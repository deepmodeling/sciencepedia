{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering the Büttiker probe model is understanding how the probe's electrochemical potential is determined. This foundational exercise establishes the core principle: the probe potential floats to a value that guarantees zero net current, effectively sampling the local potential within the conductor. By analyzing a simple, symmetric case, you will derive an intuitive result that provides a clear entry point into the mechanics of this powerful theoretical tool .",
            "id": "4266172",
            "problem": "A nanoscale conductor made of an emerging two-dimensional semiconductor is connected to three electrical contacts labeled $L$, $R$, and $p$. Contacts $L$ and $R$ are macroscopic electron reservoirs at electrochemical potentials $\\,\\mu_{L}\\,$ and $\\,\\mu_{R}\\,$, respectively. Contact $p$ is a fictitious Büttiker probe introduced to model inelastic scattering that conserves particle number locally by enforcing zero net particle current into the probe at steady state. Assume that electron transport is phase-coherent between contacts and is described by the Landauer–Büttiker framework.\n\nUse the following fundamental base:\n- The steady-state current $\\,I_{\\alpha}\\,$ flowing out of contact $\\,\\alpha\\,$ is given by the Landauer–Büttiker expression\n$$\nI_{\\alpha} \\;=\\; \\frac{2q}{h}\\,\\sum_{\\beta}\\,\\int_{-\\infty}^{\\infty}\\! dE \\; T_{\\alpha\\beta}(E)\\,\\Big[f\\big(E,\\mu_{\\alpha},T_{0}\\big)\\;-\\;f\\big(E,\\mu_{\\beta},T_{0}\\big)\\Big],\n$$\nwhere $\\,q\\,$ is the elementary charge, $\\,h\\,$ is Planck’s constant, $\\,T_{\\alpha\\beta}(E)\\,$ is the transmission probability from contact $\\,\\beta\\,$ to contact $\\,\\alpha\\,$, and $\\,f(E,\\mu,T_{0})\\,$ is the Fermi–Dirac distribution at lattice temperature $\\,T_{0}$.\n\nAssume the following physically motivated conditions typical of linear-response nanoelectronic transport:\n1. Small biases such that $\\,\\mu_{L}-\\mu_{R}\\,$ is sufficiently small to justify linearization of the Fermi–Dirac distributions about a common equilibrium chemical potential.\n2. Time-reversal symmetry and phase-coherent elastic transport between terminals imply $\\,T_{\\alpha\\beta}(E)=T_{\\beta\\alpha}(E)\\,$ for all $\\,\\alpha\\neq\\beta\\,$.\n3. Over the transport window selected by the small bias and temperature, each inter-terminal transmission can be approximated as energy-independent: $\\,T_{\\alpha\\beta}(E)\\approx T_{\\alpha\\beta}\\,$.\n4. The Büttiker probe enforces zero net particle current into itself: $\\,I_{p}=0\\,$ at steady state.\n\nUnder these assumptions, determine the Büttiker probe electrochemical potential $\\,\\mu_{p}\\,$ in terms of $\\,\\mu_{L}\\,$ and $\\,\\mu_{R}\\,$ for the symmetric-coupling toy model in which the probe couples equally to the left and right contacts, i.e., $\\,T_{pL}=T_{pR}\\,$. Provide your final result as a closed-form symbolic expression involving only $\\,\\mu_{L}\\,$ and $\\,\\mu_{R}\\,$. Do not include units in your answer.",
            "solution": "The problem asks for the electrochemical potential $\\mu_{p}$ of a Büttiker probe in a three-terminal nanoelectronic device. The solution is derived within the Landauer–Büttiker formalism under a set of simplifying assumptions.\n\nThe starting point is the given Landauer–Büttiker expression for the steady-state current $I_{\\alpha}$ flowing out of contact $\\alpha$:\n$$\nI_{\\alpha} \\;=\\; \\frac{2q}{h}\\,\\sum_{\\beta}\\,\\int_{-\\infty}^{\\infty}\\! dE \\; T_{\\alpha\\beta}(E)\\,\\Big[f\\big(E,\\mu_{\\alpha},T_{0}\\big)\\;-\\;f\\big(E,\\mu_{\\beta},T_{0}\\big)\\Big]\n$$\nHere, the indices $\\alpha$ and $\\beta$ range over the set of contacts $\\{L, R, p\\}$. The term for $\\beta=\\alpha$ in the summation is zero, as $f(E,\\mu_{\\alpha},T_{0}) - f(E,\\mu_{\\alpha},T_{0}) = 0$. Therefore, the sum is effectively over all contacts $\\beta \\neq \\alpha$.\n\nWe are interested in the current $I_{p}$ flowing out of the Büttiker probe, contact $p$. According to the formula, this is:\n$$\nI_{p} \\;=\\; \\frac{2q}{h}\\,\\left( \\int_{-\\infty}^{\\infty}\\! dE \\; T_{pL}(E)\\,\\Big[f(E,\\mu_{p},T_{0}) - f(E,\\mu_{L},T_{0})\\Big] + \\int_{-\\infty}^{\\infty}\\! dE \\; T_{pR}(E)\\,\\Big[f(E,\\mu_{p},T_{0}) - f(E,\\mu_{R},T_{0})\\Big] \\right)\n$$\n\nThe first assumption is that of small biases, which allows for the linearization of the Fermi–Dirac distribution. The difference between two Fermi functions can be approximated as:\n$$\nf(E,\\mu_{a}, T_{0}) - f(E,\\mu_{b}, T_{0}) \\approx \\left.\\frac{\\partial f}{\\partial \\mu}\\right|_{\\mu=\\mu_{eq}} (\\mu_{a}-\\mu_{b})\n$$\nwhere $\\mu_{eq}$ is a common equilibrium chemical potential. Using the property that $\\frac{\\partial f}{\\partial \\mu} = -\\frac{\\partial f}{\\partial E}$, we have:\n$$\nf(E,\\mu_{a}, T_{0}) - f(E,\\mu_{b}, T_{0}) \\approx -\\frac{\\partial f(E,\\mu_{eq},T_{0})}{\\partial E} (\\mu_{a}-\\mu_{b})\n$$\n\nThe second relevant assumption is that the transmission probabilities are approximately energy-independent over the relevant transport window, i.e., $T_{\\alpha\\beta}(E) \\approx T_{\\alpha\\beta}$.\n\nSubstituting these approximations into the expression for $I_{p}$:\n$$\nI_{p} \\approx \\frac{2q}{h}\\,\\left( T_{pL} \\int_{-\\infty}^{\\infty}\\! dE \\; \\Big(-\\frac{\\partial f}{\\partial E}\\Big)(\\mu_{p}-\\mu_{L}) + T_{pR} \\int_{-\\infty}^{\\infty}\\! dE \\; \\Big(-\\frac{\\partial f}{\\partial E}\\Big)(\\mu_{p}-\\mu_{R}) \\right)\n$$\nThe integral of the negative derivative of the Fermi function over all energies is unity:\n$$\n\\int_{-\\infty}^{\\infty} \\! \\Big(-\\frac{\\partial f(E)}{\\partial E}\\Big) dE = - \\big[f(E)\\big]_{-\\infty}^{\\infty} = - (f(+\\infty) - f(-\\infty)) = - (0-1) = 1\n$$\nThis simplifies the expression for the current $I_{p}$ to its linear-response form:\n$$\nI_{p} = \\frac{2q}{h}\\,\\Big[ T_{pL}(\\mu_{p} - \\mu_{L}) + T_{pR}(\\mu_{p} - \\mu_{R}) \\Big]\n$$\n\nThe defining characteristic of a Büttiker probe, as stated in the problem, is that it enforces zero net particle current at steady state. This implies that the net charge current $I_{p}$ is also zero.\n$$\nI_{p} = 0\n$$\nSetting our derived expression for $I_{p}$ to zero:\n$$\n\\frac{2q}{h}\\,\\Big[ T_{pL}(\\mu_{p} - \\mu_{L}) + T_{pR}(\\mu_{p} - \\mu_{R}) \\Big] = 0\n$$\nSince the prefactor $\\frac{2q}{h}$ is a non-zero constant, the term in the square brackets must be zero:\n$$\nT_{pL}(\\mu_{p} - \\mu_{L}) + T_{pR}(\\mu_{p} - \\mu_{R}) = 0\n$$\n\nNow, we solve this algebraic equation for the probe potential $\\mu_{p}$:\n$$\nT_{pL}\\mu_{p} - T_{pL}\\mu_{L} + T_{pR}\\mu_{p} - T_{pR}\\mu_{R} = 0\n$$\n$$\n\\mu_{p}(T_{pL} + T_{pR}) = T_{pL}\\mu_{L} + T_{pR}\\mu_{R}\n$$\n$$\n\\mu_{p} = \\frac{T_{pL}\\mu_{L} + T_{pR}\\mu_{R}}{T_{pL} + T_{pR}}\n$$\nThis general result shows that the probe potential is a weighted average of the potentials of the contacts to which it is coupled, with the transmission probabilities (proportional to conductances) acting as the weights.\n\nFinally, we apply the specific condition for the given toy model: the probe couples equally to the left and right contacts, meaning $T_{pL} = T_{pR}$. Let us denote this common transmission probability by $T_{p}$. Substituting this into the expression for $\\mu_{p}$:\n$$\n\\mu_{p} = \\frac{T_{p}\\mu_{L} + T_{p}\\mu_{R}}{T_{p} + T_{p}} = \\frac{T_{p}(\\mu_{L} + \\mu_{R})}{2T_{p}}\n$$\nAssuming the probe is physically connected to the contacts ($T_{p} \\neq 0$), we can cancel $T_{p}$ from the numerator and denominator, yielding the final result:\n$$\n\\mu_{p} = \\frac{\\mu_{L} + \\mu_{R}}{2}\n$$\nThe electrochemical potential of the symmetrically coupled Büttiker probe is the arithmetic mean of the electrochemical potentials of the source and drain contacts.",
            "answer": "$$\\boxed{\\frac{\\mu_{L} + \\mu_{R}}{2}}$$"
        },
        {
            "introduction": "Building upon the basic concept of the probe potential, this practice delves into the quantitative impact of dephasing on quantum transport. Using the Non-Equilibrium Green's Function (NEGF) formalism for a minimal three-site chain, you will analytically derive the effective transmission in the presence of a probe. This exercise is crucial for understanding how a Büttiker probe partitions transport into a direct, coherent pathway and an indirect, probe-mediated incoherent pathway, a fundamental concept in modeling decoherence .",
            "id": "4266178",
            "problem": "Consider a one-dimensional chain of $3$ sites labeled $1\\text{--}2\\text{--}3$ described by a nearest-neighbor tight-binding Hamiltonian with on-site energies equal to $0$ and hopping amplitude $-t$ between adjacent sites. Site $1$ is coupled to a left electron reservoir (lead) with coupling strength $\\Gamma_{L}$, site $3$ is coupled to a right electron reservoir with coupling strength $\\Gamma_{R}$, and site $2$ is coupled to a Büttiker dephasing probe with coupling strength $\\Gamma_{p}$. Assume the reservoirs and the Büttiker probe are described within the wide-band limit and that transport is evaluated using the Non-Equilibrium Green’s Function (NEGF) formalism. The system is studied at zero temperature and in the linear response regime about a common equilibrium chemical potential $\\mu=0$, with a small bias such that the left and right reservoirs have chemical potentials $\\mu_{L}=\\delta\\mu$ and $\\mu_{R}=-\\delta\\mu$, respectively, where $|\\delta\\mu|$ is small. The Büttiker probe is treated as a voltage probe whose distribution function is adjusted to satisfy current conservation, i.e., the net current flowing into the probe is zero.\n\nStarting from first principles appropriate to this context, namely:\n- the retarded Green’s function $G^{r}(E)$ defined by $G^{r}(E)=\\left[E I - H - \\Sigma^{r}(E)\\right]^{-1}$, where $H$ is the tight-binding Hamiltonian and $\\Sigma^{r}(E)$ is the sum of retarded self-energies from the left lead, right lead, and probe,\n- the spectral coupling matrices $\\Gamma_{\\alpha}(E)=i\\left[\\Sigma_{\\alpha}^{r}(E)-\\Sigma_{\\alpha}^{a}(E)\\right]$ for $\\alpha\\in\\{L,R,p\\}$,\n- the multi-terminal Landauer–Büttiker (LB) linear-response current relations consistent with NEGF, and\n- the Büttiker probe (BP) condition of zero net current into the probe,\n\nderive the local non-equilibrium occupations on each site and the bond current distribution at energy $E=0$, and analyze how the presence of the probe modifies the effective two-terminal transmission from the left to the right reservoir. For definiteness, take the retarded self-energy in the wide-band limit on site $i$ connected to terminal $\\alpha$ to be $\\Sigma_{\\alpha}^{r}(E)=-i\\,\\Gamma_{\\alpha}/2$ on that site and zero elsewhere, with $\\Gamma_{\\alpha}$ energy-independent.\n\nYour final task is to provide a closed-form analytic expression for the effective two-terminal transmission at energy $E=0$ after enforcing the Büttiker probe condition. Express your final answer as a function of $t$, $\\Gamma_{L}$, $\\Gamma_{R}$, and $\\Gamma_{p}$. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "The system is a $3$-site tight-binding chain described by the Hamiltonian matrix $H$ in the site basis $\\{|1\\rangle, |2\\rangle, |3\\rangle\\}$. With zero on-site energies and nearest-neighbor hopping amplitude $-t$, the Hamiltonian is:\n$$\nH = \\begin{pmatrix} 0  -t  0 \\\\ -t  0  -t \\\\ 0  -t  0 \\end{pmatrix}\n$$\nThe system is coupled to three terminals (Left, Right, and Probe). In the wide-band approximation, the retarded self-energy for each terminal $\\alpha \\in \\{L, R, p\\}$ is a constant matrix. The self-energy $\\Sigma^r_\\alpha(E)$ is non-zero only at the site of coupling. Specifically, site $1$ is coupled to lead L, site $2$ to probe p, and site $3$ to lead R.\n$$\n\\Sigma_{L}^{r}(E) = \\begin{pmatrix} -i\\frac{\\Gamma_L}{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad\n\\Sigma_{p}^{r}(E) = \\begin{pmatrix} 0  0  0 \\\\ 0  -i\\frac{\\Gamma_p}{2}  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad\n\\Sigma_{R}^{r}(E) = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  -i\\frac{\\Gamma_R}{2} \\end{pmatrix}\n$$\nThe total retarded self-energy is $\\Sigma^{r}(E) = \\Sigma_{L}^{r}(E) + \\Sigma_{p}^{r}(E) + \\Sigma_{R}^{r}(E)$. The retarded Green's function of the system is given by:\n$$\nG^{r}(E) = \\left[E I - H - \\Sigma^{r}(E)\\right]^{-1}\n$$\nWe are interested in the transport properties at energy $E=0$, corresponding to the equilibrium chemical potential. At $E=0$, the matrix to be inverted is:\n$$\nM = \\left[0 \\cdot I - H - \\Sigma^{r}(0)\\right] = -H - \\Sigma^{r}(0) = \\begin{pmatrix} i\\frac{\\Gamma_L}{2}  t  0 \\\\ t  i\\frac{\\Gamma_p}{2}  t \\\\ 0  t  i\\frac{\\Gamma_R}{2} \\end{pmatrix}\n$$\nThe current flowing from lead $\\beta$ to lead $\\alpha$ is given by the Landauer-Büttiker formula. For linear response at zero temperature, the net current into lead $\\alpha$ is $I_\\alpha = \\frac{e^2}{h} \\sum_{\\beta \\neq \\alpha} T_{\\beta \\alpha}(\\mu_\\alpha - \\mu_\\beta)$, where $\\mu_\\alpha$ is the chemical potential of lead $\\alpha$ and $T_{\\beta \\alpha}$ is the transmission probability from lead $\\beta$ to lead $\\alpha$. Within the NEGF formalism, the transmission is given by:\n$$\nT_{\\beta \\alpha}(E) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha}(E) G^{r}(E) \\Gamma_{\\beta}(E) G^{a}(E)\\right]\n$$\nHere, $G^{a}(E) = [G^{r}(E)]^{\\dagger}$ is the advanced Green's function and $\\Gamma_{\\alpha}(E) = i\\left[\\Sigma_{\\alpha}^{r}(E)-\\Sigma_{\\alpha}^{a}(E)\\right]$ are the spectral coupling matrices. In the wide-band limit, $\\Sigma^a_\\alpha = (\\Sigma^r_\\alpha)^\\dagger = i\\Gamma_\\alpha/2$, so $\\Gamma_\\alpha$ is a diagonal matrix with the constant $\\Gamma_\\alpha$ at the position of the coupled site and zeros elsewhere. For example, $(\\Gamma_L)_{11} = \\Gamma_L$.\n\nThe Büttiker probe condition requires that the net current into the probe is zero, $I_p=0$. With chemical potentials $\\mu_L = \\delta\\mu$, $\\mu_R = -\\delta\\mu$, and an unknown $\\mu_p$, the condition is:\n$$\nI_p = \\frac{e^2}{h} \\left[ T_{Lp}(\\mu_p - \\mu_L) + T_{Rp}(\\mu_p - \\mu_R) \\right] = 0\n$$\nThis allows us to solve for the probe potential: $\\mu_p(T_{Lp} + T_{Rp}) = T_{Lp}\\mu_L + T_{Rp}\\mu_R$, which gives $\\mu_p = \\frac{T_{Lp}\\mu_L + T_{Rp}\\mu_R}{T_{Lp} + T_{Rp}}$.\n\nThe current flowing out of the left lead is $I_L = I_{LR} + I_{Lp}$.\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{RL}(\\mu_L - \\mu_R) + T_{pL}(\\mu_L - \\mu_p) \\right]\n$$\nUsing $T_{\\alpha\\beta}=T_{\\beta\\alpha}$ and substituting the expression for $\\mu_p$:\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{LR}(\\mu_L - \\mu_R) + T_{Lp}\\left(\\mu_L - \\frac{T_{Lp}\\mu_L + T_{Rp}\\mu_R}{T_{Lp} + T_{Rp}}\\right) \\right]\n$$\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{LR}(\\mu_L - \\mu_R) + T_{Lp}\\frac{(\\mu_L T_{Lp} + \\mu_L T_{Rp}) - (T_{Lp}\\mu_L + T_{Rp}\\mu_R)}{T_{Lp} + T_{Rp}} \\right]\n$$\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{LR}(\\mu_L - \\mu_R) + \\frac{T_{Lp}T_{Rp}}{T_{Lp} + T_{Rp}}(\\mu_L - \\mu_R) \\right]\n$$\nThe total current is $I_L = \\frac{e^2}{h} T_{eff}(\\mu_L - \\mu_R)$, where the effective two-terminal transmission is:\n$$\nT_{eff} = T_{LR} + \\frac{T_{Lp} T_{Rp}}{T_{Lp} + T_{Rp}}\n$$\nThis expression describes how transport is partitioned between a direct, coherent path ($T_{LR}$) and an indirect, incoherent path through the dephasing probe.\n\nTo find $T_{eff}$, we must calculate the individual transmissions $T_{LR}$, $T_{Lp}$, and $T_{Rp}$ at $E=0$. This requires inverting the matrix $M$ to get $G^r(0)$. The determinant of $M$ is:\n$$\n\\det(M) = (i\\Gamma_L/2)[(i\\Gamma_p/2)(i\\Gamma_R/2) - t^2] - t[t(i\\Gamma_R/2)] = -\\frac{i}{8}(\\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R))\n$$\nLet's define a real-valued quantity $K = \\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R)$, so $\\det(M) = -iK/8$. The required elements of $G^r(0) = M^{-1} = \\frac{\\mathrm{adj}(M)}{\\det(M)}$ are:\n$G^r_{31}(0) = \\frac{C_{13}}{\\det(M)} = \\frac{t^2}{-iK/8} = \\frac{8it^2}{K}$\n$G^r_{21}(0) = \\frac{C_{12}}{\\det(M)} = \\frac{-t(i\\Gamma_R/2)}{-iK/8} = \\frac{4t\\Gamma_R}{K}$\n$G^r_{23}(0) = \\frac{C_{32}}{\\det(M)} = \\frac{-t(i\\Gamma_L/2)}{-iK/8} = \\frac{4t\\Gamma_L}{K}$\nwhere $C_{ij}$ are the cofactors of $M$.\n\nThe transmissions are calculated as $T_{\\beta\\alpha} = \\Gamma_\\beta \\Gamma_\\alpha |G^r_{\\beta\\alpha}(0)|^2$, where the indices on $G^r$ refer to sites.\n$$\nT_{LR} = \\Gamma_L \\Gamma_R |G^r_{31}(0)|^2 = \\Gamma_L \\Gamma_R \\left| \\frac{8it^2}{K} \\right|^2 = \\frac{64 t^4 \\Gamma_L \\Gamma_R}{K^2}\n$$\n$$\nT_{Lp} = \\Gamma_L \\Gamma_p |G^r_{21}(0)|^2 = \\Gamma_L \\Gamma_p \\left| \\frac{4t\\Gamma_R}{K} \\right|^2 = \\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2}\n$$\n$$\nT_{Rp} = \\Gamma_R \\Gamma_p |G^r_{23}(0)|^2 = \\Gamma_R \\Gamma_p \\left| \\frac{4t\\Gamma_L}{K} \\right|^2 = \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}\n$$\nNow we compute the second term in $T_{eff}$:\n$$\n\\frac{T_{Lp} T_{Rp}}{T_{Lp} + T_{Rp}} = \\frac{\\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2} \\cdot \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}}{\\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2} + \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}} = \\frac{\\frac{256 t^4 \\Gamma_p^2 \\Gamma_L^3 \\Gamma_R^3}{K^4}}{\\frac{16 t^2 \\Gamma_p \\Gamma_L \\Gamma_R (\\Gamma_R + \\Gamma_L)}{K^2}} = \\frac{16 t^2 \\Gamma_p \\Gamma_L^2 \\Gamma_R^2}{K^2 (\\Gamma_L + \\Gamma_R)}\n$$\nFinally, we sum the two contributions to $T_{eff}$:\n$$\nT_{eff} = \\frac{64 t^4 \\Gamma_L \\Gamma_R}{K^2} + \\frac{16 t^2 \\Gamma_p \\Gamma_L^2 \\Gamma_R^2}{K^2 (\\Gamma_L + \\Gamma_R)} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{K^2 (\\Gamma_L + \\Gamma_R)} \\left[ 4 t^2 (\\Gamma_L + \\Gamma_R) + \\Gamma_p \\Gamma_L \\Gamma_R \\right]\n$$\nThe term in the square brackets is exactly the definition of $K$.\n$$\nT_{eff} = \\frac{16 t^2 \\Gamma_L \\Gamma_R \\cdot K}{K^2 (\\Gamma_L + \\Gamma_R)} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{K (\\Gamma_L + \\Gamma_R)}\n$$\nSubstituting back $K = \\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R)$, we obtain the final expression for the effective transmission.\n\nThe problem also asks for local occupations and bond currents. These can be found from the lesser Green's function, $G^(E) = G^r(E) \\Sigma^(E) G^a(E)$, where $\\Sigma^(E) = i\\sum_{\\alpha} f_{\\alpha}(E) \\Gamma_{\\alpha}$. The local occupation on site $i$ is $n_i = -i \\int (dE/2\\pi) G^_{ii}(E)$. The bond current $I_{ij}$ is proportional to $\\mathrm{Im}[H_{ij}G^_{ji}]$. With $I_p=0$, current conservation dictates that the bond currents $I_{12}$ and $I_{23}$ must be equal and carry the total current $I_L$. These quantities can be fully calculated using the Green's function elements and the probe potential $\\mu_p$ derived above, but the primary task is to find the effective transmission $T_{eff}$.\nThe final closed-form expression for $T_{eff}$ at $E=0$ is:\n$$\nT_{eff} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{(\\Gamma_L \\Gamma_p \\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R))(\\Gamma_L + \\Gamma_R)}\n$$\nThis expression shows how the hopping $t$ enables transport, while the couplings $\\Gamma_L, \\Gamma_R$ are necessary for injection and collection. The dephasing term $\\Gamma_p$ in the denominator suppresses the overall transmission, as expected.",
            "answer": "$$\n\\boxed{\\frac{16 t^{2} \\Gamma_{L} \\Gamma_{R}}{(\\Gamma_{L} \\Gamma_{p} \\Gamma_{R} + 4t^{2}(\\Gamma_{L} + \\Gamma_{R}))(\\Gamma_{L} + \\Gamma_{R})}}\n$$"
        },
        {
            "introduction": "This final practice moves from analytical theory to computational application, a vital transition for modern nanoelectronics research. You are tasked with writing a program to simulate quantum transport in a chain and investigate how the device current changes as a scattering center is moved from the device's interior to a location near a contact. This hands-on coding exercise not only reinforces the NEGF formalism but also provides practical insight into how the spatial location of inelastic scattering influences a device's electrical characteristics .",
            "id": "4266098",
            "problem": "You are to write a complete and runnable program that computes how the steady-state device current in a coherent one-dimensional tight-binding chain changes when a single Büttiker probe is moved from a bulk site to a location near a contact. The device is modeled as a linear chain of $N$ sites with nearest-neighbor hopping. The left and right metallic contacts are modeled by wide-band self-energies at the end sites. The Büttiker probe is modeled as a third wide-band terminal coupled to a single site and its electrochemical potential is chosen so that the net current into the probe is zero (voltage-probe limit, representing inelastic relaxation). Use zero-temperature, linear-response transport.\n\nStart from the following foundational base:\n- The multi-terminal Landauer–Büttiker relation in linear response at zero temperature: for terminal $\\alpha$, the current is $I_{\\alpha} = \\left(g_s e^2/h\\right) \\sum_{\\beta} T_{\\alpha\\beta}\\left(V_{\\alpha}-V_{\\beta}\\right)$, where $g_s$ is the spin degeneracy, $e$ is the elementary charge, $h$ is Planck's constant, $T_{\\alpha\\beta}$ is the transmission from terminal $\\beta$ to $\\alpha$ at the Fermi energy $E_F$, and $V_{\\alpha}$ is the electrical potential (in volts) of terminal $\\alpha$.\n- The Caroli formula for transmission in the non-equilibrium Green's function framework: $T_{\\alpha\\beta}(E_F) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha} G^r(E_F)\\,\\Gamma_{\\beta} G^a(E_F)\\right]$, where $G^r$ and $G^a$ are the retarded and advanced Green's functions of the device including all self-energies, and $\\Gamma_{\\alpha} = i\\left(\\Sigma_{\\alpha} - \\Sigma_{\\alpha}^{\\dagger}\\right)$ is the broadening matrix for terminal $\\alpha$.\n- The retarded Green's function for the device: $G^r(E_F) = \\left[E_F I - H - \\sum_{\\alpha}\\Sigma_{\\alpha}\\right]^{-1}$, with $H$ the device Hamiltonian and $\\Sigma_{\\alpha}$ the terminal self-energies in the wide-band limit.\n\nDevice model and conventions:\n- The device Hamiltonian $H$ is an $N\\times N$ tridiagonal matrix with on-site energies equal to $0$ and nearest-neighbor hopping $-t$ (energy in electronvolts).\n- The left (right) contact couples only to site index $0$ (site index $N-1$) with wide-band self-energy $\\Sigma_L = -i \\Gamma_L/2$ at site $0$ and $\\Sigma_R = -i \\Gamma_R/2$ at site $N-1$, where $\\Gamma_L$ and $\\Gamma_R$ are positive constants in electronvolts.\n- The Büttiker probe couples to exactly one site, indexed by an integer position $p$, with wide-band self-energy $\\Sigma_p = -i \\Gamma_p/2$ at that site. The probe potential $V_p$ is determined by the zero-current condition $I_p = 0$ under the same linear-response law at zero temperature.\n- Use spin degeneracy $g_s = 2$. Use the Fermi energy $E_F$ inside the device band (energy in electronvolts). Use a small symmetric bias such that $V_L = +V/2$ and $V_R = -V/2$, where $V$ is the applied source-drain bias in volts.\n- Use zero-based indexing for lattice sites: the left contact is at site $0$, the right contact at site $N-1$, the \"near-contact\" probe position is the site $1$, and the \"bulk\" probe position is the site $\\lfloor N/2 \\rfloor$.\n\nYour program must:\n- For each test case, compute the steady-state device current flowing from left to right when the probe is at the bulk position, $I_{\\text{bulk}}$, and when the probe is at the near-contact position, $I_{\\text{near}}$, both in amperes. Then compute the difference $\\Delta I = I_{\\text{bulk}} - I_{\\text{near}}$ in amperes.\n- Use the zero-temperature, linear-response expressions strictly at the Fermi energy $E_F$ and do not perform any energy averaging.\n- Ensure numerical stability by adding a small positive imaginary infinitesimal $i\\eta$ with $\\eta \\ll 1$ (in electronvolts) if needed for matrix inversion. Choose $\\eta$ sufficiently small not to affect the physical result.\n- Express the final numerical answers for each test case in amperes, each rounded to $6$ significant figures.\n\nTest suite:\n- Case $1$ (happy path): $N=10$, $t=1.0$ eV, $\\Gamma_L=0.5$ eV, $\\Gamma_R=0.5$ eV, $\\Gamma_p=0.2$ eV, $E_F=0.0$ eV, $V=0.01$ V.\n- Case $2$ (weak probe, near-ballistic limit): $N=10$, $t=1.0$ eV, $\\Gamma_L=0.5$ eV, $\\Gamma_R=0.5$ eV, $\\Gamma_p=1.0\\times 10^{-6}$ eV, $E_F=0.0$ eV, $V=0.01$ V.\n- Case $3$ (asymmetric contacts): $N=12$, $t=1.0$ eV, $\\Gamma_L=0.05$ eV, $\\Gamma_R=1.0$ eV, $\\Gamma_p=0.5$ eV, $E_F=0.0$ eV, $V=0.01$ V.\n- Case $4$ (short chain, stronger probe, larger bias): $N=4$, $t=0.5$ eV, $\\Gamma_L=0.5$ eV, $\\Gamma_R=0.5$ eV, $\\Gamma_p=1.0$ eV, $E_F=0.0$ eV, $V=0.02$ V.\n\nOutput specification:\n- Your program should produce a single line of output containing the results for the test suite as a comma-separated list enclosed in square brackets, ordered as listed above. For example, the format must be exactly like: [$\\Delta I_1$,$\\Delta I_2$,$\\Delta I_3$,$\\Delta I_4$], where each $\\Delta I_k$ is a float in amperes rounded to $6$ significant figures.\n- All currents must be reported in amperes.",
            "solution": "The problem requires the calculation of the change in steady-state device current, $\\Delta I = I_{\\text{bulk}} - I_{\\text{near}}$, when a Büttiker probe is moved from a \"bulk\" position to a \"near-contact\" position. The device is a one-dimensional tight-binding chain of $N$ sites connected to left (L) and right (R) contacts, with the probe (p) acting as a third terminal.\n\nThe foundation of our calculation is the multi-terminal Landauer-Büttiker formula for current in terminal $\\alpha$ at zero temperature and in the linear response regime:\n$$I_{\\alpha} = \\frac{g_s e^2}{h} \\sum_{\\beta} T_{\\alpha\\beta}(E_F) (V_{\\alpha} - V_{\\beta})$$\nHere, $g_s=2$ is the spin degeneracy, $e$ is the elementary charge, $h$ is Planck's constant, $V_{\\alpha}$ is the voltage of terminal $\\alpha$, and $T_{\\alpha\\beta}(E_F)$ is the transmission probability from terminal $\\beta$ to $\\alpha$ at the Fermi energy $E_F$. The terminals are $\\alpha, \\beta \\in \\{L, R, p\\}$. The applied bias is symmetric: $V_L = +V/2$ and $V_R = -V/2$. The potential of the Büttiker probe, $V_p$, is determined by the condition that the net current into it is zero, $I_p=0$.\n\nFirst, we determine the probe potential $V_p$. The condition $I_p=0$ yields:\n$$I_p = \\frac{g_s e^2}{h} \\left[ T_{pL}(V_p - V_L) + T_{pR}(V_p - V_R) \\right] = 0$$\nNote that the term for $\\beta=p$ is $T_{pp}(V_p-V_p)=0$. Solving for $V_p$:\n$$V_p(T_{pL} + T_{pR}) = T_{pL}V_L + T_{pR}V_R$$\n$$V_p = \\frac{T_{pL}V_L + T_{pR}V_R}{T_{pL} + T_{pR}}$$\nHere we have used the reciprocity of transmission in the absence of a magnetic field, $T_{\\alpha\\beta} = T_{\\beta\\alpha}$.\n\nNext, we calculate the device current, which is the current flowing from the left contact, $I_L$. Due to current conservation, $I_L+I_R+I_p=0$. Since $I_p=0$, we have $I_L = -I_R$, so $I_L$ represents the net current through the device.\n$$I_L = \\frac{g_s e^2}{h} \\left[ T_{LR}(V_L - V_R) + T_{Lp}(V_L - V_p) \\right]$$\nSubstituting the expression for $V_p$:\n$$I_L = \\frac{g_s e^2}{h} \\left[ T_{LR}(V_L - V_R) + T_{Lp} \\left( V_L - \\frac{T_{pL}V_L + T_{pR}V_R}{T_{pL} + T_{pR}} \\right) \\right]$$\nUsing $T_{Lp} = T_{pL}$ and simplifying the term in the parenthesis:\n$$V_L - \\frac{T_{Lp}V_L + T_{pR}V_R}{T_{Lp} + T_{pR}} = \\frac{V_L(T_{Lp} + T_{pR}) - (T_{Lp}V_L + T_{pR}V_R)}{T_{Lp} + T_{pR}} = \\frac{T_{pR}(V_L - V_R)}{T_{Lp} + T_{pR}}$$\nSubstituting this back into the expression for $I_L$:\n$$I_L = \\frac{g_s e^2}{h} \\left[ T_{LR}(V_L - V_R) + T_{Lp} \\frac{T_{pR}(V_L - V_R)}{T_{Lp} + T_{pR}} \\right]$$\nLetting $V = V_L - V_R$ and $G_0 = g_s e^2 / h$, the device current is:\n$$I_{\\text{device}} = G_0 V \\left( T_{LR} + \\frac{T_{Lp} T_{pR}}{T_{Lp} + T_{pR}} \\right)$$\nThis central equation shows that the probe introduces an additional pathway for transport, whose effective transmission is added to the direct transmission $T_{LR}$. Note that if $\\Gamma_p=0$, then $T_{Lp}=T_{pR}=0$ and we recover the two-terminal result $I = G_0 V T_{LR}$.\n\nThe core of the calculation is to find the transmission probabilities $T_{\\alpha\\beta}$ using the non-equilibrium Green's function (NEGF) formalism. The Caroli formula gives the transmission:\n$$T_{\\alpha\\beta}(E_F) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha} G^r(E_F)\\,\\Gamma_{\\beta} G^a(E_F)\\right]$$\nwhere $G^r$ and $G^a$ are the retarded and advanced Green's functions, and $\\Gamma_{\\alpha}$ is the broadening matrix for terminal $\\alpha$.\nThe broadening matrices are given by $\\Gamma_{\\alpha} = i(\\Sigma_{\\alpha} - \\Sigma_{\\alpha}^{\\dagger})$. For the wide-band self-energies $\\Sigma_L = -i\\Gamma_L/2$ at site $0$, $\\Sigma_R = -i\\Gamma_R/2$ at site $N-1$, and $\\Sigma_p = -i\\Gamma_p/2$ at site $p$, the broadening matrices are diagonal, with a single non-zero element: $(\\Gamma_{\\alpha})_{s_\\alpha, s_\\alpha} = \\Gamma_{\\alpha}$, where $s_\\alpha$ is the site to which terminal $\\alpha$ couples ($s_L=0$, $s_R=N-1$, $s_p$ is the probe position).\nUnder these conditions, the trace simplifies to:\n$$T_{\\alpha\\beta} = \\Gamma_\\alpha \\Gamma_\\beta |G^r_{s_\\alpha, s_\\beta}|^2$$\nwhere $G^r_{s_\\alpha, s_\\beta}$ is the element of the retarded Green's function matrix connecting the site of contact $\\alpha$ to the site of contact $\\beta$.\n\nThe retarded Green's function is calculated by inverting the system's effective Hamiltonian matrix:\n$$G^r(E_F) = \\left[E_F I - H - \\sum_{\\alpha \\in \\{L, R, p\\}} \\Sigma_{\\alpha}\\right]^{-1}$$\nwhere $I$ is the $N \\times N$ identity matrix and $H$ is the device Hamiltonian. $H$ is a tridiagonal matrix with zero on-site energies and nearest-neighbor hopping $-t$. Let $M = E_F I - H - \\sum_{\\alpha} \\Sigma_{\\alpha}$. Its elements are:\n$M_{i,i+1} = M_{i+1,i} = t$ for $i \\in \\{0, \\dots, N-2\\}$.\n$M_{i,i} = E_F$ for $i \\notin \\{0, N-1, p\\}$.\nThe diagonal elements at the contact sites are modified by the self-energies:\n$M_{0,0} = E_F - (\\Sigma_L)_{0,0} - (\\Sigma_p)_{0,0} = E_F + i\\Gamma_L/2 + i\\delta_{0,p}\\Gamma_p/2$\n$M_{N-1,N-1} = E_F - (\\Sigma_R)_{N-1,N-1} - (\\Sigma_p)_{N-1,N-1} = E_F + i\\Gamma_R/2 + i\\delta_{N-1,p}\\Gamma_p/2$\n$M_{p,p} = E_F - (\\Sigma_p)_{p,p} = E_F + i\\Gamma_p/2$ for $p \\notin \\{0, N-1\\}$.\nThe term $i\\eta$ for numerical stability is automatically provided by the imaginary parts of the self-energies, assuming at least one $\\Gamma_\\alpha > 0$.\n\nThe overall algorithm for each test case is:\n1. Define parameters: $N, t, \\Gamma_L, \\Gamma_R, \\Gamma_p, E_F, V$.\n2. Define probe positions: $p_{\\text{near}} = 1$ and $p_{\\text{bulk}} = \\lfloor N/2 \\rfloor$.\n3. For each position $p \\in \\{p_{\\text{near}}, p_{\\text{bulk}}\\}$:\n    a. Construct the $N \\times N$ complex matrix $M$.\n    b. Compute $G^r = M^{-1}$.\n    c. Extract the necessary elements of $G^r$: $G^r_{0,N-1}$, $G^r_{0,p}$, and $G^r_{p,N-1}$.\n    d. Calculate transmissions: $T_{LR} = \\Gamma_L \\Gamma_R |G^r_{0,N-1}|^2$, $T_{Lp} = \\Gamma_L \\Gamma_p |G^r_{0,p}|^2$, $T_{pR} = \\Gamma_p \\Gamma_R |G^r_{p,N-1}|^2$.\n    e. Compute the current $I(p)$ using the derived formula.\n4. Calculate the difference $\\Delta I = I(p_{\\text{bulk}}) - I(p_{\\text{near}})$.\n5. Report $\\Delta I$ in amperes, rounded to $6$ significant figures.\n\nThe physical constants used are $e = 1.602176634 \\times 10^{-19}$ C and $h = 6.62607015 \\times 10^{-34}$ J$\\cdot$s.\nThe conductance quantum is $G_0 = 2e^2/h \\approx 7.748091729 \\times 10^{-5}$ A/V.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It calculates the change in current when a Büttiker probe is moved.\n    \"\"\"\n    \n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    h = 6.62607015e-34    # Planck's constant in J*s\n    G0 = 2 * e**2 / h      # Conductance quantum with spin degeneracy g_s=2, in A/V (Siemens)\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: happy path\n        {'N': 10, 't': 1.0, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 0.2, 'E_F': 0.0, 'V': 0.01},\n        # Case 2: weak probe, near-ballistic limit\n        {'N': 10, 't': 1.0, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 1.0e-6, 'E_F': 0.0, 'V': 0.01},\n        # Case 3: asymmetric contacts\n        {'N': 12, 't': 1.0, 'Gamma_L': 0.05, 'Gamma_R': 1.0, 'Gamma_p': 0.5, 'E_F': 0.0, 'V': 0.01},\n        # Case 4: short chain, stronger probe, larger bias\n        {'N': 4, 't': 0.5, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 1.0, 'E_F': 0.0, 'V': 0.02},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        p_bulk = params['N'] // 2\n        p_near = 1\n        \n        I_bulk = calculate_current(params, p_bulk, G0)\n        I_near = calculate_current(params, p_near, G0)\n        \n        delta_I = I_bulk - I_near\n        results.append(f\"{delta_I:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n\ndef calculate_current(params, p_probe, G0):\n    \"\"\"\n    Calculates the steady-state current for a given set of device parameters and probe position.\n    \n    Args:\n        params (dict): A dictionary containing N, t, Gamma_L, Gamma_R, Gamma_p, E_F, V.\n        p_probe (int): The zero-based index of the site where the probe is coupled.\n        G0 (float): The conductance quantum 2*e^2/h.\n\n    Returns:\n        float: The calculated current in Amperes.\n    \"\"\"\n    N = params['N']\n    t = params['t']\n    Gamma_L = params['Gamma_L']\n    Gamma_R = params['Gamma_R']\n    Gamma_p = params['Gamma_p']\n    E_F = params['E_F']\n    V = params['V']\n\n    # 1. Construct the matrix M = E_F*I - H - Sigma\n    # H is the tight-binding Hamiltonian with -t hopping\n    # Sigma is the sum of self-energies for L, R, and p terminals\n    M = np.zeros((N, N), dtype=np.complex128)\n\n    # Diagonal elements from E_F*I\n    np.fill_diagonal(M, E_F)\n    \n    # Off-diagonal elements from -H\n    if N > 1:\n        off_diag = np.full(N - 1, t)\n        M += np.diag(off_diag, 1) + np.diag(off_diag, -1)\n\n    # Add self-energies -Sigma to the diagonal\n    # Sigma_alpha = -i * Gamma_alpha / 2, so -Sigma_alpha = +i * Gamma_alpha / 2\n    M[0, 0] += 1j * Gamma_L / 2\n    M[N - 1, N - 1] += 1j * Gamma_R / 2\n    M[p_probe, p_probe] += 1j * Gamma_p / 2\n    \n    # 2. Invert M to get the retarded Green's function G^r\n    Gr = np.linalg.inv(M)\n\n    # 3. Extract required elements of G^r\n    s_L = 0\n    s_R = N - 1\n    s_p = p_probe\n\n    Gr_LR = Gr[s_L, s_R]\n    Gr_Lp = Gr[s_L, s_p]\n    Gr_pR = Gr[s_p, s_R]\n    \n    # 4. Calculate transmission probabilities T_ab = Gamma_a * Gamma_b * |G^r_{s_a, s_b}|^2\n    T_LR = Gamma_L * Gamma_R * (np.abs(Gr_LR) ** 2)\n    T_Lp = Gamma_L * Gamma_p * (np.abs(Gr_Lp) ** 2)\n    T_pR = Gamma_p * Gamma_R * (np.abs(Gr_pR) ** 2)\n\n    # 5. Calculate the effective transmission and current\n    if (T_Lp + T_pR) == 0:\n        T_eff = T_LR\n    else:\n        # This term represents the additional transport channel via the probe\n        T_eff = T_LR + (T_Lp * T_pR) / (T_Lp + T_pR)\n    \n    current = G0 * T_eff * V\n    \n    return current\n\nsolve()\n\n```"
        }
    ]
}