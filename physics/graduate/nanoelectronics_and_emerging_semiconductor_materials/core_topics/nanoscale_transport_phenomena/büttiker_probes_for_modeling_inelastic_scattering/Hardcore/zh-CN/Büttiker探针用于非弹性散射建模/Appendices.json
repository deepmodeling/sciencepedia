{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在通过一个最简化的模型来建立直观理解。我们将抽象的探针耦合强度 $\\gamma_{p}$ 与一个可测量的物理量——表观串联电阻——联系起来，从而揭示 Büttiker 探针作为散射中心的基本物理效应。通过分析这个单能级系统，你可以清晰地看到非弹性散射是如何增加器件电阻的 。",
            "id": "4266258",
            "problem": "考虑一个单共振能级纳米电子通道，代表新兴二维半导体中的一个短程传导态，由一个能量为 $E_{0}$ 的局域格点描述，并与两个宏观电极——左（$L$）和右（$R$）——在宽带极限下耦合。左、右电极的特征是与能量无关的能级展宽（耦合强度）分别为 $\\gamma_{L}0$ 和 $\\gamma_{R}0$。此外，一个 Markus Büttiker 意义下的理想退相电压探针（Büttiker 探针）以耦合强度 $\\gamma_{p}0$ 连接到同一共振能级，用于模拟非弹性散射。因此，总能级展宽为 $\\Gamma=\\gamma_{L}+\\gamma_{R}+\\gamma_{p}$。假设零温且在费米能量 $E=E_{F}$ 处为线性响应，并设置 $E_{F}=E_{0}$（共振）。\n\n你可以使用以下基础要素：\n- 线性响应的 Landauer–Büttiker 多端电流关系：对于化学势由电压 $V_{\\alpha}$ 参数化的电极 $\\alpha$，电流为 $I_{\\alpha}=(2e^{2}/h)\\sum_{\\beta}T_{\\alpha\\beta}(V_{\\alpha}-V_{\\beta})$，其中 $T_{\\alpha\\beta}$ 是从电极 $\\beta$ 到 $\\alpha$ 的透射概率。\n- 在宽带极限下的非平衡格林函数（NEGF）形式理论中，单个能级在电极 $\\alpha$ 和 $\\beta$ 之间的能量分辨透射率为 $T_{\\alpha\\beta}(E)=\\Gamma_{\\alpha}\\Gamma_{\\beta}|G^{r}(E)|^{2}$，其中 $G^{r}(E)=[E-E_{0}+\\mathrm{i}\\Gamma/2]^{-1}$ 且 $\\Gamma_{\\alpha}\\in\\{\\gamma_{L},\\gamma_{R},\\gamma_{p}\\}$ 是由相应电极引起的能级展宽。\n\n必须选择探针电压 $V_{p}$，以使流入探针的净电流为零，即 $I_{p}=0$。\n\n任务：\n1. 从给定的基础要素出发，推导在 Büttiker 探针存在时，左右电极间的两端线性响应电导 $G$，并用 $\\gamma_{L}$、$\\gamma_{R}$ 和 $\\gamma_{p}$ 在共振（$E=E_{0}$）时表示。不要在没有推导的情况下假设任何“捷径”多端公式。\n2. 定义没有探针时（即 $\\gamma_{p}=0$）同一系统的基线两端电导 $G_{0}$。定义由探针引起的表观串联电阻，\n$$R_{\\mathrm{app}}=\\frac{1}{G}-\\frac{1}{G_{0}},$$\n并证明对于任何 $\\gamma_{p}0$ 它都严格为正。以闭合形式给出 $R_{\\mathrm{app}}$。\n3. 一个设计准则是确保探针引起的表观串联电阻不超过电阻量子 $R_{q}=h/(2e^{2})$ 的一个分数 $\\varepsilon$（其中 $0\\varepsilon1$），即 $R_{\\mathrm{app}}\\leq \\varepsilon R_{q}$。推导满足此不等式的最大允许探针耦合 $\\gamma_{p}^{\\max}$ 的闭合形式表达式。\n\n你的最终答案必须是关于 $\\varepsilon$、$\\gamma_{L}$ 和 $\\gamma_{R}$ 的 $\\gamma_{p}^{\\max}$ 的单一闭合形式表达式。不需要数值近似，最终方框内的表达式不应包含单位。所有中间数学表达式必须用 LaTeX 书写。",
            "solution": "问题陈述已经过验证并被认为是有效的。它在科学上基于 Landauer–Büttiker 和非平衡格林函数（NEGF）形式理论，这些是纳米电子学中的标准理论框架。该问题是适定的，提供了所有必要的数据和条件，并且没有矛盾、歧义或主观性论断。这些任务是顺序的，并导向一个唯一的、可验证的解。\n\n我们将按照要求，根据三个指定的任务进行推导。\n\n### 任务1：两端电导 $G$ 的推导\n\n系统由三个电极组成：左（$L$）、右（$R$）和 Büttiker 探针（$p$）。在线性响应区，每个电极 $\\alpha \\in \\{L, R, p\\}$ 中的电流由 Landauer–Büttiker 关系给出：\n$$I_{\\alpha} = \\frac{2e^2}{h} \\sum_{\\beta \\in \\{L, R, p\\}} T_{\\alpha\\beta} (V_{\\alpha} - V_{\\beta})$$\n令 $G_{q} = 2e^2/h$ 表示量子电导。三个电极中的电流为：\n$$I_{L} = G_{q} \\left[ T_{LR}(V_{L} - V_{R}) + T_{Lp}(V_{L} - V_{p}) \\right]$$\n$$I_{R} = G_{q} \\left[ T_{RL}(V_{R} - V_{L}) + T_{Rp}(V_{R} - V_{p}) \\right]$$\n$$I_{p} = G_{q} \\left[ T_{pL}(V_{p} - V_{L}) + T_{pR}(V_{p} - V_{R}) \\right]$$\nBüttiker 探针的定义条件是流入其中的净电流为零，即 $I_{p}=0$。这个条件模拟了一个电压探针，它散射电子，但不作为电荷载流子的净源或汇。\n$$I_{p} = G_{q} \\left[ T_{pL}(V_{p} - V_{L}) + T_{pR}(V_{p} - V_{R}) \\right] = 0$$\n由此，我们可以求解探针的浮动电势 $V_{p}$：\n$$V_{p} (T_{pL} + T_{pR}) = V_{L} T_{pL} + V_{R} T_{pR}$$\n$$V_{p} = \\frac{T_{pL} V_{L} + T_{pR} V_{R}}{T_{pL} + T_{pR}}$$\n左右电极之间的两端电流为 $I = I_{L} = -I_{R}$。我们将 $V_{p}$ 的表达式代入 $I_{L}$ 的方程中：\n$$I = I_{L} = G_{q} \\left[ T_{LR}(V_{L} - V_{R}) + T_{Lp}\\left(V_{L} - \\frac{T_{pL} V_{L} + T_{pR} V_{R}}{T_{pL} + T_{pR}}\\right) \\right]$$\n$$I = G_{q} \\left[ T_{LR}(V_{L} - V_{R}) + T_{Lp}\\left(\\frac{V_{L}(T_{pL} + T_{pR}) - (T_{pL} V_{L} + T_{pR} V_{R})}{T_{pL} + T_{pR}}\\right) \\right]$$\n$$I = G_{q} \\left[ T_{LR}(V_{L} - V_{R}) + T_{Lp}\\left(\\frac{V_{L} T_{pR} - V_{R} T_{pR}}{T_{pL} + T_{pR}}\\right) \\right]$$\n$$I = G_{q} (V_{L} - V_{R}) \\left[ T_{LR} + \\frac{T_{Lp} T_{pR}}{T_{pL} + T_{pR}} \\right]$$\n两端电导为 $G = I / (V_{L} - V_{R})$。因此，有效透射率 $T_{\\mathrm{eff}}$ 由方括号中的项给出：\n$$G = G_{q} \\left[ T_{LR} + \\frac{T_{Lp} T_{pR}}{T_{pL} + T_{pR}} \\right]$$\n接下来，我们计算在共振点 $E=E_{F}=E_{0}$ 时的透射概率 $T_{\\alpha\\beta}$。推迟格林函数为 $G^{r}(E) = [E - E_{0} + \\mathrm{i}\\Gamma/2]^{-1}$，其中 $\\Gamma = \\gamma_{L} + \\gamma_{R} + \\gamma_{p}$。在共振点（$E=E_{0}$）：\n$$G^{r}(E_{0}) = [0 - 0 + \\mathrm{i}\\Gamma/2]^{-1} = (\\mathrm{i}\\Gamma/2)^{-1} = -\\frac{2\\mathrm{i}}{\\Gamma}$$\n模的平方为：\n$$|G^{r}(E_{0})|^2 = \\left|-\\frac{2\\mathrm{i}}{\\Gamma}\\right|^2 = \\frac{4}{\\Gamma^2}$$\n透射概率由 $T_{\\alpha\\beta}(E) = \\Gamma_{\\alpha}\\Gamma_{\\beta}|G^{r}(E)|^2$ 给出。使用特定的耦合 $\\gamma_{\\alpha}$，我们有：\n$$T_{\\alpha\\beta}(E_{0}) = \\frac{4\\gamma_{\\alpha}\\gamma_{\\beta}}{\\Gamma^2}$$\n注意到 $T_{\\alpha\\beta} = T_{\\beta\\alpha}$。我们将这些代入电导 $G$ 的表达式中：\n$$G = G_{q} \\left[ \\frac{4\\gamma_{L}\\gamma_{R}}{\\Gamma^2} + \\frac{(\\frac{4\\gamma_{L}\\gamma_{p}}{\\Gamma^2})(\\frac{4\\gamma_{p}\\gamma_{R}}{\\Gamma^2})}{\\frac{4\\gamma_{L}\\gamma_{p}}{\\Gamma^2} + \\frac{4\\gamma_{R}\\gamma_{p}}{\\Gamma^2}} \\right]$$\n$$G = G_{q} \\left[ \\frac{4\\gamma_{L}\\gamma_{R}}{\\Gamma^2} + \\frac{\\frac{16\\gamma_{L}\\gamma_{R}\\gamma_{p}^2}{\\Gamma^4}}{\\frac{4\\gamma_{p}(\\gamma_{L}+\\gamma_{R})}{\\Gamma^2}} \\right] = G_{q} \\left[ \\frac{4\\gamma_{L}\\gamma_{R}}{\\Gamma^2} + \\frac{4\\gamma_{L}\\gamma_{R}\\gamma_{p}}{\\Gamma^2(\\gamma_{L}+\\gamma_{R})} \\right]$$\n提出公因式：\n$$G = G_{q} \\frac{4\\gamma_{L}\\gamma_{R}}{\\Gamma^2} \\left[ 1 + \\frac{\\gamma_{p}}{\\gamma_{L}+\\gamma_{R}} \\right] = G_{q} \\frac{4\\gamma_{L}\\gamma_{R}}{\\Gamma^2} \\left[ \\frac{\\gamma_{L}+\\gamma_{R}+\\gamma_{p}}{\\gamma_{L}+\\gamma_{R}} \\right]$$\n由于 $\\Gamma = \\gamma_{L}+\\gamma_{R}+\\gamma_{p}$，这可以简化为：\n$$G = G_{q} \\frac{4\\gamma_{L}\\gamma_{R}}{\\Gamma(\\gamma_{L}+\\gamma_{R})} = G_{q} \\frac{4\\gamma_{L}\\gamma_{R}}{(\\gamma_{L}+\\gamma_{R}+\\gamma_{p})(\\gamma_{L}+\\gamma_{R})}$$\n这就完成了第一个任务。\n\n### 任务2：表观串联电阻 $R_{\\mathrm{app}}$\n\n首先，我们确定没有探针时的基线电导 $G_{0}$，这对应于设置 $\\gamma_{p}=0$。在这种情况下，总展宽为 $\\Gamma_{0} = \\gamma_{L} + \\gamma_{R}$。电导就是 $G_{0} = G_{q} T_{LR,0}$。透射率为：\n$$T_{LR,0} = \\gamma_{L}\\gamma_{R} |G_{0}^{r}(E_0)|^2 = \\gamma_{L}\\gamma_{R} \\left|(\\mathrm{i}\\Gamma_{0}/2)^{-1}\\right|^2 = \\gamma_{L}\\gamma_{R} \\frac{4}{\\Gamma_{0}^2} = \\frac{4\\gamma_{L}\\gamma_{R}}{(\\gamma_{L}+\\gamma_{R})^2}$$\n所以基线电导为：\n$$G_{0} = G_{q} \\frac{4\\gamma_{L}\\gamma_{R}}{(\\gamma_{L}+\\gamma_{R})^2}$$\n这个结果也可以通过在我们的 $G$ 表达式中设置 $\\gamma_{p}=0$ 来获得。\n\n现在我们计算表观串联电阻 $R_{\\mathrm{app}} = 1/G - 1/G_{0}$。令 $R_{q} = 1/G_{q} = h/(2e^2)$ 为电阻量子。\n$$ \\frac{1}{G} = \\frac{1}{G_{q}} \\frac{(\\gamma_{L}+\\gamma_{R}+\\gamma_{p})(\\gamma_{L}+\\gamma_{R})}{4\\gamma_{L}\\gamma_{R}} = R_{q} \\frac{(\\gamma_{L}+\\gamma_{R})^2 + \\gamma_{p}(\\gamma_{L}+\\gamma_{R})}{4\\gamma_{L}\\gamma_{R}} $$\n$$ \\frac{1}{G_{0}} = \\frac{1}{G_{q}} \\frac{(\\gamma_{L}+\\gamma_{R})^2}{4\\gamma_{L}\\gamma_{R}} = R_{q} \\frac{(\\gamma_{L}+\\gamma_{R})^2}{4\\gamma_{L}\\gamma_{R}} $$\n将两个表达式相减得到 $R_{\\mathrm{app}}$：\n$$ R_{\\mathrm{app}} = \\frac{1}{G} - \\frac{1}{G_{0}} = R_{q} \\left[ \\frac{(\\gamma_{L}+\\gamma_{R})^2 + \\gamma_{p}(\\gamma_{L}+\\gamma_{R})}{4\\gamma_{L}\\gamma_{R}} - \\frac{(\\gamma_{L}+\\gamma_{R})^2}{4\\gamma_{L}\\gamma_{R}} \\right] $$\n$$ R_{\\mathrm{app}} = R_{q} \\frac{\\gamma_{p}(\\gamma_{L}+\\gamma_{R})}{4\\gamma_{L}\\gamma_{R}} $$\n为证明对于任何 $\\gamma_{p}0$，$R_{\\mathrm{app}}$ 都严格为正，我们分析此表达式。问题陈述 $\\gamma_{L}0$ 和 $\\gamma_{R}0$。电阻量子 $R_{q}=h/(2e^2)$ 是一个基本的正常数。在分数 $\\frac{\\gamma_{p}(\\gamma_{L}+\\gamma_{R})}{4\\gamma_{L}\\gamma_{R}}$ 中，分子 $\\gamma_{p}(\\gamma_{L}+\\gamma_{R})$ 是正项的乘积，所以为正。分母 $4\\gamma_{L}\\gamma_{R}$ 也是正项的乘积，因此也为正。两个正数的比值为正，因此对于所有 $\\gamma_p0$，$R_{\\mathrm{app}}  0$。这表明退相探针总是会给通道增加电阻。\n\n### 任务3：最大允许探针耦合 $\\gamma_{p}^{\\max}$\n\n设计准则施加了约束条件 $R_{\\mathrm{app}} \\leq \\varepsilon R_{q}$，其中 $0  \\varepsilon  1$。我们将 $R_{\\mathrm{app}}$ 的表达式代入这个不等式中：\n$$ R_{q} \\frac{\\gamma_{p}(\\gamma_{L}+\\gamma_{R})}{4\\gamma_{L}\\gamma_{R}} \\leq \\varepsilon R_{q} $$\n由于 $R_{q}  0$，我们可以在不等式两边同除以 $R_{q}$ 而不改变不等号的方向：\n$$ \\frac{\\gamma_{p}(\\gamma_{L}+\\gamma_{R})}{4\\gamma_{L}\\gamma_{R}} \\leq \\varepsilon $$\n我们现在求解 $\\gamma_{p}$。乘以 $\\gamma_p$ 的项是 $(\\gamma_L+\\gamma_R)/(4\\gamma_L\\gamma_R)$，它是正的。\n$$ \\gamma_{p} \\leq \\varepsilon \\frac{4\\gamma_{L}\\gamma_{R}}{\\gamma_{L}+\\gamma_{R}} $$\n最大允许探针耦合 $\\gamma_{p}^{\\max}$ 是使该不等式饱和的值：\n$$ \\gamma_{p}^{\\max} = \\frac{4\\varepsilon\\gamma_{L}\\gamma_{R}}{\\gamma_{L}+\\gamma_{R}} $$\n这个表达式给出了在保持附加电阻低于电阻量子的指定分数 $\\varepsilon$ 的同时，可以容忍的与 Büttiker 探针的最大耦合。这就完成了最终所需表达式的推导。",
            "answer": "$$\\boxed{\\frac{4 \\varepsilon \\gamma_{L} \\gamma_{R}}{\\gamma_{L} + \\gamma_{R}}}$$"
        },
        {
            "introduction": "在理解了探针在单能级系统中的基本作用后，我们现在转向一个更接近实际的空间扩展系统。这个练习将帮助你区分直接的相干隧穿路径和由退相干探针介导的非相干路径，这需要你运用矩阵格林函数方法进行更复杂的分析 。通过推导这个三站点链的有效透射，你将更深入地掌握 Büttiker 探针如何影响多路径量子干涉。",
            "id": "4266178",
            "problem": "考虑一个由最近邻紧束缚哈密顿量描述的包含$3$个位点（标记为$1\\text{--}2\\text{--}3$）的一维链，其在位能为$0$，相邻位点间的跃迁振幅为$t$。位点$1$与耦合强度为$\\Gamma_{L}$的左电子库（电极）相连，位点$3$与耦合强度为$\\Gamma_{R}$的右电子库相连，位点$2$与耦合强度为$\\Gamma_{p}$的Büttiker退相干探针相连。假设电子库和Büttiker探针在宽带极限下描述，并且输运过程通过非平衡格林函数（NEGF）形式理论进行评估。该系统在零温及围绕共同平衡化学势$\\mu=0$的线性响应区中进行研究，施加一个微小偏压，使得左右电子库的化学势分别为$\\mu_{L}=\\delta\\mu$和$\\mu_{R}=-\\delta\\mu$，其中$|\\delta\\mu|$很小。Büttiker探针被视为一个电压探针，其分布函数被调整以满足电流守恒，即流入探针的净电流为零。\n\n从适用于此背景的第一性原理出发，即：\n- 由$G^{r}(E)=\\left[E I - H - \\Sigma^{r}(E)\\right]^{-1}$定义的推迟格林函数$G^{r}(E)$，其中$H$是紧束缚哈密顿量，$\\Sigma^{r}(E)$是来自左电极、右电极和探针的推迟自能之和，\n- 谱耦合矩阵$\\Gamma_{\\alpha}(E)=i\\left[\\Sigma_{\\alpha}^{r}(E)-\\Sigma_{\\alpha}^{a}(E)\\right]$，对于$\\alpha\\in\\{L,R,p\\}$，\n- 与NEGF一致的多端Landauer–Büttiker (LB) 线性响应电流关系，以及\n- 流入探针的净电流为零的Büttiker探针 (BP) 条件，\n\n推导在能量$E=0$时每个位点上的局域非平衡占据数和键电流分布，并分析探针的存在如何改变从左电极到右电极的有效两端透射。为明确起见，设在宽带极限下，连接到端$\\alpha$的位点$i$上的推迟自能为$\\Sigma_{\\alpha}^{r}(E)=-i\\,\\Gamma_{\\alpha}/2$，而在其他地方为零，其中$\\Gamma_{\\alpha}$与能量无关。\n\n您的最终任务是在施加Büttiker探针条件后，为能量$E=0$时的有效两端透射提供一个闭式解析表达式。请将最终答案表示为$t$、$\\Gamma_{L}$、$\\Gamma_{R}$和$\\Gamma_{p}$的函数。无需进行数值计算，最终表达式中不应包含单位。",
            "solution": "首先验证该问题，确认其为纳米电子学领域中一个适定且有科学依据的问题。因此，我们可以进行完整的推导。\n\n该系统是一个$3$位点的紧束缚链，在位点基$\\{|1\\rangle, |2\\rangle, |3\\rangle\\}$下由哈密顿矩阵$H$描述。在位能为零、最近邻跃迁振幅为$-t$的情况下，哈密顿量为：\n$$\nH = \\begin{pmatrix} 0  -t  0 \\\\ -t  0  -t \\\\ 0  -t  0 \\end{pmatrix}\n$$\n系统与三个端（左、右和探针）耦合。在宽带近似下，每个端$\\alpha \\in \\{L, R, p\\}$的推迟自能是一个常数矩阵。自能$\\Sigma^r_\\alpha(E)$仅在耦合位点处非零。具体来说，位点$1$与电极L耦合，位点$2$与探针p耦合，位点$3$与电极R耦合。\n$$\n\\Sigma_{L}^{r}(E) = \\begin{pmatrix} -i\\frac{\\Gamma_L}{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad\n\\Sigma_{p}^{r}(E) = \\begin{pmatrix} 0  0  0 \\\\ 0  -i\\frac{\\Gamma_p}{2}  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad\n\\Sigma_{R}^{r}(E) = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  -i\\frac{\\Gamma_R}{2} \\end{pmatrix}\n$$\n总的推迟自能为$\\Sigma^{r}(E) = \\Sigma_{L}^{r}(E) + \\Sigma_{p}^{r}(E) + \\Sigma_{R}^{r}(E)$。系统的推迟格林函数由下式给出：\n$$\nG^{r}(E) = \\left[E I - H - \\Sigma^{r}(E)\\right]^{-1}\n$$\n我们关心的是能量$E=0$（对应于平衡化学势）时的输运性质。在$E=0$时，需要求逆的矩阵是：\n$$\nM = \\left[0 \\cdot I - H - \\Sigma^{r}(0)\\right] = -H - \\Sigma^{r}(0) = \\begin{pmatrix} i\\frac{\\Gamma_L}{2}  t  0 \\\\ t  i\\frac{\\Gamma_p}{2}  t \\\\ 0  t  i\\frac{\\Gamma_R}{2} \\end{pmatrix}\n$$\n从电极$\\beta$流向电极$\\alpha$的电流由Landauer-Büttiker公式给出。对于零温下的线性响应，流入电极$\\alpha$的净电流为$I_\\alpha = \\frac{e^2}{h} \\sum_{\\beta \\neq \\alpha} T_{\\beta \\alpha}(\\mu_\\alpha - \\mu_\\beta)$，其中$\\mu_\\alpha$是电极$\\alpha$的化学势，$T_{\\beta \\alpha}$是从电极$\\beta$到电极$\\alpha$的透射概率。在NEGF形式理论中，透射由下式给出：\n$$\nT_{\\beta \\alpha}(E) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha}(E) G^{r}(E) \\Gamma_{\\beta}(E) G^{a}(E)\\right]\n$$\n此处，$G^{a}(E) = [G^{r}(E)]^{\\dagger}$是超前格林函数，$\\Gamma_{\\alpha}(E) = i\\left[\\Sigma_{\\alpha}^{r}(E)-\\Sigma_{\\alpha}^{a}(E)\\right]$是谱耦合矩阵。在宽带极限下，$\\Sigma^a_\\alpha = (\\Sigma^r_\\alpha)^\\dagger = i\\Gamma_\\alpha/2$，因此$\\Gamma_\\alpha$是一个对角矩阵，在耦合位点的位置上元素为常数$\\Gamma_\\alpha$，其他位置为零。例如，$(\\Gamma_L)_{11} = \\Gamma_L$。\n\nBüttiker探针条件要求流入探针的净电流为零，$I_p=0$。设化学势为$\\mu_L = \\delta\\mu$、$\\mu_R = -\\delta\\mu$和一个未知的$\\mu_p$，该条件为：\n$$\nI_p = \\frac{e^2}{h} \\left[ T_{Lp}(\\mu_p - \\mu_L) + T_{Rp}(\\mu_p - \\mu_R) \\right] = 0\n$$\n这使我们能够解出探针电势：$\\mu_p(T_{Lp} + T_{Rp}) = T_{Lp}\\mu_L + T_{Rp}\\mu_R$，得到$\\mu_p = \\frac{T_{Lp}\\mu_L + T_{Rp}\\mu_R}{T_{Lp} + T_{Rp}}$。\n\n流出左电极的电流为$I_L = I_{LR} + I_{Lp}$。\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{RL}(\\mu_L - \\mu_R) + T_{pL}(\\mu_L - \\mu_p) \\right]\n$$\n使用$T_{\\alpha\\beta}=T_{\\beta\\alpha}$并代入$\\mu_p$的表达式：\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{LR}(\\mu_L - \\mu_R) + T_{Lp}\\left(\\mu_L - \\frac{T_{Lp}\\mu_L + T_{Rp}\\mu_R}{T_{Lp} + T_{Rp}}\\right) \\right]\n$$\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{LR}(\\mu_L - \\mu_R) + T_{Lp}\\frac{(\\mu_L T_{Lp} + \\mu_L T_{Rp}) - (T_{Lp}\\mu_L + T_{Rp}\\mu_R)}{T_{Lp} + T_{Rp}} \\right]\n$$\n$$\nI_L = \\frac{e^2}{h} \\left[ T_{LR}(\\mu_L - \\mu_R) + \\frac{T_{Lp}T_{Rp}}{T_{Lp} + T_{Rp}}(\\mu_L - \\mu_R) \\right]\n$$\n总电流为$I_L = \\frac{e^2}{h} T_{eff}(\\mu_L - \\mu_R)$，其中有效两端透射为：\n$$\nT_{eff} = T_{LR} + \\frac{T_{Lp} T_{Rp}}{T_{Lp} + T_{Rp}}\n$$\n该表达式描述了输运如何在直接的相干路径（$T_{LR}$）和通过退相干探针的间接非相干路径之间分配。\n\n为了找到$T_{eff}$，我们必须计算在$E=0$时的各个透射$T_{LR}$、$T_{Lp}$和$T_{Rp}$。这需要对矩阵$M$求逆以得到$G^r(0)$。$M$的行列式为：\n$$\n\\det(M) = (i\\Gamma_L/2)[(i\\Gamma_p/2)(i\\Gamma_R/2) - t^2] - t[t(i\\Gamma_R/2)] = -\\frac{i}{8}(\\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R))\n$$\n我们定义一个实值量$K = \\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R)$，所以$\\det(M) = -iK/8$。$G^r(0) = M^{-1} = \\frac{\\mathrm{adj}(M)}{\\det(M)}$所需的矩阵元为：\n$G^r_{31}(0) = \\frac{C_{13}}{\\det(M)} = \\frac{t^2}{-iK/8} = \\frac{8it^2}{K}$\n$G^r_{21}(0) = \\frac{C_{12}}{\\det(M)} = \\frac{-t(i\\Gamma_R/2)}{-iK/8} = \\frac{4t\\Gamma_R}{K}$\n$G^r_{23}(0) = \\frac{C_{32}}{\\det(M)} = \\frac{-t(i\\Gamma_L/2)}{-iK/8} = \\frac{4t\\Gamma_L}{K}$\n其中$C_{ij}$是$M$的代数余子式。\n\n透射计算公式为$T_{\\beta\\alpha} = \\Gamma_\\beta \\Gamma_\\alpha |G^r_{\\beta\\alpha}(0)|^2$，其中$G^r$上的索引指的是位点。\n$$\nT_{LR} = \\Gamma_L \\Gamma_R |G^r_{31}(0)|^2 = \\Gamma_L \\Gamma_R \\left| \\frac{8it^2}{K} \\right|^2 = \\frac{64 t^4 \\Gamma_L \\Gamma_R}{K^2}\n$$\n$$\nT_{Lp} = \\Gamma_L \\Gamma_p |G^r_{21}(0)|^2 = \\Gamma_L \\Gamma_p \\left| \\frac{4t\\Gamma_R}{K} \\right|^2 = \\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2}\n$$\n$$\nT_{Rp} = \\Gamma_R \\Gamma_p |G^r_{23}(0)|^2 = \\Gamma_R \\Gamma_p \\left| \\frac{4t\\Gamma_L}{K} \\right|^2 = \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}\n$$\n现在我们计算$T_{eff}$中的第二项：\n$$\n\\frac{T_{Lp} T_{Rp}}{T_{Lp} + T_{Rp}} = \\frac{\\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2} \\cdot \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}}{\\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2} + \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}} = \\frac{\\frac{256 t^4 \\Gamma_p^2 \\Gamma_L^3 \\Gamma_R^3}{K^4}}{\\frac{16 t^2 \\Gamma_p \\Gamma_L \\Gamma_R (\\Gamma_R + \\Gamma_L)}{K^2}} = \\frac{16 t^2 \\Gamma_p \\Gamma_L^2 \\Gamma_R^2}{K^2 (\\Gamma_L + \\Gamma_R)}\n$$\n最后，我们将两部分的贡献相加得到$T_{eff}$：\n$$\nT_{eff} = \\frac{64 t^4 \\Gamma_L \\Gamma_R}{K^2} + \\frac{16 t^2 \\Gamma_p \\Gamma_L^2 \\Gamma_R^2}{K^2 (\\Gamma_L + \\Gamma_R)} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{K^2 (\\Gamma_L + \\Gamma_R)} \\left[ 4 t^2 (\\Gamma_L + \\Gamma_R) + \\Gamma_p \\Gamma_L \\Gamma_R \\right]\n$$\n方括号中的项正是$K$的定义。\n$$\nT_{eff} = \\frac{16 t^2 \\Gamma_L \\Gamma_R \\cdot K}{K^2 (\\Gamma_L + \\Gamma_R)} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{K (\\Gamma_L + \\Gamma_R)}\n$$\n将$K = \\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R)$代回，我们得到有效透射的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{16 t^{2} \\Gamma_{L} \\Gamma_{R}}{(\\Gamma_{L} \\Gamma_{p} \\Gamma_{R} + 4t^{2}(\\Gamma_{L} + \\Gamma_{R}))(\\Gamma_{L} + \\Gamma_{R})}}\n$$"
        },
        {
            "introduction": "理论分析虽然强大，但数值模拟对于研究复杂器件和探索解析解难以处理的场景至关重要。本练习作为一个“计算实验室”，旨在锻炼你将 NEGF-Büttiker 探针理论框架转化为可执行代码的能力。你将通过编程来模拟探针在不同位置时对电流的影响，从而直观地验证散射效应的局域性 。",
            "id": "4266098",
            "problem": "您需要编写一个完整且可运行的程序，计算当一个 Büttiker 探针从体材料中的某个位置移动到靠近电极的位置时，相干一维紧束缚链中的稳态器件电流如何变化。该器件被建模为一个包含 $N$ 个格点的线性链，格点间存在最近邻跃迁。左右金属电极通过末端格点上的宽带自能进行建模。Büttiker 探针被建模为耦合到单个格点的第三个宽带终端，其电化学势的选择需满足流入探针的净电流为零（电压探针极限，代表非弹性弛豫）。使用零温、线性响应输运模型。\n\n从以下基本理论出发：\n- 零温线性响应下的多终端 Landauer–Büttiker 关系：对于终端 $\\alpha$，电流为 $I_{\\alpha} = \\left(g_s e^2/h\\right) \\sum_{\\beta} T_{\\alpha\\beta}\\left(V_{\\alpha}-V_{\\beta}\\right)$，其中 $g_s$ 是自旋简并度，$e$ 是元电荷，$h$ 是普朗克常数，$T_{\\alpha\\beta}$ 是在费米能 $E_F$ 处从终端 $\\beta$ 到 $\\alpha$ 的透射率，$V_{\\alpha}$ 是终端 $\\alpha$ 的电势（单位：伏特）。\n- 非平衡格林函数框架中的 Caroli 透射率公式：$T_{\\alpha\\beta}(E_F) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha} G^r(E_F)\\,\\Gamma_{\\beta} G^a(E_F)\\right]$，其中 $G^r$ 和 $G^a$ 是包含所有自能的器件的推迟和超前格林函数，而 $\\Gamma_{\\alpha} = i\\left(\\Sigma_{\\alpha} - \\Sigma_{\\alpha}^{\\dagger}\\right)$ 是终端 $\\alpha$ 的展宽矩阵。\n- 器件的推迟格林函数：$G^r(E_F) = \\left[E_F I - H - \\sum_{\\alpha}\\Sigma_{\\alpha}\\right]^{-1}$，其中 $H$ 是器件哈密顿量，$\\Sigma_{\\alpha}$ 是宽带极限下的终端自能。\n\n器件模型与约定：\n- 器件哈密顿量 $H$ 是一个 $N\\times N$ 的三对角矩阵，其在位能为 $0$，最近邻跃迁为 $-t$（能量单位：电子伏特）。\n- 左（右）电极仅耦合到格点索引为 $0$（格点索引为 $N-1$）的格点，其宽带自能分别为在格点 $0$ 处的 $\\Sigma_L = -i \\Gamma_L/2$ 和在格点 $N-1$ 处的 $\\Sigma_R = -i \\Gamma_R/2$，其中 $\\Gamma_L$ 和 $\\Gamma_R$ 是正的常数，单位为电子伏特。\n- Büttiker 探针精确地耦合到一个由整数位置 $p$ 索引的格点上，该格点上的宽带自能为 $\\Sigma_p = -i \\Gamma_p/2$。探针电势 $V_p$ 由零温下同样线性响应定律所要求的零电流条件 $I_p=0$ 决定。\n- 使用自旋简并度 $g_s = 2$。使用位于器件能带内的费米能 $E_F$（能量单位：电子伏特）。施加一个小的对称偏压，使得 $V_L = +V/2$ 且 $V_R = -V/2$，其中 $V$ 是施加的源漏偏压（单位：伏特）。\n- 对晶格格点使用从零开始的索引：左电极位于格点 $0$，右电极位于格点 $N-1$，“近电极”探针位置为格点 $1$，“体材料”探针位置为格点 $\\lfloor N/2 \\rfloor$。\n\n您的程序必须：\n- 对于每个测试用例，计算探针在体材料位置时的稳态器件电流 $I_{\\text{bulk}}$（从左到右流动）和探针在近电极位置时的稳态器件电流 $I_{\\text{near}}$，单位均为安培。然后计算差值 $\\Delta I = I_{\\text{bulk}} - I_{\\text{near}}$，单位为安培。\n- 严格使用费米能 $E_F$ 处的零温、线性响应表达式，不要进行任何能量平均。\n- 如果矩阵求逆需要，通过添加一个小的正虚数无穷小量 $i\\eta$（其中 $\\eta \\ll 1$，单位为电子伏特）来确保数值稳定性。选择足够小的 $\\eta$ 以免影响物理结果。\n- 对每个测试用例，以安培为单位给出最终数值答案，每个答案均四舍五入到 $6$ 位有效数字。\n\n测试集：\n- 用例 $1$（正常路径）：$N=10$，$t=1.0$ eV，$\\Gamma_L=0.5$ eV，$\\Gamma_R=0.5$ eV，$\\Gamma_p=0.2$ eV，$E_F=0.0$ eV，$V=0.01$ V。\n- 用例 $2$（弱探针，近弹道输运极限）：$N=10$，$t=1.0$ eV，$\\Gamma_L=0.5$ eV，$\\Gamma_R=0.5$ eV，$\\Gamma_p=1.0\\times 10^{-6}$ eV，$E_F=0.0$ eV，$V=0.01$ V。\n- 用例 $3$（非对称电极）：$N=12$，$t=1.0$ eV，$\\Gamma_L=0.05$ eV，$\\Gamma_R=1.0$ eV，$\\Gamma_p=0.5$ eV，$E_F=0.0$ eV，$V=0.01$ V。\n- 用例 $4$（短链，强探针，较大偏压）：$N=4$，$t=0.5$ eV，$\\Gamma_L=0.5$ eV，$\\Gamma_R=0.5$ eV，$\\Gamma_p=1.0$ eV，$E_F=0.0$ eV，$V=0.02$ V。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含测试集的结果，格式为方括号内由逗号分隔的列表，顺序与上文一致。例如，格式必须完全如下：[$\\Delta I_1$,$\\Delta I_2$,$\\Delta I_3$,$\\Delta I_4$]，其中每个 $\\Delta I_k$ 是一个浮点数，单位为安培，并四舍五入到 $6$ 位有效数字。\n- 所有电流必须以安培为单位报告。",
            "solution": "该问题是有效的，因为它科学地基于量子输运理论的既定原理（Landauer-Büttiker 形式和非平衡格林函数），其参数和方程的设定是完整且一致的，问题是良定的，并以客观、正式的语言表述。因此，我们可以着手求解。\n\n问题要求计算当一个 Büttiker 探针从“体材料”位置移动到“近电极”位置时，稳态器件电流的变化量 $\\Delta I = I_{\\text{bulk}} - I_{\\text{near}}$。该器件是一个由 $N$ 个格点构成的一维紧束缚链，连接到左（L）和右（R）电极，探针（p）作为第三个终端。\n\n我们计算的基础是零温和线性响应机制下的多终端 Landauer-Büttiker 电流公式，对于终端 $\\alpha$：\n$$I_{\\alpha} = \\frac{g_s e^2}{h} \\sum_{\\beta} T_{\\alpha\\beta}(E_F) (V_{\\alpha} - V_{\\beta})$$\n此处，$g_s=2$ 是自旋简并度，$e$ 是元电荷，$h$ 是普朗克常数，$V_{\\alpha}$ 是终端 $\\alpha$ 的电压，$T_{\\alpha\\beta}(E_F)$ 是在费米能 $E_F$ 处从终端 $\\beta$ 到 $\\alpha$ 的透射概率。终端为 $\\alpha, \\beta \\in \\{L, R, p\\}$。施加的偏压是对称的：$V_L = +V/2$ 和 $V_R = -V/2$。Büttiker 探针的电势 $V_p$ 由流入其中的净电流为零的条件 $I_p=0$ 决定。\n\n首先，我们确定探针电势 $V_p$。条件 $I_p=0$ 得出：\n$$I_p = \\frac{g_s e^2}{h} \\left[ T_{pL}(V_p - V_L) + T_{pR}(V_p - V_R) \\right] = 0$$\n注意，$\\beta=p$ 的项为 $T_{pp}(V_p-V_p)=0$。求解 $V_p$：\n$$V_p(T_{pL} + T_{pR}) = T_{pL}V_L + T_{pR}V_R$$\n$$V_p = \\frac{T_{pL}V_L + T_{pR}V_R}{T_{pL} + T_{pR}}$$\n这里我们使用了在无磁场情况下的透射互易性，$T_{\\alpha\\beta} = T_{\\beta\\alpha}$。\n\n接下来，我们计算器件电流，即从左电极流出的电流 $I_L$。根据电流守恒，$I_L+I_R+I_p=0$。由于 $I_p=0$，我们有 $I_L = -I_R$，因此 $I_L$ 代表流过器件的净电流。\n$$I_L = \\frac{g_s e^2}{h} \\left[ T_{LR}(V_L - V_R) + T_{Lp}(V_L - V_p) \\right]$$\n将 $V_p$ 的表达式代入：\n$$I_L = \\frac{g_s e^2}{h} \\left[ T_{LR}(V_L - V_R) + T_{Lp} \\left( V_L - \\frac{T_{pL}V_L + T_{pR}V_R}{T_{pL} + T_{pR}} \\right) \\right]$$\n使用 $T_{Lp} = T_{pL}$ 并简化括号中的项：\n$$V_L - \\frac{T_{Lp}V_L + T_{pR}V_R}{T_{Lp} + T_{pR}} = \\frac{V_L(T_{Lp} + T_{pR}) - (T_{Lp}V_L + T_{pR}V_R)}{T_{Lp} + T_{pR}} = \\frac{T_{pR}(V_L - V_R)}{T_{Lp} + T_{pR}}$$\n将此结果代回 $I_L$ 的表达式中：\n$$I_L = \\frac{g_s e^2}{h} \\left[ T_{LR}(V_L - V_R) + T_{Lp} \\frac{T_{pR}(V_L - V_R)}{T_{Lp} + T_{pR}} \\right]$$\n令 $V = V_L - V_R$ 和 $G_0 = g_s e^2 / h$，器件电流为：\n$$I_{\\text{device}} = G_0 V \\left( T_{LR} + \\frac{T_{Lp} T_{pR}}{T_{Lp} + T_{pR}} \\right)$$\n这个核心方程表明，探针引入了一个额外的输运路径，其有效透射率被加到直接透射率 $T_{LR}$ 上。注意，如果 $\\Gamma_p=0$，那么 $T_{Lp}=T_{pR}=0$，我们就回到了两终端的结果 $I = G_0 V T_{LR}$。\n\n计算的核心是使用非平衡格林函数 (NEGF) 形式论来找到透射概率 $T_{\\alpha\\beta}$。Caroli 公式给出了透射率：\n$$T_{\\alpha\\beta}(E_F) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha} G^r(E_F)\\,\\Gamma_{\\beta} G^a(E_F)\\right]$$\n其中 $G^r$ 和 $G^a$ 是推迟和超前格林函数，$\\Gamma_{\\alpha}$ 是终端 $\\alpha$ 的展宽矩阵。\n展宽矩阵由 $\\Gamma_{\\alpha} = i(\\Sigma_{\\alpha} - \\Sigma_{\\alpha}^{\\dagger})$ 给出。对于在格点 $0$ 处的宽带自能 $\\Sigma_L = -i\\Gamma_L/2$、在格点 $N-1$ 处的 $\\Sigma_R = -i\\Gamma_R/2$ 以及在格点 $p$ 处的 $\\Sigma_p = -i\\Gamma_p/2$，展宽矩阵是对角的，只有一个非零元素：$(\\Gamma_{\\alpha})_{s_\\alpha, s_\\alpha} = \\Gamma_{\\alpha}$，其中 $s_\\alpha$ 是终端 $\\alpha$ 耦合的格点（$s_L=0$, $s_R=N-1$, $s_p$ 是探针位置）。\n在这些条件下，迹（trace）简化为：\n$$T_{\\alpha\\beta} = \\Gamma_\\alpha \\Gamma_\\beta |G^r_{s_\\alpha, s_\\beta}|^2$$\n其中 $G^r_{s_\\alpha, s_\\beta}$ 是推迟格林函数矩阵中连接电极 $\\alpha$ 所在格点与电极 $\\beta$ 所在格点的矩阵元。\n\n推迟格林函数通过对系统的有效哈密顿矩阵求逆来计算：\n$$G^r(E_F) = \\left[E_F I - H - \\sum_{\\alpha \\in \\{L, R, p\\}} \\Sigma_{\\alpha}\\right]^{-1}$$\n其中 $I$ 是 $N \\times N$ 的单位矩阵，$H$ 是器件哈密顿量。$H$ 是一个在位能为零、最近邻跃迁为 $-t$ 的三对角矩阵。令 $M = E_F I - H - \\sum_{\\alpha} \\Sigma_{\\alpha}$。其矩阵元为：\n对于 $i \\in \\{0, \\dots, N-2\\}$，$M_{i,i+1} = M_{i+1,i} = t$。\n对于 $i \\notin \\{0, N-1, p\\}$，$M_{i,i} = E_F$。\n电极耦合格点上的对角元被自能修正：\n$M_{0,0} = E_F - (\\Sigma_L)_{0,0} - (\\Sigma_p)_{0,0} = E_F + i\\Gamma_L/2 + i\\delta_{0,p}\\Gamma_p/2$\n$M_{N-1,N-1} = E_F - (\\Sigma_R)_{N-1,N-1} - (\\Sigma_p)_{N-1,N-1} = E_F + i\\Gamma_R/2 + i\\delta_{N-1,p}\\Gamma_p/2$\n对于 $p \\notin \\{0, N-1\\}$，$M_{p,p} = E_F - (\\Sigma_p)_{p,p} = E_F + i\\Gamma_p/2$。\n用于数值稳定性的项 $i\\eta$ 由自能的虚部自动提供，前提是至少有一个 $\\Gamma_\\alpha  0$。\n\n每个测试用例的总体算法是：\n1. 定义参数：$N, t, \\Gamma_L, \\Gamma_R, \\Gamma_p, E_F, V$。\n2. 定义探针位置：$p_{\\text{near}} = 1$ 和 $p_{\\text{bulk}} = \\lfloor N/2 \\rfloor$。\n3. 对于每个位置 $p \\in \\{p_{\\text{near}}, p_{\\text{bulk}}\\}$：\n    a. 构建 $N \\times N$ 的复数矩阵 $M$。\n    b. 计算 $G^r = M^{-1}$。\n    c. 提取 $G^r$ 的必要矩阵元：$G^r_{0,N-1}$，$G^r_{0,p}$ 和 $G^r_{p,N-1}$。\n    d. 计算透射率：$T_{LR} = \\Gamma_L \\Gamma_R |G^r_{0,N-1}|^2$，$T_{Lp} = \\Gamma_L \\Gamma_p |G^r_{0,p}|^2$，$T_{pR} = \\Gamma_p \\Gamma_R |G^r_{p,N-1}|^2$。\n    e. 使用推导出的公式计算电流 $I(p)$。\n4. 计算差值 $\\Delta I = I(p_{\\text{bulk}}) - I(p_{\\text{near}})$。\n5. 以安培为单位报告 $\\Delta I$，四舍五入到 6 位有效数字。\n\n使用的物理常数为 $e = 1.602176634 \\times 10^{-19}$ C 和 $h = 6.62607015 \\times 10^{-34}$ J$\\cdot$s。\n电导量子为 $G_0 = 2e^2/h \\approx 7.748091729 \\times 10^{-5}$ A/V。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It calculates the change in current when a Büttiker probe is moved.\n    \"\"\"\n    \n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    h = 6.62607015e-34    # Planck's constant in J*s\n    G0 = 2 * e**2 / h      # Conductance quantum with spin degeneracy g_s=2, in A/V (Siemens)\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: happy path\n        {'N': 10, 't': 1.0, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 0.2, 'E_F': 0.0, 'V': 0.01},\n        # Case 2: weak probe, near-ballistic limit\n        {'N': 10, 't': 1.0, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 1.0e-6, 'E_F': 0.0, 'V': 0.01},\n        # Case 3: asymmetric contacts\n        {'N': 12, 't': 1.0, 'Gamma_L': 0.05, 'Gamma_R': 1.0, 'Gamma_p': 0.5, 'E_F': 0.0, 'V': 0.01},\n        # Case 4: short chain, stronger probe, larger bias\n        {'N': 4, 't': 0.5, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 1.0, 'E_F': 0.0, 'V': 0.02},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        p_bulk = params['N'] // 2\n        p_near = 1\n        \n        I_bulk = calculate_current(params, p_bulk, G0)\n        I_near = calculate_current(params, p_near, G0)\n        \n        delta_I = I_bulk - I_near\n        results.append(f\"{delta_I:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n\ndef calculate_current(params, p_probe, G0):\n    \"\"\"\n    Calculates the steady-state current for a given set of device parameters and probe position.\n    \n    Args:\n        params (dict): A dictionary containing N, t, Gamma_L, Gamma_R, Gamma_p, E_F, V.\n        p_probe (int): The zero-based index of the site where the probe is coupled.\n        G0 (float): The conductance quantum 2*e^2/h.\n\n    Returns:\n        float: The calculated current in Amperes.\n    \"\"\"\n    N = params['N']\n    t = params['t']\n    Gamma_L = params['Gamma_L']\n    Gamma_R = params['Gamma_R']\n    Gamma_p = params['Gamma_p']\n    E_F = params['E_F']\n    V = params['V']\n\n    # 1. Construct the matrix M = E_F*I - H - Sigma\n    # H is the tight-binding Hamiltonian with -t hopping\n    # Sigma is the sum of self-energies for L, R, and p terminals\n    M = np.zeros((N, N), dtype=np.complex128)\n\n    # Diagonal elements from E_F*I\n    np.fill_diagonal(M, E_F)\n    \n    # Off-diagonal elements from -H\n    if N > 1:\n        off_diag = np.full(N - 1, t)\n        M += np.diag(off_diag, 1) + np.diag(off_diag, -1)\n\n    # Add self-energies -Sigma to the diagonal\n    # Sigma_alpha = -i * Gamma_alpha / 2, so -Sigma_alpha = +i * Gamma_alpha / 2\n    M[0, 0] += 1j * Gamma_L / 2\n    M[N - 1, N - 1] += 1j * Gamma_R / 2\n    M[p_probe, p_probe] += 1j * Gamma_p / 2\n    \n    # 2. Invert M to get the retarded Green's function G^r\n    Gr = np.linalg.inv(M)\n\n    # 3. Extract required elements of G^r\n    s_L = 0\n    s_R = N - 1\n    s_p = p_probe\n\n    Gr_LR = Gr[s_L, s_R]\n    Gr_Lp = Gr[s_L, s_p]\n    Gr_pR = Gr[s_p, s_R]\n    \n    # 4. Calculate transmission probabilities T_ab = Gamma_a * Gamma_b * |G^r_{s_a, s_b}|^2\n    T_LR = Gamma_L * Gamma_R * (np.abs(Gr_LR) ** 2)\n    T_Lp = Gamma_L * Gamma_p * (np.abs(Gr_Lp) ** 2)\n    T_pR = Gamma_p * Gamma_R * (np.abs(Gr_pR) ** 2)\n\n    # 5. Calculate the effective transmission and current\n    if (T_Lp + T_pR) == 0:\n        T_eff = T_LR\n    else:\n        # This term represents the additional transport channel via the probe\n        T_eff = T_LR + (T_Lp * T_pR) / (T_Lp + T_pR)\n    \n    current = G0 * T_eff * V\n    \n    return current\n\nsolve()\n\n```"
        }
    ]
}