{
    "hands_on_practices": [
        {
            "introduction": "To begin mastering Büttiker probes, we first need to understand how their electrochemical potential is determined. This foundational exercise  explores the most intuitive scenario: a probe symmetrically coupled to the source and drain contacts. By applying the fundamental zero-current condition, you will derive that the probe's potential settles at the arithmetic average of the contact potentials, providing a clear illustration of the probe's role as a self-consistent voltage terminal.",
            "id": "4266172",
            "problem": "A nanoscale conductor made of an emerging two-dimensional semiconductor is connected to three electrical contacts labeled $L$, $R$, and $p$. Contacts $L$ and $R$ are macroscopic electron reservoirs at electrochemical potentials $\\,\\mu_{L}\\,$ and $\\,\\mu_{R}\\,$, respectively. Contact $p$ is a fictitious Büttiker probe introduced to model inelastic scattering that conserves particle number locally by enforcing zero net particle current into the probe at steady state. Assume that electron transport is phase-coherent between contacts and is described by the Landauer–Büttiker framework.\n\nUse the following fundamental base:\n- The steady-state current $\\,I_{\\alpha}\\,$ flowing out of contact $\\,\\alpha\\,$ is given by the Landauer–Büttiker expression\n$$\nI_{\\alpha} \\;=\\; \\frac{2q}{h}\\,\\sum_{\\beta}\\,\\int_{-\\infty}^{\\infty}\\! dE \\; T_{\\alpha\\beta}(E)\\,\\Big[f\\big(E,\\mu_{\\alpha},T_{0}\\big)\\;-\\;f\\big(E,\\mu_{\\beta},T_{0}\\big)\\Big],\n$$\nwhere $\\,q\\,$ is the elementary charge, $\\,h\\,$ is Planck’s constant, $\\,T_{\\alpha\\beta}(E)\\,$ is the transmission probability from contact $\\,\\beta\\,$ to contact $\\,\\alpha\\,$, and $\\,f(E,\\mu,T_{0})\\,$ is the Fermi–Dirac distribution at lattice temperature $\\,T_{0}$.\n\nAssume the following physically motivated conditions typical of linear-response nanoelectronic transport:\n1. Small biases such that $\\,\\mu_{L}-\\mu_{R}\\,$ is sufficiently small to justify linearization of the Fermi–Dirac distributions about a common equilibrium chemical potential.\n2. Time-reversal symmetry and phase-coherent elastic transport between terminals imply $T_{\\alpha\\beta}(E)=T_{\\beta\\alpha}(E)$ for all $\\,\\alpha\\neq\\beta\\,$.\n3. Over the transport window selected by the small bias and temperature, each inter-terminal transmission can be approximated as energy-independent: $\\,T_{\\alpha\\beta}(E)\\approx T_{\\alpha\\beta}\\,$.\n4. The Büttiker probe enforces zero net particle current into itself: $\\,I_{p}=0\\,$ at steady state.\n\nUnder these assumptions, determine the Büttiker probe electrochemical potential $\\,\\mu_{p}\\,$ in terms of $\\,\\mu_{L}\\,$ and $\\,\\mu_{R}\\,$ for the symmetric-coupling toy model in which the probe couples equally to the left and right contacts, i.e., $\\,T_{pL}=T_{pR}\\,$. Provide your final result as a closed-form symbolic expression involving only $\\,\\mu_{L}\\,$ and $\\,\\mu_{R}\\,$. Do not include units in your answer.",
            "solution": "The problem asks for the electrochemical potential $\\mu_{p}$ of a Büttiker probe in a three-terminal nanoelectronic device. The solution is derived within the Landauer–Büttiker formalism under a set of simplifying assumptions.\n\nThe starting point is the given Landauer–Büttiker expression for the steady-state current $I_{\\alpha}$ flowing out of contact $\\alpha$:\n$$\nI_{\\alpha} \\;=\\; \\frac{2q}{h}\\,\\sum_{\\beta}\\,\\int_{-\\infty}^{\\infty}\\! dE \\; T_{\\alpha\\beta}(E)\\,\\Big[f\\big(E,\\mu_{\\alpha},T_{0}\\big)\\;-\\;f\\big(E,\\mu_{\\beta},T_{0}\\big)\\Big]\n$$\nHere, the indices $\\alpha$ and $\\beta$ range over the set of contacts $\\{L, R, p\\}$. The term for $\\beta=\\alpha$ in the summation is zero, as $f(E,\\mu_{\\alpha},T_{0}) - f(E,\\mu_{\\alpha},T_{0}) = 0$. Therefore, the sum is effectively over all contacts $\\beta \\neq \\alpha$.\n\nWe are interested in the current $I_{p}$ flowing out of the Büttiker probe, contact $p$. According to the formula, this is:\n$$\nI_{p} \\;=\\; \\frac{2q}{h}\\,\\left( \\int_{-\\infty}^{\\infty}\\! dE \\; T_{pL}(E)\\,\\Big[f(E,\\mu_{p},T_{0}) - f(E,\\mu_{L},T_{0})\\Big] + \\int_{-\\infty}^{\\infty}\\! dE \\; T_{pR}(E)\\,\\Big[f(E,\\mu_{p},T_{0}) - f(E,\\mu_{R},T_{0})\\Big] \\right)\n$$\n\nThe first assumption is that of small biases, which allows for the linearization of the Fermi–Dirac distribution. The difference between two Fermi functions can be approximated as:\n$$\nf(E,\\mu_{a}, T_{0}) - f(E,\\mu_{b}, T_{0}) \\approx \\left.\\frac{\\partial f}{\\partial \\mu}\\right|_{\\mu=\\mu_{eq}} (\\mu_{a}-\\mu_{b})\n$$\nwhere $\\mu_{eq}$ is a common equilibrium chemical potential. Using the property that $\\frac{\\partial f}{\\partial \\mu} = -\\frac{\\partial f}{\\partial E}$, we have:\n$$\nf(E,\\mu_{a}, T_{0}) - f(E,\\mu_{b}, T_{0}) \\approx -\\frac{\\partial f(E,\\mu_{eq},T_{0})}{\\partial E} (\\mu_{a}-\\mu_{b})\n$$\n\nThe second relevant assumption is that the transmission probabilities are approximately energy-independent over the relevant transport window, i.e., $T_{\\alpha\\beta}(E) \\approx T_{\\alpha\\beta}$.\n\nSubstituting these approximations into the expression for $I_{p}$:\n$$\nI_{p} \\approx \\frac{2q}{h}\\,\\left( T_{pL} \\int_{-\\infty}^{\\infty}\\! dE \\; \\Big(-\\frac{\\partial f}{\\partial E}\\Big)(\\mu_{p}-\\mu_{L}) + T_{pR} \\int_{-\\infty}^{\\infty}\\! dE \\; \\Big(-\\frac{\\partial f}{\\partial E}\\Big)(\\mu_{p}-\\mu_{R}) \\right)\n$$\nThe integral of the negative derivative of the Fermi function over all energies is unity:\n$$\n\\int_{-\\infty}^{\\infty} \\! \\Big(-\\frac{\\partial f(E)}{\\partial E}\\Big) dE = - \\big[f(E)\\big]_{-\\infty}^{\\infty} = - (f(+\\infty) - f(-\\infty)) = - (0-1) = 1\n$$\nThis simplifies the expression for the current $I_{p}$ to its linear-response form:\n$$\nI_{p} = \\frac{2q}{h}\\,\\Big[ T_{pL}(\\mu_{p} - \\mu_{L}) + T_{pR}(\\mu_{p} - \\mu_{R}) \\Big]\n$$\n\nThe defining characteristic of a Büttiker probe, as stated in the problem, is that it enforces zero net particle current at steady state. This implies that the net charge current $I_{p}$ is also zero.\n$$\nI_{p} = 0\n$$\nSetting our derived expression for $I_{p}$ to zero:\n$$\n\\frac{2q}{h}\\,\\Big[ T_{pL}(\\mu_{p} - \\mu_{L}) + T_{pR}(\\mu_{p} - \\mu_{R}) \\Big] = 0\n$$\nSince the prefactor $\\frac{2q}{h}$ is a non-zero constant, the term in the square brackets must be zero:\n$$\nT_{pL}(\\mu_{p} - \\mu_{L}) + T_{pR}(\\mu_{p} - \\mu_{R}) = 0\n$$\n\nNow, we solve this algebraic equation for the probe potential $\\mu_{p}$:\n$$\nT_{pL}\\mu_{p} - T_{pL}\\mu_{L} + T_{pR}\\mu_{p} - T_{pR}\\mu_{R} = 0\n$$\n$$\n\\mu_{p}(T_{pL} + T_{pR}) = T_{pL}\\mu_{L} + T_{pR}\\mu_{R}\n$$\n$$\n\\mu_{p} = \\frac{T_{pL}\\mu_{L} + T_{pR}\\mu_{R}}{T_{pL} + T_{pR}}\n$$\nThis general result shows that the probe potential is a weighted average of the potentials of the contacts to which it is coupled, with the transmission probabilities (proportional to conductances) acting as the weights.\n\nFinally, we apply the specific condition for the given toy model: the probe couples equally to the left and right contacts, meaning $T_{pL} = T_{pR}$. Let us denote this common transmission probability by $T_{p}$. Substituting this into the expression for $\\mu_{p}$:\n$$\n\\mu_{p} = \\frac{T_{p}\\mu_{L} + T_{p}\\mu_{R}}{T_{p} + T_{p}} = \\frac{T_{p}(\\mu_{L} + \\mu_{R})}{2T_{p}}\n$$\nAssuming the probe is physically connected to the contacts ($T_{p} \\neq 0$), we can cancel $T_{p}$ from the numerator and denominator, yielding the final result:\n$$\n\\mu_{p} = \\frac{\\mu_{L} + \\mu_{R}}{2}\n$$\nThe electrochemical potential of the symmetrically coupled Büttiker probe is the arithmetic mean of the electrochemical potentials of the source and drain contacts.",
            "answer": "$$\\boxed{\\frac{\\mu_{L} + \\mu_{R}}{2}}$$"
        },
        {
            "introduction": "Moving from the abstract Landauer-Büttiker picture to a concrete microscopic system, this practice  challenges you to apply the Non-Equilibrium Green's Function (NEGF) formalism. You will analyze a simple three-site atomic chain where the central site is coupled to a dephasing probe. This exercise is crucial for deriving from first principles how the probe creates an incoherent transport channel that competes with the direct coherent path, fundamentally altering the device's effective transmission.",
            "id": "4266178",
            "problem": "Consider a one-dimensional chain of $3$ sites labeled $1-2-3$ described by a nearest-neighbor tight-binding Hamiltonian with on-site energies equal to $0$ and hopping amplitude $t$ between adjacent sites. Site $1$ is coupled to a left electron reservoir (lead) with coupling strength $\\Gamma_{L}$, site $3$ is coupled to a right electron reservoir with coupling strength $\\Gamma_{R}$, and site $2$ is coupled to a Büttiker dephasing probe with coupling strength $\\Gamma_{p}$. Assume the reservoirs and the Büttiker probe are described within the wide-band limit and that transport is evaluated using the Non-Equilibrium Green’s Function (NEGF) formalism. The system is studied at zero temperature and in the linear response regime about a common equilibrium chemical potential $\\mu=0$, with a small bias such that the left and right reservoirs have chemical potentials $\\mu_{L}=\\delta\\mu$ and $\\mu_{R}=-\\delta\\mu$, respectively, where $|\\delta\\mu|$ is small. The Büttiker probe is treated as a voltage probe whose distribution function is adjusted to satisfy current conservation, i.e., the net current flowing into the probe is zero.\n\nStarting from first principles appropriate to this context, namely:\n- the retarded Green’s function $G^{r}(E)$ defined by $G^{r}(E)=\\left[E I - H - \\Sigma^{r}(E)\\right]^{-1}$, where $H$ is the tight-binding Hamiltonian and $\\Sigma^{r}(E)$ is the sum of retarded self-energies from the left lead, right lead, and probe,\n- the spectral coupling matrices $\\Gamma_{\\alpha}(E)=i\\left[\\Sigma_{\\alpha}^{r}(E)-\\Sigma_{\\alpha}^{a}(E)\\right]$ for $\\alpha\\in\\{L,R,p\\}$,\n- the multi-terminal Landauer–Büttiker (LB) linear-response current relations consistent with NEGF, and\n- the Büttiker probe (BP) condition of zero net current into the probe,\n\nderive the local non-equilibrium occupations on each site and the bond current distribution at energy $E=0$, and analyze how the presence of the probe modifies the effective two-terminal transmission from the left to the right reservoir. For definiteness, take the retarded self-energy in the wide-band limit on site $i$ connected to terminal $\\alpha$ to be $\\Sigma_{\\alpha}^{r}(E)=-i\\,\\Gamma_{\\alpha}/2$ on that site and zero elsewhere, with $\\Gamma_{\\alpha}$ energy-independent.\n\nYour final task is to provide a closed-form analytic expression for the effective two-terminal transmission at energy $E=0$ after enforcing the Büttiker probe condition. Express your final answer as a function of $t$, $\\Gamma_{L}$, $\\Gamma_{R}$, and $\\Gamma_{p}$. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "The system is a $3$-site tight-binding chain described by the Hamiltonian matrix $H$ in the site basis $\\{|1\\rangle, |2\\rangle, |3\\rangle\\}$. With zero on-site energies and nearest-neighbor hopping amplitude $t$, the Hamiltonian matrix elements are $-t$ for adjacent sites:\n$$\nH = \\begin{pmatrix} 0  -t  0 \\\\ -t  0  -t \\\\ 0  -t  0 \\end{pmatrix}\n$$\nThe system is coupled to three terminals (Left, Right, and Probe). In the wide-band approximation, the retarded self-energy for each terminal $\\alpha \\in \\{L, R, p\\}$ is a constant matrix, non-zero only at the site of coupling. Specifically, site $1$ is coupled to lead L, site $2$ to probe p, and site $3$ to lead R.\n$$\n\\Sigma_{L}^{r}(E) = \\begin{pmatrix} -i\\frac{\\Gamma_L}{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad\n\\Sigma_{p}^{r}(E) = \\begin{pmatrix} 0  0  0 \\\\ 0  -i\\frac{\\Gamma_p}{2}  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad\n\\Sigma_{R}^{r}(E) = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  -i\\frac{\\Gamma_R}{2} \\end{pmatrix}\n$$\nThe total retarded self-energy is $\\Sigma^{r}(E) = \\Sigma_{L}^{r}(E) + \\Sigma_{p}^{r}(E) + \\Sigma_{R}^{r}(E)$. The retarded Green's function is $G^{r}(E) = \\left[E I - H - \\Sigma^{r}(E)\\right]^{-1}$. At the Fermi energy $E=0$, the matrix to be inverted is:\n$$\nM = \\left[0 \\cdot I - H - \\Sigma^{r}(0)\\right] = -H - \\Sigma^{r}(0) = \\begin{pmatrix} i\\frac{\\Gamma_L}{2}  t  0 \\\\ t  i\\frac{\\Gamma_p}{2}  t \\\\ 0  t  i\\frac{\\Gamma_R}{2} \\end{pmatrix}\n$$\nThe effective two-terminal transmission $T_{eff}$ from left to right, in the presence of a voltage probe, is given by the sum of a direct coherent path and an indirect incoherent path:\n$$\nT_{eff} = T_{LR} + \\frac{T_{Lp} T_{Rp}}{T_{Lp} + T_{Rp}}\n$$\nThe individual transmission probabilities $T_{\\beta \\alpha}$ are calculated from the NEGF formula $T_{\\beta \\alpha}(E) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha}(E) G^{r}(E) \\Gamma_{\\beta}(E) G^{a}(E)\\right]$. For local wide-band couplings, this simplifies to $T_{\\beta \\alpha} = \\Gamma_\\alpha \\Gamma_\\beta |G^r_{s_\\alpha s_\\beta}|^2$, where $s_\\alpha$ is the site coupled to terminal $\\alpha$.\n\nTo find the transmissions, we need the matrix elements of $G^r(0) = M^{-1}$. The determinant of $M$ is:\n$$\n\\det(M) = (i\\Gamma_L/2)[(i\\Gamma_p/2)(i\\Gamma_R/2) - t^2] - t[t(i\\Gamma_R/2)] = -\\frac{i}{8}(\\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R))\n$$\nLet's define a real-valued quantity $K = \\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R)$, so $\\det(M) = -iK/8$. The required elements of $G^r(0) = \\frac{\\mathrm{adj}(M)}{\\det(M)}$ are found using the matrix of cofactors. Note that $(M^{-1})_{ij} = C_{ji}/\\det(M)$.\n$G^r_{13}(0) = C_{31}/\\det(M) = \\frac{t^2}{-iK/8} = \\frac{8it^2}{K}$\n$G^r_{12}(0) = C_{21}/\\det(M) = \\frac{-t(i\\Gamma_R/2)}{-iK/8} = \\frac{4t\\Gamma_R}{K}$\n$G^r_{23}(0) = C_{32}/\\det(M) = \\frac{-t(i\\Gamma_L/2)}{-iK/8} = \\frac{4t\\Gamma_L}{K}$\n\nNow, we calculate the transmissions at $E=0$:\n$T_{LR} = \\Gamma_L \\Gamma_R |G^r_{13}(0)|^2 = \\Gamma_L \\Gamma_R \\left| \\frac{8it^2}{K} \\right|^2 = \\frac{64 t^4 \\Gamma_L \\Gamma_R}{K^2}$\n$T_{Lp} = \\Gamma_L \\Gamma_p |G^r_{12}(0)|^2 = \\Gamma_L \\Gamma_p \\left| \\frac{4t\\Gamma_R}{K} \\right|^2 = \\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2}$\n$T_{pR} = \\Gamma_p \\Gamma_R |G^r_{23}(0)|^2 = \\Gamma_p \\Gamma_R \\left| \\frac{4t\\Gamma_L}{K} \\right|^2 = \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}$\n\nNow we compute the second term in $T_{eff}$:\n$$\n\\frac{T_{Lp} T_{pR}}{T_{Lp} + T_{pR}} = \\frac{\\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2} \\cdot \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}}{\\frac{16 t^2 \\Gamma_L \\Gamma_p \\Gamma_R^2}{K^2} + \\frac{16 t^2 \\Gamma_p \\Gamma_R \\Gamma_L^2}{K^2}} = \\frac{\\frac{256 t^4 \\Gamma_p^2 \\Gamma_L^3 \\Gamma_R^3}{K^4}}{\\frac{16 t^2 \\Gamma_p \\Gamma_L \\Gamma_R (\\Gamma_R + \\Gamma_L)}{K^2}} = \\frac{16 t^2 \\Gamma_p \\Gamma_L^2 \\Gamma_R^2}{K^2 (\\Gamma_L + \\Gamma_R)}\n$$\nFinally, we sum the two contributions to $T_{eff}$:\n$$\nT_{eff} = \\frac{64 t^4 \\Gamma_L \\Gamma_R}{K^2} + \\frac{16 t^2 \\Gamma_p \\Gamma_L^2 \\Gamma_R^2}{K^2 (\\Gamma_L + \\Gamma_R)} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{K^2 (\\Gamma_L + \\Gamma_R)} \\left[ 4 t^2 (\\Gamma_L + \\Gamma_R) + \\Gamma_p \\Gamma_L \\Gamma_R \\right]\n$$\nThe term in the square brackets is exactly the definition of $K$.\n$$\nT_{eff} = \\frac{16 t^2 \\Gamma_L \\Gamma_R \\cdot K}{K^2 (\\Gamma_L + \\Gamma_R)} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{K (\\Gamma_L + \\Gamma_R)}\n$$\nSubstituting back $K = \\Gamma_L\\Gamma_p\\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R)$, we obtain the final expression for the effective transmission.\n$$\nT_{eff} = \\frac{16 t^2 \\Gamma_L \\Gamma_R}{(\\Gamma_L \\Gamma_p \\Gamma_R + 4t^2(\\Gamma_L + \\Gamma_R))(\\Gamma_L + \\Gamma_R)}\n$$\nThis is the required closed-form expression for the effective two-terminal transmission at $E=0$. It shows how the hopping $t$ enables transport, while the couplings $\\Gamma_L, \\Gamma_R$ are necessary for injection and collection. The dephasing term $\\Gamma_p$ in the denominator suppresses the overall transmission, as expected.",
            "answer": "$$\n\\boxed{\\frac{16 t^{2} \\Gamma_{L} \\Gamma_{R}}{(\\Gamma_{L} \\Gamma_{p} \\Gamma_{R} + 4t^{2}(\\Gamma_{L} + \\Gamma_{R}))(\\Gamma_{L} + \\Gamma_{R})}}\n$$"
        },
        {
            "introduction": "The final step in our hands-on journey is to translate analytical theory into practical computational models, a vital skill for modern nanoelectronics research. This exercise  guides you through writing a program to simulate quantum transport in a multi-site chain with a dephasing probe at an arbitrary position. By numerically investigating how the current is affected by the probe's location, you will develop both coding proficiency and a tangible intuition for the non-local effects of inelastic scattering in nanoscale conductors.",
            "id": "4266098",
            "problem": "You are to write a complete and runnable program that computes how the steady-state device current in a coherent one-dimensional tight-binding chain changes when a single Büttiker probe is moved from a bulk site to a location near a contact. The device is modeled as a linear chain of $N$ sites with nearest-neighbor hopping. The left and right metallic contacts are modeled by wide-band self-energies at the end sites. The Büttiker probe is modeled as a third wide-band terminal coupled to a single site and its electrochemical potential is chosen so that the net current into the probe is zero (voltage-probe limit, representing inelastic relaxation). Use zero-temperature, linear-response transport.\n\nStart from the following foundational base:\n- The multi-terminal Landauer–Büttiker relation in linear response at zero temperature: for terminal $\\alpha$, the current is $I_{\\alpha} = (\\frac{g_s e^2}{h}) \\sum_{\\beta} T_{\\alpha\\beta}\\left(E_F\\right)\\left(V_{\\alpha}-V_{\\beta}\\right)$, where $g_s$ is the spin degeneracy, $e$ is the elementary charge, $h$ is Planck's constant, $T_{\\alpha\\beta}$ is the transmission from terminal $\\beta$ to $\\alpha$ at the Fermi energy $E_F$, and $V_{\\alpha}$ is the electrical potential (in volts) of terminal $\\alpha$.\n- The Caroli formula for transmission in the non-equilibrium Green's function framework: $T_{\\alpha\\beta}(E_F) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha} G^r(E_F)\\,\\Gamma_{\\beta} G^a(E_F)\\right]$, where $G^r$ and $G^a$ are the retarded and advanced Green's functions of the device including all self-energies, and $\\Gamma_{\\alpha} = i(\\Sigma_{\\alpha} - \\Sigma_{\\alpha}^{\\dagger})$ is the broadening matrix for terminal $\\alpha$.\n- The retarded Green's function for the device: $G^r(E_F) = \\left[E_F I - H - \\sum_{\\alpha}\\Sigma_{\\alpha}\\right]^{-1}$, with $H$ the device Hamiltonian and $\\Sigma_{\\alpha}$ the terminal self-energies in the wide-band limit.\n\nDevice model and conventions:\n- The device Hamiltonian $H$ is an $N\\times N$ tridiagonal matrix with on-site energies equal to $0$ and nearest-neighbor hopping $-t$ (energy in electronvolts).\n- The left contact couples only to site index 0, and the right contact couples only to site index $N-1$, with wide-band self-energy $\\Sigma_L = -i \\Gamma_L/2$ at site $0$ and $\\Sigma_R = -i \\Gamma_R/2$ at site $N-1$, where $\\Gamma_L$ and $\\Gamma_R$ are positive constants in electronvolts.\n- The Büttiker probe couples to exactly one site, indexed by an integer position $p$, with wide-band self-energy $\\Sigma_p = -i \\Gamma_p/2$ at that site. The probe potential $V_p$ is determined by the zero-current condition $I_p = 0$ under the same linear-response law at zero temperature.\n- Use spin degeneracy $g_s = 2$. Use the Fermi energy $E_F$ inside the device band (energy in electronvolts). Use a small symmetric bias such that $V_L = +V/2$ and $V_R = -V/2$, where $V$ is the applied source-drain bias in volts.\n- Use zero-based indexing for lattice sites: the left contact is at site $0$, the right contact at site $N-1$, the \"near-contact\" probe position is the site $1$, and the \"bulk\" probe position is the site $\\lfloor N/2 \\rfloor$.\n\nYour program must:\n- For each test case, compute the steady-state device current flowing from left to right when the probe is at the bulk position, $I_{\\text{bulk}}$, and when the probe is at the near-contact position, $I_{\\text{near}}$, both in amperes. Then compute the difference $\\Delta I = I_{\\text{bulk}} - I_{\\text{near}}$ in amperes.\n- Use the zero-temperature, linear-response expressions strictly at the Fermi energy $E_F$ and do not perform any energy averaging.\n- Ensure numerical stability by adding a small positive imaginary infinitesimal $i\\eta$ with $\\eta \\ll 1$ (in electronvolts) if needed for matrix inversion. Choose $\\eta$ sufficiently small not to affect the physical result.\n- Express the final numerical answers for each test case in amperes, each rounded to $6$ significant figures.\n\nTest suite:\n- Case $1$ (happy path): $N=10$, $t=1.0$ eV, $\\Gamma_L=0.5$ eV, $\\Gamma_R=0.5$ eV, $\\Gamma_p=0.2$ eV, $E_F=0.0$ eV, $V=0.01$ V.\n- Case $2$ (weak probe, near-ballistic limit): $N=10$, $t=1.0$ eV, $\\Gamma_L=0.5$ eV, $\\Gamma_R=0.5$ eV, $\\Gamma_p=1.0\\times 10^{-6}$ eV, $E_F=0.0$ eV, $V=0.01$ V.\n- Case $3$ (asymmetric contacts): $N=12$, $t=1.0$ eV, $\\Gamma_L=0.05$ eV, $\\Gamma_R=1.0$ eV, $\\Gamma_p=0.5$ eV, $E_F=0.0$ eV, $V=0.01$ V.\n- Case $4$ (short chain, stronger probe, larger bias): $N=4$, $t=0.5$ eV, $\\Gamma_L=0.5$ eV, $\\Gamma_R=0.5$ eV, $\\Gamma_p=1.0$ eV, $E_F=0.0$ eV, $V=0.02$ V.\n\nOutput specification:\n- Your program should produce a single line of output containing the results for the test suite as a comma-separated list enclosed in square brackets, ordered as listed above. For example, the format must be exactly like: [$\\Delta I_1$,$\\Delta I_2$,$\\Delta I_3$,$\\Delta I_4$], where each $\\Delta I_k$ is a float in amperes rounded to $6$ significant figures.\n- All currents must be reported in amperes.",
            "solution": "The problem requires calculating the change in steady-state device current, $\\Delta I = I_{\\text{bulk}} - I_{\\text{near}}$, when a Büttiker probe is moved. The device consists of a 1D tight-binding chain with three terminals: Left (L), Right (R), and a voltage probe (p).\n\nThe calculation uses the multi-terminal Landauer-Büttiker formula in the linear response regime at zero temperature. The current in terminal $\\alpha$ is given by:\n$$I_{\\alpha} = \\frac{g_s e^2}{h} \\sum_{\\beta \\neq \\alpha} T_{\\alpha\\beta}(E_F) (V_{\\alpha} - V_{\\beta})$$\nHere, $g_s=2$, $V_L = V/2$, $V_R = -V/2$, and $V_p$ is determined by the zero-current condition $I_p=0$. This condition yields:\n$$V_p = \\frac{T_{pL}V_L + T_{pR}V_R}{T_{pL} + T_{pR}}$$\nUsing reciprocity ($T_{\\alpha\\beta} = T_{\\beta\\alpha}$), the total device current, $I_{\\text{device}} = I_L$, can be expressed in terms of an effective two-terminal transmission, $T_{\\text{eff}}$:\n$$I_{\\text{device}} = \\frac{g_s e^2}{h} (V_L - V_R) T_{\\text{eff}} = \\frac{g_s e^2}{h} V T_{\\text{eff}}$$\nwhere\n$$T_{\\text{eff}} = T_{LR} + \\frac{T_{Lp} T_{pR}}{T_{Lp} + T_{pR}}$$\nThis equation shows that the probe introduces an incoherent transport channel in parallel with the direct coherent channel.\n\nThe core task is to compute the transmission probabilities $T_{\\alpha\\beta}$ at the Fermi energy $E_F$ using the non-equilibrium Green's function (NEGF) method. The Caroli formula gives:\n$$T_{\\alpha\\beta}(E_F) = \\mathrm{Tr}\\left[\\Gamma_{\\alpha} G^r(E_F)\\,\\Gamma_{\\beta} G^a(E_F)\\right]$$\nFor local wide-band couplings, where terminal $\\alpha$ couples to site $s_\\alpha$ with broadening $\\Gamma_\\alpha$, this simplifies to:\n$$T_{\\alpha\\beta} = \\Gamma_\\alpha \\Gamma_\\beta |G^r_{s_\\alpha, s_\\beta}|^2$$\nThe retarded Green's function $G^r$ is found by inverting the effective Hamiltonian matrix:\n$$G^r(E_F) = \\left[E_F I - H - \\sum_{\\alpha \\in \\{L, R, p\\}} \\Sigma_{\\alpha}\\right]^{-1}$$\nwhere $H$ is the device Hamiltonian matrix and $\\Sigma_{\\alpha}$ are the self-energy matrices for the terminals. For a given probe position $p$, the matrix $M = E_F I - H - \\sum \\Sigma_{\\alpha}$ is constructed. Its inverse gives $G^r$, from which the transmission elements are calculated. This process is repeated for the bulk and near-contact probe positions to find $I_{\\text{bulk}}$, $I_{\\text{near}}$, and their difference $\\Delta I$.\n\nThe following Python code implements this procedure to solve for the test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It calculates the change in current when a Büttiker probe is moved.\n    \"\"\"\n    \n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    h = 6.62607015e-34    # Planck's constant in J*s\n    G0 = 2 * e**2 / h      # Conductance quantum with spin degeneracy g_s=2, in A/V (Siemens)\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: happy path\n        {'N': 10, 't': 1.0, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 0.2, 'E_F': 0.0, 'V': 0.01},\n        # Case 2: weak probe, near-ballistic limit\n        {'N': 10, 't': 1.0, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 1.0e-6, 'E_F': 0.0, 'V': 0.01},\n        # Case 3: asymmetric contacts\n        {'N': 12, 't': 1.0, 'Gamma_L': 0.05, 'Gamma_R': 1.0, 'Gamma_p': 0.5, 'E_F': 0.0, 'V': 0.01},\n        # Case 4: short chain, stronger probe, larger bias\n        {'N': 4, 't': 0.5, 'Gamma_L': 0.5, 'Gamma_R': 0.5, 'Gamma_p': 1.0, 'E_F': 0.0, 'V': 0.02},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        p_bulk = params['N'] // 2\n        p_near = 1\n        \n        I_bulk = calculate_current(params, p_bulk, G0)\n        I_near = calculate_current(params, p_near, G0)\n        \n        delta_I = I_bulk - I_near\n        results.append(f\"{delta_I:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n\ndef calculate_current(params, p_probe, G0):\n    \"\"\"\n    Calculates the steady-state current for a given set of device parameters and probe position.\n    \n    Args:\n        params (dict): A dictionary containing N, t, Gamma_L, Gamma_R, Gamma_p, E_F, V.\n        p_probe (int): The zero-based index of the site where the probe is coupled.\n        G0 (float): The conductance quantum 2*e^2/h.\n\n    Returns:\n        float: The calculated current in Amperes.\n    \"\"\"\n    N = params['N']\n    t = params['t']\n    Gamma_L = params['Gamma_L']\n    Gamma_R = params['Gamma_R']\n    Gamma_p = params['Gamma_p']\n    E_F = params['E_F']\n    V = params['V']\n\n    # 1. Construct the matrix M = E_F*I - H - Sigma\n    # H is the tight-binding Hamiltonian with -t hopping\n    # Sigma is the sum of self-energies for L, R, and p terminals\n    M = np.zeros((N, N), dtype=np.complex128)\n\n    # Diagonal elements from E_F*I - H\n    np.fill_diagonal(M, E_F)\n    \n    # Off-diagonal elements from -H\n    if N  1:\n        off_diag = np.full(N - 1, t)\n        M += np.diag(off_diag, 1) + np.diag(off_diag, -1)\n\n    # Add self-energies -Sigma to the diagonal\n    # Sigma_alpha = -i * Gamma_alpha / 2, so -Sigma_alpha = +i * Gamma_alpha / 2\n    M[0, 0] += 1j * Gamma_L / 2\n    M[N - 1, N - 1] += 1j * Gamma_R / 2\n    M[p_probe, p_probe] += 1j * Gamma_p / 2\n    \n    # 2. Invert M to get the retarded Green's function G^r\n    Gr = np.linalg.inv(M)\n\n    # 3. Extract required elements of G^r\n    s_L = 0\n    s_R = N - 1\n    s_p = p_probe\n\n    Gr_LR = Gr[s_L, s_R]\n    Gr_Lp = Gr[s_L, s_p]\n    Gr_pR = Gr[s_p, s_R]\n    \n    # 4. Calculate transmission probabilities T_ab = Gamma_a * Gamma_b * |G^r_{s_a, s_b}|^2\n    T_LR = Gamma_L * Gamma_R * (np.abs(Gr_LR) ** 2)\n    T_Lp = Gamma_L * Gamma_p * (np.abs(Gr_Lp) ** 2)\n    T_pR = Gamma_p * Gamma_R * (np.abs(Gr_pR) ** 2)\n\n    # 5. Calculate the effective transmission and current\n    if (T_Lp + T_pR) == 0:\n        T_eff = T_LR\n    else:\n        # This term represents the additional transport channel via the probe\n        T_eff = T_LR + (T_Lp * T_pR) / (T_Lp + T_pR)\n    \n    current = G0 * T_eff * V\n    \n    return current\n\nsolve()\n\n```"
        }
    ]
}