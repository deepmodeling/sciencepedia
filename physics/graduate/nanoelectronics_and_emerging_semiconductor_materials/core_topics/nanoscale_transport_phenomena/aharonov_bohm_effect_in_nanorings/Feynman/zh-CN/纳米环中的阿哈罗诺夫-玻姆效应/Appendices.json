{
    "hands_on_practices": [
        {
            "introduction": "规范不变性是电磁学和量子力学中的一个核心概念，它保证了物理定律不依赖于我们描述场的数学形式。本练习旨在通过数值方法，具体展示阿哈罗诺夫-玻姆效应中的物理可观测量（如能谱和持续电流）不依赖于磁矢量势 $\\mathbf{A}$ 的具体选择（即规范选择）。通过为同一个物理系统构建和对角化代表两种不同规范的紧束缚哈密顿量，您将亲手验证这一基本原理，从而加深对理论形式的理解。",
            "id": "4262357",
            "problem": "考虑一个理想的一维纳米环，其上有$N$个格点，由一个紧束缚哈密顿量描述，该哈密顿量针对的是一个最近邻跃迁振幅为$t$的单个无自旋电子。在有磁通量 $\\Phi$ 穿过环的情况下，其动力学由非相对论量子力学中的最小耦合原理支配：正则动量根据 $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$ 进行修正，其中 $q$ 是电子电荷，$\\mathbf{A}$ 是磁矢量势。Aharonov-Bohm效应（Aharonov-Bohm (AB) 效应）指出，即使磁场被限制在环的内部并且在电子路径上为零，物理可观测量也可能依赖于穿过环的闭合磁通量 $\\Phi$。磁通量子为 $\\Phi_0 = h/e$，在紧束缚模型中，$\\mathbf{A}$ 的效应可以通过 Peierls 替换被一致地引入，该替换将每个跃迁项乘以一个相位因子，此相位因子由 $\\mathbf{A}$ 沿键的线积分给出。\n\n在环形几何结构中，产生相同总磁通量 $\\Phi$ 的不同 $\\mathbf{A}$ 规范选择通过规范变换相互关联，因此物理可观测量必须是规范不变的。在离散环中，表示相同总磁通量的两种数学上明确定义的规范选择是：\n- 均匀方位角规范，其中总相位 $2\\pi f$（$f = \\Phi/\\Phi_0$）在所有 $N$ 个键上均匀分布，因此对于所有 $j$，格点 $j$ 和格点 $j+1$ 之间的前向跃迁携带相同的相位因子，而后向跃迁携带其复共轭。这对应于在连续体中沿环恒定的切向 $\\mathbf{A}$。\n- 单支割规范，其中整个相位 $2\\pi f$ 集中在单个键上（例如，格点 $N-1$ 和 $0$ 之间），而所有其他键都具有实数跃迁振幅。这对应于一种规范，其中 $\\mathbf{A}$ 在环上除了一个支割处外处处都是纯规范。\n\n你的任务是从第一性原理出发，通过数值计算来证明，能谱和基态持续电流在这些规范选择下是不变的。仅使用以下基础依据：\n- 薛定谔方程中的最小耦合原理 $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$。\n- 在存在磁矢量势的情况下，用于紧束缚模型的 Peierls 替换。\n- 磁通量子 $\\Phi_0 = h/e$ 的定义。\n- 规范变换作为幺正变换作用于哈密顿量且不改变物理谱这一事实。\n\n定义无量纲磁通参数 $f = \\Phi/\\Phi_0$，并分别构建对应于均匀方位角规范和单支割规范的两个 $N \\times N$ 紧束缚哈密顿量 $H_{\\text{uni}}(N,t,f)$ 和 $H_{\\text{cut}}(N,t,f)$，均采用周期性边界条件。假设在位能为零。对每个测试磁通，计算两个哈密顿量的排序后能谱，并计算每个规范下的基态能量 $E_0(f)$。使用中心有限差分，通过 $I'(f) = -\\frac{\\partial E_0}{\\partial f}$ 和一个小步长 $\\delta f$ 来近似计算归一化的基态持续电流，注意 $I'(f)$ 的单位是能量每磁通量子；由于你只需要比较不变性，因此无需将 $I'(f)$ 表示为物理单位。\n\n定义容差 $\\varepsilon_E = 10^{-10}$ 和 $\\varepsilon_I = 10^{-8}$。对于每个测试用例，产生两个布尔结果：\n- 一个能谱不变性布尔值，表示来自两种规范的排序后能谱之间的最大绝对差是否小于 $\\varepsilon_E$。\n- 一个电流不变性布尔值，表示从两种规范计算出的 $I'(f)$ 之间的绝对差是否小于 $\\varepsilon_I$。\n\n实现程序以评估以下测试套件，其中所有参数都是无量纲的，或其单位无需显式报告，因为只输出布尔值：\n- 测试用例 1：$N = 16$， $t = 1.0$， $f = 0.25$， $\\delta f = 10^{-6}$。\n- 测试用例 2：$N = 12$， $t = 1.0$， $f = 0.0$， $\\delta f = 10^{-6}$。\n- 测试用例 3：$N = 10$， $t = 2.0$， $f = 0.5$， $\\delta f = 10^{-6}$。\n- 测试用例 4：$N = 3$， $t = 1.0$， $f = 0.3$， $\\delta f = 10^{-6}$。\n\n你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是按 $[\\text{spectrum\\_invariant}, \\text{current\\_invariant}]$ 顺序排列的包含两个布尔值的列表。例如，对于四个测试用例，输出格式必须为 $[[\\text{b}_{11},\\text{b}_{12}],[\\text{b}_{21},\\text{b}_{22}],[\\text{b}_{31},\\text{b}_{32}],[\\text{b}_{41},\\text{b}_{42}]]$, 其中每个 $\\text{b}_{ij}$ 是 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "这个问题的物理基础是量子力学中的最小耦合原理和规范不变性。对于一个在磁场中电荷为 $q=-e$ 的电子，其动量算符根据 $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$ 进行修正，其中 $\\mathbf{A}$ 是磁矢量势。在紧束缚描述中，Peierls 替换忠实地编码了 $\\mathbf{A}$ 沿离散键的影响：从格点 $i$ 到格点 $j$ 的跃迁振幅获得一个相位因子 $\\exp\\left( \\frac{i q}{\\hbar} \\int_i^j \\mathbf{A} \\cdot d\\mathbf{\\ell} \\right)$。对于一个总闭合磁通量为 $\\Phi$ 的环，沿闭合回路的这些相位的总和必须是 $2\\pi f$，其中 $f = \\Phi/\\Phi_0$ 且 $\\Phi_0 = h/e$。\n\n我们考虑产生相同总回路相位 $2\\pi f$ 的两种规范选择：\n\n1. 均匀方位角规范：总相位在所有 $N$ 个键上均匀分布，因此每个前向最近邻跃迁携带相位 $\\exp\\left( i \\frac{2\\pi f}{N} \\right)$，而后向跃迁携带其复共轭。将此紧束缚哈密顿量记为 $H_{\\text{uni}}(N,t,f)$，其矩阵元为\n$$\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{j,j+1} = -t \\, e^{i \\frac{2\\pi f}{N}}, \\quad\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{j+1,j} = -t \\, e^{-i \\frac{2\\pi f}{N}},\n$$\n对于 $j=0,1,\\ldots,N-2$，并在边界上周期性地实施，\n$$\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{N-1,0} = -t \\, e^{i \\frac{2\\pi f}{N}}, \\quad\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{0,N-1} = -t \\, e^{-i \\frac{2\\pi f}{N}}.\n$$\n所有在位项均为零。\n\n2. 单支割规范：整个回路相位集中在一个键上（选择在格点 $N-1$ 和 $0$ 之间），而所有其他键都具有实数跃迁振幅 $-t$。将此哈密顿量记为 $H_{\\text{cut}}(N,t,f)$，其矩阵元为\n$$\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{j,j+1} = -t, \\quad\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{j+1,j} = -t, \\quad j=0,1,\\ldots,N-2,\n$$\n以及跨越支割处，\n$$\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{N-1,0} = -t \\, e^{i 2\\pi f}, \\quad\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{0,N-1} = -t \\, e^{-i 2\\pi f}.\n$$\n\n这两个哈密顿量通过一个依赖于格点的幺正规范变换 $U = \\mathrm{diag}\\left(e^{i \\theta_0}, e^{i \\theta_1}, \\ldots, e^{i \\theta_{N-1}}\\right)$ 相关联，其中选择 $\\theta_j = \\frac{2\\pi f}{N} j$ 会得到\n$$\nH_{\\text{cut}}(N,t,f) = U^{\\dagger} H_{\\text{uni}}(N,t,f) U,\n$$\n这意味着 $H_{\\text{uni}}$ 和 $H_{\\text{cut}}$ 是幺正等价的。因此，它们具有相同的谱和相同的物理可观测量，这些量可以表示为本征值的函数。这是规范不变性的直接体现。\n\n算法设计：\n\n- 使用上述定义，将 $H_{\\text{uni}}(N,t,f)$ 和 $H_{\\text{cut}}(N,t,f)$ 显式地构建为 $N \\times N$ 的厄米矩阵。通过连接格点 $N-1$ 和格点 $0$ 来实现周期性边界条件。\n\n- 使用数值厄米本征求解器（例如，一个实现复厄米矩阵对角化的例程）计算两个哈密顿量的本征值。按升序对本征值进行排序，以获得能谱 $E^{\\text{uni}}(f)$ 和 $E^{\\text{cut}}(f)$。\n\n- 通过计算在相同 $f$ 下两个排序后能谱之间的最大绝对差来量化能谱不变性：\n$$\n\\Delta_E(f) = \\max_k \\left| E^{\\text{uni}}_k(f) - E^{\\text{cut}}_k(f) \\right|.\n$$\n如果 $\\Delta_E(f)  \\varepsilon_E$（其中 $\\varepsilon_E = 10^{-10}$），则宣布能谱是不变的。\n\n- 将两种规范下的最小本征值作为基态能量 $E_0^{\\text{uni}}(f)$ 和 $E_0^{\\text{cut}}(f)$。通过中心有限差分来近似归一化的持续电流（能量每磁通量子）：\n$$\nI'_{\\text{uni}}(f) = -\\frac{E_0^{\\text{uni}}(f+\\delta f) - E_0^{\\text{uni}}(f-\\delta f)}{2 \\, \\delta f}, \\quad\nI'_{\\text{cut}}(f) = -\\frac{E_0^{\\text{cut}}(f+\\delta f) - E_0^{\\text{cut}}(f-\\delta f)}{2 \\, \\delta f}.\n$$\n然后计算\n$$\n\\Delta_I(f) = \\left| I'_{\\text{uni}}(f) - I'_{\\text{cut}}(f) \\right|.\n$$\n如果 $\\Delta_I(f)  \\varepsilon_I$（其中 $\\varepsilon_I = 10^{-8}$），则宣布电流不变。\n\n- 边界情况考虑：在 $f = 0$ 时，两种规范下的相位都消失，不变性是平凡的。在 $f = 0.5$（半个磁通量子）时，简并可能在 $E_0(f)$ 中产生尖点；中心有限差分仍然是一个定义良好的对称离散近似，规范不变性仍然存在。非常小的环（例如 $N = 3$）仍然遵守规范不变性；数值容差可以捕捉到残余的浮点误差。\n\n将上述过程应用于测试套件：\n- 测试用例 1：$N = 16$， $t = 1.0$， $f = 0.25$， $\\delta f = 10^{-6}$。\n- 测试用例 2：$N = 12$， $t = 1.0$， $f = 0.0$， $\\delta f = 10^{-6}$。\n- 测试用例 3：$N = 10$， $t = 2.0$， $f = 0.5$， $\\delta f = 10^{-6}$。\n- 测试用例 4：$N = 3$， $t = 1.0$， $f = 0.3$， $\\delta f = 10^{-6}$。\n\n程序为每个测试用例汇总两个布尔值 $[\\text{spectrum\\_invariant}, \\text{current\\_invariant}]$，并按以下格式打印单行\n$$\n[[\\text{b}_{11},\\text{b}_{12}],[\\text{b}_{21},\\text{b}_{22}],[\\text{b}_{31},\\text{b}_{32}],[\\text{b}_{41},\\text{b}_{42}]],\n$$\n其中每个 $\\text{b}_{ij}$ 是 $\\text{True}$ 或 $\\text{False}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_hamiltonian_uniform(N: int, t: float, f: float) - np.ndarray:\n    \"\"\"\n    Build the NxN tight-binding Hamiltonian for a ring with uniform azimuthal gauge.\n    Each bond carries the same phase corresponding to total flux 2*pi*f uniformly distributed.\n    \"\"\"\n    H = np.zeros((N, N), dtype=np.complex128)\n    # Phase per bond in the forward direction\n    phi = 2.0 * np.pi * f / N\n    hop_forward = -t * np.exp(1j * phi)\n    hop_backward = -t * np.exp(-1j * phi)\n    # Fill nearest-neighbor hoppings\n    for j in range(N - 1):\n        H[j, j + 1] = hop_forward\n        H[j + 1, j] = hop_backward\n    # Periodic boundary\n    H[N - 1, 0] = hop_forward\n    H[0, N - 1] = hop_backward\n    # On-site energies are zero\n    return H\n\ndef build_hamiltonian_cut(N: int, t: float, f: float) - np.ndarray:\n    \"\"\"\n    Build the NxN tight-binding Hamiltonian for a ring with single-branch-cut gauge.\n    All bonds are real except the boundary bond (N-1 to 0) carrying the total phase 2*pi*f.\n    \"\"\"\n    H = np.zeros((N, N), dtype=np.complex128)\n    # Real hopping for non-cut bonds\n    hop_real = -t\n    # Fill nearest-neighbor hoppings for bonds j - j+1 (except the boundary bond)\n    for j in range(N - 1):\n        H[j, j + 1] = hop_real\n        H[j + 1, j] = hop_real\n    # Boundary bond carries entire phase\n    boundary_forward = -t * np.exp(1j * 2.0 * np.pi * f)\n    boundary_backward = -t * np.exp(-1j * 2.0 * np.pi * f)\n    H[N - 1, 0] = boundary_forward\n    H[0, N - 1] = boundary_backward\n    # On-site energies are zero\n    return H\n\ndef spectrum(H: np.ndarray) - np.ndarray:\n    \"\"\"\n    Compute sorted eigenvalues of a Hermitian Hamiltonian.\n    \"\"\"\n    # eigh is for Hermitian matrices, returns real eigenvalues for Hermitian input\n    vals = np.linalg.eigh(H)[0]\n    vals.sort()\n    return vals\n\ndef ground_state_energy(H: np.ndarray) - float:\n    \"\"\"\n    Return the smallest eigenvalue (ground-state energy).\n    \"\"\"\n    vals = np.linalg.eigh(H)[0]\n    return float(np.min(vals))\n\ndef normalized_persistent_current(N: int, t: float, f: float, df: float,\n                                  builder) - float:\n    \"\"\"\n    Compute normalized persistent current I'(f) = -dE0/df via central difference\n    using the provided Hamiltonian builder (uniform or cut gauge).\n    \"\"\"\n    H_minus = builder(N, t, f - df)\n    H_plus = builder(N, t, f + df)\n    E_minus = ground_state_energy(H_minus)\n    E_plus = ground_state_energy(H_plus)\n    # Central difference\n    dE_df = (E_plus - E_minus) / (2.0 * df)\n    return -dE_df\n\ndef compare_gauges(N: int, t: float, f: float, df: float,\n                   tol_energy: float = 1e-10, tol_current: float = 1e-8):\n    \"\"\"\n    Compare the uniform and cut gauges for given parameters.\n    Returns a tuple of booleans: (spectrum_invariant, current_invariant).\n    \"\"\"\n    H_uni = build_hamiltonian_uniform(N, t, f)\n    H_cut = build_hamiltonian_cut(N, t, f)\n\n    spec_uni = spectrum(H_uni)\n    spec_cut = spectrum(H_cut)\n\n    # Max absolute difference between sorted spectra\n    # Spectra lengths are the same (N), both sorted\n    max_diff_energy = float(np.max(np.abs(spec_uni - spec_cut)))\n\n    # Normalized persistent current via central difference\n    I_uni = normalized_persistent_current(N, t, f, df, build_hamiltonian_uniform)\n    I_cut = normalized_persistent_current(N, t, f, df, build_hamiltonian_cut)\n    diff_current = abs(I_uni - I_cut)\n\n    spectrum_invariant = (max_diff_energy  tol_energy)\n    current_invariant = (diff_current  tol_current)\n    return spectrum_invariant, current_invariant\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (N, t, f, df)\n    test_cases = [\n        (16, 1.0, 0.25, 1e-6),  # Happy path\n        (12, 1.0, 0.0,  1e-6),  # Zero flux boundary\n        (10, 2.0, 0.5,  1e-6),  # Half flux quantum edge case\n        (3,  1.0, 0.3,  1e-6),  # Small ring edge case\n    ]\n\n    results = []\n    for case in test_cases:\n        N, t, f, df = case\n        spectrum_invariant, current_invariant = compare_gauges(N, t, f, df)\n        results.append([spectrum_invariant, current_invariant])\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of [bool,bool] per test case.\n    # No extra text.\n    def bool_list_to_str(lst):\n        # Convert list of [bool,bool] to string with True/False\n        return \"[\" + \",\".join(\"True\" if x else \"False\" for x in lst) + \"]\"\n    output = \"[\" + \",\".join(bool_list_to_str(r) for r in results) + \"]\"\n    print(output)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "实验物理学家面临的最终挑战之一是从复杂的测量数据中提取出真实的物理信号。本练习将引导您从理论上估算一个特征磁场 $B_{Z}^{\\ast}$，在该场强下，由自旋引起的塞曼能量劈裂与环的轨道量子化能级间距变得相当。这项实践有助于您理解何时必须考虑自旋自由度对输运性质的影响，并将纯理论模型与真实的实验参数联系起来。",
            "id": "4262379",
            "problem": "一个在砷化铟二维电子气（2DEG）中制造的准一维半导体纳米环，被建模为一个平均半径为 $R$、径向宽度可忽略不计（$w \\ll R$）的单模相干环。电子的有效质量为 $m^{\\ast}$，朗德 $g$ 因子为 $g$。一个垂直磁场 $B$ 穿过该环，同时产生阿哈罗诺夫-玻姆（AB）磁通和塞曼自旋分裂。可以忽略自旋轨道耦合；假设自旋分裂纯粹由塞曼效应引起。温度足够低，使得相位相关长度超过环的周长，并且环是弹道输运的。\n\n从环上的正则动量量子化和非相对论色散关系出发，估算当塞曼能量与费米能级处的轨道能级间距相当时的特征磁场 $B_{Z}^{\\ast}$。将该环视为一个一维通道，其波数量子化由存在 AB 磁通时的周期性边界条件决定，并使用宿主二维电子气相关的费米速度 $v_{F}$。明确地将塞曼能量与费米波数附近的轨道能级间距相等，并推导出一个以 $g$、玻尔磁子 $\\mu_{B}$、约化普朗克常数 $\\hbar$、环半径 $R$ 以及 $v_{F}$ 或费米波数 $k_{F}$ 和 $m^{\\ast}$ 表示的 $B_{Z}^{\\ast}$ 的闭合形式表达式。\n\n然后根据以下参数数值计算 $B_{Z}^{\\ast}$，将最终结果以特斯拉为单位表示，并四舍五入到三位有效数字：\n- 平均半径 $R = 250\\,\\text{nm}$，\n- 有效质量 $m^{\\ast} = 0.023\\,m_{e}$，\n- 朗德 $g$ 因子 $g = 15$，\n- 二维电子气面密度 $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2}$，\n- 使用 $k_{F} = \\sqrt{2\\pi n_{s}}$ 和 $v_{F} = \\hbar k_{F}/m^{\\ast}$。\n\n最后，基于你的表达式和数值估算，定性地简要讨论当 $B$ 接近并超过 $B_{Z}^{\\ast}$ 时，持久流 $I(\\Phi)$ 以及磁电导 AB 振荡的振幅和相位预计会如何变化，假设环被固定的 AB 磁通穿过，并且环限制之外的轨道朗道量子化可以忽略不计。\n\n你的最终答案必须是 $B_{Z}^{\\ast}$ 的单一数值，以特斯拉为单位，并四舍五入到三位有效数字。",
            "solution": "### 推导过程\n在垂直磁场 $B$ 中，纳米环内一个电子的总能量是其轨道能量和自旋（塞曼）能量之和。根据问题陈述，我们忽略自旋轨道耦合。\n\n被限制在半径为 $R$、被磁通量 $\\Phi = B \\pi R^2$ 穿过的一维环中的电子，其轨道能量是量子化的。轨道运动的单粒子哈密顿量由下式给出：\n$$\nH_{\\text{orb}} = \\frac{1}{2m^{\\ast}} \\left( \\hat{p}_{\\theta} + e A_{\\theta} \\right)^2\n$$\n其中 $\\hat{p}_{\\theta} = \\frac{-i\\hbar}{R} \\frac{\\partial}{\\partial\\theta}$ 是沿周长的正则动量算符，而 $A_{\\theta} = \\frac{B R}{2} = \\frac{\\Phi}{2\\pi R}$ 是方位角方向的磁矢量势。由于周期性边界条件 $\\psi(\\theta+2\\pi) = \\psi(\\theta)$，本征函数的形式为 $\\psi_n(\\theta) = \\frac{1}{\\sqrt{2\\pi}} \\exp(i n \\theta)$，其中 $n$ 是整数量子数。\n\n将哈密顿量作用于这些本征函数，得到能量本征值：\n$$\nE_{n}^{\\text{orb}} = \\frac{1}{2m^{\\ast} R^2} \\left( \\hbar n + e R A_{\\theta} \\right)^2 = \\frac{1}{2m^{\\ast} R^2} \\left( \\hbar n + \\frac{e\\Phi}{2\\pi} \\right)^2\n$$\n使用磁通量子 $\\Phi_0 = h/e = 2\\pi\\hbar/e$，表达式简化为：\n$$\nE_{n}^{\\text{orb}} = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left( n + \\frac{\\Phi}{\\Phi_0} \\right)^2\n$$\n\n塞曼能量源于电子的自旋磁矩与磁场的相互作用。它由 $E_Z = g \\mu_B m_s B$ 给出，其中 $m_s = \\pm 1/2$ 是自旋量子数，$g$ 是朗德 $g$ 因子，$\\mu_B = e\\hbar/(2m_e)$ 是玻尔磁子。两个自旋态之间的能量分裂为 $\\Delta E_Z = g \\mu_B B$。\n\n问题要求我们找到费米能级处的轨道能级间距。相邻轨道能级 $n$ 和 $n+1$ 之间的能量间距为：\n$$\n\\Delta E_{n, n+1}^{\\text{orb}} = E_{n+1}^{\\text{orb}} - E_{n}^{\\text{orb}} = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left[ \\left( n+1 + \\frac{\\Phi}{\\Phi_0} \\right)^2 - \\left( n + \\frac{\\Phi}{\\Phi_0} \\right)^2 \\right] = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left( 2n + 1 + 2\\frac{\\Phi}{\\Phi_0} \\right)\n$$\n在费米能级处，相关的量子数 $n$ 是费米量子数 $n_F$，它通过 $n_F \\approx k_F R$ 与费米波数 $k_F$ 相关。通常，对于纳米环，$n_F \\gg 1$。此外，阿哈罗诺夫-玻姆相位项 $\\Phi/\\Phi_0$ 的数量级为 1。因此，我们可以近似为 $2n + 1 + 2\\Phi/\\Phi_0 \\approx 2n_F$。费米能级处的轨道能级间距变为：\n$$\n\\Delta E_{\\text{orb}} \\approx \\frac{\\hbar^2}{2m^{\\ast} R^2} (2n_F) = \\frac{\\hbar^2 n_F}{m^{\\ast} R^2}\n$$\n代入 $n_F = k_F R$，我们得到：\n$$\n\\Delta E_{\\text{orb}} = \\frac{\\hbar^2 (k_F R)}{m^{\\ast} R^2} = \\frac{\\hbar^2 k_F}{m^{\\ast} R}\n$$\n使用费米速度的定义 $v_F = \\hbar k_F / m^{\\ast}$，这个间距可以表示为：\n$$\n\\Delta E_{\\text{orb}} = \\frac{\\hbar v_F}{R}\n$$\n这个结果也可以从一维系统的色散关系 $E(k) = \\hbar^2 k^2/(2m^{\\ast})$ 得到，其中能级间距为 $\\Delta E \\approx \\frac{dE}{dk} \\Delta k$。在费米能级处，$\\frac{dE}{dk}|_{k_F} = \\frac{\\hbar^2 k_F}{m^{\\ast}} = \\hbar v_F$。环上的量子化条件 $k=n/R$ 意味着波数空间中的间距为 $\\Delta k = 1/R$。因此，$\\Delta E_{\\text{orb}} = (\\hbar v_F)(1/R)$。\n\n问题将特征磁场 $B_{Z}^{\\ast}$ 定义为塞曼分裂等于此轨道能级间距时的磁场：\n$$\n\\Delta E_Z = \\Delta E_{\\text{orb}}\n$$\n$$\ng \\mu_B B_{Z}^{\\ast} = \\frac{\\hbar v_F}{R}\n$$\n求解 $B_{Z}^{\\ast}$，得到以 $v_F$ 表示的表达式：\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar v_F}{g \\mu_B R}\n$$\n为了用 $k_F$ 和 $m^{\\ast}$ 表示，我们代入 $v_F = \\hbar k_F / m^{\\ast}$：\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar}{g \\mu_B R} \\left( \\frac{\\hbar k_F}{m^{\\ast}} \\right) = \\frac{\\hbar^2 k_F}{g \\mu_B m^{\\ast} R}\n$$\n这就是所要求的闭合形式表达式。\n\n### 数值计算\n我们给定了以下参数：\n- $R = 250\\,\\text{nm} = 2.50 \\times 10^{-7}\\,\\text{m}$\n- $m^{\\ast} = 0.023\\,m_{e} = 0.023 \\times (9.10938 \\times 10^{-31}\\,\\text{kg}) \\approx 2.095 \\times 10^{-32}\\,\\text{kg}$\n- $g = 15$\n- $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2} = 2.50 \\times 10^{15}\\,\\text{m}^{-2}$\n\n以及基本常数：\n- $\\hbar \\approx 1.05457 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n- $\\mu_B \\approx 9.27401 \\times 10^{-24}\\,\\text{J}\\cdot\\text{T}^{-1}$\n\n首先，我们计算二维电子气的费米波数 $k_F$：\n$$\nk_F = \\sqrt{2\\pi n_{s}} = \\sqrt{2\\pi (2.50 \\times 10^{15}\\,\\text{m}^{-2})} \\approx 1.2533 \\times 10^{8}\\,\\text{m}^{-1}\n$$\n现在，我们可以将所有数值代入 $B_{Z}^{\\ast}$ 的表达式中：\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar^2 k_F}{g \\mu_B m^{\\ast} R}\n$$\n$$\nB_{Z}^{\\ast} = \\frac{(1.05457 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s})^2 (1.2533 \\times 10^{8}\\,\\text{m}^{-1})}{(15) (9.27401 \\times 10^{-24}\\,\\text{J}\\cdot\\text{T}^{-1}) (2.095 \\times 10^{-32}\\,\\text{kg}) (2.50 \\times 10^{-7}\\,\\text{m})} \\approx 1.91\\,\\text{T}\n$$\n四舍五入到三位有效数字，我们得到 $B_{Z}^{\\ast} = 1.91\\,\\text{T}$。\n\n### 定性讨论\n持久流 $I(\\Phi)$ 和磁电导中的阿哈罗诺夫-玻姆（AB）振荡依赖于能谱 $E_{n,m_s}$。这两种现象都对磁通量 $\\Phi$ 呈周期性，周期为 $\\Phi_0 = h/e$。当 $B=0$ 时，自旋向上和自旋向下的能级是简并的。当 $B$ 从零开始增加时，简并被解除，出现两组抛物线形的能谱，它们之间相对移动了塞曼能量 $\\Delta E_Z = g \\mu_B B$。\n- **持久流 $I(\\Phi)$**：总电流 $I(\\Phi) = I^{\\uparrow}(\\Phi) + I^{\\downarrow}(\\Phi)$ 是两个周期为 $\\Phi_0$ 的信号的叠加。当 $B$ 接近 $B_{Z}^{\\ast}$ 时，塞曼分裂 $\\Delta E_Z$ 变得与轨道能级间距 $\\Delta E_{\\text{orb}}$ 相当。这导致具有不同自旋和轨道量子数的态之间发生能级交叉（例如，$E_{n, \\uparrow} \\approx E_{n+1, \\downarrow}$），从而显著改变系统基态构型随磁通的变化，导致持久流的振幅、形状甚至符号发生剧烈变化。\n- **磁电导 AB 振荡**：总电导是两个自旋通道贡献的总和，$G(\\Phi) = G^{\\uparrow}(\\Phi) + G^{\\downarrow}(\\Phi)$。当塞曼分裂 $\\Delta E_Z$ 达到轨道间距 $\\Delta E_{\\text{orb}}$ 的一个显著部分时，总 AB 振荡的振幅会受到调制。当 $B$ 接近并超过 $B_{Z}^{\\ast}$ 时，自旋通道之间相长或相消干涉的条件发生变化，可能导致 AB 振荡振幅随磁场 $B$ 的变化而出现抑制（猝灭）和随后的恢复。因此，$B_{Z}^{\\ast}$ 代表了控制纳米环磁输运性质中自旋和轨道效应相互作用的一个基本场标度。",
            "answer": "$$\n\\boxed{1.91}\n$$"
        },
        {
            "introduction": "实验物理学家面临的最终挑战之一是从复杂的测量数据中提取出真实的物理信号。本练习模拟了这一过程，要求您从一个包含了真实AB振荡、平滑的磁阻背景以及其他干扰伪影的合成信号中，分离并验证阿哈罗诺夫-玻姆信号。您将运用信号处理技术，如多项式去趋势和傅里叶分析，来揭示隐藏的周期性信号，这对于在纳米电子学领域进行有效的数据分析至关重要。",
            "id": "4262338",
            "problem": "考虑一个单电子相干输运过程，该过程通过一个具有两条形成闭合回路路径的介观纳米环。该纳米环置于一个径向上可能非均匀的外加磁场中。核心可观测量是由 Aharonov-Bohm 相位引起的、依赖于干涉的电导调制。您必须对测量信号进行建模，并实现一种计算策略，以从由非均匀磁场和一般磁阻趋势引起的背景伪影中分离出真实的 Aharonov-Bohm 信号特征。\n\n使用以下基本原理：\n\n- 在存在矢量势的情况下，沿路径获得的量子力学相位由 $ \\Delta \\varphi_{\\mathrm{AB}} = \\frac{q}{\\hbar} \\oint \\mathbf{A} \\cdot d\\boldsymbol{\\ell} $ 给出，其中 $q$ 是电荷，$\\hbar$ 是约化普朗克常数。根据 Stokes 定理，对于一个包围面积 $S$ 的闭合回路，$ \\Delta \\varphi_{\\mathrm{AB}} = \\frac{q}{\\hbar} \\iint_S \\mathbf{B} \\cdot d\\mathbf{S} $。\n- 定义磁通量子 $ \\Phi_0 = \\frac{h}{|q|} $，其中 $h$ 为普朗克常数。对于电子，使用 $ |q| = e $，其中 $e$ 是元电荷。\n\n几何与磁场模型：\n\n- 设纳米环的平均半径为 $ R $，径向宽度为 $ w $，因此内半径为 $ r_{\\mathrm{in}} = R - \\frac{w}{2} $，外半径为 $ r_{\\mathrm{out}} = R + \\frac{w}{2} $。环形面积为 $ S = \\pi \\left(r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2\\right) $。\n- 假设一个轴向对称的磁场分布 $ B(r; B) = B + g \\left(r - R\\right) + c \\left(r - R\\right)^2 $，其中 $B$ 是以特斯拉为单位的均匀外部扫描场，$g$ 是以特斯拉/米为单位的一阶径向梯度，$c$ 是以特斯拉/平方米为单位的二阶径向曲率。所有相位量的角度单位均为弧度。\n\n干涉与测量模型：\n\n- 设测量的归一化信号模型为\n$$ G(B) = G_0 + A_{\\mathrm{AB}} \\cos\\!\\left( \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 \\right) + M(B) + N(B), $$\n其中 $ G_0 $ 是一个恒定偏移，$ A_{\\mathrm{AB}} $ 是 Aharonov-Bohm 振荡幅度，$ \\Phi(B) = \\iint_S B(r; B)\\, dS $ 是通过环的磁通量，$ \\varphi_0 $ 是一个相位偏移（以弧度为单位），$ M(B) $ 是一个平滑的磁阻背景，$ N(B) $ 是一个确定性干扰项，用于模拟与 Aharonov-Bohm 效应无关的虚假振荡。\n- 平滑背景被建模为一个三次多项式 $ M(B) = \\alpha B + \\beta B^2 + \\gamma B^3 $，其系数为 $ \\alpha, \\beta, \\gamma $。\n- 干扰项被建模为两个正弦分量的和 $ N(B) = s_1 \\sin\\!\\left( 2\\pi f_1 B \\right) + s_2 \\sin\\!\\left( 2\\pi f_2 B \\right) $，频率 $ f_1, f_2 $ 的单位是周期/特斯拉，振幅为 $ s_1, s_2 $。\n\n目标：\n\n1. 从基本原理出发，推导 Aharonov-Bohm 相位对扫描场 $ B $ 的依赖关系，并说明非均匀性参数 $ g $ 和 $ c $ 是改变振荡频率还是仅改变相位偏移。\n2. 实现一个程序来：\n   - 在指定的场扫描范围内的等间距网格上合成 $ G(B) $。\n   - 使用两步策略分离出真实的 Aharonov-Bohm 信号特征：\n     a) 通过拟合和减去一个关于 $ B $ 的三次多项式来去除趋势，以移除 $ M(B) $。\n     b) 使用 Hann 窗和离散傅里叶变换对残差进行频域分析，以评估理论 Aharonov-Bohm 频率处的振幅。\n   - 在理论频率处使用信号背景比来量化检测结果，其中背景水平由除最接近理论频率的频点之外的所有正频率上的谱振幅中位数来表征。\n   - 通过将残差投影到 $ \\cos\\!\\left( 2\\pi f_{\\mathrm{AB}} B \\right) $ 和 $ \\sin\\!\\left( 2\\pi f_{\\mathrm{AB}} B \\right) $ 上，并计算分数 $ \\mathrm{Var}(G_{\\mathrm{AB}})/\\mathrm{Var}(G_{\\mathrm{res}}) $，来量化 Aharonov-Bohm 分量解释了多少残差方差。\n3. 对于每个测试用例，输出：\n   - 理论 Aharonov-Bohm 周期，单位为特斯拉，定义为 $ \\Delta B_{\\mathrm{AB}} = \\Phi_0 / S $，四舍五入到六位小数。\n   - 一个布尔值，当信号背景比大于 $ 6 $ 时表示检测成功。\n   - 方差分数，以小数形式表示，四舍五入到六位小数。\n\n测试套件：\n\n使用以下三个测试用例，每个用例都指定了 $ R $（米）、$ w $（米）、$ g $（特斯拉/米）、$ c $（特斯拉/平方米）、$ A_{\\mathrm{AB}} $（无量纲）、$ G_0 $（无量纲）、$ \\alpha, \\beta, \\gamma $（与以特斯拉为单位的 $ B $ 一致的无量纲系数）、$ s_1, s_2 $（无量纲）、$ f_1, f_2 $（周期/特斯拉）、扫描范围 $ B_{\\min} $ 和 $ B_{\\max} $（特斯拉）以及点数 $ N $。\n\n- 用例 1（基线，近均匀场）：\n  - $ R = 2.00 \\times 10^{-7} $, $ w = 4.00 \\times 10^{-8} $, $ g = 0.0 $, $ c = 0.0 $,\n  - $ A_{\\mathrm{AB}} = 0.15 $, $ G_0 = 0.0 $,\n  - $ \\alpha = 0.01 $, $ \\beta = 0.25 $, $ \\gamma = 0.00 $,\n  - $ s_1 = 0.02 $, $ s_2 = 0.01 $, $ f_1 = 7.3 $, $ f_2 = 20.0 $,\n  - $ B_{\\min} = -0.4 $, $ B_{\\max} = 0.4 $, $ N = 4096 $。\n\n- 用例 2（中等非均匀性，较强背景）：\n  - $ R = 2.00 \\times 10^{-7} $, $ w = 4.00 \\times 10^{-8} $, $ g = 500.0 $, $ c = 1.00 \\times 10^{7} $,\n  - $ A_{\\mathrm{AB}} = 0.12 $, $ G_0 = 0.0 $,\n  - $ \\alpha = 0.02 $, $ \\beta = 0.35 $, $ \\gamma = 0.02 $,\n  - $ s_1 = 0.03 $, $ s_2 = 0.02 $, $ f_1 = 9.1 $, $ f_2 = 18.0 $,\n  - $ B_{\\min} = -0.4 $, $ B_{\\max} = 0.4 $, $ N = 4096 $。\n\n- 用例 3（窄环，弱 Aharonov-Bohm 振幅，较强干扰）：\n  - $ R = 2.00 \\times 10^{-7} $, $ w = 1.00 \\times 10^{-8} $, $ g = 500.0 $, $ c = 5.00 \\times 10^{7} $,\n  - $ A_{\\mathrm{AB}} = 0.04 $, $ G_0 = 0.0 $,\n  - $ \\alpha = 0.03 $, $ \\beta = 0.40 $, $ \\gamma = 0.05 $,\n  - $ s_1 = 0.04 $, $ s_2 = 0.03 $, $ f_1 = 6.0 $, $ f_2 = 22.0 $,\n  - $ B_{\\min} = -0.4 $, $ B_{\\max} = 0.4 $, $ N = 4096 $。\n\n实现要求：\n\n- 使用 $ e = 1.602176634 \\times 10^{-19} \\, \\mathrm{C} $ 和 $ h = 6.62607015 \\times 10^{-34} \\, \\mathrm{J\\cdot s} $，使得 $ \\Phi_0 = h/e $ 的单位为韦伯。\n- 最终输出必须是单行，包含一个列表的列表，每个内部列表对应于上述顺序的一个测试用例：$ [\\Delta B_{\\mathrm{AB}}, \\text{detected}, \\text{variance\\_fraction}] $。所有角度必须以弧度处理。周期 $ \\Delta B_{\\mathrm{AB}} $ 必须以特斯拉表示并四舍五入到六位小数；方差分数必须是小数并四舍五入到六位小数；布尔值应为 True 或 False。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$ [[0.082300,\\mathrm{True},0.512345],[\\dots]] $）。",
            "solution": "### 1. 理论推导：阿哈罗诺夫-玻姆相位与场非均匀性\n\n主要目标是确定阿哈罗诺夫-玻姆（AB）振荡频率如何受非均匀磁场的影响。AB效应核心的量子相位与电子路径所包围的磁通量 $ \\Phi(B) $ 成正比。电导模型中的总相位参数为 $ \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 $。我们必须首先计算通过环形纳米环的总磁通量 $ \\Phi(B) $。\n\n磁通量是磁场 $ B(r; B) $ 在环形面积 $ S $ 上的积分。鉴于轴向对称性，面积元为 $ dS = 2\\pi r dr $。磁场建模为 $ B(r; B) = B + g(r-R) + c(r-R)^2 $。\n\n总磁通量为：\n$$ \\Phi(B) = \\iint_S B(r; B) \\, dS = \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ B + g(r-R) + c(r-R)^2 \\right] 2\\pi r \\, dr $$\n其中 $ r_{\\mathrm{in}} = R - w/2 $ 和 $ r_{\\mathrm{out}} = R + w/2 $ 分别是内半径和外半径。\n\n我们可以将积分分为依赖于扫描场 $ B $ 的部分和相对于 $ B $ 恒定的部分：\n$$ \\Phi(B) = \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} B \\cdot 2\\pi r \\, dr + \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ g(r-R) + c(r-R)^2 \\right] 2\\pi r \\, dr $$\n\n第一项代表来自均匀场分量的磁通量，简化为：\n$$ B \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} 2\\pi r \\, dr = B \\cdot \\pi (r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2) = B \\cdot S $$\n环形面积 $ S = \\pi (r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2) $ 可简化为 $ S = \\pi ((R+w/2)^2 - (R-w/2)^2) = \\pi(2Rw) = 2\\pi R w $。\n\n第二项 $ \\Phi_{\\mathrm{inhom}} $ 是来自场的径向非均匀性的磁通量，并且独立于扫描场 $ B $：\n$$ \\Phi_{\\mathrm{inhom}} = 2\\pi \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ g(r^2 - Rr) + c(r^3 - 2Rr^2 + R^2r) \\right] dr $$\n对于给定的环几何形状和非均匀性参数 $ g $ 和 $ c $，计算此定积分会得到一个恒定值。\n\n因此，总磁通量是 $ B $ 的一个线性函数：\n$$ \\Phi(B) = S \\cdot B + \\Phi_{\\mathrm{inhom}} $$\n\n将此代入电导模型的余弦参数中：\n$$ \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 = \\frac{2\\pi}{\\Phi_0} (S \\cdot B + \\Phi_{\\mathrm{inhom}}) + \\varphi_0 = \\left(\\frac{2\\pi S}{\\Phi_0}\\right) B + \\left(\\frac{2\\pi \\Phi_{\\mathrm{inhom}}}{\\Phi_0} + \\varphi_0\\right) $$\n该表达式的形式为 $ 2\\pi f_{\\mathrm{AB}} B + \\varphi'_{\\mathrm{total}} $，其中：\n- 相对于 $ B $ 的振荡频率为 $ f_{\\mathrm{AB}} = \\frac{S}{\\Phi_0} $。\n- 总相位偏移为 $ \\varphi'_{\\mathrm{total}} = \\frac{2\\pi \\Phi_{\\mathrm{inhom}}}{\\Phi_0} + \\varphi_0 $。\n\n该推导表明，非均匀性参数 $ g $ 和 $ c $ **不改变阿哈罗诺夫-玻姆振荡频率** $ f_{\\mathrm{AB}} $。它们仅对一个独立于扫描场 $ B $ 的恒定相位偏移有贡献。AB 振荡的周期仅由环的面积 $ S $ 和磁通量子 $ \\Phi_0 $ 决定：\n$$ \\Delta B_{\\mathrm{AB}} = \\frac{1}{f_{\\mathrm{AB}}} = \\frac{\\Phi_0}{S} $$\n\n### 2. 计算策略\n\n所给问题要求进行计算分析，以从复合测量信号 $ G(B) $ 中提取 AB 信号。该策略按以下方式实现：\n\n**步骤 1：信号合成**\n对于每个测试用例，在从 $ B_{\\min} $ 到 $ B_{\\max} $ 的 $ N $ 个点的等间距网格上合成信号 $ G(B) $。这涉及计算模型的每个分量：\n- **阿哈罗诺夫-玻姆项：** $ A_{\\mathrm{AB}} \\cos( \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 ) $。总磁通量 $ \\Phi(B) $ 使用上面推导的公式计算。未指定的相位偏移 $ \\varphi_0 $ 取为 $ 0 $，因为分析方法对该初始相位不敏感。\n- **磁阻背景：** $ M(B) = \\alpha B + \\beta B^2 + \\gamma B^3 $。\n- **干扰项：** $ N(B) = s_1 \\sin(2\\pi f_1 B) + s_2 \\sin(2\\pi f_2 B) $。\n这些分量与偏移量 $ G_0 $ 相加，以生成完整信号 $ G(B) $。\n\n**步骤 2：背景去趋势**\n平滑的低频磁阻背景 $ M(B) $ 是一个重要的伪影。为移除它，使用最小二乘法（`numpy.polyfit`）将一个三次多项式拟合到合成信号 $ G(B) $。然后将这个用于建模 $ G_0 + M(B) $ 的拟合多项式从 $ G(B) $ 中减去，得到残差信号 $ G_{\\mathrm{res}}(B) $，理想情况下它只包含 AB 振荡和干扰信号。\n$$ G_{\\mathrm{res}}(B) = G(B) - (\\hat{G}_0 + \\hat{\\alpha} B + \\hat{\\beta} B^2 + \\hat{\\gamma} B^3) \\approx A_{\\mathrm{AB}} \\cos(\\dots) + N(B) $$\n\n**步骤 3：频域分析**\n为了分离和量化 AB 信号特征，我们分析残差信号 $ G_{\\mathrm{res}}(B) $ 的频率内容。\n- 对 $ G_{\\mathrm{res}}(B) $ 应用 **Hann 窗**以减少频谱泄漏，当对在采样窗口内非周期的有限长度信号执行离散傅里叶变换（DFT）时，会发生频谱泄漏。\n- 对加窗后的残差计算**快速傅里叶变换（FFT）**，特别是实值版本（`scipy.fft.rfft`），以获得其振幅谱。该频谱的 x 轴表示频率，单位为周期/特斯拉（$ \\mathrm{T}^{-1} $）。\n\n**步骤 4：用于检测的信号背景比（SBR）**\n真实的 AB 信号应在振幅谱中理论计算频率 $ f_{\\mathrm{AB}} = S/\\Phi_0 $ 处表现为一个峰值。\n- **信号：** 最接近 $ f_{\\mathrm{AB}} $ 的频率仓处的频谱分量振幅被识别为信号强度。\n- **背景：** 背景水平由所有其他正频率上的谱振幅的**中位数**来表征。为避免 AB 峰自身的频谱泄漏使背景估计产生偏差，一个小的频率仓窗口（峰值仓及其直接相邻点）被排除在众数计算之外。直流分量（频率 $ 0 $）也被排除。\n- **SBR 与检测：** SBR 是信号振幅与背景水平的比值。如果该比值超过阈值 $ 6 $，则检测被视为成功。\n\n**步骤 5：解释方差量化**\n该指标量化了 AB 分量本身在多大程度上解释了残差信号的振荡内容。\n- 残差信号 $ G_{\\mathrm{res}}(B) $ 被投影到以理论 AB 频率 $ f_{\\mathrm{AB}} $ 振荡的正弦和余弦函数的正交基上。这等价于将 $ G_{\\mathrm{res}}(B) $ 最小二乘拟合到一个模型 $ A_c \\cos(2\\pi f_{\\mathrm{AB}} B) + A_s \\sin(2\\pi f_{\\mathrm{AB}} B) $。\n- 得到的拟合信号 $ G_{\\mathrm{AB,proj}}(B) $ 代表了可由纯 AB 振荡描述的那部分残差。\n- 解释的方差分数计算为投影信号的方差与总残差信号的方差之比：$ \\mathrm{Var}(G_{\\mathrm{AB,proj}}) / \\mathrm{Var}(G_{\\mathrm{res}}) $。接近 $ 1 $ 的值表示 AB 效应对残差信号的方差起主导作用。\n\n最后，计算每个测试用例所需的输出——理论 AB 周期 $ \\Delta B_{\\mathrm{AB}} $、布尔检测结果和方差分数——并按指定要求四舍五入，格式化为最终输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Solves the Aharonov-Bohm effect problem for a set of test cases.\n    It synthesizes the measured signal, applies a detrending and FFT-based\n    analysis to isolate the AB signature, and quantifies the detection and\n    variance contribution.\n    \"\"\"\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    h = 6.62607015e-34    # Planck's constant in J*s\n    Phi_0 = h / e        # Magnetic flux quantum in Webers (T*m^2)\n\n    # Test suite\n    test_cases = [\n        # Case 1\n        {\n            \"R\": 2.00e-7, \"w\": 4.00e-8, \"g\": 0.0, \"c\": 0.0,\n            \"A_AB\": 0.15, \"G_0\": 0.0,\n            \"alpha\": 0.01, \"beta\": 0.25, \"gamma\": 0.00,\n            \"s1\": 0.02, \"s2\": 0.01, \"f1\": 7.3, \"f2\": 20.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n        # Case 2\n        {\n            \"R\": 2.00e-7, \"w\": 4.00e-8, \"g\": 500.0, \"c\": 1.00e7,\n            \"A_AB\": 0.12, \"G_0\": 0.0,\n            \"alpha\": 0.02, \"beta\": 0.35, \"gamma\": 0.02,\n            \"s1\": 0.03, \"s2\": 0.02, \"f1\": 9.1, \"f2\": 18.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n        # Case 3\n        {\n            \"R\": 2.00e-7, \"w\": 1.00e-8, \"g\": 500.0, \"c\": 5.00e7,\n            \"A_AB\": 0.04, \"G_0\": 0.0,\n            \"alpha\": 0.03, \"beta\": 0.40, \"gamma\": 0.05,\n            \"s1\": 0.04, \"s2\": 0.03, \"f1\": 6.0, \"f2\": 22.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        # Unpack parameters for clarity\n        R, w, g, c = params[\"R\"], params[\"w\"], params[\"g\"], params[\"c\"]\n        A_AB, G_0 = params[\"A_AB\"], params[\"G_0\"]\n        alpha, beta, gamma = params[\"alpha\"], params[\"beta\"], params[\"gamma\"]\n        s1, s2, f1, f2 = params[\"s1\"], params[\"s2\"], params[\"f1\"], params[\"f2\"]\n        B_min, B_max, N = params[\"B_min\"], params[\"B_max\"], params[\"N\"]\n        \n        # 1. Theoretical Calculations\n        S = 2 * np.pi * R * w\n        delta_B_ab = Phi_0 / S\n        f_ab = 1 / delta_B_ab\n\n        # 2. Synthesize Signal G(B)\n        B_sweep = np.linspace(B_min, B_max, N)\n        \n        # Calculate inhomogeneous flux contribution\n        r_in = R - w / 2\n        r_out = R + w / 2\n\n        def flux_integral_term(r, R_val, g_val, c_val):\n            term_g = g_val * (r**3 / 3 - R_val * r**2 / 2)\n            term_c = c_val * (r**4 / 4 - 2 * R_val * r**3 / 3 + R_val**2 * r**2 / 2)\n            return term_g + term_c\n        \n        Phi_inhom = 2 * np.pi * (flux_integral_term(r_out, R, g, c) - flux_integral_term(r_in, R, g, c))\n        total_flux = S * B_sweep + Phi_inhom\n\n        # Signal components (phi_0 = 0)\n        G_ab_term = A_AB * np.cos(2 * np.pi / Phi_0 * total_flux)\n        M_B_term = alpha * B_sweep + beta * B_sweep**2 + gamma * B_sweep**3\n        N_B_term = s1 * np.sin(2 * np.pi * f1 * B_sweep) + s2 * np.sin(2 * np.pi * f2 * B_sweep)\n        \n        G = G_0 + G_ab_term + M_B_term + N_B_term\n\n        # 3. Analysis: Detrending\n        poly_coeffs = np.polyfit(B_sweep, G, 3)\n        poly_fit = np.polyval(poly_coeffs, B_sweep)\n        G_res = G - poly_fit\n\n        # 4. Analysis: FFT\n        hann_window = np.hanning(N)\n        G_res_windowed = G_res * hann_window\n        \n        G_spectrum = fft.rfft(G_res_windowed)\n        amp_spectrum = np.abs(G_spectrum)\n        \n        dB = (B_max - B_min) / (N - 1)\n        freqs = fft.rfftfreq(N, d=dB)\n        \n        # 5. SBR Calculation\n        idx_ab = np.argmin(np.abs(freqs - f_ab))\n        signal_amp = amp_spectrum[idx_ab]\n        \n        background_mask = np.ones_like(freqs, dtype=bool)\n        background_mask[0] = False # Exclude DC component\n\n        # Exclude window of 3 bins around AB peak from background\n        win_start = max(0, idx_ab - 1)\n        win_end = min(len(freqs), idx_ab + 2)\n        background_mask[win_start:win_end] = False\n        \n        background_level = np.median(amp_spectrum[background_mask])\n        \n        sbr = signal_amp / background_level if background_level > 1e-12 else np.inf\n        detected = sbr > 6.0\n\n        # 6. Variance Fraction Calculation\n        c_basis = np.cos(2 * np.pi * f_ab * B_sweep)\n        s_basis = np.sin(2 * np.pi * f_ab * B_sweep)\n\n        # Projection of G_res onto the AB basis functions\n        A_c = np.dot(G_res, c_basis) / np.dot(c_basis, c_basis)\n        A_s = np.dot(G_res, s_basis) / np.dot(s_basis, s_basis)\n        \n        G_ab_proj = A_c * c_basis + A_s * s_basis\n\n        var_g_ab = np.var(G_ab_proj)\n        var_g_res = np.var(G_res)\n\n        var_fraction = var_g_ab / var_g_res if var_g_res > 1e-12 else 0.0\n\n        # 7. Store results\n        all_results.append([delta_B_ab, detected, var_fraction])\n\n    # 8. Print final output in the required format\n    final_output_strings = []\n    for res in all_results:\n        period, is_detected, var_frac = res\n        res_str = f\"[{period:.6f},{str(is_detected)},{var_frac:.6f}]\"\n        final_output_strings.append(res_str)\n    \n    print(f\"[{','.join(final_output_strings)}]\")\n\nsolve()\n```"
        }
    ]
}