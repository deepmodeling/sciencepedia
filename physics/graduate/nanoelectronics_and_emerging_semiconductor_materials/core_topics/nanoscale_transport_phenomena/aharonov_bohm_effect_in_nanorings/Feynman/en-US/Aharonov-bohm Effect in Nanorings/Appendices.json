{
    "hands_on_practices": [
        {
            "introduction": "The Aharonov-Bohm effect is fundamentally a consequence of the magnetic vector potential, $\\mathbf{A}$, which is not a unique quantity; different choices of $\\mathbf{A}$ that produce the same magnetic field $\\mathbf{B}$ are related by a gauge transformation. This practice provides a crucial hands-on demonstration of gauge invariance, a cornerstone of quantum electrodynamics. By numerically constructing the tight-binding Hamiltonian for a nanoring using two different gauges , you will verify from first principles that physical observables like the energy spectrum and persistent current are independent of the mathematical description chosen, solidifying your understanding of the underlying physics.",
            "id": "4262357",
            "problem": "Consider an ideal one-dimensional nanoring with $N$ lattice sites described by a tight-binding Hamiltonian for a single spinless electron with nearest-neighbor hopping amplitude $t$. In the presence of a magnetic flux $\\Phi$ threading the ring, the dynamics are governed by the principle of minimal coupling from non-relativistic quantum mechanics: the canonical momentum is modified according to $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$, where $q$ is the electron charge and $\\mathbf{A}$ is the magnetic vector potential. The Aharonov-Bohm (AB) effect stipulates that physical observables can depend on the enclosed flux $\\Phi$ through the ring even when the magnetic field is confined to the interior and vanishes along the electron’s path. The magnetic flux quantum is $\\Phi_0 = h/e$, and in tight-binding models the effect of $\\mathbf{A}$ can be consistently incorporated using the Peierls substitution, which multiplies each hopping term by a phase factor given by the line integral of $\\mathbf{A}$ along the bond.\n\nIn a ring geometry, different gauge choices for $\\mathbf{A}$ that yield the same total flux $\\Phi$ are related by gauge transformations, and therefore physical observables must be gauge invariant. Two mathematically well-defined gauge choices for representing the same total flux in a discrete ring are:\n- A uniform azimuthal gauge, in which the total phase $2\\pi f$ with $f = \\Phi/\\Phi_0$ is distributed equally across all $N$ bonds, so that the forward hopping between site $j$ and site $j+1$ carries the same phase factor for all $j$ and the backward hopping carries the complex conjugate. This corresponds to a tangential $\\mathbf{A}$ that is constant along the ring in the continuum.\n- A single-branch-cut gauge, in which the entire phase $2\\pi f$ is concentrated on a single bond (e.g., between sites $N-1$ and $0$), while all other bonds have real hopping amplitudes. This corresponds to a gauge where $\\mathbf{A}$ is pure gauge everywhere along the ring except at a branch cut.\n\nYour task is to demonstrate numerically, from first principles, that the energy spectrum and the ground-state persistent current are invariant under these gauge choices. Use only the following foundational bases:\n- The minimal coupling principle $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$ in the Schrödinger equation.\n- The Peierls substitution for tight-binding models in the presence of a magnetic vector potential.\n- The definition of the magnetic flux quantum $\\Phi_0 = h/e$.\n- The fact that gauge transformations act as unitary transformations on the Hamiltonian and do not change physical spectra.\n\nDefine the dimensionless flux parameter $f = \\Phi/\\Phi_0$ (unitless), and construct two $N \\times N$ tight-binding Hamiltonians $H_{\\text{uni}}(N,t,f)$ and $H_{\\text{cut}}(N,t,f)$ corresponding to the uniform azimuthal gauge and the single-branch-cut gauge, respectively, with periodic boundary conditions. Assume zero on-site energies. Compute the sorted energy spectra for both Hamiltonians at each test flux, and compute the ground-state energy $E_0(f)$ for each gauge. Approximate the normalized ground-state persistent current by a central finite difference as $I'(f) = -\\frac{\\partial E_0}{\\partial f}$ using a small step $\\delta f$, noting that $I'(f)$ has units of energy per flux quantum; since you will only compare invariance, you do not need to express $I'(f)$ in physical units.\n\nDefine tolerances $\\varepsilon_E = 10^{-10}$ and $\\varepsilon_I = 10^{-8}$. For each test case, produce two boolean results:\n- A spectrum invariance boolean indicating whether the maximum absolute difference between the sorted energy spectra from the two gauges is less than $\\varepsilon_E$.\n- A current invariance boolean indicating whether the absolute difference between $I'(f)$ computed from the two gauges is less than $\\varepsilon_I$.\n\nImplement the program to evaluate the following test suite, where all parameters are dimensionless or in units that do not require explicit reporting because only booleans are output:\n- Test case $1$: $N = 16$, $t = 1.0$, $f = 0.25$, $\\delta f = 10^{-6}$.\n- Test case $2$: $N = 12$, $t = 1.0$, $f = 0.0$, $\\delta f = 10^{-6}$.\n- Test case $3$: $N = 10$, $t = 2.0$, $f = 0.5$, $\\delta f = 10^{-6}$.\n- Test case $4$: $N = 3$, $t = 1.0$, $f = 0.3$, $\\delta f = 10^{-6}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a two-element list of booleans in the order $[\\text{spectrum\\_invariant}, \\text{current\\_invariant}]$. For example, for four test cases the output format must be $[[\\text{b}_{11},\\text{b}_{12}],[\\text{b}_{21},\\text{b}_{22}],[\\text{b}_{31},\\text{b}_{32}],[\\text{b}_{41},\\text{b}_{42}]]$, where each $\\text{b}_{ij}$ is either $\\text{True}$ or $\\text{False}$.",
            "solution": "The physical basis for this problem is the minimal coupling principle and gauge invariance in quantum mechanics. For an electron with charge $q=-e$ in a magnetic field, the momentum operator is modified according to $\\mathbf{p} \\rightarrow \\mathbf{p} - q \\mathbf{A}$, where $\\mathbf{A}$ is the magnetic vector potential. In the tight-binding description, the Peierls substitution faithfully encodes the effect of $\\mathbf{A}$ along discrete bonds: the hopping amplitude from site $i$ to site $j$ acquires a phase factor $\\exp\\left( \\frac{i q}{\\hbar} \\int_i^j \\mathbf{A} \\cdot d\\mathbf{\\ell} \\right)$. For a ring with total enclosed flux $\\Phi$, the sum of these phases around a closed loop must be $2\\pi f$ with $f = \\Phi/\\Phi_0$ and $\\Phi_0 = h/e$.\n\nWe consider two gauge choices that produce the same total loop phase $2\\pi f$:\n\n1. Uniform azimuthal gauge: The total phase is distributed evenly across all $N$ bonds, so each forward nearest-neighbor hopping carries phase $\\exp\\left( i \\frac{2\\pi f}{N} \\right)$ and the backward hopping carries the complex conjugate. Denote the tight-binding Hamiltonian as $H_{\\text{uni}}(N,t,f)$ with matrix elements\n$$\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{j,j+1} = -t \\, e^{i \\frac{2\\pi f}{N}}, \\quad\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{j+1,j} = -t \\, e^{-i \\frac{2\\pi f}{N}},\n$$\nfor $j=0,1,\\ldots,N-2$, and enforced periodically across the boundary,\n$$\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{N-1,0} = -t \\, e^{i \\frac{2\\pi f}{N}}, \\quad\n\\left[H_{\\text{uni}}(N,t,f)\\right]_{0,N-1} = -t \\, e^{-i \\frac{2\\pi f}{N}}.\n$$\nAll on-site terms are zero.\n\n2. Single-branch-cut gauge: The entire loop phase is concentrated on one bond (chosen between sites $N-1$ and $0$), while all other bonds have real hopping amplitudes $-t$. Denote this Hamiltonian as $H_{\\text{cut}}(N,t,f)$ with matrix elements\n$$\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{j,j+1} = -t, \\quad\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{j+1,j} = -t, \\quad j=0,1,\\ldots,N-2,\n$$\nand across the branch cut,\n$$\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{N-1,0} = -t \\, e^{i 2\\pi f}, \\quad\n\\left[H_{\\text{cut}}(N,t,f)\\right]_{0,N-1} = -t \\, e^{-i 2\\pi f}.\n$$\n\nThese two Hamiltonians are related by a site-dependent unitary gauge transformation, $U = \\mathrm{diag}\\left(e^{i \\theta_0}, e^{i \\theta_1}, \\ldots, e^{i \\theta_{N-1}}\\right)$, where choosing $\\theta_j = \\frac{2\\pi f}{N} j$ yields\n$$\nH_{\\text{cut}}(N,t,f) = U^{\\dagger} H_{\\text{uni}}(N,t,f) U,\n$$\nwhich implies that $H_{\\text{uni}}$ and $H_{\\text{cut}}$ are unitarily equivalent. Therefore, they have identical spectra and identical physical observables that can be expressed as functions of the eigenvalues. This is a direct manifestation of gauge invariance.\n\nAlgorithmic design:\n\n- Construct $H_{\\text{uni}}(N,t,f)$ and $H_{\\text{cut}}(N,t,f)$ explicitly as $N \\times N$ Hermitian matrices using the definitions above. Periodic boundary conditions are implemented by connecting site $N-1$ to site $0$.\n\n- Compute the eigenvalues of both Hamiltonians using a numerical Hermitian eigensolver (e.g., a routine implementing diagonalization for complex Hermitian matrices). Sort the eigenvalues in ascending order to obtain the spectra $E^{\\text{uni}}(f)$ and $E^{\\text{cut}}(f)$.\n\n- Quantify spectrum invariance by computing the maximum absolute difference between the two sorted spectra at the same $f$:\n$$\n\\Delta_E(f) = \\max_k \\left| E^{\\text{uni}}_k(f) - E^{\\text{cut}}_k(f) \\right|.\n$$\nDeclare the spectrum invariant if $\\Delta_E(f) < \\varepsilon_E$ with $\\varepsilon_E = 10^{-10}$.\n\n- Compute the ground-state energy $E_0^{\\text{uni}}(f)$ and $E_0^{\\text{cut}}(f)$ as the smallest eigenvalues in the two gauges. Approximate the normalized persistent current (energy per flux quantum) via central finite difference:\n$$\nI'_{\\text{uni}}(f) = -\\frac{E_0^{\\text{uni}}(f+\\delta f) - E_0^{\\text{uni}}(f-\\delta f)}{2 \\, \\delta f}, \\quad\nI'_{\\text{cut}}(f) = -\\frac{E_0^{\\text{cut}}(f+\\delta f) - E_0^{\\text{cut}}(f-\\delta f)}{2 \\, \\delta f}.\n$$\nThen compute\n$$\n\\Delta_I(f) = \\left| I'_{\\text{uni}}(f) - I'_{\\text{cut}}(f) \\right|.\n$$\nDeclare current invariance if $\\Delta_I(f) < \\varepsilon_I$ with $\\varepsilon_I = 10^{-8}$.\n\n- Edge-case considerations: At $f = 0$ the phases vanish in both gauges and invariance is trivial. At $f = 0.5$ (half flux quantum), degeneracies can produce cusps in $E_0(f)$; the central finite difference remains a well-defined symmetric discrete approximation and gauge invariance persists. Very small rings (e.g., $N = 3$) still obey gauge invariance; numerical tolerances capture residual floating-point error.\n\nApply the above procedure to the test suite:\n- Test case $1$: $N = 16$, $t = 1.0$, $f = 0.25$, $\\delta f = 10^{-6}$.\n- Test case $2$: $N = 12$, $t = 1.0$, $f = 0.0$, $\\delta f = 10^{-6}$.\n- Test case $3$: $N = 10$, $t = 2.0$, $f = 0.5$, $\\delta f = 10^{-6}$.\n- Test case $4$: $N = 3$, $t = 1.0$, $f = 0.3$, $\\delta f = 10^{-6}$.\n\nThe program aggregates for each test case the two booleans $[\\text{spectrum\\_invariant}, \\text{current\\_invariant}]$ and prints a single line of the form\n$$\n[[\\text{b}_{11},\\text{b}_{12}],[\\text{b}_{21},\\text{b}_{22}],[\\text{b}_{31},\\text{b}_{32}],[\\text{b}_{41},\\text{b}_{42}]],\n$$\nwhere each $\\text{b}_{ij}$ is either $\\text{True}$ or $\\text{False}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_hamiltonian_uniform(N: int, t: float, f: float) -> np.ndarray:\n    \"\"\"\n    Build the NxN tight-binding Hamiltonian for a ring with uniform azimuthal gauge.\n    Each bond carries the same phase corresponding to total flux 2*pi*f uniformly distributed.\n    \"\"\"\n    H = np.zeros((N, N), dtype=np.complex128)\n    # Phase per bond in the forward direction\n    phi = 2.0 * np.pi * f / N\n    hop_forward = -t * np.exp(1j * phi)\n    hop_backward = -t * np.exp(-1j * phi)\n    # Fill nearest-neighbor hoppings\n    for j in range(N - 1):\n        H[j, j + 1] = hop_forward\n        H[j + 1, j] = hop_backward\n    # Periodic boundary\n    H[N - 1, 0] = hop_forward\n    H[0, N - 1] = hop_backward\n    # On-site energies are zero\n    return H\n\ndef build_hamiltonian_cut(N: int, t: float, f: float) -> np.ndarray:\n    \"\"\"\n    Build the NxN tight-binding Hamiltonian for a ring with single-branch-cut gauge.\n    All bonds are real except the boundary bond (N-1 to 0) carrying the total phase 2*pi*f.\n    \"\"\"\n    H = np.zeros((N, N), dtype=np.complex128)\n    # Real hopping for non-cut bonds\n    hop_real = -t\n    # Fill nearest-neighbor hoppings for bonds j -> j+1 (except the boundary bond)\n    for j in range(N - 1):\n        H[j, j + 1] = hop_real\n        H[j + 1, j] = hop_real\n    # Boundary bond carries entire phase\n    boundary_forward = -t * np.exp(1j * 2.0 * np.pi * f)\n    boundary_backward = -t * np.exp(-1j * 2.0 * np.pi * f)\n    H[N - 1, 0] = boundary_forward\n    H[0, N - 1] = boundary_backward\n    # On-site energies are zero\n    return H\n\ndef spectrum(H: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Compute sorted eigenvalues of a Hermitian Hamiltonian.\n    \"\"\"\n    # eigh is for Hermitian matrices, returns real eigenvalues for Hermitian input\n    vals = np.linalg.eigh(H)[0]\n    vals.sort()\n    return vals\n\ndef ground_state_energy(H: np.ndarray) -> float:\n    \"\"\"\n    Return the smallest eigenvalue (ground-state energy).\n    \"\"\"\n    vals = np.linalg.eigh(H)[0]\n    return float(np.min(vals))\n\ndef normalized_persistent_current(N: int, t: float, f: float, df: float,\n                                  builder) -> float:\n    \"\"\"\n    Compute normalized persistent current I'(f) = -dE0/df via central difference\n    using the provided Hamiltonian builder (uniform or cut gauge).\n    \"\"\"\n    H_minus = builder(N, t, f - df)\n    H_plus = builder(N, t, f + df)\n    E_minus = ground_state_energy(H_minus)\n    E_plus = ground_state_energy(H_plus)\n    # Central difference\n    dE_df = (E_plus - E_minus) / (2.0 * df)\n    return -dE_df\n\ndef compare_gauges(N: int, t: float, f: float, df: float,\n                   tol_energy: float = 1e-10, tol_current: float = 1e-8):\n    \"\"\"\n    Compare the uniform and cut gauges for given parameters.\n    Returns a tuple of booleans: (spectrum_invariant, current_invariant).\n    \"\"\"\n    H_uni = build_hamiltonian_uniform(N, t, f)\n    H_cut = build_hamiltonian_cut(N, t, f)\n\n    spec_uni = spectrum(H_uni)\n    spec_cut = spectrum(H_cut)\n\n    # Max absolute difference between sorted spectra\n    # Spectra lengths are the same (N), both sorted\n    max_diff_energy = float(np.max(np.abs(spec_uni - spec_cut)))\n\n    # Normalized persistent current via central difference\n    I_uni = normalized_persistent_current(N, t, f, df, build_hamiltonian_uniform)\n    I_cut = normalized_persistent_current(N, t, f, df, build_hamiltonian_cut)\n    diff_current = abs(I_uni - I_cut)\n\n    spectrum_invariant = (max_diff_energy < tol_energy)\n    current_invariant = (diff_current < tol_current)\n    return spectrum_invariant, current_invariant\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (N, t, f, df)\n    test_cases = [\n        (16, 1.0, 0.25, 1e-6),  # Happy path\n        (12, 1.0, 0.0,  1e-6),  # Zero flux boundary\n        (10, 2.0, 0.5,  1e-6),  # Half flux quantum edge case\n        (3,  1.0, 0.3,  1e-6),  # Small ring edge case\n    ]\n\n    results = []\n    for case in test_cases:\n        N, t, f, df = case\n        spectrum_invariant, current_invariant = compare_gauges(N, t, f, df)\n        results.append([spectrum_invariant, current_invariant])\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of [bool,bool] per test case.\n    # No extra text.\n    def bool_list_to_str(lst):\n        # Convert list of [bool,bool] to string with True/False\n        return \"[\" + \",\".join(\"True\" if x else \"False\" for x in lst) + \"]\"\n    output = \"[\" + \",\".join(bool_list_to_str(r) for r in results) + \"]\"\n    print(output)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "In realistic semiconductor nanostructures, an external magnetic field does more than just create an Aharonov-Bohm phase; it also interacts with the electron's intrinsic spin via the Zeeman effect. This practice explores the rich physics that emerges from the interplay between these orbital and spin phenomena. By deriving and calculating the characteristic magnetic field at which the Zeeman energy splitting becomes comparable to the orbital energy level spacing , you will gain insight into how competing energy scales can dramatically modify the transport properties and persistent currents in mesoscopic rings.",
            "id": "4262379",
            "problem": "A quasi-one-dimensional semiconductor nanoring fabricated in a Two-Dimensional Electron Gas (2DEG) of indium arsenide is modeled as a single-mode coherent ring of mean radius $R$ with negligible radial width $w \\ll R$. Electrons have effective mass $m^{\\ast}$ and Landé $g$-factor $g$. A perpendicular magnetic field $B$ threads the ring, providing both Aharonov-Bohm (AB) flux and Zeeman spin splitting. Spin-orbit coupling may be neglected; assume that spin splitting is purely Zeeman. The temperature is low enough that the phase coherence length exceeds the ring circumference, and the ring is ballistic.\n\nStarting from the canonical momentum quantization on a ring and the non-relativistic dispersion relation, estimate the characteristic magnetic field $B_{Z}^{\\ast}$ at which the Zeeman energy becomes comparable to the orbital level spacing at the Fermi level. Treat the ring as a one-dimensional channel with wave number quantization determined by periodic boundary conditions in the presence of AB flux, and use the Fermi velocity $v_{F}$ associated with the host 2DEG. Explicitly equate the Zeeman energy to the orbital level spacing near the Fermi wave number and derive $B_{Z}^{\\ast}$ as a closed-form expression in terms of $g$, the Bohr magneton $\\mu_{B}$, the reduced Planck constant $\\hbar$, the ring radius $R$, and either $v_{F}$ or the Fermi wave number $k_{F}$ and $m^{\\ast}$.\n\nThen evaluate $B_{Z}^{\\ast}$ numerically for the following parameters, expressing your final result in Tesla and rounding to three significant figures:\n- Mean radius $R = 250\\,\\text{nm}$,\n- Effective mass $m^{\\ast} = 0.023\\,m_{e}$,\n- Landé $g$-factor $g = 15$,\n- 2DEG sheet density $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2}$,\n- Use $k_{F} = \\sqrt{2\\pi n_{s}}$ and $v_{F} = \\hbar k_{F}/m^{\\ast}$.\n\nFinally, based on your expression and numerical estimate, briefly discuss qualitatively how the persistent current $I(\\Phi)$ and the amplitude and phase of magnetoconductance AB oscillations are expected to be modified as $B$ approaches and exceeds $B_{Z}^{\\ast}$, assuming fixed AB flux threading and negligible orbital Landau quantization beyond the ring confinement.\n\nYour final answer must be the single value of $B_{Z}^{\\ast}$ in Tesla, rounded to three significant figures.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- **System**: A quasi-one-dimensional semiconductor nanoring in a Two-Dimensional Electron Gas (2DEG) of indium arsenide.\n- **Model**: Single-mode coherent ring.\n- **Geometry**: Mean radius $R$, negligible radial width $w \\ll R$.\n- **Electron Properties**: Effective mass $m^{\\ast}$, Landé $g$-factor $g$.\n- **External Field**: Perpendicular magnetic field $B$ providing Aharonov-Bohm (AB) flux and Zeeman spin splitting.\n- **Assumptions/Approximations**: Spin-orbit coupling is neglected; spin splitting is purely Zeeman. Temperature is low, ensuring phase coherence length exceeds ring circumference. The ring is ballistic.\n- **Derivation Task**: Estimate the characteristic magnetic field $B_{Z}^{\\ast}$ by equating the Zeeman energy to the orbital level spacing at the Fermi level. Start from canonical momentum quantization and use the non-relativistic dispersion. Use the Fermi velocity $v_{F}$ of the host 2DEG. The final expression for $B_{Z}^{\\ast}$ should be in terms of $g$, $\\mu_{B}$, $\\hbar$, $R$, and either $v_{F}$ or ($k_{F}$, $m^{\\ast}$).\n- **Numerical Evaluation Task**: Calculate $B_{Z}^{\\ast}$ in Tesla, rounded to three significant figures.\n- **Numerical Parameters**:\n    - $R = 250\\,\\text{nm}$\n    - $m^{\\ast} = 0.023\\,m_{e}$\n    - $g = 15$\n    - $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2}$\n- **Provided Formulae**:\n    - $k_{F} = \\sqrt{2\\pi n_{s}}$\n    - $v_{F} = \\hbar k_{F}/m^{\\ast}$\n- **Qualitative Discussion Task**: Discuss modifications to persistent current $I(\\Phi)$ and magnetoconductance AB oscillations as $B$ approaches and exceeds $B_{Z}^{\\ast}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on well-established principles of quantum mechanics (Aharonov-Bohm effect, Zeeman effect) and solid-state physics (2DEG, effective mass, Fermi level). The physical system and parameters are representative of real experiments in nanoelectronics. The problem is scientifically sound.\n- **Well-Posed**: The problem sets a clear objective: derive an expression for $B_{Z}^{\\ast}$, calculate its value, and provide a qualitative discussion. The instructions are specific, guiding the choice of model and approximations. All necessary information is either provided or consists of fundamental constants. The problem is well-posed.\n- **Objective**: The language is technical and precise, free of subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, well-formulated problem in mesoscopic physics. The solution process can proceed.\n\n### Solution Derivation\nThe total energy of an electron in the nanoring in a perpendicular magnetic field $B$ is the sum of its orbital energy and its spin (Zeeman) energy. Spin-orbit coupling is neglected as per the problem statement.\n\nThe orbital energy of an electron confined to a one-dimensional ring of radius $R$ threaded by a magnetic flux $\\Phi = B \\pi R^2$ is quantized. The single-particle Hamiltonian for the orbital motion is given by:\n$$\nH_{\\text{orb}} = \\frac{1}{2m^{\\ast}} \\left( \\hat{p}_{\\theta} + e A_{\\theta} \\right)^2\n$$\nwhere $\\hat{p}_{\\theta} = \\frac{-i\\hbar}{R} \\frac{\\partial}{\\partial\\theta}$ is the canonical momentum operator along the circumference, and $A_{\\theta} = \\frac{B R}{2} = \\frac{\\Phi}{2\\pi R}$ is the magnetic vector potential in the azimuthal direction. The eigenfunctions are of the form $\\psi_n(\\theta) = \\frac{1}{\\sqrt{2\\pi}} \\exp(i n \\theta)$, where $n$ is an integer quantum number, due to the periodic boundary condition $\\psi(\\theta+2\\pi) = \\psi(\\theta)$.\n\nThe application of the Hamiltonian on these eigenfunctions yields the energy eigenvalues:\n$$\nE_{n}^{\\text{orb}} = \\frac{1}{2m^{\\ast} R^2} \\left( \\hbar n + e R A_{\\theta} \\right)^2 = \\frac{1}{2m^{\\ast} R^2} \\left( \\hbar n + \\frac{e\\Phi}{2\\pi} \\right)^2\n$$\nUsing the magnetic flux quantum $\\Phi_0 = h/e = 2\\pi\\hbar/e$, the expression simplifies to:\n$$\nE_{n}^{\\text{orb}} = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left( n + \\frac{\\Phi}{\\Phi_0} \\right)^2\n$$\n\nThe Zeeman energy results from the interaction of the electron's spin magnetic moment with the magnetic field. It is given by $E_Z = g \\mu_B m_s B$, where $m_s = \\pm 1/2$ is the spin quantum number, $g$ is the Landé $g$-factor, and $\\mu_B = e\\hbar/(2m_e)$ is the Bohr magneton (note the use of the free electron mass $m_e$). The energy splitting between the two spin states is $\\Delta E_Z = E_{m_s=1/2} - E_{m_s=-1/2} = g \\mu_B B$.\n\nThe problem requires us to find the orbital level spacing at the Fermi level. The energy spacing between adjacent orbital levels $n$ and $n+1$ is:\n$$\n\\Delta E_{n, n+1}^{\\text{orb}} = E_{n+1}^{\\text{orb}} - E_{n}^{\\text{orb}} = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left[ \\left( n+1 + \\frac{\\Phi}{\\Phi_0} \\right)^2 - \\left( n + \\frac{\\Phi}{\\Phi_0} \\right)^2 \\right] = \\frac{\\hbar^2}{2m^{\\ast} R^2} \\left( 2n + 1 + 2\\frac{\\Phi}{\\Phi_0} \\right)\n$$\nAt the Fermi level, the relevant quantum number $n$ is the Fermi quantum number, $n_F$, which is related to the Fermi wave number $k_F$ by $n_F \\approx k_F R$. Typically, for a nanoring, $n_F \\gg 1$. Also, the Aharonov-Bohm phase term $\\Phi/\\Phi_0$ is of order unity. Therefore, we can approximate $2n + 1 + 2\\Phi/\\Phi_0 \\approx 2n_F$. The orbital level spacing at the Fermi level becomes:\n$$\n\\Delta E_{\\text{orb}} \\approx \\frac{\\hbar^2}{2m^{\\ast} R^2} (2n_F) = \\frac{\\hbar^2 n_F}{m^{\\ast} R^2}\n$$\nSubstituting $n_F = k_F R$, we get:\n$$\n\\Delta E_{\\text{orb}} = \\frac{\\hbar^2 (k_F R)}{m^{\\ast} R^2} = \\frac{\\hbar^2 k_F}{m^{\\ast} R}\n$$\nUsing the definition of the Fermi velocity, $v_F = \\hbar k_F / m^{\\ast}$, this spacing can be expressed as:\n$$\n\\Delta E_{\\text{orb}} = \\frac{\\hbar v_F}{R}\n$$\nThis result can also be obtained from the dispersion relation $E(k) = \\hbar^2 k^2/(2m^{\\ast})$ for a 1D system, where level spacing is $\\Delta E \\approx \\frac{dE}{dk} \\Delta k$. At the Fermi level, $\\frac{dE}{dk}|_{k_F} = \\frac{\\hbar^2 k_F}{m^{\\ast}} = \\hbar v_F$. The quantization condition on a ring, $k=n/R$, implies that the spacing in wave number space is $\\Delta k = 1/R$. Thus, $\\Delta E_{\\text{orb}} = (\\hbar v_F)(1/R)$.\n\nThe problem defines the characteristic magnetic field $B_{Z}^{\\ast}$ as the field where the Zeeman splitting equals this orbital level spacing:\n$$\n\\Delta E_Z = \\Delta E_{\\text{orb}}\n$$\n$$\ng \\mu_B B_{Z}^{\\ast} = \\frac{\\hbar v_F}{R}\n$$\nSolving for $B_{Z}^{\\ast}$ gives the expression in terms of $v_F$:\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar v_F}{g \\mu_B R}\n$$\nTo express this in terms of $k_F$ and $m^{\\ast}$, we substitute $v_F = \\hbar k_F / m^{\\ast}$:\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar}{g \\mu_B R} \\left( \\frac{\\hbar k_F}{m^{\\ast}} \\right) = \\frac{\\hbar^2 k_F}{g \\mu_B m^{\\ast} R}\n$$\nThis is the required closed-form expression.\n\n### Numerical Evaluation\nWe are given the following parameters:\n- $R = 250\\,\\text{nm} = 2.50 \\times 10^{-7}\\,\\text{m}$\n- $m^{\\ast} = 0.023\\,m_{e} = 0.023 \\times (9.10938 \\times 10^{-31}\\,\\text{kg}) \\approx 2.09516 \\times 10^{-32}\\,\\text{kg}$\n- $g = 15$\n- $n_{s} = 2.50 \\times 10^{11}\\,\\text{cm}^{-2} = 2.50 \\times 10^{15}\\,\\text{m}^{-2}$\n\nAnd the fundamental constants:\n- $\\hbar \\approx 1.05457 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n- $\\mu_B \\approx 9.27401 \\times 10^{-24}\\,\\text{J}\\cdot\\text{T}^{-1}$\n\nFirst, we calculate the Fermi wave number $k_F$ for the 2DEG:\n$$\nk_F = \\sqrt{2\\pi n_{s}} = \\sqrt{2\\pi (2.50 \\times 10^{15}\\,\\text{m}^{-2})} = \\sqrt{1.5708 \\times 10^{16}\\,\\text{m}^{-2}} \\approx 1.2533 \\times 10^{8}\\,\\text{m}^{-1}\n$$\nNow, we can substitute all values into the expression for $B_{Z}^{\\ast}$:\n$$\nB_{Z}^{\\ast} = \\frac{\\hbar^2 k_F}{g \\mu_B m^{\\ast} R}\n$$\n$$\nB_{Z}^{\\ast} = \\frac{(1.05457 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s})^2 (1.2533 \\times 10^{8}\\,\\text{m}^{-1})}{(15) (9.27401 \\times 10^{-24}\\,\\text{J}\\cdot\\text{T}^{-1}) (2.09516 \\times 10^{-32}\\,\\text{kg}) (2.50 \\times 10^{-7}\\,\\text{m})}\n$$\nNumerator: $(1.11212 \\times 10^{-68}\\,\\text{J}^2\\cdot\\text{s}^2) (1.2533 \\times 10^{8}\\,\\text{m}^{-1}) \\approx 1.3938 \\times 10^{-60}\\,\\text{J}^2\\cdot\\text{s}^2\\cdot\\text{m}^{-1}$\nDenominator: $(15)(9.27401 \\times 10^{-24})(2.09516 \\times 10^{-32})(2.50 \\times 10^{-7})\\,\\text{J}\\cdot\\text{T}^{-1}\\cdot\\text{kg}\\cdot\\text{m}$\nDenominator $\\approx (7.2891 \\times 10^{-61})\\,\\text{J}\\cdot\\text{T}^{-1}\\cdot\\text{kg}\\cdot\\text{m}$\n$$\nB_{Z}^{\\ast} = \\frac{1.3938 \\times 10^{-60}}{7.2891 \\times 10^{-61}}\\,\\text{T} \\approx 1.9122\\,\\text{T}\n$$\nRounding to three significant figures, we get $B_{Z}^{\\ast} = 1.91\\,\\text{T}$.\n\n### Qualitative Discussion\nThe persistent current $I(\\Phi)$ and the Aharonov-Bohm (AB) oscillations in magnetoconductance depend on the energy spectrum $E_{n,m_s}$. Both phenomena are periodic in the magnetic flux $\\Phi$ with period $\\Phi_0 = h/e$.\n\nWhen $B=0$, the spin-up and spin-down energy levels are degenerate. The total current and conductance are sums of two identical contributions.\n\nAs $B$ increases from zero, the degeneracy is lifted, and two sets of parabolic energy spectra emerge, shifted relative to each other by the Zeeman energy $\\Delta E_Z = g \\mu_B B$.\n- **Persistent Current $I(\\Phi)$**: The persistent current is calculated by summing the contributions from all occupied states up to the Fermi energy. With Zeeman splitting, the number of occupied states and their respective energies become different for spin-up and spin-down electrons. The total current, $I(\\Phi) = I^{\\uparrow}(\\Phi) + I^{\\downarrow}(\\Phi)$, is a superposition of two $\\Phi_0$-periodic signals. As $B$ approaches $B_{Z}^{\\ast}$, the Zeeman splitting $\\Delta E_Z$ becomes comparable to the orbital level spacing $\\Delta E_{\\text{orb}}$. This leads to energy level crossings between states with different spin and orbital quantum numbers (e.g., $E_{n, \\uparrow} \\approx E_{n+1, \\downarrow}$). These crossings significantly alter the ground state configuration of the system as a function of flux, leading to drastic changes in the amplitude, shape, and even sign of the persistent current.\n- **Magnetoconductance AB Oscillations**: Conductance oscillations also arise from quantum interference, which is sensitive to the energy spectrum. The total conductance is the sum of contributions from the two spin channels, $G(\\Phi) = G^{\\uparrow}(\\Phi) + G^{\\downarrow}(\\Phi)$. Because the Fermi wave numbers $k_{F,\\uparrow}$ and $k_{F,\\downarrow}$ become different, the two channels can interfere. When the Zeeman splitting $\\Delta E_Z$ becomes a significant fraction of the orbital spacing $\\Delta E_{\\text{orb}}$, the amplitude of the total AB oscillation is modulated. Specifically, when $\\Delta E_Z$ is close to half the orbital spacing, a phase shift of $\\pi$ in the AB oscillations can be observed, which appears as an inversion of the oscillation pattern. As $B$ approaches and exceeds $B_{Z}^{\\ast}$, where $\\Delta E_Z \\approx \\Delta E_{\\text{orb}}$, the conditions for constructive or destructive interference between spin channels change. This can lead to a suppression (quenching) and subsequent revival of the AB oscillation amplitude as a function of the magnetic field $B$. Thus, $B_{Z}^{\\ast}$ represents a fundamental field scale governing the interplay between spin and orbital effects in the magnetotransport properties of the nanoring.",
            "answer": "$$\n\\boxed{1.91}\n$$"
        },
        {
            "introduction": "Bridging the gap between idealized theory and real-world experiments requires mastering the art of data analysis. In a laboratory setting, the faint, periodic signature of the Aharonov-Bohm effect is often buried within a much larger, smoothly varying magnetoresistance background and other spurious signals. This capstone exercise  challenges you to develop a robust computational strategy, employing polynomial detrending and frequency-domain analysis, to successfully extract and validate the genuine quantum interference signal from a realistically modeled, complex dataset.",
            "id": "4262338",
            "problem": "Consider a one-electron coherent transport through a mesoscopic nanoring with two paths that form a closed loop. The nanoring is embedded in an externally applied magnetic field that may be inhomogeneous in the radial direction. The central observable is an interference-dependent conductance modulation arising from the Aharonov-Bohm phase. You must model the measured signal and implement a computational strategy to isolate the genuine Aharonov-Bohm signature from background artifacts caused by inhomogeneous magnetic fields and generic magnetoresistive trends.\n\nUse the following fundamental base:\n\n- The quantum mechanical phase acquired along a path in the presence of a vector potential is given by $ \\Delta \\varphi_{\\mathrm{AB}} = \\frac{q}{\\hbar} \\oint \\mathbf{A} \\cdot d\\boldsymbol{\\ell} $, where $q$ is the charge and $\\hbar$ is the reduced Planck constant. By Stokes' theorem, for a closed loop enclosing area $S$, $ \\Delta \\varphi_{\\mathrm{AB}} = \\frac{q}{\\hbar} \\iint_S \\mathbf{B} \\cdot d\\mathbf{S} $.\n- Define the magnetic flux quantum $ \\Phi_0 = \\frac{h}{|q|} $ with $h$ as Planck's constant. For an electron, use $ |q| = e $, where $e$ is the elementary charge.\n\nGeometry and magnetic field model:\n\n- Let the nanoring have mean radius $ R $ and radial width $ w $, so the inner radius is $ r_{\\mathrm{in}} = R - \\frac{w}{2} $ and the outer radius is $ r_{\\mathrm{out}} = R + \\frac{w}{2} $. The annular area is $ S = \\pi \\left(r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2\\right) $.\n- Assume an azimuthally symmetric magnetic field profile $ B(r; B) = B + g \\left(r - R\\right) + c \\left(r - R\\right)^2 $, where $B$ is the uniform externally swept field in tesla, $g$ is the first-order radial gradient in tesla per meter, and $c$ is the second-order radial curvature in tesla per square meter. The angle unit for all phase quantities is radians.\n\nInterference and measurement model:\n\n- Let the measured normalized signal be modeled as\n$$ G(B) = G_0 + A_{\\mathrm{AB}} \\cos\\!\\left( \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 \\right) + M(B) + N(B), $$\nwhere $ G_0 $ is a constant offset, $ A_{\\mathrm{AB}} $ is the Aharonov-Bohm oscillation amplitude, $ \\Phi(B) = \\iint_S B(r; B)\\, dS $ is the flux through the annulus, $ \\varphi_0 $ is a phase offset (in radians), $ M(B) $ is a smooth magnetoresistive background, and $ N(B) $ is a deterministic nuisance term mimicking spurious oscillations unrelated to the Aharonov-Bohm effect.\n- The smooth background is modeled as a cubic polynomial $ M(B) = \\alpha B + \\beta B^2 + \\gamma B^3 $ with coefficients $ \\alpha, \\beta, \\gamma $.\n- The nuisance term is modeled as a sum of two sinusoidal components $ N(B) = s_1 \\sin\\!\\left( 2\\pi f_1 B \\right) + s_2 \\sin\\!\\left( 2\\pi f_2 B \\right) $, with frequencies $ f_1, f_2 $ in cycles per tesla and amplitudes $ s_1, s_2 $.\n\nObjectives:\n\n1. Starting from the fundamental base, derive the dependence of the Aharonov-Bohm phase on the swept field $ B $ and show whether the inhomogeneity parameters $ g $ and $ c $ modify the oscillation frequency or only the phase offset.\n2. Implement a program to:\n   - Synthesize $ G(B) $ over a specified field sweep range on an equispaced grid.\n   - Isolate the genuine Aharonov-Bohm signature using a two-step strategy:\n     a) Detrend by fitting and subtracting a cubic polynomial in $ B $ to remove $ M(B) $.\n     b) Perform frequency-domain analysis of the residual using a Hann window and the discrete Fourier transform to evaluate the amplitude at the theoretical Aharonov-Bohm frequency.\n   - Quantify detection using a signal-to-background ratio at the theoretical frequency, where the background level is characterized by the median spectral amplitude across positive frequencies excluding the bins nearest to the theoretical frequency.\n   - Quantify how much of the residual variance is explained by the Aharonov-Bohm component by projecting the residual onto $ \\cos\\!\\left( 2\\pi f_{\\mathrm{AB}} B \\right) $ and $ \\sin\\!\\left( 2\\pi f_{\\mathrm{AB}} B \\right) $ and computing the fraction $ \\mathrm{Var}(G_{\\mathrm{AB}})/\\mathrm{Var}(G_{\\mathrm{res}}) $.\n3. For each test case, output:\n   - The theoretical Aharonov-Bohm period in tesla, defined by $ \\Delta B_{\\mathrm{AB}} = \\Phi_0 / S $, rounded to six decimal places.\n   - A boolean indicating successful detection based on a signal-to-background ratio greater than $ 6 $.\n   - The variance fraction as a decimal rounded to six decimal places.\n\nTest suite:\n\nUse the following three test cases, each specifying $ R $ in meters, $ w $ in meters, $ g $ in tesla per meter, $ c $ in tesla per square meter, $ A_{\\mathrm{AB}} $ (dimensionless), $ G_0 $ (dimensionless), $ \\alpha, \\beta, \\gamma $ (dimensionless coefficients consistent with $ B $ in tesla), $ s_1, s_2 $ (dimensionless), $ f_1, f_2 $ in cycles per tesla, the sweep range $ B_{\\min} $ and $ B_{\\max} $ in tesla, and the number of points $ N $.\n\n- Case 1 (baseline, nearly homogeneous field):\n  - $ R = 2.00 \\times 10^{-7} $, $ w = 4.00 \\times 10^{-8} $, $ g = 0.0 $, $ c = 0.0 $,\n  - $ A_{\\mathrm{AB}} = 0.15 $, $ G_0 = 0.0 $,\n  - $ \\alpha = 0.01 $, $ \\beta = 0.25 $, $ \\gamma = 0.00 $,\n  - $ s_1 = 0.02 $, $ s_2 = 0.01 $, $ f_1 = 7.3 $, $ f_2 = 20.0 $,\n  - $ B_{\\min} = -0.4 $, $ B_{\\max} = 0.4 $, $ N = 4096 $.\n\n- Case 2 (moderate inhomogeneity, stronger background):\n  - $ R = 2.00 \\times 10^{-7} $, $ w = 4.00 \\times 10^{-8} $, $ g = 500.0 $, $ c = 1.00 \\times 10^{7} $,\n  - $ A_{\\mathrm{AB}} = 0.12 $, $ G_0 = 0.0 $,\n  - $ \\alpha = 0.02 $, $ \\beta = 0.35 $, $ \\gamma = 0.02 $,\n  - $ s_1 = 0.03 $, $ s_2 = 0.02 $, $ f_1 = 9.1 $, $ f_2 = 18.0 $,\n  - $ B_{\\min} = -0.4 $, $ B_{\\max} = 0.4 $, $ N = 4096 $.\n\n- Case 3 (narrow ring, weak Aharonov-Bohm amplitude, stronger nuisance):\n  - $ R = 2.00 \\times 10^{-7} $, $ w = 1.00 \\times 10^{-8} $, $ g = 500.0 $, $ c = 5.00 \\times 10^{7} $,\n  - $ A_{\\mathrm{AB}} = 0.04 $, $ G_0 = 0.0 $,\n  - $ \\alpha = 0.03 $, $ \\beta = 0.40 $, $ \\gamma = 0.05 $,\n  - $ s_1 = 0.04 $, $ s_2 = 0.03 $, $ f_1 = 6.0 $, $ f_2 = 22.0 $,\n  - $ B_{\\min} = -0.4 $, $ B_{\\max} = 0.4 $, $ N = 4096 $.\n\nImplementation requirements:\n\n- Use $ e = 1.602176634 \\times 10^{-19} \\, \\mathrm{C} $ and $ h = 6.62607015 \\times 10^{-34} \\, \\mathrm{J\\cdot s} $ so that $ \\Phi_0 = h/e $ in webers.\n- The final output must be a single line containing a list of lists, each inner list corresponding to a test case in the order above: $ [\\Delta B_{\\mathrm{AB}}, \\text{detected}, \\text{variance\\_fraction}] $. All angles must be treated in radians. The period $ \\Delta B_{\\mathrm{AB}} $ must be expressed in tesla and rounded to six decimal places; the variance fraction must be a decimal rounded to six decimal places; the boolean should be either True or False.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $ [[0.082300,\\mathrm{True},0.512345],[\\dots]] $).",
            "solution": "The user-provided problem is assessed to be **valid**. It is scientifically grounded in the principles of quantum mechanics (Aharonov-Bohm effect), well-posed with a clear and complete set of definitions and parameters, and objective in its formulation. The problem poses a non-trivial task involving both theoretical derivation and computational signal processing, representing a realistic scenario in experimental nanoelectronics.\n\n### 1. Theoretical Derivation: Aharonov-Bohm Phase and Field Inhomogeneity\n\nThe primary objective is to determine how the Aharonov-Bohm (AB) oscillation frequency is affected by an inhomogeneous magnetic field. The quantum phase at the core of the AB effect is proportional to the magnetic flux, $ \\Phi(B) $, enclosed by the electron paths. The total phase argument in the conductance model is $ \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 $. We must first calculate the total flux $ \\Phi(B) $ through the annular nanoring.\n\nThe flux is the integral of the magnetic field $ B(r; B) $ over the annular area $ S $. Given the azimuthal symmetry, the area element is $ dS = 2\\pi r dr $. The field is modeled as $ B(r; B) = B + g(r-R) + c(r-R)^2 $.\n\nThe total flux is:\n$$ \\Phi(B) = \\iint_S B(r; B) \\, dS = \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ B + g(r-R) + c(r-R)^2 \\right] 2\\pi r \\, dr $$\nwhere $ r_{\\mathrm{in}} = R - w/2 $ and $ r_{\\mathrm{out}} = R + w/2 $ are the inner and outer radii.\n\nWe can separate the integral into a part dependent on the swept field $ B $ and a part that is constant with respect to $ B $:\n$$ \\Phi(B) = \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} B \\cdot 2\\pi r \\, dr + \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ g(r-R) + c(r-R)^2 \\right] 2\\pi r \\, dr $$\n\nThe first term, representing the flux from the uniform field component, simplifies to:\n$$ B \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} 2\\pi r \\, dr = B \\cdot \\pi (r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2) = B \\cdot S $$\nThe area of the annulus, $ S = \\pi (r_{\\mathrm{out}}^2 - r_{\\mathrm{in}}^2) $, can be simplified as $ S = \\pi ((R+w/2)^2 - (R-w/2)^2) = \\pi(2Rw) = 2\\pi R w $.\n\nThe second term, $ \\Phi_{\\mathrm{inhom}} $, is the flux from the field's radial inhomogeneity and is independent of the swept field $ B $:\n$$ \\Phi_{\\mathrm{inhom}} = 2\\pi \\int_{r_{\\mathrm{in}}}^{r_{\\mathrm{out}}} \\left[ g(r^2 - Rr) + c(r^3 - 2Rr^2 + R^2r) \\right] dr $$\nEvaluating this definite integral yields a constant value for a given ring geometry and inhomogeneity parameters $ g $ and $ c $.\n\nThe total flux is therefore a linear function of $ B $:\n$$ \\Phi(B) = S \\cdot B + \\Phi_{\\mathrm{inhom}} $$\n\nSubstituting this into the cosine argument of the conductance model:\n$$ \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 = \\frac{2\\pi}{\\Phi_0} (S \\cdot B + \\Phi_{\\mathrm{inhom}}) + \\varphi_0 = \\left(\\frac{2\\pi S}{\\Phi_0}\\right) B + \\left(\\frac{2\\pi \\Phi_{\\mathrm{inhom}}}{\\Phi_0} + \\varphi_0\\right) $$\nThis expression has the form $ 2\\pi f_{\\mathrm{AB}} B + \\varphi'_{\\mathrm{total}} $, where:\n- The oscillation frequency with respect to $ B $ is $ f_{\\mathrm{AB}} = \\frac{S}{\\Phi_0} $.\n- The total phase offset is $ \\varphi'_{\\mathrm{total}} = \\frac{2\\pi \\Phi_{\\mathrm{inhom}}}{\\Phi_0} + \\varphi_0 $.\n\nThis derivation shows that the inhomogeneity parameters $ g $ and $ c $ **do not modify the Aharonov-Bohm oscillation frequency** $ f_{\\mathrm{AB}} $. They contribute only to a constant phase offset that is independent of the swept field $ B $. The period of the AB oscillations is determined solely by the ring's area $ S $ and the magnetic flux quantum $ \\Phi_0 $:\n$$ \\Delta B_{\\mathrm{AB}} = \\frac{1}{f_{\\mathrm{AB}}} = \\frac{\\Phi_0}{S} $$\n\n### 2. Computational Strategy\n\nThe provided problem requires a computational analysis to extract the AB signal from a composite measured signal $ G(B) $. The strategy is implemented as follows:\n\n**Step 1: Signal Synthesis**\nFor each test case, the signal $ G(B) $ is synthesized over an equispaced grid of $ N $ points from $ B_{\\min} $ to $ B_{\\max} $. This involves calculating each component of the model:\n- **Aharonov-Bohm Term:** $ A_{\\mathrm{AB}} \\cos( \\frac{2\\pi}{\\Phi_0} \\Phi(B) + \\varphi_0 ) $. The total flux $ \\Phi(B) $ is computed using the formula derived above. The unspecified phase offset $ \\varphi_0 $ is taken to be $ 0 $, as the analysis methods are insensitive to this initial phase.\n- **Magnetoresistive Background:** $ M(B) = \\alpha B + \\beta B^2 + \\gamma B^3 $.\n- **Nuisance Term:** $ N(B) = s_1 \\sin(2\\pi f_1 B) + s_2 \\sin(2\\pi f_2 B) $.\nThese components are summed with the offset $ G_0 $ to generate the full signal $ G(B) $.\n\n**Step 2: Background Detrending**\nThe smooth, low-frequency magnetoresistive background $ M(B) $ is a significant artifact. To remove it, a cubic polynomial is fitted to the synthesized signal $ G(B) $ using a least-squares method (`numpy.polyfit`). This fitted polynomial, which models $ G_0 + M(B) $, is then subtracted from $ G(B) $ to yield the residual signal, $ G_{\\mathrm{res}}(B) $, which ideally contains only the AB oscillations and the nuisance signals.\n$$ G_{\\mathrm{res}}(B) = G(B) - (\\hat{G}_0 + \\hat{\\alpha} B + \\hat{\\beta} B^2 + \\hat{\\gamma} B^3) \\approx A_{\\mathrm{AB}} \\cos(\\dots) + N(B) $$\n\n**Step 3: Frequency-Domain Analysis**\nTo isolate and quantify the AB signature, we analyze the frequency content of the residual signal $ G_{\\mathrm{res}}(B) $.\n- A **Hann window** is applied to $ G_{\\mathrm{res}}(B) $ to reduce spectral leakage, which occurs when performing a Discrete Fourier Transform (DFT) on a finite-length signal that is not periodic in the sampling window.\n- The **Fast Fourier Transform (FFT)**, specifically the real-valued version (`scipy.fft.rfft`), is computed on the windowed residual to obtain its amplitude spectrum. The x-axis of this spectrum represents frequency in units of cycles per tesla ($ \\mathrm{T}^{-1} $).\n\n**Step 4: Signal-to-Background Ratio (SBR) for Detection**\nThe genuine AB signal should appear as a peak in the amplitude spectrum at the theoretically calculated frequency $ f_{\\mathrm{AB}} = S/\\Phi_0 $.\n- **Signal:** The amplitude of the spectral component at the frequency bin closest to $ f_{\\mathrm{AB}} $ is identified as the signal strength.\n- **Background:** The background level is characterized by the **median** of the spectral amplitudes at all other positive frequencies. To avoid the AB peak's own spectral leakage from biasing the background estimate, a small window of frequency bins (the peak bin and its immediate neighbors) is excluded from the median calculation. The DC component (frequency $ 0 $) is also excluded.\n- **SBR and Detection:** The SBR is the ratio of the signal amplitude to the background level. The detection is deemed successful if this ratio exceeds a threshold of $ 6 $.\n\n**Step 5: Explained Variance Quantification**\nThis metric quantifies how well the AB component alone explains the oscillatory content of the residual signal.\n- The residual signal $ G_{\\mathrm{res}}(B) $ is projected onto an orthogonal basis of sine and cosine functions oscillating at the theoretical AB frequency, $ f_{\\mathrm{AB}} $. This is equivalent to a least-squares fit of $ G_{\\mathrm{res}}(B) $ to a model $ A_c \\cos(2\\pi f_{\\mathrm{AB}} B) + A_s \\sin(2\\pi f_{\\mathrm{AB}} B) $.\n- The resulting fitted signal, $ G_{\\mathrm{AB,proj}}(B) $, represents the portion of the residual that can be described by the pure AB oscillation.\n- The fraction of variance explained is computed as the ratio of the variance of the projected signal to the variance of the total residual signal: $ \\mathrm{Var}(G_{\\mathrm{AB,proj}}) / \\mathrm{Var}(G_{\\mathrm{res}}) $. A value close to $ 1 $ indicates that the AB effect dominates the residual signal's variance.\n\nFinally, the required outputs for each test case—the theoretical AB period $ \\Delta B_{\\mathrm{AB}} $, the boolean detection result, and the variance fraction—are calculated, rounded as specified, and formatted into the final output string.",
            "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Solves the Aharonov-Bohm effect problem for a set of test cases.\n    It synthesizes the measured signal, applies a detrending and FFT-based\n    analysis to isolate the AB signature, and quantifies the detection and\n    variance contribution.\n    \"\"\"\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    h = 6.62607015e-34    # Planck's constant in J*s\n    Phi_0 = h / e        # Magnetic flux quantum in Webers (T*m^2)\n\n    # Test suite\n    test_cases = [\n        # Case 1\n        {\n            \"R\": 2.00e-7, \"w\": 4.00e-8, \"g\": 0.0, \"c\": 0.0,\n            \"A_AB\": 0.15, \"G_0\": 0.0,\n            \"alpha\": 0.01, \"beta\": 0.25, \"gamma\": 0.00,\n            \"s1\": 0.02, \"s2\": 0.01, \"f1\": 7.3, \"f2\": 20.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n        # Case 2\n        {\n            \"R\": 2.00e-7, \"w\": 4.00e-8, \"g\": 500.0, \"c\": 1.00e7,\n            \"A_AB\": 0.12, \"G_0\": 0.0,\n            \"alpha\": 0.02, \"beta\": 0.35, \"gamma\": 0.02,\n            \"s1\": 0.03, \"s2\": 0.02, \"f1\": 9.1, \"f2\": 18.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n        # Case 3\n        {\n            \"R\": 2.00e-7, \"w\": 1.00e-8, \"g\": 500.0, \"c\": 5.00e7,\n            \"A_AB\": 0.04, \"G_0\": 0.0,\n            \"alpha\": 0.03, \"beta\": 0.40, \"gamma\": 0.05,\n            \"s1\": 0.04, \"s2\": 0.03, \"f1\": 6.0, \"f2\": 22.0,\n            \"B_min\": -0.4, \"B_max\": 0.4, \"N\": 4096,\n        },\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        # Unpack parameters for clarity\n        R, w, g, c = params[\"R\"], params[\"w\"], params[\"g\"], params[\"c\"]\n        A_AB, G_0 = params[\"A_AB\"], params[\"G_0\"]\n        alpha, beta, gamma = params[\"alpha\"], params[\"beta\"], params[\"gamma\"]\n        s1, s2, f1, f2 = params[\"s1\"], params[\"s2\"], params[\"f1\"], params[\"f2\"]\n        B_min, B_max, N = params[\"B_min\"], params[\"B_max\"], params[\"N\"]\n        \n        # 1. Theoretical Calculations\n        S = 2 * np.pi * R * w\n        delta_B_ab = Phi_0 / S\n        f_ab = 1 / delta_B_ab\n\n        # 2. Synthesize Signal G(B)\n        B_sweep = np.linspace(B_min, B_max, N)\n        \n        # Calculate inhomogeneous flux contribution\n        r_in = R - w / 2\n        r_out = R + w / 2\n\n        def flux_integral_term(r, R_val, g_val, c_val):\n            term_g = g_val * (r**3 / 3 - R_val * r**2 / 2)\n            term_c = c_val * (r**4 / 4 - 2 * R_val * r**3 / 3 + R_val**2 * r**2 / 2)\n            return term_g + term_c\n        \n        Phi_inhom = 2 * np.pi * (flux_integral_term(r_out, R, g, c) - flux_integral_term(r_in, R, g, c))\n        total_flux = S * B_sweep + Phi_inhom\n\n        # Signal components (phi_0 = 0)\n        G_ab_term = A_AB * np.cos(2 * np.pi / Phi_0 * total_flux)\n        M_B_term = alpha * B_sweep + beta * B_sweep**2 + gamma * B_sweep**3\n        N_B_term = s1 * np.sin(2 * np.pi * f1 * B_sweep) + s2 * np.sin(2 * np.pi * f2 * B_sweep)\n        \n        G = G_0 + G_ab_term + M_B_term + N_B_term\n\n        # 3. Analysis: Detrending\n        poly_coeffs = np.polyfit(B_sweep, G, 3)\n        poly_fit = np.polyval(poly_coeffs, B_sweep)\n        G_res = G - poly_fit\n\n        # 4. Analysis: FFT\n        hann_window = np.hanning(N)\n        G_res_windowed = G_res * hann_window\n        \n        G_spectrum = fft.rfft(G_res_windowed)\n        amp_spectrum = np.abs(G_spectrum)\n        \n        dB = (B_max - B_min) / (N - 1)\n        freqs = fft.rfftfreq(N, d=dB)\n        \n        # 5. SBR Calculation\n        idx_ab = np.argmin(np.abs(freqs - f_ab))\n        signal_amp = amp_spectrum[idx_ab]\n        \n        background_mask = np.ones_like(freqs, dtype=bool)\n        background_mask[0] = False # Exclude DC component\n\n        # Exclude window of 3 bins around AB peak from background\n        win_start = max(0, idx_ab - 1)\n        win_end = min(len(freqs), idx_ab + 2)\n        background_mask[win_start:win_end] = False\n        \n        background_level = np.median(amp_spectrum[background_mask])\n        \n        sbr = signal_amp / background_level if background_level > 1e-12 else np.inf\n        detected = sbr > 6.0\n\n        # 6. Variance Fraction Calculation\n        c_basis = np.cos(2 * np.pi * f_ab * B_sweep)\n        s_basis = np.sin(2 * np.pi * f_ab * B_sweep)\n\n        # Projection of G_res onto the AB basis functions\n        A_c = np.dot(G_res, c_basis) / np.dot(c_basis, c_basis)\n        A_s = np.dot(G_res, s_basis) / np.dot(s_basis, s_basis)\n        \n        G_ab_proj = A_c * c_basis + A_s * s_basis\n\n        var_g_ab = np.var(G_ab_proj)\n        var_g_res = np.var(G_res)\n\n        var_fraction = var_g_ab / var_g_res if var_g_res > 1e-12 else 0.0\n\n        # 7. Store results\n        all_results.append([delta_B_ab, detected, var_fraction])\n\n    # 8. Print final output in the required format\n    final_output_strings = []\n    for res in all_results:\n        period, is_detected, var_frac = res\n        res_str = f\"[{period:.6f},{str(is_detected)},{var_frac:.6f}]\"\n        final_output_strings.append(res_str)\n    \n    print(f\"[{','.join(final_output_strings)}]\")\n\nsolve()\n```"
        }
    ]
}