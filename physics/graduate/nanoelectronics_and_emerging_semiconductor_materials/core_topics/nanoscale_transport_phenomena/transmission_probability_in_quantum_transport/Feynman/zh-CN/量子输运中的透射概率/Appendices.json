{
    "hands_on_practices": [
        {
            "introduction": "我们从一个量子输运中最基础也是最重要的模型——矩形势垒——开始我们的实践。通过求解定态薛定谔方程并应用严格的边界条件，您可以推导出粒子隧穿该势垒的精确透射概率。这项练习不仅能巩固您对量子力学基本原理的理解，还将精确解与广泛使用的WKB近似进行对比，从而深刻揭示势垒透射不仅仅是简单的指数衰减，其界面反射效应所贡献的前置因子也至关重要。",
            "id": "4310446",
            "problem": "在一个纳米级一维异质结构中，一个有效质量为 $m^{\\ast}$ 的电子遇到了一个矩形势垒 $U(x)$，其定义为：当 $0  x  L$ 时 $U(x) = U_0 > 0$，其他情况下 $U(x)=0$。一个能量为 $E \\in (0, U_0)$ 的电子从左侧 ($x0$) 入射。\n在厚势垒极限下（即 $\\kappa L \\gg 1$，其中 $\\kappa = \\sqrt{2m^{\\ast}(U_0-E)}/\\hbar$），精确透射概率 $T_{\\mathrm{exact}}$ 可以近似为一个渐近形式 $T_{\\text{asymptotic}}$。你的任务是计算该渐近形式 $T_{\\text{asymptotic}}$ 与标准 Wentzel–Kramers–Brillouin (WKB) 近似值 $T_{\\text{WKB}} = \\exp(-2\\kappa L)$ 的比值 $R = T_{\\text{asymptotic}} / T_{\\text{WKB}}$。\n\n在无量纲单位制中进行计算，其中 $\\hbar=1$ 且 $2m^{\\ast}=1$。在这个单位制中，入射区的波数为 $k = \\sqrt{E}$，势垒区的衰减常数为 $\\kappa = \\sqrt{U_0-E}$。最终答案应以 $k$ 和 $\\kappa$ 表示。",
            "solution": "问题陈述经过严格验证，确认有效。这是一个适定、有科学依据且客观的量子力学领域的问题，具体涉及通过矩形势垒的量子隧穿，这是纳米电子学中的一个基础课题。所有必要的参数和条件都已给出，且没有内部矛盾或事实错误。因此，我们可以进行推导。\n\n该问题要求推导电子隧穿矩形势垒的精确透射概率 $T_{\\mathrm{exact}}$、其在厚势垒情况下的渐近形式，以及该渐近形式与标准 Wentzel–Kramers–Brillouin (WKB) 近似值的比值 $R$。\n\n一维不含时薛定谔方程 (TISE) 由下式给出：\n$$-\\frac{\\hbar^{2}}{2 m^{\\ast}} \\frac{d^{2}\\psi(x)}{d x^{2}} + U(x) \\psi(x) = E \\psi(x)$$\n势 $U(x)$ 定义为：当 $0  x  L$ 时 $U(x) = U_0$，其他情况下为 0。\n\n对于这个问题，我们有三个区域：\n-   区域 I ($x  0$)：$U(x)=0$。解的形式为 $\\psi_I(x) = A e^{ikx} + B e^{-ikx}$，其中 $k = \\sqrt{2m^{\\ast}E}/\\hbar$。\n-   区域 II ($0  x  L$)：$U(x)=U_0$。由于 $E  U_0$，解是衰减的，形式为 $\\psi_{II}(x) = C e^{\\kappa x} + D e^{-\\kappa x}$，其中 $\\kappa = \\sqrt{2m^{\\ast}(U_0-E)}/\\hbar$。\n-   区域 III ($x > L$)：$U(x)=0$。解的形式为 $\\psi_{III}(x) = F e^{ikx}$。我们假设只有透射波，没有从右侧入射的波。\n\n通过在 $x=0$ 和 $x=L$ 处施加边界条件（$\\psi$ 和 $d\\psi/dx$ 连续），我们可以求解系数。经过标准的代数运算，透射系数 $t = F/A$ 被求出，透射概率 $T_{\\mathrm{exact}} = |t|^2$ 的精确表达式为：\n$$ T_{\\mathrm{exact}} = \\frac{1}{1 + \\frac{(k^2+\\kappa^2)^2}{4k^2\\kappa^2}\\sinh^2(\\kappa L)} $$\n在无量纲单位制中（$\\hbar=1, 2m^{\\ast}=1$），$k^2 = E$ 且 $\\kappa^2 = U_0 - E$，所以 $k^2 + \\kappa^2 = U_0$。公式变为：\n$$ T_{\\mathrm{exact}} = \\frac{1}{1 + \\frac{U_0^2}{4E(U_0-E)}\\sinh^2(\\kappa L)} $$\n在厚势垒极限下 ($\\kappa L \\gg 1$)，$\\sinh(\\kappa L) \\approx \\frac{1}{2} e^{\\kappa L}$。将此代入精确表达式中：\n$$ T_{\\mathrm{exact}} \\approx \\frac{1}{1 + \\frac{U_0^2}{4E(U_0-E)} \\left(\\frac{1}{2}e^{\\kappa L}\\right)^2} = \\frac{1}{1 + \\frac{U_0^2}{16E(U_0-E)} e^{2\\kappa L}} $$\n由于 $e^{2\\kappa L}$ 很大，分母中的“1”可以忽略不计。因此，渐近形式为：\n$$ T_{\\text{asymptotic}} = \\frac{1}{\\frac{U_0^2}{16E(U_0-E)} e^{2\\kappa L}} = \\frac{16E(U_0-E)}{U_0^2} e^{-2\\kappa L} $$\nWKB 近似值由下式给出：\n$$ T_{\\text{WKB}} = \\exp\\left(-2 \\int_0^L \\frac{\\sqrt{2m^{\\ast}(U(x)-E)}}{\\hbar} dx\\right) = \\exp\\left(-2 \\int_0^L \\kappa dx\\right) = e^{-2\\kappa L} $$\n最后，我们计算比值 $R$：\n$$ R = \\frac{T_{\\text{asymptotic}}}{T_{\\text{WKB}}} = \\frac{\\frac{16E(U_0-E)}{U_0^2} e^{-2\\kappa L}}{e^{-2\\kappa L}} = \\frac{16E(U_0-E)}{U_0^2} $$\n用无量纲波数 $k=\\sqrt{E}$ 和 $\\kappa=\\sqrt{U_0-E}$ 来表示这个比值：\n$$ R = \\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2} $$\n这个结果表明，对于矩形势垒，WKB近似仅给出了正确的指数衰减因子，而忽略了由于势垒界面处的阻抗失配而产生的一个重要的能量依赖性前置因子。",
            "answer": "$$\n\\boxed{\\frac{16k^{2}\\kappa^{2}}{(k^{2}+\\kappa^{2})^{2}}}\n$$"
        },
        {
            "introduction": "真实纳米器件中的势垒轮廓很少是理想的矩形，而通常是平滑变化的。这个练习将引导您从解析模型走向更贴近实际的数值计算，目标是计算电子通过高斯型势垒的透射概率。您需要将连续的势垒离散化为一系列矩形薄片，并从第一性原理出发，通过编程实现传递矩阵方法来解决这个问题，这对于连接理论与实际计算、培养数值求解能力至关重要。",
            "id": "4310459",
            "problem": "考虑一个电子在一维稳态下通过局域势垒的量子输运过程，该过程由不含时薛定谔方程描述：\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x),$$\n其中，$x$ 是位置，$m$ 是电子质量，$\\hbar$ 是约化普朗克常数，$V(x)$ 是势能分布，$E$ 是总能量，$\\psi(x)$ 是波函数。在本问题中，我们使用无量纲单位制，其中 $\\hbar^2/(2m) = 1$，因此薛定谔方程简化为：\n$$-\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x).$$\n势垒是高斯型的：\n$$V(x) = V_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right),$$\n其中势垒高度为 $V_0$，宽度参数为 $\\sigma$。假设当 $|x|\\to\\infty$ 时 $V(x)\\to 0$，且渐近区域（$x\\ll -\\sigma$ 和 $x\\gg \\sigma$）是自由的（$V=0$）。透射概率 $T(E)$ 是指透射到右侧渐近区域的入射通量所占的比例。\n\n你的任务是，基于高斯势垒的分段常数离散化，使用传输矩阵法从第一性原理出发，构建一个对 $T(E)$ 的收敛数值近似。请从以下基本依据出发：不含时薛定谔方程；在任何势能为常数的区域，通解是反向传播的平面波的叠加；以及在每个界面处，$\\psi(x)$ 及其空间导数 $d\\psi/dx$ 都是连续的。不要引入或假设任何关于势垒透射的预先推导出的公式。而是应：\n- 选择一个包含势垒且 $V(x)$ 不可忽略的有限计算区间 $[-L, L]$，其中 $L$ 与 $\\sigma$ 成正比。解释并证明选择的 $L$ 使得 $V(\\pm L)$ 相对于 $V_0$ 可以忽略不计。\n- 将 $[-L, L]$ 离散化为 $N$ 个宽度为 $\\Delta x$ 的均匀切片，并用切片 $j$ 的中点值 $V_j = V(x_j)$ 来近似该切片内的 $V(x)$，其中 $x_j$ 是切片 $j$ 的中点。在每个切片中，写出局域通解，并通过 $k_j^2 = E - V_j$ 定义局域波数 $k_j$，需要理解的是，对于 $E  V_j$ 的经典禁戒区， $k_j$ 可以是复数值。\n- 根据每个切片界面处 $\\psi$ 和 $d\\psi/dx$ 的连续性，推导出一个 $2\\times 2$ 的界面传输映射，该映射将界面右侧紧邻处的右行波和左行波振幅与左侧紧邻处的振幅联系起来。同时，推导出一个在波数为 $k_j$ 时穿过宽度为 $\\Delta x$ 的切片的 $2\\times 2$ 传播映射。\n- 按照正确的从左到右的顺序组合这些映射，得到一个总的 $2\\times 2$ 传输矩阵 $\\mathbf{M}$，该矩阵将左侧渐近区域的振幅矢量映射到右侧渐近区域。施加物理散射条件，即从左侧有一个单位振幅的入射右行波，而在右侧渐近区域没有左行波，并求解透射振幅。使用左右自由区域相应的渐近波数 $k_\\mathrm{L}$ 和 $k_\\mathrm{R}$，将透射振幅转换为透射概率 $T(E)$。\n- 对 $N$ 实施一种自适应加密策略，即不断将 $N$ 加倍，直到连续两次加密计算得到的 $T(E)$ 值的绝对变化小于指定的容差 $\\varepsilon$，或者直到达到最大值 $N_\\text{max}$。如上所述，使用均匀切片方案和中点法则计算 $V_j$。\n\n对以下参数集测试套件，数值计算 $T(E)$，每个参数集由 $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max})$ 指定，其中 $L = (\\text{L-factor})\\cdot \\sigma$，$N$ 从 $N_0$ 开始并不断加倍，直到收敛至容差 $\\varepsilon$ 或达到 $N_\\text{max}$：\n- 测试用例 1：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 0.15, 6.0, 50, 10^{-6}, 8192)$。\n- 测试用例 2：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 1.5, 6.0, 50, 10^{-6}, 8192)$。\n- 测试用例 3：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 7.5, 6.0, 50, 10^{-8}, 8192)$。\n- 测试用例 4：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 0.2, 0.5, 8.0, 50, 10^{-7}, 8192)$。\n\n在所有情况下，透射概率 $T(E)$ 都是无量纲的。你的程序应生成单行输出，其中包含四个 $T(E)$ 的结果值，以逗号分隔，并用方括号括起来，每个值四舍五入到八位小数（例如，$[0.12345678,0.23456789,0.98765432,0.11121314]$）。不应打印任何其他文本。",
            "solution": "首先验证问题，以确保其科学上合理、适定且完整。\n\n### 步骤 1：提取已知条件\n- **控制方程（无量纲化）**：$-\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$\n- **势能分布**：高斯势垒 $V(x) = V_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$\n- **渐近条件**：当 $|x| \\to \\infty$ 时，$V(x) \\to 0$。\n- **任务**：使用从第一性原理推导的传输矩阵法，数值近似计算透射概率 $T(E)$。\n- **方法论约束**：\n    - 使用 $V(x)$ 的分段常数近似。\n    - 计算区间为 $[-L, L]$，其中 $L$ 与 $\\sigma$ 成正比。\n    - 区间被离散化为 $N$ 个宽度为 $\\Delta x$ 的均匀切片。\n    - 切片 $j$ 中的势是中点值，$V_j = V(x_j)$。\n    - 局域波数 $k_j$ 由 $k_j^2 = E - V_j$ 定义。\n    - 推导一个 $2\\times 2$ 的界面传输映射用于波振幅。\n    - 推导一个 $2\\times 2$ 的传播映射用于穿过一个切片。\n    - 通过乘以这些映射来组合成一个总传输矩阵 $\\mathbf{M}$。\n    - 应用散射边界条件：来自左侧的单位振幅入射波，右侧无入射波。\n    - 使用渐近波数 $k_\\mathrm{L}$ 和 $k_\\mathrm{R}$ 求出 $T(E)$。\n    - 对 $N$ 实现一个自适应加密循环，从初始值 $N_0$ 开始将 $N$ 加倍，直到 $|T_N - T_{N/2}|  \\varepsilon$ 或 $N > N_\\text{max}$。\n- **数值测试用例**：$(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max})$\n    - 用例 1：$(1.5, 1.0, 0.15, 6.0, 50, 10^{-6}, 8192)$\n    - 用例 2：$(1.5, 1.0, 1.5, 6.0, 50, 10^{-6}, 8192)$\n    - 用例 3：$(1.5, 1.0, 7.5, 6.0, 50, 10^{-8}, 8192)$\n    - 用例 4：$(1.5, 0.2, 0.5, 8.0, 50, 10^{-7}, 8192)$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是计算量子力学中的一个标准练习。它基于不含时薛定谔方程和传输矩阵法，这两者都是物理学中基本且完善的概念。所有原理都是合理的。\n- **适定性**：该问题是适定的。对于给定的能量 $E$ 和势 $V(x)$，具有指定渐近边界条件的散射问题对于透射和反射振幅有唯一解。所描述的数值方法是找到该解的一种标准的、收敛的方法。\n- **客观性**：问题以精确、客观的数学语言陈述，没有主观或模糊的术语。\n- **不完整或矛盾的设置**：问题是自洽的。对于每个测试用例，势和能量所需的所有物理参数，以及算法所需的所有数值参数（域大小、离散化、收敛标准）都已明确提供。\n- **不切实际或不可行**：物理参数对于量子力学中的模型问题是典型的数量级。数值参数是合理的，应该能在可行的计算时间内得到收敛解。\n- **其他缺陷**：该问题是一项实质性任务，需要从第一性原理进行推导并实现一个非平凡的数值算法。它没有列出的任何其他缺陷。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解决方案。\n\n### 求解推导\n\n求解过程遵循问题陈述中概述的步骤。\n\n**1. 计算域与离散化**\n高斯势 $V(x) = V_0 \\exp(-x^2 / (2\\sigma^2))$ 在远离 $x=0$ 的地方快速衰减。我们选择一个有限的计算域 $[-L, L]$，其中 $L = (\\text{L-factor}) \\cdot \\sigma$。在该域之外，势被假定为零。选择 $L$ 的合理性在于确保 $V(\\pm L)$ 可以忽略不计。在 $x=\\pm L$ 处，势为 $V(\\pm L) = V_0 \\exp(-L^2/(2\\sigma^2)) = V_0 \\exp(-(\\text{L-factor})^2/2)$。对于给定的最小 $\\text{L-factor}$ 值 $6.0$，$V(\\pm L) / V_0 = \\exp(-6^2/2) = \\exp(-18) \\approx 1.5 \\times 10^{-8}$，这是势垒高度的一个可忽略部分。因此，这个 $L$ 的选择是合理的。\n\n区间 $[-L, L]$ 被离散化为 $N$ 个均匀切片，每个切片宽度为 $\\Delta x = 2L/N$。切片之间的界面位于位置 $x'_j = -L + j \\Delta x$，其中 $j = 0, 1, \\dots, N$。第 $j$ 个切片覆盖区间 $[x'_{j-1}, x'_j]$。第 $j$ 个切片（$j=1, \\dots, N$）内的势由其在中点 $x_j = -L + (j - 1/2)\\Delta x$ 的值来近似，从而得到一个分段常数势能分布 $V_j = V(x_j)$。\n\n**2. 局域解与波数**\n在每个切片 $j$ 内部，势是恒定的，$V(x) = V_j$。薛定谔方程变为：\n$$-\\frac{d^2\\psi_j(x)}{dx^2} = (E - V_j)\\psi_j(x)$$\n我们定义局域波数的平方为 $k_j^2 = E - V_j$。波数为 $k_j = \\sqrt{E - V_j}$。如果 $E  V_j$（经典禁戒区），$k_j$ 变为纯虚数，$k_j = i\\kappa_j$，其中 $\\kappa_j = \\sqrt{V_j - E}$。切片 $j$ 中的通解是右行和左行平面波的叠加：\n$$\\psi_j(x) = A_j e^{i k_j x} + B_j e^{-i k_j x}$$\n其中 $A_j$ 和 $B_j$ 是复振幅。其导数为：\n$$\\frac{d\\psi_j(x)}{dx} = i k_j (A_j e^{i k_j x} - B_j e^{-i k_j x})$$\n\n**3. 传播矩阵与界面矩阵的推导**\n我们采用一种形式体系，其中波的振幅是相对于每个切片的起点来定义的。对于跨越 $[x'_{j-1}, x'_{j}]$ 的切片 $j$，我们使用局域坐标 $\\tilde{x} = x - x'_{j-1}$，所以 $\\tilde{x} \\in [0, \\Delta x]$。解为：\n$$\\psi_j(\\tilde{x}) = A_j e^{i k_j \\tilde{x}} + B_j e^{-i k_j \\tilde{x}}$$\n在切片入口处 $(\\tilde{x}=0)$ 的振幅矢量为 $\\mathbf{c}^{\\text{in}}_j = \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix}$。\n\n**传播映射**：在切片末端 $(\\tilde{x}=\\Delta x)$，波为：\n$$\\psi_j(\\Delta x) = A_j e^{i k_j \\Delta x} + B_j e^{-i k_j \\Delta x}$$\n在切片末端，相对于其起点的右行和左行分量的振幅为 $(A_j e^{i k_j \\Delta x}, B_j e^{-i k_j \\Delta x})$。传播映射将出射相量与入射振幅关联起来：\n$$ \\begin{pmatrix} A_j e^{i k_j \\Delta x} \\\\ B_j e^{-i k_j \\Delta x} \\end{pmatrix} = \\begin{pmatrix} e^{i k_j \\Delta x}  0 \\\\ 0  e^{-i k_j \\Delta x} \\end{pmatrix} \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix} $$\n因此，切片 $j$ 的**传播矩阵**是：\n$$ \\mathbf{P}_j = \\begin{pmatrix} e^{i k_j \\Delta x}  0 \\\\ 0  e^{-i k_j \\Delta x} \\end{pmatrix} $$\n\n**界面映射**：在切片 $j$（波数 $k_j$）和切片 $j+1$（波数 $k_{j+1}$）之间的界面 $x'_{j}$ 处，$\\psi(x)$ 和 $d\\psi/dx$ 都必须是连续的。设 $\\mathbf{c}^{\\text{out}}_j = \\mathbf{P}_j \\mathbf{c}^{\\text{in}}_j$ 为切片 $j$ 末端的相量矢量。设 $\\mathbf{c}^{\\text{in}}_{j+1} = \\begin{pmatrix} A_{j+1} \\\\ B_{j+1} \\end{pmatrix}$ 为切片 $j+1$ 起始处的振幅矢量。\n$\\psi$ 在 $x'_j$ 处的连续性：$\\psi_j(\\Delta x) = \\psi_{j+1}(0)$。\n$$ A_j e^{i k_j \\Delta x} + B_j e^{-i k_j \\Delta x} = A_{j+1} + B_{j+1} $$\n$d\\psi/dx$ 在 $x'_j$ 处的连续性：$\\psi_j'(\\Delta x) = \\psi_{j+1}'(0)$。\n$$ i k_j (A_j e^{i k_j \\Delta x} - B_j e^{-i k_j \\Delta x}) = i k_{j+1} (A_{j+1} - B_{j+1}) $$\n令 $\\alpha = A_j e^{i k_j \\Delta x}$ 和 $\\beta = B_j e^{-i k_j \\Delta x}$。方程组为：\n$$ \\alpha + \\beta = A_{j+1} + B_{j+1} $$\n$$ k_j(\\alpha - \\beta) = k_{j+1}(A_{j+1} - B_{j+1}) $$\n解这个关于 $A_{j+1}$ 和 $B_{j+1}$ 的线性方程组：\n$$ A_{j+1} = \\frac{1}{2} \\left( (\\alpha+\\beta) + \\frac{k_j}{k_{j+1}}(\\alpha-\\beta) \\right) = \\frac{k_{j+1}+k_j}{2k_{j+1}}\\alpha + \\frac{k_{j+1}-k_j}{2k_{j+1}}\\beta $$\n$$ B_{j+1} = \\frac{1}{2} \\left( (\\alpha+\\beta) - \\frac{k_j}{k_{j+1}}(\\alpha-\\beta) \\right) = \\frac{k_{j+1}-k_j}{2k_{j+1}}\\alpha + \\frac{k_{j+1}+k_j}{2k_{j+1}}\\beta $$\n这定义了**界面矩阵** $\\mathbf{I}_{j \\to j+1}$，它将切片 $j+1$ 的输入振幅与切片 $j$ 的输出相量关联起来：\n$$ \\mathbf{c}^{\\text{in}}_{j+1} = \\mathbf{I}_{j \\to j+1} \\mathbf{c}^{\\text{out}}_j \\quad \\text{其中} \\quad \\mathbf{I}_{j \\to j+1} = \\frac{1}{2k_{j+1}} \\begin{pmatrix} k_{j+1}+k_j  k_{j+1}-k_j \\\\ k_{j+1}-k_j  k_{j+1}+k_j \\end{pmatrix} $$\n\n**4. 总传输矩阵**\n我们构建一个总传输矩阵 $\\mathbf{M}_{\\text{total}}$，它将左侧渐近区域（区域 0）的振幅矢量 $\\mathbf{c}_0 = \\begin{pmatrix} A_0 \\\\ B_0 \\end{pmatrix}$ 映射到右侧渐近区域（区域 $N+1$）的振幅矢量 $\\mathbf{c}_{N+1} = \\begin{pmatrix} A_{N+1} \\\\ B_{N+1} \\end{pmatrix}$。\n$$ \\mathbf{c}_{N+1} = \\mathbf{M}_{\\text{total}} \\mathbf{c}_0 $$\n这个总矩阵是通过从左到右依次乘以每个步骤的矩阵而构建的：\n$$ \\mathbf{M}_{\\text{total}} = (\\mathbf{I}_{N \\to N+1}\\mathbf{P}_N) \\cdots (\\mathbf{I}_{1 \\to 2}\\mathbf{P}_1) (\\mathbf{I}_{0 \\to 1}) $$\n这里，$\\mathbf{P}_j$ 是第 $j$ 个切片的传播矩阵，$\\mathbf{I}_{j \\to j+1}$ 是从区域 $j$ 到区域 $j+1$ 的界面矩阵。\n\n**5. 透射概率**\n散射边界条件是：一个来自左侧的单位振幅入射波（$A_0 = 1$），并且右侧没有入射波（$B_{N+1} = 0$）。方程为：\n$$ \\begin{pmatrix} A_{N+1} \\\\ 0 \\end{pmatrix} = \\mathbf{M}_{\\text{total}} \\begin{pmatrix} 1 \\\\ B_0 \\end{pmatrix} = \\begin{pmatrix} M_{11}  M_{12} \\\\ M_{21}  M_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ B_0 \\end{pmatrix} $$\n第二行给出 $0 = M_{21} + M_{22} B_0$，可以用来求解反射振幅 $B_0$。第一行给出透射振幅 $A_{N+1} = M_{11} + M_{12} B_0 = M_{11} - M_{12} \\frac{M_{21}}{M_{22}} = \\frac{\\det(\\mathbf{M}_{\\text{total}})}{M_{22}}$。\n总矩阵的行列式可以证明为 $\\det(\\mathbf{M}_{\\text{total}}) = k_0 / k_{N+1} = k_L / k_R$。\n透射振幅为 $t = A_{N+1}/A_0 = A_{N+1} = \\frac{k_L/k_R}{M_{22}}$。\n\n透射概率 $T(E)$ 是透射概率流与入射概率流之比。平面波 $A e^{ikx}$ 的概率流正比于 $k|A|^2$。\n$$ T(E) = \\frac{j_{\\text{trans}}}{j_{\\text{inc}}} = \\frac{k_R |A_{N+1}|^2}{k_L |A_0|^2} = \\frac{k_R}{k_L} \\left| \\frac{k_L/k_R}{M_{22}} \\right|^2 = \\frac{k_R}{k_L} \\frac{(k_L/k_R)^2}{|M_{22}|^2} = \\frac{k_L}{k_R} \\frac{1}{|M_{22}|^2} $$\n由于在这个问题中 $V(x) \\to 0$ 渐近地成立，我们有 $k_L = k_R = \\sqrt{E}$。因此，公式简化为 $T(E) = 1 / |M_{22}|^2$。\n\n**6. 数值实现**\n实现一个自适应算法。对于每个测试用例，我们从 $N=N_0$ 开始。我们计算 $T(E)$。然后我们将 $N$ 加倍并重新计算 $T(E)$，持续这个过程直到连续计算之间的绝对差小于容差 $\\varepsilon$，或者直到 $N$ 超过 $N_\\text{max}$。对于给定的 $N$，计算过程包括：\n1.  定义切片中点网格 $x_j$ 并计算势 $V_j$。\n2.  计算所有切片的波数 $k_j = \\sqrt{E - V_j + 0j}$，以及渐近波数 $k_L=k_R=\\sqrt{E}$。\n3.  初始化总矩阵 $\\mathbf{M}_{\\text{total}}$ 为从区域 0 到切片 1 的界面矩阵 $\\mathbf{I}_{0 \\to 1}$。\n4.  从 $j=1$ 到 $N$ 循环，通过当前步骤的矩阵进行左乘：$\\mathbf{M}_{\\text{total}} = (\\mathbf{I}_{j \\to j+1}\\mathbf{P}_j) \\mathbf{M}_{\\text{total}}$。\n5.  计算 $T(E) = 1 / |(\\mathbf{M}_{\\text{total}})_{2,2}|^2$。\n这将产生透射概率的一个收敛估计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    \n    # Test cases: (V0, sigma, E, L_factor, N0, epsilon, N_max)\n    test_cases = [\n        (1.5, 1.0, 0.15, 6.0, 50, 1e-6, 8192),\n        (1.5, 1.0, 1.5, 6.0, 50, 1e-6, 8192),\n        (1.5, 1.0, 7.5, 6.0, 50, 1e-8, 8192),\n        (1.5, 0.2, 0.5, 8.0, 50, 1e-7, 8192),\n    ]\n\n    results = []\n    for params in test_cases:\n        T_final = calculate_transmission_probability(*params)\n        results.append(f\"{T_final:.8f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_transmission_probability(V0, sigma, E, L_factor, N0, epsilon, N_max):\n    \"\"\"\n    Calculates the transmission probability T(E) for a Gaussian barrier using an\n    adaptive transfer-matrix method.\n\n    Args:\n        V0 (float): Barrier height.\n        sigma (float): Barrier width parameter.\n        E (float): Incident electron energy.\n        L_factor (float): Factor to determine computational domain [-L, L] where L = L_factor * sigma.\n        N0 (int): Initial number of discretization slices.\n        epsilon (float): Convergence tolerance for T(E).\n        N_max (int): Maximum number of slices.\n\n    Returns:\n        float: The converged transmission probability T(E).\n    \"\"\"\n\n    N = N0\n    T_prev = -1.0  # Sentinel value\n\n    while N = N_max:\n        L = L_factor * sigma\n        delta_x = 2 * L / N\n\n        # Define slice midpoints and potential values\n        x_j = -L + (np.arange(N) + 0.5) * delta_x\n        V_j = V0 * np.exp(-x_j**2 / (2 * sigma**2))\n\n        # Wavenumbers: k_async, k_1, ..., k_N, k_async\n        # Ensure arguments to sqrt are complex to handle E  V cases.\n        k = np.sqrt(E - V_j + 0j)\n        k_asymptotic = np.sqrt(E + 0j)\n        \n        # Check for E=0 case where k_asymptotic is 0\n        if np.isclose(k_asymptotic.real, 0) and np.isclose(k_asymptotic.imag, 0):\n            # For E=0, transmission is exactly 0 unless V(x)=0 everywhere.\n            return 0.0\n\n        # Assemble the total transfer matrix M_total that maps amplitudes from\n        # the left lead to the right lead.\n        # The matrix multiplication order is M_total = M_{N->N+1} * ... * M_{1->2} * M_{0->1}\n        # where M_{j->j+1} = I_{j->j+1} @ P_j. This is built by right-multiplication.\n        # Let's adjust the logic slightly to be more direct.\n        # We want to compute T = M_total where M_total maps (A_0, B_0) to (A_{N+1}, B_{N+1})\n        # This is built by left-multiplication.\n        \n        # Start with the first interface matrix I_0->1 (from left lead to slice 1)\n        k_left = k_asymptotic\n        k_right = k[0]\n        \n        # Interface Matrix I = 1/(2*k_r) * [[k_r+k_l, k_r-k_l], [k_r-k_l, k_r+k_l]]\n        term1 = k_right + k_left\n        term2 = k_right - k_left\n        M_total = (0.5 / k_right) * np.array([[term1, term2], [term2, term1]], dtype=np.complex128)\n\n        # Loop through slices 1 to N (0 to N-1 in code)\n        for j in range(N):\n            # Propagation matrix for slice j (0-indexed in code)\n            k_curr = k[j]\n            P_j = np.array([[np.exp(1j * k_curr * delta_x), 0],\n                            [0, np.exp(-1j * k_curr * delta_x)]], dtype=np.complex128)\n\n            # Interface matrix from slice j to j+1\n            k_left = k_curr\n            # If at the last slice, the next region is the right lead\n            k_right = k[j + 1] if j  N - 1 else k_asymptotic\n\n            term1 = k_right + k_left\n            term2 = k_right - k_left\n            I_j_jp1 = (0.5 / k_right) * np.array([[term1, term2], [term2, term1]], dtype=np.complex128)\n            \n            # The matrix for one step (propagate through slice j, then cross interface j) is I_j_jp1 @ P_j\n            # We want to find the matrix that relates c_0 to c_{N+1}.\n            # c_{j+1} = I_{j->j+1} @ P_j @ c_j. We have c_1 = I_{0->1} @ c_0.\n            # So, c_2 = I_{1->2}P_1 c_1 = I_{1->2}P_1 I_{0->1} c_0.\n            # M_total is built by left-multiplication.\n            \n            M_step_matrix = I_j_jp1 @ P_j\n            M_total = M_step_matrix @ M_total\n        \n        # Transmission probability T = 1 / |M_22|^2 (or M[1,1] in 0-indexed)\n        # since k_L = k_R in this problem.\n        T_current = 1.0 / np.abs(M_total[1, 1])**2\n\n        # Check for convergence\n        if T_prev >= 0 and np.abs(T_current - T_prev)  epsilon:\n            return T_current\n\n        T_prev = T_current\n        N *= 2\n\n    # Return the last calculated value if max iterations reached\n    return T_prev\n\nsolve()\n```"
        }
    ]
}