{
    "hands_on_practices": [
        {
            "introduction": "We begin with the \"hydrogen atom\" of quantum scattering: the rectangular potential barrier. While a simplified model, its exact analytical solution provides a crucial benchmark for testing our physical intuition and validating more complex numerical codes. This exercise  involves deriving the transmission probability from first principles and comparing it to the Wentzel–Kramers–Brillouin (WKB) approximation, revealing how and why this powerful approximation can sometimes fall short.",
            "id": "4310446",
            "problem": "An electron with effective mass $m^{\\ast}$ in a nanoscale one-dimensional heterostructure encounters a rectangular potential barrier $U(x)$ defined by $U(x)=U_{0}$ for $0xL$ and $U(x)=0$ otherwise. Assume ballistic coherent transport and model the electron with the time-independent Schrödinger equation $-\\frac{\\hbar^{2}}{2 m^{\\ast}} \\frac{d^{2}\\psi(x)}{d x^{2}} + U(x) \\psi(x) = E \\psi(x)$ at energy $E$ with $0EU_{0}$. Define $k=\\sqrt{\\frac{2 m^{\\ast} E}{\\hbar^{2}}}$ and $\\kappa=\\sqrt{\\frac{2 m^{\\ast}(U_{0}-E)}{\\hbar^{2}}}$.\n\nStarting from the Schrödinger equation and continuity of the wavefunction and its derivative at the interfaces $x=0$ and $x=L$, derive the exact transmission probability $T_{\\mathrm{exact}}(E,U_{0},L,m^{\\ast})$ through the barrier. Then, in the limit of a thick barrier with $\\kappa L \\gg 1$, extract the leading-order asymptotic form of $T_{\\mathrm{exact}}$ and compare it to the naive Wentzel–Kramers–Brillouin (WKB) approximation $T_{\\mathrm{WKB}}=\\exp(-2 \\kappa L)$ that retains only the exponential attenuation across the classically forbidden region.\n\nDefine the ratio $R=\\frac{T_{\\mathrm{exact}}}{T_{\\mathrm{WKB}}}$ in the limit $\\kappa L \\gg 1$. Provide $R$ as a closed-form analytic expression in terms of $k$ and $\\kappa$. Briefly indicate, in terms of the dimensionless parameters $\\kappa L$ and $\\eta=k/\\kappa$, when the exponential error and the prefactor error of the WKB approximation become significant. The final answer must be the single analytic expression for $R$.",
            "solution": "The problem asks for the derivation of the exact transmission probability $T_{\\mathrm{exact}}$ for an electron tunneling through a rectangular potential barrier, its asymptotic form for a thick barrier, and the ratio $R$ of this form to the standard Wentzel–Kramers–Brillouin (WKB) approximation.\n\nThe one-dimensional time-independent Schrödinger equation (TISE) is given by:\n$$-\\frac{\\hbar^{2}}{2 m^{\\ast}} \\frac{d^{2}\\psi(x)}{d x^{2}} + U(x) \\psi(x) = E \\psi(x)$$\nThe potential $U(x)$ is defined as $U(x)=U_{0}$ for $0xL$ and $U(x)=0$ otherwise. The electron energy $E$ is in the tunneling regime, $0  E  U_{0}$.\n\nWe divide the problem into three regions:\nRegion I ($x0$, $U(x)=0$): The TISE is $\\frac{d^{2}\\psi_I}{d x^{2}} + k^{2}\\psi_I = 0$, where $k=\\sqrt{\\frac{2 m^{\\ast} E}{\\hbar^{2}}}$.\nThe general solution is a superposition of an incident wave traveling to the right and a reflected wave traveling to the left:\n$$\\psi_{I}(x) = A e^{ikx} + B e^{-ikx}$$\n\nRegion II ($0xL$, $U(x)=U_0$): The TISE is $\\frac{d^{2}\\psi_{II}}{d x^{2}} - \\kappa^{2}\\psi_{II} = 0$, where $\\kappa=\\sqrt{\\frac{2 m^{\\ast}(U_{0}-E)}{\\hbar^{2}}}$.\nThe general solution is a superposition of an exponentially decaying and an exponentially growing evanescent wave:\n$$\\psi_{II}(x) = C e^{\\kappa x} + D e^{-\\kappa x}$$\n\nRegion III ($xL$, $U(x)=0$): The TISE is again $\\frac{d^{2}\\psi_{III}}{d x^{2}} + k^{2}\\psi_{III} = 0$.\nThe solution represents a transmitted wave traveling to the right. Since there are no sources of particles for $x \\to \\infty$, there is no wave traveling to the left in this region:\n$$\\psi_{III}(x) = F e^{ikx}$$\n\nTo find the relationship between the coefficients, we apply the boundary conditions that the wavefunction $\\psi(x)$ and its first derivative $\\frac{d\\psi(x)}{dx}$ must be continuous at the interfaces $x=0$ and $x=L$.\n\nAt $x=0$:\n1. $\\psi_I(0) = \\psi_{II}(0) \\implies A+B = C+D$\n2. $\\psi'_I(0) = \\psi'_{II}(0) \\implies ik(A-B) = \\kappa(C-D)$\n\nAt $x=L$:\n3. $\\psi_{II}(L) = \\psi_{III}(L) \\implies C e^{\\kappa L} + D e^{-\\kappa L} = F e^{ikL}$\n4. $\\psi'_{II}(L) = \\psi'_{III}(L) \\implies \\kappa(C e^{\\kappa L} - D e^{-\\kappa L}) = ik F e^{ikL}$\n\nOur goal is to find the transmission probability $T = |F/A|^2$. We solve the system of equations for the ratio $F/A$. From equations (3) and (4), we can express $C$ and $D$ in terms of $F$:\nAdding (4) to $\\kappa \\times (3)$: $2\\kappa C e^{\\kappa L} = (\\kappa+ik) F e^{ikL} \\implies C = \\frac{\\kappa+ik}{2\\kappa} F e^{ikL} e^{-\\kappa L}$.\nSubtracting (4) from $\\kappa \\times (3)$: $2\\kappa D e^{-\\kappa L} = (\\kappa-ik) F e^{ikL} \\implies D = \\frac{\\kappa-ik}{2\\kappa} F e^{ikL} e^{\\kappa L}$.\n\nNow, we use equations (1) and (2) to express $A$ in terms of $C$ and $D$, and subsequently in terms of $F$. From (1) and (2):\n$2A = (A+B) + (A-B) = (C+D) + \\frac{\\kappa}{ik}(C-D) = C(1+\\frac{\\kappa}{ik}) + D(1-\\frac{\\kappa}{ik})$.\nUsing a more structured approach with hyperbolic functions is cleaner. Let's express $A$ in terms of $F$ using the expressions for $C$ and $D$ derived above.\n$A+B = C+D = F e^{ikL} \\left[ \\frac{\\kappa+ik}{2\\kappa}e^{-\\kappa L} + \\frac{\\kappa-ik}{2\\kappa}e^{\\kappa L} \\right] = F e^{ikL} \\left[ \\cosh(\\kappa L) - \\frac{ik}{\\kappa}\\sinh(\\kappa L) \\right]$\n$A-B = \\frac{\\kappa}{ik}(C-D) = \\frac{\\kappa}{ik} F e^{ikL} \\left[ \\frac{\\kappa+ik}{2\\kappa}e^{-\\kappa L} - \\frac{\\kappa-ik}{2\\kappa}e^{\\kappa L} \\right] = F e^{ikL} \\left[ -\\frac{\\kappa}{ik}\\sinh(\\kappa L) + \\cosh(\\kappa L) \\right]$\nAdding these two equations for $A+B$ and $A-B$ gives $2A$:\n$2A = F e^{ikL} \\left[ 2\\cosh(\\kappa L) - i(\\frac{k}{\\kappa} + \\frac{\\kappa}{k}) \\sinh(\\kappa L) \\right]$\nThe inverse of the transmission amplitude $A/F$ is therefore:\n$\\frac{A}{F} = e^{ikL} \\left[ \\cosh(\\kappa L) - \\frac{i}{2}(\\frac{k}{\\kappa} + \\frac{\\kappa}{k}) \\sinh(\\kappa L) \\right]$\nThe transmission probability is $T_{\\mathrm{exact}} = |F/A|^2$. We compute $|A/F|^2$:\n$|A/F|^2 = \\left| e^{ikL} \\right|^2 \\left| \\cosh(\\kappa L) - \\frac{i}{2}(\\frac{k}{\\kappa} + \\frac{\\kappa}{k}) \\sinh(\\kappa L) \\right|^2$\n$|A/F|^2 = (1) \\left[ \\cosh^2(\\kappa L) + \\frac{1}{4}(\\frac{k}{\\kappa} + \\frac{\\kappa}{k})^2 \\sinh^2(\\kappa L) \\right]$\nUsing the identity $\\cosh^2(x) = 1 + \\sinh^2(x)$:\n$|A/F|^2 = 1 + \\sinh^2(\\kappa L) + \\frac{1}{4}\\frac{(k^2+\\kappa^2)^2}{k^2\\kappa^2} \\sinh^2(\\kappa L)$\n$|A/F|^2 = 1 + \\left( 1 + \\frac{(k^2+\\kappa^2)^2}{4k^2\\kappa^2} \\right) \\sinh^2(\\kappa L) = 1 + \\frac{(k^2+\\kappa^2)^2}{4k^2\\kappa^2}\\sinh^2(\\kappa L)$\nSo, the exact transmission probability is:\n$$T_{\\mathrm{exact}} = \\frac{1}{|A/F|^2} = \\left[ 1 + \\frac{(k^2+\\kappa^2)^2}{4k^2\\kappa^2} \\sinh^2(\\kappa L) \\right]^{-1}$$\n\nNext, we find the leading-order asymptotic form in the limit of a thick barrier, $\\kappa L \\gg 1$. In this limit, $\\sinh(\\kappa L) = \\frac{e^{\\kappa L} - e^{-\\kappa L}}{2} \\approx \\frac{1}{2}e^{\\kappa L}$.\nSubstituting this into the expression for $T_{\\mathrm{exact}}^{-1}$:\n$T_{\\mathrm{exact}}^{-1} \\approx 1 + \\frac{(k^2+\\kappa^2)^2}{4k^2\\kappa^2} \\left( \\frac{1}{2}e^{\\kappa L} \\right)^2 = 1 + \\frac{(k^2+\\kappa^2)^2}{16k^2\\kappa^2} e^{2\\kappa L}$\nSince $\\kappa L \\gg 1$, the exponential term $e^{2\\kappa L}$ is very large, making the additive constant $1$ negligible.\n$T_{\\mathrm{exact}}^{-1} \\approx \\frac{(k^2+\\kappa^2)^2}{16k^2\\kappa^2} e^{2\\kappa L}$\nThus, the asymptotic form of the transmission probability is:\n$$T_{\\mathrm{exact}} \\approx \\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2} e^{-2\\kappa L}$$\n\nThe problem provides the naive WKB approximation as $T_{\\mathrm{WKB}} = \\exp(-2\\kappa L)$. This approximation captures only the exponential decay within the barrier.\nThe ratio $R$ is defined as $R = \\frac{T_{\\mathrm{exact}}}{T_{\\mathrm{WKB}}}$ in the limit $\\kappa L \\gg 1$.\n$$R = \\frac{\\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2} e^{-2\\kappa L}}{\\exp(-2\\kappa L)} = \\frac{16k^2\\kappa^2}{(k^2+\\kappa^2)^2}$$\nThis expression for $R$ is the required pre-exponential factor that the naive WKB approximation misses. This prefactor accounts for reflections at the sharp interfaces of the barrier, which are not captured by the WKB approximation that assumes a slowly varying potential. The error from this prefactor depends on the ratio $\\eta = k/\\kappa$ and is significant unless $\\eta$ is very large or very small. The exponential error from the WKB approximation is significant when the barrier is not thick, i.e., when $\\kappa L$ is not much greater than 1.\n\nThe final answer required is the single expression for $R$.",
            "answer": "$$\n\\boxed{\\frac{16k^{2}\\kappa^{2}}{(k^{2}+\\kappa^{2})^{2}}}\n$$"
        },
        {
            "introduction": "Potentials in real nanoscale devices are rarely simple rectangles; they are often smooth and spatially complex. This practice  challenges you to move beyond analytical solutions and build a numerical engine to compute transmission through an arbitrary potential, here exemplified by a Gaussian barrier. By discretizing the potential and composing a total transfer matrix from elementary propagation and interface steps, you will translate the principles of quantum mechanics into a powerful and convergent computational tool.",
            "id": "4310459",
            "problem": "Consider one-dimensional steady-state quantum transport of an electron through a localized barrier, modeled by the time-independent Schrödinger equation\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x),$$\nwhere $x$ is position, $m$ is the electron mass, $\\hbar$ is the reduced Planck constant, $V(x)$ is the potential energy profile, $E$ is the total energy, and $\\psi(x)$ is the wavefunction. In this problem, work in a nondimensionalized unit system with $\\hbar^2/(2m) = 1$ so that the Schrödinger equation reduces to\n$$-\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x).$$\nThe barrier is Gaussian: \n$$V(x) = V_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right),$$\nwith barrier height $V_0$ and width parameter $\\sigma$. Assume $V(x)\\to 0$ as $|x|\\to\\infty$ and that the asymptotic regions ($x\\ll -\\sigma$ and $x\\gg \\sigma$) are free ($V=0$). The transmission probability $T(E)$ is the fraction of incident flux transmitted to the right asymptotic region.\n\nYour task is to construct from first principles a convergent numerical approximation to $T(E)$ using a transfer-matrix method based on a piecewise-constant discretization of the Gaussian barrier. Start from the fundamental base consisting of: the time-independent Schrödinger equation, the fact that in any region where the potential is constant the general solution is a superposition of counter-propagating plane waves, and the continuity of $\\psi(x)$ and its spatial derivative $d\\psi/dx$ at every interface. Do not import or assume any pre-derived formulas for transmission through barriers. Instead:\n- Choose a finite computational interval $[-L, L]$ that contains the barrier and on which $V(x)$ is non-negligible, with $L$ proportional to $\\sigma$. Explain and justify the choice of $L$ so that $V(\\pm L)$ is negligible compared to $V_0$.\n- Discretize $[-L, L]$ into $N$ uniform slices of width $\\Delta x$, and approximate $V(x)$ in slice $j$ by the midpoint value $V_j = V(x_j)$, where $x_j$ is the midpoint of slice $j$. In each slice, write the local general solution and define the local wavenumber $k_j$ via $k_j^2 = E - V_j$, understanding that $k_j$ can be complex-valued for classically forbidden slices where $E  V_j$.\n- From the continuity of $\\psi$ and $d\\psi/dx$ at each slice interface, derive a $2\\times 2$ interface transfer mapping that relates the right-going and left-going wave amplitudes immediately to the right of the interface to those immediately to the left. Also derive a $2\\times 2$ propagation mapping for traversing a slice of width $\\Delta x$ at wavenumber $k_j$.\n- Compose these mappings in the correct left-to-right order to obtain a total $2\\times 2$ transfer matrix $\\mathbf{M}$ that maps the amplitude vector in the left asymptotic region to that in the right asymptotic region. Impose the physical scattering condition that there is one unit-amplitude incident right-going wave from the left and no left-going wave in the right asymptotic region, and solve for the transmitted amplitude. Use the appropriate asymptotic wavenumbers $k_\\mathrm{L}$ and $k_\\mathrm{R}$ for the left and right free regions to convert the transmitted amplitude into transmission probability $T(E)$.\n- Implement an adaptive refinement strategy over $N$ that doubles $N$ until the absolute change in $T(E)$ between successive refinements is below a prescribed tolerance $\\varepsilon$, or until a maximum $N_\\text{max}$ is reached. Use a uniform slice scheme and the midpoint rule for $V_j$ as specified above.\n\nNumerically evaluate $T(E)$ for the following test suite of parameter sets, each specified by $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max})$, where $L = (\\text{L-factor})\\cdot \\sigma$ and $N$ starts from $N_0$ and is doubled until convergence to tolerance $\\varepsilon$ or until $N_\\text{max}$:\n- Test case $1$: $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 0.15, 6.0, 50, 10^{-6}, 8192)$.\n- Test case $2$: $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 1.5, 6.0, 50, 10^{-6}, 8192)$.\n- Test case $3$: $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 1.0, 7.5, 6.0, 50, 10^{-8}, 8192)$.\n- Test case $4$: $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max}) = (1.5, 0.2, 0.5, 8.0, 50, 10^{-7}, 8192)$.\n\nIn all cases, the transmission probability $T(E)$ is dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of the four $T(E)$ values, each rounded to eight decimal places, enclosed in square brackets (for example, $[0.12345678,0.23456789,0.98765432,0.11121314]$).",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and complete.\n\n### Step 1: Extract Givens\n- **Governing Equation (nondimensionalized)**: $-\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$\n- **Potential Profile**: Gaussian barrier $V(x) = V_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$\n- **Asymptotic Conditions**: $V(x) \\to 0$ as $|x| \\to \\infty$.\n- **Task**: Numerically approximate the transmission probability $T(E)$ using a transfer-matrix method derived from first principles.\n- **Methodological Constraints**:\n    - Use a piecewise-constant approximation of $V(x)$.\n    - The computational interval is $[-L, L]$, with $L$ proportional to $\\sigma$.\n    - The interval is discretized into $N$ uniform slices of width $\\Delta x$.\n    - The potential in slice $j$ is the midpoint value, $V_j = V(x_j)$.\n    - The local wavenumber $k_j$ is defined by $k_j^2 = E - V_j$.\n    - Derive a $2\\times 2$ interface transfer mapping for wave amplitudes.\n    - Derive a $2\\times 2$ propagation mapping for traversing a slice.\n    - Compose a total transfer matrix $\\mathbf{M}$ by multiplying these mappings.\n    - Apply scattering boundary conditions: unit-amplitude incident wave from the left, no incident wave from the right.\n    - Use asymptotic wavenumbers $k_\\mathrm{L}$ and $k_\\mathrm{R}$ to find $T(E)$.\n    - Implement an adaptive refinement loop for $N$, doubling $N$ from an initial value $N_0$ until $|T_N - T_{N/2}|  \\varepsilon$ or $N  N_\\text{max}$.\n- **Numerical Test Cases**: $(V_0, \\sigma, E, L\\text{-factor}, N_0, \\varepsilon, N_\\text{max})$\n    - Case 1: $(1.5, 1.0, 0.15, 6.0, 50, 10^{-6}, 8192)$\n    - Case 2: $(1.5, 1.0, 1.5, 6.0, 50, 10^{-6}, 8192)$\n    - Case 3: $(1.5, 1.0, 7.5, 6.0, 50, 10^{-8}, 8192)$\n    - Case 4: $(1.5, 0.2, 0.5, 8.0, 50, 10^{-7}, 8192)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in computational quantum mechanics, based on sound physical and numerical principles. The setup is complete, objective, and feasible.\n\n### Solution Derivation\n\nThe solution is constructed by following the steps outlined in the problem statement.\n\n**1. Computational Domain and Discretization**\nThe Gaussian potential $V(x) = V_0 \\exp(-x^2 / (2\\sigma^2))$ decays rapidly away from $x=0$. We choose a finite computational domain $[-L, L]$ where $L = (\\text{L-factor}) \\cdot \\sigma$. Outside this domain, the potential is assumed to be zero. The choice of $L$ is justified by ensuring $V(\\pm L)$ is negligible. At $x=\\pm L$, the potential is $V(\\pm L) = V_0 \\exp(-L^2/(2\\sigma^2)) = V_0 \\exp(-(\\text{L-factor})^2/2)$. For the smallest given $\\text{L-factor}$ of $6.0$, $V(\\pm L) / V_0 = \\exp(-6^2/2) = \\exp(-18) \\approx 1.5 \\times 10^{-8}$, which is a negligible fraction of the barrier height. Thus, this choice of $L$ is well-justified.\n\nThe interval $[-L, L]$ is discretized into $N$ uniform slices, each of width $\\Delta x = 2L/N$. The interfaces between slices are located at positions $x'_j = -L + j \\Delta x$ for $j = 0, 1, \\dots, N$. The $j$-th slice spans the interval $[x'_{j-1}, x'_j]$. The potential within slice $j$ (for $j=1, \\dots, N$) is approximated by its value at the midpoint $x_j = -L + (j - 1/2)\\Delta x$, yielding a piecewise-constant potential profile $V_j = V(x_j)$.\n\n**2. Local Solution and Wavenumber**\nInside each slice $j$, the potential is constant, $V(x) = V_j$. The Schrödinger equation becomes:\n$$-\\frac{d^2\\psi_j(x)}{dx^2} = (E - V_j)\\psi_j(x)$$\nWe define the square of the local wavenumber as $k_j^2 = E - V_j$. The wavenumber is $k_j = \\sqrt{E - V_j}$. If $E  V_j$ (a classically forbidden region), $k_j$ becomes purely imaginary, $k_j = i\\kappa_j$ where $\\kappa_j = \\sqrt{V_j - E}$. The general solution in slice $j$ is a superposition of a right-going and a left-going plane wave:\n$$\\psi_j(x) = A_j e^{i k_j (x-x'_{j-1})} + B_j e^{-i k_j (x-x'_{j-1})}$$\nwhere $A_j$ and $B_j$ are complex amplitudes.\n\n**3. Derivation of Transfer Matrix for a Single Step**\nThe transfer matrix relates the wave amplitudes on the left of a region to those on the right. A single step in our method consists of propagating through a slice of constant potential $V_j$ and then crossing the interface into the next slice with potential $V_{j+1}$. Let's define the transfer matrix $\\mathbf{T}_j$ for the $j$-th slice, which maps amplitudes from the left of the slice ($x'_{j-1}$) to the right ($x'_j$). At the boundaries, we have $\\psi_j(x'_{j-1})=A_j+B_j$, $\\psi'_j(x'_{j-1}) = ik_j(A_j-B_j)$, and similarly at $x'_j$. By matching boundary conditions, the matrix relating amplitudes $(A, B)$ across the slice is:\n$$ \\begin{pmatrix} A_{j, \\text{out}} \\\\ B_{j, \\text{out}} \\end{pmatrix} = \\mathbf{T}_j \\begin{pmatrix} A_{j, \\text{in}} \\\\ B_{j, \\text{in}} \\end{pmatrix} $$\nThe total transfer matrix from the left lead ($x=-L$) to the right lead ($x=L$) is obtained by multiplying the matrices for each slice:\n$$ \\mathbf{M} = \\mathbf{T}_N \\mathbf{T}_{N-1} \\cdots \\mathbf{T}_1 $$\nwhere $\\mathbf{T}_j$ is the transfer matrix for the $j$-th slice.\n\n**4. Transmission Probability**\nWith the total transfer matrix $\\mathbf{M}$ relating amplitudes in the left lead to amplitudes in the right lead, we apply scattering boundary conditions: an incident wave from the left with unit amplitude ($A_L=1$) and no incident wave from the right ($B_R=0$).\n$$ \\begin{pmatrix} A_R \\\\ 0 \\end{pmatrix} = \\mathbf{M} \\begin{pmatrix} 1 \\\\ B_L \\end{pmatrix} = \\begin{pmatrix} M_{11}  M_{12} \\\\ M_{21}  M_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ B_L \\end{pmatrix} $$\nFrom the second row, $0 = M_{21} + M_{22} B_L$, which gives the reflected amplitude $B_L$. From the first row, $A_R = M_{11} + M_{12} B_L = M_{11} - M_{12} \\frac{M_{21}}{M_{22}} = \\frac{\\det(\\mathbf{M})}{M_{22}}$.\nFor this system, the determinant of the transfer matrix is $\\det(\\mathbf{M})=1$. So, the transmitted amplitude is $A_R = 1/M_{22}$.\n\nThe transmission probability $T(E)$ is the ratio of the transmitted probability current to the incident probability current. Since the potential is the same in the left and right leads, the wavenumbers are equal, and the velocity factor is unity. Thus,\n$$ T(E) = \\frac{k_R |A_R|^2}{k_L |A_L|^2} = \\frac{|A_R|^2}{|1|^2} = \\left| \\frac{1}{M_{22}} \\right|^2 = \\frac{1}{|M_{22}|^2} $$\n\n**5. Numerical Implementation**\nAn adaptive algorithm is implemented. For each test case, we start with $N=N_0$. We calculate $T(E)$. Then we double $N$ and recalculate $T(E)$, continuing until the absolute difference between successive calculations is less than the tolerance $\\varepsilon$, or until $N$ exceeds $N_\\text{max}$. The core calculation for a given $N$ involves building and multiplying the transfer matrices for each slice to get the total matrix $\\mathbf{M}$, from which $T(E)$ is computed. This procedure is implemented in the provided Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    \n    # Test cases: (V0, sigma, E, L_factor, N0, epsilon, N_max)\n    test_cases = [\n        (1.5, 1.0, 0.15, 6.0, 50, 1e-6, 8192),\n        (1.5, 1.0, 1.5, 6.0, 50, 1e-6, 8192),\n        (1.5, 1.0, 7.5, 6.0, 50, 1e-8, 8192),\n        (1.5, 0.2, 0.5, 8.0, 50, 1e-7, 8192),\n    ]\n\n    results = []\n    for params in test_cases:\n        T_final = calculate_transmission_probability(*params)\n        results.append(f\"{T_final:.8f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_transmission_probability(V0, sigma, E, L_factor, N0, epsilon, N_max):\n    \"\"\"\n    Calculates the transmission probability T(E) for a Gaussian barrier using an\n    adaptive transfer-matrix method.\n\n    Args:\n        V0 (float): Barrier height.\n        sigma (float): Barrier width parameter.\n        E (float): Incident electron energy.\n        L_factor (float): Factor to determine computational domain [-L, L] where L = L_factor * sigma.\n        N0 (int): Initial number of discretization slices.\n        epsilon (float): Convergence tolerance for T(E).\n        N_max (int): Maximum number of slices.\n\n    Returns:\n        float: The converged transmission probability T(E).\n    \"\"\"\n\n    N = N0\n    T_prev = -1.0  # Sentinel value\n\n    while N = N_max:\n        L = L_factor * sigma\n        delta_x = 2 * L / N\n\n        x_j = -L + (np.arange(N) + 0.5) * delta_x\n        V_j = V0 * np.exp(-x_j**2 / (2 * sigma**2))\n\n        k_slices = np.sqrt(E - V_j + 0j)\n        k_asymptotic = np.sqrt(E + 0j)\n        \n        # Check for E=0 case where k_asymptotic is 0\n        if np.isclose(k_asymptotic, 0):\n            return 0.0\n\n        # Total transfer matrix, initialized to identity\n        M_total = np.identity(2, dtype=np.complex128)\n\n        # The transfer matrix formalism connects left-side amplitudes to right-side amplitudes.\n        # We start in the left lead and multiply matrices for each slice from left to right.\n        k_left = k_asymptotic\n        for j in range(N):\n            k_right = k_slices[j]\n\n            # Interface matrix from region with k_left to region with k_right\n            I_matrix = 0.5 * np.array([\n                [1 + k_left/k_right, 1 - k_left/k_right],\n                [1 - k_left/k_right, 1 + k_left/k_right]\n            ], dtype=np.complex128)\n            \n            # Propagation matrix through the slice j\n            P_matrix = np.array([\n                [np.exp(1j * k_right * delta_x), 0],\n                [0, np.exp(-1j * k_right * delta_x)]\n            ], dtype=np.complex128)\n            \n            # The matrix for this step is P_j @ I_{j-1 -> j}\n            M_step = P_matrix @ I_matrix\n            M_total = M_step @ M_total\n            \n            k_left = k_right\n        \n        # Final interface matrix from the last slice to the right lead\n        k_right = k_asymptotic\n        I_final = 0.5 * np.array([\n            [1 + k_left/k_right, 1 - k_left/k_right],\n            [1 - k_left/k_right, 1 + k_left/k_right]\n        ], dtype=np.complex128)\n        \n        M_total = I_final @ M_total\n        \n        # Transmission probability T = 1 / |M_11|^2\n        # Here, the matrix M maps (A_R, B_R) = M (A_L, B_L).\n        # With A_L = 1, B_R = 0, we get T = 1/|M_22|^2 for the other convention.\n        # Our convention here: (A_L, B_L) -> (A_R, B_R).\n        # We have A_R = M_11*A_L + M_12*B_L, B_R = M_21*A_L + M_22*B_L.\n        # With A_L=1, B_R=0: 0 = M_21 + M_22*B_L => B_L = -M_21/M_22\n        # A_R = M_11 - M_12*M_21/M_22 = det(M)/M_22. Since det(M)=1, A_R=1/M_22.\n        # So T=1/|M_22|^2. Python indexing is M_total[1, 1].\n        # The python code in the prompt had a different (and more complex) implementation. \n        # A more direct T-matrix composition:\n        \n        k_prev = k_asymptotic\n        M_total = np.identity(2, dtype=np.complex128)\n        for i in range(N):\n            k_curr = k_slices[i]\n            # Matrix to cross interface from k_prev to k_curr\n            I_matrix = 0.5 * np.array([[1 + k_prev / k_curr, 1 - k_prev / k_curr],\n                                       [1 - k_prev / k_curr, 1 + k_prev / k_curr]])\n            M_total = I_matrix @ M_total\n\n            # Matrix to propagate through slice i\n            P_matrix = np.array([[np.exp(1j * k_curr * delta_x), 0],\n                                 [0, np.exp(-1j * k_curr * delta_x)]])\n            M_total = P_matrix @ M_total\n            k_prev = k_curr\n        \n        # Final interface\n        k_curr = k_asymptotic\n        I_matrix = 0.5 * np.array([[1 + k_prev / k_curr, 1 - k_prev / k_curr],\n                                   [1 - k_prev / k_curr, 1 + k_prev / k_curr]])\n        M_total = I_matrix @ M_total\n        \n        # This M_total maps (A_L, B_L) to (A_R, B_R), where A_L is incident from left, B_R from right.\n        # T = 1/|M_total[1,1]|^2\n        T_current = 1.0 / np.abs(M_total[1, 1])**2\n\n        if T_prev >= 0 and np.abs(T_current - T_prev)  epsilon:\n            return T_current\n\n        T_prev = T_current\n        N *= 2\n\n    return T_prev\n\nsolve()\n```"
        },
        {
            "introduction": "A powerful tool is only useful if you understand its limitations. Having implemented the transfer-matrix method, we now confront its critical weakness: numerical instability. This exercise  delves into why this seemingly straightforward method fails catastrophically for thick tunneling barriers, a common scenario in nanoelectronics. Understanding the mathematical origin of this instability—the mixing of growing and decaying evanescent modes—is essential for any practitioner and motivates the development of robust computational techniques.",
            "id": "4310465",
            "problem": "A one-dimensional quantum transport calculation in a nanoscale semiconductor heterostructure uses the effective mass approximation to model a single rectangular barrier of height $V_0$ and width $L$ embedded between semi-infinite contacts. An electron of energy $E$ impinges from the left contact, with $E  V_0$. The time-independent Schrödinger equation for the envelope function $\\psi(x)$ in each region is $-\\frac{\\hbar^2}{2 m^*} \\frac{d^2 \\psi}{dx^2} + V(x) \\psi = E \\psi$, where $m^*$ is the effective mass and $V(x)$ is piecewise constant. Outside the barrier, the solutions are propagating plane waves; inside the barrier, the solutions are superpositions of evanescent modes that decay or grow as functions of $x$. The standard transfer-matrix method builds a matrix that maps boundary amplitudes on the left to boundary amplitudes on the right by multiplying interface and propagation blocks; the scattering-matrix method maps incoming amplitudes to outgoing amplitudes and composes layers via the Redheffer star product (also known as the Redheffer product).\n\nConsider a barrier in an emerging semiconductor material with effective mass $m^* = 0.2 \\, m_e$ and barrier excess $V_0 - E = 0.25 \\, \\text{eV}$, where $m_e$ is the electron rest mass. For the purposes of numerical analysis, recall that double-precision floating point has a machine epsilon of order $10^{-16}$ and a maximum finite magnitude of order $\\exp(709)$. Let $\\kappa$ denote the evanescent decay rate inside the barrier, defined by the imaginary wavevector that solves the Schrödinger equation in the barrier region when $E  V_0$. The physical transmission probability is computed from the ratio of outgoing to incoming fluxes.\n\nSelect all statements that are correct about numerical instability in the transfer-matrix approach for large $L$, and stabilization strategies:\n\nA. For $E  V_0$, the presence of both decaying and growing evanescent solutions inside the barrier causes elements of the transfer matrix to scale like $e^{\\pm \\kappa L}$; the condition number of the barrier transfer matrix grows approximately as $e^{2 \\kappa L}$ for large $L$, which can cause severe loss of numerical accuracy or overflow in double precision.\n\nB. The scattering-matrix formulation, which directly relates incoming to outgoing flux-normalized amplitudes and composes layers via the Redheffer star product, tends to be numerically stable because, in the absence of absorption, reflection and transmission amplitudes remain bounded (e.g., $|r| \\leq 1$, $|t| \\leq 1$), avoiding the exponential growth seen in transfer-matrix entries.\n\nC. Applying orthogonal-triangular factorization (QR factorization) after each layer to reorthonormalize the basis spanning the decaying subspace and to separate growing from decaying components yields a stable recursion for reflection and transmission, because it prevents the accumulation of exponentially ill-conditioned vectors.\n\nD. Increasing the barrier thickness $L$ reduces numerical instability in the transfer-matrix approach for $E  V_0$, because the evanescent modes become negligible and the transfer matrix approaches the identity, improving conditioning.\n\nE. Switching from double precision to single precision arithmetic reduces rounding errors and therefore stabilizes transfer-matrix calculations for thick barriers.\n\nChoose all correct options.",
            "solution": "The problem asks to identify correct statements regarding the numerical instability of the transfer-matrix method (TMM) for thick tunneling barriers. Let's analyze each option based on the principles of quantum mechanics and numerical analysis.\n\nInside a potential barrier where the electron energy $E$ is less than the barrier height $V_0$, the Schrödinger equation solution is a superposition of a decaying evanescent wave, $e^{-\\kappa x}$, and a growing evanescent wave, $e^{\\kappa x}$. The TMM works by propagating the coefficients of these waves (or equivalently, the wavefunction and its derivative) across the barrier.\n\n**A. For $E  V_0$, the presence of both decaying and growing evanescent solutions inside the barrier causes elements of the transfer matrix to scale like $e^{\\pm \\kappa L}$; the condition number of the barrier transfer matrix grows approximately as $e^{2 \\kappa L}$ for large $L$, which can cause severe loss of numerical accuracy or overflow in double precision.**\nThis statement is correct. The propagation matrix for the barrier contains terms like $\\cosh(\\kappa L)$ and $\\sinh(\\kappa L)$, both of which grow as $\\frac{1}{2} e^{\\kappa L}$ for large barrier width $L$. The eigenvalues of this matrix are $e^{\\kappa L}$ and $e^{-\\kappa L}$. The condition number, which measures the amplification of numerical errors, is the ratio of the largest to the smallest singular value, and it scales with the ratio of the eigenvalues, i.e., $e^{\\kappa L}/e^{-\\kappa L} = e^{2\\kappa L}$. This exponential growth means that for a thick barrier, any tiny rounding error in the coefficient of the growing wave is amplified, completely swamping the physically important information carried by the decaying wave. This leads to a catastrophic loss of precision and potential overflow.\n\n**B. The scattering-matrix formulation, which directly relates incoming to outgoing flux-normalized amplitudes and composes layers via the Redheffer star product, tends to be numerically stable because, in the absence of absorption, reflection and transmission amplitudes remain bounded (e.g., $|r| \\leq 1$, $|t| \\leq 1$), avoiding the exponential growth seen in transfer-matrix entries.**\nThis statement is correct. The scattering-matrix (S-matrix) method works with reflection and transmission amplitudes, which are physically bounded quantities (by definition, their squared magnitudes are probabilities or ratios of fluxes, which cannot exceed 1 in a passive system). When combining layers using the Redheffer star product, the resulting S-matrix for the entire structure also has bounded elements. This formulation inherently avoids manipulating the exponentially growing terms that plague the TMM, making it numerically stable even for very thick barriers.\n\n**C. Applying orthogonal-triangular factorization (QR factorization) after each layer to reorthonormalize the basis spanning the decaying subspace and to separate growing from decaying components yields a stable recursion for reflection and transmission, because it prevents the accumulation of exponentially ill-conditioned vectors.**\nThis statement is correct. This describes a well-known stabilization technique for the TMM. The core issue is that when propagating two solution vectors through the barrier, they both tend to align with the fastest-growing exponential mode, becoming numerically collinear. Applying QR factorization at each step separates the propagated vectors into an orthonormal basis (the Q matrix) and an upper-triangular matrix (the R matrix) that absorbs the exponential growth. By propagating the well-conditioned Q matrix, the linear independence of the solutions is maintained, preventing the loss of information about the decaying mode. This is a standard and effective way to stabilize the TMM.\n\n**D. Increasing the barrier thickness $L$ reduces numerical instability in the transfer-matrix approach for $E  V_0$, because the evanescent modes become negligible and the transfer matrix approaches the identity, improving conditioning.**\nThis statement is incorrect. It makes the opposite claim. As explained in A, increasing $L$ *exacerbates* the numerical instability by making the condition number exponentially larger. The transfer matrix only approaches the identity for $L \\to 0$.\n\n**E. Switching from double precision to single precision arithmetic reduces rounding errors and therefore stabilizes transfer-matrix calculations for thick barriers.**\nThis statement is incorrect. Single precision has a much larger machine epsilon (lower precision) than double precision. This means rounding errors are inherently larger. In an ill-conditioned problem where errors are amplified exponentially, using lower precision will cause the calculation to fail much sooner. Stability requires higher, not lower, precision.\n\nTherefore, statements A, B, and C are correct.",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}