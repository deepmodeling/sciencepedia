{
    "hands_on_practices": [
        {
            "introduction": "本练习是理解拉什巴效应核心物理图像的基石。通过直接计算自旋期望值，您将揭示电子的自旋如何被“锁定”到其动量上，从而在动量空间中形成独特的涡旋状自旋纹理 ()。这是将抽象的自旋轨道耦合概念形象化的关键一步。",
            "id": "4303853",
            "problem": "考虑一个限制在半导体量子阱 $x$–$y$ 平面内的二维电子气 (2DEG)，该量子阱沿 $z$ 轴方向具有结构反演不对称性。包含强度为 $\\alpha_{R} > 0$ 的 Rashba 自旋轨道耦合的低能单粒子哈密顿量为\n$$\nH = \\frac{\\hbar^{2} k^{2}}{2 m^{\\ast}} \\mathbb{I}_{2} + \\alpha_{R} \\left( \\sigma_{x} k_{y} - \\sigma_{y} k_{x} \\right),\n$$\n其中 $\\boldsymbol{k} = (k_{x}, k_{y})$ 是晶格动量，$k = |\\boldsymbol{k}|$，$\\mathbb{I}_{2}$ 是 $2 \\times 2$ 单位矩阵，$\\boldsymbol{\\sigma} = (\\sigma_{x}, \\sigma_{y}, \\sigma_{z})$ 是泡利矩阵。对于一个固定 $k$ 值的平面波本征态，通过 $k_{x} = k \\cos \\varphi_{k}$ 和 $k_{y} = k \\sin \\varphi_{k}$ 定义极角 $\\varphi_{k}$。从上述哈密顿量和对于归一化旋量 $\\psi$ 的期望值定义 $\\langle \\sigma_{i} \\rangle = \\psi^{\\dagger} \\sigma_{i} \\psi$ 出发，推导 Rashba 项的归一化旋量本征态，并计算两个自旋分裂的 Rashba 分支各自的自旋期望矢量 $\\langle \\boldsymbol{\\sigma} \\rangle$。将 $\\langle \\boldsymbol{\\sigma} \\rangle$ 的最终答案明确地表示为 $\\varphi_{k}$ 的函数，并描述由此产生的面内自旋织构与动量方向 $\\boldsymbol{k}$ 的相对关系。最终答案必须是 $\\langle \\boldsymbol{\\sigma} \\rangle$ 关于 $\\varphi_{k}$ 的一个单一闭合形式解析表达式。",
            "solution": "问题陈述经核实具有科学依据、提法得当、客观且完整。它提出了一个凝聚态物理中的标准问题，涉及二维电子气 (2DEG) 中 Rashba 自旋轨道耦合的效应。\n\n二维电子气的单粒子哈密顿量由下式给出\n$$\nH = \\frac{\\hbar^{2} k^{2}}{2 m^{\\ast}} \\mathbb{I}_{2} + \\alpha_{R} \\left( \\sigma_{x} k_{y} - \\sigma_{y} k_{x} \\right)\n$$\n其中第一项是动能，$H_{kin} = \\frac{\\hbar^{2} k^{2}}{2 m^{\\ast}} \\mathbb{I}_{2}$，第二项是 Rashba 自旋轨道耦合哈密顿量，$H_{R} = \\alpha_{R} \\left( \\sigma_{x} k_{y} - \\sigma_{y} k_{x} \\right)$。此处，$\\hbar$ 是约化普朗克常数，$m^{\\ast}$ 是电子有效质量，$\\boldsymbol{k} = (k_{x}, k_{y})$ 是面内波矢，其大小为 $k = |\\boldsymbol{k}|$，$\\alpha_{R}$ 是 Rashba 耦合强度，$\\mathbb{I}_{2}$ 是 $2 \\times 2$ 单位矩阵，$\\sigma_{x,y,z}$ 是泡利矩阵。\n\n由于动能项与单位矩阵成正比，它与 Rashba 项对易，即 $[H_{kin}, H_{R}] = 0$。因此，$H$ 和 $H_{R}$ 共享一套共同的本征态。为了找到这些本征态，我们可以将 Rashba 项 $H_{R}$ 对角化。\n\n首先，我们使用泡利矩阵的标准表示法将 $H_{R}$ 写成矩阵形式：\n$$\n\\sigma_{x} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}, \\quad \\sigma_{y} = \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}\n$$\n将这些代入 $H_{R}$ 的表达式中：\n$$\nH_{R} = \\alpha_{R} \\left( k_{y} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} - k_{x} \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix} \\right) = \\alpha_{R} \\begin{pmatrix} 0  k_{y} + i k_{x} \\\\ k_{y} - i k_{x}  0 \\end{pmatrix}\n$$\n使用波矢的极坐标表示，$k_{x} = k \\cos \\varphi_{k}$ 和 $k_{y} = k \\sin \\varphi_{k}$，我们可以简化非对角项：\n$$\nk_{y} - i k_{x} = k(\\sin \\varphi_{k} - i \\cos \\varphi_{k}) = -ik(\\cos \\varphi_{k} + i \\sin \\varphi_{k}) = -ik e^{i \\varphi_{k}}\n$$\n$$\nk_{y} + i k_{x} = k(\\sin \\varphi_{k} + i \\cos \\varphi_{k}) = ik(\\cos \\varphi_{k} - i \\sin \\varphi_{k}) = ik e^{-i \\varphi_{k}}\n$$\n因此，Rashba 哈密顿量变为：\n$$\nH_{R} = \\alpha_{R} k \\begin{pmatrix} 0  i e^{-i \\varphi_{k}} \\\\ -i e^{i \\varphi_{k}}  0 \\end{pmatrix}\n$$\n为了求出 $H_{R}$ 的本征值 $\\lambda_{R}$，我们求解特征方程 $\\det(H_{R} - \\lambda_{R} \\mathbb{I}_{2}) = 0$：\n$$\n\\det \\begin{pmatrix} -\\lambda_{R}  i \\alpha_{R} k e^{-i \\varphi_{k}} \\\\ -i \\alpha_{R} k e^{i \\varphi_{k}}  -\\lambda_{R} \\end{pmatrix} = \\lambda_{R}^{2} - (i \\alpha_{R} k e^{-i \\varphi_{k}})(-i \\alpha_{R} k e^{i \\varphi_{k}}) = \\lambda_{R}^{2} - (\\alpha_{R} k)^{2} = 0\n$$\n$H_R$ 的本征值为 $\\lambda_{R, \\pm} = \\pm \\alpha_{R} k$。这对应于两个能量分支（在 $k$ 空间中能量发生平移的抛物线），被称为自旋分裂的 Rashba 能带，其总能量为 $E_{\\pm}(k) = \\frac{\\hbar^{2} k^{2}}{2 m^{\\ast}} \\pm \\alpha_{R} k$。\n\n接下来，我们求解相应的归一化旋量本征态 $\\psi_{\\pm}$。设一个一般旋量为 $\\psi = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$。本征值方程为 $H_{R} \\psi_{\\pm} = \\lambda_{R, \\pm} \\psi_{\\pm}$。\n$$\n\\alpha_{R} k \\begin{pmatrix} 0  i e^{-i \\varphi_{k}} \\\\ -i e^{i \\varphi_{k}}  0 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\pm \\alpha_{R} k \\begin{pmatrix} a \\\\ b \\end{pmatrix}\n$$\n这得到方程组：\n$i b e^{-i \\varphi_{k}} = \\pm a$ 和 $-i a e^{i \\varphi_{k}} = \\pm b$。\n从第一个方程，我们得到关系 $b = \\mp i a e^{i \\varphi_{k}}$。\n\n对于上分支 ($+$)，其本征值为 $\\lambda_{R,+} = +\\alpha_{R}k$，我们有 $b = -i a e^{i \\varphi_{k}}$。本征态与 $\\begin{pmatrix} 1 \\\\ -i e^{i \\varphi_{k}} \\end{pmatrix}$ 成正比。将此旋量归一化：\n$|a|^{2}(1 + |-i e^{i \\varphi_{k}}|^{2}) = 1 \\implies 2|a|^{2}=1 \\implies |a| = 1/\\sqrt{2}$。为 $a$ 选择一个实相位，我们得到：\n$$\n\\psi_{+} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -i e^{i \\varphi_{k}} \\end{pmatrix}\n$$\n对于下分支 ($-$)，其本征值为 $\\lambda_{R,-} = -\\alpha_{R}k$，我们有 $b = +i a e^{i \\varphi_{k}}$。本征态与 $\\begin{pmatrix} 1 \\\\ i e^{i \\varphi_{k}} \\end{pmatrix}$ 成正比。归一化后得到：\n$$\n\\psi_{-} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ i e^{i \\varphi_{k}} \\end{pmatrix}\n$$\n现在我们对每个分支计算自旋期望矢量 $\\langle \\boldsymbol{\\sigma} \\rangle = (\\langle \\sigma_{x} \\rangle, \\langle \\sigma_{y} \\rangle, \\langle \\sigma_{z} \\rangle)$，使用公式 $\\langle \\sigma_{i} \\rangle = \\psi^{\\dagger} \\sigma_{i} \\psi$。\n\n对于上分支 ($+$)，$\\psi_{+}^{\\dagger} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  i e^{-i \\varphi_{k}} \\end{pmatrix}$。\n$$\n\\langle \\sigma_{x} \\rangle_{+} = \\frac{1}{2}\\begin{pmatrix} 1  i e^{-i \\varphi_{k}} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -i e^{i \\varphi_{k}} \\end{pmatrix} = \\frac{1}{2}(i e^{-i \\varphi_{k}} - i e^{i \\varphi_{k}}) = \\frac{-i^{2}}{2i}(e^{i \\varphi_{k}} - e^{-i \\varphi_{k}}) = \\sin \\varphi_{k}\n$$\n$$\n\\langle \\sigma_{y} \\rangle_{+} = \\frac{1}{2}\\begin{pmatrix} 1  i e^{-i \\varphi_{k}} \\end{pmatrix} \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -i e^{i \\varphi_{k}} \\end{pmatrix} = \\frac{1}{2}(-e^{i \\varphi_{k}} - e^{-i \\varphi_{k}}) = -\\cos \\varphi_{k}\n$$\n$$\n\\langle \\sigma_{z} \\rangle_{+} = \\frac{1}{2}\\begin{pmatrix} 1  i e^{-i \\varphi_{k}} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -i e^{i \\varphi_{k}} \\end{pmatrix} = \\frac{1}{2}(1 - 1) = 0\n$$\n因此，对于上分支，$\\langle \\boldsymbol{\\sigma} \\rangle_{+} = (\\sin \\varphi_{k}, -\\cos \\varphi_{k}, 0)$。\n\n对于下分支 ($-$)，$\\psi_{-}^{\\dagger} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -i e^{-i \\varphi_{k}} \\end{pmatrix}$。计算过程类似：\n$$\n\\langle \\sigma_{x} \\rangle_{-} = \\frac{1}{2}\\begin{pmatrix} 1  -i e^{-i \\varphi_{k}} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ i e^{i \\varphi_{k}} \\end{pmatrix} = \\frac{1}{2}(-i e^{-i \\varphi_{k}} + i e^{i \\varphi_{k}}) = -\\sin \\varphi_{k}\n$$\n$$\n\\langle \\sigma_{y} \\rangle_{-} = \\frac{1}{2}\\begin{pmatrix} 1  -i e^{-i \\varphi_{k}} \\end{pmatrix} \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ i e^{i \\varphi_{k}} \\end{pmatrix} = \\frac{1}{2}(e^{i \\varphi_{k}} + e^{-i \\varphi_{k}}) = \\cos \\varphi_{k}\n$$\n$$\n\\langle \\sigma_{z} \\rangle_{-} = \\frac{1}{2}\\begin{pmatrix} 1  -i e^{-i \\varphi_{k}} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ i e^{i \\varphi_{k}} \\end{pmatrix} = \\frac{1}{2}(1 - 1) = 0\n$$\n因此，对于下分支，$\\langle \\boldsymbol{\\sigma} \\rangle_{-} = (-\\sin \\varphi_{k}, \\cos \\varphi_{k}, 0) = -\\langle \\boldsymbol{\\sigma} \\rangle_{+}$。\n\n两个分支（上分支 $\\eta = +1$，下分支 $\\eta = -1$）的自旋期望矢量的组合表达式为：\n$$\n\\langle \\boldsymbol{\\sigma} \\rangle_{\\eta} = \\eta(\\sin \\varphi_{k}, -\\cos \\varphi_{k}, 0)\n$$\n为了描述自旋织构，我们将自旋方向与动量方向进行比较。动量方向由单位矢量 $\\hat{\\boldsymbol{k}} = (\\cos \\varphi_{k}, \\sin \\varphi_{k})$ 给出。面内自旋期望矢量为 $\\langle \\boldsymbol{\\sigma}_{\\parallel} \\rangle_{\\eta} = \\eta(\\sin \\varphi_{k}, -\\cos \\varphi_{k})$。\n我们来计算点积：\n$$\n\\hat{\\boldsymbol{k}} \\cdot \\langle \\boldsymbol{\\sigma}_{\\parallel} \\rangle_{\\eta} = \\eta(\\cos \\varphi_{k} \\sin \\varphi_{k} - \\sin \\varphi_{k} \\cos \\varphi_{k}) = 0\n$$\n这表明对于任意给定的动量 $\\boldsymbol{k}$，自旋被锁定在 $x$–$y$ 平面内，并且始终垂直于动量矢量。\n对于上分支 ($\\eta=+1$)，自旋矢量 $(\\sin \\varphi_{k}, -\\cos \\varphi_{k})$ 是将动量方向矢量 $(\\cos \\varphi_{k}, \\sin \\varphi_{k})$ 顺时针旋转 $\\pi/2$ 角度得到的。对于下分支 ($\\eta=-1$)，自旋方向相反，对应于将动量方向逆时针旋转 $\\pi/2$。这导致了 $k$ 空间中的一种涡旋状自旋织构，其中自旋围绕原点 $k=0$ 缠绕，对于外层（上）费米圆是顺时针方向，对于内层（下）费米圆是逆时针方向。\n\n最终答案是两个分支的自旋期望矢量的组合表达式。我们用 $\\pm$ 符号表示这两个分支。\n$$\n\\langle \\boldsymbol{\\sigma} \\rangle_{\\pm} = (\\pm\\sin \\varphi_{k}, \\mp\\cos \\varphi_{k}, 0)\n$$\n该表达式概括了上（$x$ 分量为 $+$ 号）和下（$x$ 分量为 $-$ 号）Rashba 分裂能带的结果。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\pm \\sin(\\varphi_k)  \\mp \\cos(\\varphi_k)  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实的材料中往往同时存在拉什巴和德雷斯尔豪斯效应。本练习旨在探索它们之间的相互作用，通过分析两者强度相等（即 $\\alpha = \\beta$）时的情形，您会发现沿特定方向传播的电子其自旋分裂会完全消失 ()。这种现象源于两种效应产生的等效磁场之间的相消干涉，对设计自旋电子学器件具有重要意义。",
            "id": "3774136",
            "problem": "一个限制在沿晶体学 $[001]$ 轴生长的闪锌矿半导体量子阱中的二维电子气 (2DEG)，表现出由结构反演不对称性和体反演不对称性引起的自旋轨道相互作用。在有效质量近似下，自旋轨道相互作用由一个依赖于面内动量的 $2 \\times 2$ 哈密顿量描述，该哈密顿量作用于自旋，由泡利矩阵和波矢分量构建而成。考虑一个固定的面内波矢，其大小为 $k$，相对于 $[100]$ 轴的极角为 $\\phi$，因此其分量满足 $k_{x} = k \\cos \\phi$ 和 $k_{y} = k \\sin \\phi$。假设与线性项相比，三次方的 Dresselhaus 项可以忽略不计，并且 Rashba 和线性 Dresselhaus 耦合强度相等且为正，即 $\\alpha = \\beta > 0$。\n\n从适用于 $[001]$ 2DEG 的 Rashba 和线性 Dresselhaus 自旋轨道哈密顿量的标准形式出发，推导使两个自旋分辨支之间的自旋分裂 $\\Delta E(\\phi)$ 消失的角度 $\\phi$ 所满足的条件。确定区间 $[0, 2\\pi)$ 内所有使 $\\Delta E(\\phi) = 0$ 的角度 $\\phi$，并用弧度表示最终角度。然后，根据与结构反演不对称性和体反演不对称性相关的有效自旋轨道场之间的相消干涉，解释这些特殊方向的物理意义。\n\n你的最终答案必须是 $[0, 2\\pi)$ 区间内的角度列表，以弧度表示。无需四舍五入。",
            "solution": "该问题要求在 Rashba 和线性 Dresselhaus 耦合强度相等的条件下，找出二维电子气 (2DEG) 中电子运动的特定方向，在这些方向上由自旋轨道相互作用引起的自旋分裂消失。\n\n首先，我们建立理论框架。该系统是一个限制在沿 $[001]$ 方向生长的闪锌矿量子阱中的 2DEG。电子的面内波矢表示为 $\\mathbf{k} = (k_x, k_y)$，其分量为 $k_x = k \\cos \\phi$ 和 $k_y = k \\sin \\phi$，其中 $k = |\\mathbf{k}|$，$\\phi$ 是相对于 $[100]$ 轴的角度。\n\n自旋轨道相互作用哈密顿量 $H_{SO}$ 是由结构反演不对称性 (SIA) 引起的 Rashba 项 $H_R$ 和由体反演不对称性 (BIA) 引起的线性 Dresselhaus 项 $H_D$ 之和。对于沿 $[001]$ 方向生长的 2DEG，它们由以下公式给出：\n$$ H_R = \\alpha (\\sigma_x k_y - \\sigma_y k_x) $$\n$$ H_D = \\beta (\\sigma_x k_x - \\sigma_y k_y) $$\n其中 $\\alpha$ 和 $\\beta$ 分别是 Rashba 和 Dresselhaus 耦合系数，$\\sigma_x, \\sigma_y$ 是泡利自旋矩阵。\n\n总的自旋轨道哈密顿量是 $H_{SO} = H_R + H_D$ 的和：\n$$ H_{SO} = \\alpha (\\sigma_x k_y - \\sigma_y k_x) + \\beta (\\sigma_x k_x - \\sigma_y k_y) $$\n我们可以按泡利矩阵对各项进行分组：\n$$ H_{SO} = (\\alpha k_y + \\beta k_x) \\sigma_x - (\\alpha k_x + \\beta k_y) \\sigma_y $$\n该哈密顿量可以表示为一个有效的自旋轨道磁场矢量 $\\mathbf{\\Omega}_{SO}$ 与泡利矩阵矢量 $\\mathbf{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 的点积：\n$$ H_{SO} = \\mathbf{\\Omega}_{SO} \\cdot \\mathbf{\\sigma} $$\n其中有效场的分量为：\n$$ \\Omega_x = \\alpha k_y + \\beta k_x $$\n$$ \\Omega_y = -(\\alpha k_x + \\beta k_y) $$\n$$ \\Omega_z = 0 $$\n电子的总哈密顿量为 $H = \\frac{\\hbar^2 k^2}{2m^*}I + H_{SO}$，其中第一项是动能（$I$ 是 $2 \\times 2$ 单位矩阵，$m^*$ 是有效质量）。$H_{SO}$ 的本征值为 $\\pm |\\mathbf{\\Omega}_{SO}|$，其中 $|\\mathbf{\\Omega}_{SO}| = \\sqrt{\\Omega_x^2 + \\Omega_y^2}$。因此，总哈密顿量 $H$ 的本征值为：\n$$ E_{\\pm}(\\mathbf{k}) = \\frac{\\hbar^2 k^2}{2m^*} \\pm |\\mathbf{\\Omega}_{SO}| $$\n自旋分裂 $\\Delta E$ 是这两个自旋分辨支之间的能量差：\n$$ \\Delta E(\\mathbf{k}) = E_+(\\mathbf{k}) - E_-(\\mathbf{k}) = 2 |\\mathbf{\\Omega}_{SO}| = 2 \\sqrt{(\\alpha k_y + \\beta k_x)^2 + (-(\\alpha k_x + \\beta k_y))^2} $$\n\n问题要求我们找到自旋分裂消失的条件，即 $\\Delta E(\\phi) = 0$。这种情况发生当且仅当有效自旋轨道场的模为零，即 $|\\mathbf{\\Omega}_{SO}| = 0$。这要求其两个分量 $\\Omega_x$ 和 $\\Omega_y$ 同时为零：\n1. $\\alpha k_y + \\beta k_x = 0$\n2. $-(\\alpha k_x + \\beta k_y) = 0$\n这两个方程是线性相关的。我们使用问题陈述中给出的特定条件：$\\alpha = \\beta > 0$。将此代入第一个方程得到：\n$$ \\alpha k_y + \\alpha k_x = 0 $$\n因为 $\\alpha > 0$，我们可以除以 $\\alpha$ 得到中心条件：\n$$ k_x + k_y = 0 $$\n现在，我们用极角 $\\phi$ 来表示这个条件。使用定义 $k_x = k \\cos \\phi$ 和 $k_y = k \\sin \\phi$，我们得到：\n$$ k \\cos \\phi + k \\sin \\phi = 0 $$\n对于运动的电子，波矢的模 $k$ 是非零的（$k \\neq 0$），所以我们可以除以 $k$：\n$$ \\cos \\phi + \\sin \\phi = 0 $$\n$$ \\sin \\phi = -\\cos \\phi $$\n我们可以除以 $\\cos \\phi$，因为 $\\cos \\phi = 0$（这意味着 $\\phi = \\frac{\\pi}{2}$ 或 $\\phi = \\frac{3\\pi}{2}$）不满足该方程（因为 $\\sin \\phi$ 将是 $\\pm 1$，而不是 $0$）。这得到：\n$$ \\tan \\phi = -1 $$\n我们需要在区间 $[0, 2\\pi)$ 中找到 $\\phi$ 的所有解。正切函数在第二和第四象限等于 $-1$。$\\arctan(-1)$ 的主值是 $-\\frac{\\pi}{4}$。通解是 $\\phi = -\\frac{\\pi}{4} + n\\pi$，其中 $n$ 是任意整数。\n当 $n=1$ 时，我们找到在第二象限的解：\n$$ \\phi_1 = -\\frac{\\pi}{4} + \\pi = \\frac{3\\pi}{4} $$\n当 $n=2$ 时，我们找到在第四象限的解：\n$$ \\phi_2 = -\\frac{\\pi}{4} + 2\\pi = \\frac{7\\pi}{4} $$\n这些是在指定区间 $[0, 2\\pi)$ 内的唯二解。\n\n这一结果的物理解释是，当与 Rashba 和 Dresselhaus 效应相关的有效磁场发生相消干涉并完全抵消时，自旋分裂消失。总有效场 $\\mathbf{\\Omega}_{SO}$ 是 Rashba 场 $\\mathbf{\\Omega}_R = \\alpha(k_y, -k_x, 0)$ 和 Dresselhaus 场 $\\mathbf{\\Omega}_D = \\beta(k_x, -k_y, 0)$ 的矢量和。条件 $\\Delta E = 0$ 等价于 $\\mathbf{\\Omega}_{SO} = \\mathbf{\\Omega}_R + \\mathbf{\\Omega}_D = \\mathbf{0}$，这意味着 $\\mathbf{\\Omega}_R = -\\mathbf{\\Omega}_D$。\n给定 $\\alpha=\\beta$，这个矢量等式变为：\n$$ \\alpha(k_y, -k_x, 0) = -\\alpha(k_x, -k_y, 0) $$\n$$ \\alpha(k_y, -k_x, 0) = \\alpha(-k_x, k_y, 0) $$\n使分量相等得到 $k_y = -k_x$，这正是我们推导出的条件。因此，对于沿方向 $\\phi = \\frac{3\\pi}{4}$（晶体学方向 $[\\bar{1}10]$）和 $\\phi = \\frac{7\\pi}{4}$（晶体学方向 $[1\\bar{1}0]$）的电子动量矢量，来自结构反演不对称性（Rashba）和体反演不对称性（Dresselhaus）的有效场大小相等、方向相反，导致净有效场为零，因此没有自旋分裂。对于这些特定的传播方向，两个自旋态保持简并。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3\\pi}{4}  \\frac{7\\pi}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "连续谱模型为我们提供了深刻的物理直觉，但现代材料研究更多地依赖于格点模型。这项计算实践旨在搭建从连续谱到格点模型的桥梁 ()。您将亲手构建包含拉什巴效应的紧束缚模型，并用数值方法计算其能带结构和自旋性质，从而获得计算凝聚态物理研究中的核心实践技能。",
            "id": "4303839",
            "problem": "考虑一个二维方格子上的无相互作用自旋-$\\tfrac{1}{2}$电子系统，该系统由一个紧束缚哈密顿量描述。此哈密顿量包含一个自旋无关的最近邻跃迁振幅 $t$，以及一个由结构反演不对称引起的最近邻Rashba自旋轨道耦合。在格点费米子算符 $c_{i,s}$ 的基下进行计算，其中 $i$ 是格点索引，$s \\in \\{\\uparrow,\\downarrow\\}$ 是自旋索引。使用以下经过充分检验的基本出发点：\n\n- 最近邻跃迁的二次量子化紧束缚形式，泡利矩阵 $\\sigma_x$、$\\sigma_y$ 和 $\\sigma_z$ 的定义与性质，以及自旋-$1/2$ 的单位矩阵 $I_2$。\n- 离散平移不变性以及实空间格点算符与动量空间算符之间的傅里叶变换关系 $c_{i,s} = \\tfrac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}_i} c_{\\mathbf{k},s}$，其中 $N$ 是格点总数。\n- 由结构反演不对称引起的Rashba机制，它将自旋与晶格动量耦合起来，使得产生的自旋相关跃迁在波矢下是奇函数，并且满足时间反演对称性。\n\n你的任务是：\n\n1. 从上述基本要素出发，推导方格子上具有自旋无关跃迁振幅 $t$ 和Rashba自旋轨道耦合振幅 $t_R$ （仅限于最近邻）的动量空间布洛赫哈密顿量 $H(\\mathbf{k})$。在旋量基 $(c_{\\mathbf{k},\\uparrow}, c_{\\mathbf{k},\\downarrow})$ 中表示 $H(\\mathbf{k})$，并证明它可以写成通用的 $2 \\times 2$ 形式 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2 + \\mathbf{g}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中 $\\boldsymbol{\\sigma} = (\\sigma_x,\\sigma_y,\\sigma_z)$，而 $\\mathbf{g}(\\mathbf{k}) = (g_x(\\mathbf{k}), g_y(\\mathbf{k}), g_z(\\mathbf{k}))$ 由Rashba跃迁结构决定。请明确说明 $\\mathbf{g}(\\mathbf{k})$ 中关于 $\\mathbf{k}$ 的奇函数分量是如何从最近邻自旋相关跃迁的傅里叶变换中产生的。\n\n2. 使用推导出的 $H(\\mathbf{k})$，设计一个数值计算程序来计算：\n   - 沿方格子第一布里渊区中的标准高对称路径 $\\Gamma \\rightarrow X \\rightarrow M \\rightarrow \\Gamma$ 的能带结构，其中 $\\Gamma = (0,0)$，$X = (\\pi,0)$，$M = (\\pi,\\pi)$。在 $\\mathbf{k}$ 空间中，对每段路径使用相同数量的点进行采样，以形成一条折线。每段路径使用 $128$ 个点，总共采样 $384$ 个 $\\mathbf{k}$ 值（包括端点），并将所有量视为无量纲。\n   - 对每个采样的 $\\mathbf{k}$，计算两个能带的能量 $E_-(\\mathbf{k})$ 和 $E_+(\\mathbf{k})$，并确定较低的能带 $E_-(\\mathbf{k})$。\n   - 对每个 $\\mathbf{k}$ 处的较低能带本征态，计算自旋期望值 $\\langle \\sigma_x \\rangle$、$\\langle \\sigma_y \\rangle$ 和 $\\langle \\sigma_z \\rangle$。如果在某个采样点 $\\mathbf{k}$ 处自旋分裂消失（即由于 $\\mathbf{g}(\\mathbf{k}) = \\mathbf{0}$ 导致简并），则将自旋期望值定义为零矢量，以避免因简并点处旋量基的任意性而产生的歧义。\n\n3. 对每组参数 $(t, t_R)$，定义并计算沿该路径的以下三个标量汇总指标：\n   - 沿路径的最大能带分裂，$\\Delta_{\\max} = \\max_{\\mathbf{k}} \\left[ E_+(\\mathbf{k}) - E_-(\\mathbf{k}) \\right]$。\n   - 一种自旋-动量锁定关联，定义为 $C(\\mathbf{k}) = \\hat{\\mathbf{s}}_-(\\mathbf{k}) \\cdot \\left( \\hat{\\mathbf{z}} \\times \\hat{\\mathbf{k}} \\right)$ 沿路径的平均值。其中 $\\hat{\\mathbf{s}}_-(\\mathbf{k})$ 是在 $\\mathbf{k}$ 点处较低能带自旋期望值的单位矢量（当自旋分裂消失时使用零矢量），$\\hat{\\mathbf{z}}$ 是垂直于格点平面的单位矢量，$\\hat{\\mathbf{k}} = \\mathbf{k}/\\lVert \\mathbf{k} \\rVert$ 是 $\\mathbf{k}$ 方向的单位矢量。在计算平均值时，排除 $\\mathbf{k} = \\mathbf{0}$ 或将其贡献视为零。将所有采样点的平均值报告为单个浮点数。\n   - 沿路径的较低能带的平均自旋大小，$S_{\\mathrm{avg}} = \\frac{1}{N_{\\mathrm{samples}}} \\sum_{\\mathbf{k}} \\lVert \\langle \\boldsymbol{\\sigma} \\rangle_-(\\mathbf{k}) \\rVert$，在简并点处使用上述约定。\n\n4. 在单个程序中实现你的推导和数值计算过程，为以下测试套件中的每组参数计算第3项中的指标：\n   - $(t, t_R) = (1.0, 0.0)$，无Rashba耦合的边界情况。\n   - $(t, t_R) = (1.0, 0.2)$，代表性的正Rashba耦合。\n   - $(t, t_R) = (1.0, -0.2)$，代表性的负Rashba耦合。\n\n所有量都是无量纲的，不需要物理单位。波矢使用弧度单位。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。对每组参数，按 $\\Delta_{\\max}$、平均自旋-动量锁定关联和平均自旋大小的顺序列出三个浮点数，并将这三组三元组合并成一个扁平列表。例如，输出格式应为 $[\\Delta_{\\max}^{(1)},C^{(1)},S_{\\mathrm{avg}}^{(1)},\\Delta_{\\max}^{(2)},C^{(2)},S_{\\mathrm{avg}}^{(2)},\\Delta_{\\max}^{(3)},C^{(3)},S_{\\mathrm{avg}}^{(3)}]$。",
            "solution": "用户提供的问题已经过分析和验证。这是一个来自凝聚态物理领域的、定义明确、有科学依据且客观的问题。该问题没有任何验证清单中所列的缺陷。因此，下面提供一个完整的解决方案。\n\n### 1. 布洛赫哈密顿量的推导\n\n对于二维方格子上具有最近邻相互作用的无相互作用电子，其总哈密顿量 $H$可以写成一个自旋无关的跃迁项 $H_t$ 和一个Rashba自旋轨道耦合项 $H_R$ 的和：\n$$H = H_t + H_R$$\n我们将通过对每一项进行离散傅里叶变换来推导动量空间表示，即布洛赫哈密顿量 $H(\\mathbf{k})$。我们在旋量基 $\\mathbf{c}_i^\\dagger = (c_{i,\\uparrow}^\\dagger, c_{i,\\downarrow}^\\dagger)$ 中进行计算，其中 $i$ 是格点索引。为简单起见，设晶格常数 $a=1$。\n\n**自旋无关跃迁 ($H_t$)**\n\n自旋无关的最近邻跃迁由以下公式描述：\n$$H_t = -t \\sum_{\\langle i,j \\rangle, s} (c_{i,s}^\\dagger c_{j,s} + \\text{h.c.})$$\n其中 $t$ 是跃迁振幅，$\\langle i,j \\rangle$ 表示对所有最近邻对求和，$s \\in \\{\\uparrow, \\downarrow\\}$ 是自旋索引。在旋量基中，这可以写成：\n$$H_t = -t \\sum_{\\langle i,j \\rangle} \\mathbf{c}_i^\\dagger I_2 \\mathbf{c}_j$$\n其中 $I_2$ 是自旋空间中的 $2 \\times 2$ 单位矩阵。\n格点 $i$ 的位置是 $\\mathbf{r}_i$，其最近邻位于 $\\mathbf{r}_i + \\boldsymbol{\\delta}$，其中 $\\boldsymbol{\\delta} \\in \\{\\pm \\hat{x}, \\pm \\hat{y}\\}$。我们可以将哈密顿量写成对格点 $i$ 和位移 $\\boldsymbol{\\delta}$ 的求和：\n$$H_t = -t \\sum_{i, \\boldsymbol{\\delta}} \\mathbf{c}_i^\\dagger I_2 \\mathbf{c}_{i+\\boldsymbol{\\delta}}$$\n我们使用傅里叶变换 $c_{i,s} = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}_i} c_{\\mathbf{k},s}$，这意味着 $\\mathbf{c}_i = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}_i} \\mathbf{c}_{\\mathbf{k}}$。将此代入 $H_t$ 的表达式，并使用恒等式 $\\frac{1}{N} \\sum_i e^{i(\\mathbf{k}-\\mathbf{k}')\\cdot\\mathbf{r}_i} = \\delta_{\\mathbf{k},\\mathbf{k}'}$，可得：\n$$H_t = \\sum_{\\mathbf{k}} \\mathbf{c}_{\\mathbf{k}}^\\dagger \\left( -t \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}} \\right) I_2 \\, \\mathbf{c}_{\\mathbf{k}}$$\n对于方格子，对最近邻矢量的求和为：\n$$\\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}} = e^{ik_x} + e^{-ik_x} + e^{ik_y} + e^{-ik_y} = 2(\\cos k_x + \\cos k_y)$$\n因此，跃迁项的动量空间表示为 $H_t(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2$，其中色散关系为：\n$$\\varepsilon(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)$$\n\n**Rashba自旋轨道耦合 ($H_R$)**\n\nRashba自旋轨道耦合源于结构反演不对称，并表现为一种自旋相关的跃迁相互作用。对于从格点 $j$ 到格点 $i$ 的一次跃迁，其相互作用正比于 $i t_R (\\boldsymbol{\\sigma} \\times \\hat{\\mathbf{d}}_{ij}) \\cdot \\hat{\\mathbf{z}}$，其中 $\\hat{\\mathbf{d}}_{ij}$ 是从格点 $i$ 到格点 $j$ 的单位矢量，$\\hat{\\mathbf{z}}$ 是垂直于二维平面的单位矢量。完整的最近邻Rashba哈密顿量为：\n$$H_R = i t_R \\sum_{\\langle i,j \\rangle} \\mathbf{c}_i^\\dagger (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{d}}_{ij})) \\mathbf{c}_j$$\n我们来分析每个近邻方向 $\\boldsymbol{\\delta} = \\hat{\\mathbf{d}}_{ij}$ 的跃迁矩阵：\n- 对于 $\\boldsymbol{\\delta} = \\hat{x}$：矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times \\hat{x})) = i t_R (\\boldsymbol{\\sigma} \\cdot \\hat{y}) = i t_R \\sigma_y$。\n- 对于 $\\boldsymbol{\\delta} = -\\hat{x}$：矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times (-\\hat{x}))) = -i t_R \\sigma_y$。\n- 对于 $\\boldsymbol{\\delta} = \\hat{y}$：矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times \\hat{y})) = i t_R (\\boldsymbol{\\sigma} \\cdot (-\\hat{x})) = -i t_R \\sigma_x$。\n- 对于 $\\boldsymbol{\\delta} = -\\hat{y}$：矩阵为 $i t_R (\\boldsymbol{\\sigma} \\cdot (\\hat{\\mathbf{z}} \\times (-\\hat{y}))) = i t_R \\sigma_x$。\n\n总的实空间哈密顿量可以写成 $H = \\sum_{i, \\boldsymbol{\\delta}} \\mathbf{c}_i^\\dagger T_{\\boldsymbol{\\delta}} \\mathbf{c}_{i+\\boldsymbol{\\delta}}$，其中 $T_{\\boldsymbol{\\delta}}$ 是对应位移 $\\boldsymbol{\\delta}$ 的总跃迁矩阵。布洛赫哈密顿量是其傅里叶变换 $H(\\mathbf{k}) = \\sum_{\\boldsymbol{\\delta}} T_{\\boldsymbol{\\delta}} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}}$。\n$H(\\mathbf{k}) = T_{\\hat{x}} e^{ik_x} + T_{-\\hat{x}} e^{-ik_x} + T_{\\hat{y}} e^{ik_y} + T_{-\\hat{y}} e^{-ik_y}$\n其中 $T_{\\boldsymbol{\\delta}} = -t I_2 + H_{R, \\boldsymbol{\\delta}}$，$H_{R, \\boldsymbol{\\delta}}$ 是Rashba部分。\n$$H(\\mathbf{k}) = (-t I_2 + i t_R \\sigma_y)e^{ik_x} + (-t I_2 - i t_R \\sigma_y)e^{-ik_x} + (-t I_2 - i t_R \\sigma_x)e^{ik_y} + (-t I_2 + i t_R \\sigma_x)e^{-ik_y}$$\n合并各项：\n$$H(\\mathbf{k}) = -t(e^{ik_x} + e^{-ik_x} + e^{ik_y} + e^{-ik_y})I_2 + i t_R \\sigma_x (e^{-ik_y} - e^{ik_y}) + i t_R \\sigma_y (e^{ik_x} - e^{-ik_x})$$\n使用欧拉公式 $e^{i\\theta}-e^{-i\\theta} = 2i\\sin\\theta$：\n$$H(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)I_2 + i t_R \\sigma_x (-2i \\sin k_y) + i t_R \\sigma_y (2i \\sin k_x)$$\n$$H(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)I_2 + 2t_R \\sin(k_y) \\sigma_x - 2t_R \\sin(k_x) \\sigma_y$$\n这正是所要求的形式 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2 + \\mathbf{g}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中：\n- 自旋无关色散关系：$\\varepsilon(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y)$\n- 自旋轨道耦合矢量：$\\mathbf{g}(\\mathbf{k}) = (g_x(\\mathbf{k}), g_y(\\mathbf{k}), g_z(\\mathbf{k}))$\n  - $g_x(\\mathbf{k}) = 2t_R \\sin(k_y)$\n  - $g_y(\\mathbf{k}) = -2t_R \\sin(k_x)$\n  - $g_z(\\mathbf{k}) = 0$\n\n$\\mathbf{g}(\\mathbf{k})$ 矢量分量的 $\\mathbf{k}$-奇函数特性源于最近邻自旋相关跃迁项的傅里叶变换。来自相反方向跃迁的相位因子 $e^{i k_x}$ 和 $e^{-i k_x}$ 组合形成 $\\sin(k_x)$，这是一个奇函数。这反映了自旋轨道相互作用必须在动量反演下为奇函数以保持时间反演对称性的要求。\n\n### 2. 数值计算过程和指标\n\n**能带结构和本征态**\n哈密顿量 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) I_2 + \\mathbf{g}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$ 的本征值由下式给出：\n$$E_{\\pm}(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\pm |\\mathbf{g}(\\mathbf{k})|$$\n其中 $|\\mathbf{g}(\\mathbf{k})| = \\sqrt{g_x(\\mathbf{k})^2 + g_y(\\mathbf{k})^2 + g_z(\\mathbf{k})^2} = \\sqrt{(2t_R \\sin k_y)^2 + (-2t_R \\sin k_x)^2} = 2|t_R|\\sqrt{\\sin^2 k_x + \\sin^2 k_y}$。两个能带分别是 $E_+(\\mathbf{k})$（上能带）和 $E_-(\\mathbf{k})$（下能带）。\n\n$H(\\mathbf{k})$ 的本征矢量是与矢量 $\\mathbf{g}(\\mathbf{k})$ 平行或反平行的旋量。对于一个本征态 $|\\psi\\rangle$，其自旋期望值为 $\\langle \\boldsymbol{\\sigma} \\rangle = \\langle \\psi | \\boldsymbol{\\sigma} | \\psi \\rangle$。对于对应于 $E_-(\\mathbf{k})$ 的下能带本征态，其自旋与 $\\mathbf{g}(\\mathbf{k})$ 反平行：\n$$\\langle \\boldsymbol{\\sigma} \\rangle_- (\\mathbf{k}) = -\\frac{\\mathbf{g}(\\mathbf{k})}{|\\mathbf{g}(\\mathbf{k})|}$$\n这是一个单位矢量，因此当 $|\\mathbf{g}(\\mathbf{k})| \\neq 0$ 时，其大小为 $\\lVert \\langle \\boldsymbol{\\sigma} \\rangle_- (\\mathbf{k}) \\rVert = 1$。当自旋分裂消失时，即 $|\\mathbf{g}(\\mathbf{k})| = 0$，能带是简并的，自旋基是任意的。根据问题陈述，我们在这些简并点将自旋期望值定义为零矢量：$\\langle \\boldsymbol{\\sigma} \\rangle_-(\\mathbf{k}) = \\mathbf{0}$。当 $k_x$ 和 $k_y$ 是 $\\pi$ 的整数倍时会发生简并，这包括高对称点 $\\Gamma=(0,0)$、$X=(\\pi,0)$ 和 $M=(\\pi,\\pi)$。\n\n**路径和指标**\n数值计算过程涉及沿路径 $\\Gamma \\rightarrow X \\rightarrow M \\rightarrow \\Gamma$ 对布里渊区进行采样。\n- 第1段：从 $\\Gamma=(0,0)$ 到 $X=(\\pi,0)$。\n- 第2段：从 $X=(\\pi,0)$ 到 $M=(\\pi,\\pi)$。\n- 第3段：从 $M=(\\pi,\\pi)$ 到 $\\Gamma=(0,0)$。\n每段路径采样 $128$ 个点，总计 $384$ 个点。对每个采样的 $\\mathbf{k}$ 点，我们计算本征值和下能带的自旋期望矢量。基于这些结果，我们计算三个汇总指标：\n\n1.  **最大能带分裂 ($\\Delta_{\\max}$):** 分裂值为 $\\Delta(\\mathbf{k}) = E_+(\\mathbf{k}) - E_-(\\mathbf{k}) = 2|\\mathbf{g}(\\mathbf{k})|$。我们对路径上所有的点 $\\mathbf{k}$ 计算该值，并找出其最大值。\n$$ \\Delta_{\\max} = \\max_{\\mathbf{k} \\text{ on path}} \\left[ 4|t_R|\\sqrt{\\sin^2 k_x + \\sin^2 k_y} \\right] $$\n\n2.  **自旋-动量锁定关联 ($C_{\\mathrm{avg}}$):** 该指标量化了自旋织构与动量方向的对齐程度。对每个点 $\\mathbf{k}$，我们计算 $C(\\mathbf{k}) = \\hat{\\mathbf{s}}_-(\\mathbf{k}) \\cdot (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{k}})$，其中 $\\hat{\\mathbf{s}}_-(\\mathbf{k})$ 是下能带自旋期望值的单位矢量，$\\hat{\\mathbf{z}}=(0,0,1)$，$\\hat{\\mathbf{k}} = \\mathbf{k}/\\lVert \\mathbf{k} \\rVert$。如果 $|\\mathbf{g}(\\mathbf{k})|=0$ (简并) 或 $\\mathbf{k}=\\mathbf{0}$，其对平均值的贡献取为零。最终指标是所有 $384$ 个采样点的平均值。\n\n3.  **平均自旋大小 ($S_{\\mathrm{avg}}$):** 这是沿路径的下能带自旋期望值大小的平均值。\n$$ S_{\\mathrm{avg}} = \\frac{1}{N_{\\mathrm{samples}}} \\sum_{\\mathbf{k}} \\lVert \\langle \\boldsymbol{\\sigma} \\rangle_-(\\mathbf{k}) \\rVert $$\n由于在非简并点处 $\\lVert \\langle \\boldsymbol{\\sigma} \\rangle_- \\rVert$ 为 $1$，在简并点处为 $0$，该指标实际上测量了路径上采样的非简并点的比例。\n\n所提供的Python代码为给定的测试用例实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes summary metrics for a tight-binding model with Rashba\n    spin-orbit coupling on a 2D square lattice.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.0),   # No Rashba coupling\n        (1.0, 0.2),   # Positive Rashba coupling\n        (1.0, -0.2),  # Negative Rashba coupling\n    ]\n\n    all_results = []\n    \n    # K-path definition\n    N_POINTS_PER_SEGMENT = 128\n    GAMMA = np.array([0.0, 0.0])\n    X = np.array([np.pi, 0.0])\n    M = np.array([np.pi, np.pi])\n\n    path_G_X = np.linspace(GAMMA, X, N_POINTS_PER_SEGMENT, endpoint=True)\n    path_X_M = np.linspace(X, M, N_POINTS_PER_SEGMENT, endpoint=True)\n    path_M_G = np.linspace(M, GAMMA, N_POINTS_PER_SEGMENT, endpoint=True)\n    \n    # The full path contains 3 * 128 = 384 k-points\n    k_path = np.vstack([path_G_X, path_X_M, path_M_G])\n    \n    # Numerical tolerance for checking if a value is zero\n    TOL = 1e-12\n\n    for t, tR in test_cases:\n        \n        path_band_splittings = []\n        path_spin_locking_correlations = []\n        path_spin_magnitudes = []\n\n        for k in k_path:\n            kx, ky = k\n            \n            # g-vector components\n            g_x = 2.0 * tR * np.sin(ky)\n            g_y = -2.0 * tR * np.sin(kx)\n            g_vec = np.array([g_x, g_y, 0.0])\n            g_norm = np.linalg.norm(g_vec)\n\n            # Metric 1: Band Splitting\n            band_splitting = 2.0 * g_norm\n            path_band_splittings.append(band_splitting)\n\n            # Lower-band spin expectation vector\n            if g_norm  TOL:\n                # Degenerate case\n                spin_vec_minus = np.array([0.0, 0.0, 0.0])\n            else:\n                # Non-degenerate case\n                spin_vec_minus = -g_vec / g_norm\n            \n            # Metric 3: Spin Magnitude\n            spin_mag = np.linalg.norm(spin_vec_minus)\n            path_spin_magnitudes.append(spin_mag)\n                \n            # Metric 2: Spin-Momentum Locking Correlation C(k)\n            k_norm = np.linalg.norm(k)\n            \n            # C(k) is zero at degenerate points (g_norm ~ 0) or at k=0 (k_norm ~ 0)\n            if g_norm  TOL or k_norm  TOL:\n                C_k = 0.0\n            else:\n                s_hat_minus = spin_vec_minus # Already normalized\n                k_hat = k / k_norm\n                \n                # In 2D, z_hat x k_hat = (-k_hat_y, k_hat_x, 0)\n                z_cross_k_hat = np.array([-k_hat[1], k_hat[0], 0.0])\n                \n                C_k = np.dot(s_hat_minus, z_cross_k_hat)\n            \n            path_spin_locking_correlations.append(C_k)\n\n        # Calculate final metrics for the current test case\n        max_band_splitting = np.max(path_band_splittings)\n        avg_spin_locking = np.mean(path_spin_locking_correlations)\n        avg_spin_magnitude = np.mean(path_spin_magnitudes)\n        \n        all_results.extend([max_band_splitting, avg_spin_locking, avg_spin_magnitude])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}