{
    "hands_on_practices": [
        {
            "introduction": "理解随机电报噪声 (RTN) 的一个核心技能，是能够将其时间域特性（如捕获和发射时间）与频域中的可测量特征联系起来。本练习将指导您从基本原理出发，推导单个缺陷引起的双态 RTN 的功率谱密度 (PSD) 。通过这个过程，您将掌握 RTN 独特的洛伦兹谱线形状，并理解其低频平台和高频 $1/f^2$ 滚降如何由载流子动力学决定。",
            "id": "3769556",
            "problem": "一个纳米级金属-氧化物-半导体场效应晶体管在固定的栅极和漏极偏置条件下工作，使得单个氧化物/界面缺陷间歇性地俘获和释放一个载流子，从而使沟道电流在两个能级之间调制。由此产生的电流涨落是一个平稳、各态历经的双态连续时间马尔可夫过程，通常称为随机电报噪声 (RTN)。设平均俘获时间为 $\\tau_{c}$，平均发射时间为 $\\tau_{e}$，因此跃迁速率分别为 $\\lambda_{c}=1/\\tau_{c}$ 和 $\\lambda_{e}=1/\\tau_{e}$。电流在两个相差 $2A$ 的能级之间跳变，因此，围绕平均值的涨落可以建模为 $\\delta I(t)\\in\\{+A,-A\\}$。\n\n从双态马尔可夫过程的定义、此类过程的指数自相关性以及作为自相关函数傅里叶变换的单边电流功率谱密度 (PSD) $S_{I}(f)$ 出发，推导出 $S_{I}(f)$ 关于 $A$、$\\lambda_{c}$ 和 $\\lambda_{e}$ 的解析表达式。将转角频率 $f_{c}$ 定义为 $S_{I}(f)$ 等于其低频平台值 $S_{I}(0)$ 一半时的频率，并用 $\\lambda_{c}$ 和 $\\lambda_{e}$ 表示 $f_{c}$。然后，对于给定的 $\\tau_{c}=10\\,\\mathrm{ms}$，$\\tau_{e}=5\\,\\mathrm{ms}$ 和 $2A=100\\,\\mathrm{nA}$，计算 $f_{c}$ 和在 $f=10\\,\\mathrm{Hz}$ 时的 $S_{I}(f)$ 值。在此过程中，请从您推导的表达式中明确展示低频平台和高频 $1/f^{2}$ 滚降。将转角频率以 $\\mathrm{Hz}$ 为单位表示，功率谱密度以 $\\mathrm{A}^{2}/\\mathrm{Hz}$ 为单位表示。将您的数值结果四舍五入到三位有效数字。",
            "solution": "用户要求我解决以下问题：\n“一个纳米级金属-氧化物-半导体场效应晶体管在固定的栅极和漏极偏置条件下工作，使得单个氧化物/界面缺陷间歇性地俘获和释放一个载流子，从而使沟道电流在两个能级之间调制。由此产生的电流涨落是一个平稳、各态历经的双态连续时间马尔可夫过程，通常称为随机电报噪声 (RTN)。设平均俘获时间为 $\\tau_{c}$，平均发射时间为 $\\tau_{e}$，因此跃迁速率分别为 $\\lambda_{c}=1/\\tau_{c}$ 和 $\\lambda_{e}=1/\\tau_{e}$。电流在两个相差 $2A$ 的能级之间跳变，因此，围绕平均值的涨落可以建模为 $\\delta I(t)\\in\\{+A,-A\\}$。\n\n从双态马尔可夫过程的定义、此类过程的指数自相关性以及作为自相关函数傅里叶变换的单边电流功率谱密度 (PSD) $S_{I}(f)$ 出发，推导出 $S_{I}(f)$ 关于 $A$、$\\lambda_{c}$ 和 $\\lambda_{e}$ 的解析表达式。将转角频率 $f_{c}$ 定义为 $S_{I}(f)$ 等于其低频平台值 $S_{I}(0)$ 一半时的频率，并用 $\\lambda_{c}$ 和 $\\lambda_{e}$ 表示 $f_{c}$。然后，对于给定的 $\\tau_{c}=10\\,\\mathrm{ms}$，$\\tau_{e}=5\\,\\mathrm{ms}$ 和 $2A=100\\,\\mathrm{nA}$，计算 $f_{c}$ 和在 $f=10\\,\\mathrm{Hz}$ 时的 $S_{I}(f)$ 值。在此过程中，请从您推导的表达式中明确展示低频平台和高频 $1/f^{2}$ 滚降。将转角频率以 $\\mathrm{Hz}$ 为单位表示，功率谱密度以 $\\mathrm{A}^{2}/\\mathrm{Hz}$ 为单位表示。将您的数值结果四舍五入到三位有效数字。”\n\n### 第 1 步：提取已知条件\n- 该过程是一个平稳、各态历经的双态连续时间马尔可夫过程（随机电报噪声）。\n- 平均俘获时间：$\\tau_c$。\n- 平均发射时间：$\\tau_e$。\n- 俘获的跃迁速率：$\\lambda_c = 1/\\tau_c$。\n- 发射的跃迁速率：$\\lambda_e = 1/\\tau_e$。\n- 电流在两个相差 $2A$ 的能级之间跳变。\n- 围绕平均值的涨落建模为 $\\delta I(t) \\in \\{+A, -A\\}$。\n- 问题要求用 $A$、$\\lambda_c$、$\\lambda_e$ 推导单边功率谱密度 $S_I(f)$。\n- 问题要求推导转角频率 $f_c$，其中 $S_I(f_c) = S_I(0)/2$。\n- 问题要求展示低频平台和高频 $1/f^2$ 滚降。\n- 用于计算的数值：$\\tau_c = 10\\,\\mathrm{ms}$，$\\tau_e = 5\\,\\mathrm{ms}$， $2A = 100\\,\\mathrm{nA}$。\n- 需要计算 $f_c$ 和在 $f = 10\\,\\mathrm{Hz}$ 时的 $S_I(f)$。\n- 数值结果必须四舍五入到三位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了半导体器件中单个陷阱引起的随机电报噪声 (RTN) 的标准模型。这是固态物理和电子器件工程领域一个成熟的课题。该模型基于随机过程理论（特别是双态马尔可夫链）及其在电子噪声中的应用，具有科学合理性。\n- **适定性**：该问题提供了推导所要求量的所有必要信息。平均时间、跃迁速率、电平以及功率谱密度之间的关系定义明确。同时要求解析推导和数值计算，这一点也很清晰。\n- **客观性**：该问题以精确的量化术语陈述。在“围绕平均值的涨落可以建模为 $\\delta I(t)\\in\\{+A,-A\\}$”的陈述中存在一个微小的歧义。对于 $\\tau_c \\neq \\tau_e$ 的一般情况，该过程是非对称的，围绕平均值的涨落幅度不等于 $\\pm A$。然而，核心物理参数是总电流阶跃高度 $\\Delta I$，明确给出为 $2A$。如下所示，最终的功率谱密度 (PSD) 仅取决于此阶跃高度 $\\Delta I$ 和跃迁速率，而与绝对电平或它们是否以平均值为中心无关。因此，这种不精确性不妨碍得到唯一且正确的解。该问题可以被形式化并严格求解。\n- **所有其他验证标准均已满足**：该问题不是比喻性的、不完整的、矛盾的或琐碎的。\n\n### 第 3 步：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n物理过程是一个双态系统。设状态为状态 0（低电流，陷阱被占据）和状态 1（高电流，陷阱为空）。从状态 1 到状态 0 的跃迁速率是俘获速率，$\\lambda_c = 1/\\tau_c$。从状态 0 到状态 1 的跃迁速率是发射速率，$\\lambda_e = 1/\\tau_e$。\n\n对于平稳过程，处于状态 0 和状态 1 的概率 $P_0$ 和 $P_1$ 是恒定的。它们由平衡方程 $\\lambda_c P_1 = \\lambda_e P_0$ 以及归一化条件 $P_0 + P_1 = 1$ 确定。\n求解该方程组可得稳态概率：\n$$ P_0 = \\frac{\\lambda_c}{\\lambda_c + \\lambda_e} $$\n$$ P_1 = \\frac{\\lambda_e}{\\lambda_c + \\lambda_e} $$\n\n设两个状态的电流分别为 $I_0$ 和 $I_1$。问题陈述能级相差 $2A$，因此我们定义电流阶跃高度为 $\\Delta I = |I_1 - I_0| = 2A$。我们感兴趣的信号是电流围绕其平均值 $\\langle I \\rangle$ 的涨落 $\\delta I(t)$。\n平均电流为 $\\langle I \\rangle = I_0 P_0 + I_1 P_1$。\n涨落信号为 $\\delta I(t) = I(t) - \\langle I \\rangle$。\n在状态 0，涨落为 $\\delta I_0 = I_0 - \\langle I \\rangle = I_0 - (I_0 P_0 + I_1 P_1) = I_0(1-P_0) - I_1 P_1 = I_0 P_1 - I_1 P_1 = -(I_1-I_0)P_1 = -\\Delta I P_1$。\n在状态 1，涨落为 $\\delta I_1 = I_1 - \\langle I \\rangle = I_1 - (I_0 P_0 + I_1 P_1) = I_1(1-P_1) - I_0 P_0 = I_1 P_0 - I_0 P_0 = (I_1-I_0)P_0 = \\Delta I P_0$。\n注意，平均涨落为 $\\langle \\delta I \\rangle = \\delta I_0 P_0 + \\delta I_1 P_1 = (-\\Delta I P_1)P_0 + (\\Delta I P_0)P_1 = 0$，符合预期。\n\n对于双态马尔可夫过程，涨落的自相关函数 $R_{\\delta I}(\\tau) = \\langle \\delta I(t) \\delta I(t+\\tau) \\rangle$ 已知为指数衰减：\n$$ R_{\\delta I}(\\tau) = \\sigma_{\\delta I}^{2} \\exp\\left(-\\frac{|\\tau|}{\\tau_{eff}}\\right) $$\n其中 $\\sigma_{\\delta I}^{2}$ 是涨落的方差，$\\tau_{eff}$ 是相关衰减的有效时间常数。\n方差为 $\\sigma_{\\delta I}^{2} = \\langle (\\delta I)^2 \\rangle = (\\delta I_0)^2 P_0 + (\\delta I_1)^2 P_1$。\n$$ \\sigma_{\\delta I}^{2} = (-\\Delta I P_1)^2 P_0 + (\\Delta I P_0)^2 P_1 = (\\Delta I)^2 (P_1^2 P_0 + P_0^2 P_1) = (\\Delta I)^2 P_0 P_1 (P_0+P_1) = (\\Delta I)^2 P_0 P_1 $$\n代入 $P_0$ 和 $P_1$ 的表达式：\n$$ \\sigma_{\\delta I}^{2} = (\\Delta I)^2 \\frac{\\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^2} $$\n有效时间常数 $\\tau_{eff}$ 由跃迁速率之和给出：\n$$ \\tau_{eff} = \\frac{1}{\\lambda_c + \\lambda_e} $$\n代入 $\\Delta I = 2A$，自相关函数为：\n$$ R_{\\delta I}(\\tau) = (2A)^2 \\frac{\\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^2} \\exp(-(\\lambda_c + \\lambda_e)|\\tau|) = \\frac{4A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^2} \\exp(-(\\lambda_c + \\lambda_e)|\\tau|) $$\n\n单边功率谱密度 (PSD) $S_I(f)$ 由维纳-辛钦定理给出，对于 $f \\ge 0$，其值为自相关函数傅里叶变换的两倍。更常见的表达式为：\n$$ S_I(f) = 4 \\int_{0}^{\\infty} R_{\\delta I}(\\tau) \\cos(2\\pi f \\tau) d\\tau $$\n代入 $R_{\\delta I}(\\tau)$ 的表达式：\n$$ S_I(f) = 4 \\left( \\frac{4A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^2} \\right) \\int_{0}^{\\infty} \\exp(-(\\lambda_c + \\lambda_e)\\tau) \\cos(2\\pi f \\tau) d\\tau $$\n该积分为一个标准的拉普拉斯变换结果：$\\int_0^\\infty e^{-s t} \\cos(\\omega t) dt = \\frac{s}{s^2+\\omega^2}$。\n这里，$s = \\lambda_c + \\lambda_e$ 且 $\\omega = 2\\pi f$。\n$$ \\int_{0}^{\\infty} \\exp(-(\\lambda_c + \\lambda_e)\\tau) \\cos(2\\pi f \\tau) d\\tau = \\frac{\\lambda_c + \\lambda_e}{(\\lambda_c + \\lambda_e)^2 + (2\\pi f)^2} $$\n因此，功率谱密度为：\n$$ S_I(f) = \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^2} \\frac{\\lambda_c + \\lambda_e}{(\\lambda_c + \\lambda_e)^2 + (2\\pi f)^2} $$\n$$ S_I(f) = \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e) \\left[ (\\lambda_c + \\lambda_e)^2 + (2\\pi f)^2 \\right]} $$\n这是单边功率谱密度的解析表达式，呈洛伦兹形式。\n\n接下来，我们求转角频率 $f_c$。首先，通过在 $S_I(f)$ 表达式中令 $f=0$ 来确定低频平台 $S_I(0)$：\n$$ S_I(0) = \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e) [(\\lambda_c + \\lambda_e)^2 + 0]} = \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^3} $$\n转角频率 $f_c$ 定义为 $S_I(f_c) = S_I(0)/2$。\n$$ \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e) \\left[ (\\lambda_c + \\lambda_e)^2 + (2\\pi f_c)^2 \\right]} = \\frac{1}{2} \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^3} $$\n消去公因子：\n$$ \\frac{1}{(\\lambda_c + \\lambda_e)^2 + (2\\pi f_c)^2} = \\frac{1}{2(\\lambda_c + \\lambda_e)^2} $$\n$$ 2(\\lambda_c + \\lambda_e)^2 = (\\lambda_c + \\lambda_e)^2 + (2\\pi f_c)^2 $$\n$$ (\\lambda_c + \\lambda_e)^2 = (2\\pi f_c)^2 $$\n由于 $f_c$ 和速率均为正值，我们取正根：\n$$ 2\\pi f_c = \\lambda_c + \\lambda_e \\implies f_c = \\frac{\\lambda_c + \\lambda_e}{2\\pi} $$\n\n现在我们可以用 $S_I(0)$ 和 $f_c$ 来表示功率谱密度：\n$$ S_I(f) = \\frac{S_I(0)(\\lambda_c + \\lambda_e)^2}{(\\lambda_c + \\lambda_e)^2 + (2\\pi f)^2} = S_I(0) \\frac{(2\\pi f_c)^2}{(2\\pi f_c)^2 + (2\\pi f)^2} = S_I(0) \\frac{1}{1 + (f/f_c)^2} $$\n这种形式清楚地展示了在不同频率范围内的行为。\n- **低频平台**：对于 $f \\ll f_c$，项 $(f/f_c)^2 \\to 0$，因此 $S_I(f) \\approx S_I(0)$，为一个常数。\n- **高频滚降**：对于 $f \\gg f_c$，项 $(f/f_c)^2 \\gg 1$，因此 $S_I(f) \\approx S_I(0) \\frac{1}{(f/f_c)^2} = S_I(0) \\frac{f_c^2}{f^2}$。这表明在高频下，功率谱密度与 $1/f^2$ 成正比。\n\n最后，我们计算数值。\n已知：\n$\\tau_c = 10\\,\\mathrm{ms} = 1 \\times 10^{-2}\\,\\mathrm{s}$\n$\\tau_e = 5\\,\\mathrm{ms} = 5 \\times 10^{-3}\\,\\mathrm{s}$\n$2A = 100\\,\\mathrm{nA} = 1 \\times 10^{-7}\\,\\mathrm{A} \\implies A = 5 \\times 10^{-8}\\,\\mathrm{A}$\n\n首先，计算跃迁速率：\n$\\lambda_c = 1/\\tau_c = 1/(1 \\times 10^{-2}\\,\\mathrm{s}) = 100\\,\\mathrm{s}^{-1}$\n$\\lambda_e = 1/\\tau_e = 1/(5 \\times 10^{-3}\\,\\mathrm{s}) = 200\\,\\mathrm{s}^{-1}$\n\n接下来，计算转角频率 $f_c$：\n$$ f_c = \\frac{\\lambda_c + \\lambda_e}{2\\pi} = \\frac{100\\,\\mathrm{s}^{-1} + 200\\,\\mathrm{s}^{-1}}{2\\pi} = \\frac{300}{2\\pi}\\,\\mathrm{Hz} \\approx 47.746\\,\\mathrm{Hz} $$\n四舍五入到三位有效数字，$f_c = 47.7\\,\\mathrm{Hz}$。\n\n现在，我们计算在 $f=10\\,\\mathrm{Hz}$ 时的功率谱密度值。我们首先计算低频平台值 $S_I(0)$：\n$$ S_I(0) = \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e)^3} = \\frac{16(5 \\times 10^{-8}\\,\\mathrm{A})^2 (100\\,\\mathrm{s}^{-1})(200\\,\\mathrm{s}^{-1})}{(100\\,\\mathrm{s}^{-1} + 200\\,\\mathrm{s}^{-1})^3} $$\n$$ S_I(0) = \\frac{16(25 \\times 10^{-16}\\,\\mathrm{A}^2) (2 \\times 10^4\\,\\mathrm{s}^{-2})}{(300\\,\\mathrm{s}^{-1})^3} = \\frac{8000 \\times 10^{-16}\\,\\mathrm{A}^2\\cdot\\mathrm{s}^{-2}}{27 \\times 10^6\\,\\mathrm{s}^{-3}} = \\frac{8 \\times 10^{-13}}{2.7 \\times 10^7}\\,\\mathrm{A}^2 \\cdot \\mathrm{s} $$\n$$ S_I(0) = \\frac{8}{27} \\times 10^{-16}\\,\\mathrm{A}^2/\\mathrm{Hz} \\approx 2.96296 \\times 10^{-17}\\,\\mathrm{A}^2/\\mathrm{Hz} $$\n现在我们使用洛伦兹形式来求 $S_I(10\\,\\mathrm{Hz})$：\n$$ S_I(10\\,\\mathrm{Hz}) = S_I(0) \\frac{1}{1 + (10\\,\\mathrm{Hz}/f_c)^2} = (2.96296 \\times 10^{-17}) \\frac{1}{1 + (10 / 47.746)^2} $$\n$$ S_I(10\\,\\mathrm{Hz}) \\approx (2.96296 \\times 10^{-17}) \\frac{1}{1 + (0.20944)^2} \\approx (2.96296 \\times 10^{-17}) \\frac{1}{1 + 0.043865} $$\n$$ S_I(10\\,\\mathrm{Hz}) \\approx \\frac{2.96296 \\times 10^{-17}}{1.043865} \\approx 2.8384 \\times 10^{-17}\\,\\mathrm{A}^2/\\mathrm{Hz} $$\n四舍五入到三位有效数字，$S_I(10\\,\\mathrm{Hz}) = 2.84 \\times 10^{-17}\\,\\mathrm{A}^2/\\mathrm{Hz}$。\n\n结果总结：\n- $S_I(f)$ 的推导表达式：$S_I(f) = \\frac{16A^2 \\lambda_c \\lambda_e}{(\\lambda_c + \\lambda_e) [(\\lambda_c + \\lambda_e)^2 + (2\\pi f)^2]}$。\n- 推导的转角频率：$f_c = \\frac{\\lambda_c + \\lambda_e}{2\\pi}$。\n- 计算的转角频率：$f_c \\approx 47.7\\,\\mathrm{Hz}$。\n- 在 $10\\,\\mathrm{Hz}$ 处计算的功率谱密度：$S_I(10\\,\\mathrm{Hz}) \\approx 2.84 \\times 10^{-17}\\,\\mathrm{A}^2/\\mathrm{Hz}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 47.7  2.84 \\times 10^{-17} \\end{pmatrix} } $$"
        },
        {
            "introduction": "理论模型只有在能够解释和预测真实器件行为时才具有价值。本练习将 RTN 的随机过程模型与纳米级场效应晶体管 (FET) 的半导体物理学联系起来 。您将探索栅极电压如何通过调制沟道中的载流子浓度来直接影响缺陷的捕获速率，从而改变 RTN 的开关不对称性。",
            "id": "4297478",
            "problem": "一个位于顶栅二硫化钼（$\\mathrm{MoS_2}$）场效应晶体管界面的双态缺陷会产生随机电报噪声（RTN）。该缺陷以速率 $c_n$ 俘获导带电子，并以速率 $e_n$ 发射它们，导致在低电流（陷阱填充）和高电流（陷阱空置）状态之间的随机切换。考虑一个物理厚度为 $t_{\\mathrm{ch}}$ 的单层 MoS$_2$ 沟道，其上方是厚度为 $t_{\\mathrm{ox}}$、相对介电常数为 $\\kappa_{\\mathrm{ox}}$ 的高$\\kappa$值二氧化铪（HfO$_2$）栅极氧化层。单位面积的栅极氧化层电容为 $C_{\\mathrm{ox}} = \\varepsilon_{\\mathrm{ox}}/t_{\\mathrm{ox}}$，其中 $\\varepsilon_{\\mathrm{ox}} = \\kappa_{\\mathrm{ox}} \\varepsilon_0$。假设处于强反型状态，因此当栅源电压 $V_{GS}$ 高于阈值电压 $V_T$ 时，反型层薄层电荷密度为 $Q_{\\mathrm{inv}} = C_{\\mathrm{ox}}(V_{GS} - V_T)$。将单层中的反型层电子体密度建模为 $n(V_{GS}) = Q_{\\mathrm{inv}}/(q t_{\\mathrm{ch}})$，其中 $q$ 是元电荷。俘获速率为 $c_n = n(V_{GS}) \\sigma_n v_{\\mathrm{th}}$，其中 $\\sigma_n$ 是俘获截面， $v_{\\mathrm{th}}$ 是电子热速度。使用麦克斯韦-玻尔兹曼平均速率 $v_{\\mathrm{th}} = \\sqrt{\\frac{8 k_B T}{\\pi m^*}}$，其中 $k_B$ 是玻尔兹曼常数， $T$ 是绝对温度， $m^*$ 是电子导带有效质量。假设为 Shockley–Read–Hall 发射 $e_n = \\sigma_n v_{\\mathrm{th}} n_1$，其中 $n_1 = N_C \\exp\\!\\left(-\\frac{E_C - E_t}{k_B T}\\right)$，导带有效态密度为 $N_C = 2 \\left(\\frac{2 \\pi m^* k_B T}{h^2}\\right)^{3/2}$，其中 $h$ 是普朗克常数，$E_C - E_t$ 是导带边与陷阱能级之间的能量间隔。将RTN切换不对称因子定义为 $A(V_{GS}) = \\frac{\\tau_{\\mathrm{filled}}}{\\tau_{\\mathrm{empty}}} = \\frac{c_n}{e_n}$，其中 $\\tau_{\\mathrm{filled}}$ 和 $\\tau_{\\mathrm{empty}}$ 分别是陷阱在填充态和空态的平均停留时间。\n\n给定以下参数： $T = 300$, $m^* = 0.45 m_e$（其中 $m_e$ 为电子质量），$\\sigma_n = 1.0 \\times 10^{-19}$，$E_C - E_t = 0.20$ 电子伏特，$\\kappa_{\\mathrm{ox}} = 20$，$t_{\\mathrm{ox}} = 3.0 \\times 10^{-9}$，$t_{\\mathrm{ch}} = 6.5 \\times 10^{-10}$，$V_T = 0.50$，以及两个栅极偏压 $V_{GS,1} = 0.70$ 和 $V_{GS,2} = 1.10$。使用 $q = 1.602176634 \\times 10^{-19}$，$\\varepsilon_0 = 8.854187817 \\times 10^{-12}$，$k_B = 1.380649 \\times 10^{-23}$，$h = 6.62607015 \\times 10^{-34}$，以及 $m_e = 9.10938356 \\times 10^{-31}$。\n\n从给定的基本定义和公式出发，推导出用 $V_{GS}$ 和给定常数表示的 $A(V_{GS})$，并计算比率\n$$R \\equiv \\frac{A(V_{GS,2})}{A(V_{GS,1})}$$\n该比率量化了RTN切换不对称性随栅极过驱动电压的变化。将最终比率 $R$ 表示为一个无量纲数，并将答案四舍五入至四位有效数字。",
            "solution": "该问题已经过验证，被认为是具有科学依据、提法得当且客观的。在纳米电子学和半导体器件物理的背景下，所有提供的信息都是一致且物理上现实的。未发现任何瑕疵。\n\n目标是推导RTN切换不对称因子 $A(V_{GS})$，然后计算在两个给定的栅源电压 $V_{GS,1}$ 和 $V_{GS,2}$ 下的比率 $R \\equiv \\frac{A(V_{GS,2})}{A(V_{GS,1})}$。\n\n根据问题陈述，不对称因子 $A(V_{GS})$ 定义为陷阱在填充态的平均停留时间 $\\tau_{\\mathrm{filled}}$ 与在空态的平均停留时间 $\\tau_{\\mathrm{empty}}$之比。这等效于俘获速率 $c_n$ 与发射速率 $e_n$ 之比。\n$$A(V_{GS}) = \\frac{\\tau_{\\mathrm{filled}}}{\\tau_{\\mathrm{empty}}} = \\frac{c_n}{e_n}$$\n给出了俘获和发射速率的表达式：\n$c_n = n(V_{GS}) \\sigma_n v_{\\mathrm{th}}$\n$e_n = \\sigma_n v_{\\mathrm{th}} n_1$\n\n在此，$n(V_{GS})$ 是反型层电子体密度，$\\sigma_n$ 是俘获截面，$v_{\\mathrm{th}}$ 是电子热速度，$n_1$ 是一个与陷阱能级和有效态密度相关的参数。\n\n将这些表达式代入 $A(V_{GS})$ 的定义中，我们发现有几项可以消去：\n$$A(V_{GS}) = \\frac{n(V_{GS}) \\sigma_n v_{\\mathrm{th}}}{\\sigma_n v_{\\mathrm{th}} n_1} = \\frac{n(V_{GS})}{n_1}$$\n只要 $\\sigma_n \\neq 0$ 且 $v_{\\mathrm{th}} \\neq 0$，这个简化就成立，根据所提供的数据（$\\sigma_n = 1.0 \\times 10^{-19}$ 且 $T = 300 \\, \\mathrm{K}$，确保了 $v_{\\mathrm{th}} > 0$），情况正是如此。\n\n接下来，我们推导 $A(V_{GS})$ 对栅源电压 $V_{GS}$ 的显式依赖关系。项 $n_1$ 由 $n_1 = N_C \\exp\\!\\left(-\\frac{E_C - E_t}{k_B T}\\right)$ 给出，其中 $N_C$ 是有效态密度。$N_C$ 和指数项都依赖于温度 $T$ 和材料属性（$m^*$, $E_C - E_t$），但与栅极电压 $V_{GS}$无关。因此，相对于 $V_{GS}$ 而言，$n_1$ 是一个常数。\n\n电子体密度 $n(V_{GS})$ 由下式给出：\n$$n(V_{GS}) = \\frac{Q_{\\mathrm{inv}}}{q t_{\\mathrm{ch}}}$$\n其中 $q$ 是元电荷，$t_{\\mathrm{ch}}$ 是沟道厚度。\n对于高于阈值电压 $V_T$ 的栅极电压 $V_{GS}$，反型层薄层电荷密度 $Q_{\\mathrm{inv}}$ 由下式给出：\n$$Q_{\\mathrm{inv}} = C_{\\mathrm{ox}}(V_{GS} - V_T)$$\n单位面积的栅极氧化层电容 $C_{\\mathrm{ox}}$ 为：\n$$C_{\\mathrm{ox}} = \\frac{\\varepsilon_{\\mathrm{ox}}}{t_{\\mathrm{ox}}} = \\frac{\\kappa_{\\mathrm{ox}} \\varepsilon_0}{t_{\\mathrm{ox}}}$$\n其中 $\\kappa_{\\mathrm{ox}}$ 是氧化物的相对介电常数，$\\varepsilon_0$ 是真空介电常数，$t_{\\mathrm{ox}}$ 是氧化层厚度。\n\n结合这些表达式，我们得到依赖于栅极电压的电子密度：\n$$n(V_{GS}) = \\frac{1}{q t_{\\mathrm{ch}}} \\left( \\frac{\\kappa_{\\mathrm{ox}} \\varepsilon_0}{t_{\\mathrm{ox}}} \\right) (V_{GS} - V_T)$$\n现在，我们可以写出不对称因子 $A(V_{GS})$ 的完整表达式：\n$$A(V_{GS}) = \\frac{n(V_{GS})}{n_1} = \\frac{\\kappa_{\\mathrm{ox}} \\varepsilon_0}{q t_{\\mathrm{ch}} t_{\\mathrm{ox}} n_1} (V_{GS} - V_T)$$\n此表达式表明 $A(V_{GS})$ 与栅极过驱动电压 $(V_{GS} - V_T)$ 呈线性正比关系。让我们定义一个常数 $K$，将所有不依赖于电压的项组合在一起：\n$$K = \\frac{\\kappa_{\\mathrm{ox}} \\varepsilon_0}{q t_{\\mathrm{ch}} t_{\\mathrm{ox}} n_1}$$\n那么，$A(V_{GS}) = K (V_{GS} - V_T)$。\n\n我们需要计算比率 $R = \\frac{A(V_{GS,2})}{A(V_{GS,1})}$。使用推导出的 $A(V_{GS})$ 表达式：\n$$R = \\frac{K (V_{GS,2} - V_T)}{K (V_{GS,1} - V_T)}$$\n常数 $K$ 被消去，得到一个非常简单的结果，它只依赖于施加的栅极电压和阈值电压：\n$$R = \\frac{V_{GS,2} - V_T}{V_{GS,1} - V_T}$$\n这意味着我们不需要计算问题陈述中提供的众多物理常数的数值，例如 $m^*$, $\\sigma_n$, $E_C - E_t$, $h$ 等，因为它们都被包含在常数 $K$ 中，而在最终的比率中 $K$ 被消去了。\n\n给定的数值如下：\n$V_{GS,1} = 0.70 \\, \\mathrm{V}$\n$V_{GS,2} = 1.10 \\, \\mathrm{V}$\n$V_T = 0.50 \\, \\mathrm{V}$\n\n将这些值代入 $R$ 的表达式中：\n第一个偏置点的栅极过驱动电压为 $V_{GS,1} - V_T = 0.70 - 0.50 = 0.20 \\, \\mathrm{V}$。\n第二个偏置点的栅极过驱动电压为 $V_{GS,2} - V_T = 1.10 - 0.50 = 0.60 \\, \\mathrm{V}$。\n\n因此，比率 $R$ 为：\n$$R = \\frac{0.60}{0.20} = 3$$\n问题要求将结果表示为一个无量纲数，并四舍五入到四位有效数字。\n\n因此，$R = 3.000$。",
            "answer": "$$\\boxed{3.000}$$"
        },
        {
            "introduction": "在先进的纳米器件中，RTN 信号往往被显著的测量噪声所淹没，并且可能表现出多个离散能级，这超出了简单双态模型的范畴。本练习将引导您进入现代 RTN 分析的前沿，通过构建和应用隐马尔可夫模型 (HMM) 来解决这一挑战 。您将学习如何从一个物理速率矩阵模型生成合成数据，并实现维特比算法 (Viterbi algorithm) 来从噪声观测中解码最可能的状态路径。",
            "id": "4297514",
            "problem": "构建一个程序，使用隐马尔可夫模型 (HMM) 在连续时间物理模型下合成和解码多级随机电报噪声，并通过最大后验 (MAP) 准则对照基准真相验证解码出的隐藏状态路径。其物理基础是，纳米电子器件中具有离散电导状态的多级随机电报噪声过程可以建模为一个连续时间马尔可夫链，其转移由一个无穷小生成元（速率矩阵）控制。以均匀间隔采样的观测值会受到加性测量噪声的干扰。解码目标是在给定观测序列和 HMM 参数的情况下，找到最可能出现的隐藏状态路径。推导和实现必须从基本定义开始：马尔可夫性质、连续时间马尔可夫链及其在采样间隔内的离散时间对应部分的结构，以及给定状态下发射的条件独立性。\n\n需使用的定义和建模假设：\n- 设隐藏状态过程为一个具有 $K$ 个状态的连续时间马尔可夫链，其速率矩阵为 $\\Lambda \\in \\mathbb{R}^{K \\times K}$，其中当 $i \\ne j$ 时 $\\Lambda_{ij} \\ge 0$，且 $\\Lambda_{ii} = -\\sum_{j \\ne i} \\Lambda_{ij}$。对于小的采样间隔 $d t$，从状态 $i$到 $j$ 在 $d t$ 内的转移概率由矩阵指数导出，即离散时间转移矩阵为 $P = \\exp(\\Lambda \\, d t)$，该矩阵是行随机的。\n- 设发射模型为加性高斯测量噪声：如果样本索引 $n$ 处的隐藏状态是 $s_n \\in \\{0,1,\\dots,K-1\\}$，观测到的电压为 $y_n = L_{s_n} + \\varepsilon_n$，其中 $L_i$ 是状态 $i$ 的电导水平（单位：伏特），而 $\\varepsilon_n \\sim \\mathcal{N}(0,\\sigma^2)$ 在 $n$ 上独立。给定状态 $s_n = i$ 时观测值 $y_n$ 的似然 $p(y_n \\mid s_n = i)$ 是均值为 $L_i$、方差为 $\\sigma^2$ 的高斯分布。\n- 设 $s_0$ 的初始分布 $\\pi$ 是离散时间转移矩阵 $P$ 的稳态分布。\n\n您的程序必须：\n1. 对于每个测试用例，通过计算 $P = \\exp(\\Lambda \\, d t)$ 来构建合成的 HMM，计算 $P$ 的稳态分布 $\\pi$，通过初始状态从 $\\pi$ 中抽取且转移由 $P$ 控制的马尔可夫链模拟一个长度为 $N$ 的隐藏状态轨迹 $\\{s_n\\}_{n=0}^{N-1}$，并使用上述高斯模型生成观测值 $\\{y_n\\}_{n=0}^{N-1}$。\n2. 在所述的 HMM 下，推导并实现一个用于隐藏状态路径的数值稳定的最大后验解码器，使用对数域以避免数值下溢。解码器的结果是在给定观测序列和已知的 HMM 参数 $(\\pi,P,L,\\sigma)$ 的情况下最可能的状态路径 $\\{\\hat{s}_n\\}_{n=0}^{N-1}$。\n3. 对于每个测试用例，计算路径准确率，即 $\\hat{s}_n = s_n$ 的索引 $n$ 的比例，表示为区间 $[0,1]$ 内的小数。准确率没有物理单位。将每个准确率四舍五入到小数点后六位。\n\n物理和数值单位：\n- 电导水平 $L_i$ 必须以伏特为单位指定和使用。\n- 速率矩阵项 $\\Lambda_{ij}$ 必须以反秒（inverse seconds）为单位指定和使用。\n- 采样间隔 $d t$ 必须以秒为单位指定和使用。\n- 噪声标准差 $\\sigma$ 必须以伏特为单位指定和使用。\n- 样本数 $N$ 是一个计数，没有物理单位。\n\n测试套件和参数：\n- 测试用例 1（二元随机电报噪声，低噪声，中等转换）：\n  - $K = 2$，\n  - $L = [\\,0\\,\\text{V},\\,20 \\times 10^{-3}\\,\\text{V}\\,]$,\n  - $\\Lambda = \\begin{bmatrix} -1500  1500 \\\\ 2000  -2000 \\end{bmatrix}$，单位为反秒，\n  - $d t = 10^{-5}$ 秒，\n  - $\\sigma = 10^{-3}$ 伏特，\n  - $N = 4000$ 样本，\n  - 随机种子 $= 12345$。\n- 测试用例 2（三级随机电报噪声，中等噪声，非对称转换）：\n  - $K = 3$，\n  - $L = [\\,0\\,\\text{V},\\,10 \\times 10^{-3}\\,\\text{V},\\,25 \\times 10^{-3}\\,\\text{V}\\,]$,\n  - 非对角线转换速率（单位：反秒）：$r_{01} = 600$，$r_{02} = 100$，$r_{10} = 300$，$r_{12} = 400$，$r_{20} = 200$，$r_{21} = 500$；根据对角线 $\\Lambda_{ii} = -\\sum_{j \\ne i} r_{ij}$ 组装 $\\Lambda$，\n  - $d t = 2 \\times 10^{-5}$ 秒，\n  - $\\sigma = 2 \\times 10^{-3}$ 伏特，\n  - $N = 5000$ 样本，\n  - 随机种子 $= 202311$。\n- 测试用例 3（三级随机电报噪声，高噪声挑战解码）：\n  - $K = 3$,\n  - $L = [\\,0\\,\\text{V},\\,10 \\times 10^{-3}\\,\\text{V},\\,25 \\times 10^{-3}\\,\\text{V}\\,]$,\n  - 使用与测试用例 2 中相同的非对角线转换速率和相应的 $\\Lambda$，\n  - $d t = 2 \\times 10^{-5}$ 秒，\n  - $\\sigma = 12 \\times 10^{-3}$ 伏特，\n  - $N = 5000$ 样本，\n  - 随机种子 $= 777$。\n- 测试用例 4（具有罕见最近邻转换的四级随机电报噪声）：\n  - $K = 4$,\n  - $L = [\\,0\\,\\text{V},\\,5 \\times 10^{-3}\\,\\text{V},\\,10 \\times 10^{-3}\\,\\text{V},\\,15 \\times 10^{-3}\\,\\text{V}\\,]$,\n  - 非对角线转换速率（单位：反秒）：仅最近邻，其中 $r_{01} = r_{10} = 10$，$r_{12} = r_{21} = 10$，$r_{23} = r_{32} = 10$，所有其他 $r_{ij} = 0$；相应地组装 $\\Lambda$，\n  - $d t = 10^{-3}$ 秒，\n  - $\\sigma = 2 \\times 10^{-3}$ 伏特，\n  - $N = 6000$ 样本，\n  - 随机种子 $= 42$。\n\n答案规格和最终输出格式：\n- 对于每个测试用例，将路径准确率计算为浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[a_1,a_2,a_3,a_4]$），其中每个 $a_i$ 四舍五入到小数点后六位。",
            "solution": "该问题要求合成和解码多级随机电报噪声，该过程通过连续时间隐马尔可夫模型 (HMM) 进行建模。此任务涉及多个步骤：从物理模型中定义 HMM 参数，模拟状态和观测值的轨迹，从观测值中解码最可能的状态路径，以及评估此解码的准确率。\n\n### 从物理模型进行 HMM 参数化\n\n1.  **连续时间马尔可夫链**：隐藏状态过程是一个具有 $K$ 个状态 $\\{0, 1, \\dots, K-1\\}$ 的连续时间马尔可夫链。其动态由无穷小生成元矩阵（或称速率矩阵）$\\Lambda \\in \\mathbb{R}^{K \\times K}$ 控制。对于 $i \\neq j$，非对角线元素 $\\Lambda_{ij}$ 代表从状态 $i$ 到状态 $j$ 的转移速率。这些速率是非负的，即 $\\Lambda_{ij} \\ge 0$。对角线元素的定义是为了确保行和为零：$\\Lambda_{ii} = -\\sum_{j \\neq i} \\Lambda_{ij}$。\n\n2.  **离散时间转移矩阵**：观测值以均匀的时间间隔 $dt$ 进行采样。此离散时间过程的转移概率矩阵 $P \\in \\mathbb{R}^{K \\times K}$ 是通过矩阵指数从连续时间生成元 $\\Lambda$ 导出的：\n    $$ P = \\exp(\\Lambda \\, dt) $$\n    元素 $P_{ij}$ 给出在时间间隔 $dt$ 内从状态 $i$ 转移到状态 $j$ 的概率，即 $P_{ij} = p(s_{n+1}=j \\mid s_n=i)$。矩阵 $P$ 是行随机的，意味着其所有元素都是非负的，并且每行之和为 $1$。\n\n3.  **初始状态分布**：初始状态 $s_0$ 是从一个概率分布 $\\pi \\in \\mathbb{R}^K$ 中抽取的，其中 $\\pi_i = p(s_0=i)$。问题指定 $\\pi$ 是离散时间马尔可夫链的稳态分布。稳态分布是一个满足特征向量方程的行向量：\n    $$ \\pi P = \\pi $$\n    同时满足归一化约束 $\\sum_{i=0}^{K-1} \\pi_i = 1$。这等效于寻找 $P$ 对应于特征值 $1$ 的左特征向量。\n\n4.  **发射模型**：当系统处于隐藏状态 $s_n=i$ 时，它会生成一个可观测的电压 $y_n$。这个观测值受到加性高斯白噪声的干扰。该模型为：\n    $$ y_n = L_i + \\varepsilon_n $$\n    其中 $L_i$ 是状态 $i$ 的平均电压水平，$\\varepsilon_n$ 是从均值为零、方差为 $\\sigma^2$ 的正态分布中抽取的噪声项，即 $\\varepsilon_n \\sim \\mathcal{N}(0, \\sigma^2)$。因此，给定状态 $s_n=i$ 时观测值 $y_n$ 的发射概率密度为：\n    $$ p(y_n \\mid s_n=i) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_n - L_i)^2}{2\\sigma^2}\\right) $$\n\n### 合成数据生成\n\n对于每个测试用例，我们按如下方式合成一个数据集：\n1.  根据给定的速率构建速率矩阵 $\\Lambda$。\n2.  计算离散时间转移矩阵 $P = \\exp(\\Lambda \\, dt)$。\n3.  计算 $P$ 的稳态分布 $\\pi$。\n4.  为保证可复现性，设置随机数生成器种子。\n5.  生成一个长度为 $N$ 的隐藏状态序列 $\\{s_n\\}_{n=0}^{N-1}$：\n    - 从由 $\\pi$ 定义的分类分布中抽取初始状态 $s_0$。\n    - 对于 $n = 1, \\dots, N-1$，从由 $P$ 的第 $s_{n-1}$ 行定义的分类分布中抽取状态 $s_n$。\n6.  生成相应的长度为 $N$ 的观测序列 $\\{y_n\\}_{n=0}^{N-1}$：\n    - 对于每个 $n = 0, \\dots, N-1$，从高斯分布 $\\mathcal{N}(L_{s_n}, \\sigma^2)$ 中抽取观测值 $y_n$。\n\n### 最大后验 (MAP) 路径解码\n\n目标是给定观测序列 $\\{y_n\\}_{n=0}^{N-1}$ 和 HMM 参数 $(\\pi, P, L, \\sigma)$，找到最可能的隐藏状态序列 $\\{\\hat{s}_n\\}_{n=0}^{N-1}$。这被称为 MAP 解码。\n$$ \\{\\hat{s}_n\\} = \\arg\\max_{\\{s_n\\}} p(\\{s_n\\} \\mid \\{y_n\\}) $$\n根据贝叶斯定理，这等效于最大化联合概率 $p(\\{s_n\\}, \\{y_n\\})$。对于特定路径 $\\{s_n\\}$ 的联合概率由下式给出：\n$$ p(\\{y_n\\}, \\{s_n\\}) = p(s_0) p(y_0|s_0) \\prod_{n=1}^{N-1} p(s_n|s_{n-1}) p(y_n|s_n) = \\pi_{s_0} p(y_0|s_0=s_0) \\prod_{n=1}^{N-1} P_{s_{n-1},s_n} p(y_n|s_n=s_n) $$\n对于长序列，直接计算此乘积容易出现数值下溢。因此，我们在对数域中工作，最大化对数联合概率。这通过使用维特比算法实现。\n\n### 对数域中的维特比算法\n\n设 $\\delta_n(i)$ 为在时间 $n$ 以状态 $i$ 结束、且已生成观测值 $y_0, \\dots, y_n$ 的任意长度为 $n+1$ 的状态路径的最大对数概率。\n\n1.  **初始化 ($n=0$):**\n    对于每个状态 $i \\in \\{0, \\dots, K-1\\}$：\n    $$ \\delta_0(i) = \\log(\\pi_i) + \\log p(y_0 | s_0=i) $$\n    其中对数发射概率为：\n    $$ \\log p(y_n | s_n=i) = -\\frac{(y_n - L_i)^2}{2\\sigma^2} - \\frac{1}{2}\\log(2\\pi\\sigma^2) $$\n\n2.  **递归 ($n=1, \\dots, N-1$):**\n    对于每个状态 $j \\in \\{0, \\dots, K-1\\}$：\n    $$ \\delta_n(j) = \\max_{i=0,\\dots,K-1} \\left( \\delta_{n-1}(i) + \\log(P_{ij}) \\right) + \\log p(y_n | s_n=j) $$\n    为了重构路径，我们将后向指针存储在数组 $\\psi_n(j)$ 中：\n    $$ \\psi_n(j) = \\arg\\max_{i=0,\\dots,K-1} \\left( \\delta_{n-1}(i) + \\log(P_{ij}) \\right) $$\n\n3.  **终止:**\n    最可能路径的对数概率为 $p^* = \\max_{i=0,\\dots,K-1} \\delta_{N-1}(i)$。\n    该路径的最终状态为 $\\hat{s}_{N-1} = \\arg\\max_{i=0,\\dots,K-1} \\delta_{N-1}(i)$。\n\n4.  **路径回溯:**\n    我们通过从最终状态回溯来恢复最可能的路径：\n    对于 $n = N-2, \\dots, 0$：\n    $$ \\hat{s}_n = \\psi_{n+1}(\\hat{s}_{n+1}) $$\n\n### 路径准确率计算\n最后一步是量化解码器的性能。通过将解码的状态序列 $\\{\\hat{s}_n\\}$ 与基准真相（综合生成）的状态序列 $\\{s_n\\}$ 进行比较来计算路径准确率。它是解码状态与真实状态匹配的时间步数的比例：\n$$ \\text{Accuracy} = \\frac{1}{N} \\sum_{n=0}^{N-1} \\mathbf{1}(\\hat{s}_n = s_n) $$\n其中 $\\mathbf{1}(\\cdot)$ 是指示函数，如果其参数为真则为 $1$，否则为 $0$。结果以保留六位小数的十进制数报告。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm, eig\n\ndef solve():\n    \"\"\"\n    Main function to run the HMM simulation and decoding for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"K\": 2,\n            \"L\": np.array([0.0, 20e-3]),\n            \"Lambda\": np.array([[-1500.0, 1500.0], [2000.0, -2000.0]]),\n            \"dt\": 1e-5,\n            \"sigma\": 1e-3,\n            \"N\": 4000,\n            \"seed\": 12345,\n        },\n        {\n            \"K\": 3,\n            \"L\": np.array([0.0, 10e-3, 25e-3]),\n            \"Lambda\": np.array([[-700.0, 600.0, 100.0], [300.0, -700.0, 400.0], [200.0, 500.0, -700.0]]),\n            \"dt\": 2e-5,\n            \"sigma\": 2e-3,\n            \"N\": 5000,\n            \"seed\": 202311,\n        },\n        {\n            \"K\": 3,\n            \"L\": np.array([0.0, 10e-3, 25e-3]),\n            \"Lambda\": np.array([[-700.0, 600.0, 100.0], [300.0, -700.0, 400.0], [200.0, 500.0, -700.0]]),\n            \"dt\": 2e-5,\n            \"sigma\": 12e-3,\n            \"N\": 5000,\n            \"seed\": 777,\n        },\n        {\n            \"K\": 4,\n            \"L\": np.array([0.0, 5e-3, 10e-3, 15e-3]),\n            \"Lambda\": np.array([[-10.0, 10.0, 0.0, 0.0], [10.0, -20.0, 10.0, 0.0], [0.0, 10.0, -20.0, 10.0], [0.0, 0.0, 10.0, -10.0]]),\n            \"dt\": 1e-3,\n            \"sigma\": 2e-3,\n            \"N\": 6000,\n            \"seed\": 42,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        K, L, Lambda, dt, sigma, N, seed = case.values()\n        rng = np.random.default_rng(seed)\n\n        # 1. Synthesize HMM data\n        s_true, y_obs, pi, P = synthesize_hmm_data(K, L, Lambda, dt, sigma, N, rng)\n\n        # 2. Decode using Viterbi\n        s_decoded = viterbi_decode(K, y_obs, pi, P, L, sigma)\n\n        # 3. Compute accuracy\n        accuracy = np.mean(s_true == s_decoded)\n        results.append(f\"{accuracy:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef get_stationary_distribution(P):\n    \"\"\"\n    Calculates the stationary distribution of a transition matrix P.\n    It is the normalized left eigenvector corresponding to eigenvalue 1.\n    \"\"\"\n    eigenvalues, eigenvectors = eig(P.T)\n    # Find the eigenvector corresponding to the eigenvalue closest to 1\n    idx = np.argmin(np.abs(eigenvalues - 1.0))\n    pi_unnormalized = eigenvectors[:, idx].real\n    pi = pi_unnormalized / np.sum(pi_unnormalized)\n    return pi\n\ndef synthesize_hmm_data(K, L, Lambda, dt, sigma, N, rng):\n    \"\"\"\n    Synthesizes hidden states and observations from an HMM.\n    \"\"\"\n    # Discrete-time transition matrix\n    P = expm(Lambda * dt)\n    \n    # Initial state distribution (stationary)\n    pi = get_stationary_distribution(P)\n\n    # Generate hidden states\n    states = np.zeros(N, dtype=int)\n    states[0] = rng.choice(K, p=pi)\n    for n in range(1, N):\n        states[n] = rng.choice(K, p=P[states[n-1], :])\n\n    # Generate observations\n    observations = rng.normal(loc=L[states], scale=sigma)\n    \n    return states, observations, pi, P\n\ndef viterbi_decode(K, y_obs, pi, P, L, sigma):\n    \"\"\"\n    Finds the most likely sequence of hidden states given observations\n    using the Viterbi algorithm in the log domain.\n    \"\"\"\n    N = len(y_obs)\n    \n    # Pre-compute log probabilities to avoid repeated calculations\n    # Small epsilon to avoid log(0)\n    log_pi = np.log(pi + 1e-300)\n    log_P = np.log(P + 1e-300)\n\n    # Log emission probabilities\n    log_emission_const = -0.5 * np.log(2 * np.pi * sigma**2)\n    def log_emission_prob(y, state_k):\n        return log_emission_const - ((y - L[state_k])**2) / (2 * sigma**2)\n\n    # Viterbi variables\n    delta = np.zeros((N, K))\n    psi = np.zeros((N, K), dtype=int)\n\n    # Initialization (n=0)\n    for i in range(K):\n        delta[0, i] = log_pi[i] + log_emission_prob(y_obs[0], i)\n\n    # Recursion (n=1 to N-1)\n    for n in range(1, N):\n        y_n_log_probs = np.array([log_emission_prob(y_obs[n], j) for j in range(K)])\n        for j in range(K):\n            # The transition part: delta_{n-1}(i) + log(P_ij)\n            trans_probs = delta[n-1, :] + log_P[:, j]\n            # Maximize over previous states i\n            psi[n, j] = np.argmax(trans_probs)\n            delta[n, j] = np.max(trans_probs) + y_n_log_probs[j]\n\n    # Path backtracking\n    decoded_path = np.zeros(N, dtype=int)\n    decoded_path[N-1] = np.argmax(delta[N-1, :])\n    for n in range(N-2, -1, -1):\n        decoded_path[n] = psi[n+1, decoded_path[n+1]]\n\n    return decoded_path\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}