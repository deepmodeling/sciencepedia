{
    "hands_on_practices": [
        {
            "introduction": "内存计算的主要驱动力是其在能效方面实现巨大提升的潜力。本练习提供了一个具体模型，用于计算典型阻性交叉阵列宏的能量消耗，并将其分解为各个组成部分。通过完成此计算，您将理解列级开销是如何被摊销的，并能识别出系统中的主要能耗来源。",
            "id": "4276912",
            "problem": "考虑一个电阻交叉阵列存内计算宏单元，该宏单元沿一列执行点积运算，该列有$N$行，每行以电导的形式存储一个8位权重，并由一个编码为电压的8位输入驱动。数模转换器 (DAC) 从数字输入生成行电压，阵列通过欧姆传导和列上的电流求和来执行模拟乘累加 (MAC) 操作，单个模数转换器 (ADC) 对每个点积的列电流进行数字化。外围电路（例如，字线驱动器、采样保持、参考生成）每次列操作都会产生能量成本。\n\n使用以下数据，均针对8位分辨率指定：\n- 每个输入单元激活的DAC能量：$E_{\\text{DAC}} = 0.2\\ \\text{pJ}$。\n- 每个模拟MAC的阵列传导能量：$E_{\\text{array}} = 0.05\\ \\text{pJ}/\\text{MAC}$。\n- 每次列转换的ADC能量：$E_{\\text{ADC}} = 1\\ \\text{pJ}/\\text{conv}$。\n- 每次列操作的外围电路能量：$E_{\\text{periph}} = 0.1\\ \\text{pJ}$。\n- 每列的行数：$N = 256$。\n\n从总能量是独立子操作能量的总和，且列级能量被分摊到点积并行产生的MAC数量上的原理出发，推导沿一列的每个有效8位MAC的总能量表达式，并为给定参数计算其值。以皮焦耳 ($\\text{pJ}$) 为单位表示您的最终答案，并将结果四舍五入到六位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于集成电路能耗原理，特别是针对存内计算架构。这是一个适定问题，提供了所有必要的参数和明确的目标。数据在量纲上是一致的，并且对于现代半导体技术是物理上现实的。\n\n目标是推导在一个电阻交叉阵列内，每个有效8位乘累加(MAC)操作的总能量表达式，并计算其数值。\n\n如问题所述，基本原理是：一次列操作的总能量，记为 $E_{\\text{total\\_col}}$，是其组成部分所消耗能量的总和。所述操作是向量-矩阵乘法，具体来说是输入电压向量与阵列一列上存储的电导向量之间的点积。\n\n一次完整列操作的总能量的组成部分如下：\n\n1. 数模转换器 (DAC) 能量：$N$行中的每一行都由一个DAC生成的输入电压驱动。由于所有$N$行都被激活以计算点积，因此DAC消耗的总能量是每次DAC激活的能量 $E_{\\text{DAC}}$ 乘以行数 $N$。\n$$ E_{\\text{DAC\\_total}} = N \\cdot E_{\\text{DAC}} $$\n\n2. 阵列传导能量：核心的乘累加操作发生在电阻阵列内部。对于列中的$N$个单元中的每一个，都会执行一次乘法操作（欧姆定律：$I = V \\cdot G$）。问题提供了每个模拟MAC的能量 $E_{\\text{array}}$。由于$N$个这样的操作并行发生，总的阵列能量是：\n$$ E_{\\text{array\\_total}} = N \\cdot E_{\\text{array}} $$\n\n3. 模数转换器 (ADC) 能量：来自列中所有$N$个单元的电流在列线的底部相加（Kirchhoff电流定律）。这个单一的、相加后的模拟电流随后由一个ADC转换回数字值。这是每次列操作的固定能量成本。\n$$ E_{\\text{ADC\\_total}} = E_{\\text{ADC}} $$\n\n4. 外围电路能量：列操作需要额外的电路，如字线驱动器、参考电压生成器和采样保持电路。它们的组合能量成本以每次列操作的单个值的形式给出。\n$$ E_{\\text{periph\\_total}} = E_{\\text{periph}} $$\n\n单次列操作的总能量是这些组成部分的和：\n$$ E_{\\text{total\\_col}} = E_{\\text{DAC\\_total}} + E_{\\text{array\\_total}} + E_{\\text{ADC\\_total}} + E_{\\text{periph\\_total}} $$\n$$ E_{\\text{total\\_col}} = N \\cdot E_{\\text{DAC}} + N \\cdot E_{\\text{array}} + E_{\\text{ADC}} + E_{\\text{periph}} $$\n\n问题要求的是每个有效8位MAC的能量，我们将其记为 $E_{\\text{MAC\\_eff}}$。一次列操作执行$N$个并行的8位 $\\times$ 8位乘累加操作。因此，为了找到每个MAC的有效能量，我们必须将总的列能量分摊到所执行的$N$个操作上。\n$$ E_{\\text{MAC\\_eff}} = \\frac{E_{\\text{total\\_col}}}{N} $$\n代入 $E_{\\text{total\\_col}}$ 的表达式：\n$$ E_{\\text{MAC\\_eff}} = \\frac{N \\cdot E_{\\text{DAC}} + N \\cdot E_{\\text{array}} + E_{\\text{ADC}} + E_{\\text{periph}}}{N} $$\n这个表达式可以通过分配除以$N$来简化：\n$$ E_{\\text{MAC\\_eff}} = E_{\\text{DAC}} + E_{\\text{array}} + \\frac{E_{\\text{ADC}} + E_{\\text{periph}}}{N} $$\n这个最终的符号表达式表明，DAC和阵列的每MAC能量是直接成本，而ADC和外围电路的共享列级开销则被分摊到$N$个并行操作上。\n\n现在，我们代入给定的数值：\n- 每列的行数：$N = 256$\n- 每个激活的DAC能量：$E_{\\text{DAC}} = 0.2\\ \\text{pJ}$\n- 每个MAC的阵列能量：$E_{\\text{array}} = 0.05\\ \\text{pJ}$\n- 每次转换的ADC能量：$E_{\\text{ADC}} = 1\\ \\text{pJ}$\n- 每次列操作的外围电路能量：$E_{\\text{periph}} = 0.1\\ \\text{pJ}$\n\n将这些值代入推导出的 $E_{\\text{MAC\\_eff}}$ 公式中：\n$$ E_{\\text{MAC\\_eff}} = 0.2 + 0.05 + \\frac{1 + 0.1}{256} $$\n$$ E_{\\text{MAC\\_eff}} = 0.25 + \\frac{1.1}{256} $$\n进行除法运算：\n$$ \\frac{1.1}{256} = 0.004296875 $$\n现在，完成加法运算：\n$$ E_{\\text{MAC\\_eff}} = 0.25 + 0.004296875 = 0.254296875\\ \\text{pJ} $$\n问题要求最终答案四舍五入到六位有效数字。前六位有效数字是 $2, 5, 4, 2, 9, 6$。第七位数字是 $8$，大于或等于 $5$，所以我们将第六位数字向上取整。\n$$ E_{\\text{MAC\\_eff}} \\approx 0.254297\\ \\text{pJ} $$",
            "answer": "$$\\boxed{0.254297}$$"
        },
        {
            "introduction": "尽管内存计算架构在并行计算方面表现出色，但其模拟特性给读出电路带来了巨大挑战。本实践通过计算交叉阵列列的最大和最小可能输出电流，来探讨动态范围的概念。这一分析对于设计能够精确处理各种可能信号的传感放大器和模数转换器至关重要。",
            "id": "4276926",
            "problem": "考虑一个用于存内计算的无源电阻交叉阵列，其应用背景为集成电路与电子设计自动化（EDA）。该交叉阵列具有 $128$ 行和 $128$ 列，每个交叉点包含一个电导为 $G_{ij}$ 的电阻元件，连接第 $i$ 行和第 $j$ 列。每一行 $i$ 由输入电压 $V_{i}$ 驱动，每一列汇集所有连接器件的电流，并由一个读出放大器读取。假设器件呈欧姆行为且导线为理想导线，因此 Kirchhoff 电流定律（KCL）和 Ohm 定律适用，无寄生损耗。\n\n行输入电压在区间 $[0,\\,0.2]\\ \\text{V}$ 内均匀量化为 $N=8$ 位，包括端点 $0\\ \\text{V}$ 和 $0.2\\ \\text{V}$。每个器件的电导被限制在区间 $[1,\\,100]\\ \\mu\\text{S}$ 内，并可在此范围内任意设置。列电流是由各自的行电压驱动的器件电流之和，即对于给定的列 $j$：\n$$\nI_{j}=\\sum_{i=1}^{128} G_{ij} V_{i}.\n$$\n以这些事实为基本依据，确定：\n1. 在所有允许的 $\\{V_{i}\\}$ 和 $\\{G_{ij}\\}$ 条件下，可能的最大列电流 $I_{\\max}$。\n2. 读出放大器所需的动态范围，此处定义为最大可能列电流与最小非零列电流之比 $\\mathcal{D}$。该最小非零列电流是在给定的输入量化和电导边界条件下，交叉阵列所能产生的。对于最小非零电流，应考虑任何允许配置下可实现的最小严格正值的列电流。\n\n将最大列电流以毫安（mA）表示。将动态范围表示为无单位的比率。将这两个量都四舍五入到四位有效数字。",
            "solution": "我们从 Ohm 定律和 Kirchhoff 电流定律开始。对于列 $j$，其电流是每行-器件对贡献的电流之和：\n$$\nI_{j}=\\sum_{i=1}^{128} I_{ij}=\\sum_{i=1}^{128} G_{ij} V_{i},\n$$\n其中 $I_{ij}=G_{ij} V_{i}$ 是根据 Ohm 定律得出的交叉点 $(i,j)$ 处每个电阻器件的电流。\n\n为获得最大可能列电流 $I_{\\max}$，我们在约束条件 $V_{i} \\in [0,\\,0.2]\\ \\text{V}$（量化的）和 $G_{ij} \\in [1,\\,100]\\ \\mu\\text{S}$ 下，最大化每一项 $G_{ij} V_{i}$。由于 $G_{ij}$ 和 $V_{i}$ 以乘法形式出现，且求和对 $i$ 是可分的，所以当所有 $V_{i}$ 取其允许的最大值，且所有 $G_{ij}$ 处于其上界时，总和达到最大值：\n$$\nV_{i}^{\\max}=0.2\\ \\text{V}, \\quad G_{ij}^{\\max}=100\\ \\mu\\text{S}.\n$$\n因此，\n$$\nI_{\\max}=\\sum_{i=1}^{128} G_{ij}^{\\max} V_{i}^{\\max} = \\sum_{i=1}^{128} \\left(100 \\times 10^{-6}\\ \\text{S}\\right) \\left(0.2\\ \\text{V}\\right).\n$$\n每一项等于\n$$\n\\left(100 \\times 10^{-6}\\right)\\left(0.2\\right)\\ \\text{A} = 20 \\times 10^{-6}\\ \\text{A},\n$$\n并且有 $128$ 项，得出\n$$\nI_{\\max} = 128 \\times 20 \\times 10^{-6}\\ \\text{A} = 2560 \\times 10^{-6}\\ \\text{A} = 2.56 \\times 10^{-3}\\ \\text{A}.\n$$\n以毫安表示，\n$$\nI_{\\max} = 2.56\\ \\text{mA}.\n$$\n四舍五入到四位有效数字，结果为 $2.560\\ \\text{mA}$。\n\n接下来，我们将动态范围 $\\mathcal{D}$ 定义为\n$$\n\\mathcal{D}=\\frac{I_{\\max}}{I_{\\min}},\n$$\n其中 $I_{\\min}$ 是在给定约束下可实现的最小严格正值列电流。最小非零列电流出现在只有一个器件贡献最小非零电流，而所有其他贡献均为零（即它们的行电压为 $0\\ \\text{V}$ 或电导无贡献）的情况下。因为输入是量化的，所以最小的严格正电压是最低有效步长（LSB）。对于在 $[0,\\,0.2]\\ \\text{V}$（包括两个端点）上均匀量化的 $N=8$ 位，步长为\n$$\n\\Delta V = \\frac{0.2\\ \\text{V} - 0\\ \\text{V}}{2^{8}-1} = \\frac{0.2}{255}\\ \\text{V}.\n$$\n因此，最小的严格正电压电平是 $V_{\\text{LSB}}=\\Delta V=\\frac{0.2}{255}\\ \\text{V}$。最小电导为\n$$\nG_{\\min} = 1\\ \\mu\\text{S} = 1 \\times 10^{-6}\\ \\text{S}.\n$$\n当只有一个位于 $(i^{*}, j)$ 的器件有贡献时，最小的严格正列电流是\n$$\nI_{\\min} = G_{\\min} V_{\\text{LSB}} = \\left(1 \\times 10^{-6}\\ \\text{S}\\right) \\left(\\frac{0.2}{255}\\ \\text{V}\\right) = \\frac{0.2 \\times 10^{-6}}{255}\\ \\text{A}.\n$$\n因此动态范围是\n$$\n\\mathcal{D} = \\frac{I_{\\max}}{I_{\\min}} = \\frac{2.56 \\times 10^{-3}}{\\frac{0.2 \\times 10^{-6}}{255}} = \\frac{2.56 \\times 10^{-3} \\times 255}{0.2 \\times 10^{-6}}.\n$$\n我们进行代数化简：\n$$\n\\mathcal{D} = \\frac{2.56}{0.2} \\times \\frac{255 \\times 10^{-3}}{10^{-6}} = 12.8 \\times 255 \\times 10^{3} = 3264 \\times 10^{3} = 3.264 \\times 10^{6}.\n$$\n在给定的量化模型下，这已经是精确值。四舍五入到四位有效数字，得到\n$$\n\\mathcal{D} = 3.264 \\times 10^{6}.\n$$\n\n因此，所求的量为 $I_{\\max}=2.560\\ \\text{mA}$ 和 $\\mathcal{D}=3.264 \\times 10^{6}$（无单位比率），均按要求保留四位有效数字。",
            "answer": "$$\\boxed{\\begin{pmatrix}2.560  3.264 \\times 10^{6}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在理想模型中，构成交叉阵列的导线电阻为零，但实际上它们会引入电压降（IR drop），从而降低计算精度。本练习将引导您对沿行线的“IR压降”进行建模，并估算其对最终向量-矩阵乘法结果的影响。这展示了物理器件和互连线的属性如何直接转化为系统级的计算误差。",
            "id": "4282448",
            "problem": "考虑一个用于内存中向量-矩阵乘法 (VMM) 的电阻交叉阵列，该阵列有 $M$ 行和 $N$ 列。位于第 $i$ 行和第 $j$ 列的每个可编程单元被建模为一个线性电导 $G_{ij}$，连接在行线和列线之间。VMM 操作将输入电压向量 $\\{V_{i}\\}$ 施加到 $M$ 行上，并感测 $N$ 列上产生的输出电流。在实践中，由于互连材料的有限电阻率和线路几何形状，水平行线表现出非零电阻，导致沿线路产生欧姆压降，从而降低了远离驱动器的单元所获得的电压。假设列线通过高增益跨阻放大器保持在理想的虚拟地（零电压），因此与行线压降相比，列线电压变化可以忽略不计。\n\n从欧姆定律和电阻率的定义出发，将单一行 $j$ 建模为一条均匀的电阻线，其单位长度电阻为 $r$，总长度为 $L$。在假设行负载为近似均匀的单元电导，并且工作在压降足够小的区域，以至于行电流分布可以很好地用其在驱动器附近的总值来近似的情况下，推导出行上某位置 $x$（从驱动器测量）处的单元节点电压的表达式，该表达式用施加的行电压 $V_{j}$、行电流 $I_{j}$ 以及驱动器和单元位置之间的线路电阻来表示。使用此分布式电阻模型，将您的结果特化到位于行最远端的最差情况单元，并获得其电压的表达式，该表达式用 $V_{j}$、$I_{j}$ 和行的总线路电阻 $R_{\\text{line}}$ 表示。\n\n将由行线压降引起的列 $k$ 处的相对 VMM 输出误差定义为\n$$\\delta_{k} \\equiv \\frac{|I_{k}^{\\text{ideal}} - I_{k}^{\\text{actual}}|}{I_{k}^{\\text{ideal}}},$$\n其中 $I_{k}^{\\text{ideal}}$ 是行线为理想导体时的列电流，$I_{k}^{\\text{actual}}$ 是在单元获得降低了的行节点电压时的列电流。假设所有单元具有相同的电导 $G_{ij} = G_{0}$，并且所有行都由相同的电压 $V_{i} = V_{0}$ 驱动，使用您推导的最远端单元电压表达式来估计最差情况下的 $\\delta_{k}$。\n\n阵列的数值参数如下：\n- $M = 256$， $N = 256$，\n- 均匀单元电导 $G_{0} = 10~\\mu\\text{S}$，\n- 均匀行驱动电压 $V_{0} = 0.1~\\text{V}$，\n- 互连材料电阻率 $\\rho = 2.0 \\times 10^{-8}~\\Omega\\cdot\\text{m}$，\n- 行线宽度 $w = 200~\\text{nm}$，厚度 $t = 100~\\text{nm}$，\n- 单元间距 $a = 100~\\text{nm}$，因此行长度为 $L = N a$。\n\n将每行上的最差情况单元视为位于 $x = L$ 处，并忽略列线压降。使用这些参数计算最差情况下的相对 VMM 输出误差 $\\delta_{k}$。将最终答案四舍五入到四位有效数字，并以不带单位符号的小数表示。",
            "solution": "用户提供的问题已经过验证，并被确定是合理的。它在科学上基于电路理论的原理，问题提出得当，信息充分，目标明确，陈述客观。明确给出了简化假设，使得问题可以求解。\n\n我们首先对单一行线上的电压降进行建模。设行的索引为 $j$。行线是一条总长度为 $L$ 的电阻线，其单位长度的电阻为均匀的 $r$。根据欧姆定律，在位置 $x$（从电压驱动器测量）处，长度为无穷小 $dx$ 的一段导线上的无穷小压降 $dV$ 由下式给出：\n$$dV(x) = I(x) (r \\, dx)$$\n其中 $I(x)$ 是在位置 $x$ 处流过行线的电流。问题陈述中指出，我们可以用驱动器附近的总电流值来近似电流分布 $I(x)$，我们将其表示为 $I_j$。这个简化假设分流到单元的电流与总电流相比很小，这在小压降区域是有效的。因此，我们近似 $I(x) \\approx I_j$。\n\n从驱动器（位于 $x=0$）到位置 $x$ 的总压降 $\\Delta V(x)$ 是这些无穷小压降的积分：\n$$\\Delta V(x) = \\int_{0}^{x} dV(x') = \\int_{0}^{x} I(x') r \\, dx' \\approx \\int_{0}^{x} I_j r \\, dx' = I_j r x$$\n量 $r x$ 是从驱动器到位置 $x$ 的线路电阻，我们可以将其表示为 $R(x)$。因此，$\\Delta V(x) \\approx I_j R(x)$。\n\n位置 $x$ 处的单元节点电压 $V(x)$ 是驱动器上施加的电压 $V_j$ 减去这个压降：\n$$V(x) = V_j - \\Delta V(x) = V_j - I_j r x$$\n该表达式给出了位置 $x$ 处的单元节点电压，用施加的电压 $V_j$、总行电流 $I_j$ 以及驱动器和单元之间的线路电阻 $r x$ 表示。\n\n对于位于行最远端的最差情况单元，我们设置 $x=L$。行线的总电阻为 $R_{\\text{line}} = rL$。此单元的电压为：\n$$V_{\\text{far-end}} = V(L) = V_j - I_j r L = V_j - I_j R_{\\text{line}}$$\n这就是所要求的最远端单元电压的表达式。\n\n接下来，我们估计相对 VMM 输出误差 $\\delta_k$，其定义为：\n$$\\delta_{k} \\equiv \\frac{|I_{k}^{\\text{ideal}} - I_{k}^{\\text{actual}}|}{I_{k}^{\\text{ideal}}}$$\n我们分析所有单元电导均为 $G_{ij} = G_0$ 且所有行驱动电压均为 $V_i = V_0$ 的特定情况。\n\n在理想情况下，行线是理想导体 ($R_{\\text{line}} = 0$)。每个单元 $(i, k)$ 上的电压就是施加的行电压 $V_0$。列线处于虚拟地（$0$ V）。列 $k$ 中的电流是连接到它的所有 $M$ 行的电流之和：\n$$I_{k}^{\\text{ideal}} = \\sum_{i=1}^{M} G_{ik} V_{i} = \\sum_{i=1}^{M} G_0 V_0 = M G_0 V_0$$\n\n在实际情况下，我们必须考虑电压降。为了求得电压降，我们首先需要每行的总电流 $I_i$。遵循问题的近似方案，我们可以使用理想电压来估计这个电流：\n$$I_i = \\sum_{j=1}^{N} G_{ij} V_i = \\sum_{j=1}^{N} G_0 V_0 = N G_0 V_0$$\n由于这对所有行都是相同的，我们称之为 $I_0 = N G_0 V_0$。\n\n问题要求使用最远端单元电压来估计误差。这意味着一种最差情况估计，即我们假设给定行上*每个*单元的电压都降低到最远端的电压。因此，对于行 $i$ 上的每个单元，我们将其电压近似为：\n$$V_{i, \\text{cell}}^{\\text{actual}} \\approx V_0 - I_0 R_{\\text{line}} = V_0 - (N G_0 V_0) R_{\\text{line}} = V_0(1 - N G_0 R_{\\text{line}})$$\n然后，实际的列电流 $I_k^{\\text{actual}}$ 估计为：\n$$I_{k}^{\\text{actual}} = \\sum_{i=1}^{M} G_0 V_{i, \\text{cell}}^{\\text{actual}} = \\sum_{i=1}^{M} G_0 \\left[V_0(1 - N G_0 R_{\\text{line}})\\right] = M G_0 V_0 (1 - N G_0 R_{\\text{line}})$$\n现在我们计算相对误差 $\\delta_k$。由于 $N$、$G_0$ 和 $R_{\\text{line}}$ 都是正量，并且我们预期压降只是施加电压的一小部分，所以 $N G_0 R_{\\text{line}}  1$。因此我们可以去掉绝对值符号。\n$$\\delta_k = \\frac{I_{k}^{\\text{ideal}} - I_{k}^{\\text{actual}}}{I_{k}^{\\text{ideal}}} = \\frac{M G_0 V_0 - M G_0 V_0 (1 - N G_0 R_{\\text{line}})}{M G_0 V_0}$$\n$$\\delta_k = 1 - (1 - N G_0 R_{\\text{line}}) = N G_0 R_{\\text{line}}$$\n这就是相对误差的最差情况估计，在这些均匀条件下，它与列索引 $k$ 无关。\n\n最后，我们计算数值。首先，我们计算总线路电阻 $R_{\\text{line}}$。导线的电阻由 $R = \\rho \\frac{\\text{长度}}{\\text{面积}}$ 给出。\n行线的长度是 $L = N a$。\n行线的横截面积是 $A = w t$。\n$$R_{\\text{line}} = \\rho \\frac{L}{A} = \\rho \\frac{N a}{w t}$$\n代入以国际单位制（SI units）表示的给定数值参数：\n$N = 256$\n$\\rho = 2.0 \\times 10^{-8}~\\Omega\\cdot\\text{m}$\n$a = 100~\\text{nm} = 1.0 \\times 10^{-7}~\\text{m}$\n$w = 200~\\text{nm} = 2.0 \\times 10^{-7}~\\text{m}$\n$t = 100~\\text{nm} = 1.0 \\times 10^{-7}~\\text{m}$\n$$R_{\\text{line}} = (2.0 \\times 10^{-8}~\\Omega\\cdot\\text{m}) \\frac{(256) \\times (1.0 \\times 10^{-7}~\\text{m})}{(2.0 \\times 10^{-7}~\\text{m}) \\times (1.0 \\times 10^{-7}~\\text{m})} = \\frac{5.12 \\times 10^{-13}}{2.0 \\times 10^{-14}}~\\Omega = 25.6~\\Omega$$\n现在，我们使用 $G_0 = 10~\\mu\\text{S} = 1.0 \\times 10^{-5}~\\text{S}$ 来计算相对误差 $\\delta_k$：\n$$\\delta_k = N G_0 R_{\\text{line}} = (256) \\times (1.0 \\times 10^{-5}~\\text{S}) \\times (25.6~\\Omega)$$\n$$\\delta_k = 256 \\times 2.56 \\times 10^{-4} = 655.36 \\times 10^{-4} = 0.065536$$\n问题要求四舍五入到四位有效数字。\n$\\delta_k \\approx 0.06554$。\n这表示最差情况下的 VMM 输出误差约为 $6.554\\%$。",
            "answer": "$$\\boxed{0.06554}$$"
        }
    ]
}