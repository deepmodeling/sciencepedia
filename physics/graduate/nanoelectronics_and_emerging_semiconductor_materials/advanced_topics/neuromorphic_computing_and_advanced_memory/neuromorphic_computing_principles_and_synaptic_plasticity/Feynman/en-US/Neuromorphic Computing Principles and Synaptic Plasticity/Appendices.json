{
    "hands_on_practices": [
        {
            "introduction": "Spike-Timing-Dependent Plasticity (STDP) is a biologically inspired learning rule that is fundamental to many neuromorphic systems. It adjusts synaptic strength based on the precise timing difference between presynaptic and postsynaptic neuron spikes. This exercise provides a hands-on derivation of the classic STDP learning window, starting from the differential equations that model the underlying synaptic eligibility traces. By solving this problem, you will gain a deeper, first-principles understanding of how relative spike timing translates into synaptic potentiation or depression. ",
            "id": "4290330",
            "problem": "A two-terminal metal-oxide memristive synapse fabricated from a titanium dioxide ($\\mathrm{TiO_2}$) stack exhibits Spike-Timing-Dependent Plasticity (STDP), implemented by overlap of a presynaptic voltage pulse at time $t_{\\text{pre}}$ and a postsynaptic back-propagating pulse at time $t_{\\text{post}}$. The local ionic occupancy that gates field-driven modulation of the channel conductance is described by exponentially decaying traces. Specifically, the presynaptic trace $x(t)$ and the postsynaptic trace $y(t)$ are defined by the causal solutions to the first-order linear differential equations\n$$\\frac{d x}{d t} = -\\frac{x}{\\tau_{+}}, \\quad \\frac{d y}{d t} = -\\frac{y}{\\tau_{-}},$$\nwith impulsive excitations at $t=t_{\\text{pre}}$ for $x(t)$ and $t=t_{\\text{post}}$ for $y(t)$. The initial conditions at the impulses are $x(t_{\\text{pre}}^{+}) = 1$ and $y(t_{\\text{post}}^{+}) = 1$, and the traces are causal, $x(t) = 0$ for $t  t_{\\text{pre}}$ and $y(t) = 0$ for $t  t_{\\text{post}}$.\n\nUnder pair-based STDP, the synaptic weight update for a single presynaptic and postsynaptic spike pair is the sum of two local contributions triggered at spike times: a potentiation increment at $t_{\\text{post}}$ proportional to the presynaptic trace magnitude $x(t_{\\text{post}})$ with proportionality coefficient $A_{+}$, and a depression decrement at $t_{\\text{pre}}$ proportional to the postsynaptic trace magnitude $y(t_{\\text{pre}})$ with proportionality coefficient $A_{-}$. Let $\\Delta t = t_{\\text{post}} - t_{\\text{pre}}$.\n\nStarting from these definitions and the differential equations given, derive the closed-form expression for the total weight change $\\Delta w$ for a single pre-post spike pair in terms of $A_{\\pm}$, $\\tau_{\\pm}$, and $\\Delta t$, and evaluate it numerically for $A_{+} = 4.0 \\times 10^{-3}$, $A_{-} = 3.2 \\times 10^{-3}$, $\\tau_{+} = 20\\,\\mathrm{ms}$, $\\tau_{-} = 30\\,\\mathrm{ms}$, and $\\Delta t = 11\\,\\mathrm{ms}$. Determine, based on the sign of $\\Delta w$, whether the synapse potentiates or depresses for this spike timing. Express the synaptic weight change in dimensionless units and round your final numerical answer to four significant figures.",
            "solution": "The problem specifies Spike-Timing-Dependent Plasticity (STDP) implemented via exponentially decaying causal traces $x(t)$ and $y(t)$ that are excited by presynaptic and postsynaptic spikes, respectively. The dynamics are governed by first-order decay with time constants $\\tau_{+}$ for the presynaptic eligibility trace and $\\tau_{-}$ for the postsynaptic trace:\n$$\\frac{d x}{d t} = -\\frac{x}{\\tau_{+}}, \\quad x(t_{\\text{pre}}^{+}) = 1, \\quad x(t) = 0\\ \\text{for}\\ t  t_{\\text{pre}},$$\n$$\\frac{d y}{d t} = -\\frac{y}{\\tau_{-}}, \\quad y(t_{\\text{post}}^{+}) = 1, \\quad y(t) = 0\\ \\text{for}\\ t  t_{\\text{post}}.$$\n\nSolving these linear differential equations with the stated impulsive initial conditions yields the causal exponential solutions\n$$x(t) = \\exp\\left(-\\frac{t - t_{\\text{pre}}}{\\tau_{+}}\\right) H(t - t_{\\text{pre}}), \\quad y(t) = \\exp\\left(-\\frac{t - t_{\\text{post}}}{\\tau_{-}}\\right) H(t - t_{\\text{post}}),$$\nwhere $H(\\cdot)$ is the Heaviside step function enforcing causality.\n\nThe plasticity rule states that the synaptic weight update for a single spike pair is the sum of a potentiation term generated at the postsynaptic spike time (proportional to the presynaptic trace evaluated at that time) and a depression term generated at the presynaptic spike time (proportional to the postsynaptic trace evaluated at that time). Denoting these contributions,\n$$\\Delta w_{\\text{pot}} = A_{+}\\, x(t_{\\text{post}}), \\quad \\Delta w_{\\text{dep}} = -A_{-}\\, y(t_{\\text{pre}}),$$\nthe total weight change is\n$$\\Delta w = \\Delta w_{\\text{pot}} + \\Delta w_{\\text{dep}} = A_{+}\\, x(t_{\\text{post}}) - A_{-}\\, y(t_{\\text{pre}}).$$\n\nWe evaluate $x(t_{\\text{post}})$ and $y(t_{\\text{pre}})$ using the expressions for the traces and the spike timing difference $\\Delta t = t_{\\text{post}} - t_{\\text{pre}}$.\n\nCase $1$: $\\Delta t > 0$ (presynaptic spike precedes postsynaptic spike).\n- At $t = t_{\\text{post}}$, the presynaptic trace is nonzero and given by\n$$x(t_{\\text{post}}) = \\exp\\left(-\\frac{t_{\\text{post}} - t_{\\text{pre}}}{\\tau_{+}}\\right) = \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right).$$\n- At $t = t_{\\text{pre}}$, the postsynaptic trace is zero because the postsynaptic spike has not yet occurred,\n$$y(t_{\\text{pre}}) = 0.$$\nThus, for $\\Delta t > 0$,\n$$\\Delta w(\\Delta t) = A_{+}\\, \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right).$$\n\nCase $2$: $\\Delta t  0$ (postsynaptic spike precedes presynaptic spike).\n- At $t = t_{\\text{post}}$, the presynaptic trace is zero because the presynaptic spike has not yet occurred,\n$$x(t_{\\text{post}}) = 0.$$\n- At $t = t_{\\text{pre}}$, the postsynaptic trace is nonzero and given by\n$$y(t_{\\text{pre}}) = \\exp\\left(-\\frac{t_{\\text{pre}} - t_{\\text{post}}}{\\tau_{-}}\\right) = \\exp\\left(-\\frac{-\\Delta t}{\\tau_{-}}\\right) = \\exp\\left(\\frac{\\Delta t}{\\tau_{-}}\\right),$$\nwhere $\\Delta t/\\tau_{-}  0$ because $\\Delta t  0$, so this equals $\\exp\\left(-\\frac{|\\Delta t|}{\\tau_{-}}\\right)$ in magnitude.\nThus, for $\\Delta t  0$,\n$$\\Delta w(\\Delta t) = -A_{-}\\, \\exp\\left(\\frac{\\Delta t}{\\tau_{-}}\\right).$$\n\nCombining the two cases gives the standard pair-based STDP form derived from the causal trace dynamics:\n$$\n\\Delta w(\\Delta t) =\n\\begin{cases}\nA_{+}\\, \\exp\\left(-\\dfrac{\\Delta t}{\\tau_{+}}\\right),  \\Delta t > 0, \\\\\n- A_{-}\\, \\exp\\left(\\dfrac{\\Delta t}{\\tau_{-}}\\right),  \\Delta t  0, \\\\\n0,  \\Delta t = 0,\n\\end{cases}\n$$\nwhere the $\\Delta t = 0$ case follows because $x(t_{\\text{post}}) = 1$ and $y(t_{\\text{pre}}) = 1$ occur simultaneously but the incremental updates cancel only if $A_{+} = A_{-}$; however, with strictly simultaneous spikes in this trace-triggered scheme, the separation into distinct triggers can be device-specific. In this problem, we consider the given nonzero $\\Delta t$.\n\nWe now evaluate numerically for $A_{+} = 4.0 \\times 10^{-3}$, $A_{-} = 3.2 \\times 10^{-3}$, $\\tau_{+} = 20\\,\\mathrm{ms}$, $\\tau_{-} = 30\\,\\mathrm{ms}$, and $\\Delta t = 11\\,\\mathrm{ms}$. Since $\\Delta t > 0$, we use\n$$\\Delta w = A_{+}\\, \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right) = \\left(4.0 \\times 10^{-3}\\right) \\exp\\left(-\\frac{11\\,\\mathrm{ms}}{20\\,\\mathrm{ms}}\\right).$$\nCompute the exponent:\n$$-\\frac{11\\,\\mathrm{ms}}{20\\,\\mathrm{ms}} = -0.55.$$\nThus,\n$$\\Delta w = \\left(4.0 \\times 10^{-3}\\right)\\, \\exp(-0.55).$$\nKeeping the numerical evaluation to the final step, then evaluate $\\exp(-0.55)$:\n$$\\exp(-0.55) \\approx 0.576949810.$$\nTherefore,\n$$\\Delta w \\approx \\left(4.0 \\times 10^{-3}\\right) \\times 0.576949810 = 2.30779924 \\times 10^{-3}.$$\nRounding to four significant figures gives\n$$\\Delta w \\approx 0.002308.$$\n\nBecause $\\Delta w > 0$, the synapse potentiates for $\\Delta t = 11\\,\\mathrm{ms}$ in this pair-based interaction. The requested final answer is the dimensionless synaptic weight change rounded to four significant figures.",
            "answer": "$$\\boxed{0.002308}$$"
        },
        {
            "introduction": "To build neuromorphic hardware, abstract concepts like synaptic weight must be mapped onto physical device properties. This practice explores how a Ferroelectric Field-Effect Transistor (FeFET), a promising emerging memory device, can serve as an analog synapse. You will connect the device physics of ferroelectric polarization switching to the modulation of the transistor's transconductance, which represents the synaptic weight, providing a concrete example of a hardware-level implementation of plasticity. ",
            "id": "4290315",
            "problem": "A ferroelectric field-effect transistor (FeFET) used as a neuromorphic synapse is biased in the saturation regime, where the metal-oxide-semiconductor field-effect transistor (MOSFET) drain current obeys the well-tested square-law approximation for long-channel devices. The gate stack includes a ferroelectric layer of thickness $t_{\\mathrm{FE}}$ in series with a conventional dielectric, and the ferroelectric polarization $P$ modulates the effective threshold voltage $V_{T}$ via the fundamental charge-capacitance relation for a planar capacitor.\n\nAssume the following physically grounded starting points:\n- Saturation-region drain current: $$I_{D} = \\frac{1}{2}\\,\\mu\\,C_{\\mathrm{ox}}\\,\\frac{W}{L}\\,\\left(V_{G}-V_{T}\\right)^{2},$$ where $\\mu$ is the carrier mobility, $C_{\\mathrm{ox}}$ is the gate capacitance per unit area, $W/L$ is the device geometry factor, $V_{G}$ is the gate bias, and $V_{T}$ is the threshold voltage.\n- Transconductance definition at fixed drain bias: $$g_{m} \\equiv \\frac{\\partial I_{D}}{\\partial V_{G}} = \\mu\\,C_{\\mathrm{ox}}\\,\\frac{W}{L}\\,\\left(V_{G}-V_{T}\\right).$$\n- Ferroelectric threshold modulation due to polarization charge at the interface: $$\\Delta V_{T} = -\\frac{P}{C_{\\mathrm{ox}}},$$ which follows from Gauss’s law and the series-capacitor charge continuity assuming ideal coupling of the ferroelectric interfacial bound charge into the channel charge control.\n- First-order ferroelectric polarization dynamics under a constant field during a pulse of width $\\tau_{p}$: $$\\frac{dP}{dt} = \\frac{P_{\\infty}(E)-P}{\\tau_{0}},\\quad P_{\\infty}(E) = P_{s}\\,\\tanh\\!\\left(\\frac{E}{E_{c}}\\right),$$ where $P_{s}$ is the spontaneous polarization magnitude, $E$ is the applied electric field across the ferroelectric, $E_{c}$ is a characteristic field scale, and $\\tau_{0}$ is a characteristic relaxation time. Over a single rectangular pulse, the polarization update is $$P^{+} = P^{-} + \\left(1-\\exp\\!\\left(-\\frac{\\tau_{p}}{\\tau_{0}}\\right)\\right)\\left(P_{\\infty}(E)-P^{-}\\right),$$ where $P^{-}$ and $P^{+}$ denote pre- and post-pulse polarization.\n\nA train of $3$ identical potentiation pulses is applied to the gate to strengthen the synapse. The pulses are separated sufficiently that there is negligible depolarization between pulses. The device and pulse parameters are:\n- $\\mu = 0.020\\ \\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}$,\n- $C_{\\mathrm{ox}} = 1.5\\ \\mathrm{F\\,m^{-2}}$,\n- $W/L = 5$,\n- $V_{G} = 0.80\\ \\mathrm{V}$,\n- initial threshold $V_{T,0} = 0.30\\ \\mathrm{V}$,\n- $t_{\\mathrm{FE}} = 10\\ \\mathrm{nm}$,\n- $P_{s} = 0.20\\ \\mathrm{C\\,m^{-2}}$,\n- $E_{c} = 2.0\\times 10^{8}\\ \\mathrm{V\\,m^{-1}}$,\n- $\\tau_{0} = 10\\ \\mathrm{ns}$,\n- pulse amplitude $V_{p} = 2.0\\ \\mathrm{V}$,\n- pulse width $\\tau_{p} = 20\\ \\mathrm{ns}$,\n- initial polarization $P_{0} = 0$.\n\nThe synaptic weight update is defined as the normalized fractional change in transconductance relative to the baseline: $$\\Delta w \\equiv \\frac{\\Delta g_{m}}{g_{m,0}},\\quad g_{m,0} = \\mu\\,C_{\\mathrm{ox}}\\,\\frac{W}{L}\\,\\left(V_{G}-V_{T,0}\\right).$$\n\nStarting only from the stated principles, compute the transconductance change $\\Delta g_{m}$ after the $3$-pulse train and the resulting synaptic weight update $\\Delta w$. Express the transconductance change in siemens (S) and the synaptic weight update as a dimensionless decimal. Round your answers to four significant figures.",
            "solution": "The objective is to calculate the change in transconductance, $\\Delta g_{m}$, and the corresponding synaptic weight update, $\\Delta w$, after applying a train of $3$ identical voltage pulses.\n\nFirst, we compute the constant pre-factor for the transconductance, which we denote as $K$:\n$$K = \\mu\\,C_{\\mathrm{ox}}\\,\\frac{W}{L} = (0.020\\ \\mathrm{m^{2}\\,V^{-1}\\,s^{-1}}) \\times (1.5\\ \\mathrm{F\\,m^{-2}}) \\times 5 = 0.15\\ \\mathrm{S\\,V^{-1}}$$\nThe unit is Siemens per Volt ($\\mathrm{S\\,V^{-1}}$), which is equivalent to Ampere per Volt-squared ($\\mathrm{A\\,V^{-2}}$), as expected for the pre-factor of $(V_{G}-V_{T})$.\n\nNext, we calculate the baseline transconductance, $g_{m,0}$, corresponding to the initial state of the device where the polarization $P_0 = 0$ and the threshold voltage is $V_{T,0}$.\n$$g_{m,0} = K \\left(V_{G}-V_{T,0}\\right) = (0.15\\ \\mathrm{S\\,V^{-1}}) \\times (0.80\\ \\mathrm{V} - 0.30\\ \\mathrm{V}) = 0.15 \\times 0.50 = 0.075\\ \\mathrm{S}$$\n\nThe core of the problem lies in determining the final polarization, $P_3$, after $3$ pulses. The polarization evolves according to the update rule:\n$P_{n} = P_{n-1} + \\left(1-\\exp\\left(-\\frac{\\tau_{p}}{\\tau_{0}}\\right)\\right)\\left(P_{\\infty}(E)-P_{n-1}\\right)$, where $P_n$ is the polarization after the $n$-th pulse.\nLet $\\alpha = 1 - \\exp(-\\tau_p/\\tau_0)$. The update rule is $P_n = (1-\\alpha)P_{n-1} + \\alpha P_{\\infty}(E)$. Starting with $P_0 = 0$, the polarization after $n$ pulses is given by the general solution to this recurrence relation:\n$$P_{n} = P_{\\infty}(E)\\left(1 - (1-\\alpha)^{n}\\right) = P_{\\infty}(E)\\left(1 - \\left(\\exp\\left(-\\frac{\\tau_{p}}{\\tau_{0}}\\right)\\right)^{n}\\right) = P_{\\infty}(E)\\left(1 - \\exp\\left(-n\\frac{\\tau_{p}}{\\tau_{0}}\\right)\\right)$$\n\nWe must first compute the terms $P_{\\infty}(E)$ and the exponential factor. The electric field $E$ across the ferroelectric layer during a pulse is:\n$$E = \\frac{V_{p}}{t_{\\mathrm{FE}}} = \\frac{2.0\\ \\mathrm{V}}{10 \\times 10^{-9}\\ \\mathrm{m}} = 2.0 \\times 10^{8}\\ \\mathrm{V\\,m^{-1}}$$\nThe asymptotic polarization $P_{\\infty}(E)$ is:\n$$P_{\\infty}(E) = P_{s}\\,\\tanh\\left(\\frac{E}{E_{c}}\\right) = (0.20\\ \\mathrm{C\\,m^{-2}}) \\times \\tanh\\left(\\frac{2.0 \\times 10^{8}\\ \\mathrm{V\\,m^{-1}}}{2.0 \\times 10^{8}\\ \\mathrm{V\\,m^{-1}}}\\right) = 0.20 \\times \\tanh(1)\\ \\mathrm{C\\,m^{-2}}$$\nNow, we calculate the final polarization $P_3$ after $n=3$ pulses. The time-constant ratio is $\\tau_{p}/\\tau_{0} = (20\\ \\mathrm{ns}) / (10\\ \\mathrm{ns}) = 2$.\n$$P_3 = P_{\\infty}(E) \\left(1 - \\exp\\left(-3 \\times 2\\right)\\right) = \\left(0.20 \\times \\tanh(1)\\right) \\left(1 - \\exp(-6)\\right)\\ \\mathrm{C\\,m^{-2}}$$\nUsing $\\tanh(1) \\approx 0.761594$ and $\\exp(-6) \\approx 0.002479$, we get:\n$$P_3 \\approx (0.20 \\times 0.761594) \\times (1 - 0.002479) \\approx 0.152319 \\times 0.997521 \\approx 0.151942\\ \\mathrm{C\\,m^{-2}}$$\n\nThe final polarization $P_3$ causes a shift in the threshold voltage. The total change from the initial state is $\\Delta V_{T, \\text{final}} = -P_3 / C_{\\mathrm{ox}}$. The final threshold voltage, $V_{T,f}$, is:\n$$V_{T,f} = V_{T,0} + \\Delta V_{T, \\text{final}} = V_{T,0} - \\frac{P_3}{C_{\\mathrm{ox}}}$$\n$$V_{T,f} \\approx 0.30\\ \\mathrm{V} - \\frac{0.151942\\ \\mathrm{C\\,m^{-2}}}{1.5\\ \\mathrm{F\\,m^{-2}}} \\approx 0.30\\ \\mathrm{V} - 0.101295\\ \\mathrm{V} = 0.198705\\ \\mathrm{V}$$\nNote that the units are consistent: $\\mathrm{C\\,m^{-2} / F\\,m^{-2}} = \\mathrm{C/F} = \\mathrm{C/(C/V)} = \\mathrm{V}$.\n\nWith the final threshold voltage, we can compute the final transconductance, $g_{m,f}$:\n$$g_{m,f} = K \\left(V_{G}-V_{T,f}\\right) \\approx (0.15\\ \\mathrm{S\\,V^{-1}}) \\times (0.80\\ \\mathrm{V} - 0.198705\\ \\mathrm{V})$$\n$$g_{m,f} \\approx 0.15 \\times 0.601295 = 0.090194\\ \\mathrm{S}$$\n\nThe change in transconductance, $\\Delta g_{m}$, is the difference between the final and initial values:\n$$\\Delta g_{m} = g_{m,f} - g_{m,0} \\approx 0.090194\\ \\mathrm{S} - 0.075\\ \\mathrm{S} = 0.015194\\ \\mathrm{S}$$\nRounding to four significant figures, $\\Delta g_m = 0.01519\\ \\mathrm{S}$.\n\nFinally, we compute the synaptic weight update, $\\Delta w$, defined as the normalized fractional change in transconductance:\n$$\\Delta w = \\frac{\\Delta g_{m}}{g_{m,0}} \\approx \\frac{0.015194\\ \\mathrm{S}}{0.075\\ \\mathrm{S}} \\approx 0.20259$$\nAlternatively, we can express $\\Delta w$ symbolically:\n$$\\Delta w = \\frac{g_{m,f} - g_{m,0}}{g_{m,0}} = \\frac{K(V_G - V_{T,f}) - K(V_G - V_{T,0})}{K(V_G - V_{T,0})} = \\frac{V_{T,0} - V_{T,f}}{V_G - V_{T,0}} = \\frac{P_3/C_{\\mathrm{ox}}}{V_G - V_{T,0}}$$\n$$\\Delta w \\approx \\frac{0.101295\\ \\mathrm{V}}{0.50\\ \\mathrm{V}} \\approx 0.20259$$\nRounding to four significant figures, $\\Delta w = 0.2026$.\n\nThe results are a transconductance change of $\\Delta g_m \\approx 0.01519\\ \\mathrm{S}$ and a synaptic weight update of $\\Delta w \\approx 0.2026$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01519  0.2026 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A major driver for neuromorphic computing is the promise of vastly improved energy efficiency for tasks like pattern recognition. This exercise elevates the perspective from a single device to a system-level analysis of a resistive crossbar array, a common architecture for performing matrix-vector multiplications. You will derive a closed-form expression for the energy consumed per multiply-accumulate (MAC) operation, a critical figure of merit for assessing the practical viability and performance of neuromorphic accelerators. ",
            "id": "4290347",
            "problem": "Consider a resistive crossbar array in a neuromorphic accelerator where each synapse is implemented by a programmable two-terminal device whose conductance encodes the synaptic weight. Let the crossbar have $M$ input rows and $N$ output columns, with the conductance at the crosspoint connecting input row $i$ to output column $j$ denoted by $G_{j i}$. An input vector with voltage entries $\\{x_{i}\\}_{i=1}^{M}$ is applied to the rows, and the columns are each terminated by an identical capacitive sense element of capacitance $C_{c}$ that is fully discharged prior to each vector-matrix multiply.\n\nAssume the following physically grounded relationships:\n- Ohm’s law for each synapse: the synaptic current contributed from row $i$ to column $j$ is $I_{j i}=G_{j i}\\,x_{i}$.\n- The column current is the sum of synaptic currents into that column, so the net column current is $I_{j}=\\sum_{i=1}^{M}G_{j i}\\,x_{i}$.\n- The column sense circuit integrates this current onto the capacitance $C_{c}$ over a fixed compute window and is gain-normalized so that the final column voltage equals the arithmetic output of the vector-matrix multiply. In other words, the implemented computation is $y=G\\,x$, and the final column voltage is $y_{j}=\\sum_{i=1}^{M}G_{j i}\\,x_{i}$.\n- The dynamic switching energy per column to charge from $0$ to a final voltage $V$ and then reset (one full compute cycle) is given by $E=C\\,V^{2}$.\n\nUnder these assumptions, define the energy per multiply-accumulate (Multiply-Accumulate (MAC)) operation as the total dynamic switching energy summed over all $N$ columns divided by the total number of synaptic MACs, which is $M\\,N$. Derive a closed-form expression for the energy per MAC in terms of $C_{c}$, $\\{G_{j i}\\}$, and $\\{x_{i}\\}$. Express your final answer as a single analytic expression. No numerical evaluation is required.",
            "solution": "The energy per Multiply-Accumulate (MAC) operation, denoted as $E_{\\text{MAC}}$, is defined as the total dynamic switching energy, $E_{\\text{total}}$, divided by the total number of MAC operations, $N_{\\text{MAC}}$.\n$$E_{\\text{MAC}} = \\frac{E_{\\text{total}}}{N_{\\text{MAC}}}$$\nThe total number of MACs in an $M \\times N$ vector-matrix multiplication is the product of the dimensions.\n$$N_{\\text{MAC}} = M\\,N$$\nThe total dynamic switching energy, $E_{\\text{total}}$, is the sum of the individual energies consumed by each of the $N$ columns during one compute cycle.\n$$E_{\\text{total}} = \\sum_{j=1}^{N} E_{\\text{col}, j}$$\nwhere $E_{\\text{col}, j}$ is the energy for the $j$-th column.\n\nThe problem states that the dynamic switching energy for a single column to charge to a final voltage $V$ and then reset is given by $E = C\\,V^{2}$. For the $j$-th column, the capacitance is $C_c$ and the final voltage is $y_j$. Therefore, the energy for the $j$-th column is:\n$$E_{\\text{col}, j} = C_{c} (y_j)^2$$\nThe problem specifies that the final column voltage $y_j$ is the result of the vector-matrix multiplication for that column:\n$$y_{j} = \\sum_{i=1}^{M} G_{j i}\\,x_{i}$$\nSubstituting this expression for $y_j$ into the equation for the column energy gives:\n$$E_{\\text{col}, j} = C_{c} \\left( \\sum_{i=1}^{M} G_{j i}\\,x_{i} \\right)^2$$\nNow, we can find the total energy, $E_{\\text{total}}$, by summing the energies of all $N$ columns:\n$$E_{\\text{total}} = \\sum_{j=1}^{N} E_{\\text{col}, j} = \\sum_{j=1}^{N} C_{c} \\left( \\sum_{i=1}^{M} G_{j i}\\,x_{i} \\right)^2$$\nSince the capacitance $C_c$ is identical for all columns, it is a constant factor and can be moved outside the summation over $j$:\n$$E_{\\texttotal}} = C_{c} \\sum_{j=1}^{N} \\left( \\sum_{i=1}^{M} G_{j i}\\,x_{i} \\right)^2$$\nFinally, we substitute the expressions for $E_{\\text{total}}$ and $N_{\\text{MAC}}$ into the definition of the energy per MAC:\n$$E_{\\text{MAC}} = \\frac{C_{c} \\sum_{j=1}^{N} \\left( \\sum_{i=1}^{M} G_{j i}\\,x_{i} \\right)^2}{M\\,N}$$\nThis is the final closed-form expression for the energy per MAC in terms of the given quantities $C_c$, $\\{G_{j i}\\}$, $\\{x_i\\}$, and the dimensions $M$ and $N$.",
            "answer": "$$\\boxed{\\frac{C_{c} \\sum_{j=1}^{N} \\left( \\sum_{i=1}^{M} G_{j i}\\,x_{i} \\right)^2}{M\\,N}}$$"
        }
    ]
}