{
    "hands_on_practices": [
        {
            "introduction": "在深入研究量子隧穿之前，我们必须首先理解其发生的经典静电学环境。本练习旨在巩固对p-n结耗尽区的理解，该区域构成了隧道场效应晶体管（TFET）中隧穿的物理势垒。通过计算耗尽区宽度，我们将确定影响晶体管性能的关键参数——有效隧穿距离。",
            "id": "4310548",
            "problem": "隧穿场效应晶体管（TFET）由一个重掺杂的源极和一个轻掺杂的沟道组成，形成单个半导体的突变结。考虑一个在室温下工作的一维、突变、平面的硅源-沟道结。源极为均匀的p型，受主密度为 $N_{A} = 3.0 \\times 10^{19}\\ \\mathrm{cm}^{-3}$，沟道为均匀的n型，施主密度为 $N_{D} = 1.0 \\times 10^{17}\\ \\mathrm{cm}^{-3}$。器件温度为 $T = 300\\ \\mathrm{K}$，硅的本征载流子浓度为 $n_{i} = 1.0 \\times 10^{10}\\ \\mathrm{cm}^{-3}$。硅的相对介电常数为 $\\epsilon_{r} = 11.7$，自由空间的介电常数为 $\\epsilon_{0} = 8.854187817 \\times 10^{-14}\\ \\mathrm{F/cm}$。元电荷为 $q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。由于栅极静电学作用，该结承受 $V_{R} = 0.25\\ \\mathrm{V}$ 的反向偏压。\n\n使用物理上一致的耗尽近似，并从具有适当边界和连续性条件的泊松方程出发，计算在等于内建电势加上所施加反向偏压的总电势降下，源-沟道结的总耗尽宽度 $W$。将最终的耗尽宽度表示为有效隧穿距离。假设没有固定的界面电荷，并且电位移在冶金结处是连续的。\n\n将最终数值答案四舍五入到三位有效数字，并以纳米为单位表示。",
            "solution": "该问题要求计算在室温下，一个一维、突变的硅p-n结在反向偏压下的总耗尽宽度，并将其解释为有效隧穿距离。解决方案需要应用耗尽近似来求解泊松方程，以得到结上的静电势和电场。\n\n### 第1步：问题验证\n\n**1. 提取给定条件：**\n- 半导体：硅 (Si)\n- 结类型：突变、平面、一维\n- 源极掺杂 (p型)：受主密度，$N_{A} = 3.0 \\times 10^{19}\\ \\mathrm{cm}^{-3}$\n- 沟道掺杂 (n型)：施主密度，$N_{D} = 1.0 \\times 10^{17}\\ \\mathrm{cm}^{-3}$\n- 温度：$T = 300\\ \\mathrm{K}$\n- 本征载流子浓度：$n_{i} = 1.0 \\times 10^{10}\\ \\mathrm{cm}^{-3}$\n- 硅的相对介电常数：$\\epsilon_{r} = 11.7$\n- 自由空间介电常数：$\\epsilon_{0} = 8.854187817 \\times 10^{-14}\\ \\mathrm{F/cm}$\n- 元电荷：$q = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n- 施加的反向偏压：$V_{R} = 0.25\\ \\mathrm{V}$\n\n**2. 使用提取的给定条件进行验证：**\n- **科学依据**：该问题基于半导体中p-n结的标准、成熟模型，并使用了耗尽近似。该模型是半导体器件物理学的基石。提供的材料属性（硅）和物理常数值是准确和标准的。TFET的背景是合适的，因为耗尽宽度从根本上决定了带间隧穿过程。\n- **适定性**：该问题提供了计算耗尽宽度 $W$ 唯一值所需的所有必要参数（$N_A, N_D, \\epsilon_{Si}, V_R, T, n_i, q$）。问题是具体的，可以从给定信息中推导出答案。\n- **客观性**：问题以精确、定量和客观的语言陈述，没有歧义或主观性陈述。\n- **结论**：该问题在科学上是合理的、适定的、客观的和完整的。这是半导体器件物理学中的一个有效问题。\n\n### 第2步：耗尽宽度的推导\n\n分析从泊松方程开始，该方程将静电势 $\\phi$ 与净电荷密度 $\\rho$ 联系起来：\n$$ \\frac{d^2\\phi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon_{Si}} $$\n其中 $\\epsilon_{Si} = \\epsilon_r \\epsilon_0$ 是硅的介电常数。\n\n在耗尽近似下，我们假设在冶金结 $x=0$ 周围宽度为 $W = x_p + x_n$ 的区域内，移动载流子（电子和空穴）被完全耗尽。因此，空间电荷密度 $\\rho(x)$ 完全由离化的掺杂原子决定：\n$$ \\rho(x) = \\begin{cases} -q N_A & \\text{for } -x_p  x  0 \\quad (\\text{p-side}) \\\\ +q N_D  \\text{for } 0  x  x_n \\quad (\\text{n-side}) \\\\ 0  \\text{otherwise} \\end{cases} $$\n此处，$x_p$ 和 $x_n$ 分别是耗尽区延伸到p型和n型材料中的宽度。\n\n将电荷密度代入泊松方程得到：\n$$ \\frac{d^2\\phi}{dx^2} = \\frac{q N_A}{\\epsilon_{Si}} \\quad \\text{for } -x_p  x  0 $$\n$$ \\frac{d^2\\phi}{dx^2} = -\\frac{q N_D}{\\epsilon_{Si}} \\quad \\text{for } 0  x  x_n $$\n\n电场为 $E(x) = -d\\phi/dx$。将上述方程对 $x$ 积分一次即可得到电场。我们应用边界条件，即在耗尽区的边缘电场必须为零，即 $E(-x_p) = 0$ 和 $E(x_n) = 0$。\n\n对于p区 ($-x_p  x  0$)：\n$$ E(x) = -\\int_{-x_p}^{x} \\frac{q N_A}{\\epsilon_{Si}} dx' = -\\frac{q N_A}{\\epsilon_{Si}}(x+x_p) $$\n对于n区 ($0  x  x_n$)：\n$$ E(x) = E(0) - \\int_{0}^{x} \\left(-\\frac{q N_D}{\\epsilon_{Si}}\\right) dx' = E(0) + \\frac{q N_D}{\\epsilon_{Si}}x $$\n使用条件 $E(x_n)=0$，我们得到 $E(0) = -\\frac{q N_D x_n}{\\epsilon_{Si}}$。因此，对于n区：\n$$ E(x) = \\frac{q N_D}{\\epsilon_{Si}}(x-x_n) $$\n电位移场 $D = \\epsilon_{Si} E$ 在结的 $x=0$ 处必须是连续的。由于 $\\epsilon_{Si}$ 是常数，电场 $E$ 也必须是连续的。令 $x=0$ 处的 $E(x)$ 表达式相等：\n$$ -\\frac{q N_A}{\\epsilon_{Si}}(0+x_p) = \\frac{q N_D}{\\epsilon_{Si}}(0-x_n) $$\n$$ -q N_A x_p = -q N_D x_n \\implies N_A x_p = N_D x_n $$\n这个结果表达了电荷中性条件：p区耗尽区中的总负电荷等于n区耗尽区中的总正电荷。\n\n总耗尽宽度为 $W = x_p + x_n$。利用电荷中性条件，我们可以用 $W$ 来表示 $x_p$ 和 $x_n$：\n$$ x_p = W \\frac{N_D}{N_A + N_D} \\quad \\text{and} \\quad x_n = W \\frac{N_A}{N_A + N_D} $$\n\n结上的总电势降 $V_{tot}$ 是内建电势 $V_{bi}$ 和所施加反向偏压 $V_R$ 的和。该电势降通过对整个耗尽区的电场进行积分得到：\n$$ V_{tot} = V_{bi} + V_R = -\\int_{-x_p}^{x_n} E(x) dx $$\n$$ V_{tot} = -\\left[ \\int_{-x_p}^{0} -\\frac{q N_A}{\\epsilon_{Si}}(x+x_p) dx + \\int_{0}^{x_n} \\frac{q N_D}{\\epsilon_{Si}}(x-x_n) dx \\right] $$\n$$ V_{tot} = \\frac{q N_A}{\\epsilon_{Si}} \\left[ \\frac{x^2}{2} + x_p x \\right]_{-x_p}^{0} - \\frac{q N_D}{\\epsilon_{Si}} \\left[ \\frac{x^2}{2} - x_n x \\right]_{0}^{x_n} $$\n$$ V_{tot} = \\frac{q N_A}{\\epsilon_{Si}} \\left( \\frac{x_p^2}{2} \\right) - \\frac{q N_D}{\\epsilon_{Si}} \\left( -\\frac{x_n^2}{2} \\right) = \\frac{q}{2\\epsilon_{Si}} (N_A x_p^2 + N_D x_n^2) $$\n将 $x_p$ 和 $x_n$ 的表达式用 $W$ 代入：\n$$ V_{tot} = \\frac{q}{2\\epsilon_{Si}} \\left[ N_A \\left( W\\frac{N_D}{N_A+N_D} \\right)^2 + N_D \\left( W\\frac{N_A}{N_A+N_D} \\right)^2 \\right] $$\n$$ V_{tot} = \\frac{q W^2}{2\\epsilon_{Si}(N_A+N_D)^2} [N_A N_D^2 + N_D N_A^2] = \\frac{q W^2 N_A N_D}{2\\epsilon_{Si}(N_A+N_D)} $$\n求解总耗尽宽度 $W$：\n$$ W = \\sqrt{\\frac{2 \\epsilon_{Si} (V_{bi} + V_R)}{q} \\left( \\frac{N_A+N_D}{N_A N_D} \\right)} = \\sqrt{\\frac{2 \\epsilon_{Si} (V_{bi} + V_R)}{q} \\left( \\frac{1}{N_A} + \\frac{1}{N_D} \\right)} $$\n\n### 第3步：数值计算\n\n首先，我们计算内建电势 $V_{bi}$：\n$$ V_{bi} = \\frac{k_B T}{q} \\ln\\left(\\frac{N_A N_D}{n_i^2}\\right) $$\n在 $T=300\\ \\mathrm{K}$ 时，热电压为 $V_T = k_B T / q \\approx 0.025852\\ \\mathrm{V}$。\n$$ V_{bi} = (0.025852\\ \\mathrm{V}) \\ln\\left(\\frac{(3.0 \\times 10^{19}\\ \\mathrm{cm}^{-3})(1.0 \\times 10^{17}\\ \\mathrm{cm}^{-3})}{(1.0 \\times 10^{10}\\ \\mathrm{cm}^{-3})^2}\\right) $$\n$$ V_{bi} = (0.025852\\ \\mathrm{V}) \\ln(3.0 \\times 10^{16}) \\approx (0.025852\\ \\mathrm{V})(37.9402) \\approx 0.98086\\ \\mathrm{V} $$\n结上的总电势为：\n$$ V_{tot} = V_{bi} + V_R = 0.98086\\ \\mathrm{V} + 0.25\\ \\mathrm{V} = 1.23086\\ \\mathrm{V} $$\n接下来，我们计算硅的介电常数：\n$$ \\epsilon_{Si} = \\epsilon_r \\epsilon_0 = 11.7 \\times (8.854187... \\times 10^{-14}\\ \\mathrm{F/cm}) \\approx 1.03595 \\times 10^{-12}\\ \\mathrm{F/cm} $$\n现在我们整理用于计算 $W$ 的各项：\n$$ \\frac{1}{N_A} + \\frac{1}{N_D} = \\frac{1}{3.0 \\times 10^{19}\\ \\mathrm{cm}^{-3}} + \\frac{1}{1.0 \\times 10^{17}\\ \\mathrm{cm}^{-3}} $$\n$$ \\frac{1}{N_A} + \\frac{1}{N_D} \\approx (3.333 \\times 10^{-20} + 1.0 \\times 10^{-17})\\ \\mathrm{cm}^3 = 1.00333 \\times 10^{-17}\\ \\mathrm{cm}^3 $$\n现在，我们将所有值代入 $W$ 的方程中：\n$$ W^2 = \\frac{2 (1.03595 \\times 10^{-12}\\ \\mathrm{F/cm}) (1.23086\\ \\mathrm{V})}{1.602177 \\times 10^{-19}\\ \\mathrm{C}} \\left( 1.00333 \\times 10^{-17}\\ \\mathrm{cm}^3 \\right) $$\n$$ W^2 \\approx \\frac{2.5500 \\times 10^{-12}\\ \\mathrm{F \\cdot V/cm}}{1.602177 \\times 10^{-19}\\ \\mathrm{C}} (1.00333 \\times 10^{-17}\\ \\mathrm{cm}^3) $$\n$$ W^2 \\approx (1.59158 \\times 10^7\\ \\mathrm{cm^3/F \\cdot V}) \\cdot \\frac{\\mathrm{F \\cdot V}}{\\mathrm{C}} \\cdot \\frac{1}{\\mathrm{cm}} \\cdot (1.00333 \\times 10^{-17}\\ \\mathrm{cm}^3) $$\n认识到 $\\mathrm{F} \\cdot \\mathrm{V} = \\mathrm{C}$，单位合并为 $\\mathrm{cm}^2$。\n$$ W^2 \\approx (1.59158 \\times 10^7) (1.00333 \\times 10^{-17})\\ \\mathrm{cm}^2 \\approx 1.59688 \\times 10^{-10}\\ \\mathrm{cm}^2 $$\n取平方根求得 $W$：\n$$ W = \\sqrt{1.59688 \\times 10^{-10}\\ \\mathrm{cm}^2} \\approx 1.2637 \\times 10^{-5}\\ \\mathrm{cm} $$\n问题要求答案以纳米为单位 ($1\\ \\mathrm{cm} = 10^7\\ \\mathrm{nm}$):\n$$ W \\approx (1.2637 \\times 10^{-5}) \\times 10^7\\ \\mathrm{nm} \\approx 126.37\\ \\mathrm{nm} $$\n四舍五入到三位有效数字，总耗尽宽度为 $126\\ \\mathrm{nm}$。该值代表了在指定条件下的有效隧穿距离。",
            "answer": "$$\n\\boxed{126}\n$$"
        },
        {
            "introduction": "TFET工作的核心是量子力学的带间隧穿。本练习将带领我们从经典静电学进入量子力学领域，使用温策尔-克拉默斯-布里渊（WKB）近似来分析势垒形状对隧穿概率的影响。通过解析地比较一个实际的梯形势垒与一个理想化的三角形势垒，您将对常用理论模型的有效性以及控制隧穿速率的物理学原理获得深刻的见解。",
            "id": "4310596",
            "problem": "考虑隧穿场效应晶体管 (TFET) 的源-沟道结上发生的一维带间隧穿事件。设能量势垒由一个空间变化的势能 $U(x)$ 表示，单位为焦耳，其中 $x$ 是输运坐标。假设隧穿发生在足够低的注入能量下，因此相对于势垒的入射载流子能量为 $E=0$。隧穿的相关质量是电子-空穴系统的约化有效质量 $m_{r}$。普朗克常数除以 $2\\pi$ 为 $\\hbar$。\n\n假设源区边缘的势垒高度为 $U(0)=E_{g}$，其中 $E_{g}0$ 是半导体带隙能量，并且势垒在沟道边缘 $x=L$ 处减小到零，即对于某个固定的 $L0$，有 $U(L)=0$。考虑两种势垒形状：\n\n1. 梯形势垒，具有两个不同的线性段，反映了源区侧和沟道区侧的不同电场。定义源区侧和沟道区侧的能量空间斜率 $S_{s}0$ 和 $S_{c}0$，且 $S_{s} \\neq S_{c}$ 和 $S_{s}S_{c}$。势垒为\n$$\nU(x)=\n\\begin{cases}\nE_{g}-S_{s} x,  0 \\leq x \\leq \\ell_{s}, \\\\\nE_{g}-S_{s} \\ell_{s}-S_{c} (x-\\ell_{s}),  \\ell_{s} \\leq x \\leq L,\n\\end{cases}\n$$\n其中 $\\ell_{s}$ 是源区段长度，$\\ell_{c}=L-\\ell_{s}$ 是沟道区段长度。物理一致性要求 $E_{g}=S_{s}\\ell_{s}+S_{c}\\ell_{c}$ 且 $\\ell_{s},\\ell_{c}0$。在所述约束条件下，$\\ell_{s}$ 和 $\\ell_{c}$ 由 $E_{g}$、$L$、$S_{s}$ 和 $S_{c}$ 唯一确定。\n\n2. 三角形势垒近似，使用单个均匀斜率 $S_{t}$，选择该斜率以精确匹配端点 $(x,U)=(0,E_{g})$ 和 $(x,U)=(L,0)$：\n$$\nU_{t}(x)=E_{g}-S_{t} x, \\quad S_{t}=\\frac{E_{g}}{L}, \\quad 0 \\leq x \\leq L.\n$$\n\n使用源于不含时 Schrödinger 方程的半经典 Wentzel–Kramers–Brillouin (WKB) 近似，隧穿通过一维势垒的透射概率为 $T \\approx \\exp\\!\\left(-2 \\int \\kappa(x) \\, dx\\right)$，其中在 $U(x)E$ 的经典禁区内，$\\kappa(x)=\\sqrt{2 m_{r} \\left(U(x)-E\\right)}/\\hbar$。对上述每种势垒形状，计算 WKB 透射概率 $T_{\\mathrm{trap}}$ 和 $T_{\\mathrm{tri}}$，并将三角形近似的相对误差定义为\n$$\n\\delta \\equiv \\frac{T_{\\mathrm{tri}}-T_{\\mathrm{trap}}}{T_{\\mathrm{trap}}}.\n$$\n\n推导 $\\delta$ 关于 $E_{g}$、$L$、$S_{s}$、$S_{c}$、$m_{r}$ 和 $\\hbar$ 的闭式解析表达式。你的最终答案必须是单个解析表达式。假设 $S_{s} L > E_{g} > S_{c} L$。",
            "solution": "用户希望求解在 TFET 中计算量子隧穿透射概率时，使用三角形势垒近似替代梯形势垒所产生的相对误差 $\\delta$。计算将使用 Wentzel–Kramers–Brillouin (WKB) 近似进行。\n\n能量为 $E$ 的粒子隧穿通过势垒 $U(x)$ 的 WKB 透射概率 $T$ 由下式给出\n$$\nT \\approx \\exp\\left( -2 \\int_{x_1}^{x_2} \\kappa(x) \\, dx \\right)\n$$\n其中 $\\kappa(x) = \\sqrt{2 m_{r} (U(x)-E)}/\\hbar$，$[x_1, x_2]$ 是 $U(x)  E$ 的经典禁区。在本问题中，入射载流子能量为 $E=0$，约化有效质量为 $m_r$。势垒从 $x=0$ 延伸到 $x=L$，对于 $x \\in [0,L)$ 有 $U(x)0$，且 $U(L)=0$。因此，积分上下限为 $0$ 和 $L$。指数参数（我们记为 $W$）由下式给出：\n$$\nW = 2 \\int_{0}^{L} \\frac{\\sqrt{2 m_{r} U(x)}}{\\hbar} \\, dx = \\frac{2\\sqrt{2 m_{r}}}{\\hbar} \\int_{0}^{L} \\sqrt{U(x)} \\, dx\n$$\n透射概率为 $T = \\exp(-W)$。相对误差定义为\n$$\n\\delta = \\frac{T_{\\mathrm{tri}}-T_{\\mathrm{trap}}}{T_{\\mathrm{trap}}} = \\frac{\\exp(-W_{\\mathrm{tri}})}{\\exp(-W_{\\mathrm{trap}})} - 1 = \\exp(W_{\\mathrm{trap}} - W_{\\mathrm{tri}}) - 1\n$$\n我们需要分别计算三角形势垒和梯形势垒的指数 $W_{\\mathrm{tri}}$ 和 $W_{\\mathrm{trap}}$。\n\n1.  **三角形势垒 ($T_{\\mathrm{tri}}$)**\n    势能为 $U_{t}(x) = E_{g} - S_{t} x$，其中 $S_t = E_g/L$。\n    指数 $W_{\\mathrm{tri}}$ 为：\n    $$\n    W_{\\mathrm{tri}} = \\frac{2\\sqrt{2 m_{r}}}{\\hbar} \\int_{0}^{L} \\sqrt{E_{g} - \\frac{E_{g}}{L} x} \\, dx = \\frac{2\\sqrt{2 m_{r} E_{g}}}{\\hbar} \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right)^{1/2} \\, dx\n    $$\n    该积分的计算结果为：\n    $$\n    \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right)^{1/2} \\, dx = \\left[ -L \\frac{2}{3} \\left(1 - \\frac{x}{L}\\right)^{3/2} \\right]_{0}^{L} = 0 - \\left(-\\frac{2L}{3}\\right) = \\frac{2L}{3}\n    $$\n    代入此结果，我们得到：\n    $$\n    W_{\\mathrm{tri}} = \\frac{2\\sqrt{2 m_{r} E_{g}}}{\\hbar} \\left(\\frac{2L}{3}\\right) = \\frac{4L\\sqrt{2 m_{r} E_{g}}}{3\\hbar}\n    $$\n    另外，使用斜率 $S_t=E_g/L$，积分 $\\int_0^L \\sqrt{E_g - S_t x} dx = \\left[ -\\frac{2}{3S_t}(E_g - S_t x)^{3/2} \\right]_0^L = \\frac{2}{3S_t} E_g^{3/2}$。\n    因此，$W_{\\mathrm{tri}} = \\frac{2\\sqrt{2 m_{r}}}{\\hbar} \\frac{2 E_g^{3/2}}{3S_t} = \\frac{4\\sqrt{2 m_{r}} E_g^{3/2}}{3\\hbar S_t}$。\n\n2.  **梯形势垒 ($T_{\\mathrm{trap}}$)**\n    势能 $U(x)$ 是分段线性的。我们在 $x=\\ell_s$ 处将积分分开：\n    $$\n    W_{\\mathrm{trap}} = \\frac{2\\sqrt{2 m_{r}}}{\\hbar} \\left( \\int_{0}^{\\ell_s} \\sqrt{E_{g}-S_{s} x} \\, dx + \\int_{\\ell_s}^{L} \\sqrt{E_{g}-S_{s} \\ell_{s}-S_{c} (x-\\ell_{s})} \\, dx \\right)\n    $$\n    令 $U_k \\equiv U(\\ell_s) = E_g - S_s\\ell_s$。根据一致性条件 $E_g = S_s\\ell_s+S_c\\ell_c$，我们有 $U_k=S_c\\ell_c$。\n    势能的第二部分为 $U(x) = S_c\\ell_c - S_c(x-\\ell_s) = S_c(L-x)$，适用于 $\\ell_s \\le x \\le L$。\n    积分为：\n    $$\n    \\int_{0}^{\\ell_s} \\sqrt{E_{g}-S_{s} x} \\, dx = \\left[ -\\frac{2}{3S_s}(E_g-S_s x)^{3/2} \\right]_{0}^{\\ell_s} = \\frac{2}{3S_s} \\left( E_g^{3/2} - (E_g-S_s\\ell_s)^{3/2} \\right) = \\frac{2}{3S_s} (E_g^{3/2} - U_k^{3/2})\n    $$\n    $$\n    \\int_{\\ell_s}^{L} \\sqrt{S_c(L-x)} \\, dx = \\left[ -\\frac{2\\sqrt{S_c}}{3}(L-x)^{3/2} \\right]_{\\ell_s}^{L} = \\frac{2\\sqrt{S_c}}{3}(L-\\ell_s)^{3/2} = \\frac{2\\sqrt{S_c}}{3}\\ell_c^{3/2} = \\frac{2}{3S_c}(S_c\\ell_c)^{3/2} = \\frac{2}{3S_c}U_k^{3/2}\n    $$\n    将两部分相加，梯形的总积分为：\n    $$\n    \\int_0^L \\sqrt{U(x)} dx = \\frac{2}{3S_s} (E_g^{3/2} - U_k^{3/2}) + \\frac{2}{3S_c} U_k^{3/2} = \\frac{2}{3} \\left( \\frac{E_g^{3/2}}{S_s} + U_k^{3/2} \\left(\\frac{1}{S_c} - \\frac{1}{S_s}\\right) \\right)\n    $$\n    因此，指数为：\n    $$\n    W_{\\mathrm{trap}} = \\frac{4\\sqrt{2 m_{r}}}{3\\hbar} \\left( \\frac{E_g^{3/2}}{S_s} + U_k^{3/2} \\left(\\frac{S_s - S_c}{S_s S_c}\\right) \\right)\n    $$\n\n3.  **指数之差 ($W_{\\mathrm{trap}} - W_{\\mathrm{tri}}$)**\n    为求差值，将 $W_{\\mathrm{tri}}$ 用相同变量表示会更方便。我们使用关系式 $L=\\ell_s+\\ell_c = \\frac{E_g-U_k}{S_s} + \\frac{U_k}{S_c} = \\frac{E_g}{S_s} + U_k(\\frac{1}{S_c}-\\frac{1}{S_s})$。\n    $$\n    W_{\\mathrm{tri}} = \\frac{4L\\sqrt{2 m_{r} E_g}}{3\\hbar} = \\frac{4\\sqrt{2 m_{r} E_g}}{3\\hbar} \\left( \\frac{E_g}{S_s} + U_k\\left(\\frac{1}{S_c}-\\frac{1}{S_s}\\right) \\right) = \\frac{4\\sqrt{2 m_{r}}}{3\\hbar} \\left( \\frac{E_g^{3/2}}{S_s} + U_k E_g^{1/2}\\left(\\frac{S_s - S_c}{S_s S_c}\\right) \\right)\n    $$\n    差值 $\\Delta W = W_{\\mathrm{trap}} - W_{\\mathrm{tri}}$ 为：\n    $$\n    \\Delta W = \\frac{4\\sqrt{2 m_{r}}}{3\\hbar} \\left(\\frac{S_s - S_c}{S_s S_c}\\right) \\left( U_k^{3/2} - U_k E_g^{1/2} \\right) = \\frac{4\\sqrt{2 m_{r}}}{3\\hbar} \\left(\\frac{S_s - S_c}{S_s S_c}\\right) U_k \\left( \\sqrt{U_k} - \\sqrt{E_g} \\right)\n    $$\n    现在，我们必须用给定的参数来表示 $U_k$。从 $L = \\frac{E_g}{S_s} + U_k(\\frac{S_s-S_c}{S_sS_c})$，我们解出 $U_k$：\n    $$\n    U_k = \\left(L - \\frac{E_g}{S_s}\\right) \\frac{S_s S_c}{S_s-S_c} = \\frac{S_s L - E_g}{S_s} \\frac{S_s S_c}{S_s-S_c} = \\frac{S_c(S_s L - E_g)}{S_s - S_c}\n    $$\n    将此代入 $\\Delta W$ 的表达式：\n    $$\n    \\Delta W = \\frac{4\\sqrt{2 m_{r}}}{3\\hbar} \\left(\\frac{S_s - S_c}{S_s S_c}\\right) \\frac{S_c(S_s L - E_g)}{S_s - S_c} \\left( \\sqrt{\\frac{S_c(S_s L - E_g)}{S_s - S_c}} - \\sqrt{E_g} \\right)\n    $$\n    简化前置因子：\n    $$\n    \\Delta W = \\frac{4\\sqrt{2 m_{r}}}{3\\hbar S_s} (S_s L - E_g) \\left( \\sqrt{\\frac{S_c(S_s L - E_g)}{S_s - S_c}} - \\sqrt{E_g} \\right)\n    $$\n    为使表达式更紧凑一些，我们可以从括号中提出因子 $\\sqrt{E_g}$：\n    $$\n    \\Delta W = \\frac{4\\sqrt{2 m_{r} E_g}}{3\\hbar S_s} (S_s L - E_g) \\left( \\sqrt{\\frac{S_c(S_s L - E_g)}{E_g(S_s - S_c)}} - 1 \\right)\n    $$\n    相对误差 $\\delta$ 则为 $\\exp(\\Delta W) - 1$。\n\n4.  **$\\delta$ 的最终表达式**\n    代入 $\\Delta W$ 的表达式，我们得到相对误差 $\\delta$ 的最终闭式解析表达式：\n    $$\n    \\delta = \\exp\\left( \\frac{4\\sqrt{2m_r E_g}}{3\\hbar S_s} (S_s L - E_g) \\left( \\sqrt{\\frac{S_c(S_s L - E_g)}{E_g(S_s - S_c)}} - 1 \\right) \\right) - 1\n    $$",
            "answer": "$$\n\\boxed{\\exp\\left(\\frac{4\\sqrt{2m_r E_g}}{3\\hbar S_s} (S_s L - E_g) \\left(\\sqrt{\\frac{S_c(S_s L - E_g)}{E_g(S_s - S_c)}} - 1\\right)\\right) - 1}\n$$"
        },
        {
            "introduction": "为了完整地描述TFET的行为，我们必须将器件结构、量子力学和非平衡统计学结合起来。这项综合性练习将指导您使用非平衡格林函数（NEGF）方法，实现一个完整的量子输运仿真。通过从头开始构建模型并计算电流-电压（$I$-$V$）特性，您将把抽象的理论与实际的器件性能预测联系起来，完成从理论到实践的跨越。",
            "id": "4310537",
            "problem": "实现一个完整且可运行的程序，该程序使用简化的非平衡格林函数 (NEGF) 形式主义下的一维紧束缚模型，计算隧穿场效应晶体管 (TFET) 的漏极电流-电压特性。该程序必须对一组由器件和偏置参数定义的测试用例进行数值计算，并如下文指定，将结果单行输出。\n\n从以下基本框架出发：\n\n- 器件哈密顿量由单粒子薛定谔方程的一维最近邻紧束缚离散化构建，每个格点有两个轨道，分别代表导带和价带。设 $N$ 为格点数。分别用 $c_i$ 和 $v_i$ 表示格点 $i$ 处的导带轨道和价带轨道。总器件哈密顿量 $H$ 作用在一个 $2N$ 维的基上，基的排列顺序为 $\\{c_0, c_1, \\ldots, c_{N-1}, v_0, v_1, \\ldots, v_{N-1}\\}$。\n- 在位能由能带边和栅极控制定义：对于每个格点 $i$，$\\varepsilon_c(i) = E_g / 2 - \\alpha V_g$ 且 $\\varepsilon_v(i) = - E_g / 2$，其中 $E_g$ 是带隙，$\\alpha$ 是栅极效率因子（无量纲），$V_g$ 是以 $\\mathrm{V}$ 为单位的栅极电压，通过元电荷换算为 $\\mathrm{eV}$ 单位。导带链和价带链的带内最近邻耦合分别为 $t_c$ 和 $t_v$，带间在位耦合为 $U$（每个格点上导带和价带之间的局域混合）。\n- 源极接触耦合到格点 $i = 0$ 处的价带轨道，漏极接触耦合到格点 $i = N-1$ 处的导带轨道。每个接触都被建模为半无限紧束缚链，其带内耦合与相应器件链的相同，在位能与能带中心匹配：$\\varepsilon_v^{(\\mathrm{src})} = - E_g / 2$ 和 $\\varepsilon_c^{(\\mathrm{drn})} = + E_g / 2$。\n- 推迟格林函数定义为 $ G^r(E) = \\left[ (E + i \\eta) I - H - \\Sigma_s^r(E) - \\Sigma_d^r(E) \\right]^{-1} $，其中 $I$ 是单位矩阵，$E$ 是以 $\\mathrm{eV}$ 为单位的能量，$\\eta$ 是一个正无穷小量，$\\Sigma_s^r(E)$ 和 $\\Sigma_d^r(E)$ 是由源极和漏极接触引起的推迟自能。自能仅在与接触耦合的器件轨道上非零，并从半无限链的表面格林函数获得；通过选择二次方程的推迟根来保证因果性。\n- 展宽矩阵为 $ \\Gamma_s(E) = i \\left[ \\Sigma_s^r(E) - \\Sigma_s^a(E) \\right] $ 和 $ \\Gamma_d(E) = i \\left[ \\Sigma_d^r(E) - \\Sigma_d^a(E) \\right] $，其中超前自能是厄米共轭：$ \\Sigma^a(E) = \\left( \\Sigma^r(E) \\right)^\\dagger $。\n- 能量 $E$ 处的透射率为 $ T(E) = \\mathrm{Tr} \\left[ \\Gamma_s(E) G^r(E) \\Gamma_d(E) G^a(E) \\right] $。对于单轨道接触，这简化为 $ T(E) = \\Gamma_s(E) \\, \\Gamma_d(E) \\, \\left| G_{d,s}^r(E) \\right|^2 $，其中 $ G_{d,s}^r(E) $ 是连接漏极接触轨道与源极接触轨道的 $G^r$ 矩阵元。\n- 电流由针对具有自旋简并的相干输运的 Landauer 表达式给出，$ I = \\dfrac{2 q^2}{h} \\int_{-\\infty}^{+\\infty} dE \\, T(E) \\left[ f(E, \\mu_s) - f(E, \\mu_d) \\right] $，其中 $q$ 是元电荷，$h$ 是普朗克常数，$f(E, \\mu)$ 是化学势为 $\\mu$ 的费米-狄拉克分布（以 $\\mathrm{eV}$ 为单位）。使用 $ \\mu_s = 0 \\, \\mathrm{eV} $ 和 $ \\mu_d = - V_{ds} \\, \\mathrm{eV} $，以及 $ f(E, \\mu) = \\dfrac{1}{1 + \\exp\\left( \\dfrac{E - \\mu}{k_B T} \\right)} $，其中 $k_B T$ 以 $\\mathrm{eV}$ 表示。\n\n您的程序必须实现上述模型，通过在覆盖相关能带的足够精细的均匀网格上进行能量的数值积分，来计算每个测试用例的 $I$。程序必须：\n\n- 构建具有指定在位能和耦合的 $2N \\times 2N$ 哈密顿量 $H$。\n- 使用半无限一维紧束缚链的解析表面格林函数计算推迟接触自能，确保选择正确的推迟分支。\n- 通过求解线性方程组 $ G^r(E) $ 与单位向量的乘积来提取 $ G_{d,s}^r(E) $，而不是计算完整的逆矩阵，以此来评估 $ T(E) $。\n- 在至少跨越 $\\left[ -2.0, +2.0 \\right] \\, \\mathrm{eV}$ 的能量网格上使用梯形法则进行数值积分。\n- 使用常数 $ q = 1.602176634 \\times 10^{-19} \\, \\mathrm{C} $，$ h = 6.62607015 \\times 10^{-34} \\, \\mathrm{J \\cdot s} $，以及 $ k_B = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV/K} $。\n\n将最终电流值以 $\\mathrm{A}$ 为单位表示，并四舍五入到六位有效数字。\n\n所有测试用例的通用参数：\n\n- 格点数：$ N = 20 $\n- 带隙：$ E_g = 0.6 \\, \\mathrm{eV} $\n- 带内跃迁：$ t_c = 0.5 \\, \\mathrm{eV} $，$ t_v = 0.5 \\, \\mathrm{eV} $\n- 栅极效率：$ \\alpha = 0.8 $ (无量纲)\n- 温度：$ T = 300 \\, \\mathrm{K} $\n\n定义以下测试套件（每个元组为 $ (V_{ds}, V_g, U) $，电压单位为 $\\mathrm{V}$，$U$ 单位为 $\\mathrm{eV}$）：\n\n1. $ (0.2, 0.0, 0.05) $: 基线能带未对齐，中等漏极偏压。\n2. $ (0.2, 0.4, 0.05) $: 栅极诱导的部分对齐。\n3. $ (0.2, 0.75, 0.05) $: 栅极诱导的能带重叠附近的强对齐。\n4. $ (0.5, 0.4, 0.05) $: 较高漏极偏压下的部分对齐。\n5. $ (0.2, 0.4, 0.01) $: 减小带间耦合以突显隧穿敏感性。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[result1,result2,result3,result4,result5]\"），其中每个“result”是以 $\\mathrm{A}$ 为单位的电流，并四舍五入到六位有效数字。\n\n所有物理量必须以一致的能量单位处理；能量积分变量必须以 $\\mathrm{eV}$ 为单位，最终电流必须以 $\\mathrm{A}$ 为单位。",
            "solution": "用户的要求是，在一个简化的非平衡格林函数 (NEGF) 形式主义下的一维紧束缚模型基础上，实现一个程序来计算隧穿场效应晶体管 (TFET) 的电流-电压特性。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **模型**：一维 (1D) 最近邻紧束缚模型，每个格点有两个轨道 ($c_i, v_i$)。\n- **器件尺寸**：$N = 20$ 个格点。\n- **哈密顿量基**：$2N$ 维，排列顺序为 $\\{c_0, ..., c_{N-1}, v_0, ..., v_{N-1}\\}$。\n- **在位能**：$\\varepsilon_c(i) = E_g / 2 - \\alpha V_g$，$\\varepsilon_v(i) = - E_g / 2$。\n- **跃迁/耦合**：带内 $t_c, t_v$；带间在位 $U$。\n- **接触**：源极耦合到 $v_0$（索引 $N$），漏极耦合到 $c_{N-1}$。\n- **接触模型**：能量为 $\\varepsilon_v^{(\\mathrm{src})} = -E_g/2$ 和 $\\varepsilon_c^{(\\mathrm{drn})} = +E_g/2$ 的半无限一维紧束缚链。\n- **格林函数**：$G^r(E) = \\left[ (E + i \\eta) I - H - \\Sigma_s^r(E) - \\Sigma_d^r(E) \\right]^{-1}$。\n- **自能**：从半无限链的表面格林函数解析得到。\n- **展宽**：$\\Gamma_{s,d}(E) = i \\left[ \\Sigma_{s,d}^r(E) - \\Sigma_{s,d}^a(E) \\right]$。\n- **透射率**：$T(E) = \\Gamma_s(E) \\, \\Gamma_d(E) \\, \\left| G_{d,s}^r(E) \\right|^2$。\n- **电流**：$I = \\dfrac{2 q^2}{h} \\int_{-\\infty}^{+\\infty} dE \\, T(E) \\left[ f(E, \\mu_s) - f(E, \\mu_d) \\right]$。\n- **化学势**：$\\mu_s = 0 \\, \\mathrm{eV}$，$\\mu_d = - V_{ds} \\, \\mathrm{eV}$。\n- **费米-狄拉克分布**：$f(E, \\mu) = [1 + \\exp((E - \\mu)/(k_B T))]^{-1}$。\n- **数值方法**：在至少 $[-2.0, 2.0] \\, \\mathrm{eV}$ 的网格上使用梯形法则积分。\n- **常数**：$q = 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$，$h = 6.62607015 \\times 10^{-34} \\, \\mathrm{J \\cdot s}$，$k_B = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV/K}$。\n- **通用参数**：$N = 20$，$E_g = 0.6 \\, \\mathrm{eV}$，$t_c = 0.5 \\, \\mathrm{eV}$，$t_v = 0.5 \\, \\mathrm{eV}$，$\\alpha = 0.8$，$T = 300 \\, \\mathrm{K}$。\n- **测试用例 ($V_{ds}, V_g, U$)**：1. $(0.2, 0.0, 0.05)$，2. $(0.2, 0.4, 0.05)$，3. $(0.2, 0.75, 0.05)$，4. $(0.5, 0.4, 0.05)$，5. $(0.2, 0.4, 0.01)$。\n- **输出**：电流单位为安培，四舍五入到六位有效数字，形式为逗号分隔的列表 `[...]`。\n\n**步骤2：使用提取的已知条件进行验证**\n这个问题具有科学依据，采用了标准的 NEGF 框架来处理量子输运。问题陈述清晰，定义了所有必要的方程、参数和边界条件以确保唯一解。语言客观而精确。物理参数和测试用例对于模型 TFET 系统是切合实际的，旨在探究不同的工作区域（关断态、导通态、饱和态）。数值要求具体且可行。简化的透射率公式对于单轨道接触是有效的，并且所提供的 Landauer 电流积分对于以 eV 为单位的能量积分是正确构建的。不存在会妨碍严谨实现的矛盾或模糊之处。\n\n**步骤3：结论与行动**\n问题是**有效的**。将遵循指定的模型和数值步骤来开发解决方案。\n\n### 基于原理的设计与解决方案\n该解决方案通过数值评估 Landauer 电流公式来实现。这需要在一个能量网格上计算透射函数 $T(E)$，然后将其与源极和漏极接触的费米-狄拉克分布之差进行积分。\n\n**1. 哈密顿量构建**\n器件由一个 $2N \\times 2N$ 的紧束缚哈密顿矩阵 $H$ 描述。基的排列顺序是先排布所有 $N$ 个导带轨道，然后是所有 $N$ 个价带轨道。轨道 $c_i$ 对应于矩阵索引 $i$，轨道 $v_i$ 对应于索引 $N+i$。\n- **在位能**：对角线元素的前 $N$ 个填充为 $\\varepsilon_c = E_g/2 - \\alpha V_g$，后 $N$ 个填充为 $\\varepsilon_v = -E_g/2$。\n- **带内跃迁**：最近邻耦合 $-t_c$ 和 $-t_v$ 分别填充在导带-导带块和价带-价带块的第一条次对角线上。\n- **带间耦合**：$c_i$ 和 $v_i$ 之间的在位耦合 $-U$ 填充在非对角元素 $H_{i, N+i}$ 和 $H_{N+i, i}$ 上。\n\n**2. 接触自能**\n源极和漏极接触是半无限导线，它们对器件的影响通过推迟自能项 $\\Sigma_s^r(E)$ 和 $\\Sigma_d^r(E)$ 来体现。对于在位能为 $\\varepsilon_L$、跃迁为 $t_L$ 的一维链，标量自能从表面格林函数导出：\n$$ \\sigma_L^r(E) = \\frac{1}{2} \\left[ (E' - \\varepsilon_L) - \\sqrt{(E' - \\varepsilon_L)^2 - 4t_L^2} \\right] $$\n其中 $E' = E + i\\eta$ 包含一个小的正虚部 $\\eta$ 以确保因果性（推迟解）。平方根取复数主根。\n- 源极接触耦合到轨道 $v_0$（索引 $N$），参数为 $\\varepsilon_L = \\varepsilon_v^{(\\mathrm{src})} = -E_g/2$ 和 $t_L = t_v$。其自能矩阵 $\\Sigma_s^r(E)$ 除了元素 $(\\Sigma_s^r)_{N,N} = \\sigma_s^r(E)$ 外均为零。\n- 漏极接触耦合到轨道 $c_{N-1}$（索引 $N-1$），参数为 $\\varepsilon_L = \\varepsilon_c^{(\\mathrm{drn})} = E_g/2$ 和 $t_L = t_c$。其自能矩阵 $\\Sigma_d^r(E)$ 除了 $(\\Sigma_d^r)_{N-1,N-1} = \\sigma_d^r(E)$ 外均为零。\n\n**3. 格林函数与透射率**\n推迟格林函数 $G^r(E)$ 是矩阵 $M(E) = (E+i\\eta)I - H - \\Sigma_s^r(E) - \\Sigma_d^r(E)$ 的逆。透射函数由下式给出：\n$$ T(E) = \\gamma_s(E) \\gamma_d(E) |G^r_{d,s}(E)|^2 $$\n其中 $d$ 和 $s$ 分别是与漏极和源极耦合的轨道的索引（$d=N-1, s=N$），而 $\\gamma_L(E)$ 是展宽。\n- **展宽**：$\\gamma_L(E) = i[\\sigma_L^r(E) - (\\sigma_L^r(E))^*] = -2 \\, \\text{Im}[\\sigma_L^r(E)]$。由于 $\\text{Im}[\\sigma_L^r(E)] \\le 0$，展宽是非负的。\n- **格林函数矩阵元**：不进行完全的矩阵求逆，而是通过求解线性系统 $M(E) \\mathbf{x} = \\mathbf{b}$ 来高效地找到 $G^r_{d,s}(E)$，其中 $\\mathbf{b}$ 是一个在源极索引 $s$ 处为 1 的单位向量。所需矩阵元即为解向量 $\\mathbf{x}$ 的第 $d$ 个分量。\n\n**4. 电流计算**\n总电流通过对所有能量上的透射率进行积分得到，并由费米窗口加权：\n$$ I = \\frac{2q^2}{h} \\int T(E) [f(E, \\mu_s) - f(E, \\mu_d)] \\, dE $$\n- **费米窗口**：源极化学势为 $\\mu_s = 0$，漏极化学势为 $\\mu_d = -V_{ds}$。费米-狄拉克分布为 $f(E, \\mu) = (1 + \\exp((E-\\mu)/k_BT))^{-1}$。\n- **数值积分**：使用梯形法则在一个从 $E_{min}=-2.0 \\, \\mathrm{eV}$ 到 $E_{max}=+2.0 \\, \\mathrm{eV}$ 的具有精细步长的均匀能量网格上对积分进行数值计算。前置因子 $2q^2/h$ 将结果（单位为能量 eV）转换为以安培为单位的电流，其中 $q$ 的单位是库仑， $h$ 的单位是焦耳·秒。\n\n该算法遍历每个测试用例，使用上述步骤计算电流，将结果格式化为六位有效数字，并收集它们用于最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the TFET current calculation problem.\n    It orchestrates the calculation for each test case and prints the final result.\n    \"\"\"\n\n    # Define physical constants as per the problem statement\n    Q = 1.602176634e-19  # Elementary charge in C\n    H = 6.62607015e-34    # Planck's constant in J*s\n    KB = 8.617333262145e-5 # Boltzmann constant in eV/K\n\n    # Define common parameters for all test cases\n    common_params = {\n        'N': 20,           # Number of sites\n        'Eg': 0.6,         # Bandgap in eV\n        'tc': 0.5,         # Conduction band hopping in eV\n        'tv': 0.5,         # Valence band hopping in eV\n        'alpha': 0.8,      # Gate efficiency factor (dimensionless)\n        'T': 300.0,        # Temperature in K\n    }\n\n    # Define numerical integration parameters\n    numerical_params = {\n        'E_min': -2.0,      # Min energy for integration in eV\n        'E_max': 2.0,       # Max energy for integration in eV\n        'n_E': 2001,        # Number of energy points\n        'eta': 1e-6,        # Infinitesimal for retarded Green's function in eV\n    }\n\n    # Define the test suite: (Vds [V], Vg [V], U [eV])\n    test_cases = [\n        (0.2, 0.0, 0.05),\n        (0.2, 0.4, 0.05),\n        (0.2, 0.75, 0.05),\n        (0.5, 0.4, 0.05),\n        (0.2, 0.4, 0.01),\n    ]\n\n    results = []\n    for vds, vg, u in test_cases:\n        current = calculate_current(vds, vg, u, common_params, numerical_params, Q, H, KB)\n        results.append(current)\n\n    # Format results to 6 significant figures and create the output string\n    def format_sig(val, sig_figs=6):\n        if val == 0:\n            return '0.0'\n        return f\"{val:.{sig_figs-1}e}\"\n\n    formatted_results = [format_sig(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_current(vds, vg, u, common_params, num_params, q, h, kb):\n    \"\"\"\n    Calculates the TFET current for a given set of parameters using NEGF.\n    \"\"\"\n    # Unpack parameters\n    N = common_params['N']\n    Eg = common_params['Eg']\n    tc = common_params['tc']\n    tv = common_params['tv']\n    alpha = common_params['alpha']\n    T = common_params['T']\n    \n    E_min, E_max, n_E, eta = num_params['E_min'], num_params['E_max'], num_params['n_E'], num_params['eta']\n\n    # --- 1. Construct the device Hamiltonian H ---\n    # Basis: {c0..cN-1, v0..vN-1}, so indices 0..N-1 are CB, N..2N-1 are VB.\n    dim = 2 * N\n    H = np.zeros((dim, dim), dtype=np.float64)\n\n    # On-site energies (diagonal)\n    eps_c = Eg / 2.0 - alpha * vg\n    eps_v = -Eg / 2.0\n    for i in range(N):\n        H[i, i] = eps_c  # Conduction band sites\n        H[N + i, N + i] = eps_v  # Valence band sites\n\n    # Intra-band hopping (off-diagonals)\n    for i in range(N - 1):\n        H[i, i + 1] = H[i + 1, i] = -tc\n        H[N + i, N + i + 1] = H[N + i + 1, N + i] = -tv\n    \n    # Inter-band coupling\n    for i in range(N):\n        H[i, N + i] = H[N + i, i] = -u\n\n    # --- 2. Set up energy grid and Fermi functions ---\n    E = np.linspace(E_min, E_max, n_E)\n    kBT = kb * T\n\n    mu_s = 0.0\n    mu_d = -vds\n\n    def fermi_dirac(energy, mu, kBT_val):\n        x = (energy - mu) / kBT_val\n        # Avoid overflow by handling large positive x\n        return np.where(x  100, 0.0, 1.0 / (1.0 + np.exp(x)))\n\n    f_s = fermi_dirac(E, mu_s, kBT)\n    f_d = fermi_dirac(E, mu_d, kBT)\n\n    # --- 3. Compute transmission T(E) over the energy grid ---\n    transmission = np.zeros_like(E)\n    E_complex = E + 1j * eta\n\n    # Contact parameters\n    # Source: couples to v0 (index N), lead properties from valence band\n    eps_s_lead = -Eg / 2.0\n    t_s_lead = tv\n    s_idx = N\n    \n    # Drain: couples to cN-1 (index N-1), lead properties from conduction band\n    eps_d_lead = Eg / 2.0\n    t_d_lead = tc\n    d_idx = N - 1\n\n    # Source vector for linear solve\n    source_vector = np.zeros(dim, dtype=np.complex128)\n    source_vector[s_idx] = 1.0\n    \n    for i, e_c in enumerate(E_complex):\n        # Calculate self-energies for source and drain\n        # Formula for 1D semi-infinite lead self-energy\n        # sigma = 0.5 * ( (E - eps) - sqrt((E - eps)^2 - 4*t^2) )\n        z_s = e_c - eps_s_lead\n        sigma_s = 0.5 * (z_s - np.sqrt(z_s**2 - 4 * t_s_lead**2, dtype=np.complex128))\n        \n        z_d = e_c - eps_d_lead\n        sigma_d = 0.5 * (z_d - np.sqrt(z_d**2 - 4 * t_d_lead**2, dtype=np.complex128))\n\n        # Calculate broadening functions\n        gamma_s = -2.0 * np.imag(sigma_s)\n        gamma_d = -2.0 * np.imag(sigma_d)\n        \n        if gamma_s == 0 or gamma_d == 0:\n            continue\n            \n        # Construct the matrix M = (E+i*eta)*I - H - Sigma_s - Sigma_d\n        M = np.diag(np.full(dim, e_c, dtype=np.complex128)) - H\n        M[s_idx, s_idx] -= sigma_s\n        M[d_idx, d_idx] -= sigma_d\n\n        # Solve M * x = b for x (which is one column of G^r)\n        try:\n            g_rs_col = np.linalg.solve(M, source_vector)\n        except np.linalg.LinAlgError:\n            continue\n            \n        g_rds = g_rs_col[d_idx]\n        \n        # Calculate transmission\n        transmission[i] = gamma_s * gamma_d * np.abs(g_rds)**2\n\n    # --- 4. Integrate to find the current ---\n    integrand = transmission * (f_s - f_d)\n    \n    # Prefactor for current calculation\n    prefactor = (2 * q**2) / h\n    \n    # Trapezoidal rule for numerical integration\n    current_integral_eV = np.trapz(integrand, E)\n    \n    current = prefactor * current_integral_eV\n    \n    return current\n\n# Execute the main function\nsolve()\n\n```"
        }
    ]
}