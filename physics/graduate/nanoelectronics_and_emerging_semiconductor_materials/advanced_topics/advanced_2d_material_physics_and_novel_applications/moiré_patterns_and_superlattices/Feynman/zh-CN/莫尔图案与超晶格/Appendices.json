{
    "hands_on_practices": [
        {
            "introduction": "理解摩尔超晶格的第一步是掌握其基本几何属性。本练习将引导你使用连续介质模型，这是一个从真实空间位移场出发来描述两个晶格堆叠的强大工具。通过这个实践，你将推导出连接摩尔周期与晶格失配及扭转角的经典公式，这是分析几乎所有摩尔现象的基石。",
            "id": "4288042",
            "problem": "由单层石墨烯和六方氮化硼（hBN）构成的异质结，由于微小的晶格常数失配和可能存在的相对扭转，会展现出二维莫尔超晶格。设石墨烯的布拉维晶格常数为 $a_{\\mathrm{g}}$，hBN的晶格常数为 $a_{\\mathrm{hBN}} = (1+\\epsilon)\\,a_{\\mathrm{g}}$，其中晶格失配 $\\epsilon$ 定义为 $\\epsilon = \\left(a_{\\mathrm{hBN}} - a_{\\mathrm{g}}\\right)/a_{\\mathrm{g}}$。两个晶格之间的相对旋转是一个小角度 $\\theta$（以弧度为单位）。\n\n从两个近乎对齐的二维晶体相对堆叠的连续介质模型描述出发，将局域层间位移场建模为一个作用于位置 $\\mathbf{r}$ 的线性算符，即 $\\mathbf{u}(\\mathbf{r}) = \\left[(1+\\epsilon)\\,\\mathbf{R}(\\theta) - \\mathbf{I}\\right]\\mathbf{r}$，其中 $\\mathbf{R}(\\theta)$ 是二维旋转矩阵，$\\mathbf{I}$ 是单位矩阵。利用在 $|\\epsilon|\\ll 1$ 和 $|\\theta|\\ll 1$ 时有效的小参数展开，推导莫尔超晶格周期 $L(\\theta,\\epsilon)$ 的解析表达式。推导要求满足 $|\\mathbf{u}(\\mathbf{T})|$ 等于一个实空间原胞晶格矢量模长的最小非零实空间平移 $\\mathbf{T}$ 即为莫尔原胞周期。在领头阶上将晶格视为各向同性，并忽略超过 $\\epsilon$ 和 $\\theta$ 二阶的项。\n\n然后，取石墨烯/hBN的 $a_{\\mathrm{g}} = 0.246~\\mathrm{nm}$ 和 $\\epsilon = 0.018$，计算零扭转角（$\\theta = 0$）时的莫尔周期 $L(0,\\epsilon)$。将您的数值答案四舍五入到四位有效数字，并以纳米表示。最后，基于您推导出的 $L(\\theta,\\epsilon)$，讨论一个微小但非零的扭转角 $\\theta$（以弧度为单位）对莫尔周期的领头阶效应，并确定扭转在决定周期方面主导晶格失配的区间。",
            "solution": "该问题要求推导具有晶格失配 $\\epsilon$ 和扭转角 $\\theta$ 的异质结的莫尔超晶格周期 $L(\\theta,\\epsilon)$，然后进行数值计算并讨论该角度的效应。\n\n出发点是局域层间位移场，由 $\\mathbf{u}(\\mathbf{r}) = \\mathbf{M}\\mathbf{r}$ 给出，其中算符 $\\mathbf{M}$ 定义为 $\\mathbf{M} = (1+\\epsilon)\\mathbf{R}(\\theta) - \\mathbf{I}$。此处，$\\mathbf{R}(\\theta)$ 是二维旋转矩阵，$\\mathbf{I}$ 是单位矩阵。\n在笛卡尔坐标系中，旋转矩阵为：\n$$ \\mathbf{R}(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} $$\n因此，矩阵 $\\mathbf{M}$ 为：\n$$ \\mathbf{M} = (1+\\epsilon)\\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} - \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (1+\\epsilon)\\cos\\theta - 1 & -(1+\\epsilon)\\sin\\theta \\\\ (1+\\epsilon)\\sin\\theta & (1+\\epsilon)\\cos\\theta - 1 \\end{pmatrix} $$\n问题指明我们应使用 $|\\epsilon| \\ll 1$ 和 $|\\theta| \\ll 1$ 的小参数展开，并忽略超过这些参数二阶的项。三角函数的泰勒展开为 $\\cos\\theta \\approx 1 - \\frac{\\theta^2}{2}$ 和 $\\sin\\theta \\approx \\theta$。将这些代入 $\\mathbf{M}$ 的表达式中：\n对角元变为：\n$$ (1+\\epsilon)\\cos\\theta - 1 \\approx (1+\\epsilon)\\left(1 - \\frac{\\theta^2}{2}\\right) - 1 = 1 + \\epsilon - \\frac{\\theta^2}{2} - \\frac{\\epsilon\\theta^2}{2} - 1 = \\epsilon - \\frac{\\theta^2}{2} - \\frac{\\epsilon\\theta^2}{2} $$\n非对角元变为：\n$$ (1+\\epsilon)\\sin\\theta \\approx (1+\\epsilon)\\theta = \\theta + \\epsilon\\theta $$\n忽略超过二阶的项（即3阶或更高阶的项，如 $\\epsilon\\theta^2$），矩阵 $\\mathbf{M}$ 近似为：\n$$ \\mathbf{M} \\approx \\begin{pmatrix} \\epsilon - \\frac{\\theta^2}{2} & -(\\theta + \\epsilon\\theta) \\\\ \\theta + \\epsilon\\theta & \\epsilon - \\frac{\\theta^2}{2} \\end{pmatrix} $$\n为进一步简化并抓住领头阶行为，我们可以只保留 $\\epsilon$ 和 $\\theta$ 的线性项：\n$$ \\mathbf{M} \\approx \\begin{pmatrix} \\epsilon & -\\theta \\\\ \\theta & \\epsilon \\end{pmatrix} $$\n这个矩阵表示一个因子为 $\\sqrt{\\epsilon^2+\\theta^2}$ 的缩放和一个旋转的组合。让我们来验证变换的模长。对于任意矢量 $\\mathbf{v}$，$\\mathbf{Mv}$ 的模的平方为 $|\\mathbf{Mv}|^2 = \\mathbf{v}^T \\mathbf{M}^T \\mathbf{M} \\mathbf{v}$。\n$$ \\mathbf{M}^T\\mathbf{M} \\approx \\begin{pmatrix} \\epsilon & \\theta \\\\ -\\theta & \\epsilon \\end{pmatrix} \\begin{pmatrix} \\epsilon & -\\theta \\\\ \\theta & \\epsilon \\end{pmatrix} = \\begin{pmatrix} \\epsilon^2+\\theta^2 & 0 \\\\ 0 & \\epsilon^2+\\theta^2 \\end{pmatrix} = (\\epsilon^2+\\theta^2)\\mathbf{I} $$\n因此， $|\\mathbf{Mv}|^2 = (\\epsilon^2+\\theta^2)|\\mathbf{v}|^2$，这意味着 $|\\mathbf{Mv}| = \\sqrt{\\epsilon^2+\\theta^2}|\\mathbf{v}|$。这个结果在 $\\epsilon$ 和 $\\theta$ 的二阶精度下是精确的。使用更精确的 $\\mathbf{M}$ 形式并展开结果，将得到直到二阶都相同的表达式。\n\n莫尔超晶格周期 $L$ 定义为最小非零平移矢量 $\\mathbf{T}$ 的模长，该矢量满足 $|\\mathbf{u}(\\mathbf{T})|$ 等于参考晶格（石墨烯）的原胞实空间晶格矢量的模长 $a_{\\mathrm{g}}$。\n条件是 $|\\mathbf{u}(\\mathbf{T})| = a_{\\mathrm{g}}$。\n代入 $\\mathbf{u}(\\mathbf{T}) = \\mathbf{M}\\mathbf{T}$，我们得到 $|\\mathbf{M}\\mathbf{T}| = a_{\\mathrm{g}}$。\n使用刚才的结果， $|\\mathbf{M}\\mathbf{T}| = \\sqrt{\\epsilon^2+\\theta^2}|\\mathbf{T}|$。\n令 $L = |\\mathbf{T}|$ 为莫尔周期。该条件变为：\n$$ \\sqrt{\\epsilon^2+\\theta^2} L = a_{\\mathrm{g}} $$\n对 $L$ 求解，我们得到莫尔超晶格周期作为扭转角 $\\theta$ 和晶格失配 $\\epsilon$ 的函数的解析表达式：\n$$ L(\\theta, \\epsilon) = \\frac{a_{\\mathrm{g}}}{\\sqrt{\\epsilon^2 + \\theta^2}} $$\n\n接下来，我们使用给定的值 $a_{\\mathrm{g}} = 0.246~\\mathrm{nm}$ 和 $\\epsilon = 0.018$ 来计算石墨烯/hBN异质结的零扭转角（$\\theta=0$）莫尔周期。\n对于 $\\theta=0$，周期的表达式简化为：\n$$ L(0, \\epsilon) = \\frac{a_{\\mathrm{g}}}{\\sqrt{\\epsilon^2 + 0^2}} = \\frac{a_{\\mathrm{g}}}{|\\epsilon|} $$\n因为 $\\epsilon = 0.018$ 是正数，所以 $|\\epsilon|=\\epsilon$。\n$$ L(0, \\epsilon) = \\frac{0.246~\\mathrm{nm}}{0.018} $$\n数值计算得出：\n$$ L(0, \\epsilon) = \\frac{246}{18}~\\mathrm{nm} = \\frac{41}{3}~\\mathrm{nm} \\approx 13.666...~\\mathrm{nm} $$\n将结果四舍五入到四位有效数字，我们得到 $13.67~\\mathrm{nm}$。\n\n最后，我们讨论一个微小但非零的扭转角 $\\theta$ 对莫尔周期的领头阶效应。通用表达式为 $L(\\theta, \\epsilon) = a_{\\mathrm{g}} / \\sqrt{\\epsilon^2 + \\theta^2}$。\n对于固定的晶格失配 $\\epsilon$，如果我们引入一个小的扭转角 $\\theta \\neq 0$，分母 $\\sqrt{\\epsilon^2 + \\theta^2}$ 会变得大于 $\\sqrt{\\epsilon^2} = |\\epsilon|$。因此，莫尔周期 $L(\\theta, \\epsilon)$ 会减小。一个微小扭转角的领头阶效应是缩短莫尔周期。\n\n扭转在决定周期方面主导晶格失配的区间是当来自角度的贡献 $\\theta^2$ 远大于来自失配的贡献 $\\epsilon^2$ 时。这个条件表示为 $\\theta^2 \\gg \\epsilon^2$，或更简单地表示为 $|\\theta| \\gg |\\epsilon|$（因为两者都是小实数且 $\\theta$ 以弧度为单位）。在这个扭转主导的区间，莫尔周期的表达式可以近似为：\n$$ L(\\theta, \\epsilon) \\approx \\frac{a_{\\mathrm{g}}}{\\sqrt{\\theta^2}} = \\frac{a_{\\mathrm{g}}}{|\\theta|} $$\n在这些条件下，莫尔周期几乎完全由扭转角决定，并与其成反比，而晶格失配的作用可以忽略不计。",
            "answer": "$$\\boxed{13.67}$$"
        },
        {
            "introduction": "理想化的模型是理解复杂系统的起点，但真实材料总存在非理想因素。本练习将我们的分析从理想的各向同性情况扩展到更现实的场景，即存在单轴应变的情况。通过分析应变如何在倒易空间中扭曲晶格，你将学会计算各向异性的摩尔波长，并理解其如何导致摩尔晶胞的拉伸，这对于精确解读实验结果至关重要。",
            "id": "4288061",
            "problem": "考虑一个二维（2D）双层结构，它由相同的晶格叠加而成，其原始实空间矢量沿笛卡尔坐标轴方向。设未应变的原始矢量为 $a\\,\\hat{\\boldsymbol{x}}$ 和 $a\\,\\hat{\\boldsymbol{y}}$，因此相应的原始倒易矢量为 $G\\,\\hat{\\boldsymbol{x}}$ 和 $G\\,\\hat{\\boldsymbol{y}}$，其中 $G = 2\\pi/a$。顶层相对于底层旋转了一个小角度 $\\theta$（以弧度为单位）。底层沿 $\\hat{\\boldsymbol{x}}$ 方向受到一个小的单轴应变 $\\epsilon$，其各向同性线弹性泊松比为 $\\nu$，因此其在实空间中的小应变张量为 $\\boldsymbol{e} = \\mathrm{diag}(\\epsilon,\\,-\\nu\\,\\epsilon)$。假设 $\\theta$ 和 $\\epsilon$ 都足够小，使得一阶近似有效。\n\n使用以下基本原理：\n- 莫尔超晶格源于两个倒易晶格的干涉；在小角度错配的主导阶下，莫尔倒易矢量 $\\boldsymbol{g}_{m}$ 由两层相应倒易晶格矢量的差给出。\n- 一个小的实空间形变梯度 $\\boldsymbol{F} = \\boldsymbol{I} + \\boldsymbol{e}$ 通过 $\\boldsymbol{F}^{-T} \\approx \\boldsymbol{I} - \\boldsymbol{e}^{T}$ 变换倒易矢量，而一个小的角度 $\\theta$ 旋转由 $\\boldsymbol{R}(\\theta) \\approx \\boldsymbol{I} + \\theta\\,\\boldsymbol{J}$ 表示，其中 $\\boldsymbol{J} = \\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}$。\n- 沿给定方向的实空间莫尔波长是相应莫尔波矢大小的倒数：$L = 2\\pi/|\\boldsymbol{g}_{m}|$。\n\n从这些原理出发，推导由小的旋转和小的单轴应变组合产生的沿主轴 $\\hat{\\boldsymbol{x}}$ 和 $\\hat{\\boldsymbol{y}}$ 方向的莫尔波长的主导阶表达式。然后，通过计算定义为 $r = L_{y}/L_{x}$ 的纵横比来量化莫尔晶胞的各向异性和伸长。\n\n以无量纲形式报告你的答案，即归一化莫尔波长 $L_{x}/a$ 和 $L_{y}/a$，以及纵横比 $r$。无需进行数值计算或四舍五入。将角度 $\\theta$ 解释为弧度。从所述基本原理开始，解释你推导的每一步，并清楚地指明所使用的任何近似。",
            "solution": "目标是推导莫尔波长 $L_x$ 和 $L_y$ 及其比率 $r$ 的表达式。这需要确定莫尔倒易矢量，即两层倒易矢量之间的差。\n\n首先，我们将方形晶格的未扰动原始倒易矢量表示为 $\\boldsymbol{G}_x = G\\,\\hat{\\boldsymbol{x}}$ 和 $\\boldsymbol{G}_y = G\\,\\hat{\\boldsymbol{y}}$，其中 $G = 2\\pi/a$。\n\n**底层（第1层）：应变**\n底层受到一个小应变张量 $\\boldsymbol{e} = \\begin{pmatrix} \\epsilon & 0 \\\\ 0 & -\\nu\\epsilon \\end{pmatrix}$。这个应变层的倒易晶格矢量，我们记为 $\\boldsymbol{G}_{1,x}'$ 和 $\\boldsymbol{G}_{1,y}'$，是通过应用变换 $\\boldsymbol{I} - \\boldsymbol{e}^T$ 得到的。由于 $\\boldsymbol{e}$ 是对角矩阵，所以 $\\boldsymbol{e}^T = \\boldsymbol{e}$。\n变换矩阵为 $\\boldsymbol{T}_{\\epsilon} = \\boldsymbol{I} - \\boldsymbol{e} = \\begin{pmatrix} 1-\\epsilon & 0 \\\\ 0 & 1-(-\\nu\\epsilon) \\end{pmatrix} = \\begin{pmatrix} 1-\\epsilon & 0 \\\\ 0 & 1+\\nu\\epsilon \\end{pmatrix}$。\n\n将此变换应用于未扰动的倒易矢量：\n$$ \\boldsymbol{G}_{1,x}' = \\boldsymbol{T}_{\\epsilon} \\boldsymbol{G}_x = \\begin{pmatrix} 1-\\epsilon & 0 \\\\ 0 & 1+\\nu\\epsilon \\end{pmatrix} \\begin{pmatrix} G \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (1-\\epsilon)G \\\\ 0 \\end{pmatrix} = (1-\\epsilon)G\\,\\hat{\\boldsymbol{x}} $$\n$$ \\boldsymbol{G}_{1,y}' = \\boldsymbol{T}_{\\epsilon} \\boldsymbol{G}_y = \\begin{pmatrix} 1-\\epsilon & 0 \\\\ 0 & 1+\\nu\\epsilon \\end{pmatrix} \\begin{pmatrix} 0 \\\\ G \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ (1+\\nu\\epsilon)G \\end{pmatrix} = (1+\\nu\\epsilon)G\\,\\hat{\\boldsymbol{y}} $$\n\n**顶层（第2层）：旋转**\n顶层旋转了一个小角度 $\\theta$。旋转由矩阵 $\\boldsymbol{R}(\\theta) \\approx \\boldsymbol{I} + \\theta\\boldsymbol{J}$ 表示，其中 $\\boldsymbol{J} = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$。\n旋转矩阵为 $\\boldsymbol{R}(\\theta) \\approx \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\theta\\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & -\\theta \\\\ \\theta & 1 \\end{pmatrix}$。\n\n旋转层的倒易矢量 $\\boldsymbol{G}_{2,x}'$ 和 $\\boldsymbol{G}_{2,y}'$ 是通过将此旋转应用于未扰动矢量得到的：\n$$ \\boldsymbol{G}_{2,x}' = \\boldsymbol{R}(\\theta) \\boldsymbol{G}_x = \\begin{pmatrix} 1 & -\\theta \\\\ \\theta & 1 \\end{pmatrix} \\begin{pmatrix} G \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} G \\\\ G\\theta \\end{pmatrix} = G\\,\\hat{\\boldsymbol{x}} + G\\theta\\,\\hat{\\boldsymbol{y}} $$\n$$ \\boldsymbol{G}_{2,y}' = \\boldsymbol{R}(\\theta) \\boldsymbol{G}_y = \\begin{pmatrix} 1 & -\\theta \\\\ \\theta & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ G \\end{pmatrix} = \\begin{pmatrix} -G\\theta \\\\ G \\end{pmatrix} = -G\\theta\\,\\hat{\\boldsymbol{x}} + G\\,\\hat{\\boldsymbol{y}} $$\n\n**莫尔倒易矢量**\n根据问题陈述，莫尔倒易矢量 $\\boldsymbol{g}_m$ 是相应倒易晶格矢量的差。我们通过计算顶层和底层变换后矢量的差，来计算两个主莫尔矢量 $\\boldsymbol{g}_{mx}$ 和 $\\boldsymbol{g}_{my}$。\n$$ \\boldsymbol{g}_{mx} = \\boldsymbol{G}_{2,x}' - \\boldsymbol{G}_{1,x}' = (G\\,\\hat{\\boldsymbol{x}} + G\\theta\\,\\hat{\\boldsymbol{y}}) - (1-\\epsilon)G\\,\\hat{\\boldsymbol{x}} = G\\epsilon\\,\\hat{\\boldsymbol{x}} + G\\theta\\,\\hat{\\boldsymbol{y}} $$\n$$ \\boldsymbol{g}_{my} = \\boldsymbol{G}_{2,y}' - \\boldsymbol{G}_{1,y}' = (-G\\theta\\,\\hat{\\boldsymbol{x}} + G\\,\\hat{\\boldsymbol{y}}) - (1+\\nu\\epsilon)G\\,\\hat{\\boldsymbol{y}} = -G\\theta\\,\\hat{\\boldsymbol{x}} - G\\nu\\epsilon\\,\\hat{\\boldsymbol{y}} $$\n\n**莫尔波长**\n实空间莫尔波长 $L$ 定义为 $L = 2\\pi/|\\boldsymbol{g}_m|$。我们计算 $\\boldsymbol{g}_{mx}$ 和 $\\boldsymbol{g}_{my}$ 的大小，以找到相应的波长 $L_x$ 和 $L_y$。\n$$ |\\boldsymbol{g}_{mx}| = \\sqrt{(G\\epsilon)^2 + (G\\theta)^2} = G\\sqrt{\\epsilon^2 + \\theta^2} $$\n$$ |\\boldsymbol{g}_{my}| = \\sqrt{(-G\\theta)^2 + (-G\\nu\\epsilon)^2} = G\\sqrt{\\theta^2 + \\nu^2\\epsilon^2} $$\n\n现在我们可以找到波长 $L_x$ 和 $L_y$：\n$$ L_x = \\frac{2\\pi}{|\\boldsymbol{g}_{mx}|} = \\frac{2\\pi}{G\\sqrt{\\epsilon^2 + \\theta^2}} $$\n由于 $G = 2\\pi/a$，这可以简化为：\n$$ L_x = \\frac{a}{\\sqrt{\\epsilon^2 + \\theta^2}} $$\n类似地，对于 $L_y$：\n$$ L_y = \\frac{2\\pi}{|\\boldsymbol{g}_{my}|} = \\frac{2\\pi}{G\\sqrt{\\theta^2 + \\nu^2\\epsilon^2}} = \\frac{a}{\\sqrt{\\theta^2 + \\nu^2\\epsilon^2}} $$\n\n**归一化波长和纵横比**\n问题要求无量纲的归一化波长 $L_x/a$ 和 $L_y/a$，以及纵横比 $r=L_y/L_x$。\n\n归一化波长为：\n$$ \\frac{L_x}{a} = \\frac{1}{\\sqrt{\\epsilon^2 + \\theta^2}} $$\n$$ \\frac{L_y}{a} = \\frac{1}{\\sqrt{\\theta^2 + \\nu^2\\epsilon^2}} $$\n\n纵横比 $r$ 是这两个波长的比值：\n$$ r = \\frac{L_y}{L_x} = \\frac{a/\\sqrt{\\theta^2 + \\nu^2\\epsilon^2}}{a/\\sqrt{\\epsilon^2 + \\theta^2}} = \\frac{\\sqrt{\\epsilon^2 + \\theta^2}}{\\sqrt{\\theta^2 + \\nu^2\\epsilon^2}} $$\n这可以写成：\n$$ r = \\sqrt{\\frac{\\epsilon^2 + \\theta^2}{\\theta^2 + \\nu^2\\epsilon^2}} $$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{\\epsilon^{2} + \\theta^{2}}} & \\frac{1}{\\sqrt{\\theta^{2} + \\nu^{2}\\epsilon^{2}}} & \\sqrt{\\frac{\\epsilon^{2} + \\theta^{2}}{\\theta^{2} + \\nu^{2}\\epsilon^{2}}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "摩尔超晶格最引人入胜的特性源于其平带中强烈的电子相互作用。这个高级实践将带你从单粒子几何结构过渡到多体物理学的核心问题。你将应用Hartree-Fock平均场理论，通过最小化一个简化的能量泛函，来探索不同关联电子相（如谷极化和谷间相干）之间的竞争，从而亲身体验理论物理学家如何预测和分类在摩尔材料中涌现的新物态。",
            "id": "4288049",
            "problem": "考虑一个用于莫尔超晶格的双谷、无自旋、平带模型，其中谷指数被视为赝自旋自由度。在哈特里-福克 (Hartree-Fock, HF) 近似下，每个莫尔原胞的能量通过一个由局域单粒子密度矩阵构建的能量密度泛函来建模。设每个莫尔原胞的总电子密度为 $n \\in [0,2]$，对应于双谷导致的每个原胞两个电子的能带容量。将 $2 \\times 2$ 的单粒子密度矩阵定义为 $\\rho = \\frac{n}{2} I + \\mathbf{S} \\cdot \\boldsymbol{\\sigma}$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵，$\\boldsymbol{\\sigma}$ 是作用在谷空间中的泡利矩阵，$\\mathbf{S} = (S_x,S_y,S_z)$ 是谷赝自旋序参量矢量。HF 能量密度泛函取为\n$$\nE_{\\mathrm{HF}}(n,\\mathbf{S}) = \\frac{u}{2}\\, n^2 \\;-\\; j_z\\, S_z^2 \\;-\\; j_\\perp\\, (S_x^2 + S_y^2),\n$$\n其中 $u > 0$ 代表屏蔽的哈特里相互作用标度，$j_z > 0$ 和 $j_\\perp > 0$ 分别代表沿谷极化 ($z$) 方向和谷间相干 ($x,y$) 方向的各向异性福克交换作用标度。相互作用的各向异性由无量纲比率参数化\n$$\n\\gamma = \\frac{j_\\perp}{j_z}.\n$$\n物理约束要求 $\\rho$ 描述的是具有两个谷态的单条平带的占据情况，这意味着 $\\rho$ 必须是半正定的，且其本征值必须介于 0 和 1 之间。\n\n任务 1 (推导): 从给定的 $E_{\\mathrm{HF}}(n,\\mathbf{S})$、结构 $\\rho = \\frac{n}{2} I + \\mathbf{S} \\cdot \\boldsymbol{\\sigma}$ 以及对 $\\rho$ 的谱约束出发，推导在所有允许的 $\\mathbf{S}$ 上取得的最小 HF 能量 $E_{\\min}(n,\\gamma)$ 的表达式，并给出相应的相分类。可能的相由 $\\mathbf{S}$ 在谷赝自旋空间中的取向定义：\n- 谷非极化 (UP): $\\mathbf{S} = \\mathbf{0}$。\n- 谷极化 (VP): $\\mathbf{S}$ 沿 $z$ 轴排列且 $|\\mathbf{S}| > 0$。\n- 谷间相干 (IVC): $\\mathbf{S}$ 位于 $x\\text{–}y$ 平面内且 $|\\mathbf{S}| > 0$。\n- 简并 (DEG): 旋转对称的流形，其中 $|\\mathbf{S}| > 0$ 时 $\\mathbf{S}$ 的所有方向在能量上都是等价的。\n\n您的推导必须确定，作为 $n$ 和 $\\gamma$ 的函数，上述哪一个相在所描述的约束条件下使 $E_{\\mathrm{HF}}(n,\\mathbf{S})$ 最小化，并给出该相的 $E_{\\min}(n,\\gamma)$。能量以每个莫尔原胞的 $\\mathrm{meV}$ 为单位表示。\n\n任务 2 (实现): 实现一个完整的、可运行的程序，使用您推导出的结果，对下面测试套件中的每组参数进行相分类评估，并计算最小 HF 能量。使用固定的相互作用标度 $u = 50\\,\\mathrm{meV}$ 和 $j_z = 15\\,\\mathrm{meV}$，并计算 $j_\\perp = \\gamma\\, j_z$。对于数值报告，每个能量值必须四舍五入到 6 位小数。程序不得要求任何输入，并且必须生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，格式如下：\n- 对于每个测试用例，报告一个二元列表 $[p,e]$，其中 $p$ 是一个整数相代码，$e$ 是最小能量，以每个莫尔原胞的 $\\mathrm{meV}$ 为单位的浮点数，四舍五入到 6 位小数。\n- 使用相代码：UP $\\to 0$, VP $\\to 1$, IVC $\\to 2$, DEG $\\to 3$。\n\n测试套件（参数以 $(n,\\gamma)$ 的形式给出，其中 $n$ 的单位是每个莫尔原胞的电子数，$\\gamma$ 是无量纲的）：\n- 情况 A: $(1.0,\\,0.8)$\n- 情况 B: $(1.0,\\,1.2)$\n- 情况 C: $(1.0,\\,1.0)$\n- 情况 D: $(0.0,\\,0.5)$\n- 情况 E: $(2.0,\\,1.5)$\n- 情况 F: $(0.3,\\,0.5)$\n- 情况 G: $(1.7,\\,0.9)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的七个结果的列表，例如：$[[p_1,e_1],[p_2,e_2],\\dots,[p_7,e_7]]$。能量必须以每个莫尔原胞的 $\\mathrm{meV}$ 为单位，四舍五入到 6 位小数。本问题不使用角度。不涉及百分比。",
            "solution": "求解过程分两步：首先，根据对密度矩阵 $\\rho$ 的物理要求，推导谷赝自旋序参量 $\\mathbf{S}$ 的约束条件；其次，在这些约束条件下最小化哈特里-福克能量泛函 $E_{\\mathrm{HF}}(n,\\mathbf{S})$，以求得最小能量 $E_{\\min}(n,\\gamma)$ 及相应的基态相。\n\n**第 1 步：序参量 $\\mathbf{S}$ 约束条件的推导**\n\n单粒子密度矩阵给定为 $\\rho = \\frac{n}{2} I + \\mathbf{S} \\cdot \\boldsymbol{\\sigma}$，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵，$n$ 是每个莫爾原胞的总电子密度，且 $n \\in [0,2]$。矢量 $\\mathbf{S}$ 是谷赝自旋序参量。矩阵 $\\mathbf{S} \\cdot \\boldsymbol{\\sigma}$ 的本征值为 $\\pm |\\mathbf{S}|$，其中 $|\\mathbf{S}| = \\sqrt{S_x^2 + S_y^2 + S_z^2}$。因此，密度矩阵 $\\rho$ 的本征值为：\n$$\n\\lambda_{\\pm} = \\frac{n}{2} \\pm |\\mathbf{S}|\n$$\n问题陈述 $\\rho$ 必须是半正定的，且其本征值必须介于 0 和 1 之间。这对两个本征值都意味着约束条件 $0 \\le \\lambda_{\\pm} \\le 1$。这一个约束条件蕴含四个不等式：\n1. $0 \\le \\frac{n}{2} + |\\mathbf{S}|$\n2. $\\frac{n}{2} + |\\mathbf{S}| \\le 1$\n3. $0 \\le \\frac{n}{2} - |\\mathbf{S}|$\n4. $\\frac{n}{2} - |\\mathbf{S}| \\le 1$\n\n由于 $|\\mathbf{S}| \\ge 0$ 且 $n \\in [0,2]$，不等式 (1) 和 (4) 总是成立的。不等式 (3) 意味着 $|\\mathbf{S}| \\le \\frac{n}{2}$。不等式 (2) 意味着 $|\\mathbf{S}| \\le 1 - \\frac{n}{2}$。为了使两个不等式同时成立，序参量的大小必须受两个上界中较小者的限制：\n$$\n|\\mathbf{S}| \\le \\min\\left(\\frac{n}{2}, 1 - \\frac{n}{2}\\right)\n$$\n这个约束取决于填充数 $n$。\n- 对于填充数 $n \\in [0,1]$，我们有 $\\frac{n}{2} \\le 1 - \\frac{n}{2}$，所以约束是 $|\\mathbf{S}| \\le \\frac{n}{2}$。\n- 对于填充数 $n \\in (1,2]$，我们有 $1 - \\frac{n}{2}  \\frac{n}{2}$，所以约束是 $|\\mathbf{S}| \\le 1 - \\frac{n}{2}$。\n\n一个紧凑的写法来表示这个最大允许的大小，我们称之为 $S_{\\max}(n)$，是：\n$$\nS_{\\max}(n) = \\frac{1}{2}(1 - |n-1|)\n$$\n序参量的物理定义域是一个半径为 $S_{\\max}(n)$ 的球体，即 $|\\mathbf{S}| \\le S_{\\max}(n)$。\n\n**第 2 步：哈特里-福克能量的最小化**\n\nHF 能量泛函由下式给出：\n$$\nE_{\\mathrm{HF}}(n,\\mathbf{S}) = \\frac{u}{2}\\, n^2 \\;-\\; j_z\\, S_z^2 \\;-\\; j_\\perp\\, (S_x^2 + S_y^2)\n$$\n其中 $u, j_z, j_\\perp > 0$。我们希望在约束条件 $|\\mathbf{S}| \\le S_{\\max}(n)$ 下最小化关于 $\\mathbf{S}$ 的能量。第一项 $\\frac{u}{2}n^2$ 是一个相对于 $\\mathbf{S}$ 的常数。最小化 $E_{\\mathrm{HF}}$ 等价于最大化项 $J(\\mathbf{S}) = j_z S_z^2 + j_\\perp (S_x^2 + S_y^2)$。\n\n我们用大小 $S = |\\mathbf{S}|$ 及其方向来表示 $J(\\mathbf{S})$。设 $S_z^2 = S^2 \\cos^2\\theta$ 且 $S_x^2 + S_y^2 = S^2 \\sin^2\\theta$。\n$$\nJ(S, \\theta) = S^2 (j_z \\cos^2\\theta + j_\\perp \\sin^2\\theta) = j_z S^2 (\\cos^2\\theta + \\gamma \\sin^2\\theta)\n$$\n其中 $\\gamma = j_\\perp/j_z$。\n\n为了最大化 $J(S, \\theta)$，我们首先针对大小 $S$ 进行最大化。由于整个项是正的，当 $S$ 取其最大允许值 $S = S_{\\max}(n)$ 时，它被最大化。这对于任何 $S_{\\max}(n)>0$ 的 $n \\in (0,2)$ 都成立。$\\mathbf{S}=\\mathbf{0}$ 的情况得出 $J=0$，除非 $S_{\\max}(n)=0$，否则这绝不是最大值。\n\n问题现在简化为通过选择最佳方向 $\\theta$ 来最大化角度部分 $f(\\theta) = \\cos^2\\theta + \\gamma \\sin^2\\theta$。我们可以将 $f(\\theta)$ 重写为 $f(\\theta) = \\gamma + (1-\\gamma)\\cos^2\\theta$。最佳的 $\\theta$取决于 $(1-\\gamma)$ 的符号。\n\n基态相作为 $n$ 和 $\\gamma$ 的函数的分析如下：\n\n**A. 空带 ($n=0$) 或满带 ($n=2$)**\n如果 $n=0$ 或 $n=2$，则 $S_{\\max}(n) = 0$。这迫使 $\\mathbf{S}=\\mathbf{0}$。这是**谷非极化 (UP)** 相 (代码 $0$)。\n- 对于 $n=0$：$E_{\\min}(0,\\gamma) = 0$。\n- 对于 $n=2$：$E_{\\min}(2,\\gamma) = \\frac{u}{2}(2)^2 = 2u$。\n\n**B. 部分填充 ($n \\in (0,2)$)**\n此处，$S_{\\max}(n) > 0$。基态将具有 $|\\mathbf{S}| = S_{\\max}(n)$。相由 $\\gamma$ 决定。\n\n- **情况 1: $\\gamma  1$** ($j_\\perp  j_z$)\n因子 $(1-\\gamma)$ 是正的，所以当 $\\cos^2\\theta$ 最大化时，$f(\\theta)$ 也最大化，即 $\\cos^2\\theta = 1$。这对应于 $\\theta=0$ 或 $\\theta=\\pi$，意味着 $\\mathbf{S}$ 与 $z$ 轴对齐。这是**谷极化 (VP)** 相 (代码 $1$)。角度部分的最大值是 $1$。最小能量是：\n$$\nE_{\\min}(n,\\gamma) = \\frac{u}{2} n^2 - j_z (S_{\\max}(n))^2\n$$\n\n- **情况 2: $\\gamma > 1$** ($j_\\perp > j_z$)\n因子 $(1-\\gamma)$ 是负的，所以当 $\\cos^2\\theta$ 最小化时，$f(\\theta)$ 最大化，即 $\\cos^2\\theta = 0$。这对应于 $\\theta=\\pi/2$，意味着 $\\mathbf{S}$ 位于 $x\\text{–}y$ 平面内。这是**谷间相干 (IVC)** 相 (代码 $2$)。角度部分的最大值是 $\\gamma$。最小能量是：\n$$\nE_{\\min}(n,\\gamma) = \\frac{u}{2} n^2 - j_z (S_{\\max}(n))^2 \\cdot \\gamma = \\frac{u}{2} n^2 - j_\\perp (S_{\\max}(n))^2\n$$\n\n- **情况 3: $\\gamma = 1$** ($j_\\perp = j_z$)\n因子 $(1-\\gamma)$ 为零，所以对于所有 $\\theta$，$f(\\theta) = 1$。能量与 $\\mathbf{S}$ 的方向无关。任何方向在能量上都是等价的，从而产生一个简并的基态流形。这是**简并 (DEG)** 相 (代码 $3$)。最小能量是：\n$$\nE_{\\min}(n,1) = \\frac{u}{2} n^2 - j_z (S_{\\max}(n))^2\n$$\n\n**用于实现的公式总结：**\n设 $u=50\\,\\mathrm{meV}$ 且 $j_z=15\\,\\mathrm{meV}$。\n$$\nS_{\\max}^2(n) = \\left( \\frac{1}{2}(1 - |n-1|) \\right)^2 = \\begin{cases} (n/2)^2  \\text{若 } 0 \\le n \\le 1 \\\\ (1-n/2)^2  \\text{若 } 1  n \\le 2 \\end{cases}\n$$\n相代码 $p$ 和最小能量 $e$ 按如下方式确定：\n- 若 $n=0$：$p=0$, $e=0$。\n- 若 $n=2$：$p=0$, $e=2u$。\n- 若 $n \\in (0,2)$：\n    - $E_{\\text{Hartree}} = \\frac{u}{2}n^2$。\n    - $E_{\\text{exch}} = j_z S_{\\max}^2(n)$。\n    - 若 $\\gamma  1$：$p=1$, $e = E_{\\text{Hartree}} - E_{\\text{exch}}$。\n    - 若 $\\gamma > 1$：$p=2$, $e = E_{\\text{Hartree}} - \\gamma E_{\\text{exch}}$。\n    - 若 $\\gamma = 1$：$p=3$, $e = E_{\\text{Hartree}} - E_{\\text{exch}}$。\n这些公式将被实现以求解给定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hartree-Fock phase competition problem for a moiré superlattice model.\n    \"\"\"\n\n    # Define fixed interaction scales from the problem description.\n    U_HARTREE = 50.0  # meV\n    J_Z = 15.0      # meV\n\n    # Define phase codes.\n    PHASE_UP = 0   # Valley-unpolarized\n    PHASE_VP = 1   # Valley-polarized\n    PHASE_IVC = 2  # Intervalley-coherent\n    PHASE_DEG = 3  # Degenerate\n\n    # Define the test cases from the problem statement as (n, gamma).\n    test_cases = [\n        (1.0, 0.8),  # Case A\n        (1.0, 1.2),  # Case B\n        (1.0, 1.0),  # Case C\n        (0.0, 0.5),  # Case D\n        (2.0, 1.5),  # Case E\n        (0.3, 0.5),  # Case F\n        (1.7, 0.9),  # Case G\n    ]\n\n    results = []\n\n    for n, gamma in test_cases:\n        phase_code = -1\n        min_energy = 0.0\n\n        # Handle edge cases: empty (n=0) or full (n=2) band.\n        # In these cases, S_max is 0, so S must be 0 (UP phase).\n        if n == 0.0:\n            phase_code = PHASE_UP\n            min_energy = 0.0\n        elif n == 2.0:\n            phase_code = PHASE_UP\n            min_energy = 2.0 * U_HARTREE\n        else: # Handle partial filling (0  n  2).\n            # Calculate the square of the maximum allowed magnitude of the order parameter.\n            # S_max(n) = min(n/2, 1 - n/2)\n            if 0  n = 1.0:\n                s_max_sq = (n / 2.0)**2\n            else: # 1  n  2\n                s_max_sq = (1.0 - n / 2.0)**2\n            \n            # Common Hartree energy term.\n            energy_hartree = 0.5 * U_HARTREE * n**2\n            \n            # Exchange energy contribution depends on the phase.\n            # The phase choice minimizes the total energy by maximizing the\n            # negative exchange contribution.\n            \n            if gamma  1.0:\n                # Valley-Polarized (VP) phase is favored.\n                phase_code = PHASE_VP\n                min_energy = energy_hartree - J_Z * s_max_sq\n            elif gamma > 1.0:\n                # Intervalley-Coherent (IVC) phase is favored.\n                j_perp = gamma * J_Z\n                phase_code = PHASE_IVC\n                min_energy = energy_hartree - j_perp * s_max_sq\n            else: # gamma == 1.0\n                # Degenerate (DEG) phase where all directions are equivalent.\n                phase_code = PHASE_DEG\n                min_energy = energy_hartree - J_Z * s_max_sq\n\n        # Append the result [phase_code, rounded_energy] to the list.\n        results.append([phase_code, round(min_energy, 6)])\n\n    # The final print statement must match the required format exactly.\n    # The str() of a list automatically includes the brackets and spaces,\n    # and join combines them with commas.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str.replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}