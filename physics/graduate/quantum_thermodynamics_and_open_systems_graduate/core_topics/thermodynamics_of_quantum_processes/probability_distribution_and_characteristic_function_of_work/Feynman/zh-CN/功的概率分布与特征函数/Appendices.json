{
    "hands_on_practices": [
        {
            "introduction": "在深入研究量子功之前，我们先从一个经典的类比开始，这有助于我们建立直观的理解。本练习探讨了一个浸在热浴中的谐振子，这是统计力学中的一个经典模型。我们的目标是计算对该粒子所做功的特征函数，这是一个描述由热噪声引起的功涨落的强大数学工具。通过这个练习，你将为理解功的概率分布奠定坚实的基础。",
            "id": "1116713",
            "problem": "一个过阻尼粒子被限制在一维谐振势 $V(x, t) = \\frac{1}{2}k(x - x_0(t))^2$ 中，其中 $k$ 是弹簧常数。该粒子浸在一个恒定绝对温度为 $T$ 的热浴中。与热浴的相互作用产生一个摩擦系数为 $\\gamma$ 的摩擦和一个随机热力。该粒子的位置 $x(t)$ 的动力学由朗之万方程描述：\n$$ \\gamma \\frac{dx}{dt} = -\\frac{\\partial V(x,t)}{\\partial x} + \\xi(t) $$\n其中 $\\xi(t)$ 是一个高斯白噪声项，其均值为零，$\\langle \\xi(t) \\rangle = 0$，且其关联由涨落-耗散定理给出：$\\langle \\xi(t)\\xi(t') \\rangle = 2\\gamma k_B T \\delta(t-t')$，其中 $k_B$ 是玻尔兹曼常数。\n\n初始时，在 $t=0$ 时，谐振势阱的中心位于 $x_0(0)=0$，并且粒子与热浴处于热平衡状态。对于 $t>0$，势阱中心以恒定速度 $v$ 移动，使得 $x_0(t) = vt$。该过程持续一个有限的时间间隔，时长为 $\\tau$。\n\n移动势阱的外部施动者对粒子所做的功 $W$ 由所施加功率的积分给出：\n$$ W = \\int_0^\\tau \\frac{\\partial V(x(t), t)}{\\partial t} dt $$\n\n你的任务是计算功的概率分布的特征函数 $\\Phi_W(u) = \\langle e^{iuW} \\rangle$，其中 $u$ 是一个实变量，尖括号 $\\langle \\cdot \\rangle$ 表示对所有可能的噪声实现和初始条件的平均。\n\n用给定的物理参数 $k, \\gamma, v, \\tau, T, k_B$ 和变量 $u$ 来表示你的最终答案。\n\n**求：**特征函数 $\\Phi_W(u)$。",
            "solution": "1.  **动力学**：设 $y=x-vt$。朗之万方程变为 $\\gamma\\dot{y}=-ky-\\gamma v+\\xi(t)$。其通解是初始条件 $y(0)$ 和噪声历史 $\\xi(s)$ 的线性泛函。\n\n2.  **功**：功的表达式为 $W=\\int_0^\\tau\\frac{\\partial V}{\\partial t}dt=-kv\\int_0^\\tau y(t)\\,dt$。将 $y(t)$ 的解代入，可以看出功 $W$ 也是 $y(0)$ 和 $\\xi(s)$ 的线性泛函。\n\n3.  **高斯性质**：由于初始位置 $y(0)$ 服从高斯分布（来自热平衡），且噪声 $\\xi(t)$ 是高斯过程，功 $W$ 作为一个线性泛函，其本身也是一个高斯随机变量。因此，其特征函数完全由其均值和方差确定：$\\Phi_W(u)=\\exp(iu\\langle W\\rangle - u^2\\text{Var}(W)/2)$。\n\n4.  **均值与方差**：利用初始平衡条件 $\\langle y(0)\\rangle=0$ 和 $\\text{Var}(y(0))=k_BT/k$，以及噪声的关联性质，可以计算出功的均值和方差：\n    *   均值：$\\langle W\\rangle = \\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}(1-e^{-k\\tau/\\gamma})$\n    *   方差：$\\text{Var}(W)=2\\gamma v^2k_B T\\left[\\tau-\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\right]$\n\n5.  **特征函数**：将上述均值和方差的表达式代入 $\\Phi_W(u)$ 的公式中，即可得到最终答案。",
            "answer": "$$\\boxed{\\exp\\!\\Bigl[iu\\Bigl(\\gamma v^2\\tau-\\frac{\\gamma^2v^2}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)\\;-\\;u^2\\,\\gamma v^2k_B T\\Bigl(\\tau-\\frac{\\gamma}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)\\Bigr]}$$"
        },
        {
            "introduction": "现在，我们将注意力转向量子领域。在量子力学中，“功”是通过一个特定的测量方案——“两点测量”（TPM）方案——来定义的。本练习通过一个经历 Landau-Zener 扫描的典型二能级系统，展示了如何计算由量子测量和非绝热跃迁引起的功分布。这是一个理解量子功的核心范例，它揭示了即使在孤立系统的幺正演化中，功的随机性也源于量子测量的内在特性。",
            "id": "452914",
            "problem": "考虑一个双能级量子系统，在泡利矩阵 $\\{\\sigma_x, \\sigma_y, \\sigma_z\\}$ 基下，其含时哈密顿量由下式给出：\n$$\nH(t) = -\\frac{1}{2} (v t \\sigma_z + \\Delta \\sigma_x)\n$$\n其中 $\\Delta$ 是恒定的最小能隙，$v$ 是能量偏置的扫描速率。系统在此哈密顿量的驱动下演化一段有限的时间，从初始时刻 $t_i = -T$ 到末尾时刻 $t_f = +T$。我们设 $\\hbar=1$ 且玻尔兹曼常数 $k_B=1$。\n\n初始时，在时刻 $t_i=-T$，系统与一个具有恒定逆温度 $\\beta$ 的热浴处于热平衡状态。之后从 $t=-T$ 到 $t=+T$ 的演化是幺正的，并且与热浴隔离。\n\n在此过程中，外界对系统做功 $W$。功的值由一个两点能量测量方案确定：\n1.  在 $t=-T$ 时，测量系统的能量。\n2.  系统幺正演化至 $t=+T$。\n3.  在 $t=+T$ 时，再次测量系统的能量。\n所做的功是第二次和第一次能量测量结果之差。\n\n你的任务是计算功分布的特征函数，其定义为期望值 $G(u) = \\langle e^{iuW} \\rangle$，其中 $u$ 是一个实变量。\n\n在计算中，你可以假设扫描持续时间足够长，以至于 $vT \\gg \\Delta$。这允许使用标准的 Landau-Zener 公式来计算系统瞬时绝热本征态之间的非绝热跃迁概率，该概率由 $P_{LZ} = \\exp(-\\pi \\Delta^2 / v)$ 给出。\n\n将你的最终答案表示为单个闭合形式的解析表达式，用给定的参数 $\\Delta$、$v$、$T$、$\\beta$ 和 $u$ 表示。",
            "solution": "1.  **定义基本量**：在 $t=\\pm T$ 时，系统的瞬时能量本征值为 $\\pm E_T$，其中 $E_T=\\frac{1}{2}\\sqrt{(vT)^2+\\Delta^2}$。非绝热跃迁（Landau-Zener）概率为 $P_{LZ}=e^{-\\pi\\Delta^2/v}$。\n\n2.  **初始状态**：系统初始处于热平衡态，占据能量为 $nE_T$（$n=\\pm1$）的瞬时本征态的概率为 $p_n=e^{-\\beta nE_T}/(2\\cosh(\\beta E_T))$。\n\n3.  **跃迁概率**：从 $t=-T$ 的瞬时本征态 $n$ 到 $t=+T$ 的瞬时本征态 $m$ 的概率为 $P_{m|n}=(1-P_{LZ})\\delta_{mn}+P_{LZ}(1-\\delta_{mn})$。\n\n4.  **功**：对于一个从初始能量 $nE_T$ 到末态能量 $mE_T$ 的特定过程，所做的功为 $W_{m,n}=(m-n)E_T$。\n\n5.  **特征函数**：对所有可能的过程求平均，得到特征函数：\n    $$\n    G(u)=\\sum_{n,m=\\pm1}p_n P_{m|n} e^{iu(m-n)E_T}\n    $$\n\n6.  **计算**：将求和分为跃迁项（$m=-n$）和非跃迁项（$m=n$）：\n    $$\n    G(u)=\\sum_{n}p_n(1-P_{LZ}) + \\sum_{n}p_n P_{LZ} e^{-2iunE_T} = (1-P_{LZ})+P_{LZ}\\sum_{n=\\pm1}p_n e^{-2iunE_T}\n    $$\n\n7.  **求和化简**：计算含指数项的和：\n    $$\n    \\sum_{n=\\pm1} p_n e^{-2iunE_T} = \\frac{p_{-1}e^{2iuE_T} + p_1e^{-2iuE_T}}{\\sum p_n} = \\frac{\\frac{e^{\\beta E_T}}{Z} e^{2iuE_T} + \\frac{e^{-\\beta E_T}}{Z} e^{-2iuE_T}}{1} = \\frac{\\cosh\\bigl((\\beta+2iu)E_T\\bigr)}{\\cosh(\\beta E_T)}\n    $$\n    其中 $Z=2\\cosh(\\beta E_T)$。\n\n8.  **最终表达式**：将上述结果组合起来，得到：\n    $$\n    G(u)=(1-P_{LZ})+P_{LZ}\\frac{\\cosh\\bigl((\\beta+2iu)E_T\\bigr)}{\\cosh(\\beta E_T)}\n    $$\n    代入 $E_T$ 和 $P_{LZ}$ 的定义，即得到最终答案。",
            "answer": "$$\\boxed{\nG(u)=1-e^{-\\frac{\\pi\\Delta^2}{v}}\n+e^{-\\frac{\\pi\\Delta^2}{v}}\\,\n\\frac{\\cosh\\!\\Bigl(\\bigl(\\beta+2i u\\bigr)\\tfrac{\\sqrt{(vT)^2+\\Delta^2}}{2}\\Bigr)}\n{\\cosh\\!\\Bigl(\\beta\\,\\tfrac{\\sqrt{(vT)^2+\\Delta^2}}{2}\\Bigr)}\n}$$"
        },
        {
            "introduction": "在掌握了孤立量子系统的功之后，我们将进一步考虑系统与热环境的相互作用，即开放量子系统。这项实践不仅限于计算功的分布，而是要验证一个深刻而普适的涨落关系：Crooks 定理。通过编写代码数值实现一个包含淬火和热弛豫过程的协议，你将亲手验证这一对称性，它将正向过程所做的功与时间反演过程所做的功以及系统的自由能变化联系在一起。",
            "id": "3778125",
            "problem": "考虑一个量子二能级系统，它经历一次从初始哈密顿量 $H_0$（能量本征值为 $(E_0, E_1)$，本征基为 $\\{\\lvert \\psi_0 \\rangle, \\lvert \\psi_1 \\rangle\\}$）到末态哈密顿量 $H_1$（能量本征值为 $(E_0', E_1')$，本征基为 $\\{\\lvert \\phi_0 \\rangle, \\lvert \\phi_1 \\rangle\\}$）的突然淬火。系统初始处于逆温为 $\\beta$ 的吉布斯态，功通过两点测量（TPM）方案定义：在过程开始时（相对于 $H_0$）和结束时（相对于 $H_1$）对能量进行投影测量。\n\n本征基通过一个角度为 $\\theta$ 的实旋转相关联，因此\n$$\n\\lvert \\phi_0 \\rangle = \\cos\\theta \\,\\lvert \\psi_0 \\rangle + \\sin\\theta \\,\\lvert \\psi_1 \\rangle, \\quad \n\\lvert \\phi_1 \\rangle = -\\sin\\theta \\,\\lvert \\psi_0 \\rangle + \\cos\\theta \\,\\lvert \\psi_1 \\rangle,\n$$\n因此交叠概率为\n$$\nC_{j|i} = \\left|\\langle \\phi_j \\mid \\psi_i \\rangle\\right|^2 =\n\\begin{cases}\n\\cos^2\\theta  & \\text{若 } (j,i) \\in \\{(0,0),(1,1)\\}, \\\\\n\\sin^2\\theta  & \\text{若 } (j,i) \\in \\{(1,0),(0,1)\\}.\n\\end{cases}\n$$\n\n在初始和末态能量测量之间，系统与热浴弱耦合，并根据满足量子细致平衡（QDB）条件的时齐生成元进行演化。在二能级能量基中，这简化为一个经典的二态马尔可夫生成元，其速率满足细致平衡。对于任何具有能量 $(E_a, E_b)$ 的哈密顿量 $H$，定义一个基本速率参数 $g > 0$，并设置向上和向下的跃迁速率\n$$\nw_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}, \\quad w_{b \\to a} = g,\n$$\n这确保了相对于吉布斯稳态分布的细致平衡。作用于列概率向量 $p$（通过 $\\frac{d}{dt} p = \\mathcal{R}\\, p$）的相应 $2\\times 2$ 速率矩阵 $\\mathcal{R}$ 是\n$$\n\\mathcal{R} =\n\\begin{pmatrix}\n- w_{a \\to b} & w_{b \\to a} \\\\\nw_{a \\to b} & - w_{b \\to a}\n\\end{pmatrix},\n$$\n并且在持续时间 $\\tau$ 内的跃迁矩阵由矩阵指数给出\n$$\nM(\\tau) = e^{\\mathcal{R} \\tau}.\n$$\n\n定义正向过程如下：根据热概率 $p_i = e^{-\\beta E_i}/Z_0$（其中 $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$）抽取 $i \\in \\{0,1\\}$；执行到 $H_1$ 的突然淬火；在 $H_1$ 基中，给定 $i$ 的淬火后状态在 $k \\in \\{0,1\\}$ 上分布为 $C_{k|i}$；在 $H_1$ 的生成元下演化时间 $\\tau$，跃迁矩阵为 $M_1(\\tau)$；最后测量 $H_1$ 的能量，得到 $j \\in \\{0,1\\}$。相应的联合概率是\n$$\nP_F(i \\to j) = p_i \\sum_{k} C_{k|i}\\, [M_1(\\tau)]_{j k}.\n$$\n类似地，逆向过程从 $H_1$ 的热态开始，其概率为 $p_j' = e^{-\\beta E_j'}/Z_1$（其中 $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$）；测量 $H_1$ 的能量得到 $j$；淬火回 $H_0$；在 $H_0$ 基中，淬火后状态分布为 $D_{i|j} = \\left|\\langle \\psi_i \\mid \\phi_j \\rangle\\right|^2 = C_{j|i}$；在 $H_0$ 的生成元下演化时间 $\\tau$，跃迁矩阵为 $M_0(\\tau)$；最后测量 $H_0$ 的能量，得到 $i$。相应的联合概率是\n$$\nP_R(j \\to i) = p_j' \\sum_{k} D_{k|j}\\, [M_0(\\tau)]_{i k}.\n$$\n\n正向功特征函数定义为\n$$\n\\chi_F(u) = \\sum_{i,j} P_F(i \\to j)\\, e^{i u (E_j' - E_i)},\n$$\n逆向功特征函数定义为\n$$\n\\chi_R(v) = \\sum_{j,i} P_R(j \\to i)\\, e^{i v (E_i - E_j')}.\n$$\n令自由能差为 $\\Delta F = F_1 - F_0$，其中 $F_\\nu = -\\beta^{-1} \\ln Z_\\nu$，因此 $e^{-\\beta \\Delta F} = Z_1/Z_0$。\n\n任务：\n- 实现上述二能级系统的 $\\chi_F(u)$ 和 $\\chi_R(v)$ 的计算。\n- 在指定的实数 $u$ 值集合上，使用均匀绝对容差，数值验证 Crooks 对称性\n$$\n\\chi_F(u) \\approx e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta),\n$$\n\n您的程序必须：\n- 对每个测试用例，使用上述定义计算特征函数。\n- 对每个测试用例，在测试的 $u$ 值集合 $\\mathcal{U}$ 上，评估最大绝对偏差\n$$\n\\max_{u \\in \\mathcal{U}} \\left| \\chi_F(u) - e^{-\\beta \\Delta F}\\, \\chi_R(-u + i \\beta) \\right|\n$$\n并返回一个布尔值，指示偏差是否在容差范围内。\n\n测试套件：\n- 使用以下四个参数集，所有量均为无量纲：\n    1. 正常路径：$(E_0, E_1) = (0.0, 1.0)$, $(E_0', E_1') = (0.0, 1.3)$, $\\beta = 1.5$, $\\theta = 0.37$, $\\tau = 1.0$, $g = 0.8$。\n    2. 无动力学（边界情况）：与 1 中相同的能量和 $\\theta$，$\\beta = 1.5$, $\\tau = 0.0$, $g = 0.8$。\n    3. 无旋转（边界情况）：$(E_0, E_1) = (0.0, 1.0)$, $(E_0', E_1') = (0.0, 1.2)$, $\\beta = 1.5$, $\\theta = 0.0$, $\\tau = 2.0$, $g = 0.7$。\n    4. 长弛豫（边缘情况）：$(E_0, E_1) = (0.0, 1.0)$, $(E_0', E_1') = (0.0, 1.1)$, $\\beta = 2.0$, $\\theta = 0.25$, $\\tau = 50.0$, $g = 0.4$。\n- 使用 $u$ 值集合 $\\mathcal{U} = \\{-2.0, -0.5, 0.0, 0.5, 2.0\\}$。\n- 使用绝对容差 $\\varepsilon = 10^{-10}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表的结果，例如，“[true,false,true,true]”。每个条目是一个布尔值，表示相应测试用例是否通过了 Crooks 对称性检查，顺序与上面列出的一致。",
            "solution": "该问题要求对一个量子二能级系统，数值验证一个随机热力学对称关系，具体来说是 Crooks 涨落定理的一种形式。该系统经历一个包含热化步骤的淬火协议。解决方案涉及计算正向和逆向功特征函数 $\\chi_F(u)$ 和 $\\chi_R(v)$，并检验它们之间的关系。\n\n对于给定的一组参数——初始能量 $(E_0, E_1)$、末态能量 $(E_0', E_1')$、逆温 $\\beta$、旋转角 $\\theta$、演化时间 $\\tau$ 和基本速率 $g$——验证过程的结构如下：\n\n1.  **计算平衡性质和自由能：**\n    首先，我们计算初始和末态哈密顿量 $H_0$ 和 $H_1$ 各自的配分函数。\n    初始配分函数为 $Z_0 = e^{-\\beta E_0} + e^{-\\beta E_1}$。\n    末态配分函数为 $Z_1 = e^{-\\beta E_0'} + e^{-\\beta E_1'}$。\n    $H_0$ 能级的初始吉布斯态概率为 $p_i = e^{-\\beta E_i} / Z_0$，其中 $i \\in \\{0, 1\\}$。\n    类似地，$H_1$ 能级的吉布斯概率为 $p_j' = e^{-\\beta E_j'} / Z_1$，其中 $j \\in \\{0, 1\\}$。\n    自由能差为 $\\Delta F = F_1 - F_0 = -\\beta^{-1}(\\ln Z_1 - \\ln Z_0)$。出现在 Crooks 关系中的项是 $e^{-\\beta \\Delta F} = Z_1/Z_0$。\n\n2.  **构建速率和跃迁矩阵：**\n    系统在与热浴弱耦合下的演化由各自哈密顿量的能量本征基中的经典主方程建模。\n    对于具有能量 $(E_a, E_b)$ 的通用哈密顿量，跃迁速率由 $w_{a \\to b} = g\\, e^{-\\beta (E_b - E_a)}$ 和 $w_{b \\to a} = g$ 给出。我们假设 $E_b > E_a$。\n    相应的速率矩阵 $\\mathcal{R}$ 是：\n    $$\n    \\mathcal{R} =\n    \\begin{pmatrix}\n    -w_{a \\to b} & w_{b \\to a} \\\\\n    w_{a \\to b} & -w_{b \\to a}\n    \\end{pmatrix}\n    $$\n    在持续时间 $\\tau$ 内的跃迁概率矩阵由矩阵指数 $M(\\tau) = e^{\\mathcal{R}\\tau}$ 给出。此计算对初始哈密顿量 $H_0$（使用能量 $(E_0, E_1)$）和末态哈密顿量 $H_1$（使用能量 $(E_0', E_1')$）都执行，从而得到矩阵 $M_0(\\tau)$ 和 $M_1(\\tau)$。矩阵指数可以使用例如 `scipy.linalg.expm` 的数值例程来计算。\n\n3.  **确定交叠和联合概率：**\n    从 $H_0$ 到 $H_1$（反之亦然）的突然淬火导致能量本征基之间的失配，这通过旋转角 $\\theta$ 相关联。由于此基矢变换引起的跃迁概率矩阵 $C_{j|i} = |\\langle\\phi_j|\\psi_i\\rangle|^2$ 为：\n    $$\n    C = \\begin{pmatrix} C_{0|0} & C_{0|1} \\\\ C_{1|0} & C_{1|1} \\end{pmatrix} = \\begin{pmatrix} \\cos^2\\theta & \\sin^2\\theta \\\\ \\sin^2\\theta & \\cos^2\\theta \\end{pmatrix}\n    $$\n    逆向淬火概率由 $D_{k|j} = |\\langle\\psi_k|\\phi_j\\rangle|^2 = C_{j|k}$ 给出，因此矩阵 $D$ 是 $C$ 的转置。\n\n    正向过程（初始测量到 $E_i$ 且末态测量到 $E_j'$）的联合概率 $P_F(i \\to j)$ 通过对所有中间路径求和来计算：\n    $$\n    P_F(i \\to j) = p_i \\sum_{k=0,1} C_{k|i} [M_1(\\tau)]_{jk}\n    $$\n    类似地，逆向过程的联合概率 $P_R(j \\to i)$ 是：\n    $$\n    P_R(j \\to i) = p_j' \\sum_{k=0,1} D_{k|j} [M_0(\\tau)]_{ik} = p_j' \\sum_{k=0,1} C_{j|k} [M_0(\\tau)]_{ik}\n    $$\n    计算每个过程的这四种概率（例如，$P_F(0\\to0), P_F(0\\to1), P_F(1\\to0), P_F(1\\to1)$）。\n\n4.  **计算特征函数：**\n    使用联合概率，我们为测试集 $\\mathcal{U}$ 中的每个 $u$ 值计算正向和逆向功特征函数。\n    正向特征函数是：\n    $$\n    \\chi_F(u) = \\sum_{i,j \\in \\{0,1\\}} P_F(i \\to j) e^{i u (E_j' - E_i)}\n    $$\n    逆向特征函数在复数自变量 $v = -u + i\\beta$ 处求值：\n    $$\n    \\chi_R(-u + i\\beta) = \\sum_{j,i \\in \\{0,1\\}} P_R(j \\to i) e^{i(-u+i\\beta) (E_i - E_j')}\n    $$\n\n5.  **验证对称关系：**\n    对于每个 $u \\in \\mathcal{U}$，我们计算 Crooks 对称关系的左手边（LHS），$\\chi_F(u)$，和右手边（RHS），$e^{-\\beta \\Delta F} \\chi_R(-u + i\\beta)$。计算绝对差 $|LHS - RHS|$。\n    找出在所有 $u \\in \\mathcal{U}$ 上的这些差值的最大值：\n    $$\n    \\text{偏差} = \\max_{u \\in \\mathcal{U}} |\\chi_F(u) - e^{-\\beta\\Delta F} \\chi_R(-u + i\\beta)|\n    $$\n    最后，将此最大偏差与给定的容差 $\\varepsilon = 10^{-10}$ 进行比较。如果偏差小于 $\\varepsilon$，则该测试用例的验证通过。对所有四个提供的测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the problem by verifying the Crooks symmetry relation for four test cases.\n    \"\"\"\n\n    test_cases = [\n        # 1. Happy path\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 1.0, 'g': 0.8},\n        # 2. No dynamics (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.3), 'beta': 1.5, 'theta': 0.37, 'tau': 0.0, 'g': 0.8},\n        # 3. No rotation (boundary)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.2), 'beta': 1.5, 'theta': 0.0, 'tau': 2.0, 'g': 0.7},\n        # 4. Long relaxation (edge)\n        {'E': (0.0, 1.0), 'E_p': (0.0, 1.1), 'beta': 2.0, 'theta': 0.25, 'tau': 50.0, 'g': 0.4},\n    ]\n\n    u_values = [-2.0, -0.5, 0.0, 0.5, 2.0]\n    tolerance = 1e-10\n\n    results = []\n    for params in test_cases:\n        discrepancy = verify_crooks_for_case(params, u_values)\n        results.append(discrepancy  tolerance)\n\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\ndef verify_crooks_for_case(params, u_values):\n    \"\"\"\n    Computes the maximum discrepancy for a single test case.\n    \"\"\"\n    E = np.array(params['E'])\n    E_p = np.array(params['E_p'])\n    beta = params['beta']\n    theta = params['theta']\n    tau = params['tau']\n    g = params['g']\n\n    # 1. Equilibrium properties and free energy\n    Z0 = np.sum(np.exp(-beta * E))\n    Z1 = np.sum(np.exp(-beta * E_p))\n    p = np.exp(-beta * E) / Z0\n    p_p = np.exp(-beta * E_p) / Z1\n    exp_neg_beta_delta_F = Z1 / Z0\n    \n    # 2. Rate and transition matrices\n    def get_transition_matrix(energies, beta_val, g_val, tau_val):\n        E_a, E_b = energies[0], energies[1]\n        # Assuming E_b > E_a, which holds for all test cases.\n        w_ab = g_val * np.exp(-beta_val * (E_b - E_a))\n        w_ba = g_val\n        R = np.array([[-w_ab, w_ba], [w_ab, -w_ba]])\n        return expm(R * tau_val)\n\n    M0 = get_transition_matrix(E, beta, g, tau)\n    M1 = get_transition_matrix(E_p, beta, g, tau)\n\n    # 3. Overlap and joint probabilities\n    cos2_theta = np.cos(theta)**2\n    sin2_theta = np.sin(theta)**2\n    C = np.array([[cos2_theta, sin2_theta],\n                  [sin2_theta, cos2_theta]])\n\n    # PF[j, i] corresponds to P_F(i -> j)\n    PF = np.zeros((2, 2))\n    for i in range(2):\n        for j in range(2):\n            # Sum over intermediate states k\n            prob_sum = np.dot(M1[j, :], C[:, i])\n            PF[j, i] = p[i] * prob_sum\n    \n    # PR[i, j] corresponds to P_R(j -> i)\n    PR = np.zeros((2, 2))\n    for j in range(2):\n        for i in range(2):\n            # Sum over intermediate states k\n            # D_kj = C_jk\n            prob_sum = np.dot(M0[i, :], C[j, :])\n            PR[i, j] = p_p[j] * prob_sum\n\n    # 4.  5. Compute characteristic functions and verify symmetry\n    max_discrepancy = 0.0\n    for u in u_values:\n        # Forward characteristic function\n        chi_F = 0.0j\n        for i in range(2):\n            for j in range(2):\n                work = E_p[j] - E[i]\n                chi_F += PF[j, i] * np.exp(1j * u * work)\n        \n        # Reverse characteristic function\n        v = -u + 1j * beta\n        chi_R_v = 0.0j\n        for j in range(2):\n            for i in range(2):\n                rev_work = E[i] - E_p[j]\n                chi_R_v += PR[i, j] * np.exp(1j * v * rev_work)\n        \n        lhs = chi_F\n        rhs = exp_neg_beta_delta_F * chi_R_v\n        \n        discrepancy = np.abs(lhs - rhs)\n        if discrepancy > max_discrepancy:\n            max_discrepancy = discrepancy\n\n    return max_discrepancy\n\nsolve()\n```"
        }
    ]
}