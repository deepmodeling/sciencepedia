{
    "hands_on_practices": [
        {
            "introduction": "The possibility of transforming one quantum state into another via thermal operations is governed by a precise mathematical condition known as thermo-majorization. This exercise provides a direct, hands-on application of this fundamental concept. By constructing and comparing thermo-majorization curves for two different states, you will determine the feasibility of a state transition, gaining a concrete understanding of how these curves encapsulate the interplay between a state's population distribution and its energy structure at a given temperature .",
            "id": "3790549",
            "problem": "Consider a three-level quantum system (qutrit) with Hamiltonian $H$ having nondegenerate energy eigenvalues $E_{0}=0$, $E_{1}=\\epsilon$, and $E_{2}=2\\epsilon$, where $\\epsilon>0$. Let the inverse temperature be $\\beta=\\frac{\\ln 2}{\\epsilon}$. Define the Gibbs state $\\gamma_{\\beta}$ with components $g_{i}=\\frac{\\exp(-\\beta E_{i})}{Z_{\\beta}}$, where $Z_{\\beta}=\\sum_{j=0}^{2}\\exp(-\\beta E_{j})$ is the partition function. A thermal operation is any map implemented by an energy-preserving unitary on the joint system-bath starting with the bath in the Gibbs state at inverse temperature $\\beta$, which is a completely positive trace-preserving (CPTP) map that preserves the Gibbs state. The thermo-majorization curve of a state with populations $\\{p_{i}\\}_{i=0}^{2}$ is constructed by the following procedure: first, sort the indices $i$ by decreasing values of the ratios $p_{i}/g_{i}$ (equivalently, decreasing values of $p_{i}\\exp(\\beta E_{i})$); then plot the piecewise-linear curve through points whose $x$-coordinates are the cumulative sums of the sorted $\\{g_{i}\\}$ and whose $y$-coordinates are the corresponding cumulative sums of the sorted $\\{p_{i}\\}$.\n\nLet $\\rho$ and $\\sigma$ be diagonal states in the energy eigenbasis with populations\n$$\n\\boldsymbol{p}=(p_{0},p_{1},p_{2})=(0.1,\\,0.3,\\,0.6),\\qquad \\boldsymbol{q}=(q_{0},q_{1},q_{2})=(0.2,\\,0.4,\\,0.4).\n$$\nUsing the above definitions, construct the thermo-majorization curves for $\\rho$ and $\\sigma$ at the given $\\beta$, and from first principles determine whether $\\rho$ can be converted to $\\sigma$ by thermal operations at inverse temperature $\\beta$. As a quantitative certificate of convertibility, compute the worst-case slack\n$$\n\\delta=\\min_{k\\in\\{1,2\\}}\\left[\\sum_{i=1}^{k}p^{\\downarrow\\beta}_{i}-\\sum_{i=1}^{k}q^{\\downarrow\\beta}_{i}\\right],\n$$\nwhere $p^{\\downarrow\\beta}_{i}$ and $q^{\\downarrow\\beta}_{i}$ denote the components of $\\boldsymbol{p}$ and $\\boldsymbol{q}$ ordered by decreasing $p_{i}\\exp(\\beta E_{i})$ and $q_{i}\\exp(\\beta E_{i})$, respectively, and the sums range over the first $k$ components in that common $\\beta$-ordering. Report the value of $\\delta$ in exact form as a single fraction. No rounding is required, and there are no physical units attached to $\\delta$.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n### Step 1: Extract Givens\n-   System: A three-level quantum system (qutrit).\n-   Hamiltonian $H$: Nondegenerate energy eigenvalues $E_{0}=0$, $E_{1}=\\epsilon$, and $E_{2}=2\\epsilon$, with $\\epsilon>0$.\n-   Inverse temperature: $\\beta=\\frac{\\ln 2}{\\epsilon}$.\n-   Gibbs state $\\gamma_{\\beta}$: A thermal state with populations (diagonal elements in the energy eigenbasis) given by $g_{i}=\\frac{\\exp(-\\beta E_{i})}{Z_{\\beta}}$, where $Z_{\\beta}=\\sum_{j=0}^{2}\\exp(-\\beta E_{j})$.\n-   Initial state $\\rho$: A diagonal state with populations $\\boldsymbol{p}=(p_{0},p_{1},p_{2})=(0.1, 0.3, 0.6)$.\n-   Final state $\\sigma$: A diagonal state with populations $\\boldsymbol{q}=(q_{0},q_{1},q_{2})=(0.2, 0.4, 0.4)$.\n-   Thermo-majorization curve: A piecewise-linear curve defined by sorting state populations $\\{p_i\\}$ and Gibbs populations $\\{g_i\\}$ according to decreasing values of the ratio $p_i/g_i$. The vertices of the curve are the cumulative sums of the sorted Gibbs populations (x-coordinates) and the corresponding cumulative sums of the sorted state populations (y-coordinates).\n-   Condition for state conversion $\\rho \\to \\sigma$ under thermal operations: The thermo-majorization curve of $\\rho$ must lie nowhere below the thermo-majorization curve of $\\sigma$.\n-   Worst-case slack $\\delta$: Defined as $\\delta=\\min_{k\\in\\{1,2\\}}\\left[\\sum_{i=1}^{k}p^{\\downarrow\\beta}_{i}-\\sum_{i=1}^{k}q^{\\downarrow\\beta}_{i}\\right]$, where the superscript $\\downarrow\\beta$ denotes ordering according to a common decreasing order of $p_i \\exp(\\beta E_i)$ and $q_i \\exp(\\beta E_i)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It poses a standard question within the well-established framework of quantum thermodynamics and resource theories. All terms are defined, and the data provided are complete and consistent for solving the problem. The question of a \"common $\\beta$-ordering\" is crucial, but its existence can be verified by direct calculation. Therefore, the problem is valid.\n\n### Step 3: Proceed with Solution\n\nA state transition from $\\rho$ to $\\sigma$ is possible via thermal operations if and only if the population vector $\\boldsymbol{p}$ thermo-majorizes the population vector $\\boldsymbol{q}$, denoted as $\\boldsymbol{p} \\succ_{\\beta} \\boldsymbol{q}$. This requires two conditions:\n$1$. The components of $\\boldsymbol{p}$ and $\\boldsymbol{q}$ must have the same ordering when sorted by the ratio $p_i/g_i$ and $q_i/g_i$, respectively. This is the \"common $\\beta$-ordering\".\n$2$. The cumulative sums of the $\\beta$-ordered populations of $\\boldsymbol{p}$ must be greater than or equal to the corresponding cumulative sums for $\\boldsymbol{q}$.\n\nFirst, we compute the Gibbs state populations, $\\{g_i\\}$.\nThe energy eigenvalues are $E_0=0$, $E_1=\\epsilon$, $E_2=2\\epsilon$.\nThe inverse temperature is $\\beta=\\frac{\\ln 2}{\\epsilon}$.\nThe Boltzmann factors are:\n$$\n\\exp(-\\beta E_0) = \\exp(0) = 1\n$$\n$$\n\\exp(-\\beta E_1) = \\exp\\left(-\\frac{\\ln 2}{\\epsilon} \\epsilon\\right) = \\exp(-\\ln 2) = \\frac{1}{2}\n$$\n$$\n\\exp(-\\beta E_2) = \\exp\\left(-\\frac{\\ln 2}{\\epsilon} 2\\epsilon\\right) = \\exp(-2\\ln 2) = \\frac{1}{4}\n$$\nThe partition function $Z_{\\beta}$ is the sum of these factors:\n$$\nZ_{\\beta} = \\sum_{j=0}^{2} \\exp(-\\beta E_j) = 1 + \\frac{1}{2} + \\frac{1}{4} = \\frac{4+2+1}{4} = \\frac{7}{4}\n$$\nThe Gibbs state populations are:\n$$\ng_0 = \\frac{\\exp(-\\beta E_0)}{Z_{\\beta}} = \\frac{1}{7/4} = \\frac{4}{7}\n$$\n$$\ng_1 = \\frac{\\exp(-\\beta E_1)}{Z_{\\beta}} = \\frac{1/2}{7/4} = \\frac{2}{7}\n$$\n$$\ng_2 = \\frac{\\exp(-\\beta E_2)}{Z_{\\beta}} = \\frac{1/4}{7/4} = \\frac{1}{7}\n$$\nSo, the Gibbs population vector is $\\boldsymbol{g} = \\left(\\frac{4}{7}, \\frac{2}{7}, \\frac{1}{7}\\right)$.\n\nNext, we establish the $\\beta$-ordering for both states $\\rho$ and $\\sigma$ by sorting according to the decreasing ratio $p_i/g_i$ (or $q_i/g_i$).\nFor state $\\rho$ with $\\boldsymbol{p}=(0.1, 0.3, 0.6) = (\\frac{1}{10}, \\frac{3}{10}, \\frac{6}{10})$:\n$$\n\\frac{p_0}{g_0} = \\frac{1/10}{4/7} = \\frac{7}{40} = 0.175\n$$\n$$\n\\frac{p_1}{g_1} = \\frac{3/10}{2/7} = \\frac{21}{20} = 1.05\n$$\n$$\n\\frac{p_2}{g_2} = \\frac{6/10}{1/7} = \\frac{42}{10} = 4.2\n$$\nThe decreasing order of these ratios is for indices $(2, 1, 0)$.\n\nFor state $\\sigma$ with $\\boldsymbol{q}=(0.2, 0.4, 0.4) = (\\frac{2}{10}, \\frac{4}{10}, \\frac{4}{10})$:\n$$\n\\frac{q_0}{g_0} = \\frac{2/10}{4/7} = \\frac{14}{40} = \\frac{7}{20} = 0.35\n$$\n$$\n\\frac{q_1}{g_1} = \\frac{4/10}{2/7} = \\frac{28}{20} = \\frac{7}{5} = 1.4\n$$\n$$\n\\frac{q_2}{g_2} = \\frac{4/10}{1/7} = \\frac{28}{10} = 2.8\n$$\nThe decreasing order of these ratios is also for indices $(2, 1, 0)$.\n\nSince both population vectors share the common $\\beta$-ordering of indices $\\pi = (2, 1, 0)$, the condition for thermo-majorization can be tested.\nWe arrange the populations and Gibbs populations according to this common ordering.\nLet $p^{\\downarrow\\beta}_i = p_{\\pi(i)}$ and $q^{\\downarrow\\beta}_i = q_{\\pi(i)}$.\nSorted populations for $\\rho$: $\\boldsymbol{p}^{\\downarrow\\beta} = (p_2, p_1, p_0) = (0.6, 0.3, 0.1)$.\nSorted populations for $\\sigma$: $\\boldsymbol{q}^{\\downarrow\\beta} = (q_2, q_1, q_0) = (0.4, 0.4, 0.2)$.\nSorted Gibbs populations: $\\boldsymbol{g}^{\\downarrow\\beta} = (g_2, g_1, g_0) = (\\frac{1}{7}, \\frac{2}{7}, \\frac{4}{7})$.\n\nNow, we construct the thermo-majorization curves.\nThe curve for $\\rho$ is the piecewise-linear function connecting the points:\n$(0, 0)$\n$(g_2, p_2) = (\\frac{1}{7}, 0.6)$\n$(g_2+g_1, p_2+p_1) = (\\frac{1}{7}+\\frac{2}{7}, 0.6+0.3) = (\\frac{3}{7}, 0.9)$\n$(g_2+g_1+g_0, p_2+p_1+p_0) = (1, 1)$\n\nThe curve for $\\sigma$ is the piecewise-linear function connecting the points:\n$(0, 0)$\n$(g_2, q_2) = (\\frac{1}{7}, 0.4)$\n$(g_2+g_1, q_2+q_1) = (\\frac{1}{7}+\\frac{2}{7}, 0.4+0.4) = (\\frac{3}{7}, 0.8)$\n$(g_2+g_1+g_0, q_2+q_1+q_0) = (1, 1)$\n\nTo determine if the conversion $\\rho \\to \\sigma$ is possible, we check if the thermo-majorization curve of $\\rho$ is always on or above the curve of $\\sigma$. This is equivalent to checking the inequalities on the cumulative sums for $k=1, 2, 3$.\nFor $k=1$: $\\sum_{i=1}^1 p^{\\downarrow\\beta}_i = p_2 = 0.6$ and $\\sum_{i=1}^1 q^{\\downarrow\\beta}_i = q_2 = 0.4$. The condition $0.6 \\ge 0.4$ is satisfied.\nFor $k=2$: $\\sum_{i=1}^2 p^{\\downarrow\\beta}_i = p_2+p_1 = 0.9$ and $\\sum_{i=1}^2 q^{\\downarrow\\beta}_i = q_2+q_1 = 0.8$. The condition $0.9 \\ge 0.8$ is satisfied.\nFor $k=3$: $\\sum_{i=1}^3 p^{\\downarrow\\beta}_i = 1$ and $\\sum_{i=1}^3 q^{\\downarrow\\beta}_i = 1$. The condition $1 \\ge 1$ is satisfied (always with equality).\nSince all conditions are met, $\\boldsymbol{p} \\succ_{\\beta} \\boldsymbol{q}$, and thus the state conversion from $\\rho$ to $\\sigma$ by thermal operations is possible.\n\nFinally, we compute the worst-case slack $\\delta$:\n$$\n\\delta=\\min_{k\\in\\{1,2\\}}\\left[\\sum_{i=1}^{k}p^{\\downarrow\\beta}_{i}-\\sum_{i=1}^{k}q^{\\downarrow\\beta}_{i}\\right]\n$$\nFor $k=1$, the difference is:\n$$\n\\Delta_1 = p^{\\downarrow\\beta}_1 - q^{\\downarrow\\beta}_1 = p_2 - q_2 = 0.6 - 0.4 = 0.2 = \\frac{2}{10} = \\frac{1}{5}\n$$\nFor $k=2$, the difference is:\n$$\n\\Delta_2 = \\sum_{i=1}^{2}p^{\\downarrow\\beta}_{i}-\\sum_{i=1}^{2}q^{\\downarrow\\beta}_{i} = (p_2+p_1) - (q_2+q_1) = (0.6+0.3) - (0.4+0.4) = 0.9 - 0.8 = 0.1 = \\frac{1}{10}\n$$\nThe worst-case slack $\\delta$ is the minimum of these differences:\n$$\n\\delta = \\min(\\Delta_1, \\Delta_2) = \\min\\left(\\frac{1}{5}, \\frac{1}{10}\\right) = \\frac{1}{10}\n$$",
            "answer": "$$\\boxed{\\frac{1}{10}}$$"
        },
        {
            "introduction": "While the thermo-majorization condition may appear similar to the standard majorization used in resource theories of purity, the inclusion of energy and temperature introduces crucial physical constraints. This practice is designed to illuminate this key distinction by presenting a scenario where a state transformation is allowed by majorization but forbidden by thermo-majorization. By working through this example, you will develop a deeper intuition for how energy conservation and the thermal nature of the environment fundamentally shape the set of possible thermodynamic processes .",
            "id": "3790552",
            "problem": "Consider a three-level quantum system with Hamiltonian $H$ having energy eigenvalues $E_0=0$, $E_1=\\epsilon$, and $E_2=3\\epsilon$, where $\\epsilon>0$. Two diagonal (in the energy eigenbasis) states are given by their populations: $\\rho$ with $p=(p_0,p_1,p_2)=(0.6,0.3,0.1)$ and $\\sigma$ with $q=(q_0,q_1,q_2)=(0.55,0.2,0.25)$. Assume incoherent states so that population vectors fully characterize state transformations under thermal operations. Thermal operations (TO) are energy-preserving interactions with a heat bath in the Gibbs state, and their classical reachability is captured by thermo-majorization, which compares thermo-majorization curves constructed from energies and populations at inverse temperature $\\beta$. Gibbs-preserving maps (GPM) are quantum channels that preserve the Gibbs state but need not be implementable by TO; they induce the same thermo-majorization preorder on incoherent states.\n\nUsing only foundational definitions, proceed as follows:\n\n1. Determine, from the definition of majorization on probability vectors, whether the population vector $p$ majorizes $q$.\n\n2. At inverse temperature $\\beta>0$ with $\\beta\\epsilon=\\tfrac{1}{2}$, use the definition of the thermo-majorization curve: order energy levels by decreasing values of the rescaled populations at that $\\beta$ and construct the piecewise-linear cumulative curve in the plane whose horizontal axis accumulates $e^{-\\beta E_i}$ and whose vertical axis accumulates the corresponding probabilities. Explain how high-energy population differences can lead to different orderings for $\\rho$ and $\\sigma$ at this $\\beta$.\n\n3. Using the thermo-majorization curves for $\\rho$ and $\\sigma$ at $\\beta\\epsilon=\\tfrac{1}{2}$, evaluate the vertical gap $D$ between the two curves at the abscissa $X=\\exp(-\\beta E_2)$. Define $D$ as $D=Y_{\\sigma}(X)-Y_{\\rho}(X)$ at that $X$. A strictly positive $D$ certifies that $\\rho$ does not thermo-majorize $\\sigma$ at this temperature.\n\nCompute the numerical value of $D$ and round your final answer to four significant figures. The answer is dimensionless.",
            "solution": "The problem asks for a three-part analysis of two quantum states, $\\rho$ and $\\sigma$, within the framework of quantum thermodynamics, specifically focusing on majorization and thermo-majorization. We will address each part sequentially based on the foundational definitions.\n\nThe system is a three-level quantum system with energy eigenvalues $E_0=0$, $E_1=\\epsilon$, and $E_2=3\\epsilon$ for some $\\epsilon>0$. The states $\\rho$ and $\\sigma$ are diagonal in the energy eigenbasis, with population vectors $p=(p_0,p_1,p_2)=(0.6,0.3,0.1)$ and $q=(q_0,q_1,q_2)=(0.55,0.2,0.25)$, respectively. The analysis is to be performed at an inverse temperature $\\beta$ such that $\\beta\\epsilon=\\tfrac{1}{2}$.\n\n### Part 1: Majorization\n\nMajorization is a preorder on probability vectors. For two vectors $x, y \\in \\mathbb{R}^d$ that sum to $1$, $x$ is said to majorize $y$, denoted $x \\succ y$, if the sum of the $k$ largest components of $x$ is greater than or equal to the sum of the $k$ largest components of $y$, for all $k \\in \\{1, \\dots, d-1\\}$, with equality holding for $k=d$.\n\nLet $x^\\downarrow$ denote the vector $x$ with its components sorted in descending order. The condition for $p \\succ q$ is $\\sum_{i=1}^k p_i^\\downarrow \\ge \\sum_{i=1}^k q_i^\\downarrow$ for $k=1, 2$, and $\\sum_{i=1}^3 p_i^\\downarrow = \\sum_{i=1}^3 q_i^\\downarrow$.\n\nThe given population vectors are $p=(0.6, 0.3, 0.1)$ and $q=(0.55, 0.2, 0.25)$.\nFirst, we sort their components in descending order:\n$p^\\downarrow = (0.6, 0.3, 0.1)$\n$q^\\downarrow = (0.55, 0.25, 0.2)$\n\nNow, we check the cumulative sums:\nFor $k=1$:\n$p_1^\\downarrow = 0.6$\n$q_1^\\downarrow = 0.55$\nThe condition $0.6 \\ge 0.55$ is satisfied.\n\nFor $k=2$:\n$\\sum_{i=1}^2 p_i^\\downarrow = 0.6 + 0.3 = 0.9$\n$\\sum_{i=1}^2 q_i^\\downarrow = 0.55 + 0.25 = 0.8$\nThe condition $0.9 \\ge 0.8$ is satisfied.\n\nFor $k=3$:\n$\\sum_{i=1}^3 p_i^\\downarrow = 0.6 + 0.3 + 0.1 = 1.0$\n$\\sum_{i=1}^3 q_i^\\downarrow = 0.55 + 0.25 + 0.2 = 1.0$\nThe equality holds.\n\nSince all conditions are met, we conclude that the population vector $p$ majorizes $q$, i.e., $p \\succ q$.\n\n### Part 2: Thermo-majorization Curve Construction\n\nThermo-majorization extends the concept of majorization to account for energy constraints imposed by a thermal bath. The thermo-majorization curve for a state with populations $p_i$ at energies $E_i$ is constructed by ordering the energy levels according to the decreasing value of the rescaled populations $p_i / \\exp(-\\beta E_i)$. Let this ordered sequence of indices be $j_0, j_1, j_2$. The vertices of the piecewise-linear curve are $(X_k, Y_k)$ for $k=0,1,2,3$, where $(X_0, Y_0) = (0,0)$ and for $k>0$:\n$$X_k = \\sum_{m=0}^{k-1} \\exp(-\\beta E_{j_m})$$\n$$Y_k = \\sum_{m=0}^{k-1} p_{j_m}$$\n\nWe are given $\\beta\\epsilon = \\tfrac{1}{2}$. The Boltzmann factors $Z_i = \\exp(-\\beta E_i)$ are:\n$Z_0 = \\exp(-\\beta E_0) = \\exp(0) = 1$\n$Z_1 = \\exp(-\\beta E_1) = \\exp(-\\beta\\epsilon) = \\exp(-\\tfrac{1}{2})$\n$Z_2 = \\exp(-\\beta E_2) = \\exp(-3\\beta\\epsilon) = \\exp(-\\tfrac{3}{2})$\n\nFor state $\\rho$ with $p=(0.6, 0.3, 0.1)$:\nThe rescaled populations are $p_i/Z_i$:\n$p_0/Z_0 = 0.6 / 1 = 0.6$\n$p_1/Z_1 = 0.3 / \\exp(-\\tfrac{1}{2}) = 0.3 \\exp(\\tfrac{1}{2}) \\approx 0.3 \\times 1.6487 = 0.49461$\n$p_2/Z_2 = 0.1 / \\exp(-\\tfrac{3}{2}) = 0.1 \\exp(\\tfrac{3}{2}) \\approx 0.1 \\times 4.4817 = 0.44817$\nThe descending order of these values is for $i=0, 1, 2$. So the ordering of indices for $\\rho$ is $(0, 1, 2)$.\n\nFor state $\\sigma$ with $q=(0.55, 0.2, 0.25)$:\nThe rescaled populations are $q_i/Z_i$:\n$q_0/Z_0 = 0.55 / 1 = 0.55$\n$q_1/Z_1 = 0.2 / \\exp(-\\tfrac{1}{2}) = 0.2 \\exp(\\tfrac{1}{2}) \\approx 0.2 \\times 1.6487 = 0.32974$\n$q_2/Z_2 = 0.25 / \\exp(-\\tfrac{3}{2}) = 0.25 \\exp(\\tfrac{3}{2}) \\approx 0.25 \\times 4.4817 = 1.120425$\nThe descending order of these values corresponds to the indices $i=2, 0, 1$. So the ordering of indices for $\\sigma$ is $(2, 0, 1)$.\n\nThe different orderings arise because of the population distribution relative to the energy levels. State $\\rho$ has populations that decrease with energy, a property typical of thermal-like states. The rescaling by $1/Z_i = \\exp(\\beta E_i)$ does not alter this \"natural\" order. In contrast, state $\\sigma$ exhibits a form of population inversion, where the population of the highest energy level ($q_2=0.25$) is greater than that of the intermediate level ($q_1=0.2$). The rescaled population $q_i/Z_i$ is weighted by the factor $\\exp(\\beta E_i)$, which heavily amplifies populations at high energies. For state $\\sigma$, the relatively large population $q_2$ at the high energy $E_2$ results in $q_2/Z_2$ becoming the dominant term, thus changing the ordering. This reordering is a signature of an \"athermal\" resource present in the state $\\sigma$.\n\n### Part 3: Gap Calculation\n\nWe now construct the corner points of the thermo-majorization curves $T_\\rho$ and $T_\\sigma$.\n\nFor $T_\\rho$, the ordering is $(0, 1, 2)$. The points $(X_k, Y_k)$ are:\n$(X_0, Y_0) = (0, 0)$\n$(X_1, Y_1) = (Z_0, p_0) = (1, 0.6)$\n$(X_2, Y_2) = (Z_0+Z_1, p_0+p_1) = (1+\\exp(-\\tfrac{1}{2}), 0.9)$\n$(X_3, Y_3) = (Z_0+Z_1+Z_2, p_0+p_1+p_2) = (1+\\exp(-\\tfrac{1}{2})+\\exp(-\\tfrac{3}{2}), 1.0)$\n\nFor $T_\\sigma$, the ordering is $(2, 0, 1)$. The points $(X_k, Y_k)$ are:\n$(X_0, Y_0) = (0, 0)$\n$(X_1, Y_1) = (Z_2, q_2) = (\\exp(-\\tfrac{3}{2}), 0.25)$\n$(X_2, Y_2) = (Z_2+Z_0, q_2+q_0) = (\\exp(-\\tfrac{3}{2})+1, 0.25+0.55) = (\\exp(-\\tfrac{3}{2})+1, 0.8)$\n$(X_3, Y_3) = (Z_2+Z_0+Z_1, q_2+q_0+q_1) = (\\exp(-\\tfrac{3}{2})+1+\\exp(-\\tfrac{1}{2}), 1.0)$\n\nWe need to calculate the gap $D = Y_{\\sigma}(X) - Y_{\\rho}(X)$ at the abscissa $X = \\exp(-\\beta E_2) = \\exp(-\\tfrac{3}{2})$.\n\nFirst, we find $Y_{\\sigma}(X)$. The point $X = \\exp(-\\tfrac{3}{2})$ is the abscissa of the first corner of the $T_\\sigma$ curve. Thus, the value of the function at this point is simply the ordinate of that corner:\n$Y_{\\sigma}(\\exp(-\\tfrac{3}{2})) = 0.25$.\n\nNext, we find $Y_{\\rho}(X)$. The point $X = \\exp(-\\tfrac{3}{2})$ lies on the first line segment of the $T_\\rho$ curve, which connects $(0,0)$ to $(1, 0.6)$. We confirm that $0 < \\exp(-\\tfrac{3}{2}) < 1$. The equation for this segment is $Y(x) = m x$, with slope $m = \\frac{0.6-0}{1-0} = 0.6$.\nSo, for $x \\in [0, 1]$, $Y_\\rho(x) = 0.6x$. Evaluating at $X$:\n$Y_{\\rho}(\\exp(-\\tfrac{3}{2})) = 0.6 \\times \\exp(-\\tfrac{3}{2})$.\n\nThe gap $D$ is the difference:\n$D = 0.25 - 0.6 \\exp(-\\tfrac{3}{2})$.\n\nNow, we compute the numerical value.\n$\\exp(-\\tfrac{3}{2}) = \\exp(-1.5) \\approx 0.22313016$\n$D \\approx 0.25 - 0.6 \\times 0.22313016$\n$D \\approx 0.25 - 0.13387810$\n$D \\approx 0.1161219$\n\nRounding to four significant figures, we get $D = 0.1161$. Since $D > 0$, the curve for $\\sigma$ lies above the curve for $\\rho$ at this point, which proves that $\\rho$ does not thermo-majorize $\\sigma$ at this temperature.",
            "answer": "$$\\boxed{0.1161}$$"
        },
        {
            "introduction": "Beyond manual comparison of curves, the feasibility of state transitions under thermal operations can be determined with the power and generality of computational optimization. This exercise guides you through framing the state convertibility problem as a linear program, a standard tool in operations research and computer science. By translating the physical conditions of a Gibbs-preserving map into a set of linear constraints, you will implement an algorithmic method to verify thermodynamic possibility, providing a practical and scalable alternative to the graphical approach .",
            "id": "3790542",
            "problem": "You are given a family of state-transition feasibility questions for finite-dimensional, diagonal (quasi-classical) quantum states under thermal operations at a fixed inverse temperature. The goal is to determine whether a desired population transfer is possible via a Gibbs-preserving stochastic map, and to do so by formulating and solving a linear programming feasibility problem. You must implement a program that, for each test case, returns a boolean indicating feasibility.\n\nFundamental base and definitions:\n- Let there be a system with energy levels specified by a finite vector $E = (E_1,\\dots,E_d)$, with $d \\in \\mathbb{N}$.\n- Fix an inverse temperature $\\beta \\ge 0$ (with Boltzmann constant set to unity so that $\\beta$ has units of inverse energy).\n- The Gibbs state associated with $(E,\\beta)$ is the probability vector $g \\in \\mathbb{R}^d$ with entries $g_i = e^{-\\beta E_i}/Z$, where $Z = \\sum_{k=1}^d e^{-\\beta E_k}$.\n- A Gibbs-preserving stochastic map (also called a Gibbs-stochastic matrix) is a matrix $T \\in \\mathbb{R}^{d \\times d}$ that satisfies:\n  1) $T_{ij} \\ge 0$ for all $i,j$,\n  2) $\\sum_{i=1}^d T_{ij} = 1$ for all $j \\in \\{1,\\dots,d\\}$ (column-stochasticity),\n  3) $T g = g$ (Gibbs preservation).\n- A population transfer from an initial state $p \\in \\mathbb{R}^d$ to a target state $q \\in \\mathbb{R}^d$ (both probability vectors) is feasible under thermal operations at inverse temperature $\\beta$ if there exists a Gibbs-stochastic matrix $T$ such that $q = T p$.\n\nThermo-majorization curves:\n- For a given $p$ and $(E,\\beta)$, define weights $r_i = e^{-\\beta E_i}$. The $\\beta$-ordering for $p$ is obtained by sorting indices $i$ by decreasing values of $p_i / r_i$.\n- The thermo-majorization curve of $p$ is the piecewise linear curve passing through points $(X_k, Y_k)$ where $X_k = \\sum_{\\ell=1}^k r_{i_\\ell}$ and $Y_k = \\sum_{\\ell=1}^k p_{i_\\ell}$, with $(i_1,\\dots,i_d)$ being the $\\beta$-ordering for $p$, and also including $(0,0)$.\n- For diagonal states, a necessary and sufficient condition for feasibility is that the thermo-majorization curve of $p$ lies nowhere below that of $q$ when evaluated consistently across the same horizontal coordinate (with respect to the weights defined by $(E,\\beta)$).\n\nYour tasks:\n1) Implement a linear programming formulation to test feasibility of $q = T p$ under the constraints above. Formulate the decision variables as the entries of $T$, and impose all linear equality and inequality constraints. A solution exists if and only if the linear program is feasible.\n2) Implement a thermo-majorization comparison routine that computes the thermo-majorization curve for $p$ and evaluates it at the $x$-coordinates induced by the $\\beta$-ordering of $q$; use this to check whether the thermo-majorization curve of $p$ lies nowhere below that of $q$. Although your programâ€™s final decision must be based on the linear program feasibility, you must implement and internally verify that both methods agree for the provided test suite (within a numerical tolerance).\n3) For numerical stability, you may assume a tolerance of $10^{-9}$ when comparing floating-point quantities.\n\nPhysical units:\n- Energies $E_i$ must be treated in arbitrary but consistent energy units.\n- The inverse temperature $\\beta$ must be treated in units of inverse energy.\n- Population vectors $p$ and $q$ are dimensionless probabilities and must each sum to $1$ (they may be renormalized internally to correct small floating-point deviations).\n\nTest suite:\nFor each case below, use exactly the given parameters. For each case, your program must output a boolean indicating whether the target state $q$ is feasible from $p$ under thermal operations at inverse temperature $\\beta$ and Hamiltonian energies $E$.\n\n- Case A (happy path): $E = [0,1,2]$, $\\beta = 1$, $p = [0.7,0.2,0.1]$, $q = g$ computed from $(E,\\beta)$.\n- Case B (infeasible up-hill change): $E = [0,1,2]$, $\\beta = 1$, $p = g$ computed from $(E,\\beta)$, $q = [1,0,0]$.\n- Case C (nontrivial feasible mixture toward Gibbs state): $E = [0,1,2]$, $\\beta = 0.7$, $p = [0.5,0.3,0.2]$, $q = (1-\\lambda) p + \\lambda g$ with $\\lambda = 0.4$, and $g$ computed from $(E,\\beta)$.\n- Case D (boundary condition: identity map): $E = [0,1,3]$, $\\beta = 0.8$, $p = [0.2,0.5,0.3]$, $q = p$.\n- Case E (edge case attempting to push weight to highest energy level): $E = [0,1,2,3]$, $\\beta = 1.2$, $p = [0.6,0.2,0.15,0.05]$, $q = [0.5,0.2,0.15,0.15]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases A through E (e.g., \"[True,False,True,True,False]\").\n- No external inputs should be read; the program must use the test suite hard-coded within it.",
            "solution": "The problem has been assessed and is deemed valid. It is scientifically grounded in the principles of quantum thermodynamics, specifically the resource theory of athermality. It is well-posed, providing all necessary definitions, constraints, and data for a unique solution to be computed for each test case. The problem is objective and free of ambiguity.\n\nThe task is to determine if a population transfer from an initial quasi-classical state $p$ to a final state $q$ is possible under thermal operations. This feasibility can be determined by solving a linear programming problem or by checking a thermo-majorization condition. The primary method for the final answer will be the linear program, with the thermo-majorization criterion implemented for internal verification.\n\nLet the system have $d$ energy levels, given by the vector $E=(E_1, \\dots, E_d)$. The system is in contact with a heat bath at a fixed inverse temperature $\\beta \\ge 0$. The Boltzmann constant is taken as $k_B=1$.\n\nThe Gibbs state, or thermal equilibrium state, is a probability vector $g$ with components $g_i = \\frac{e^{-\\beta E_i}}{Z}$, where $Z = \\sum_{k=1}^d e^{-\\beta E_k}$ is the partition function. The states $p$ and $q$ are also probability vectors of dimension $d$.\n\nA state transition from $p$ to $q$ is possible if there exists a Gibbs-preserving stochastic map (GPSM) $T \\in \\mathbb{R}^{d \\times d}$ such that $q = Tp$. A matrix $T$ is a GPSM if it satisfies three conditions:\n1.  Non-negativity: $T_{ij} \\ge 0$ for all $i,j \\in \\{1, \\dots, d\\}$.\n2.  Column-stochasticity: $\\sum_{i=1}^d T_{ij} = 1$ for all $j \\in \\{1, \\dots, d\\}$.\n3.  Gibbs-preservation: $Tg = g$, which translates to $\\sum_{j=1}^d T_{ij} g_j = g_i$ for all $i \\in \\{1, \\dots, d\\}$.\n\n**1. Linear Programming (LP) Formulation**\n\nThe existence of such a matrix $T$ can be framed as a linear programming feasibility problem. The decision variables are the $d^2$ entries of the matrix $T$. We can flatten the matrix $T$ into a vector of variables $x \\in \\mathbb{R}^{d^2}$. For instance, using row-major ordering, $x_{k} = T_{i,j}$ where $k = i \\cdot d + j$.\n\nThe problem is to find a vector $x$ that satisfies the set of linear constraints derived from the GPSM properties and the state transition equation.\n\n-   **Constraints:**\n    1.  $T_{ij} \\ge 0$: This translates to $x_{k} \\ge 0$ for all $k \\in \\{0, \\dots, d^2-1\\}$. This is a lower bound constraint on the variables.\n    2.  $\\sum_{i=1}^d T_{ij} = 1$: This provides $d$ linear equality constraints, one for each column $j$.\n    3.  $\\sum_{j=1}^d T_{ij} g_j = g_i$: This provides $d$ linear equality constraints for Gibbs-preservation.\n    4.  $\\sum_{j=1}^d T_{ij} p_j = q_i$: This provides $d$ linear equality constraints for the state transition.\n\nIn total, we have $3d$ linear equality constraints on $d^2$ variables. This can be expressed in the standard form $A_{eq} x = b_{eq}$, where $A_{eq}$ is a $(3d \\times d^2)$ matrix and $b_{eq}$ is a vector of length $3d$.\n\n-   **Objective Function:**\n    Since we are only interested in feasibility, there is no function to optimize. We can set a dummy objective function, such as minimizing $c^T x$ where $c$ is the zero vector. A standard LP solver will then search for any point in the feasible set.\n\nIf the solver finds a solution, the transition is possible (feasible). If the solver determines the problem is infeasible, the transition is not possible.\n\n**2. Thermo-majorization Criterion (for Verification)**\n\nAn equivalent condition for feasibility is based on the concept of thermo-majorization. The problem defines a specific procedure for this check.\n\n1.  **Define weights:** For the given Hamiltonian $E$ and inverse temperature $\\beta$, we define weights $r_i = e^{-\\beta E_i}$.\n2.  **Define $\\beta$-ordering:** For any probability vector $v$, its $\\beta$-ordering is the permutation of indices $(i_1, \\dots, i_d)$ that sorts the ratios $v_i/r_i$ in descending order.\n3.  **Construct thermo-majorization curves:** The curve for a state $p$ is the piecewise linear function connecting the points $(X_k, Y_k)$ for $k \\in \\{0, \\dots, d\\}$, where $(X_0, Y_0)=(0,0)$ and for $k>0$:\n    $$ X_k = \\sum_{\\ell=1}^k r_{i_\\ell} \\quad \\text{and} \\quad Y_k = \\sum_{\\ell=1}^k p_{i_\\ell} $$\n    Here, $(i_1, \\dots, i_d)$ is the $\\beta$-ordering specific to the state $p$. A similar curve is constructed for the state $q$ using its own $\\beta$-ordering. Let's denote these curves as $f_p(x)$ and $f_q(x)$.\n4.  **Compare curves:** The transition $p \\to q$ is feasible if and only if the curve for $p$ lies nowhere below the curve for $q$, i.e., $f_p(x) \\ge f_q(x)$ for all $x$ in their domain of definition. Since the curves are concave, this condition needs to be checked at all \"kink\" points from both curves. The set of check points is the union of the $x$-coordinates of the kinks of $f_p$ and $f_q$. For any check point $x^*$, the values $f_p(x^*)$ and $f_q(x^*)$ are found by linear interpolation between the corresponding adjacent kinks.\n\nThe comparison must respect a numerical tolerance, e.g., $10^{-9}$. That is, the condition fails if $f_p(x) < f_q(x) - 10^{-9}$ for any check point $x$.\n\n**3. Implementation Plan**\n\nThe program will implement both methods. For each test case:\n1.  The parameters $E, \\beta, p, q$ are defined. The probability vectors $p$ and $q$ are normalized to sum to $1$ to correct for any minor floating-point inaccuracies.\n2.  The Gibbs vector $g$ is computed.\n3.  The LP feasibility problem is constructed and solved using `scipy.optimize.linprog`. The result (True for feasible, False for infeasible) is stored.\n4.  The thermo-majorization check is performed as described above. This involves sorting, calculating cumulative sums, and interpolating values for comparison.\n5.  An assertion verifies that both methods yield the same result.\n6.  The result from the LP solver is appended to a list of final answers.\n\n**Analysis of Test Cases:**\n-   **Case A:** $q=g$. A transition to the thermal Gibbs state is always possible from any initial state. This is a manifestation of thermalization. Expected: `True`.\n-   **Case B:** $p=g, q=[1,0,0]$. This represents a transition from the equilibrium state to a pure ground state, which would constitute a decrease in entropy without work input, violating the second law of thermodynamics for this context. Expected: `False`.\n-   **Case C:** $q = (1-\\lambda)p + \\lambda g$. This represents a partial thermalization or mixing process. The transformation can be realized by the matrix $T = (1-\\lambda)I + \\lambda K_g$, where $I$ is the identity and $K_g$ is a matrix with $g$ in every column. This $T$ can be shown to be a valid GPSM for $\\lambda \\in [0,1]$. Expected: `True`.\n-   **Case D:** $p=q$. The transition is trivial, realized by the identity map $T=I$, which is a valid GPSM. Expected: `True`.\n-   **Case E:** This case involves moving population probability from a lower energy level to a higher one ($p_0=0.6 \\to q_0=0.5$ and $p_3=0.05 \\to q_3=0.15$). Such \"uphill\" transitions are generally forbidden. The thermo-majorization condition is expected to fail. Expected: `False`.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the state-transition feasibility problem for the given test suite.\n    \"\"\"\n    \n    tol = 1e-9\n\n    def get_gibbs_state(E, beta):\n        \"\"\"Computes the Gibbs state vector.\"\"\"\n        if beta == 0:\n            return np.full_like(E, 1.0 / len(E))\n        unnormalized_g = np.exp(-beta * E)\n        Z = np.sum(unnormalized_g)\n        return unnormalized_g / Z\n\n    def check_feasibility_lp(E, beta, p, q):\n        \"\"\"\n        Determines feasibility using a linear programming formulation.\n        Variables are the d*d entries of the transition matrix T.\n        \"\"\"\n        d = len(E)\n        \n        # Normalize p and q to be valid probability distributions\n        p = np.array(p, dtype=float) / np.sum(p)\n        q = np.array(q, dtype=float) / np.sum(q)\n        E = np.array(E, dtype=float)\n        \n        g = get_gibbs_state(E, beta)\n\n        # Objective function: 0, as we only care about feasibility\n        c = np.zeros(d * d)\n\n        # Equality constraints A_eq * x = b_eq\n        # x is the flattened T matrix (row-major)\n        A_eq = np.zeros((3 * d, d * d))\n        b_eq = np.zeros(3 * d)\n\n        # 1. State transition: q = T*p\n        for i in range(d):\n            for j in range(d):\n                A_eq[i, i * d + j] = p[j]\n            b_eq[i] = q[i]\n\n        # 2. Column-stochasticity: sum_i T_ij = 1 for each j\n        for j in range(d):\n            for i in range(d):\n                A_eq[d + j, i * d + j] = 1.0\n            b_eq[d + j] = 1.0\n\n        # 3. Gibbs-preservation: T*g = g\n        for i in range(d):\n            for j in range(d):\n                A_eq[2 * d + i, i * d + j] = g[j]\n            b_eq[2 * d + i] = g[i]\n\n        # Bounds: T_ij >= 0 for all i,j\n        bounds = (0, None)\n        \n        # Solve the LP feasibility problem\n        res = linprog(c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n        \n        return res.success\n\n    def check_feasibility_thermo(E, beta, p, q):\n        \"\"\"\n        Determines feasibility using the thermo-majorization criterion.\n        \"\"\"\n        d = len(E)\n        \n        p = np.array(p, dtype=float) / np.sum(p)\n        q = np.array(q, dtype=float) / np.sum(q)\n        E = np.array(E, dtype=float)\n        \n        r = np.exp(-beta * E)\n        \n        def get_thermo_curve(vec, weights):\n            # Avoid division by zero if a weight is zero\n            ratios = np.divide(vec, weights, out=np.full_like(vec, -np.inf), where=weights>tol)\n            \n            # Beta-ordering: sort indices by decreasing ratio\n            sorted_indices = np.argsort(ratios)[::-1]\n            \n            # Cumulative sums for curve points\n            sorted_weights = weights[sorted_indices]\n            sorted_vec = vec[sorted_indices]\n            \n            X_kinks = np.concatenate(([0], np.cumsum(sorted_weights)))\n            Y_kinks = np.concatenate(([0], np.cumsum(sorted_vec)))\n            \n            return X_kinks, Y_kinks\n\n        Xp, Yp = get_thermo_curve(p, r)\n        Xq, Yq = get_thermo_curve(q, r)\n        \n        # Check if curves end at the same point (within tolerance)\n        if not (np.isclose(Xp[-1], Xq[-1], atol=tol) and np.isclose(Yp[-1], Yq[-1], atol=tol)):\n            # This can happen due to fundamental reasons or precision, but for p, q summing to 1,\n            # Yp[-1] and Yq[-1] should both be 1. Xp[-1] and Xq[-1] should be sum(r).\n            # This check is a sanity check on the inputs.\n            pass\n\n        # Combined set of x-coordinates for comparison\n        X_check = np.union1d(Xp, Xq)\n        \n        for x_val in X_check:\n            y_p = np.interp(x_val, Xp, Yp)\n            y_q = np.interp(x_val, Xq, Yq)\n            \n            if y_p  y_q - tol:\n                return False\n        \n        return True\n\n    # Test Suite\n    # Case A: Happy path (relaxation to Gibbs)\n    E_a = [0, 1, 2]\n    beta_a = 1\n    p_a = [0.7, 0.2, 0.1]\n    g_a = get_gibbs_state(np.array(E_a), beta_a)\n    q_a = g_a.tolist()\n\n    # Case B: Infeasible uphill change\n    E_b = [0, 1, 2]\n    beta_b = 1\n    g_b = get_gibbs_state(np.array(E_b), beta_b)\n    p_b = g_b.tolist()\n    q_b = [1, 0, 0]\n\n    # Case C: Nontrivial feasible mixture\n    E_c = [0, 1, 2]\n    beta_c = 0.7\n    p_c_vec = np.array([0.5, 0.3, 0.2])\n    g_c_vec = get_gibbs_state(np.array(E_c), beta_c)\n    lambda_c = 0.4\n    q_c_vec = (1 - lambda_c) * p_c_vec + lambda_c * g_c_vec\n    p_c = p_c_vec.tolist()\n    q_c = q_c_vec.tolist()\n\n    # Case D: Boundary condition (identity)\n    E_d = [0, 1, 3]\n    beta_d = 0.8\n    p_d = [0.2, 0.5, 0.3]\n    q_d = p_d\n\n    # Case E: Edge case (uphill push)\n    E_e = [0, 1, 2, 3]\n    beta_e = 1.2\n    p_e = [0.6, 0.2, 0.15, 0.05]\n    q_e = [0.5, 0.2, 0.15, 0.15]\n\n    test_cases = [\n        (E_a, beta_a, p_a, q_a),\n        (E_b, beta_b, p_b, q_b),\n        (E_c, beta_c, p_c, q_c),\n        (E_d, beta_d, p_d, q_d),\n        (E_e, beta_e, p_e, q_e),\n    ]\n\n    results = []\n    for E, beta, p, q in test_cases:\n        lp_result = check_feasibility_lp(E, beta, p, q)\n        thermo_result = check_feasibility_thermo(E, beta, p, q)\n        \n        # Internal verification\n        assert lp_result == thermo_result, \"LP and Thermo-majorization methods disagree!\"\n        \n        results.append(lp_result)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}