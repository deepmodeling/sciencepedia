{
    "hands_on_practices": [
        {
            "introduction": "The concept of ergotropy quantifies the maximum amount of work that can be extracted from a quantum state using only unitary operations. This exercise () provides a fundamental calculation within the resource theory of athermality, challenging you to determine the work potential of a qutrit system prepared in a non-passive state. By rearranging the state's populations to find the corresponding passive state, you will directly compute the energy difference that constitutes the extractable work.",
            "id": "3783476",
            "problem": "Consider a three-level quantum system (qutrit) with Hamiltonian $H$ having non-degenerate and strictly increasing energy eigenvalues $\\epsilon_{1} < \\epsilon_{2} < \\epsilon_{3}$, and let the system be initially in a state $\\rho$ that is diagonal in the energy eigenbasis with populations $p_{1}$, $p_{2}$, $p_{3}$. Suppose the populations are out of Gibbs order, meaning they are not monotonically non-increasing with energy. In the resource theory of athermality, the ergotropy $\\mathcal{W}(\\rho)$ is defined as the maximal extractable work via unitary operations, \n$$\n\\mathcal{W}(\\rho) = \\max_{U}\\,\\mathrm{Tr}\\!\\left[H\\left(\\rho - U\\rho U^{\\dagger}\\right)\\right],\n$$\nwhere $U$ ranges over all unitary operators on the qutrit Hilbert space. Starting from the definitions of passivity and the spectral invariance of unitary transformations, derive the expression for $\\mathcal{W}(\\rho)$ in terms of the spectrum of $\\rho$ and the energy eigenvalues of $H$ by identifying the passive rearrangement of $\\rho$. Then evaluate $\\mathcal{W}(\\rho)$ for the concrete instance\n$$\n\\epsilon_{1} = 0\\,\\text{J},\\quad \\epsilon_{2} = 3.0 \\times 10^{-21}\\,\\text{J},\\quad \\epsilon_{3} = 5.0 \\times 10^{-21}\\,\\text{J},\n$$\nand\n$$\np_{1} = 0.20,\\quad p_{2} = 0.30,\\quad p_{3} = 0.50.\n$$\nExpress the final answer in Joules. Your final answer must be a single real number. No rounding instruction is required since the inputs are exact decimals.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- System: A three-level quantum system (qutrit).\n- Hamiltonian: $H$ with non-degenerate and strictly increasing energy eigenvalues $\\epsilon_{1} < \\epsilon_{2} < \\epsilon_{3}$.\n- Initial State: $\\rho$, diagonal in the energy eigenbasis with populations $p_{1}$, $p_{2}$, $p_{3}$.\n- Condition: The populations are out of Gibbs order.\n- Definition of Ergotropy: $\\mathcal{W}(\\rho) = \\max_{U}\\,\\mathrm{Tr}\\!\\left[H\\left(\\rho - U\\rho U^{\\dagger}\\right)\\right]$, where $U$ is any unitary operator.\n- Task 1: Derive the expression for $\\mathcal{W}(\\rho)$ by identifying the passive rearrangement of $\\rho$.\n- Task 2: Evaluate $\\mathcal{W}(\\rho)$ for the specific values:\n  - $\\epsilon_{1} = 0\\,\\text{J}$\n  - $\\epsilon_{2} = 3.0 \\times 10^{-21}\\,\\text{J}$\n  - $\\epsilon_{3} = 5.0 \\times 10^{-21}\\,\\text{J}$\n  - $p_{1} = 0.20$\n  - $p_{2} = 0.30$\n  - $p_{3} = 0.50$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on established principles of quantum thermodynamics, specifically the resource theory of athermality. The concepts of ergotropy, passive states, unitary evolution, Hamiltonians, and density matrices are standard in this field.\n- **Well-Posed:** The problem provides all necessary definitions and data to derive a general formula and then compute a specific numerical value. The maximization problem is well-defined and has a unique solution.\n- **Objective:** The problem is stated in precise, formal language without subjective or ambiguous terms.\n- **Flaw Checklist:**\n  1. **Scientific/Factual Unsoundness:** None. The premises are physically and mathematically sound. The given population distribution $p_{1} < p_{2} < p_{3}$ for energy levels $\\epsilon_{1} < \\epsilon_{2} < \\epsilon_{3}$ correctly represents a state with population inversion, which is \"out of Gibbs order\" and thus active (non-passive). The populations sum to $0.20 + 0.30 + 0.50 = 1.0$, as required for a density matrix.\n  2. **Non-Formalizable/Irrelevant:** None. The problem is a formal exercise in quantum thermodynamics.\n  3. **Incomplete/Contradictory Setup:** None. All necessary information is provided and is internally consistent.\n  4. **Unrealistic/Infeasible:** None. The energy and population values are physically plausible for a quantum system.\n  5. **Ill-Posed/Poorly Structured:** None. The problem structure is clear and leads to a unique answer.\n  6. **Pseudo-Profound/Trivial/Tautological:** None. The problem requires a non-trivial application of the definitions and properties of quantum states and operators.\n  7. **Outside Scientific Verifiability:** None. The problem is entirely within the domain of mathematical physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe ergotropy $\\mathcal{W}(\\rho)$ is the maximal work that can be extracted from a quantum state $\\rho$ via unitary operations. It is defined as:\n$$\n\\mathcal{W}(\\rho) = \\max_{U}\\,\\mathrm{Tr}\\!\\left[H\\left(\\rho - U\\rho U^{\\dagger}\\right)\\right]\n$$\nUsing the linearity of the trace, we can rewrite this expression as:\n$$\n\\mathcal{W}(\\rho) = \\mathrm{Tr}(H\\rho) - \\min_{U}\\,\\mathrm{Tr}(H U\\rho U^{\\dagger})\n$$\nThe first term, $\\mathrm{Tr}(H\\rho)$, represents the initial average energy of the system. Since the state $\\rho$ is diagonal in the energy eigenbasis $\\{|E_i\\rangle\\}$ with populations $p_i$, we have $\\rho = \\sum_{i=1}^{3} p_i |E_i\\rangle\\langle E_i|$, and the Hamiltonian is $H = \\sum_{i=1}^{3} \\epsilon_i |E_i\\rangle\\langle E_i|$. The initial energy is:\n$$\nE_{\\text{initial}} = \\mathrm{Tr}(H\\rho) = \\sum_{i=1}^{3} \\epsilon_i p_i\n$$\nThe second term, $\\min_{U}\\,\\mathrm{Tr}(H U\\rho U^{\\dagger})$, represents the minimum possible average energy that the system can reach under unitary evolution from the state $\\rho$. Let $\\rho' = U\\rho U^{\\dagger}$. The problem states that unitary transformations are spectrally invariant, which means that the eigenvalues of $\\rho'$ are the same as the eigenvalues of $\\rho$. Since $\\rho$ is given as diagonal with entries $p_1, p_2, p_3$, these are its eigenvalues (the spectrum of $\\rho$).\n\nWe need to find the state $\\rho'$, having the same eigenvalues as $\\rho$, that minimizes the average energy $\\mathrm{Tr}(H\\rho')$. According to the rearrangement inequality (specifically, von Neumann's trace inequality), for two Hermitian matrices $A$ and $B$, the trace $\\mathrm{Tr}(AB)$ is minimized when their eigenvalues are paired in opposite order. In our case, we wish to minimize $\\mathrm{Tr}(H\\rho')$. The eigenvalues of $H$ are $\\{\\epsilon_i\\}$, which are ordered as $\\epsilon_1 < \\epsilon_2 < \\epsilon_3$. Let the eigenvalues of $\\rho$, which are the populations $\\{p_i\\}$, be sorted in non-increasing order: $p^{\\downarrow}_1 \\ge p^{\\downarrow}_2 \\ge p^{\\downarrow}_3$.\n\nThe minimum energy is achieved when the largest population ($p^{\\downarrow}_1$) is associated with the smallest energy level ($\\epsilon_1$), the second-largest population ($p^{\\downarrow}_2$) with the second-smallest energy level ($\\epsilon_2$), and so on. The state that achieves this minimum energy is called the passive state, $\\rho_{\\text{pass}}$, associated with $\\rho$. Its form in the energy eigenbasis is:\n$$\n\\rho_{\\text{pass}} = \\sum_{i=1}^{3} p^{\\downarrow}_i |E_i\\rangle\\langle E_i|\n$$\nThe minimum energy is therefore:\n$$\nE_{\\text{final,min}} = \\mathrm{Tr}(H\\rho_{\\text{pass}}) = \\sum_{i=1}^{3} \\epsilon_i p^{\\downarrow}_i\n$$\nThis state is passive because no further work can be extracted from it; its populations are already in Gibbs order (non-increasing with energy), so no unitary operation can lower its average energy. The unitary operation $U$ that transforms $\\rho$ to $\\rho_{\\text{pass}}$ is a permutation of the energy eigenstates that reorders the populations $p_i$ into the sorted sequence $p^{\\downarrow}_i$.\n\nCombining these results, the ergotropy is the difference between the initial energy and the energy of the corresponding passive state:\n$$\n\\mathcal{W}(\\rho) = \\mathrm{Tr}(H\\rho) - \\mathrm{Tr}(H\\rho_{\\text{pass}}) = \\left(\\sum_{i=1}^{3} \\epsilon_i p_i\\right) - \\left(\\sum_{i=1}^{3} \\epsilon_i p^{\\downarrow}_i\\right)\n$$\nThis is the general expression for ergotropy in terms of the spectrum of $\\rho$ (the set of populations $\\{p_i\\}$) and the energy eigenvalues $\\{\\epsilon_i\\}$.\n\n### Evaluation for the Concrete Instance\nWe are given the following values:\n- Energies: $\\epsilon_1 = 0\\,\\text{J}$, $\\epsilon_2 = 3.0 \\times 10^{-21}\\,\\text{J}$, $\\epsilon_3 = 5.0 \\times 10^{-21}\\,\\text{J}$.\n- Initial populations: $p_1 = 0.20$, $p_2 = 0.30$, $p_3 = 0.50$.\n\nFirst, we calculate the initial average energy $E_{\\text{initial}} = \\mathrm{Tr}(H\\rho)$:\n$$\nE_{\\text{initial}} = \\epsilon_1 p_1 + \\epsilon_2 p_2 + \\epsilon_3 p_3\n$$\n$$\nE_{\\text{initial}} = (0 \\times 0.20) + (3.0 \\times 10^{-21} \\times 0.30) + (5.0 \\times 10^{-21} \\times 0.50)\n$$\n$$\nE_{\\text{initial}} = 0 + 0.9 \\times 10^{-21} + 2.5 \\times 10^{-21} = 3.4 \\times 10^{-21}\\,\\text{J}\n$$\nNext, we identify the passive arrangement of populations. The initial populations are $\\{p_1, p_2, p_3\\} = \\{0.20, 0.30, 0.50\\}$. Sorting these in non-increasing order gives the passive state populations:\n$$\np^{\\downarrow}_1 = 0.50, \\quad p^{\\downarrow}_2 = 0.30, \\quad p^{\\downarrow}_3 = 0.20\n$$\nNow, we calculate the energy of the passive state, $E_{\\text{final,min}} = \\mathrm{Tr}(H\\rho_{\\text{pass}})$:\n$$\nE_{\\text{final,min}} = \\epsilon_1 p^{\\downarrow}_1 + \\epsilon_2 p^{\\downarrow}_2 + \\epsilon_3 p^{\\downarrow}_3\n$$\n$$\nE_{\\text{final,min}} = (0 \\times 0.50) + (3.0 \\times 10^{-21} \\times 0.30) + (5.0 \\times 10^{-21} \\times 0.20)\n$$\n$$\nE_{\\text{final,min}} = 0 + 0.9 \\times 10^{-21} + 1.0 \\times 10^{-21} = 1.9 \\times 10^{-21}\\,\\text{J}\n$$\nFinally, the ergotropy $\\mathcal{W}(\\rho)$ is the difference between these two energies:\n$$\n\\mathcal{W}(\\rho) = E_{\\text{initial}} - E_{\\text{final,min}} = (3.4 \\times 10^{-21}) - (1.9 \\times 10^{-21})\n$$\n$$\n\\mathcal{W}(\\rho) = 1.5 \\times 10^{-21}\\,\\text{J}\n$$",
            "answer": "$$\\boxed{1.5 \\times 10^{-21}}$$"
        },
        {
            "introduction": "While a decrease in standard free energy is a necessary condition for state-to-state transformations in macroscopic thermodynamics, it is not sufficient in the quantum realm. This practice () illustrates this crucial subtlety by exploring the role of generalized free energies, which act as a family of monotones under thermal operations. By analyzing two specific qubit states, you will demonstrate how a transformation can be forbidden by a higher-order free energy, even when the standard free energy decreases, revealing the richer set of constraints in quantum thermodynamics.",
            "id": "3783486",
            "problem": "Consider a two-level quantum system (qubit) with Hamiltonian $H = \\epsilon \\, |1\\rangle\\langle 1|$ at inverse temperature $\\beta$, so that the Gibbs state is $\\tau = \\frac{1}{Z} \\operatorname{diag}(1, \\exp(-\\beta \\epsilon))$ with partition function $Z = 1 + \\exp(-\\beta \\epsilon)$. For concreteness, take $\\exp(-\\beta \\epsilon) = \\frac{1}{3}$, so that $Z = \\frac{4}{3}$ and $\\tau = \\operatorname{diag}\\!\\left(\\frac{3}{4}, \\frac{1}{4}\\right)$. In the resource theory of athermality under Thermal Operations, the generalized free energies $F_{\\alpha}(\\rho)$ based on Rényi divergences are monotones. For diagonal states in the energy eigenbasis, these can be characterized by the classical Rényi divergences $D_{\\alpha}(\\mathbf{p} \\,\\|\\, \\mathbf{q})$. In particular, the standard nonequilibrium free energy corresponds to the Kullback–Leibler divergence (relative entropy) $D_{1}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\sum_{i} p_{i} \\ln\\!\\left(\\frac{p_{i}}{q_{i}}\\right)$, and the max-free energy corresponds to the max-relative divergence $D_{\\infty}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\ln\\!\\left(\\max_{i} \\frac{p_{i}}{q_{i}}\\right)$. As $F_{\\alpha}(\\rho)$ differs from $k_{B} T D_{\\alpha}(\\rho \\,\\|\\, \\tau)$ by an additive constant independent of $\\rho$, comparing $F_{\\alpha}$ is equivalent to comparing $D_{\\alpha}$.\n\nYour task is to construct and analyze a pair of diagonal qubit states $\\rho$ and $\\sigma$ that witness an obstruction to state conversion despite a decrease in the standard free energy. Specifically, consider the diagonal states\n$$\n\\rho = \\operatorname{diag}\\!\\left(\\frac{4}{5}, \\frac{1}{5}\\right), \\qquad \\sigma = \\operatorname{diag}\\!\\left(\\frac{71}{100}, \\frac{29}{100}\\right),\n$$\nwith the Gibbs state fixed as $\\tau = \\operatorname{diag}\\!\\left(\\frac{3}{4}, \\frac{1}{4}\\right)$.\n\nStarting from the foundational definitions of the Gibbs state and the Rényi divergences above, do the following:\n\n1. Show that $D_{1}(\\rho \\,\\|\\, \\tau) \\ge D_{1}(\\sigma \\,\\|\\, \\tau)$, thereby establishing $F_{1}(\\rho) \\ge F_{1}(\\sigma)$, which is consistent with a decrease of the standard free energy along the hypothetical conversion $\\rho \\to \\sigma$.\n2. Show that $D_{\\infty}(\\rho \\,\\|\\, \\tau) < D_{\\infty}(\\sigma \\,\\|\\, \\tau)$, thereby establishing $F_{\\infty}(\\rho) < F_{\\infty}(\\sigma)$, which signals an obstruction to the conversion under Thermal Operations due to an increase in the max-free energy.\n3. Compute the exact closed-form value of\n$$\n\\Delta \\equiv D_{\\infty}(\\sigma \\,\\|\\, \\tau) - D_{\\infty}(\\rho \\,\\|\\, \\tau).\n$$\n\nExpress the final result for $\\Delta$ as a single analytic expression. No rounding is required, and no physical units are associated with $\\Delta$.",
            "solution": "The problem statement will first be validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- System: A two-level quantum system (qubit).\n- Hamiltonian: $H = \\epsilon \\, |1\\rangle\\langle 1|$.\n- Inverse temperature: $\\beta$.\n- Gibbs state: $\\tau = \\frac{1}{Z} \\operatorname{diag}(1, \\exp(-\\beta \\epsilon))$ with $Z = 1 + \\exp(-\\beta \\epsilon)$.\n- Specific parameter for Gibbs state: $\\exp(-\\beta \\epsilon) = \\frac{1}{3}$.\n- Resulting Gibbs state: $\\tau = \\operatorname{diag}\\!\\left(\\frac{3}{4}, \\frac{1}{4}\\right)$.\n- States for analysis: $\\rho = \\operatorname{diag}\\!\\left(\\frac{4}{5}, \\frac{1}{5}\\right)$ and $\\sigma = \\operatorname{diag}\\!\\left(\\frac{71}{100}, \\frac{29}{100}\\right)$.\n- Definitions for diagonal states with probability vectors $\\mathbf{p}$ and $\\mathbf{q}$:\n  - Kullback–Leibler divergence: $D_{1}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\sum_{i} p_{i} \\ln\\!\\left(\\frac{p_{i}}{q_{i}}\\right)$.\n  - Max-relative divergence: $D_{\\infty}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\ln\\!\\left(\\max_{i} \\frac{p_{i}}{q_{i}}\\right)$.\n- Tasks:\n  1. Show that $D_{1}(\\rho \\,\\|\\, \\tau) \\ge D_{1}(\\sigma \\,\\|\\, \\tau)$.\n  2. Show that $D_{\\infty}(\\rho \\,\\|\\, \\tau) < D_{\\infty}(\\sigma \\,\\|\\, \\tau)$.\n  3. Compute the exact value of $\\Delta \\equiv D_{\\infty}(\\sigma \\,\\|\\, \\tau) - D_{\\infty}(\\rho \\,\\|\\, \\tau)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is sourced from the field of quantum thermodynamics, specifically the resource theory of athermality. All definitions, such as the Gibbs state, Rényi divergences, and their connection to free energies, are standard and correctly stated. The states $\\rho$, $\\sigma$, and $\\tau$ are valid density matrices as their diagonal elements are non-negative and sum to $1$. The questions posed are precise, mathematical, and lead to a unique, verifiable solution. The problem is self-contained, providing all necessary information for the calculations. The scenario, where different free energy monotones ($F_1$ and $F_\\infty$) yield conflicting conditions for a state transformation, is a known and important feature of this resource theory, illustrating that a simple decrease in the standard free energy is not a sufficient condition for a state transition under Thermal Operations. The problem has no scientific or logical flaws.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n***\n\nThe problem requires a comparative analysis of two quantum states, $\\rho$ and $\\sigma$, with respect to a thermal equilibrium state $\\tau$, using two different Rényi divergences, $D_1$ and $D_\\infty$. Since the states are diagonal in the energy eigenbasis, the problem reduces to the comparison of classical probability distributions.\n\nThe probability distributions corresponding to the diagonal elements of the density matrices are:\n- For $\\rho$: $\\mathbf{p}_{\\rho} = \\left(\\frac{4}{5}, \\frac{1}{5}\\right) = (0.8, 0.2)$.\n- For $\\sigma$: $\\mathbf{p}_{\\sigma} = \\left(\\frac{71}{100}, \\frac{29}{100}\\right) = (0.71, 0.29)$.\n- For the Gibbs state $\\tau$: $\\mathbf{q}_{\\tau} = \\left(\\frac{3}{4}, \\frac{1}{4}\\right) = (0.75, 0.25)$.\n\n### 1. Comparison of $D_{1}(\\rho \\,\\|\\, \\tau)$ and $D_{1}(\\sigma \\,\\|\\, \\tau)$\n\nThe Kullback–Leibler divergence is given by $D_{1}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\sum_{i} p_{i} \\ln\\!\\left(\\frac{p_{i}}{q_{i}}\\right)$.\n\nFor the state $\\rho$ relative to $\\tau$:\n$$\nD_{1}(\\rho \\,\\|\\, \\tau) = p_{\\rho,0} \\ln\\left(\\frac{p_{\\rho,0}}{q_{\\tau,0}}\\right) + p_{\\rho,1} \\ln\\left(\\frac{p_{\\rho,1}}{q_{\\tau,1}}\\right)\n= \\frac{4}{5} \\ln\\left(\\frac{4/5}{3/4}\\right) + \\frac{1}{5} \\ln\\left(\\frac{1/5}{1/4}\\right)\n= \\frac{4}{5} \\ln\\left(\\frac{16}{15}\\right) + \\frac{1}{5} \\ln\\left(\\frac{4}{5}\\right).\n$$\n\nFor the state $\\sigma$ relative to $\\tau$:\n$$\nD_{1}(\\sigma \\,\\|\\, \\tau) = p_{\\sigma,0} \\ln\\left(\\frac{p_{\\sigma,0}}{q_{\\tau,0}}\\right) + p_{\\sigma,1} \\ln\\left(\\frac{p_{\\sigma,1}}{q_{\\tau,1}}\\right)\n= \\frac{71}{100} \\ln\\left(\\frac{71/100}{3/4}\\right) + \\frac{29}{100} \\ln\\left(\\frac{29/100}{1/4}\\right)\n= \\frac{71}{100} \\ln\\left(\\frac{284}{300}\\right) + \\frac{29}{100} \\ln\\left(\\frac{116}{100}\\right)\n= \\frac{71}{100} \\ln\\left(\\frac{71}{75}\\right) + \\frac{29}{100} \\ln\\left(\\frac{29}{25}\\right).\n$$\n\nTo show that $D_{1}(\\rho \\,\\|\\, \\tau) \\ge D_{1}(\\sigma \\,\\|\\, \\tau)$, a direct analytical comparison of these logarithmic expressions is highly complex. However, we can analyze the behavior of the relative entropy function. The relative entropy $D_1(\\mathbf{p} \\| \\mathbf{q})$ is a convex function of $\\mathbf{p}$, with its unique minimum of $0$ occurring at $\\mathbf{p}=\\mathbf{q}$. For this two-level system, the distributions are characterized by the probability of the ground state: $p_{\\rho,0} = 0.8$, $p_{\\sigma,0} = 0.71$, and $q_{\\tau,0} = 0.75$.\nThe distance of these probabilities from the thermal probability are:\n$|p_{\\rho,0} - q_{\\tau,0}| = |0.8 - 0.75| = 0.05$.\n$|p_{\\sigma,0} - q_{\\tau,0}| = |0.71 - 0.75| = 0.04$.\nSince $p_{\\rho,0}$ is further from the minimum $q_{\\tau,0}$ than $p_{\\sigma,0}$ is, it is expected that $D_{1}(\\rho \\,\\|\\, \\tau) > D_{1}(\\sigma \\,\\|\\, \\tau)$. To confirm this, we perform a numerical evaluation:\n$$\nD_{1}(\\rho \\,\\|\\, \\tau) = \\frac{4}{5} \\ln\\left(\\frac{16}{15}\\right) + \\frac{1}{5} \\ln\\left(\\frac{4}{5}\\right) \\approx 0.8 \\times (0.0645385) + 0.2 \\times (-0.2231435) \\approx 0.0516308 - 0.0446287 = 0.0070021.\n$$\n$$\nD_{1}(\\sigma \\,\\|\\, \\tau) = \\frac{71}{100} \\ln\\left(\\frac{71}{75}\\right) + \\frac{29}{100} \\ln\\left(\\frac{29}{25}\\right) \\approx 0.71 \\times (-0.0548120) + 0.29 \\times (0.1484200) \\approx -0.0389165 + 0.0430418 = 0.0041253.\n$$\nAs $0.0070021 > 0.0041253$, we have demonstrated that $D_{1}(\\rho \\,\\|\\, \\tau) > D_{1}(\\sigma \\,\\|\\, \\tau)$, which implies $F_1(\\rho) > F_1(\\sigma)$.\n\n### 2. Comparison of $D_{\\infty}(\\rho \\,\\|\\, \\tau)$ and $D_{\\infty}(\\sigma \\,\\|\\, \\tau)$\n\nThe max-relative divergence is given by $D_{\\infty}(\\mathbf{p} \\,\\|\\, \\mathbf{q}) = \\ln\\!\\left(\\max_{i} \\frac{p_{i}}{q_{i}}\\right)$.\n\nFor the state $\\rho$ relative to $\\tau$, we compute the ratios $\\frac{p_{\\rho,i}}{q_{\\tau,i}}$:\n$$\n\\frac{p_{\\rho,0}}{q_{\\tau,0}} = \\frac{4/5}{3/4} = \\frac{16}{15}, \\qquad \\frac{p_{\\rho,1}}{q_{\\tau,1}} = \\frac{1/5}{1/4} = \\frac{4}{5}.\n$$\nThe maximum ratio is $\\max\\left(\\frac{16}{15}, \\frac{4}{5}\\right) = \\max\\left(\\frac{16}{15}, \\frac{12}{15}\\right) = \\frac{16}{15}$.\nThus, $D_{\\infty}(\\rho \\,\\|\\, \\tau) = \\ln\\left(\\frac{16}{15}\\right)$.\n\nFor the state $\\sigma$ relative to $\\tau$, we compute the ratios $\\frac{p_{\\sigma,i}}{q_{\\tau,i}}$:\n$$\n\\frac{p_{\\sigma,0}}{q_{\\tau,0}} = \\frac{71/100}{3/4} = \\frac{71 \\times 4}{100 \\times 3} = \\frac{284}{300} = \\frac{71}{75}.\n$$\n$$\n\\frac{p_{\\sigma,1}}{q_{\\tau,1}} = \\frac{29/100}{1/4} = \\frac{29 \\times 4}{100} = \\frac{116}{100} = \\frac{29}{25}.\n$$\nThe maximum ratio is $\\max\\left(\\frac{71}{75}, \\frac{29}{25}\\right) = \\max\\left(\\frac{71}{75}, \\frac{3 \\times 29}{3 \\times 25}\\right) = \\max\\left(\\frac{71}{75}, \\frac{87}{75}\\right) = \\frac{87}{75} = \\frac{29}{25}$.\nThus, $D_{\\infty}(\\sigma \\,\\|\\, \\tau) = \\ln\\left(\\frac{29}{25}\\right)$.\n\nTo show that $D_{\\infty}(\\rho \\,\\|\\, \\tau) < D_{\\infty}(\\sigma \\,\\|\\, \\tau)$, we compare their arguments, since $\\ln(x)$ is a strictly increasing function for $x>0$:\nWe compare $\\frac{16}{15}$ and $\\frac{29}{25}$.\nLet's find a common denominator, which is $75$:\n$$\n\\frac{16}{15} = \\frac{16 \\times 5}{15 \\times 5} = \\frac{80}{75}.\n$$\n$$\n\\frac{29}{25} = \\frac{29 \\times 3}{25 \\times 3} = \\frac{87}{75}.\n$$\nSince $\\frac{80}{75} < \\frac{87}{75}$, it follows that $\\frac{16}{15} < \\frac{29}{25}$.\nTherefore, $\\ln\\left(\\frac{16}{15}\\right) < \\ln\\left(\\frac{29}{25}\\right)$, which proves that $D_{\\infty}(\\rho \\,\\|\\, \\tau) < D_{\\infty}(\\sigma \\,\\|\\, \\tau)$. This implies $F_\\infty(\\rho) < F_\\infty(\\sigma)$, which is an obstruction to the conversion $\\rho \\to \\sigma$ under Thermal Operations.\n\n### 3. Computation of $\\Delta$\n\nWe are asked to compute the exact closed-form value of $\\Delta = D_{\\infty}(\\sigma \\,\\|\\, \\tau) - D_{\\infty}(\\rho \\,\\|\\, \\tau)$.\nUsing the results from the previous section:\n$$\n\\Delta = \\ln\\left(\\frac{29}{25}\\right) - \\ln\\left(\\frac{16}{15}\\right).\n$$\nUsing the logarithm property $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$\n\\Delta = \\ln\\left(\\frac{29/25}{16/15}\\right) = \\ln\\left(\\frac{29}{25} \\times \\frac{15}{16}\\right).\n$$\nSimplifying the fraction:\n$$\n\\Delta = \\ln\\left(\\frac{29 \\times (3 \\times 5)}{(5 \\times 5) \\times 16}\\right) = \\ln\\left(\\frac{29 \\times 3}{5 \\times 16}\\right) = \\ln\\left(\\frac{87}{80}\\right).\n$$\nThis is the exact closed-form value for $\\Delta$.",
            "answer": "$$\n\\boxed{\\ln\\left(\\frac{87}{80}\\right)}\n$$"
        },
        {
            "introduction": "The resource theory of athermality is deeply connected to the broader field of non-equilibrium statistical mechanics, particularly through fluctuation theorems that govern work and heat in small systems. This computational exercise () tasks you with numerically verifying the celebrated Jarzynski equality and Crooks relation for a driven qubit. By implementing a two-point measurement protocol, you will construct the full work distribution and confirm these fundamental relationships, bridging abstract theory with practical simulation.",
            "id": "3783444",
            "problem": "Consider a single qubit subject to unitary driving between two Hamiltonians within the two-point measurement (TPM) scheme, where TPM stands for two-point measurement. The initial state at the start of the protocol is the Gibbs thermal state at inverse temperature $\\beta$ for the initial Hamiltonian. This setting is a canonical model in the resource theory of athermality, where Gibbs states are free states and unitary drivings generate athermality that can be quantified via nonequilibrium work fluctuations.\n\nUse the following physically consistent model:\n\n- The Pauli matrices are $\\,\\sigma_x = \\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}\\,$, $\\,\\sigma_y = \\begin{pmatrix}0 & -i \\\\ i & 0\\end{pmatrix}\\,$, and $\\,\\sigma_z = \\begin{pmatrix}1 & 0 \\\\ 0 & -1\\end{pmatrix}\\,$.\n- The initial Hamiltonian is $\\,H_i = \\frac{\\Delta_i}{2}\\,\\sigma_z\\,$, with gap parameter $\\,\\Delta_i > 0\\,$.\n- The final Hamiltonian is $\\,H_f = \\frac{\\Delta_f}{2}\\big(\\cos\\varphi\\,\\sigma_z + \\sin\\varphi\\,\\sigma_x\\big)\\,$, with gap parameter $\\,\\Delta_f > 0\\,$ and Bloch-angle $\\,\\varphi \\in \\mathbb{R}\\,$.\n- The unitary that implements the driving protocol is a $y$-axis rotation $\\,U(\\theta) = e^{-i\\,\\theta\\,\\sigma_y/2} = \\cos\\!\\big(\\frac{\\theta}{2}\\big)\\,\\mathbb{I} - i\\,\\sin\\!\\big(\\frac{\\theta}{2}\\big)\\,\\sigma_y\\,$, with rotation angle $\\,\\theta \\in \\mathbb{R}\\,$.\n\nUnder the TPM protocol:\n- At the start, perform a projective measurement of $\\,H_i\\,$. The outcome $\\,E_n^i\\,$ collapses the state into the corresponding eigenvector $\\,\\lvert n^i\\rangle\\,$, and occurs with Gibbs probability determined by $\\,\\beta\\,$ and $\\,H_i\\,$.\n- Evolve the state by $\\,U(\\theta)\\,$.\n- Perform a projective measurement of $\\,H_f\\,$ with outcome $\\,E_m^f\\,$ corresponding to eigenvector $\\,\\lvert m^f\\rangle\\,$.\n- The forward work value is $\\,W = E_m^f - E_n^i\\,$. The forward work distribution is supported on the discrete set of such differences.\n- The reverse protocol starts from the Gibbs state of $\\,H_f\\,$, measures $\\,H_f\\,$, evolves by $\\,U(\\theta)^\\dagger\\,$, measures $\\,H_i\\,$, and assigns reverse work $\\,W_\\mathrm{rev} = E_n^i - E_m^f = -W\\,$. The reverse work distribution is supported on the negative of the forward differences.\n\nImplement, from the above fundamental definitions (Gibbs state, projective measurement and collapse, Born rule, unitary evolution), the forward and reverse work distributions and numerically assess the nonequilibrium fluctuation relations associated with TPM. Specifically, for each test case:\n- Construct the distributions of forward and reverse work values and compute the ensemble average of $\\,e^{-\\beta W}\\,$ over the forward distribution.\n- Compute the equilibrium free energy difference $\\,\\Delta F\\,$ from the partition functions $\\,Z_i\\,$ and $\\,Z_f\\,$ of $\\,H_i\\,$ and $\\,H_f\\,$ at inverse temperature $\\,\\beta\\,$.\n- For the Crooks-type ratio test, evaluate the ratio of forward probability at work $\\,W\\,$ to reverse probability at work $\\,{-W}\\,$ for each supported $\\,W\\,$ and compare to the equilibrium prediction implied by the TPM fluctuation relation. Aggregate the maximum absolute deviation over all supported forward work values for the test case.\n- For the Jarzynski-type exponential average test, compute the absolute deviation between the forward ensemble average of $\\,e^{-\\beta W}\\,$ and the equilibrium prediction implied by the TPM fluctuation relation.\n\nYour program must return, for each test case, a list $[d_J, d_C, J_\\mathrm{ok}, C_\\mathrm{ok}]$ containing:\n- $d_J$: the absolute deviation in the Jarzynski-type test as a float.\n- $d_C$: the maximum absolute deviation in the Crooks-type ratio test as a float.\n- $J_\\mathrm{ok}$: a boolean that is true if $d_J \\leq 10^{-10}$ and false otherwise.\n- $C_\\mathrm{ok}$: a boolean that is true if $d_C \\leq 10^{-10}$ and false otherwise.\n\nNo physical unit conversion is required because all outputs are dimensionless deviations and booleans.\n\nTest suite parameter sets to cover general behavior and edge conditions:\n1. $\\beta = 0.7$, $\\Delta_i = 1.0$, $\\Delta_f = 1.3$, $\\varphi = 0.4$, $\\theta = 0.6$.\n2. $\\beta = 5.0$, $\\Delta_i = 1.5$, $\\Delta_f = 0.8$, $\\varphi = 1.0$, $\\theta = \\frac{\\pi}{2}$.\n3. $\\beta = 0.05$, $\\Delta_i = 1.0$, $\\Delta_f = 2.0$, $\\varphi = 0.2$, $\\theta = 0.3$.\n4. $\\beta = 1.2$, $\\Delta_i = 1.0$, $\\Delta_f = 1.0$, $\\varphi = 0.0$, $\\theta = 0.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result appears as a four-element sublist in the same order as the test suite. For example, the output format must be like \"[[result_case1],[result_case2],[result_case3],[result_case4]]\", with booleans literally printed as \"True\" or \"False\".",
            "solution": "The problem requires a thorough analysis of a driven two-level quantum system (a qubit) within the two-point measurement (TPM) framework to verify the Jarzynski and Crooks fluctuation relations. The solution proceeds by first determining the eigensystems of the initial and final Hamiltonians, then calculating the work distributions for the forward and reverse protocols, and finally computing the specified deviations from the fluctuation relations.\n\nStep 1: Eigensystems of the Hamiltonians\n\nThe initial Hamiltonian is given by $H_i = \\frac{\\Delta_i}{2}\\,\\sigma_z$. Its matrix form is:\n$$\nH_i = \\frac{\\Delta_i}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\nThe eigenvalues are $E_{e,i} = +\\frac{\\Delta_i}{2}$ and $E_{g,i} = -\\frac{\\Delta_i}{2}$. The corresponding eigenvectors are the standard computational basis states:\n$$\n\\lvert e^i \\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\quad , \\quad \\lvert g^i \\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\nThe final Hamiltonian is $H_f = \\frac{\\Delta_f}{2}\\big(\\cos\\varphi\\,\\sigma_z + \\sin\\varphi\\,\\sigma_x\\big)$. Its matrix form is:\n$$\nH_f = \\frac{\\Delta_f}{2} \\begin{pmatrix} \\cos\\varphi & \\sin\\varphi \\\\ \\sin\\varphi & -\\cos\\varphi \\end{pmatrix}\n$$\nThis Hamiltonian is proportional to a Pauli vector rotated by an angle $\\varphi$ from the $z$-axis towards the $x$-axis. Its eigenvalues are independent of this rotation and are given by $E_{e,f} = +\\frac{\\Delta_f}{2}$ and $E_{g,f} = -\\frac{\\Delta_f}{2}$. The corresponding eigenvectors are found by solving the eigenvalue equation. They are:\n$$\n\\lvert e^f \\rangle = \\begin{pmatrix} \\cos(\\varphi/2) \\\\ \\sin(\\varphi/2) \\end{pmatrix} \\quad , \\quad \\lvert g^f \\rangle = \\begin{pmatrix} -\\sin(\\varphi/2) \\\\ \\cos(\\varphi/2) \\end{pmatrix}\n$$\n\nStep 2: Partition Functions and Free Energy Difference\n\nThe partition function for a system with Hamiltonian $H$ at inverse temperature $\\beta$ is $Z = \\text{Tr}(e^{-\\beta H}) = \\sum_k e^{-\\beta E_k}$.\nFor the initial system:\n$$\nZ_i = e^{-\\beta E_{g,i}} + e^{-\\beta E_{e,i}} = e^{\\beta \\Delta_i / 2} + e^{-\\beta \\Delta_i / 2} = 2 \\cosh\\left(\\frac{\\beta \\Delta_i}{2}\\right)\n$$\nFor the final system:\n$$\nZ_f = e^{-\\beta E_{g,f}} + e^{-\\beta E_{e,f}} = e^{\\beta \\Delta_f / 2} + e^{-\\beta \\Delta_f / 2} = 2 \\cosh\\left(\\frac{\\beta \\Delta_f}{2}\\right)\n$$\nThe equilibrium free energy difference is $\\Delta F = F_f - F_i = -\\frac{1}{\\beta} \\ln(Z_f) - (-\\frac{1}{\\beta} \\ln(Z_i)) = -\\frac{1}{\\beta} \\ln\\left(\\frac{Z_f}{Z_i}\\right)$.\n\nStep 3: Unitary Evolution and Transition Probabilities\n\nThe unitary evolution is a rotation around the $y$-axis, $U(\\theta) = e^{-i\\,\\theta\\,\\sigma_y/2}$, which has the matrix representation:\n$$\nU(\\theta) = \\cos(\\theta/2)\\,\\mathbb{I} - i\\,\\sin(\\theta/2)\\,\\sigma_y = \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix}\n$$\nThe core of the TPM protocol is the probability of transitioning from an initial energy eigenstate $\\lvert n^i \\rangle$ to a final energy eigenstate $\\lvert m^f \\rangle$ after the unitary evolution $U(\\theta)$. This is given by the Born rule: $p(m|n) = |\\langle m^f | U(\\theta) | n^i \\rangle|^2$.\nLet's compute the four transition amplitudes:\n- $\\langle g^f | U(\\theta) | g^i \\rangle = \\begin{pmatrix} -\\sin(\\varphi/2) & \\cos(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\cos(\\varphi/2)\\cos(\\theta/2) + \\sin(\\varphi/2)\\sin(\\theta/2) = \\cos\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $\\langle e^f | U(\\theta) | g^i \\rangle = \\begin{pmatrix} \\cos(\\varphi/2) & \\sin(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\sin(\\varphi/2)\\cos(\\theta/2) - \\cos(\\varphi/2)\\sin(\\theta/2) = \\sin\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $\\langle g^f | U(\\theta) | e^i \\rangle = \\begin{pmatrix} -\\sin(\\varphi/2) & \\cos(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\cos(\\varphi/2)\\sin(\\theta/2) - \\sin(\\varphi/2)\\cos(\\theta/2) = -\\sin\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $\\langle e^f | U(\\theta) | e^i \\rangle = \\begin{pmatrix} \\cos(\\varphi/2) & \\sin(\\varphi/2) \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\cos(\\varphi/2)\\cos(\\theta/2) + \\sin(\\varphi/2)\\sin(\\theta/2) = \\cos\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n\nThe transition probabilities are the squares of these amplitudes:\n- $p(g \\to g) = |\\langle g^f | U | g^i \\rangle|^2 = \\cos^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $p(g \\to e) = |\\langle e^f | U | g^i \\rangle|^2 = \\sin^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $p(e \\to g) = |\\langle g^f | U | e^i \\rangle|^2 = \\sin^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n- $p(e \\to e) = |\\langle e^f | U | e^i \\rangle|^2 = \\cos^2\\left(\\frac{\\varphi-\\theta}{2}\\right)$\n\nStep 4: Forward and Reverse Work Distributions\n\nIn the forward protocol, the system is initially in a Gibbs state of $H_i$. The probability of measuring the state to be $\\lvert n^i \\rangle$ (with energy $E_n^i$) is $p_n^i = e^{-\\beta E_n^i} / Z_i$. The total probability of a work outcome $W = E_m^f - E_n^i$ is $P_{fwd}(W) = \\sum_{n,m:E_m^f-E_n^i=W} p(m|n) p_n^i$. The four possible work values and their probabilities are:\n- $W_{g \\to g} = E_{g,f} - E_{g,i} = \\frac{\\Delta_i - \\Delta_f}{2}$ with probability $p(g \\to g) \\cdot (e^{\\beta \\Delta_i/2}/Z_i)$\n- $W_{g \\to e} = E_{e,f} - E_{g,i} = \\frac{\\Delta_i + \\Delta_f}{2}$ with probability $p(g \\to e) \\cdot (e^{\\beta \\Delta_i/2}/Z_i)$\n- $W_{e \\to g} = E_{g,f} - E_{e,i} = -\\frac{\\Delta_i + \\Delta_f}{2}$ with probability $p(e \\to g) \\cdot (e^{-\\beta \\Delta_i/2}/Z_i)$\n- $W_{e \\to e} = E_{e,f} - E_{e,i} = \\frac{\\Delta_f - \\Delta_i}{2}$ with probability $p(e \\to e) \\cdot (e^{-\\beta \\Delta_i/2}/Z_i)$\n\nIn the reverse protocol, the system starts in a Gibbs state of $H_f$, evolves under $U(\\theta)^\\dagger$, and is measured in the basis of $H_i$. The reverse work is $W_{\\mathrm{rev}} = E_n^i - E_m^f = -W$. The probability of a transition from $\\lvert m^f \\rangle$ to $\\lvert n^i \\rangle$ under $U(\\theta)^\\dagger$ is $p(n|m)_{\\mathrm{rev}} = |\\langle n^i | U^\\dagger | m^f \\rangle|^2 = |\\langle m^f | U | n^i \\rangle|^2 = p(m|n)$. The reverse work distribution is $P_{\\mathrm{rev}}(W_{\\mathrm{rev}}) = \\sum_{n,m:E_n^i-E_m^f=W_{\\mathrm{rev}}} p(n|m)_{\\mathrm{rev}} \\cdot (e^{-\\beta E_m^f}/Z_f)$.\n\nStep 5: Nonequilibrium Fluctuation Relations Tests\n\nThe Jarzynski equality states $\\langle e^{-\\beta W} \\rangle_{fwd} = e^{-\\beta \\Delta F}$. The left-hand side is computed by averaging over the forward work distribution:\n$$\n\\langle e^{-\\beta W} \\rangle_{fwd} = \\sum_W P_{fwd}(W) e^{-\\beta W}\n$$\nThe right-hand side is $e^{-\\beta \\Delta F} = e^{\\ln(Z_f/Z_i)} = Z_f/Z_i$. The Jarzynski deviation is $d_J = \\left| \\langle e^{-\\beta W} \\rangle_{fwd} - Z_f/Z_i \\right|$.\n\nThe Crooks fluctuation theorem relates the forward and reverse work-probability distributions:\n$$\n\\frac{P_{fwd}(W)}{P_{rev}(-W)} = e^{\\beta(W - \\Delta F)}\n$$\nThis relation is exact for any work value $W$ in the support of the distributions. The Crooks deviation $d_C$ is the maximum absolute deviation from this equality over all possible forward work values. For each $W_k$ in the support of $P_{fwd}$, we calculate the deviation $\\left| \\frac{P_{fwd}(W_k)}{P_{rev}(-W_k)} - e^{\\beta(W_k - \\Delta F)} \\right|$, and $d_C$ is the maximum of these values. As the relations are exact, both $d_J$ and $d_C$ are expected to be zero up to numerical floating-point precision.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum work fluctuation problem for a driven qubit.\n    \"\"\"\n\n    test_cases = [\n        {'beta': 0.7, 'delta_i': 1.0, 'delta_f': 1.3, 'phi': 0.4, 'theta': 0.6},\n        {'beta': 5.0, 'delta_i': 1.5, 'delta_f': 0.8, 'phi': 1.0, 'theta': np.pi / 2},\n        {'beta': 0.05, 'delta_i': 1.0, 'delta_f': 2.0, 'phi': 0.2, 'theta': 0.3},\n        {'beta': 1.2, 'delta_i': 1.0, 'delta_f': 1.0, 'phi': 0.0, 'theta': 0.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(calculate_fluctuation_relations(**params))\n\n    # Format the final output string\n    # e.g., [[0.0, 0.0, True, True],[...]]\n    formatted_results = []\n    for res in results:\n        # Format: [d_J, d_C, J_ok, C_ok]\n        d_J_str = f\"{res[0]:.16e}\"  # Using scientific notation for small numbers\n        d_C_str = f\"{res[1]:.16e}\" \n        J_ok_str = str(res[2])\n        C_ok_str = str(res[3])\n        formatted_results.append(f\"[{d_J_str},{d_C_str},{J_ok_str},{C_ok_str}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_fluctuation_relations(beta, delta_i, delta_f, phi, theta):\n    \"\"\"\n    Calculates the deviations for Jarzynski and Crooks relations for a single test case.\n\n    Args:\n        beta (float): Inverse temperature.\n        delta_i (float): Gap of the initial Hamiltonian.\n        delta_f (float): Gap of the final Hamiltonian.\n        phi (float): Bloch-angle for the final Hamiltonian.\n        theta (float): Rotation angle for the unitary driving.\n\n    Returns:\n        list: A list [d_J, d_C, J_ok, C_ok] containing the results.\n    \"\"\"\n    # Step 1: Eigensystems\n    # Energies are denoted as Ei_g, Ei_e for ground and excited states of H_i\n    Ei_g, Ei_e = -delta_i / 2.0, delta_i / 2.0\n    Ef_g, Ef_e = -delta_f / 2.0, delta_f / 2.0\n\n    # Step 2: Partition functions and free energy\n    Zi = 2.0 * np.cosh(beta * delta_i / 2.0)\n    Zf = 2.0 * np.cosh(beta * delta_f / 2.0)\n    \n    # Handle beta=0 case to avoid division by zero, although not in test suite.\n    if beta == 0:\n        # For beta=0, rho is proportional to identity, F = -T*S = -T*k*log(dim) -> 0.\n        delta_F = 0\n    else:\n        delta_F = -1.0/beta * np.log(Zf / Zi)\n\n    # Step 3: Transition probabilities\n    angle_diff_half = (phi - theta) / 2.0\n    \n    # p_g2g: prob of g_i -> g_f, p_g2e: prob of g_i -> e_f, etc.\n    p_g2g = np.cos(angle_diff_half)**2\n    p_g2e = np.sin(angle_diff_half)**2\n    # By symmetry, p(e->g) = p(g->e) and p(e->e) = p(g->g)\n    p_e2g = p_g2e\n    p_e2e = p_g2g\n    \n    # Step 4: Work distributions\n    # Probabilities of occupying initial states\n    p_gi = np.exp(-beta * Ei_g) / Zi\n    p_ei = np.exp(-beta * Ei_e) / Zi\n    \n    # Probabilities of occupying final states (for reverse protocol)\n    p_gf = np.exp(-beta * Ef_g) / Zf\n    p_ef = np.exp(-beta * Ef_e) / Zf\n    \n    # Forward work distribution (dictionary: {work_value: probability})\n    fwd_work_dist = {}\n    transitions = [\n        (Ei_g, Ef_g, p_gi, p_g2g),  # g_i -> g_f\n        (Ei_g, Ef_e, p_gi, p_g2e),  # g_i -> e_f\n        (Ei_e, Ef_g, p_ei,p_e2g),  # e_i -> g_f\n        (Ei_e, Ef_e, p_ei, p_e2e),  # e_i -> e_f\n    ]\n    for E_start, E_end, p_initial, p_trans in transitions:\n        W = E_end - E_start\n        prob = p_trans * p_initial\n        fwd_work_dist[W] = fwd_work_dist.get(W, 0) + prob\n\n    # Reverse work distribution\n    rev_work_dist = {}\n    rev_transitions = [\n        (Ef_g, Ei_g, p_gf, p_g2g),  # g_f -> g_i, transition prob is p(g->g)\n        (Ef_g, Ei_e, p_gf, p_e2g),  # g_f -> e_i, transition prob is p(e->g)\n        (Ef_e, Ei_g, p_ef, p_g2e),  # e_f -> g_i, transition prob is p(g->e)\n        (Ef_e, Ei_e, p_ef, p_e2e),  # e_f -> e_i, transition prob is p(e->e)\n    ]\n    for E_start, E_end, p_initial, p_trans in rev_transitions:\n        W_rev = E_end - E_start\n        prob = p_trans * p_initial\n        rev_work_dist[W_rev] = rev_work_dist.get(W_rev, 0) + prob\n        \n    # Step 5: Fluctuation relation tests\n    \n    # Jarzynski test\n    jarzynski_avg = sum(p * np.exp(-beta * W) for W, p in fwd_work_dist.items())\n    jarzynski_pred = Zf / Zi\n    d_J = float(np.abs(jarzynski_avg - jarzynski_pred))\n    \n    # Crooks test\n    crooks_devs = []\n    \n    for W, P_fwd in fwd_work_dist.items():\n        if P_fwd > 1e-15:  # Consider only numerically supported work values\n            P_rev_at_minus_W = rev_work_dist.get(-W, 0.0)\n            \n            if P_rev_at_minus_W > 1e-15:\n                ratio = P_fwd / P_rev_at_minus_W\n                prediction = np.exp(beta * (W - delta_F))\n                crooks_devs.append(np.abs(ratio - prediction))\n            else: # P_fwd > 0 but P_rev(-W) = 0. This implies P_fwd is also 0 due to the theorem.\n                  # If not, it signals a deeper numerical issue or a violation.\n                  # A P_fwd > 0 means some p_trans*p_initial > 0.\n                  # This implies p_trans > 0 and p_initial > 0 (for finite beta).\n                  # So, p_rev_trans > 0 and p_final > 0, so P_rev(-W) must be > 0.\n                  # Any deviation is numerical error. Check against prediction for ratio.\n                  prediction = np.exp(beta * (W - delta_F))\n                  # If P_fwd is tiny, ratio can be huge. But the theorem P_fwd = P_rev(-W) * pred\n                  # implies P_fwd should also be zero. We can assume 0 deviation.\n                  crooks_devs.append(0.0)\n\n    d_C = float(max(crooks_devs)) if crooks_devs else 0.0\n\n    # Verdicts\n    tol = 1e-10\n    J_ok = d_J = tol\n    C_ok = d_C = tol\n    \n    return [d_J, d_C, J_ok, C_ok]\n\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}