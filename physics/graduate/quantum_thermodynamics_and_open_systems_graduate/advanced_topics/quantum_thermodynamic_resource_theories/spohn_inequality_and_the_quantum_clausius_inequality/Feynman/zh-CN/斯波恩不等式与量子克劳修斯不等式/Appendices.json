{
    "hands_on_practices": [
        {
            "introduction": "开放系统演化的一类重要特例是幺正动力学（unital dynamics），它能保持最大混合态不变。这一特性对系统冯·诺依曼熵的行为有着直接而深刻的影响。本练习  将指导你推导幺正性的条件，并理解其与第二定律的联系，帮助你区分系统熵变与总熵产生这两个不同但相关的概念。",
            "id": "3784762",
            "problem": "考虑一个双能级量子系统（量子比特），其哈密顿量为 $H = \\frac{\\omega}{2}\\,\\sigma_z$，其中 $\\sigma_z$ 是泡利 $z$ 矩阵。该系统在由一个 Gorini–Kossakowski–Sudarshan–Lindblad (GKSL) 生成元 $\\mathcal{L}$ 生成的时齐马尔可夫动力学下演化。耗散部分由跃迁算符指定：\n$$\nL_1 = \\sqrt{\\gamma}\\,\\sigma_- = \\sqrt{\\gamma}\\,|0\\rangle\\langle 1|,\\quad\nL_2 = \\sqrt{\\kappa}\\,\\sigma_+ = \\sqrt{\\kappa}\\,|1\\rangle\\langle 0|,\\quad\nL_3 = \\sqrt{\\lambda}\\,\\sigma_z,\n$$\n其中速率 $\\gamma,\\kappa,\\lambda\\ge 0$。生成元的作用形式为 $\\dot{\\rho}_t = \\mathcal{L}(\\rho_t)$，具有标准的 GKSL 结构。如果 $\\mathcal{L}(I)=0$（其中 $I$ 是单位算符），则称一个量子动力学半群是幺正的 (unital)。请使用适用于开放量子系统的基本定义和定律，判断由上述 $L_k$ 定义的半群是否是幺正的，并根据 Spohn 不等式和量子克劳修斯不等式，推断其对熵产生和冯·诺伊曼熵 $S(\\rho_t)=-\\operatorname{Tr}[\\rho_t\\log\\rho_t]$ 的影响。\n\n下列哪个陈述是正确的？\n\nA. 半群是幺正的，当且仅当 $\\gamma=\\kappa$。在这种情况下，对于稳态 $\\sigma=I/2$，Spohn 不等式意味着对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\ge 0$，因此冯·诺伊曼熵是单调不减的；如果 $\\gamma\\neq\\kappa$，半群不是幺正的，且 $S(\\rho_t)$ 可以减小，尽管相对于稳态 $\\sigma$ 定义的熵产生率 $-\\frac{d}{dt}D(\\rho_t\\|\\sigma)$ 保持非负。\n\nB. 对于所有的 $\\gamma,\\kappa,\\lambda$，半群都是幺正的，因为 $[H,I]=0$；相应地，Spohn 不等式意味着对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\le 0$。\n\nC. 除非 $\\lambda=0$，否则半群是非幺正的。在幺正的情况下（即当 $\\lambda=0$ 时），退相干导致对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\le 0$。\n\nD. 半群是幺正的，仅当 $\\gamma=\\kappa=0$；当幺正时，冯·诺伊曼熵 $S(\\rho_t)$ 随时间守恒，且熵产生恒为零。",
            "solution": "用户希望我验证问题陈述然后解决它。\n\n### 步骤1：问题陈述的验证\n\n问题描述了一个双能级量子系统（量子比特），其哈密顿量为 $H = \\frac{\\omega}{2}\\sigma_z$，在由一个时齐 Gorini–Kossakowski–Sudarshan–Lindblad (GKSL) 主方程所描述的动力学下演化。Lindblad 跃迁算符被给出为 $L_1 = \\sqrt{\\gamma}\\,\\sigma_- = \\sqrt{\\gamma}\\,|0\\rangle\\langle 1|$、$L_2 = \\sqrt{\\kappa}\\,\\sigma_+ = \\sqrt{\\kappa}\\,|1\\rangle\\langle 0|$ 和 $L_3 = \\sqrt{\\lambda}\\,\\sigma_z$。问题要求确定相应的动力学半群是幺正的条件，并分析其对熵产生的影响。\n\n这个设置在开放量子系统和量子热力学领域是标准的。GKSL 主方程、幺正性概念、冯·诺伊曼熵、Spohn 不等式和量子克劳修斯不等式都是基础且定义明确的。系统本身——一个经历幅度阻尼、激发和退相干的量子比特——是一个典型的模型。\n\n问题陈述中存在一个微小的记号不一致。给定泡利矩阵 $\\sigma_z = |0\\rangle\\langle 0| - |1\\rangle\\langle 1|$ 的标准选择，升算符通常是 $\\sigma_+ = |0\\rangle\\langle 1|$，而降算符是 $\\sigma_- = |1\\rangle\\langle 0|$。问题陈述中写了 $L_1 = \\sqrt{\\gamma}\\,\\sigma_-$ 但将其定义为 $\\sqrt{\\gamma}\\,|0\\rangle\\langle 1|$，并写了 $L_2 = \\sqrt{\\kappa}\\,\\sigma_+$ 但将其定义为 $\\sqrt{\\kappa}\\,|1\\rangle\\langle 0|$。符号名称 $(\\sigma_-, \\sigma_+)$ 相对于它们的显式定义被交换了。这种模糊性不是一个致命的缺陷，因为严谨的分析必须从显式的数学定义出发，即 $L_1 = \\sqrt{\\gamma}\\,|0\\rangle\\langle 1|$ 和 $L_2 = \\sqrt{\\kappa}\\,|1\\rangle\\langle 0|$。我们注意到，我们下面推导的幺正性条件对这种交换不敏感。\n\n该问题具有科学依据、提法恰当、客观，并包含了获得唯一解所需的所有信息。因此，问题陈述是有效的。\n\n### 步骤2：解的推导\n\n密度矩阵 $\\rho_t$ 的演化由 GKSL 主方程决定：\n$$\n\\dot{\\rho}_t = \\mathcal{L}(\\rho_t) = -i[H, \\rho_t] + \\sum_{k=1}^3 \\left( L_k \\rho_t L_k^\\dagger - \\frac{1}{2} \\{L_k^\\dagger L_k, \\rho_t\\} \\right)\n$$\n其中 $\\{A,B\\} = AB+BA$ 是反对易子。\n\n一个量子动力学半群被定义为幺正的，如果其生成元 $\\mathcal{L}$ 湮灭单位算符 $I$，即 $\\mathcal{L}(I) = 0$。\n我们计算 $\\mathcal{L}(I)$：\n哈密顿部分是 $-i[H, I] = 0$。\n耗散部分是：\n$$\n\\mathcal{D}(I) = \\sum_{k=1}^3 \\left( L_k I L_k^\\dagger - \\frac{1}{2} \\{L_k^\\dagger L_k, I\\} \\right) = \\sum_{k=1}^3 \\left( L_k L_k^\\dagger - \\frac{1}{2} (L_k^\\dagger L_k + L_k^\\dagger L_k) \\right) = \\sum_{k=1}^3 (L_k L_k^\\dagger - L_k^\\dagger L_k) = \\sum_{k=1}^3 [L_k, L_k^\\dagger]\n$$\n因此，半群是幺正的，当且仅当 $\\sum_{k=1}^3 [L_k, L_k^\\dagger] = 0$。\n\n让我们为给定的跃迁算符计算对易子：\n1. 对于 $L_1 = \\sqrt{\\gamma}\\,|0\\rangle\\langle 1|$，其伴随算符是 $L_1^\\dagger = \\sqrt{\\gamma}\\,|1\\rangle\\langle 0|$。对易子是：\n    $$\n    [L_1, L_1^\\dagger] = \\gamma [|0\\rangle\\langle 1|, |1\\rangle\\langle 0|] = \\gamma (|0\\rangle\\langle 1|1\\rangle\\langle 0| - |1\\rangle\\langle 0|0\\rangle\\langle 1|) = \\gamma (|0\\rangle\\langle 0| - |1\\rangle\\langle 1|) = \\gamma \\sigma_z\n    $$\n2. 对于 $L_2 = \\sqrt{\\kappa}\\,|1\\rangle\\langle 0|$，其伴随算符是 $L_2^\\dagger = \\sqrt{\\kappa}\\,|0\\rangle\\langle 1|$。对易子是：\n    $$\n    [L_2, L_2^\\dagger] = \\kappa [|1\\rangle\\langle 0|, |0\\rangle\\langle 1|] = \\kappa (|1\\rangle\\langle 0|0\\rangle\\langle 1| - |0\\rangle\\langle 1|1\\rangle\\langle 0|) = \\kappa (|1\\rangle\\langle 1| - |0\\rangle\\langle 0|) = -\\kappa \\sigma_z\n    $$\n3. 对于 $L_3 = \\sqrt{\\lambda}\\,\\sigma_z$，由于 $\\sigma_z$ 是厄米的，其伴随算符是 $L_3^\\dagger = \\sqrt{\\lambda}\\,\\sigma_z$。对易子是：\n    $$\n    [L_3, L_3^\\dagger] = \\lambda [\\sigma_z, \\sigma_z] = 0\n    $$\n幺正性条件变为：\n$$\n\\sum_{k=1}^3 [L_k, L_k^\\dagger] = \\gamma \\sigma_z - \\kappa \\sigma_z + 0 = (\\gamma - \\kappa)\\sigma_z = 0\n$$\n由于 $\\sigma_z \\neq 0$，这要求 $\\gamma = \\kappa$。该条件与 $\\lambda$ 无关。\n因此，该半群是幺正的，当且仅当 $\\gamma = \\kappa$。\n\n现在我们分析对熵的影响。Spohn 不等式指出，对于任何具有稳态 $\\sigma$ (即 $\\mathcal{L}(\\sigma) = 0$) 的 GKSL 生成元 $\\mathcal{L}$，量子相对熵 $S(\\rho_t \\| \\sigma) = \\operatorname{Tr}[\\rho_t(\\log \\rho_t - \\log \\sigma)]$ 是不增的。熵产生率，定义为 $\\Sigma = -\\frac{d}{dt}S(\\rho_t\\|\\sigma)$，是非负的：\n$$\n\\Sigma = -\\frac{d}{dt} S(\\rho_t \\| \\sigma) = -\\operatorname{Tr}[\\dot{\\rho}_t(\\log \\rho_t - \\log \\sigma)] \\ge 0\n$$\n让我们分析两种情况：\n\n情况1：幺正动力学 ($\\gamma = \\kappa$)\n如果半群是幺正的，最大混合态 $\\sigma = I/d$ (这里 $d=2$，所以 $\\sigma = I/2$) 是一个稳态，因为 $\\mathcal{L}(I/2) = \\frac{1}{2}\\mathcal{L}(I) = 0$。\n相对于这个稳态的相对熵是：\n$$\nS(\\rho_t \\| I/2) = \\operatorname{Tr}[\\rho_t(\\log \\rho_t - \\log (I/2))] = -S(\\rho_t) - \\operatorname{Tr}[\\rho_t(-\\log(2)I)] = -S(\\rho_t) + \\log(2)\\operatorname{Tr}[\\rho_t]\n$$\n由于 $\\operatorname{Tr}[\\rho_t]=1$，我们有 $S(\\rho_t \\| I/2) = \\log(2) - S(\\rho_t)$。\n对时间求导，$\\frac{d}{dt}S(\\rho_t \\| I/2) = -\\frac{d}{dt}S(\\rho_t)$。\nSpohn 不等式为 $-\\frac{d}{dt}S(\\rho_t \\| I/2) \\ge 0$，它变为：\n$$\n-(-\\frac{d}{dt}S(\\rho_t)) = \\frac{d}{dt}S(\\rho_t) \\ge 0\n$$\n对于幺正半群，冯·诺伊曼熵 $S(\\rho_t)$ 是时间的单调不减函数。\n\n情况2：非幺正动力学 ($\\gamma \\neq \\kappa$)\n半群不是幺正的，且最大混合态 $I/2$ 不是一个稳态。存在一个唯一的稳态 $\\sigma$，它是一个类热态。对于任何初始态 $\\rho_0$，系统都会收敛到这个 $\\sigma$。\n让我们考虑一个初始态 $\\rho_0 = I/2$。它的熵是 $S(I/2) = \\log 2$，这是量子比特可能的最大熵。稳态 $\\sigma$ 与 $I/2$ 不同，必须具有更低的熵，即 $S(\\sigma)  \\log 2$。当系统从 $\\rho_0=I/2$ 演化到 $\\sigma$ 时，其熵 $S(\\rho_t)$ 必须减小（至少在演化的某些部分）以达到最终值 $S(\\sigma)$。因此，在非幺正的情况下，冯·诺伊曼熵 $S(\\rho_t)$ 可以减小。\n然而，Spohn 不等式 $\\Sigma = -\\frac{d}{dt}S(\\rho_t \\| \\sigma) \\ge 0$ 仍然有效。相对于真实稳态 $\\sigma$ 的相对熵总是单调不增的。这是开放量子系统热力学第二定律的一个陈述。该不等式可以写成 $\\frac{d}{dt}S(\\rho_t) \\ge -\\operatorname{Tr}[\\dot{\\rho}_t\\log \\sigma]$。右边的项是熵流，对于非幺正动力学，它不为零，从而允许系统熵 $S(\\rho_t)$ 减小。\n\n### 步骤3：选项评估\n\nA. **半群是幺正的，当且仅当 $\\gamma=\\kappa$。在这种情况下，对于稳态 $\\sigma=I/2$，Spohn 不等式意味着对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\ge 0$，因此冯·诺伊曼熵是单调不减的；如果 $\\gamma\\neq\\kappa$，半群不是幺正的，且 $S(\\rho_t)$ 可以减小，尽管相对于稳态 $\\sigma$ 定义的熵产生率 $-\\frac{d}{dt}D(\\rho_t\\|\\sigma)$ 保持非负。**\n这个陈述与我们的推导完全一致。它正确地指出了幺正性的条件（$\\gamma=\\kappa$），正确地推导了其对冯·诺伊曼熵的后果（$\\frac{d}{dt}S(\\rho_t) \\ge 0$），并正确地描述了非幺正的情况：$S(\\rho_t)$ 可以减小，而 Spohn 不等式的一般形式仍然成立。这个陈述是**正确的**。\n\nB. **对于所有的 $\\gamma,\\kappa,\\lambda$，半群都是幺正的，因为 $[H,I]=0$；相应地，Spohn 不等式意味着对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\le 0$。**\n半群对所有速率都是幺正的这个前提是错误的；幺正性取决于耗散部分，而不仅仅是哈密顿部分。结论 $\\frac{d}{dt}S(\\rho_t)\\le 0$ 也是错误的；对于幺正通道，不等式的方向相反。这个陈述是**不正确的**。\n\nC. **除非 $\\lambda=0$，否则半群是非幺正的。在幺正的情况下（即当 $\\lambda=0$ 时），退相干导致对所有初始态都有 $\\frac{d}{dt}S(\\rho_t)\\le 0$。**\n幺正性的条件是 $\\gamma=\\kappa$，它与 $\\lambda$ 无关。退相干通道（其中 $\\gamma=\\kappa=0, \\lambda>0$）实际上是幺正的。断言幺正性要求 $\\lambda=0$ 是错误的。在幺正情况下 $\\frac{d}{dt}S(\\rho_t)\\le 0$ 的结论也是错误的。这个陈述是**不正确的**。\n\nD. **半群是幺正的，仅当 $\\gamma=\\kappa=0$；当幺正时，冯·诺伊曼熵 $S(\\rho_t)$ 随时间守恒，且熵产生恒为零。**\n幺正性的条件是 $\\gamma=\\kappa$，不一定是它们都为零。例如，如果 $\\gamma=\\kappa > 0$ 且 $\\lambda=0$，半群是幺正的。对于任何幺正演化，$S(\\rho_t)$ 都守恒的结论也是错误的；一个退相干通道（$\\gamma=\\kappa=0, \\lambda>0$）是幺正的，但通常会增加熵。这个陈述是**不正确的**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在理解了幺正性的概念后，我们现在转向一个具体的实例。本练习  探讨了一个纯退相干过程，这是一个在没有能量交换的情况下量子信息损失的经典模型。你将直接求解主方程并计算熵变率，从而获得一个关于量子相干性如何转化为熵的具体范例，这与斯普恩不等式对幺正通道的预测完全一致。",
            "id": "3784697",
            "problem": "考虑一个单量子比特，其演化由一个时齐的 Gorini-Kossakowski-Sudarshan-Lindblad (GKSL) 主方程描述，该方程由纯退相干生成，Lindblad 算符为 $L=\\sqrt{\\Gamma}\\,\\sigma_{z}$，其中 $\\Gamma0$ 且 $\\sigma_{z}$ 是泡利 z 矩阵。初始状态为一个通用的量子比特密度矩阵\n$$\n\\rho_{0}=\\begin{pmatrix}\np   c_{0} \\\\\nc_{0}^{\\ast}  1-p\n\\end{pmatrix},\n$$\n其中 $p\\in[0,1]$ 且 $|c_{0}|\\leq \\sqrt{p(1-p)}$。假设没有哈密顿量贡献。从 GKSL 生成元的定义、冯·诺依曼熵 $S(\\rho)=-\\operatorname{Tr}[\\rho \\ln \\rho]$ 和量子相对熵 $D(\\rho\\Vert\\pi)=\\operatorname{Tr}[\\rho(\\ln \\rho-\\ln \\pi)]$ 的基本性质出发。判断该生成元是否是保单的，并找出一个与该性质一致的忠实稳态 $\\pi$。然后，通过在矩阵元级别上求解主方程，确定密度矩阵随时间变化的规律，并计算由非对角元衰减引起的熵产生率 $\\dot{S}(\\rho_{t})$。使用自然对数，将最终的熵率表示为关于 $p$、$|c_{0}|$、$\\Gamma$ 和 $t$ 的单个闭式解析表达式，并结合 Spohn 不等式和量子克劳修斯不等式，对此保单的、无热流的动力学过程进行解释。\n\n使用自然对数，并将最终熵率以纳特/单位时间为单位表示。无需进行四舍五入。",
            "solution": "一个马尔可夫开放量子系统的密度矩阵 $\\rho_{t}$ 的演化由 Gorini-Kossakowski-Sudarshan-Lindblad (GKSL) 形式给出：\n$$\n\\frac{d\\rho_{t}}{dt}=\\mathcal{L}(\\rho_{t}),\\qquad \\mathcal{L}(\\rho)=L\\rho L^{\\dagger}-\\frac{1}{2}\\{L^{\\dagger}L,\\rho\\},\n$$\n其中 $\\{A,B\\}=AB+BA$ 表示反对易子。对于 $L=\\sqrt{\\Gamma}\\,\\sigma_{z}$ 且无哈密顿项的纯退相干过程，我们有\n$$\nL^{\\dagger}L=\\Gamma\\,\\sigma_{z}^{2}=\\Gamma\\,I,\n$$\n因此生成元为\n$$\n\\mathcal{L}(\\rho)=\\Gamma\\,\\sigma_{z}\\rho\\,\\sigma_{z}-\\frac{\\Gamma}{2}\\{I,\\rho\\}=\\Gamma\\big(\\sigma_{z}\\rho\\,\\sigma_{z}-\\rho\\big).\n$$\n\n首先，我们检验其保单性。如果一个量子动力学映射保持单位算符不变，则称其为保单的。对于该生成元，\n$$\n\\mathcal{L}(I)=\\Gamma\\big(\\sigma_{z}I\\,\\sigma_{z}-I\\big)=\\Gamma\\big(I-I\\big)=0,\n$$\n因此 $I$ 是生成元的一个不动点，该动力学过程是保单的。与保单性一致的一个忠实稳态是该量子比特的最大混合态 $\\pi=\\frac{I}{2}$。确实，$\\mathcal{L}(\\pi)=0$ 且 $\\pi$ 是严格正定的。\n\n接下来，我们在计算基中按分量求解主方程，在该基中 $\\sigma_{z}=\\operatorname{diag}(1,-1)$ 且\n$$\n\\rho_{t}=\\begin{pmatrix}\n\\rho_{00}(t)   \\rho_{01}(t) \\\\\n\\rho_{10}(t)   \\rho_{11}(t)\n\\end{pmatrix}.\n$$\n用 $\\sigma_{z}$ 进行共轭变换会使非对角项变号，而对角项保持不变：\n$$\n\\sigma_{z}\\rho_{t}\\sigma_{z}=\\begin{pmatrix}\n\\rho_{00}(t)   -\\rho_{01}(t) \\\\\n-\\rho_{10}(t)   \\rho_{11}(t)\n\\end{pmatrix}.\n$$\n因此，\n$$\n\\frac{d\\rho_{t}}{dt}=\\Gamma\\Bigg(\\begin{pmatrix}\n\\rho_{00}(t)   -\\rho_{01}(t) \\\\\n-\\rho_{10}(t)   \\rho_{11}(t)\n\\end{pmatrix}-\\begin{pmatrix}\n\\rho_{00}(t)   \\rho_{01}(t) \\\\\n\\rho_{10}(t)   \\rho_{11}(t)\n\\end{pmatrix}\\Bigg)=\\Gamma\\begin{pmatrix}\n0   -2\\rho_{01}(t) \\\\\n-2\\rho_{10}(t)   0\n\\end{pmatrix}.\n$$\n所以，\n$$\n\\frac{d}{dt}\\rho_{00}(t)=0,\\quad \\frac{d}{dt}\\rho_{11}(t)=0,\\quad \\frac{d}{dt}\\rho_{01}(t)=-2\\Gamma\\,\\rho_{01}(t),\\quad \\frac{d}{dt}\\rho_{10}(t)=-2\\Gamma\\,\\rho_{10}(t).\n$$\n根据初始条件 $\\rho_{0}=\\begin{pmatrix}p  c_{0}\\\\ c_{0}^{\\ast}  1-p\\end{pmatrix}$，解为\n$$\n\\rho_{00}(t)=p,\\quad \\rho_{11}(t)=1-p,\\quad \\rho_{01}(t)=c_{0}\\,\\exp(-2\\Gamma t),\\quad \\rho_{10}(t)=c_{0}^{\\ast}\\,\\exp(-2\\Gamma t).\n$$\n\n我们现在计算冯·诺依曼熵率 $\\dot{S}(\\rho_{t})$。冯·诺依曼熵为 $S(\\rho)=-\\operatorname{Tr}[\\rho\\ln\\rho]$。计算该变化率的一个便捷方法是使用谱分解。令 $\\lambda_{\\pm}(t)$ 表示 $\\rho_{t}$ 的特征值。对于一个对角元为 $p$ 和 $1-p$、非对角元为 $c(t)=c_{0}\\exp(-2\\Gamma t)$ 的 $2\\times 2$ 厄米矩阵，其特征值为\n$$\n\\lambda_{\\pm}(t)=\\frac{1}{2}\\left(1\\pm \\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}\\right).\n$$\n定义\n$$\nD(t)=(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t).\n$$\n那么\n$$\n\\lambda_{\\pm}(t)=\\frac{1}{2}\\left(1\\pm \\sqrt{D(t)}\\right).\n$$\n对 $D(t)$ 求导得到\n$$\n\\frac{d}{dt}D(t)=4|c_{0}|^{2}\\frac{d}{dt}\\exp(-4\\Gamma t)=-16\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t).\n$$\n根据链式法则，\n$$\n\\dot{\\lambda}_{\\pm}(t)=\\pm \\frac{1}{2}\\cdot \\frac{1}{2\\sqrt{D(t)}}\\,\\dot{D}(t)=\\pm \\frac{\\dot{D}(t)}{4\\sqrt{D(t)}}=\\mp \\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}.\n$$\n\n熵率可以写为\n$$\n\\dot{S}(\\rho_{t})=-\\sum_{k=\\pm}\\dot{\\lambda}_{k}(t)\\,\\ln\\lambda_{k}(t),\n$$\n因为 $\\sum_{k}\\dot{\\lambda}_{k}(t)=\\frac{d}{dt}\\operatorname{Tr}[\\rho_{t}]=0$ 消去了对 $-\\lambda\\ln\\lambda$ 求导时产生的 $-\\sum_{k}\\dot{\\lambda}_{k}(t)$ 贡献。代入 $\\dot{\\lambda}_{\\pm}(t)$ 的表达式可得\n$$\n\\dot{S}(\\rho_{t})=-\\left(-\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\ln\\lambda_{+}(t)+\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\ln\\lambda_{-}(t)\\right)\n=\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\Big(\\ln\\lambda_{+}(t)-\\ln\\lambda_{-}(t)\\Big).\n$$\n这可以简化为\n$$\n\\dot{S}(\\rho_{t})=\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{D(t)}}\\,\\ln\\left(\\frac{\\lambda_{+}(t)}{\\lambda_{-}(t)}\\right).\n$$\n使用 $\\lambda_{\\pm}(t)=\\frac{1}{2}(1\\pm \\sqrt{D(t)})$ 可得\n$$\n\\frac{\\lambda_{+}(t)}{\\lambda_{-}(t)}=\\frac{1+\\sqrt{D(t)}}{1-\\sqrt{D(t)}},\n$$\n因此闭式解为\n$$\n\\dot{S}(\\rho_{t})=\\frac{4\\Gamma |c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\,\n\\ln\\left(\\frac{1+\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}{1-\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\right).\n$$\n\n根据 Spohn 不等式和量子克劳修斯不等式的解释：对于具有稳态 $\\pi$ 的 GKSL 生成元，Spohn 不等式指出 $-\\frac{d}{dt}D(\\rho_{t}\\Vert \\pi)\\geq 0$。对于一个稳态为 $\\pi=\\frac{I}{2}$ 的保单量子比特生成元，有 $\\ln\\pi=-\\ln 2\\,I$ 且 $\\operatorname{Tr}[\\dot{\\rho}_{t}\\ln\\pi]=0$，因此 $-\\frac{d}{dt}D(\\rho_{t}\\Vert \\pi)=\\dot{S}(\\rho_{t})\\geq 0$。上面推导出的显式表达式确实是非负的，因为 $\\lambda_{+}(t)\\geq \\lambda_{-}(t)$ 意味着 $\\ln(\\lambda_{+}/\\lambda_{-})\\geq 0$，且前面的系数是非负的。在物理上，纯退相干是一个无热流过程（没有能量交换），对于保单动力学，量子克劳修斯不等式简化为熵的单调增加；所得到的 $\\dot{S}(\\rho_{t})$ 以纳特/单位时间为单位量化了该速率。",
            "answer": "$$\\boxed{\\frac{4\\,\\Gamma\\,|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}{\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\,\\ln\\!\\left(\\frac{1+\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}{1-\\sqrt{(2p-1)^{2}+4|c_{0}|^{2}\\,\\exp(-4\\Gamma t)}}\\right)}$$"
        },
        {
            "introduction": "我们最后的练习将从简单的、不随时变的模型转向更复杂、更贴近现实的驱动量子系统领域。当系统的哈密顿量随时间变化时，总熵产生可以分解为与驱动相关的部分（非绝热）和维持非平衡条件相关的部分（绝热）。这个计算练习  提供了一个实用的工具包，用于模拟这些动力学过程，数值计算熵产生的不同分量，并验证即使在这些复杂情景下，热力学的基本定律依然成立。",
            "id": "3784778",
            "problem": "考虑一个双能级量子系统（量子比特），其哈密顿量为 $H_t = \\frac{\\omega(t)}{2}\\sigma_z$，该系统与一组标记为 $\\alpha$ 的独立热库弱耦合，每个热库的逆温度为 $\\beta_\\alpha$。系统的约化态 $\\rho_t$ 在一个 Gorini–Kossakowski–Lindblad–Sudarshan (GKLS) 生成元的作用下演化，该生成元是各热库特定生成元的总和，并且是马尔可夫的。假设每个热库 $\\alpha$ 都满足局域细致平衡，因此激发率 $\\gamma_{\\alpha}^{+}(t)$ 和弛豫率 $\\gamma_{\\alpha}^{-}(t)$ 在所有时间 $t$ 都满足 $\\gamma_{\\alpha}^{-}(t)/\\gamma_{\\alpha}^{+}(t) = e^{\\beta_\\alpha \\omega(t)}$。一个满足局域细致平衡的具体参数化是 $\\gamma_{\\alpha}^{+}(t) = k_\\alpha e^{-\\beta_\\alpha \\omega(t)/2}$ 和 $\\gamma_{\\alpha}^{-}(t) = k_\\alpha e^{+\\beta_\\alpha \\omega(t)/2}$，其中 $k_\\alpha0$。\n\n设能量本征态的布居数在所有时间都是对角的，其中 $n(t)$ 是激发态的布居数。布居动力学由 GKLS 生成元诱导的经典速率方程给出，\n$$\n\\frac{dn(t)}{dt} = \\sum_{\\alpha} \\left[ \\gamma_{\\alpha}^{+}(t) \\left(1 - n(t)\\right) - \\gamma_{\\alpha}^{-}(t) n(t) \\right].\n$$\n将瞬时稳态 $\\pi_t$ 定义为满足完整生成元的瞬时稳态条件的时间依赖状态，其激发态布居数为\n$$\nn_{\\mathrm{ss}}(t) = \\frac{\\sum_{\\alpha} \\gamma_{\\alpha}^{+}(t)}{\\sum_{\\alpha} \\gamma_{\\alpha}^{+}(t) + \\sum_{\\alpha} \\gamma_{\\alpha}^{-}(t)}.\n$$\n将流入热库 $\\alpha$ 的热流定义为\n$$\nJ_\\alpha(t) = - \\operatorname{Tr}\\left[ H_t \\,\\mathcal{L}_{\\alpha,t}(\\rho_t) \\right] = -\\omega(t)\\left[ \\gamma_\\alpha^{+}(t)\\left(1-n(t)\\right) - \\gamma_\\alpha^{-}(t) n(t) \\right],\n$$\n并将流入热库 $\\alpha$ 的管家热流定义为\n$$\nJ_\\alpha^{\\mathrm{hk}}(t) = - \\operatorname{Tr}\\left[ H_t \\,\\mathcal{L}_{\\alpha,t}(\\pi_t) \\right] = -\\omega(t)\\left[ \\gamma_\\alpha^{+}(t)\\left(1-n_{\\mathrm{ss}}(t)\\right) - \\gamma_\\alpha^{-}(t) n_{\\mathrm{ss}}(t) \\right].\n$$\n设两个激发态布居数分别为 $n$ 和 $m$ 的对角态之间的量子相对熵为\n$$\nD\\left(\\rho\\|\\pi\\right) = n \\ln\\left(\\frac{n}{m}\\right) + \\left(1-n\\right) \\ln\\left(\\frac{1-n}{1-m}\\right).\n$$\n从 GKLS 动力学的 Spohn 不等式和上述定义出发，可以将瞬时熵产生率分解为非绝热和绝热部分，而量子克劳修斯不等式断言总熵产生率的非负性。你的任务是：\n- 推导非绝热熵产生率 $\\sigma_{\\mathrm{na}}(t)$ 的表达式（用量子相对熵 $D\\left(\\rho_t\\|\\pi_t\\right)$ 的时间导数表示）和绝热熵产生率 $\\sigma_{\\mathrm{ad}}(t)$ 的表达式（用逆温度 $\\beta_\\alpha$ 和管家热流 $J_\\alpha^{\\mathrm{hk}}(t)$ 表示），使得总熵产生率 $\\sigma_{\\mathrm{tot}}(t) = \\sigma_{\\mathrm{na}}(t) + \\sigma_{\\mathrm{ad}}(t)$ 在所有时间都非负。\n- 实现一个数值求解器，该求解器在上述速率方程下模拟布居动力学 $n(t)$，并使用有限差分计算时间导数，沿均匀时间网格计算 $\\sigma_{\\mathrm{na}}(t)$ 和 $\\sigma_{\\mathrm{ad}}(t)$。使用自然单位制，其中玻尔兹曼常数和普朗克常数均设为 $1$，因此所有量都是无量纲的。\n\n测试套件：\n- 情况 A（单热库，驱动频率）：一个热库，$\\beta_1 = 1.5$，耦合强度 $k_1 = 0.5$，初始激发态布居数 $n(0) = 0.1$，总时间 $T = 2.0$，时间步长 $\\Delta t = 10^{-3}$，并且对于 $t\\in[0,T]$，$\\omega(t) = 1.0 + 0.5\\,(t/T)$。\n- 情况 B（双热库，无驱动，稳态初始状态）：两个热库，$\\beta_1 = 0.5$，$\\beta_2 = 2.0$，耦合强度 $k_1 = 0.4$，$k_2 = 0.6$，初始 $n(0) = n_{\\mathrm{ss}}(0)$（根据给定参数计算），$T = 1.0$，$\\Delta t = 10^{-3}$，以及常数 $\\omega(t) = 1.0$。\n- 情况 C（双热库，正弦驱动）：两个热库，$\\beta_1 = 0.5$，$\\beta_2 = 2.0$，耦合强度 $k_1 = 0.4$，$k_2 = 0.6$，初始 $n(0) = 0.0$，$T = 1.0$，$\\Delta t = 10^{-3}$，以及 $\\omega(t) = 1.0 + 0.2 \\sin\\left(2\\pi t/T\\right)$。\n\n算法要求：\n- 对 $n(t)$ 使用显式欧拉积分。\n- 通过 $D$ 的有限差分计算 $n_{\\mathrm{ss}}(t)$、$D\\left(\\rho_t\\|\\pi_t\\right)$、$\\sigma_{\\mathrm{na}}(t)$，并从 $J_\\alpha^{\\mathrm{hk}}(t)$ 和 $\\beta_\\alpha$ 计算 $\\sigma_{\\mathrm{ad}}(t)$。\n- 使用非负性容差 $\\varepsilon = 10^{-9}$：如果一个值 $x$ 满足 $x \\ge -\\varepsilon$，则将其视为非负。\n\n输出规范：\n- 对于每种情况，通过检查在所有采样时间内是否满足 $\\sigma_{\\mathrm{tot}}(t) \\ge 0$（在容差 $\\varepsilon$ 范围内）来评估量子克劳修斯不等式是否成立。\n- 此外，对于情况 A（单热库），评估在整个时间网格上 $\\sigma_{\\mathrm{ad}}(t)$ 是否在容差范围内恒为零。\n- 您的程序应生成单行输出，其中包含四个布尔结果，以逗号分隔的列表形式包含在方括号内，顺序为 $[\\text{情况A\\_总非负}, \\text{情况B\\_总非负}, \\text{情况C\\_总非负}, \\text{情况A\\_绝热为零}]$。",
            "solution": "问题陈述已经过严格验证，被认为是科学上合理、表述清晰且客观的。它提出了一个开放量子系统热力学中的标准问题，需要基于既定原理进行理论推导和数值模拟。所有给定的量和定义都与该领域的文献一致。\n\n### 理论推导与框架\n\n核心任务是分解受驱动的双能级量子系统的熵产生率，并数值验证量子克劳修斯不等式。问题引导了一个特定的分解，将其分为绝热和非绝热部分。\n\n设双能级系统在时间 $t$ 的状态由密度矩阵 $\\rho_t$ 描述。由于哈密顿量 $H_t = \\frac{\\omega(t)}{2}\\sigma_z$ 的本征态被假定为计算基，并且系统从对角态开始并保持在对角态，$\\rho_t$ 可以完全由激发态的布居数 $n(t)$ 来表征。密度矩阵为 $\\rho_t = \\mathrm{diag}(n(t), 1-n(t))$。系统的冯·诺依曼熵则为 $S(\\rho_t) = -n(t) \\ln n(t) - (1-n(t)) \\ln(1-n(t))$。\n\n系统和热库组合的总熵产生率，此处表示为 $\\sigma_{\\mathrm{true\\_tot}}(t)$，由系统熵的变化率和流入热库的熵流之和给出：\n$$\n\\sigma_{\\mathrm{true\\_tot}}(t) = \\frac{dS(\\rho_t)}{dt} + \\sum_{\\alpha} \\beta_\\alpha J_\\alpha(t)\n$$\n其中 $J_\\alpha(t)$ 是流入热库 $\\alpha$ 的热流。Spohn 不等式是带有局域细致平衡的 Gorini–Kossakowski–Lindblad–Sudarshan (GKLS) 主方程的一个推论，它保证了总熵产生非负：$\\sigma_{\\mathrm{true\\_tot}}(t) \\ge 0$。这就是量子克劳修斯不等式。\n\n问题要求将熵产生率分解为绝热部分 $\\sigma_{\\mathrm{ad}}(t)$ 和非绝热部分 $\\sigma_{\\mathrm{na}}(t)$。遵循驱动开放系统的标准框架，我们将这些分量定义如下：\n\n1.  **绝热熵产生率，$\\sigma_{\\mathrm{ad}}(t)$**：该分量量化了为使系统维持在其瞬时稳态 $\\pi_t$（激发态布居数为 $n_{\\mathrm{ss}}(t)$）以抵抗热库施加的热力学力而产生的熵。它由管家热流 $J_\\alpha^{\\mathrm{hk}}(t)$ 定义：\n    $$\n    \\sigma_{\\mathrm{ad}}(t) \\equiv \\sum_{\\alpha} \\beta_\\alpha J_\\alpha^{\\mathrm{hk}}(t)\n    $$\n    其中 $J_\\alpha^{\\mathrm{hk}}(t) = - \\operatorname{Tr}\\left[ H_t \\,\\mathcal{L}_{\\alpha,t}(\\pi_t) \\right]$。管家热代表了维持非平衡稳态所需的能量交换。可以证明该项是非负的，$\\sigma_{\\mathrm{ad}}(t) \\ge 0$。\n\n2.  **非绝热熵产生率，$\\sigma_{\\mathrm{na}}(t)$**：该分量与系统状态 $\\rho_t$ 未能适应瞬时稳态 $\\pi_t$ 有关。它通常与这两个状态之间的信息论距离相关联。问题指导了用量子相对熵 $D(\\rho_t \\| \\pi_t)$ 来定义：\n    $$\n    \\sigma_{\\mathrm{na}}(t) \\equiv -\\frac{d}{dt}D\\left(\\rho_t\\|\\pi_t\\right)\n    $$\n    其中 $D(\\rho_t\\|\\pi_t) = n(t) \\ln\\left(\\frac{n(t)}{n_{\\mathrm{ss}}(t)}\\right) + (1-n(t)) \\ln\\left(\\frac{1-n(t)}{1-n_{\\mathrm{ss}}(t)}\\right)$。该项不保证为非负，因为与移动稳态的距离既可以增加也可以减少。\n\n问题的主要目标是评估这两个分量之和的非负性，我们将其定义为 $\\sigma_{\\mathrm{tot}}(t)$：\n$$\n\\sigma_{\\mathrm{tot}}(t) = \\sigma_{\\mathrm{na}}(t) + \\sigma_{\\mathrm{ad}}(t) = -\\frac{d}{dt}D\\left(\\rho_t\\|\\pi_t\\right) + \\sum_{\\alpha} \\beta_\\alpha J_\\alpha^{\\mathrm{hk}}(t)\n$$\n根据现代热力学理论，这个量 $\\sigma_{\\mathrm{tot}}(t)$ 精确地等于总熵产生率 $\\sigma_{\\mathrm{true\\_tot}}(t)$，因此必须是非负的。这个问题的任务就是数值验证这个基本定律。\n\n### A. 单热库情况\n\n对于逆温度为 $\\beta_1$ 的单个热库，瞬时稳态 $\\pi_t$ 是哈密顿量 $H_t$ 的热平衡态，即 $n_{\\mathrm{ss}}(t) = 1/(1+e^{\\beta_1 \\omega(t)})$。这个单热库的林德布劳德生成元 $\\mathcal{L}_{1,t}$ 满足 $\\mathcal{L}_{1,t}(\\pi_t) = 0$。根据定义，管家热为 $J_1^{\\mathrm{hk}}(t) = - \\operatorname{Tr}\\left[ H_t \\,\\mathcal{L}_{1,t}(\\pi_t) \\right] = 0$。因此，绝热熵产生恒为零：$\\sigma_{\\mathrm{ad}}(t) = \\beta_1 J_1^{\\mathrm{hk}}(t) = 0$。\n\n### 数值实现计划\n\n模拟将在均匀时间网格 $t_i = i \\Delta t$ 上使用显式欧拉积分方案进行。\n\n1.  **初始化**：设置初始布居数 $n(t_0)$ 并创建时间网格。\n2.  **时间演化循环**：对于每个时间步 $t_i$：\n    a. 计算随时间变化的频率 $\\omega(t_i)$。\n    b. 对于每个热库 $\\alpha$，计算速率 $\\gamma_{\\alpha}^{+}(t_i) = k_\\alpha e^{-\\beta_\\alpha \\omega(t_i)/2}$ 和 $\\gamma_{\\alpha}^{-}(t_i) = k_\\alpha e^{\\beta_\\alpha \\omega(t_i)/2}$。\n    c. 计算总速率 $G^+(t_i) = \\sum_\\alpha \\gamma_{\\alpha}^{+}(t_i)$ 和 $G^-(t_i) = \\sum_\\alpha \\gamma_{\\alpha}^{-}(t_i)$。\n    d. 确定瞬时稳态布居数 $n_{\\mathrm{ss}}(t_i) = G^+(t_i) / (G^+(t_i) + G^-(t_i))$。\n    e. 使用欧拉方法演化布居数：$n(t_{i+1}) = n(t_i) + \\Delta t \\left[ G^+(t_i)(1-n(t_i)) - G^-(t_i)n(t_i) \\right]$。\n3.  **后处理**：计算出轨迹 $n(t)$ 和 $n_{\\mathrm{ss}}(t)$ 后：\n    a. 对于每个时间步 $t_i$（直到倒数第二个点）：\n    b. 计算相对熵 $D(t_i)$ 和 $D(t_{i+1})$。注意处理 $n=0$ 或 $n=1$ 的情况，此时 $x \\ln x$ 为 $0$。\n    c. 使用前向有限差分计算 $\\sigma_{\\mathrm{na}}(t_i)$：$\\sigma_{\\mathrm{na}}(t_i) = -(D(t_{i+1}) - D(t_i)) / \\Delta t$。\n    d. 计算管家热流 $J_\\alpha^{\\mathrm{hk}}(t_i) = -\\omega(t_i)\\left[ \\gamma_\\alpha^{+}(t_i)(1-n_{\\mathrm{ss}}(t_i)) - \\gamma_\\alpha^{-}(t_i) n_{\\mathrm{ss}}(t_i) \\right]$。\n    e. 计算 $\\sigma_{\\mathrm{ad}}(t_i) = \\sum_\\alpha \\beta_\\alpha J_\\alpha^{\\mathrm{hk}}(t_i)$。\n    f. 计算总速率 $\\sigma_{\\mathrm{tot}}(t_i) = \\sigma_{\\mathrm{na}}(t_i) + \\sigma_{\\mathrm{ad}}(t_i)$。\n4.  **验证**：对于每个测试用例，对所有计算值检查是否 $\\sigma_{\\mathrm{tot}}(t_i) \\ge -\\varepsilon$。对于情况 A，还要检查是否 $|\\sigma_{\\mathrm{ad}}(t_i)| \\le \\varepsilon$。结果被编译成一个布尔值列表。",
            "answer": "```python\n# 完整的、可运行的 Python 3 代码在此处。\n# 导入必须遵守指定的执行环境。\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    主求解器函数，用于组织和报告问题陈述中指定的三个测试用例的模拟和结果。\n    \"\"\"\n\n    # 定义一个小数以处理零的对数。\n    LOG_EPS = 1e-15\n\n    # 定义非负性和零值检查的容差。\n    NON_NEG_TOLERANCE = 1e-9\n\n    def xlogy_safe(x, y):\n        \"\"\"\n        安全地计算 x * log(y)，如果 x 为 0 则返回 0。\n        这是为了处理布居数 n=0 或 n=1 的情况。\n        \"\"\"\n        if x == 0:\n            return 0\n        # 在对数的参数中加入一个小的 epsilon，以避免 y=0 时出现 -inf\n        return x * np.log(y + LOG_EPS)\n\n    def run_case(params):\n        \"\"\"\n        运行单个模拟案例。\n\n        Args:\n            params (dict): 包含案例所有参数的字典。\n\n        Returns:\n            tuple: 一个元组，包含：\n                - (np.ndarray): 总熵产生率 sigma_tot 的数组。\n                - (np.ndarray): 绝热熵产生率 sigma_ad 的数组。\n        \"\"\"\n        betas = np.array(params['betas'])\n        ks = np.array(params['ks'])\n        n0 = params['n0']\n        T = params['T']\n        dt = params['dt']\n        omega_func = params['omega_func']\n\n        num_steps = int(T / dt)\n        times = np.linspace(0, T, num_steps + 1)\n        \n        # 用于存储轨迹的数组\n        n_t = np.zeros(num_steps + 1)\n        n_ss_t = np.zeros(num_steps + 1)\n        \n        # 计算 n_ss(0) 以确定情况 B 的 n(0)\n        omega_0 = omega_func(0, T)\n        if n0 == 'n_ss_0':\n            gamma_plus_0 = ks * np.exp(-betas * omega_0 / 2)\n            gamma_minus_0 = ks * np.exp(betas * omega_0 / 2)\n            G_plus_0 = np.sum(gamma_plus_0)\n            G_minus_0 = np.sum(gamma_minus_0)\n            n_t[0] = G_plus_0 / (G_plus_0 + G_minus_0)\n        else:\n            n_t[0] = n0\n            \n        # 使用显式欧拉方法进行时间演化\n        for i in range(num_steps):\n            t_i = times[i]\n            n_i = n_t[i]\n            \n            omega_i = omega_func(t_i, T)\n            \n            gamma_plus_i = ks * np.exp(-betas * omega_i / 2)\n            gamma_minus_i = ks * np.exp(betas * omega_i / 2)\n\n            G_plus_i = np.sum(gamma_plus_i)\n            G_minus_i = np.sum(gamma_minus_i)\n            \n            # 瞬时稳态布居数\n            if G_plus_i + G_minus_i == 0:\n                 # 避免除以零，尽管在 k>0 的情况下不太可能发生\n                 n_ss_t[i] = 0.5\n            else:\n                 n_ss_t[i] = G_plus_i / (G_plus_i + G_minus_i)\n            \n            # 欧拉步\n            dn_dt = G_plus_i * (1 - n_i) - G_minus_i * n_i\n            n_t[i+1] = n_i + dt * dn_dt\n            \n            # 确保布居数保持在 [0, 1] 范围内\n            n_t[i+1] = np.clip(n_t[i+1], 0, 1)\n\n        # 计算最终时间点的 n_ss 以用于 D 的计算\n        omega_T = omega_func(T, T)\n        gamma_plus_T = ks * np.exp(-betas * omega_T / 2)\n        gamma_minus_T = ks * np.exp(betas * omega_T / 2)\n        G_plus_T = np.sum(gamma_plus_T)\n        G_minus_T = np.sum(gamma_minus_T)\n        if G_plus_T + G_minus_T == 0:\n            n_ss_t[-1] = 0.5\n        else:\n            n_ss_t[-1] = G_plus_T / (G_plus_T + G_minus_T)\n\n        # 计算相对熵 D(t)\n        D_t = np.array([\n            xlogy_safe(n_t[i], n_t[i] / (n_ss_t[i] + LOG_EPS)) + \n            xlogy_safe(1 - n_t[i], (1 - n_t[i]) / (1 - n_ss_t[i] + LOG_EPS))\n            for i in range(num_steps + 1)\n        ])\n        \n        # 计算 sigma_na, sigma_ad, 和 sigma_tot\n        # 这些是在区间 [0, T-dt] 上计算的\n        sigma_na = -(D_t[1:] - D_t[:-1]) / dt\n        \n        sigma_ad = np.zeros(num_steps)\n        for i in range(num_steps):\n            t_i = times[i]\n            omega_i = omega_func(t_i, T)\n            n_ss_i = n_ss_t[i]\n            \n            gamma_plus_i = ks * np.exp(-betas * omega_i / 2)\n            gamma_minus_i = ks * np.exp(betas * omega_i / 2)\n            \n            J_hk_alpha = -omega_i * (gamma_plus_i * (1 - n_ss_i) - gamma_minus_i * n_ss_i)\n            sigma_ad[i] = np.sum(betas * J_hk_alpha)\n            \n        sigma_tot = sigma_na + sigma_ad\n        \n        return sigma_tot, sigma_ad\n\n    # --- 测试用例定义 ---\n    \n    # 情况 A：单热库，驱动频率\n    case_A_params = {\n        'betas': [1.5], 'ks': [0.5], 'n0': 0.1, 'T': 2.0, 'dt': 1e-3,\n        'omega_func': lambda t, T: 1.0 + 0.5 * (t / T)\n    }\n\n    # 情况 B：双热库，无驱动，稳态初始状态\n    case_B_params = {\n        'betas': [0.5, 2.0], 'ks': [0.4, 0.6], 'n0': 'n_ss_0', 'T': 1.0, 'dt': 1e-3,\n        'omega_func': lambda t, T: 1.0\n    }\n\n    # 情况 C：双热库，正弦驱动\n    case_C_params = {\n        'betas': [0.5, 2.0], 'ks': [0.4, 0.6], 'n0': 0.0, 'T': 1.0, 'dt': 1e-3,\n        'omega_func': lambda t, T: 1.0 + 0.2 * np.sin(2 * np.pi * t / T)\n    }\n\n    test_cases = [case_A_params, case_B_params, case_C_params]\n    results = []\n\n    # 运行情况 A\n    sigma_tot_A, sigma_ad_A = run_case(test_cases[0])\n    results.append(np.all(sigma_tot_A >= -NON_NEG_TOLERANCE))\n\n    # 运行情况 B\n    sigma_tot_B, _ = run_case(test_cases[1])\n    results.append(np.all(sigma_tot_B >= -NON_NEG_TOLERANCE))\n    \n    # 运行情况 C\n    sigma_tot_C, _ = run_case(test_cases[2])\n    results.append(np.all(sigma_tot_C >= -NON_NEG_TOLERANCE))\n    \n    # 对情况 A 进行绝热检查\n    results.append(np.all(np.abs(sigma_ad_A) = NON_NEG_TOLERANCE))\n    \n    # 最终打印语句\n    print(f\"[{','.join(map(lambda b: str(b).lower(), results))}]\")\n\nsolve()\n```"
        }
    ]
}