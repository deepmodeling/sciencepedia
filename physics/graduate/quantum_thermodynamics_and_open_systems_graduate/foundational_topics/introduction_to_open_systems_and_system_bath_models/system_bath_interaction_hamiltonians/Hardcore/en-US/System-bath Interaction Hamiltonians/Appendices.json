{
    "hands_on_practices": [
        {
            "introduction": "The dynamics of an open quantum system are profoundly shaped by the statistical properties of its environment, or bath. These properties are encapsulated in the bath's two-time correlation functions, which quantify how fluctuations at one point in time are correlated with those at another. This exercise  provides practice with the foundational skill of deriving these correlation functions from a microscopic model of a bosonic bath, demonstrating how they are ultimately determined by the bath's spectral density and temperature.",
            "id": "3785591",
            "problem": "Consider a bosonic bath described by the bath Hamiltonian $H_{B}=\\sum_{k}\\omega_{k}\\,b_{k}^{\\dagger}b_{k}$, where $b_{k}$ and $b_{k}^{\\dagger}$ are the annihilation and creation operators for bath mode $k$, satisfying the canonical bosonic commutation relations $[b_{k},b_{\\ell}^{\\dagger}]=\\delta_{k\\ell}$ and $[b_{k},b_{\\ell}]=[b_{k}^{\\dagger},b_{\\ell}^{\\dagger}]=0$. Let the system couple linearly to the bath through the bath operators $B_{\\alpha}=\\sum_{k}g_{k\\alpha}\\,(b_{k}+b_{k}^{\\dagger})$, where $g_{k\\alpha}$ are real coupling coefficients indexed by the bath mode $k$ and a system channel label $\\alpha$. Work in units where $\\hbar=1$.\n\nUsing the Heisenberg picture with respect to $H_{B}$, derive the time dependence $B_{\\alpha}(t)$ of the bath coupling operator $B_{\\alpha}$. Then, assuming the bath is initially in a thermal state at inverse temperature $\\beta$ with density operator $\\rho_{B}=\\exp(-\\beta H_{B})/Z_{B}$ and $Z_{B}=\\mathrm{Tr}[\\exp(-\\beta H_{B})]$, compute the stationary two-time correlator $C_{\\alpha\\beta}(t)=\\langle B_{\\alpha}(t)B_{\\beta}(0)\\rangle_{\\beta}$, where $\\langle\\cdot\\rangle_{\\beta}\\equiv\\mathrm{Tr}(\\rho_{B}\\,\\cdot)$ denotes a thermal average. In addition, compute the commutator correlator $\\chi_{\\alpha\\beta}(t)=\\langle[B_{\\alpha}(t),B_{\\beta}(0)]\\rangle_{\\beta}$.\n\nExpress $C_{\\alpha\\beta}(t)$ and $\\chi_{\\alpha\\beta}(t)$ in terms of the cross spectral density $J_{\\alpha\\beta}(\\omega)$ defined by $J_{\\alpha\\beta}(\\omega)=\\sum_{k}g_{k\\alpha}g_{k\\beta}\\,\\delta(\\omega-\\omega_{k})$ for $\\omega\\geq 0$, and the Bose–Einstein distribution (BE) $n(\\omega)=\\frac{1}{\\exp(\\beta\\omega)-1}$. Your derivations must start from the Heisenberg equation of motion and the definitions provided. Express your final answers as closed-form analytic expressions. No rounding is required. Provide the final expressions for $B_{\\alpha}(t)$, $C_{\\alpha\\beta}(t)$, and $\\chi_{\\alpha\\beta}(t)$.",
            "solution": "The bath is governed by the Hamiltonian $H_{B}=\\sum_{k}\\omega_{k}\\,b_{k}^{\\dagger}b_{k}$. In the Heisenberg picture, the time evolution of an operator $O(t)$ is generated by the Heisenberg equation of motion with $\\hbar=1$,\n$$\n\\frac{d}{dt}O(t)=\\mathrm{i}[H_{B},O(t)].\n$$\nWe first obtain the dynamics of the mode operators $b_{k}(t)$ and $b_{k}^{\\dagger}(t)$. Using the commutation relation $[b_{k},b_{\\ell}^{\\dagger}]=\\delta_{k\\ell}$ and $[b_{k}^{\\dagger}b_{k},b_{k}]=-b_{k}$, we compute\n$$\n[H_{B},b_{k}]=\\sum_{\\ell}\\omega_{\\ell}[b_{\\ell}^{\\dagger}b_{\\ell},b_{k}]=\\omega_{k}[b_{k}^{\\dagger}b_{k},b_{k}]=-\\omega_{k}\\,b_{k}.\n$$\nTherefore,\n$$\n\\frac{d}{dt}b_{k}(t)=\\mathrm{i}[H_{B},b_{k}(t)]=-\\mathrm{i}\\,\\omega_{k}\\,b_{k}(t),\n$$\nwhose solution is\n$$\nb_{k}(t)=b_{k}\\,\\exp(-\\mathrm{i}\\omega_{k}t).\n$$\nSimilarly, using $[b_{k}^{\\dagger}b_{k},b_{k}^{\\dagger}]=+b_{k}^{\\dagger}$, we obtain\n$$\n\\frac{d}{dt}b_{k}^{\\dagger}(t)=\\mathrm{i}[H_{B},b_{k}^{\\dagger}(t)]=+\\mathrm{i}\\,\\omega_{k}\\,b_{k}^{\\dagger}(t)\\quad\\Rightarrow\\quad b_{k}^{\\dagger}(t)=b_{k}^{\\dagger}\\,\\exp(+\\mathrm{i}\\omega_{k}t).\n$$\nThe bath coupling operator is $B_{\\alpha}=\\sum_{k}g_{k\\alpha}(b_{k}+b_{k}^{\\dagger})$, so its Heisenberg-evolved operator is\n$$\nB_{\\alpha}(t)=\\sum_{k}g_{k\\alpha}\\left(b_{k}\\,\\exp(-\\mathrm{i}\\omega_{k}t)+b_{k}^{\\dagger}\\,\\exp(+\\mathrm{i}\\omega_{k}t)\\right).\n$$\n\nNext, we evaluate the thermal two-time correlator $C_{\\alpha\\beta}(t)=\\langle B_{\\alpha}(t)B_{\\beta}(0)\\rangle_{\\beta}$ with $\\rho_{B}=\\exp(-\\beta H_{B})/Z_{B}$ and $Z_{B}=\\mathrm{Tr}[\\exp(-\\beta H_{B})]$. Expanding the product,\n$$\nB_{\\alpha}(t)B_{\\beta}(0)=\\sum_{k,\\ell}g_{k\\alpha}g_{\\ell\\beta}\\left(b_{k}\\,\\exp(-\\mathrm{i}\\omega_{k}t)+b_{k}^{\\dagger}\\,\\exp(+\\mathrm{i}\\omega_{k}t)\\right)\\left(b_{\\ell}+b_{\\ell}^{\\dagger}\\right).\n$$\nWe need thermal averages of quadratic bath operators, which for a free bosonic thermal state are standard results given by\n$$\n\\langle b_{k}^{\\dagger}b_{\\ell}\\rangle_{\\beta}=\\delta_{k\\ell}\\,n(\\omega_{k}),\\qquad \\langle b_{k}b_{\\ell}^{\\dagger}\\rangle_{\\beta}=\\delta_{k\\ell}\\,\\left(n(\\omega_{k})+1\\right),\n$$\nand $\\langle b_{k}b_{\\ell}\\rangle_{\\beta}=0$, $\\langle b_{k}^{\\dagger}b_{\\ell}^{\\dagger}\\rangle_{\\beta}=0$ for a thermal Gaussian state of uncoupled modes. Here $n(\\omega)=\\frac{1}{\\exp(\\beta\\omega)-1}$ is the Bose–Einstein distribution. Therefore,\n$$\nC_{\\alpha\\beta}(t)=\\sum_{k,\\ell}g_{k\\alpha}g_{\\ell\\beta}\\left(\\exp(-\\mathrm{i}\\omega_{k}t)\\langle b_{k}b_{\\ell}^{\\dagger}\\rangle_{\\beta}+\\exp(+\\mathrm{i}\\omega_{k}t)\\langle b_{k}^{\\dagger}b_{\\ell}\\rangle_{\\beta}\\right)\n=\\sum_{k}g_{k\\alpha}g_{k\\beta}\\left[\\left(n(\\omega_{k})+1\\right)\\exp(-\\mathrm{i}\\omega_{k}t)+n(\\omega_{k})\\exp(+\\mathrm{i}\\omega_{k}t)\\right].\n$$\nTo express this in terms of the cross spectral density, define\n$$\nJ_{\\alpha\\beta}(\\omega)=\\sum_{k}g_{k\\alpha}g_{k\\beta}\\,\\delta(\\omega-\\omega_{k}),\\qquad \\omega\\geq 0.\n$$\nReplacing the mode sum by an integral against $J_{\\alpha\\beta}(\\omega)$ yields\n$$\nC_{\\alpha\\beta}(t)=\\int_{0}^{\\infty}\\mathrm{d}\\omega\\,J_{\\alpha\\beta}(\\omega)\\left[\\left(n(\\omega)+1\\right)\\exp(-\\mathrm{i}\\omega t)+n(\\omega)\\exp(+\\mathrm{i}\\omega t)\\right].\n$$\n\nWe now compute the commutator correlator $\\chi_{\\alpha\\beta}(t)=\\langle[B_{\\alpha}(t),B_{\\beta}(0)]\\rangle_{\\beta}$. Using linearity and the mode commutators,\n$$\n[B_{\\alpha}(t),B_{\\beta}(0)]=\\sum_{k,\\ell}g_{k\\alpha}g_{\\ell\\beta}\\left([b_{k}(t),b_{\\ell}]+[b_{k}(t),b_{\\ell}^{\\dagger}]+[b_{k}^{\\dagger}(t),b_{\\ell}]+[b_{k}^{\\dagger}(t),b_{\\ell}^{\\dagger}]\\right).\n$$\nThe nonvanishing terms are $[b_{k}(t),b_{\\ell}^{\\dagger}]=\\exp(-\\mathrm{i}\\omega_{k}t)\\,[b_{k},b_{\\ell}^{\\dagger}]=\\exp(-\\mathrm{i}\\omega_{k}t)\\,\\delta_{k\\ell}$ and $[b_{k}^{\\dagger}(t),b_{\\ell}]=\\exp(+\\mathrm{i}\\omega_{k}t)\\,[b_{k}^{\\dagger},b_{\\ell}]=-\\exp(+\\mathrm{i}\\omega_{k}t)\\,\\delta_{k\\ell}$. Thus,\n$$\n[B_{\\alpha}(t),B_{\\beta}(0)]=\\sum_{k}g_{k\\alpha}g_{k\\beta}\\left(\\exp(-\\mathrm{i}\\omega_{k}t)-\\exp(+\\mathrm{i}\\omega_{k}t)\\right)=-2\\,\\mathrm{i}\\sum_{k}g_{k\\alpha}g_{k\\beta}\\,\\sin(\\omega_{k}t),\n$$\nwhich is a c-number and therefore independent of the bath state. Converting the sum to an integral using $J_{\\alpha\\beta}(\\omega)$ gives\n$$\n\\chi_{\\alpha\\beta}(t)=-2\\,\\mathrm{i}\\int_{0}^{\\infty}\\mathrm{d}\\omega\\,J_{\\alpha\\beta}(\\omega)\\,\\sin(\\omega t).\n$$\n\nCollecting results, we have obtained closed-form expressions for the Heisenberg-evolved bath operator and its thermal two-time correlators in terms of the cross spectral density $J_{\\alpha\\beta}(\\omega)$ and the Bose–Einstein distribution $n(\\omega)$:\n$$\nB_{\\alpha}(t)=\\sum_{k}g_{k\\alpha}\\left(b_{k}\\,\\exp(-\\mathrm{i}\\omega_{k}t)+b_{k}^{\\dagger}\\,\\exp(+\\mathrm{i}\\omega_{k}t)\\right),\n$$\n$$\nC_{\\alpha\\beta}(t)=\\int_{0}^{\\infty}\\mathrm{d}\\omega\\,J_{\\alpha\\beta}(\\omega)\\left[\\left(n(\\omega)+1\\right)\\exp(-\\mathrm{i}\\omega t)+n(\\omega)\\exp(+\\mathrm{i}\\omega t)\\right],\n$$\n$$\n\\chi_{\\alpha\\beta}(t)=-2\\,\\mathrm{i}\\int_{0}^{\\infty}\\mathrm{d}\\omega\\,J_{\\alpha\\beta}(\\omega)\\,\\sin(\\omega t).\n$$\nThese satisfy stationarity and embody the fluctuation–dissipation structure, with $C_{\\alpha\\beta}(t)$ encoding thermal fluctuations and $\\chi_{\\alpha\\beta}(t)$ encoding the bath response independent of temperature.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\displaystyle B_{\\alpha}(t)=\\sum_{k}g_{k\\alpha}\\left(b_{k}\\,\\exp(-\\mathrm{i}\\omega_{k}t)+b_{k}^{\\dagger}\\,\\exp(+\\mathrm{i}\\omega_{k}t)\\right) \n\\displaystyle C_{\\alpha\\beta}(t)=\\int_{0}^{\\infty}\\mathrm{d}\\omega\\,J_{\\alpha\\beta}(\\omega)\\left[\\left(n(\\omega)+1\\right)\\exp(-\\mathrm{i}\\omega t)+n(\\omega)\\exp(+\\mathrm{i}\\omega t)\\right] \n\\displaystyle \\chi_{\\alpha\\beta}(t)=-2\\,\\mathrm{i}\\int_{0}^{\\infty}\\mathrm{d}\\omega\\,J_{\\alpha\\beta}(\\omega)\\,\\sin(\\omega t)\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "The spectral density, $J(\\omega)$, is a cornerstone of open quantum systems theory, yet it can often seem like an abstract input to our models. This practice  grounds this crucial function in physical reality by guiding you through its derivation for two common environmental models: acoustic phonons in a solid and electromagnetic modes in a transmission line. By working through these examples, you will develop a powerful intuition for how the dimensionality and underlying physics of a bath dictate the frequency scaling of its spectral density, a key factor in the resulting system dynamics.",
            "id": "3785598",
            "problem": "A bosonic environment modeled as a continuum of harmonic modes is described by the bath Hamiltonian $H_{B} = \\sum_{\\mathbf{k}} \\hbar \\omega_{\\mathbf{k}} \\hat{b}_{\\mathbf{k}}^{\\dagger} \\hat{b}_{\\mathbf{k}}$, and a system-bath interaction of the linear form $H_{I} = \\hat{X} \\sum_{\\mathbf{k}} c_{\\mathbf{k}} \\left( \\hat{b}_{\\mathbf{k}} + \\hat{b}_{\\mathbf{k}}^{\\dagger} \\right)$, where $\\hat{X}$ is a Hermitian system operator and $c_{\\mathbf{k}}$ are real-valued coupling amplitudes. The spectral density is defined as $J(\\omega) = \\pi \\sum_{\\mathbf{k}} c_{\\mathbf{k}}^{2} \\, \\delta\\!\\left( \\omega - \\omega_{\\mathbf{k}} \\right)$.\n\nConsider two distinct physical realizations of the bosonic environment:\n\n(1) An acoustic phonon bath in spatial dimension $d \\in \\{1,2,3\\}$ with longitudinal modes of linear dispersion $\\omega_{\\mathbf{k}} = v \\, |\\mathbf{k}|$, mass density $\\rho$, and displacement field operator $\\hat{\\mathbf{u}}(\\mathbf{r})$ quantized in the usual way. Assume the system couples to the local dilation via a deformation potential, so that the interaction is $H_{I}^{\\text{ph}} = \\lambda \\, \\hat{X} \\, \\nabla \\cdot \\hat{\\mathbf{u}}(\\mathbf{r}_{0})$, with $\\lambda$ a coupling constant and $\\mathbf{r}_{0}$ the system position. Use the standard quantization of the displacement field to infer the scaling of $c_{\\mathbf{k}}$ with $|\\mathbf{k}|$ and $\\omega_{\\mathbf{k}}$.\n\n(2) A one-dimensional electromagnetic transmission line with phase velocity $v$, characteristic capacitance per unit length $C'$, and quantized voltage field $\\hat{V}(z)$ at position $z$. Suppose the system with charge operator $\\hat{Q}$ couples capacitively to the local voltage at $z=0$ via $H_{I}^{\\text{TL}} = \\hat{Q} \\, \\hat{V}(0)$. Use the standard quantization of the voltage field in a one-dimensional waveguide to infer the scaling of $c_{k}$ with $\\omega_{k}$.\n\nStarting from the above microscopic models and the definition of $J(\\omega)$, derive, for each case, the power-law scaling exponent $s$ defined by $J(\\omega) \\propto \\omega^{s}$ in the low-frequency regime. Report the four exponents as $s_{1}$, $s_{2}$, $s_{3}$ for the acoustic phonon environment in spatial dimensions $d=1,2,3$ respectively, and $s_{\\text{TL}}$ for the one-dimensional transmission line. Express your final answer as a row matrix $\\begin{pmatrix} s_{1}  s_{2}  s_{3}  s_{\\text{TL}} \\end{pmatrix}$. No numerical values are required and no units should be included in the final answer.",
            "solution": "The problem requires the derivation of the scaling exponent $s$ for the spectral density $J(\\omega) \\propto \\omega^s$ for two types of bosonic environments: an acoustic phonon bath in dimensions $d \\in \\{1,2,3\\}$ and a one-dimensional electromagnetic transmission line. The analysis begins with the definition of the spectral density in the continuum limit.\n\nThe spectral density is given by $J(\\omega) = \\pi \\sum_{\\mathbf{k}} c_{\\mathbf{k}}^{2} \\, \\delta\\!\\left( \\omega - \\omega_{\\mathbf{k}} \\right)$. In the continuum limit for a quantization volume $V_d = L^d$, the sum over wavevectors $\\mathbf{k}$ transitions to an integral:\n$$ \\sum_{\\mathbf{k}} \\rightarrow \\frac{V_d}{(2\\pi)^d} \\int d^d\\mathbf{k} $$\nThus, the spectral density becomes:\n$$ J(\\omega) = \\pi \\frac{V_d}{(2\\pi)^d} \\int d^d\\mathbf{k} \\, c_{\\mathbf{k}}^{2} \\, \\delta\\!\\left( \\omega - \\omega_{\\mathbf{k}} \\right) $$\nTo find the scaling of $J(\\omega)$, we must first determine the dependence of the squared coupling amplitudes, $c_{\\mathbf{k}}^2$, on the wavevector $\\mathbf{k}$ and frequency $\\omega_{\\mathbf{k}}$ for each case.\n\n**1. Acoustic Phonon Bath**\n\nThe system couples to the bath via the deformation potential, with the interaction Hamiltonian $H_{I}^{\\text{ph}} = \\lambda \\, \\hat{X} \\, \\nabla \\cdot \\hat{\\mathbf{u}}(\\mathbf{r}_{0})$. To find the form of $c_{\\mathbf{k}}$, we use the standard second quantization of the longitudinal displacement field operator $\\hat{\\mathbf{u}}(\\mathbf{r})$:\n$$ \\hat{\\mathbf{u}}(\\mathbf{r}) = \\sum_{\\mathbf{k}} \\sqrt{\\frac{\\hbar}{2 \\rho V_d \\omega_{\\mathbf{k}}}} \\frac{\\mathbf{k}}{|\\mathbf{k}|} \\left( \\hat{b}_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}} + \\hat{b}_{\\mathbf{k}}^{\\dagger} e^{-i \\mathbf{k} \\cdot \\mathbf{r}} \\right) $$\nwhere $\\rho$ is the mass density, $V_d$ is the quantization volume in $d$ dimensions, and $\\mathbf{k}/|\\mathbf{k}|$ is the unit vector for longitudinal polarization.\n\nThe interaction involves the divergence of the displacement field:\n$$ \\nabla \\cdot \\hat{\\mathbf{u}}(\\mathbf{r}) = \\sum_{\\mathbf{k}} \\sqrt{\\frac{\\hbar}{2 \\rho V_d \\omega_{\\mathbf{k}}}} \\frac{\\mathbf{k}}{|\\mathbf{k}|} \\cdot \\nabla \\left( \\hat{b}_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}} + \\hat{b}_{\\mathbf{k}}^{\\dagger} e^{-i \\mathbf{k} \\cdot \\mathbf{r}} \\right) $$\n$$ \\nabla \\cdot \\hat{\\mathbf{u}}(\\mathbf{r}) = \\sum_{\\mathbf{k}} \\sqrt{\\frac{\\hbar}{2 \\rho V_d \\omega_{\\mathbf{k}}}} \\left( \\hat{b}_{\\mathbf{k}} (i \\mathbf{k} \\cdot \\frac{\\mathbf{k}}{|\\mathbf{k}|}) e^{i \\mathbf{k} \\cdot \\mathbf{r}} + \\hat{b}_{\\mathbf{k}}^{\\dagger} (-i \\mathbf{k} \\cdot \\frac{\\mathbf{k}}{|\\mathbf{k}|}) e^{-i \\mathbf{k} \\cdot \\mathbf{r}} \\right) $$\nSince $\\mathbf{k} \\cdot \\mathbf{k} / |\\mathbf{k}| = |\\mathbf{k}|$, this simplifies to:\n$$ \\nabla \\cdot \\hat{\\mathbf{u}}(\\mathbf{r}) = \\sum_{\\mathbf{k}} i |\\mathbf{k}| \\sqrt{\\frac{\\hbar}{2 \\rho V_d \\omega_{\\mathbf{k}}}} \\left( \\hat{b}_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}} - \\hat{b}_{\\mathbf{k}}^{\\dagger} e^{-i \\mathbf{k} \\cdot \\mathbf{r}} \\right) $$\nEvaluating at the system's position $\\mathbf{r}_0$ and substituting into $H_{I}^{\\text{ph}}$, we get an interaction Hamiltonian. By performing a trivial canonical transformation $\\hat{b}_{\\mathbf{k}} \\to -i \\hat{b}_{\\mathbf{k}} e^{-i\\mathbf{k}\\cdot\\mathbf{r}_0}$, which preserves the bath Hamiltonian $H_B$, the interaction can be brought to the specified form $H_{I} = \\hat{X} \\sum_{\\mathbf{k}} c_{\\mathbf{k}} (\\hat{b}_{\\mathbf{k}} + \\hat{b}_{\\mathbf{k}}^{\\dagger})$. The magnitude of the coupling is what matters for the spectral density. We can identify the squared coupling strength as:\n$$ c_{\\mathbf{k}}^2 \\propto \\lambda^2 \\left( |\\mathbf{k}| \\sqrt{\\frac{\\hbar}{2 \\rho V_d \\omega_{\\mathbf{k}}}} \\right)^2 = \\frac{\\lambda^2 \\hbar |\\mathbf{k}|^2}{2 \\rho V_d \\omega_{\\mathbf{k}}} $$\nThe problem states a linear dispersion relation $\\omega_{\\mathbf{k}} = v |\\mathbf{k}|$. Substituting this into the expression for $c_{\\mathbf{k}}^2$ gives the scaling with respect to frequency:\n$c_{\\mathbf{k}}^2 \\propto \\frac{|\\mathbf{k}|^2}{\\omega_{\\mathbf{k}}} = \\frac{|\\mathbf{k}|^2}{v |\\mathbf{k}|} = \\frac{|\\mathbf{k}|}{v} = \\frac{\\omega_{\\mathbf{k}}}{v^2} \\propto \\omega_{\\mathbf{k}}$\nNow we can compute the spectral density. We switch to spherical coordinates in k-space, where $d^d\\mathbf{k} = k^{d-1} dk \\, d\\Omega_{d-1}$, with $k = |\\mathbf{k}|$. The integral over the solid angle $d\\Omega_{d-1}$ yields a constant factor.\n$J(\\omega) \\propto \\int d^d\\mathbf{k} \\, c_{\\mathbf{k}}^2 \\, \\delta(\\omega - \\omega_{\\mathbf{k}}) \\propto \\int_0^\\infty k^{d-1} dk \\, \\omega_k \\, \\delta(\\omega - v k)$\nUsing the property of the Dirac delta function, $\\delta(\\omega - v k) = \\frac{1}{v} \\delta(k - \\omega/v)$:\n$J(\\omega) \\propto \\int_0^\\infty k^{d-1} (vk) \\frac{1}{v} \\delta(k - \\omega/v) \\, dk = \\int_0^\\infty k^d \\delta(k - \\omega/v) \\, dk$\nEvaluating the integral at $k = \\omega/v$ gives:\n$J(\\omega) \\propto \\left( \\frac{\\omega}{v} \\right)^d \\propto \\omega^d$\nThe scaling exponent $s$ is therefore equal to the spatial dimension $d$. This yields the first three exponents:\n$s_1 = 1$, $s_2 = 2$, $s_3 = 3$.\n\n**2. 1D Electromagnetic Transmission Line**\n\nThe system couples to the voltage at position $z=0$ via $H_{I}^{\\text{TL}} = \\hat{Q} \\, \\hat{V}(0)$. The standard quantization for the voltage operator $\\hat{V}(z)$ on a transmission line of length $L$ with capacitance per unit length $C'$ is:\n$$ \\hat{V}(z) = \\sum_k \\sqrt{\\frac{\\hbar \\omega_k}{2 C' L}} \\left( \\hat{b}_k e^{ikz} + \\hat{b}_k^\\dagger e^{-ikz} \\right) $$\nThe dispersion relation is linear, $\\omega_k = v |k|$, where $v$ is the phase velocity. The interaction Hamiltonian is found by evaluating $\\hat{V}(z)$ at $z=0$:\n$$ H_{I}^{\\text{TL}} = \\hat{Q} \\sum_k \\sqrt{\\frac{\\hbar \\omega_k}{2 C' L}} \\left( \\hat{b}_k + \\hat{b}_k^\\dagger \\right) $$\nComparing this with the generic form $H_{I} = \\hat{S} \\sum_k c_k (\\hat{b}_k + \\hat{b}_k^\\dagger)$, where the system operator is $\\hat{S}=\\hat{Q}$, we identify the squared coupling constant:\n$c_k^2 = \\frac{\\hbar \\omega_k}{2 C' L} \\propto \\omega_k$\nNow we compute the spectral density for this $1$-dimensional case ($d=1$). The sum over $k$ becomes $\\sum_k \\to \\frac{L}{2\\pi} \\int dk$.\n$$ J(\\omega) = \\pi \\sum_k c_k^2 \\delta(\\omega - \\omega_k) = \\pi \\frac{L}{2\\pi} \\int_{-\\infty}^{\\infty} dk \\, \\frac{\\hbar \\omega_k}{2 C' L} \\, \\delta(\\omega - v|k|) $$\n$$ J(\\omega) = \\frac{\\hbar}{4 C'} \\int_{-\\infty}^{\\infty} dk \\, \\omega_k \\, \\delta(\\omega - v|k|) = \\frac{\\hbar}{4 C'} \\int_{-\\infty}^{\\infty} dk \\, v|k| \\, \\delta(\\omega - v|k|) $$\nFor $\\omega > 0$, the integral can be split into positive and negative $k$:\n$$ \\int_{-\\infty}^{\\infty} |k| \\delta(\\omega - v|k|) dk = \\int_0^{\\infty} k \\delta(\\omega - vk) dk + \\int_{-\\infty}^0 (-k) \\delta(\\omega + vk) dk $$\nUsing $\\delta(ax) = \\frac{1}{|a|} \\delta(x)$, the integrals evaluate to:\n$$ \\int_0^{\\infty} k \\frac{1}{v}\\delta(k - \\omega/v) dk + \\int_{-\\infty}^0 (-k) \\frac{1}{v}\\delta(k + \\omega/v) dk = \\frac{1}{v} (\\omega/v) + \\frac{1}{v}(- (-\\omega/v)) = \\frac{2\\omega}{v^2} $$\nSubstituting this back into the expression for $J(\\omega)$:\n$$ J(\\omega) = \\frac{\\hbar v}{4 C'} \\left(\\frac{2\\omega}{v^2}\\right) = \\frac{\\hbar \\omega}{2 C' v} $$\nThe spectral density is directly proportional to $\\omega$. Therefore, the scaling exponent is $s_{\\text{TL}} = 1$.\n\n**Summary of Results**\nThe calculated exponents are:\n-   Acoustic phonons, $d=1$: $s_1 = 1$\n-   Acoustic phonons, $d=2$: $s_2 = 2$\n-   Acoustic phonons, $d=3$: $s_3 = 3$\n-   1D transmission line: $s_{\\text{TL}} = 1$\n\nThese values can be presented in the requested row matrix format.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  2  3  1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While many system-bath problems are too complex to solve exactly, certain models permit a full analytical solution, providing invaluable benchmarks for testing the accuracy of approximation methods. This exercise  leverages one such model—a qubit coupled to a bath with a Lorentzian spectral density—to explore the Time-Convolutionless (TCL) expansion, a powerful technique for deriving time-local master equations. By deriving both the exact dynamics and the TCL approximation, and then comparing them numerically, you will gain a practical understanding of the performance and limitations of this important theoretical tool.",
            "id": "3785588",
            "problem": "Consider a two-level quantum system (a qubit) interacting with a bosonic environment through a rotating-wave system-bath interaction. The system Hamiltonian is $H_{\\mathrm{S}} = \\frac{\\omega_0}{2}\\sigma_z$, where $\\sigma_z$ is the Pauli-$z$ matrix and $\\omega_0$ is the qubit frequency. The interaction Hamiltonian is $H_{\\mathrm{I}} = g\\left(\\sigma_{+}\\otimes B + \\sigma_{-}\\otimes B^{\\dagger}\\right)$, where $\\sigma_{+}$ and $\\sigma_{-}$ are the qubit raising and lowering operators, $B$ is a bath operator constructed from bosonic annihilation operators, and $g$ is a dimensionless coupling constant absorbed into the spectral parameters defined below. The bath is initially in its vacuum state and is fully characterized by a Lorentzian spectral density centered at $\\omega_c$, given by\n$$\nJ(\\omega) = \\frac{\\Gamma \\lambda^2}{2\\pi\\left[(\\omega - \\omega_c)^2 + \\lambda^2\\right]},\n$$\nwhere $\\Gamma$ sets the overall coupling scale and $\\lambda$ is the linewidth of the Lorentzian. Define the detuning $\\Delta = \\omega_c - \\omega_0$. In this model, the system’s excited-state amplitude $G(t)$ obeys a non-Markovian memory equation driven by the bath correlation function derived from $J(\\omega)$.\n\nYour task is to construct the Time-Convolutionless (TCL) generator to second order and to third order for this qubit-boson model, and to quantify their accuracy against the exact reduced dynamics for the Lorentzian spectral density. Start from fundamental definitions: the Liouville-von Neumann equation, the projection operator formalism, and the definition of the bath correlation function from the spectral density. From these bases, do the following, without using any shortcut formulas in the problem statement:\n- Derive the bath two-point correlation function $\\alpha(t)$ implied by $J(\\omega)$ and the vacuum initial state, and formulate the exact memory-kernel equation for the excited-state amplitude $G(t)$ with initial condition $G(0) = 1$.\n- Obtain the exact analytical expression for $G(t)$ for the Lorentzian spectral density via first principles (for example, by Laplace-transform methods) starting from the memory-kernel equation.\n- Construct the TCL generator up to second order in the coupling (Born approximation), yielding a time-local master equation with time-dependent decay rate and energy shift. Then construct the third-order TCL generator for this Gaussian bosonic bath and discuss whether it contributes beyond second order.\n- Using the second-order TCL generator and the third-order TCL generator, obtain corresponding approximations to the excited-state amplitude, $G_{\\mathrm{TCL2}}(t)$ and $G_{\\mathrm{TCL3}}(t)$, consistent with the time-local master equation.\n\nImplement a program that:\n- Computes the exact excited-state population $P_{\\mathrm{exact}}(t) = |G(t)|^2$.\n- Computes the second-order Time-Convolutionless excited-state population $P_{\\mathrm{TCL2}}(t) = |G_{\\mathrm{TCL2}}(t)|^2$ and the third-order Time-Convolutionless excited-state population $P_{\\mathrm{TCL3}}(t) = |G_{\\mathrm{TCL3}}(t)|^2$.\n- Evaluates the maximum absolute error over a uniform time grid for each approximation against the exact dynamics: $\\max_{t\\in[0,T]} \\left|P_{\\mathrm{TCL2}}(t) - P_{\\mathrm{exact}}(t)\\right|$ and $\\max_{t\\in[0,T]} \\left|P_{\\mathrm{TCL3}}(t) - P_{\\mathrm{exact}}(t)\\right|$.\n\nAll quantities are dimensionless. Use a uniform time grid with $N = 10001$ points over $[0,T]$ for each test. The test suite consists of the following parameter sets $(\\Gamma,\\lambda,\\Delta,T)$:\n- Test $1$: $(\\Gamma,\\lambda,\\Delta,T) = (0.05,1.0,0.0,10.0)$.\n- Test $2$: $(\\Gamma,\\lambda,\\Delta,T) = (0.5,0.2,0.0,20.0)$.\n- Test $3$: $(\\Gamma,\\lambda,\\Delta,T) = (0.2,0.5,1.0,20.0)$.\n- Test $4$: $(\\Gamma,\\lambda,\\Delta,T) = (2.0,0.5,0.0,20.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the maximum errors for the second-order and third-order TCL approximations in sequence for each test case in the order above, specifically:\n$$\n\\left[\\max\\left|P_{\\mathrm{TCL2}} - P_{\\mathrm{exact}}\\right|_{1}, \\max\\left|P_{\\mathrm{TCL3}} - P_{\\mathrm{exact}}\\right|_{1}, \\max\\left|P_{\\mathrm{TCL2}} - P_{\\mathrm{exact}}\\right|_{2}, \\max\\left|P_{\\mathrm{TCL3}} - P_{\\mathrm{exact}}\\right|_{2}, \\max\\left|P_{\\mathrm{TCL2}} - P_{\\mathrm{exact}}\\right|_{3}, \\max\\left|P_{\\mathrm{TCL3}} - P_{\\mathrm{exact}}\\right|_{3}, \\max\\left|P_{\\mathrm{TCL2}} - P_{\\mathrm{exact}}\\right|_{4}, \\max\\left|P_{\\mathrm{TCL3}} - P_{\\mathrm{exact}}\\right|_{4}\\right],\n$$\nwhere the subscript indicates the test index. Express all entries as decimal floats.",
            "solution": "The problem presented is a standard, exactly solvable model in the theory of open quantum systems, describing a two-level atom (qubit) interacting with a structured bosonic reservoir. The task is to derive the exact dynamics and compare it to approximations derived from the Time-Convolutionless (TCL) master equation formalism. All steps will be derived from fundamental principles as requested.\n\n### 1. Bath Correlation Function and Exact Memory-Kernel Equation\n\nThe total Hamiltonian of the system and bath is $H = H_S + H_B + H_I$, where $H_S = \\frac{\\omega_0}{2}\\sigma_z$ is the system Hamiltonian, $H_B = \\sum_k \\omega_k b_k^\\dagger b_k$ is the bath Hamiltonian (using units where $\\hbar=1$), and $H_I = g(\\sigma_+ \\otimes B + \\sigma_- \\otimes B^\\dagger)$ is the interaction Hamiltonian. The bath operator is a collective operator $B = \\sum_k g_k b_k$, where $g_k$ are coupling constants. We work in the interaction picture with respect to $H_0 = H_S + H_B$. The interaction Hamiltonian becomes:\n$$\nH_I(t) = e^{iH_0 t} H_I e^{-iH_0 t} = g\\left( \\sigma_+ e^{i\\omega_0 t} \\otimes B(t) + \\sigma_- e^{-i\\omega_0 t} \\otimes B^\\dagger(t) \\right)\n$$\nwhere $B(t) = e^{iH_B t} B e^{-iH_B t} = \\sum_k g_k b_k e^{-i\\omega_k t}$.\n\nThe system is initially in the excited state $|e\\rangle$ and the bath is in the vacuum state $|0_B\\rangle$, so the initial state of the total system is $|\\psi(0)\\rangle = |e, 0_B\\rangle$. Due to the rotating-wave form of the interaction, the total number of excitations is conserved. The state of the system at any time $t$ can be written in the single-excitation subspace as:\n$$\n|\\psi(t)\\rangle = G(t)|e, 0_B\\rangle + \\sum_k c_k(t)|g, 1_k\\rangle\n$$\nwhere $|g, 1_k\\rangle$ represents the qubit in the ground state and one excitation in the $k$-th bath mode. The initial condition is $G(0)=1$ and $c_k(0)=0$ for all $k$.\n\nThe time evolution is governed by the Schrödinger equation $i\\frac{d}{dt}|\\psi(t)\\rangle = H_I(t)|\\psi(t)\\rangle$. Projecting this equation onto $\\langle e, 0_B|$ and $\\langle g, 1_k|$ yields a set of coupled differential equations for the amplitudes:\n$$\ni \\dot{G}(t) = g \\sum_k g_k e^{i\\omega_0 t} \\langle 0_B | b_k e^{-i\\omega_k t} | 1_k \\rangle c_k(t) = g \\sum_k g_k e^{i(\\omega_0-\\omega_k)t} c_k(t)\n$$\n$$\ni \\dot{c}_k(t) = g g_k e^{-i\\omega_0 t} \\langle 1_k | b_k^\\dagger e^{i\\omega_k t} | 0_B \\rangle G(t) = g g_k e^{i(\\omega_k - \\omega_0) t} G(t)\n$$\nIntegrating the equation for $c_k(t)$ from $0$ to $t$ gives:\n$$\nc_k(t) = -i g g_k \\int_0^t d\\tau\\; e^{i(\\omega_k - \\omega_0)\\tau} G(\\tau)\n$$\nSubstituting this back into the equation for $\\dot{G}(t)$:\n$$\n\\dot{G}(t) = -g^2 \\sum_k |g_k|^2 \\int_0^t d\\tau\\; e^{-i(\\omega_k - \\omega_0)(t-\\tau)} G(\\tau)\n$$\nIn the continuum limit, the sum over modes is replaced by an integral over frequencies, weighted by the spectral density $J(\\omega) = \\sum_k g^2|g_k|^2 \\delta(\\omega-\\omega_k)$. The equation becomes:\n$$\n\\dot{G}(t) = -\\int_0^t d\\tau \\left( \\int_0^\\infty d\\omega\\; J(\\omega) e^{-i(\\omega-\\omega_0)(t-\\tau)} \\right) G(\\tau)\n$$\nThe quantity in the parenthesis is the memory kernel. We can relate this to the bath two-point correlation function. For a bath in the vacuum state $\\rho_B = |0_B \\rangle \\langle 0_B|$, the correlation function is defined as $\\alpha(t-s) \\equiv \\langle B(t)B^\\dagger(s)\\rangle_B = \\text{Tr}_B\\{\\rho_B B(t)B^\\dagger(s)\\}$. Substituting the expressions for $B(t)$ and using $\\langle b_k b_j^\\dagger \\rangle = \\delta_{kj}$:\n$$\n\\alpha(t-s) = \\sum_{k,j} g^2 g_k g_j e^{-i\\omega_k t} e^{i\\omega_j s} \\langle b_k b_j^\\dagger \\rangle = \\sum_k g^2|g_k|^2 e^{-i\\omega_k(t-s)} \\xrightarrow{\\text{continuum}} \\int_0^\\infty d\\omega\\; J(\\omega) e^{-i\\omega(t-s)}\n$$\nThe problem states that the coupling constant $g$ is absorbed into the spectral parameters, so we set $g=1$ henceforth. The given spectral density is $J(\\omega) = \\frac{\\Gamma \\lambda^2}{2\\pi\\left[(\\omega - \\omega_c)^2 + \\lambda^2\\right]}$. To evaluate the integral for $\\alpha(\\tau)$, we make the standard approximation of extending the integration lower limit to $-\\infty$, which is valid when $\\omega_c \\gg \\lambda$. This allows calculation via the residue theorem. For $\\tau0$, we close the contour in the lower half-plane, enclosing the pole at $\\omega = \\omega_c - i\\lambda$:\n$$\n\\alpha(\\tau) = \\int_{-\\infty}^\\infty d\\omega\\; \\frac{\\Gamma \\lambda^2}{2\\pi} \\frac{e^{-i\\omega\\tau}}{(\\omega-\\omega_c-i\\lambda)(\\omega-\\omega_c+i\\lambda)} = -2\\pi i \\left( \\frac{\\Gamma \\lambda^2}{2\\pi} \\right) \\text{Res}\\left[\\dots, \\omega_c-i\\lambda\\right] = \\frac{\\Gamma\\lambda}{2} e^{-\\lambda\\tau}e^{-i\\omega_c\\tau}\n$$\nThe memory kernel equation for $G(t)$ is thus:\n$$\n\\dot{G}(t) = -\\int_0^t d\\tau\\; \\alpha(t-\\tau) e^{i\\omega_0(t-\\tau)} G(\\tau) = -\\frac{\\Gamma\\lambda}{2} \\int_0^t d\\tau\\; e^{-(\\lambda + i(\\omega_c-\\omega_0))(t-\\tau)} G(\\tau)\n$$\nUsing the detuning $\\Delta = \\omega_c - \\omega_0$, we arrive at the exact memory-kernel equation:\n$$\n\\dot{G}(t) = -\\frac{\\Gamma\\lambda}{2} \\int_0^t d\\tau\\; e^{-(\\lambda+i\\Delta)(t-\\tau)} G(\\tau)\n$$\n\n### 2. Exact Analytical Solution for $G(t)$\n\nThe equation for $G(t)$ is a linear Volterra integro-differential equation with a convolution kernel, which is ideally suited for solution by Laplace transforms. Let $\\tilde{G}(s) = \\mathcal{L}[G(t)](s)$. Applying the Laplace transform to the equation:\n$$\ns\\tilde{G}(s) - G(0) = -\\frac{\\Gamma\\lambda}{2} \\mathcal{L}[e^{-(\\lambda+i\\Delta)t}](s) \\tilde{G}(s)\n$$\nUsing $G(0)=1$ and $\\mathcal{L}[e^{-at}](s) = \\frac{1}{s+a}$:\n$$\ns\\tilde{G}(s) - 1 = -\\frac{\\Gamma\\lambda}{2} \\frac{1}{s+\\lambda+i\\Delta} \\tilde{G}(s)\n$$\nSolving for $\\tilde{G}(s)$:\n$$\n\\tilde{G}(s) \\left(s + \\frac{\\Gamma\\lambda/2}{s+\\lambda+i\\Delta}\\right) = 1 \\implies \\tilde{G}(s) = \\frac{s+\\lambda+i\\Delta}{s(s+\\lambda+i\\Delta) + \\Gamma\\lambda/2} = \\frac{s+\\lambda+i\\Delta}{s^2 + (\\lambda+i\\Delta)s + \\Gamma\\lambda/2}\n$$\nTo find $G(t) = \\mathcal{L}^{-1}[\\tilde{G}(s)](t)$, we use partial fraction expansion. The roots of the quadratic denominator $s^2 + (\\lambda+i\\Delta)s + \\Gamma\\lambda/2 = 0$ are given by $s_\\pm = \\frac{-(\\lambda+i\\Delta) \\pm \\sqrt{(\\lambda+i\\Delta)^2 - 2\\Gamma\\lambda}}{2}$. Let $\\Omega = \\sqrt{(\\lambda+i\\Delta)^2 - 2\\Gamma\\lambda}$. The roots are $s_\\pm = -\\frac{1}{2}(\\lambda+i\\Delta) \\pm \\frac{1}{2}\\Omega$.\nWe expand $\\tilde{G}(s) = \\frac{A}{s-s_+} + \\frac{B}{s-s_-}$. The coefficients are found to be $A = \\frac{s_++\\lambda+i\\Delta}{s_+-s_-}$ and $B = \\frac{s_-+\\lambda+i\\Delta}{s_--s_+}$. Substituting the expressions for $s_\\pm$:\n$$\nA = \\frac{\\frac{1}{2}(\\lambda+i\\Delta) + \\frac{1}{2}\\Omega}{\\Omega} \\quad , \\quad B = \\frac{\\frac{1}{2}(\\lambda+i\\Delta) - \\frac{1}{2}\\Omega}{-\\Omega}\n$$\nThe inverse Laplace transform is $G(t) = A e^{s_+ t} + B e^{s_- t}$. After algebraic simplification, this yields:\n$$\nG(t) = e^{-\\frac{(\\lambda+i\\Delta)}{2}t} \\left( \\frac{A+B}{2}(e^{\\frac{\\Omega t}{2}} + e^{-\\frac{\\Omega t}{2}}) + \\frac{A-B}{2}(e^{\\frac{\\Omega t}{2}} - e^{-\\frac{\\Omega t}{2}}) \\right)\n$$\n$$\nG(t) = e^{-\\frac{(\\lambda+i\\Delta)}{2}t} \\left( \\cosh\\left(\\frac{\\Omega t}{2}\\right) + \\frac{\\lambda+i\\Delta}{\\Omega} \\sinh\\left(\\frac{\\Omega t}{2}\\right) \\right)\n$$\nThis is the exact analytical solution for the excited state amplitude.\n\n### 3. Time-Convolutionless (TCL) Generators and Approximations\n\nThe TCL formalism recasts the non-local memory kernel equation into a time-local form, $\\dot{\\rho}_S(t) = \\mathcal{K}(t)\\rho_S(t)$, where $\\mathcal{K}(t)$ is the TCL generator. For the excited-state amplitude $G(t)$ in our single-excitation problem, this corresponds to an equation of the form $\\dot{G}(t) = -\\Lambda(t)G(t)$. The generator $\\Lambda(t)$ has a perturbative expansion in the coupling strength $\\Gamma$.\n\n**Second-Order TCL (TCL2):** The second-order (Born) approximation is obtained by assuming that the system's state changes slowly on the timescale of the bath correlation. In the memory integral $\\int_0^t d\\tau K(t-\\tau)G(\\tau)$, we \"factorize\" the memory by approximating $G(\\tau) \\approx G(t)$, which can then be pulled out of the integral.\n$$\n\\dot{G}_{\\mathrm{TCL2}}(t) = -\\left(\\int_0^t d\\tau\\; K(\\tau)\\right) G_{\\mathrm{TCL2}}(t)\n$$\nwhere $K(\\tau) = \\frac{\\Gamma\\lambda}{2}e^{-(\\lambda+i\\Delta)\\tau}$. The integral, which defines the second-order decay rate and frequency shift, is:\n$$\n\\Lambda_2(t) = \\int_0^t d\\tau\\; \\frac{\\Gamma\\lambda}{2} e^{-(\\lambda+i\\Delta)\\tau} = \\frac{\\Gamma\\lambda}{2(\\lambda+i\\Delta)} \\left(1 - e^{-(\\lambda+i\\Delta)t}\\right)\n$$\nThe resulting time-local differential equation $\\dot{G}_{\\mathrm{TCL2}}(t) = -\\Lambda_2(t)G_{\\mathrm{TCL2}}(t)$ is solved with the initial condition $G_{\\mathrm{TCL2}}(0)=1$:\n$$\nG_{\\mathrm{TCL2}}(t) = \\exp\\left(-\\int_0^t d\\tau\\; \\Lambda_2(\\tau)\\right)\n$$\nIntegrating $\\Lambda_2(\\tau)$ gives:\n$$\n\\int_0^t d\\tau\\; \\Lambda_2(\\tau) = \\frac{\\Gamma\\lambda}{2(\\lambda+i\\Delta)}\\left( \\int_0^t d\\tau\\; (1 - e^{-(\\lambda+i\\Delta)\\tau}) \\right) = \\frac{\\Gamma\\lambda t}{2(\\lambda+i\\Delta)} + \\frac{\\Gamma\\lambda}{2(\\lambda+i\\Delta)^2}\\left(e^{-(\\lambda+i\\Delta)t} - 1\\right)\n$$\nThus, the second-order TCL approximation for the amplitude is:\n$$\nG_{\\mathrm{TCL2}}(t) = \\exp\\left( -\\frac{\\Gamma\\lambda t}{2(\\lambda+i\\Delta)} - \\frac{\\Gamma\\lambda}{2(\\lambda+i\\Delta)^2}(e^{-(\\lambda+i\\Delta)t} - 1) \\right)\n$$\n\n**Third-Order TCL (TCL3):** The third-order generator $\\mathcal{K}_3(t)$ is constructed from three-time correlation functions of the bath operators appearing in $H_I$. For the interaction $H_I = \\sigma_+ B + \\sigma_- B^\\dagger$ with $B = \\sum_k g'_k b_k$ (with absorbed coupling), $\\mathcal{K}_3(t)$ will be a functional of three-point correlation functions such as $\\langle B(t_1)B(t_2)B^\\dagger(t_3) \\rangle_B$. The problem specifies a bosonic bath, initially in its vacuum state. The vacuum state is a Gaussian state. A defining property of Gaussian quantum states is that the expectation value of any product of an odd number of operators that are linear in creation/annihilation operators (like $B$ and $B^\\dagger$) is zero. Consequently, all three-point correlation functions vanish.\n$$\n\\langle B(t_1) B(t_2) B^\\dagger(t_3) \\rangle_B = 0,\\;\\; \\langle B(t_1) B(t_2) B(t_3) \\rangle_B = 0, \\;\\; \\text{etc.}\n$$\nSince the construction of $\\mathcal{K}_3(t)$ involves only such terms, we must conclude that the third-order TCL generator is identically zero: $\\mathcal{K}_3(t) = 0$. This implies that for this specific model, the TCL expansion contains only even-order terms. The TCL3 approximation therefore adds no correction to the TCL2 result.\n$$\nG_{\\mathrm{TCL3}}(t) = G_{\\mathrm{TCL2}}(t) \\quad \\text{and} \\quad P_{\\mathrm{TCL3}}(t) \\equiv |G_{\\mathrm{TCL3}}(t)|^2 = |G_{\\mathrm{TCL2}}(t)|^2 \\equiv P_{\\mathrm{TCL2}}(t)\n$$\n\n### 4. Implementation for Error Analysis\n\nThe task is to compute the maximum absolute error for the populations $P_{\\mathrm{TCL2}}(t)=|G_{\\mathrm{TCL2}}(t)|^2$ and $P_{\\mathrm{TCL3}}(t)=|G_{\\mathrm{TCL3}}(t)|^2$ against the exact population $P_{\\mathrm{exact}}(t)=|G(t)|^2$. Based on the analysis above, the error for the TCL3 approximation will be identical to that of the TCL2 approximation. We will implement the derived formulas for $G(t)$ and $G_{\\mathrm{TCL2}}(t)$, compute the corresponding populations over the specified time grid, and find the maximum absolute difference for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum absolute error of the TCL2 and TCL3 approximations\n    for the excited-state population of a qubit coupled to a bosonic bath\n    with a Lorentzian spectral density.\n    \"\"\"\n    test_cases = [\n        (0.05, 1.0, 0.0, 10.0),  # Test 1: (Gamma, lambda, Delta, T)\n        (0.5, 0.2, 0.0, 20.0),   # Test 2\n        (0.2, 0.5, 1.0, 20.0),   # Test 3\n        (2.0, 0.5, 0.0, 20.0),   # Test 4\n    ]\n\n    N = 10001\n    results = []\n\n    for case in test_cases:\n        Gamma, lmbda, Delta, T = case\n        t = np.linspace(0, T, N)\n\n        # --- Exact Solution ---\n        # G(t) = exp(-z*t/2) * [cosh(Omega*t/2) + z/Omega * sinh(Omega*t/2)]\n        # where z = lmbda + i*Delta\n        # and Omega = sqrt(z**2 - 2*Gamma*lmbda)\n        z = lmbda + 1j * Delta\n        Omega = np.sqrt(z**2 - 2 * Gamma * lmbda)\n        \n        # Guard against division by zero if Omega is numerically zero,\n        # although this case is not in the test suite.\n        if np.isclose(Omega, 0.0):\n            # Critically damped case: G(t) = exp(-z*t/2) * (1 + z*t/2)\n            G_exact = np.exp(-z * t / 2.0) * (1.0 + z * t / 2.0)\n        else:\n            exp_term = np.exp(-z * t / 2.0)\n            cosh_term = np.cosh(Omega * t / 2.0)\n            sinh_term = (z / Omega) * np.sinh(Omega * t / 2.0)\n            G_exact = exp_term * (cosh_term + sinh_term)\n        \n        P_exact = np.abs(G_exact)**2\n\n        # --- TCL2 Approximation ---\n        # G_TCL2(t) = exp(-C1 * t - C2 * (exp(-z*t) - 1))\n        # where C1 = Gamma*lambda / (2*z)\n        # and   C2 = C1 / z\n        # We need to handle the case z=0, though not in the test suite.\n        if np.isclose(z, 0.0):\n            # If z=0, then lmbda=0 and Delta=0. The kernel is zero, so G=1.\n            G_TCL2 = np.ones_like(t, dtype=complex)\n        else:\n            C1 = (Gamma * lmbda) / (2.0 * z)\n            C2 = C1 / z\n            exponent = -C1 * t - C2 * (np.exp(-z * t) - 1.0)\n            G_TCL2 = np.exp(exponent)\n\n        P_TCL2 = np.abs(G_TCL2)**2\n\n        # --- TCL3 Approximation ---\n        # For a Gaussian bath (like the vacuum state of a harmonic bath),\n        # all odd-order correlation functions are zero. The third-order\n        # TCL generator K3(t) depends on 3-point correlation functions and is\n        # thus identically zero.\n        # Therefore, TCL3 provides no correction over TCL2.\n        P_TCL3 = P_TCL2\n\n        # --- Error Calculation ---\n        max_err_tcl2 = np.max(np.abs(P_TCL2 - P_exact))\n        max_err_tcl3 = np.max(np.abs(P_TCL3 - P_exact)) # This will be identical to max_err_tcl2\n\n        results.append(max_err_tcl2)\n        results.append(max_err_tcl3)\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}