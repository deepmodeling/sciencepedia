{
    "hands_on_practices": [
        {
            "introduction": "在正则系综中，计算配分函数是平衡态统计力学的核心任务。这个问题是一个完美的范例，展示了在一个由无相互作用组分（谐振子）组成的系统中，可分离性所带来的强大威力。掌握这一计算方法，为从微观模型系统地推导出所有宏观热力学性质奠定了基础。",
            "id": "3764716",
            "problem": "考虑一个开放的经典系统，它由$N$个独立的、质量为$m$、角频率为$\\omega$的一维谐振子组成。每个谐振子都与一个绝对温度为$T$的大热库弱耦合，因此系统处于正则平衡状态。该系统的哈密顿量为\n$$\nH(\\{q_i,p_i\\})=\\sum_{i=1}^{N}\\left[\\frac{p_i^{2}}{2m}+\\frac{1}{2}m\\omega^{2}q_i^{2}\\right],\n$$\n其中$\\{q_i\\}$和$\\{p_i\\}$分别为正则坐标和正则动量。使用正则系综，其中逆温度为$\\beta=1/(k_{B}T)$，$k_{B}$是 Boltzmann 常数(k_B)。使用由 Planck 常数(h)对每一维自由度对进行粗粒化的经典 Liouville 相空间测度，以使配分函数无量纲化。从第一性原理出发——即正则概率密度$\\rho(\\{q_i,p_i\\})\\propto\\exp(-\\beta H)$以及经典正则配分函数作为适当归一化的相空间积分的定义——推导：\n- $N$个独立振子的总正则配分函数$Z_{N}(T)$，\n- Helmholtz 自由能$F(T)$，\n- 内能$U(T)$，\n- 通过 Boltzmann 的平衡框架（等价于正则态的 Gibbs 熵）得到的熵$S(T)$，以及\n- 固定$\\omega$下的热容$C(T)$。\n\n您的推导应明确执行相空间积分，并展示如何利用振子间的可分离性。请用$N$、$m$、$\\omega$、$h$、$k_{B}$和$T$以闭合形式表示所有最终结果。请将您的最终答案以单行矩阵的形式列出$\\big(Z_{N}(T),\\,F(T),\\,U(T),\\,S(T),\\,C(T)\\big)$。不需要进行数值计算，也不需要四舍五入。请勿在最终的方框答案中包含单位。",
            "solution": "该问题陈述清晰且科学上合理，是经典统计力学中的一个标准练习。我们将按要求进行推导。\n\n该系统由$N$个独立的一维经典谐振子组成。系统的总哈密顿量是各个哈密顿量的总和：\n$$H(\\{q_i,p_i\\}) = \\sum_{i=1}^{N} H_i(q_i, p_i) = \\sum_{i=1}^{N}\\left[\\frac{p_i^{2}}{2m}+\\frac{1}{2}m\\omega^{2}q_i^{2}\\right]$$\n其中$m$是质量，$\\omega$是角频率，$\\{q_i, p_i\\}$是第$i$个振子的正则位置和动量坐标。系统与温度为$T$的热库处于热平衡状态，可以用正则系综来描述。逆温度为$\\beta = 1/(k_{B}T)$。\n\n**1. 正则配分函数 $Z_N(T)$**\n\n对于一个具有$N$个可分辨自由度（此处为可分辨的振子）的经典系统，其正则配分函数$Z_N$由在整个$2N$维相空间上的积分给出，并由$h^N$归一化：\n$$Z_N = \\frac{1}{h^N} \\int \\dots \\int \\exp(-\\beta H(\\{q_i, p_i\\})) \\prod_{i=1}^N dq_i dp_i$$\n由于哈密顿量是独立项的总和，$H = \\sum_{i=1}^N H_i$，Boltzmann 因子$\\exp(-\\beta H)$变成单个 Boltzmann 因子的乘积：\n$$Z_N = \\frac{1}{h^N} \\int \\dots \\int \\prod_{i=1}^N \\exp(-\\beta H_i(q_i, p_i)) \\, dq_i dp_i$$\n这个多维积分可以分离成$N$个相同的单粒子积分的乘积：\n$$Z_N = \\prod_{i=1}^N \\left[ \\frac{1}{h} \\iint \\exp\\left(-\\beta \\left[\\frac{p_i^2}{2m} + \\frac{1}{2}m\\omega^2q_i^2\\right]\\right) dq_i dp_i \\right]$$\n设$Z_1$为单个振子的配分函数。由于所有振子都是相同的，因此$Z_N = (Z_1)^N$。我们现在计算$Z_1$：\n$$Z_1 = \\frac{1}{h} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta\\frac{p^2}{2m}\\right) \\exp\\left(-\\beta\\frac{m\\omega^2q^2}{2}\\right) dp \\, dq$$\n这个积分是两个高斯积分的乘积：\n$$Z_1 = \\frac{1}{h} \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta}{2m}p^2\\right) dp \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2}{2}q^2\\right) dq \\right)$$\n使用标准高斯积分公式$\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$，我们计算每个积分：\n动量积分给出：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta}{2m}p^2\\right) dp = \\sqrt{\\frac{\\pi}{\\beta/(2m)}} = \\sqrt{\\frac{2\\pi m}{\\beta}}$$\n位置积分给出：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2}{2}q^2\\right) dq = \\sqrt{\\frac{\\pi}{(\\beta m\\omega^2)/2}} = \\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}}$$\n将这些结果相乘得到$Z_1$：\n$$Z_1 = \\frac{1}{h} \\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}} = \\frac{1}{h} \\sqrt{\\frac{4\\pi^2 m}{m\\beta^2\\omega^2}} = \\frac{2\\pi}{h\\beta\\omega}$$\n代入$\\beta = 1/(k_B T)$：\n$$Z_1 = \\frac{2\\pi k_B T}{h\\omega}$$\n因此，$N$个振子的总配分函数为：\n$$Z_N(T) = (Z_1)^N = \\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N$$\n\n**2. Helmholtz 自由能 $F(T)$**\n\nHelmholtz 自由能$F$通过基本关系$F = -k_B T \\ln Z_N$与正则配分函数相关联。\n$$F(T) = -k_B T \\ln\\left[\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N\\right]$$\n利用对数性质$\\ln(x^a) = a\\ln(x)$，我们得到：\n$$F(T) = -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)$$\n\n**3. 内能 $U(T)$**\n\n平均内能$U$可以从配分函数计算得到，$U = -\\frac{\\partial}{\\partial\\beta} \\ln Z_N$。\n首先，我们用$\\beta$表示$\\ln Z_N$：\n$$\\ln Z_N = \\ln\\left[\\left(\\frac{2\\pi}{h\\omega\\beta}\\right)^N\\right] = N \\ln\\left(\\frac{2\\pi}{h\\omega\\beta}\\right) = N(\\ln(2\\pi) - \\ln(h\\omega) - \\ln\\beta)$$\n现在，我们对$\\beta$求导：\n$$\\frac{\\partial}{\\partial\\beta} \\ln Z_N = \\frac{\\partial}{\\partial\\beta} [N(\\text{const} - \\ln\\beta)] = -N \\frac{1}{\\beta}$$\n因此，内能为：\n$$U = - \\left(-\\frac{N}{\\beta}\\right) = \\frac{N}{\\beta}$$\n代入$\\beta = 1/(k_B T)$：\n$$U(T) = N k_B T$$\n这个结果与经典能量均分定理一致，即$2N$个二次自由度（$p_i^2$和$q_i^2$）中的每一个都对总能量贡献$\\frac{1}{2}k_B T$。\n\n**4. 熵 $S(T)$**\n\n熵$S$可以从热力学关系$F = U - TS$推导得出，即$S = (U-F)/T$。\n使用我们得到的$U(T)$和$F(T)$的表达式：\n$$S(T) = \\frac{1}{T} \\left[ N k_B T - \\left(-N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right) \\right]$$\n$$S(T) = \\frac{1}{T} \\left[ N k_B T + N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right) \\right]$$\n通过提出公因子$N k_B T$来简化：\n$$S(T) = N k_B \\left[1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right]$$\n或者，我们也可以使用$S = -(\\partial F/\\partial T)_{N, \\omega}$，这会得到相同的结果。\n\n**5. 热容 $C(T)$**\n\n恒定外部参数（此处为固定的$\\omega$）下的热容定义为$C = (\\partial U / \\partial T)_{N, \\omega}$。\n使用我们关于内能$U(T) = N k_B T$的结果：\n$$C(T) = \\frac{\\partial}{\\partial T} (N k_B T)$$\n由于$N$和$k_B$是常数，导数为：\n$$C(T) = N k_B$$\n这是该系统的经典 Dulong-Petit 定律，表明热容与温度无关。\n\n**结果总结：**\n推导出的各量为：\n- $Z_{N}(T) = \\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N$\n- $F(T) = -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)$\n- $U(T) = N k_B T$\n- $S(T) = N k_B \\left[1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right]$\n- $C(T) = N k_B$\n这些将以单行矩阵的形式作为最终答案呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N  -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)  N k_B T  N k_B \\left(1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right)  N k_B\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然理想系统可以解析求解，但真实世界的粒子间存在相互作用。这项练习引入了 Lennard-Jones 势，这是一个更符合实际的原子相互作用模型，并要求您计算第二维里系数——这是对理想气体行为的首次修正。这项实践从纯粹的解析推导过渡到数值计算，这是现代物理学家和化学家研究复杂系统时的一项关键技能。",
            "id": "3764714",
            "problem": "您的任务是基于第一性原理设计并实现一个数值程序，用于计算决定具有 Lennard–Jones 对相互作用的经典气体的第二维里系数的构型贡献，并推断在指定无量纲温度下第二维里系数的符号。请从与大热源热接触的经典系统的正则系综出发，其中正则配分函数是相关的描述。使用已建立的构型积分构造及其在维里展开中的作用，得出一个适合数值积分的可计算的一维积分。\n\n该系统由在三维空间中通过球对称的 Lennard–Jones 对势相互作用的相同点粒子组成，其参数为 $\\epsilon$ 和 $\\sigma$，其中两个相距为 $r$ 的粒子间的势能为 $u(r) = 4 \\epsilon \\left[ \\left( \\dfrac{\\sigma}{r} \\right)^{12} - \\left( \\dfrac{\\sigma}{r} \\right)^{6} \\right]$。请在基于 $\\epsilon$ 和 $\\sigma$ 的约化无量纲单位下进行计算：定义约化温度 $T^\\star = \\dfrac{k_B T}{\\epsilon}$ 和约化距离 $x = \\dfrac{r}{\\sigma}$。将第二维里系数以 $\\sigma^3$ 为单位表示为无量纲数 $\\dfrac{B_2}{\\sigma^3}$。您计算的所有物理量都必须用这些约化单位表示。\n\n您的推导和程序必须遵守以下基本原理：\n- 从 $N$ 个经典粒子的正则配分函数开始，通过对动量进行积分来分离动能和构型贡献。\n- 使用构型积分的定义和性质以及压强按数密度幂次的系统性维里展开，将第二维里系数与对相互作用势的积分联系起来。\n- 专用于球对称对势，并将构型积分简化为对约化变量 $x$ 的单一径向积分，以适合数值计算。通过对 $x \\to 0$ 和 $x \\to \\infty$ 处行为的适当处理，确保该积分是绝对收敛且数值稳定的。\n\n程序规范：\n- 实现一个鲁棒的数值积分方法，用于在 $x \\in [0, \\infty)$ 上为 Lennard–Jones $12$–$6$ 势计算所需的定积分，以在给定的 $T^\\star$ 下获得 $\\dfrac{B_2}{\\sigma^3}$。\n- 根据每个 $T^\\star$ 下的计算值推断 $B_2$ 的符号；报告 $B_2$ 是正值（排斥主导行为）还是非正值（吸引主导或中性行为）。\n- 对于数值输出，将每个 $\\dfrac{B_2}{\\sigma^3}$ 值四舍五入到八位小数。\n\n物理和数值单位：\n- 您必须将第二维里系数以 $\\sigma^3$ 为单位表示，作为一个无量纲量 $\\dfrac{B_2}{\\sigma^3}$。\n- 温度以约化单位 $T^\\star = \\dfrac{k_B T}{\\epsilon}$ 指定，该单位是无量纲的。\n\n测试套件：\n为以下约化温度 $T^\\star$ 评估您的实现：\n1. $T^\\star = 0.5$（低温，吸引主导区域）。\n2. $T^\\star = 2.0$（中等温度）。\n3. $T^\\star = 3.42$（接近玻意耳温度，此时 Lennard–Jones 12-6 势的第二维里系数接近于零）。\n4. $T^\\star = 4.0$（高于玻意耳温度）。\n5. $T^\\star = 10.0$（高温，排斥主导区域）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。输出必须是包含两个列表的列表：\n    - 第一个内部列表包含五个计算出的 $\\dfrac{B_2}{\\sigma^3}$ 值，每个值四舍五入到八位小数。\n    - 第二个内部列表包含五个布尔值，指示相应测试用例中 $B_2$ 的符号，使用该语言原生的布尔字面量表示真（true）和假（false）。\n- 例如，输出格式应如下所示：“[[b2_case1,b2_case2,b2_case3,b2_case4,b2_case5],[sign1,sign2,sign3,sign4,sign5]]”，其中每个“b2_case”是浮点数，每个“sign”是布尔值。\n\n您的程序必须是自包含的，并且不得需要任何外部输入。",
            "solution": "该问题要求计算经典气体的第二维里系数 $B_2$，其粒子通过 Lennard-Jones 势相互作用。这将通过从正则配分函数出发，推导 $B_2$ 关于对相互作用势的表达式，将表达式转换为适合数值计算的无量纲单位，然后对给定的一组无量纲温度评估所得积分来完成。\n\n起点是正则配分函数 $Z_N$，用于描述一个在温度 $T$、体积 $V$ 中包含 $N$ 个相同、不可区分的经典粒子的系统。它由下式给出\n$$\nZ_N = \\frac{1}{N! h^{3N}} \\int \\cdots \\int e^{-\\beta H(\\mathbf{q}^N, \\mathbf{p}^N)} d\\mathbf{q}^N d\\mathbf{p}^N\n$$\n其中 $\\beta = (k_B T)^{-1}$，$k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数。哈密顿量 $H(\\mathbf{q}^N, \\mathbf{p}^N)$ 是动能 $K(\\mathbf{p}^N)$ 和势能 $U(\\mathbf{q}^N)$ 的和：\n$$\nH(\\mathbf{q}^N, \\mathbf{p}^N) = \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m} + U(\\mathbf{q}^N)\n$$\n对动量的积分可以独立于位置进行，得到：\n$$\n\\int e^{-\\beta K(\\mathbf{p}^N)} d\\mathbf{p}^N = \\left( \\int e^{-\\beta(p_x^2+p_y^2+p_z^2)/(2m)} dp_x dp_y dp_z \\right)^N = \\left( \\frac{2\\pi m}{\\beta} \\right)^{3N/2}\n$$\n这使得配分函数可以写成：\n$$\nZ_N = \\frac{1}{N! \\Lambda^{3N}} Q_N\n$$\n其中 $\\Lambda = h / \\sqrt{2\\pi m k_B T}$ 是热德布罗意波长，$Q_N$ 是构型积分：\n$$\nQ_N = \\int_V \\cdots \\int_V e^{-\\beta U(\\mathbf{q}^N)} d\\mathbf{q}^1 \\cdots d\\mathbf{q}^N\n$$\n对于具有对可加相互作用的系统，势能为 $U(\\mathbf{q}^N) = \\sum_{1 \\le i  j \\le N} u(r_{ij})$，其中 $u(r_{ij})$ 是粒子 $i$ 和 $j$ 之间的势，它们相距 $r_{ij} = |\\mathbf{q}_i - \\mathbf{q}_j|$。\n\n物态方程可以通过维里展开来表示，该展开将压强 $P$ 与数密度 $\\rho = N/V$ 的幂级数联系起来：\n$$\n\\frac{P}{\\rho k_B T} = 1 + B_2(T) \\rho + B_3(T) \\rho^2 + \\mathcal{O}(\\rho^3)\n$$\n第二维里系数 $B_2(T)$ 解释了由于对相互作用引起的对理想气体行为的一阶偏差。统计力学提供了 $B_2(T)$ 和对势 $u(r)$ 之间的直接联系：\n$$\nB_2(T) = -\\frac{1}{2} \\int (e^{-\\beta u(\\mathbf{r})} - 1) d\\mathbf{r}\n$$\n$e^{-\\beta u(\\mathbf{r})} - 1$ 这一项被称为 Mayer f-函数。对于球对称势 $u(\\mathbf{r}) = u(r)$，我们可以用球坐标将体积元 $d\\mathbf{r}$ 表示为 $4\\pi r^2 dr$。积分变为一维的：\n$$\nB_2(T) = -2\\pi \\int_0^\\infty (e^{-\\beta u(r)} - 1) r^2 dr\n$$\nLennard-Jones 12-6 势由下式给出：\n$$\nu(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]\n$$\n其中 $\\epsilon$ 是势阱深度，$\\sigma$ 是粒子间势能为零时的有限距离。为方便计算，我们变换到无量纲变量。令 $x = r/\\sigma$ 为约化距离，$T^\\star = k_B T / \\epsilon$ 为约化温度。指数项 $\\beta u(r)$ 变为：\n$$\n\\beta u(r) = \\frac{1}{k_B T} u(r) = \\frac{\\epsilon}{k_B T} \\frac{u(r)}{\\epsilon} = \\frac{1}{T^\\star} \\cdot 4 \\left[ \\left( \\frac{1}{x} \\right)^{12} - \\left( \\frac{1}{x} \\right)^{6} \\right] = \\frac{4}{T^\\star} (x^{-12} - x^{-6})\n$$\n将 $r = x\\sigma$ 和 $dr = \\sigma dx$ 代入 $B_2(T)$ 的积分中，我们得到：\n$$\nB_2(T) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right) (x\\sigma)^2 (\\sigma dx)\n$$\n$$\nB_2(T) = -2\\pi \\sigma^3 \\int_0^\\infty \\left( \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right) x^2 dx\n$$\n问题要求以 $\\sigma^3$ 为单位的第二维里系数，即无量纲量 $B_2^\\star = B_2(T)/\\sigma^3$：\n$$\nB_2^\\star(T^\\star) = -2\\pi \\int_0^\\infty \\left\\{ \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right\\} x^2 dx\n$$\n这是需要进行数值计算的最终表达式。该定积分是反常的，积分区间为 $[0, \\infty)$。被积函数在两个极限处都是良态的。当 $x \\to 0$ 时，$u(x) \\to \\infty$，因此 $\\exp[-\\beta u(x)] \\to 0$，被积函数表现为 $-x^2$，这是可积的。当 $x \\to \\infty$ 时，$u(x) \\to 0$，因此 $\\exp[-\\beta u(x)] - 1 \\approx -\\beta u(x) \\propto x^{-6}$。被积函数随之表现为 $x^{-6} \\cdot x^2 = x^{-4}$，这确保了积分在无穷远处的收敛性。一个为反常积分设计的数值积分程序可以鲁棒地计算其值。$B_2^\\star$ 的符号然后从结果中确定。正值表示排斥占主导，而非正值表示吸引占主导，或者在玻意耳温度下，表示两种效应之间的平衡。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless second virial coefficient for a Lennard-Jones gas\n    at specified reduced temperatures.\n    \"\"\"\n    \n    # Define the test cases for reduced temperature T* = k_B * T / epsilon.\n    test_cases = [0.5, 2.0, 3.42, 4.0, 10.0]\n\n    b2_results = []\n    sign_results = []\n\n    def integrand(x, t_star):\n        \"\"\"\n        Calculates the integrand for the B2* integral.\n        The integrand is (exp[-u*(x)/t_star] - 1) * x^2,\n        where u*(x) = 4 * (x**-12 - x**-6) is the reduced LJ potential.\n        \n        Args:\n            x (float): The reduced distance r/sigma.\n            t_star (float): The reduced temperature k_B*T/epsilon.\n\n        Returns:\n            float: The value of the integrand.\n        \"\"\"\n        # The limit of the integrand as x - 0 is 0.\n        # Guard against ZeroDivisionError for x=0.\n        if x == 0.0:\n            return 0.0\n\n        # Calculate the reduced potential energy term in the exponent.\n        # This term can be large for small x, but exp(-large_positive) is 0.\n        potential_term = 4.0 * (x**-12 - x**-6)\n        beta_u = potential_term / t_star\n        \n        # The minimum of the potential is at x = 2^(1/6), where u* = -1.\n        # The maximum value of -beta_u is 4/t_star. For the given test cases,\n        # max value is 4/0.5 = 8. np.exp(8) is well within float64 range.\n        # No overflow is expected.\n        return (np.exp(-beta_u) - 1.0) * x**2\n\n    for t_star_val in test_cases:\n        # Perform numerical quadrature of the integrand from 0 to infinity.\n        # The `args` tuple passes the reduced temperature to the integrand.\n        integral_val, _ = integrate.quad(integrand, 0, np.inf, args=(t_star_val,))\n\n        # Calculate the reduced second virial coefficient B2* = B2 / sigma^3.\n        # B2* = -2 * pi * integral\n        b2_star = -2.0 * np.pi * integral_val\n        \n        # Round the result to eight decimal places as required.\n        b2_rounded = round(b2_star, 8)\n        \n        # Infer the sign: True for positive, False for non-positive.\n        is_positive = b2_rounded  0.0\n        \n        b2_results.append(b2_rounded)\n        sign_results.append(is_positive)\n\n    # Format the final output string precisely as specified:\n    # \"[[b2_case1,...,b2_case5],[sign1,...,sign5]]\"\n    # where booleans are lowercase 'true' or 'false'.\n    b2_str_list = [f\"{val:.8f}\" for val in b2_results]\n    sign_str_list = [str(val).lower() for val in sign_results]\n    \n    final_output = f\"[[{','.join(b2_str_list)}],[{','.join(sign_str_list)}]]\"\n    \n    # The final print statement must produce only the required output string.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "为了深化对熵本身的理解，我们将视角从正则系综转向更基础的微正则系综。这个思想实验利用理想气体来探索玻尔兹曼熵公式 $S = k_B \\ln \\Omega$ 的核心。通过计算施加约束时可及微观态数目 $\\Omega$ 的变化，您将对熵如何量化构型自由度以及不可区分性的作用获得直接而具体的洞察。",
            "id": "3764680",
            "problem": "考虑一个孤立的经典理想气体，由$N$个质量为$m$的全同点状粒子组成，被限制在体积为$V$的刚性容器内，总能量固定为$E$。该气体处于平衡状态，其条件与经典统计力学中的微正则系综描述一致。一个完全绝热、不可渗透的活塞被准静态地插入到中平面，将容器分成两个大小为$V/2$的相等子体积，并约束恰好$N/2$的粒子位于左子体积，另外$N/2$的粒子位于右子体积。在正确考虑了粒子不可区分性的常规经典计数下，引入活塞施加了一个组态约束，但并未改变与能量$E$相关的可及动量空间壳层。\n\n从微正则系综中可及相空间微观态数目的定义和一致的经典不可区分性计数出发，推导无约束情况（无活塞）与受约束情况（活塞就位且两边粒子数相等）之间的熵变，定义为 $\\Delta S \\equiv S_{\\mathrm{unconstrained}} - S_{\\mathrm{constrained}}$。将您的最终结果表示为无量纲系数 $\\Delta s$ 的单个闭式解析表达式，该系数由 $\\Delta S = k_{B}\\,\\Delta s$ 定义，其中 $k_{B}$ 是玻尔兹曼常数。表达式应以 $N$ 为变量（假设 $N$ 为偶数）。不需要进行数值计算或四舍五入。只需报告 $\\Delta s$ 的解析表达式。",
            "solution": "问题要求推导当活塞插入，将经典理想气体容器的每一半中的粒子数固定时，熵的变化 $\\Delta S \\equiv S_{\\mathrm{unconstrained}} - S_{\\mathrm{constrained}}$。熵由玻尔兹曼公式给出，$S = k_B \\ln \\Omega$，其中 $k_B$ 是玻尔兹曼常数，$\\Omega$ 是相空间中可及的微观态数目。\n\n对于一个由 $N$ 个全同粒子组成的经典系统，微观态的数目通过对可及相空间进行积分，并除以一个因子来计算。该因子用于解释粒子的不可区分性，并使体积无量纲化。\n$$\n\\Omega(E, V, N) = \\frac{1}{N! h^{3N}} \\int_{\\text{allowed}} d^{3N}q \\, d^{3N}p\n$$\n其中 $h$ 是一个具有作用量量纲（动量 $\\times$ 位置）的常数，$\\mathbf{q}$ 代表 $3N$ 个位置坐标，$\\mathbf{p}$ 代表 $3N$ 个动量坐标。积分是在与宏观约束（例如，总能量 $E$，体积 $V$）一致的相空间区域上进行的。\n\n相空间积分可以分离为组态（位置）空间上的积分和动量空间上的积分。\n$$\n\\Omega = \\frac{1}{N! h^{3N}} \\left( \\int d^{3N}q \\right) \\left( \\int d^{3N}p \\right)\n$$\n问题陈述，引入活塞“并未改变与能量$E$相关的可及动量空间壳层”。这意味着动量空间积分（其值取决于 $N$、$m$ 和 $E$）在无约束和受约束两种情况下是相同的。我们将这个积分的值表示为 $\\mathcal{V}_p(E, N)$。\n$$\n\\mathcal{V}_p(E, N) = \\int_{\\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2m} = E} d^{3N}p\n$$\n因此，微观态的数目可以表示为：\n$$\n\\Omega = \\frac{\\mathcal{V}_p(E, N)}{N! h^{3N}} \\int d^{3N}q\n$$\n因此，熵的变化将仅取决于组态空间可及体积的变化。\n\n**1. 无约束情况**\n在初始状态下，$N$ 个粒子可以在整个体积 $V$ 内自由移动。组态积分是：\n$$\n\\int d^{3N}q = \\left( \\int_V d^3q_1 \\right) \\left( \\int_V d^3q_2 \\right) \\dots \\left( \\int_V d^3q_N \\right) = V^N\n$$\n无约束系统的微观态数目为：\n$$\n\\Omega_{\\mathrm{unconstrained}} = \\frac{V^N \\mathcal{V}_p(E, N)}{N! h^{3N}}\n$$\n相应的熵为 $S_{\\mathrm{unconstrained}} = k_B \\ln(\\Omega_{\\mathrm{unconstrained}})$。\n\n**2. 受约束情况**\n在活塞被插入到中平面后，系统受到约束，使得左子体积 $V_L = V/2$ 中恰好有 $N/2$ 个粒子，右子体积 $V_R = V/2$ 中也恰好有 $N/2$ 个粒子。我们必须计算这个受约束区域在 $3N$ 维组态空间中的体积。\n\n由于粒子是全同的，我们无法区分哪些特定的粒子在哪个子体积中。我们必须考虑将 $N$ 个粒子分成两组，每组 $N/2$ 个粒子的所有可能方式。选择哪 $N/2$ 个粒子占据左子体积的方式数由二项式系数 $\\binom{N}{N/2}$ 给出。\n对于任何一种这样的选择，所选的 $N/2$ 个粒子被限制在 $V_L$ 内，而其余的 $N/2$ 个粒子被限制在 $V_R$ 内。对于此特定划分的组态空间体积为：\n$$\n\\left( \\int_{V_L} d^{3(N/2)}q \\right) \\left( \\int_{V_R} d^{3(N/2)}q \\right) = (V/2)^{N/2} (V/2)^{N/2} = (V/2)^N\n$$\n总的可及组态空间体积是所有这些划分的总和。由于存在 $\\binom{N}{N/2}$ 种不同（对于有标签的粒子）但等效的划分，总的组态空间积分为：\n$$\n\\int_{\\text{constrained}} d^{3N}q = \\binom{N}{N/2} \\left(\\frac{V}{2}\\right)^N\n$$\n因此，受约束系统的微观态数目为：\n$$\n\\Omega_{\\mathrm{constrained}} = \\frac{1}{N! h^{3N}} \\left[ \\binom{N}{N/2} \\left(\\frac{V}{2}\\right)^N \\right] \\mathcal{V}_p(E, N)\n$$\n相应的熵为 $S_{\\mathrm{constrained}} = k_B \\ln(\\Omega_{\\mathrm{constrained}})$。\n\n**3. 熵变**\n熵变定义为 $\\Delta S = S_{\\mathrm{unconstrained}} - S_{\\mathrm{constrained}}$。使用对数性质，这变成：\n$$\n\\Delta S = k_B \\ln(\\Omega_{\\mathrm{unconstrained}}) - k_B \\ln(\\Omega_{\\mathrm{constrained}}) = k_B \\ln\\left( \\frac{\\Omega_{\\mathrm{unconstrained}}}{\\Omega_{\\mathrm{constrained}}} \\right)\n$$\n我们计算微观态数目的比值：\n$$\n\\frac{\\Omega_{\\mathrm{unconstrained}}}{\\Omega_{\\mathrm{constrained}}} = \\frac{\\frac{V^N \\mathcal{V}_p(E, N)}{N! h^{3N}}}{\\frac{1}{N! h^{3N}} \\left[ \\binom{N}{N/2} \\left(\\frac{V}{2}\\right)^N \\right] \\mathcal{V}_p(E, N)}\n$$\n公共因子 $\\frac{\\mathcal{V}_p(E, N)}{N! h^{3N}}$ 被约掉，只剩下组态体积的比值：\n$$\n\\frac{\\Omega_{\\mathrm{unconstrained}}}{\\Omega_{\\mathrm{constrained}}} = \\frac{V^N}{\\binom{N}{N/2} (V/2)^N} = \\frac{V^N}{\\binom{N}{N/2} \\frac{V^N}{2^N}} = \\frac{2^N}{\\binom{N}{N/2}}\n$$\n将此比值代回到 $\\Delta S$ 的表达式中：\n$$\n\\Delta S = k_B \\ln\\left( \\frac{2^N}{\\binom{N}{N/2}} \\right)\n$$\n问题要求无量纲系数 $\\Delta s$，其定义为 $\\Delta S = k_B \\Delta s$。因此：\n$$\n\\Delta s = \\ln\\left( \\frac{2^N}{\\binom{N}{N/2}} \\right)\n$$\n这也可以通过展开对数和二项式系数来写成：\n$$\n\\Delta s = \\ln(2^N) - \\ln\\left( \\binom{N}{N/2} \\right) = N\\ln(2) - \\ln\\left( \\frac{N!}{\\left(\\left(\\frac{N}{2}\\right)!\\right)^2} \\right)\n$$\n第一种形式更紧凑。由于 $\\sum_{k=0}^{N} \\binom{N}{k} = 2^N$ 并且对于偶数 $N$，$\\binom{N}{N/2}$ 是此和中的单个（最大）项，因此可以得出 $2^N  \\binom{N}{N/2}$。因此，对数的参数大于 $1$，且 $\\Delta s  0$。这在物理上是一致的，因为对系统增加一个约束会减少其可及的微观态数目，从而降低其熵 ($S_{\\mathrm{unconstrained}}  S_{\\mathrm{constrained}}$)。\n该表达式是根据要求以 $N$ 表示的闭式解析结果。",
            "answer": "$$\n\\boxed{\\ln\\left(\\frac{2^N}{\\binom{N}{\\frac{N}{2}}}\\right)}\n$$"
        }
    ]
}