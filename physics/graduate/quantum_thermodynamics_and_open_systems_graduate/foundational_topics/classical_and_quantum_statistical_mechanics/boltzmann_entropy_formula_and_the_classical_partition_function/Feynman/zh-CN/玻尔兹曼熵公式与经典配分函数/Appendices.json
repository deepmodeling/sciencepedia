{
    "hands_on_practices": [
        {
            "introduction": "本练习将作为一个基础实践。我们将把经典配分函数应用于一组独立的谐振子系统，这是物理学中的一个基石模型 ()。通过具体执行相空间积分，您将亲眼看到这个强大的工具如何将微观哈密顿量与宏观的热力学性质（如内能、熵和热容）直接联系起来。",
            "id": "3764716",
            "problem": "考虑一个开放的经典系统，由$N$个独立的、一维的谐振子组成，它们的质量均为$m$，角频率均为$\\omega$。每个谐振子都与一个绝对温度为$T$的大热库弱耦合，使得系统处于正则平衡态。该系统的哈密顿量为\n$$\nH(\\{q_i,p_i\\})=\\sum_{i=1}^{N}\\left[\\frac{p_i^{2}}{2m}+\\frac{1}{2}m\\omega^{2}q_i^{2}\\right],\n$$\n其中$\\{q_i\\}$和$\\{p_i\\}$分别为正则坐标和正则动量。请使用正则系综，逆温度为$\\beta=1/(k_{B}T)$，其中$k_{B}$是玻尔兹曼常数($k_B$)。为使配分函数无量纲化，采用经典刘维相空间测度，并对每个一维自由度对应的相空间体积元由普朗克常数($h$)进行粗粒化。从第一性原理出发——即正则概率密度$\\rho(\\{q_i,p_i\\})\\propto\\exp(-\\beta H)$以及经典正则配分函数的定义（作为适当归一化的相空间积分）——推导：\n- $N$个独立振子的总正则配分函数$Z_{N}(T)$，\n- 亥姆霍兹自由能$F(T)$，\n- 内能$U(T)$，\n- 通过玻尔兹曼平衡框架得到的熵$S(T)$（等效于正则态下的吉布斯熵），以及\n- 固定$\\omega$下的热容$C(T)$。\n\n你的推导过程应明确执行相空间积分，并展示振子间的可分离性是如何被利用的。将所有最终结果以$N$、$m$、$\\omega$、$h$、$k_{B}$和$T$的闭合形式表示。请将你的最终答案以一个单行矩阵$\\big(Z_{N}(T),\\,F(T),\\,U(T),\\,S(T),\\,C(T)\\big)$的形式列出。不需要进行数值计算，也不需要四舍五入。最终的方框答案中不要包含单位。",
            "solution": "该问题提法明确且科学上合理，是经典统计力学中的一个标准练习。我们将按要求进行推导。\n\n该系统由$N$个独立的、一维的经典谐振子组成。系统的总哈密顿量是单个哈密顿量之和：\n$$H(\\{q_i,p_i\\}) = \\sum_{i=1}^{N} H_i(q_i, p_i) = \\sum_{i=1}^{N}\\left[\\frac{p_i^{2}}{2m}+\\frac{1}{2}m\\omega^{2}q_i^{2}\\right]$$\n其中，$m$是质量，$\\omega$是角频率，$\\{q_i, p_i\\}$是第$i$个振子的正则位置和动量坐标。系统与温度为$T$的热库处于热平衡状态，由正则系综描述。逆温度为$\\beta = 1/(k_{B}T)$。\n\n**1. 正则配分函数 $Z_N(T)$**\n\n对于一个由$N$个可分辨自由度（这里是可分辨的振子）组成的经典系统，其正则配分函数$Z_N$由对整个$2N$维相空间的积分给出，并由$h^N$归一化：\n$$Z_N = \\frac{1}{h^N} \\int \\dots \\int \\exp(-\\beta H(\\{q_i, p_i\\})) \\prod_{i=1}^N dq_i dp_i$$\n由于哈密顿量是独立项之和，$H = \\sum_{i=1}^N H_i$，玻尔兹曼因子$\\exp(-\\beta H)$变为单个玻尔兹曼因子的乘积：\n$$Z_N = \\frac{1}{h^N} \\int \\dots \\int \\prod_{i=1}^N \\exp(-\\beta H_i(q_i, p_i)) \\, dq_i dp_i$$\n该多维积分可以分离为$N$个相同的单粒子积分的乘积：\n$$Z_N = \\prod_{i=1}^N \\left[ \\frac{1}{h} \\iint \\exp\\left(-\\beta \\left[\\frac{p_i^2}{2m} + \\frac{1}{2}m\\omega^2q_i^2\\right]\\right) dq_i dp_i \\right]$$\n设$Z_1$为单个振子的配分函数。由于所有振子都相同，所以$Z_N = (Z_1)^N$。我们现在计算$Z_1$：\n$$Z_1 = \\frac{1}{h} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta\\frac{p^2}{2m}\\right) \\exp\\left(-\\beta\\frac{m\\omega^2q^2}{2}\\right) dp \\, dq$$\n该积分是两个高斯积分的乘积：\n$$Z_1 = \\frac{1}{h} \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta}{2m}p^2\\right) dp \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2}{2}q^2\\right) dq \\right)$$\n使用标准高斯积分公式$\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$，我们计算每个积分：\n动量积分给出：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta}{2m}p^2\\right) dp = \\sqrt{\\frac{\\pi}{\\beta/(2m)}} = \\sqrt{\\frac{2\\pi m}{\\beta}}$$\n位置积分给出：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2}{2}q^2\\right) dq = \\sqrt{\\frac{\\pi}{(\\beta m\\omega^2)/2}} = \\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}}$$\n将这些结果相乘得到$Z_1$：\n$$Z_1 = \\frac{1}{h} \\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}} = \\frac{1}{h} \\sqrt{\\frac{4\\pi^2 m}{m\\beta^2\\omega^2}} = \\frac{2\\pi}{h\\beta\\omega}$$\n代入$\\beta = 1/(k_B T)$：\n$$Z_1 = \\frac{2\\pi k_B T}{h\\omega}$$\n因此，$N$个振子的总配分函数为：\n$$Z_N(T) = (Z_1)^N = \\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N$$\n\n**2. 亥姆霍兹自由能 $F(T)$**\n\n亥姆霍兹自由能$F$通过基本关系式$F = -k_B T \\ln Z_N$与正则配分函数相关联。\n$$F(T) = -k_B T \\ln\\left[\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N\\right]$$\n利用对数性质$\\ln(x^a) = a\\ln(x)$，我们得到：\n$$F(T) = -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)$$\n\n**3. 内能 $U(T)$**\n\n平均内能$U$可以从配分函数计算得出，$U = -\\frac{\\partial}{\\partial\\beta} \\ln Z_N$。\n首先，我们用$\\beta$表示$\\ln Z_N$：\n$$\\ln Z_N = \\ln\\left[\\left(\\frac{2\\pi}{h\\omega\\beta}\\right)^N\\right] = N \\ln\\left(\\frac{2\\pi}{h\\omega\\beta}\\right) = N(\\ln(2\\pi) - \\ln(h\\omega) - \\ln\\beta)$$\n现在，我们对$\\beta$求导：\n$$\\frac{\\partial}{\\partial\\beta} \\ln Z_N = \\frac{\\partial}{\\partial\\beta} [N(\\text{const} - \\ln\\beta)] = -N \\frac{1}{\\beta}$$\n因此，内能为：\n$$U = - \\left(-\\frac{N}{\\beta}\\right) = \\frac{N}{\\beta}$$\n代入$\\beta = 1/(k_B T)$：\n$$U(T) = N k_B T$$\n此结果与经典能量均分定理一致，其中$2N$个二次自由度（$p_i^2$和$q_i^2$）中的每一个都对总能量贡献$\\frac{1}{2}k_B T$。\n\n**4. 熵 $S(T)$**\n\n熵$S$可以从热力学关系$F = U - TS$推导得出，即$S = (U-F)/T$。\n使用我们得到的$U(T)$和$F(T)$的表达式：\n$$S(T) = \\frac{1}{T} \\left[ N k_B T - \\left(-N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right) \\right]$$\n$$S(T) = \\frac{1}{T} \\left[ N k_B T + N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right) \\right]$$\n通过提出因子$N k_B T$来简化：\n$$S(T) = N k_B \\left[1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right]$$\n或者，我们也可以使用$S = -(\\partial F/\\partial T)_{N, \\omega}$，这会得到相同的结果。\n\n**5. 热容 $C(T)$**\n\n恒定外部参数（这里是固定的$\\omega$）下的热容定义为$C = (\\partial U / \\partial T)_{N, \\omega}$。\n使用我们关于内能的结果$U(T) = N k_B T$：\n$$C(T) = \\frac{\\partial}{\\partial T} (N k_B T)$$\n由于$N$和$k_B$是常数，其导数为：\n$$C(T) = N k_B$$\n这是该系统的经典杜隆-珀蒂定律，表明热容与温度无关。\n\n**结果总结：**\n推导出的各物理量为：\n- $Z_{N}(T) = \\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N$\n- $F(T) = -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)$\n- $U(T) = N k_B T$\n- $S(T) = N k_B \\left[1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right]$\n- $C(T) = N k_B$\n这些结果将以单行矩阵的形式作为最终答案呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)^N  -N k_B T \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)  N k_B T  N k_B \\left(1 + \\ln\\left(\\frac{2\\pi k_B T}{h\\omega}\\right)\\right)  N k_B\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "经典配分函数本质上是其量子对应物的近似。本练习 () 将通过比较箱中粒子的量子配分函数（对能级的离散求和）与经典配分函数（对相空间的连续积分），来明确地建立这种联系。您将推导出经典描述成立的条件，并量化主要的量子修正项，从而加深对经典极限的理解。",
            "id": "3764710",
            "problem": "一个质量为 $m$ 的单个非相对论性粒子被限制在一个边长为 $L$、具有不可穿透壁（狄利克雷边界条件）的三维立方体盒子中。该粒子与一个绝对温度为 $T$ 的大热库弱耦合，这使得使用正则系综是合理的。令 $\\beta = 1/(k_{B} T)$，其中 $k_{B}$ 是玻尔兹曼常数，令 $h$ 表示普朗克常数，$\\hbar = h/(2\\pi)$ 表示约化普朗克常数。热德布罗意波长定义为 $\\lambda_{T} = h / \\sqrt{2\\pi m k_{B} T}$。\n\n从量子和经典系统的平衡统计力学的第一性原理出发，并且不使用任何快捷公式，完成以下任务：\n\n1. 将该粒子的精确量子正则配分函数 $Z_{\\mathrm{q}}$ 表述为对立方体盒子中所有单粒子能量本征态的求和。\n2. 使用具有适当元胞体积的相空间积分，为同一粒子表述经典正则配分函数 $Z_{\\mathrm{cl}}$。\n3. 在盒子远大于热波长的极限下，当许多量子能级位于热可及范围内时，使用一种合理的渐近方法，推导 $Z_{\\mathrm{q}}$ 和 $Z_{\\mathrm{cl}}$ 之间的领头阶关系。将你的最终结果表示为比率 $Z_{\\mathrm{q}}/Z_{\\mathrm{cl}}$ 的一个闭合形式解析表达式，该表达式包含首个非平庸修正项，且仅用 $L$ 和 $\\lambda_{T}$ 表示。\n\n你的最终答案必须是第3部分所要求的 $Z_{\\mathrm{q}}/Z_{\\mathrm{cl}}$ 的单一表达式。不需要进行数值计算。",
            "solution": "问题陈述已经过验证，被认为是统计力学中一个适定且科学上合理的问题。我们从第一性原理出发，进行详细求解。\n\n按要求，分析分为三个部分：量子配分函数（$Z_{\\mathrm{q}}$）的表述、经典配分函数（$Z_{\\mathrm{cl}}$）的表述，以及它们之间渐近关系的推导。\n\n**第1部分：量子正则配分函数 ($Z_{\\mathrm{q}}$)**\n\n对于一个质量为 $m$ 的单个非相对论性粒子，在边长为 $L$ 且具有不可穿透壁的三维立方体盒子中，带有狄利克雷边界条件（壁上 $\\psi=0$）的不含时薛定谔方程会得到量子化的能量本征态。能量本征值由下式给出：\n$$\nE_{n_x, n_y, n_z} = \\frac{\\hbar^2}{2m} \\left( \\frac{\\pi^2 n_x^2}{L^2} + \\frac{\\pi^2 n_y^2}{L^2} + \\frac{\\pi^2 n_z^2}{L^2} \\right) = \\frac{\\pi^2 \\hbar^2}{2mL^2} (n_x^2 + n_y^2 + n_z^2)\n$$\n其中 $n_x$、$n_y$ 和 $n_z$ 是正整数，即 $n_i \\in \\{1, 2, 3, \\dots\\}$。\n\n该系统与温度为 $T$ 的热库处于热平衡状态，因此我们使用正则系综。量子正则配分函数 $Z_{\\mathrm{q}}$ 是对所有可能的单粒子量子态的玻尔兹曼因子求和：\n$$\nZ_{\\mathrm{q}} = \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\exp(-\\beta E_{n_x, n_y, n_z})\n$$\n其中 $\\beta = 1/(k_B T)$。代入能量本征值：\n$$\nZ_{\\mathrm{q}} = \\sum_{n_x=1}^{\\infty} \\sum_{n_y=1}^{\\infty} \\sum_{n_z=1}^{\\infty} \\exp\\left( -\\frac{\\beta \\pi^2 \\hbar^2}{2mL^2} (n_x^2 + n_y^2 + n_z^2) \\right)\n$$\n由于和的指数是指数的乘积，这个三重求和可以分解为三个相同且独立的求和的乘积，每个求和对应一个空间维度：\n$$\nZ_{\\mathrm{q}} = \\left[ \\sum_{n=1}^{\\infty} \\exp\\left( -\\frac{\\beta \\pi^2 \\hbar^2}{2mL^2} n^2 \\right) \\right]^3\n$$\n此表达式是该系统量子配分函数的精确表述。\n\n**第2部分：经典正则配分函数 ($Z_{\\mathrm{cl}}$)**\n\n在经典统计力学中，单个粒子的配分函数由对所有可及相空间的积分除以单个元胞的体积 $h^3$ 给出。自由粒子的哈密顿量纯粹是动能：$H(\\mathbf{r}, \\mathbf{p}) = |\\mathbf{p}|^2 / (2m)$。\n$$\nZ_{\\mathrm{cl}} = \\frac{1}{h^3} \\int d^3\\mathbf{r} \\int d^3\\mathbf{p} \\, \\exp(-\\beta H(\\mathbf{r}, \\mathbf{p}))\n$$\n对空间坐标 $\\mathbf{r}$ 的积分被限制在盒子的体积内，即 $V = L^3$：\n$$\n\\int d^3\\mathbf{r} = L^3\n$$\n对动量坐标 $\\mathbf{p}$ 的积分是遍及从 $-\\infty$ 到 $\\infty$ 的所有可能动量。这个积分也可以分解：\n$$\n\\int d^3\\mathbf{p} \\, \\exp\\left(-\\frac{\\beta}{2m}(p_x^2 + p_y^2 + p_z^2)\\right) = \\left[ \\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\right]^3\n$$\n内部的积分是标准的高斯积分，$\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$。当 $a = \\beta/(2m)$ 时，我们有：\n$$\n\\int_{-\\infty}^{\\infty} dp \\, \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) = \\sqrt{\\frac{2m\\pi}{\\beta}} = \\sqrt{2\\pi m k_B T}\n$$\n结合这些结果，经典配分函数为：\n$$\nZ_{\\mathrm{cl}} = \\frac{L^3}{h^3} \\left( \\sqrt{2\\pi m k_B T} \\right)^3 = \\frac{L^3}{h^3} (2\\pi m k_B T)^{3/2}\n$$\n使用给定的热德布罗意波长定义 $\\lambda_T = h / \\sqrt{2\\pi m k_B T}$，我们可以将 $Z_{\\mathrm{cl}}$ 表示为：\n$$\nZ_{\\mathrm{cl}} = L^3 \\left( \\frac{\\sqrt{2\\pi m k_B T}}{h} \\right)^3 = L^3 \\left( \\frac{1}{\\lambda_T} \\right)^3 = \\left(\\frac{L}{\\lambda_T}\\right)^3\n$$\n\n**第3部分：$Z_{\\mathrm{q}}$ 与 $Z_{\\mathrm{cl}}$ 之间的渐近关系**\n\n我们希望在盒子尺寸 $L$ 远大于热波长 $\\lambda_T$ 的极限下，找出 $Z_{\\mathrm{q}}$ 和 $Z_{\\mathrm{cl}}$ 之间的关系。这对应于预期会出现经典行为的高温或大体积极限。\n\n让我们分析第1部分中的一维量子求和：\n$$\nS = \\sum_{n=1}^{\\infty} \\exp(-\\alpha n^2), \\quad \\text{其中} \\quad \\alpha = \\frac{\\beta \\pi^2 \\hbar^2}{2mL^2}\n$$\n因此 $Z_{\\mathrm{q}} = S^3$。我们用 $L$ 和 $\\lambda_T$ 来表示 $\\alpha$。使用 $\\hbar = h/(2\\pi)$ 和 $\\beta=1/(k_B T)$：\n$$\n\\alpha = \\frac{1}{k_B T} \\frac{\\pi^2}{2mL^2} \\left(\\frac{h}{2\\pi}\\right)^2 = \\frac{h^2}{8mL^2 k_B T} = \\frac{\\pi}{4} \\frac{2\\pi m k_B T}{h^2} \\frac{h^2}{(2\\pi m k_B T) L^2} = \\frac{\\pi}{4} \\frac{h^2}{2\\pi m k_B T} \\frac{1}{L^2} = \\frac{\\pi}{4}\\left(\\frac{\\lambda_T}{L}\\right)^2\n$$\n极限 $L \\gg \\lambda_T$ 意味着 $\\alpha$ 是一个非常小的正参数，$\\alpha \\ll 1$。在此极限下，求和 $S$ 可以被近似。一个有效的方法是 Poisson 求和公式，该公式对于函数 $f(x)$ 表述为 $\\sum_{n=-\\infty}^{\\infty} f(n) = \\sum_{k=-\\infty}^{\\infty} \\hat{f}(k)$，其中 $\\hat{f}(k)$ 是 $f(x)$ 的傅里叶变换。\n\n令 $f(x) = \\exp(-\\alpha x^2)$。我们需要的求和与 $\\sum_{n=-\\infty}^{\\infty} f(n) = f(0) + 2 \\sum_{n=1}^{\\infty} f(n) = 1 + 2S$ 相关。其傅里叶变换为：\n$$\n\\hat{f}(k) = \\int_{-\\infty}^{\\infty} e^{-\\alpha x^2} e^{-2\\pi i k x} dx = \\sqrt{\\frac{\\pi}{\\alpha}} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right)\n$$\n应用 Poisson 求和公式：\n$$\n1 + 2S = \\sum_{k=-\\infty}^{\\infty} \\sqrt{\\frac{\\pi}{\\alpha}} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right) = \\sqrt{\\frac{\\pi}{\\alpha}} \\left(1 + 2\\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right) \\right)\n$$\n求解 $S$：\n$$\nS = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} - \\frac{1}{2} + \\sqrt{\\frac{\\pi}{\\alpha}} \\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{\\pi^2 k^2}{\\alpha}\\right)\n$$\n在 $\\alpha \\to 0$ 的极限下，求和中指数的参数 $-\\pi^2/\\alpha$ 变得非常大且为负。该求和由 $k=1$ 项主导，其量级为 $\\exp(-\\pi^2/\\alpha)$，这是指数级小的，对于以 $\\sqrt{\\alpha} \\sim \\lambda_T/L$ 的幂次进行的渐近展开可以忽略不计。因此，$S$ 的渐近近似为：\n$$\nS \\approx \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} - \\frac{1}{2}\n$$\n现在我们代入 $\\alpha$ 的表达式：\n$$\n\\sqrt{\\frac{\\pi}{\\alpha}} = \\sqrt{\\pi \\cdot \\frac{4L^2}{\\pi\\lambda_T^2}} = \\frac{2L}{\\lambda_T}\n$$\n这给出了一维求和的近似：\n$$\nS \\approx \\frac{1}{2}\\left(\\frac{2L}{\\lambda_T}\\right) - \\frac{1}{2} = \\frac{L}{\\lambda_T} - \\frac{1}{2}\n$$\n三维量子配分函数为 $Z_{\\mathrm{q}} = S^3$：\n$$\nZ_{\\mathrm{q}} \\approx \\left(\\frac{L}{\\lambda_T} - \\frac{1}{2}\\right)^3\n$$\n我们展开此表达式，并保留到小参数 $\\lambda_T/L$ 的一阶修正项：\n$$\nZ_{\\mathrm{q}} \\approx \\left(\\frac{L}{\\lambda_T}\\right)^3 - 3\\left(\\frac{L}{\\lambda_T}\\right)^2\\left(\\frac{1}{2}\\right) + 3\\left(\\frac{L}{\\lambda_T}\\right)\\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)^3\n$$\n领头项是 $(L/\\lambda_T)^3$，这正是 $Z_{\\mathrm{cl}}$。首个非平庸的修正项是展开式中的下一项：\n$$\nZ_{\\mathrm{q}} \\approx \\left(\\frac{L}{\\lambda_T}\\right)^3 - \\frac{3}{2}\\left(\\frac{L}{\\lambda_T}\\right)^2 = Z_{\\mathrm{cl}} - \\frac{3}{2}\\frac{L^2}{\\lambda_T^2}\n$$\n最后，我们计算比率 $Z_{\\mathrm{q}}/Z_{\\mathrm{cl}}$：\n$$\n\\frac{Z_{\\mathrm{q}}}{Z_{\\mathrm{cl}}} \\approx \\frac{ (L/\\lambda_T)^3 - \\frac{3}{2}(L/\\lambda_T)^2 }{ (L/\\lambda_T)^3 } = 1 - \\frac{3}{2}\\frac{(L/\\lambda_T)^2}{(L/\\lambda_T)^3} = 1 - \\frac{3}{2}\\frac{\\lambda_T}{L}\n$$\n该修正项代表了由于盒子的有限尺寸和粒子的波动性而产生的量子效应，这些在纯经典处理中被忽略了。",
            "answer": "$$\n\\boxed{1 - \\frac{3}{2}\\frac{\\lambda_{T}}{L}}\n$$"
        },
        {
            "introduction": "真实气体并非理想气体，其构成粒子之间存在相互作用。本练习 () 将从理想化模型转向使用 Lennard-Jones 势对非理想气体进行真实描述。您将看到配分函数框架如何引出维里展开，并允许您通过数值计算来确定第二维里系数 $B_2$，这是一个可测量的、捕捉了对理想气体行为首次偏离的物理量。",
            "id": "3764714",
            "problem": "您的任务是基于第一性原理设计并实现一个数值程序，用于计算由对 Lennard-Jones 相互作用决定的经典气体的第二维里系数的构型贡献，并推断在指定无量纲温度下第二维里系数的符号。从与大热源热接触的经典系统的正则系综出发，其中相关的描述是正则配分函数。利用构型积分的既定构造及其在维里展开中的作用，得出一个适合数值积分的可计算的一维积分。\n\n该系统由三维空间中的相同点粒子组成，它们通过球对称的对 Lennard-Jones 势相互作用，该势具有参数 $\\epsilon$ 和 $\\sigma$，其中相距为 $r$ 的两个粒子之间的势能为 $u(r) = 4 \\epsilon \\left[ \\left( \\dfrac{\\sigma}{r} \\right)^{12} - \\left( \\dfrac{\\sigma}{r} \\right)^{6} \\right]$。使用基于 $\\epsilon$ 和 $\\sigma$ 的约化无量纲单位：定义约化温度 $T^\\star = \\dfrac{k_B T}{\\epsilon}$ 和约化距离 $x = \\dfrac{r}{\\sigma}$。将第二维里系数以 $\\sigma^3$ 为单位表示为无量纲数 $\\dfrac{B_2}{\\sigma^3}$。您计算的所有物理量都必须以这些约化单位表示。\n\n您的推导和程序必须遵循以下基本原理：\n- 从 $N$ 个经典粒子的正则配分函数开始，通过对动量积分来分离动能和构型贡献。\n- 利用构型积分的定义和性质，以及压力对数密度的系统维里展开，将第二维里系数与对相互作用势的积分联系起来。\n- 将其特化为球对称的对势，并将构型积分简化为对约化变量 $x$ 的单一径向积分，以适合数值计算。通过适当处理在 $x \\to 0$ 和 $x \\to \\infty$ 处的行为，确保积分是绝对收敛且数值稳定的。\n\n程序规范：\n- 实现一个稳健的数值积分方法，用于在 $x \\in [0, \\infty)$ 上计算 Lennard-Jones $12$–$6$ 势所需的瑕积分，以在给定的 $T^\\star$ 下获得 $\\dfrac{B_2}{\\sigma^3}$。\n- 根据每个 $T^\\star$ 下的计算值推断 $B_2$ 的符号；报告 $B_2$ 是正值（以排斥为主的行为）还是非正值（以吸引为主或中性的行为）。\n- 对于数值输出，将每个 $\\dfrac{B_2}{\\sigma^3}$ 值四舍五入到八位小数。\n\n物理和数值单位：\n- 您必须将第二维里系数以 $\\sigma^3$ 为单位表示，作为一个无量纲量 $\\dfrac{B_2}{\\sigma^3}$。\n- 温度以约化单位 $T^\\star = \\dfrac{k_B T}{\\epsilon}$ 指定，该单位是无量纲的。\n\n测试套件：\n针对以下约化温度 $T^\\star$ 评估您的实现：\n1. $T^\\star = 0.5$ (低温，以吸引为主的区域)。\n2. $T^\\star = 2.0$ (中等温度)。\n3. $T^\\star = 3.42$ (接近玻意耳温度，在该温度下 Lennard-Jones $12$–$6$ 势的第二维里系数接近于零)。\n4. $T^\\star = 4.0$ (高于玻意耳温度)。\n5. $T^\\star = 10.0$ (高温，以排斥为主的区域)。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。输出必须是包含两个列表的列表：\n    - 第一个内部列表包含五个计算出的 $\\dfrac{B_2}{\\sigma^3}$ 值，每个值都四舍五入到八位小数。\n    - 第二个内部列表包含五个布尔值，指示相应测试用例中 $B_2$ 的符号，使用该语言的原生布尔字面量表示真和假。\n- 例如，输出格式应如下所示：`[[b2_case1,b2_case2,b2_case3,b2_case4,b2_case5],[sign1,sign2,sign3,sign4,sign5]]`，其中每个 `b2_case` 是一个浮点数，每个 `sign` 是一个布尔值。\n\n您的程序必须是自包含的，并且不得需要任何外部输入。",
            "solution": "该问题要求计算一个经典气体的第二维里系数 $B_2$，该气体中的粒子通过 Lennard-Jones 势相互作用。这将通过从正则配分函数出发，推导 $B_2$ 关于对相互作用势的表达式，将该表达式转换为适合数值计算的无量纲单位，然后对给定的一组无量纲温度计算所得积分来完成。\n\n起点是正则配分函数 $Z_N$，它描述了在温度 $T$ 和体积 $V$ 中由 $N$ 个相同的、不可区分的经典粒子组成的系统。它由下式给出\n$$\nZ_N = \\frac{1}{N! h^{3N}} \\int \\cdots \\int e^{-\\beta H(\\mathbf{q}^N, \\mathbf{p}^N)} d\\mathbf{q}^N d\\mathbf{p}^N\n$$\n其中 $\\beta = (k_B T)^{-1}$，$k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数。哈密顿量 $H(\\mathbf{q}^N, \\mathbf{p}^N)$ 是动能 $K(\\mathbf{p}^N)$ 和势能 $U(\\mathbf{q}^N)$ 的和：\n$$\nH(\\mathbf{q}^N, \\mathbf{p}^N) = \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m} + U(\\mathbf{q}^N)\n$$\n对动量的积分可以独立于位置进行，得到：\n$$\n\\int e^{-\\beta K(\\mathbf{p}^N)} d\\mathbf{p}^N = \\left( \\int e^{-\\beta(p_x^2+p_y^2+p_z^2)/(2m)} dp_x dp_y dp_z \\right)^N = \\left( \\frac{2\\pi m}{\\beta} \\right)^{3N/2}\n$$\n这使得配分函数可以写成：\n$$\nZ_N = \\frac{1}{N! \\Lambda^{3N}} Q_N\n$$\n其中 $\\Lambda = h / \\sqrt{2\\pi m k_B T}$ 是热德布罗意波长，$Q_N$ 是构型积分：\n$$\nQ_N = \\int_V \\cdots \\int_V e^{-\\beta U(\\mathbf{q}^N)} d\\mathbf{q}^1 \\cdots d\\mathbf{q}^N\n$$\n对于一个具有对可加相互作用的系统，势能为 $U(\\mathbf{q}^N) = \\sum_{1 \\le i  j \\le N} u(r_{ij})$，其中 $u(r_{ij})$ 是相距为 $r_{ij} = |\\mathbf{q}_i - \\mathbf{q}_j|$ 的粒子 $i$ 和 $j$ 之间的势。\n\n物态方程可以使用维里展开来表示，该展开将压力 $P$ 与数密度 $\\rho = N/V$ 的幂级数联系起来：\n$$\n\\frac{P}{\\rho k_B T} = 1 + B_2(T) \\rho + B_3(T) \\rho^2 + \\mathcal{O}(\\rho^3)\n$$\n第二维里系数 $B_2(T)$ 解释了由于对相互作用引起的对理想气体行为的一阶偏差。统计力学提供了 $B_2(T)$ 和对势 $u(r)$ 之间的直接联系：\n$$\nB_2(T) = -\\frac{1}{2} \\int (e^{-\\beta u(\\mathbf{r})} - 1) d\\mathbf{r}\n$$\n项 $e^{-\\beta u(\\mathbf{r})} - 1$ 被称为 Mayer f-函数。对于球对称势 $u(\\mathbf{r}) = u(r)$，我们可以在球坐标中将体积元 $d\\mathbf{r}$ 表示为 $4\\pi r^2 dr$。积分变为一维：\n$$\nB_2(T) = -2\\pi \\int_0^\\infty (e^{-\\beta u(r)} - 1) r^2 dr\n$$\nLennard-Jones $12$–$6$ 势由下式给出：\n$$\nu(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]\n$$\n其中 $\\epsilon$ 是势阱的深度，$\\sigma$ 是粒子间势为零时的有限距离。为方便计算，我们转换为无量纲变量。令 $x = r/\\sigma$ 为约化距离，$T^\\star = k_B T / \\epsilon$ 为约化温度。指数项 $\\beta u(r)$ 变为：\n$$\n\\beta u(r) = \\frac{1}{k_B T} u(r) = \\frac{\\epsilon}{k_B T} \\frac{u(r)}{\\epsilon} = \\frac{1}{T^\\star} \\cdot 4 \\left[ \\left( \\frac{1}{x} \\right)^{12} - \\left( \\frac{1}{x} \\right)^{6} \\right] = \\frac{4}{T^\\star} (x^{-12} - x^{-6})\n$$\n将 $r = x\\sigma$ 和 $dr = \\sigma dx$ 代入 $B_2(T)$ 的积分中，我们得到：\n$$\nB_2(T) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right) (x\\sigma)^2 (\\sigma dx)\n$$\n$$\nB_2(T) = -2\\pi \\sigma^3 \\int_0^\\infty \\left( \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right) x^2 dx\n$$\n问题要求以 $\\sigma^3$ 为单位的第二维里系数，即无量纲量 $B_2^\\star = B_2(T)/\\sigma^3$：\n$$\nB_2^\\star(T^\\star) = -2\\pi \\int_0^\\infty \\left\\{ \\exp\\left[ -\\frac{4}{T^\\star}(x^{-12} - x^{-6}) \\right] - 1 \\right\\} x^2 dx\n$$\n这是需要进行数值计算的最终表达式。该定积分是瑕积分，积分区间为 $[0, \\infty)$。被积函数在两个极限处都表现良好。当 $x \\to 0$ 时，$u(x) \\to \\infty$，因此 $\\exp[-\\beta u(x)] \\to 0$，被积函数的行为类似于 $-x^2$，这是可积的。当 $x \\to \\infty$ 时，$u(x) \\to 0$，因此 $\\exp[-\\beta u(x)] - 1 \\approx -\\beta u(x) \\propto x^{-6}$。被积函数的行为则类似于 $x^{-6} \\cdot x^2 = x^{-4}$，这确保了积分在无穷远处的收敛性。一个为瑕积分设计的数值求积程序可以稳健地计算其值。$B_2^\\star$ 的符号则由结果确定。正值表示排斥占主导，而非正值表示吸引占主导，或者在玻意耳温度下，表示两种效应之间的平衡。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless second virial coefficient for a Lennard-Jones gas\n    at specified reduced temperatures.\n    \"\"\"\n    \n    # Define the test cases for reduced temperature T* = k_B * T / epsilon.\n    test_cases = [0.5, 2.0, 3.42, 4.0, 10.0]\n\n    b2_results = []\n    sign_results = []\n\n    def integrand(x, t_star):\n        \"\"\"\n        Calculates the integrand for the B2* integral.\n        The integrand is (exp[-u*(x)/t_star] - 1) * x^2,\n        where u*(x) = 4 * (x**-12 - x**-6) is the reduced LJ potential.\n        \n        Args:\n            x (float): The reduced distance r/sigma.\n            t_star (float): The reduced temperature k_B*T/epsilon.\n\n        Returns:\n            float: The value of the integrand.\n        \"\"\"\n        # The limit of the integrand as x -> 0 is 0.\n        # Guard against ZeroDivisionError for x=0.\n        if x == 0.0:\n            return 0.0\n\n        # Calculate the reduced potential energy term in the exponent.\n        # This term can be large for small x, but exp(-large_positive) is 0.\n        potential_term = 4.0 * (x**-12 - x**-6)\n        beta_u = potential_term / t_star\n        \n        # The minimum of the potential is at x = 2^(1/6), where u* = -1.\n        # The maximum value of -beta_u is 4/t_star. For the given test cases,\n        # max value is 4/0.5 = 8. np.exp(8) is well within float64 range.\n        # No overflow is expected.\n        return (np.exp(-beta_u) - 1.0) * x**2\n\n    for t_star_val in test_cases:\n        # Perform numerical quadrature of the integrand from 0 to infinity.\n        # The `args` tuple passes the reduced temperature to the integrand.\n        integral_val, _ = integrate.quad(integrand, 0, np.inf, args=(t_star_val,))\n\n        # Calculate the reduced second virial coefficient B2* = B2 / sigma^3.\n        # B2* = -2 * pi * integral\n        b2_star = -2.0 * np.pi * integral_val\n        \n        # Round the result to eight decimal places as required.\n        b2_rounded = round(b2_star, 8)\n        \n        # Infer the sign: True for positive, False for non-positive.\n        is_positive = b2_rounded > 0.0\n        \n        b2_results.append(b2_rounded)\n        sign_results.append(is_positive)\n\n    # Format the final output string precisely as specified:\n    # \"[[b2_case1,...,b2_case5],[sign1,...,sign5]]\"\n    # where booleans are lowercase 'true' or 'false'.\n    b2_str_list = [f\"{val:.8f}\" for val in b2_results]\n    sign_str_list = [str(val).lower() for val in sign_results]\n    \n    final_output = f\"[[{','.join(b2_str_list)}],[{','.join(sign_str_list)}]]\"\n    \n    # The final print statement must produce only the required output string.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}