{
    "hands_on_practices": [
        {
            "introduction": "本练习在偏迹的抽象定义及其实际应用之间搭建了一座基础的桥梁。通过从其根本定义出发推导指标求和公式，并将其应用于一个具体的三能级-比特（qutrit-qubit）系统，您将亲身体验如何从一个更大的复合态矩阵中计算出约化密度算符 。这项技能对于分析任何子系统的局域性质以及后续计算如纯度等物理量都是不可或缺的。",
            "id": "3783121",
            "problem": "考虑一个复合量子系统，它由一个希尔伯特空间 $\\mathcal{H}_{S}$ 维数为 $3$ 的三能级系统（qutrit）$S$ 和一个希尔伯特空间 $\\mathcal{H}_{E}$ 维数为 $2$ 的两能级环境（qubit）$E$ 组成。联合空间为 $\\mathcal{H}_{S} \\otimes \\mathcal{H}_{E}$，维数为 $6$。在按字典序排列的计算乘积基中进行计算：\n$$\n|0\\rangle \\otimes |0\\rangle,\\; |0\\rangle \\otimes |1\\rangle,\\; |1\\rangle \\otimes |0\\rangle,\\; |1\\rangle \\otimes |1\\rangle,\\; |2\\rangle \\otimes |0\\rangle,\\; |2\\rangle \\otimes |1\\rangle,\n$$\n并用复合索引 $i = 2 s + e$ (其中 $s \\in \\{0,1,2\\}$ 且 $e \\in \\{0,1\\}$) 来编码基矢 $|s\\rangle \\otimes |e\\rangle$。\n\n从对环境求偏迹的定义性质出发，\n$$\n\\mathrm{Tr}_{S}\\!\\left[ A_{S}\\, \\mathrm{Tr}_{E}(\\rho_{SE}) \\right] \\;=\\; \\mathrm{Tr}_{S \\otimes E}\\!\\left[ (A_{S} \\otimes I_{E})\\, \\rho_{SE} \\right]\n$$\n对于 $\\mathcal{H}_{S}$ 上的所有有界算符 $A_{S}$，推导约化密度算符 $\\rho_{S} = \\mathrm{Tr}_{E}(\\rho_{SE})$ 在 $S$ 基下的矩阵元的显式索引求和公式，该公式用 $\\rho_{SE}$ 在上述乘积基下的 $6 \\times 6$ 矩阵的元素表示。\n\n然后，使用你推导出的求和公式，对下面给出的、在上述有序基下表示的特定联合态 $\\rho_{SE}$ 执行对 $E$ 的偏迹运算：\n$$\n\\rho_{SE} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{4} & 0 & \\frac{1}{4} & 0 & 0 & \\frac{1}{2\\sqrt{2}} \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n\\frac{1}{4} & 0 & \\frac{1}{4} & 0 & 0 & \\frac{1}{2\\sqrt{2}} \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n\\frac{1}{2\\sqrt{2}} & 0 & \\frac{1}{2\\sqrt{2}} & 0 & 0 & \\frac{1}{2}\n\\end{pmatrix}.\n$$\n\n最后，计算系统纯度\n$$\n\\gamma \\;=\\; \\mathrm{Tr}\\!\\left( \\rho_{S}^{2} \\right).\n$$\n\n给出你的最终答案，它应为一个精确数。不要四舍五-入。不要包含单位。最终答案必须仅为 $\\gamma$ 的值。",
            "solution": "该问题经评估是有效的，因为它在数学上和科学上是合理的、良定的，并且提供了所有必要的信息。它涉及量子信息论中标准的、可验证的概念。\n\n我们的首要任务是推导偏迹的索引求和公式。我们从约化密度算符 $\\rho_S = \\mathrm{Tr}_E(\\rho_{SE})$ 的定义关系式开始：\n$$\n\\mathrm{Tr}_{S}\\!\\left[ A_{S}\\, \\rho_{S} \\right] \\;=\\; \\mathrm{Tr}_{S \\otimes E}\\!\\left[ (A_{S} \\otimes I_{E})\\, \\rho_{SE} \\right]\n$$\n这对于希尔伯特空间 $\\mathcal{H}_S$ 上的任何有界线性算符 $A_S$ 都必须成立。设 $\\{|s\\rangle\\}_{s=0,1,2}$ 是 $\\mathcal{H}_S$ 的标准正交基，$\\{|e\\rangle\\}_{e=0,1}$ 是 $\\mathcal{H}_E$ 的标准正交基。复合空间 $\\mathcal{H}_{SE} = \\mathcal{H}_S \\otimes \\mathcal{H}_E$ 的乘积基是 $\\{|s\\rangle \\otimes |e\\rangle\\}$，我们将其记为 $\\{|s,e\\rangle\\}$。\n\n我们用 $\\mathcal{H}_S$ 基矢下的矩阵元来表示左侧（LHS）：\n$$\n\\mathrm{LHS} = \\mathrm{Tr}_{S}\\!\\left[ A_{S}\\, \\rho_{S} \\right] = \\sum_{s_1=0}^{2} \\langle s_1 | A_S \\rho_S | s_1 \\rangle = \\sum_{s_1=0}^{2} \\sum_{s_2=0}^{2} \\langle s_1 | A_S | s_2 \\rangle \\langle s_2 | \\rho_S | s_1 \\rangle\n$$\n设矩阵元表示为 $(A_S)_{s_1 s_2} = \\langle s_1 | A_S | s_2 \\rangle$ 和 $(\\rho_S)_{s_2 s_1} = \\langle s_2 | \\rho_S | s_1 \\rangle$。那么，$\\mathrm{LHS} = \\sum_{s_1,s_2} (A_S)_{s_1 s_2} (\\rho_S)_{s_2 s_1}$。\n\n接下来，我们在 $\\mathcal{H}_{SE}$ 的基中表示右侧（RHS）：\n$$\n\\mathrm{RHS} = \\mathrm{Tr}_{S \\otimes E}\\!\\left[ (A_{S} \\otimes I_{E})\\, \\rho_{SE} \\right] = \\sum_{s_1=0}^{2} \\sum_{e_1=0}^{1} \\langle s_1, e_1 | (A_S \\otimes I_E) \\rho_{SE} | s_1, e_1 \\rangle\n$$\n插入完备性关系 $I_{SE} = \\sum_{s_2, e_2} |s_2, e_2\\rangle \\langle s_2, e_2|$：\n$$\n\\mathrm{RHS} = \\sum_{s_1, e_1} \\sum_{s_2, e_2} \\langle s_1, e_1 | A_S \\otimes I_E | s_2, e_2 \\rangle \\langle s_2, e_2 | \\rho_{SE} | s_1, e_1 \\rangle\n$$\n张量积算符的矩阵元为 $\\langle s_1, e_1 | A_S \\otimes I_E | s_2, e_2 \\rangle = \\langle s_1 | A_S | s_2 \\rangle \\langle e_1 | I_E | e_2 \\rangle = (A_S)_{s_1 s_2} \\delta_{e_1 e_2}$。\n将此代入 RHS 的表达式中：\n$$\n\\mathrm{RHS} = \\sum_{s_1, e_1} \\sum_{s_2, e_2} (A_S)_{s_1 s_2} \\delta_{e_1 e_2} \\langle s_2, e_2 | \\rho_{SE} | s_1, e_1 \\rangle\n$$\n对 $e_2$ 求和会消去克罗内克δ：\n$$\n\\mathrm{RHS} = \\sum_{s_1, s_2} \\sum_{e_1} (A_S)_{s_1 s_2} \\langle s_2, e_1 | \\rho_{SE} | s_1, e_1 \\rangle\n$$\n令 LHS 和 RHS 相等：\n$$\n\\sum_{s_1, s_2} (A_S)_{s_1 s_2} (\\rho_S)_{s_2 s_1} = \\sum_{s_1, s_2} (A_S)_{s_1 s_2} \\left( \\sum_{e_1=0}^{1} \\langle s_2, e_1 | \\rho_{SE} | s_1, e_1 \\rangle \\right)\n$$\n由于该等式必须对任意算符 $A_S$ 成立，因此两边 $(A_S)_{s_1 s_2}$ 的系数必须相等。因此，我们确定：\n$$\n(\\rho_S)_{s_2 s_1} = \\sum_{e=0}^{1} \\langle s_2, e | \\rho_{SE} | s_1, e \\rangle\n$$\n这就是我们想要的约化密度算符 $\\rho_S$ 矩阵元的索引求和公式。\n\n现在，我们将此公式应用于给定的 $6 \\times 6$ 密度矩阵 $\\rho_{SE}$。基矢的顺序为 $|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle, |20\\rangle, |21\\rangle$，对应于索引 $0$ 到 $5$。态 $|s,e\\rangle$ 的矩阵索引为 $i = 2s+e$。因此，矩阵元 $\\langle s_1, e_1 | \\rho_{SE} | s_2, e_2 \\rangle$ 对应于矩阵元素 $(\\rho_{SE})_{i,j}$，其中 $i = 2s_1+e_1$ 且 $j = 2s_2+e_2$。\n$\\rho_S$ 元素的公式变为：\n$$\n(\\rho_S)_{s_1 s_2} = \\sum_{e=0}^{1} (\\rho_{SE})_{2s_1+e, 2s_2+e}\n$$\n我们计算 $3 \\times 3$ 矩阵 $\\rho_S$ 的元素：\n$(\\rho_S)_{00} = (\\rho_{SE})_{0,0} + (\\rho_{SE})_{1,1} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{01} = (\\rho_{SE})_{0,2} + (\\rho_{SE})_{1,3} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{02} = (\\rho_{SE})_{0,4} + (\\rho_{SE})_{1,5} = 0 + 0 = 0$\n$(\\rho_S)_{10} = (\\rho_{SE})_{2,0} + (\\rho_{SE})_{3,1} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{11} = (\\rho_{SE})_{2,2} + (\\rho_{SE})_{3,3} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{12} = (\\rho_{SE})_{2,4} + (\\rho_{SE})_{3,5} = 0 + 0 = 0$\n$(\\rho_S)_{20} = (\\rho_{SE})_{4,0} + (\\rho_{SE})_{5,1} = 0 + 0 = 0$\n$(\\rho_S)_{21} = (\\rho_{SE})_{4,2} + (\\rho_{SE})_{5,3} = 0 + 0 = 0$\n$(\\rho_S)_{22} = (\\rho_{SE})_{4,4} + (\\rho_{SE})_{5,5} = 0 + \\frac{1}{2} = \\frac{1}{2}$\n\n系统 $S$ 的约化密度算符为：\n$$\n\\rho_{S} =\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n0 & 0 & \\frac{1}{2}\n\\end{pmatrix}\n$$\n迹为 $\\mathrm{Tr}(\\rho_S) = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{2} = 1$，符合要求。\n\n最后，我们计算纯度 $\\gamma = \\mathrm{Tr}(\\rho_S^2)$：\n$$\n\\rho_{S}^2 =\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n0 & 0 & \\frac{1}{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n0 & 0 & \\frac{1}{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(\\frac{1}{4})^2 + (\\frac{1}{4})^2 & (\\frac{1}{4})^2 + (\\frac{1}{4})^2 & 0 \\\\\n(\\frac{1}{4})^2 + (\\frac{1}{4})^2 & (\\frac{1}{4})^2 + (\\frac{1}{4})^2 & 0 \\\\\n0 & 0 & (\\frac{1}{2})^2\n\\end{pmatrix}\n$$\n$$\n\\rho_{S}^2 =\n\\begin{pmatrix}\n\\frac{1}{16} + \\frac{1}{16} & \\frac{1}{16} + \\frac{1}{16} & 0 \\\\\n\\frac{1}{16} + \\frac{1}{16} & \\frac{1}{16} + \\frac{1}{16} & 0 \\\\\n0 & 0 & \\frac{1}{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{2}{16} & \\frac{2}{16} & 0 \\\\\n\\frac{2}{16} & \\frac{2}{16} & 0 \\\\\n0 & 0 & \\frac{1}{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{8} & \\frac{1}{8} & 0 \\\\\n\\frac{1}{8} & \\frac{1}{8} & 0 \\\\\n0 & 0 & \\frac{1}{4}\n\\end{pmatrix}\n$$\n纯度是该矩阵的迹：\n$$\n\\gamma = \\mathrm{Tr}(\\rho_S^2) = \\frac{1}{8} + \\frac{1}{8} + \\frac{1}{4} = \\frac{2}{8} + \\frac{1}{4} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "除了简单的计算，理解约化密度算符所编码的物理性质也至关重要。本练习旨在探索约化密度算符的本征值（其量化了子系统的混合度）如何在环境上的局域幺正操作下保持不变——这是与量子纠缠相关的基石概念 。您将看到局域操作如何影响量子态的基，但却保持其根本的混合度不变，从而深刻洞察量子关联的本质。",
            "id": "3783151",
            "problem": "考虑一个开放量子系统 $S$ 与一个环境 $E$ 耦合，每个系统都被建模为一个二能级系统，其计算基分别为 $\\{|0\\rangle_{S},|1\\rangle_{S}\\}$ 和 $\\{|0\\rangle_{E},|1\\rangle_{E}\\}$。其联合态为纯态，由下式给出\n$$\n|\\Psi\\rangle = \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E},\n$$\n其中 $0<p<1$ 且 $\\phi$ 为实数。\n1.  通过对环境 $E$ 进行偏迹运算，计算系统 $S$ 的约化密度算符 $\\rho_{S} = \\mathrm{Tr}_{E}(|\\Psi\\rangle\\langle\\Psi|)$。\n2.  现在，对联合态施加一个局域幺正变换 $U_{S}(\\theta)\\otimes V_{E}(\\vartheta)$，得到一个新的态 $|\\Psi'\\rangle = (U_{S}(\\theta)\\otimes V_{E}(\\vartheta))|\\Psi\\rangle$。推导新的约化密度算符 $\\rho'_{S} = \\mathrm{Tr}_{E}(|\\Psi'\\rangle\\langle\\Psi'|)$ 关于 $\\rho_{S}$ 和 $U_{S}(\\theta)$ 的表达式。\n3.  从第一性原理（即施密特分解）出发，论证为何对环境 $E$ 的局域幺正操作 $V_{E}(\\vartheta)$ 不改变 $S$ 的约化密度算符的本征值，而对系统 $S$ 的局域幺正操作 $U_{S}(\\theta)$ 也不改变它们。\n4.  基于你的推导，写出 $\\rho'_{S}$ 的本征值。给出你的答案，它应为一个有序的本征值对 $(p, 1-p)$。",
            "solution": "该问题是良定的，具有科学依据，并且是开放量子系统形式体系中的一个标准练习。因此，它被认为是有效的，并将提供完整的解答。解答将按所述顺序执行四个任务。\n\n1.  **约化密度算符 $\\rho_{S}$ 的计算**\n\n复合系统 $S+E$ 处于纯态 $|\\Psi\\rangle$，由下式给出\n$$\n|\\Psi\\rangle = \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E}\n$$\n复合系统对应的密度算符为 $\\rho_{SE} = |\\Psi\\rangle\\langle\\Psi|$。展开此表达式，我们得到：\n$$\n\\rho_{SE} = \\left( \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E} \\right) \\left( \\sqrt{p}\\,\\langle0|_{S}\\otimes\\langle0|_{E} + \\sqrt{1-p}\\,\\exp(-i\\phi)\\,\\langle1|_{S}\\otimes\\langle1|_{E} \\right)\n$$\n$$\n\\rho_{SE} = p\\,|0\\rangle_{S}\\langle0|_{S} \\otimes |0\\rangle_{E}\\langle0|_{E} + (1-p)\\,|1\\rangle_{S}\\langle1|_{S} \\otimes |1\\rangle_{E}\\langle1|_{E} + \\sqrt{p(1-p)}\\exp(i\\phi)\\,|1\\rangle_{S}\\langle0|_{S} \\otimes |1\\rangle_{E}\\langle0|_{E} + \\sqrt{p(1-p)}\\exp(-i\\phi)\\,|0\\rangle_{S}\\langle1|_{S} \\otimes |0\\rangle_{E}\\langle1|_{E}\n$$\n系统 $S$ 的约化密度算符，记作 $\\rho_{S}$，是通过对环境 $E$ 进行偏迹运算得到的。使用所提供的定义，$\\rho_{S} = \\mathrm{Tr}_{E}(\\rho_{SE}) = \\sum_{j=0}^{1} \\langle j|_{E} \\rho_{SE} |j\\rangle_{E}$，为简洁起见，我们省略了单位算符 $\\mathbb{I}_{S}$，因为其作用是隐含的。\n\n对于 $j=0$：\n$$\n\\langle 0|_{E} \\rho_{SE} |0\\rangle_{E} = \\langle 0|_{E} \\left( p\\,|0\\rangle_{S}\\langle0|_{S} \\otimes |0\\rangle_{E}\\langle0|_{E} + \\dots \\right) |0\\rangle_{E}\n$$\n涉及 $E$ 的态的内积为 $\\langle 0|_{E}|0\\rangle_{E}=1$ 和 $\\langle 0|_{E}|1\\rangle_{E}=0$。因此，只有 $\\rho_{SE}$ 的第一项在此投影下存活。\n$$\n\\langle 0|_{E} \\rho_{SE} |0\\rangle_{E} = p\\,|0\\rangle_{S}\\langle0|_{S} \\cdot \\langle 0|_{E}|0\\rangle_{E}\\langle0|_{E}|0\\rangle_{E} = p\\,|0\\rangle_{S}\\langle0|_{S}\n$$\n对于 $j=1$：\n$$\n\\langle 1|_{E} \\rho_{SE} |1\\rangle_{E} = \\langle 1|_{E} \\left( \\dots + (1-p)\\,|1\\rangle_{S}\\langle1|_{S} \\otimes |1\\rangle_{E}\\langle1|_{E} + \\dots \\right) |1\\rangle_{E}\n$$\n同样，由于正交条件 $\\langle 1|_{E}|0\\rangle_{E}=0$，只有 $\\rho_{SE}$ 的第二项存活。\n$$\n\\langle 1|_{E} \\rho_{SE} |1\\rangle_{E} = (1-p)\\,|1\\rangle_{S}\\langle1|_{S} \\cdot \\langle 1|_{E}|1\\rangle_{E}\\langle1|_{E}|1\\rangle_{E} = (1-p)\\,|1\\rangle_{S}\\langle1|_{S}\n$$\n交叉项消失，因为它们涉及诸如 $|1\\rangle_{E}\\langle0|_{E}$ 的项，这导致内积如 $\\langle 0|_{E}|1\\rangle_{E}\\langle0|_{E}|0\\rangle_{E} = 0$ 或 $\\langle 1|_{E}|0\\rangle_{E}\\langle1|_{E}|1\\rangle_{E} = 0$。\n将 $j=0$ 和 $j=1$ 的贡献相加：\n$$\n\\rho_{S} = p\\,|0\\rangle_{S}\\langle0|_{S} + (1-p)\\,|1\\rangle_{S}\\langle1|_{S}\n$$\n在计算基 $\\{|0\\rangle_{S}, |1\\rangle_{S}\\}$ 中，这对应于矩阵：\n$$\n\\rho_{S} = \\begin{pmatrix} p & 0 \\\\ 0 & 1-p \\end{pmatrix}\n$$\n\n2.  **变换后的约化密度算符 $\\rho'_{S}$ 的推导**\n\n变换后的联合密度算符为 $\\rho'_{SE} = |\\Psi'\\rangle\\langle\\Psi'|$，其中 $|\\Psi'\\rangle = (U_{S}\\otimes V_{E})|\\Psi\\rangle$。因此，\n$$\n\\rho'_{SE} = (U_{S}\\otimes V_{E})|\\Psi\\rangle\\langle\\Psi|(U_{S}^{\\dagger}\\otimes V_{E}^{\\dagger}) = (U_{S}\\otimes V_{E})\\rho_{SE}(U_{S}^{\\dagger}\\otimes V_{E}^{\\dagger})\n$$\n变换后的约化态为 $\\rho'_{S} = \\mathrm{Tr}_{E}(\\rho'_{SE})$。\n$$\n\\rho'_{S} = \\mathrm{Tr}_{E}\\left[ (U_{S}\\otimes V_{E})\\rho_{SE}(U_{S}^{\\dagger}\\otimes V_{E}^{\\dagger}) \\right]\n$$\n偏迹是一个线性映射。仅作用于系统 $S$ 的算符（如 $U_{S}$ 和 $U_{S}^{\\dagger}$）可以从对 $E$ 的迹中提取出来。\n$$\n\\rho'_{S} = U_{S} \\left( \\mathrm{Tr}_{E}\\left[ (\\mathbb{I}_{S}\\otimes V_{E})\\rho_{SE}(\\mathbb{I}_{S}\\otimes V_{E}^{\\dagger}) \\right] \\right) U_{S}^{\\dagger}\n$$\n我们来计算括号内的表达式。设 $\\{|k\\rangle_{E}\\}$ 是环境 $E$ 的任意一个标准正交基。\n$$\n\\mathrm{Tr}_{E}\\left[ (\\mathbb{I}_{S}\\otimes V_{E})\\rho_{SE}(\\mathbb{I}_{S}\\otimes V_{E}^{\\dagger}) \\right] = \\sum_{k} \\langle k|_{E} (\\mathbb{I}_{S}\\otimes V_{E})\\rho_{SE}(\\mathbb{I}_{S}\\otimes V_{E}^{\\dagger}) |k\\rangle_{E}\n$$\n$$\n= \\sum_{k} (\\langle k|_{E}V_{E}) \\rho_{SE} (V_{E}^{\\dagger}|k\\rangle_{E})\n$$\n为清晰起见，我们省略了单位算符。由于 $V_{E}$ 是一个幺正算符，态的集合 $\\{|k'\\rangle_{E}\\} \\equiv \\{V_{E}^{\\dagger}|k\\rangle_{E}\\}$ 构成了 $E$ 的另一个标准正交基。对 $k$ 的求和等价于对 $k'$ 的求和。\n$$\n= \\sum_{k'} \\langle k'|_{E} \\rho_{SE} |k'\\rangle_{E} = \\mathrm{Tr}_{E}(\\rho_{SE}) = \\rho_{S}\n$$\n这表明对环境的局域幺正操作不会改变系统的约化态。将此结果代回 $\\rho'_{S}$ 的表达式中：\n$$\n\\rho'_{S} = U_{S} \\rho_{S} U_{S}^{\\dagger}\n$$\n这就是 $\\rho'_{S}$ 关于 $\\rho_{S}$ 和 $U_{S}(\\theta)$ 的表达式。它与 $V_{E}(\\vartheta)$ 无关。\n\n3.  **从第一性原理出发的论证**\n\n初始态 $|\\Psi\\rangle = \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E}$ 是一个二体纯态。其施密特分解由 $|\\Psi\\rangle = \\sum_{k} \\sqrt{\\lambda_k} |u_k\\rangle_S \\otimes |v_k\\rangle_E$ 给出，其中 $\\{|u_k\\rangle_S\\}$ 和 $\\{|v_k\\rangle_E\\}$ 分别是 $S$ 和 $E$ 的标准正交基，$\\sqrt{\\lambda_k}$ 是施密特系数。对于给定的态，施密特系数为 $\\sqrt{\\lambda_0}=\\sqrt{p}$ 和 $\\sqrt{\\lambda_1}=\\sqrt{1-p}$。对应的施密特基为 $\\{|u_0\\rangle_S, |u_1\\rangle_S\\} = \\{|0\\rangle_S, |1\\rangle_S\\}$ 和 $\\{|v_0\\rangle_E, |v_1\\rangle_E\\} = \\{|0\\rangle_E, \\exp(i\\phi)|1\\rangle_E\\}$。\n\n约化密度算符 $\\rho_{S}$ 可以直接从施密特分解表示为 $\\rho_{S} = \\sum_{k} \\lambda_k |u_k\\rangle_S \\langle u_k|_S$。$\\rho_{S}$ 的本征值是施密特系数的平方，即 $\\{\\lambda_k\\} = \\{p, 1-p\\}$，其本征矢量是 $S$ 的施密特基矢量 $\\{|u_k\\rangle_S\\}$。\n\n$\\mathbb{I}_{S}\\otimes V_{E}(\\vartheta)$ 的作用：态变换为 $|\\Psi_{V}\\rangle = (\\mathbb{I}_{S}\\otimes V_{E})|\\Psi\\rangle = \\sum_{k}\\sqrt{\\lambda_k} |u_k\\rangle_S \\otimes (V_{E}|v_k\\rangle_E)$。令 $|v'_k\\rangle_E = V_{E}|v_k\\rangle_E$。由于 $V_{E}$ 是幺正的，$\\{|v'_k\\rangle_E\\}$ 是 $E$ 的一个新的标准正交基。态 $|\\Psi_V\\rangle = \\sum_{k}\\sqrt{\\lambda_k} |u_k\\rangle_S \\otimes |v'_k\\rangle_E$ 是新的施密特分解。施密特系数 $\\{\\sqrt{\\lambda_k}\\}$ 和 S-基 $\\{|u_k\\rangle_S\\}$ 保持不变。由于 $\\rho_S$ 的本征值仅由施密特系数决定，它们保持不变。此操作仅改变 $E$ 上的施密特基。\n\n$U_{S}(\\theta)\\otimes \\mathbb{I}_{E}$ 的作用：态变换为 $|\\Psi_{U}\\rangle = (U_{S}\\otimes \\mathbb{I}_{E})|\\Psi\\rangle = \\sum_{k}\\sqrt{\\lambda_k} (U_{S}|u_k\\rangle_S) \\otimes |v_k\\rangle_E$。令 $|u'_k\\rangle_S = U_{S}|u_k\\rangle_S$。由于 $U_{S}$ 是幺正的，$\\{|u'_k\\rangle_S\\}$ 是 $S$ 的一个新的标准正交基。态 $|\\Psi_U\\rangle = \\sum_{k}\\sqrt{\\lambda_k} |u'_k\\rangle_S \\otimes |v_k\\rangle_E$ 是新的施密特分解。同样，施密特系数 $\\{\\sqrt{\\lambda_k}\\}$ 保持不变，这意味着系统 $S$ 的约化态的本征值是不变的。然而，$S$ 的施密特基已经改变。新的约化算符是 $\\rho'_S = \\sum_k \\lambda_k |u'_k\\rangle_S \\langle u'_k|_S = \\sum_k \\lambda_k U_S|u_k\\rangle_S \\langle u_k|_S U_S^\\dagger = U_S(\\sum_k \\lambda_k |u_k\\rangle_S \\langle u_k|_S)U_S^\\dagger = U_S \\rho_S U_S^\\dagger$。这是一个幺正相似变换，它是一种保持算符本征值不变的基变换。\n\n4.  **$\\rho'_{S}$ 的本征值**\n\n从第2部分的推导可知，我们有 $\\rho'_{S} = U_{S} \\rho_{S} U_{S}^{\\dagger}$。此关系表明 $\\rho'_{S}$ 和 $\\rho_{S}$ 通过一个幺正相似变换相关联。线性代数的一个基本定理指出，相似变换保持矩阵的本征值不变。因此，$\\rho'_{S}$ 的本征值与 $\\rho_S$ 的本征值相同。\n\n从第1部分，我们计算了 $\\rho_{S}$ 的对角表示：\n$$\n\\rho_{S} = \\begin{pmatrix} p & 0 \\\\ 0 & 1-p \\end{pmatrix}\n$$\n对角矩阵的本征值是其对角元。因此，$\\rho_{S}$ 的本征值为 $\\lambda_1 = p$ 和 $\\lambda_2 = 1-p$。\n因此，$\\rho'_{S}$ 的本征值也是 $p$ 和 $1-p$。参数 $\\theta$、$\\vartheta$ 和 $\\phi$ 不影响约化密度算符的谱，这是研究纠缠和局域操作中的一个关键结果。\n有序本征值对为 $(p, 1-p)$。",
            "answer": "$$\n\\boxed{(p, 1-p)}\n$$"
        },
        {
            "introduction": "在现代量子物理研究中，数值模拟是研究复杂系统不可或缺的工具。这个动手编程练习要求您用代码实现偏迹运算，并且通过测试它必须保持的基本数学性质——迹守恒、正定性以及局域期望值的一致性——来严格验证其正确性 。通过将理论理解转化为一个稳健且可验证的计算算法，本练习将巩固您的理论基础并培养关键的计算物理技能。",
            "id": "3783109",
            "problem": "考虑一个由希尔伯特空间 $\\mathcal{H}_A \\otimes \\mathcal{H}_B$ 描述的二分量子系统，其维度分别为有限的 $d_A$ 和 $d_B$。在 $\\mathcal{H}_A \\otimes \\mathcal{H}_B$ 上的密度算符 $\\rho_{AB}$ 是一个作用于该复合空间、迹为 1 的半正定算符。子系统 $A$ 上的约化密度算符（记作 $\\rho_A$）是通过对子系统 $B$ 取偏迹来定义的，它是 $\\mathcal{H}_A$ 上唯一的算符，对于 $\\mathcal{H}_A$ 上的所有算符 $O_A$ 都满足关系式 $\\mathrm{Tr}\\!\\left[(O_A \\otimes I_B)\\rho_{AB}\\right] = \\mathrm{Tr}\\!\\left[O_A \\rho_A\\right]$，其中 $I_B$ 是 $\\mathcal{H}_B$ 上的单位算符。操作 $\\mathrm{Tr}_B$ 表示对子系统 $B$ 取偏迹。在量子热力学和开放量子系统的背景下，当全局系统处于状态 $\\rho_{AB}$ 时，约化密度算符编码了在子系统 $A$ 上可获取的所有局域统计信息。\n\n从根本上说，我们必须验证偏迹的任何数值实现都保持了约化密度算符定义所要求的核心不变量。这些不变量包括：迹的保持性、正定性以及局域期望值的一致性。更准确地说：\n- 迹保持性：如果 $\\rho_{AB}$ 的迹为 $\\mathrm{Tr}(\\rho_{AB}) = 1$，那么约化密度 $\\rho_A = \\mathrm{Tr}_B(\\rho_{AB})$ 必须满足 $\\mathrm{Tr}(\\rho_A) = 1$。\n- 正定性：如果 $\\rho_{AB} \\succeq 0$（半正定），那么 $\\rho_A \\succeq 0$。\n- 局域期望值一致性：对于作用于 $\\mathcal{H}_A$ 的任何算符 $O_A$，等式 $\\mathrm{Tr}\\!\\left[O_A \\rho_A\\right] = \\mathrm{Tr}\\!\\left[(O_A \\otimes I_B)\\rho_{AB}\\right]$ 必须成立。\n\n你的任务是编写一个完整、可运行的程序，该程序构建几个二分量子态 $\\rho_{AB}$，通过对 $B$ 进行数值偏迹计算出约化态 $\\rho_A$，并在指定的数值容差范围内，对每种情况验证上面列出的三个不变量。程序必须：\n- 实现一个函数，该函数对给定的 $\\rho_{AB}$ 和维度 $(d_A,d_B)$ 执行偏迹操作 $\\mathrm{Tr}_B$，仅使用数组上的线性代数运算和偏迹的定义。\n- 使用固定的伪随机数生成器种子 $1729$，以确保测试套件中的所有随机构建都是可复现的。\n- 对每个测试用例，在 $\\mathcal{H}_A$ 上构建一个算符 $O_A$，并在 $10^{-10}$ 的数值容差内验证局域期望值的等式 $\\mathrm{Tr}\\!\\left[O_A \\rho_A\\right] = \\mathrm{Tr}\\!\\left[(O_A \\otimes I_B) \\rho_{AB}\\right]$。\n- 通过确保 $\\rho_A$ 的所有特征值都大于或等于 $-10^{-10}$ 来检查正定性。\n- 通过确保 $\\mathrm{Tr}(\\rho_A)$ 在 $10^{-10}$ 的容差内等于 $1$ 来检查迹保持性。\n\n此问题不涉及任何物理单位。\n\n测试套件：\n- 情况 1（正常路径，随机纯态）：$d_A = 2$，$d_B = 2$。构建一个随机纯态 $|\\psi\\rangle \\in \\mathcal{H}_A \\otimes \\mathcal{H}_B$ 并设置 $\\rho_{AB} = |\\psi\\rangle\\langle\\psi|$。在 $\\mathcal{H}_A$ 上选择一个随机的厄米算符 $O_A$。\n- 情况 2（边界情况，最大纠缠贝尔态）：$d_A = 2$，$d_B = 2$。使用 $|\\psi\\rangle = (|00\\rangle + |11\\rangle)/\\sqrt{2}$，因此 $\\rho_{AB} = |\\psi\\rangle\\langle\\psi|$。令 $O_A$ 为 $\\mathcal{H}_A$ 上的泡利-$Z$ 算符，由矩阵 $\\mathrm{diag}(1,-1)$ 表示。\n- 情况 3（非对称维度上的随机混合态）：$d_A = 2$，$d_B = 3$。通过 Ginibre 系综构建一个随机混合态 $\\rho_{AB}$：选取一个大小为 $(d_A d_B) \\times (d_A d_B)$ 的随机复矩阵 $G$，设置 $X = G G^\\dagger$，并归一化 $\\rho_{AB} = X/\\mathrm{Tr}(X)$。在 $\\mathcal{H}_A$ 上选择一个随机的厄米算符 $O_A$。\n- 情况 4（在较大的 A 上的乘积纯态）：$d_A = 3$，$d_B = 2$。构建随机归一化向量 $|\\phi_A\\rangle \\in \\mathcal{H}_A$ 和 $|\\phi_B\\rangle \\in \\mathcal{H}_B$，设置 $|\\psi\\rangle = |\\phi_A\\rangle \\otimes |\\phi_B\\rangle$，以及 $\\rho_{AB} = |\\psi\\rangle\\langle\\psi|$。在 $\\mathcal{H}_A$ 上选择一个随机的厄米算符 $O_A$。\n- 情况 5（边缘情况，平凡环境）：$d_A = 4$，$d_B = 1$。如情况 3 那样，通过 Ginibre 系综构建一个随机混合态 $\\rho_{AB}$。在 $\\mathcal{H}_A$ 上选择一个随机的厄米算符 $O_A$。\n\n对于每个测试用例，你的程序必须按顺序输出一个包含三个布尔值的列表：$[$trace\\_preserved$, $positive$, $expectation\\_consistent$]$。将所有测试用例的结果聚合到单行中。你的程序应生成单行输出，其中包含一个由逗号分隔的列表组成的列表，并用方括号括起来（例如，$[[ \\mathrm{True},\\mathrm{True},\\mathrm{True}],[ \\mathrm{True},\\mathrm{True},\\mathrm{True}],\\dots]$）。程序必须完全独立，无需用户输入。",
            "solution": "所提出的问题是开发并验证量子力学中偏迹运算的数值实现。这是研究开放量子系统和量子信息论中的一个基本步骤。在进行解答之前，经过严格的验证，确认该问题具有科学依据、是良定的且客观的。它准确地描述了密度算符和偏迹的性质，提供了一套清晰且计算上可行的任务，并使用了标准的、无歧义的科学术语。所有必要的参数，包括系统维度、状态构建协议、数值容差和随机数生成器种子，都已明确指定。因此，该问题被认为是有效的。\n\n问题的核心在于从复合系统 $AB$ 的密度算符 $\\rho_{AB}$ 计算子系统 $A$ 的约化密度算符 $\\rho_A$。复合系统的希尔伯特空间是各个独立希尔伯特空间的张量积，$\\mathcal{H}_{AB} = \\mathcal{H}_A \\otimes \\mathcal{H}_B$，其各自的维度为 $d_{AB} = d_A \\cdot d_B$、$d_A$ 和 $d_B$。偏迹，记作 $\\mathrm{Tr}_B$，是连接全局状态与局域可观测量之间的唯一线性映射。$\\mathcal{H}_A$ 上的一个算符 $O_A$ 在 $\\mathcal{H}_{AB}$ 上有一个等价表示 $O_A \\otimes I_B$，其中 $I_B$ 是 $\\mathcal{H}_B$ 上的单位算符。约化密度算符 $\\rho_A = \\mathrm{Tr}_B(\\rho_{AB})$ 的定义要求是，它能正确地复现子系统 $A$ 上所有局域可观测量 $O_A$ 的期望值：\n$$\n\\mathrm{Tr}_A(O_A \\rho_A) = \\mathrm{Tr}_{AB}((O_A \\otimes I_B) \\rho_{AB})\n$$\n对于 $\\mathcal{H}_A$ 上的任何算符 $O_A$ 均成立。\n\n为了设计一个数值算法，我们将这个定义在一个计算基中表示。令 $\\{|i_A\\rangle\\}_{i=0}^{d_A-1}$ 为 $\\mathcal{H}_A$ 的一个标准正交基，$\\{|k_B\\rangle\\}_{k=0}^{d_B-1}$ 为 $\\mathcal{H}_B$ 的一个标准正交基。复合空间 $\\mathcal{H}_{AB}$ 的一个基由张量积 $\\{|i_A\\rangle \\otimes |k_B\\rangle\\}$ 给出。该基的一个标准排序将索引对 $(i_A, k_B)$ 映射到单个索引 $m = i_A \\cdot d_B + k_B$。\n\n约化密度算符 $\\rho_A$ 在 $\\mathcal{H}_A$ 基下的矩阵元由下式给出：\n$$\n(\\rho_A)_{i_A, j_A} = \\langle i_A | \\rho_A | j_A \\rangle\n$$\n使用偏迹的定义，可以将其展开为：\n$$\n(\\rho_A)_{i_A, j_A} = \\mathrm{Tr}_A(|j_A\\rangle\\langle i_A| \\rho_A) = \\mathrm{Tr}_{AB}((|j_A\\rangle\\langle i_A| \\otimes I_B) \\rho_{AB})\n$$\n我们可以通过对 $\\mathcal{H}_{AB}$ 的基求和来表示右边的迹：\n$$\n(\\rho_A)_{i_A, j_A} = \\sum_{l_A=0}^{d_A-1} \\sum_{k_B=0}^{d_B-1} \\langle l_A, k_B | (|j_A\\rangle\\langle i_A| \\otimes I_B) \\rho_{AB} | l_A, k_B \\rangle\n$$\n使用性质 $\\langle l_A, k_B | = \\langle l_A | \\otimes \\langle k_B |$ 和算符张量积的定义，我们得到：\n$$\n(\\rho_A)_{i_A, j_A} = \\sum_{l_A=0}^{d_A-1} \\sum_{k_B=0}^{d_B-1} (\\langle l_A |j_A\\rangle\\langle i_A| l_A \\rangle) \\otimes (\\langle k_B | I_B | k_B \\rangle) \\cdot \\langle l_A, k_B | \\rho_{AB} | l_A, k_B \\rangle\n$$\n基向量的内积是克罗内克 δ 函数：$\\langle l_A|j_A\\rangle = \\delta_{l_A, j_A}$ 和 $\\langle i_A|l_A\\rangle = \\delta_{i_A, l_A}$。并且，$\\langle k_B | I_B | k_B \\rangle = \\langle k_B | k_B \\rangle = 1$。由于这些 δ 函数，对 $l_A$ 的求和会坍缩，强制 $l_A = i_A$ 且 $l_A = j_A$，这仅在 $i_A = j_A$ 时才可能。一个更直接的计算来自：\n$$\n(\\rho_A)_{i_A, j_A} = \\sum_{k_B=0}^{d_B-1} \\langle i_A, k_B | \\rho_{AB} | j_A, k_B \\rangle\n$$\n这为 $\\rho_A$ 的矩阵元提供了一个直接的公式。用矩阵索引表示，其中复合索引为 $m = i \\cdot d_B + k$，该公式变为：\n$$\n(\\rho_A)_{i,j} = \\sum_{k=0}^{d_B-1} (\\rho_{AB})_{i \\cdot d_B + k, j \\cdot d_B + k}\n$$\n这个公式表明，$\\rho_A$ 的第 $(i,j)$ 个元素是 $\\rho_{AB}$ 特定子矩阵对角线元素之和。如果我们将 $\\rho_{AB}$ 视为一个 $d_A \\times d_A$ 的块矩阵，其中每个块都是一个 $d_B \\times d_B$ 的矩阵，那么第 $(i,j)$ 个块对应于连接子系统 $A$ 的扇区 $i$ 和 $j$ 的算符分量。偏迹操作等效于取这些 $d_B \\times d_B$ 块中每一个的迹：$(\\rho_A)_{i,j} = \\mathrm{Tr}((\\rho_{AB})_{\\text{block } i,j})$。这就是所提供代码中实现的算法。\n\n程序将系统地执行五个测试用例。对于每个用例，它将：\n1.  根据指定规则（随机纯态、贝尔态、随机混合态或乘积态）构建 $d_{AB} \\times d_{AB}$ 的密度矩阵 $\\rho_{AB}$。所有随机构建都将使用种子 $1729$ 以保证可复现性。\n2.  构建 $d_A \\times d_A$ 的局域可观测量 $O_A$。\n3.  通过实现上述的块求迹算法，计算 $d_A \\times d_A$ 的约化密度矩阵 $\\rho_A$。\n4.  在 $\\epsilon = 10^{-10}$ 的数值容差内验证三个基本不变量：\n    a.  **迹保持性**：检查是否 $|\\mathrm{Tr}(\\rho_A) - 1| \\le \\epsilon$。一个物理上有效的密度矩阵的迹必须为 $1$。\n    b.  **正定性**：检查 $\\rho_A$ 是否为半正定。这通过计算 $\\rho_A$ 的特征值（由于 $\\rho_A$ 是厄米矩阵，其特征值必须为实数）并确保它们都大于或等于 $-\\epsilon$ 来进行验证。\n    c.  **局域期望值一致性**：检查是否 $|\\mathrm{Tr}(O_A \\rho_A) - \\mathrm{Tr}((O_A \\otimes I_B) \\rho_{AB})| \\le \\epsilon$。这是偏迹的定义属性。\n\n程序将每个测试用例的这三个检查的布尔结果聚合成一个最终列表，作为结论性输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs bipartite quantum states, computes the reduced density operator\n    via partial trace, and verifies its fundamental properties.\n    \"\"\"\n    \n    # Set the random seed for reproducibility as required.\n    SEED = 1729\n    rng = np.random.default_rng(SEED)\n    \n    # Define the numerical tolerance for all checks.\n    TOL = 1e-10\n\n    # --- Helper functions for state and operator construction ---\n    \n    def get_random_pure_state(dim, generator):\n        \"\"\"Generates a random normalized pure state vector in a complex Hilbert space.\"\"\"\n        # Generate a random complex vector.\n        psi = generator.random(dim, dtype=np.float64) + 1j * generator.random(dim, dtype=np.float64)\n        # Normalize it.\n        norm = np.linalg.norm(psi)\n        return psi / norm\n\n    def get_random_hermitian_operator(dim, generator):\n        \"\"\"Generates a random Hermitian operator.\"\"\"\n        # Generate a random complex matrix.\n        M = generator.random((dim, dim), dtype=np.float64) + 1j * generator.random((dim, dim), dtype=np.float64)\n        # Symmetrize to make it Hermitian: O = M + M^dagger\n        return M + M.conj().T\n\n    def get_random_mixed_state(dim, generator):\n        \"\"\"Generates a random mixed density operator from a Ginibre ensemble.\"\"\"\n        # Generate a random complex matrix G.\n        G = generator.random((dim, dim), dtype=np.float64) + 1j * generator.random((dim, dim), dtype=np.float64)\n        # Construct a positive semidefinite matrix X = G * G^dagger.\n        X = G @ G.conj().T\n        # Normalize to ensure Tr(rho) = 1.\n        trace_X = np.trace(X)\n        if trace_X > TOL:\n            return X / trace_X\n        else:\n            # Fallback for the unlikely case of a zero-trace matrix\n            return np.eye(dim) / dim\n\n    # --- Core partial trace implementation ---\n\n    def partial_trace(rho_ab, dA, dB):\n        \"\"\"\n        Computes the partial trace Tr_B(rho_ab) over subsystem B.\n        rho_ab: Density matrix of the composite system AB of size (dA*dB, dA*dB).\n        dA: Dimension of subsystem A.\n        dB: Dimension of subsystem B.\n        \"\"\"\n        # rho_A will be a dA x dA matrix. Initialize with zeros.\n        rho_a = np.zeros((dA, dA), dtype=np.complex128)\n        \n        # We view rho_ab as a dA x dA block matrix, where each block is dB x dB.\n        # The (i,j)-th element of rho_a is the trace of the (i,j)-th block of rho_ab.\n        for i in range(dA):\n            for j in range(dA):\n                # Extract the (i,j)-th block.\n                # The block starts at row i*dB and column j*dB.\n                block = rho_ab[i*dB:(i+1)*dB, j*dB:(j+1)*dB]\n                \n                # Compute the trace of the block and assign it to rho_a[i,j].\n                rho_a[i, j] = np.trace(block)\n                \n        return rho_a\n\n    # --- Test suite definition ---\n\n    test_cases = [\n        {'case_name': 'Random pure state', 'dA': 2, 'dB': 2},\n        {'case_name': 'Maximally entangled Bell state', 'dA': 2, 'dB': 2},\n        {'case_name': 'Random mixed state, asymmetric', 'dA': 2, 'dB': 3},\n        {'case_name': 'Product pure state', 'dA': 3, 'dB': 2},\n        {'case_name': 'Trivial environment', 'dA': 4, 'dB': 1},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        dA = case['dA']\n        dB = case['dB']\n        dAB = dA * dB\n        \n        # --- 1. Construct rho_ab and O_a for the current case ---\n        \n        if case['case_name'] == 'Random pure state':\n            psi_ab = get_random_pure_state(dAB, rng)\n            rho_ab = np.outer(psi_ab, np.conj(psi_ab))\n            O_a = get_random_hermitian_operator(dA, rng)\n            \n        elif case['case_name'] == 'Maximally entangled Bell state':\n            # |psi> = (|00> + |11>)/sqrt(2)\n            # |00> is [1,0,0,0], |11> is [0,0,0,1]\n            psi_ab = np.array([1, 0, 0, 1], dtype=np.complex128) / np.sqrt(2)\n            rho_ab = np.outer(psi_ab, np.conj(psi_ab))\n            # O_a is the Pauli-Z operator\n            O_a = np.diag([1, -1]).astype(np.complex128)\n\n        elif case['case_name'] == 'Random mixed state, asymmetric':\n            rho_ab = get_random_mixed_state(dAB, rng)\n            O_a = get_random_hermitian_operator(dA, rng)\n\n        elif case['case_name'] == 'Product pure state':\n            psi_a = get_random_pure_state(dA, rng)\n            psi_b = get_random_pure_state(dB, rng)\n            psi_ab = np.kron(psi_a, psi_b)\n            rho_ab = np.outer(psi_ab, np.conj(psi_ab))\n            O_a = get_random_hermitian_operator(dA, rng)\n\n        elif case['case_name'] == 'Trivial environment':\n            # When dB=1, H_AB is isomorphic to H_A. rho_ab is already dA x dA.\n            rho_ab = get_random_mixed_state(dAB, rng)\n            O_a = get_random_hermitian_operator(dA, rng)\n        \n        # --- 2. Compute the reduced density operator ---\n        \n        rho_a = partial_trace(rho_ab, dA, dB)\n        \n        # --- 3. Verify the three invariants ---\n        \n        case_results = []\n\n        # a. Trace preservation: Tr(rho_a) == 1\n        trace_val = np.trace(rho_a)\n        trace_preserved = np.isclose(trace_val, 1.0, atol=TOL)\n        case_results.append(bool(trace_preserved))\n        \n        # b. Positivity: rho_a >= 0 (all eigenvalues must be non-negative)\n        # Use eigvalsh for Hermitian matrices for better performance and stability.\n        eigenvalues = np.linalg.eigvalsh(rho_a)\n        positive = np.all(eigenvalues >= -TOL)\n        case_results.append(bool(positive))\n        \n        # c. Local expectation consistency: Tr(O_a * rho_a) == Tr((O_a x I_b) * rho_ab)\n        # Identity operator on subsystem B\n        I_b = np.eye(dB)\n        # Form O_a (tensor) I_b\n        O_ab = np.kron(O_a, I_b)\n        \n        exp_val_a = np.trace(O_a @ rho_a)\n        exp_val_ab = np.trace(O_ab @ rho_ab)\n        \n        expectation_consistent = np.isclose(exp_val_a, exp_val_ab, atol=TOL)\n        case_results.append(bool(expectation_consistent))\n        \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # str() on a list [True, True] gives '[True, True]'.\n    # ','.join() combines these strings.\n    # The outer brackets complete the format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}