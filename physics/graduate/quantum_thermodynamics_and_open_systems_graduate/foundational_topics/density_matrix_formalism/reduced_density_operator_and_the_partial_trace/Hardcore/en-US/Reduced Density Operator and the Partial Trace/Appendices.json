{
    "hands_on_practices": [
        {
            "introduction": "This first exercise is a foundational practice in computing the reduced density operator. Starting with a general pure bipartite state, you will perform the partial trace operation explicitly to find the state of the subsystem . The exercise then explores the effect of local unitary operations, illustrating the crucial principle that the eigenvalues of the reduced density operator—which determine the entanglement entropy—are invariant under such transformations.",
            "id": "3783151",
            "problem": "Consider an open quantum system $S$ coupled to an environment $E$, each modeled as a two-level system with computational bases $\\{|0\\rangle_{S},|1\\rangle_{S}\\}$ and $\\{|0\\rangle_{E},|1\\rangle_{E}\\}$, respectively. The joint state is pure and given by\n$$\n|\\Psi\\rangle = \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E},\n$$\nwhere $0<p<1$ and $\\phi\\in[0,2\\pi)$. The composite density operator is $\\rho_{SE} = |\\Psi\\rangle\\langle\\Psi|$. The reduced density operator of the system is defined by the partial trace over the environment,\n$$\n\\rho_{S} = \\operatorname{Tr}_{E}\\big(\\rho_{SE}\\big) = \\sum_{j=0}^{1} \\big(\\langle j|_{E} \\otimes \\mathbb{I}_{S}\\big)\\,\\rho_{SE}\\,\\big(|j\\rangle_{E} \\otimes \\mathbb{I}_{S}\\big),\n$$\nwhere $\\mathbb{I}_{S}$ is the identity on $S$.\n\nNow consider the action of local unitary transformations on $S$ and $E$ given by\n$$\nU_{S}(\\theta) = \\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta\\\\\n\\sin\\theta & \\cos\\theta\n\\end{pmatrix}, \\qquad\nV_{E}(\\vartheta) = \\begin{pmatrix}\n\\cos\\vartheta & \\sin\\vartheta\\\\\n-\\sin\\vartheta & \\cos\\vartheta\n\\end{pmatrix},\n$$\nwith real parameters $\\theta,\\vartheta\\in\\mathbb{R}$. The transformed joint state is $|\\Psi'\\rangle = \\big(U_{S}(\\theta)\\otimes V_{E}(\\vartheta)\\big)|\\Psi\\rangle$, with transformed joint density operator $\\rho'_{SE} = |\\Psi'\\rangle\\langle\\Psi'|$. The reduced state after the local unitaries is $\\rho'_{S} = \\operatorname{Tr}_{E}\\big(\\rho'_{SE}\\big)$.\n\nStarting only from the definitions of density operators and the partial trace, and basic linear-algebraic properties of unitary matrices, perform the following:\n\n1. Compute $\\rho_{S}$ explicitly in the computational basis of $S$ by tracing out $E$ from $\\rho_{SE}$.\n2. Derive the expression for $\\rho'_{S}$ in terms of $\\rho_{S}$, $U_{S}(\\theta)$, and $V_{E}(\\vartheta)$.\n3. From first principles, justify how local unitaries $\\mathbb{I}_{S}\\otimes V_{E}(\\vartheta)$ change the Schmidt basis on $E$ without altering the eigenvalues of $\\rho_{S}$, and how $U_{S}(\\theta)\\otimes \\mathbb{I}_{E}$ changes the basis of $\\rho_{S}$ without changing its eigenvalues.\n4. Provide the ordered pair of eigenvalues of $\\rho'_{S}$ as a closed-form analytic expression in terms of $p$.\n\nYour final answer must be the pair of eigenvalues presented as a single row matrix using the $\\mathrm{pmatrix}$ environment. No numerical rounding is needed and no units are required.",
            "solution": "The problem is well-posed, scientifically grounded, and presents a standard exercise in the formalism of open quantum systems. It is therefore deemed valid and a full solution will be provided. The solution proceeds by executing the four tasks as stated.\n\n1.  **Computation of the reduced density operator $\\rho_{S}$**\n\nThe composite system $S+E$ is in the pure state $|\\Psi\\rangle$ given by\n$$\n|\\Psi\\rangle = \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E}\n$$\nThe corresponding density operator for the composite system is $\\rho_{SE} = |\\Psi\\rangle\\langle\\Psi|$. Expanding this expression, we obtain:\n$$\n\\rho_{SE} = \\left( \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E} \\right) \\left( \\sqrt{p}\\,\\langle0|_{S}\\otimes\\langle0|_{E} + \\sqrt{1-p}\\,\\exp(-i\\phi)\\,\\langle1|_{S}\\otimes\\langle1|_{E} \\right)\n$$\n$$\n\\rho_{SE} = p\\,|0\\rangle_{S}\\langle0|_{S} \\otimes |0\\rangle_{E}\\langle0|_{E} + (1-p)\\,|1\\rangle_{S}\\langle1|_{S} \\otimes |1\\rangle_{E}\\langle1|_{E} + \\sqrt{p(1-p)}\\exp(i\\phi)\\,|1\\rangle_{S}\\langle0|_{S} \\otimes |1\\rangle_{E}\\langle0|_{E} + \\sqrt{p(1-p)}\\exp(-i\\phi)\\,|0\\rangle_{S}\\langle1|_{S} \\otimes |0\\rangle_{E}\\langle1|_{E}\n$$\nThe reduced density operator for system $S$, denoted $\\rho_{S}$, is obtained by performing a partial trace over the environment $E$. Using the definition provided, $\\rho_{S} = \\operatorname{Tr}_{E}(\\rho_{SE}) = \\sum_{j=0}^{1} \\langle j|_{E} \\rho_{SE} |j\\rangle_{E}$, where for brevity we omit the identity operator $\\mathbb{I}_{S}$ as its action is implicit.\n\nFor $j=0$:\n$$\n\\langle 0|_{E} \\rho_{SE} |0\\rangle_{E} = \\langle 0|_{E} \\left( p\\,|0\\rangle_{S}\\langle0|_{S} \\otimes |0\\rangle_{E}\\langle0|_{E} + \\dots \\right) |0\\rangle_{E}\n$$\nThe inner products involving the states of $E$ are $\\langle 0|_{E}|0\\rangle_{E}=1$ and $\\langle 0|_{E}|1\\rangle_{E}=0$. Consequently, only the first term of $\\rho_{SE}$ survives this projection.\n$$\n\\langle 0|_{E} \\rho_{SE} |0\\rangle_{E} = p\\,|0\\rangle_{S}\\langle0|_{S} \\cdot \\langle 0|_{E}|0\\rangle_{E}\\langle0|_{E}|0\\rangle_{E} = p\\,|0\\rangle_{S}\\langle0|_{S}\n$$\nFor $j=1$:\n$$\n\\langle 1|_{E} \\rho_{SE} |1\\rangle_{E} = \\langle 1|_{E} \\left( \\dots + (1-p)\\,|1\\rangle_{S}\\langle1|_{S} \\otimes |1\\rangle_{E}\\langle1|_{E} + \\dots \\right) |1\\rangle_{E}\n$$\nSimilarly, due to the orthogonality condition $\\langle 1|_{E}|0\\rangle_{E}=0$, only the second term of $\\rho_{SE}$ survives.\n$$\n\\langle 1|_{E} \\rho_{SE} |1\\rangle_{E} = (1-p)\\,|1\\rangle_{S}\\langle1|_{S} \\cdot \\langle 1|_{E}|1\\rangle_{E}\\langle1|_{E}|1\\rangle_{E} = (1-p)\\,|1\\rangle_{S}\\langle1|_{S}\n$$\nThe cross terms vanish because they involve terms like $|1\\rangle_{E}\\langle0|_{E}$, which result in inner products like $\\langle 0|_{E}|1\\rangle_{E}\\langle0|_{E}|0\\rangle_{E} = 0$ or $\\langle 1|_{E}|0\\rangle_{E}\\langle1|_{E}|1\\rangle_{E} = 0$.\nSumming the contributions for $j=0$ and $j=1$:\n$$\n\\rho_{S} = p\\,|0\\rangle_{S}\\langle0|_{S} + (1-p)\\,|1\\rangle_{S}\\langle1|_{S}\n$$\nIn the computational basis $\\{|0\\rangle_{S}, |1\\rangle_{S}\\}$, this corresponds to the matrix:\n$$\n\\rho_{S} = \\begin{pmatrix} p & 0 \\\\ 0 & 1-p \\end{pmatrix}\n$$\n\n2.  **Derivation of the transformed reduced density operator $\\rho'_{S}$**\n\nThe transformed joint density operator is $\\rho'_{SE} = |\\Psi'\\rangle\\langle\\Psi'|$, where $|\\Psi'\\rangle = (U_{S}\\otimes V_{E})|\\Psi\\rangle$. Thus,\n$$\n\\rho'_{SE} = (U_{S}\\otimes V_{E})|\\Psi\\rangle\\langle\\Psi|(U_{S}^{\\dagger}\\otimes V_{E}^{\\dagger}) = (U_{S}\\otimes V_{E})\\rho_{SE}(U_{S}^{\\dagger}\\otimes V_{E}^{\\dagger})\n$$\nThe transformed reduced state is $\\rho'_{S} = \\operatorname{Tr}_{E}(\\rho'_{SE})$.\n$$\n\\rho'_{S} = \\operatorname{Tr}_{E}\\left[ (U_{S}\\otimes V_{E})\\rho_{SE}(U_{S}^{\\dagger}\\otimes V_{E}^{\\dagger}) \\right]\n$$\nThe partial trace is a linear map. Operators acting solely on system $S$ (like $U_{S}$ and $U_{S}^{\\dagger}$) can be factored out of the trace over $E$.\n$$\n\\rho'_{S} = U_{S} \\left( \\operatorname{Tr}_{E}\\left[ (\\mathbb{I}_{S}\\otimes V_{E})\\rho_{SE}(\\mathbb{I}_{S}\\otimes V_{E}^{\\dagger}) \\right] \\right) U_{S}^{\\dagger}\n$$\nLet us evaluate the expression inside the parentheses. Let $\\{|k\\rangle_{E}\\}$ be any orthonormal basis for the environment $E$.\n$$\n\\operatorname{Tr}_{E}\\left[ (\\mathbb{I}_{S}\\otimes V_{E})\\rho_{SE}(\\mathbb{I}_{S}\\otimes V_{E}^{\\dagger}) \\right] = \\sum_{k} \\langle k|_{E} (\\mathbb{I}_{S}\\otimes V_{E})\\rho_{SE}(\\mathbb{I}_{S}\\otimes V_{E}^{\\dagger}) |k\\rangle_{E}\n$$\n$$\n= \\sum_{k} (\\langle k|_{E}V_{E}) \\rho_{SE} (V_{E}^{\\dagger}|k\\rangle_{E})\n$$\nwhere we have omitted the identity operators for clarity. Since $V_{E}$ is a unitary operator, the set of states $\\{|k'\\rangle_{E}\\} \\equiv \\{V_{E}^{\\dagger}|k\\rangle_{E}\\}$ forms another orthonormal basis for $E$. The sum over $k$ is equivalent to a sum over $k'$.\n$$\n= \\sum_{k'} \\langle k'|_{E} \\rho_{SE} |k'\\rangle_{E} = \\operatorname{Tr}_{E}(\\rho_{SE}) = \\rho_{S}\n$$\nThis demonstrates that a local unitary operation on the environment does not change the reduced state of the system. Substituting this result back into the expression for $\\rho'_{S}$:\n$$\n\\rho'_{S} = U_{S} \\rho_{S} U_{S}^{\\dagger}\n$$\nThis is the expression for $\\rho'_{S}$ in terms of $\\rho_{S}$ and $U_{S}(\\theta)$. It is independent of $V_{E}(\\vartheta)$.\n\n3.  **Justification from first principles**\n\nThe initial state $|\\Psi\\rangle = \\sqrt{p}\\,|0\\rangle_{S}\\otimes|0\\rangle_{E} + \\sqrt{1-p}\\,\\exp(i\\phi)\\,|1\\rangle_{S}\\otimes|1\\rangle_{E}$ is a bipartite pure state. Its Schmidt decomposition is given by $|\\Psi\\rangle = \\sum_{k} \\sqrt{\\lambda_k} |u_k\\rangle_S \\otimes |v_k\\rangle_E$, where $\\{|u_k\\rangle_S\\}$ and $\\{|v_k\\rangle_E\\}$ are orthonormal bases for $S$ and $E$ respectively, and $\\sqrt{\\lambda_k}$ are the Schmidt coefficients. For the given state, the Schmidt coefficients are $\\sqrt{\\lambda_0}=\\sqrt{p}$ and $\\sqrt{\\lambda_1}=\\sqrt{1-p}$. The corresponding Schmidt bases are $\\{|u_0\\rangle_S, |u_1\\rangle_S\\} = \\{|0\\rangle_S, |1\\rangle_S\\}$ and $\\{|v_0\\rangle_E, |v_1\\rangle_E\\} = \\{|0\\rangle_E, \\exp(i\\phi)|1\\rangle_E\\}$.\n\nThe reduced density operator $\\rho_{S}$ can be expressed directly from the Schmidt decomposition as $\\rho_{S} = \\sum_{k} \\lambda_k |u_k\\rangle_S \\langle u_k|_S$. The eigenvalues of $\\rho_{S}$ are the Schmidt coefficients squared, $\\{\\lambda_k\\} = \\{p, 1-p\\}$, and its eigenvectors are the Schmidt basis vectors for $S$, $\\{|u_k\\rangle_S\\}$.\n\nAction of $\\mathbb{I}_{S}\\otimes V_{E}(\\vartheta)$: The state transforms to $|\\Psi_{V}\\rangle = (\\mathbb{I}_{S}\\otimes V_{E})|\\Psi\\rangle = \\sum_{k}\\sqrt{\\lambda_k} |u_k\\rangle_S \\otimes (V_{E}|v_k\\rangle_E)$. Let $|v'_k\\rangle_E = V_{E}|v_k\\rangle_E$. Since $V_{E}$ is unitary, $\\{|v'_k\\rangle_E\\}$ is a new orthonormal basis for $E$. The state $|\\Psi_V\\rangle = \\sum_{k}\\sqrt{\\lambda_k} |u_k\\rangle_S \\otimes |v'_k\\rangle_E$ is the new Schmidt decomposition. The Schmidt coefficients $\\{\\sqrt{\\lambda_k}\\}$ and the S-basis $\\{|u_k\\rangle_S\\}$ are unchanged. Since the eigenvalues of $\\rho_S$ are determined solely by the Schmidt coefficients, they remain unaltered. This operation only changes the Schmidt basis on $E$.\n\nAction of $U_{S}(\\theta)\\otimes \\mathbb{I}_{E}$: The state transforms to $|\\Psi_{U}\\rangle = (U_{S}\\otimes \\mathbb{I}_{E})|\\Psi\\rangle = \\sum_{k}\\sqrt{\\lambda_k} (U_{S}|u_k\\rangle_S) \\otimes |v_k\\rangle_E$. Let $|u'_k\\rangle_S = U_{S}|u_k\\rangle_S$. Since $U_{S}$ is unitary, $\\{|u'_k\\rangle_S\\}$ is a new orthonormal basis for $S$. The state $|\\Psi_U\\rangle = \\sum_{k}\\sqrt{\\lambda_k} |u'_k\\rangle_S \\otimes |v_k\\rangle_E$ is the new Schmidt decomposition. Again, the Schmidt coefficients $\\{\\sqrt{\\lambda_k}\\}$ are unchanged, meaning the eigenvalues of the reduced state of system $S$ are invariant. However, the Schmidt basis for $S$ has changed. The new reduced operator is $\\rho'_S = \\sum_k \\lambda_k |u'_k\\rangle_S \\langle u'_k|_S = \\sum_k \\lambda_k U_S|u_k\\rangle_S \\langle u_k|_S U_S^\\dagger = U_S(\\sum_k \\lambda_k |u_k\\rangle_S \\langle u_k|_S)U_S^\\dagger = U_S \\rho_S U_S^\\dagger$. This is a unitary similarity transformation, which is a change of basis that preserves the eigenvalues of the operator.\n\n4.  **Eigenvalues of $\\rho'_{S}$**\n\nFrom the derivation in part 2, we have $\\rho'_{S} = U_{S} \\rho_{S} U_{S}^{\\dagger}$. This relationship indicates that $\\rho'_{S}$ and $\\rho_{S}$ are related by a unitary similarity transformation. A fundamental theorem of linear algebra states that similarity transformations preserve the eigenvalues of a matrix. Therefore, the eigenvalues of $\\rho'_{S}$ are identical to the eigenvalues of $\\rho_S$.\n\nFrom part 1, we computed $\\rho_{S}$ in its diagonal representation:\n$$\n\\rho_{S} = \\begin{pmatrix} p & 0 \\\\ 0 & 1-p \\end{pmatrix}\n$$\nThe eigenvalues of a diagonal matrix are its diagonal elements. Thus, the eigenvalues of $\\rho_{S}$ are $\\lambda_1 = p$ and $\\lambda_2 = 1-p$.\nConsequently, the eigenvalues of $\\rho'_{S}$ are also $p$ and $1-p$. The parameters $\\theta$, $\\vartheta$, and $\\phi$ do not affect the spectrum of the reduced density operator, which is a key result in the study of entanglement and local operations.\nThe ordered pair of eigenvalues is $(p, 1-p)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} p & 1-p \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building upon the basic calculation, this problem scales up the complexity to a qutrit-qubit system, which is represented by a larger $6 \\times 6$ density matrix. You are first tasked with deriving the specific index-summation formula for the partial trace from its fundamental definition, connecting the abstract theory to a concrete computational recipe . Applying this formula to a given state reinforces the block-matrix interpretation of the partial trace and hones the skills needed to analyze higher-dimensional quantum systems.",
            "id": "3783121",
            "problem": "Consider a composite quantum system consisting of a three-level system (qutrit) $S$ with Hilbert space $\\mathcal{H}_{S}$ of dimension $3$ and a two-level environment (qubit) $E$ with Hilbert space $\\mathcal{H}_{E}$ of dimension $2$. The joint space is $\\mathcal{H}_{S} \\otimes \\mathcal{H}_{E}$ of dimension $6$. Work in the computational product basis ordered lexicographically as\n$$\n|0\\rangle \\otimes |0\\rangle,\\; |0\\rangle \\otimes |1\\rangle,\\; |1\\rangle \\otimes |0\\rangle,\\; |1\\rangle \\otimes |1\\rangle,\\; |2\\rangle \\otimes |0\\rangle,\\; |2\\rangle \\otimes |1\\rangle,\n$$\nand encode basis kets $|s\\rangle \\otimes |e\\rangle$ by the composite index $i = 2 s + e$ with $s \\in \\{0,1,2\\}$ and $e \\in \\{0,1\\}$.\n\nStart from the defining property of the partial trace over the environment,\n$$\n\\mathrm{Tr}_{S}\\!\\left[ A_{S}\\, \\mathrm{Tr}_{E}(\\rho_{SE}) \\right] \\;=\\; \\mathrm{Tr}_{S \\otimes E}\\!\\left[ (A_{S} \\otimes I_{E})\\, \\rho_{SE} \\right]\n$$\nfor all bounded operators $A_{S}$ on $\\mathcal{H}_{S}$, and derive explicit index-summation formulas for the matrix elements of the reduced density operator $\\rho_{S} = \\mathrm{Tr}_{E}(\\rho_{SE})$ in the $S$-basis, expressed in terms of the entries of the $6 \\times 6$ matrix of $\\rho_{SE}$ in the above product basis.\n\nThen, using your derived summation formulas, perform the partial trace over $E$ for the following explicit joint state $\\rho_{SE}$ given in the ordered basis above by\n$$\n\\rho_{SE} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{4} & 0 & \\frac{1}{4} & 0 & 0 & \\frac{1}{2\\sqrt{2}} \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n\\frac{1}{4} & 0 & \\frac{1}{4} & 0 & 0 & \\frac{1}{2\\sqrt{2}} \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n\\frac{1}{2\\sqrt{2}} & 0 & \\frac{1}{2\\sqrt{2}} & 0 & 0 & \\frac{1}{2}\n\\end{pmatrix}.\n$$\n\nFinally, compute the system purity\n$$\n\\gamma \\;=\\; \\mathrm{Tr}\\!\\left( \\rho_{S}^{2} \\right).\n$$\n\nProvide your final answer as a single exact number. Do not round. Do not include units. The final answer must be the value of $\\gamma$ only.",
            "solution": "The problem is assessed to be valid as it is mathematically and scientifically sound, well-posed, and all necessary information is provided. It concerns standard, verifiable concepts in quantum information theory.\n\nOur first task is to derive the index-summation formula for the partial trace. We begin with the defining relation for the reduced density operator $\\rho_S = \\mathrm{Tr}_E(\\rho_{SE})$:\n$$\n\\mathrm{Tr}_{S}\\!\\left[ A_{S}\\, \\rho_{S} \\right] \\;=\\; \\mathrm{Tr}_{S \\otimes E}\\!\\left[ (A_{S} \\otimes I_{E})\\, \\rho_{SE} \\right]\n$$\nThis must hold for any bounded linear operator $A_S$ on the Hilbert space $\\mathcal{H}_S$. Let $\\{|s\\rangle\\}_{s=0,1,2}$ be the orthonormal basis for $\\mathcal{H}_S$ and $\\{|e\\rangle\\}_{e=0,1}$ be the orthonormal basis for $\\mathcal{H}_E$. The product basis for the composite space $\\mathcal{H}_{SE} = \\mathcal{H}_S \\otimes \\mathcal{H}_E$ is $\\{|s\\rangle \\otimes |e\\rangle\\}$, which we denote as $\\{|s,e\\rangle\\}$.\n\nWe express the left-hand side (LHS) in terms of matrix elements in the basis of $\\mathcal{H}_S$:\n$$\n\\mathrm{LHS} = \\mathrm{Tr}_{S}\\!\\left[ A_{S}\\, \\rho_{S} \\right] = \\sum_{s_1=0}^{2} \\langle s_1 | A_S \\rho_S | s_1 \\rangle = \\sum_{s_1=0}^{2} \\sum_{s_2=0}^{2} \\langle s_1 | A_S | s_2 \\rangle \\langle s_2 | \\rho_S | s_1 \\rangle\n$$\nLet the matrix elements be denoted $(A_S)_{s_1 s_2} = \\langle s_1 | A_S | s_2 \\rangle$ and $(\\rho_S)_{s_2 s_1} = \\langle s_2 | \\rho_S | s_1 \\rangle$. Then, $\\mathrm{LHS} = \\sum_{s_1,s_2} (A_S)_{s_1 s_2} (\\rho_S)_{s_2 s_1}$.\n\nNext, we express the right-hand side (RHS) in the basis of $\\mathcal{H}_{SE}$:\n$$\n\\mathrm{RHS} = \\mathrm{Tr}_{S \\otimes E}\\!\\left[ (A_{S} \\otimes I_{E})\\, \\rho_{SE} \\right] = \\sum_{s_1=0}^{2} \\sum_{e_1=0}^{1} \\langle s_1, e_1 | (A_S \\otimes I_E) \\rho_{SE} | s_1, e_1 \\rangle\n$$\nInserting a resolution of identity $I_{SE} = \\sum_{s_2, e_2} |s_2, e_2\\rangle \\langle s_2, e_2|$:\n$$\n\\mathrm{RHS} = \\sum_{s_1, e_1} \\sum_{s_2, e_2} \\langle s_1, e_1 | A_S \\otimes I_E | s_2, e_2 \\rangle \\langle s_2, e_2 | \\rho_{SE} | s_1, e_1 \\rangle\n$$\nThe matrix elements of the tensor product operator are $\\langle s_1, e_1 | A_S \\otimes I_E | s_2, e_2 \\rangle = \\langle s_1 | A_S | s_2 \\rangle \\langle e_1 | I_E | e_2 \\rangle = (A_S)_{s_1 s_2} \\delta_{e_1 e_2}$.\nSubstituting this into the expression for the RHS:\n$$\n\\mathrm{RHS} = \\sum_{s_1, e_1} \\sum_{s_2, e_2} (A_S)_{s_1 s_2} \\delta_{e_1 e_2} \\langle s_2, e_2 | \\rho_{SE} | s_1, e_1 \\rangle\n$$\nSumming over $e_2$ collapses the Kronecker delta:\n$$\n\\mathrm{RHS} = \\sum_{s_1, s_2} \\sum_{e_1} (A_S)_{s_1 s_2} \\langle s_2, e_1 | \\rho_{SE} | s_1, e_1 \\rangle\n$$\nEquating the LHS and RHS:\n$$\n\\sum_{s_1, s_2} (A_S)_{s_1 s_2} (\\rho_S)_{s_2 s_1} = \\sum_{s_1, s_2} (A_S)_{s_1 s_2} \\left( \\sum_{e_1=0}^{1} \\langle s_2, e_1 | \\rho_{SE} | s_1, e_1 \\rangle \\right)\n$$\nSince this equality must hold for an arbitrary operator $A_S$, the coefficients of $(A_S)_{s_1 s_2}$ on both sides must be equal. Thus, we identify:\n$$\n(\\rho_S)_{s_2 s_1} = \\sum_{e=0}^{1} \\langle s_2, e | \\rho_{SE} | s_1, e \\rangle\n$$\nThis is the desired index-summation formula for the matrix elements of the reduced density operator $\\rho_S$.\n\nNow, we apply this formula to the given $6 \\times 6$ density matrix $\\rho_{SE}$. The basis vectors are ordered $|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle, |20\\rangle, |21\\rangle$, corresponding to indices $0$ through $5$. The matrix index for a state $|s,e\\rangle$ is $i = 2s+e$. Therefore, a matrix element $\\langle s_1, e_1 | \\rho_{SE} | s_2, e_2 \\rangle$ corresponds to the entry $(\\rho_{SE})_{i,j}$ with $i = 2s_1+e_1$ and $j = 2s_2+e_2$.\nThe formula for the elements of $\\rho_S$ becomes:\n$$\n(\\rho_S)_{s_1 s_2} = \\langle s_1 | \\rho_S | s_2 \\rangle = \\sum_{e=0}^{1} \\langle s_1, e | \\rho_{SE} | s_2, e \\rangle = (\\rho_{SE})_{2s_1, 2s_2} + (\\rho_{SE})_{2s_1+1, 2s_2+1}\n$$\nWe compute the elements of the $3 \\times 3$ matrix $\\rho_S$:\n$(\\rho_S)_{00} = (\\rho_{SE})_{0,0} + (\\rho_{SE})_{1,1} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{01} = (\\rho_{SE})_{0,2} + (\\rho_{SE})_{1,3} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{02} = (\\rho_{SE})_{0,4} + (\\rho_{SE})_{1,5} = 0 + 0 = 0$\n$(\\rho_S)_{10} = (\\rho_{SE})_{2,0} + (\\rho_{SE})_{3,1} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{11} = (\\rho_{SE})_{2,2} + (\\rho_{SE})_{3,3} = \\frac{1}{4} + 0 = \\frac{1}{4}$\n$(\\rho_S)_{12} = (\\rho_{SE})_{2,4} + (\\rho_{SE})_{3,5} = 0 + 0 = 0$\n$(\\rho_S)_{20} = (\\rho_{SE})_{4,0} + (\\rho_{SE})_{5,1} = 0 + 0 = 0$\n$(\\rho_S)_{21} = (\\rho_{SE})_{4,2} + (\\rho_{SE})_{5,3} = 0 + 0 = 0$\n$(\\rho_S)_{22} = (\\rho_{SE})_{4,4} + (\\rho_{SE})_{5,5} = 0 + \\frac{1}{2} = \\frac{1}{2}$\n\nThe reduced density operator for system $S$ is:\n$$\n\\rho_{S} =\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n0 & 0 & \\frac{1}{2}\n\\end{pmatrix}\n$$\nThe trace is $\\mathrm{Tr}(\\rho_S) = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{2} = 1$, as required.\n\nFinally, we compute the purity $\\gamma = \\mathrm{Tr}(\\rho_S^2)$:\n$$\n\\rho_{S}^2 =\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n0 & 0 & \\frac{1}{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{1}{4} & 0 \\\\\n0 & 0 & \\frac{1}{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(\\frac{1}{4})^2 + (\\frac{1}{4})^2 & (\\frac{1}{4})^2 + (\\frac{1}{4})^2 & 0 \\\\\n(\\frac{1}{4})^2 + (\\frac{1}{4})^2 & (\\frac{1}{4})^2 + (\\frac{1}{4})^2 & 0 \\\\\n0 & 0 & (\\frac{1}{2})^2\n\\end{pmatrix}\n$$\n$$\n\\rho_{S}^2 =\n\\begin{pmatrix}\n\\frac{1}{16} + \\frac{1}{16} & \\frac{1}{16} + \\frac{1}{16} & 0 \\\\\n\\frac{1}{16} + \\frac{1}{16} & \\frac{1}{16} + \\frac{1}{16} & 0 \\\\\n0 & 0 & \\frac{1}{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{2}{16} & \\frac{2}{16} & 0 \\\\\n\\frac{2}{16} & \\frac{2}{16} & 0 \\\\\n0 & 0 & \\frac{1}{4}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{8} & \\frac{1}{8} & 0 \\\\\n\\frac{1}{8} & \\frac{1}{8} & 0 \\\\\n0 & 0 & \\frac{1}{4}\n\\end{pmatrix}\n$$\nThe purity is the trace of this matrix:\n$$\n\\gamma = \\mathrm{Tr}(\\rho_S^2) = \\frac{1}{8} + \\frac{1}{8} + \\frac{1}{4} = \\frac{2}{8} + \\frac{1}{4} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "This final practice transitions from analytical work to computational verification, a vital skill in modern quantum physics. You will implement the partial trace as a numerical algorithm and use it to test the fundamental properties that any valid reduced density operator must satisfy: trace preservation, positivity, and consistency of local expectation values . By constructing and testing a variety of bipartite states, this exercise provides a robust, hands-on confirmation of the theoretical framework.",
            "id": "3783109",
            "problem": "Consider a bipartite quantum system with Hilbert space $\\mathcal{H}_A \\otimes \\mathcal{H}_B$ of finite dimensions $d_A$ and $d_B$. A density operator $\\rho_{AB}$ on $\\mathcal{H}_A \\otimes \\mathcal{H}_B$ is a positive semidefinite operator of unit trace acting on the composite space. The reduced density operator on subsystem $A$, denoted $\\rho_A$, is defined via the partial trace over subsystem $B$ as the unique operator on $\\mathcal{H}_A$ satisfying the relation $\\operatorname{Tr}\\!\\left[(O_A \\otimes I_B)\\rho_{AB}\\right] = \\operatorname{Tr}\\!\\left[O_A \\rho_A\\right]$ for all operators $O_A$ on $\\mathcal{H}_A$, where $I_B$ is the identity operator on $\\mathcal{H}_B$. The operation $\\operatorname{Tr}_B$ denotes the partial trace over subsystem $B$. In the context of quantum thermodynamics and open quantum systems, the reduced density operator encodes all local statistics accessible on subsystem $A$ when the global system is in the state $\\rho_{AB}$.\n\nFundamentally, one must validate that any numerical implementation of the partial trace preserves core invariants required by the definition of a reduced density operator. These invariants include: preservation of trace, positivity, and consistency of local expectation values. More precisely:\n- Trace preservation: if $\\rho_{AB}$ has $\\operatorname{Tr}(\\rho_{AB}) = 1$, then the reduced density $\\rho_A = \\operatorname{Tr}_B(\\rho_{AB})$ must satisfy $\\operatorname{Tr}(\\rho_A) = 1$.\n- Positivity: if $\\rho_{AB} \\succeq 0$ (positive semidefinite), then $\\rho_A \\succeq 0$.\n- Local expectation consistency: for any operator $O_A$ acting on $\\mathcal{H}_A$, the equality $\\operatorname{Tr}\\!\\left[O_A \\rho_A\\right] = \\operatorname{Tr}\\!\\left[(O_A \\otimes I_B)\\rho_{AB}\\right]$ must hold.\n\nYour task is to write a complete, runnable program that constructs several bipartite states $\\rho_{AB}$, computes the reduced state $\\rho_A$ via a numerical partial trace over $B$, and verifies the three invariants listed above for each case within a specified numerical tolerance. The program must:\n- Implement a function that performs the partial trace $\\operatorname{Tr}_B$ for a given $\\rho_{AB}$ and dimensions $(d_A,d_B)$, using only linear algebraic operations on arrays and the definition of the partial trace.\n- Use a fixed pseudorandom number generator seed $1729$ so that all random constructions in the test suite are reproducible.\n- For each test case, construct an operator $O_A$ on $\\mathcal{H}_A$ and verify the equality of local expectation values $\\operatorname{Tr}\\!\\left[O_A \\rho_A\\right]$ and $\\operatorname{Tr}\\!\\left[(O_A \\otimes I_B) \\rho_{AB}\\right]$ within a numerical tolerance of $10^{-10}$.\n- Check positivity by ensuring that all eigenvalues of $\\rho_A$ are greater than or equal to $-10^{-10}$.\n- Check trace preservation by ensuring that $\\operatorname{Tr}(\\rho_A)$ equals $1$ within a tolerance of $10^{-10}$.\n\nNo physical units are involved in this problem.\n\nTest Suite:\n- Case $1$ (happy path, random pure state): $d_A = 2$, $d_B = 2$. Construct a random pure state $|\\psi\\rangle \\in \\mathcal{H}_A \\otimes \\mathcal{H}_B$ and set $\\rho_{AB} = |\\psi\\rangle\\langle\\psi|$. Choose a random Hermitian operator $O_A$ on $\\mathcal{H}_A$.\n- Case $2$ (boundary, maximally entangled Bell state): $d_A = 2$, $d_B = 2$. Use $|\\psi\\rangle = (|00\\rangle + |11\\rangle)/\\sqrt{2}$, so $\\rho_{AB} = |\\psi\\rangle\\langle\\psi|$. Let $O_A$ be the Pauli-$Z$ operator on $\\mathcal{H}_A$, represented by the matrix $\\mathrm{diag}(1,-1)$.\n- Case $3$ (random mixed state on asymmetric dimensions): $d_A = 2$, $d_B = 3$. Construct a random mixed state $\\rho_{AB}$ via a Ginibre ensemble: pick a random complex matrix $G$ of size $(d_A d_B) \\times (d_A d_B)$, set $X = G G^\\dagger$, and normalize $\\rho_{AB} = X/\\operatorname{Tr}(X)$. Choose a random Hermitian operator $O_A$ on $\\mathcal{H}_A$.\n- Case $4$ (product pure state on larger $A$): $d_A = 3$, $d_B = 2$. Construct random normalized vectors $|\\phi_A\\rangle \\in \\mathcal{H}_A$ and $|\\phi_B\\rangle \\in \\mathcal{H}_B$, set $|\\psi\\rangle = |\\phi_A\\rangle \\otimes |\\phi_B\\rangle$, and $\\rho_{AB} = |\\psi\\rangle\\langle\\psi|$. Choose a random Hermitian operator $O_A$ on $\\mathcal{H}_A$.\n- Case $5$ (edge, trivial environment): $d_A = 4$, $d_B = 1$. Construct a random mixed state $\\rho_{AB}$ via the Ginibre ensemble as in Case $3$. Choose a random Hermitian operator $O_A$ on $\\mathcal{H}_A$.\n\nFor each test case, your program must output a list of three booleans in the order: $[$trace\\_preserved$, $positive$, $expectation\\_consistent$]$. Aggregate the results of all test cases into a single line. Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets (e.g., $[[\\mathrm{True},\\mathrm{True},\\mathrm{True}],[\\mathrm{True},\\mathrm{True},\\mathrm{True}],\\dots]$). The program must be entirely self-contained and require no user input.",
            "solution": "The problem posed is to develop and verify a numerical implementation of the partial trace operation in quantum mechanics. This is a fundamental procedure in the study of open quantum systems and quantum information theory. Before proceeding to the solution, a rigorous validation confirms that the problem is scientifically grounded, well-posed, and objective. It accurately describes the properties of density operators and the partial trace, provides a clear and computationally feasible set of tasks, and uses standard, unambiguous scientific terminology. All necessary parameters, including system dimensions, state construction protocols, numerical tolerances, and the random number generator seed, are specified. The problem is therefore deemed valid.\n\nThe core of the problem lies in computing the reduced density operator $\\rho_A$ of a subsystem $A$ from the density operator $\\rho_{AB}$ of a composite system $AB$. The Hilbert space of the composite system is the tensor product of the individual Hilbert spaces, $\\mathcal{H}_{AB} = \\mathcal{H}_A \\otimes \\mathcal{H}_B$, with respective dimensions $d_{AB} = d_A \\cdot d_B$, $d_A$, and $d_B$. The partial trace, denoted $\\operatorname{Tr}_B$, is the unique linear map that connects the global state to local observables. An operator $O_A$ on $\\mathcal{H}_A$ has an equivalent representation $O_A \\otimes I_B$ on $\\mathcal{H}_{AB}$, where $I_B$ is the identity operator on $\\mathcal{H}_B$. The reduced density operator $\\rho_A = \\operatorname{Tr}_B(\\rho_{AB})$ is defined by the requirement that it correctly reproduces the expectation values of all local observables on subsystem $A$:\n$$\n\\operatorname{Tr}_A(O_A \\rho_A) = \\operatorname{Tr}_{AB}((O_A \\otimes I_B) \\rho_{AB})\n$$\nfor any operator $O_A$ on $\\mathcal{H}_A$.\n\nTo devise a numerical algorithm, we express this definition in a computational basis. Let $\\{|i_A\\rangle\\}_{i=0}^{d_A-1}$ be an orthonormal basis for $\\mathcal{H}_A$ and $\\{|k_B\\rangle\\}_{k=0}^{d_B-1}$ be an orthonormal basis for $\\mathcal{H}_B$. A basis for the composite space $\\mathcal{H}_{AB}$ is given by the tensor products $\\{|i_A\\rangle \\otimes |k_B\\rangle\\}$. A standard ordering for this basis maps the pair of indices $(i_A, k_B)$ to a single index $m = i_A \\cdot d_B + k_B$.\n\nThe matrix elements of the reduced density operator $\\rho_A$ in the basis of $\\mathcal{H}_A$ are given by:\n$$\n(\\rho_A)_{i_A, j_A} = \\langle i_A | \\rho_A | j_A \\rangle\n$$\nUsing the definition of the partial trace, this can be expanded as:\n$$\n(\\rho_A)_{i_A, j_A} = \\operatorname{Tr}_A(|j_A\\rangle\\langle i_A| \\rho_A) = \\operatorname{Tr}_{AB}((|j_A\\rangle\\langle i_A| \\otimes I_B) \\rho_{AB})\n$$\nWe can express the trace on the right-hand side by summing over the basis of $\\mathcal{H}_{AB}$:\n$$\n(\\rho_A)_{i_A, j_A} = \\sum_{l_A=0}^{d_A-1} \\sum_{k_B=0}^{d_B-1} \\langle l_A, k_B | (|j_A\\rangle\\langle i_A| \\otimes I_B) \\rho_{AB} | l_A, k_B \\rangle\n$$\nUsing the property $\\langle l_A, k_B | = \\langle l_A | \\otimes \\langle k_B |$ and the definition of the tensor product of operators, we get:\n$$\n(\\rho_A)_{i_A, j_A} = \\sum_{l_A=0}^{d_A-1} \\sum_{k_B=0}^{d_B-1} (\\langle l_A |j_A\\rangle\\langle i_A| l_A \\rangle) \\otimes (\\langle k_B | I_B | k_B \\rangle) \\cdot \\langle l_A, k_B | \\rho_{AB} | l_A, k_B \\rangle\n$$\nThe inner products of basis vectors are Kronecker deltas: $\\langle l_A|j_A\\rangle = \\delta_{l_A, j_A}$ and $\\langle i_A|l_A\\rangle = \\delta_{i_A, l_A}$. Also, $\\langle k_B | I_B | k_B \\rangle = \\langle k_B | k_B \\rangle = 1$. The sum over $l_A$ collapses due to the deltas, forcing $l_A = i_A$ and $l_A = j_A$, which is only possible if $i_A = j_A$. A more direct evaluation comes from:\n$$\n(\\rho_A)_{i_A, j_A} = \\sum_{k_B=0}^{d_B-1} \\langle i_A, k_B | \\rho_{AB} | j_A, k_B \\rangle\n$$\nThis provides a direct formula for the matrix elements of $\\rho_A$. In terms of matrix indices, where the composite index is $m = i \\cdot d_B + k$, this becomes:\n$$\n(\\rho_A)_{i,j} = \\sum_{k=0}^{d_B-1} (\\rho_{AB})_{i \\cdot d_B + k, j \\cdot d_B + k}\n$$\nThis formula reveals that the $(i,j)$-th element of $\\rho_A$ is the sum of the diagonal elements of a specific submatrix of $\\rho_{AB}$. If we view $\\rho_{AB}$ as a $d_A \\times d_A$ block matrix, where each block is a $d_B \\times d_B$ matrix, then the $(i,j)$-th block corresponds to the operator components connecting sectors $i$ and $j$ of subsystem $A$. The partial trace operation is equivalent to taking the trace of each of these $d_B \\times d_B$ blocks: $(\\rho_A)_{i,j} = \\operatorname{Tr}((\\rho_{AB})_{\\text{block } i,j})$. This is the algorithm implemented in the provided code.\n\nThe program will systematically execute the five test cases. For each case, it will:\n1.  Construct the $d_{AB} \\times d_{AB}$ density matrix $\\rho_{AB}$ according to the specified rule (random pure state, Bell state, random mixed state, or product state). All random constructions will be seeded by $1729$ for reproducibility.\n2.  Construct the $d_A \\times d_A$ local observable $O_A$.\n3.  Compute the $d_A \\times d_A$ reduced density matrix $\\rho_A$ by implementing the block-trace algorithm described above.\n4.  Verify the three fundamental invariants within a numerical tolerance of $\\epsilon = 10^{-10}$:\n    a.  **Trace Preservation**: Check if $|\\operatorname{Tr}(\\rho_A) - 1| \\le \\epsilon$. The trace of a physically valid density matrix must be $1$.\n    b.  **Positivity**: Check if $\\rho_A$ is positive semidefinite. This is verified by computing the eigenvalues of $\\rho_A$ (which must be real, as $\\rho_A$ is Hermitian) and ensuring they are all greater than or equal to $-\\epsilon$.\n    c.  **Local Expectation Consistency**: Check if $|\\operatorname{Tr}(O_A \\rho_A) - \\operatorname{Tr}((O_A \\otimes I_B) \\rho_{AB})| \\le \\epsilon$. This is the defining property of the partial trace.\n\nThe program aggregates the boolean outcomes of these three checks for each test case into a final list, which serves as the conclusive output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs bipartite quantum states, computes the reduced density operator\n    via partial trace, and verifies its fundamental properties.\n    \"\"\"\n    \n    # Set the random seed for reproducibility as required.\n    SEED = 1729\n    rng = np.random.default_rng(SEED)\n    \n    # Define the numerical tolerance for all checks.\n    TOL = 1e-10\n\n    # --- Helper functions for state and operator construction ---\n    \n    def get_random_pure_state(dim, generator):\n        \"\"\"Generates a random normalized pure state vector in a complex Hilbert space.\"\"\"\n        # Generate a random complex vector.\n        psi = generator.random(dim, dtype=np.float64) + 1j * generator.random(dim, dtype=np.float64)\n        # Normalize it.\n        norm = np.linalg.norm(psi)\n        return psi / norm\n\n    def get_random_hermitian_operator(dim, generator):\n        \"\"\"Generates a random Hermitian operator.\"\"\"\n        # Generate a random complex matrix.\n        M = generator.random((dim, dim), dtype=np.float64) + 1j * generator.random((dim, dim), dtype=np.float64)\n        # Symmetrize to make it Hermitian: O = M + M^dagger\n        return M + M.conj().T\n\n    def get_random_mixed_state(dim, generator):\n        \"\"\"Generates a random mixed density operator from a Ginibre ensemble.\"\"\"\n        # Generate a random complex matrix G.\n        G = generator.random((dim, dim), dtype=np.float64) + 1j * generator.random((dim, dim), dtype=np.float64)\n        # Construct a positive semidefinite matrix X = G * G^dagger.\n        X = G @ G.conj().T\n        # Normalize to ensure Tr(rho) = 1.\n        trace_X = np.trace(X)\n        if trace_X > TOL:\n            return X / trace_X\n        else:\n            # Fallback for the unlikely case of a zero-trace matrix\n            return np.eye(dim) / dim\n\n    # --- Core partial trace implementation ---\n\n    def partial_trace(rho_ab, dA, dB):\n        \"\"\"\n        Computes the partial trace Tr_B(rho_ab) over subsystem B.\n        rho_ab: Density matrix of the composite system AB of size (dA*dB, dA*dB).\n        dA: Dimension of subsystem A.\n        dB: Dimension of subsystem B.\n        \"\"\"\n        # rho_A will be a dA x dA matrix. Initialize with zeros.\n        rho_a = np.zeros((dA, dA), dtype=np.complex128)\n        \n        # We view rho_ab as a dA x dA block matrix, where each block is dB x dB.\n        # The (i,j)-th element of rho_a is the trace of the (i,j)-th block of rho_ab.\n        for i in range(dA):\n            for j in range(dA):\n                # Extract the (i,j)-th block.\n                # The block starts at row i*dB and column j*dB.\n                block = rho_ab[i*dB:(i+1)*dB, j*dB:(j+1)*dB]\n                \n                # Compute the trace of the block and assign it to rho_a[i,j].\n                rho_a[i, j] = np.trace(block)\n                \n        return rho_a\n\n    # --- Test suite definition ---\n\n    test_cases = [\n        {'case_name': 'Random pure state', 'dA': 2, 'dB': 2},\n        {'case_name': 'Maximally entangled Bell state', 'dA': 2, 'dB': 2},\n        {'case_name': 'Random mixed state, asymmetric', 'dA': 2, 'dB': 3},\n        {'case_name': 'Product pure state', 'dA': 3, 'dB': 2},\n        {'case_name': 'Trivial environment', 'dA': 4, 'dB': 1},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        dA = case['dA']\n        dB = case['dB']\n        dAB = dA * dB\n        \n        # --- 1. Construct rho_ab and O_a for the current case ---\n        \n        if case['case_name'] == 'Random pure state':\n            psi_ab = get_random_pure_state(dAB, rng)\n            rho_ab = np.outer(psi_ab, np.conj(psi_ab))\n            O_a = get_random_hermitian_operator(dA, rng)\n            \n        elif case['case_name'] == 'Maximally entangled Bell state':\n            # |psi> = (|00> + |11>)/sqrt(2)\n            # |00> is [1,0,0,0], |11> is [0,0,0,1]\n            psi_ab = np.array([1, 0, 0, 1], dtype=np.complex128) / np.sqrt(2)\n            rho_ab = np.outer(psi_ab, np.conj(psi_ab))\n            # O_a is the Pauli-Z operator\n            O_a = np.diag([1, -1]).astype(np.complex128)\n\n        elif case['case_name'] == 'Random mixed state, asymmetric':\n            rho_ab = get_random_mixed_state(dAB, rng)\n            O_a = get_random_hermitian_operator(dA, rng)\n\n        elif case['case_name'] == 'Product pure state':\n            psi_a = get_random_pure_state(dA, rng)\n            psi_b = get_random_pure_state(dB, rng)\n            psi_ab = np.kron(psi_a, psi_b)\n            rho_ab = np.outer(psi_ab, np.conj(psi_ab))\n            O_a = get_random_hermitian_operator(dA, rng)\n\n        elif case['case_name'] == 'Trivial environment':\n            # When dB=1, H_AB is isomorphic to H_A. rho_ab is already dA x dA.\n            rho_ab = get_random_mixed_state(dAB, rng)\n            O_a = get_random_hermitian_operator(dA, rng)\n        \n        # --- 2. Compute the reduced density operator ---\n        \n        rho_a = partial_trace(rho_ab, dA, dB)\n        \n        # --- 3. Verify the three invariants ---\n        \n        case_results = []\n\n        # a. Trace preservation: Tr(rho_a) == 1\n        trace_val = np.trace(rho_a)\n        trace_preserved = np.isclose(trace_val, 1.0, atol=TOL)\n        case_results.append(bool(trace_preserved))\n        \n        # b. Positivity: rho_a >= 0 (all eigenvalues must be non-negative)\n        # Use eigvalsh for Hermitian matrices for better performance and stability.\n        eigenvalues = np.linalg.eigvalsh(rho_a)\n        positive = np.all(eigenvalues >= -TOL)\n        case_results.append(bool(positive))\n        \n        # c. Local expectation consistency: Tr(O_a * rho_a) == Tr((O_a x I_b) * rho_ab)\n        # Identity operator on subsystem B\n        I_b = np.eye(dB)\n        # Form O_a (tensor) I_b\n        O_ab = np.kron(O_a, I_b)\n        \n        exp_val_a = np.trace(O_a @ rho_a)\n        exp_val_ab = np.trace(O_ab @ rho_ab)\n        \n        expectation_consistent = np.isclose(exp_val_a, exp_val_ab, atol=TOL)\n        case_results.append(bool(expectation_consistent))\n        \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # str() on a list [True, True] gives '[True, True]'.\n    # ','.join() combines these strings.\n    # The outer brackets complete the format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}