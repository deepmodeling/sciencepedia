{
    "hands_on_practices": [
        {
            "introduction": "Gyro-fluid models build upon standard fluid descriptions by systematically incorporating kinetic physics. This exercise takes you \"under the hood\" by focusing on the mathematical heart of these models: the gyroaveraging operators that account for Finite Larmor Radius (FLR) effects . By deriving the long-wavelength expansions of the key operators $\\Gamma_0(b_s)$ and $\\Gamma_1(b_s)$, you will see precisely how kinetic corrections for polarization and pressure emerge from first principles, providing a deeper appreciation for the model's construction.",
            "id": "3988029",
            "problem": "Consider a homogeneous, magnetized plasma with species index $s$, mass $m_s$, charge $q_s$, and equilibrium temperature $T_s$, embedded in a uniform magnetic field of magnitude $B$. Let the species cyclotron frequency be $\\Omega_s = |q_s| B / m_s$, and define the thermal Larmor radius $\\rho_s$ so that the long-wavelength gyrokinetic parameter is $b_s = k_{\\perp}^{2} \\rho_s^{2}$ for perpendicular wavenumber $k_{\\perp}$. In gyro-fluid and gyro-Landau fluid models, finite Larmor radius (FLR) effects enter perpendicular dynamics through gyroaveraging operators $\\Gamma_0(b_s)$ and $\\Gamma_1(b_s)$, which are defined in terms of modified Bessel functions of the first kind $I_n$ as $\\Gamma_0(b) \\equiv I_0(b) \\exp(-b)$ and $\\Gamma_1(b) \\equiv \\big(I_1(b)/b\\big)\\exp(-b)$. The FLR-modified polarization density typically involves the combination $1 - \\Gamma_0(b_s)$, while FLR corrections to perpendicular pressure closures involve $\\Gamma_1(b_s)$.\n\nStarting from the standard power-series definitions of the modified Bessel functions $I_0(x)$ and $I_1(x)$ and the exponential $\\exp(-x)$, derive the small-$b_s$ expansions of $\\Gamma_0(b_s)$ and $\\Gamma_1(b_s)$, retaining terms up to and including $\\mathcal{O}(b_s^{2})$. Then, using these expansions, interpret the leading-order and next-order FLR corrections to the species-$s$ polarization response and to the gyrofluid perpendicular pressure response in the long-wavelength limit. Your final answer must be the two truncated series for $\\Gamma_0(b_s)$ and $\\Gamma_1(b_s)$ written as closed-form expressions. Do not perform any numerical approximations.",
            "solution": "The objective is to derive the small-$b_s$ expansions for the gyroaveraging operators $\\Gamma_0(b_s)$ and $\\Gamma_1(b_s)$ up to order $\\mathcal{O}(b_s^2)$, and then to interpret the physical significance of the leading-order and next-order corrections in the context of gyro-fluid models. The parameter $b_s$ is defined as $b_s = k_{\\perp}^{2} \\rho_s^{2}$, where $k_{\\perp}$ is the perpendicular wavenumber and $\\rho_s$ is the species thermal Larmor radius. The small-$b_s$ limit corresponds to the long-wavelength approximation, $k_{\\perp} \\rho_s \\ll 1$.\n\nThe derivation begins with the standard power-series definitions of the exponential function and the modified Bessel functions of the first kind, $I_0(x)$ and $I_1(x)$.\n\nThe power series for the exponential function is:\n$$ \\exp(-x) = \\sum_{k=0}^{\\infty} \\frac{(-x)^k}{k!} = 1 - x + \\frac{x^2}{2} - \\frac{x^3}{6} + \\mathcal{O}(x^4) $$\n\nThe power series for the modified Bessel function $I_n(x)$ is given by:\n$$ I_n(x) = \\sum_{k=0}^{\\infty} \\frac{1}{k! \\Gamma(n+k+1)} \\left(\\frac{x}{2}\\right)^{n+2k} $$\nwhere $\\Gamma$ is the Gamma function.\n\nFor $n=0$, we have $I_0(x)$, noting that $\\Gamma(k+1) = k!$:\n$$ I_0(x) = \\sum_{k=0}^{\\infty} \\frac{1}{(k!)^2} \\left(\\frac{x}{2}\\right)^{2k} = 1 + \\frac{1}{(1!)^2}\\left(\\frac{x}{2}\\right)^2 + \\frac{1}{(2!)^2}\\left(\\frac{x}{2}\\right)^4 + \\dots $$\n$$ I_0(x) = 1 + \\frac{x^2}{4} + \\frac{x^4}{64} + \\mathcal{O}(x^6) $$\n\nFor $n=1$, we have $I_1(x)$, noting that $\\Gamma(k+2) = (k+1)!$:\n$$ I_1(x) = \\sum_{k=0}^{\\infty} \\frac{1}{k! (k+1)!} \\left(\\frac{x}{2}\\right)^{1+2k} = \\frac{x}{2} + \\frac{1}{1!2!}\\left(\\frac{x}{2}\\right)^3 + \\frac{1}{2!3!}\\left(\\frac{x}{2}\\right)^5 + \\dots $$\n$$ I_1(x) = \\frac{x}{2} + \\frac{x^3}{16} + \\frac{x^5}{384} + \\mathcal{O}(x^7) $$\n\nNow we can derive the expansions for $\\Gamma_0(b_s)$ and $\\Gamma_1(b_s)$. For notational simplicity during the derivation, let $b = b_s$. We seek expansions up to and including terms of order $\\mathcal{O}(b^2)$.\n\n**Derivation of the expansion for $\\Gamma_0(b_s)$:**\n\nThe definition is $\\Gamma_0(b) = I_0(b) \\exp(-b)$. We use the series expansions truncated to the required order.\n$$ I_0(b) = 1 + \\frac{b^2}{4} + \\mathcal{O}(b^4) $$\n$$ \\exp(-b) = 1 - b + \\frac{b^2}{2} + \\mathcal{O}(b^3) $$\nMultiplying these two series and keeping terms up to $\\mathcal{O}(b^2)$:\n$$ \\Gamma_0(b) = \\left(1 + \\frac{b^2}{4} + \\mathcal{O}(b^4)\\right) \\left(1 - b + \\frac{b^2}{2} + \\mathcal{O}(b^3)\\right) $$\n$$ \\Gamma_0(b) = 1 \\cdot \\left(1 - b + \\frac{b^2}{2}\\right) + \\frac{b^2}{4} \\cdot (1) + \\mathcal{O}(b^3) $$\n$$ \\Gamma_0(b) = 1 - b + \\frac{b^2}{2} + \\frac{b^2}{4} + \\mathcal{O}(b^3) $$\n$$ \\Gamma_0(b_s) = 1 - b_s + \\frac{3}{4}b_s^2 + \\mathcal{O}(b_s^3) $$\n\n**Derivation of the expansion for $\\Gamma_1(b_s)$:**\n\nThe definition is $\\Gamma_1(b) = \\left(\\frac{I_1(b)}{b}\\right) \\exp(-b)$. First, we find the expansion for $I_1(b)/b$:\n$$ \\frac{I_1(b)}{b} = \\frac{1}{b} \\left(\\frac{b}{2} + \\frac{b^3}{16} + \\frac{b^5}{384} + \\dots\\right) = \\frac{1}{2} + \\frac{b^2}{16} + \\frac{b^4}{384} + \\mathcal{O}(b^6) $$\nNow, we multiply this by the expansion for $\\exp(-b)$, keeping terms up to $\\mathcal{O}(b^2)$:\n$$ \\Gamma_1(b) = \\left(\\frac{1}{2} + \\frac{b^2}{16} + \\mathcal{O}(b^4)\\right) \\left(1 - b + \\frac{b^2}{2} + \\mathcal{O}(b^3)\\right) $$\n$$ \\Gamma_1(b) = \\frac{1}{2} \\cdot \\left(1 - b + \\frac{b^2}{2}\\right) + \\frac{b^2}{16} \\cdot (1) + \\mathcal{O}(b^3) $$\n$$ \\Gamma_1(b) = \\frac{1}{2} - \\frac{b}{2} + \\frac{b^2}{4} + \\frac{b^2}{16} + \\mathcal{O}(b^3) $$\n$$ \\Gamma_1(b) = \\frac{1}{2} - \\frac{b}{2} + \\left(\\frac{4+1}{16}\\right)b^2 + \\mathcal{O}(b^3) $$\n$$ \\Gamma_1(b_s) = \\frac{1}{2} - \\frac{1}{2}b_s + \\frac{5}{16}b_s^2 + \\mathcal{O}(b_s^3) $$\n\n**Interpretation of FLR Corrections:**\n\n**1. Polarization Response:**\nThe species polarization density in gyrokinetics is proportional to $1 - \\Gamma_0(b_s)$. Using our expansion:\n$$ 1 - \\Gamma_0(b_s) = 1 - \\left(1 - b_s + \\frac{3}{4}b_s^2 + \\mathcal{O}(b_s^3)\\right) = b_s - \\frac{3}{4}b_s^2 + \\mathcal{O}(b_s^3) $$\nSubstituting $b_s = k_{\\perp}^2 \\rho_s^2$:\n$$ 1 - \\Gamma_0(b_s) = k_{\\perp}^2 \\rho_s^2 - \\frac{3}{4}(k_{\\perp}^2 \\rho_s^2)^2 + \\mathcal{O}((k_{\\perp}^2 \\rho_s^2)^3) $$\n- **Leading-Order Correction:** The term $b_s = k_{\\perp}^2 \\rho_s^2$ is the leading-order finite Larmor radius (FLR) correction. This term corresponds exactly to the classical polarization current response found in standard fluid models. It represents the charge separation caused by the differential drift of ions and electrons in a time-varying electric field, averaged over a gyromotion. In the cold plasma limit ($\\rho_s \\rightarrow 0$), $b_s \\rightarrow 0$, $\\Gamma_0 \\rightarrow 1$, and this correction vanishes.\n- **Next-Order Correction:** The term $-\\frac{3}{4}b_s^2$ is a higher-order kinetic correction to the standard fluid polarization response. It refines the model by including more detailed information about the distribution of particle orbits, becoming important for shorter wavelengths (larger $k_{\\perp}$) where the simple fluid approximation breaks down. This term ensures the gyro-fluid model more accurately reproduces the full kinetic response at smaller scales.\n\n**2. Perpendicular Pressure Response:**\nThe operator $\\Gamma_1(b_s)$ modifies the perpendicular pressure dynamics in gyro-fluid closures. Its expansion is:\n$$ \\Gamma_1(b_s) = \\frac{1}{2} - \\frac{1}{2}b_s + \\frac{5}{16}b_s^2 + \\mathcal{O}(b_s^3) $$\n- **Zero-Order Behavior:** In the long-wavelength limit ($b_s \\rightarrow 0$), $\\Gamma_1(b_s) \\rightarrow \\frac{1}{2}$. This constant factor often appears in combinations like $2\\Gamma_1(b_s)$, which approaches $1$ in this limit. This signifies that, to lowest order, the perpendicular heat flux dynamics are coupled to the perpendicular pressure in a way that is consistent with an isotropic fluid-like behavior at very large scales.\n- **Leading-Order Correction:** The term $-\\frac{1}{2}b_s = -\\frac{1}{2}k_{\\perp}^2 \\rho_s^2$ is the leading-order FLR correction to the pressure dynamics. This term represents the first-order effects of gyromotion on heat transport. It is responsible for introducing effects like diamagnetic heat flux, which are fundamentally kinetic and absent in simpler fluid models. It introduces a dissipative or dispersive character to the pressure evolution equations.\n- **Next-Order Correction:** The term $+\\frac{5}{16}b_s^2$ is a higher-order kinetic correction. It provides a more accurate representation of the perpendicular thermal transport at shorter wavelengths, capturing additional complexities of particle-wave interactions that are averaged out in lower-order models.\n\nIn summary, the expansions of $\\Gamma_0$ and $\\Gamma_1$ systematically introduce FLR effects into fluid-like equations, with each successive term in the expansion providing a higher-fidelity approximation to the underlying kinetic physics at progressively smaller spatial scales.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 1 - b_s + \\frac{3}{4}b_s^2 & \\frac{1}{2} - \\frac{1}{2}b_s + \\frac{5}{16}b_s^2 \\end{pmatrix}} $$"
        },
        {
            "introduction": "A primary application of gyro-fluid theory is to build models that can predict the onset and behavior of plasma instabilities. This practice guides you through the process of deriving the growth rate for the fundamental interchange instability, which is driven by magnetic field curvature and stabilized by FLR effects . You will then translate your analytical result into a computational script to perform a parameter study, a core skill that bridges the gap between theoretical physics and numerical simulation.",
            "id": "4190681",
            "problem": "You are asked to design and implement a parameter study to identify regimes of strong interchange activity in gyro-fluid models of fusion plasma turbulence. The study must be derived from first principles appropriate to magnetized plasmas under drift ordering, starting from the following base: conservation of mass, force balance, the electron adiabatic response, and gyro-fluid polarization effects. Specifically, use a low-magnetic-pressure regime where electron dynamics are isothermal and ions are cold, in a flute-mode limit with negligible parallel wave number. Your derivation must begin from a physically justified effective buoyancy force due to magnetic field line curvature, and a pressure gradient providing available free energy. You must also incorporate the finite Larmor radius (FLR) stabilization present in gyro-fluid polarization, which screens perpendicular scales.\n\nThe goal is to derive a linear interchange growth rate, expressed in terms of curvature and pressure gradient parameters, and then use it to implement a parameter scan that outputs whether each case lies in a regime of strong interchange activity. In this context, define “strong interchange activity” as cases where the linear growth rate exceeds the parallel sound transit frequency, so that interchange growth outpaces parallel loss. The criterion is $ \\gamma > \\omega_{\\parallel} $, where $ \\gamma $ is the linear interchange growth rate and $ \\omega_{\\parallel} = c_s / L_{\\parallel} $ is the parallel sound transit frequency, with $ c_s $ the ion-acoustic speed and $ L_{\\parallel} $ the parallel connection length.\n\nUse the following fundamental laws and definitions as your starting base (do not use or quote the target dispersion relation in the problem statement):\n- Ion-acoustic speed: $ c_s = \\sqrt{ T_e / m_i } $, with $ T_e $ the electron temperature and $ m_i $ the ion mass.\n- Ion cyclotron frequency: $ \\Omega_i = e B / m_i $, with $ e $ the elementary charge and $ B $ the magnetic field strength.\n- Ion-sound Larmor radius: $ \\rho_s = c_s / \\Omega_i $.\n- Effective interchange “gravity” due to curvature: $ g_{\\mathrm{eff}} = 2 c_s^2 / R $, with $ R $ the curvature radius.\n- Pressure-gradient scale length: $ L_p = - p_0 / (\\partial p_0 / \\partial x) $, assumed positive in the region of interest.\n- Gyro-fluid polarization produces perpendicular shielding represented by a factor that depends on $ k_{\\perp} $ and $ \\rho_s $.\n\nScientific and numerical requirements:\n- Assume a slab geometry with coordinates $ x $ (radial) and $ y $ (poloidal).\n- Consider flute-like perturbations for which $ k_{\\parallel} \\approx 0 $.\n- Electrons are adiabatic and isothermal, ions are cold, low magnetic pressure, and drift ordering applies.\n- Your program must compute the linear interchange growth rate $ \\gamma $ for each test case, then compare $ \\gamma $ to $ \\omega_{\\parallel} = c_s / L_{\\parallel} $ to return a boolean indicating strong interchange activity.\n\nUnits and formatting requirements:\n- All physical quantities must be handled in International System of Units (SI).\n- The electron temperature $ T_e $ will be provided in electronvolts and must be converted to Joules via $ 1 \\, \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\, \\mathrm{J} $.\n- Magnetic field $ B $ in Tesla $ (\\mathrm{T}) $, lengths $ R $, $ L_p $, $ L_{\\parallel} $ in meters $ (\\mathrm{m}) $, wave numbers $ k_x $, $ k_y $ in inverse meters $ (\\mathrm{m}^{-1}) $, masses in kilograms $ (\\mathrm{kg}) $.\n- The program must output a single line containing a comma-separated list enclosed in square brackets with boolean values (Python-style) for each test case indicating strong interchange activity, for example $ [\\mathrm{True},\\mathrm{False},\\mathrm{True}] $.\n\nTest suite:\nImplement the following test cases, each as a tuple $ (T_e, B, R, L_p, k_x, k_y, L_{\\parallel}, m_i) $ with the specified units:\n- Case $ 1 $ (baseline strong interchange): $ (100 \\, \\mathrm{eV}, 2.0 \\, \\mathrm{T}, 1.5 \\, \\mathrm{m}, 0.02 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m}^{-1}, 300.0 \\, \\mathrm{m}^{-1}, 10.0 \\, \\mathrm{m}, 3.344 \\times 10^{-27} \\, \\mathrm{kg}) $.\n- Case $ 2 $ (negligible curvature): $ (100 \\, \\mathrm{eV}, 2.0 \\, \\mathrm{T}, 1.0 \\times 10^{9} \\, \\mathrm{m}, 0.02 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m}^{-1}, 300.0 \\, \\mathrm{m}^{-1}, 10.0 \\, \\mathrm{m}, 3.344 \\times 10^{-27} \\, \\mathrm{kg}) $.\n- Case $ 3 $ (flat pressure profile): $ (100 \\, \\mathrm{eV}, 2.0 \\, \\mathrm{T}, 1.5 \\, \\mathrm{m}, 100.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m}^{-1}, 300.0 \\, \\mathrm{m}^{-1}, 10.0 \\, \\mathrm{m}, 3.344 \\times 10^{-27} \\, \\mathrm{kg}) $.\n- Case $ 4 $ (strong FLR stabilization at high $ k_{\\perp} $): $ (100 \\, \\mathrm{eV}, 2.0 \\, \\mathrm{T}, 1.5 \\, \\mathrm{m}, 0.02 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m}^{-1}, 10000.0 \\, \\mathrm{m}^{-1}, 0.5 \\, \\mathrm{m}, 3.344 \\times 10^{-27} \\, \\mathrm{kg}) $.\n- Case $ 5 $ (strong gradient and curvature, long connection length): $ (100 \\, \\mathrm{eV}, 2.0 \\, \\mathrm{T}, 1.0 \\, \\mathrm{m}, 0.01 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m}^{-1}, 200.0 \\, \\mathrm{m}^{-1}, 50.0 \\, \\mathrm{m}, 3.344 \\times 10^{-27} \\, \\mathrm{kg}) $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $ [\\mathrm{True},\\mathrm{False},\\mathrm{False},\\mathrm{False},\\mathrm{True}] $. The internal numerical calculations must be performed in SI units, and the final comparison $ \\gamma > \\omega_{\\parallel} $ must be implemented to yield the boolean outputs.",
            "solution": "The problem requires the derivation of the linear growth rate for an interchange instability in a magnetized plasma, followed by a numerical parameter study. The physical regime is a low-magnetic-pressure, flute-mode limit ($k_{\\parallel} \\approx 0$) with cold ions ($T_i=0$) and isothermal, adiabatic electrons ($T_e$). The derivation must be based on first principles as outlined.\n\nFirst, we validate the problem statement. The givens are the fundamental definitions for ion-acoustic speed $c_s$, ion cyclotron frequency $\\Omega_i$, ion-sound Larmor radius $\\rho_s$, effective interchange gravity $g_{\\mathrm{eff}}$, and pressure-gradient scale length $L_p$. The physical scenario described—interchange instability driven by magnetic curvature and pressure gradients, stabilized by Finite Larmor Radius (FLR) effects—is a cornerstone topic in plasma stability theory. The parameters and assumptions (cold ions, flute modes, etc.) constitute a standard, well-posed model used to isolate specific physical mechanisms. The test case parameters are physically plausible for fusion experiments. The problem is scientifically grounded, objective, and self-contained. Thus, the problem is deemed valid and a solution can be formulated.\n\nOur derivation begins by recognizing that the interchange instability is a plasma physics analogue of the classical Rayleigh-Taylor instability, where a heavy fluid is unstably supported by a lighter fluid in a gravitational field.\n\n1.  **Instability Drive**: In a magnetized plasma with curved magnetic field lines, particles experience centrifugal and grad-B drifts. This creates a charge-separation current that, in the presence of a pressure gradient, can be unstable. The combined effect of these drifts and plasma pressure acts like an effective gravity. The problem provides this effective gravity as $g_{\\mathrm{eff}} = 2 c_s^2 / R$, where $R$ is the radius of magnetic curvature. This \"gravity\" acts on the plasma mass density $\\rho_m = n_i m_i$. The free energy for the instability is provided by the plasma pressure gradient, characterized by the scale length $L_p = -p_0 / (\\partial p_0 / \\partial x)$. In the Rayleigh-Taylor analogy, the growth rate squared is proportional to the gravity and the density gradient: $\\gamma^2 \\propto g (\\nabla \\rho / \\rho)$. For our plasma system, this translates to a base growth rate $\\gamma_0^2$ given by:\n    $$ \\gamma_0^2 = \\frac{g_{\\mathrm{eff}}}{L_n} $$\n    where $L_n$ is the density gradient scale length. Since electrons are isothermal ($p_e = n_e T_e$ with constant $T_e$), the pressure and density scale lengths are equal: $L_p = L_n$. Using the provided definition of $g_{\\mathrm{eff}}$:\n    $$ \\gamma_0^2 = \\frac{2 c_s^2}{R L_p} $$\n    This represents the ideal magnetohydrodynamic (MHD) drive for the interchange instability. Instability ($\\gamma_0^2 > 0$) occurs for \"bad\" curvature ($R>0$, i.e., field lines convex to the plasma) and a pressure gradient pointing away from the center of curvature (assumed here, with $L_p > 0$).\n\n2.  **FLR Stabilization**: The ideal MHD model neglects micro-scale plasma physics. Gyro-fluid models incorporate Finite Larmor Radius (FLR) effects, which arise because ions gyrate around magnetic field lines with a finite radius $\\rho_i$. These effects are particularly important at small spatial scales (large perpendicular wavenumbers, $k_{\\perp}$). One key consequence is the ion polarization drift, which is an inertial drift that gives the plasma its effective inertia in response to changing electric fields. Gyro-averaging modifies the simple cold-plasma polarization, introducing a scale-dependent correction. This effect is often described as a gyro-viscosity, which smooths out small-scale perturbations and provides a stabilizing effect.\n\n    In a simplified fluid picture, the inertia of a plasma element is not just its classical mass density $\\rho_m$, but an effective mass density $\\rho_{\\mathrm{eff}}$. For interchange modes, this is modeled as:\n    $$ \\rho_{\\mathrm{eff}} = \\rho_m (1 + k_{\\perp}^2 \\rho_s^2) $$\n    where $k_{\\perp} = \\sqrt{k_x^2 + k_y^2}$ is the perpendicular wavenumber and $\\rho_s = c_s / \\Omega_i$ is the ion-sound Larmor radius. The term $k_{\\perp}^2 \\rho_s^2$ represents the FLR stabilization, which becomes dominant at short wavelengths (large $k_{\\perp}$).\n\n3.  **Dispersion Relation**: The equation of motion for an unstable displacement $\\xi$ is schematically $ \\rho_{\\mathrm{eff}} \\frac{\\partial^2 \\xi}{\\partial t^2} = F_{\\text{destabilizing}} \\xi $. Since $\\frac{\\partial^2}{\\partial t^2} \\rightarrow -\\omega^2$, and for pure growth $\\omega = i\\gamma$, we have $\\rho_{\\mathrm{eff}} \\gamma^2 \\propto F_{\\text{destabilizing}}$. This indicates that the growth rate $\\gamma$ is inversely proportional to the square root of the effective inertia. We can thus modify the ideal MHD growth rate to include FLR effects:\n    $$ \\gamma^2 = \\frac{\\gamma_0^2}{1 + k_{\\perp}^2 \\rho_s^2} $$\n    Substituting the expressions for $\\gamma_0^2$, we obtain the final dispersion relation for the growth rate $\\gamma$:\n    $$ \\gamma^2 = \\frac{2 c_s^2}{R L_p (1 + k_{\\perp}^2 \\rho_s^2)} $$\n    If the right-hand side is negative (e.g., due to stabilizing \"good\" curvature, $R<0$), the mode is stable, and the growth rate $\\gamma$ is zero. For the given problem, all unstable cases have $R > 0$ and $L_p > 0$.\n\n4.  **Condition for Strong Interchange Activity**: The problem defines \"strong interchange activity\" as the regime where the interchange growth rate $\\gamma$ exceeds the parallel sound transit frequency $\\omega_{\\parallel}$. This frequency represents the rate at which parallel plasma motion (e.g., sound waves) can wash out or \"short-circuit\" the perpendicular perturbations. The condition is:\n    $$ \\gamma > \\omega_{\\parallel} $$\n    where $\\omega_{\\parallel} = c_s / L_{\\parallel}$, with $L_{\\parallel}$ being the parallel connection length of the magnetic field.\n\n5.  **Final Calculation Formulae**: To implement the parameter scan, we will calculate $\\gamma$ and $\\omega_{\\parallel}$ for each test case using the following set of equations in SI units.\n    - Elementary charge: $e = 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$.\n    - Electron temperature in Joules: $T_e \\, [\\mathrm{J}] = T_e \\, [\\mathrm{eV}] \\times (1.602176634 \\times 10^{-19} \\, \\mathrm{J/eV})$.\n    - Ion-acoustic speed: $c_s = \\sqrt{T_e / m_i}$.\n    - Ion cyclotron frequency: $\\Omega_i = e B / m_i$.\n    - Ion-sound Larmor radius: $\\rho_s = c_s / \\Omega_i$.\n    - Perpendicular wavenumber squared: $k_{\\perp}^2 = k_x^2 + k_y^2$.\n    - Growth rate squared: $\\gamma^2 = \\frac{2 c_s^2}{R L_p (1 + k_{\\perp}^2 \\rho_s^2)}$. If the argument is negative, $\\gamma = 0$.\n    - Growth rate: $\\gamma = \\sqrt{\\max(0, \\gamma^2)}$.\n    - Parallel transit frequency: $\\omega_{\\parallel} = c_s / L_{\\parallel}$.\n    - Condition: The test case exhibits strong interchange activity if $\\gamma > \\omega_{\\parallel}$.\n\nThis completes the physical and mathematical derivation required to solve the problem. The next step is to implement these calculations in code.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the interchange instability parameter study problem.\n\n    The function implements a parameter scan to identify regimes of strong\n    interchange activity in a gyro-fluid model of fusion plasma. It calculates\n    the linear interchange growth rate (gamma) and compares it to the parallel\n    sound transit frequency (omega_parallel) for several test cases.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    EV_TO_J = 1.602176634e-19   # Conversion factor from electron-volts to Joules\n\n    # Test cases: (T_e [eV], B [T], R [m], L_p [m], k_x [m^-1], k_y [m^-1], L_parallel [m], m_i [kg])\n    test_cases = [\n        # Case 1 (baseline strong interchange)\n        (100.0, 2.0, 1.5, 0.02, 0.0, 300.0, 10.0, 3.344e-27),\n        # Case 2 (negligible curvature)\n        (100.0, 2.0, 1.0e9, 0.02, 0.0, 300.0, 10.0, 3.344e-27),\n        # Case 3 (flat pressure profile)\n        (100.0, 2.0, 1.5, 100.0, 0.0, 300.0, 10.0, 3.344e-27),\n        # Case 4 (strong FLR stabilization at high k_perp)\n        (100.0, 2.0, 1.5, 0.02, 0.0, 10000.0, 0.5, 3.344e-27),\n        # Case 5 (strong gradient and curvature, long connection length)\n        (100.0, 2.0, 1.0, 0.01, 0.0, 200.0, 50.0, 3.344e-27),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        Te_eV, B, R, Lp, kx, ky, L_parallel, mi = case\n\n        # Convert electron temperature to Joules (SI)\n        Te_J = Te_eV * EV_TO_J\n\n        # 1. Calculate ion-acoustic speed (c_s)\n        # c_s = sqrt(T_e / m_i)\n        cs = np.sqrt(Te_J / mi)\n\n        # 2. Calculate ion cyclotron frequency (Omega_i)\n        # Omega_i = e * B / m_i\n        Omega_i = E_CHARGE * B / mi\n\n        # 3. Calculate ion-sound Larmor radius (rho_s)\n        # rho_s = c_s / Omega_i\n        rho_s = cs / Omega_i\n\n        # 4. Calculate perpendicular wavenumber squared (k_perp^2)\n        # k_perp^2 = k_x^2 + k_y^2\n        k_perp_sq = kx**2 + ky**2\n\n        # 5. Calculate interchange growth rate (gamma)\n        # gamma^2 = (2 * c_s^2) / (R * L_p * (1 + k_perp^2 * rho_s^2))\n        \n        # Check for non-physical inputs that would lead to division by zero\n        if R == 0 or Lp == 0:\n            gamma_sq = 0.0\n        else:\n            denominator = R * Lp * (1.0 + k_perp_sq * rho_s**2)\n            if denominator <= 0: # This case implies stability\n                gamma_sq = 0.0\n            else:\n                numerator = 2.0 * cs**2\n                gamma_sq = numerator / denominator\n\n        # Growth rate is real and positive for instability\n        gamma = np.sqrt(gamma_sq)\n\n        # 6. Calculate parallel sound transit frequency (omega_parallel)\n        # omega_parallel = c_s / L_parallel\n        if L_parallel == 0:\n            # Physically, this would be an infinite frequency\n            omega_parallel = float('inf')\n        else:\n            omega_parallel = cs / L_parallel\n\n        # 7. Compare gamma and omega_parallel to determine strong activity\n        is_strong_activity = gamma > omega_parallel\n        results.append(is_strong_activity)\n\n    # Format the output as a comma-separated list of Python-style booleans\n    # e.g., [True, False, False, False, True]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "To analyze a real-world fusion device, one must synthesize multiple physical effects to form a complete picture of the plasma state. This capstone exercise challenges you to act as a plasma modeler by calculating a suite of critical dimensionless parameters for a realistic tokamak scenario . By evaluating quantities such as plasma beta, normalized gradients, and collisionality, you will learn to weigh competing physical drivers and make an informed judgment about the dominant turbulence regime, a crucial step in predicting and controlling plasma transport.",
            "id": "4190724",
            "problem": "In a circular cross-section tokamak core, consider a single-scale, local, flux-tube description appropriate for gyro-fluid modeling of microturbulence. Assume a quasi-neutral deuterium plasma with singly charged ions ($Z=1$) and the following parameters at a given radius: magnetic field magnitude $B=3.20$, electron density $n_e=6.00\\times 10^{19}$, ion density $n_i=6.00\\times 10^{19}$, electron temperature $T_e=2.00\\,\\mathrm{keV}$, ion temperature $T_i=3.00\\,\\mathrm{keV}$, density gradient scale length $L_n=0.140$, ion temperature gradient scale length $L_{T_i}=0.070$, electron temperature gradient scale length $L_{T_e}=0.100$, safety factor $q=1.60$, major radius $R=1.70$, Coulomb logarithm $\\ln\\Lambda=17.0$, and perpendicular wavenumber $k_{\\perp}=4.00\\times 10^{2}$. All lengths are in meters, densities in inverse cubic meters, temperatures in kiloelectronvolts, and magnetic field in tesla.\n\nStarting only from fundamental definitions and well-tested formulas for the relevant dimensionless parameters, perform the following:\n\n1. Derive and compute the total dimensionless plasma beta $\\beta$ defined as the ratio of total thermal pressure to magnetic pressure, using the thermodynamic definition of pressure and the magnetic pressure $B^{2}/(2\\mu_{0})$. Treat temperature values given in kiloelectronvolts as per-particle thermal energies and convert them to joules using the elementary charge $e$.\n\n2. Derive and compute the dimensionless gradient ratios $\\eta_{i}$ and $\\eta_{e}$ defined using the standard gradient scale lengths $L_{n}$, $L_{T_{i}}$, and $L_{T_{e}}$.\n\n3. Derive and compute the normalized electron collisionality $\\nu^{\\ast}$ defined as the product of the electron-ion collision frequency and the characteristic parallel transit time, $\\nu^{\\ast}=\\nu_{ei}\\,(qR/v_{\\mathrm{th},e})$, where $v_{\\mathrm{th},e}=\\sqrt{2 k_{B} T_{e}/m_{e}}$ and $\\nu_{ei}$ is the Spitzer electron-ion collision frequency for $Z=1$ and Maxwellian electrons. Use the well-tested Coulomb collision expression for $\\nu_{ei}$ written in terms of the elementary charge $e$ and vacuum permittivity $\\varepsilon_{0}$, and treat $k_{B}T_{e}$ consistently with the energy conversion noted above.\n\n4. Derive and compute the dimensionless product $k_{\\perp}\\rho_{s}$, where $\\rho_{s}=c_{s}/\\Omega_{i}$ is the sound Larmor radius, $c_{s}=\\sqrt{k_{B}T_{e}/m_{i}}$ is the ion-acoustic speed, and $\\Omega_{i}=eB/m_{i}$ is the ion gyrofrequency. Take the deuterium ion mass to be $m_{i}=2m_{p}$.\n\nThen, based on the magnitudes of the computed parameters and standard gyro-fluid microinstability reasoning, categorize the expected dominant turbulence regime at this radius using the following numeric encoding:\n- $1$: Ion Temperature Gradient dominated (ITG),\n- $2$: Trapped Electron Mode dominated (TEM),\n- $3$: Electron Temperature Gradient dominated (ETG),\n- $4$: Resistive drift-wave dominated,\n- $5$: Electromagnetic microtearing dominated.\n\nRound each computed dimensionless parameter ($\\beta$, $\\eta_{i}$, $\\eta_{e}$, $\\nu^{\\ast}$, $k_{\\perp}\\rho_{s}$) to three significant figures. Express the final answer as a single row matrix in the order $\\beta$, $\\eta_{i}$, $\\eta_{e}$, $\\nu^{\\ast}$, $k_{\\perp}\\rho_{s}$, regime code. The regime code is the integer corresponding to your categorization. The final answer must be dimensionless and unitless.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, self-contained, and well-posed. All provided parameters are physically realistic for a tokamak core plasma, and the tasks are standard calculations in fusion plasma turbulence analysis. Proceeding with the solution.\n\nThe analysis requires the following fundamental physical constants in SI units:\n- Elementary charge: $e \\approx 1.602 \\times 10^{-19} \\, \\text{C}$\n- Vacuum permeability: $\\mu_0 = 4\\pi \\times 10^{-7} \\, \\text{H/m}$\n- Vacuum permittivity: $\\varepsilon_0 \\approx 8.854 \\times 10^{-12} \\, \\text{F/m}$\n- Electron mass: $m_e \\approx 9.109 \\times 10^{-31} \\, \\text{kg}$\n- Proton mass: $m_p \\approx 1.6726 \\times 10^{-27} \\, \\text{kg}$\n\nThe ion mass for deuterium is given as $m_i = 2m_p \\approx 3.3452 \\times 10^{-27} \\, \\text{kg}$.\n\nThe problem specifies that temperatures given in kiloelectronvolts ($T_{\\text{keV}}$) should be treated as per-particle thermal energies. This energy in joules is $E = T_{\\text{keV}} \\times 10^3 \\times e$. This quantity $E$ is equivalent to $k_B T$ in standard thermodynamic formulas, where $k_B$ is the Boltzmann constant.\nFor the given temperatures:\n- Electron thermal energy: $k_B T_e = 2.00 \\, \\text{keV} = 2000 \\, e \\approx 3.204 \\times 10^{-16} \\, \\text{J}$\n- Ion thermal energy: $k_B T_i = 3.00 \\, \\text{keV} = 3000 \\, e \\approx 4.806 \\times 10^{-16} \\, \\text{J}$\n\n**1. Derivation and Computation of Plasma Beta ($\\beta$)**\n\nThe total dimensionless plasma beta, $\\beta$, is the ratio of the total thermal pressure $P_{\\text{th}}$ to the magnetic pressure $P_{\\text{mag}}$.\nThe total thermal pressure is the sum of the electron and ion pressures, $P_{\\text{th}} = P_e + P_i$. Using the ideal gas law, $P_s = n_s k_B T_s$ for a species $s$.\nGiven $n_e = n_i = n = 6.00 \\times 10^{19} \\, \\text{m}^{-3}$, the total thermal pressure is:\n$$ P_{\\text{th}} = n_e k_B T_e + n_i k_B T_i = n(k_B T_e + k_B T_i) $$\nPlugging in the values:\n$$ P_{\\text{th}} = (6.00 \\times 10^{19} \\, \\text{m}^{-3}) \\times (3.204 \\times 10^{-16} \\, \\text{J} + 4.806 \\times 10^{-16} \\, \\text{J}) = (6.00 \\times 10^{19}) \\times (8.010 \\times 10^{-16}) \\, \\text{Pa} = 48060 \\, \\text{Pa} $$\nThe magnetic pressure is defined as $P_{\\text{mag}} = \\frac{B^2}{2\\mu_0}$. With $B = 3.20 \\, \\text{T}$:\n$$ P_{\\text{mag}} = \\frac{(3.20 \\, \\text{T})^2}{2 \\times (4\\pi \\times 10^{-7} \\, \\text{H/m})} = \\frac{10.24}{8\\pi \\times 10^{-7}} \\, \\text{Pa} \\approx 4.074 \\times 10^6 \\, \\text{Pa} $$\nThe plasma beta is the ratio:\n$$ \\beta = \\frac{P_{\\text{th}}}{P_{\\text{mag}}} = \\frac{48060}{4.074 \\times 10^6} \\approx 0.011796 $$\nRounding to three significant figures, $\\beta = 0.0118$.\n\n**2. Derivation and Computation of Gradient Ratios ($\\eta_i, \\eta_e$)**\n\nThe dimensionless gradient ratios $\\eta_s$ are defined as the ratio of the density gradient scale length $L_n$ to the temperature gradient scale length $L_{T_s}$ for species $s$.\n$$ \\eta_i = \\frac{L_n}{L_{T_i}} \\quad \\text{and} \\quad \\eta_e = \\frac{L_n}{L_{T_e}} $$\nUsing the given values $L_n = 0.140 \\, \\text{m}$, $L_{T_i} = 0.070 \\, \\text{m}$, and $L_{T_e} = 0.100 \\, \\text{m}$:\n$$ \\eta_i = \\frac{0.140}{0.070} = 2.00 $$\n$$ \\eta_e = \\frac{0.140}{0.100} = 1.40 $$\n\n**3. Derivation and Computation of Normalized Electron Collisionality ($\\nu^*$**)**\n\nThe normalized electron collisionality is given by $\\nu^{\\ast}=\\nu_{ei}\\,(qR/v_{\\mathrm{th},e})$, where $v_{\\mathrm{th},e}$ is the electron thermal velocity and $\\nu_{ei}$ is the electron-ion collision frequency.\nFirst, we compute the electron thermal velocity $v_{\\mathrm{th},e} = \\sqrt{2k_B T_e / m_e}$:\n$$ v_{\\mathrm{th},e} = \\sqrt{\\frac{2 \\times (3.204 \\times 10^{-16} \\, \\text{J})}{9.109 \\times 10^{-31} \\, \\text{kg}}} \\approx 2.652 \\times 10^7 \\, \\text{m/s} $$\nNext, we compute the Spitzer electron-ion collision frequency for a plasma with singly charged ions ($Z=1$). The standard formula for a Maxwellian distribution is:\n$$ \\nu_{ei} = \\frac{4\\sqrt{2\\pi}}{3} \\frac{n_i Z^2 e^4 \\ln\\Lambda}{(4\\pi \\varepsilon_0)^2 m_e^{1/2} (k_B T_e)^{3/2}} $$\nUsing $n_i = n = 6.00 \\times 10^{19} \\, \\text{m}^{-3}$, $Z=1$, and $\\ln\\Lambda = 17.0$:\n$$ \\nu_{ei} = \\frac{4\\sqrt{2\\pi}}{3} \\frac{(6.00 \\times 10^{19})(1)^2(1.602 \\times 10^{-19})^4(17.0)}{(4\\pi \\times 8.854 \\times 10^{-12})^2(9.109 \\times 10^{-31})^{1/2}(3.204 \\times 10^{-16})^{3/2}} \\approx 3.312 \\times 10^4 \\, \\text{s}^{-1} $$\nThe characteristic parallel transit time is scaled by the factor $qR/v_{\\mathrm{th},e}$. With $q=1.60$ and $R=1.70 \\, \\text{m}$:\n$$ \\frac{qR}{v_{\\mathrm{th},e}} = \\frac{1.60 \\times 1.70 \\, \\text{m}}{2.652 \\times 10^7 \\, \\text{m/s}} \\approx 1.026 \\times 10^{-7} \\, \\text{s} $$\nFinally, we compute $\\nu^*$:\n$$ \\nu^* = \\nu_{ei} \\frac{qR}{v_{\\mathrm{th},e}} = (3.312 \\times 10^4 \\, \\text{s}^{-1}) \\times (1.026 \\times 10^{-7} \\, \\text{s}) \\approx 0.003398 $$\nRounding to three significant figures, $\\nu^* = 0.00340$.\n\n**4. Derivation and Computation of the Normalized Wavenumber ($k_\\perp \\rho_s$)**\n\nThe dimensionless product $k_{\\perp}\\rho_{s}$ normalizes the perpendicular wavenumber $k_\\perp$ to the sound Larmor radius $\\rho_s$.\nThe sound Larmor radius is $\\rho_s = c_s / \\Omega_i$, where $c_s$ is the ion-acoustic speed and $\\Omega_i$ is the ion gyrofrequency.\nThe ion-acoustic speed is $c_s = \\sqrt{k_B T_e / m_i}$:\n$$ c_s = \\sqrt{\\frac{3.204 \\times 10^{-16} \\, \\text{J}}{3.3452 \\times 10^{-27} \\, \\text{kg}}} \\approx 3.095 \\times 10^5 \\, \\text{m/s} $$\nThe ion gyrofrequency is $\\Omega_i = eB / m_i$ (since $Z=1$):\n$$ \\Omega_i = \\frac{(1.602 \\times 10^{-19} \\, \\text{C}) \\times (3.20 \\, \\text{T})}{3.3452 \\times 10^{-27} \\, \\text{kg}} \\approx 1.532 \\times 10^8 \\, \\text{rad/s} $$\nThe sound Larmor radius is therefore:\n$$ \\rho_s = \\frac{c_s}{\\Omega_i} = \\frac{3.095 \\times 10^5 \\, \\text{m/s}}{1.532 \\times 10^8 \\, \\text{rad/s}} \\approx 2.020 \\times 10^{-3} \\, \\text{m} $$\nFinally, we compute the dimensionless product with the given perpendicular wavenumber $k_\\perp = 4.00 \\times 10^2 \\, \\text{m}^{-1}$:\n$$ k_{\\perp}\\rho_{s} = (4.00 \\times 10^2 \\, \\text{m}^{-1}) \\times (2.020 \\times 10^{-3} \\, \\text{m}) \\approx 0.808 $$\n\n**5. Dominant Turbulence Regime Categorization**\n\nThe computed dimensionless parameters are:\n- $\\beta = 0.0118$\n- $\\eta_i = 2.00$\n- $\\eta_e = 1.40$\n- $\\nu^* = 0.00340$\n- $k_{\\perp}\\rho_{s} = 0.808$\n\nBased on these values, we determine the dominant turbulence regime:\n- The normalized wavenumber $k_{\\perp}\\rho_{s} \\approx 0.808$ is characteristic of ion-scale turbulence ($k_{\\perp}\\rho_{s} \\lesssim 1$). This immediately suggests that Electron Temperature Gradient (ETG) turbulence, which occurs at much smaller electron scales ($k_{\\perp}\\rho_{s} \\gg 1$), is not the dominant regime at this wavenumber. So, **ETG (3)** is unlikely.\n- The normalized collisionality $\\nu^* \\approx 0.00340$ is very low, indicating a collisionless or \"banana\" regime plasma. This rules out instability regimes that require significant resistivity or collisional dissipation. Therefore, **Resistive drift-wave (4)** and **Microtearing (5)** modes, which are typically dominant at higher collisionality, are not expected to be the primary instability.\n- The competition is therefore between Ion Temperature Gradient (ITG) modes and Trapped Electron Modes (TEM).\n- The driving term for ITG instability is $\\eta_i = L_n/L_{T_i}$. The computed value $\\eta_i = 2.00$ is well above the typical critical threshold for instability ($\\eta_{i, \\text{crit}} \\sim 1$). Furthermore, the normalized ion temperature gradient, $R/L_{T_i} = 1.70/0.070 \\approx 24.3$, is very large, indicating a strong thermodynamic drive.\n- The driving term for TEM instability is related to $\\eta_e = L_n/L_{T_e}$ and the density gradient. The value $\\eta_e = 1.40$ also indicates a source of instability.\n- However, comparing the strength of the drives, the ion temperature gradient is particularly steep ($L_{T_i}=0.070\\,\\mathrm{m}$ is the shortest of all gradient scale lengths provided). The resulting value of $\\eta_i=2.00$ is significantly larger than $\\eta_e=1.40$. In typical tokamak core conditions where $T_i \\sim T_e$ (here $T_i = 1.5 T_e$) and both gradients are unstable, the mode with the stronger drive parameter ($\\eta_i > \\eta_e$) and the larger normalized gradient ($R/L_{T_i} > R/L_{T_e}$) is generally expected to be dominant.\n- The moderate beta value $\\beta \\approx 1.2\\%$ can lead to electromagnetic modifications of the dominant mode (e.g., coupling to kinetic ballooning modes), but it is unlikely to change the fundamental driver, which is the ion temperature gradient.\n\nGiven the strong ITG drive ($\\eta_i=2.00$) at an ion-scale wavenumber ($k_\\perp\\rho_s=0.808$) in a collisionless plasma, the dominant turbulence regime is concluded to be **Ion Temperature Gradient (ITG) dominated**. The integer code is $1$.\n\nThe values for the final answer, rounded to three significant figures, are:\n- $\\beta = 0.0118$\n- $\\eta_i = 2.00$\n- $\\eta_e = 1.40$\n- $\\nu^* = 0.00340$\n- $k_{\\perp}\\rho_{s} = 0.808$\n- Regime code = $1$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0118 & 2.00 & 1.40 & 0.00340 & 0.808 & 1 \\end{pmatrix} } $$"
        }
    ]
}