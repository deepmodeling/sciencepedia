{
    "hands_on_practices": [
        {
            "introduction": "在模拟复杂的湍流之前，我们必须首先理解数值方法如何影响最基本的物理过程——线性波的传播。本练习将引导您通过推导数值色散关系，来量化由空间离散化引入的相位误差。这是理解和评估波模拟中数值不准确性的一个基本步骤。",
            "id": "4183775",
            "problem": "一个具有均匀背景磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ 和平衡密度梯度 $\\nabla n_{0} = \\partial_{x} n_{0} \\, \\hat{\\mathbf{x}}$ 的板状聚变等离子体支持静电漂移波。考虑仅在副法线方向 $y$ 和时间 $t$ 上变化的小振幅线性微扰，并假设电子是等温、绝热的，离子是冷的；准中性条件必须满足。从离子连续性方程和$\\mathbf{E}\\times\\mathbf{B}$漂移出发，推导一个关于静电势 $\\phi(y,t)$ 的线性演化方程。该方程应为适用于此板状几何中漂移波传播的、关于 $y$ 和 $t$ 的一阶双曲型偏微分方程。根据此连续介质方程，确定在 $y$ 方向的平面波解的连续介质色散关系。\n\n现在，选择一种空间离散化方案，在间距为 $\\Delta y$ 的均匀网格上对 $y$ 方向的导数使用二阶中心有限差分，并将时间视为连续的（线方法）。将此空间离散化方案应用于推导出的线性演化方程，以获得具有副法线波数 $k_{y}$ 的平面波的半离散数值色散关系。\n\n将精确（连续介质）漂移波的相速度定义为 $c_{\\mathrm{exact}}$，将半离散波的相速度定义为 $c_{\\mathrm{num}}$。使用半离散数值色散关系，量化相对相位误差 $\\varepsilon_{\\phi}(\\Delta y) \\equiv \\frac{c_{\\mathrm{num}}}{c_{\\mathrm{exact}}} - 1$（定义为相速度的分数偏差），将其表示为 $k_{y}$ 和 $\\Delta y$ 的解析函数。\n\n将您关于 $\\varepsilon_{\\phi}(\\Delta y)$ 的最终答案表示为闭式解析表达式。最终表达式中不应进行数值取整，也不应出现物理单位。推导必须从上述基本守恒定律和本构关系开始，并且所有步骤都必须在科学上保持一致。您最终的方框答案必须只包含所要求的 $\\varepsilon_{\\phi}(\\Delta y)$ 的解析表达式。",
            "solution": "推导从线性化的离子连续性方程开始：\n$$ \\frac{\\partial n_{i1}}{\\partial t} + \\nabla \\cdot (n_{0} \\mathbf{v}_{i1}) = 0 $$\n其中 $n_{i1}$ 是扰动离子密度，$\\mathbf{v}_{i1}$ 是扰动离子流体速度。对于冷离子，其主要运动是$\\mathbf{E}\\times\\mathbf{B}$漂移：\n$$ \\mathbf{v}_{i1} = \\mathbf{v}_{\\mathbf{E}} = \\frac{\\mathbf{E}_{1} \\times \\mathbf{B}}{B^{2}} $$\n静电场微扰为 $\\mathbf{E}_{1} = -\\nabla \\phi$。鉴于微扰仅在 $y$ 和 $t$ 上变化，我们有 $\\phi = \\phi(y,t)$，因此 $\\mathbf{E}_{1} = -\\frac{\\partial\\phi}{\\partial y}\\hat{\\mathbf{y}}$。背景磁场为 $\\mathbf{B} = B\\hat{\\mathbf{z}}$。那么，扰动离子速度为：\n$$ \\mathbf{v}_{i1} = \\frac{(-\\frac{\\partial\\phi}{\\partial y}\\hat{\\mathbf{y}}) \\times (B\\hat{\\mathbf{z}})}{B^{2}} = -\\frac{1}{B}\\frac{\\partial\\phi}{\\partial y} (\\hat{\\mathbf{y}} \\times \\hat{\\mathbf{z}}) = -\\frac{1}{B}\\frac{\\partial\\phi}{\\partial y} \\hat{\\mathbf{x}} $$\n连续性方程中的散度项变为：\n$$ \\nabla \\cdot (n_{0} \\mathbf{v}_{i1}) = \\frac{\\partial}{\\partial x}(n_{0} v_{i1,x}) + \\frac{\\partial}{\\partial y}(n_{0} v_{i1,y}) + \\frac{\\partial}{\\partial z}(n_{0} v_{i1,z}) $$\n由于 $\\mathbf{v}_{i1}$ 只有一个 $x$ 分量，该项简化为 $\\frac{\\partial}{\\partial x}(n_{0} v_{i1,x})$。由于 $v_{i1,x}$ 不依赖于 $x$，我们有：\n$$ \\nabla \\cdot (n_{0} \\mathbf{v}_{i1}) = v_{i1,x} \\frac{\\partial n_{0}}{\\partial x} = \\left(-\\frac{1}{B}\\frac{\\partial\\phi}{\\partial y}\\right) \\frac{\\partial n_{0}}{\\partial x} $$\n将此代入离子连续性方程，得到：\n$$ \\frac{\\partial n_{i1}}{\\partial t} - \\frac{1}{B} \\frac{\\partial n_{0}}{\\partial x} \\frac{\\partial\\phi}{\\partial y} = 0 $$\n为了封闭该方程组，我们将密度微扰与势关联起来。准中性假设意味着 $n_{i1} = n_{e1}$，其中 $n_{e1}$ 是扰动电子密度。对于等温、绝热的电子，密度微扰遵循玻尔兹曼关系：\n$$ \\frac{n_{e1}}{n_{0}} = \\frac{e\\phi}{T_{e}} $$\n其中 $e$ 是元电荷，$T_e$ 是恒定的电子温度。将 $n_{i1} = n_{e1} = n_{0}\\frac{e\\phi}{T_{e}}$ 代入离子方程：\n$$ \\frac{\\partial}{\\partial t}\\left(n_{0}\\frac{e\\phi}{T_{e}}\\right) - \\frac{1}{B} \\frac{\\partial n_{0}}{\\partial x} \\frac{\\partial\\phi}{\\partial y} = 0 $$\n由于 $n_{0}$ 是一个不随时间变化的平衡量，而 $\\phi$ 不依赖于 $x$，我们可以写出：\n$$ n_{0}\\frac{e}{T_{e}}\\frac{\\partial\\phi}{\\partial t} - \\frac{1}{B} \\frac{\\partial n_{0}}{\\partial x} \\frac{\\partial\\phi}{\\partial y} = 0 $$\n两边同除以 $n_{0}\\frac{e}{T_{e}}$，得到 $\\phi(y,t)$ 的线性演化方程：\n$$ \\frac{\\partial\\phi}{\\partial t} - \\frac{T_{e}}{eB} \\left(\\frac{1}{n_{0}}\\frac{\\partial n_{0}}{\\partial x}\\right) \\frac{\\partial\\phi}{\\partial y} = 0 $$\n这是一个一阶双曲型偏微分方程。我们将特征漂移波速度 $v_{*}$ 定义为：\n$$ v_{*} \\equiv -\\frac{T_{e}}{eB} \\frac{1}{n_{0}}\\frac{\\partial n_{0}}{\\partial x} $$\n该方程简化为经典的平流方程：\n$$ \\frac{\\partial\\phi}{\\partial t} + v_{*} \\frac{\\partial\\phi}{\\partial y} = 0 $$\n为了求出连续介质色散关系，我们将平面波解 $\\phi(y,t) = \\phi_{0} \\exp[i(k_{y}y - \\omega t)]$ 代入该方程：\n$$ -i\\omega \\phi + v_{*} (ik_{y}) \\phi = 0 $$\n这给出了精确的色散关系：$\\omega = k_{y}v_{*}$。\n\n接下来，我们在均匀网格 $y_{j} = j \\Delta y$ 上使用二阶中心有限差分来离散化空间导数 $\\frac{\\partial\\phi}{\\partial y}$：\n$$ \\left. \\frac{\\partial\\phi}{\\partial y} \\right|_{y_j} \\approx \\frac{\\phi(y_{j+1},t) - \\phi(y_{j-1},t)}{2\\Delta y} = \\frac{\\phi_{j+1}(t) - \\phi_{j-1}(t)}{2\\Delta y} $$\n将此应用于该偏微分方程，得到半离散的常微分方程组（线方法）：\n$$ \\frac{d\\phi_{j}}{dt} + v_{*} \\left(\\frac{\\phi_{j+1} - \\phi_{j-1}}{2\\Delta y}\\right) = 0 $$\n为了求出数值色散关系，我们代入网格层面上的平面波解 $\\phi_{j}(t) = \\tilde{\\phi} \\exp[i(k_{y}j\\Delta y - \\omega_{\\mathrm{num}}t)]$：\n$$ -i\\omega_{\\mathrm{num}}\\phi_{j} + v_{*} \\left(\\frac{\\phi_{j}e^{ik_{y}\\Delta y} - \\phi_{j}e^{-ik_{y}\\Delta y}}{2\\Delta y}\\right) = 0 $$\n消去 $\\phi_{j}$ 并乘以 $i$，得到：\n$$ \\omega_{\\mathrm{num}} = v_{*} \\left(\\frac{e^{ik_{y}\\Delta y} - e^{-ik_{y}\\Delta y}}{2i\\Delta y}\\right) $$\n使用欧拉公式 $\\sin(x) = \\frac{e^{ix} - e^{-ix}}{2i}$，我们得到半离散的数值色散关系：\n$$ \\omega_{\\mathrm{num}} = v_{*} \\frac{\\sin(k_{y}\\Delta y)}{\\Delta y} $$\n精确波的相速度为 $c_{\\mathrm{exact}} = \\frac{\\omega}{k_{y}} = \\frac{k_{y}v_{*}}{k_{y}} = v_{*}$。\n半离散数值波的相速度为 $c_{\\mathrm{num}} = \\frac{\\omega_{\\mathrm{num}}}{k_{y}} = \\frac{v_{*}}{\\Delta y k_{y}}\\sin(k_{y}\\Delta y) = v_{*} \\frac{\\sin(k_{y}\\Delta y)}{k_{y}\\Delta y}$。\n相对相位误差定义为 $\\varepsilon_{\\phi}(\\Delta y) = \\frac{c_{\\mathrm{num}}}{c_{\\mathrm{exact}}} - 1$：\n$$ \\varepsilon_{\\phi}(\\Delta y) = \\frac{v_{*} \\frac{\\sin(k_{y}\\Delta y)}{k_{y}\\Delta y}}{v_{*}} - 1 $$\n这简化为相对相位误差的最终闭式表达式：\n$$ \\varepsilon_{\\phi}(\\Delta y) = \\frac{\\sin(k_{y}\\Delta y)}{k_{y}\\Delta y} - 1 $$\n该表达式量化了由二阶中心差分格式引入的数值色散误差，并将其表示为波数 $k_y$ 和网格间距 $\\Delta y$ 乘积的函数。",
            "answer": "$$\\boxed{\\frac{\\sin(k_{y} \\Delta y)}{k_{y} \\Delta y} - 1}$$"
        },
        {
            "introduction": "空间离散化之后，偏微分方程就转化为一个需要进行时间演化的常微分方程组（ODE）。本练习聚焦于时间积分这一环节，要求您为线性化的长谷川-三间和长谷川-若谷方程组实现并比较两种常见的时间推进格式：显式欧拉法和克兰克-尼科尔森法。通过这个实践，您将对数值方法的稳定性和精度有更直观的认识。",
            "id": "4204295",
            "problem": "您的任务是在聚变等离子体湍流模拟的背景下，为 Hasegawa-Mima 方程和 Hasegawa-Wakatani 方程的线性化形式设计并实现数值时间推进求解器。您的实现必须基于第一性原理推导，从平板位形中的基本静电漂移波模型出发，并且必须在无量纲归一化下对波数矢量为 $\\mathbf{k} = (k_x, k_y)$ 的单一傅里叶模式进行操作。所有量都是无量纲的；因此，所有数值输出都必须是无单位的。\n\n本问题的基础是二维静电准中性漂移波模型，该模型使用绝热电子响应和等温离子。在此归一化中，由沿 $x$ 方向的恒定密度梯度引起的背景逆磁漂移产生一个与 $\\partial_y \\phi$ 成正比的线性驱动项，其中 $\\phi$ 是静电势。\n\nHasegawa-Mima 方程通过势涡量 $q = \\nabla^2 \\phi - \\phi$ 将静电势与离子涡量耦合起来。在线性化体系中（忽略非线性泊松括号），演化方程为\n$$\n\\frac{\\partial}{\\partial t}\\left(\\nabla^2 \\phi - \\phi \\right) + \\frac{\\partial \\phi}{\\partial y} = 0,\n$$\n必须对单一傅里叶模式分析该方程。对于振幅为 $\\hat{\\phi}(t)$、波数为 $\\mathbf{k}$ 的傅里叶模式，必须使用傅里叶表示来推导关于 $\\hat{\\phi}(t)$ 的标量线性常微分方程。\n\nHasegawa-Wakatani 双场模型通过平行电阻耦合参数 $\\alpha  0$ 将静电势 $\\phi$ 和密度涨落 $n$ 耦合起来。在线性化体系中（忽略非线性泊松括号），并且在与逆磁漂移相同的归一化下，演化方程为\n$$\n\\frac{\\partial \\zeta}{\\partial t} = -\\frac{\\partial \\phi}{\\partial y} - \\alpha\\left(\\phi - n\\right), \\qquad \\frac{\\partial n}{\\partial t} = -\\frac{\\partial \\phi}{\\partial y} - \\alpha\\left(n - \\phi\\right),\n$$\n其中 $\\zeta = \\nabla^2 \\phi$。对于单一傅里叶模式，您必须为傅里叶振幅矢量 $\\begin{bmatrix}\\hat{\\phi}(t) \\\\ \\hat{n}(t)\\end{bmatrix}$ 推导一个线性常微分方程组，其矩阵算子依赖于 $\\mathbf{k}$ 和 $\\alpha$。\n\n您的程序必须为推导出的线性化傅里叶模式系统，实现以下针对大小为 $\\Delta t$ 的单个时间步长的数值时间步进格式：\n\n- 针对每个模型的显式欧拉格式。\n- 针对每个模型的 Crank–Nicolson 格式。\n\n对于 Hasegawa-Mima 模型，您必须使用傅里叶模式的闭式解推导单个时间步的精确放大因子。对于 Hasegawa-Wakatani 模型，您必须通过计算推导出的线性算子的矩阵指数来计算单个时间步的精确放大矩阵。\n\n对于每个测试用例，计算由显式欧拉格式和 Crank–Nicolson 格式产生的数值放大（Hasegawa-Mima 模型为标量因子，Hasegawa-Wakatani 模型为矩阵）。然后，按如下方式计算相对于精确放大的误差（Hasegawa-Mima 的精确复数标量因子和 Hasegawa-Wakatani 的精确复数矩阵）：\n\n- 对于 Hasegawa-Mima 模型，误差是数值放大因子与精确放大因子之差的绝对值（一个非负实数浮点数）。\n- 对于 Hasegawa-Wakatani 模型，误差是数值放大矩阵与精确放大矩阵之差的 Frobenius 范数（一个非负实数浮点数）。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔的浮点数列表。对于每个测试用例，该列表必须包含两个浮点数，顺序为“显式欧拉误差”后跟“Crank–Nicolson 误差”。每个浮点数必须四舍五入到六位小数。总输出列表必须按下面给出的顺序连接所有测试用例的数对。\n\n所有量都是无量纲的。角度不适用。百分比不适用。以浮点数形式提供结果。\n\n使用以下参数值的测试套件，其设计旨在覆盖基线、高 $k$ 行为、耦合强度变化和边界条件：\n\n- 测试用例 $1$ (Hasegawa–Mima): $k_x = 1$, $k_y = 1$, $\\Delta t = 0.05$。\n- 测试用例 $2$ (Hasegawa–Mima): $k_x = 10$, $k_y = 5$, $\\Delta t = 0.01$。\n- 测试用例 $3$ (Hasegawa–Mima, 边界情况): $k_x = 3$, $k_y = 0$, $\\Delta t = 0.1$。\n- 测试用例 $4$ (Hasegawa–Wakatani): $k_x = 1$, $k_y = 0.3$, $\\alpha = 0.1$, $\\Delta t = 0.05$。\n- 测试用例 $5$ (Hasegawa–Wakatani): $k_x = 2$, $k_y = 1.0$, $\\alpha = 2.0$, $\\Delta t = 0.02$。\n- 测试用例 $6$ (Hasegawa–Wakatani, 边界情况): $k_x = 1$, $k_y = 0$, $\\alpha = 1.0$, $\\Delta t = 0.05$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下：\n$$\n[\\text{HM 情况 }1\\ \\text{欧拉},\\ \\text{HM 情况 }1\\ \\text{CN},\\ \\text{HM 情况 }2\\ \\text{欧拉},\\ \\text{HM 情况 }2\\ \\text{CN},\\ \\text{HM 情况 }3\\ \\text{欧拉},\\ \\text{HM 情况 }3\\ \\text{CN},\\ \\text{HW 情况 }4\\ \\text{欧拉},\\ \\text{HW 情况 }4\\ \\text{CN},\\ \\text{HW 情况 }5\\ \\text{欧拉},\\ \\text{HW 情况 }5\\ \\text{CN},\\ \\text{HW 情况 }6\\ \\text{欧拉},\\ \\text{HW 情况 }6\\ \\text{CN}]\n$$\n每个条目都是一个四舍五入到六位小数的浮点数，并且必须打印完整的列表，不带空格。",
            "solution": "我们从平板位形中的基本静电漂移波模型开始，该模型在 Hasegawa-Mima 和 Hasegawa-Wakatani 方程中使用了无量纲归一化。绝热电子响应和准中性条件产生了 Hasegawa-Mima 势涡量，而均匀的背景密度梯度引入了与 $\\partial_y \\phi$ 成正比的逆磁漂移项。我们推导了适用于单一傅里叶模式的线性化方程，并构建了数值求解器和精确放大算子。\n\n对于 Hasegawa–Mima 方程，势涡量为 $q = \\nabla^2 \\phi - \\phi$。忽略非线性泊松括号项，线性化方程为\n$$\n\\frac{\\partial}{\\partial t}\\left(\\nabla^2 \\phi - \\phi\\right) + \\frac{\\partial \\phi}{\\partial y} = 0.\n$$\n考虑单一傅里叶模式 $\\phi(\\mathbf{x}, t) = \\hat{\\phi}(t) \\exp\\left(i (k_x x + k_y y)\\right)$。在傅里叶空间中，拉普拉斯算子的作用是 $\\nabla^2 \\phi \\rightarrow -k^2 \\hat{\\phi}$，其中 $k^2 = k_x^2 + k_y^2$，$y$ 方向导数的作用是 $\\partial_y \\phi \\rightarrow i k_y \\hat{\\phi}$。将傅里叶表示代入线性化的 Hasegawa–Mima 方程，得到\n$$\n\\frac{d}{dt}\\left((-k^2 - 1) \\hat{\\phi}(t)\\right) + i k_y \\hat{\\phi}(t) = 0.\n$$\n解出 $\\frac{d \\hat{\\phi}}{dt}$ 可得\n$$\n\\frac{d \\hat{\\phi}}{dt} = - i \\omega \\hat{\\phi}(t), \\qquad \\omega = \\frac{k_y}{1 + k^2}.\n$$\n这是一个带常系数的标量线性常微分方程。它在时间步长 $\\Delta t$ 内的精确单步放大因子为\n$$\nG_{\\text{exact}}^{\\text{HM}} = \\exp\\left(- i \\omega \\Delta t\\right).\n$$\n对于数值格式：\n- 将显式欧拉格式应用于 $\\frac{d \\hat{\\phi}}{dt} = - i \\omega \\hat{\\phi}$ 得到\n$$\nG_{\\text{E}}^{\\text{HM}} = 1 - i \\omega \\Delta t.\n$$\n- 将 Crank–Nicolson 格式应用于同一方程（该格式使用梯形法则处理线性项）得到\n$$\nG_{\\text{CN}}^{\\text{HM}} = \\frac{1 - i \\omega \\Delta t / 2}{1 + i \\omega \\Delta t / 2}.\n$$\n将给定格式的误差定义为数值放大因子与精确放大因子之差的模，\n$$\n\\varepsilon_{\\text{scheme}}^{\\text{HM}} = \\left|G_{\\text{scheme}}^{\\text{HM}} - G_{\\text{exact}}^{\\text{HM}}\\right|.\n$$\n注意，对于 $k_y = 0$ 的边界情况，我们有 $\\omega = 0$，因此 $G_{\\text{exact}}^{\\text{HM}} = 1$，$G_{\\text{E}}^{\\text{HM}} = 1$ 和 $G_{\\text{CN}}^{\\text{HM}} = 1$，如预期那样产生零误差。\n\n对于 Hasegawa–Wakatani 模型，具有电阻耦合 $\\alpha$ 和相同逆磁漂移归一化的线性化双场系统（忽略泊松括号非线性项）为\n$$\n\\frac{\\partial \\zeta}{\\partial t} = -\\frac{\\partial \\phi}{\\partial y} - \\alpha\\left(\\phi - n\\right), \\qquad \\frac{\\partial n}{\\partial t} = -\\frac{\\partial \\phi}{\\partial y} - \\alpha\\left(n - \\phi\\right), \\qquad \\zeta = \\nabla^2 \\phi.\n$$\n使用傅里叶表示，我们有 $\\zeta \\rightarrow -k^2 \\hat{\\phi}$ 和 $\\partial_y \\phi \\rightarrow i k_y \\hat{\\phi}$。代入后得到傅里叶振幅的方程：\n$$\n- k^2 \\frac{d \\hat{\\phi}}{dt} = - i k_y \\hat{\\phi} - \\alpha\\left(\\hat{\\phi} - \\hat{n}\\right), \\qquad \\frac{d \\hat{n}}{dt} = - i k_y \\hat{\\phi} - \\alpha\\left(\\hat{n} - \\hat{\\phi}\\right).\n$$\n从第一个方程解出 $\\frac{d \\hat{\\phi}}{dt}$：\n$$\n\\frac{d \\hat{\\phi}}{dt} = \\frac{i k_y}{k^2} \\hat{\\phi} + \\frac{\\alpha}{k^2}\\left(\\hat{\\phi} - \\hat{n}\\right).\n$$\n第二个方程是\n$$\n\\frac{d \\hat{n}}{dt} = - i k_y \\hat{\\phi} - \\alpha \\hat{n} + \\alpha \\hat{\\phi}.\n$$\n我们将该系统写成矢量形式 $\\frac{d}{dt} \\mathbf{u} = \\mathbf{A} \\mathbf{u}$，其中 $\\mathbf{u} = \\begin{bmatrix}\\hat{\\phi} \\\\ \\hat{n}\\end{bmatrix}$ 且\n$$\n\\mathbf{A} = \\begin{bmatrix}\n\\frac{i k_y}{k^2} + \\frac{\\alpha}{k^2}  - \\frac{\\alpha}{k^2} \\\\\n\\alpha - i k_y  - \\alpha\n\\end{bmatrix}.\n$$\n在时间步长 $\\Delta t$ 内的精确单步放大矩阵是矩阵指数\n$$\n\\mathbf{G}_{\\text{exact}}^{\\text{HW}} = \\exp\\left(\\mathbf{A} \\Delta t\\right).\n$$\n对于数值格式：\n- 显式欧拉格式得到\n$$\n\\mathbf{G}_{\\text{E}}^{\\text{HW}} = \\mathbf{I} + \\Delta t \\, \\mathbf{A},\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 的单位矩阵。\n- Crank–Nicolson 格式得到\n$$\n\\mathbf{G}_{\\text{CN}}^{\\text{HW}} = \\left(\\mathbf{I} - \\frac{\\Delta t}{2} \\mathbf{A}\\right)^{-1} \\left(\\mathbf{I} + \\frac{\\Delta t}{2} \\mathbf{A}\\right).\n$$\n将给定格式的误差定义为数值放大矩阵与精确放大矩阵之差的 Frobenius 范数，\n$$\n\\varepsilon_{\\text{scheme}}^{\\text{HW}} = \\left\\|\\mathbf{G}_{\\text{scheme}}^{\\text{HW}} - \\mathbf{G}_{\\text{exact}}^{\\text{HW}}\\right\\|_{\\text{F}},\n$$\n其中 $\\|\\cdot\\|_{\\text{F}}$ 是 Frobenius 范数，$\\|\\mathbf{M}\\|_{\\text{F}} = \\sqrt{\\sum_{i,j} |M_{ij}|^2}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef hm_errors(kx, ky, dt):\n    \"\"\"\n    Compute Explicit Euler and Crank-Nicolson one-step amplification errors\n    for the linearized Hasegawa-Mima equation for a single Fourier mode.\n    Returns (err_euler, err_cn) as floats.\n    \"\"\"\n    k2 = kx**2 + ky**2\n    if kx == 0 and ky == 0:\n        k2 = 1.0 # Avoid division by zero, although not in tests\n    if 1.0 + k2 == 0:\n        omega = 0.0\n    else:\n        # Drift-wave frequency for HM linearized equation\n        omega = ky / (1.0 + k2)\n    # Exact scalar amplification over one step\n    G_exact = np.exp(-1j * omega * dt)\n    # Explicit Euler amplification\n    G_euler = 1.0 - 1j * omega * dt\n    # Crank-Nicolson amplification\n    half = 0.5 * omega * dt\n    # Avoid division by zero if denominator is zero\n    denom_cn = 1.0 + 1j * half\n    if np.abs(denom_cn)  1e-15:\n        G_cn = np.inf # or handle as error\n    else:\n        G_cn = (1.0 - 1j * half) / denom_cn\n    # Errors are absolute differences of complex scalars\n    err_euler = np.abs(G_euler - G_exact)\n    err_cn = np.abs(G_cn - G_exact)\n    return float(err_euler), float(err_cn)\n\ndef hw_errors(kx, ky, alpha, dt):\n    \"\"\"\n    Compute Explicit Euler and Crank-Nicolson one-step amplification errors\n    for the linearized Hasegawa-Wakatani two-field model for a single Fourier mode.\n    Returns (err_euler, err_cn) as floats (Frobenius norms).\n    \"\"\"\n    k2 = kx**2 + ky**2\n    if k2 == 0: # Handle k=0 case to prevent division by zero\n        A = np.array([\n            [alpha, -alpha],\n            [alpha, -alpha]\n        ], dtype=np.complex128)\n    else:\n        # Build the 2x2 complex matrix A for d/dt [phi, n]^T = A [phi, n]^T\n        # A = [[ i ky/k2 + alpha/k2,    - alpha/k2 ],\n        #      [ alpha - i ky,          - alpha    ]]\n        A = np.array([\n            [1j * ky / k2 + alpha / k2, -alpha / k2],\n            [alpha - 1j * ky,           -alpha    ]\n        ], dtype=np.complex128)\n    I = np.eye(2, dtype=np.complex128)\n    # Exact amplification matrix via matrix exponential\n    G_exact = expm(A * dt)\n    # Explicit Euler amplification matrix\n    G_euler = I + dt * A\n    # Crank-Nicolson amplification matrix\n    G_cn = np.linalg.solve(I - 0.5 * dt * A, I + 0.5 * dt * A)\n    # Errors are Frobenius norms of matrix differences\n    err_euler = np.linalg.norm(G_euler - G_exact, ord='fro')\n    err_cn = np.linalg.norm(G_cn - G_exact, ord='fro')\n    return float(err_euler), float(err_cn)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case yields two floats: (Euler error, CN error).\n    test_cases_hm = [\n        # (kx, ky, dt)\n        (1.0, 1.0, 0.05),   # HM case 1\n        (10.0, 5.0, 0.01),  # HM case 2\n        (3.0, 0.0, 0.10),   # HM case 3 (edge ky=0)\n    ]\n    test_cases_hw = [\n        # (kx, ky, alpha, dt)\n        (1.0, 0.3, 0.1, 0.05),  # HW case 4\n        (2.0, 1.0, 2.0, 0.02),  # HW case 5\n        (1.0, 0.0, 1.0, 0.05),  # HW case 6 (edge ky=0)\n    ]\n\n    results = []\n    # Compute HM errors\n    for (kx, ky, dt) in test_cases_hm:\n        err_e, err_cn = hm_errors(kx, ky, dt)\n        results.append(err_e)\n        results.append(err_cn)\n    # Compute HW errors\n    for (kx, ky, alpha, dt) in test_cases_hw:\n        err_e, err_cn = hw_errors(kx, ky, alpha, dt)\n        results.append(err_e)\n        results.append(err_cn)\n\n    # Format each result to six decimal places, no spaces, single-line output.\n    formatted = \",\".join(f\"{r:.6f}\" for r in results)\n    print(f\"[{formatted}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "这些方程的真正复杂性在于其非线性平流项，它描述了等离子体中涡旋之间的相互作用。本练习旨在揭示选择正确的空间离散格式的极端重要性。通过比较一个简单的中心差分格式和一个结构保持格式（即 Arakawa Jacobian），您将亲眼见证数值选择如何影响能量和拟涡能等基本物理量的守恒性。",
            "id": "4204282",
            "problem": "考虑用于聚变等离子体湍流模拟的二维静电漂移波模型，特别是 Hasegawa-Mima (HM) 方程和 Hasegawa-Wakatani (HW) 系统。重点关注由雅可比式表示的平流非线性项及其在均匀周期性网格上的离散化。您的目标是为平流雅可比式实现两种离散化方案，并为 HM 方程定量测试它们的离散守恒性质。\n\n从以下基本和核心定义开始：\n- 无量纲变量下的标量势 $\\,\\phi(x,y,t)\\,$ 的 Hasegawa-Mima (HM) 方程为 $\\,\\partial_t q + J(\\phi,q) = 0\\,$，其中势涡为 $\\,q = \\nabla^2 \\phi - \\phi\\,$，雅可比式为 $\\,J(f,g) = \\partial_x f\\,\\partial_y g - \\partial_y f\\,\\partial_x g\\,$。\n- 在周期性边界条件下，HM 方程守恒两个二次不变量：能量 $\\,E = \\tfrac{1}{2}\\int (|\\nabla \\phi|^2 + \\phi^2)\\,dx\\,dy\\,$ 和拟涡能 $\\,W = \\tfrac{1}{2}\\int q^2\\,dx\\,dy\\,$。利用分部积分和 $\\,1-\\nabla^2\\,$ 的自伴性，这些不变量可以等价地写成 $\\,E = \\tfrac{1}{2}\\int \\phi (1 - \\nabla^2)\\phi\\,dx\\,dy = -\\tfrac{1}{2}\\int \\phi\\,q\\,dx\\,dy\\,$。对于具有周期性边界的光滑场，由于雅可比式的反对称性以及将 $\\,\\phi\\,$ 映射到 $\\,q\\,$ 的算子的自伴性，它们的时间导数满足 $\\,\\tfrac{dE}{dt} = -\\int \\phi\\,J(\\phi,q)\\,dx\\,dy\\,$ 和 $\\,\\tfrac{dW}{dt} = -\\int q\\,J(\\phi,q)\\,dx\\,dy\\,$。\n\n您必须在具有 $\\,N_x\\,$ 个 $x$ 方向格点和 $\\,N_y\\,$ 个 $y$ 方向格点的矩形网格上离散化 $\\,J(\\phi,q)\\,$，其均匀间距为 $\\,\\Delta x = L_x/N_x\\,$ 和 $\\,\\Delta y = L_y/N_y\\,$，并采用周期性边界条件。所有变量都是无量纲的。任何三角函数场构造中的角度都必须以弧度为单位。\n\n实现并比较以下两种雅可比式离散化方案：\n- 方案 C：一种朴素的中心有限差分离散，它在周期性网格上使用二阶中心差分来近似空间导数。\n- 方案 A：一种结构保持离散，旨在在均匀周期性网格上守恒 $\\,E\\,$ 和 $\\,W\\,$ 的离散模拟量。\n\n对于每种方案，在网格上定义离散场 $\\,\\phi_{i,j}\\,$ 和 $\\,q_{i,j}\\,$，并计算仅由平流非线性项引起的能量和拟涡能瞬时产生率的离散模拟量：\n- 离散拟涡能产生率为 $\\,\\mathcal{P}_W = \\sum_{i,j} q_{i,j}\\,J(\\phi,q)_{i,j}\\,\\Delta x\\,\\Delta y\\,$。\n- 离散能量产生率为 $\\,\\mathcal{P}_E = \\sum_{i,j} \\phi_{i,j}\\,J(\\phi,q)_{i,j}\\,\\Delta x\\,\\Delta y\\,$。\n\n如果计算出的产生率在指定的容差 $\\,\\epsilon\\,$ 内与零在数值上无法区分，则称该方案离散地守恒相应的不变量。使用容差 $\\,\\epsilon = 10^{-12}\\,$。\n\n您的程序应：\n- 在指定的网格上构建测试场 $\\,\\phi(x,y)\\,$：\n  - 对于“随机”场，从具有指定种子的标准正态分布中独立同分布地抽取 $\\,\\phi_{i,j}\\,$，然后通过标准的二阶离散拉普拉斯算子计算 $\\,q\\,$：$\\,q = \\nabla^2 \\phi - \\phi\\,$。\n  - 对于“正弦”场，在 $\\,[0,L_x)\\times[0,L_y)\\,$ 上使用 $\\,\\phi(x,y) = \\sin(k_x x)\\cos(k_y y)\\,$，其中 $\\,x = i\\,\\Delta x\\,$ 且 $\\,y = j\\,\\Delta y\\,$，并通过相同的离散拉普拉斯公式计算 $\\,q\\,$。角度以弧度为单位。\n- 使用指定的方案 C 或方案 A 计算 $\\,J(\\phi,q)\\,$。\n- 针对指定的测试用例评估 $\\,\\mathcal{P}_W\\,$ 或 $\\,\\mathcal{P}_E\\,$，并返回一个布尔值，说明 $\\,|\\mathcal{P}_W|  \\epsilon\\,$ 或 $\\,|\\mathcal{P}_E|  \\epsilon\\,$ 是否成立。\n- 使用通过索引环绕实现的严格周期性边界条件。\n\n测试套件：\n提供以下五个测试用例以确保覆盖率，所有数值均以无量纲单位表示：\n1. 测试 $\\,1\\,$：方案 A，在中等网格上使用随机场的拟涡能守恒。\n   - 参数：$\\,N_x = 64\\,$, $\\,N_y = 64\\,$, $\\,L_x = 2\\pi\\,$, $\\,L_y = 2\\pi\\,$, 场类型“随机”，种子 $\\,1234\\,$。\n   - 输出：关于 $\\,|\\mathcal{P}_W|  \\epsilon\\,$ 的布尔值。\n2. 测试 $\\,2\\,$：方案 A，在相同网格和随机场上的能量守恒。\n   - 参数：与测试 $\\,1\\,$ 相同。\n   - 输出：关于 $\\,|\\mathcal{P}_E|  \\epsilon\\,$ 的布尔值。\n3. 测试 $\\,3\\,$：方案 C，在相同网格和随机场上的拟涡能守恒。\n   - 参数：$\\,N_x = 64\\,$, $\\,N_y = 64\\,$, $\\,L_x = 2\\pi\\,$, $\\,L_y = 2\\pi\\,$, 场类型“随机”，种子 $\\,1234\\,$。\n   - 输出：关于 $\\,|\\mathcal{P}_W|  \\epsilon\\,$ 的布尔值。\n4. 测试 $\\,4\\,$：方案 A，在各向异性网格上使用光滑正弦场的能量守恒。\n   - 参数：$\\,N_x = 48\\,$, $\\,N_y = 32\\,$, $\\,L_x = 1.0\\,$, $\\,L_y = 2.5\\,$, 场类型“正弦”，$\\,k_x = 3\\,$ 且 $\\,k_y = 5\\,$。\n   - 输出：关于 $\\,|\\mathcal{P}_E|  \\epsilon\\,$ 的布尔值。\n5. 测试 $\\,5\\,$：方案 A，在非常小的网格上使用正弦场探测边界效应的拟涡能守恒。\n   - 参数：$\\,N_x = 4\\,$, $\\,N_y = 4\\,$, $\\,L_x = 1.0\\,$, $\\,L_y = 1.0\\,$, 场类型“正弦”，$\\,k_x = 1\\,$ 且 $\\,k_y = 1\\,$。\n   - 输出：关于 $\\,|\\mathcal{P}_W|  \\epsilon\\,$ 的布尔值。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，该列表按照上述五个测试的顺序排列结果，例如 $\\,\\,[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5]\\,\\,$，其中每个条目都是一个布尔值。\n\n所有量都是无量纲的，角度必须以弧度为单位。不允许外部输入；所有参数必须根据上述测试套件进行硬编码。输出必须是指定格式的单行文本。",
            "solution": "问题的核心是研究 Hasegawa-Mima (HM) 方程 $\\partial_t q + J(\\phi, q) = 0$ 中平流非线性项 $J(\\phi, q)$ 的离散守恒性质。在连续、周期性情况下，HM 方程拥有两个二次不变量：能量 $E = \\frac{1}{2}\\int (|\\nabla \\phi|^2 + \\phi^2)\\,dx\\,dy = -\\frac{1}{2}\\int \\phi q\\,dx\\,dy$ 和拟涡能 $W = \\frac{1}{2}\\int q^2\\,dx\\,dy$。由平流项引起的变化率为 $\\frac{dE}{dt} = -\\int \\phi J(\\phi,q)\\,dx\\,dy$ 和 $\\frac{dW}{dt} = \\int q \\partial_t q\\,dx\\,dy = -\\int q J(\\phi,q)\\,dx\\,dy$。在连续情况下，由于雅可比式的性质，这些积分恒等于零。我们的任务是验证该性质对离散模拟量是否成立。\n\n问题要求计算离散产生率：\n$$\n\\mathcal{P}_E = \\sum_{i,j} \\phi_{i,j} J(\\phi,q)_{i,j} \\Delta x \\Delta y\n$$\n$$\n\\mathcal{P}_W = \\sum_{i,j} q_{i,j} J(\\phi,q)_{i,j} \\Delta x \\Delta y\n$$\n如果这些和在机器精度范围内为零，则该方案是守恒的。我们现在将形式化在均匀周期性网格上的离散过程，网格点为 $(x_i, y_j) = (i\\Delta x, j\\Delta y)$，场用 $f_{i,j}$ 表示。\n\n首先，我们定义具有周期性边界条件的二阶中心差分算子，这对两种方案都是基础。对于一个离散场 $f_{i,j}$：\n$$\n(\\delta_x f)_{i,j} = \\frac{f_{i+1, j} - f_{i-1, j}}{2 \\Delta x}\n$$\n$$\n(\\delta_y f)_{i,j} = \\frac{f_{i, j+1} - f_{i, j-1}}{2 \\Delta y}\n$$\n索引按 ($N_x, N_y$) 取模，以强制周期性。这些算子的一个关键性质是求和分部：对于任意两个周期场 $f$ 和 $g$，$\\sum_{i,j} f_{i,j} (\\delta_x g)_{i,j} = -\\sum_{i,j} g_{i,j} (\\delta_x f)_{i,j}$。\n\n势涡 $q = \\nabla^2 \\phi - \\phi$ 使用拉普拉斯算子的标准5点格式进行离散化：\n$$\n(\\nabla^2 \\phi)_{i,j} = \\frac{\\phi_{i+1, j} - 2\\phi_{i,j} + \\phi_{i-1, j}}{(\\Delta x)^2} + \\frac{\\phi_{i, j+1} - 2\\phi_{i,j} + \\phi_{i, j-1}}{(\\Delta y)^2}\n$$\n因此，$q_{i,j} = (\\nabla^2 \\phi)_{i,j} - \\phi_{i,j}$。\n\n**方案 C：中心有限差分雅可比式**\n该方案是连续定义 $J(f,g) = \\partial_x f \\partial_y g - \\partial_y f \\partial_x g$ 的直接离散化：\n$$\nJ_C(f,g)_{i,j} = (\\delta_x f)_{i,j}(\\delta_y g)_{i,j} - (\\delta_y f)_{i,j}(\\delta_x g)_{i,j}\n$$\n虽然看起来简单直接，但该方案不具备保证能量或拟涡能离散守恒所需的代数结构。求和 $\\sum \\phi J_C(\\phi,q)$ 和 $\\sum q J_C(\\phi,q)$ 通常不为零。\n\n**方案 A：Arakawa 雅可比式**\n这种结构保持方案由 A. Arakawa (1966) 开发，旨在保持连续雅可比式关键性质的离散模拟量。二阶精度的 Arakawa 雅可比式 $J_A$ 由三种不同的 $J(f,g)$ 离散化的平均值构成：\n$$\nJ_A(f,g) = \\frac{1}{3} (J_1(f,g) + J_2(f,g) + J_3(f,g))\n$$\n其中：\n1.  $J_1(f,g)_{i,j} = (\\delta_x f)_{i,j}(\\delta_y g)_{i,j} - (\\delta_y f)_{i,j}(\\delta_x g)_{i,j}$ (与方案 C 相同)\n2.  $J_2(f,g)_{i,j} = \\delta_x(f_{i,j} (\\delta_y g)_{i,j}) - \\delta_y(f_{i,j} (\\delta_x g)_{i,j})$ (平流形式)\n3.  $J_3(f,g)_{i,j} = \\delta_y(g_{i,j} (\\delta_x f)_{i,j}) - \\delta_x(g_{i,j} (\\delta_y f)_{i,j})$ (平流形式)\n\n$J_A$ 的守恒性质源于这些分量在求和下的性质。在周期性网格上使用求和分部：\n-   **拟涡能守恒 ($\\mathcal{P}_W=0$):** 我们测试 $\\sum_{i,j} g_{i,j} J_A(f,g)_{i,j} = 0$ 是否成立。\n    -   $\\sum g J_2 = \\sum g (\\delta_x(f \\delta_y g) - \\delta_y(f \\delta_x g)) = \\sum -(\\delta_x g)(f \\delta_y g) + (\\delta_y g)(f \\delta_x g) = \\sum f(\\delta_y g \\delta_x g - \\delta_x g \\delta_y g) = 0$。\n    -   $\\sum g J_3 = \\sum g (\\delta_y(g \\delta_x f) - \\delta_x(g \\delta_y f)) = \\sum - (g\\delta_x f)\\delta_y g + (g\\delta_y f)\\delta_x g = \\sum g(-\\delta_x f \\delta_y g + \\delta_y f \\delta_x g) = -\\sum g J_1$。\n    -   因此，$\\sum g(J_1+J_3) = 0$。\n    -   结合这些，$\\sum g J_A = \\frac{1}{3} (\\sum g(J_1+J_3) + \\sum g J_2) = \\frac{1}{3}(0+0) = 0$。\n-   **能量守恒 ($\\mathcal{P}_E=0$):** 我们测试 $\\sum_{i,j} f_{i,j} J_A(f,g)_{i,j} = 0$ 是否成立。\n    -   $\\sum f J_3 = \\sum f (\\delta_y(g \\delta_x f) - \\delta_x(g \\delta_y f)) = \\sum -(g\\delta_x f)\\delta_y f + (g\\delta_y f)\\delta_x f = \\sum g(-\\delta_x f \\delta_y f + \\delta_y f \\delta_x f) = 0$。\n    -   $\\sum f J_2 = \\sum f (\\delta_x(f \\delta_y g) - \\delta_y(f \\delta_x g)) = \\sum -(f\\delta_y g)\\delta_x f + (f\\delta_x g)\\delta_y f = \\sum f(-\\delta_y g \\delta_x f + \\delta_x g \\delta_y f) = -\\sum f J_1$。\n    -   因此，$\\sum f(J_1+J_2) = 0$。\n    -   结合这些，$\\sum f J_A = \\frac{1}{3} (\\sum f(J_1+J_2) + \\sum f J_3) = \\frac{1}{3}(0+0) = 0$。\n\n通过代入 $f=\\phi$ 和 $g=q$，我们证明了 Arakawa 雅可比式在离散层面上保证了 $\\mathcal{P}_E=0$ 和 $\\mathcal{P}_W=0$（在浮点运算误差范围内）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for discrete conservation laws\n    in the Hasegawa-Mima equation.\n    \"\"\"\n    EPSILON = 1e-12\n\n    def central_diff_x(f, dx):\n        \"\"\"Computes the central difference in the x-direction (axis 0) with periodic BC.\"\"\"\n        return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * dx)\n\n    def central_diff_y(f, dy):\n        \"\"\"Computes the central difference in the y-direction (axis 1) with periodic BC.\"\"\"\n        return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * dy)\n\n    def discrete_laplacian(f, dx, dy):\n        \"\"\"Computes the 5-point stencil discrete Laplacian with periodic BC.\"\"\"\n        term_x = (np.roll(f, -1, axis=0) - 2 * f + np.roll(f, 1, axis=0)) / (dx**2)\n        term_y = (np.roll(f, -1, axis=1) - 2 * f + np.roll(f, 1, axis=1)) / (dy**2)\n        return term_x + term_y\n\n    def jacobian_C(f, g, dx, dy):\n        \"\"\"Naive centered finite-difference Jacobian (Scheme C).\"\"\"\n        dfdx = central_diff_x(f, dx)\n        dfdy = central_diff_y(f, dy)\n        dgdx = central_diff_x(g, dx)\n        dgdy = central_diff_y(g, dy)\n        return dfdx * dgdy - dfdy * dgdx\n\n    def jacobian_A(f, g, dx, dy):\n        \"\"\"Arakawa Jacobian (Scheme A) for discrete conservation.\"\"\"\n        # J_A = (J1 + J2 + J3) / 3\n\n        dfdx = central_diff_x(f, dx)\n        dfdy = central_diff_y(f, dy)\n        dgdx = central_diff_x(g, dx)\n        dgdy = central_diff_y(g, dy)\n\n        # J1 term (same as Scheme C)\n        J1 = dfdx * dgdy - dfdy * dgdx\n\n        # J2 term\n        J2 = central_diff_x(f * dgdy, dx) - central_diff_y(f * dgdx, dy)\n\n        # J3 term\n        J3 = central_diff_y(g * dfdx, dy) - central_diff_x(g * dfdy, dx)\n\n        return (J1 + J2 + J3) / 3.0\n    \n    def run_test(Nx, Ny, Lx, Ly, scheme, conservation_type, field_params):\n        \"\"\"\n        Runs a single test case for conservation properties.\n        \"\"\"\n        dx = Lx / Nx\n        dy = Ly / Ny\n\n        # 1. Construct the phi field\n        if field_params['type'] == 'random':\n            rng = np.random.default_rng(field_params['seed'])\n            # The problem specifies a grid with Nx points in x and Ny points in y.\n            # Numpy arrays are (row, col), so we use (Nx, Ny) to map rows to x and cols to y.\n            phi = rng.standard_normal((Nx, Ny))\n        elif field_params['type'] == 'sine':\n            kx = field_params['kx']\n            ky = field_params['ky']\n            x = np.linspace(0, Lx, Nx, endpoint=False)\n            y = np.linspace(0, Ly, Ny, endpoint=False)\n            xx, yy = np.meshgrid(x, y, indexing='ij')\n            phi = np.sin(kx * xx) * np.cos(ky * yy)\n        else:\n            raise ValueError(f\"Unknown field type: {field_params['type']}\")\n\n        # 2. Compute the q field\n        lap_phi = discrete_laplacian(phi, dx, dy)\n        q = lap_phi - phi\n\n        # 3. Compute the Jacobian J(phi, q)\n        if scheme == 'A':\n            J_phi_q = jacobian_A(phi, q, dx, dy)\n        elif scheme == 'C':\n            J_phi_q = jacobian_C(phi, q, dx, dy)\n        else:\n            raise ValueError(f\"Unknown scheme type: {scheme}\")\n\n        # 4. Evaluate the discrete production rate\n        if conservation_type == 'enstrophy':\n            # P_W = sum(q * J(phi,q)) * dx * dy\n            production_rate = np.sum(q * J_phi_q) * dx * dy\n        elif conservation_type == 'energy':\n            # P_E = sum(phi * J(phi,q)) * dx * dy\n            production_rate = np.sum(phi * J_phi_q) * dx * dy\n        else:\n            raise ValueError(f\"Unknown conservation type: {conservation_type}\")\n        \n        # 5. Return boolean based on tolerance\n        return abs(production_rate)  EPSILON\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test 1\n        {'Nx': 64, 'Ny': 64, 'Lx': 2*np.pi, 'Ly': 2*np.pi, 'scheme': 'A', 'conservation_type': 'enstrophy', 'field_params': {'type': 'random', 'seed': 1234}},\n        # Test 2\n        {'Nx': 64, 'Ny': 64, 'Lx': 2*np.pi, 'Ly': 2*np.pi, 'scheme': 'A', 'conservation_type': 'energy', 'field_params': {'type': 'random', 'seed': 1234}},\n        # Test 3\n        {'Nx': 64, 'Ny': 64, 'Lx': 2*np.pi, 'Ly': 2*np.pi, 'scheme': 'C', 'conservation_type': 'enstrophy', 'field_params': {'type': 'random', 'seed': 1234}},\n        # Test 4\n        {'Nx': 48, 'Ny': 32, 'Lx': 1.0, 'Ly': 2.5, 'scheme': 'A', 'conservation_type': 'energy', 'field_params': {'type': 'sine', 'kx': 3, 'ky': 5}},\n        # Test 5\n        {'Nx': 4, 'Ny': 4, 'Lx': 1.0, 'Ly': 1.0, 'scheme': 'A', 'conservation_type': 'enstrophy', 'field_params': {'type': 'sine', 'kx': 1, 'ky': 1}},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_test(\n            Nx=case['Nx'], Ny=case['Ny'], Lx=case['Lx'], Ly=case['Ly'],\n            scheme=case['scheme'], conservation_type=case['conservation_type'],\n            field_params=case['field_params']\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Convert Python boolean to lowercase string 'true'/'false' for JSON-like output\n    formatted_results = [str(r).lower() for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}