{
    "hands_on_practices": [
        {
            "introduction": "To understand turbulence, we must first identify its source of free energy. In the context of drift-reduced models for tokamaks, instabilities are primarily driven by pressure gradients and unfavorable magnetic field curvature. This exercise provides a foundational, hands-on calculation to quantify and compare the strength of these two driving mechanisms by computing the diamagnetic frequency, $\\omega_*$, and the curvature drift frequency, $\\omega_\\kappa$. Mastering this analysis  is a critical first step in diagnosing the dominant physics governing turbulence in a given plasma scenario.",
            "id": "4187867",
            "problem": "Consider a low-frequency, electrostatic, drift-reduced fluid description of turbulence in a large-aspect-ratio tokamak. Assume singly ionized deuterium ions. A background magnetic field of magnitude $B$ is uniform in the local slab and has curvature characterized by the large-aspect-ratio estimate that the curvature operator amplitude along the binormal direction is $2/R$, where $R$ is the tokamak major radius. Fluctuations vary as $\\exp(i k_y y)$ along the binormal direction with perpendicular wavenumber $k_y$, and the background density has a radial gradient with scale length $L_n$. Use the following fundamental definitions:\n- The ion sound speed is $c_s = \\sqrt{T_e/m_i}$, where $T_e$ is the electron temperature and $m_i$ is the ion mass.\n- The ion cyclotron frequency is $\\Omega_i = e B/m_i$, where $e$ is the elementary charge.\n- The ion sound Larmor radius is $\\rho_s = c_s/\\Omega_i$.\n- The electron diamagnetic drift velocity is $\\mathbf{v}_{*e} = \\frac{T_e}{e B}\\,\\hat{\\mathbf{z}}\\times\\nabla \\ln n$, so its magnitude for a background density gradient $\\partial_x \\ln n = 1/L_n$ is $v_{*e} = \\frac{T_e}{e B L_n}$.\nDefine the diamagnetic drift frequency as $\\omega_* = k_y v_{*e}$.\n\nStarting from these definitions and using dimensional analysis in the drift-reduced fluid model to form the curvature-induced advection speed from $c_s$, $\\rho_s$, and the curvature amplitude $2/R$, derive an expression for the curvature drift frequency $\\omega_\\kappa$ in terms of $k_y$, $c_s$, $\\rho_s$, and $R$. Then, using the given parameters\n$R = 1.7\\ \\mathrm{m}$, $B = 2.5\\ \\mathrm{T}$, $T_e = 80\\ \\mathrm{eV}$, $m_i = 3.343\\times 10^{-27}\\ \\mathrm{kg}$, $e = 1.602\\times 10^{-19}\\ \\mathrm{C}$, $L_n = 0.15\\ \\mathrm{m}$, and $k_y = 150\\ \\mathrm{m}^{-1}$,\ncompute numerical values of $\\omega_\\kappa$ and $\\omega_*$, and finally compute the dimensionless ratio $\\chi = \\omega_\\kappa/\\omega_*$. Round your final reported value of $\\chi$ to four significant figures and report it as a pure number with no units.",
            "solution": "The solution proceeds in four stages: 1) derivation of the curvature drift frequency $\\omega_\\kappa$, 2) identification of the diamagnetic drift frequency $\\omega_*$, 3) derivation of their ratio $\\chi$, and 4) numerical computation of all quantities.\n\n**1. Derivation of the Curvature Drift Frequency $\\omega_\\kappa$**\n\nThe problem requires constructing a 'curvature-induced advection speed', let's call it $v_\\kappa$, from the ion sound speed $c_s$, the ion sound Larmor radius $\\rho_s$, and the curvature amplitude $2/R$. We use dimensional analysis. Let the dimensions of length and time be $[L]$ and $[T]$, respectively.\nThe dimensions of the given quantities are:\n-   $v_\\kappa$: $[L][T]^{-1}$\n-   $c_s$: $[L][T]^{-1}$\n-   $\\rho_s$: $[L]$\n-   $1/R$: $[L]^{-1}$\n\nWe look for a combination of the form $v_\\kappa \\propto c_s^a \\rho_s^b (1/R)^c$. Expressing this in terms of dimensions:\n$$[L]^1 [T]^{-1} = ([L][T]^{-1})^a ([L])^b ([L]^{-1})^c = [L]^{a+b-c} [T]^{-a}$$\nEquating the exponents for each dimension:\n-   For time $[T]$: $-1 = -a \\implies a=1$.\n-   For length $[L]$: $1 = a+b-c = 1+b-c \\implies b=c$.\n\nThe simplest non-trivial physical solution is to take $b=c=1$. This yields a velocity proportional to $c_s \\rho_s / R$. The problem specifies using the curvature amplitude $2/R$, so we incorporate the dimensionless factor of $2$:\n$$v_\\kappa = \\frac{2 c_s \\rho_s}{R}$$\nThis result is physically correct. In drift-reduced models, the effective gravity due to bad magnetic curvature is $g_{eff} = 2 c_s^2 / R$. The resulting drift velocity, analogous to a gravitational drift, has a magnitude $v_\\kappa = m_i g_{eff} / (eB) = 2 m_i c_s^2 / (eBR)$. Using the definitions $c_s = \\sqrt{T_e/m_i}$ and $\\rho_s = c_s/\\Omega_i = c_s m_i / (eB)$, we can confirm our expression:\n$$v_\\kappa = \\frac{2 m_i (T_e/m_i)}{eBR} = \\frac{2 T_e}{eBR} = \\frac{2}{R} \\frac{T_e}{eB} = \\frac{2}{R} \\frac{m_i c_s^2}{eB} = \\frac{2}{R} \\frac{m_i c_s}{eB} c_s = \\frac{2 c_s \\rho_s}{R}$$\nThe curvature drift frequency, $\\omega_\\kappa$, is obtained by the dot product of the wavevector $\\mathbf{k}$ and the drift velocity $\\mathbf{v}_\\kappa$. For fluctuations of the form $\\exp(i k_y y)$, the wavevector is $\\mathbf{k} = k_y \\hat{\\mathbf{y}}$, and the drift is in the binormal direction, so $\\omega_\\kappa = k_y v_\\kappa$.\n$$ \\omega_\\kappa = \\frac{2 k_y c_s \\rho_s}{R} $$\n\n**2. Diamagnetic Drift Frequency $\\omega_*$**\n\nThe problem provides the definition of the diamagnetic drift frequency as $\\omega_* = k_y v_{*e}$. The magnitude of the electron diamagnetic drift velocity is given as $v_{*e} = \\frac{T_e}{eBL_n}$ for a density gradient scale length $L_n$. Therefore, the diamagnetic drift frequency is:\n$$ \\omega_* = \\frac{k_y T_e}{e B L_n} $$\n\n**3. Derivation of the Ratio $\\chi = \\omega_\\kappa/\\omega_*$**\n\nWe now form the ratio $\\chi = \\omega_\\kappa / \\omega_*$. To simplify the expression, we first express $\\omega_\\kappa$ in terms of fundamental parameters, as we did for $v_\\kappa$:\n$$ \\omega_\\kappa = k_y v_\\kappa = k_y \\left(\\frac{2 T_e}{eBR}\\right) = \\frac{2 k_y T_e}{eBR} $$\nNow, we can compute the ratio $\\chi$:\n$$ \\chi = \\frac{\\omega_\\kappa}{\\omega_*} = \\frac{\\frac{2 k_y T_e}{eBR}}{\\frac{k_y T_e}{eBL_n}} $$\nThe terms $k_y$, $T_e$, $e$, and $B$ cancel, leading to a simple geometric ratio:\n$$ \\chi = \\frac{2/R}{1/L_n} = \\frac{2 L_n}{R} $$\n\n**4. Numerical Computation**\n\nWe are given the following parameter values:\n-   $R = 1.7\\ \\mathrm{m}$\n-   $B = 2.5\\ \\mathrm{T}$\n-   $T_e = 80\\ \\mathrm{eV}$\n-   $m_i = 3.343\\times 10^{-27}\\ \\mathrm{kg}$\n-   $e = 1.602\\times 10^{-19}\\ \\mathrm{C}$\n-   $L_n = 0.15\\ \\mathrm{m}$\n-   $k_y = 150\\ \\mathrm{m}^{-1}$\n\nFirst, we convert the electron temperature $T_e$ to Joules:\n$$ T_e = 80\\ \\mathrm{eV} \\times 1.602\\times 10^{-19}\\ \\mathrm{J/eV} = 1.2816\\times 10^{-17}\\ \\mathrm{J} $$\n\nNext, we compute the numerical values for $\\omega_\\kappa$ and $\\omega_*$.\nFor the curvature drift frequency $\\omega_\\kappa$:\n$$ \\omega_\\kappa = \\frac{2 k_y T_e}{eBR} = \\frac{2 \\times 150 \\times (1.2816\\times 10^{-17})}{(1.602\\times 10^{-19}) \\times 2.5 \\times 1.7} = \\frac{2 \\times 150 \\times 80}{2.5 \\times 1.7} = \\frac{24000}{4.25} \\approx 5647.059\\ \\mathrm{s}^{-1} $$\nFor the diamagnetic drift frequency $\\omega_*$:\n$$ \\omega_* = \\frac{k_y T_e}{eBL_n} = \\frac{150 \\times (1.2816\\times 10^{-17})}{(1.602\\times 10^{-19}) \\times 2.5 \\times 0.15} = \\frac{150 \\times 80}{2.5 \\times 0.15} = \\frac{12000}{0.375} = 32000\\ \\mathrm{s}^{-1} $$\n\nFinally, we compute the dimensionless ratio $\\chi$. We can use either the numerical values of the frequencies or the simplified analytical expression. Using the analytical expression is more direct and less prone to intermediate rounding errors.\n$$ \\chi = \\frac{2 L_n}{R} = \\frac{2 \\times 0.15}{1.7} = \\frac{0.3}{1.7} \\approx 0.176470588... $$\nThe problem asks for the result to be rounded to four significant figures.\n$$ \\chi \\approx 0.1765 $$\nAs a check, using the calculated frequencies: $\\chi = \\omega_\\kappa/\\omega_* \\approx 5647.059 / 32000 \\approx 0.17647059...$, which confirms the result.",
            "answer": "$$\\boxed{0.1765}$$"
        },
        {
            "introduction": "Once turbulence is driven by linear instabilities, it does not grow indefinitely. Instead, it generates secondary structures, such as zonal flows, which can regulate the turbulence itself. This exercise focuses on this crucial nonlinear saturation mechanism by quantifying the ability of zonal flows to suppress turbulence through velocity shear. By calculating the zonal flow shearing rate, $\\gamma_E$, from a synthetic potential spectrum and comparing it to a linear instability growth rate, $\\gamma_{\\mathrm{lin}}$, you will test the fundamental suppression criterion $\\gamma_E \\gtrsim \\gamma_{\\mathrm{lin}}$ , making a key concept in nonlinear plasma dynamics concrete and computable.",
            "id": "4187894",
            "problem": "Consider an electrostatic, drift-reduced fluid description of turbulence in a slab with a uniform magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$ and coordinates $(x,y)$ denoting radial and poloidal directions, respectively. Zonal flows (ZF) are represented by the zonal ($k_y=0$) component of the electrostatic potential $\\phi(x)$, and the electric field cross magnetic field (E$\\times$B) drift provides the poloidal velocity $v_y(x)$. Let the zonal potential be synthesized from a prescribed turbulent spectrum as a finite odd-harmonic Fourier series\n$$\n\\phi(x) \\;=\\; \\sum_{n=1,3,5,\\dots,19} A_n \\cos\\!\\left(n k_0 x\\right),\n$$\n$$\nA_n \\;=\\; A_0\\, n^{-p}\\, \\exp\\!\\left(-\\frac{n}{n_c}\\right),\n$$\nand the fundamental radial wavenumber is $k_0 = \\frac{2\\pi}{L_x}$. The parameters are:\n- $B = 2.0$ in Tesla,\n- $L_x = 0.4$ in meters,\n- $A_0 = 3.0$ in Volts,\n- $p = 3$,\n- $n_c = 5$.\n\nStarting from first principles appropriate to drift-reduced fluid models, express the poloidal E$\\times$B velocity $v_y(x)$ and derive the zonal flow shearing rate\n$$\n\\gamma_E \\;=\\; \\max_{x} \\left| \\partial_x v_y(x) \\right|.\n$$\nUsing the given spectrum, compute the numerical value of $\\gamma_E$ in $\\mathrm{s}^{-1}$.\n\nA separate linear drift-reduced calculation (eigenvalue analysis of the linearized model) for the dominant drift-wave mode yields a linear growth rate $\\gamma_{\\mathrm{lin}} = 3.80 \\times 10^{2}$ in $\\mathrm{s}^{-1}$. Compute the dimensionless ratio\n$$\nR \\;=\\; \\frac{\\gamma_E}{\\gamma_{\\mathrm{lin}}},\n$$\nand use it to assess whether the shear suppression criterion $\\gamma_E \\gtrsim \\gamma_{\\mathrm{lin}}$ is satisfied.\n\nRound your final answer for $R$ to four significant figures. Since $R$ is dimensionless, do not include any units with the final value.",
            "solution": "The problem requires the calculation of the zonal flow shearing rate, $\\gamma_E$, from a given electrostatic potential spectrum, and then a comparison with a given linear drift-wave growth rate, $\\gamma_{\\mathrm{lin}}$. The process begins with the fundamental principles of plasma fluid motion in a magnetic field.\n\nFirst, we determine the poloidal velocity $v_y(x)$ from the E$\\times$B drift velocity formula. The E$\\times$B drift velocity, $\\mathbf{v}_E$, is given by:\n$$\n\\mathbf{v}_E = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}\n$$\nThe electric field, $\\mathbf{E}$, is the negative gradient of the electrostatic potential, $\\phi$:\n$$\n\\mathbf{E} = -\\nabla\\phi\n$$\nGiven that the potential $\\phi$ is a function only of the radial coordinate $x$, $\\phi = \\phi(x)$, the electric field simplifies to:\n$$\n\\mathbf{E} = -\\frac{d\\phi(x)}{dx} \\hat{\\mathbf{x}}\n$$\nThe magnetic field is uniform and in the $\\hat{\\mathbf{z}}$ direction, $\\mathbf{B} = B \\hat{\\mathbf{z}}$. The cross product $\\mathbf{E} \\times \\mathbf{B}$ is:\n$$\n\\mathbf{E} \\times \\mathbf{B} = \\left(-\\frac{d\\phi}{dx} \\hat{\\mathbf{x}}\\right) \\times (B \\hat{\\mathbf{z}}) = -\\frac{d\\phi}{dx} B (\\hat{\\mathbf{x}} \\times \\hat{\\mathbf{z}})\n$$\nUsing the vector identity for Cartesian unit vectors, $\\hat{\\mathbf{x}} \\times \\hat{\\mathbf{z}} = -\\hat{\\mathbf{y}}$, we obtain:\n$$\n\\mathbf{E} \\times \\mathbf{B} = -\\frac{d\\phi}{dx} B (-\\hat{\\mathbf{y}}) = B \\frac{d\\phi}{dx} \\hat{\\mathbf{y}}\n$$\nSubstituting this back into the expression for $\\mathbf{v}_E$:\n$$\n\\mathbf{v}_E = \\frac{B \\frac{d\\phi}{dx} \\hat{\\mathbf{y}}}{B^2} = \\frac{1}{B} \\frac{d\\phi}{dx} \\hat{\\mathbf{y}}\n$$\nThe poloidal velocity $v_y(x)$ is the component of $\\mathbf{v}_E$ in the $\\hat{\\mathbf{y}}$ direction:\n$$\nv_y(x) = \\frac{1}{B} \\frac{d\\phi}{dx}\n$$\nNext, we find the zonal flow shearing rate, $\\gamma_E$, which is defined as the maximum absolute value of the radial derivative of the poloidal velocity:\n$$\n\\gamma_E = \\max_{x} \\left| \\partial_x v_y(x) \\right|\n$$\nSubstituting the expression for $v_y(x)$, we get:\n$$\n\\partial_x v_y(x) = \\partial_x \\left(\\frac{1}{B} \\frac{d\\phi}{dx}\\right) = \\frac{1}{B} \\frac{d^2\\phi}{dx^2}\n$$\nTherefore, the shearing rate is:\n$$\n\\gamma_E = \\frac{1}{B} \\max_{x} \\left| \\frac{d^2\\phi}{dx^2} \\right|\n$$\nNow we use the given form of the potential $\\phi(x)$:\n$$\n\\phi(x) = \\sum_{n=1,3,5,\\dots,19} A_n \\cos(n k_0 x)\n$$\nWe compute the second derivative with respect to $x$:\n$$\n\\frac{d\\phi}{dx} = \\sum_{n=1,3,5,\\dots,19} A_n \\left( -n k_0 \\sin(n k_0 x) \\right) = -k_0 \\sum_{n=1,3,5,\\dots,19} n A_n \\sin(n k_0 x)\n$$\n$$\n\\frac{d^2\\phi}{dx^2} = -k_0 \\sum_{n=1,3,5,\\dots,19} n A_n \\left( n k_0 \\cos(n k_0 x) \\right) = -k_0^2 \\sum_{n=1,3,5,\\dots,19} n^2 A_n \\cos(n k_0 x)\n$$\nSubstituting this into the expression for $\\gamma_E$:\n$$\n\\gamma_E = \\frac{1}{B} \\max_{x} \\left| -k_0^2 \\sum_{n=1,3,5,\\dots,19} n^2 A_n \\cos(n k_0 x) \\right| = \\frac{k_0^2}{B} \\max_{x} \\left| \\sum_{n=1,3,5,\\dots,19} n^2 A_n \\cos(n k_0 x) \\right|\n$$\nThe amplitude spectrum is $A_n = A_0 n^{-p} \\exp(-n/n_c)$. With $A_0 > 0$, all $A_n$ are positive. Thus, the coefficients $n^2 A_n$ of the cosine terms are all positive. The maximum value of a sum of cosine functions with positive coefficients is achieved when all cosine terms are equal to $1$. This occurs, for example, at $x=0$, where $\\cos(n k_0 \\cdot 0) = \\cos(0) = 1$ for all $n$. The maximum absolute value is therefore the sum of the coefficients:\n$$\n\\gamma_E = \\frac{k_0^2}{B} \\sum_{n=1,3,5,\\dots,19} n^2 A_n\n$$\nSubstituting the expression for $A_n$:\n$$\n\\gamma_E = \\frac{k_0^2}{B} \\sum_{n=1,3,5,\\dots,19} n^2 \\left( A_0 n^{-p} \\exp\\left(-\\frac{n}{n_c}\\right) \\right) = \\frac{k_0^2 A_0}{B} \\sum_{n=1,3,5,\\dots,19} n^{2-p} \\exp\\left(-\\frac{n}{n_c}\\right)\n$$\nNow, we substitute the given numerical parameters: $B=2.0$, $L_x=0.4$, $A_0=3.0$, $p=3$, and $n_c=5$.\nThe fundamental wavenumber $k_0$ is:\n$$\nk_0 = \\frac{2\\pi}{L_x} = \\frac{2\\pi}{0.4} = 5\\pi \\, \\mathrm{m}^{-1}\n$$\nWith $p=3$, the exponent of $n$ in the sum becomes $2-3 = -1$.\n$$\n\\gamma_E = \\frac{(5\\pi)^2 (3.0)}{2.0} \\sum_{n=1,3,5,\\dots,19} \\frac{1}{n} \\exp\\left(-\\frac{n}{5}\\right) = \\frac{75\\pi^2}{2} \\sum_{n=1,3,5,\\dots,19} \\frac{1}{n} \\exp\\left(-\\frac{n}{5}\\right)\n$$\nWe compute the sum for the odd integers $n$ from $1$ to $19$:\n$$\nS = \\sum_{n \\in \\{1,3,..,19\\}} \\frac{1}{n} \\exp\\left(-\\frac{n}{5}\\right) = \\frac{1}{1}\\exp(-0.2) + \\frac{1}{3}\\exp(-0.6) + \\frac{1}{5}\\exp(-1.0) + \\dots + \\frac{1}{19}\\exp(-3.8)\n$$\nThe terms are:\n$n=1$: $\\exp(-0.2) \\approx 0.81873075$\n$n=3$: $\\frac{1}{3}\\exp(-0.6) \\approx 0.18293731$\n$n=5$: $\\frac{1}{5}\\exp(-1.0) \\approx 0.07357589$\n$n=7$: $\\frac{1}{7}\\exp(-1.4) \\approx 0.03522790$\n$n=9$: $\\frac{1}{9}\\exp(-1.8) \\approx 0.01836640$\n$n=11$: $\\frac{1}{11}\\exp(-2.2) \\approx 0.01007301$\n$n=13$: $\\frac{1}{13}\\exp(-2.6) \\approx 0.00571337$\n$n=15$: $\\frac{1}{15}\\exp(-3.0) \\approx 0.00331919$\n$n=17$: $\\frac{1}{17}\\exp(-3.4) \\approx 0.00196316$\n$n=19$: $\\frac{1}{19}\\exp(-3.8) \\approx 0.00117739$\nSumming these values gives:\n$$\nS \\approx 1.15108437\n$$\nNow we can compute $\\gamma_E$. The units are $(\\mathrm{m}^{-2})(\\mathrm{V})/(\\mathrm{T}) = (\\mathrm{m}^{-2})(\\mathrm{V})/(\\mathrm{V}\\cdot\\mathrm{s}\\cdot\\mathrm{m}^{-2}) = \\mathrm{s}^{-1}$.\n$$\n\\gamma_E \\approx \\frac{75\\pi^2}{2} \\times 1.15108437 \\approx 37.5 \\times (9.8696044) \\times 1.15108437 \\approx 426.0400 \\, \\mathrm{s}^{-1}\n$$\nThe problem provides the linear growth rate $\\gamma_{\\mathrm{lin}} = 3.80 \\times 10^2 \\, \\mathrm{s}^{-1} = 380 \\, \\mathrm{s}^{-1}$.\nThe dimensionless ratio $R$ is:\n$$\nR = \\frac{\\gamma_E}{\\gamma_{\\mathrm{lin}}} \\approx \\frac{426.0400}{380} \\approx 1.121157...\n$$\nRounding to four significant figures, we get $R \\approx 1.121$.\nThe shear suppression criterion is $\\gamma_E \\gtrsim \\gamma_{\\mathrm{lin}}$, which is equivalent to $R \\gtrsim 1$. Since our calculated value is $R \\approx 1.121$, which is greater than $1$, the criterion for turbulent transport suppression by zonal flow shear is satisfied.",
            "answer": "$$\\boxed{1.121}$$"
        },
        {
            "introduction": "The ultimate goal of many turbulence studies is to predict the resulting macroscopic transport of particles and heat. This capstone practice integrates the concepts of instability drives and saturation mechanisms into predictive models for transport coefficients. You will implement and compare two widely used frameworks: a quasi-linear (QL) theory and a heuristic mixing-length (ML) model, incorporating effects like shear suppression and collisional dissipation. This exercise  bridges the gap between fundamental theory and practical application, providing direct experience in developing the computational tools used to estimate turbulent transport in fusion devices.",
            "id": "4187929",
            "problem": "You are given a synthetic spectrum of electrostatic modes intended to represent fluctuations in a drift-reduced fluid model of magnetized plasma turbulence in slab geometry. Using fundamental plasma fluid principles, you must derive and implement a program to compute net transport coefficients from the spectrum and compare them to a mixing-length prediction, and then aggregate the results over multiple test cases into the required final output format.\n\nThe physical setting and normalization are as follows: assume a two-dimensional plane $(x,y)$ perpendicular to a uniform magnetic field, with electrostatic potential fluctuations $\\phi(x,y,t)$ generating cross-field motion via the $\\mathbf{E}\\times\\mathbf{B}$ drift. All quantities are normalized in a standard drift-reduced form, with lengths normalized to the ion sound gyroradius and velocities normalized so that the radial component of the $\\mathbf{E}\\times\\mathbf{B}$ drift for a Fourier mode is $v_{r,k} = k_y \\phi_k$, where $k_y$ is the poloidal wavenumber and $\\phi_k$ is the complex amplitude (take the provided amplitudes as real and positive). The net transport coefficients to compute are the particle diffusivity $D_n$ and the heat diffusivity $\\chi$, both dimensionless in this normalization, and both to be expressed as decimal floats.\n\nPrinciple-based derivation requirements:\n- Start from the $\\mathbf{E}\\times\\mathbf{B}$ drift expression and the linearized evolution of passive scalar fluctuations (density and temperature) in a drift-reduced fluid description. That is, use the linearized advection of background gradients by the $\\mathbf{E}\\times\\mathbf{B}$ velocity and include collisional dissipation modeled as a Laplacian term. Use these to obtain the fluctuation response amplitudes in terms of the mode properties.\n- Model the turbulence decorrelation time for each mode by a random-walk approach, adopting an additive decorrelation rate composed of the linear instability growth rate and the externally imposed zonal flow shearing rate. Implement zonal flow suppression by treating shear as a decorrelation mechanism that acts in parallel with the linear growth rate.\n- Define the net particle diffusivity $D_n$ and heat diffusivity $\\chi$ from quasi-linear theory by summing the contributions from all modes in the spectrum using the derived fluctuation responses and decorrelation times.\n- Independently derive the mixing-length predictions for $D_n$ and $\\chi$ by combining the eddy size $(\\propto 1/k_\\perp)$ with an effective instability rate. In the presence of zonal flows, construct the effective instability rate as a shear-reduced rate. Aggregate multi-mode mixing-length predictions by an amplitude-weighted average across the spectrum.\n\nScientific and numerical details to use in your derivation and implementation:\n- Let the radial velocity for a mode be $v_{r,k} = k_y \\phi_k$.\n- Let the perpendicular wavenumber magnitude be $k_\\perp = \\sqrt{k_x^2 + k_y^2}$.\n- Each mode is characterized by $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k)$, where $\\gamma_k$ is the linear growth rate and $S_k$ is the zonal flow shearing rate, both taken as constant positive numbers per mode.\n- Include collisional dissipation for density and temperature via base coefficients $D_0$ and $\\chi_0$, respectively, entering through Laplacian terms in the fluctuation evolution.\n- Use a small positive numerical regularization parameter $\\epsilon$ to avoid division by zero; you may take $\\epsilon = 10^{-12}$.\n- All computed transport coefficients are dimensionless in the chosen normalization. Express all outputs as decimal floats rounded to six ($6$) decimal places.\n\nTest suite:\nCompute the four ($4$) numbers $[D_n^{\\mathrm{QL}}, \\chi^{\\mathrm{QL}}, D_n^{\\mathrm{ML}}, \\chi^{\\mathrm{ML}}]$ for each of the following test cases, where the superscripts ${\\mathrm{QL}}$ and ${\\mathrm{ML}}$ denote quasi-linear and mixing-length, respectively.\n\n- Case A (moderate growth, moderate shear): $D_0 = 0.01$, $\\chi_0 = 0.015$, with modes\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.3, 0.2, 0.08, 0.04, 0.03)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.1, 0.4, 0.12, 0.05, 0.02)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.2, 0.6, 0.09, 0.03, 0.05)$.\n- Case B (strong shear suppression): $D_0 = 0.005$, $\\chi_0 = 0.005$, with modes\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.2, 0.5, 0.05, 0.04, 0.07)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.5, 0.3, 0.04, 0.02, 0.08)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.8, 0.2, 0.03, 0.01, 0.10)$.\n- Case C (high $k_\\perp$ spectrum): $D_0 = 0.02$, $\\chi_0 = 0.02$, with modes\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (1.2, 1.0, 0.15, 0.03, 0.02)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.9, 1.1, 0.10, 0.02, 0.01)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (1.5, 0.7, 0.12, 0.025, 0.03)$.\n- Case D (no shear, low growth): $D_0 = 0.0$, $\\chi_0 = 0.0$, with modes\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.05, 0.1, 0.01, 0.05, 0.0)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.1, 0.05, 0.005, 0.04, 0.0)$,\n  - $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k) = (0.2, 0.15, 0.02, 0.03, 0.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, where each inner list corresponds to one test case and contains the four ($4$) floats $[D_n^{\\mathrm{QL}}, \\chi^{\\mathrm{QL}}, D_n^{\\mathrm{ML}}, \\chi^{\\mathrm{ML}}]$, each rounded to six ($6$) decimal places. For example: $[[d_1,\\chi_1,dm_1,\\chi m_1],[d_2,\\chi_2,dm_2,\\chi m_2],\\dots]$.",
            "solution": "The problem requires the derivation and implementation of two distinct models for calculating turbulent transport coefficients in a magnetized plasma: a quasi-linear (QL) model and a mixing-length (ML) model. The physical context is a drift-reduced fluid description in a two-dimensional slab geometry. We will first derive the expressions for the particle diffusivity $D_n$ and heat diffusivity $\\chi$ for each model based on the provided principles, and then outline the computational algorithm.\n\n### Quasi-Linear (QL) Transport Model\n\nThe quasi-linear theory calculates the transport flux by correlating the velocity fluctuations with the pressure or density fluctuations they induce. We consider a passive scalar field $f$ (representing either particle density $n$ or temperature $T$) with a background value $f_0$ and a fluctuation $\\tilde{f}$. Its evolution in a turbulent electrostatic field is governed by the linearized advection-diffusion equation.\n\nThe evolution of the fluctuation $\\tilde{f}$ is driven by the advection of the background gradient by the fluctuating $\\mathbf{E}\\times\\mathbf{B}$ velocity, $\\tilde{\\mathbf{v}}_E$, and is damped by collisional dissipation. The radial component of $\\tilde{\\mathbf{v}}_E$ is denoted $\\tilde{v}_r$. The equation for the fluctuation of a scalar $f$ is:\n$$\n\\frac{\\partial \\tilde{f}}{\\partial t} + \\tilde{v}_r \\frac{\\partial f_0}{\\partial x} = \\mathcal{C}(\\tilde{f})\n$$\nwhere $\\mathcal{C}$ is a general collision/dissipation operator. In the drift-reduced normalization used here, the background gradients $\\partial n_0 / \\partial x$ and $\\partial T_0 / \\partial x$ are taken to be of order $-1$. Thus, we set $\\partial f_0 / \\partial x = -1$. The equation becomes:\n$$\n\\frac{\\partial \\tilde{f}}{\\partial t} - \\tilde{v}_r = \\mathcal{C}(\\tilde{f})\n$$\nWe analyze this equation in Fourier space for a single mode with wavenumber vector $\\mathbf{k} = (k_x, k_y)$. The problem specifies that the collisional dissipation is modeled by a Laplacian term, so for density fluctuations $\\tilde{n}$, $\\mathcal{C}(\\tilde{n}) = D_0 \\nabla^2 \\tilde{n}$, which in Fourier space becomes $-D_0 k_\\perp^2 \\tilde{n}_k$, where $k_\\perp^2 = k_x^2 + k_y^2$.\n\nFurthermore, the problem states that turbulence decorrelation for each mode should be modeled by an additive rate comprising the linear growth rate $\\gamma_k$ and the zonal flow shearing rate $S_k$. This represents the effective damping rate of the fluctuation amplitude $\\tilde{n}_k$ due to the turbulent dynamics. Combining all damping effects on the fluctuation, the time evolution operator $\\partial/\\partial t$ for a mode $k$ in a statistically steady state can be replaced by the total decorrelation rate: $\\Delta\\omega_k = \\gamma_k + S_k + D_0 k_\\perp^2$ for density, and a corresponding rate for temperature.\n\nThe steady-state balance for the density fluctuation amplitude $\\tilde{n}_k$ is then:\n$$\n(\\gamma_k + S_k + D_0 k_\\perp^2) \\tilde{n}_k = \\tilde{v}_{r,k}\n$$\nSolving for $\\tilde{n}_k$, we find the fluctuation response to the advecting velocity:\n$$\n\\tilde{n}_k = \\frac{\\tilde{v}_{r,k}}{\\gamma_k + S_k + D_0 k_\\perp^2}\n$$\nA small regularization parameter $\\epsilon$ is added to the denominator to prevent division by zero in cases where all rate terms are zero.\n$$\n\\tilde{n}_k = \\frac{\\tilde{v}_{r,k}}{\\gamma_k + S_k + D_0 k_\\perp^2 + \\epsilon}\n$$\nThe quasi-linear particle flux for this mode, $\\Gamma_{n,k}$, is the statistical average $\\langle \\tilde{v}_{r,k} \\tilde{n}_k \\rangle$. Assuming the fluctuations are saturated such that we can relate the averaged product to the product of their root-mean-square amplitudes, and given $|\\tilde{v}_{r,k}| = k_y |\\phi_k|$ from the problem statement:\n$$\n\\Gamma_{n,k} = |\\tilde{v}_{r,k}| |\\tilde{n}_k| = \\frac{|\\tilde{v}_{r,k}|^2}{\\gamma_k + S_k + D_0 k_\\perp^2 + \\epsilon} = \\frac{(k_y |\\phi_k|)^2}{\\gamma_k + S_k + D_0 k_\\perp^2 + \\epsilon}\n$$\nThe particle diffusivity $D_n$ is defined by the relation $\\Gamma_n = -D_n (\\partial n_0 / \\partial x)$. Since we have taken $\\partial n_0 / \\partial x = -1$, the diffusivity contribution from mode $k$ is simply $D_{n,k} = \\Gamma_{n,k}$. The total quasi-linear particle diffusivity $D_n^{\\mathrm{QL}}$ is the sum of contributions from all modes in the spectrum:\n$$\nD_n^{\\mathrm{QL}} = \\sum_k \\frac{(k_y |\\phi_k|)^2}{\\gamma_k + S_k + D_0 k_\\perp^2 + \\epsilon}\n$$\nBy identical reasoning, the heat diffusivity $\\chi^{\\mathrm{QL}}$ is obtained by replacing the base particle diffusivity $D_0$ with the base heat diffusivity $\\chi_0$:\n$$\n\\chi^{\\mathrm{QL}} = \\sum_k \\frac{(k_y |\\phi_k|)^2}{\\gamma_k + S_k + \\chi_0 k_\\perp^2 + \\epsilon}\n$$\n\n### Mixing-Length (ML) Transport Model\n\nThe mixing-length model provides a heuristic estimate for turbulent diffusivity. It is based on the idea that the diffusivity is proportional to the product of the square of a characteristic eddy size, $L_{mix}$, and an effective turbulent frequency or growth rate, $\\gamma_{eff}$.\n$$\nD^{\\mathrm{ML}} \\sim \\gamma_{eff} L_{mix}^2\n$$\nFor turbulent eddies characterized by a perpendicular wavenumber $k_\\perp$, the natural choice for the mixing length is the eddy size, $L_{mix} \\sim 1/k_\\perp$.\n\nThe problem specifies that the effective instability rate, $\\gamma_{eff}$, should be a \"shear-reduced rate\". Zonal flow shear is a primary mechanism for suppressing turbulence. A standard model for this effect is that turbulence is suppressed or quenched if the shearing rate $S_k$ exceeds the linear growth rate $\\gamma_k$. This can be modeled by defining an effective growth rate as:\n$$\n\\gamma_{eff,k} = \\max(0, \\gamma_k - S_k)\n$$\nThis form captures the reduction of the effective drive for turbulence due to shear, and its complete suppression when shear is dominant ($S_k \\ge \\gamma_k$).\n\nCombining these elements, the mixing-length diffusivity estimate for a single mode $k$ is:\n$$\nD_{k}^{\\mathrm{ML}} = \\frac{\\gamma_{eff,k}}{k_\\perp^2} = \\frac{\\max(0, \\gamma_k - S_k)}{k_\\perp^2}\n$$\nA regularization parameter $\\epsilon$ is added to the denominator to handle cases where $k_\\perp = 0$. Note that in this model, base collisional dissipation ($D_0, \\chi_0$) is not included, as it is typically a subdominant effect compared to the strong turbulence dynamics captured by $\\gamma_k$ and $S_k$. Since the underlying physics for passive density and temperature transport is assumed to be identical in this simple model, the per-mode estimate is the same for both particle and heat diffusivity: $D_{n,k}^{\\mathrm{ML}} = \\chi_{k}^{\\mathrm{ML}} = D_{k}^{\\mathrm{ML}}$.\n\nFinally, the problem requires aggregating the multi-mode mixing-length predictions via an amplitude-weighted average. The natural weighting factor is the mode intensity, which is proportional to $|\\phi_k|^2$. The total mixing-length particle diffusivity $D_n^{\\mathrm{ML}}$ is therefore:\n$$\nD_n^{\\mathrm{ML}} = \\frac{\\sum_k |\\phi_k|^2 D_{n,k}^{\\mathrm{ML}}}{\\sum_k |\\phi_k|^2} = \\frac{\\sum_k |\\phi_k|^2 \\frac{\\max(0, \\gamma_k - S_k)}{k_x^2 + k_y^2 + \\epsilon}}{\\sum_k |\\phi_k|^2 + \\epsilon}\n$$\nSimilarly, the heat diffusivity $\\chi^{\\mathrm{ML}}$ is given by the same expression:\n$$\n\\chi^{\\mathrm{ML}} = D_n^{\\mathrm{ML}}\n$$\n\n### Summary of Formulas for Implementation\n\nFor each test case, given a set of modes $\\{k\\}$, each characterized by $(k_x, k_y, \\gamma_k, |\\phi_k|, S_k)$, and global parameters $D_0$ and $\\chi_0$:\n\n1.  **Quasi-Linear Particle Diffusivity ($D_n^{\\mathrm{QL}}$)**:\n    $$\n    D_n^{\\mathrm{QL}} = \\sum_k \\frac{(k_y |\\phi_k|)^2}{\\gamma_k + S_k + D_0 (k_x^2 + k_y^2) + \\epsilon}\n    $$\n2.  **Quasi-Linear Heat Diffusivity ($\\chi^{\\mathrm{QL}}$)**:\n    $$\n    \\chi^{\\mathrm{QL}} = \\sum_k \\frac{(k_y |\\phi_k|)^2}{\\gamma_k + S_k + \\chi_0 (k_x^2 + k_y^2) + \\epsilon}\n    $$\n3.  **Mixing-Length Particle Diffusivity ($D_n^{\\mathrm{ML}}$)**:\n    $$\n    D_n^{\\mathrm{ML}} = \\frac{\\sum_k |\\phi_k|^2 \\left( \\frac{\\max(0, \\gamma_k - S_k)}{k_x^2 + k_y^2 + \\epsilon} \\right)}{\\sum_k |\\phi_k|^2 + \\epsilon}\n    $$\n4.  **Mixing-Length Heat Diffusivity ($\\chi^{\\mathrm{ML}}$)**:\n    $$\n    \\chi^{\\mathrm{ML}} = D_n^{\\mathrm{ML}}\n    $$\nThe numerical regularization parameter is $\\epsilon = 10^{-12}$. All final results must be rounded to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quasi-linear (QL) and mixing-length (ML) transport coefficients\n    for synthetic plasma turbulence spectra according to the derived physics models.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: moderate growth, moderate shear\n        {\n            \"D0\": 0.01, \"chi0\": 0.015,\n            \"modes\": [\n                (0.3, 0.2, 0.08, 0.04, 0.03),\n                (0.1, 0.4, 0.12, 0.05, 0.02),\n                (0.2, 0.6, 0.09, 0.03, 0.05),\n            ]\n        },\n        # Case B: strong shear suppression\n        {\n            \"D0\": 0.005, \"chi0\": 0.005,\n            \"modes\": [\n                (0.2, 0.5, 0.05, 0.04, 0.07),\n                (0.5, 0.3, 0.04, 0.02, 0.08),\n                (0.8, 0.2, 0.03, 0.01, 0.10),\n            ]\n        },\n        # Case C: high k_perp spectrum\n        {\n            \"D0\": 0.02, \"chi0\": 0.02,\n            \"modes\": [\n                (1.2, 1.0, 0.15, 0.03, 0.02),\n                (0.9, 1.1, 0.10, 0.02, 0.01),\n                (1.5, 0.7, 0.12, 0.025, 0.03),\n            ]\n        },\n        # Case D: no shear, low growth\n        {\n            \"D0\": 0.0, \"chi0\": 0.0,\n            \"modes\": [\n                (0.05, 0.1, 0.01, 0.05, 0.0),\n                (0.1, 0.05, 0.005, 0.04, 0.0),\n                (0.2, 0.15, 0.02, 0.03, 0.0),\n            ]\n        }\n    ]\n\n    epsilon = 1e-12\n    all_results = []\n\n    for case in test_cases:\n        D0 = case[\"D0\"]\n        chi0 = case[\"chi0\"]\n        modes = case[\"modes\"]\n        \n        Dn_ql = 0.0\n        chi_ql = 0.0\n        \n        ml_numerator = 0.0\n        total_phi_sq = 0.0\n\n        for mode in modes:\n            kx, ky, gamma_k, phi_k, S_k = mode\n            \n            k_perp_sq = kx**2 + ky**2\n            \n            # --- Quasi-Linear (QL) Calculation ---\n            # Numerator is common for both particle and heat transport\n            ql_numerator = (ky * phi_k)**2\n            \n            # Denominator for particle diffusivity\n            ql_denominator_n = gamma_k + S_k + D0 * k_perp_sq + epsilon\n            Dn_ql += ql_numerator / ql_denominator_n\n            \n            # Denominator for heat diffusivity\n            ql_denominator_chi = gamma_k + S_k + chi0 * k_perp_sq + epsilon\n            chi_ql += ql_numerator / ql_denominator_chi\n\n            # --- Mixing-Length (ML) Calculation ---\n            # Effective shear-reduced growth rate\n            gamma_eff = max(0, gamma_k - S_k)\n            \n            # Per-mode ML diffusivity\n            Dk_ml = gamma_eff / (k_perp_sq + epsilon)\n            \n            # Accumulate for weighted average\n            phi_k_sq = phi_k**2\n            ml_numerator += phi_k_sq * Dk_ml\n            total_phi_sq += phi_k_sq\n\n        # Finalize ML calculation by performing the weighted average\n        Dn_ml = ml_numerator / (total_phi_sq + epsilon)\n        chi_ml = Dn_ml  # In this model, chi_ml is identical to Dn_ml\n\n        # Store results for the current case, rounded to 6 decimal places\n        case_results = [\n            round(Dn_ql, 6),\n            round(chi_ql, 6),\n            round(Dn_ml, 6),\n            round(chi_ml, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as required by the problem statement\n    # Example: [[d1,x1,dm1,xm1],[d2,x2,dm2,xm2],...]\n    output_str = \"[\" + \",\".join([str(res) for res in all_results]) + \"]\"\n    output_str = output_str.replace(\" \", \"\") # Remove spaces for exact format match\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}