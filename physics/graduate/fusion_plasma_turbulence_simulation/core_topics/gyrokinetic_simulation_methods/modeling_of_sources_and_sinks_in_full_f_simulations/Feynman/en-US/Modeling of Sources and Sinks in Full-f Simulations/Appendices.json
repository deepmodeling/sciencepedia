{
    "hands_on_practices": [
        {
            "introduction": "Understanding the interplay between particle transport, sources, and sinks is fundamental to kinetic modeling. This first exercise provides a cornerstone by asking you to derive the exact analytical solution for a simple one-dimensional kinetic system . By solving this, you will gain direct insight into how a balance between constant sourcing, linear losses, and particle streaming establishes a specific steady-state spatial profile for the distribution function.",
            "id": "4196643",
            "problem": "Consider a one-dimensional slab model for a full-distribution-function (full-$f$) kinetic simulation of a magnetized fusion plasma along a rectilinear coordinate $x \\in [0,L]$ aligned with the magnetic field. The full distribution function $f(x)$ represents the phase-space density of guiding centers with a fixed parallel speed $v>0$ (monoenergetic approximation) streaming along $+x$. In steady state, the evolution of $f(x)$ is governed by the balance of parallel free streaming, a spatially uniform particle source, and a linear sink that models losses to material boundaries or effective collisional absorption. Starting from the kinetic advection-source-sink balance\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = S(x) - \\Sigma(f,x),\n$$\nassume steady state $\\partial f/\\partial t=0$, a constant source $S(x)=S_0$ with $S_0 \\ge 0$, and a linear sink $\\Sigma(f,x) = \\alpha f$ with $\\alpha>0$ (e.g., a Bhatnagar–Gross–Krook (BGK) type relaxation to zero). The domain has an inflow boundary condition at $x=0$ appropriate for right-moving characteristics,\n$$\nf(0) = f_{\\mathrm{in}},\n$$\nwith $f_{\\mathrm{in}} \\ge 0$ given, and a free outflow at $x=L$ (no additional boundary constraint is imposed at $x=L$ for $v>0$).\n\nDerive the analytic steady-state solution $f(x)$ from first principles using the above fundamental kinetic balance and appropriate boundary placement for characteristics. Then verify that your solution satisfies the inflow boundary condition at $x=0$ and is physically admissible (bounded and nonnegative for $S_0 \\ge 0$, $\\alpha>0$, $f_{\\mathrm{in}} \\ge 0$). Express your final answer as a single closed-form analytic expression for $f(x)$. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The time-dependent kinetic equation is $\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = S(x) - \\Sigma(f,x)$.\n- **Domain:** The spatial domain is a one-dimensional slab, $x \\in [0,L]$.\n- **Particle Velocity:** Particles are monoenergetic with a fixed parallel speed $v > 0$, streaming in the positive $x$ direction.\n- **Steady State:** The system is in steady state, so $\\frac{\\partial f}{\\partial t} = 0$.\n- **Source Term:** The particle source is spatially uniform, $S(x) = S_0$, with $S_0 \\ge 0$.\n- **Sink Term:** The particle sink is linear, $\\Sigma(f,x) = \\alpha f$, with $\\alpha > 0$.\n- **Inflow Boundary Condition:** The distribution function at the inflow boundary $x=0$ is specified as $f(0) = f_{\\mathrm{in}}$, with $f_{\\mathrm{in}} \\ge 0$.\n- **Outflow Condition:** A free outflow condition is assumed at $x=L$, which for particles with $v>0$ means no constraint is imposed at this boundary.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria for validity.\n\n- **Scientific Groundedness:** The problem is based on the one-dimensional, steady-state kinetic transport equation. This is a fundamental equation in transport theory and plasma physics. The source term ($S_0$) and sink term ($\\alpha f$) are standard, simplified models (e.g., a BGK-type collision operator relaxing to a zero background) used to represent particle sources and losses. The model is physically and mathematically sound.\n- **Well-Posedness:** In steady state, the governing partial differential equation reduces to a first-order ordinary differential equation in the spatial coordinate $x$. A first-order ODE requires a single boundary condition to yield a unique solution. The problem provides exactly one boundary condition, $f(0) = f_{\\mathrm{in}}$. Since the characteristics of the equation $v \\frac{df}{dx} = \\dots$ propagate in the direction of increasing $x$ (because $v>0$), the boundary condition must be specified at the inflow boundary, $x=0$. The problem correctly does this. Therefore, the problem is well-posed.\n- **Objectivity:** The problem is stated in precise mathematical and physical terms, free of ambiguity or subjective language.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and objective. It is free from contradictions, missing information, and other flaws. Therefore, the problem is deemed **valid**. A solution will now be derived.\n\nThe starting point is the provided kinetic equation:\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} = S(x) - \\Sigma(f,x)\n$$\nApplying the steady-state condition, $\\frac{\\partial f}{\\partial t} = 0$, and substituting the given forms for the source, $S(x) = S_0$, and sink, $\\Sigma(f,x) = \\alpha f$, we obtain the steady-state equation for the distribution function $f(x)$:\n$$\nv \\frac{df}{dx} = S_0 - \\alpha f\n$$\nThis is a first-order linear ordinary differential equation. To solve it, we rearrange it into the standard form $\\frac{dy}{dx} + P(x)y = Q(x)$:\n$$\nv \\frac{df}{dx} + \\alpha f = S_0\n$$\nDividing by the constant speed $v$ (since $v>0$), we get:\n$$\n\\frac{df}{dx} + \\frac{\\alpha}{v} f = \\frac{S_0}{v}\n$$\nThis equation can be solved using the method of integrating factors. The integrating factor, $I(x)$, is given by:\n$$\nI(x) = \\exp\\left(\\int \\frac{\\alpha}{v} dx\\right) = \\exp\\left(\\frac{\\alpha x}{v}\\right)\n$$\nMultiplying the differential equation by the integrating factor $I(x)$ yields:\n$$\n\\exp\\left(\\frac{\\alpha x}{v}\\right) \\frac{df}{dx} + \\frac{\\alpha}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right) f = \\frac{S_0}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right)\n$$\nThe left-hand side is the derivative of the product $f(x)I(x)$ by the product rule:\n$$\n\\frac{d}{dx}\\left[f(x) \\exp\\left(\\frac{\\alpha x}{v}\\right)\\right] = \\frac{S_0}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right)\n$$\nWe integrate both sides with respect to $x$ to find the general solution:\n$$\n\\int \\frac{d}{dx}\\left[f(x) \\exp\\left(\\frac{\\alpha x}{v}\\right)\\right] dx = \\int \\frac{S_0}{v} \\exp\\left(\\frac{\\alpha x}{v}\\right) dx\n$$\n$$\nf(x) \\exp\\left(\\frac{\\alpha x}{v}\\right) = \\frac{S_0}{v} \\left(\\frac{v}{\\alpha}\\right) \\exp\\left(\\frac{\\alpha x}{v}\\right) + C\n$$\nwhere $C$ is the constant of integration. Simplifying this expression gives:\n$$\nf(x) \\exp\\left(\\frac{\\alpha x}{v}\\right) = \\frac{S_0}{\\alpha} \\exp\\left(\\frac{\\alpha x}{v}\\right) + C\n$$\nTo obtain $f(x)$, we multiply by $\\exp\\left(-\\frac{\\alpha x}{v}\\right)$:\n$$\nf(x) = \\frac{S_0}{\\alpha} + C \\exp\\left(-\\frac{\\alpha x}{v}\\right)\n$$\nThis is the general solution to the ODE. The constant $C$ is determined by the inflow boundary condition $f(0) = f_{\\mathrm{in}}$. We evaluate the general solution at $x=0$:\n$$\nf(0) = \\frac{S_0}{\\alpha} + C \\exp(0) = \\frac{S_0}{\\alpha} + C\n$$\nSetting this equal to the given boundary value $f_{\\mathrm{in}}$:\n$$\nf_{\\mathrm{in}} = \\frac{S_0}{\\alpha} + C\n$$\nSolving for $C$:\n$$\nC = f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\n$$\nSubstituting this expression for $C$ back into the general solution gives the unique, particular solution for $f(x)$:\n$$\nf(x) = \\frac{S_0}{\\alpha} + \\left(f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\\right) \\exp\\left(-\\frac{\\alpha x}{v}\\right)\n$$\nThis is the final analytic solution.\n\nFinally, we verify that the solution is physically admissible.\nFirst, we check the boundary condition at $x=0$:\n$$\nf(0) = \\frac{S_0}{\\alpha} + \\left(f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\\right) \\exp(0) = \\frac{S_0}{\\alpha} + f_{\\mathrm{in}} - \\frac{S_0}{\\alpha} = f_{\\mathrm{in}}\n$$\nThe inflow boundary condition is satisfied.\n\nSecond, we check for non-negativity, $f(x) \\ge 0$, for all $x \\in [0, L]$, given the constraints $S_0 \\ge 0$, $f_{\\mathrm{in}} \\ge 0$, $\\alpha > 0$, and $v > 0$. We can rewrite the solution as:\n$$\nf(x) = \\frac{S_0}{\\alpha} \\left(1 - \\exp\\left(-\\frac{\\alpha x}{v}\\right)\\right) + f_{\\mathrm{in}} \\exp\\left(-\\frac{\\alpha x}{v}\\right)\n$$\nFor $x \\ge 0$, we have $\\frac{\\alpha x}{v} \\ge 0$. Therefore, $0 < \\exp\\left(-\\frac{\\alpha x}{v}\\right) \\le 1$.\nThe term $\\left(1 - \\exp\\left(-\\frac{\\alpha x}{v}\\right)\\right)$ is thus bounded between $0$ (at $x=0$) and $1$ (as $x \\to \\infty$), so it is always non-negative.\nSince $S_0 \\ge 0$ and $\\alpha > 0$, the first term $\\frac{S_0}{\\alpha} \\left(1 - \\exp\\left(-\\frac{\\alpha x}{v}\\right)\\right)$ is non-negative.\nSince $f_{\\mathrm{in}} \\ge 0$ and $\\exp\\left(-\\frac{\\alpha x}{v}\\right) > 0$, the second term $f_{\\mathrm{in}} \\exp\\left(-\\frac{\\alpha x}{v}\\right)$ is also non-negative.\nThe sum of two non-negative terms is non-negative, so $f(x) \\ge 0$ for all $x \\ge 0$. The solution is physically admissible and bounded on the domain $[0,L]$.\nThe solution represents a balance: the distribution function starts at $f_{\\mathrm{in}}$ and evolves over the length scale $v/\\alpha$ towards an equilibrium value $S_0/\\alpha$, which is the value that would balance the source and sink locally ($S_0 - \\alpha f = 0$).",
            "answer": "$$\n\\boxed{\\frac{S_0}{\\alpha} + \\left(f_{\\mathrm{in}} - \\frac{S_0}{\\alpha}\\right) \\exp\\left(-\\frac{\\alpha x}{v}\\right)}\n$$"
        },
        {
            "introduction": "In simulations, sources often represent physical processes like radio-frequency (RF) heating, which are characterized by macroscopic parameters such as injected power. This practice bridges the gap between the microscopic model—a quasi-linear diffusion operator in velocity space—and the macroscopic observable . You will derive the relationship between the diffusion coefficient $D_{\\text{RF}}$ and the absorbed power density $p_{\\text{in}}$, a critical step for setting up physically realistic heating simulations.",
            "id": "4196633",
            "problem": "Consider a spatially homogeneous, fully resolved distribution function (full-f) description for electrons in a fusion plasma, where the velocity-space dynamics are modeled by a Fokker–Planck equation with a Radio Frequency (RF) quasi-linear diffusion term. Let the electron distribution function be denoted by $f(\\mathbf{v}, t)$, with electron mass $m$ and number density $n_0$. The RF term is modeled as an isotropic velocity-space diffusion operator with a constant coefficient $D_{\\text{RF}}$, so that the contribution of RF to the kinetic equation is $\\nabla_{\\mathbf{v}} \\cdot \\left( D_{\\text{RF}} \\nabla_{\\mathbf{v}} f \\right)$. Assume the steady-state electron distribution is Maxwellian,\n$$\nf_M(v) = n_0 \\left( \\frac{m}{2\\pi T_0} \\right)^{3/2} \\exp\\!\\left( - \\frac{m v^2}{2 T_0} \\right),\n$$\nwith temperature $T_0$ and $v = |\\mathbf{v}|$. Let the thermal speed be $v_{\\text{th}} = \\sqrt{ \\frac{2 T_0}{m} }$. Define the kinetic energy density as\n$$\nW = \\int \\frac{m v^2}{2} f(\\mathbf{v}) \\, d^3 v.\n$$\nSuppose a uniform injected RF power per unit volume $p_{\\text{in}}$ is delivered to the electrons, and that in steady state the energy balance is satisfied by equality of the RF energy input to the electrons and the macroscopic sink (so that the net time derivative of $W$ is zero). Using first-principles energy balance and the above RF diffusion operator, derive the relation between $D_{\\text{RF}}$ and $p_{\\text{in}}$. Then, normalize $D_{\\text{RF}}$ by the reference thermal speed and a given reference frequency $\\nu_0$ via\n$$\n\\hat{D}_{\\text{RF}} = \\frac{D_{\\text{RF}}}{ v_{\\text{th}}^2 \\, \\nu_0 }.\n$$\nTake the following parameters:\n- electron mass $m = 9.109\\,383\\,7015 \\times 10^{-31} \\, \\text{kg}$,\n- number density $n_0 = 1.0 \\times 10^{20} \\, \\text{m}^{-3}$,\n- temperature $T_0 = 2 \\, \\text{keV}$,\n- injected RF power density $p_{\\text{in}} = 2.0 \\times 10^{5} \\, \\text{W} \\, \\text{m}^{-3}$,\n- reference frequency $\\nu_0 = 1.0 \\times 10^{5} \\, \\text{s}^{-1}$.\nUse $1 \\, \\text{eV} = 1.602\\,176\\,634 \\times 10^{-19} \\, \\text{J}$. Compute the numerical value of $\\hat{D}_{\\text{RF}}$ under these assumptions. Express the final answer as a dimensionless number. Round your answer to three significant figures.",
            "solution": "The problem requires the derivation of a relation between the Radio Frequency (RF) quasi-linear diffusion coefficient $D_{\\text{RF}}$ and the injected RF power density $p_{\\text{in}}$, and subsequently the calculation of a normalized, dimensionless coefficient $\\hat{D}_{\\text{RF}}$. The validation of the problem statement must precede any attempt at a solution.\n\n### Step 1: Extract Givens\n- The kinetic equation for the electron distribution function $f(\\mathbf{v}, t)$ includes an RF term given by the operator $C_{\\text{RF}}(f) = \\nabla_{\\mathbf{v}} \\cdot \\left( D_{\\text{RF}} \\nabla_{\\mathbf{v}} f \\right)$, where $D_{\\text{RF}}$ is a constant.\n- The steady-state electron distribution is a Maxwellian: $f_M(v) = n_0 \\left( \\frac{m}{2\\pi T_0} \\right)^{3/2} \\exp\\!\\left( - \\frac{m v^2}{2 T_0} \\right)$, with $v = |\\mathbf{v}|$.\n- The electron number density is $n_0$ and the electron mass is $m$. The temperature is $T_0$.\n- The kinetic energy density is defined as $W = \\int \\frac{m v^2}{2} f(\\mathbf{v}) \\, d^3 v$.\n- In steady state, the injected RF power per unit volume, $p_{\\text{in}}$, is equal to the rate of energy input from the RF source to the electrons.\n- The thermal speed is defined as $v_{\\text{th}} = \\sqrt{ \\frac{2 T_0}{m} }$.\n- The normalized diffusion coefficient is $\\hat{D}_{\\text{RF}} = \\frac{D_{\\text{RF}}}{ v_{\\text{th}}^2 \\, \\nu_0 }$, where $\\nu_0$ is a reference frequency.\n- The numerical parameters are:\n  - $m = 9.109\\,383\\,7015 \\times 10^{-31} \\, \\text{kg}$\n  - $n_0 = 1.0 \\times 10^{20} \\, \\text{m}^{-3}$\n  - $T_0 = 2 \\, \\text{keV}$\n  - $p_{\\text{in}} = 2.0 \\times 10^{5} \\, \\text{W} \\, \\text{m}^{-3}$\n  - $\\nu_0 = 1.0 \\times 10^{5} \\, \\text{s}^{-1}$\n  - $1 \\, \\text{eV} = 1.602\\,176\\,634 \\times 10^{-19} \\, \\text{J}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, using standard concepts from plasma kinetic theory such as the Fokker-Planck equation, quasi-linear diffusion, and Maxwellian distributions. The parameters provided are physically realistic for a fusion plasma environment. The problem is well-posed, providing sufficient information to establish a unique relationship between the variables and compute the required numerical value. The language is objective and precise. The assumption that the steady-state distribution is Maxwellian is a standard approximation in certain analytical treatments to estimate RF power absorption, where it is implicitly assumed that collisional processes are strong enough to maintain a near-thermal distribution. Thus, the problem is deemed valid.\n\n### Step 3: Derivation and Solution\n\nThe core of the problem lies in the steady-state energy balance. The injected power density $p_{\\text{in}}$ is the rate at which the RF field does work on the electron population. This rate is calculated by taking the energy-moment of the RF collision operator acting on the steady-state distribution function $f_M$.\n$$\np_{\\text{in}} = \\frac{d W_{\\text{RF}}}{dt} = \\int \\frac{m v^2}{2} C_{\\text{RF}}(f_M) \\, d^3v\n$$\nSubstituting the expression for the RF operator, we have:\n$$\np_{\\text{in}} = \\int \\frac{m v^2}{2} \\left[ \\nabla_{\\mathbf{v}} \\cdot \\left( D_{\\text{RF}} \\nabla_{\\mathbf{v}} f_M \\right) \\right] \\, d^3v\n$$\nTo evaluate this integral over all of velocity space, we apply integration by parts (specifically, Green's first identity in three dimensions). Let $\\phi = \\frac{m v^2}{2}$ and $\\mathbf{A} = D_{\\text{RF}} \\nabla_{\\mathbf{v}} f_M$. The integral becomes:\n$$\np_{\\text{in}} = \\oint_{S_\\infty} \\phi \\mathbf{A} \\cdot d\\mathbf{S}_{\\mathbf{v}} - \\int \\left( \\nabla_{\\mathbf{v}} \\phi \\right) \\cdot \\mathbf{A} \\, d^3v\n$$\nThe surface integral is taken over the boundary of velocity space, a sphere of infinite radius ($v \\to \\infty$). Since $f_M$ is a Maxwellian distribution, it and its gradient decay as $\\exp(-a v^2)$, which is a much faster decay than the polynomial growth of any other terms in the integrand. Consequently, the surface integral vanishes. We are left with the volume integral:\n$$\np_{\\text{in}} = - \\int \\left[ \\nabla_{\\mathbf{v}} \\left( \\frac{m v^2}{2} \\right) \\right] \\cdot \\left( D_{\\text{RF}} \\nabla_{\\mathbf{v}} f_M \\right) \\, d^3v\n$$\nWe compute the gradients. The gradient of the kinetic energy is:\n$$\n\\nabla_{\\mathbf{v}} \\left( \\frac{m v^2}{2} \\right) = m \\mathbf{v}\n$$\nThe gradient of the Maxwellian distribution $f_M(v)$ is:\n$$\n\\nabla_{\\mathbf{v}} f_M(v) = \\frac{\\partial f_M}{\\partial v} \\frac{\\mathbf{v}}{v} = \\left[ n_0 \\left( \\frac{m}{2\\pi T_0} \\right)^{3/2} \\exp\\!\\left( - \\frac{m v^2}{2 T_0} \\right) \\left( - \\frac{m (2v)}{2 T_0} \\right) \\right] \\frac{\\mathbf{v}}{v} = -f_M(v) \\frac{m \\mathbf{v}}{T_0}\n$$\nSubstituting these gradients back into the integral for $p_{\\text{in}}$ and noting that $D_{\\text{RF}}$ is a constant:\n$$\np_{\\text{in}} = - D_{\\text{RF}} \\int (m \\mathbf{v}) \\cdot \\left( -f_M \\frac{m \\mathbf{v}}{T_0} \\right) \\, d^3v = \\frac{D_{\\text{RF}} m^2}{T_0} \\int v^2 f_M(v) \\, d^3v\n$$\nThe integral $\\int v^2 f_M(v) \\, d^3v$ is the second moment of the distribution function, which is related to the average squared speed $\\langle v^2 \\rangle$ by $\\int v^2 f_M(v) \\, d^3v = n_0 \\langle v^2 \\rangle$. For a Maxwellian distribution in three dimensions, the equipartition theorem gives $\\frac{1}{2} m \\langle v^2 \\rangle = \\frac{3}{2} T_0$ (where $T_0$ is in energy units). Thus, $\\langle v^2 \\rangle = \\frac{3 T_0}{m}$.\nThe integral is therefore:\n$$\n\\int v^2 f_M(v) \\, d^3v = n_0 \\left( \\frac{3 T_0}{m} \\right) = \\frac{3 n_0 T_0}{m}\n$$\nSubstituting this result into the expression for $p_{\\text{in}}$:\n$$\np_{\\text{in}} = \\frac{D_{\\text{RF}} m^2}{T_0} \\left( \\frac{3 n_0 T_0}{m} \\right) = 3 n_0 m D_{\\text{RF}}\n$$\nThis gives the desired relationship between $D_{\\text{RF}}$ and $p_{\\text{in}}$:\n$$\nD_{\\text{RF}} = \\frac{p_{\\text{in}}}{3 n_0 m}\n$$\nNext, we compute the normalized coefficient $\\hat{D}_{\\text{RF}}$. The definition is given as:\n$$\n\\hat{D}_{\\text{RF}} = \\frac{D_{\\text{RF}}}{ v_{\\text{th}}^2 \\, \\nu_0 }\n$$\nUsing the provided definition for the thermal speed, $v_{\\text{th}} = \\sqrt{\\frac{2 T_0}{m}}$, we have $v_{\\text{th}}^2 = \\frac{2 T_0}{m}$. Substituting this into the normalization:\n$$\n\\hat{D}_{\\text{RF}} = \\frac{D_{\\text{RF}}}{ \\left(\\frac{2 T_0}{m}\\right) \\nu_0 } = \\frac{m D_{\\text{RF}}}{2 T_0 \\nu_0}\n$$\nFinally, we substitute our derived expression for $D_{\\text{RF}}$:\n$$\n\\hat{D}_{\\text{RF}} = \\frac{m}{2 T_0 \\nu_0} \\left( \\frac{p_{\\text{in}}}{3 n_0 m} \\right) = \\frac{p_{\\text{in}}}{6 n_0 T_0 \\nu_0}\n$$\nThis symbolic expression for $\\hat{D}_{\\text{RF}}$ is independent of the electron mass $m$.\n\nNow, we must substitute the given numerical values, ensuring all are in base SI units.\n- $p_{\\text{in}} = 2.0 \\times 10^{5} \\, \\text{J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-3}$\n- $n_0 = 1.0 \\times 10^{20} \\, \\text{m}^{-3}$\n- $\\nu_0 = 1.0 \\times 10^{5} \\, \\text{s}^{-1}$\n- $T_0 = 2 \\, \\text{keV} = 2 \\times 10^{3} \\, \\text{eV}$. We convert this to Joules:\n  $T_0 = (2 \\times 10^3) \\times (1.602\\,176\\,634 \\times 10^{-19}) \\, \\text{J} = 3.204\\,353\\,268 \\times 10^{-16} \\, \\text{J}$\n\nSubstitute these values into the expression for $\\hat{D}_{\\text{RF}}$:\n$$\n\\hat{D}_{\\text{RF}} = \\frac{2.0 \\times 10^{5}}{6 \\times (1.0 \\times 10^{20}) \\times (3.204\\,353\\,268 \\times 10^{-16}) \\times (1.0 \\times 10^{5})}\n$$\n$$\n\\hat{D}_{\\text{RF}} = \\frac{2.0 \\times 10^{5}}{6 \\times 3.204\\,353\\,268 \\times 10^{(20 - 16 + 5)}} = \\frac{2.0 \\times 10^{5}}{19.226\\,119\\,608 \\times 10^{9}}\n$$\n$$\n\\hat{D}_{\\text{RF}} = \\frac{2.0}{19.226\\,119\\,608} \\times 10^{5-9} \\approx 0.104\\,025 \\times 10^{-4} = 1.040\\,25 \\times 10^{-5}\n$$\nRounding the result to three significant figures as required by the problem statement gives:\n$$\n\\hat{D}_{\\text{RF}} \\approx 1.04 \\times 10^{-5}\n$$\nThis is the final dimensionless numerical value for the normalized RF diffusion coefficient.",
            "answer": "$$\\boxed{1.04 \\times 10^{-5}}$$"
        },
        {
            "introduction": "Implementing source and sink terms in a time-dependent simulation requires careful consideration of numerical stability and physical constraints. This exercise tackles a critical challenge: ensuring the distribution function $f$ remains non-negative, a property that simple explicit time-stepping schemes can easily violate . You will design and implement a positivity-preserving limiter, a practical and essential tool for developing robust full-f codes.",
            "id": "4196640",
            "problem": "You are modeling the single-step update due to sources and linear sinks in a full distribution function (full-f) simulation of a fusion plasma. Consider a single phase-space point with nonnegative distribution value $f^n \\ge 0$ at discrete time index $n$. Over a time step of size $\\Delta t$, the effect of a source term $S$ (which can be positive or negative) and a linear sink with coefficient $\\alpha \\ge 0$ is modeled by the explicit forward-Euler update\n$$\nf^{n+1} \\;=\\; f^n \\;+\\; \\Delta t\\,\\big(S \\;-\\; \\alpha f^n\\big)\n\\;=\\; \\big(1 - \\alpha \\Delta t\\big)\\,f^n \\;+\\; \\Delta t\\,S.\n$$\nAll quantities are dimensionless. In the context of operator splitting, you will implement a local, pointwise positivity-preserving limiter that modifies only the source amplitude before it is applied, such that $f^{n+1} \\ge 0$ whenever $f^n \\ge 0$. The limiter must be designed using first principles and must not rely on nonphysical adjustments to $f^n$ or $\\alpha$. Assume that the linear sink Courant number satisfies $0 \\le \\alpha \\Delta t \\le 1$.\n\nYour tasks are:\n1) From first principles, derive a sufficient condition (expressed as a bound on the effective source amplitude) that guarantees $f^{n+1} \\ge 0$ given $f^n \\ge 0$ and $0 \\le \\alpha \\Delta t \\le 1$. Your derivation must start from the explicit forward-Euler formula above and must not assume any unenforced constraint on $S$ beyond what you design as a limiter. Explain why this condition is mathematically sufficient to ensure $f^{n+1} \\ge 0$.\n2) Design a local limiter that enforces your derived condition by modifying only the source amplitude $S$ before updating $f$. The limiter must act pointwise, must not increase $S$ if $S$ already satisfies the bound, and must minimally modify $S$ in the sense of the smallest change necessary to satisfy the condition. Prove that your limiter satisfies the condition from part 1) for any $f^n \\ge 0$ and $0 \\le \\alpha \\Delta t \\le 1$.\n3) Implement a program that:\n   - Defines a function that takes $(f^n,\\alpha,\\Delta t,S)$ and returns the updated value $f^{n+1}$ using your limiter.\n   - Applies this function to a test suite of parameter sets and produces a single-line output containing the list of resulting $f^{n+1}$ values, each rounded to six decimal places.\n\nUse the following test suite, which exercises a representative \"happy path\" case, boundary cases, and significant edge cases. All quantities are dimensionless and satisfy $0 \\le \\alpha \\Delta t \\le 1$:\n- Test A: $f^n = 1.0$, $\\alpha = 0.3$, $\\Delta t = 1.0$, $S = -0.5$.\n- Test B: $f^n = 0.2$, $\\alpha = 0.2$, $\\Delta t = 1.0$, $S = -0.16$.\n- Test C: $f^n = 0.1$, $\\alpha = 0.4$, $\\Delta t = 1.0$, $S = -0.3$.\n- Test D: $f^n = 5.0$, $\\alpha = 1.0$, $\\Delta t = 1.0$, $S = -1.0$.\n- Test E: $f^n = 0.0$, $\\alpha = 0.6$, $\\Delta t = 1.0$, $S = -10.0$.\n- Test F: $f^n = 0.7$, $\\alpha = 0.5$, $\\Delta t = 0.5$, $S = 0.4$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[x,y,z]\"), with each $f^{n+1}$ rounded to six decimal places.",
            "solution": "The problem requires the derivation, design, and implementation of a positivity-preserving limiter for a forward-Euler update of a distribution function, $f$. The update models the effect of a source, $S$, and a linear sink, $\\alpha$, over a time step, $\\Delta t$.\n\nThe governing equation for the update is:\n$$f^{n+1} = f^n + \\Delta t (S - \\alpha f^n) = (1 - \\alpha \\Delta t) f^n + \\Delta t S$$\nThe following conditions are given: the initial distribution function value is non-negative, $f^n \\ge 0$; the sink coefficient is non-negative, $\\alpha \\ge 0$; and the linear sink Courant number satisfies $0 \\le \\alpha \\Delta t \\le 1$. The task is to ensure the updated value is also non-negative, $f^{n+1} \\ge 0$, by modifying only the source amplitude $S$. We will assume a non-zero time step, $\\Delta t > 0$, as a zero time step implies no evolution.\n\nFirst, we derive a sufficient condition on $S$ that guarantees $f^{n+1} \\ge 0$. The requirement is:\n$$f^{n+1} \\ge 0$$\nSubstituting the update formula, we get:\n$$(1 - \\alpha \\Delta t) f^n + \\Delta t S \\ge 0$$\nLet's analyze the first term, $(1 - \\alpha \\Delta t) f^n$. The problem statement provides two crucial constraints: $f^n \\ge 0$ and $0 \\le \\alpha \\Delta t \\le 1$. The second constraint implies that the factor $(1 - \\alpha \\Delta t)$ is bounded between $0$ and $1$:\n$$0 \\le \\alpha \\Delta t \\le 1 \\implies -1 \\le -\\alpha \\Delta t \\le 0 \\implies 0 \\le 1 - \\alpha \\Delta t \\le 1$$\nSince both $(1 - \\alpha \\Delta t)$ and $f^n$ are non-negative, their product is also non-negative:\n$$(1 - \\alpha \\Delta t) f^n \\ge 0$$\nTo satisfy the inequality for $f^{n+1}$, we can now establish a bound on the source term $S$. We rearrange the inequality:\n$$\\Delta t S \\ge - (1 - \\alpha \\Delta t) f^n$$\nSince we assume $\\Delta t > 0$, we can divide by $\\Delta t$ without altering the direction of the inequality, yielding the sufficient condition on $S$:\n$$S \\ge - \\frac{(1 - \\alpha \\Delta t) f^n}{\\Delta t}$$\nIf the source amplitude $S$ respects this lower bound, then $f^{n+1}$ is guaranteed to be non-negative. This follows directly by reversing the steps of this derivation.\n\nSecond, we design a limiter that enforces this condition. The limiter must modify the source term $S$ to a new value, $S_{\\text{lim}}$, that always satisfies the derived bound. We define the minimum allowed source amplitude as $S_{\\text{min}}$:\n$$S_{\\text{min}} = - \\frac{(1 - \\alpha \\Delta t) f^n}{\\Delta t}$$\nThe required condition is thus $S \\ge S_{\\text{min}}$. The limiter must not change $S$ if it already satisfies this condition, and must minimally adjust $S$ if it does not. The unique mathematical operation that achieves this is the maximum function. We define the limited source as:\n$$S_{\\text{lim}} = \\max(S, S_{\\text{min}})$$\nThis limiter correctly satisfies the design requirements. If $S \\ge S_{\\text{min}}$, then $S_{\\text{lim}} = S$, and the source is not modified. If $S < S_{\\text{min}}$, then $S_{\\text{lim}} = S_{\\text{min}}$, which is the smallest possible modification to $S$ to satisfy the positivity condition. With this limited source, the update equation becomes:\n$$f^{n+1} = (1 - \\alpha \\Delta t) f^n + \\Delta t S_{\\text{lim}}$$\nBy the definition of our limiter, we have $S_{\\text{lim}} \\ge S_{\\text{min}}$ for any value of $S$. Substituting this into the update formula guarantees that the condition for non-negativity is met, and thus $f^{n+1} \\ge 0$.\n\nThird, we outline the algorithm for implementation. A function will take $(f^n, \\alpha, \\Delta t, S)$ as input. Assuming $\\Delta t > 0$, the function will:\n$1$. Calculate the minimum source value, $S_{\\text{min}} = - \\frac{(1 - \\alpha \\Delta t) f^n}{\\Delta t}$.\n$2$. Compute the limited source, $S_{\\text{lim}} = \\max(S, S_{\\text{min}})$.\n$3$. Calculate the new distribution function value, $f^{n+1} = (1 - \\alpha \\Delta t)f^n + \\Delta t S_{\\text{lim}}$.\n$4$. Return $f^{n+1}$.\nThis procedure is applied to each of the test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of applying a positivity-preserving limiter to a\n    forward-Euler update of a distribution function.\n    \"\"\"\n    # Test cases from the problem statement.\n    # Each tuple is (f^n, alpha, Delta_t, S)\n    test_cases = [\n        (1.0, 0.3, 1.0, -0.5),   # Test A\n        (0.2, 0.2, 1.0, -0.16),  # Test B\n        (0.1, 0.4, 1.0, -0.3),   # Test C\n        (5.0, 1.0, 1.0, -1.0),   # Test D\n        (0.0, 0.6, 1.0, -10.0),  # Test E\n        (0.7, 0.5, 0.5, 0.4),    # Test F\n    ]\n\n    def update_with_limiter(f_n: float, alpha: float, dt: float, S: float) -> float:\n        \"\"\"\n        Calculates the updated distribution function f^{n+1} using the\n        derived positivity-preserving limiter for the source term.\n        \n        Args:\n            f_n: Distribution function value at time n.\n            alpha: Linear sink coefficient.\n            dt: Time step size.\n            S: Source amplitude.\n            \n        Returns:\n            The updated distribution value f^{n+1}, guaranteed to be non-negative.\n        \"\"\"\n        if dt == 0.0:\n            # If time step is zero, no change occurs.\n            return f_n\n\n        alpha_dt = alpha * dt\n        \n        # Calculate the minimum allowed source term to ensure positivity.\n        # S_min = - (1 - alpha*dt) * f_n / dt\n        s_min = - (1.0 - alpha_dt) * f_n / dt\n        \n        # Apply the limiter: take the maximum of the original source and the minimum allowed value.\n        s_lim = np.maximum(S, s_min)\n        \n        # Calculate f^{n+1} using the limited source term.\n        # f^{n+1} = (1 - alpha*dt) * f_n + dt * S_lim\n        f_next = (1.0 - alpha_dt) * f_n + dt * s_lim\n        \n        return f_next\n\n    results = []\n    for case in test_cases:\n        f_n, alpha, dt, S = case\n        f_next = update_with_limiter(f_n, alpha, dt, S)\n        results.append(f_next)\n\n    # Format the results to six decimal places as specified.\n    formatted_results = [f'{r:.6f}' for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}