## 引言
在[磁约束聚变](@entry_id:180408)研究中，等离子体是一个远离[热力学平衡](@entry_id:141660)的开放系统。持续的外部加热和粒子注入使其维持着驱动[湍流](@entry_id:151300)和输运所需的宏观梯度，而这些过程正是决定聚变装置性能的关键。然而，在计算模拟中，一个封闭的、孤立的系统会因碰撞而不可避免地弛豫到无趣的[平衡态](@entry_id:270364)，从而无法捕捉到真实等离子体的复杂动力学。如何在一个自洽的动理学框架内，既能精确描述[湍流](@entry_id:151300)的微观演化，又能维持宏观的非平衡定常态？这正是全[分布函数](@entry_id:145626)（full-f）模拟中源项与汇项建模所要解决的核心问题。

本文将系统性地探讨在[全f模拟](@entry_id:1125367)中对[源与汇](@entry_id:263105)进行建模的理论、方法与应用。在第一章“原理与机制”中，我们将深入剖析构建[源与汇](@entry_id:263105)项必须遵守的基本守恒律，并介绍如何为中性束注入、[射频加热](@entry_id:194262)等关键物理过程构建数学模型。随后，在第二章“应用与跨学科联系”中，我们将展示这些模型如何被用于研究全局输运、控制等离子体剖面，并探讨其思想如何延伸至航空航天和材料科学等其他领域。最后，通过第三章“动手实践”中的具体编程练习，读者将直面数值实现中的挑战，如保证正定性和守恒性。通过这三章的学习，读者将掌握在高性能模拟中有效使用[源与汇](@entry_id:263105)的关键技能，从而更好地连接理论模型与实验现实。

## 原理与机制

在全分布函数（full-f）模拟中，[源与汇](@entry_id:263105)项（sources and sinks）扮演着至关重要的角色，它们是维持等离子体远离[热力学平衡](@entry_id:141660)态、使其能够展现出丰富的输运和[湍流](@entry_id:151300)现象的关键。一个孤立的、没有能量和[粒子交换](@entry_id:154910)的等离子体系统，会因碰撞而弛豫到麦克斯韦[平衡态](@entry_id:270364)，此时所有的宏观梯度都将消失，[湍流](@entry_id:151300)也会随之平息。然而，在真实的聚变装置中，等离子体通过外部加热系统持续获得能量，通过加料系统获得粒子，同时又因辐射和输运而损失能量和粒子。源和汇项正是对这些物理过程的数学建模，它们使得在模拟中建立并维持一个准[稳态](@entry_id:139253)（quasi-steady state）成为可能。本章将深入探讨在全分布函数模拟中构建和使用[源与汇](@entry_id:263105)项的基本原理和关键机制。

### 守恒律：构建[源与汇](@entry_id:263105)的基石

在动力学模拟中引入任何源或汇项时，首要的考量是其必须与基本的物理守恒律相一致。一个算符对粒子数、动量和能量的影响，决定了它的物理意义和适用范畴。

#### 内在过程与外源的区分

等离子体动力学方程中的算符可分为两类：描述系统内部相互作用的算符和描述系统与外界交换的算符。朗道-[福克-普朗克](@entry_id:635508)（Landau-[Fokker-Planck](@entry_id:635508)）碰撞算符 $C_s[f]$ 是前者的典型代表。对于[库仑碰撞](@entry_id:186273)，粒子种类不会改变，因此碰撞过程对每个粒子组分而言是保持粒子数守恒的。这意味着在任意空间位置 $\boldsymbol{r}$，碰撞算符的[速度空间](@entry_id:181216)积分为零：

$$
\int C_s[f] \, d^3v = 0
$$

这一性质表明，碰撞仅在[速度空间](@entry_id:181216)中重新分布粒子，使分布函数趋向于局域麦克斯韦分布，但它本身不能在任何空间点创造或湮灭粒子。因此，[碰撞算符](@entry_id:189499)无法平衡由空间输运造成的粒子净损失或增益。要维持一个[稳态](@entry_id:139253)的密度分布，必须引入一个显式的粒子源或汇项 。

然而，对于动量和能量，情况有所不同。在不同组分（例如，离子和电子）之间的碰撞中，动量和能量可以在组分间传递。因此，单个组分的动量和能量并不守恒，即 $\int m_s \boldsymbol{v} C_s[f] \, d^3v \neq \boldsymbol{0}$ 且 $\int \frac{1}{2}m_s v^2 C_s[f] \, d^3v \neq 0$。但是，对于整个孤立的等离子体系统，总动量和总能量是守恒的，即 $\sum_s \int m_s \boldsymbol{v} C_s[f] \, d^3v = \boldsymbol{0}$ 且 $\sum_s \int \frac{1}{2}m_s v^2 C_s[f] \, d^3v = 0$。

与之相对，源项 $S_s$ 和汇项 $L_s$ 代表了与外部世界的相互作用，例如[中性束注入](@entry_id:204293)（NBI）、射频波（RF）加热或辐射损失。这些过程可以向等离子体系统注入或从中移出净粒子数、动量和能量。因此，它们的矩通常不为零，这正是它们维持等离子体宏观剖面的功能所在 。

#### 电荷守恒与[麦克斯韦方程组](@entry_id:150940)的相容性

在包含电磁场演化的全函数模拟中，一个更为严格的约束是[电荷守恒](@entry_id:264158)。这个约束源于动力学描述与麦克斯韦方程组的[自洽性](@entry_id:160889)要求。

从动力学方程出发，对其乘以电荷 $q_s$，在速度空间积分并对所有组分求和，可以得到[电荷密度](@entry_id:144672)的演化方程：

$$
\frac{\partial \rho}{\partial t} + \nabla \cdot \mathbf{J} = \sum_s q_s \int S_s \, d^3v
$$

这里，$\rho = \sum_s q_s \int f_s \, d^3v$ 是电荷密度，$\mathbf{J} = \sum_s q_s \int \mathbf{v} f_s \, d^3v$ 是电流密度。等式右边代表由源项注入的净电荷率。

另一方面，[麦克斯韦方程组](@entry_id:150940)自身内蕴了[电荷守恒](@entry_id:264158)定律。对[安培-麦克斯韦定律](@entry_id:266368) $\nabla \times \mathbf{B} = \mu_0 (\mathbf{J} + \varepsilon_0 \frac{\partial \mathbf{E}}{\partial t})$ 两边取散度，并利用 $\nabla \cdot (\nabla \times \mathbf{B}) = 0$ 和高斯定律 $\nabla \cdot \mathbf{E} = \rho / \varepsilon_0$，可直接导出[电荷连续性](@entry_id:747292)方程：

$$
\frac{\partial \rho}{\partial t} + \nabla \cdot \mathbf{J} = 0
$$

为了使这两个方程相容，源项的电荷加权零阶矩必须为零 ：

$$
\sum_s q_s \int S_s(\mathbf{x}, \mathbf{v}, t) \, d^3v = 0
$$

这个条件意味着任何引入的源项必须是局域[电中性](@entry_id:138647)的。例如，如果一个源项模拟了中性原子的电离，它必须同时产生一个电子和一个离子，以保证没有净电荷的产生。值得注意的是，这个约束并未对动量矩 $\sum_s q_s \int \mathbf{v} S_s \, d^3v$ 施加限制。因此，一个[电中性](@entry_id:138647)的源完全可以注入净动量或电流，这是中性束[电流驱动](@entry_id:186346)（NBCD）等物理机制的基础  。源项[对等离子体](@entry_id:1129298)的影响是通过改变分布函数 $f_s$ 来间接改变电流密度 $\mathbf{J}$，而不是在安培定律中添加一个显式的源电流项。

### 典型[源与汇](@entry_id:263105)的建模

基于上述守恒律的指导原则，我们可以构建多种多样的[源与汇](@entry_id:263105)模型来描述特定的物理过程。

#### 粒子源：中性原子电离

在[聚变等离子体](@entry_id:1125407)中，一个主要的粒子来源是来自装置壁或通过[气体喷射](@entry_id:273270)引入的中性原子的电离。一个物理上合理的[电离源](@entry_id:750818)模型可以写成如下形式 ：

$$
S_s(\mathbf{x}, \mathbf{v}) = n_n(\mathbf{x}) \nu_{\mathrm{ion}}(\mathbf{x}) M(\mathbf{v}; T_n(\mathbf{x}), \mathbf{U}_n(\mathbf{x}))
$$

其中，$n_n(\mathbf{x})$ 是中性原子密度，$\nu_{\mathrm{ion}}(\mathbf{x})$ 是有效电离频率。对于[电子碰撞电离](@entry_id:164299)，$\nu_{\mathrm{ion}} = n_e \langle \sigma v \rangle_{e,n}(T_e)$，它依赖于电子密度 $n_e$ 和电子温度 $T_e$。$M(\mathbf{v})$ 是归一化的新生[离子速度分布函数](@entry_id:195956)，通常假设为具有中性原子温度 $T_n$ 和[漂移速度](@entry_id:262489) $\mathbf{U}_n$ 的麦克斯韦分布。

这个源项的各阶[速度矩](@entry_id:1133763)对应着它所注入的粒子、动量和能量。对 $S_s$ 在速度空间积分，可以得到：
- **粒子源率密度**: $\Gamma_s(\mathbf{x}) = \int S_s \, d^3v = n_n \nu_{\mathrm{ion}}$
- **动量源率密度**: $\mathbf{P}_s(\mathbf{x}) = m_s \int \mathbf{v} S_s \, d^3v = m_s \Gamma_s \mathbf{U}_n$
- **能量源率密度**: $Q_s(\mathbf{x}) = \frac{m_s}{2} \int |\mathbf{v}|^2 S_s \, d^3v = \Gamma_s \left( \frac{3}{2} T_n + \frac{1}{2} m_s |\mathbf{U}_n|^2 \right)$

这些矩明确地量化了源项对宏观[平衡方程](@entry_id:172166)的贡献 。

#### 能量源：[射频波加热](@entry_id:1131005)

射频（RF）波加热是通过波-粒相互作用将能量传递给等离子体粒子。在准线性理论框架下，这种相互作用可以被建模为一个速度空间中的[扩散过程](@entry_id:268015)。相应的源算符（通常只作用于被加热的粒子组分）具有以下形式 ：

$$
\left.\frac{\partial f_s}{\partial t}\right|_{\text{RF}} = \nabla_{\mathbf{v}} \cdot \left( \mathbf{D}_{\text{RF}}(\mathbf{x}, \mathbf{v}) \cdot \nabla_{\mathbf{v}} f_s \right)
$$

其中 $\mathbf{D}_{\text{RF}}$ 是[准线性扩散](@entry_id:753965)张量，其大小和方向性由波的性质和[共振条件](@entry_id:754285)决定。这个算符的数学结构有几个关键特性：
1.  **粒子数守恒**：由于整个算符是[速度空间](@entry_id:181216)中一个通量 $\mathbf{J}_{\mathbf{v}} = \mathbf{D}_{\text{RF}} \cdot \nabla_{\mathbf{v}} f_s$ 的散度，其在整个[速度空间](@entry_id:181216)的积分，通过[高斯定理](@entry_id:143110)，等于边界上的通量。假设在无穷大速度处分布函数衰减足够快，这个积分为零。因此，该算符自动满足粒子数守恒的要求，这与RF加热不产生或消灭粒子的物理事实相符。
2.  **能量注入**：该算符的能量矩通常不为零。通过分部积分可以得到能量注入率密度为：
    $$
    \left.\frac{\partial W_s}{\partial t}\right|_{\text{RF}} = \int \frac{m_s v^2}{2} \left.\frac{\partial f_s}{\partial t}\right|_{\text{RF}} \, d^3v = - \int m_s \mathbf{v} \cdot \mathbf{D}_{\text{RF}} \cdot \nabla_{\mathbf{v}} f_s \, d^3v
    $$
    通过精心设计 $\mathbf{D}_{\text{RF}}$，可以使其在[速度空间](@entry_id:181216)中将粒子推向高能区，从而实现净能量注入。
3.  **动量注入**：同样，动量矩 $\int m_s \mathbf{v} (\nabla_{\mathbf{v}} \cdot (\mathbf{D}_{\text{RF}} \cdot \nabla_{\mathbf{v}} f_s)) \, d^3v$ 通常也不为零。如果 $\mathbf{D}_{\text{RF}}$ 在[速度空间](@entry_id:181216)中是不对称的（例如，对于同向和反向运动的粒子具有不同的值），它就可以产生一个[净力](@entry_id:163825)，从而驱动电流。

#### 能量汇：[韧致辐射](@entry_id:270512)

[韧致辐射](@entry_id:270512)是电子在离子电场中偏转时发出的辐射，这是等离子体的一种重要能量损失机制。在模拟中，我们需要一个汇算符 $S_{\text{br}}$ 来描述这个过程。这个过程的关键物理特性是：电子损失了能量，但电子本身没有被湮灭。因此，算符必须满足能量汇的要求，同时严格保持粒子数守恒 。

一个简单的粒子移除算符，如 $S_{\text{br}} \propto -f_e$，会错误地减少粒子数。一个满足要求的算符形式是修正的Krook算符：

$$
S_{\text{br}}[f_e] = - \nu_{\text{br}} \left( \frac{E}{T_e} - \frac{3}{2} \right) f_e
$$

其中 $E = m_e v^2/2$ 是电子动能，$\nu_{\text{br}}$ 是一个根据[总辐射功率](@entry_id:756065) $P_{\text{br}}$ 确定的有效碰撞率。我们可以验证这个算符的性质：
- **粒子数守恒**: 它的零阶矩为 $\int S_{\text{br}} \, d^3v = -\nu_{\text{br}} (\frac{1}{T_e}\int E f_e d^3v - \frac{3}{2}\int f_e d^3v) = -\nu_{\text{br}} (\frac{1}{T_e}(\frac{3}{2}n_e T_e) - \frac{3}{2}n_e) = 0$。
- **能量损失**: 它的能量矩可以被构造成精确等于所需的能量损失率 $-P_{\text{br}}$，通过适当地选择 $\nu_{\text{br}}$。具体来说，$\nu_{\text{br}} = P_{\text{br}} / (\frac{3}{2} n_e T_e)$。

这个例子展示了如何通过“算符工程”（operator engineering）来构建满足特定物理约束的复杂汇项。

### 源、汇与宏观平衡方程

动力学源项 $S_s$ 通过其[速度矩](@entry_id:1133763)直接影响宏观的[流体平衡](@entry_id:187794)方程。对动力学方程取$1$, $\boldsymbol{v}$, $v^2$的矩，可以分别得到粒子、动量和能量的[平衡方程](@entry_id:172166)  。例如，[能量平衡方程](@entry_id:191484)的一般形式为：

$$
\frac{\partial W_s}{\partial t} + \nabla \cdot \boldsymbol{Q}_{W_s} = \mathbf{J}_s \cdot \mathbf{E} + \mathcal{E}_{coll} + \mathcal{E}_{ext} + \mathcal{E}_{rad}
$$

其中 $\frac{\partial W_s}{\partial t}$ 是能量密度的变化率，$\nabla \cdot \boldsymbol{Q}_{W_s}$ 是[能量通量](@entry_id:266056)的散度（代表输运损失），右边的项则代表了各种能量源和汇：$\mathbf{J}_s \cdot \mathbf{E}$ 是电场做功（焦耳加热），$\mathcal{E}_{coll}$ 是[碰撞能量](@entry_id:183483)交换，而 $\mathcal{E}_{ext} = \int \frac{1}{2}m_s v^2 Q_s^{ext} d^3v$ 和 $\mathcal{E}_{rad} = \int \frac{1}{2}m_s v^2 R_s^{rad} d^3v$ 分别是来自外部加热源和辐射汇的能量注入/损失率。

在全局尺度上，这些平衡关系决定了系统的宏观行为。例如，整个等离子体的总能量 $W(t)$ 的演化遵循全局功率平衡 ：

$$
\frac{dW}{dt} = P_{\text{input}} - P_{\text{transport}} - P_{\text{radiation}}
$$

其中 $P_{\text{input}}$ 是所有加热源的总功率（例如，由 $S_s$ 的能量矩在全空间积分得到），$P_{\text{transport}}$ 是通过边界的净能量输运损失，而 $P_{\text{radiation}}$ 是总[辐射损失](@entry_id:1130499)。这个方程在分析模拟结果和与实验数据对比时至关重要。例如，如果在模拟中测得了 $dW/dt$、输运损失和[辐射损失](@entry_id:1130499)，就可以反推出所需的加热功率幅值 $A$ 。

同样，在[稳态](@entry_id:139253)下，[动量平衡](@entry_id:1128118)方程要求外部动量注入必须被[动量输运](@entry_id:139628)（由有效[粘滞](@entry_id:201265) $\eta_0$ 描述）和[摩擦阻尼](@entry_id:189251)（由阻尼率 $\nu_0$ 描述）所平衡。例如，对于环向动量，这可以导出一个关于环向流速剖面 $u_\varphi(x)$ 的[常微分方程](@entry_id:147024)。求解这个方程可以得到自洽的旋转剖面，它正是由动量源、汇和输运三者之间的平衡所决定的 。

### 源项的策略性使用：通量驱动与剖面驱动

除了模拟特定的物理过程，源项在全函数模拟中还扮演着一个重要的策略性角色：即如何驱动系统以维持准[稳态](@entry_id:139253)。两种主流的策略是“通量驱动”（flux-driven）和“剖面驱动”（profile-driven） 。

- **剖面驱动** 策略通过引入一个动力学源项来将宏观剖面（如温度或密度）“钳制”在预设的目标剖面 $X_\star(r)$ 附近。这种源项通常具有弛豫形式，例如 $\langle S_X \rangle(r,t) = \omega_X(r) [X_\star(r) - X(r,t)]$。这里，如果[湍流](@entry_id:151300)输运试图使剖面偏离目标，源项就会提供一个强烈的正或负反馈，将其拉回到目标值。这种方法的优点是稳定且易于控制，但其代价是人为地干预了[湍流](@entry_id:151300)与背景剖面之间的自然反馈循环。通过固定梯度，它压制了[湍流](@entry_id:151300)的“捕食者-猎物”动力学，从而可能抑制如[输运垒](@entry_id:756132)和雪崩等自组织现象。

- **通量驱动** 策略则旨在模拟一个更真实的实验场景，其中系统被注入一个固定的通量（或功率）。这通常通过在模拟区域的特定位置（如芯部）施加一个固定的源项来实现，例如一个空间分布固定的加热源。在这种设置下，剖面和梯度不是被固定的，而是作为系统对该输入通量的自洽响应而演化。系统必须自己“决定”需要多强的[湍流](@entry_id:151300)才能将注入的能量或[粒子输运](@entry_id:1129401)出去。这种方法保留了梯度与[湍流](@entry_id:151300)之间的完整反馈回路，因此能够更真实地捕捉到[湍流](@entry_id:151300)的自组织行为，是研究输运尺度动力学的首选方法。

这两种策略的选择，反映了全函数模拟从早期的局域 `delta-f` 模型（其本质上是剖面驱动的，因为它假定了一个固定的背景梯度）向更完整的全局输运模拟的演进。正是因为[湍流](@entry_id:151300)输运会反过来改变背景剖面，而这种相互作用对全局能量和[粒子平衡](@entry_id:753197)至关重要，所以需要采用 `full-f` 模型和通量驱动的方法来进行输运时间尺度的预测性模拟 。

总之，[源与汇](@entry_id:263105)项不仅是全函数模拟中代表具体物理过程的必要组成部分，也是控制模拟、维持非[平衡态](@entry_id:270364)以及探索[等离子体自组织](@entry_id:1129807)行为的关键工具。对它们的深刻理解和恰当使用，是进行高保真度[聚变等离子体模拟](@entry_id:1125410)的基石。