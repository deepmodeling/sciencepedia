{
    "hands_on_practices": [
        {
            "introduction": "在数值模拟中，我们选择的算法可能会引入原始物理方程中不存在的效应。本练习  通过分析一种常见的平流格式来探讨这一现象。通过使用修正方程分析，你将揭示一阶迎风格式中固有的“隐藏”数值耗散，这项技能对于区分我们有意添加的物理耗散和算法带来的意外数值耗散至关重要。",
            "id": "4191613",
            "problem": "在聚变等离子体湍流的磁通管模型中，沿副法线坐标的一维平流通常为了稳定性而采用迎风差分进行离散化，这会引入数值耗散。考虑线性平流偏微分方程 $\\,\\partial_{t} u + c\\,\\partial_{x} u = 0\\,$，其中平流速度 $\\,c>0\\,$ 为常数，该方程在空间步长为 $\\,\\Delta x\\,$、时间步长为 $\\,\\Delta t\\,$ 的均匀网格上进行离散化。对于 $\\,c>0\\,$ 的情况，一阶迎风格式由以下更新公式定义：\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\lambda \\left( u_{j}^{n} - u_{j-1}^{n} \\right),\n$$\n其中 Courant–Friedrichs–Lewy (CFL) 数 $\\,\\lambda\\,$ 为 $\\,\\lambda = c\\,\\Delta t / \\Delta x\\,$。以控制方程 $\\,\\partial_{t} u + c\\,\\partial_{x} u = 0\\,$ 为基础，通过将格式在 $\\,\\Delta x\\,$ 和 $\\,\\Delta t\\,$ 上一致地展开到二阶泰勒级数，并利用基本方程消去高阶时间导数，来进行修正方程分析。推导出形式为\n$$\n\\partial_{t} u + c\\,\\partial_{x} u \\;=\\; \\nu_{\\mathrm{num}}\\,\\partial_{x}^{2} u \\;+\\; \\text{更高阶项}\n$$\n的相应连续修正方程，并提取领头阶有效数值黏性系数 $\\,\\nu_{\\mathrm{num}}\\,$，表示为 $\\,c\\,$、$\\,\\Delta x\\,$ 和 $\\,\\lambda\\,$ 的闭式解析表达式。请给出 $\\,\\nu_{\\mathrm{num}}\\,$ 的最终表达式。无需进行数值计算；给出精确的符号表达式。最终答案必须是答案框内不含单位的单个解析表达式。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，是适定且客观的，呈现了偏微分方程数值分析领域的一个标准问题。唯一推导所需的所有信息均已提供。\n\n任务是推导应用于线性平流方程的一阶迎风格式的领头阶有效数值黏性系数 $\\nu_{\\mathrm{num}}$。分析将通过将离散格式的各项展开成泰勒级数来进行，以获得该格式实际求解的修正偏微分方程。\n\n控制偏微分方程 (PDE) 是线性平流方程：\n$$\n\\partial_{t} u + c\\,\\partial_{x} u = 0\n$$\n其中 $u$ 是时间 $t$ 和空间 $x$ 的函数，而 $c > 0$ 是一个恒定的平流速度。\n\n一阶迎风有限差分格式由下式给出：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\lambda \\left( u_{j}^{n} - u_{j-1}^{n} \\right)\n$$\n其中 $u_{j}^{n}$ 表示在空间网格点 $x_j = j\\,\\Delta x$ 和时间 $t_n = n\\,\\Delta t$ 处的数值解。Courant–Friedrichs–Lewy (CFL) 数为 $\\lambda = c\\,\\Delta t / \\Delta x$。\n\n为进行修正方程分析，我们将格式中的每一项在点 $(x_j, t_n)$ 附近展开为泰勒级数。令不带下标或上标的 $u$ 表示 $u(x_j, t_n)$。\n\n项 $u_{j}^{n+1}$ 是关于时间的展开：\n$$\nu_{j}^{n+1} = u(x_j, t_n + \\Delta t) = u + \\Delta t\\,\\partial_{t} u + \\frac{(\\Delta t)^{2}}{2}\\,\\partial_{t}^{2} u + \\frac{(\\Delta t)^{3}}{6}\\,\\partial_{t}^{3} u + O((\\Delta t)^{4})\n$$\n\n项 $u_{j-1}^{n}$ 是关于空间的展开：\n$$\nu_{j-1}^{n} = u(x_j - \\Delta x, t_n) = u - \\Delta x\\,\\partial_{x} u + \\frac{(\\Delta x)^{2}}{2}\\,\\partial_{x}^{2} u - \\frac{(\\Delta x)^{3}}{6}\\,\\partial_{x}^{3} u + O((\\Delta x)^{4})\n$$\n\n现在，我们将这些展开式代入数值格式中：\n$$\n\\left( u + \\Delta t\\,\\partial_{t} u + \\frac{(\\Delta t)^{2}}{2}\\,\\partial_{t}^{2} u + \\dots \\right) = u - \\lambda \\left( u - \\left( u - \\Delta x\\,\\partial_{x} u + \\frac{(\\Delta x)^{2}}{2}\\,\\partial_{x}^{2} u - \\dots \\right) \\right)\n$$\n首先简化右侧：\n$$\nu - \\lambda \\left( \\Delta x\\,\\partial_{x} u - \\frac{(\\Delta x)^{2}}{2}\\,\\partial_{x}^{2} u + \\dots \\right) = u - \\lambda\\,\\Delta x\\,\\partial_{x} u + \\frac{\\lambda\\,(\\Delta x)^{2}}{2}\\,\\partial_{x}^{2} u - \\dots\n$$\n将 CFL 数的定义 $\\lambda = c\\,\\Delta t / \\Delta x$ 代入简化的右侧：\n$$\nu - \\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)\\,\\Delta x\\,\\partial_{x} u + \\frac{1}{2}\\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)\\,(\\Delta x)^{2}\\,\\partial_{x}^{2} u - \\dots = u - c\\,\\Delta t\\,\\partial_{x} u + \\frac{c\\,\\Delta t\\,\\Delta x}{2}\\,\\partial_{x}^{2} u - \\dots\n$$\n现在，令展开后的左侧和右侧相等：\n$$\nu + \\Delta t\\,\\partial_{t} u + \\frac{(\\Delta t)^{2}}{2}\\,\\partial_{t}^{2} u + \\dots = u - c\\,\\Delta t\\,\\partial_{x} u + \\frac{c\\,\\Delta t\\,\\Delta x}{2}\\,\\partial_{x}^{2} u - \\dots\n$$\n我们从两侧消去项 $u$，然后将整个方程除以 $\\Delta t$：\n$$\n\\partial_{t} u + \\frac{\\Delta t}{2}\\,\\partial_{t}^{2} u + \\dots = -c\\,\\partial_{x} u + \\frac{c\\,\\Delta x}{2}\\,\\partial_{x}^{2} u - \\dots\n$$\n重新整理此方程以匹配原始 PDE 加上高阶项的形式，得到截断误差：\n$$\n\\partial_{t} u + c\\,\\partial_{x} u = \\frac{c\\,\\Delta x}{2}\\,\\partial_{x}^{2} u - \\frac{\\Delta t}{2}\\,\\partial_{t}^{2} u + O(\\Delta x^2, \\Delta t^2)\n$$\n该方程描述了离散格式实际求解的连续 PDE，精确到领头阶。为了获得所要求形式的修正方程，我们必须用空间导数来表示高阶时间导数。这可以通过重复使用方程本身来完成。\n\n从方程的领头阶部分，我们得到原始 PDE：\n$$\n\\partial_{t} u = -c\\,\\partial_{x} u + O(\\Delta x, \\Delta t)\n$$\n对 $t$ 求导：\n$$\n\\partial_{t}^{2} u = \\partial_{t}(-c\\,\\partial_{x} u + \\dots) = -c\\,\\partial_{t}(\\partial_{x} u) + \\dots = -c\\,\\partial_{x}(\\partial_{t} u) + \\dots\n$$\n现在将 $\\partial_{t} u = -c\\,\\partial_{x} u$ 代回到 $\\partial_{t}^{2} u$ 的表达式中：\n$$\n\\partial_{t}^{2} u = -c\\,\\partial_{x}(-c\\,\\partial_{x} u) + \\dots = c^{2}\\,\\partial_{x}^{2} u + O(\\Delta x, \\Delta t)\n$$\n我们现在将这个 $\\partial_{t}^{2} u$ 的表达式代回到我们的截断方程中：\n$$\n\\partial_{t} u + c\\,\\partial_{x} u = \\frac{c\\,\\Delta x}{2}\\,\\partial_{x}^{2} u - \\frac{\\Delta t}{2}\\left(c^{2}\\,\\partial_{x}^{2} u\\right) + \\text{更高阶项}\n$$\n右侧包含领头阶误差项，该项是空间导数的二阶项，并具有扩散或黏性项的形式。我们现在可以合并 $\\partial_{x}^{2} u$ 的系数：\n$$\n\\partial_{t} u + c\\,\\partial_{x} u = \\left( \\frac{c\\,\\Delta x}{2} - \\frac{c^2\\,\\Delta t}{2} \\right)\\,\\partial_{x}^{2} u + \\text{H.O.T.}\n$$\n通过将其与目标形式 $\\partial_{t} u + c\\,\\partial_{x} u = \\nu_{\\mathrm{num}}\\,\\partial_{x}^{2} u + \\text{H.O.T.}$ 进行比较，我们可以确定有效数值黏性系数 $\\nu_{\\mathrm{num}}$：\n$$\n\\nu_{\\mathrm{num}} = \\frac{c\\,\\Delta x}{2} - \\frac{c^2\\,\\Delta t}{2}\n$$\n最后一步是按要求将此系数表示为 $c$、$\\Delta x$ 和 $\\lambda$ 的函数。我们使用恒等式 $c\\,\\Delta t = \\lambda\\,\\Delta x$：\n$$\n\\nu_{\\mathrm{num}} = \\frac{c\\,\\Delta x}{2} - \\frac{c}{2}(c\\,\\Delta t) = \\frac{c\\,\\Delta x}{2} - \\frac{c}{2}(\\lambda\\,\\Delta x)\n$$\n提取公因式可得到数值黏性的最终表达式：\n$$\n\\nu_{\\mathrm{num}} = \\frac{c\\,\\Delta x}{2} (1 - \\lambda)\n$$\n该表达式表明，一阶迎风格式的领头阶误差是一个耗散项，它与网格尺寸 $\\Delta x$ 以及一个取决于 CFL 数的因子 $(1-\\lambda)$ 成正比。在使用该格式时观察到的数值耗散就是由该项引起的。",
            "answer": "$$\n\\boxed{\\frac{c\\,\\Delta x}{2}(1 - \\lambda)}\n$$"
        },
        {
            "introduction": "在理解了数值耗散之后，我们通常更倾向于使用超粘性来显式地、可控地添加耗散，特别是为了抑制小尺度上的噪音。然而，当使用显式时间推进方法时，这会引入一个严格的稳定性约束。本练习  将指导你完成一个基本的稳定性分析，以确定使用显式超粘性的模拟所允许的最大时间步长，掌握这种计算是建立稳定高效的湍流模拟的关键一步。",
            "id": "4191634",
            "problem": "一个一维板模型中的电阻漂移波湍流，其垂直超粘性耗散项使用显式前向欧拉更新方法进行时间推进。在傅里叶空间中，对于每个波数 $k$， $n$ 阶超粘性算子的特征值为 $\\lambda_k = -\\nu_n k^{2n}$，其中 $\\nu_n$ 是超粘性系数。假设所有非超粘性算子的处理方式不会对时间步长产生额外的限制，因此，显式时间步长的约束完全由超粘性决定。\n\n给定条件：\n- 超粘性阶数 $n = 2$（双拉普拉斯算子），因此 $\\lambda_k = -\\nu_2 k^{4}$。\n- 超粘性系数 $\\nu_2 = 2.0 \\times 10^{-11}$ $\\mathrm{m}^4/\\mathrm{s}$。\n- 均匀网格，间距为 $\\Delta x = \\pi/5000$ $\\mathrm{m}$，其最高可分辨波数可由奈奎斯特波数 $k_{\\max} = \\pi/\\Delta x$ 近似。\n\n从线性微分算子的傅里叶表示和线性标量模式显式时间步进的稳定性要求等第一性原理出发，推导由超粘性决定的最大稳定显式时间步长 $\\Delta t_{\\max}$。然后使用上述参数对 $\\Delta t_{\\max}$ 进行数值计算。以微秒为单位表示最终的时间步长，并将答案四舍五入到四位有效数字。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n-   物理系统是一维板模型中的电阻漂移波湍流。\n-   超粘性耗散项的时间步进格式是显式前向欧拉更新。\n-   $n$阶超粘性算子的特征值为 $\\lambda_k = -\\nu_n k^{2n}$，对应于每个波数 $k$。\n-   超粘性系数为 $\\nu_n$。\n-   时间步长约束完全由超粘性项决定。\n-   超粘性阶数：$n = 2$（双拉普拉斯算子）。\n-   $n=2$ 时的特征值表达式：$\\lambda_k = -\\nu_2 k^{4}$。\n-   超粘性系数值：$\\nu_2 = 2.0 \\times 10^{-11}$ $\\mathrm{m}^4/\\mathrm{s}$。\n-   网格配置：均匀网格，间距 $\\Delta x = \\pi/5000$ $\\mathrm{m}$。\n-   最高可分辨波数：$k_{\\max} = \\pi/\\Delta x$。\n-   目标：推导最大稳定显式时间步长 $\\Delta t_{\\max}$，并以微秒为单位进行数值计算，结果保留四位有效数字。\n\n**步骤2：使用提取的条件进行验证**\n-   **科学依据**：该问题在计算物理和数值分析领域有充分的依据。使用超粘性（特别是 $n=2$ 时的双拉普拉斯算子）是湍流模拟中的一种标准技术，用于在网格尺度上提供尺度选择性耗散。前向欧拉法是一种基本的显式时间步进格式。将此格式应用于线性耗散算子的稳定性分析是一个经典的、被充分理解的问题。特征值的形式 $\\lambda_k = -\\nu_n k^{2n}$ 是算子 $(-1)^{n+1}\\nu_n \\nabla^{2n}$ 的正确傅里叶表示。该问题在科学上和数学上都是合理的。\n-   **适定性**：问题定义清晰，提供了计算所需量 $\\Delta t_{\\max}$ 所需的所有必要参数（$\\nu_2$、$\\Delta x$、 $n$）和定义（$k_{\\max}$）。逻辑自洽，并能导出一个唯一解。\n-   **客观性**：语言精确且定量，没有主观或模糊的术语。\n\n**步骤3：结论与行动**\n该问题有效。这是一个标准的数值稳定性分析练习，科学上合理、适定且客观。将提供解答。\n\n### 解答推导\n\n在超粘性算子作用下，单个傅里叶模式振幅 $\\hat{\\phi}_k(t)$ 的演化由以下线性常微分方程（ODE）描述：\n$$\n\\frac{d\\hat{\\phi}_k}{dt} = \\lambda_k \\hat{\\phi}_k\n$$\n其中 $\\lambda_k$ 是对应于波数 $k$ 的特征值。对于给定的 $n=2$ 阶超粘性项，特征值为：\n$$\n\\lambda_k = -\\nu_2 k^4\n$$\n\n问题陈述此常微分方程使用显式前向欧拉格式进行时间离散化。设 $\\hat{\\phi}_k^j$ 表示在时间步 $j$ 的傅里叶振幅值。前向欧拉更新由下式给出：\n$$\n\\frac{\\hat{\\phi}_k^{j+1} - \\hat{\\phi}_k^j}{\\Delta t} = \\lambda_k \\hat{\\phi}_k^j\n$$\n其中 $\\Delta t$ 是时间步长。重新整理此方程可得到 $\\hat{\\phi}_k$ 的更新规则：\n$$\n\\hat{\\phi}_k^{j+1} = \\hat{\\phi}_k^j + \\Delta t (\\lambda_k \\hat{\\phi}_k^j) = (1 + \\lambda_k \\Delta t) \\hat{\\phi}_k^j\n$$\n项 $G_k = 1 + \\lambda_k \\Delta t$ 是模式 $k$ 的放大因子。为使数值格式稳定，任何模式的放大因子的大小都不能超过1。这可以防止数值解的任何分量无界增长。因此，稳定性条件是：\n$$\n|G_k| \\le 1 \\quad \\forall k\n$$\n代入 $G_k$ 的表达式，我们得到：\n$$\n|1 + \\lambda_k \\Delta t| \\le 1\n$$\n特征值 $\\lambda_k = -\\nu_2 k^4$ 是一个实非正数，因为超粘性系数 $\\nu_2 = 2.0 \\times 10^{-11} \\, \\mathrm{m}^4/\\mathrm{s}$ 是正数。在前向欧拉格式中，对于一个实非正特征值 $\\lambda$ 的稳定性条件是一个众所周知的结果。我们可以通过考虑不等式 $|1 + \\lambda \\Delta t| \\le 1$ 来推导它。由于 $\\lambda \\Delta t \\le 0$，我们有：\n$$\n-1 \\le 1 + \\lambda_k \\Delta t \\le 1\n$$\n不等式的右侧，$1 + \\lambda_k \\Delta t \\le 1$，简化为 $\\lambda_k \\Delta t \\le 0$。鉴于 $\\lambda_k \\le 0$ 和 $\\Delta t \\ge 0$，此条件始终满足。不等式的左侧提供了非平凡的约束：\n$$\n-1 \\le 1 + \\lambda_k \\Delta t\n$$\n$$\n-2 \\le \\lambda_k \\Delta t\n$$\n$$\n\\Delta t \\le \\frac{-2}{\\lambda_k} = \\frac{2}{-\\lambda_k} = \\frac{2}{|\\lambda_k|}\n$$\n代入 $\\lambda_k$ 的表达式：\n$$\n\\Delta t \\le \\frac{2}{\\nu_2 k^4}\n$$\n这个条件必须对数值网格上解析的所有波数 $k$ 都成立。为确保全局稳定性，必须选择时间步长 $\\Delta t$ 以满足最严格的情况。当分母 $\\nu_2 k^4$ 最大化时，不等式的右侧最小化。这种情况发生在最高可表示波数 $k_{\\max}$ 处。因此，最大稳定时间步长 $\\Delta t_{\\max}$ 是：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\nu_2 k_{\\max}^4}\n$$\n问题给出了网格间距 $\\Delta x = \\pi/5000 \\, \\mathrm{m}$，并将最大波数定义为奈奎斯特波数 $k_{\\max} = \\pi/\\Delta x$。\n$$\nk_{\\max} = \\frac{\\pi}{\\pi/5000 \\, \\mathrm{m}} = 5000 \\, \\mathrm{m}^{-1}\n$$\n现在我们可以将 $\\nu_2$ 和 $k_{\\max}$ 的数值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\nu_2 = 2.0 \\times 10^{-11} \\, \\frac{\\mathrm{m}^4}{\\mathrm{s}}\n$$\n$$\nk_{\\max} = 5 \\times 10^3 \\, \\mathrm{m}^{-1}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{(2.0 \\times 10^{-11} \\, \\frac{\\mathrm{m}^4}{\\mathrm{s}}) (5 \\times 10^3 \\, \\mathrm{m}^{-1})^4}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{(2.0 \\times 10^{-11}) (5^4 \\times (10^3)^4)} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{(2.0 \\times 10^{-11}) (625 \\times 10^{12})} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{2.0 \\times 625 \\times 10^{(-11+12)}} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{1250 \\times 10^1} \\, \\mathrm{s} = \\frac{2}{12500} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{6250} \\, \\mathrm{s} = 0.00016 \\, \\mathrm{s}\n$$\n问题要求答案以微秒（$\\mu\\mathrm{s}$）表示。\n$$\n1 \\, \\mathrm{s} = 10^6 \\, \\mu\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = 0.00016 \\times 10^6 \\, \\mu\\mathrm{s} = 160 \\, \\mu\\mathrm{s}\n$$\n最后，我们必须将答案四舍五入到四位有效数字。值 $160$ 可以写成 $160.0$ 以明确表示四位有效数字。\n$$\n\\Delta t_{\\max} = 160.0 \\, \\mu\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{160.0}\n$$"
        },
        {
            "introduction": "确保模拟稳定（即数值解不发散）仅仅是第一步；我们还必须确保解在物理上是有意义的。高阶数值格式，如用于超扩散的格式，有时会产生非物理的振荡，例如使像密度这样的正定物理量出现负值。本练习  深入探讨了数值格式为保持正定性并满足离散极值原理所需的条件，通过分析离散格式，你将了解这些振荡的产生机理以及如何选择数值参数来避免它们，从而确保模拟的物理保真度。",
            "id": "4191598",
            "problem": "考虑聚变等离子体湍流模拟中的一个一维周期性切片，其中一个无源标量场 $u(x,t)$ 用于模拟受到超扩散数值稳定化影响的线平均密度涨落。用于超扩散稳定化的控制连续方程为\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; - \\nu_{h} \\,\\frac{\\partial^{4} u}{\\partial x^{4}},\n$$\n其中 $\\nu_{h} > 0$ 是超扩散系数。该方程在均匀网格 $x_{i} = i\\,\\Delta x$ 上进行离散化，时间上采用时间步长为 $\\Delta t$ 的前向欧拉法，空间上对四阶导数使用标准的五点中心差分近似。将网格索引为 $i$、时间层为 $n$ 处的离散解记为 $u_{i}^{n}$，则更新方程为\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; r \\left( u_{i-2}^{n} - 4\\,u_{i-1}^{n} + 6\\,u_{i}^{n} - 4\\,u_{i+1}^{n} + u_{i+2}^{n} \\right),\n$$\n其中 $r \\equiv \\nu_{h}\\,\\Delta t / \\Delta x^{4}$ 是无量纲超扩散时间步长。假设采用周期性边界条件，并且离散场可以展开为傅里叶模，其波数为 $k$，网格角为 $\\theta = k\\,\\Delta x$。\n\n从第一性原理和线性常系数离散算子的标准性质出发，完成以下任务：\n\n1. 对于任意非零的 $r$，评估该更新方程是否可以写成 $u_{i}^{n}$ 及其相邻点的凸组合。解释这对标量的离散极值原理以及出现过冲或下冲的可能性的影响。\n\n2. 使用离散傅里叶分析，推导单模放大因子 $G(\\theta)$，使得傅里叶分量 $u^{n}_{i} \\propto \\exp(\\mathrm{i}\\,i\\,\\theta)$ 按 $u^{n+1}_{i} = G(\\theta)\\,u^{n}_{i}$ 进行更新。确定精确的最大值 $r_{\\max}$，使得对于所有 $\\theta \\in [0,\\pi]$ 都有 $G(\\theta) \\geq 0$，从而避免跨时间步的符号反转，已知这种反转会引发离散解中的过冲和下冲。\n\n以有理数形式给出 $r_{\\max}$ 的精确值。由于 $r$ 是无量纲的，因此不需要单位。也不需要进行四舍五入。",
            "solution": "用户请求解答一个关于等离子体湍流模拟中使用的超扩散格式的数值性质的问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   控制连续方程：$\\frac{\\partial u}{\\partial t} = - \\nu_{h} \\frac{\\partial^{4} u}{\\partial x^{4}}$\n-   超扩散系数：$\\nu_{h} > 0$\n-   离散化网格：均匀网格，$x_{i} = i\\,\\Delta x$\n-   离散解变量：$u_{i}^{n}$\n-   时间离散化：前向欧拉法，时间步长 $\\Delta t$\n-   空间离散化：对四阶导数采用标准的五点中心差分\n-   离散更新方程：$u_{i}^{n+1} = u_{i}^{n} - r \\left( u_{i-2}^{n} - 4\\,u_{i-1}^{n} + 6\\,u_{i}^{n} - 4\\,u_{i+1}^{n} + u_{i+2}^{n} \\right)$\n-   无量纲超扩散时间步长：$r \\equiv \\nu_{h}\\,\\Delta t / \\Delta x^{4}$\n-   边界条件：周期性\n-   傅里叶模表示：$u^{n}_{i} \\propto \\exp(\\mathrm{i}\\,i\\,\\theta)$，其中 $\\theta = k\\,\\Delta x$ 是网格角。\n\n**步骤2：使用提取的已知条件进行验证**\n\n1.  **科学基础扎实：** 该问题在计算流体动力学和等离子体物理学中有坚实的基础。超扩散方程是在模拟湍流的代码中用于数值稳定化的高阶耗散的标准模型。其离散化格式（时间上采用前向欧拉法，空间上采用中心差分）是有限差分法的经典示例。\n2.  **适定性：** 该问题提供了所有必要信息：控制方程、确切的数值格式以及所有参数的定义。它要求求解特定的、可推导的量（$r_{\\max}$）并进行解释（凸组合、极值原理）。问题的结构保证了其解是唯一且有意义的。\n3.  **客观性：** 该问题使用精确、标准的数学和科学术语进行陈述。它没有歧义、主观论断或无法形式化的类比。\n\n**步骤3：结论与行动**\n\n该问题是有效的。它在科学上合理、适定且客观。现在开始解题过程。\n\n### 解答\n\n解答按照题目要求分为两部分。\n\n**第一部分：凸组合与离散极值原理**\n\n离散更新方程为：\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; r \\left( u_{i-2}^{n} - 4\\,u_{i-1}^{n} + 6\\,u_{i}^{n} - 4\\,u_{i+1}^{n} + u_{i+2}^{n} \\right)\n$$\n为了将其分析为前一时间步 $n$ 处各值的线性组合，我们对每个网格点对应的项进行合并：\n$$\nu_{i}^{n+1} \\;=\\; (-r)\\,u_{i-2}^{n} \\;+\\; (4r)\\,u_{i-1}^{n} \\;+\\; (1 - 6r)\\,u_{i}^{n} \\;+\\; (4r)\\,u_{i+1}^{n} \\;+\\; (-r)\\,u_{i+2}^{n}\n$$\n这将 $u_{i}^{n+1}$ 表示为时间层 $n$ 处其相邻点值的线性组合，形式为 $u_{i}^{n+1} = \\sum_{j=-2}^{2} c_{i+j} u_{i+j}^{n}$。这些系数为：\n$$\nc_{i-2} = -r, \\quad c_{i-1} = 4r, \\quad c_{i} = 1-6r, \\quad c_{i+1} = 4r, \\quad c_{i+2} = -r\n$$\n凸组合要求所有系数都为非负，$c_{j} \\geq 0$，且它们的和为1，即 $\\sum_j c_j = 1$。我们来检查系数之和：\n$$\n\\sum c_j = (-r) + (4r) + (1-6r) + (4r) + (-r) = 1 + (-1+4-6+4-1)r = 1 + 0r = 1\n$$\n系数之和恒为1。然而，要使系数为非负，我们需要满足：\n$$\n-r \\geq 0 \\quad \\text{and} \\quad 4r \\geq 0 \\quad \\text{and} \\quad 1-6r \\geq 0\n$$\n由于题目规定 $\\nu_h > 0$、$\\Delta t > 0$ 和 $\\Delta x > 0$，参数 $r = \\nu_h \\Delta t / \\Delta x^4$ 必须严格为正，即 $r > 0$。因此，对于任何非零的 $r$，条件 $-r \\geq 0$ 永远无法满足。\n\n**第一部分结论：** 对于任何非零的 $r$，该更新方程**永远**不能写成凸组合。一个数值格式满足离散极值原理（DMP）的一个充分条件是其更新方程为凸组合。由于此条件被违反，该格式不保证满足DMP。负系数（$c_{i\\pm2}=-r$）的存在意味着解可能会产生过冲（局部最大值随时间增加）或下冲（局部最小值随时间减小），这些都是非物理振荡，即使格式本身是数值稳定的。\n\n**第二部分：放大因子与正性条件**\n\n我们通过考虑单个傅里叶模 $u_{j}^{n} = \\hat{u}^{n} \\exp(\\mathrm{i} j \\theta)$（其中 $\\theta = k \\Delta x$）来进行离散傅里叶分析（冯·诺依曼分析）。放大因子 $G(\\theta)$ 的定义为 $u_{j}^{n+1} = G(\\theta)u_{j}^{n}$。将傅里叶模代入离散更新格式，得到：\n$$\nG(\\theta) \\hat{u}^{n} \\exp(\\mathrm{i}i\\theta) = \\hat{u}^{n}\\exp(\\mathrm{i}i\\theta) - r \\left( \\hat{u}^{n}\\exp(\\mathrm{i}(i-2)\\theta) - 4\\hat{u}^{n}\\exp(\\mathrm{i}(i-1)\\theta) + 6\\hat{u}^{n}\\exp(\\mathrm{i}i\\theta) - 4\\hat{u}^{n}\\exp(\\mathrm{i}(i+1)\\theta) + \\hat{u}^{n}\\exp(\\mathrm{i}(i+2)\\theta) \\right)\n$$\n两边同除以公共因子 $\\hat{u}^{n}\\exp(\\mathrm{i}i\\theta)$，我们得到放大因子 $G(\\theta)$：\n$$\nG(\\theta) = 1 - r \\left( \\exp(-2\\mathrm{i}\\theta) - 4\\exp(-\\mathrm{i}\\theta) + 6 - 4\\exp(\\mathrm{i}\\theta) + \\exp(2\\mathrm{i}\\theta) \\right)\n$$\n我们可以通过对括号内的复指数项进行分组来简化表达式：\n$$\nG(\\theta) = 1 - r \\left[ (\\exp(2\\mathrm{i}\\theta) + \\exp(-2\\mathrm{i}\\theta)) - 4(\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)) + 6 \\right]\n$$\n使用欧拉公式 $\\cos(\\phi) = \\frac{\\exp(\\mathrm{i}\\phi) + \\exp(-\\mathrm{i}\\phi)}{2}$，上式变为：\n$$\nG(\\theta) = 1 - r \\left[ 2\\cos(2\\theta) - 8\\cos(\\theta) + 6 \\right]\n$$\n为进一步简化，我们使用三角恒等式 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$ 和 $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1 = 2(1-2\\sin^2(\\theta/2))^2-1$：\n\\begin{align*}\n2\\cos(2\\theta) - 8\\cos(\\theta) + 6 = 2(2\\cos^2(\\theta)-1) - 8\\cos(\\theta) + 6 \\\\\n= 4\\cos^2(\\theta) - 8\\cos(\\theta) + 4 \\\\\n= 4(\\cos(\\theta) - 1)^2 \\\\\n= 4\\left( (1-2\\sin^2(\\theta/2)) - 1 \\right)^2 \\\\\n= 4\\left( -2\\sin^2(\\theta/2) \\right)^2 \\\\\n= 4\\left( 4\\sin^4(\\theta/2) \\right) \\\\\n= 16\\sin^4(\\theta/2)\n\\end{align*}\n将这个简化后的表达式代回 $G(\\theta)$ 的方程中：\n$$\nG(\\theta) = 1 - 16 r \\sin^4(\\frac{\\theta}{2})\n$$\n题目要求找到最大的 $r_{\\max}$ 值，使得对所有 $\\theta \\in [0, \\pi]$ 都有 $G(\\theta) \\geq 0$。这个条件可以防止傅里叶分量的符号反转，而符号反转是产生过冲和下冲的关键机制。\n$$\n1 - 16 r \\sin^4(\\frac{\\theta}{2}) \\geq 0\n$$\n$$\n1 \\geq 16 r \\sin^4(\\frac{\\theta}{2})\n$$\n由于 $r > 0$，我们可以写成：\n$$\nr \\leq \\frac{1}{16 \\sin^4(\\frac{\\theta}{2})}\n$$\n这个不等式必须对所有 $\\theta \\in [0, \\pi]$ 的值都成立。最严格的情况（即对 $r$ 施加最紧上界的情况）发生在项 $\\sin^4(\\theta/2)$ 达到其最大值时。对于 $\\theta \\in [0, \\pi]$，自变量 $\\theta/2$ 的范围是 $[0, \\pi/2]$。函数 $\\sin(\\phi)$ 在此区间上于 $\\phi = \\pi/2$ 时取得最大值，这对应于 $\\theta = \\pi$。\n最大值为：\n$$\n\\max_{\\theta \\in [0,\\pi]} \\sin^4(\\frac{\\theta}{2}) = \\sin^4(\\frac{\\pi}{2}) = (1)^4 = 1\n$$\n将此最大值代入不等式，得到对 $r$ 的最严格条件：\n$$\nr \\leq \\frac{1}{16 \\cdot 1} \\implies r \\leq \\frac{1}{16}\n$$\n因此，保证对所有模式都有 $G(\\theta) \\geq 0$ 的 $r$ 的最大值为 $r_{\\max} = 1/16$。",
            "answer": "$$\\boxed{\\frac{1}{16}}$$"
        }
    ]
}