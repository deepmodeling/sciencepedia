{
    "hands_on_practices": [
        {
            "introduction": "Mastering numerical methods begins with understanding how to construct the discrete operators themselves. In simulations of multi-scale phenomena like plasma turbulence, high-order accuracy is often necessary to minimize numerical errors that can corrupt the physics. This practice guides you through the foundational process of deriving a sixth-order finite difference scheme from first principles using Taylor series, a technique applicable to any desired order of accuracy. You will then analyze its quality by deriving the modified wavenumber, a crucial tool that reveals how the scheme's numerical dispersion distorts waves of different lengths ().",
            "id": "4201165",
            "problem": "In a local flux-tube model of Gyrokinetic (GK) fusion plasma turbulence, consider the radial advection term in a one-dimensional slice with coordinate $x$ and a passive scalar field $f(x)$ defined on a uniform, periodic grid with spacing $h$. The continuous operator is the first spatial derivative $\\partial_x f$. You will construct a central finite difference discretization that achieves sixth-order consistency and then analyze its dispersion via Fourier symbols.\n\nStarting from the Taylor series expansion for $f(x)$ about a grid point $x_{i}$ and the definition of the first derivative as the coefficient multiplying $f'(x_{i})$ in that expansion, impose the necessary moment conditions so that the truncation error is $\\mathcal{O}(h^{6})$ for a central stencil that uses the six neighbors $x_{i\\pm 1}$, $x_{i\\pm 2}$, and $x_{i\\pm 3}$ and has antisymmetric weights. Derive the unique coefficients for the stencil\n$$\nD f_{i} \\equiv \\frac{1}{h} \\sum_{m=-3}^{3} \\alpha_{m} f_{i+m}, \\quad \\alpha_{0} = 0, \\quad \\alpha_{-m} = -\\alpha_{m},\n$$\nthat satisfy these conditions.\n\nThen, assuming periodic boundary conditions, analyze the discrete operator $D$ by applying it to the Fourier mode $f_{j} = \\exp(\\mathrm{i} k x_{j})$ with $x_{j} = j h$ and define the nondimensional wavenumber $\\theta \\equiv k h \\in [0,\\pi]$. Compute the nondimensional modified wavenumber $k^{*} h$ associated with the discrete operator $D$, expressed as a closed-form analytic function of $\\theta$.\n\nProvide as your final answer the analytic expression for $k^{*} h$ in terms of $\\theta$. No numerical evaluation or rounding is required, and no units should be included in the final expression.",
            "solution": "The user wants to find the nondimensional modified wavenumber for a sixth-order central finite difference scheme.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   **Model**: Local flux-tube model of Gyrokinetic (GK) fusion plasma turbulence.\n-   **Context**: Radial advection term, one-dimensional slice, coordinate $x$.\n-   **Field**: Passive scalar field $f(x)$.\n-   **Grid**: Uniform, periodic, spacing $h$.\n-   **Continuous Operator**: $\\partial_{x} f$.\n-   ** discrete Operator Form**: $D f_{i} \\equiv \\frac{1}{h} \\sum_{m=-3}^{3} \\alpha_{m} f_{i+m}$.\n-   **Stencil Constraints**: Central, using neighbors $x_{i\\pm 1}$, $x_{i\\pm 2}$, $x_{i\\pm 3}$.\n-   **Weight Constraints**: $\\alpha_{0} = 0$ and antisymmetry $\\alpha_{-m} = -\\alpha_{m}$.\n-   **Accuracy Requirement**: Truncation error of $\\mathcal{O}(h^{6})$.\n-   **Analysis Task**: Compute the nondimensional modified wavenumber $k^{*} h$.\n-   **Test Function**: Fourier mode $f_{j} = \\exp(\\mathrm{i} k x_{j})$ with $x_{j} = j h$.\n-   **Nondimensional Wavenumber**: $\\theta \\equiv k h \\in [0,\\pi]$.\n\n**1.2. Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is grounded in the well-established field of numerical analysis, specifically the construction and analysis of finite difference methods for solving partial differential equations. These methods are standard tools in computational physics, including fusion plasma turbulence simulations. The problem is scientifically and mathematically sound.\n-   **Well-Posedness**: The problem is well-posed. The constraints on the finite difference stencil (width, antisymmetry, and order of accuracy) lead to a uniquely solvable system of linear equations for the stencil coefficients. The subsequent derivation of the modified wavenumber is a standard Fourier analysis procedure with a unique outcome.\n-   **Objectivity**: The language is precise, technical, and free of any subjectivity or ambiguity.\n\n**1.3. Verdict and Action**\nThe problem is valid. It is a standard, solvable problem in computational science. The solution process can proceed.\n\n### Step 2: Derivation of Stencil Coefficients\n\nThe goal is to construct a discrete operator $D$ that approximates the continuous first derivative operator $\\partial_x$. The discrete operator is given as:\n$$\nD f_{i} = \\frac{1}{h} \\sum_{m=-3}^{3} \\alpha_{m} f_{i+m}\n$$\nWith the constraints $\\alpha_{0} = 0$ and $\\alpha_{-m} = -\\alpha_{m}$, the sum can be simplified:\n$$\nD f_{i} = \\frac{1}{h} \\sum_{m=1}^{3} (\\alpha_{m} f_{i+m} + \\alpha_{-m} f_{i-m}) = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_{m} (f_{i+m} - f_{i-m})\n$$\nTo determine the coefficients $\\alpha_m$, we expand $f_{i+m} = f(x_i + mh)$ and $f_{i-m} = f(x_i - mh)$ in a Taylor series around the point $x_i$:\n$$\nf(x_i \\pm mh) = \\sum_{n=0}^{\\infty} \\frac{(\\pm mh)^n}{n!} \\frac{d^n f}{dx^n}\\bigg|_{x_i}\n$$\nThe difference term is:\n$$\nf_{i+m} - f_{i-m} = \\sum_{n=0}^{\\infty} \\frac{(mh)^n - (-mh)^n}{n!} f^{(n)}(x_i)\n$$\nThe terms for even $n$ cancel out. For odd $n=2k+1$, we have $(mh)^{2k+1} - (-mh)^{2k+1} = 2(mh)^{2k+1}$.\n$$\nf_{i+m} - f_{i-m} = \\sum_{k=0}^{\\infty} \\frac{2(mh)^{2k+1}}{(2k+1)!} f^{(2k+1)}(x_i) = 2mh f'(x_i) + \\frac{2(mh)^3}{3!}f'''(x_i) + \\frac{2(mh)^5}{5!}f^{(5)}(x_i) + \\dots\n$$\nSubstituting this back into the expression for $D f_i$:\n$$\nD f_i = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_m \\left( 2mh f'(x_i) + \\frac{2m^3h^3}{6}f'''(x_i) + \\frac{2m^5h^5}{120}f^{(5)}(x_i) + \\frac{2m^7h^7}{5040}f^{(7)}(x_i) + \\mathcal{O}(h^9) \\right)\n$$\nWe group the terms by the order of the derivative of $f$:\n$$\nD f_i = f'(x_i) \\left[ 2 \\sum_{m=1}^{3} m \\alpha_m \\right] + f'''(x_i) \\left[ \\frac{h^2}{3} \\sum_{m=1}^{3} m^3 \\alpha_m \\right] + f^{(5)}(x_i) \\left[ \\frac{h^4}{60} \\sum_{m=1}^{3} m^5 \\alpha_m \\right] + f^{(7)}(x_i) \\left[ \\frac{h^6}{2520} \\sum_{m=1}^{3} m^7 \\alpha_m \\right] + \\dots\n$$\nFor $D f_i$ to approximate $f'(x_i)$ with a truncation error of $\\mathcal{O}(h^6)$, we must impose the following conditions:\n1.  The coefficient of $f'(x_i)$ must be $1$: $2 \\sum_{m=1}^{3} m \\alpha_m = 1$.\n2.  The coefficient of $f'''(x_i)$ must be $0$: $\\sum_{m=1}^{3} m^3 \\alpha_m = 0$.\n3.  The coefficient of $f^{(5)}(x_i)$ must be $0$: $\\sum_{m=1}^{3} m^5 \\alpha_m = 0$.\n\nThis gives us a system of three linear equations for the three unknown coefficients $\\alpha_1$, $\\alpha_2$, and $\\alpha_3$:\n$$\n\\begin{cases}\n\\alpha_1 + 2\\alpha_2 + 3\\alpha_3 = \\frac{1}{2} \\\\\n\\alpha_1 + 8\\alpha_2 + 27\\alpha_3 = 0 \\\\\n\\alpha_1 + 32\\alpha_2 + 243\\alpha_3 = 0\n\\end{cases}\n$$\nSubtracting the first equation from the second, and the second from the third, we get:\n$$\n\\begin{cases}\n6\\alpha_2 + 24\\alpha_3 = -\\frac{1}{2} \\\\\n24\\alpha_2 + 216\\alpha_3 = 0\n\\end{cases}\n$$\nFrom the second of these new equations, $24(\\alpha_2 + 9\\alpha_3) = 0$, which implies $\\alpha_2 = -9\\alpha_3$. Substituting this into the first new equation:\n$$\n6(-9\\alpha_3) + 24\\alpha_3 = -\\frac{1}{2} \\implies -54\\alpha_3 + 24\\alpha_3 = -\\frac{1}{2} \\implies -30\\alpha_3 = -\\frac{1}{2} \\implies \\alpha_3 = \\frac{1}{60}\n$$\nNow we can find $\\alpha_2$ and $\\alpha_1$:\n$$\n\\alpha_2 = -9\\alpha_3 = -9\\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}\n$$\n$$\n\\alpha_1 = \\frac{1}{2} - 2\\alpha_2 - 3\\alpha_3 = \\frac{1}{2} - 2\\left(-\\frac{3}{20}\\right) - 3\\left(\\frac{1}{60}\\right) = \\frac{1}{2} + \\frac{6}{20} - \\frac{3}{60} = \\frac{30}{60} + \\frac{18}{60} - \\frac{3}{60} = \\frac{45}{60} = \\frac{3}{4}\n$$\nThe coefficients are $\\alpha_1 = \\frac{3}{4}$, $\\alpha_2 = -\\frac{3}{20}$, and $\\alpha_3 = \\frac{1}{60}$.\n\n### Step 3: Derivation of the Modified Wavenumber\n\nThe continuous derivative operator acting on a Fourier mode $f(x) = \\exp(\\mathrm{i} k x)$ yields $\\partial_x f(x) = \\mathrm{i} k \\exp(\\mathrm{i} k x) = \\mathrm{i} k f(x)$. The eigenvalue is $\\mathrm{i} k$.\n\nThe modified wavenumber $k^*$ is defined such that the discrete operator $D$ acting on the grid function $f_j = \\exp(\\mathrm{i} k x_j) = \\exp(\\mathrm{i} k j h)$ mimics the continuous operator: $D f_j = \\mathrm{i} k^* f_j$.\nLet's compute the action of $D$ on $f_j$:\n$$\nD f_j = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_m (f_{j+m} - f_{j-m})\n$$\nSubstituting $f_{j\\pm m} = \\exp(\\mathrm{i} k(j\\pm m)h) = \\exp(\\mathrm{i} k j h) \\exp(\\pm \\mathrm{i} k m h) = f_j \\exp(\\pm \\mathrm{i} k m h)$:\n$$\nD f_j = \\frac{1}{h} \\sum_{m=1}^{3} \\alpha_m (f_j \\exp(\\mathrm{i} k m h) - f_j \\exp(-\\mathrm{i} k m h))\n$$\n$$\nD f_j = \\frac{f_j}{h} \\sum_{m=1}^{3} \\alpha_m (\\exp(\\mathrm{i} k m h) - \\exp(-\\mathrm{i} k m h))\n$$\nUsing Euler's formula, $\\exp(\\mathrm{i} z) - \\exp(-\\mathrm{i} z) = 2\\mathrm{i}\\sin(z)$, we get:\n$$\nD f_j = \\frac{f_j}{h} \\sum_{m=1}^{3} \\alpha_m (2\\mathrm{i} \\sin(k m h)) = f_j \\left( \\frac{2\\mathrm{i}}{h} \\sum_{m=1}^{3} \\alpha_m \\sin(k m h) \\right)\n$$\nBy comparing this with the definition $D f_j = \\mathrm{i} k^* f_j$, we identify the modified wavenumber $k^*$:\n$$\n\\mathrm{i} k^* = \\frac{2\\mathrm{i}}{h} \\sum_{m=1}^{3} \\alpha_m \\sin(k m h) \\implies k^* = \\frac{2}{h} \\sum_{m=1}^{3} \\alpha_m \\sin(k m h)\n$$\nThe problem asks for the nondimensional modified wavenumber, $k^* h$. Multiplying by $h$:\n$$\nk^* h = 2 \\sum_{m=1}^{3} \\alpha_m \\sin(k m h)\n$$\nIntroducing the nondimensional wavenumber $\\theta = k h$, the expression becomes:\n$$\nk^* h = 2 \\sum_{m=1}^{3} \\alpha_m \\sin(m \\theta) = 2(\\alpha_1 \\sin(\\theta) + \\alpha_2 \\sin(2\\theta) + \\alpha_3 \\sin(3\\theta))\n$$\nFinally, we substitute the derived values for the coefficients $\\alpha_1 = \\frac{3}{4}$, $\\alpha_2 = -\\frac{3}{20}$, and $\\alpha_3 = \\frac{1}{60}$:\n$$\nk^* h = 2 \\left( \\frac{3}{4} \\sin(\\theta) - \\frac{3}{20} \\sin(2\\theta) + \\frac{1}{60} \\sin(3\\theta) \\right)\n$$\n$$\nk^* h = \\frac{3}{2} \\sin(\\theta) - \\frac{3}{10} \\sin(2\\theta) + \\frac{1}{30} \\sin(3\\theta)\n$$\nThis is the final analytical expression for the nondimensional modified wavenumber as a function of the nondimensional wavenumber $\\theta$.",
            "answer": "$$\n\\boxed{\\frac{3}{2} \\sin(\\theta) - \\frac{3}{10} \\sin(2\\theta) + \\frac{1}{30} \\sin(3\\theta)}\n$$"
        },
        {
            "introduction": "A correct implementation of the interior stencil is only half the battle; physical accuracy hinges on the proper enforcement of boundary conditions. A common source of error in numerical codes is the mishandling of boundaries in a way that degrades the overall accuracy of the scheme. This exercise tackles a frequent requirement in physical models: the zero-derivative (Neumann) boundary condition. You will use the ghost-cell technique to construct a boundary value that preserves second-order accuracy, and then formally prove its consistency through a truncation error analysis ().",
            "id": "4201210",
            "problem": "In the radial coordinate $x$ of a local flux-tube model for fusion plasma turbulence, consider a scalar field $f(x)$ that represents a smooth, radially varying quantity (for example, an electrostatic potential or pressure moment) near the magnetic axis, with a homogeneous Neumann boundary condition at the axis, $\\partial_x f|_{x=0} = 0$, imposed by physical symmetry. For spatial discretization, adopt a uniform one-dimensional grid with spacing $\\Delta x$, nodes $x_{i} = i\\,\\Delta x$ for $i = 0, 1, \\dots, N$, and a single ghost node at $i = -1$ located at $x_{-1} = -\\Delta x$ used to close central-difference stencils at the boundary. Let $f_{i}$ denote the grid function approximating $f(x_{i})$.\n\nYou seek to enforce the Neumann boundary condition at $x=0$ using a second-order central-difference approximation to the derivative at the boundary, which, at the discrete level, couples $f_{-1}$ and $f_{1}$. Construct a ghost-cell value $f_{-1}$, expressed as a closed-form analytic expression in terms of grid quantities, that yields second-order accuracy for the boundary derivative under central differencing. Starting from the definition of the derivative and the Taylor expansion of $f(x)$ about $x=0$, demonstrate the consistency of your construction by deriving the truncation error order for the boundary derivative, explicitly showing that it is $\\mathcal{O}(\\Delta x^{2})$ in the sense of the central-difference operator at $x=0$.\n\nProvide your final answer as the explicit analytic expression for the ghost-cell value $f_{-1}$ in terms of grid function values. No rounding is needed. Do not include units in your final answer.",
            "solution": "The problem requires the determination of a ghost-cell value, $f_{-1}$, for a scalar field $f(x)$ at a boundary $x=0$ subject to a homogeneous Neumann condition, $\\partial_{x} f|_{x=0} = 0$. The construction must be consistent with a second-order central-difference scheme. Following this construction, a formal proof of the second-order accuracy of the resulting numerical approximation to the boundary derivative is required.\n\nFirst, we construct the expression for the ghost-cell value $f_{-1}$. The problem specifies the use of a second-order central-difference approximation to the derivative at the boundary node $x_{0} = 0$. The standard second-order central-difference operator for the first derivative, $\\frac{d}{dx}$, at a grid point $x_i$ uses the values at the neighboring points $x_{i-1}$ and $x_{i+1}$. At the boundary point $x_0 = 0$, this operator is given by:\n$$\n\\left. \\frac{\\partial f}{\\partial x} \\right|_{x=0} \\approx \\frac{f(x_{1}) - f(x_{-1})}{x_1 - x_{-1}}\n$$\nUsing the specified grid notation where $x_i = i\\,\\Delta x$, we have $x_1 = \\Delta x$ and $x_{-1} = -\\Delta x$. The discrete approximation to the derivative at $x_0$ using the grid function values $f_i$ is thus:\n$$\n\\left. \\frac{\\partial f}{\\partial x} \\right|_{x_0} \\approx \\frac{f_{1} - f_{-1}}{2\\Delta x}\n$$\nThe physical boundary condition is a homogeneous Neumann condition, $\\partial_{x} f|_{x=0} = 0$. To enforce this condition discretely, we set the finite-difference approximation of the derivative to zero:\n$$\n\\frac{f_{1} - f_{-1}}{2\\Delta x} = 0\n$$\nSolving this algebraic equation for the ghost-cell value $f_{-1}$ yields the desired expression:\n$$\nf_{1} - f_{-1} = 0 \\implies f_{-1} = f_{1}\n$$\nThis establishes the rule for setting the ghost-cell value: it is equal to the value of the grid function at the first interior grid point, $x_1$.\n\nNext, we must demonstrate the consistency of this method by deriving the truncation error for the boundary derivative approximation and showing it is of order $\\mathcal{O}(\\Delta x^{2})$. The truncation error, $T_0$, of the finite-difference operator at $x_0 = 0$ is defined as the difference between the operator applied to the exact, smooth function $f(x)$ and the exact derivative $\\left. \\frac{df}{dx} \\right|_{x=0}$:\n$$\nT_0 = \\frac{f(x_1) - f(x_{-1})}{2\\Delta x} - f'(0)\n$$\nwhere $f'(0)$ denotes $\\left. \\frac{df}{dx} \\right|_{x=0}$. To analyze this error, we employ the Taylor series expansion for the function $f(x)$ about the point $x=0$. Since the function is assumed to be smooth, its derivatives exist. The expansions for $f(x_1) = f(\\Delta x)$ and $f(x_{-1}) = f(-\\Delta x)$ are:\n$$\nf(\\Delta x) = f(0) + \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{2}}{2!} f''(0) + \\frac{(\\Delta x)^{3}}{3!} f'''(0) + \\frac{(\\Delta x)^{4}}{4!} f^{(4)}(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\n$$\nf(-\\Delta x) = f(0) - \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{2}}{2!} f''(0) - \\frac{(\\Delta x)^{3}}{3!} f'''(0) + \\frac{(\\Delta x)^{4}}{4!} f^{(4)}(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\nWe compute the difference $f(\\Delta x) - f(-\\Delta x)$ by subtracting the second series from the first. The even-powered terms cancel out:\n$$\nf(\\Delta x) - f(-\\Delta x) = \\left( \\Delta x \\, f'(0) - (-\\Delta x \\, f'(0)) \\right) + \\left( \\frac{(\\Delta x)^{3}}{6} f'''(0) - (-\\frac{(\\Delta x)^{3}}{6} f'''(0)) \\right) + \\mathcal{O}((\\Delta x)^{5})\n$$\n$$\nf(\\Delta x) - f(-\\Delta x) = 2 \\Delta x \\, f'(0) + \\frac{2(\\Delta x)^{3}}{6} f'''(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\n$$\nf(\\Delta x) - f(-\\Delta x) = 2 \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{3}}{3} f'''(0) + \\mathcal{O}((\\Delta x)^{5})\n$$\nNow, substitute this result back into the expression for the truncation error $T_0$:\n$$\nT_0 = \\frac{2 \\Delta x \\, f'(0) + \\frac{(\\Delta x)^{3}}{3} f'''(0) + \\mathcal{O}((\\Delta x)^{5})}{2\\Delta x} - f'(0)\n$$\nDividing by $2\\Delta x$ gives:\n$$\nT_0 = \\left( f'(0) + \\frac{(\\Delta x)^{2}}{6} f'''(0) + \\mathcal{O}((\\Delta x)^{4}) \\right) - f'(0)\n$$\nThe $f'(0)$ terms cancel, leaving the final expression for the truncation error:\n$$\nT_0 = \\frac{(\\Delta x)^{2}}{6} f'''(0) + \\mathcal{O}((\\Delta x)^{4})\n$$\nThe leading term in the truncation error is proportional to $(\\Delta x)^{2}$, assuming $f'''(0)$ is non-zero. Therefore, the truncation error is of order $\\mathcal{O}((\\Delta x)^{2})$. This demonstrates that the central-difference operator used at the boundary is second-order accurate. The construction $f_{-1} = f_1$ forces the discrete derivative to be zero, which differs from the true value of the operator, $\\frac{f(\\Delta x)-f(-\\Delta x)}{2\\Delta x}$, by an amount of order $\\mathcal{O}((\\Delta x)^2)$, since the physical condition $f'(0)=0$ is given. Thus, the implementation of the Neumann boundary condition is consistent with the second-order accuracy of the scheme.",
            "answer": "$$\n\\boxed{f_{1}}\n$$"
        },
        {
            "introduction": "After implementing both the interior operator and its boundary conditions, the final and most critical step is verification: proving that your code works as intended. The Method of Manufactured Solutions (MMS) is a rigorous and indispensable technique for this purpose, allowing you to test your code against a problem with a known analytical solution. This practice demonstrates how to apply MMS to a representative advection-diffusion equation. You will derive the specific source term that must be added to the governing equation so that a chosen smooth function becomes an exact solution to the *discrete* system, enabling a precise measurement of your code's convergence and accuracy ().",
            "id": "4201204",
            "problem": "In fusion plasma turbulence simulation, a common verification strategy is the Method of Manufactured Solutions (MMS), in which one prescribes a smooth solution and derives a source term that makes the numerical scheme exactly solvable at the discrete level. Consider a steady, two-dimensional, gyrokinetic-like advectionâ€“diffusion model in nondimensional units on a rectangular, periodic domain with coordinates $x \\in [0,L_x)$ and $y \\in [0,L_y)$. The equation for a scalar field $g(x,y)$ is\n$$\nv_x \\,\\frac{\\partial g}{\\partial x} \\;+\\; v_y \\,\\frac{\\partial g}{\\partial y} \\;-\\; D \\left(\\frac{\\partial^2 g}{\\partial x^2} + \\frac{\\partial^2 g}{\\partial y^2}\\right) \\;=\\; S(x,y),\n$$\nwhere $v_x$ and $v_y$ are constant advection velocities (representing, for example, components of the electric field cross magnetic field $\\left(\\mathbf{E} \\times \\mathbf{B}\\right)$ drift), and $D>0$ is a constant cross-field diffusivity.\n\nDiscretize the equation on a uniform grid with $N_x$ points in $x$ and $N_y$ points in $y$, with spacings $h_x = L_x/N_x$ and $h_y = L_y/N_y$. Denote grid points by $x_i = i\\,h_x$ and $y_j = j\\,h_y$, with integer indices $i \\in \\{0,1,\\dots,N_x-1\\}$ and $j \\in \\{0,1,\\dots,N_y-1\\}$ and periodic boundary conditions. Use second-order centered finite differences for the first derivatives and the standard five-point stencil for the Laplacian, namely\n$$\n\\left(D_x g\\right)_{i,j} \\;=\\; \\frac{g_{i+1,j} - g_{i-1,j}}{2 h_x}, \n\\qquad\n\\left(D_y g\\right)_{i,j} \\;=\\; \\frac{g_{i,j+1} - g_{i,j-1}}{2 h_y},\n$$\n$$\n\\left(\\Delta_h g\\right)_{i,j} \\;=\\; \\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} \\;+\\; \\frac{g_{i,j+1} - 2 g_{i,j} + g_{i,j-1}}{h_y^2},\n$$\nwith periodic wrapping of indices. The discrete steady operator is then\n$$\n\\left(\\mathcal{L}_h g\\right)_{i,j} \\;=\\; v_x \\left(D_x g\\right)_{i,j} \\;+\\; v_y \\left(D_y g\\right)_{i,j} \\;-\\; D \\left(\\Delta_h g\\right)_{i,j}.\n$$\n\nChoose a manufactured solution compatible with periodicity,\n$$\ng(x,y) \\;=\\; \\cos\\!\\left(k_x x\\right)\\,\\cos\\!\\left(k_y y\\right),\n$$\nwith $k_x = \\frac{2\\pi m}{L_x}$ and $k_y = \\frac{2\\pi n}{L_y}$ for fixed integers $m$ and $n$. Define the discrete source on grid points by $S_{i,j} \\equiv \\left(\\mathcal{L}_h g\\right)_{i,j}$, where $g_{i,j} = g(x_i,y_j)$.\n\nDerive a closed-form analytic expression for $S_{i,j}$ in terms of $v_x$, $v_y$, $D$, $h_x$, $h_y$, $k_x$, $k_y$, $x_i$, and $y_j$ that makes the discrete scheme exactly solvable for the chosen $g(x,y)$. Express the final $S_{i,j}$ as a single analytic expression. No numerical evaluation or rounding is required, and all quantities are nondimensional, so no physical units should be included in the answer.",
            "solution": "The problem has been validated and found to be scientifically grounded, well-posed, and objective. It is a standard exercise in the Method of Manufactured Solutions (MMS) for verifying numerical codes, based on fundamental principles of numerical analysis and partial differential equations. All necessary information is provided, and the definitions are consistent and unambiguous. We may proceed with the derivation.\n\nThe objective is to derive a closed-form analytic expression for the discrete source term $S_{i,j}$ that makes the given discrete scheme exactly solvable for the manufactured solution $g(x,y)$. The source term is defined by applying the discrete operator $\\mathcal{L}_h$ to the manufactured solution evaluated on the grid, $g_{i,j} = g(x_i, y_j)$.\nThe discrete operator is given by:\n$$\n\\left(\\mathcal{L}_h g\\right)_{i,j} \\;=\\; v_x \\left(D_x g\\right)_{i,j} \\;+\\; v_y \\left(D_y g\\right)_{i,j} \\;-\\; D \\left(\\Delta_h g\\right)_{i,j}\n$$\nThe manufactured solution is:\n$$\ng(x,y) \\;=\\; \\cos(k_x x)\\,\\cos(k_y y)\n$$\nWhen evaluated on the grid points $(x_i, y_j)$, we have:\n$$\ng_{i,j} = g(x_i, y_j) = \\cos(k_x x_i)\\,\\cos(k_y y_j)\n$$\nWe shall compute each term of $(\\mathcal{L}_h g)_{i,j}$ separately.\n\nFirst, we compute the advection term in the $x$-direction, $v_x(D_x g)_{i,j}$. The discrete operator $D_x$ is:\n$$\n(D_x g)_{i,j} = \\frac{g_{i+1,j} - g_{i-1,j}}{2 h_x}\n$$\nWe need to evaluate $g$ at the neighboring points:\n$$\ng_{i+1,j} = g(x_{i+1}, y_j) = g(x_i+h_x, y_j) = \\cos(k_x(x_i+h_x))\\cos(k_y y_j)\n$$\n$$\ng_{i-1,j} = g(x_{i-1}, y_j) = g(x_i-h_x, y_j) = \\cos(k_x(x_i-h_x))\\cos(k_y y_j)\n$$\nSubstituting these into the expression for $(D_x g)_{i,j}$:\n$$\n(D_x g)_{i,j} = \\frac{\\cos(k_x(x_i+h_x))\\cos(k_y y_j) - \\cos(k_x(x_i-h_x))\\cos(k_y y_j)}{2h_x}\n$$\nFactoring out the common term $\\cos(k_y y_j)$:\n$$\n(D_x g)_{i,j} = \\frac{\\cos(k_x x_i + k_x h_x) - \\cos(k_x x_i - k_x h_x)}{2h_x} \\cos(k_y y_j)\n$$\nWe use the trigonometric identity $\\cos(A+B) - \\cos(A-B) = -2\\sin A \\sin B$. With $A = k_x x_i$ and $B = k_x h_x$, we get:\n$$\n(D_x g)_{i,j} = \\frac{-2\\sin(k_x x_i)\\sin(k_x h_x)}{2h_x} \\cos(k_y y_j) = -\\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j)\n$$\n\nSecond, we compute the advection term in the $y$-direction, $v_y(D_y g)_{i,j}$. By symmetry, the calculation is analogous. The operator is:\n$$\n(D_y g)_{i,j} = \\frac{g_{i,j+1} - g_{i,j-1}}{2 h_y}\n$$\nThe values at neighboring points are:\n$$\ng_{i,j+1} = \\cos(k_x x_i)\\cos(k_y(y_j+h_y))\n$$\n$$\ng_{i,j-1} = \\cos(k_x x_i)\\cos(k_y(y_j-h_y))\n$$\nSubstituting and using the same identity $\\cos(A+B) - \\cos(A-B) = -2\\sin A \\sin B$ with $A = k_y y_j$ and $B = k_y h_y$:\n$$\n(D_y g)_{i,j} = \\cos(k_x x_i) \\frac{\\cos(k_y y_j+k_y h_y) - \\cos(k_y y_j-k_y h_y)}{2h_y} = \\cos(k_x x_i) \\frac{-2\\sin(k_y y_j)\\sin(k_y h_y)}{2h_y}\n$$\n$$\n(D_y g)_{i,j} = -\\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j)\n$$\n\nThird, we compute the diffusion term, $-D(\\Delta_h g)_{i,j}$. The discrete Laplacian is:\n$$\n(\\Delta_h g)_{i,j} = \\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} + \\frac{g_{i,j+1} - 2 g_{i,j} + g_{i,j-1}}{h_y^2}\n$$\nLet's analyze the first part of the Laplacian (the second derivative in $x$):\n$$\n\\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} = \\frac{(g_{i+1,j} + g_{i-1,j}) - 2 g_{i,j}}{h_x^2}\n$$\nWe use the trigonometric identity $\\cos(A+B) + \\cos(A-B) = 2\\cos A \\cos B$. With $A = k_x x_i$ and $B = k_x h_x$:\n$$\ng_{i+1,j} + g_{i-1,j} = \\cos(k_x(x_i+h_x))\\cos(k_y y_j) + \\cos(k_x(x_i-h_x))\\cos(k_y y_j) = 2\\cos(k_x x_i)\\cos(k_x h_x)\\cos(k_y y_j)\n$$\nSubstituting this into the numerator of the discrete second derivative:\n$$\ng_{i+1,j} - 2g_{i,j} + g_{i-1,j} = 2\\cos(k_x x_i)\\cos(k_x h_x)\\cos(k_y y_j) - 2\\cos(k_x x_i)\\cos(k_y y_j)\n$$\n$$\n= 2(\\cos(k_x h_x) - 1)\\cos(k_x x_i)\\cos(k_y y_j)\n$$\nThus, the $x$-component of the discrete Laplacian is:\n$$\n\\frac{g_{i+1,j} - 2 g_{i,j} + g_{i-1,j}}{h_x^2} = \\frac{2(\\cos(k_x h_x) - 1)}{h_x^2} \\cos(k_x x_i)\\cos(k_y y_j)\n$$\nBy symmetry, the $y$-component is:\n$$\n\\frac{g_{i,j+1} - 2 g_{i,j} + g_{i,j-1}}{h_y^2} = \\frac{2(\\cos(k_y h_y) - 1)}{h_y^2} \\cos(k_x x_i)\\cos(k_y y_j)\n$$\nSumming these two components gives the discrete Laplacian applied to $g_{i,j}$:\n$$\n(\\Delta_h g)_{i,j} = \\left( \\frac{2(\\cos(k_x h_x) - 1)}{h_x^2} + \\frac{2(\\cos(k_y h_y) - 1)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j)\n$$\n\nFinally, we assemble the source term $S_{i,j} = (\\mathcal{L}_h g)_{i,j}$ by combining the three computed parts:\n$$\nS_{i,j} = v_x \\left( -\\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j) \\right) + v_y \\left( -\\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j) \\right) - D \\left[ \\left( \\frac{2(\\cos(k_x h_x) - 1)}{h_x^2} + \\frac{2(\\cos(k_y h_y) - 1)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j) \\right]\n$$\nRearranging the terms for clarity and combining constants yields the final expression:\n$$\nS_{i,j} = -v_x \\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j) - v_y \\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j) + 2D \\left( \\frac{1 - \\cos(k_x h_x)}{h_x^2} + \\frac{1 - \\cos(k_y h_y)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j)\n$$\nThis is the required closed-form analytic expression for the source term $S_{i,j}$.",
            "answer": "$$\n\\boxed{-v_x \\frac{\\sin(k_x h_x)}{h_x} \\sin(k_x x_i)\\cos(k_y y_j) - v_y \\frac{\\sin(k_y h_y)}{h_y} \\cos(k_x x_i)\\sin(k_y y_j) + 2D \\left( \\frac{1 - \\cos(k_x h_x)}{h_x^2} + \\frac{1 - \\cos(k_y h_y)}{h_y^2} \\right) \\cos(k_x x_i)\\cos(k_y y_j)}\n$$"
        }
    ]
}