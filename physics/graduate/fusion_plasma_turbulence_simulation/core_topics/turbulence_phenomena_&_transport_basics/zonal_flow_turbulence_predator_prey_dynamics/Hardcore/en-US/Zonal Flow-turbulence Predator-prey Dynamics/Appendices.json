{
    "hands_on_practices": [
        {
            "introduction": "The interaction between turbulence and zonal flows hinges on the ability of the flow's shear to suppress turbulent eddies. This exercise provides a practical, order-of-magnitude estimate of this fundamental process. By calculating the critical zonal flow amplitude required to balance a model drift-wave instability , you will gain a quantitative feel for the parameters that govern turbulence regulation in a tokamak core.",
            "id": "4209786",
            "problem": "Consider a reduced predator-prey description of core drift-wave turbulence and zonal flows in a tokamak plasma, in which the turbulence is decorrelated when the Electric cross Magnetic (E×B) zonal shear rate balances the linear drift-wave growth rate. Let the poloidally directed zonal flow velocity be modeled as a purely radial sinusoidal structure $V_E(x) = V_0 \\cos(q x)$, where $x$ is the radial coordinate, $V_0$ is the zonal flow amplitude, and $q$ is the radial wavenumber of the zonal flow. The zonal shear rate is defined by $\\omega_E \\equiv \\partial_x V_E$, and turbulence suppression requires the threshold condition $|\\omega_E| \\sim \\gamma_{\\mathrm{lin}}(k)$, where $\\gamma_{\\mathrm{lin}}(k)$ is the linear drift-wave growth rate at perpendicular wavenumber $k$.\n\nAdopt the following widely used, core-relevant, drift-wave growth-rate model that captures finite Larmor radius stabilization:\n$$\n\\gamma_{\\mathrm{lin}}(k_y) \\equiv \\beta\\,\\omega_\\ast\\,\\exp\\!\\left(-k_\\perp^{2}\\rho_s^{2}\\right),\n$$\nwhere $k_\\perp \\approx k_y$ for predominantly poloidal fluctuations, $\\beta$ is a dimensionless coefficient representing drive above marginality, $\\omega_\\ast$ is the ion diamagnetic drift frequency, and $\\rho_s$ is the ion-sound gyroradius. Use the definitions\n$$\n\\omega_\\ast \\equiv \\frac{k_y c_s}{L_n}, \\qquad c_s \\equiv \\sqrt{\\frac{T_e}{m_i}}, \\qquad \\rho_s \\equiv \\frac{c_s}{\\Omega_{ci}}, \\qquad \\Omega_{ci} \\equiv \\frac{e B}{m_i},\n$$\nwith $T_e$ the electron temperature (treated as isothermal for the sound speed), $m_i$ the ion mass (take deuterium), $e$ the elementary charge, $B$ the magnetic field strength, and $L_n$ the density gradient scale length.\n\nAssume typical core parameters:\n- $B = 3.0\\,\\mathrm{T}$,\n- $T_e = 2.0\\,\\mathrm{keV}$,\n- $m_i = 3.3436 \\times 10^{-27}\\,\\mathrm{kg}$ (deuterium),\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$,\n- $L_n = 0.80\\,\\mathrm{m}$,\n- $\\beta = 0.20$,\n- $k_y \\rho_s = 0.30$,\n- $q = \\rho_s^{-1}$.\n\nStarting from the above definitions and the threshold condition $|\\omega_E| \\sim \\gamma_{\\mathrm{lin}}(k_y)$, derive the expression for the critical zonal flow amplitude $V_E^{\\mathrm{crit}}$ required for balance, and then evaluate it numerically for the given parameters. Express the final answer in $\\mathrm{m/s}$ and round your answer to three significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded in established plasma physics principles, well-posed with a complete and consistent set of definitions and parameters, and objectively stated. We can therefore proceed with the derivation and calculation.\n\nThe problem requires a determination of the critical zonal flow amplitude, denoted $V_E^{\\mathrm{crit}}$, for which the zonal shear rate balances the linear drift-wave growth rate. The condition for turbulence suppression is given as $|\\omega_E| \\sim \\gamma_{\\mathrm{lin}}(k_y)$. For a threshold or critical balance calculation, this is treated as an equality. The zonal shear rate $\\omega_E$ is a function of the radial coordinate $x$. The suppression condition is most stringently applied by comparing the maximum shear rate with the growth rate.\n\nFirst, we calculate the zonal shear rate $\\omega_E$ and its maximum value. The zonal flow velocity is given by\n$$\nV_E(x) = V_0 \\cos(q x)\n$$\nwhere $V_0$ is the amplitude we seek to determine ($V_E^{\\mathrm{crit}} \\equiv V_0^{\\mathrm{crit}}$). The shear rate is its radial derivative:\n$$\n\\omega_E(x) \\equiv \\frac{\\partial V_E}{\\partial x} = -V_0 q \\sin(q x)\n$$\nThe magnitude of the shear rate is $|\\omega_E(x)| = |V_0 q \\sin(q x)|$. The spatially maximum value of this shear rate is\n$$\n|\\omega_E|_{\\max} = V_0 q\n$$\nThe threshold condition for turbulence suppression is thus established by equating this maximum shear rate to the linear growth rate:\n$$\nV_E^{\\mathrm{crit}} q = \\gamma_{\\mathrm{lin}}(k_y)\n$$\n\nNext, we substitute the provided model for the drift-wave growth rate:\n$$\n\\gamma_{\\mathrm{lin}}(k_y) = \\beta\\,\\omega_\\ast\\,\\exp\\!\\left(-k_y^{2}\\rho_s^{2}\\right)\n$$\nwhere we use the approximation $k_\\perp \\approx k_y$. The ion diamagnetic drift frequency $\\omega_\\ast$ is defined as\n$$\n\\omega_\\ast = \\frac{k_y c_s}{L_n}\n$$\nSubstituting this into the expression for $\\gamma_{\\mathrm{lin}}(k_y)$ yields:\n$$\n\\gamma_{\\mathrm{lin}}(k_y) = \\beta \\frac{k_y c_s}{L_n} \\exp\\!\\left(-(k_y \\rho_s)^{2}\\right)\n$$\n\nNow, we can solve for the critical amplitude $V_E^{\\mathrm{crit}}$:\n$$\nV_E^{\\mathrm{crit}} = \\frac{1}{q} \\gamma_{\\mathrm{lin}}(k_y) = \\frac{1}{q} \\left( \\beta \\frac{k_y c_s}{L_n} \\exp\\!\\left(-(k_y \\rho_s)^{2}\\right) \\right)\n$$\nThe problem specifies that the zonal flow wavenumber is $q = \\rho_s^{-1}$, where $\\rho_s$ is the ion-sound gyroradius. Substituting $q^{-1} = \\rho_s$ into the expression for $V_E^{\\mathrm{crit}}$ gives:\n$$\nV_E^{\\mathrm{crit}} = \\rho_s \\left( \\beta \\frac{k_y c_s}{L_n} \\exp\\!\\left(-(k_y \\rho_s)^{2}\\right) \\right)\n$$\nThis expression can be rearranged to group the dimensionless parameter $k_y \\rho_s$:\n$$\nV_E^{\\mathrm{crit}} = \\frac{\\beta c_s}{L_n} (k_y \\rho_s) \\exp\\!\\left(-(k_y \\rho_s)^{2}\\right)\n$$\nThis is the final symbolic expression for the critical zonal flow amplitude.\n\nTo evaluate this expression numerically, we must first calculate the ion sound speed, $c_s$. The electron temperature $T_e$ must be converted from kiloelectronvolts ($\\mathrm{keV}$) to joules ($\\mathrm{J}$).\nThe elementary charge is $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$.\n$$\nT_e = 2.0\\,\\mathrm{keV} = 2.0 \\times 10^3\\,\\mathrm{eV} = (2.0 \\times 10^3) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J}) = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}\n$$\nThe ion mass for deuterium is given as $m_i = 3.3436 \\times 10^{-27}\\,\\mathrm{kg}$. The sound speed $c_s$ is:\n$$\nc_s = \\sqrt{\\frac{T_e}{m_i}} = \\sqrt{\\frac{3.204353268 \\times 10^{-16}\\,\\mathrm{J}}{3.3436 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx 3.0957 \\times 10^5\\,\\mathrm{m/s}\n$$\nNow we can substitute all the given numerical values into the expression for $V_E^{\\mathrm{crit}}$:\n- $\\beta = 0.20$\n- $c_s \\approx 3.0957 \\times 10^5\\,\\mathrm{m/s}$\n- $L_n = 0.80\\,\\mathrm{m}$\n- $k_y \\rho_s = 0.30$\n\n$$\nV_E^{\\mathrm{crit}} = \\frac{0.20 \\times (3.0957 \\times 10^5\\,\\mathrm{m/s})}{0.80\\,\\mathrm{m}} \\times (0.30) \\times \\exp\\!\\left(-(0.30)^{2}\\right)\n$$\n$$\nV_E^{\\mathrm{crit}} = \\frac{0.20 \\times 3.0957 \\times 10^5}{0.80} \\times 0.30 \\times \\exp(-0.09)\\,\\mathrm{m/s}\n$$\nUsing a more precise value for $c_s = 309572.925\\,\\mathrm{m/s}$ and $\\exp(-0.09) \\approx 0.913931$:\n$$\nV_E^{\\mathrm{crit}} = \\frac{0.20 \\times 309572.925}{0.80} \\times 0.30 \\times 0.913931\\,\\mathrm{m/s}\n$$\n$$\nV_E^{\\mathrm{crit}} \\approx (77393.23) \\times (0.274179)\\,\\mathrm{m/s} \\approx 21220.13\\,\\mathrm{m/s}\n$$\nThe problem requires the final answer to be rounded to three significant figures.\n$$\nV_E^{\\mathrm{crit}} \\approx 21200\\,\\mathrm{m/s}\n$$\nExpressed in scientific notation, this is $2.12 \\times 10^4\\,\\mathrm{m/s}$.",
            "answer": "$$\n\\boxed{2.12 \\times 10^{4}}\n$$"
        },
        {
            "introduction": "The constant battle between turbulence and zonal flows often leads to dynamic, oscillatory behavior rather than a simple static equilibrium. This problem explores this dynamic using a classic predator-prey model, a cornerstone of understanding self-regulation in plasma turbulence. By performing a bifurcation analysis , you will determine the precise conditions under which the system transitions from a stable, quiescent state to one of sustained predator-prey oscillations, a phenomenon known as a limit cycle.",
            "id": "4209795",
            "problem": "In a reduced predator-prey model for drift-wave turbulence intensity and zonal flow in a magnetized fusion plasma, the turbulence intensity $I(t)$ is driven by a linear instability and saturates nonlinearly, while the mean zonal flow amplitude $Z(t)$ is driven by Reynolds stress and damped linearly. Consider the following pair of coupled ordinary differential equations (ODEs):\n$$\n\\frac{d I}{d t} \\;=\\; I \\big( \\gamma - \\beta I \\big) \\;-\\; \\alpha Z, \n\\qquad\n\\frac{d Z}{d t} \\;=\\; s I \\;-\\; \\nu Z,\n$$\nwhere $\\gamma$ is the linear drift-wave growth rate due to background gradients, $\\beta$ is a nonlinear self-saturation coefficient for $I$, $\\alpha$ parameterizes linear shear suppression of turbulence by $Z$, $s$ measures the efficiency of zonal flow drive by turbulent Reynolds stress, and $\\nu$ is the effective linear damping rate of the zonal flow. All parameters satisfy $\\alpha > 0$, $\\beta > 0$, $s > 0$, and $\\nu > 0$. The control parameter for the bifurcation analysis is $\\gamma$.\n\nStarting from the definitions of fixed points, linearization, and linear stability of equilibria for ODEs, perform a bifurcation analysis with respect to $\\gamma$ to identify the onset of a Hopf bifurcation at the nontrivial coexistence fixed point $(I^{\\ast}, Z^{\\ast})$ with $I^{\\ast} > 0$ and $Z^{\\ast} > 0$. Specifically:\n- Derive $(I^{\\ast}, Z^{\\ast})$ as functions of the parameters.\n- Compute the Jacobian matrix evaluated at $(I^{\\ast}, Z^{\\ast})$ and express its trace and determinant in terms of the parameters.\n- Using the defining criteria for a Hopf bifurcation, determine the critical value $\\gamma_{\\mathrm{H}}$ at which the stable fixed point transitions to a limit cycle, and identify the parameter inequality that must hold for this Hopf bifurcation to occur.\n\nYour final answer must be the single closed-form analytic expression for $\\gamma_{\\mathrm{H}}$ in terms of $\\alpha$, $s$, and $\\nu$. Do not include units. No numerical substitution is required. If you find that a Hopf bifurcation requires an additional condition on parameters beyond positivity, explain this condition in your derivation, but do not include it in the final answer.",
            "solution": "The problem requires a bifurcation analysis of a system of two coupled ordinary differential equations (ODEs) describing the interaction between drift-wave turbulence intensity, $I(t)$, and mean zonal flow amplitude, $Z(t)$. The system is given by:\n$$ \\frac{d I}{d t} = I \\left( \\gamma - \\beta I \\right) - \\alpha Z $$\n$$ \\frac{d Z}{d t} = s I - \\nu Z $$\nAll parameters $\\alpha, \\beta, s, \\nu$ are positive constants, and $\\gamma$ is the bifurcation control parameter. We seek to find the critical value of $\\gamma$, denoted $\\gamma_{\\mathrm{H}}$, at which a Hopf bifurcation occurs at the nontrivial coexistence fixed point.\n\nFirst, we determine the fixed points $(I^{\\ast}, Z^{\\ast})$ of the system by setting the time derivatives to zero:\n$$ I^{\\ast} \\left( \\gamma - \\beta I^{\\ast} \\right) - \\alpha Z^{\\ast} = 0 \\quad (1) $$\n$$ s I^{\\ast} - \\nu Z^{\\ast} = 0 \\quad (2) $$\nFrom equation $(2)$, we find $Z^{\\ast} = \\frac{s}{\\nu} I^{\\ast}$. The problem specifies a nontrivial coexistence fixed point, which requires $I^{\\ast} > 0$ and $Z^{\\ast} > 0$. Since $s > 0$ and $\\nu > 0$, the condition $Z^{\\ast} > 0$ is equivalent to $I^{\\ast} > 0$.\nSubstituting $Z^{\\ast} = \\frac{s}{\\nu} I^{\\ast}$ into equation $(1)$:\n$$ I^{\\ast} \\left( \\gamma - \\beta I^{\\ast} \\right) - \\alpha \\left( \\frac{s}{\\nu} I^{\\ast} \\right) = 0 $$\n$$ I^{\\ast} \\left( \\gamma - \\beta I^{\\ast} - \\frac{\\alpha s}{\\nu} \\right) = 0 $$\nThis equation has two solutions for $I^{\\ast}$. The trivial solution is $I^{\\ast} = 0$, which yields $Z^{\\ast} = 0$, corresponding to the fixed point $(0, 0)$. The nontrivial solution is found by setting the term in the parenthesis to zero:\n$$ \\gamma - \\beta I^{\\ast} - \\frac{\\alpha s}{\\nu} = 0 $$\nSolving for $I^{\\ast}$ gives:\n$$ I^{\\ast} = \\frac{1}{\\beta} \\left( \\gamma - \\frac{\\alpha s}{\\nu} \\right) $$\nThe corresponding value for $Z^{\\ast}$ is:\n$$ Z^{\\ast} = \\frac{s}{\\nu} I^{\\ast} = \\frac{s}{\\nu \\beta} \\left( \\gamma - \\frac{\\alpha s}{\\nu} \\right) $$\nFor this fixed point to be a physically meaningful coexistence point ($I^{\\ast} > 0, Z^{\\ast} > 0$), we must have $\\gamma - \\frac{\\alpha s}{\\nu} > 0$, which implies the condition $\\gamma > \\frac{\\alpha s}{\\nu}$.\n\nNext, we analyze the linear stability of this nontrivial fixed point. We compute the Jacobian matrix $J$ of the system, defined by $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$, where $f_1 = \\frac{dI}{dt}$ and $f_2 = \\frac{dZ}{dt}$, and $(x_1, x_2) = (I, Z)$:\n$$ J(I, Z) = \\begin{pmatrix} \\frac{\\partial}{\\partial I} (I(\\gamma - \\beta I) - \\alpha Z)  \\frac{\\partial}{\\partial Z} (I(\\gamma - \\beta I) - \\alpha Z) \\\\ \\frac{\\partial}{\\partial I} (sI - \\nu Z)  \\frac{\\partial}{\\partial Z} (sI - \\nu Z) \\end{pmatrix} $$\n$$ J(I, Z) = \\begin{pmatrix} \\gamma - 2\\beta I  -\\alpha \\\\ s  -\\nu \\end{pmatrix} $$\nWe evaluate this matrix at the nontrivial fixed point $(I^{\\ast}, Z^{\\ast})$:\n$$ J^{\\ast} = J(I^{\\ast}, Z^{\\ast}) = \\begin{pmatrix} \\gamma - 2\\beta I^{\\ast}  -\\alpha \\\\ s  -\\nu \\end{pmatrix} $$\nSubstituting the expression for $I^{\\ast}$:\n$$ J_{11}^{\\ast} = \\gamma - 2\\beta \\left( \\frac{1}{\\beta} \\left( \\gamma - \\frac{\\alpha s}{\\nu} \\right) \\right) = \\gamma - 2\\left(\\gamma - \\frac{\\alpha s}{\\nu}\\right) = -\\gamma + \\frac{2\\alpha s}{\\nu} $$\nSo the Jacobian matrix at the fixed point is:\n$$ J^{\\ast} = \\begin{pmatrix} -\\gamma + \\frac{2\\alpha s}{\\nu}  -\\alpha \\\\ s  -\\nu \\end{pmatrix} $$\n\nThe stability of the fixed point is determined by the eigenvalues of $J^{\\ast}$. A Hopf bifurcation occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. This corresponds to two conditions on the trace ($\\mathrm{Tr}$) and determinant ($\\mathrm{Det}$) of the Jacobian matrix:\n1. $\\mathrm{Tr}(J^{\\ast}) = 0$\n2. $\\mathrm{Det}(J^{\\ast}) > 0$\n\nThe trace of $J^{\\ast}$ is the sum of its diagonal elements:\n$$ \\mathrm{Tr}(J^{\\ast}) = \\left(-\\gamma + \\frac{2\\alpha s}{\\nu}\\right) + (-\\nu) = -\\gamma + \\frac{2\\alpha s}{\\nu} - \\nu $$\nThe determinant of $J^{\\ast}$ is:\n$$ \\mathrm{Det}(J^{\\ast}) = \\left(-\\gamma + \\frac{2\\alpha s}{\\nu}\\right)(-\\nu) - (-\\alpha)(s) = \\nu\\gamma - 2\\alpha s + \\alpha s = \\nu\\gamma - \\alpha s $$\n\nApplying the first condition for the Hopf bifurcation, $\\mathrm{Tr}(J^{\\ast}) = 0$, we find the critical value of the bifurcation parameter, $\\gamma_{\\mathrm{H}}$:\n$$ -\\gamma_{\\mathrm{H}} + \\frac{2\\alpha s}{\\nu} - \\nu = 0 $$\n$$ \\gamma_{\\mathrm{H}} = \\frac{2\\alpha s}{\\nu} - \\nu $$\n\nNow we apply the second condition, $\\mathrm{Det}(J^{\\ast}) > 0$, which must be satisfied at the bifurcation point, i.e., at $\\gamma = \\gamma_{\\mathrm{H}}$:\n$$ \\mathrm{Det}(J^{\\ast})|_{\\gamma=\\gamma_{\\mathrm{H}}} = \\nu \\gamma_{\\mathrm{H}} - \\alpha s > 0 $$\nSubstituting the expression for $\\gamma_{\\mathrm{H}}$:\n$$ \\nu \\left( \\frac{2\\alpha s}{\\nu} - \\nu \\right) - \\alpha s > 0 $$\n$$ 2\\alpha s - \\nu^2 - \\alpha s > 0 $$\n$$ \\alpha s - \\nu^2 > 0 $$\nThis inequality, $\\alpha s > \\nu^2$, is a necessary condition for a Hopf bifurcation to occur. It ensures that $\\mathrm{Det}(J^{\\ast}) > 0$ at the bifurcation point, as required. It also ensures that the nontrivial fixed point is physically meaningful ($I^* > 0$) at the bifurcation, since $\\gamma_{\\mathrm{H}} - \\frac{\\alpha s}{\\nu} = \\frac{\\alpha s - \\nu^2}{\\nu} > 0$. The stability of the fixed point depends on the sign of the trace, $\\mathrm{Tr}(J^{\\ast}) = \\gamma_{\\mathrm{H}} - \\gamma$. For $\\gamma  \\gamma_{\\mathrm{H}}$, the trace is positive, so the fixed point is unstable. For $\\gamma > \\gamma_{\\mathrm{H}}$, the trace is negative, and the fixed point becomes stable. The bifurcation at $\\gamma = \\gamma_{\\mathrm{H}}$ is where the fixed point gains stability as the drive parameter $\\gamma$ increases.\n\nThe problem asks for the single expression for $\\gamma_{\\mathrm{H}}$.\n$$ \\gamma_{\\mathrm{H}} = \\frac{2\\alpha s}{\\nu} - \\nu = \\frac{2\\alpha s - \\nu^2}{\\nu} $$",
            "answer": "$$ \\boxed{\\frac{2 \\alpha s - \\nu^{2}}{\\nu}} $$"
        },
        {
            "introduction": "Theoretical concepts and models become truly powerful when they can be connected to measurable data from simulations or experiments. This exercise bridges the gap between theory and computational practice by focusing on diagnostics for zonal flows. You will derive the relationship between the zonal flow's shearing rate, $\\gamma_s$, and its underlying electrostatic potential spectrum, $\\phi(k_x)$, and then implement this as a numerical diagnostic , a task central to the analysis of any turbulence simulation.",
            "id": "4209797",
            "problem": "You are given a spectral representation of the zonal component of the electrostatic potential in a magnetized plasma turbulence simulation. The zonal component is defined as the set of Fourier coefficients at poloidal wavenumber $k_y=0$, so that the potential depends only on the radial coordinate $x$. Define the zonal flow diagnostic amplitude as\n$$\nZ(t) = \\sum_{k_x} \\frac{|k_x \\,\\phi(k_x, k_y=0, t)|^2}{2},\n$$\nwhere $\\phi(k_x,k_y=0,t)$ are the complex Fourier coefficients of the potential at time $t$ and radial wavenumber $k_x$, and the sum is taken over all represented $k_x$ values. Use International System of Units (SI), so that $\\phi$ is expressed in $\\mathrm{V}$, $k_x$ in $\\mathrm{rad}\\,\\mathrm{m}^{-1}$, the magnetic field $B$ in $\\mathrm{T}$, and time in $\\mathrm{s}$.\n\nStarting from fundamental principles (the Lorentz force for a charged particle and the guiding-center Electric field cross magnetic field (E×B) drift in SI, $ \\mathbf{v}_{E} = \\mathbf{E}\\times\\mathbf{B} / B^2 $), and noting $ \\mathbf{E} = -\\nabla \\phi $ and that zonal flows have $k_y=0$, derive an expression for the root-mean-square shearing rate $\\gamma_s(t)$ in terms of the spectral coefficients $\\phi(k_x,k_y=0,t)$ and $B$. Then, implement a program to compute, for each test case listed below, the following at a fixed analysis time $t^\\star$:\n- The zonal flow amplitude $Z(t^\\star)$.\n- The root-mean-square shearing rate $\\gamma_s(t^\\star)$ in $\\mathrm{s}^{-1}$.\n- An approximate estimator for the shearing rate based on a single characteristic wavenumber,\n$$\nk_{\\mathrm{bar}}(t^\\star) = \\sqrt{ \\frac{ \\sum_{k_x} k_x^2 |\\phi(k_x,0,t^\\star)|^2 }{ \\sum_{k_x} |\\phi(k_x,0,t^\\star)|^2 } },\n$$\nand\n$$\n\\gamma_{s,\\mathrm{est}}(t^\\star) = \\frac{1}{B}\\,\\sqrt{2\\,Z(t^\\star)}\\,k_{\\mathrm{bar}}(t^\\star).\n$$\n\nFinally, report the relative error of this estimator compared to the exact shearing rate,\n$$\n\\epsilon = \\frac{\\gamma_{s,\\mathrm{est}}(t^\\star) - \\gamma_s(t^\\star)}{\\gamma_s(t^\\star)},\n$$\nexpressed as a decimal (not a percentage). If $\\gamma_s(t^\\star)=0$, define $\\epsilon=0$.\n\nYour program should compute the requested quantities for the following test suite of three cases and produce a single line of output containing the results as a comma-separated list of triplets, in the exact format:\n$$\n\\text{Output: } [[Z_1,\\gamma_1,\\epsilon_1],[Z_2,\\gamma_2,\\epsilon_2],[Z_3,\\gamma_3,\\epsilon_3]].\n$$\nAll $Z_i$ must be in $\\mathrm{V}^2\\,\\mathrm{m}^{-2}$ and all $\\gamma_i$ in $\\mathrm{s}^{-1}$.\n\nTest Suite:\n1. Case A (single-mode zonal flow):\n   - Magnetic field: $B=2.0\\,\\mathrm{T}$.\n   - Analysis time: $t^\\star=0.15\\,\\mathrm{s}$.\n   - Radial wavenumbers: $k_x \\in \\{-2.0, 0.0, 2.0\\}\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$.\n   - Spectral coefficients at $t^\\star$: $\\phi(-2.0,0,t^\\star)=5.0\\,e^{-i\\,0.2}\\,\\mathrm{V}$, $\\phi(0.0,0,t^\\star)=0\\,\\mathrm{V}$, $\\phi(2.0,0,t^\\star)=5.0\\,e^{i\\,0.2}\\,\\mathrm{V}$.\n\n2. Case B (narrow-band, bimodal spectrum):\n   - Magnetic field: $B=3.0\\,\\mathrm{T}$.\n   - Analysis time: $t^\\star=0.20\\,\\mathrm{s}$.\n   - Radial wavenumbers: $k_x \\in \\{-3.0,-2.0,-1.0,0.0,1.0,2.0,3.0\\}\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$.\n   - Spectral coefficients at $t^\\star$: define an amplitude envelope\n     $$\n     A(k_x) = 3.0\\,\\exp\\!\\left(-\\frac{\\min\\{(k_x-1.5)^2,(k_x+1.5)^2\\}}{2\\,\\sigma^2}\\right),\\quad \\sigma=0.5\\,\\mathrm{rad}\\,\\mathrm{m}^{-1},\n     $$\n     and a deterministic phase $\\theta(k_x)=0.1\\,k_x\\,\\mathrm{rad}$. Set $\\phi(k_x,0,t^\\star)=A(k_x)\\,e^{i\\,\\theta(k_x)}\\,\\mathrm{V}$ for each listed $k_x$.\n\n3. Case C (null field):\n   - Magnetic field: $B=1.5\\,\\mathrm{T}$.\n   - Analysis time: $t^\\star=0.10\\,\\mathrm{s}$.\n   - Radial wavenumbers: $k_x \\in \\{-1.0,0.0,1.0\\}\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$.\n   - Spectral coefficients at $t^\\star$: $\\phi(k_x,0,t^\\star)=0\\,\\mathrm{V}$ for all listed $k_x$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case represented by a triplet in the order $[Z_i,\\gamma_i,\\epsilon_i]$. No other output should be printed.",
            "solution": "The starting point is the Lorentz force $\\mathbf{F}=q(\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})$, and, for strongly magnetized plasmas in the guiding-center approximation, the lowest-order drift is the Electric field cross magnetic field (E×B) drift. In International System of Units (SI), the E×B drift velocity is\n$$\n\\mathbf{v}_{E} = \\frac{\\mathbf{E}\\times\\mathbf{B}}{B^2}.\n$$\nFor a purely zonal component of the potential, the potential depends only on the radial coordinate $x$, so $\\phi=\\phi(x,t)$. The electric field is $\\mathbf{E}=-\\nabla\\phi = -(\\partial \\phi/\\partial x)\\,\\hat{\\mathbf{x}}$. Assuming the magnetic field is $\\mathbf{B}=B\\,\\hat{\\mathbf{z}}$, the cross product gives $\\mathbf{E}\\times\\mathbf{B} = -(\\partial \\phi/\\partial x)\\hat{\\mathbf{x}} \\times B\\hat{\\mathbf{z}} = (\\partial \\phi/\\partial x) B \\hat{\\mathbf{y}}$. Thus the E×B drift is purely in the poloidal direction:\n$$\nv_y(x,t) = \\frac{1}{B^2} (\\partial \\phi/\\partial x) B = \\frac{1}{B}\\frac{\\partial \\phi(x,t)}{\\partial x}.\n$$\nThe shearing rate is the radial derivative of the poloidal velocity:\n$$\n\\gamma_s(x,t) = \\frac{\\partial v_y}{\\partial x} = \\frac{1}{B}\\frac{\\partial^2 \\phi(x,t)}{\\partial x^2}.\n$$\nTo relate this to spectral coefficients, we represent the zonal potential as a Fourier sum over radial wavenumbers,\n$$\n\\phi(x,t) = \\sum_{k_x} \\phi(k_x,0,t)\\,e^{i k_x x}.\n$$\nTaking the second derivative yields:\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} = \\sum_{k_x} (i k_x)^2\\,\\phi(k_x,0,t)\\,e^{i k_x x} = -\\sum_{k_x} k_x^2\\,\\phi(k_x,0,t)\\,e^{i k_x x}.\n$$\nTherefore, the shearing rate in spectral form is:\n$$\n\\gamma_s(x,t) = -\\frac{1}{B}\\sum_{k_x} k_x^2\\,\\phi(k_x,0,t)\\,e^{i k_x x}.\n$$\nWe define the root-mean-square (rms) shearing rate by spatial averaging over a domain of length $L$ in $x$:\n$$\n\\gamma_{s,\\mathrm{rms}}^2(t) \\equiv \\frac{1}{L}\\int_0^L |\\gamma_s(x,t)|^2\\,dx.\n$$\nUsing Parseval's theorem, which relates the integral of a squared function to the sum of its squared Fourier coefficients, the rms value is\n$$\n\\gamma_{s,\\mathrm{rms}}^2(t) = \\sum_{k_x} \\left|-\\frac{1}{B}k_x^2\\,\\phi(k_x,0,t)\\right|^2 = \\frac{1}{B^2}\\sum_{k_x} k_x^4\\,|\\phi(k_x,0,t)|^2.\n$$\nThus, the rms shearing rate is:\n$$\n\\gamma_s(t) \\equiv \\gamma_{s,\\mathrm{rms}}(t) = \\frac{1}{B}\\sqrt{\\sum_{k_x} k_x^4\\,|\\phi(k_x,0,t)|^2}.\n$$\nNow consider the zonal flow diagnostic amplitude,\n$$\nZ(t) = \\sum_{k_x} \\frac{|k_x \\phi(k_x,0,t)|^2}{2} = \\frac{1}{2}\\sum_{k_x} k_x^2\\,|\\phi(k_x,0,t)|^2.\n$$\nIntroduce a characteristic wavenumber $k_{\\mathrm{char}}$ such that\n$$\nk_{\\mathrm{char}}^2(t) \\equiv \\frac{\\sum_{k_x} k_x^4\\,|\\phi(k_x,0,t)|^2}{\\sum_{k_x} k_x^2\\,|\\phi(k_x,0,t)|^2}.\n$$\nWith this, the exact rms shearing rate can be written as\n$$\n\\gamma_s(t) = \\frac{1}{B}\\sqrt{\\sum_{k_x} k_x^4\\,|\\phi(k_x,0,t)|^2}\n= \\frac{1}{B}\\sqrt{k_{\\mathrm{char}}^2(t)\\sum_{k_x} k_x^2\\,|\\phi(k_x,0,t)|^2}\n= \\frac{1}{B}\\,\\sqrt{2\\,Z(t)}\\,k_{\\mathrm{char}}(t).\n$$\nThis shows that, for a given spectral shape, the shearing rate is proportional to $\\sqrt{Z(t)}$ and scaled by a characteristic radial wavenumber.\n\nIn practice, one may approximate $k_{\\mathrm{char}}$ by an energy-weighted mean wavenumber\n$$\nk_{\\mathrm{bar}}(t) \\equiv \\sqrt{ \\frac{ \\sum_{k_x} k_x^2 |\\phi(k_x,0,t)|^2 }{ \\sum_{k_x} |\\phi(k_x,0,t)|^2 } }.\n$$\nThis estimator equals $k_{\\mathrm{char}}$ only for special spectral shapes (e.g., single-mode), and introduces an approximation. The corresponding shearing estimate then reads\n$$\n\\gamma_{s,\\mathrm{est}}(t) = \\frac{1}{B}\\,\\sqrt{2\\,Z(t)}\\,k_{\\mathrm{bar}}(t).\n$$\nThe relative error of this estimator compared to the exact rms shearing rate is\n$$\n\\epsilon(t) = \\frac{\\gamma_{s,\\mathrm{est}}(t)-\\gamma_s(t)}{\\gamma_s(t)}.\n$$\n\nAlgorithm for computation at a fixed analysis time $t^\\star$ using discrete $k_x$ and $\\phi(k_x,0,t^\\star)$:\n1. Compute $Z(t^\\star) = \\frac{1}{2}\\sum_{k_x} k_x^2 |\\phi|^2$.\n2. Compute $\\gamma_s(t^\\star) = \\frac{1}{B}\\sqrt{\\sum_{k_x} k_x^4 |\\phi|^2}$.\n3. Compute $k_{\\mathrm{bar}}(t^\\star) = \\sqrt{\\frac{\\sum k_x^2 |\\phi|^2}{\\sum |\\phi|^2}}$, with $k_{\\mathrm{bar}}=0$ if the denominator vanishes.\n4. Compute $\\gamma_{s,\\mathrm{est}}(t^\\star) = \\frac{1}{B}\\sqrt{2 Z(t^\\star)}\\,k_{\\mathrm{bar}}(t^\\star)$.\n5. Compute $\\epsilon(t^\\star) = \\frac{\\gamma_{s,\\mathrm{est}}(t^\\star)-\\gamma_s(t^\\star)}{\\gamma_s(t^\\star)}$, setting $\\epsilon=0$ if $\\gamma_s(t^\\star)=0$.\n\nFor the test cases:\n- Case A (single mode at $k_x=\\pm 2\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$ with $|\\phi|=5\\,\\mathrm{V}$ and $B=2\\,\\mathrm{T}$) yields\n$$\nZ = \\tfrac{1}{2}\\left( (-2)^2(5^2) + (2^2)(5^2) \\right) = \\tfrac{1}{2}(200) = 100\\,\\mathrm{V}^2\\,\\mathrm{m}^{-2},\n$$\n$$\n\\gamma_s = \\frac{1}{2}\\sqrt{ (-2)^4(5^2) + (2)^4(5^2) } = \\frac{1}{2}\\sqrt{800} \\approx 14.1421356\\,\\mathrm{s}^{-1}.\n$$\nHere $k_{\\mathrm{bar}}=2\\,\\mathrm{rad}\\,\\mathrm{m}^{-1}$, and $\\gamma_{s,\\mathrm{est}}=\\gamma_s$, so $\\epsilon=0$.\n- Case B and Case C are computed numerically following the steps above. Case C yields $Z=0$, $\\gamma_s=0$, and $\\epsilon=0$ by definition.\n\nThe program implements these steps for each case and prints the requested single-line nested list in the specified order. All values are computed in SI units: $Z$ in $\\mathrm{V}^2\\,\\mathrm{m}^{-2}$, $\\gamma_s$ in $\\mathrm{s}^{-1}$, and $\\epsilon$ as a decimal.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_Z_gamma_and_error(kx, phi_k, B):\n    \"\"\"\n    Compute Z, exact gamma_s, and relative error of an estimator based on k_bar.\n\n    Parameters:\n        kx: numpy array of radial wavenumbers (rad/m)\n        phi_k: numpy array of complex spectral coefficients (V) at ky=0\n        B: magnetic field (Tesla)\n\n    Returns:\n        Z: float, zonal flow amplitude (V^2 m^-2)\n        gamma_exact: float, rms shearing rate (1/s)\n        rel_error: float, (gamma_est - gamma_exact)/gamma_exact; 0 if gamma_exact == 0\n    \"\"\"\n    abs2_phi = np.abs(phi_k)**2\n    kx2 = kx**2\n    kx4 = kx2**2\n\n    # Z = 0.5 * sum(kx^2 * |phi|^2)\n    Z = 0.5 * float(np.sum(kx2 * abs2_phi))\n\n    # Exact gamma_s = (1/B) * sqrt( sum(kx^4 * |phi|^2) )\n    sum_k4 = float(np.sum(kx4 * abs2_phi))\n    gamma_exact = (1.0 / B) * np.sqrt(sum_k4)\n\n    # k_bar = sqrt( sum(kx^2 |phi|^2) / sum(|phi|^2) ), handle zero denom\n    sum_k2 = float(np.sum(kx2 * abs2_phi))\n    sum_abs2 = float(np.sum(abs2_phi))\n    if sum_abs2  0.0:\n        k_bar = np.sqrt(sum_k2 / sum_abs2)\n    else:\n        k_bar = 0.0\n\n    # Estimator gamma_est = (1/B) * sqrt(2 Z) * k_bar\n    gamma_est = (1.0 / B) * np.sqrt(2.0 * Z) * k_bar\n\n    # Relative error\n    if gamma_exact  0.0:\n        rel_error = (gamma_est - gamma_exact) / gamma_exact\n    else:\n        rel_error = 0.0\n\n    return Z, gamma_exact, rel_error\n\ndef format_nested_list(list_of_triplets, decimals=6):\n    \"\"\"\n    Format a list of triplets into a single-line string with no spaces,\n    like [[a,b,c],[d,e,f],...], with each number formatted to 'decimals' places.\n    \"\"\"\n    def fmt(x):\n        # Ensure finite numbers; for safety, cast to float\n        return f\"{float(x):.{decimals}f}\"\n    inner = []\n    for triplet in list_of_triplets:\n        inner.append(\"[\" + \",\".join(fmt(v) for v in triplet) + \"]\")\n    return \"[\" + \",\".join(inner) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Case A: Single-mode zonal flow\n    B_A = 2.0  # Tesla\n    t_star_A = 0.15  # s (unused directly, but specified)\n    kx_A = np.array([-2.0, 0.0, 2.0], dtype=float)  # rad/m\n    # Spectral coefficients at t*, in Volts\n    phi_A = np.array([5.0 * np.exp(-1j * 0.2), 0.0 + 0.0j, 5.0 * np.exp(1j * 0.2)], dtype=complex)\n\n    # Case B: Narrow-band, bimodal spectrum\n    B_B = 3.0  # Tesla\n    t_star_B = 0.20  # s\n    kx_B = np.array([-3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0], dtype=float)  # rad/m\n    A0 = 3.0  # Volts\n    sigma = 0.5  # rad/m\n    # Amplitude envelope around +/- 1.5 rad/m\n    def A_env(k):\n        return A0 * np.exp(-min((k - 1.5)**2, (k + 1.5)**2) / (2.0 * sigma**2))\n    # Deterministic phase theta(k) = 0.1 * k (radians)\n    theta = 0.1\n    phi_B = np.array([A_env(k) * np.exp(1j * theta * k) for k in kx_B], dtype=complex)\n\n    # Case C: Null field\n    B_C = 1.5  # Tesla\n    t_star_C = 0.10  # s\n    kx_C = np.array([-1.0, 0.0, 1.0], dtype=float)  # rad/m\n    phi_C = np.zeros_like(kx_C, dtype=complex)  # all zero Volts\n\n    # Compute results\n    results = []\n    Z_A, gamma_A, err_A = compute_Z_gamma_and_error(kx_A, phi_A, B_A)\n    Z_B, gamma_B, err_B = compute_Z_gamma_and_error(kx_B, phi_B, B_B)\n    Z_C, gamma_C, err_C = compute_Z_gamma_and_error(kx_C, phi_C, B_C)\n\n    results.append((Z_A, gamma_A, err_A))\n    results.append((Z_B, gamma_B, err_B))\n    results.append((Z_C, gamma_C, err_C))\n\n    # Final print statement in the exact required format.\n    print(format_nested_list(results, decimals=6))\n\nsolve()\n```"
        }
    ]
}