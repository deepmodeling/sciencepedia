{
    "hands_on_practices": [
        {
            "introduction": "To understand turbulent transport, we must first understand the resonant interaction between waves and individual particles. This foundational exercise guides you through the core mathematical machinery of quasilinear theory, deriving the velocity-space diffusion that arises from these interactions. By accounting for a particle's helical motion in a magnetic field, you will see how Finite Larmor Radius (FLR) effects naturally emerge, leading to the discrete resonance conditions $\\omega - k_{\\parallel}v_{\\parallel} - n\\Omega = 0$ and the coupling between the wave's spatial scale and the particle's gyroradius via Bessel functions. ",
            "id": "4198789",
            "problem": "Consider a uniform, time-independent magnetic field $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$ and a single, monochromatic, electrostatic fluctuation described by the scalar potential $\\phi(\\mathbf{r},t) = \\Re\\{\\Phi\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\}$, with constant complex amplitude $\\Phi$, wavevector $\\mathbf{k} = \\mathbf{k}_{\\perp} + k_{\\parallel}\\,\\hat{\\mathbf{z}}$, and angular frequency $\\omega$. A trace species with charge $q$ and mass $m$ moves under the Lorentz force in the unperturbed, helical orbit generated by $\\mathbf{B}_{0}$: the parallel velocity $v_{\\parallel}$ is constant and the perpendicular motion is circular with cyclotron frequency $\\Omega \\equiv q B_{0}/m$, perpendicular speed $v_{\\perp}$, and Larmor radius $\\rho \\equiv v_{\\perp}/\\Omega$. \n\nWithin Quasi-Linear (QL) theory, the parallel velocity-space diffusion coefficient $D_{\\parallel\\parallel}(v_{\\parallel},v_{\\perp})$ is defined as the long-time integral of the autocorrelation of the parallel acceleration evaluated along unperturbed orbits, under the assumptions of random phases and statistical homogeneity of the fluctuation. Finite Larmor Radius (FLR) effects enter through the dependence of the field along the helical orbit on the gyrophase. \n\nStarting from the Lorentz force and the unperturbed orbit, and using only base definitions and well-tested identities (including the Fourier–Bessel decomposition of $\\exp[i\\,\\mathbf{k}_{\\perp}\\cdot\\boldsymbol{\\rho}(t)]$ into cylindrical Bessel functions $J_{n}$), derive the closed-form analytic expression for the cyclotron-harmonic ($n\\neq 0$) contribution to $D_{\\parallel\\parallel}(v_{\\parallel},v_{\\perp})$ for this single mode, retaining FLR effects through $J_{n}(k_{\\perp}\\rho)$ and the resonance condition. Express your final answer explicitly in terms of $q$, $m$, $k_{\\parallel}$, $\\omega$, $B_{0}$, $|\\Phi|$, $v_{\\parallel}$, $v_{\\perp}$, and standard special functions, after gyroangle averaging and in the long-time limit. \n\nYour final answer must be a single closed-form analytic expression. No numerical evaluation or rounding is required.",
            "solution": "The problem asks for the cyclotron-harmonic contribution to the quasilinear parallel velocity-space diffusion coefficient, $D_{\\parallel\\parallel}$, for a single electrostatic mode. We begin from the fundamental definitions and derive the expression step-by-step.\n\nThe parallel diffusion coefficient is defined as the time integral of the autocorrelation of the parallel acceleration, evaluated along the unperturbed particle orbits:\n$$D_{\\parallel\\parallel} = \\int_{0}^{\\infty} \\langle a_{\\parallel}(t_{0}) a_{\\parallel}(t_{0}+\\tau) \\rangle \\, d\\tau$$\nThe angle brackets $\\langle \\cdot \\rangle$ denote an ensemble average over the statistical properties of the turbulence, which in this case of a single mode with amplitude $\\Phi = |\\Phi| \\exp(i\\delta)$, corresponds to an average over the random phase $\\delta$ and the initial particle gyrophase $\\alpha$. Due to statistical stationarity, the correlation function is independent of the initial time $t_{0}$, which we set to $0$ for convenience.\n\nFirst, we determine the parallel acceleration $a_{\\parallel}$. The force on a particle with charge $q$ and mass $m$ is the Lorentz force, $\\mathbf{F} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$. The fluctuation is electrostatic, so the electric field is $\\mathbf{E} = -\\nabla\\phi$. The problem provides the potential $\\phi(\\mathbf{r},t) = \\Re\\{\\Phi\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\}$.\nIt is computationally more convenient to work with the complex potential $\\phi_{c}(\\mathbf{r},t) = \\Phi\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]$ and take the real part at the end. The complex electric field is $\\mathbf{E}_{c} = -\\nabla\\phi_{c} = -i\\mathbf{k}\\,\\phi_{c}$.\nThe parallel component of the electric field is $E_{\\parallel, c} = \\mathbf{E}_{c} \\cdot \\hat{\\mathbf{z}} = -i(\\mathbf{k} \\cdot \\hat{\\mathbf{z}})\\phi_{c} = -i k_{\\parallel} \\phi_{c}$.\nThe parallel acceleration is then $a_{\\parallel, c}(t) = \\frac{q}{m} E_{\\parallel, c} = -i\\frac{q k_{\\parallel}}{m} \\Phi \\exp[i(\\mathbf{k}\\cdot\\mathbf{r}(t) - \\omega t)]$.\nThe physical acceleration is $a_{\\parallel}(t) = \\Re\\{a_{\\parallel, c}(t)\\}$.\n\nNext, we describe the unperturbed particle orbit $\\mathbf{r}(t)$ in the uniform magnetic field $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$. The motion consists of a constant parallel velocity $v_{\\parallel}$ and a circular gyromotion in the perpendicular plane. The orbit can be described as:\n$$\\mathbf{r}(t) = \\mathbf{R}_{GC} + v_{\\parallel} t \\hat{\\mathbf{z}} + \\boldsymbol{\\rho}(t)$$\nwhere $\\mathbf{R}_{GC}$ is the initial guiding center position and $\\boldsymbol{\\rho}(t)$ is the Larmor radius vector. We can set the origin such that $\\mathbf{R}_{GC}=\\mathbf{0}$. To evaluate $\\mathbf{k}_{\\perp}\\cdot\\boldsymbol{\\rho}(t)$, we can align our coordinate system such that $\\mathbf{k}_{\\perp}$ is along the $y$-axis, i.e., $\\mathbf{k}_{\\perp} = k_{\\perp}\\hat{\\mathbf{y}}$, without loss of generality. The gyromotion is described by $\\boldsymbol{\\rho}(t) = \\rho (\\sin(\\Omega t + \\alpha)\\hat{\\mathbf{x}} + \\cos(\\Omega t + \\alpha)\\hat{\\mathbf{y}})$, where $\\Omega = qB_{0}/m$ is the cyclotron frequency, $\\rho = v_{\\perp}/|\\Omega|$ is the Larmor radius, and $\\alpha$ is the initial gyrophase. The problem defines $\\rho=v_{\\perp}/\\Omega$, which we will use, noting that $J_{n}^{2}(x)=J_{n}^{2}(-x)$.\nThe scalar product is then $\\mathbf{k}_{\\perp}\\cdot\\boldsymbol{\\rho}(t) = k_{\\perp}\\rho\\cos(\\Omega t + \\alpha)$. The phase of the wave along the unperturbed orbit is:\n$$\\mathbf{k}\\cdot\\mathbf{r}(t) - \\omega t = k_{\\parallel}v_{\\parallel}t + k_{\\perp}\\rho\\cos(\\Omega t + \\alpha) - \\omega t$$\n\nWe now use the Fourier-Bessel (Jacobi-Anger) identity, $\\exp(iz\\cos\\beta) = \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(z)\\exp(in\\beta)$, where $J_{n}$ is the Bessel function of the first kind of order $n$. Applying this to our phase term with $z = k_{\\perp}\\rho$ and $\\beta = \\Omega t + \\alpha$:\n$$\\exp[ik_{\\perp}\\rho\\cos(\\Omega t + \\alpha)] = \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(k_{\\perp}\\rho) \\exp[in(\\Omega t + \\alpha)]$$\nSubstituting this into the expression for $a_{\\parallel, c}(t)$:\n$$a_{\\parallel, c}(t) = -i\\frac{q k_{\\parallel}\\Phi}{m} \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(k_{\\perp}\\rho) \\exp[i(k_{\\parallel}v_{\\parallel}t + n\\Omega t + n\\alpha - \\omega t)]$$\n$$a_{\\parallel, c}(t) = \\frac{q k_{\\parallel}\\Phi}{m} \\sum_{n=-\\infty}^{\\infty} i^{n-1} J_{n}(k_{\\perp}\\rho) \\exp[i((k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega)t + n\\alpha)]$$\nThe autocorrelation function for real quantities can be related to the complex ones by $C(\\tau) = \\langle \\Re\\{a_{\\parallel, c}(0)\\} \\Re\\{a_{\\parallel, c}(\\tau)\\} \\rangle = \\frac{1}{2}\\Re\\{\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle\\}$, because terms like $\\langle \\Phi \\Phi \\rangle$ average to zero over the random phase $\\delta$.\n$$a_{\\parallel, c}^{*}(0) = \\frac{q k_{\\parallel}\\Phi^{*}}{m} \\sum_{l=-\\infty}^{\\infty} (-i)^{l-1} J_{l}(k_{\\perp}\\rho) \\exp(-il\\alpha)$$\n$$a_{\\parallel, c}(\\tau) = \\frac{q k_{\\parallel}\\Phi}{m} \\sum_{n=-\\infty}^{\\infty} i^{n-1} J_{n}(k_{\\perp}\\rho) \\exp[i((k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega)\\tau + n\\alpha)]$$\nThe product is:\n$$\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle = \\left(\\frac{q k_{\\parallel}}{m}\\right)^{2} \\langle |\\Phi|^{2} \\rangle \\sum_{n,l} (-i)^{l-1} i^{n-1} J_{l}J_{n} \\exp[i\\omega_{n}\\tau] \\langle \\exp[i(n-l)\\alpha] \\rangle$$\nwhere we've defined the resonance frequency $\\omega_{n} = k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega$. The average over the initial gyrophase $\\alpha$ yields $\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\exp[i(n-l)\\alpha]d\\alpha = \\delta_{nl}$, where $\\delta_{nl}$ is the Kronecker delta. This collapses the double summation to a single sum with $n=l$.\n$$\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle = \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} (-i)^{n-1} i^{n-1} J_{n}^{2}(k_{\\perp}\\rho) \\exp(i\\omega_{n}\\tau)$$\nThe factor $(-i)^{n-1} i^{n-1} = ((-i)i)^{n-1} = 1^{n-1} = 1$. The expression simplifies to:\n$$\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle = \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\exp(i\\omega_{n}\\tau)$$\nThe autocorrelation function is then:\n$$C(\\tau) = \\frac{1}{2}\\Re\\left\\{\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle\\right\\} = \\frac{1}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\cos(\\omega_{n}\\tau)$$\nNow, we integrate $C(\\tau)$ to find $D_{\\parallel\\parallel}$:\n$$D_{\\parallel\\parallel} = \\int_{0}^{\\infty} C(\\tau) \\, d\\tau = \\frac{1}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\int_{0}^{\\infty}\\cos(\\omega_{n}\\tau) \\, d\\tau$$\nThe time integral represents the resonance condition. In the long-time limit, it evaluates to a Dirac delta function: $\\int_{0}^{\\infty} \\cos(\\omega' \\tau)d\\tau = \\pi \\delta(\\omega')$.\n$$D_{\\parallel\\parallel} = \\frac{\\pi}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\delta(\\omega_{n})$$\nSubstituting $\\omega_{n} = k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega$ and using the property $\\delta(-x)=\\delta(x)$:\n$$D_{\\parallel\\parallel}(v_{\\parallel}, v_{\\perp}) = \\frac{\\pi}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\delta(\\omega - k_{\\parallel}v_{\\parallel} - n\\Omega)$$\nThe problem asks for the cyclotron-harmonic contribution, which corresponds to all terms with $n \\neq 0$. The $n=0$ term corresponds to Landau damping.\n$$D_{\\parallel\\parallel, n \\neq 0} = \\frac{\\pi}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n \\in \\mathbb{Z}, n\\neq 0} J_{n}^{2}(k_{\\perp}\\rho) \\delta(\\omega - k_{\\parallel}v_{\\parallel} - n\\Omega)$$\nFinally, we substitute the given definitions $\\Omega = q B_{0}/m$ and $\\rho = v_{\\perp}/\\Omega = v_{\\perp}m/(qB_{0})$ to express the result in terms of the specified variables.\n$$D_{\\parallel\\parallel, n \\neq 0} = \\frac{\\pi q^2 k_{\\parallel}^2 |\\Phi|^2}{2m^2} \\sum_{\\substack{n \\in \\mathbb{Z} \\\\ n\\neq 0}} J_n^2\\left(\\frac{k_{\\perp} v_{\\perp} m}{q B_0}\\right) \\delta\\left(\\omega - k_{\\parallel}v_{\\parallel} - n \\frac{q B_0}{m}\\right)$$\nThis is the final expression for the cyclotron-harmonic contribution to the parallel diffusion coefficient.",
            "answer": "$$\\boxed{\\frac{\\pi q^{2} k_{\\parallel}^{2} |\\Phi|^{2}}{2m^{2}} \\sum_{\\substack{n \\in \\mathbb{Z} \\\\ n\\neq 0}} J_{n}^{2}\\left(\\frac{k_{\\perp} v_{\\perp} m}{q B_{0}}\\right) \\delta\\left(\\omega - k_{\\parallel}v_{\\parallel} - n \\frac{q B_{0}}{m}\\right)}$$"
        },
        {
            "introduction": "In a high-temperature plasma, particles are not just pushed around by electric fields; they can also be transported by streaming along perturbed magnetic field lines. This practice challenges you to apply the quasilinear framework to compare two distinct transport channels: the electrostatic $E \\times B$ drift and the electromagnetic \"magnetic flutter\". By deriving the diffusivity for each mechanism and calculating their ratio, you will uncover a fundamental scaling law that illustrates the power of quasilinear theory to provide critical physical insights. This exercise reveals how a key dimensionless parameter, the ion plasma beta ($\\beta_i$), governs the transition from an electrostatically to an electromagnetically dominated transport regime. ",
            "id": "4198745",
            "problem": "Consider a homogeneous, stationary slab plasma with a uniform background magnetic field $ \\mathbf{B}_0 = B \\hat{\\mathbf{z}} $. Turbulent fluctuations are composed of Fourier modes with perpendicular wavevector $ \\mathbf{k}_{\\perp} = (k_x, k_y) $ and a prescribed, angle-isotropic electrostatic potential spectrum. Assume the following:\n\n- The electrostatic potential fluctuation spectrum is $|\\phi_{\\mathbf{k}}|^2 = C k_{\\perp}^{-p}$ for $ k_0 \\le k_{\\perp} \\le k_1 $, with $ C $, $ p $, $ k_0 $, and $ k_1 $ independent of $ \\beta $ and time, and with a uniform distribution of the perpendicular wavevector angle so that $\\langle k_y^2 \\rangle_{\\theta} = k_{\\perp}^2 / 2$ after angular averaging.\n\n- The turbulence decorrelation time $ \\tau_{\\mathbf{k}} $ is the same for the electrostatic and electromagnetic contributions at each $ \\mathbf{k} $, because both arise from the same underlying mode lifetime. No explicit form of $ \\tau_{\\mathbf{k}} $ is required beyond this equality.\n\n- The quasilinear radial diffusivity for passive guiding-center transport is constructed from the velocity autocorrelation as $ D = \\int d^2 k_{\\perp} \\, \\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle \\, \\tau_{\\mathbf{k}} $, under the random-phase approximation.\n\n- The radial electric field cross magnetic field (E×B) drift is $ \\mathbf{v}_{E} = \\mathbf{E} \\times \\mathbf{B}_0 / B^2 $ with $ \\mathbf{E} = - \\nabla \\phi $. The radial component for a single Fourier mode is $v_{r,E}(\\mathbf{k}) = -i k_y \\phi_{\\mathbf{k}} / B$.\n\n- The magnetic flutter radial velocity is $ v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\, \\delta B_r(\\mathbf{k}) / B $, where $ \\delta \\mathbf{B} = \\nabla \\times (A_{\\parallel} \\hat{\\mathbf{z}}) $. The radial component of the perturbed magnetic field is $\\delta B_r(\\mathbf{k}) = i k_y A_{\\parallel, \\mathbf{k}}$. For the electromagnetic coupling, take vanishing parallel electric field $ E_{\\parallel} \\approx 0 $, so that Faraday’s law implies in Fourier space $ \\omega A_{\\parallel, \\mathbf{k}} = k_{\\parallel} \\phi_{\\mathbf{k}} $. Furthermore, assume an Alfvénic dispersion $ \\omega = k_{\\parallel} v_A $, where the Alfvén speed is $ v_A = B / \\sqrt{\\mu_0 n_i m_i} $, with $ \\mu_0 $ the vacuum permeability, $ n_i $ the ion density, and $ m_i $ the ion mass. Under these assumptions, $A_{\\parallel, \\mathbf{k}} = \\phi_{\\mathbf{k}} / v_A$, hence $\\delta B_r(\\mathbf{k}) / B = i k_y \\phi_{\\mathbf{k}} / (B v_A)$.\n\n- Consider ion guiding-center transport. Take the parallel-velocity average over a Maxwellian ion distribution with temperature $ T_i $, for which $\\langle v_{\\parallel}^2 \\rangle = T_i / m_i$.\n\nDefine the ion plasma beta as $\\beta_i = 2 \\mu_0 n_i T_i / B^2$. Using only the stated assumptions and definitions, evaluate the ratio $ R(\\beta_i) $ of the quasilinear magnetic-flutter diffusivity to the quasilinear electrostatic E×B diffusivity, integrated over the given spectrum. Your final answer must be a single closed-form analytic expression for $ R(\\beta_i) $ in terms of $\\beta_i$. Do not include units in your final answer.",
            "solution": "The problem asks for the ratio $R(\\beta_i)$ of the quasilinear magnetic-flutter diffusivity, $D_B$, to the quasilinear electrostatic E×B diffusivity, $D_E$. The general form of the quasilinear radial diffusivity is given as:\n$$ D = \\int d^2 k_{\\perp} \\, \\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle \\, \\tau_{\\mathbf{k}} $$\nUnder the random-phase approximation, the correlation term is $\\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle = |v_r(\\mathbf{k})|^2$.\n\nFirst, we formulate the expression for the electrostatic E×B diffusivity, $D_E$. The radial velocity component for a single Fourier mode $\\mathbf{k}$ due to the E×B drift is given as $v_{r,E}(\\mathbf{k}) = -i k_y \\phi_{\\mathbf{k}} / B$. The squared magnitude is $|v_{r,E}(\\mathbf{k})|^2 = k_y^2 |\\phi_{\\mathbf{k}}|^2 / B^2$. Substituting this into the general diffusivity formula gives:\n$$ D_E = \\int d^2 k_{\\perp} \\, \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} $$\nThe integral is over the perpendicular wavevector space, $d^2 k_{\\perp} = k_{\\perp} dk_{\\perp} d\\theta$, where $\\theta$ is the angle of $\\mathbf{k}_{\\perp}$ in the plane. The problem specifies an angle-isotropic spectrum, and we can perform the angular integration. We use the identity $k_y = k_{\\perp} \\sin(\\theta)$. The quantities $|\\phi_{\\mathbf{k}}|^2$ and $\\tau_{\\mathbf{k}}$ are stated to be functions of $k_{\\perp}$ only. The angular integral is:\n$$ \\int_0^{2\\pi} k_y^2 d\\theta = \\int_0^{2\\pi} (k_{\\perp} \\sin(\\theta))^2 d\\theta = k_{\\perp}^2 \\int_0^{2\\pi} \\sin^2(\\theta) d\\theta = k_{\\perp}^2 \\pi $$\nThis is consistent with the provided relation $\\langle k_y^2 \\rangle_{\\theta} = \\frac{1}{2\\pi} \\int_0^{2\\pi} k_y^2 d\\theta = k_{\\perp}^2 / 2$.\nSubstituting this into the expression for $D_E$:\n$$ D_E = \\int_{k_0}^{k_1} k_{\\perp} dk_{\\perp} \\left( \\frac{(\\pi k_{\\perp}^2) |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} \\right) = \\frac{\\pi}{B^2} \\int_{k_0}^{k_1} k_{\\perp}^3 |\\phi_{\\mathbf{k}}|^2 \\tau_{\\mathbf{k}} dk_{\\perp} $$\n\nNext, we formulate the expression for the magnetic-flutter diffusivity, $D_B$. The radial velocity due to magnetic flutter is given as $v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\, \\delta B_r(\\mathbf{k}) / B$. The problem provides the sequence of assumptions leading to $\\delta B_r(\\mathbf{k}) / B = i k_y \\phi_{\\mathbf{k}} / (B v_A)$. Therefore, the velocity is:\n$$ v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\frac{i k_y \\phi_{\\mathbf{k}}}{B v_A} $$\nThe transport is for ion guiding-centers, so we must average the velocity-dependent transport over the ion parallel-velocity distribution, which is a Maxwellian with temperature $T_i$. For the diffusivity calculation, we need the average of the squared radial velocity:\n$$ \\langle |v_{r,B}(\\mathbf{k}, v_{\\parallel})|^2 \\rangle_{v_{\\parallel}} = \\left\\langle v_{\\parallel}^2 \\left| \\frac{i k_y \\phi_{\\mathbf{k}}}{B v_A} \\right|^2 \\right\\rangle_{v_{\\parallel}} = \\langle v_{\\parallel}^2 \\rangle_{v_{\\parallel}} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} $$\nWe are given $\\langle v_{\\parallel}^2 \\rangle_{v_{\\parallel}} = T_i / m_i$. Substituting this in gives:\n$$ \\langle |v_{r,B}(\\mathbf{k})|^2 \\rangle_{v_{\\parallel}} = \\frac{T_i}{m_i} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} $$\nThe magnetic-flutter diffusivity $D_B$ is then:\n$$ D_B = \\int d^2 k_{\\perp} \\, \\left( \\frac{T_i}{m_i} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} \\right) \\tau_{\\mathbf{k}} $$\nWe can factor out the terms that do not depend on $\\mathbf{k}_{\\perp}$:\n$$ D_B = \\frac{T_i}{m_i v_A^2} \\left[ \\int d^2 k_{\\perp} \\, \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} \\right] $$\nThe term in the square brackets is precisely the expression for the E×B diffusivity, $D_E$.\n$$ D_B = \\frac{T_i}{m_i v_A^2} D_E $$\n\nThe desired ratio $R(\\beta_i) = D_B / D_E$ can now be computed directly:\n$$ R(\\beta_i) = \\frac{D_B}{D_E} = \\frac{T_i}{m_i v_A^2} $$\nNote that this result is independent of the specific spectral shape $|\\phi_{\\mathbf{k}}|^2 = C k_{\\perp}^{-p}$ and the decorrelation time $\\tau_{\\mathbf{k}}$, as these common factors cancel in the ratio.\n\nTo express this ratio in terms of the ion plasma beta, $\\beta_i$, we substitute the definition of the Alfvén speed, $v_A = B / \\sqrt{\\mu_0 n_i m_i}$. The square of the Alfvén speed is:\n$$ v_A^2 = \\frac{B^2}{\\mu_0 n_i m_i} $$\nSubstituting this into the expression for the ratio $R$:\n$$ R(\\beta_i) = \\frac{T_i}{m_i \\left( \\frac{B^2}{\\mu_0 n_i m_i} \\right)} = \\frac{T_i \\mu_0 n_i m_i}{m_i B^2} = \\frac{\\mu_0 n_i T_i}{B^2} $$\nFinally, we use the definition of the ion plasma beta provided in the problem: $\\beta_i = 2 \\mu_0 n_i T_i / B^2$. By rearranging this definition, we find:\n$$ \\frac{\\mu_0 n_i T_i}{B^2} = \\frac{\\beta_i}{2} $$\nTherefore, the final expression for the ratio is:\n$$ R(\\beta_i) = \\frac{\\beta_i}{2} $$",
            "answer": "$$ \\boxed{\\frac{\\beta_i}{2}} $$"
        },
        {
            "introduction": "Real plasma turbulence consists of a broad spectrum of fluctuations, and the total transport is the integrated effect of all these modes. This problem bridges the gap between abstract theory and practical computation, asking you to calculate the total cross-field diffusivity by integrating over a modeled turbulence spectrum. You will implement the quasilinear diffusivity integral for a physically motivated spectrum and investigate how transport levels are affected by the characteristics of the most unstable modes. This hands-on numerical exercise builds concrete intuition for how the spectral properties of turbulence determine macroscopic transport, a central question in fusion energy science. ",
            "id": "4198778",
            "problem": "A plasma with ion sound Larmor radius $\\rho_{s}$ and ion cyclotron frequency $\\Omega_{i}$ exhibits electrostatic turbulence that drives cross-field transport via the electric cross magnetic drift (E×B). Consider a passive scalar subject to advection by E×B fluctuations. In the quasilinear approximation, the diffusivity is obtained by modeling turbulent displacements as a random walk with step velocity set by the E×B fluctuation amplitude and correlation time set by the linear decorrelation rate. Work in normalized units where lengths are scaled to $\\rho_{s}$ and times to $1/\\Omega_{i}$, so that diffusivity is reported in units of $\\rho_{s}^{2}\\Omega_{i}$.\n\nStarting from the definition of the E×B drift $\\mathbf{v}_{E} = \\frac{c}{B}\\,\\hat{\\mathbf{z}}\\times \\nabla \\phi$ and the normalized potential fluctuation amplitude $\\tilde{\\phi} \\equiv e\\phi/T_{e}$, the normalized E×B speed at wavenumber $k_{\\perp}$ satisfies $v_{E}/c_{s} \\sim k_{\\perp}\\rho_{s}\\,|\\tilde{\\phi}_{k}|$, where $c_{s} = \\sqrt{T_{e}/m_{i}}$ is the ion sound speed. In the quasilinear approximation with isotropic fluctuations, the normalized diffusivity can be represented as the spectral integral\n$$\n\\hat{D} \\equiv \\frac{D}{\\rho_{s}^{2}\\Omega_{i}} = \\int_{0}^{\\infty} 2\\pi s \\,\\mathrm{d}s\\; \\left[s^{2}\\,P(s)\\,\\hat{\\tau}(s)\\right],\n$$\nwhere $s \\equiv k_{\\perp}\\rho_{s}$ is the dimensionless perpendicular wavenumber, $P(s)$ is the dimensionless spectral density of normalized potential fluctuations (such that $2\\pi\\int_{0}^{\\infty} s\\,P(s)\\,\\mathrm{d}s$ equals the variance in $\\tilde{\\phi}$), and $\\hat{\\tau}(s)$ is the dimensionless correlation time in units of $1/\\Omega_{i}$.\n\nAssume a broadband spectrum with a superposed Gaussian peak near $s \\approx 0.3$ modeled as\n$$\nP(s) = A\\, s^{\\alpha}\\, \\exp\\!\\left[-\\left(\\frac{s}{s_{b}}\\right)^{p}\\right]\\left[1 + r\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma^{2}}\\right)\\right],\n$$\nand a decorrelation time determined by a growth-rate-peaked model\n$$\n\\hat{\\tau}(s) = \\frac{1}{\\hat{\\gamma}(s) + \\nu}, \\qquad \\hat{\\gamma}(s) = \\gamma_{0}\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma_{g}^{2}}\\right),\n$$\nwhere $A$, $\\alpha$, $s_{b}$, $p$ set the broadband background shape, $r$ controls the peak strength, $s_{0}$ is the peak location, $\\sigma$ is the spectral peak width, $\\gamma_{0}$ is the peak growth rate, $\\sigma_{g}$ is the growth-rate width, and $\\nu$ is a constant decorrelation rate representing additional shear or damping. All quantities are dimensionless in the stated normalization.\n\nYour task is to write a program that evaluates the integral for $\\hat{D}$ numerically using the above model over $s \\in [0,s_{\\max}]$ for the following test suite of parameter sets, designed to probe the influence of shifting the peak location and modifying peak width or decorrelation:\n\n- Case 1 (baseline happy path): $A = 0.8$, $\\alpha = 1.0$, $s_{b} = 2.0$, $p = 2$, $r = 2.0$, $s_{0} = 0.30$, $\\sigma = 0.07$, $\\gamma_{0} = 0.15$, $\\sigma_{g} = 0.08$, $\\nu = 0.05$, $s_{\\max} = 4.0$.\n- Case 2 (lower peak): same as Case 1 but $s_{0} = 0.20$.\n- Case 3 (higher peak): same as Case 1 but $s_{0} = 0.50$.\n- Case 4 (narrow spectral peak): same as Case 1 but $\\sigma = 0.03$.\n- Case 5 (strong shear decorrelation): same as Case 1 but $\\nu = 0.30$.\n- Case 6 (no added peak, pure broadband background): same as Case 1 but $r = 0.0$.\n\nAll integrals must be evaluated to produce floating-point values for $\\hat{D}$ in units of $\\rho_{s}^{2}\\Omega_{i}$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\") in the order of the cases listed above.\n\nRequirements:\n- Derive the quasilinear diffusivity from fundamental principles as stated.\n- Implement the numerical integration with adequate resolution to capture the spectrum and peak.\n- Express all results as floats in the specified units.\n- No angles are involved; do not use angle units.\n- No percentages are involved; do not use percentage signs.\n- The final printed output must exactly match the specified single-line format.\n\nFinally, in your solution, explain why shifting the peak $s_{0}$ modifies $\\hat{D}$ by referring to the structure of the integrand, in particular the $s^{2}$ weighting of the E×B speed and the dependence of $\\hat{\\tau}(s)$ on $\\hat{\\gamma}(s)$.",
            "solution": "The primary task is to compute the normalized quasilinear diffusivity, $\\hat{D}$, for a passive scalar advected by electrostatic turbulence. The diffusivity is given by the spectral integral:\n$$\n\\hat{D} \\equiv \\frac{D}{\\rho_{s}^{2}\\Omega_{i}} = \\int_{0}^{\\infty} 2\\pi s \\,\\mathrm{d}s\\; \\left[s^{2}\\,P(s)\\,\\hat{\\tau}(s)\\right]\n$$\nThis formula arises from a random walk model of transport where diffusivity is approximated as $D \\sim v_{\\text{eff}}^{2}\\tau_{c}$. Here, $v_{\\text{eff}}$ is an effective turbulent velocity and $\\tau_{c}$ is the turbulence correlation time. In the context of E×B turbulence, the velocity is the E×B drift, $\\mathbf{v}_{E} = \\frac{c}{B}\\hat{\\mathbf{z}}\\times \\nabla \\phi$. For a single Fourier mode with perpendicular wavenumber $k_{\\perp}$, the velocity magnitude is approximately $v_{E,k} \\sim k_{\\perp} \\phi_k$ (in appropriate units). The contribution to diffusivity from this mode is thus proportional to $(k_{\\perp} \\phi_k)^2 \\tau_k$, where $\\tau_k$ is the mode's correlation time.\n\nThe provided formula represents the total diffusivity, which is obtained by integrating these contributions over the entire wavenumber spectrum. In the given normalized units, the dimensionless wavenumber is $s \\equiv k_{\\perp}\\rho_{s}$. The term $s^2$ in the integrand reflects the $k_{\\perp}^2$ dependence of the squared E×B velocity. The function $P(s)$ is the spectral density of the normalized potential fluctuations $\\tilde{\\phi}$, representing the fluctuation power, $|\\tilde{\\phi}_s|^2$, at wavenumber $s$. The function $\\hat{\\tau}(s)$ is the dimensionless correlation time. The differential element $2\\pi s\\,\\mathrm{d}s$ is the area of an annular ring in a two-dimensional, isotropic wavenumber space. Rewriting the integral by combining terms, we must evaluate:\n$$\n\\hat{D} = \\int_{0}^{s_{\\max}} 2\\pi s^3 \\,P(s)\\,\\hat{\\tau}(s)\\,\\mathrm{d}s\n$$\nwhere the integral to infinity is approximated by an integral up to a sufficiently large wavenumber, $s_{\\max}$, beyond which the spectrum $P(s)$ becomes negligible. The specific functional forms for the spectrum $P(s)$ and the correlation time $\\hat{\\tau}(s)$ are provided:\n$$\nP(s) = A\\, s^{\\alpha}\\, \\exp\\!\\left[-\\left(\\frac{s}{s_{b}}\\right)^{p}\\right]\\left[1 + r\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma^{2}}\\right)\\right]\n$$\n$$\n\\hat{\\tau}(s) = \\frac{1}{\\hat{\\gamma}(s) + \\nu}, \\qquad \\text{where} \\qquad \\hat{\\gamma}(s) = \\gamma_{0}\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma_{g}^{2}}\\right)\n$$\nThe calculation is performed by implementing these functions and using a numerical quadrature algorithm to evaluate the definite integral for each of the six specified parameter sets. The `scipy.integrate.quad` function is suitable for this purpose, as it provides a robust adaptive algorithm capable of handling the peaked nature of the integrand.\n\nThe problem also requires an explanation of why shifting the spectral peak location, $s_{0}$, modifies the value of $\\hat{D}$. This can be understood by examining the structure of the integrand, $I(s) = 2\\pi s^3 P(s) \\hat{\\tau}(s)$.\n\n$1$. **Wavenumber Weighting**: The term $s^3$ in the integrand acts as a strong weighting factor. It is a product of the $s^2$ from the squared E×B velocity, $(v_E/c_s)^2 \\propto s^2$, and the $s$ from the radial integration measure in wavenumber space, $2\\pi s\\,\\mathrm{d}s$. This $s^3$ factor means that turbulent fluctuations at higher wavenumbers (larger $s$) are inherently more effective at driving transport, assuming all other factors are equal.\n\n$2$. **Spectral Power and Correlation Time**: The potential spectrum $P(s)$ and the linear growth rate $\\hat{\\gamma}(s)$ are both modeled with peaks centered at $s = s_{0}$. This means the turbulence is strongest in a localized region around $s_0$. However, the correlation time $\\hat{\\tau}(s) = 1/(\\hat{\\gamma}(s) + \\nu)$ is *shortest* near $s=s_0$, because a large growth rate leads to rapid decorrelation. This represents a self-regulation mechanism where the most unstable modes are also the most transient.\n\n$3$. **Combined Effect**: When $s_0$ is shifted, the peak of the turbulence spectrum $P(s)$ moves along the $s$-axis.\n- If $s_0$ is increased (e.g., from Case $1$'s $s_0 = 0.30$ to Case $3$'s $s_0 = 0.50$), the peak of $P(s)$ is shifted to a region where the $s^3$ weighting factor is significantly larger. For instance, $(0.50)^3 = 0.125$ is more than four times larger than $(0.30)^3 = 0.027$. This amplification effect generally dominates, leading to a substantial increase in the total integrated diffusivity $\\hat{D}$.\n- Conversely, if $s_0$ is decreased (from Case $1$'s $s_0 = 0.30$ to Case $2$'s $s_0 = 0.20$), the peak of $P(s)$ moves to a region of much smaller $s^3$ weighting. This results in a significant reduction in the total diffusivity $\\hat{D}$.\n\nTherefore, the location of the turbulence peak $s_0$ is a critical parameter in determining the overall transport level, primarily through its interplay with the strong $s^3$ weighting in the quasilinear diffusivity integral.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Calculates the quasilinear diffusivity for a series of test cases\n    by numerically integrating the specified model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a dictionary of parameters.\n    base_case = {\n        'A': 0.8, 'alpha': 1.0, 'sb': 2.0, 'p': 2, 'r': 2.0,\n        's0': 0.30, 'sigma': 0.07, 'gamma0': 0.15, 'sigmag': 0.08,\n        'nu': 0.05, 's_max': 4.0\n    }\n\n    test_cases = [\n        # Case 1 (baseline happy path)\n        base_case,\n        # Case 2 (lower peak)\n        {**base_case, 's0': 0.20},\n        # Case 3 (higher peak)\n        {**base_case, 's0': 0.50},\n        # Case 4 (narrow spectral peak)\n        {**base_case, 'sigma': 0.03},\n        # Case 5 (strong shear decorrelation)\n        {**base_case, 'nu': 0.30},\n        # Case 6 (no added peak, pure broadband background)\n        {**base_case, 'r': 0.0}\n    ]\n\n    results = []\n\n    for params in test_cases:\n        \n        # Unpack parameters for the current case\n        A = params['A']\n        alpha = params['alpha']\n        sb = params['sb']\n        p = params['p']\n        r = params['r']\n        s0 = params['s0']\n        sigma = params['sigma']\n        gamma0 = params['gamma0']\n        sigmag = params['sigmag']\n        nu = params['nu']\n        s_max = params['s_max']\n\n        # Define the functions for the integrand\n        \n        def p_spectrum(s):\n            \"\"\"\n            Calculates the dimensionless spectral density P(s).\n            \"\"\"\n            if s == 0.0 and alpha > 0:\n                return 0.0\n            \n            broadband_part = A * (s**alpha) * np.exp(-((s / sb)**p))\n            peak_part = 1.0 + r * np.exp(-((s - s0)**2) / (2 * sigma**2))\n            \n            return broadband_part * peak_part\n\n        def tau_corr(s):\n            \"\"\"\n            Calculates the dimensionless correlation time tau_hat(s).\n            \"\"\"\n            gamma_hat = gamma0 * np.exp(-((s - s0)**2) / (2 * sigmag**2))\n            return 1.0 / (gamma_hat + nu)\n\n        def integrand(s):\n            \"\"\"\n            Defines the full integrand for the diffusivity integral.\n            Integrand = 2 * pi * s^3 * P(s) * tau(s)\n            \"\"\"\n            return 2 * np.pi * (s**3) * p_spectrum(s) * tau_corr(s)\n\n        # Perform the numerical integration\n        # The quad function returns the integral and an error estimate. We only need the integral.\n        integral, _ = integrate.quad(integrand, 0, s_max)\n        \n        results.append(integral)\n\n    # Final print statement in the exact required format.\n    # The output should be a single line: a list of comma-separated floats\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}