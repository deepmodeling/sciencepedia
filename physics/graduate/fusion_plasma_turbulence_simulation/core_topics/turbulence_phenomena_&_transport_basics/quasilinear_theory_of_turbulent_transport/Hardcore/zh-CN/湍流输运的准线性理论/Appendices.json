{
    "hands_on_practices": [
        {
            "introduction": "准线性理论的核心在于将输运系数与湍流的谱特性联系起来。本练习提供了一个计算准线性扩散系数的具体实践，通过对给定的湍流波动谱进行数值积分，你将亲身体验如何从微观涨落的统计性质出发，定量地评估宏观输运的大小。这项练习不仅能加深你对准线性积分结构的理解，还能让你直观地看到湍流谱的峰值位置等关键特征如何决定输运效率。",
            "id": "4198778",
            "problem": "一个等离子体，其离子声拉莫尔半径为 $\\rho_{s}$，离子回旋频率为 $\\Omega_{i}$，表现出静电湍流，该湍流通过$E \\times B$漂移驱动跨场输运。考虑一个受 $E \\times B$ 涨落平流影响的被动标量。在准线性近似中，通过将湍流位移建模为随机行走来获得扩散系数，其中步长速度由 $E \\times B$ 涨落幅度设定，相关时间由线性退相关率设定。在归一化单位下进行计算，其中长度按 $\\rho_{s}$ 缩放，时间按 $1/\\Omega_{i}$ 缩放，因此扩散系数以 $\\rho_{s}^{2}\\Omega_{i}$ 为单位报告。\n\n从 $E \\times B$ 漂移的定义 $\\mathbf{v}_{E} = \\frac{c}{B}\\,\\hat{\\mathbf{z}}\\times \\nabla \\phi$ 和归一化电势涨落幅度 $\\tilde{\\phi} \\equiv e\\phi/T_{e}$ 出发，波数为 $k_{\\perp}$ 处的归一化 $E \\times B$ 速度满足 $v_{E}/c_{s} \\sim k_{\\perp}\\rho_{s}\\,|\\tilde{\\phi}_{k}|$，其中 $c_{s} = \\sqrt{T_{e}/m_{i}}$ 是离子声速。在各向同性涨落的准线性近似中，归一化扩散系数可以表示为谱积分\n$$\n\\hat{D} \\equiv \\frac{D}{\\rho_{s}^{2}\\Omega_{i}} = \\int_{0}^{\\infty} 2\\pi s \\,\\mathrm{d}s\\; \\left[s^{2}\\,P(s)\\,\\hat{\\tau}(s)\\right],\n$$\n其中 $s \\equiv k_{\\perp}\\rho_{s}$ 是无量纲垂直波数，$P(s)$ 是归一化电势涨落的无量纲谱密度（使得 $2\\pi\\int_{0}^{\\infty} s\\,P(s)\\,\\mathrm{d}s$ 等于 $\\tilde{\\phi}$ 的方差），$\\hat{\\tau}(s)$ 是以 $1/\\Omega_{i}$ 为单位的无量纲相关时间。\n\n假设一个宽带谱，其上叠加一个在 $s \\approx 0.3$ 附近的高斯峰，模型如下\n$$\nP(s) = A\\, s^{\\alpha}\\, \\exp\\!\\left[-\\left(\\frac{s}{s_{b}}\\right)^{p}\\right]\\left[1 + r\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma^{2}}\\right)\\right],\n$$\n以及一个由增长率峰值模型确定的退相关时间\n$$\n\\hat{\\tau}(s) = \\frac{1}{\\hat{\\gamma}(s) + \\nu}, \\qquad \\hat{\\gamma}(s) = \\gamma_{0}\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma_{g}^{2}}\\right),\n$$\n其中 $A$、$\\alpha$、$s_{b}$、$p$ 设定了宽带背景形状，$r$ 控制峰的强度，$s_{0}$ 是峰的位置，$\\sigma$ 是谱峰宽度，$\\gamma_{0}$ 是峰值增长率，$\\sigma_{g}$ 是增长率宽度，$\\nu$ 是一个代表额外剪切或阻尼的恒定退相关率。在所述的归一化体系中，所有量都是无量纲的。\n\n您的任务是编写一个程序，使用上述模型在 $s \\in [0,s_{\\max}]$ 范围内对 $\\hat{D}$ 的积分进行数值评估，针对以下参数集的测试套件，这些参数集旨在探究改变峰位置、修改峰宽或退相关的影响：\n\n- 案例1（基准理想情况）：$A = 0.8$, $\\alpha = 1.0$, $s_{b} = 2.0$, $p = 2$, $r = 2.0$, $s_{0} = 0.30$, $\\sigma = 0.07$, $\\gamma_{0} = 0.15$, $\\sigma_{g} = 0.08$, $\\nu = 0.05$, $s_{\\max} = 4.0$。\n- 案例2（较低峰值）：与案例1相同，但 $s_{0} = 0.20$。\n- 案例3（较高峰值）：与案例1相同，但 $s_{0} = 0.50$。\n- 案例4（窄谱峰）：与案例1相同，但 $\\sigma = 0.03$。\n- 案例5（强剪切退相关）：与案例1相同，但 $\\nu = 0.30$。\n- 案例6（无附加峰，纯宽带背景）：与案例1相同，但 $r = 0.0$。\n\n所有积分都必须被评估以产生以 $\\rho_{s}^{2}\\Omega_{i}$ 为单位的 $\\hat{D}$ 的浮点数值。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,...]\"），并按上述案例的顺序列出。\n\n要求：\n- 根据所述的基本原理推导出准线性扩散系数。\n- 以足够的分辨率实现数值积分，以捕捉谱和峰。\n- 所有结果都以指定单位的浮点数表示。\n- 不涉及角度；不要使用角度单位。\n- 不涉及百分比；不要使用百分号。\n- 最终打印的输出必须与指定的单行格式完全匹配。\n\n最后，在您的解答中，通过参考被积函数的结构，特别是 $E \\times B$ 速度的 $s^{2}$ 权重以及 $\\hat{\\tau}(s)$ 对 $\\hat{\\gamma}(s)$ 的依赖性，解释为什么移动峰值 $s_{0}$ 会改变 $\\hat{D}$。",
            "solution": "该问题陈述具有科学依据、提法恰当且客观。它提供了一套完整的方程、参数和条件，用于基于等离子体物理学中标准的准线性模型进行湍流扩散系数的数值计算。所有术语都得到了明确定义，其物理背景在聚变等离子体湍流领域中是标准的。因此，该问题被认为是有效的，并将提供解答。\n\n主要任务是计算由静电湍流平流的被动标量的归一化准线性扩散系数 $\\hat{D}$。扩散系数由谱积分给出：\n$$\n\\hat{D} \\equiv \\frac{D}{\\rho_{s}^{2}\\Omega_{i}} = \\int_{0}^{\\infty} 2\\pi s \\,\\mathrm{d}s\\; \\left[s^{2}\\,P(s)\\,\\hat{\\tau}(s)\\right]\n$$\n该公式源于输运的随机行走模型，其中扩散系数近似为 $D \\sim v_{\\text{eff}}^{2}\\tau_{c}$。此处，$v_{\\text{eff}}$ 是有效湍流速度，$\\tau_{c}$ 是湍流相关时间。在 $E \\times B$ 湍流的背景下，速度是 $E \\times B$ 漂移，$\\mathbf{v}_{E} = \\frac{c}{B}\\hat{\\mathbf{z}}\\times \\nabla \\phi$。对于具有垂直波数 $k_{\\perp}$ 的单个傅里叶模式，速度大小约为 $v_{E,k} \\sim k_{\\perp} \\phi_k$（在适当单位下）。因此，该模式对扩散系数的贡献与 $(k_{\\perp} \\phi_k)^2 \\tau_k$ 成正比，其中 $\\tau_k$ 是该模式的相关时间。\n\n所提供的公式代表总扩散系数，它是通过对整个波数谱上的这些贡献进行积分得到的。在给定的归一化单位中，无量纲波数为 $s \\equiv k_{\\perp}\\rho_{s}$。被积函数中的 $s^2$ 项反映了平方 $E \\times B$ 速度对 $k_{\\perp}^2$ 的依赖性。函数 $P(s)$ 是归一化电势涨落 $\\tilde{\\phi}$ 的谱密度，代表在波数 $s$ 处的涨落功率 $|\\tilde{\\phi}_s|^2$。函数 $\\hat{\\tau}(s)$ 是无量纲相关时间。微分元 $2\\pi s\\,\\mathrm{d}s$ 是二维各向同性波数空间中环形区域的面积。通过组合各项重写积分，我们必须评估：\n$$\n\\hat{D} = \\int_{0}^{s_{\\max}} 2\\pi s^3 \\,P(s)\\,\\hat{\\tau}(s)\\,\\mathrm{d}s\n$$\n其中，对无穷大的积分被近似为对一个足够大的波数 $s_{\\max}$ 的积分，超过该波数后，谱 $P(s)$ 变得可以忽略不计。谱 $P(s)$ 和相关时间 $\\hat{\\tau}(s)$ 的具体函数形式已给出：\n$$\nP(s) = A\\, s^{\\alpha}\\, \\exp\\!\\left[-\\left(\\frac{s}{s_{b}}\\right)^{p}\\right]\\left[1 + r\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma^{2}}\\right)\\right]\n$$\n$$\n\\hat{\\tau}(s) = \\frac{1}{\\hat{\\gamma}(s) + \\nu}, \\qquad \\text{其中} \\qquad \\hat{\\gamma}(s) = \\gamma_{0}\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma_{g}^{2}}\\right)\n$$\n计算过程通过实现这些函数并使用数值求积算法来为六个指定的参数集中的每一个评估定积分来完成。`scipy.integrate.quad` 函数适用于此目的，因为它提供了一个鲁棒的自适应算法，能够处理被积函数的峰值特性。\n\n该问题还要求解释为什么移动谱峰位置 $s_{0}$ 会改变 $\\hat{D}$ 的值。这可以通过检查被积函数 $I(s) = 2\\pi s^3 P(s) \\hat{\\tau}(s)$ 的结构来理解。\n\n$1$. **波数加权**：被积函数中的 $s^3$ 项作为一个强权重因子。它是来自平方 $E \\times B$ 速度 $(v_E/c_s)^2 \\propto s^2$ 的 $s^2$ 和来自波数空间中径向积分测度 $2\\pi s\\,\\mathrm{d}s$ 的 $s$ 的乘积。这个 $s^3$ 因子意味着，在所有其他因素相同的情况下，较高波数（较大的 $s$）处的湍流涨落在驱动输运方面天生更有效。\n\n$2$. **谱功率与相关时间**：电势谱 $P(s)$ 和线性增长率 $\\hat{\\gamma}(s)$ 都被建模为以 $s = s_{0}$ 为中心有峰值。这意味着湍流在 $s_0$ 附近的一个局部区域内最强。然而，相关时间 $\\hat{\\tau}(s) = 1/(\\hat{\\gamma}(s) + \\nu)$ 在 $s=s_0$ 附近是*最短*的，因为大的增长率导致快速的退相关。这代表了一种自调节机制，其中最不稳定的模式也是最瞬态的。\n\n$3$. **综合效应**：当 $s_0$ 移动时，湍流谱 $P(s)$ 的峰值沿 $s$ 轴移动。\n- 如果 $s_0$ 增加（例如，从案例1的 $s_0 = 0.30$ 到案例3的 $s_0 = 0.50$），$P(s)$ 的峰值会移动到 $s^3$ 权重因子显著更大的区域。例如，$(0.50)^3 = 0.125$ 比 $(0.30)^3 = 0.027$ 大四倍以上。这种放大效应通常占主导地位，导致总积分扩散系数 $\\hat{D}$ 大幅增加。\n- 相反，如果 $s_0$ 减小（从案例1的 $s_0 = 0.30$ 到案例2的 $s_0 = 0.20$），$P(s)$ 的峰值会移动到 $s^3$ 权重小得多的区域。这导致总扩散系数 $\\hat{D}$ 显著减少。\n\n因此，湍流峰值的位置 $s_0$ 是决定整体输运水平的关键参数，这主要是通过它与准线性扩散系数积分中强 $s^3$ 权重的相互作用实现的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Calculates the quasilinear diffusivity for a series of test cases\n    by numerically integrating the specified model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a dictionary of parameters.\n    base_case = {\n        'A': 0.8, 'alpha': 1.0, 'sb': 2.0, 'p': 2, 'r': 2.0,\n        's0': 0.30, 'sigma': 0.07, 'gamma0': 0.15, 'sigmag': 0.08,\n        'nu': 0.05, 's_max': 4.0\n    }\n\n    test_cases = [\n        # Case 1 (baseline happy path)\n        base_case,\n        # Case 2 (lower peak)\n        {**base_case, 's0': 0.20},\n        # Case 3 (higher peak)\n        {**base_case, 's0': 0.50},\n        # Case 4 (narrow spectral peak)\n        {**base_case, 'sigma': 0.03},\n        # Case 5 (strong shear decorrelation)\n        {**base_case, 'nu': 0.30},\n        # Case 6 (no added peak, pure broadband background)\n        {**base_case, 'r': 0.0}\n    ]\n\n    results = []\n\n    for params in test_cases:\n        \n        # Unpack parameters for the current case\n        A = params['A']\n        alpha = params['alpha']\n        sb = params['sb']\n        p = params['p']\n        r = params['r']\n        s0 = params['s0']\n        sigma = params['sigma']\n        gamma0 = params['gamma0']\n        sigmag = params['sigmag']\n        nu = params['nu']\n        s_max = params['s_max']\n\n        # Define the functions for the integrand\n        \n        def p_spectrum(s):\n            \"\"\"\n            Calculates the dimensionless spectral density P(s).\n            \"\"\"\n            if s == 0.0 and alpha > 0:\n                return 0.0\n            \n            broadband_part = A * (s**alpha) * np.exp(-((s / sb)**p))\n            peak_part = 1.0 + r * np.exp(-((s - s0)**2) / (2 * sigma**2))\n            \n            return broadband_part * peak_part\n\n        def tau_corr(s):\n            \"\"\"\n            Calculates the dimensionless correlation time tau_hat(s).\n            \"\"\"\n            gamma_hat = gamma0 * np.exp(-((s - s0)**2) / (2 * sigmag**2))\n            return 1.0 / (gamma_hat + nu)\n\n        def integrand(s):\n            \"\"\"\n            Defines the full integrand for the diffusivity integral.\n            Integrand = 2 * pi * s^3 * P(s) * tau(s)\n            \"\"\"\n            return 2 * np.pi * (s**3) * p_spectrum(s) * tau_corr(s)\n\n        # Perform the numerical integration\n        # The quad function returns the integral and an error estimate. We only need the integral.\n        integral, _ = integrate.quad(integrand, 0, s_max)\n        \n        results.append(integral)\n\n    # Final print statement in the exact required format.\n    # The output should be a single line: a list of comma-separated floats\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在磁约束聚变等离子体中，湍流引起的输运主要通过两个渠道发生：静电涨落引起的 $E \\times B$ 漂移输运和电磁涨落引起的磁“颤振”（magnetic flutter）输运。理解这两种机制的相对重要性对于预测和控制输运至关重要。本练习将引导你通过解析推导，阐明这两种输运机制如何依赖于关键的等离子体参数——比压 $\\beta_i$，从而揭示从静电输运到电磁输运的过渡。",
            "id": "4198745",
            "problem": "考虑一个均匀、稳态的板状等离子体，其背景磁场均匀，为 $ \\mathbf{B}_0 = B \\hat{\\mathbf{z}} $。湍流涨落由傅里叶模式构成，这些模式具有垂直波矢 $ \\mathbf{k}_{\\perp} = (k_x, k_y) $ 和一个给定的、角度各向同性的静电势谱。假设如下：\n\n- 静电势涨落谱为 $ |\\phi_{\\mathbf{k}}|^2 = C k_{\\perp}^{-p} $（其中 $ k_0 \\le k_{\\perp} \\le k_1 $），$ C $、$ p $、$ k_0 $ 和 $ k_1 $ 与 $ \\beta $ 和时间无关，并且垂直波矢角度呈均匀分布，因此在角度平均后有 $ \\langle k_y^2 \\rangle_{\\theta} = k_{\\perp}^2 / 2 $。\n\n- 对于每个 $ \\mathbf{k} $，静电和电磁贡献的湍流退相关时间 $ \\tau_{\\mathbf{k}} $ 相同，因为两者都源于相同的潜在模式寿命。除了此等式之外，不需要 $ \\tau_{\\mathbf{k}} $ 的显式形式。\n\n- 在随机相位近似下，无源引导中心输运的准线性径向扩散系数由速度自相关构建，公式为 $ D = \\int d^2 k_{\\perp} \\, \\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle \\, \\tau_{\\mathbf{k}} $。\n\n- 径向电场叉磁场 ($E \\times B$) 漂移为 $ \\mathbf{v}_{E} = \\mathbf{E} \\times \\mathbf{B}_0 / B^2 $，其中 $ \\mathbf{E} = - \\nabla \\phi $，因此单个傅里叶模式的径向分量大小为 $ v_{r,E}(\\mathbf{k}) = k_y \\phi_{\\mathbf{k}} / B $。\n\n- 磁扰动径向速度为 $ v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\, \\delta B_r(\\mathbf{k}) / B $，其中 $ \\delta \\mathbf{B} = \\nabla \\times (A_{\\parallel} \\hat{\\mathbf{z}}) $，因此 $ \\delta B_r(\\mathbf{k}) = k_y A_{\\parallel, \\mathbf{k}} $ 在大小上成立。对于电磁耦合，取平行电场 $ E_{\\parallel} \\approx 0 $，因此根据 Faraday 定律，在傅里叶空间中意味着 $ \\omega A_{\\parallel, \\mathbf{k}} = k_{\\parallel} \\phi_{\\mathbf{k}} $。此外，假设存在 Alfvén 色散关系 $ \\omega = k_{\\parallel} v_A $，其中 Alfvén 速度为 $ v_A = B / \\sqrt{\\mu_0 n_i m_i} $，$ \\mu_0 $ 是真空磁导率，$ n_i $ 是离子密度，$ m_i $ 是离子质量。在这些假设下，有 $ A_{\\parallel, \\mathbf{k}} = \\phi_{\\mathbf{k}} / v_A $，因此 $ \\delta B_r(\\mathbf{k}) / B = k_y \\phi_{\\mathbf{k}} / (B v_A) $。\n\n- 考虑离子引导中心输运。对具有温度 $ T_i $ 的麦克斯韦离子分布进行平行速度平均，对于该分布有 $ \\langle v_{\\parallel}^2 \\rangle = T_i / m_i $。\n\n将离子等离子体贝塔值定义为 $ \\beta_i = 2 \\mu_0 n_i T_i / B^2 $。仅使用陈述的假设和定义，计算在给定谱上积分的准线性磁扰动扩散系数与准线性静电 $E \\times B$ 扩散系数的比率 $ R(\\beta_i) $。您的最终答案必须是关于 $ \\beta_i $ 的单个闭式解析表达式。最终答案中请勿包含单位。",
            "solution": "该问题经评估为有效，因为它在科学上基于等离子体物理和湍流理论的原理，是自洽的、适定的和客观的。推导所要求的比率所需的所有必要信息和定义均已提供，并且没有内部矛盾或事实不准确之处。因此，我们可以着手求解。\n\n问题要求计算准线性磁扰动扩散系数 $D_B$ 与准线性静电 $E \\times B$ 扩散系数 $D_E$ 的比率 $R(\\beta_i)$。准线性径向扩散系数的一般形式为：\n$$ D = \\int d^2 k_{\\perp} \\, \\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle \\, \\tau_{\\mathbf{k}} $$\n在随机相位近似下，相关项为 $\\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle = |v_r(\\mathbf{k})|^2$。\n\n首先，我们构建静电 $E \\times B$ 扩散系数 $D_E$ 的表达式。由 $E \\times B$ 漂移引起的单个傅里叶模式 $\\mathbf{k}$ 的径向速度分量为 $v_{r,E}(\\mathbf{k}) = k_y \\phi_{\\mathbf{k}} / B$。其大小的平方为 $|v_{r,E}(\\mathbf{k})|^2 = k_y^2 |\\phi_{\\mathbf{k}}|^2 / B^2$。将此代入通用扩散系数公式可得：\n$$ D_E = \\int d^2 k_{\\perp} \\, \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} $$\n积分是在垂直波矢空间上进行的，$d^2 k_{\\perp} = k_{\\perp} dk_{\\perp} d\\theta$，其中 $\\theta$ 是 $\\mathbf{k}_{\\perp}$ 在平面内的角度。问题指定了角度各向同性的谱，因此我们可以进行角度积分。我们使用恒等式 $k_y = k_{\\perp} \\sin(\\theta)$。量 $|\\phi_{\\mathbf{k}}|^2$ 和 $\\tau_{\\mathbf{k}}$ 被说明仅是 $k_{\\perp}$ 的函数。角度积分为：\n$$ \\int_0^{2\\pi} k_y^2 d\\theta = \\int_0^{2\\pi} (k_{\\perp} \\sin(\\theta))^2 d\\theta = k_{\\perp}^2 \\int_0^{2\\pi} \\sin^2(\\theta) d\\theta = k_{\\perp}^2 \\pi $$\n这与给出的关系式 $\\langle k_y^2 \\rangle_{\\theta} = \\frac{1}{2\\pi} \\int_0^{2\\pi} k_y^2 d\\theta = k_{\\perp}^2 / 2$ 是一致的。\n将此代入 $D_E$ 的表达式：\n$$ D_E = \\int_{k_0}^{k_1} k_{\\perp} dk_{\\perp} \\left( \\frac{(\\pi k_{\\perp}^2) |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} \\right) = \\frac{\\pi}{B^2} \\int_{k_0}^{k_1} k_{\\perp}^3 |\\phi_{\\mathbf{k}}|^2 \\tau_{\\mathbf{k}} dk_{\\perp} $$\n\n接下来，我们构建磁扰动扩散系数 $D_B$ 的表达式。由磁扰动引起的径向速度为 $v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\, \\delta B_r(\\mathbf{k}) / B$。问题提供了一系列假设，导出 $\\delta B_r(\\mathbf{k}) / B = k_y \\phi_{\\mathbf{k}} / (B v_A)$。因此，速度为：\n$$ v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\frac{k_y \\phi_{\\mathbf{k}}}{B v_A} $$\n该输运是针对离子引导中心的，因此我们必须对依赖于速度的输运在离子平行速度分布上进行平均，该分布是温度为 $T_i$ 的麦克斯韦分布。为了计算扩散系数，我们需要径向速度平方的平均值：\n$$ \\langle |v_{r,B}(\\mathbf{k}, v_{\\parallel})|^2 \\rangle_{v_{\\parallel}} = \\left\\langle v_{\\parallel}^2 \\left| \\frac{k_y \\phi_{\\mathbf{k}}}{B v_A} \\right|^2 \\right\\rangle_{v_{\\parallel}} = \\langle v_{\\parallel}^2 \\rangle_{v_{\\parallel}} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} $$\n给定 $\\langle v_{\\parallel}^2 \\rangle_{v_{\\parallel}} = T_i / m_i$。将此代入可得：\n$$ \\langle |v_{r,B}(\\mathbf{k})|^2 \\rangle_{v_{\\parallel}} = \\frac{T_i}{m_i} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} $$\n于是磁扰动扩散系数 $D_B$ 为：\n$$ D_B = \\int d^2 k_{\\perp} \\, \\left( \\frac{T_i}{m_i} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} \\right) \\tau_{\\mathbf{k}} $$\n我们可以将不依赖于 $\\mathbf{k}_{\\perp}$ 的项提取出来：\n$$ D_B = \\frac{T_i}{m_i v_A^2} \\left[ \\int d^2 k_{\\perp} \\, \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} \\right] $$\n方括号中的项正是 $E \\times B$ 扩散系数 $D_E$ 的表达式。\n$$ D_B = \\frac{T_i}{m_i v_A^2} D_E $$\n\n所求的比率 $R(\\beta_i) = D_B / D_E$ 现在可以直接计算：\n$$ R(\\beta_i) = \\frac{D_B}{D_E} = \\frac{T_i}{m_i v_A^2} $$\n请注意，此结果与具体谱形 $|\\phi_{\\mathbf{k}}|^2 = C k_{\\perp}^{-p}$ 和退相关时间 $\\tau_{\\mathbf{k}}$ 无关，因为这些公共因子在比率中相互抵消。\n\n为用离子等离子体贝塔值 $\\beta_i$ 表示此比率，我们代入 Alfvén 速度的定义 $v_A = B / \\sqrt{\\mu_0 n_i m_i}$。Alfvén 速度的平方是：\n$$ v_A^2 = \\frac{B^2}{\\mu_0 n_i m_i} $$\n将此代入比率 $R$ 的表达式中：\n$$ R(\\beta_i) = \\frac{T_i}{m_i \\left( \\frac{B^2}{\\mu_0 n_i m_i} \\right)} = \\frac{T_i \\mu_0 n_i m_i}{m_i B^2} = \\frac{\\mu_0 n_i T_i}{B^2} $$\n最后，我们使用问题中提供的离子等离子体贝塔值的定义：$\\beta_i = 2 \\mu_0 n_i T_i / B^2$。通过整理此定义，我们发现：\n$$ \\frac{\\mu_0 n_i T_i}{B^2} = \\frac{\\beta_i}{2} $$\n因此，该比率的最终表达式为：\n$$ R(\\beta_i) = \\frac{\\beta_i}{2} $$",
            "answer": "$$ \\boxed{\\frac{\\beta_i}{2}} $$"
        },
        {
            "introduction": "简单的准线性模型常假设湍流在空间上是均匀的，但这忽略了真实等离子体中湍流模具有沿磁力线变化的“气球模”结构。输运通量不仅取决于涨落的幅度，还强烈依赖于密度和电势等不同物理量涨落之间的局域相位关系。本练习通过建立一个包含本征函数空间结构和局域相位的模型，让你能够通过数值计算，探索这些精细结构如何影响并最终决定净输运通量的大小。",
            "id": "4198758",
            "problem": "本题要求您通过对局域交叉相位进行积分，来形式化、计算并测试准线性粒子通量对沿着气球模坐标的本征函数空间变化的敏感性。请在局域磁通管、静电、无碰撞近似的框架下进行。所有量都用归一化、无量纲单位表示，因此不需要物理单位。所有角度必须使用弧度。\n\n从以下基本理论出发。径向粒子通量由连续性方程和电场叉磁场漂移（$E \\times B$）速度定义为密度涨落和径向 $E \\times B$ 速度涨落乘积的时间平均值，\n$$\n\\Gamma \\equiv \\langle \\tilde{n} \\,\\tilde{v}_{E,r} \\rangle_t,\n$$\n其中 $\\langle \\cdot \\rangle_t$ 表示对多个波周期的时间平均。在线性理论中，涨落具有单一频率 $\\omega$ 和副法向波数 $k_y$，可以表示为复振幅 $\\tilde{n}(\\theta,t) = \\Re\\{\\hat{n}(\\theta)\\,e^{-i \\omega t}\\}$ 和 $\\tilde{\\phi}(\\theta,t) = \\Re\\{\\hat{\\phi}(\\theta)\\,e^{-i \\omega t}\\}$，其中 $\\theta$ 是气球模坐标。径向 $E \\times B$ 速度的振幅由静电势得出：\n$$\n\\hat{v}_{E,r}(\\theta) = i\\,k_y\\, \\hat{\\phi}(\\theta),\n$$\n该表达式采用的归一化中，电场与磁场强度之比为单位一。\n\n使用 $\\langle \\Re\\{a e^{-i\\omega t}\\}\\Re\\{b e^{-i\\omega t}\\}\\rangle_t = \\tfrac{1}{2}\\Re\\{a b^\\ast\\}$，在每个 $\\theta$ 处对通量的局域贡献正比于 $\\tfrac{1}{2}\\Re\\{\\hat{n} \\hat{v}_{E,r}^\\ast\\} = \\tfrac{1}{2} k_y |\\hat{n}||\\hat{\\phi}| \\sin\\delta(\\theta)$，其中局域交叉相位 $\\delta(\\theta)$ 通过 $\\hat{n}(\\theta) = |\\hat{n}(\\theta)| e^{i (\\arg \\hat{\\phi}(\\theta) + \\delta(\\theta))}$ 定义。总通量在整个气球模结构上积分，并由模式能量归一化后得到：\n$$\n\\Gamma_{\\mathrm{norm}} = \\frac{k_y}{2} \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, |\\hat{\\phi}(\\theta)|\\,|\\hat{n}(\\theta)| \\, \\sin\\delta(\\theta)}{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, |\\hat{\\phi}(\\theta)|^2 }.\n$$\n\n在本问题中，您将为一组给定的本征函数和响应模型评估 $\\Gamma_{\\mathrm{norm}}$，并计算其对一个控制本征函数振幅空间变化的参数的敏感性。具体来说，采用以下气球模结构模型：\n- 电势本征函数振幅（实数，非负）为\n$$\n|\\hat{\\phi}_\\alpha(\\theta)| = \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta^2}{2 \\sigma_\\phi^2}\\right),\n$$\n其中 $\\sigma_\\phi  0$ 是一个宽度参数，$\\alpha$ 是一个调制本征函数空间变化的实数控制参数（要求 $\\alpha  -1$ 以保持高斯函数可归一化）。\n- 密度响应振幅为\n$$\n|\\hat{n}(\\theta)| = R_0 \\exp\\!\\left(-\\frac{\\theta^2}{2 \\sigma_n^2}\\right),\n$$\n其中响应强度 $R_0 \\ge 0$，宽度 $\\sigma_n  0$。\n- 局域交叉相位规定为\n$$\n\\delta(\\theta) = \\delta_0 + \\gamma_1 \\,\\theta + \\gamma_3 \\,\\theta^3,\n$$\n其中 $\\delta_0$、$\\gamma_1$ 和 $\\gamma_3$ 是常数。\n\n因此，作为 $\\alpha$ 函数的归一化准线性通量为\n$$\n\\Gamma_{\\mathrm{norm}}(\\alpha) = \\frac{k_y}{2} \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta^2}{2 \\sigma_\\phi^2}\\right)\\, R_0 \\exp\\!\\left(-\\frac{\\theta^2}{2 \\sigma_n^2}\\right)\\, \\sin\\!\\big(\\delta_0 + \\gamma_1 \\theta + \\gamma_3 \\theta^3\\big)}{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta^2}{\\sigma_\\phi^2}\\right)}.\n$$\n\n您的任务：\n1. 实现一个数值方法，在一个具有 $N_\\theta$ 个网格点的有限对称区间 $[-\\Theta_{\\max}, \\Theta_{\\max}]$ 上，使用均匀网格和复合梯形法则来近似关于 $\\theta$ 的积分。所有角度均以弧度为单位。选择的 $\\Theta_{\\max}$ 应确保高斯包络能被良好分辨。\n2. 对于下面测试套件中的每一组参数，计算两个量：\n   - 归一化通量 $\\Gamma_{\\mathrm{norm}}(\\alpha)$。\n   - 由中心有限差分导数定义的敏感性 $S(\\alpha)$\n     $$\n     S(\\alpha) \\equiv \\frac{\\Gamma_{\\mathrm{norm}}(\\alpha + h) - \\Gamma_{\\mathrm{norm}}(\\alpha - h)}{2 h},\n     $$\n     步长 $h = 0.05$。\n3. 使用以下测试套件，其中每个测试指定 $(k_y, \\sigma_\\phi, \\sigma_n, R_0, \\delta_0, \\gamma_1, \\gamma_3, \\alpha, \\Theta_{\\max}, N_\\theta)$，适用时所有数值均以弧度为单位：\n   - 测试 $1$：$(0.3, 1.2, 1.0, 0.8, 0.5, 0.2, 0.0, 0.0, 8.0, 20001)$。\n   - 测试 $2$：$(0.7, 1.0, 1.0, 1.0, 0.0, 0.6, 0.0, 0.0, 8.0, 20001)$。\n   - 测试 $3$：$(0.5, 2.5, 1.5, 0.6, 0.3, 0.0, 0.02, 0.0, 8.0, 20001)$。\n   - 测试 $4$：$(1.0, 0.8, 0.8, 1.0, 1.0, -0.1, 0.01, 0.0, 8.0, 20001)$。\n   - 测试 $5$：$(0.4, 1.3, 0.7, 0.0, 0.9, 0.2, 0.03, 0.0, 8.0, 20001)$。\n\n您的程序必须：\n- 精确实现上述定义，并对每个测试用例计算 $\\Gamma_{\\mathrm{norm}}(\\alpha)$ 和 $S(\\alpha)$，其中有限差分敏感性计算使用 $h = 0.05$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按顺序拼接两个浮点数：$\\Gamma_{\\mathrm{norm}}$，然后是 $S$。例如，五个测试的输出格式为\n$$\n[\\Gamma_1, S_1, \\Gamma_2, S_2, \\Gamma_3, S_3, \\Gamma_4, S_4, \\Gamma_5, S_5].\n$$\n\n所有输出都是无量纲数。所有计算中角度必须以弧度处理。程序不需要用户输入；它必须是完全自包含的，并直接打印所需的列表。",
            "solution": "我们从第一性原理推导所需的数值公式，并将其转化为算法。\n\n出发点是无碰撞、静电、局域磁通管近似下的连续性方程和电场叉磁场漂移（$E \\times B$）速度。涨落粒子通量定义为密度和径向 $E \\times B$ 速度涨落乘积的时间平均值，\n$$\n\\Gamma \\equiv \\langle \\tilde{n} \\,\\tilde{v}_{E,r} \\rangle_t.\n$$\n频率为 $\\omega$、副法向波数为 $k_y$ 的线性涨落可以表示为复振幅 $\\hat{n}(\\theta)$ 和 $\\hat{\\phi}(\\theta)$，真实的物理场由 $\\hat{n} e^{-i\\omega t}$ 和 $\\hat{\\phi} e^{-i\\omega t}$ 的实部给出。径向电场叉磁场漂移（$E \\times B$）速度的振幅通过静电势得到：\n$$\n\\hat{v}_{E,r}(\\theta) = i\\,k_y\\, \\hat{\\phi}(\\theta),\n$$\n这个结果是在一种平板归一化下得到的，其中电场与磁场强度之比为单位一，并且副法向的空间依赖关系 $\\exp(i k_y y)$ 在微分后产生因子 $i k_y$。\n\n使用谐波信号时间平均的恒等式，\n$$\n\\left\\langle \\Re\\{a e^{-i\\omega t}\\}\\Re\\{b e^{-i\\omega t}\\}\\right\\rangle_t = \\frac{1}{2}\\Re\\{a b^\\ast\\},\n$$\n我们得到在气球模角 $\\theta$ 处的局域贡献，\n$$\n\\frac{1}{2}\\Re\\left\\{\\hat{n}(\\theta)\\, \\hat{v}_{E,r}^\\ast(\\theta)\\right\\} = \\frac{1}{2}\\Re\\left\\{\\hat{n}(\\theta)\\, (-i k_y)\\, \\hat{\\phi}^\\ast(\\theta)\\right\\}.\n$$\n将复振幅写成极坐标形式，并定义相对于电势的局域交叉相位 $\\delta(\\theta)$，\n$$\n\\hat{\\phi}(\\theta) = |\\hat{\\phi}(\\theta)| e^{i \\varphi(\\theta)}, \\quad\n\\hat{n}(\\theta) = |\\hat{n}(\\theta)| e^{i (\\varphi(\\theta) + \\delta(\\theta))}.\n$$\n于是\n$$\n\\hat{n}(\\theta)\\, \\hat{\\phi}^\\ast(\\theta) = |\\hat{n}(\\theta)|\\,|\\hat{\\phi}(\\theta)|\\, e^{i \\delta(\\theta)},\n$$\n因此\n$$\n\\Re\\left\\{\\hat{n}\\,(-i k_y)\\,\\hat{\\phi}^\\ast\\right\\} = -k_y\\, \\Re\\left\\{i\\, \\hat{n}\\,\\hat{\\phi}^\\ast\\right\\}\n= -k_y\\, \\Re\\left\\{i\\, |\\hat{n}|\\,|\\hat{\\phi}|\\, e^{i \\delta}\\right\\} = k_y\\, |\\hat{n}|\\,|\\hat{\\phi}|\\, \\sin \\delta(\\theta).\n$$\n所以，时间平均的局域通量密度为\n$$\n\\frac{1}{2} k_y\\, |\\hat{n}(\\theta)|\\,|\\hat{\\phi}(\\theta)|\\, \\sin \\delta(\\theta).\n$$\n将此局域贡献沿 $\\theta$ 在整个气球模结构上积分，得到总贡献。为了消除模式的平凡整体振幅标度，我们用模式能量度量 $M = \\int \\mathrm{d}\\theta\\, |\\hat{\\phi}(\\theta)|^2$ 进行归一化。这给出了归一化通量\n$$\n\\Gamma_{\\mathrm{norm}} = \\frac{k_y}{2}\\, \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, |\\hat{\\phi}(\\theta)|\\,|\\hat{n}(\\theta)| \\, \\sin\\delta(\\theta)}{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, |\\hat{\\phi}(\\theta)|^2 }.\n$$\n\n现在我们指定气球模结构的模型。电势本征函数振幅是一个高斯包络，其宽度由参数 $\\alpha$ 调制，\n$$\n|\\hat{\\phi}_\\alpha(\\theta)| = \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta^2}{2 \\sigma_\\phi^2}\\right),\n$$\n其中 $\\alpha  -1$。密度响应振幅是一个宽度为 $\\sigma_n$、响应强度为 $R_0$ 的高斯函数，\n$$\n|\\hat{n}(\\theta)| = R_0 \\exp\\!\\left(-\\frac{\\theta^2}{2 \\sigma_n^2}\\right).\n$$\n局域交叉相位包含常数项、线性项和弱三次项对 $\\theta$ 的依赖关系，\n$$\n\\delta(\\theta) = \\delta_0 + \\gamma_1 \\,\\theta + \\gamma_3 \\,\\theta^3.\n$$\n将这些代入归一化通量，得到\n$$\n\\Gamma_{\\mathrm{norm}}(\\alpha) = \\frac{k_y}{2} \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta^2}{2 \\sigma_\\phi^2}\\right)\\, R_0 \\exp\\!\\left(-\\frac{\\theta^2}{2 \\sigma_n^2}\\right)\\, \\sin\\!\\big(\\delta_0 + \\gamma_1 \\theta + \\gamma_3 \\theta^3\\big)}{\\displaystyle \\int_{-\\infty}^{\\infty} \\mathrm{d}\\theta \\, \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta^2}{\\sigma_\\phi^2}\\right)}.\n$$\n\n算法离散化：\n- 选择一个对称有限区间 $\\theta \\in [-\\Theta_{\\max}, \\Theta_{\\max}]$ 和 $N_\\theta$ 个均匀间隔的网格点。只要 $\\Theta_{\\max} \\gg \\max(\\sigma_\\phi, \\sigma_n)$，高斯包络在 $|\\theta| \\gtrsim \\Theta_{\\max}$ 时就会快速衰减；测试套件强制 $\\Theta_{\\max} = 8.0$，对于给定的宽度是足够的。\n- 使用复合梯形法则计算分子积分，\n$$\nI_{\\mathrm{num}}(\\alpha) \\approx \\sum_{j=1}^{N_\\theta} w_j\\, \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta_j^2}{2 \\sigma_\\phi^2}\\right)\\, R_0 \\exp\\!\\left(-\\frac{\\theta_j^2}{2 \\sigma_n^2}\\right)\\, \\sin\\!\\big(\\delta_0 + \\gamma_1 \\theta_j + \\gamma_3 \\theta_j^3\\big),\n$$\n以及分母积分\n$$\nM(\\alpha) \\approx \\sum_{j=1}^{N_\\theta} w_j\\, \\exp\\!\\left(-\\frac{(1+\\alpha)\\,\\theta_j^2}{\\sigma_\\phi^2}\\right),\n$$\n其中 $w_j$ 是由间距为 $\\Delta\\theta$ 的均匀网格所隐含的梯形权重。\n- 组合起来得到\n$$\n\\Gamma_{\\mathrm{norm}}(\\alpha) \\approx \\frac{k_y}{2}\\, \\frac{I_{\\mathrm{num}}(\\alpha)}{M(\\alpha)}.\n$$\n\n关于 $\\alpha$ 的敏感性：\n- 定义有限差分敏感性\n$$\nS(\\alpha) = \\frac{\\Gamma_{\\mathrm{norm}}(\\alpha + h) - \\Gamma_{\\mathrm{norm}}(\\alpha - h)}{2 h},\n$$\n其中 $h = 0.05$。这是一个二阶精度的中心差分，与高斯包络对 $\\alpha$ 的平滑依赖性相符。\n\n正确性检查和特殊情况：\n- 如果 $R_0 = 0$，那么处处有 $|\\hat{n}| = 0$，并且对所有 $\\alpha$ 都有 $\\Gamma_{\\mathrm{norm}}(\\alpha) = 0$，这意味着 $S(\\alpha) = 0$。\n- 如果 $\\delta_0 = 0$、$\\gamma_3 = 0$，并且 $\\sin(\\gamma_1 \\theta)$ 是一个奇函数，而包络是 $\\theta$ 的偶函数，那么分子积分是在对称区间上对一个奇函数的积分，在连续极限下精确为零，从而得到 $\\Gamma_{\\mathrm{norm}}(\\alpha) = 0$ 并因此 $S(\\alpha) = 0$。对称均匀网格和梯形积分法能将这种相消保持到接近机器精度。\n\n实现细节：\n- 在 $[-\\Theta_{\\max}, \\Theta_{\\max}]$ 上使用一个包含 $N_\\theta$ 个点的均匀网格，间距为 $\\Delta\\theta = 2 \\Theta_{\\max}/(N_\\theta - 1)$。\n- 通过矢量化评估和一个使用适当端点半权重的求和数值积分函数来使用复合梯形法则，或者等效地使用一个实现该法则的标准例程。\n- 对五个指定的测试中的每一个评估 $\\Gamma_{\\mathrm{norm}}(\\alpha)$ 和 $S(\\alpha)$：\n  - 测试 $1$：$(k_y, \\sigma_\\phi, \\sigma_n, R_0, \\delta_0, \\gamma_1, \\gamma_3, \\alpha, \\Theta_{\\max}, N_\\theta) = (0.3, 1.2, 1.0, 0.8, 0.5, 0.2, 0.0, 0.0, 8.0, 20001)$。\n  - 测试 $2$：$(0.7, 1.0, 1.0, 1.0, 0.0, 0.6, 0.0, 0.0, 8.0, 20001)$。\n  - 测试 $3$：$(0.5, 2.5, 1.5, 0.6, 0.3, 0.0, 0.02, 0.0, 8.0, 20001)$。\n  - 测试 $4$：$(1.0, 0.8, 0.8, 1.0, 1.0, -0.1, 0.01, 0.0, 8.0, 20001)$。\n  - 测试 $5$：$(0.4, 1.3, 0.7, 0.0, 0.9, 0.2, 0.03, 0.0, 8.0, 20001)$。\n\n输出规格：\n- 对于每个测试 $i \\in \\{1,2,3,4,5\\}$，计算 $\\Gamma_i = \\Gamma_{\\mathrm{norm}}(\\alpha_i)$ 和 $S_i = S(\\alpha_i)$，其中 $h = 0.05$。\n- 打印单行，其中包含列表 $[\\Gamma_1, S_1, \\Gamma_2, S_2, \\Gamma_3, S_3, \\Gamma_4, S_4, \\Gamma_5, S_5]$，包含用逗号分隔的浮点数，无额外文本。\n\n该算法与通量的准线性定义、$E \\times B$ 速度关系以及交叉相位表示法一致，而有限差分敏感性量化了归一化通量如何响应沿气球模角的本征函数振幅的受控空间变化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef gamma_norm(k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha, theta_max, n_theta):\n    \"\"\"\n    Compute the normalized quasilinear flux Gamma_norm(alpha) using trapezoidal integration.\n\n    Parameters are dimensionless; angles are in radians.\n    \"\"\"\n    # Construct symmetric theta grid\n    theta = np.linspace(-theta_max, theta_max, n_theta)\n    # Gaussian envelopes for |phi_alpha| and |n|\n    phi_amp = np.exp(-((1.0 + alpha) * theta**2) / (2.0 * sigma_phi**2))\n    n_amp = R0 * np.exp(-(theta**2) / (2.0 * sigma_n**2))\n    # Local cross-phase\n    delta = delta0 + gamma1 * theta + gamma3 * theta**3\n    # Numerator integrand and denominator\n    integrand = phi_amp * n_amp * np.sin(delta)\n    # Trapezoidal integrals\n    num = np.trapz(integrand, theta)\n    den = np.trapz(phi_amp**2, theta)\n    # Avoid division by zero; if den is zero, return zero flux\n    if den == 0.0:\n        return 0.0\n    return (k_y / 2.0) * (num / den)\n\ndef sensitivity_central(k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha, theta_max, n_theta, h=0.05):\n    \"\"\"\n    Compute centered finite-difference sensitivity S(alpha) with step h.\n    \"\"\"\n    g_plus = gamma_norm(k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha + h, theta_max, n_theta)\n    g_minus = gamma_norm(k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha - h, theta_max, n_theta)\n    return (g_plus - g_minus) / (2.0 * h)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha, theta_max, n_theta)\n    test_cases = [\n        (0.3, 1.2, 1.0, 0.8, 0.5, 0.2, 0.0, 0.0, 8.0, 20001),\n        (0.7, 1.0, 1.0, 1.0, 0.0, 0.6, 0.0, 0.0, 8.0, 20001),\n        (0.5, 2.5, 1.5, 0.6, 0.3, 0.0, 0.02, 0.0, 8.0, 20001),\n        (1.0, 0.8, 0.8, 1.0, 1.0, -0.1, 0.01, 0.0, 8.0, 20001),\n        (0.4, 1.3, 0.7, 0.0, 0.9, 0.2, 0.03, 0.0, 8.0, 20001),\n    ]\n\n    results = []\n    for case in test_cases:\n        k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha, theta_max, n_theta = case\n        gamma = gamma_norm(k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha, theta_max, n_theta)\n        sens = sensitivity_central(k_y, sigma_phi, sigma_n, R0, delta0, gamma1, gamma3, alpha, theta_max, n_theta, h=0.05)\n        results.append(gamma)\n        results.append(sens)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}