{
    "hands_on_practices": [
        {
            "introduction": "准线性理论的核心在于，通过分析粒子在波动场中的运动来计算输运。本练习将带你追溯到第一性原理——洛伦兹力，来推导平行速度空间扩散系数 $D_{\\parallel\\parallel}$ 。通过沿无扰轨道对粒子加速度进行自相关计算，你将亲自揭示波粒相互作用的基本结构，包括回旋共振条件和描述有限拉莫尔半径（FLR）效应的贝塞尔函数是如何自然出现的。",
            "id": "4198789",
            "problem": "考虑一个均匀、不随时间变化的磁场 $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$ 和一个由标量势 $\\phi(\\mathbf{r},t) = \\Re\\{\\Phi\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\}$ 描述的单色静电涨落，其中 $\\Phi$ 是常数复振幅，$\\mathbf{k} = \\mathbf{k}_{\\perp} + k_{\\parallel}\\,\\hat{\\mathbf{z}}$ 是波矢，$\\omega$ 是角频率。一种带电荷 $q$ 和质量 $m$ 的示踪粒子在由 $\\mathbf{B}_{0}$ 产生的未受扰动的螺旋轨道上受洛伦兹力作用而运动：平行速度 $v_{\\parallel}$ 是恒定的，垂直运动是圆周运动，其回旋频率为 $\\Omega \\equiv q B_{0}/m$，垂直速率为 $v_{\\perp}$，拉莫尔半径为 $\\rho \\equiv v_{\\perp}/\\Omega$。\n\n在准线性（QL）理论中，平行速度空间扩散系数 $D_{\\parallel\\parallel}(v_{\\parallel},v_{\\perp})$ 被定义为沿未受扰动轨道计算的平行加速度自相关的长时间积分，其中假设了涨落的相位是随机的且具有统计均匀性。有限拉莫尔半径（FLR）效应通过场沿螺旋轨道对回旋相位的依赖性而引入。\n\n从洛伦兹力和未受扰动轨道出发，仅使用基本定义和经过充分检验的恒等式（包括将 $\\exp[i\\,\\mathbf{k}_{\\perp}\\cdot\\boldsymbol{\\rho}(t)]$ 分解为柱贝塞尔函数 $J_{n}$ 的傅里叶-贝塞尔分解），推导对于此单一模式，回旋谐波（$n\\neq 0$）对 $D_{\\parallel\\parallel}(v_{\\parallel},v_{\\perp})$ 的贡献的闭合形式解析表达式，并通过 $J_{n}(k_{\\perp}\\rho)$ 和共振条件保留FLR效应。在进行回旋角平均和取长时间极限后，用 $q$、$m$、$k_{\\parallel}$、$\\omega$、$B_{0}$、$|\\Phi|$、$v_{\\parallel}$、$v_{\\perp}$ 以及标准特殊函数明确表达你的最终答案。\n\n你的最终答案必须是单一的闭合形式解析表达式。不需要进行数值计算或四舍五入。",
            "solution": "问题要求计算单一静电模式下，回旋谐波对准线性平行速度空间扩散系数 $D_{\\parallel\\parallel}$ 的贡献。我们从基本定义开始，一步步推导该表达式。\n\n平行扩散系数被定义为沿未受扰动粒子轨道计算的平行加速度自相关的时间积分：\n$$D_{\\parallel\\parallel} = \\int_{0}^{\\infty} \\langle a_{\\parallel}(t_{0}) a_{\\parallel}(t_{0}+\\tau) \\rangle \\, d\\tau$$\n尖括号 $\\langle \\cdot \\rangle$ 表示对湍流统计特性的系综平均。在本问题中，对于一个振幅为 $\\Phi = |\\Phi| \\exp(i\\delta)$ 的单一模式，这对应于对随机相位 $\\delta$ 和初始粒子回旋相位 $\\alpha$ 的平均。由于统计平稳性，相关函数与初始时间 $t_{0}$ 无关，为方便起见，我们将其设为 $0$。\n\n首先，我们确定平行加速度 $a_{\\parallel}$。带电荷 $q$ 和质量 $m$ 的粒子受到的力是洛伦兹力，$\\mathbf{F} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$。涨落是静电的，因此电场为 $\\mathbf{E} = -\\nabla\\phi$。问题给出的势为 $\\phi(\\mathbf{r},t) = \\Re\\{\\Phi\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\}$。\n在计算上，使用复势 $\\phi_{c}(\\mathbf{r},t) = \\Phi\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]$ 并在最后取实部更为方便。复电场为 $\\mathbf{E}_{c} = -\\nabla\\phi_{c} = -i\\mathbf{k}\\,\\phi_{c}$。\n电场的平行分量为 $E_{\\parallel, c} = \\mathbf{E}_{c} \\cdot \\hat{\\mathbf{z}} = -i(\\mathbf{k} \\cdot \\hat{\\mathbf{z}})\\phi_{c} = -i k_{\\parallel} \\phi_{c}$。\n于是，平行加速度为 $a_{\\parallel, c}(t) = \\frac{q}{m} E_{\\parallel, c} = -i\\frac{q k_{\\parallel}}{m} \\Phi \\exp[i(\\mathbf{k}\\cdot\\mathbf{r}(t) - \\omega t)]$。物理加速度为 $a_{\\parallel}(t) = \\Re\\{a_{\\parallel, c}(t)\\}$.\n\n接下来，我们描述在均匀磁场 $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{z}}$ 中未受扰动的粒子轨道 $\\mathbf{r}(t)$。该运动由一个恒定的平行速度 $v_{\\parallel}$ 和垂直平面内的圆周回旋运动组成。轨道可以描述为：\n$$\\mathbf{r}(t) = \\mathbf{R}_{GC} + v_{\\parallel} t \\hat{\\mathbf{z}} + \\boldsymbol{\\rho}(t)$$\n其中 $\\mathbf{R}_{GC}$ 是初始导心位置，$\\boldsymbol{\\rho}(t)$ 是拉莫尔半径矢量。我们可以设置原点使 $\\mathbf{R}_{GC}=\\mathbf{0}$。为了计算 $\\mathbf{k}_{\\perp}\\cdot\\boldsymbol{\\rho}(t)$，我们可以不失一般性地调整坐标系，使 $\\mathbf{k}_{\\perp}$ 沿着 y 轴，即 $\\mathbf{k}_{\\perp} = k_{\\perp}\\hat{\\mathbf{y}}$。回旋运动由 $\\boldsymbol{\\rho}(t) = \\rho (\\sin(\\Omega t + \\alpha)\\hat{\\mathbf{x}} + \\cos(\\Omega t + \\alpha)\\hat{\\mathbf{y}})$ 描述，其中 $\\Omega = qB_{0}/m$ 是回旋频率，$\\rho = v_{\\perp}/|\\Omega|$ 是拉莫尔半径，$\\alpha$ 是初始回旋相位。问题中定义了 $\\rho=v_{\\perp}/\\Omega$，我们将使用这个定义，并注意到 $J_{n}^{2}(x)=J_{n}^{2}(-x)$。\n于是标量积为 $\\mathbf{k}_{\\perp}\\cdot\\boldsymbol{\\rho}(t) = k_{\\perp}\\rho\\cos(\\Omega t + \\alpha)$。波沿未受扰动轨道的相位是：\n$$\\mathbf{k}\\cdot\\mathbf{r}(t) - \\omega t = k_{\\parallel}v_{\\parallel}t + k_{\\perp}\\rho\\cos(\\Omega t + \\alpha) - \\omega t$$\n\n现在我们使用傅里叶-贝塞尔（雅可比-安格尔）恒等式 $\\exp(iz\\cos\\beta) = \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(z)\\exp(in\\beta)$，其中 $J_{n}$ 是 n 阶第一类贝塞尔函数。将此应用于我们的相位项，令 $z = k_{\\perp}\\rho$ 和 $\\beta = \\Omega t + \\alpha$：\n$$\\exp[ik_{\\perp}\\rho\\cos(\\Omega t + \\alpha)] = \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(k_{\\perp}\\rho) \\exp[in(\\Omega t + \\alpha)]$$\n将此代入 $a_{\\parallel, c}(t)$ 的表达式：\n$$a_{\\parallel, c}(t) = -i\\frac{q k_{\\parallel}\\Phi}{m} \\sum_{n=-\\infty}^{\\infty} i^{n} J_{n}(k_{\\perp}\\rho) \\exp[i(k_{\\parallel}v_{\\parallel}t + n\\Omega t + n\\alpha - \\omega t)]$$\n$$a_{\\parallel, c}(t) = \\frac{q k_{\\parallel}\\Phi}{m} \\sum_{n=-\\infty}^{\\infty} i^{n-1} J_{n}(k_{\\perp}\\rho) \\exp[i((k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega)t + n\\alpha)]$$\n实数量的自相关函数可以通过 $C(\\tau) = \\langle \\Re\\{a_{\\parallel, c}(0)\\} \\Re\\{a_{\\parallel, c}(\\tau)\\} \\rangle = \\frac{1}{2}\\Re\\{\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle\\}$ 与复数量联系起来，因为诸如 $\\langle \\Phi \\Phi \\rangle$ 的项在对随机相位 $\\delta$ 平均后为零。\n$$a_{\\parallel, c}^{*}(0) = \\frac{q k_{\\parallel}\\Phi^{*}}{m} \\sum_{l=-\\infty}^{\\infty} (-i)^{l-1} J_{l}(k_{\\perp}\\rho) \\exp(-il\\alpha)$$\n$$a_{\\parallel, c}(\\tau) = \\frac{q k_{\\parallel}\\Phi}{m} \\sum_{n=-\\infty}^{\\infty} i^{n-1} J_{n}(k_{\\perp}\\rho) \\exp[i((k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega)\\tau + n\\alpha)]$$\n乘积为：\n$$\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle = \\left(\\frac{q k_{\\parallel}}{m}\\right)^{2} \\langle |\\Phi|^{2} \\rangle \\sum_{n,l} (-i)^{l-1} i^{n-1} J_{l}J_{n} \\exp[i\\omega_{n}\\tau] \\langle \\exp[i(n-l)\\alpha] \\rangle$$\n这里我们定义了共振频率 $\\omega_{n} = k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega$。对初始回旋相位 $\\alpha$ 的平均得到 $\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\exp[i(n-l)\\alpha]d\\alpha = \\delta_{nl}$，其中 $\\delta_{nl}$ 是克罗内克δ函数。这将双重求和简化为 $n=l$ 的单重求和。\n$$\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle = \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} (-i)^{n-1} i^{n-1} J_{n}^{2}(k_{\\perp}\\rho) \\exp(i\\omega_{n}\\tau)$$\n因子 $(-i)^{n-1} i^{n-1} = ((-i)i)^{n-1} = 1^{n-1} = 1$。表达式简化为：\n$$\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle = \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\exp(i\\omega_{n}\\tau)$$\n于是自相关函数为：\n$$C(\\tau) = \\frac{1}{2}\\Re\\left\\{\\langle a_{\\parallel, c}^{*}(0) a_{\\parallel, c}(\\tau) \\rangle\\right\\} = \\frac{1}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\cos(\\omega_{n}\\tau)$$\n现在，我们对 $C(\\tau)$ 积分以求得 $D_{\\parallel\\parallel}$：\n$$D_{\\parallel\\parallel} = \\int_{0}^{\\infty} C(\\tau) \\, d\\tau = \\frac{1}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\int_{0}^{\\infty}\\cos(\\omega_{n}\\tau) \\, d\\tau$$\n时间积分代表了共振条件。在长时间极限下，它计算为一个狄拉克δ函数：$\\int_{0}^{\\infty} \\cos(\\omega' \\tau)d\\tau = \\pi \\delta(\\omega')$。\n$$D_{\\parallel\\parallel} = \\frac{\\pi}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\delta(\\omega_{n})$$\n代入 $\\omega_{n} = k_{\\parallel}v_{\\parallel} + n\\Omega - \\omega$ 并利用性质 $\\delta(-x)=\\delta(x)$：\n$$D_{\\parallel\\parallel}(v_{\\parallel}, v_{\\perp}) = \\frac{\\pi}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n=-\\infty}^{\\infty} J_{n}^{2}(k_{\\perp}\\rho) \\delta(\\omega - k_{\\parallel}v_{\\parallel} - n\\Omega)$$\n问题要求的是回旋谐波的贡献，这对应于所有 $n \\neq 0$ 的项。$n=0$ 项对应于朗道阻尼。\n$$D_{\\parallel\\parallel, n \\neq 0} = \\frac{\\pi}{2} \\left(\\frac{q k_{\\parallel} |\\Phi|}{m}\\right)^{2} \\sum_{n \\in \\mathbb{Z}, n\\neq 0} J_{n}^{2}(k_{\\perp}\\rho) \\delta(\\omega - k_{\\parallel}v_{\\parallel} - n\\Omega)$$\n最后，我们代入给定的定义 $\\Omega = q B_{0}/m$ 和 $\\rho = v_{\\perp}/\\Omega = v_{\\perp}m/(qB_{0})$，从而用指定的变量来表示结果。\n$$D_{\\parallel\\parallel, n \\neq 0} = \\frac{\\pi q^2 k_{\\parallel}^2 |\\Phi|^2}{2m^2} \\sum_{\\substack{n \\in \\mathbb{Z} \\\\ n\\neq 0}} J_n^2\\left(\\frac{k_{\\perp} v_{\\perp} m}{q B_0}\\right) \\delta\\left(\\omega - k_{\\parallel}v_{\\parallel} - n \\frac{q B_0}{m}\\right)$$\n这就是回旋谐波对平行扩散系数贡献的最终表达式。",
            "answer": "$$\\boxed{\\frac{\\pi q^{2} k_{\\parallel}^{2} |\\Phi|^{2}}{2m^{2}} \\sum_{\\substack{n \\in \\mathbb{Z} \\\\ n\\neq 0}} J_{n}^{2}\\left(\\frac{k_{\\perp} v_{\\perp} m}{q B_{0}}\\right) \\delta\\left(\\omega - k_{\\parallel}v_{\\parallel} - n \\frac{q B_{0}}{m}\\right)}$$"
        },
        {
            "introduction": "在等离子体中，湍流输运可由多种物理机制驱动。本练习将引导你比较两种主要的输运渠道：由静电涨落引起的 $E \\times B$ 输运，以及由电磁涨落引起的磁漂移输运 。通过推导这两种输运通量的比值，你将发现一个与离子等离子体贝塔值 $\\beta_i$ 相关的简洁而深刻的标度关系，这对于理解不同等离子体环境（如托卡马克与天体物理等离子体）中主导的输运机制至关重要。",
            "id": "4198745",
            "problem": "考虑一个均匀、静态的板状等离子体，其背景磁场是均匀的 $ \\mathbf{B}_0 = B \\hat{\\mathbf{z}} $。湍流涨落由傅里叶模式构成，这些模式具有垂直波矢 $ \\mathbf{k}_{\\perp} = (k_x, k_y) $ 和一个给定的、角度各向同性的静电势谱。假设如下：\n\n- 静电势涨落谱为 $ |\\phi_{\\mathbf{k}}|^2 = C k_{\\perp}^{-p} $（其中 $ k_0 \\le k_{\\perp} \\le k_1 $），并且 $ C $、$ p $、$ k_0 $ 和 $ k_1 $ 均不依赖于 $ \\beta $ 和时间。垂直波矢角呈均匀分布，因此在角度平均后有 $ \\langle k_y^2 \\rangle_{\\theta} = k_{\\perp}^2 / 2 $。\n\n- 对于每个 $ \\mathbf{k} $，湍流退相关时间 $ \\tau_{\\mathbf{k}} $ 对于静电和电磁贡献是相同的，因为两者都源于相同的基本模式寿命。除了此相等关系外，不需要 $ \\tau_{\\mathbf{k}} $ 的具体形式。\n\n- 在随机相位近似下，用于被动导心输运的准线性径向扩散系数由速度自相关构成：$ D = \\int d^2 k_{\\perp} \\, \\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle \\, \\tau_{\\mathbf{k}} $。\n\n- 径向电场叉磁场（E×B）漂移为 $ \\mathbf{v}_{E} = \\mathbf{E} \\times \\mathbf{B}_0 / B^2 $，其中 $ \\mathbf{E} = - \\nabla \\phi $，因此单个傅里叶模式的径向分量大小为 $ v_{r,E}(\\mathbf{k}) = k_y \\phi_{\\mathbf{k}} / B $。\n\n- 磁抖动径向速度为 $ v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\, \\delta B_r(\\mathbf{k}) / B $，其中 $ \\delta \\mathbf{B} = \\nabla \\times (A_{\\parallel} \\hat{\\mathbf{z}}) $，因此 $ \\delta B_r(\\mathbf{k}) $ 的大小为 $ k_y A_{\\parallel, \\mathbf{k}} $。对于电磁耦合，取平行电场 $ E_{\\parallel} \\approx 0 $，根据法拉第定律，在傅里叶空间中意味着 $ \\omega A_{\\parallel, \\mathbf{k}} = k_{\\parallel} \\phi_{\\mathbf{k}} $。此外，假设为阿尔芬色散关系 $ \\omega = k_{\\parallel} v_A $，其中阿尔芬速度为 $ v_A = B / \\sqrt{\\mu_0 n_i m_i} $，$ \\mu_0 $ 是真空磁导率，$ n_i $ 是离子密度，$ m_i $ 是离子质量。在这些假设下，$ A_{\\parallel, \\mathbf{k}} = \\phi_{\\mathbf{k}} / v_A $，因此 $ \\delta B_r(\\mathbf{k}) / B = k_y \\phi_{\\mathbf{k}} / (B v_A) $。\n\n- 考虑离子导心输运。对具有温度 $ T_i $ 的麦克斯韦离子分布进行平行速度平均，其中 $ \\langle v_{\\parallel}^2 \\rangle = T_i / m_i $。\n\n将离子等离子体贝塔值定义为 $ \\beta_i = 2 \\mu_0 n_i T_i / B^2 $。仅使用给定的假设和定义，评估在给定谱上积分的准线性磁抖动扩散系数与准线性静电E×B扩散系数之比 $ R(\\beta_i) $。您的最终答案必须是 $ R(\\beta_i) $ 关于 $ \\beta_i $ 的单个闭合形式解析表达式。最终答案中不要包含单位。",
            "solution": "该问题被评估为有效，因为它在科学上基于等离子体物理学和湍流理论的原理，是自洽的、适定的和客观的。推导所要求的比率所需的所有必要信息和定义均已提供，没有内部矛盾或事实不准确之处。因此，我们可以着手求解。\n\n问题要求计算准线性磁抖动扩散系数 $D_B$ 与准线性静电E×B扩散系数 $D_E$ 之比 $R(\\beta_i)$。准线性径向扩散系数的一般形式为：\n$$ D = \\int d^2 k_{\\perp} \\, \\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle \\, \\tau_{\\mathbf{k}} $$\n在随机相位近似下，相关项为 $\\langle v_r(\\mathbf{k}) v_r(-\\mathbf{k}) \\rangle = |v_r(\\mathbf{k})|^2$。\n\n首先，我们构建静电E×B扩散系数 $D_E$ 的表达式。由E×B漂移引起的单个傅里叶模式 $\\mathbf{k}$ 的径向速度分量为 $v_{r,E}(\\mathbf{k}) = k_y \\phi_{\\mathbf{k}} / B$。其大小的平方为 $|v_{r,E}(\\mathbf{k})|^2 = k_y^2 |\\phi_{\\mathbf{k}}|^2 / B^2$。将此代入通用扩散系数公式可得：\n$$ D_E = \\int d^2 k_{\\perp} \\, \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} $$\n积分是在垂直波矢空间上进行的，$d^2 k_{\\perp} = k_{\\perp} dk_{\\perp} d\\theta$，其中 $\\theta$ 是 $\\mathbf{k}_{\\perp}$ 在平面内的角度。问题指定了角度各向同性的谱，我们可以进行角度积分。我们使用恒等式 $k_y = k_{\\perp} \\sin(\\theta)$。量 $|\\phi_{\\mathbf{k}}|^2$ 和 $\\tau_{\\mathbf{k}}$ 被说明仅是 $k_{\\perp}$ 的函数。角度积分为：\n$$ \\int_0^{2\\pi} k_y^2 d\\theta = \\int_0^{2\\pi} (k_{\\perp} \\sin(\\theta))^2 d\\theta = k_{\\perp}^2 \\int_0^{2\\pi} \\sin^2(\\theta) d\\theta = k_{\\perp}^2 \\pi $$\n这与所提供的关系 $\\langle k_y^2 \\rangle_{\\theta} = \\frac{1}{2\\pi} \\int_0^{2\\pi} k_y^2 d\\theta = k_{\\perp}^2 / 2$ 一致。\n将此代入 $D_E$ 的表达式中：\n$$ D_E = \\int_{k_0}^{k_1} k_{\\perp} dk_{\\perp} \\left( \\frac{(\\pi k_{\\perp}^2) |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} \\right) = \\frac{\\pi}{B^2} \\int_{k_0}^{k_1} k_{\\perp}^3 |\\phi_{\\mathbf{k}}|^2 \\tau_{\\mathbf{k}} dk_{\\perp} $$\n\n接下来，我们构建磁抖动扩散系数 $D_B$ 的表达式。由磁抖动引起的径向速度为 $v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\, \\delta B_r(\\mathbf{k}) / B$。问题提供了一系列假设，导出了 $\\delta B_r(\\mathbf{k}) / B = k_y \\phi_{\\mathbf{k}} / (B v_A)$。因此，速度为：\n$$ v_{r,B}(\\mathbf{k}, v_{\\parallel}) = v_{\\parallel} \\frac{k_y \\phi_{\\mathbf{k}}}{B v_A} $$\n输运是针对离子导心的，所以我们必须对依赖于速度的输运在离子平行速度分布上进行平均，这是一个温度为 $T_i$ 的麦克斯韦分布。为了计算扩散系数，我们需要径向速度平方的平均值：\n$$ \\langle |v_{r,B}(\\mathbf{k}, v_{\\parallel})|^2 \\rangle_{v_{\\parallel}} = \\left\\langle v_{\\parallel}^2 \\left| \\frac{k_y \\phi_{\\mathbf{k}}}{B v_A} \\right|^2 \\right\\rangle_{v_{\\parallel}} = \\langle v_{\\parallel}^2 \\rangle_{v_{\\parallel}} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} $$\n给定 $\\langle v_{\\parallel}^2 \\rangle_{v_{\\parallel}} = T_i / m_i$。将其代入可得：\n$$ \\langle |v_{r,B}(\\mathbf{k})|^2 \\rangle_{v_{\\parallel}} = \\frac{T_i}{m_i} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} $$\n磁抖动扩散系数 $D_B$ 于是为：\n$$ D_B = \\int d^2 k_{\\perp} \\, \\left( \\frac{T_i}{m_i} \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2 v_A^2} \\right) \\tau_{\\mathbf{k}} $$\n我们可以将不依赖于 $\\mathbf{k}_{\\perp}$ 的项提取出来：\n$$ D_B = \\frac{T_i}{m_i v_A^2} \\left[ \\int d^2 k_{\\perp} \\, \\frac{k_y^2 |\\phi_{\\mathbf{k}}|^2}{B^2} \\tau_{\\mathbf{k}} \\right] $$\n方括号中的项恰好是E×B扩散系数 $D_E$ 的表达式。\n$$ D_B = \\frac{T_i}{m_i v_A^2} D_E $$\n\n现在可以直接计算所求的比率 $R(\\beta_i) = D_B / D_E$：\n$$ R(\\beta_i) = \\frac{D_B}{D_E} = \\frac{T_i}{m_i v_A^2} $$\n请注意，这个结果与具体的谱形 $|\\phi_{\\mathbf{k}}|^2 = C k_{\\perp}^{-p}$ 和退相关时间 $\\tau_{\\mathbf{k}}$ 无关，因为这些公共因子在比率中被消掉了。\n\n为了用离子等离子体贝塔值 $\\beta_i$ 来表示这个比率，我们代入阿尔芬速度的定义 $v_A = B / \\sqrt{\\mu_0 n_i m_i}$。阿尔芬速度的平方是：\n$$ v_A^2 = \\frac{B^2}{\\mu_0 n_i m_i} $$\n将此代入比率 $R$ 的表达式中：\n$$ R(\\beta_i) = \\frac{T_i}{m_i \\left( \\frac{B^2}{\\mu_0 n_i m_i} \\right)} = \\frac{T_i \\mu_0 n_i m_i}{m_i B^2} = \\frac{\\mu_0 n_i T_i}{B^2} $$\n最后，我们使用问题中提供的离子等离子体贝塔值的定义：$\\beta_i = 2 \\mu_0 n_i T_i / B^2$。通过重新整理这个定义，我们发现：\n$$ \\frac{\\mu_0 n_i T_i}{B^2} = \\frac{\\beta_i}{2} $$\n因此，该比率的最终表达式为：\n$$ R(\\beta_i) = \\frac{\\beta_i}{2} $$",
            "answer": "$$ \\boxed{\\frac{\\beta_i}{2}} $$"
        },
        {
            "introduction": "理论推导为我们提供了扩散系数的数学形式，但要获得定量的输运水平，我们必须对所有湍流模式的贡献进行积分。本练习提供了一个包含宽谱背景和不稳定模式峰值的写实湍流谱模型，要求你通过数值积分来计算总的准线性扩散系数 。这项编程实践将理论与可量化的预测联系起来，让你亲身体验湍流谱的特征（如峰值位置）如何与输运机制的内禀波数依赖性相互作用，从而共同决定宏观输运的大小。",
            "id": "4198778",
            "problem": "一个具有离子声拉莫尔半径 $\\rho_{s}$ 和离子回旋频率 $\\Omega_{i}$ 的等离子体表现出静电湍流，该湍流通过电场叉磁场漂移（E×B）驱动跨场输运。考虑一个受 E×B 涨落平流影响的被动标量。在准线性近似中，通过将湍流位移建模为随机行走来获得扩散系数，其步速由 E×B 涨落振幅设定，相关时间由线性退相关率设定。在归一化单位下进行计算，其中长度以 $\\rho_{s}$ 为单位，时间以 $1/\\Omega_{i}$ 为单位，因此扩散系数的单位为 $\\rho_{s}^{2}\\Omega_{i}$。\n\n从 E×B 漂移的定义 $\\mathbf{v}_{E} = \\frac{c}{B}\\,\\hat{\\mathbf{z}}\\times \\nabla \\phi$ 和归一化电势涨落振幅 $\\tilde{\\phi} \\equiv e\\phi/T_{e}$ 出发，波数为 $k_{\\perp}$ 处的归一化 E×B 速度满足 $v_{E}/c_{s} \\sim k_{\\perp}\\rho_{s}\\,|\\tilde{\\phi}_{k}|$，其中 $c_{s} = \\sqrt{T_{e}/m_{i}}$ 是离子声速。在各向同性涨落的准线性近似中，归一化扩散系数可以表示为谱积分\n$$\n\\hat{D} \\equiv \\frac{D}{\\rho_{s}^{2}\\Omega_{i}} = \\int_{0}^{\\infty} 2\\pi s \\,\\mathrm{d}s\\; \\left[s^{2}\\,P(s)\\,\\hat{\\tau}(s)\\right],\n$$\n其中 $s \\equiv k_{\\perp}\\rho_{s}$ 是无量纲垂直波数，$P(s)$ 是归一化电势涨落的无量纲谱密度（使得 $2\\pi\\int_{0}^{\\infty} s\\,P(s)\\,\\mathrm{d}s$ 等于 $\\tilde{\\phi}$ 的方差），而 $\\hat{\\tau}(s)$ 是以 $1/\\Omega_{i}$ 为单位的无量纲相关时间。\n\n假设一个宽带谱叠加一个在 $s \\approx 0.3$ 附近的高斯峰，模型如下\n$$\nP(s) = A\\, s^{\\alpha}\\, \\exp\\!\\left[-\\left(\\frac{s}{s_{b}}\\right)^{p}\\right]\\left[1 + r\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma^{2}}\\right)\\right],\n$$\n以及一个由峰值增长率模型决定的退相关时间\n$$\n\\hat{\\tau}(s) = \\frac{1}{\\hat{\\gamma}(s) + \\nu}, \\qquad \\hat{\\gamma}(s) = \\gamma_{0}\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma_{g}^{2}}\\right),\n$$\n其中 $A$、$\\alpha$、$s_{b}$、$p$ 设定宽带背景形状，$r$ 控制峰值强度，$s_{0}$ 是峰值位置，$\\sigma$ 是谱峰宽度，$\\gamma_{0}$ 是峰值增长率，$\\sigma_{g}$ 是增长率宽度，$\\nu$ 是一个代表额外剪切或阻尼的恒定退相关率。在所述的归一化标准下，所有量均为无量纲。\n\n您的任务是编写一个程序，使用上述模型在 $s \\in [0,s_{\\max}]$ 区间内对 $\\hat{D}$ 的积分进行数值计算。此计算需针对以下一系列参数集进行，这些参数集旨在探究移动峰值位置以及修改峰宽或退相关性的影响：\n\n- 情况 1（基准情况）：$A = 0.8$, $\\alpha = 1.0$, $s_{b} = 2.0$, $p = 2$, $r = 2.0$, $s_{0} = 0.30$, $\\sigma = 0.07$, $\\gamma_{0} = 0.15$, $\\sigma_{g} = 0.08$, $\\nu = 0.05$, $s_{\\max} = 4.0$。\n- 情况 2（较低峰值）：与情况 1 相同，但 $s_{0} = 0.20$。\n- 情况 3（较高峰值）：与情况 1 相同，但 $s_{0} = 0.50$。\n- 情况 4（窄谱峰）：与情况 1 相同，但 $\\sigma = 0.03$。\n- 情况 5（强剪切退相关）：与情况 1 相同，但 $\\nu = 0.30$。\n- 情况 6（无附加峰，纯宽带背景）：与情况 1 相同，但 $r = 0.0$。\n\n所有积分必须被计算以生成 $\\hat{D}$ 的浮点值，单位为 $\\rho_{s}^{2}\\Omega_{i}$。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，\"[result1,result2,...]\"），结果顺序与上述情况列表一致。\n\n要求：\n- 根据所述基本原理推导准线性扩散系数。\n- 以足够的分辨率实现数值积分，以捕捉谱和峰值。\n- 所有结果以指定单位的浮点数表示。\n- 不涉及角度；不要使用角度单位。\n- 不涉及百分比；不要使用百分号。\n- 最终打印的输出必须与指定的单行格式完全匹配。\n\n最后，在您的解答中，请参考被积函数的结构，特别是 E×B 速度的 $s^{2}$ 权重以及 $\\hat{\\tau}(s)$ 对 $\\hat{\\gamma}(s)$ 的依赖性，解释为什么移动峰值 $s_{0}$ 会改变 $\\hat{D}$。",
            "solution": "该问题陈述具有科学依据，提法明确且客观。它为基于等离子体物理学中标准的准线性模型进行湍流扩散系数的数值计算，提供了一套完整的方程、参数和条件。所有术语都得到了明确定义，其物理背景在聚变等离子体湍流领域中是标准的。因此，该问题被认为是有效的，并将提供解答。\n\n主要任务是计算由静电湍流平流的被动标量的归一化准线性扩散系数 $\\hat{D}$。扩散系数由以下谱积分给出：\n$$\n\\hat{D} \\equiv \\frac{D}{\\rho_{s}^{2}\\Omega_{i}} = \\int_{0}^{\\infty} 2\\pi s \\,\\mathrm{d}s\\; \\left[s^{2}\\,P(s)\\,\\hat{\\tau}(s)\\right]\n$$\n该公式源于输运的随机行走模型，其中扩散系数近似为 $D \\sim v_{\\text{eff}}^{2}\\tau_{c}$。在这里，$v_{\\text{eff}}$ 是有效湍流速度，$\\tau_{c}$ 是湍流相关时间。在 E×B 湍流的背景下，速度是 E×B 漂移，$\\mathbf{v}_{E} = \\frac{c}{B}\\hat{\\mathbf{z}}\\times \\nabla \\phi$。对于具有垂直波数 $k_{\\perp}$ 的单个傅里叶模式，其速度大小约为 $v_{E,k} \\sim k_{\\perp} \\phi_k$（在适当单位下）。因此，该模式对扩散系数的贡献与 $(k_{\\perp} \\phi_k)^2 \\tau_k$ 成正比，其中 $\\tau_k$ 是该模式的相关时间。\n\n所提供的公式代表总扩散系数，它是通过在整个波数谱上对这些贡献进行积分得到的。在给定的归一化单位中，无量纲波数为 $s \\equiv k_{\\perp}\\rho_{s}$。被积函数中的 $s^2$ 项反映了 E×B 速度平方对 $k_{\\perp}^2$ 的依赖性。函数 $P(s)$ 是归一化电势涨落 $\\tilde{\\phi}$ 的谱密度，表示在波数 $s$ 处的涨落功率 $|\\tilde{\\phi}_s|^2$。函数 $\\hat{\\tau}(s)$ 是无量纲相关时间。微分元 $2\\pi s\\,\\mathrm{d}s$ 是二维各向同性波数空间中一个环形区域的面积。通过合并各项重写积分，我们必须计算：\n$$\n\\hat{D} = \\int_{0}^{s_{\\max}} 2\\pi s^3 \\,P(s)\\,\\hat{\\tau}(s)\\,\\mathrm{d}s\n$$\n这里，到无穷大的积分被近似为到一个足够大的波数 $s_{\\max}$ 的积分，超过该波数后，谱 $P(s)$ 变得可以忽略不计。谱 $P(s)$ 和相关时间 $\\hat{\\tau}(s)$ 的具体函数形式已给出：\n$$\nP(s) = A\\, s^{\\alpha}\\, \\exp\\!\\left[-\\left(\\frac{s}{s_{b}}\\right)^{p}\\right]\\left[1 + r\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma^{2}}\\right)\\right]\n$$\n$$\n\\hat{\\tau}(s) = \\frac{1}{\\hat{\\gamma}(s) + \\nu}, \\qquad \\text{其中} \\qquad \\hat{\\gamma}(s) = \\gamma_{0}\\, \\exp\\!\\left(-\\frac{(s - s_{0})^{2}}{2\\sigma_{g}^{2}}\\right)\n$$\n通过实现这些函数并使用数值积分算法来为六个指定的参数集中的每一个评估定积分，从而完成计算。`scipy.integrate.quad` 函数适用于此目的，因为它提供了一个鲁棒的自适应算法，能够处理被积函数的峰值特性。\n\n该问题还要求解释为什么移动谱峰位置 $s_{0}$ 会改变 $\\hat{D}$ 的值。这可以通过检查被积函数 $I(s) = 2\\pi s^3 P(s) \\hat{\\tau}(s)$ 的结构来理解。\n\n1. **波数加权**：被积函数中的 $s^3$ 项作为一个强加权因子。它是 E×B 速度平方中的 $s^2$（即 $(v_E/c_s)^2 \\propto s^2$）与波数空间中径向积分测度 $2\\pi s\\,\\mathrm{d}s$ 中的 $s$ 的乘积。这个 $s^3$ 因子意味着，在所有其他因素相同的情况下，较高波数（较大的 $s$）的湍流涨落在驱动输运方面本质上更有效。\n\n2. **谱功率与相关时间**：电势谱 $P(s)$ 和线性增长率 $\\hat{\\gamma}(s)$ 都被建模为以 $s = s_{0}$ 为中心的峰。这意味着湍流在 $s_0$ 附近的局部区域内最强。然而，相关时间 $\\hat{\\tau}(s) = 1/(\\hat{\\gamma}(s) + \\nu)$ 在 $s=s_0$ 附近*最短*，因为大的增长率会导致快速的退相关。这代表了一种自调节机制，即最不稳定的模式也是最瞬态的。\n\n3. **综合效应**：当 $s_0$ 移动时，湍流谱 $P(s)$ 的峰值会沿着 $s$ 轴移动。\n- 如果 $s_0$ 增加（例如，从情况 1 的 $s_0 = 0.30$ 到情况 3 的 $s_0 = 0.50$），$P(s)$ 的峰值会移动到 $s^3$ 加权因子显著更大的区域。例如，$(0.50)^3 = 0.125$ 比 $(0.30)^3 = 0.027$ 大四倍多。这种放大效应通常占主导地位，导致总积分扩散系数 $\\hat{D}$ 大幅增加。\n- 相反，如果 $s_0$ 减小（从情况 1 的 $s_0 = 0.30$ 到情况 2 的 $s_0 = 0.20$），$P(s)$ 的峰值会移动到 $s^3$ 加权小得多的区域。这导致总扩散系数 $\\hat{D}$ 显著减小。\n\n因此，湍流峰的位置 $s_0$ 是决定整体输运水平的关键参数，这主要是通过它与准线性扩散系数积分中强 $s^3$ 加权的相互作用实现的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Calculates the quasilinear diffusivity for a series of test cases\n    by numerically integrating the specified model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a dictionary of parameters.\n    base_case = {\n        'A': 0.8, 'alpha': 1.0, 'sb': 2.0, 'p': 2, 'r': 2.0,\n        's0': 0.30, 'sigma': 0.07, 'gamma0': 0.15, 'sigmag': 0.08,\n        'nu': 0.05, 's_max': 4.0\n    }\n\n    test_cases = [\n        # Case 1 (baseline happy path)\n        base_case,\n        # Case 2 (lower peak)\n        {**base_case, 's0': 0.20},\n        # Case 3 (higher peak)\n        {**base_case, 's0': 0.50},\n        # Case 4 (narrow spectral peak)\n        {**base_case, 'sigma': 0.03},\n        # Case 5 (strong shear decorrelation)\n        {**base_case, 'nu': 0.30},\n        # Case 6 (no added peak, pure broadband background)\n        {**base_case, 'r': 0.0}\n    ]\n\n    results = []\n\n    for params in test_cases:\n        \n        # Unpack parameters for the current case\n        A = params['A']\n        alpha = params['alpha']\n        sb = params['sb']\n        p = params['p']\n        r = params['r']\n        s0 = params['s0']\n        sigma = params['sigma']\n        gamma0 = params['gamma0']\n        sigmag = params['sigmag']\n        nu = params['nu']\n        s_max = params['s_max']\n\n        # Define the functions for the integrand\n        \n        def p_spectrum(s):\n            \"\"\"\n            Calculates the dimensionless spectral density P(s).\n            \"\"\"\n            if s == 0.0 and alpha > 0:\n                return 0.0\n            \n            broadband_part = A * (s**alpha) * np.exp(-((s / sb)**p))\n            peak_part = 1.0 + r * np.exp(-((s - s0)**2) / (2 * sigma**2))\n            \n            return broadband_part * peak_part\n\n        def tau_corr(s):\n            \"\"\"\n            Calculates the dimensionless correlation time tau_hat(s).\n            \"\"\"\n            gamma_hat = gamma0 * np.exp(-((s - s0)**2) / (2 * sigmag**2))\n            return 1.0 / (gamma_hat + nu)\n\n        def integrand(s):\n            \"\"\"\n            Defines the full integrand for the diffusivity integral.\n            Integrand = 2 * pi * s^3 * P(s) * tau(s)\n            \"\"\"\n            return 2 * np.pi * (s**3) * p_spectrum(s) * tau_corr(s)\n\n        # Perform the numerical integration\n        # The quad function returns the integral and an error estimate. We only need the integral.\n        integral, _ = integrate.quad(integrand, 0, s_max)\n        \n        results.append(integral)\n\n    # Final print statement in the exact required format.\n    # The output should be a single line: a list of comma-separated floats\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}