{
    "hands_on_practices": [
        {
            "introduction": "要理解测地声学模（Geodesic Acoustic Modes, GAMs），必须从其在托卡马克磁约束几何中的物理起源入手。本练习提供了从第一性原理出发，推导测地曲率项的实践机会。测地曲率正是导致电荷分离并最终驱动GAM振荡的关键因素，通过这个练习，你将能够把抽象的几何概念与具体的物理作用力联系起来。",
            "id": "4190155",
            "problem": "考虑一个具有圆形、同心磁通量面的轴对称托卡马克。设磁面坐标为 $(r,\\theta,\\phi)$，其中 $r$ 是小半径，$\\theta$ 是极向角（从外侧中平面量起），$\\phi$ 是环向角。柱坐标 $(R,\\phi,Z)$ 通过 $R(r,\\theta) = R_{0} + r \\cos\\theta$ 和 $Z(r,\\theta) = r \\sin\\theta$ 与每个磁通量面上的 $(r,\\theta)$ 相关联，其中 $R_{0}$ 是磁轴的大半径。磁通量面上的线元为\n$$\nds^{2} = dr^{2} + r^{2} d\\theta^{2} + R^{2}(r,\\theta) d\\phi^{2}.\n$$\n假设磁场是轴对称的，并且主要是环向的，带有一个小的极向分量，因此沿磁场的单位矢量可以写为\n$$\n\\hat{b} = \\frac{B_{\\phi}}{B}\\,\\hat{e}_{\\phi} + \\frac{B_{\\theta}}{B}\\,\\hat{e}_{\\theta},\n$$\n其中 $B = |\\mathbf{B}|$，$B_{\\phi} \\gg B_{\\theta}$，$\\hat{e}_{\\phi}$ 和 $\\hat{e}_{\\theta}$ 分别是沿环向和极向的单位矢量。磁力线的曲率由几何恒等式定义\n$$\n\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}.\n$$\n在与测地声学模 (GAMs) 相关的极向动量平衡中，测地曲率是 $\\boldsymbol{\\kappa}$ 在面内的分量投影到极向方向上，即\n$$\n\\kappa_{g}(\\theta) = \\boldsymbol{\\kappa}\\cdot\\hat{e}_{\\theta}.\n$$\n仅从给定的度规和这些几何定义出发，并在大环径比极限 $B_{\\phi}/B \\approx 1$ 下，推导测地曲率 $\\kappa_{g}(\\theta)$ 作为 $r$、$\\theta$ 和 $R_{0}$ 的函数的解析表达式。将您的最终答案表示为 $\\kappa_{g}(\\theta)$ 的单个闭合形式表达式。不要进行任何数值计算。最终表达式中不需要单位。",
            "solution": "该问题要求推导具有圆形、同心磁通量面的轴对称托卡马克中的测地曲率 $\\kappa_g(\\theta)$。测地曲率定义为磁力线曲率矢量 $\\boldsymbol{\\kappa}$ 的极向分量。推导将从曲率矢量 $\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}$ 的基本定义开始，利用所提供的环向坐标系和大环径比近似。\n\n首先，我们确定指定的坐标系 $(r, \\theta, \\phi)$ 的性质。线元由 $ds^{2} = dr^{2} + r^{2} d\\theta^{2} + R^{2}(r,\\theta) d\\phi^{2}$ 给出，其中 $R(r,\\theta) = R_{0} + r \\cos\\theta$。这是一个正交坐标系。标度因子为 $h_r = 1$、$h_\\theta = r$ 和 $h_\\phi = R(r,\\theta)$。标准正交基矢量记为 $\\hat{e}_r$、$\\hat{e}_\\theta$ 和 $\\hat{e}_\\phi$。\n\n在这个正交坐标系中，梯度算子 $\\nabla$ 由下式给出：\n$$\n\\nabla = \\frac{\\hat{e}_r}{h_r}\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{h_\\theta}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{h_\\phi}\\frac{\\partial}{\\partial \\phi} = \\hat{e}_r\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\n$$\n\n沿磁场的单位矢量 $\\hat{b}$ 给出为 $\\hat{b} = \\frac{B_{\\phi}}{B}\\,\\hat{e}_{\\phi} + \\frac{B_{\\theta}}{B}\\,\\hat{e}_{\\theta}$。为方便起见，令 $b_\\phi = \\frac{B_\\phi}{B}$ 和 $b_\\theta = \\frac{B_\\theta}{B}$，因此 $\\hat{b} = b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta$。注意，根据单位矢量的定义，我们有恒等式 $b_\\phi^2 + b_\\theta^2 = 1$。算子 $(\\hat{b}\\cdot\\nabla)$ 是沿磁力线的方向导数：\n$$\n\\hat{b}\\cdot\\nabla = (b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta) \\cdot \\left(\\hat{e}_r\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\\right) = \\frac{b_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{b_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\n$$\n这里，我们使用了基矢量的正交性，即 $\\hat{e}_i \\cdot \\hat{e}_j = \\delta_{ij}$。\n\n为了计算曲率 $\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}$，我们必须评估方向导数对矢量 $\\hat{b}$ 的作用。这需要基矢量的偏导数。对于所定义的环向坐标系，它们是：\n$$\n\\begin{array}{lll}\n\\frac{\\partial \\hat{e}_r}{\\partial \\theta} = \\hat{e}_\\theta, & \\frac{\\partial \\hat{e}_\\theta}{\\partial \\theta} = -\\hat{e}_r, & \\frac{\\partial \\hat{e}_\\phi}{\\partial \\theta} = 0 \\\\\n\\frac{\\partial \\hat{e}_r}{\\partial \\phi} = \\hat{e}_\\phi \\cos\\theta, & \\frac{\\partial \\hat{e}_\\theta}{\\partial \\phi} = -\\hat{e}_\\phi \\sin\\theta, & \\frac{\\partial \\hat{e}_\\phi}{\\partial \\phi} = -\\hat{e}_r \\cos\\theta + \\hat{e}_\\theta \\sin\\theta\n\\end{array}\n$$\n由于系统是轴对称的，磁场的标量分量 $B_\\phi$ 和 $B_\\theta$ 以及它们的比值 $b_\\phi$ 和 $b_\\theta$ 都与环向角 $\\phi$ 无关。因此，$\\frac{\\partial b_\\phi}{\\partial \\phi} = 0$ 和 $\\frac{\\partial b_\\theta}{\\partial \\phi} = 0$。\n\n现在我们计算 $\\boldsymbol{\\kappa}$：\n$$\n\\boldsymbol{\\kappa} = \\left(\\frac{b_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{b_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\\right) (b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta)\n$$\n展开导数项：\n$$\n\\boldsymbol{\\kappa} = \\frac{b_\\theta}{r} \\left( \\frac{\\partial b_\\phi}{\\partial \\theta} \\hat{e}_\\phi + b_\\phi \\frac{\\partial \\hat{e}_\\phi}{\\partial \\theta} + \\frac{\\partial b_\\theta}{\\partial \\theta} \\hat{e}_\\theta + b_\\theta \\frac{\\partial \\hat{e}_\\theta}{\\partial \\theta} \\right) + \\frac{b_\\phi}{R} \\left( \\frac{\\partial b_\\phi}{\\partial \\phi} \\hat{e}_\\phi + b_\\phi \\frac{\\partial \\hat{e}_\\phi}{\\partial \\phi} + \\frac{\\partial b_\\theta}{\\partial \\phi} \\hat{e}_\\theta + b_\\theta \\frac{\\partial \\hat{e}_\\theta}{\\partial \\phi} \\right)\n$$\n代入基矢量的导数和轴对称条件：\n$$\n\\boldsymbol{\\kappa} = \\frac{b_\\theta}{r} \\left( \\frac{\\partial b_\\phi}{\\partial \\theta} \\hat{e}_\\phi + b_\\phi (0) + \\frac{\\partial b_\\theta}{\\partial \\theta} \\hat{e}_\\theta + b_\\theta (-\\hat{e}_r) \\right) + \\frac{b_\\phi}{R} \\left( (0) \\hat{e}_\\phi + b_\\phi (-\\hat{e}_r \\cos\\theta + \\hat{e}_\\theta \\sin\\theta) + (0) \\hat{e}_\\theta + b_\\theta (-\\hat{e}_\\phi \\sin\\theta) \\right)\n$$\n合并每个基矢量的项：\n$$\n\\boldsymbol{\\kappa} = \\left(-\\frac{b_\\theta^2}{r} - \\frac{b_\\phi^2 \\cos\\theta}{R}\\right) \\hat{e}_r + \\left(\\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta} + \\frac{b_\\phi^2 \\sin\\theta}{R}\\right) \\hat{e}_\\theta + \\left(\\frac{b_\\theta}{r}\\frac{\\partial b_\\phi}{\\partial \\theta} - \\frac{b_\\phi b_\\theta \\sin\\theta}{R}\\right) \\hat{e}_\\phi\n$$\n测地曲率是 $\\boldsymbol{\\kappa}$ 在极向方向上的分量，$\\kappa_g(\\theta) = \\boldsymbol{\\kappa} \\cdot \\hat{e}_\\theta$。将 $\\boldsymbol{\\kappa}$ 的表达式投影到 $\\hat{e}_\\theta$ 上，得到 $\\kappa_g(\\theta)$ 的精确表达式：\n$$\n\\kappa_g(\\theta) = \\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta} + \\frac{b_\\phi^2 \\sin\\theta}{R}\n$$\n问题指定我们应在大环径比极限 $B_\\phi/B \\approx 1$ 下进行计算。这对应于极限 $b_\\phi \\to 1$。根据恒等式 $b_\\phi^2 + b_\\theta^2 = 1$，当 $b_\\phi \\to 1$ 时，必然有 $b_\\theta \\to 0$。第一项 $\\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta}$ 包含小量 $b_\\theta$ 及其导数的乘积，因此在此极限下消失。第二项 $\\frac{b_\\phi^2 \\sin\\theta}{R}$，在 $b_\\phi \\to 1$ 时趋近于 $\\frac{\\sin\\theta}{R}$。\n\n因此，在指定极限下，测地曲率为：\n$$\n\\kappa_g(\\theta) \\approx \\frac{\\sin\\theta}{R}\n$$\n最后，代入大半径坐标的给定表达式 $R = R_0 + r \\cos\\theta$：\n$$\n\\kappa_g(\\theta) = \\frac{\\sin\\theta}{R_0 + r \\cos\\theta}\n$$\n这是在指定条件下推导出的，作为 $r$、$\\theta$ 和 $R_0$ 函数的测地曲率的解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\sin\\theta}{R_{0} + r \\cos\\theta}}\n$$"
        },
        {
            "introduction": "在掌握了GAM的驱动力来源之后，下一步便是确定该模式的特征频率。本练习基于测地曲率的概念，构建一个简化的流体模型来描述GAM，从而推导出其振荡频率。更重要的是，通过引入等离子体截面形状（如此处的椭圆度），你将探索更真实的几何效应对这一基本性质的修正，加深对理论模型如何应用于复杂构型的理解。",
            "id": "4190085",
            "problem": "考虑一个大环径比的托卡马克，其大半径为 $R_{0}$，小半径为 $r$，具有小椭圆度 $\\delta$ 和可忽略的拉长。假设一个静电测地声学模 (GAM)，定义为带状流和势的轴对称 ($m=0$, $n=0$) 振荡，通过测地曲率与一个极向变化的 $m=1$ 压力边带耦合。使用简化的类 Miller 位形来模拟平衡，其中测地曲率在 $\\delta$ 的一阶近似下由下式给出：\n$$\n\\kappa_{g}(\\theta) \\equiv \\frac{1}{R_{0}}\\left[\\sin\\theta + \\delta \\sin(2\\theta)\\right],\n$$\n其中 $\\theta$ 是几何极向角。\n\n采用漂移简化流体描述，其中离子为等温的，温度为 $T_{i}$，电子为绝热的（对于非带状分量呈玻尔兹曼响应）。极向 $\\boldsymbol{E}\\times\\boldsymbol{B}$ 流取为 $\\boldsymbol{v}_{E} = \\hat{\\theta}\\,U_{\\theta}(t)$，其中 $U_{\\theta}(t) = (c/B_{0})\\,\\partial_{r}\\phi_{0}(t)$，并且 $B_{0}$ 在大环径比的领头阶上为常数。使用离子连续性方程和测地曲率引起的压缩性，将 $m=1$ 压力边带 $p_{1}(\\theta, t)$ 与 $U_{\\theta}(t)$ 联系起来：\n$$\n\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0,\\quad \\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\,\\kappa_{g}(\\theta)\\,U_{\\theta}(t),\\quad p_{1}(\\theta,t) = T_{i}\\,n_{1}(\\theta,t),\n$$\n其中 $n_{0}$ 是平衡密度。使用将边带耦合回带状流的曲率力密度来闭合该系统，\n$$\nf_{r}(\\theta,t) = -\\,p_{1}(\\theta,t)\\,\\kappa_{g}(\\theta),\n$$\n并进行极向平均以获得带状流的演化：\n$$\nm_{i}\\,n_{0}\\,\\partial_{t}U_{\\theta}(t) = -\\,\\langle f_{r}(\\theta,t)\\rangle_{\\theta},\n$$\n其中 $m_{i}$ 是离子质量，$\\langle\\cdot\\rangle_{\\theta}$ 表示在 $\\theta$ 上的 $2\\pi$ 极向平均。\n\n仅使用这些基础，并保留 $\\delta$ 的最低非平凡阶项，推导：\n\n1. 由椭圆度 $\\delta$ 引起的压力边带 $p_{1}(\\theta,t)$ 极向变化的领头阶修正。\n\n2. 相应的由椭圆度引起的 GAM 频率 $\\omega_{G}(\\delta)$ 相对于无位形圆形极限 $\\omega_{G0}$ (由 $\\delta=0$ 的相同模型定义) 的第一个非零频移。\n\n将最终的 GAM 频率表示为 $\\omega_{G0}$ 和 $\\delta$ 的闭合形式解析表达式。同时，将 $p_{1}(\\theta,t)$ 的极向变化表示为闭合形式，即一个含时振幅 $P_{0}(t)$ 乘以一个关于 $\\theta$ 和 $\\delta$ 的显式函数。您的最终答案必须是单个解析表达式或单个行矩阵的解析表达式。如果提供两个表达式，请使用 $\\mathrm{pmatrix}$ 环境将它们合并为单个行矩阵。无需进行数值计算。",
            "solution": "首先将根据所需标准对用户提供的问题进行验证。\n\n### 步骤1：提取给定条件\n- **几何与位形**：大环径比托卡马克，大半径 $R_{0}$，小半径 $r$，小椭圆度 $\\delta$。\n- **关心的模式**：静电测地声学模 (GAM)，轴对称 ($m=0$, $n=0$)。\n- **测地曲率模型**：$\\kappa_{g}(\\theta) \\equiv \\frac{1}{R_{0}}\\left[\\sin\\theta + \\delta \\sin(2\\theta)\\right]$，其中 $\\theta$ 是极向角。\n- **等离子体模型**：漂移简化流体描述，等温离子（温度 $T_{i}$，质量 $m_{i}$），绝热电子（对于非带状分量呈玻尔兹曼响应）。\n- **流的定义**：极向 $\\boldsymbol{E}\\times\\boldsymbol{B}$ 流 $\\boldsymbol{v}_{E} = \\hat{\\theta}\\,U_{\\theta}(t)$，速度为 $U_{\\theta}(t) = (c/B_{0})\\,\\partial_{r}\\phi_{0}(t)$。$B_{0}$ 是一个领头阶常数磁场。\n- **控制方程**：\n    1. 离子连续性：$\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0$，其中 $n_0$ 是平衡密度，$n_1$ 是密度微扰。\n    2. 压缩性关系：$\\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\,\\kappa_{g}(\\theta)\\,U_{\\theta}(t)$。\n    3. 状态方程：$p_{1}(\\theta,t) = T_{i}\\,n_{1}(\\theta,t)$，其中 $p_1$ 是压力边带。\n    4. 曲率力密度：$f_{r}(\\theta,t) = -\\,p_{1}(\\theta,t)\\,\\kappa_{g}(\\theta)$。\n    5. 带状流演化：$m_{i}\\,n_{0}\\,\\partial_{t}U_{\\theta}(t) = -\\,\\langle f_{r}(\\theta,t)\\rangle_{\\theta}$。\n- **平均算符**：$\\langle\\cdot\\rangle_{\\theta}$ 是在 $\\theta$ 上从 $0$ 到 $2\\pi$ 的极向平均。\n- **目标**：\n    1. 推导由 $\\delta$ 引起的压力边带 $p_{1}(\\theta,t)$ 极向变化的领头阶修正。\n    2. 推导由椭圆度引起的 GAM 频率 $\\omega_{G}(\\delta)$ 相对于圆形情况 $\\omega_{G0}$（其中 $\\delta=0$）的第一个非零频移。\n- **要求的输出格式**：$p_{1}(\\theta,t)$（用通用振幅 $P_0(t)$ 表示）和 $\\omega_{G}(\\delta)$（用 $\\omega_{G0}$ 和 $\\delta$ 表示）的闭合形式解析表达式。\n\n### 步骤2：使用提取的给定条件进行验证\n对问题进行验证：\n- **科学依据**：该问题在等离子体湍流和磁流体动力学理论中有坚实的基础。所提出的模型是用于研究托卡马克中测地声学模的标准简化流体模型。连续性方程、由测地曲率引起的流体压缩性以及对带状流的反作用力是该主题的基础。\n- **适定性**：该问题是适定的。它提供了一套完整、闭合的线性化方程组，并要求从中得出色散关系（频率）和模结构（压力变化）。按 $\\delta$ 的最低非平凡阶进行计算的指令提供了一个清晰且标准的微扰计算程序。预期会得到频率和模结构的唯一解。\n- **客观性**：问题陈述使用精确、客观和标准的科学语言编写，没有歧义或主观论断。\n\n该问题没有说明中列出的任何缺陷。它在科学上是合理的、可形式化的、完整的和自洽的。参数和模型虽然经过简化，但在所述近似范围内是物理上可信的。该问题是理论等离子体物理学中一个非平凡但可解的练习。\n\n### 步骤3：结论与行动\n问题是 **有效的**。将提供完整解答。\n\n### 解答推导\n推导过程通过依次应用所提供的方程来构建一个描述 GAM 振荡的闭合系统。\n\n**1. 压力边带 $p_{1}(\\theta,t)$ 的推导**\n\n我们从离子连续性方程和给定的压缩性关系开始：\n$$\n\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0\n$$\n代入 $\\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\kappa_{g}(\\theta)U_{\\theta}(t)$，我们得到：\n$$\n\\partial_{t}n_{1} - n_{0}\\kappa_{g}(\\theta)U_{\\theta}(t) = 0\n$$\n$$\n\\partial_{t}n_{1} = n_{0}\\kappa_{g}(\\theta)U_{\\theta}(t)\n$$\n使用等温离子状态方程 $p_{1}(\\theta,t) = T_{i}n_{1}(\\theta,t)$，我们可以写出压力边带的时间演化：\n$$\n\\partial_{t}p_{1}(\\theta,t) = T_{i}\\partial_{t}n_{1} = n_{0}T_{i}\\kappa_{g}(\\theta)U_{\\theta}(t)\n$$\n对于振荡模式，压力微扰 $p_{1}$ 必须与流速 $U_{\\theta}(t)$ 的时间积分相关。如果我们假设谐波时间依赖性，其中 $U_{\\theta}(t)$ 与 $\\sin(\\omega_{G}t)$ 成正比，那么 $p_{1}(\\theta,t)$ 将与 $\\cos(\\omega_{G}t)$ 成正比。\n对该方程关于时间积分，我们发现 $p_{1}$ 的极向结构与测地曲率 $\\kappa_{g}(\\theta)$ 直接成正比：\n$$\np_{1}(\\theta,t) \\propto \\kappa_{g}(\\theta) \\int^t U_{\\theta}(t') dt'\n$$\n代入给定的 $\\kappa_{g}(\\theta) = \\frac{1}{R_{0}}\\left[\\sin\\theta + \\delta \\sin(2\\theta)\\right]$ 表达式，$p_{1}$ 的极向依赖性由 $(\\sin\\theta + \\delta \\sin(2\\theta))$ 给出。我们可以通过定义一个含时振幅 $P_{0}(t)$ 来吸收所有其他因子，从而以要求的格式表示它：\n$$\np_{1}(\\theta,t) = P_{0}(t) \\left( \\sin\\theta + \\delta\\sin(2\\theta) \\right)\n$$\n该表达式直接解决了第一个目标。在圆形托卡马克 ($\\delta=0$) 中，领头阶的压力变化具有 $\\sin\\theta$ 依赖性。由椭圆度 $\\delta$ 引起的领头阶修正是增加了与 $\\delta\\sin(2\\theta)$ 成正比的项。\n\n**2. GAM 频率 $\\omega_{G}(\\delta)$ 的推导**\n\n接下来，我们使用带状流演化方程来求解 GAM 频率。带状流速度 $U_{\\theta}(t)$ 的演化由极向平均的曲率力驱动：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = -\\langle f_{r}(\\theta,t)\\rangle_{\\theta}\n$$\n力密度为 $f_{r}(\\theta,t) = -p_{1}(\\theta,t)\\kappa_{g}(\\theta)$，因此方程变为：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = \\langle p_{1}(\\theta,t)\\kappa_{g}(\\theta) \\rangle_{\\theta}\n$$\n我们代入关系 $\\partial_t p_1 = n_0 T_i \\kappa_g(\\theta) U_\\theta(t)$，它可以写成积分形式 $p_{1}(\\theta,t) = n_{0}T_{i}\\kappa_{g}(\\theta) \\int^{t} U_{\\theta}(t') dt'$（假设振荡从零开始）。将此式代入带状流方程得到：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = \\left\\langle \\left( n_{0}T_{i}\\kappa_{g}(\\theta) \\int^{t} U_{\\theta}(t') dt' \\right) \\kappa_{g}(\\theta) \\right\\rangle_{\\theta}\n$$\n项 $n_{0}$、$T_{i}$ 和时间积分不依赖于极向角 $\\theta$，因此可以移到平均算符之外：\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = n_{0}T_{i} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} \\int^{t} U_{\\theta}(t') dt'\n$$\n除以 $m_{i}n_{0}$ 得到：\n$$\n\\partial_{t}U_{\\theta}(t) = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} \\int^{t} U_{\\theta}(t') dt'\n$$\n为了得到一个标准的微分方程，我们对两边关于时间 $t$ 求导：\n$$\n\\partial_{t}^{2}U_{\\theta}(t) = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} U_{\\theta}(t)\n$$\n这可以重排成简谐振子方程的标准形式：\n$$\n\\partial_{t}^{2}U_{\\theta}(t) + \\omega_{G}^{2} U_{\\theta}(t) = 0\n$$\n其中 GAM 频率的平方被确定为：\n$$\n\\omega_{G}^{2} = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta}\n$$\n这里，$v_{ti} = \\sqrt{T_{i}/m_{i}}$ 是离子热速度。现在我们必须计算 $\\kappa_g^2(\\theta)$ 的极向平均。\n$$\n\\kappa_{g}^{2}(\\theta) = \\frac{1}{R_{0}^{2}} \\left( \\sin\\theta + \\delta \\sin(2\\theta) \\right)^{2} = \\frac{1}{R_{0}^{2}} \\left( \\sin^{2}\\theta + 2\\delta \\sin\\theta \\sin(2\\theta) + \\delta^{2}\\sin^{2}(2\\theta) \\right)\n$$\n极向平均 $\\langle F(\\theta) \\rangle_{\\theta}$ 是 $\\frac{1}{2\\pi}\\int_{0}^{2\\pi} F(\\theta) d\\theta$。我们使用标准积分：对于整数 $k \\neq 0$，$\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin^{2}(k\\theta)d\\theta = \\frac{1}{2}$；对于整数 $A \\neq B$，$\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin(A\\theta)\\sin(B\\theta)d\\theta = 0$。\n$$\n\\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} = \\frac{1}{R_{0}^{2}} \\left( \\langle \\sin^{2}\\theta \\rangle_{\\theta} + 2\\delta \\langle \\sin\\theta \\sin(2\\theta) \\rangle_{\\theta} + \\delta^{2} \\langle \\sin^{2}(2\\theta) \\rangle_{\\theta} \\right)\n$$\n$$\n\\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} = \\frac{1}{R_{0}^{2}} \\left( \\frac{1}{2} + 2\\delta(0) + \\delta^{2}\\frac{1}{2} \\right) = \\frac{1}{2R_{0}^{2}} (1 + \\delta^{2})\n$$\n$\\delta$ 的线性项消失。因此，由椭圆度引起的第一个非零修正是 $\\delta^{2}$ 阶的。这与问题的要求一致。\n\n将此结果代回 $\\omega_{G}^{2}$ 的表达式中：\n$$\n\\omega_{G}^{2}(\\delta) = \\frac{T_{i}}{m_{i}} \\frac{1}{2R_{0}^{2}} (1 + \\delta^{2}) = \\frac{v_{ti}^{2}}{2R_{0}^{2}}(1 + \\delta^{2})\n$$\n在无位形圆形极限下的 GAM 频率 $\\omega_{G0}$，通过设置 $\\delta=0$ 找到：\n$$\n\\omega_{G0}^{2} = \\omega_{G}^{2}(\\delta=0) = \\frac{v_{ti}^{2}}{2R_{0}^{2}}\n$$\n因此，$\\omega_{G0} = \\frac{v_{ti}}{\\sqrt{2}R_{0}}$。我们现在可以用 $\\omega_{G0}$ 来表示具有椭圆度的频率 $\\omega_{G}(\\delta)$：\n$$\n\\omega_{G}^{2}(\\delta) = \\omega_{G0}^{2} (1 + \\delta^{2})\n$$\n取平方根给出 GAM 频率的最终表达式：\n$$\n\\omega_{G}(\\delta) = \\omega_{G0} \\sqrt{1 + \\delta^{2}}\n$$\n该表达式表明，对于小 $\\delta$，频移 $\\Delta\\omega_{G} = \\omega_{G}(\\delta) - \\omega_{G0} \\approx \\frac{1}{2}\\omega_{G0}\\delta^{2}$，这证明了第一个非零的由椭圆度引起的频移是 $\\delta$ 的二阶。\n\n两个要求的结果是压力的极向变化和修正后的 GAM 频率。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nP_{0}(t)\\left(\\sin\\theta + \\delta\\sin(2\\theta)\\right) & \\omega_{G0}\\sqrt{1 + \\delta^{2}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的实验和数值模拟中，GAM信号并非理想的纯净振荡，而是与湍流和噪声混合在一起。这个计算练习将理论与应用相结合，引入了“验证与确认”（Verification and Validation）这一核心的计算科学技能。你将学习创建一个符合物理现实的合成信号，并实现一套稳健的分析流程来从中提取GAM的频率和阻尼率，这恰好反映了处理真实数据时所面临的挑战。",
            "id": "3984919",
            "problem": "您的任务是实现一个完全自包含的程序，该程序构造一个表示与湍流耦合的阻尼测地声学模 (GAM) 振荡的人工时间序列，然后在指定的容差范围内数值恢复给定的振荡频率和阻尼率。背景设定为高阶研究生水平的计算聚变科学与工程。\n\n首先从单模振荡的基于原理的表示开始。在存在耗散和与湍流雷诺应力一致的微小随机驱动的情况下，与该模式相关的标量可观测量（表示为 $x(t)$）可以被建模为一个具有乘性振幅调制和加性测量噪声的指数阻尼振荡。待合成的人工解为\n$$\nx(t) = A_0 \\exp(-\\gamma\\, t)\\,\\exp\\big(\\epsilon\\,E(t)\\big)\\,\\cos\\big(\\omega\\, t + \\phi\\big) + \\sigma\\,\\xi(t),\n$$\n其中 $A_0$ 是一个正振幅，$\\gamma$ 是一个单位为 $\\mathrm{s}^{-1}$ 的正阻尼率，$\\omega$ 是一个单位为 $\\mathrm{rad/s}$ 的角频率，$\\phi$ 是一个单位为 $\\mathrm{rad}$ 的恒定相位，$\\epsilon$ 是一个与湍流的非负耦合强度，$E(t)$ 是一个零均值奥恩斯坦-乌伦贝克 (OU) 过程，用于模拟由湍流雷诺应力引起的涨落包络，而 $\\xi(t)$ 是一个零均值高斯白噪声，代表测量和未分辨的动力学。OU 过程 $E(t)$ 在伊藤意义下由以下方程控制\n$$\n\\mathrm{d}E = -\\frac{1}{\\tau_c}E\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\tau_c}}\\,\\mathrm{d}W_t,\n$$\n其中相关时间为 $\\tau_c$ (单位为 $\\mathrm{s}$)，维纳增量为 $\\mathrm{d}W_t$。这样的选择确保 $E(t)$ 是平稳的且方差为一。\n\n您的程序必须：\n\n- 对每个测试用例，使用具有采样频率 $f_s$ (单位为 $\\mathrm{Hz}$)、持续时间 $T$ (单位为 $\\mathrm{s}$) 的均匀时间网格和用于可复现性的固定种子来构造 $x(t)$。\n- 使用一个基于信号分析原理且与所建模型物理兼容的、科学上合理的数值方案，从 $x(t)$ 中估计角频率 $\\omega$ 和阻尼率 $\\gamma$。作为指导，采用基于傅里叶功率谱密度的方法来定位主导振荡频带，通过希尔伯特变换构造解析信号以提取瞬时相位和包络，以及对包络的对数进行回归来估计阻尼率。\n- 将估计的参数与给定值进行比较，并确定频率和阻尼率的恢复值是否都在为每个测试用例指定的绝对容差范围内。\n\n物理单位和要求：\n\n- 频率以 $\\mathrm{rad/s}$ 表示，阻尼以 $\\mathrm{s}^{-1}$ 表示。\n- 角度必须以 $\\mathrm{radians}$ (弧度) 处理。\n\n该数值方案在存在乘性包络涨落和加性噪声的情况下必须是鲁棒的。估计决策必须由基本原理来证明其合理性：由阻尼振子模型捕捉的守恒和耗散，以及用于振荡分量提取的谱/解析信号方法。\n\n测试套件：\n\n对于每个测试用例，都提供一个参数元组 $(\\omega,\\gamma,A_0,\\epsilon,\\tau_c,\\sigma,f_s,T,\\phi,\\omega_{\\text{tol}},\\gamma_{\\text{tol}},\\text{seed})$。您的程序必须精确使用这些值，并当且仅当\n$$\n|\\widehat{\\omega} - \\omega| \\le \\omega_{\\text{tol}} \\quad \\text{且} \\quad |\\widehat{\\gamma} - \\gamma| \\le \\gamma_{\\text{tol}},\n$$\n都满足时，输出一个指示成功的布尔值，其中 $\\widehat{\\omega}$ 和 $\\widehat{\\gamma}$ 是估计值。\n\n使用以下四个科学上合理的测试用例，所有量均采用指定单位：\n\n1. 用例 1 (中等阻尼，中等湍流，高信噪比):\n   - $\\omega = 2\\pi \\cdot 12{,}000$\n   - $\\gamma = 1200$\n   - $A_0 = 1.25$\n   - $\\epsilon = 0.2$\n   - $\\tau_c = 5\\times 10^{-4}$\n   - $\\sigma = 0.02$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.012$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 300$\n   - $\\gamma_{\\text{tol}} = 200$\n   - $\\text{seed} = 0$\n\n2. 用例 2 (较强阻尼，较强湍流，中等噪声):\n   - $\\omega = 2\\pi \\cdot 18{,}000$\n   - $\\gamma = 3000$\n   - $A_0 = 0.8$\n   - $\\epsilon = 0.4$\n   - $\\tau_c = 3\\times 10^{-4}$\n   - $\\sigma = 0.04$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.010$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 400$\n   - $\\gamma_{\\text{tol}} = 500$\n   - $\\text{seed} = 1$\n\n3. 用例 3 (低阻尼，记录较短，噪声较高):\n   - $\\omega = 2\\pi \\cdot 9{,}000$\n   - $\\gamma = 600$\n   - $A_0 = 1.0$\n   - $\\epsilon = 0.3$\n   - $\\tau_c = 4\\times 10^{-4}$\n   - $\\sigma = 0.05$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.006$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 500$\n   - $\\gamma_{\\text{tol}} = 250$\n   - $\\text{seed} = 2$\n\n4. 用例 4 (较高频率，高阻尼，无湍流，中等噪声):\n   - $\\omega = 2\\pi \\cdot 25{,}000$\n   - $\\gamma = 4500$\n   - $A_0 = 1.1$\n   - $\\epsilon = 0.0$\n   - $\\tau_c = 3\\times 10^{-4}$\n   - $\\sigma = 0.03$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.008$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 400$\n   - $\\gamma_{\\text{tol}} = 600$\n   - $\\text{seed} = 3$\n\n最终输出格式：\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例对应一个布尔值，指示如上定义的成功。例如：\"[True,False,True,True]\"。",
            "solution": "该问题陈述经过了仔细验证，并被确定为有效。它在科学上植根于等离子体中波-湍流相互作用的物理学，特别是对测地声学模 (GAM) 的建模。该问题是适定的，提供了所有必要的参数和清晰、客观的成功标准。这些参数虽然在某些情况下由于强阻尼而具有挑战性，但在物理上是合理的，并强制要求采用鲁棒的数值方法，这对于该级别的问题是合适的。其中没有矛盾、歧义或事实错误。\n\n该解决方案的实现方式是：首先根据所提供的随机微分模型合成时间序列，然后应用基于原理的信号分析程序来估计目标参数，即角频率 $\\omega$ 和阻尼率 $\\gamma$。\n\n### 信号合成\n\n对于每个测试用例，我们生成一个离散时间序列 $x(t_i)$。\n\n1.  **时间网格**：构造一个从 $t=0$ 到 $t=T$ 的均匀时间向量 $t$，时间步长为 $\\Delta t = 1/f_s$。总点数为 $N = \\lfloor T \\cdot f_s \\rfloor + 1$。\n\n2.  **奥恩斯坦-乌伦贝克 (OU) 过程**：用于乘性噪声的随机过程 $E(t)$ 由以下随机微分方程 (SDE) 控制：\n    $$\n    \\mathrm{d}E = -\\frac{1}{\\tau_c}E\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\tau_c}}\\,\\mathrm{d}W_t\n    $$\n    我们通过使用欧拉-丸山格式积分此 SDE 来生成离散实现 $E_i = E(t_i)$。考虑到在所有测试用例中时间步长 $\\Delta t$ 都远小于相关时间 $\\tau_c$，该格式是合适的。更新规则是：\n    $$\n    E_{i+1} = E_i \\left(1 - \\frac{\\Delta t}{\\tau_c}\\right) + \\sqrt{\\frac{2\\Delta t}{\\tau_c}} Z_i\n    $$\n    其中 $Z_i$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的独立随机变量。该过程通过从其平稳分布（即 $\\mathcal{N}(0, 1)$，以满足单位方差要求）中抽取 $E_0$ 来初始化。\n\n3.  **加性噪声**：加性白噪声分量 $\\xi(t)$ 实现为从 $\\mathcal{N}(0, 1)$ 抽取的随机数的离散序列 $\\xi_i$。\n\n4.  **完整信号**：使用指定的模型组装最终的时间序列 $x(t_i)$：\n    $$\n    x(t_i) = A_0 \\exp(-\\gamma\\, t_i)\\,\\exp\\big(\\epsilon\\,E_i\\big)\\,\\cos\\big(\\omega\\, t_i + \\phi\\big) + \\sigma\\,\\xi_i\n    $$\n    每个用例都使用固定的随机种子以确保可复现性。\n\n### 参数估计\n\n$\\widehat{\\omega}$ 和 $\\widehat{\\gamma}$ 的估计需要将振荡分量与噪声分离并分析其属性。根据问题陈述的指导，采用了一个多阶段过程。\n\n1.  **带通滤波**：原始信号 $x(t)$ 是期望的阻尼振荡和宽带加性噪声的复合体。为了分离 GAM 信号，带通滤波器是必不可少的。\n    -   通过定位原始信号 $x(t)$ 的功率谱密度 (PSD) 中的峰值来确定滤波器的中心频率。PSD 使用快速傅里叶变换 (FFT) 计算。最大功率对应的频率提供了该模式频率的初步估计值 $f_{peak}$。\n    -   设计一个 5 阶巴特沃斯滤波器，其通带以 $f_{peak}$ 为中心。选择 6 kHz 的带宽，这个宽度足以捕捉模式的谱宽（因阻尼和湍流调制而变宽），同时能抑制大部分带外噪声。\n    -   使用前向-后向滤波 (`sosfiltfilt`) 来应用滤波器，以确保零相位失真。这一点至关重要，因为任何相位失真都会破坏后续对 $\\omega$ 和 $\\gamma$ 的估计。设滤波后的信号为 $x_{filt}(t)$。\n\n2.  **解析信号构造**：对滤波后的信号 $x_{filt}(t)$ 应用希尔伯特变换，以构造解析信号 $z(t)$：\n    $$\n    z(t) = x_{filt}(t) + i\\mathcal{H}\\{x_{filt}(t)\\} = A(t)e^{i\\psi(t)}\n    $$\n    这种表示有效地将信号分离为其瞬时包络 $A(t) = |z(t)|$ 和瞬时相位 $\\psi(t) = \\arg(z(t))$。\n\n3.  **为实现鲁棒拟合而进行数据截断**：在几个测试用例中，阻尼很强，导致信号包络在时间记录 $T$ 结束前很久就衰减到加性噪声基底 $\\sigma$ 以下。对信号中噪声主导的尾部进行回归会严重偏置估计值。因此，我们仅在信号包络 $A(t)$ 显著的部分上进行拟合。我们定义一个有效数据区域，其中 $A(t) > 3\\sigma$。这种阈值处理确保估计是基于信号中信噪比较高的部分。\n\n4.  **频率估计 ($\\widehat{\\omega}$)**：对于理想的滤波振荡，瞬时相位随时间线性演化：$\\psi(t) \\approx \\omega t + \\text{const}$。因此，角频率 $\\omega$ 是相位的变化率。通过在有效数据区域上对解缠相位 $\\psi(t)$ 与时间 $t$ 进行线性回归，可以获得一个鲁棒的估计值 $\\widehat{\\omega}$。该拟合的斜率即为 $\\widehat{\\omega}$。这种方法通常比依赖短时、含噪信号的 FFT 峰值位置更准确。\n\n5.  **阻尼率估计 ($\\widehat{\\gamma}$)**：信号包络的模型（包括湍流涨落）近似为 $A(t) \\approx A_0 \\exp(-\\gamma t) \\exp(\\epsilon E(t))$。取自然对数可以使阻尼项线性化：\n    $$\n    \\ln A(t) \\approx \\ln A_0 - \\gamma t + \\epsilon E(t)\n    $$\n    这是 $\\ln A(t)$ 和 $t$ 之间的线性关系，并带有一个附加的零均值随机项 $\\epsilon E(t)$。对 $\\ln A(t)$ 与 $t$ 进行线性回归（在有效数据区域上）将得到一个斜率，该斜率是 $-\\gamma$ 的一个鲁棒估计。因此，我们设 $\\widehat{\\gamma} = -(\\text{斜率})$。\n\n最后，对于每个测试用例，将估计值 $\\widehat{\\omega}$ 和 $\\widehat{\\gamma}$ 与真实值 $\\omega$ 和 $\\gamma$ 进行比较，使用提供的绝对容差 $\\omega_{tol}$ 和 $\\gamma_{tol}$ 来确定成功与否 (True/False)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef analyze_signal(params):\n    \"\"\"\n    Synthesizes a GAM time series and estimates its frequency and damping rate.\n    \n    Args:\n        params (tuple): A tuple containing all model and analysis parameters.\n\n    Returns:\n        bool: True if both frequency and damping are recovered within tolerance, False otherwise.\n    \"\"\"\n    omega, gamma, A0, epsilon, tau_c, sigma, fs, T, phi, omega_tol, gamma_tol, seed = params\n\n    # 1. Signal Synthesis\n    rng = np.random.default_rng(seed)\n    \n    # Time base\n    dt = 1.0 / fs\n    num_points = int(T * fs) + 1\n    t = np.linspace(0.0, T, num_points, endpoint=True)\n\n    # Ornstein-Uhlenbeck process E(t) via Euler-Maruyama\n    E = np.zeros(num_points)\n    E[0] = rng.normal()  # Start from stationary distribution N(0,1)\n    # Pre-calculate constants for the loop\n    exp_factor = 1.0 - dt / tau_c\n    noise_factor = np.sqrt(2.0 * dt / tau_c)\n    for i in range(num_points - 1):\n        E[i+1] = exp_factor * E[i] + noise_factor * rng.normal()\n\n    # Additive white noise xi(t)\n    xi = rng.normal(size=num_points)\n\n    # Full manufactured signal x(t)\n    envelope = A0 * np.exp(-gamma * t) * np.exp(epsilon * E)\n    oscillation = np.cos(omega * t + phi)\n    x = envelope * oscillation + sigma * xi\n\n    # 2. Parameter Estimation\n    \n    # Coarse frequency estimate from PSD peak\n    # Use rfft for real-valued signal\n    n_fft = len(x)\n    yf = np.fft.rfft(x)\n    xf = np.fft.rfftfreq(n_fft, d=dt)\n    \n    # Find peak in power spectrum (ignoring DC component)\n    power = np.abs(yf[1:])**2\n    peak_idx = np.argmax(power) + 1 # +1 to account for slicing\n    f_peak = xf[peak_idx]\n\n    # Band-pass filter around the peak frequency\n    # Filter is designed to isolate the GAM mode from broadband noise\n    filter_order = 5\n    filter_bw = 6000.0  # Hz, a reasonable choice for these cases\n    f_low = max(1.0, f_peak - filter_bw / 2.0)\n    f_high = f_peak + filter_bw / 2.0\n    \n    nyquist = 0.5 * fs\n    # Wn is normalized to Nyquist frequency\n    wn = [f_low / nyquist, f_high / nyquist]\n    \n    sos = signal.butter(filter_order, wn, btype='bandpass', output='sos')\n    x_filt = signal.sosfiltfilt(sos, x)\n\n    # Analytic signal via Hilbert transform\n    z = signal.hilbert(x_filt)\n    envelope_hat = np.abs(z)\n    phase_hat = np.unwrap(np.angle(z))\n\n    # Perform fits only on the signal part with high SNR\n    # This avoids bias from the noise-dominated tail\n    valid_indices = np.where(envelope_hat > 3.0 * sigma)[0]\n    \n    # Check if we have enough points for a meaningful fit\n    if len(valid_indices)  20:\n        return False\n\n    t_valid = t[valid_indices]\n\n    # Estimate omega from phase slope\n    phase_valid = phase_hat[valid_indices]\n    omega_slope, _ = np.polyfit(t_valid, phase_valid, 1)\n    omega_hat = omega_slope\n\n    # Estimate gamma from envelope log-slope\n    log_envelope_valid = np.log(envelope_hat[valid_indices])\n    gamma_slope, _ = np.polyfit(t_valid, log_envelope_valid, 1)\n    gamma_hat = -gamma_slope\n\n    # 3. Validation\n    omega_err = np.abs(omega_hat - omega)\n    gamma_err = np.abs(gamma_hat - gamma)\n    \n    success = (omega_err = omega_tol) and (gamma_err = gamma_tol)\n    \n    return success\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # omega, gamma, A0, epsilon, tau_c, sigma, fs, T, phi, omega_tol, gamma_tol, seed\n    test_cases = [\n        (2 * np.pi * 12000, 1200, 1.25, 0.2, 5e-4, 0.02, 5.0e5, 0.012, 0.37, 2 * np.pi * 300, 200, 0),\n        (2 * np.pi * 18000, 3000, 0.8, 0.4, 3e-4, 0.04, 5.0e5, 0.010, 0.37, 2 * np.pi * 400, 500, 1),\n        (2 * np.pi * 9000, 600, 1.0, 0.3, 4e-4, 0.05, 5.0e5, 0.006, 0.37, 2 * np.pi * 500, 250, 2),\n        (2 * np.pi * 25000, 4500, 1.1, 0.0, 3e-4, 0.03, 5.0e5, 0.008, 0.37, 2 * np.pi * 400, 600, 3)\n    ]\n    \n    results = []\n    for case in test_cases:\n        result = analyze_signal(case)\n        results.append(result)\n\n    # Format output as specified: [True,False,True,True]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}