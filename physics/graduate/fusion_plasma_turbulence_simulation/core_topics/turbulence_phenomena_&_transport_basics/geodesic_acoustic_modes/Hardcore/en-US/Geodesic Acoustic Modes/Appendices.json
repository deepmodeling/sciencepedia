{
    "hands_on_practices": [
        {
            "introduction": "The Geodesic Acoustic Mode (GAM) is fundamentally a consequence of the toroidal geometry of a tokamak. This hands-on practice guides you through the derivation of the geodesic curvature, $\\kappa_g$, which acts as the primary driving force for the mode. By starting from the metric of the magnetic field and applying the definition of curvature, you will see how the variation in magnetic field strength along a field line within a flux surface gives rise to this crucial term. This exercise is invaluable for building a first-principles understanding of why GAMs exist and how they are tied to the machine's geometry .",
            "id": "4190155",
            "problem": "Consider an axisymmetric tokamak with circular, concentric magnetic flux surfaces. Let the flux-surface coordinates be $(r,\\theta,\\phi)$, where $r$ is the minor radius, $\\theta$ is the poloidal angle (measured from the outboard midplane), and $\\phi$ is the toroidal angle. The cylindrical coordinates $(R,\\phi,Z)$ are related to $(r,\\theta)$ on each flux surface by $R(r,\\theta) = R_{0} + r \\cos\\theta$ and $Z(r,\\theta) = r \\sin\\theta$, where $R_{0}$ is the major radius of the magnetic axis. The line element on a flux surface is\n$$\nds^{2} = dr^{2} + r^{2} d\\theta^{2} + R^{2}(r,\\theta) d\\phi^{2}.\n$$\nAssume the magnetic field is axisymmetric and predominantly toroidal with a small poloidal component, so the unit vector along the magnetic field can be written as\n$$\n\\hat{b} = \\frac{B_{\\phi}}{B}\\,\\hat{e}_{\\phi} + \\frac{B_{\\theta}}{B}\\,\\hat{e}_{\\theta},\n$$\nwith $B = |\\mathbf{B}|$, $B_{\\phi} \\gg B_{\\theta}$, and $\\hat{e}_{\\phi}$, $\\hat{e}_{\\theta}$ the unit vectors along the toroidal and poloidal directions, respectively. The curvature of the magnetic field line is defined by the geometric identity\n$$\n\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}.\n$$\nIn the poloidal momentum balance relevant to Geodesic Acoustic Modes (GAMs), the geodesic curvature is the in-surface component of $\\boldsymbol{\\kappa}$ projected onto the poloidal direction, namely\n$$\n\\kappa_{g}(\\theta) = \\boldsymbol{\\kappa}\\cdot\\hat{e}_{\\theta}.\n$$\nStarting only from the given metric and these geometric definitions, and working in the large-aspect-ratio limit $B_{\\phi}/B \\approx 1$, derive the analytic expression for the geodesic curvature $\\kappa_{g}(\\theta)$ as a function of $r$, $\\theta$, and $R_{0}$. Present your final answer as a single closed-form expression for $\\kappa_{g}(\\theta)$. Do not perform any numerical evaluation. No units are required in your final expression.",
            "solution": "The problem asks for the derivation of the geodesic curvature, $\\kappa_g(\\theta)$, for an axisymmetric tokamak with circular, concentric flux surfaces. The geodesic curvature is defined as the poloidal component of the magnetic field line curvature vector, $\\boldsymbol{\\kappa}$. The derivation will commence from the fundamental definition of the curvature vector, $\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}$, utilizing the provided toroidal coordinate system and the large-aspect-ratio approximation.\n\nFirst, we establish the properties of the specified coordinate system $(r, \\theta, \\phi)$. The line element is given as $ds^{2} = dr^{2} + r^{2} d\\theta^{2} + R^{2}(r,\\theta) d\\phi^{2}$, where $R(r,\\theta) = R_{0} + r \\cos\\theta$. This is an orthogonal coordinate system. The scale factors are $h_r = 1$, $h_\\theta = r$, and $h_\\phi = R(r,\\theta)$. The orthonormal basis vectors are denoted by $\\hat{e}_r$, $\\hat{e}_\\theta$, and $\\hat{e}_\\phi$.\n\nThe gradient operator, $\\nabla$, in this orthogonal coordinate system is given by:\n$$\n\\nabla = \\frac{\\hat{e}_r}{h_r}\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{h_\\theta}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{h_\\phi}\\frac{\\partial}{\\partial \\phi} = \\hat{e}_r\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\n$$\n\nThe unit vector along the magnetic field, $\\hat{b}$, is given as $\\hat{b} = \\frac{B_{\\phi}}{B}\\,\\hat{e}_{\\phi} + \\frac{B_{\\theta}}{B}\\,\\hat{e}_{\\theta}$. For convenience, let $b_\\phi = \\frac{B_\\phi}{B}$ and $b_\\theta = \\frac{B_\\theta}{B}$, so $\\hat{b} = b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta$. Note that from the definition of a unit vector, we have the identity $b_\\phi^2 + b_\\theta^2 = 1$. The operator $(\\hat{b}\\cdot\\nabla)$ is the directional derivative along the magnetic field line:\n$$\n\\hat{b}\\cdot\\nabla = (b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta) \\cdot \\left(\\hat{e}_r\\frac{\\partial}{\\partial r} + \\frac{\\hat{e}_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{\\hat{e}_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\\right) = \\frac{b_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{b_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\n$$\nHere, we have used the orthogonality of the basis vectors, i.e., $\\hat{e}_i \\cdot \\hat{e}_j = \\delta_{ij}$.\n\nTo calculate the curvature $\\boldsymbol{\\kappa} = (\\hat{b}\\cdot\\nabla)\\hat{b}$, we must evaluate the action of the directional derivative on the vector $\\hat{b}$. This requires the partial derivatives of the basis vectors. For the toroidal coordinate system defined, these are:\n$$\n\\begin{array}{lll}\n\\frac{\\partial \\hat{e}_r}{\\partial \\theta} = \\hat{e}_\\theta  \\frac{\\partial \\hat{e}_\\theta}{\\partial \\theta} = -\\hat{e}_r  \\frac{\\partial \\hat{e}_\\phi}{\\partial \\theta} = 0 \\\\\n\\frac{\\partial \\hat{e}_r}{\\partial \\phi} = \\hat{e}_\\phi \\cos\\theta  \\frac{\\partial \\hat{e}_\\theta}{\\partial \\phi} = -\\hat{e}_\\phi \\sin\\theta  \\frac{\\partial \\hat{e}_\\phi}{\\partial \\phi} = -\\hat{e}_r \\cos\\theta + \\hat{e}_\\theta \\sin\\theta\n\\end{array}\n$$\nSince the system is axisymmetric, the scalar components of the magnetic field, $B_\\phi$ and $B_\\theta$, and hence their ratios $b_\\phi$ and $b_\\theta$, are independent of the toroidal angle $\\phi$. Thus, $\\frac{\\partial b_\\phi}{\\partial \\phi} = 0$ and $\\frac{\\partial b_\\theta}{\\partial \\phi} = 0$.\n\nNow we compute $\\boldsymbol{\\kappa}$:\n$$\n\\boldsymbol{\\kappa} = \\left(\\frac{b_\\theta}{r}\\frac{\\partial}{\\partial \\theta} + \\frac{b_\\phi}{R}\\frac{\\partial}{\\partial \\phi}\\right) (b_\\phi \\hat{e}_\\phi + b_\\theta \\hat{e}_\\theta)\n$$\nExpanding the derivative terms:\n$$\n\\boldsymbol{\\kappa} = \\frac{b_\\theta}{r} \\left( \\frac{\\partial b_\\phi}{\\partial \\theta} \\hat{e}_\\phi + b_\\phi \\frac{\\partial \\hat{e}_\\phi}{\\partial \\theta} + \\frac{\\partial b_\\theta}{\\partial \\theta} \\hat{e}_\\theta + b_\\theta \\frac{\\partial \\hat{e}_\\theta}{\\partial \\theta} \\right) + \\frac{b_\\phi}{R} \\left( \\frac{\\partial b_\\phi}{\\partial \\phi} \\hat{e}_\\phi + b_\\phi \\frac{\\partial \\hat{e}_\\phi}{\\partial \\phi} + \\frac{\\partial b_\\theta}{\\partial \\phi} \\hat{e}_\\theta + b_\\theta \\frac{\\partial \\hat{e}_\\theta}{\\partial \\phi} \\right)\n$$\nSubstituting the derivatives of the basis vectors and the axisymmetry condition:\n$$\n\\boldsymbol{\\kappa} = \\frac{b_\\theta}{r} \\left( \\frac{\\partial b_\\phi}{\\partial \\theta} \\hat{e}_\\phi + b_\\phi (0) + \\frac{\\partial b_\\theta}{\\partial \\theta} \\hat{e}_\\theta + b_\\theta (-\\hat{e}_r) \\right) + \\frac{b_\\phi}{R} \\left( (0) \\hat{e}_\\phi + b_\\phi (-\\hat{e}_r \\cos\\theta + \\hat{e}_\\theta \\sin\\theta) + (0) \\hat{e}_\\theta + b_\\theta (-\\hat{e}_\\phi \\sin\\theta) \\right)\n$$\nCollecting terms for each basis vector:\n$$\n\\boldsymbol{\\kappa} = \\left(-\\frac{b_\\theta^2}{r} - \\frac{b_\\phi^2 \\cos\\theta}{R}\\right) \\hat{e}_r + \\left(\\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta} + \\frac{b_\\phi^2 \\sin\\theta}{R}\\right) \\hat{e}_\\theta + \\left(\\frac{b_\\theta}{r}\\frac{\\partial b_\\phi}{\\partial \\theta} - \\frac{b_\\phi b_\\theta \\sin\\theta}{R}\\right) \\hat{e}_\\phi\n$$\nThe geodesic curvature is the component of $\\boldsymbol{\\kappa}$ in the poloidal direction, $\\kappa_g(\\theta) = \\boldsymbol{\\kappa} \\cdot \\hat{e}_\\theta$. Projecting the expression for $\\boldsymbol{\\kappa}$ onto $\\hat{e}_\\theta$ yields the exact expression for $\\kappa_g(\\theta)$:\n$$\n\\kappa_g(\\theta) = \\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta} + \\frac{b_\\phi^2 \\sin\\theta}{R}\n$$\nThe problem specifies that we should work in the large-aspect-ratio limit where $B_\\phi/B \\approx 1$. This corresponds to the limit $b_\\phi \\to 1$. From the identity $b_\\phi^2 + b_\\theta^2 = 1$, as $b_\\phi \\to 1$, it follows that $b_\\theta \\to 0$. The first term, $\\frac{b_\\theta}{r}\\frac{\\partial b_\\theta}{\\partial \\theta}$, contains products of the small quantity $b_\\theta$ and its derivative, and thus vanishes in this limit. The second term, $\\frac{b_\\phi^2 \\sin\\theta}{R}$, approaches $\\frac{\\sin\\theta}{R}$ as $b_\\phi \\to 1$.\n\nTherefore, in the specified limit, the geodesic curvature is:\n$$\n\\kappa_g(\\theta) \\approx \\frac{\\sin\\theta}{R}\n$$\nFinally, substituting the given expression for the major radius coordinate, $R = R_0 + r \\cos\\theta$:\n$$\n\\kappa_g(\\theta) = \\frac{\\sin\\theta}{R_0 + r \\cos\\theta}\n$$\nThis is the analytic expression for the geodesic curvature as a function of $r$, $\\theta$, and $R_0$, derived under the specified conditions.",
            "answer": "$$\n\\boxed{\\frac{\\sin\\theta}{R_{0} + r \\cos\\theta}}\n$$"
        },
        {
            "introduction": "Building on the concept of geodesic curvature, this problem explores how modifying the magnetic geometry affects the observable properties of a GAM. The mode's frequency, $\\omega_G$, is directly related to the root-mean-square of the geodesic curvature, $\\sqrt{\\langle \\kappa_g^2 \\rangle}$. This exercise demonstrates how introducing triangularity, a common shaping parameter in modern tokamaks, alters the poloidal structure of $\\kappa_g$ and consequently shifts the GAM frequency. Working through this model provides crucial insight into how plasma shaping can be used to control or influence plasma turbulence and transport through its effect on zonal flows and GAMs .",
            "id": "4190085",
            "problem": "Consider a large-aspect-ratio tokamak of major radius $R_{0}$ and minor radius $r$, with small triangularity $\\delta$ and negligible elongation. Assume an electrostatic Geodesic Acoustic Mode (GAM), defined as an axisymmetric ($m=0$, $n=0$) oscillation of the zonal flow and potential, couples to a poloidally varying $m=1$ pressure sideband through geodesic curvature. Model the equilibrium with a simplified Miller-like shaping in which the geodesic curvature is approximated, to first order in $\\delta$, by\n$$\n\\kappa_{g}(\\theta) \\equiv \\frac{1}{R_{0}}\\left[\\sin\\theta + \\delta \\sin(2\\theta)\\right],\n$$\nwhere $\\theta$ is the geometric poloidal angle.\n\nAdopt a drift-reduced fluid description with isothermal ions of temperature $T_{i}$ and adiabatic electrons (Boltzmann response for nonzonal components). The poloidal $\\boldsymbol{E}\\times\\boldsymbol{B}$ flow is taken as $\\boldsymbol{v}_{E} = \\hat{\\theta}\\,U_{\\theta}(t)$ with $U_{\\theta}(t) = (c/B_{0})\\,\\partial_{r}\\phi_{0}(t)$ and $B_{0}$ constant to leading order in the large-aspect-ratio ordering. Use the ion continuity equation and the geodesic curvature-induced compressibility to relate the $m=1$ pressure sideband $p_{1}(\\theta, t)$ to $U_{\\theta}(t)$:\n$$\n\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0,\\quad \\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\,\\kappa_{g}(\\theta)\\,U_{\\theta}(t),\\quad p_{1}(\\theta,t) = T_{i}\\,n_{1}(\\theta,t),\n$$\nwhere $n_{0}$ is the equilibrium density. Close the system using the curvature force density that couples the sideband back to the zonal flow,\n$$\nf_{r}(\\theta,t) = -\\,p_{1}(\\theta,t)\\,\\kappa_{g}(\\theta),\n$$\nand take the poloidal average to obtain the zonal-flow evolution:\n$$\nm_{i}\\,n_{0}\\,\\partial_{t}U_{\\theta}(t) = -\\,\\langle f_{r}(\\theta,t)\\rangle_{\\theta},\n$$\nwhere $m_{i}$ is the ion mass and $\\langle\\cdot\\rangle_{\\theta}$ denotes a $2\\pi$ poloidal average over $\\theta$.\n\nUsing only these bases and keeping terms to the lowest nontrivial order(s) in $\\delta$, derive:\n\n1. The leading-order modification in the poloidal variation of the pressure sideband $p_{1}(\\theta,t)$ induced by triangularity $\\delta$.\n\n2. The corresponding first nonvanishing triangularity-induced shift in the GAM frequency $\\omega_{G}(\\delta)$ relative to the unshaped circular limit $\\omega_{G0}$, defined by the same model with $\\delta=0$.\n\nExpress the final GAM frequency as a closed-form analytic expression in terms of $\\omega_{G0}$ and $\\delta$. Also express the poloidal variation of $p_{1}(\\theta,t)$ in closed form, in terms of a single time-dependent amplitude $P_{0}(t)$ multiplying an explicit function of $\\theta$ and $\\delta$. Your final answer must be a single analytic expression or a single row matrix of analytic expressions. If you provide two expressions, combine them into a single row matrix using the $\\mathrm{pmatrix}$ environment. No numerical evaluation is required.",
            "solution": "The user-provided problem will first be validated against the required criteria.\n\n### Step 1: Extract Givens\n- **Geometry and Shaping**: Large-aspect-ratio tokamak, major radius $R_{0}$, minor radius $r$, small triangularity $\\delta$, negligible elongation.\n- **Mode of Interest**: Electrostatic Geodesic Acoustic Mode (GAM), axisymmetric ($m=0$, $n=0$).\n- **Geodesic Curvature Model**: $\\kappa_{g}(\\theta) \\equiv \\frac{1}{R_{0}}\\left[\\sin\\theta + \\delta \\sin(2\\theta)\\right]$, where $\\theta$ is the poloidal angle.\n- **Plasma Model**: Drift-reduced fluid description, isothermal ions (temperature $T_{i}$, mass $m_{i}$), adiabatic electrons (Boltzmann response for nonzonal components).\n- **Flow Definition**: Poloidal $\\boldsymbol{E}\\times\\boldsymbol{B}$ flow $\\boldsymbol{v}_{E} = \\hat{\\theta}\\,U_{\\theta}(t)$, with velocity $U_{\\theta}(t) = (c/B_{0})\\,\\partial_{r}\\phi_{0}(t)$. $B_{0}$ is a leading-order constant magnetic field.\n- **Governing Equations**:\n    1. Ion continuity: $\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0$, where $n_0$ is equilibrium density, $n_1$ is density perturbation.\n    2. Compressibility relation: $\\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\,\\kappa_{g}(\\theta)\\,U_{\\theta}(t)$.\n    3. Equation of state: $p_{1}(\\theta,t) = T_{i}\\,n_{1}(\\theta,t)$, where $p_1$ is the pressure sideband.\n    4. Curvature force density: $f_{r}(\\theta,t) = -\\,p_{1}(\\theta,t)\\,\\kappa_{g}(\\theta)$.\n    5. Zonal flow evolution: $m_{i}\\,n_{0}\\,\\partial_{t}U_{\\theta}(t) = -\\,\\langle f_{r}(\\theta,t)\\rangle_{\\theta}$.\n- **Averaging Operator**: $\\langle\\cdot\\rangle_{\\theta}$ is the poloidal average over $\\theta$ from $0$ to $2\\pi$.\n- **Objectives**:\n    1. Derive the leading-order modification in the poloidal variation of the pressure sideband $p_{1}(\\theta,t)$ due to $\\delta$.\n    2. Derive the first nonvanishing triangularity-induced shift in the GAM frequency $\\omega_{G}(\\delta)$ relative to the circular case $\\omega_{G0}$ (where $\\delta=0$).\n- **Required Output Format**: Closed-form analytic expressions for $p_{1}(\\theta,t)$ (in terms of a generic amplitude $P_0(t)$) and for $\\omega_{G}(\\delta)$ (in terms of $\\omega_{G0}$ and $\\delta$).\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation:\n- **Scientifically Grounded**: The problem is well-grounded in the theory of plasma turbulence and magnetohydrodynamics. The model presented is a standard, simplified fluid model used to study Geodesic Acoustic Modes in tokamaks. The equations for continuity, flow compressibility due to geodesic curvature, and the back-reaction on the zonal flow are fundamental to this topic.\n- **Well-Posed**: The problem is well-posed. It provides a complete, closed set of linearized equations and asks for the dispersion relation (frequency) and mode structure (pressure variation) that arise from them. The instruction to work to the lowest non-trivial order in $\\delta$ provides a clear and standard procedure for a perturbative calculation. A unique solution for the frequency and mode structure is expected.\n- **Objective**: The problem statement is written in precise, objective, and standard scientific language, free of ambiguity or subjective claims.\n\nThe problem does not exhibit any of the flaws listed in the instructions. It is scientifically sound, formalizable, complete, and self-consistent. The parameters and model, while simplified, are physically plausible within the stated approximations. The problem is a non-trivial but solvable exercise in theoretical plasma physics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\nThe derivation proceeds by sequentially applying the provided equations to construct a closed system describing the GAM oscillation.\n\n**1. Derivation of the Pressure Sideband $p_{1}(\\theta,t)$**\n\nWe begin with the ion continuity equation and the given compressibility relation:\n$$\n\\partial_{t}n_{1} + n_{0}\\,\\nabla\\cdot\\boldsymbol{v}_{E} = 0\n$$\nSubstituting $\\nabla\\cdot\\boldsymbol{v}_{E} \\approx -\\kappa_{g}(\\theta)U_{\\theta}(t)$, we obtain:\n$$\n\\partial_{t}n_{1} - n_{0}\\kappa_{g}(\\theta)U_{\\theta}(t) = 0\n$$\n$$\n\\partial_{t}n_{1} = n_{0}\\kappa_{g}(\\theta)U_{\\theta}(t)\n$$\nUsing the isothermal ion equation of state, $p_{1}(\\theta,t) = T_{i}n_{1}(\\theta,t)$, we can write the time evolution of the pressure sideband:\n$$\n\\partial_{t}p_{1}(\\theta,t) = T_{i}\\partial_{t}n_{1} = n_{0}T_{i}\\kappa_{g}(\\theta)U_{\\theta}(t)\n$$\nFor an oscillatory mode, the pressure perturbation $p_{1}$ must be related to the time integral of the flow velocity $U_{\\theta}(t)$. If we assume a harmonic time dependence where $U_{\\theta}(t)$ is proportional to $\\cos(\\omega_{G}t)$, then $p_{1}(\\theta,t)$ will be proportional to $\\sin(\\omega_{G}t)$.\nIntegrating the equation with respect to time, we find that the poloidal structure of $p_{1}$ is directly proportional to the geodesic curvature $\\kappa_{g}(\\theta)$:\n$$\np_{1}(\\theta,t) \\propto \\kappa_{g}(\\theta) \\int^t U_{\\theta}(t') dt'\n$$\nSubstituting the given expression for $\\kappa_{g}(\\theta) = \\frac{1}{R_{0}}\\left[\\sin\\theta + \\delta \\sin(2\\theta)\\right]$, the poloidal dependence of $p_{1}$ is given by $(\\sin\\theta + \\delta \\sin(2\\theta))$. We can express this in the requested format by defining a time-dependent amplitude $P_{0}(t)$ that absorbs all other factors:\n$$\np_{1}(\\theta,t) = P_{0}(t) \\left( \\sin\\theta + \\delta\\sin(2\\theta) \\right)\n$$\nThis expression directly addresses the first objective. The leading-order pressure variation in a circular tokamak ($\\delta=0$) has a $\\sin\\theta$ dependence. The leading-order modification induced by triangularity $\\delta$ is the addition of the term proportional to $\\delta\\sin(2\\theta)$.\n\n**2. Derivation of the GAM Frequency $\\omega_{G}(\\delta)$**\n\nNext, we use the zonal flow evolution equation to find the GAM frequency. The evolution of the zonal flow velocity $U_{\\theta}(t)$ is driven by the poloidally averaged curvature force:\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = -\\langle f_{r}(\\theta,t)\\rangle_{\\theta}\n$$\nThe force density is $f_{r}(\\theta,t) = -p_{1}(\\theta,t)\\kappa_{g}(\\theta)$, so the equation becomes:\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = \\langle p_{1}(\\theta,t)\\kappa_{g}(\\theta) \\rangle_{\\theta}\n$$\nWe substitute the relation $\\partial_t p_1 = n_0 T_i \\kappa_g(\\theta) U_\\theta(t)$, which can be written in integral form as $p_{1}(\\theta,t) = n_{0}T_{i}\\kappa_{g}(\\theta) \\int^{t} U_{\\theta}(t') dt'$ (assuming the oscillation starts from zero). Inserting this into the zonal flow equation yields:\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = \\left\\langle \\left( n_{0}T_{i}\\kappa_{g}(\\theta) \\int^{t} U_{\\theta}(t') dt' \\right) \\kappa_{g}(\\theta) \\right\\rangle_{\\theta}\n$$\nThe terms $n_{0}$, $T_{i}$, and the time integral do not depend on the poloidal angle $\\theta$, so they can be moved outside the averaging operator:\n$$\nm_{i}n_{0}\\partial_{t}U_{\\theta}(t) = n_{0}T_{i} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} \\int^{t} U_{\\theta}(t') dt'\n$$\nDividing by $m_{i}n_{0}$ gives:\n$$\n\\partial_{t}U_{\\theta}(t) = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} \\int^{t} U_{\\theta}(t') dt'\n$$\nTo obtain a standard differential equation, we differentiate both sides with respect to time $t$:\n$$\n\\partial_{t}^{2}U_{\\theta}(t) = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} U_{\\theta}(t)\n$$\nThis can be rearranged into the canonical form of a simple harmonic oscillator equation:\n$$\n\\partial_{t}^{2}U_{\\theta}(t) + \\omega_{G}^{2} U_{\\theta}(t) = 0\n$$\nwhere the square of the GAM frequency is identified as:\n$$\n\\omega_{G}^{2} = \\frac{T_{i}}{m_{i}} \\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta}\n$$\nHere, $v_{ti} = \\sqrt{T_{i}/m_{i}}$ is the ion thermal velocity. Now we must compute the poloidal average of $\\kappa_g^2(\\theta)$.\n$$\n\\kappa_{g}^{2}(\\theta) = \\frac{1}{R_{0}^{2}} \\left( \\sin\\theta + \\delta \\sin(2\\theta) \\right)^{2} = \\frac{1}{R_{0}^{2}} \\left( \\sin^{2}\\theta + 2\\delta \\sin\\theta \\sin(2\\theta) + \\delta^{2}\\sin^{2}(2\\theta) \\right)\n$$\nThe poloidal average $\\langle F(\\theta) \\rangle_{\\theta}$ is $\\frac{1}{2\\pi}\\int_{0}^{2\\pi} F(\\theta) d\\theta$. We use the standard integrals: $\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin^{2}(k\\theta)d\\theta = \\frac{1}{2}$ for integer $k \\neq 0$, and $\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\sin(A\\theta)\\sin(B\\theta)d\\theta = 0$ for integers $A \\neq B$.\n$$\n\\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} = \\frac{1}{R_{0}^{2}} \\left( \\langle \\sin^{2}\\theta \\rangle_{\\theta} + 2\\delta \\langle \\sin\\theta \\sin(2\\theta) \\rangle_{\\theta} + \\delta^{2} \\langle \\sin^{2}(2\\theta) \\rangle_{\\theta} \\right)\n$$\n$$\n\\langle \\kappa_{g}^{2}(\\theta) \\rangle_{\\theta} = \\frac{1}{R_{0}^{2}} \\left( \\frac{1}{2} + 2\\delta(0) + \\delta^{2}\\frac{1}{2} \\right) = \\frac{1}{2R_{0}^{2}} (1 + \\delta^{2})\n$$\nThe term linear in $\\delta$ vanishes. The first nonvanishing correction due to triangularity is therefore of order $\\delta^{2}$. This is consistent with the problem's requirement.\n\nSubstituting this result back into the expression for $\\omega_{G}^{2}$:\n$$\n\\omega_{G}^{2}(\\delta) = \\frac{T_{i}}{m_{i}} \\frac{1}{2R_{0}^{2}} (1 + \\delta^{2}) = \\frac{v_{ti}^{2}}{2R_{0}^{2}}(1 + \\delta^{2})\n$$\nThe GAM frequency in the unshaped circular limit, $\\omega_{G0}$, is found by setting $\\delta=0$:\n$$\n\\omega_{G0}^{2} = \\omega_{G}^{2}(\\delta=0) = \\frac{v_{ti}^{2}}{2R_{0}^{2}}\n$$\nThus, $\\omega_{G0} = \\frac{v_{ti}}{\\sqrt{2}R_{0}}$. We can now express the frequency with triangularity, $\\omega_{G}(\\delta)$, in terms of $\\omega_{G0}$:\n$$\n\\omega_{G}^{2}(\\delta) = \\omega_{G0}^{2} (1 + \\delta^{2})\n$$\nTaking the square root gives the final expression for the GAM frequency:\n$$\n\\omega_{G}(\\delta) = \\omega_{G0} \\sqrt{1 + \\delta^{2}}\n$$\nThis expression shows that the frequency shift $\\Delta\\omega_{G} = \\omega_{G}(\\delta) - \\omega_{G0} \\approx \\frac{1}{2}\\omega_{G0}\\delta^{2}$ for small $\\delta$, demonstrating that the first nonvanishing triangularity-induced shift is of second order in $\\delta$.\n\nThe two requested results are the poloidal variation of the pressure and the modified GAM frequency.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nP_{0}(t)\\left(\\sin\\theta + \\delta\\sin(2\\theta)\\right)  \\omega_{G0}\\sqrt{1 + \\delta^{2}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between analytical theory and the practical analysis of experimental or simulation data. Real-world measurements of GAMs are often embedded in noisy signals, reflecting interactions with background turbulence and instrumental effects. This computational exercise challenges you to create a synthetic time series of a damped GAM, complete with realistic noise, and then develop a robust numerical scheme to extract its underlying frequency and damping rate. Mastering these signal processing techniques, such as Fourier and Hilbert transforms, is an essential skill for any researcher aiming to diagnose plasma phenomena and validate theoretical models against empirical data .",
            "id": "3984919",
            "problem": "You are tasked with implementing a fully self-contained program that constructs a manufactured time series representing a damped Geodesic Acoustic Mode (GAM) oscillation coupled to turbulence, and then numerically recovers the imposed oscillation frequency and damping rate within specified tolerances. The setting is computational fusion science and engineering at the advanced graduate level.\n\nBegin with a principle-based representation of a single-mode oscillation. In the presence of dissipation and a small stochastic drive consistent with turbulent Reynolds stress, a scalar observable associated with the mode, denoted by $x(t)$, can be modeled as an exponentially damped oscillation with multiplicative amplitude modulation and additive measurement noise. The manufactured solution to be synthesized is\n$$\nx(t) = A_0 \\exp(-\\gamma\\, t)\\,\\exp\\big(\\epsilon\\,E(t)\\big)\\,\\cos\\big(\\omega\\, t + \\phi\\big) + \\sigma\\,\\xi(t),\n$$\nwhere $A_0$ is a positive amplitude, $\\gamma$ is a positive damping rate in $\\mathrm{s}^{-1}$, $\\omega$ is an angular frequency in $\\mathrm{rad/s}$, $\\phi$ is a constant phase in $\\mathrm{rad}$, $\\epsilon$ is a nonnegative coupling strength to turbulence, $E(t)$ is a zero-mean Ornstein–Uhlenbeck (OU) process modeling a fluctuating envelope induced by the turbulent Reynolds stress, and $\\xi(t)$ is a zero-mean white Gaussian noise representing measurement and unresolved dynamics. The OU process $E(t)$ is governed in the Itô sense by\n$$\n\\mathrm{d}E = -\\frac{1}{\\tau_c}E\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\tau_c}}\\,\\mathrm{d}W_t,\n$$\nwith correlation time $\\tau_c$ (in $\\mathrm{s}$) and Wiener increment $\\mathrm{d}W_t$. This choice ensures that $E(t)$ is stationary with unit variance.\n\nYour program must:\n\n- Construct $x(t)$ for each test case using a uniform temporal grid with sampling frequency $f_s$ (in $\\mathrm{Hz}$), duration $T$ (in $\\mathrm{s}$), and fixed seed for reproducibility.\n- Estimate the angular frequency $\\omega$ and damping rate $\\gamma$ from $x(t)$ using a scientifically justified numerical scheme grounded in signal analysis principles compatible with the modeled physics. As guidance, employ methods based on Fourier power spectral density to locate the dominant oscillatory band, analytic signal construction via the Hilbert transform to extract instantaneous phase and envelope, and regression on the logarithm of the envelope to estimate the damping rate.\n- Compare the estimated parameters to the imposed values and determine whether both the frequency and the damping are recovered within the specified absolute tolerances provided for each test case.\n\nPhysical units and requirements:\n\n- Express frequency in $\\mathrm{rad/s}$ and damping in $\\mathrm{s}^{-1}$.\n- Angles must be handled in $\\mathrm{radians}$.\n\nThe numerical scheme must be robust in the presence of multiplicative envelope fluctuations and additive noise. The estimation decisions must be justified by foundational principles: conservation and dissipation captured by a damped oscillator model, and spectral/analytic signal methods for oscillatory component extraction.\n\nTest Suite:\n\nFor each test case, a parameter tuple $(\\omega,\\gamma,A_0,\\epsilon,\\tau_c,\\sigma,f_s,T,\\phi,\\omega_{\\text{tol}},\\gamma_{\\text{tol}},\\text{seed})$ is provided. Your program must use these values exactly and produce a boolean indicating success if and only if both\n$$\n|\\widehat{\\omega} - \\omega| \\le \\omega_{\\text{tol}} \\quad \\text{and} \\quad |\\widehat{\\gamma} - \\gamma| \\le \\gamma_{\\text{tol}},\n$$\nwhere $\\widehat{\\omega}$ and $\\widehat{\\gamma}$ are the estimates.\n\nUse the following four scientifically plausible test cases, with all quantities in the specified units:\n\n1. Case 1 (moderate damping, moderate turbulence, high signal-to-noise):\n   - $\\omega = 2\\pi \\cdot 12{,}000$\n   - $\\gamma = 1200$\n   - $A_0 = 1.25$\n   - $\\epsilon = 0.2$\n   - $\\tau_c = 5\\times 10^{-4}$\n   - $\\sigma = 0.02$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.012$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 300$\n   - $\\gamma_{\\text{tol}} = 200$\n   - $\\text{seed} = 0$\n\n2. Case 2 (stronger damping, stronger turbulence, moderate noise):\n   - $\\omega = 2\\pi \\cdot 18{,}000$\n   - $\\gamma = 3000$\n   - $A_0 = 0.8$\n   - $\\epsilon = 0.4$\n   - $\\tau_c = 3\\times 10^{-4}$\n   - $\\sigma = 0.04$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.010$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 400$\n   - $\\gamma_{\\text{tol}} = 500$\n   - $\\text{seed} = 1$\n\n3. Case 3 (low damping, shorter record, higher noise):\n   - $\\omega = 2\\pi \\cdot 9{,}000$\n   - $\\gamma = 600$\n   - $A_0 = 1.0$\n   - $\\epsilon = 0.3$\n   - $\\tau_c = 4\\times 10^{-4}$\n   - $\\sigma = 0.05$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.006$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 500$\n   - $\\gamma_{\\text{tol}} = 250$\n   - $\\text{seed} = 2$\n\n4. Case 4 (higher frequency, high damping, no turbulence, moderate noise):\n   - $\\omega = 2\\pi \\cdot 25{,}000$\n   - $\\gamma = 4500$\n   - $A_0 = 1.1$\n   - $\\epsilon = 0.0$\n   - $\\tau_c = 3\\times 10^{-4}$\n   - $\\sigma = 0.03$\n   - $f_s = 5.0\\times 10^{5}$\n   - $T = 0.008$\n   - $\\phi = 0.37$\n   - $\\omega_{\\text{tol}} = 2\\pi \\cdot 400$\n   - $\\gamma_{\\text{tol}} = 600$\n   - $\\text{seed} = 3$\n\nFinal Output Format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one boolean per test case indicating success as defined above. For example: \"[True,False,True,True]\".",
            "solution": "The problem statement has been meticulously validated and is determined to be valid. It is scientifically grounded in the physics of wave-turbulence interaction in plasmas, specifically modeling a Geodesic Acoustic Mode (GAM). The problem is well-posed, providing all necessary parameters and a clear, objective success criterion. The parameters, while challenging due to strong damping in some cases, are physically plausible and force a robust numerical approach, which is appropriate for a problem at this level. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe solution is implemented by first synthesizing the time series according to the provided stochastic differential model and then applying a principled signal analysis procedure to estimate the parameters of interest, namely the angular frequency $\\omega$ and the damping rate $\\gamma$.\n\n### Signal Synthesis\n\nFor each test case, we generate a discrete time series $x(t_i)$.\n\n1.  **Temporal Grid**: A uniform time vector $t$ is constructed from $t=0$ to $t=T$ with a time step $\\Delta t = 1/f_s$. The total number of points is $N = \\lfloor T \\cdot f_s \\rfloor + 1$.\n\n2.  **Ornstein-Uhlenbeck (OU) Process**: The stochastic process $E(t)$ for the multiplicative noise is governed by the Stochastic Differential Equation (SDE):\n    $$\n    \\mathrm{d}E = -\\frac{1}{\\tau_c}E\\,\\mathrm{d}t + \\sqrt{\\frac{2}{\\tau_c}}\\,\\mathrm{d}W_t\n    $$\n    We generate a discrete realization $E_i = E(t_i)$ by integrating this SDE using the Euler-Maruyama scheme, which is appropriate given that the time step $\\Delta t$ is much smaller than the correlation time $\\tau_c$ in all test cases. The update rule is:\n    $$\n    E_{i+1} = E_i \\left(1 - \\frac{\\Delta t}{\\tau_c}\\right) + \\sqrt{\\frac{2\\Delta t}{\\tau_c}} Z_i\n    $$\n    where $Z_i$ are independent random variables drawn from a standard normal distribution, $\\mathcal{N}(0, 1)$. The process is initialized by drawing $E_0$ from its stationary distribution, which is $\\mathcal{N}(0, 1)$ as required for unit variance.\n\n3.  **Additive Noise**: The additive white noise component $\\xi(t)$ is realized as a discrete sequence $\\xi_i$ of random numbers drawn from $\\mathcal{N}(0, 1)$.\n\n4.  **Complete Signal**: The final time series $x(t_i)$ is assembled using the specified model:\n    $$\n    x(t_i) = A_0 \\exp(-\\gamma\\, t_i)\\,\\exp\\big(\\epsilon\\,E_i\\big)\\,\\cos\\big(\\omega\\, t_i + \\phi\\big) + \\sigma\\,\\xi_i\n    $$\n    A fixed random seed is used for each case to ensure reproducibility.\n\n### Parameter Estimation\n\nThe estimation of $\\widehat{\\omega}$ and $\\widehat{\\gamma}$ requires separating the oscillatory component from noise and analyzing its properties. A multi-stage process is employed as guided by the problem statement.\n\n1.  **Band-Pass Filtering**: The raw signal $x(t)$ is a composite of the desired damped oscillation and broadband additive noise. To isolate the GAM signal, a band-pass filter is essential.\n    -   The filter's center frequency is determined by locating the peak in the power spectral density (PSD) of the raw signal $x(t)$. The PSD is computed using the Fast Fourier Transform (FFT). The frequency corresponding to the maximum power provides a first estimate of the mode's frequency, $f_{peak}$.\n    -   A $5^{th}$-order Butterworth filter is designed with a passband centered at $f_{peak}$. The bandwidth is chosen to be $6$ kHz, which is wide enough to capture the mode's spectral width (broadened by damping and turbulent modulation) while rejecting a significant portion of out-of-band noise.\n    -   The filter is applied using a forward-backward pass (`sosfiltfilt`) to ensure zero phase distortion. This is critical as any phase distortion would corrupt the subsequent estimation of both $\\omega$ and $\\gamma$. Let the filtered signal be $x_{filt}(t)$.\n\n2.  **Analytic Signal Construction**: The Hilbert transform is applied to the filtered signal $x_{filt}(t)$ to construct the analytic signal, $z(t)$:\n    $$\n    z(t) = x_{filt}(t) + i\\mathcal{H}\\{x_{filt}(t)\\} = A(t)e^{i\\psi(t)}\n    $$\n    This representation effectively separates the signal into its instantaneous envelope, $A(t) = |z(t)|$, and instantaneous phase, $\\psi(t) = \\arg(z(t))$.\n\n3.  **Data Truncation for Robust Fitting**: In several test cases, the damping is strong, causing the signal envelope to decay below the additive noise floor $\\sigma$ well before the end of the time record $T$. Performing regressions on the noise-dominated tail of the signal would severely bias the estimates. Therefore, we perform the fits only on the portion of the signal where the envelope $A(t)$ is significant. We define a valid data region where $A(t)  3\\sigma$. This thresholding ensures that the estimation is based on the part of the signal with a high signal-to-noise ratio.\n\n4.  **Frequency Estimation ($\\widehat{\\omega}$)**: For an ideal filtered oscillation, the instantaneous phase evolves linearly with time: $\\psi(t) \\approx \\omega t + \\text{const}$. Thus, the angular frequency $\\omega$ is the rate of change of phase. A robust estimate, $\\widehat{\\omega}$, is obtained by performing a linear regression on the unwrapped phase $\\psi(t)$ versus time $t$ over the valid data region. The slope of this fit gives $\\widehat{\\omega}$. This method is generally more accurate than relying on the peak location in the FFT of a short, noisy signal.\n\n5.  **Damping Rate Estimation ($\\widehat{\\gamma}$)**: The model for the signal envelope, including the turbulent fluctuations, is approximately $A(t) \\approx A_0 \\exp(-\\gamma t) \\exp(\\epsilon E(t))$. Taking the natural logarithm linearizes the anelastic damping term:\n    $$\n    \\ln A(t) \\approx \\ln A_0 - \\gamma t + \\epsilon E(t)\n    $$\n    This is a linear relationship between $\\ln A(t)$ and $t$, with an additional zero-mean stochastic term $\\epsilon E(t)$. A linear regression of $\\ln A(t)$ versus $t$ (over the valid data region) will yield a slope that is a robust estimate of $-\\gamma$. Therefore, we set $\\widehat{\\gamma} = -(\\text{slope})$.\n\nFinally, for each test case, the estimated values $\\widehat{\\omega}$ and $\\widehat{\\gamma}$ are compared against the true values $\\omega$ and $\\gamma$ using the provided absolute tolerances $\\omega_{tol}$ and $\\gamma_{tol}$ to determine the success (True/False).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef analyze_signal(params):\n    \"\"\"\n    Synthesizes a GAM time series and estimates its frequency and damping rate.\n    \n    Args:\n        params (tuple): A tuple containing all model and analysis parameters.\n\n    Returns:\n        bool: True if both frequency and damping are recovered within tolerance, False otherwise.\n    \"\"\"\n    omega, gamma, A0, epsilon, tau_c, sigma, fs, T, phi, omega_tol, gamma_tol, seed = params\n\n    # 1. Signal Synthesis\n    rng = np.random.default_rng(seed)\n    \n    # Time base\n    dt = 1.0 / fs\n    num_points = int(T * fs) + 1\n    t = np.linspace(0.0, T, num_points, endpoint=True)\n\n    # Ornstein-Uhlenbeck process E(t) via Euler-Maruyama\n    E = np.zeros(num_points)\n    E[0] = rng.normal()  # Start from stationary distribution N(0,1)\n    # Pre-calculate constants for the loop\n    exp_factor = 1.0 - dt / tau_c\n    noise_factor = np.sqrt(2.0 * dt / tau_c)\n    for i in range(num_points - 1):\n        E[i+1] = exp_factor * E[i] + noise_factor * rng.normal()\n\n    # Additive white noise xi(t)\n    xi = rng.normal(size=num_points)\n\n    # Full manufactured signal x(t)\n    envelope = A0 * np.exp(-gamma * t) * np.exp(epsilon * E)\n    oscillation = np.cos(omega * t + phi)\n    x = envelope * oscillation + sigma * xi\n\n    # 2. Parameter Estimation\n    \n    # Coarse frequency estimate from PSD peak\n    # Use rfft for real-valued signal\n    n_fft = len(x)\n    yf = np.fft.rfft(x)\n    xf = np.fft.rfftfreq(n_fft, d=dt)\n    \n    # Find peak in power spectrum (ignoring DC component)\n    power = np.abs(yf[1:])**2\n    peak_idx = np.argmax(power) + 1 # +1 to account for slicing\n    f_peak = xf[peak_idx]\n\n    # Band-pass filter around the peak frequency\n    # Filter is designed to isolate the GAM mode from broadband noise\n    filter_order = 5\n    filter_bw = 6000.0  # Hz, a reasonable choice for these cases\n    f_low = max(1.0, f_peak - filter_bw / 2.0)\n    f_high = f_peak + filter_bw / 2.0\n    \n    nyquist = 0.5 * fs\n    # Wn is normalized to Nyquist frequency\n    wn = [f_low / nyquist, f_high / nyquist]\n    \n    sos = signal.butter(filter_order, wn, btype='bandpass', output='sos')\n    x_filt = signal.sosfiltfilt(sos, x)\n\n    # Analytic signal via Hilbert transform\n    z = signal.hilbert(x_filt)\n    envelope_hat = np.abs(z)\n    phase_hat = np.unwrap(np.angle(z))\n\n    # Perform fits only on the signal part with high SNR\n    # This avoids bias from the noise-dominated tail\n    valid_indices = np.where(envelope_hat > 3.0 * sigma)[0]\n    \n    # Check if we have enough points for a meaningful fit\n    if len(valid_indices)  20:\n        return False\n\n    t_valid = t[valid_indices]\n\n    # Estimate omega from phase slope\n    phase_valid = phase_hat[valid_indices]\n    omega_slope, _ = np.polyfit(t_valid, phase_valid, 1)\n    omega_hat = omega_slope\n\n    # Estimate gamma from envelope log-slope\n    log_envelope_valid = np.log(envelope_hat[valid_indices])\n    gamma_slope, _ = np.polyfit(t_valid, log_envelope_valid, 1)\n    gamma_hat = -gamma_slope\n\n    # 3. Validation\n    omega_err = np.abs(omega_hat - omega)\n    gamma_err = np.abs(gamma_hat - gamma)\n    \n    success = (omega_err = omega_tol) and (gamma_err = gamma_tol)\n    \n    return success\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # omega, gamma, A0, epsilon, tau_c, sigma, fs, T, phi, omega_tol, gamma_tol, seed\n    test_cases = [\n        (2 * np.pi * 12000, 1200, 1.25, 0.2, 5e-4, 0.02, 5.0e5, 0.012, 0.37, 2 * np.pi * 300, 200, 0),\n        (2 * np.pi * 18000, 3000, 0.8, 0.4, 3e-4, 0.04, 5.0e5, 0.010, 0.37, 2 * np.pi * 400, 500, 1),\n        (2 * np.pi * 9000, 600, 1.0, 0.3, 4e-4, 0.05, 5.0e5, 0.006, 0.37, 2 * np.pi * 500, 250, 2),\n        (2 * np.pi * 25000, 4500, 1.1, 0.0, 3e-4, 0.03, 5.0e5, 0.008, 0.37, 2 * np.pi * 400, 600, 3)\n    ]\n    \n    results = []\n    for case in test_cases:\n        result = analyze_signal(case)\n        results.append(result)\n\n    # Format output as specified: [True,False,True,True]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}