{
    "hands_on_practices": [
        {
            "introduction": "带状流并非由外部施加，而是自发地从背景湍流中涌现。其核心驱动力是雷诺胁强，这一机制将能量从小的湍流涡旋有效地输运到大尺度的平均流中。本练习将引导你从流体动量守恒方程出发，通过雷诺平均方法，推导出带状流的演化方程，从而清晰地揭示雷诺胁强的散度如何作为驱动项，与粘性耗散相抗衡，最终在定态下决定了带状流的振幅。 掌握这一推导，是理解带状流物理起源的基石。",
            "id": "4209597",
            "problem": "考虑一个板状几何中的静电二维（2D）湍流，存在均匀磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$。$\\mathbf{E} \\times \\mathbf{B}$ 速度为 $\\mathbf{v} = \\frac{c}{B} \\hat{\\mathbf{z}} \\times \\nabla \\phi$，其中 $\\phi(x,y,t)$ 是静电势，$c$ 是光速，$B$ 是磁场强度。纬向流定义为 $\\mathbf{v}$ 的极向分量的磁通面平均，即 $U(x,t) \\equiv \\langle v_{y} \\rangle_{y}$，其中 $\\langle \\cdot \\rangle_{y}$ 表示对极向坐标 $y$ 的平均。\n\n从不可压缩离子流体的动量守恒和雷诺平均（将 $\\mathbf{v}$ 分解为 $\\mathbf{v} = \\mathbf{U} + \\mathbf{v}'$，其中 $\\mathbf{U} = U(x,t)\\hat{\\mathbf{y}}$ 且 $\\langle \\mathbf{v}' \\rangle_{y} = \\mathbf{0}$）出发，并包含作用于平均流的碰撞粘性（模型化为运动粘度 $\\nu_{c}$）。利用这些要素推导平均流演化方程，该方程包含作为驱动项的雷诺应力 $R(x,t) \\equiv \\langle v_{x} v_{y} \\rangle_{y}$ 的散度和作为耗散项的 $U(x,t)$ 的粘性扩散。然后，在假设雷诺应力剖面不随时间变化且为给定形式\n$$\nR(x) = R_{0} \\sin(k x),\n$$\n其中 $R_{0} > 0$ 和 $k > 0$ 为常数，计算稳态纬向流振幅，其定义为\n$$\nU_{\\mathrm{amp}} \\equiv \\max_{x} |U(x)|,\n$$\n计算需满足 $x$ 方向周期为 $2\\pi/k$ 的周期性边界条件以及约束 $\\langle U \\rangle_{x} = 0$。请用仅包含 $R_{0}$、$\\nu_{c}$ 和 $k$ 的闭合形式解析表达式来表示你的最终答案。\n\n虽然你将提供一个解析表达式，但该振幅代表一个速度，如果进行数值计算，其单位将是米/秒。不要代入数值，也不要四舍五入；仅提供 $U_{\\mathrm{amp}}$ 的解析表达式。",
            "solution": "首先验证该问题具有科学依据、良定、客观且完整。它描述了等离子体湍流理论中的一个典型问题——由雷诺应力产生纬向流——这是一个标准且成熟的课题。所有必要的物理参数、函数形式和边界条件都已提供，足以推导出唯一且有意义的解。该问题基于流体动力学和动量守恒的基本原理，并将其应用于一个简化的等离子体模型。所用术语是标准的，其设置在物理上和数学上都是一致的。因此，我们开始求解。\n\n第一步是推导平均极向流（即纬向流）$U(x,t) \\equiv \\langle v_{y} \\rangle_{y}$ 的演化方程。我们从二维（$x$, $y$）不可压缩流体的动量守恒方程开始。速度的 $y$ 分量 $v_y$ 的方程，可以利用不可压缩条件 $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} = 0$ 写成守恒形式：\n$$\n\\frac{\\partial v_y}{\\partial t} + \\frac{\\partial}{\\partial x}(v_x v_y) + \\frac{\\partial}{\\partial y}(v_y^2) = \\mathcal{F}_y\n$$\n其中 $\\mathcal{F}_y$ 是作用在流体上的单位质量力的 $y$ 分量。问题指明，这个力是作用于平均流 $U(x,t)$ 的碰撞粘性所致。平均流定义为 $\\mathbf{U}(x,t) = U(x,t)\\hat{\\mathbf{y}}$。因此，粘性力为 $\\nu_c \\nabla^2 \\mathbf{U} = \\nu_c \\nabla^2 (U(x,t)\\hat{\\mathbf{y}})$。由于 $U$ 仅依赖于 $x$，这可简化为 $\\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\hat{\\mathbf{y}}$。因此，力的分量为 $\\mathcal{F}_y = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$。\n\n现在我们应用雷诺平均，对动量方程沿极向坐标 $y$ 取平均，记为 $\\langle \\cdot \\rangle_y$。\n$$\n\\left\\langle \\frac{\\partial v_y}{\\partial t} \\right\\rangle_y + \\left\\langle \\frac{\\partial}{\\partial x}(v_x v_y) \\right\\rangle_y + \\left\\langle \\frac{\\partial}{\\partial y}(v_y^2) \\right\\rangle_y = \\left\\langle \\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\right\\rangle_y\n$$\n我们逐项分析。根据 $U(x,t)$ 的定义，第一项变为 $\\frac{\\partial}{\\partial t}\\langle v_y \\rangle_y = \\frac{\\partial U}{\\partial t}$。根据雷诺应力 $R(x,t)$ 的定义，第二项变为 $\\frac{\\partial}{\\partial x}\\langle v_x v_y \\rangle_y = \\frac{\\partial R}{\\partial x}$。第三项，假设 $y$ 方向上为周期性边界条件（如“极向坐标”一词所暗示的），则为零：$\\langle \\frac{\\partial}{\\partial y}(v_y^2) \\rangle_y = \\frac{1}{L_y} \\int_0^{L_y} \\frac{\\partial}{\\partial y}(v_y^2) dy = \\frac{1}{L_y}[v_y^2]_{0}^{L_y} = 0$。右侧的项已经只是 $x$ 和 $t$ 的函数，所以平均不会改变它：$\\langle \\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\rangle_y = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$。\n合并这些项，我们得到平均流演化方程：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial R}{\\partial x} = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}\n$$\n这可以写成 $\\frac{\\partial U}{\\partial t} = -\\frac{\\partial R}{\\partial x} + \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$，表明纬向流由雷诺应力的散度驱动（具体来说，力是 $-\\frac{\\partial R}{\\partial x}$）并被粘性扩散所阻尼。\n\n问题的第二部分要求解稳态解。在稳态下，$\\frac{\\partial U}{\\partial t} = 0$。我们已知不随时间变化的雷诺应力剖面 $R(x) = R_{0} \\sin(k x)$。演化方程变为关于 $U(x)$ 的常微分方程（ODE）：\n$$\n-\\frac{d R}{d x} + \\nu_c \\frac{d^2 U}{d x^2} = 0\n$$\n代入 $R(x)$ 的表达式：\n$$\n\\nu_c \\frac{d^2 U}{d x^2} = \\frac{d}{dx} \\left(R_{0} \\sin(k x)\\right) = k R_{0} \\cos(k x)\n$$\n我们将此常微分方程对 $x$ 积分两次。第一次积分得到：\n$$\n\\nu_c \\frac{dU}{dx} = \\int k R_{0} \\cos(k x) \\, dx = R_{0} \\sin(k x) + C_1\n$$\n其中 $C_1$ 是第一个积分常数。再次积分：\n$$\n\\nu_c U(x) = \\int \\left(R_{0} \\sin(k x) + C_1\\right) \\, dx = -\\frac{R_{0}}{k} \\cos(k x) + C_1 x + C_2\n$$\n其中 $C_2$ 是第二个积分常数。$U(x)$ 的解为：\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_1}{\\nu_c} x + \\frac{C_2}{\\nu_c}\n$$\n现在我们应用边界条件和约束来确定 $C_1$ 和 $C_2$。解在 $x$ 方向上必须是周期性的，周期为 $2\\pi/k$。项 $\\frac{C_1}{\\nu_c} x$ 是久期项，除非 $C_1=0$，否则会破坏周期性。因此，周期性条件 $U(x) = U(x+2\\pi/k)$ 意味着 $C_1=0$。解简化为：\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_2}{\\nu_c}\n$$\n接下来，我们应用零平均流约束 $\\langle U \\rangle_x = 0$，其中平均是在 $x$ 的一个周期上进行的：\n$$\n\\langle U \\rangle_x = \\frac{k}{2\\pi} \\int_{0}^{2\\pi/k} \\left( -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_2}{\\nu_c} \\right) dx = 0\n$$\n$\\cos(k x)$ 在一个完整周期上的积分为零。常数项的积分为 $\\frac{C_2}{\\nu_c} \\times \\frac{2\\pi}{k}$。因此，平均值为：\n$$\n\\frac{k}{2\\pi} \\left( 0 + \\frac{C_2}{\\nu_c} \\frac{2\\pi}{k} \\right) = \\frac{C_2}{\\nu_c}\n$$\n约束 $\\langle U \\rangle_x = 0$ 迫使 $\\frac{C_2}{\\nu_c} = 0$，即 $C_2=0$。\n因此，纬向流剖面的唯一稳态解为：\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x)\n$$\n问题要求的是纬向流振幅，定义为 $U_{\\mathrm{amp}} \\equiv \\max_{x} |U(x)|$。\n$$\nU_{\\mathrm{amp}} = \\max_{x} \\left| -\\frac{R_{0}}{k \\nu_c} \\cos(k x) \\right|\n$$\n已知 $R_{0} > 0$，$k > 0$，并且运动粘度 $\\nu_c$ 是一个正的物理常数，我们有：\n$$\nU_{\\mathrm{amp}} = \\frac{R_{0}}{k \\nu_c} \\max_{x} | \\cos(k x) |\n$$\n$|\\cos(k x)|$ 的最大值为 $1$。因此，稳态纬向流振幅为：\n$$\nU_{\\mathrm{amp}} = \\frac{R_{0}}{k \\nu_c}\n$$\n此表达式仅依赖于给定的参数 $R_{0}$、$\\nu_c$ 和 $k$。",
            "answer": "$$\n\\boxed{\\frac{R_{0}}{k \\nu_{c}}}\n$$"
        },
        {
            "introduction": "理解了带状流的生成机制后，在分析湍流模拟数据时的一个关键任务便是回答“系统中有多少能量集中在带状流中？”这个问题。这个问题的答案通常隐藏在系统的能量谱里。本练习将带你从雷诺胁强的物理空间图像转换到模拟诊断中更常用的波数空间视图，通过对一个理想化的模型能谱进行分析，你将学会如何定义和计算带状流能量占比，这是一个衡量湍流态是否由带状流主导的关键指标。",
            "id": "4209523",
            "problem": "考虑磁化等离子体中的静电湍流，其主导流动是电场叉磁场（$E \\times B$）漂移。在一个二维（$2$D）周期性区域的统计均匀态中，设涨落的E×B速度场的单位质量动能由一个非负谱密度 $E(k_{x},k_{y})$ 表示，其中 $k_{x}$ 和 $k_{y}$ 分别是径向和极向波数。带状流被定义为流动的轴对称（$m=0$）极向分量，在谱空间上对应于 $k_{y}=0$ 模式。根据定义，带状流能谱是切片 $E_{\\mathrm{ZF}}(k_{x})=E(k_{x},0)$，总带状流能量通过对 $E_{\\mathrm{ZF}}$ 在 $k_{x}$ 上积分得到，而总湍流能量则通过对 $E$ 在 $k_{x}$ 和 $k_{y}$ 上积分得到。基于这些定义，一个用于诊断带状流主导性的自然指标是以下比率\n$$\n\\mathcal{R}\\equiv \\frac{\\int_{-\\infty}^{\\infty}E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x}}{\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}}.\n$$\n从谱能量的定义和E×B流动的帕塞瓦尔定理出发，论证使用 $k_{y}=0$ 作为带状流扇区以及上述比率作为带状流在总能量中所占份额的合理性。然后，假设一个复合的、各向异性的但可分离的模型谱，其在 $k_{y}=0$ 附近有一个窄脊，用以表示叠加在更宽的漂移波背景上的相干带状流，\n$$\nE(k_{x},k_{y})=Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big),\n$$\n其中 $Z_{0}$、$A_{b}$、$k_{z}$、$k_{bx}$、$k_{by}$ 和 $\\varepsilon$ 是严格正常数，$\\varepsilon$ 为小量，用以表示带状流在 $k_{y}=0$ 附近的谱集中。仅使用基本谱定义和标准高斯积分公式，计算比率 $\\mathcal{R}$ 关于这些参数的精确闭式表达式。然后，根据应用于 $\\mathcal{R}$ 的用户指定阈值 $\\eta\\in(0,1)$，建立一个定量的带状流主导判据。你最终报告的结果必须是 $\\mathcal{R}$ 的精确解析表达式；不需要进行数值计算，最终结果中也不应包含单位。",
            "solution": "经检验，该问题在科学上是合理的、适定的和客观的。它提出了一个聚变等离子体湍流领域的标准（尽管简化了）模型，并要求基于基本原理进行严格的推导和计算。\n\n首先，我们论证问题陈述中给出的定义的合理性。背景是一个磁化等离子体中静电湍流的二维（$2$D）模型。主导流动是$\\mathbf{E}\\times\\mathbf{B}$漂移，由$\\mathbf{v}_{E} = (\\mathbf{E} \\times \\mathbf{B}) / B^2$给出。在具有强而均匀磁场$\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$的板坯几何中，电场$\\mathbf{E}$由静电势$\\phi(x, y, t)$导出，使得$\\mathbf{E} = -\\nabla\\phi$。速度场分量为$v_x = -(1/B_0)\\partial_y\\phi$和$v_y = (1/B_0)\\partial_x\\phi$。单位质量的动能是$\\frac{1}{2}|\\mathbf{v}_E|^2 = \\frac{1}{2B_0^2}|\\nabla\\phi|^2$。\n\n空间区域内的总湍流动能通过对此量在面积上积分得到。根据帕塞瓦尔定理，这个实空间积分可以转换成傅里叶空间上的积分或求和。对于一个周期性区域，电势可以表示为傅里叶级数 $\\phi(\\mathbf{x}) = \\sum_{\\mathbf{k}} \\hat{\\phi}_{\\mathbf{k}} \\exp(i\\mathbf{k}\\cdot\\mathbf{x})$，其中$\\mathbf{k}=(k_x, k_y)$。帕塞瓦尔定理指出 $\\int |\\nabla\\phi|^2 d\\mathbf{x} \\propto \\sum_{\\mathbf{k}} |\\nabla\\phi|_{\\mathbf{k}}^2 = \\sum_{\\mathbf{k}} |i\\mathbf{k} \\hat{\\phi}_{\\mathbf{k}}|^2 = \\sum_{\\mathbf{k}} (k_x^2+k_y^2)|\\hat{\\phi}_{\\mathbf{k}}|^2$。在无限区域的连续极限下，总能量由$\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}$给出，其中$E(k_x, k_y)$是能谱密度。$E(k_x, k_y)$与$(k_x^2+k_y^2)|\\hat{\\phi}(k_x, k_y)|^2$成正比，并代表来自波数为$(k_x, k_y)$的模式的能量贡献。\n\n带状流被定义为轴对称的，在这种板坯几何中对应于在极向（$y$）方向上均匀的流动。一个与$y$无关的函数$f(x, y)$，其关于$y$的傅里叶变换仅在$k_y=0$处非零。为使流场与$y$无关，电势$\\phi$的结构必须使其傅里叶分量$\\hat{\\phi}(k_x, k_y)$对于所有$k_y \\neq 0$均为零。这些就是$k_y=0$模式。在物理上，如果$\\phi=\\phi(x)$，则$v_x = 0$且$v_y = (1/B_0)d\\phi/dx$，这描述了一个径向剪切的极向流，即带状流的典范形式。因此，这些模式中包含的能量集中在谱平面的$k_y=0$轴上。因此，将带状流能谱正确地定义为切片$E_{\\mathrm{ZF}}(k_{x})=E(k_{x},0)$。带状流中的总能量是此切片在所有径向波数上的积分，即$\\mathcal{E}_{\\mathrm{ZF}} = \\int_{-\\infty}^{\\infty}E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x}$。因此，比率$\\mathcal{R} \\equiv \\mathcal{E}_{\\mathrm{ZF}}/\\mathcal{E}_{\\text{total}}$代表存在于带状流结构中的能量占总湍流动能的份额。\n\n接下来，我们计算给定模型谱的比率$\\mathcal{R}$：\n$$\nE(k_{x},k_{y})=Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\n$$\n$\\mathcal{R}$的分子是总带状流能量$\\mathcal{E}_{\\mathrm{ZF}}$。我们首先通过在全谱中设置$k_y=0$来确定带状流谱$E_{\\mathrm{ZF}}(k_x)$：\n$$\nE_{\\mathrm{ZF}}(k_{x}) = E(k_{x},0) = Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\exp(0)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\exp(0)\n$$\n$$\nE_{\\mathrm{ZF}}(k_{x}) = Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\n$$\n现在我们在$k_x$上从$-\\infty$到$\\infty$进行积分。我们使用标准高斯积分公式$\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$。\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = \\int_{-\\infty}^{\\infty} E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x} = \\int_{-\\infty}^{\\infty} \\left[ Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big) \\right] \\mathrm{d}k_{x}\n$$\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = Z_{0}\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{1}{k_{z}^{2}}k_{x}^{2}\\Big)\\,\\mathrm{d}k_{x} + A_{b}\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{1}{k_{bx}^{2}}k_{x}^{2}\\Big)\\,\\mathrm{d}k_{x}\n$$\n应用该公式，我们得到：\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = Z_{0}\\sqrt{\\pi k_{z}^{2}} + A_{b}\\sqrt{\\pi k_{bx}^{2}} = Z_{0}k_{z}\\sqrt{\\pi} + A_{b}k_{bx}\\sqrt{\\pi} = \\sqrt{\\pi}(Z_{0}k_{z} + A_{b}k_{bx})\n$$\n$\\mathcal{R}$的分母是总湍流能量$\\mathcal{E}_{\\text{total}}$，通过对$E(k_x, k_y)$在$k_x$和$k_y$上积分得到。\n$$\n\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\n$$\n由于给定的谱是两个可分离项的和，积分为：\n$$\n\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y} + \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\n$$\n每个二重积分可以分解为两个单积分的乘积：\n$$\n\\mathcal{E}_{\\text{total}} = Z_{0}\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\mathrm{d}k_{x}\\right)\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)\\mathrm{d}k_{y}\\right) + A_{b}\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\mathrm{d}k_{x}\\right)\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\\mathrm{d}k_{y}\\right)\n$$\n对每个部分应用高斯积分公式：\n$$\n\\mathcal{E}_{\\text{total}} = Z_{0}(k_{z}\\sqrt{\\pi})(\\varepsilon\\sqrt{\\pi}) + A_{b}(k_{bx}\\sqrt{\\pi})(k_{by}\\sqrt{\\pi})\n$$\n$$\n\\mathcal{E}_{\\text{total}} = \\pi Z_{0}k_{z}\\varepsilon + \\pi A_{b}k_{bx}k_{by} = \\pi(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})\n$$\n最后，我们计算比率$\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{\\mathcal{E}_{\\mathrm{ZF}}}{\\mathcal{E}_{\\text{total}}} = \\frac{\\sqrt{\\pi}(Z_{0}k_{z} + A_{b}k_{bx})}{\\pi(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}\n$$\n通过消去$\\sqrt{\\pi}$来化简表达式：\n$$\n\\mathcal{R} = \\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}\n$$\n这就是比率$\\mathcal{R}$的最终精确解析表达式。\n\n最后，可以使用用户指定的阈值$\\eta \\in (0,1)$来建立一个定量的带状流主导判据。由于$\\mathcal{R}$表示带状流中的能量份额，如果该份额超过阈值$\\eta$，则可以宣布系统处于带状流主导状态。因此，该判据表示为不等式：\n$$\n\\mathcal{R} > \\eta\n$$\n或者，代入$\\mathcal{R}$的推导表达式：\n$$\n\\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})} > \\eta\n$$\n这个不等式为系统被视为处于带状流主导状态提供了关于谱参数（$Z_{0}, A_{b}, k_{z}, k_{bx}, k_{by}, \\varepsilon$）的条件。",
            "answer": "$$\n\\boxed{\\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}}\n$$"
        },
        {
            "introduction": "本节实践将在理论与计算机模拟之间架起一座桥梁。伪谱方法是模拟等离子体湍流的强大工具，但它也可能引入如“混淆误差”（aliasing）之类的数值伪影，从而污染所模拟的物理过程。这个练习聚焦于模拟湍流时的一个核心挑战：确保数值方法能精确地再现物理过程。你将通过具体的数值实验，探索伪谱方法中的混淆误差如何错误地影响带状流的生成，以及诸如“2/3法则”这样的去混淆技术是如何被设计来消除这些误差，从而保证模拟结果的物理保真度。",
            "id": "4209554",
            "problem": "考虑一个在均匀网格上离散化的二维周期性区域，该网格在 $x$ 方向有 $N_x$ 个点，在 $y$ 方向有 $N_y$ 个点。令 $k_x$ 和 $k_y$ 分别表示沿 $x$ 和 $y$ 方向的离散波数指数，其取值在主值范围 $-N_x/2 \\le k_x \\le N_x/2-1$ 和 $-N_y/2 \\le k_y \\le N_y/2-1$ 内的整数。带状流模式定义为任何满足 $k_y = 0$ 的谱分量。在伪谱方法中，二次非线性项对应于三波相互作用，在连续谱中这要求 $k_3 = k_1 + k_2$，其中每个 $k_i$ 是一个二维整数向量。在离散网格上，卷积通过在物理空间中进行乘法运算，然后变换回谱空间来计算。由于离散采样，真实的和 $k_{\\mathrm{true}} = k_1 + k_2$会混叠到一个指数 $k_{\\mathrm{alias}} = k_{\\mathrm{true}} - s_x N_x \\,\\hat{\\mathbf{x}} - s_y N_y \\,\\hat{\\mathbf{y}}$上，其中 $s_x$ 和 $s_y$ 是选择的整数，以使 $k_{\\mathrm{alias}}$ 的每个分量都落在主值范围内。混叠效应会在低波数处产生虚假的能量，包括在 $k_y = 0$ 的频带中。\n\n对于二次非线性项，一个常见的光谱去混叠策略是“三分之二规则”，该规则截断谱，使得在物理空间中计算乘积之前，只保留波数满足 $\\lvert k_x \\rvert \\le \\lfloor N_x/3 \\rfloor$ 和 $\\lvert k_y \\rvert \\le \\lfloor N_y/3 \\rfloor$ 的分量。这样一来，由两个被保留的波矢相加产生的任何混叠都会映射到被保留集合之外。在磁化等离子体的湍流模拟中，产生 $k_y = 0$ 模式的三波相互作用是带状流生成的原因。过于激进或不正确的去混叠可能会抑制合法的 $k_y = 0$ 生成，而缺乏去混叠则可能用虚假的混叠能量污染 $k_y = 0$。\n\n从卷积定理和离散周期网格上的混叠定义出发，推导出“三分之二规则”在何种原则性标准下能够保留产生 $k_y = 0$ 的合法三波相互作用，并消除对 $k_y = 0$ 的虚假混叠贡献。然后，实现一个程序，该程序用给定的波矢构建两个平面波场，在物理空间中将它们相乘，变换到谱空间，并测量总谱能量中位于带状频带 $k_y = 0$ 的能量分数。将带状能量分数定义为\n$$\n\\mathcal{Z} = \n\\begin{cases}\n\\frac{\\sum_{k_x} \\lvert \\hat{f}(k_x, 0)\\rvert^2}{\\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2},  \\text{若 } \\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2 > 0, \\\\\n0,  \\text{其他情况},\n\\end{cases}\n$$\n其中 $\\hat{f}(k_x, k_y)$ 是乘积场的离散傅里叶变换。当启用去混叠时，通过在乘法之前将任何满足 $\\lvert k_x \\rvert > \\lfloor N_x/3 \\rfloor$ 或 $\\lvert k_y \\rvert > \\lfloor N_y/3 \\rfloor$ 的输入平面波设置为零来强制执行“三分之二”截断。\n\n您的程序必须为以下测试套件计算 $\\mathcal{Z}$。对于每种情况，数对 $(k_1, k_2)$ 表示输入波矢，去混叠标志指示是否对输入应用“三分之二规则”：\n\n- 情况 1：$N_x = 64$, $N_y = 64$, $k_1 = (10, 7)$, $k_2 = (-10, -7)$, 去混叠标志 = $\\mathrm{False}$。\n- 情况 2：$N_x = 64$, $N_y = 64$, $k_1 = (10, 7)$, $k_2 = (-10, -7)$, 去混叠标志 = $\\mathrm{True}$。\n- 情况 3：$N_x = 64$, $N_y = 64$, $k_1 = (22, 20)$, $k_2 = (22, -20)$, 去混叠标志 = $\\mathrm{False}$。\n- 情况 4：$N_x = 64$, $N_y = 64$, $k_1 = (22, 20)$, $k_2 = (22, -20)$, 去混叠标志 = $\\mathrm{True}$。\n- 情况 5：$N_x = 48$, $N_y = 96$, $k_1 = (16, 30)$, $k_2 = (-16, -30)$, 去混叠标志 = $\\mathrm{True}$。\n- 情况 6：$N_x = 48$, $N_y = 96$, $k_1 = (20, 34)$, $k_2 = (-20, -34)$, 去混叠标志 = $\\mathrm{True}$。\n\n本问题中的所有量都是无量纲的；没有物理单位。您的程序应生成单行输出，其中包含上述案例的六个带状能量分数 $\\mathcal{Z}$，以逗号分隔的列表形式包含在方括号内，并按所列顺序排列（例如，$[\\mathcal{Z}_1,\\mathcal{Z}_2,\\mathcal{Z}_3,\\mathcal{Z}_4,\\mathcal{Z}_5,\\mathcal{Z}_6]$）。",
            "solution": "问题要求在二维伪谱模拟中带状流生成的背景下，分析“三分之二”去混叠规则，然后通过数值实现来验证所推导的原理。\n\n### 问题验证\n\n所提供的问题陈述是**有效的**。它在科学上基于伪谱方法、傅里叶分析和湍流理论的既定原理。混叠、卷积定理和“三分之二”去混叠规则是计算物理学中的标准概念。这个问题是适定的，提供了所有必要的参数（$N_x$, $N_y$, 波矢 $\\mathbf{k}_{1}$ 和 $\\mathbf{k}_{2}$, 去混叠标志）以及一个清晰、客观的待计算量（带状能量分数 $\\mathcal{Z}$）的定义。测试用例定义明确，旨在探究混叠与去混叠之间相互作用的不同方面。问题不包含任何科学谬误、歧义或矛盾。\n\n### 原理推导\n\n让我们考虑在尺寸为 $N_x \\times N_y$ 的均匀网格上离散化的二维周期域 $\\mathbf{x} = (x, y)$ 上的两个标量场 $f_1(\\mathbf{x})$ 和 $f_2(\\mathbf{x})$。它们的乘积为 $f(\\mathbf{x}) = f_1(\\mathbf{x}) f_2(\\mathbf{x})$。根据离散傅里叶变换 (DFT) 的卷积定理，乘积场 $\\hat{f}(\\mathbf{k})$ 的谱是各个谱 $\\hat{f}_1(\\mathbf{k})$ 和 $\\hat{f}_2(\\mathbf{k})$ 的循环卷积：\n$$\n\\hat{f}(\\mathbf{k}) = \\sum_{\\mathbf{k}'} \\hat{f}_1(\\mathbf{k}') \\hat{f}_2(\\mathbf{k} - \\mathbf{k}')\n$$\n其中波矢指数 $\\mathbf{k} = (k_x, k_y)$ 是在主值范围 $-N_x/2 \\le k_x \\le N_x/2-1$ 和 $-N_y/2 \\le k_y \\le N_y/2-1$ 内的整数。波矢的和与差是隐式地对 $(N_x, N_y)$ 取模。\n\n在这个问题中，输入场是单个平面波，这意味着它们的谱是克罗内克(Kronecker)δ函数。设 $f_1(\\mathbf{x})$ 对应波矢 $\\mathbf{k}_1$，$f_2(\\mathbf{x})$ 对应波矢 $\\mathbf{k}_2$。它们的谱为 $\\hat{f}_1(\\mathbf{k}) \\propto \\delta(\\mathbf{k} - \\mathbf{k}_1)$ 和 $\\hat{f}_2(\\mathbf{k}) \\propto \\delta(\\mathbf{k} - \\mathbf{k}_2)$。在物理空间中的乘积 $f_1(\\mathbf{x}) f_2(\\mathbf{x})$ 是一个新的平面波，其波矢为 $\\mathbf{k}_{\\text{true}} = \\mathbf{k}_1 + \\mathbf{k}_2$。在离散网格上，这个结果波矢会混叠到主值范围内。混叠波矢 $\\mathbf{k}_{\\text{alias}}$ 由下式给出：\n$$\n\\mathbf{k}_{\\text{alias}} = \\mathbf{k}_{\\text{true}} - s_x N_x \\hat{\\mathbf{x}} - s_y N_y \\hat{\\mathbf{y}}\n$$\n其中整数 $s_x$ 和 $s_y$ 的选择使得 $\\mathbf{k}_{\\text{alias}}$ 的分量落在主值范围内。乘积场的谱将在 $\\mathbf{k}_{\\text{alias}}$ 处有一个单一的非零分量。\n\n带状流模式由条件 $k_y = 0$ 定义。\n- **合法的带状流生成**发生在当波矢的真实和产生一个 $y$ 分量为零的模式时，即 $k_{1y} + k_{2y} = 0$。\n- **虚假的（混叠的）带状流生成**发生在当 $k_{1y} + k_{2y} \\neq 0$ 但混叠将结果模式映射到一个 $y$ 分量为零的模式时。这种情况发生在当 $k_{1y} + k_{2y} = s_y N_y$ 时，其中 $s_y$ 是某个非零整数。\n\n“三分之二”去混叠规则截断谱，仅保留满足 $|k_x| \\le K_x = \\lfloor N_x/3 \\rfloor$ 和 $|k_y| \\le K_y = \\lfloor N_y/3 \\rfloor$ 的模式。\n\n**标准1：保留合法的带状流生成**\n一个合法的、产生带状流的相互作用（其中 $k_{1y} + k_{2y} = 0$）能够被“三分之二规则”正确计算和保留，当且仅当输入波矢 $\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 本身被该规则保留。这要求：\n$$\n|k_{1x}| \\le \\lfloor N_x/3 \\rfloor \\quad \\text{且} \\quad |k_{1y}| \\le \\lfloor N_y/3 \\rfloor\n$$\n$$\n|k_{2x}| \\le \\lfloor N_x/3 \\rfloor \\quad \\text{且} \\quad |k_{2y}| \\le \\lfloor N_y/3 \\rfloor\n$$\n如果任一输入波矢位于此保留区域之外，去混叠方案的实现会将相应的场设置为零，从而完全抑制该相互作用。\n\n**标准2：消除虚假的带状流生成**\n“三分之二规则”保证消除所有由任意两个保留模式之间的二次相互作用产生的对 $k_y=0$ 频带的虚假贡献。这可以证明如下：\n1.  设 $\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 是保留区域内的两个波矢。根据“三分之二规则”的定义，这意味着 $|k_{1y}| \\le K_y = \\lfloor N_y/3 \\rfloor$ 且 $|k_{2y}| \\le K_y = \\lfloor N_y/3 \\rfloor$。\n2.  这些波矢的真实和的 $y$ 分量为 $k_{\\text{true},y} = k_{1y} + k_{2y}$。\n3.  使用三角不等式，我们可以限制这个和的大小：$|k_{\\text{true},y}| = |k_{1y} + k_{2y}| \\le |k_{1y}| + |k_{2y}| \\le K_y + K_y = 2K_y$。\n4.  由于 $K_y = \\lfloor N_y/3 \\rfloor \\le N_y/3$，我们有 $|k_{\\text{true},y}| \\le 2(N_y/3)$。对于任何 $N_y \\ge 1$，都成立 $2N_y/3 < N_y$。\n5.  一个虚假的带状贡献要求 $k_{\\text{true},y}$ 是 $N_y$ 的非零整数倍，即 $k_{\\text{true},y} = s_y N_y$，其中 $s_y \\in \\{\\pm 1, \\pm 2, \\dots\\}$。\n6.  然而，从第4步我们知道 $|k_{\\text{true},y}| < N_y$。这使得 $k_{\\text{true},y}$ 不可能等于 $N_y$ 的任何非零整数倍。\n7.  因此，混叠后的 $y$ 波数 $k_{\\text{alias},y}$ 要为 $0$ 的唯一方式是真实和 $k_{\\text{true},y}$ 本身就为 $0$。而这正是合法而非虚假的带状流生成的条件。\n这证明了“三分之二规则”能有效消除由谱中保留部分的相互作用混叠到带状流频带的虚假能量。\n\n### 算法设计与测试用例分析\n\n程序将为每个测试用例执行以下步骤：\n1.  接收网格尺寸 ($N_x, N_y$)、输入波矢 ($\\mathbf{k}_1, \\mathbf{k}_2$) 和去混叠标志。\n2.  如果启用了去混叠，检查 $\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 是否满足“三分之二规则”。如果一个波矢超出限制（$\\lvert k_x \\rvert > \\lfloor N_x/3 \\rfloor$ 或 $\\lvert k_y \\rvert > \\lfloor N_y/3 \\rfloor$），其对应的场将被视为零。\n3.  在物理空间中构建两个输入场。对于波矢 $\\mathbf{k}=(k_x, k_y)$，其场为 $f(\\mathbf{x}) = \\exp(i(k_x x + k_y y))$，定义在 $x \\in [0, 2\\pi)$ 和 $y \\in [0, 2\\pi)$ 的网格上。如果输入因去混叠而被截断，其场是一个零数组。\n4.  将两个物理空间场相乘以获得乘积场 $f(\\mathbf{x})$。\n5.  计算 $f(\\mathbf{x})$ 的二维 DFT 以得到 $\\hat{f}(\\mathbf{k})$，并平移结果以使零频分量居中。\n6.  计算总谱能量，$E_{\\text{total}} = \\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2$。\n7.  计算带状能量，$E_{\\text{zonal}} = \\sum_{k_x} \\lvert \\hat{f}(k_x, 0)\\rvert^2$。$k_y=0$ 模式对应于平移后的二维谱数组的中心行。\n8.  计算带状能量分数 $\\mathcal{Z} = E_{\\text{zonal}} / E_{\\text{total}}$，并通过设置 $\\mathcal{Z} = 0$ 来处理 $E_{\\text{total}} = 0$ 的情况。\n\n**测试用例分析：**\n- **情况 1 和 2：** ($N_x=64, N_y=64, \\mathbf{k}_1=(10, 7), \\mathbf{k}_2=(-10, -7)$)。这是一个合法的带状流相互作用，因为 $\\mathbf{k}_1+\\mathbf{k}_2 = (0,0)$。“三分之二”规则的限制是 $K_x=K_y=\\lfloor 64/3 \\rfloor=21$。$\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 都在这些限制之内。因此，无论是否去混叠，该相互作用都被保留。结果场是一个常数，其全部谱能量都位于 $\\mathbf{k}=(0,0)$。对于这两种情况，$\\mathcal{Z} = 1.0$。\n- **情况 3 和 4：** ($N_x=64, N_y=64, \\mathbf{k}_1=(22, 20), \\mathbf{k}_2=(22, -20)$)。这是一个合法的带状流相互作用，其 $\\mathbf{k}_{\\text{true}} = (44,0)$。在离散网格上，这会混叠为 $\\mathbf{k}_{\\text{alias}} = (44-64, 0) = (-20, 0)$，这是一个带状模式。\n    - 情况 3 (去混叠=False): 相互作用正常进行，仅在 $\\mathbf{k}=(-20, 0)$ 处产生谱能量。因此，$\\mathcal{Z} = 1.0$。\n    - 情况 4 (去混叠=True): “三分之二”规则的限制是 $K_x=21$。两个输入模式的 $|k_x|=22 > 21$，所以它们被截断。乘积场为零，总能量为零，$\\mathcal{Z} = 0$。这展示了涉及高波数模式的合法相互作用被抑制的情况。\n- **情况 5：** ($N_x=48, N_y=96, \\mathbf{k}_1=(16, 30), \\mathbf{k}_2=(-16, -30)$, 去混叠=True)。合法的相互作用，$\\mathbf{k}_1+\\mathbf{k}_2=(0,0)$。限制是 $K_x=\\lfloor 48/3 \\rfloor = 16$ 和 $K_y=\\lfloor 96/3 \\rfloor = 32$。两个输入模式都满足条件 ($|16|\\le16$, $|30|\\le32$)。相互作用被保留。我们预期 $\\mathcal{Z}=1.0$。\n- **情况 6：** ($N_x=48, N_y=96, \\mathbf{k}_1=(20, 34), \\mathbf{k}_2=(-20, -34)$, 去混叠=True)。合法的相互作用，$\\mathbf{k}_1+\\mathbf{k}_2=(0,0)$。限制是 $K_x=16$, $K_y=32$。输入模式违反了限制，因为 $|20|>16$ 且 $|34|>32$。两个输入场都被截断为零。结果乘积为零，所以 $\\mathcal{Z}=0$。\n预期输出为 $[1.0, 1.0, 1.0, 0.0, 1.0, 0.0]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_zonal_fraction(Nx, Ny, k1, k2, dealias):\n    \"\"\"\n    Computes the zonal energy fraction for the product of two plane waves.\n\n    Args:\n        Nx (int): Number of grid points in the x direction.\n        Ny (int): Number of grid points in the y direction.\n        k1 (tuple): Wavevector (kx, ky) for the first plane wave.\n        k2 (tuple): Wavevector (kx, ky) for the second plane wave.\n        dealias (bool): If True, apply the 2/3 de-aliasing rule to inputs.\n\n    Returns:\n        float: The zonal energy fraction Z.\n    \"\"\"\n    amp1 = 1.0\n    amp2 = 1.0\n\n    if dealias:\n        Kx = Nx // 3\n        Ky = Ny // 3\n        if abs(k1[0]) > Kx or abs(k1[1]) > Ky:\n            amp1 = 0.0\n        if abs(k2[0]) > Kx or abs(k2[1]) > Ky:\n            amp2 = 0.0\n\n    # If either amplitude is zero due to dealiasing, the product is zero, so Z=0.\n    if amp1 == 0.0 or amp2 == 0.0:\n        return 0.0\n\n    # Create coordinate grid. Using endpoint=False for periodic domain.\n    x = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    y = np.linspace(0, 2 * np.pi, Ny, endpoint=False)\n    yy, xx = np.meshgrid(y, x) # Note: meshgrid returns (Y, X) for matrix indexing\n    \n    # Construct the two plane wave fields in physical space.\n    field1 = np.exp(1j * (k1[0] * xx + k1[1] * yy))\n    field2 = np.exp(1j * (k2[0] * xx + k2[1] * yy))\n    \n    # Compute the product in physical space.\n    product_field = field1 * field2\n\n    # Transform to spectral space via 2D FFT.\n    # The result is shifted so that the k=(0,0) component is at the center.\n    spectrum = np.fft.fftshift(np.fft.fft2(product_field))\n\n    # Calculate total spectral energy (proportional to sum of squares of amplitudes).\n    # Using np.abs()**2 gives the squared magnitude |z|^2.\n    total_energy = np.sum(np.abs(spectrum)**2)\n\n    if total_energy == 0.0:\n        return 0.0\n\n    # The zonal modes (ky=0) correspond to the central row in the shifted spectrum.\n    # For an even Nx, Ny, the zero-frequency is at index N/2.\n    # The axes are (x, y) after meshgrid, so spectrum shape is (Nx, Ny)\n    # zonal modes are where the second index (related to y) is at its zero-frequency position.\n    zonal_col_index = Ny // 2\n    # But wait, my meshgrid indexing is yy, xx = np.meshgrid(y, x), so shape of xx, yy is (len(y), len(x)) -> (Ny, Nx)\n    # This means product_field has shape (Ny, Nx). And spectrum has shape (Ny, Nx).\n    # FFT along rows (axis=1) is for x, along columns (axis=0) is for y.\n    # So zonal modes (ky=0) are in the central *row*.\n    zonal_row_index = Ny // 2\n    zonal_energy = np.sum(np.abs(spectrum[zonal_row_index, :])**2)\n\n    # Compute and return the zonal energy fraction.\n    zonal_fraction = zonal_energy / total_energy\n    \n    # Return as a standard Python float, rounded to a reasonable precision for display.\n    # Using np.round to avoid potential minor floating point inaccuracies like 0.999...\n    return np.round(zonal_fraction, decimals=9)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # I made a mistake in the meshgrid indexing in the original python code. \n    # Let me re-verify. np.meshgrid(x, y) returns two arrays with shape (len(y), len(x)).\n    # So if x is for Nx and y is for Ny, the shape is (Ny, Nx).\n    # field = exp(1j * (kx*xx + ky*yy)). Here xx varies along columns, yy varies along rows.\n    # So fft2(field) will have ky varying along axis 0, and kx varying along axis 1.\n    # Zonal means ky=0. In the shifted spectrum, this is the central row.\n    # So spectrum[Ny//2, :] is correct.\n    # My original python code had a subtle bug with meshgrid.\n    # xx, yy = np.meshgrid(x, y) is the standard way, where xx.shape is (Ny, Nx)\n    # The kx term should multiply xx, and ky term should multiply yy. Correct.\n    # fft2(field) will have kx associated with axis=1, ky with axis=0. Correct.\n    # So zonal (ky=0) is indeed the central row spectrum[Ny//2, :]. Correct.\n    # The original code provided in the problem had yy,xx = np.meshgrid(y,x) then field = exp(1j * (k1[0] * xx + k1[1] * yy)).\n    # This is also correct. xx has shape (Nx, Ny) and varies along axis 1. yy has shape (Nx,Ny) and varies along axis 0.\n    # This means product_field has shape (Nx, Ny).\n    # Then fft2 is applied. ky is associated with axis 0. So central row is correct.\n    # The code seems fine. No need to change.\n    test_cases = [\n        # (Nx, Ny, k1, k2, de-alias_flag)\n        (64, 64, (10, 7), (-10, -7), False),\n        (64, 64, (10, 7), (-10, -7), True),\n        (64, 64, (22, 20), (22, -20), False),\n        (64, 64, (22, 20), (22, -20), True),\n        (48, 96, (16, 30), (-16, -30), True),\n        (48, 96, (20, 34), (-20, -34), True),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny, k1, k2, dealias = case\n        z_fraction = calculate_zonal_fraction(Nx, Ny, k1, k2, dealias)\n        results.append(z_fraction)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, [float(f) for f in results]))}]\")\n\nsolve()\n```"
        }
    ]
}