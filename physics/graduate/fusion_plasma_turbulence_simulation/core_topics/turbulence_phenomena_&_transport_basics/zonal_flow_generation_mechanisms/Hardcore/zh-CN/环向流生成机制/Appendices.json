{
    "hands_on_practices": [
        {
            "introduction": "在深入研究带状流的生成机制之前，我们首先需要一种稳健的方法来衡量其强度。本练习将介绍一种基于湍流能谱的定量诊断方法，要求学习者将带状流的物理定义（轴对称流）与其在波数空间中的标志（$k_y=0$ 模式）联系起来。通过完成这项实践 ，您将掌握从谱数据中提取带状流能量并评估其在系统中的重要性的核心技能。",
            "id": "4209523",
            "problem": "考虑磁化等离子体中的静电湍流，其主流动是电场叉磁场（E×B）漂移。在一个二维（$2$D）周期性区域的统计均匀状态下，设涨落的E×B速度场的单位质量动能由一个非负谱密度 $E(k_{x},k_{y})$ 表示，其中 $k_{x}$ 和 $k_{y}$ 分别是径向波数和极向波数。带状流被定义为流动的轴对称（$m=0$）极向分量，在谱空间上对应于 $k_{y}=0$ 的模。根据定义，带状流能谱是切片 $E_{\\mathrm{ZF}}(k_{x})=E(k_{x},0)$，总带状流能量通过对 $E_{\\mathrm{ZF}}$ 在 $k_{x}$ 上积分得到，而总湍流能量通过对 $E$ 在 $k_{x}$ 和 $k_{y}$ 上积分得到。基于这些定义，一个用于判断带状流主导地位的自然诊断量是以下比率\n$$\n\\mathcal{R}\\equiv \\frac{\\int_{-\\infty}^{\\infty}E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x}}{\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}}.\n$$\n从谱能量的定义和E×B流动的 Parseval 定理出发，论证使用 $k_{y}=0$ 作为带状流区域以及上述比率作为带状流中总能量分数的合理性。然后，假设一个复合的、各向异性的但可分离的模型谱，在 $k_{y}=0$ 附近有一个窄脊，用以表示叠加在更宽的漂移波背景上的相干带状流，\n$$\nE(k_{x},k_{y})=Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big),\n$$\n其中 $Z_{0}$、$A_{b}$、$k_{z}$、$k_{bx}$、$k_{by}$ 和 $\\varepsilon$ 均为严格正常数，且 $\\varepsilon$ 很小，以表示带状流在 $k_{y}=0$ 附近的谱集中性。仅使用基本谱定义和标准高斯积分公式，计算比率 $\\mathcal{R}$ 关于这些参数的精确闭合形式表达式。然后，根据应用于 $\\mathcal{R}$ 的用户指定阈值 $\\eta\\in(0,1)$，建立一个定量的带状流主导判据。你最终报告的结果必须是 $\\mathcal{R}$ 的精确解析表达式；不需要进行数值计算，最终结果中也不应包含单位。",
            "solution": "该问题被验证为科学上合理、提法恰当且客观。它提出了一个聚变等离子体湍流领域的标准（尽管简化了的）模型，并要求基于基本原理进行严格的推导和计算。\n\n首先，我们论证问题陈述中给出的定义的合理性。背景是一个磁化等离子体中静电湍流的二维（$2$D）模型。主导流动是 $\\mathbf{E}\\times\\mathbf{B}$ 漂移，由 $\\mathbf{v}_{E} = (\\mathbf{E} \\times \\mathbf{B}) / B^2$ 给出。在具有强而均匀磁场 $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$ 的平板几何中，电场 $\\mathbf{E}$ 从静电势 $\\phi(x, y, t)$ 导出，使得 $\\mathbf{E} = -\\nabla\\phi$。速度场分量为 $v_x = -(1/B_0)\\partial_y\\phi$ 和 $v_y = (1/B_0)\\partial_x\\phi$。单位质量动能为 $\\frac{1}{2}|\\mathbf{v}_E|^2 = \\frac{1}{2B_0^2}|\\nabla\\phi|^2$。\n\n空间域中的总湍流动能通过对此量在面积上积分得到。根据 Parseval 定理，这个实空间积分可以转换成傅里叶空间上的积分或求和。对于周期性区域，势可以表示为傅里叶级数 $\\phi(\\mathbf{x}) = \\sum_{\\mathbf{k}} \\hat{\\phi}_{\\mathbf{k}} \\exp(i\\mathbf{k}\\cdot\\mathbf{x})$，其中 $\\mathbf{k}=(k_x, k_y)$。Parseval 定理指出 $\\int |\\nabla\\phi|^2 d\\mathbf{x} \\propto \\sum_{\\mathbf{k}} |\\nabla\\phi|_{\\mathbf{k}}^2 = \\sum_{\\mathbf{k}} |i\\mathbf{k} \\hat{\\phi}_{\\mathbf{k}}|^2 = \\sum_{\\mathbf{k}} (k_x^2+k_y^2)|\\hat{\\phi}_{\\mathbf{k}}|^2$。在无限大区域的连续极限下，总能量由 $\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}$ 给出，其中 $E(k_x, k_y)$ 是能谱密度。$E(k_x, k_y)$ 与 $(k_x^2+k_y^2)|\\hat{\\phi}(k_x, k_y)|^2$ 成正比，表示波数为 $(k_x, k_y)$ 的模的能量贡献。\n\n带状流被定义为轴对称的，这在平板几何中对应于在极向（$y$）方向上均匀的流动。一个与 $y$ 无关的函数 $f(x, y)$，其关于 $y$ 的傅里叶变换仅在 $k_y=0$ 处非零。为使流场与 $y$ 无关，势 $\\phi$ 的结构必须使其傅里叶分量 $\\hat{\\phi}(k_x, k_y)$ 对于所有 $k_y \\neq 0$ 都为零。这些就是 $k_y=0$ 的模。物理上，如果 $\\phi=\\phi(x)$，则 $v_x = 0$ 且 $v_y = (1/B_0)d\\phi/dx$，这描述了一个径向剪切的极向流，即带状流的典型形式。因此，这些模所包含的能量集中在谱平面的 $k_y=0$ 轴上。因此，带状流能谱被正确定义为切片 $E_{\\mathrm{ZF}}(k_{x})=E(k_{x},0)$。带状流中的总能量是此切片在所有径向波数上的积分，$\\mathcal{E}_{\\mathrm{ZF}} = \\int_{-\\infty}^{\\infty}E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x}$。因此，比率 $\\mathcal{R} \\equiv \\mathcal{E}_{\\mathrm{ZF}}/\\mathcal{E}_{\\text{total}}$ 代表了存在于带状流结构中的总湍流动能的分数。\n\n接下来，我们计算给定模型谱的比率 $\\mathcal{R}$：\n$$\nE(k_{x},k_{y})=Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\n$$\n$\\mathcal{R}$ 的分子是总带状流能量 $\\mathcal{E}_{\\mathrm{ZF}}$。我们首先通过在全谱中设置 $k_y=0$ 来确定带状流谱 $E_{\\mathrm{ZF}}(k_x)$：\n$$\nE_{\\mathrm{ZF}}(k_{x}) = E(k_{x},0) = Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\exp(0)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\exp(0)\n$$\n$$\nE_{\\mathrm{ZF}}(k_{x}) = Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\n$$\n现在我们在 $k_x$ 上从 $-\\infty$ 到 $\\infty$ 进行积分。我们使用标准高斯积分公式 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$。\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = \\int_{-\\infty}^{\\infty} E_{\\mathrm{ZF}}(k_{x})\\,\\mathrm{d}k_{x} = \\int_{-\\infty}^{\\infty} \\left[ Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)+A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big) \\right] \\mathrm{d}k_{x}\n$$\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = Z_{0}\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{1}{k_{z}^{2}}k_{x}^{2}\\Big)\\,\\mathrm{d}k_{x} + A_{b}\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{1}{k_{bx}^{2}}k_{x}^{2}\\Big)\\,\\mathrm{d}k_{x}\n$$\n应用该公式，我们得到：\n$$\n\\mathcal{E}_{\\mathrm{ZF}} = Z_{0}\\sqrt{\\pi k_{z}^{2}} + A_{b}\\sqrt{\\pi k_{bx}^{2}} = Z_{0}k_{z}\\sqrt{\\pi} + A_{b}k_{bx}\\sqrt{\\pi} = \\sqrt{\\pi}(Z_{0}k_{z} + A_{b}k_{bx})\n$$\n$\\mathcal{R}$ 的分母是总湍流能量 $\\mathcal{E}_{\\text{total}}$，通过对 $E(k_x, k_y)$ 在 $k_x$ 和 $k_y$ 上积分得到。\n$$\n\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} E(k_{x},k_{y})\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\n$$\n由于给定的谱是两项可分离项的和，积分为：\n$$\n\\mathcal{E}_{\\text{total}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} Z_{0}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y} + \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} A_{b}\\,\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\,\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\\,\\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\n$$\n每个二重积分可以分解为两个单积分的乘积：\n$$\n\\mathcal{E}_{\\text{total}} = Z_{0}\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{z}^{2}}\\Big)\\mathrm{d}k_{x}\\right)\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{y}^{2}}{\\varepsilon^{2}}\\Big)\\mathrm{d}k_{y}\\right) + A_{b}\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{x}^{2}}{k_{bx}^{2}}\\Big)\\mathrm{d}k_{x}\\right)\\left(\\int_{-\\infty}^{\\infty}\\exp\\!\\Big(-\\frac{k_{y}^{2}}{k_{by}^{2}}\\Big)\\mathrm{d}k_{y}\\right)\n$$\n对每个部分应用高斯积分公式：\n$$\n\\mathcal{E}_{\\text{total}} = Z_{0}(k_{z}\\sqrt{\\pi})(\\varepsilon\\sqrt{\\pi}) + A_{b}(k_{bx}\\sqrt{\\pi})(k_{by}\\sqrt{\\pi})\n$$\n$$\n\\mathcal{E}_{\\text{total}} = \\pi Z_{0}k_{z}\\varepsilon + \\pi A_{b}k_{bx}k_{by} = \\pi(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})\n$$\n最后，我们计算比率 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{\\mathcal{E}_{\\mathrm{ZF}}}{\\mathcal{E}_{\\text{total}}} = \\frac{\\sqrt{\\pi}(Z_{0}k_{z} + A_{b}k_{bx})}{\\pi(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}\n$$\n通过约去 $\\sqrt{\\pi}$ 来简化表达式：\n$$\n\\mathcal{R} = \\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}\n$$\n这就是比率 $\\mathcal{R}$ 的最终精确解析表达式。\n\n最后，可以使用用户指定的阈值 $\\eta \\in (0,1)$ 来建立一个定量的带状流主导判据。由于 $\\mathcal{R}$ 代表带状流中的能量分数，如果该分数超过阈值 $\\eta$，则可以宣布进入带状流主导状态。因此，该判据表示为不等式：\n$$\n\\mathcal{R} > \\eta\n$$\n或者，代入推导出的 $\\mathcal{R}$ 表达式：\n$$\n\\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})} > \\eta\n$$\n这个不等式为系统被视为处于带状流主导状态提供了关于谱参数（$Z_{0}, A_{b}, k_{z}, k_{bx}, k_{by}, \\varepsilon$）的条件。",
            "answer": "$$\n\\boxed{\\frac{Z_{0}k_{z} + A_{b}k_{bx}}{\\sqrt{\\pi}(Z_{0}k_{z}\\varepsilon + A_{b}k_{bx}k_{by})}}\n$$"
        },
        {
            "introduction": "在学会如何量化带状流后，我们来探究其物理起源。本练习聚焦于核心的生成机制——雷诺胁强，即小尺度湍流如何驱动大尺度流动。通过推导并求解平均流的演化方程，您将亲手揭示湍流涨落如何系统性地将能量输运给带状流，使其得以在耗散背景下维持和增长 。",
            "id": "4209597",
            "problem": "考虑一个具有均匀磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ 的平板位形中的静电二维(2D)湍流。$\\mathbf{E} \\times \\mathbf{B}$ 速度为 $\\mathbf{v} = \\frac{c}{B} \\hat{\\mathbf{z}} \\times \\nabla \\phi$，其中 $\\phi(x,y,t)$ 是静电势，$c$ 是光速，$B$ 是磁场的大小。带状流定义为 $\\mathbf{v}$ 的极向分量的磁通面平均，即 $U(x,t) \\equiv \\langle v_{y} \\rangle_{y}$，其中 $\\langle \\cdot \\rangle_{y}$ 表示对极向坐标 $y$ 的平均。\n\n从不可压缩离子流体的动量守恒和 Reynolds 平均（将 $\\mathbf{v}$ 分解为 $\\mathbf{v} = \\mathbf{U} + \\mathbf{v}'$，其中 $\\mathbf{U} = U(x,t)\\hat{\\mathbf{y}}$ 且 $\\langle \\mathbf{v}' \\rangle_{y} = \\mathbf{0}$）出发，并包含作用于平均流的碰撞粘性（建模为运动粘度 $\\nu_{c}$）。使用这些要素推导平均流演化方程，该方程包含作为驱动项的 Reynolds 应力 $R(x,t) \\equiv \\langle v_{x} v_{y} \\rangle_{y}$ 的散度和作为耗散项的 $U(x,t)$ 的粘性扩散。然后，在给定不依赖于时间的 Reynolds 应力剖面\n$$\nR(x) = R_{0} \\sin(k x),\n$$\n（其中 $R_{0} > 0$ 和 $k > 0$ 为常数）的假设下，计算稳态带状流振幅，其定义为\n$$\nU_{\\mathrm{amp}} \\equiv \\max_{x} |U(x)|,\n$$\n该计算需满足 $x$ 方向周期为 $2\\pi/k$ 的周期性边界条件以及约束条件 $\\langle U \\rangle_{x} = 0$。请仅用 $R_{0}$、$\\nu_{c}$ 和 $k$ 将最终答案表示为闭合形式的解析表达式。\n\n尽管您将提供一个解析表达式，但该振幅代表一个速度，如果进行数值计算，将以米/秒为单位。请勿代入数值，也勿进行取整；仅提供 $U_{\\mathrm{amp}}$ 的解析表达式。",
            "solution": "首先验证该问题具有科学依据、是适定的、客观且完整的。该问题描述了等离子体湍流理论中的一个典型问题——由 Reynolds 应力产生带状流——这是一个标准且成熟的课题。所有必要的物理参数、函数形式和边界条件均已提供，足以推导出唯一的、有意义的解。该问题基于应用于简化等离子体模型的流体动力学和动量守恒的基本原理。所用术语是标准的，其设定在物理上和数学上都是自洽的。因此，我们开始求解。\n\n第一步是推导平均极向流（即带状流）$U(x,t) \\equiv \\langle v_{y} \\rangle_{y}$ 的演化方程。我们从二维（$x$，$y$）不可压缩流体的动量守恒方程出发。利用不可压缩条件 $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} = 0$，速度 $y$ 分量 $v_y$ 的方程可以写成守恒形式：\n$$\n\\frac{\\partial v_y}{\\partial t} + \\frac{\\partial}{\\partial x}(v_x v_y) + \\frac{\\partial}{\\partial y}(v_y^2) = \\mathcal{F}_y\n$$\n其中 $\\mathcal{F}_y$ 是作用在流体上的单位质量力的 $y$ 分量。问题指明，这个力是由作用于平均流 $U(x,t)$ 的碰撞粘性引起的。平均流定义为 $\\mathbf{U}(x,t) = U(x,t)\\hat{\\mathbf{y}}$。因此，粘性力为 $\\nu_c \\nabla^2 \\mathbf{U} = \\nu_c \\nabla^2 (U(x,t)\\hat{\\mathbf{y}})$。由于 $U$ 只依赖于 $x$，该式简化为 $\\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\hat{\\mathbf{y}}$。因此，力的分量是 $\\mathcal{F}_y = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$。\n\n现在我们应用 Reynolds 平均，即对动量方程关于极向坐标 $y$ 取平均，记为 $\\langle \\cdot \\rangle_y$。\n$$\n\\left\\langle \\frac{\\partial v_y}{\\partial t} \\right\\rangle_y + \\left\\langle \\frac{\\partial}{\\partial x}(v_x v_y) \\right\\rangle_y + \\left\\langle \\frac{\\partial}{\\partial y}(v_y^2) \\right\\rangle_y = \\left\\langle \\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\right\\rangle_y\n$$\n我们逐项分析。根据 $U(x,t)$ 的定义，第一项变为 $\\frac{\\partial}{\\partial t}\\langle v_y \\rangle_y = \\frac{\\partial U}{\\partial t}$。根据 Reynolds 应力 $R(x,t)$ 的定义，第二项变为 $\\frac{\\partial}{\\partial x}\\langle v_x v_y \\rangle_y = \\frac{\\partial R}{\\partial x}$。第三项，假设在 $y$ 方向上具有周期性边界条件（如“极向坐标”一词所暗示的），则为零：$\\langle \\frac{\\partial}{\\partial y}(v_y^2) \\rangle_y = \\frac{1}{L_y} \\int_0^{L_y} \\frac{\\partial}{\\partial y}(v_y^2) dy = \\frac{1}{L_y}[v_y^2]_{0}^{L_y} = 0$。等式右边的项已经只是 $x$ 和 $t$ 的函数，所以取平均不会改变它：$\\langle \\nu_c \\frac{\\partial^2 U}{\\partial x^2} \\rangle_y = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$。\n综合这些项，我们得到平均流演化方程：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial R}{\\partial x} = \\nu_c \\frac{\\partial^2 U}{\\partial x^2}\n$$\n这可以写成 $\\frac{\\partial U}{\\partial t} = -\\frac{\\partial R}{\\partial x} + \\nu_c \\frac{\\partial^2 U}{\\partial x^2}$，这表明带状流由 Reynolds 应力的散度驱动（具体来说，驱动力为 $-\\frac{\\partial R}{\\partial x}$），并被粘性扩散所阻尼。\n\n问题的第二部分要求解出稳态解。在稳态下，$\\frac{\\partial U}{\\partial t} = 0$。给定不依赖于时间的 Reynolds 应力剖面 $R(x) = R_{0} \\sin(k x)$。演化方程变为关于 $U(x)$ 的常微分方程(ODE)：\n$$\n-\\frac{d R}{d x} + \\nu_c \\frac{d^2 U}{d x^2} = 0\n$$\n代入 $R(x)$ 的表达式：\n$$\n\\nu_c \\frac{d^2 U}{d x^2} = \\frac{d}{dx} \\left(R_{0} \\sin(k x)\\right) = k R_{0} \\cos(k x)\n$$\n我们对这个常微分方程关于 $x$ 积分两次。第一次积分得到：\n$$\n\\nu_c \\frac{dU}{dx} = \\int k R_{0} \\cos(k x) \\, dx = R_{0} \\sin(k x) + C_1\n$$\n其中 $C_1$ 是第一个积分常数。再次积分：\n$$\n\\nu_c U(x) = \\int \\left(R_{0} \\sin(k x) + C_1\\right) \\, dx = -\\frac{R_{0}}{k} \\cos(k x) + C_1 x + C_2\n$$\n其中 $C_2$ 是第二个积分常数。$U(x)$ 的解为：\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_1}{\\nu_c} x + \\frac{C_2}{\\nu_c}\n$$\n现在我们应用边界条件和约束条件来确定 $C_1$ 和 $C_2$。解在 $x$ 方向上必须是周期的，周期为 $2\\pi/k$。项 $\\frac{C_1}{\\nu_c} x$ 是久期项，会破坏周期性，除非 $C_1=0$。因此，周期性条件 $U(x) = U(x+2\\pi/k)$ 意味着 $C_1=0$。解简化为：\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_2}{\\nu_c}\n$$\n接下来，我们应用平均流为零的约束条件 $\\langle U \\rangle_x = 0$，其中平均是在 $x$ 方向的一个周期内进行的：\n$$\n\\langle U \\rangle_x = \\frac{k}{2\\pi} \\int_{0}^{2\\pi/k} \\left( -\\frac{R_{0}}{k \\nu_c} \\cos(k x) + \\frac{C_2}{\\nu_c} \\right) dx = 0\n$$\n$\\cos(k x)$ 在一个完整周期上的积分为零。常数项的积分为 $\\frac{C_2}{\\nu_c} \\times \\frac{2\\pi}{k}$。因此，平均值为：\n$$\n\\frac{k}{2\\pi} \\left( 0 + \\frac{C_2}{\\nu_c} \\frac{2\\pi}{k} \\right) = \\frac{C_2}{\\nu_c}\n$$\n约束条件 $\\langle U \\rangle_x = 0$ 导致 $\\frac{C_2}{\\nu_c} = 0$，这意味着 $C_2=0$。\n因此，带状流剖面的唯一稳态解是：\n$$\nU(x) = -\\frac{R_{0}}{k \\nu_c} \\cos(k x)\n$$\n问题要求计算带状流振幅，其定义为 $U_{\\mathrm{amp}} \\equiv \\max_{x} |U(x)|$。\n$$\nU_{\\mathrm{amp}} = \\max_{x} \\left| -\\frac{R_{0}}{k \\nu_c} \\cos(k x) \\right|\n$$\n已知 $R_{0} > 0$，$k > 0$，且运动粘度 $\\nu_c$ 是一个正的物理常数，我们有：\n$$\nU_{\\mathrm{amp}} = \\frac{R_{0}}{k \\nu_c} \\max_{x} | \\cos(k x) |\n$$\n$|\\cos(k x)|$ 的最大值为 $1$。因此，稳态带状流的振幅为：\n$$\nU_{\\mathrm{amp}} = \\frac{R_{0}}{k \\nu_c}\n$$\n这个表达式只依赖于给定的参数 $R_{0}$、$\\nu_c$ 和 $k$。",
            "answer": "$$\n\\boxed{\\frac{R_{0}}{k \\nu_{c}}}\n$$"
        },
        {
            "introduction": "将物理理论转化为可靠的计算机模拟，必须处理数值伪影。本计算练习直面伪谱方法中的一个核心挑战：混叠误差。您将通过编程实践，分析反混叠技术如何影响驱动带状流的三波相互作用，并判断数值方案是否会人为地抑制或虚假地增强带状流的生成 。",
            "id": "4209554",
            "problem": "考虑一个在均匀网格上离散化的二维周期性域，其在 $x$ 方向有 $N_x$ 个点，在 $y$ 方向有 $N_y$ 个点。设 $k_x$ 和 $k_y$ 分别表示沿 $x$ 和 $y$ 方向的离散波数指数，其取值在主值范围 $-N_x/2 \\le k_x \\le N_x/2-1$ 和 $-N_y/2 \\le k_y \\le N_y/2-1$ 内的整数。纬向流模式（zonal flow mode）定义为任何具有 $k_y = 0$ 的谱分量。在伪谱方法中，二次非线性项对应于三波相互作用，在连续谱中强制满足 $k_3 = k_1 + k_2$，其中每个 $k_i$ 是一个二维整数向量。在离散网格上，卷积通过物理空间中的乘法和变换回谱空间来计算。由于离散采样，真实的和 $k_{\\mathrm{true}} = k_1 + k_2$ 会混叠到一个指数 $k_{\\mathrm{alias}} = k_{\\mathrm{true}} - s_x N_x \\,\\hat{\\mathbf{x}} - s_y N_y \\,\\hat{\\mathbf{y}}$，其中 $s_x$ 和 $s_y$ 是选择的整数，以使 $k_{\\mathrm{alias}}$ 的每个分量都落在主值范围内。混叠可能会在低波数处产生伪能量，包括在 $k_y = 0$ 的频带中。\n\n对于二次非线性项，一个常见的谱反混叠策略是 $2/3$ 法则，该法则截断谱，使得在物理空间中计算乘积之前，只保留波数满足 $|\\lvert k_x \\rvert \\le \\lfloor N_x/3 \\rfloor$ 和 $\\lvert k_y \\rvert \\le \\lfloor N_y/3 \\rfloor$ 的分量。这样，由两个保留的波矢量相加产生的任何混叠都会映射到保留集合之外。在磁化等离子体的湍流模拟中，产生 $k_y = 0$ 模式的三波相互作用是纬向流生成的原因。过于激进或不正确的反混叠可能会抑制合法的 $k_y = 0$ 生成，而缺乏反混叠则可能用伪混叠能量污染 $k_y = 0$ 频带。\n\n从卷积定理和离散周期性网格上的混叠定义出发，推导原则性判据，以说明在何种条件下 $2/3$ 法则能够保留产生 $k_y = 0$ 的合法三波相互作用，并消除对 $k_y = 0$ 的伪混叠贡献。然后，实现一个程序，该程序构建两个具有指定波矢量的平面波场，在物理空间中将它们相乘，变换到谱空间，并测量位于纬向频带 $k_y = 0$ 中的总谱能量的分数。将纬向能量分数定义为\n$$\n\\mathcal{Z} = \n\\begin{cases}\n\\frac{\\sum_{k_x} \\lvert \\hat{f}(k_x, 0)\\rvert^2}{\\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2},  \\text{若 } \\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2 > 0, \\\\\n0,  \\text{其他情况},\n\\end{cases}\n$$\n其中 $\\hat{f}(k_x, k_y)$ 是乘积场的离散傅里叶变换。当启用反混叠时，通过在乘法之前将任何满足 $\\lvert k_x \\rvert > \\lfloor N_x/3 \\rfloor$ 或 $\\lvert k_y \\rvert > \\lfloor N_y/3 \\rfloor$ 的输入平面波设置为零，来强制执行 $2/3$ 截断。\n\n您的程序必须为以下测试套件计算 $\\mathcal{Z}$。对于每个案例，序对 $(k_1, k_2)$ 表示输入波矢量，反混叠标志指示是否对输入应用 $2/3$ 法则：\n\n- 案例 1：$N_x = 64$，$N_y = 64$，$k_1 = (10, 7)$，$k_2 = (-10, -7)$，反混叠标志 $=$ $\\mathrm{False}$。\n- 案例 2：$N_x = 64$，$N_y = 64$，$k_1 = (10, 7)$，$k_2 = (-10, -7)$，反混叠标志 $=$ $\\mathrm{True}$。\n- 案例 3：$N_x = 64$，$N_y = 64$，$k_1 = (22, 20)$，$k_2 = (22, -20)$，反混叠标志 $=$ $\\mathrm{False}$。\n- 案例 4：$N_x = 64$，$N_y = 64$，$k_1 = (22, 20)$，$k_2 = (22, -20)$，反混叠标志 $=$ $\\mathrm{True}$。\n- 案例 5：$N_x = 48$，$N_y = 96$，$k_1 = (16, 30)$，$k_2 = (-16, -30)$，反混叠标志 $=$ $\\mathrm{True}$。\n- 案例 6：$N_x = 48$，$N_y = 96$，$k_1 = (20, 34)$，$k_2 = (-20, -34)$，反混叠标志 $=$ $\\mathrm{True}$。\n\n此问题中的所有量都是无量纲的；没有物理单位。您的程序应生成一行输出，其中包含上述案例的六个纬向能量分数 $\\mathcal{Z}$，形式为一个用方括号括起来的逗号分隔列表，并按所列顺序排列（例如，$[\\mathcal{Z}_1,\\mathcal{Z}_2,\\mathcal{Z}_3,\\mathcal{Z}_4,\\mathcal{Z}_5,\\mathcal{Z}_6]$）。",
            "solution": "该问题要求在二维伪谱模拟中，结合纬向流生成的背景，对 $2/3$ 反混叠法则进行分析，并通过数值实现来验证推导出的原理。\n\n### 问题有效性验证\n\n所提供的问题陈述是**有效**的。它在科学上基于伪谱方法、傅里叶分析和湍流理论的既定原理。混叠、卷积定理和 $2/3$ 反混叠法则是计算物理学中的标准概念。该问题是适定的，提供了所有必要的参数（$N_x$、$N_y$、波矢量 $\\mathbf{k}_{1}$ 和 $\\mathbf{k}_{2}$、反混叠标志），并对要计算的量——纬向能量分数 $\\mathcal{Z}$——给出了清晰、客观的定义。测试用例定义明确，旨在探究混叠与反混叠相互作用的不同方面。问题不包含任何科学谬误、模糊不清或矛盾之处。\n\n### 判据的理论推导\n\n让我们考虑在大小为 $N_x \\times N_y$ 的均匀网格上离散化的二维周期性域 $\\mathbf{x} = (x, y)$ 上的两个标量场 $f_1(\\mathbf{x})$ 和 $f_2(\\mathbf{x})$。它们的乘积是 $f(\\mathbf{x}) = f_1(\\mathbf{x}) f_2(\\mathbf{x})$。根据离散傅里叶变换（DFT）的卷积定理，乘积场的谱 $\\hat{f}(\\mathbf{k})$ 是各个谱 $\\hat{f}_1(\\mathbf{k})$ 和 $\\hat{f}_2(\\mathbf{k})$ 的循环卷积：\n$$\n\\hat{f}(\\mathbf{k}) = \\sum_{\\mathbf{k}'} \\hat{f}_1(\\mathbf{k}') \\hat{f}_2(\\mathbf{k} - \\mathbf{k}')\n$$\n其中波矢量指数 $\\mathbf{k} = (k_x, k_y)$ 是在主值范围 $-N_x/2 \\le k_x \\le N_x/2-1$ 和 $-N_y/2 \\le k_y \\le N_y/2-1$ 内的整数。波矢量的和与差是隐式地对 $(N_x, N_y)$ 取模进行的。\n\n在此问题中，输入场是单个平面波，这意味着它们的谱是 Kronecker δ 函数。设 $f_1(\\mathbf{x})$ 对应波矢量 $\\mathbf{k}_1$，$f_2(\\mathbf{x})$ 对应 $\\mathbf{k}_2$。它们的谱为 $\\hat{f}_1(\\mathbf{k}) \\propto \\delta(\\mathbf{k} - \\mathbf{k}_1)$ 和 $\\hat{f}_2(\\mathbf{k}) \\propto \\delta(\\mathbf{k} - \\mathbf{k}_2)$。物理空间中的乘积 $f_1(\\mathbf{x}) f_2(\\mathbf{x})$ 是一个新的平面波，其波矢量为 $\\mathbf{k}_{\\text{true}} = \\mathbf{k}_1 + \\mathbf{k}_2$。在离散网格上，这个结果波矢量被混叠到主值范围内。混叠后的波矢量 $\\mathbf{k}_{\\text{alias}}$ 由下式给出：\n$$\n\\mathbf{k}_{\\text{alias}} = \\mathbf{k}_{\\text{true}} - s_x N_x \\hat{\\mathbf{x}} - s_y N_y \\hat{\\mathbf{y}}\n$$\n其中选择整数 $s_x$ 和 $s_y$，使得 $\\mathbf{k}_{\\text{alias}}$ 的分量落在主值范围内。乘积场的谱将在 $\\mathbf{k}_{\\text{alias}}$ 处有一个唯一的非零分量。\n\n纬向流模式由条件 $k_y = 0$ 定义。\n- **合法的纬向流生成**发生在波矢量的真实和导致一个 $y$ 分量为零的模式时，即 $k_{1y} + k_{2y} = 0$。\n- **伪（混叠）纬向流生成**发生在 $k_{1y} + k_{2y} \\neq 0$，但混叠将结果模式映射到一个 $y$ 分量为零的模式时。这种情况发生在 $k_{1y} + k_{2y} = s_y N_y$ 且 $s_y$ 为某个非零整数时。\n\n$2/3$ 反混叠法则截断谱，只保留满足 $|k_x| \\le K_x = \\lfloor N_x/3 \\rfloor$ 和 $|k_y| \\le K_y = \\lfloor N_y/3 \\rfloor$ 的模式。\n\n**判据1：保留合法的纬向流生成**\n一个合法的纬向流生成相互作用（其中 $k_{1y} + k_{2y} = 0$），当且仅当输入波矢量 $\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 本身被该法则保留时，才能被正确计算和保留。这要求：\n$$\n|k_{1x}| \\le \\lfloor N_x/3 \\rfloor \\quad \\text{且} \\quad |k_{1y}| \\le \\lfloor N_y/3 \\rfloor\n$$\n$$\n|k_{2x}| \\le \\lfloor N_x/3 \\rfloor \\quad \\text{且} \\quad |k_{2y}| \\le \\lfloor N_y/3 \\rfloor\n$$\n如果任一输入波矢量位于此保留区域之外，反混叠方案的实现会将相应场设置为零，从而完全抑制该相互作用。\n\n**判据2：消除伪纬向流生成**\n$2/3$ 法则保证消除了所有由任意两个保留模式之间的二次相互作用产生的对 $k_y=0$ 频带的伪贡献。这可以证明如下：\n1.  设 $\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 是保留区域内的两个波矢量。根据 $2/3$ 法则的定义，这意味着 $|k_{1y}| \\le K_y = \\lfloor N_y/3 \\rfloor$ 和 $|k_{2y}| \\le K_y = \\lfloor N_y/3 \\rfloor$。\n2.  这些波矢量的真实和的 $y$ 分量是 $k_{\\text{true},y} = k_{1y} + k_{2y}$。\n3.  使用三角不等式，我们可以限制这个和的大小：$|k_{\\text{true},y}| = |k_{1y} + k_{2y}| \\le |k_{1y}| + |k_{2y}| \\le K_y + K_y = 2K_y$。\n4.  因为 $K_y = \\lfloor N_y/3 \\rfloor \\le N_y/3$，我们有 $|k_{\\text{true},y}| \\le 2(N_y/3)$。对于任何 $N_y \\ge 1$，都有 $2N_y/3  < N_y$。\n5.  伪纬向贡献要求 $k_{\\text{true},y}$ 是 $N_y$ 的非零整数倍，即 $k_{\\text{true},y} = s_y N_y$ 且 $s_y \\in \\{\\pm 1, \\pm 2, \\dots\\}$。\n6.  然而，从第4步可知，我们有 $|k_{\\text{true},y}|  < N_y$。这使得 $k_{\\text{true},y}$ 不可能等于 $N_y$ 的任何非零整数倍。\n7.  因此，混叠后的 $y$ 波数 $k_{\\text{alias},y}$ 要为 $0$，唯一的方法是真实和 $k_{\\text{true},y}$ 本身为 $0$。这是合法而非伪纬向流生成的条件。\n这证明了 $2/3$ 法则在消除从谱的保留部分内的相互作用混叠到纬向流频带的伪能量方面是有效的。\n\n### 算法设计与测试用例分析\n\n程序将为每个测试用例实现以下步骤：\n1.  接收网格维度（$N_x, N_y$）、输入波矢量（$\\mathbf{k}_1, \\mathbf{k}_2$）和反混叠标志。\n2.  如果启用反混叠，检查 $\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 是否满足 $2/3$ 法则。如果一个波矢量超出限制（$\\lvert k_x \\rvert > \\lfloor N_x/3 \\rfloor$ 或 $\\lvert k_y \\rvert > \\lfloor N_y/3 \\rfloor$），其对应的场将被视为零。\n3.  在物理空间中构建两个输入场。对于波矢量 $\\mathbf{k}=(k_x, k_y)$，其场为 $f(\\mathbf{x}) = \\exp(i(k_x x + k_y y))$，其中网格 $x \\in [0, 2\\pi)$ 和 $y \\in [0, 2\\pi)$。如果一个输入因反混叠而被截断，其场是一个零数组。\n4.  将两个物理空间场相乘以获得乘积场 $f(\\mathbf{x})$。\n5.  计算 $f(\\mathbf{x})$ 的二维 DFT 以得到 $\\hat{f}(\\mathbf{k})$，并平移结果以使零频分量居中。\n6.  计算总谱能量 $E_{\\text{total}} = \\sum_{k_x,k_y} \\lvert \\hat{f}(k_x, k_y)\\rvert^2$。\n7.  计算纬向能量 $E_{\\text{zonal}} = \\sum_{k_x} \\lvert \\hat{f}(k_x, 0)\\rvert^2$。$k_y=0$ 模式对应于平移后的二维谱数组的中心行。\n8.  计算纬向能量分数 $\\mathcal{Z} = E_{\\text{zonal}} / E_{\\text{total}}$，并通过将 $\\mathcal{Z}$ 设为 $0$ 来处理 $E_{\\text{total}} = 0$ 的情况。\n\n**测试用例分析：**\n- **案例 1 & 2：** ($N_x=64, N_y=64, \\mathbf{k}_1=(10, 7), \\mathbf{k}_2=(-10, -7)$)。这是一个合法的纬向相互作用，因为 $\\mathbf{k}_1+\\mathbf{k}_2 = (0,0)$。$2/3$ 法则的限制是 $K_x=K_y=\\lfloor 64/3 \\rfloor=21$。$\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 都在这些限制之内。因此，无论是否进行反混叠，该相互作用都会被保留。结果场是一个常数，其全部谱能量都在 $\\mathbf{k}=(0,0)$ 处。对于这两种情况，$\\mathcal{Z} = 1.0$。\n- **案例 3 & 4：** ($N_x=64, N_y=64, \\mathbf{k}_1=(22, 20), \\mathbf{k}_2=(22, -20)$)。这是一个合法的纬向相互作用，其 $\\mathbf{k}_{\\text{true}} = (44,0)$。在离散网格上，这会混叠到 $\\mathbf{k}_{\\text{alias}} = (44-64, 0) = (-20, 0)$，这是一个纬向模式。\n    - 案例 3 (de-alias=False)：相互作用正常进行，仅在 $\\mathbf{k}=(-20, 0)$ 处产生谱能量。因此，$\\mathcal{Z} = 1.0$。\n    - 案例 4 (de-alias=True)：$2/3$ 法则的限制是 $K_x=21$。两个输入模式的 $|k_x|=22 > 21$，因此它们被截断。乘积场为零，总能量为零，$\\mathcal{Z} = 0$。这演示了涉及高波数模式的合法相互作用被抑制的情况。\n- **案例 5：** ($N_x=48, N_y=96, \\mathbf{k}_1=(16, 30), \\mathbf{k}_2=(-16, -30)$, de-alias=True)。合法的相互作用，$\\mathbf{k}_1+\\mathbf{k}_2=(0,0)$。限制是 $K_x=\\lfloor 48/3 \\rfloor = 16$ 和 $K_y=\\lfloor 96/3 \\rfloor = 32$。两个输入模式都满足条件（$|16|\\le16$，$|30|\\le32$）。相互作用被保留。我们期望 $\\mathcal{Z}=1.0$。\n- **案例 6：** ($N_x=48, N_y=96, \\mathbf{k}_1=(20, 34), \\mathbf{k}_2=(-20, -34)$, de-alias=True)。合法的相互作用，$\\mathbf{k}_1+\\mathbf{k}_2=(0,0)$。限制是 $K_x=16$，$K_y=32$。输入模式违反了限制，因为 $|20|>16$ 和 $|34|>32$。两个输入场都被截断为零。结果乘积为零，因此 $\\mathcal{Z}=0$。\n预期输出为 $[1.0, 1.0, 1.0, 0.0, 1.0, 0.0]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_zonal_fraction(Nx, Ny, k1, k2, dealias):\n    \"\"\"\n    Computes the zonal energy fraction for the product of two plane waves.\n\n    Args:\n        Nx (int): Number of grid points in the x direction.\n        Ny (int): Number of grid points in the y direction.\n        k1 (tuple): Wavevector (kx, ky) for the first plane wave.\n        k2 (tuple): Wavevector (kx, ky) for the second plane wave.\n        dealias (bool): If True, apply the 2/3 de-aliasing rule to inputs.\n\n    Returns:\n        float: The zonal energy fraction Z.\n    \"\"\"\n    amp1 = 1.0\n    amp2 = 1.0\n\n    if dealias:\n        Kx = Nx // 3\n        Ky = Ny // 3\n        if abs(k1[0]) > Kx or abs(k1[1]) > Ky:\n            amp1 = 0.0\n        if abs(k2[0]) > Kx or abs(k2[1]) > Ky:\n            amp2 = 0.0\n\n    # If either amplitude is zero due to truncation, the product is zero.\n    if amp1 == 0.0 or amp2 == 0.0:\n        return 0.0\n\n    # Create coordinate grid. Using endpoint=False for periodic domain.\n    # Meshgrid indexing is 'xy' by default, which is what we need.\n    x = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    y = np.linspace(0, 2 * np.pi, Ny, endpoint=False)\n    xx, yy = np.meshgrid(x, y)\n    \n    # Construct the two plane wave fields in physical space.\n    field1 = np.exp(1j * (k1[0] * xx + k1[1] * yy))\n    field2 = np.exp(1j * (k2[0] * xx + k2[1] * yy))\n    \n    # Compute the product in physical space.\n    product_field = field1 * field2\n\n    # Transform to spectral space via 2D FFT.\n    # The result is shifted so that the k=(0,0) component is at the center.\n    spectrum = np.fft.fftshift(np.fft.fft2(product_field))\n\n    # Calculate total spectral energy (proportional to sum of squares of amplitudes).\n    # Using np.abs()**2 gives the squared magnitude |z|^2.\n    total_energy = np.sum(np.abs(spectrum)**2)\n\n    if total_energy  1e-9: # Use a small tolerance for floating point zero.\n        return 0.0\n\n    # The zonal modes (ky=0) correspond to the central row in the shifted spectrum.\n    # For an even Ny, the ky=0 wave number is at index Ny // 2.\n    # For example, if Ny=64, indices are 0..63. Shifted indices are -32..31.\n    # The ky=0 mode is at index 32 of the original FFT output, which becomes\n    # the central row after fftshift.\n    zonal_row_index = Ny // 2\n    zonal_energy = np.sum(np.abs(spectrum[zonal_row_index, :])**2)\n\n    # Compute the zonal energy fraction.\n    zonal_fraction = zonal_energy / total_energy\n    \n    # Return as a standard Python float, rounded to a reasonable precision \n    # to avoid potential minor floating point inaccuracies like 0.999...\n    return np.round(zonal_fraction, decimals=9)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, Ny, k1, k2, de-alias_flag)\n        (64, 64, (10, 7), (-10, -7), False),\n        (64, 64, (10, 7), (-10, -7), True),\n        (64, 64, (22, 20), (22, -20), False),\n        (64, 64, (22, 20), (22, -20), True),\n        (48, 96, (16, 30), (-16, -30), True),\n        (48, 96, (20, 34), (-20, -34), True),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny, k1, k2, dealias = case\n        z_fraction = calculate_zonal_fraction(Nx, Ny, k1, k2, dealias)\n        # Ensure the output is 1.0 or 0.0 as expected from theory\n        # and to match the required output format (no trailing .0)\n        if z_fraction > 0.5:\n             results.append(\"1.0\")\n        else:\n             results.append(\"0.0\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}