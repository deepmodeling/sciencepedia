{
    "hands_on_practices": [
        {
            "introduction": "回旋动理学是描述磁化等离子体中低频湍流的基石，其有效性依赖于一系列尺度分离的假设，即回旋动理学级数。本练习旨在通过一个实际的托卡马克核心等离子体场景，将这些抽象的级数关系与具体的物理量联系起来。通过计算典型的托卡马克参数下的基本无量纲比率，您将亲手验证回旋动理学近似的自洽性，从而巩固对该理论物理基础的理解。",
            "id": "4191352",
            "problem": "一个托卡马克芯部使用标准的单调指数剖面，为一个带有子网格尺度 (SGS) 建模的陀螺动理学大涡模拟 (LES) 进行建模。假设芯部为轴对称平衡，且磁场强度均匀。装置参数如下：磁场 $B_{0} = 3.0~\\text{T}$，大半径 $R_{0} = 3.0~\\text{m}$，小半径 $a = 1.0~\\text{m}$。离子种类为氘，其质量 $m_{i} = 2 m_{p}$，其中质子质量为 $m_{p} = 1.67262192369 \\times 10^{-27}~\\text{kg}$，元电荷为 $e = 1.602176634 \\times 10^{-19}~\\text{C}$。芯部粒子密度和离子温度剖面为\n$$\nn(r) = n_{0} \\exp\\!\\left(-\\frac{r}{L_{n}}\\right), \\quad T_{i}(r) = T_{0} \\exp\\!\\left(-\\frac{r}{L_{T}}\\right),\n$$\n其中 $n_{0} = 8.0 \\times 10^{19}~\\text{m}^{-3}$，$T_{0} = 6.0~\\text{keV}$，$L_{n} = 0.40~\\text{m}$，$L_{T} = 0.30~\\text{m}$。考虑中间半径位置 $r = a/2$。\n\nLES 滤波宽度为 $\\Delta = 0.030~\\text{m}$，用于表征主导涡的解析副法向波数为 $k_{y} = \\frac{1}{2} \\frac{\\pi}{\\Delta}$。\n\n使用以下经过充分检验的定义：\n- 离子热速度 $v_{\\text{thi}} = \\sqrt{\\frac{2 T_{i}}{m_{i}}}$，\n- 离子回旋频率 $\\Omega_{i} = \\frac{e B_{0}}{m_{i}}$，\n- 离子回旋半径 $\\rho_{i} = \\frac{v_{\\text{thi}}}{\\Omega_{i}}$，\n- 宏观梯度尺度 $L = \\min(L_{n}, L_{T})$，\n- 板近似下的离子抗磁漂移频率 $\\omega_{*i} = k_{y} \\frac{T_{i}}{e B_{0} L_{n}}$，\n- 热磁曲率漂移频率大小 $\\omega_{di} \\approx k_{y} \\frac{v_{\\text{thi}}^{2}}{2 \\Omega_{i} R_{0}}$，\n\n在 $r = a/2$ 处，计算以下三个小参数比值\n$$\n\\epsilon_{1} = \\frac{\\rho_{i}}{L}, \\quad \\epsilon_{2} = \\frac{\\omega_{*i}}{\\Omega_{i}}, \\quad \\epsilon_{3} = \\frac{\\omega_{di}}{\\Omega_{i}}\n$$\n然后，计算 $\\epsilon_{1}$、$\\epsilon_{2}$ 和 $\\epsilon_{3}$ 中的最大值，结果表示为单个实数。将最终答案表示为无量纲量，并四舍五入到三位有效数字。",
            "solution": "目标是在托卡马克芯部的指定位置，计算三个无量纲比值 $\\epsilon_{1}$、$\\epsilon_{2}$ 和 $\\epsilon_{3}$（它们是陀螺动理学理论中的基本级数展开参数），然后找出这三个值中的最大值。\n\n分析将在中间半径位置 $r = a/2$ 处进行。由于小半径 $a = 1.0~\\text{m}$，所研究的位置是 $r = 0.5~\\text{m}$。\n\n首先，我们必须确定该半径处的局域离子温度 $T_{i}$。温度剖面由 $T_{i}(r) = T_{0} \\exp(-r/L_{T})$ 给出，其中 $T_{0} = 6.0~\\text{keV}$，$L_{T} = 0.30~\\text{m}$。在 $r=0.5~\\text{m}$ 处，温度为：\n$$\nT_{i}(r=0.5~\\text{m}) = (6.0~\\text{keV}) \\exp\\left(-\\frac{0.5~\\text{m}}{0.30~\\text{m}}\\right) = (6.0~\\text{keV}) \\exp\\left(-\\frac{5}{3}\\right)\n$$\n为与国际单位制 (SI) 保持一致，我们必须将温度从千电子伏特 ($keV$) 转换为焦耳 ($J$)。使用元电荷 $e = 1.602176634 \\times 10^{-19}~\\text{C}$，转换关系为 $1~\\text{eV} = 1.602176634 \\times 10^{-19}~\\text{J}$。\n$$\nT_{i} = 6.0 \\times 10^{3} \\exp\\left(-\\frac{5}{3}\\right) \\times (1.602176634 \\times 10^{-19})~\\text{J} \\approx 1.81560 \\times 10^{-16}~\\text{J}.\n$$\n\n接下来，我们计算这些比值所需的物理量。\n氘的离子质量为 $m_{i} = 2 m_{p}$，其中 $m_{p} = 1.67262192369 \\times 10^{-27}~\\text{kg}$。\n$$\nm_{i} = 2 \\times (1.67262192369 \\times 10^{-27}~\\text{kg}) = 3.34524384738 \\times 10^{-27}~\\text{kg}.\n$$\n离子回旋半径 $\\rho_{i}$ 定义为 $\\rho_{i} = v_{\\text{thi}}/\\Omega_{i}$。利用给定的离子热速度 $v_{\\text{thi}} = \\sqrt{2 T_{i} / m_{i}}$ 和离子回旋频率 $\\Omega_{i} = e B_{0} / m_{i}$ 的定义，我们可以将 $\\rho_{i}$ 写为：\n$$\n\\rho_{i} = \\frac{\\sqrt{2 T_{i} / m_{i}}}{e B_{0} / m_{i}} = \\frac{\\sqrt{2 T_{i} m_{i}}}{e B_{0}}\n$$\n代入 $T_{i}$、$m_{i}$、$e$ 和 $B_{0} = 3.0~\\text{T}$ 的值：\n$$\n\\rho_{i} = \\frac{\\sqrt{2 \\times (1.81560 \\times 10^{-16}~\\text{J}) \\times (3.34524 \\times 10^{-27}~\\text{kg})}}{(1.602176634 \\times 10^{-19}~\\text{C}) \\times (3.0~\\text{T})} \\approx 0.0022931~\\text{m}.\n$$\n宏观梯度标长 $L$ 是密度梯度标长和温度梯度标长中的最小值：\n$$\nL = \\min(L_{n}, L_{T}) = \\min(0.40~\\text{m}, 0.30~\\text{m}) = 0.30~\\text{m}.\n$$\n副法向波数 $k_{y}$ 由下式给出：\n$$\nk_{y} = \\frac{1}{2} \\frac{\\pi}{\\Delta} = \\frac{\\pi}{2 \\times 0.030~\\text{m}} = \\frac{\\pi}{0.060}~\\text{m}^{-1} \\approx 52.3599~\\text{m}^{-1}.\n$$\n\n现在我们可以计算这三个无量纲比值了。\n\n1.  比值 $\\epsilon_{1} = \\rho_{i}/L$：\n    $$\n    \\epsilon_{1} = \\frac{0.0022931~\\text{m}}{0.30~\\text{m}} \\approx 0.0076437.\n    $$\n\n2.  比值 $\\epsilon_{2} = \\omega_{*i}/\\Omega_{i}$：\n    使用定义 $\\omega_{*i} = k_{y} \\frac{T_{i}}{e B_{0} L_{n}}$ 和 $\\Omega_{i} = \\frac{e B_{0}}{m_{i}}$，我们可以将 $\\epsilon_2$ 表示为：\n    $$\n    \\epsilon_{2} = \\frac{\\omega_{*i}}{\\Omega_{i}} = \\frac{k_{y} T_{i} m_{i}}{(e B_{0})^{2} L_{n}}\n    $$\n    注意到 $\\rho_{i}^{2} = \\frac{2 T_{i} m_{i}}{(e B_{0})^{2}}$，可以简化此式。因此：\n    $$\n    \\epsilon_{2} = \\frac{k_{y} \\rho_{i}^{2}}{2 L_{n}}\n    $$\n    代入 $k_{y}$、$\\rho_{i}$ 和 $L_{n} = 0.40~\\text{m}$ 的值：\n    $$\n    \\epsilon_{2} = \\frac{(52.3599~\\text{m}^{-1}) \\times (0.0022931~\\text{m})^{2}}{2 \\times (0.40~\\text{m})} \\approx \\frac{2.7525 \\times 10^{-4}~\\text{m}}{0.80~\\text{m}} \\approx 0.00034406.\n    $$\n\n3.  比值 $\\epsilon_{3} = \\omega_{di}/\\Omega_{i}$：\n    使用近似式 $\\omega_{di} \\approx k_{y} \\frac{v_{\\text{thi}}^{2}}{2 \\Omega_{i} R_{0}}$，我们得到 $\\epsilon_3$：\n    $$\n    \\epsilon_{3} = \\frac{\\omega_{di}}{\\Omega_{i}} \\approx k_{y} \\frac{v_{\\text{thi}}^{2}}{2 \\Omega_{i}^{2} R_{0}}\n    $$\n    由于 $v_{\\text{thi}} = \\rho_{i} \\Omega_{i}$，该表达式简化为：\n    $$\n    \\epsilon_{3} = \\frac{k_{y} (\\rho_{i}\\Omega_{i})^{2}}{2 \\Omega_{i}^{2} R_{0}} = \\frac{k_{y} \\rho_{i}^{2}}{2 R_{0}}\n    $$\n    代入 $k_{y}$、$\\rho_{i}$ 和 $R_{0} = 3.0~\\text{m}$ 的值：\n    $$\n    \\epsilon_{3} = \\frac{(52.3599~\\text{m}^{-1}) \\times (0.0022931~\\text{m})^{2}}{2 \\times (3.0~\\text{m})} \\approx \\frac{2.7525 \\times 10^{-4}~\\text{m}}{6.0~\\text{m}} \\approx 0.000045875.\n    $$\n\n最后，我们比较这三个比值以找出最大值：\n$$\n\\epsilon_{1} \\approx 0.0076437 \\\\\n\\epsilon_{2} \\approx 0.0003441 \\\\\n\\epsilon_{3} \\approx 0.0000459\n$$\n其中最大的是 $\\epsilon_{1}$。题目要求将此值四舍五入到三位有效数字。\n$$\n\\max(\\epsilon_{1}, \\epsilon_{2}, \\epsilon_{3}) = \\epsilon_{1} \\approx 0.0076437 \\approx 0.00764.\n$$",
            "answer": "$$\n\\boxed{0.00764}\n$$"
        },
        {
            "introduction": "在大涡模拟 (LES) 中，空间滤波是区分已解析尺度和亚格子尺度的核心操作。然而，在托卡马克复杂的曲线坐标系下，滤波和空间微分运算通常不对易，这会产生所谓的“对易误差”，该误差是亚格子尺度模型中的一个重要不确定性来源。本练习将引导您推导并量化这一误差，揭示在为聚变等离子体开发精确亚格子尺度模型时所面临的一个关键挑战。",
            "id": "4191370",
            "problem": "在磁化等离子体湍流的回旋动理学大涡模拟（LES）中，空间滤波在场向坐标系中进行，以分离可解尺度和亚格子尺度。考虑直场线磁通坐标系 $(\\psi,\\theta,\\zeta)$，其中 $\\psi$ 是一个类径向的磁通标签，$\\theta$ 是极向角，$\\zeta$ 是环向角。在固定的 $\\psi$ 和 $\\zeta$ 处，定义一个一维极向高斯滤波器，该滤波器通过雅可比行列式 $J(\\psi,\\theta)$ 保持度规权重：\n$$\n\\overline{a}(\\psi,\\theta) \\equiv \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} a(\\psi,\\theta+s)\\,J(\\psi,\\theta+s)\\,K_{\\Delta(\\psi)}(s)\\,\\mathrm{d}s}{\\displaystyle \\int_{-\\infty}^{\\infty} J(\\psi,\\theta+s)\\,K_{\\Delta(\\psi)}(s)\\,\\mathrm{d}s},\n$$\n其高斯核为\n$$\nK_{\\Delta(\\psi)}(s) \\equiv \\frac{1}{\\sqrt{2\\pi}\\,\\Delta(\\psi)}\\exp\\!\\left(-\\frac{s^2}{2\\,\\Delta(\\psi)^2}\\right),\n$$\n其中 $\\Delta(\\psi)$ 是一个径向变化的滤波宽度。设托卡马克几何为大环径比且在极向方向上弱非均匀，其模型为\n$$\nJ(\\psi,\\theta) = J_0(\\psi)\\,\\bigl[1+\\epsilon(\\psi)\\cos\\theta\\bigr],\n$$\n其中 $|\\epsilon(\\psi)| \\ll 1$。\n\n仅使用上述定义和光滑函数的标准泰勒-矩展开，在窄滤波器极限下进行计算，并保留至 $\\mathcal{O}(\\Delta(\\psi)^2)$ 阶和 $\\epsilon(\\psi)$ 的线性阶的贡献。考虑径向导数算符 $\\partial_{\\psi}$ 以及作用于测试场的滤波与求导之间的对易子\n$$\na(\\psi,\\theta) = g(\\psi)\\cos\\theta,\n$$\n其中 $g(\\psi)$ 是一个光滑的振幅。推导前导阶的对易子\n$$\n\\mathcal{C}(\\psi,\\theta) \\equiv \\overline{\\partial_{\\psi} a}(\\psi,\\theta) - \\partial_{\\psi}\\overline{a}(\\psi,\\theta),\n$$\n并在 $\\theta=\\pi/2$ 和任意半径 $\\psi=\\psi_0$ 处求其值。\n\n你的最终答案必须是 $\\mathcal{C}(\\psi_0,\\pi/2)$ 的一个单一闭合形式的解析表达式，用 $g(\\psi_0)$、$\\Delta(\\psi_0)$、$\\Delta'(\\psi_0)$、$\\epsilon(\\psi_0)$ 和 $\\epsilon'(\\psi_0)$ 表示，且在所述阶数内有效。无需进行数值计算。此外，在你的推导中，请确定（在相同阶数下）$\\partial_{\\psi}$ 与滤波器对所有光滑函数 $a(\\psi,\\theta)$ 可交换的充分条件。最终的方框答案应仅包含所要求的解析表达式，不带任何单位或无关符号。",
            "solution": "### 滤波场的推导\n首先，我们简化滤波器定义。因子 $J_0(\\psi)$ 与积分变量 $s$ 无关，因此可以从分子和分母中消去。滤波器变为：\n$$\n\\overline{a}(\\psi,\\theta) = \\frac{\\displaystyle \\int_{-\\infty}^{\\infty} a(\\psi,\\theta+s)\\,\\bigl[1+\\epsilon(\\psi)\\cos(\\theta+s)\\bigr]\\,K_{\\Delta}(s)\\,\\mathrm{d}s}{\\displaystyle \\int_{-\\infty}^{\\infty} \\bigl[1+\\epsilon(\\psi)\\cos(\\theta+s)\\bigr]\\,K_{\\Delta}(s)\\,\\mathrm{d}s}\n$$\n为简洁起见，我们用 $\\Delta$ 代替 $\\Delta(\\psi)$，用 $\\epsilon$ 代替 $\\epsilon(\\psi)$。我们在小 $s$ 的情况下对被积函数中的量进行泰勒级数展开，这在窄滤波器极限下是合理的。我们需要高斯核的矩：$\\int_{-\\infty}^{\\infty} s^n K_{\\Delta}(s) \\, \\mathrm{d}s$。对于 $n=0,1,2,3,4$，这些矩分别是 $1, 0, \\Delta^2, 0, 3\\Delta^4$。\n\n首先，让我们计算分母 $D$，保留到 $\\mathcal{O}(\\Delta^2)$ 阶和 $\\epsilon$ 的线性阶：\n$$\nD = \\int_{-\\infty}^{\\infty} [1+\\epsilon\\cos(\\theta+s)] K_{\\Delta}(s)\\,\\mathrm{d}s = 1 + \\epsilon \\int_{-\\infty}^{\\infty} (\\cos\\theta\\cos s - \\sin\\theta\\sin s) K_{\\Delta}(s)\\,\\mathrm{d}s\n$$\n我们展开 $\\cos s \\approx 1-s^2/2$ 和 $\\sin s \\approx s$。对核函数积分得到：\n$$\nD = 1 + \\epsilon (\\cos\\theta \\langle 1-s^2/2 \\rangle_K - \\sin\\theta \\langle s \\rangle_K) = 1 + \\epsilon\\cos\\theta(1-\\Delta^2/2) = 1 + \\epsilon\\cos\\theta - \\frac{\\epsilon\\Delta^2}{2}\\cos\\theta\n$$\n其逆为 $D^{-1} \\approx (1+\\epsilon\\cos\\theta)^{-1} \\approx 1-\\epsilon\\cos\\theta$，保留到 $\\epsilon$ 的前导阶。保留 $\\epsilon\\Delta^2$ 的修正项：\n$D^{-1} \\approx (1 + \\epsilon\\cos\\theta(1-\\Delta^2/2))^{-1} \\approx 1 - \\epsilon\\cos\\theta(1-\\Delta^2/2) \\approx 1 - \\epsilon\\cos\\theta + \\frac{\\epsilon\\Delta^2}{2}\\cos\\theta$。\n\n现在我们计算分子 $N$，将 $a(\\psi,\\theta+s)$ 和 $\\cos(\\theta+s)$ 展开到 $s$ 的二阶：\n$a(\\psi,\\theta+s) \\approx a + s\\partial_\\theta a + \\frac{s^2}{2}\\partial^2_\\theta a$\n$\\cos(\\theta+s) \\approx \\cos\\theta - s\\sin\\theta - \\frac{s^2}{2}\\cos\\theta$\n分子的被积函数是 $[a(\\psi,\\theta+s)][1+\\epsilon\\cos(\\theta+s)]K_\\Delta(s)$。\n$N = \\int \\left(a + s\\partial_\\theta a + \\frac{s^2}{2}\\partial^2_\\theta a\\right) \\left[1+\\epsilon\\left(\\cos\\theta - s\\sin\\theta - \\frac{s^2}{2}\\cos\\theta\\right)\\right] K_\\Delta(s) \\,\\mathrm{d}s$。\n逐项积分，保留到 $\\mathcal{O}(\\Delta^2)$ 阶和 $\\epsilon$ 的线性阶的贡献：\n$$\nN = \\left( a + \\frac{\\Delta^2}{2}\\partial^2_\\theta a \\right) + \\epsilon \\left( a\\cos\\theta - \\Delta^2\\sin\\theta\\partial_\\theta a - \\frac{\\Delta^2}{2}a\\cos\\theta + \\frac{\\Delta^2}{2}\\cos\\theta\\partial^2_\\theta a \\right)\n$$\n然后 $\\overline{a} = N D^{-1}$。我们将 $N$ 乘以 $D^{-1}$，保留 $\\mathcal{O}(\\Delta^2)$ 和 $\\mathcal{O}(\\epsilon\\Delta^2)$ 阶的项：\n$$\n\\overline{a} \\approx \\left[ a + \\frac{\\Delta^2}{2}\\partial^2_\\theta a + \\epsilon a\\cos\\theta + \\mathcal{O}(\\epsilon\\Delta^2) \\right] \\left( 1 - \\epsilon\\cos\\theta + \\frac{\\epsilon\\Delta^2}{2}\\cos\\theta \\right) + \\epsilon\\left(-\\Delta^2\\sin\\theta\\partial_\\theta a - \\frac{\\Delta^2}{2}a\\cos\\theta + \\frac{\\Delta^2}{2}\\cos\\theta\\partial^2_\\theta a\\right)\n$$\n展开并化简：\n$$\n\\overline{a} = a + \\frac{\\Delta^2}{2}\\partial^2_\\theta a - a\\epsilon\\cos\\theta + a\\frac{\\epsilon\\Delta^2}{2}\\cos\\theta + \\epsilon a\\cos\\theta - \\epsilon\\Delta^2\\sin\\theta\\partial_\\theta a - \\epsilon\\frac{\\Delta^2}{2}a\\cos\\theta + \\epsilon\\frac{\\Delta^2}{2}\\cos\\theta\\partial^2_\\theta a + \\mathcal{O}(\\epsilon^2, \\Delta^4)\n$$\n许多项相互抵消，留下滤波场的表达式：\n$$\n\\overline{a}(\\psi,\\theta) = a + \\frac{\\Delta^2}{2}\\partial^2_\\theta a - \\epsilon\\Delta^2\\sin\\theta\\partial_\\theta a + \\frac{\\epsilon\\Delta^2}{2}\\cos\\theta\\partial^2_\\theta a\n$$\n这是在所要求阶数下，对任何光滑场 $a(\\psi, \\theta)$ 的通用表达式。\n\n### 对易子的推导\n我们需要计算 $\\mathcal{C}(\\psi,\\theta) \\equiv \\overline{\\partial_{\\psi} a}(\\psi,\\theta) - \\partial_{\\psi}\\overline{a}(\\psi,\\theta)$。\n\n首先，我们代入测试场 $a(\\psi,\\theta)=g(\\psi)\\cos\\theta$。其导数为：\n$\\partial_\\theta a = -g\\sin\\theta$ 和 $\\partial_\\theta^2 a = -g\\cos\\theta$。\n将这些代入 $\\overline{a}$ 的表达式：\n$$\n\\overline{a} = g\\cos\\theta + \\frac{\\Delta^2}{2}(-g\\cos\\theta) - \\epsilon\\Delta^2\\sin\\theta(-g\\sin\\theta) + \\frac{\\epsilon\\Delta^2}{2}\\cos\\theta(-g\\cos\\theta)\n$$\n$$\n\\overline{a}(\\psi,\\theta) = g\\cos\\theta - \\frac{g\\Delta^2}{2}\\cos\\theta + \\epsilon g\\Delta^2\\sin^2\\theta - \\frac{\\epsilon g\\Delta^2}{2}\\cos^2\\theta\n$$\n现在我们计算对易子的两项。\n\n1.  $\\overline{\\partial_{\\psi} a}(\\psi,\\theta)$:\n    需要滤波的场是 $\\partial_\\psi a = g'(\\psi)\\cos\\theta$。我们可以通过在 $\\overline{a}$ 的表达式中用 $g'$ 替换 $g$ 来得到结果：\n    $$\n    \\overline{\\partial_{\\psi} a} = g'\\cos\\theta - \\frac{g'\\Delta^2}{2}\\cos\\theta + \\epsilon g'\\Delta^2\\sin^2\\theta - \\frac{\\epsilon g'\\Delta^2}{2}\\cos^2\\theta\n    $$\n\n2.  $\\partial_{\\psi}\\overline{a}(\\psi,\\theta)$:\n    我们将 $\\overline{a}$ 的表达式对 $\\psi$ 求导，注意 $g, \\Delta$ 和 $\\epsilon$ 都是 $\\psi$ 的函数。使用乘法法则 $\\partial_\\psi(f_1 f_2 ...)=f_1'f_2... + f_1f_2'...$，我们得到：\n    $$\n    \\partial_{\\psi}\\overline{a} = \\partial_\\psi(g\\cos\\theta) - \\partial_\\psi\\left(\\frac{g\\Delta^2}{2}\\cos\\theta\\right) + \\partial_\\psi(\\epsilon g\\Delta^2\\sin^2\\theta) - \\partial_\\psi\\left(\\frac{\\epsilon g\\Delta^2}{2}\\cos^2\\theta\\right)\n    $$\n    $$\n    \\partial_{\\psi}\\overline{a} = g'\\cos\\theta - \\frac{\\cos\\theta}{2}(g'\\Delta^2 + 2g\\Delta\\Delta') + \\sin^2\\theta(\\epsilon'g\\Delta^2 + \\epsilon g'\\Delta^2 + 2\\epsilon g\\Delta\\Delta') - \\frac{\\cos^2\\theta}{2}(\\epsilon'g\\Delta^2 + \\epsilon g'\\Delta^2 + 2\\epsilon g\\Delta\\Delta')\n    $$\n\n现在，我们计算对易子 $\\mathcal{C} = \\overline{\\partial_\\psi a} - \\partial_\\psi\\overline{a}$：\n$$\n\\mathcal{C} = \\left( g'\\cos\\theta - \\frac{g'\\Delta^2}{2}\\cos\\theta + \\epsilon g'\\Delta^2\\sin^2\\theta - \\frac{\\epsilon g'\\Delta^2}{2}\\cos^2\\theta \\right) - \\\\ \\left( g'\\cos\\theta - \\frac{g'\\Delta^2}{2}\\cos\\theta - g\\Delta\\Delta'\\cos\\theta + (\\epsilon'g\\Delta^2 + \\epsilon g'\\Delta^2 + 2\\epsilon g\\Delta\\Delta')\\sin^2\\theta - (\\frac{\\epsilon'g\\Delta^2}{2} + \\frac{\\epsilon g'\\Delta^2}{2} + \\epsilon g\\Delta\\Delta')\\cos^2\\theta \\right)\n$$\n相减后许多项相互抵消。我们剩下：\n$$\n\\mathcal{C}(\\psi,\\theta) = g\\Delta\\Delta'\\cos\\theta - (\\epsilon'g\\Delta^2 + 2\\epsilon g\\Delta\\Delta')\\sin^2\\theta + (\\frac{\\epsilon'g\\Delta^2}{2} + \\epsilon g\\Delta\\Delta')\\cos^2\\theta\n$$\n\n### 在指定点求值\n我们在 $\\theta=\\pi/2$ 处计算对易子。在此角度，$\\cos(\\pi/2)=0$ 且 $\\sin(\\pi/2)=1$。\n$$\n\\mathcal{C}(\\psi,\\pi/2) = g\\Delta\\Delta'(0) - (\\epsilon'g\\Delta^2 + 2\\epsilon g\\Delta\\Delta')(1)^2 + (\\frac{\\epsilon'g\\Delta^2}{2} + \\epsilon g\\Delta\\Delta')(0)^2\n$$\n$$\n\\mathcal{C}(\\psi,\\pi/2) = -g(\\psi)\\epsilon'(\\psi)\\Delta(\\psi)^2 - 2g(\\psi)\\epsilon(\\psi)\\Delta(\\psi)\\Delta'(\\psi)\n$$\n问题要求在任意半径 $\\psi=\\psi_0$ 处求值。\n$$\n\\mathcal{C}(\\psi_0, \\pi/2) = -g(\\psi_0)\\epsilon'(\\psi_0)\\Delta(\\psi_0)^2 - 2g(\\psi_0)\\epsilon(\\psi_0)\\Delta(\\psi_0)\\Delta'(\\psi_0)\n$$\n因式分解该表达式得到：\n$$\n\\mathcal{C}(\\psi_0, \\pi/2) = -g(\\psi_0)\\Delta(\\psi_0)\\left[ \\epsilon'(\\psi_0)\\Delta(\\psi_0) + 2\\epsilon(\\psi_0)\\Delta'(\\psi_0) \\right]\n$$\n该表达式等价于 $-g(\\psi_0)\\left[\\frac{d}{d\\psi}(\\epsilon(\\psi)\\Delta(\\psi)^2)\\right]_{\\psi=\\psi_0}$。\n\n### 可交换性条件\n为了找到 $\\partial_\\psi$ 与滤波器对任何光滑函数 $a(\\psi, \\theta)$ 可交换的充分条件，我们需要对所有的 $a$ 都有 $\\mathcal{C}(\\psi,\\theta)=0$。我们必须分析对易子的一般算符形式。\n$$\n\\mathcal{C}[a] = \\overline{\\partial_\\psi a} - \\partial_\\psi \\overline{a}\n$$\n使用 $\\overline{a}$ 的通用表达式并应用与测试函数相同的步骤，我们发现：\n$$\n\\mathcal{C}[a] = -\\Delta\\Delta'\\partial_\\theta^2 a - \\left(\\frac{d}{d\\psi}(\\epsilon\\Delta^2)\\right)\\left(\\frac{\\cos\\theta}{2}\\partial_\\theta^2 a - \\sin\\theta\\partial_\\theta a\\right)\n$$\n$$\n\\mathcal{C}[a] = -\\Delta\\Delta'\\partial_\\theta^2 a - (\\epsilon'\\Delta^2 + 2\\epsilon\\Delta\\Delta')\\left(\\frac{\\cos\\theta}{2}\\partial_\\theta^2 a - \\sin\\theta\\partial_\\theta a\\right)\n$$\n为了使 $\\mathcal{C}[a]$ 对任何光滑的 $a$ 恒为零，独立的微分算符 $(\\partial_\\theta a, \\partial_\\theta^2 a)$ 的系数必须对所有的 $\\theta$ 都为零。\n$\\partial_\\theta a$ 的系数是：\n$$\n(\\epsilon'\\Delta^2 + 2\\epsilon\\Delta\\Delta')\\sin\\theta = 0\n$$\n因为这对所有 $\\theta$ 都必须成立，我们必须有 $\\epsilon'\\Delta^2 + 2\\epsilon\\Delta\\Delta' = 0$，即 $\\frac{d}{d\\psi}(\\epsilon\\Delta^2)=0$。\n$\\partial_\\theta^2 a$ 的系数是：\n$$\n-\\Delta\\Delta' - (\\epsilon'\\Delta^2 + 2\\epsilon\\Delta\\Delta')\\frac{\\cos\\theta}{2} = 0\n$$\n使用第一个条件，这可以简化为 $-\\Delta\\Delta' = 0$。由于滤波器宽度 $\\Delta \\neq 0$，这意味着 $\\Delta'(\\psi)=0$，即 $\\Delta$ 是常数。\n如果 $\\Delta'=0$，第一个条件 $\\epsilon'\\Delta^2=0$ 意味着 $\\epsilon'(\\psi)=0$，即 $\\epsilon$ 也是常数。\n因此，滤波器与 $\\partial_\\psi$ 可交换的一个充分条件是，滤波器宽度 $\\Delta$ 和几何因子 $\\epsilon$ 都与 $\\psi$ 无关。",
            "answer": "$$ \\boxed{-g(\\psi_0)\\Delta(\\psi_0)\\left( \\Delta(\\psi_0) \\epsilon'(\\psi_0) + 2 \\epsilon(\\psi_0) \\Delta'(\\psi_0) \\right)} $$"
        },
        {
            "introduction": "动态亚格子尺度模型能够根据已解析的流场“实时”计算模型系数，但有时会产生非物理的“能量反向散射”，从而破坏数值模拟的稳定性。本练习将演示如何基于自由能守恒这一物理原理，实现一个“限制器”来约束动态系数。通过这个实践，您将学习到确保高级亚格子模型稳定性和物理真实性的一种重要实用技术。",
            "id": "4191297",
            "problem": "您的任务是为回旋动理学等离子体湍流的大涡模拟（LES）中动态计算的亚网格尺度系数，实现并分析一个保正限制器。其目标是防止由负动态系数引起的解析系统失稳，同时允许受控的反向散射。您的实现和分析必须基于回旋动理学自由能平衡，并且通篇使用无量纲单位表示。\n\n考虑回旋动理学自由能 $W(t)$，在标准回旋动理学理论中，当不存在源和耗散时，它是一个二次不变量。在一个带有亚网格尺度闭合的简化解析尺度模型中，假设解析自由能满足以下平衡：\n$$\n\\frac{dW}{dt} = P - \\epsilon_{\\mathrm{res}} - \\epsilon_{\\mathrm{sgs}},\n$$\n其中 $P \\ge 0$ 是由背景梯度驱动产生的产生项，$\\epsilon_{\\mathrm{res}} \\ge 0$ 是解析尺度耗散，而 $\\epsilon_{\\mathrm{sgs}}$ 是亚网格尺度项，其模型为\n$$\n\\epsilon_{\\mathrm{sgs}} = C \\, \\phi,\n$$\n其中 $C$ 是一个通过测试滤波过程确定的动态系数，$\\phi \\ge 0$ 是一个解析尺度的梯度或应变的正定度量（例如，解析梯度的范数）。系数 $C$ 可能为负，表示反向散射。为保证数值稳定性和物理真实性，我们需要一个保正限制器，该限制器在允许有限反向散射的同时，强制执行能量稳定性约束。\n\n从自由能平衡出发，并根据净反向散射不能超过产生项的一个固定比例的要求，推导出一个能确保以下条件的显式限制器：\n$$\n\\epsilon_{\\mathrm{sgs}} \\ge -\\beta P,\n$$\n对于一个选定的界限 $0 \\le \\beta \\le 1$，并且通过上界 $C \\le C_{\\max}$ 来限制过度的耗散。该限制器必须作用于动态系数 $C_{\\mathrm{raw}}$，以产生一个受限系数 $C_{\\mathrm{lim}}$，使得\n$$\nC_{\\mathrm{lim}} = \\min\\left(C_{\\max}, \\max\\left(C_{\\mathrm{raw}}, C_{\\min}\\right)\\right),\n$$\n与\n$$\nC_{\\min} = \n\\begin{cases}\n-\\dfrac{\\beta P}{\\phi},  &\\phi > 0, \\\\\n0,  &\\phi = 0.\n\\end{cases}\n$$\n这确保了 $C_{\\mathrm{lim}} \\in [C_{\\min}, C_{\\max}]$，$\\epsilon_{\\mathrm{sgs}} \\ge -\\beta P$，并且当 $\\phi = 0$ 时没有反向散射。\n\n您的程序必须实现这个限制器，并为一组给定的测试用例计算 $C_{\\mathrm{lim}}$。所有量都是无量纲的。对于每个测试用例，您将获得一个元组 $(C_{\\mathrm{raw}}, P, \\phi, C_{\\max}, \\beta)$。\n\n测试套件：\n- 情况 1 (理想路径，无削波): $(0.10, 1.0, 2.0, 0.25, 0.30)$\n- 情况 2 (允许反向散射，无削波): $(-0.05, 1.0, 2.0, 0.25, 0.30)$\n- 情况 3 (负系数被下界削波): $(-0.40, 1.0, 2.0, 0.25, 0.30)$\n- 情况 4 (正系数被上界削波): $(0.50, 1.0, 2.0, 0.25, 0.30)$\n- 情况 5 (无产生项，禁止反向散射): $(-0.10, 0.0, 3.0, 0.25, 0.30)$\n- 情况 6 (梯度为零，禁止反向散射): $(-1.00, 0.5, 0.0, 0.25, 0.30)$\n- 情况 7 (梯度极小，下界绝对值大，无削波): $(-0.01, 0.5, 10^{-6}, 0.25, 0.30)$\n- 情况 8 (中等产生项和梯度下的上界削波): $(0.30, 0.2, 0.1, 0.25, 0.30)$\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,...]”），其中每个结果是相应测试用例的受限系数 $C_{\\mathrm{lim}}$，并四舍五入到六位小数。",
            "solution": "目标是为回旋动理学等离子体湍流的大涡模拟（LES）中使用的动态亚网格尺度（SGS）系数 $C$ 实现一个物理上合理的限制器。该限制器必须通过强制施加能量约束来确保数值稳定性，同时允许受控量的能量从亚网格尺度反向散射到解析尺度。\n\n出发点是解析尺度自由能 $W(t)$ 的演化方程：\n$$\n\\frac{dW}{dt} = P - \\epsilon_{\\mathrm{res}} - \\epsilon_{\\mathrm{sgs}}\n$$\n在此，$P \\ge 0$ 是能量产生项，$\\epsilon_{\\mathrm{res}} \\ge 0$ 是解析尺度耗散，$\\epsilon_{\\mathrm{sgs}}$ 是向亚网格尺度的能量输运。为使系统稳定，总耗散必须平衡或超过产生项。SGS 项的模型为：\n$$\n\\epsilon_{\\mathrm{sgs}} = C \\phi\n$$\n其中 $\\phi \\ge 0$ 是解析尺度梯度的正定度量，而 $C$ 是一个动态计算的系数。如果 $C > 0$，$\\epsilon_{\\mathrm{sgs}} > 0$ 表示正向能量级串（来自解析尺度的耗散）。如果 $C < 0$，$\\epsilon_{\\mathrm{sgs}} < 0$ 表示反向散射（向解析尺度的能量注入）。不受控制的反向散射可能导致数值不稳定性。\n\n该限制器的核心是能量稳定性约束，它限制了允许的反向散射量。净反向散射不允许超过能量产生项 $P$ 的一个指定比例 $\\beta$。在数学上，这表示为：\n$$\n\\epsilon_{\\mathrm{sgs}} \\ge -\\beta P\n$$\n其中 $0 \\le \\beta \\le 1$。这个不等式确保了即使在最大反向散射的最坏情况下，SGS 项也不会驱动解析能量发生不符合物理的爆炸性增长。\n\n我们通过将SGS模型代入约束条件，来推导受限系数 $C_{\\mathrm{lim}}$ 的下界：\n$$\nC_{\\mathrm{lim}} \\phi \\ge -\\beta P\n$$\n我们必须考虑 $\\phi$ 值的两种情况：\n\n1.  情况 $\\phi > 0$：当存在非零的解析梯度时，我们可以用正量 $\\phi$ 去除不等式两边，而无需改变不等号的方向：\n    $$\n    C_{\\mathrm{lim}} \\ge -\\frac{\\beta P}{\\phi}\n    $$\n    这个不等式定义了受限系数的最小允许值。因此，我们将下界 $C_{\\min}$ 定义为：\n    $$\n    C_{\\min} = -\\frac{\\beta P}{\\phi}\n    $$\n\n2.  情况 $\\phi = 0$：当解析尺度梯度为零时，不等式变为 $C_{\\mathrm{lim}} \\cdot 0 \\ge -\\beta P$，可简化为 $0 \\ge -\\beta P$。由于 $P \\ge 0$ 和 $\\beta \\ge 0$，$-\\beta P$ 项总是小于或等于零，因此不等式 $0 \\ge -\\beta P$ 恒成立，与 $C_{\\mathrm{lim}}$ 的值无关。因此，在这种情况下，能量约束本身并未对 $C_{\\mathrm{lim}}$ 施加下界。然而，需要进行物理上的考虑。$\\phi = 0$ 的值意味着解析场在网格尺度上局部是“平坦”的。在这样的区域，任何SGS能量输运都是物理上无意义的。因此，我们通过将下界设置为零来强制要求不应有SGS耗散或反向散射。这导出了以下定义：\n    $$\n    C_{\\min} = 0\n    $$\n\n结合这两种情况，我们得到了问题中指定的下界的完整定义：\n$$\nC_{\\min} = \n\\begin{cases}\n-\\dfrac{\\beta P}{\\phi},  &\\phi > 0, \\\\\n0,  &\\phi = 0.\n\\end{cases}\n$$\n\n完整的限制器必须将原始的动态计算系数 $C_{\\mathrm{raw}}$ 限制在由这个物理推导的下界 $C_{\\min}$ 和一个防止过度耗散的用户指定的上界 $C_{\\max}$ 所定义的允许范围内。削波操作表示为：\n$$\nC_{\\mathrm{lim}} = \\min\\left(C_{\\max}, \\max\\left(C_{\\mathrm{raw}}, C_{\\min}\\right)\\right)\n$$\n这等同于将 $C_{\\mathrm{raw}}$ 限制在区间 $[C_{\\min}, C_{\\max}]$ 内。对于一组给定的参数 $(C_{\\mathrm{raw}}, P, \\phi, C_{\\max}, \\beta)$，计算 $C_{\\mathrm{lim}}$ 的算法如下：\n1.  评估输入。\n2.  根据 $\\phi$ 的条件逻辑计算 $C_{\\min}$。\n3.  使用计算出的 $C_{\\min}$ 和给定的 $C_{\\max}$ 将削波公式应用于 $C_{\\mathrmraw}$。\n4.  返回结果 $C_{\\mathrm{lim}}$。\n\n将对每个提供的测试用例实施此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and tests a positivity-preserving limiter for a dynamic SGS coefficient\n    in a gyrokinetic LES context.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (C_raw, P, phi, C_max, beta)\n    test_cases = [\n        (0.10, 1.0, 2.0, 0.25, 0.30),    # Case 1\n        (-0.05, 1.0, 2.0, 0.25, 0.30),   # Case 2\n        (-0.40, 1.0, 2.0, 0.25, 0.30),   # Case 3\n        (0.50, 1.0, 2.0, 0.25, 0.30),   # Case 4\n        (-0.10, 0.0, 3.0, 0.25, 0.30),   # Case 5\n        (-1.00, 0.5, 0.0, 0.25, 0.30),   # Case 6\n        (-0.01, 0.5, 1e-6, 0.25, 0.30),  # Case 7\n        (0.30, 0.2, 0.1, 0.25, 0.30),    # Case 8\n    ]\n\n    results = []\n    for C_raw, P, phi, C_max, beta in test_cases:\n        # Calculate the lower bound C_min based on the stability constraint.\n        # This is the core logic derived from the free-energy balance principle.\n        \n        # Case 1: phi > 0. The lower bound is determined by the ratio of\n        # allowed backscatter to the local gradient measure.\n        if phi > 0:\n            C_min = -beta * P / phi\n        # Case 2: phi = 0. No SGS effects should occur if there are no\n        # resolved gradients, so we enforce C_min = 0.\n        else:\n            C_min = 0.0\n\n        # Apply the limiter. The raw coefficient C_raw is clipped to the\n        # range [C_min, C_max] to produce the limited coefficient C_lim.\n        # The numpy.clip function is equivalent to the problem's formulation:\n        # min(C_max, max(C_raw, C_min))\n        C_lim = np.clip(C_raw, C_min, C_max)\n        \n        results.append(C_lim)\n\n    # Format the results as a comma-separated list of strings, with each\n    # number rounded to six decimal places.\n    # The f-string format specifier \"{:.6f}\" ensures rounding and formatting.\n    formatted_results = [f'{res:.6f}' for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}