{
    "hands_on_practices": [
        {
            "introduction": "漂移-流体模型是模拟边缘等离子体“团块”的有力工具，但它们本质上是近似。在使用这些模型之前，一个关键步骤是确定其有效性范围。该模型的有效性取决于物理尺度的分离，特别是离子声波拉莫尔半径 $\\rho_s$ 与宏观梯度尺度 $L_\\perp$ 之间的比率。这个练习  将让你亲手计算这个关键的排序参数 $\\epsilon = \\rho_s / L_\\perp$，从而为给定的一组等离子体参数采用二维漂移-流体描述提供定量的依据。",
            "id": "4200178",
            "problem": "一个环形装置中的边缘等离子体团块在强磁场下进行建模，其参数为 $B=2\\,\\mathrm{T}$，$n=5\\times 10^{19}\\,\\mathrm{m^{-3}}$，$T_{e}=30\\,\\mathrm{eV}$，以及垂直梯度尺度 $L_{\\perp}=2\\,\\mathrm{cm}$。假设存在质量为 $m_{i}$、电荷为 $q_{i}=+e$ 的单电离氘离子；电子是等温的，温度为 $T_{e}$，且等离子体是准中性的。二维(2D)漂移流体描述依赖于一个阶化小参数 $\\epsilon$，该参数定义为特征垂直微观尺度与宏观梯度尺度之比。\n\n从洛伦兹力作用下的离子运动方程和等温电子动量平衡方程（忽略电子惯性）出发，推导离子回旋频率和离子声速的表达式，并由此得到定义为离子声速与离子回旋频率之比的离子声回旋半径 $\\rho_{s}$。使用这些结果，构造阶化参数 $\\epsilon=\\rho_{s}/L_{\\perp}$。\n\n然后，使用给定参数，计算 $\\rho_{s}$ 和 $\\epsilon$ 的数值。将您的数值答案四舍五入至四位有效数字。以 $\\mathrm{m}$ 为单位表示 $\\rho_{s}$，并将 $\\epsilon$ 表示为无量纲数。以行矩阵的形式按顺序 $\\left[\\rho_{s},\\,\\epsilon\\right]$ 提供您的最终数值答案。\n\n最后，基于第一性原理的尺度分离，讨论二维漂移流体描述对于这组边缘参数是否有效，并根据 $\\epsilon$ 的量级和其所隐含的动力学时间尺度分离来证明您的结论。您的讨论无需包括除已要求之外的额外数值计算。",
            "solution": "目标是从第一性原理出发，计算离子声回旋半径 $\\rho_{s}$ 和阶化参数 $\\epsilon=\\rho_{s}/L_{\\perp}$。\n\n我们从洛伦兹力作用下的离子运动方程，\n$$\nm_{i}\\,\\frac{d\\boldsymbol{v}_{i}}{dt} = q_{i}\\,\\boldsymbol{v}_{i}\\times \\boldsymbol{B} + q_{i}\\,\\boldsymbol{E} - \\nabla p_{i},\n$$\n以及忽略电子惯性的电子动量平衡方程开始，\n$$\n0 = - e\\,n\\,\\boldsymbol{E} - \\nabla p_{e}.\n$$\n对于等温电子，有 $p_{e} = n k_{B} T_{e}$，电子平衡方程立即可得\n$$\n\\boldsymbol{E} = -\\frac{1}{e n}\\,\\nabla p_{e} = -\\frac{k_{B} T_{e}}{e}\\,\\nabla\\ln n.\n$$\n离子回旋频率源于洛伦兹力磁场部分作用下的匀速圆周运动，该运动投影在垂直于 $\\boldsymbol{B}$ 的平面上。对于回旋运动，设 $\\boldsymbol{E}=\\boldsymbol{0}$ 并忽略压强，\n$$\nm_{i}\\,\\frac{d\\boldsymbol{v}_{\\perp}}{dt} = q_{i}\\,\\boldsymbol{v}_{\\perp}\\times \\boldsymbol{B},\n$$\n这给出了回旋频率的大小\n$$\n\\Omega_{i} = \\frac{q_{i} B}{m_{i}} = \\frac{e B}{m_{i}}.\n$$\n\n离子声速是通过将离子连续性方程、平行方向动量方程与等温电子状态方程相结合，从沿磁力线的压缩动力学中得到的。在一维情况下，对于小振幅扰动和冷离子（忽略离子压强），线性化系统变为\n$$\n\\partial_{t} n_{1} + n_{0}\\,\\partial_{x} u_{i1} = 0, \\qquad m_{i}\\,\\partial_{t} u_{i1} = -\\frac{1}{n_{0}}\\,\\partial_{x} p_{e1},\n$$\n其中 $p_{e1} = k_{B} T_{e}\\,n_{1}$ 且准中性条件为 $n_{e1}\\approx n_{i1}\\equiv n_{1}$。消去 $u_{i1}$ 得到波动方程 $\\partial_{t}^{2} n_{1} = c_{s}^{2}\\,\\partial_{x}^{2} n_{1}$，其中的离子声速为\n$$\nc_{s} = \\sqrt{\\frac{k_{B} T_{e}}{m_{i}}}.\n$$\n由于 $T_{e}$ 是以电子伏特为单位给出的，我们使用 $k_{B} T_{e} = e\\,T_{e}$，得到\n$$\nc_{s} = \\sqrt{\\frac{e\\,T_{e}}{m_{i}}}.\n$$\n\n根据定义，离子声回旋半径是离子声速与离子回旋频率之比，\n$$\n\\rho_{s} \\equiv \\frac{c_{s}}{\\Omega_{i}} = \\frac{\\sqrt{e\\,T_{e}/m_{i}}}{e B/m_{i}} = \\frac{\\sqrt{m_{i}\\,e\\,T_{e}}}{e\\,B}.\n$$\n阶化参数为\n$$\n\\epsilon = \\frac{\\rho_{s}}{L_{\\perp}}.\n$$\n\n现在我们用给定参数计算数值。设单电离氘离子的质量为 $m_{i} = 2\\,m_{p}$，其中 $m_{p}$ 是质子质量，$q_{i}=e$ 是基本电荷。使用标准值 $e = 1.602176634\\times 10^{-19}$ C，$m_{p} = 1.67262192369\\times 10^{-27}$ kg，我们有\n$$\nm_{i} = 2\\,m_{p} = 3.34524384738\\times 10^{-27} \\text{ kg}.\n$$\n使用 $T_{e}=30$ (单位为电子伏特)，$B=2$ T 和 $L_{\\perp} = 2\\,\\mathrm{cm} = 2.0\\times 10^{-2}\\,\\mathrm{m}$，计算\n$$\nc_{s} = \\sqrt{\\frac{e T_{e}}{m_{i}}} = \\sqrt{\\frac{1.602176634\\times 10^{-19}\\times 30}{3.34524384738\\times 10^{-27}}} \\approx 3.7930\\times 10^{4} \\text{ m/s},\n$$\n$$\n\\Omega_{i} = \\frac{e B}{m_{i}} = \\frac{1.602176634\\times 10^{-19}\\times 2}{3.34524384738\\times 10^{-27}} \\approx 9.5788\\times 10^{7} \\text{ rad/s}.\n$$\n因此，\n$$\n\\rho_{s} = \\frac{c_{s}}{\\Omega_{i}} \\approx \\frac{3.7930\\times 10^{4}}{9.5788\\times 10^{7}} \\approx 3.956\\times 10^{-4} \\text{ m},\n$$\n和\n$$\n\\epsilon = \\frac{\\rho_{s}}{L_{\\perp}} = \\frac{3.956\\times 10^{-4}}{2.0\\times 10^{-2}} \\approx 1.978\\times 10^{-2}.\n$$\n四舍五入至四位有效数字，这些即为所求值。\n\n最后，我们讨论二维(2D)漂移流体描述的有效性。漂移流体模型基于一个小参数的渐近展开，该参数衡量了微观回旋半径尺度与宏观梯度尺度之比，同时还基于慢速的漂移/交换模动力学与快速的回旋运动之间的时间尺度分离。此处的小参数是 $\\epsilon = \\rho_{s}/L_{\\perp}$。由于 $\\epsilon \\approx 1.978\\times 10^{-2}$，我们有 $\\epsilon \\ll 1$，这表明：\n- 长度尺度分离：$\\rho_{s} \\ll L_{\\perp}$，因此在离子声回旋半径尺度上，垂直梯度是平滑的，并且漂移阶化是合适的。\n- 时间尺度分离：特征垂直对流频率 $\\omega_{\\perp}\\sim c_{s}/L_{\\perp}$ 比离子回旋频率小，其比率相同，即 $\\omega_{\\perp}/\\Omega_{i} = \\epsilon \\ll 1$，这证明了进行漂移简化和忽略回旋相位分辨动力学的合理性。\n\n在这些条件下，用于描述边缘区域类似交换模的团块运动的二维漂移流体模型在主导阶上是自洽的。需要注意的是，平行方向的动力学（例如，沿磁力线的鞘层损失）、有限的碰撞性以及电磁效应可能会变得显著，具体取决于连接长度、电阻率和 $\\beta$ 值；然而，当主导阶化参数仍然很小且平行方向的变化相对于垂直方向的变化较弱时，这些因素都不会使二维静电漂移流体近似失效。因此，对于给定的参数集，二维漂移流体描述在其由 $\\epsilon\\ll 1$ 控制的标准渐近区域内是有效的，计算出的 $\\epsilon$ 值为此提供了定量的证明。",
            "answer": "$$\\boxed{\\begin{pmatrix}3.956 \\times 10^{-4} \\ 1.978 \\times 10^{-2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在验证了模型的适用性之后，下一步自然是着手实现其核心动力学。等离子体团块的演化主要由涡量方程描述，该方程平衡了非线性平流、曲率驱动的交换不稳定性以及耗散效应。这个实践练习  将指导你完成对这一基本偏微分方程的离散化和实现过程，从而将团块运动的物理原理转化为具体的计算算法。",
            "id": "4200180",
            "problem": "你的任务是，在一个板状几何中，为一个冷离子、等温电子团块实现交换驱动涡度动力学的二维离散计算。目标是使用一个简化但科学上一致的模型，在均匀周期性笛卡尔网格上计算涡度场的时间导数，记为 $\\partial_t \\Omega$。\n\n物理和数学背景如下。\n\n- 几何与归一化：假设一个板状等离子体与均匀磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ 对齐，并在垂直于 $\\mathbf{B}$ 的平面内使用静电、漂移简化、二维的动力学模型。所有物理量均以玻姆单位进行归一化，即长度以离子声回旋半径 $\\rho_s$ 归一化，时间以离子回旋频率的倒数归一化，电势以热能 $T_e/e$ 归一化。因此，所有场都是无量纲的。\n\n- 场：模拟中涉及的场为密度 $n(x,y)$、静电势 $\\phi(x,y)$ 和涡度 $\\Omega(x,y)$。涡度由极化闭合关系 $\\Omega = \\nabla_\\perp^2 \\phi$ 定义，其中 $\\nabla_\\perp^2 = \\partial_x^2 + \\partial_y^2$ 是垂直拉普拉斯算子。\n\n- 电子热力学：电子是等温的，在归一化单位下，压强为 $p(x,y) = n(x,y)$。\n\n- 动力学：垂直流体速度是跨场（电场叉磁场）漂移 $\\mathbf{v}_E = \\hat{\\mathbf{z}} \\times \\nabla \\phi$。交换曲率驱动通过作用于压强的曲率算子引入，其模型为 $\\mathcal{K}(p) = \\kappa \\,\\partial_y p$，其中 $\\kappa$ 是一个常数曲率参数。一个线性粘性阻尼项 $-\\nu \\Omega$ 用于模拟耗散汇。\n\n- 目标：基于这些基础，推导出用场 $n$ 和 $\\phi$、它们的空间导数、作用于 $p$ 的曲率算子以及阻尼来表示 $\\partial_t \\Omega$ 的表达式。然后，使用二阶中心有限差分法计算空间导数，在均匀周期性网格上实现 $\\partial_t \\Omega$ 的离散计算。\n\n- 离散算子和边界条件：\n  1. 使用一个尺寸为 $L_x \\times L_y$ 的矩形区域，该区域被 $N_x \\times N_y$ 个点离散化，均匀间距为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。\n  2. 对所有离散空间导数，在两个方向上都实现周期性边界条件。\n  3. 使用带周期性环绕的二阶中心差分计算梯度。对于一个场 $f$，相应地定义 $\\partial_x f$ 和 $\\partial_y f$。\n  4. 使用带周期性环绕的二阶中心差分计算垂直拉普拉斯算子 $\\nabla_\\perp^2 f$。\n  5. 使用上述离散梯度计算泊松括号（非线性平流）$\\{\\phi, \\Omega\\} = \\partial_x \\phi \\, \\partial_y \\Omega - \\partial_y \\phi \\, \\partial_x \\Omega$。\n\n- 最终要求量：对于下面描述的每个测试用例，计算初始时刻的离散场 $\\partial_t \\Omega(x,y)$，并报告其在整个区域内的均方根（RMS）幅值，定义为\n  $$\\mathrm{RMS}(\\partial_t \\Omega) = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} \\left( \\partial_t \\Omega_{i,j} \\right)^2 }.$$\n\n- 答案的单位：所有量都是无量纲的。将每个RMS值报告为浮点数。\n\n- 测试套件和参数说明：\n  为以下四个测试用例实现计算。对于每个用例，在网格上构建场 $n(x,y)$ 和 $\\phi(x,y)$，并按要求计算 $\\partial_t \\Omega$ 及其RMS值。\n\n  所有用例的通用网格参数：\n  - 区域尺寸：$L_x = 40$，$L_y = 40$。\n  - 网格分辨率：$N_x = 64$，$N_y = 64$。\n\n  用例1（带曲率和弱阻尼的一般团块）：\n  - 曲率参数：$\\kappa = 0.02$。\n  - 阻尼参数：$\\nu = 0.005$。\n  - 团块参数：$A = 1.0$，$\\sigma = 5.0$，$x_0 = L_x/2$，$y_0 = L_y/2$。\n  - 场：$\\phi(x,y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{\\sigma^2}\\right)$，以及 $n(x,y) = \\phi(x,y)$。\n\n  用例2（均匀零场）：\n  - 曲率参数：$\\kappa = 0.02$。\n  - 阻尼参数：$\\nu = 0.005$。\n  - 场：$\\phi(x,y) = 0$ 和 $n(x,y) = 0$ 在所有位置。\n\n  用例3（仅曲率驱动，正弦密度，无电势）：\n  - 曲率参数：$\\kappa = 0.05$。\n  - 阻尼参数：$\\nu = 0.0$。\n  - 场：$\\phi(x,y) = 0$ 在所有位置，以及 $n(x,y) = 1.0 + \\sin\\left(\\frac{2\\pi y}{L_y}\\right)$。\n\n  用例4（带强阻尼的一般团块）：\n  - 曲率参数：$\\kappa = 0.02$。\n  - 阻尼参数：$\\nu = 0.5$。\n  - 团块参数：$A = 1.0$，$\\sigma = 5.0$，$x_0 = L_x/2$，$y_0 = L_y/2$。\n  - 场：$\\phi(x,y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{\\sigma^2}\\right)$，以及 $n(x,y) = \\phi(x,y)$。\n\n- 最终输出格式：你的程序应生成单行输出，其中包含四个RMS值，以逗号分隔并用方括号括起来（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$）。每个RMS值必须是浮点数。\n\n本问题要求你从上述物理和数学基础出发，推导出 $\\partial_t \\Omega$ 的离散表达式，该表达式需考虑 $\\mathbf{v}_E$ 引起的非线性平流、曲率驱动 $\\mathcal{K}(p)$ 和阻尼项，然后为指定的测试套件进行数值实现。在整个过程中必须保持使用无量纲单位，并且在计算空间导数时必须在两个方向上应用周期性边界条件。最终输出必须严格遵守指定的单行格式，结果按用例1到4的顺序排列。",
            "solution": "该问题陈述已经过验证，被确定为具有科学依据、提法恰当且内容完整。因此，我们可以进行推导和求解。\n\n目标是为一个简化的交换驱动等离子体湍流模型计算涡度场的时间导数 $\\partial_t \\Omega$。该模型定义在一个垂直于均匀磁场 $\\mathbf{B}$ 的二维板状几何中。所有物理量都是无量纲的，以玻姆归一化单位表示。\n\n在该系统中，涡度 $\\Omega$ 演化的控制方程可以从基本的等离子体流体方程推导得出，但就本问题的范围而言，我们从包含指定物理效应的标准简化涡度方程开始。该方程描述了某一点的涡度如何因平流、曲率驱动的交换不稳定性以及耗散而随时间变化。\n\n涡度的全时间导数，也称为物质导数，由下式给出：\n$$\n\\frac{d\\Omega}{dt} = \\frac{\\partial \\Omega}{\\partial t} + (\\mathbf{v}_E \\cdot \\nabla) \\Omega\n$$\n在此，$\\frac{\\partial \\Omega}{\\partial t}$ 是我们旨在计算的局域时间导数，而 $(\\mathbf{v}_E \\cdot \\nabla) \\Omega$ 是平流导数，代表涡度随流体流动的输运。流体速度是 $\\mathbf{E} \\times \\mathbf{B}$ 漂移，在归一化单位下由 $\\mathbf{v}_E = \\hat{\\mathbf{z}} \\times \\nabla \\phi$ 给出。具体来说，当 $\\nabla \\phi = (\\partial_x \\phi)\\hat{\\mathbf{x}} + (\\partial_y \\phi)\\hat{\\mathbf{y}}$ 时，速度分量为 $v_x = \\partial_y \\phi$ 和 $v_y = -\\partial_x \\phi$。因此，平流项为：\n$$\n(\\mathbf{v}_E \\cdot \\nabla) \\Omega = v_x \\frac{\\partial \\Omega}{\\partial x} + v_y \\frac{\\partial \\Omega}{\\partial y} = (\\partial_y \\phi)(\\partial_x \\Omega) - (\\partial_x \\phi)(\\partial_y \\Omega)\n$$\n问题将泊松括号定义为 $\\{\\phi, \\Omega\\} = \\partial_x \\phi \\, \\partial_y \\Omega - \\partial_y \\phi \\, \\partial_x \\Omega$。通过比较，我们发现 $(\\mathbf{v}_E \\cdot \\nabla) \\Omega = -\\{\\phi, \\Omega\\}$。\n\n涡度演化方程将此物质导数与源项和汇项相平衡。问题指定了两个这样的项：\n1. 一个由交换驱动产生的源项，通过作用于压强 $p$ 的曲率算子 $\\mathcal{K}(p)$ 建模。当 $p=n$（等温电子）且 $\\mathcal{K}(p) = \\kappa \\, \\partial_y p$ 时，此项为 $\\kappa \\, \\partial_y n$。\n2. 一个代表粘性耗散的汇项，建模为线性阻尼 $-\\nu \\Omega$。\n\n综合这些要素，涡度演化方程为：\n$$\n\\frac{d\\Omega}{dt} = \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\n代入物质导数的展开式：\n$$\n\\frac{\\partial \\Omega}{\\partial t} + (\\mathbf{v}_E \\cdot \\nabla) \\Omega = \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\n使用关系式 $(\\mathbf{v}_E \\cdot \\nabla) \\Omega = -\\{\\phi, \\Omega\\}$：\n$$\n\\frac{\\partial \\Omega}{\\partial t} - \\{\\phi, \\Omega\\} = \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\n求解局域时间导数 $\\partial_t \\Omega$ 可得待实现的最终连续方程：\n$$\n\\partial_t \\Omega = \\{\\phi, \\Omega\\} + \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\n涡度 $\\Omega$ 本身不是一个独立的场，而是通过极化闭合关系 $\\Omega = \\nabla_\\perp^2 \\phi$ 定义的。\n\n接下来，我们在一个尺寸为 $L_x \\times L_y$、包含 $N_x \\times N_y$ 个点的均匀笛卡尔网格上对该方程进行离散化。网格间距为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。一个场 $f(x,y)$ 由其在网格点 $(x_i, y_j) = (i\\Delta x, j\\Delta y)$ 上的值 $f_{i,j}$ 表示，其中 $i \\in \\{0, \\dots, N_x-1\\}$，$j \\in \\{0, \\dots, N_y-1\\}$。\n\n我们对所有空间导数使用二阶中心有限差分法，并实现周期性边界条件。对于一个场 $f_{i,j}$：\n关于 $x$ 的偏导数为：\n$$\n(\\partial_x f)_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x}\n$$\n关于 $y$ 的偏导数为：\n$$\n(\\partial_y f)_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y}\n$$\n垂直拉普拉斯算子 $\\nabla_\\perp^2 = \\partial_x^2 + \\partial_y^2$ 为：\n$$\n(\\nabla_\\perp^2 f)_{i,j} \\approx \\frac{f_{i+1,j} - 2f_{i,j} + f_{i-1,j}}{(\\Delta x)^2} + \\frac{f_{i,j+1} - 2f_{i,j} + f_{i,j-1}}{(\\Delta y)^2}\n$$\n通过环绕索引来强制实现周期性，例如，$f_{N_x,j} = f_{0,j}$ 和 $f_{-1,j} = f_{N_x-1,j}$。\n\n计算算法如下：\n1. 对每个测试用例，定义参数并在 $N_x \\times N_y$ 网格上构建离散初始场 $\\phi_{i,j}$ 和 $n_{i,j}$。\n2. 使用有限差分拉普拉斯算子计算离散涡度场：$\\Omega_{i,j} = (\\nabla_\\perp^2 \\phi)_{i,j}$。\n3. 使用有限差分梯度算子计算所需的一阶空间导数：$(\\partial_x\\phi)_{i,j}$、$(\\partial_y\\phi)_{i,j}$、$(\\partial_x\\Omega)_{i,j}$、$(\\partial_y\\Omega)_{i,j}$ 和 $(\\partial_y n)_{i,j}$。\n4. 对每个网格点 $(i,j)$，组装涡度的离散时间导数 $(\\partial_t \\Omega)_{i,j}$：\n$$\n(\\partial_t \\Omega)_{i,j} = \\left( (\\partial_x \\phi)_{i,j} (\\partial_y \\Omega)_{i,j} - (\\partial_y \\phi)_{i,j} (\\partial_x \\Omega)_{i,j} \\right) + \\kappa (\\partial_y n)_{i,j} - \\nu \\Omega_{i,j}\n$$\n5. 计算所得 $(\\partial_t \\Omega)_{i,j}$ 场在整个区域上的均方根（RMS）幅值：\n$$\n\\mathrm{RMS}(\\partial_t \\Omega) = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} \\left( (\\partial_t \\Omega)_{i,j} \\right)^2 }\n$$\n将此过程应用于四个指定的测试用例中的每一个，以获得最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMS of the time derivative of vorticity for four test cases\n    based on a simplified model of plasma interchange turbulence.\n    \"\"\"\n\n    # Common grid parameters for all cases\n    Lx, Ly = 40.0, 40.0\n    Nx, Ny = 64, 64\n    dx, dy = Lx / Nx, Ly / Ny\n\n    # Test suite and parameter specification\n    test_cases = [\n        # Case 1: General blob with curvature and weak damping\n        {'kappa': 0.02, 'nu': 0.005, 'case_type': 'gaussian_blob', 'A': 1.0, 'sigma': 5.0},\n        # Case 2: Uniform zero fields\n        {'kappa': 0.02, 'nu': 0.005, 'case_type': 'zero_fields'},\n        # Case 3: Curvature-only drive with sinusoidal density\n        {'kappa': 0.05, 'nu': 0.0, 'case_type': 'sinusoidal_density'},\n        # Case 4: General blob with strong damping\n        {'kappa': 0.02, 'nu': 0.5, 'case_type': 'gaussian_blob', 'A': 1.0, 'sigma': 5.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        # 1. Set up grid\n        x = np.linspace(0, Lx, Nx, endpoint=False)\n        y = np.linspace(0, Ly, Ny, endpoint=False)\n        X, Y = np.meshgrid(x, y, indexing='ij')\n\n        # 2. Define finite difference operators with periodic boundaries\n        def grad_x(f):\n            return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * dx)\n\n        def grad_y(f):\n            return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * dy)\n\n        def laplacian(f):\n            d2f_dx2 = (np.roll(f, -1, axis=0) - 2 * f + np.roll(f, 1, axis=0)) / (dx**2)\n            d2f_dy2 = (np.roll(f, -1, axis=1) - 2 * f + np.roll(f, 1, axis=1)) / (dy**2)\n            return d2f_dx2 + d2f_dy2\n\n        # 3. Construct initial fields n(x,y) and phi(x,y)\n        phi = np.zeros((Nx, Ny))\n        n = np.zeros((Nx, Ny))\n        case_type = params['case_type']\n\n        if case_type == 'gaussian_blob':\n            A = params['A']\n            sigma = params['sigma']\n            x0, y0 = Lx / 2, Ly / 2\n            blob = A * np.exp(-((X - x0)**2 + (Y - y0)**2) / sigma**2)\n            phi = blob\n            n = blob\n        elif case_type == 'zero_fields':\n            # Fields are already initialized to zero\n            pass\n        elif case_type == 'sinusoidal_density':\n            phi = np.zeros((Nx, Ny))\n            n = 1.0 + np.sin(2 * np.pi * Y / Ly)\n\n        # 4. Compute d(Omega)/dt\n        kappa = params['kappa']\n        nu = params['nu']\n\n        # Compute vorticity Omega = laplacian(phi)\n        Omega = laplacian(phi)\n\n        # Compute terms for the Poisson bracket {phi, Omega}\n        dphi_dx = grad_x(phi)\n        dphi_dy = grad_y(phi)\n        dOmega_dx = grad_x(Omega)\n        dOmega_dy = grad_y(Omega)\n        poisson_bracket = dphi_dx * dOmega_dy - dphi_dy * dOmega_dx\n\n        # Compute curvature drive term\n        dn_dy = grad_y(n)\n        curvature_term = kappa * dn_dy\n\n        # Compute damping term\n        damping_term = -nu * Omega\n\n        # Assemble the time derivative of vorticity\n        dOmega_dt = poisson_bracket + curvature_term + damping_term\n\n        # 5. Calculate the domain-wide RMS magnitude\n        rms_val = np.sqrt(np.mean(dOmega_dt**2))\n        results.append(rms_val)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然二维模型为我们提供了深刻的见解，但真实的等离子体团块是三维结构，它们沿着磁力线与偏滤器等物质表面相连。这种连接通过鞘层边界条件来建模，它不仅闭合了平行电流回路，还引入了一个关键的能量和粒子损失机制。更重要的是，这些边界条件导致了平行模式（以平行波数 $k_\\parallel$ 表征）的量子化。在这个高级练习中 ，你将推导并数值求解决定平行波数谱的超越方程，这是构建更真实的磁通管模拟的关键一步。",
            "id": "4200239",
            "problem": "考虑一个用于磁约束聚变装置中边缘等离子体团块和丝状输运的简化磁通管模型。设局域标准正交坐标为 $(x,y,z)$，其中 $z$ 是沿磁力线的坐标，$y$ 是副法线方向。假设存在标量势为 $\\phi(y,z)$ 的静电涨落，以及具有均匀平行电导率 $\\sigma_\\parallel$ 的简化平行闭合模型。在 $y$ 方向上施加周期性边界条件，并在平行两端 $z=\\pm L_\\parallel/2$ 处施加线性化鞘层边界条件。\n\n基本依据：\n- 使用电阻极限下广义欧姆定律的平行电流闭合，$E_\\parallel=\\eta\\,j_\\parallel$，其中 $\\eta=1/\\sigma_\\parallel$ 且 $E_\\parallel=-\\partial\\phi/\\partial z$，因此\n$$\nj_\\parallel(z)=-\\sigma_\\parallel\\,\\frac{\\partial\\phi}{\\partial z}(z).\n$$\n- 使用等温电子的线性化 Bohm 鞘层电流，该理论指出，进入鞘层的净平行电流密度与鞘层入口处的静电势成正比，\n$$\nj_s(z=\\pm L_\\parallel/2)=\\pm \\frac{n_0 e^2 c_s}{T_e}\\,\\phi\\big|_{z=\\pm L_\\parallel/2},\n$$\n其中 $n_0$ 是背景密度，$e$ 是基本电荷，$c_s$ 是离子声速，$T_e$ 是以焦耳表示的电子温度。如果 $T_e$ 以电子伏特为单位，则使用 $T_e[\\mathrm{J}]=e\\,T_e[\\mathrm{eV}]$。\n\n通过将两端的平行电流与鞘层电流相等，推导在 $z=\\pm L_\\parallel/2$ 处关于 $\\phi$ 的 Robin 边界条件，\n$$\n\\frac{\\partial\\phi}{\\partial z}\\Big|_{z=+L_\\parallel/2}=-\\lambda\\,\\phi\\Big|_{z=+L_\\parallel/2},\\quad\n\\frac{\\partial\\phi}{\\partial z}\\Big|_{z=-L_\\parallel/2}=+\\lambda\\,\\phi\\Big|_{z=-L_\\parallel/2},\n$$\n其中鞘层导纳参数为\n$$\n\\lambda=\\frac{n_0 e^2 c_s}{T_e\\,\\sigma_\\parallel}=\\frac{n_0 e c_s}{T_e[\\mathrm{eV}]\\,\\sigma_\\parallel}.\n$$\n\n假设变量分离的平行本征模可解沿场的一维 Helmholtz 问题：\n$$\n\\frac{d^2\\phi}{dz^2}+k_\\parallel^2\\,\\phi=0\\quad\\text{for}\\quad z\\in\\left[-\\frac{L_\\parallel}{2},\\,+\\frac{L_\\parallel}{2}\\right]\n$$\n并服从上述在 $z=\\pm L_\\parallel/2$ 处的 Robin 边界条件。证明允许的平行波数 $k_\\parallel$ 满足两个超越方程族，\n$$\n\\text{偶模:}\\quad k_\\parallel\\,\\tan\\!\\left(k_\\parallel\\,\\frac{L_\\parallel}{2}\\right)=\\lambda,\n$$\n$$\n\\text{奇模:}\\quad -k_\\parallel\\,\\cot\\!\\left(k_\\parallel\\,\\frac{L_\\parallel}{2}\\right)=\\lambda.\n$$\n在 $y$ 方向上，长度为 $L_y$ 的区域上的周期性边界条件意味着离散的副法线波数\n$$\nk_y=\\frac{2\\pi m}{L_y},\\quad m\\in\\mathbb{Z}.\n$$\n虽然 $k_y$ 不直接进入上述平行量子化过程，但在程序设计中应实现其周期性。\n\n任务：\n- 从上述基本依据出发，推导 $k_\\parallel$ 的量子化条件，并设计一个算法来数值计算前 $N$ 个最小的正值允许 $k_\\parallel$（单位为 $\\mathrm{m}^{-1}$）。这些值通过求解偶模和奇模族的超越方程，然后合并和排序得到。\n- 你的程序必须为测试套件中的每个参数集计算这些值，并输出包含汇总结果的单行文本。\n\n单位和输出要求：\n- 所有物理输入必须使用国际单位制 (SI)；使用以电子伏特为单位的 $T_e$，并通过 $T_e[\\mathrm{J}]=e\\,T_e[\\mathrm{eV}]$（其中 $e$ 的单位为库仑）在内部转换为焦耳。\n- 将每个 $k_\\parallel$ 以 $\\mathrm{m}^{-1}$ 为单位表示为浮点数。\n- 最终输出格式必须是单行：一个逗号分隔的 Python 风格的浮点数列表的列表，每个测试用例对应一个内部列表，并用方括号括起来。例如：$[\\,[k_1,k_2,\\dots],\\,[\\dots],\\,[\\dots]\\,]$。\n\n测试套件：\n使用以下三个科学上合理的参数集来测试不同的鞘层导纳区域：\n1. 情况 A（近 Neumann 鞘层，小 $\\lambda$）：$L_\\parallel=20\\,\\mathrm{m}$，$L_y=1\\,\\mathrm{m}$，$n_0=1.0\\times 10^{19}\\,\\mathrm{m}^{-3}$，$T_e=20\\,\\mathrm{eV}$，$c_s=2.0\\times 10^{4}\\,\\mathrm{m/s}$，$\\sigma_\\parallel=1.0\\times 10^{7}\\,\\mathrm{S/m}$，$N=4$。\n2. 情况 B（中等鞘层导纳）：$L_\\parallel=20\\,\\mathrm{m}$，$L_y=1\\,\\mathrm{m}$，$n_0=1.0\\times 10^{19}\\,\\mathrm{m}^{-3}$，$T_e=20\\,\\mathrm{eV}$，$c_s=2.0\\times 10^{4}\\,\\mathrm{m/s}$，$\\sigma_\\parallel=1.0\\times 10^{4}\\,\\mathrm{S/m}$，$N=4$。\n3. 情况 C（强鞘层，大 $\\lambda$）：$L_\\parallel=20\\,\\mathrm{m}$，$L_y=1\\,\\mathrm{m}$，$n_0=1.0\\times 10^{19}\\,\\mathrm{m}^{-3}$，$T_e=20\\,\\mathrm{eV}$，$c_s=2.0\\times 10^{4}\\,\\mathrm{m/s}$，$\\sigma_\\parallel=1.0\\times 10^{2}\\,\\mathrm{S/m}$，$N=4$。\n\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的 $N$ 个最小正 $k_\\parallel$ 值（单位为 $\\mathrm{m}^{-1}$）作为一个内部列表，并按升序排列。例如：$[[k_{\\parallel,1},k_{\\parallel,2},k_{\\parallel,3},k_{\\parallel,4}],[\\dots],[\\dots]]$。",
            "solution": "问题陈述经过严格评估，被确定为有效。它在科学上基于一个简化但标准的等离子体-鞘层相互作用模型，问题定义明确、客观且自洽。所有必要的参数和物理定律都已提供，足以构建和解决该问题。\n\n任务是找到前 $N$ 个最小的正平行波数 $k_\\parallel$，这些波数在沿长度为 $L_\\parallel$ 的磁力线的等离子体输运简化模型中满足一组边界条件。静电势 $\\phi(z)$ 的控制方程是一维 Helmholtz 方程：\n$$\n\\frac{d^2\\phi}{dz^2} + k_\\parallel^2\\,\\phi = 0, \\quad z \\in \\left[-\\frac{L_\\parallel}{2}, +\\frac{L_\\parallel}{2}\\right]\n$$\n问题陈述指出，平行电流 $j_\\parallel = -\\sigma_\\parallel \\frac{\\partial\\phi}{\\partial z}$ 必须与两端材料鞘层收集的电流 $j_s = \\pm \\frac{n_0 e c_s}{T_e[\\mathrm{eV}]\\,\\sigma_\\parallel} \\phi$ 相匹配，其中 $\\pm$ 符号对应于 $z=\\pm L_\\parallel/2$。令这些电流相等可得到 Robin 边界条件：\n$$\n\\frac{\\partial\\phi}{\\partial z}\\Big|_{z=+L_\\parallel/2} = -\\lambda\\,\\phi\\Big|_{z=+L_\\parallel/2}\n$$\n$$\n\\frac{\\partial\\phi}{\\partial z}\\Big|_{z=-L_\\parallel/2} = +\\lambda\\,\\phi\\Big|_{z=-L_\\parallel/2}\n$$\n其中鞘层导纳参数为 $\\lambda = \\frac{n_0 e c_s}{T_e[\\mathrm{eV}]\\,\\sigma_\\parallel}$。\n\n为推导 $k_\\parallel$ 的量子化条件，我们从 Helmholtz 方程的通解开始，该通解可以表示为偶函数和奇函数的叠加：\n$$\n\\phi(z) = A \\cos(k_\\parallel z) + B \\sin(k_\\parallel z)\n$$\n其中 $A$ 和 $B$ 是常数。其导数为：\n$$\n\\frac{d\\phi}{dz}(z) = -A k_\\parallel \\sin(k_\\parallel z) + B k_\\parallel \\cos(k_\\parallel z)\n$$\n应用这两个边界条件，可以得到关于 $A$ 和 $B$ 的两个线性方程组：\n1. 在 $z = +L_\\parallel/2$ 处：\n$$\n-A k_\\parallel \\sin\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) + B k_\\parallel \\cos\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) = -\\lambda \\left[A \\cos\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) + B \\sin\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right)\\right]\n$$\n2. 在 $z = -L_\\parallel/2$ 处：\n$$\n-A k_\\parallel \\sin\\left(-k_\\parallel \\frac{L_\\parallel}{2}\\right) + B k_\\parallel \\cos\\left(-k_\\parallel \\frac{L_\\parallel}{2}\\right) = \\lambda \\left[A \\cos\\left(-k_\\parallel \\frac{L_\\parallel}{2}\\right) + B \\sin\\left(-k_\\parallel \\frac{L_\\parallel}{2}\\right)\\right]\n$$\n利用 $\\sin(-x) = -\\sin(x)$ 和 $\\cos(-x) = \\cos(x)$ 的性质，第二个方程简化为：\n$$\nA k_\\parallel \\sin\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) + B k_\\parallel \\cos\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) = \\lambda \\left[A \\cos\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) - B \\sin\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right)\\right]\n$$\n通过分别考虑偶解和奇解，该方程组可以解耦。\n\n对于偶模，我们有 $\\phi(-z) = \\phi(z)$，这要求 $B=0$。解为 $\\phi(z) = A \\cos(k_\\parallel z)$。将 $B=0$ 代入任一边界条件方程（它们会变得相同），对于非平凡解（$A \\neq 0$）可得：\n$$\n-A k_\\parallel \\sin\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) = -\\lambda A \\cos\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right)\n$$\n$$\nk_\\parallel \\tan\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) = \\lambda\n$$\n这就是偶模族的超越方程。\n\n对于奇模，我们有 $\\phi(-z) = -\\phi(z)$，这要求 $A=0$。解为 $\\phi(z) = B \\sin(k_\\parallel z)$。将 $A=0$ 代入任一边界条件方程，对于非平凡解（$B \\neq 0$）可得：\n$$\nB k_\\parallel \\cos\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) = -\\lambda B \\sin\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right)\n$$\n$$\nk_\\parallel \\cot\\left(k_\\parallel \\frac{L_\\parallel}{2}\\right) = -\\lambda\n$$\n这等价于 $-k_\\parallel \\cot(k_\\parallel \\frac{L_\\parallel}{2}) = \\lambda$，即奇模族的超越方程。\n\n寻找前 $N$ 个最小正 $k_\\parallel$ 值的算法设计涉及数值求解这两个超越方程。\n1. 对每个参数集，使用给定的公式和物理常数计算鞘层导纳 $\\lambda$。\n2. 可以通过寻找函数 $f_{\\text{even}}(k_\\parallel) = k_\\parallel \\tan(k_\\parallel L_\\parallel/2) - \\lambda$ 和 $f_{\\text{odd}}(k_\\parallel) = -k_\\parallel \\cot(k_\\parallel L_\\parallel/2) - \\lambda$ 的零点来找到超越方程的根。\n3. 通过分析正切和余切函数的行为来系统地定位根。\n   - 对于偶模，方程 $k_\\parallel \\tan(k_\\parallel L_\\parallel/2) = \\lambda$（其中 $\\lambda>0$）的根存在于区间 $k_\\parallel \\in [2n\\pi/L_\\parallel, (2n+1)\\pi/L_\\parallel]$ 中，其中 $n=0, 1, 2, \\dots$。\n   - 对于奇模，方程 $-k_\\parallel \\cot(k_\\parallel L_\\parallel/2) = \\lambda$（其中 $\\lambda>0$）的根存在于区间 $k_\\parallel \\in [(2n-1)\\pi/L_\\parallel, 2n\\pi/L_\\parallel]$ 中，其中 $n=1, 2, 3, \\dots$。\n4. 像 Brent-Dekker 方法 (`scipy.optimize.brentq`) 这样的数值求根算法非常适合在函数变号的指定区间内寻找根。我们在上述确定的区间内为每个根划定范围，并稍微缩小区间以避免边界处的奇点。\n5. 为了获得前 $N$ 个最小的正波数，我们从偶模和奇模族中生成足够数量的根（例如，为保证稳健性，从每个族中生成 $N$ 个根）。\n6. 将从两个族中收集到的根合并到一个列表中。\n7. 列表按升序排序。\n8. 排序后列表的前 $N$ 个元素就是所需的解。对每个测试用例重复此过程。\n9. 最终的结果集合，一个列表的列表，被格式化为指定的字符串格式。\n如问题陈述中所述，副法线波数 $k_y$ 不进入平行本征模问题，因此在计算中不使用。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the first N smallest positive parallel wavenumbers (k_parallel) \n    for edge plasma blobs based on a simplified flux-tube model with \n    Robin boundary conditions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (near-Neumann sheath, small lambda)\n        {'L_parallel': 20.0, 'n_0': 1.0e19, 'T_e': 20.0, 'c_s': 2.0e4, 'sigma_parallel': 1.0e7, 'N': 4},\n        # Case B (intermediate sheath admittance)\n        {'L_parallel': 20.0, 'n_0': 1.0e19, 'T_e': 20.0, 'c_s': 2.0e4, 'sigma_parallel': 1.0e4, 'N': 4},\n        # Case C (strong sheath, large lambda)\n        {'L_parallel': 20.0, 'n_0': 1.0e19, 'T_e': 20.0, 'c_s': 2.0e4, 'sigma_parallel': 1.0e2, 'N': 4},\n    ]\n\n    # Fundamental constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n\n    all_results = []\n    \n    for case in test_cases:\n        L_p = case['L_parallel']\n        n_0 = case['n_0']\n        T_e_eV = case['T_e']\n        c_s = case['c_s']\n        sigma_p = case['sigma_parallel']\n        N = case['N']\n\n        # Calculate sheath admittance parameter lambda using the given formula for T_e in eV.\n        # lambda = (n_0 * e * c_s) / (T_e[eV] * sigma_parallel)\n        lambda_param = (n_0 * E_CHARGE * c_s) / (T_e_eV * sigma_p)\n        \n        half_L = L_p / 2.0\n        \n        # Define the transcendental equations to be solved for k_parallel (k)\n        def even_mode_eq(k, lam, hL):\n            # Equation: k * tan(k * hL) - lam = 0\n            if abs(k)  1e-12:\n                return -lam\n            return k * np.tan(k * hL) - lam\n\n        def odd_mode_eq(k, lam, hL):\n            # Equation: -k * cot(k * hL) - lam = 0, written as -k / tan(k*hL)\n            tan_val = np.tan(k * hL)\n            if abs(tan_val)  1e-12: # Avoid division by zero at poles of cotangent\n                return np.inf if -k > 0 else -np.inf\n            return -k / tan_val - lam\n\n        # Collect roots from both families\n        even_roots = []\n        odd_roots = []\n        epsilon = 1e-9 # Small value to stay away from singularities\n\n        # Generate enough roots to ensure we get the first N smallest ones after merging\n        num_to_generate = N + 2 \n        \n        # Even modes: roots are in intervals [n*pi/hL, (n+0.5)*pi/hL] for n=0, 1, ...\n        for n in range(num_to_generate):\n            lower_bound = n * np.pi / half_L\n            upper_bound = (n + 0.5) * np.pi / half_L\n            \n            # For lambda_param > 0, the function goes from a negative value to +infinity \n            # in the bracket, guaranteeing a root.\n            try:\n                root = brentq(even_mode_eq, lower_bound, upper_bound - epsilon, args=(lambda_param, half_L))\n                even_roots.append(root)\n            except ValueError:\n                # This may happen if the function doesn't cross zero in the bracket,\n                # which shouldn't occur for lambda_param > 0.\n                pass\n\n        # Odd modes: roots are in intervals [(n-0.5)*pi/hL, n*pi/hL] for n=1, 2, ...\n        for n in range(1, num_to_generate + 1):\n            lower_bound = (n - 0.5) * np.pi / half_L\n            upper_bound = n * np.pi / half_L\n            \n            # The function goes from a negative value to +infinity in the bracket.\n            try:\n                root = brentq(odd_mode_eq, lower_bound + epsilon, upper_bound - epsilon, args=(lambda_param, half_L))\n                odd_roots.append(root)\n            except ValueError:\n                pass\n                \n        # Combine, sort, and take the N smallest positive roots.\n        # The problem asks for the smallest *positive* allowed k_parallel values.\n        all_k = sorted(even_roots + odd_roots)\n        positive_k = [k for k in all_k if k > 1e-12]\n        \n        all_results.append(positive_k[:N])\n\n    # Final print statement in the exact required format.\n    # Format to a string that looks like a Python list of lists, with no spaces.\n    list_of_list_strs = [f\"[{','.join(map(str, sublist))}]\" for sublist in all_results]\n    output_str = f\"[{','.join(list_of_list_strs)}]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}