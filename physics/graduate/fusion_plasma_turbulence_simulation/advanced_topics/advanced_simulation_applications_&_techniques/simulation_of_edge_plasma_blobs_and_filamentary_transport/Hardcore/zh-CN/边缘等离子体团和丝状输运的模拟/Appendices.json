{
    "hands_on_practices": [
        {
            "introduction": "在编写复杂的模拟程序之前，我们必须理解其所依赖的物理近似。对于边缘等离子体团块，二维漂移流体模型是常用的工具，其有效性取决于时空尺度的清晰分离。本练习将通过第一性原理来巩固我们的模拟工作。你将为一组典型的边缘等离子体参数计算基本序参量 $\\epsilon = \\rho_s / L_\\perp$，这不仅能让你练习处理关键的等离子体物理量，还能培养你对简化模型何时以及为何能成为研究复杂湍流的有效工具的直觉。",
            "id": "4200178",
            "problem": "一个位于环形装置中的边缘等离子体团块在强磁场下被建模，其参数为$B=2\\,\\mathrm{T}$，$n=5\\times 10^{19}\\,\\mathrm{m^{-3}}$，$T_{e}=30\\,\\mathrm{eV}$，以及垂直梯度尺度$L_{\\perp}=2\\,\\mathrm{cm}$。假设存在质量为$m_{i}$、电荷为$q_{i}=+e$的单电离氘离子；电子是等温的，温度为$T_{e}$，且等离子体是准中性的。二维（2D）漂移流体描述依赖于一个量级小参数$\\epsilon$，该参数定义为特征垂直微观尺度与宏观梯度尺度之比。\n\n从洛伦兹力作用下的离子运动方程和等温电子动量平衡（忽略电子惯性）出发，推导离子回旋频率和离子声速的表达式，并由此得到定义为离子声速与离子回旋频率之比的离子声回旋半径$\\rho_{s}$。使用这些结果，构建量级参数$\\epsilon=\\rho_{s}/L_{\\perp}$。\n\n然后，使用给定的参数，计算$\\rho_{s}$和$\\epsilon$的数值。将您的数值答案四舍五入至四位有效数字。将$\\rho_{s}$以$\\mathrm{m}$为单位表示，$\\epsilon$作为一个无量纲数。按$\\left[\\rho_{s},\\,\\epsilon\\right]$的顺序，以行矩阵形式提供您的最终数值答案。\n\n最后，基于第一性原理的尺度分离，讨论二维漂移流体描述对于此边缘参数集是否有效，并根据$\\epsilon$的大小和其隐含的动力学时间尺度分离来证明您的结论。您的讨论无需包括已要求之外的额外数值计算。",
            "solution": "目标是从第一性原理出发，计算离子声回旋半径$\\rho_{s}$和量级参数$\\epsilon=\\rho_{s}/L_{\\perp}$。\n\n我们从洛伦兹力作用下的离子运动方程，\n$$\nm_{i}\\,\\frac{d\\boldsymbol{v}_{i}}{dt} = q_{i}\\,\\boldsymbol{v}_{i}\\times \\boldsymbol{B} + q_{i}\\,\\boldsymbol{E} - \\nabla p_{i},\n$$\n和忽略电子惯性的电子动量平衡开始，\n$$\n0 = - e\\,n\\,\\boldsymbol{E} - \\nabla p_{e}.\n$$\n对于$p_{e} = n k_{B} T_{e}$的等温电子，电子动量平衡立即得出\n$$\n\\boldsymbol{E} = -\\frac{1}{e n}\\,\\nabla p_{e} = -\\frac{k_{B} T_{e}}{e}\\,\\nabla\\ln n.\n$$\n离子回旋频率源于洛伦兹力磁场部分作用下的匀速圆周运动，该运动投影在垂直于$\\boldsymbol{B}$的平面上。对于回旋运动，设$\\boldsymbol{E}=\\boldsymbol{0}$并忽略压强，\n$$\nm_{i}\\,\\frac{d\\boldsymbol{v}_{\\perp}}{dt} = q_{i}\\,\\boldsymbol{v}_{\\perp}\\times \\boldsymbol{B},\n$$\n这给出了回旋频率的大小\n$$\n\\Omega_{i} = \\frac{q_{i} B}{m_{i}} = \\frac{e B}{m_{i}}.\n$$\n\n离子声速是通过将离子连续性方程、平行动量方程与等温电子状态方程相结合，从沿磁力线的压缩动力学中获得的。在一维情况下，对于小振幅扰动和冷离子（忽略离子压强），线性化系统变为\n$$\n\\partial_{t} n_{1} + n_{0}\\,\\partial_{x} u_{i1} = 0, \\qquad m_{i}\\,\\partial_{t} u_{i1} = -\\frac{1}{n_{0}}\\,\\partial_{x} p_{e1},\n$$\n其中$p_{e1} = k_{B} T_{e}\\,n_{1}$且准中性条件为$n_{e1}\\approx n_{i1}\\equiv n_{1}$。消去$u_{i1}$得到波动方程$\\partial_{t}^{2} n_{1} = c_{s}^{2}\\,\\partial_{x}^{2} n_{1}$，其中的离子声速为\n$$\nc_{s} = \\sqrt{\\frac{k_{B} T_{e}}{m_{i}}}.\n$$\n由于$T_{e}$是以电子伏特为单位给出的，我们使用$k_{B} T_{e} = e\\,T_{e}$，得到\n$$\nc_{s} = \\sqrt{\\frac{e\\,T_{e}}{m_{i}}}.\n$$\n\n根据定义，离子声回旋半径是离子声速与离子回旋频率的比值，\n$$\n\\rho_{s} \\equiv \\frac{c_{s}}{\\Omega_{i}} = \\frac{\\sqrt{e\\,T_{e}/m_{i}}}{e B/m_{i}} = \\frac{\\sqrt{m_{i}\\,e\\,T_{e}}}{e\\,B}.\n$$\n量级参数为\n$$\n\\epsilon = \\frac{\\rho_{s}}{L_{\\perp}}.\n$$\n\n我们现在用给定的参数计算数值。令单电离氘离子的质量为$m_{i} = 2\\,m_{p}$，其中$m_{p}$是质子质量，$q_{i}=e$是元电荷。使用标准值$e = 1.602176634\\times 10^{-19}\\,\\text{C}$，$m_{p} = 1.67262192369\\times 10^{-27}\\,\\text{kg}$，我们有\n$$\nm_{i} = 2\\,m_{p} = 3.34524384738\\times 10^{-27}\\,\\text{kg}.\n$$\n当$T_{e}=30\\,\\text{eV}$，$B=2\\,\\text{T}$以及$L_{\\perp} = 2\\,\\mathrm{cm} = 2.0\\times 10^{-2}\\,\\mathrm{m}$时，计算\n$$\nc_{s} = \\sqrt{\\frac{e T_{e}}{m_{i}}} = \\sqrt{\\frac{1.602176634\\times 10^{-19}\\times 30}{3.34524384738\\times 10^{-27}}} \\approx 3.7930\\times 10^{4}\\,\\text{m/s},\n$$\n$$\n\\Omega_{i} = \\frac{e B}{m_{i}} = \\frac{1.602176634\\times 10^{-19}\\times 2}{3.34524384738\\times 10^{-27}} \\approx 9.5788\\times 10^{7}\\,\\text{rad/s}.\n$$\n因此，\n$$\n\\rho_{s} = \\frac{c_{s}}{\\Omega_{i}} \\approx \\frac{3.7930\\times 10^{4}}{9.5788\\times 10^{7}} \\approx 3.960\\times 10^{-4}\\,\\text{m},\n$$\n和\n$$\n\\epsilon = \\frac{\\rho_{s}}{L_{\\perp}} = \\frac{3.960\\times 10^{-4}}{2.0\\times 10^{-2}} \\approx 1.980\\times 10^{-2}.\n$$\n四舍五入到四位有效数字后，这些即为所要求的值。\n\n最后，我们讨论二维（2D）漂移流体描述的有效性。漂移流体模型基于一个小参数的渐近展开，该参数衡量了微观回旋半径尺度与宏观梯度尺度的比率，同时该模型还基于慢漂移/交换动力学与快回旋运动之间的时间尺度分离。这里的小参数是$\\epsilon = \\rho_{s}/L_{\\perp}$。由于$\\epsilon \\approx 1.980\\times 10^{-2}$，我们有$\\epsilon \\ll 1$，这表明：\n- 长度尺度分离：$\\,\\rho_{s} \\ll L_{\\perp}$，因此在离子声回旋半径尺度上，垂直梯度是平滑的，漂移标度是合适的。\n- 时间尺度分离：特征垂直对流频率$\\,\\omega_{\\perp}\\sim c_{s}/L_{\\perp}\\,$比离子回旋频率小，其比值也为$\\epsilon$，即$\\,\\omega_{\\perp}/\\Omega_{i} = \\epsilon \\ll 1\\,$，这证明了漂移简化以及忽略回旋相位分辨动力学的合理性。\n\n在这些条件下，对于边缘区域交换模状团块运动的二维漂移流体描述在主导阶上是一致的。需要注意的是，平行动力学（例如，沿磁力线的鞘层损失）、有限碰撞性以及电磁效应可能会变得显著，这取决于连接长度、电阻率和$\\beta$值；然而，当主导量级参数保持很小且平行变化相对于垂直变化较弱时，这些因素都不会使二维静电漂移流体近似失效。因此，对于给定的参数集，二维漂移流体描述在其由$\\epsilon\\ll 1$控制的标准渐近区域内是有效的，计算出的$\\epsilon$值为此提供了定量上的证明。",
            "answer": "$$\\boxed{\\begin{pmatrix}3.960 \\times 10^{-4}  1.980 \\times 10^{-2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "一旦模型的合理性得到验证，下一步便是将控制偏微分方程转化为数值算法。静电漂移流体模型的核心是涡量演化方程。这项实践将带你从连续的数学描述走向具体的计算实现。你将对二维涡量方程进行离散化和编码，其中包含了非线性平流项和曲率驱动的交换项，正是这些项驱动了等离子体团块的形成和传播。这个动手编码练习让你能直接了解研究代码是如何模拟团块动力学的。",
            "id": "4200180",
            "problem": "您的任务是在板状几何中，为一个冷离子、等温电子团块，实现交换驱动的涡度动力学的二维离散计算。目标是使用一个简化但科学上一致的模型，在均匀的周期性笛卡尔网格上计算涡度场的时间导数，记为 $\\partial_t \\Omega$。\n\n物理和数学背景设置如下。\n\n- 几何与归一化：假设一个板状等离子体与均匀磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ 对齐，并使用垂直于 $\\mathbf{B}$ 的平面内的静电、漂移简化、二维动力学模型。所有物理量均以玻姆（Bohm）单位进行归一化，即长度以离子声回旋半径 $\\rho_s$ 为单位，时间以离子回旋频率的倒数为单位，电势以热能 $T_e/e$ 为单位。因此，所有场都是无量纲的。\n\n- 场：模拟中涉及的场为密度 $n(x,y)$、静电势 $\\phi(x,y)$ 和涡度 $\\Omega(x,y)$。涡度由极化闭合关系 $\\Omega = \\nabla_\\perp^2 \\phi$ 定义，其中 $\\nabla_\\perp^2 = \\partial_x^2 + \\partial_y^2$ 是垂直拉普拉斯算子。\n\n- 电子热力学：电子是等温的，在归一化单位下，压强为 $p(x,y) = n(x,y)$。\n\n- 动力学：垂直流体速度是跨场（电场叉乘磁场）漂移 $\\mathbf{v}_E = \\hat{\\mathbf{z}} \\times \\nabla \\phi$。交换曲率驱动通过作用于压强的曲率算子引入，其模型为 $\\mathcal{K}(p) = \\kappa \\,\\partial_y p$，其中 $\\kappa$ 是一个常数曲率参数。一个线性粘性阻尼项 $-\\nu \\Omega$ 用于模拟耗散汇。\n\n- 目标：基于以上基础，推导出 $\\partial_t \\Omega$ 关于场 $n$ 和 $\\phi$、它们的空间导数、作用于 $p$ 的曲率算子以及阻尼的表达式。然后，使用二阶中心有限差分计算空间导数，在均匀周期性网格上实现 $\\partial_t \\Omega$ 的离散计算。\n\n- 离散算子和边界条件：\n  1. 使用一个尺寸为 $L_x \\times L_y$ 的矩形区域，该区域由 $N_x \\times N_y$ 个点离散化，均匀间距为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。\n  2. 对所有离散空间导数，在两个方向上都实施周期性边界条件。\n  3. 使用带周期性环绕的二阶中心差分计算梯度。对于一个场 $f$，相应地定义 $\\partial_x f$ 和 $\\partial_y f$。\n  4. 使用带周期性环绕的二阶中心差分计算垂直拉普拉斯算子 $\\nabla_\\perp^2 f$。\n  5. 使用上述离散梯度计算泊松括号（非线性平流项）$\\{\\phi, \\Omega\\} = \\partial_x \\phi \\, \\partial_y \\Omega - \\partial_y \\phi \\, \\partial_x \\Omega$。\n\n- 最终要求量：对于下面描述的每个测试用例，计算初始时刻的离散场 $\\partial_t \\Omega(x,y)$，并报告其全域均方根（RMS）大小，定义为\n  $$\\mathrm{RMS}(\\partial_t \\Omega) = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} \\left( \\partial_t \\Omega_{i,j} \\right)^2 }.$$\n\n- 答案的单位：所有量均为无量纲。将每个 RMS 值报告为浮点数。\n\n- 测试套件和参数说明：\n  为以下四个测试用例实现计算。对于每个用例，在网格上构建场 $n(x,y)$ 和 $\\phi(x,y)$，并按要求计算 $\\partial_t \\Omega$ 及其 RMS 值。\n\n  所有用例的通用网格参数：\n  - 区域尺寸：$L_x = 40$，$L_y = 40$。\n  - 网格分辨率：$N_x = 64$，$N_y = 64$。\n\n  用例 1（带曲率和弱阻尼的一般团块）：\n  - 曲率参数：$\\kappa = 0.02$。\n  - 阻尼参数：$\\nu = 0.005$。\n  - 团块参数：$A = 1.0$，$\\sigma = 5.0$，$x_0 = L_x/2$，$y_0 = L_y/2$。\n  - 场：$\\phi(x,y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{\\sigma^2}\\right)$，以及 $n(x,y) = \\phi(x,y)$。\n\n  用例 2（均匀零场）：\n  - 曲率参数：$\\kappa = 0.02$。\n  - 阻尼参数：$\\nu = 0.005$。\n  - 场：$\\phi(x,y) = 0$ 和 $n(x,y) = 0$ 在所有位置。\n\n  用例 3（仅有曲率驱动的正弦密度，无电势）：\n  - 曲率参数：$\\kappa = 0.05$。\n  - 阻尼参数：$\\nu = 0.0$。\n  - 场：$\\phi(x,y) = 0$ 在所有位置，以及 $n(x,y) = 1.0 + \\sin\\left(\\frac{2\\pi y}{L_y}\\right)$。\n\n  用例 4（带强阻尼的一般团块）：\n  - 曲率参数：$\\kappa = 0.02$。\n  - 阻尼参数：$\\nu = 0.5$。\n  - 团块参数：$A = 1.0$，$\\sigma = 5.0$，$x_0 = L_x/2$，$y_0 = L_y/2$。\n  - 场：$\\phi(x,y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{\\sigma^2}\\right)$，以及 $n(x,y) = \\phi(x,y)$。\n\n- 最终输出格式：您的程序应生成单行输出，其中包含四个 RMS 值，形式为用逗号分隔并用方括号括起来的列表（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$）。每个 RMS 值必须是浮点数。\n\n此问题要求您从上面列出的物理和数学基础出发，推导出 $\\partial_t \\Omega$ 的离散表达式，该表达式需考虑由 $\\mathbf{v}_E$ 引起的非线性平流、曲率驱动 $\\mathcal{K}(p)$ 和阻尼项，然后为指定的测试套件进行数值实现。在整个过程中必须保持使用无量纲单位，并且在计算空间导数时必须在两个方向上应用周期性边界条件。最终输出必须严格遵守指定的单行格式，结果按用例 1 到 4 的顺序排列。",
            "solution": "问题陈述已经过验证，被确定为具有科学依据、问题定义良好且完整。因此，我们可以进行推导和求解。\n\n目标是为一个简化的交换驱动等离子体湍流模型计算涡度场的时间导数 $\\partial_t \\Omega$。该模型定义在垂直于均匀磁场 $\\mathbf{B}$ 的二维板状几何中。所有物理量都是无量纲的，以玻姆（Bohm）归一化单位表示。\n\n涡度 $\\Omega$ 演化的控制方程由涡度的全时间导数（物质导数）与源项和汇项的平衡给出：\n$$\n\\frac{d\\Omega}{dt} = \\frac{\\partial \\Omega}{\\partial t} + (\\mathbf{v}_E \\cdot \\nabla) \\Omega = \\mathcal{S}_{\\text{source}} + \\mathcal{S}_{\\text{sink}}\n$$\n在此模型中，源项是曲率驱动，汇项是粘性阻尼。\n$$\n\\frac{\\partial \\Omega}{\\partial t} + (\\mathbf{v}_E \\cdot \\nabla) \\Omega = \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\n流体速度是归一化的 $\\mathbf{E} \\times \\mathbf{B}$ 漂移，$\\mathbf{v}_E = \\hat{\\mathbf{z}} \\times \\nabla \\phi$。其分量为 $v_x = -\\partial_y \\phi$ 和 $v_y = \\partial_x \\phi$。因此，非线性平流项为：\n$$\n(\\mathbf{v}_E \\cdot \\nabla) \\Omega = v_x \\frac{\\partial \\Omega}{\\partial x} + v_y \\frac{\\partial \\Omega}{\\partial y} = (-\\partial_y \\phi)(\\partial_x \\Omega) + (\\partial_x \\phi)(\\partial_y \\Omega) = \\partial_x \\phi \\partial_y \\Omega - \\partial_y \\phi \\partial_x \\Omega\n$$\n这正是问题中定义的泊松括号 $\\{\\phi, \\Omega\\}$。因此，$(\\mathbf{v}_E \\cdot \\nabla) \\Omega = \\{\\phi, \\Omega\\}$。\n\n将此代入涡度方程，我们得到：\n$$\n\\frac{\\partial \\Omega}{\\partial t} + \\{\\phi, \\Omega\\} = \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\n求解我们旨在计算的局部时间导数 $\\partial_t \\Omega$：\n$$\n\\partial_t \\Omega = -\\{\\phi, \\Omega\\} + \\kappa \\, \\partial_y n - \\nu \\Omega\n$$\n涡度 $\\Omega$ 本身不是一个独立的场，而是通过极化闭合关系 $\\Omega = \\nabla_\\perp^2 \\phi$ 定义的。\n\n接下来，我们在一个尺寸为 $L_x \\times L_y$、包含 $N_x \\times N_y$ 个点的均匀笛卡尔网格上离散化该方程。网格间距为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。一个场 $f(x,y)$ 由其在网格点 $(x_i, y_j) = (i\\Delta x, j\\Delta y)$ 上的值 $f_{i,j}$ 表示，其中 $i \\in \\{0, \\dots, N_x-1\\}$ 且 $j \\in \\{0, \\dots, N_y-1\\}$。\n\n我们对所有空间导数使用二阶中心有限差分，并实施周期性边界条件。对于一个场 $f_{i,j}$：\n关于 $x$ 的偏导数为：\n$$\n(\\partial_x f)_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x}\n$$\n关于 $y$ 的偏导数为：\n$$\n(\\partial_y f)_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y}\n$$\n垂直拉普拉斯算子 $\\nabla_\\perp^2 = \\partial_x^2 + \\partial_y^2$ 为：\n$$\n(\\nabla_\\perp^2 f)_{i,j} \\approx \\frac{f_{i+1,j} - 2f_{i,j} + f_{i-1,j}}{(\\Delta x)^2} + \\frac{f_{i,j+1} - 2f_{i,j} + f_{i,j-1}}{(\\Delta y)^2}\n$$\n周期性通过环绕索引来强制执行，例如，$f_{N_x,j} = f_{0,j}$ 和 $f_{-1,j} = f_{N_x-1,j}$。\n\n计算算法按以下步骤进行：\n1. 对于每个测试用例，定义参数并在 $N_x \\times N_y$ 网格上构建离散的初始场 $\\phi_{i,j}$ 和 $n_{i,j}$。\n2. 使用有限差分拉普拉斯算子计算离散涡度场：$\\Omega_{i,j} = (\\nabla_\\perp^2 \\phi)_{i,j}$。\n3. 使用有限差分梯度算子计算必要的一阶空间导数：$(\\partial_x\\phi)_{i,j}$、$(\\partial_y\\phi)_{i,j}$、$(\\partial_x\\Omega)_{i,j}$、$(\\partial_y\\Omega)_{i,j}$ 和 $(\\partial_y n)_{i,j}$。\n4. 对每个网格点 $(i,j)$，组合出涡度的离散时间导数 $(\\partial_t \\Omega)_{i,j}$：\n$$\n(\\partial_t \\Omega)_{i,j} = -\\left( (\\partial_x \\phi)_{i,j} (\\partial_y \\Omega)_{i,j} - (\\partial_y \\phi)_{i,j} (\\partial_x \\Omega)_{i,j} \\right) + \\kappa (\\partial_y n)_{i,j} - \\nu \\Omega_{i,j}\n$$\n5. 计算所得 $(\\partial_t \\Omega)_{i,j}$ 场在整个区域上的均方根（RMS）大小：\n$$\n\\mathrm{RMS}(\\partial_t \\Omega) = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} \\left( (\\partial_t \\Omega)_{i,j} \\right)^2 }\n$$\n将此过程应用于四个指定的测试用例中的每一个，以获得最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMS of the time derivative of vorticity for four test cases\n    based on a simplified model of plasma interchange turbulence.\n    \"\"\"\n\n    # Common grid parameters for all cases\n    Lx, Ly = 40.0, 40.0\n    Nx, Ny = 64, 64\n    dx, dy = Lx / Nx, Ly / Ny\n\n    # Test suite and parameter specification\n    test_cases = [\n        # Case 1: General blob with curvature and weak damping\n        {'kappa': 0.02, 'nu': 0.005, 'case_type': 'gaussian_blob', 'A': 1.0, 'sigma': 5.0},\n        # Case 2: Uniform zero fields\n        {'kappa': 0.02, 'nu': 0.005, 'case_type': 'zero_fields'},\n        # Case 3: Curvature-only drive with sinusoidal density\n        {'kappa': 0.05, 'nu': 0.0, 'case_type': 'sinusoidal_density'},\n        # Case 4: General blob with strong damping\n        {'kappa': 0.02, 'nu': 0.5, 'case_type': 'gaussian_blob', 'A': 1.0, 'sigma': 5.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        # 1. Set up grid\n        x = np.linspace(0, Lx, Nx, endpoint=False)\n        y = np.linspace(0, Ly, Ny, endpoint=False)\n        X, Y = np.meshgrid(x, y, indexing='ij')\n\n        # 2. Define finite difference operators with periodic boundaries\n        def grad_x(f):\n            return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * dx)\n\n        def grad_y(f):\n            return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * dy)\n\n        def laplacian(f):\n            d2f_dx2 = (np.roll(f, -1, axis=0) - 2 * f + np.roll(f, 1, axis=0)) / (dx**2)\n            d2f_dy2 = (np.roll(f, -1, axis=1) - 2 * f + np.roll(f, 1, axis=1)) / (dy**2)\n            return d2f_dx2 + d2f_dy2\n\n        # 3. Construct initial fields n(x,y) and phi(x,y)\n        phi = np.zeros((Nx, Ny))\n        n = np.zeros((Nx, Ny))\n        case_type = params['case_type']\n\n        if case_type == 'gaussian_blob':\n            A = params['A']\n            sigma = params['sigma']\n            x0, y0 = Lx / 2, Ly / 2\n            blob = A * np.exp(-((X - x0)**2 + (Y - y0)**2) / sigma**2)\n            phi = blob\n            n = blob\n        elif case_type == 'zero_fields':\n            # Fields are already initialized to zero\n            pass\n        elif case_type == 'sinusoidal_density':\n            phi = np.zeros((Nx, Ny))\n            n = 1.0 + np.sin(2 * np.pi * Y / Ly)\n\n        # 4. Compute d(Omega)/dt\n        kappa = params['kappa']\n        nu = params['nu']\n\n        # Compute vorticity Omega = laplacian(phi)\n        Omega = laplacian(phi)\n\n        # Compute terms for the Poisson bracket {phi, Omega}\n        dphi_dx = grad_x(phi)\n        dphi_dy = grad_y(phi)\n        dOmega_dx = grad_x(Omega)\n        dOmega_dy = grad_y(Omega)\n        poisson_bracket = dphi_dx * dOmega_dy - dphi_dy * dOmega_dx\n\n        # Compute curvature drive term\n        dn_dy = grad_y(n)\n        curvature_term = kappa * dn_dy\n\n        # Compute damping term\n        damping_term = -nu * Omega\n\n        # Assemble the time derivative of vorticity with the correct sign for the advection term\n        dOmega_dt = -poisson_bracket + curvature_term + damping_term\n\n        # 5. Calculate the domain-wide RMS magnitude\n        rms_val = np.sqrt(np.mean(dOmega_dt**2))\n        results.append(rms_val)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "模拟结果的可靠性取决于底层代码的正确性。代码验证是一个严谨的过程，用以确保数值求解器能准确地求解目标方程。我们如何确定代码没有错误并以预期的速率收敛？本练习将介绍“人造解方法”（Method of Manufactured Solutions, MMS），这是一种强大而通用的代码验证技术。通过理解如何将 MMS 应用于涡量方程，你将学到如何设计测试来严格确认数值实现的准确性。",
            "id": "4200189",
            "problem": "考虑一个平板几何中的边缘等离子体团块动力学的静电漂移流体模型，其中在Boussinesq近似下，涡度场定义为 $ \\omega = \\nabla_\\perp^2 \\phi $。涡度方程可以写成一个偏微分方程（PDE）\n$$\n\\partial_t \\omega + \\mathbf{v}_{E} \\cdot \\nabla \\omega = \\mathcal{C}(n, \\phi) + \\nu \\nabla_\\perp^2 \\omega - \\sigma \\,\\omega + S(x,y,t),\n$$\n其中 $ \\mathbf{v}_E = - \\frac{c}{B_0} \\nabla \\phi \\times \\hat{\\mathbf{z}} $ 是电场叉磁场（E×B）漂移，$ \\mathcal{C}(n, \\phi) $ 代表耦合密度 $ n $ 和电势 $ \\phi $ 的曲率驱动交换项，$ \\nu $ 是垂直粘性，$ \\sigma $ 是一个有效线性鞘层阻尼系数，$ S(x,y,t) $ 是一个体源项。待验证的数值代码在空间上使用 $ p $ 阶精度的中心有限差分（FD）格式，在时间上使用 $ q $ 阶精度的显式 Runge–Kutta（RK）积分器。\n\n人造解方法（MMS）将被用于验证该涡度求解器的空间和时间收敛性，包括非线性平流 $ \\mathbf{v}_E \\cdot \\nabla \\omega $、曲率、耗散和鞘层阻尼的存在。误差范数，如 $ L^2 $ 范数，\n$$\n\\| e \\|_2 = \\left( \\frac{1}{A} \\int_\\Omega | \\omega_{\\text{num}} - \\omega_{\\text{exact}} |^2 \\, dA \\right)^{1/2},\n$$\n和 $ L^\\infty $ 范数，\n$$\n\\| e \\|_\\infty = \\max_{\\mathbf{x} \\in \\Omega} | \\omega_{\\text{num}}(\\mathbf{x},t) - \\omega_{\\text{exact}}(\\mathbf{x},t) |,\n$$\n在面积为 $ A $ 的域 $ \\Omega $ 上计算。\n\n下列哪个陈述正确描述了如何将人造解方法（MMS）应用于此团块涡度PDE，以及如何用它来验证空间和时间收敛率？\n\nA. 选择光滑、非平凡的人造场 $ \\phi_M(x,y,t) $ 和 $ n_M(x,y,t) $，以激活偏微分方程中的每一项，形成 $ \\omega_M = \\nabla_\\perp^2 \\phi_M $，并通过将 $ \\omega_M $、$ \\phi_M $ 和 $ n_M $ 代入连续的PDE算子（包括 $ \\mathbf{v}_E(\\phi_M) \\cdot \\nabla \\omega_M $、$ \\mathcal{C}(n_M,\\phi_M) $、$ \\nu \\nabla_\\perp^2 \\omega_M $ 和 $ \\sigma \\omega_M $）来计算精确源项 $ S_M(x,y,t) $。施加与人造解一致的边界条件，然后进行网格和时间步长加密研究：对于空间阶数，使 $ \\Delta t $ 足够小以使时间误差可忽略不计；对于时间阶数，使 $ \\Delta x $ 和 $ \\Delta y $ 足够小以使空间误差可忽略不计。当分离时，在 $ L^2 $ 和 $ L^\\infty $ 范数中观察到的阶数应与 $ p $ 和 $ q $ 匹配。\n\nB. 为确保残差为零，通过将求解器使用的相同离散FD和RK算子应用于网格上的人造场（而不是连续微分算子）来计算源项，从而使数值解在任何 $ \\Delta x $、$ \\Delta y $ 和 $ \\Delta t $ 下都能达到机器精度与 $ \\omega_M $ 匹配，并因此确认收敛。\n\nC. 为测量空间阶数 $ p $，将 $ \\Delta t $ 固定在一个较大的值，使时间误差占主导地位；$ \\log \\| e \\| $ 对 $ \\log \\Delta x $ 的斜率仍将揭示 $ p $，因为时间误差是一个常数偏移。\n\nD. 当存在鞘层边界条件时，MMS强迫项应仅在内部添加；可以保留求解器默认的齐次Neumann边界，因为光滑的人造解确保边界效应不影响收敛率。\n\nE. 在 $ \\Delta x \\neq \\Delta y $ 的各向异性网格中，要么将两个空间方向一起加密并将 $ \\Delta t $ 与加密过程联系起来以平衡误差贡献（例如，选择 $ \\Delta t \\propto h^{p/q} $，其中 $ h = \\max\\{\\Delta x, \\Delta y\\} $），要么进行独立研究，保持三个分辨率中的两个渐近地小。否则，混合误差污染会掩盖真实的空间和时间阶数。\n\nF. 人造解的构造应使非线性平流 $ \\mathbf{v}_E \\cdot \\nabla \\omega $、曲率交换 $ \\mathcal{C}(n,\\phi) $、粘性扩散 $ \\nu \\nabla_\\perp^2 \\omega $ 和鞘层阻尼 $ \\sigma \\omega $ 均被激活；如果在人造场下任何项恒为零，MMS研究就无法验证该项的离散化，并可能导致过于乐观的收敛性声明。\n\n选择所有适用项。",
            "solution": "人造解方法（Method of Manufactured Solutions, MMS）是用于验证偏微分方程（PDE）数值求解器精度阶数的一种严谨程序。其基本原理是选择一个解析解，即“人造解”，并将其代入连续的PDE中。由于所选函数通常不是原始PDE（例如，源项为零的PDE）的真解，将其代入会产生一个残差。然后，这个残差被定义为一个修改后PDE的源项。根据设计，人造解是这个修改后PDE的精确解析解。然后，使用数值代码求解这个修改后的问题，并测量数值解与已知人造解之间的误差。通过系统地加密离散化参数（网格间距和时间步长），可以测量该误差减小的速率，该速率应与所用数值格式的理论精度阶数相对应。\n\n给定的PDE是涡度方程：\n$$\n\\partial_t \\omega + \\mathbf{v}_{E} \\cdot \\nabla \\omega = \\mathcal{C}(n, \\phi) + \\nu \\nabla_\\perp^2 \\omega - \\sigma \\,\\omega + S(x,y,t)\n$$\n在这里，解变量是耦合的，主要通过涡度定义 $ \\omega = \\nabla_\\perp^2 \\phi $ 以及平流/曲率项。对于MMS，我们必须为人造基本场，比如 $ n_M(x,y,t) $ 和 $ \\phi_M(x,y,t) $。由此，我们可以推导出所有其他必要的量：\n-   人造电势：$ \\phi_M(x,y,t) $\n-   人造密度：$ n_M(x,y,t) $\n-   人造涡度：$ \\omega_M = \\nabla_\\perp^2 \\phi_M $\n-   人造速度：$ \\mathbf{v}_{E,M} = - \\frac{c}{B_0} \\nabla \\phi_M \\times \\hat{\\mathbf{z}} $\n\n然后，通过将这些人造场代入PDE来计算人造源项 $ S_M(x,y,t) $：\n$$\nS_M = \\partial_t \\omega_M + \\mathbf{v}_{E,M} \\cdot \\nabla \\omega_M - \\mathcal{C}(n_M, \\phi_M) - \\nu \\nabla_\\perp^2 \\omega_M + \\sigma \\omega_M\n$$\n数值代码随后用此源项 $ S_M $ 求解PDE。将数值解 $ \\omega_{\\text{num}} $ 与精确解 $ \\omega_M $ 进行比较。对于一个空间 $ p $ 阶、时间 $ q $ 阶的格式，误差 $ e = \\omega_{\\text{num}} - \\omega_M $ 预计将按 $ \\|e\\| \\approx C_{sp} h^p + C_t (\\Delta t)^q $ 的比例变化，其中 $ h $ 是空间网格尺寸的度量（如 $ \\max\\{\\Delta x, \\Delta y\\} $）。\n\n现在，我们根据这些原则评估每个选项。\n\n**A. 选择光滑、非平凡的人造场 $ \\phi_M(x,y,t) $ 和 $ n_M(x,y,t) $，以激活偏微分方程中的每一项，形成 $ \\omega_M = \\nabla_\\perp^2 \\phi_M $，并通过将 $ \\omega_M $、$ \\phi_M $ 和 $ n_M $ 代入连续的PDE算子（包括 $ \\mathbf{v}_E(\\phi_M) \\cdot \\nabla \\omega_M $、$ \\mathcal{C}(n_M,\\phi_M) $、$ \\nu \\nabla_\\perp^2 \\omega_M $ 和 $ \\sigma \\omega_M $）来计算精确源项 $ S_M(x,y,t) $。施加与人造解一致的边界条件，然后进行网格和时间步长加密研究：对于空间阶数，使 $ \\Delta t $ 足够小以使时间误差可忽略不计；对于时间阶数，使 $ \\Delta x $ 和 $ \\Delta y $ 足够小以使空间误差可忽略不计。当分离时，在 $ L^2 $ 和 $ L^\\infty $ 范数中观察到的阶数应与 $ p $ 和 $ q $ 匹配。**\n\n该陈述提供了MMS程序的完整且正确的摘要。它正确地指明了：\n1.  选择能够激活PDE中所有项的光滑、非平凡的人造解。\n2.  通过将人造解代入*连续*算子来计算源项。\n3.  施加与人造解一致的边界条件的必要性。\n4.  通过使其他误差源处于次要地位，从而在收敛性研究中分离空间和时间误差的正确方法。\n5.  预期的结果：测得的收敛率应与数值方法的理论阶数相匹配。\n\n结论：**正确**。\n\n**B. 为确保残差为零，通过将求解器使用的相同离散FD和RK算子应用于网格上的人造场（而不是连续微分算子）来计算源项，从而使数值解在任何 $ \\Delta x $、$ \\Delta y $ 和 $ \\Delta t $ 下都能达到机器精度与 $ \\omega_M $ 匹配，并因此确认收敛。**\n\n该陈述描述了一种不同的、弱得多的验证测试，有时称为“零误差”或“离散残差”测试。如果源项是使用应用于人造解的离散算子 ($ \\hat{L}_h $) 计算的 ($ S_M^{\\text{discrete}} = \\hat{L}_h(\\omega_M) $)，那么数值求解器的任务就是求解 $ \\hat{L}_h(\\omega_{\\text{num}}) = S_M^{\\text{discrete}} $。根据构造，$ \\omega_{\\text{num}} = \\omega_M $ 是该离散系统的精确解，其误差在机器精度范围内为零，而与 $ \\Delta x $、$ \\Delta y $ 或 $ \\Delta t $ 无关。此测试验证了源项是否正确实现，但它*不*测试离散算子相对于其连续对应物的准确性。它不能测量收敛率。MMS的核心是测量截断误差，即作用于精确解的连续算子和离散算子之间的差异；而此过程根据定义使截断误差无效。\n\n结论：**不正确**。\n\n**C. 为测量空间阶数 $ p $，将 $ \\Delta t $ 固定在一个较大的值，使时间误差占主导地位；$ \\log \\| e \\| $ 对 $ \\log \\Delta x $ 的斜率仍将揭示 $ p $，因为时间误差是一个常数偏移。**\n\n该陈述误解了不同误差源如何组合。总误差的行为近似为 $ \\|e\\| \\approx C_{sp}h^p + C_t(\\Delta t)^q $。如果 $ \\Delta t $ 固定且较大，则项 $ C_t(\\Delta t)^q $ 将是一个大的常数值。随着空间网格的加密 ($ h \\to 0 $)，空间误差项 $ C_{sp}h^p $ 将减小，并变得远小于占主导地位的恒定时间误差。因此，总误差 $ \\|e\\| $ 将趋近一个恒定的下限，即 $ \\|e\\| \\to C_t(\\Delta t)^q $。在 $ \\|e\\| $ 对 $ h $ 的对数-对数图上，曲线将变平，斜率为0，这完全掩盖了空间阶数 $ p $。要测量 $ p $，时间误差必须可以忽略不计，这需要使 $ \\Delta t $ 足够小。\n\n结论：**不正确**。\n\n**D. 当存在鞘层边界条件时，MMS强迫项应仅在内部添加；可以保留求解器默认的齐次Neumann边界，因为光滑的人造解确保边界效应不影响收敛率。**\n\n这是不正确的。要使人造函数 $ \\omega_M $ 成为数值问题的真解，模拟中施加的边界条件 (BCs) 必须从 $ \\omega_M $ 导出。例如，如果求解器使用Dirichlet边界条件，则必须施加 $ \\omega|_{\\partial\\Omega} = \\omega_M|_{\\partial\\Omega} $。如果使用Neumann边界条件，则必须施加 $ \\nabla \\omega \\cdot \\mathbf{\\hat{n}}|_{\\partial\\Omega} = \\nabla \\omega_M \\cdot \\mathbf{\\hat{n}}|_{\\partial\\Omega} $。使用任意边界条件，例如齐次Neumann ($ \\nabla \\omega \\cdot \\mathbf{\\hat{n}} = 0 $)，会引入不一致性，除非人造解恰好满足此条件。这种不一致性会产生边界误差，污染整个域的解并破坏收敛性研究，通常会阻止方法达到其设计精度阶数。$ \\omega_M $ 的光滑性并不能消除此要求。\n\n结论：**不正确**。\n\n**E. 在 $ \\Delta x \\neq \\Delta y $ 的各向异性网格中，要么将两个空间方向一起加密并将 $ \\Delta t $ 与加密过程联系起来以平衡误差贡献（例如，选择 $ \\Delta t \\propto h^{p/q} $，其中 $ h = \\max\\{\\Delta x, \\Delta y\\} $），要么进行独立研究，保持三个分辨率中的两个渐近地小。否则，混合误差污染会掩盖真实的空间和时间阶数。**\n\n该陈述正确地指出了由多个离散化参数 ($ \\Delta x $, $ \\Delta y $, $ \\Delta t $) 引起的误差污染问题，并提出了有效的缓解策略。总误差是来自每个维度的贡献之和：$ \\|e\\| \\approx C_x(\\Delta x)^p + C_y(\\Delta y)^p + C_t(\\Delta t)^q $。\n1.  **协调加密：** 通过设置 $ \\Delta x \\propto h $、$ \\Delta y \\propto h $ 和 $ \\Delta t \\propto h^{p/q} $，使所有误差项都按 $ h^p $ 的比例缩放。只要时间步长选择得当，观察到的收敛率将为 $ p $，从而证实空间准确性。这是一种常见且有效的方法。\n2.  **分离：** 或者，可以通过使其他方向的网格/时间步长足够小，以使其误差贡献可以忽略不计，从而一次测量一个方向的收敛性。例如，要测量 $ x $ 方向的收敛性，可将 $ \\Delta y $ 和 $ \\Delta t $ 固定为非常小的值，并仅加密 $ \\Delta x $。\n关于混合误差污染会掩盖真实收敛阶数的警告是准确的，并证明了这些谨慎程序的合理性。\n\n结论：**正确**。\n\n**F. 人造解的构造应使非线性平流 $ \\mathbf{v}_E \\cdot \\nabla \\omega $、曲率交换 $ \\mathcal{C}(n,\\phi) $、粘性扩散 $ \\nu \\nabla_\\perp^2 \\omega $ 和鞘层阻尼 $ \\sigma \\omega $ 均被激活；如果在人造场下任何项恒为零，MMS研究就无法验证该项的离散化，并可能导致过于乐观的收敛性声明。**\n\n该陈述强调了设计一个有用的MMS测试的关键方面。测试的目的是验证*整个*数值算法的正确实现。如果人造解导致PDE中的某一项恒为零（例如，选择一个常数 $ \\phi_M $ 会使 $ \\mathbf{v}_E = \\mathbf{0} $ 且平流项消失），那么离散化该项的代码部分就永远不会被执行或测试。该部分代码中的错误将不会被检测到。测试仍将显示简化PDE的预期收敛率，从而导致对代码正确性的错误信心。因此，一个好的人造解必须足够通用，以激活方程中的所有项。\n\n结论：**正确**。",
            "answer": "$$\\boxed{AEF}$$"
        }
    ]
}