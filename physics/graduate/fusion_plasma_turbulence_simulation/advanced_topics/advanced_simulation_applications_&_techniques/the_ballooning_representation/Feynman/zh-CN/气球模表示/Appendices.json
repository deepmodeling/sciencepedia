{
    "hands_on_practices": [
        {
            "introduction": "为了理解气球模的结构，我们通常从一个简化模型入手。第一个练习将引导您求解一个典型的一维本征问题，该问题捕捉了由磁剪切约束的模式的基本物理特性。通过解决这个类似于量子谐振子的问题 ()，您将从第一性原理出发，推导出离散的本征值谱，并证明对称和反对称模结构的存在性。",
            "id": "4201994",
            "problem": "在强磁化等离子体中静电涨落的气球模表示中，沿单根磁力线的模结构由一个标量包络 $\\phi(\\theta)$ 描述，其中 $\\theta$ 是扩展的极向角。在与聚变等离子体湍流模拟相关的局域强磁剪切极限下，由于磁剪切，垂直波数 $k_{\\perp}(\\theta)$ 随 $|\\theta|$ 近似呈二次方增长，从而产生一个有效的偶势。作为一个最小模型，考虑气球模包络的一维 Sturm–Liouville 本征问题，\n$$\n-\\,\\frac{d^{2}\\phi}{d\\theta^{2}} \\;+\\; \\Omega^{2}\\,\\theta^{2}\\,\\phi \\;=\\; \\Lambda\\,\\phi,\n$$\n其中 $\\Omega0$ 为常数，服从边界条件 $\\phi(\\theta)\\to 0$ 当 $|\\theta|\\to\\infty$。假设采用无量纲归一化，使得 $\\theta$、$\\phi$ 和 $\\Lambda$ 都是无量纲的。\n\n从上述本征问题和偶势的宇称性质出发，完成以下任务：\n\n1. 利用具有偶系数的二阶自伴算符的一般性质，证明所有本征函数都可以选择为在 $\\theta$ 上具有确定宇称，并说明可能出现的两种宇称类别。\n\n2. 进行适当的无量纲化，将本征问题简化为一种典范形式，其偶势的系数中没有自由标度，并引入相应的无量纲谱参数。明确说明你使用的尺度变换。\n\n3. 通过在 $\\mathbb{R}$ 上强制要求 $\\phi(\\theta)$ 的平方可积性，推导出无量纲谱参数的量子化条件，从而获得 $\\Lambda$ 的离散谱的闭合形式。你的推导必须从第一性原理出发构造可归一化的解，并且不得假设任何已知的特殊函数解。\n\n4. 根据你的构造，确定第 $n$ 个本征函数（$n=0,1,2,\\dots$）的宇称，并简要解释对称和反对称气球模本征函数的共存是如何从偶势中得出的。\n\n以 $\\Lambda_{n}$ 作为 $\\Omega$ 和整数索引 $n$ 的函数的单个闭合形式表达式提供最终答案。不需要数值近似。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n已知条件如下：\n*   控制标量包络 $\\phi(\\theta)$ 的本征问题：\n    $$-\\frac{d^{2}\\phi}{d\\theta^{2}} + \\Omega^{2}\\theta^{2}\\phi = \\Lambda\\phi$$\n*   常数 $\\Omega$ 为正：$\\Omega  0$。\n*   边界条件是解必须是物理上可接受的，这意味着它们在 $\\mathbb{R}$ 上是平方可积的。这表述为当 $|\\theta| \\to \\infty$ 时 $\\phi(\\theta) \\to 0$。\n*   变量 $\\theta$、$\\phi$ 和谱参数 $\\Lambda$ 都是无量纲的。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **科学依据**：所提供的方程在数学上等同于量子谐振子的不含时薛定谔方程。这是量子力学中的一个基石模型，并经常在数学物理中用作 Sturm-Liouville 问题的典范例子。它作为聚变等离子体物理中气球模包络结构在高磁剪切极限下的简化模型，是一种标准且物理上合理的近似。该问题在科学上是合理的。\n*   **良态性**：该问题是在无穷域 $(-\\infty, \\infty)$ 上提出的正则 Sturm-Liouville 问题。势 $V(\\theta) = \\Omega^2\\theta^2$ 是束缚势，意味着当 $|\\theta| \\to \\infty$ 时 $V(\\theta) \\to \\infty$。已知此类问题拥有实本征值的离散谱和相应的一组完备的平方可积本征函数。该问题是良态的。\n*   **客观性**：问题以精确的数学语言陈述，没有歧义或主观论断。\n*   **完整性与一致性**：问题提供了确定本征值谱所需的所有信息（微分方程、定义域、边界条件以及常数 $\\Omega$ 的性质）。没有矛盾之处。\n\n**第3步：结论与行动**\n\n该问题具有科学依据、良态、客观且自洽。它是一个有效的问题。可以开始求解过程。\n\n### 解答\n\n按顺序解决问题陈述的四个部分。\n\n**1. 本征函数的宇称**\n\n该本征问题由线性算符 $L = -\\frac{d^2}{d\\theta^2} + \\Omega^2\\theta^2$ 定义。势项为 $V(\\theta) = \\Omega^2\\theta^2$。这个势是 $\\theta$ 的偶函数，因为 $V(-\\theta) = \\Omega^2(-\\theta)^2 = \\Omega^2\\theta^2 = V(\\theta)$。动能项 $-\\frac{d^2}{d\\theta^2}$ 对于宇称变换 $\\theta \\to -\\theta$ 也是偶的。因此，整个算符 $L$ 是偶的。\n\n令 $P$ 为宇称算符，其作用于函数 $f(\\theta)$ 的定义为 $(P f)(\\theta) = f(-\\theta)$。如果一个算符 $A$ 与宇称算符对易，即 $[A, P] = AP - PA = 0$，则该算符是偶的。我们来检验我们的算符 $L$ 是否满足此条件：\n$$ (L(P\\phi))(\\theta) = \\left(-\\frac{d^2}{d\\theta^2} + \\Omega^2\\theta^2\\right)\\phi(-\\theta) $$\n令 $\\eta = -\\theta$，则 $\\frac{d}{d\\theta} = -\\frac{d}{d\\eta}$ 且 $\\frac{d^2}{d\\theta^2} = \\frac{d^2}{d\\eta^2}$。\n$$ (L(P\\phi))(\\theta) = -\\frac{d^2\\phi}{d\\eta^2} + \\Omega^2(-\\eta)^2\\phi(\\eta) = -\\frac{d^2\\phi(\\eta)}{d\\eta^2} + \\Omega^2\\eta^2\\phi(\\eta) = (L\\phi)(\\eta) = (L\\phi)(-\\theta) = (P(L\\phi))(\\theta) $$\n因为对任意函数 $\\phi$，都有 $(L(P\\phi))(\\theta) = (P(L\\phi))(\\theta)$，所以我们有 $LP = PL$，即 $[L, P] = 0$。\n\n线性代数（和量子力学）的一个基本定理指出，如果两个算符对易，它们共享一组共同的本征函数。宇称算符 $P$ 的本征函数是具有确定宇称的函数。如果 $\\psi$ 是 $P$ 的一个本征函数，本征值为 $p$，那么 $P\\psi = p\\psi$。再次作用 $P$ 得到 $P^2\\psi = p^2\\psi$。但 $P^2$ 是单位算符，因为 $(P(P\\psi))(\\theta) = \\psi(-(-\\theta)) = \\psi(\\theta)$。因此，$p^2=1$，宇称算符的本征值为 $p = 1$ 和 $p = -1$。\n\n*   本征值 $p=1$：$\\phi(-\\theta) = \\phi(\\theta)$。这些是**偶**函数（对称）。\n*   本征值 $p=-1$: $\\phi(-\\theta) = -\\phi(\\theta)$。这些是**奇**函数（反对称）。\n\n由于 $L$ 的本征函数可以选择为同时也是 $P$ 的本征函数，因此给定问题的所有本征函数 $\\phi(\\theta)$ 都可以被分类为具有确定宇称。两个宇称类别是偶宇称和奇宇称。\n\n**2. 无量纲化至典范形式**\n\n原始本征问题为 $-\\frac{d^2\\phi}{d\\theta^2} + \\Omega^2\\theta^2\\phi = \\Lambda\\phi$。我们寻求一个变量替换 $\\theta = \\alpha x$，其中 $\\alpha$ 为某个标度因子，以简化方程。使用链式法则，$\\frac{d}{d\\theta} = \\frac{1}{\\alpha}\\frac{d}{dx}$ 且 $\\frac{d^2}{d\\theta^2} = \\frac{1}{\\alpha^2}\\frac{d^2}{dx^2}$。将此代入方程得到：\n$$ -\\frac{1}{\\alpha^2}\\frac{d^2\\phi}{dx^2} + \\Omega^2(\\alpha x)^2 \\phi = \\Lambda \\phi $$\n两边乘以 $\\alpha^2$：\n$$ -\\frac{d^2\\phi}{dx^2} + \\alpha^4\\Omega^2 x^2 \\phi = \\alpha^2\\Lambda \\phi $$\n为了将其简化为势项中没有自由参数的典范形式，我们选择 $x^2$ 的系数为 $1$。这要求 $\\alpha^4\\Omega^2 = 1$。由于 $\\Omega  0$，我们可以选择一个实数 $\\alpha  0$，得到 $\\alpha^2\\Omega = 1$，或 $\\alpha = 1/\\sqrt{\\Omega}$。\n\n因此，所需的尺度变换为 $\\theta = x/\\sqrt{\\Omega}$。\n通过这个选择，本征问题变为：\n$$ -\\frac{d^2\\phi}{dx^2} + x^2 \\phi = \\frac{\\Lambda}{\\Omega} \\phi $$\n这是量子谐振子方程的典范形式。相应的无量纲谱参数，我们称之为 $\\lambda$，由以下关系给出：\n$$ \\lambda = \\frac{\\Lambda}{\\Omega} $$\n\n**3. 量子化条件与谱的推导**\n\n我们必须找到重新标度后方程的平方可积解：\n$$ -\\frac{d^2\\phi}{dx^2} + x^2 \\phi = \\lambda \\phi $$\n首先，分析 $|x| \\to \\infty$ 时的渐近行为。在此极限下，$x^2\\phi$ 项远大于 $\\lambda\\phi$ 项，方程近似为 $\\frac{d^2\\phi}{dx^2} \\approx x^2\\phi$。具有这种渐近行为的解的形式为 $\\exp(\\pm x^2/2)$。为了使解是平方可积的（即当 $|x| \\to \\infty$ 时 $\\phi \\to 0$），我们必须选择衰减的指数。这启发我们做出如下拟设：\n$$ \\phi(x) = H(x) \\exp\\left(-\\frac{x^2}{2}\\right) $$\n其中 $H(x)$ 是一个比 $\\exp(x^2/2)$ 增长慢的函数。我们计算 $\\phi(x)$ 的导数：\n$$ \\frac{d\\phi}{dx} = \\left(\\frac{dH}{dx} - xH\\right) \\exp\\left(-\\frac{x^2}{2}\\right) $$\n$$ \\frac{d^2\\phi}{dx^2} = \\left(\\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} - H + x^2H\\right) \\exp\\left(-\\frac{x^2}{2}\\right) $$\n将这些代入重新标度后的微分方程中得到：\n$$ -\\left(\\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} - H + x^2H\\right) + x^2H = \\lambda H $$\n这简化为 $H(x)$ 的 Hermite 微分方程：\n$$ \\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} + (\\lambda-1)H = 0 $$\n我们使用 $H(x)$ 的幂级数展开从第一性原理求解此方程：\n$$ H(x) = \\sum_{k=0}^{\\infty} c_k x^k $$\n其导数为 $H'(x) = \\sum_{k=1}^{\\infty} k c_k x^{k-1}$ 和 $H''(x) = \\sum_{k=2}^{\\infty} k(k-1) c_k x^{k-2}$。将这些代入 Hermite 方程：\n$$ \\sum_{k=2}^{\\infty} k(k-1) c_k x^{k-2} - 2x\\sum_{k=1}^{\\infty} k c_k x^{k-1} + (\\lambda-1)\\sum_{k=0}^{\\infty} c_k x^k = 0 $$\n对第一个和式重新索引，令 $j=k-2$ (因此 $k=j+2$):\n$$ \\sum_{j=0}^{\\infty} (j+2)(j+1) c_{j+2} x^j - \\sum_{k=1}^{\\infty} 2k c_k x^k + (\\lambda-1)\\sum_{k=0}^{\\infty} c_k x^k = 0 $$\n为了使 $x^k$ 的系数对所有 $k$ 都为零，我们将每个 $x$ 次幂的系数之和设为零。这产生了递推关系：\n$$ (k+2)(k+1)c_{k+2} - 2kc_k + (\\lambda-1)c_k = 0 $$\n$$ c_{k+2} = \\frac{2k - (\\lambda-1)}{(k+2)(k+1)} c_k = \\frac{2k+1-\\lambda}{(k+2)(k+1)} c_k $$\n对于大的 $k$，相邻系数之比为 $c_{k+2}/c_k \\sim 2k/k^2 = 2/k$。这与 $\\exp(x^2)$ 的泰勒级数系数的渐近比率相同。如果 $H(x)$ 的级数不终止，它将像 $\\exp(x^2)$ 一样增长，因此 $\\phi(x) = H(x)\\exp(-x^2/2)$ 将像 $\\exp(x^2/2)$ 一样增长，违反了平方可积性条件。\n\n为了使级数终止，它必须是一个多项式。这发生在递推关系中的分子对于某个非负整数 $k$ 变为零时。设这个整数为 $n$。\n$$ 2n + 1 - \\lambda = 0 $$\n这就给出了无量纲谱参数 $\\lambda$ 的量子化条件：\n$$ \\lambda_n = 2n+1, \\quad \\text{其中 } n = 0, 1, 2, \\ldots $$\n这个条件确保了 $c_{n+2}=0$，并且根据递推关系，所有更高阶的系数 $c_{n+4}, c_{n+6}, \\ldots$ 也为零，使得 $H(x)$ 成为一个 $n$ 次多项式。\n回想起 $\\lambda = \\Lambda/\\Omega$，我们找到本征值 $\\Lambda_n$ 的离散谱：\n$$ \\Lambda_n = \\Omega \\lambda_n = \\Omega(2n+1), \\quad n = 0, 1, 2, \\ldots $$\n\n**4. 第n个本征函数的宇称**\n\n递推关系 $c_{k+2} = \\frac{2k+1-\\lambda}{(k+2)(k+1)} c_k$ 只关联指数相差 $2$ 的系数。这将级数解耦为两个独立的集合：一个用于 $x$ 的偶次幂（从 $c_0$ 开始），另一个用于 $x$ 的奇次幂（从 $c_1$ 开始）。\n*   如果我们选择 $c_1=0$，所有奇数系数都消失（$c_3=c_5=\\ldots=0$）。解是只包含偶次幂的级数。为使此级数终止，量子化条件 $\\lambda_n=2n+1$ 必须对一个偶数 $n$ 成立。得到的多项式 $H_n(x)$ 是一个偶函数，因此本征函数 $\\phi_n(x) = H_n(x)\\exp(-x^2/2)$ 具有偶宇称。这对应于 $n=0, 2, 4, \\ldots$。\n*   如果我们选择 $c_0=0$，所有偶数系数都消失（$c_2=c_4=\\ldots=0$）。解是只包含奇次幂的级数。为使此级数终止，条件 $\\lambda_n=2n+1$ 必须对一个奇数 $n$ 成立。得到的多项式 $H_n(x)$ 是一个奇函数，本征函数 $\\phi_n(x)$ 具有奇宇称。这对应于 $n=1, 3, 5, \\ldots$。\n\n因此，第 $n$ 个本征函数的宇称为 $(-1)^n$。基态（$n=0$）是偶宇称，第一激发态（$n=1$）是奇宇称，第二激发态（$n=2$）是偶宇称，依此类推。\n\n对称（偶）和反对称（奇）气球模本征函数的共存是该问题对称性的直接结果。正如在第1部分中所确立的，控制算符 $L$ 在宇称变换 $\\theta \\to -\\theta$ 下是不变的，因为有效势 $\\Omega^2\\theta^2$ 是一个偶函数。这种对称性保证了本征函数可以被分为不同的宇称类别。由于定义域 $\\mathbb{R}$ 相对于原点也是对称的，没有任何约束会排除某一类解，因此两族解都必须存在。",
            "answer": "$$\\boxed{\\Omega(2n+1)}$$"
        },
        {
            "introduction": "底层物理系统的对称性对解的形式具有深远的影响。本练习在宇称性的概念基础上，探讨了气球模的偶宇称或奇宇称性质如何决定其局部行为和物理耦合。您将推导不同宇称解在等离子体外侧中平面（$\\theta=0$）必须满足的边界条件，并量化这种对称性如何影响静电势和矢量势之间的电磁耦合 ()。",
            "id": "4202011",
            "problem": "考虑在托卡马克等离子体的气球模表示中进行高环向模数的线性分析，其中场线坐标用气球模角 $ \\theta \\in (-\\infty,\\infty) $ 表示。假设存在一个上下对称的平衡，使得描述沿 $ \\theta $ 的模结构的线性化方程的系数是 $ \\theta $ 的偶函数。令 $ \\phi(\\theta) $ 表示静电势，$ A_{\\parallel}(\\theta) $ 表示电磁矢量势的平行分量。在这样的上下对称系统中，可以选择本征函数，使其在 $ \\theta \\rightarrow -\\theta $ 变换下具有确定的宇称。\n\n首先，仅使用宇称的定义 $ X(\\theta)=X(-\\theta) $ (偶) 和 $ X(\\theta)=-X(-\\theta) $ (奇)，以及控制系数是 $ \\theta $ 的偶函数的假设，推导在 $ \\theta=0 $ 处必须被代表 $ \\phi(\\theta) $ 或 $ A_{\\parallel}(\\theta) $ 的任意偶宇称和奇宇称解 $ X(\\theta) $ 满足的边界条件。用 $ X(0) $ 和 $ \\partial_{\\theta} X(0) $ 明确地陈述这些边界条件。\n\n接下来，为了量化 $ \\phi(\\theta) $ 和 $ A_{\\parallel}(\\theta) $ 之间与回旋动理学（GK）理论中平行电场结构一致的最小电磁耦合，定义耦合泛函\n$$\nK \\doteq \\int_{-\\infty}^{\\infty} d\\theta \\, \\phi(\\theta)\\,\\frac{d A_{\\parallel}(\\theta)}{d\\theta}.\n$$\n假设存在局域化的气球模包络，并采用以下在 $ \\theta=0 $ 附近宇称一致的高斯拟设：\n- 对于具有静电（气球模）宇称的分支，取 $ \\phi_{\\mathrm{b}}(\\theta)=\\phi_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $ 和 $ A_{\\parallel,\\mathrm{b}}(\\theta)=A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $。\n- 对于具有撕裂模宇称的分支，取 $ \\phi_{\\mathrm{t}}(\\theta)=\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $ 和 $ A_{\\parallel,\\mathrm{t}}(\\theta)=A_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $。\n\n此处 $ \\phi_{0} $，$ A_{0} $ 和 $ \\Delta0 $ 是实常数。使用这些形式，通过将 $ (\\phi_{\\mathrm{b}},A_{\\parallel,\\mathrm{b}}) $ 和 $ (\\phi_{\\mathrm{t}},A_{\\parallel,\\mathrm{t}}) $ 代入 $ K $ 的定义中，计算 $ K_{\\mathrm{b}} $ 和 $ K_{\\mathrm{t}} $。然后计算比值\n$$\nR \\doteq \\frac{K_{\\mathrm{b}}}{K_{\\mathrm{t}}}.\n$$\n给出 $ R $ 的最终答案，应为一个精确的无量纲数。无需四舍五入。",
            "solution": "该问题被评估为有效，因为它在科学上基于聚变等离子体物理理论，是适定的、客观的、自洽的，并且在数学上是可解的。所有提供的信息都是一致的，足以得出一个唯一的解。\n\n第一个任务是推导具有确定宇称的一般函数 $X(\\theta)$ 在 $\\theta=0$ 处的边界条件。\n\n对于偶宇称解，定义为 $X(\\theta) = X(-\\theta)$。两边对 $\\theta$ 求导，得到 $\\partial_{\\theta}X(\\theta) = (\\partial_{\\theta}X)(-\\theta) \\cdot (-1) = - \\partial_{\\theta}X(-\\theta)$。这表明偶函数的导数是奇函数。对于任意奇函数 $f(\\theta)$，我们有 $f(0) = -f(-0) = -f(0)$，这意味着 $2 f(0) = 0$，所以 $f(0)=0$。因此，对于偶宇称解 $X(\\theta)$，其导数在原点处必须为零：\n$$\n\\partial_{\\theta}X(0)=0.\n$$\n对于奇宇称解，定义为 $X(\\theta) = -X(-\\theta)$。在 $\\theta=0$ 处求值得到 $X(0) = -X(-0) = -X(0)$，这意味着 $2 X(0)=0$，所以 $X(0)=0$。因此，任何奇宇称解在原点处必须为零：\n$$\nX(0)=0.\n$$\n对奇函数求导得到 $\\partial_{\\theta}X(\\theta) = -(\\partial_{\\theta}X)(-\\theta) \\cdot(-1) = \\partial_{\\theta}X(-\\theta)$，这表明其导数是偶函数。偶函数在 $\\theta=0$ 处通常不为零，所以 $\\partial_{\\theta}X(0)$ 可以是非零的。\n\n第二个任务是计算比值 $R \\doteq K_{\\mathrm{b}}/K_{\\mathrm{t}}$，其中 $K$ 是定义为如下的耦合泛函：\n$$\nK \\doteq \\int_{-\\infty}^{\\infty} d\\theta \\, \\phi(\\theta)\\,\\frac{d A_{\\parallel}(\\theta)}{d\\theta}.\n$$\n该问题为两个相反宇称的分支提供了高斯拟设。由于模是局域化的，函数 $\\phi(\\theta)$ 和 $A_{\\parallel}(\\theta)$ 被假定在 $\\theta \\to \\pm\\infty$ 时衰减到零。这允许对泛函 $K$ 进行分部积分：\n$$\nK = \\left[ \\phi(\\theta) A_{\\parallel}(\\theta) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} d\\theta \\, A_{\\parallel}(\\theta)\\,\\frac{d \\phi(\\theta)}{d\\theta}.\n$$\n边界项为零，从而得到该泛函的另一种形式：\n$$\nK = - \\int_{-\\infty}^{\\infty} d\\theta \\, A_{\\parallel}(\\theta)\\,\\frac{d \\phi(\\theta)}{d\\theta}.\n$$\n我们现在将计算 $K_{\\mathrm{b}}$ 和 $K_{\\mathrm{t}}$。为此，我们使用标准的高斯积分结果：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-a x^2) dx = \\sqrt{\\frac{\\pi}{a}}, \\quad \\int_{-\\infty}^{\\infty} x^2 \\exp(-a x^2) dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}\n$$\n对于任意实常数 $a0$。\n\n对于静电（气球模）宇称分支，拟设为：\n$$\n\\phi_{\\mathrm{b}}(\\theta)=\\phi_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{偶})\n$$\n$$\nA_{\\parallel,\\mathrm{b}}(\\theta)=A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{奇})\n$$\n我们使用分部积分形式计算 $K_{\\mathrm{b}}$。首先，我们求 $\\phi_{\\mathrm{b}}(\\theta)$ 的导数：\n$$\n\\frac{d \\phi_{\\mathrm{b}}}{d\\theta} = \\phi_{0} \\left( -\\frac{2\\theta}{2\\Delta^{2}} \\right) \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) = -\\frac{\\phi_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right).\n$$\n现在，代入 $K_{\\mathrm{b}}$ 的积分中：\n$$\nK_{\\mathrm{b}} = - \\int_{-\\infty}^{\\infty} A_{\\parallel,\\mathrm{b}}(\\theta)\\,\\frac{d \\phi_{\\mathrm{b}}}{d\\theta} d\\theta = - \\int_{-\\infty}^{\\infty} \\left(A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) \\left(-\\frac{\\phi_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) d\\theta\n$$\n$$\nK_{\\mathrm{b}} = \\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta.\n$$\n使用高斯积分公式，其中 $a = 1/\\Delta^{2}$：\n$$\n\\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta = \\frac{1}{2(1/\\Delta^{2})} \\sqrt{\\frac{\\pi}{1/\\Delta^{2}}} = \\frac{\\Delta^{2}}{2} (\\Delta\\sqrt{\\pi}) = \\frac{\\Delta^{3}\\sqrt{\\pi}}{2}.\n$$\n因此，$K_{\\mathrm{b}}$ 为：\n$$\nK_{\\mathrm{b}} = \\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\left(\\frac{\\Delta^{3}\\sqrt{\\pi}}{2}\\right) = \\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}.\n$$\n\n对于撕裂模宇称分支，拟设为：\n$$\n\\phi_{\\mathrm{t}}(\\theta)=\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{奇})\n$$\n$$\nA_{\\parallel,\\mathrm{t}}(\\theta)=A_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{偶})\n$$\n我们使用原始定义计算 $K_{\\mathrm{t}}$。首先，我们求 $A_{\\parallel,\\mathrm{t}}(\\theta)$ 的导数：\n$$\n\\frac{d A_{\\parallel,\\mathrm{t}}}{d\\theta} = A_{0} \\left( -\\frac{2\\theta}{2\\Delta^{2}} \\right) \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) = -\\frac{A_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right).\n$$\n现在，代入 $K_{\\mathrm{t}}$ 的积分中：\n$$\nK_{\\mathrm{t}} = \\int_{-\\infty}^{\\infty} \\phi_{\\mathrm{t}}(\\theta)\\,\\frac{d A_{\\parallel,\\mathrm{t}}}{d\\theta} d\\theta = \\int_{-\\infty}^{\\infty} \\left(\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) \\left(-\\frac{A_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) d\\theta\n$$\n$$\nK_{\\mathrm{t}} = -\\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta.\n$$\n这个积分与为 $K_{\\mathrm{b}}$ 计算的积分相同。\n$$\nK_{\\mathrm{t}} = -\\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\left(\\frac{\\Delta^{3}\\sqrt{\\pi}}{2}\\right) = -\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}.\n$$\n最后，我们计算比值 $R$：\n$$\nR = \\frac{K_{\\mathrm{b}}}{K_{\\mathrm{t}}} = \\frac{\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}}{-\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}}.\n$$\n假设振幅 $\\phi_{0}$ 和 $A_{0}$ 非零，表达式简化为：\n$$\nR = -1.\n$$\n结果是一个无量纲数，符合要求。该计算展示了在给定的理想化模结构下，相反宇称分支的耦合泛函之间存在一个基本的对称关系。",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "连接理论与仿真是计算物理学中的一项关键技能。最后一个练习将从解析推导过渡到数值实现，重点关注“扭曲-平移”（twist-and-shift）边界条件，这是使用气球模表示的磁通管模拟程序的一个核心特征。您将通过编写程序，在一个简化的剪切平板几何模型中，对照其精确的解析形式来验证这一数值边界条件 ()，从而加深对模拟中如何处理磁剪切的理解。",
            "id": "4201936",
            "problem": "考虑用于聚变等离子体湍流模拟的剪切平板模型中的气球模表象。在一个局域场向坐标系中，设位置分解为 $x$ (径向)、$y$ (副法向) 和 $z$ (平行于磁场方向)。垂直平面波相位由垂直波矢与位置的标量积定义。在磁剪切作用下，副法向坐标会沿着平行方向发生线性变形，这导致当一个模式沿着 $z$ 方向传播时，其径向波数会发生演化。从气球模表象的假设出发，一个模式在 $z=0$ 处的垂直相位可以写为 $k_x x + k_y y$，并且剪切平板变形可以表示为 $y$ 随 $z$ 的线性映射。基于这些基础，推导出径向波数随平行坐标 $z$ 演化的控制关系式。\n\n在磁通管模拟中使用的扭曲-平移边界条件在平行边界上强制执行一个离散映射：在穿过一个长度为 $L_z$ 的平行区域后，模式会连接到间距为 $\\Delta k_x$ 的均匀离散径向波数网格上的一个平移后的径向波数索引。请仅基于径向波数沿磁力线的演化和网格间距，构建此离散索引变化的理论预测公式。\n\n你的任务是实现一个程序，对每个提供的测试用例执行以下步骤：\n\n1. 在平行坐标 $z \\in [-L_z/2, +L_z/2]$ 上构建一个包含 $N=2001$ 个点（含端点）的均匀网格，单位为米。\n2. 使用从剪切平板气球模表象推导出的演化关系，在该网格上计算解析的径向波数 $k_x(z)$。所用参数为：初始径向波数 $k_{x0}$（单位 $\\mathrm{m}^{-1}$），副法向波数 $k_y$（单位 $\\mathrm{m}^{-1}$），磁剪切 $\\hat{s}$（单位 $\\mathrm{m}^{-1}$），以及平行区域长度 $L_z$（单位 $\\mathrm{m}$）。\n3. 使用与推导出的关于 $z$ 的 $k_x(z)$ 常微分方程一致的步进更新方法，在同一网格上数值模拟 $k_x(z)$ 的演化。使用简单的向前欧拉法在 $z$ 方向上步进，累积整个网格上 $k_x$ 的变化。\n4. 计算整个网格上解析与模拟的 $k_x(z)$ 数组之间的最大绝对差。该差值以 $\\mathrm{m}^{-1}$ 为单位表示。\n5. 计算预测的离散扭曲-平移索引变化 $N_{\\text{pred}}$，其值为整个区域内径向波数净变化量与径向波数网格间距 $\\Delta k_x$之比的最接近整数。使用相同的最接近整数规则，根据模拟出的定义域两端的 $k_x(z)$ 值计算数值实现的索引变化 $N_{\\text{sim}}$。报告整数差 $N_{\\text{sim}} - N_{\\text{pred}}$。\n\n所有量都必须使用国际单位制（SI）处理。特别地，$z$ 的单位必须是米， $k_x$、$k_y$ 和 $\\Delta k_x$ 的单位是 $\\mathrm{m}^{-1}$，$\\hat{s}$ 的单位是 $\\mathrm{m}^{-1}$。本问题不使用角度。\n\n测试套件：\n使用以下参数集，每组参数均以 $(k_{x0}, k_y, \\hat{s}, L_z, \\Delta k_x)$ 的形式给出，单位为 $(\\mathrm{m}^{-1}, \\mathrm{m}^{-1}, \\mathrm{m}^{-1}, \\mathrm{m}, \\mathrm{m}^{-1})$：\n- 情况A（一般情况）：$(0.0, 2.0, 0.3, 10.0, 0.5)$\n- 情况B（零剪切）：$(1.0, 2.0, 0.0, 10.0, 0.5)$\n- 情况C（零副法向波数）：$(0.5, 0.0, 0.25, 12.0, 0.6)$\n- 情况D（负剪切）：$(0.0, 3.0, -0.1, 20.0, 0.4)$\n- 情况E（非整数映射比）：$(0.2, 1.5, 0.2, 7.0, 0.8)$\n\n最终输出格式要求：\n你的程序应生成单行输出，其中包含五个测试用例的结果，形式为一个由方括号括起来的逗号分隔列表。每个用例的结果本身必须是一个形式为 $[E_{\\max}, \\Delta N]$ 的双元素列表，其中 $E_{\\max}$ 是以 $\\mathrm{m}^{-1}$ 为单位的最大绝对差（一个浮点数），$\\Delta N$ 是整数差 $N_{\\text{sim}} - N_{\\text{pred}}$。例如：\"[[Emax_caseA,DeltaN_caseA],[Emax_caseB,DeltaN_caseB],...]\"，其中每个元素按顺对应上面列出的情况。",
            "solution": "在尝试解答之前，将对问题陈述进行验证。\n\n### 第1步：提取已知信息\n- **坐标系**：一个局域场向坐标系，坐标为 $x$ (径向)、$y$ (副法向) 和 $z$ (平行)。\n- **模式表示**：在 $z=0$ 处的垂直平面波相位由 $k_x x + k_y y$ 给出。\n- **磁剪切模型**：剪切平板模型中，副法向坐标 $y$ 随平行坐标 $z$ 发生线性变形，进而导致径向波数 $k_x$ 随 $z$ 演化。\n- **边界条件**：在长度为 $L_z$ 的平行区域上使用扭曲-平移边界条件，将模式连接到间距为 $\\Delta k_x$ 的离散网格上一个平移后的径向波数索引。\n- **模拟参数**：\n    - 平行网格：在 $z \\in [-L_z/2, +L_z/2]$ 上均匀离散，含 $N=2001$ 个点。\n    - $z=0$ 处的初始径向波数：$k_{x0}$ [$\\mathrm{m}^{-1}$]。\n    - 副法向波数：$k_y$ [$\\mathrm{m}^{-1}$]。\n    - 磁剪切参数：$\\hat{s}$ [$\\mathrm{m}^{-1}$]。\n    - 平行区域长度：$L_z$ [m]。\n    - 径向波数网格间距：$\\Delta k_x$ [$\\mathrm{m}^{-1}$]。\n- **任务**：\n    1. 构建 $z$ 的平行网格。\n    2. 计算 $k_x(z)$ 的解析形式。\n    3. 基于 $dk_x/dz$ 的常微分方程，使用向前欧拉法模拟 $k_x(z)$ 的演化。\n    4. 计算解析与模拟的 $k_x(z)$ 数组之间的最大绝对差 $E_{\\max}$。\n    5. 根据解析结果计算预测的整数索引变化 $N_{\\text{pred}}$，并根据数值结果计算模拟的变化 $N_{\\text{sim}}$，二者均使用最接近整数的取整规则。报告其差值 $\\Delta N = N_{\\text{sim}} - N_{\\text{pred}}$。\n- **测试用例**：提供了五组参数 $(k_{x0}, k_y, \\hat{s}, L_z, \\Delta k_x)$。\n- **单位**：所有量均以国际单位制（SI）指定。\n\n### 第2步：使用提取的已知信息进行验证\n根据所需标准对问题进行评估。\n- **科学依据**：该问题基于磁约束聚变等离子体中微观不稳定性理论和模拟中已广为建立的气球模表象。剪切平板模型是研究此类现象的标准简化几何模型。场向坐标、由剪切引起的波数演化以及扭曲-平移边界条件等概念在回旋动理学模拟领域都是标准内容。该问题在科学上是合理的。\n- **定义明确**：问题定义清晰。它要求进行特定的推导，提供所有必要参数（$k_{x0}$、$k_y$、$\\hat{s}$、$L_z$、$\\Delta k_x$、$N$）和方法（向前欧拉法）的数值实现，并计算明确定义的度量指标（$E_{\\max}$、$\\Delta N$）。存在一个唯一的、稳定的、有意义的解。\n- **客观性**：问题以精确、技术性的语言陈述，没有歧义、主观性或观点。\n- **缺陷检查清单**：该问题不违反任何指定的无效性标准。它是可形式化的、完整的、物理上合理的，并且需要进行有意义的推理和实现。参数与物理模型之间的关系是一致的。术语 $\\hat{s}$ 的单位是 $\\mathrm{m}^{-1}$，这对于一个平板模型是合适的，因为它代表了磁场螺距的梯度，$d(B_y/B_z)/dx$。\n\n### 第3步：结论与行动\n问题被判定为 **有效**。将提供一个完整、论证充分的解答。\n\n### 基于原理的设计与解答\n\n#### 理论推导\n问题的核心在于确定径向波数 $k_x$ 随平行坐标 $z$ 变化的函数形式。这一关系是采用沿剪切磁力线坐标系的直接结果。\n\n在剪切平板模型中，磁场可以表示为 $\\vec{B} \\approx B_0(\\hat{z} + \\hat{s} x \\hat{y})$，其中 $\\hat{s}$ 代表磁剪切。磁力线是一条其上任意点的切线都与 $\\vec{B}$ 平行的曲线。磁力线的方程是 $d\\vec{l}/ds \\propto \\vec{B}$，其分量关系为 $dx/B_x = dy/B_y = dz/B_z$。在此模型中，这意味着 $dx/0 = dy/(B_0 \\hat{s} x) = dz/B_0$，从而得到 $dy/dz = \\hat{s} x$。\n\n为了简化对类波扰动的描述，我们变换到一个场跟随坐标系 $(x, y', z)$，其中 $y'$ 沿磁力线为常数。从 $dy/dz = \\hat{s} x$ 出发，可以定义这样一个坐标 $y' = y - \\hat{s} x z$。\n\n让我们考虑单个傅里叶模式。在实验室坐标系 $(x,y,z)$ 中，其相位由 $\\alpha(x,y,z)$ 给出。一个在场跟随坐标系中形式简单的模式，其相位可以描述为 $\\alpha = k_{x0} x + k_y y'$，其中 $k_{x0}$ 和 $k_y$ 是恒定的波数。将此相位变换回实验室坐标系可得：\n$$ \\alpha = k_{x0} x + k_y (y - \\hat{s} x z) = k_{x0} x + k_y y - \\hat{s} k_y z x $$\n重新整理各项，按空间依赖关系分组，我们得到：\n$$ \\alpha = (k_{x0} - \\hat{s} k_y z) x + k_y y $$\n这个表达式具有 $\\alpha = k_x(z) x + k_y y$ 的形式，其中径向波数 $k_x(z)$ 明确地依赖于平行坐标 $z$。通过直接比较，我们发现：\n$$ k_x(z) = k_{x0} - \\hat{s} k_y z $$\n文献中也常用另一种符号约定，即 $k_x(z) = k_{x0} + \\hat{s} k_y z$。这种选择取决于磁场方向、等离子体电流以及 $\\hat{s}$ 定义的约定。在本解答中，我们将采用 $k_x(z) = k_{x0} + \\hat{s} k_y z$ 这个约定，这是一个常见的选择，并且对于正的 $\\hat{s}$、$k_y$ 和 $z$，它会产生 $k_x$ 的正变化。这提供了径向波数的解析表达式。\n\n从这个关系式出发，通过对 $z$ 求导，可以得到 $k_x(z)$ 的主导常微分方程（ODE）：\n$$ \\frac{d k_x}{dz} = \\frac{d}{dz} (k_{x0} + \\hat{s} k_y z) = \\hat{s} k_y $$\n该ODE表明，径向波数沿磁力线的变化率是一个常数，由磁剪切和副法向波数的乘积决定。\n\n#### 数值分析与误差预期\n这个问题要求使用向前欧拉法模拟 $k_x(z)$ 的演化。步长为 $\\Delta z$ 的更新规则是：\n$$ k_x(z_{i+1}) = k_x(z_i) + \\Delta z \\left. \\frac{d k_x}{dz} \\right|_{z_i} $$\n代入我们推导的ODE：\n$$ k_x(z_{i+1}) = k_x(z_i) + \\Delta z (\\hat{s} k_y) $$\n这个数值格式是一个简单的一阶积分器。其局部截断误差为 $\\mathcal{O}(\\Delta z^2)$ 阶。然而，对于我们的特定问题，解析解的二阶导数为零：\n$$ \\frac{d^2 k_x}{dz^2} = \\frac{d}{dz} (\\hat{s} k_y) = 0 $$\n由于所有更高阶的导数也为零，所以 $k_x(z)$ 的泰勒展开在一阶上是精确的。这意味着基于一阶泰勒展开的向前欧拉法不会引入任何截断误差。数值积分将精确地再现线性解析解，仅受浮点表示误差的影响。\n\n因此，可以预先预期最大绝对差 $E_{\\max} = \\max_z|k_{x, \\text{analytic}}(z) - k_{x, \\text{sim}}(z)|$ 将为零，或者是一个机器精度量级的非常小的数。\n\n#### 扭曲-平移索引变化\n扭曲-平移边界条件关联了模拟在平行区域两端，$z = -L_z/2$ 和 $z = +L_z/2$ 处的状态。径向波数在该区域内的总变化量是一个关键参数。\n对此变化的解析预测为：\n$$ \\Delta k_{x, \\text{total}} = k_x(+L_z/2) - k_x(-L_z/2) = (k_{x0} + \\hat{s} k_y \\frac{L_z}{2}) - (k_{x0} + \\hat{s} k_y \\frac{-L_z}{2}) = \\hat{s} k_y L_z $$\n相应的离散索引变化 $N_{\\text{pred}}$ 是这个总变化量所跨越的尺寸为 $\\Delta k_x$ 的网格单元数。问题指定对此值使用最接近的整数：\n$$ N_{\\text{pred}} = \\text{round}\\left(\\frac{\\Delta k_{x, \\text{total}}}{\\Delta k_x}\\right) = \\text{round}\\left(\\frac{\\hat{s} k_y L_z}{\\Delta k_x}\\right) $$\n术语“round”被解释为四舍五入到最接近的整数，在标准数值库（`numpy.rint`）中，恰好为一半的情况通常舍入到最接近的偶数。所提供的测试用例不会落在恰好一半的整数上，所以这个模糊性并不关键。\n\n模拟的索引变化 $N_{\\text{sim}}$ 的计算方法相同，但使用的是数值模拟在定义域边界处的值：\n$$ N_{\\text{sim}} = \\text{round}\\left(\\frac{k_{x, \\text{sim}}(+L_z/2) - k_{x, \\text{sim}}(-L_z/2)}{\\Delta k_x}\\right) $$\n由于我们已经确定数值模拟预期是精确的，我们必须得出结论，$k_{x, \\text{sim}} \\approx k_{x, \\text{analytic}}$ 在所有地方都成立。因此，$N_{\\text{sim}}$ 将等于 $N_{\\text{pred}}$，并且对于所有测试用例，要求的输出 $\\Delta N = N_{\\text{sim}} - N_{\\text{pred}}$ 预期为 $0$。\n\n#### 实现策略\n程序将为每个测试用例执行以下步骤：\n1.  定义从 $-L_z/2$ 到 $+L_z/2$ 的模拟网格 $z_i$，包含 $N=2001$ 个点。\n2.  计算解析解数组 $k_{x, \\text{analytic}}(z_i) = k_{x0} + \\hat{s} k_y z_i$。\n3.  初始化一个同样大小的模拟数组 $k_{x, \\text{sim}}$。将中心点（$z=0$处）的值设为 $k_{x0}$。\n4.  使用向前欧拉法则 $k_{x,i+1} = k_{x,i} + \\Delta z (\\hat{s} k_y)$，从中心点向前和向后步进，迭代计算 $k_{x, \\text{sim}}$ 数组的其余部分。\n5.  计算两个数组之间绝对差的最大值，即 $E_{\\max}$。\n6.  计算 $\\Delta k_{x, \\text{analytic}} = k_{x, \\text{analytic}}[-1] - k_{x, \\text{analytic}}[0]$ 以及 $\\Delta k_{x, \\text{sim}} = k_{x, \\text{sim}}[-1] - k_{x, \\text{sim}}[0]$。\n7.  使用 `numpy.rint` 和给定的 $\\Delta k_x$ 计算 $N_{\\text{pred}}$ 和 $N_{\\text{sim}}$。\n8.  计算整数差 $\\Delta N = N_{\\text{sim}} - N_{\\text{pred}}$。\n9.  为该用例存储数对 $[E_{\\max}, \\Delta N]$。\n10. 处理完所有用例后，将最终结果列表格式化为所要求的字符串输出。\n\n这构成了一个解决所述问题的完整而严谨的计划。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ballooning representation problem for a sheared slab model.\n\n    For each test case, this function:\n    1. Sets up a parallel coordinate grid.\n    2. Computes the analytic evolution of the radial wavenumber k_x(z).\n    3. Simulates the evolution of k_x(z) using a forward Euler method.\n    4. Calculates the maximum absolute difference (E_max) between the two.\n    5. Calculates the predicted and simulated twist-and-shift index changes\n       (N_pred, N_sim) and their difference (Delta_N).\n    6. Formats and prints the results as specified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k_x0, k_y, s_hat, L_z, delta_kx) with SI units.\n    test_cases = [\n        (0.0, 2.0, 0.3, 10.0, 0.5),   # Case A (general case)\n        (1.0, 2.0, 0.0, 10.0, 0.5),   # Case B (zero shear)\n        (0.5, 0.0, 0.25, 12.0, 0.6),   # Case C (zero binormal wavenumber)\n        (0.0, 3.0, -0.1, 20.0, 0.4),  # Case D (negative shear)\n        (0.2, 1.5, 0.2, 7.0, 0.8),    # Case E (non-integer mapping ratio)\n    ]\n\n    results = []\n    \n    # Number of grid points in the parallel direction\n    N = 2001\n\n    for case in test_cases:\n        k_x0, k_y, s_hat, L_z, delta_kx = case\n\n        # 1. Construct a uniform grid in the parallel coordinate z.\n        # z is in meters.\n        z = np.linspace(-L_z / 2.0, L_z / 2.0, N, dtype=np.float64)\n        dz = L_z / (N - 1)\n\n        # 2. Compute the analytic radial wavenumber k_x(z).\n        # The evolution relation is derived as k_x(z) = k_x0 + s_hat * k_y * z.\n        kx_analytic = k_x0 + s_hat * k_y * z\n\n        # 3. Numerically simulate the k_x(z) evolution.\n        # The ODE is dk_x/dz = s_hat * k_y.\n        kx_sim = np.zeros(N, dtype=np.float64)\n        \n        # Find the index corresponding to z = 0.\n        center_idx = (N - 1) // 2\n        \n        # Set the initial condition k_x(0) = k_x0.\n        kx_sim[center_idx] = k_x0\n        \n        # Use forward Euler stepping to integrate forward from the center.\n        dkx_dz = s_hat * k_y\n        for i in range(center_idx, N - 1):\n            kx_sim[i + 1] = kx_sim[i] + dz * dkx_dz\n            \n        # Use a consistent backward step to integrate backward from the center.\n        for i in range(center_idx, 0, -1):\n            kx_sim[i - 1] = kx_sim[i] - dz * dkx_dz\n\n        # 4. Compute the maximum absolute difference between analytic and simulated arrays.\n        E_max = np.max(np.abs(kx_analytic - kx_sim))\n\n        # 5. Compute the predicted and simulated discrete index changes.\n        \n        # Calculate the total change in kx across the domain for both methods.\n        delta_kx_total_analytic = kx_analytic[-1] - kx_analytic[0]\n        delta_kx_total_sim = kx_sim[-1] - kx_sim[0]\n\n        # Calculate the index change as the nearest integer to the ratio.\n        # numpy.rint rounds to the nearest integer (ties to nearest even).\n        N_pred = np.rint(delta_kx_total_analytic / delta_kx)\n        N_sim = np.rint(delta_kx_total_sim / delta_kx)\n        \n        # Compute the integer difference.\n        delta_N = int(N_sim - N_pred)\n        \n        results.append([E_max, delta_N])\n\n    # Final print statement in the exact required format.\n    # The problem description's example print statement implies that the\n    # default str() representation of a list (e.g., \"[0.0, 0]\") is acceptable.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}