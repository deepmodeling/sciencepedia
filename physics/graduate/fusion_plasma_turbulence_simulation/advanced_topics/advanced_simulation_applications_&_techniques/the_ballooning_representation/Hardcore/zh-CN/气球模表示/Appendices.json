{
    "hands_on_practices": [
        {
            "introduction": "本次练习将复杂的托卡马克几何结构简化为一个典型的一维问题。通过求解这个类似于量子谐振子的模型，你将揭示气球模本征函数的基本属性，例如其离散谱和确定的宇称性，这是建立关于气球模物理直觉的第一步。",
            "id": "4201994",
            "problem": "在强磁化等离子体静电涨落的气球模表示中，沿单根磁力线的模结构由一个标量包络 $\\phi(\\theta)$ 描述，其中 $\\theta$ 是扩展的极向角。在与聚变等离子体湍流模拟相关的局域强磁剪切极限下，由于磁剪切，垂直波数 $k_{\\perp}(\\theta)$ 随 $|\\theta|$ 近似呈二次方增长，从而产生一个有效的偶势。作为一个最小模型，考虑气球模包络的一维Sturm–Liouville本征问题，\n$$\n-\\,\\frac{d^{2}\\phi}{d\\theta^{2}} \\;+\\; \\Omega^{2}\\,\\theta^{2}\\,\\phi \\;=\\; \\Lambda\\,\\phi,\n$$\n其中 $\\Omega0$ 为常数，服从边界条件 $\\phi(\\theta)\\to 0$ 当 $|\\theta|\\to\\infty$ 时。假设采用无量纲归一化，使得 $\\theta$、$\\phi$ 和 $\\Lambda$ 均为无量纲量。\n\n从上述本征问题和偶势的宇称性质出发，完成以下任务：\n\n1. 利用具有偶系数的二阶自伴算符的一般性质，证明所有本征函数都可以选择在 $\\theta$ 上具有确定的宇称，并说明可能出现的两种宇称类别。\n\n2. 进行适当的无量纲化，将本征问题简化为偶势系数中没有自由尺度的典范形式，并引入相应的无量纲谱参数。明确说明您使用的重新标度。\n\n3. 通过在 $\\mathbb{R}$ 上强制要求 $\\phi(\\theta)$ 的平方可积性，推导无量纲谱参数的量子化条件，从而获得 $\\Lambda$ 的离散谱的闭合形式。您的推导必须从第一性原理构造可归一化的解，并且不得假设任何已知的特殊函数解。\n\n4. 根据您的构造，确定第 $n$ 个本征函数（$n=0,1,2,\\dots$）的宇称，并简要解释对称和反对称气球模本征函数的存在性如何从偶势中得出。\n\n以 $\\Lambda_{n}$ 作为 $\\Omega$ 和整数索引 $n$ 的函数的单一闭合形式表达式提供最终答案。不需要数值近似。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n已知条件如下：\n*   标量包络 $\\phi(\\theta)$ 的控制性本征问题：\n    $$-\\frac{d^{2}\\phi}{d\\theta^{2}} + \\Omega^{2}\\theta^{2}\\phi = \\Lambda\\phi$$\n*   常数 $\\Omega$ 为正：$\\Omega  0$。\n*   边界条件是解必须是物理上可接受的，这意味着它们在 $\\mathbb{R}$ 上是平方可积的。这表示为当 $|\\theta| \\to \\infty$ 时 $\\phi(\\theta) \\to 0$。\n*   变量 $\\theta$、$\\phi$ 和谱参数 $\\Lambda$ 均为无量纲。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n*   **科学基础**：所提供的方程在数学上等价于量子谐振子的不含时薛定谔方程。这是量子力学中的一个基石模型，并经常在数学物理中用作Sturm-Liouville问题的典范示例。将其用作聚变等离子体物理中气球模包络结构的简化模型，是在高磁剪切极限下的一种标准且物理上合理的近似。该问题是科学上可靠的。\n*   **适定性**：该问题是在无限域 $(-\\infty, \\infty)$ 上的正则Sturm-Liouville问题。势 $V(\\theta) = \\Omega^2\\theta^2$ 是束缚势，意味着当 $|\\theta| \\to \\infty$ 时 $V(\\theta) \\to \\infty$。已知这类问题拥有一个由实数本征值构成的离散谱和一套相应的完备的平方可积本征函数。该问题是适定的。\n*   **客观性**：该问题以精确的数学语言陈述，没有歧义或主观论断。\n*   **完备性与一致性**：该问题提供了确定本征值谱所需的所有必要信息（微分方程、定义域、边界条件以及常数 $\\Omega$ 的性质）。不存在矛盾之处。\n\n**步骤 3：结论与行动**\n\n该问题具有科学基础、适定、客观且自洽。这是一个有效的问题。可以开始解题过程。\n\n### 解题过程\n\n解题过程按顺序解决问题陈述的四个部分。\n\n**1. 本征函数的宇称**\n\n该本征问题由线性算符 $L = -\\frac{d^2}{d\\theta^2} + \\Omega^2\\theta^2$ 定义。势项为 $V(\\theta) = \\Omega^2\\theta^2$。这个势是 $\\theta$ 的偶函数，因为 $V(-\\theta) = \\Omega^2(-\\theta)^2 = \\Omega^2\\theta^2 = V(\\theta)$。动能项 $-\\frac{d^2}{d\\theta^2}$ 对于宇称变换 $\\theta \\to -\\theta$ 也是偶的。因此，整个算符 $L$ 是偶的。\n\n令 $P$ 为宇称算符，其对函数 $f(\\theta)$ 的作用定义为 $(P f)(\\theta) = f(-\\theta)$。如果一个算符 $A$ 与宇称算符对易，即 $[A, P] = AP - PA = 0$，则该算符是偶的。我们来验证我们的算符 $L$：\n$$ (L(P\\phi))(\\theta) = \\left(-\\frac{d^2}{d\\theta^2} + \\Omega^2\\theta^2\\right)\\phi(-\\theta) $$\n令 $\\eta = -\\theta$，则 $\\frac{d}{d\\theta} = -\\frac{d}{d\\eta}$ 且 $\\frac{d^2}{d\\theta^2} = \\frac{d^2}{d\\eta^2}$。\n$$ (L(P\\phi))(\\theta) = -\\frac{d^2\\phi}{d\\eta^2} + \\Omega^2(-\\eta)^2\\phi(\\eta) = -\\frac{d^2\\phi(\\eta)}{d\\eta^2} + \\Omega^2\\eta^2\\phi(\\eta) = (L\\phi)(\\eta) = (L\\phi)(-\\theta) = (P(L\\phi))(\\theta) $$\n由于对任意函数 $\\phi$，都有 $(L(P\\phi))(\\theta) = (P(L\\phi))(\\theta)$，我们得到 $LP = PL$，所以 $[L, P] = 0$。\n\n线性代数（以及量子力学）的一个基本定理指出，如果两个算符对易，它们共享一组共同的本征函数。宇称算符 $P$ 的本征函数是具有确定宇称的函数。如果 $\\psi$ 是 $P$ 的一个本征函数，本征值为 $p$，则 $P\\psi = p\\psi$。再次应用 $P$ 得到 $P^2\\psi = p^2\\psi$。但是 $P^2$ 是单位算符，因为 $(P(P\\psi))(\\theta) = \\psi(-(-\\theta)) = \\psi(\\theta)$。因此，$p^2=1$，宇称算符的本征值为 $p = 1$ 和 $p = -1$。\n\n*   本征值 $p=1$：$\\phi(-\\theta) = \\phi(\\theta)$。这些是**偶**函数（对称的）。\n*   本征值 $p=-1$：$\\phi(-\\theta) = -\\phi(\\theta)$。这些是**奇**函数（反对称的）。\n\n由于 $L$ 的本征函数可以选择同时也是 $P$ 的本征函数，所以给定问题的所有本征函数 $\\phi(\\theta)$ 都可以被分类为具有确定的宇称。这两个宇称类别是偶宇称和奇宇称。\n\n**2. 无量纲化至典范形式**\n\n原始本征问题是 $-\\frac{d^2\\phi}{d\\theta^2} + \\Omega^2\\theta^2\\phi = \\Lambda\\phi$。我们寻求一个变量替换 $\\theta = \\alpha x$ 来简化方程，其中 $\\alpha$ 是某个缩放因子。使用链式法则，$\\frac{d}{d\\theta} = \\frac{1}{\\alpha}\\frac{d}{dx}$ 且 $\\frac{d^2}{d\\theta^2} = \\frac{1}{\\alpha^2}\\frac{d^2}{dx^2}$。将其代入方程得到：\n$$ -\\frac{1}{\\alpha^2}\\frac{d^2\\phi}{dx^2} + \\Omega^2(\\alpha x)^2 \\phi = \\Lambda \\phi $$\n两边乘以 $\\alpha^2$：\n$$ -\\frac{d^2\\phi}{dx^2} + \\alpha^4\\Omega^2 x^2 \\phi = \\alpha^2\\Lambda \\phi $$\n为了将其简化为势项中没有自由参数的典范形式，我们选择 $x^2$ 的系数为 $1$。这要求 $\\alpha^4\\Omega^2 = 1$。由于 $\\Omega  0$，我们可以选择一个实数 $\\alpha  0$，得到 $\\alpha^2\\Omega = 1$，或 $\\alpha = 1/\\sqrt{\\Omega}$。\n\n因此，所需的重新标度为 $\\theta = x/\\sqrt{\\Omega}$。\n通过这个选择，本征问题变为：\n$$ -\\frac{d^2\\phi}{dx^2} + x^2 \\phi = \\frac{\\Lambda}{\\Omega} \\phi $$\n这就是量子谐振子方程的典范形式。相应的无量纲谱参数，我们称之为 $\\lambda$，由以下关系给出：\n$$ \\lambda = \\frac{\\Lambda}{\\Omega} $$\n\n**3. 量子化条件和谱的推导**\n\n我们必须找到重新标度后方程的平方可积解：\n$$ -\\frac{d^2\\phi}{dx^2} + x^2 \\phi = \\lambda \\phi $$\n首先，分析 $|x| \\to \\infty$ 时的渐近行为。在此极限下，$x^2\\phi$ 项远大于 $\\lambda\\phi$ 项，方程近似为 $\\frac{d^2\\phi}{dx^2} \\approx x^2\\phi$。具有这种渐近行为的解形式为 $\\exp(\\pm x^2/2)$。为了使解是平方可积的（即当 $|x| \\to \\infty$ 时 $\\phi \\to 0$），我们必须选择衰减的指数形式。这启发我们做出如下拟设：\n$$ \\phi(x) = H(x) \\exp\\left(-\\frac{x^2}{2}\\right) $$\n其中 $H(x)$ 是一个比 $\\exp(x^2/2)$ 增长慢的函数。我们计算 $\\phi(x)$ 的导数：\n$$ \\frac{d\\phi}{dx} = \\left(\\frac{dH}{dx} - xH\\right) \\exp\\left(-\\frac{x^2}{2}\\right) $$\n$$ \\frac{d^2\\phi}{dx^2} = \\left(\\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} - H + x^2H\\right) \\exp\\left(-\\frac{x^2}{2}\\right) $$\n将这些代入重新标度的微分方程中得到：\n$$ -\\left(\\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} - H + x^2H\\right) + x^2H = \\lambda H $$\n这简化为关于 $H(x)$ 的 Hermite 微分方程：\n$$ \\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} + (\\lambda-1)H = 0 $$\n我们使用 $H(x)$ 的幂级数展开，从第一性原理求解此方程：\n$$ H(x) = \\sum_{k=0}^{\\infty} c_k x^k $$\n其导数为 $H'(x) = \\sum_{k=1}^{\\infty} k c_k x^{k-1}$ 和 $H''(x) = \\sum_{k=2}^{\\infty} k(k-1) c_k x^{k-2}$。将这些代入 Hermite 方程：\n$$ \\sum_{k=2}^{\\infty} k(k-1) c_k x^{k-2} - 2x\\sum_{k=1}^{\\infty} k c_k x^{k-1} + (\\lambda-1)\\sum_{k=0}^{\\infty} c_k x^k = 0 $$\n对第一个和式重新索引，令 $j=k-2$（所以 $k=j+2$）：\n$$ \\sum_{j=0}^{\\infty} (j+2)(j+1) c_{j+2} x^j - \\sum_{k=1}^{\\infty} 2k c_k x^k + (\\lambda-1)\\sum_{k=0}^{\\infty} c_k x^k = 0 $$\n为了使 $x^k$ 的系数对所有 $k$ 都为零，我们将每个 $x$ 次幂的系数之和设为零。这得出了递推关系：\n$$ (k+2)(k+1)c_{k+2} - 2kc_k + (\\lambda-1)c_k = 0 $$\n$$ c_{k+2} = \\frac{2k - (\\lambda-1)}{(k+2)(k+1)} c_k = \\frac{2k+1-\\lambda}{(k+2)(k+1)} c_k $$\n对于大的 $k$，连续系数之比为 $c_{k+2}/c_k \\sim 2k/k^2 = 2/k$。这与 $\\exp(x^2)$ 的泰勒级数系数的渐近比相同。如果 $H(x)$ 的级数不终止，它将以 $\\exp(x^2)$ 的速率增长，从而导致 $\\phi(x) = H(x)\\exp(-x^2/2)$ 以 $\\exp(x^2/2)$ 的速率增长，违反了平方可积性条件。\n\n为了使级数终止，它必须是一个多项式。这发生在递推关系中的分子对某个非负整数 $k$ 等于零时。设这个整数为 $n$。\n$$ 2n + 1 - \\lambda = 0 $$\n这就给出了无量纲谱参数 $\\lambda$ 的量子化条件：\n$$ \\lambda_n = 2n+1, \\quad \\text{其中 } n = 0, 1, 2, \\ldots $$\n这个条件确保 $c_{n+2}=0$，并且根据递推关系，所有更高阶的系数 $c_{n+4}, c_{n+6}, \\ldots$ 也都为零，使得 $H(x)$ 成为一个 $n$ 次多项式。\n回想起 $\\lambda = \\Lambda/\\Omega$，我们找到本征值 $\\Lambda_n$ 的离散谱：\n$$ \\Lambda_n = \\Omega \\lambda_n = \\Omega(2n+1), \\quad n = 0, 1, 2, \\ldots $$\n\n**4. 第 $n$ 个本征函数的宇称**\n\n递推关系 $c_{k+2} = \\frac{2k+1-\\lambda}{(k+2)(k+1)} c_k$ 只关联指数相差 $2$ 的系数。这将级数解耦为两个独立的集合：一个用于 $x$ 的偶次幂（从 $c_0$ 开始），另一个用于 $x$ 的奇次幂（从 $c_1$ 开始）。\n*   如果我们选择 $c_1=0$，则所有奇次项系数都为零（$c_3=c_5=\\ldots=0$）。解是一个只包含偶次幂的级数。为使该级数终止，量子化条件 $\\lambda_n=2n+1$ 必须对一个偶数 $n$ 成立。得到的多项式 $H_n(x)$ 是一个偶函数，因此本征函数 $\\phi_n(x) = H_n(x)\\exp(-x^2/2)$ 具有偶宇称。这对应于 $n=0, 2, 4, \\ldots$。\n*   如果我们选择 $c_0=0$，则所有偶次项系数都为零（$c_2=c_4=\\ldots=0$）。解是一个只包含奇次幂的级数。为使该级数终止，条件 $\\lambda_n=2n+1$ 必须对一个奇数 $n$ 成立。得到的多项式 $H_n(x)$ 是一个奇函数，因此本征函数 $\\phi_n(x)$ 具有奇宇称。这对应于 $n=1, 3, 5, \\ldots$。\n\n因此，第 $n$ 个本征函数的宇称为 $(-1)^n$。基态（$n=0$）是偶宇称，第一激发态（$n=1$）是奇宇称，第二激发态（$n=2$）是偶宇称，依此类推。\n\n对称（偶）和反对称（奇）气球模本征函数的同时存在是该问题对称性的直接结果。正如在第1部分所确立的，由于有效势 $\\Omega^2\\theta^2$ 是一个偶函数，控制算符 $L$ 在宇称变换 $\\theta \\to -\\theta$ 下是不变的。这种对称性保证了本征函数可以被分入不同的宇称类别。由于定义域 $\\mathbb{R}$ 相对于原点也是对称的，没有任何约束会排除某一类解，因此两族解都必须存在。",
            "answer": "$$\\boxed{\\Omega(2n+1)}$$"
        },
        {
            "introduction": "现在，我们将把宇称性的概念扩展到一个更具体的物理场景中。本练习旨在探索磁平衡的对称性如何决定静电势 $\\phi$ 和平行矢量势 $A_{\\parallel}$ 在气球模域中心（$\\theta=0$）的结构，并展示抽象的对称性原理如何对不同物理场之间的耦合产生具体且可计算的影响。",
            "id": "4202011",
            "problem": "考虑托卡马克等离子体在高环向模数下的线性分析，采用气球模表示，其中场线坐标由气球模角 $ \\theta \\in (-\\infty,\\infty) $ 表示。假设一个上下对称的平衡，从而使得沿 $ \\theta $ 的模结构的线性化方程的系数是 $ \\theta $ 的偶函数。令 $ \\phi(\\theta) $ 表示静电势，$ A_{\\parallel}(\\theta) $ 表示电磁矢量势的平行分量。在此种上下对称系统中，可以选择本征函数具有关于 $ \\theta \\rightarrow -\\theta $ 的确定宇称。\n\n首先，仅使用宇称定义 $ X(\\theta)=X(-\\theta) $ (偶) 和 $ X(\\theta)=-X(-\\theta) $ (奇)，并结合控制系数在 $ \\theta $ 上为偶函数的假设，推导在 $ \\theta=0 $ 处必须满足的边界条件。这些边界条件适用于代表 $ \\phi(\\theta) $ 或 $ A_{\\parallel}(\\theta) $ 的任何偶宇称和奇宇称解 $ X(\\theta) $。用 $ X(0) $ 和 $ \\partial_{\\theta} X(0) $ 明确地表述这些边界条件。\n\n接下来，为了量化 $ \\phi(\\theta) $ 和 $ A_{\\parallel}(\\theta) $ 之间与回旋动理学（GK）理论中平行电场结构一致的最小电磁耦合，定义耦合泛函\n$$\nK \\doteq \\int_{-\\infty}^{\\infty} d\\theta \\, \\phi(\\theta)\\,\\frac{d A_{\\parallel}(\\theta)}{d\\theta}.\n$$\n假设局域化气球模包络，并在 $ \\theta=0 $ 附近采用以下与宇称一致的高斯拟设：\n- 对于具有静电（气球模）宇称的分支，取 $ \\phi_{\\mathrm{b}}(\\theta)=\\phi_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $ 和 $ A_{\\parallel,\\mathrm{b}}(\\theta)=A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $。\n- 对于具有撕裂模宇称的分支，取 $ \\phi_{\\mathrm{t}}(\\theta)=\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $ 和 $ A_{\\parallel,\\mathrm{t}}(\\theta)=A_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $。\n\n此处 $ \\phi_{0} $、$ A_{0} $ 和 $ \\Delta0 $ 是实常数。使用这些形式，通过将 $ (\\phi_{\\mathrm{b}},A_{\\parallel,\\mathrm{b}}) $ 和 $ (\\phi_{\\mathrm{t}},A_{\\parallel,\\mathrm{t}}) $ 代入 $ K $ 的定义中，计算 $ K_{\\mathrm{b}} $ 和 $ K_{\\mathrm{t}} $。然后计算比值\n$$\nR \\doteq \\frac{K_{\\mathrm{b}}}{K_{\\mathrm{t}}}.\n$$\n给出 $ R $ 的最终答案，形式为一个精确的无量纲数。无需进行四舍五入。",
            "solution": "该问题被评估为有效，因为它在聚变等离子体物理理论中有科学依据，是适定的、客观的、自洽的，并且在数学上是可解的。所有提供的信息都是一致且充分的，足以得出一个唯一的解。\n\n第一个任务是推导具有确定宇称的一般函数 $X(\\theta)$ 在 $\\theta=0$ 处的边界条件。\n\n对于偶宇称解，定义为 $X(\\theta) = X(-\\theta)$。两边对 $\\theta$ 求导得到 $\\partial_{\\theta}X(\\theta) = (\\partial_{\\theta}X)(-\\theta) \\cdot (-1) = - \\partial_{\\theta}X(-\\theta)$。这表明偶函数的导数是奇函数。对于任何奇函数 $f(\\theta)$，我们有 $f(0) = -f(-0) = -f(0)$，这意味着 $2 f(0) = 0$，所以 $f(0)=0$。因此，对于偶宇称解 $X(\\theta)$，其导数在原点必须为零：\n$$\n\\partial_{\\theta}X(0)=0.\n$$\n对于奇宇称解，定义为 $X(\\theta) = -X(-\\theta)$。在 $\\theta=0$ 处计算该式得到 $X(0) = -X(-0) = -X(0)$，这意味着 $2 X(0)=0$，所以 $X(0)=0$。因此，任何奇宇称解在原点必须为零：\n$$\nX(0)=0.\n$$\n对奇函数求导得到 $\\partial_{\\theta}X(\\theta) = -(\\partial_{\\theta}X)(-\\theta) \\cdot(-1) = \\partial_{\\theta}X(-\\theta)$，这表明其导数是偶函数。偶函数在 $\\theta=0$ 处通常不为零，所以 $\\partial_{\\theta}X(0)$ 可以是非零的。\n\n第二个任务是计算比值 $R \\doteq K_{\\mathrm{b}}/K_{\\mathrm{t}}$，其中 $K$ 是定义为如下的耦合泛函\n$$\nK \\doteq \\int_{-\\infty}^{\\infty} d\\theta \\, \\phi(\\theta)\\,\\frac{d A_{\\parallel}(\\theta)}{d\\theta}.\n$$\n问题为两个相反宇称的分支提供了高斯拟设。由于模是局域化的，函数 $\\phi(\\theta)$ 和 $A_{\\parallel}(\\theta)$ 被假定在 $\\theta \\to \\pm\\infty$ 时衰减到零。这允许对泛函 $K$ 进行分部积分：\n$$\nK = \\left[ \\phi(\\theta) A_{\\parallel}(\\theta) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} d\\theta \\, A_{\\parallel}(\\theta)\\,\\frac{d \\phi(\\theta)}{d\\theta}.\n$$\n边界项为零，从而得到该泛函的另一种形式：\n$$\nK = - \\int_{-\\infty}^{\\infty} d\\theta \\, A_{\\parallel}(\\theta)\\,\\frac{d \\phi(\\theta)}{d\\theta}.\n$$\n我们现在来计算 $K_{\\mathrm{b}}$ 和 $K_{\\mathrm{t}}$。为此，我们使用标准的高斯积分结果：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-a x^2) dx = \\sqrt{\\frac{\\pi}{a}}, \\quad \\int_{-\\infty}^{\\infty} x^2 \\exp(-a x^2) dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}\n$$\n对于任意实常数 $a0$。\n\n对于静电（气球模）宇称分支，拟设为：\n$$\n\\phi_{\\mathrm{b}}(\\theta)=\\phi_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{偶})\n$$\n$$\nA_{\\parallel,\\mathrm{b}}(\\theta)=A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{奇})\n$$\n我们使用分部积分形式计算 $K_{\\mathrm{b}}$。首先，我们求出 $\\phi_{\\mathrm{b}}(\\theta)$ 的导数：\n$$\n\\frac{d \\phi_{\\mathrm{b}}}{d\\theta} = \\phi_{0} \\left( -\\frac{2\\theta}{2\\Delta^{2}} \\right) \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) = -\\frac{\\phi_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right).\n$$\n现在，代入 $K_{\\mathrm{b}}$ 的积分中：\n$$\nK_{\\mathrm{b}} = - \\int_{-\\infty}^{\\infty} A_{\\parallel,\\mathrm{b}}(\\theta)\\,\\frac{d \\phi_{\\mathrm{b}}}{d\\theta} d\\theta = - \\int_{-\\infty}^{\\infty} \\left(A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) \\left(-\\frac{\\phi_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) d\\theta\n$$\n$$\nK_{\\mathrm{b}} = \\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta.\n$$\n使用高斯积分公式，其中 $a = 1/\\Delta^{2}$：\n$$\n\\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta = \\frac{1}{2(1/\\Delta^{2})} \\sqrt{\\frac{\\pi}{1/\\Delta^{2}}} = \\frac{\\Delta^{2}}{2} (\\Delta\\sqrt{\\pi}) = \\frac{\\Delta^{3}\\sqrt{\\pi}}{2}.\n$$\n因此，$K_{\\mathrm{b}}$ 为：\n$$\nK_{\\mathrm{b}} = \\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\left(\\frac{\\Delta^{3}\\sqrt{\\pi}}{2}\\right) = \\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}.\n$$\n\n对于撕裂模宇称分支，拟设为：\n$$\n\\phi_{\\mathrm{t}}(\\theta)=\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{奇})\n$$\n$$\nA_{\\parallel,\\mathrm{t}}(\\theta)=A_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{偶})\n$$\n我们使用原始定义计算 $K_{\\mathrm{t}}$。首先，我们求出 $A_{\\parallel,\\mathrm{t}}(\\theta)$ 的导数：\n$$\n\\frac{d A_{\\parallel,\\mathrm{t}}}{d\\theta} = A_{0} \\left( -\\frac{2\\theta}{2\\Delta^{2}} \\right) \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) = -\\frac{A_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right).\n$$\n现在，代入 $K_{\\mathrm{t}}$ 的积分中：\n$$\nK_{\\mathrm{t}} = \\int_{-\\infty}^{\\infty} \\phi_{\\mathrm{t}}(\\theta)\\,\\frac{d A_{\\parallel,\\mathrm{t}}}{d\\theta} d\\theta = \\int_{-\\infty}^{\\infty} \\left(\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) \\left(-\\frac{A_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) d\\theta\n$$\n$$\nK_{\\mathrm{t}} = -\\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta.\n$$\n这个积分与为 $K_{\\mathrm{b}}$ 计算的积分相同。\n$$\nK_{\\mathrm{t}} = -\\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\left(\\frac{\\Delta^{3}\\sqrt{\\pi}}{2}\\right) = -\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}.\n$$\n最后，我们计算比值 $R$：\n$$\nR = \\frac{K_{\\mathrm{b}}}{K_{\\mathrm{t}}} = \\frac{\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}}{-\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}}.\n$$\n假设振幅 $\\phi_{0}$ 和 $A_{0}$ 非零，表达式简化为：\n$$\nR = -1.\n$$\n结果是一个无量纲数，符合要求。该计算展示了在给定的理想化模结构下，相反宇称分支的耦合泛函之间存在一种基本的对称关系。",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "气球模表示的最终用途在于大规模数值模拟。本练习通过实现一个简化的气球模不稳定性模型为此提供了宝贵的实践经验，其目标是理解在气球模角（$\\theta$）和波数空间中的数值分辨率如何影响关键物理输出（如增长率和输运通量）的准确性，这是计算科学家必须掌握的一项关键技能。",
            "id": "4202001",
            "problem": "考虑聚变等离子体湍流中的球囊表示（Ballooning Representation, BR），其中场向坐标是极向角 $\\theta$（单位为弧度）。在一个简化的、但有科学依据的局部模型中，对于一个代表性的球囊不稳定性，在固定的垂直波数 $(k_x,k_y)$ 和极向角 $\\theta$ 下的瞬时线性增长率密度模型为\n$$\nD(\\theta,k_x,k_y) \\equiv \\omega_*\\,k_y + \\kappa \\exp\\!\\left(-\\frac{(\\theta-\\theta_0)^2}{2\\Delta^2}\\right) - \\nu\\,(k_x^2+k_y^2),\n$$\n其中所有量均为无量纲量，$\\theta$ 以弧度表示。参数 $\\omega_*$、$\\kappa$、$\\nu$、$\\theta_0$ 和 $\\Delta$ 分别代表抗磁漂移驱动系数、曲率驱动振幅、耗散阻尼系数、曲率驱动峰值位置及其平行局域化宽度。在强球囊极限下，$(k_x,k_y)$ 处的线性增长率由沿场线的上确界近似：\n$$\n\\gamma(k_x,k_y) \\equiv \\sup_{\\theta\\in[-\\pi,\\pi)} D(\\theta,k_x,k_y).\n$$\n在数值上，这通过在 $[-\\pi,\\pi)$ 上用 $N_\\theta$ 个点均匀采样 $\\theta$ 并用离散最大值代替上确界来近似。\n\n一个无量纲的准线性（QL）通量泛函通过对不稳定谱进行加权来定义，权重为净驱动，并使用一个预设的谱包络 $A(k_x,k_y)$：\n$$\nQ \\equiv \\iint \\mathrm{d}k_x\\,\\mathrm{d}k_y\\; k_y \\,\\max\\!\\left(0,\\gamma(k_x,k_y)\\right) A(k_x,k_y),\n$$\n其中\n$$\nA(k_x,k_y) = \\exp\\!\\left(-\\frac{k_x^2+k_y^2}{k_0^2}\\right).\n$$\n该连续积分通过一个均匀黎曼和来近似，在定义域 $k_x\\in[-K,K]$ 和 $k_y\\in[0,K]$ 上分别使用 $N_{k_x}$ 和 $N_{k_y}$ 个点。\n\n仅从上确界、均匀黎曼和以及前述具有物理动机的 $D(\\theta,k_x,k_y)$ 局部模型的定义出发，实现一个程序，该程序：\n- 构建在 $[-\\pi,\\pi)$ 上具有 $N_\\theta$ 个均匀间隔点的离散 $\\theta$ 网格。\n- 构建在 $[-K,K]$ 上具有 $N_{k_x}$ 个均匀间隔点的离散 $k_x$ 网格，以及在 $[0,K]$ 上具有 $N_{k_y}$ 个均匀间隔点的离散 $k_y$ 网格。\n- 对于每个 $(k_x,k_y)$，通过在离散 $\\theta$ 网格上最大化 $D(\\theta,k_x,k_y)$ 来计算 $\\gamma(k_x,k_y)$ 的离散近似。\n- 使用测度权重 $\\Delta k_x=(2K)/N_{k_x}$ 和 $\\Delta k_y=K/N_{k_y}$，通过上述积分的均匀黎曼和近似来计算 $Q$。\n\n为了量化收敛性，通过使用 $N_\\theta^{\\mathrm{ref}}$、$N_{k_x}^{\\mathrm{ref}}$ 和 $N_{k_y}^{\\mathrm{ref}}$ 定义一个参考解，并重复计算 $\\gamma(k_x,k_y)$ 和 $Q$：\n- 对于增长率误差，将粗网格的 $\\gamma(k_x,k_y)$ 与在相同的粗 $(k_x,k_y)$ 点上、但使用 $N_\\theta^{\\mathrm{ref}}$ 计算出的参考 $\\gamma^{\\mathrm{ref}}(k_x,k_y)$ 进行比较。使用相对二范数（$L^2$）误差\n$$\n\\varepsilon_\\gamma \\equiv \\frac{\\left\\|\\gamma-\\gamma^{\\mathrm{ref}}\\right\\|_{2}}{\\left\\|\\gamma^{\\mathrm{ref}}\\right\\|_{2}},\n$$\n其中范数是在粗 $(k_x,k_y)$ 网格上计算的。\n- 对于通量误差，将粗网格的 $Q$ 与使用 $(N_\\theta^{\\mathrm{ref}},N_{k_x}^{\\mathrm{ref}},N_{k_y}^{\\mathrm{ref}})$ 计算的参考 $Q^{\\mathrm{ref}}$ 进行比较，通过相对绝对误差\n$$\n\\varepsilon_Q \\equiv \\frac{\\left|Q-Q^{\\mathrm{ref}}\\right|}{\\left|Q^{\\mathrm{ref}}\\right|}.\n$$\n\n所有量均为无量纲量，角度必须以弧度表示。代表性不稳定性的参数为\n- $\\omega_* = 0.7$，\n- $\\kappa = 0.6$，\n- $\\nu = 0.3$，\n- $\\theta_0 = 0.4$，\n- $\\Delta = 0.5$，\n- $k_0 = 0.8$，\n- $K = 2.4$。\n使用以下参考分辨率：\n- $N_\\theta^{\\mathrm{ref}} = 1024$，\n- $N_{k_x}^{\\mathrm{ref}} = 64$，\n- $N_{k_y}^{\\mathrm{ref}} = 64$。\n\n您的程序必须对以下 $(N_\\theta,N_{k_x},N_{k_y})$ 测试套件评估误差对 $(\\varepsilon_\\gamma,\\varepsilon_Q)$：\n- 情况 $1$：$(32,16,16)$，一个通用的粗分辨率。\n- 情况 $2$：$(16,8,8)$，一个边界的粗分辨率。\n- 情况 $3$：$(64,32,8)$，各向异性分辨率，具有更精细的 $k_x$。\n- 情况 $4$：$(128,8,32)$，各向异性分辨率，具有更精细的 $k_y$。\n\n最终输出格式必须是单行文本，包含一个逗号分隔的 Python 风格列表的列表，其中每个内部列表是针对一种情况的 $[\\varepsilon_\\gamma,\\varepsilon_Q]$。例如，输出应如下所示\n$$\n[\\,[e_{\\gamma,1},e_{Q,1}],[e_{\\gamma,2},e_{Q,2}],[e_{\\gamma,3},e_{Q,3}],[e_{\\gamma,4},e_{Q,4}]\\,].\n$$",
            "solution": "问题陈述已经过验证，被认为是可靠的。它在一个简化的等离子体湍流模型的背景下具有科学依据，在数学上是适定的，并为确定性数值计算提供了一套完整且一致的定义和参数。未发现任何缺陷。\n\n目标是计算增长率谱 $\\gamma(k_x, k_y)$ 和相关的准线性通量 $Q$ 的粗网格近似相对于高分辨率参考解的数值收敛误差。这需要实现指定的物理模型和数值方案。\n\n该解决方案基于以下原则和算法步骤制定：\n\n**1. 物理和数值模型构建**\n\n问题的核心在于评估两个关键量。首先，瞬时线性增长率密度由以下函数给出：\n$$\nD(\\theta,k_x,k_y) \\equiv \\omega_*\\,k_y + \\kappa \\exp\\!\\left(-\\frac{(\\theta-\\theta_0)^2}{2\\Delta^2}\\right) - \\nu\\,(k_x^2+k_y^2)\n$$\n在这里，$\\theta$ 是场向坐标，$(k_x, k_y)$ 是垂直波数。参数 $\\omega_* = 0.7$、$\\kappa = 0.6$、$\\nu = 0.3$、$\\theta_0 = 0.4$ 和 $\\Delta = 0.5$ 是定义不稳定性物理特性的无量纲常数。\n\n其次，通过取 $D$ 在角度 $\\theta$ 的周期性域上的上确界来找到线性增长率 $\\gamma(k_x, k_y)$：\n$$\n\\gamma(k_x,k_y) \\equiv \\sup_{\\theta\\in[-\\pi,\\pi)} D(\\theta,k_x,k_y)\n$$\n在数值上，这通过在区间 $[-\\pi, \\pi)$ 内的 $N_\\theta$ 个离散均匀网格点上找到 $D$ 的最大值来近似。\n\n第三，准线性通量泛函 $Q$ 的计算方法是，将增长率的正部在波数空间 $(k_x, k_y)$ 上积分，并用 $k_y$ 和谱包络 $A(k_x, k_y)$ 进行加权：\n$$\nQ \\equiv \\iint \\mathrm{d}k_x\\,\\mathrm{d}k_y\\; k_y \\,\\max\\!\\left(0,\\gamma(k_x,k_y)\\right) A(k_x,k_y)\n$$\n谱包络是一个高斯函数，定义为：\n$$\nA(k_x,k_y) = \\exp\\!\\left(-\\frac{k_x^2+k_y^2}{k_0^2}\\right)\n$$\n其中 $k_0 = 0.8$。积分域为 $k_x \\in [-K, K]$ 和 $k_y \\in [0, K]$，其中 $K = 2.4$。该连续积分由离散网格上的均匀黎曼和近似。\n\n**2. 算法设计与实现**\n\n为了确保清晰性和正确性，计算被构建为模块化函数。\n\n**2.1. 网格生成**\n需要为 $\\theta$、$k_x$ 和 $k_y$ 生成离散网格。问题指定了分别具有 $N_\\theta$、$N_{k_x}$ 和 $N_{k_y}$ 个点的均匀网格。波数网格的步长明确给出为 $\\Delta k_x = (2K)/N_{k_x}$ 和 $\\Delta k_y = K/N_{k_y}$。通过生成覆盖区间但不包括端点的网格来满足此定义。对于具有 $N$ 个点的区间 $[a, b]$，步长为 $(b-a)/N$。因此，网格构造如下：\n- **$\\theta$ 网格：** 在 $[-\\pi, \\pi)$ 上的 $N_\\theta$ 个点，通过 `np.linspace(-np.pi, np.pi, N_theta, endpoint=False)` 生成。\n- **$k_x$ 网格：** 在 $[-K, K)$ 上的 $N_{k_x}$ 个点，通过 `np.linspace(-K, K, N_kx, endpoint=False)` 生成。相应的步长与指定的 $\\Delta k_x$ 匹配。\n- **$k_y$ 网格：** 在 $[0, K)$ 上的 $N_{k_y}$ 个点，通过 `np.linspace(0, K, N_ky, endpoint=False)` 生成。相应的步长与指定的 $\\Delta k_y$ 匹配。\n\n**2.2. $\\gamma(k_x, k_y)$ 的计算**\n为了高效计算 $\\gamma(k_x, k_y)$，我们利用了 `NumPy` 的矢量化和广播功能。\n1. 将 $k_x$ 和 $k_y$ 的一维网格扩展为形状为 $(N_{k_x}, N_{k_y})$ 的二维网格矩阵 `kx_grid` 和 `ky_grid`。\n2. 将 $\\theta$ 的一维网格重塑为 $(N_\\theta, 1, 1)$，波数网格重塑为 $(1, N_{k_x}, N_{k_y})$。\n3. 计算构成 $D(\\theta, k_x, k_y)$ 的三项。广播会自动扩展它们的维度，从而得到一个形状为 $(N_\\theta, N_{k_x}, N_{k_y})$ 的三维数组 $D$。这一单一操作在没有显式循环的情况下，在 $(\\theta, k_x, k_y)$ 网格的每个点上评估了增长率密度。\n4. 通过取三维数组 $D$ 沿 $\\theta$ 轴（轴 0）的最大值，找到对上确界的离散近似。结果是形状为 $(N_{k_x}, N_{k_y})$ 的二维数组 $\\gamma(k_x, k_y)$。\n\n**2.3. $Q$ 的计算**\n$Q$ 积分的黎曼和近似为：\n$$\nQ \\approx \\sum_{i=0}^{N_{k_x}-1} \\sum_{j=0}^{N_{k_y}-1} k_{y,j} \\,\\max\\!\\left(0,\\gamma(k_{x,i}, k_{y,j})\\right) A(k_{x,i}, k_{y,j}) \\,\\Delta k_x \\Delta k_y\n$$\n此实现方式如下：\n1. 在 $(k_x, k_y)$ 网格的每个点上计算被积函数 $I_{ij} = k_{y,j} \\,\\max(0, \\gamma_{ij}) A_{ij}$。\n2. 对得到的二维被积函数数组的所有元素求和。\n3. 将总和乘以面积元 $\\Delta k_x \\Delta k_y$。\n\n**3. 误差分析与收敛**\n\n核心任务是量化粗分辨率计算与高分辨率参考之间的误差。\n\n**3.1. 参考解**\n首先使用由 $(N_\\theta^{\\mathrm{ref}}, N_{k_x}^{\\mathrm{ref}}, N_{k_y}^{\\mathrm{ref}}) = (1024, 64, 64)$ 定义的精细网格计算参考解。这会得到参考通量 $Q^{\\mathrm{ref}}$。\n\n**3.2. 粗略解与误差计算**\n对于每个测试案例 $(N_\\theta, N_{k_x}, N_{k_y})$，计算粗网格通量 $Q$ 和增长率谱 $\\gamma$。然后按如下方式计算误差：\n\n- **通量误差 $\\varepsilon_Q$：** 直接计算相对绝对误差：\n  $$\n  \\varepsilon_Q = \\frac{\\left|Q - Q^{\\mathrm{ref}}\\right|}{\\left|Q^{\\mathrm{ref}}\\right|}\n  $$\n\n- **增长率误差 $\\varepsilon_\\gamma$：** 这需要更具体的比较。误差是粗网格 $\\gamma$ 与参考 $\\gamma^{\\mathrm{ref}}$ 之间差异的相对 $L^2$ 范数（或弗罗贝尼乌斯范数），其中两者都在*相同的粗 $(k_x, k_y)$ 网格*上进行评估。\n  $$\n  \\varepsilon_\\gamma = \\frac{\\left\\|\\gamma - \\gamma^{\\mathrm{ref}}\\right\\|_{2}}{\\left\\|\\gamma^{\\mathrm{ref}}\\right\\|_{2}}\n  $$\n  为了实现这一点，在粗 $(k_x, k_y)$ 网格上计算了两个 $\\gamma$ 谱：\n  1. $\\gamma$：使用粗极向分辨率 $N_\\theta$。\n  2. $\\gamma^{\\mathrm{ref}}$：使用参考极向分辨率 $N_\\theta^{\\mathrm{ref}}$。\n  然后使用 `np.linalg.norm` 对这两个二维数组之差计算 $L^2$ 范数。\n\n对所有四个测试案例重复此过程，并收集得到的误差对 $(\\varepsilon_\\gamma, \\varepsilon_Q)$ 以用于最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating convergence errors for a plasma turbulence model.\n    \"\"\"\n    \n    # Define physical and numerical parameters from the problem statement.\n    params = {\n        'omega_star': 0.7,\n        'kappa': 0.6,\n        'nu': 0.3,\n        'theta_0': 0.4,\n        'Delta': 0.5,\n        'k0': 0.8,\n        'K': 2.4,\n    }\n\n    # Define reference resolution.\n    ref_resolution = {\n        'N_theta': 1024,\n        'N_kx': 64,\n        'N_ky': 64,\n    }\n\n    # Define the test suite of coarse resolutions.\n    test_cases = [\n        (32, 16, 16),  # Case 1\n        (16, 8, 8),    # Case 2\n        (64, 32, 8),   # Case 3\n        (128, 8, 32),  # Case 4\n    ]\n\n    def compute_gamma(kx_vals, ky_vals, N_theta, p):\n        \"\"\"\n        Computes the growth rate gamma(kx, ky) on a given wavenumber grid.\n        \n        Args:\n            kx_vals (np.ndarray): 1D array of kx grid points.\n            ky_vals (np.ndarray): 1D array of ky grid points.\n            N_theta (int): Number of points for the theta grid.\n            p (dict): Dictionary of physical parameters.\n        \n        Returns:\n            np.ndarray: 2D array of gamma values.\n        \"\"\"\n        # Construct the theta grid.\n        theta_vals = np.linspace(-np.pi, np.pi, N_theta, endpoint=False)\n        \n        # Create meshgrids for kx and ky.\n        kx_grid, ky_grid = np.meshgrid(kx_vals, ky_vals, indexing='ij')\n\n        # Use broadcasting to compute D(theta, kx, ky) efficiently.\n        # Reshape arrays to (N_theta, 1, 1), (1, N_kx, N_ky), (1, N_kx, N_ky)\n        theta_r = theta_vals.reshape(-1, 1, 1)\n        kx_r = kx_grid.reshape(1, kx_grid.shape[0], kx_grid.shape[1])\n        ky_r = ky_grid.reshape(1, ky_grid.shape[0], ky_grid.shape[1])\n\n        # D(theta, kx, ky) = drive1 + drive2 - damping\n        diamagnetic_drive = p['omega_star'] * ky_r\n        curvature_drive = p['kappa'] * np.exp(-((theta_r - p['theta_0'])**2) / (2 * p['Delta']**2))\n        dissipation = p['nu'] * (kx_r**2 + ky_r**2)\n        \n        D_array = diamagnetic_drive + curvature_drive - dissipation\n        \n        # gamma is the supremum (max) over theta.\n        gamma = np.max(D_array, axis=0)\n        return gamma\n\n    def compute_Q(gamma_array, kx_vals, ky_vals, p):\n        \"\"\"\n        Computes the quasi-linear flux Q from a given gamma spectrum.\n\n        Args:\n            gamma_array (np.ndarray): 2D array of gamma values.\n            kx_vals (np.ndarray): 1D array of kx grid points.\n            ky_vals (np.ndarray): 1D array of ky grid points.\n            p (dict): Dictionary of physical parameters.\n\n        Returns:\n            float: The integrated quasi-linear flux Q.\n        \"\"\"\n        N_kx = len(kx_vals)\n        N_ky = len(ky_vals)\n        \n        kx_grid, ky_grid = np.meshgrid(kx_vals, ky_vals, indexing='ij')\n\n        # Spectral envelope A(kx, ky)\n        A = np.exp(-(kx_grid**2 + ky_grid**2) / p['k0']**2)\n        \n        # Integrand for the Q integral\n        integrand = ky_grid * np.maximum(0, gamma_array) * A\n        \n        # Uniform Riemann sum\n        delta_kx = (2 * p['K']) / N_kx\n        delta_ky = p['K'] / N_ky\n        \n        Q = np.sum(integrand) * delta_kx * delta_ky\n        return Q\n\n    # 1. Compute Reference Solution\n    N_theta_ref, N_kx_ref, N_ky_ref = ref_resolution.values()\n    \n    kx_ref_vals = np.linspace(-params['K'], params['K'], N_kx_ref, endpoint=False)\n    ky_ref_vals = np.linspace(0, params['K'], N_ky_ref, endpoint=False)\n    \n    gamma_ref_full = compute_gamma(kx_ref_vals, ky_ref_vals, N_theta_ref, params)\n    Q_ref = compute_Q(gamma_ref_full, kx_ref_vals, ky_ref_vals, params)\n\n    # List to store error pairs for each test case\n    error_results = []\n\n    # 2. Iterate through test cases\n    for N_theta_c, N_kx_c, N_ky_c in test_cases:\n        # Create coarse wavenumber grids\n        kx_c_vals = np.linspace(-params['K'], params['K'], N_kx_c, endpoint=False)\n        ky_c_vals = np.linspace(0, params['K'], N_ky_c, endpoint=False)\n        \n        # --- Calculate errors ---\n        \n        # a) For gamma error (eps_gamma):\n        # Compute gamma on the coarse k-grid using coarse N_theta.\n        gamma_c = compute_gamma(kx_c_vals, ky_c_vals, N_theta_c, params)\n        # Compute gamma on the coarse k-grid using reference N_theta.\n        gamma_ref_on_coarse = compute_gamma(kx_c_vals, ky_c_vals, N_theta_ref, params)\n        \n        # Calculate relative L2-norm error.\n        norm_diff_gamma = np.linalg.norm(gamma_c - gamma_ref_on_coarse)\n        norm_ref_gamma = np.linalg.norm(gamma_ref_on_coarse)\n        eps_gamma = norm_diff_gamma / norm_ref_gamma if norm_ref_gamma != 0 else 0.0\n\n        # b) For flux error (eps_Q):\n        # Compute Q on the coarse grid.\n        Q_c = compute_Q(gamma_c, kx_c_vals, ky_c_vals, params)\n        \n        # Calculate relative absolute error.\n        eps_Q = np.abs(Q_c - Q_ref) / np.abs(Q_ref) if Q_ref != 0 else 0.0\n\n        error_results.append([eps_gamma, eps_Q])\n\n    # 3. Format and print the final output\n    print(f\"[{','.join(str(r) for r in error_results)}]\")\n\nsolve()\n```"
        }
    ]
}