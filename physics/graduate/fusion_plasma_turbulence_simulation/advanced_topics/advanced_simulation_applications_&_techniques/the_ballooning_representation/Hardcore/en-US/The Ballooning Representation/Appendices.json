{
    "hands_on_practices": [
        {
            "introduction": "The structure of a ballooning mode along a magnetic field line can often be reduced to a familiar Sturm-Liouville problem. This practice demonstrates how, in a simple limit, the governing equation becomes mathematically identical to the Schrödinger equation for a quantum harmonic oscillator, providing a solid analytical foundation for understanding ballooning eigenfunctions . Working through this model from first principles will illuminate fundamental properties such as mode parity and the quantization of eigenvalues, connecting abstract plasma theory to a cornerstone of mathematical physics.",
            "id": "4201994",
            "problem": "In the ballooning representation for electrostatic fluctuations in a strongly magnetized plasma, the mode structure along a single magnetic field line is described by a scalar envelope $\\phi(\\theta)$, where $\\theta$ is the extended poloidal angle. In a local, strong-shear limit relevant to fusion plasma turbulence simulation, the perpendicular wavenumber $k_{\\perp}(\\theta)$ grows approximately quadratically with $|\\theta|$ due to magnetic shear, yielding an effective even potential. As a minimal model, consider the one-dimensional Sturm–Liouville eigenproblem for the ballooning envelope,\n$$\n-\\,\\frac{d^{2}\\phi}{d\\theta^{2}} \\;+\\; \\Omega^{2}\\,\\theta^{2}\\,\\phi \\;=\\; \\Lambda\\,\\phi,\n$$\nwith $\\Omega>0$ constant, subject to the boundary condition $\\phi(\\theta)\\to 0$ as $|\\theta|\\to\\infty$. Assume a dimensionless normalization such that $\\theta$, $\\phi$, and $\\Lambda$ are dimensionless.\n\nStarting from the above eigenproblem and the parity properties of even potentials, do the following:\n\n1. Using general properties of second-order self-adjoint operators with even coefficients, justify that all eigenfunctions can be chosen to have definite parity in $\\theta$, and state the two parity classes that can arise.\n\n2. Perform an appropriate non-dimensionalization that reduces the eigenproblem to a canonical form with no free scale in the coefficient of the even potential, and introduce the corresponding dimensionless spectral parameter. State explicitly the rescaling you use.\n\n3. By enforcing square-integrability of $\\phi(\\theta)$ on $\\mathbb{R}$, derive the quantization condition for the dimensionless spectral parameter and thereby obtain the discrete spectrum of $\\Lambda$ in closed form. Your derivation must construct normalizable solutions from first principles and must not assume any pre-known special-function solution.\n\n4. From your construction, determine the parity of the $n$-th eigenfunction (with $n=0,1,2,\\dots$) and explain briefly how the existence of both symmetric and antisymmetric ballooning eigenfunctions follows from the even potential.\n\nProvide the final answer as a single closed-form expression for the discrete eigenvalues $\\Lambda_{n}$ as a function of $\\Omega$ and the integer index $n$. No numerical approximation is required.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe givens are:\n*   The governing eigenproblem for the scalar envelope $\\phi(\\theta)$:\n    $$-\\frac{d^{2}\\phi}{d\\theta^{2}} + \\Omega^{2}\\theta^{2}\\phi = \\Lambda\\phi$$\n*   The constant $\\Omega$ is positive: $\\Omega > 0$.\n*   The boundary condition is that the solutions must be physically acceptable, which implies they are square-integrable on $\\mathbb{R}$. This is stated as $\\phi(\\theta) \\to 0$ as $|\\theta| \\to \\infty$.\n*   The variables $\\theta$, $\\phi$, and the spectral parameter $\\Lambda$ are dimensionless.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded**: The provided equation is mathematically equivalent to the time-independent Schrödinger equation for a quantum harmonic oscillator. This is a cornerstone model in quantum mechanics and is frequently used as a canonical example for Sturm-Liouville problems in mathematical physics. Its application as a simplified model for the ballooning envelope structure in fusion plasma physics is a standard and physically justified approximation in the high-shear limit. The problem is scientifically sound.\n*   **Well-Posed**: The problem is a regular Sturm-Liouville problem posed on the infinite domain $(-\\infty, \\infty)$. The potential $V(\\theta) = \\Omega^2\\theta^2$ is confining, meaning $V(\\theta) \\to \\infty$ as $|\\theta| \\to \\infty$. Such problems are known to possess a discrete spectrum of real eigenvalues and a corresponding complete set of square-integrable eigenfunctions. The problem is well-posed.\n*   **Objective**: The problem is stated in precise mathematical language, free of ambiguity or subjective claims.\n*   **Completeness and Consistency**: The problem provides all necessary information (the differential equation, the domain, the boundary conditions, and the properties of the constant $\\Omega$) to determine the eigenvalue spectrum. There are no contradictions.\n\n**Step 3: Verdict and Action**\n\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It is a valid problem. The solution process may proceed.\n\n### Solution\n\nThe solution proceeds by addressing the four parts of the problem statement in order.\n\n**1. Parity of Eigenfunctions**\n\nThe eigenproblem is defined by the linear operator $L = -\\frac{d^2}{d\\theta^2} + \\Omega^2\\theta^2$. The potential term is $V(\\theta) = \\Omega^2\\theta^2$. This potential is an even function of $\\theta$, since $V(-\\theta) = \\Omega^2(-\\theta)^2 = \\Omega^2\\theta^2 = V(\\theta)$. The kinetic term, $-\\frac{d^2}{d\\theta^2}$, is also even with respect to the parity transformation $\\theta \\to -\\theta$. Therefore, the entire operator $L$ is even.\n\nLet $P$ be the parity operator, defined by its action on a function $f(\\theta)$ as $(P f)(\\theta) = f(-\\theta)$. An operator $A$ is even if it commutes with the parity operator, i.e., $[A, P] = AP - PA = 0$. Let's check this for our operator $L$:\n$$ (L(P\\phi))(\\theta) = \\left(-\\frac{d^2}{d\\theta^2} + \\Omega^2\\theta^2\\right)\\phi(-\\theta) $$\nLet $\\eta = -\\theta$, so $\\frac{d}{d\\theta} = -\\frac{d}{d\\eta}$ and $\\frac{d^2}{d\\theta^2} = \\frac{d^2}{d\\eta^2}$.\n$$ (L(P\\phi))(\\theta) = -\\frac{d^2\\phi}{d\\eta^2} + \\Omega^2(-\\eta)^2\\phi(\\eta) = -\\frac{d^2\\phi(\\eta)}{d\\eta^2} + \\Omega^2\\eta^2\\phi(\\eta) = (L\\phi)(\\eta) = (L\\phi)(-\\theta) = (P(L\\phi))(\\theta) $$\nSince $(L(P\\phi))(\\theta) = (P(L\\phi))(\\theta)$ for any function $\\phi$, we have $LP = PL$, so $[L, P] = 0$.\n\nA fundamental theorem of linear algebra (and quantum mechanics) states that if two operators commute, they share a common set of eigenfunctions. The eigenfunctions of the parity operator $P$ are functions with definite parity. If $\\psi$ is an eigenfunction of $P$ with eigenvalue $p$, then $P\\psi = p\\psi$. Applying $P$ again gives $P^2\\psi = p^2\\psi$. But $P^2$ is the identity operator, since $(P(P\\psi))(\\theta) = \\psi(-(-\\theta)) = \\psi(\\theta)$. Thus, $p^2=1$, and the eigenvalues of the parity operator are $p = 1$ and $p = -1$.\n\n*   Eigenvalue $p=1$: $\\phi(-\\theta) = \\phi(\\theta)$. These are **even** functions (symmetric).\n*   Eigenvalue $p=-1$: $\\phi(-\\theta) = -\\phi(\\theta)$. These are **odd** functions (antisymmetric).\n\nSince the eigenfunctions of $L$ can be chosen to be also eigenfunctions of $P$, all eigenfunctions $\\phi(\\theta)$ of the given problem can be classified as having a definite parity. The two parity classes are even and odd.\n\n**2. Non-dimensionalization to Canonical Form**\n\nThe original eigenproblem is $-\\frac{d^2\\phi}{d\\theta^2} + \\Omega^2\\theta^2\\phi = \\Lambda\\phi$. We seek a change of variables $\\theta = \\alpha x$ for some scaling factor $\\alpha$ to simplify the equation. Using the chain rule, $\\frac{d}{d\\theta} = \\frac{1}{\\alpha}\\frac{d}{dx}$ and $\\frac{d^2}{d\\theta^2} = \\frac{1}{\\alpha^2}\\frac{d^2}{dx^2}$. Substituting this into the equation yields:\n$$ -\\frac{1}{\\alpha^2}\\frac{d^2\\phi}{dx^2} + \\Omega^2(\\alpha x)^2 \\phi = \\Lambda \\phi $$\nMultiplying by $\\alpha^2$:\n$$ -\\frac{d^2\\phi}{dx^2} + \\alpha^4\\Omega^2 x^2 \\phi = \\alpha^2\\Lambda \\phi $$\nTo reduce this to a canonical form with no free parameter in the potential term, we choose the coefficient of $x^2$ to be $1$. This requires $\\alpha^4\\Omega^2 = 1$. Since $\\Omega > 0$, we can choose a real $\\alpha > 0$, which gives $\\alpha^2\\Omega = 1$, or $\\alpha = 1/\\sqrt{\\Omega}$.\n\nThe required rescaling is therefore $\\theta = x/\\sqrt{\\Omega}$.\nWith this choice, the eigenproblem becomes:\n$$ -\\frac{d^2\\phi}{dx^2} + x^2 \\phi = \\frac{\\Lambda}{\\Omega} \\phi $$\nThis is the canonical form of the quantum harmonic oscillator equation. The corresponding dimensionless spectral parameter, let's call it $\\lambda$, is given by the relation:\n$$ \\lambda = \\frac{\\Lambda}{\\Omega} $$\n\n**3. Derivation of the Quantization Condition and Spectrum**\n\nWe must find the square-integrable solutions to the rescaled equation:\n$$ -\\frac{d^2\\phi}{dx^2} + x^2 \\phi = \\lambda \\phi $$\nFirst, analyze the asymptotic behavior as $|x| \\to \\infty$. In this limit, the $x^2\\phi$ term dominates the $\\lambda\\phi$ term, and the equation is approximately $\\frac{d^2\\phi}{dx^2} \\approx x^2\\phi$. The solutions with this asymptotic behavior are of the form $\\exp(\\pm x^2/2)$. For the solution to be square-integrable (i.e., $\\phi \\to 0$ as $|x| \\to \\infty$), we must choose the decaying exponential. This motivates the ansatz:\n$$ \\phi(x) = H(x) \\exp\\left(-\\frac{x^2}{2}\\right) $$\nwhere $H(x)$ is a function that grows slower than $\\exp(x^2/2)$. We compute the derivatives of $\\phi(x)$:\n$$ \\frac{d\\phi}{dx} = \\left(\\frac{dH}{dx} - xH\\right) \\exp\\left(-\\frac{x^2}{2}\\right) $$\n$$ \\frac{d^2\\phi}{dx^2} = \\left(\\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} - H + x^2H\\right) \\exp\\left(-\\frac{x^2}{2}\\right) $$\nSubstituting these into the rescaled differential equation gives:\n$$ -\\left(\\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} - H + x^2H\\right) + x^2H = \\lambda H $$\nThis simplifies to Hermite's differential equation for $H(x)$:\n$$ \\frac{d^2H}{dx^2} - 2x\\frac{dH}{dx} + (\\lambda-1)H = 0 $$\nWe solve this equation from first principles using a power series expansion for $H(x)$:\n$$ H(x) = \\sum_{k=0}^{\\infty} c_k x^k $$\nThe derivatives are $H'(x) = \\sum_{k=1}^{\\infty} k c_k x^{k-1}$ and $H''(x) = \\sum_{k=2}^{\\infty} k(k-1) c_k x^{k-2}$. Substituting these into Hermite's equation:\n$$ \\sum_{k=2}^{\\infty} k(k-1) c_k x^{k-2} - 2x\\sum_{k=1}^{\\infty} k c_k x^{k-1} + (\\lambda-1)\\sum_{k=0}^{\\infty} c_k x^k = 0 $$\nRe-indexing the first sum with $j=k-2$ (so $k=j+2$):\n$$ \\sum_{j=0}^{\\infty} (j+2)(j+1) c_{j+2} x^j - \\sum_{k=1}^{\\infty} 2k c_k x^k + (\\lambda-1)\\sum_{k=0}^{\\infty} c_k x^k = 0 $$\nFor the coefficient of $x^k$ to be zero for all $k$, we equate the sum of coefficients to zero for each power of $x$. This yields the recurrence relation:\n$$ (k+2)(k+1)c_{k+2} - 2kc_k + (\\lambda-1)c_k = 0 $$\n$$ c_{k+2} = \\frac{2k - (\\lambda-1)}{(k+2)(k+1)} c_k = \\frac{2k+1-\\lambda}{(k+2)(k+1)} c_k $$\nFor large $k$, the ratio of successive coefficients is $c_{k+2}/c_k \\sim 2k/k^2 = 2/k$. This is the same asymptotic ratio as the coefficients of the Taylor series for $\\exp(x^2)$. If the series for $H(x)$ does not terminate, it will grow as $\\exp(x^2)$, and consequently $\\phi(x) = H(x)\\exp(-x^2/2)$ would grow as $\\exp(x^2/2)$, violating the square-integrability condition.\n\nFor the series to terminate, it must be a polynomial. This occurs if the numerator in the recurrence relation becomes zero for some non-negative integer $k$. Let this integer be $n$.\n$$ 2n + 1 - \\lambda = 0 $$\nThis gives the quantization condition for the dimensionless spectral parameter $\\lambda$:\n$$ \\lambda_n = 2n+1, \\quad \\text{for } n = 0, 1, 2, \\ldots $$\nThis condition ensures that $c_{n+2}=0$, and by the recurrence, all higher coefficients $c_{n+4}, c_{n+6}, \\ldots$ are also zero, making $H(x)$ a polynomial of degree $n$.\nRecalling that $\\lambda = \\Lambda/\\Omega$, we find the discrete spectrum of eigenvalues $\\Lambda_n$:\n$$ \\Lambda_n = \\Omega \\lambda_n = \\Omega(2n+1), \\quad n = 0, 1, 2, \\ldots $$\n\n**4. Parity of the $n$-th Eigenfunction**\n\nThe recurrence relation $c_{k+2} = \\frac{2k+1-\\lambda}{(k+2)(k+1)} c_k$ only links coefficients whose indices differ by $2$. This decouples the series into two independent sets: one for even powers of $x$ (starting from $c_0$) and one for odd powers of $x$ (starting from $c_1$).\n*   If we choose $c_1=0$, all odd coefficients vanish ($c_3=c_5=\\ldots=0$). The solution is a series of only even powers. For this series to terminate, the quantization condition $\\lambda_n=2n+1$ must hold for an even integer $n$. The resulting polynomial $H_n(x)$ is an even function, and therefore the eigenfunction $\\phi_n(x) = H_n(x)\\exp(-x^2/2)$ has even parity. This corresponds to $n=0, 2, 4, \\ldots$.\n*   If we choose $c_0=0$, all even coefficients vanish ($c_2=c_4=\\ldots=0$). The solution is a series of only odd powers. For this series to terminate, the condition $\\lambda_n=2n+1$ must hold for an odd integer $n$. The resulting polynomial $H_n(x)$ is an odd function, and the eigenfunction $\\phi_n(x)$ has odd parity. This corresponds to $n=1, 3, 5, \\ldots$.\n\nTherefore, the parity of the $n$-th eigenfunction is $(-1)^n$. The ground state ($n=0$) is even, the first excited state ($n=1$) is odd, the second excited state ($n=2$) is even, and so on.\n\nThe existence of both symmetric (even) and antisymmetric (odd) ballooning eigenfunctions is a direct consequence of the symmetry of the problem. As established in part 1, the governing operator $L$ is invariant under the parity transformation $\\theta \\to -\\theta$ because the effective potential $\\Omega^2\\theta^2$ is an even function. This symmetry guarantees that the eigenfunctions can be sorted into distinct parity classes. Since the domain $\\mathbb{R}$ is also symmetric with respect to the origin, there is no constraint that would eliminate one class of solutions over the other, so both families of solutions must exist.",
            "answer": "$$\\boxed{\\Omega(2n+1)}$$"
        },
        {
            "introduction": "Building on the concept of mode parity, this practice investigates how symmetry distinguishes different types of electromagnetic instabilities in a tokamak. You will derive the boundary conditions at the point of symmetry for even (\"ballooning\") and odd (\"tearing\") parity modes and explore how this classification impacts the coupling between the electrostatic potential $\\phi$ and the parallel vector potential $A_\\|$ . This exercise demonstrates a fundamental principle: the underlying symmetry of the system imposes powerful constraints that determine the qualitative nature of instabilities.",
            "id": "4202011",
            "problem": "Consider a high toroidal mode number linear analysis in the ballooning representation of a tokamak plasma, with the field-line coordinate denoted by the ballooning angle $ \\theta \\in (-\\infty,\\infty) $. Assume an up–down symmetric equilibrium so that the coefficients of the linearized equations for the mode structure along $ \\theta $ are even functions of $ \\theta $. Let $ \\phi(\\theta) $ denote the electrostatic potential and $ A_{\\parallel}(\\theta) $ denote the parallel component of the electromagnetic vector potential. In such up–down symmetric systems, eigenfunctions may be chosen to be of definite parity with respect to $ \\theta \\rightarrow -\\theta $. \n\nFirst, use only the parity definitions $ X(\\theta)=X(-\\theta) $ (even) and $ X(\\theta)=-X(-\\theta) $ (odd), together with the assumption that the governing coefficients are even in $ \\theta $, to derive the boundary conditions at $ \\theta=0 $ that must be satisfied by any even- and odd-parity solutions $ X(\\theta) $ representative of $ \\phi(\\theta) $ or $ A_{\\parallel}(\\theta) $. State these boundary conditions explicitly in terms of $ X(0) $ and $ \\partial_{\\theta} X(0) $.\n\nNext, to quantify a minimal electromagnetic coupling between $ \\phi(\\theta) $ and $ A_{\\parallel}(\\theta) $ that is consistent with the structure of the parallel electric field in gyrokinetic (GK) theory, define the coupling functional\n$$\nK \\doteq \\int_{-\\infty}^{\\infty} d\\theta \\, \\phi(\\theta)\\,\\frac{d A_{\\parallel}(\\theta)}{d\\theta}.\n$$\nAssume localized ballooning envelopes and adopt the following parity-consistent Gaussian ansatzes near $ \\theta=0 $:\n- For a branch with electrostatic (ballooning) parity, take $ \\phi_{\\mathrm{b}}(\\theta)=\\phi_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $ and $ A_{\\parallel,\\mathrm{b}}(\\theta)=A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $.\n- For a branch with tearing parity, take $ \\phi_{\\mathrm{t}}(\\theta)=\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $ and $ A_{\\parallel,\\mathrm{t}}(\\theta)=A_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) $.\n\nHere $ \\phi_{0} $, $ A_{0} $, and $ \\Delta0 $ are real constants. Using these forms, compute $ K_{\\mathrm{b}} $ and $ K_{\\mathrm{t}} $ obtained by substituting $ (\\phi_{\\mathrm{b}},A_{\\parallel,\\mathrm{b}}) $ and $ (\\phi_{\\mathrm{t}},A_{\\parallel,\\mathrm{t}}) $ into the definition of $ K $. Then compute the ratio\n$$\nR \\doteq \\frac{K_{\\mathrm{b}}}{K_{\\mathrm{t}}}.\n$$\nProvide your final answer for $ R $ as a single exact dimensionless number. No rounding is required.",
            "solution": "The problem is evaluated as valid, as it is scientifically grounded in the theory of fusion plasma physics, well-posed, objective, self-contained, and mathematically solvable. All provided information is consistent and sufficient to arrive at a unique solution.\n\nThe first task is to derive the boundary conditions at $\\theta=0$ for a general function $X(\\theta)$ of definite parity.\n\nFor an even-parity solution, the definition is $X(\\theta) = X(-\\theta)$. Differentiating both sides with respect to $\\theta$ yields $\\partial_{\\theta}X(\\theta) = (\\partial_{\\theta}X)(-\\theta) \\cdot (-1) = - \\partial_{\\theta}X(-\\theta)$. This shows that the derivative of an even function is an odd function. For any odd function $f(\\theta)$, we have $f(0) = -f(-0) = -f(0)$, which implies $2 f(0) = 0$, so $f(0)=0$. Therefore, for an even-parity solution $X(\\theta)$, its derivative must vanish at the origin:\n$$\n\\partial_{\\theta}X(0)=0.\n$$\nFor an odd-parity solution, the definition is $X(\\theta) = -X(-\\theta)$. Evaluating this at $\\theta=0$ gives $X(0) = -X(-0) = -X(0)$, which implies $2 X(0)=0$, so $X(0)=0$. Therefore, any odd-parity solution must vanish at the origin:\n$$\nX(0)=0.\n$$\nDifferentiating an odd function gives $\\partial_{\\theta}X(\\theta) = -(\\partial_{\\theta}X)(-\\theta) \\cdot(-1) = \\partial_{\\theta}X(-\\theta)$, which shows the derivative is an even function. An even function does not generally vanish at $\\theta=0$, so $\\partial_{\\theta}X(0)$ can be non-zero.\n\nThe second task is to compute the ratio $R \\doteq K_{\\mathrm{b}}/K_{\\mathrm{t}}$, where $K$ is the coupling functional defined as\n$$\nK \\doteq \\int_{-\\infty}^{\\infty} d\\theta \\, \\phi(\\theta)\\,\\frac{d A_{\\parallel}(\\theta)}{d\\theta}.\n$$\nThe problem provides Gaussian ansatzes for two branches of opposite parity. Since the modes are localized, the functions $\\phi(\\theta)$ and $A_{\\parallel}(\\theta)$ are assumed to decay to zero as $\\theta \\to \\pm\\infty$. This allows for integration by parts on the functional $K$:\n$$\nK = \\left[ \\phi(\\theta) A_{\\parallel}(\\theta) \\right]_{-\\infty}^{\\infty} - \\int_{-\\infty}^{\\infty} d\\theta \\, A_{\\parallel}(\\theta)\\,\\frac{d \\phi(\\theta)}{d\\theta}.\n$$\nThe boundary term vanishes, yielding an alternative form for the functional:\n$$\nK = - \\int_{-\\infty}^{\\infty} d\\theta \\, A_{\\parallel}(\\theta)\\,\\frac{d \\phi(\\theta)}{d\\theta}.\n$$\nWe will now compute $K_{\\mathrm{b}}$ and $K_{\\mathrm{t}}$. For this calculation, we use the standard Gaussian integral results:\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-a x^2) dx = \\sqrt{\\frac{\\pi}{a}}, \\quad \\int_{-\\infty}^{\\infty} x^2 \\exp(-a x^2) dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}\n$$\nfor any real constant $a>0$.\n\nFor the electrostatic (ballooning) parity branch, the ansatzes are:\n$$\n\\phi_{\\mathrm{b}}(\\theta)=\\phi_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{even})\n$$\n$$\nA_{\\parallel,\\mathrm{b}}(\\theta)=A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{odd})\n$$\nWe calculate $K_{\\mathrm{b}}$ using the integration-by-parts form. First, we find the derivative of $\\phi_{\\mathrm{b}}(\\theta)$:\n$$\n\\frac{d \\phi_{\\mathrm{b}}}{d\\theta} = \\phi_{0} \\left( -\\frac{2\\theta}{2\\Delta^{2}} \\right) \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) = -\\frac{\\phi_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right).\n$$\nNow, substitute into the integral for $K_{\\mathrm{b}}$:\n$$\nK_{\\mathrm{b}} = - \\int_{-\\infty}^{\\infty} A_{\\parallel,\\mathrm{b}}(\\theta)\\,\\frac{d \\phi_{\\mathrm{b}}}{d\\theta} d\\theta = - \\int_{-\\infty}^{\\infty} \\left(A_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) \\left(-\\frac{\\phi_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) d\\theta\n$$\n$$\nK_{\\mathrm{b}} = \\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta.\n$$\nUsing the Gaussian integral formula with $a = 1/\\Delta^{2}$:\n$$\n\\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta = \\frac{1}{2(1/\\Delta^{2})} \\sqrt{\\frac{\\pi}{1/\\Delta^{2}}} = \\frac{\\Delta^{2}}{2} (\\Delta\\sqrt{\\pi}) = \\frac{\\Delta^{3}\\sqrt{\\pi}}{2}.\n$$\nThus, $K_{\\mathrm{b}}$ is:\n$$\nK_{\\mathrm{b}} = \\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\left(\\frac{\\Delta^{3}\\sqrt{\\pi}}{2}\\right) = \\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}.\n$$\n\nFor the tearing parity branch, the ansatzes are:\n$$\n\\phi_{\\mathrm{t}}(\\theta)=\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{odd})\n$$\n$$\nA_{\\parallel,\\mathrm{t}}(\\theta)=A_{0}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) \\quad (\\text{even})\n$$\nWe calculate $K_{\\mathrm{t}}$ using the original definition. First, we find the derivative of $A_{\\parallel,\\mathrm{t}}(\\theta)$:\n$$\n\\frac{d A_{\\parallel,\\mathrm{t}}}{d\\theta} = A_{0} \\left( -\\frac{2\\theta}{2\\Delta^{2}} \\right) \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right) = -\\frac{A_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right).\n$$\nNow, substitute into the integral for $K_{\\mathrm{t}}$:\n$$\nK_{\\mathrm{t}} = \\int_{-\\infty}^{\\infty} \\phi_{\\mathrm{t}}(\\theta)\\,\\frac{d A_{\\parallel,\\mathrm{t}}}{d\\theta} d\\theta = \\int_{-\\infty}^{\\infty} \\left(\\phi_{0}\\,\\frac{\\theta}{\\Delta}\\,\\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) \\left(-\\frac{A_{0}\\theta}{\\Delta^{2}} \\exp\\!\\left(-\\frac{\\theta^{2}}{2\\Delta^{2}}\\right)\\right) d\\theta\n$$\n$$\nK_{\\mathrm{t}} = -\\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\int_{-\\infty}^{\\infty} \\theta^{2} \\exp\\!\\left(-\\frac{\\theta^{2}}{\\Delta^{2}}\\right) d\\theta.\n$$\nThe integral is identical to the one computed for $K_{\\mathrm{b}}$.\n$$\nK_{\\mathrm{t}} = -\\frac{\\phi_{0}A_{0}}{\\Delta^{3}} \\left(\\frac{\\Delta^{3}\\sqrt{\\pi}}{2}\\right) = -\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}.\n$$\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{K_{\\mathrm{b}}}{K_{\\mathrm{t}}} = \\frac{\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}}{-\\frac{1}{2}\\phi_{0}A_{0}\\sqrt{\\pi}}.\n$$\nAssuming the amplitudes $\\phi_{0}$ and $A_{0}$ are non-zero, the expression simplifies to:\n$$\nR = -1.\n$$\nThe result is a dimensionless number, as required. The calculation demonstrates a fundamental symmetry relationship between the coupling functionals of opposite parity branches under the given idealized mode structures.",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "To translate the ballooning representation from theory into a computational tool, one must correctly implement the effects of magnetic shear. This hands-on coding practice focuses on the \"twist-and-shift\" boundary condition, a cornerstone of flux-tube simulations that captures how the radial wavenumber $k_x$ evolves along a sheared magnetic field line . By deriving the analytic evolution of $k_x(z)$ and implementing a simple numerical integrator to reproduce it, you will perform a fundamental verification test that builds confidence in the numerical representation of the field-line geometry.",
            "id": "4201936",
            "problem": "Consider the ballooning representation in a sheared slab model for fusion plasma turbulence simulation. In a local field-aligned coordinate system, let the position be decomposed as $x$ (radial), $y$ (binormal), and $z$ (parallel along the magnetic field). The perpendicular plane-wave phase is defined by the scalar product of the perpendicular wavevector with position. Under magnetic shear, the binormal coordinate is linearly deformed along the parallel direction, which induces an evolution of the radial wavenumber as one follows a mode along $z$. Starting from the field-aligned representation assumptions, the perpendicular phase of a mode may be written as $k_x x + k_y y$ at $z=0$, and the sheared slab deformation may be expressed as a linear mapping of $y$ with $z$. Using these foundations, derive the governing relation for the evolution of the radial wavenumber as a function of the parallel coordinate $z$.\n\nThe twist-and-shift boundary condition used in flux-tube simulations enforces a discrete mapping at the parallel boundaries: after traversing a parallel domain length $L_z$, the mode connects to a shifted radial wavenumber index on a uniformly discretized radial-wavenumber grid with spacing $\\Delta k_x$. Formulate the theoretical prediction for this discrete index change based solely on the evolution of the radial wavenumber along the field line and the grid spacing.\n\nYour task is to implement a program that, for each provided test case, performs the following steps:\n\n1. Construct a uniform grid in the parallel coordinate $z \\in [-L_z/2, +L_z/2]$ with $N=2001$ points (inclusive), in meters.\n2. Compute the analytic radial wavenumber $k_x(z)$ on this grid, using the evolution relation derived from the sheared slab ballooning representation, with parameters: initial radial wavenumber $k_{x0}$ in $\\mathrm{m}^{-1}$, binormal wavenumber $k_y$ in $\\mathrm{m}^{-1}$, magnetic shear $\\hat{s}$ in $\\mathrm{m}^{-1}$, and parallel domain length $L_z$ in $\\mathrm{m}$.\n3. Numerically simulate the $k_x(z)$ evolution on the same grid using a stepwise update consistent with the derived ordinary differential equation for $k_x(z)$ with respect to $z$. Use a simple forward Euler stepping in $z$ that accumulates the change in $k_x$ across the grid.\n4. Compute the maximum absolute difference between the analytic and simulated $k_x(z)$ arrays over the entire grid. Express this difference in $\\mathrm{m}^{-1}$.\n5. Compute the predicted discrete twist-and-shift index change $N_{\\text{pred}}$ as the nearest integer to the ratio of the net radial wavenumber change across the domain to the radial-wavenumber grid spacing $\\Delta k_x$. Compute the numerically realized index change $N_{\\text{sim}}$ from the simulated $k_x(z)$ at the two ends of the domain using the same nearest-integer rule. Report the integer difference $N_{\\text{sim}} - N_{\\text{pred}}$.\n\nAll quantities must be handled in International System of Units (SI). In particular, $z$ must be in meters, $k_x$, $k_y$, and $\\Delta k_x$ in $\\mathrm{m}^{-1}$, and $\\hat{s}$ in $\\mathrm{m}^{-1}$. Angles are not used in this problem.\n\nTest Suite:\nUse the following parameter sets, each given as $(k_{x0}, k_y, \\hat{s}, L_z, \\Delta k_x)$ with units $(\\mathrm{m}^{-1}, \\mathrm{m}^{-1}, \\mathrm{m}^{-1}, \\mathrm{m}, \\mathrm{m}^{-1})$:\n- Case A (general case): $(0.0, 2.0, 0.3, 10.0, 0.5)$\n- Case B (zero shear): $(1.0, 2.0, 0.0, 10.0, 0.5)$\n- Case C (zero binormal wavenumber): $(0.5, 0.0, 0.25, 12.0, 0.6)$\n- Case D (negative shear): $(0.0, 3.0, -0.1, 20.0, 0.4)$\n- Case E (non-integer mapping ratio): $(0.2, 1.5, 0.2, 7.0, 0.8)$\n\nRequired Final Output Format:\nYour program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets. Each per-case result must itself be a two-element list of the form $[E_{\\max}, \\Delta N]$, where $E_{\\max}$ is the maximum absolute difference in $\\mathrm{m}^{-1}$ (a float) and $\\Delta N$ is the integer difference $N_{\\text{sim}} - N_{\\text{pred}}$. For example: \"[[Emax_caseA,DeltaN_caseA],[Emax_caseB,DeltaN_caseB],...]\" where each element corresponds in order to the cases listed above.",
            "solution": "The problem statement will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Coordinate System**: A local field-aligned system with coordinates $x$ (radial), $y$ (binormal), and $z$ (parallel).\n- **Mode Representation**: A perpendicular plane-wave phase at $z=0$ is given by $k_x x + k_y y$.\n- **Magnetic Shear Model**: The sheared slab model involves a linear deformation of the binormal coordinate $y$ with the parallel coordinate $z$, which in turn causes the radial wavenumber $k_x$ to evolve as a function of $z$.\n- **Boundary Condition**: A twist-and-shift boundary condition is used over a parallel domain of length $L_z$, connecting the mode to a shifted radial wavenumber index on a discrete grid of spacing $\\Delta k_x$.\n- **Simulation Parameters**:\n    - Parallel grid: Uniformly discretized in $z \\in [-L_z/2, +L_z/2]$ with $N=2001$ points.\n    - Initial radial wavenumber at $z=0$: $k_{x0}$ [$\\mathrm{m}^{-1}$].\n    - Binormal wavenumber: $k_y$ [$\\mathrm{m}^{-1}$].\n    - Magnetic shear parameter: $\\hat{s}$ [$\\mathrm{m}^{-1}$].\n    - Parallel domain length: $L_z$ [m].\n    - Radial wavenumber grid spacing: $\\Delta k_x$ [$\\mathrm{m}^{-1}$].\n- **Tasks**:\n    1. Construct the parallel grid for $z$.\n    2. Compute the analytic form of $k_x(z)$.\n    3. Simulate the evolution of $k_x(z)$ using a forward Euler method based on the ODE for $dk_x/dz$.\n    4. Calculate $E_{\\max}$, the maximum absolute difference between the analytic and simulated $k_x(z)$ arrays.\n    5. Calculate the predicted integer index change $N_{\\text{pred}}$ from the analytic result and the simulated change $N_{\\text{sim}}$ from the numerical result, both using a nearest-integer rounding rule. Report the difference $\\Delta N = N_{\\text{sim}} - N_{\\text{pred}}$.\n- **Test Cases**: Five sets of parameters $(k_{x0}, k_y, \\hat{s}, L_z, \\Delta k_x)$ are provided.\n- **Units**: All quantities are specified in SI units.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria.\n- **Scientifically Grounded**: The problem is based on the well-established ballooning representation used in the theory and simulation of micro-instabilities in magnetically confined fusion plasmas. The sheared slab model is a standard simplified geometry for studying such phenomena. The concepts of field-aligned coordinates, wavenumber evolution due to shear, and twist-and-shift boundary conditions are all standard in the field of gyrokinetic simulation. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly defined. It asks for a specific derivation, a numerical implementation with all necessary parameters ($k_{x0}$, $k_y$, $\\hat{s}$, $L_z$, $\\Delta k_x$, $N$) and methods (forward Euler) provided, and the calculation of specific, well-defined metrics ($E_{\\max}$, $\\Delta N$). A unique, stable, and meaningful solution exists.\n- **Objective**: The problem is stated in precise, technical language, free of ambiguity, subjectivity, or opinion.\n- **Flaw Checklist**: The problem does not violate any of the specified invalidity criteria. It is formalizable, complete, physically plausible, and requires non-trivial reasoning and implementation. The relationship between the parameters and the physical model is consistent. The term $\\hat{s}$ is given in units of $\\mathrm{m}^{-1}$, which is appropriate for a slab model where it represents the gradient of the magnetic field pitch, $d(B_y/B_z)/dx$.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\n### Principle-Based Design and Solution\n\n#### Theoretical Derivation\nThe core of the problem lies in determining the functional form of the radial wavenumber $k_x$ as it varies with the parallel coordinate $z$. This relationship is a direct consequence of adopting a coordinate system that follows the sheared magnetic field lines.\n\nIn a sheared slab model, the magnetic field can be represented as $\\vec{B} \\approx B_0(\\hat{z} + \\hat{s} x \\hat{y})$, where $\\hat{s}$ represents the magnetic shear. A field line is a curve whose tangent is everywhere parallel to $\\vec{B}$. The equation for a field line is $d\\vec{l}/ds \\propto \\vec{B}$, which gives the component relations $dx/B_x = dy/B_y = dz/B_z$. In this model, this implies $dx/0 = dy/(B_0 \\hat{s} x) = dz/B_0$, leading to $dy/dz = \\hat{s} x$.\n\nTo simplify the description of wave-like perturbations, we transform to a field-following coordinate system $(x, y', z)$, where $y'$ is constant along a field line. From $dy/dz = \\hat{s} x$, one can define such a coordinate as $y' = y - \\hat{s} x z$.\n\nLet us consider a single Fourier mode. In the lab frame $(x,y,z)$, its phase is given by $\\alpha(x,y,z)$. A mode that is simple in the field-following frame might be described by a phase $\\alpha = k_{x0} x + k_y y'$, where $k_{x0}$ and $k_y$ are constant wavenumbers. Transforming this phase back to the lab frame coordinates gives:\n$$ \\alpha = k_{x0} x + k_y (y - \\hat{s} x z) = k_{x0} x + k_y y - \\hat{s} k_y z x $$\nRearranging the terms to group the spatial dependencies, we get:\n$$ \\alpha = (k_{x0} - \\hat{s} k_y z) x + k_y y $$\nThis expression has the form $\\alpha = k_x(z) x + k_y y$, where the radial wavenumber $k_x(z)$ explicitly depends on the parallel coordinate $z$. By direct comparison, and adopting a common sign convention, we find:\n$$ k_x(z) = k_{x0} + \\hat{s} k_y z $$\nThis provides the analytic expression for the radial wavenumber.\n\nFrom this relation, the governing ordinary differential equation (ODE) for $k_x(z)$ is obtained by differentiation with respect to $z$:\n$$ \\frac{d k_x}{dz} = \\frac{d}{dz} (k_{x0} + \\hat{s} k_y z) = \\hat{s} k_y $$\nThis ODE states that the rate of change of the radial wavenumber along the field line is constant, determined by the product of the magnetic shear and the binormal wavenumber.\n\n#### Numerical Analysis and Error Expectation\nThe problem requires simulating the evolution of $k_x(z)$ using the forward Euler method. The update rule for a step $\\Delta z$ is:\n$$ k_x(z_{i+1}) = k_x(z_i) + \\Delta z \\left. \\frac{d k_x}{dz} \\right|_{z_i} $$\nSubstituting our derived ODE:\n$$ k_x(z_{i+1}) = k_x(z_i) + \\Delta z (\\hat{s} k_y) $$\nThis numerical scheme is a simple first-order integrator. Its local truncation error is of order $\\mathcal{O}(\\Delta z^2)$. However, for our specific problem, the second derivative of the analytic solution is zero:\n$$ \\frac{d^2 k_x}{dz^2} = \\frac{d}{dz} (\\hat{s} k_y) = 0 $$\nSince all higher-order derivatives are also zero, the Taylor expansion of $k_x(z)$ is exact to first order. This means the forward Euler method, which is based on a first-order Taylor expansion, will not introduce any truncation error. The numerical integration will exactly reproduce the linear analytic solution, subject only to floating-point representation errors.\n\nTherefore, it is an a priori expectation that the maximum absolute difference $E_{\\max} = \\max_z|k_{x, \\text{analytic}}(z) - k_{x, \\text{sim}}(z)|$ will be zero, or a very small number on the order of machine precision.\n\n#### Twist-and-Shift Index Change\nThe twist-and-shift boundary condition relates the state of the simulation at the two ends of the parallel domain, $z = -L_z/2$ and $z = +L_z/2$. The total change in the radial wavenumber across this domain is a key parameter.\nThe analytic prediction for this change is:\n$$ \\Delta k_{x, \\text{total}} = k_x(+L_z/2) - k_x(-L_z/2) = (k_{x0} + \\hat{s} k_y \\frac{L_z}{2}) - (k_{x0} + \\hat{s} k_y \\frac{-L_z}{2}) = \\hat{s} k_y L_z $$\nThe corresponding discrete index change, $N_{\\text{pred}}$, is the number of grid cells of size $\\Delta k_x$ that this total change spans. The problem specifies using the nearest integer for this value:\n$$ N_{\\text{pred}} = \\text{round}\\left(\\frac{\\Delta k_{x, \\text{total}}}{\\Delta k_x}\\right) = \\text{round}\\left(\\frac{\\hat{s} k_y L_z}{\\Delta k_x}\\right) $$\nThe term \"round\" is interpreted as rounding to the nearest integer.\n\nThe simulated index change, $N_{\\text{sim}}$, is computed identically, but using the values from the numerical simulation at the domain boundaries:\n$$ N_{\\text{sim}} = \\text{round}\\left(\\frac{k_{x, \\text{sim}}(+L_z/2) - k_{x, \\text{sim}}(-L_z/2)}{\\Delta k_x}\\right) $$\nSince we have established that the numerical simulation is expected to be exact, we must conclude that $k_{x, \\text{sim}} \\approx k_{x, \\text{analytic}}$ everywhere. Consequently, $N_{\\text{sim}}$ will be equal to $N_{\\text{pred}}$, and the required output $\\Delta N = N_{\\text{sim}} - N_{\\text{pred}}$ is expected to be $0$ for all test cases.\n\n#### Implementation Strategy\nThe program will execute the following steps for each test case:\n1.  Define the simulation grid $z_i$ from $-L_z/2$ to $+L_z/2$ with $N=2001$ points.\n2.  Calculate the analytic solution array $k_{x, \\text{analytic}}(z_i) = k_{x0} + \\hat{s} k_y z_i$.\n3.  Initialize a simulation array $k_{x, \\text{sim}}$ of the same size. Set the central point (at $z=0$) to $k_{x0}$.\n4.  Iteratively compute the rest of the $k_{x, \\text{sim}}$ array by stepping forward and backward from the center using the forward Euler rule: $k_{x,i+1} = k_{x,i} + \\Delta z (\\hat{s} k_y)$.\n5.  Compute $E_{\\max}$ as the maximum of the absolute difference between the two arrays.\n6.  Calculate $N_{\\text{pred}}$ from the total analytic change and $N_{\\text{sim}}$ from the total simulated change.\n7.  Compute the integer difference $\\Delta N = N_{\\text{sim}} - N_{\\text{pred}}$.\n8.  Store the pair $[E_{\\max}, \\Delta N]$ for the case.\n9.  After processing all cases, the final list of results will be formatted into the required string output.\n\nThis constitutes a complete and rigorous plan for solving the posed problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ballooning representation problem for a sheared slab model.\n\n    For each test case, this function:\n    1. Sets up a parallel coordinate grid.\n    2. Computes the analytic evolution of the radial wavenumber k_x(z).\n    3. Simulates the evolution of k_x(z) using a forward Euler method.\n    4. Calculates the maximum absolute difference (E_max) between the two.\n    5. Calculates the predicted and simulated twist-and-shift index changes\n       (N_pred, N_sim) and their difference (Delta_N).\n    6. Formats and prints the results as specified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k_x0, k_y, s_hat, L_z, delta_kx) with SI units.\n    test_cases = [\n        (0.0, 2.0, 0.3, 10.0, 0.5),   # Case A (general case)\n        (1.0, 2.0, 0.0, 10.0, 0.5),   # Case B (zero shear)\n        (0.5, 0.0, 0.25, 12.0, 0.6),   # Case C (zero binormal wavenumber)\n        (0.0, 3.0, -0.1, 20.0, 0.4),  # Case D (negative shear)\n        (0.2, 1.5, 0.2, 7.0, 0.8),    # Case E (non-integer mapping ratio)\n    ]\n\n    results = []\n    \n    # Number of grid points in the parallel direction\n    N = 2001\n\n    for case in test_cases:\n        k_x0, k_y, s_hat, L_z, delta_kx = case\n\n        # 1. Construct a uniform grid in the parallel coordinate z.\n        # z is in meters.\n        z = np.linspace(-L_z / 2.0, L_z / 2.0, N, dtype=np.float64)\n        dz = L_z / (N - 1)\n\n        # 2. Compute the analytic radial wavenumber k_x(z).\n        # The evolution relation is k_x(z) = k_x0 + s_hat * k_y * z.\n        kx_analytic = k_x0 + s_hat * k_y * z\n\n        # 3. Numerically simulate the k_x(z) evolution.\n        # The ODE is dk_x/dz = s_hat * k_y.\n        kx_sim = np.zeros(N, dtype=np.float64)\n        \n        # Find the index corresponding to z = 0.\n        center_idx = (N - 1) // 2\n        \n        # Set the initial condition k_x(0) = k_x0.\n        kx_sim[center_idx] = k_x0\n        \n        # Use forward Euler stepping to integrate forward from the center.\n        dkx_dz = s_hat * k_y\n        for i in range(center_idx, N - 1):\n            kx_sim[i + 1] = kx_sim[i] + dz * dkx_dz\n            \n        # Use a consistent backward step to integrate backward from the center.\n        for i in range(center_idx, 0, -1):\n            kx_sim[i - 1] = kx_sim[i] - dz * dkx_dz\n\n        # 4. Compute the maximum absolute difference between analytic and simulated arrays.\n        E_max = np.max(np.abs(kx_analytic - kx_sim))\n\n        # 5. Compute the predicted and simulated discrete index changes.\n        \n        # Calculate the total change in kx across the domain for both methods.\n        # This is kx(L_z/2) - kx(-L_z/2)\n        delta_kx_total_analytic = kx_analytic[-1] - kx_analytic[0]\n        delta_kx_total_sim = kx_sim[-1] - kx_sim[0]\n\n        # Calculate the index change as the nearest integer to the ratio.\n        # numpy.rint rounds to the nearest integer (ties to nearest even).\n        N_pred = np.rint(delta_kx_total_analytic / delta_kx)\n        N_sim = np.rint(delta_kx_total_sim / delta_kx)\n        \n        # Compute the integer difference.\n        delta_N = int(N_sim - N_pred)\n        \n        results.append([E_max, delta_N])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}