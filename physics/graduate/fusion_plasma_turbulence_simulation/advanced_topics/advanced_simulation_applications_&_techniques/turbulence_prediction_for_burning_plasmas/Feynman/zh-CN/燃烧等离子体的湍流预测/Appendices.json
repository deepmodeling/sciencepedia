{
    "hands_on_practices": [
        {
            "introduction": "在深入研究湍流之前，理解由碰撞和磁场几何决定的基线“新经典”输运至关重要。本练习将通过计算关键的无量纲参数来确定输运机制，从而巩固对碰撞性及其在定义输运区（例如燃烧等离子体特有的香蕉区）中作用的理解。通过这项实践，您将学会如何根据等离子体核心参数来判断主导的碰撞输运机制。",
            "id": "4208357",
            "problem": "一个类似ITER的燃烧等离子体芯部的特征是主半径大而反环径比相对较小，其参数代表了中等半径处的芯部区域。考虑平均质量为 $m_i \\approx 2.5 m_p$ 的氘-氚离子，其中 $m_p$ 是质子质量。在主半径为 $R$、安全因子为 $q$ 的托卡马克内部，径向位置 $r$ 处的反环径比为 $\\epsilon \\equiv r/R$。给定以下与ITER相关的值：\n- $R = 6.2\\,\\mathrm{m}$,\n- $r = 0.6\\,\\mathrm{m}$,\n- $q = 1.4$,\n- 离子温度 $T_i = 15\\,\\mathrm{keV}$,\n- 离子密度 $n_i = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$,\n- 库仑对数 $\\ln\\Lambda = 17$,\n- 离子电荷数 $Z = 1$.\n\n将离子布居视为单一有效粒子种类（氘-氚混合物），其 $m_i = 2.5 m_p$ 且 $Z=1$。使用以下常数：$m_p = 1.6726\\times 10^{-27}\\,\\mathrm{kg}$, $e = 1.602\\times 10^{-19}\\,\\mathrm{C}$, $\\epsilon_0 = 8.854\\times 10^{-12}\\,\\mathrm{F/m}$, 以及玻尔兹曼常数 $k_B$ 且 $1\\,\\mathrm{eV} = 1.602\\times 10^{-19}\\,\\mathrm{J}$。假设为轴对称托卡马克几何，并使用标准的导心和库仑碰撞物理。\n\n基于第一性原理，完成以下任务：\n1. 根据动理论计算离子热速度 $v_{\\mathrm{th,i}}$。\n2. 使用经典的Spitzer公式计算同种离子碰撞的离子-离子碰撞频率 $\\nu_{ii}$。\n3. 通过将平行连接长度与 $qR$ 相关联，并使用捕获粒子运动的几何标度 $\\epsilon$，估算深捕获离子的弹跳频率 $\\omega_b$。\n4. 构建一个无量纲的捕获粒子碰撞率 $\\nu^{*}$，该碰撞率比较螺距角散射率与弹跳动力学及捕获层宽度，并对给定参数计算其量值。\n5. 使用您计算的 $\\nu^{*}$ 和 $\\epsilon$，判断此ITER芯部中的离子输运处于香蕉区、平台区还是Pfirsch-Schluter区，并通过比较相关的时间尺度来证明您的选择。\n\n选择正确的区域：\n- A. 香蕉区\n- B. 平台区\n- C. Pfirsch-Schluter区\n- D. 接近平台区–Pfirsch-Schluter区过渡",
            "solution": "首先验证问题陈述，以确保其科学上合理、良定且客观。\n\n### 步骤1：提取给定条件\n以下是逐字提供的参数和常数：\n- 主半径: $R = 6.2\\,\\mathrm{m}$\n- 小半径位置: $r = 0.6\\,\\mathrm{m}$\n- 安全因子: $q = 1.4$\n- 离子温度: $T_i = 15\\,\\mathrm{keV}$\n- 离子密度: $n_i = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$\n- 库仑对数: $\\ln\\Lambda = 17$\n- 离子电荷数: $Z = 1$\n- 平均离子质量: $m_i = 2.5 m_p$\n- 质子质量: $m_p = 1.6726\\times 10^{-27}\\,\\mathrm{kg}$\n- 基本电荷: $e = 1.602\\times 10^{-19}\\,\\mathrm{C}$\n- 真空介电常数: $\\epsilon_0 = 8.854\\times 10^{-12}\\,\\mathrm{F/m}$\n- 能量转换: $1\\,\\mathrm{eV} = 1.602\\times 10^{-19}\\,\\mathrm{J}$\n\n问题要求使用这些给定值计算几个等离子体参数，并确定这个类ITER芯部的离子输运区。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学上合理**：该问题设置在托卡马克新经典输运理论的既定框架内，这是等离子体物理学的核心课题。香蕉区、平台区和Pfirsch-Schlüter区的概念是基础性的。所提供的参数（$R$, $T_i$, $n_i$, $q$）是现实的，并代表了像ITER这样的燃烧等离子体实验芯部的目标运行条件。诸如将D-T混合物视为单一离子种类的简化，对于这种水平的分析是标准且合适的。\n- **良定性**：问题定义清晰。它要求基于所提供的数据进行一系列计算，从而得出关于输运区的确定性结论。待计算的量基于标准公式，且用于划分输运区的标准是公认的，这确保了唯一解的存在。\n- **客观性**：问题以精确、定量和技术性的语言陈述，没有任何主观或模糊的术语。\n\n### 步骤3：结论与行动\n问题陈述有效。它科学上合理、良定且客观。没有矛盾、缺失数据或不符合物理的假设。因此，我将继续进行完整的推导和求解。\n\n---\n\n### 推导\n任务是通过计算无量纲碰撞率 $\\nu^{*}$ 来确定离子输运区。这需要逐步计算几个关键的等离子体参数。\n\n首先，我们用国际单位制（SI）计算一些初步的量。\n- 反环径比为 $\\epsilon = r/R = 0.6\\,\\mathrm{m} / 6.2\\,\\mathrm{m} \\approx 0.09677$。\n- 平均离子质量为 $m_i = 2.5 \\times m_p = 2.5 \\times (1.6726 \\times 10^{-27}\\,\\mathrm{kg}) = 4.1815 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 以焦耳为单位的离子温度为 $k_B T_i = 15\\,\\mathrm{keV} = 15 \\times 10^3\\,\\mathrm{eV} \\times (1.602 \\times 10^{-19}\\,\\mathrm{J/eV}) = 2.403 \\times 10^{-15}\\,\\mathrm{J}$。在等离子体物理学中，以能量单位（如 $\\mathrm{eV}$）给出的温度通常代表乘积 $k_B T$。\n\n**1. 计算离子热速度 $v_{\\mathrm{th,i}}$**\n热速度是根据动能定义的。在动理论中，一个标准的定义对应于麦克斯韦分布中的最概然速率，即：\n$$v_{\\mathrm{th,i}} = \\sqrt{\\frac{2 k_B T_i}{m_i}}$$\n代入数值：\n$$v_{\\mathrm{th,i}} = \\sqrt{\\frac{2 \\times (2.403 \\times 10^{-15}\\,\\mathrm{J})}{4.1815 \\times 10^{-27}\\,\\mathrm{kg}}} = \\sqrt{1.1493 \\times 10^{12}\\,\\mathrm{m^2/s^2}} \\approx 1.072 \\times 10^6\\,\\mathrm{m/s}$$\n\n**2. 计算离子-离子碰撞频率 $\\nu_{ii}$**\n在麦克斯韦分布上平均的离子-离子 $90^{\\circ}$ 散射频率由标准公式给出：\n$$\\nu_{ii} = \\frac{4\\sqrt{\\pi} n_i Z^4 e^4 \\ln\\Lambda}{3 (4\\pi \\epsilon_0)^2 m_i^{1/2} (k_B T_i)^{3/2}}$$\n我们来计算这个表达式的各个部分：\n- 分子：$4\\sqrt{\\pi} n_i Z^4 e^4 \\ln\\Lambda = 4\\sqrt{\\pi} (1.0 \\times 10^{20}) (1)^4 (1.602 \\times 10^{-19})^4 (17) \\approx 7.913 \\times 10^{-54}\\,\\mathrm{C^4 m^{-3}}$\n- 分母：$3 (4\\pi \\epsilon_0)^2 m_i^{1/2} (k_B T_i)^{3/2}$\n- $(4\\pi \\epsilon_0)^2 = (4\\pi \\times 8.854 \\times 10^{-12})^2 \\approx 1.238 \\times 10^{-20}\\,\\mathrm{F^2/m^2}$\n- $m_i^{1/2} = (4.1815 \\times 10^{-27})^{1/2} \\approx 6.466 \\times 10^{-14}\\,\\mathrm{kg^{1/2}}$\n- $(k_B T_i)^{3/2} = (2.403 \\times 10^{-15})^{3/2} \\approx 3.729 \\times 10^{-23}\\,\\mathrm{J^{3/2}}$\n- 分母 $\\approx 3 \\times (1.238 \\times 10^{-20}) \\times (6.466 \\times 10^{-14}) \\times (3.729 \\times 10^{-23}) \\approx 8.956 \\times 10^{-56}\\,\\mathrm{F^2 kg^{1/2} J^{3/2} m^{-2}}$\n综合这些：\n$$\\nu_{ii} = \\frac{7.913 \\times 10^{-54}}{8.956 \\times 10^{-56}} \\approx 88.36\\,\\mathrm{s^{-1}}$$\n\n**3. 估算深捕获离子的弹跳频率 $\\omega_b$**\n对于被捕获在托卡马克磁阱中的粒子，弹跳频率是其沿磁力线在两个镜点之间周期性运动的特征频率。对于深捕获粒子，该频率可以估算为：\n$$\\omega_b \\approx \\frac{v_{||}}{L_c} \\sim \\frac{\\sqrt{\\epsilon} v_{\\mathrm{th,i}}}{qR}$$\n这里，$v_{||} \\sim \\sqrt{\\epsilon} v_{\\mathrm{th,i}}$ 是捕获粒子的特征平行速度，$L_c \\approx qR$ 是连接长度。\n$$\\omega_b \\approx \\frac{\\sqrt{0.09677} \\times (1.072 \\times 10^6\\,\\mathrm{m/s})}{1.4 \\times 6.2\\,\\mathrm{m}} = \\frac{0.3111 \\times 1.072 \\times 10^6}{8.68} \\approx 3.84 \\times 10^4\\,\\mathrm{rad/s}$$\n\n**4. 构建并计算无量纲碰撞率 $\\nu^{*}$**\n无量纲碰撞率 $\\nu^*$ 比较了捕获粒子散射出捕获速度空间区域的有效碰撞频率与其弹跳频率。有效碰撞频率为 $\\nu_{\\mathrm{eff}} \\approx \\nu_{ii}/\\epsilon$，因为只需要量级为 $\\sqrt{\\epsilon}$ 的小螺距角散射即可实现解捕获。\n离子碰撞率的标准定义是：\n$$\\nu^*_i = \\frac{\\nu_{\\mathrm{eff}}}{\\omega_b} = \\frac{\\nu_{ii}/\\epsilon}{\\omega_b} = \\frac{\\nu_{ii} q R}{\\epsilon^{3/2} v_{\\mathrm{th,i}}}$$\n代入计算出的值：\n- $\\epsilon^{3/2} = (0.09677)^{1.5} \\approx 0.03011$\n$$\\nu^*_i = \\frac{88.36\\,\\mathrm{s^{-1}} \\times 1.4 \\times 6.2\\,\\mathrm{m}}{0.03011 \\times (1.072 \\times 10^6\\,\\mathrm{m/s})} = \\frac{766.9}{32278} \\approx 0.02375$$\n因此，离子碰撞率为 $\\nu^*_i \\approx 0.024$。\n\n**5. 确定输运区**\n新经典输运区由 $\\nu^*_i$ 的值定义：\n- **香蕉区**：$\\nu^*_i \\ll 1$。在此区域，有效碰撞频率远小于弹跳频率（$\\nu_{\\mathrm{eff}} \\ll \\omega_b$）。捕获粒子在被散射之前会完成许多次弹跳轨道。\n- **平台区**：$1 \\lesssim \\nu^*_i \\lesssim \\epsilon^{-3/2}$。碰撞足够频繁，可以中断香蕉轨道，但又不是那么频繁以至于平均自由程短于连接长度。\n- **Pfirsch-Schlüter区**：$\\nu^*_i \\gtrsim \\epsilon^{-3/2}$。这是高碰撞率的、类似流体的区域，其中平均自由程短于连接长度。\n\n我们计算出的值为 $\\nu^*_i \\approx 0.024$。由于 $0.024 \\ll 1$，等离子体深处香蕉区。条件 $\\nu_{\\mathrm{eff}} \\ll \\omega_b$ 很好地满足：\n- $\\nu_{\\mathrm{eff}} = \\nu_{ii}/\\epsilon \\approx 88.36/0.09677 \\approx 913\\,\\mathrm{s^{-1}}$\n- $\\omega_b \\approx 3.84 \\times 10^4\\,\\mathrm{rad/s}$\n确实，$913 \\ll 38400$。一个捕获离子在一次碰撞使其解捕获之前，平均会执行 $\\omega_b/\\nu_{\\mathrm{eff}} \\approx 42$ 次弹跳轨道。\n\n### 选项评估\n\n- **A. 香蕉区**：该区域由 $\\nu^* \\ll 1$ 定义。我们的计算得出 $\\nu^*_i \\approx 0.024$，这明确地将等离子体置于该区域。这与ITER芯部的高温（$T_i = 15\\,\\mathrm{keV}$）一致，因为碰撞率随温度的升高而急剧下降（$\\nu^* \\propto T^{-2}$）。**正确**。\n\n- **B. 平台区**：该区域对应中等碰撞率，大约为 $1  \\nu^*  \\epsilon^{-3/2}$。我们的值 $\\nu^*_i \\approx 0.024$ 不在此范围内。**不正确**。\n\n- **C. Pfirsch-Schluter区**：这是高碰撞率区域，其中 $\\nu^* > \\epsilon^{-3/2}$。我们有 $\\epsilon^{-3/2} \\approx (0.09677)^{-1.5} \\approx 33.2$。我们的值 $\\nu^*_i \\approx 0.024$ 远低于此阈值。**不正确**。\n\n- **D. 接近平台区–Pfirsch-Schluter区过渡**：此过渡发生在 $\\nu^* \\approx \\epsilon^{-3/2} \\approx 33.2$。我们的值比这个小几个数量级。**不正确**。\n\n分析明确地确定了输运区为香蕉区。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在大多数聚变反应堆方案中，能量和粒子输运由微观湍流主导，而非新经典效应。本练习介绍了一种预测这种湍流输运的基本工具：准线性模型。这项实践旨在连接线性不稳定性计算（如增长率）与热通量的实际预测，展示了预测工作流程中的一个核心环节。",
            "id": "4208279",
            "problem": "考虑使用基于回旋动理学理论的准线性理论，预测与国际热核聚变实验反应堆（ITER）和示范性发电厂（DEMO）相关的燃烧等离子体中的离子热输运问题。离子热通量由菲克定律（Fick’s law）建模，该定律指出通量与离子温度的梯度成正比。本问题的基本依据包括以下广为接受的原理和定义：\n- 磁通面平均的离子热通量由扩散闭合给出，其中离子热通量 $Q_{i}$ 满足 $Q_{i} = - n_{i} k_{\\mathrm{B}} \\chi_{i} \\, \\partial T_{i} / \\partial r$，其中 $n_{i}$ 是离子数密度，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\chi_{i}$ 是离子热扩散系数，$T_{i}$ 是离子温度。\n- 在准线性混合长度理论中，湍流输运源于 $E \\times B$ 平流，其退相关时间由线性增长率决定，垂直相关长度由模结构决定。使用静电势涨落的饱和规则，包含能量的振幅遵循 $|\\phi_{k}|^{2} \\sim \\gamma / k_{\\perp}^{2}$，其中 $\\gamma$ 是线性增长率，$k_{\\perp}^{2} = k_{x}^{2} + k_{y}^{2}$ 是垂直波数的平方，由模本征函数（通过 $k_{x}$ 决定径向结构）和副法向波数 $k_{y}$ 确定。\n- 离子的垂直拉莫尔半径为 $\\rho_{i} = v_{\\mathrm{th}i}/\\Omega_{i}$，其中 $v_{\\mathrm{th}i} = \\sqrt{2 k_{\\mathrm{B}} T_{i} / m_{i}}$ 是离子热速度，$\\Omega_{i} = q_{i} B / m_{i}$ 是离子回旋频率。这里 $m_{i}$ 是离子质量，$q_{i}$ 是离子电荷，$B$ 是磁场强度。\n\n从这些第一性原理出发，推导在固定 $k_{y}$ 下离子热扩散系数 $\\chi_{i}(k_{y})$ 的准线性估计值。利用饱和规则和本征函数所蕴含的垂直尺度，确定 $\\chi_{i}(k_{y})$ 如何依赖于 $\\gamma$ 和 $k_{\\perp}$。推导过程必须证明 $\\chi_{i}$ 对增长率和垂直波数的依赖关系，且不引入任何唯象的输运系数。在最终表达式中，引入一个无量纲耦合因子 $\\alpha_{i}(k_{y})$，该因子解释了线性本征函数中 $E \\times B$ 速度与离子温度涨落之间的交叉相位，其中 $0 \\le \\alpha_{i}(k_{y}) \\le 1$。\n\n然后，使用菲克定律计算每个 $k_{y}$ 对应的离子热通量 $Q_{i}(k_{y})$。将所有最终的离子热通量值以瓦特每平方米（W/m$^{2}$）为单位表示，并将每个值四舍五入到三位有效数字。角度不出现，也无需指定。不涉及百分比。\n\n您的程序必须为一组指定的参数实现以下步骤：\n1. 计算 $v_{\\mathrm{th}i} = \\sqrt{2 k_{\\mathrm{B}} T_{i} / m_{i}}$。\n2. 计算 $\\Omega_{i} = q_{i} B / m_{i}$。\n3. 计算 $\\rho_{i} = v_{\\mathrm{th}i} / \\Omega_{i}$。\n4. 将每个无量纲的副法向波数 $k_{y} \\rho_{i}$ 转换为物理波数 $k_{y}$，即 $k_{y} = (k_{y} \\rho_{i}) / \\rho_{i}$。\n5. 使用本征函数结构给定的 $k_{x}$，构成 $k_{\\perp}^{2} = k_{x}^{2} + k_{y}^{2}$。\n6. 使用推导出的准线性闭合关系计算 $\\chi_{i}(k_{y})$。\n7. 对每个 $k_{y}$，计算 $Q_{i}(k_{y}) = - n_{i} k_{\\mathrm{B}} \\chi_{i}(k_{y}) \\, \\partial T_{i} / \\partial r$。\n8. 以 W/m$^{2}$ 为单位生成输出，并四舍五入到三位有效数字。\n\n科学真实性约束：使用氘离子，其质量 $m_{i} = 3.343583719 \\times 10^{-27}$ kg，电荷 $q_{i} = 1.602176634 \\times 10^{-19}$ C。使用玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ J/K。\n\n测试套件。实现三个不同的场景，涵盖燃烧等离子体中的典型工况和边缘工况。对于每个场景，评估四个 $k_{y} \\rho_{i}$ 值 $[\\,0.2,\\,0.4,\\,0.6,\\,0.8\\,]$。\n\n- 场景A（类ITER堆芯，“理想路径”）：\n  - $n_{i} = 1.0 \\times 10^{20}$ m$^{-3}$，$B = 5.3$ T，$T_{i} = 1.50 \\times 10^{8}$ K，$\\partial T_{i} / \\partial r = -5.00 \\times 10^{6}$ K/m。\n  - 对于 $k_{y} \\rho_{i} = [\\,0.2,\\,0.4,\\,0.6,\\,0.8\\,]$ 的线性增长率（单位 s$^{-1}$）：$\\gamma = [\\,1.00 \\times 10^{4},\\,1.80 \\times 10^{4},\\,2.50 \\times 10^{4},\\,2.00 \\times 10^{4}\\,]$。\n  - 径向波数（单位 m$^{-1}$）：$k_{x} = [\\,1.50 \\times 10^{2},\\,2.00 \\times 10^{2},\\,2.50 \\times 10^{2},\\,3.00 \\times 10^{2}\\,]$。\n  - 耦合因子：$\\alpha_{i} = [\\,0.70,\\,0.80,\\,0.85,\\,0.80\\,]$。\n\n- 场景B（近边际稳定，边界覆盖：包含一个近稳定模）：\n  - $n_{i} = 1.0 \\times 10^{20}$ m$^{-3}$，$B = 5.3$ T，$T_{i} = 1.50 \\times 10^{8}$ K，$\\partial T_{i} / \\partial r = -5.00 \\times 10^{6}$ K/m。\n  - 线性增长率（单位 s$^{-1}$）：$\\gamma = [\\,0.00,\\,3.00 \\times 10^{3},\\,4.00 \\times 10^{3},\\,3.50 \\times 10^{3}\\,]$。\n  - 径向波数（单位 m$^{-1}$）：$k_{x} = [\\,1.50 \\times 10^{2},\\,2.00 \\times 10^{2},\\,2.50 \\times 10^{2},\\,3.00 \\times 10^{2}\\,]$。\n  - 耦合因子：$\\alpha_{i} = [\\,0.60,\\,0.70,\\,0.75,\\,0.70\\,]$。\n\n- 场景C（具有大径向波数的本征函数，强垂直退相关的边缘情况）：\n  - $n_{i} = 1.0 \\times 10^{20}$ m$^{-3}$，$B = 5.3$ T，$T_{i} = 1.50 \\times 10^{8}$ K，$\\partial T_{i} / \\partial r = -5.00 \\times 10^{6}$ K/m。\n  - 线性增长率（单位 s$^{-1}$）：$\\gamma = [\\,1.50 \\times 10^{4},\\,1.60 \\times 10^{4},\\,1.70 \\times 10^{4},\\,1.60 \\times 10^{4}\\,]$。\n  - 径向波数（单位 m$^{-1}$）：$k_{x} = [\\,5.00 \\times 10^{2},\\,6.00 \\times 10^{2},\\,7.00 \\times 10^{2},\\,8.00 \\times 10^{2}\\,]$。\n  - 耦合因子：$\\alpha_{i} = [\\,0.70,\\,0.75,\\,0.80,\\,0.75\\,]$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个场景的结果本身是一个列表，包含按 $k_{y} \\rho_{i} = 0.2, 0.4, 0.6, 0.8$ 顺序排列的四个 $Q_{i}(k_{y})$ 值（单位 W/m$^{2}$，四舍五入到三位有效数字）。例如：\"[[scenarioA_k0.2,scenarioA_k0.4,scenarioA_k0.6,scenarioA_k0.8],[scenarioB_k0.2,...],[scenarioC_k0.2,...]]\"。",
            "solution": "问题陈述经评估具有科学合理性、定义明确、客观且完整。它基于等离子体物理的既定原理，特别是回旋动理学理论和准线性输运模型。所有必需的物理常数、参数和边界条件都已提供，以推导出一个唯一且有意义的解。因此，该问题被认定为有效，并将提供解答。\n\n问题的核心是首先推导离子热扩散系数 $\\chi_i$ 的准线性估计，然后用它来计算离子热通量 $Q_i$。\n\n**1. 离子热扩散系数 $\\chi_i$ 的推导**\n\n湍流离子热通量 $Q_i$ 是由于涨落引起的离子热能径向输运的磁通面平均值。在统计意义上，它由涨落的 $E \\times B$ 速度的径向分量 $\\delta v_{Er}$ 和离子温度涨落 $\\delta T_i$ 之间的相关性给出：\n$$\nQ_i = n_i k_B \\langle \\delta v_{Er} \\delta T_i \\rangle\n$$\n其中 $n_i$ 是离子密度，$k_B$ 是玻尔兹曼常数，尖括号表示对涨落的空间或时间平均。问题陈述中给出的菲克扩散定律为此通量提供了一个宏观闭合：\n$$\nQ_i = -n_i k_B \\chi_i \\frac{\\partial T_i}{\\partial r}\n$$\n通过比较这两个表达式，我们可以将热扩散系数 $\\chi_i$ 确定为：\n$$\n\\chi_i = - \\frac{\\langle \\delta v_{Er} \\delta T_i \\rangle}{\\partial T_i / \\partial r}\n$$\n准线性理论提供了一种估算涨落量的方法。在磁化等离子体中，湍流输运的主要机制是 $\\vec{E} \\times \\vec{B}$ 漂移，其中 $\\vec{E}$ 是涨落电场。对于静电湍流，$\\delta\\vec{E} = -\\nabla \\delta\\phi$，其中 $\\delta\\phi$ 是涨落的静电势。对于波数为 $\\vec{k} = (k_x, k_y)$ 的单个傅里叶模，漂移速度的径向分量是 $\\delta v_{Er, k} = -i k_y \\phi_k / B$。\n\n该问题要求基于混合长度论证进行推导。这种方法的一个核心原则是，当非线性平流率 $\\omega_{NL}$ 与最不稳定模的线性增长率 $\\gamma$ 相当时，湍流达到饱和。非线性率可以估算为湍流涡旋以自身尺寸平流结构的速度，即 $\\omega_{NL} \\sim k_\\perp v_{E,\\perp}$，其中 $v_{E,\\perp} \\sim k_y |\\phi_k| / B$ 是特征垂直速度，$k_\\perp = \\sqrt{k_x^2 + k_y^2}$ 是特征垂直波数。因此，饱和条件 $\\gamma_k \\approx \\omega_{NL}$ 通常被建模为 $\\gamma_k \\sim k_\\perp^2 \\chi_k$，其中 $\\chi_k$ 是与该模相关的扩散系数。\n\n这直接得出了广泛使用的湍流扩散系数的混合长度估计：\n$$\n\\chi_i(k_y) \\sim \\frac{\\gamma(k_y)}{k_\\perp^2}\n$$\n这个估计抓住了基本物理：输运随不稳定性驱动（$\\gamma$）的增加而增加，随空间结构变小（$k_\\perp$ 变大）而减少，因为较小的结构在大尺度输运中效率较低。其单位是 $(\\mathrm{s}^{-1}) / (\\mathrm{m}^{-2}) = \\mathrm{m}^2/\\mathrm{s}$，这对于扩散系数是正确的。\n\n然而，这个简单的估计忽略了速度涨落 $\\delta v_{Er}$ 和温度涨落 $\\delta T_i$ 之间相位关系的详细物理。净输运严重依赖于这个交叉相位。该问题通过引入一个无量纲耦合因子 $\\alpha_i(k_y)$ 来解决这一点，该因子代表了模驱动热输运的效率。这个因子范围从 $0$ 到 $1$，概括了线性本征函数结构和相位关系的复杂物理。\n\n因此，对于副法向波数为 $k_y$ 的模，离子热扩散系数的最终、更完整的准线性表达式为：\n$$\n\\chi_i(k_y) = \\alpha_i(k_y) \\frac{\\gamma(k_y)}{k_\\perp^2}\n$$\n其中 $k_\\perp^2 = k_x(k_y)^2 + k_y^2$。径向波数 $k_x$ 对 $k_y$ 的依赖性反映了本征模的径向结构通常是其副法向波数的函数这一事实。\n\n**2. 计算步骤**\n\n有了推导出的 $\\chi_i(k_y)$ 表达式，我们现在可以遵循问题陈述中指定的计算步骤。对三个场景中的每一个，以及每个场景中给定的四个 $(k_y \\rho_i)$ 值，执行这些步骤。\n\n1.  **计算离子热速度 ($v_{\\mathrm{th}i}$)**：计算 $v_{\\mathrm{th}i} = \\sqrt{2 k_{\\mathrm{B}} T_{i} / m_{i}}$。这在单个场景内的所有模中是恒定的。\n2.  **计算离子回旋频率 ($\\Omega_{i}$)**：计算 $\\Omega_{i} = q_{i} B / m_{i}$。这在单个场景内的所有模中也是恒定的。\n3.  **计算离子拉莫尔半径 ($\\rho_{i}$)**：计算 $\\rho_{i} = v_{\\mathrm{th}i} / \\Omega_{i}$。这在单个场景内也是恒定的。\n4.  **计算副法向波数 ($k_{y}$)**：对于每个无量纲值 $(k_{y}\\rho_i)$，计算物理波数 $k_{y} = (k_{y}\\rho_i) / \\rho_{i}$。\n5.  **计算垂直波数 ($k_{\\perp}^2$)**: 使用每个模给定的 $k_x$ 值，计算 $k_{\\perp}^2 = k_{x}^2 + k_{y}^2$。\n6.  **计算离子热扩散系数 ($\\chi_{i}(k_{y})$)**：使用推导的公式 $\\chi_{i}(k_y) = \\alpha_{i}(k_y) \\frac{\\gamma(k_y)}{k_x^2 + k_y^2}$，并使用每个模对应的 $\\alpha_i$、$\\gamma$、$k_x$ 和计算出的 $k_y$ 值。\n7.  **计算离子热通量 ($Q_{i}(k_{y})$)**：使用菲克定律计算每个模的贡献：$Q_{i}(k_{y}) = -n_{i} k_{\\mathrm{B}} \\chi_{i}(k_{y}) (\\partial T_{i} / \\partial r)$。温度梯度中的负号导致对于正的 $\\chi_i$，热通量为正（向外）。\n8.  **格式化输出**：将每个计算出的 $Q_i(k_y)$ 值四舍五入到三位有效数字，并以 W/m$^2$ 为单位呈现。最终输出将所有场景的结果汇总到一个嵌套列表结构中。",
            "answer": "```python\nimport numpy as np\nfrom math import log10, floor\n\ndef solve():\n    \"\"\"\n    Solves the plasma turbulence problem by deriving ion heat flux for three scenarios.\n    \"\"\"\n\n    # Scientific Constants\n    M_D = 3.343583719e-27  # Mass of Deuterium (kg)\n    Q_ION = 1.602176634e-19 # Elementary charge (C)\n    K_B = 1.380649e-23      # Boltzmann constant (J/K)\n\n    # Test Scenarios\n    test_scenarios = [\n        {\n            \"name\": \"Scenario A (ITER-like core)\",\n            \"params\": {\n                \"n_i\": 1.0e20,  # Ion density (m^-3)\n                \"B\": 5.3,       # Magnetic field (T)\n                \"T_i\": 1.50e8,  # Ion temperature (K)\n                \"grad_T_i\": -5.00e6, # Ion temperature gradient (K/m)\n            },\n            \"modes\": {\n                \"ky_rho_i\": np.array([0.2, 0.4, 0.6, 0.8]),\n                \"gamma\": np.array([1.00e4, 1.80e4, 2.50e4, 2.00e4]), # Growth rates (s^-1)\n                \"k_x\": np.array([1.50e2, 2.00e2, 2.50e2, 3.00e2]),   # Radial wavenumbers (m^-1)\n                \"alpha_i\": np.array([0.70, 0.80, 0.85, 0.80]),      # Coupling factors\n            }\n        },\n        {\n            \"name\": \"Scenario B (near marginal stability)\",\n            \"params\": {\n                \"n_i\": 1.0e20,\n                \"B\": 5.3,\n                \"T_i\": 1.50e8,\n                \"grad_T_i\": -5.00e6,\n            },\n            \"modes\": {\n                \"ky_rho_i\": np.array([0.2, 0.4, 0.6, 0.8]),\n                \"gamma\": np.array([0.00, 3.00e3, 4.00e3, 3.50e3]),\n                \"k_x\": np.array([1.50e2, 2.00e2, 2.50e2, 3.00e2]),\n                \"alpha_i\": np.array([0.60, 0.70, 0.75, 0.70]),\n            }\n        },\n        {\n            \"name\": \"Scenario C (large radial wavenumber)\",\n            \"params\": {\n                \"n_i\": 1.0e20,\n                \"B\": 5.3,\n                \"T_i\": 1.50e8,\n                \"grad_T_i\": -5.00e6,\n            },\n            \"modes\": {\n                \"ky_rho_i\": np.array([0.2, 0.4, 0.6, 0.8]),\n                \"gamma\": np.array([1.50e4, 1.60e4, 1.70e4, 1.60e4]),\n                \"k_x\": np.array([5.00e2, 6.00e2, 7.00e2, 8.00e2]),\n                \"alpha_i\": np.array([0.70, 0.75, 0.80, 0.75]),\n            }\n        }\n    ]\n\n    def round_to_sf(x, n):\n        \"\"\"Rounds a number x to n significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return round(x, n - int(floor(log10(abs(x)))) - 1)\n\n    all_results = []\n\n    for scenario in test_scenarios:\n        params = scenario[\"params\"]\n        modes = scenario[\"modes\"]\n        \n        # Unpack parameters\n        n_i = params[\"n_i\"]\n        B = params[\"B\"]\n        T_i = params[\"T_i\"]\n        grad_T_i = params[\"grad_T_i\"]\n        \n        ky_rho_i_vals = modes[\"ky_rho_i\"]\n        gamma_vals = modes[\"gamma\"]\n        kx_vals = modes[\"k_x\"]\n        alpha_i_vals = modes[\"alpha_i\"]\n\n        # Step 1: Compute ion thermal speed\n        v_thi = np.sqrt(2 * K_B * T_i / M_D)\n        \n        # Step 2: Compute ion cyclotron frequency\n        omega_i = Q_ION * B / M_D\n        \n        # Step 3: Compute ion Larmor radius\n        rho_i = v_thi / omega_i\n        \n        scenario_fluxes = []\n        \n        for i in range(len(ky_rho_i_vals)):\n            # Unpack mode-specific values\n            ky_rho_i = ky_rho_i_vals[i]\n            gamma = gamma_vals[i]\n            k_x = kx_vals[i]\n            alpha_i = alpha_i_vals[i]\n\n            # Handle stable mode case\n            if gamma == 0.0:\n                scenario_fluxes.append(0.0)\n                continue\n\n            # Step 4: Convert dimensionless ky_rho_i to physical k_y\n            k_y = ky_rho_i / rho_i\n            \n            # Step 5: Form k_perp squared\n            k_perp_sq = k_x**2 + k_y**2\n            \n            # Step 6: Compute ion thermal diffusivity chi_i\n            chi_i = alpha_i * gamma / k_perp_sq\n            \n            # Step 7: Compute ion heat flux Q_i\n            Q_i = -n_i * K_B * chi_i * grad_T_i\n\n            # Step 8: Round to three significant figures\n            rounded_Q_i = round_to_sf(Q_i, 3)\n            scenario_fluxes.append(rounded_Q_i)\n        \n        all_results.append(scenario_fluxes)\n\n    # Format the final output string as per requirements\n    outer_list_str = []\n    for res_list in all_results:\n        inner_list_str = f\"[{','.join(map(str, res_list))}]\"\n        outer_list_str.append(inner_list_str)\n    \n    final_output_str = f\"[{','.join(outer_list_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "即使是最复杂的物理模型也包含不确定参数，必须通过实验数据进行约束。本练习介绍了一种现代而强大的统计框架——贝叶斯推断——来校准一个简化的输运模型。通过这项实践，您将学习如何系统地将理论模型与实验测量相结合，以提高模型的预测能力，这是聚变科学中的一项关键任务。",
            "id": "4208356",
            "problem": "考虑一个以 gyro-Bohm 归一化单位（无量纲）表示的离子热通量简化输运模型，该模型适用于 Joint European Torus (JET) 和 International Thermonuclear Experimental Reactor (ITER) 等装置中的燃烧等离子体。该模型基于一个刚度参数和一个归一化逆温度梯度中的阈值来预测归一化湍流离子热通量。设模型定义为\n$$\nQ_{\\mathrm{model}}(g;\\kappa,g_c) = \\kappa \\max\\left(0, g - g_c\\right),\n$$\n其中 $g$ 是无量纲归一化逆离子温度梯度（例如 $R/L_{T_i}$，其中 $R$ 是大半径，$L_{T_i}$ 是离子温度标长），$\\kappa0$ 是控制高于阈值的输運斜率的刚度参数，而 $g_c0$ 是临界梯度阈值。给定在不同梯度值 $g_i$ 下归一化离子热通量的实验测量值 $Q_{\\mathrm{exp},i}$，其测量噪声为已知且独立的标准差为 $\\sigma$ 的高斯噪声。\n\n请利用所提供的数据，对 $(\\kappa,g_c)$ 进行贝叶斯校准，使用：\n- 一个独立的对数正态先验分布用于 $\\kappa$，其中 $\\ln \\kappa \\sim \\mathcal{N}(\\mu_\\kappa,\\sigma_\\kappa^2)$，以及\n- 一个独立的正态先验分布用于 $g_c \\sim \\mathcal{N}(\\mu_{g_c},\\tau_{g_c}^2)$，并截断至 $g_c0$。\n\n假设似然函数为具有独立误差的高斯分布：\n$$\n\\mathcal{L}\\left(Q_{\\mathrm{exp}} \\mid \\kappa,g_c\\right) = \\prod_{i} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left( -\\frac{\\left(Q_{\\mathrm{exp},i} - Q_{\\mathrm{model}}(g_i;\\kappa,g_c)\\right)^2}{2\\sigma^2} \\right).\n$$\n你的任务是根据贝叶斯定理和给定模型，推导出后验分布 $p(\\kappa,g_c \\mid Q_{\\mathrm{exp}})$ 的形式（不包括归一化常数），然后通过在均匀网格上对矩形参数域进行数值积分，计算后验均值 $\\mathbb{E}[\\kappa \\mid Q_{\\mathrm{exp}}]$ 和 $\\mathbb{E}[g_c \\mid Q_{\\mathrm{exp}}]$。\n\n实现一个程序，该程序：\n1. 对下面提供的测试套件中的每个测试用例，在 $(\\kappa,g_c)$ 的均匀网格上构建未归一化的后验分布，为保证数值稳定性进行重新缩放，并通过数值积分计算后验均值。\n2. 生成单行输出，其中包含所有测试用例的所有后验均值，按顺序排列，形式为方括号括起来的逗号分隔列表。结果必须按测试用例排序；在每个测试用例中，首先报告 $\\mathbb{E}[\\kappa \\mid Q_{\\mathrm{exp}}]$，然后报告 $\\mathbb{E}[g_c \\mid Q_{\\mathrm{exp}}]$。所有结果都表示为十进制浮点数。\n\n测试套件包含四个代表 JET/ITER/DEMO 相关工况的案例。所有量都是无量纲的：\n\n- 测试用例1（类JET，超临界梯度）：\n  - $g = [5.0,\\, 5.5,\\, 6.0,\\, 6.5]$\n  - $Q_{\\mathrm{exp}} = [0.39,\\, 1.04,\\, 1.69,\\, 2.34]$\n  - $\\sigma = 0.15$\n  - 先验参数：$\\ln \\kappa$ 为 $\\mu_\\kappa = 0.1$, $\\sigma_\\kappa = 0.5$；$g_c$ 为 $\\mu_{g_c} = 4.5$, $\\tau_{g_c} = 0.4$\n  - 积分域：$\\kappa \\in [0.1,\\, 3.0]$, $g_c \\in [3.0,\\, 6.0]$\n\n- 测试用例2（类ITER，近阈值）：\n  - $g = [4.0,\\, 4.2,\\, 4.5,\\, 4.7,\\, 5.0]$\n  - $Q_{\\mathrm{exp}} = [0.0,\\, 0.0,\\, 0.0,\\, 0.0,\\, 0.3]$\n  - $\\sigma = 0.1$\n  - 先验参数：$\\ln \\kappa$ 为 $\\mu_\\kappa = 0.3$, $\\sigma_\\kappa = 0.4$；$g_c$ 为 $\\mu_{g_c} = 4.6$, $\\tau_{g_c} = 0.3$\n  - 积分域：$\\kappa \\in [0.1,\\, 3.0]$, $g_c \\in [3.0,\\, 6.0]$\n\n- 测试用例3（边缘情况，亚临界梯度）：\n  - $g = [3.0,\\, 3.5,\\, 3.8,\\, 4.0]$\n  - $Q_{\\mathrm{exp}} = [0.0,\\, 0.0,\\, 0.0,\\, 0.0]$\n  - $\\sigma = 0.2$\n  - 先验参数：$\\ln \\kappa$ 为 $\\mu_\\kappa = 0.0$, $\\sigma_\\kappa = 0.6$；$g_c$ 为 $\\mu_{g_c} = 4.8$, $\\tau_{g_c} = 0.6$\n  - 积分域：$\\kappa \\in [0.1,\\, 3.0]$, $g_c \\in [3.0,\\, 6.0]$\n\n- 测试用例4（类DEMO，远超阈值的刚性输运）：\n  - $g = [6.0,\\, 7.0,\\, 8.0]$\n  - $Q_{\\mathrm{exp}} = [3.0,\\, 5.0,\\, 7.0]$\n  - $\\sigma = 0.2$\n  - 先验参数：$\\ln \\kappa$ 为 $\\mu_\\kappa = 0.5$, $\\sigma_\\kappa = 0.3$；$g_c$ 为 $\\mu_{g_c} = 4.6$, $\\tau_{g_c} = 0.4$\n  - 积分域：$\\kappa \\in [0.1,\\, 3.0]$, $g_c \\in [3.0,\\, 6.0]$\n\n您的程序应使用一个至少包含 $200 \\times 200$ 个点的均匀矩形网格，该网格跨越每个指定的参数域，为每个测试用例计算后验均值，并按以下格式将结果打印为单行：\n$$\n[\\text{E}[\\kappa]_1,\\,\\text{E}[g_c]_1,\\,\\text{E}[\\kappa]_2,\\,\\text{E}[g_c]_2,\\,\\text{E}[\\kappa]_3,\\,\\text{E}[g_c]_3,\\,\\text{E}[\\kappa]_4,\\,\\text{E}[g_c]_4].\n$$\n由于所有变量都是无量纲的，因此不涉及物理单位。未使用角度。所有输出都必须是小数，而不是分数，并由程序的默认浮点数表示或固定小数位数进行一致的舍入。",
            "solution": "该问题要求计算聚变等离子体中离子热通量简化输运模型的参数 $(\\kappa, g_c)$ 的后验均值。此估计将使用贝叶斯推断，基于所提供的实验数据、模型和指定的先验分布来执行。\n\n首先，我们建立未归一化后验分布的数学形式。根据贝叶斯定理，后验分布 $p(\\kappa, g_c \\mid D)$ 与似然 $p(D \\mid \\kappa, g_c)$ 和先验 $p(\\kappa, g_c)$ 的乘积成正比，其中 $D$ 代表实验数据对 $(g_i, Q_{\\mathrm{exp},i})$ 的集合。\n$$\np(\\kappa, g_c \\mid D) \\propto p(D \\mid \\kappa, g_c) p(\\kappa) p(g_c)\n$$\n参数 $\\kappa$ 和 $g_c$ 被假定具有独立的先验。为保证数值稳定性，处理后验分布的对数是很有利的，它与对数似然和对数先验的总和成正比。\n\n输运模型由 $Q_{\\mathrm{model}}(g;\\kappa,g_c) = \\kappa \\max\\left(0, g - g_c\\right)$ 给出。\n似然是独立高斯分布的乘積，由此可得对数似然（忽略与参数估计无关的常数项）：\n$$\n\\ln \\mathcal{L}(\\kappa, g_c) \\propto -\\frac{1}{2\\sigma^2} \\sum_{i} \\left(Q_{\\mathrm{exp},i} - Q_{\\mathrm{model}}(g_i;\\kappa,g_c)\\right)^2 = -\\frac{1}{2\\sigma^2} \\sum_{i} \\left(Q_{\\mathrm{exp},i} - \\kappa \\max(0, g_i - g_c)\\right)^2\n$$\n\n刚度参数 $\\kappa$ 的先验是对数正态分布，其中 $\\ln \\kappa \\sim \\mathcal{N}(\\mu_\\kappa, \\sigma_\\kappa^2)$。其概率密度函数为 $p(\\kappa) \\propto \\frac{1}{\\kappa} \\exp\\left(-\\frac{(\\ln\\kappa - \\mu_\\kappa)^2}{2\\sigma_\\kappa^2}\\right)$。相应的对数先验为：\n$$\n\\ln p(\\kappa) \\propto -\\ln\\kappa - \\frac{(\\ln\\kappa - \\mu_\\kappa)^2}{2\\sigma_\\kappa^2}\n$$\n\n临界梯度 $g_c$ 的先验是一个截断至 $g_c  0$ 的正态分布，$p(g_c) \\propto \\exp\\left(-\\frac{(g_c - \\mu_{g_c})^2}{2\\tau_{g_c}^2}\\right)$ for $g_c  0$。截斷的歸一化常數不依賴於 $g_c$，可以被吸收到後驗分佈的總歸一化常數中。对数先验就是指数的参数：\n$$\n\\ln p(g_c) \\propto -\\frac{(g_c - \\mu_{g_c})^2}{2\\tau_{g_c}^2}\n$$\n\n结合这些，未归一化的对数后验 $\\ln \\pi(\\kappa, g_c)$ 为：\n$$\n\\ln \\pi(\\kappa, g_c) = -\\frac{1}{2\\sigma^2} \\sum_{i} \\left(Q_{\\mathrm{exp},i} - \\kappa \\max(0, g_i - g_c)\\right)^2 - \\frac{(\\ln\\kappa - \\mu_\\kappa)^2}{2\\sigma_\\kappa^2} - \\ln\\kappa - \\frac{(g_c - \\mu_{g_c})^2}{2\\tau_{g_c}^2}\n$$\n\n为了计算后验均值 $\\mathbb{E}[\\kappa \\mid D]$ 和 $\\mathbb{E}[g_c \\mid D]$，我们必须在指定的参数域上计算以下积分：\n$$\n\\mathbb{E}[\\kappa \\mid D] = \\frac{\\iint \\kappa \\, \\pi(\\kappa,g_c) \\,d\\kappa\\,dg_c}{\\iint \\pi(\\kappa,g_c) \\,d\\kappa\\,dg_c}, \\quad \\mathbb{E}[g_c \\mid D] = \\frac{\\iint g_c \\, \\pi(\\kappa,g_c) \\,d\\kappa\\,dg_c}{\\iint \\pi(\\kappa,g_c) \\,d\\kappa\\,dg_c}\n$$\n这些积分使用均匀网格进行数值近似。为 $(\\kappa, g_c)$ 指定的参数域被离散化为一个点网格 $(\\kappa_j, g_{c,k})$。在每个网格点上计算未归一化的后验 $\\pi_{jk} = \\pi(\\kappa_j, g_{c,k})$。为保证数值稳定性，我们计算 $\\pi_{jk} = \\exp(\\ln \\pi_{jk} - \\max(\\ln \\pi))$ 以防止下溢/上溢。然后将积分近似为求和，后验均值的表达式变为网格坐标的加权平均值，其中以后验值作为权重：\n$$\n\\mathbb{E}[\\kappa \\mid D] \\approx \\frac{\\sum_{j,k} \\kappa_j \\pi_{jk}}{\\sum_{j,k} \\pi_{jk}}, \\quad \\mathbb{E}[g_c \\mid D] \\approx \\frac{\\sum_{j,k} g_{c,k} \\pi_{jk}}{\\sum_{j,k} \\pi_{jk}}\n$$\n\n该实现将为每个测试用例构建一个 $201 \\times 201$ 的网格，为提高效率使用向量化的 NumPy 操作在该网格上评估对数后验，然后取指数得到未归一化的后验，最后计算加权平均值以找到 $\\kappa$ 和 $g_c$ 的后验均值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Bayesian calibration for a plasma transport model and prints the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (JET-like, supercritical gradients)\n        {\n            \"g\": np.array([5.0, 5.5, 6.0, 6.5]),\n            \"Q_exp\": np.array([0.39, 1.04, 1.69, 2.34]),\n            \"sigma\": 0.15,\n            \"mu_kappa\": 0.1, \"sigma_kappa\": 0.5,\n            \"mu_gc\": 4.5, \"tau_gc\": 0.4,\n            \"kappa_range\": (0.1, 3.0), \"gc_range\": (3.0, 6.0)\n        },\n        # Test case 2 (ITER-like, near-threshold)\n        {\n            \"g\": np.array([4.0, 4.2, 4.5, 4.7, 5.0]),\n            \"Q_exp\": np.array([0.0, 0.0, 0.0, 0.0, 0.3]),\n            \"sigma\": 0.1,\n            \"mu_kappa\": 0.3, \"sigma_kappa\": 0.4,\n            \"mu_gc\": 4.6, \"tau_gc\": 0.3,\n            \"kappa_range\": (0.1, 3.0), \"gc_range\": (3.0, 6.0)\n        },\n        # Test case 3 (edge case, subcritical gradients)\n        {\n            \"g\": np.array([3.0, 3.5, 3.8, 4.0]),\n            \"Q_exp\": np.array([0.0, 0.0, 0.0, 0.0]),\n            \"sigma\": 0.2,\n            \"mu_kappa\": 0.0, \"sigma_kappa\": 0.6,\n            \"mu_gc\": 4.8, \"tau_gc\": 0.6,\n            \"kappa_range\": (0.1, 3.0), \"gc_range\": (3.0, 6.0)\n        },\n        # Test case 4 (DEMO-like, stiff transport far above threshold)\n        {\n            \"g\": np.array([6.0, 7.0, 8.0]),\n            \"Q_exp\": np.array([3.0, 5.0, 7.0]),\n            \"sigma\": 0.2,\n            \"mu_kappa\": 0.5, \"sigma_kappa\": 0.3,\n            \"mu_gc\": 4.6, \"tau_gc\": 0.4,\n            \"kappa_range\": (0.1, 3.0), \"gc_range\": (3.0, 6.0)\n        }\n    ]\n\n    results = []\n    \n    # Grid resolution\n    N_GRID_POINTS = 201\n\n    for case in test_cases:\n        # Unpack case data\n        g_data = case[\"g\"]\n        Q_exp_data = case[\"Q_exp\"]\n        sigma = case[\"sigma\"]\n        mu_kappa, sigma_kappa = case[\"mu_kappa\"], case[\"sigma_kappa\"]\n        mu_gc, tau_gc = case[\"mu_gc\"], case[\"tau_gc\"]\n        kappa_min, kappa_max = case[\"kappa_range\"]\n        gc_min, gc_max = case[\"gc_range\"]\n\n        # 1. Create the parameter grid\n        kappa_ax = np.linspace(kappa_min, kappa_max, N_GRID_POINTS)\n        gc_ax = np.linspace(gc_min, gc_max, N_GRID_POINTS)\n        kappa_grid, gc_grid = np.meshgrid(kappa_ax, gc_ax, indexing='xy')\n\n        # 2. Calculate the log-likelihood\n        # Reshape data for broadcasting over the grid\n        # g_data_reshaped: (N_data, 1, 1)\n        # Q_exp_reshaped: (N_data, 1, 1)\n        # kappa_grid: (N_gc, N_kappa)\n        # gc_grid: (N_gc, N_kappa)\n        # NumPy's broadcasting rules will handle the shape differences\n        g_data_reshaped = g_data[:, np.newaxis, np.newaxis]\n        Q_exp_reshaped = Q_exp_data[:, np.newaxis, np.newaxis]\n\n        # Calculate Q_model over the grid for all data points\n        # The result Q_model will have shape (N_data, N_gc, N_kappa)\n        Q_model = kappa_grid * np.maximum(0, g_data_reshaped - gc_grid)\n        \n        # Calculate sum of squared residuals over the grid\n        sum_sq_residuals = np.sum((Q_exp_reshaped - Q_model)**2, axis=0)\n        \n        log_likelihood = -sum_sq_residuals / (2 * sigma**2)\n\n        # 3. Calculate log-priors\n        log_prior_kappa = -(np.log(kappa_grid) - mu_kappa)**2 / (2 * sigma_kappa**2) - np.log(kappa_grid)\n        log_prior_gc = -(gc_grid - mu_gc)**2 / (2 * tau_gc**2)\n\n        # 4. Calculate the total unnormalized log-posterior\n        log_posterior = log_likelihood + log_prior_kappa + log_prior_gc\n\n        # 5. Stabilize and compute posterior\n        log_posterior -= np.max(log_posterior)\n        posterior = np.exp(log_posterior)\n        \n        # 6. Compute posterior means via weighted average\n        # The sum of posterior values serves as the normalization constant\n        posterior_sum = np.sum(posterior)\n        \n        if posterior_sum > 0:\n            E_kappa = np.sum(kappa_grid * posterior) / posterior_sum\n            E_gc = np.sum(gc_grid * posterior) / posterior_sum\n        else:\n            # Handle case where posterior is zero everywhere (e.g., due to underflow)\n            E_kappa = np.nan\n            E_gc = np.nan\n\n        results.extend([E_kappa, E_gc])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}