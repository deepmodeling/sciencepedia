{
    "hands_on_practices": [
        {
            "introduction": "模拟任何不稳定性的第一步是理解其自由能来源。本练习聚焦于电子温度梯度，这是驱动微撕裂模的核心因素，并用参数 $\\eta_e$ 对其进行量化。通过从给定的等离子体分布参数计算 $\\eta_e$ ，您将练习一项基本技能，并深入理解为何某些等离子体更容易出现微撕裂模。",
            "id": "4200707",
            "problem": "考虑一个大环径比托卡马克，其小半径为 $a$，平衡仅在径向 $r \\in [0,a]$ 上变化。设电子密度剖面为 $n_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p$，电子温度剖面为 $T_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q$，其中 $n_0$、$T_0$、$p$ 和 $q$ 是正常数，$B$ 是均匀的环向磁场强度。假设微撕裂不稳定的波数排序为 $k_y \\rho_e \\ll 1$ 和半碰撞电子，定义为 $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$，其中 $\\lambda_{\\mathrm{mfp}} = v_{te}/\\nu_e$，$v_{te} = \\sqrt{2 T_e/m_e}$ 是电子热速度，$\\nu_e$ 是电子碰撞频率。设磁剪切弱但有限，并关注平行矢量势 $A_{\\parallel}$ 的重联宇称分量。\n\n从梯度标长 $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ 和 $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$ 的基本定义出发，在给定 $p = 1.7$ 和 $q = 3.1$ 的条件下，构建在半径 $r_0 = \\frac{a}{2}$ 处的局部电子温度梯度参数 $\\eta_e = \\frac{L_n}{L_{T_e}}$。然后，使用半碰撞機制下电子平行力平衡和能量方程的第一性原理线性化，并结合安培定律，确定在 $r_0$ 附近、固定 $k_y$ 时 $\\frac{d \\gamma}{d \\eta_e}$ 的符号，其中 $\\gamma$ 是微撕裂模的线性增长率。如果增加 $\\eta_e$（在其他参数固定的情况下）会增加 $\\gamma$（使模式不稳定），则将您的定性稳定性预测数值编码为 $+1$；如果增加 $\\eta_e$ 会减少 $\\gamma$（使模式稳定），则编码为 $-1$。\n\n您必须给出一个包含两个条目的最终答案：第一个条目是 $\\eta_e(r_0)$ 的值（无量纲），四舍五入到四位有效数字；第二个条目是 $\\frac{d \\gamma}{d \\eta_e}$ 的符号，编码为 $+1$ 或 $-1$（无量纲）。提供最终答案时无需单位。",
            "solution": "该问题要求计算托卡马克等离子体中与微撕裂模（MTM）相关的两个量。首先，我们必须计算在特定半径处的局部电子温度梯度参数 $\\eta_e$。其次，我们必须确定MTM线性增长率 $\\gamma$ 对 $\\eta_e$ 的导数符号，这表明增加 $\\eta_e$ 是起稳定作用还是不稳定作用。\n\n第1部分：$\\eta_e(r_0)$ 的计算\n\n参数 $\\eta_e$ 定义为电子密度梯度标长 $L_n$ 与电子温度梯度标长 $L_{T_e}$ 之比。\n$$\n\\eta_e = \\frac{L_n}{L_{T_e}}\n$$\n梯度标长定义为 $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ 和 $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$。给定的电子密度和温度剖面为：\n$$\nn_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p\n$$\n$$\nT_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q\n$$\n首先，我们计算电子密度 $n_e$ 的对数导数。$n_e(r)$ 的自然对数是：\n$$\n\\ln n_e(r) = \\ln n_0 + p \\ln\\left(1 - \\frac{r^2}{a^2}\\right)\n$$\n对小半径 $r$ 求导：\n$$\n\\frac{d \\ln n_e}{dr} = 0 + p \\cdot \\frac{1}{1 - \\frac{r^2}{a^2}} \\cdot \\left(-\\frac{2r}{a^2}\\right) = -\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n因此，密度的逆梯度标长为 $\\frac{1}{L_n} = -\\frac{d \\ln n_e}{dr}$：\n$$\n\\frac{1}{L_n(r)} = \\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n直接类比，对于电子温度剖面 $T_e(r)$，我们可以用参数 $q$ 替换 $p$：\n$$\n\\frac{d \\ln T_e}{dr} = -\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n温度的逆梯度标长为 $\\frac{1}{L_{T_e}} = -\\frac{d \\ln T_e}{dr}$：\n$$\n\\frac{1}{L_{T_e}(r)} = \\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n现在我们可以通过计算逆标长之比来计算 $\\eta_e(r)$：\n$$\n\\eta_e(r) = \\frac{L_n(r)}{L_{T_e}(r)} = \\frac{1/L_{T_e}(r)}{1/L_n(r)} = \\frac{\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}}{\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}} = \\frac{q}{p}\n$$\n对于这种特定的剖面函数形式，参数 $\\eta_e$ 是一个常数，与径向位置 $r$ 无关。给定常数 $p = 1.7$ 和 $q = 3.1$。因此，在任何半径（包括 $r_0 = a/2$）处的 $\\eta_e$ 值为：\n$$\n\\eta_e = \\frac{3.1}{1.7} \\approx 1.823529...\n$$\n按要求四舍五入到四位有效数字，我们得到：\n$$\n\\eta_e(r_0) \\approx 1.824\n$$\n\n第2部分：稳定性对 $\\eta_e$ 的依赖性\n\n接下来，我们必须确定 $\\frac{d\\gamma}{d\\eta_e}$ 的符号，其中 $\\gamma$ 是微撕裂模的线性增长率。这需要理解其基本的不稳定性机制。\n\n微撕裂模是由储存在电子温度梯度中的自由能驱动的电磁不稳定性。该模式涉及磁扰动，主要在平行矢量势 $\\tilde{A}_{\\parallel}$ 中，这导致小磁岛的形成和磁力线的随机性。\n\n分析从三个基本方程开始：\n1.  **安培定律**：该定律将磁扰动与电子电流扰动 $\\tilde{j}_{\\parallel e}$ 联系起来。在平板几何中，此为 $-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\tilde{j}_{\\parallel e}$。扰动的形式为 $\\exp(ik_y y - i\\omega t)$，其中 $\\omega = \\omega_r + i\\gamma$。增长模有 $\\gamma > 0$。\n2.  **电子平行力平衡（广义欧姆定律）**：该方程确定平行电流。响应于平行电场 $\\tilde{E}_{\\parallel} = -\\frac{\\partial \\tilde{A}_{\\parallel}}{\\partial t} - \\nabla_{\\parallel} \\tilde{\\phi} = i\\omega \\tilde{A}_{\\parallel} - ik_{\\parallel} \\tilde{\\phi}$，电子产生电流。该响应取决于碰撞性。此平衡中的一个关键项是热力，它与电子温度扰动 $\\nabla_{\\parallel} \\tilde{T}_e$ 的平行梯度成正比。\n3.  **电子能量平衡**：该方程确定温度扰动 $\\tilde{T}_e$。它平衡了来自场向输运、磁力线飘移以及其他源/汇的加热/冷却。\n\n在半碰撞机制 $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$ 中，不稳定性机制依赖于特定的相位关系。自由能源是背景温度梯度 $\\nabla_r T_e = -T_e/L_{T_e}$。该能量通过电子沿扰动磁力线运动的热量径向输运而释放。能量释放速率与 $\\langle \\tilde{q}_r \\left(-\\nabla_r T_e\\right) \\rangle$ 成正比，其中 $\\tilde{q}_r = \\tilde{q}_{\\parallel e}(\\tilde{B}_r/B)$ 是由于沿径向扰动磁力线($\\tilde{B}_r = ik_y \\tilde{A}_{\\parallel}$)的平行热输运引起的径向热通量。\n\n对于不稳定性（$\\gamma > 0$），必须有能量从背景热梯度净转移到电磁场扰动。当电子电流扰动 $\\tilde{j}_{\\parallel e}$ 与感应电场扰动 $\\tilde{E}_{\\parallel,ind} = i\\omega \\tilde{A}_{\\parallel}$ 部分同相时，就会发生这种情况。所需的相移由电子碰撞与热力共同提供。\n\n不稳定性驱动的强度与自由能源的大小成正比，即电子温度梯度。\n$$\n\\text{驱动} \\propto \\left| \\frac{dT_e}{dr} \\right| \\propto \\frac{1}{L_{T_e}}\n$$\n增长率 $\\gamma$ 是该驱动的函数，因此我们可以近似地写出：\n$$\n\\gamma \\propto \\frac{1}{L_{T_e}}\n$$\n问题要求 $\\gamma$ 对 $\\eta_e = L_n/L_{T_e}$ 的依赖性。我们可以用 $\\eta_e$ 和密度梯度标长 $L_n$ 来表示驱动：\n$$\n\\frac{1}{L_{T_e}} = \\frac{\\eta_e}{L_n}\n$$\n因此，增长率的依赖关系可以写为：\n$$\n\\gamma \\propto \\frac{\\eta_e}{L_n}\n$$\n问题要求在其他参数固定时 $\\frac{d\\gamma}{d\\eta_e}$ 的符号。在理论和实验背景下，“其他参数”通常指诸如 $L_n$、磁剪切、等离子体贝塔值和碰撞性等量。在此标准假设下（即保持 $L_n$ 不变），增长率 $\\gamma$ 与 $\\eta_e$ 成正比。\n$$\n\\frac{d\\gamma}{d\\eta_e} \\propto \\frac{1}{L_n}\n$$\n由于 $L_n = \\frac{a^2(1 - r_0^2/a^2)}{2pr_0}$ 是一个正量（给定 $p>0$ 和 $r_0 \\in (0,a)$），该导数必须为正。\n$$\n\\frac{d\\gamma}{d\\eta_e} > 0\n$$\n这表明，相对于密度梯度增加电子温度梯度对微撕裂模是不稳定的。更大的 $\\eta_e$ 意味着在给定的密度剖面下有更陡峭的温度剖面，从而提供更多的自由能来驱动不稳定性。这个正号的数值编码是 $+1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.824 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "物理模型的计算机模拟，其可靠性取决于其数值设置的严谨性。本练习将带您从物理理论走向计算实践，解决数值收敛性测试这一关键任务 。您将学习如何设计并识别一个严格的验证方案，以确保模拟结果准确反映了潜在的物理规律，而非数值计算引入的误差。",
            "id": "4200727",
            "problem": "一个基准线性回旋动理学(GK)微撕裂模将在磁通管几何中使用沿磁力线的气球模角坐标 $\\theta$ 进行模拟。电磁本征问题产生一个复本征值 $\\omega = \\omega_r + i \\gamma$ 以及定义在区间 $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$ 上的本征函数 $\\phi(\\theta)$ 和 $A_\\parallel(\\theta)$。离散化在平行坐标上使用网格间距 $\\Delta \\theta$ 进行，并采用尺寸为 $N_{v_\\parallel} \\times N_\\mu$ 的张量积速度空间网格，其中 $v_\\parallel$ 是平行速度，$\\mu$ 是磁矩。碰撞算子包括螺距角散射和能量扩散，这意味着需要对 $v_\\parallel$ 和 $\\mu$ 进行精确的速度空间求积，以解析电子响应。线性GK系统包含平行流算子 $v_\\parallel \\partial_\\theta$ 和通过Ampère定律的电磁耦合，这需要精确计算速度空间矩。在连续极限下，当 $\\Delta \\theta \\to 0$ 且 $N_{v_\\parallel}, N_\\mu \\to \\infty$ 时，计算出的 $\\omega$、$\\phi(\\theta)$ 和 $A_\\parallel(\\theta)$ 收敛到它们的连续值。\n\n根据第一性原理，解析一个微撕裂模需要：\n- 足够的平行分辨率来捕捉 $\\theta \\approx 0$ 附近的窄电流层，该电流层由电子动力学中的平行流和碰撞扩散之间的竞争决定，从而使得 $A_\\parallel(\\theta)$ 和 $J_\\parallel(\\theta)$ 中的局域梯度能够被离散导数算子和网格充分表示。\n- 足够的速度空间分辨率，以便精确计算微扰分布函数 $h_e(v_\\parallel,\\mu,\\theta)$ 的速度空间积分，从而确保准中性和Ampère定律的封闭性以及一致的电磁响应。\n- 一个基于线行动力学平衡的收敛判据，该平衡将增长率等同于净自由能注入减去耗散，即 $2 \\gamma W = P_{\\text{drive}} - P_{\\text{diss}}$ (其中 $W$ 是自由能)，并结合矩方程中的小残差，因为离散化误差会随着网格细化而消失。\n\n你的任务是确定哪个收敛性测试计划能通过分离 $\\Delta \\theta$、$N_{v_\\parallel}$ 和 $N_\\mu$ 中的离散化误差，并应用基于物理和范数的判据，来正确地验证本征值和本征函数得到了数值解析。所有物理参数（如垂直波数、安全因子、磁剪切、碰撞率和电子贝塔值）在所有测试中都保持不变。\n\n下面哪个选项是最合适的收敛计划？\n\nA. 执行三次独立的分辨率扫描，如下所示。对于 $\\Delta \\theta$ 扫描：选择至少3个嵌套网格，并相继减小 $\\Delta \\theta$（例如，$\\Delta \\theta$、$\\Delta \\theta/2$、$\\Delta \\theta/4$），同时将 $N_{v_\\parallel}$ 和 $N_\\mu$ 保持在非常高的基线值。对于 $N_{v_\\parallel}$ 扫描：在固定的较小 $\\Delta \\theta$ 和较大的 $N_\\mu$ 下，选择至少3个嵌套值（例如，$N_{v_\\parallel}$、$N_{v_\\parallel}+10$、$N_{v_\\parallel}+20$）。对于 $N_\\mu$ 扫描：在固定的较小 $\\Delta \\theta$ 和较大的 $N_{v_\\parallel}$ 下，选择至少3个嵌套值（例如，$N_\\mu$、$N_\\mu+10$、$N_\\mu+20$）。在每次扫描中，要求在两个最精细分辨率之间，本征值的相对变化满足 $|\\Delta \\omega|/|\\omega| < 1\\%$ 和 $|\\Delta \\gamma|/|\\gamma| < 1\\%$，并且本征函数的变化满足 $\\|\\phi^{(n+1)} - \\phi^{(n)}\\|_2/\\|\\phi^{(n+1)}\\|_2 < 2\\%$ 和 $\\|A_\\parallel^{(n+1)} - A_\\parallel^{(n)}\\|_2/\\|A_\\parallel^{(n+1)}\\|_2 < 2\\%$，其中 $n$ 是连续细化的索引。此外，通过检查准中性和Ampère定律中的残差小于最大项的 $1\\%$，以及自由能平衡 $2 \\gamma W \\approx P_{\\text{drive}} - P_{\\text{diss}}$ 在 $2\\%$ 的范围内成立，来验证封闭性。只有当所有三次扫描都独立满足这些标准，并且最精细的组合运行（同时使用小的 $\\Delta \\theta$、大的 $N_{v_\\parallel}$ 和大的 $N_\\mu$）相对于次精细的组合运行，本征值的变化小于 $0.5\\%$ 时，才接受收敛。\n\nB. 在一个单一的两级测试中，同时将 $\\Delta \\theta$、$N_{v_\\parallel}$ 和 $N_\\mu$ 从粗到细变化，如果两级之间的增长率 $\\gamma$ 变化小于 $5\\%$，则宣布收敛。通过目视检查本征函数的相似性，并且不执行矩封闭或自由能平衡残差检查。\n\nC. 仅细化 $\\Delta \\theta$，同时将 $N_{v_\\parallel}$ 和 $N_\\mu$ 固定在中等值，当模在 $\\theta = 0$ 附近表现出奇宇称且 $\\phi(0)$ 在 $3\\%$ 内消失时，宣布收敛。假设速度空间积分是准确的，因为平衡分布是麦克斯韦分布。\n\nD. 自适应地增加 $N_{v_\\parallel}$ 和 $N_\\mu$，直到 $h_e$ 的速度空间矩在不同细化程度下的变化小于 $2\\%$，同时保持 $\\Delta \\theta$ 固定。使用 $10\\%$ 的能量平衡容差来接受收敛。不进行平行分辨率扫描，因为假设在微撕裂模中，主导动力学是由速度空间驱动的。\n\n选择最佳选项。",
            "solution": "问题陈述描述了计算等离子体物理学中的一个标准数值练习：对微撕裂模的线性回旋动理学模拟进行验证。其目标是确定最严谨和最合适的计划，用于测试模拟结果的数值收敛性，即复本征值 $\\omega = \\omega_r + i\\gamma$ 及其相关的本征函数 $\\phi(\\theta)$ 和 $A_\\parallel(\\theta)$。\n\n### **问题验证**\n\n**步骤 1：提取已知条件**\n- **系统**：线性回旋动理学(GK)微撕裂模。\n- **几何**：磁通管，使用气球模角坐标 $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$。\n- **离散化参数**：平行网格间距 $\\Delta \\theta$、平行速度网格点数 $N_{v_\\parallel}$ 和磁矩网格点数 $N_\\mu$。\n- **物理**：该模型包括平行流 ($v_\\parallel \\partial_\\theta$)、电磁耦合 (Ampère定律) 以及一个包含螺距角散射和能量扩散的碰撞算子。\n- **分辨率要求 (第一性原理)**：\n    1.  足够的平行分辨率 ($\\Delta \\theta$) 来捕捉 $\\theta \\approx 0$ 附近的窄电流层。\n    2.  足够的速度空间分辨率 ($N_{v_\\parallel}$, $N_\\mu$) 来精确计算微扰分布函数 $h_e(v_\\parallel,\\mu,\\theta)$ 的积分。\n    3.  必须使用基于自由能平衡 $2 \\gamma W = P_{\\text{drive}} - P_{\\text{diss}}$ 的收敛判据和矩方程（准中性和Ampère定律）中的小残差来验证收敛性。\n- **任务**：确定一个收敛性测试计划，该计划通过分离 $\\Delta \\theta$、$N_{v_\\parallel}$ 和 $N_\\mu$ 中的离散化误差，并使用基于物理和范数的判据，来正确验证分辨率，同时保持所有物理参数不变。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在回旋动理学的既定理论和用于求解聚变等离子体中微撕裂模的GK方程的计算方法方面有充分的依据。所有概念——磁通管几何、气球模形式、线性GK系统的结构、微撕裂模的物理学（由电子温度梯度驱动，并以 $A_\\parallel$ 的撕裂宇称和精细的平行结构为特征）以及数值验证的原则——都是标准的且科学合理的。能量平衡方程是底层GK Vlasov-Maxwell系统的直接推论。\n- **适定性**：这个问题是适定的。它要求在一组选项中为一项明确定义的任务——数值收敛性验证——找出最合适的程序。其底层的物理问题，一个线性本征值问题，在典型的物理条件下也是适定的。\n- **客观性**：问题陈述是客观的，使用了计算等离子体物理领域的精确技术语言。它没有主观或含糊的术语。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。它科学合理、适定、客观，并为评估所提出的收敛计划提供了完整的背景。我现在将进行求解推导和选项分析。\n\n### **求解推导与选项分析**\n\n对于一个多维问题（如本题所述）的严格数值收敛性研究，必须遵守验证和确认的几个基本原则。\n\n1.  **分离离散化误差**：总数值误差是来自每个离散化维度（平行坐标 $\\theta$、平行速度 $v_\\parallel$、磁矩 $\\mu$）的误差之和。为确保每个维度都得到充分解析，标准做法是执行独立的分辨率扫描。在每次扫描中，一个离散化参数（例如 $\\Delta \\theta$）被系统地细化，而其他参数（例如 $N_{v_\\parallel}$、$N_\\mu$）则固定在较高的分辨率上，以最小化它们的误差贡献。这使得能够明确地识别每个坐标的分辨率要求。\n\n2.  **定量的、基于范数的度量**：必须使用客观、定量的度量来评估收敛性。目视检查是不充分且主观的。\n    - 对于像本征值 $\\omega$ 这样的标量，连续细化之间的相对差异是一个标准度量（例如，$|\\omega^{(n+1)} - \\omega^{(n)}| / |\\omega^{(n+1)}|  \\epsilon$）。实频率 $\\omega_r$ 和增长率 $\\gamma$ 都必须收敛。\n    - 对于像本征函数 $\\phi(\\theta)$ 和 $A_\\parallel(\\theta)$ 这样的场量，必须在合适的函数空间范数（如 $L_2$ 范数）中测量收敛性。归一化差异，例如 $\\|\\phi^{(n+1)} - \\phi^{(n)}\\|_2 / \\|\\phi^{(n+1)}\\|_2  \\epsilon$，是一个鲁棒的度量。\n\n3.  **基于物理的一致性检查**：一个数值收敛的解也必须是物理上正确的。这可以通过检查数值解在多大程度上满足连续物理系统固有的基本定律和性质来验证。\n    - **控制方程的残差**：核心的GK-Maxwell方程（在本例中为准中性和Ampère定律）是作为广义本征值问题求解的。一个正确的本征解必须满足这些方程。检查这些方程的残差与物理项相比是否很小，是一个关键的验证步骤。\n    - **守恒/平衡定律**：对于线性不稳定性，增长率与能量注入和耗散的平衡直接相关。问题正确地引用了自由能平衡方程 $2 \\gamma W = P_{\\text{drive}} - P_{\\text{diss}}$。要求这个恒等式在严格的容差内得到满足，是对整个解（包括本征值和本征函数）的一个强有力的综合性检查。\n\n基于这些原则，我们来评估每个选项。\n\n**A. 执行三次独立的分辨率扫描...**\n这个选项提出了一个全面且方法上合理的计划。\n- **误差分离**：它正确地规定了对 $\\Delta \\theta$、$N_{v_\\parallel}$ 和 $N_\\mu$ 进行三次独立的扫描，同时保持其他分辨率较高。这是正确的程序。使用至少3个嵌套级别是观察收敛趋势的良好实践。\n- **定量度量**：它对本征值 ($|\\Delta \\omega|/|\\omega|$、 $|\\Delta \\gamma|/|\\gamma|$) 和本征函数 ($\\|\\phi^{(n+1)} - \\phi^{(n)}\\|_2/\\|\\phi^{(n+1)}\\|_2$) 都采用了标准的定量度量。指定的容差 ($1\\%$、$2\\%$) 对于高保真度模拟是合理的。\n- **基于物理的检查**：它明确要求检查矩方程（准中性和Ampère定律）的残差，并以严格的容差验证自由能平衡。这是一个严谨验证计划的关键组成部分。\n- **最终确认**：在所有分辨率都达到最精细水平的最终检查，确认了离散化误差中任何潜在的交叉依赖性都很小。该计划与计算科学中代码和解验证的既定最佳实践完全一致。\n**结论：正确。**\n\n**B. 同时改变 $\\Delta \\theta$、$N_{v_\\parallel}$ 和 $N_\\mu$...**\n这个选项存在严重缺陷。\n- **误差混淆**：同时改变所有参数使得无法确定解是否在所有维度上都收敛，或者观察到的变化是由于误差抵消还是来自单一未解析维度的误差主导。\n- **细化不足**：“两级测试”不足以建立清晰的收敛趋势或估计收敛阶。\n- **主观且不完整的判据**：依赖“目视检查”来判断本征函数不是严谨的科学方法。忽略实频率 $\\omega_r$、矩封闭和能量平衡是关键的疏漏，因为一个模拟可能在物理上不一致的情况下产生一个看似合理的增长率 $\\gamma$。$5\\%$ 的容差也相当大。\n**结论：不正确。**\n\n**C. 仅细化 $\\Delta \\theta$ 而保持 $N_{v_\\parallel}$ 和 $N_\\mu$ 固定...**\n这个选项表现出对问题物理学的根本性误解。\n- **不完整的扫描**：它完全忽略了对速度空间收敛性的测试。如问题所述，涉及碰撞和精确速度空间矩的电子响应对于微撕裂模至关重要。一个未解析的速度空间将导致不正确的物理结果，无论平行分辨率如何。\n- **错误的假设**：认为速度空间积分是准确的，因为*平衡*分布是麦克斯韦分布，这种假设是错误的。数值挑战在于解析*微扰分布函数* $h_e(v_\\parallel, \\mu, \\theta)$ 的复杂、非麦克斯韦结构。\n- **不充分的判据**：检查模的宇称和 $\\phi$ 在单一点的值是必要的一致性检查，但不足以证明数值收敛。一个分辨率差的模拟仍然可能产生具有正确对称性的解。\n**结论：不正确。**\n\n**D. 自适应地增加 $N_{v_\\parallel}$ 和 $N_\\mu$...同时保持 $\\Delta \\theta$ 固定...**\n这个选项犯了与选项 C 相反的错误。\n- **不完整的扫描**：它完全忽略了对平行坐标 $\\theta$ 收敛性的测试。问题明确指出，微撕裂模在 $\\theta \\approx 0$ 附近具有窄电流层，这要求高的平行分辨率。忽略 $\\Delta \\theta$ 扫描是一个致命缺陷。这一点尤其正确，因为物理过程涉及平行流 ($v_\\parallel \\partial_\\theta$) 和碰撞之间的竞争，使得在速度空间和位形空间中的分辨率都至关重要。\n- **错误的假设**：认为平行分辨率不重要的假设与问题描述和已知的微撕裂模物理学都直接矛盾。\n- **宽松的容差**：$10\\%$ 的能量平衡容差过于宽松，会允许一个未充分收敛或物理上不一致的解。\n**结论：不正确。**\n\n总之，选项A是唯一描述了完整、系统且基于物理的验证程序的计划，该程序符合计算科学的标准。它正确地处理了所有相关维度（$\\theta$, $v_\\parallel$, $\\mu$）的分辨率要求，并包含了必要的定量和基于物理的检查。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "线性理论只能描述不稳定性的初始增长阶段，要理解最终形成的湍流状态，必须考虑非线性饱和机制。本练习介绍了一个强大的物理模型——混合长度估算 。通过它，您可以将线性增长率与饱和湍流的涨落幅度联系起来，为从线性分析到非线性湍流研究架起一座关键的桥梁。",
            "id": "4200697",
            "problem": "考虑一个磁化聚变等离子体中饱和微撕裂模湍流的简化模型。在此模型中，假定当由磁剪切引起的非线性退相干率与净线性驱动相平衡时，达到饱和状态。从适用于磁化等离子体动力学的第一性原理出发，推导饱和磁涨落水平 $\\langle |\\delta B|^2 \\rangle$ 的表达式，该表达式用背景磁场 $B_0$、离子质量 $m_i$、离子数密度 $n_i$、垂直波数 $k_\\perp$、线性增长率 $\\gamma_{\\mathrm{lin}}$ 和一组线性阻尼率 $\\{\\gamma_{d,j}\\}$ 来表示。使用以下基础：\n- 阿尔芬速度的定义 $v_A = \\dfrac{B_0}{\\sqrt{\\mu_0 \\rho}}$，其中质量密度 $\\rho = n_i m_i$，真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$。\n- 混合长度假设，即在饱和状态下，由磁剪切产生的非线性退相干率与净线性驱动具有相同的量级，并且可以使用特征垂直尺度 $k_\\perp$ 和对磁扰动的阿尔芬响应来估计。\n- 将净线性驱动视为 $\\gamma_{\\mathrm{net}} = \\gamma_{\\mathrm{lin}} - \\sum_j \\gamma_{d,j}$，并通过在 $\\gamma_{\\mathrm{net}} \\le 0$ 时设定 $\\langle |\\delta B|^2 \\rangle = 0$ 来施加物理一致性。\n\n将 $\\langle |\\delta B|^2 \\rangle$ 的最终结果以特斯拉的平方 (T$^2$) 表示。假设量级为1的无量纲混合长度常数 $C_{\\mathrm{ml}} = 1$。\n\n你的任务是实现一个程序，为以下每个测试用例计算 $\\langle |\\delta B|^2 \\rangle$。在每个用例中，将所有率的单位解释为 $\\mathrm{s}^{-1}$，所有波数的单位解释为 $\\mathrm{m}^{-1}$，数密度的单位解释为 $\\mathrm{m}^{-3}$，质量的单位解释为 $\\mathrm{kg}$，磁场的单位解释为特斯拉 (T)。答案必须是代表 $\\langle |\\delta B|^2 \\rangle$ (单位为 T$^2$) 的浮点数。\n\n测试套件（每个用例列为 $(B_0, n_i, m_i, k_\\perp, \\gamma_{\\mathrm{lin}}, [\\gamma_{d,1}, \\gamma_{d,2}, \\ldots])$）：\n1. $(2.5, 1.0\\times 10^{20}, 3.344\\times 10^{-27}, 150, 6.0\\times 10^{4}, [2.0\\times 10^{4}, 1.5\\times 10^{4}, 0.5\\times 10^{4}])$ 一个典型的正驱动用例。\n2. $(3.0, 8.0\\times 10^{19}, 3.344\\times 10^{-27}, 200, 3.5\\times 10^{4}, [2.0\\times 10^{4}, 1.5\\times 10^{4}])$ 一个净驱动为零的边界用例。\n3. $(2.0, 1.2\\times 10^{20}, 3.344\\times 10^{-27}, 100, 2.0\\times 10^{4}, [3.0\\times 10^{4}])$ 一个净驱动为负的稳定用例。\n4. $(5.0, 3.0\\times 10^{19}, 3.344\\times 10^{-27}, 400, 8.0\\times 10^{4}, [1.0\\times 10^{4}])$ 一个强场和低密度导致大阿尔芬速度的用例。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4]”），其中每个条目是相应测试用例计算出的 $\\langle |\\delta B|^2 \\rangle$（单位 T$^2$），并遵循规则：如果 $\\gamma_{\\mathrm{net}} \\le 0$，则结果为 $0.0$。",
            "solution": "该问题要求在一个简化的微撕裂模湍流模型中，推导饱和磁涨落水平（表示为 $\\langle |\\delta B|^2 \\rangle$）的表达式。推导过程必须遵循问题陈述中概述的第一性原理。\n\n首先，我们建立此模型中饱和的基本条件。混合长度假设假定当非线性退相干率 $\\gamma_{\\mathrm{NL}}$ 与不稳定性的净线性增长率 $\\gamma_{\\mathrm{net}}$ 相当时，发生饱和。我们可以将其写成一个量级平衡：\n$$ \\gamma_{\\mathrm{NL}} \\approx \\gamma_{\\mathrm{net}} $$\n问题为净线性驱动提供了一个形式化定义：\n$$ \\gamma_{\\mathrm{net}} = \\gamma_{\\mathrm{lin}} - \\sum_j \\gamma_{d,j} $$\n其中 $\\gamma_{\\mathrm{lin}}$ 是线性增长率，$\\{\\gamma_{d,j}\\}$ 是所有线性阻尼率的集合。一个关键的物理约束是，如果 $\\gamma_{\\mathrm{net}} \\le 0$，则该模式是稳定或边缘稳定的，因此不会发展出湍流。在这种情况下，饱和涨落振幅必须为零：\n$$ \\langle |\\delta B|^2 \\rangle = 0 \\quad \\text{if} \\quad \\gamma_{\\mathrm{net}} \\le 0 $$\n对于 $\\gamma_{\\mathrm{net}}  0$ 的不稳定情况，我们必须为非线性退相干率 $\\gamma_{\\mathrm{NL}}$ 构建一个模型。问题指明，该率源于磁剪切，并应使用特征垂直波数 $k_\\perp$ 和对磁扰动的阿尔芬响应来估计。\n\n非线性退相干机制是受扰动的磁力线对湍流涡的剪切。磁力线本身被磁涨落 $\\delta B$ 随机“弯曲”。沿平均磁场 $\\mathbf{B}_0$ 传播的粒子或波包将经历一个有效的平行动力学过程，该过程被涨落的垂直分量 $\\delta \\mathbf{B}_\\perp$ 所修正。湍流的有效平行波数 $k_{\\parallel, \\text{NL}}$ 表征了沿总的、受扰动的磁场的梯度，可以估计为垂直波数 $k_\\perp$ 与磁力线倾斜角（近似为 $|\\delta B|/B_0$）的乘积。\n$$ k_{\\parallel, \\text{NL}} \\sim k_\\perp \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} $$\n在这里，我们使用均方根 (RMS) 涨落振幅 $\\sqrt{\\langle |\\delta B|^2 \\rangle}$ 作为特征幅度。\n\n与沿这些受扰动磁力线的动力学相关的特征频率（或速率）由相关波的传播速度决定，对于磁扰动而言，该速度是阿尔芬速度 $v_A$。因此，非线性退相干率可以估计为这个有效平行波数与阿尔芬速度的乘积。\n$$ \\gamma_{\\mathrm{NL}} \\sim k_{\\parallel, \\text{NL}} v_A \\sim k_\\perp v_A \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} $$\n引入量级为1的无量纲混合长度常数 $C_{\\mathrm{ml}}$，我们将此关系形式化为：\n$$ \\gamma_{\\mathrm{NL}} = C_{\\mathrm{ml}} k_\\perp v_A \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} $$\n问题指定 $C_{\\mathrm{ml}} = 1$。\n\n现在，对于 $\\gamma_{\\mathrm{net}}  0$ 的情况，我们通过将非线性率与净线性驱动等同来强制执行饱和条件：\n$$ C_{\\mathrm{ml}} k_\\perp v_A \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} = \\gamma_{\\mathrm{net}} $$\n解出 RMS 磁涨落振幅 $\\sqrt{\\langle |\\delta B|^2 \\rangle}$：\n$$ \\sqrt{\\langle |\\delta B|^2 \\rangle} = \\frac{\\gamma_{\\mathrm{net}} B_0}{C_{\\mathrm{ml}} k_\\perp v_A} $$\n两边平方得到所求的量，即均方磁涨落水平：\n$$ \\langle |\\delta B|^2 \\rangle = \\left(\\frac{\\gamma_{\\mathrm{net}} B_0}{C_{\\mathrm{ml}} k_\\perp v_A}\\right)^2 $$\n问题提供了阿尔芬速度 $v_A$ 的定义：\n$$ v_A = \\frac{B_0}{\\sqrt{\\mu_0 \\rho}} $$\n其中质量密度 $\\rho$ 由 $\\rho = n_i m_i$ 给出，$\\mu_0$ 是真空磁导率。代入 $\\rho$ 的表达式：\n$$ v_A = \\frac{B_0}{\\sqrt{\\mu_0 n_i m_i}} $$\n现在我们可以将 $v_A$ 的这个表达式代入我们关于 $\\langle |\\delta B|^2 \\rangle$ 的方程中：\n$$ \\langle |\\delta B|^2 \\rangle = \\left(\\frac{\\gamma_{\\mathrm{net}} B_0}{C_{\\mathrm{ml}} k_\\perp \\left(\\frac{B_0}{\\sqrt{\\mu_0 n_i m_i}}\\right)}\\right)^2 $$\n背景磁场强度 $B_0$ 从表达式中消去：\n$$ \\langle |\\delta B|^2 \\rangle = \\left(\\frac{\\gamma_{\\mathrm{net}} \\sqrt{\\mu_0 n_i m_i}}{C_{\\mathrm{ml}} k_\\perp}\\right)^2 $$\n这简化为我们的最终解析结果。按照规定设置 $C_{\\mathrm{ml}}=1$：\n$$ \\langle |\\delta B|^2 \\rangle = \\frac{\\gamma_{\\mathrm{net}}^2 \\mu_0 n_i m_i}{k_\\perp^2} $$\n将此与稳定性条件相结合，完整的表达式是：\n$$ \\langle |\\delta B|^2 \\rangle = \\begin{cases} \\dfrac{(\\gamma_{\\mathrm{lin}} - \\sum_j \\gamma_{d,j})^2 \\mu_0 n_i m_i}{k_\\perp^2}  \\text{if } \\gamma_{\\mathrm{lin}}  \\sum_j \\gamma_{d,j} \\\\ 0  \\text{if } \\gamma_{\\mathrm{lin}} \\le \\sum_j \\gamma_{d,j} \\end{cases} $$\n此表达式将用于计算所提供测试用例的数值结果。所有输入均以国际单位制（SI）单位给出，$\\langle |\\delta B|^2 \\rangle$ 的结果将以特斯拉的平方（T$^2$）为单位。真空磁导率的值为 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the saturated magnetic fluctuation level for microtearing-mode turbulence\n    based on a simplified mixing-length model.\n    \"\"\"\n    # Define the fundamental constant: vacuum magnetic permeability in N/A^2 (or H/m)\n    MU_0 = 4 * np.pi * 1e-7\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (B0, ni, mi, k_perp, gamma_lin, list_of_gamma_d)\n    # Units: B0 (T), ni (m^-3), mi (kg), k_perp (m^-1), all rates (s^-1)\n    test_cases = [\n        # Case 1: typical positive-drive case\n        (2.5, 1.0e20, 3.344e-27, 150, 6.0e4, [2.0e4, 1.5e4, 0.5e4]),\n        # Case 2: boundary case with zero net drive\n        (3.0, 8.0e19, 3.344e-27, 200, 3.5e4, [2.0e4, 1.5e4]),\n        # Case 3: stable case with negative net drive\n        (2.0, 1.2e20, 3.344e-27, 100, 2.0e4, [3.0e4]),\n        # Case 4: case with strong field and low density\n        (5.0, 3.0e19, 3.344e-27, 400, 8.0e4, [1.0e4]),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case. Note: B0 is not needed in the final formula\n        # but is kept for clarity relative to the problem definition.\n        _B0, ni, mi, k_perp, gamma_lin, gamma_d_list = case\n\n        # Calculate the sum of all linear damping rates\n        sum_gamma_d = sum(gamma_d_list)\n\n        # Calculate the net linear drive\n        gamma_net = gamma_lin - sum_gamma_d\n\n        # Apply the physical consistency condition:\n        # If the net drive is zero or negative, the mode is stable and fluctuation level is zero.\n        if gamma_net = 0:\n            saturated_B_sq = 0.0\n        else:\n            # The derived expression for the saturated mean-squared magnetic fluctuation level:\n            # |delta B|^2> = (gamma_net^2 * mu_0 * ni * mi) / (k_perp^2)\n            numerator = (gamma_net**2) * MU_0 * ni * mi\n            denominator = k_perp**2\n            saturated_B_sq = numerator / denominator\n        \n        results.append(saturated_B_sq)\n\n    # Format the results into the required output string: \"[result1,result2,result3,result4]\"\n    # Using a general format specifier 'g' to handle floating point representation cleanly.\n    output_string = f\"[{','.join(f'{r:g}' for r in results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}