{
    "hands_on_practices": [
        {
            "introduction": "Understanding the source of free energy that drives an instability is the first step in its analysis. For microtearing modes (MTMs), this drive is primarily the electron temperature gradient. This exercise  provides a hands-on opportunity to connect realistic plasma profiles for density and temperature to the key dimensionless parameter, $\\eta_e$, and to reason from first principles about how this parameter governs the stability of the mode.",
            "id": "4200707",
            "problem": "Consider a large-aspect-ratio tokamak with minor radius $a$ and equilibria that vary only radially $r \\in [0,a]$. Let the electron density profile be $n_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p$ and the electron temperature profile be $T_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q$, where $n_0$, $T_0$, $p$, and $q$ are positive constants, and $B$ is a uniform toroidal magnetic field magnitude. Assume a microtearing-unstable wavenumber ordering $k_y \\rho_e \\ll 1$ and semi-collisional electrons, defined by $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$, where $\\lambda_{\\mathrm{mfp}} = v_{te}/\\nu_e$, $v_{te} = \\sqrt{2 T_e/m_e}$ is the electron thermal speed, and $\\nu_e$ is the electron collision frequency. Let the magnetic shear be weak but finite, and focus on the reconnecting parity component of the parallel vector potential $A_{\\parallel}$.\n\nStarting from the fundamental definition of gradient scale lengths $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ and $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$, construct the local electron temperature gradient parameter $\\eta_e = \\frac{L_n}{L_{T_e}}$ at the radius $r_0 = \\frac{a}{2}$, given $p = 1.7$ and $q = 3.1$. Then, using first-principles linearization of the electron parallel force balance and energy equations in the semi-collisional regime together with Ampère’s law, determine the sign of $\\frac{d \\gamma}{d \\eta_e}$ at fixed $k_y$ near $r_0$, where $\\gamma$ is the microtearing linear growth rate. Encode your qualitative stability prediction numerically as $+1$ if increasing $\\eta_e$ (at fixed other parameters) increases $\\gamma$ (destabilizes the mode), and $-1$ if increasing $\\eta_e$ decreases $\\gamma$ (stabilizes the mode).\n\nYou must produce a two-entry final answer: the first entry is the value of $\\eta_e(r_0)$ (dimensionless), rounded to four significant figures; the second entry is the sign of $\\frac{d \\gamma}{d \\eta_e}$ encoded as $+1$ or $-1$ (dimensionless). Provide the final answer without units.",
            "solution": "The problem asks for two quantities related to microtearing modes (MTM) in a tokamak plasma. First, we must calculate the local electron temperature gradient parameter, $\\eta_e$, at a specific radius. Second, we must determine the sign of the derivative of the MTM linear growth rate, $\\gamma$, with respect to $\\eta_e$, which indicates whether increasing $\\eta_e$ is stabilizing or destabilizing.\n\nPart 1: Calculation of $\\eta_e(r_0)$\n\nThe parameter $\\eta_e$ is defined as the ratio of the electron density gradient scale length, $L_n$, to the electron temperature gradient scale length, $L_{T_e}$.\n$$\n\\eta_e = \\frac{L_n}{L_{T_e}}\n$$\nThe gradient scale lengths are defined as $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ and $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$. We are given the electron density and temperature profiles:\n$$\nn_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p\n$$\n$$\nT_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q\n$$\nFirst, we calculate the logarithmic derivative of the electron density, $n_e$. The natural logarithm of $n_e(r)$ is:\n$$\n\\ln n_e(r) = \\ln n_0 + p \\ln\\left(1 - \\frac{r^2}{a^2}\\right)\n$$\nDifferentiating with respect to the minor radius $r$:\n$$\n\\frac{d \\ln n_e}{dr} = 0 + p \\cdot \\frac{1}{1 - \\frac{r^2}{a^2}} \\cdot \\left(-\\frac{2r}{a^2}\\right) = -\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nThe inverse gradient scale length for density is thus $\\frac{1}{L_n} = -\\frac{d \\ln n_e}{dr}$:\n$$\n\\frac{1}{L_n(r)} = \\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nBy direct analogy, for the electron temperature profile $T_e(r)$, we can replace the parameter $p$ with $q$:\n$$\n\\frac{d \\ln T_e}{dr} = -\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nAnd the inverse gradient scale length for temperature is $\\frac{1}{L_{T_e}} = -\\frac{d \\ln T_e}{dr}$:\n$$\n\\frac{1}{L_{T_e}(r)} = \\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nNow we can compute $\\eta_e(r)$ by taking the ratio of the inverse scale lengths:\n$$\n\\eta_e(r) = \\frac{L_n(r)}{L_{T_e}(r)} = \\frac{1/L_{T_e}(r)}{1/L_n(r)} = \\frac{\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}}{\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}} = \\frac{q}{p}\n$$\nFor this specific functional form of the profiles, the parameter $\\eta_e$ is a constant, independent of the radial position $r$. We are given the constants $p = 1.7$ and $q = 3.1$. Therefore, the value of $\\eta_e$ at any radius, including $r_0 = a/2$, is:\n$$\n\\eta_e = \\frac{3.1}{1.7} \\approx 1.823529...\n$$\nRounding to four significant figures as required, we get:\n$$\n\\eta_e(r_0) \\approx 1.824\n$$\n\nPart 2: Stability Dependence on $\\eta_e$\n\nNext, we must determine the sign of $\\frac{d\\gamma}{d\\eta_e}$, where $\\gamma$ is the linear growth rate of the microtearing mode. This requires an understanding of the fundamental instability mechanism.\n\nMicrotearing modes are electromagnetic instabilities driven by the free energy stored in the electron temperature gradient. The mode involves a magnetic perturbation, primarily in the parallel vector potential $\\tilde{A}_{\\parallel}$, which leads to the formation of small magnetic islands and stochasticity in the magnetic field lines.\n\nThe analysis starts from three fundamental equations:\n1.  **Ampère's Law**: This relates the magnetic perturbation to the electron current perturbation, $\\tilde{j}_{\\parallel e}$. In slab geometry, this is $-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\tilde{j}_{\\parallel e}$. Perturbations are of the form $\\exp(ik_y y - i\\omega t)$, with $\\omega = \\omega_r + i\\gamma$. A growing mode has $\\gamma > 0$.\n2.  **Electron Parallel Force Balance (Generalized Ohm's Law)**: This equation determines the parallel current. In response to a parallel electric field $\\tilde{E}_{\\parallel} = -\\frac{\\partial \\tilde{A}_{\\parallel}}{\\partial t} - \\nabla_{\\parallel} \\tilde{\\phi} = i\\omega \\tilde{A}_{\\parallel} - ik_{\\parallel} \\tilde{\\phi}$, electrons produce a current. The response depends on collisionality. A key term in this balance is the thermal force, proportional to the parallel gradient of the electron temperature perturbation, $\\nabla_{\\parallel} \\tilde{T}_e$.\n3.  **Electron Energy Balance**: This equation determines the temperature perturbation $\\tilde{T}_e$. It balances the heating/cooling from field-parallel transport, magnetic field line flutter, and other sources/sinks.\n\nThe instability mechanism in the semi-collisional regime, $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$, relies on a specific phase relationship. The free energy source is the background temperature gradient, $\\nabla_r T_e = -T_e/L_{T_e}$. This energy is released through the radial transport of heat by electrons moving along perturbed magnetic field lines. The rate of energy release is proportional to $\\langle \\tilde{q}_r \\left(-\\nabla_r T_e\\right) \\rangle$, where $\\tilde{q}_r = \\tilde{q}_{\\parallel e}(\\tilde{B}_r/B)$ is the radial heat flux due to parallel heat transport along a radially perturbed magnetic field line, $\\tilde{B}_r = ik_y \\tilde{A}_{\\parallel}$.\n\nFor instability ($\\gamma > 0$), there must be a net transfer of energy from the background thermal gradient to the electromagnetic field perturbation. This occurs when the electron current perturbation $\\tilde{j}_{\\parallel e}$ is partially in phase with the inductive electric field perturbation $\\tilde{E}_{\\parallel,ind} = i\\omega \\tilde{A}_{\\parallel}$. The required phase shift is provided by electron collisions in conjunction with the thermal force.\n\nThe strength of the instability drive is directly proportional to the magnitude of the free energy source, which is the electron temperature gradient.\n$$\n\\text{Drive} \\propto \\left| \\frac{dT_e}{dr} \\right| \\propto \\frac{1}{L_{T_e}}\n$$\nThe growth rate $\\gamma$ is a function of this drive, so we can write, to a first approximation:\n$$\n\\gamma \\propto \\frac{1}{L_{T_e}}\n$$\nThe problem asks for the dependence of $\\gamma$ on $\\eta_e = L_n/L_{T_e}$. We can express the drive in terms of $\\eta_e$ and the density gradient scale length $L_n$:\n$$\n\\frac{1}{L_{T_e}} = \\frac{\\eta_e}{L_n}\n$$\nTherefore, the growth rate dependence can be written as:\n$$\n\\gamma \\propto \\frac{\\eta_e}{L_n}\n$$\nThe question asks for the sign of $\\frac{d\\gamma}{d\\eta_e}$ at fixed other parameters. In theoretical and experimental contexts, \"other parameters\" are typically taken to mean quantities like $L_n$, the magnetic shear, plasma beta, and collisionality. Under this standard assumption (i.e., holding $L_n$ constant), the growth rate $\\gamma$ is directly proportional to $\\eta_e$.\n$$\n\\frac{d\\gamma}{d\\eta_e} \\propto \\frac{1}{L_n}\n$$\nSince $L_n = \\frac{a^2(1 - r_0^2/a^2)}{2pr_0}$ is a positive quantity (given $p>0$ and $r_0 \\in (0,a)$), the derivative must be positive.\n$$\n\\frac{d\\gamma}{d\\eta_e} > 0\n$$\nThis signifies that increasing the electron temperature gradient relative to the density gradient is destabilizing for the microtearing mode. A larger $\\eta_e$ implies a steeper temperature profile for a given density profile, providing more free energy to drive the instability. The numerical encoding for this positive sign is $+1$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.824 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The power of numerical simulation is only realized when we can trust the results. For complex systems like the gyrokinetic equations, ensuring that a solution is physically meaningful and not an artifact of numerical discretization is a critical skill. This practice  moves from physics to computational practice, challenging you to design a rigorous verification plan to confirm that a simulated microtearing mode is well-resolved, a process fundamental to all high-fidelity simulation work.",
            "id": "4200727",
            "problem": "A benchmark linear Gyrokinetic (GK) microtearing mode is to be simulated in a flux-tube geometry using the ballooning angle coordinate $\\theta$ along the magnetic field line. The electromagnetic eigenproblem yields a complex eigenvalue $\\omega = \\omega_r + i \\gamma$ and eigenfunctions $\\phi(\\theta)$ and $A_\\parallel(\\theta)$ defined on the domain $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$. Discretization is performed with grid spacing $\\Delta \\theta$ in the parallel coordinate and with a tensor-product velocity-space grid of size $N_{v_\\parallel} \\times N_\\mu$, where $v_\\parallel$ is the parallel velocity and $\\mu$ is the magnetic moment. The collision operator includes pitch-angle scattering and energy diffusion, implying that accurate velocity-space quadrature in both $v_\\parallel$ and $\\mu$ is required to resolve the electron response. The linear GK system contains the parallel streaming operator $v_\\parallel \\partial_\\theta$ and electromagnetic coupling through Ampère’s law, which requires accurate evaluation of velocity-space moments. In the continuous limit, as $\\Delta \\theta \\to 0$ and $N_{v_\\parallel}, N_\\mu \\to \\infty$, the computed $\\omega$, $\\phi(\\theta)$, and $A_\\parallel(\\theta)$ converge to their continuum values.\n\nFrom first principles, resolving a microtearing mode requires:\n- Sufficient parallel resolution to capture the narrow current layer around $\\theta \\approx 0$, which is set by the competition between parallel streaming and collisional diffusion in the electron dynamics, so that localized gradients in $A_\\parallel(\\theta)$ and $J_\\parallel(\\theta)$ are adequately represented by the discrete derivative operator and grid.\n- Sufficient velocity-space resolution so that the velocity-space integrals of the perturbed distribution function $h_e(v_\\parallel,\\mu,\\theta)$ are accurately computed, ensuring closure of quasineutrality and Ampère’s law and a consistent electromagnetic response.\n- A convergence criterion grounded in the linear dynamical balance that equates the growth rate to the net free-energy injection minus dissipation, i.e., $2 \\gamma W = P_{\\text{drive}} - P_{\\text{diss}}$, where $W$ is the free energy, combined with small residuals in moment equations, as discretization errors vanish under refinement.\n\nYou are to identify which convergence test plan correctly verifies that the eigenvalues and eigenfunctions are numerically resolved by isolating discretization errors in $\\Delta \\theta$, $N_{v_\\parallel}$, and $N_\\mu$, and by applying physically grounded and norm-based criteria. All physical parameters (such as perpendicular wavenumber, safety factor, magnetic shear, collisionality, and electron beta) are held fixed across tests.\n\nWhich option below is the most appropriate convergence plan?\n\nA. Perform three independent resolution scans as follows. For the $\\Delta \\theta$ scan: choose at least $3$ nested grids with $\\Delta \\theta$ reduced successively (for example, $\\Delta \\theta$, $\\Delta \\theta/2$, $\\Delta \\theta/4$), while holding $N_{v_\\parallel}$ and $N_\\mu$ at very high baseline values. For the $N_{v_\\parallel}$ scan: choose at least $3$ nested values (for example, $N_{v_\\parallel}$, $N_{v_\\parallel}+10$, $N_{v_\\parallel}+20$) at fixed small $\\Delta \\theta$ and large $N_\\mu$. For the $N_\\mu$ scan: choose at least $3$ nested values (for example, $N_\\mu$, $N_\\mu+10$, $N_\\mu+20$) at fixed small $\\Delta \\theta$ and large $N_{v_\\parallel}$. In each scan, require that the relative change in eigenvalue satisfies $|\\Delta \\omega|/|\\omega| < 1\\%$ and $|\\Delta \\gamma|/|\\gamma| < 1\\%$ between the two finest resolutions, and that the eigenfunction changes satisfy $\\|\\phi^{(n+1)} - \\phi^{(n)}\\|_2/\\|\\phi^{(n+1)}\\|_2 < 2\\%$ and $\\|A_\\parallel^{(n+1)} - A_\\parallel^{(n)}\\|_2/\\|A_\\parallel^{(n+1)}\\|_2 < 2\\%$, where $n$ indexes successive refinements. Additionally, verify closure by checking that the residuals in quasineutrality and Ampère’s law are less than $1\\%$ of the largest term and that the free-energy balance $2 \\gamma W \\approx P_{\\text{drive}} - P_{\\text{diss}}$ holds within $2\\%$. Accept convergence only if all three scans independently meet these criteria and the finest combined run (simultaneously small $\\Delta \\theta$, large $N_{v_\\parallel}$, and large $N_\\mu$) changes the eigenvalue by less than $0.5\\%$ relative to the second-finest combined run.\n\nB. Vary $\\Delta \\theta$, $N_{v_\\parallel}$, and $N_\\mu$ simultaneously from coarse to fine in a single two-level test, and declare convergence if the growth rate $\\gamma$ changes by less than $5\\%$ between the two levels. Eigenfunctions are inspected visually for similarity, and no moment-closure or free-energy balance residual checks are performed.\n\nC. Refine only $\\Delta \\theta$ while keeping $N_{v_\\parallel}$ and $N_\\mu$ fixed at moderate values, and declare convergence when the mode exhibits odd parity around $\\theta = 0$ and when $\\phi(0)$ vanishes within $3\\%$. Velocity-space integrals are assumed to be accurate because the equilibrium distribution is Maxwellian.\n\nD. Increase $N_{v_\\parallel}$ and $N_\\mu$ adaptively until velocity-space moments of $h_e$ change by less than $2\\%$ across refinements, while keeping $\\Delta \\theta$ fixed. Use an energy balance tolerance of $10\\%$ to accept convergence. Parallel resolution is not scanned because the dominant dynamics are assumed to be velocity-space driven in microtearing modes.\n\nSelect the best option.",
            "solution": "The problem statement describes a standard numerical exercise in computational plasma physics: the verification of a linear gyrokinetic simulation of a microtearing mode. The goal is to identify the most rigorous and appropriate plan for testing the numerical convergence of the simulation's results, namely the complex eigenvalue $\\omega = \\omega_r + i\\gamma$ and the associated eigenfunctions $\\phi(\\theta)$ and $A_\\parallel(\\theta)$.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n- **System**: Linear Gyrokinetic (GK) microtearing mode.\n- **Geometry**: Flux-tube, using ballooning angle coordinate $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$.\n- **Discretization Parameters**: Parallel grid spacing $\\Delta \\theta$, parallel velocity grid points $N_{v_\\parallel}$, and magnetic moment grid points $N_\\mu$.\n- **Physics**: The model includes parallel streaming ($v_\\parallel \\partial_\\theta$), electromagnetic coupling (Ampère’s law), and a collision operator with pitch-angle scattering and energy diffusion.\n- **Resolution Requirements (First Principles)**:\n    1.  Sufficient parallel resolution ($\\Delta \\theta$) to capture the narrow current layer around $\\theta \\approx 0$.\n    2.  Sufficient velocity-space resolution ($N_{v_\\parallel}$, $N_\\mu$) for accurate evaluation of integrals of the perturbed distribution function $h_e(v_\\parallel,\\mu,\\theta)$.\n    3.  Convergence must be verified using a convergence criterion based on the free-energy balance, $2 \\gamma W = P_{\\text{drive}} - P_{\\text{diss}}$, and small residuals in moment equations (quasineutrality and Ampère’s law).\n- **Task**: Identify the convergence test plan that correctly verifies resolution by isolating discretization errors in $\\Delta \\theta$, $N_{v_\\parallel}$, and $N_\\mu$ using physically grounded and norm-based criteria, while keeping all physical parameters fixed.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is well-grounded in the established theory of gyrokinetics and the computational methods used to solve the GK equations for microtearing modes in fusion plasmas. All concepts—flux-tube geometry, ballooning formalism, the structure of the linear GK system, the physics of microtearing modes (driven by electron temperature gradients and characterized by tearing parity of $A_\\parallel$ and fine parallel structures), and the principles of numerical verification—are standard and scientifically sound. The energy balance equation is a direct consequence of the underlying GK Vlasov-Maxwell system.\n- **Well-Posed**: The question is well-posed. It asks for the identification of the most appropriate procedure among a set of options for a clearly defined task: numerical convergence verification. The underlying physical problem, a linear eigenvalue problem, is also well-posed under typical physical conditions.\n- **Objective**: The problem statement is objective, using precise, technical language from the field of computational plasma physics. It is free of subjective or ambiguous terminology.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. It is scientifically sound, well-posed, objective, and provides a complete context for evaluating the proposed convergence plans. I will now proceed with the solution derivation and option analysis.\n\n### **Solution Derivation and Option Analysis**\n\nA rigorous numerical convergence study for a multi-dimensional problem, such as the one described, must adhere to several fundamental principles of verification and validation.\n\n1.  **Isolation of Discretization Errors**: The total numerical error is a sum of errors from each discretization dimension (parallel coordinate $\\theta$, parallel velocity $v_\\parallel$, magnetic moment $\\mu$). To ensure each dimension is adequately resolved, it is standard practice to perform independent resolution scans. In each scan, one discretization parameter (e.g., $\\Delta \\theta$) is refined systematically while the others (e.g., $N_{v_\\parallel}$, $N_\\mu$) are held fixed at a high resolution to minimize their error contribution. This allows for the unambiguous identification of the resolution requirements for each coordinate.\n\n2.  **Quantitative, Norm-Based Metrics**: Convergence must be assessed using objective, quantitative measures. Visual inspection is insufficient and subjective.\n    - For scalar quantities like the eigenvalue $\\omega$, the relative difference between successive refinements is a standard metric (e.g., $|\\omega^{(n+1)} - \\omega^{(n)}| / |\\omega^{(n+1)}| < \\epsilon$). Both the real frequency $\\omega_r$ and the growth rate $\\gamma$ must converge.\n    - For field quantities like the eigenfunctions $\\phi(\\theta)$ and $A_\\parallel(\\theta)$, convergence must be measured in a suitable function space norm, such as the $L_2$-norm. The normalized difference, e.g., $\\|\\phi^{(n+1)} - \\phi^{(n)}\\|_2 / \\|\\phi^{(n+1)}\\|_2 < \\epsilon$, is a robust metric.\n\n3.  **Physics-Based Consistency Checks**: A numerically converged solution must also be physically correct. This is verified by checking how well the numerical solution satisfies fundamental laws and properties that are inherent to the continuous physical system.\n    - **Residuals of Governing Equations**: The core GK-Maxwell equations (in this case, quasineutrality and Ampère's law) are solved as a generalized eigenvalue problem. A correct eigen-solution must satisfy these equations. Checking that the residuals of these equations are small compared to the physical terms is a crucial verification step.\n    - **Conservation/Balance Laws**: For a linear instability, the growth rate is directly tied to the balance of energy injection and dissipation. The problem correctly cites the free-energy balance equation, $2 \\gamma W = P_{\\text{drive}} - P_{\\text{diss}}$. Requiring this identity to be satisfied to a tight tolerance is a powerful, integrated check on the entire solution (both eigenvalue and eigenfunctions).\n\nBased on these principles, let us evaluate each option.\n\n**A. Perform three independent resolution scans...**\nThis option proposes a comprehensive and methodologically sound plan.\n- **Isolation of Errors**: It correctly prescribes three independent scans for $\\Delta \\theta$, $N_{v_\\parallel}$, and $N_\\mu$, holding other resolutions high. This is the correct procedure. The use of at least $3$ nested levels is good practice for observing a convergence trend.\n- **Quantitative Metrics**: It employs standard, quantitative metrics for both eigenvalues ($|\\Delta \\omega|/|\\omega|$, $|\\Delta \\gamma|/|\\gamma|$) and eigenfunctions ($\\|\\phi^{(n+1)} - \\phi^{(n)}\\|_2/\\|\\phi^{(n+1)}\\|_2$). The specified tolerances ($<1\\%$, $<2\\%$) are reasonable for high-fidelity simulations.\n- **Physics-Based Checks**: It explicitly requires checking the residuals of the moment equations (quasineutrality and Ampère’s law) and verifying the free-energy balance to tight tolerances. This is a critical component of a rigorous verification plan.\n- **Final Confirmation**: The final check with all resolutions at their finest levels provides confirmation that any potential cross-dependencies in discretization errors are small.\nThis plan aligns perfectly with the established best practices for code and solution verification in computational science.\n**Verdict: Correct.**\n\n**B. Vary $\\Delta \\theta$, $N_{v_\\parallel}$, and $N_\\mu$ simultaneously...**\nThis option is deeply flawed.\n- **Conflation of Errors**: Varying all parameters simultaneously makes it impossible to determine if the solution is converged in all dimensions or if the observed change is due to error cancellation or the dominance of error from a single, unresolved dimension.\n- **Insufficient Refinement**: A \"two-level test\" is inadequate to establish a clear convergence trend or estimate the order of convergence.\n- **Subjective and Incomplete Criteria**: Relying on \"visual inspection\" for eigenfunctions is not a rigorous scientific method. Ignoring the real frequency $\\omega_r$, moment closure, and energy balance is a critical omission, as a simulation can yield a plausible growth rate $\\gamma$ while being physically inconsistent. The $5\\%$ tolerance is also quite large.\n**Verdict: Incorrect.**\n\n**C. Refine only $\\Delta \\theta$ while keeping $N_{v_\\parallel}$ and $N_\\mu$ fixed...**\nThis option exhibits a fundamental misunderstanding of the problem physics.\n- **Incomplete Scans**: It completely neglects to test for convergence in velocity space. As stated in the problem, the electron response, involving collisions and accurate velocity-space moments, is crucial for microtearing modes. An unresolved velocity space will lead to an incorrect physical result, regardless of the parallel resolution.\n- **Fallacious Assumption**: The assumption that velocity-space integrals are accurate because the *equilibrium* is Maxwellian is wrong. The numerical challenge lies in resolving the complex, non-Maxwellian structure of the *perturbed distribution function* $h_e(v_\\parallel, \\mu, \\theta)$.\n- **Insufficient Criteria**: Checking for mode parity and the value of $\\phi$ at a single point are necessary consistency checks but are not sufficient to prove numerical convergence. A poorly resolved simulation can still produce a solution with the correct symmetry.\n**Verdict: Incorrect.**\n\n**D. Increase $N_{v_\\parallel}$ and $N_\\mu$ adaptively... while keeping $\\Delta \\theta$ fixed...**\nThis option commits the opposite error to option C.\n- **Incomplete Scans**: It completely neglects to test for convergence in the parallel coordinate $\\theta$. The problem explicitly states that microtearing modes feature a narrow current layer around $\\theta \\approx 0$, which demands high parallel resolution. Ignoring the $\\Delta \\theta$ scan is a fatal flaw. This is especially true since the physics involves the competition between parallel streaming ($v_\\parallel \\partial_\\theta$) and collisions, making resolution in both velocity and configuration space essential.\n- **Fallacious Assumption**: The assumption that parallel resolution is not important is in direct contradiction to both the problem description and the known physics of microtearing modes.\n- **Loose Tolerance**: An energy balance tolerance of $10\\%$ is far too lenient and would permit a solution that is not well-converged or physically consistent.\n**Verdict: Incorrect.**\n\nIn summary, Option A is the only plan that describes a complete, systematic, and physically grounded verification procedure consistent with the standards of computational science. It correctly addresses the resolution requirements in all relevant dimensions ($\\theta$, $v_\\parallel$, $\\mu$) and includes the necessary quantitative and physics-based checks.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Linear simulations tell us whether a mode is unstable and how fast it grows, but they cannot predict the final amplitude of the turbulence. To bridge this gap, we turn to nonlinear theory, and one of the most powerful conceptual tools is the mixing-length estimate. This problem  guides you through a derivation to connect the linear growth rate to the saturated magnetic fluctuation level, providing a practical estimate for the nonlinear outcome of the instability.",
            "id": "4200697",
            "problem": "Consider a simplified model of saturated microtearing-mode turbulence in a magnetized fusion plasma. In this model, saturation is assumed to occur when the nonlinear decorrelation rate arising from magnetic shearing balances the net linear drive. Starting from first principles appropriate to magnetized plasma dynamics, derive an expression for the saturated magnetic fluctuation level $\\langle |\\delta B|^2 \\rangle$ in terms of the background magnetic field $B_0$, the ion mass $m_i$, the ion number density $n_i$, the perpendicular wavenumber $k_\\perp$, the linear growth rate $\\gamma_{\\mathrm{lin}}$, and a set of linear damping rates $\\{\\gamma_{d,j}\\}$. Use the following foundations:\n- The definition of the Alfvén speed $v_A = \\dfrac{B_0}{\\sqrt{\\mu_0 \\rho}}$ with mass density $\\rho = n_i m_i$ and vacuum magnetic permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$.\n- The mixing-length hypothesis that at saturation the nonlinear decorrelation rate produced by magnetic shearing is of the same order as the net linear drive, and may be estimated using the characteristic perpendicular scale $k_\\perp$ and the Alfvénic response to magnetic perturbations.\n- Treat the net linear drive as $\\gamma_{\\mathrm{net}} = \\gamma_{\\mathrm{lin}} - \\sum_j \\gamma_{d,j}$, and impose physical consistency by setting $\\langle |\\delta B|^2 \\rangle = 0$ whenever $\\gamma_{\\mathrm{net}} \\le 0$.\n\nExpress the final result for $\\langle |\\delta B|^2 \\rangle$ in Tesla squared (T$^2$). Assume a dimensionless order-unity mixing-length constant $C_{\\mathrm{ml}} = 1$.\n\nYour task is to implement a program that computes $\\langle |\\delta B|^2 \\rangle$ for each of the following test cases. In every case, interpret all rates as in $\\mathrm{s}^{-1}$, all wavenumbers as in $\\mathrm{m}^{-1}$, number densities as in $\\mathrm{m}^{-3}$, masses as in $\\mathrm{kg}$, and magnetic fields as in Tesla (T). The answers must be floats representing $\\langle |\\delta B|^2 \\rangle$ in T$^2$.\n\nTest suite (each case listed as $(B_0, n_i, m_i, k_\\perp, \\gamma_{\\mathrm{lin}}, [\\gamma_{d,1}, \\gamma_{d,2}, \\ldots])$):\n1. $(2.5, 1.0\\times 10^{20}, 3.344\\times 10^{-27}, 150, 6.0\\times 10^{4}, [2.0\\times 10^{4}, 1.5\\times 10^{4}, 0.5\\times 10^{4}])$ a typical positive-drive case.\n2. $(3.0, 8.0\\times 10^{19}, 3.344\\times 10^{-27}, 200, 3.5\\times 10^{4}, [2.0\\times 10^{4}, 1.5\\times 10^{4}])$ a boundary case with zero net drive.\n3. $(2.0, 1.2\\times 10^{20}, 3.344\\times 10^{-27}, 100, 2.0\\times 10^{4}, [3.0\\times 10^{4}])$ a stable case with negative net drive.\n4. $(5.0, 3.0\\times 10^{19}, 3.344\\times 10^{-27}, 400, 8.0\\times 10^{4}, [1.0\\times 10^{4}])$ a case with strong field and low density leading to large Alfvén speed.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each entry is the computed $\\langle |\\delta B|^2 \\rangle$ in T$^2$ for the corresponding test case, following the rule that if $\\gamma_{\\mathrm{net}} \\le 0$ then the result is $0.0$.",
            "solution": "The problem requires the derivation of an expression for the saturated magnetic fluctuation level, denoted as $\\langle |\\delta B|^2 \\rangle$, in a simplified model of microtearing-mode turbulence. The derivation must proceed from first principles as outlined in the problem statement.\n\nFirst, we establish the fundamental condition for saturation in this model. The mixing-length hypothesis posits that saturation occurs when the nonlinear decorrelation rate, $\\gamma_{\\mathrm{NL}}$, becomes comparable to the net linear growth rate of the instability, $\\gamma_{\\mathrm{net}}$. We can write this as an order-of-magnitude balance:\n$$ \\gamma_{\\mathrm{NL}} \\approx \\gamma_{\\mathrm{net}} $$\nThe problem provides a formal definition for the net linear drive:\n$$ \\gamma_{\\mathrm{net}} = \\gamma_{\\mathrm{lin}} - \\sum_j \\gamma_{d,j} $$\nwhere $\\gamma_{\\mathrm{lin}}$ is the linear growth rate and $\\{\\gamma_{d,j}\\}$ is the set of all linear damping rates. A crucial physical constraint is that if $\\gamma_{\\mathrm{net}} \\le 0$, the mode is stable or marginally stable, and thus no turbulence develops. In this case, the saturated fluctuation amplitude must be zero:\n$$ \\langle |\\delta B|^2 \\rangle = 0 \\quad \\text{if} \\quad \\gamma_{\\mathrm{net}} \\le 0 $$\nFor the unstable case where $\\gamma_{\\mathrm{net}} > 0$, we must construct a model for the nonlinear decorrelation rate, $\\gamma_{\\mathrm{NL}}$. The problem specifies that this rate arises from magnetic shearing and should be estimated using the characteristic perpendicular wavenumber, $k_\\perp$, and the Alfvénic response to magnetic perturbations.\n\nThe nonlinear decorrelation mechanism is the shearing of turbulent eddies by the perturbed magnetic field lines. The magnetic field lines are stochastically \"bent\" by the magnetic fluctuations $\\delta B$ themselves. A particle or wave packet propagating along the mean magnetic field $\\mathbf{B}_0$ will experience an effective parallel dynamic that is modified by the perpendicular component of the fluctuation, $\\delta \\mathbf{B}_\\perp$. The effective parallel wavenumber of the turbulence, $k_{\\parallel, \\text{NL}}$, which characterizes the gradient along the total, perturbed magnetic field, can be estimated as the product of the perpendicular wavenumber $k_\\perp$ and the angle of the field-line tilt, which is approximately $|\\delta B|/B_0$.\n$$ k_{\\parallel, \\text{NL}} \\sim k_\\perp \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} $$\nHere, we use the root-mean-square (RMS) fluctuation amplitude $\\sqrt{\\langle |\\delta B|^2 \\rangle}$ as the characteristic magnitude.\n\nThe characteristic frequency, or rate, associated with dynamics along these perturbed field lines is set by the propagation speed of the relevant wave, which for magnetic perturbations is the Alfvén speed, $v_A$. The nonlinear decorrelation rate can thus be estimated as the product of this effective parallel wavenumber and the Alfvén speed.\n$$ \\gamma_{\\mathrm{NL}} \\sim k_{\\parallel, \\text{NL}} v_A \\sim k_\\perp v_A \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} $$\nIntroducing the dimensionless order-unity mixing-length constant, $C_{\\mathrm{ml}}$, we formalize this relationship as:\n$$ \\gamma_{\\mathrm{NL}} = C_{\\mathrm{ml}} k_\\perp v_A \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} $$\nThe problem specifies $C_{\\mathrm{ml}} = 1$.\n\nNow, we enforce the saturation condition by equating the nonlinear rate with the net linear drive, for $\\gamma_{\\mathrm{net}} > 0$:\n$$ C_{\\mathrm{ml}} k_\\perp v_A \\frac{\\sqrt{\\langle |\\delta B|^2 \\rangle}}{B_0} = \\gamma_{\\mathrm{net}} $$\nSolving for the RMS magnetic fluctuation amplitude $\\sqrt{\\langle |\\delta B|^2 \\rangle}$:\n$$ \\sqrt{\\langle |\\delta B|^2 \\rangle} = \\frac{\\gamma_{\\mathrm{net}} B_0}{C_{\\mathrm{ml}} k_\\perp v_A} $$\nSquaring both sides gives the desired quantity, the mean-squared magnetic fluctuation level:\n$$ \\langle |\\delta B|^2 \\rangle = \\left(\\frac{\\gamma_{\\mathrm{net}} B_0}{C_{\\mathrm{ml}} k_\\perp v_A}\\right)^2 $$\nThe problem provides the definition of the Alfvén speed, $v_A$:\n$$ v_A = \\frac{B_0}{\\sqrt{\\mu_0 \\rho}} $$\nwhere the mass density $\\rho$ is given by $\\rho = n_i m_i$, and $\\mu_0$ is the vacuum magnetic permeability. Substituting the expression for $\\rho$:\n$$ v_A = \\frac{B_0}{\\sqrt{\\mu_0 n_i m_i}} $$\nWe can now substitute this expression for $v_A$ into our equation for $\\langle |\\delta B|^2 \\rangle$:\n$$ \\langle |\\delta B|^2 \\rangle = \\left(\\frac{\\gamma_{\\mathrm{net}} B_0}{C_{\\mathrm{ml}} k_\\perp \\left(\\frac{B_0}{\\sqrt{\\mu_0 n_i m_i}}\\right)}\\right)^2 $$\nThe background magnetic field strength, $B_0$, cancels out from the expression:\n$$ \\langle |\\delta B|^2 \\rangle = \\left(\\frac{\\gamma_{\\mathrm{net}} \\sqrt{\\mu_0 n_i m_i}}{C_{\\mathrm{ml}} k_\\perp}\\right)^2 $$\nThis simplifies to our final analytical result. Setting $C_{\\mathrm{ml}}=1$ as specified:\n$$ \\langle |\\delta B|^2 \\rangle = \\frac{\\gamma_{\\mathrm{net}}^2 \\mu_0 n_i m_i}{k_\\perp^2} $$\nCombining this with the condition for stability, the complete expression is:\n$$ \\langle |\\delta B|^2 \\rangle = \\begin{cases} \\dfrac{(\\gamma_{\\mathrm{lin}} - \\sum_j \\gamma_{d,j})^2 \\mu_0 n_i m_i}{k_\\perp^2} & \\text{if } \\gamma_{\\mathrm{lin}} > \\sum_j \\gamma_{d,j} \\\\ 0 & \\text{if } \\gamma_{\\mathrm{lin}} \\le \\sum_j \\gamma_{d,j} \\end{cases} $$\nThis expression will be used to compute the numerical results for the provided test cases. All inputs are given in SI units, and the result for $\\langle |\\delta B|^2 \\rangle$ will be in Tesla squared (T$^2$). The value of the vacuum permeability is $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the saturated magnetic fluctuation level for microtearing-mode turbulence\n    based on a simplified mixing-length model.\n    \"\"\"\n    # Define the fundamental constant: vacuum magnetic permeability in N/A^2 (or H/m)\n    MU_0 = 4 * np.pi * 1e-7\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (B0, ni, mi, k_perp, gamma_lin, list_of_gamma_d)\n    # Units: B0 (T), ni (m^-3), mi (kg), k_perp (m^-1), all rates (s^-1)\n    test_cases = [\n        # Case 1: typical positive-drive case\n        (2.5, 1.0e20, 3.344e-27, 150, 6.0e4, [2.0e4, 1.5e4, 0.5e4]),\n        # Case 2: boundary case with zero net drive\n        (3.0, 8.0e19, 3.344e-27, 200, 3.5e4, [2.0e4, 1.5e4]),\n        # Case 3: stable case with negative net drive\n        (2.0, 1.2e20, 3.344e-27, 100, 2.0e4, [3.0e4]),\n        # Case 4: case with strong field and low density\n        (5.0, 3.0e19, 3.344e-27, 400, 8.0e4, [1.0e4]),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case. Note: B0 is not needed in the final formula\n        # but is kept for clarity relative to the problem definition.\n        _B0, ni, mi, k_perp, gamma_lin, gamma_d_list = case\n\n        # Calculate the sum of all linear damping rates\n        sum_gamma_d = sum(gamma_d_list)\n\n        # Calculate the net linear drive\n        gamma_net = gamma_lin - sum_gamma_d\n\n        # Apply the physical consistency condition:\n        # If the net drive is zero or negative, the mode is stable and fluctuation level is zero.\n        if gamma_net <= 0:\n            saturated_B_sq = 0.0\n        else:\n            # The derived expression for the saturated mean-squared magnetic fluctuation level:\n            # <|delta B|^2> = (gamma_net^2 * mu_0 * ni * mi) / (k_perp^2)\n            numerator = (gamma_net**2) * MU_0 * ni * mi\n            denominator = k_perp**2\n            saturated_B_sq = numerator / denominator\n        \n        results.append(saturated_B_sq)\n\n    # Format the results into the required output string: \"[result1,result2,result3,result4]\"\n    # Using a general format specifier 'g' to handle floating point representation cleanly.\n    output_string = f\"[{','.join(f'{r:g}' for r in results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}