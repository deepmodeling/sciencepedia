{
    "hands_on_practices": [
        {
            "introduction": "在托卡马克等环形磁约束装置中，由磁场曲率和梯度引起的粒子漂移是驱动离子温度梯度（ITG）等漂移波不稳定性的关键物理机制。第一个动手实践  要求你从基本物理原理出发，推导并计算热离子的梯度-$B$漂移速度。这项练习旨在揭示一个看似矛盾但至关重要的结果：在固定离子温度下，该漂移速度与离子质量无关，从而引导我们思考同位素效应更深层次的来源。",
            "id": "4193410",
            "problem": "考虑一个大半径为$R$的轴对称、大环径比托卡马克，其磁场强度$B(R)$在离子回旋轨道尺度上变化缓慢，使得局部满足$|\\nabla B| \\approx B/R$。一种单电荷离子（电荷$q_i = +e$）在这种非均匀磁场中运动。使用导心理论，从洛伦兹力$\\mathbf{F} = q_i \\mathbf{v} \\times \\mathbf{B}$以及磁矩$\\mu = \\frac{m_i v_{\\perp}^{2}}{2B}$的绝热不变量出发，推导在大环径比极限下，具有垂直速度$v_{\\perp}$的离子的梯度B漂移速度大小$v_{\\nabla B,i}$的表达式。然后，将离子视为具有垂直温度$T_i$的热离子，并采用麦克斯韦垂直平均$\\langle v_{\\perp}^{2}\\rangle = \\frac{2 k_B T_i}{m_i}$，其中$k_B$是玻尔兹曼常数，$m_i$是离子质量。明确展示任何离子质量依赖关系是如何引入并化简的。\n\n利用推导出的表达式，计算在离子温度$T_i = 10~\\text{keV}$、磁场$B = 5~\\text{T}$、大半径$R = 3~\\text{m}$的托卡马克中，三种同位素的热梯度B漂移速度。计算氢（$\\text{H}$）、氘（$\\text{D}$）和氚（$\\text{T}$）的$v_{\\nabla B,i}$，并将你的三个数值结果以$(\\text{H},\\text{D},\\text{T})$的顺序列为单行矩阵。最终速度以米/秒为单位表示，并将结果四舍五入到四位有效数字。\n\n最后，比较$\\text{H}$、$\\text{D}$和$\\text{T}$的速度大小，并在漂移波和离子温度梯度（ITG）模的聚变等离子体湍流模拟框架内，定性解释即使在固定$T_i$下所有同位素的热梯度B漂移速度相同，同位素质量为何仍能改变波-粒子共振条件。",
            "solution": "该问题经评估有效，因为它在科学上基于既定的等离子体物理原理，问题提出得当，有清晰的路径可得到唯一解，并且陈述规范，没有歧义或矛盾。\n\n我们首先推导梯度B漂移速度大小$v_{\\nabla B,i}$的表达式。带电粒子在缓慢变化的磁场中的运动可以近似为其导心的运动。由磁场强度梯度引起的作用于粒子导心的力由下式给出：\n$$\n\\mathbf{F}_{\\nabla B} = -\\mu \\nabla B\n$$\n其中$\\mu = \\frac{m_i v_{\\perp}^{2}}{2B}$是离子的磁矩，它是一个绝热不变量。这里，$m_i$是离子质量，$v_{\\perp}$是离子速度垂直于磁场$\\mathbf{B}$的分量，$B=|\\mathbf{B}|$。\n\n由力引起的漂移速度$\\mathbf{v}_F$的一般表达式为：\n$$\n\\mathbf{v}_F = \\frac{\\mathbf{F} \\times \\mathbf{B}}{q_i B^2}\n$$\n将梯度B力$\\mathbf{F}_{\\nabla B}$代入$\\mathbf{F}$，我们得到梯度B漂移速度$\\mathbf{v}_{\\nabla B,i}$：\n$$\n\\mathbf{v}_{\\nabla B,i} = \\frac{-\\mu \\nabla B \\times \\mathbf{B}}{q_i B^2}\n$$\n现在，我们代入磁矩$\\mu$的表达式：\n$$\n\\mathbf{v}_{\\nabla B,i} = -\\frac{m_i v_{\\perp}^2}{2B} \\frac{\\nabla B \\times \\mathbf{B}}{q_i B^2} = -\\frac{m_i v_{\\perp}^2}{2q_i B^3} (\\nabla B \\times \\mathbf{B})\n$$\n问题要求的是这个漂移的大小，$v_{\\nabla B,i} = |\\mathbf{v}_{\\nabla B,i}|$。在指定的大环径比托卡马克几何构型中，磁场主要是环向的，其强度随大半径$R$的增加而减小。因此，梯度$\\nabla B$指向径向内侧，垂直于环向磁场$\\mathbf{B}$。于是，$|\\nabla B \\times \\mathbf{B}| = |\\nabla B| |\\mathbf{B}| \\sin(90^\\circ) = |\\nabla B| B$。问题陈述中说明我们可以近似认为$|\\nabla B| \\approx B/R$。\n将此代入大小表达式中得到：\n$$\nv_{\\nabla B,i} = \\left|-\\frac{m_i v_{\\perp}^2}{2q_i B^3}\\right| |\\nabla B \\times \\mathbf{B}| = \\frac{m_i v_{\\perp}^2}{2|q_i| B^3} (|\\nabla B| B) \\approx \\frac{m_i v_{\\perp}^2}{2|q_i| B^3} \\left(\\frac{B}{R}\\right) B = \\frac{m_i v_{\\perp}^2}{2|q_i| B R}\n$$\n这个表达式表明，对于单个离子，其漂移速度取决于其质量$m_i$和垂直动能。\n\n接下来，我们计算这个漂移速度的热平均值。给定麦克斯韦垂直平均为$\\langle v_{\\perp}^2 \\rangle = \\frac{2k_B T_i}{m_i}$，其中$T_i$是离子温度，$k_B$是玻尔兹曼常数。热梯度B漂移速度（我们记作$V_{\\nabla B,i}^{\\text{th}}$）可通过将$v_{\\perp}^2$替换为其平均值$\\langle v_{\\perp}^2 \\rangle$来获得：\n$$\nV_{\\nabla B,i}^{\\text{th}} = \\frac{m_i \\langle v_{\\perp}^2 \\rangle}{2|q_i| B R}\n$$\n代入$\\langle v_{\\perp}^2 \\rangle$的表达式：\n$$\nV_{\\nabla B,i}^{\\text{th}} = \\frac{m_i}{2|q_i| B R} \\left(\\frac{2 k_B T_i}{m_i}\\right)\n$$\n如明确显示的，离子质量$m_i$从分子和分母中消去。这得到了热梯度B漂移速度的最终表达式，它与离子质量无关：\n$$\nV_{\\nabla B,i}^{\\text{th}} = \\frac{k_B T_i}{|q_i| B R}\n$$\n鉴于所有同位素（氢、氘、氚）都是单电荷的，即$|q_i|=e$，其中$e$是元电荷。因此，在固定的离子温度$T_i$下，这三种同位素的热漂移速度是相同的。\n\n现在，我们使用给定的数据计算这个速度的数值：$T_i = 10~\\text{keV}$，$B = 5~\\text{T}$，$R = 3~\\text{m}$。\n量$k_B T_i$代表热能，给定为$10~\\text{keV}$。我们可以将其写作$10^4~\\text{eV}$。\n漂移速度为：\n$$\nV_{\\nabla B,i}^{\\text{th}} = \\frac{k_B T_i}{e B R} = \\frac{10^4~\\text{eV}}{e \\cdot (5~\\text{T}) \\cdot (3~\\text{m})}\n$$\n由于$1~\\text{eV}$是电荷为$e$的粒子通过$1~\\text{V}$电势差所获得的能量，因此项$\\text{eV}/e$的单位是伏特（或焦耳/库仑）。$e$的数值被消去，从而简化了计算：\n$$\nV_{\\nabla B,i}^{\\text{th}} = \\frac{10000}{5 \\times 3} \\frac{\\text{V}}{\\text{T} \\cdot \\text{m}} = \\frac{10000}{15}~\\text{m/s} = \\frac{2000}{3}~\\text{m/s} \\approx 666.666...~\\text{m/s}\n$$\n四舍五入到四位有效数字，我们得到$666.7~\\text{m/s}$。\n由于在固定温度下，热梯度B漂移速度与质量无关，所以对于氢（H）、氘（D）和氚（T），该值是相同的。\n\n最后，我们回答定性问题。尽管在固定温度$T_i$下，磁漂移速度（包括梯度B漂移和曲率漂移）的热平均值与离子质量无关，但同位素质量仍然深刻影响湍流中的波-粒子共振条件。这是因为共振取决于粒子的完整轨道动力学，而不仅仅是它们的平均漂移。\n\n关键在于离子运动的其他特征频率，这些频率确实依赖于质量。离子热速度为$v_{ti} = \\sqrt{2k_B T_i / m_i}$，其标度关系为$v_{ti} \\propto 1/\\sqrt{m_i}$。\n对于通行（非捕获）粒子，其穿行频率（即它们绕环面循环运动的频率）为$\\omega_t \\approx v_{\\parallel}/(qR) \\sim v_{ti}/R \\propto 1/\\sqrt{m_i}$，其中$q$是安全因子。\n对于捕获粒子，其弹跳频率（即它们在磁镜点之间振荡的频率）为$\\omega_b \\approx v_{ti}\\sqrt{\\epsilon}/R \\propto 1/\\sqrt{m_i}$，其中$\\epsilon = r/R$是反环径比。\n\n波-粒子共振控制着驱动或阻尼离子温度梯度（ITG）模等不稳定性的能量交换，当波频$\\omega$与粒子特征频率的某种组合相匹配时发生。例如，一个广义共振条件可以写成：\n$$\n\\omega - \\omega_D - p \\omega_b \\approx 0 \\quad (\\text{对于捕获粒子})\n$$\n或\n$$\n\\omega - k_{\\parallel}v_{\\parallel} - \\omega_D \\approx 0 \\quad (\\text{对于通行粒子})\n$$\n这里，$\\omega_D = \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_D$是磁漂移频率，$p$是整数，$k_{\\parallel}$是平行波数。虽然$\\omega_D$的平均值与质量无关，但弹跳频率$\\omega_b$和穿行项$k_{\\parallel}v_{\\parallel}$（与$\\omega_t$相关）都强烈依赖于质量。\n\n因此，将同位素质量从H变为D再到T会改变共振条件。一个给定频率$\\omega$的波将与每种同位素速度分布的不同部分发生共振。这通过改变不稳定效应（如来自$\\omega_D$的驱动）和稳定效应（如来自$k_{\\parallel}v_{\\parallel}$项的朗道阻尼）之间的平衡，来改变不稳定性的线性增长率。这种对底层线性物理的改变是在聚变实验中观察到的“同位素效应”的主要原因之一，在这些实验中，含有较重离子（如氘或氚）的等离子体通常表现出比含有较轻离子（氢）的等离子体更好的能量约束。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6.667 \\times 10^{2}  & 6.667 \\times 10^{2}  & 6.667 \\times 10^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了单粒子运动，等离子体中的集体行为，尤其是碰撞过程，也对湍流输运有重要影响。例如，带状流（zonal flow）的剪切可以有效抑制湍流，而其自身的演化则受到新经典阻尼的制约。这项实践  将带你深入分析碰撞物理，推导离子黏滞性和新经典阻尼率如何依赖于离子质量。通过这个练习，你将发现这些过程对离子质量表现出明确而强烈的依赖关系，为理解同位素效应提供了另一块关键拼图。",
            "id": "4193424",
            "problem": "考虑一个磁约束聚变等离子体，其中同位素的变化只改变离子质量 $m_i$，而离子密度 $n_i$、离子温度 $T_i$、电荷态 $Z$、库仑对数 $\\ln\\Lambda$ 和流动尺度（由单一径向波数 $k$ 表征）保持不变。在由 Braginskii 理论描述的碰撞流体极限下，动态离子黏度满足量级关系 $\\mu_i \\propto n_i T_i \\tau_i$，其中离子-离子碰撞时间的标度关系为 $\\tau_i \\propto \\frac{T_i^{3/2}}{n_i Z^4 \\ln\\Lambda \\sqrt{m_i}}$。\n\n假设一个径向变化的、磁通面平均的电场叉磁场（E$\\times$B）带状流的新经典阻尼可以被建模为动量的黏性扩散，这是通过使用黏性应力张量对离子动量方程进行线性化，并忽略外力、非线性平流和可压缩性得到的。对于径向依赖关系为 $\\cos(k x)$ 的单模流动 $u(x,t)$，在黏性作用下，阻尼率 $\\gamma_{\\mathrm{nc}}$ 由 $u(x,t) \\propto \\exp(-\\gamma_{\\mathrm{nc}} t)$ 定义。\n\n从上述基本关系和假设出发，仅使用基于离子动量平衡和碰撞输运理论的第一性原理推导，确定动态离子黏度 $\\mu_i$ 和新经典阻尼率 $\\gamma_{\\mathrm{nc}}$ 如何随离子质量 $m_i$ 标度变化。将 $n_i$、$T_i$、$Z$、$\\ln\\Lambda$ 和 $k$ 视为与 $m_i$ 无关的常数，并将最终结果表示为仅含 $m_i$ 的简化幂律形式。将你的最终答案以一个双元素行矩阵的形式给出，其第一个元素是 $\\mu_i$ 的 $m_i$ 标度关系，第二个元素是 $\\gamma_{\\mathrm{nc}}$ 的 $m_i$ 标度关系。不需要进行数值计算，最终的方框表达式中不应包含任何单位。",
            "solution": "目标是从基本的碰撞输运和线性动量扩散论证中推导出动态离子黏度 $\\mu_i$ 和新经典阻尼率 $\\gamma_{\\mathrm{nc}}$ 对同位素质量的依赖关系。\n\n我们从碰撞磁化等离子体流体理论中使用的、经过充分检验的既定关系式开始：\n\n1. 动态离子黏度的 Braginskii 标度关系为\n$$\n\\mu_i \\propto n_i T_i \\tau_i,\n$$\n其中 $\\tau_i$ 是离子-离子碰撞时间。\n\n2. 离子的库仑碰撞时间标度为\n$$\n\\tau_i \\propto \\frac{T_i^{3/2}}{n_i Z^4 \\ln\\Lambda \\sqrt{m_i}}.\n$$\n该标度关系源于二体库仑碰撞理论：$\\tau_i \\sim \\nu_{ii}^{-1}$，其中 $\\nu_{ii}$ 与 $n_i Z^4 \\ln\\Lambda / (T_i^{3/2})$ 成正比，并乘以 $\\sqrt{m_i}$，这是因为热速度 $v_{ti} \\propto \\sqrt{T_i/m_i}$ 进入了碰撞频率中的相对速度；因此 $\\tau_i \\propto T_i^{3/2}/(n_i Z^4 \\ln\\Lambda \\sqrt{m_i})$。\n\n据此，我们通过代入法确定 $\\mu_i$ 的质量标度关系：\n$$\n\\mu_i \\propto n_i T_i \\tau_i \\propto n_i T_i \\left( \\frac{T_i^{3/2}}{n_i Z^4 \\ln\\Lambda \\sqrt{m_i}} \\right) = \\frac{T_i^{5/2}}{Z^4 \\ln\\Lambda}\\, m_i^{-1/2}.\n$$\n保持 $T_i$、$Z$ 和 $\\ln\\Lambda$ 不变，因此对离子质量的依赖关系为\n$$\n\\mu_i \\propto m_i^{-1/2}.\n$$\n\n接下来，我们推导被建模为黏性扩散的带状流的新经典阻尼率。从离子动量方程出发（为研究剪切流的线性阻尼，仅保留黏性应力和惯性项，忽略压力梯度、外力和非线性平流）：\n$$\nn_i m_i \\frac{\\partial \\mathbf{u}}{\\partial t} = \\mu_i \\nabla^2 \\mathbf{u},\n$$\n其中 $\\mathbf{u}$ 是离子流速，$\\mu_i$ 是对应于碰撞动量输运的动态黏度。考虑一个随 $\\cos(k x)$ 变化的单模不可压缩剪切流 $u(x,t)$，使得 $\\nabla^2 u = -k^2 u$。寻找一个衰减解 $u(x,t) \\propto \\exp(-\\gamma_{\\mathrm{nc}} t)$ 可得\n$$\nn_i m_i \\left( -\\gamma_{\\mathrm{nc}} \\right) u = \\mu_i \\left(-k^2\\right) u,\n$$\n由此得到线性阻尼率\n$$\n\\gamma_{\\mathrm{nc}} = \\frac{\\mu_i k^2}{n_i m_i}.\n$$\n这个结果是动量黏性扩散的一个标准结果：运动黏度为 $\\nu_{i} \\equiv \\frac{\\mu_i}{n_i m_i}$，波数为 $k$ 的傅里叶模的衰减率为 $\\nu_{i} k^2$。\n\n我们关注同位素质量的标度关系，同时保持所有其他量（$n_i$、$T_i$、$Z$、$\\ln\\Lambda$、$k$）不变：\n$$\n\\gamma_{\\mathrm{nc}} \\propto \\frac{\\mu_i}{m_i} \\propto \\frac{m_i^{-1/2}}{m_i} = m_i^{-3/2}.\n$$\n\n汇总结果，质量标度关系为：\n- 动态离子黏度：$\\mu_i \\propto m_i^{-1/2}$。\n- 新经典黏性阻尼率：$\\gamma_{\\mathrm{nc}} \\propto m_i^{-3/2}$。\n\n这些标度关系反映出，较重同位素的碰撞时间仅通过分母中的 $\\sqrt{m_i}$ 因子而变长，这导致黏度降低；而阻尼率进一步除以离子惯量 $n_i m_i$，引入了一个额外的 $m_i^{-1}$ 因子。因此，在固定的热力学参数和几何构型下，剪切流的黏性新经典阻尼随离子质量的增加而迅速减弱。",
            "answer": "$$\\boxed{\\begin{pmatrix} m_i^{-1/2}  & m_i^{-3/2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "现代聚变等离子体物理研究高度依赖于大规模数值模拟。为了从复杂的模拟结果中提炼出普适的物理规律，研究者们常常构建降维模型。最后的这项实践  旨在搭建理论与前沿研究之间的桥梁，为你提供一个分析模拟数据的实战任务。你将利用回归分析方法，基于给定的模拟输出，构建一个描述湍流热输运如何依赖于离子质量和背景流剪切的降维模型，这正是聚变研究中的一项典型工作。",
            "id": "4193466",
            "problem": "给定来自非线性聚变等离子体湍流模拟的合成输出，这些模拟通过扫描离子同位素质量来评估同位素质量对湍流热输运的影响。您的目标是构建一个降阶回归模型，通过将归一化扩散系数对质量的平方根以及平衡流剪切率与线性不稳定性增长率之比进行回归，从而解耦回旋玻姆（gyro-Bohm）标度和剪切抑制。\n\n假设存在单一离子种类，其电荷数 $Z=1$，并具有固定的离子温度 $T_i$、磁场 $B$ 和湍流外尺度 $L$。使用以下经过充分检验的定义作为归一化基准：\n\n- 离子热速度 $v_{\\mathrm{th},i} = \\sqrt{\\frac{2 T_i}{m_i}}$，其中 $T_i$ 是以焦耳为单位的每个粒子的离子温度。\n- 离子回旋频率 $\\Omega_i = \\frac{Z e B}{m_i}$，其中 $e$ 是基本电荷，$B$ 是磁场强度。\n- 离子回旋半径 $\\rho_i = \\frac{v_{\\mathrm{th},i}}{\\Omega_i}$。\n- 回旋玻姆（gB）参考扩散系数 $\\chi_{\\mathrm{gB},0} = \\frac{\\rho_{i,0}^2 v_{\\mathrm{th},i,0}}{L}$，在参考质量 $m_{\\mathrm{ref}}$ 下计算。\n\n您必须使用在 $m_{\\mathrm{ref}}$ 和给定 $(T_i,B,L)$ 下计算的单一固定 $\\chi_{\\mathrm{gB},0}$ 来归一化测量的扩散系数，而不是使用特定于案例的值，以生成无量纲目标 $\\hat{\\chi}$。定义无量纲回归特征\n- $s = \\sqrt{\\frac{m_i}{m_{\\mathrm{ref}}}}$，\n- $r = \\frac{\\gamma_E}{\\gamma_{\\mathrm{lin}}}$，\n其中 $\\gamma_E$ 是流剪切率，$\\gamma_{\\mathrm{lin}}$ 是线性增长率。拟合一个线性降阶模型\n$\\hat{\\chi} \\approx a_0 + a_1 s + a_2 r + a_3 s r$\n通过使测量得到的归一化 $\\hat{\\chi}$ 与您的模型之间的残差平方和最小化的普通最小二乘法。使用拟合模型，通过将模型预测值 $\\hat{\\chi}$ 乘以 $\\chi_{\\mathrm{gB},0}$，来预测每个测试案例的有量纲扩散系数 $\\chi$（单位为 $\\mathrm{m}^2/\\mathrm{s}$）。\n\n常量和固定参数：\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}$ 库仑。\n- 原子质量单位 $m_u = 1.66053906660 \\times 10^{-27}$ 千克。\n- 参考质量 $m_{\\mathrm{ref}} = m_u$。\n- 电荷数 $Z = 1$。\n- 离子温度 $T_i = 3000$ 电子伏特，在所有计算中需转换为焦耳。\n- 磁场 $B = 3$ 特斯拉。\n- 外尺度 $L = 0.5$ 米。\n\n每个测试案例提供 $(m_i, \\gamma_E, \\gamma_{\\mathrm{lin}}, \\chi_{\\mathrm{meas}})$，其中 $m_i$ 是以千克为单位的离子质量，$\\gamma_E$ 和 $\\gamma_{\\mathrm{lin}}$ 的单位是 $\\mathrm{s}^{-1}$，$\\chi_{\\mathrm{meas}}$ 是以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位的测量湍流扩散系数。仅使用所提供的数据；不要虚构额外的数据。\n\n待处理的测试套件是：\n\n- 案例 $1$：$m_i = 1 \\times m_u$，$\\gamma_E = 0$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 10.622$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $2$：$m_i = 2 \\times m_u$，$\\gamma_E = 0$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 13.843$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $3$：$m_i = 3 \\times m_u$，$\\gamma_E = 0$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 16.897$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $4$：$m_i = 1 \\times m_u$，$\\gamma_E = 0.5 \\times 10^5$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 6.258$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $5$：$m_i = 2 \\times m_u$，$\\gamma_E = 0.5 \\times 10^5$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 9.075$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $6$：$m_i = 3 \\times m_u$，$\\gamma_E = 1.0 \\times 10^5$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 5.079$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $7$：$m_i = 1 \\times m_u$，$\\gamma_E = 1.0 \\times 10^5$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 2.103$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $8$：$m_i = 2.5 \\times m_u$，$\\gamma_E = 0.3 \\times 10^5$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 12.045$ $\\mathrm{m}^2/\\mathrm{s}$。\n- 案例 $9$：$m_i = 0.5 \\times m_u$，$\\gamma_E = 0.8 \\times 10^5$，$\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^5$，$\\chi_{\\mathrm{meas}} = 2.435$ $\\mathrm{m}^2/\\mathrm{s}$。\n\n边界和边缘覆盖说明：\n- 案例 $1$–$3$ 在递增的 $m_i$ 下测试零剪切极限。\n- 案例 $4$–$7$ 在固定和变化的 $m_i$ 下测试有限剪切，包括强剪切极限 $r = 1$。\n- 案例 $8$ 在中等剪切区域使用非整数质量比来探测插值行为。\n- 案例 $9$ 在高剪切下使用亚参考质量来探测组合抑制和轻质量行为。\n\n您的程序必须：\n- 根据给定的常量和 $(T_i,B,L,m_{\\mathrm{ref}})$ 计算 $\\chi_{\\mathrm{gB},0}$。\n- 用 $\\chi_{\\mathrm{gB},0}$ 归一化提供的 $\\chi_{\\mathrm{meas}}$，以形成 $\\hat{\\chi}$。\n- 使用每个测试案例的 $m_i$ 和 $(\\gamma_E,\\gamma_{\\mathrm{lin}})$，构建列对应于 $\\{1, s, r, s r\\}$ 的设计矩阵。\n- 通过无正则化的最小二乘法求解 $a_0,a_1,a_2,a_3$。\n- 使用拟合的降阶模型预测所有测试案例的有量纲扩散系数，以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位表示。\n- 生成单行输出，其中包含按上述顺序排列的测试案例的预测扩散系数，形式为用方括号括起来的逗号分隔列表。例如，输出应类似于 $[\\chi_1,\\chi_2,\\dots,\\chi_9]$，其中每个 $\\chi_i$ 是一个以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位的浮点数。\n\n此问题不涉及角度。所有报告的扩散系数必须以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位表示为浮点数，除了标准的浮点表示外，没有取整要求。",
            "solution": "该问题是有效的。它是一个定义明确且自包含的数据分析任务，基于聚变等离子体湍流的原理。所有必要的物理常量、参数、定义和实验数据都已提供。其目标是构建并应用一个线性回归模型，这是一个标准且数学上合理的程序。该问题没有科学上的不准确、模糊或矛盾之处。\n\n解决方案分为以下四个主要步骤：\n1.  计算恒定的回旋玻姆参考扩散系数 $\\chi_{\\mathrm{gB},0}$。\n2.  根据提供的测试案例数据，为回归模型准备无量纲特征和目标变量。\n3.  通过普通最小二乘（OLS）回归确定模型系数。\n4.  使用拟合模型预测每个测试案例的有量纲湍流扩散系数。\n\n**步骤1：计算回旋玻姆参考扩散系数 $\\chi_{\\mathrm{gB},0}$**\n\n参考扩散系数 $\\chi_{\\mathrm{gB},0}$ 作为一个归一化常数，使我们能够处理无量纲量。它基于在参考离子质量 $m_{\\mathrm{ref}}$ 下计算的基本等离子体参数来定义。给定的固定参数是：\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}$ C\n- 原子质量单位 $m_u = 1.66053906660 \\times 10^{-27}$ kg\n- 参考质量 $m_{\\mathrm{ref}} = m_u$\n- 离子电荷数 $Z = 1$\n- 离子温度 $T_i = 3000$ eV\n- 磁场强度 $B = 3$ T\n- 湍流外尺度 $L = 0.5$ m\n\n首先，离子温度必须从电子伏特（eV）转换为焦耳（J）：\n$$T_{i, (\\mathrm{J})} = T_{i, (\\mathrm{eV})} \\times e = 3000 \\times (1.602176634 \\times 10^{-19}) \\mathrm{J} = 4.806529902 \\times 10^{-16} \\mathrm{J}$$\n\n接下来，我们使用参考质量 $m_{\\mathrm{ref}}$ 计算参考离子热速度 $v_{\\mathrm{th},i,0}$：\n$$v_{\\mathrm{th},i,0} = \\sqrt{\\frac{2 T_{i, (\\mathrm{J})}}{m_{\\mathrm{ref}}}} = \\sqrt{\\frac{2 \\times (4.806529902 \\times 10^{-16} \\mathrm{J})}{1.66053906660 \\times 10^{-27} \\mathrm{kg}}} \\approx 760921.2 \\mathrm{\\,m/s}$$\n\n然后，我们计算参考离子回旋频率 $\\Omega_{i,0}$：\n$$\\Omega_{i,0} = \\frac{Z e B}{m_{\\mathrm{ref}}} = \\frac{1 \\times (1.602176634 \\times 10^{-19} \\mathrm{C}) \\times (3 \\mathrm{T})}{1.66053906660 \\times 10^{-27} \\mathrm{kg}} \\approx 2.89452 \\times 10^8 \\mathrm{\\,rad/s}$$\n\n使用这些值，参考离子回旋半径 $\\rho_{i,0}$ 为：\n$$\\rho_{i,0} = \\frac{v_{\\mathrm{th},i,0}}{\\Omega_{i,0}} = \\frac{760921.2 \\mathrm{\\,m/s}}{2.89452 \\times 10^8 \\mathrm{\\,rad/s}} \\approx 0.0026289 \\mathrm{\\,m}$$\n\n最后，我们可以计算回旋玻姆参考扩散系数 $\\chi_{\\mathrm{gB},0}$：\n$$\\chi_{\\mathrm{gB},0} = \\frac{\\rho_{i,0}^2 v_{\\mathrm{th},i,0}}{L} = \\frac{(0.0026289 \\mathrm{\\,m})^2 \\times (760921.2 \\mathrm{\\,m/s})}{0.5 \\mathrm{\\,m}} \\approx 10.5186 \\mathrm{\\,m}^2/\\mathrm{s}$$\n该值将用于归一化所有测量的扩散系数。\n\n**步骤2：为回归准备数据**\n\n回归模型为 $\\hat{\\chi} \\approx a_0 + a_1 s + a_2 r + a_3 s r$。我们必须构建设计矩阵 $\\mathbf{X}$ 和目标向量 $\\mathbf{y}$（其中包含归一化的扩散系数 $\\hat{\\chi}$）。\n特征是 $s = \\sqrt{\\frac{m_i}{m_{\\mathrm{ref}}}}$ 和 $r = \\frac{\\gamma_E}{\\gamma_{\\mathrm{lin}}}$。目标是 $\\hat{\\chi} = \\frac{\\chi_{\\mathrm{meas}}}{\\chi_{\\mathrm{gB},0}}$。\n\n让我们处理这9个测试案例：\n1.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 1$, $s = 1.0$。$r = \\frac{0}{10^5} = 0.0$。$\\hat{\\chi}_1 = \\frac{10.622}{10.5186} \\approx 1.010$。\n2.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 2$, $s = \\sqrt{2} \\approx 1.414$。$r = 0.0$。$\\hat{\\chi}_2 = \\frac{13.843}{10.5186} \\approx 1.316$。\n3.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 3$, $s = \\sqrt{3} \\approx 1.732$。$r = 0.0$。$\\hat{\\chi}_3 = \\frac{16.897}{10.5186} \\approx 1.606$。\n4.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 1$, $s = 1.0$。$r = \\frac{0.5 \\times 10^5}{1.0 \\times 10^5} = 0.5$。$\\hat{\\chi}_4 = \\frac{6.258}{10.5186} \\approx 0.595$。\n5.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 2$, $s = \\sqrt{2} \\approx 1.414$。$r = 0.5$。$\\hat{\\chi}_5 = \\frac{9.075}{10.5186} \\approx 0.863$。\n6.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 3$, $s = \\sqrt{3} \\approx 1.732$。$r = \\frac{1.0 \\times 10^5}{1.0 \\times 10^5} = 1.0$。$\\hat{\\chi}_6 = \\frac{5.079}{10.5186} \\approx 0.483$。\n7.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 1$, $s = 1.0$。$r = 1.0$。$\\hat{\\chi}_7 = \\frac{2.103}{10.5186} \\approx 0.200$。\n8.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 2.5$, $s = \\sqrt{2.5} \\approx 1.581$。$r = \\frac{0.3 \\times 10^5}{1.0 \\times 10^5} = 0.3$。$\\hat{\\chi}_8 = \\frac{12.045}{10.5186} \\approx 1.145$。\n9.  $\\frac{m_i}{m_{\\mathrm{ref}}} = 0.5$, $s = \\sqrt{0.5} \\approx 0.707$。$r = \\frac{0.8 \\times 10^5}{1.0 \\times 10^5} = 0.8$。$\\hat{\\chi}_9 = \\frac{2.435}{10.5186} \\approx 0.231$。\n\n设计矩阵 $\\mathbf{X}$ 的每一行形式为 $[1, s, r, sr]$，目标向量 $\\mathbf{y}$ 是 $\\hat{\\chi}$ 值的列向量。\n\n**步骤3：普通最小二乘回归**\n\n我们寻求系数向量 $\\mathbf{a} = [a_0, a_1, a_2, a_3]^T$，它能最小化观测目标 $\\mathbf{y}$ 和模型预测 $\\mathbf{X} \\mathbf{a}$ 之间的平方差之和。解由正规方程给出：\n$$\\mathbf{a} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$$\n此计算使用标准的线性代数库例程（如 `numpy.linalg.lstsq`）进行数值执行。\n\n**步骤4：预测有量纲扩散系数**\n\n一旦确定了系数向量 $\\mathbf{a}$，就可以使用该模型，通过其特征 $(s,r)$ 来预测每个测试案例的归一化扩散系数 $\\hat{\\chi}_{\\mathrm{pred}}$：\n$$\\hat{\\chi}_{\\mathrm{pred},i} = a_0 + a_1 s_i + a_2 r_i + a_3 s_i r_i$$\n这可以通过矩阵-向量乘积 $\\hat{\\boldsymbol{\\chi}}_{\\mathrm{pred}} = \\mathbf{X} \\mathbf{a}$ 对所有案例同时计算。\n\n最后，为了获得单位为 $\\mathrm{m}^2/\\mathrm{s}$ 的有量纲预测值，我们将归一化的预测值乘以参考回旋玻姆扩散系数：\n$$\\chi_{\\mathrm{pred},i} = \\hat{\\chi}_{\\mathrm{pred},i} \\times \\chi_{\\mathrm{gB},0}$$\n得到的一组9个值 $\\{\\chi_{\\mathrm{pred},i}\\}$ 构成了最终答案。下面代码块中的实现将执行这些计算，以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes predicted turbulent diffusivities using a reduced regression model.\n    \"\"\"\n    # ----------------------------------------------------------------------\n    # Define constants and fixed parameters from the problem statement.\n    # ----------------------------------------------------------------------\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    AMU = 1.66053906660e-27      # Atomic mass unit in kg\n    M_REF = AMU                    # Reference mass in kg\n    Z = 1.0                        # Ion charge number\n    T_I_EV = 3000.0                # Ion temperature in eV\n    B_FIELD = 3.0                  # Magnetic field in Tesla\n    L_SCALE = 0.5                  # Outer scale in meters\n\n    # Convert ion temperature to Joules\n    T_I_J = T_I_EV * E_CHARGE\n\n    # ----------------------------------------------------------------------\n    # Step 1: Calculate the Gyro-Bohm reference diffusivity chi_gB,0\n    # ----------------------------------------------------------------------\n    # Reference thermal speed\n    v_th_i_0 = np.sqrt(2 * T_I_J / M_REF)\n    # Reference cyclotron frequency\n    omega_i_0 = Z * E_CHARGE * B_FIELD / M_REF\n    # Reference gyroradius\n    rho_i_0 = v_th_i_0 / omega_i_0\n    # Gyro-Bohm reference diffusivity\n    chi_gB_0 = (rho_i_0**2 * v_th_i_0) / L_SCALE\n\n    # ----------------------------------------------------------------------\n    # Define the test cases from the problem statement.\n    # (m_i in kg, gamma_E in 1/s, gamma_lin in 1/s, chi_meas in m^2/s)\n    # ----------------------------------------------------------------------\n    test_cases = [\n        # (m_i_factor, gamma_E, gamma_lin, chi_meas)\n        (1.0, 0.0, 1.0e5, 10.622),\n        (2.0, 0.0, 1.0e5, 13.843),\n        (3.0, 0.0, 1.0e5, 16.897),\n        (1.0, 0.5e5, 1.0e5, 6.258),\n        (2.0, 0.5e5, 1.0e5, 9.075),\n        (3.0, 1.0e5, 1.0e5, 5.079),\n        (1.0, 1.0e5, 1.0e5, 2.103),\n        (2.5, 0.3e5, 1.0e5, 12.045),\n        (0.5, 0.8e5, 1.0e5, 2.435),\n    ]\n\n    # ----------------------------------------------------------------------\n    # Step 2: Prepare data for regression (design matrix X and target y)\n    # ----------------------------------------------------------------------\n    num_cases = len(test_cases)\n    # Design matrix X has 4 columns for a_0, a_1, a_2, a_3\n    X = np.zeros((num_cases, 4))\n    # Target vector y\n    y = np.zeros(num_cases)\n\n    for i, case in enumerate(test_cases):\n        m_i_factor, gamma_E, gamma_lin, chi_meas = case\n        \n        # Dimensionless features\n        s = np.sqrt(m_i_factor)  # s = sqrt(m_i / m_ref)\n        r = gamma_E / gamma_lin  # r = gamma_E / gamma_lin\n        \n        # Populate the design matrix (X)\n        X[i, 0] = 1.0  # Intercept for a_0\n        X[i, 1] = s    # Feature for a_1\n        X[i, 2] = r    # Feature for a_2\n        X[i, 3] = s * r# Interaction feature for a_3\n\n        # Populate the normalized target vector (y)\n        y[i] = chi_meas / chi_gB_0\n\n    # ----------------------------------------------------------------------\n    # Step 3: Solve for coefficients using Ordinary Least Squares\n    # ----------------------------------------------------------------------\n    # np.linalg.lstsq solves the equation X @ a = y for the coefficients a\n    coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n    # coeffs is the vector [a_0, a_1, a_2, a_3]\n\n    # ----------------------------------------------------------------------\n    # Step 4: Predict diffusivities using the fitted model\n    # ----------------------------------------------------------------------\n    # Predict the normalized diffusivities\n    chi_hat_pred = X @ coeffs\n    \n    # Convert back to dimensional diffusivities\n    chi_pred = chi_hat_pred * chi_gB_0\n    \n    # ----------------------------------------------------------------------\n    # Format and print the final output as a single line\n    # ----------------------------------------------------------------------\n    results = chi_pred.tolist()\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}