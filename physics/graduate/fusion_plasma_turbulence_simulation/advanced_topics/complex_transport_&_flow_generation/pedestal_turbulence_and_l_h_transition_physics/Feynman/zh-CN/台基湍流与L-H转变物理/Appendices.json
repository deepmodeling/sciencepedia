{
    "hands_on_practices": [
        {
            "introduction": "托卡马克边缘等离子体中的径向电场 $E_r$ 及其剪切是抑制湍流和触发 L-H 转换的关键。该练习将引导您探索离子轨道损失机制，这是产生 $E_r$ 的一个基本物理过程。通过从第一性原理出发，计算因轨道损失而在等离子体中产生的净电流 ()，您将亲身体验单个粒子动力学如何影响宏观电场，并加深对 L-H 转换物理的理解。",
            "id": "4198005",
            "problem": "考虑在低约束到高约束（L-H）转换期间，处于边缘台基区的大环径比、圆形截面托卡马克等离子体。假设系统具有轴对称性，并采用单零点下X点位形，使得$\\nabla B$漂移和曲率漂移优先将平行速度$v_{\\parallel}0$的离子引导至外侧分界面附近的损失区。磁场具有主导的环向分量$B_{\\phi}\\approx B_{0}$和极向场$B_{\\theta}\\approx B_{0} r/(q R)$，其中$q$是安全因子，$R$是主半径，$r$是台基区的局域小半径。\n\n从Lorentz力和导心近似出发，利用磁矩守恒和大环径比几何，估算深陷俘离子轨道的香蕉轨道半宽度$\\Delta_{b}$，用离子拉莫尔半径$\\rho_{i}$、安全因子$q$和反环径比$\\varepsilon=r/R$表示。基于该估算，通过要求$\\Delta_{b}$超过到分界面的给定径向距离$d$，推导出一个离子的局域轨道损失条件，该条件表示为垂直速度$v_{\\perp}$的一个阈值。然后，假设只有$v_{\\parallel}0$且$v_{\\perp}$高于阈值的离子会立即损失，计算在约束等离子体中产生的、改变径向力平衡的净平行电流密度。未受扰动的离子分布是各向同性的麦克斯韦分布，\n$$\nf_{0}(v_{\\parallel},v_{\\perp})=n_{i}\\left(\\frac{m_{i}}{2\\pi k_{B} T_{i}}\\right)^{3/2}\\exp\\!\\left[-\\frac{m_{i}(v_{\\parallel}^{2}+v_{\\perp}^{2})}{2 k_{B} T_{i}}\\right],\n$$\n其中$n_{i}$是离子密度，$T_{i}$是离子温度，$m_{i}$是离子质量，$Z$是电荷态。将损失视为在半空间$\\{v_{\\parallel}0,\\, v_{\\perp}\\ge v_{c}\\}$中对$f_{0}$的瞬时截断，其中$v_{c}$是推导出的阈值，并计算等离子体中剩余的净平行电流密度$j_{\\parallel}$，该密度由剩余分布的速度矩定义。\n\n使用以下代表L-H转换附近台基区的参数：\n- $B_{0}=2.0\\,\\mathrm{T}$，\n- $q=4.0$，\n- $R=1.7\\,\\mathrm{m}$，\n- $r=0.55\\,\\mathrm{m}$，\n- $d=0.01\\,\\mathrm{m}$，\n- $Z=1$，\n- $m_{i}=3.344\\times 10^{-27}\\,\\mathrm{kg}$ (氘核)，\n- $n_{i}=2.0\\times 10^{19}\\,\\mathrm{m}^{-3}$，\n- $T_{i}=1.0\\,\\mathrm{keV}$。\n\n取$k_{B}$为玻尔兹曼常数。以$\\mathrm{A}\\,\\mathrm{m}^{-2}$为单位表示最终的电流密度，并将您的答案四舍五入到三位有效数字。",
            "solution": "首先对问题进行验证，以确保其科学上合理、内容自洽且提法良定。\n\n### 步骤1：提取给定条件\n- **物理模型**：大环径比、圆形截面托卡马克。导心近似，磁矩守恒。\n- **磁场**：环向分量$B_{\\phi}\\approx B_{0}$，极向分量$B_{\\theta}\\approx B_{0} r/(q R)$。\n- **定义**：反环径比$\\varepsilon=r/R$。香蕉轨道半宽度$\\Delta_{b}$。离子拉莫尔半径$\\rho_{i}$。\n- **初始分布**：离子的各向同性麦克斯韦分布，$f_{0}(v_{\\parallel},v_{\\perp})=n_{i}\\left(\\frac{m_{i}}{2\\pi k_{B} T_{i}}\\right)^{3/2}\\exp\\!\\left[-\\frac{m_{i}(v_{\\parallel}^{2}+v_{\\perp}^{2})}{2 k_{B} T_{i}}\\right]$。\n- **损失条件**：如果离子的香蕉轨道半宽度$\\Delta_{b}$超过到分界面的径向距离$d$，则离子会损失。问题指明，这种损失发生在平行速度$v_{\\parallel}0$且垂直速度$v_{\\perp}$高于一个推导出的阈值$v_{c}$的离子上。\n- **任务**：\n    1.  用$\\rho_{i}$、$q$和$\\varepsilon$表示$\\Delta_{b}$的估算值。\n    2.  推导轨道损失条件，作为$v_{\\perp}$的阈值$v_{c}$。\n    3.  计算由离子损失产生的净平行电流密度$j_{\\parallel}$。\n- **参数**：\n    - $B_{0}=2.0\\,\\mathrm{T}$\n    - $q=4.0$\n    - $R=1.7\\,\\mathrm{m}$\n    - $r=0.55\\,\\mathrm{m}$\n    - $d=0.01\\,\\mathrm{m}$\n    - $Z=1$ (离子电荷态数)\n    - $m_{i}=3.344\\times 10^{-27}\\,\\mathrm{kg}$ (氘核质量)\n    - $n_{i}=2.0\\times 10^{19}\\,\\mathrm{m}^{-3}$\n    - $T_{i}=1.0\\,\\mathrm{keV}$\n    - $k_{B}$是玻尔兹曼常数。（注意：$T_i$以能量单位给出，所以$k_B T_i$为$1.0\\,\\mathrm{keV}$）。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题是磁约束聚变背景下动理学等离子体物理学中的一个标准练习题。\n- **科学依据**：该问题基于等离子体物理学的基本原理，包括导心运动、磁场中的守恒定律和动理学理论。香蕉轨道的概念及其在离子损失中的作用是托卡马克中新经典输运理论的基石。\n- **良定性**：该问题陈述清晰，提供了所有必要的物理参数以及明确定义的初始状态和损失机制。一系列任务导向一个唯一的、可量化的答案。\n- **客观性**：该问题使用精确的技术语言，避免了主观或模棱两可的陈述。\n\n该问题是等离子体物理学中一个提法良定、有科学依据的问题，因此是有效的。未发现任何缺陷。\n\n### 步骤3：引言与求解\n该问题需要分三部分解答：首先，求出香蕉轨道半宽度；其次，建立轨道损失条件；第三，计算由此产生的平行电流密度。\n\n**第一部分：香蕉轨道半宽度, $\\Delta_{b}$**\n在大环径比托卡马克近似下，俘获粒子轨道（“香蕉”轨道）的径向宽度可以从环向正则动量守恒推导得出。此推导的一个标准结果是，深陷俘离子的香蕉轨道半宽度$\\Delta_{b}$与其拉莫尔半径$\\rho_{i}$、安全因子$q$和反环径比$\\varepsilon=r/R$相关。其表达式为：\n$$\n\\Delta_{b} \\approx \\frac{q}{\\sqrt{\\varepsilon}} \\rho_{i}\n$$\n离子拉莫尔半径是相对于主磁场$B_0$和离子的垂直速度$v_{\\perp}$定义的：\n$$\n\\rho_{i} = \\frac{m_{i}v_{\\perp}}{Z e B_{0}}\n$$\n其中$Z$是离子电荷态数，$e$是元电荷。\n\n**第二部分：轨道损失条件**\n位于分界面内侧径向距离$d$处的离子，如果其轨道延伸到分界面之外，则会发生损失。我们通过要求香蕉轨道半宽度大于这个距离来近似此条件：\n$$\n\\Delta_{b} > d\n$$\n代入$\\Delta_{b}$和$\\rho_{i}$的表达式：\n$$\n\\frac{q}{\\sqrt{\\varepsilon}} \\left(\\frac{m_{i}v_{\\perp}}{Z e B_{0}}\\right) > d\n$$\n这个不等式定义了离子发生损失所需的最小垂直速度。我们把这个阈值速度定义为$v_{c}$：\n$$\nv_{\\perp} > \\frac{d \\sqrt{\\varepsilon} Z e B_{0}}{q m_{i}} \\equiv v_{c}\n$$\n因此，轨道损失条件为$v_{\\perp} > v_{c}$，其中\n$$\nv_{c} = \\frac{d \\sqrt{\\varepsilon} Z e B_{0}}{q m_{i}}\n$$\n\n**第三部分：净平行电流密度, $j_{\\parallel}$**\n初始离子分布函数$f_{0}$是各向同性的，并且关于$v_{\\parallel}$是偶函数，因此它不携带净平行电流。从速度空间特定区域损失离子会产生不对称性，从而导致净电流。题目说明，$v_{\\parallel}  0$且$v_{\\perp} \\ge v_{c}$的离子会损失。\n净平行电流密度$j_{\\parallel}$是剩余分布函数$f_{rem}$的一阶速度矩：\n$$\nj_{\\parallel} = \\int (Ze v_{\\parallel}) f_{rem}(\\mathbf{v}) d^3\\mathbf{v}\n$$\n由于$v_{\\parallel} f_{0}$在整个速度空间上的积分为零，因此剩余电流等于损失粒子所携带电流的负值：\n$$\nj_{\\parallel} = - \\int_{\\text{loss region}} (Ze v_{\\parallel}) f_{0}(\\mathbf{v}) d^3\\mathbf{v}\n$$\n积分是在速度空间的损失区域上进行的，该区域定义为$\\{v_{\\parallel}  0, v_{\\perp} \\ge v_{c}\\}$。在速度柱坐标$(v_{\\perp}, \\phi_{v}, v_{\\parallel})$中，体积元为$d^3\\mathbf{v} = 2\\pi v_{\\perp} dv_{\\perp} dv_{\\parallel}$。\n$$\nj_{\\parallel} = - Ze \\int_{-\\infty}^{0} dv_{\\parallel} \\int_{v_{c}}^{\\infty} dv_{\\perp} \\, (v_{\\parallel} f_{0}(v_{\\parallel}, v_{\\perp}) 2\\pi v_{\\perp})\n$$\n我们定义离子热速度$v_{th,i} = \\sqrt{2k_{B}T_{i}/m_{i}}$。麦克斯韦分布变为：\n$$\nf_{0}(v_{\\parallel}, v_{\\perp}) = \\frac{n_{i}}{\\pi^{3/2} v_{th,i}^{3}} \\exp\\left(-\\frac{v_{\\parallel}^{2}+v_{\\perp}^{2}}{v_{th,i}^{2}}\\right)\n$$\n将此代入$j_{\\parallel}$的积分式中：\n$$\nj_{\\parallel} = - Ze (2\\pi) \\frac{n_{i}}{\\pi^{3/2} v_{th,i}^{3}} \\left( \\int_{-\\infty}^{0} v_{\\parallel} e^{-v_{\\parallel}^{2}/v_{th,i}^{2}} dv_{\\parallel} \\right) \\left( \\int_{v_{c}}^{\\infty} v_{\\perp} e^{-v_{\\perp}^{2}/v_{th,i}^{2}} dv_{\\perp} \\right)\n$$\n我们计算这两个积分：\n平行速度积分为：\n$$\n\\int_{-\\infty}^{0} v_{\\parallel} e^{-v_{\\parallel}^{2}/v_{th,i}^{2}} dv_{\\parallel} = \\left[ -\\frac{v_{th,i}^{2}}{2} e^{-v_{\\parallel}^{2}/v_{th,i}^{2}} \\right]_{-\\infty}^{0} = -\\frac{v_{th,i}^{2}}{2} (1 - 0) = -\\frac{v_{th,i}^{2}}{2}\n$$\n垂直速度积分为：\n$$\n\\int_{v_{c}}^{\\infty} v_{\\perp} e^{-v_{\\perp}^{2}/v_{th,i}^{2}} dv_{\\perp} = \\left[ -\\frac{v_{th,i}^{2}}{2} e^{-v_{\\perp}^{2}/v_{th,i}^{2}} \\right]_{v_{c}}^{\\infty} = -\\frac{v_{th,i}^{2}}{2} (0 - e^{-v_{c}^{2}/v_{th,i}^{2}}) = \\frac{v_{th,i}^{2}}{2} e^{-v_{c}^{2}/v_{th,i}^{2}}\n$$\n将这些结果代回$j_{\\parallel}$的表达式中：\n$$\nj_{\\parallel} = - Ze \\frac{2 n_{i}}{\\sqrt{\\pi} v_{th,i}^{3}} \\left( -\\frac{v_{th,i}^{2}}{2} \\right) \\left( \\frac{v_{th,i}^{2}}{2} e^{-v_{c}^{2}/v_{th,i}^{2}} \\right) = \\frac{Ze n_{i} v_{th,i}}{2\\sqrt{\\pi}} \\exp\\left(-\\frac{v_{c}^{2}}{v_{th,i}^{2}}\\right)\n$$\n\n**数值计算**\n首先，我们计算必要的参数：\n- 反环径比：$\\varepsilon = r/R = 0.55\\,\\mathrm{m} / 1.7\\,\\mathrm{m} \\approx 0.323529$\n- 离子温度（单位：焦耳）：$k_{B}T_{i} = 1.0\\,\\mathrm{keV} = 1.0 \\times 10^{3} \\times 1.6021766 \\times 10^{-19}\\,\\mathrm{J} = 1.6021766 \\times 10^{-16}\\,\\mathrm{J}$\n- 离子热速度：$v_{th,i} = \\sqrt{\\frac{2 k_{B} T_{i}}{m_{i}}} = \\sqrt{\\frac{2 \\times 1.6021766 \\times 10^{-16}\\,\\mathrm{J}}{3.344 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx 3.0955 \\times 10^{5}\\,\\mathrm{m/s}$\n- 临界垂直速度：\n$$\nv_{c} = \\frac{d \\sqrt{\\varepsilon} Z e B_{0}}{q m_{i}} = \\frac{(0.01\\,\\mathrm{m}) \\sqrt{0.323529} (1) (1.6021766 \\times 10^{-19}\\,\\mathrm{C}) (2.0\\,\\mathrm{T})}{(4.0) (3.344 \\times 10^{-27}\\,\\mathrm{kg})} \\approx 1.3625 \\times 10^{5}\\,\\mathrm{m/s}\n$$\n- 指数函数的自变量：\n$$\n\\frac{v_{c}^{2}}{v_{th,i}^{2}} = \\left(\\frac{1.3625 \\times 10^{5}\\,\\mathrm{m/s}}{3.0955 \\times 10^{5}\\,\\mathrm{m/s}}\\right)^{2} \\approx (0.44015)^{2} \\approx 0.19373\n$$\n- 最后，电流密度：\n$$\nj_{\\parallel} = \\frac{(1)(1.6021766 \\times 10^{-19}\\,\\mathrm{C})(2.0 \\times 10^{19}\\,\\mathrm{m}^{-3})(3.0955 \\times 10^{5}\\,\\mathrm{m/s})}{2\\sqrt{\\pi}} \\exp(-0.19373)\n$$\n$$\nj_{\\parallel} \\approx \\frac{9.920 \\times 10^{5}\\,\\mathrm{A/m^2}}{3.5449} \\times 0.82389 \\approx (2.7984 \\times 10^{5}\\,\\mathrm{A/m^2}) \\times 0.82389 \\approx 2.3056 \\times 10^{5}\\,\\mathrm{A/m^2}\n$$\n四舍五入到三位有效数字，我们得到$2.31 \\times 10^{5}\\,\\mathrm{A/m^2}$。",
            "answer": "$$\\boxed{2.31 \\times 10^5}$$"
        },
        {
            "introduction": "高约束模式（H-mode）的一个标志性特征是在等离子体边缘形成一个具有陡峭压力梯度的台基区。这个梯度的上限通常由微观不稳定性决定，例如动理学气球模（KBM）。本练习 () 要求您基于台基区处处处于 KBM 临界稳定边界的假设，推导出台基宽度的解析表达式，从而将局域的稳定性判据与宏观的剖面结构联系起来。",
            "id": "4198083",
            "problem": "考虑一个环形装置中的高约束边缘（H模）台基，其台基压力分布由动理学气球模（KBM）调控。设局域KBM稳定性边界由一个与$\\beta$相关的归一化压力梯度极限表征，其形式为\n$$\n\\frac{R}{L_p} \\leq C \\sqrt{\\beta},\n$$\n其中，$R$是大半径，$L_p \\equiv \\left| \\frac{p}{\\mathrm{d}p/\\mathrm{d}r} \\right|$是局域压力标长，$C$是一个由几何和动理学效应决定的量级为1的常数，$\\beta \\equiv \\frac{2 \\mu_0 p}{B^2}$是使用环向磁场强度$B$定义的局域等离子体贝塔值。假设以下具有物理动机的条件：\n$1$) 我们感兴趣的台基区域从台基顶部（位于$r=r_0$，压力为$p_{\\mathrm{ped}}$）延伸到分界面（位于$r=r_0+\\Delta_p$，压力为$p_{\\mathrm{sep}} \\ll p_{\\mathrm{ped}}$）；\n$2$) 在整个区域内，压力梯度处处都饱和KBM边界（即，局域上维持临界稳定）；\n$3$) 磁场强度$B$在整个台基上近似恒定，因此$\\beta$与$p$成正比。\n\n仅从给定的边界、$L_p$的定义和$\\beta$的定义出发，并取向外的小半径坐标$r$从$r_0$增加到$r_0+\\Delta_p$，推导台基宽度$\\Delta_p$的闭式表达式，用$R$、$C$、$\\beta_{\\mathrm{ped}} \\equiv \\frac{2 \\mu_0 p_{\\mathrm{ped}}}{B^2}$和$\\beta_{\\mathrm{sep}} \\equiv \\frac{2 \\mu_0 p_{\\mathrm{sep}}}{B^2}$表示。你的最终答案必须是$\\Delta_p$的单个解析表达式。除上述列出的近似外，不要陈述任何其他近似。不要代入数值。仅给出最终的符号表达式。",
            "solution": "该问题要求基于一个简化模型推导台基宽度$\\Delta_p$的表达式，该模型中压力梯度处处位于动理学气球模（KBM）的临界稳定边界。\n\n分析从给定的KBM稳定性边界开始。根据条件($2$)，台基压力梯度饱和了该边界，这将不等式转化为严格的等式：\n$$\n\\frac{R}{L_p} = C \\sqrt{\\beta}\n$$\n这里，$R$是大半径，$C$是常数，$\\beta$是局域等离子体贝塔值，$L_p$是压力标长。\n\n压力标长$L_p$定义为：\n$$\nL_p \\equiv \\left| \\frac{p}{\\mathrm{d}p/\\mathrm{d}r} \\right|\n$$\n问题指明，小半径$r$从台基顶部$r=r_0$增加到分界面$r=r_0+\\Delta_p$。对应的压力为$p_{\\mathrm{ped}}$和$p_{\\mathrm{sep}}$，且满足条件$p_{\\mathrm{ped}} > p_{\\mathrm{sep}}$。这意味着在整个台基上，压力$p$是半径$r$的递减函数。因此，导数$\\mathrm{d}p/\\mathrm{d}r$是负的。由于压力$p$本质上是正的，$L_p$定义中的绝对值可以处理为：\n$$\nL_p = -\\frac{p}{\\mathrm{d}p/\\mathrm{d}r}\n$$\n\n将$L_p$的这个表达式代入临界稳定方程，得到：\n$$\n\\frac{R}{-p/(\\mathrm{d}p/\\mathrm{d}r)} = C \\sqrt{\\beta}\n$$\n$$\n-R \\frac{\\mathrm{d}p/\\mathrm{d}r}{p} = C \\sqrt{\\beta}\n$$\n这可以重写为一阶常微分方程：\n$$\n-R \\frac{1}{p} \\frac{\\mathrm{d}p}{\\mathrm{d}r} = C \\sqrt{\\beta}\n$$\n\n下一步是将此方程完全用$\\beta$和$r$表示。局域等离子体贝塔值定义为$\\beta \\equiv \\frac{2 \\mu_0 p}{B^2}$。根据条件($3$)，磁场强度$B$在整个台基上是恒定的。因此，$\\beta$与压力$p$成正比。我们可以写成$\\beta = k p$，其中$k = \\frac{2 \\mu_0}{B^2}$是一个常数。对这个关系求微分得到$\\mathrm{d}\\beta = k \\, \\mathrm{d}p$。现在我们可以找到项$\\frac{1}{p}\\frac{\\mathrm{d}p}{\\mathrm{d}r}$的表达式：\n$$\n\\frac{1}{p} \\frac{\\mathrm{d}p}{\\mathrm{d}r} = \\frac{k}{k p} \\frac{\\mathrm{d}p}{\\mathrm{d}r} = \\frac{1}{\\beta} \\frac{k \\, \\mathrm{d}p}{\\mathrm{d}r} = \\frac{1}{\\beta} \\frac{\\mathrm{d}\\beta}{\\mathrm{d}r}\n$$\n将此代回微分方程，得到：\n$$\n-R \\frac{1}{\\beta} \\frac{\\mathrm{d}\\beta}{\\mathrm{d}r} = C \\sqrt{\\beta}\n$$\n整理这个方程以分离变量$\\beta$和$r$：\n$$\n\\frac{\\mathrm{d}\\beta}{\\beta \\sqrt{\\beta}} = -\\frac{C}{R} \\mathrm{d}r\n$$\n$$\n\\beta^{-3/2} \\mathrm{d}\\beta = -\\frac{C}{R} \\mathrm{d}r\n$$\n为了求得台基宽度$\\Delta_p$，我们对该方程在台基区域上进行积分。径向坐标$r$的范围从$r_0$到$r_0 + \\Delta_p$。对应的$\\beta$值的范围从$r=r_0$处的$\\beta_{\\mathrm{ped}}$到$r=r_0 + \\Delta_p$处的$\\beta_{\\mathrm{sep}}$。因此，定积分为：\n$$\n\\int_{\\beta_{\\mathrm{ped}}}^{\\beta_{\\mathrm{sep}}} \\beta^{-3/2} \\mathrm{d}\\beta = \\int_{r_0}^{r_0 + \\Delta_p} -\\frac{C}{R} \\mathrm{d}r\n$$\n我们计算左边的积分：\n$$\n\\int \\beta^{-3/2} \\mathrm{d}\\beta = \\frac{\\beta^{-1/2}}{-1/2} + \\text{const} = -2\\beta^{-1/2} + \\text{const}\n$$\n$$\n\\int_{\\beta_{\\mathrm{ped}}}^{\\beta_{\\mathrm{sep}}} \\beta^{-3/2} \\mathrm{d}\\beta = \\left[ -2\\beta^{-1/2} \\right]_{\\beta_{\\mathrm{ped}}}^{\\beta_{\\mathrm{sep}}} = -2(\\beta_{\\mathrm{sep}}^{-1/2} - \\beta_{\\mathrm{ped}}^{-1/2}) = 2(\\beta_{\\mathrm{ped}}^{-1/2} - \\beta_{\\mathrm{sep}}^{-1/2})\n$$\n接下来，我们计算右边的积分：\n$$\n\\int_{r_0}^{r_0 + \\Delta_p} -\\frac{C}{R} \\mathrm{d}r = -\\frac{C}{R} \\left[ r \\right]_{r_0}^{r_0 + \\Delta_p} = -\\frac{C}{R} ((r_0+\\Delta_p) - r_0) = -\\frac{C}{R} \\Delta_p\n$$\n令两个积分的结果相等，得到：\n$$\n2(\\beta_{\\mathrm{ped}}^{-1/2} - \\beta_{\\mathrm{sep}}^{-1/2}) = -\\frac{C}{R} \\Delta_p\n$$\n最后，我们求解台基宽度$\\Delta_p$：\n$$\n\\Delta_p = -\\frac{2R}{C} (\\beta_{\\mathrm{ped}}^{-1/2} - \\beta_{\\mathrm{sep}}^{-1/2})\n$$\n$$\n\\Delta_p = \\frac{2R}{C} (\\beta_{\\mathrm{sep}}^{-1/2} - \\beta_{\\mathrm{ped}}^{-1/2})\n$$\n这个表达式可以更明确地写为：\n$$\n\\Delta_p = \\frac{2R}{C} \\left( \\frac{1}{\\sqrt{\\beta_{\\mathrm{sep}}}} - \\frac{1}{\\sqrt{\\beta_{\\mathrm{ped}}}} \\right)\n$$\n由于$p_{\\mathrm{ped}} > p_{\\mathrm{sep}}$，可以得出$\\beta_{\\mathrm{ped}} > \\beta_{\\mathrm{sep}} > 0$。这意味着$\\sqrt{\\beta_{\\mathrm{ped}}} > \\sqrt{\\beta_{\\mathrm{sep}}}$，因此$\\frac{1}{\\sqrt{\\beta_{\\mathrm{ped}}}}  \\frac{1}{\\sqrt{\\beta_{\\mathrm{sep}}}}$。括号中的项是正的，并且由于$R$和$C$是正常数，因此正确地求得台基宽度$\\Delta_p$是一个正量。",
            "answer": "$$\\boxed{\\frac{2R}{C} \\left( \\frac{1}{\\sqrt{\\beta_{\\mathrm{sep}}}} - \\frac{1}{\\sqrt{\\beta_{\\mathrm{ped}}}} \\right)}$$"
        },
        {
            "introduction": "湍流与 $E \\times B$ 剪切流之间的相互作用可以被形象地比作“捕食者-被捕食者”系统，其动态行为决定了输运垒的形成和稳定性。本练习 () 将指导您通过数值求解一个简化的瞬态模型来模拟这种动态竞争。通过实现一个包含线性增长、剪切抑制、非线性饱和和间歇性爆发源的常微分方程，您将能够评估输运垒在面对湍流爆发时的鲁棒性。",
            "id": "4198067",
            "problem": "我们要求您形式化并模拟一个在托卡马克边界基座处的瞬态、简化湍流幅度模型，以评估间歇性爆发是否能够克服由径向$\\mathbf{E}\\times\\mathbf{B}$剪切相关的时间依赖性$\\gamma_{E}(t)$所带来的抑制效应。您的程序必须实现一个针对无量纲湍流幅度$A(t)\\ge 0$的单场常微分方程（ODE），其动力学由线性漂移波增长率、剪切退相干、非线性自阻尼和间歇性类爆发源之间的竞争所驱动。目的是评估抑制效应的鲁棒性，即$A(t)$是否能在所需的最小连续时间内超过一个指定的阈值。所有量均为无量纲（归一化单位），因此不需要物理单位。\n\n待实现的模型规格：\n- 模型变量是无量纲湍流幅度$A(t)$。\n- 演化方程为\n$$\n\\frac{dA}{dt} = \\Big(\\gamma_{L} - \\gamma_{E}(t)\\Big) A - \\mu A^{3} + F_{\\text{burst}}(t),\n$$\n初始条件为$A(0)=A_{0}$，并始终强制$A(t)\\ge 0$。\n- 随时间变化的剪切率为\n$$\n\\gamma_{E}(t) = \\gamma_{E0} + \\Delta_{E}\\,\\sin\\!\\Big(\\frac{2\\pi t}{T_{E}}\\Big).\n$$\n- 间歇性爆发源是高斯脉冲的总和，\n$$\nF_{\\text{burst}}(t) = \\sum_{i=1}^{N_{b}} B_{i}\\,\\exp\\!\\left(-\\frac{(t-t_{i})^{2}}{2\\sigma_{i}^{2}}\\right),\n$$\n其中$N_{b}$是爆发次数，$B_{i}$是第$i$次爆发的幅度，$t_{i}$是其中心时间，$\\sigma_{i}$是其宽度。\n- 穿越判据由阈值幅度$A_{\\text{thr}}$和最小连续保持时间$\\tau_{\\text{hold}}$定义。定义一个案例“克服剪切势垒”，当且仅当存在一个持续时间至少为$\\tau_{\\text{hold}}$的时间区间，在该区间内所有的$t$都满足$A(t)\\ge A_{\\text{thr}}$。\n\n数值要求：\n- 在区间$t\\in[0,t_{\\text{end}}]$上，使用经典的四阶龙格-库塔（Runge–Kutta (RK4)）方法，以固定时间步长$dt$积分该ODE。\n- 在每个时间步之后，强制执行$A(t)\\leftarrow \\max(A(t),0)$。\n- 通过追踪$A(t)\\ge A_{\\text{thr}}$的最长连续时间来检测是否克服势垒，使用步长为$dt$的离散时间网格。如果找到任何长度至少为$\\tau_{\\text{hold}}$的连续区间，则报告“真”，否则报告“假”。\n\n测试套件：\n对于以下每个案例，请使用上面模型中列出的参数。所有数字都是无量纲的，并且必须完全按照给定的数值实现。\n\n- 案例1（强剪切，中等爆发）：\n  - $\\gamma_{L}=0.4$, $\\gamma_{E0}=0.6$, $\\Delta_{E}=0.1$, $T_{E}=20$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - 爆发：$N_{b}=2$，分别为$(B_{1},t_{1},\\sigma_{1})=(0.3,30,0.5)$和$(B_{2},t_{2},\\sigma_{2})=(0.3,60,0.5)$\n\n- 案例2（中等剪切，单次强爆发）：\n  - $\\gamma_{L}=0.4$, $\\gamma_{E0}=0.35$, $\\Delta_{E}=0.1$, $T_{E}=25$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - 爆发：$N_{b}=1$，为$(B_{1},t_{1},\\sigma_{1})=(1.0,30,1.0)$\n\n- 案例3（大剪切偏移，小幅爆发）：\n  - $\\gamma_{L}=0.4$, $\\gamma_{E0}=0.5$, $\\Delta_{E}=0.25$, $T_{E}=30$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - 爆发：$N_{b}=2$，分别为$(B_{1},t_{1},\\sigma_{1})=(0.4,10,0.7)$和$(B_{2},t_{2},\\sigma_{2})=(0.4,20,0.7)$\n\n- 案例4（接近平衡，多次中等爆发）：\n  - $\\gamma_{L}=0.45$, $\\gamma_{E0}=0.43$, $\\Delta_{E}=0.05$, $T_{E}=40$\n  - $\\mu=1.0$, $A_{0}=0.05$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - 爆发：$N_{b}=3$，分别为$(B_{1},t_{1},\\sigma_{1})=(0.35,15,1.2)$、$(B_{2},t_{2},\\sigma_{2})=(0.35,25,1.2)$和$(B_{3},t_{3},\\sigma_{3})=(0.35,35,1.2)$\n\n- 案例5（无驱动，无爆发）：\n  - $\\gamma_{L}=0.0$, $\\gamma_{E0}=0.2$, $\\Delta_{E}=0.0$, $T_{E}=50$\n  - $\\mu=1.0$, $A_{0}=0.0$\n  - $A_{\\text{thr}}=0.5$, $\\tau_{\\text{hold}}=5.0$\n  - $t_{\\text{end}}=100$, $dt=0.01$\n  - 爆发：$N_{b}=0$（空列表）\n\n输出格式：\n- 对于以上述顺序列出的每个案例，计算一个布尔值，指示是否克服了剪切势垒（如定义）。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，`[{\\rm true},{\\rm false},\\dots]`，但使用相应编程语言的布尔字面量）。例如：`[True,False,True,False,False]`。",
            "solution": "该问题已经过验证，并被确定为一个适定的、有科学依据的计算物理任务。它提出了一个简化但具有物理动机的湍流动力学模型，该模型与磁约束聚变相关，特别是托卡马克边界的L-H转换。所有的参数、方程和数值要求都已明确指定，构成了一个自洽且可解的问题。\n\n问题的核心是求解一个一阶常微分方程（ODE）的初值问题，该方程模拟了无量纲湍流幅度$A(t)$的演化。该模型是一个唯象模型，捕捉了几种物理机制之间的本质竞争：\n\n1.  **线性增长/阻尼**：项$(\\gamma_{L} - \\gamma_{E}(t))A$表示对湍流幅度的净线性效应。$\\gamma_{L}$是一个恒定的线性增长率，源于像漂移波这样的等离子体不稳定性。$\\gamma_{E}(t)$是一个随时间变化的抑制率，表示剪切$\\mathbf{E}\\times\\mathbf{B}$流（已知会随时间振荡，即带状流）对湍流涡旋的退相干作用。\n2.  **非线性饱和**：项$-\\mu A^{3}$是一个三次自阻尼项。这代表了湍流通过非线性方式将能量转移到阻尼模式或以其他方式限制其自身增长，从而达到饱和状态的过程。\n3.  **外部强迫**：项$F_{\\text{burst}}(t)$代表驱动湍流的间歇性类爆发事件，例如磁流体动力学（MHD）事件（如边界局域模或ELMs）将能量注入湍流涨落中。\n\n完整的演化方程为：\n$$\n\\frac{dA}{dt} = f(t, A) = \\Big(\\gamma_{L} - \\gamma_{E}(t)\\Big) A - \\mu A^{3} + F_{\\text{burst}}(t)\n$$\n初始条件为$A(0) = A_{0}$。由于$A(t)$代表一个幅度，它必须是非负的，这个约束通过在每个时间步后设置$A(t) \\leftarrow \\max(0, A(t))$在数值上强制执行。\n\n随时间变化的剪切率$\\gamma_E(t)$和爆发源$F_{\\text{burst}}(t)$由下式给出：\n$$\n\\gamma_{E}(t) = \\gamma_{E0} + \\Delta_{E}\\,\\sin\\!\\Big(\\frac{2\\pi t}{T_{E}}\\Big)\n$$\n$$\nF_{\\text{burst}}(t) = \\sum_{i=1}^{N_{b}} B_{i}\\,\\exp\\!\\left(-\\frac{(t-t_{i})^{2}}{2\\sigma_{i}^{2}}\\right)\n$$\n\n为了数值求解这个ODE，问题指定使用经典的四阶龙格-库塔（RK4）方法。这是一种稳健且广泛用于求解初值问题的显式方法。对于形式为$\\frac{dy}{dt} = f(t, y)$的ODE，RK4算法将解从时间$t_n$推进到$t_{n+1} = t_n + dt$的过程如下：\n$$\ny_{n+1} = y_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\n其中中间斜率计算如下：\n\\begin{align*}\nk_1 = dt \\cdot f(t_n, y_n) \\\\\nk_2 = dt \\cdot f(t_n + \\frac{dt}{2}, y_n + \\frac{k_1}{2}) \\\\\nk_3 = dt \\cdot f(t_n + \\frac{dt}{2}, y_n + \\frac{k_2}{2}) \\\\\nk_4 = dt \\cdot f(t_n + dt, y_n + k_3)\n\\end{align*}\n在我们的具体问题中，变量$y$对应于幅度$A$。\n\n每个测试案例的总体求解流程如下：\n1.  将时间区间$[0, t_{\\text{end}}]$离散化为一个点网格$t_n = n \\cdot dt$，其中$n$是从$0$到$N_{\\text{steps}} = \\lfloor t_{\\text{end}} / dt \\rfloor$的整数。\n2.  用$A_0 = A(0)$初始化解数组。\n3.  从$n=0$迭代到$N_{\\text{steps}}-1$，应用RK4更新步骤从$A_n$计算$A_{n+1}$。\n4.  每次计算出$A_{n+1}$后，强制执行非负约束：$A_{n+1} \\leftarrow \\max(0, A_{n+1})$。\n5.  存储所有时间步计算出的$A_n$值。\n6.  积分完成后，分析得到的时间序列$A_n$。遍历该序列，找到满足$A_n \\ge A_{\\text{thr}}$的最长连续时间点序列的长度。设这个点数为$N_{\\text{contiguous, max}}$。\n7.  这个最长区间的持续时间计算为$T_{\\text{contiguous, max}} = N_{\\text{contiguous, max}} \\times dt$。\n8.  当且仅当$T_{\\text{contiguous, max}} \\ge \\tau_{\\text{hold}}$时，满足克服剪切势垒的条件。该案例的结果是一个布尔值（`True`或`False`）。\n\n对提供的五个测试案例中的每一个都执行此流程，为每个案例得出一个确定的布尔结果。下面是用于执行这些模拟并为每个案例生成布尔结果的完整Python 3代码实现：\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (strong shear, moderate bursts)\n        {\n            \"gamma_L\": 0.4, \"gamma_E0\": 0.6, \"Delta_E\": 0.1, \"T_E\": 20.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(0.3, 30.0, 0.5), (0.3, 60.0, 0.5)]\n        },\n        # Case 2 (moderate shear, one strong burst)\n        {\n            \"gamma_L\": 0.4, \"gamma_E0\": 0.35, \"Delta_E\": 0.1, \"T_E\": 25.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(1.0, 30.0, 1.0)]\n        },\n        # Case 3 (large shear excursions, small bursts)\n        {\n            \"gamma_L\": 0.4, \"gamma_E0\": 0.5, \"Delta_E\": 0.25, \"T_E\": 30.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(0.4, 10.0, 0.7), (0.4, 20.0, 0.7)]\n        },\n        # Case 4 (near balance, multiple modest bursts)\n        {\n            \"gamma_L\": 0.45, \"gamma_E0\": 0.43, \"Delta_E\": 0.05, \"T_E\": 40.0,\n            \"mu\": 1.0, \"A0\": 0.05,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": [(0.35, 15.0, 1.2), (0.35, 25.0, 1.2), (0.35, 35.0, 1.2)]\n        },\n        # Case 5 (no drive, no bursts)\n        {\n            \"gamma_L\": 0.0, \"gamma_E0\": 0.2, \"Delta_E\": 0.0, \"T_E\": 50.0,\n            \"mu\": 1.0, \"A0\": 0.0,\n            \"A_thr\": 0.5, \"tau_hold\": 5.0,\n            \"t_end\": 100.0, \"dt\": 0.01,\n            \"bursts\": []\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(params):\n    \"\"\"\n    Solves the ODE for a single case and checks the barrier overcoming criterion.\n    \n    Args:\n        params (dict): A dictionary containing all parameters for the simulation.\n    \n    Returns:\n        bool: True if the barrier is overcome, False otherwise.\n    \"\"\"\n    # Extract parameters from the dictionary for clarity\n    gamma_L = params[\"gamma_L\"]\n    mu = params[\"mu\"]\n    A0 = params[\"A0\"]\n    A_thr = params[\"A_thr\"]\n    tau_hold = params[\"tau_hold\"]\n    t_end = params[\"t_end\"]\n    dt = params[\"dt\"]\n    burst_params = params[\"bursts\"]\n    \n    # Define time-dependent functions using parameters\n    def gamma_E(t):\n        return params[\"gamma_E0\"] + params[\"Delta_E\"] * np.sin(2 * np.pi * t / params[\"T_E\"])\n\n    def F_burst(t):\n        force = 0.0\n        for B, t_i, sigma in burst_params:\n            force += B * np.exp(-((t - t_i)**2) / (2 * sigma**2))\n        return force\n\n    # Define the right-hand side of the ODE, dA/dt = f(t, A)\n    def f(t, A):\n        return (gamma_L - gamma_E(t)) * A - mu * A**3 + F_burst(t)\n\n    # Set up time grid and solution array\n    num_steps = int(t_end / dt)\n    t_values = np.linspace(0, t_end, num_steps + 1)\n    A_values = np.zeros(num_steps + 1)\n    A_values[0] = A0\n\n    # Perform RK4 integration\n    for i in range(num_steps):\n        t_n = t_values[i]\n        A_n = A_values[i]\n\n        k1 = dt * f(t_n, A_n)\n        k2 = dt * f(t_n + 0.5 * dt, A_n + 0.5 * k1)\n        k3 = dt * f(t_n + 0.5 * dt, A_n + 0.5 * k2)\n        k4 = dt * f(t_n + dt, A_n + k3)\n        \n        A_next = A_n + (1.0/6.0) * (k1 + 2*k2 + 2*k3 + k4)\n        \n        # Enforce non-negativity constraint\n        A_values[i+1] = max(0.0, A_next)\n\n    # Check the barrier overcoming criterion\n    max_contiguous_steps = 0\n    current_contiguous_steps = 0\n    for A_val in A_values:\n        if A_val >= A_thr:\n            current_contiguous_steps += 1\n        else:\n            max_contiguous_steps = max(max_contiguous_steps, current_contiguous_steps)\n            current_contiguous_steps = 0\n    \n    # Final check after the loop to account for a final contiguous block\n    max_contiguous_steps = max(max_contiguous_steps, current_contiguous_steps)\n    \n    max_contiguous_time = max_contiguous_steps * dt\n    \n    return max_contiguous_time >= tau_hold\n\n# This block is for standalone execution and would be removed in a library context.\n# solve() is not called here to prevent output during validation, but it is the\n# function that produces the final answer. The result of calling solve() is placed\n# in the answer tag.\n\n```",
            "answer": "[False, True, False, True, False]"
        }
    ]
}