{
    "hands_on_practices": [
        {
            "introduction": "在对输运垒的复杂动态进行建模之前，我们必须首先理解支持它的基本磁平衡结构。本练习聚焦于安全因子剖面 $q(r)$ 和“反磁剪切”这一概念，后者是一种与强大内部输运垒的形成密切相关的磁位形。通过一个具体的解析实例 ，您将亲手感受对此关键等离子体特征的数学描述。",
            "id": "4192938",
            "problem": "考虑一个大环径比、轴对称的托卡马克，其具有圆形同心磁通面，大半径为 $R_0$，小半径为 $a$，环向磁场 $B_\\phi$ 在小半径范围内近似恒定。安全因子 $q(r)$ 定义为磁力线沿环向运行圈数与沿极向运行圈数之比，在大环径比近似下，可以写为 $q(r) \\equiv \\frac{r B_\\phi}{R_0 B_\\theta(r)}$，其中 $B_\\theta(r)$ 是极向磁场。归一化磁剪切定义为 $\\hat{s}(r) \\equiv \\frac{r}{q(r)} \\frac{dq}{dr}$。反剪切区是指在一个有限的径向区间内 $\\hat{s}(r)  0$ 的区域，这通常与聚变等离子体湍流模拟中的内部输运垒 (ITB) 的形成和动力学相关。\n\n假设安全因子剖面由以下四次形式给出\n$$\nq(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^2 + \\beta \\left(\\frac{r}{a}\\right)^4,\n$$\n其中参数 $q_0 > 0$，$\\alpha  0$ 且 $\\beta > 0$，这代表了芯部的一种定性上的反剪切位形，并向边界过渡为单调剪切。\n\n从上述定义出发，不借助任何专门的稳定性判据，确定由给定的 $q(r)$ 所隐含的最小安全因子 $q_{\\min}$ 的闭合形式解析表达式，该表达式仅用 $q_0$、$\\alpha$ 和 $\\beta$ 表示。请将最终答案表示为单个闭合形式的表达式。无需进行数值计算，最终答案中不应包含单位。",
            "solution": "该问题要求根据给定的径向剖面确定安全因子的最小值 $q_{\\min}$。\n\n给定的安全因子剖面是小半径 $r$ 的函数，定义为：\n$$\nq(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^2 + \\beta \\left(\\frac{r}{a}\\right)^4\n$$\n其中 $q_0$、$\\alpha$、$\\beta$ 和 $a$ 是常数。参数约束为 $q_0 > 0$，$\\alpha  0$ 且 $\\beta > 0$。小半径的物理域为 $0 \\le r \\le a$。\n\n为了找到函数 $q(r)$ 的最小值，我们必须首先找到其临界点。临界点是函数对其变量的一阶导数等于零的位置。我们计算 $q(r)$ 对 $r$ 的导数：\n$$\n\\frac{dq}{dr} = \\frac{d}{dr} \\left[ q_0 + \\alpha \\frac{r^2}{a^2} + \\beta \\frac{r^4}{a^4} \\right]\n$$\n应用求导的幂次法则，我们得到：\n$$\n\\frac{dq}{dr} = 0 + \\alpha \\frac{2r}{a^2} + \\beta \\frac{4r^3}{a^4} = \\frac{2\\alpha r}{a^2} + \\frac{4\\beta r^3}{a^4}\n$$\n我们通过将此导数设为零来找到临界点：\n$$\n\\frac{2\\alpha r}{a^2} + \\frac{4\\beta r^3}{a^4} = 0\n$$\n我们可以提取一个与 $r$ 成正比的项：\n$$\nr \\left( \\frac{2\\alpha}{a^2} + \\frac{4\\beta r^2}{a^4} \\right) = 0\n$$\n该方程为临界点的位置提供了两种可能的解。\n\n第一个解是 $r = 0$。这对应于磁轴。在该点，安全因子为 $q(0) = q_0$。\n\n第二个解可以通过将括号中的项设为零来找到：\n$$\n\\frac{2\\alpha}{a^2} + \\frac{4\\beta r^2}{a^4} = 0\n$$\n让我们求解 $r^2$：\n$$\n\\frac{4\\beta r^2}{a^4} = -\\frac{2\\alpha}{a^2}\n$$\n$$\nr^2 = -\\frac{2\\alpha a^4}{4\\beta a^2} = -\\frac{\\alpha}{2\\beta} a^2\n$$\n由于 $r$ 代表物理半径，$r^2$ 必须为非负数。题目中指出 $\\alpha  0$ 且 $\\beta > 0$。因此，比率 $-\\frac{\\alpha}{2\\beta}$ 是正的，存在一个 $r$ 的实正根。我们将这第二个临界点的半径记为 $r_c$：\n$$\nr_c = a \\sqrt{-\\frac{\\alpha}{2\\beta}}\n$$\n为了确定这些临界点是对应于最小值还是最大值，我们采用二阶导数检验。$q(r)$ 的二阶导数是：\n$$\n\\frac{d^2q}{dr^2} = \\frac{d}{dr} \\left( \\frac{2\\alpha r}{a^2} + \\frac{4\\beta r^3}{a^4} \\right) = \\frac{2\\alpha}{a^2} + \\frac{12\\beta r^2}{a^4}\n$$\n首先，我们计算在 $r = 0$ 处的二阶导数：\n$$\n\\left. \\frac{d^2q}{dr^2} \\right|_{r=0} = \\frac{2\\alpha}{a^2}\n$$\n由于 $\\alpha  0$，在 $r=0$ 处的二阶导数为负。这表明 $q(0) = q_0$ 是一个局部极大值。这与反剪切剖面的物理描述一致，即安全因子从磁轴向外减小。\n\n接下来，我们计算在第二个临界点处的二阶导数，其中 $r^2 = r_c^2 = -\\frac{\\alpha}{2\\beta} a^2$：\n$$\n\\left. \\frac{d^2q}{dr^2} \\right|_{r=r_c} = \\frac{2\\alpha}{a^2} + \\frac{12\\beta}{a^4} \\left( -\\frac{\\alpha}{2\\beta} a^2 \\right) = \\frac{2\\alpha}{a^2} - \\frac{12\\alpha\\beta a^2}{2\\beta a^4} = \\frac{2\\alpha}{a^2} - \\frac{6\\alpha}{a^2} = -\\frac{4\\alpha}{a^2}\n$$\n由于 $\\alpha  0$，量 $-\\frac{4\\alpha}{a^2}$ 是正的。一个正的二阶导数表明在 $r = r_c$ 处的临界点是一个局部极小值。\n\n函数 $q(r)$ 是一个关于 $r^2$ 的简单多项式，在 $r=0$ 处有一个局部极大值，在 $r>0$ 处有一个局部极小值。因此，函数在 $r = r_c$ 处的值就是最小安全因子 $q_{\\min}$。为了求得 $q_{\\min}$，我们将 $r_c^2$ 的表达式代回到 $q(r)$ 的原始方程中：\n$$\nq_{\\min} = q(r_c) = q_0 + \\alpha \\left(\\frac{r_c}{a}\\right)^2 + \\beta \\left(\\frac{r_c}{a}\\right)^4\n$$\n我们有 $\\left(\\frac{r_c}{a}\\right)^2 = \\frac{r_c^2}{a^2} = -\\frac{\\alpha}{2\\beta}$。将此代入 $q_{\\min}$ 的表达式中：\n$$\nq_{\\min} = q_0 + \\alpha \\left(-\\frac{\\alpha}{2\\beta}\\right) + \\beta \\left(-\\frac{\\alpha}{2\\beta}\\right)^2\n$$\n$$\nq_{\\min} = q_0 - \\frac{\\alpha^2}{2\\beta} + \\beta \\left(\\frac{\\alpha^2}{4\\beta^2}\\right)\n$$\n$$\nq_{\\min} = q_0 - \\frac{\\alpha^2}{2\\beta} + \\frac{\\alpha^2}{4\\beta}\n$$\n合并包含 $\\alpha^2$ 和 $\\beta$ 的项：\n$$\nq_{\\min} = q_0 - \\frac{2\\alpha^2}{4\\beta} + \\frac{\\alpha^2}{4\\beta} = q_0 - \\frac{\\alpha^2}{4\\beta}\n$$\n这就是最小安全因子的闭合形式解析表达式，仅用给定的参数 $q_0$、$\\alpha$ 和 $\\beta$ 表示。",
            "answer": "$$\n\\boxed{q_0 - \\frac{\\alpha^2}{4\\beta}}\n$$"
        },
        {
            "introduction": "内部输运垒的价值在于它能显著提升等离子体维持其能量的能力。本实践将输运垒内部湍流输运减弱的微观图像与宏观性能指标——能量约束时间 $\\tau_E$ 联系起来。从基本的能量平衡方程出发 ，您将推导出一个局域化的热扩散系数 $\\chi(r)$ 的降低如何导致整体约束性能的可量化改善。",
            "id": "4192955",
            "problem": "一台大环径比托卡马克，其大半径为 $R$，小半径为 $a$，在稳态下运行，具有均匀的辅助加热功率密度 $\\mathcal{P}$（单位时间单位体积的能量）和跨磁通面均匀的离子密度 $n(r) = n$。能量通过湍流传导沿径向输运，其热通量密度为 $q_r(r) = - n \\chi(r) \\frac{dT}{dr}$，其中 $\\chi(r)$ 是有效湍流热扩散系数，$T(r)$ 是离子温度。假设轴对称，并忽略对流和辐射，使得稳态能量平衡简化为径向传导将局部沉积的能量向外输运。\n\n使用薄磁通面环形关系对几何进行建模：小半径为 $r$ 的磁通面包围的体积为 $V(r) = 2 \\pi^2 R r^2$，该磁通面的面积为 $A(r) = 4 \\pi^2 R r$。施加边界条件 $q_r(0) = 0$ 和 $T(a) = 0$。定义总储热能 $W$ 为 $W = \\int \\frac{3}{2} n T \\, dV$，总输入功率为 $P_{\\text{in}} = \\int \\mathcal{P} \\, dV$。能量约束时间为 $\\tau_E = \\frac{W}{P_{\\text{in}}}$。\n\n考虑两种输运状态：一个具有均匀扩散系数 $\\chi(r) = \\chi_0$ 的基准状态，以及一个具有内部输运垒 (ITB) 的状态，其中在输运垒区域 $r \\in [r_b - w, r_b + w]$ 内，扩散系数减小为 $\\chi(r) = \\alpha \\chi_0$，而在其他地方保持为 $\\chi_0$，其中 $0  \\alpha  1$。仅使用以上给出的原理和定义，推导出一个用 $a$、$\\chi(r)$ 和几何量表示 $\\tau_E$ 的表达式，然后使用以下参数对 ITB 情况下的 $\\tau_E$ 进行数值计算：\n- $a = 0.60$ 米，\n- $\\chi_0 = 1.5$ 米$^2$/秒，\n- $r_b = 0.35$ 米，\n- $w = 0.10$ 米，\n- $\\alpha = 0.20$。\n\n以秒为单位表示最终的能量约束时间。将答案四舍五入到三位有效数字。",
            "solution": "该问题被验证为具有科学依据、提法恰当、客观且一致。它代表了托卡马克等离子体中热输运的一个标准简化模型，这是聚变能源科学中的一个核心课题。所有必要的定义、参数和边界条件都已提供，足以推导出唯一且有意义的解。\n\n推导过程分几步进行。首先，我们从稳态能量平衡中确定径向热通量密度 $q_r(r)$。其次，我们通过对热输运方程积分来求得温度分布 $T(r)$。第三，我们推导出能量约束时间 $\\tau_E$ 的通用表达式。最后，我们对指定的内部输运垒 (ITB) 情况计算此表达式的值。\n\n在稳态下，沉积在小半径为 $r$ 的磁通面内的总加热功率必须与通过该磁通面表面积流出的能量通量相平衡。体积 $V(r)$ 内沉积的总功率为 $P(r) = \\int_{V(r)} \\mathcal{P} \\, dV'$。由于加热功率密度 $\\mathcal{P}$ 是均匀的，该积分变为 $P(r) = \\mathcal{P} V(r)$。使用给定的几何关系 $V(r) = 2 \\pi^2 R r^2$，我们有 $P(r) = 2 \\pi^2 R \\mathcal{P} r^2$。\n\n穿过表面积 $A(r)$ 的总热流率为 $q_r(r) A(r)$。因此，能量平衡方程为 $q_r(r) A(r) = P(r)$。代入 $A(r) = 4 \\pi^2 R r$ 和 $P(r)$ 的表达式，我们得到：\n$$q_r(r) (4 \\pi^2 R r) = 2 \\pi^2 R \\mathcal{P} r^2$$\n解出热通量密度 $q_r(r)$：\n$$q_r(r) = \\frac{2 \\pi^2 R \\mathcal{P} r^2}{4 \\pi^2 R r} = \\frac{\\mathcal{P} r}{2}$$\n此表达式满足边界条件 $q_r(0) = 0$。\n\n接下来，我们使用给定的热通量定义 $q_r(r) = -n \\chi(r) \\frac{dT}{dr}$ 来确定温度分布 $T(r)$。由于离子密度 $n$ 是均匀的，我们可以写出：\n$$\\frac{dT}{dr} = -\\frac{q_r(r)}{n \\chi(r)} = -\\frac{\\mathcal{P} r}{2n \\chi(r)}$$\n我们将此表达式从一个一般半径 $r$ 积分到等离子体边界 $r=a$，以找到温度分布，并使用边界条件 $T(a) = 0$：\n$$T(r) - T(a) = \\int_a^r \\left( -\\frac{\\mathcal{P} r'}{2n \\chi(r')} \\right) dr'$$\n$$T(r) = \\frac{\\mathcal{P}}{2n} \\int_r^a \\frac{r'}{\\chi(r')} dr'$$\n\n现在我们推导能量约束时间 $\\tau_E = W/P_{\\text{in}}$ 的表达式。首先，我们通过在整个等离子体体积 $V(a)$ 上对功率密度 $\\mathcal{P}$ 积分来计算总输入功率 $P_{\\text{in}}$：\n$$P_{\\text{in}} = \\mathcal{P} V(a) = 2 \\pi^2 R a^2 \\mathcal{P}$$\n接下来，我们计算总储热能 $W$，其定义为 $W = \\int \\frac{3}{2} n T \\, dV$。使用环形体积元 $dV = A(r)dr = 4 \\pi^2 R r dr$，积分变为：\n$$W = \\int_0^a \\frac{3}{2} n T(r) (4 \\pi^2 R r) dr = 6 \\pi^2 n R \\int_0^a r T(r) dr$$\n代入 $T(r)$ 的表达式：\n$$W = 6 \\pi^2 n R \\int_0^a r \\left( \\frac{\\mathcal{P}}{2n} \\int_r^a \\frac{r'}{\\chi(r')} dr' \\right) dr = 3 \\pi^2 R \\mathcal{P} \\int_0^a r \\left( \\int_r^a \\frac{r'}{\\chi(r')} dr' \\right) dr$$\n能量约束时间是 $W$ 与 $P_{\\text{in}}$ 的比值：\n$$\\tau_E = \\frac{W}{P_{\\text{in}}} = \\frac{3 \\pi^2 R \\mathcal{P} \\int_0^a r \\left( \\int_r^a \\frac{r'}{\\chi(r')} dr' \\right) dr}{2 \\pi^2 R a^2 \\mathcal{P}} = \\frac{3}{2 a^2} \\int_0^a r \\left( \\int_r^a \\frac{r'}{\\chi(r')} dr' \\right) dr$$\n这个二重积分可以使用分部积分法来简化。设 $f(r) = \\frac{r}{\\chi(r)}$。积分为 $\\int_0^a r \\left( \\int_r^a f(r') dr' \\right) dr$。应用分部积分法，令 $u = \\int_r^a f(r') dr'$ 和 $dv = r dr$，我们发现这可以简化为 $\\int_0^a \\frac{r^3}{2 \\chi(r)} dr$。因此，$\\tau_E$ 的表达式变为：\n$$\\tau_E = \\frac{3}{2 a^2} \\left( \\int_0^a \\frac{r^3}{2 \\chi(r)} dr \\right) = \\frac{3}{4 a^2} \\int_0^a \\frac{r^3}{\\chi(r)} dr$$\n这是用 $a$ 和扩散系数分布 $\\chi(r)$ 表示的 $\\tau_E$ 的通用表达式。注意，大半径 $R$、加热功率密度 $\\mathcal{P}$ 和离子密度 $n$ 都已消去。\n\n我们现在为 ITB 情况计算此表达式。输运垒的中心位于 $r_b = 0.35$ 米，宽度为 $w = 0.10$ 米。输运垒的内边界和外边界分别为 $r_1 = r_b - w = 0.25$ 米和 $r_2 = r_b + w = 0.45$ 米。扩散系数分布 $\\chi(r)$ 是分段的：\n$$\\chi(r) = \\begin{cases} \\chi_0  \\text{对于 } 0 \\le r  0.25 \\, \\text{米} \\\\ \\alpha \\chi_0  \\text{对于 } 0.25 \\, \\text{米} \\le r \\le 0.45 \\, \\text{米} \\\\ \\chi_0  \\text{对于 } 0.45 \\, \\text{米}  r \\le a \\end{cases}$$\n$\\tau_E$ 的积分必须分成三部分：\n$$\\int_0^a \\frac{r^3}{\\chi(r)} dr = \\int_0^{r_1} \\frac{r^3}{\\chi_0} dr + \\int_{r_1}^{r_2} \\frac{r^3}{\\alpha \\chi_0} dr + \\int_{r_2}^{a} \\frac{r^3}{\\chi_0} dr$$\n$$\\int_0^a \\frac{r^3}{\\chi(r)} dr = \\frac{1}{\\chi_0} \\left[ \\int_0^{r_1} r^3 dr + \\frac{1}{\\alpha} \\int_{r_1}^{r_2} r^3 dr + \\int_{r_2}^{a} r^3 dr \\right]$$\n计算 $r^3$ 的定积分：\n$$\\int_0^a \\frac{r^3}{\\chi(r)} dr = \\frac{1}{\\chi_0} \\left[ \\left[\\frac{r^4}{4}\\right]_0^{r_1} + \\frac{1}{\\alpha} \\left[\\frac{r^4}{4}\\right]_{r_1}^{r_2} + \\left[\\frac{r^4}{4}\\right]_{r_2}^{a} \\right]$$\n$$\\int_0^a \\frac{r^3}{\\chi(r)} dr = \\frac{1}{4 \\chi_0} \\left[ r_1^4 + \\frac{1}{\\alpha}(r_2^4 - r_1^4) + (a^4 - r_2^4) \\right]$$\n将此代回 $\\tau_E$ 的表达式：\n$$\\tau_E = \\frac{3}{4 a^2} \\left( \\frac{1}{4 \\chi_0} \\left[ r_1^4 + \\frac{r_2^4 - r_1^4}{\\alpha} + a^4 - r_2^4 \\right] \\right) = \\frac{3}{16 a^2 \\chi_0} \\left[ a^4 + \\left(\\frac{1}{\\alpha} - 1\\right)(r_2^4 - r_1^4) \\right]$$\n现在我们代入给定的数值：$a = 0.60$ 米, $\\chi_0 = 1.5$ 米$^2$/秒, $r_1 = 0.25$ 米, $r_2 = 0.45$ 米, 以及 $\\alpha = 0.20$。\n$$a^2 = (0.60)^2 = 0.36 \\, \\text{米}^2$$\n$$a^4 = (0.60)^4 = 0.1296 \\, \\text{米}^4$$\n$$r_1^4 = (0.25)^4 = 0.00390625 \\, \\text{米}^4$$\n$$r_2^4 = (0.45)^4 = 0.04100625 \\, \\text{米}^4$$\n$$\\frac{1}{\\alpha} - 1 = \\frac{1}{0.20} - 1 = 5 - 1 = 4$$\n方括号中的项是：\n$$0.1296 + 4 \\times (0.04100625 - 0.00390625) = 0.1296 + 4 \\times (0.0371) = 0.1296 + 0.1484 = 0.278 \\, \\text{米}^4$$\n现在我们计算 $\\tau_E$：\n$$\\tau_E = \\frac{3}{16 \\times 0.36 \\times 1.5} \\times 0.278 = \\frac{3}{8.64} \\times 0.278 \\approx 0.0965277... \\, \\text{秒}$$\n按要求将结果四舍五入到三位有效数字，得到 $0.0965$ 秒。",
            "answer": "$$\\boxed{0.0965}$$"
        },
        {
            "introduction": "内部输运垒并非静态结构，而是由多种竞争力量的精妙平衡所控制的动态系统。本练习使用一个“捕食者-猎物”模型来探究这种动态特性，其中温度梯度（“猎物”）驱动湍流（“捕食者”），而湍流又被梯度自身产生的流剪切所抑制。通过模拟这个简化的方程组 ，您将揭示像输运垒形成、坍塌和振荡等复杂行为是如何从这些基本的非线性反馈回路中涌现出来的。",
            "id": "4056842",
            "problem": "您的任务是实现并分析一个简化的、无量纲化的内部输运垒（ITB）模型，该模型捕捉了在局域加热条件下，归一化温度梯度与湍流强度之间的相互作用。目标是对加热的局域化和强度进行参数扫描，模拟模型动力学，并将结果的模态分类为输运垒形成、坍塌或振荡。您的程序必须是一个完整的、可运行的程序，能够生成指定的输出格式，而无需任何用户输入。\n\n从以下适用于计算聚变科学与工程的原理层面基础开始：\n\n- 能量平衡与输运：一个由 $g(t)$ 表示的归一化温度梯度，在加热、线性弛豫和湍流驱动的输运作用下演化。湍流强度，由 $w(t)$ 表示，由梯度驱动的不稳定性所驱动，并被 $E \\times B$ 剪切所抑制。\n- 湍流驱动与剪切抑制：湍流增长率通过一个饱和非线性关系依赖于 $g(t)$，而 $E \\times B$ 剪切去相关率与局域梯度的平方成正比。\n\n您将为一个位于固定归一化小半径 $r_b = 0.6$（无量纲）的单一代表性磁通面实现一个双方程简化模型，该位置代表输运垒的位置。控制常微分方程（ODEs）如下：\n$$\n\\frac{dg}{dt} = Q \\, L(r_0,\\sigma) - C_g \\, g - \\alpha \\, w \\, g,\n$$\n$$\n\\frac{dw}{dt} = \\beta \\, \\frac{g^2}{1 + s \\, g^2} - C_w \\, w - S_{\\text{shear}} \\, g^2 \\, w,\n$$\n其中 $Q$ 是加热强度，$r_0$ 是加热局域化半径，$\\sigma$ 是加热宽度。局域化因子 $L(r_0,\\sigma)$ 是一个高斯函数：\n$$\nL(r_0,\\sigma) = \\exp\\left(-\\frac{(r_b - r_0)^2}{2 \\sigma^2}\\right).\n$$\n所有量均为无量纲。\n\n使用以下固定的模型参数，这些参数在简化模型中被选择为物理上合理且自洽的：\n- $C_g = 0.3$,\n- $\\alpha = 0.9$,\n- $\\beta = 1.5$,\n- $s = 0.5$,\n- $C_w = 0.4$,\n- $S_{\\text{shear}} = 3.0$,\n- $r_b = 0.6$.\n\n使用初始条件 $g(0) = 0.1$ 和 $w(0) = 0.05$，并将常微分方程从 $t = 0$ 积分到 $t = 500$（无量纲时间），使用足够的分辨率来捕捉瞬态和持续的动力学过程。\n\n必须根据在模拟时间区间的最后 $20\\%$ 计算的以下标准，对数值时间序列进行模态分类：\n- 在时间序列的最后 $20\\%$ 上计算时间平均梯度 $\\overline{g}$ 和时间平均湍流 $\\overline{w}$。\n- 定义阈值：$g_{\\text{high}} = 0.9$，$g_{\\text{low}} = 0.3$，$w_{\\text{low}} = 0.25$。\n- 输运垒形成（代码 $1$）：如果 $\\overline{g}  g_{\\text{high}}$ 且 $\\overline{w}  w_{\\text{low}}$。\n- 坍塌（代码 $0$）：如果 $\\overline{g}  g_{\\text{low}}$ 且 $\\overline{w}  w_{\\text{low}}$。\n- 振荡（代码 $2$）：如果以上两种情况均不适用，并且后半部分时间序列表现出持续振荡，其特征为 $g(t)$ 至少有 $5$ 个显著的局部最大值，峰峰值振幅大于 $0.3$，并且具有非平凡的方差（在最后 $50\\%$ 的时间内，$g(t)$ 的方差超过 $0.01$，$w(t)$ 也类似）。\n- 如果以上条件均不满足，则分类为坍塌（代码 $0$）。\n\n请注意，这个无量纲简化模型中没有物理单位；所有输出必须是无单位的整数。\n\n您的程序必须为下面的测试套件中的每个参数集模拟模型，并为每个案例输出一个分类代码。测试套件涵盖了多种行为，包括高强度局域加热案例、低强度远距离加热案例、易于振荡的近输运垒中等强度条件，以及宽度效应：\n\n$(Q, r_0, \\sigma)$ 值的测试套件：\n- 案例 $1$：$(2.5, 0.6, 0.05)$，\n- 案例 $2$：$(0.3, 0.1, 0.2)$，\n- 案例 $3$：$(1.2, 0.62, 0.08)$，\n- 案例 $4$：$(1.8, 0.9, 0.05)$，\n- 案例 $5$：$(2.0, 0.6, 0.3)$，\n- 案例 $6$：$(1.0, 0.58, 0.05)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与测试套件相同（例如，“[c1,c2,c3,c4,c5,c6]”），其中每个 $c_i$ 是上述定义的案例 $i$ 的整数分类代码。不应打印任何其他文本。",
            "solution": "所提出的问题是计算物理学领域，特别是在聚变能源科学领域，一个有效且适定的练习。它要求对一个耦合的非线性常微分方程（ODEs）组进行数值求解，该方程组构成了一个用于描述托卡马克等离子体中内部输运垒（ITB）动力学的简化模型。任务是在各种加热情景下模拟该模型，并对产生的等离子体状态进行分类。\n\n问题的核心在于以下这个双方程无量纲常微分方程组，它描述了在特定径向位置 $r_b = 0.6$ 处，归一化温度梯度 $g(t)$ 和归一化湍流强度 $w(t)$ 的时间演化：\n$$\n\\frac{dg}{dt} = Q \\, L(r_0,\\sigma) - C_g \\, g - \\alpha \\, w \\, g\n$$\n$$\n\\frac{dw}{dt} = \\beta \\, \\frac{g^2}{1 + s \\, g^2} - C_w \\, w - S_{\\text{shear}} \\, g^2 \\, w\n$$\n该系统是捕食者-猎物模型的经典例子，其中梯度 $g(t)$ 充当“猎物”，而湍流 $w(t)$ 充当“捕食者”。\n\n第一个方程控制温度梯度 $g(t)$。每一项对应一个独特的物理过程：\n- 源项 $Q_h = Q \\, L(r_0,\\sigma)$ 代表施加于等离子体的外部加热。$Q$ 是总加热功率，函数 $L(r_0,\\sigma) = \\exp\\left(-\\frac{(r_b - r_0)^2}{2 \\sigma^2}\\right)$ 模拟了这种加热的局域化。接近 $1$ 的 $L$ 值表示加热高度集中在输运垒位置 $r_b$，而接近 $0$ 的值则代表在该位置不直接为梯度提供能量的离轴加热。\n- 线性项 $-C_g \\, g$ 代表一个标准的弛豫或阻尼过程，模拟通过新经典或其他非湍流输运通道的能量损失，其速率与梯度成正比。这里的常数是 $C_g = 0.3$。\n- 非线性项 $-\\alpha \\, w \\, g$ 模拟了热量的湍流输运，这是湍流等离子体中能量损失的主要机制。热通量与湍流强度 $w$ 和梯度 $g$ 的乘积成正比，耦合系数为 $\\alpha = 0.9$。该项显示了湍流如何“捕食”梯度，从而降低梯度。\n\n第二个方程控制湍流强度 $w(t)$：\n- 项 $\\beta \\, \\frac{g^2}{1 + s \\, g^2}$ 代表湍流的驱动。由梯度驱动的不稳定性，如离子温度梯度（ITG）模，是湍流的主要来源。增长率随梯度 $g$ 的增加而增加，但在非常高的梯度下会饱和，这种行为由参数为 $\\beta = 1.5$ 和 $s = 0.5$ 的函数形式所捕捉。\n- 线性项 $-C_w \\, w$ 是湍流的一个简单阻尼项，代表耗散湍流能量的机制。常数为 $C_w = 0.4$。\n- 对于 ITB 形成最关键的项是剪切抑制项 $-S_{\\text{shear}} \\, g^2 \\, w$。强的温度梯度会产生剪切的 E×B 等离子体流。这些流会撕裂湍流涡并使其去相关，从而主动抑制湍流。这种抑制是高度非线性的，与 $g^2$ 成比例，并由常数 $S_{\\text{shear}} = 3.0$ 调节。该项代表了“猎物”的防御机制：高梯度可以抑制其自身的捕食者。\n\n解决此问题的算法方法包括两个主要阶段：数值积分，然后是用于分类的时间序列分析。\n\n首先，对于每个参数集 $(Q, r_0, \\sigma)$，常微分方程组被数值求解。`scipy.integrate.solve_ivp` 函数是完成此任务的合适工具，因为它为初值问题提供了鲁棒且自适应的算法。积分从 $t=0$ 到 $t=500$ 进行，初始条件为 $g(0) = 0.1$ 和 $w(0) = 0.05$。必须评估足够多的时间点，以解析可能存在的复杂动力学，包括快速瞬变和持续振荡。\n\n其次，在获得 $g(t)$ 和 $w(t)$ 的时间序列后，应用分类算法来确定系统的最终状态。分析侧重于模拟的后半部分，以表征渐进行为，丢弃初始瞬态阶段。\n- 一个覆盖模拟时间最后 $20\\%$（从 $t=400$ 到 $t=500$）的分析窗口被用来计算时间平均梯度 $\\overline{g}$ 和湍流 $\\overline{w}$。\n- 这些平均值与预定义的阈值进行比较：$g_{\\text{high}} = 0.9$，$g_{\\text{low}} = 0.3$ 和 $w_{\\text{low}} = 0.25$。\n- 如果系统稳定在高梯度、低湍流的状态，即 $\\overline{g}  g_{\\text{high}}$ 且 $\\overline{w}  w_{\\text{low}}$，则识别为“输运垒形成”状态（代码 $1$）。\n- 如果系统处于低梯度、低湍流的状态，其中 $\\overline{g}  g_{\\text{low}}$ 且 $\\overline{w}  w_{\\text{low}}$，则识别为“坍塌”状态（代码 $0$）。\n- 如果这两个稳态条件都不满足，则检查系统是否存在振荡行为。此检查在模拟的最后 $50\\%$（从 $t=250$ 到 $t=500$）进行。如果以下所有条件都为真，则声明为“振荡”状态（代码 $2$）：\n    1. $g(t)$ 和 $w(t)$ 的方差都非平凡（大于 $0.01$），表明存在动态活动。\n    2. $g(t)$ 的时间序列至少表现出 $5$ 个局部最大值，表明是持续的振荡行为而非简单的过冲。\n    3. $g(t)$ 中振荡的峰峰值振幅显著，定义为此窗口内 $g(t)$ 的最大值与最小值之差大于 $0.3$。\n- 如果没有满足输运垒、坍塌或振荡的特定标准，该状态默认分类为坍塌（代码 $0$），代表一种通用的低约束模式。\n\n这种系统化的模拟和分类程序允许对参数空间进行定量探索，将不同的加热情景映射到独特且具有物理意义的等离子体输运模态。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Simulates a reduced internal transport barrier (ITB) model and classifies the\n    resulting regimes for a suite of test cases.\n    \"\"\"\n    \n    # Test suite of (Q, r0, sigma) values\n    test_cases = [\n        (2.5, 0.6, 0.05),  # Case 1\n        (0.3, 0.1, 0.2),   # Case 2\n        (1.2, 0.62, 0.08), # Case 3\n        (1.8, 0.9, 0.05),  # Case 4\n        (2.0, 0.6, 0.3),   # Case 5\n        (1.0, 0.58, 0.05),  # Case 6\n    ]\n\n    results = []\n\n    # Fixed model parameters\n    Cg = 0.3\n    alpha = 0.9\n    beta = 1.5\n    s = 0.5\n    Cw = 0.4\n    S_shear = 3.0\n    rb = 0.6\n\n    # Simulation parameters\n    t_span = [0, 500]\n    t_eval = np.linspace(t_span[0], t_span[1], 10000)\n    initial_conditions = [0.1, 0.05] # [g(0), w(0)]\n\n    for Q, r0, sigma in test_cases:\n        \n        # Calculate the constant heating source term\n        L = np.exp(-((rb - r0)**2) / (2 * sigma**2))\n        Q_h = Q * L\n\n        def itb_model(t, y):\n            \"\"\"Defines the system of ODEs for the ITB model.\"\"\"\n            g, w = y\n            \n            dg_dt = Q_h - Cg * g - alpha * w * g\n            dw_dt = beta * (g**2 / (1 + s * g**2)) - Cw * w - S_shear * g**2 * w\n            \n            return [dg_dt, dw_dt]\n\n        # Numerically integrate the ODEs\n        sol = solve_ivp(\n            itb_model, \n            t_span, \n            initial_conditions,\n            method='RK45', \n            t_eval=t_eval\n        )\n        \n        g_series = sol.y[0]\n        w_series = sol.y[1]\n        \n        # --- Regime Classification ---\n        \n        # Analysis over the last 20% of the time series for steady state\n        last_20_percent_idx = int(len(t_eval) * 0.8)\n        g_last_20 = g_series[last_20_percent_idx:]\n        w_last_20 = w_series[last_20_percent_idx:]\n        \n        g_mean = np.mean(g_last_20)\n        w_mean = np.mean(w_last_20)\n        \n        # Thresholds\n        g_high = 0.9\n        g_low = 0.3\n        w_low = 0.25\n        \n        # Classification logic\n        classification_code = 0 # Default to collapse\n\n        # Check for Barrier formation (code 1)\n        if g_mean > g_high and w_mean  w_low:\n            classification_code = 1\n        # Check for Collapse (code 0)\n        elif g_mean  g_low and w_mean  w_low:\n            classification_code = 0\n        else:\n            # If not a clear steady state, check for Oscillation (code 2)\n            \n            # Analysis over the last 50% of the time series for oscillations\n            last_50_percent_idx = int(len(t_eval) * 0.5)\n            g_last_50 = g_series[last_50_percent_idx:]\n            w_last_50 = w_series[last_50_percent_idx:]\n            \n            # Condition 1: Non-trivial variance\n            g_var_ok = np.var(g_last_50) > 0.01\n            w_var_ok = np.var(w_last_50) > 0.01\n            \n            if g_var_ok and w_var_ok:\n                # Condition 2: At least 5 local maxima in g(t)\n                # A point is a local maximum if it is greater than its neighbors\n                peaks = 0\n                for i in range(1, len(g_last_50) - 1):\n                    if g_last_50[i] > g_last_50[i-1] and g_last_50[i] > g_last_50[i+1]:\n                        peaks += 1\n                \n                num_peaks_ok = (peaks >= 5)\n\n                if num_peaks_ok:\n                    # Condition 3: Significant peak-to-peak amplitude\n                    amplitude = np.max(g_last_50) - np.min(g_last_50)\n                    amplitude_ok = (amplitude > 0.3)\n                    \n                    if amplitude_ok:\n                        classification_code = 2\n                    else: # Not oscillating significantly, default to collapse\n                        classification_code = 0\n                else: # Not enough peaks, default to collapse\n                    classification_code = 0\n            else: # Low variance, default to collapse\n                classification_code = 0\n        \n        results.append(classification_code)\n    \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}