{
    "hands_on_practices": [
        {
            "introduction": "在聚变等离子体中，剪切流是抑制湍流和磁流体力学（MHD）不稳定性的关键机制。本练习 () 将引导你通过一个具体的计算，来理解径向电场产生的 $E \\times B$ 剪切流如何抑制撕裂模。通过推导剪切率并将其与撕裂模的线性增长率进行比较，你将能够量化地估算出稳定等离子体所需的电场强度，从而将MHD理论与托卡马克实验中的主动控制策略直接联系起来。",
            "id": "4192441",
            "problem": "一个小半径为 $a$ 的圆柱形托卡马克等离子体在半径为 $r_s$ 处有一个有理面，此处的安全因子为有理数。考虑一个稳定的环向磁场 $B(r) \\approx B_0$ 和一个单调递增的径向电场分布 $E_r(r) = E_a \\left(\\frac{r}{a}\\right)^p$，其中 $E_a$ 是 $E_r$ 在 $r=a$ 处的值，且 $p>0$ 是一个已知的整数。与电场和磁场相关的跨场漂移速度是电场乘以磁场（$\\mathrm{E}\\times\\mathrm{B}$）漂移，其大小由 $V_{E}(r) = \\frac{E_r(r)}{B_0}$ 给出。该流动在有理面附近的局域剪切通常用 $V_E(r)$ 在 $r=r_s$ 处的径向梯度来表征。在某些磁流体力学（MHD）的背景下，一个相关的量是量纲一致的剪切率，定义为 $\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$，单位是 $\\mathrm{s}^{-1}$。另一种约定使用算符 $r\\,\\partial_r$ 来构成 $\\gamma_E(r) = r\\,\\partial_r\\left(\\frac{E_r}{B_0}\\right)$，单位是速度，这个量可以在磁面上用 $r$ 归一化以得到一个速率。\n\n从基础电动力学和单流体磁流体力学（MHD）出发，使用 $\\mathrm{E}\\times\\mathrm{B}$ 漂移的定义以及给定的 $E_r(r)$ 和 $B(r)$ 分布，推导有理面上局域 $\\mathrm{E}\\times\\mathrm{B}$ 剪切率的表达式，形式为速率形式 $\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$ 以及另一种约定形式 $\\gamma_E(r_s) = r_s\\,\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\big|_{r_s}$。然后，将此剪切与线性撕裂模增长率进行比较，并根据以下判据确定通过剪切抑制磁岛生长所需的最小边界电场 $E_a$：\n$$\\left|\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} \\ge \\gamma_{\\mathrm{TM}},$$\n其中 $\\gamma_{\\mathrm{TM}}$ 是线性撕裂模增长率。假设以下科学上合理的参数：\n- $p=2$,\n- $B_0 = 3.0\\,\\mathrm{T}$,\n- $a = 0.80\\,\\mathrm{m}$,\n- $r_s = 0.50\\,\\mathrm{m}$,\n- $\\gamma_{\\mathrm{TM}} = 2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}$.\n\n将 $E_a$ 的最终数值答案四舍五入到四位有效数字。最终电场以 $\\mathrm{kV/m}$ 为单位表示。无需报告其他任何量。此问题中不出现角度，因此无需指定单位。比较应使用速率形式 $\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$ 进行，你也可以在推导中报告 $\\gamma_E(r_s)$ 以求完整，但最终答案只需要最小的 $E_a$。",
            "solution": "首先对所述问题进行严格的验证过程。\n\n### 步骤1：提取已知条件\n\n从问题陈述中逐字提取所有数据、变量和条件，得到如下内容：\n- 小半径为 $a$ 的圆柱形托卡马克等离子体。\n- 半径为 $r_s$ 处的有理面。\n- 稳定的环向磁场 $B(r) \\approx B_0$。\n- 单调递增的径向电场分布 $E_r(r) = E_a \\left(\\frac{r}{a}\\right)^p$。\n- $E_a$ 是 $E_r$ 在 $r=a$ 处的值。\n- $p>0$ 是一个已知的整数。\n- $\\mathrm{E}\\times\\mathrm{B}$ 漂移速度大小为 $V_{E}(r) = \\frac{E_r(r)}{B_0}$。\n- 剪切率定义：$\\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s}$。\n- 备选剪切约定：$\\gamma_E(r) = r\\,\\partial_r\\left(\\frac{E_r}{B_0}\\right)$。\n- 撕裂模生长被剪切抑制的判据：$\\left|\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} \\ge \\gamma_{\\mathrm{TM}}$。\n- $\\gamma_{\\mathrm{TM}}$ 是线性撕裂模增长率。\n- 具体参数值：\n    - $p = 2$\n    - $B_0 = 3.0\\,\\mathrm{T}$\n    - $a = 0.80\\,\\mathrm{m}$\n    - $r_s = 0.50\\,\\mathrm{m}$\n    - $\\gamma_{\\mathrm{TM}} = 2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}$\n- $E_a$ 的最终答案必须四舍五入到四位有效数字，并以 $\\mathrm{kV/m}$ 表示。\n\n### 步骤2：使用提取的已知条件进行验证\n\n根据既定标准对问题进行评估：\n- **科学依据：** 该问题设置在应用于托卡马克聚变等离子体的磁流体力学（MHD）的标准理论框架内。$\\mathrm{E}\\times\\mathrm{B}$ 漂移、剪切流、有理面、撕裂模以及流剪切对不稳定性的抑制等概念在该领域是基础且已成熟的。给定的电场和磁场函数形式是解析建模中常用且有效的简化。数值参数对于现代托卡马克是物理上现实的。\n- **适定性：** 问题是自洽的且结构清晰。它提供了一个具体的物理模型、一组控制方程、一个明确的目标（计算所需的最小 $E_a$）、一个精确的抑制判据以及所有必需的数值常数。可以推导出一个唯一且稳定的解。\n- **客观性：** 语言正式、精确，没有主观或模糊的术语。\n- **缺陷分析：**\n    1.  **科学或事实不成立：** 无。所涉及的物理学是标准的。\n    2.  **不可形式化或不相关：** 该问题是可形式化的，并且与湍流和磁流体力学不稳定性之间相互作用的主题直接相关。\n    3.  **不完整或矛盾的设置：** 所有必需的信息都已给出且一致。\n    4.  **不切实际或不可行：** 物理参数是合理的。\n    5.  **不适定或结构不良：** 存在唯一解。\n    6.  **伪深刻、琐碎或同义反复：** 该问题要求将微积分直接但非平凡地应用于物理模型，这是该领域的标准练习。\n    7.  **超出科学可验证范围：** 该模型及其解完全可以在物理学和数学原理内进行验证。\n\n### 步骤3：结论和行动\n\n问题是**有效的**。现在开始求解过程。\n\n目标是确定满足撕裂模抑制判据所需的边界电场 $E_a$ 的最小值。\n\n首先，我们定义需要计算其径向梯度的量，即 $\\mathrm{E}\\times\\mathrm{B}$ 漂移速度的径向分布 $V_E(r)$。问题陈述其大小由下式给出：\n$$V_{E}(r) = \\frac{E_r(r)}{B_0}$$\n问题给出了径向电场分布 $E_r(r) = E_a \\left(\\frac{r}{a}\\right)^p$ 并将磁场近似为常数 $B_0$。将这些代入 $V_E(r)$ 的表达式中，得到：\n$$V_{E}(r) = \\frac{1}{B_0} \\left( E_a \\left(\\frac{r}{a}\\right)^p \\right) = \\frac{E_a}{B_0 a^p} r^p$$\n剪切抑制判据是根据该速度的径向梯度给出的，我们将其表示为剪切率 $\\omega'_E(r)$：\n$$\\omega'_E(r) = \\partial_r V_E(r) = \\partial_r\\left(\\frac{E_r(r)}{B_0}\\right)$$\n我们计算这个导数：\n$$\\omega'_E(r) = \\partial_r\\left(\\frac{E_a}{B_0 a^p} r^p\\right)$$\n由于 $E_a$、$B_0$、$a$ 和 $p$ 都是相对于径向坐标 $r$ 的常数，我们可以将它们从导数中提出来：\n$$\\omega'_E(r) = \\frac{E_a}{B_0 a^p} \\partial_r(r^p) = \\frac{E_a}{B_0 a^p} (p r^{p-1})$$\n判据必须在有理面 $r = r_s$ 处求值：\n$$\\left.\\omega'_E\\right|_{r_s} = \\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} = \\frac{p E_a r_s^{p-1}}{B_0 a^p}$$\n为完整起见，我们也可以写出备选的剪切定义 $\\gamma_E(r_s)$：\n$$\\gamma_E(r_s) = r_s \\left.\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} = r_s \\left( \\frac{p E_a r_s^{p-1}}{B_0 a^p} \\right) = \\frac{p E_a r_s^p}{B_0 a^p}$$\n这个量的单位是速度，与问题描述一致。\n\n抑制判据为：\n$$\\left|\\partial_r\\left(\\frac{E_r}{B_0}\\right)\\right|_{r_s} \\ge \\gamma_{\\mathrm{TM}}$$\n代入我们推导出的剪切率表达式：\n$$\\left|\\frac{p E_a r_s^{p-1}}{B_0 a^p}\\right| \\ge \\gamma_{\\mathrm{TM}}$$\n问题陈述 $E_r(r)$ 是一个 $p>0$ 的单调递增分布，这意味着 $E_a$ 与 $E_r$ 符号相同。我们可以假设 $E_a > 0$。所有其他参数（$p$、$r_s$、$B_0$、$a$）都是正的物理量。因此，绝对值内的项是正的，可以去掉绝对值符号。\n$$\\frac{p E_a r_s^{p-1}}{B_0 a^p} \\ge \\gamma_{\\mathrm{TM}}$$\n我们正在寻找满足此条件的 $E_a$ 的最小值。这个最小值 $E_{a,\\text{min}}$ 在等式成立时出现：\n$$\\frac{p E_{a,\\text{min}} r_s^{p-1}}{B_0 a^p} = \\gamma_{\\mathrm{TM}}$$\n现在我们用代数方法求解 $E_{a,\\text{min}}$：\n$$E_{a,\\text{min}} = \\frac{\\gamma_{\\mathrm{TM}} B_0 a^p}{p r_s^{p-1}}$$\n现在，我们代入给定的数值：\n- $p = 2$\n- $B_0 = 3.0\\,\\mathrm{T}$\n- $a = 0.80\\,\\mathrm{m}$\n- $r_s = 0.50\\,\\mathrm{m}$\n- $\\gamma_{\\mathrm{TM}} = 2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}$\n\n$$E_{a,\\text{min}} = \\frac{(2.00 \\times 10^{4}\\,\\mathrm{s}^{-1}) (3.0\\,\\mathrm{T}) (0.80\\,\\mathrm{m})^{2}}{2 \\cdot (0.50\\,\\mathrm{m})^{2-1}}$$\n$$E_{a,\\text{min}} = \\frac{(2.00 \\times 10^{4}) (3.0) (0.64)}{2 \\cdot (0.50)}\\, \\frac{\\mathrm{s}^{-1} \\cdot \\mathrm{T} \\cdot \\mathrm{m}^2}{\\mathrm{m}}$$\n单位是 $\\mathrm{T \\cdot m \\cdot s^{-1}}$，等效于 $\\mathrm{V/m}$。\n$$E_{a,\\text{min}} = \\frac{(2.00 \\times 10^{4}) \\cdot (3.0) \\cdot (0.64)}{1.0}\\,\\mathrm{V/m}$$\n$$E_{a,\\text{min}} = (6.00 \\times 10^{4}) \\cdot (0.64)\\,\\mathrm{V/m}$$\n$$E_{a,\\text{min}} = 3.84 \\times 10^{4}\\,\\mathrm{V/m}$$\n问题要求答案以千伏每米（$\\mathrm{kV/m}$）为单位表示。\n$$E_{a,\\text{min}} = 38.4\\,\\mathrm{kV/m}$$\n最后，问题要求将最终答案四舍五入到四位有效数字。\n$$E_{a,\\text{min}} = 38.40\\,\\mathrm{kV/m}$$\n需要报告的数值是 $38.40$。",
            "answer": "$$\n\\boxed{38.40}\n$$"
        },
        {
            "introduction": "简单的电阻MHD模型是理解撕裂模的起点，但在高温托卡马克芯部，更复杂的物理效应往往起着决定性作用。本练习 () 将带你深入广义欧姆定律，比较霍尔效应和电阻效应对磁场演化的影响。通过估算这两个关键物理项的相对大小，你将学会判断在何种等离子体条件下，必须超越单流体MHD框架，采用双流体模型来精确描述MHD不稳定性与湍流的相互作用。",
            "id": "4192410",
            "problem": "托卡马克核心中撕裂模-湍流耦合的简化双流体磁流体动力学（MHD）描述可以从广义欧姆定律和麦克斯韦方程组构建。考虑存在电阻物理和霍尔物理时，从广义欧姆定律\n$${\\boldsymbol E} + {\\boldsymbol v} \\times {\\boldsymbol B} = \\eta_{\\mathrm{elec}}\\,{\\boldsymbol J} + \\frac{1}{n e}\\,{\\boldsymbol J} \\times {\\boldsymbol B} - \\frac{1}{n e}\\,\\nabla p_{e} + \\frac{m_{e}}{n e^{2}}\\,\\frac{\\partial {\\boldsymbol J}}{\\partial t} \\, ,$$\n导出的磁通函数$\\,\\psi\\,$的感应方程的平行分量，并结合法拉第定律和安培定律。在强引导场下的简化MHD标度中，并假设在所关注的尺度上，密度$\\,n\\,$均匀，且电子压力梯度和电子惯性对$\\,E_{\\parallel}\\,$的贡献可忽略不计，平行感应方程包含两个主要的相关项：\n- 电阻扩散项$\\,\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi\\,$，其中磁扩散系数为$\\,\\eta_{m} \\equiv \\eta_{\\mathrm{elec}}/\\mu_{0}\\,$，以及\n- 霍尔项$\\,d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi\\,$，其中$\\,d_{i}^{2} \\equiv m_{i}/(\\mu_{0}\\,n\\,e^{2})\\,$是离子趋肤深度的平方。\n\n假设耦合的撕裂-湍流动力学具有单一的特征垂直尺度$\\,k_{\\perp}\\,$和单一的特征频率$\\,\\omega\\,$，使得作用于$\\,\\psi\\,$时有$\\,\\nabla_{\\perp}^{2}\\sim -k_{\\perp}^{2}\\,$和$\\,\\partial_{t} \\sim \\omega\\,$。仅使用上述定义，推导霍尔项大小与电阻项大小的无量纲比值$\\,\\mathcal{R}\\,$的表达式，\n$$\\mathcal{R} \\equiv \\frac{|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi|}{|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi|} \\, ,$$\n该表达式仅用$\\,\\omega\\,$, $\\,\\eta_{m}\\,$和$\\,d_{i}\\,$表示。\n\n然后，针对代表氘等离子体的典型托卡马克核心参数，计算$\\,\\mathcal{R}\\,$的值：\n- 离子质量 $\\,m_{i} = 2\\,m_{p}\\,$，其中质子质量$\\,m_{p} = 1.673 \\times 10^{-27}\\,\\mathrm{kg}\\,$，\n- 电子电荷 $\\,e = 1.602 \\times 10^{-19}\\,\\mathrm{C}\\,$，\n- 真空磁导率 $\\,\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H\\,m^{-1}}\\,$，\n- 密度 $\\,n = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}\\,$，\n- 电子温度 $\\,T_{e} = 6.0 \\times 10^{3}\\,\\mathrm{eV}\\,$，\n- 库仑对数 $\\,\\ln\\Lambda = 17\\,$，\n- 有效电荷 $\\,Z_{\\mathrm{eff}} = 1\\,$，\n- 特征频率 $\\,\\omega = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}\\,$。\n\n使用以下形式的Spitzer电阻率\n$$\\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9}\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_{e}^{3/2}} \\ \\mathrm{\\Omega\\,m} \\quad \\text{其中 } T_{e}\\text{ 单位为 eV} \\, ,$$\n并取$\\,\\eta_{m} = \\eta_{\\mathrm{elec}}/\\mu_{0}\\,$。计算给定参数下$\\,\\mathcal{R}\\,$的数值。将最终答案表示为一个无单位的纯数，并四舍五入到三位有效数字。",
            "solution": "首先提取给定信息，然后检查其科学一致性和完整性，从而对问题进行验证。\n\n### 步骤1：提取给定信息\n- **广义欧姆定律：** ${\\boldsymbol E} + {\\boldsymbol v} \\times {\\boldsymbol B} = \\eta_{\\mathrm{elec}}\\,{\\boldsymbol J} + \\frac{1}{n e}\\,{\\boldsymbol J} \\times {\\boldsymbol B} - \\frac{1}{n e}\\,\\nabla p_{e} + \\frac{m_{e}}{n e^{2}}\\,\\frac{\\partial {\\boldsymbol J}}{\\partial t}$。\n- **背景：** 托卡马克核心中撕裂模-湍流耦合的简化双流体MHD描述。\n- **假设：** 密度$\\,n\\,$均匀，电子压力梯度和电子惯性对平行电场$\\,E_{\\parallel}$的影响可忽略不计。\n- **关注的项：**\n    - 电阻扩散项：$\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi$\n    - 霍尔项：$d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi$\n- **定义：**\n    - 磁扩散系数：$\\eta_{m} \\equiv \\eta_{\\mathrm{elec}}/\\mu_{0}$\n    - 离子趋肤深度的平方：$d_{i}^{2} \\equiv m_{i}/(\\mu_{0}\\,n\\,e^{2})$\n    - 无量纲比值：$\\mathcal{R} \\equiv \\frac{|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi|}{|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi|}$\n- **标度关系：** 当作用于$\\psi$时，$\\nabla_{\\perp}^{2}\\sim -k_{\\perp}^{2}$ 且 $\\partial_{t} \\sim \\omega$。\n- **等离子体参数：**\n    - 离子质量：$m_{i} = 2\\,m_{p}$\n    - 质子质量：$m_{p} = 1.673 \\times 10^{-27}\\,\\mathrm{kg}$\n    - 电子电荷：$e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$\n    - 真空磁导率：$\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H\\,m^{-1}}$\n    - 密度：$n = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n    - 电子温度：$T_{e} = 6.0 \\times 10^{3}\\,\\mathrm{eV}$\n    - 库仑对数：$\\ln\\Lambda = 17$\n    - 有效电荷：$Z_{\\mathrm{eff}} = 1$\n    - 特征频率：$\\omega = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$\n- **Spitzer电阻率公式：** $\\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9}\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_{e}^{3/2}} \\ \\mathrm{\\Omega\\,m}$ (其中$T_{e}$单位为eV)。\n\n### 步骤2：使用提取的给定信息进行验证\n根据验证标准对问题进行评估：\n- **科学依据：** 该问题基于等离子体物理学中的一个标准简化模型（双流体MHD），利用了广义欧姆定律、Spitzer电阻率和离子趋肤深度等公认的概念。所有假设和简化都已明确说明，并且在托卡马克等离子体湍流的背景下是标准的。\n- **良态的：** 该问题提供了推导唯一符号表达式并计算特定数值所需的所有必要定义、常数和标度关系。任务定义明确。\n- **客观的：** 该问题使用等离子体物理学的标准术语，以精确、客观的语言陈述。它不含主观论断。\n- **完整性与一致性：** 所有需要的数据都已提供。定义和参数彼此一致，并与标准物理值相符。\n- **现实性：** 所提供的参数是现代托卡马克核心的典型值，使得计算具有物理相关性。\n\n该问题没有验证清单中列出的任何缺陷。这是一个标准的、良态的物理问题。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供解答。\n\n### 解答推导\n\n第一个任务是推导无量纲比值 $\\mathcal{R}$ 关于 $\\omega$、$\\eta_{m}$ 和 $d_{i}$ 的表达式。$\\mathcal{R}$ 的定义如下：\n$$ \\mathcal{R} \\equiv \\frac{|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi|}{|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi|} $$\n根据指示，我们使用动力学的特征垂直尺度 $k_{\\perp}$ 和频率 $\\omega$ 的标度关系 $\\nabla_{\\perp}^{2} \\sim -k_{\\perp}^{2}$ 和 $\\partial_{t} \\sim \\omega$。将这些标度关系应用于作用在磁通函数 $\\psi$ 上的算子：\n- 霍尔项的大小估计为：$|d_{i}^{2}\\,\\nabla_{\\perp}^{2}\\,\\partial_{t}\\psi| \\sim |d_{i}^{2}\\,(-k_{\\perp}^{2})\\,(\\omega\\psi)| = d_{i}^{2}\\,k_{\\perp}^{2}\\,|\\omega|\\,|\\psi|$。\n- 电阻项的大小估计为：$|\\eta_{m}\\,\\nabla_{\\perp}^{2}\\psi| \\sim |\\eta_{m}\\,(-k_{\\perp}^{2})\\,\\psi| = \\eta_{m}\\,k_{\\perp}^{2}\\,|\\psi|$。\n\n我们假设特征频率 $\\omega$ 是一个正数，因此 $|\\omega| = \\omega$。那么比值 $\\mathcal{R}$ 为：\n$$ \\mathcal{R} = \\frac{d_{i}^{2}\\,k_{\\perp}^{2}\\,\\omega\\,|\\psi|}{\\eta_{m}\\,k_{\\perp}^{2}\\,|\\psi|} $$\n$k_{\\perp}^{2}$ 和 $|\\psi|$ 项相互抵消，得到 $\\mathcal{R}$ 的符号表达式：\n$$ \\mathcal{R} = \\frac{\\omega\\,d_{i}^{2}}{\\eta_{m}} $$\n该表达式用 $\\omega$、$\\eta_m$ 和 $d_i^2$（或 $d_i$）表示。\n\n第二个任务是数值计算 $\\mathcal{R}$。为此，代入 $d_{i}^{2}$ 和 $\\eta_{m}$ 的定义会很方便：\n$$ d_{i}^{2} = \\frac{m_{i}}{\\mu_{0}\\,n\\,e^{2}} $$\n$$ \\eta_{m} = \\frac{\\eta_{\\mathrm{elec}}}{\\mu_{0}} $$\n将它们代入 $\\mathcal{R}$ 的表达式中：\n$$ \\mathcal{R} = \\frac{\\omega \\left( \\frac{m_{i}}{\\mu_{0}\\,n\\,e^{2}} \\right)}{\\left( \\frac{\\eta_{\\mathrm{elec}}}{\\mu_{0}} \\right)} = \\frac{\\omega\\,m_{i}\\,\\mu_{0}}{\\mu_{0}\\,n\\,e^{2}\\,\\eta_{\\mathrm{elec}}} $$\n真空磁导率 $\\mu_{0}$ 相互抵消，简化了计算：\n$$ \\mathcal{R} = \\frac{\\omega\\,m_{i}}{n\\,e^{2}\\,\\eta_{\\mathrm{elec}}} $$\n接下来，我们使用所提供的公式和参数计算Spitzer电阻率 $\\eta_{\\mathrm{elec}}$。根据公式要求，电子温度以eV为单位给出。\n$$ \\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9}\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_{e}^{3/2}} $$\n给定值为 $Z_{\\mathrm{eff}}=1$，$\\ln\\Lambda=17$，以及 $T_{e} = 6.0 \\times 10^{3}\\,\\mathrm{eV}$。\n$$ T_{e}^{3/2} = (6.0 \\times 10^{3})^{3/2} = (6000)^{1.5} \\approx 464758.15 $$\n$$ \\eta_{\\mathrm{elec}} = 1.65 \\times 10^{-9} \\times \\frac{1 \\times 17}{(6.0 \\times 10^{3})^{3/2}} = \\frac{2.805 \\times 10^{-8}}{464758.15} \\approx 6.0353 \\times 10^{-14}\\,\\mathrm{\\Omega\\,m} $$\n现在我们整理用于 $\\mathcal{R}$ 最终计算的数值：\n- $\\omega = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$\n- $m_{i} = 2\\,m_{p} = 2 \\times (1.673 \\times 10^{-27}\\,\\mathrm{kg}) = 3.346 \\times 10^{-27}\\,\\mathrm{kg}$\n- $n = 8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n- $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$，所以 $e^{2} = (1.602 \\times 10^{-19})^{2} \\approx 2.5664 \\times 10^{-38}\\,\\mathrm{C^{2}}$\n- $\\eta_{\\mathrm{elec}} \\approx 6.0353 \\times 10^{-14}\\,\\mathrm{\\Omega\\,m}$\n\n将这些值代入 $\\mathcal{R}$ 的简化表达式中：\n$$ \\mathcal{R} = \\frac{(2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}) \\times (3.346 \\times 10^{-27}\\,\\mathrm{kg})}{(8.0 \\times 10^{19}\\,\\mathrm{m^{-3}}) \\times (1.602 \\times 10^{-19}\\,\\mathrm{C})^{2} \\times (6.0353 \\times 10^{-14}\\,\\mathrm{\\Omega\\,m})} $$\n$$ \\mathcal{R} \\approx \\frac{6.692 \\times 10^{-22}}{(8.0 \\times 10^{19}) \\times (2.5664 \\times 10^{-38}) \\times (6.0353 \\times 10^{-14})} $$\n$$ \\mathcal{R} \\approx \\frac{6.692 \\times 10^{-22}}{1.23916 \\times 10^{-31}} \\approx 5.4004 \\times 10^{9} $$\n结果表明，对于给定参数，霍尔项比电阻项大许多数量级。这在物理上与托卡马克核心等离子体的高温和动态特性相符，在这些等离子体中，双流体效应通常主导经典电阻率。\n\n将结果四舍五入到三位有效数字，得到 $5.40 \\times 10^{9}$。",
            "answer": "$$\\boxed{5.40 \\times 10^{9}}$$"
        },
        {
            "introduction": "在湍流与MHD不稳定性共存的复杂系统中，一个核心问题是确定它们之间的因果关系：是湍流驱动了MHD模，还是MHD模通过某种机制（如带状流）抑制了湍流？本练习 () 将指导你运用前沿的时间序列分析技术——滞后互相关和传递熵——来解决这个问题。通过在一个可控的合成数据集上实施这些方法，你将亲身体验如何从复杂的模拟输出中提取有向信息流，从而为揭示非线性耦合系统中的因果链条提供有力证据。",
            "id": "4192403",
            "problem": "考虑代表聚变等离子体中湍流与磁流体动力学（MHD）不稳定性相互作用的两个离散时间序列：纬向流振幅 $Z(t)$ 和 MHD 模振幅 $M(t)$，它们以均匀时间步长 $\\Delta t$（秒）进行采样。假设在一个有限事件窗口内存在物理上合理的线性自回归耦合，这与湍流和 MHD 模之间的能量交换一致：$Z(t+1)$ 依赖于 $Z(t)$ 和 $M(t)$，而 $M(t+1)$ 依赖于 $M(t)$ 和 $Z(t)$，并伴有附加的随机强迫。一种对另一种的抑制由从驱动项到目标项的负耦合系数表示。任务是仅在事件窗口内确定是纬向流抑制 MHD 模，还是纬向流被 MHD 模抑制，或者数据不支持任何一个方向。您的分析必须同时使用滞后互相关和传递熵（TE），并基于它们的概率定义：$Z(t)$ 和 $M(t+\\ell)$ 之间对于整数滞后 $\\ell$ 的滞后互相关，以及 TE 作为利用从时间序列构建的经验条件概率计算的一个过程到另一个过程的有向信息流。除了概率和相关的核心定义外，您不能假设任何公式。\n\n为您提供了一个包含 $5$ 个合成场景的测试套件。在每个场景中，通过演化以下自回归系统来构建时间序列，时间范围为 $t = 0,1,\\dots,N-2$，其中耦合仅在事件窗口 $t \\in [t_{\\mathrm{start}}, t_{\\mathrm{end}}-1]$ 内激活，在窗口外不激活：\n$$\nZ(t+1) = \\alpha\\, Z(t) + d_{\\mathrm{eff}}(t)\\, M(t) + \\eta_Z(t),\n$$\n$$\nM(t+1) = \\beta\\, M(t) + b_{\\mathrm{eff}}(t)\\, Z(t) + \\eta_M(t),\n$$\n其中，在事件窗口内 $b_{\\mathrm{eff}}(t) = b$ 且 $d_{\\mathrm{eff}}(t) = d$，在窗口外 $b_{\\mathrm{eff}}(t) = 0$ 且 $d_{\\mathrm{eff}}(t) = 0$。随机项 $\\eta_Z(t)$ 和 $\\eta_M(t)$ 是独立的髙斯随机变量，均值为零，标准差分别为 $\\sigma_Z$ 和 $\\sigma_M$。通过具有相同标准差的独立高斯抽样来初始化 $Z(0)$ 和 $M(0)$。每个场景使用一个设定了种子的可复现伪随机数生成器。\n\n对于每个场景，严格仅在数据的事件窗口段内执行以下步骤：\n- 在分析之前，将 $Z$ 和 $M$ 的数据段标准化为零均值和单位方差。\n- 对于给定的最大滞后 $L$，计算 $Z(t)$ 和 $M(t+\\ell)$ 在整数滞后 $\\ell \\in \\{-L,-L+1,\\dots,L\\}$ 上的经验滞后互相关，并找出最小负相关值及其滞后 $\\ell_{\\min}$。\n- 使用通过分位数将标准化时间序列离散化为 $B$ 个等概率区间而得到的经验条件概率，来估计传递熵（TE）$T_{Z\\to M}$ 和 $T_{M\\to Z}$。\n- 应用非零平滑以避免在概率估计中出现除以零的情况。\n- 使用两种度量来判定抑制方向：抑制需要反相关和一致的信息流方向。具体来说，如果最负相关值低于指定阈值且出现在正滞后，并且如果 $T_{Z\\to M} - T_{M\\to Z}$ 超过指定的 TE 阈值，则推断纬向流抑制 MHD 模。如果最负相关值出现在负滞后且其值低于阈值，并且 $T_{M\\to Z} - T_{Z\\to M}$ 超过 TE 阈值，则推断纬向流被 MHD 模抑制。否则，声明无方向。将推断结果报告为整数：$+1$ 代表“纬向流抑制 MHD”，$-1$ 代表“纬向流被 MHD 抑制”，$0$ 代表“无方向”。\n- 所有引用的时间必须以秒为单位。虽然最终输出是无单位整数，但要确保任何引用时间的中间量都使用秒。不使用角度。不使用百分比。\n\n使用以下参数集（测试套件），在每个场景中，事件窗口定义为 $t_{\\mathrm{start}} = \\lfloor N/4 \\rfloor$ 和 $t_{\\mathrm{end}} = \\lfloor 3N/4 \\rfloor$，最大滞后 $L = 20$，区间数量 $B = 4$，平滑参数 $\\alpha_{\\mathrm{smooth}} = 1$，互相关阈值 $\\rho_{\\mathrm{thr}} = 0.1$，以及 TE 阈值 $\\theta_{\\mathrm{TE}} = 0.01$：\n\n- 场景1（预期纬向流抑制MHD）：$N = 4096$，$\\Delta t = 10^{-4}\\ \\mathrm{s}$，$\\alpha = 0.9$，$\\beta = 0.8$，$b = -0.6$，$d = 0.0$，$\\sigma_Z = 0.3$，$\\sigma_M = 0.3$，随机种子 $= 1$。\n- 场景2（预期MHD抑制纬向流）：$N = 4096$，$\\Delta t = 10^{-4}\\ \\mathrm{s}$，$\\alpha = 0.85$，$\\beta = 0.9$，$b = 0.0$，$d = -0.5$，$\\sigma_Z = 0.3$，$\\sigma_M = 0.3$，随机种子 $= 2$。\n- 场景3（无耦合）：$N = 4096$，$\\Delta t = 10^{-4}\\ \\mathrm{s}$，$\\alpha = 0.95$，$\\beta = 0.95$，$b = 0.0$，$d = 0.0$，$\\sigma_Z = 0.4$，$\\sigma_M = 0.4$，随机种子 $= 3$。\n- 场景4（相互抑制，不明确）：$N = 4096$，$\\Delta t = 10^{-4}\\ \\mathrm{s}$，$\\alpha = 0.9$，$\\beta = 0.9$，$b = -0.3$，$d = -0.3$，$\\sigma_Z = 0.3$，$\\sigma_M = 0.3$，随机种子 $= 4$。\n- 场景5（短事件，低噪声下纬向流抑制MHD）：$N = 128$，$\\Delta t = 10^{-4}\\ \\mathrm{s}$，$\\alpha = 0.9$，$\\beta = 0.8$，$b = -0.6$，$d = 0.0$，$\\sigma_Z = 0.1$，$\\sigma_M = 0.1$，随机种子 $= 5$。\n\n您的程序必须实现以上内容，并生成单行输出，其中包含 $5$ 个场景的整数结果，形式为方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$）。输出值必须是整数，并且顺序必须遵循场景 $1$ 到 $5$。",
            "solution": "该问题要求分析离散时间序列数据，这些数据代表了聚变等离子体中纬向流振幅 $Z(t)$ 与磁流体动力学（MHD）模振幅 $M(t)$ 之间的相互作用。目标是通过综合滞后互相关和传递熵这两种不同的统计度量，来确定抑制性因果关系的方向——即纬向流抑制 MHD 模（$Z \\to M$）还是反之（$M \\to Z$）。\n\n首先，我们通过定义数据生成过程来阐述该问题。时间序列 $Z(t)$ 和 $M(t)$ 是使用一阶向量自回归（VAR(1)）模型生成的。系统的演化由以下耦合方程描述，以均匀时间步长 $\\Delta t$ 采样：\n$$\nZ(t+1) = \\alpha\\, Z(t) + d_{\\mathrm{eff}}(t)\\, M(t) + \\eta_Z(t)\n$$\n$$\nM(t+1) = \\beta\\, M(t) + b_{\\mathrm{eff}}(t)\\, Z(t) + \\eta_M(t)\n$$\n此处，$\\alpha$ 和 $\\beta$ 是代表每个过程记忆性的自回归系数。项 $\\eta_Z(t)$ 和 $\\eta_M(t)$ 是独立同分布的随机强迫项，从均值为零、标准差分别为 $\\sigma_Z$ 和 $\\sigma_M$ 的高斯分布中抽取。耦合仅在指定的事件窗口 $t \\in [t_{\\mathrm{start}}, t_{\\mathrm{end}}-1]$ 内激活，此时有效耦合系数为 $b_{\\mathrm{eff}}(t) = b$ 和 $d_{\\mathrm{eff}}(t) = d$。在此窗口之外，$b_{\\mathrm{eff}}(t) = 0$ 和 $d_{\\mathrm{eff}}(t) = 0$，意味着这两个过程独立演化。负耦合系数，例如 $b  0$，表示 $Z(t)$ 抑制 $M(t+1)$。分析将仅限于此事件窗口内的数据段。\n\n分析方法分三个阶段进行。\n首先，提取时间序列 $Z(t)$ 和 $M(t)$ 中对应于事件窗口 $[t_{\\mathrm{start}}, t_{\\mathrm{end}})$ 的数据段。为确保公平比较并消除尺度效应，将这些数据段标准化，使其均值为 $0$，标准差为 $1$。\n\n其次，我们计算标准化序列之间的经验滞后互相关 $\\rho(\\ell)$。这被定义为在整数时间滞后范围 $\\ell \\in \\{-L, \\dots, L\\}$ 内，$Z(t)$ 和 $M(t+\\ell)$ 之间的皮尔逊相关系数。负相关表示反相关系，这与抑制作用一致。出现最负相关时的滞后 $\\ell_{\\min}$ 的符号提供了因果方向的初步指示。正滞后 $\\ell_{\\min} > 0$ 表明 $Z$ 的变化先于 $M$ 的变化（$Z$ 对 $M$ 的影响），而负滞后 $\\ell_{\\min}  0$ 则表明情况相反。\n\n第三，我们采用传递熵（TE）来量化两个序列之间的有向信息流。从过程 $X$到过程 $Y$ 的 TE，记为 $T_{X \\to Y}$，衡量的是在已知 $Y$ 自身历史的条件下，当额外知道 $X$ 的历史后，预测 $Y$ 未来时不确定性的减少量。假设为一阶马尔可夫过程，这与我们的 VAR(1) 模型一致，TE 定义为：\n$$\nT_{X \\to Y} = \\sum p(y_{t+1}, y_t, x_t) \\log_2 \\frac{p(y_{t+1}|y_t, x_t)}{p(y_{t+1}|y_t)}\n$$\n为了从有限时间序列中估计 TE，我们采用非参数方法。将标准化的连续值序列通过其样本分位数离散化为 $B=4$ 个等概率的区间。然后，从离散状态的经验频率中估计 TE 公式中的各种联合概率和条件概率。为缓解状态空间中欠采样可能导致零概率和未定义对数的问题，我们应用拉普拉斯平滑，即向所有频率计数中添加一个平滑参数 $\\alpha_{\\mathrm{smooth}}=1$。我们计算两个方向的 TE：$T_{Z \\to M}$ 和 $T_{M \\to Z}$。\n\n最后，一个决策规则综合了这两个度量，以得出确定性的推断。抑制的方向按如下方式确定：\n-   **纬向流抑制 MHD ($+1$)**：如果最负互相关是显著的（即小于 $-\\rho_{\\mathrm{thr}}$）、其对应的滞后为正（$\\ell_{\\min} > 0$），并且从 $Z$ 到 $M$ 的净传递熵是显著的（$T_{Z \\to M} - T_{M \\to Z} > \\theta_{\\mathrm{TE}}$，其中 $\\theta_{\\mathrm{TE}} = 0.01$），则可作出此推断。\n-   **纬向流被 MHD 抑制 ($-1$)**：如果最负互相关是显著的（$\\rho(\\ell_{\\min})  -\\rho_{\\mathrm{thr}}$）、其滞后为负（$\\ell_{\\min}  0$），并且从 $M$ 到 $Z$ 的净传递熵是显著的（$T_{M \\to Z} - T_{Z \\to M} > \\theta_{\\mathrm{TE}}$），则可作出此推断。\n-   **无方向 ($0$)**：如果以上两组条件均未满足，则不判定主导的抑制方向。\n\n该综合性程序被系统地应用于一个包含 $5$ 个场景的测试套件，每个场景都有不同的参数，以生成最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef generate_time_series(N, alpha, beta, b, d, sigma_Z, sigma_M, seed):\n    \"\"\"\n    Generates Z(t) and M(t) time series based on the VAR(1) model.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    Z = np.zeros(N)\n    M = np.zeros(N)\n\n    # Initial conditions\n    Z[0] = rng.normal(0, sigma_Z)\n    M[0] = rng.normal(0, sigma_M)\n\n    t_start = N // 4\n    t_end = 3 * N // 4\n\n    noise_Z = rng.normal(0, sigma_Z, N - 1)\n    noise_M = rng.normal(0, sigma_M, N - 1)\n\n    for t in range(N - 1):\n        b_eff = d_eff = 0\n        if t_start = t  t_end:\n            b_eff = b\n            d_eff = d\n        \n        Z[t+1] = alpha * Z[t] + d_eff * M[t] + noise_Z[t]\n        M[t+1] = beta * M[t] + b_eff * Z[t] + noise_M[t]\n        \n    return Z, M\n\ndef standardize(series):\n    \"\"\"\n    Standardizes a time series to zero mean and unit variance.\n    \"\"\"\n    mean = np.mean(series)\n    std = np.std(series)\n    if std  1e-9: # Avoid division by zero for constant series\n        return series - mean\n    return (series - mean) / std\n\ndef lagged_cross_correlation(z, m, max_lag):\n    \"\"\"\n    Computes lagged cross-correlation between z(t) and m(t+l).\n    \"\"\"\n    N_win = len(z)\n    lags = np.arange(-max_lag, max_lag + 1)\n    corrs = np.zeros(len(lags))\n\n    for i, l in enumerate(lags):\n        if l >= 0:\n            x = z[0 : N_win - l]\n            y = m[l : N_win]\n        else: # l  0\n            ll = -l\n            x = z[ll : N_win]\n            y = m[0 : N_win - ll]\n        \n        if len(x)  2:\n            corrs[i] = 0\n            continue\n            \n        corrs[i] = np.corrcoef(x, y)[0, 1]\n\n    min_corr_val = np.min(corrs)\n    min_corr_lag = lags[np.argmin(corrs)]\n    \n    return min_corr_val, min_corr_lag\n\ndef calculate_te(source, target, n_bins, alpha_smooth):\n    \"\"\"\n    Estimates the Transfer Entropy from a source series to a target series.\n    \"\"\"\n    # 1. Discretize into equiprobable bins using quantiles\n    source_edges = np.quantile(source, np.linspace(0, 1, n_bins + 1))\n    target_edges = np.quantile(target, np.linspace(0, 1, n_bins + 1))\n    \n    source_binned = np.digitize(source, source_edges[1:-1])\n    target_binned = np.digitize(target, target_edges[1:-1])\n\n    # 2. Form state vectors\n    y_tp1 = target_binned[1:]\n    y_t = target_binned[:-1]\n    x_t = source_binned[:-1]\n    n_samples = len(x_t)\n\n    # 3. Compute count matrices (histograms)\n    counts_3d = np.zeros((n_bins, n_bins, n_bins))\n    for i in range(n_samples):\n        counts_3d[y_tp1[i], y_t[i], x_t[i]] += 1\n\n    counts_2d_yt_xt = np.sum(counts_3d, axis=0)\n    counts_2d_ytp1_yt = np.sum(counts_3d, axis=2)\n    counts_1d_yt = np.sum(counts_2d_yt_xt, axis=1)\n\n    # 4. Calculate TE using the formula: T = sum(p(y_t+1,y_t,x_t) * log2(p(y_t+1|y_t,x_t)/p(y_t+1|y_t)))\n    te = 0.0\n    total_count_3d = n_samples + (n_bins**3) * alpha_smooth\n\n    for i in range(n_bins):  # y_t+1\n        for j in range(n_bins):  # y_t\n            # Denominator term of log\n            denom_count_sum = counts_1d_yt[j] + n_bins * alpha_smooth\n            if denom_count_sum == 0: continue\n            p_cond_2 = (counts_2d_ytp1_yt[i, j] + alpha_smooth) / denom_count_sum\n            if p_cond_2 == 0: continue\n\n            for k in range(n_bins): # x_t\n                # Joint probability for summation\n                p_joint_3d = (counts_3d[i, j, k] + alpha_smooth) / total_count_3d\n                if p_joint_3d == 0: continue\n\n                # Numerator term of log\n                num_count_sum = counts_2d_yt_xt[j, k] + n_bins * alpha_smooth\n                if num_count_sum == 0: continue\n                p_cond_1 = (counts_3d[i, j, k] + alpha_smooth) / num_count_sum\n                if p_cond_1 == 0: continue\n                \n                log_term = np.log2(p_cond_1 / p_cond_2)\n                te += p_joint_3d * log_term\n    return te\n\ndef analyze_scenario(params):\n    \"\"\"\n    Runs the full analysis for a single scenario.\n    \"\"\"\n    # Unpack parameters\n    N, dt, alpha_p, beta_p, b, d, sigma_Z, sigma_M, seed = params\n    L = 20\n    B = 4\n    alpha_smooth = 1.0\n    rho_thr = 0.1\n    theta_TE = 0.01\n\n    # Generate time series\n    Z, M = generate_time_series(N, alpha_p, beta_p, b, d, sigma_Z, sigma_M, seed)\n\n    # Extract event window and standardize\n    t_start = N // 4\n    t_end = 3 * N // 4\n    Z_win = Z[t_start:t_end]\n    M_win = M[t_start:t_end]\n    \n    if len(Z_win)  L*2: # Not enough data for analysis\n        return 0\n\n    z_std = standardize(Z_win)\n    m_std = standardize(M_win)\n\n    # Lagged cross-correlation\n    min_corr, lag_min = lagged_cross_correlation(z_std, m_std, L)\n\n    # Transfer Entropy\n    T_ZM = calculate_te(z_std, m_std, B, alpha_smooth)\n    T_MZ = calculate_te(m_std, z_std, B, alpha_smooth)\n\n    # Decision logic\n    result = 0\n    if min_corr  -rho_thr:\n        if lag_min > 0 and (T_ZM - T_MZ) > theta_TE:\n            result = 1\n        elif lag_min  0 and (T_MZ - T_ZM) > theta_TE:\n            result = -1\n    \n    return result\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # N, dt, alpha, beta, b, d, sigma_Z, sigma_M, seed\n        (4096, 1e-4, 0.9, 0.8, -0.6, 0.0, 0.3, 0.3, 1),\n        (4096, 1e-4, 0.85, 0.9, 0.0, -0.5, 0.3, 0.3, 2),\n        (4096, 1e-4, 0.95, 0.95, 0.0, 0.0, 0.4, 0.4, 3),\n        (4096, 1e-4, 0.9, 0.9, -0.3, -0.3, 0.3, 0.3, 4),\n        (128, 1e-4, 0.9, 0.8, -0.6, 0.0, 0.1, 0.1, 5),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_scenario(case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}