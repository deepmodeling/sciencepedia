{
    "hands_on_practices": [
        {
            "introduction": "The first and most fundamental task in code verification is to confirm that a simulation's output converges toward a single, grid-independent solution as resolution is increased. This exercise provides a hands-on method for diagnosing this behavior by calculating the observed order of accuracy, $p$, from a series of simulations. Mastering this technique  is essential for building confidence that your code is implemented correctly and that its discretization error is decreasing as theoretically expected.",
            "id": "4183847",
            "problem": "A high-fidelity gyrokinetic simulation of electrostatic ion temperature gradient turbulence in a tokamak computes the time-averaged, flux-surface-averaged ion heat flux, normalized to gyro-Bohm units, denoted by $Q(h)$, where $h$ is the perpendicular radial grid spacing. For spatial code verification, assume the asymptotic discretization error model\n$$\nQ(h) \\;=\\; Q^{\\star} \\;+\\; C\\, h^{p},\n$$\nwhere $Q^{\\star}$ is the continuum-limit quantity, $C$ is a constant, and $p$ is the (unknown) observed order of accuracy. The solverâ€™s formal spatial accuracy is nominally second-order. You perform three systematically refined simulations with refinement ratio $r=2$ and obtain\n$$\nQ(h)\\;=\\;1.832,\\qquad Q\\!\\left(\\frac{h}{2}\\right)\\;=\\;1.754,\\qquad Q\\!\\left(\\frac{h}{4}\\right)\\;=\\;1.730.\n$$\nStarting from the asymptotic error model and the assumption of a uniform refinement ratio $r=2$, derive a closed-form expression for the observed order of accuracy $p$ in terms of the three-grid solutions and then evaluate $p$ using the provided data. Briefly, in your solution, interpret any deviation of the observed $p$ from the nominal order. Report the final numerical value of $p$ rounded to three significant figures. No units are required for $p$.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a standard procedure in numerical code verification, specifically the estimation of the observed order of accuracy from a series of grid refinement simulations. The data and context are consistent with practices in computational plasma physics.\n\nThe problem starts with the asymptotic error model for a computed quantity $Q$ as a function of grid spacing $h$:\n$$\nQ(h) = Q^{\\star} + C h^{p}\n$$\nwhere $Q^{\\star}$ is the exact continuum solution, $C$ is a constant, and $p$ is the order of accuracy of the numerical method.\n\nWe are given three simulations performed on systematically refined grids. Let the coarsest grid have a spacing $h$. The subsequent grids have spacings $h/r$ and $h/r^2$, where the refinement ratio is given as $r=2$. Let us denote the results from these three grids as:\n$$\nQ_1 = Q(h) \\\\\nQ_2 = Q\\left(\\frac{h}{2}\\right) \\\\\nQ_3 = Q\\left(\\frac{h}{4}\\right)\n$$\n\nUsing the error model, we can write an equation for each simulation result:\n$$\nQ_1 = Q^{\\star} + C h^{p} \\qquad (1)\n$$\n$$\nQ_2 = Q^{\\star} + C \\left(\\frac{h}{2}\\right)^{p} = Q^{\\star} + \\frac{C h^{p}}{2^{p}} \\qquad (2)\n$$\n$$\nQ_3 = Q^{\\star} + C \\left(\\frac{h}{4}\\right)^{p} = Q^{\\star} + \\frac{C h^{p}}{4^{p}} = Q^{\\star} + \\frac{C h^{p}}{(2^2)^{p}} = Q^{\\star} + \\frac{C h^{p}}{2^{2p}} \\qquad (3)\n$$\n\nTo find the order of accuracy $p$, we must eliminate the unknown constants $Q^{\\star}$ and $C$. We can achieve this by taking the differences between the results from successive grids.\n\nSubtracting equation $(2)$ from $(1)$:\n$$\nQ_1 - Q_2 = \\left(Q^{\\star} + C h^{p}\\right) - \\left(Q^{\\star} + \\frac{C h^{p}}{2^{p}}\\right) = C h^{p} \\left(1 - \\frac{1}{2^{p}}\\right) \\qquad (4)\n$$\n\nSubtracting equation $(3)$ from $(2)$:\n$$\nQ_2 - Q_3 = \\left(Q^{\\star} + \\frac{C h^{p}}{2^{p}}\\right) - \\left(Q^{\\star} + \\frac{C h^{p}}{4^{p}}\\right) = \\frac{C h^{p}}{2^{p}} \\left(1 - \\frac{1}{2^{p}}\\right) \\qquad (5)\n$$\n\nNow, we can eliminate $C$, $h$, and the term $\\left(1 - 1/2^{p}\\right)$ by taking the ratio of equation $(4)$ to equation $(5)$:\n$$\n\\frac{Q_1 - Q_2}{Q_2 - Q_3} = \\frac{C h^{p} \\left(1 - \\frac{1}{2^{p}}\\right)}{\\frac{C h^{p}}{2^{p}} \\left(1 - \\frac{1}{2^{p}}\\right)}\n$$\nAssuming that $p \\neq 0$ and we are not at the exact solution (so differences are non-zero), the terms cancel out, leaving:\n$$\n\\frac{Q_1 - Q_2}{Q_2 - Q_3} = 2^{p}\n$$\nThis equation provides the relationship between the three-grid solutions and the observed order of accuracy $p$. To solve for $p$, we take the logarithm of both sides. Using the natural logarithm ($\\ln$):\n$$\n\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right) = \\ln(2^{p})\n$$\nUsing the logarithm property $\\ln(a^b) = b \\ln(a)$, we get:\n$$\n\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right) = p \\ln(2)\n$$\nIsolating $p$ gives the desired closed-form expression:\n$$\np = \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(2)}\n$$\nThis is also equivalent to $p = \\log_{2}\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)$.\n\nNow, we substitute the numerical data provided in the problem:\n$$\nQ_1 = Q(h) = 1.832 \\\\\nQ_2 = Q\\left(\\frac{h}{2}\\right) = 1.754 \\\\\nQ_3 = Q\\left(\\frac{h}{4}\\right) = 1.730\n$$\nFirst, calculate the differences:\n$$\nQ_1 - Q_2 = 1.832 - 1.754 = 0.078\n$$\n$$\nQ_2 - Q_3 = 1.754 - 1.730 = 0.024\n$$\nNext, calculate the ratio of the differences:\n$$\n\\frac{Q_1 - Q_2}{Q_2 - Q_3} = \\frac{0.078}{0.024} = 3.25\n$$\nFinally, substitute this value into the expression for $p$:\n$$\np = \\frac{\\ln(3.25)}{\\ln(2)} \\approx \\frac{1.17865499}{0.69314718} \\approx 1.70046\n$$\nRounding the result to three significant figures, we obtain $p \\approx 1.70$.\n\nThe problem asks for a brief interpretation of any deviation of the observed $p$ from the nominal order. The solver's nominal spatial accuracy is second-order, meaning $p_{nominal} = 2$. Our observed order of accuracy is $p \\approx 1.70$, which is lower than the nominal value. This discrepancy is common in code verification studies. The asymptotic error model $Q(h) = Q^{\\star} + C h^{p}$ is strictly valid only in the limit $h \\to 0$. For finite grid spacings, higher-order error terms, such as $D h^{p+1}$ (where $D$ is another constant), may still be significant. The presence of these higher-order terms contaminates the estimate of $p$. An observed order of $p  p_{nominal}$ typically indicates that the grid resolutions used are not yet fine enough to be in the \"asymptotic range,\" where the lowest-order error term dominates the total discretization error. The result $p \\approx 1.70$ suggests that the code is approaching its theoretical second-order convergence, but the coarsest grid spacing $h$ is likely too large for the asymptotic behavior to be fully realized.",
            "answer": "$$\\boxed{1.70}$$"
        },
        {
            "introduction": "Once convergence is established, we can go a step further: using the data from a grid refinement study to produce a more accurate estimate of the true solution and to formally quantify the numerical uncertainty. This practice  introduces Richardson extrapolation, a powerful technique to estimate the continuum solution $u^{\\ast}$, and the Grid Convergence Index (GCI), a standardized method for reporting discretization error. These tools are indispensable for producing simulation results with credible, quantified confidence intervals.",
            "id": "4183818",
            "problem": "A researcher is performing code verification for a nonlinear electrostatic gyrokinetic turbulence simulation of an Ion Temperature Gradient (ITG) driven state in a tokamak core. The quantity of interest is the flux-surface-averaged ion heat flux, normalized to gyro-Bohm units, denoted by $u$. The solver is known to be consistent, and under asymptotic grid refinement the discretization error admits a leading-order expansion $u(h) = u^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$, where $h$ is the characteristic radial grid spacing, $u^{\\ast}$ is the grid-converged solution, $C$ is a constant, and $p$ is the observed order of accuracy.\n\nA sequence of three simulations are performed with uniform refinement ratio $r$, using identical physics and numerics except for the radial grid spacing:\n- $h_{1} = 3.2 \\times 10^{-3}$, $u_{1} = 0.940$\n- $h_{2} = 1.6 \\times 10^{-3}$, $u_{2} = 0.900$\n- $h_{3} = 0.8 \\times 10^{-3}$, $u_{3} = 0.890$\n\nAssume asymptotic behavior holds and that monotonic convergence without oscillations is present. Using the asymptotic error expansion and the concept of grid refinement with ratio $r = h_{1}/h_{2} = h_{2}/h_{3}$, do the following:\n1. Derive the observed order $p$ from the three-level refinement data using first principles.\n2. Apply Richardson extrapolation to estimate the grid-converged solution $u^{\\ast}$.\n3. Compute an uncertainty estimate for the solution at the finest grid $h_{3}$ using the Grid Convergence Index (GCI) method, with the safety factor $F_{s} = 1.25$, under asymptotic conditions.\n\nRound your final reported values for $u^{\\ast}$ and the uncertainty estimate at $h_{3}$ to four significant figures. Express both in gyro-Bohm normalized units. Provide your final answer as two values in a single row matrix, in the order $\\left(u^{\\ast}, \\text{uncertainty at } h_{3}\\right)$.",
            "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the established principles of code verification and uncertainty quantification for computational simulations. The problem is well-posed, providing a self-contained and consistent set of data and assumptions that permit a unique and meaningful solution. All terms are clearly defined, and the premises are factually sound within the context of numerical analysis of partial differential equations.\n\nThe problem requires a three-step analysis based on the provided simulation data and the asymptotic error expansion model. The model for the quantity of interest, the normalized ion heat flux $u$, as a function of the grid spacing $h$, is given as $u(h) = u^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$, where $u^{\\ast}$ is the exact, grid-converged solution, $C$ is a constant, and $p$ is the observed order of accuracy. We are given data from three simulations with a uniform refinement ratio $r$:\n- Grid $1$: $h_{1} = 3.2 \\times 10^{-3}$, $u_{1} = 0.940$\n- Grid $2$: $h_{2} = 1.6 \\times 10^{-3}$, $u_{2} = 0.900$\n- Grid $3$: $h_{3} = 0.8 \\times 10^{-3}$, $u_{3} = 0.890$\n\nThe constant grid refinement ratio $r$ is calculated as $r = \\frac{h_{1}}{h_{2}} = \\frac{3.2 \\times 10^{-3}}{1.6 \\times 10^{-3}} = 2$ and $r = \\frac{h_{2}}{h_{3}} = \\frac{1.6 \\times 10^{-3}}{0.8 \\times 10^{-3}} = 2$. Thus, $r=2$.\n\n**1. Derivation of the Observed Order of Accuracy, $p$**\n\nWe write the asymptotic error model for the three grid levels, ignoring the higher-order terms:\n$$u_{1} \\approx u^{\\ast} + C h_{1}^{p}$$\n$$u_{2} \\approx u^{\\ast} + C h_{2}^{p}$$\n$$u_{3} \\approx u^{\\ast} + C h_{3}^{p}$$\n\nTo eliminate the unknown $u^{\\ast}$, we take the difference between solutions on consecutive grids:\n$$u_{1} - u_{2} \\approx C (h_{1}^{p} - h_{2}^{p})$$\n$$u_{2} - u_{3} \\approx C (h_{2}^{p} - h_{3}^{p})$$\n\nNext, we take the ratio of these two differences to eliminate the constant $C$:\n$$\\frac{u_{1} - u_{2}}{u_{2} - u_{3}} \\approx \\frac{C (h_{1}^{p} - h_{2}^{p})}{C (h_{2}^{p} - h_{3}^{p})} = \\frac{h_{1}^{p} - h_{2}^{p}}{h_{2}^{p} - h_{3}^{p}}$$\n\nWe substitute the relations $h_{1} = r h_{2}$ and $h_{2} = r h_{3}$:\n$$\\frac{u_{1} - u_{2}}{u_{2} - u_{3}} \\approx \\frac{(r h_{2})^{p} - h_{2}^{p}}{(r h_{3})^{p} - h_{3}^{p}} = \\frac{h_{2}^{p}(r^{p} - 1)}{h_{3}^{p}(r^{p} - 1)} = \\left(\\frac{h_{2}}{h_{3}}\\right)^{p} = r^{p}$$\n\nThis gives an equation for the observed order of accuracy $p$:\n$$r^{p} = \\frac{u_{1} - u_{2}}{u_{2} - u_{3}}$$\nSolving for $p$ by taking the natural logarithm of both sides:\n$$p \\ln(r) = \\ln\\left(\\frac{u_{1} - u_{2}}{u_{2} - u_{3}}\\right)$$\n$$p = \\frac{\\ln\\left(\\frac{u_{1} - u_{2}}{u_{2} - u_{3}}\\right)}{\\ln(r)}$$\n\nSubstituting the numerical values:\n$$u_{1} - u_{2} = 0.940 - 0.900 = 0.040$$\n$$u_{2} - u_{3} = 0.900 - 0.890 = 0.010$$\n$$p = \\frac{\\ln\\left(\\frac{0.040}{0.010}\\right)}{\\ln(2)} = \\frac{\\ln(4)}{\\ln(2)} = \\frac{2 \\ln(2)}{\\ln(2)} = 2$$\nThe observed order of accuracy is $p=2$.\n\n**2. Richardson Extrapolation for the Grid-Converged Solution, $u^{\\ast}$**\n\nRichardson extrapolation uses solutions from two grid levels to estimate the exact solution $u^{\\ast}$. It is best practice to use the two finest grids, $h_{2}$ and $h_{3}$, as they better represent the asymptotic behavior. We have:\n$$u_{2} \\approx u^{\\ast} + C h_{2}^{p}$$\n$$u_{3} \\approx u^{\\ast} + C h_{3}^{p}$$\nThe error on the finest grid is $E_{3} = u_{3} - u^{\\ast} \\approx C h_{3}^{p}$. The error on the medium grid is $E_{2} = u_{2} - u^{\\ast} \\approx C h_{2}^{p} = C (r h_{3})^{p} = r^{p} C h_{3}^{p} \\approx r^{p} E_{3}$.\nFrom this, we have the relation $u_{2} - u^{\\ast} \\approx r^{p}(u_{3} - u^{\\ast})$.\n$$u_{2} - u^{\\ast} \\approx r^{p} u_{3} - r^{p} u^{\\ast}$$\n$$r^{p} u^{\\ast} - u^{\\ast} \\approx r^{p} u_{3} - u_{2}$$\n$$u^{\\ast}(r^{p} - 1) \\approx r^{p} u_{3} - u_{2}$$\n$$u^{\\ast} \\approx \\frac{r^{p} u_{3} - u_{2}}{r^{p} - 1}$$\nThis can be rearranged into the more common form:\n$$u^{\\ast} \\approx u_{3} + \\frac{u_{3} - u_{2}}{r^{p} - 1}$$\nSubstituting the values $r=2$, $p=2$, $u_{2}=0.900$, and $u_{3}=0.890$:\n$$u^{\\ast} \\approx 0.890 + \\frac{0.890 - 0.900}{2^{2} - 1} = 0.890 + \\frac{-0.010}{3} = 0.890 - 0.003333... = 0.886666...$$\nRounding to four significant figures, we get $u^{\\ast} \\approx 0.8867$.\n\n**3. Grid Convergence Index (GCI) Uncertainty Estimate**\n\nThe GCI method provides a conservative estimate for the numerical uncertainty in the solution on a given grid. For the finest grid (grid $3$), the GCI is defined as:\n$$\\text{GCI}_{3} = F_{s} \\frac{|\\epsilon_{32}|}{r^{p} - 1}$$\nwhere $F_{s}$ is a safety factor, and $\\epsilon_{32} = u_{3} - u_{2}$ is the difference in solutions between the fine and medium grids. This formula essentially scales the magnitude of the correction term from Richardson extrapolation by the safety factor.\nWe are given $F_{s} = 1.25$. Using the values from the previous steps:\n$$\\epsilon_{32} = u_{3} - u_{2} = 0.890 - 0.900 = -0.010$$\n$$r^{p} - 1 = 2^{2} - 1 = 3$$\n$$\\text{GCI}_{3} = 1.25 \\times \\frac{|-0.010|}{3} = 1.25 \\times \\frac{0.010}{3} = 1.25 \\times 0.003333... = 0.0041666...$$\nRounding to four significant figures, the uncertainty estimate for the solution at the finest grid $h_{3}$ is $\\text{GCI}_{3} \\approx 0.004167$.\n\nThe final results are the Richardson-extrapolated solution $u^{\\ast}$ and the GCI uncertainty on the finest grid solution $u_{3}$. They are to be reported to four significant figures.\n$u^{\\ast} \\approx 0.8867$\n$\\text{Uncertainty at } h_{3} \\approx 0.004167$\nThese are presented as a row matrix as requested.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8867  0.004167 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Effective verification extends beyond analyzing integrated outputs; it requires scrutinizing whether the simulation faithfully reproduces fundamental physical dynamics, such as wave propagation. This exercise  moves from output analysis to algorithm analysis by deriving the numerical dispersion relation for a discretized drift wave equation. By quantifying the resulting phase error, you will gain direct insight into how numerical methods can introduce non-physical artifacts that affect the fidelity of turbulence simulations.",
            "id": "4183775",
            "problem": "A slab fusion plasma with a uniform background magnetic field $\\mathbf{B} = B \\hat{\\mathbf{z}}$ and an equilibrium density gradient $\\nabla n_{0} = \\partial_{x} n_{0} \\, \\hat{\\mathbf{x}}$ supports electrostatic drift waves. Consider small-amplitude, linear perturbations that vary only in the binormal direction $y$ and time $t$, and assume isothermal, adiabatic electrons and cold ions; quasi-neutrality is enforced. Starting from the ion continuity equation and the Electric-field cross-magnetic-field ($\\mathbf{E}\\times\\mathbf{B}$) drift, derive a linear evolution equation for the electrostatic potential $\\phi(y,t)$ in the form of a first-order hyperbolic partial differential equation in $y$ and $t$ appropriate for drift-wave propagation in this slab geometry. From this continuum equation, determine the continuum dispersion relation for plane-wave solutions in $y$.\n\nNow, choose a spatial discretization consisting of a second-order central finite difference for the $y$-derivative on a uniform grid with spacing $\\Delta y$, and treat time as continuous (method of lines). Apply this spatial discretization to the derived linear evolution equation to obtain the semi-discrete numerical dispersion relation for a plane wave with binormal wavenumber $k_{y}$.\n\nDefine the phase speed of the exact (continuum) drift wave as $c_{\\mathrm{exact}}$ and the phase speed of the semi-discrete wave as $c_{\\mathrm{num}}$. Using the semi-discrete numerical dispersion relation, quantify the relative phase error, defined as the fractional bias in phase speed, $\\varepsilon_{\\phi}(\\Delta y) \\equiv \\frac{c_{\\mathrm{num}}}{c_{\\mathrm{exact}}} - 1$, as an analytic function of $k_{y}$ and $\\Delta y$.\n\nExpress your final answer for $\\varepsilon_{\\phi}(\\Delta y)$ as a closed-form analytic expression. No numerical rounding is required and no physical units should appear in the final expression. The derivation must start from the fundamental conservation laws and constitutive relations stated above, and all steps must be scientifically consistent. Your final boxed answer must contain only the requested analytic expression for $\\varepsilon_{\\phi}(\\Delta y)$.",
            "solution": "The problem requires the derivation of the relative phase error for a numerical scheme simulating electrostatic drift waves. We begin by validating the problem statement.\n\n### Step 1: Extract Givens\n- **Physics**: Slab fusion plasma, electrostatic drift waves.\n- **Magnetic Field**: Uniform, $\\mathbf{B} = B \\hat{\\mathbf{z}}$.\n- **Equilibrium**: Density gradient $\\nabla n_{0} = \\partial_{x} n_{0} \\, \\hat{\\mathbf{x}}$.\n- **Perturbations**: Linear, small-amplitude, with functional dependence on binormal direction $y$ and time $t$ only.\n- **Plasma Model**: Isothermal, adiabatic electrons; cold ions; quasi-neutrality ($n_{i1} = n_{e1}$).\n- **Dynamics**: Ion motion governed by the ion continuity equation and the $\\mathbf{E}\\times\\mathbf{B}$ drift.\n- **Task 1**: Derive a linear, first-order hyperbolic partial differential equation (PDE) for the electrostatic potential $\\phi(y,t)$.\n- **Task 2**: From the PDE, find the continuum dispersion relation $\\omega(k_y)$.\n- **Task 3**: Apply a second-order central finite difference for the $\\partial/\\partial y$ derivative on a uniform grid with spacing $\\Delta y$, with time continuous.\n- **Task 4**: Derive the semi-discrete numerical dispersion relation $\\omega_{\\mathrm{num}}(k_y)$.\n- **Task 5**: Define exact phase speed $c_{\\mathrm{exact}}$ and numerical phase speed $c_{\\mathrm{num}}$.\n- **Task 6**: Quantify the relative phase error $\\varepsilon_{\\phi}(\\Delta y) \\equiv \\frac{c_{\\mathrm{num}}}{c_{\\mathrm{exact}}} - 1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard, simplified model for electron drift waves (a limit of the Hasegawa-Wakatani or Hasegawa-Mima equations). The assumptions are standard in introductory plasma physics and turbulence theory. The problem is well-posed, as it asks for a derivation and analysis that lead to a unique analytical expression. The language is objective and precise. The physical and numerical setup is self-contained and sufficient to perform the required derivations. The problem is not trivial, as it requires connecting a physical model to its numerical representation and performing a dispersion analysis. The entire derivation is verifiable through standard mathematical and physical principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\nThe derivation starts with the linearized ion continuity equation:\n$$ \\frac{\\partial n_{i1}}{\\partial t} + \\nabla \\cdot (n_{0} \\mathbf{v}_{i1}) = 0 $$\nwhere $n_{i1}$ is the perturbed ion density and $\\mathbf{v}_{i1}$ is the perturbed ion fluid velocity. For cold ions, the dominant motion is the electric-field-cross-magnetic-field ($\\mathbf{E}\\times\\mathbf{B}$) drift:\n$$ \\mathbf{v}_{i1} = \\mathbf{v}_{\\mathbf{E}} = \\frac{\\mathbf{E}_{1} \\times \\mathbf{B}}{B^{2}} $$\nThe electrostatic field perturbation is $\\mathbf{E}_{1} = -\\nabla \\phi$. Given that perturbations vary only in $y$ and $t$, we have $\\phi = \\phi(y,t)$, so $\\mathbf{E}_{1} = -\\frac{\\partial\\phi}{\\partial y}\\hat{\\mathbf{y}}$. The background magnetic field is $\\mathbf{B} = B\\hat{\\mathbf{z}}$. The perturbed ion velocity is then:\n$$ \\mathbf{v}_{i1} = \\frac{(-\\frac{\\partial\\phi}{\\partial y}\\hat{\\mathbf{y}}) \\times (B\\hat{\\mathbf{z}})}{B^{2}} = -\\frac{1}{B}\\frac{\\partial\\phi}{\\partial y} (\\hat{\\mathbf{y}} \\times \\hat{\\mathbf{z}}) = -\\frac{1}{B}\\frac{\\partial\\phi}{\\partial y} \\hat{\\mathbf{x}} $$\nThe divergence term in the continuity equation becomes:\n$$ \\nabla \\cdot (n_{0} \\mathbf{v}_{i1}) = \\frac{\\partial}{\\partial x}(n_{0} v_{i1,x}) + \\frac{\\partial}{\\partial y}(n_{0} v_{i1,y}) + \\frac{\\partial}{\\partial z}(n_{0} v_{i1,z}) $$\nSince $\\mathbf{v}_{i1}$ has only an $x$-component, this simplifies to $\\frac{\\partial}{\\partial x}(n_{0} v_{i1,x})$. As $v_{i1,x}$ does not depend on $x$, we have:\n$$ \\nabla \\cdot (n_{0} \\mathbf{v}_{i1}) = v_{i1,x} \\frac{\\partial n_{0}}{\\partial x} = \\left(-\\frac{1}{B}\\frac{\\partial\\phi}{\\partial y}\\right) \\frac{\\partial n_{0}}{\\partial x} $$\nSubstituting this into the ion continuity equation gives:\n$$ \\frac{\\partial n_{i1}}{\\partial t} - \\frac{1}{B} \\frac{\\partial n_{0}}{\\partial x} \\frac{\\partial\\phi}{\\partial y} = 0 $$\nTo close the system, we relate the density perturbation to the potential. The assumption of quasi-neutrality implies $n_{i1} = n_{e1}$, where $n_{e1}$ is the perturbed electron density. For isothermal, adiabatic electrons, the density perturbation follows the Boltzmann relation:\n$$ \\frac{n_{e1}}{n_{0}} = \\frac{e\\phi}{T_{e}} $$\nwhere $e$ is the elementary charge and $T_e$ is the constant electron temperature. Substituting $n_{i1} = n_{e1} = n_{0}\\frac{e\\phi}{T_{e}}$ into the ion equation:\n$$ \\frac{\\partial}{\\partial t}\\left(n_{0}\\frac{e\\phi}{T_{e}}\\right) - \\frac{1}{B} \\frac{\\partial n_{0}}{\\partial x} \\frac{\\partial\\phi}{\\partial y} = 0 $$\nSince $n_{0}$ is an equilibrium quantity independent of time, and $\\phi$ is independent of $x$, we can write:\n$$ n_{0}\\frac{e}{T_{e}}\\frac{\\partial\\phi}{\\partial t} - \\frac{1}{B} \\frac{\\partial n_{0}}{\\partial x} \\frac{\\partial\\phi}{\\partial y} = 0 $$\nDividing by $n_{0}\\frac{e}{T_{e}}$ yields the linear evolution equation for $\\phi(y,t)$:\n$$ \\frac{\\partial\\phi}{\\partial t} - \\frac{T_{e}}{eB} \\left(\\frac{1}{n_{0}}\\frac{\\partial n_{0}}{\\partial x}\\right) \\frac{\\partial\\phi}{\\partial y} = 0 $$\nThis is a first-order hyperbolic PDE. We define the characteristic drift-wave velocity $v_{*}$ as:\n$$ v_{*} \\equiv -\\frac{T_{e}}{eB} \\frac{1}{n_{0}}\\frac{\\partial n_{0}}{\\partial x} $$\nThe equation simplifies to the classic advection equation:\n$$ \\frac{\\partial\\phi}{\\partial t} + v_{*} \\frac{\\partial\\phi}{\\partial y} = 0 $$\nTo find the continuum dispersion relation, we substitute a plane-wave solution $\\phi(y,t) = \\phi_{0} \\exp[i(k_{y}y - \\omega t)]$ into the equation:\n$$ -i\\omega \\phi + v_{*} (ik_{y}) \\phi = 0 $$\nThis gives the exact dispersion relation: $\\omega = k_{y}v_{*}$.\n\nNext, we discretize the spatial derivative $\\frac{\\partial\\phi}{\\partial y}$ using a second-order central finite difference on a uniform grid $y_{j} = j \\Delta y$:\n$$ \\left. \\frac{\\partial\\phi}{\\partial y} \\right|_{y_j} \\approx \\frac{\\phi(y_{j+1},t) - \\phi(y_{j-1},t)}{2\\Delta y} = \\frac{\\phi_{j+1}(t) - \\phi_{j-1}(t)}{2\\Delta y} $$\nApplying this to the PDE gives the semi-discrete system of ordinary differential equations (method of lines):\n$$ \\frac{d\\phi_{j}}{dt} + v_{*} \\left(\\frac{\\phi_{j+1} - \\phi_{j-1}}{2\\Delta y}\\right) = 0 $$\nTo find the numerical dispersion relation, we substitute a grid-level plane-wave solution $\\phi_{j}(t) = \\tilde{\\phi} \\exp[i(k_{y}j\\Delta y - \\omega_{\\mathrm{num}}t)]$:\n$$ -i\\omega_{\\mathrm{num}}\\phi_{j} + v_{*} \\left(\\frac{\\phi_{j}e^{ik_{y}\\Delta y} - \\phi_{j}e^{-ik_{y}\\Delta y}}{2\\Delta y}\\right) = 0 $$\nCanceling $\\phi_{j}$ and multiplying by $i$ gives:\n$$ \\omega_{\\mathrm{num}} = v_{*} \\left(\\frac{e^{ik_{y}\\Delta y} - e^{-ik_{y}\\Delta y}}{2i\\Delta y}\\right) $$\nUsing Euler's formula, $\\sin(x) = \\frac{e^{ix} - e^{-ix}}{2i}$, we obtain the semi-discrete numerical dispersion relation:\n$$ \\omega_{\\mathrm{num}} = v_{*} \\frac{\\sin(k_{y}\\Delta y)}{\\Delta y} $$\nThe phase speed of the exact wave is $c_{\\mathrm{exact}} = \\frac{\\omega}{k_{y}} = \\frac{k_{y}v_{*}}{k_{y}} = v_{*}$.\nThe phase speed of the semi-discrete numerical wave is $c_{\\mathrm{num}} = \\frac{\\omega_{\\mathrm{num}}}{k_{y}} = \\frac{v_{*}}{\\Delta y k_{y}}\\sin(k_{y}\\Delta y) = v_{*} \\frac{\\sin(k_{y}\\Delta y)}{k_{y}\\Delta y}$.\nThe relative phase error is defined as $\\varepsilon_{\\phi}(\\Delta y) = \\frac{c_{\\mathrm{num}}}{c_{\\mathrm{exact}}} - 1$:\n$$ \\varepsilon_{\\phi}(\\Delta y) = \\frac{v_{*} \\frac{\\sin(k_{y}\\Delta y)}{k_{y}\\Delta y}}{v_{*}} - 1 $$\nThis simplifies to the final closed-form expression for the relative phase error:\n$$ \\varepsilon_{\\phi}(\\Delta y) = \\frac{\\sin(k_{y}\\Delta y)}{k_{y}\\Delta y} - 1 $$\nThis expression quantifies the numerical dispersion error introduced by the second-order central difference scheme as a function of the product of the wavenumber $k_y$ and the grid spacing $\\Delta y$.",
            "answer": "$$\\boxed{\\frac{\\sin(k_{y} \\Delta y)}{k_{y} \\Delta y} - 1}$$"
        }
    ]
}