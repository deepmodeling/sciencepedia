{
    "hands_on_practices": [
        {
            "introduction": "在聚变等离子体中，温度分布的刚性是一个核心特征，它决定了系统如何响应外部加热。本练习通过一个简化的零维能量平衡模型，让您亲手计算稳态下的温度梯度。您将通过求解加热功率与输运热流之间的平衡关系，确定系统的平衡点并分析其稳定性，从而深刻理解“梯度钳位”（gradient clamping）这一关键现象 。",
            "id": "4185851",
            "problem": "考虑环形等离子体中的单个磁通量面，该等离子体具有指定的、恒定的外部加热功率密度 $P$（单位为 Gyro-Bohm (GB) 单位），以及局域无量纲温度梯度 $G \\equiv R/L_T$，其中 $R$ 是大半径，$L_T \\equiv -T/\\nabla T$ 是温度标长。假设一个简化的局域能量平衡模型，其中梯度根据 $C\\, dG/dt = P - Q(G)$ 演化，其中 $C>0$ 是单位体积的有效热容，$Q(G)$ 是作为 $G$ 函数的向外热通量（单位为 GB）。总通量是新经典基线和在临界梯度 $G_c$ 之上启动的湍流驱动贡献之和：\n$$\nQ(G) \\;=\\; \\chi_{\\mathrm{neo}}\\, G \\;+\\; \\chi_{\\mathrm{t}}\\, \\bigl(G - G_c\\bigr)^{2}\\, H\\!\\bigl(G - G_c\\bigr),\n$$\n其中 $\\chi_{\\mathrm{neo}}>0$ 和 $\\chi_{\\mathrm{t}}>0$ 是常数，$H(x)$ 是 Heaviside 阶跃函数。取参数 $\\chi_{\\mathrm{neo}} = 0.8$（GB 单位）、$\\chi_{\\mathrm{t}} = 200$（GB 单位）、$G_c = 4.6$ 和 $P = 12$（GB 单位）。\n\n从第一性原理出发，通过求解 $P = Q(G)$ 来确定平衡分支，并通过分析平衡点处的 $dQ/dG$ 来评估每个分支的线性稳定性。定义梯度钳制为：当平衡梯度对加热功率变化的敏感度在平衡点处满足 $dG/dP \\le 2 \\times 10^{-2}$ 时，即认为梯度被钳制。计算稳定平衡梯度 $G^{\\ast}$，并确定它是否满足钳制判据。报告被钳制的平衡梯度 $G^{\\ast}$（以无量纲 $R/L_T$ 形式）。将最终答案四舍五入至四位有效数字。",
            "solution": "将首先提取给定信息，然后检查其科学依据、一致性和完整性，从而验证该问题。\n\n### 第1步：提取已知条件\n已知条件如下：\n- 能量平衡模型：$C\\, dG/dt = P - Q(G)$，其中 $C>0$。\n- 无量纲温度梯度：$G \\equiv R/L_T$。\n- 外部加热功率密度：$P = 12$（Gyro-Bohm 单位）。\n- 热通量模型 $Q(G)$:\n$$\nQ(G) = \\chi_{\\mathrm{neo}}\\, G + \\chi_{\\mathrm{t}}\\, \\bigl(G - G_c\\bigr)^{2}\\, H\\!\\bigl(G - G_c\\bigr)\n$$\n- 模型参数:\n  - 新经典输运系数：$\\chi_{\\mathrm{neo}} = 0.8$（GB 单位）。\n  - 湍流输运系数：$\\chi_{\\mathrm{t}} = 200$（GB 单位）。\n  - 临界梯度：$G_c = 4.6$。\n- Heaviside 阶跃函数：当 $x \\ge 0$ 时 $H(x) = 1$，当 $x  0$ 时 $H(x) = 0$。\n- 梯度钳制判据：在平衡点处 $dG/dP \\le 2 \\times 10^{-2}$。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题提出了一个简化的、但标准的零维（$0$D）输运模型，用于等离子体物理学中研究存在湍流时温度剖面的刚度。湍流热通量的临界梯度模型是聚变等离子体中现代输运理论的基石。给定方程 $C\\, dG/dt = P - Q$ 是一个基本的能量平衡方程。$Q(G)$ 的形式和给定参数在 Gyro-Bohm 归一化方案中是物理上合理的。平衡、稳定性和输运刚度（$dQ/dG$）的概念是该领域的核心。该问题在科学上是合理的。\n- **良构性**：问题陈述清晰，提供了所有必要的参数和定义。它要求计算平衡点、其稳定性，并评估一个特定的判据（$dG/dP$）。这种结构导向一个唯一、稳定且有意义的解。\n- **客观性**：该问题用精确、客观的语言和数学表达式表述，没有任何主观或基于观点的陈述。\n\n### 第3步：结论和行动\n该问题有效。它具有科学依据，是良构的、客观的。将提供完整的解答。\n\n### 解答\n\n解答过程分为四个阶段：\n1.  通过求解稳态能量平衡方程，确定梯度 $G$ 的平衡分支。\n2.  评估每个平衡分支的线性稳定性。\n3.  对稳定平衡点评估钳制判据。\n4.  报告稳定、被钳制的平衡梯度 $G^{\\ast}$ 的最终值。\n\n**1. 平衡分支的确定**\n\n平衡态由条件 $dG/dt = 0$ 定义。根据给定的能量平衡模型，这意味着加热功率 $P$ 必须与向外的热通量 $Q(G)$ 相平衡：\n$$\nP = Q(G)\n$$\n代入给定值和 $Q(G)$ 的表达式：\n$$\n12 = 0.8\\, G + 200\\, (G - 4.6)^{2}\\, H(G - 4.6)\n$$\n我们必须在由 Heaviside 函数 $H(G - G_c)$ 定义的两种情况下分析此方程。\n\n- **情况1：亚临界梯度 ($G \\le G_c$)**\n在这种情况下，$G \\le 4.6$，这意味着 $G - G_c \\le 0$ 且 $H(G - 4.6) = 0$。湍流通量项消失，方程简化为新经典平衡：\n$$\n12 = 0.8\\, G\n$$\n求解 $G$ 得：\n$$\nG = \\frac{12}{0.8} = 15\n$$\n这个解 $G=15$ 与本情况的初始假设 $G \\le 4.6$ 相矛盾。因此，在亚临界区没有平衡解。\n\n- **情况2：超临界梯度 ($G > G_c$)**\n在这种情况下，$G > 4.6$，这意味着 $G - G_c > 0$ 且 $H(G - 4.6) = 1$。完整的热通量模型适用：\n$$\n12 = 0.8\\, G + 200\\, (G - 4.6)^{2}\n$$\n这是一个关于 $G$ 的二次方程。我们将其展开并整理成标准形式 $aG^2 + bG + c = 0$。\n$$\n12 = 0.8\\, G + 200\\, (G^2 - 9.2\\, G + 21.16)\n$$\n$$\n12 = 0.8\\, G + 200\\, G^2 - 1840\\, G + 4232\n$$\n$$\n200\\, G^2 + (0.8 - 1840)\\, G + (4232 - 12) = 0\n$$\n$$\n200\\, G^2 - 1839.2\\, G + 4220 = 0\n$$\n我们使用二次公式 $G = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个二次方程，其中 $a=200$, $b=-1839.2$, $c=4220$。\n判别式为：\n$$\n\\Delta = b^2 - 4ac = (-1839.2)^2 - 4(200)(4220) = 3382656.64 - 3376000 = 6656.64\n$$\n根是：\n$$\nG = \\frac{1839.2 \\pm \\sqrt{6656.64}}{2(200)} = \\frac{1839.2 \\pm 81.588231}{400}\n$$\n这产生两个可能的解：\n$$\nG_1 = \\frac{1839.2 + 81.588231}{400} = \\frac{1920.788231}{400} \\approx 4.80197\n$$\n$$\nG_2 = \\frac{1839.2 - 81.588231}{400} = \\frac{1757.611769}{400} \\approx 4.39403\n$$\n我们必须根据本情况的假设 $G > 4.6$ 来检查这些解。\n- $G_1 \\approx 4.80197$ 大于 $4.6$，因此它是一个有效的物理平衡点。\n- $G_2 \\approx 4.39403$ 小于 $4.6$，这与假设相矛盾。这个根是将通量的二次形式扩展到其无效区域而产生的人为结果，因此不是一个物理平衡点。\n\n因此，只有一个物理平衡点，$G^{\\ast} \\approx 4.80197$。\n\n**2. 稳定性分析**\n\n平衡点 $G^{\\ast}$ 的稳定性通过分析对微小扰动 $\\delta G(t) = G(t) - G^{\\ast}$ 的响应来确定。演化方程变为：\n$$\nC \\frac{d(\\delta G)}{dt} = P - Q(G^{\\ast} + \\delta G)\n$$\n对于小扰动，我们可以在 $G^{\\ast}$ 附近将 $Q(G)$ 线性化：$Q(G^{\\ast} + \\delta G) \\approx Q(G^{\\ast}) + \\frac{dQ}{dG}\\bigg|_{G^{\\ast}} \\delta G$。\n由于在平衡点处 $P = Q(G^{\\ast})$，方程简化为：\n$$\nC \\frac{d(\\delta G)}{dt} = - \\left( \\frac{dQ}{dG}\\bigg|_{G^{\\ast}} \\right) \\delta G\n$$\n为了使平衡是稳定的，扰动必须衰减，这要求右侧的系数为负。由于 $C > 0$，稳定性要求：\n$$\n\\frac{dQ}{dG}\\bigg|_{G^{\\ast}}  0\n$$\n对于 $G > G_c$，热通量 $Q(G)$ 的导数为：\n$$\n\\frac{dQ}{dG} = \\frac{d}{dG} \\left[ \\chi_{\\mathrm{neo}}\\, G + \\chi_{\\mathrm{t}}\\, (G - G_c)^{2} \\right] = \\chi_{\\mathrm{neo}} + 2\\, \\chi_{\\mathrm{t}}\\, (G - G_c)\n$$\n我们在平衡点 $G^{\\ast} \\approx 4.80197$ 处评估这个“输运刚度”：\n$$\n\\frac{dQ}{dG}\\bigg|_{G^{\\ast}} = 0.8 + 2(200)(4.80197 - 4.6) = 0.8 + 400(0.20197) = 0.8 + 80.788 = 81.588\n$$\n由于 $\\frac{dQ}{dG}\\bigg|_{G^{\\ast}} \\approx 81.588  0$，平衡点 $G^{\\ast} \\approx 4.80197$ 是线性稳定的。\n\n**3. 梯度钳制判据**\n\n该问题将梯度钳制定义为平衡梯度对加热功率的敏感度 $dG/dP$ 很小的条件：\n$$\n\\frac{dG}{dP} \\le 2 \\times 10^{-2}\n$$\n为了求出 $dG/dP$，我们对平衡条件 $P = Q(G)$ 关于 $P$ 求导，将 $G$ 视为 $P$ 的函数：\n$$\n\\frac{d}{dP}(P) = \\frac{d}{dP}(Q(G(P)))\n$$\n在右侧使用链式法则：\n$$\n1 = \\frac{dQ}{dG} \\frac{dG}{dP}\n$$\n因此，敏感度是输运刚度的倒数：\n$$\n\\frac{dG}{dP} = \\left(\\frac{dQ}{dG}\\right)^{-1}\n$$\n使用稳定性分析中计算出的值：\n$$\n\\frac{dG}{dP}\\bigg|_{G^{\\ast}} = \\frac{1}{81.588} \\approx 0.0122567\n$$\n我们现在将此值与钳制判据进行比较：\n$$\n0.0122567 \\le 2 \\times 10^{-2} \\quad \\implies \\quad 0.0122567 \\le 0.02\n$$\n该不等式成立。因此，稳定平衡梯度 $G^{\\ast}$ 满足钳制判据。\n\n**4. 最终答案**\n\n稳定、被钳制的平衡梯度为 $G^{\\ast} \\approx 4.80197$。将其四舍五入至四位有效数字得到 $4.802$。",
            "answer": "$$ \\boxed{4.802} $$"
        },
        {
            "introduction": "湍流输运的非线性阈值为何常常高于线性不稳定性阈值？本练习将带您通过一个唯象模型来探索著名的“迪米兹上移”（Dimits shift）现象的物理机制。您将通过编程实现一个包含线性驱动、纬向流抑制和输运刚性的简化模型，定量地研究纬向流是如何非线性地抬高湍流触发的临界梯度 。",
            "id": "4185910",
            "problem": "您的任务是设计并实现一个独立的数值实验，通过在固定的归一化拉莫尔半径 $\\rho_*$ 和归一化碰撞率 $\\nu_*$ 条件下，扫描归一化离子温度梯度 $R/L_{T_i}$，来量化离子温度梯度驱动湍流的 Dimits 移动。目标是提取一个非线性阈值范围，在该范围内，由于纬向流的调节作用，湍流热通量保持为零或可忽略不计，从而在一个简化的降阶模型中量化 Dimits 移动。\n\n从以下在回旋动理学湍流降阶模型中广泛使用的基本物理基础和假设出发：\n\n1. 离子温度梯度（ITG）线性稳定性：在临界稳定性附近，最不稳定模式的最大线性增长率随其与临界梯度的距离近似线性增长，因此线性增长率可表示为 $ \\gamma_L(R/L_{T_i}) = s \\cdot \\max\\{0, R/L_{T_i} - (R/L_{T_i})_{\\mathrm{lin}}\\} $，其中 $s$ 是一个为正的常数斜率，$(R/L_{T_i})_{\\mathrm{lin}}$ 是线性临界梯度。\n\n2. 纬向流调节与 Dimits 移动：纬向流由次级不稳定性驱动，并剪切湍流涡旋，当纬向流剪切率超过线性增长率时，湍流被抑制。作为一个与回旋动理学中观察到的标度趋势一致的最小模型，我们假设纬向流剪切率与 $\\rho_*$ 成反比，并因碰撞率而减小，即 $ \\gamma_{\\mathrm{ZF}} = C_{\\mathrm{ZF}} / (\\rho_* [1 + C_\\nu \\nu_*]) $，其中 $C_{\\mathrm{ZF}}$ 和 $C_\\nu$ 是正常数。当 $\\gamma_L \\le \\gamma_{\\mathrm{ZF}}$ 时，湍流被抑制，这导致了有限输运出现的非线性上移。\n\n3. 输运刚度闭合：在一个混合长度闭合模型中，湍流热通量 $Q_{\\mathrm{turb}}$ 与在纬向流剪切作用下剩余的净正增长率的正幂次成标度关系。将其建模为 $ Q_{\\mathrm{turb}} = K_Q \\cdot (\\max\\{0, \\gamma_L - \\gamma_{\\mathrm{ZF}}\\})^p $，其中常数 $K_Q  0$ 且 $p \\ge 1$。当 $p  1$ 时，此模型体现了输运刚度。\n\n您的程序必须实现以下实验设计和测量协议：\n\n- 对于每个测试用例，在指定的范围内以给定的步长均匀扫描 $R/L_{T_i}$。\n- 使用下面提供的固定常数 $s$、$C_{\\mathrm{ZF}}$、$C_\\nu$、$K_Q$ 和 $p$，根据上述模型计算 $Q_{\\mathrm{turb}}(R/L_{T_i}; \\rho_*, \\nu_*)$。\n- 将估计的非线性阈值 $(R/L_{T_i})_{\\mathrm{nl}}$ 定义为扫描中使 $Q_{\\mathrm{turb}} \\ge \\epsilon$ 的最小 $R/L_{T_i}$ 值，其中 $\\epsilon$ 是一个代表“可忽略”通量的小阈值。如果在扫描范围内不存在这样的 $R/L_{T_i}$，则将 $(R/L_{T_i})_{\\mathrm{nl}}$ 报告为扫描范围的上限。\n- 将 Dimits 移动定义为 $\\Delta_{\\mathrm{Dimits}} = (R/L_{T_i})_{\\mathrm{nl}} - (R/L_{T_i})_{\\mathrm{lin}}$。\n\n在您的实现中使用以下固定的模型参数：\n- $s = 1.0$,\n- $C_{\\mathrm{ZF}} = 0.01$,\n- $C_\\nu = 5.0$,\n- $K_Q = 1.0$,\n- $p = 2$.\n\n所有量均为无量纲。\n\n测试套件：\n您的程序必须为以下每一组参数计算 $\\Delta_{\\mathrm{Dimits}}$，每组参数由一个元组 $(\\rho_*, \\nu_*, (R/L_{T_i})_{\\mathrm{lin}}, (R/L_{T_i})_{\\min}, (R/L_{T_i})_{\\max}, \\Delta(R/L_{T_i}), \\epsilon)$ 描述：\n\n1. 用例 A（中等 $\\rho_*$，低 $\\nu_*$，明显的非线性上移）：\n   - $\\rho_* = 0.003$，$\\nu_* = 0.02$，$(R/L_{T_i})_{\\mathrm{lin}} = 4.5$，$(R/L_{T_i})_{\\min} = 3.5$，$(R/L_{T_i})_{\\max} = 9.0$，$\\Delta(R/L_{T_i}) = 0.05$，$\\epsilon = 0.001$。\n\n2. 用例 B（较大 $\\rho_*$，中等 $\\nu_*$，减小的上移）：\n   - $\\rho_* = 0.01$，$\\nu_* = 0.1$，$(R/L_{T_i})_{\\mathrm{lin}} = 4.5$，$(R/L_{T_i})_{\\min} = 3.5$，$(R/L_{T_i})_{\\max} = 9.0$，$\\Delta(R/L_{T_i}) = 0.05$，$\\epsilon = 0.001$。\n\n3. 用例 C（中等 $\\rho_*$，高 $\\nu_*$，较小的上移）：\n   - $\\rho_* = 0.005$，$\\nu_* = 2.0$，$(R/L_{T_i})_{\\mathrm{lin}} = 4.5$，$(R/L_{T_i})_{\\min} = 3.5$，$(R/L_{T_i})_{\\max} = 9.0$，$\\Delta(R/L_{T_i}) = 0.05$，$\\epsilon = 0.001$。\n\n4. 用例 D（极小 $\\rho_*$，零 $\\nu_*$，上移超出扫描窗口）：\n   - $\\rho_* = 0.001$，$\\nu_* = 0.0$，$(R/L_{T_i})_{\\mathrm{lin}} = 3.0$，$(R/L_{T_i})_{\\min} = 2.0$，$(R/L_{T_i})_{\\max} = 12.0$，$\\Delta(R/L_{T_i}) = 0.05$，$\\epsilon = 0.001$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来、以逗号分隔的结果列表，顺序为 [用例 A, 用例 B, 用例 C, 用例 D]，其中每个条目是计算出的、四舍五入到三位小数的 $\\Delta_{\\mathrm{Dimits}}$。例如，形式为 $[3.100,0.700,0.250,9.000]$ 的输出是可以接受的。不应打印任何其他文本。",
            "solution": "我们概述一个基于原理的推导，它将临界梯度行为、纬向流调节和输运刚度的最简物理模型与一个用于从数值参数扫描中提取 Dimits 移动的算法联系起来。\n\n第一性原理与降阶模型假设：\n\n1. 临界状态附近的线性驱动。在离子温度梯度（ITG）湍流中，自由能源是离子温度梯度。在线性临界梯度 $(R/L_{T_i})_{\\mathrm{lin}}$ 附近，最不稳定的线性模式的增长率随其超过阈值的距离近似线性增加。这是线性回旋动理学和围绕临界状态的双尺度展开的标准结果。我们将其表示为\n$$\n\\gamma_L(R/L_{T_i}) = s \\, \\max\\{0,\\; R/L_{T_i} - (R/L_{T_i})_{\\mathrm{lin}}\\},\n$$\n其中 $s0$ 是一个斜率，它将梯度增量转换为增长率增量。这捕捉了在 $R/L_{T_i}=(R/L_{T_i})_{\\mathrm{lin}}$ 处不稳定性的开始以及此后成比例的增加。\n\n2. 纬向流抑制与 Dimits 移动。纬向流是在极向和环向模数 $(m,n)=(0,0)$ 处的 $E\\times B$ 剪切流，它们通过次级和三级过程从湍流雷诺胁强中获取自由能。在 Dimits 区，这些纬向流被高效地生成且阻尼很弱，从而产生湍流涡旋的剪切退相干。当纬向流剪切率超过线性增长率时，即\n$$\n\\gamma_{\\mathrm{ZF}} \\gtrsim \\gamma_L,\n$$\n抑制就会发生，因此湍流的有效增长率降至零。Dimits 移动是相对于线性临界点，输运出现的非线性上移。与标准回旋动理学趋势一致的纬向流剪切率的降阶标度关系包括以下几点：\n- 由于尺度分离增强，$\\rho_*$ 越小，剪切越强：$\\gamma_{\\mathrm{ZF}} \\propto 1/\\rho_*$。\n- 削弱纬向流的碰撞阻尼：随着 $\\nu_*$ 的增加，$\\gamma_{\\mathrm{ZF}}$ 减小。\n我们采用最简形式\n$$\n\\gamma_{\\mathrm{ZF}} = \\frac{C_{\\mathrm{ZF}}}{\\rho_* \\, \\big(1 + C_\\nu \\nu_*\\big)},\n$$\n其中 $C_{\\mathrm{ZF}}0$ 和 $C_\\nu0$ 是模型常数。这个标度关系捕捉了已确立的 Dimits 移动对 $\\rho_*$ 和 $\\nu_*$ 的敏感性：当 $\\rho_*$ 和 $\\nu_*$ 较小时，移动较大；随着碰撞率的增加，移动减小。\n\n3. 输运刚度闭合。本着混合长度的精神，湍流热扩散系数 $\\chi_t$ 与相关长度的平方乘以退相干率成标度关系。使用有效增长率\n$$\n\\gamma_{\\mathrm{eff}} = \\max\\{0, \\gamma_L - \\gamma_{\\mathrm{ZF}}\\},\n$$\n并将尺度因子吸收到一个系数中，离子湍流热通量的一个唯象闭合模型为\n$$\nQ_{\\mathrm{turb}} = K_Q \\, \\gamma_{\\mathrm{eff}}^p,\n$$\n其中 $K_Q0$ 且 $p\\ge 1$。选择 $p=2$ 体现了在回旋动理学模拟中观察到的输运刚度，即一旦抑制消失，通量便迅速增加。此形式遵循了当 $\\gamma_{\\mathrm{eff}}=0$ 时 $Q_{\\mathrm{turb}}=0$ 的规律。\n\n测量 Dimits 移动：\n\n- 非线性输运阈值 $(R/L_{T_i})_{\\mathrm{nl}}$ 是使得 $Q_{\\mathrm{turb}} \\ge \\epsilon$ 的最小 $R/L_{T_i}$，其中 $\\epsilon0$ 是一个预设的、代表可忽略热通量阈值的小量。离散扫描的间距决定了分辨率。\n- Dimits 移动为\n$$\n\\Delta_{\\mathrm{Dimits}} = (R/L_{T_i})_{\\mathrm{nl}} - (R/L_{T_i})_{\\mathrm{lin}}.\n$$\n- 如果扫描没有达到 $Q_{\\mathrm{turb}} \\ge \\epsilon$ 的点，则 $(R/L_{T_i})_{\\mathrm{nl}}$ 至少是扫描范围的上限，我们通过取 $(R/L_{T_i})_{\\mathrm{nl}}=(R/L_{T_i})_{\\max}$ 来报告移动的下限。\n\n算法：\n\n1. 固定模型常数 $s$、$C_{\\mathrm{ZF}}$、$C_\\nu$、$K_Q$、$p$ 和一个可忽略的通量底值 $\\epsilon$。\n2. 对于给定的 $(\\rho_*, \\nu_*, (R/L_{T_i})_{\\mathrm{lin}})$ 和一个扫描网格 $R/L_{T_i} \\in [(R/L_{T_i})_{\\min}, (R/L_{T_i})_{\\max}]$，步长为 $\\Delta(R/L_{T_i})$，计算：\n   - $\\gamma_L(R/L_{T_i}) = s \\, \\max\\{0, R/L_{T_i} - (R/L_{T_i})_{\\mathrm{lin}}\\}$,\n   - $\\gamma_{\\mathrm{ZF}} = C_{\\mathrm{ZF}} / (\\rho_* (1 + C_\\nu \\nu_*))$,\n   - $\\gamma_{\\mathrm{eff}} = \\max\\{0, \\gamma_L - \\gamma_{\\mathrm{ZF}}\\}$,\n   - $Q_{\\mathrm{turb}} = K_Q \\, (\\gamma_{\\mathrm{eff}})^p$.\n3. 在网格中找到使 $Q_{\\mathrm{turb}} \\ge \\epsilon$ 的最小 $R/L_{T_i}$，将其定义为 $(R/L_{T_i})_{\\mathrm{nl}}$，并计算 $\\Delta_{\\mathrm{Dimits}}$。\n4. 如果没有满足条件的点，则设置 $(R/L_{T_i})_{\\mathrm{nl}} = (R/L_{T_i})_{\\max}$ 并计算对应的 $\\Delta_{\\mathrm{Dimits}}$ 下限。\n\n使用指定的常数 $s=1.0$、$C_{\\mathrm{ZF}}=0.01$、$C_\\nu=5.0$、$K_Q=1.0$、$p=2$ 和 $\\epsilon=0.001$，各测试用例得出以下推理：\n\n- 用例 A：$\\rho_* = 0.003$，$\\nu_* = 0.02$。那么 $\\gamma_{\\mathrm{ZF}} = 0.01 / (0.003 \\cdot (1 + 5 \\cdot 0.02)) = 0.01 / (0.003 \\cdot 1.1) \\approx 3.0303$。线性阈值为 $(R/L_{T_i})_{\\mathrm{lin}}=4.5$。步长为 $\\Delta(R/L_{T_i})=0.05$ 的离散扫描得出 $(R/L_{T_i})_{\\mathrm{nl}} \\approx 7.6$ 作为第一个满足 $Q_{\\mathrm{turb}} \\ge 0.001$ 的点，因此 $\\Delta_{\\mathrm{Dimits}} \\approx 7.6 - 4.5 = 3.1$。\n\n- 用例 B：$\\rho_* = 0.01$，$\\nu_* = 0.1$。那么 $\\gamma_{\\mathrm{ZF}} = 0.01 / (0.01 \\cdot (1 + 5 \\cdot 0.1)) = 0.01 / (0.01 \\cdot 1.5) = 0.6667$。第一个超过通量底值的点出现在 $(R/L_{T_i})_{\\mathrm{nl}} \\approx 5.2$ 处，得出 $\\Delta_{\\mathrm{Dimits}} \\approx 0.7$。\n\n- 用例 C：$\\rho_* = 0.005$，$\\nu_* = 2.0$。那么 $\\gamma_{\\mathrm{ZF}} = 0.01 / (0.005 \\cdot (1 + 5 \\cdot 2.0)) = 0.01 / (0.005 \\cdot 11) \\approx 0.1818$。扫描解析出 $(R/L_{T_i})_{\\mathrm{nl}} \\approx 4.75$，得出 $\\Delta_{\\mathrm{Dimits}} \\approx 0.25$。\n\n- 用例 D：$\\rho_* = 0.001$，$\\nu_* = 0.0$。那么 $\\gamma_{\\mathrm{ZF}} = 0.01 / (0.001 \\cdot (1 + 0)) = 10$。当 $(R/L_{T_i})_{\\mathrm{lin}}=3.0$ 且扫描上限为 $(R/L_{T_i})_{\\max}=12.0$ 时，非线性阈值应为 $(R/L_{T_i})_{\\mathrm{lin}} + \\gamma_{\\mathrm{ZF}}/s = 13.0$，这超出了扫描窗口，因此扫描中没有 $R/L_{T_i}$ 能产生 $Q_{\\mathrm{turb}} \\ge \\epsilon$。根据测量协议，报告 $(R/L_{T_i})_{\\mathrm{nl}}=(R/L_{T_i})_{\\max}=12.0$，从而得出下限 $\\Delta_{\\mathrm{Dimits}} = 12.0 - 3.0 = 9.0$。\n\n程序将实现此算法，扫描指定的网格，根据通量准则检测起始点，并按要求的顺序打印一行包含四个移动值（四舍五入到三位小数）的结果。这个过程通过一个最小化的、有物理基础的代理模型和一个可复现的数值实验设计，将 Dimits 移动的概念操作化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_gamma_L(RL, RL_lin, s):\n    # Linear growth rate model near threshold\n    return s * max(0.0, RL - RL_lin)\n\ndef compute_gamma_ZF(rho_star, nu_star, C_ZF, C_nu):\n    # Zonal flow shearing rate scaling with rho_* and nu_*\n    return C_ZF / (rho_star * (1.0 + C_nu * nu_star))\n\ndef compute_Q_turb(gamma_L, gamma_ZF, K_Q, p):\n    # Transport stiffness closure with net positive growth\n    gamma_eff = max(0.0, gamma_L - gamma_ZF)\n    return K_Q * (gamma_eff ** p)\n\ndef dimits_shift_for_case(case, s, C_ZF, C_nu, K_Q, p):\n    rho_star, nu_star, RL_lin, RL_min, RL_max, dRL, eps = case\n    gamma_ZF = compute_gamma_ZF(rho_star, nu_star, C_ZF, C_nu)\n    # Create RL grid including RL_max\n    # Add a small numerical epsilon to include upper bound reliably\n    RL_vals = np.arange(RL_min, RL_max + 0.5 * dRL, dRL)\n    RL_nl = RL_max  # default to upper bound if not found\n    found = False\n    for RL in RL_vals:\n        gL = compute_gamma_L(RL, RL_lin, s)\n        Q = compute_Q_turb(gL, gamma_ZF, K_Q, p)\n        if Q = eps:\n            RL_nl = RL\n            found = True\n            break\n    # Dimits shift definition\n    shift = RL_nl - RL_lin\n    return shift\n\ndef solve():\n    # Fixed model constants\n    s = 1.0\n    C_ZF = 0.01\n    C_nu = 5.0\n    K_Q = 1.0\n    p = 2\n\n    # Define the test cases from the problem statement:\n    # (rho_*, nu_*, RL_lin, RL_min, RL_max, dRL, eps)\n    test_cases = [\n        (0.003, 0.02, 4.5, 3.5, 9.0, 0.05, 0.001),  # Case A\n        (0.01,  0.1,  4.5, 3.5, 9.0, 0.05, 0.001),  # Case B\n        (0.005, 2.0,  4.5, 3.5, 9.0, 0.05, 0.001),  # Case C\n        (0.001, 0.0,  3.0, 2.0, 12.0, 0.05, 0.001)  # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        shift = dimits_shift_for_case(case, s, C_ZF, C_nu, K_Q, p)\n        # Round to three decimals as required\n        results.append(f\"{shift:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "理论模型中的临界梯度和输运刚性等概念，在实际的模拟数据中是如何被测量的？本练习将为您提供模拟的回旋动理学数据，并要求您运用数据拟合技术来推断线性和非线性输运阈值。通过这个实践，您将掌握从“原始”数据中提取关键物理参数的基本方法，并能定量地评估迪米兹漂移的大小 。",
            "id": "4185941",
            "problem": "考虑一个托卡马克类系统中的静电离子温度梯度（ITG）湍流的简化无量纲模型，其中控制参数是由$\\kappa$表示的归一化离子温度梯度。在线性回旋动理学区，主导模式的增长率$\\gamma(\\kappa)$在线性边缘稳定性阈值处改变符号，即$\\gamma(\\kappa_{\\text{lin}})=0$，且在边缘稳定性点附近$\\partial \\gamma/\\partial \\kappa \\neq 0$。在包含自生带状流的完全非线性区，观测到湍流热输运是刚性的，表现出一个上移的非线性阈值$\\kappa_{\\text{NL}}$（通常称为Dimits上移），因此当$\\kappa \\le \\kappa_{\\text{NL}}$时，饱和热通量$Q(\\kappa)$被强烈抑制，而当$\\kappa  \\kappa_{\\text{NL}}$时则迅速上升。Dimits上移可以通过两个无量纲的度量来量化，即比较$\\kappa_{\\text{NL}}$和$\\kappa_{\\text{lin}}$：比值$D = \\kappa_{\\text{NL}} / \\kappa_{\\text{lin}}$和差值$\\Delta = \\kappa_{\\text{NL}} - \\kappa_{\\text{lin}}$。您的任务是，对于下方的每个测试用例，从线性回旋动理学数据中推断$\\kappa_{\\text{lin}}$，从非线性功率扫描数据中推断$\\kappa_{\\text{NL}}$，然后计算$D$和$\\Delta$。\n\n仅使用以下符合第一性原理和经过充分检验的观测结果的、有原则且与模型无关的推断方法：\n- 线性边缘稳定性：在$\\kappa_{\\text{lin}}$附近，最不稳定的线性本征值的实部增长率$\\gamma(\\kappa)$与$\\kappa$近似成仿射关系。通过最小二乘法将$\\gamma(\\kappa)$拟合成关于$\\kappa$的直线，并求解$\\gamma(\\kappa)=0$时的截距来推断$\\kappa_{\\text{lin}}$。\n- 非线性刚性输运的起始：在起始点附近，假设饱和热通量遵循带阈值的幂律形式$Q(\\kappa) \\approx A \\cdot \\max\\{0, \\kappa - \\kappa_{0}\\}^{\\alpha}$，其中$A \\ge 0$且固定指数$\\alpha = 2$，这代表了与强剪切调节一致的超线性起始。通过选择使所有数据点相对于该模型的总最小二乘误差最小化的$\\kappa_{0}$来推断$\\kappa_{\\text{NL}}$，其中系数$A$对每个试验的$\\kappa_{0}$通过最小二乘法进行优化。将$\\kappa_{0}$限制在每个测试的非线性数据集中提供的最小和最大$\\kappa$值所构成的闭区间内。\n\n对于每个测试用例，您将获得两个数据集：\n- 线性数据集：一个由$(\\kappa_{i}, \\gamma_{i})$对组成的列表，表示为两个并行的列表$\\{\\kappa_{i}\\}$和$\\{\\gamma_{i}\\}$。\n- 非线性数据集：一个由$(\\kappa_{j}, Q_{j})$对组成的列表，表示为两个并行的列表$\\{\\kappa_{j}\\}$和$\\{Q_{j}\\}$。\n\n所有量均为无量纲。不需要物理单位。不使用角度。您的程序必须：\n- 对每个测试用例，通过对$\\gamma(\\kappa)$进行最小二乘仿射拟合并评估零点穿越来从线性数据集中推断$\\kappa_{\\text{lin}}$。\n- 对每个测试用例，通过最小化带阈值的二次模型$Q(\\kappa) = A \\cdot \\max\\{0, \\kappa - \\kappa_{0}\\}^{2}$（关于$\\kappa_{0}$和$A \\ge 0$）的最小二乘误差来从非线性数据集中推断$\\kappa_{\\text{NL}}$。\n- 为每个测试用例计算$D = \\kappa_{\\text{NL}} / \\kappa_{\\text{lin}}$和$\\Delta = \\kappa_{\\text{NL}} - \\kappa_{\\text{lin}}$。\n- 将$D$和$\\Delta$四舍五入到恰好三位小数。\n\n测试套件：\n- 测试用例1：\n  - 线性：$\\{\\kappa\\} = [3.5, 4.0, 4.5, 5.0, 5.5]$, $\\{\\gamma\\} = [-0.2, -0.1, 0.0, 0.1, 0.2]$。\n  - 非线性：$\\{\\kappa\\} = [5.0, 5.5, 6.0, 6.3, 6.6, 7.0]$, $\\{Q\\} = [0.0, 0.0, 0.0, 0.0, 0.135, 0.735]$。\n- 测试用例2：\n  - 线性：$\\{\\kappa\\} = [4.0, 4.5, 5.0, 5.5, 6.0]$, $\\{\\gamma\\} = [-0.25, -0.125, 0.0, 0.125, 0.25]$。\n  - 非线性：$\\{\\kappa\\} = [4.5, 5.0, 5.5, 6.0]$, $\\{Q\\} = [0.0, 0.0, 0.5, 2.0]$。\n- 测试用例3：\n  - 线性：$\\{\\kappa\\} = [3.0, 3.5, 3.8, 4.2, 4.6]$, $\\{\\gamma\\} = [-0.144, -0.054, 0.0, 0.072, 0.144]$。\n  - 非线性：$\\{\\kappa\\} = [5.0, 5.5, 6.0, 6.84, 7.2, 7.8]$, $\\{Q\\} = [0.0, 0.0, 0.0, 0.0, 0.15552, 1.10592]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个列表，每个测试用例对应一个条目。每个条目本身必须是一个双元素列表$[D, \\Delta]$，两个数字都四舍五入到恰好三位小数。例如，对于两个假设的用例，一个有效的输出将是“[[1.234,0.567],[1.000,0.000]]”。您的实际输出必须按顺序1、2、3对应于上述三个测试用例。",
            "solution": "用户的问题要求分析来自回旋动理学湍流模拟的模拟数据，以提取与输运刚性相关的关键物理参数。该问题被认为是有效的，因为它在科学上基于既定的聚变等离子体物理原理，问题陈述清晰且可形式化，语言客观。所有必要的数据和模型都已提供，并且该任务是该领域的标准数据分析程序。\n\n对每个测试用例的分析分为两个主要部分：推断线性稳定性阈值$\\kappa_{\\text{lin}}$和推断非线性输运阈值$\\kappa_{\\text{NL}}$。\n\n**1. 线性阈值$\\kappa_{\\text{lin}}$的推断**\n\n问题指出，在边缘稳定性点附近，最不稳定模式的线性增长率$\\gamma$近似为归一化温度梯度$\\kappa$的仿射函数。这与分岔点附近特征值的一般行为一致。我们将此关系建模为：\n$$\n\\gamma(\\kappa) = m\\kappa + c\n$$\n其中$m$和$c$是常数。线性边缘稳定性阈值$\\kappa_{\\text{lin}}$被定义为增长率消失的点，即$\\gamma(\\kappa_{\\text{lin}}) = 0$。求解$\\kappa_{\\text{lin}}$可得：\n$$\n\\kappa_{\\text{lin}} = -\\frac{c}{m}\n$$\n为了从给定的线性数据集（由$(\\kappa_i, \\gamma_i)$对组成）中确定参数$m$和$c$，我们执行线性最小二乘回归。该过程最小化观测增长率$\\gamma_i$与仿射模型预测值之间的平方差之和。对于一个包含$N$个点的数据集，我们最小化误差$E = \\sum_{i=1}^{N} (\\gamma_i - (m\\kappa_i + c))^2$。计算出最优参数$m$和$c$，并由此确定$\\kappa_{\\text{lin}}$。在实现中，这可以通过使用像`numpy.polyfit`这样次数为1的函数来高效处理。\n\n**2. 非线性阈值$\\kappa_{\\text{NL}}$的推断**\n\n问题使用带阈值的幂律模型来描述刚性湍流输运的起始，该模型表示饱和热通量$Q$是$\\kappa$的函数：\n$$\nQ(\\kappa) \\approx A \\, \\max\\{0, \\kappa - \\kappa_{0}\\}^{\\alpha}\n$$\n问题指定指数$\\alpha=2$，这代表了由强带状流剪切调节的湍流的超线性起始特性。我们的任务是找到非线性阈值$\\kappa_{\\text{NL}}$，它在模型中被确定为参数$\\kappa_0$。\n\n从非线性数据集（由$(\\kappa_j, Q_j)$对组成）推断$\\kappa_0$（以及幅度$A$）是一个非线性最小二乘问题。问题指定的一种标准方法是，对最优的$\\kappa_0$进行一维搜索。对于任何给定的试验值$\\kappa_0$，模型相对于幅度$A$是线性的。我们定义一个新的自变量$X_j(\\kappa_0) = \\max\\{0, \\kappa_j - \\kappa_0\\}^2$。模型则变为$Q_j \\approx A X_j(\\kappa_0)$。\n\n对于固定的$\\kappa_0$，我们可以通过求解$\\partial S / \\partial A = 0$来找到最小化残差平方和$S = \\sum_j (Q_j - A X_j(\\kappa_0))^2$的最优幅度$A_{opt}$。这会得到系数$A$的标准线性最小二乘解：\n$$\nA_{opt}(\\kappa_0) = \\frac{\\sum_j Q_j X_j(\\kappa_0)}{\\sum_j (X_j(\\kappa_0))^2} = \\frac{\\vec{Q} \\cdot \\vec{X}(\\kappa_0)}{\\vec{X}(\\kappa_0) \\cdot \\vec{X}(\\kappa_0)}\n$$\n问题约束$A \\ge 0$。由于观测到的热通量$Q_j$是非负的，并且基函数$X_j(\\kappa_0)$根据其构造也是非负的，因此计算出的$A_{opt}$也将是非负的。\n\n通过将$A_{opt}(\\kappa_0)$代回到平方和的表达式中，我们得到给定$\\kappa_0$的最小误差，该误差仅是$\\kappa_0$的函数：\n$$\nE(\\kappa_0) = \\sum_j (Q_j - A_{opt}(\\kappa_0) X_j(\\kappa_0))^2\n$$\n非线性阈值$\\kappa_{\\text{NL}}$就是使该误差函数$E(\\kappa_0)$最小化的$\\kappa_0$值。此最小值的搜索在指定的闭区间$[\\min\\{\\kappa_j\\}, \\max\\{\\kappa_j\\}]$内进行。这种一维有界最小化是使用`scipy.optimize.minimize_scalar`进行数值计算的。\n\n**3. Dimits上移度量的计算**\n\n一旦为给定的测试用例推断出$\\kappa_{\\text{lin}}$和$\\kappa_{\\text{NL}}$，用于量化Dimits上移的两个无量纲度量计算如下：\n- 比值：$D = \\kappa_{\\text{NL}} / \\kappa_{\\text{lin}}$\n- 差值：$\\Delta = \\kappa_{\\text{NL}} - \\kappa_{\\text{lin}}$\n\n然后按要求将这些值四舍五入到三位小数。整个过程将应用于所提供的每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the problem of inferring linear and nonlinear thresholds\n    from gyrokinetic data and computes the Dimits upshift metrics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"linear\": {\n                \"kappa\": [3.5, 4.0, 4.5, 5.0, 5.5],\n                \"gamma\": [-0.2, -0.1, 0.0, 0.1, 0.2]\n            },\n            \"nonlinear\": {\n                \"kappa\": [5.0, 5.5, 6.0, 6.3, 6.6, 7.0],\n                \"Q\": [0.0, 0.0, 0.0, 0.0, 0.135, 0.735]\n            }\n        },\n        {\n            \"linear\": {\n                \"kappa\": [4.0, 4.5, 5.0, 5.5, 6.0],\n                \"gamma\": [-0.25, -0.125, 0.0, 0.125, 0.25]\n            },\n            \"nonlinear\": {\n                \"kappa\": [4.5, 5.0, 5.5, 6.0],\n                \"Q\": [0.0, 0.0, 0.5, 2.0]\n            }\n        },\n        {\n            \"linear\": {\n                \"kappa\": [3.0, 3.5, 3.8, 4.2, 4.6],\n                \"gamma\": [-0.144, -0.054, 0.0, 0.072, 0.144]\n            },\n            \"nonlinear\": {\n                \"kappa\": [5.0, 5.5, 6.0, 6.84, 7.2, 7.8],\n                \"Q\": [0.0, 0.0, 0.0, 0.0, 0.15552, 1.10592]\n            }\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # --- 1. Infer linear threshold kappa_lin ---\n        k_lin_data = np.array(case[\"linear\"][\"kappa\"])\n        g_lin_data = np.array(case[\"linear\"][\"gamma\"])\n        \n        # Fit gamma(kappa) = m*kappa + c\n        m, c = np.polyfit(k_lin_data, g_lin_data, 1)\n        \n        # kappa_lin is found where gamma = 0, so m*k_lin + c = 0\n        kappa_lin = -c / m\n\n        # --- 2. Infer nonlinear threshold kappa_NL ---\n        k_nl_data = np.array(case[\"nonlinear\"][\"kappa\"])\n        q_nl_data = np.array(case[\"nonlinear\"][\"Q\"])\n\n        def cost_function(kappa_0, kappa_vals, q_vals):\n            \"\"\"\n            Calculates the least-squares error for a given threshold kappa_0.\n            \"\"\"\n            # Model basis function: X = max(0, kappa - kappa_0)^2\n            X = np.maximum(0, kappa_vals - kappa_0)**2\n            \n            # Solve for the optimal amplitude A = 0 via linear least squares\n            # A = (Q . X) / (X . X)\n            x_dot_x = np.dot(X, X)\n            \n            if x_dot_x  1e-15: # Handles cases where all kappa  kappa_0\n                A = 0.0\n            else:\n                q_dot_x = np.dot(q_vals, X)\n                A = q_dot_x / x_dot_x\n\n            # Calculate residuals and sum of squares error\n            q_predicted = A * X\n            residuals = q_vals - q_predicted\n            error = np.dot(residuals, residuals)\n            \n            return error\n\n        # Search for kappa_0 that minimizes the cost function\n        search_bounds = (k_nl_data.min(), k_nl_data.max())\n        \n        opt_result = minimize_scalar(\n            cost_function,\n            bounds=search_bounds,\n            args=(k_nl_data, q_nl_data),\n            method='bounded'\n        )\n        \n        kappa_nl = opt_result.x\n\n        # --- 3. Compute metrics D and Delta ---\n        D = kappa_nl / kappa_lin\n        Delta = kappa_nl - kappa_lin\n\n        results.append((D, Delta))\n\n    # --- 4. Format and print final output ---\n    # Create a list of formatted strings, e.g., \"[1.400,1.800]\"\n    formatted_results = [f\"[{d:.3f},{delta:.3f}]\" for d, delta in results]\n\n    # Join them into the final output string, e.g., \"[[...],[...]]\"\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}