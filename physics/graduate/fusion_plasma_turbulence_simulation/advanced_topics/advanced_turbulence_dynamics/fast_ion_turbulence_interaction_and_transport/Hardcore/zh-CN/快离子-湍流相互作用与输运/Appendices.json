{
    "hands_on_practices": [
        {
            "introduction": "在分析快离子如何与湍流相互作用之前，我们必须首先理解它们在等离子体中的基准状态，该状态是由快离子与热电子和热离子的碰撞过程所决定的。本练习旨在探索“临界能量” $E_c$ 这一概念，即快离子在电子和离子上的碰撞减速率相等的能量点。通过计算 $E_c$ 并理解其作用，您将明白它如何在快离子平衡分布函数中形成一个特征性的“拐点”，这是决定回旋动理学模拟中驱动或阻尼湍流的可用自由能的关键特征。",
            "id": "4189028",
            "problem": "一群电荷数为 $Z_{t}=1$、质量为 $M = m_{D}$ 的单能快氘离子被注入到均匀、完全电离的氘等离子体中。假设等离子体是准中性的，即 $n_{e} \\simeq n_{i}$，其中 $n_{e}$ 和 $n_{i}$ 分别是电子和氘离子的密度。电子和背景氘离子均为麦克斯韦分布，温度分别为 $T_{e}$ 和 $T_{i}$，且电子和离子碰撞中的库仑对数 $\\ln\\Lambda$ 相同。考虑 Fokker–Planck 描述中的经典测试粒子库仑碰撞算子，并使用测试粒子在麦克斯韦背景上所受阻力的渐近极限：相对于 $v_{Te}$ 的电子低速极限和相对于 $v_{Ti}$ 的离子高速极限。从第一性原理出发，推导电子阻力等于离子阻力时的临界速度 $v_{c}$ 的条件，并由此获得快氘离子的临界能量 $E_{c} = \\tfrac{1}{2} M v_{c}^{2}$。\n\n使用以下参数：$n_{e} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$n_{i} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$T_{e} = 10\\,\\mathrm{keV}$，$T_{i} = 5\\,\\mathrm{keV}$，$m_{e} = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$，$m_{D} = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$，以及 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。你可以假设在定义 $v_{c}$ 的电子阻力与离子阻力之比中，库仑对数 $\\ln\\Lambda$ 和因子 $Z_{t}^{2}$ 可以相互抵消。\n\n使用这些假设，计算氘快离子的 $E_{c}$ 的数值。以 $\\mathrm{keV}$ 为单位表示最终能量，并将答案四舍五入到三位有效数字。\n\n最后，定性解释 $E_{c}$ 的位置如何在回旋动理学模拟中使用的平衡快离子分布 $F_{0f}(v)$ 中形成一个“膝部”，以及这个膝部如何通过改变速度空间梯度和共振条件来改变与微观湍流的耦合。此讨论不影响数值答案的要求，仅为概念上的完整性而设。",
            "solution": "用户提供的问题是等离子体物理领域一个有效、适定且具有科学依据的问题。这是一个关于等离子体中快离子碰撞减速的标准推导和计算。所有必要的参数和物理假设都已提供，不存在矛盾或不合理的假设。因此，我将提供一个完整的解答。\n\n问题要求推导临界能量 $E_c$，在该能量下，快氘离子受到的来自背景电子的碰撞阻力等于来自背景离子的阻力。推导从库仑碰撞的 Fokker-Planck 描述开始。\n\n设测试粒子（快氘离子）的质量为 $M=m_D$，电荷为 $Z_t e$，速度为 $\\mathbf{v}$。背景等离子体由电子（物种 'e'）和氘离子（物种 'i'）组成，它们都服从麦克斯韦分布，温度分别为 $T_e$ 和 $T_i$，密度分别为 $n_e$ 和 $n_i$。设背景离子的电荷为 $Z_i e$。\n\n测试粒子 't' 由于与背景物种 's' 的碰撞而受到的摩擦阻力 $\\mathbf{F}_{ts}$ 由下式给出：\n$$ \\mathbf{F}_{ts} = - (1 + \\frac{M}{m_s}) \\frac{Z_t^2 Z_s^2 e^4 n_s \\ln\\Lambda}{4\\pi\\epsilon_0^2 M} \\frac{\\mathbf{v}}{v^3} \\Psi(x_s) $$\n其中 $m_s$ 和 $Z_s e$ 是背景物种的质量和电荷，$v=|\\mathbf{v}|$ 是测试粒子的速率，$x_s = v/v_{Ts}$ 是测试粒子速率与物种 's' 的热速度之比（$v_{Ts} = \\sqrt{2T_s/m_s}$），$\\Psi(x_s)$ 是 Chandrasekhar 函数：\n$$ \\Psi(x_s) = \\mathrm{erf}(x_s) - \\frac{2x_s}{\\sqrt{\\pi}}\\exp(-x_s^2) $$\n测试粒子因与物种 's' 碰撞而产生的能量损失率由 $\\frac{dE}{dt}|_s = \\mathbf{F}_{ts} \\cdot \\mathbf{v}$ 给出。我们关心的是这个能量损失率的大小。\n$$ \\left| \\frac{dE}{dt} \\right|_s = (1 + \\frac{M}{m_s}) \\frac{Z_t^2 Z_s^2 e^4 n_s \\ln\\Lambda}{4\\pi\\epsilon_0^2 M} \\frac{1}{v} \\Psi(x_s) $$\n我们现在应用问题中指定的渐近极限。\n\n**对电子的阻力 (s=e)**\n问题要求使用低速极限，$v \\ll v_{Te}$，这意味着 $x_e = v/v_{Te} \\ll 1$。对于小的 $x_e$，Chandrasekhar 函数 $\\Psi(x_e)$ 可以通过展开误差函数和指数函数来近似：\n$$ \\mathrm{erf}(x_e) \\approx \\frac{2}{\\sqrt{\\pi}}(x_e - \\frac{x_e^3}{3}) \\quad , \\quad \\exp(-x_e^2) \\approx 1 - x_e^2 $$\n$$ \\Psi(x_e) \\approx \\frac{2}{\\sqrt{\\pi}}(x_e - \\frac{x_e^3}{3}) - \\frac{2x_e}{\\sqrt{\\pi}}(1 - x_e^2) = \\frac{2}{\\sqrt{\\pi}} \\left( x_e - \\frac{x_e^3}{3} - x_e + x_e^3 \\right) = \\frac{4x_e^3}{3\\sqrt{\\pi}} $$\n由于 $M \\gg m_e$，前置因子 $(1 + M/m_e)$ 近似为 $M/m_e$。对电子的能量损失率变为：\n$$ \\left| \\frac{dE}{dt} \\right|_e \\approx \\frac{M}{m_e} \\frac{Z_t^2 e^4 n_e \\ln\\Lambda}{4\\pi\\epsilon_0^2 M} \\frac{1}{v} \\left( \\frac{4x_e^3}{3\\sqrt{\\pi}} \\right) = \\frac{Z_t^2 e^4 n_e \\ln\\Lambda}{3\\pi^{3/2}\\epsilon_0^2 m_e} \\frac{x_e^3}{v} $$\n代入 $x_e = v/v_{Te}$ 和 $E = \\frac{1}{2} M v^2$：\n$$ \\left| \\frac{dE}{dt} \\right|_e \\approx \\frac{Z_t^2 e^4 n_e \\ln\\Lambda}{3\\pi^{3/2}\\epsilon_0^2 m_e v_{Te}^3} v^2 = \\frac{Z_t^2 e^4 n_e \\ln\\Lambda}{3\\pi^{3/2}\\epsilon_0^2 m_e v_{Te}^3} \\frac{2E}{M} $$\n\n**对离子的阻力 (s=i)**\n问题要求使用高速极限，$v \\gg v_{Ti}$，这意味着 $x_i = v/v_{Ti} \\gg 1$。在此极限下，$\\mathrm{erf}(x_i) \\to 1$ 且 $\\exp(-x_i^2) \\to 0$，因此 $\\Psi(x_i) \\approx 1$。\n对离子的能量损失率为：\n$$ \\left| \\frac{dE}{dt} \\right|_i \\approx (1 + \\frac{M}{m_i}) \\frac{Z_t^2 Z_i^2 e^4 n_i \\ln\\Lambda}{4\\pi\\epsilon_0^2 M} \\frac{1}{v} $$\n在这个问题中，背景离子也是氘，所以 $m_i = m_D = M$ 且 $Z_i = 1$。氘等离子体的准中性条件是 $n_e \\simeq n_i$。前置因子变为 $(1 + M/M) = 2$。\n$$ \\left| \\frac{dE}{dt} \\right|_i \\approx 2 \\frac{Z_t^2 e^4 n_i \\ln\\Lambda}{4\\pi\\epsilon_0^2 M} \\frac{1}{v} = \\frac{Z_t^2 e^4 n_i \\ln\\Lambda}{2\\pi\\epsilon_0^2 M v} $$\n\n**临界速度和能量**\n临界速度 $v_c$ 由电子和离子阻力率相等的条件定义。令 $E_c = \\frac{1}{2} M v_c^2$。\n$$ \\left| \\frac{dE}{dt} \\right|_e = \\left| \\frac{dE}{dt} \\right|_i $$\n$$ \\frac{Z_t^2 e^4 n_e \\ln\\Lambda}{3\\pi^{3/2}\\epsilon_0^2 m_e v_{Te}^3} v_c^2 = \\frac{Z_t^2 e^4 n_i \\ln\\Lambda}{2\\pi\\epsilon_0^2 M v_c} $$\n问题说明 $Z_t^2$ 和 $\\ln\\Lambda$ 可以消去。又因为 $n_e=n_i$，我们可以简化为：\n$$ \\frac{1}{3\\pi^{3/2} m_e v_{Te}^3} v_c^2 = \\frac{1}{2\\pi M v_c} $$\n解出 $v_c^3$：\n$$ v_c^3 = \\frac{3\\pi^{3/2} m_e v_{Te}^3}{2\\pi M} = \\frac{3\\sqrt{\\pi} m_e v_{Te}^3}{2 M} $$\n现在，代入热速度 $v_{Te} = \\sqrt{2T_e/m_e}$：\n$$ v_c^3 = \\frac{3\\sqrt{\\pi} m_e}{2 M} \\left(\\frac{2T_e}{m_e}\\right)^{3/2} = \\frac{3\\sqrt{\\pi} m_e}{2 M} \\frac{2\\sqrt{2} T_e^{3/2}}{m_e^{3/2}} = \\frac{3\\sqrt{2\\pi} T_e^{3/2}}{M \\sqrt{m_e}} $$\n临界能量为 $E_c = \\frac{1}{2} M v_c^2 = \\frac{1}{2} M (v_c^3)^{2/3}$。\n$$ E_c = \\frac{1}{2} M \\left( \\frac{3\\sqrt{2\\pi} T_e^{3/2}}{M \\sqrt{m_e}} \\right)^{2/3} = \\frac{1}{2} M \\frac{(18\\pi)^{1/3} T_e}{M^{2/3} m_e^{1/3}} $$\n$$ E_c = \\frac{1}{2} (18\\pi)^{1/3} M^{1/3} m_e^{-1/3} T_e = \\frac{1}{2} (18\\pi)^{1/3} \\left(\\frac{M}{m_e}\\right)^{1/3} T_e $$\n\n**数值计算**\n给定 $M = m_D = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$，$m_e = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$，以及 $T_e = 10\\,\\mathrm{keV}$。\n首先，计算质量比：\n$$ \\frac{M}{m_e} = \\frac{3.344 \\times 10^{-27}\\,\\mathrm{kg}}{9.109 \\times 10^{-31}\\,\\mathrm{kg}} \\approx 3671.09 $$\n现在，计算 $T_e$ 的数值前置因子：\n$$ \\frac{E_c}{T_e} = \\frac{1}{2} (18\\pi)^{1/3} \\left(\\frac{M}{m_e}\\right)^{1/3} \\approx \\frac{1}{2} (18 \\times 3.14159)^{1/3} (3671.09)^{1/3} $$\n$$ \\frac{E_c}{T_e} \\approx \\frac{1}{2} (56.5487)^{1/3} (3671.09)^{1/3} \\approx \\frac{1}{2} (3.8383) (15.4294) \\approx 29.605 $$\n临界能量大约是电子温度的 $29.605$ 倍。\n$$ E_c \\approx 29.605 \\times T_e = 29.605 \\times 10\\,\\mathrm{keV} = 296.05\\,\\mathrm{keV} $$\n四舍五入到三位有效数字，临界能量为 $296\\,\\mathrm{keV}$。\n\n**定性讨论**\n临界能量 $E_c$ 标志着快离子碰撞动力学的一个转变。对于快离子能量 $E \\gg E_c$，离子主要通过与电子碰撞而减速，能量损失率 $|dE/dt|_e \\propto E$。对于能量 $E \\ll E_c$，与背景离子的碰撞减速占主导地位，能量损失率 $|dE/dt|_i \\propto E^{-1/2}$。\n\n在一个具有高能快离子源（例如，来自中性束注入或聚变反应）的稳态系统中，平衡快离子分布函数 $F_{0f}$ 由源与碰撞减速之间的平衡决定。在速度空间的无源区，能量空间中的粒子通量是恒定的。这导致分布函数的形式为 $F_{0f}(E) \\propto 1/|dE/dt|_{total}$。总能量损失率是与电子和离子碰撞的损失率之和：$|dE/dt|_{total} \\propto E + E_c^{3/2} E^{-1/2}$。这种函数形式导致分布函数 $F_{0f}(E)$ 的斜率在 $E=E_c$ 附近发生明显变化。具体来说，对于 $E \\gg E_c$，$F_{0f}(E) \\propto E^{-1}$；对于 $E \\ll E_c$，$F_{0f}(E) \\propto E^{1/2}$。这个过渡区域通常被称为快离子分布中的“膝部”。\n\n这个膝部的位置和形状对于微观湍流的回旋动理学模拟非常重要。\n1.  **作为不稳定性驱动的速度空间梯度**：不稳定性是由分布函数中的梯度驱动的。$E_c$ 处的膝部产生一个区域，其中能量梯度 $\\partial F_{0f}/\\partial E$ 的性质发生变化。对于 $E>E_c$，$\\partial F_{0f}/\\partial E  0$，提供了一个可以驱动动理学不稳定性（如阿尔芬本征模）的自由能来源。该梯度的大小决定了驱动的强度，而梯度大小受 $E_c$ 相对于源能量的值的影响。\n2.  **共振条件的改变**：快离子与微观湍流之间的相互作用由形式为 $\\omega - k_{\\parallel}v_{\\parallel} - n\\omega_c = 0$ 的波-粒子共振所控制。共振粒子的数量取决于 $F_{0f}(v)$ 的结构。$v_c$ 处的膝部决定了在不同速度范围内可用于共振的粒子数量。$E_c$ 的变化（例如，由于 $T_e$ 的变化）可以改变哪些粒子与给定模式共振，从而改变该模式的稳定性。例如，它可以改变快离子通常对离子温度梯度（ITG）模的稳定效应，或改变快离子驱动模的增长率。\n\n总之，临界能量 $E_c$ 是一个构建快离子平衡分布的基本参数，而这种结构，特别是其膝部，直接影响聚变等离子体中快离子与微观湍流之间的相互作用。",
            "answer": "$$\\boxed{296}$$"
        },
        {
            "introduction": "快离子与湍流波之间的相互作用在所有尺度上并非是均一的，其回旋运动的有限轨道尺寸在调节这种耦合中扮演着至关重要的角色。本练习将深入探讨由 Bessel 函数因子 $J_0(k_\\perp \\rho_f)$ 所代表的回旋平均物理，并推导出一个实用判据，用以判断该效应何时会强到足以使快离子与短波长湍流解耦。掌握此概念是理解快离子输运选择性的关键，即为何它们主要与如 Alfvén 本征模等特定类型的波相互作用。",
            "id": "4188975",
            "problem": "考虑一个磁化等离子体，其中包含拉莫尔半径为 $\\rho_{f}$ 的快离子，这些快离子与静电漂移波湍流相互作用。在回旋动理学 (GK) 理论的准线性 (QL) 极限下，快离子与垂直波数为 $k_{\\perp}$ 的湍流涨落的耦合会受到有限拉莫尔半径 (FLR) 回旋平均因子的修正。该因子在快离子响应中以零阶贝塞尔函数 $J_{0}(k_{\\perp}\\rho_{f})$ 的形式出现。快离子准线性扩散系数 $D_{\\mathrm{QL}}$ 可以示意性地写成一个谱求和的形式，其中 FLR 因子与湍流场振幅以及波-粒子共振核相乘。引入无量纲抑制因子 $S(x) = J_{0}^{2}(x)$，其中 $x \\equiv k_{\\perp}\\rho_{f}$。这样，在共振和谱固定的情况下，相对于零拉莫尔半径极限，$D_{\\mathrm{QL}}$ 会被因子 $S(x)$ 减小。采用一个操作性判据：对于给定的阈值 $0  \\eta  1$，当 $S(x) \\ge \\eta$ 时，快离子扩散是“显著的”；当 $S(x) \\le \\eta$ 时，快离子扩散是“被抑制的”。仅使用贝塞尔函数 $J_{0}(x)$ 经过充分检验的性质，推导出一个保守阈值 $x_{\\mathrm{th}}(\\eta)$，使得对于所有 $x \\ge x_{\\mathrm{th}}(\\eta)$，不等式 $S(x) \\le \\eta$ 恒成立，而无需考虑快离子回旋角与垂直波场的具体相位关系。你的推导应从 $J_{0}(x)$ 的一个基本表示或渐近形式出发，并从逻辑上证明该阈值的充分性。将 $x_{\\mathrm{th}}(\\eta)$ 的最终表达式写成一个单一的闭式解析表达式，无需取整。量 $x_{\\mathrm{th}}$ 是无量纲的，因此最终答案中不需要物理单位。",
            "solution": "用于描述静电湍流中快离子输运的准线性 (QL) 回旋动理学 (GK) 公式，其特点是垂直耦合受到有限拉莫尔半径 (FLR) 的修正，表现为一个因子 $J_{0}(k_{\\perp}\\rho_{f})$。该因子源于对快离子圆周轨道的回旋平均。这个因子从指数微扰回旋平均的傅里叶-贝塞尔表示中是众所周知的。当关注 FLR 相对于零拉莫尔半径极限如何抑制输运时，一个无量纲的抑制度量是\n$$\nS(x) \\equiv J_{0}^{2}(x), \\quad x \\equiv k_{\\perp}\\rho_{f}.\n$$\n在共振和湍流谱固定的条件下，准线性扩散系数 $D_{\\mathrm{QL}}$ 会被 $S(x)$ 减小。因此，对于给定的阈值 $0  \\eta  1$，$S(x) \\ge \\eta$ 表示“显著”扩散，$S(x) \\le \\eta$ 表示“被抑制的”扩散。\n\n为了找到一个保守（充分）的阈值 $x_{\\mathrm{th}}(\\eta)$，以确保对于所有 $x \\ge x_{\\mathrm{th}}$，都有 $S(x) \\le \\eta$ 成立，且与振荡的相位无关，我们需要一个对大 $x$ 有效的 $|J_{0}(x)|$ 的上界。对于大宗量，第一类贝塞尔函数的一个标准的、经过充分检验的渐近形式是\n$$\nJ_{0}(x) \\simeq \\sqrt{\\frac{2}{\\pi x}} \\cos\\!\\left(x - \\frac{\\pi}{4}\\right), \\quad x \\gg 1.\n$$\n这个渐近展开式是通过将驻相法应用于积分表示\n$$\nJ_{0}(x) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\exp\\!\\big(i x \\cos\\theta\\big)\\, d\\theta,\n$$\n得到的，它表现出一种振荡行为，其包络振幅为\n$$\n|J_{0}(x)| \\lesssim \\sqrt{\\frac{2}{\\pi x}}, \\quad x \\gg 1.\n$$\n虽然渐近表达式是近似的，但它提供了一个保守的包络：$J_{0}(x)$ 的量级近似按 $x^{-1/2}$ 衰减，并且对于足够大的 $x$，振荡的幅度受包络振幅 $\\sqrt{2/(\\pi x)}$ 的限制。使用这个包络界，我们得到不等式\n$$\n|J_{0}(x)| \\le \\sqrt{\\frac{2}{\\pi x}} \\quad \\text{（对于大 $x$）, }\n$$\n由此可得\n$$\nS(x) = J_{0}^{2}(x) \\le \\frac{2}{\\pi x}.\n$$\n为了保证在给定 $x$ 值下，对于任何振荡相位都有 $S(x) \\le \\eta$，包络只需满足\n$$\n\\frac{2}{\\pi x} \\le \\eta.\n$$\n对 $x$ 求解这个不等式，得到保守阈值\n$$\nx_{\\mathrm{th}}(\\eta) = \\frac{2}{\\pi \\eta}.\n$$\n对于所有 $x \\ge x_{\\mathrm{th}}(\\eta)$，包络界强制 $|J_{0}(x)| \\le \\sqrt{\\eta}$，因此 $S(x) \\le \\eta$，这与快离子回旋相位和垂直波场之间的具体干涉无关。该阈值明确指出了在何种 $k_{\\perp}\\rho_{f}$ 范围内，根据操作性判据，快离子准线性扩散会因 FLR 效应而受到抑制。\n\n值得注意的是两个互补的情况：对于小 $x$，有泰勒展开 $J_{0}(x) = 1 - x^{2}/4 + \\mathcal{O}(x^{4})$，表明抑制作用很小；在 $J_{0}(x)$ 的零点 $x_{n}$ 附近，$S(x)$ 受到强烈抑制。然而，所推导的 $x_{\\mathrm{th}}(\\eta)$ 提供了一个简单的、与相位无关的、仅基于大 $x$ 包络的充分抑制条件，这正是题目所要求的保守阈值。\n\n因此，保守抑制阈值的最终闭式解析表达式为\n$$\nx_{\\mathrm{th}}(\\eta) = \\frac{2}{\\pi \\eta}.\n$$",
            "answer": "$$\\boxed{\\frac{2}{\\pi \\eta}}$$"
        },
        {
            "introduction": "快离子群与湍流之间复杂相互作用的净效应是能量的转移，确定此能量流动的方向和大小是湍流模拟中的一项关键诊断任务。本练习将指导您完成一个速度空间积分的数值计算，该积分量化了快离子与静电湍流势之间的功率转移 $P_f$。通过完成此计算，您将获得将基本的回旋动理学方程转化为实用计算工具的实践经验，并学会解读其结果以判断快离子是净驱动湍流还是充当阻尼机制。",
            "id": "4188971",
            "problem": "考虑在回旋动理学 (GK) 理论的静电极限下，场与快离子物种之间的湍流能量转移。从动理学描述出发，在固定时间 $t$ 的物种-场能量交换率密度可以通过评估速度空间相关积分来量化：\n$$\nP_f(t) = \\int h_f(\\mathbf{v}, t)\\,\\partial_t \\chi(\\mathbf{v}, t)\\,d^3v,\n$$\n其中 $h_f$ 表示快离子分布函数的非绝热部分，$\\chi$ 表示 GK 势。在一个轴对称的速度空间中，引入柱坐标，其中 $v_\\parallel \\in [-v_{\\max}, v_{\\max}]$ 且 $v_\\perp \\in [0, v_{\\max}]$，因此 $d^3v = 2\\pi\\,v_\\perp\\,dv_\\perp\\,dv_\\parallel$。假设所有量都在一致的、无量纲的 GK 归一化下给出，因此数值不需要转换为物理单位。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n- 为 $v_\\parallel$ 和 $v_\\perp$ 构建具有间距 $\\Delta v_\\parallel$ 和 $\\Delta v_\\perp$ 的均匀速度空间网格，为每个测试用例评估 $h_f(v_\\parallel, v_\\perp)$ 和 $\\partial_t \\chi(v_\\parallel, v_\\perp)$，并计算离散近似：\n$$\nP_f \\approx \\sum_{i=1}^{N_\\parallel}\\sum_{j=1}^{N_\\perp} h_f(v_{\\parallel,i}, v_{\\perp,j})\\,\\partial_t \\chi(v_{\\parallel,i}, v_{\\perp,j})\\,\\left(2\\pi\\,v_{\\perp,j}\\,\\Delta v_\\perp\\,\\Delta v_\\parallel\\right).\n$$\n- 按如下方式解释 $P_f$ 的符号：如果 $P_f > 0$，则快离子是湍流能量的净吸收者（净阻尼，编码为整数 $+1$）；如果 $P_f  0$，则快离子是湍流能量的净来源（净驱动，编码为整数 $-1$）；如果在数值容差范围内 $P_f = 0$，则编码为整数 $0$。\n\n实现以下测试套件，其中所有参数都是无量纲的，速度空间度量为 $d^3v = 2\\pi\\,v_\\perp\\,dv_\\perp\\,dv_\\parallel$：\n\n- 测试用例 $1$（正常路径，预期为净阻尼）：使用 $v_{\\max} = 4$, $N_\\parallel = 201$, $N_\\perp = 200$ 和 $\\sigma = 1$。定义\n$$\nh_f(v_\\parallel, v_\\perp) = A\\,\\exp\\!\\left(-\\frac{v_\\parallel^2 + v_\\perp^2}{2\\sigma^2}\\right)\\left(1 + \\delta \\cos(k\\,v_\\parallel)\\right) + \\delta_b\\,\\exp\\!\\left(-\\frac{(v_\\parallel - v_b)^2}{2 w_b^2}\\right)\\exp\\!\\left(-\\frac{(v_\\perp - v_{p,b})^2}{2 w_{p,b}^2}\\right),\n$$\n其中 $A = 0.1$, $\\delta = 0.05$, $k = 1.2$, $\\delta_b = 0.02$, $v_b = 1.8$, $v_{p,b} = 0.4$, $w_b = 0.25$, $w_{p,b} = 0.2$。取一个均匀的 $\\partial_t \\chi = c_0$，其中 $c_0 = 0.01$。\n\n- 测试用例 $2$（因符号反转预期为净驱动）：使用与测试用例 $1$ 中相同的 $h_f$，但取一个均匀的 $\\partial_t \\chi = c_0$，其中 $c_0 = -0.015$。\n\n- 测试用例 $3$（对称边界，预期接近零转移）：使用 $v_{\\max} = 3$, $N_\\parallel = 401$, $N_\\perp = 401$ 和 $\\sigma = 1$。定义\n$$\nh_f(v_\\parallel, v_\\perp) = A\\,\\exp\\!\\left(-\\frac{v_\\parallel^2 + v_\\perp^2}{2\\sigma^2}\\right),\n$$\n其中 $A = 0.2$，以及\n$$\n\\partial_t \\chi(v_\\parallel, v_\\perp) = \\alpha\\,v_\\parallel\\,\\exp\\!\\left(-\\frac{v_\\perp^2}{2\\sigma^2}\\right),\n$$\n其中 $\\alpha = 0.02$。\n\n算法要求：\n- 将 $v_\\parallel$ 和 $v_\\perp$ 在它们各自的区间上构建为包含端点的均匀网格。\n- 使用上述带有 $2\\pi$ 因子和柱面雅可比行列式 $v_\\perp$ 的离散近似。\n- 在符号解释中应用数值容差 $\\varepsilon = 10^{-12}$：将 $|P_f| \\le \\varepsilon$ 视为零。\n\n最终输出规范：\n- 对于每个测试用例，生成一个嵌套列表 $[P_f, s]$，其中 $P_f$ 四舍五入到 $8$ 位小数，而 $s \\in \\{-1, 0, +1\\}$ 是如上所述的符号分类。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[[P_1,s_1],[P_2,s_2],[P_3,s_3]]$，不含空格。\n\n所有输入都是无量纲的，不需要进行物理单位转换。角度（如果有）以弧度为单位，但在上述定义中未使用。",
            "solution": "该问题要求在回旋动理学 (GK) 理论框架内，计算快离子物种与静电场之间的湍流能量转移率密度 $P_f$。量 $P_f$ 由速度空间积分定义：\n$$\nP_f = \\int h_f(\\mathbf{v})\\,\\partial_t \\chi(\\mathbf{v})\\,d^3v\n$$\n其中 $h_f$ 是快离子分布函数的非绝热部分，$\\partial_t \\chi$ 是 GK 势随时间的变化率。$P_f$ 的符号决定了能量流动的方向：$P_f > 0$ 表示能量从场净转移到粒子（阻尼），而 $P_f  0$ 表示能量从粒子净转移到场（驱动）。\n\n积分在轴对称的柱面速度空间坐标系 $(v_\\parallel, v_\\perp)$ 中执行，其中 $v_\\parallel$ 是平行于磁场的速度，$v_\\perp$ 是垂直速度。积分域为 $v_\\parallel \\in [-v_{\\max}, v_{\\max}]$ 和 $v_\\perp \\in [0, v_{\\max}]$。无穷小体积元由 $d^3v = 2\\pi\\,v_\\perp\\,dv_\\perp\\,dv_\\parallel$ 给出。因此，$P_f$ 的积分为：\n$$\nP_f = \\int_{-v_{\\max}}^{v_{\\max}} \\int_0^{v_{\\max}} h_f(v_\\parallel, v_\\perp)\\,\\partial_t \\chi(v_\\parallel, v_\\perp)\\, (2\\pi v_\\perp) \\,dv_\\perp \\,dv_\\parallel\n$$\n\n为了计算这个定积分，我们采用基于均匀二维网格上离散求和的数值近似方法。速度空间被离散化为一个包含 $N_\\parallel \\times N_\\perp$ 个点的网格。\n平行速度的网格 $\\{v_{\\parallel,i}\\}_{i=1}^{N_\\parallel}$ 覆盖区间 $[-v_{\\max}, v_{\\max}]$，均匀间距为 $\\Delta v_\\parallel = \\frac{2v_{\\max}}{N_\\parallel - 1}$。\n垂直速度的网格 $\\{v_{\\perp,j}\\}_{j=1}^{N_\\perp}$ 覆盖区间 $[0, v_{\\max}]$，均匀间距为 $\\Delta v_\\perp = \\frac{v_{\\max}}{N_\\perp - 1}$。\n\n连续积分由以下离散和近似：\n$$\nP_f \\approx \\sum_{i=1}^{N_\\parallel}\\sum_{j=1}^{N_\\perp} I(v_{\\parallel,i}, v_{\\perp,j})\\, \\Delta V_j\n$$\n其中 $I(v_{\\parallel,i}, v_{\\perp,j}) = h_f(v_{\\parallel,i}, v_{\\perp,j})\\,\\partial_t \\chi(v_{\\parallel,i}, v_{\\perp,j})$ 是在每个网格点上评估的被积函数，而 $\\Delta V_j = 2\\pi\\,v_{\\perp,j}\\,\\Delta v_\\perp\\,\\Delta v_\\parallel$ 是速度空间中相应环形单元的体积。在柱坐标中，雅可比因子 $v_{\\perp,j}$ 对计算的正确性至关重要。\n\n每个测试用例的计算过程如下：\n$1$. 使用指定的参数 $v_{\\max}$, $N_\\parallel$ 和 $N_\\perp$ 构建 $v_\\parallel$ 和 $v_\\perp$ 的一维网格。\n$2$. 从这些网格创建二维坐标数组，以表示积分域中的每个点 $(v_{\\parallel,i}, v_{\\perp,j})$。\n$3$. 在这个二维网格上评估函数 $h_f(v_\\parallel, v_\\perp)$ 和 $\\partial_t \\chi(v_\\parallel, v_\\perp)$，得到两个数值矩阵。\n$4$. 通过对 $h_f$ 和 $\\partial_t \\chi$ 矩阵进行逐元素相乘，计算被积函数矩阵。\n$5$. 计算一个表示微分体积元 $2\\pi\\,v_{\\perp,j}\\,\\Delta v_\\perp\\,\\Delta v_\\parallel$ 的矩阵。\n$6$. 将被积函数矩阵和体积元矩阵逐元素相乘，并将所得矩阵的所有元素求和，以获得 $P_f$ 的数值。\n$7. $使用容差 $\\varepsilon = 10^{-12}$ 解释计算出的 $P_f$ 的符号。如果 $P_f > \\varepsilon$，结果为净阻尼（编码为 $+1$）。如果 $P_f  -\\varepsilon$，结果为净驱动（编码为 $-1$）。如果 $|P_f| \\le \\varepsilon$，则净转移被视为零（编码为 $0$）。\n\n测试用例分析：\n- **测试用例 $1$**：函数 $h_f$ 由一个调制的麦克斯韦分布和一个高斯“尾部凸起”之和构成。两个分量都严格为正，因此 $h_f(v_\\parallel, v_\\perp) > 0$。势的变化率是一个正常数，$\\partial_t \\chi = c_0 = 0.01 > 0$。因此，被积函数在整个定义域内均为正。因此，积分 $P_f$ 必定为正，对应于净阻尼 ($s=+1$)。\n\n- **测试用例 $2$**：此用例使用与用例 $1$ 中相同的正函数 $h_f$。然而，势的变化率是一个负常数，$\\partial_t \\chi = c_0 = -0.015  0$。因此，被积函数处处为负。积分 $P_f$ 必定为负，对应于净驱动 ($s=-1$)。\n\n- **测试用例 $3$**：在这里，$h_f(v_\\parallel, v_\\perp) = A\\,\\exp\\!\\left(-\\frac{v_\\parallel^2 + v_\\perp^2}{2\\sigma^2}\\right)$ 是关于 $v_\\parallel$ 的偶函数，即 $h_f(-v_\\parallel, v_\\perp) = h_f(v_\\parallel, v_\\perp)$。势的变化率 $\\partial_t \\chi(v_\\parallel, v_\\perp) = \\alpha\\,v_\\parallel\\,\\exp\\!\\left(-\\frac{v_\\perp^2}{2\\sigma^2}\\right)$ 是关于 $v_\\parallel$ 的奇函数，即 $\\partial_t \\chi(-v_\\parallel, v_\\perp) = -\\partial_t \\chi(v_\\parallel, v_\\perp)$。被积函数是一个偶函数和一个奇函数的乘积，因此它本身是关于 $v_\\parallel$ 的奇函数。奇函数在对称区间（如 $[-v_{\\max}, v_{\\max}]$）上的积分解析上为零。由于数值积分方案是对称的，预期会得到一个在数值精度范围内为零的 $P_f$ 值。因此，我们预期 $|P_f| \\le \\varepsilon$，对应于零净能量转移 ($s=0$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the species-field energy exchange rate density Pf for three test cases\n    based on Gyrokinetic theory.\n    \"\"\"\n    \n    # Define the parameters for the three test cases.\n    test_cases = [\n        {\n            # Test case 1: happy path, net damping expected\n            \"v_max\": 4.0, \"N_parallel\": 201, \"N_perp\": 200, \"sigma\": 1.0,\n            \"h_f_params\": {\"A\": 0.1, \"delta\": 0.05, \"k\": 1.2, \"delta_b\": 0.02,\n                         \"v_b\": 1.8, \"v_p_b\": 0.4, \"w_b\": 0.25, \"w_p_b\": 0.2},\n            \"dt_chi_params\": {\"c0\": 0.01},\n            \"case_type\": 1\n        },\n        {\n            # Test case 2: net drive expected by sign reversal\n            \"v_max\": 4.0, \"N_parallel\": 201, \"N_perp\": 200, \"sigma\": 1.0,\n            \"h_f_params\": {\"A\": 0.1, \"delta\": 0.05, \"k\": 1.2, \"delta_b\": 0.02,\n                         \"v_b\": 1.8, \"v_p_b\": 0.4, \"w_b\": 0.25, \"w_p_b\": 0.2},\n            \"dt_chi_params\": {\"c0\": -0.015},\n            \"case_type\": 2\n        },\n        {\n            # Test case 3: symmetry boundary, near-zero transfer expected\n            \"v_max\": 3.0, \"N_parallel\": 401, \"N_perp\": 401, \"sigma\": 1.0,\n            \"h_f_params\": {\"A\": 0.2},\n            \"dt_chi_params\": {\"alpha\": 0.02},\n            \"case_type\": 3\n        }\n    ]\n\n    results = []\n    \n    # Define functional forms for h_f and dt_chi\n    def get_hf(case_type, Vp, Vperp, sigma, params):\n        if case_type in [1, 2]:\n            term1 = params['A'] * np.exp(-(Vp**2 + Vperp**2) / (2 * sigma**2)) * \\\n                    (1 + params['delta'] * np.cos(params['k'] * Vp))\n            term2 = params['delta_b'] * np.exp(-((Vp - params['v_b'])**2) / (2 * params['w_b']**2)) * \\\n                    np.exp(-((Vperp - params['v_p_b'])**2) / (2 * params['w_p_b']**2))\n            return term1 + term2\n        elif case_type == 3:\n            return params['A'] * np.exp(-(Vp**2 + Vperp**2) / (2 * sigma**2))\n\n    def get_dt_chi(case_type, Vp, Vperp, sigma, params):\n        if case_type in [1, 2]:\n            return np.full_like(Vp, params['c0'])\n        elif case_type == 3:\n            return params['alpha'] * Vp * np.exp(-(Vperp**2) / (2 * sigma**2))\n\n    for case in test_cases:\n        v_max = case[\"v_max\"]\n        N_parallel = case[\"N_parallel\"]\n        N_perp = case[\"N_perp\"]\n        sigma = case[\"sigma\"]\n        \n        # 1. Construct uniform velocity-space grids\n        v_parallel_grid = np.linspace(-v_max, v_max, N_parallel)\n        v_perp_grid = np.linspace(0, v_max, N_perp)\n        \n        # Calculate grid spacings\n        delta_v_parallel = (2 * v_max) / (N_parallel - 1)\n        delta_v_perp = v_max / (N_perp - 1)\n        \n        # Create 2D coordinate arrays\n        V_parallel, V_perp = np.meshgrid(v_parallel_grid, v_perp_grid, indexing='ij')\n\n        # 2. Evaluate h_f and dt_chi on the grid\n        hf_vals = get_hf(case[\"case_type\"], V_parallel, V_perp, sigma, case[\"h_f_params\"])\n        dt_chi_vals = get_dt_chi(case[\"case_type\"], V_parallel, V_perp, sigma, case[\"dt_chi_params\"])\n        \n        # 3. Compute the integrand and the differential volume element\n        integrand = hf_vals * dt_chi_vals\n        dV = 2 * np.pi * V_perp * delta_v_perp * delta_v_parallel\n        \n        # 4. Compute Pf using discrete approximation\n        P_f = np.sum(integrand * dV)\n        \n        # 5. Interpret the sign of Pf\n        eps = 1e-12\n        if P_f > eps:\n            s = 1\n        elif P_f  -eps:\n            s = -1\n        else:\n            s = 0\n        \n        # Store result rounded to 8 decimal places\n        results.append([round(P_f, 8), s])\n\n    # Final print statement in the exact required format\n    output_parts = [f\"[{p},{s}]\" for p, s in results]\n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```"
        }
    ]
}