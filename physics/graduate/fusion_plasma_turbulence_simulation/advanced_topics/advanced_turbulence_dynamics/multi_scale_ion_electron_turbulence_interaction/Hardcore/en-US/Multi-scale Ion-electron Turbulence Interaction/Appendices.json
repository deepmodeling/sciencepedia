{
    "hands_on_practices": [
        {
            "introduction": "Before simulating turbulence, one must understand the geometric 'stage' on which it evolves. In a tokamak, the complex, sheared magnetic field imposes non-trivial constraints on how turbulent eddies develop and interact. This exercise explores how magnetic shear affects the phase of individual Fourier modes within the widely-used flux-tube model and, critically, how it impacts the phase-matching of the nonlinear triads responsible for energy transfer .",
            "id": "4196984",
            "problem": "Consider a local flux-tube representation of a tokamak plasma used in gyrokinetic (GK) simulations of multi-scale ion-electron turbulence, with coordinates $(x,y,\\theta)$, where $x$ is the radial-like coordinate, $y$ is the binormal coordinate, and $\\theta$ is the poloidal angle along the magnetic field line. The magnetic field is written in Clebsch form as $\\mathbf{B} = \\nabla \\psi \\times \\nabla \\alpha$, where $\\psi$ is a flux surface label and $\\alpha$ is a field-line label. The magnetic shear $\\hat{s}$ is defined (for circular concentric flux surfaces) by $\\hat{s} = (r/q)\\,\\mathrm{d}q/\\mathrm{d}r$, where $r$ is a minor radius and $q(\\psi)$ is the safety factor.\n\nA periodic boundary condition is imposed at $\\theta = 0$ and $\\theta = 2\\pi$ along the field line. Due to magnetic shear, advancing by $\\Delta \\theta = 2\\pi$ maps perpendicular coordinates nontrivially: the binormal coordinate shifts as $y \\rightarrow y + \\Delta y(x)$ at fixed $x$. You may assume that $\\Delta y$ is linear in both $x$ and $\\Delta \\theta$ for sufficiently small $x$ and local shear, and that this mapping arises from the differential field-line twist associated with $q(\\psi)$.\n\nThree perpendicular Fourier modes interact nonlinearly as a triad via the electrostatic $\\mathbf{E}\\times\\mathbf{B}$ nonlinearity. Each mode has the form $f_i(x,y,\\theta) = A_i(\\theta)\\,\\exp\\!\\left[i\\left(k_{x,i} x + k_{y,i} y\\right)\\right]$ for $i \\in \\{1,2,3\\}$, with envelopes $A_i(\\theta)$. At $\\theta = 0$, the triad satisfies the standard perpendicular wavevector matching conditions $\\sum_{i=1}^{3} k_{x,i} = 0$ and $\\sum_{i=1}^{3} k_{y,i} = 0$, which follow from translational invariance in $(x,y)$. Suppose the binormal wavenumbers are, in units of $\\mathrm{m}^{-1}$, $k_{y,1} = 800$, $k_{y,2} = -800$, and $k_{y,3} = 0$, and the interaction is evaluated at a fixed radius $x = 0.010\\,\\mathrm{m}$ in a region with magnetic shear $\\hat{s} = 0.8$.\n\nStarting from the Clebsch form and definition of $\\hat{s}$, derive the shear-induced mapping $y \\rightarrow y + \\Delta y(x)$ across $\\Delta \\theta = 2\\pi$ and then determine the resulting phase shift of a single perpendicular Fourier mode across the boundary. Use that result to derive and compute the total phase shift $\\Delta \\Phi$ accumulated by the product $f_1 f_2 f_3$ when carried from $\\theta = 0$ to $\\theta = 2\\pi$ at fixed $x$.\n\nExpress the final answer as a single real number representing the phase shift $\\Delta \\Phi$ in radians. Do not provide intermediate equations as the final answer.",
            "solution": "The problem statement is scientifically grounded, well-posed, and self-contained. It describes a canonical situation in the theory of plasma turbulence in a tokamak, specifically concerning the consequences of magnetic shear on the nonlinear interaction of Fourier modes in a flux-tube geometry. All provided information and constants are physically sound and dimensionally consistent. The problem tests fundamental concepts of phase-matching in triad interactions under a sheared magnetic field. The problem is therefore valid.\n\nThe solution proceeds in three stages as requested:\n1.  Derivation of the shear-induced coordinate mapping for one full transit along the magnetic field line.\n2.  Calculation of the resulting phase shift for a single Fourier mode.\n3.  Calculation of the total phase shift for the product of the three interacting modes.\n\n**1. Derivation of the Shear-Induced Coordinate Mapping**\n\nWe are considering a local flux-tube representation of a tokamak. In this model, the curved toroidal geometry is approximated by a sheared slab geometry. A local orthogonal coordinate system $(x, y, z)$ is used, where $x$ is the radial-like coordinate, $z$ is the coordinate parallel to the magnetic field $\\mathbf{B}$ on a reference flux surface, and $y$ is the binormal coordinate, completing the right-handed set.\n\nIn this sheared slab, the magnetic field is represented as:\n$$\n\\mathbf{B} \\approx B_0 \\left( \\hat{e}_z + \\frac{x}{L_s} \\hat{e}_y \\right)\n$$\nwhere $B_0$ is the magnetic field strength, and $L_s$ is the magnetic shear length, which characterizes the rate at which field lines change direction with radial position.\n\nA magnetic field line is a curve $\\mathbf{r}(l)$ whose tangent is everywhere parallel to $\\mathbf{B}$. The differential equation for a field line is $d\\mathbf{r}/dl = \\mathbf{B}/|\\mathbf{B}|$. For a small shear component, $|\\mathbf{B}| \\approx B_0$, and the component equations are:\n$$\n\\frac{dx}{dz} = \\frac{B_x}{B_z} = 0\n$$\n$$\n\\frac{dy}{dz} = \\frac{B_y}{B_z} \\approx \\frac{x/L_s}{1} = \\frac{x}{L_s}\n$$\nIntegrating these equations, we find that a field line remains at a constant radial position $x$, while its binormal position $y$ shifts linearly with the distance $z$ traveled along the field line:\n$$\n\\Delta y = \\frac{x}{L_s} \\Delta z\n$$\nThis slab model is connected to the toroidal geometry of the tokamak. The parallel coordinate $z$ is related to the poloidal angle $\\theta$ by the connection length, $z = q_0 R_0 \\theta$, where $q_0$ and $R_0$ are the safety factor and major radius on the reference flux surface. A full transit along the field line corresponds to a change in the poloidal angle $\\Delta\\theta = 2\\pi$, so the parallel distance traversed is $\\Delta z = 2\\pi q_0 R_0$.\n\nThe magnetic shear length $L_s$ is related to the dimensionless magnetic shear parameter $\\hat{s}$ by the standard definition $L_s = q_0 R_0 / \\hat{s}$.\n\nSubstituting these toroidal-equivalent expressions for $\\Delta z$ and $L_s$ into the slab result for $\\Delta y$:\n$$\n\\Delta y(x) = \\frac{x}{q_0 R_0 / \\hat{s}} (2\\pi q_0 R_0) = 2\\pi \\hat{s} x\n$$\nThis is the derived shear-induced shift in the binormal coordinate $y$ after one full poloidal transit ($\\Delta\\theta = 2\\pi$) at a radial position $x$.\n\n**2. Phase Shift of a Single Mode**\n\nThe problem states that a periodic boundary condition is imposed along the field line, which connects the field at $\\theta=0$ and $\\theta=2\\pi$. Due to the magnetic shear, this periodicity is \"twisted\". For any function $f(x,y,\\theta)$, the boundary condition is:\n$$\nf(x, y, \\theta=2\\pi) = f(x, y + \\Delta y(x), \\theta=0)\n$$\nwhere $\\Delta y(x) = 2\\pi \\hat{s} x$.\n\nWe consider a single Fourier mode of the form $f_i(x,y,\\theta) = A_i(\\theta)\\,\\exp\\!\\left[i\\left(k_{x,i} x + k_{y,i} y\\right)\\right]$. Applying the boundary condition to this mode:\n$$\nA_i(2\\pi) \\exp\\!\\left[i\\left(k_{x,i} x + k_{y,i} y\\right)\\right] = A_i(0) \\exp\\!\\left[i\\left(k_{x,i} x + k_{y,i} (y + \\Delta y(x))\\right)\\right]\n$$\nWe can expand the right side:\n$$\nA_i(2\\pi) \\exp\\!\\left[i\\left(k_{x,i} x + k_{y,i} y\\right)\\right] = A_i(0) \\exp\\!\\left[i\\left(k_{x,i} x + k_{y,i} y\\right)\\right] \\exp\\!\\left[i k_{y,i} \\Delta y(x)\\right]\n$$\nCanceling the common exponential term, we find the relationship between the mode's envelope at the two ends of the flux tube:\n$$\nA_i(2\\pi) = A_i(0) \\exp\\!\\left[i k_{y,i} \\Delta y(x)\\right]\n$$\nThis shows that the envelope $A_i(\\theta)$ acquires a phase shift $\\Delta\\phi_i$ across the $\\Delta\\theta=2\\pi$ boundary. This phase shift is given by:\n$$\n\\Delta\\phi_i = k_{y,i} \\Delta y(x) = 2\\pi \\hat{s} x k_{y,i}\n$$\n\n**3. Total Phase Shift of the Triad Product**\n\nThe problem asks for the total phase shift $\\Delta \\Phi$ accumulated by the product of the three interacting modes, $P(x,y,\\theta) = f_1(x,y,\\theta)f_2(x,y,\\theta)f_3(x,y,\\theta)$.\nLet's first write out the product:\n$$\nP(x,y,\\theta) = \\left( \\prod_{j=1}^3 A_j(\\theta) \\right) \\exp\\!\\left[ i \\left( \\left(\\sum_{j=1}^3 k_{x,j}\\right) x + \\left(\\sum_{j=1}^3 k_{y,j}\\right) y \\right) \\right]\n$$\nThe problem states that at $\\theta=0$, the triad satisfies the standard wavevector matching conditions for a nonlinear interaction: $\\sum_{i=1}^{3} k_{x,i} = 0$ and $\\sum_{i=1}^{3} k_{y,i} = 0$. These conditions stem from translational invariance and hold for all $\\theta$. Thus, the exponential part of the product is unity:\n$$\n\\exp\\!\\left[ i \\left( (0) x + (0) y \\right) \\right] = \\exp(0) = 1\n$$\nSo the product simplifies to $P(\\theta) = A_1(\\theta)A_2(\\theta)A_3(\\theta)$. The phase of the product is $\\arg(P(\\theta)) = \\sum_{i=1}^3 \\arg(A_i(\\theta))$.\n\nThe total phase shift $\\Delta\\Phi$ of the product from $\\theta=0$ to $\\theta=2\\pi$ is the sum of the phase shifts of the individual envelopes:\n$$\n\\Delta\\Phi = \\sum_{i=1}^3 \\Delta\\phi_i = \\sum_{i=1}^3 \\left( k_{y,i} \\Delta y(x) \\right)\n$$\nFactoring out the common term $\\Delta y(x)$:\n$$\n\\Delta\\Phi = \\left( \\sum_{i=1}^3 k_{y,i} \\right) \\Delta y(x) = \\left( \\sum_{i=1}^3 k_{y,i} \\right) (2\\pi \\hat{s} x)\n$$\nNow we use the given values for the binormal wavenumbers:\n$k_{y,1} = 800\\,\\mathrm{m}^{-1}$\n$k_{y,2} = -800\\,\\mathrm{m}^{-1}$\n$k_{y,3} = 0\\,\\mathrm{m}^{-1}$\n\nThe sum of the binormal wavenumbers is:\n$$\n\\sum_{i=1}^3 k_{y,i} = 800 + (-800) + 0 = 0\n$$\nThis result is a direct consequence of the triad interaction condition. Substituting this sum into the expression for the total phase shift:\n$$\n\\Delta\\Phi = (0) \\cdot (2\\pi \\hat{s} x) = 0\n$$\nThe total phase shift accumulated by the product of the three modes is exactly zero. This is a crucial property for nonlinear energy transfer to be sustained in a sheared system; the triad interaction remains phase-matched despite the shear-induced dephasing of individual modes. The specific values of magnetic shear $\\hat{s}=0.8$ and radial position $x=0.010\\,\\mathrm{m}$ are not needed for the final result, as the cancellation is guaranteed by the fundamental triad resonance condition.\n\nThe phase shift is $0$ radians.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Multi-scale turbulence involves more than just the co-existence of different sized eddies; the scales actively influence one another. This practice provides a concrete, quantitative example of this interaction, starting from the fundamental drift-kinetic equation. We will derive how the stochastic 'noise' from large-scale ion turbulence can decorrelate and broaden the kinetic resonance that drives small-scale electron turbulence, a key mechanism in setting the saturation level of fine-scale fluctuations .",
            "id": "4196947",
            "problem": "Consider a large-aspect-ratio tokamak with inverse aspect ratio $\\epsilon \\ll 1$ and constant safety factor $q$. Focus on electrostatic turbulence whose ion-scale component is characterized by a background $E \\times B$ radial stochastic transport with coefficient $D_{r}$, and a single trapped-electron-resonant micro-mode with laboratory-frame frequency $\\omega$ and radial wavenumber $k_{r}$. Work in the collisionless banana regime for electrons except for a weak collisional pitch-angle scattering that modifies the trapped-electron dynamics. Use the drift-kinetic equation (DKE) for electrons, linearized about a Maxwellian background, and subsequently perform a bounce average (BA) over the trapped electron orbit. Denote by $g_{e}$ the non-adiabatic part of the perturbed electron distribution function, and by $\\omega_{d}$ the bounce-averaged trapped-electron precession drift frequency. Model the bounce-averaged collisional operator as an effective relaxation operator of rate $\\nu_{\\mathrm{ba}}$ acting on $g_{e}$. Model the multi-scale cross-field decorrelation produced by ion-scale $E \\times B$ turbulence as a bounce-averaged radial diffusion operator acting on $g_{e}$ that produces phase decorrelation at a rate proportional to $k_{r}^{2} D_{r}$. Assume $|\\omega - \\omega_{d}|$ is small enough that the trapped-electron precession resonance dominates, and neglect finite Larmor radius effects to focus exclusively on the resonance structure.\n\nStarting from the fundamental kinetic description embodied by the drift-kinetic equation and its bounce average, derive the frequency-space resonance response for trapped electrons near the precession condition $\\omega \\approx \\omega_{d}$, including the collisional modification and the cross-scale decorrelation due to ion-scale $E \\times B$ stochasticity. From your derived response, define the precession resonance half-width at half-maximum (HWHM) in frequency space and obtain a closed-form analytic expression for this HWHM in terms of $\\nu_{\\mathrm{ba}}$, $k_{r}$, and $D_{r}$.\n\nExpress your final answer as a single analytic expression for the HWHM in radians per second. No numerical evaluation is required, and no intermediate or auxiliary results should appear in the final answer. Clearly state any additional assumptions you introduce and ensure all steps follow from the stated fundamental base without invoking unverified shortcuts. Define every acronym on first use, including drift-kinetic equation (DKE), bounce average (BA), and half-width at half-maximum (HWHM).",
            "solution": "The problem will first be validated against the specified criteria before a solution is attempted.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n- **System**: A large-aspect-ratio tokamak with inverse aspect ratio $\\epsilon \\ll 1$ and constant safety factor $q$.\n- **Plasma Regime**: Collisionless banana regime for electrons, except for weak collisional pitch-angle scattering.\n- **Turbulence Characteristics**: Electrostatic turbulence with two components:\n    1.  An ion-scale component characterized by a background $E \\times B$ radial stochastic transport with a coefficient $D_r$.\n    2.  A single trapped-electron-resonant micro-mode with laboratory-frame frequency $\\omega$ and radial wavenumber $k_r$.\n- **Theoretical Framework**: Linearized drift-kinetic equation (DKE) for electrons, bounce-averaged (BA) over the trapped electron orbit.\n- **Variables and Functions**:\n    - $g_{e}$: The non-adiabatic part of the perturbed electron distribution function.\n    - $\\omega_{d}$: The bounce-averaged trapped-electron precession drift frequency.\n- **Modeling Assumptions**:\n    1.  The bounce-averaged collisional operator is an effective relaxation operator of rate $\\nu_{\\mathrm{ba}}$ acting on $g_{e}$.\n    2.  The multi-scale cross-field decorrelation due to ion-scale $E \\times B$ turbulence is a bounce-averaged radial diffusion operator acting on $g_{e}$, producing phase decorrelation at a rate proportional to $k_r^{2} D_r$.\n    3.  The trapped-electron precession resonance, where $|\\omega - \\omega_{d}|$ is small, is the dominant effect.\n    4.  Finite Larmor radius effects are neglected.\n- **Objective**: Derive the frequency-space resonance response for trapped electrons near the precession condition $\\omega \\approx \\omega_{d}$. From this, find a closed-form analytic expression for the resonance half-width at half-maximum (HWHM) in terms of $\\nu_{\\mathrm{ba}}$, $k_r$, and $D_r$.\n\n#### Step 2: Validate Using Extracted Givens\nThe problem is assessed based on the validation criteria:\n- **Scientifically Grounded**: The problem is firmly rooted in the standard theoretical framework of fusion plasma turbulence, specifically the study of micro-instabilities in tokamaks using gyrokinetic or drift-kinetic theory. The concepts of bounce-averaging, precession drift resonance, collisional relaxation, and turbulent diffusion are all established principles in this field. The model of multi-scale interaction, where large-scale turbulence affects small-scale dynamics via a diffusion operator, is a widely used and physically motivated approach. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a clear physical model with well-defined parameters and asks for a specific, derivable quantity (the HWHM of a resonance). The inputs ($\\nu_{\\mathrm{ba}}$, $k_r$, $D_r$) are specified, and the output is a single analytic expression. This structure allows for a unique and meaningful solution.\n- **Objective**: The language is technical, precise, and devoid of any subjective, ambiguous, or opinion-based statements.\n- **Completeness and Consistency**: The problem statement contains all necessary physical ingredients to construct the kinetic response function. It specifies the governing equation (DKE), the particle population of interest (trapped electrons), the relevant physical effects (precession resonance, collisions, turbulent decorrelation), and the models for these effects. There are no contradictions in the setup.\n- **Realism**: The model is a simplification of a complex physical system but represents a standard and physically plausible scenario explored in theoretical plasma physics. The parameterization is consistent with common theoretical treatments.\n\nThe problem does not exhibit any of the invalidity flaws. It is a formalizable physics problem that is directly relevant to the topic of *multi-scale ion-electron turbulence interaction*.\n\n#### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\n### Solution\n\nThe objective is to derive the half-width at half-maximum (HWHM) of the trapped-electron precession resonance. We begin with the fundamental description provided: the bounce-averaged (BA) linearized drift-kinetic equation (DKE) for the non-adiabatic part of the perturbed electron distribution function, denoted $\\overline{g_e}$ after bounce-averaging. Acronyms are defined as: drift-kinetic equation (DKE), bounce average (BA), and half-width at half-maximum (HWHM).\n\nThe evolution of $\\overline{g_e}$ for a single electrostatic mode with frequency $\\omega$ and radial wavenumber $k_r$ is governed by an algebraic equation in frequency-wavenumber space. This equation aggregates the effects of mode propagation, particle drifts, collisions, and turbulent decorrelation. Let us assemble the operator acting on $\\overline{g_e}$ based on the problem statement.\n\nThe general form of the linearized DKE for $\\overline{g_e}$ driven by a source $S$ is:\n$$ \\left( \\frac{\\partial}{\\partial t} + \\mathcal{L}_{\\text{space}} \\right) \\overline{g_e} = S $$\nAfter Fourier transforming in time ($\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$), the equation becomes algebraic:\n$$ (-i\\omega + \\mathcal{L}_{\\text{space}}) \\overline{g_e} = S $$\nThe spatial operator $\\mathcal{L}_{\\text{space}}$ includes all other processes. The problem specifies these processes for trapped electrons:\n\n1.  **Precession Drift Resonance**: The bounce-averaged precession drift, with frequency $\\omega_d$, interacts with the mode structure. In Fourier space, this contributes a term $-i\\omega_d$ to the operator. The resonance occurs when the mode frequency $\\omega$ is close to $\\omega_d$.\n\n2.  **Collisional Relaxation**: The bounce-averaged pitch-angle scattering is modeled as a relaxation process with rate $\\nu_{\\mathrm{ba}}$. This acts as a damping term, contributing $-\\nu_{\\mathrm{ba}}$ to the operator.\n\n3.  **Cross-Scale Decorrelation**: The background ion-scale turbulence causes stochastic radial transport of electrons, which in turn decorrelates the phase of the electron response from the coherent micro-mode. This is modeled as a diffusion process. A radial diffusion operator $D_r \\frac{\\partial^2}{\\partial r^2}$ acting on a mode with radial wavenumber $k_r$ becomes $-k_r^2 D_r$ in Fourier space. This contributes a term $-k_r^2 D_r$ to the operator.\n\nCombining these effects, the full operator acting on $\\overline{g_e}$ is $(-i\\omega - i\\omega_d - \\nu_{\\mathrm{ba}} - k_r^2 D_r)$. The bounce-averaged DKE for $\\overline{g_e}$ is thus:\n$$ (-i\\omega - i\\omega_d - \\nu_{\\mathrm{ba}} - k_r^2 D_r) \\overline{g_e} = S $$\nThe specific form of the source term $S$ depends on the mode potential and the background gradients, but it does not affect the position or width of the resonance in frequency space. The solution for the response $\\overline{g_e}$ is:\n$$ \\overline{g_e} = \\frac{S}{-i(\\omega - \\omega_d) - (\\nu_{\\mathrm{ba}} + k_r^2 D_r)} $$\nTo analyze the resonance, we examine the propagator, or the response function, which is the part of the expression containing the frequency dependence:\n$$ P(\\omega) = \\frac{1}{-i(\\omega - \\omega_d) - (\\nu_{\\mathrm{ba}} + k_r^2 D_r)} = \\frac{i}{(\\omega - \\omega_d) + i(\\nu_{\\mathrm{ba}} + k_r^2 D_r)} $$\nThe strength of the resonance is typically measured by the magnitude-squared of the response, $|P(\\omega)|^2$:\n$$ |P(\\omega)|^2 = \\frac{1}{(\\omega - \\omega_d)^2 + (\\nu_{\\mathrm{ba}} + k_r^2 D_r)^2} $$\nThis expression has the form of a Lorentzian distribution, a characteristic shape for a damped resonance. Let us define an effective broadening rate $\\gamma_{\\text{eff}}$ as the sum of the rates of the two decorrelation mechanisms:\n$$ \\gamma_{\\text{eff}} = \\nu_{\\mathrm{ba}} + k_r^2 D_r $$\nThe response magnitude-squared can then be written as:\n$$ |P(\\omega)|^2 = \\frac{1}{(\\omega - \\omega_d)^2 + \\gamma_{\\text{eff}}^2} $$\nThe maximum of this response occurs at the resonant frequency $\\omega = \\omega_d$, where the value is $|P(\\omega_d)|^2 = \\frac{1}{\\gamma_{\\text{eff}}^2}$.\n\nThe HWHM is the positive frequency difference $|\\omega - \\omega_d|$ at which the response magnitude-squared is half of its maximum value. We set $|P(\\omega)|^2$ to half its peak value and solve for the frequency $\\omega$:\n$$ \\frac{1}{(\\omega - \\omega_d)^2 + \\gamma_{\\text{eff}}^2} = \\frac{1}{2} \\left( \\frac{1}{\\gamma_{\\text{eff}}^2} \\right) $$\nInverting both sides gives:\n$$ (\\omega - \\omega_d)^2 + \\gamma_{\\text{eff}}^2 = 2 \\gamma_{\\text{eff}}^2 $$\nSubtracting $\\gamma_{\\text{eff}}^2$ from both sides yields:\n$$ (\\omega - \\omega_d)^2 = \\gamma_{\\text{eff}}^2 $$\nTaking the square root gives the frequency offset from the resonance center:\n$$ |\\omega - \\omega_d| = \\gamma_{\\text{eff}} $$\nBy definition, this frequency offset is the HWHM of the resonance. Therefore, the HWHM of the trapped-electron precession resonance is equal to the effective broadening rate $\\gamma_{\\text{eff}}$.\n\nSubstituting the expression for $\\gamma_{\\text{eff}}$ gives the final result for the HWHM:\n$$ \\text{HWHM} = \\nu_{\\mathrm{ba}} + k_r^2 D_r $$\nThis result demonstrates that the width of the resonance is determined by the linear superposition of the collisional relaxation rate and the turbulent decorrelation rate arising from the background stochastic transport.",
            "answer": "$$\\boxed{\\nu_{\\mathrm{ba}} + k_r^2 D_r}$$"
        },
        {
            "introduction": "Simulating the full range of turbulent scales in a plasma, from large ion gyroradii down to small electron gyroradii, is often computationally intractable. A powerful strategy is to explicitly simulate the large ion scales while modeling the average effect of the unresolved small scales. This exercise guides you through the foundational concepts of a Large-Eddy Simulation (LES) approach, where you will construct a 'subgrid-scale' (SGS) model that accounts for the energy exchange between resolved and unresolved dynamics in a physically consistent manner .",
            "id": "4196928",
            "problem": "Consider electrostatic, magnetized, quasi-neutral plasma turbulence in the low-frequency, small-gyro-radius regime where GyroKinetic (GK) theory applies. Let species index $s \\in \\{i,e\\}$ denote ions and electrons. The GK distribution function for species $s$ is $f_s(\\mathbf{R},v_\\parallel,\\mu,t)$, where $\\mathbf{R}$ is the guiding-center position, $v_\\parallel$ is the parallel velocity, and $\\mu$ is the magnetic moment. The GK equation for $f_s$ consists of linear terms (drifts, parallel streaming, and collisions) and the nonlinear $\\mathbf{E}\\times\\mathbf{B}$ advection in the plane perpendicular to the magnetic field:\n$$\n\\frac{\\partial f_s}{\\partial t} + \\mathbf{v}_E \\cdot \\nabla_\\perp f_s + \\text{(linear terms)} = \\text{(collisions)},\n$$\nwhere the perpendicular $\\mathbf{E}\\times\\mathbf{B}$ velocity is $\\mathbf{v}_E = \\frac{\\mathbf{B} \\times \\nabla_\\perp \\phi}{B^2}$ with electrostatic potential $\\phi(\\mathbf{x}_\\perp,t)$, magnetic field magnitude $B$, and $\\nabla_\\perp$ the perpendicular gradient.\n\nDefine the GK free energy for species $s$ as the quadratic invariant built from $f_s$ and field fluctuations (neglecting magnetic fluctuations in the electrostatic limit), and consider a Large-Eddy Simulation (LES) filtering at the ion scale cutoff characterized by perpendicular wavenumbers satisfying $k_\\perp \\rho_i \\lesssim \\kappa_c$ with $\\kappa_c \\approx 1$, where $\\rho_i$ is the ion Larmor radius. Introduce a sharp spectral filter in perpendicular wavenumber space with cutoff $k_\\perp \\rho_i = \\kappa_c$, defining resolved fields $\\overline{\\phi}$ and resolved distribution $\\overline{f}_s$ that only contain modes with $k_\\perp \\rho_i \\le \\kappa_c$, and subgrid-scale (SGS) fields containing modes with $k_\\perp \\rho_i  \\kappa_c$. Filtering the nonlinear $\\mathbf{E}\\times\\mathbf{B}$ term produces an additional SGS term in the resolved equations, often written as a subgrid stress that represents the back-reaction of unresolved scales on the resolved dynamics.\n\nStarting from the GK free energy conservation law in the electrostatic limit, derive the resolved-scale free-energy budget under LES filtering at $k_\\perp \\rho_i \\sim 1$, explicitly identifying the SGS exchange term between resolved ion-scale dynamics and unresolved electron-scale dynamics. Model this SGS term with an eddy-stress closure that is compatible with energy conservation and can represent backscatter (energy transfer from unresolved to resolved scales). Restrict attention to the perpendicular plane and assume statistical isotropy so that resolved dynamics of the perpendicular $\\mathbf{E}\\times\\mathbf{B}$ flow can be reduced to a two-dimensional incompressible streamfunction representation $\\mathbf{u}_E = \\hat{\\mathbf{z}} \\times \\nabla_\\perp \\overline{\\phi}$, where $\\hat{\\mathbf{z}}$ is the unit vector along the magnetic field. Using this reduction, construct a closure in which the SGS energy exchange depends on the resolved rate-of-strain magnitude squared at each perpendicular wavenumber $k_\\perp$, and electron-scale dissipation is represented by a model coefficient multiplying a linear damping operator consistent with the electron free-energy sink.\n\nYour task is to:\n\n- Derive, from the GK free energy conservation and the filtered resolved equations, a resolved free-energy budget in which the modeled SGS energy flux across the cutoff $k_\\perp \\rho_i = \\kappa_c$ can be written in terms of a coefficient that multiplies the resolved rate-of-strain. Under the two-dimensional isotropic assumption for $\\mathbf{u}_E$, show that the resolved rate-of-strain magnitude squared at perpendicular wavenumber $k_\\perp$ can be expressed in terms of the resolved streamfunction spectrum as a function proportional to $k_\\perp^4 |\\overline{\\phi}_k|^2$. Similarly, show that an electron SGS collisional dissipation consistent with energy conservation can be represented by a coefficient multiplying a quadratic form proportional to $k_\\perp^4 |\\overline{\\phi}_k|^2$.\n\n- Construct a minimal gyrokinetic LES subgrid model at ion-scale cutoff $k_\\perp \\rho_i \\sim 1$ in which the net modeled SGS energy flux $\\Pi_{\\mathrm{model}}$ (positive for net transfer from resolved to unresolved scales, negative for backscatter) and the modeled unresolved electron dissipation $D_{e,\\mathrm{model}}$ are given by sums over resolved modes. Impose that model coefficients are determined by global energy constraints: given target net SGS energy flux $\\Pi_{\\mathrm{target}}$ and target unresolved electron dissipation $D_{e,\\mathrm{target}}$ consistent with a steady-state balance, choose coefficients so that the modeled aggregates match the targets, and compute the resulting energy-balance error $\\varepsilon = \\Pi_{\\mathrm{model}} - D_{e,\\mathrm{model}}$, where exact energy conservation at steady state would require $\\varepsilon = 0$ when electron dissipation is the only unresolved sink.\n\n- Implement a program that, for each test case, takes as input the resolved spectral data and the target aggregates, computes the model coefficients, and returns the set of outputs described below.\n\nUse the following modeling simplifications grounded in the above derivation:\n\n- Let the resolved rate-of-strain magnitude squared per mode be $S_k^2 \\propto k_\\perp^4 |\\overline{\\phi}_k|^2$. In normalized units compatible with a unit magnetic field magnitude and constant density, take $S_k^2 = k_\\perp^4 \\, |\\overline{\\phi}_k|^2$.\n\n- Let the modeled net SGS energy flux aggregate be $\\Pi_{\\mathrm{model}} = 2 \\, \\nu_t \\sum_{k \\in \\mathcal{K}_{\\mathrm{res}}} S_k^2$, where $\\nu_t$ is the eddy-viscosity-like SGS coefficient and $\\mathcal{K}_{\\mathrm{res}}$ is the set of resolved wavenumbers with $k_\\perp \\rho_i \\le \\kappa_c$. The factor $2$ is the canonical coefficient that appears in the resolved kinetic energy budget for eddy viscosity in two-dimensional incompressible flow expressed via rate-of-strain.\n\n- Let the modeled unresolved electron dissipation aggregate be $D_{e,\\mathrm{model}} = \\mu_e \\sum_{k \\in \\mathcal{K}_{\\mathrm{res}}} S_k^2$, where $\\mu_e$ is the electron SGS dissipation coefficient, consistent with a linear damping operator whose free-energy sink rate is proportional to $k_\\perp^4 |\\overline{\\phi}_k|^2$ in the electrostatic limit. Use the same normalized units so that the proportionality constant equals $1$.\n\nThe algorithm to determine $\\nu_t$ and $\\mu_e$ should be:\n\n- If $\\sum_{k \\in \\mathcal{K}_{\\mathrm{res}}} S_k^2$ is below a small numerical threshold, set $\\nu_t = 0$, $\\mu_e = 0$, $\\Pi_{\\mathrm{model}} = 0$, $D_{e,\\mathrm{model}} = 0$, and $\\varepsilon = 0$.\n\n- Otherwise, enforce the aggregate constraints $\\Pi_{\\mathrm{model}} = \\Pi_{\\mathrm{target}}$ and $D_{e,\\mathrm{model}} = D_{e,\\mathrm{target}}$ to determine $\\nu_t$ and $\\mu_e$. Compute the energy-balance error $\\varepsilon = \\Pi_{\\mathrm{model}} - D_{e,\\mathrm{model}}$.\n\nAll quantities in this problem are dimensionless; report all outputs without units. Angles are not involved.\n\nTest suite and output specification:\n\nFor each test case, you are given the resolved perpendicular wavenumbers $k_\\perp \\rho_i$ and resolved electrostatic potential spectrum amplitudes $|\\overline{\\phi}_k|$:\n\n- Test case $1$:\n    - $k_\\perp \\rho_i$ values: $[0.3, 0.5, 0.8, 1.0]$\n    - $|\\overline{\\phi}_k|$ values: $[0.8, 0.6, 0.4, 0.2]$\n    - $\\Pi_{\\mathrm{target}} = 0.05$\n    - $D_{e,\\mathrm{target}} = 0.05$\n\n- Test case $2$:\n    - $k_\\perp \\rho_i$ values: $[0.2, 0.4, 0.7, 0.9]$\n    - $|\\overline{\\phi}_k|$ values: $[0.5, 0.7, 0.3, 0.1]$\n    - $\\Pi_{\\mathrm{target}} = -0.02$\n    - $D_{e,\\mathrm{target}} = 0.01$\n\n- Test case $3$ (boundary condition with vanishing resolved content):\n    - $k_\\perp \\rho_i$ values: $[0.1, 0.3, 1.0]$\n    - $|\\overline{\\phi}_k|$ values: $[0.0, 0.0, 0.0]$\n    - $\\Pi_{\\mathrm{target}} = 0.0$\n    - $D_{e,\\mathrm{target}} = 0.0$\n\n- Test case $4$ (near-cutoff emphasis):\n    - $k_\\perp \\rho_i$ values: $[0.95, 1.0]$\n    - $|\\overline{\\phi}_k|$ values: $[0.4, 0.4]$\n    - $\\Pi_{\\mathrm{target}} = 0.02$\n    - $D_{e,\\mathrm{target}} = 0.015$\n\nYour program should, for each test case, compute the list $[\\nu_t, \\mu_e, \\varepsilon]$, where $\\nu_t$ and $\\mu_e$ are computed as above, and $\\varepsilon = \\Pi_{\\mathrm{model}} - D_{e,\\mathrm{model}}$. The final output must be a single line containing a comma-separated list of these lists, enclosed in square brackets (for example, $[[\\nu_t^{(1)},\\mu_e^{(1)},\\varepsilon^{(1)}],[\\nu_t^{(2)},\\mu_e^{(2)},\\varepsilon^{(2)}],\\dots]$), with each floating-point number rounded to six decimal places.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It is based on established principles of gyrokinetic (GK) theory and turbulence modeling, specifically the Large-Eddy Simulation (LES) of plasma turbulence. The provided models, while simplified, are representative of energy-conserving subgrid-scale (SGS) closures used in the field. All necessary data and a clear algorithm are provided, making the problem solvable. No contradictions, ambiguities, or factual errors are present. The problem is therefore deemed **valid**.\n\nThe solution proceeds in two parts: first, a derivation of the physical and mathematical basis for the model, and second, the application of the specified algorithm to the provided test cases.\n\nThe core of the problem lies in the energy budget of a turbulent system under an LES filtering operation. In electrostatic GK theory, the total free energy $\\mathcal{E}$ of the system, a sum of species contributions $\\mathcal{E}_s$, is conserved in the absence of external drives and collisional dissipation. The time evolution of the free energy is governed by the GK equation. The nonlinear term, representing the advection of the distribution function $f_s$ by the $\\mathbf{E}\\times\\mathbf{B}$ velocity $\\mathbf{v}_E$, is responsible for the transfer of energy between different spatial scales.\n\nThe LES procedure partitions all fields into resolved (large-scale) components, denoted by an overbar (e.g., $\\overline{\\phi}$), and subgrid-scale (SGS) components, denoted by a prime (e.g., $\\phi'$). The cutoff is set at a perpendicular wavenumber $k_\\perp \\rho_i = \\kappa_c \\approx 1$, separating ion-scale dynamics from electron-scale dynamics. Applying this filter to the GK equation for the resolved distribution $\\overline{f}_s$ isolates a term that represents the influence of the unresolved SGS fields on the resolved dynamics. This term, arising from the filtered nonlinear advection term $\\overline{\\mathbf{v}_E \\cdot \\nabla_\\perp f_s}$, leads to an energy flux, $\\Pi$, across the wavenumber cutoff $\\kappa_c$. This flux represents the net transfer of free energy from the resolved scales to the SGS scales. A positive $\\Pi$ signifies a forward cascade (resolved to unresolved), while a negative $\\Pi$ signifies backscatter (unresolved to resolved).\n\nThe problem then specializes to the dynamics in the perpendicular plane, assuming statistical isotropy. The resolved $\\mathbf{E}\\times\\mathbf{B}$ velocity $\\mathbf{u}_E = (\\mathbf{B} \\times \\nabla_\\perp \\overline{\\phi}) / B^2$ is modeled as a two-dimensional incompressible flow. With the magnetic field $\\mathbf{B}$ aligned with the $\\hat{\\mathbf{z}}$ direction, we can write $\\mathbf{u}_E = \\hat{\\mathbf{z}} \\times \\nabla_\\perp (\\overline{\\phi}/B)$. This means the quantity $\\psi = \\overline{\\phi}/B$ acts as the streamfunction for the flow. In the normalized units of the problem, we can absorb $B$ and treat $\\overline{\\phi}$ as the streamfunction directly, such that $\\mathbf{u}_E = \\hat{\\mathbf{z}} \\times \\nabla_\\perp \\overline{\\phi}$.\n\nThe energy flux $\\Pi$ must be modeled. In fluid turbulence, the SGS energy flux is often modeled via an eddy viscosity $\\nu_t$ acting on the resolved flow. The dissipation rate due to viscosity is proportional to the resolved rate-of-strain tensor squared, $S_{ij} = \\frac{1}{2}(\\partial_j u_i + \\partial_i u_j)$. The total power dissipated is $2\\nu_t \\int \\sum_{i,j} S_{ij}^2 dV$. For a 2D incompressible flow with streamfunction $\\overline{\\phi}$, this integral can be related to the enstrophy, which is the integral of the squared vorticity $\\omega_z^2 = (\\nabla_\\perp^2 \\overline{\\phi})^2$. Specifically, $\\int \\sum_{i,j} S_{ij}^2 dV = \\frac{1}{2} \\int \\omega_z^2 dV$. In Fourier space, a field $\\overline{\\phi}(\\mathbf{x}_\\perp) = \\sum_k \\overline{\\phi}_k e^{i \\mathbf{k}_\\perp \\cdot \\mathbf{x}_\\perp}$ has a vorticity spectrum $\\widehat{\\omega_z}_k = -k_\\perp^2 \\overline{\\phi}_k$. By Parseval's theorem, the total enstrophy is proportional to $\\sum_k k_\\perp^4 |\\overline{\\phi}_k|^2$. Therefore, modeling the SGS energy transfer rate as being proportional to the spectrally-decomposed resolved enstrophy is a physically motivated choice. The problem defines the quantity $S_k^2 = k_\\perp^4 |\\overline{\\phi}_k|^2$ as the \"resolved rate-of-strain magnitude squared per mode,\" consistent with this reasoning. The model for the net SGS energy flux is thus $\\Pi_{\\mathrm{model}} = 2 \\nu_t \\sum_k S_k^2$. The factor of $2$ is canonical for the power dissipated by the full rate-of-strain tensor.\n\nConcurrently, the energy transferred to the electron scales ($k_\\perp \\rho_i  1$) is ultimately dissipated. This dissipation, $D_e$, is a physical sink of free energy. A common model for this dissipation links it to the magnitude of the shear driving the electron-scale turbulence. The shear is related to spatial gradients of the velocity, or second derivatives of the potential $\\overline{\\phi}$. A dissipation rate quadratic in the field amplitudes and proportional to the square of the shear leads naturally to a model of the form $D_{e,\\mathrm{model}} = \\mu_e \\sum_k k_\\perp^4 |\\overline{\\phi}_k|^2 = \\mu_e \\sum_k S_k^2$. The coefficient $\\mu_e$ parameterizes the efficiency of this SGS dissipation mechanism.\n\nThe core of the computational task is to determine the model coefficients $\\nu_t$ and $\\mu_e$ by enforcing that the modeled aggregate quantities match their target values, which are assumed to be known from either theory or a higher-fidelity simulation. Let $\\mathcal{S} = \\sum_{k \\in \\mathcal{K}_{\\mathrm{res}}} S_k^2 = \\sum_k k_\\perp^4 |\\overline{\\phi}_k|^2$. The model equations are:\n$$\n\\Pi_{\\mathrm{model}} = 2 \\nu_t \\mathcal{S} = \\Pi_{\\mathrm{target}}\n$$\n$$\nD_{e,\\mathrm{model}} = \\mu_e \\mathcal{S} = D_{e,\\mathrm{target}}\n$$\nIf $\\mathcal{S}$ is non-zero, these equations can be solved for the coefficients:\n$$\n\\nu_t = \\frac{\\Pi_{\\mathrm{target}}}{2 \\mathcal{S}}\n$$\n$$\n\\mu_e = \\frac{D_{e,\\mathrm{target}}}{\\mathcal{S}}\n$$\nA special case arises if $\\mathcal{S}$ is zero or numerically indistinguishable from zero (i.e., below a threshold). This corresponds to a state with no resolved turbulent activity. In this case, there is no resolved strain to act upon, so the modeled energy flux and dissipation must be zero. The problem specifies setting $\\nu_t=0$, $\\mu_e=0$, which correctly yields $\\Pi_{\\mathrm{model}}=0$ and $D_{e,\\mathrm{model}}=0$.\n\nFinally, the energy-balance error $\\varepsilon$ is defined as the difference between the modeled energy transfer *out* of the resolved scales and the modeled energy sink *in* the unresolved scales: $\\varepsilon = \\Pi_{\\mathrm{model}} - D_{e,\\mathrm{model}}$. In a statistically steady state where electron dissipation is the only SGS sink, we would expect $\\Pi = D_e$, so $\\varepsilon = 0$. By substituting the target constraints, we find $\\varepsilon = \\Pi_{\\mathrm{target}} - D_{e,\\mathrm{target}}$ (when $\\mathcal{S}$ is non-zero). A non-zero $\\varepsilon$ indicates that the targets themselves are not balanced, implying the existence of other energy channels not captured by this minimal model (e.g., direct ion dissipation, energy storage in SGS fields).\n\nThe algorithm is as follows for each test case:\n$1$. Given the lists of resolved wavenumbers $k_j$ and potential amplitudes $|\\overline{\\phi}_j|$, calculate the sum of the squared strain rates: $\\mathcal{S} = \\sum_j (k_j)^4 |\\overline{\\phi}_j|^2$.\n$2$. Check if $\\mathcal{S}$ is below a small numerical threshold (e.g., $10^{-12}$).\n$3$. If $\\mathcal{S}$ is below the threshold, set $[\\nu_t, \\mu_e, \\varepsilon] = [0, 0, 0]$.\n$4$. Otherwise, calculate the coefficients $\\nu_t = \\Pi_{\\mathrm{target}}/(2 \\mathcal{S})$ and $\\mu_e = D_{e,\\mathrm{target}}/\\mathcal{S}$.\n$5$. Calculate the energy-balance error $\\varepsilon = \\Pi_{\\mathrm{target}} - D_{e,\\mathrm{target}}$.\n$6$. Collect the results $[\\nu_t, \\mu_e, \\varepsilon]$ for each test case.",
            "answer": "[[0.187660,0.375319,0.000000],[-0.243197,0.243197,-0.030000],[0.000000,0.000000,0.000000],[0.034445,0.051668,0.005000]]"
        }
    ]
}