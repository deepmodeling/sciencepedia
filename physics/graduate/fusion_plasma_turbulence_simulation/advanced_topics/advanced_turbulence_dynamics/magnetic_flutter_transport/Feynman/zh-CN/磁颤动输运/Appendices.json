{
    "hands_on_practices": [
        {
            "introduction": "该实践旨在介绍微观涨落与宏观输运之间的基本联系。我们将阐明，输运不仅仅取决于涨落的幅度，更关键地依赖于不同涨落量（此处为密度和磁场）之间的相位关系。本练习提供了一个具体的、定量的计算，利用傅里叶分析这一湍流理论的基石，来揭示这一原理。",
            "id": "4195053",
            "problem": "在一个具有与坐标$z$对齐的强度为$B_0$的强而均匀的引导磁场的直场线磁通管模型中，粒子种类$s$的径向磁扰动速度建模为 $v_{r,\\mathrm{fl}} = v_{\\parallel s}\\,\\delta b_r$，其中$v_{\\parallel s}$是粒子种类$s$的一个恒定的特征平行速度，而$\\delta b_r \\doteq \\delta B_r/B_0$是无量纲的径向磁扰动。粒子种类$s$的磁扰动粒子通量定义为统计平均$\\Gamma^{\\mathrm{fl}}_s \\doteq \\langle \\delta n_s\\, v_{r,\\mathrm{fl}} \\rangle$，其中$\\delta n_s$是粒子种类$s$的密度涨落。假设在垂直$(x,y)$平面内存在统计稳恒且均匀的湍流，并使用傅里叶表示\n$$\nf(\\mathbf{x}) \\;=\\; \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,\\tilde{f}(\\mathbf{k})\\,\\exp\\!\\big(i\\,\\mathbf{k}\\cdot\\mathbf{x}\\big),\n$$\n其相关的互功率谱密度$C_{fg}(\\mathbf{k})$由$\\langle \\tilde{f}(\\mathbf{k})\\,\\tilde{g}(\\mathbf{k}')^{*}\\rangle \\;=\\; (2\\pi)^2 \\delta(\\mathbf{k}-\\mathbf{k}')\\,C_{fg}(\\mathbf{k})$定义，因此$\\langle f\\,g\\rangle \\;=\\; \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{fg}(\\mathbf{k})$。此处$^{*}$表示复共轭。\n\n假设密度涨落和归一化径向磁涨落的复谱满足其互功率谱密度由它们的模长和一个与波数无关的互相位的乘积生成。具体来说，设傅里叶复振幅为\n$$\n\\tilde{n}_s(\\mathbf{k}) \\;=\\; \\mathcal{N}_0\\,\\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2}\\Big)\\,\\exp\\!\\big(i\\,\\phi_n\\big),\\qquad\n\\widetilde{\\delta b}_r(\\mathbf{k}) \\;=\\; \\mathcal{B}_0\\,\\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2}\\Big)\\,\\exp\\!\\big(i\\,\\phi_b\\big),\n$$\n其中常数$\\mathcal{N}_0>0$，$\\mathcal{B}_0>0$和$\\sigma>0$。将$v_{\\parallel s}$视为一个恒定参数。你可以假设系综平均仅作用于相位，因此$C_{n b}(\\mathbf{k}) = \\langle \\tilde{n}_s(\\mathbf{k})\\,\\widetilde{\\delta b}_r(\\mathbf{k})^{*}\\rangle = \\mathcal{N}_0 \\mathcal{B}_0 \\exp\\!\\big(-|\\mathbf{k}|^2/\\sigma^2\\big)\\exp\\!\\big(i(\\phi_n-\\phi_b)\\big)$。\n\n从以上定义出发，不引用任何额外公式，计算准线性磁扰动粒子通量$\\Gamma^{\\mathrm{fl}}_s$的闭合形式，作为给定参数的函数。此外，对于固定的$\\mathcal{N}_0$、$\\mathcal{B}_0$、$\\sigma$和$v_{\\parallel s}$，找出使$\\Gamma^{\\mathrm{fl}}_s$最大化和最小化的$\\phi_n$与$\\phi_b$之间的相位关系。以弧度报告相角。将通量$\\Gamma^{\\mathrm{fl}}_s$表示为单个解析表达式；如果进行数值计算，其单位应表示为$\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。不要在你最终的方框答案中包含单位。",
            "solution": "用户希望我解决一个问题。根据指示，我将首先验证问题陈述。\n\n### 步骤1：提取已知条件\n- **模型**：直场线磁通管。\n- **引导磁场**：强度为$B_0$，与$z$坐标对齐。\n- **径向磁扰动速度**：$v_{r,\\mathrm{fl}} = v_{\\parallel s}\\,\\delta b_r$。\n- **特征平行速度**：对于粒子种类$s$，$v_{\\parallel s}$是一个常数。\n- **归一化径向磁扰动**：$\\delta b_r \\doteq \\delta B_r/B_0$。\n- **磁扰动粒子通量**：$\\Gamma^{\\mathrm{fl}}_s \\doteq \\langle \\delta n_s\\, v_{r,\\mathrm{fl}} \\rangle$。\n- **密度涨落**：$\\delta n_s$。\n- **湍流特性**：在垂直$(x,y)$平面内统计稳恒且均匀。\n- **傅里叶表示**：$f(\\mathbf{x}) = \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,\\tilde{f}(\\mathbf{k})\\,\\exp(i\\,\\mathbf{k}\\cdot\\mathbf{x})$。\n- **互功率谱密度定义**：$\\langle \\tilde{f}(\\mathbf{k})\\,\\tilde{g}(\\mathbf{k}')^{*}\\rangle = (2\\pi)^2 \\delta(\\mathbf{k}-\\mathbf{k}')\\,C_{fg}(\\mathbf{k})$。\n- **通量-谱关系**：$\\langle f\\,g\\rangle = \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{fg}(\\mathbf{k})$。\n- **密度涨落的傅里叶振幅**：$\\tilde{n}_s(\\mathbf{k}) = \\mathcal{N}_0\\,\\exp(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2})\\,\\exp(i\\,\\phi_n)$。\n- **磁涨落的傅里叶振幅**：$\\widetilde{\\delta b}_r(\\mathbf{k}) = \\mathcal{B}_0\\,\\exp(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2})\\,\\exp(i\\,\\phi_b)$。\n- **常数**：$\\mathcal{N}_0>0$，$\\mathcal{B}_0>0$，$\\sigma>0$。\n- **假设的互功率谱密度**：$C_{n b}(\\mathbf{k}) = \\langle \\tilde{n}_s(\\mathbf{k})\\,\\widetilde{\\delta b}_r(\\mathbf{k})^{*}\\rangle = \\mathcal{N}_0 \\mathcal{B}_0 \\exp(-|\\mathbf{k}|^2/\\sigma^2)\\exp(i(\\phi_n-\\phi_b))$。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学性**：该问题描述了一个典型的准线性计算，关于磁化等离子体中由磁涨落引起的粒子输运。所有概念、定义和数学框架（傅里叶分析、统计平均）在等离子体物理和湍流理论领域都是标准的。谱的高斯形状是一个常见的简化假设。该问题在科学上是合理的。\n2.  **良构性**：该问题提供了计算所需量所必需的所有定义、函数形式和参数。通量的积分是良定义且收敛的。目标陈述清晰。该问题是良构的。\n3.  **客观性**：该问题以精确、客观、数学化的语言表述，没有主观或含糊的陈述。\n4.  **完整性和一致性**：该问题是自洽的。在指定的平均程序下，所提供的互功率谱密度$C_{nb}(\\mathbf{k})$的公式与傅里叶振幅$\\tilde{n}_s(\\mathbf{k})$和$\\widetilde{\\delta b}_r(\\mathbf{k})$的给定形式是一致的。虽然像密度这样的物理量是实数，这对其傅里叶变换施加了约束（$\\tilde{f}(\\mathbf{k}) = \\tilde{f}^*(-\\mathbf{k})$），但在这种准线性计算中的常见做法是使用复数表示，并对通量的最终结果取实部。这种解释解决了任何明显的矛盾，并且在该领域是标准的。\n5.  **现实性**：该模型是一个理想化模型（例如，直场线、恒定的平行速度、固定的相位），但这种理想化在理论等离子体物理中是标准的，用于推导基本的输运估算。在其理论背景下，该问题并非不切实际。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个理论等离子体物理学中标准的、良构的问题。我现在将进行求解。\n\n粒子种类$s$的磁扰动粒子通量定义为密度涨落$\\delta n_s$与径向扰动速度$v_{r,\\mathrm{fl}}$乘积的统计平均。\n$$\n\\Gamma^{\\mathrm{fl}}_s \\doteq \\langle \\delta n_s\\, v_{r,\\mathrm{fl}} \\rangle\n$$\n径向扰动速度由$v_{r,\\mathrm{fl}} = v_{\\parallel s}\\,\\delta b_r$给出，其中$v_{\\parallel s}$是一个常数。将此代入通量定义，我们得到：\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\langle \\delta n_s\\, (v_{\\parallel s}\\,\\delta b_r) \\rangle = v_{\\parallel s} \\langle \\delta n_s\\, \\delta b_r \\rangle\n$$\n问题给出了两个涨落场$f$和$g$乘积的空间平均与其互功率谱密度$C_{fg}(\\mathbf{k})$之间的关系。\n$$\n\\langle f\\,g\\rangle = \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{fg}(\\mathbf{k})\n$$\n将此公式应用于我们的通量表达式，我们有$f=\\delta n_s$和$g=\\delta b_r$。相应的互功率谱密度是$C_{nb}(\\mathbf{k})$。因此，通量由下式给出：\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s} \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{nb}(\\mathbf{k})\n$$\n问题指明互功率谱密度为：\n$$\nC_{n b}(\\mathbf{k}) = \\mathcal{N}_0 \\mathcal{B}_0 \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big)\\exp\\!\\big(i(\\phi_n-\\phi_b)\\big)\n$$\n物理粒子通量作为一个可测量量，必须是实数。$C_{nb}(\\mathbf{k})$的表达式是复数。在准线性理论中，当使用复数波表示计算相关性时，像通量这样的二次量的物理结果是通过取实部得到的。因此，我们计算：\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\text{Re} \\left( v_{\\parallel s} \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2}\\,C_{nb}(\\mathbf{k}) \\right)\n$$\n让我们代入$C_{nb}(\\mathbf{k})$的表达式并计算积分。设$\\Delta\\phi = \\phi_n - \\phi_b$。\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s}\\, \\text{Re} \\left[ \\int \\frac{d^2\\mathbf{k}}{(2\\pi)^2} \\mathcal{N}_0 \\mathcal{B}_0 \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big)\\exp(i\\Delta\\phi) \\right]\n$$\n不依赖于$\\mathbf{k}$的项可以移到积分之外：\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s}\\, \\frac{\\mathcal{N}_0 \\mathcal{B}_0}{(2\\pi)^2} \\text{Re} \\left[ \\exp(i\\Delta\\phi) \\int d^2\\mathbf{k} \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big) \\right]\n$$\n该积分是一个标准的二维高斯积分。我们可以通过在$\\mathbf{k}$空间中切换到极坐标来求解它，其中$\\mathbf{k}=(k\\cos\\theta, k\\sin\\theta)$，$|\\mathbf{k}|=k$，面积元为$d^2\\mathbf{k} = k\\,dk\\,d\\theta$。\n$$\n\\int d^2\\mathbf{k} \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big) = \\int_0^{2\\pi} d\\theta \\int_0^\\infty dk\\, k\\, \\exp\\!\\Big(-\\frac{k^2}{\\sigma^2}\\Big)\n$$\n对$\\theta$的积分得到一个因子$2\\pi$。对于径向积分，我们使用换元法$u=k^2/\\sigma^2$，这意味着$du = (2k/\\sigma^2)dk$，或者$k\\,dk = (\\sigma^2/2)du$。\n$$\n\\int_0^\\infty dk\\, k\\, \\exp\\!\\Big(-\\frac{k^2}{\\sigma^2}\\Big) = \\int_0^\\infty \\frac{\\sigma^2}{2} du\\, \\exp(-u) = \\frac{\\sigma^2}{2} [-\\exp(-u)]_0^\\infty = \\frac{\\sigma^2}{2} (0 - (-1)) = \\frac{\\sigma^2}{2}\n$$\n所以，二维积分的总值为：\n$$\n\\int d^2\\mathbf{k} \\exp\\!\\Big(-\\frac{|\\mathbf{k}|^2}{\\sigma^2}\\Big) = 2\\pi \\times \\frac{\\sigma^2}{2} = \\pi\\sigma^2\n$$\n将此结果代回通量表达式中：\n$$\n\\Gamma^{\\mathrm{fl}}_s = v_{\\parallel s}\\, \\frac{\\mathcal{N}_0 \\mathcal{B}_0}{(2\\pi)^2} \\text{Re} \\left[ \\exp(i\\Delta\\phi) (\\pi\\sigma^2) \\right] = v_{\\parallel s}\\, \\frac{\\mathcal{N}_0 \\mathcal{B}_0 \\pi\\sigma^2}{4\\pi^2} \\text{Re} [\\exp(i\\Delta\\phi)]\n$$\n简化表达式并使用欧拉公式$\\exp(i\\Delta\\phi) = \\cos(\\Delta\\phi) + i\\sin(\\Delta\\phi)$：\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\frac{v_{\\parallel s} \\mathcal{N}_0 \\mathcal{B}_0 \\sigma^2}{4\\pi} \\text{Re}[\\cos(\\Delta\\phi) + i\\sin(\\Delta\\phi)]\n$$\n实部就是$\\cos(\\Delta\\phi)$。通量的最终闭合形式表达式是：\n$$\n\\Gamma^{\\mathrm{fl}}_s = \\frac{v_{\\parallel s} \\mathcal{N}_0 \\mathcal{B}_0 \\sigma^2}{4\\pi} \\cos(\\phi_n - \\phi_b)\n$$\n接下来，我们必须确定使该通量最大化和最小化的相位关系。参数$v_{\\parallel s}$、$\\mathcal{N}_0$、$\\mathcal{B}_0$和$\\sigma$都是正常数。因此，通量的最大化或最小化取决于$\\cos(\\phi_n - \\phi_b)$项的值。\n\n当$\\cos(\\phi_n - \\phi_b)$取最大值时，通量$\\Gamma^{\\mathrm{fl}}_s$达到最大。余弦函数的最大值是$1$。这发生在相位差是$2\\pi$的偶数倍时：\n$$\n\\phi_n - \\phi_b = 2m\\pi, \\quad \\text{对于任意整数 } m\n$$\n这对应于密度和磁场涨落同相。最简单的情况是相位差为$0$弧度。\n\n当$\\cos(\\phi_n - \\phi_b)$取最小值时，通量$\\Gamma^{\\mathrm{fl}}_s$达到最小。余弦函数的最小值是$-1$。这发生在相位差是$\\pi$的奇数倍时：\n$$\n\\phi_n - \\phi_b = (2m+1)\\pi, \\quad \\text{对于任意整数 } m\n$$\n这对应于密度和磁场涨落反相。最简单的情况是相位差为$\\pi$弧度。最小通量是负值，表示向内的粒子通量（一种箍缩）。如果问题是关于通量的大小，则最小大小为零，这发生在$\\cos(\\phi_n - \\phi_b)=0$时，即$\\phi_n - \\phi_b = (m+1/2)\\pi$。然而，最小化通量的代数值是标准的解释。",
            "answer": "$$\n\\boxed{\\pmatrix{ \\frac{v_{\\parallel s} \\mathcal{N}_0 \\mathcal{B}_0 \\sigma^2}{4\\pi} \\cos(\\phi_n - \\phi_b) & 0 & \\pi }}\n$$"
        },
        {
            "introduction": "在颤振驱动输运概念的基础上，该实践将探讨其物理后果。我们将使用一个简单的随机游走模型来理解为何磁颤振在输运热量（由快速运动的电子携带）方面远比输运动量（由较慢的离子携带）更有效。本练习最终将推导出有效普朗特数，这是一个量化这种差异的关键无量纲参数，为我们提供了对随机磁场输运本质的深刻物理洞察。",
            "id": "4195005",
            "problem": "考虑一个大环径比托卡马克芯部等离子体，其磁场为 $\\mathbf{B} = B_{0}\\,\\mathbf{b} + \\delta \\mathbf{B}_{\\perp}$，其中 $|\\delta \\mathbf{B}_{\\perp}| \\ll B_{0}$ 且 $\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$。假设磁力线是随机的，平行相关长度为 $L_{c}$，并且粒子在比磁力线退相关时间更短的时间尺度上沿 $\\mathbf{b}$ 自由流动。采用一个简单的、基于第一性原理的随机行走模型，其中导心穿过磁通量面的位移是由于沿扰动磁力线连续经过多个平行相关长度而产生的。\n\n从沿磁场的导心运动方程和跨场扩散系数的随机行走定义出发，推导磁扰动驱动的电子热扩散系数 $\\chi_{e}^{\\mathrm{fl}}$ 和离子动量扩散系数（有效粘度）$\\nu_{i}^{\\mathrm{fl}}$ 的参数表达式，用平行流速度、$L_{c}$ 和振幅比 $|\\delta \\mathbf{B}_{\\perp}|/B_{0}$ 来表示。然后，利用这些表达式，计算有效普朗特数 $Pr^{\\mathrm{fl}}$，其定义为磁扰动驱动的动量扩散系数与磁扰动驱动的热扩散系数之比。假设在此机制中，电子负责热输运，离子负责动量输运，粒子热速度为 $v_{t s} = \\sqrt{2 T_{s} / m_{s}}$，其中 $s \\in \\{e,i\\}$ 表示粒子种类，$T_{s}$ 是该粒子的温度，$m_{s}$ 是该粒子的质量。\n\n使用以下参数获得数值：电子质量 $m_{e} = 9.11 \\times 10^{-31}\\,\\mathrm{kg}$，质子质量 $m_{p} = 1.67 \\times 10^{-27}\\,\\mathrm{kg}$，离子种类为氘，其质量 $m_{i} = 2 m_{p}$，且温度满足 $T_{e} = T_{i}$。为便于理解物理背景，可取 $B_{0} = 3\\,\\mathrm{T}$、$|\\delta \\mathbf{B}_{\\perp}|/B_{0} = 1.0 \\times 10^{-3}$ 和 $L_{c} = 2.0\\,\\mathrm{m}$，但请注意，你最终得到的 $Pr^{\\mathrm{fl}}$ 表达式应能揭示其中发生的任何参数相消。\n\n将你最终得到的 $Pr^{\\mathrm{fl}}$ 数值答案四舍五入至三位有效数字。答案应表示为一个纯数（无量纲）。在你的推导中，简要解释 $Pr^{\\mathrm{fl}}$ 的大小在磁扰动驱动的热量与动量输运相对效率方面的物理含义。",
            "solution": "问题陈述已通过验证，并被认为是有效的。它在科学上基于等离子体物理和输运理论的原理，特别是关于随机磁场输运的 Rechester-Rosenbluth 模型。该问题设定良好、客观，并包含了获得唯一解所需的所有必要信息，没有任何内部矛盾或对不切实际假设的依赖。\n\n我们首先基于随机行走模型推导跨场扩散系数的一般表达式。扩散系数 $D$ 可建模为 $D \\approx (\\Delta r)^2 / \\Delta t$，其中 $\\Delta r$ 是特征径向步长，$\\Delta t$ 是完成该步长所需的特征时间。\n\n在磁扰动输运模型中，粒子的导心沿着一条随机磁力线运动。径向位移是由扰动场分量 $\\delta \\mathbf{B}_{\\perp}$ 引起的。磁力线的轨迹由 $d\\mathbf{x} = \\mathbf{b} \\, ds$ 描述，其中 $ds$ 是沿磁力线的弧长元。在柱坐标近似下，径向分量为 $dr = b_r \\, ds$，其中 $b_r = \\delta B_r / |\\mathbf{B}| \\approx \\delta B_r / B_0$。在一个平行相关长度 $L_c$ 上，磁力线发生径向扩散。粒子沿磁力线移动距离 $L_c$ 所产生的特征径向步长 $\\Delta r$ 为：\n$$ \\Delta r \\approx \\left| \\frac{\\delta \\mathbf{B}_{\\perp}}{B_0} \\right| L_c $$\n符号 $|\\delta \\mathbf{B}_{\\perp}|/B_0$ 表示归一化的径向磁场涨落的幅度。\n\n$s$ 种类的粒子穿过这个平行相关长度 $L_c$ 所需的时间 $\\Delta t$ 由其特征平行流速度 $v_{\\parallel, s}$ 决定。\n$$ \\Delta t = \\frac{L_c}{v_{\\parallel, s}} $$\n将 $\\Delta r$ 和 $\\Delta t$ 的这些表达式代入随机行走扩散系数公式，得到一个依赖于粒子种类的扩散系数 $D_s$：\n$$ D_s \\approx \\frac{(\\Delta r)^2}{\\Delta t} = \\frac{\\left( \\left| \\frac{\\delta \\mathbf{B}_{\\perp}}{B_0} \\right| L_c \\right)^2}{L_c / v_{\\parallel, s}} = v_{\\parallel, s} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 $$\n\n现在，我们将这个通用公式应用于所提到的特定输运通道。\n\n首先，我们求电子热扩散系数 $\\chi_{e}^{\\mathrm{fl}}$。问题指出电子承载热输运。热电子的特征平行速度是它们的热速度 $v_{te}$。使用给定的定义 $v_{ts} = \\sqrt{2T_s/m_s}$，我们有 $v_{\\parallel, e} \\approx v_{te} = \\sqrt{2T_e/m_e}$。\n将此代入通用扩散系数表达式：\n$$ \\chi_{e}^{\\mathrm{fl}} \\approx v_{te} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 = \\sqrt{\\frac{2T_e}{m_e}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 $$\n\n其次，我们求离子动量扩散系数（有效粘度）$\\nu_{i}^{\\mathrm{fl}}$。问题指出离子承载动量输运。离子的特征平行速度是它们的热速度 $v_{ti} = \\sqrt{2T_i/m_i}$。\n将此代入通用扩散系数表达式：\n$$ \\nu_{i}^{\\mathrm{fl}} \\approx v_{ti} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 = \\sqrt{\\frac{2T_i}{m_i}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2 $$\n\n问题要求计算有效普朗特数 $Pr^{\\mathrm{fl}}$，定义为这两个扩散系数之比：\n$$ Pr^{\\mathrm{fl}} = \\frac{\\nu_{i}^{\\mathrm{fl}}}{\\chi_{e}^{\\mathrm{fl}}} $$\n代入推导出的表达式：\n$$ Pr^{\\mathrm{fl}} = \\frac{\\sqrt{\\frac{2T_i}{m_i}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2}{\\sqrt{\\frac{2T_e}{m_e}} L_c \\left( \\frac{|\\delta \\mathbf{B}_{\\perp}|}{B_0} \\right)^2} $$\n$L_c$ 和 $(|\\delta \\mathbf{B}_{\\perp}|/B_0)^2$ 项相消，表明在此模型中普朗特数仅取决于承载输运的粒子种类的性质。\n$$ Pr^{\\mathrm{fl}} = \\frac{\\sqrt{2T_i/m_i}}{\\sqrt{2T_e/m_e}} = \\sqrt{\\frac{T_i}{T_e} \\frac{m_e}{m_i}} $$\n这就是磁扰动驱动的普朗特数的参数表达式。\n\n为了计算数值，我们使用给定的参数：$T_e = T_i$，电子质量 $m_e = 9.11 \\times 10^{-31}\\,\\mathrm{kg}$，离子质量 $m_i$ 为氘的质量，是质子质量 $m_p = 1.67 \\times 10^{-27}\\,\\mathrm{kg}$ 的两倍。\n由于 $T_e = T_i$，温度比 $T_i/T_e = 1$。表达式简化为：\n$$ Pr^{\\mathrm{fl}} = \\sqrt{\\frac{m_e}{m_i}} $$\n离子质量为 $m_i = 2 m_p = 2 \\times (1.67 \\times 10^{-27}\\,\\mathrm{kg}) = 3.34 \\times 10^{-27}\\,\\mathrm{kg}$。\n代入质量的数值：\n$$ Pr^{\\mathrm{fl}} = \\sqrt{\\frac{9.11 \\times 10^{-31}\\,\\mathrm{kg}}{3.34 \\times 10^{-27}\\,\\mathrm{kg}}} = \\sqrt{\\frac{9.11}{3.34} \\times 10^{-4}} \\approx \\sqrt{2.7275 \\times 10^{-4}} $$\n$$ Pr^{\\mathrm{fl}} \\approx 1.6515 \\times 10^{-2} \\approx 0.016515 $$\n四舍五入到三位有效数字，我们得到 $0.0165$。\n\n结果 $Pr^{\\mathrm{fl}} \\approx 0.0165 \\ll 1$ 的物理含义是，磁扰动对于输运电子热量的效率远高于输运离子动量。输运速率与承载相应物理量（电子承载热量，离子承载动量）的粒子种类的平行流速度成正比。由于电子比离子轻得多，在相同温度下，其热速度显著更高 ($v_{te} \\gg v_{ti}$)。因此，电子热的径向输运远快于离子动量，导致普朗特数非常小。这是随机磁场中由平行电子动力学驱动的输运的一个典型特征。",
            "answer": "$$\n\\boxed{0.0165}\n$$"
        },
        {
            "introduction": "磁颤振的理论模型依赖于扰动磁场。该实践通过解决一个关键的实践挑战，将理论与模拟联系起来：如何在数值上表示这些场，同时遵守磁场无散度（$\\nabla \\cdot \\mathbf{B} = 0$）这一基本物理定律。您将实现一个标准的数值方案，从矢量势重构磁场，并验证该方法能将无散度条件维持在机器精度范围内，这是开发和分析湍流模拟代码的一项至关重要的技能。",
            "id": "4195006",
            "problem": "给定一个网格解析的标量场，表示扰动矢量势的平行分量，记为 $\\delta A_{\\parallel}(x,y,z)$。该场定义在板块几何中的一个均匀、周期性的笛卡尔网格上，坐标为 $(x,y,z)$。背景磁场的单位矢量被视为常数，并与 $z$ 轴对齐，即 $\\mathbf{b}_0 = \\hat{\\mathbf{z}}$，恒定的背景磁场大小为 $B_0$。目标是通过矢量势的旋度从 $\\delta A_{\\parallel}$ 重构一个螺线扰动磁场 $\\delta \\mathbf{B}$，并在将径向方向等同于 $x$ 的板块几何设定下，计算扰动场线单位矢量波动的径向分量 $\\delta b_r$。所有量均为无量纲。\n\n使用以下基本依据：\n- 麦克斯韦方程要求任何磁场 $\\mathbf{B}$ 都满足 $\\nabla \\cdot \\mathbf{B} = 0$。\n- 任何磁场都可以表示为矢量势的旋度：$\\mathbf{B} = \\nabla \\times \\mathbf{A}$。\n- 在适用于强引导场的简化描述中，扰动磁场可以从矢量势的平行分量重构为 $\\delta \\mathbf{B} = \\nabla \\times \\left(\\delta A_{\\parallel}\\,\\mathbf{b}_0\\right)$。\n- 对于小扰动，扰动场线单位矢量波动为 $\\delta \\mathbf{b} \\approx \\delta \\mathbf{B}_{\\perp}/B_0$，因此在 $r \\equiv x$ 的板块几何中，径向分量为 $\\delta b_r = \\delta B_x / B_0$。\n\n您必须使用中心有限差分和周期性边界条件，实现一种离散的、数值上满足螺线性的重构，以确保在离散层面上 $\\nabla \\cdot \\delta \\mathbf{B} = 0$ 在数值精度内成立。为此，请定义沿每个坐标的离散中心有限差分导数算子，网格间距分别为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$：\n- $D_x f_{i,j,k} = \\left(f_{i+1,j,k} - f_{i-1,j,k}\\right) / \\left(2\\,\\Delta x\\right)$，索引 $i$ 进行周期性回绕，\n- $D_y f_{i,j,k} = \\left(f_{i,j+1,k} - f_{i,j-1,k}\\right) / \\left(2\\,\\Delta y\\right)$，索引 $j$ 进行周期性回绕，\n- $D_z f_{i,j,k} = \\left(f_{i,j,k+1} - f_{i,j,k-1}\\right) / \\left(2\\,\\Delta z\\right)$，索引 $k$ 进行周期性回绕。\n\n当 $\\mathbf{b}_0 = \\hat{\\mathbf{z}}$ 时，通过 $\\delta A_{\\parallel}\\,\\hat{\\mathbf{z}}$ 的离散旋度，从 $\\delta A_{\\parallel}$ 重构离散扰动磁场分量：\n- $\\delta B_x = D_y \\delta A_{\\parallel}$，\n- $\\delta B_y = -\\,D_x \\delta A_{\\parallel}$，\n- $\\delta B_z = 0$。\n\n接下来，使用相同的中心算子计算离散散度：\n- $\\nabla \\cdot \\delta \\mathbf{B} = D_x \\delta B_x + D_y \\delta B_y + D_z \\delta B_z$。\n\n最后，计算场线单位矢量径向分量的扰动，\n- $\\delta b_r = \\delta B_x / B_0$。\n\n您的程序必须使用以下四个测试用例来实现上述计算。计算域在所有方向上都是周期性的，长度为 $L_x = 2\\pi$、$L_y = 2\\pi$ 和 $L_z = 2\\pi$，并在一个均匀网格上进行离散化。使用下面指定的整数网格大小 $N_x$、$N_y$ 和 $N_z$，并定义网格间距 $\\Delta x = L_x/N_x$、$\\Delta y = L_y/N_y$ 和 $\\Delta z = L_z/N_z$。所有情况均使用 $N_x = 64$、$N_y = 64$ 和 $N_z = 1$。\n\n对于每种情况，计算两个标量诊断量：\n- 离散散度的最大绝对值 $\\max_{i,j,k}\\left|\\nabla \\cdot \\delta \\mathbf{B}\\right|$，以及\n- $\\delta b_r$ 的均方根值，即 $\\sqrt{\\langle \\delta b_r^2 \\rangle}$，其中尖括号表示在网格上的体积平均。\n\n测试用例：\n- 情况 1：恒定场。设 $\\delta A_{\\parallel}(x,y,z) = c$，其中 $c = 1.234$，$B_0 = 1.0$。\n- 情况 2：单傅里叶模式。设 $\\delta A_{\\parallel}(x,y,z) = a \\cos\\left(m x\\right)\\,\\sin\\left(n y\\right)$，其中 $a = 0.2$，$m = 3$，$n = 5$，$B_0 = 2.0$。\n- 情况 3：接近分辨率极限的高波数模式。设 $\\delta A_{\\parallel}(x,y,z) = a \\cos\\left(m x\\right)\\,\\cos\\left(n y\\right)$，其中 $a = 0.01$，$m = 31$，$n = 30$，$B_0 = 1.3$。\n- 情况 4：具有固定种子的随机场。设 $\\delta A_{\\parallel}(x,y,z)$ 是从 $\\left[-\\tfrac{1}{2}, \\tfrac{1}{2}\\right]$ 上的均匀分布中抽取的独立同分布样本，由 $a = 0.1$ 缩放，使用固定的随机数生成器种子 $7$，$B_0 = 0.8$。\n\n您的程序必须：\n- 按所述构建网格和场，\n- 使用上述中心周期性有限差分计算 $\\delta \\mathbf{B}$、离散散度和 $\\delta b_r$，\n- 为每种情况按指定顺序返回两个诊断量。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序如下：\n- $\\left[\\mathrm{div}^{(1)}_{\\max}, \\mathrm{rms}^{(1)}_{\\delta b_r}, \\mathrm{div}^{(2)}_{\\max}, \\mathrm{rms}^{(2)}_{\\delta b_r}, \\mathrm{div}^{(3)}_{\\max}, \\mathrm{rms}^{(3)}_{\\delta b_r}, \\mathrm{div}^{(4)}_{\\max}, \\mathrm{rms}^{(4)}_{\\delta b_r}\\right]$,\n其中 $\\mathrm{div}^{(i)}_{\\max}$ 表示情况 $i$ 中的最大绝对散度，$\\mathrm{rms}^{(i)}_{\\delta b_r}$ 表示情况 $i$ 中 $\\delta b_r$ 的均方根。每个条目必须是浮点数。不需要物理单位；所有量都是无量纲的。三角函数中使用的角度以弧度为单位。任何地方都不使用百分比；所有标量输出都是无量纲浮点数。",
            "solution": "用户提供了一个问题，要求对等离子体物理模拟中的一个标准程序进行数值实现：从平行矢量势重构扰动磁场，并随后计算相关的诊断量。\n\n### 问题验证\n\n首先，根据指定的规程对问题陈述进行严格验证。\n\n**步骤 1：提取给定条件**\n- **输入场：** 标量场 $\\delta A_{\\parallel}(x,y,z)$，位于均匀、周期性的笛卡尔网格上。\n- **几何与坐标：** 板块几何，坐标为 $(x,y,z)$。\n- **背景场：** 恒定背景磁场 $\\mathbf{b}_0 = \\hat{\\mathbf{z}}$，大小为 $B_0$。\n- **目标：** 重构扰动磁场 $\\delta \\mathbf{B}$，并计算扰动场线单位矢量的径向分量 $\\delta b_r$。\n- **板块映射：** 径向坐标 $r$ 等同于 $x$。\n- **控制关系式：**\n    - $\\delta \\mathbf{B} = \\nabla \\times \\left(\\delta A_{\\parallel}\\,\\mathbf{b}_0\\right) = (\\partial_y \\delta A_{\\parallel}) \\hat{\\mathbf{x}} - (\\partial_x \\delta A_{\\parallel}) \\hat{\\mathbf{y}}$。\n    - $\\nabla \\cdot \\delta \\mathbf{B} = 0$（解析上）。\n    - $\\delta b_r = \\delta B_x / B_0$。\n- **数值方案：** 周期性网格上的中心有限差分。\n    - $D_c f_{i} = (f_{i+1} - f_{i-1}) / (2\\Delta c)$，其中 $c \\in \\{x,y,z\\}$。\n    - 离散场：$\\delta B_x = D_y \\delta A_{\\parallel}$，$\\delta B_y = -D_x \\delta A_{\\parallel}$，$\\delta B_z = 0$。\n    - 离散散度：$\\nabla \\cdot \\delta \\mathbf{B} = D_x \\delta B_x + D_y \\delta B_y + D_z \\delta B_z$。\n- **域与网格：** $L_x=2\\pi$，$L_y=2\\pi$，$L_z=2\\pi$；$N_x=64$，$N_y=64$，$N_z=1$。网格间距 $\\Delta c = L_c/N_c$。\n- **诊断量：**\n    - $\\max_{i,j,k}\\left|\\nabla \\cdot \\delta \\mathbf{B}\\right|$。\n    - $\\sqrt{\\langle \\delta b_r^2 \\rangle}$ (均方根)。\n- **测试用例：**\n    - 情况 1：$\\delta A_{\\parallel} = 1.234$，$B_0 = 1.0$。\n    - 情况 2：$\\delta A_{\\parallel} = 0.2 \\cos(3x)\\sin(5y)$，$B_0 = 2.0$。\n    - 情况 3：$\\delta A_{\\parallel} = 0.01 \\cos(31x)\\cos(30y)$，$B_0 = 1.3$。\n    - 情况 4：$\\delta A_{\\parallel} = 0.1 \\times \\mathcal{U}[-0.5, 0.5]$ (随机，种子=$7$)，$B_0 = 0.8$。\n\n**步骤 2：给定条件的验证**\n- **科学依据：** 该问题基于描述强引导场中磁扰动的标准简化模型。关系式 $\\delta \\mathbf{B} = \\nabla \\times (\\delta A_\\parallel \\mathbf{b}_0)$ 和 $\\delta b_r = \\delta B_x / B_0$ 是磁抖动和电磁湍流理论的基础。该前提在科学上是合理的。\n- **适定性：** 问题是适定的。数值程序是确定性的，并涉及标准的、稳定的数值方法（中心差分）。对于每个指定的输入情况，都存在一个唯一的、可计算的解。\n- **客观性：** 问题以精确的数学和计算术语陈述，没有歧义或主观性。\n- **完整性：** 所有必要的参数、方程、边界条件（周期性）和数值方法都已明确定义。\n- **一致性：** 定义是内部一致的。使用 $N_z=1$ 正确地将三维形式简化为有效的二维问题（$\\partial/\\partial z \\to 0$），这是模拟中常见的设置。核心科学点，即测试该方案的“数值上满足螺线性”的特性，是计算磁流体动力学中一个有效且重要的概念。\n\n**步骤 3：结论与行动**\n- **结论：** 问题是**有效的**。\n- **行动：** 继续提供完整的解决方案。\n\n### 解决方案\n\n目标是为四种不同形式的扰动平行矢量势 $\\delta A_{\\parallel}$ 计算两个诊断量。这需要在二维周期性网格上实现一个特定的数值算法，因为 $z$ 方向的网格大小为 $N_z=1$。\n\n**理论与数值框架**\n\n在适用于强引导磁场 $\\mathbf{B}_0 = B_0 \\mathbf{b}_0$ 的简化模型中，扰动磁场 $\\delta \\mathbf{B}$ 是从平行矢量势 $\\delta A_{\\parallel}$ 推导出来的。当引导场与 $z$ 轴对齐时，$\\mathbf{b}_0 = \\hat{\\mathbf{z}}$，矢量势为 $\\mathbf{A} = \\delta A_{\\parallel} \\hat{\\mathbf{z}}$。扰动磁场由其旋度给出：\n$$\n\\delta \\mathbf{B} = \\nabla \\times \\mathbf{A} = \\nabla \\times (\\delta A_{\\parallel} \\hat{\\mathbf{z}}) = \\left| \\begin{array}{ccc} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ \\partial_x & \\partial_y & \\partial_z \\\\ 0 & 0 & \\delta A_{\\parallel} \\end{array} \\right| = \\frac{\\partial (\\delta A_{\\parallel})}{\\partial y} \\hat{\\mathbf{x}} - \\frac{\\partial (\\delta A_{\\parallel})}{\\partial x} \\hat{\\mathbf{y}}\n$$\n分量为 $\\delta B_x = \\partial_y \\delta A_{\\parallel}$、$\\delta B_y = - \\partial_x \\delta A_{\\parallel}$ 和 $\\delta B_z = 0$。任何由旋度派生的场的关键特性是其散度为零：$\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$。对于我们的特定形式：\n$$\n\\nabla \\cdot \\delta \\mathbf{B} = \\frac{\\partial (\\delta B_x)}{\\partial x} + \\frac{\\partial (\\delta B_y)}{\\partial y} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial (\\delta A_{\\parallel})}{\\partial y} \\right) - \\frac{\\partial}{\\partial y} \\left( \\frac{\\partial (\\delta A_{\\parallel})}{\\partial x} \\right) = \\frac{\\partial^2 (\\delta A_{\\parallel})}{\\partial x \\partial y} - \\frac{\\partial^2 (\\delta A_{\\parallel})}{\\partial y \\partial x} = 0\n$$\n假设 $\\delta A_{\\parallel}$ 足够光滑，根据混合偏导数的相等性（克莱罗定理），该式为零。\n\n**离散化**\n\n我们在一个均匀的笛卡尔网格 $(x_i, y_j)$ 上离散化该系统，其中 $i \\in \\{0, ..., N_x-1\\}$ 且 $j \\in \\{0, ..., N_y-1\\}$。该域是周期性的，长度为 $L_x=2\\pi$ 和 $L_y=2\\pi$。网格间距为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。\n\n偏导数由二阶中心有限差分算子 $D_x$ 和 $D_y$ 近似，并采用周期性边界条件：\n$$\n(D_x f)_{i,j} = \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x} \\quad , \\quad (D_y f)_{i,j} = \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y}\n$$\n索引对其各自的网格大小取模（例如 $i+1 \\pmod{N_x}$）。离散磁场分量为：\n$$\n(\\delta B_x)_{i,j} = (D_y \\delta A_{\\parallel})_{i,j} \\quad , \\quad (\\delta B_y)_{i,j} = -(D_x \\delta A_{\\parallel})_{i,j}\n$$\n然后使用相同的算子计算离散散度：\n$$\n(\\nabla \\cdot \\delta\\mathbf{B})_{i,j} = (D_x \\delta B_x)_{i,j} + (D_y \\delta B_y)_{i,j} = (D_x D_y \\delta A_{\\parallel})_{i,j} - (D_y D_x \\delta A_{\\parallel})_{i,j}\n$$\n这些离散算子在周期性网格上的一个关键性质是它们是可交换的：$D_x D_y = D_y D_x$。这可以通过写出组合算子 $(D_x D_y f)_{i,j}$ 的计算模板来观察，它会对称地扩展为 $f_{i+1,j+1}$、$f_{i-1,j+1}$ 等项。因此，离散散度保证在机器精度内为零：\n$$\n(D_x D_y - D_y D_x) \\delta A_{\\parallel} = 0\n$$\n这个性质使得该方案“数值上满足螺线性”或“构造上无散”，这在磁场数值模拟中是一个非常理想的特性。其中一个诊断量 $\\max|\\nabla \\cdot \\delta\\mathbf{B}|$ 直接测试了这一性质。我们预期它会是一个非常小的数，量级为浮点舍入误差。\n\n**诊断量计算**\n\n1.  **最大绝对散度：** 通过计算 $(\\nabla \\cdot \\delta\\mathbf{B})_{i,j}$ 数组在所有网格点 $(i,j)$ 上的最大绝对值来获得。\n    $$\n    \\mathrm{div}_{\\max} = \\max_{i,j} |(\\nabla \\cdot \\delta\\mathbf{B})_{i,j}|\n    $$\n2.  **$\\delta b_r$ 的均方根：** 场线单位矢量波动的径向分量由 $\\delta b_r = \\delta B_x / B_0$ 给出。其均方根 (RMS) 值通过在整个网格（体积）上对其平方进行平均，然后取平方根来计算。对于 $N_x \\times N_y$ 网格上的离散场 $g_{i,j}$，体积平均为 $\\langle g \\rangle = \\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} g_{i,j}$。\n    $$\n    \\mathrm{rms}_{\\delta b_r} = \\sqrt{\\langle (\\delta b_r)^2 \\rangle} = \\sqrt{\\frac{1}{N_x N_y} \\sum_{i,j} \\left( \\frac{(\\delta B_x)_{i,j}}{B_0} \\right)^2}\n    $$\n\n**实现计划**\n\n将实现一个 Python 函数来处理每个测试用例的计算。\n1.  定义网格参数：$L_x=2\\pi, L_y=2\\pi, N_x=64, N_y=64$。\n2.  构建坐标数组 $x$ 和 $y$ 以及一个二维网格矩阵。\n3.  对于每种情况，构建 $\\delta A_{\\parallel}(x,y)$ 的二维数组。\n4.  使用 `numpy.roll` 实现中心差分算子 $D_x$ 和 $D_y$，以进行高效的周期性移位。\n5.  计算 $\\delta B_x = D_y \\delta A_{\\parallel}$ 和 $\\delta B_y = -D_x \\delta A_{\\parallel}$ 的数组。\n6.  计算散度数组 $\\nabla \\cdot \\delta \\mathbf{B} = D_x \\delta B_x + D_y \\delta B_y$。\n7.  从散度数组计算 $\\mathrm{div}_{\\max}$。\n8.  计算 $\\delta b_r$ 数组，然后计算其 RMS 值 $\\mathrm{rms}_{\\delta b_r}$。\n9.  存储每种情况的两个诊断量，并将最终输出格式化为单个逗号分隔的字符串。\n对于情况 4，使用固定种子为 $7$ 的随机数生成器以确保可复现性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It orchestrates the calculation of diagnostics for each case and prints the final result.\n    \"\"\"\n\n    # Global parameters for all cases\n    Nx, Ny, Nz = 64, 64, 1\n    Lx, Ly, Lz = 2 * np.pi, 2 * np.pi, 2 * np.pi\n    \n    # Define the 4 test cases as specified in the problem statement\n    test_cases = [\n        {'id': 1, 'type': 'constant', 'params': {'c': 1.234, 'B0': 1.0}},\n        {'id': 2, 'type': 'single_mode', 'params': {'a': 0.2, 'm': 3, 'n': 5, 'B0': 2.0}},\n        {'id': 3, 'type': 'high_k_mode', 'params': {'a': 0.01, 'm': 31, 'n': 30, 'B0': 1.3}},\n        {'id': 4, 'type': 'random', 'params': {'a': 0.1, 'seed': 7, 'B0': 0.8}},\n    ]\n\n    results = []\n    for case in test_cases:\n        diagnostics = compute_diagnostics(case, Nx, Ny, Lx, Ly)\n        results.extend(diagnostics)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_diagnostics(case, Nx, Ny, Lx, Ly):\n    \"\"\"\n    Computes the required diagnostics for a single test case.\n\n    Args:\n        case (dict): A dictionary containing the parameters for the test case.\n        Nx, Ny (int): Grid dimensions.\n        Lx, Ly (float): Domain sizes.\n\n    Returns:\n        tuple: A tuple containing (max_abs_div, rms_delta_br).\n    \"\"\"\n\n    # 1. Construct grid and delta_A_parallel field\n    dx, dy = Lx / Nx, Ly / Ny\n    \n    # Create coordinate arrays. endpoint=False is crucial for periodic domains.\n    x = np.linspace(0, Lx, Nx, endpoint=False)\n    y = np.linspace(0, Ly, Ny, endpoint=False)\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    params = case['params']\n    if case['type'] == 'constant':\n        delta_A_parallel = np.full((Nx, Ny), params['c'])\n    elif case['type'] == 'single_mode':\n        a, m, n = params['a'], params['m'], params['n']\n        delta_A_parallel = a * np.cos(m * xx) * np.sin(n * yy)\n    elif case['type'] == 'high_k_mode':\n        a, m, n = params['a'], params['m'], params['n']\n        delta_A_parallel = a * np.cos(m * xx) * np.cos(n * yy)\n    elif case['type'] == 'random':\n        rng = np.random.default_rng(params['seed'])\n        # Samples from U[-1, 1] then shift to U[-0.5, 0.5] and scale by 'a'\n        delta_A_parallel = params['a'] * (rng.random((Nx, Ny)) - 0.5)\n    \n    B0 = params['B0']\n\n    # 2. Implement centered finite difference operators using np.roll for periodicity\n    def d_dx(f):\n        return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * dx)\n\n    def d_dy(f):\n        return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * dy)\n\n    # 3. Compute perturbed magnetic field components\n    delta_Bx = d_dy(delta_A_parallel)\n    delta_By = -d_dx(delta_A_parallel)\n\n    # 4. Compute discrete divergence\n    # This should be zero to machine precision, which we will verify.\n    div_B = d_dx(delta_Bx) + d_dy(delta_By)\n\n    # 5. Compute diagnostics\n    # Diagnostic 1: Maximum absolute value of the discrete divergence\n    max_abs_div = np.max(np.abs(div_B))\n\n    # Diagnostic 2: Root-mean-square of delta_br\n    delta_br = delta_Bx / B0\n    rms_delta_br = np.sqrt(np.mean(delta_br**2))\n    \n    return (max_abs_div, rms_delta_br)\n\nsolve()\n```"
        }
    ]
}