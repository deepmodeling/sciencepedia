{
    "hands_on_practices": [
        {
            "introduction": "在模拟一个物理现象之前，我们必须理解其核心物理机制。本练习深入探讨了广义欧姆定律，这是控制磁重联的关键方程。通过从第一性原理出发推导该定律，并评估不同项的相对重要性，您将深刻理解为何在高温等离子体中，像电子压力梯度这样的双流体效应对于描述新经典撕裂模（NTM）至关重要，而电子惯性等其他效应通常可以忽略。",
            "id": "4208041",
            "problem": "一个正在经历新经典撕裂模 (NTM) 的托卡马克 (tokamak) 在一定尺度上表现出重联动力学，在该尺度下，电子惯性、压力梯度和碰撞电阻率都可能对维持磁重联的平行电场产生贡献。从双流体描述出发，考虑一个单电离的准中性等离子体，其电子数密度为 $n_{e}$，离子质量为 $m_{i} \\gg m_{e}$，其中 $m_{e}$ 是电子质量。电磁场为 $\\boldsymbol{E}$ 和 $\\boldsymbol{B}$，电子和离子的流体速度分别为 $\\boldsymbol{v}_{e}$ 和 $\\boldsymbol{v}_{i}$，电子压力为 $p_{e}$。电流密度定义为 $\\boldsymbol{J} \\equiv n_{e} e (\\boldsymbol{v}_{i} - \\boldsymbol{v}_{e})$，其中 $e$ 是元电荷的大小，质心速度为 $\\boldsymbol{v} \\equiv (m_{i} n_{i} \\boldsymbol{v}_{i} + m_{e} n_{e} \\boldsymbol{v}_{e})/(m_{i} n_{i} + m_{e} n_{e})$。假设准中性条件 $n_{i} \\simeq n_{e} \\equiv n$ 成立。电子-离子碰撞产生的拖曳力模型为 $- m_{e} n \\nu_{ei}(\\boldsymbol{v}_{e} - \\boldsymbol{v}_{i})$，其中 $\\nu_{ei}$ 是电子-离子碰撞频率。忽略电子粘性和位移电流。令 $\\boldsymbol{b} \\equiv \\boldsymbol{B}/B$ 表示沿磁场方向的单位矢量。\n\n1) 以电子动量方程为基础，推导质心系中的广义欧姆定律，并保留电子惯性、电子压力梯度和碰撞电阻率项。然后，沿磁场方向进行投影，得到平行电场 $E_{\\parallel} \\equiv \\boldsymbol{b} \\cdot \\boldsymbol{E}$ 关于 $J_{\\parallel} \\equiv \\boldsymbol{b} \\cdot \\boldsymbol{J}$、$p_{e}$ 及其导数（包括电子惯性项）的显式表达式。清楚地说明你用来将结果表示为 $\\boldsymbol{v}$ 和 $\\boldsymbol{J}$ 的函数时所使用的标准质量比和准中性近似，并用 $\\nu_{ei}$ 和基本常数定义电阻率 $\\eta$。\n\n2) 对于一个典型的NTM尺度的重联层，通过计算以下两个无量纲比值，估算电子惯性和压力梯度对 $E_{\\parallel}$ 的贡献相对于电阻率贡献的量级\n$$\nR_{\\mathrm{inertia}} \\equiv \\frac{\\left|\\frac{m_{e}}{n e^{2}} \\frac{\\partial J_{\\parallel}}{\\partial t}\\right|}{\\left|\\eta J_{\\parallel}\\right|}, \n\\qquad\nR_{\\mathrm{pressure}} \\equiv \\frac{\\left|\\frac{1}{n e} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\\right|}{\\left|\\eta J_{\\parallel}\\right|}.\n$$\n假设平行电流演化的特征时间尺度为 $\\tau$，因此 $\\left|\\partial J_{\\parallel}/\\partial t\\right| \\sim \\left|J_{\\parallel}\\right|/\\tau$；并假设平行压力梯度由连接长度 $L_{\\parallel}$ 表征，因此 $\\left|\\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\\right| \\sim p_{e}/L_{\\parallel}$，其中 $p_{e} \\simeq n k_{B} T_{e}$，$k_{B}$ 是玻尔兹曼常数，$T_{e}$ 是电子温度。使用以下参数：\n- $n = 8.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，\n- $T_{e} = 3.0\\,\\mathrm{keV}$，其中 $k_{B} T_{e} = (3.0 \\times 10^{3})\\,e\\,\\mathrm{V} = 3.0 \\times 10^{3}\\,\\mathrm{eV} \\times e$，\n- $J_{\\parallel} = 1.0 \\times 10^{6}\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$，\n- $\\eta = 2.0 \\times 10^{-7}\\,\\Omega\\,\\mathrm{m}$，\n- $\\tau = 5.0 \\times 10^{-3}\\,\\mathrm{s}$，\n- $L_{\\parallel} = 30\\,\\mathrm{m}$，\n- $m_{e} = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$，\n- $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$。\n\n数值计算 $R_{\\mathrm{inertia}}$ 和 $R_{\\mathrm{pressure}}$，并将两者都四舍五入到三位有效数字。将每个比值表示为纯数（无量纲）。\n\n3) 根据你的定量估算，结合给定参数，解释在NTM尺度下，广义欧姆定律的平行分量平衡中哪个项占主导地位，并说明原因，同时注意平行连接长度和时间尺度的作用。\n\n将两个比值的最终数值四舍五入到三位有效数字，并以数对形式报告。由于这些是无量纲比值，不需要单位。",
            "solution": "将按要求分三部分解决该问题：首先，推导平行广义欧姆定律；其次，数值评估电子惯性项和压力梯度项的相对重要性；第三，对结果进行物理解释。\n\n### 第一部分：广义欧姆定律的推导\n\n推导始于电子动量方程，该方程描述了作用在电子流体上的力的平衡：\n$$\nm_{e} n \\left( \\frac{\\partial \\boldsymbol{v}_{e}}{\\partial t} + (\\boldsymbol{v}_{e} \\cdot \\boldsymbol{\\nabla}) \\boldsymbol{v}_{e} \\right) = -n e (\\boldsymbol{E} + \\boldsymbol{v}_{e} \\times \\boldsymbol{B}) - \\boldsymbol{\\nabla} p_{e} - m_{e} n \\nu_{ei}(\\boldsymbol{v}_{e} - \\boldsymbol{v}_{i})\n$$\n其中 $m_e$ 是电子质量，$n$ 是电子数密度，$\\boldsymbol{v}_e$ 是电子流体速度，$e$ 是元电荷的大小，$\\boldsymbol{E}$ 和 $\\boldsymbol{B}$ 是电场和磁场，$p_e$ 是电子压力，$\\nu_{ei}$ 是电子-离子碰撞频率，$\\boldsymbol{v}_i$ 是离子流体速度。\n\n我们重新整理此方程以求解电场 $\\boldsymbol{E}$：\n$$\n\\boldsymbol{E} = -\\boldsymbol{v}_{e} \\times \\boldsymbol{B} - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\frac{m_{e} \\nu_{ei}}{e}(\\boldsymbol{v}_{i} - \\boldsymbol{v}_{e}) - \\frac{m_{e}}{e} \\left( \\frac{\\partial \\boldsymbol{v}_{e}}{\\partial t} + (\\boldsymbol{v}_{e} \\cdot \\boldsymbol{\\nabla}) \\boldsymbol{v}_{e} \\right)\n$$\n问题指定了电流密度 $\\boldsymbol{J} \\equiv n e (\\boldsymbol{v}_{i} - \\boldsymbol{v}_{e})$。利用此定义，碰撞项变为 $\\frac{m_e \\nu_{ei}}{n e^2} \\boldsymbol{J}$。我们定义电阻率为 $\\eta \\equiv \\frac{m_e \\nu_{ei}}{n e^2}$。\n\n为了在质心系中表达该定律，我们引入质心速度 $\\boldsymbol{v}$，并将 $\\boldsymbol{v}_e$ 与 $\\boldsymbol{v}$ 和 $\\boldsymbol{J}$ 联系起来。在准中性 ($n_i \\simeq n_e \\equiv n$) 和 $m_i \\gg m_e$ 的条件下，质心速度 $\\boldsymbol{v} \\approx \\boldsymbol{v}_i$。根据 $\\boldsymbol{J}$ 的定义，我们有 $\\boldsymbol{v}_e = \\boldsymbol{v}_i - \\frac{\\boldsymbol{J}}{ne}$。因此，我们可以将电子速度近似为 $\\boldsymbol{v}_e \\approx \\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}$。\n\n将此代入 $\\boldsymbol{E}$ 的方程：\n$$\n\\boldsymbol{E} = - \\left(\\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}\\right) \\times \\boldsymbol{B} - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\eta \\boldsymbol{J} - \\frac{m_e}{e} \\frac{d\\boldsymbol{v}_e}{dt}\n$$\n其中 $\\frac{d\\boldsymbol{v}_e}{dt}$ 是全时间导数。\n我们将 $\\boldsymbol{v} \\times \\boldsymbol{B}$ 项移到左侧，得到等离子体坐标系中的电场 $\\boldsymbol{E'} = \\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B}$：\n$$\n\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B} = \\frac{1}{ne} \\boldsymbol{J} \\times \\boldsymbol{B} - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\eta \\boldsymbol{J} - \\frac{m_e}{e} \\frac{d}{dt}\\left(\\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}\\right)\n$$\n最后一项是电子惯性项。展开导数：\n$$\n- \\frac{m_e}{e} \\frac{d}{dt}\\left(\\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}\\right) = - \\frac{m_e}{e} \\frac{d\\boldsymbol{v}}{dt} + \\frac{m_e}{ne^2} \\frac{d\\boldsymbol{J}}{dt}\n$$\n涉及 $\\frac{d\\boldsymbol{v}}{dt}$ 的项比相应的离子惯性项小一个因子 $m_e/m_i$，在广义欧姆定律中通常被忽略。对于电流密度项 $\\frac{d\\boldsymbol{J}}{dt} = \\frac{\\partial \\boldsymbol{J}}{\\partial t} + (\\boldsymbol{v}_e \\cdot \\boldsymbol{\\nabla})\\boldsymbol{J}$，我们只保留偏时间导数 $\\frac{\\partial \\boldsymbol{J}}{\\partial t}$，这是一个标准的简化，当 $\\boldsymbol{J}$ 的空间变化不是特别剧烈或流速较低时成立。这给出的电子惯性贡献为 $\\frac{m_e}{ne^2} \\frac{\\partial \\boldsymbol{J}}{\\partial t}$。\n\n因此，广义欧姆定律为：\n$$\n\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B} = \\eta \\boldsymbol{J} + \\frac{1}{ne} (\\boldsymbol{J} \\times \\boldsymbol{B}) - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\frac{m_e}{n e^2} \\frac{\\partial \\boldsymbol{J}}{\\partial t}\n$$\n该方程包括电阻项 ($\\eta\\boldsymbol{J}$)、霍尔项 ($\\frac{1}{ne}\\boldsymbol{J}\\times\\boldsymbol{B}$)、电子压力梯度项 ($-\\frac{1}{ne}\\boldsymbol{\\nabla}p_e$) 和电子惯性项 ($\\frac{m_e}{ne^2}\\frac{\\partial\\boldsymbol{J}}{\\partial t}$)。\n\n为了求平行电场 $E_{\\parallel} \\equiv \\boldsymbol{b} \\cdot \\boldsymbol{E}$，我们将广义欧姆定律与单位矢量 $\\boldsymbol{b} \\equiv \\boldsymbol{B}/B$ 做点积：\n$$\n\\boldsymbol{b} \\cdot (\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B}) = \\boldsymbol{b} \\cdot \\boldsymbol{E} + \\boldsymbol{b} \\cdot (\\boldsymbol{v} \\times B\\boldsymbol{b}) = E_{\\parallel} + 0 = E_{\\parallel}\n$$\n对右侧的各项进行投影：\n- 电阻项: $\\boldsymbol{b} \\cdot (\\eta \\boldsymbol{J}) = \\eta (\\boldsymbol{b} \\cdot \\boldsymbol{J}) = \\eta J_{\\parallel}$。\n- 霍尔项: $\\boldsymbol{b} \\cdot (\\frac{1}{ne} \\boldsymbol{J} \\times \\boldsymbol{B}) = \\frac{B}{ne} \\boldsymbol{b} \\cdot (\\boldsymbol{J} \\times \\boldsymbol{b}) = 0$。\n- 压力梯度项: $\\boldsymbol{b} \\cdot (-\\frac{1}{ne} \\boldsymbol{\\nabla} p_{e}) = -\\frac{1}{ne} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}$。\n- 惯性项: $\\boldsymbol{b} \\cdot (\\frac{m_e}{n e^2} \\frac{\\partial \\boldsymbol{J}}{\\partial t})$。我们假设磁场方向 $\\boldsymbol{b}$ 随时间的变化与电流密度 $\\boldsymbol{J}$ 的大小和方向的变化相比是缓慢的，因此 $\\boldsymbol{b} \\cdot \\frac{\\partial \\boldsymbol{J}}{\\partial t} \\approx \\frac{\\partial}{\\partial t}(\\boldsymbol{b} \\cdot \\boldsymbol{J}) = \\frac{\\partial J_{\\parallel}}{\\partial t}$。\n\n综合这些结果，得到平行电场的最终表达式：\n$$\nE_{\\parallel} = \\eta J_{\\parallel} + \\frac{m_e}{n e^2} \\frac{\\partial J_{\\parallel}}{\\partial t} - \\frac{1}{ne} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\n$$\n使用的主要近似是：\n1. 准中性 ($n_i \\simeq n_e$)。\n2. 离子与电子的质量比很大 ($m_i \\gg m_e$)，这使得 $\\boldsymbol{v} \\approx \\boldsymbol{v}_i$ 和 $\\boldsymbol{v}_e \\approx \\boldsymbol{v} - \\boldsymbol{J}/(ne)$ 的近似成立。\n3. 忽略电子动量方程中的某些小项，特别是电子对流体加速度的贡献 ($m_e/m_i \\ll 1$) 以及物质导数中的非线性和平流项。\n4. 假设磁场方向 $\\boldsymbol{b}$ 是缓变的，因此 $\\boldsymbol{b} \\cdot (\\partial\\boldsymbol{J}/\\partial t) \\approx \\partial J_\\parallel/\\partial t$。\n\n### 第二部分：无量纲比值的数值估算\n\n我们需要计算比值 $R_{\\mathrm{inertia}}$ 和 $R_{\\mathrm{pressure}}$。\n惯性项的比值使用 $|\\partial J_{\\parallel}/\\partial t| \\sim |J_{\\parallel}|/\\tau$ 进行简化：\n$$\nR_{\\mathrm{inertia}} = \\frac{\\left|\\frac{m_{e}}{n e^{2}} \\frac{\\partial J_{\\parallel}}{\\partial t}\\right|}{\\left|\\eta J_{\\parallel}\\right|} \\approx \\frac{\\frac{m_{e}}{n e^{2}} \\frac{|J_{\\parallel}|}{\\tau}}{\\eta |J_{\\parallel}|} = \\frac{m_e}{n e^2 \\eta \\tau}\n$$\n代入给定值：\n$n = 8.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $m_e = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$, $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$, $\\eta = 2.0 \\times 10^{-7}\\,\\Omega\\,\\mathrm{m}$, $\\tau = 5.0 \\times 10^{-3}\\,\\mathrm{s}$。\n$$\nR_{\\mathrm{inertia}} = \\frac{9.109 \\times 10^{-31}}{(8.0 \\times 10^{19}) (1.602 \\times 10^{-19})^2 (2.0 \\times 10^{-7}) (5.0 \\times 10^{-3})}\n$$\n$$\nR_{\\mathrm{inertia}} = \\frac{9.109 \\times 10^{-31}}{2.0531 \\times 10^{-27}} \\approx 4.4367 \\times 10^{-4}\n$$\n四舍五入到三位有效数字，$R_{\\mathrm{inertia}} = 4.44 \\times 10^{-4}$。\n\n压力项的比值使用 $|\\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}| \\sim p_e/L_{\\parallel}$ 和 $p_e \\simeq n k_B T_e$ 进行简化：\n$$\nR_{\\mathrm{pressure}} = \\frac{\\left|\\frac{1}{n e} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\\right|}{\\left|\\eta J_{\\parallel}\\right|} \\approx \\frac{\\frac{1}{ne} \\frac{n k_B T_e}{L_{\\parallel}}}{\\eta |J_{\\parallel}|} = \\frac{k_B T_e}{e L_{\\parallel} \\eta |J_{\\parallel}|}\n$$\n使用给定值：$k_B T_e / e = 3.0 \\times 10^3\\,\\mathrm{V}$, $L_{\\parallel} = 30\\,\\mathrm{m}$, $\\eta = 2.0 \\times 10^{-7}\\,\\Omega\\,\\mathrm{m}$, $|J_{\\parallel}| = 1.0 \\times 10^6\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$。\n$$\nR_{\\mathrm{pressure}} = \\frac{3.0 \\times 10^{3}}{(30) (2.0 \\times 10^{-7}) (1.0 \\times 10^{6})} = \\frac{3.0 \\times 10^{3}}{60 \\times 10^{-1}} = \\frac{3000}{6} = 500\n$$\n四舍五入到三位有效数字，$R_{\\mathrm{pressure}} = 5.00 \\times 10^2$。\n\n### 第三部分：物理解释\n\n数值结果为 $R_{\\mathrm{inertia}} \\approx 4.44 \\times 10^{-4}$ 和 $R_{\\mathrm{pressure}} \\approx 500$。这些无量纲比值分别代表在平行广义欧姆定律中，电子惯性项和电子压力梯度项相对于电阻项的量级。\n\n因此，对 $E_{\\parallel}$ 有贡献的三个项的量级排序如下：\n$$\n\\left| \\frac{1}{ne} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e} \\right| \\gg \\left| \\eta J_{\\parallel} \\right| \\gg \\left| \\frac{m_e}{n e^2} \\frac{\\partial J_{\\parallel}}{\\partial t} \\right|\n$$\n对于给定的NTM参数，平行欧姆定律中的主导项是电子压力梯度项。它大约比电阻项大 $500$ 倍。相比之下，电子惯性项完全可以忽略不计，比已经处于次要地位的电阻项还要小三个数量级以上。\n\n压力梯度项的这种主导地位具有重要的物理意义。它表明，维持磁重联所需的平行电场主要由电子压力的平行梯度来平衡，而不是由简单的电阻率来平衡。这是双流体重联机制的一个标志。该项的量级之所以很大，是高电子温度 ($T_e = 3.0\\,\\mathrm{keV}$) 和表征重联层附近磁拓扑的相对较短的平行连接长度 ($L_{\\parallel} = 30\\,\\mathrm{m}$) 的直接结果。在磁岛分界面的附近，磁力线可以有一条从热的等离子体芯部到岛外较冷区域的短路径，从而沿 $\\boldsymbol{B}$ 方向建立起陡峭的压力梯度。\n\n相反，电子惯性项可以忽略，因为电流演化的特征时间尺度 $\\tau = 5.0\\,\\mathrm{ms}$ 相对较长。惯性效应仅在非常快速的现象中才变得显著（对于电子而言，通常在亚微秒时间尺度上）。NTM典型的毫秒级演化对于电子惯性发挥作用来说太慢了。电子质量 $m_e$ 本身很小这一基本事实也极大地抑制了该项。\n\n总之，对于具有这些参数的热托卡马克等离子体中的NTM尺度重联，其动力学由双流体效应主导，其中平行电子压力梯度是支撑重联电场的关键部分，而电阻率，尤其是电子惯性，所起的作用都很小。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.44 \\times 10^{-4}  5.00 \\times 10^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一次成功的模拟必须精确地解析所有相关的物理尺度。本练习旨在解决一个关键任务：为耦合了新经典撕裂模和湍流的模拟确定所需的网格分辨率。您将学习如何计算离子回旋半径（$\\rho_i$）等基本等离子体尺度，并利用这些尺度推导出同时解析狭窄的新经典撕裂模撕裂层和更广泛的湍流结构所需的最小网格点数。",
            "id": "4208078",
            "problem": "考虑托卡马克有理磁面的局域平板模型，其中形成了一个新经典撕裂模 (NTM) 磁岛。您将设计一个耦合的模拟区域，该区域既能分辨 NTM 内撕裂层宽度，也能分辨以满足$k_{\\perp}\\rho_{i}\\sim 1$的垂直波数为特征的微观湍流尺度。模拟将在垂直平面上使用二阶中心有限差分 (FD) 格式。\n\n假设氘等离子体具有以下符合物理实际的参数：\n- 磁场强度 $B = 3\\,\\mathrm{T}$。\n- 离子温度 $T_{i} = 8\\,\\mathrm{keV}$。\n- 离子质量 $m_{i} = 2 m_{p}$，其中 $m_{p}$ 是质子质量。\n- 元电荷 $e$ 是通常的电子电荷量。\n\nNTM 内撕裂层宽度由一个独立的内外层匹配分析给出，为 $\\delta = 0.6\\,\\mathrm{mm}$。为确保稳健的湍流统计，选择副法向区域长度包含 $5$ 个在$k_{\\perp}\\rho_{i}\\sim 1$尺度下的完整波长，即 $L_{y} = 5 \\lambda_{i}$，其中 $\\lambda_{i} = 2\\pi \\rho_{i}$。为捕捉磁岛及其紧邻区域，设置径向区域为 $L_{x} = 40\\,\\delta$。FD 格式要求每个垂直波长至少有 $p_{\\lambda} = 12$ 个点来分辨$k_{\\perp}\\rho_{i}\\sim 1$尺度，并要求在撕裂内层宽度上至少有 $p_{\\delta} = 15$ 个点来分辨电阻边界层梯度。\n\n从第一性原理出发：\n1.  使用标准动理学理论，根据热速度和回旋频率定义离子回旋半径 $\\rho_{i}$，并用 $m_{i}$、$T_{i}$、$e$ 和 $B$ 表示。\n2.  基于采样考虑和 FD 精度要求，推导网格间距 $\\Delta x$ 和 $\\Delta y$ 的分辨率判据，以同时分辨撕裂层和湍流。您的推导必须从网格上可分辨波长的定义，以及精确分辨宽度为 $\\delta$ 的边界层至少需要 $p_{\\delta}$ 个网格点的概念开始。\n3.  使用这些判据，为选定的 $L_{x}$ 和 $L_{y}$ 计算所需的整数网格尺寸 $N_{x}$ 和 $N_{y}$。\n\n计算指定参数下 $N_{x}$ 和 $N_{y}$ 的最终数值。无需根据有效数字进行四舍五入；选择满足所推导分辨率判据的最小整数。最终答案必须是数对 $\\left(N_{x}, N_{y}\\right)$。",
            "solution": "该问题要求确定二维模拟区域的最小整数网格尺寸 $N_x$ 和 $N_y$，该区域能同时分辨新经典撕裂模 (NTM) 内层和等离子体微观湍流。该解通过基于这些现象的物理尺度，为有限差分网格间距 $\\Delta x$ 和 $\\Delta y$ 建立分辨率判据来推导。\n\n### 第 1 部分：离子回旋半径的定义与计算\n\n离子回旋半径 $\\rho_i$ 是微观湍流的一个基本长度尺度。它基于离子垂直于磁场的热运动来定义。\n\n根据动理学的第一性原理，离子回旋频率 $\\omega_{ci}$ 是离子在磁场 $B$ 中回旋运动的角频率，由下式给出：\n$$ \\omega_{ci} = \\frac{eB}{m_i} $$\n其中 $e$ 是元电荷，$m_i$ 是离子质量。\n\n离子热速度与离子温度 $T_i$ 相关。对于麦克斯韦速度分布，垂直于磁场的两个自由度上的平均动能为 $\\langle \\frac{1}{2}m_i v_{\\perp}^2 \\rangle = T_i$，其中 $T_i$ 以能量单位表示。这给出了均方根 (RMS) 垂直热速度：\n$$ v_{\\perp, \\text{rms}} = \\sqrt{\\frac{2T_i}{m_i}} $$\n热离子回旋半径 $\\rho_i$ 是对应于此特征热速度的拉莫尔半径：\n$$ \\rho_i = \\frac{v_{\\perp, \\text{rms}}}{\\omega_{ci}} = \\frac{\\sqrt{2T_i/m_i}}{eB/m_i} $$\n简化此表达式，得到以给定参数表示的离子回旋半径公式：\n$$ \\rho_i = \\frac{\\sqrt{2m_i T_i}}{eB} $$\n为了继续，我们必须计算 $\\rho_i$ 的数值以比较尺度，尽管我们将看到，在一个被很好满足的条件下，$N_x$ 和 $N_y$ 的最终结果可以符号化地获得。给定参数为：\n- $B = 3\\,\\text{T}$\n- $T_i = 8\\,\\text{keV} = 8 \\times 10^3\\,\\text{eV}$\n- $m_i = 2 m_p$，其中 $m_p \\approx 1.6726 \\times 10^{-27}\\,\\text{kg}$\n- $e \\approx 1.6022 \\times 10^{-19}\\,\\text{C}$\n\n首先，我们将离子温度转换为焦耳：\n$$ T_i = (8 \\times 10^3\\,\\text{eV}) \\times (1.6022 \\times 10^{-19}\\,\\text{J/eV}) = 1.28176 \\times 10^{-15}\\,\\text{J} $$\n离子质量为：\n$$ m_i = 2 \\times (1.6726 \\times 10^{-27}\\,\\text{kg}) = 3.3452 \\times 10^{-27}\\,\\text{kg} $$\n将这些值代入 $\\rho_i$ 的表达式中：\n$$ \\rho_i = \\frac{\\sqrt{2 \\times (3.3452 \\times 10^{-27}\\,\\text{kg}) \\times (1.28176 \\times 10^{-15}\\,\\text{J})}}{(1.6022 \\times 10^{-19}\\,\\text{C}) \\times (3\\,\\text{T})} $$\n$$ \\rho_i = \\frac{\\sqrt{8.575 \\times 10^{-42}}\\,\\text{kg}\\cdot\\text{J}}{4.8066 \\times 10^{-19}\\,\\text{C}\\cdot\\text{T}} = \\frac{2.928 \\times 10^{-21}\\,\\text{kg}\\cdot\\text{m/s}}{4.8066 \\times 10^{-19}\\,\\text{kg/s}} \\approx 6.093 \\times 10^{-3}\\,\\text{m} $$\n所以，$\\rho_i \\approx 6.1\\,\\text{mm}$。\n\n### 第 2 部分：分辨率判据的推导\n\n有限差分格式要求网格间距远小于要分辨的最小物理尺度长度。问题指定了两种这样的尺度以及每种尺度所需的采样率。\n\n**径向分辨率 ($\\Delta x$):**\n在径向方向上，必须分辨两种现象：NTM 内撕裂层和微观湍流。\n1.  **撕裂层：** 该层的宽度为 $\\delta = 0.6\\,\\text{mm}$。问题要求在该宽度上至少有 $p_{\\delta} = 15$ 个网格点。这意味着 $p_{\\delta}$ 个网格单元的总长度不能超过 $\\delta$。\n    $$ p_{\\delta} \\Delta x \\leq \\delta \\implies \\Delta x \\leq \\frac{\\delta}{p_{\\delta}} $$\n2.  **微观湍流：** 湍流的特征垂直波长为 $\\lambda_i = 2\\pi\\rho_i$，对应于 $k_{\\perp}\\rho_i = 1$。此尺度必须在所有垂直方向上得到分辨，包括径向。该格式要求每个波长至少有 $p_{\\lambda} = 12$ 个点。\n    $$ p_{\\lambda} \\Delta x \\leq \\lambda_i \\implies \\Delta x \\leq \\frac{\\lambda_i}{p_{\\lambda}} $$\n为了正确分辨这两种现象，网格间距 $\\Delta x$ 必须满足这两个条件中更严格的那个：\n$$ \\Delta x \\leq \\min\\left(\\frac{\\delta}{p_{\\delta}}, \\frac{\\lambda_i}{p_{\\lambda}}\\right) $$\n让我们比较每个约束条件允许的最大网格间距：\n$$ \\frac{\\delta}{p_{\\delta}} = \\frac{0.6 \\times 10^{-3}\\,\\text{m}}{15} = 4 \\times 10^{-5}\\,\\text{m} $$\n$$ \\frac{\\lambda_i}{p_{\\lambda}} = \\frac{2\\pi \\rho_i}{p_{\\lambda}} \\approx \\frac{2\\pi \\times (6.093 \\times 10^{-3}\\,\\text{m})}{12} \\approx 3.19 \\times 10^{-3}\\,\\text{m} $$\n由于 $4 \\times 10^{-5}\\,\\text{m} \\ll 3.19 \\times 10^{-3}\\,\\text{m}$，分辨撕裂层的约束要严格得多。因此，径向方向的主导分辨率判据是：\n$$ \\Delta x \\leq \\frac{\\delta}{p_{\\delta}} $$\n\n**副法向分辨率 ($\\Delta y$):**\n在副法向方向，需要分辨的主要尺度是微观湍流的尺度。特征波长是 $\\lambda_i = 2\\pi\\rho_i$，格式要求每个波长有 $p_{\\lambda} = 12$ 个点。\n$$ p_{\\lambda} \\Delta y \\leq \\lambda_i \\implies \\Delta y \\leq \\frac{\\lambda_i}{p_{\\lambda}} $$\n\n### 第 3 部分：网格尺寸 $N_x$ 和 $N_y$ 的计算\n\n在长度为 $L$、网格间距为 $\\Delta$ 的区域中，网格点数 $N$ 为 $N = L/\\Delta$。为满足分辨率判据 $\\Delta \\leq \\Delta_{\\text{max}}$，我们必须有 $L/N \\leq \\Delta_{\\text{max}}$，这意味着 $N \\geq L/\\Delta_{\\text{max}}$。问题要求满足此条件的最小整数网格尺寸。\n\n**径向网格尺寸 ($N_x$):**\n径向区域尺寸为 $L_x = 40\\,\\delta$。允许的最大网格间距为 $\\Delta x_{\\text{max}} = \\delta/p_{\\delta}$。\n$$ N_x \\geq \\frac{L_x}{\\Delta x_{\\text{max}}} = \\frac{40\\,\\delta}{\\delta/p_{\\delta}} = 40\\,p_{\\delta} $$\n代入给定值 $p_{\\delta} = 15$：\n$$ N_x \\geq 40 \\times 15 = 600 $$\n由于 $600$ 是一个整数，所需的最小整数网格点数是 $N_x = 600$。\n\n**副法向网格尺寸 ($N_y$):**\n副法向区域尺寸为 $L_y = 5\\,\\lambda_i$。允许的最大网格间距为 $\\Delta y_{\\text{max}} = \\lambda_i/p_{\\lambda}$。\n$$ N_y \\geq \\frac{L_y}{\\Delta y_{\\text{max}}} = \\frac{5\\,\\lambda_i}{\\lambda_i/p_{\\lambda}} = 5\\,p_{\\lambda} $$\n代入给定值 $p_{\\lambda} = 12$：\n$$ N_y \\geq 5 \\times 12 = 60 $$\n由于 $60$ 是一个整数，所需的最小整数网格点数是 $N_y = 60$。\n\n最终所需的网格尺寸是 $(N_x, N_y) = (600, 60)$。值得注意的是，只要条件 $\\delta/p_{\\delta} \\ll \\lambda_i/p_{\\lambda}$ 成立，这些结果就与具体的物理参数 $B$、$T_i$ 和 $m_i$ 无关，而我们已经验证了对于给定的实际参数，该条件是成立的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n600  60\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "数值模拟在有限的计算域中进行，但物理系统通常是近似无界的。本练习旨在解决计算边界上非物理的波反射问题，这种反射会污染模拟结果。您将推导一种“无反射”或“吸收”边界条件的数学形式，该条件允许湍流涨落离开计算域而不发生反射，从而确保模拟的能量通量具有物理意义。",
            "id": "4208039",
            "problem": "考虑一个板状等离子体模型，其径向坐标为 $x$，在 $z$ 方向上有一个均匀的平衡磁场 $B_0$。在 $x=0$ 处存在一个单一有理面，此处的安全因子 $q$ 满足撕裂模奇偶性模式的有理条件。外区域延伸至位于 $x=L$ 处的计算边界。在湍流与新经典撕裂模（Neoclassical Tearing Modes, NTMs）相互作用的模拟中，湍流在有理面和计算边界处产生的非物理反射会污染进入磁岛的能量通量，并改变磁岛的演化。\n\n假设与磁岛相互作用的主要湍流场分量是平行磁矢势 $A_{\\parallel}(x,t)$，其在远离内电阻层的外区域的动力学行为由线性剪切阿尔芬波方程决定\n$$\n\\frac{\\partial^2 A_{\\parallel}}{\\partial t^2} = v_A^2 \\frac{\\partial^2 A_{\\parallel}}{\\partial x^2},\n$$\n其中 $v_A$ 是阿尔芬速度。色散关系为 $ \\omega = v_A k $，其中 $k$ 是有理面附近波包络的径向波数。假设振幅足够小，使得左行和右行分量的线性叠加是有效的，并通过直接对 $A_{\\parallel}$ 施加边界条件，将 $x=0$ 处的有理面视为一个与内撕裂层不同的湍流输运界面，以防止反射波污染磁岛驱动。类似地，在 $x=L$ 的边界处施加吸收边界条件以防止计算反射。\n\n假设在边界点 $x_b$ 应用形式为 $ \\partial_x A_{\\parallel} + s \\,\\partial_t A_{\\parallel} = 0 $ 的通用时域 Robin 边界条件，其中 $s$ 是一个待选常数。对于一个复振幅为 $\\hat{A}$ 的单频右行入射波 $A_{\\parallel}(x,t) = \\Re\\{\\hat{A} e^{i(k x - \\omega t)}\\}$，边界附近的总场是入射波和反射波的叠加。反射系数 $R$ 定义为在边界处计算的反射波复振幅与入射波复振幅之比。\n\n从剪切阿尔芬波方程和 Robin 边界条件出发，推导在 $x=L$ 处的边界被来自左侧的右行波撞击时的反射系数 $R(s)$，以及在 $x=0$ 处的边界被来自右侧的左行波撞击时的反射系数 $R(s)$。利用色散关系，确定在 $x=0$ 和 $x=L$ 处的边界参数 $s$ 的值，使得对于所有满足 $ \\omega = v_A k $ 的 $\\omega$，反射系数恒为零。将您的最终结果表示为 $(s_0, s_L)$ 的一对解析表达式，其中 $s_0$ 是 $x=0$ 处的参数，$s_L$ 是 $x=L$ 处的参数。",
            "solution": "所给的问题陈述在科学上是合理的、自洽的且提法恰当。它描述了等离子体波物理学中一个物理上和数学上有效的问题，具体涉及剪切阿尔芬波吸收边界条件的实现。因此，我们将着手推导所需的参数。\n\n该问题研究了在板状等离子体中，被建模为剪切阿尔芬波的湍流与边界的相互作用。平行磁矢势 $A_{\\parallel}(x,t)$ 的动力学由一维波动方程决定：\n$$\n\\frac{\\partial^2 A_{\\parallel}}{\\partial t^2} = v_A^2 \\frac{\\partial^2 A_{\\parallel}}{\\partial x^2}\n$$\n其中 $v_A$ 是阿尔芬速度。我们旨在为通用的时域 Robin 边界条件找到参数 $s$，\n$$\n\\frac{\\partial A_{\\parallel}}{\\partial x} + s \\frac{\\partial A_{\\parallel}}{\\partial t} = 0\n$$\n使得对于特定的入射波方向，在两个不同的边界上波的反射被消除。\n\n波动方程的一个单色波解可以写成复指数形式。一个右行波的形式为 $A_{right}(x,t) = \\hat{A} \\exp(i(kx - \\omega t))$，一个左行波的形式为 $A_{left}(x,t) = \\hat{A} \\exp(i(-kx - \\omega t))$，其中 $k  0$ 是波数，$\\omega  0$ 是角频率。问题给出的色散关系为 $\\omega = v_A k$。这意味着右行波的相速度为 $\\frac{\\omega}{k} = v_A$，左行波的相速度为 $\\frac{\\omega}{-k} = -v_A$。\n\n我们分别分析两个边界。\n\n**1. $x=L$ 处的边界（右边界）**\n\n在位于 $x=L$ 的右边界处，我们需要吸收一个从左边传来的入射右行波。反射后，该波将变为一个左行波。边界附近的总波场 $A_{\\parallel}(x,t)$ 是入射分量和反射分量的叠加：\n$$\nA_{\\parallel}(x,t) = A_{inc}(x,t) + A_{ref}(x,t) = \\hat{A}_{inc} \\exp(i(kx - \\omega t)) + \\hat{A}_{ref} \\exp(i(-kx - \\omega t))\n$$\n我们可以用反射系数 $R_L = \\hat{A}_{ref} / \\hat{A}_{inc}$ 来表示总场：\n$$\nA_{\\parallel}(x,t) = \\hat{A}_{inc} \\left( \\exp(ikx) + R_L \\exp(-ikx) \\right) \\exp(-i\\omega t)\n$$\n为了应用边界条件，我们首先计算必要的偏导数：\n$$\n\\frac{\\partial A_{\\parallel}}{\\partial x} = \\hat{A}_{inc} \\left( ik \\exp(ikx) - ik R_L \\exp(-ikx) \\right) \\exp(-i\\omega t)\n$$\n$$\n\\frac{\\partial A_{\\parallel}}{\\partial t} = \\hat{A}_{inc} \\left( \\exp(ikx) + R_L \\exp(-ikx) \\right) (-i\\omega) \\exp(-i\\omega t)\n$$\n将这些表达式代入 Robin 边界条件 $\\frac{\\partial A_{\\parallel}}{\\partial x} + s_L \\frac{\\partial A_{\\parallel}}{\\partial t} = 0$，并在 $x=L$ 处求值：\n$$\n\\hat{A}_{inc} \\left( ik e^{ikL} - ik R_L e^{-ikL} \\right) e^{-i\\omega t} + s_L \\left[ \\hat{A}_{inc} \\left( e^{ikL} + R_L e^{-ikL} \\right) (-i\\omega) e^{-i\\omega t} \\right] = 0\n$$\n假设存在非平凡的入射波（$\\hat{A}_{inc} \\neq 0$），我们可以将方程两边同除以 $i \\hat{A}_{inc} \\exp(-i\\omega t)$：\n$$\n\\left( k e^{ikL} - k R_L e^{-ikL} \\right) - s_L \\omega \\left( e^{ikL} + R_L e^{-ikL} \\right) = 0\n$$\n我们重新整理各项以求解反射系数 $R_L$：\n$$\ne^{ikL} (k - \\omega s_L) = R_L e^{-ikL} (k + \\omega s_L)\n$$\n$$\nR_L = \\frac{k - \\omega s_L}{k + \\omega s_L} \\exp(2ikL)\n$$\n对于一个完美吸收边界，我们需要 $R_L=0$。当分子为零时，此条件满足：\n$$\nk - \\omega s_L = 0 \\implies s_L = \\frac{k}{\\omega}\n$$\n使用色散关系 $\\omega = v_A k$，我们找到使边界对所有适用频率都无反射的 $s_L$ 的值：\n$$\ns_L = \\frac{k}{v_A k} = \\frac{1}{v_A}\n$$\n\n**2. $x=0$ 处的边界（有理面）**\n\n在位于 $x=0$ 的左边界处，我们需要吸收一个从右边传来的入射左行波。其反射波将是一个右行波。总场为：\n$$\nA_{\\parallel}(x,t) = A_{inc}(x,t) + A_{ref}(x,t) = \\hat{A}_{inc} \\exp(i(-kx - \\omega t)) + \\hat{A}_{ref} \\exp(i(kx - \\omega t))\n$$\n用反射系数 $R_0 = \\hat{A}_{ref} / \\hat{A}_{inc}$ 表示，这为：\n$$\nA_{\\parallel}(x,t) = \\hat{A}_{inc} \\left( \\exp(-ikx) + R_0 \\exp(ikx) \\right) \\exp(-i\\omega t)\n$$\n偏导数为：\n$$\n\\frac{\\partial A_{\\parallel}}{\\partial x} = \\hat{A}_{inc} \\left( -ik \\exp(-ikx) + ik R_0 \\exp(ikx) \\right) \\exp(-i\\omega t)\n$$\n$$\n\\frac{\\partial A_{\\parallel}}{\\partial t} = \\hat{A}_{inc} \\left( \\exp(-ikx) + R_0 \\exp(ikx) \\right) (-i\\omega) \\exp(-i\\omega t)\n$$\n代入 Robin 边界条件 $\\frac{\\partial A_{\\parallel}}{\\partial x} + s_0 \\frac{\\partial A_{\\parallel}}{\\partial t} = 0$，并在 $x=0$ 处求值：\n$$\n\\hat{A}_{inc} \\left( -ik + ik R_0 \\right) e^{-i\\omega t} + s_0 \\left[ \\hat{A}_{inc} \\left( 1 + R_0 \\right) (-i\\omega) e^{-i\\omega t} \\right] = 0\n$$\n两边同除以 $i \\hat{A}_{inc} \\exp(-i\\omega t)$：\n$$\n\\left( -k + k R_0 \\right) - s_0 \\omega \\left( 1 + R_0 \\right) = 0\n$$\n求解 $R_0$：\n$$\nR_0(k - \\omega s_0) = k + \\omega s_0\n$$\n$$\nR_0 = \\frac{k + \\omega s_0}{k - \\omega s_0}\n$$\n为了使该边界无反射（$R_0=0$），分子必须为零：\n$$\nk + \\omega s_0 = 0 \\implies s_0 = -\\frac{k}{\\omega}\n$$\n使用色散关系 $\\omega = v_A k$：\n$$\ns_0 = -\\frac{k}{v_A k} = -\\frac{1}{v_A}\n$$\n\n总之，在 $x=L$ 处吸收右行波所需的边界参数是 $s_L = 1/v_A$，而在 $x=0$ 处吸收左行波所需的参数是 $s_0 = -1/v_A$。因此，$(s_0, s_L)$ 这对结果就确定了。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{v_A}  \\frac{1}{v_A}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}