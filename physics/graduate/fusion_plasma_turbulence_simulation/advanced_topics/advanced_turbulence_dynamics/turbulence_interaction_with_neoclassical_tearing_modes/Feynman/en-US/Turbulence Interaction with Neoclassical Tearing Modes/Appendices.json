{
    "hands_on_practices": [
        {
            "introduction": "The core of any tearing mode is magnetic reconnection, the process that allows magnetic field lines to break and reconfigure. To accurately model this, one must move beyond ideal Magnetohydrodynamics (MHD) and use a generalized Ohm's law that includes non-ideal effects. This exercise  guides you through the first-principles derivation of this law from two-fluid theory and asks you to evaluate which physical mechanisms—resistivity, electron pressure, or electron inertia—are most important for driving reconnection at the scale of a Neoclassical Tearing Mode (NTM).",
            "id": "4208041",
            "problem": "A tokamak undergoing a Neoclassical Tearing Mode (NTM) exhibits reconnection dynamics at scales where electron inertia, pressure gradients, and collisional resistivity can all contribute to the parallel electric field that sustains magnetic reconnection. Starting from the two-fluid description, consider a singly ionized, quasi-neutral plasma with electron number density $n_{e}$ and ions of mass $m_{i} \\gg m_{e}$, where $m_{e}$ is the electron mass. The electromagnetic fields are $\\boldsymbol{E}$ and $\\boldsymbol{B}$, the electron and ion fluid velocities are $\\boldsymbol{v}_{e}$ and $\\boldsymbol{v}_{i}$, and the electron pressure is $p_{e}$. The current density is defined by $\\boldsymbol{J} \\equiv n_{e} e (\\boldsymbol{v}_{i} - \\boldsymbol{v}_{e})$, with $e$ the magnitude of the elementary charge, and the center-of-mass velocity is $\\boldsymbol{v} \\equiv (m_{i} n_{i} \\boldsymbol{v}_{i} + m_{e} n_{e} \\boldsymbol{v}_{e})/(m_{i} n_{i} + m_{e} n_{e})$. Assume quasi-neutrality $n_{i} \\simeq n_{e} \\equiv n$. Electron-ion collisions produce a drag force modeled by $- m_{e} n \\nu_{ei}(\\boldsymbol{v}_{e} - \\boldsymbol{v}_{i})$, where $\\nu_{ei}$ is the electron-ion collision frequency. Neglect electron viscosity and displacement current. Let $\\boldsymbol{b} \\equiv \\boldsymbol{B}/B$ denote the unit vector along the magnetic field.\n\n1) Starting from the electron momentum equation, derive a generalized Ohm’s law in the center-of-mass frame that retains the electron inertia, electron pressure gradient, and collisional resistivity terms. Then project along the magnetic field to obtain an explicit expression for the parallel electric field $E_{\\parallel} \\equiv \\boldsymbol{b} \\cdot \\boldsymbol{E}$ in terms of $J_{\\parallel} \\equiv \\boldsymbol{b} \\cdot \\boldsymbol{J}$, $p_{e}$, and their derivatives, including the electron inertia term. Clearly state standard mass-ratio and quasi-neutrality approximations you use to express the result in terms of $\\boldsymbol{v}$ and $\\boldsymbol{J}$, and define the resistivity $\\eta$ in terms of $\\nu_{ei}$ and fundamental constants.\n\n2) For a representative NTM-scale reconnection layer, estimate the relative magnitudes of the electron inertia and pressure-gradient contributions to $E_{\\parallel}$ compared to the resistive contribution by evaluating the two dimensionless ratios\n$$\nR_{\\mathrm{inertia}} \\equiv \\frac{\\left|\\frac{m_{e}}{n e^{2}} \\frac{\\partial J_{\\parallel}}{\\partial t}\\right|}{\\left|\\eta J_{\\parallel}\\right|}, \n\\qquad\nR_{\\mathrm{pressure}} \\equiv \\frac{\\left|\\frac{1}{n e} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\\right|}{\\left|\\eta J_{\\parallel}\\right|}.\n$$\nAssume that the characteristic parallel current evolution timescale is $\\tau$, so that $\\left|\\partial J_{\\parallel}/\\partial t\\right| \\sim \\left|J_{\\parallel}\\right|/\\tau$, and that the parallel pressure gradient is characterized by a connection length $L_{\\parallel}$ so that $\\left|\\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\\right| \\sim p_{e}/L_{\\parallel}$ with $p_{e} \\simeq n k_{B} T_{e}$, where $k_{B}$ is the Boltzmann constant and $T_{e}$ is the electron temperature. Use the following parameters:\n- $n = 8.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$,\n- $T_{e} = 3.0\\,\\mathrm{keV}$,\n- $J_{\\parallel} = 1.0 \\times 10^{6}\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$,\n- $\\eta = 2.0 \\times 10^{-7}\\,\\Omega\\,\\mathrm{m}$,\n- $\\tau = 5.0 \\times 10^{-3}\\,\\mathrm{s}$,\n- $L_{\\parallel} = 30\\,\\mathrm{m}$,\n- $m_{e} = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$,\n- $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$.\n\nCompute $R_{\\mathrm{inertia}}$ and $R_{\\mathrm{pressure}}$ numerically and round both to three significant figures. Express each ratio as a pure number (dimensionless).\n\n3) Based on your quantitative estimates, explain which term dominates the parallel balance of the generalized Ohm’s law at NTM scales and why, in light of the parameters given, while noting the role of parallel connection length and timescale.\n\nRound your final numerical answers for the two ratios to three significant figures and report them as a pair. Since these are dimensionless ratios, no units are required.",
            "solution": "The problem will be addressed in three parts as requested: first, the derivation of the parallel generalized Ohm's law; second, the numerical evaluation of the relative importance of the electron inertia and pressure gradient terms; and third, a physical interpretation of the results.\n\n### Part 1: Derivation of the Generalized Ohm's Law\n\nThe derivation begins with the electron momentum equation, which describes the balance of forces on the electron fluid:\n$$\nm_{e} n \\left( \\frac{\\partial \\boldsymbol{v}_{e}}{\\partial t} + (\\boldsymbol{v}_{e} \\cdot \\boldsymbol{\\nabla}) \\boldsymbol{v}_{e} \\right) = -n e (\\boldsymbol{E} + \\boldsymbol{v}_{e} \\times \\boldsymbol{B}) - \\boldsymbol{\\nabla} p_{e} - m_{e} n \\nu_{ei}(\\boldsymbol{v}_{e} - \\boldsymbol{v}_{i})\n$$\nwhere $m_e$ is the electron mass, $n$ is the electron number density, $\\boldsymbol{v}_e$ is the electron fluid velocity, $e$ is the elementary charge magnitude, $\\boldsymbol{E}$ and $\\boldsymbol{B}$ are the electric and magnetic fields, $p_e$ is the electron pressure, $\\nu_{ei}$ is the electron-ion collision frequency, and $\\boldsymbol{v}_i$ is the ion fluid velocity.\n\nWe rearrange this equation to solve for the electric field $\\boldsymbol{E}$:\n$$\n\\boldsymbol{E} = -\\boldsymbol{v}_{e} \\times \\boldsymbol{B} - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\frac{m_{e} \\nu_{ei}}{e}(\\boldsymbol{v}_{i} - \\boldsymbol{v}_{e}) - \\frac{m_{e}}{e} \\left( \\frac{\\partial \\boldsymbol{v}_{e}}{\\partial t} + (\\boldsymbol{v}_{e} \\cdot \\boldsymbol{\\nabla}) \\boldsymbol{v}_{e} \\right)\n$$\nThe problem specifies the current density $\\boldsymbol{J} \\equiv n e (\\boldsymbol{v}_{i} - \\boldsymbol{v}_{e})$. Using this, the collisional term becomes $\\frac{m_e \\nu_{ei}}{n e^2} \\boldsymbol{J}$. We define the electrical resistivity as $\\eta \\equiv \\frac{m_e \\nu_{ei}}{n e^2}$.\n\nTo express the law in the center-of-mass frame, we introduce the center-of-mass velocity $\\boldsymbol{v}$ and relate $\\boldsymbol{v}_e$ to $\\boldsymbol{v}$ and $\\boldsymbol{J}$. Given quasi-neutrality ($n_i \\simeq n_e \\equiv n$) and $m_i \\gg m_e$, the center-of-mass velocity is $\\boldsymbol{v} \\approx \\boldsymbol{v}_i$. From the definition of $\\boldsymbol{J}$, we have $\\boldsymbol{v}_e = \\boldsymbol{v}_i - \\frac{\\boldsymbol{J}}{ne}$. Therefore, we can approximate the electron velocity as $\\boldsymbol{v}_e \\approx \\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}$.\n\nSubstituting this into the equation for $\\boldsymbol{E}$:\n$$\n\\boldsymbol{E} = - \\left(\\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}\\right) \\times \\boldsymbol{B} - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\eta \\boldsymbol{J} - \\frac{m_e}{e} \\frac{d\\boldsymbol{v}_e}{dt}\n$$\nwhere $\\frac{d\\boldsymbol{v}_e}{dt}$ is the total time derivative.\nWe move the $\\boldsymbol{v} \\times \\boldsymbol{B}$ term to the left hand side, yielding the electric field in the plasma frame, $\\boldsymbol{E'} = \\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B}$:\n$$\n\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B} = \\frac{1}{ne} \\boldsymbol{J} \\times \\boldsymbol{B} - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\eta \\boldsymbol{J} - \\frac{m_e}{e} \\frac{d}{dt}\\left(\\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}\\right)\n$$\nThe last term is the electron inertia term. Expanding the derivative:\n$$\n- \\frac{m_e}{e} \\frac{d}{dt}\\left(\\boldsymbol{v} - \\frac{\\boldsymbol{J}}{ne}\\right) = - \\frac{m_e}{e} \\frac{d\\boldsymbol{v}}{dt} + \\frac{m_e}{ne^2} \\frac{d\\boldsymbol{J}}{dt}\n$$\nThe term involving $\\frac{d\\boldsymbol{v}}{dt}$ is smaller than the corresponding ion inertia term by a factor of $m_e/m_i$ and is conventionally neglected in the generalized Ohm's law. For the current density term $\\frac{d\\boldsymbol{J}}{dt} = \\frac{\\partial \\boldsymbol{J}}{\\partial t} + (\\boldsymbol{v}_e \\cdot \\boldsymbol{\\nabla})\\boldsymbol{J}$, we retain only the partial time derivative $\\frac{\\partial \\boldsymbol{J}}{\\partial t}$, a standard simplification which is valid when spatial variations of $\\boldsymbol{J}$ are not excessively steep or flow speeds are low. This yields the electron inertia contribution as $\\frac{m_e}{ne^2} \\frac{\\partial \\boldsymbol{J}}{\\partial t}$.\n\nThe generalized Ohm's law is thus:\n$$\n\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B} = \\eta \\boldsymbol{J} + \\frac{1}{ne} (\\boldsymbol{J} \\times \\boldsymbol{B}) - \\frac{1}{ne} \\boldsymbol{\\nabla} p_{e} + \\frac{m_e}{n e^2} \\frac{\\partial \\boldsymbol{J}}{\\partial t}\n$$\nThis equation includes the resistive term ($\\eta\\boldsymbol{J}$), the Hall term ($\\frac{1}{ne}\\boldsymbol{J}\\times\\boldsymbol{B}$), the electron pressure gradient term ($-\\frac{1}{ne}\\boldsymbol{\\nabla}p_e$), and the electron inertia term ($\\frac{m_e}{ne^2}\\frac{\\partial\\boldsymbol{J}}{\\partial t}$).\n\nTo find the parallel electric field $E_{\\parallel} \\equiv \\boldsymbol{b} \\cdot \\boldsymbol{E}$, we take the dot product of the generalized Ohm's law with the unit vector $\\boldsymbol{b} \\equiv \\boldsymbol{B}/B$:\n$$\n\\boldsymbol{b} \\cdot (\\boldsymbol{E} + \\boldsymbol{v} \\times \\boldsymbol{B}) = \\boldsymbol{b} \\cdot \\boldsymbol{E} + \\boldsymbol{b} \\cdot (\\boldsymbol{v} \\times B\\boldsymbol{b}) = E_{\\parallel} + 0 = E_{\\parallel}\n$$\nProjecting the terms on the right-hand side:\n- Resistive term: $\\boldsymbol{b} \\cdot (\\eta \\boldsymbol{J}) = \\eta (\\boldsymbol{b} \\cdot \\boldsymbol{J}) = \\eta J_{\\parallel}$.\n- Hall term: $\\boldsymbol{b} \\cdot (\\frac{1}{ne} \\boldsymbol{J} \\times \\boldsymbol{B}) = \\frac{B}{ne} \\boldsymbol{b} \\cdot (\\boldsymbol{J} \\times \\boldsymbol{b}) = 0$.\n- Pressure gradient term: $\\boldsymbol{b} \\cdot (-\\frac{1}{ne} \\boldsymbol{\\nabla} p_{e}) = -\\frac{1}{ne} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}$.\n- Inertia term: $\\boldsymbol{b} \\cdot (\\frac{m_e}{n e^2} \\frac{\\partial \\boldsymbol{J}}{\\partial t})$. We assume the direction of the magnetic field $\\boldsymbol{b}$ changes slowly in time compared to the magnitude and direction of the current density $\\boldsymbol{J}$, such that $\\boldsymbol{b} \\cdot \\frac{\\partial \\boldsymbol{J}}{\\partial t} \\approx \\frac{\\partial}{\\partial t}(\\boldsymbol{b} \\cdot \\boldsymbol{J}) = \\frac{\\partial J_{\\parallel}}{\\partial t}$.\n\nCombining these results gives the final expression for the parallel electric field:\n$$\nE_{\\parallel} = \\eta J_{\\parallel} + \\frac{m_e}{n e^2} \\frac{\\partial J_{\\parallel}}{\\partial t} - \\frac{1}{ne} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\n$$\nThe primary approximations used are:\n1. Quasi-neutrality ($n_i \\simeq n_e$).\n2. Large ion-to-electron mass ratio ($m_i \\gg m_e$), justifying $\\boldsymbol{v} \\approx \\boldsymbol{v}_i$ and $\\boldsymbol{v}_e \\approx \\boldsymbol{v} - \\boldsymbol{J}/(ne)$.\n3. Neglect of certain small terms in the electron momentum equation, specifically the electron contribution to fluid acceleration ($m_e/m_i \\ll 1$) and nonlinear/advective terms in the material derivatives.\n4. The magnetic field direction $\\boldsymbol{b}$ is assumed to be slowly varying, so $\\boldsymbol{b} \\cdot (\\partial\\boldsymbol{J}/\\partial t) \\approx \\partial J_\\parallel/\\partial t$.\n\n### Part 2: Numerical Estimation of Dimensionless Ratios\n\nWe are asked to compute the ratios $R_{\\mathrm{inertia}}$ and $R_{\\mathrm{pressure}}$.\nThe ratio for the inertia term is simplified using $|\\partial J_{\\parallel}/\\partial t| \\sim |J_{\\parallel}|/\\tau$:\n$$\nR_{\\mathrm{inertia}} = \\frac{\\left|\\frac{m_{e}}{n e^{2}} \\frac{\\partial J_{\\parallel}}{\\partial t}\\right|}{\\left|\\eta J_{\\parallel}\\right|} \\approx \\frac{\\frac{m_{e}}{n e^{2}} \\frac{|J_{\\parallel}|}{\\tau}}{\\eta |J_{\\parallel}|} = \\frac{m_e}{n e^2 \\eta \\tau}\n$$\nSubstituting the given values:\n$n = 8.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $m_e = 9.109 \\times 10^{-31}\\,\\mathrm{kg}$, $e = 1.602 \\times 10^{-19}\\,\\mathrm{C}$, $\\eta = 2.0 \\times 10^{-7}\\,\\Omega\\,\\mathrm{m}$, $\\tau = 5.0 \\times 10^{-3}\\,\\mathrm{s}$.\n$$\nR_{\\mathrm{inertia}} = \\frac{9.109 \\times 10^{-31}}{(8.0 \\times 10^{19}) (1.602 \\times 10^{-19})^2 (2.0 \\times 10^{-7}) (5.0 \\times 10^{-3})}\n$$\n$$\nR_{\\mathrm{inertia}} = \\frac{9.109 \\times 10^{-31}}{2.0531 \\times 10^{-27}} \\approx 4.4367 \\times 10^{-4}\n$$\nRounded to three significant figures, $R_{\\mathrm{inertia}} = 4.44 \\times 10^{-4}$.\n\nThe ratio for the pressure term is simplified using $|\\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}| \\sim p_e/L_{\\parallel}$ and $p_e \\simeq n k_B T_e$:\n$$\nR_{\\mathrm{pressure}} = \\frac{\\left|\\frac{1}{n e} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e}\\right|}{\\left|\\eta J_{\\parallel}\\right|} \\approx \\frac{\\frac{1}{ne} \\frac{n k_B T_e}{L_{\\parallel}}}{\\eta |J_{\\parallel}|} = \\frac{k_B T_e}{e L_{\\parallel} \\eta |J_{\\parallel}|}\n$$\nUsing the given values: $k_B T_e / e = 3.0 \\times 10^3\\,\\mathrm{V}$ (from $T_e = 3.0\\,\\mathrm{keV}$), $L_{\\parallel} = 30\\,\\mathrm{m}$, $\\eta = 2.0 \\times 10^{-7}\\,\\Omega\\,\\mathrm{m}$, $|J_{\\parallel}| = 1.0 \\times 10^6\\,\\mathrm{A}\\,\\mathrm{m}^{-2}$.\n$$\nR_{\\mathrm{pressure}} = \\frac{3.0 \\times 10^{3}}{(30) (2.0 \\times 10^{-7}) (1.0 \\times 10^{6})} = \\frac{3.0 \\times 10^{3}}{6.0} = 500\n$$\nRounded to three significant figures, $R_{\\mathrm{pressure}} = 5.00 \\times 10^2$.\n\n### Part 3: Physical Interpretation\n\nThe numerical results are $R_{\\mathrm{inertia}} \\approx 4.44 \\times 10^{-4}$ and $R_{\\mathrm{pressure}} \\approx 500$. These dimensionless ratios represent the magnitudes of the electron inertia and electron pressure gradient terms, respectively, relative to the resistive term in the parallel generalized Ohm's law.\n\nThe magnitudes of the three terms contributing to $E_{\\parallel}$ are therefore ordered as:\n$$\n\\left| \\frac{1}{ne} \\boldsymbol{b} \\cdot \\boldsymbol{\\nabla} p_{e} \\right| \\gg \\left| \\eta J_{\\parallel} \\right| \\gg \\left| \\frac{m_e}{n e^2} \\frac{\\partial J_{\\parallel}}{\\partial t} \\right|\n$$\nThe dominant term in the parallel Ohm's law for the given NTM parameters is the electron pressure gradient term. It is approximately $500$ times larger than the resistive term. The electron inertia term is, by contrast, completely negligible, being more than three orders of magnitude smaller than the already subdominant resistive term.\n\nThis dominance of the pressure gradient term is physically significant. It indicates that the parallel electric field required to sustain magnetic reconnection is primarily balanced by the parallel gradient of the electron pressure, not by simple resistivity. This is a hallmark of two-fluid reconnection regimes. The large magnitude of this term is a direct consequence of the high electron temperature ($T_e = 3.0\\,\\mathrm{keV}$) and the relatively short parallel connection length ($L_{\\parallel} = 30\\,\\mathrm{m}$) that characterizes the magnetic topology near the reconnection layer. In the vicinity of a magnetic island separatrix, field lines can have a short path from the hot core plasma to the cooler region outside the island, establishing a steep pressure gradient along $\\boldsymbol{B}$.\n\nConversely, the electron inertia term is negligible because the characteristic timescale for current evolution, $\\tau = 5.0\\,\\mathrm{ms}$, is relatively long. Inertial effects become significant only for very rapid phenomena (typically on sub-microsecond timescales for electrons). The millisecond-scale evolution typical of NTMs is too slow for electron inertia to play a role. The fundamental smallness of the electron mass $m_e$ also strongly suppresses this term.\n\nIn conclusion, for NTM-scale reconnection in a hot tokamak plasma with these parameters, the dynamics are governed by two-fluid effects, with the parallel electron pressure gradient being the crucial component that supports the reconnection electric field, while both resistivity and especially electron inertia play minor roles.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.44 \\times 10^{-4} & 5.00 \\times 10^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A central challenge in simulating the interaction between NTMs and turbulence is the vast separation of spatial scales. One must resolve both the very narrow inner tearing layer of the magnetic island, with width $\\delta$, and the broader characteristic wavelengths of the background turbulence, which scale with the ion gyroradius $\\rho_i$. This practice  provides a concrete exercise in numerical simulation design, requiring you to derive the grid resolution criteria necessary to simultaneously capture these disparate scales and calculate the required computational grid size for a realistic scenario.",
            "id": "4208078",
            "problem": "Consider a local slab representation of a tokamak rational surface where a Neoclassical Tearing Mode (NTM) island forms. You will design a coupled simulation domain that resolves both the NTM inner tearing layer width and the microturbulence scales characterized by perpendicular wavenumbers satisfying $k_{\\perp}\\rho_{i}\\sim 1$. The simulation will use a second-order centered Finite Difference (FD) scheme in the perpendicular plane.\n\nAssume the following physically realistic parameters for a deuterium plasma:\n- Magnetic field magnitude $B = 3\\,\\mathrm{T}$.\n- Ion temperature $T_{i} = 8\\,\\mathrm{keV}$.\n- Ion mass $m_{i} = 2 m_{p}$, where $m_{p}$ is the proton mass.\n- Elementary charge $e$ is the usual electron charge magnitude.\n\nThe NTM inner tearing layer width is given (from a separate inner-outer matching analysis) as $\\delta = 0.6\\,\\mathrm{mm}$. To ensure robust turbulent statistics, choose the binormal domain length to contain $5$ full wavelengths at the scale $k_{\\perp}\\rho_{i}\\sim 1$, namely $L_{y} = 5 \\lambda_{i}$ where $\\lambda_{i} = 2\\pi \\rho_{i}$. To capture the island and its immediate surroundings, set the radial domain to $L_{x} = 40\\,\\delta$. The FD scheme requires at least $p_{\\lambda} = 12$ points per perpendicular wavelength to resolve $k_{\\perp}\\rho_{i}\\sim 1$ scales and at least $p_{\\delta} = 15$ points across the tearing inner layer width to resolve the resistive boundary layer gradients.\n\nStarting from first principles:\n1. Define the ion gyroradius $\\rho_{i}$ from the thermal speed and cyclotron frequency using standard kinetic theory and express it in terms of $m_{i}$, $T_{i}$, $e$, and $B$.\n2. Derive resolution criteria for the grid spacings $\\Delta x$ and $\\Delta y$ that simultaneously resolve the tearing layer and the turbulence, based on sampling considerations and FD accuracy requirements. Your derivation must begin from the definition of a resolvable wavelength on a grid and the notion that accurately resolving a boundary layer of width $\\delta$ requires at least $p_{\\delta}$ grid points across it.\n3. Use these criteria to compute the required integer grid sizes $N_{x}$ and $N_{y}$ for the chosen $L_{x}$ and $L_{y}$.\n\nCompute the final numerical values of $N_{x}$ and $N_{y}$ for the specified parameters. No rounding by significant figures is needed; choose the minimum integers that satisfy the resolution criteria exactly as derived. The final answer must be the pair $\\left(N_{x}, N_{y}\\right)$.",
            "solution": "The problem requires the determination of the minimum integer grid sizes, $N_x$ and $N_y$, for a two-dimensional simulation domain that simultaneously resolves a Neoclassical Tearing Mode (NTM) inner layer and plasma microturbulence. The solution is derived by establishing resolution criteria for the finite difference grid spacings, $\\Delta x$ and $\\Delta y$, based on the physical scales of these phenomena.\n\n### Part 1: Ion Gyroradius Definition and Calculation\n\nThe ion gyroradius, $\\rho_i$, is a fundamental length scale for microturbulence. It is defined based on the ion's thermal motion perpendicular to the magnetic field.\n\nFollowing first principles from kinetic theory, the ion cyclotron frequency, $\\omega_{ci}$, is the angular frequency of an ion's gyration in a magnetic field $B$, given by:\n$$ \\omega_{ci} = \\frac{eB}{m_i} $$\nwhere $e$ is the elementary charge and $m_i$ is the ion mass.\n\nThe ion thermal speed is related to the ion temperature $T_i$. For a Maxwellian velocity distribution, the average kinetic energy in the two degrees of freedom perpendicular to the magnetic field is $\\langle \\frac{1}{2}m_i v_{\\perp}^2 \\rangle = T_i$, where $T_i$ is expressed in units of energy. This gives a root-mean-square (RMS) perpendicular thermal speed of:\n$$ v_{\\perp, \\text{rms}} = \\sqrt{\\frac{2T_i}{m_i}} $$\nThe thermal ion gyroradius, $\\rho_i$, is the Larmor radius corresponding to this characteristic thermal speed:\n$$ \\rho_i = \\frac{v_{\\perp, \\text{rms}}}{\\omega_{ci}} = \\frac{\\sqrt{2T_i/m_i}}{eB/m_i} $$\nSimplifying this expression yields the formula for the ion gyroradius in terms of the given parameters:\n$$ \\rho_i = \\frac{\\sqrt{2m_i T_i}}{eB} $$\nTo proceed, we must compute the numerical value of $\\rho_i$ to compare scales, although we will see that the final result for $N_x$ and $N_y$ can be obtained symbolically under a well-satisfied condition. The given parameters are:\n- $B = 3\\,\\text{T}$\n- $T_i = 8\\,\\text{keV} = 8 \\times 10^3\\,\\text{eV}$\n- $m_i = 2 m_p$, where $m_p \\approx 1.6726 \\times 10^{-27}\\,\\text{kg}$\n- $e \\approx 1.6022 \\times 10^{-19}\\,\\text{C}$\n\nFirst, we convert the ion temperature to Joules:\n$$ T_i = (8 \\times 10^3\\,\\text{eV}) \\times (1.6022 \\times 10^{-19}\\,\\text{J/eV}) = 1.28176 \\times 10^{-15}\\,\\text{J} $$\nThe ion mass is:\n$$ m_i = 2 \\times (1.6726 \\times 10^{-27}\\,\\text{kg}) = 3.3452 \\times 10^{-27}\\,\\text{kg} $$\nSubstituting these values into the expression for $\\rho_i$:\n$$ \\rho_i = \\frac{\\sqrt{2 \\times (3.3452 \\times 10^{-27}\\,\\text{kg}) \\times (1.28176 \\times 10^{-15}\\,\\text{J})}}{(1.6022 \\times 10^{-19}\\,\\text{C}) \\times (3\\,\\text{T})} $$\n$$ \\rho_i = \\frac{\\sqrt{8.575 \\times 10^{-42}}\\,\\text{kg}\\cdot\\text{J}}{4.8066 \\times 10^{-19}\\,\\text{C}\\cdot\\text{T}} = \\frac{2.928 \\times 10^{-21}\\,\\text{kg}\\cdot\\text{m/s}}{4.8066 \\times 10^{-19}\\,\\text{kg/s}} \\approx 6.093 \\times 10^{-3}\\,\\text{m} $$\nSo, $\\rho_i \\approx 6.1\\,\\text{mm}$.\n\n### Part 2: Derivation of Resolution Criteria\n\nA finite difference scheme requires the grid spacing to be sufficiently smaller than the smallest physical scale length to be resolved. The problem specifies two such scales and the required sampling for each.\n\n**Radial Resolution ($\\Delta x$):**\nIn the radial direction, two phenomena must be resolved: the NTM inner tearing layer and the microturbulence.\n1.  **Tearing Layer:** The layer has a width $\\delta = 0.6\\,\\text{mm}$. The problem requires at least $p_{\\delta} = 15$ grid points across this width. This implies that the total length of $p_{\\delta}$ grid cells must not exceed $\\delta$.\n    $$ p_{\\delta} \\Delta x \\leq \\delta \\implies \\Delta x \\leq \\frac{\\delta}{p_{\\delta}} $$\n2.  **Microturbulence:** The turbulence has a characteristic perpendicular wavelength $\\lambda_i = 2\\pi\\rho_i$, corresponding to $k_{\\perp}\\rho_i = 1$. This scale must be resolved in all perpendicular directions, including radially. The scheme requires at least $p_{\\lambda} = 12$ points per wavelength.\n    $$ p_{\\lambda} \\Delta x \\leq \\lambda_i \\implies \\Delta x \\leq \\frac{\\lambda_i}{p_{\\lambda}} $$\nTo resolve both phenomena correctly, the grid spacing $\\Delta x$ must satisfy the more restrictive of these two conditions:\n$$ \\Delta x \\leq \\min\\left(\\frac{\\delta}{p_{\\delta}}, \\frac{\\lambda_i}{p_{\\lambda}}\\right) $$\nLet's compare the maximum allowed grid spacing from each constraint:\n$$ \\frac{\\delta}{p_{\\delta}} = \\frac{0.6 \\times 10^{-3}\\,\\text{m}}{15} = 4 \\times 10^{-5}\\,\\text{m} $$\n$$ \\frac{\\lambda_i}{p_{\\lambda}} = \\frac{2\\pi \\rho_i}{p_{\\lambda}} \\approx \\frac{2\\pi \\times (6.093 \\times 10^{-3}\\,\\text{m})}{12} \\approx 3.19 \\times 10^{-3}\\,\\text{m} $$\nSince $4 \\times 10^{-5}\\,\\text{m} \\ll 3.19 \\times 10^{-3}\\,\\text{m}$, the constraint from resolving the tearing layer is significantly more stringent. Therefore, the governing resolution criterion for the radial direction is:\n$$ \\Delta x \\leq \\frac{\\delta}{p_{\\delta}} $$\n\n**Binormal Resolution ($\\Delta y$):**\nIn the binormal direction, the dominant scale to resolve is that of the microturbulence. The characteristic wavelength is $\\lambda_i = 2\\pi\\rho_i$, and the scheme requires $p_{\\lambda} = 12$ points per wavelength.\n$$ p_{\\lambda} \\Delta y \\leq \\lambda_i \\implies \\Delta y \\leq \\frac{\\lambda_i}{p_{\\lambda}} $$\n\n### Part 3: Computation of Grid Sizes $N_x$ and $N_y$\n\nThe number of grid points $N$ in a domain of length $L$ with grid spacing $\\Delta$ is $N = L/\\Delta$. To satisfy the resolution criterion $\\Delta \\leq \\Delta_{\\text{max}}$, we must have $L/N \\leq \\Delta_{\\text{max}}$, which implies $N \\geq L/\\Delta_{\\text{max}}$. The problem asks for the minimum integer grid size that satisfies this condition.\n\n**Radial Grid Size ($N_x$):**\nThe radial domain size is $L_x = 40\\,\\delta$. The maximum allowed grid spacing is $\\Delta x_{\\text{max}} = \\delta/p_{\\delta}$.\n$$ N_x \\geq \\frac{L_x}{\\Delta x_{\\text{max}}} = \\frac{40\\,\\delta}{\\delta/p_{\\delta}} = 40\\,p_{\\delta} $$\nSubstituting the given value $p_{\\delta} = 15$:\n$$ N_x \\geq 40 \\times 15 = 600 $$\nSince $600$ is an integer, the minimum required integer number of grid points is $N_x = 600$.\n\n**Binormal Grid Size ($N_y$):**\nThe binormal domain size is $L_y = 5\\,\\lambda_i$. The maximum allowed grid spacing is $\\Delta y_{\\text{max}} = \\lambda_i/p_{\\lambda}$.\n$$ N_y \\geq \\frac{L_y}{\\Delta y_{\\text{max}}} = \\frac{5\\,\\lambda_i}{\\lambda_i/p_{\\lambda}} = 5\\,p_{\\lambda} $$\nSubstituting the given value $p_{\\lambda} = 12$:\n$$ N_y \\geq 5 \\times 12 = 60 $$\nSince $60$ is an integer, the minimum required integer number of grid points is $N_y = 60$.\n\nThe final required grid sizes are $(N_x, N_y) = (600, 60)$. It is notable that these results are independent of the specific physical parameters $B$, $T_i$, and $m_i$, provided that the condition $\\delta/p_{\\delta} \\ll \\lambda_i/p_{\\lambda}$ holds, which we have verified is the case for the given realistic parameters.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n600 & 60\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The interaction between an NTM and turbulence is not a one-way street; it forms a complex feedback loop where each phenomenon modifies the other, leading to rich nonlinear dynamics. Reduced dynamical models are powerful tools for exploring the possible outcomes of this interplay, such as whether the island saturates at a steady size or enters a state of perpetual oscillation known as a limit cycle. In this exercise , you will analyze a coupled two-variable system for the island width and a turbulence-driven zonal flow, and implement a numerical scheme to determine which of these long-term behaviors the system exhibits.",
            "id": "4208072",
            "problem": "You are given a reduced, nondimensional two-variable model that captures the interplay between the polarization current originating from the time-varying electric cross magnetic ($\\mathrm{E}\\times\\mathrm{B}$) zonal flow and the evolution of a Neoclassical Tearing Mode (NTM) island width. All variables and parameters are nondimensionalized using standard gyro-Bohm conventions, so no physical units are required in the final outputs. The model is intended to be scientifically realistic and derived from fundamental plasma physics constructs, and the goal is to determine, by direct computation and principled analysis, whether the system exhibits a steady saturation or a sustained limit cycle oscillation.\n\nThe state variables are the zonal-flow potential amplitude $\\phi_{\\mathrm{zonal}}(t)$ and the magnetic island width $w(t)$. They obey the coupled system\n$$\n\\frac{d\\phi}{dt} = S w - \\Gamma \\phi - \\zeta w^2 \\phi,\n$$\n$$\n\\frac{dw}{dt} = \\Delta_p - \\Lambda w - \\chi w^3 + \\Pi\\left(\\frac{S}{w} - \\frac{\\Gamma \\phi}{w^2} - \\zeta \\phi\\right),\n$$\nwhere $\\phi \\equiv \\phi_{\\mathrm{zonal}}$. The terms are constructed as follows from fundamental bases:\n- The $\\mathrm{E}\\times\\mathrm{B}$ flow is $\\mathbf{v}_E = -\\nabla\\phi \\times \\mathbf{b}/B$, and the ion polarization current density is $\\mathbf{J}_{\\mathrm{pol}} = (n_i m_i/B^2)d(\\nabla_\\perp^2\\phi)/dt$. Approximating $\\nabla_\\perp^2\\phi \\sim \\phi/w^2$ on the island scale, the polarization contribution entering the island width dynamics is captured by the $\\Pi$-weighted terms in the expression for $dw/dt$.\n- The magnetic island width evolves from a Rutherford-type drive-damping balance with effective constant drive $\\Delta_p$, linear response $\\Lambda w$, and nonlinear saturation $\\chi w^3$.\n- Zonal flows are driven by turbulent Reynolds stress modeled by $S w$, and damped by neoclassical friction $\\Gamma\\phi$ with additional island-modified friction $\\zeta w^2 \\phi$.\n\nA steady fixed point $(\\phi^\\ast,w^\\ast)$ satisfies $d\\phi/dt = 0$ and $dw/dt = 0$. From $d\\phi/dt=0$, one obtains\n$$\n\\phi^\\ast = \\frac{S w^\\ast}{\\Gamma + \\zeta(w^\\ast)^2}.\n$$\nSubstituting into $dw/dt$ shows the polarization current contributes no steady term at the fixed point and yields the cubic condition\n$$\n\\Delta_p - \\Lambda w^\\ast - \\chi(w^\\ast)^3 = 0.\n$$\n\nTo assess the onset of sustained oscillations, linearize the system about the fixed point and examine the Jacobian $\\mathbf{J}^\\ast$ with entries\n$$\nf_\\phi^\\ast = -\\Gamma - \\zeta(w^\\ast)^2, \\quad\nf_w^\\ast = S\\frac{\\Gamma - \\zeta(w^\\ast)^2}{\\Gamma + \\zeta(w^\\ast)^2},\n$$\n$$\ng_\\phi^\\ast = -\\Pi\\left(\\frac{\\Gamma}{(w^\\ast)^2} + \\zeta\\right), \\quad\ng_w^\\ast = -\\Lambda - 3\\chi(w^\\ast)^2 + \\Pi\\frac{S}{(w^\\ast)^2}\\left[-1 + \\frac{2\\Gamma}{\\Gamma + \\zeta(w^\\ast)^2}\\right].\n$$\nLet $\\mathrm{tr}^\\ast = f_\\phi^\\ast + g_w^\\ast$ and $\\det^\\ast = f_\\phi^\\ast g_w^\\ast - f_w^\\ast g_\\phi^\\ast$. A Hopf bifurcation, leading to limit cycles, occurs when $\\mathrm{tr}^\\ast = 0$ and $\\det^\\ast > 0$, with the additional transversality condition that changing a parameter (here $\\Pi$) causes the real part of the eigenvalues to cross zero. Algebraically, the trace is affine in $\\Pi$:\n$$\n\\mathrm{tr}^\\ast = -\\Gamma - \\zeta(w^\\ast)^2 - \\Lambda - 3\\chi(w^\\ast)^2 + \\Pi\\frac{S}{(w^\\ast)^2}\\left[-1 + \\frac{2\\Gamma}{\\Gamma + \\zeta(w^\\ast)^2}\\right],\n$$\nso, provided\n$$\nc \\equiv \\frac{S}{(w^\\ast)^2}\\left[-1 + \\frac{2\\Gamma}{\\Gamma + \\zeta(w^\\ast)^2}\\right] > 0,\n$$\nthe critical polarization strength for the Hopf threshold is\n$$\n\\Pi_{\\mathrm{Hopf}} = \\frac{\\Gamma + \\zeta(w^\\ast)^2 + \\Lambda + 3\\chi(w^\\ast)^2}{c},\n$$\nsubject to $\\det^\\ast > 0$ at $\\Pi = \\Pi_{\\mathrm{Hopf}}$. If $c \\le 0$, increasing $\\Pi$ does not yield $\\mathrm{tr}^\\ast = 0$, and the fixed point cannot undergo a Hopf via $\\Pi$.\n\nYour task is to write a program that for a given set of parameters $(\\Delta_p,\\Lambda,\\chi,\\Gamma,\\zeta,S,\\Pi)$:\n1. Solves the cubic for $w^\\ast$ and computes $\\phi^\\ast = S w^\\ast/(\\Gamma + \\zeta (w^\\ast)^2)$.\n2. Evaluates $\\mathrm{tr}^\\ast$ and $\\det^\\ast$ to assess the linear tendency (no output is required for these intermediate quantities).\n3. Integrates the full nonlinear system forward in time from a slightly perturbed initial condition near $(\\phi^\\ast,w^\\ast)$ and determines whether the long-time behavior is a sustained limit cycle (return boolean `True`) or a steady saturation (return boolean `False`). Use a robust criterion based on persistent oscillations in $w(t)$ after transients, such as a sustained number of peaks above a small threshold in the final portion of the time series; classify as sustained limit cycle only if the number of detected peaks in the final window is at least $5$ and the normalized standard deviation of $w(t)$ in that window exceeds $0.05$.\n\nNumerical details:\n- Use an explicit solver for ordinary differential equations with adaptive step size. Avoid divisions by zero by ensuring $w(t)$ does not fall below a small floor during evaluation, e.g., replace $w$ by $\\max(w,\\varepsilon)$ in denominators with $\\varepsilon = 10^{-6}$.\n- Integrate to final time $T = 500$, sample at uniform times dense enough to detect peaks.\n- Use initial conditions $\\phi(0) = 1.05 \\phi^\\ast$ and $w(0) = 0.95 w^\\ast$.\n\nTest suite:\nProvide results for the following four parameter sets to test different regimes—\n- Case $1$ (steady saturation, happy path): $\\Delta_p = 0.4$, $\\Lambda = 0.3$, $\\chi = 0.05$, $\\Gamma = 0.6$, $\\zeta = 0.5$, $S = 0.5$, $\\Pi = 0.2$.\n- Case $2$ (sustained limit cycle via strong polarization and weak island-induced friction): $\\Delta_p = 0.4$, $\\Lambda = 0.3$, $\\chi = 0.05$, $\\Gamma = 1.5$, $\\zeta = 0.1$, $S = 0.3$, $\\Pi = 12.0$.\n- Case $3$ (near-Hopf boundary, edge case expected to be steady): $\\Delta_p = 0.4$, $\\Lambda = 0.3$, $\\chi = 0.05$, $\\Gamma = 1.5$, $\\zeta = 0.1$, $S = 0.3$, $\\Pi = 9.0$.\n- Case $4$ (strong damping suppresses oscillations despite large polarization): $\\Delta_p = 0.4$, $\\Lambda = 0.3$, $\\chi = 0.05$, $\\Gamma = 2.0$, $\\zeta = 0.5$, $S = 0.3$, $\\Pi = 12.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the classification results for the four cases as a comma-separated list of booleans enclosed in square brackets, for example `[True, False, True, False]`. No other text should be printed. No physical units are required in the output, and angles are not involved.",
            "solution": "The problem presents a coupled system of two nonlinear ordinary differential equations (ODEs) describing the interaction between a neoclassical tearing mode (NTM) island width, $w(t)$, and the amplitude of a zonal flow potential, $\\phi(t)$. The task is to determine, for several sets of physical parameters, whether the system evolves to a steady-state fixed point or a sustained limit cycle oscillation.\n\n### Problem Validation\n\nThe problem statement has been meticulously validated and is deemed valid.\n1.  **Scientific Grounding**: The model is based on established principles of fusion plasma physics. The equations represent a reduced form of the dynamics of NTMs interacting with turbulence-driven zonal flows, incorporating effects like the Rutherford-type island evolution, polarization currents, and neoclassical friction. The analysis via fixed points and linear stability (Hopf bifurcation) is a standard method in dynamical systems theory. The mathematical derivations provided for the fixed point and Jacobian elements have been verified and are correct.\n2.  **Well-Posedness**: The problem is well-posed. It provides a complete set of equations, all necessary parameters for each test case, specified initial conditions for numerical integration, and a clear, quantitative criterion for classifying the outcome. The cubic equation for the fixed-point island width, $\\chi(w^\\ast)^3 + \\Lambda w^\\ast - \\Delta_p = 0$, can be shown to have a unique positive real root $w^\\ast$ for the given physical constraints ($\\chi > 0$, $\\Lambda > 0$, $\\Delta_p > 0$), which ensures a unique physical steady state for analysis.\n3.  **Objectivity**: The problem is entirely objective, expressed in precise mathematical language, and requires a computational solution based on unambiguous criteria.\n\nThe problem is a well-defined computational task in physics, free from any of the flaws listed in the validation checklist.\n\n### Algorithmic Approach\n\nThe solution involves a three-step numerical procedure for each given parameter set $(\\Delta_p, \\Lambda, \\chi, \\Gamma, \\zeta, S, \\Pi)$.\n\n**Step 1: Fixed Point Calculation**\n\nThe first step is to determine the system's fixed point $(\\phi^\\ast, w^\\ast)$, which serves as the reference state for both the initial conditions and understanding the system's stability.\n*   The fixed-point island width, $w^\\ast$, is found by solving the cubic equation:\n    $$\n    \\chi (w^\\ast)^3 + \\Lambda w^\\ast - \\Delta_p = 0\n    $$\n    This is a polynomial equation of the form $ax^3 + bx^2 + cx + d = 0$ with coefficients $[\\chi, 0, \\Lambda, -\\Delta_p]$. We solve this numerically to find its roots. As established, there is a single unique positive real root which corresponds to the physical island width $w^\\ast$.\n*   With $w^\\ast$ computed, the corresponding fixed-point zonal flow potential amplitude, $\\phi^\\ast$, is calculated directly from its equilibrium relation:\n    $$\n    \\phi^\\ast = \\frac{S w^\\ast}{\\Gamma + \\zeta (w^\\ast)^2}\n    $$\n\n**Step 2: Numerical Integration of the Nonlinear System**\n\nThe full nonlinear dynamics are simulated by integrating the system of ODEs forward in time.\n*   The system of equations is:\n    $$\n    \\frac{d\\phi}{dt} = S w - \\Gamma \\phi - \\zeta w^2 \\phi\n    $$\n    $$\n    \\frac{dw}{dt} = \\Delta_p - \\Lambda w - \\chi w^3 + \\Pi \\left( \\frac{S}{w_{\\mathrm{reg}}} - \\frac{\\Gamma \\phi}{w_{\\mathrm{reg}}^2} - \\zeta \\phi \\right)\n    $$\n    where $w_{\\mathrm{reg}} = \\max(w, \\varepsilon)$ with a small positive constant $\\varepsilon = 10^{-6}$ to prevent division by zero, ensuring numerical stability.\n*   The integration is performed using a robust, adaptive step-size ODE solver, specifically the `solve_ivp` function from the `scipy.integrate` library.\n*   The simulation runs from $t=0$ to a final time $T=500$, which is sufficiently long to allow initial transients to decay and the system to settle into its long-term behavior.\n*   The initial conditions are a small perturbation from the fixed point to trigger any potential instability:\n    $$\n    \\phi(0) = 1.05 \\phi^\\ast, \\quad w(0) = 0.95 w^\\ast\n    $$\n*   The solution is sampled at a high-frequency uniform grid of time points to produce a detailed time series for $w(t)$ and $\\phi(t)$.\n\n**Step 3: Classification of Long-Term Behavior**\n\nThe final step is to analyze the time series of the island width, $w(t)$, to classify the system's asymptotic state as either a steady saturation or a sustained limit cycle. The analysis is confined to the final portion of the simulation, from $t = 300$ to $t = 500$, to focus on the long-term behavior.\n*   **Peak Detection**: A simple peak-finding algorithm is applied to the segment of the $w(t)$ time series in the analysis window. A point $w(t_i)$ is counted as a peak if it is a local maximum, i.e., $w(t_i) > w(t_{i-1})$ and $w(t_i) > w(t_{i+1})$. The total number of peaks, $N_{\\mathrm{peaks}}$, is counted.\n*   **Amplitude Analysis**: The normalized standard deviation of $w(t)$ within the same final window is calculated. This is the coefficient of variation, defined as $\\sigma_w / \\mu_w$, where $\\sigma_w$ is the standard deviation and $\\mu_w$ is the mean of $w(t)$ in the window.\n*   **Classification Criterion**: The system is classified as exhibiting a sustained limit cycle if and only if both of the following conditions are met:\n    1.  The number of detected peaks is at least $5$ ($N_{\\mathrm{peaks}} \\geq 5$).\n    2.  The normalized standard deviation is greater than $0.05$ ($\\sigma_w / \\mu_w > 0.05$).\n    Otherwise, the system is classified as reaching a steady saturation. This dual criterion ensures that the classification is based on both the persistence of oscillations (many peaks) and their significant amplitude (large relative deviation).\n\nThis comprehensive procedure is applied to each of the four parameter sets provided, and the resulting boolean classification (`True` for limit cycle, `False` for steady saturation) for each case is collected to form the final output.",
            "answer": "$$\n\\boxed{[False, True, False, False]}\n$$"
        }
    ]
}