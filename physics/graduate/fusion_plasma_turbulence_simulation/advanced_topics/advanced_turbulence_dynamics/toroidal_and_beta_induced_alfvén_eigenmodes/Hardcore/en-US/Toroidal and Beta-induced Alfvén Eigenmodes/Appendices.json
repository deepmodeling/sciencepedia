{
    "hands_on_practices": [
        {
            "introduction": "Before embarking on complex numerical simulations, a physicist must be able to make order-of-magnitude estimates from first principles. This practice is your opportunity to derive the characteristic frequency of the Toroidicity-induced Alfvén Eigenmode (TAE) from the ground up. By starting with the basic shear Alfvén wave and considering the effect of toroidal geometry, you will see how the coupling of poloidal harmonics creates a frequency gap and then apply this theory to a practical calculation .",
            "id": "4206973",
            "problem": "In a large-aspect-ratio tokamak relevant to fusion plasma turbulence simulation, the toroidicity-induced Alfvén eigenmode (TAE) arises from toroidal coupling between adjacent poloidal harmonics of shear Alfvén waves, producing a frequency gap around the field-line continuum. Using single-fluid ideal magnetohydrodynamics (MHD) in the low-plasma-beta limit and treating the background magnetic field as approximately toroidal and uniform, derive the leading-order expression for the characteristic angular frequency at the center of the toroidal Alfvén gap of the TAE. Begin from the shear Alfvén wave relation in a uniform plasma and the geometric form of the parallel wavenumber along magnetic field lines in a tokamak. Show how the toroidal coupling between adjacent poloidal harmonics $m$ and $m+1$ sets the effective parallel wavenumber at the gap center. Then, evaluate the resulting angular frequency numerically for the following parameters: major radius $R=3\\,\\mathrm{m}$, safety factor $q=2$, toroidal magnetic field $B_0=3\\,\\mathrm{T}$, ion number density $n_i=5\\times 10^{19}\\,\\mathrm{m^{-3}}$, and deuterium ion mass $m_i=3.34\\times 10^{-27}\\,\\mathrm{kg}$. Use the vacuum permeability $\\mu_0=4\\pi\\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$. Express your final answer as an angular frequency in $\\mathrm{rad\\,s^{-1}}$ and round to four significant figures.",
            "solution": "The problem statement submitted for consideration is valid. It is scientifically grounded in the principles of ideal magnetohydrodynamics (MHD) as applied to tokamak plasmas, a core topic in fusion research. The problem is well-posed, providing all necessary physical parameters and constants to derive a unique, meaningful numerical solution. The language is objective and precise, and the parameters provided ($R=3\\,\\mathrm{m}$, $q=2$, $B_0=3\\,\\mathrm{T}$, $n_i=5\\times 10^{19}\\,\\mathrm{m^{-3}}$) are physically realistic for a large tokamak. The derivation requested is a standard, non-trivial exercise in plasma physics. Therefore, proceeding to a full solution is warranted.\n\nThe derivation begins with the dispersion relation for shear Alfvén waves in a uniform plasma, which is given by:\n$$\n\\omega = |k_\\parallel| v_A\n$$\nwhere $\\omega$ is the angular frequency, $k_\\parallel$ is the component of the wavevector parallel to the magnetic field $\\vec{B}$, and $v_A$ is the Alfvén speed.\n\nThe Alfvén speed is defined as:\n$$\nv_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}\n$$\nIn the context of a low-beta tokamak plasma with a strong toroidal magnetic field $B_0$ and a single ion species (deuterium), we can approximate the magnetic field magnitude as $B \\approx B_0$ and the mass density as $\\rho \\approx n_i m_i$, where $n_i$ is the ion number density and $m_i$ is the ion mass. Thus, the Alfvén speed is:\n$$\nv_A = \\frac{B_0}{\\sqrt{\\mu_0 n_i m_i}}\n$$\nIn the toroidal geometry of a tokamak, for a wave perturbation of the form $\\exp[i(n\\phi - m\\theta - \\omega t)]$, where $n$ is the toroidal mode number and $m$ is the poloidal mode number, the parallel wavenumber $k_\\parallel$ is given by the projection of the wavevector onto the magnetic field direction. In the large-aspect-ratio approximation ($r/R \\ll 1$, where $r$ is the minor radius and $R$ is the major radius), this is expressed as:\n$$\nk_\\parallel = \\frac{\\vec{k} \\cdot \\vec{B}}{|\\vec{B}|} \\approx \\frac{1}{R} \\left( n - \\frac{m}{q} \\right)\n$$\nwhere $q$ is the safety factor, which characterizes the pitch of the magnetic field lines.\n\nThe toroidicity-induced Alfvén eigenmode (TAE) arises from the coupling of two adjacent poloidal harmonics, $m$ and $m+1$, due to the toroidal geometry. The continuous spectra of these two modes are described by their respective frequencies:\n$$\n\\omega_m = |k_{\\parallel, m}| v_A = \\left| \\frac{1}{R} \\left( n - \\frac{m}{q} \\right) \\right| v_A\n$$\n$$\n\\omega_{m+1} = |k_{\\parallel, m+1}| v_A = \\left| \\frac{1}{R} \\left( n - \\frac{m+1}{q} \\right) \\right| v_A\n$$\nAt a specific radial location, these two continuous spectra can become degenerate, i.e., $\\omega_m = \\omega_{m+1}$. This occurs where $|k_{\\parallel, m}| = |k_{\\parallel, m+1}|$. Since the two wavenumbers cannot be equal, this implies $k_{\\parallel, m} = -k_{\\parallel, m+1}$:\n$$\n\\frac{1}{R} \\left( n - \\frac{m}{q} \\right) = - \\frac{1}{R} \\left( n - \\frac{m+1}{q} \\right)\n$$\nSolving for the safety factor $q$ at this location gives:\n$$\nn - \\frac{m}{q} = -n + \\frac{m+1}{q}\n$$\n$$\n2n = \\frac{2m+1}{q}\n$$\n$$\nq = \\frac{m + 1/2}{n}\n$$\nAt this rational surface, the toroidal coupling lifts the degeneracy and opens a frequency gap in the shear Alfvén continuum. The center of this gap corresponds to the frequency at the point of degeneracy. The effective parallel wavenumber at this point can be calculated by substituting the expression for $q$ back into either $k_{\\parallel, m}$ or $k_{\\parallel, m+1}$. Using $k_{\\parallel, m}$:\n$$\nk_{\\parallel, \\text{TAE}} = \\frac{1}{R} \\left( n - \\frac{m}{(m+1/2)/n} \\right) = \\frac{n}{R} \\left( 1 - \\frac{m}{m+1/2} \\right) = \\frac{n}{R} \\left( \\frac{m+1/2 - m}{m+1/2} \\right) = \\frac{n}{R} \\frac{1/2}{qn} = \\frac{1}{2qR}\n$$\nThe magnitude of the parallel wavenumber at the gap is therefore $|k_{\\parallel, \\text{TAE}}| = \\frac{1}{2qR}$.\n\nThe characteristic angular frequency of the TAE, $\\omega_{TAE}$, which lies at the center of the gap, is then given by:\n$$\n\\omega_{TAE} = |k_{\\parallel, \\text{TAE}}| v_A = \\frac{v_A}{2qR}\n$$\nSubstituting the expression for the Alfvén speed $v_A$, we obtain the final analytical expression for the TAE gap frequency:\n$$\n\\omega_{TAE} = \\frac{B_0}{2qR \\sqrt{\\mu_0 n_i m_i}}\n$$\nWe can now evaluate this expression numerically using the provided parameters:\n- Major radius: $R = 3\\,\\mathrm{m}$\n- Safety factor: $q = 2$\n- Toroidal magnetic field: $B_0 = 3\\,\\mathrm{T}$\n- Ion number density: $n_i = 5 \\times 10^{19}\\,\\mathrm{m^{-3}}$\n- Deuterium ion mass: $m_i = 3.34 \\times 10^{-27}\\,\\mathrm{kg}$\n- Vacuum permeability: $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}$\n\nFirst, calculate the term in the denominator under the square root:\n$$\n\\mu_0 n_i m_i = (4\\pi \\times 10^{-7}\\,\\mathrm{N\\,A^{-2}}) \\times (5 \\times 10^{19}\\,\\mathrm{m^{-3}}) \\times (3.34 \\times 10^{-27}\\,\\mathrm{kg})\n$$\n$$\n\\mu_0 n_i m_i \\approx (1.2566 \\times 10^{-6}) \\times (5 \\times 10^{19}) \\times (3.34 \\times 10^{-27})\\,\\mathrm{kg\\,m^{-1}}\n$$\n$$\n\\mu_0 n_i m_i \\approx 2.0986 \\times 10^{-13}\\,\\mathrm{kg\\,m^{-1}}\n$$\nNext, calculate the Alfvén speed, $v_A$:\n$$\nv_A = \\frac{B_0}{\\sqrt{\\mu_0 n_i m_i}} = \\frac{3\\,\\mathrm{T}}{\\sqrt{2.0986 \\times 10^{-13}\\,\\mathrm{kg\\,m^{-1}}}} \\approx \\frac{3}{4.5810 \\times 10^{-7}}\\,\\mathrm{m\\,s^{-1}}\n$$\n$$\nv_A \\approx 6.5488 \\times 10^6\\,\\mathrm{m\\,s^{-1}}\n$$\nFinally, calculate the TAE angular frequency, $\\omega_{TAE}$:\n$$\n\\omega_{TAE} = \\frac{v_A}{2qR} = \\frac{6.5488 \\times 10^6\\,\\mathrm{m\\,s^{-1}}}{2 \\times 2 \\times 3\\,\\mathrm{m}} = \\frac{6.5488 \\times 10^6}{12}\\,\\mathrm{s^{-1}}\n$$\n$$\n\\omega_{TAE} \\approx 545733\\,\\mathrm{rad\\,s^{-1}} = 5.45733 \\times 10^5\\,\\mathrm{rad\\,s^{-1}}\n$$\nRounding the result to four significant figures as requested, we get $5.457 \\times 10^5\\,\\mathrm{rad\\,s^{-1}}$.",
            "answer": "$$\n\\boxed{5.457 \\times 10^5}\n$$"
        },
        {
            "introduction": "Translating physical laws into a robust numerical simulation is a non-trivial task, involving subtle choices that can profoundly impact the results. This exercise delves into one of the most critical aspects: the implementation of boundary conditions in ideal MHD simulations of Alfvén eigenmodes. You will explore the consequences of different boundary condition choices and learn principled methods to distinguish genuine global eigenmodes from spurious, unphysical solutions that can arise at the edge of the computational domain .",
            "id": "4206983",
            "problem": "In a global simulation of Toroidal Alfvén Eigenmodes (TAE) and Beta-Induced Alfvén Eigenmodes (BAE) in a tokamak, consider a linear ideal Magnetohydrodynamics (MHD) eigenvalue problem for shear Alfvén perturbations on a fixed equilibrium with background magnetic field $\\mathbf{B}_0$, mass density $\\rho$, and Alfvén speed $v_A = B_0/\\sqrt{\\mu_0 \\rho}$. The code solves for a scalar field representing the parallel component of the perturbed vector potential $A_\\parallel(r)$ in a cylindrical approximation, with poloidal and toroidal harmonics coupled toroidally. The eigenvalue problem is self-adjoint on an appropriate function space with inner product derived from the ideal MHD energy principle, and the spectrum contains discrete gap modes (e.g., TAE/BAE) and the shear Alfvén continuum.\n\nTwo alternative boundary conditions are considered at the plasma edge $r=a$:\n- A Dirichlet boundary condition on the computational variable: $A_\\parallel(a)=0$.\n- A perfectly conducting wall boundary condition: tangential electric field vanishes at the wall, $\\mathbf{n}\\times \\mathbf{E}(a)=\\mathbf{0}$, where $\\mathbf{n}$ is the outward normal at $r=a$. In ideal MHD, with $\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0 = \\mathbf{0}$ and the linearized induction equation, this implies that the normal component of the magnetic perturbation vanishes at the wall, $\\delta B_n(a)=0$.\n\nUsing only first principles (Maxwell–Faraday law $\\nabla\\times \\mathbf{E} = -\\partial_t \\mathbf{B}$, ideal Ohm’s law $\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0 = \\mathbf{0}$, the flux-freezing condition, and the variational/min–max characterization of eigenvalues for self-adjoint operators), reason qualitatively about how these boundary conditions affect the computed eigenmodes and eigenfrequencies for TAE/BAE, and how one should identify spurious edge-localized solutions that may arise from discretization or inconsistent boundary enforcement.\n\nWhich of the following statements are correct?\n\nA. For a perfectly conducting wall at $r=a$, the physical boundary condition for ideal MHD shear Alfvén perturbations is $\\mathbf{n}\\times \\mathbf{E}(a)=\\mathbf{0}$, which by flux freezing implies $\\delta B_n(a)=0$. In a formulation using $A_\\parallel(r)$, this generally maps to a mixed (Robin-type) constraint of the form $c_1 A_\\parallel(a) + c_2 \\,\\partial_r A_\\parallel(a)=0$ with $c_2\\neq 0$. Imposing a Dirichlet condition $A_\\parallel(a)=0$ instead overconstrains the eigenfunction, typically pushing eigenfrequencies upward by the variational min–max principle. Spurious edge-localized solutions can be detected because their eigenfrequencies approach the local shear Alfvén continuum value $\\omega \\approx |k_\\parallel(a)|\\, v_A$ as resolution increases, where $k_\\parallel(r)$ is the parallel wavenumber.\n\nB. With a Dirichlet boundary condition on $A_\\parallel$, the computed TAE eigenfunction correctly enforces a physical node corresponding to $\\delta B_n(a)=0$, so Dirichlet realizes the perfectly conducting wall. Edge-localized solutions that appear under Dirichlet are genuine bound states due to the vacuum region and are not spurious.\n\nC. For a perfectly conducting wall, the correct boundary condition is $\\partial_r A_\\parallel(a)=0$ for all toroidal mode numbers, making Dirichlet and conducting-wall boundary conditions effectively equivalent up to a constant scaling. Any edge-localized modes can be removed simply by enlarging the vacuum domain outside $r=a$.\n\nD. Spurious edge-localized eigenmodes can be robustly identified by evaluating the ideal MHD energy principle: compute the fraction of the mode energy density residing within a boundary layer of width proportional to the grid spacing near $r=a$ and test its behavior under grid refinement. If this boundary-layer energy fraction does not decrease as the grid is refined while the global mode energy remains unchanged, the mode is spurious. Additionally, checking constraint violation such as $\\nabla \\cdot \\delta \\mathbf{B} = 0$ near the boundary provides a diagnostic: persistent increases in $\\|\\nabla \\cdot \\delta \\mathbf{B}\\|$ localized at the edge under Dirichlet enforcement indicate spurious modes created by inconsistent boundary conditions.\n\nChoose all that apply.",
            "solution": "We begin from fundamental relations. In ideal Magnetohydrodynamics (MHD), the ideal Ohm’s law states $\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0 = \\mathbf{0}$, and Maxwell–Faraday law gives $\\nabla\\times \\mathbf{E} = -\\partial_t \\mathbf{B}$. For a perfectly conducting wall, the tangential electric field vanishes at the wall, $\\mathbf{n}\\times \\mathbf{E}(a) = \\mathbf{0}$. Under linear perturbations and the flux-freezing condition implied by the ideal Ohm’s law, changes to magnetic flux linking a perfectly conducting surface are prohibited, which leads to $\\delta B_n(a) = \\mathbf{n}\\cdot \\delta \\mathbf{B}(a) = 0$. This is the physically correct electromagnetic boundary condition.\n\nIn a reduced formulation that solves for a scalar field such as the parallel component of the perturbed vector potential $A_\\parallel(r)$ associated with shear Alfvén dynamics, the wall condition $\\delta B_n(a)=0$ couples the value of $A_\\parallel$ to its radial derivative via the geometric relations between $\\delta \\mathbf{B}$ and $A_\\parallel$. Specifically, using the linearized induction $\\delta \\mathbf{B} = \\nabla \\times \\delta \\mathbf{A}$ and decomposing $\\delta \\mathbf{A}$ with a dominant component parallel to $\\mathbf{B}_0$, one generally obtains a boundary relation of the form $c_1 A_\\parallel(a) + c_2 \\,\\partial_r A_\\parallel(a) = 0$, where $c_1$ and $c_2$ are nonzero geometric coefficients determined by local curvature, shear, and the choice of gauge and representation. This is a mixed (Robin-type) boundary condition rather than purely Dirichlet or purely Neumann.\n\nNow, consider the impact of adopting a Dirichlet condition $A_\\parallel(a) = 0$ instead of the physical conducting-wall condition. The linear eigenproblem for the shear Alfvén operator is self-adjoint in the relevant energy inner product, with eigenfrequencies $\\omega$ characterized by a Rayleigh quotient (variational) principle derived from the ideal MHD energy principle. If the domain of admissible functions is reduced by an extra boundary constraint that is stronger than necessary (for example, forcing $A_\\parallel(a) = 0$ instead of satisfying the mixed wall condition), the min–max principle implies that the discrete eigenvalues are shifted upward: constraining the trial space increases the Rayleigh quotient for the lowest eigenvalues. Physically, an overconstrained edge diminishes the mode’s amplitude in the boundary region and shortens the effective radial wavelength, raising $\\omega$ for gap modes like TAE/BAE.\n\nSpurious edge-localized solutions can arise due to discretization when the numerical enforcement of Dirichlet on $A_\\parallel$ is not consistent with $\\delta B_n(a)=0$. Such modes tend to become trapped in the last few grid cells near $r=a$ and satisfy the local continuum relation $\\omega^2 \\approx k_\\parallel^2(a) v_A^2$, where $k_\\parallel(r)$ is the parallel wavenumber, $k_\\parallel(r) = (n - m/q(r))/R$ in a cylindrical approximation with safety factor $q(r)$ and major radius $R$. As resolution increases, these modes continue to lock to the local continuum at the edge rather than converging as global discrete gap modes, signaling that they are numerical artifacts rather than physical TAE/BAE eigenmodes.\n\nMoreover, diagnostics based on the energy principle can distinguish spurious modes. Define an energy density $\\mathcal{E}(r)$ associated with the ideal MHD perturbation, and compute the fraction residing in a boundary layer of width proportional to the grid spacing $\\Delta r$ near $r=a$. For a physical global mode, as the grid is refined ($\\Delta r \\to 0$), the fraction of energy in this vanishingly thin layer should decrease to zero. For a spurious edge-localized mode, the fraction remains non-decreasing or approximately constant, indicating concentration that scales with the grid rather than physics. In addition, ideal MHD constraints like $\\nabla \\cdot \\delta \\mathbf{B} = 0$ should be maintained to truncation error. Persistent increases in $\\|\\nabla \\cdot \\delta \\mathbf{B}\\|$ localized near the boundary under Dirichlet enforcement indicate inconsistency in boundary conditions and numerical spuriousness.\n\nWe now evaluate each option:\n\nOption A: It correctly states the physical wall condition $\\mathbf{n}\\times \\mathbf{E}(a)=\\mathbf{0}$ and its implication $\\delta B_n(a)=0$ under ideal flux-freezing. It also correctly identifies that, in a scalar $A_\\parallel$ formulation, the wall condition generally becomes a Robin-type constraint, not pure Dirichlet or Neumann. The statement about Dirichlet overconstraining the eigenfunction and pushing eigenfrequencies upward is consistent with the min–max variational argument. Lastly, the identification of spurious edge modes via their frequencies tracking the edge continuum $\\omega \\approx |k_\\parallel(a)|\\, v_A$ under refinement is correct. Verdict: Correct.\n\nOption B: It claims that Dirichlet on $A_\\parallel$ enforces a physical node corresponding to $\\delta B_n(a)=0$, but Dirichlet on $A_\\parallel$ is not equivalent to the electromagnetic condition $\\delta B_n(a)=0$. The relationship depends on geometry and representation and is generally mixed; therefore Dirichlet does not, in general, realize the perfectly conducting wall. The assertion that edge-localized solutions under Dirichlet are genuine bound states due to the vacuum region contradicts the expected behavior of numerical artifacts that lock to the local continuum and do not converge as global modes. Verdict: Incorrect.\n\nOption C: It asserts $\\partial_r A_\\parallel(a)=0$ is the correct wall condition for all toroidal mode numbers and that Dirichlet and conducting-wall boundary conditions are equivalent up to scaling. This is not generally true; the wall condition maps to a mixed constraint with coefficients depending on geometry and mode structure. Neumann ($\\partial_r A_\\parallel(a) = 0$) is not universally valid. Furthermore, enlarging the vacuum domain does not, by itself, remove spurious edge-localized modes created by inconsistent boundary conditions; it may even accentuate edge trapping. Verdict: Incorrect.\n\nOption D: It proposes an energy-based diagnostic for spurious modes and adds a constraint check $\\nabla \\cdot \\delta \\mathbf{B} = 0$ localized at the boundary. Both are principled and derived from the ideal MHD energy principle and solenoidal condition on $\\delta \\mathbf{B}$. The scaling with grid spacing in the boundary layer energy fraction and the persistence of solenoidal constraint violation at the edge under Dirichlet enforcement are sound indicators of spuriousness. Verdict: Correct.\n\nTherefore, the correct options are A and D.",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "The physics of Beta-induced Alfvén Eigenmodes (BAEs) is deeply rooted in kinetic theory, where wave-particle interactions like Landau damping play a crucial role. This advanced hands-on practice moves beyond ideal MHD to the realm of gyrokinetic simulation, tasking you with a fundamental step in computational science: verification and validation. You will design and implement a convergence study to ensure that the numerical approximations for key kinetic effects are accurate, a vital skill for anyone producing cutting-edge simulation results in plasma physics .",
            "id": "4206995",
            "problem": "You are tasked with designing and executing a numerical convergence study for the Beta-Induced Alfvén Eigenmode (BAE) compressibility and its Landau damping using reduced gyrokinetic kinetic theory. The physical context concerns Toroidal Alfvén Eigenmodes (TAE) and Beta-Induced Alfvén Eigenmodes (BAE) in fusion plasma turbulence simulation. The study must quantify how accuracy depends on resolving finite Larmor radius effects through $k_{\\perp}\\rho_i$ and on the quality of velocity-space quadrature.\n\nFundamental base and model definitions:\n- Consider a homogeneous plasma with Maxwellian ions and electrons, with the equilibrium distribution function $f_0(\\mathbf{v})$ Maxwellian. Normalize velocities by the ion thermal speed $v_{\\mathrm{th},i}$, define $x = v_{\\parallel}/v_{\\mathrm{th},i}$ and $y = v_{\\perp}^2/v_{\\mathrm{th},i}^2$. Define the normalized frequency $\\zeta = \\omega/(k_{\\parallel}v_{\\mathrm{th},i})$, taken real for this study. Define $a = k_{\\perp}\\rho_{i,\\mathrm{th}}$, where $\\rho_{i,\\mathrm{th}} = v_{\\mathrm{th},i}/\\Omega_i$ is the ion thermal gyroradius and $\\Omega_i$ is the ion gyrofrequency. The perpendicular finite Larmor radius (FLR) averaging factor is\n$$\nA(a) = \\int_{0}^{\\infty} e^{-y} J_0^2\\!\\left(a\\sqrt{y}\\right)\\,dy,\n$$\nwith $J_0$ the zeroth-order Bessel function. The exact closed-form identity for the above FLR factor is\n$$\nA_{\\mathrm{exact}}(a) = \\exp\\!\\left(-\\frac{a^2}{2}\\right) I_0\\!\\left(\\frac{a^2}{2}\\right),\n$$\nwith $I_0$ the modified Bessel function of the first kind.\n- The plasma dispersion function is defined as\n$$\nZ(\\zeta) = \\frac{1}{\\sqrt{\\pi}}\\int_{-\\infty}^{\\infty}\\frac{e^{-x^2}}{x-\\zeta}\\,dx,\n$$\nunderstood as a Cauchy principal value for real $\\zeta$, and is equivalently expressed using the Faddeeva function $w(\\zeta)$ as\n$$\nZ(\\zeta) = i\\sqrt{\\pi}\\,w(\\zeta).\n$$\n- In a reduced gyrokinetic description of the BAE branch, the compressible response enters through a species susceptibility proportional to $1 + \\zeta Z(\\zeta)$, where $\\zeta$ captures the parallel dynamics and Landau resonance. For the purposes of this convergence study, define the dimensionless compressibility coefficient\n$$\nC(a,\\zeta) = A(a)\\,\\mathrm{Re}\\!\\left[1 + \\zeta Z(\\zeta)\\right],\n$$\nand the dimensionless Landau damping surrogate\n$$\n\\Gamma(a,\\zeta) = A(a)\\,\\mathrm{Im}\\!\\left[\\zeta Z(\\zeta)\\right].\n$$\n\nNumerical quadrature approximations:\n- Approximate $A(a)$ with Gauss–Laguerre quadrature of order $N_{\\mathrm{L}}$:\n$$\nA_{\\mathrm{quad}}(a;N_{\\mathrm{L}}) \\approx \\sum_{j=1}^{N_{\\mathrm{L}}} w_j\\,J_0^2\\!\\left(a\\sqrt{y_j}\\right),\n$$\nwhere $\\{y_j,w_j\\}$ are the Gauss–Laguerre nodes and weights associated with the weight $e^{-y}$ on $[0,\\infty)$.\n- Approximate $Z(\\zeta)$ with Gauss–Hermite quadrature of order $N_{\\mathrm{H}}$ and a small imaginary regularization $\\delta > 0$ to avoid the singularity for real $\\zeta$:\n$$\nZ_{\\mathrm{quad}}(\\zeta;N_{\\mathrm{H}},\\delta) \\approx \\frac{1}{\\sqrt{\\pi}}\\sum_{i=1}^{N_{\\mathrm{H}}}\\frac{w_i}{x_i - \\zeta - i\\delta},\n$$\nwhere $\\{x_i,w_i\\}$ are the Gauss–Hermite nodes and weights associated with the weight $e^{-x^2}$ on $(-\\infty,\\infty)$.\n- Using these, define\n$$\nC_{\\mathrm{quad}}(a,\\zeta;N_{\\mathrm{L}},N_{\\mathrm{H}},\\delta) = A_{\\mathrm{quad}}(a;N_{\\mathrm{L}})\\,\\mathrm{Re}\\!\\left[1 + \\zeta Z_{\\mathrm{quad}}(\\zeta;N_{\\mathrm{H}},\\delta)\\right],\n$$\n$$\n\\Gamma_{\\mathrm{quad}}(a,\\zeta;N_{\\mathrm{L}},N_{\\mathrm{H}},\\delta) = A_{\\mathrm{quad}}(a;N_{\\mathrm{L}})\\,\\mathrm{Im}\\!\\left[\\zeta Z_{\\mathrm{quad}}(\\zeta;N_{\\mathrm{H}},\\delta)\\right].\n$$\n\nReference (exact) values:\n- Compute $A_{\\mathrm{exact}}(a)$ using the closed form above.\n- Compute $Z_{\\mathrm{exact}}(\\zeta)$ using the Faddeeva function identity, and then\n$$\nC_{\\mathrm{exact}}(a,\\zeta) = A_{\\mathrm{exact}}(a)\\,\\mathrm{Re}\\!\\left[1 + \\zeta Z_{\\mathrm{exact}}(\\zeta)\\right],\\quad\n\\Gamma_{\\mathrm{exact}}(a,\\zeta) = A_{\\mathrm{exact}}(a)\\,\\mathrm{Im}\\!\\left[\\zeta Z_{\\mathrm{exact}}(\\zeta)\\right].\n$$\n\nError metrics and pass/fail:\n- For each parameter set, compute the relative errors\n$$\n\\varepsilon_C = \\frac{\\big|C_{\\mathrm{quad}} - C_{\\mathrm{exact}}\\big|}{\\max\\!\\left(\\big|C_{\\mathrm{exact}}\\big|,\\,10^{-30}\\right)},\\quad\n\\varepsilon_{\\Gamma} = \\frac{\\big|\\Gamma_{\\mathrm{quad}} - \\Gamma_{\\mathrm{exact}}\\big|}{\\max\\!\\left(\\big|\\Gamma_{\\mathrm{exact}}\\big|,\\,10^{-30}\\right)}.\n$$\n- A parameter set “passes” if both $\\varepsilon_C$ and $\\varepsilon_{\\Gamma}$ are strictly less than a user-specified tolerance $\\mathrm{tol}$.\n\nNormalization and units:\n- All quantities are dimensionless by normalization to $v_{\\mathrm{th},i}$ and $k_{\\parallel}v_{\\mathrm{th},i}$. No physical units are required.\n\nYour program must implement the above definitions and produce pass/fail results for the following test suite, which explores distinct regimes of $k_{\\perp}\\rho_i$ resolution and quadrature accuracy:\n- Test case $1$: $a = 0.7$, $\\zeta = 1.0$, $N_{\\mathrm{H}} = 64$, $N_{\\mathrm{L}} = 64$, $\\delta = 10^{-7}$, $\\mathrm{tol} = 10^{-6}$.\n- Test case $2$: $a = 5.0$, $\\zeta = 1.2$, $N_{\\mathrm{H}} = 8$, $N_{\\mathrm{L}} = 8$, $\\delta = 5\\times 10^{-3}$, $\\mathrm{tol} = 2\\times 10^{-3}$.\n- Test case $3$: $a = 2.5$, $\\zeta = 0.8$, $N_{\\mathrm{H}} = 128$, $N_{\\mathrm{L}} = 128$, $\\delta = 10^{-8}$, $\\mathrm{tol} = 10^{-7}$.\n\nFinal output requirement:\n- Your program should produce a single line of output containing the results of the pass/fail evaluation for the three test cases as a comma-separated list of booleans enclosed in square brackets, for example $[{\\mathrm{result}_1},{\\mathrm{result}_2},{\\mathrm{result}_3}]$.\n\nNo external inputs are required; the program must run self-contained. Ensure scientific realism and consistency with the definitions above.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It presents a clear task in computational plasma physics, specifically concerning the numerical evaluation of quantities related to Beta-Induced Alfvén Eigenmodes (BAE). The underlying physics, including finite Larmor radius (FLR) effects and Landau damping, is standard. The mathematical formalisms, such as the plasma dispersion function $Z(\\zeta)$, Bessel functions, and integral representations, are correct. The proposed numerical methods, Gauss-Laguerre and Gauss-Hermite quadratures, are appropriate for the integrals being approximated. All parameters and test conditions are explicitly defined, leading to a unique and verifiable solution. Therefore, a full solution is warranted.\n\nThe core of the problem is to compare numerically-approximated values of a compressibility coefficient $C_{\\mathrm{quad}}$ and a Landau damping surrogate $\\Gamma_{\\mathrm{quad}}$ against their exact analytical counterparts, $C_{\\mathrm{exact}}$ and $\\Gamma_{\\mathrm{exact}}$. This comparison is performed for three distinct sets of physical and numerical parameters to assess the accuracy of the numerical scheme.\n\nFirst, we establish the procedure for calculating the \"exact\" reference values. The FLR averaging factor $A(a)$ is given in a closed form involving the modified Bessel function of the first kind, $I_0$:\n$$\nA_{\\mathrm{exact}}(a) = \\exp\\!\\left(-\\frac{a^2}{2}\\right) I_0\\!\\left(\\frac{a^2}{2}\\right)\n$$\nThis is implemented using standard numerical library functions for the exponential and $I_0$ functions.\n\nThe plasma dispersion function $Z(\\zeta)$ is defined for real $\\zeta$ via its relation to the complex Faddeeva function, $w(\\zeta) = e^{-\\zeta^2}(1-\\mathrm{erf}(-i\\zeta))$:\n$$\nZ_{\\mathrm{exact}}(\\zeta) = i\\sqrt{\\pi}\\,w(\\zeta)\n$$\nThis is also computed using a standard, highly accurate library implementation of $w(\\zeta)$. With $A_{\\mathrm{exact}}(a)$ and $Z_{\\mathrm{exact}}(\\zeta)$ available, the exact reference values for the compressibility and damping are calculated as:\n$$\nC_{\\mathrm{exact}}(a,\\zeta) = A_{\\mathrm{exact}}(a)\\,\\mathrm{Re}\\!\\left[1 + \\zeta Z_{\\mathrm{exact}}(\\zeta)\\right]\n$$\n$$\n\\Gamma_{\\mathrm{exact}}(a,\\zeta) = A_{\\mathrm{exact}}(a)\\,\\mathrm{Im}\\!\\left[\\zeta Z_{\\mathrm{exact}}(\\zeta)\\right]\n$$\n\nNext, we implement the numerical quadrature approximations. The FLR factor $A(a)$ is approximated using an $N_{\\mathrm{L}}$-point Gauss–Laguerre quadrature. This method is suited for integrals of the form $\\int_0^\\infty e^{-y} f(y) dy$. The nodes $\\{y_j\\}$ and weights $\\{w_j\\}$ are generated, and the approximation is computed as the weighted sum:\n$$\nA_{\\mathrm{quad}}(a;N_{\\mathrm{L}}) = \\sum_{j=1}^{N_{\\mathrm{L}}} w_j\\,J_0^2\\!\\left(a\\sqrt{y_j}\\right)\n$$\nwhere $J_0$ is the zeroth-order Bessel function of the first kind.\n\nThe plasma dispersion function $Z(\\zeta)$ is approximated using an $N_{\\mathrm{H}}$-point Gauss–Hermite quadrature. This method is designed for integrals of the form $\\int_{-\\infty}^\\infty e^{-x^2} f(x) dx$. The nodes $\\{x_i\\}$ and weights $\\{w_i\\}$ are generated. A small imaginary part, $-i\\delta$, is added to the denominator to regularize the singularity at $x=\\zeta$ for real $\\zeta$. The approximation is:\n$$\nZ_{\\mathrm{quad}}(\\zeta;N_{\\mathrm{H}},\\delta) = \\frac{1}{\\sqrt{\\pi}}\\sum_{i=1}^{N_{\\mathrm{H}}}\\frac{w_i}{x_i - \\zeta - i\\delta}\n$$\nThese quadrature-based results are then used to compute the approximate compressibility and damping:\n$$\nC_{\\mathrm{quad}}(a,\\zeta;N_{\\mathrm{L}},N_{\\mathrm{H}},\\delta) = A_{\\mathrm{quad}}(a;N_{\\mathrm{L}})\\,\\mathrm{Re}\\!\\left[1 + \\zeta Z_{\\mathrm{quad}}(\\zeta;N_{\\mathrm{H}},\\delta)\\right]\n$$\n$$\n\\Gamma_{\\mathrm{quad}}(a,\\zeta;N_{\\mathrm{L}},N_{\\mathrm{H}},\\delta) = A_{\\mathrm{quad}}(a;N_{\\mathrm{L}})\\,\\mathrm{Im}\\!\\left[\\zeta Z_{\\mathrm{quad}}(\\zeta;N_{\\mathrm{H}},\\delta)\\right]\n$$\n\nFinally, for each of the three test cases, we perform the following steps:\n1.  Set the parameters $a$, $\\zeta$, $N_{\\mathrm{L}}$, $N_{\\mathrm{H}}$, $\\delta$, and $\\mathrm{tol}$.\n2.  Compute $C_{\\mathrm{exact}}(a,\\zeta)$ and $\\Gamma_{\\mathrm{exact}}(a,\\zeta)$.\n3.  Compute $C_{\\mathrm{quad}}(a,\\zeta;N_{\\mathrm{L}},N_{\\mathrm{H}},\\delta)$ and $\\Gamma_{\\mathrm{quad}}(a,\\zeta;N_{\\mathrm{L}},N_{\\mathrm{H}},\\delta)$.\n4.  Calculate the relative errors $\\varepsilon_C$ and $\\varepsilon_{\\Gamma}$ using the specified formulas, which include a floor value of $10^{-30}$ to prevent division by zero:\n    $$\n    \\varepsilon_C = \\frac{\\big|C_{\\mathrm{quad}} - C_{\\mathrm{exact}}\\big|}{\\max\\!\\left(\\big|C_{\\mathrm{exact}}\\big|,\\,10^{-30}\\right)},\\quad\n    \\varepsilon_{\\Gamma} = \\frac{\\big|\\Gamma_{\\mathrm{quad}} - \\Gamma_{\\mathrm{exact}}\\big|}{\\max\\!\\left(\\big|\\Gamma_{\\mathrm{exact}}\\big|,\\,10^{-30}\\right)}\n    $$\n5.  Determine if the test case \"passes\" by checking if both $\\varepsilon_C  \\mathrm{tol}$ and $\\varepsilon_{\\Gamma}  \\mathrm{tol}$. The result is a Boolean value.\n\nThis procedure is implemented in a Python program, leveraging the `numpy` library for numerical array operations and the `scipy.special` module for the required special functions ($J_0$, $I_0$, $w(\\zeta)$) and quadrature rule generation (`roots_laguerre`, `roots_hermite`). The results for the three test cases are collected into a list and printed in the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special\n\ndef compute_exact_values(a, zeta):\n    \"\"\"\n    Computes the exact reference values for C and Gamma.\n    \n    Args:\n        a (float): Normalized perpendicular wavenumber k_perp*rho_i.\n        zeta (float): Normalized phase velocity omega/(k_parallel*v_th_i).\n        \n    Returns:\n        tuple[float, float]: A tuple containing (C_exact, Gamma_exact).\n    \"\"\"\n    # Exact FLR averaging factor A_exact(a)\n    # A_exact(a) = exp(-a^2/2) * I_0(a^2/2)\n    a_sq_half = a**2 / 2.0\n    A_exact = np.exp(-a_sq_half) * special.i0(a_sq_half)\n    \n    # Exact plasma dispersion function Z_exact(zeta)\n    # Z_exact(zeta) = i * sqrt(pi) * w(zeta), where w is the Faddeeva function\n    Z_exact = 1j * np.sqrt(np.pi) * special.wofz(zeta)\n    \n    # Compute C_exact and Gamma_exact\n    zeta_Z_exact = zeta * Z_exact\n    C_exact = A_exact * np.real(1.0 + zeta_Z_exact)\n    Gamma_exact = A_exact * np.imag(zeta_Z_exact)\n    \n    return C_exact, Gamma_exact\n\ndef compute_quad_values(a, zeta, N_L, N_H, delta):\n    \"\"\"\n    Computes the quadrature-approximated values for C and Gamma.\n    \n    Args:\n        a (float): Normalized perpendicular wavenumber k_perp*rho_i.\n        zeta (float): Normalized phase velocity omega/(k_parallel*v_th_i).\n        N_L (int): Order of Gauss-Laguerre quadrature.\n        N_H (int): Order of Gauss-Hermite quadrature.\n        delta (float): Regularization parameter for the Z-function denominator.\n        \n    Returns:\n        tuple[float, float]: A tuple containing (C_quad, Gamma_quad).\n    \"\"\"\n    # Quadrature for FLR averaging factor A_quad(a; N_L)\n    # y_j are nodes, w_j are weights for Gauss-Laguerre quadrature\n    y_j, w_j = special.roots_laguerre(N_L)\n    j0_arg = a * np.sqrt(y_j)\n    A_quad = np.sum(w_j * special.j0(j0_arg)**2)\n    \n    # Quadrature for plasma dispersion function Z_quad(zeta; N_H, delta)\n    # x_i are nodes, w_i are weights for Gauss-Hermite quadrature\n    x_i, w_i = special.roots_hermite(N_H)\n    denominator = x_i - zeta - 1j * delta\n    Z_quad = np.sum(w_i / denominator) / np.sqrt(np.pi)\n    \n    # Compute C_quad and Gamma_quad\n    zeta_Z_quad = zeta * Z_quad\n    C_quad = A_quad * np.real(1.0 + zeta_Z_quad)\n    Gamma_quad = A_quad * np.imag(zeta_Z_quad)\n    \n    return C_quad, Gamma_quad\n\ndef solve():\n    \"\"\"\n    Main function to run the convergence study for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, zeta, N_H, N_L, delta, tol)\n        (0.7, 1.0, 64, 64, 1e-7, 1e-6),\n        (5.0, 1.2, 8, 8, 5e-3, 2e-3),\n        (2.5, 0.8, 128, 128, 1e-8, 1e-7),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, zeta, N_H, N_L, delta, tol = case\n        \n        # Compute exact values\n        C_exact, Gamma_exact = compute_exact_values(a, zeta)\n        \n        # Compute quadrature-approximated values\n        C_quad, Gamma_quad = compute_quad_values(a, zeta, N_L, N_H, delta)\n        \n        # Calculate relative errors\n        # Use max with a small number to avoid division by zero\n        err_C = np.abs(C_quad - C_exact) / np.maximum(np.abs(C_exact), 1e-30)\n        err_Gamma = np.abs(Gamma_quad - Gamma_exact) / np.maximum(np.abs(Gamma_exact), 1e-30)\n        \n        # Perform pass/fail check\n        passes = (err_C  tol) and (err_Gamma  tol)\n        results.append(passes)\n\n    # Final print statement in the exact required format.\n    # The output format requires lowercase 'true'/'false'.\n    print(f\"[{','.join(map(str, results)).lower()}]\")\n\nsolve()\n```"
        }
    ]
}