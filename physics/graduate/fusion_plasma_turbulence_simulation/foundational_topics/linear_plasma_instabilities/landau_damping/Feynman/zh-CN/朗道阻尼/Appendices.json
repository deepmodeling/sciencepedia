{
    "hands_on_practices": [
        {
            "introduction": "为了深刻理解朗道阻尼，一个有效的方法是探究其发生条件不被满足时的情形。 这个练习使用“水袋”分布，这是一个简化的模型，它不像真实的麦克斯韦分布那样具有粒子填充的“尾部”。通过这个练习，你将亲手证明，在没有共振粒子的情况下，阻尼便会消失，从而凸显了波-粒共振的核心作用。",
            "id": "4000814",
            "problem": "考虑一个无磁化、一维、静电的电子等离子体，这是计算聚变科学与工程中核心区湍流建模的代表性模型。电子遵循关于空间均匀平衡态的线性化Vlasov–Poisson方程组，该平衡态的数密度为$n_{e}$，速度分布函数为$f_{0}(v)$，归一化条件为$\\int_{-\\infty}^{\\infty} f_{0}(v)\\, dv = 1$。假设单电荷离子提供一个固定的中性化背景。设扰动正比于$\\exp(i k x - i \\omega t)$，其中波数$k$为实数，频率$\\omega$为复数。\n\n平衡电子分布是一个有限宽度的水袋（顶帽）分布，\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},  |v| \\le \\Delta, \\\\\n0,  |v|  \\Delta,\n\\end{cases}\n$$\n其常数半宽为$\\Delta  0$。\n\n从第一性原理出发，即电子的线性化Vlasov方程和Poisson方程，\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} - \\frac{e}{m_{e}} E \\frac{\\partial f}{\\partial v} = 0, \\qquad \\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right),\n$$\n推导标准介电形式的色散关系，并计算水袋分布下电子等离子体波的Landau阻尼率$\\gamma$。在复$\\omega$平面上使用Landau围道规则进行解析延拓。用$\\mathrm{s}^{-1}$单位表示阻尼率的最终答案。\n\n此外，基于您的推导，解释水袋分布中指数尾的缺失如何相对于麦克斯韦平衡态改变了共振贡献。您的解释必须基于$f_{0}(v)$的速度空间导数的结构以及速度积分的解析性质。\n\n如果您的最终数值结果需要四舍五入，请将答案保留四位有效数字。如果您的最终结果是精确的闭合形式解析表达式，请无需四舍五入，精确提供。",
            "solution": "问题陈述经过严格评估，被认为是有效的。它提出了一个在等离子体动理学理论中适定且有科学依据的问题。起初，要求以$\\mathrm{s}^{-1}$为单位提供数值答案，却没有提供等离子体参数（$n_e$, $\\Delta$）或波参数（$k$）的数值，这表明问题可能是不完整的。然而，完整的推导表明，对于指定的水袋分布，Landau阻尼率恰好为零，这一结果不依赖于任何具体的参数值。因此，该问题是自洽的，并且可以按所述方式求解。\n\n该问题要求推导色散关系，并计算在具有水袋平衡分布函数的无磁化等离子体中电子等离子体波的Landau阻尼率。\n\n出发点是电子的线性化Vlasov方程和Poisson方程。离子背景是固定且中性的。\n围绕平衡态$f_0(v)$线性化的扰动电子分布函数$f_1(x, v, t)$的Vlasov方程为：\n$$\n\\frac{\\partial f_1}{\\partial t} + v \\frac{\\partial f_1}{\\partial x} - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\n其中$E_1(x,t)$是扰动电场，$e$是元电荷，$m_e$是电子质量。我们假设扰动形式为$\\exp(i k x - i \\omega t)$，其中$k$是实波数，$\\omega = \\omega_r + i\\gamma$是复频率。将此形式代入线性化Vlasov方程得到：\n$$\n-i\\omega f_1 + ikv f_1 - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\n求解扰动分布函数$f_1$得到：\n$$\nf_1(v) = \\frac{e E_1}{m_{e}} \\frac{1}{i(kv - \\omega)} \\frac{d f_{0}}{d v} = -i \\frac{e E_1}{m_{e}} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v}\n$$\n接下来，我们使用Poisson方程。问题陈述给出$\\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right)$。总分布函数为$f = f_0 + f_1$。为保持电中性，离子密度$n_i$是常数，且等于平衡电子密度$n_e$。扰动电子密度为$n_{e1} = n_e \\int_{-\\infty}^{\\infty} f_1(v) dv$。\n线性化的Poisson方程变为：\n$$\n\\frac{\\partial E_1}{\\partial x} = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\n应用平面波形式$E_1 \\propto \\exp(ikx - i\\omega t)$，方程变为：\n$$\nik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\n假设存在非平凡的波模（$E_1 \\neq 0$），我们代入$f_1(v)$的表达式：\n$$\nik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} \\left( -i \\frac{e E_1}{m_{e}} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} \\right) dv\n$$\n消去两边的公因子$i E_1$并引入电子等离子体频率$\\omega_p^2 = \\frac{n_e e^2}{m_e \\epsilon_0}$得到：\n$$\nk = \\omega_p^2 \\int_{-\\infty}^{\\infty} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} dv\n$$\n速度积分必须使用Landau围道规则来解释。为了得到标准形式，我们将方程重写为：\n$$\n1 = \\frac{\\omega_p^2}{k} \\int_{L} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} dv = \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{\\omega/k - v} dv\n$$\n其中$L$表示Landau围道，$f_0'(v) = \\frac{d f_{0}}{d v}$。这等价于静电介电函数$\\epsilon(\\omega, k) = 0$，其中\n$$\n\\epsilon(\\omega, k) = 1 - \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{v - \\omega/k} dv\n$$\n现在我们将此应用于特定的水袋分布：\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},  |v| \\le \\Delta, \\\\\n0,  |v|  \\Delta.\n\\end{cases}\n$$\n该函数的导数用Dirac delta函数表示为：\n$$\nf_0'(v) = \\frac{d}{dv} \\left( \\frac{1}{2\\Delta} [H(v+\\Delta) - H(v-\\Delta)] \\right) = \\frac{1}{2\\Delta} [\\delta(v+\\Delta) - \\delta(v-\\Delta)]\n$$\n其中$H(v)$是亥维赛阶跃函数。\n我们将该导数代入色散关系的速度积分中。令$u = \\omega/k$。\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\int_{-\\infty}^{\\infty} \\frac{1}{2\\Delta} \\frac{\\delta(v+\\Delta) - \\delta(v-\\Delta)}{v - u} dv\n$$\n使用delta函数的筛选性质，$\\int g(x) \\delta(x-a) dx = g(a)$：\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\frac{1}{2\\Delta} \\left( \\frac{1}{-\\Delta - u} - \\frac{1}{\\Delta - u} \\right) = \\frac{1}{2\\Delta} \\left( \\frac{-1}{\\Delta + u} - \\frac{1}{\\Delta - u} \\right)\n$$\n$$\n= \\frac{1}{2\\Delta} \\frac{-(\\Delta - u) - (\\Delta + u)}{(\\Delta+u)(\\Delta-u)} = \\frac{1}{2\\Delta} \\frac{-2\\Delta}{\\Delta^2 - u^2} = \\frac{1}{u^2 - \\Delta^2}\n$$\n该结果对于任何复数$u$都有效，只要$u \\neq \\pm \\Delta$。该积分是$u$的解析函数，除了在$u=\\pm \\Delta$处有简单极点。Landau围道规则是平凡满足的，因为除非$u$是实数且等于$\\pm \\Delta$，否则被积函数在实轴上没有奇点。\n\n将此结果代回色散关系$\\epsilon(\\omega, k) = 0$中：\n$$\n1 - \\frac{\\omega_p^2}{k^2} \\left( \\frac{1}{(\\omega/k)^2 - \\Delta^2} \\right) = 0\n$$\n$$\n1 = \\frac{\\omega_p^2}{k^2} \\frac{1}{\\omega^2/k^2 - \\Delta^2} = \\frac{\\omega_p^2}{\\omega^2 - k^2\\Delta^2}\n$$\n求解$\\omega^2$：\n$$\n\\omega^2 - k^2\\Delta^2 = \\omega_p^2\n$$\n$$\n\\omega^2 = \\omega_p^2 + k^2\\Delta^2\n$$\n由于$\\omega_p^2  0$，$k^2 \\ge 0$和$\\Delta^2  0$，右侧是一个正实数。因此，复频率$\\omega$由下式给出：\n$$\n\\omega = \\pm \\sqrt{\\omega_p^2 + k^2\\Delta^2}\n$$\n频率$\\omega$是纯实数。阻尼率$\\gamma$定义为频率的虚部，$\\gamma = \\Im(\\omega)$。\n从我们的结果可以明显看出，对于任何实波数$k$：\n$$\n\\gamma = 0\n$$\n因此，在具有水袋分布的等离子体中，电子等离子体波是无阻尼的。结果是$0 \\ \\mathrm{s}^{-1}$。\n\n无阻尼现象可以通过分析共振条件和$f_0'(v)$的结构来解释。Landau阻尼源于波与以波相速$v_{ph} = \\Re(\\omega)/k = \\omega_r/k$或接近该速度运动的粒子之间的净能量交换。这种能量交换的速率与分布函数在相速处的斜率$f_0'(v_{ph})$成正比。\n\n对于水袋分布，波的相速为：\n$$\n|v_{ph}| = \\frac{|\\omega_r|}{k} = \\frac{\\sqrt{\\omega_p^2 + k^2\\Delta^2}}{k} = \\sqrt{\\frac{\\omega_p^2}{k^2} + \\Delta^2}\n$$\n由于$\\omega_p^2/k^2  0$，显然有$|v_{ph}|  \\Delta$。\n水袋分布具有有限宽度，这意味着没有速度$|v|  \\Delta$的粒子。其导数$f_0'(v)$仅在精确的速度$v = \\pm\\Delta$处非零。由于波的相速$|v_{ph}|$严格大于$\\Delta$，它不与$f_0'(v)$非零的速度重合。更重要的是，在$v=v_{ph}$处没有粒子与波发生共振。这就是没有Landau阻尼的物理原因。\n\n相比之下，对于麦克斯韦平衡分布，$f_M(v) \\propto \\exp(-v^2/v_{th}^2)$，该函数及其导数对所有速度都非零。麦克斯韦分布具有“指数尾”，这意味着在任何速度下，无论多高，都存在少量但有限的粒子布居。当电子等离子体波传播时，其相速$v_{ph}$通常大于热速度$v_{th}$，但由于存在指数尾，总有速度$v \\approx v_{ph}$的粒子存在。导数$f_M'(v_{ph})$是非零的（对于$v_{ph}  0$为负），导致能量从波净转移到粒子，从而产生波阻尼。\n\n在数学上，差异在于速度积分的解析性质。\n对于水袋分布，$f_0(v)$的紧支集导致色散关系是$\\omega^2$的一个简单的代数（有理）函数。$\\omega$的解是这个代数方程的根，结果是纯实数。\n对于麦克斯韦分布，$f_0(v)$的无限支集导致色散函数涉及超越的等离子体色散函数$Z(\\zeta)$，其中$\\zeta = \\omega/(k v_{th}\\sqrt{2})$。对于实数宗量，该函数是复数，这从根本上为任何实数$k$的频率$\\omega$引入了虚部。这个数学特征反映了在所有速度上都存在连续的共振粒子的物理事实。水袋分布中指数尾的缺失有效地消除了导致Landau阻尼的数学结构。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在研究了理想化的水袋分布案例之后，我们转向更符合实际的麦克斯韦等离子体。在这种情况下，色散关系变成了超越方程，无法解析求解。 这个实践将要求你运用数值求根技术来计算阻尼率，并探究计算结果对数值误差的敏感性，这是计算科学中的一项关键技能。",
            "id": "4000841",
            "problem": "考虑一个无磁化、无碰撞的均匀电子等离子体，其具有麦克斯韦平衡电子分布和固定的离子。从线性化的弗拉索夫-泊松系统出发，电子极化率可以用等离子体色散函数来表示。设平衡电子分布是各向同性的麦克斯韦分布，其电子热速度为 $v_{\\mathrm{th}} = \\sqrt{2 k_{\\mathrm{B}} T_{e}/m_{e}}$，电子等离子体频率为 $\\omega_{\\mathrm{pe}} = \\sqrt{n_{e} e^{2}/(\\varepsilon_{0} m_{e})}$，德拜长度为 $\\lambda_{\\mathrm{D}} = \\sqrt{\\varepsilon_{0} k_{\\mathrm{B}} T_{e}/(n_{e} e^{2})}$。注意关系式 $v_{\\mathrm{th}} = \\sqrt{2}\\,\\lambda_{\\mathrm{D}}\\,\\omega_{\\mathrm{pe}}$。定义无量纲波数 $\\hat{k} = k v_{\\mathrm{th}}/\\omega_{\\mathrm{pe}}$ 和无量纲复频率 $\\hat{\\omega} = \\omega/\\omega_{\\mathrm{pe}}$。静电电子介电函数为\n$$\n\\varepsilon(\\omega, k) = 1 + \\chi_{e}(\\omega, k), \\quad \\chi_{e}(\\omega, k) = \\frac{\\omega_{\\mathrm{pe}}^{2}}{k^{2} v_{\\mathrm{th}}^{2}} \\left[ 1 + \\xi\\, Z(\\xi) \\right],\n$$\n其中 $\\xi = \\omega/(k v_{\\mathrm{th}})$，$Z(\\xi)$ 是等离子体色散函数。朗道阻尼的朗缪尔波对应于满足 $\\varepsilon(\\omega, k) = 0$ 且 $\\operatorname{Im}(\\omega)  0$ 的复数根 $\\omega$。归一化到电子等离子体频率的朗道阻尼率是一个无量纲量 $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$，它没有单位。\n\n你的任务是实现一个数值求解器，该求解器能够：\n- 使用恒等式 $Z(\\xi) = i \\sqrt{\\pi}\\, w(\\xi)$，通过法捷耶娃函数 $w(z)$ 来表示 $Z(\\xi)$，其中 $w(z) = e^{-z^{2}} \\operatorname{erfc}(-i z)$。\n- 求解归一化介电函数的复数根 $\\hat{\\omega}$\n$$\n\\varepsilon(\\hat{\\omega}, \\hat{k}) = 1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, Z(\\hat{\\xi}) \\right] = 0, \\quad \\hat{\\xi} = \\frac{\\hat{\\omega}}{\\hat{k}},\n$$\n通过对 $\\varepsilon$ 的实部和虚部使用二维非线性求根方法。\n- 计算并返回 $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$。\n\n此外，通过引入形式为 $Z_{\\epsilon}(\\xi) = (1 + \\epsilon)\\, Z(\\xi)$ 的可控乘性微扰，并针对几个不同的 $\\epsilon$ 值重新计算阻尼率，来量化 $\\gamma/\\omega_{\\mathrm{pe}}$ 对 $Z(\\xi)$ 中数值误差的灵敏度。这模拟了在评估 $Z(\\xi)$ 时的相对数值误差。\n\n实现你的程序以评估并输出以下测试套件：\n- 情况1（正常路径）：$k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 0.0$。\n- 情况2（接近机器精度的微扰）：$k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-8}$。\n- 情况3（小微扰）：$k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-5}$。\n- 情况4（中等微扰）：$k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-3}$。\n- 情况5（$k \\lambda_{\\mathrm{D}}$ 的边界值）：$k \\lambda_{\\mathrm{D}} = 0.05$, $\\epsilon = 0.0$。\n- 情况6（$k \\lambda_{\\mathrm{D}}$ 的边缘值）：$k \\lambda_{\\mathrm{D}} = 0.5$, $\\epsilon = 0.0$。\n\n使用归一化关系 $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$，并为每种情况返回 $\\gamma/\\omega_{\\mathrm{pe}}$ 的数值。由于输出是无量纲的，因此不需要物理单位。\n\n最终输出格式要求：你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3]”）。每个结果必须是与上述情况对应的单个浮点数 $\\gamma/\\omega_{\\mathrm{pe}}$，并按给定顺序排列。",
            "solution": "该问题要求在一个具有麦克斯韦电子分布的无磁化、无碰撞等离子体中，数值计算电子等离子体波的朗道阻尼率。解决方案涉及寻找静电介电函数的复数根。这将通过实现一个数值求根算法来完成。此外，还将进行灵敏度分析，以量化等离子体色散函数中的数值误差对计算出的阻尼率的影响。\n\n需要求解的基本方程是色散关系，由 $\\varepsilon(\\omega, k) = 0$ 给出，其中 $\\varepsilon$ 是介电函数。对于指定的等离子体条件，该方程的归一化形式为：\n$$\n\\varepsilon(\\hat{\\omega}, \\hat{k}) = 1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, Z(\\hat{\\xi}) \\right] = 0\n$$\n此处，$\\hat{\\omega} = \\omega/\\omega_{\\mathrm{pe}}$ 是归一化到电子等离子体频率的复数波频率，$\\hat{k} = k v_{\\mathrm{th}}/\\omega_{\\mathrm{pe}}$ 是使用电子热速度 $v_{\\mathrm{th}}$ 归一化的波数，而 $\\hat{\\xi} = \\hat{\\omega}/\\hat{k}$ 是它们的比值。函数 $Z(\\hat{\\xi})$ 是等离子体色散函数。阻尼率由频率根虚部的负值给出，即 $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$。问题还指定了归一化关系 $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$，其中 $\\lambda_{\\mathrm{D}}$ 是电子德拜长度。\n\n任务是为给定的 $\\hat{k}$ 值找到复数根 $\\hat{\\omega} = \\hat{\\omega}_r + i \\hat{\\omega}_i$。这等价于求解一个关于两个实变量 $\\hat{\\omega}_r$ 和 $\\hat{\\omega}_i$ 的耦合非线性实数方程组：\n$$\n\\operatorname{Re}\\left[ \\varepsilon(\\hat{\\omega}_r + i\\hat{\\omega}_i, \\hat{k}) \\right] = 0\n$$\n$$\n\\operatorname{Im}\\left[ \\varepsilon(\\hat{\\omega}_r + i\\hat{\\omega}_i, \\hat{k}) \\right] = 0\n$$\n为了评估介电函数，我们必须计算等离子体色散函数 $Z(\\xi)$。问题提供了关系式 $Z(\\xi) = i \\sqrt{\\pi}\\, w(\\xi)$，其中 $w(\\xi) = e^{-\\xi^{2}} \\operatorname{erfc}(-i \\xi)$ 是法捷耶娃函数。SciPy 库中提供了 $w(\\xi)$ 的一个稳健的数值实现，即 `scipy.special.wofz`。\n\n需要一个数值求根算法来求解该系统。`scipy.optimize.root` 函数非常适合此目的。它需要一个解向量 $(\\hat{\\omega}_r, \\hat{\\omega}_i)$ 的初始猜测值。一个有物理依据的初始猜测值能显著提高收敛到正确根（前向传播的阻尼朗缪尔波）的可能性。在长波极限 ($k \\lambda_{\\mathrm{D}} \\ll 1$)下，频率的实部可以很好地用玻姆-格罗斯色散关系近似，即 $\\omega^2 \\approx \\omega_{\\mathrm{pe}}^2 + 3 k^2 v_{\\text{th,rms}}^2$。使用问题中的定义 $v_{\\mathrm{th}} = \\sqrt{2} v_{\\text{th,rms}}$，该关系式变为 $\\omega^2 \\approx \\omega_{pe}^2 + \\frac{3}{2} k^2 v_{\\mathrm{th}}^2$。在归一化单位下，这为实部提供了一个极好的初始猜测值：\n$$\n\\hat{\\omega}_r \\approx \\sqrt{1 + \\frac{3}{2} \\hat{k}^2}\n$$\n对于虚部，已知朗道阻尼在 $\\hat{k}$ 较小时很弱，这意味着 $\\hat{\\omega}_i$ 是一个小的负数。一个合理的初始猜测值，如 $\\hat{\\omega}_i = -0.01$，足以引导求解器找到阻尼根 ($\\operatorname{Im}(\\omega)  0$）。\n\n通过向等离子体色散函数中引入一个可控的乘性微扰 $\\epsilon$，定义一个微扰函数 $Z_{\\epsilon}(\\xi) = (1 + \\epsilon)\\, Z(\\xi)$，来进行灵敏度分析。然后使用这个微扰函数重新求解色散关系：\n$$\n1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, (1 + \\epsilon)Z(\\hat{\\xi}) \\right] = 0\n$$\n通过求解不同小 $\\epsilon$ 值下的 $\\hat{\\omega}$，我们可以观察到阻尼率 $\\gamma/\\omega_{\\mathrm{pe}}$ 的相应变化。\n\n整个算法流程如下：\n1.  对于每个由 $(k \\lambda_{\\mathrm{D}}, \\epsilon)$ 定义的测试用例：\n2.  计算归一化波数 $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$。\n3.  使用玻姆-格罗斯关系和一个小的负虚部，为根 $(\\hat{\\omega}_r, \\hat{\\omega}_i)$ 建立一个初始猜测值。\n4.  定义一个目标函数，该函数接受一个向量 $(\\hat{\\omega}_r, \\hat{\\omega}_i)$ 并返回介电函数 $\\varepsilon(\\hat{\\omega}, \\hat{k})$ 的实部和虚部，同时包含微扰 $\\epsilon$。\n5.  调用 `scipy.optimize.root` 求解器找到根 $(\\hat{\\omega}_{r, \\text{sol}}, \\hat{\\omega}_{i, \\text{sol}})$。\n6.  朗道阻尼率则为 $\\gamma/\\omega_{\\mathrm{pe}} = -\\hat{\\omega}_{i, \\text{sol}}$。\n7.  收集所有测试用例的结果，并将其格式化为指定的输出字符串。这个分步过程在提供的 Python 代码中得以实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import wofz\nfrom scipy.optimize import root\n\ndef dielectric_system_for_solver(omega_vec, k_hat, epsilon):\n    \"\"\"\n    Represents the system of equations Re(epsilon)=0, Im(epsilon)=0.\n\n    Args:\n        omega_vec (list-like): A list or array [omega_r, omega_i] representing\n                               the real and imaginary parts of the normalized\n                               complex frequency omega_hat.\n        k_hat (float): The normalized wavenumber.\n        epsilon (float): The multiplicative perturbation for Z(xi).\n\n    Returns:\n        list: A list containing [Re(epsilon), Im(epsilon)].\n    \"\"\"\n    omega_hat = omega_vec[0] + 1j * omega_vec[1]\n\n    # The argument to the plasma dispersion function\n    xi_hat = omega_hat / k_hat\n\n    # Calculate Z(xi) using the Faddeeva function w(z) from SciPy.\n    # The relation is Z(xi) = i * sqrt(pi) * w(xi), where w(z) is computed by wofz.\n    w_val = wofz(xi_hat)\n    z_val = 1j * np.sqrt(np.pi) * w_val\n\n    # Apply the controlled multiplicative perturbation\n    z_perturbed = (1.0 + epsilon) * z_val\n\n    # Calculate the complex dielectric function epsilon(omega, k)\n    eps_val = 1.0 + (1.0 / k_hat**2) * (1.0 + xi_hat * z_perturbed)\n\n    # Return the real and imaginary parts for the 2D root finder\n    return [eps_val.real, eps_val.imag]\n\ndef solve():\n    \"\"\"\n    Main solver function to compute Landau damping rates for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (k * lambda_D, epsilon).\n    test_cases = [\n        (0.2, 0.0),\n        (0.2, 1e-8),\n        (0.2, 1e-5),\n        (0.2, 1e-3),\n        (0.05, 0.0),\n        (0.5, 0.0),\n    ]\n\n    results = []\n    \n    # A single reasonable initial guess for the imaginary part of omega_hat is sufficient\n    # for all cases. The damped root has Im(omega)  0.\n    omega_i_guess = -0.01\n\n    for k_lambda_d, epsilon in test_cases:\n        # Convert the given k*lambda_D to the normalized wavenumber k_hat\n        k_hat = np.sqrt(2.0) * k_lambda_d\n\n        # Calculate an initial guess for the real part of omega_hat using the\n        # Bohm-Gross dispersion relation in the appropriate normalization.\n        omega_r_guess = np.sqrt(1.0 + 1.5 * k_hat**2)\n\n        initial_guess = [omega_r_guess, omega_i_guess]\n\n        # Use scipy.optimize.root to find the solution.\n        # The 'args' parameter passes additional arguments to the target function.\n        # We use a tight tolerance for high accuracy.\n        solution = root(\n            dielectric_system_for_solver,\n            initial_guess,\n            args=(k_hat, epsilon),\n            tol=1e-13,\n            method='hybr' # Default and robust method\n        )\n\n        if not solution.success:\n            # This indicates the solver failed to converge. For these test cases,\n            # this is not expected. Append NaN as a failure indicator.\n            results.append(float('nan'))\n            continue\n\n        # The solution vector is solution.x = [omega_r, omega_i]\n        omega_i_solution = solution.x[1]\n\n        # The normalized damping rate is gamma/omega_pe = -Im(omega_hat)\n        damping_rate = -omega_i_solution\n        results.append(damping_rate)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在探索了色散关系的理论和数值解之后，最后的步骤是在一个完整的模拟中见证朗道阻尼的动力学过程。 这个练习将指导你构建一个弗拉索夫-泊松求解器，并实现一个专门的诊断工具，用以测量波与各速度粒子之间的能量交换。这将为朗道阻尼核心的共振相互作用提供直接的、可视化的证据。",
            "id": "4000790",
            "problem": "考虑一个无量纲单位下，具有固定离子的电子的一维单速度静电Vlasov–Poisson系统。设电子分布函数为 $f(x,v,t)$，电场为 $E(x,t)$，电子电荷为 $q=-1$，电子质量为 $m=1$。其控制方程为Vlasov方程和Poisson方程：\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\n在 $x$ 方向上具有周期性边界条件，且速度域被截断为 $v \\in [-v_{\\max}, v_{\\max}]$，其中 $v_{\\max}$ 的选择需足够大以至于 $f$ 在边界处可忽略不计。初始条件是麦克斯韦分布的一个弱扰动空间模式：\n$$\nf(x,v,0) = f_0(v)\\left[1 + \\alpha \\cos(k x)\\right], \\quad f_0(v) = \\frac{1}{\\sqrt{2\\pi} v_{\\mathrm{th}}}\\exp\\left(-\\frac{v^2}{2 v_{\\mathrm{th}}^2}\\right),\n$$\n其中 $k$ 是扰动的基本波数，$\\alpha$ 是扰动振幅，$v_{\\mathrm{th}}$ 是电子热速度。\n\n定义一个速度分辨的场-粒子关联诊断量，用于测量在每个速度上从场到粒子的时间平均能量传递密度：\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\n其中 $\\langle \\cdot \\rangle_{x,t}$ 表示在空间和模拟时间间隔上的平均。与朗道阻尼相关的共振速度 $v_{\\mathrm{res}}$ 被确定为使 $C(v)$ 达到其最大值时的速度 $v \\ge 0$。\n\n您的任务是为上述Vlasov–Poisson系统实现一个无量纲数值求解器，该求解器使用Strang分裂半拉格朗日格式，其中 $x$ 方向为周期性平流，$v$ 方向为线性插值平流，并与一个用于Poisson方程的傅里叶空间求解器耦合。然后实现场-粒子关联诊断量 $C(v)$，并针对每个指定的测试用例，计算并返回 $v_{\\mathrm{res}}$。\n\n使用以下域和离散化选择：\n- 空间域长度 $L = 2\\pi$，在 $x$ 方向上周期性。\n- 空间网格点数 $N_x = 64$。\n- 速度域 $v \\in [-v_{\\max}, v_{\\max}]$，其中 $v_{\\max} = 5$。\n- 速度网格点数 $N_v = 256$。\n- 时间步长 $\\Delta t = 0.05$。\n- 时间步数 $N_t = 300$。\n- 电子热速度 $v_{\\mathrm{th}} = 1$。\n\n为每个时间步 $n$ 实现Strang分裂：\n1. $v$方向半步：使用当前电场 $E^n(x)$，将 $f$ 沿 $v$-特征线平流 $\\Delta t/2$。\n2. $x$方向全步：使用粒子速度，将 $f$ 沿 $x$-特征线平流 $\\Delta t$，并采用周期性边界条件。\n3. 更新电场：从更新后的 $f$ 求解Poisson方程，得到 $E^{n+1}(x)$。\n4. $v$方向半步：使用 $E^{n+1}(x)$，将 $f$ 沿 $v$-特征线平流 $\\Delta t/2$。\n\n在每个完整时间步长，通过对 $x$ 进行平均并随时间累加，使用瞬时 $E(x,t)$ 和 $f(x,v,t)$ 来累积 $C(v)$，最后除以样本数以获得时间平均值。通过选择使 $C(v)$ 最大化的速度 $v \\ge 0$ 来确定 $v_{\\mathrm{res}}$。\n\n所有量均为无量纲。每个测试用例所需的输出是单个浮点数 $v_{\\mathrm{res}}$。程序必须处理以下参数值的测试套件：\n- 测试用例 1：$k = 1$，$\\alpha = 10^{-3}$。\n- 测试用例 2：$k = 2$，$\\alpha = 10^{-3}$。\n- 测试用例 3：$k = 3$，$\\alpha = 5 \\times 10^{-4}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_1,r_2,r_3]$），其中每个 $r_i$ 是为测试用例 $i$ 计算出的浮点数 $v_{\\mathrm{res}}$。",
            "solution": "问题的基础是静电Vlasov–Poisson系统，其一维单速度形式可写为\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\n其中 $q=-1$，$m=1$，且在 $x$ 方向上具有周期性边界条件。从第一性原理出发，Vlasov方程表示了沿运动特征线的相空间平流：粒子以速度 $v$ 在位置上平移，并根据加速度 $a = q E$ 在速度上平移。Poisson方程将电场的空间导数与净电荷密度关联起来，此处为恒定离子背景（归一化为1）与电子密度 $n_e(x,t) = \\int f(x,v,t)\\, dv$ 之差。\n\n电子动能密度 $W(x,t) = \\int \\frac{1}{2} m v^2 f(x,v,t)\\, dv$ 因电场而产生的变化率可以通过将Vlasov方程乘以 $\\frac{1}{2} m v^2$ 并对 $v$ 积分得到：\n$$\n\\frac{\\partial W}{\\partial t} = \\int \\frac{1}{2} m v^2 \\left[ - v \\frac{\\partial f}{\\partial x} - q E \\frac{\\partial f}{\\partial v} \\right] dv.\n$$\n空间平流项变为动能通量在 $x$ 方向上的散度，在周期性域中进行空间平均时，对净场-粒子能量交换率没有贡献。对于速度平流项，在 $v$ 方向上进行分部积分（假设在速度边界处 $f \\to 0$ 且 $m=1$）：\n$$\n\\int \\frac{1}{2} v^2 \\left(- q E \\frac{\\partial f}{\\partial v} \\right) dv = q E \\int v f \\, dv.\n$$\n因此，在位置 $x$ 处，从场到电子的瞬时能量传递密度率为\n$$\n\\dot{W}(x,t) = \\int q\\, E(x,t)\\, v\\, f(x,v,t)\\, dv.\n$$\n为了将此能量传递解析为速度的函数，定义速度分辨的场-粒子关联诊断量\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\n其中 $\\langle \\cdot \\rangle_{x,t}$ 表示在空间和模拟时间间隔上的平均。在波数为 $k$ 的单个静电模式发生朗道阻尼的情况下，共振能量交换局域在相速度 $v_\\phi \\approx \\omega/k$ 附近，其中 $\\omega$ 是模式的实频率。因此，对于 $v \\ge 0$，使 $C(v)$ 达到峰值的速度 $v$ 确定了对阻尼有贡献的共振速度：\n$$\nv_{\\mathrm{res}} = \\arg\\max_{v \\ge 0} \\, C(v).\n$$\n\n算法设计：\n- 将空间域 $x \\in [0,L)$ 离散化为 $N_x$ 个点，并采用周期性边界条件；将速度域 $v \\in [-v_{\\max}, v_{\\max}]$ 离散化为 $N_v$ 个点。\n- 将 $f(x,v,0)$ 初始化为具有热速度 $v_{\\mathrm{th}}$ 的弱扰动麦克斯韦分布 $f_0(v)\\left[1 + \\alpha \\cos(kx)\\right]$。\n- 使用Strang分裂法随时间推进 $f$：\n  - 速度半步平流：对于每个空间点 $x_i$，用 $a(x_i) = q E(x_i)$，将分布函数在 $v$ 方向上平移 $\\Delta v = a(x_i)\\, \\Delta t/2$，通过沿 $v$ 网格的半拉格朗日线性插值实现，边界索引采用截断方式处理。\n  - 空间全步平流：对于每个速度点 $v_j$，将分布函数在 $x$ 方向上平移 $\\Delta x = v_j\\, \\Delta t$，通过沿 $x$ 网格的半拉格朗日线性插值实现，并采用周期性卷绕（使用整数位移和线性分数插值）。\n  - 在傅里叶空间中求解Poisson方程：通过数值积分（离散求和乘以 $\\Delta v$）计算电子密度 $n_e(x) = \\int f(x,v)\\, dv$，形成电荷密度 $\\rho(x) = 1 - n_e(x)$，对其进行离散傅里叶变换得到 $\\hat{\\rho}(k_n)$，然后对于每个波数 $k_n$ 不为零的傅里叶模式，得到 $\\hat{E}(k_n) = - i\\, \\hat{\\rho}(k_n)/k_n$，再进行逆变换得到 $E(x)$；将 $\\hat{E}$ 的零模式设为零以强制周期性中性。\n  - 使用更新后的电场进行速度半步平流。\n- 在每个完整时间步长，通过计算每个速度上 $q\\, E(x,t)\\, v\\, f(x,v,t)$ 的空间平均值并随时间累加来累积关联 $C(v)$，最后除以样本数以获得时间平均值。\n- 通过找到使 $C(v)$ 最大化的速度 $v \\ge 0$ 来确定 $v_{\\mathrm{res}}$。\n\n数值细节：\n- 选择 $L = 2\\pi$，$N_x = 64$，$v_{\\max} = 5$，$N_v = 256$，$\\Delta t = 0.05$，$N_t = 300$，以及 $v_{\\mathrm{th}} = 1$。\n- 初始扰动使用 $k \\in \\{1,2,3\\}$，以与周期域的离散傅里叶模式对齐。\n- 使用小的 $\\alpha$（例如，$\\alpha = 10^{-3}$ 或 $\\alpha = 5 \\times 10^{-4}$）以保持在近似线性朗道阻尼的弱非线性区域。\n- 速度平流在边界附近使用截断插值；通过选择足够大的 $v_{\\max}$ 使得在所选的 $v_{\\mathrm{th}}$ 下 $f$ 在边界处可以忽略不计，从而最小化截断误差。\n\n测试套件和输出：\n- 测试用例 1：$k = 1$，$\\alpha = 10^{-3}$。\n- 测试用例 2：$k = 2$，$\\alpha = 10^{-3}$。\n- 测试用例 3：$k = 3$，$\\alpha = 5 \\times 10^{-4}$。\n对于每个测试用例，计算 $C(v)$ 并返回浮点数 $v_{\\mathrm{res}}$。程序必须打印单行输出，其中包含一个用方括号括起来的三个结果的逗号分隔列表，例如 $[r_1,r_2,r_3]$。\n\n该方法严格遵循基本的Vlasov–Poisson动力学，从动能方程推导出速度分辨的能量传递诊断量，并实现了一种稳健的半拉格朗日数值方法，适用于捕捉朗道阻尼并通过关联 $C(v)$ 识别共振速度。",
            "answer": "```python\nimport numpy as np\n\n# Vlasov-Poisson 1D1V solver with field–particle correlation diagnostic\n# Dimensionless units: q = -1, m = 1, L = 2*pi, v_th = 1\n\ndef maxwellian(v, v_th):\n    return (1.0 / (np.sqrt(2.0 * np.pi) * v_th)) * np.exp(-0.5 * (v / v_th) ** 2)\n\ndef solve_poisson(ne, dx, L):\n    # Solve dE/dx = 1 - ne using FFT with periodic boundary conditions\n    rho = 1.0 - ne  # Charge density (ions = 1)\n    rho_k = np.fft.fft(rho)\n    kfreq = np.fft.fftfreq(ne.size, d=dx)  # cycles per unit length\n    k = 2.0 * np.pi * kfreq  # angular wavenumbers\n    E_k = np.zeros_like(rho_k, dtype=np.complex128)\n    nonzero = k != 0.0\n    E_k[nonzero] = -1j * rho_k[nonzero] / k[nonzero]\n    E_k[~nonzero] = 0.0 + 0.0j  # enforce neutrality\n    E = np.fft.ifft(E_k).real\n    return E\n\ndef advect_x(f, vgrid, dt, dx):\n    # Semi-Lagrangian advection in x with periodic boundary\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    for j in range(Nv):\n        s = vgrid[j] * dt / dx\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        # Linear interpolation between shifted fields\n        out[:, j] = (1.0 - a) * np.roll(f[:, j], n) + a * np.roll(f[:, j], n + 1)\n    return out\n\ndef advect_v(f, E, dt, dv):\n    # Semi-Lagrangian advection in v with clamped boundary indices\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    j = np.arange(Nv)\n    for i in range(Nx):\n        s = (-E[i]) * dt / dv  # dv/dt = qE/m = -E\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        j0 = j - n\n        j1 = j - n - 1\n        j0 = np.clip(j0, 0, Nv - 1)\n        j1 = np.clip(j1, 0, Nv - 1)\n        out[i, :] = (1.0 - a) * f[i, j0] + a * f[i, j1]\n    return out\n\ndef run_case(k_mode, alpha, params):\n    # Unpack parameters\n    L = params['L']\n    Nx = params['Nx']\n    Nv = params['Nv']\n    vmax = params['vmax']\n    dt = params['dt']\n    Nt = params['Nt']\n    v_th = params['v_th']\n    q = -1.0\n\n    # Grids\n    x = np.linspace(0.0, L, Nx, endpoint=False)\n    v = np.linspace(-vmax, vmax, Nv)\n    dx = x[1] - x[0]\n    dv = v[1] - v[0]\n\n    # Initial distribution: weakly perturbed Maxwellian\n    f0 = maxwellian(v, v_th)  # shape (Nv,)\n    f = f0[None, :] * (1.0 + alpha * np.cos(k_mode * x)[:, None])  # shape (Nx, Nv)\n\n    # Initial field from Poisson\n    ne = np.sum(f, axis=1) * dv\n    E = solve_poisson(ne, dx, L)\n\n    # Correlation accumulator C(v)\n    C = np.zeros(Nv)\n\n    # Time loop with Strang splitting\n    for _ in range(Nt):\n        # Half-step in v\n        f = advect_v(f, E, dt * 0.5, dv)\n        # Full-step in x\n        f = advect_x(f, v, dt, dx)\n        # Update field\n        ne = np.sum(f, axis=1) * dv\n        E = solve_poisson(ne, dx, L)\n        # Half-step in v with updated field\n        f = advect_v(f, E, dt * 0.5, dv)\n\n        # Accumulate correlation C(v) =  q E v f >_{x}\n        Ef = (E[:, None] * f)  # shape (Nx, Nv)\n        C += q * v * (Ef.mean(axis=0))\n\n    # Time-average\n    C /= Nt\n\n    # Identify resonant velocity v_res for v >= 0 as location of maximum C(v)\n    pos_mask = v >= 0.0\n    v_pos = v[pos_mask]\n    C_pos = C[pos_mask]\n    idx = int(np.argmax(C_pos))\n    v_res = float(v_pos[idx])\n    return v_res\n\ndef solve():\n    # Simulation parameters\n    params = {\n        'L': 2.0 * np.pi,\n        'Nx': 64,\n        'Nv': 256,\n        'vmax': 5.0,\n        'dt': 0.05,\n        'Nt': 300,\n        'v_th': 1.0,\n    }\n\n    # Test cases: (k, alpha)\n    test_cases = [\n        (1, 1e-3),\n        (2, 1e-3),\n        (3, 5e-4),\n    ]\n\n    results = []\n    for k_mode, alpha in test_cases:\n        v_res = run_case(k_mode, alpha, params)\n        results.append(v_res)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}