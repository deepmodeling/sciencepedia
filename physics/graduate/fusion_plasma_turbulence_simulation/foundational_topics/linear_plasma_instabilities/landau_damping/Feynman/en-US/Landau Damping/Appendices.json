{
    "hands_on_practices": [
        {
            "introduction": "Before delving into damping, it is instructive to explore the opposite phenomenon: kinetic instability. This exercise uses the Penrose criterion to determine the stability threshold for a two-stream plasma, a classic model for counter-propagating particle beams. By analyzing how the shape of the velocity distribution function changes with beam velocity, you will discover the precise conditions under which a wave can draw energy from the particles and grow, providing a crucial insight into why a simple Maxwellian distribution, which lacks these features, leads to damping instead of growth. ",
            "id": "4000840",
            "problem": "Consider a one-dimensional, collisionless, unmagnetized electron plasma with immobile ions providing neutralizing background. Let the unperturbed electron velocity distribution function be modeled as the superposition of two equal-density drifting Maxwellians (a symmetric two-stream state) with common temperature and opposite drift speeds, given by\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right],\n$$\nwhere $n_{e}$ is the electron number density, $U$ is the magnitude of the drift speed of each stream, and $v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$ is the thermal speed associated with electron temperature $T_{e}$ and electron mass $m_{e}$, with $k_{B}$ the Boltzmann constant.\n\nStarting from the linear electrostatic response of the Vlasov–Poisson system and using the Penrose criterion, determine the exact threshold value of the ratio $U / v_{th}$ that separates stable from unstable behavior. Specifically, find the critical value $U_{c}$ such that for some real wavenumber $k$ there exist unstable electrostatic modes if and only if $U  U_{c}$, and there are no unstable modes for $U \\le U_{c}$. Express your final answer as a single closed-form analytic expression for the dimensionless ratio $U_{c} / v_{th}$. No numerical rounding is required, and your answer must be dimensionless.",
            "solution": "The user wants to find the threshold for two-stream instability in a one-dimensional, collisionless, unmagnetized electron plasma.\n\n### Step 1: Problem Validation\n\nThe problem is subjected to a rigorous validation process before any attempt at a solution.\n\n#### Step 1.1: Extract Givens\n- **System:** A one-dimensional, collisionless, unmagnetized electron plasma with immobile positive ions providing a neutralizing background.\n- **Unperturbed Electron Velocity Distribution Function:**\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n- **Variable Definitions:**\n  - $n_{e}$: electron number density\n  - $v$: electron velocity\n  - $U$: magnitude of the drift speed of each electron stream\n  - $v_{th}$: electron thermal speed, defined as $v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$\n  - $T_{e}$: electron temperature\n  - $m_{e}$: electron mass\n  - $k_{B}$: Boltzmann constant\n- **Methodology:** The analysis is to be based on the linear electrostatic response of the Vlasov–Poisson system, using the Penrose criterion.\n- **Objective:** Determine the exact critical value $U_{c}$ of the drift speed $U$ such that unstable electrostatic modes exist if and only if $U  U_{c}$. The final answer must be the dimensionless ratio $U_{c} / v_{th}$.\n\n#### Step 1.2: Validate Using Extracted Givens\n1.  **Scientific Groundedness:** The problem describes the classic two-stream instability, a fundamental concept in plasma kinetic theory. The Vlasov–Poisson system is the standard model for this phenomenon, and the Penrose criterion is the correct and rigorous tool for determining the onset of kinetic instability. The provided distribution function is a standard representation of a symmetric two-stream system. The problem is scientifically sound.\n2.  **Well-Posedness:** The problem is well-posed. It provides a specific, well-behaved distribution function and asks for a uniquely defined stability threshold. All parameters are clearly defined.\n3.  **Objectivity:** The problem is stated in precise, objective, and standard scientific language, free from ambiguity or subjective claims.\n\n#### Step 1.3: Verdict and Action\nThe problem is found to be valid as it is scientifically grounded, well-posed, and objective. There are no contradictions, missing information, or violations of physical principles. Therefore, I will proceed with a full derivation of the solution.\n\n### Step 2: Derivation of the Solution\n\nThe stability of the plasma is governed by the Penrose criterion, which is derived from the linear Vlasov-Poisson dispersion relation. The criterion states that an instability exists (i.e., there is a solution to the dispersion relation with $\\text{Im}(\\omega)  0$ for some real wavenumber $k$) if and only if the distribution function $f_0(v)$ has a local minimum at some velocity $v=v_m$ such that the Penrose integral is positive:\n$$\n\\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{f_0'(v)}{v - v_m} dv  0\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value. A simpler, sufficient condition for instability is the mere existence of a local minimum in the velocity distribution function $f_0(v)$. For the symmetric two-stream distribution, this condition is found to be both necessary and sufficient.\n\nWe will therefore find the condition under which the given distribution function $f_0(v)$ develops a local minimum.\nThe distribution function is:\n$$\nf_{0}(v) = C \\left[ \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\nwhere $C = \\frac{n_{e}}{2 \\sqrt{\\pi} v_{th}}$ is a positive constant.\n\nThis function is symmetric with respect to $v=0$, i.e., $f_0(v) = f_0(-v)$. An extremum will occur where the first derivative is zero, $\\frac{df_0}{dv} = 0$.\nThe first derivative of $f_0(v)$ with respect to $v$ is:\n$$\n\\frac{df_0}{dv} = C \\left[ \\left( -\\frac{2(v - U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\left( -\\frac{2(v + U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\frac{df_0}{dv} = -\\frac{2C}{v_{th}^{2}} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\nWe test for an extremum at $v=0$. Evaluating the derivative at $v=0$:\n$$\n\\left. \\frac{df_0}{dv} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ (-U) \\exp\\left( - \\frac{(-U)^{2}}{v_{th}^{2}} \\right) + (U) \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) \\right] = -\\frac{2C}{v_{th}^{2}} [ -U + U ] \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) = 0\n$$\nThus, $v=0$ is always an extremum of the distribution function. To determine whether it is a local minimum or a local maximum, we must examine the sign of the second derivative, $\\frac{d^2f_0}{dv^2}$, at $v=0$. A positive sign indicates a local minimum (instability), while a negative sign indicates a local maximum (stability). The transition between stability and instability occurs at the critical point where the extremum becomes a flat inflection point, i.e., $\\frac{d^2f_0}{dv^2}|_{v=0} = 0$.\n\nWe compute the second derivative of $f_0(v)$:\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\frac{d}{dv} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\nUsing the product rule, the derivative of a term like $(v-a) \\exp(-(v-a)^2/b^2)$ is $\\left[1 - \\frac{2(v-a)^2}{b^2}\\right] \\exp(-(v-a)^2/b^2)$. Applying this, we get:\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(v - U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v - U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(v + U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v + U)^2}{v_{th}^{2}} \\right) \\right]\n$$\nNow, we evaluate this expression at the extremum $v=0$:\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(-U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(-U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ 2 \\left(1 - \\frac{2U^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\left(1 - \\frac{2U^2}{v_{th}^2}\\right)\n$$\nAn instability exists if $v=0$ is a local minimum, which requires $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0}  0$. The factor $-\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right)$ is always negative. Therefore, the condition for instability becomes:\n$$\n1 - \\frac{2U^2}{v_{th}^2}  0 \\implies 1  \\frac{2U^2}{v_{th}^2} \\implies U^2  \\frac{v_{th}^2}{2} \\implies U  \\frac{v_{th}}{\\sqrt{2}}\n$$\nConversely, the system is stable if $v=0$ is a local maximum, which requires $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0}  0$. This leads to:\n$$\n1 - \\frac{2U^2}{v_{th}^2}  0 \\implies U  \\frac{v_{th}}{\\sqrt{2}}\n$$\nThe critical threshold $U_c$ that separates the stable and unstable regimes is the value of $U$ for which the second derivative is zero. This marks the transition from a single-peaked distribution (stable) to a double-peaked distribution with a minimum at $v=0$ (unstable).\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = 0 \\implies 1 - \\frac{2U_c^2}{v_{th}^2} = 0\n$$\nSolving for $U_c$:\n$$\n\\frac{2U_c^2}{v_{th}^2} = 1 \\implies U_c^2 = \\frac{v_{th}^2}{2}\n$$\nSince $U_c$ is a speed magnitude, it must be non-negative. Taking the positive square root:\n$$\nU_c = \\frac{v_{th}}{\\sqrt{2}}\n$$\nThe problem asks for the dimensionless ratio $U_c / v_{th}$.\n$$\n\\frac{U_c}{v_{th}} = \\frac{1}{\\sqrt{2}}\n$$\nThis is the exact threshold. For $U  U_c$, the distribution has a local minimum at $v=0$, satisfying the Penrose criterion for instability. For $U \\le U_c$, the distribution has a single maximum at $v=0$ (or a flat top at $U=U_c$), and the system is stable.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2}}}\n$$"
        },
        {
            "introduction": "Having established the conditions for instability, we now tackle the canonical case of Landau damping in a thermal (Maxwellian) plasma. This problem requires you to move beyond simple criteria and perform a quantitative calculation by numerically solving the full kinetic dispersion relation for its complex frequency root. This hands-on numerical exercise will not only yield the damping rate $\\gamma$ but also provides a practical lesson in the sensitivity of physical results to the precision of underlying special functions, a common challenge in computational physics. ",
            "id": "4000841",
            "problem": "Consider an unmagnetized, collisionless, homogeneous electron plasma with a Maxwellian equilibrium electron distribution and immobile ions. Starting from the linearized Vlasov–Poisson system, the electron susceptibility can be expressed in terms of the plasma dispersion function. Let the equilibrium electron distribution be isotropic and Maxwellian with electron thermal speed $v_{\\mathrm{th}} = \\sqrt{2 k_{\\mathrm{B}} T_{e}/m_{e}}$, electron plasma frequency $\\omega_{\\mathrm{pe}} = \\sqrt{n_{e} e^{2}/(\\varepsilon_{0} m_{e})}$, and Debye length $\\lambda_{\\mathrm{D}} = \\sqrt{\\varepsilon_{0} k_{\\mathrm{B}} T_{e}/(n_{e} e^{2})}$. Note the relationship $v_{\\mathrm{th}} = \\sqrt{2}\\,\\lambda_{\\mathrm{D}}\\,\\omega_{\\mathrm{pe}}$. Define the dimensionless wavenumber $\\hat{k} = k v_{\\mathrm{th}}/\\omega_{\\mathrm{pe}}$ and the dimensionless complex frequency $\\hat{\\omega} = \\omega/\\omega_{\\mathrm{pe}}$. The electrostatic electron dielectric function is\n$$\n\\varepsilon(\\omega, k) = 1 + \\chi_{e}(\\omega, k), \\quad \\chi_{e}(\\omega, k) = \\frac{\\omega_{\\mathrm{pe}}^{2}}{k^{2} v_{\\mathrm{th}}^{2}} \\left[ 1 + \\xi\\, Z(\\xi) \\right],\n$$\nwhere $\\xi = \\omega/(k v_{\\mathrm{th}})$ and $Z(\\xi)$ is the plasma dispersion function. The Landau-damped Langmuir wave corresponds to the complex root $\\omega$ such that $\\varepsilon(\\omega, k) = 0$ with $\\operatorname{Im}(\\omega)  0$. The Landau damping rate normalized to the electron plasma frequency is the dimensionless quantity $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$, which is unitless.\n\nYour task is to implement a numerical solver that:\n- Represents $Z(\\xi)$ via the Faddeeva function $w(z)$ using the identity $Z(\\xi) = i \\sqrt{\\pi}\\, w(\\xi)$, where $w(z) = e^{-z^{2}} \\operatorname{erfc}(-i z)$.\n- Solves for the complex root $\\hat{\\omega}$ of the normalized dielectric function\n$$\n\\varepsilon(\\hat{\\omega}, \\hat{k}) = 1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, Z(\\hat{\\xi}) \\right] = 0, \\quad \\hat{\\xi} = \\frac{\\hat{\\omega}}{\\hat{k}},\n$$\nusing a two-dimensional nonlinear root-finding method on the real and imaginary parts of $\\varepsilon$.\n- Computes and returns $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$.\n\nIn addition, quantify the sensitivity of $\\gamma/\\omega_{\\mathrm{pe}}$ to numerical errors in $Z(\\xi)$ by introducing a controlled multiplicative perturbation of the form $Z_{\\epsilon}(\\xi) = (1 + \\epsilon)\\, Z(\\xi)$ and recomputing the damping rate for several values of $\\epsilon$. This models a relative numerical error in the evaluation of $Z(\\xi)$.\n\nImplement your program to evaluate and output the following test suite:\n- Case 1 (happy path): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 0.0$.\n- Case 2 (near machine precision perturbation): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-8}$.\n- Case 3 (small perturbation): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-5}$.\n- Case 4 (moderate perturbation): $k \\lambda_{\\mathrm{D}} = 0.2$, $\\epsilon = 10^{-3}$.\n- Case 5 (boundary in $k \\lambda_{\\mathrm{D}}$): $k \\lambda_{\\mathrm{D}} = 0.05$, $\\epsilon = 0.0$.\n- Case 6 (edge in $k \\lambda_{\\mathrm{D}}$): $k \\lambda_{\\mathrm{D}} = 0.5$, $\\epsilon = 0.0$.\n\nUse the normalization $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$ and return the numerical values of $\\gamma/\\omega_{\\mathrm{pe}}$ for each case. No physical units are required because the output is dimensionless.\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[result1,result2,result3]\"). Each result must be a single floating-point number $\\gamma/\\omega_{\\mathrm{pe}}$ corresponding to the cases listed above, ordered as given.",
            "solution": "The problem requires the numerical computation of the Landau damping rate of electron plasma waves in an unmagnetized, collisionless plasma with a Maxwellian electron distribution. The solution involves finding the complex roots of the electrostatic dielectric function. This will be accomplished by implementing a numerical root-finding algorithm. Additionally, a sensitivity analysis will be performed to quantify the effect of numerical errors in the plasma dispersion function on the calculated damping rate.\n\nThe fundamental equation to be solved is the dispersion relation, given by $\\varepsilon(\\omega, k) = 0$, where $\\varepsilon$ is the dielectric function. For the specified plasma conditions, the normalized form of this equation is:\n$$\n\\varepsilon(\\hat{\\omega}, \\hat{k}) = 1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, Z(\\hat{\\xi}) \\right] = 0\n$$\nHere, $\\hat{\\omega} = \\omega/\\omega_{\\mathrm{pe}}$ is the complex wave frequency normalized to the electron plasma frequency, $\\hat{k} = k v_{\\mathrm{th}}/\\omega_{\\mathrm{pe}}$ is the wavenumber normalized using the electron thermal speed $v_{\\mathrm{th}}$, and $\\hat{\\xi} = \\hat{\\omega}/\\hat{k}$ is their ratio. The function $Z(\\hat{\\xi})$ is the plasma dispersion function. The damping rate is given by the negative of the imaginary part of the frequency root, $\\gamma/\\omega_{\\mathrm{pe}} = -\\operatorname{Im}(\\hat{\\omega})$. The problem also specifies the normalization relationship $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$, where $\\lambda_{\\mathrm{D}}$ is the electron Debye length.\n\nThe task is to find the complex root $\\hat{\\omega} = \\hat{\\omega}_r + i \\hat{\\omega}_i$ for given values of $\\hat{k}$. This is equivalent to solving a system of two coupled, nonlinear real equations for two real variables, $\\hat{\\omega}_r$ and $\\hat{\\omega}_i$:\n$$\n\\operatorname{Re}\\left[ \\varepsilon(\\hat{\\omega}_r + i\\hat{\\omega}_i, \\hat{k}) \\right] = 0\n$$\n$$\n\\operatorname{Im}\\left[ \\varepsilon(\\hat{\\omega}_r + i\\hat{\\omega}_i, \\hat{k}) \\right] = 0\n$$\nTo evaluate the dielectric function, we must compute the plasma dispersion function $Z(\\xi)$. The problem provides the relation $Z(\\xi) = i \\sqrt{\\pi}\\, w(\\xi)$, where $w(\\xi) = e^{-\\xi^{2}} \\operatorname{erfc}(-i \\xi)$ is the Faddeeva function. A robust numerical implementation of $w(\\xi)$ is available in the SciPy library as `scipy.special.wofz`.\n\nA numerical root-finding algorithm is required to solve this system. The `scipy.optimize.root` function is well-suited for this purpose. It requires an initial guess for the solution vector $(\\hat{\\omega}_r, \\hat{\\omega}_i)$. A physically motivated initial guess significantly improves the likelihood of convergence to the correct root (the forward-propagating, damped Langmuir wave). In the long-wavelength limit ($k \\lambda_{\\mathrm{D}} \\ll 1$), the real part of the frequency is well-approximated by the Bohm-Gross dispersion relation, $\\omega^2 \\approx \\omega_{\\mathrm{pe}}^2 + 3 k^2 v_{\\text{th,rms}}^2$. Using the problem's definition $v_{\\mathrm{th}} = \\sqrt{2} v_{\\text{th,rms}}$, this becomes $\\omega^2 \\approx \\omega_{pe}^2 + \\frac{3}{2} k^2 v_{\\mathrm{th}}^2$. In normalized units, this provides an excellent initial guess for the real part:\n$$\n\\hat{\\omega}_r \\approx \\sqrt{1 + \\frac{3}{2} \\hat{k}^2}\n$$\nFor the imaginary part, Landau damping is known to be weak for small $\\hat{k}$, implying $\\hat{\\omega}_i$ is a small negative number. A reasonable initial guess such as $\\hat{\\omega}_i = -0.01$ is sufficient to guide the solver towards the damped root ($\\operatorname{Im}(\\omega)  0$).\n\nThe sensitivity analysis is conducted by introducing a controlled multiplicative perturbation $\\epsilon$ into the plasma dispersion function, defining a perturbed function $Z_{\\epsilon}(\\xi) = (1 + \\epsilon)\\, Z(\\xi)$. The dispersion relation is then re-solved using this perturbed function:\n$$\n1 + \\frac{1}{\\hat{k}^{2}} \\left[ 1 + \\hat{\\xi}\\, (1 + \\epsilon)Z(\\hat{\\xi}) \\right] = 0\n$$\nBy solving for $\\hat{\\omega}$ for various small values of $\\epsilon$, we can observe the resulting change in the damping rate, $\\gamma/\\omega_{\\mathrm{pe}}$.\n\nThe overall algorithm proceeds as follows:\n1.  For each test case defined by $(k \\lambda_{\\mathrm{D}}, \\epsilon)$:\n2.  Calculate the normalized wavenumber $\\hat{k} = \\sqrt{2}\\,k \\lambda_{\\mathrm{D}}$.\n3.  Establish an initial guess for the root $(\\hat{\\omega}_r, \\hat{\\omega}_i)$ using the Bohm-Gross relation and a small negative imaginary part.\n4.  Define a target function that takes a vector $(\\hat{\\omega}_r, \\hat{\\omega}_i)$ and returns the real and imaginary parts of the dielectric function $\\varepsilon(\\hat{\\omega}, \\hat{k})$, incorporating the perturbation $\\epsilon$.\n5.  Invoke the `scipy.optimize.root` solver to find the root $(\\hat{\\omega}_{r, \\text{sol}}, \\hat{\\omega}_{i, \\text{sol}})$.\n6.  The Landau damping rate is then $\\gamma/\\omega_{\\mathrm{pe}} = -\\hat{\\omega}_{i, \\text{sol}}$.\n7.  Collect the results from all test cases and format them into the specified output string. This step-by-step process is implemented in the provided Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import wofz\nfrom scipy.optimize import root\n\ndef dielectric_system_for_solver(omega_vec, k_hat, epsilon):\n    \"\"\"\n    Represents the system of equations Re(epsilon)=0, Im(epsilon)=0.\n\n    Args:\n        omega_vec (list-like): A list or array [omega_r, omega_i] representing\n                               the real and imaginary parts of the normalized\n                               complex frequency omega_hat.\n        k_hat (float): The normalized wavenumber.\n        epsilon (float): The multiplicative perturbation for Z(xi).\n\n    Returns:\n        list: A list containing [Re(epsilon), Im(epsilon)].\n    \"\"\"\n    omega_hat = omega_vec[0] + 1j * omega_vec[1]\n\n    # The argument to the plasma dispersion function\n    xi_hat = omega_hat / k_hat\n\n    # Calculate Z(xi) using the Faddeeva function w(z) from SciPy.\n    # The relation is Z(xi) = i * sqrt(pi) * w(xi), where w(z) is computed by wofz.\n    w_val = wofz(xi_hat)\n    z_val = 1j * np.sqrt(np.pi) * w_val\n\n    # Apply the controlled multiplicative perturbation\n    z_perturbed = (1.0 + epsilon) * z_val\n\n    # Calculate the complex dielectric function epsilon(omega, k)\n    eps_val = 1.0 + (1.0 / k_hat**2) * (1.0 + xi_hat * z_perturbed)\n\n    # Return the real and imaginary parts for the 2D root finder\n    return [eps_val.real, eps_val.imag]\n\ndef solve():\n    \"\"\"\n    Main solver function to compute Landau damping rates for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (k * lambda_D, epsilon).\n    test_cases = [\n        (0.2, 0.0),\n        (0.2, 1e-8),\n        (0.2, 1e-5),\n        (0.2, 1e-3),\n        (0.05, 0.0),\n        (0.5, 0.0),\n    ]\n\n    results = []\n    \n    # A single reasonable initial guess for the imaginary part of omega_hat is sufficient\n    # for all cases. The damped root has Im(omega)  0.\n    omega_i_guess = -0.01\n\n    for k_lambda_d, epsilon in test_cases:\n        # Convert the given k*lambda_D to the normalized wavenumber k_hat\n        k_hat = np.sqrt(2.0) * k_lambda_d\n\n        # Calculate an initial guess for the real part of omega_hat using the\n        # Bohm-Gross dispersion relation in the appropriate normalization.\n        omega_r_guess = np.sqrt(1.0 + 1.5 * k_hat**2)\n\n        initial_guess = [omega_r_guess, omega_i_guess]\n\n        # Use scipy.optimize.root to find the solution.\n        # The 'args' parameter passes additional arguments to the target function.\n        # We use a tight tolerance for high accuracy.\n        solution = root(\n            dielectric_system_for_solver,\n            initial_guess,\n            args=(k_hat, epsilon),\n            tol=1e-13,\n            method='hybr' # Default and robust method\n        )\n\n        if not solution.success:\n            # This indicates the solver failed to converge. For these test cases,\n            # this is not expected. Append NaN as a failure indicator.\n            results.append(float('nan'))\n            continue\n\n        # The solution vector is solution.x = [omega_r, omega_i]\n        omega_i_solution = solution.x[1]\n\n        # The normalized damping rate is gamma/omega_pe = -Im(omega_hat)\n        damping_rate = -omega_i_solution\n        results.append(damping_rate)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The previous practices established the conditions for and calculated the rate of Landau damping. This capstone exercise allows you to directly visualize the physical mechanism of resonant energy exchange at the heart of the phenomenon. You will implement a Vlasov-Poisson solver and a field-particle correlation diagnostic to measure the velocity-resolved power transfer between the wave and the plasma particles. This powerful technique makes the abstract concept of resonant interaction tangible, enabling you to pinpoint the exact velocity of the particles that absorb the wave's energy and cause it to damp. ",
            "id": "4000790",
            "problem": "Consider a one-dimensional, one-velocity electrostatic Vlasov–Poisson system for electrons with immobile ions in dimensionless units. Let the electron distribution function be $f(x,v,t)$, the electric field be $E(x,t)$, the electron charge be $q=-1$, and the electron mass be $m=1$. The governing equations are the Vlasov equation and Poisson’s equation:\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\nwith periodic boundary conditions in $x$ and truncated velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ chosen large enough that $f$ is negligible at the boundaries. The initial condition is a weakly perturbed spatial mode of a Maxwellian:\n$$\nf(x,v,0) = f_0(v)\\left[1 + \\alpha \\cos(k x)\\right], \\quad f_0(v) = \\frac{1}{\\sqrt{2\\pi} v_{\\mathrm{th}}}\\exp\\left(-\\frac{v^2}{2 v_{\\mathrm{th}}^2}\\right),\n$$\nwhere $k$ is the fundamental wavenumber of the perturbation, $\\alpha$ is the perturbation amplitude, and $v_{\\mathrm{th}}$ is the electron thermal speed.\n\nDefine the velocity-resolved field–particle correlation diagnostic that measures the time-averaged energy transfer density from the field to particles at each velocity:\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\nwhere $\\langle \\cdot \\rangle_{x,t}$ denotes an average over space and over the simulation time interval. The resonant velocity $v_{\\mathrm{res}}$ associated with Landau damping is identified as the velocity $v \\ge 0$ at which $C(v)$ attains its maximum value.\n\nYour task is to implement a dimensionless numerical solver for the above Vlasov–Poisson system using a Strang-splitting semi-Lagrangian scheme with periodic advection in $x$ and linear-interpolation advection in $v$, coupled with a Fourier-space solver for Poisson’s equation. Then implement the field–particle correlation diagnostic $C(v)$ and, for each specified test case, compute and return $v_{\\mathrm{res}}$.\n\nUse the following domain and discretization choices:\n- Spatial domain length $L = 2\\pi$, periodic in $x$.\n- Number of spatial grid points $N_x = 64$.\n- Velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ with $v_{\\max} = 5$.\n- Number of velocity grid points $N_v = 256$.\n- Time step $\\Delta t = 0.05$.\n- Number of time steps $N_t = 300$.\n- Electron thermal speed $v_{\\mathrm{th}} = 1$.\n\nImplement the Strang splitting for each time step $n$:\n1. Half-step in $v$: advect $f$ along the $v$-characteristics using the current field $E^n(x)$ for $\\Delta t/2$.\n2. Full-step in $x$: advect $f$ along the $x$-characteristics using the particle velocities for $\\Delta t$ with periodic boundary conditions.\n3. Update the field: solve Poisson’s equation to obtain $E^{n+1}(x)$ from the updated $f$.\n4. Half-step in $v$: advect $f$ along the $v$-characteristics using $E^{n+1}(x)$ for $\\Delta t/2$.\n\nAt each full time step, accumulate $C(v)$ using the instantaneous $E(x,t)$ and $f(x,v,t)$ by averaging over $x$ and summing over time, and finally divide by the number of samples to obtain the time average. Identify $v_{\\mathrm{res}}$ by selecting the velocity $v \\ge 0$ at which $C(v)$ is maximized.\n\nAll quantities are dimensionless. The required output for each test case is a single float $v_{\\mathrm{res}}$. The program must process the following test suite of parameter values:\n- Test case $1$: $k = 1$, $\\alpha = 10^{-3}$.\n- Test case $2$: $k = 2$, $\\alpha = 10^{-3}$.\n- Test case $3$: $k = 3$, $\\alpha = 5 \\times 10^{-4}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_i$ is the computed $v_{\\mathrm{res}}$ for test case $i$ as a float.",
            "solution": "The foundation of the problem is the electrostatic Vlasov–Poisson system, which in one dimension and one velocity dimension can be written as\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\nwith $q=-1$ and $m=1$, and periodic boundary conditions in $x$. Starting from first principles, the Vlasov equation expresses phase-space advection along characteristics of motion: particles translate in position with velocity $v$ and in velocity according to acceleration $a = q E$. The Poisson equation relates the spatial derivative of the electric field to the net charge density, here the difference between the constant ion background (normalized to $1$) and the electron density $n_e(x,t) = \\int f(x,v,t)\\, dv$.\n\nThe rate of change of the electron kinetic energy density $W(x,t) = \\int \\frac{1}{2} m v^2 f(x,v,t)\\, dv$ due to the electric field follows from the Vlasov equation by multiplying by $\\frac{1}{2} m v^2$ and integrating over $v$:\n$$\n\\frac{\\partial W}{\\partial t} = \\int \\frac{1}{2} m v^2 \\left[ - v \\frac{\\partial f}{\\partial x} - q E \\frac{\\partial f}{\\partial v} \\right] dv.\n$$\nThe spatial-advection term becomes a divergence in $x$ of the kinetic energy flux and does not contribute to the net field–particle energy exchange rate when spatially averaged in a periodic domain. For the velocity-advection term, integrate by parts in $v$ (assuming $f \\to 0$ at the velocity boundaries and $m=1$):\n$$\n\\int \\frac{1}{2} v^2 \\left(- q E \\frac{\\partial f}{\\partial v} \\right) dv = q E \\int v f \\, dv.\n$$\nTherefore, the instantaneous rate of energy transfer density from the field to the electrons at position $x$ is\n$$\n\\dot{W}(x,t) = \\int q\\, E(x,t)\\, v\\, f(x,v,t)\\, dv.\n$$\nTo resolve this transfer as a function of velocity, define the velocity-resolved field–particle correlation diagnostic\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\nwhere $\\langle \\cdot \\rangle_{x,t}$ denotes an average over space and over the simulation time interval. In the presence of Landau damping of a single electrostatic mode with wavenumber $k$, the resonant energy exchange is localized near the phase velocity $v_\\phi \\approx \\omega/k$, where $\\omega$ is the real frequency of the mode. Thus, the velocity $v$ at which $C(v)$ peaks for $v \\ge 0$ identifies the resonant velocity contributing to damping:\n$$\nv_{\\mathrm{res}} = \\arg\\max_{v \\ge 0} \\, C(v).\n$$\n\nAlgorithmic design:\n- Discretize the spatial domain $x \\in [0,L)$ with $N_x$ points and periodic boundary conditions, and the velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ with $N_v$ points.\n- Initialize $f(x,v,0)$ as a weakly perturbed Maxwellian $f_0(v)\\left[1 + \\alpha \\cos(kx)\\right]$ with thermal speed $v_{\\mathrm{th}}$.\n- Use Strang splitting to advance $f$ in time:\n  - Half-step velocity advection: For each spatial point $x_i$, advect the distribution in $v$ by $\\Delta v = a(x_i)\\, \\Delta t/2$ with $a(x_i) = q E(x_i)$, implemented via semi-Lagrangian linear interpolation along the $v$ grid with clamped boundary indices.\n  - Full-step spatial advection: For each velocity point $v_j$, advect the distribution in $x$ by $\\Delta x = v_j\\, \\Delta t$, implemented via semi-Lagrangian linear interpolation along the $x$ grid with periodic wrapping (using integer shifts and linear fractional interpolation).\n  - Solve Poisson’s equation in Fourier space: Compute the electron density $n_e(x) = \\int f(x,v)\\, dv$ via numerical quadrature (discrete sum times $\\Delta v$), form the charge density $\\rho(x) = 1 - n_e(x)$, take its discrete Fourier transform $\\hat{\\rho}(k_n)$, then for each nonzero Fourier mode with wavenumber $k_n$, obtain $\\hat{E}(k_n) = - i\\, \\hat{\\rho}(k_n)/k_n$, and inverse transform to get $E(x)$; set the zero mode of $\\hat{E}$ to zero to enforce periodic neutrality.\n  - Half-step velocity advection with the updated field.\n- At each full time step, accumulate the correlation $C(v)$ by computing the spatial average of $q\\, E(x,t)\\, v\\, f(x,v,t)$ at each velocity and summing over time, and at the end divide by the number of samples to obtain the time average.\n- Determine $v_{\\mathrm{res}}$ by finding the velocity $v \\ge 0$ at which $C(v)$ is maximal.\n\nNumerical details:\n- Choose $L = 2\\pi$, $N_x = 64$, $v_{\\max} = 5$, $N_v = 256$, $\\Delta t = 0.05$, $N_t = 300$, and $v_{\\mathrm{th}} = 1$.\n- The initial perturbation uses $k \\in \\{1,2,3\\}$ to align with the discrete Fourier modes of the periodic domain.\n- Use small $\\alpha$ (e.g., $\\alpha = 10^{-3}$ or $\\alpha = 5 \\times 10^{-4}$) to remain in the weakly nonlinear regime approximating linear Landau damping.\n- The velocity advection uses clamped interpolation near the boundaries; truncation errors are minimized by choosing $v_{\\max}$ so that $f$ is negligible at the boundaries for the chosen $v_{\\mathrm{th}}$.\n\nTest suite and outputs:\n- Test case $1$: $k = 1$, $\\alpha = 10^{-3}$.\n- Test case $2$: $k = 2$, $\\alpha = 10^{-3}$.\n- Test case $3$: $k = 3$, $\\alpha = 5 \\times 10^{-4}$.\nFor each test case, compute $C(v)$ and return $v_{\\mathrm{res}}$ as a float. The program must print a single line containing a comma-separated list of the three results enclosed in square brackets, e.g., $[r_1,r_2,r_3]$.\n\nThis approach strictly follows from the fundamental Vlasov–Poisson dynamics, derives the velocity-resolved energy transfer diagnostic from the kinetic energy equation, and implements a robust semi-Lagrangian numerical method suitable for capturing Landau damping and identifying the resonant velocity via the correlation $C(v)$.",
            "answer": "```python\nimport numpy as np\n\n# Vlasov-Poisson 1D1V solver with field–particle correlation diagnostic\n# Dimensionless units: q = -1, m = 1, L = 2*pi, v_th = 1\n\ndef maxwellian(v, v_th):\n    return (1.0 / (np.sqrt(2.0 * np.pi) * v_th)) * np.exp(-0.5 * (v / v_th) ** 2)\n\ndef solve_poisson(ne, dx, L):\n    # Solve dE/dx = 1 - ne using FFT with periodic boundary conditions\n    rho = 1.0 - ne  # Charge density (ions = 1)\n    rho_k = np.fft.fft(rho)\n    kfreq = np.fft.fftfreq(ne.size, d=dx)  # cycles per unit length\n    k = 2.0 * np.pi * kfreq  # angular wavenumbers\n    E_k = np.zeros_like(rho_k, dtype=np.complex128)\n    nonzero = k != 0.0\n    E_k[nonzero] = -1j * rho_k[nonzero] / k[nonzero]\n    E_k[~nonzero] = 0.0 + 0.0j  # enforce neutrality\n    E = np.fft.ifft(E_k).real\n    return E\n\ndef advect_x(f, vgrid, dt, dx):\n    # Semi-Lagrangian advection in x with periodic boundary\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    for j in range(Nv):\n        s = vgrid[j] * dt / dx\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        # Linear interpolation between shifted fields\n        out[:, j] = (1.0 - a) * np.roll(f[:, j], n) + a * np.roll(f[:, j], n + 1)\n    return out\n\ndef advect_v(f, E, dt, dv):\n    # Semi-Lagrangian advection in v with clamped boundary indices\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    j = np.arange(Nv)\n    for i in range(Nx):\n        s = (-E[i]) * dt / dv  # dv/dt = qE/m = -E\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        j0 = j - n\n        j1 = j - n - 1\n        j0 = np.clip(j0, 0, Nv - 1)\n        j1 = np.clip(j1, 0, Nv - 1)\n        out[i, :] = (1.0 - a) * f[i, j0] + a * f[i, j1]\n    return out\n\ndef run_case(k_mode, alpha, params):\n    # Unpack parameters\n    L = params['L']\n    Nx = params['Nx']\n    Nv = params['Nv']\n    vmax = params['vmax']\n    dt = params['dt']\n    Nt = params['Nt']\n    v_th = params['v_th']\n    q = -1.0\n\n    # Grids\n    x = np.linspace(0.0, L, Nx, endpoint=False)\n    v = np.linspace(-vmax, vmax, Nv)\n    dx = x[1] - x[0]\n    dv = v[1] - v[0]\n\n    # Initial distribution: weakly perturbed Maxwellian\n    f0 = maxwellian(v, v_th)  # shape (Nv,)\n    f = f0[None, :] * (1.0 + alpha * np.cos(k_mode * x)[:, None])  # shape (Nx, Nv)\n\n    # Initial field from Poisson\n    ne = np.sum(f, axis=1) * dv\n    E = solve_poisson(ne, dx, L)\n\n    # Correlation accumulator C(v)\n    C = np.zeros(Nv)\n\n    # Time loop with Strang splitting\n    for _ in range(Nt):\n        # Half-step in v\n        f = advect_v(f, E, dt * 0.5, dv)\n        # Full-step in x\n        f = advect_x(f, v, dt, dx)\n        # Update field\n        ne = np.sum(f, axis=1) * dv\n        E = solve_poisson(ne, dx, L)\n        # Half-step in v with updated field\n        f = advect_v(f, E, dt * 0.5, dv)\n\n        # Accumulate correlation C(v) =  q E v f _{x}\n        Ef = (E[:, None] * f)  # shape (Nx, Nv)\n        C += q * v * (Ef.mean(axis=0))\n\n    # Time-average\n    C /= Nt\n\n    # Identify resonant velocity v_res for v = 0 as location of maximum C(v)\n    pos_mask = v = 0.0\n    v_pos = v[pos_mask]\n    C_pos = C[pos_mask]\n    idx = int(np.argmax(C_pos))\n    v_res = float(v_pos[idx])\n    return v_res\n\ndef solve():\n    # Simulation parameters\n    params = {\n        'L': 2.0 * np.pi,\n        'Nx': 64,\n        'Nv': 256,\n        'vmax': 5.0,\n        'dt': 0.05,\n        'Nt': 300,\n        'v_th': 1.0,\n    }\n\n    # Test cases: (k, alpha)\n    test_cases = [\n        (1, 1e-3),\n        (2, 1e-3),\n        (3, 5e-4),\n    ]\n\n    results = []\n    for k_mode, alpha in test_cases:\n        v_res = run_case(k_mode, alpha, params)\n        results.append(v_res)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}