{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing ballooning stability is to quantify the destabilizing drive, which arises from the plasma pressure gradient in regions of unfavorable magnetic curvature. This drive is encapsulated in the dimensionless parameter $\\alpha$. This exercise provides essential practice in connecting fundamental, measurable tokamak parameters—such as the magnetic field $B$, pressure gradient $\\frac{dp}{dr}$, and safety factor $q$—to this crucial stability parameter, grounding the abstract $s-\\alpha$ model in a concrete physical context.",
            "id": "4192698",
            "problem": "Consider a large-aspect-ratio, circular-flux-surface tokamak equilibrium in which the toroidal magnetic field is approximately radially constant over the region of interest. You are analyzing ideal Magnetohydrodynamic (MHD) ballooning stability using the standard shear–alpha ($s$–$\\alpha$) framework in which the normalized pressure-gradient parameter $\\alpha$ encapsulates the interchange drive due to unfavorable curvature. The plasma has magnetic shear $s=0.8$, safety factor $q=2.5$, major radius $R_0=3$ m, toroidal magnetic field magnitude $B=3$ T, and radial pressure gradient $\\frac{dp}{dr}=-5\\times 10^{4}$ Pa/m. Assume the vacuum permeability is $\\mu_0=4\\pi\\times 10^{-7}$ N/A$^2$ and neglect any radial variation of $B$ in evaluating derivatives of the plasma beta.\n\nStarting from fundamental definitions and well-tested relations appropriate to ideal MHD and the $s$–$\\alpha$ model, derive an expression for the normalized pressure-gradient parameter $\\alpha$ in terms of $\\mu_0$, $R_0$, $q$, $B$, and $\\frac{dp}{dr}$, then compute its value for the given parameters. Express $\\alpha$ as a dimensionless quantity and provide the final result as an exact analytical expression (no rounding).\n\nFinally, based on the computed $\\alpha$ and the given magnetic shear $s$, qualitatively assess whether the plasma is likely above the first ballooning stability boundary in the $s$–$\\alpha$ stability diagram for positive shear, explaining your reasoning. Your qualitative assessment must appear only in your derivation; the final answer must contain only your exact value of $\\alpha$ and no words.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. All provided parameters and the underlying theoretical framework, the $s$–$\\alpha$ model for ideal Magnetohydrodynamic (MHD) ballooning stability, are standard in the field of fusion plasma physics. The provided numerical values are physically realistic for a tokamak. The problem is therefore deemed valid and a solution will be provided.\n\nThe primary task is to derive and compute the value of the normalized pressure-gradient parameter, $\\alpha$. This parameter is a central component of the $s$–$\\alpha$ model for ballooning instabilities in tokamaks. It quantifies the instability drive arising from the plasma pressure gradient in a region of unfavorable magnetic field curvature.\n\nThe standard definition of $\\alpha$ is formulated in terms of the radial derivative of the plasma beta, $\\beta$. The plasma beta is the ratio of plasma pressure to magnetic pressure:\n$$ \\beta = \\frac{p}{p_{mag}} = \\frac{p}{B^2 / (2\\mu_0)} = \\frac{2\\mu_0 p}{B^2} $$\nwhere $p$ is the plasma pressure, $B$ is the magnitude of the magnetic field, and $\\mu_0$ is the vacuum permeability.\n\nThe drive for ballooning modes is proportional to the pressure gradient. In the $s$–$\\alpha$ formalism, this is expressed through the radial derivative of beta, denoted as $\\beta'$.\n$$ \\beta' = \\frac{d\\beta}{dr} $$\nwhere $r$ is the minor radial coordinate. Using the definition of $\\beta$ and applying the product rule for differentiation gives:\n$$ \\beta' = \\frac{d}{dr} \\left( \\frac{2\\mu_0 p}{B^2} \\right) = \\frac{2\\mu_0}{B^2} \\frac{dp}{dr} - \\frac{4\\mu_0 p}{B^3} \\frac{dB}{dr} $$\nThe problem statement specifies that we should neglect any radial variation of the magnetic field $B$ when evaluating derivatives of beta. This simplifies the expression for $\\beta'$ considerably by setting $\\frac{dB}{dr}=0$:\n$$ \\beta' = \\frac{2\\mu_0}{B^2} \\frac{dp}{dr} $$\nThe normalized pressure-gradient parameter $\\alpha$ is defined in the large-aspect-ratio, circular flux surface limit as:\n$$ \\alpha = -R_0 q^2 \\beta' $$\nHere, $R_0$ is the major radius of the tokamak and $q$ is the safety factor. The minus sign is conventional; since a confined plasma has a negative pressure gradient ($\\frac{dp}{dr}  0$), the value of $\\alpha$ is positive, representing the magnitude of the instability drive.\n\nSubstituting the expression for $\\beta'$ into the definition of $\\alpha$, we obtain the desired expression for $\\alpha$ in terms of the fundamental given parameters:\n$$ \\alpha = -R_0 q^2 \\left( \\frac{2\\mu_0}{B^2} \\frac{dp}{dr} \\right) = - \\frac{2 \\mu_0 R_0 q^2}{B^2} \\frac{dp}{dr} $$\nThis expression is dimensionless, as is required for a normalized parameter.\n\nNow, we compute the value of $\\alpha$ using the provided data:\n- Magnetic shear, $s = 0.8$\n- Safety factor, $q = 2.5$\n- Major radius, $R_0 = 3$ m\n- Toroidal magnetic field magnitude, $B = 3$ T\n- Radial pressure gradient, $\\frac{dp}{dr} = -5 \\times 10^{4}$ Pa/m\n- Vacuum permeability, $\\mu_0 = 4\\pi \\times 10^{-7}$ N/A$^2$\n\nSubstituting these values into the derived formula for $\\alpha$:\n$$ \\alpha = - \\frac{2 (4\\pi \\times 10^{-7}) (3) (2.5)^2}{(3)^2} (-5 \\times 10^4) $$\nThe two negative signs cancel. Let's simplify the expression:\n$$ \\alpha = \\frac{2 \\cdot (4\\pi \\times 10^{-7}) \\cdot 3 \\cdot (6.25)}{9} \\cdot (5 \\times 10^4) $$\n$$ \\alpha = \\frac{2 \\cdot 4\\pi \\cdot 3 \\cdot 6.25 \\cdot 5 \\cdot 10^{-7} \\cdot 10^4}{9} $$\n$$ \\alpha = \\frac{8\\pi \\cdot 3 \\cdot 6.25 \\cdot 5 \\cdot 10^{-3}}{9} $$\nThe factor of $3$ in the numerator cancels with one factor of $3$ in the denominator:\n$$ \\alpha = \\frac{8\\pi \\cdot 6.25 \\cdot 5 \\cdot 10^{-3}}{3} $$\nNext, we evaluate the product $8 \\times 6.25 \\times 5$:\n$$ 8 \\times 6.25 = 8 \\times \\frac{25}{4} = 2 \\times 25 = 50 $$\n$$ 50 \\times 5 = 250 $$\nSo the expression becomes:\n$$ \\alpha = \\frac{250\\pi \\times 10^{-3}}{3} = \\frac{0.25\\pi}{3} $$\nTo write this as a simple fraction:\n$$ \\alpha = \\frac{\\pi/4}{3} = \\frac{\\pi}{12} $$\nThis is the exact analytical value for the normalized pressure-gradient parameter $\\alpha$.\n\nFinally, we perform a qualitative assessment of the ballooning stability. The $s$–$\\alpha$ stability diagram maps out regions of stability and instability for ideal ballooning modes as a function of the magnetic shear $s$ and the pressure-gradient parameter $\\alpha$. For positive shear ($s > 0$), there is a first region of stability for low values of $\\alpha$, an unstable region for intermediate $\\alpha$, and potentially a second region of stability for very large $\\alpha$. The boundary between the first stable region and the unstable region, known as the first stability boundary, is a curve $\\alpha_c(s)$ that starts at the origin $(s=0, \\alpha=0)$ and increases with $s$. A common rule of thumb for this boundary at moderate shear ($s \\approx 0.5 - 1.5$) is that instability occurs when $\\alpha$ is on the order of $s$. A more precise analytical approximation is $\\alpha_c(s) \\approx 0.6s$ for $s \\lesssim 1.5$.\nThe given parameters are $s = 0.8$ and the computed value is $\\alpha = \\frac{\\pi}{12} \\approx \\frac{3.14159}{12} \\approx 0.262$.\nLet's compare our computed $\\alpha$ with the approximate stability boundary at $s=0.8$:\n$$ \\alpha_c(s=0.8) \\approx 0.6 \\times 0.8 = 0.48 $$\nSince our computed value $\\alpha \\approx 0.262$ is substantially less than the estimated critical value $\\alpha_c \\approx 0.48$, the plasma operating point $(s, \\alpha) = (0.8, \\pi/12)$ lies well within the first region of stability. The destabilizing drive from the pressure gradient is insufficient to overcome the stabilizing effect of field-line bending, which is quantified by the magnetic shear. Therefore, the plasma is qualitatively assessed to be stable with respect to ideal MHD ballooning modes.",
            "answer": "$$ \\boxed{\\frac{\\pi}{12}} $$"
        },
        {
            "introduction": "Once the instability drive, represented by $\\alpha$, is determined, the crucial question is whether it is strong enough to overcome stabilizing effects, principally the magnetic field-line bending associated with magnetic shear, $s$. This exercise takes you to the theoretical core of the $s-\\alpha$ stability diagram by analyzing a simplified, yet physically rich, model of the ideal ballooning equation. By applying standard methods of mathematical physics to derive the stability condition, you will gain a first-principles understanding of the competition between pressure drive and shear stabilization.",
            "id": "4192728",
            "problem": "Consider a large aspect-ratio, circular cross-section tokamak and the ideal Magnetohydrodynamics (MHD) energy principle in the infinite-toroidal-mode-number (ballooning) limit. Along a single magnetic field line, introduce the extended poloidal angle $\\theta$ and the ballooning representation of the normal displacement $\\xi(\\theta)$, and write the local ballooning eigenvalue problem in the form\n$$\n-\\,\\frac{d^{2}\\xi}{d\\theta^{2}} \\;+\\; \\Big[s^{2}\\,\\theta^{2}\\;-\\;\\alpha\\,\\cos\\theta\\Big]\\,\\xi \\;=\\; \\Lambda\\,\\xi,\n$$\nwhere $s$ is the magnetic shear, $\\alpha$ is the normalized pressure-gradient parameter (curvature drive), and $\\Lambda$ is the dimensionless eigenvalue whose sign determines stability. Assume a mode that is strongly ballooned on the outboard side so that it is localized near $\\theta=0$, and take the leading-order approximation of $\\cos\\theta$ about $\\theta=0$. Using a consistent local approximation and a variational estimate for the lowest eigenvalue of the associated Schrödinger-type operator, derive the leading-order closed-form analytic expression for the lowest eigenvalue $\\Lambda(s,\\alpha)$ in terms of $s$ and $\\alpha$. Express your final answer as a single analytic expression. No numerical approximation or rounding is required, and no units are to be included in the final expression.",
            "solution": "### Step-by-Step Thought Process for Problem Validation\n\n**Step 1: Extract Givens**\n*   **System:** A large aspect-ratio, circular cross-section tokamak.\n*   **Framework:** Ideal Magnetohydrodynamics (MHD) energy principle in the infinite-toroidal-mode-number (ballooning) limit.\n*   **Coordinate:** Extended poloidal angle $\\theta$.\n*   **Variable:** Normal displacement $\\xi(\\theta)$ in the ballooning representation.\n*   **Equation:** The local ballooning eigenvalue problem: $-\\frac{d^{2}\\xi}{d\\theta^{2}} + \\Big[s^{2}\\,\\theta^{2} - \\alpha\\,\\cos\\theta\\Big]\\,\\xi = \\Lambda\\,\\xi$.\n*   **Parameters:**\n    *   $s$: magnetic shear.\n    *   $\\alpha$: normalized pressure-gradient parameter (curvature drive).\n    *   $\\Lambda$: dimensionless eigenvalue.\n*   **Assumption/Condition:** The mode is strongly ballooned on the outboard side, localized near $\\theta=0$.\n*   **Methodology:**\n    *   Take the leading-order approximation of $\\cos\\theta$ about $\\theta=0$.\n    *   Use a consistent local approximation.\n    -   Use a variational estimate for the lowest eigenvalue.\n*   **Required Output:** A leading-order closed-form analytic expression for the lowest eigenvalue $\\Lambda(s, \\alpha)$.\n\n**Step 2: Validate Using Extracted Givens**\n*   **Scientific Grounding:** The problem describes the standard ideal MHD ballooning equation in the strong ballooning limit. This is a canonical problem in fusion plasma stability theory. The equation is a Schrödinger-like equation, and the parameters $s$ and $\\alpha$ are well-defined physical quantities in tokamak physics. The framework is entirely consistent with established theory. This is scientifically grounded.\n*   **Well-Posedness:** The problem asks for the lowest eigenvalue of a Sturm-Liouville-type operator. The potential term, after approximation, will be a quadratic plus a constant. This structure typically leads to a well-defined, unique lowest eigenvalue. The problem is well-posed.\n*   **Objectivity:** The language is technical, precise, and free of subjective claims. The problem is stated objectively.\n*   **Completeness:** The problem provides the governing equation, the relevant parameters, the key assumptions (strong ballooning, localization at $\\theta=0$), and the required method (Taylor approximation, variational estimate). This is sufficient information to proceed. The problem is self-contained.\n*   **Realism/Feasibility:** The approximations requested are standard in the literature for analyzing this problem. The parameters are symbolic, so there are no issues with dimensional or physical inconsistency of numerical values. The setup is realistic within the theoretical model.\n*   **Structure:** The problem is clearly structured and asks for a specific derivation. It's not ill-posed or ambiguous.\n*   **Triviality/Pseudo-Profundity:** This is a standard but non-trivial calculation in plasma theory. It requires applying knowledge of approximations, differential equations, and variational methods. It is not pseudo-profound or trivial.\n*   **Verifiability:** The derivation is a mathematical procedure that can be checked for correctness. The result can be compared with established results in the field.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. It is a standard, well-posed problem in theoretical plasma physics. I will proceed to solve it.\n\n### Step-by-Step Thought Process for the Solution\n\n1.  **Start with the governing equation:**\n    $$\n    -\\,\\frac{d^{2}\\xi}{d\\theta^{2}} \\;+\\; V(\\theta)\\,\\xi \\;=\\; \\Lambda\\,\\xi\n    $$\n    where the potential is $V(\\theta) = s^{2}\\,\\theta^{2}\\;-\\;\\alpha\\,\\cos\\theta$.\n\n2.  **Apply the strong ballooning approximation:**\n    The mode is localized near $\\theta=0$. This justifies approximating the potential $V(\\theta)$ for small $\\theta$. The Taylor series for $\\cos\\theta$ around $\\theta=0$ is:\n    $$\n    \\cos\\theta = 1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\n    $$\n    The problem asks for the *leading-order* approximation. This implies we should keep terms up to $\\mathcal{O}(\\theta^2)$ in the potential.\n    $$\n    \\cos\\theta \\approx 1 - \\frac{\\theta^2}{2}\n    $$\n    Substituting this into the potential $V(\\theta)$:\n    $$\n    V(\\theta) \\approx s^{2}\\,\\theta^{2} - \\alpha \\left(1 - \\frac{\\theta^2}{2}\\right) = s^2\\,\\theta^2 - \\alpha + \\frac{\\alpha}{2}\\theta^2 = \\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha\n    $$\n\n3.  **Rewrite the approximate eigenvalue problem:**\n    Plugging the approximate potential back into the original equation:\n    $$\n    -\\,\\frac{d^{2}\\xi}{d\\theta^{2}} \\;+\\; \\left[\\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha\\right]\\xi \\;=\\; \\Lambda\\,\\xi\n    $$\n    This is a Schrödinger-type equation with a harmonic oscillator potential plus a constant shift.\n\n4.  **Use the variational method as requested:**\n    The problem requests a variational estimate for the lowest eigenvalue, $\\Lambda_0$. According to the Rayleigh-Ritz principle, the ground state eigenvalue is the minimum value of the expectation value of the Hamiltonian. The functional to be minimized is:\n    $$\n    \\Lambda[\\xi] = \\frac{\\langle \\xi | H | \\xi \\rangle}{\\langle \\xi | \\xi \\rangle} = \\frac{\\int_{-\\infty}^{\\infty} \\xi^{*} \\left( -\\frac{d^{2}}{d\\theta^{2}} + V_{approx}(\\theta) \\right) \\xi \\, d\\theta}{\\int_{-\\infty}^{\\infty} |\\xi|^2 \\, d\\theta}\n    $$\n    where the domain of integration is extended to $(-\\infty, \\infty)$ because the mode is strongly localized.\n    The Hamiltonian operator for the approximated problem is $H = -\\frac{d^2}{d\\theta^2} + \\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha$.\n    The potential is harmonic, so the exact ground state eigenfunction is a Gaussian. We choose a Gaussian variational trial function, which is guaranteed to give the exact lowest eigenvalue for this approximated Hamiltonian. Let the trial function be:\n    $$\n    \\xi_t(\\theta) = \\exp\\left(-\\frac{a \\theta^2}{2}\\right)\n    $$\n    where $a > 0$ is a variational parameter representing the inverse-square of the mode width.\n\n5.  **Calculate the terms in the variational functional.**\n    First, the normalization integral (denominator):\n    $$\n    \\langle \\xi_t | \\xi_t \\rangle = \\int_{-\\infty}^{\\infty} \\exp(-a\\theta^2) \\, d\\theta = \\sqrt{\\frac{\\pi}{a}}\n    $$\n    Next, the numerator, $\\langle \\xi_t | H | \\xi_t \\rangle$. We can split this into kinetic and potential energy parts.\n    The kinetic energy term:\n    $$\n    T = \\int_{-\\infty}^{\\infty} \\xi_t^* \\left(-\\frac{d^2}{d\\theta^2}\\right) \\xi_t \\, d\\theta\n    $$\n    Integrating by parts, this becomes:\n    $$\n    T = \\int_{-\\infty}^{\\infty} \\left| \\frac{d\\xi_t}{d\\theta} \\right|^2 \\, d\\theta\n    $$\n    The derivative is $\\frac{d\\xi_t}{d\\theta} = -a\\theta \\exp(-\\frac{a \\theta^2}{2})$. So,\n    $$\n    T = \\int_{-\\infty}^{\\infty} a^2 \\theta^2 \\exp(-a\\theta^2) \\, d\\theta\n    $$\n    Using the standard integral $\\int_{-\\infty}^{\\infty} x^2 e^{-bx^2} dx = \\frac{1}{2b}\\sqrt{\\frac{\\pi}{b}}$, we get:\n    $$\n    T = a^2 \\left( \\frac{1}{2a} \\sqrt{\\frac{\\pi}{a}} \\right) = \\frac{a}{2} \\sqrt{\\frac{\\pi}{a}}\n    $$\n    The potential energy term:\n    $$\n    U = \\int_{-\\infty}^{\\infty} |\\xi_t|^2 V_{approx}(\\theta) \\, d\\theta = \\int_{-\\infty}^{\\infty} \\exp(-a\\theta^2) \\left[ \\left(s^2 + \\frac{\\alpha}{2}\\right)\\theta^2 - \\alpha \\right] \\, d\\theta\n    $$\n    $$\n    U = \\left(s^2 + \\frac{\\alpha}{2}\\right) \\int_{-\\infty}^{\\infty} \\theta^2 \\exp(-a\\theta^2) \\, d\\theta - \\alpha \\int_{-\\infty}^{\\infty} \\exp(-a\\theta^2) \\, d\\theta\n    $$\n    Using the previously cited integrals:\n    $$\n    U = \\left(s^2 + \\frac{\\alpha}{2}\\right) \\left( \\frac{1}{2a} \\sqrt{\\frac{\\pi}{a}} \\right) - \\alpha \\sqrt{\\frac{\\pi}{a}}\n    $$\n    The variational estimate for the eigenvalue is $\\Lambda_E(a)$:\n    $$\n    \\Lambda_E(a) = \\frac{T+U}{\\langle \\xi_t | \\xi_t \\rangle} = \\frac{\\frac{a}{2} \\sqrt{\\frac{\\pi}{a}} + \\frac{1}{2a}(s^2 + \\frac{\\alpha}{2}) \\sqrt{\\frac{\\pi}{a}} - \\alpha \\sqrt{\\frac{\\pi}{a}}}{\\sqrt{\\frac{\\pi}{a}}}\n    $$\n    $$\n    \\Lambda_E(a) = \\frac{a}{2} + \\frac{1}{2a}\\left(s^2 + \\frac{\\alpha}{2}\\right) - \\alpha\n    $$\n\n6.  **Minimize the variational functional.**\n    To find the best estimate for the lowest eigenvalue, we must minimize $\\Lambda_E(a)$ with respect to the variational parameter $a$. We compute the derivative and set it to zero:\n    $$\n    \\frac{d\\Lambda_E}{da} = \\frac{1}{2} - \\frac{1}{2a^2}\\left(s^2 + \\frac{\\alpha}{2}\\right) = 0\n    $$\n    Solving for $a$:\n    $$\n    \\frac{1}{2} = \\frac{1}{2a^2}\\left(s^2 + \\frac{\\alpha}{2}\\right) \\implies a^2 = s^2 + \\frac{\\alpha}{2}\n    $$\n    The optimal value of the parameter $a$, which we denote $a_{opt}$, is:\n    $$\n    a_{opt} = \\sqrt{s^2 + \\frac{\\alpha}{2}}\n    $$\n    For a bound state to exist, the potential must be binding, which requires $s^2 + \\frac{\\alpha}{2} > 0$. We assume this condition holds.\n\n7.  **Calculate the lowest eigenvalue.**\n    The lowest eigenvalue, $\\Lambda_0$, is the value of $\\Lambda_E(a)$ at $a = a_{opt}$.\n    $$\n    \\Lambda_0 = \\Lambda_E(a_{opt}) = \\frac{a_{opt}}{2} + \\frac{1}{2a_{opt}}\\left(s^2 + \\frac{\\alpha}{2}\\right) - \\alpha\n    $$\n    Substitute $s^2 + \\frac{\\alpha}{2} = a_{opt}^2$ into the expression:\n    $$\n    \\Lambda_0 = \\frac{a_{opt}}{2} + \\frac{a_{opt}^2}{2a_{opt}} - \\alpha = \\frac{a_{opt}}{2} + \\frac{a_{opt}}{2} - \\alpha = a_{opt} - \\alpha\n    $$\n    Finally, substitute the expression for $a_{opt}$:\n    $$\n    \\Lambda_0(s, \\alpha) = \\sqrt{s^2 + \\frac{\\alpha}{2}} - \\alpha\n    $$\nThis expression represents the leading-order analytic result for the lowest eigenvalue of the ballooning equation under the strong-ballooning approximation. The sign of $\\Lambda_0$ determines stability: $\\Lambda_0  0$ implies instability. The stability boundary is given by $\\Lambda_0 = 0$, which leads to the condition $\\sqrt{s^2 + \\frac{\\alpha}{2}} = \\alpha$, or $s^2 + \\frac{\\alpha}{2} = \\alpha^2$, which can be rearranged to form the well-known $s$-$\\alpha$ stability diagram for ideal ballooning modes.",
            "answer": "$$\n\\boxed{\\sqrt{s^{2} + \\frac{\\alpha}{2}} - \\alpha}\n$$"
        },
        {
            "introduction": "Analytical models, like the one explored in the previous exercise, provide invaluable physical insight but often rely on simplifying approximations. To obtain precise solutions and analyze more complex scenarios, plasma physicists turn to numerical methods. This hands-on coding practice guides you through implementing a powerful spectral method to solve the ballooning eigenvalue problem, bridging the gap between theory and computation. By building a numerical solver and testing its convergence against the known analytical solution, you will not only verify the theory but also develop computational skills that are fundamental to modern plasma simulation.",
            "id": "4192684",
            "problem": "You are tasked with implementing a spectral method using Hermite functions to solve a simplified, parabolic approximation of the ideal Magnetohydrodynamics (MHD) ballooning eigenvalue equation and to test convergence of the computed ground-state eigenvalue versus the basis size. The derivation must start from the ideal MHD energy principle and the local $s$-$\\alpha$ model, which captures the competition between magnetic shear and pressure-gradient-driven curvature. Near the outboard midplane (poloidal angle $\\theta = 0$, measured in radians), the local ballooning eigenvalue problem along the field line, in a parabolic approximation, can be written as a one-dimensional Sturm–Liouville operator on the infinite domain $\\theta \\in \\mathbb{R}$ with decay at infinity:\n$$\n\\mathcal{L} \\phi(\\theta) \\equiv -\\frac{d^2 \\phi}{d \\theta^2} + \\left( \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 - \\alpha \\right) \\phi(\\theta) = \\lambda \\, \\phi(\\theta),\n$$\nwhere $s$ is the magnetic shear (dimensionless), $\\alpha$ is the normalized pressure-gradient parameter (dimensionless), $\\phi(\\theta)$ is the ballooning eigenfunction envelope, and $\\lambda$ is the eigenvalue (dimensionless). The boundary condition is $\\phi(\\theta) \\to 0$ as $|\\theta| \\to \\infty$.\n\nYou must discretize $\\mathcal{L}$ with a spectral expansion in the orthonormal Hermite function basis $\\{\\varphi_n(\\theta)\\}_{n=0}^{N-1}$ on $\\mathbb{R}$, where\n$$\n\\varphi_n(\\theta) = \\frac{1}{\\sqrt{2^n n! \\sqrt{\\pi}}} \\, e^{-\\theta^2/2} H_n(\\theta),\n$$\nand $H_n(\\theta)$ are the physicists’ Hermite polynomials. Use the standard $L^2(\\mathbb{R})$ inner product. Construct the truncated matrix representation of $\\mathcal{L}$ in this basis of size $N$, and compute its lowest eigenvalue $\\lambda_0^{(N)}$. Then, test convergence by increasing $N$ and comparing $\\lambda_0^{(N)}$ to the exact ground-state eigenvalue of the parabolic model (which follows from first principles and operator rescaling, to be derived in your solution). Report the absolute error $|\\lambda_0^{(N)} - \\lambda_0|$ for each $N$.\n\nAngles must be taken in radians. All outputs are dimensionless. Round all reported errors to $10$ decimal places.\n\nImplement a complete, runnable program that:\n- Builds the spectral matrix of $\\mathcal{L}$ using Hermite functions for given $(s,\\alpha)$ and basis size $N$.\n- Computes the lowest eigenvalue numerically for each $N$.\n- Computes and returns the absolute error with respect to the exact ground-state eigenvalue of the parabolic model.\n- Aggregates the results across a test suite of parameter sets and basis sizes into the specified output format.\n\nTest suite specification:\n- Use the following parameter sets $(s,\\alpha)$, each tested at basis sizes $N \\in \\{4,8,16,32\\}$:\n    1. $(s,\\alpha) = (1.0,\\,0.5)$: a general “happy path” case.\n    2. $(s,\\alpha) = (0.5,\\,2.5)$: a case with a negative ground-state eigenvalue.\n    3. $(s,\\alpha) = (2.8,\\,0.4)$: a case with large effective curvature.\n    4. $(s,\\alpha) = (0.1,\\,0.1)$: a near-marginal curvature case.\n    5. $(s,\\alpha) = (0.9,\\,0.38)$: a boundary case where the effective oscillator frequency matches the unit Hermite basis scaling.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list corresponding to one parameter set and containing the four absolute errors for $N=4,8,16,32$, rounded to $10$ decimal places, with no spaces, for example:\n$$\n[\\,[e_{1,4},e_{1,8},e_{1,16},e_{1,32}],\\,[e_{2,4},e_{2,8},e_{2,16},e_{2,32}],\\,[e_{3,4},e_{3,8},e_{3,16},e_{3,32}],\\,[e_{4,4},e_{4,8},e_{4,16},e_{4,32}],\\,[e_{5,4},e_{5,8},e_{5,16},e_{5,32}]\\,]\n$$\nwhere each $e_{i,N}$ is a float representing the absolute error for the $i$-th parameter set at basis size $N$.",
            "solution": "The problem requires solving a one-dimensional Sturm–Liouville eigenvalue problem, which is a parabolic approximation of the ideal Magnetohydrodynamics (MHD) ballooning equation. The equation is given on the infinite domain $\\theta \\in \\mathbb{R}$ as:\n$$\n\\mathcal{L} \\phi(\\theta) \\equiv -\\frac{d^2 \\phi}{d \\theta^2} + \\left( \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 - \\alpha \\right) \\phi(\\theta) = \\lambda \\, \\phi(\\theta)\n$$\nwith boundary conditions $\\phi(\\theta) \\to 0$ as $|\\theta| \\to \\infty$. Here, $s$ is the magnetic shear, $\\alpha$ is the normalized pressure-gradient parameter, $\\phi$ is the eigenfunction, and $\\lambda$ is the eigenvalue. We are to solve this numerically using a spectral method with Hermite functions and compare the numerical ground-state eigenvalue to the exact analytical solution.\n\nFirst, we derive the exact ground-state eigenvalue, $\\lambda_0$. The given equation can be rearranged as:\n$$\n\\left[ -\\frac{d^2}{d \\theta^2} + \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 \\right] \\phi(\\theta) = (\\lambda + \\alpha) \\phi(\\theta)\n$$\nThis is a form of the Schrödinger equation for a quantum harmonic oscillator (QHO). The standard QHO eigenvalue equation for a particle of mass $m$ and angular frequency $\\omega$ (with $\\hbar = 1$) is $\\left(-\\frac{1}{2m}\\frac{d^2}{dx^2} + \\frac{1}{2}m\\omega^2 x^2\\right)\\psi = E \\psi$, with eigenvalues $E_\\nu = (\\nu + 1/2)\\omega$ for $\\nu = 0, 1, 2, \\dots$. Our equation is of the form $\\left(-\\frac{d^2}{d\\theta^2} + K \\theta^2\\right)\\phi = E' \\phi$, where $K = s^2 + \\frac{\\alpha}{2}$ and $E' = \\lambda + \\alpha$. This operator corresponds to a QHO with $m=1/2$ and $\\omega = \\sqrt{2K}$. The eigenvalues of the operator $-\\frac{d^2}{d\\theta^2} + K\\theta^2$ are $(2\\nu+1)\\sqrt{K}$. Therefore, we must have:\n$$\n\\lambda_\\nu + \\alpha = (2\\nu+1)\\sqrt{s^2 + \\frac{\\alpha}{2}}\n$$\nThe eigenvalues, $\\lambda_\\nu$, of the operator $\\mathcal{L}$ are thus:\n$$\n\\lambda_\\nu = (2\\nu+1)\\sqrt{s^2 + \\frac{\\alpha}{2}} - \\alpha\n$$\nThe ground state corresponds to $\\nu=0$, yielding the exact ground-state eigenvalue:\n$$\n\\lambda_0 = \\sqrt{s^2 + \\frac{\\alpha}{2}} - \\alpha\n$$\nThis analytical result will serve as the benchmark for our numerical solution.\n\nNext, we formulate the spectral method. We expand the unknown eigenfunction $\\phi(\\theta)$ in a truncated basis of orthonormal Hermite functions $\\{\\varphi_n(\\theta)\\}_{n=0}^{N-1}$:\n$$ \\phi(\\theta) \\approx \\sum_{n=0}^{N-1} c_n \\varphi_n(\\theta) $$\nwhere $\\varphi_n(\\theta) = \\frac{1}{\\sqrt{2^n n! \\sqrt{\\pi}}} e^{-\\theta^2/2} H_n(\\theta)$. Substituting this expansion into the eigenvalue equation and taking the inner product $\\langle \\varphi_m, \\cdot \\rangle = \\int_{-\\infty}^\\infty \\varphi_m(\\theta) (\\cdot) d\\theta$ yields a matrix eigenvalue problem $L \\mathbf{c} = \\lambda \\mathbf{c}$, where $\\mathbf{c} = [c_0, c_1, \\dots, c_{N-1}]^T$ and $L$ is an $N \\times N$ matrix with elements $L_{mn} = \\langle \\varphi_m, \\mathcal{L} \\varphi_n \\rangle$.\nThe matrix elements are:\n$$\nL_{mn} = \\int_{-\\infty}^{\\infty} \\varphi_m(\\theta) \\left[ -\\frac{d^2}{d \\theta^2} + \\left(s^2 + \\frac{\\alpha}{2}\\right) \\theta^2 - \\alpha \\right] \\varphi_n(\\theta) \\, d\\theta\n$$\nWe can compute the matrix elements of the operators $-\\frac{d^2}{d\\theta^2}$ and $\\theta^2$ in the Hermite basis. These basis functions are the eigenfunctions of the standard QHO Hamiltonian $H_{QHO} = -\\frac{1}{2}\\frac{d^2}{d\\theta^2} + \\frac{1}{2}\\theta^2$, satisfying $H_{QHO} \\varphi_n = (n+1/2)\\varphi_n$. This implies $\\left(-\\frac{d^2}{d\\theta^2} + \\theta^2\\right)\\varphi_n = (2n+1)\\varphi_n$. Using this identity and the orthonormality relation $\\langle \\varphi_m, \\varphi_n \\rangle = \\delta_{mn}$, we can find the separate matrix elements. A more direct method uses the ladder operators $a$ and $a^\\dag$, defined such that $\\theta = \\frac{1}{\\sqrt{2}}(a+a^\\dag)$ and $\\frac{d}{d\\theta} = \\frac{1}{\\sqrt{2}}(a^\\dag-a)$. The actions on the basis states are $a\\varphi_n = \\sqrt{n}\\varphi_{n-1}$ and $a^\\dag\\varphi_n = \\sqrt{n+1}\\varphi_{n+1}$.\nThe matrix elements for $\\theta^2$ are found to be:\n$$\n\\langle \\varphi_m, \\theta^2 \\varphi_n \\rangle = \\frac{1}{2} \\left[ (2n+1)\\delta_{mn} + \\sqrt{n(n-1)}\\delta_{m,n-2} + \\sqrt{(n+1)(n+2)}\\delta_{m,n+2} \\right]\n$$\nAnd for the kinetic operator:\n$$\n\\left\\langle \\varphi_m, -\\frac{d^2}{d\\theta^2} \\varphi_n \\right\\rangle = \\frac{1}{2} \\left[ (2n+1)\\delta_{mn} - \\sqrt{n(n-1)}\\delta_{m,n-2} - \\sqrt{(n+1)(n+2)}\\delta_{m,n+2} \\right]\n$$\nCombining these to form $L_{mn}$, with $K = s^2 + \\alpha/2$:\n$$\nL_{mn} = \\left\\langle \\varphi_m, -\\frac{d^2}{d\\theta^2} \\varphi_n \\right\\rangle + K \\langle \\varphi_m, \\theta^2 \\varphi_n \\rangle - \\alpha \\langle \\varphi_m, \\varphi_n \\rangle\n$$\nSubstituting the expressions and simplifying gives the non-zero elements of the symmetric matrix $L$:\n$$\nL_{nn} = \\frac{1+K}{2}(2n+1) - \\alpha\n$$\n$$\nL_{n,n+2} = L_{n+2,n} = \\frac{K-1}{2}\\sqrt{(n+1)(n+2)}\n$$\nThe operator $\\mathcal{L}$ preserves parity, so it does not couple basis functions of different parity (even $n$ with odd $n$). This results in a block-diagonal matrix $L$, one block for even indices and one for odd indices. The ground-state eigenfunction has even parity, so its eigenvalue will be the lowest eigenvalue of the even-index submatrix. Numerically, we can construct the full $N \\times N$ matrix and find its lowest eigenvalue, $\\lambda_0^{(N)}$.\n\nThe numerical procedure is as follows:\n1. For each parameter set $(s, \\alpha)$ and basis size $N$, calculate $K = s^2 + \\alpha/2$.\n2. Construct the $N \\times N$ symmetric matrix $L$ using the formulas for $L_{nn}$ and $L_{n,n+2}$.\n3. Compute all real eigenvalues of $L$ using a standard numerical library function for symmetric matrices.\n4. The smallest of these eigenvalues is the numerical approximation of the ground-state eigenvalue, $\\lambda_0^{(N)}$.\n5. Calculate the exact eigenvalue $\\lambda_0 = \\sqrt{K} - \\alpha$.\n6. The absolute error is computed as $|\\lambda_0^{(N)} - \\lambda_0|$.\nFor the special case where $K=1$, the off-diagonal terms vanish, making $L$ a diagonal matrix. The basis functions $\\varphi_n$ are the exact eigenfunctions of $\\mathcal{L}$, and the eigenvalues are simply the diagonal entries $L_{nn}$. In this case, the numerical result is exact, and the error will be zero up to machine precision. This is tested in case 5. For other cases, convergence is expected, meaning the error will decrease as the basis size $N$ increases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_spectral_matrix(s, alpha, N):\n    \"\"\"\n    Builds the spectral matrix for the ballooning eigenvalue problem.\n\n    Args:\n        s (float): Magnetic shear parameter.\n        alpha (float): Normalized pressure gradient parameter.\n        N (int): Basis size (number of Hermite functions).\n\n    Returns:\n        numpy.ndarray: The N x N spectral matrix L.\n    \"\"\"\n    L = np.zeros((N, N))\n    \n    # K is the coefficient of the quadratic potential term\n    K = s**2 + alpha / 2.0\n    \n    # Diagonal elements L_nn\n    # L_nn = 0.5 * (1 + K) * (2n + 1) - alpha\n    n_vals = np.arange(N)\n    diagonal_vals = 0.5 * (1 + K) * (2 * n_vals + 1) - alpha\n    np.fill_diagonal(L, diagonal_vals)\n\n    # Off-diagonal elements L_{n, n+2} and L_{n+2, n}\n    # L_{n,n+2} = 0.5 * (K - 1) * sqrt((n+1)(n+2))\n    if N > 2:\n        off_diag_coeff = 0.5 * (K - 1)\n        if off_diag_coeff != 0: # Avoid unnecessary computation if K=1\n            for n in range(N - 2):\n                val = off_diag_coeff * np.sqrt((n + 1.0) * (n + 2.0))\n                L[n, n + 2] = val\n                L[n + 2, n] = val\n            \n    return L\n\ndef solve():\n    \"\"\"\n    Executes the main logic to solve the problem for the given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_params = [\n        (1.0, 0.5),   # 1. general case\n        (0.5, 2.5),   # 2. negative eigenvalue case\n        (2.8, 0.4),   # 3. large effective curvature\n        (0.1, 0.1),   # 4. near-marginal curvature\n        (0.9, 0.38),  # 5. s^2+alpha/2 = 1 case\n    ]\n    basis_sizes = [4, 8, 16, 32]\n\n    all_results = []\n    \n    for s, alpha in test_params:\n        case_errors = []\n        \n        # Calculate the exact ground-state eigenvalue\n        lambda_exact = np.sqrt(s**2 + alpha / 2.0) - alpha\n        \n        for N in basis_sizes:\n            # Build the spectral matrix L\n            L = build_spectral_matrix(s, alpha, N)\n            \n            # Compute eigenvalues of the symmetric matrix L.\n            # eigvalsh is efficient for real symmetric matrices.\n            eigenvalues = np.linalg.eigvalsh(L)\n            \n            # The lowest eigenvalue is the numerical ground-state eigenvalue.\n            lambda_numeric = np.min(eigenvalues)\n            \n            # Calculate and store the absolute error, rounded to 10 decimal places.\n            error = np.abs(lambda_numeric - lambda_exact)\n            case_errors.append(round(error, 10))\n            \n        all_results.append(case_errors)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, with no spaces.\n    # str() of a list of lists gives almost the right format, just with spaces.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}