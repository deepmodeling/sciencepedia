{
    "hands_on_practices": [
        {
            "introduction": "驱动捕获电子模（TEM）不稳定性的自由能来源于等离子体密度和温度的空间梯度。第一个练习提供了一个量化这种驱动的基本实践。通过计算不同密度分布下的电子抗磁漂移频率 $\\omega_{*e}$，你将直接、定量地理解等离子体加料策略如何增强或抑制TEM的生长条件 。",
            "id": "4207235",
            "problem": "考虑一个大环径比托卡马克，其磁场大小为 $B$，小半径为 $a$，电子具有径向均匀的电子温度 $T_e$（即 $dT_e/dr \\approx 0$）。假设磁场在局部近似为直线且均匀（这在微观不稳定性的球囊表示中是有效的），并且密度梯度是捕获电子模（TEM）不稳定性的主要自由能来源。设副法向波数为 $k_y$（垂直于磁场并与电子逆磁漂移方向对齐）。电子密度梯度标长 $L_n$ 定义为 $L_n \\equiv -\\left(d\\ln n_e/dr\\right)^{-1}$，因此较大的 $a/L_n$ 表示更强的密度尖峰化。\n\n从第一性原理出发，使用导心漂移和压强平衡将电子逆磁漂移频率 $\\omega_{*e}$ 与密度梯度联系起来，然后计算并解释在两种加料情景下 $\\omega_{*e}$ 如何变化：\n- 情景F（通过芯部加料使剖面平坦化）：$a/L_n = 0.5$，\n- 情景P（密度尖峰化）：$a/L_n = 2.0$。\n\n所有其他参数保持不变：$B = 3\\,\\mathrm{T}$，$a = 0.6\\,\\mathrm{m}$，$T_e = 2.5\\,\\mathrm{keV}$ 以及 $k_y = 40\\,\\mathrm{m}^{-1}$。只考虑密度梯度对逆磁漂移频率的贡献，并忽略温度梯度效应。您可以假设 $p_e \\simeq n_e T_e$ 以及局部坐标系为 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$ 和 $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$，因此 $\\mathbf{B} \\times \\nabla p_e$ 指向 $\\hat{\\mathbf{y}}$ 方向。\n\n基于这些假设和定义进行推导，选择一个选项，该选项既正确给出了情景F和情景P下 $\\omega_{*e}$ 的数值，又正确给出了从情景F到情景P，TEM驱动如何响应的物理预测。\n\nA. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx -1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$；情景P中频率幅值的增加会增强TEM驱动（更强的电子逆磁方向传播和更大的自由能注入）。\n\nB. $\\omega_{*e}(F) \\approx +2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx +1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$；变为正号意味着情景P中TEM驱动减弱，因为该模式不再沿电子逆磁方向传播。\n\nC. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{2}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx -1.11 \\times 10^{3}\\,\\mathrm{s}^{-1}$；密度尖峰化降低了TEM驱动，因为较低的频率减弱了与捕获电子的共振。\n\nD. $\\omega_{*e}(F) \\approx -1.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx -6.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$；加料主要改变离子逆磁频率 $\\omega_{*i}$，因此TEM驱动对从情景F到情景P的变化不敏感。",
            "solution": "用户要求对问题陈述进行严格验证，然后从第一性原理推导解决方案，并对所提供的选项进行评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题陈述提供了以下信息：\n-   **系统**：一个大环径比托卡马克。\n-   **磁场**：大小为 $B$，局部近似为直线且均匀，$\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$。\n-   **几何**：小半径 $a$。\n-   **电子**：\n    -   径向均匀的电子温度 $T_e$，意味着 $dT_e/dr \\approx 0$。\n    -   电子密度 $n_e$。\n    -   电子压强 $p_e \\simeq n_e T_e$。\n    -   压强梯度 $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$。\n-   **不稳定性**：捕获电子模（TEM），以密度梯度为主要自由能来源。\n-   **定义**：\n    -   密度梯度标长：$L_n \\equiv -\\left(d\\ln n_e/dr\\right)^{-1}$。\n    -   副法向波数：$k_y$，垂直于 $\\mathbf{B}$ 并与电子逆磁漂移方向对齐。\n    -   坐标系引申：$\\mathbf{B} \\times \\nabla p_e$ 指向 $\\hat{\\mathbf{y}}$ 方向。\n-   **情景**：\n    -   情景F（平坦化）：$a/L_n = 0.5$。\n    -   情景P（尖峰化）：$a/L_n = 2.0$。\n-   **数值**：\n    -   $B = 3\\,\\mathrm{T}$。\n    -   $a = 0.6\\,\\mathrm{m}$。\n    -   $T_e = 2.5\\,\\mathrm{keV}$。\n    -   $k_y = 40\\,\\mathrm{m}^{-1}$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n根据既定标准对问题进行评估：\n\n-   **科学依据**：该问题基于等离子体物理学的基本概念，特别是托卡马克等离子体中像捕获电子模（TEM）这样的漂移波不稳定性的理论。局域平板近似以及逆磁频率和梯度标长的定义是该领域的标准做法。该设置在科学上是合理的。\n-   **适定性**：问题提供了所有必要的参数和定义，以便在指定条件下推导出电子逆磁漂移频率 $\\omega_{*e}$ 的唯一数值解。\n-   **客观性**：问题使用了精确的、定量的语言进行陈述。\n-   **潜在歧义分析**：关于波数 $k_y$ 的符号可能存在混淆。让我们对此进行严格分析。\n    1.  局部坐标系定义为 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$ 且 $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$。对于一个典型的向外压强递减的托卡马克剖面，$\\frac{dp_e}{dr}  0$，所以我们可以写成 $\\nabla p_e = (\\frac{dp_e}{dr})\\hat{\\mathbf{x}}$。\n    2.  向量 $\\mathbf{B} \\times \\nabla p_e$ 计算为 $B\\hat{\\mathbf{z}} \\times (\\frac{dp_e}{dr})\\hat{\\mathbf{x}} = B\\frac{dp_e}{dr}(\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = B\\frac{dp_e}{dr}\\hat{\\mathbf{y}}$。因为 $\\frac{dp_e}{dr}  0$，该向量指向 $-\\hat{\\mathbf{y}}$ 方向。\n    3.  问题陈述中说“$\\mathbf{B} \\times \\nabla p_e$ 指向 $\\hat{\\mathbf{y}}$ 方向”。这意味着局部坐标系的设置使得 $dp_e/dr  0$，或者 $\\hat{\\mathbf{x}}$ 轴指向内部。这是一个非标准的选择，但在数学上是一致的。我们将遵循问题的明确陈述：$\\mathbf{B} \\times \\nabla p_e$ 在 $+\\hat{\\mathbf{y}}$ 方向。\n    4.  电子逆磁漂移速度为 $\\mathbf{v}_{*e} = \\frac{\\mathbf{B} \\times \\nabla p_e}{q_e n_e B^2}$。由于电子电荷 $q_e = -e$，我们有 $\\mathbf{v}_{*e} = -\\frac{\\mathbf{B} \\times \\nabla p_e}{e n_e B^2}$。\n    5.  因为 $\\mathbf{B} \\times \\nabla p_e$ 在 $+\\hat{\\mathbf{y}}$ 方向，所以电子逆磁漂移速度 $\\mathbf{v}_{*e}$ 在 $-\\hat{\\mathbf{y}}$ 方向。这就是“电子逆磁漂移方向”。\n    6.  问题陈述中说副法向波数 $k_y$ “与电子逆磁漂移方向对齐”。这意味着波矢 $\\mathbf{k}_{\\perp}$ 指向 $-\\hat{\\mathbf{y}}$ 方向。\n    7.  符号 $k_y$ 表示波矢在 $\\hat{\\mathbf{y}}$ 方向上的分量。因此，$k_y$ 必须为负。给定的值 $k_y = 40\\,\\mathrm{m}^{-1}$ 必须被解释为波数的模，即 $|k_y|$。因此，在我们的计算中，必须使用 $k_y = -40\\,\\mathrm{m}^{-1}$。\n\n通过仔细阅读，解决了这个潜在的矛盾。问题本身没有缺陷，但需要严谨地应用所提供的定义。\n\n**步骤3：结论与行动**\n\n只要对定义进行足够严谨的解释，问题陈述就是有效的、自洽的并且适定的。我们可以继续进行求解。\n\n### 解题推导\n\n电子逆磁漂移频率 $\\omega_{*e}$ 是表征漂移波的一个基本量。它由电子逆磁漂移导出。对于粒子种类 $\\alpha$，逆磁频率的一般表达式为：\n$$ \\omega_{*\\alpha} = \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{*\\alpha} $$\n其中 $\\mathbf{k}_{\\perp}$ 是垂直于磁场的波矢，$\\mathbf{v}_{*\\alpha}$ 是粒子种类 $\\alpha$ 的逆磁漂移速度。在指定的坐标系中，$\\mathbf{k}_{\\perp} = k_y \\hat{\\mathbf{y}}$。\n\n电子逆磁漂移速度 $\\mathbf{v}_{*e}$ 由下式给出：\n$$ \\mathbf{v}_{*e} = \\frac{\\mathbf{B} \\times \\nabla p_e}{q_e n_e B^2} = -\\frac{\\mathbf{B} \\times \\nabla p_e}{e n_e B^2} $$\n问题陈述中指出 $\\nabla p_e \\parallel \\hat{\\mathbf{x}}$ 且 $\\mathbf{B} \\parallel \\hat{\\mathbf{z}}$。设 $\\nabla p_e = \\frac{dp_e}{dr}\\hat{\\mathbf{x}}$。\n$$ \\mathbf{B} \\times \\nabla p_e = (B\\hat{\\mathbf{z}}) \\times \\left(\\frac{dp_e}{dr}\\hat{\\mathbf{x}}\\right) = B\\frac{dp_e}{dr}\\hat{\\mathbf{y}} $$\n因此，漂移速度为：\n$$ \\mathbf{v}_{*e} = -\\frac{B(dp_e/dr)\\hat{\\mathbf{y}}}{e n_e B^2} = -\\frac{1}{e n_e B}\\frac{dp_e}{dr}\\hat{\\mathbf{y}} $$\n问题陈述中 $T_e$ 是均匀的，所以 $\\nabla p_e = \\nabla(n_e T_e) = T_e \\nabla n_e$。并且，$\\nabla n_e = \\frac{dn_e}{dr}\\hat{\\mathbf{x}}$。\n密度梯度标长定义为 $L_n \\equiv -(d\\ln n_e/dr)^{-1} = -n_e/(dn_e/dr)$。这意味着 $\\frac{dn_e}{dr} = -\\frac{n_e}{L_n}$。\n将这些代入压强梯度的表达式中：\n$$ \\frac{dp_e}{dr} = T_e \\frac{dn_e}{dr} = -\\frac{n_e T_e}{L_n} $$\n电子逆磁漂移速度变为：\n$$ \\mathbf{v}_{*e} = -\\frac{1}{e n_e B} \\left(-\\frac{n_e T_e}{L_n}\\right) \\hat{\\mathbf{y}} = \\frac{T_e}{e B L_n} \\hat{\\mathbf{y}} $$\n于是逆磁频率为：\n$$ \\omega_{*e} = \\mathbf{k}_{\\perp} \\cdot \\mathbf{v}_{*e} = (k_y \\hat{\\mathbf{y}}) \\cdot \\left(\\frac{T_e}{e B L_n} \\hat{\\mathbf{y}}\\right) = \\frac{k_y T_e}{e B L_n} $$\n正如在验证步骤中确定的，问题陈述要求 $k_y = -40\\,\\mathrm{m}^{-1}$。参数 $L_n$ 可以用给定物理量表示为 $L_n = a / (a/L_n)$。将其代入 $\\omega_{*e}$ 的公式中：\n$$ \\omega_{*e} = \\frac{k_y T_e}{e B a} \\left(\\frac{a}{L_n}\\right) $$\n现在，我们可以计算数值。\n参数如下：\n-   $k_y = -40\\,\\mathrm{m}^{-1}$\n-   $T_e = 2.5\\,\\mathrm{keV} = 2.5 \\times 10^3\\,\\mathrm{eV} \\times (1.602177 \\times 10^{-19}\\,\\mathrm{J/eV}) \\approx 4.0054 \\times 10^{-16}\\,\\mathrm{J}$\n-   $e = 1.602177 \\times 10^{-19}\\,\\mathrm{C}$\n-   $B = 3\\,\\mathrm{T}$\n-   $a = 0.6\\,\\mathrm{m}$\n\n或者，我们可以用电子伏特表示温度，并利用 $T_e[\\mathrm{J}]/e = T_e[\\mathrm{V}]$ 这一事实。所以，$T_e/e = 2500\\,\\mathrm{V}$。\n让我们计算预因子项 $\\frac{k_y T_e}{e B a}$：\n$$ \\frac{k_y (T_e/e)}{B a} = \\frac{(-40\\,\\mathrm{m}^{-1}) \\times (2500\\,\\mathrm{V})}{(3\\,\\mathrm{T}) \\times (0.6\\,\\mathrm{m})} = \\frac{-100000\\,\\mathrm{V/m}}{1.8\\,\\mathrm{T \\cdot m}} \\approx -55555.5\\,\\mathrm{s}^{-1} = -5.556 \\times 10^4\\,\\mathrm{s}^{-1} $$\n\n现在，我们为每种情景计算 $\\omega_{*e}$：\n-   **情景F（平坦化）：$a/L_n = 0.5$**\n    $$ \\omega_{*e}(F) = (-5.556 \\times 10^4\\,\\mathrm{s}^{-1}) \\times 0.5 = -2.778 \\times 10^4\\,\\mathrm{s}^{-1} $$\n-   **情景P（尖峰化）：$a/L_n = 2.0$**\n    $$ \\omega_{*e}(P) = (-5.556 \\times 10^4\\,\\mathrm{s}^{-1}) \\times 2.0 = -11.112 \\times 10^4\\,\\mathrm{s}^{-1} = -1.111 \\times 10^5\\,\\mathrm{s}^{-1} $$\n\n物理上的解释是，较大的 $a/L_n$ 值对应于更陡峭、更“尖峰”的密度剖面。这种更陡峭的梯度代表了像TEM这样由梯度驱动的不稳定性的更大自由能来源。因此，从情景F到情景P，即 $a/L_n$ 增加了四倍，应该会显著增强TEM的驱动。这反映在 $\\omega_{*e}$ 的幅值增加了四倍上。\n\n### 逐项分析\n\n**A. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx -1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$；情景P中频率幅值的增加会增强TEM驱动（更强的电子逆磁方向传播和更大的自由能注入）。**\n-   **数值**：计算出的值 $\\omega_{*e}(F) \\approx -2.78 \\times 10^4\\,\\mathrm{s}^{-1}$ 和 $\\omega_{*e}(P) \\approx -1.11 \\times 10^5\\,\\mathrm{s}^{-1}$ 与我们的推导非常吻合。\n-   **物理释义**：该解释是正确的。从F到P的转变涉及密度梯度（$a/L_n$）的增加，这增加了TEM可用的自由能。这反映在 $\\omega_{*e}$ 幅值的增加上，并导致更强的不稳定性驱动。“更强的电子逆磁方向传播”这一措辞正确地将更高的频率幅值与更快的模式传播联系起来。\n-   **结论**：**正确**。\n\n**B. $\\omega_{*e}(F) \\approx +2.78 \\times 10^{4}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx +1.11 \\times 10^{5}\\,\\mathrm{s}^{-1}$；变为正号意味着情景P中TEM驱动减弱，因为该模式不再沿电子逆磁方向传播。**\n-   **数值**：符号为正，这与我们基于问题明确定义的严格推导相矛盾，我们的推导得出 $k_y  0$，因此 $\\omega_{*e}  0$。\n-   **物理释义**：其推理存在根本性缺陷。这里没有“符号反转”；两个值符号相同。$\\omega_{*e}$ 幅值的增加意味着*更强*的驱动，而不是减弱。最后，频率的符号决定了传播方向；根据定义，TEM在电子逆磁方向上传播。非零频率（正或负，取决于约定）是该模式存在的必要条件，而不是其驱动减弱的原因。\n-   **结论**：**不正确**。\n\n**C. $\\omega_{*e}(F) \\approx -2.78 \\times 10^{2}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx -1.11 \\times 10^{3}\\,\\mathrm{s}^{-1}$；密度尖峰化降低了TEM驱动，因为较低的频率减弱了与捕获电子的共振。**\n-   **数值**：数值错了两个数量级（$10^2$）。\n-   **物理释义**：该解释是不正确的。密度尖峰化（更强的梯度）*增强*了TEM驱动，而不是减弱它。\n-   **结论**：**不正确**。\n\n**D. $\\omega_{*e}(F) \\approx -1.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$ 且 $\\omega_{*e}(P) \\approx -6.67 \\times 10^{4}\\,\\mathrm{s}^{-1}$；加料主要改变离子逆磁频率 $\\omega_{*i}$，因此TEM驱动对从情景F到情景P的变化不敏感。**\n-   **数值**：数值不正确。我们的计算是可靠的。\n-   **物理释义**：该推理是不正确的。捕获电子模（TEM）从根本上与电子逆磁漂移和电子压强梯度相关联。因此，其驱动对密度梯度的变化高度敏感，而密度梯度直接影响 $\\omega_{*e}$。声称其不敏感与该不稳定性的性质相悖。\n-   **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "任何不稳定性的增长都是驱动力与稳定效应之间的精细平衡。在梯度驱动概念的基础上，本练习探讨了离子响应的稳定作用，它如同一个“屏蔽层”来抑制不稳定性。你将使用一个简化模型来研究电子与离子的温度比 $\\tau = T_e/T_i$ 如何改变这种屏蔽效应，并最终影响TEM的增长率 。",
            "id": "4207273",
            "problem": "考虑在托卡马克芯部等离子体中对捕获电子模（TEM）进行局域、静电、无碰撞的线性分析。将离子作回旋动理学处理，考虑有限拉莫尔半径极化效应；将电子视为绝热通行电子和非绝热捕获电子的混合体。假设存在一个单谐波微扰，其垂直波数为 $k_{\\perp}$，副法向波数为 $k_{y}$，且 $k_{\\perp} \\simeq k_{y}$。以下基本定义和事实适用：\n- 准中性要求 $\\sum_{s} q_{s} \\delta n_{s} = 0$。\n- 通行电子的密度响应是绝热的，$\\delta n_{e,\\mathrm{pass}}/n_{0} = (1 - f_{t}) \\, (e \\phi/T_{e})$，其中 $f_{t}$ 是捕获电子份额，$\\phi$ 是静电势。\n- 离子的回旋动理学极化密度响应为 $\\delta n_{i}/n_{0} = (e \\phi/T_{i}) \\, \\left[1 - \\Gamma_{0}(b_{i})\\right]$，其中 $b_{i} \\equiv k_{\\perp}^{2} \\rho_{i}^{2}$，$\\rho_{i} \\equiv \\sqrt{T_{i} m_{i}}/(e B)$ 是离子拉莫尔半径，$m_{i}$ 是离子质量，$B$ 是磁场强度，$e$ 是元电荷，$\\Gamma_{0}(b)$ 是回旋平均，对于 $b \\ll 1$，其小 $b$ 展开为 $\\Gamma_{0}(b) \\simeq 1 - b$。\n- 捕获电子的非绝热驱动源于电子温度梯度和抗磁漂移，其抗磁频率为 $\\omega_{\\ast e} \\equiv - k_{y} T_{e}/(e B L_{n})$，电子温度梯度参数为 $\\eta_{e} \\equiv L_{n}/L_{T_{e}}$，其中 $L_{n} \\equiv - \\left(d \\ln n_{0}/dx\\right)^{-1}$ 且 $L_{T_{e}} \\equiv - \\left(d \\ln T_{e}/dx\\right)^{-1}$。在一个能够描述线性TEM驱动的流体闭合模型中，捕获电子对净驱动的贡献标度为 $f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}$。\n将密度归一化到 $e \\phi/T_{e}$，这样离子极化项就乘以电子-离子温度比 $\\tau \\equiv T_{e}/T_{i}$。在这些假设下，线性增长率 $\\gamma$ 的标度关系为捕获电子驱动与总屏蔽（通行电子绝热响应加离子极化）之比：\n$$\n\\gamma(\\tau) \\propto \\frac{f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}}{1 + \\tau \\left[1 - \\Gamma_{0}(b_{i})\\right]} \\, ,\n$$\n其中 $\\omega_{\\ast e} \\propto T_{e}$，因此 $\\gamma(\\tau)$ 具有如下形式\n$$\n\\gamma(\\tau) = C \\, \\frac{\\tau}{1 + \\tau \\, b_{i}} \\, ,\n$$\n其中 $C$ 是一个不依赖于 $\\tau$ 但可能依赖于 $k_{y}$、$L_{n}$、$f_{t}$、$\\eta_{e}$、$T_{i}$ 和平衡参数的常数。\n\n你的任务：\n1. 从上述基本定义和准中性条件出发，使用小 $b_{i}$ 近似 $\\Gamma_{0}(b_{i}) \\simeq 1 - b_{i}$ 和正比关系 $\\omega_{\\ast e} \\propto T_{e}$，推导标度关系 $\\gamma(\\tau) = C \\, \\tau/(1 + \\tau \\, b_{i})$。\n2. 使用推导出的 $\\gamma(\\tau)$，计算当电子-离子温度比从 $\\tau = 1$ 加倍到 $\\tau = 2$ 时增长率的乘性变化，即比值\n$$\nR \\equiv \\frac{\\gamma(2)}{\\gamma(1)} = \\frac{2 \\left(1 + b_{i}\\right)}{1 + 2 b_{i}} \\, .\n$$\n对于以下参数，计算 $R$ 的值：\n- 磁场 $B = 2.0 \\, \\mathrm{T}$。\n- 离子温度 $T_{i} = 1.602 \\times 10^{-16} \\, \\mathrm{J}$（对应 $1.0 \\, \\mathrm{keV}$）。\n- 氘离子质量 $m_{i} = 3.345 \\times 10^{-27} \\, \\mathrm{kg}$。\n- 元电荷 $e = 1.602 \\times 10^{-19} \\, \\mathrm{C}$。\n- 垂直波数 $k_{\\perp} = 100 \\, \\mathrm{m}^{-1}$。\n使用 $b_{i} \\equiv k_{\\perp}^{2} \\rho_{i}^{2}$ 和 $\\rho_{i} \\equiv \\sqrt{T_{i} m_{i}}/(e B)$ 并假设 $k_{\\perp} \\simeq k_{y}$。将最终的无量纲比值 $R$ 表示为一个无单位的纯数，并将你的答案四舍五入到三位有效数字。",
            "solution": "问题陈述已经过分析，并被认为是有效的。它在科学上基于等离子体物理学原理，特别是磁约束聚变等离子体中微观不稳定性的线性稳定性理论。该问题是适定的，为得到唯一解提供了所有必要的数据和定义。参数在物理上是现实的，并且所引用的近似（例如，小拉莫尔半径）也由这些参数证明是合理的。任务清晰、无矛盾，且需要直接应用所提供的理论框架。\n\n根据要求，解答过程分为两个主要部分：首先是推导增长率的标度关系，其次是计算比值 $R$。\n\n### 第一部分：增长率标度关系的推导\n\n我们已知捕获电子模（TEM）的线性增长率 $\\gamma$ 作为电子-离子温度比 $\\tau \\equiv T_{e}/T_{i}$ 的函数的标度关系为：\n$$\n\\gamma(\\tau) \\propto \\frac{f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}}{1 + \\tau \\left[1 - \\Gamma_{0}(b_{i})\\right]}\n$$\n该关系将增长率建模为与不稳定性驱动（分子）与稳定化屏蔽效应（分母）之比成正比。我们的任务是通过应用给定的近似，证明这会导致 $\\gamma(\\tau) = C \\, \\frac{\\tau}{1 + \\tau \\, b_{i}}$ 的形式。\n\n我们分别分析分子和分母，以确定它们对 $\\tau$ 的依赖关系。\n\n**分子分析：**\n代表驱动的分子是 $f_{t} \\, \\eta_{e} \\, \\omega_{\\ast e}$。参数 $f_t$（捕获电子份额）和 $\\eta_e$（密度与温度梯度长度之比）被视为相对于 $\\tau$ 的常数。电子抗磁频率 $\\omega_{\\ast e}$ 定义为 $\\omega_{\\ast e} \\equiv - k_{y} T_{e}/(e B L_{n})$。\n问题陈述我们正在分析改变 $T_e$ 的影响，而其他平衡参数如 $T_i$、$B$、$L_n$ 和 $k_y$ 保持不变。温度比为 $\\tau = T_e/T_i$，这意味着 $T_e = \\tau T_i$。\n鉴于 $\\omega_{\\ast e} \\propto T_e$ 的正比关系，我们可以写出：\n$$\n\\omega_{\\ast e} \\propto \\tau\n$$\n因此，整个分子与 $\\tau$ 呈线性标度关系：\n$$\n\\text{分子} \\propto f_{t} \\, \\eta_{e} \\, \\tau \\propto \\tau\n$$\n\n**分母分析：**\n代表屏蔽的分母是 $1 + \\tau \\left[1 - \\Gamma_{0}(b_{i})\\right]$。\n根据指示，我们对 $b_i \\ll 1$ 的离子回旋平均函数 $\\Gamma_{0}(b_i)$ 使用小自变量展开：\n$$\n\\Gamma_{0}(b_i) \\simeq 1 - b_i\n$$\n这里，$b_i = k_{\\perp}^2 \\rho_i^2 = k_{\\perp}^2 \\frac{T_i m_i}{(eB)^2}$ 与 $T_e$ 无关，因此也与 $\\tau$ 无关。\n将此近似代入分母：\n$$\n\\text{分母} \\simeq 1 + \\tau \\left[1 - (1 - b_i)\\right] = 1 + \\tau \\left[b_i\\right] = 1 + \\tau b_i\n$$\n\n**结合结果：**\n通过结合分子和分母的标度关系，我们得到增长率 $\\gamma(\\tau)$ 的标度关系：\n$$\n\\gamma(\\tau) \\propto \\frac{\\tau}{1 + \\tau b_i}\n$$\n通过引入一个与 $\\tau$ 无关但包含所有其他参数（$f_t, \\eta_e, k_y, L_n, B, T_i, m_i$ 等）的常数 $C$，可以将此正比关系表示为等式：\n$$\n\\gamma(\\tau) = C \\frac{\\tau}{1 + \\tau b_i}\n$$\n这完成了问题第一部分要求的推导。\n\n### 第二部分：比值 R 的计算\n\n第二个任务是计算当 $\\tau$ 从 $\\tau=1$ 加倍到 $\\tau=2$ 时，增长率的乘性变化，即比值 $R$。\n比值 $R$ 定义为：\n$$\nR \\equiv \\frac{\\gamma(2)}{\\gamma(1)}\n$$\n使用推导出的 $\\gamma(\\tau)$ 表达式：\n$$\n\\gamma(2) = C \\frac{2}{1 + 2 b_i}\n$$\n$$\n\\gamma(1) = C \\frac{1}{1 + (1) b_i} = C \\frac{1}{1 + b_i}\n$$\n因此，比值 $R$ 为：\n$$\nR = \\frac{\\gamma(2)}{\\gamma(1)} = \\frac{C \\frac{2}{1 + 2 b_i}}{C \\frac{1}{1 + b_i}} = \\frac{2}{1 + 2 b_i} \\cdot (1 + b_i) = \\frac{2(1 + b_i)}{1 + 2 b_i}\n$$\n这与问题陈述中提供的表达式相符，从而证实了我们推导的一致性。\n\n为了数值计算 $R$，我们必须首先计算无量纲参数 $b_i$。\n$$\nb_i = k_{\\perp}^2 \\rho_i^2\n$$\n其中离子拉莫尔半径的平方 $\\rho_i^2$ 由下式给出：\n$$\n\\rho_i^2 = \\frac{T_i m_i}{(eB)^2}\n$$\n给定的参数均为国际单位制（SI）单位：\n- 磁场 $B = 2.0 \\, \\mathrm{T}$\n- 离子温度 $T_{i} = 1.602 \\times 10^{-16} \\, \\mathrm{J}$\n- 氘离子质量 $m_{i} = 3.345 \\times 10^{-27} \\, \\mathrm{kg}$\n- 元电荷 $e = 1.602 \\times 10^{-19} \\, \\mathrm{C}$\n- 垂直波数 $k_{\\perp} = 100 \\, \\mathrm{m}^{-1}$\n\n首先，我们计算 $\\rho_i^2$：\n$$\n\\rho_i^2 = \\frac{(1.602 \\times 10^{-16} \\, \\mathrm{J})(3.345 \\times 10^{-27} \\, \\mathrm{kg})}{((1.602 \\times 10^{-19} \\, \\mathrm{C})(2.0 \\, \\mathrm{T}))^2} = \\frac{5.35869 \\times 10^{-43} \\, \\mathrm{kg} \\cdot \\mathrm{J}}{(3.204 \\times 10^{-19} \\, \\mathrm{C} \\cdot \\mathrm{T})^2}\n$$\n$$\n\\rho_i^2 = \\frac{5.35869 \\times 10^{-43}}{1.0265616 \\times 10^{-37}} \\, \\mathrm{m}^2 \\approx 5.220138 \\times 10^{-6} \\, \\mathrm{m}^2\n$$\n接下来，我们计算 $b_i$：\n$$\nb_i = k_{\\perp}^2 \\rho_i^2 = (100 \\, \\mathrm{m}^{-1})^2 (5.220138 \\times 10^{-6} \\, \\mathrm{m}^2) = (10^4 \\, \\mathrm{m}^{-2})(5.220138 \\times 10^{-6} \\, \\mathrm{m}^2)\n$$\n$$\nb_i \\approx 0.05220138\n$$\n该值为无量纲，且 $b_i \\ll 1$，这验证了使用 $\\Gamma_0$ 的小自变量近似的合理性。\n\n最后，我们将 $b_i$ 的值代入 $R$ 的表达式中：\n$$\nR = \\frac{2(1 + 0.05220138)}{1 + 2(0.05220138)} = \\frac{2(1.05220138)}{1 + 0.10440276} = \\frac{2.10440276}{1.10440276}\n$$\n$$\nR \\approx 1.905493\n$$\n将结果四舍五入到三位有效数字，我们得到 $1.91$。\n这意味着对于给定的参数，将电子与离子的温度比从1加倍到2，会导致TEM增长率增加约 $91\\%$。",
            "answer": "$$\\boxed{1.91}$$"
        },
        {
            "introduction": "在解析理论和计算科学之间架起桥梁是现代等离子体物理学的一项关键技能。最后一个练习模拟了数值研究中的一个常见任务：测量不稳定性的线性增长率。通过比较与模式结构对齐的初始扰动和随机噪声初始扰动，你将探索一种关键的数值技术，并体会从模拟数据中准确提取物理增长率所面临的挑战 。",
            "id": "4207290",
            "problem": "您正在一个局域、谱、无碰撞、静电回旋动理学设定下，对捕获电子模（TEM）不稳定性的早期线性阶段进行建模。在此设定下，对捕获电子进行弹跳平均并投影到一组有限的基函数上之后，给定副法向波数的线性化动力学可以表示为一个有限维齐次线性常微分方程，形式为 $\\mathrm{d}\\mathbf{x}/\\mathrm{d}t = \\mathbf{A}\\,\\mathbf{x}$。其中，$\\mathbf{x}\\in\\mathbb{C}^N$ 是微扰振幅的状态向量，$\\mathbf{A}\\in\\mathbb{C}^{N\\times N}$ 是一个常复数矩阵，它编码了选定平衡态附近的漂移、曲率和捕获电子动力学。如果 $\\mathbf{A}$ 具有离散谱，其右本征对为 $\\{(\\lambda_j,\\mathbf{v}_j)\\}$，那么一个与本征模对齐的初始条件 $\\mathbf{x}(0)=\\mathbf{v}_j$ 将演化为 $\\mathbf{x}(t)=\\mathrm{e}^{\\lambda_j t}\\mathbf{v}_j$，因此增长率是其实部 $\\Re(\\lambda_j)$。相比之下，一个随机噪声的初始条件 $\\mathbf{x}(0)=\\sum_j c_j \\mathbf{v}_j$ 会激发多个模式，并可能在有限时间窗内对增长率的估计造成偏差，特别是当 $\\mathbf{A}$ 是非正规矩阵或各增长率间距很近时。\n\n您的任务是编写一个程序，对于每个给定的线性算子，构造一个本征模对齐的微扰和一个随机噪声微扰，通过谱方法传播精确模拟它们的线性演化，通过拟合微扰振幅的对数与时间的关系来估计增长率，并报告每个估计值相对于真实主导增长率的绝对误差。所有时间都以离子回旋频率归一化，因此时间的单位是 $1/\\Omega_i$，增长率的单位是 $\\Omega_i$。您必须以 $\\Omega_i$ 为单位，用普通十进制数表示最终的数值答案。\n\n使用的基本原理：线性系统的线性化原理和叠加原理，线性算子的本征值/本征向量的定义，以及通过谱分解求解具有常系数的齐次线性系统的精确解。\n\n对于每个测试用例 $(i=1,2,3)$，算子 $\\mathbf{A}^{(i)}$ 定义为 $\\mathbf{A}^{(i)} = \\mathbf{S}^{(i)} \\mathbf{\\Lambda}^{(i)} \\left(\\mathbf{S}^{(i)}\\right)^{-1}$，其中 $\\mathbf{\\Lambda}^{(i)}$ 是对角矩阵，其元素为 $\\lambda^{(i)}_1,\\lambda^{(i)}_2,\\lambda^{(i)}_3,\\lambda^{(i)}_4$，$\\mathbf{S}^{(i)}$ 是一个可逆实矩阵。矩阵和本征值如下：\n\n测试用例 $i=1$：\n- $\\lambda^{(1)}_1 = 0.12 + \\mathrm{i}\\,0.7$, $\\lambda^{(1)}_2 = 0.05 + \\mathrm{i}\\,0.4$, $\\lambda^{(1)}_3 = -0.02 + \\mathrm{i}\\,0.2$, $\\lambda^{(1)}_4 = -0.08 + \\mathrm{i}\\,0.1$。\n- $\\mathbf{S}^{(1)} = \\begin{pmatrix}\n1.0  0.2  -0.1  0.0 \\\\\n0.1  1.0  0.3  -0.2 \\\\\n0.0  -0.1  1.0  0.1 \\\\\n0.2  0.0  -0.2  1.0\n\\end{pmatrix}$。\n- 时间窗口：在 $t\\in[t^{(1)}_{\\min},t^{(1)}_{\\max}]$ 上拟合，其中 $t^{(1)}_{\\min}=10.0$ 且 $t^{(1)}_{\\max}=40.0$。\n\n测试用例 $i=2$：\n- $\\lambda^{(2)}_1 = 0.10 + \\mathrm{i}\\,0.9$, $\\lambda^{(2)}_2 = 0.095 + \\mathrm{i}\\,0.85$, $\\lambda^{(2)}_3 = 0.0 + \\mathrm{i}\\,0.3$, $\\lambda^{(2)}_4 = -0.06 + \\mathrm{i}\\,0.15$。\n- $\\mathbf{S}^{(2)} = \\begin{pmatrix}\n1.0  -0.3  0.1  0.0 \\\\\n0.2  0.9  -0.2  0.1 \\\\\n0.0  0.1  0.95  -0.3 \\\\\n-0.1  0.0  0.25  1.1\n\\end{pmatrix}$。\n- 时间窗口：在 $t\\in[t^{(2)}_{\\min},t^{(2)}_{\\max}]$ 上拟合，其中 $t^{(2)}_{\\min}=5.0$ 且 $t^{(2)}_{\\max}=35.0$。\n\n测试用例 $i=3$：\n- $\\lambda^{(3)}_1 = 0.08 + \\mathrm{i}\\,0.6$, $\\lambda^{(3)}_2 = 0.06 + \\mathrm{i}\\,0.65$, $\\lambda^{(3)}_3 = 0.02 + \\mathrm{i}\\,0.2$, $\\lambda^{(3)}_4 = -0.05 + \\mathrm{i}\\,0.05$。\n- $\\mathbf{S}^{(3)} = \\begin{pmatrix}\n1.0  1.5  -1.2  0.3 \\\\\n0.0  1.0  1.4  -0.8 \\\\\n0.0  0.0  1.0  0.9 \\\\\n0.0  0.0  0.0  1.0\n\\end{pmatrix}$。\n- 时间窗口：在 $t\\in[t^{(3)}_{\\min},t^{(3)}_{\\max}]$ 上拟合，其中 $t^{(3)}_{\\min}=5.0$ 且 $t^{(3)}_{\\max}=20.0$。\n\n对于每个测试用例 $i$：\n\n1. 从 $\\mathbf{S}^{(i)}$ 和 $\\mathbf{\\Lambda}^{(i)}$ 构造 $\\mathbf{A}^{(i)}$。\n2. 计算真实的主导增长率 $\\gamma^{(i)}_{\\text{true}}=\\max_j \\Re(\\lambda^{(i)}_j)$，单位为 $\\Omega_i$。\n3. 找到与 $\\gamma^{(i)}_{\\text{true}}$ 相关联的 $\\mathbf{A}^{(i)}$ 的右本征向量 $\\mathbf{v}^{(i)}_{\\max}$，并将其归一化到单位 $2$-范数。这定义了本征模对齐的初始条件 $\\mathbf{x}^{(i)}_{\\text{eig}}(0)=\\mathbf{v}^{(i)}_{\\max}$。\n4. 构造一个随机复数初始条件 $\\mathbf{x}^{(i)}_{\\text{rnd}}(0)$，方法是使用每个测试唯一的固定种子（$s^{(1)}=7$，$s^{(2)}=11$，$s^{(3)}=13$）从标准正态分布中独立抽取每个分量的实部和虚部，然后归一化到单位 $2$-范数。\n5. 通过谱解 $\\mathbf{x}(t)=\\mathbf{S}^{(i)} \\exp(\\mathbf{\\Lambda}^{(i)} t) \\left(\\mathbf{S}^{(i)}\\right)^{-1} \\mathbf{x}(0)$ 精确演化每个初始条件 $\\mathbf{x}(0)$，在 $[t^{(i)}_{\\min},t^{(i)}_{\\max}]$ 上以 $N=601$ 个等距时间点进行采样。\n6. 对于每个轨迹，计算振幅 $a(t)=\\|\\mathbf{x}(t)\\|_2$，并通过对采样窗口内的 $\\ln a(t)$ 与 $t$ 进行最小二乘线性拟合来估计增长率 $\\widehat{\\gamma}$。报告 $\\widehat{\\gamma}^{(i)}_{\\text{eig}}$ 和 $\\widehat{\\gamma}^{(i)}_{\\text{rnd}}$。\n7. 对于每种初始化类型，计算相对于真实主导增长率的绝对误差：$E^{(i)}_{\\text{eig}}=\\left|\\widehat{\\gamma}^{(i)}_{\\text{eig}}-\\gamma^{(i)}_{\\text{true}}\\right|$ 和 $E^{(i)}_{\\text{rnd}}=\\left|\\widehat{\\gamma}^{(i)}_{\\text{rnd}}-\\gamma^{(i)}_{\\text{true}}\\right|$。这些误差必须以 $\\Omega_i$ 为单位，用普通十进制数表示。\n\n测试套件和要求输出：\n- 使用上述三个测试用例，以及指定的矩阵、本征值、时间窗口、采样数 $N=601$ 和种子 $s^{(1)}=7, s^{(2)}=11, s^{(3)}=13$。\n- 您的程序应生成单行输出，其中包含六个误差，以逗号分隔的列表形式包含在方括号中，顺序为 $[E^{(1)}_{\\text{eig}},E^{(1)}_{\\text{rnd}},E^{(2)}_{\\text{eig}},E^{(2)}_{\\text{rnd}},E^{(3)}_{\\text{eig}},E^{(3)}_{\\text{rnd}}]$，每个条目都是以 $\\Omega_i$ 为单位的十进制数。",
            "solution": "该问题要求对等离子体不稳定性（特别是捕获电子模，TEM）的线性化模型的增长率估计进行分析，该模型由齐次线性常微分方程 $\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}t} = \\mathbf{A}\\,\\mathbf{x}$ 描述。此处，$\\mathbf{x}(t) \\in \\mathbb{C}^N$ 是微扰振幅的状态向量，$\\mathbf{A} \\in \\mathbb{C}^{N \\times N}$ 是表示系统动力学的常数矩阵。我们被要求比较从两种不同初始条件得到的增长率估计的准确性：一种是与增长最快的本征模完美对齐，另一种是代表随机噪声。\n\n解决该系统的基本原理植根于线性算子的谱理论。由于假设矩阵 $\\mathbf{A}$ 是可对角化的，它可以分解为 $\\mathbf{A} = \\mathbf{S} \\mathbf{\\Lambda} \\mathbf{S}^{-1}$，其中 $\\mathbf{\\Lambda}$ 是包含 $\\mathbf{A}$ 的本征值 $\\lambda_j$ 的对角矩阵，$\\mathbf{S}$ 的列是相应的右本征向量 $\\mathbf{v}_j$。初值问题 $\\mathbf{x}(0) = \\mathbf{x}_0$ 的解由 $\\mathbf{x}(t) = \\exp(t\\mathbf{A})\\mathbf{x}_0$ 给出。使用谱分解，矩阵指数可以计算为 $\\exp(t\\mathbf{A}) = \\mathbf{S} \\exp(t\\mathbf{\\Lambda}) \\mathbf{S}^{-1}$，其中 $\\exp(t\\mathbf{\\Lambda})$ 是一个对角矩阵，其元素为 $\\mathrm{e}^{\\lambda_j t}$。这导出了问题中提供的精确解析解：\n$$\n\\mathbf{x}(t) = \\mathbf{S} \\exp(t\\mathbf{\\Lambda}) \\mathbf{S}^{-1} \\mathbf{x}_0\n$$\n另一种计算上更高效的表达方式是，将初始条件投影到本征基上。设 $\\mathbf{c} = \\mathbf{S}^{-1} \\mathbf{x}_0$ 是 $\\mathbf{x}_0$ 在本征向量基中的系数向量。那么演化过程由 $\\mathbf{x}(t) = \\mathbf{S} (\\exp(t\\mathbf{\\Lambda}) \\mathbf{c})$ 给出，这简化了对多个时间点的计算。\n\n单个本征模的增长率是其本征值的实部，即 $\\gamma_j = \\Re(\\lambda_j)$。如果系统以单个本征模 $\\mathbf{x}(0) = \\mathbf{v}_j$ 初始化，状态将演化为 $\\mathbf{x}(t) = \\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j$。由 $2$-范数定义的微扰振幅演化为 $a(t) = \\|\\mathbf{x}(t)\\|_2 = \\|\\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j\\|_2 = |\\mathrm{e}^{\\lambda_j t}| \\|\\mathbf{v}_j\\|_2 = \\mathrm{e}^{\\Re(\\lambda_j) t} \\|\\mathbf{v}_j\\|_2$。取自然对数可得：\n$$\n\\ln a(t) = \\Re(\\lambda_j) t + \\ln(\\|\\mathbf{v}_j\\|_2)\n$$\n这是时间 $t$ 的一个线性函数，其斜率等于精确的增长率 $\\gamma_j$。因此，对于一个本征模对齐的初始条件，对 $\\ln a(t)$ 与 $t$ 的关系进行线性拟合，应能高精度地得出真实的增长率。\n\n相比之下，一个随机初始条件 $\\mathbf{x}_0$ 是多个本征模的叠加，$\\mathbf{x}_0 = \\sum_j c_j \\mathbf{v}_j$。其时间演化则为 $\\mathbf{x}(t) = \\sum_j c_j \\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j$。振幅 $a(t) = \\|\\sum_j c_j \\mathrm{e}^{\\lambda_j t} \\mathbf{v}_j\\|_2$ 不再具有简单的指数形式。虽然在 $t$ 很大时渐近地看，对应最大增长率 $\\gamma_{\\text{true}} = \\max_j \\Re(\\lambda_j)$ 的项将占主导地位，但在有限时间内的行为是复杂的。模式间的干涉可能导致瞬态增长或衰减，特别是当矩阵 $\\mathbf{A}$ 是非正规的（即其本征向量非正交）或多个本征值的实部几乎相同时。这种复杂的瞬态行为会对 $\\ln a(t)$ 的线性拟合产生偏差，导致估计出的增长率 $\\widehat{\\gamma}$ 偏离 $\\gamma_{\\text{true}}$。\n\n为量化这三个给定测试用例中的效应，算法如下：\n\n对于每个测试用例 $i \\in \\{1, 2, 3\\}$：\n1.  **定义输入**：指定矩阵 $\\mathbf{S}^{(i)}$、对角本征值矩阵 $\\mathbf{\\Lambda}^{(i)}$、时间区间 $[t^{(i)}_{\\min}, t^{(i)}_{\\max}]$ 和随机种子 $s^{(i)}$。\n2.  **确定真实增长率**：真实的主导增长率被确定为 $\\gamma^{(i)}_{\\text{true}} = \\max_j \\Re(\\lambda^{(i)}_j)$。定位该本征值的索引。\n3.  **准备初始条件**：\n    -   **本征模对齐**：从 $\\mathbf{S}^{(i)}$ 的相应列中提取与 $\\gamma^{(i)}_{\\text{true}}$ 对应的本征向量 $\\mathbf{v}^{(i)}_{\\max}$。初始条件设置为经过 $2$-范数归一化的向量：$\\mathbf{x}^{(i)}_{\\text{eig}}(0) = \\mathbf{v}^{(i)}_{\\max} \\left/ \\|\\mathbf{v}^{(i)}_{\\max}\\|_2\\right.$。\n    -   **随机**：使用指定的种子 $s^{(i)}$ 生成一个维度为 $4$ 的随机复向量 $\\mathbf{z}$，其各分量的实部和虚部从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取。然后将此向量进行 $2$-范数归一化，以创建初始条件 $\\mathbf{x}^{(i)}_{\\text{rnd}}(0) = \\mathbf{z} \\left/ \\|\\mathbf{z}\\|_2\\right.$。\n4.  **模拟系统演化**：在区间 $[t^{(i)}_{\\min}, t^{(i)}_{\\max}]$ 内生成一组 $N=601$ 个等距时间点 $\\{t_k\\}$。对于每个初始条件 $\\mathbf{x}^{(i)}_{\\text{eig}}(0)$ 和 $\\mathbf{x}^{(i)}_{\\text{rnd}}(0)$，使用精确的谱解 $\\mathbf{x}(t) = \\mathbf{S} \\exp(t\\mathbf{\\Lambda})\\mathbf{S}^{-1} \\mathbf{x}_0$ 计算每个 $t_k$ 处的状态向量 $\\mathbf{x}(t_k)$。\n5.  **估计增长率**：对于两条轨迹中的每一条，在每个时间点计算振幅 $a(t_k) = \\|\\mathbf{x}(t_k)\\|_2$。对数据点 $(t_k, \\ln a(t_k))$ 进行线性最小二乘拟合。所得直线的斜率即为估计的增长率，从而得到 $\\widehat{\\gamma}^{(i)}_{\\text{eig}}$ 和 $\\widehat{\\gamma}^{(i)}_{\\text{rnd}}$。\n6.  **计算误差**：通过将估计的增长率与真实的主导增长率进行比较来计算绝对误差：$E^{(i)}_{\\text{eig}} = \\left|\\widehat{\\gamma}^{(i)}_{\\text{eig}} - \\gamma^{(i)}_{\\text{true}}\\right|$ 和 $E^{(i)}_{\\text{rnd}} = \\left|\\widehat{\\gamma}^{(i)}_{\\text{rnd}} - \\gamma^{(i)}_{\\text{true}}\\right|$。\n\n将此过程系统地应用于三个测试用例，并将得到的六个误差值合并到一个最终列表中。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating TEM growth rates for different initial conditions.\n    \"\"\"\n    \n    # Define test cases as per the problem statement.\n    test_cases = [\n        {\n            \"lambdas\": np.array([0.12 + 0.7j, 0.05 + 0.4j, -0.02 + 0.2j, -0.08 + 0.1j]),\n            \"S\": np.array([\n                [1.0, 0.2, -0.1, 0.0],\n                [0.1, 1.0, 0.3, -0.2],\n                [0.0, -0.1, 1.0, 0.1],\n                [0.2, 0.0, -0.2, 1.0]\n            ]),\n            \"t_min\": 10.0,\n            \"t_max\": 40.0,\n            \"seed\": 7\n        },\n        {\n            \"lambdas\": np.array([0.10 + 0.9j, 0.095 + 0.85j, 0.0 + 0.3j, -0.06 + 0.15j]),\n            \"S\": np.array([\n                [1.0, -0.3, 0.1, 0.0],\n                [0.2, 0.9, -0.2, 0.1],\n                [0.0, 0.1, 0.95, -0.3],\n                [-0.1, 0.0, 0.25, 1.1]\n            ]),\n            \"t_min\": 5.0,\n            \"t_max\": 35.0,\n            \"seed\": 11\n        },\n        {\n            \"lambdas\": np.array([0.08 + 0.6j, 0.06 + 0.65j, 0.02 + 0.2j, -0.05 + 0.05j]),\n            \"S\": np.array([\n                [1.0, 1.5, -1.2, 0.3],\n                [0.0, 1.0, 1.4, -0.8],\n                [0.0, 0.0, 1.0, 0.9],\n                [0.0, 0.0, 0.0, 1.0]\n            ]),\n            \"t_min\": 5.0,\n            \"t_max\": 20.0,\n            \"seed\": 13\n        }\n    ]\n\n    all_errors = []\n    N_SAMPLES = 601\n\n    for case in test_cases:\n        lambdas = case[\"lambdas\"]\n        S = case[\"S\"]\n        t_min, t_max = case[\"t_min\"], case[\"t_max\"]\n        seed = case[\"seed\"]\n\n        S_inv = np.linalg.inv(S)\n        \n        # Step 2: Compute true leading growth rate\n        gamma_true = np.max(np.real(lambdas))\n        idx_max = np.argmax(np.real(lambdas))\n\n        # Step 3: Construct initial conditions\n        # Eigenmode-aligned initialization\n        v_max = S[:, idx_max]\n        x0_eig = v_max / np.linalg.norm(v_max)\n\n        # Random-noise initialization\n        rng = np.random.default_rng(seed)\n        dim = S.shape[0]\n        z = rng.standard_normal(dim) + 1j * rng.standard_normal(dim)\n        x0_rnd = z / np.linalg.norm(z)\n\n        # Time vector for simulation\n        t_vec = np.linspace(t_min, t_max, N_SAMPLES)\n        \n        def evolve_and_estimate_growth_rate(x0):\n            \"\"\"\n            Evolves an initial condition and estimates the growth rate from the trajectory.\n            \"\"\"\n            # Project initial condition onto the eigenbasis\n            c = S_inv @ x0\n            \n            amplitudes = np.zeros(len(t_vec))\n            \n            for i, t in enumerate(t_vec):\n                # Evolve coefficients in the eigenbasis\n                ct = np.exp(lambdas * t) * c\n                # Transform back to the standard basis\n                xt = S @ ct\n                # Compute amplitude\n                amplitudes[i] = np.linalg.norm(xt)\n            \n            # Step 6: Estimate growth rate via linear fit\n            log_amplitudes = np.log(amplitudes)\n            # slope is the estimated growth rate\n            slope, _, _, _, _ = linregress(t_vec, log_amplitudes)\n            \n            return slope\n\n        # Estimate growth rates for both initial conditions\n        gamma_hat_eig = evolve_and_estimate_growth_rate(x0_eig)\n        gamma_hat_rnd = evolve_and_estimate_growth_rate(x0_rnd)\n\n        # Step 7: Compute absolute errors\n        E_eig = np.abs(gamma_hat_eig - gamma_true)\n        E_rnd = np.abs(gamma_hat_rnd - gamma_true)\n\n        all_errors.extend([E_eig, E_rnd])\n\n    # Format output as plain decimal numbers\n    formatted_errors = [f\"{err:.16f}\".rstrip('0').rstrip('.') for err in all_errors]\n    print(f\"[{','.join(formatted_errors)}]\")\n\nsolve()\n```"
        }
    ]
}