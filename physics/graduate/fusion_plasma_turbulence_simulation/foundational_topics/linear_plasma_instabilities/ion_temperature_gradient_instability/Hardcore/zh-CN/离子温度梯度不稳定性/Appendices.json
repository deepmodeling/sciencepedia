{
    "hands_on_practices": [
        {
            "introduction": "理解任何等离子体不稳定性的第一步是量化其增长的速度。本练习  将指导你从基本的物理参数出发，为一个著名的聚变等离子体场景——Cyclone基准案例，编写程序计算离子温度梯度（ITG）不稳定性的线性增长率。通过这个实践，你将把抽象的理论公式与具体的数值结果联系起来，并将其与一个简化的混合长度估算进行比较。",
            "id": "4193211",
            "problem": "您将实现一个程序，在Cyclone基本案例中，使用简化的漂移-动理学和曲率驱动的反应模型，计算离子温度梯度（ITG）不稳定性的线性增长率作为极向波数的函数，并将其与混合长度估算进行比较。推导和实现必须基于磁化等离子体物理学的核心定义和经过充分检验的基础公式，不得使用任何预先给出的目标公式快捷方式。\n\n从以下基本基础开始：\n- 离子热速度定义为 $v_{\\mathrm{th}i} = \\sqrt{2 T_i / m_i}$，其中 $T_i$ 是离子温度，$m_i$ 是离子质量。\n- 离子回旋频率为 $\\Omega_i = e B / m_i$，其中 $e$ 是元电荷，$B$ 是磁场强度。\n- 离子拉莫尔半径为 $\\rho_i = v_{\\mathrm{th}i} / \\Omega_i$。\n- 离子抗磁频率定义为 $\\omega_{\\ast i} = k_y T_i / (e B L_n)$，其中 $k_y$ 是极向波数，$L_n$ 是密度梯度标长。\n- 在坏曲率区，环向曲率漂移频率的标度关系可以建模为 $\\omega_D = 2 \\varepsilon_n \\, \\omega_{\\ast i}$，其中 $\\varepsilon_n = L_n / R$，$R$ 是大半径。此关系源于曲率漂移速度标度关系 $v_\\kappa \\sim 2 T_i/(e B R)$ 和 $\\omega_D \\sim k_y v_\\kappa$。\n- 归一化离子温度梯度参数为 $\\eta_i = L_n / L_{T_i}$，其中 $L_{T_i}$ 是离子温度梯度标长。\n- 对于绝热电子和在气球模点处平行动力学消失的低频无碰撞动力学，曲率驱动和离子抗磁响应之间的简化反应性平衡给出了一个近似的ITG增长率标度关系：当 $\\eta_i  \\eta_{i,c}$ 时，$\\gamma \\sim \\sqrt{\\omega_{\\ast i} \\omega_D (\\eta_i - \\eta_{i,c})}$，否则 $\\gamma = 0$。这里 $\\eta_{i,c}$ 是临界离子温度梯度阈值。与双流体闭合和环向坏曲率驱动一致的曲率弛豫阈值可近似为 $\\eta_{i,c} = \\max\\{0, \\tfrac{2}{3}(1+\\tau) - 2 \\varepsilon_n\\}$，其中 $\\tau = T_i/T_e$，$T_e$ 是电子温度。这捕捉了环向曲率相对于平板位形值所导致的阈值降低，同时在 $\\varepsilon_n \\to 0$ 时保持了物理极限。\n- 相应的增长率混合长度估算为：当 $\\eta_i  \\eta_{i,c}$ 时，$\\gamma_{\\mathrm{ML}} \\sim \\omega_{\\ast i}\\sqrt{\\eta_i - \\eta_{i,c}}$，否则 $\\gamma_{\\mathrm{ML}} = 0$。\n\n您的任务：\n- 使用上述基础，从算法上推导出计算增长率 $\\gamma$ 和混合长度估算 $\\gamma_{\\mathrm{ML}}$ 所需的公式，使其成为 $k_y \\rho_i$ 和下面列出的Cyclone基本案例参数的显式函数。您必须使用从基本定义中获得的 $\\rho_i$，将无量纲输入 $k_y \\rho_i$ 转换为物理波数 $k_y$。\n- 采用氘离子，其质量为 $m_i = 2 m_p$，其中 $m_p$ 是质子质量。使用 $m_p = 1.67262192369 \\times 10^{-27}$ kg 和 $e = 1.602176634 \\times 10^{-19}$ C。\n- 使用Cyclone基本案例的物理参数：\n  - 大半径 $R = 1.65$ m，\n  - 磁场 $B = 3.0$ T，\n  - 离子和电子温度 $T_i = T_e = 2.0$ keV，\n  - 归一化温度梯度 $R / L_{T_i} = 6.9$，\n  - 归一化密度梯度 $R / L_n = 2.2$，\n  - 在此简化模型中，安全因子和磁剪切并非显式需要。\n- 根据上述参数计算 $L_{T_i} = R / (R/L_{T_i})$ 和 $L_n = R / (R/L_n)$。\n- 计算 $\\eta_i = L_n / L_{T_i}$ 和 $\\tau = T_i / T_e$。\n- 使用以下与上述基础和物理推理一致的简化反应模型来计算线性增长率：\n  - $\\gamma = \\sqrt{\\max\\{0, \\, \\omega_{\\ast i}\\, \\omega_D \\, (\\eta_i - \\eta_{i,c})\\}}$,\n  - $\\gamma_{\\mathrm{ML}} = \\omega_{\\ast i}\\, \\sqrt{\\max\\{0, \\, \\eta_i - \\eta_{i,c}\\}}$,\n  - 其中 $\\omega_D = 2 \\varepsilon_n \\, \\omega_{\\ast i}$ 和 $\\varepsilon_n = L_n/R$，以及 $\\eta_{i,c} = \\max\\{0, \\tfrac{2}{3}(1+\\tau) - 2 \\varepsilon_n\\}$。\n\n重要实现细节：\n- 使用 $1$ eV $= e$ 焦耳将温度从 keV 转换为焦耳。所有计算出的增长率必须以 s$^{-1}$ 表示。\n- 您的代码的输入由下面给出的测试套件固定；您的程序不得接受任何用户输入。\n- 角度不出现；这里您不需要使用弧度或度。\n- 对于每个测试案例 $k_y \\rho_i$，计算 $k_y = (k_y \\rho_i)/\\rho_i$，然后计算 $\\omega_{\\ast i}$、$\\eta_{i,c}$、$\\omega_D$，最后计算 $\\gamma$ 和 $\\gamma_{\\mathrm{ML}}$ (单位为 s$^{-1}$)。\n\n测试套件：\n- 使用以下 $k_y \\rho_i$ 的值：\n  - 案例 1：$0.05$，\n  - 案例 2：$0.10$，\n  - 案例 3：$0.30$，\n  - 案例 4：$0.50$，\n  - 案例 5：$0.80$，\n  - 案例 6：$1.20$。\n这些值涵盖了小、中等和相对较大的 $k_y \\rho_i$，包括远离和接近典型谱峰的行为。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于上述顺序中的每个测试案例，首先包含模型化的增长率 $\\gamma$ (单位 s$^{-1}$)，然后是混合长度估算 $\\gamma_{\\mathrm{ML}}$ (单位 s$^{-1}$)。因此，最终列表的长度为12。\n- 将每个数字用科学记数法表示，小数点后精确到6位（例如，$1.234567e+03$）。\n- 示例格式（仅供说明）：\"[1.234567e+03,9.876543e+02, ...]\"。",
            "solution": "我们从标准的漂移动理学标度关系和环向曲率的几何形状出发，为Cyclone基本案例中的离子温度梯度（ITG）不稳定性线性增长率推导一个可计算的、自洽的模型。目的是获得一个连接离子抗磁响应和环向曲率驱动的简化反应性色散模型，然后将得到的增长率与混合长度标度关系进行比较。\n\n步骤1：热、回旋运动和拉莫尔相关量。\n- 离子热速度源于沿单个速度分量的能量均分和低频动理学运动，$v_{\\mathrm{th}i} = \\sqrt{2 T_i / m_i}$。\n- 离子回旋频率是 $\\Omega_i = e B / m_i$，代表在均匀磁场中的拉莫尔旋转频率。\n- 离子拉莫尔半径是热速度与回旋频率之比，$\\rho_i = v_{\\mathrm{th}i} / \\Omega_i = \\sqrt{2 m_i T_i}/(e B)$。\n\n步骤2：抗磁和曲率漂移频率。\n- 离子抗磁漂移频率体现了由抗磁漂移引起的平衡密度梯度的跨场平流，由 $\\omega_{\\ast i} = k_y T_i / (e B L_n)$ 给出，其中 $k_y$ 是极向波数。由于我们寻求的是增长率，因此使用其绝对值。\n- 在大环径比托卡马克的坏曲率区中，环向曲率和梯度B漂移产生曲率漂移速度标度关系 $v_\\kappa \\sim 2 T_i/(e B R)$。因此，对于具有极向波数 $k_y$ 的扰动，相关的曲率频率为 $\\omega_D \\sim k_y v_\\kappa$。使用离子抗磁频率标度关系，在局域、大环径比近似下，这可以一致地表示为 $\\omega_D = 2 \\varepsilon_n \\, \\omega_{\\ast i}$，其中 $\\varepsilon_n = L_n/R$。\n\n步骤3：温度梯度驱动和阈值。\n- 归一化的ITG驱动参数为 $\\eta_i = L_n/L_{T_i}$。假设是绝热电子，并忽略在气球模点处的平行动力学，简化的双流体和回旋流体闭合提供了曲率自由能输入和离子抗磁响应之间的反应性平衡，其增长率与两个特征频率的几何平均值乘以超临界度（$\\eta_i - \\eta_{i,c}$）成标度关系。\n- 环向曲率降低了平板位形阈值。一个与简单闭合一致且被广泛使用的曲率弛豫阈值是\n  $$\\eta_{i,c} = \\max\\Big\\{0, \\, \\tfrac{2}{3}(1+\\tau) - 2 \\varepsilon_n \\Big\\},$$\n  其中 $\\tau = T_i/T_e$。该表达式在 $\\varepsilon_n \\to 0$ 的极限下简化为平板位形值 $\\tfrac{2}{3}(1+\\tau)$，同时捕捉了有限曲率驱动下的阈值降低。对于 $T_i=T_e$ 的Cyclone基本案例，我们有 $\\tau = 1$。\n\n步骤4：简化的增长率模型和混合长度比较。\n- 与上述标度关系一致的简化反应性增长率模型为\n  $$\\gamma = \\sqrt{\\max\\{0, \\, \\omega_{\\ast i}\\, \\omega_D \\, (\\eta_i - \\eta_{i,c})\\}}.$$\n  使用 $\\omega_D = 2 \\varepsilon_n \\, \\omega_{\\ast i}$，上式变为\n  $$\\gamma = \\omega_{\\ast i}\\, \\sqrt{\\max\\{0, \\, 2 \\varepsilon_n (\\eta_i - \\eta_{i,c})\\}}.$$\n- 一个相应的混合长度估算，基于在抗磁频率速率下的涡流退相干以及相同的阈值得出，\n  $$\\gamma_{\\mathrm{ML}} = \\omega_{\\ast i}\\, \\sqrt{\\max\\{0, \\, \\eta_i - \\eta_{i,c}\\}}.$$\n- 其比率为 $\\gamma/\\gamma_{\\mathrm{ML}} = \\sqrt{2 \\varepsilon_n}$，与 $k_y$ 无关，这反映了在此简化模型中曲率的贡献。\n\n步骤5：Cyclone基本案例参数和单位。\n- Cyclone基本案例提供：\n  - $R = 1.65$ m,\n  - $B = 3.0$ T,\n  - $T_i = T_e = 2.0$ keV,\n  - $R / L_{T_i} = 6.9$ 意味着 $L_{T_i} = R/(R/L_{T_i}) = 1.65/6.9$ m,\n  - $R / L_n = 2.2$ 意味着 $L_n = R/(R/L_n) = 1.65/2.2$ m,\n  - $\\eta_i = L_n / L_{T_i}$,\n  - $\\tau = 1$,\n  - $\\varepsilon_n = L_n/R$。\n- 使用 $1$ eV $= e$ J 将 $T_i$ 转换为焦耳。因此 $T_i = 2.0 \\times 10^3 \\, e$ J。\n- 使用 $m_i = 2 m_p$ 其中 $m_p = 1.67262192369 \\times 10^{-27}$ kg 和 $e = 1.602176634 \\times 10^{-19}$ C。\n\n步骤6：针对测试套件中每个给定的 $k_y \\rho_i$ 的算法步骤。\n- 计算 $\\rho_i = \\sqrt{2 m_i T_i} / (e B)$。\n- 计算 $k_y = (k_y \\rho_i)/\\rho_i$。\n- 计算 $\\omega_{\\ast i} = k_y T_i / (e B L_n)$。\n- 计算 $\\eta_{i,c} = \\max\\{0, \\tfrac{2}{3}(1+\\tau) - 2 \\varepsilon_n\\}$，其中 $\\varepsilon_n = L_n/R$ 且 $\\tau=1$。\n- 计算 $\\omega_D = 2 \\varepsilon_n \\, \\omega_{\\ast i}$。\n- 计算 $\\gamma = \\sqrt{\\max\\{0, \\, \\omega_{\\ast i}\\, \\omega_D \\, (\\eta_i - \\eta_{i,c})\\}}$ 和 $\\gamma_{\\mathrm{ML}} = \\omega_{\\ast i}\\, \\sqrt{\\max\\{0, \\, \\eta_i - \\eta_{i,c}\\}}$。\n- 根据构造，两个输出的单位都是 s$^{-1}$。\n\n步骤7：数值考虑和边界情况。\n- 如果参数是亚临界的，量 $\\eta_i - \\eta_{i,c}$ 可能为负；通过使用如上述定义中的与零的最大值来强制平方根内的非负性。\n- 测试套件使用六个 $k_y \\rho_i$ 的值：$0.05$, $0.10$, $0.30$, $0.50$, $0.80$, $1.20$，涵盖了从小到相对大的尺度。当 $k_y \\rho_i \\to 0$ 时，两个增长率都与 $k_y$ 呈线性标度关系，因此它们平滑地趋于零；在此简化模型中，随着 $k_y \\rho_i$ 的增加，两者都与 $k_y$ 成比例增长。\n\n步骤8：输出格式。\n- 对于每个测试案例，首先输出 $\\gamma$，然后输出 $\\gamma_{\\mathrm{ML}}$，单位均为 s⁻¹，使用科学记数法，小数点后精确到6位。\n- 按照测试套件案例的顺序，将所有12个数字聚合到一个列表中，并打印为单行，例如：\"[x1,x2,...]\"。\n\n此过程实现了基于基本漂移定义和最小环向反应性闭合的有原则的计算，从而可以在Cyclone基本案例条件下，与混合长度估算进行清晰的比较。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cyclone_base_itg_growth(ky_rhoi_values):\n    # Physical constants (SI)\n    e = 1.602176634e-19       # Coulomb\n    m_p = 1.67262192369e-27   # kg\n\n    # Cyclone base case parameters\n    R = 1.65                  # m\n    B = 3.0                   # T\n    Ti_keV = 2.0              # keV\n    Te_keV = 2.0              # keV\n    RLTi = 6.9                # R / L_Ti\n    RLn  = 2.2                # R / L_n\n    mi = 2.0 * m_p            # Deuterium mass\n    # Convert temperatures to Joules\n    Ti = Ti_keV * 1e3 * e     # J\n    Te = Te_keV * 1e3 * e     # J\n\n    # Derived scales\n    L_Ti = R / RLTi\n    L_n = R / RLn\n    eta_i = L_n / L_Ti\n    tau = Ti / Te\n    eps_n = L_n / R\n\n    # Ion thermal speed, gyrofrequency, and Larmor radius\n    vthi = np.sqrt(2.0 * Ti / mi)\n    Omega_i = e * B / mi\n    rho_i = vthi / Omega_i\n\n    # Critical threshold (curvature-relaxed)\n    eta_ic = max(0.0, (2.0/3.0) * (1.0 + tau) - 2.0 * eps_n)\n\n    results = []\n    for ky_rhoi in ky_rhoi_values:\n        ky = ky_rhoi / rho_i\n        # Ion diamagnetic frequency (use magnitude for growth rate)\n        omega_star_i = abs(ky) * Ti / (e * B * L_n)\n        # Curvature frequency via large-aspect-ratio scaling\n        omega_D = 2.0 * eps_n * omega_star_i\n\n        # Supercriticality\n        delta_eta = eta_i - eta_ic\n        if delta_eta = 0.0:\n            # Subcritical: no growth\n            gamma = 0.0\n            gamma_ml = 0.0\n        else:\n            gamma = np.sqrt(omega_star_i * omega_D * delta_eta)\n            gamma_ml = omega_star_i * np.sqrt(delta_eta)\n\n        results.append(gamma)\n        results.append(gamma_ml)\n\n    return results\n\ndef solve():\n    # Define the test cases from the problem statement.\n    ky_rhoi_values = [0.05, 0.10, 0.30, 0.50, 0.80, 1.20]\n\n    results = cyclone_base_itg_growth(ky_rhoi_values)\n\n    # Final print statement in the exact required format: scientific notation with 6 digits after decimal.\n    formatted = \"[\" + \",\".join(f\"{x:.6e}\" for x in results) + \"]\"\n    print(formatted)\n\nsolve()\n```"
        },
        {
            "introduction": "不稳定性一旦增长，便会驱动输运，这是磁约束聚变装置中的核心问题。本练习  深入探讨了不稳定性的波动特性（如相位关系）与由此产生的离子热通量之间的联系。此练习还将演示外部施加的流场（如此处所用的 $E \\times B$ 剪切）如何有效地抑制甚至逆转这种由湍流驱动的输运。",
            "id": "4193216",
            "problem": "考虑一个局域、静电、低磁化参数的等离子体，其中包含绝热电子和单电荷离子，采用均匀磁场 $\\mathbf{B} = B \\,\\hat{\\mathbf{z}}$ 的平板近似。假设背景离子温度梯度驱动离子温度梯度（ITG）不稳定性。设涨落的静电势和离子温度为单模平面波，\n$$\\tilde{\\phi}(\\mathbf{r},t) = \\Re\\{\\hat{\\phi}\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\}, \\quad \\tilde{T}_i(\\mathbf{r},t) = \\Re\\{\\hat{T}_i\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\},$$\n其中 $\\mathbf{k} = k_x \\hat{\\mathbf{x}} + k_y \\hat{\\mathbf{y}}$，复频率为 $\\omega = \\omega_r + i \\gamma_{\\mathrm{eff}}$，且 $\\gamma_{\\mathrm{eff}} = \\gamma_{0} - \\gamma_{E}$，这里 $\\gamma_{0}  0$ 是未剪切的净线性ITG增长率，$\\gamma_{E} \\ge 0$ 是施加的跨场 $\\mathbf{E}\\times\\mathbf{B}$ 剪切率（ExB，跨场电漂移）。径向 $\\mathbf{E}\\times\\mathbf{B}$ 速度为 $v_{E r} = - (c/B)\\,\\partial_y \\tilde{\\phi}$，湍流离子热通量定义为传导分量\n$$Q_i \\doteq \\frac{3}{2}\\,n_{0i}\\,\\langle \\tilde{T}_i\\, v_{E r} \\rangle,$$\n其中 $n_{0i}$ 是平衡离子密度，$\\langle \\cdot \\rangle$ 表示对多个波周期的平均以及对多个极向波长的空间平均。\n\n假设在漂移动理学、小拉莫尔半径极限下，离子温度对势的响应是因果的且由单极点主导，因此交叉相位 $\\delta \\doteq \\arg(\\hat{T}_i) - \\arg(\\hat{\\phi})$ 在临界稳定性附近满足小角度近似，即 $\\sin \\delta \\approx \\delta$，且\n$$\\delta \\approx -\\,\\frac{\\gamma_{\\mathrm{eff}}}{|\\omega_r|} \\quad \\text{for} \\quad |\\gamma_{\\mathrm{eff}}| \\ll |\\omega_r|,$$\n并且振幅比 $|\\hat{T}_i|/|\\hat{\\phi}|$ 在 $|\\gamma_{\\mathrm{eff}}|/|\\omega_r|$ 的主导阶上是实数。在符号约定中，正的径向热通量 $Q_i$ 是向外的（$x$ 增加的方向）。\n\n从以上定义和假设出发，完成以下任务：\n1) 推导单模的离子热通量 $Q_i$ 的准线性表达式，用 $k_y$、$B$、$|\\hat{\\phi}|$、$|\\hat{T}_i|$ 和交叉相位 $\\delta$ 表示，并确定当 $\\omega_r$ 具有漂移波符号且 $\\gamma_{\\mathrm{eff}}  0$（不稳定）时，典型ITG模相下 $Q_i$ 的符号。\n2) 使用 $\\delta$ 的因果小角度关系，说明当 $\\mathbf{E}\\times\\mathbf{B}$ 剪切率 $\\gamma_{E}$ 增加时，$Q_i$ 的符号如何变化，并确定热通量符号反转的阈值。\n3) 给出离子热通量符号改变时的临界剪切率 $\\gamma_{E}^{\\mathrm{crit}}$ 的闭式解析表达式（用上面定义的参数表示）。最终答案中不要包含单位。如果引入任何中间数值计算，请勿四舍五入；最终答案必须是精确的符号形式。",
            "solution": "问题要求推导离子温度梯度（ITG）模的准线性离子热通量，分析该通量如何受施加的 $\\mathbf{E}\\times\\mathbf{B}$ 剪切率影响，并求出热通量符号反转时该剪切率的临界值。解答按要求分三部分进行。\n\n### 第1部分：准线性离子热通量表达式及其符号\n\n湍流离子热通量 $Q_i$ 定义为焓通量的传导分量，由下式给出：\n$$Q_i \\doteq \\frac{3}{2}\\,n_{0i}\\,\\langle \\tilde{T}_i\\, v_{E r} \\rangle$$\n其中 $n_{0i}$ 是背景离子密度，$\\tilde{T}_i$ 是涨落的离子温度，$v_{E r}$ 是涨落的径向 $\\mathbf{E}\\times\\mathbf{B}$ 漂移速度，$\\langle \\cdot \\rangle$ 表示时间和空间平均。\n\n涨落量以单模平面波的形式给出：\n$$\\tilde{\\phi}(\\mathbf{r},t) = \\Re\\{\\hat{\\phi}\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\}$$\n$$\\tilde{T}_i(\\mathbf{r},t) = \\Re\\{\\hat{T}_i\\,\\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)]\\}$$\n$\\mathbf{E}\\times\\mathbf{B}$ 速度的径向分量为 $v_{E r} = - (c/B)\\,\\partial_y \\tilde{\\phi}$。为了求出 $v_{E r}$ 的复振幅，我们将算符 $- (c/B)\\,\\partial_y$ 应用于 $\\tilde{\\phi}$ 的复数表示：\n$$\\hat{v}_{Er} \\exp[i(\\mathbf{k}\\cdot\\mathbf{r} - \\omega t)] = -\\frac{c}{B} \\frac{\\partial}{\\partial y} \\left( \\hat{\\phi}\\,\\exp[i(k_x x + k_y y - \\omega t)] \\right)$$\n$$\\hat{v}_{Er} = -\\frac{c}{B} (i k_y) \\hat{\\phi}$$\n通量涉及相关项 $\\langle \\tilde{T}_i v_{E r} \\rangle$。对于两个振荡量 $A(t) = \\Re\\{\\hat{A} e^{-i\\omega t}\\}$ 和 $B(t) = \\Re\\{\\hat{B} e^{-i\\omega t}\\}$，它们乘积的时间平均为 $\\langle A B \\rangle = \\frac{1}{2} \\Re\\{\\hat{A} \\hat{B}^*\\}$。这里，$A = \\tilde{T}_i$，$B = v_{Er}$。\n$$\\langle \\tilde{T}_i v_{E r} \\rangle = \\frac{1}{2} \\Re\\{ \\hat{T}_i \\hat{v}_{Er}^* \\}$$\n代入 $\\hat{v}_{Er}$ 的表达式：\n$$\\langle \\tilde{T}_i v_{E r} \\rangle = \\frac{1}{2} \\Re\\left\\{ \\hat{T}_i \\left( -i \\frac{c k_y}{B} \\hat{\\phi} \\right)^* \\right\\} = \\frac{1}{2} \\Re\\left\\{ \\hat{T}_i \\left( i \\frac{c k_y}{B} \\hat{\\phi}^* \\right) \\right\\} = \\frac{c k_y}{2B} \\Re\\{ i \\hat{T}_i \\hat{\\phi}^* \\}$$\n设复振幅用极坐标形式表示为：$\\hat{\\phi} = |\\hat{\\phi}| \\exp(i \\arg(\\hat{\\phi}))$ 和 $\\hat{T}_i = |\\hat{T}_i| \\exp(i \\arg(\\hat{T}_i))$。交叉相位定义为 $\\delta \\doteq \\arg(\\hat{T}_i) - \\arg(\\hat{\\phi})$。\n乘积 $\\hat{T}_i \\hat{\\phi}^*$ 变为：\n$$\\hat{T}_i \\hat{\\phi}^* = |\\hat{T}_i| \\exp(i \\arg(\\hat{T}_i)) \\cdot |\\hat{\\phi}| \\exp(-i \\arg(\\hat{\\phi})) = |\\hat{T}_i| |\\hat{\\phi}| \\exp(i[\\arg(\\hat{T}_i) - \\arg(\\hat{\\phi})]) = |\\hat{T}_i| |\\hat{\\phi}| \\exp(i\\delta)$$\n将此代入相关项的表达式中：\n$$\\langle \\tilde{T}_i v_{E r} \\rangle = \\frac{c k_y}{2B} \\Re\\{ i |\\hat{T}_i| |\\hat{\\phi}| \\exp(i\\delta) \\} = \\frac{c k_y}{2B} |\\hat{T}_i| |\\hat{\\phi}| \\Re\\{ i(\\cos\\delta + i\\sin\\delta) \\}$$\n$$\\langle \\tilde{T}_i v_{E r} \\rangle = \\frac{c k_y}{2B} |\\hat{T}_i| |\\hat{\\phi}| \\Re\\{ i\\cos\\delta - \\sin\\delta \\} = - \\frac{c k_y}{2B} |\\hat{T}_i| |\\hat{\\phi}| \\sin\\delta$$\n最后，准线性离子热通量 $Q_i$ 为：\n$$Q_i = \\frac{3}{2} n_{0i} \\left( - \\frac{c k_y}{2B} |\\hat{T}_i| |\\hat{\\phi}| \\sin\\delta \\right) = - \\frac{3 c n_{0i} k_y}{4B} |\\hat{\\phi}| |\\hat{T}_i| \\sin\\delta$$\n这就是单模的离子热通量表达式。\n\n为确定不稳定ITG模的 $Q_i$ 符号，我们使用给定的信息。按照惯例，极向波数 $k_y$ 取为正值。其他量 $c$、$n_{0i}$、$B$、$|\\hat{\\phi}|$ 和 $|\\hat{T}_i|$ 都是正定的。因此，$Q_i$ 的符号由 $-\\sin\\delta$ 的符号决定。\n问题指出，对于弱不稳定模，交叉相位 $\\delta$ 满足 $\\delta \\approx -\\gamma_{\\mathrm{eff}}/|\\omega_r|$。对于不稳定模，有效增长率 $\\gamma_{\\mathrm{eff}}  0$。实频率分母 $|\\omega_r|$ 也是正的。因此，$\\delta$ 是一个小的负数：$\\delta  0$。\n对于小角度 $\\delta$，$\\sin\\delta \\approx \\delta$。因为 $\\delta  0$，我们有 $\\sin\\delta  0$。\n因此，$-\\sin\\delta  0$。这意味着热通量为正，$Q_i  0$。这在物理上是一致的，因为由温度梯度驱动的不稳定性应将热量沿梯度向下输运（即向外，这是 $Q_i$ 的正方向）。\n\n### 第2部分：$\\mathbf{E}\\times\\mathbf{B}$ 剪切效应和通量反转\n\n为了分析 $Q_i$ 的符号如何随 $\\mathbf{E}\\times\\mathbf{B}$ 剪切率 $\\gamma_E$ 变化，我们将给定关系代入推导出的 $Q_i$ 表达式中。我们使用小角度近似 $\\sin\\delta \\approx \\delta$，这在 $|\\gamma_{\\mathrm{eff}}| \\ll |\\omega_r|$ 时成立：\n$$Q_i \\approx - \\frac{3 c n_{0i} k_y}{4B} |\\hat{\\phi}| |\\hat{T}_i| \\delta$$\n接下来，我们代入相移的因果关系 $\\delta \\approx -\\gamma_{\\mathrm{eff}}/|\\omega_r|$：\n$$Q_i \\approx - \\frac{3 c n_{0i} k_y}{4B} |\\hat{\\phi}| |\\hat{T}_i| \\left( -\\frac{\\gamma_{\\mathrm{eff}}}{|\\omega_r|} \\right) = \\frac{3 c n_{0i} k_y}{4 B |\\omega_r|} |\\hat{\\phi}| |\\hat{T}_i| \\gamma_{\\mathrm{eff}}$$\n问题将有效增长率定义为 $\\gamma_{\\mathrm{eff}} = \\gamma_0 - \\gamma_E$，其中 $\\gamma_0  0$ 是内禀ITG增长率，$\\gamma_E \\ge 0$ 是剪切率。将此代入 $Q_i$ 的表达式：\n$$Q_i \\approx \\frac{3 c n_{0i} k_y}{4 B |\\omega_r|} |\\hat{\\phi}| |\\hat{T}_i| (\\gamma_0 - \\gamma_E)$$\n前因子项 $\\frac{3 c n_{0i} k_y}{4 B |\\omega_r|} |\\hat{\\phi}| |\\hat{T}_i|$ 是正的。因此，$Q_i$ 的符号由 $(\\gamma_0 - \\gamma_E)$ 项的符号决定。\n我们可以分析当 $\\gamma_E$ 从 $0$ 开始增加时 $Q_i$ 的行为：\n1.  对于 $\\gamma_E  \\gamma_0$：项 $(\\gamma_0 - \\gamma_E)$ 是正的。因此，$Q_i  0$。这对应于由不稳定模（$\\gamma_{\\mathrm{eff}}  0$）驱动的向外热通量。随着 $\\gamma_E$ 增加，$Q_i$ 的大小减小。\n2.  对于 $\\gamma_E = \\gamma_0$：项 $(\\gamma_0 - \\gamma_E)$ 为零。因此，$Q_i = 0$。这是临界稳定点（$\\gamma_{\\mathrm{eff}} = 0$），此时 $\\mathbf{E}\\times\\mathbf{B}$ 剪切完全抑制了线性不稳定性。湍流热通量消失。\n3.  对于 $\\gamma_E  \\gamma_0$：项 $(\\gamma_0 - \\gamma_E)$ 是负的。因此，$Q_i  0$。在此区域，模是线性阻尼的（$\\gamma_{\\mathrm{eff}}  0$）。热通量符号反转，现在指向内部。\n\n热通量在 $Q_i$ 通过零点的阈值处反转符号。这恰好在 $\\gamma_0 - \\gamma_E = 0$ 时发生。\n\n### 第3部分：通量反转的临界剪切率\n\n临界剪切率 $\\gamma_E^{\\mathrm{crit}}$ 是离子热通量 $Q_i$ 改变符号时的 $\\gamma_E$ 值。根据第2部分的分析，这个转变发生在 $Q_i = 0$ 时。将 $Q_i$ 的表达式设为零：\n$$Q_i \\propto (\\gamma_0 - \\gamma_E) = 0$$\n这得出了剪切率的临界值：\n$$\\gamma_E^{\\mathrm{crit}} = \\gamma_0$$\n因此，反转湍流离子热通量符号所需的临界剪切率等于ITG模的未剪切线性增长率。",
            "answer": "$$\\boxed{\\gamma_{0}}$$"
        },
        {
            "introduction": "简单的准线性模型往往无法完全捕捉湍流输运的复杂性，因此需要更高级的模型。本练习  介绍了两个关键的非线性物理现象：由带状流（zonal flow）引起的湍流抑制和由流光（streamer）结构引起的输运增强。通过比较简单的混合长度模型与包含了这些非线性修正的模型，你将能更好地理解湍流建模中的挑战与精妙之处。",
            "id": "4193169",
            "problem": "您的任务是实现并分析一个简化的、但有科学依据的比较，该比较针对聚变等离子体中离子温度梯度（ITG）湍流的准线性混合长度估算离子热输运与非线性校正估算进行。目标是通过将准线性输运估算与非线性回旋动理学饱和的替代模型进行比较，来评估准线性输运估算的有效性，并识别混合长度法则失效或低估通量的区域。\n\n分析必须以无量纲的回旋玻姆（gyro-Bohm）单位进行。回旋玻姆归一化（GB）是一种常规的无量纲标度化方法，其中物理量通过离子声速和离子回旋半径尺度进行归一化，从而使输运通量变为无量纲。所有输出必须表示为回旋玻姆单位下的无量纲值。\n\n从以下基本概念开始：\n- 菲克热输运定律指出，热通量 $Q$ 的标度关系为 $Q \\sim \\chi \\nabla T$，其中 $\\chi$ 是热扩散系数，$\\nabla T$ 是温度梯度。\n- 混合长度概念将湍流扩散系数建模为特征步长和特征退相干速度的乘积，或退相干率与波数平方的比值。对于波数 $k_{\\perp}$，其无量纲形式为，假设混合长度湍流扩散系数满足 $\\chi_{\\mathrm{ML}}(k) = \\gamma_{\\mathrm{lin}}(k) / k_{\\perp}^{2}$，其中 $\\gamma_{\\mathrm{lin}}$ 是线性不稳定性增长率。\n- 准线性离子热通量则建模为 $Q_{\\mathrm{ML}} = \\left(\\sum_{k} \\chi_{\\mathrm{ML}}(k)\\right)\\left(R/L_{T_{i}}\\right)$，其中 $R/L_{T_{i}}$ 是与归一化离子温度梯度成正比的无量纲驱动参数，而 $R$ 是用于归一化的特征大半径（在本问题中设为1）。\n\n对于离子温度梯度（ITG）不稳定性：\n- 将离子温度梯度（ITG）定义为由磁化等离子体中的离子温度梯度驱动的不稳定性。\n- 在无量纲单位中，将离子抗磁漂移频率定义为 $\\omega_{\\ast i} = k_{y}/L_{n}$，其中 $k_{y}$ 是极向波数，$L_{n}$ 是无量纲密度梯度标长。\n- 定义 $\\eta_{i} = L_{n}/L_{T_{i}}$，其中 $L_{T_{i}}$ 是离子温度梯度标长。在这些单位中，当 $R=1$ 时，驱动参数 $R/L_{T_{i}} = 1/L_{T_{i}}$，因此 $L_{T_{i}} = 1/(R/L_{T_{i}})$，所以 $\\eta_{i} = L_{n} \\cdot (R/L_{T_{i}})$。\n- 使用一个带有有限拉莫尔半径稳定化的线性增长率模型：$\\gamma_{\\mathrm{lin}}(k_{x},k_{y}) = C_{g}\\,\\omega_{\\ast i}\\,\\max\\left(0, \\eta_{i}-\\eta_{\\mathrm{crit}}(\\tau)\\right)\\,\\exp\\left(-b\\right)$，其中 $b = k_{\\perp}^{2}$ 且 $k_{\\perp}^{2}=k_{x}^{2}+k_{y}^{2}$，$C_{g}$ 是一个无量纲系数，临界阈值 $\\eta_{\\mathrm{crit}}(\\tau)$ 取决于温度比 $\\tau=T_{i}/T_{e}$。在本问题中，取 $C_{g}=0.3$ 和 $\\eta_{\\mathrm{crit}}(\\tau)=0.8+0.3/\\tau$。\n- 将每个模式的混合长度扩散系数定义为 $\\chi_{\\mathrm{ML}}(k) = \\gamma_{\\mathrm{lin}}(k)/k_{\\perp}^{2}$，并对所有提供的 $(k_{x},k_{y})$ 模式求和以获得总的 $\\chi_{\\mathrm{ML}}$。\n\n为了包含模拟回旋动理学动力学的非线性饱和效应：\n- 认识到电场叉磁场（E×B）纬向流剪切可以在阈值附近抑制湍流（Dimits 位移区）。将纬向流剪切率与增长率之比建模为\n$$\\frac{\\gamma_{E}(k)}{\\gamma_{\\mathrm{lin}}(k)} = \\frac{C_{E}}{1+s_{\\hat{}}/k_{y}},$$\n其中 $s_{\\hat{}}$ 是磁剪切参数，$C_{E}$ 是一个无量纲常数。取 $C_{E}=1.2$。相关的抑制因子为\n$$S_{\\mathrm{zf}}(k) = \\frac{1}{1+\\left(\\gamma_{E}(k)/\\gamma_{\\mathrm{lin}}(k)\\right)^{2}} = \\frac{1}{1+\\left(\\frac{C_{E}}{1+s_{\\hat{}}/k_{y}}\\right)^{2}}.$$\n- 在强驱动和弱剪切区域，流光结构可以产生超混合长度输运。将流光增强因子建模为\n$$F_{\\mathrm{st}} = 1 + C_{\\mathrm{st}}\\,\\max\\left(0,\\eta_{i}-\\eta_{\\mathrm{stream}}\\right)^{\\beta}\\,\\frac{1}{1+s_{\\hat{}}/s_{0}},$$\n其中 $C_{\\mathrm{st}}=0.6$，$\\beta=1.5$，$s_{0}=0.2$，以及 $\\eta_{\\mathrm{stream}}=\\eta_{\\mathrm{crit}}(\\tau)+0.5$。\n- 定义每个模式的非线性校正扩散系数：\n$$\\chi_{\\mathrm{NL}}(k) = \\chi_{\\mathrm{ML}}(k)\\,S_{\\mathrm{zf}}(k)\\,F_{\\mathrm{st}},$$\n以及非线性离子热通量\n$$Q_{\\mathrm{NL}} = \\left(\\sum_{k} \\chi_{\\mathrm{NL}}(k)\\right)\\left(R/L_{T_{i}}\\right).$$\n\n您的程序必须：\n1.  对于每个提供的测试用例，计算 $\\eta_{i}$、所有模式的 $\\gamma_{\\mathrm{lin}}(k)$、$\\chi_{\\mathrm{ML}}$、$Q_{\\mathrm{ML}}$、$S_{\\mathrm{zf}}(k)$、$F_{\\mathrm{st}}$、$\\chi_{\\mathrm{NL}}$ 和 $Q_{\\mathrm{NL}}$（以回旋玻姆单位），以及比值 $r=Q_{\\mathrm{NL}}/Q_{\\mathrm{ML}}$（如果 $Q_{\\mathrm{ML}}=0$ 且 $Q_{\\mathrm{NL}}=0$，则设 $r=0$；如果 $Q_{\\mathrm{ML}}=0$ 但 $Q_{\\mathrm{NL}}0$，则将 $r$ 设为一个大的哨兵值，如 $10^{9}$）。\n2.  使用以下整数代码对每个用例的混合长度有效性进行分类：\n    - $0$ 如果准线性估算有效，定义为 $0.7 \\le r \\le 1.3$，\n    - $1$ 如果混合长度低估了输运，定义为 $r  1.3$，\n    - $-1$ 如果混合长度高估了输运，定义为 $r  0.7$。\n3.  生成最终输出，为单行逗号分隔的 Python 风格列表的列表，每个测试用例一个，其中每个内部列表为 $[Q_{\\mathrm{ML}}, Q_{\\mathrm{NL}}, r, \\text{code}]$。\n\n使用以下测试套件，其模式网格和参数涵盖了近阈值抑制、中等驱动、强驱动流光增强和强剪切等情况：\n- 所有用例共享的模式网格：$(k_{y},k_{x}) \\in \\{(0.1,0.1),(0.2,0.2),(0.3,0.3),(0.5,0.5),(0.7,0.7),(1.0,1.0)\\}$。\n- 用例 A（近阈值，中等剪切）：$\\tau=1.0$, $L_{n}=2.0$, $R/L_{T_{i}}=0.6$, $s_{\\hat{}}=0.7$。\n- 用例 B（中等驱动，中等剪切）：$\\tau=1.0$, $L_{n}=2.0$, $R/L_{T_{i}}=1.0$, $s_{\\hat{}}=0.7$。\n- 用例 C（强驱动，弱剪切）：$\\tau=1.5$, $L_{n}=3.0$, $R/L_{T_{i}}=1.2$, $s_{\\hat{}}=0.05$。\n- 用例 D（强驱动，强剪切）：$\\tau=1.5$, $L_{n}=3.0$, $R/L_{T_{i}}=1.2$, $s_{\\hat{}}=1.5$。\n\n所有通量必须以回旋玻姆单位的无量纲浮点数报告。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result1,result2,result3]$），其中每个 $result$ 是一个四元素列表 $[Q_{\\mathrm{ML}}, Q_{\\mathrm{NL}}, r, \\text{code}]$，对应一个测试用例。",
            "solution": "该问题提出了一个有效的、适定的、且具有科学依据的任务。它要求在托卡马克等离子体中离子温度梯度（ITG）湍流的简化表示下，实现并比较两种离子热输运模型。第一个模型是准线性混合长度估算，第二个模型则包含了对非线性效应（即纬向流抑制和流光增强）的唯象校正。这些模型虽然经过简化，但均基于等离子体微观湍流理论的既定原理。所有参数和操作区域在物理上都是合理的。该问题是自洽的，并提供了所有必要的方程、常数和测试用例，以得出一个唯一的、可验证的解。\n\n问题的核心是计算四种不同物理情景下以无量纲回旋玻姆单位表示的离子热通量 $Q_i$。这是通过首先计算湍流热扩散系数 $\\chi_i$，然后将其乘以驱动温度梯度（由参数 $R/L_{T_i}$ 表示）来完成的。问题为扩散系数定义了两种模型保真度级别。\n\n首先是准线性混合长度模型，它基于 ITG 不稳定性的线性特性。总混合长度扩散系数 $\\chi_{\\mathrm{ML}}$ 是对一系列由波数 $(k_x, k_y)$ 索引的离散湍流模式谱的求和。对于每个模式，扩散系数由下式给出：\n$$\n\\chi_{\\mathrm{ML}}(k) = \\frac{\\gamma_{\\mathrm{lin}}(k)}{k_{\\perp}^{2}}\n$$\n其中 $k$ 代表模式 $(k_x, k_y)$，$k_{\\perp} = \\sqrt{k_x^2 + k_y^2}$ 是垂直波数，$\\gamma_{\\mathrm{lin}}(k)$ 是该模式下 ITG 不稳定性的线性增长率。问题为该增长率提供了一个具体模型：\n$$\n\\gamma_{\\mathrm{lin}}(k_{x},k_{y}) = C_{g}\\,\\omega_{\\ast i}\\,\\max\\left(0, \\eta_{i}-\\eta_{\\mathrm{crit}}(\\tau)\\right)\\,\\exp\\left(-b\\right)\n$$\n这里，$C_g = 0.3$ 是一个数值系数。项 $\\max(0, \\eta_i - \\eta_{\\mathrm{crit}})$ 代表不稳定性驱动，仅当离子温度梯度参数 $\\eta_i$ 超过临界阈值 $\\eta_{\\mathrm{crit}}$ 时才非零。指数项 $\\exp(-b)$（其中 $b = k_{\\perp}^2$）模拟了高波数下有限拉莫尔半径（FLR）的稳定化效应。参数 $\\eta_i$ 和 $\\eta_{\\mathrm{crit}}$ 定义如下：\n$$\n\\eta_{i} = L_{n} \\cdot (R/L_{T_{i}})\n$$\n$$\n\\eta_{\\mathrm{crit}}(\\tau) = 0.8 + 0.3/\\tau\n$$\n其中 $L_n$ 是密度梯度标长，$R/L_{T_i}$ 是归一化的离子温度梯度（大半径 $R=1$），$\\tau = T_i/T_e$ 是离子与电子的温度比。离子抗磁漂移频率 $\\omega_{\\ast i}$ 引入了对极向波数 $k_y$ 的依赖：\n$$\n\\omega_{\\ast i} = \\frac{k_{y}}{L_{n}}\n$$\n一旦计算出总扩散系数 $\\sum_k \\chi_{\\mathrm{ML}}(k)$，准线性离子热通量 $Q_{\\mathrm{ML}}$ 为：\n$$\nQ_{\\mathrm{ML}} = \\left(\\sum_{k} \\chi_{\\mathrm{ML}}(k)\\right)\\left(\\frac{R}{L_{T_{i}}}\\right)\n$$\n\n其次，引入了一个非线性校正模型以解释超越线性理论的现象。非线性扩散系数 $\\chi_{\\mathrm{NL}}$ 通过两个因子来修正混合长度估算：一个纬向流抑制因子 $S_{\\mathrm{zf}}(k)$ 和一个流光增强因子 $F_{\\mathrm{st}}$。\n$$\n\\chi_{\\mathrm{NL}}(k) = \\chi_{\\mathrm{ML}}(k)\\,S_{\\mathrm{zf}}(k)\\,F_{\\mathrm{st}}\n$$\n纬向流抑制因子 $S_{\\mathrm{zf}}(k)$ 模拟了 $E \\times B$ 剪切流对湍流的淬灭作用，这在不稳定性阈值附近和低 $k_y$ 时尤其有效。它由下式给出：\n$$\nS_{\\mathrm{zf}}(k) = \\frac{1}{1+\\left(\\frac{\\gamma_{E}(k)}{\\gamma_{\\mathrm{lin}}(k)}\\right)^{2}} = \\frac{1}{1+\\left(\\frac{C_{E}}{1+s_{\\hat{}}/k_{y}}\\right)^{2}}\n$$\n其中 $C_E=1.2$，$s_{\\hat{}}$ 是磁剪切参数。\n\n流光增强因子 $F_{\\mathrm{st}}$ 解释了径向拉长的结构（流光）的形成，这可能导致输运水平超过混合长度估算，尤其是在强驱动（$\\eta_i \\gg \\eta_{\\mathrm{crit}}$）和弱磁剪切的区域。其定义为：\n$$\nF_{\\mathrm{st}} = 1 + C_{\\mathrm{st}}\\,\\max\\left(0,\\eta_{i}-\\eta_{\\mathrm{stream}}\\right)^{\\beta}\\,\\frac{1}{1+s_{\\hat{}}/s_{0}}\n$$\n其中常数 $C_{\\mathrm{st}}=0.6$，$\\beta=1.5$，$s_{0}=0.2$，以及流光阈值 $\\eta_{\\mathrm{stream}}=\\eta_{\\mathrm{crit}}(\\tau)+0.5$。请注意，在给定的测试用例中，$F_{\\mathrm{st}}$ 对所有模式都是常数。\n\n总的非线性离子热通量 $Q_{\\mathrm{NL}}$ 的计算方式与准线性情况类似：\n$$\nQ_{\\mathrm{NL}} = \\left(\\sum_{k} \\chi_{\\mathrm{NL}}(k)\\right)\\left(\\frac{R}{L_{T_{i}}}\\right)\n$$\n\n每个测试用例的算法步骤如下：\n1.  给定输入参数 $\\tau$、$L_n$、$R/L_{T_{i}}$ 和 $s_{\\hat{}}$，首先计算整个用例范围内的参数 $\\eta_{\\mathrm{crit}}$、$\\eta_i$ 和 $F_{\\mathrm{st}}$。\n2.  将总扩散系数 $\\sum_k \\chi_{\\mathrm{ML}}(k)$ 和 $\\sum_k \\chi_{\\mathrm{NL}}(k)$ 初始化为 $0$。\n3.  遍历波数网格中每个指定的模式 $(k_y, k_x)$。\n4.  对于每个模式，计算 $k_{\\perp}^2$、$\\gamma_{\\mathrm{lin}}(k)$ 和 $\\chi_{\\mathrm{ML}}(k)$。如果 $\\eta_i \\le \\eta_{\\mathrm{crit}}$，这些量为零。\n5.  计算依赖于模式的抑制因子 $S_{\\mathrm{zf}}(k)$。\n6.  计算每个模式的非线性扩散系数 $\\chi_{\\mathrm{NL}}(k) = \\chi_{\\mathrm{ML}}(k)S_{\\mathrm{zf}}(k)F_{\\mathrm{st}}$。\n7.  将每个模式的扩散系数累加到各自的总和中。\n8.  遍历所有模式后，计算总通量 $Q_{\\mathrm{ML}}$ 和 $Q_{\\mathrm{NL}}$。\n9.  计算比值 $r = Q_{\\mathrm{NL}} / Q_{\\mathrm{ML}}$。如果 $Q_{\\mathrm{ML}} = 0$，那么基于模型 $Q_{\\mathrm{NL}}$ 也必须为 $0$，因此我们设 $r=0$。\n10. 根据 $r$ 的值使用整数代码对结果进行分类：$r  0.7$ 为 $-1$，$0.7 \\le r \\le 1.3$ 为 $0$，$r > 1.3$ 为 $1$。\n11. 存储该测试用例的结果列表 $[Q_{\\mathrm{ML}}, Q_{\\mathrm{NL}}, r, \\text{code}]$。\n\n此过程将系统地应用于四个测试用例，这些用例旨在探测不同的物理区域：近阈值抑制（Dimits 位移）、中等湍流、强驱动流光增强以及强驱动伴随强剪切抑制。\n\n关于问题陈述的一个小注：它为 $Q_{\\mathrm{ML}}=0$ 且 $Q_{\\mathrm{NL}}0$ 的情况指定了一个哨兵值。然而，根据所提供的公式，$\\chi_{\\mathrm{NL}}(k)$ 与 $\\chi_{\\mathrm{ML}}(k)$ 成正比。因此，如果所有模式的 $\\chi_{\\mathrm{ML}}(k)$ 都为零（这发生在等离子体稳定，即 $\\eta_i \\le \\eta_{\\mathrm{crit}}$ 时），那么所有模式的 $\\chi_{\\mathrm{NL}}(k)$ 也必须为零。因此，$Q_{\\mathrm{ML}}=0$ 意味着 $Q_{\\mathrm{NL}}=0$。指定的情况是不可达的，我们只需要处理 $Q_{\\mathrm{ML}}=Q_{\\mathrm{NL}}=0$ 的情景，对此规定 $r=0$ 是正确的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares quasilinear and nonlinear-corrected ion heat transport\n    for Ion Temperature Gradient (ITG) turbulence.\n    \"\"\"\n\n    # --- Problem Constants ---\n    Cg = 0.3\n    CE = 1.2\n    Cst = 0.6\n    beta = 1.5\n    s0 = 0.2\n\n    # --- Mode Grid (k_y, k_x) ---\n    modes = np.array([\n        (0.1, 0.1),\n        (0.2, 0.2),\n        (0.3, 0.3),\n        (0.5, 0.5),\n        (0.7, 0.7),\n        (1.0, 1.0)\n    ])\n    ky_vals = modes[:, 0]\n    kx_vals = modes[:, 1]\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A: Near threshold, moderate shear\n        {'tau': 1.0, 'Ln': 2.0, 'R_over_LTi': 0.6, 's_hat': 0.7, 'name': 'A'},\n        # Case B: Moderate drive, moderate shear\n        {'tau': 1.0, 'Ln': 2.0, 'R_over_LTi': 1.0, 's_hat': 0.7, 'name': 'B'},\n        # Case C: Strong drive, weak shear\n        {'tau': 1.5, 'Ln': 3.0, 'R_over_LTi': 1.2, 's_hat': 0.05, 'name': 'C'},\n        # Case D: Strong drive, strong shear\n        {'tau': 1.5, 'Ln': 3.0, 'R_over_LTi': 1.2, 's_hat': 1.5, 'name': 'D'},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        tau = case['tau']\n        Ln = case['Ln']\n        R_over_LTi = case['R_over_LTi']\n        s_hat = case['s_hat']\n\n        # --- Step 1: Calculate case-wide parameters ---\n        eta_crit = 0.8 + 0.3 / tau\n        eta_i = Ln * R_over_LTi\n        eta_stream = eta_crit + 0.5\n\n        drive_factor = max(0, eta_i - eta_crit)\n\n        # Streamer enhancement factor (F_st)\n        streamer_drive = max(0, eta_i - eta_stream)\n        F_st = 1.0 + Cst * (streamer_drive ** beta) * (1.0 / (1.0 + s_hat / s0))\n\n        total_chi_ml = 0.0\n        total_chi_nl = 0.0\n\n        # --- Step 2: Loop over modes ---\n        for ky, kx in zip(ky_vals, kx_vals):\n            k_perp_sq = kx**2 + ky**2\n            b = k_perp_sq\n\n            # Linear growth rate (gamma_lin)\n            omega_star_i = ky / Ln\n            gamma_lin = Cg * omega_star_i * drive_factor * np.exp(-b)\n\n            if k_perp_sq == 0 or gamma_lin == 0:\n                chi_ml_k = 0.0\n            else:\n                # Mixing-length diffusivity (chi_ML)\n                chi_ml_k = gamma_lin / k_perp_sq\n\n            # Zonal flow suppression factor (S_zf)\n            gamma_E_over_gamma_lin = CE / (1.0 + s_hat / ky)\n            S_zf_k = 1.0 / (1.0 + gamma_E_over_gamma_lin**2)\n\n            # Nonlinear-corrected diffusivity (chi_NL)\n            chi_nl_k = chi_ml_k * S_zf_k * F_st\n\n            total_chi_ml += chi_ml_k\n            total_chi_nl += chi_nl_k\n\n        # --- Step 3: Calculate total fluxes ---\n        Q_ml = total_chi_ml * R_over_LTi\n        Q_nl = total_chi_nl * R_over_LTi\n\n        # --- Step 4: Calculate ratio and classify ---\n        if Q_ml == 0:\n            # As derived, if Q_ml is 0, Q_nl must also be 0.\n            r = 0.0\n        else:\n            r = Q_nl / Q_ml\n\n        if r  0.7:\n            code = -1  # mixing-length overestimates\n        elif r > 1.3:\n            code = 1   # mixing-length underestimates\n        else:\n            code = 0   # quasilinear estimate is valid\n\n        all_results.append([Q_ml, Q_nl, r, code])\n\n    # --- Step 5: Format final output ---\n    # The problem asks for a Python-style list of lists, which is what `str(all_results)` produces.\n    # To match the example format exactly, need to build the string carefully.\n    result_str = '[' + ','.join([f\"[{qml},{qnl},{rat},{c}]\" for qml, qnl, rat, c in all_results]) + ']'\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}