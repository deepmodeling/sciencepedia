{
    "hands_on_practices": [
        {
            "introduction": "这项实践是一项基础练习，旨在巩固微观动理学描述与宏观流体图像之间的关键联系。我们将从分布函数的一个具体形式——漂移麦克斯韦分布出发，通过直接计算其速度矩，来验证它能够准确地导出我们所熟悉的流体物理量，如密度、整体速度和压力。这个过程有助于加深对分布函数物理意义的理解。",
            "id": "4202184",
            "problem": "在聚变等离子体湍流的动理学描述中，单粒子分布函数的演化由玻尔兹曼方程决定，或在无碰撞极限下由弗拉索夫方程决定。一个常见的局域平衡是漂移麦克斯韦分布。考虑一个单组分等离子体，其粒子质量为 $m$，电荷为 $q$，在空间某点的速度分布由以下漂移麦克斯韦分布给出：\n$$\nf_{M}(\\mathbf{v}) \\;=\\; n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left[-\\frac{m\\,|\\mathbf{v}-\\mathbf{u}|^{2}}{2T}\\right],\n$$\n其中 $n$ 是数密度，$\\mathbf{u}=(u_{x},u_{y},u_{z})$ 是体漂移速度，$T$ 是标量温度。假设 $T$ 以能量单位度量（即玻尔兹曼常数已被吸收到 $T$ 中）。为了进行这些矩的计算，所有量均视为空间均匀的。\n\n从速度矩的基本动理学定义出发：\n$$\nn \\;=\\; \\int_{\\mathbb{R}^{3}} f(\\mathbf{v})\\, d^{3}\\!v,\\qquad\nn\\,\\mathbf{u} \\;=\\; \\int_{\\mathbb{R}^{3}} \\mathbf{v}\\, f(\\mathbf{v})\\, d^{3}\\!v,\\qquad\nP_{ij} \\;=\\; m\\int_{\\mathbb{R}^{3}} \\big(v_{i}-u_{i}\\big)\\big(v_{j}-u_{j}\\big)\\, f(\\mathbf{v})\\, d^{3}\\!v,\n$$\n以及标量压力 $p$ 的定义：\n$$\np \\;=\\; \\frac{1}{3}\\,\\mathrm{Tr}\\,\\mathbf{P} \\;=\\; \\frac{1}{3}\\sum_{i=x,y,z} P_{ii},\n$$\n计算给定 $f_{M}(\\mathbf{v})$ 的数密度 $n$、体漂移速度分量 $u_{x}$、$u_{y}$、$u_{z}$ 和标量压力 $p$。然后，仅使用对称性和高斯积分的性质，证明压力张量 $\\mathbf{P}$ 的非对角元对于此分布为零。您的推导必须从所述的矩定义开始，并可使用标准的多维高斯积分。\n\n请将您的最终结果以单行矩阵的形式给出，该矩阵按顺序包含五个量：$n$、$u_{x}$、$u_{y}$、$u_{z}$ 和 $p$，并用 $n$、$u_{x}$、$u_{y}$、$u_{z}$、$T$ 和 $m$ 以符号形式表示。最终的方框答案中不要包含单位。仅为提供上下文，$n$ 的单位是数密度，$\\mathbf{u}$ 的单位是速度，$p$ 的单位是压力。不需要进行数值取整。",
            "solution": "该问题陈述已经过验证，被认为是科学上合理、良定、客观且内部一致的。它提出了一个源自动理学理论的标准的、非平凡的验证问题，要求计算给定漂移麦克斯韦分布函数的最低阶速度矩。所提供的定义是基本且正确的。该问题按陈述可解。\n\n我们被要求计算一个等离子体组分的数密度 $n$、体漂移速度矢量 $\\mathbf{u}$ 和标量压力 $p$，其速度分布为漂移麦克斯韦分布：\n$$f_{M}(\\mathbf{v}) \\;=\\; N \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left[-\\frac{m\\,|\\mathbf{v}-\\mathbf{U}|^{2}}{2T}\\right]$$\n为清晰起见，并为了区分函数中的参数和我们正在计算的矩，我们将暂时把分布中的参数记为 $N$、$\\mathbf{U}$ 和 $T$。问题陈述对这些参数使用了 $n$ 和 $\\mathbf{u}$，但这种记法是自我指涉的。我们的任务是证明计算出的矩确实等于这些参数。矩的定义如下：\n$$n_{calc} \\;=\\; \\int_{\\mathbb{R}^{3}} f_{M}(\\mathbf{v})\\, d^{3}\\!v$$\n$$n_{calc}\\,\\mathbf{u}_{calc} \\;=\\; \\int_{\\mathbb{R}^{3}} \\mathbf{v}\\, f_{M}(\\mathbf{v})\\, d^{3}\\!v$$\n$$P_{ij} \\;=\\; m\\int_{\\mathbb{R}^{3}} \\big(v_{i}-u_{calc,i}\\big)\\big(v_{j}-u_{calc,j}\\big)\\, f_{M}(\\mathbf{v})\\, d^{3}\\!v$$\n$$p_{calc} \\;=\\; \\frac{1}{3}\\sum_{i=x,y,z} P_{ii}$$\n我们将证明 $n_{calc}=N$，$\\mathbf{u}_{calc}=\\mathbf{U}$，以及 $p_{calc}=NT$。\n\n为了方便计算，我们在速度积分中进行变量替换。令 $\\mathbf{w} = \\mathbf{v} - \\mathbf{U}$。这意味着 $\\mathbf{v} = \\mathbf{w} + \\mathbf{U}$，速度空间中的体积元保持不变，$d^3\\!v = d^3\\!w$。分布函数变为：\n$$f_{M}(\\mathbf{w}) \\;=\\; N \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\!\\left[-\\frac{m\\,|\\mathbf{w}|^{2}}{2T}\\right]$$\n其中 $|\\mathbf{w}|^2 = w_x^2 + w_y^2 + w_z^2$。这个函数是一个以 $\\mathbf{w}=\\mathbf{0}$ 为中心的各向同性高斯函数。\n\n首先，我们计算数密度 $n_{calc}$：\n$$n_{calc} = \\int_{\\mathbb{R}^3} f_M(\\mathbf{v}) \\,d^3\\!v = \\int_{\\mathbb{R}^3} N \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\left(-\\frac{m|\\mathbf{w}|^2}{2T}\\right) \\,d^3\\!w$$\n该积分可分离为三个相同的一维高斯积分：\n$$n_{calc} = N \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m w_x^2}{2T}\\right) dw_x \\right] \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m w_y^2}{2T}\\right) dw_y \\right] \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m w_z^2}{2T}\\right) dw_z \\right]$$\n使用标准定积分 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$，其中 $a = m/(2T)$，每个积分的计算结果为 $\\sqrt{2\\pi T/m}$。\n$$n_{calc} = N \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\left(\\sqrt{\\frac{2\\pi T}{m}}\\right)^3 = N \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\left(\\frac{2\\pi T}{m}\\right)^{3/2} = N$$\n这证实了分布中的参数 $N$ 确实是数密度。此后，我们如问题陈述中一样，使用 $n$ 表示此参数。\n\n接下来，我们计算体漂移速度 $\\mathbf{u}_{calc}$。\n$$n\\,\\mathbf{u}_{calc} = \\int_{\\mathbb{R}^3} \\mathbf{v} f_M(\\mathbf{v}) \\,d^3\\!v$$\n应用变量替换 $\\mathbf{v} = \\mathbf{w} + \\mathbf{U}$：\n$$n\\,\\mathbf{u}_{calc} = \\int_{\\mathbb{R}^3} (\\mathbf{w} + \\mathbf{U}) f_M(\\mathbf{w}) \\,d^3\\!w = \\int_{\\mathbb{R}^3} \\mathbf{w} f_M(\\mathbf{w}) \\,d^3\\!w + \\mathbf{U} \\int_{\\mathbb{R}^3} f_M(\\mathbf{w}) \\,d^3\\!w$$\n根据定义，第二个积分是数密度 $n$。第一个积分是矢量积分。我们来考察它的第 $i$ 个分量：\n$$\\int_{\\mathbb{R}^3} w_i f_M(\\mathbf{w}) \\,d^3\\!w = \\int_{\\mathbb{R}^3} w_i \\, n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\left(-\\frac{m(w_x^2+w_y^2+w_z^2)}{2T}\\right) \\,d^3\\!w$$\n被积函数是 $w_i$ 的奇函数，因为 $w_i$ 是一个因子，而指数项 $\\exp(-c|\\mathbf{w}|^2)$ 是 $w_i$ 的偶函数。奇函数在对称区间 $(-\\infty, \\infty)$ 上的积分为零。因此，第一个积分的每个分量都为零。\n$$\\int_{\\mathbb{R}^3} \\mathbf{w} f_M(\\mathbf{w}) \\,d^3\\!w = \\mathbf{0}$$\n将此结果代回，我们得到：\n$$n\\,\\mathbf{u}_{calc} = \\mathbf{0} + \\mathbf{U} n \\implies \\mathbf{u}_{calc} = \\mathbf{U}$$\n这证明了分布中的参数 $\\mathbf{U}$ 是体漂移速度。我们现在恢复使用 $\\mathbf{u}$ 表示此参数。\n\n现在我们计算压力张量 $P_{ij}$。根据定义，并使用已验证的事实 $\\mathbf{u}_{calc}=\\mathbf{u}$：\n$$P_{ij} = m \\int_{\\mathbb{R}^3} (v_i - u_i)(v_j-u_j) f_M(\\mathbf{v}) \\,d^3\\!v$$\n切换到中心化速度坐标 $\\mathbf{w} = \\mathbf{v} - \\mathbf{u}$：\n$$P_{ij} = m \\int_{\\mathbb{R}^3} w_i w_j f_M(\\mathbf{w}) \\,d^3\\!w$$\n对于非对角元，其中 $i \\neq j$：\n$$P_{ij} = m \\int_{\\mathbb{R}^3} w_i w_j \\, n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\exp\\left(-\\frac{m|\\mathbf{w}|^2}{2T}\\right) \\,d^3\\!w$$\n考虑关于 $w_i$ 的积分。被积函数是 $w_i$ 的奇函数（一个 $w_i$ 因子乘以关于 $w_i$ 的偶函数）。由于对称性，在对称区间 $w_i \\in (-\\infty, \\infty)$ 上的积分为零。因此，对于这个各向同性的麦克斯韦分布：\n$$P_{ij} = 0 \\quad \\text{for} \\quad i \\neq j$$\n这完成了压力张量非对角元为零的证明。\n\n对于对角元，其中 $i=j$：\n$$P_{ii} = m \\int_{\\mathbb{R}^3} w_i^2 f_M(\\mathbf{w}) \\,d^3\\!w = m n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\int_{\\mathbb{R}^3} w_i^2 \\exp\\left(-\\frac{m|\\mathbf{w}|^2}{2T}\\right) \\,d^3\\!w$$\n让我们明确计算 $P_{xx}$。积分可以分离：\n$$P_{xx} = m n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\left[\\int_{-\\infty}^{\\infty} w_x^2 e^{-\\frac{m w_x^2}{2T}} dw_x\\right] \\left[\\int_{-\\infty}^{\\infty} e^{-\\frac{m w_y^2}{2T}} dw_y\\right] \\left[\\int_{-\\infty}^{\\infty} e^{-\\frac{m w_z^2}{2T}} dw_z\\right]$$\n使用标准积分，令 $a = m/(2T)$：$\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$ 和 $\\int_{-\\infty}^{\\infty} x^2\\exp(-ax^2)dx = \\frac{1}{2a}\\sqrt{\\pi/a}$。\n这三个积分的计算结果为：\n$$\\int_{-\\infty}^{\\infty} w_x^2 e^{-a w_x^2} dw_x = \\frac{1}{2(m/2T)}\\sqrt{\\frac{\\pi}{m/2T}} = \\frac{T}{m}\\sqrt{\\frac{2\\pi T}{m}}$$\n$$\\int_{-\\infty}^{\\infty} e^{-a w_y^2} dw_y = \\sqrt{\\frac{2\\pi T}{m}}$$\n$$\\int_{-\\infty}^{\\infty} e^{-a w_z^2} dw_z = \\sqrt{\\frac{2\\pi T}{m}}$$\n将这些结果代回 $P_{xx}$ 的表达式：\n$$P_{xx} = m n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\left(\\frac{T}{m}\\sqrt{\\frac{2\\pi T}{m}}\\right) \\left(\\sqrt{\\frac{2\\pi T}{m}}\\right) \\left(\\sqrt{\\frac{2\\pi T}{m}}\\right)$$\n$$P_{xx} = m n \\left(\\frac{m}{2\\pi T}\\right)^{3/2} \\frac{T}{m} \\left(\\frac{2\\pi T}{m}\\right)^{3/2} = m n \\frac{T}{m} = nT$$\n由于 $f_M(\\mathbf{w})$ 在 $\\mathbf{w}$ 空间中的球对称性，对角元必须相等：\n$$P_{xx} = P_{yy} = P_{zz} = nT$$\n最后，我们计算标量压力 $p$：\n$$p = \\frac{1}{3} \\mathrm{Tr}\\,\\mathbf{P} = \\frac{1}{3} (P_{xx} + P_{yy} + P_{zz}) = \\frac{1}{3}(nT + nT + nT) = nT$$\n\n我们因此根据基本定义推导出了五个所要求的量。计算出的密度和体漂移速度与分布函数中的参数相匹配，标量压力为 $nT$。结果按要求以符号形式表示。\n\n这五个量是：\n1. 密度：$n$\n2. x方向体漂移速度：$u_x$\n3. y方向体漂移速度：$u_y$\n4. z方向体漂移速度：$u_z$\n5. 标量压力：$nT$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nn  u_x  u_y  u_z  nT\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "像弗拉索夫-玻尔兹曼方程这样的动理学模型之所以强大，是因为它们能够描述超出简单流体理论范畴的现象。本练习通过计算电子对静电波的动理学响应来展示这一点，其中包含了碰撞和捕获粒子的效应。通过将结果与简单的绝热近似进行比较，我们可以量化这种常用简化在何种情况下以及为何会失效，从而更深入地洞察等离子体动力学。",
            "id": "4202204",
            "problem": "考虑一个强磁化均匀等离子体中的静电扰动，其磁场为 $\\mathbf{B} = B \\hat{\\mathbf{z}}$，电子由 Vlasov-Boltzmann 方程描述。扰动的形式为 $\\phi(\\mathbf{r}, t) = \\Re\\{\\phi_0 \\exp[i (k_{\\parallel} z - \\omega t)]\\}$，其中 $\\phi_0$ 为实振幅，$k_{\\parallel}$ 为平行波数，$\\omega$ 为复频率（允许增长或阻尼）。假设准中性条件，使得垂直尺度不影响电子的平行动力学。电子经历的碰撞由速率为 $\\nu_e$ 的 Bhatnagar-Gross-Krook (BGK) 算符建模，且平衡电子分布是麦克斯韦分布，\n$$\nf_{0e}(v_{\\parallel}) = n_{0e} \\left(\\frac{m_e}{2 \\pi T_e}\\right)^{1/2} \\exp\\!\\left(-\\frac{m_e v_{\\parallel}^2}{2 T_e}\\right),\n$$\n其中 $n_{0e}$ 是平衡电子数密度，$T_e$ 是电子温度，$m_e$ 是电子质量。定义电子热速度 $v_{te} = \\sqrt{2 T_e/m_e}$。\n\n我们将电子分解为两个布居：一部分比例为 $1 - f_t$ 的通行电子，它们沿磁力线自由流动；另一部分比例为 $f_t$ 的捕获电子，其弹跳平均的平行流动为零。考虑标度关系 $k_{\\parallel} \\lambda_b \\gg 1$，其中 $\\lambda_b$ 是捕获电子的特征弹跳长度，因此捕获电子感受到的轨道平均平行电场在主导阶上抵消；在此标度关系下，它们对 $\\phi$ 的平行运动学响应在主导阶上可以忽略。相反，通行电子沿磁力线进行动力学响应。\n\n从包含 BGK 碰撞的电子线性化 Vlasov-Boltzmann 方程出发，通过求解扰动分布函数的平行速度矩，推导通行布居的电子数密度扰动，并用等离子体色散函数 $Z(\\zeta)$ 表示，其定义为\n$$\nZ(\\zeta) \\equiv \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} \\frac{\\exp(-x^2)}{x - \\zeta} \\, dx \\quad \\text{for} \\quad \\Im(\\zeta)  0,\n$$\n其自变量为 $\\zeta = (\\omega + i \\nu_e)/(k_{\\parallel} v_{te})$。在所述标度关系下，捕获电子的主导阶密度响应被认为是可忽略的。\n\n定义绝热电子近似为 $\\delta n_{\\mathrm{ad}} = (e \\phi_0/T_e) n_{0e}$，其中 $e$ 是元电荷。设 $\\delta n_e$ 为上述模型下包含通行电子和捕获电子贡献的总电子密度扰动。与绝热电子近似的偏差因子 $\\Delta$ 定义为\n$$\n\\Delta \\equiv \\frac{\\delta n_e}{\\delta n_{\\mathrm{ad}}} - 1.\n$$\n\n推导 $\\Delta$ 作为 $\\omega$、$k_{\\parallel}$、$\\nu_e$、$T_e$、$m_e$ 和 $f_t$ 的函数的闭式解析表达式，仅使用提供的信息和假设。\n\n您的最终答案必须是关于 $\\Delta$ 的单个闭式解析表达式，用上面介绍的符号表示。不需要进行数值计算。",
            "solution": "我们从描述电子分布函数扰动 $\\delta f_e$ 的一维线性化 Vlasov-Boltzmann 方程出发，该方程在磁场平行方向上，并包含一个 BGK 碰撞算符：\n$$\n\\frac{\\partial \\delta f_e}{\\partial t} + v_{\\parallel} \\frac{\\partial \\delta f_e}{\\partial z} + \\frac{F_{\\parallel}}{m_e} \\frac{\\partial f_{0e}}{\\partial v_{\\parallel}} = -\\nu_e \\delta f_e\n$$\n电子（电荷 $q = -e$）受到的平行力来自静电势扰动 $F_{\\parallel} = q E_{\\parallel} = (-e)(-\\partial\\phi/\\partial z) = e \\partial\\phi/\\partial z$。对于形式为 $\\phi \\propto \\exp[i(k_{\\parallel}z - \\omega t)]$ 的扰动，我们可以进行替换 $\\partial/\\partial t \\to -i\\omega$ 和 $\\partial/\\partial z \\to ik_{\\parallel}$。这使得平行力为 $F_{\\parallel} = i e k_{\\parallel} \\phi$。将这些代入 Vlasov 方程，我们得到关于扰动分布函数复振幅的代数方程：\n$$\n(-i\\omega + i k_{\\parallel} v_{\\parallel} + \\nu_e) \\delta f_e = -\\frac{i e k_{\\parallel} \\phi}{m_e} \\frac{\\partial f_{0e}}{\\partial v_{\\parallel}}\n$$\n求解 $\\delta f_e$：\n$$\n\\delta f_e = \\frac{-i e k_{\\parallel} \\phi / m_e}{-i(\\omega - k_{\\parallel} v_{\\parallel}) + \\nu_e} \\frac{\\partial f_{0e}}{\\partial v_{\\parallel}} = \\frac{e k_{\\parallel} \\phi / m_e}{\\omega - k_{\\parallel} v_{\\parallel} + i\\nu_e} \\frac{\\partial f_{0e}}{\\partial v_{\\parallel}}\n$$\n根据问题设定，只有比例为 $(1-f_t)$ 的通行电子对此扰动有动力学响应。因此，我们考虑一个平衡分布为 $f_{0ep} = (1-f_t) f_{0e}$ 的通行布居。其扰动分布 $\\delta f_{ep}$ 为：\n$$\n\\delta f_{ep} = (1-f_t) \\frac{e k_{\\parallel} \\phi / m_e}{\\omega - k_{\\parallel} v_{\\parallel} + i\\nu_e} \\frac{\\partial f_{0e}}{\\partial v_{\\parallel}}\n$$\n对于麦克斯韦平衡分布，$f_{0e}$ 的导数为 $\\frac{\\partial f_{0e}}{\\partial v_{\\parallel}} = f_{0e} \\left(-\\frac{m_e v_{\\parallel}}{T_e}\\right)$。代入此式：\n$$\n\\delta f_{ep} = -(1-f_t) \\frac{e \\phi k_{\\parallel}}{T_e} \\frac{v_{\\parallel}}{\\omega - k_{\\parallel} v_{\\parallel} + i\\nu_e} f_{0e}\n$$\n通行电子的密度扰动 $\\delta n_{ep}$ 是通过对平行速度积分得到的：\n$$\n\\delta n_{ep} = \\int_{-\\infty}^{\\infty} \\delta f_{ep} \\, dv_{\\parallel} = -(1-f_t) \\frac{e \\phi k_{\\parallel}}{T_e} \\int_{-\\infty}^{\\infty} \\frac{v_{\\parallel}}{\\omega - k_{\\parallel} v_{\\parallel} + i\\nu_e} f_{0e}(v_{\\parallel}) \\, dv_{\\parallel}\n$$\n为了计算该积分，我们使用一个标准技巧，将被积函数中的分数部分重写：\n$$\n\\frac{v_{\\parallel}}{\\omega - k_{\\parallel} v_{\\parallel} + i\\nu_e} = \\frac{v_{\\parallel}}{-k_{\\parallel}(v_{\\parallel} - (\\omega+i\\nu_e)/k_{\\parallel})} = -\\frac{1}{k_{\\parallel}} \\left( 1 + \\frac{(\\omega+i\\nu_e)/k_{\\parallel}}{v_{\\parallel} - (\\omega+i\\nu_e)/k_{\\parallel}} \\right)\n$$\n将此代入积分，得到：\n$$\n\\delta n_{ep} = (1-f_t) \\frac{e \\phi}{T_e} \\left( \\int_{-\\infty}^{\\infty} f_{0e} \\, dv_{\\parallel} + \\frac{\\omega+i\\nu_e}{k_{\\parallel}} \\int_{-\\infty}^{\\infty} \\frac{f_{0e}}{v_{\\parallel} - (\\omega+i\\nu_e)/k_{\\parallel}} \\, dv_{\\parallel} \\right)\n$$\n第一个积分就是平衡密度 $n_{0e}$。第二个积分可以用等离子体色散函数 $Z(\\zeta)$ 表示。我们引入归一化速度 $x = v_{\\parallel}/v_{te}$ 和自变量 $\\zeta = (\\omega+i\\nu_e)/(k_{\\parallel} v_{te})$。第二个积分为 $\\frac{n_{0e}}{v_{te}} Z(\\zeta)$。代入这些结果：\n$$\n\\delta n_{ep} = (1-f_t) \\frac{e \\phi}{T_e} \\left( n_{0e} + \\frac{\\omega+i\\nu_e}{k_{\\parallel}} \\frac{n_{0e}}{v_{te}} Z(\\zeta) \\right)\n$$\n由于 $(\\omega+i\\nu_e)/k_{\\parallel} = \\zeta v_{te}$，上式简化为：\n$$\n\\delta n_{ep} = (1-f_t) \\frac{e \\phi n_{0e}}{T_e} [1+\\zeta Z(\\zeta)]\n$$\n根据假设，捕获电子的密度响应可以忽略，因此总电子密度扰动 $\\delta n_e \\approx \\delta n_{ep}$。将复振幅 $\\phi$ 等同于实振幅 $\\phi_0$：\n$$\n\\delta n_e = (1-f_t) \\frac{e \\phi_0 n_{0e}}{T_e} [1+\\zeta Z(\\zeta)]\n$$\n绝热响应的定义是 $\\delta n_{\\mathrm{ad}} = (e \\phi_0/T_e) n_{0e}$。偏差因子 $\\Delta$ 的定义为 $\\Delta = \\delta n_e / \\delta n_{\\mathrm{ad}} - 1$。代入我们的结果：\n$$\n\\Delta = \\frac{(1-f_t) \\frac{e \\phi_0 n_{0e}}{T_e} [1+\\zeta Z(\\zeta)]}{\\frac{e \\phi_0 n_{0e}}{T_e}} - 1 = (1-f_t) [1 + \\zeta Z(\\zeta)] - 1\n$$\n展开并简化表达式：\n$$\n\\Delta = 1 - f_t + (1-f_t) \\zeta Z(\\zeta) - 1 = (1-f_t) \\zeta Z(\\zeta) - f_t\n$$\n这个结果在物理上是合理的：$-f_t$ 项表示由于无响应的捕获电子布居而与完全绝热响应产生的偏差，而 $(1-f_t)\\zeta Z(\\zeta)$ 项是通行电子对绝热响应的动理学校正。",
            "answer": "$$\\boxed{(1-f_t) \\zeta Z(\\zeta) - f_t}$$"
        },
        {
            "introduction": "将动理学方程转化为计算机代码时，必须仔细注意保持基本的物理守恒律。这项计算实践旨在解决一个关键任务：在离散化福克-普朗克碰撞算符的同时，确保粒子数、动量和能量在离散层面上得到精确守恒。通过本练习，你将亲手实践矩守恒修正技术，这对于构建稳健且物理上准确的动理学模拟至关重要。",
            "id": "3999269",
            "problem": "考虑动理学理论中单一离子种类的库仑碰撞项，其在朗道表述中表示为速度空间通量的散度。在各向同性、单一种类、自碰撞的极限情况下，一个常见的替代形式是福克-普朗克（FP）形式，它是一个速度空间上的偏微分方程（PDE）。令 $v$ 表示归一化无量纲单位下的一维速度坐标，其中速度由参考热速度缩放，时间由参考碰撞时间缩放，因此在整个计算过程中不出现任何物理单位。\n\n从朗道自碰撞算符的基本性质出发：\n- 碰撞不变量为 $1$、$v$ 和 $v^2$。\n- 碰撞算符 $C[f]$ 必须满足精确的矩平衡\n$$\n\\int_{-\\infty}^{\\infty} C[f](v)\\,\\mathrm{d}v = 0,\\quad\n\\int_{-\\infty}^{\\infty} v\\,C[f](v)\\,\\mathrm{d}v = 0,\\quad\n\\int_{-\\infty}^{\\infty} v^2\\,C[f](v)\\,\\mathrm{d}v = 0,\n$$\n当其作用于任何充分衰减的分布 $f(v)$ 时，分别反映了粒子数、动量和能量的守恒。\n\n你的任务是设计并实现一种速度空间离散化方法，该方法通过强制矩平衡，在离散层面上精确地满足这些守恒性质。使用均匀网格上的守恒有限体积离散化方法来近似朗道算符的一维各向同性 FP 替代模型：\n- 令碰撞算符具有通量-散度形式\n$$\nC[f](v) = \\nu\\,\\frac{\\partial}{\\partial v}\\left(A(v)\\,f(v) + D\\,\\frac{\\partial f}{\\partial v}\\right),\n$$\n其中 $\\nu$ 是一个恒定的碰撞频率（无量纲），对于给定的漂移速度 $u$（无量纲），摩擦系数为 $A(v) = v - u$，速度空间扩散系数为 $D = \\theta$，其中 $\\theta$ 是一个无量纲的温度参数。该替代模型在连续极限下满足碰撞不变量。\n- 将 $v \\in [v_{\\min}, v_{\\max}]$ 均匀离散化，得到 $N$ 个单元中心 $v_j$ 和间距 $\\Delta v$，并定义 $N+1$ 个跨越相同区间的单元面 $v_{j+1/2}$。\n- 通过对通量散度进行有限体积近似来构造原始离散算符 $C_j^{\\mathrm{raw}}$，其中内部单元面上的通量使用对 $f$ 和 $\\partial f/\\partial v$ 的一致中心近似计算，并在区域边界处设置零通量。\n\n为实现精确的离散守恒，应用一个矩守恒修正。使用梯形法则权重 $w_j$ 在网格上定义离散内积，使得内部单元的权重为 $w_j = \\Delta v$，端点的权重为 $w_0 = w_{N-1} = \\Delta v/2$。令 $\\boldsymbol{M}(v) = \\left[1, v, v^2\\right]^\\top$ 表示在网格点上求值的不变量向量。你修正后的离散算符 $C_j$ 必须满足以下精确的离散矩约束：\n$$\n\\sum_{j=0}^{N-1} w_j\\,C_j = 0,\\quad \\sum_{j=0}^{N-1} w_j\\,v_j\\,C_j = 0,\\quad \\sum_{j=0}^{N-1} w_j\\,v_j^2\\,C_j = 0.\n$$\n设计一种系统性的修正方法，将任何原始算符 $\\boldsymbol{C}^{\\mathrm{raw}}$ 映射到一个能精确满足这三个约束的修正算符 $\\boldsymbol{C}$。\n\n按以下步骤实现算法：\n- 构建一个均匀速度网格并计算分布 $f(v)$ 的值。\n- 离散化通量-散度以获得原始算符。\n- 使用最小秩修正构建一个矩守恒修正，以精确地强制满足三个离散矩约束。\n- 报告修正后三个约束的离散残差。\n\n在测试套件中使用以下麦克斯韦测试分布，其数密度归一化为1：\n$$\nf(v) = \\frac{1}{\\sqrt{2\\pi\\,\\theta}}\\exp\\left(-\\frac{(v-u)^2}{2\\,\\theta}\\right).\n$$\n所有量均为无量纲，且不使用角度单位。\n\n测试套件（每个测试用例指定网格和分布参数）：\n1. 理想情况（细网格、零漂移、中等温度）：$N=401$，$v_{\\min}=-6$，$v_{\\max}=6$，$u=0$，$\\theta=1$，$\\nu=1$。\n2. 边界受力情况（粗网格、非零漂移、较低温度）：$N=81$，$v_{\\min}=-4$，$v_{\\max}=4$，$u=1.2$，$\\theta=0.5$，$\\nu=1$。\n3. 偏斜极端情况（中等网格、大漂移、低温）：$N=121$，$v_{\\min}=-5$，$v_{\\max}=5$，$u=2.5$，$\\theta=0.2$，$\\nu=1$。\n\n对于每个测试用例，你的程序必须计算修正后的算符，然后计算三个离散残差\n$$\nR_0 = \\sum_{j=0}^{N-1} w_j\\,C_j,\\quad R_1 = \\sum_{j=0}^{N-1} w_j\\,v_j\\,C_j,\\quad R_2 = \\sum_{j=0}^{N-1} w_j\\,v_j^2\\,C_j.\n$$\n对于每个测试用例，返回一个浮点数，其值为 $\\max\\left(|R_0|,|R_1|,|R_2|\\right)$，并四舍五入到12位小数。\n\n最终输出格式：\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3]$），其中 $r_k$ 是为测试用例 $k$ 定义的浮点数。所有输出均为无量纲数。",
            "solution": "解决方案首先通过有限体积法离散化福克-普朗克算符，然后应用一个修正，以确保数值格式在离散意义上精确地守恒粒子数、动量和能量。\n\n令一维福克-普朗克碰撞算符由下式给出：\n$$\nC[f](v) = \\nu\\,\\frac{\\partial}{\\partial v}\\left((v-u)f(v) + \\theta \\frac{\\partial f}{\\partial v}\\right) \\equiv \\frac{\\partial J}{\\partial v}\n$$\n其中通量为 $J(v) = \\nu\\left((v-u)f(v) + \\theta \\frac{\\partial f}{\\partial v}\\right)$。\n\n我们将速度域 $[v_{\\min}, v_{\\max}]$ 离散化为 $N$ 个单元，其中心为 $v_j$（$j=0, \\dots, N-1$），均匀间距为 $\\Delta v$。单元面位于 $v_{j+1/2}$。有限体积法通过考虑穿过单元面的通量平衡来近似每个单元中心 $v_j$ 处的算符：\n$$\nC_j \\approx \\frac{J_{j+1/2} - J_{j-1/2}}{\\Delta v}\n$$\n为了计算内部面 $v_{j+1/2}$ 上的通量，我们对分布函数 $f$ 及其导数使用中心有限差分近似：\n$$\nf(v_{j+1/2}) \\approx \\frac{f_j + f_{j+1}}{2}, \\quad \\left.\\frac{\\partial f}{\\partial v}\\right|_{v_{j+1/2}} \\approx \\frac{f_{j+1} - f_j}{\\Delta v}\n$$\n将这些代入通量表达式，可得内部通量 $J_{j+1/2}$。问题指定了零通量边界条件，这意味着在区域边界上的通量为零。这给了我们一个原始、未修正的离散算符 $C_j^{\\mathrm{raw}}$。\n\n由于离散化误差，该原始算符通常不满足离散守恒律。我们使用梯形法则定义离散矩，其中内部点的权重为 $w_j = \\Delta v$，端点的权重为 $w_0 = w_{N-1} = \\Delta v/2$。原始矩残差为 $R_k^{\\mathrm{raw}} = \\sum_j w_j v_j^k C_j^{\\mathrm{raw}}$，$k=0, 1, 2$。\n\n为了强制实现精确的离散守恒，我们引入一个修正项 $C_j^{\\mathrm{corr}} = \\alpha_0 + \\alpha_1 v_j + \\alpha_2 v_j^2$，使得修正后的算符 $C_j = C_j^{\\mathrm{raw}} + C_j^{\\mathrm{corr}}$ 满足 $\\sum_j w_j v_j^k C_j = 0$。这意味着修正项必须满足：\n$$\n\\sum_{j=0}^{N-1} w_j v_j^k (\\alpha_0 + \\alpha_1 v_j + \\alpha_2 v_j^2) = -R_k^{\\mathrm{raw}} \\quad \\text{for } k=0, 1, 2\n$$\n这可以写成矩阵形式 $\\boldsymbol{G} \\boldsymbol{\\alpha} = -\\boldsymbol{R}^{\\mathrm{raw}}$，其中 $\\boldsymbol{\\alpha} = [\\alpha_0, \\alpha_1, \\alpha_2]^\\top$。$3 \\times 3$ 矩阵 $\\boldsymbol{G}$ 是格拉姆矩阵，其元素是 $G_{ik} = \\sum_{j} w_j v_j^i v_j^k$。\n\n实现的算法如下：\n1.  建立均匀速度网格 $v_j$ 并计算麦克斯韦分布 $f_j$ 的值。\n2.  计算所有内部面上的通量 $J_{j+1/2}$。\n3.  构造包含零通量边界条件的原始离散算符 $C_j^{\\mathrm{raw}}$。\n4.  计算三个原始矩残差 $R_k^{\\mathrm{raw}}$。\n5.  组装 $3 \\times 3$ 的格拉姆矩阵 $\\boldsymbol{G}$。\n6.  求解线性系统 $\\boldsymbol{G} \\boldsymbol{\\alpha} = -\\boldsymbol{R}^{\\mathrm{raw}}$ 以找到修正系数 $\\boldsymbol{\\alpha}$。\n7.  构造修正后的算符 $C_j = C_j^{\\mathrm{raw}} + (\\alpha_0 + \\alpha_1 v_j + \\alpha_2 v_j^2)$。\n8.  计算最终的矩残差 $R_k$。根据构造，这些值在浮点精度范围内应为零，其最大值即为所求结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n\n    def calculate_max_residual(N, vmin, vmax, u, theta, nu):\n        \"\"\"\n        Calculates the maximum moment residual for a corrected Fokker-Planck operator.\n\n        Args:\n            N (int): Number of grid points.\n            vmin (float): Minimum velocity.\n            vmax (float): Maximum velocity.\n            u (float): Drift velocity of the Maxwellian distribution.\n            theta (float): Temperature parameter of the Maxwellian distribution.\n            nu (float): Collision frequency.\n\n        Returns:\n            float: The maximum absolute value of the three final moment residuals,\n                   rounded to 12 decimal places.\n        \"\"\"\n        # Step 1: Set up the uniform velocity grid\n        dv = (vmax - vmin) / (N - 1)\n        v = np.linspace(vmin, vmax, N)\n\n        # Step 2: Evaluate the Maxwellian distribution function on the grid\n        f = (1.0 / np.sqrt(2 * np.pi * theta)) * np.exp(-((v - u)**2) / (2 * theta))\n\n        # Step 3: Compute fluxes at N-1 interior cell faces\n        # Face locations\n        v_faces_interior = v[:-1] + dv / 2.0\n        # Centered approximation for f at faces\n        f_faces = (f[:-1] + f[1:]) / 2.0\n        # Centered approximation for df/dv at faces\n        dfdv_faces = (f[1:] - f[:-1]) / dv\n\n        # Flux J = nu * ((v-u)*f + theta*df/dv)\n        J_interior = nu * ((v_faces_interior - u) * f_faces + theta * dfdv_faces)\n\n        # Step 4: Construct the raw discrete operator C_raw\n        # Create a full flux vector of size N+1 for all faces\n        J_full = np.zeros(N + 1)\n        # Populate with interior fluxes\n        J_full[1:N] = J_interior\n        # Boundary conditions are zero flux, so J_full[0] and J_full[N] remain 0\n\n        # Finite volume formulation: C_j = (J_{j+1/2} - J_{j-1/2}) / dv\n        C_raw = (J_full[1:] - J_full[:-1]) / dv\n\n        # Step 5: Define trapezoidal rule weights for discrete inner product\n        w = np.full(N, dv)\n        w[0] = dv / 2.0\n        w[-1] = dv / 2.0\n\n        # Step 6: Compute the three raw moment residuals before correction\n        R0_raw = np.sum(w * C_raw)\n        R1_raw = np.sum(w * v * C_raw)\n        R2_raw = np.sum(w * (v**2) * C_raw)\n        R_raw_vec = np.array([R0_raw, R1_raw, R2_raw])\n\n        # Step 7: Construct the 3x3 Gram matrix G for the moment-preserving correction\n        # G_ik = sum_j(w_j * v_j^i * v_j^k)\n        G = np.zeros((3, 3))\n        m = [np.ones(N), v, v**2]\n        for i in range(3):\n            for k in range(3):\n                G[i, k] = np.sum(w * m[i] * m[k])\n\n        # Step 8: Solve the linear system G * alpha = -R_raw for the correction coefficients\n        alpha = np.linalg.solve(G, -R_raw_vec)\n\n        # Step 9: Construct the corrected operator C\n        C_corr = alpha[0] + alpha[1] * v + alpha[2] * (v**2)\n        C = C_raw + C_corr\n\n        # Step 10: Compute the final residuals of the corrected operator\n        # These should be zero up to floating-point precision.\n        R0_final = np.sum(w * C)\n        R1_final = np.sum(w * v * C)\n        R2_final = np.sum(w * (v**2) * C)\n\n        # Step 11: Find the maximum absolute residual and round\n        max_residual = max(abs(R0_final), abs(R1_final), abs(R2_final))\n\n        return round(max_residual, 12)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, vmin, vmax, u, theta, nu)\n        (401, -6.0, 6.0, 0.0, 1.0, 1.0),\n        (81, -4.0, 4.0, 1.2, 0.5, 1.0),\n        (121, -5.0, 5.0, 2.5, 0.2, 1.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        N, vmin, vmax, u, theta, nu = case\n        result = calculate_max_residual(N, vmin, vmax, u, theta, nu)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}