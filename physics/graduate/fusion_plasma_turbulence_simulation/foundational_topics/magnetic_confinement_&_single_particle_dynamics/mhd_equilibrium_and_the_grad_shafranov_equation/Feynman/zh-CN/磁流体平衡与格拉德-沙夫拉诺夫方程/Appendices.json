{
    "hands_on_practices": [
        {
            "introduction": "理解磁轴附近的等离子体行为是MHD平衡研究的基石。本练习将抽象的Grad-Shafranov方程与具体的物理性质联系起来，通过在磁轴附近进行泰勒展开，揭示了磁面的局部曲率如何由等离子体压力和电流的梯度决定。这项实践旨在帮助你从一个关键的物理极限中直观地理解平衡条件的内涵，即等离子体分布与磁场位形是如何自洽地相互决定的。",
            "id": "4196413",
            "problem": "考虑一个环形装置中的轴对称理想磁流体力学 (MHD) 平衡，采用柱坐标 $(R,\\phi,Z)$，磁轴位于 $(R_0,0)$。设极向磁通函数为 $\\psi(R,Z)$，并假设其具有如下形式的近轴展开\n$$\n\\psi(R,Z)=\\psi_0+\\frac{1}{2}a\\,(R-R_0)^2+\\frac{1}{2}b\\,Z^2,\n$$\n其中 $\\psi_0=\\psi(R_0,0)$，$a$ 和 $b$ 是常数，分别表示 $\\psi$ 在磁轴附近径向和垂直方向上的局部曲率。假设平衡压强和环向场函数是满足 $p=p(\\psi)$ 和 $F=F(\\psi)$ 的磁通函数，其中 $F(\\psi)=R B_{\\phi}$，并允许如下的近轴展开\n$$\np(\\psi)=p_{\\mathrm{axis}}+\\alpha\\,(\\psi-\\psi_0)+\\mathcal{O}((\\psi-\\psi_0)^2),\\qquad F(\\psi)=F_0+\\gamma\\,(\\psi-\\psi_0)+\\mathcal{O}((\\psi-\\psi_0)^2),\n$$\n其中常数 $\\alpha=\\left.\\dfrac{dp}{d\\psi}\\right|_{\\psi_0}$，$F_0=F(\\psi_0)$，以及 $\\gamma=\\left.\\dfrac{dF}{d\\psi}\\right|_{\\psi_0}$。从轴对称理想 MHD 平衡和 Grad–Shafranov 方程出发，推导近轴展开对组合 $a+b$ 所施加的领头阶约束。将最终答案表示为由 $\\mu_0$、$R_0$、$\\alpha$、$F_0$ 和 $\\gamma$ 组成的单个闭合形式解析表达式。无需进行数值计算或四舍五入，最终表达式中不应包含单位。",
            "solution": "该问题要求在轴对称理想磁流体力学 (MHD) 平衡中，推导极向磁通函数 $\\psi$ 的近轴展开参数所满足的一个约束条件。出发点是 Grad-Shafranov 方程，该方程控制着此类平衡。\n\nGrad-Shafranov 方程由下式给出：\n$$\n\\Delta^* \\psi = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F \\frac{dF}{d\\psi}\n$$\n其中 $\\psi$ 是极向磁通，$p(\\psi)$ 是等离子体压强，$F(\\psi) = R B_{\\phi}$ 是环向场函数，$\\mu_0$ 是真空磁导率。坐标系为柱坐标 $(R,\\phi,Z)$。Grad-Shafranov 算符 $\\Delta^*$ 定义为：\n$$\n\\Delta^* \\psi \\equiv R \\frac{\\partial}{\\partial R} \\left(\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^2 \\psi}{\\partial Z^2}\n$$\n展开第一项，该算符可写作：\n$$\n\\Delta^* \\psi = \\frac{\\partial^2 \\psi}{\\partial R^2} - \\frac{1}{R} \\frac{\\partial \\psi}{\\partial R} + \\frac{\\partial^2 \\psi}{\\partial Z^2}\n$$\n问题指明磁轴位于 $(R,Z)=(R_0,0)$。我们将在此点计算 Grad-Shafranov 方程。为此，我们需要利用给定的近轴展开式，计算磁轴上方程左侧 (LHS) 和右侧 (RHS) 的各项。\n\n首先，我们分析方程的左侧。给定 $\\psi(R,Z)$ 的近轴展开式：\n$$\n\\psi(R,Z) = \\psi_0 + \\frac{1}{2}a(R-R_0)^2 + \\frac{1}{2}b Z^2\n$$\n我们计算 $\\psi$ 的必要偏导数：\n$$\n\\frac{\\partial \\psi}{\\partial R} = a(R-R_0)\n$$\n$$\n\\frac{\\partial^2 \\psi}{\\partial R^2} = a\n$$\n$$\n\\frac{\\partial \\psi}{\\partial Z} = bZ\n$$\n$$\n\\frac{\\partial^2 \\psi}{\\partial Z^2} = b\n$$\n注意，磁轴的条件 $\\nabla \\psi = 0$ 在 $(R,Z)=(R_0,0)$ 处是满足的，因为 $\\left.\\frac{\\partial \\psi}{\\partial R}\\right|_{(R_0,0)} = a(R_0-R_0) = 0$ 且 $\\left.\\frac{\\partial \\psi}{\\partial Z}\\right|_{(R_0,0)} = b(0) = 0$。\n\n现在，我们在磁轴 $(R_0,0)$ 处计算 $\\Delta^*$ 算符的每一项：\n$$\n\\left. \\frac{\\partial^2 \\psi}{\\partial R^2} \\right|_{(R_0,0)} = a\n$$\n$$\n\\left. \\frac{1}{R} \\frac{\\partial \\psi}{\\partial R} \\right|_{(R_0,0)} = \\frac{1}{R_0} \\left( a(R_0-R_0) \\right) = 0\n$$\n$$\n\\left. \\frac{\\partial^2 \\psi}{\\partial Z^2} \\right|_{(R_0,0)} = b\n$$\n将这些代入左侧的表达式，我们得到其在磁轴处的值：\n$$\n\\left. \\Delta^* \\psi \\right|_{(R_0,0)} = a - 0 + b = a+b\n$$\n\n接下来，我们在磁轴 $(R_0,0)$ 处计算 Grad-Shafranov 方程的右侧。右侧为：\n$$\n- \\mu_0 R^2 \\frac{dp}{d\\psi} - F \\frac{dF}{d\\psi}\n$$\n在磁轴处，$R=R_0$，$Z=0$，且 $\\psi = \\psi_0$。给定压强 $p(\\psi)$ 和环向场函数 $F(\\psi)$ 的近轴展开式：\n$$\np(\\psi) = p_{\\mathrm{axis}} + \\alpha(\\psi-\\psi_0) + \\mathcal{O}((\\psi-\\psi_0)^2)\n$$\n$$\nF(\\psi) = F_0 + \\gamma(\\psi-\\psi_0) + \\mathcal{O}((\\psi-\\psi_0)^2)\n$$\n从这些展开式中，我们可以求得关于 $\\psi$ 的导数：\n$$\n\\frac{dp}{d\\psi} = \\alpha + \\mathcal{O}(\\psi-\\psi_0)\n$$\n$$\n\\frac{dF}{d\\psi} = \\gamma + \\mathcal{O}(\\psi-\\psi_0)\n$$\n在磁轴处 ($\\psi=\\psi_0$) 计算这些量的值：\n$$\n\\left. \\frac{dp}{d\\psi} \\right|_{\\psi=\\psi_0} = \\alpha\n$$\n$$\nF(\\psi_0) = F_0\n$$\n$$\n\\left. \\frac{dF}{d\\psi} \\right|_{\\psi=\\psi_0} = \\gamma\n$$\n将这些值以及 $R=R_0$ 代入右侧的表达式中：\n$$\n\\left. \\left( - \\mu_0 R^2 \\frac{dp}{d\\psi} - F \\frac{dF}{d\\psi} \\right) \\right|_{(R_0,0)} = - \\mu_0 R_0^2 \\left. \\frac{dp}{d\\psi} \\right|_{\\psi_0} - F(\\psi_0) \\left. \\frac{dF}{d\\psi} \\right|_{\\psi_0} = - \\mu_0 R_0^2 \\alpha - F_0 \\gamma\n$$\n\n最后，我们将在磁轴处计算的 Grad-Shafranov 方程的左侧和右侧相等：\n$$\na+b = - \\mu_0 R_0^2 \\alpha - F_0 \\gamma\n$$\n该方程表示了磁轴附近的 MHD 平衡条件对组合 $a+b$ 施加的领头阶约束。参数 $a$ 和 $b$ 描述了嵌套磁通面的局部曲率，而此表达式将该曲率与压强和环向场函数的局部梯度联系起来。",
            "answer": "$$ \\boxed{- \\mu_0 R_0^2 \\alpha - F_0 \\gamma} $$"
        },
        {
            "introduction": "在完成了对磁轴的局部分析之后，我们转向一个完整的解析平衡模型。本练习将探讨一种广泛应用的Solov'ev平衡，其特点是压强函数 $p(\\psi)$ 和环向场函数 $F(\\psi)$ 具有简单的线性形式。通过分析不同的参数选择如何影响环向电流密度 $J_{\\phi}$ 的空间分布，你将深入理解等离子体位形是如何被“设计”的，并掌握沙夫拉诺夫位移、电流峰化以及电流反转等重要物理概念。",
            "id": "4196435",
            "problem": "考虑一个托卡马克中的静态、轴对称磁流体动力学（MHD）平衡，其中的磁场可以用极向磁通函数 $\\,\\psi(R,Z)\\,$ 和环向场函数 $\\,F(\\psi) = R B_{\\phi}\\,$ 来表示。该主导平衡由 $\\,\\nabla p = \\mathbf{J} \\times \\mathbf{B}\\,$ 和 $\\,\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}\\,$，以及 $\\,\\nabla \\cdot \\mathbf{B} = 0\\,$ 和轴对称性共同构建。在此类平衡中，标量压强 $\\,p(\\psi)\\,$ 和环向场函数 $\\,F(\\psi)\\,$ 决定了通过轴对称力平衡驱动极向磁通 $\\,\\psi(R,Z)\\,$ 的源项。环向电流密度 $\\,J_{\\phi}(R,Z)\\,$ 遵循安培定律，并且可以用这些源函数和几何因子来表示。\n\n假设一个大环径比托卡马克，其大半径为 $\\,R_{0}\\,$，小半径为 $\\,a\\,$，使得闭合磁面包含在柱坐标半径范围 $\\,R \\in [R_{\\min},R_{\\max}] = [R_{0}-a,\\,R_{0}+a]\\,$ 内。考虑两种由 $\\,\\psi\\,$ 的线性函数定义的Solov’ev类型的参数选择：\n\n- 组 $\\,\\mathsf{S1}\\,$：$\\,p(\\psi) = p_{0} - \\alpha \\psi\\,$，其中 $\\,\\alpha > 0\\,$，以及 $\\,F(\\psi) = F_{0}\\,$（因此 $\\,F'(\\psi) = 0\\,$）。\n- 组 $\\,\\mathsf{S2}\\,$：$\\,p(\\psi) = p_{0} - \\alpha \\psi\\,$，其中 $\\,\\alpha > 0\\,$，以及 $\\,F(\\psi) = F_{0} + \\beta \\psi\\,$，其中 $\\,\\beta \\neq 0\\,$ 的选择使得乘积 $\\,F(\\psi) F'(\\psi)\\,$ 在整个等离子体区域近似恒定，并等于一个正参数 $\\,b > 0\\,$。\n\n从上述平衡定律出发（不使用简化公式），推导在这些参数化下环向电流密度 $\\,J_{\\phi}(R,Z)\\,$ 对 $\\,R\\,$ 的依赖关系，并用此来评估在每个闭合磁面上得到的 $\\,J_{\\phi}\\,$ 分布的物理合理性。特别是，讨论符号确定性、高场侧（HFS，较小的 $\\,R\\,$）和低场侧（LFS，较大的 $\\,R\\,$）之间的极向变化，以及出现反向电流区域的可能性。\n\n下列哪个陈述是正确的？\n\nA. 在 $\\,\\mathsf{S1}\\,$ 组下，环向电流密度 $\\,J_{\\phi}\\,$ 是一个磁通函数（在每个磁面上是常数），导致极向均匀的电流和一个物理上合理的、轴上峰化的剖面。\n\nB. 在 $\\,\\mathsf{S2}\\,$ 组下，当 $\\,b > \\mu_{0} \\alpha R_{\\max}^{2}\\,$ 时，环向电流密度 $\\,J_{\\phi}\\,$ 在高场侧和低场侧符号相同，并且由于 $\\,1/R\\,$ 的贡献，在高场侧更大，从而避免了反向电流区域并保持了物理上的合理性。\n\nC. 对于任何具有恒定 $\\,p'(\\psi)\\,$ 和近似恒定 $\\,F(\\psi) F'(\\psi)\\,$ 的Solov’ev平衡，环向电流密度 $\\,J_{\\phi}\\,$ 必然在磁轴处发散，这使得此类解在物理上不合理。\n\nD. 在 $\\,\\mathsf{S2}\\,$ 组下，如果 $\\,\\mu_{0} \\alpha R_{\\min}^{2}  b  \\mu_{0} \\alpha R_{\\max}^{2}\\,$，环向电流在同一磁面上的高场侧和低场侧之间会改变符号，这在Solov’ev平衡中是不可避免的，因此使其无法代表托卡马克放电。",
            "solution": "该问题陈述是磁流体动力学（MHD）平衡理论中的一个有效练习。它科学地基于理想磁流体动力学原理，是适定的、客观的，并为严格的推导和分析提供了所有必要的信息。所提供的参数化，即所谓的Solov’ev型平衡，是该领域的标准方法。\n\n第一步是从所给的MHD平衡基本定律推导出环向电流密度 $\\,J_{\\phi}(R,Z)\\,$ 的表达式：\n1.  力平衡：$\\,\\nabla p = \\mathbf{J} \\times \\mathbf{B}\\,$\n2.  安培定律：$\\,\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}\\,$\n\n在轴对称系统中，磁场 $\\,\\mathbf{B}\\,$ 可以表示为：\n$$ \\mathbf{B} = \\frac{1}{R} \\nabla\\psi \\times \\hat{\\phi} + \\frac{F(\\psi)}{R}\\hat{\\phi} $$\n其中 $\\,\\psi(R,Z)\\,$ 是极向磁通，$\\,F(\\psi) = R B_{\\phi}\\,$ 是环向场函数，$\\,(R, \\phi, Z)\\,$ 是柱坐标。磁场的极向分量为 $\\,B_R = -\\frac{1}{R}\\frac{\\partial\\psi}{\\partial Z}\\,$ 和 $\\,B_Z = \\frac{1}{R}\\frac{\\partial\\psi}{\\partial R}\\,$。\n\n电流密度 $\\,\\mathbf{J}\\,$ 可以分解为极向和环向部分，$\\,\\mathbf{J} = \\mathbf{J}_p + J_{\\phi}\\hat{\\phi}\\,$。根据安培定律，我们有：\n$$ \\mu_{0} J_{\\phi} = (\\nabla \\times \\mathbf{B}_p) \\cdot \\hat{\\phi} = \\frac{\\partial B_R}{\\partial Z} - \\frac{\\partial B_Z}{\\partial R} $$\n$$ \\mu_{0} \\mathbf{J}_p = \\nabla \\times \\mathbf{B}_{\\phi} = \\nabla \\times \\left(\\frac{F(\\psi)}{R}\\hat{\\phi}\\right) $$\n从力平衡方程 $\\,\\nabla p = \\mathbf{J} \\times \\mathbf{B}\\,$ 以及压强是磁通函数 $\\,p=p(\\psi)\\,$ 这一事实，我们得到 $\\,\\nabla p = p'(\\psi)\\nabla\\psi\\,$。\n代入 $\\,\\mathbf{J}\\,$ 和 $\\,\\mathbf{B}\\,$ 的表达式：\n$$ p'(\\psi)\\nabla\\psi = (\\mathbf{J}_p + J_{\\phi}\\hat{\\phi}) \\times (\\mathbf{B}_p + B_{\\phi}\\hat{\\phi}) $$\n$$ p'(\\psi)\\nabla\\psi = (\\mathbf{J}_p \\times \\mathbf{B}_p) + (\\mathbf{J}_p \\times B_{\\phi}\\hat{\\phi}) + (J_{\\phi}\\hat{\\phi} \\times \\mathbf{B}_p) + (J_{\\phi}\\hat{\\phi} \\times B_{\\phi}\\hat{\\phi}) $$\n在轴对称平衡中，$\\,\\mathbf{J}_p\\,$ 平行于 $\\,\\mathbf{B}_p\\,$，所以 $\\,\\mathbf{J}_p \\times \\mathbf{B}_p = 0\\,$。最后一项也为零。剩下：\n$$ p'(\\psi)\\nabla\\psi = B_{\\phi} (\\mathbf{J}_p \\times \\hat{\\phi}) + J_{\\phi}(\\hat{\\phi} \\times \\mathbf{B}_p) $$\n对 $\\,\\mathbf{J}_p = (\\nabla \\times \\mathbf{B}_{\\phi})/\\mu_0\\,$ 的详细计算表明 $\\,\\mathbf{J}_p = \\frac{F'(\\psi)}{\\mu_0}\\mathbf{B}_p\\,$。\n将此代入力平衡方程得到：\n$$ p'(\\psi)\\nabla\\psi = \\frac{F'(\\psi)B_{\\phi}}{\\mu_0}(\\mathbf{B}_p \\times \\hat{\\phi}) + J_{\\phi}(\\hat{\\phi} \\times \\mathbf{B}_p) $$\n使用恒等式 $\\,\\hat{\\phi} \\times \\mathbf{B}_p = -(\\mathbf{B}_p \\times \\hat{\\phi})\\,$ 并表示 $\\,\\mathbf{B}_p \\times \\hat{\\phi} = -\\frac{1}{R}\\nabla\\psi\\,$：\n$$ p'(\\psi)\\nabla\\psi = \\left( J_{\\phi} - \\frac{F'(\\psi) B_{\\phi}}{\\mu_0} \\right)(-\\frac{1}{R}\\nabla\\psi) $$\n令 $\\,\\nabla\\psi\\,$ 的标量系数相等，并代入 $\\,B_{\\phi} = F(\\psi)/R\\,$：\n$$ p'(\\psi) = -\\frac{1}{R}\\left(J_{\\phi} - \\frac{F(\\psi)F'(\\psi)}{\\mu_0 R}\\right) $$\n解出 $\\,J_{\\phi}\\,$ 得到所需的环向电流密度表达式：\n$$ J_{\\phi}(R, Z) = R p'(\\psi) + \\frac{F(\\psi) F'(\\psi)}{\\mu_0 R} $$\n这个基本结果表明，由于其对 $\\,R\\,$ 的显式依赖，$\\,J_{\\phi}\\,$ 通常不是一个磁通函数。\n\n现在我们分析两种具体的参数组。\n\n**分析 $\\,\\mathsf{S1}\\,$ 组**\n给定：$\\,p(\\psi) = p_{0} - \\alpha \\psi\\,$ (所以 $\\,p'(\\psi) = -\\alpha\\,$，其中 $\\,\\alpha  0\\,$) 且 $\\,F(\\psi) = F_{0}\\,$ (所以 $\\,F'(\\psi) = 0\\,$)。\n将这些代入 $\\,J_{\\phi}\\,$ 的表达式中：\n$$ J_{\\phi}(R,Z) = R(-\\alpha) + \\frac{F_0 \\cdot 0}{\\mu_0 R} = -\\alpha R $$\n环向电流密度为 $\\,J_{\\phi} = -\\alpha R\\,$。\n- **磁通函数**：磁通函数在等 $\\,\\psi\\,$ 面上是常数。由于 $\\,R\\,$ 在托卡马克的磁面上是变化的，因此 $\\,J_{\\phi}\\,$ 不是磁通函数。电流不是极向均匀的。\n- **极向变化**：电流的大小为 $\\,|J_{\\phi}| = \\alpha R\\,$。它在高场侧（HFS，较小的 $\\,R\\,$）较小，在低场侧（LFS，较大的 $\\,R\\,$）较大。\n- **剖面形状**：电流剖面是“空心”的，意味着电流密度的大小在最大大半径 $\\,R_{max}\\,$ 处达到峰值，而不是在磁轴上。\n这种剖面在物理上是可能的，但与选项A中的描述不符。\n\n**分析 $\\,\\mathsf{S2}\\,$ 组**\n给定：$\\,p'(\\psi) = -\\alpha\\,$ 且 $\\,F(\\psi)F'(\\psi) \\approx b\\,$，其中 $\\,b  0\\,$ 是一个常数。\n将这些代入 $\\,J_{\\phi}\\,$ 的表达式中：\n$$ J_{\\phi}(R,Z) = R(-\\alpha) + \\frac{b}{\\mu_0 R} = \\frac{b - \\mu_0 \\alpha R^2}{\\mu_0 R} $$\n$\\,J_{\\phi}\\,$ 的符号和行为取决于这两项之间的竞争。电流在半径 $\\,R_{rev} = \\sqrt{b/(\\mu_0 \\alpha)}\\,$ 处改变符号。\n\n现在我们评估每个选项。\n\n**A. 在 $\\,\\mathsf{S1}\\,$ 组下，环向电流密度 $\\,J_{\\phi}\\,$ 是一个磁通函数（在每个磁面上是常数），导致极向均匀的电流和一个物理上合理的、轴上峰化的剖面。**\n如上所推导，对于 $\\,\\mathsf{S1}\\,$ 组，$\\,J_{\\phi} = -\\alpha R\\,$。这不是一个磁通函数，电流不是极向均匀的，并且剖面是空心的（在大的 $\\,R\\,$ 处达到峰值），而不是轴上峰化的。此陈述中的每一项主张都是错误的。\n**结论：不正确**\n\n**B. 在 $\\,\\mathsf{S2}\\,$ 组下，当 $\\,b  \\mu_{0} \\alpha R_{\\max}^{2}\\,$ 时，环向电流密度 $\\,J_{\\phi}\\,$ 在高场侧和低场侧符号相同，并且由于 $\\,1/R\\,$ 的贡献，在高场侧更大，从而避免了反向电流区域并保持了物理上的合理性。**\n条件 $\\,b  \\mu_{0} \\alpha R_{\\max}^{2}\\,$ 意味着 $\\,b/(\\mu_0 \\alpha)  R_{\\max}^2\\,$。电流反转半径为 $\\,R_{rev} = \\sqrt{b/(\\mu_0 \\alpha)}  R_{max}\\,$。由于所有等离子体都包含在 $\\,R \\leq R_{max}\\,$ 内部，因此反转半径在等离子体之外。对于等离子体中的任何 $\\,R\\,$，都有 $\\,\\mu_0 \\alpha R^2  \\mu_0 \\alpha R_{max}^2  b\\,$。因此，分子 $\\,b - \\mu_0 \\alpha R^2\\,$ 总是正的。由于 $\\,\\mu_0 R  0\\,$，$\\,J_{\\phi}\\,$ 处处为正。这就避免了反向电流区域。\n为了确定极向变化，我们考察其对 $\\,R\\,$ 的导数：\n$$ \\frac{d J_{\\phi}}{d R} = \\frac{d}{dR}\\left(-\\alpha R + \\frac{b}{\\mu_0 R}\\right) = -\\alpha - \\frac{b}{\\mu_0 R^2} $$\n由于 $\\,\\alpha  0\\,$ 且 $\\,b  0\\,$，这个导数总是负的。这证明 $\\,J_{\\phi}(R)\\,$ 是 $\\,R\\,$ 的一个单调递减函数。因此，电流密度在最小半径处（HFS）最大，在最大半径处（LFS）最小。这种内侧峰化的电流剖面是Shafranov位移的结果，对于托卡马克平衡来说在物理上是非常合理的。\n**结论：正确**\n\n**C. 对于任何具有恒定 $\\,p'(\\psi)\\,$ 和近似恒定 $\\,F(\\psi) F'(\\psi)\\,$ 的Solov’ev平衡，环向电流密度 $\\,J_{\\phi}\\,$ 必然在磁轴处发散，这使得此类解在物理上不合理。**\n电流密度的表达式是 $\\,J_{\\phi} = c_1 R + c_2/R\\,$，其中 $\\,c_1 = p'\\,$ 和 $\\,c_2 = FF'/\\mu_0\\,$ 是常数。托卡马克的磁轴是一个点 $\\,(R_{axis}, Z_{axis})\\,$，其中 $\\,R_{axis}\\,$ 通常接近大半径 $\\,R_0  0\\,$。磁轴处的电流密度 $\\,J_{\\phi}(R_{axis}, Z_{axis}) = c_1 R_{axis} + c_2/R_{axis}\\,$ 是一个有限值。发散只会在 $\\,R=0\\,$ 处发生，这是环体的几何轴，不属于约束等离子体的一部分。该陈述是错误的。\n**结论：不正确**\n\n**D. 在 $\\,\\mathsf{S2}\\,$ 组下，如果 $\\,\\mu_{0} \\alpha R_{\\min}^{2}  b  \\mu_{0} \\alpha R_{\\max}^{2}\\,$，环向电流在同一磁面上的高场侧和低场侧之间会改变符号，这在Solov’ev平衡中是不可避免的，因此使其无法代表托卡马克放电。**\n条件 $\\,\\mu_{0} \\alpha R_{\\min}^{2}  b  \\mu_{0} \\alpha R_{\\max}^{2}\\,$ 意味着 $R_{\\min}  R_{\\rev}  R_{\\max}$，其中 $\\,R_{rev} = \\sqrt{b/(\\mu_0 \\alpha)}\\,$。这意味着 $\\,J_{\\phi}=0\\,$ 的半径位于等离子体内部。对于任何穿过该半径的磁面，$\\,J_{\\phi}\\,$ 在其HFS部分（$\\,R  R_{rev}\\,$）将为正，而在其LFS部分（$\\,R > R_{rev}\\,$）将为负。在这种条件下存在这样的电流反转是被正确描述的。然而，该陈述声称这种情况在“Solov’ev平衡中是不可避免的”。这是错误的。正如在选项B的分析中所证明的，选择参数使得 $\\,b > \\mu_{0} \\alpha R_{\\max}^{2}\\,$ 可以避免电流反转。因为这种现象并非不可避免，所以该陈述不正确。此外，声称这使得平衡“无法代表托卡马克放电”是一种夸张的说法，因为具有反向电流区域的平衡在等离子体物理学中是有研究的，特别是在奇异位形中。\n**结论：不正确**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "虽然解析解对于建立物理直觉至关重要，但现实中的托卡马克平衡往往只能通过数值方法获得。本练习旨在搭建理论与计算实践之间的桥梁，指导你将安全因子 $q$ 和磁剪切 $\\hat{s}$ 的积分定义转化为实际的计算程序。对于任何从事等离子体湍流和稳定性模拟的研究者而言，从给定的数值平衡解中准确计算这些决定稳定性的关键参数是一项核心技能。",
            "id": "4196423",
            "problem": "给定一个轴对称磁流体动力学（MHD）平衡，它在柱坐标系 $(R,\\phi,Z)$ 中由极向磁通函数 $\\,\\psi(R,Z)\\,$ 和环向场函数 $\\,F(\\psi)\\,$ 描述。在理想MHD平衡中，磁场可以表示为 $\\,\\mathbf{B} = \\frac{1}{R}\\,\\nabla\\psi \\times \\hat{\\boldsymbol{\\phi}} \\;+\\; \\frac{F(\\psi)}{R}\\,\\hat{\\boldsymbol{\\phi}}\\,$，其中 $\\,\\hat{\\boldsymbol{\\phi}}\\,$ 是环向的单位矢量。极向磁场的大小为 $\\,B_{\\mathrm{p}} = \\frac{|\\nabla \\psi|}{R}\\,$，安全因子 $\\,q(\\psi)\\,$ 衡量磁力线的缠绕情况，由一个磁面平均线积分定义。磁剪切定义为 $\\,\\hat{s} = \\frac{r}{q}\\,\\frac{\\mathrm{d}q}{\\mathrm{d}r}\\,$，其中 $\\,r(\\psi)\\,$ 是一个小半径标签，通过磁面面积 $\\,A(\\psi)\\,$ 由 $\\,r(\\psi) = \\sqrt{A(\\psi)/\\pi}\\,$ 导出。角度必须以弧度为单位。\n\n仅从这些原理出发，构建一个程序，对于给定的能产生嵌套闭合磁面的数值 $\\,\\psi(R,Z)\\,$ 和给定的 $\\,F(\\psi)\\,$，计算：\n- 使用磁面平均的安全因子 $\\,q(\\psi)\\,$，以及\n- 使用数值磁面微分的磁剪切 $\\,\\hat{s} = \\frac{r}{q}\\,\\frac{\\mathrm{d}q}{\\mathrm{d}r}\\,$。\n\n使用磁面平均的定义\n$$\n\\langle g \\rangle_{\\psi} \\;=\\; \\frac{\\displaystyle \\oint_{\\psi=\\mathrm{const}} \\frac{g\\,\\mathrm{d}\\ell_{\\mathrm{p}}}{|\\nabla\\psi|}}{\\displaystyle \\oint_{\\psi=\\mathrm{const}} \\frac{\\mathrm{d}\\ell_{\\mathrm{p}}}{|\\nabla\\psi|}} \\,,\n$$\n其中 $\\,\\mathrm{d}\\ell_{\\mathrm{p}}\\,$ 是沿着磁面 $\\,\\psi=\\mathrm{const}\\,$ 的极向线元，并通过标准的轴对称线积分计算 $\\,q(\\psi)\\,$\n$$\nq(\\psi) \\;=\\; \\frac{1}{2\\pi}\\,\\oint_{\\psi=\\mathrm{const}} \\frac{F(\\psi)}{R\\,|\\nabla\\psi|}\\;\\mathrm{d}\\ell_{\\mathrm{p}} \\,,\n$$\n这也可以用磁面平均表示为\n$$\nq(\\psi) \\;=\\; \\frac{1}{2\\pi}\\,\\Big\\langle \\frac{F(\\psi)}{R} \\Big\\rangle_{\\psi}\\;\\oint_{\\psi=\\mathrm{const}} \\frac{\\mathrm{d}\\ell_{\\mathrm{p}}}{|\\nabla\\psi|} \\,.\n$$\n\n你的程序必须在一组测试几何上实现这些计算，其中 $\\,\\psi(R,Z)\\,$ 产生以 $\\,R=R_{0}\\,$ 为中心的椭圆磁面：\n$$\n\\psi(R,Z) \\;=\\; \\psi_{0} \\;+\\; \\frac{1}{2}\\Big( \\frac{(R - R_{0})^{2}}{a^{2}} \\;+\\; \\frac{Z^{2}}{b^{2}} \\Big) \\,,\n$$\n其中半轴参数 $\\,a0\\,$ 和 $\\,b0\\,$。对于一个给定的水平 $\\,\\psi=\\psi_{0}+\\Delta\\psi\\,$（其中 $\\,\\Delta\\psi0\\,$），用一个角度 $\\,t\\in[0,2\\pi)\\,$（以弧度为单位）将磁面参数化为\n$$\nR(t) \\;=\\; R_{0} \\;+\\; a\\,\\sqrt{2\\,\\Delta\\psi}\\,\\cos t \\,,\\qquad\nZ(t) \\;=\\; b\\,\\sqrt{2\\,\\Delta\\psi}\\,\\sin t \\,,\n$$\n其极向弧长微分为\n$$\n\\mathrm{d}\\ell_{\\mathrm{p}} \\;=\\; \\sqrt{ 2\\,\\Delta\\psi }\\;\\sqrt{ a^{2}\\,\\sin^{2}t \\;+\\; b^{2}\\,\\cos^{2}t } \\;\\mathrm{d}t \\,,\n$$\n梯度大小为\n$$\n|\\nabla\\psi| \\;=\\; \\sqrt{ 2\\,\\Delta\\psi }\\;\\sqrt{ \\frac{\\cos^{2}t}{a^{2}} \\;+\\; \\frac{\\sin^{2}t}{b^{2}} } \\,.\n$$\n使用这些关系来数值计算 $\\,q(\\psi)\\,$ 的线积分。由位于 $\\,\\psi=\\psi_{0}+\\Delta\\psi\\,$ 的椭圆所包围的磁面面积为\n$$\nA(\\psi) \\;=\\; 2\\,\\pi\\,a\\,b\\,\\Delta\\psi \\,,\n$$\n小半径标签为\n$$\nr(\\psi) \\;=\\; \\sqrt{ \\frac{A(\\psi)}{\\pi} } \\;=\\; \\sqrt{ 2\\,a\\,b\\,\\Delta\\psi } \\,.\n$$\n通过对 $\\,q\\,$ 沿着一系列相邻磁面关于 $\\,r\\,$ 进行数值微分来计算 $\\,\\hat{s}(\\psi)\\,$。\n\n设计一个包含三个案例的测试套件，用以探测计算的不同方面：\n- 案例1（一般的拉长磁面，恒定的环向场函数）：$\\,R_{0}=1.7\\,$, $\\,a=0.25\\,$, $\\,b=0.50\\,$, $\\,F(\\psi)=F_{0}\\,$ 其中 $\\,F_{0}=2.5\\,$, 且 $\\,\\Delta\\psi\\in\\{0.01,\\,0.04,\\,0.09\\}\\,$。\n- 案例2（圆形截面，线性变化的环向场函数）：$\\,R_{0}=2.0\\,$, $\\,a=0.20\\,$, $\\,b=0.20\\,$, $\\,F(\\psi)=F_{0}+c\\,(\\psi-\\psi_{0})\\,$ 其中 $\\,F_{0}=3.0\\,$ 且 $\\,c=10.0\\,$, 且 $\\,\\Delta\\psi\\in\\{0.001,\\,0.01,\\,0.03\\}\\,$。\n- 案例3（近轴小磁面，用于边界测试的恒定环向场函数）：$\\,R_{0}=1.8\\,$, $\\,a=0.15\\,$, $\\,b=0.45\\,$, $\\,F(\\psi)=F_{0}\\,$ 其中 $\\,F_{0}=2.2\\,$, 且 $\\,\\Delta\\psi\\in\\{10^{-6},\\,5\\times 10^{-6}\\}\\,$。\n\n所有量在最终输出中都是无量纲的（安全因子 $\\,q\\,$ 和磁剪切 $\\,\\hat{s}\\,$ 均为无量纲）；角度必须以弧度为单位。对于每个案例，计算：\n- 在列出的 $\\,\\Delta\\psi\\,$ 水平上的所有 $\\,q\\,$ 值，以及\n- 在相同的 $\\,\\Delta\\psi\\,$ 水平上的所有 $\\,\\hat{s}\\,$ 值，使用从列出的离散磁面计算出的 $\\,r(\\psi)\\,$ 进行有限差分。对内部点使用中心有限差分，对端点使用单边有限差分。\n\n你的程序应产生一行输出，包含一个用方括号括起来的逗号分隔列表，其结果按如下顺序排列：\n$$\n[\\;q_{1}^{(1)},\\,q_{2}^{(1)},\\,q_{3}^{(1)},\\,\\hat{s}_{1}^{(1)},\\,\\hat{s}_{2}^{(1)},\\,\\hat{s}_{3}^{(1)},\\,q_{1}^{(2)},\\,q_{2}^{(2)},\\,q_{3}^{(2)},\\,\\hat{s}_{1}^{(2)},\\,s_{2}^{(2)},\\,\\hat{s}_{3}^{(2)},\\,q_{1}^{(3)},\\,q_{2}^{(3)},\\,\\hat{s}_{1}^{(3)},\\,\\hat{s}_{2}^{(3)}\\;] \\,,\n$$\n其中上标表示案例索引，下标按升序列举 $\\,\\Delta\\psi\\,$ 磁面索引。沿 $\\,t\\,$ 的数值积分必须使用弧度。不允许有其他输出。",
            "solution": "该问题陈述在科学上是合理的、自洽的且是适定的。它基于关于轴对称等离子体平衡的磁流体动力学（MHD）的既定原理。所有提供的定义和公式在等离子体物理领域都是标准的。测试案例的参数在物理上是现实的。因此，该问题是有效的，下面提供了解决方案。\n\n任务的核心是为一族特定的、由椭圆形的嵌套磁面表征的MHD平衡计算安全因子 $q(\\psi)$ 和磁剪切 $\\hat{s}(\\psi)$。\n\n首先，我们处理安全因子 $q(\\psi)$ 的计算。所提供的定义是\n$$\nq(\\psi) \\;=\\; \\frac{1}{2\\pi}\\,\\oint_{\\psi=\\mathrm{const}} \\frac{F(\\psi)}{R\\,|\\nabla\\psi|}\\;\\mathrm{d}\\ell_{\\mathrm{p}}\n$$\n问题提供了一个关于角度 $t \\in [0, 2\\pi)$ 的磁面 $\\psi = \\psi_0 + \\Delta\\psi$ 的参数化，由此可以导出被积函数中的各项。相关表达式为：\n- 大半径：$R(t) = R_{0} + a\\,\\sqrt{2\\,\\Delta\\psi}\\,\\cos t$\n- 极向弧长微分：$\\mathrm{d}\\ell_{\\mathrm{p}} = \\sqrt{ 2\\,\\Delta\\psi }\\;\\sqrt{ a^{2}\\,\\sin^{2}t \\;+\\; b^{2}\\,\\cos^{2}t } \\;\\mathrm{d}t$\n- 磁通函数的梯度：$|\\nabla\\psi| = \\sqrt{ 2\\,\\Delta\\psi }\\;\\sqrt{ \\frac{\\cos^{2}t}{a^{2}} \\;+\\; \\frac{\\sin^{2}t}{b^{2}} }$\n\n将这些代入 $q(\\psi)$ 的积分中，我们将关于 $\\mathrm{d}\\ell_{\\mathrm{p}}$ 的线积分转换为一个从 $0$ 到 $2\\pi$ 的关于 $t$ 的标准定积分：\n$$\nq(\\Delta\\psi) \\;=\\; \\frac{1}{2\\pi}\\,\\int_{0}^{2\\pi} \\frac{F(\\psi_0 + \\Delta\\psi)}{R(t)\\,|\\nabla\\psi(t)|}\\;\\frac{\\mathrm{d}\\ell_{\\mathrm{p}}}{\\mathrm{d}t}\\;\\mathrm{d}t\n$$\n被积函数，包括 $\\frac{\\mathrm{d}\\ell_{\\mathrm{p}}}{\\mathrm{d}t}$ 项，变为：\n$$\n\\frac{F(\\psi_0+\\Delta\\psi) \\left( \\sqrt{ 2\\,\\Delta\\psi }\\;\\sqrt{ a^{2}\\,\\sin^{2}t \\;+\\; b^{2}\\,\\cos^{2}t } \\right)}{\\left( R_{0} + a\\,\\sqrt{2\\,\\Delta\\psi}\\,\\cos t \\right) \\left( \\sqrt{ 2\\,\\Delta\\psi }\\;\\sqrt{ \\frac{\\cos^{2}t}{a^{2}} \\;+\\; \\frac{\\sin^{2}t}{b^{2}} } \\right)}\n$$\n这个表达式可以在代数上进行简化。分子和分母中的项 $\\sqrt{ 2\\,\\Delta\\psi }$ 可以消去。分母中的根式可以重写为：\n$$\n\\sqrt{ \\frac{\\cos^{2}t}{a^{2}} \\;+\\; \\frac{\\sin^{2}t}{b^{2}} } \\;=\\; \\sqrt{ \\frac{b^2\\cos^2 t + a^2\\sin^2 t}{a^2 b^2} } \\;=\\; \\frac{\\sqrt{a^2\\sin^2 t + b^2\\cos^2 t}}{ab}\n$$\n因为 $a0$ 且 $b0$。然后，项 $\\sqrt{a^2\\sin^2 t + b^2\\cos^2 t}$ 与其在分子中的对应项消去。这产生了一个大大简化的被积函数。$q(\\psi)$ 的公式变为：\n$$\nq(\\Delta\\psi) \\;=\\; \\frac{F(\\psi_0+\\Delta\\psi)}{2\\pi} \\int_{0}^{2\\pi} \\frac{ab}{R_{0} + a\\,\\sqrt{2\\,\\Delta\\psi}\\,\\cos t} \\;\\mathrm{d}t\n$$\n这个积分是良态的，并使用 `scipy.integrate` 库中的 `quad` 函数对每个指定的 $\\Delta\\psi$ 值进行数值计算，该函数执行数值求积。所有角度量都以弧度处理。\n\n接下来，我们计算磁剪切 $\\hat{s}$，其定义为 $\\hat{s} = \\frac{r}{q}\\frac{\\mathrm{d}q}{\\mathrm{d}r}$。磁面标签 $r(\\psi)$ 由 $r(\\psi) = \\sqrt{2\\,a\\,b\\,\\Delta\\psi}$ 给出。对于每个案例，我们首先计算与每个给定的 $\\Delta\\psi_i$ 对应的离散点对 $(r_i, q_i)$。然后，如规定所示，使用有限差分法在每个点 $i$ 处近似导数 $\\frac{\\mathrm{d}q}{\\mathrm{d}r}$。\n设一个案例有 $N$ 个磁面，索引为 $i=0, 1, ..., N-1$。\n- 对于第一个磁面（$i=0$），使用前向差分：\n$$ \\Big(\\frac{\\mathrm{d}q}{\\mathrm{d}r}\\Big)_0 \\approx \\frac{q_1 - q_0}{r_1 - r_0} $$\n- 对于任何内部磁面（$0  i  N-1$），为获得更好精度，使用中心差分：\n$$ \\Big(\\frac{\\mathrm{d}q}{\\mathrm{d}r}\\Big)_i \\approx \\frac{q_{i+1} - q_{i-1}}{r_{i+1} - r_{i-1}} $$\n- 对于最后一个磁面（$i=N-1$），使用后向差分：\n$$ \\Big(\\frac{\\mathrm{d}q}{\\mathrm{d}r}\\Big)_{N-1} \\approx \\frac{q_{N-1} - q_{N-2}}{r_{N-1} - r_{N-2}} $$\n对于只有两个磁面（$N=2$）的案例3，第一个点使用前向差分，第二个点使用后向差分，它们都计算出相同的值，即 $\\frac{q_1-q_0}{r_1-r_0}$。\n\n然后，通过组合这些分量来计算每个磁面上的磁剪切 $\\hat{s}_i$：\n$$\n\\hat{s}_i = \\frac{r_i}{q_i} \\Big(\\frac{\\mathrm{d}q}{\\mathrm{d}r}\\Big)_i\n$$\n这个过程被系统地应用于三个测试案例中的每一个的参数。为每个案例计算出的 $q$ 和 $\\hat{s}$ 值被收集并按照输出要求格式化为单个扁平列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n\n    def calculate_q_and_s(R0, a, b, F_func, dpsi_values):\n        \"\"\"\n        Calculates q and s profiles for a single case.\n\n        Args:\n            R0 (float): Major radius of the magnetic axis.\n            a (float): Horizontal semi-axis of elliptical flux surfaces.\n            b (float): Vertical semi-axis of elliptical flux surfaces.\n            F_func (callable): Toroidal field function F(psi), expects delta_psi.\n            dpsi_values (list of float): List of delta_psi levels to compute on.\n\n        Returns:\n            tuple: A tuple containing a list of q values and a list of s values.\n        \"\"\"\n\n        q_vals = []\n        r_vals = []\n\n        # Sort delta_psi values to ensure r is monotonically increasing\n        dpsi_values = sorted(dpsi_values)\n\n        # 1. Calculate r and q for each delta_psi\n        for dpsi in dpsi_values:\n            # Calculate minor radius label r\n            r = np.sqrt(2 * a * b * dpsi)\n            r_vals.append(r)\n            \n            # Calculate safety factor q\n            F_val = F_func(dpsi)\n            delta_R = a * np.sqrt(2 * dpsi)\n\n            # The integrand for q simplifies to ab / (R0 + delta_R * cos(t)).\n            # This is derived by substituting the parametric expressions for R, |grad(psi)|,\n            # and dl_p into the definition of q and simplifying the resulting algebraic expression.\n            def integrand(t):\n                return 1.0 / (R0 + delta_R * np.cos(t))\n\n            integral_val, _ = quad(integrand, 0, 2 * np.pi)\n            \n            q = (F_val * a * b / (2 * np.pi)) * integral_val\n            q_vals.append(q)\n\n        # 2. Calculate magnetic shear s using finite differences\n        n = len(dpsi_values)\n        if n  2:\n            # Shear is not well-defined for a single point\n            s_vals = [np.nan] * n\n            return q_vals, s_vals\n\n        dqdr = [0.0] * n\n        \n        # Forward difference for the first point (i=0)\n        dqdr[0] = (q_vals[1] - q_vals[0]) / (r_vals[1] - r_vals[0])\n        \n        # Centered difference for interior points\n        for i in range(1, n - 1):\n            dqdr[i] = (q_vals[i+1] - q_vals[i-1]) / (r_vals[i+1] - r_vals[i-1])\n\n        # Backward difference for the last point (i=n-1)\n        dqdr[n-1] = (q_vals[n-1] - q_vals[n-2]) / (r_vals[n-1] - r_vals[n-2])\n        \n        s_vals = [(r_vals[i] / q_vals[i]) * dqdr[i] for i in range(n)]\n\n        return q_vals, s_vals\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"R0\": 1.7, \"a\": 0.25, \"b\": 0.50,\n            \"F_func\": lambda dpsi: 2.5,\n            \"dpsi_values\": [0.01, 0.04, 0.09]\n        },\n        {\n            \"R0\": 2.0, \"a\": 0.20, \"b\": 0.20,\n            \"F_func\": lambda dpsi: 3.0 + 10.0 * dpsi,\n            \"dpsi_values\": [0.001, 0.01, 0.03]\n        },\n        {\n            \"R0\": 1.8, \"a\": 0.15, \"b\": 0.45,\n            \"F_func\": lambda dpsi: 2.2,\n            \"dpsi_values\": [1e-6, 5e-6]\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        q_results, s_results = calculate_q_and_s(\n            case[\"R0\"], case[\"a\"], case[\"b\"], case[\"F_func\"], case[\"dpsi_values\"]\n        )\n        all_results.extend(q_results)\n        all_results.extend(s_results)\n    \n    # In the problem statement, the output format lists s_2^(2) instead of s_2^(2).\n    # Assuming it's a typo and the third shear value for case 2 should be included.\n    # The expected output for Case 3 has 2 q values and 2 s values. The format is\n    # [q1, q2, q3, s1, s2, s3, q1, q2, q3, s1, s2, s3, q1, q2, s1, s2]\n    # The provided format in the prompt has a typo \"s_{2}^{(2)}\" instead of \"s_{3}^{(2)}\",\n    # and has a total of 16 elements. Case 1: 3q, 3s. Case 2: 3q, 3s. Case 3: 2q, 2s.\n    # Total should be 6+6+4=16 elements. The prompt format string is correct.\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.8f}' for x in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}