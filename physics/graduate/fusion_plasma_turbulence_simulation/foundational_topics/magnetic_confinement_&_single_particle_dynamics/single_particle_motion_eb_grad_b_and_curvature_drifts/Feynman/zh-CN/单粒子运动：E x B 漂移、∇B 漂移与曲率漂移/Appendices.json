{
    "hands_on_practices": [
        {
            "introduction": "这项练习将探讨带电粒子在空间不均匀磁场中运动的一个基本推论。通过应用能量守恒和磁矩 $\\mu$ 的绝热不变量性质，你将推导出“磁镜力”的表达式，它主导着粒子沿磁力线的平行速度 $v_{\\parallel}$ 的变化。这是理解磁约束装置中粒子捕获效应的基石 。",
            "id": "4200941",
            "problem": "考虑一个质量为 $m$、电荷为 $q$ 的带电粒子，在一个不随时间变化的非均匀磁场 $\\mathbf{B}(\\mathbf{x})$ 中运动。该磁场的单位矢量为 $\\hat{\\mathbf{b}} \\equiv \\mathbf{B}/B$，场向坐标 $s$ 由 $\\mathrm{d}\\mathbf{x}/\\mathrm{d}s = \\hat{\\mathbf{b}}$ 定义。假设满足导心序 $\\rho_{\\mathrm{L}}/L_{B} \\ll 1$，其中 $\\rho_{\\mathrm{L}}$ 是拉莫尔半径，$L_{B}$ 是磁场变化的特征尺度长度。因此，回旋运动可以被平均掉，磁矩 $\\mu \\equiv m v_{\\perp}^{2}/(2B)$ 在领头阶上是一个绝热不变量。不存在电场，即 $\\mathbf{E} = \\mathbf{0}$，因此任何电场叉磁场（$E \\times B$）漂移都不存在。粒子速度可分解为 $\\mathbf{v} = v_{\\parallel}\\,\\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}$。从包含洛伦兹力的牛顿第二定律 $m\\,\\mathrm{d}\\mathbf{v}/\\mathrm{d}t = q\\,\\mathbf{v}\\times\\mathbf{B}$ 出发，并使用导心近似，推导在沿磁感线存在磁场强度变化情况下的有效平行动力学。特别地，关注磁镜力 $-\\mu\\,\\hat{\\mathbf{b}}\\cdot\\nabla B$，并计算当粒子从参考位置 $s_{0}$ 移动到位置 $s$ 时平行速度 $v_{\\parallel}$ 的变化，其中 $B_{0} \\equiv B(s_{0})$ 且 $v_{\\parallel 0} \\equiv v_{\\parallel}(s_{0})$。请将您的最终结果表示为关于 $v_{\\parallel 0}$、$\\mu$、$m$、$B(s)$ 和 $B_{0}$ 的单个闭式解析表达式 $v_{\\parallel}(s)$。然后，讨论由磁镜力驱动的 $v_{\\parallel}$ 的演化如何与由磁感线曲率引起的曲率漂移耦合，同时不改变绝热不变量 $\\mu$。您的最终答案必须仅为所求的 $v_{\\parallel}(s)$ 的解析表达式；请勿在最终的方框答案中包含任何单位。不需要进行数值计算或四舍五入。",
            "solution": "该问题被评估为具有科学依据、适定且客观。这是经典力学和等离子体物理中的一个标准问题，具体涉及带电粒子运动的导心近似。所有提供的信息都是一致且足以得出一个唯一解。因此，该问题被认为是有效的。\n\n质量为 $m$、电荷为 $q$ 的带电粒子在磁场 $\\mathbf{B}$ 中的运动由洛伦兹力决定，如牛顿第二定律所述：\n$$m \\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t} = q \\mathbf{v} \\times \\mathbf{B}$$\n磁场力对粒子所做的功为零，因为该力始终垂直于速度：$\\mathbf{F} \\cdot \\mathbf{v} = (q \\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{v} = 0$。鉴于电场 $\\mathbf{E}$ 为零，没有其他力对粒子做功。因此，粒子的动能 $K$ 是一个运动常数：\n$$\\frac{\\mathrm{d}K}{\\mathrm{d}t} = 0 \\implies K = \\text{constant}$$\n粒子的速度矢量 $\\mathbf{v}$ 可以分解为平行于和垂直于磁场单位矢量 $\\hat{\\mathbf{b}} = \\mathbf{B}/B$ 的分量：$\\mathbf{v} = v_{\\parallel} \\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}$。总动能可以用这些分量来表示。由于 $\\hat{\\mathbf{b}}$ 和 $\\mathbf{v}_{\\perp}$ 是正交的，速度大小的平方为 $v^2 = \\mathbf{v} \\cdot \\mathbf{v} = v_{\\parallel}^2 + v_{\\perp}^2$。守恒的动能是：\n$$K = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2)$$\n问题指出，在导心近似下，磁矩 $\\mu$ 是一个绝热不变量。其定义为：\n$$\\mu \\equiv \\frac{m v_{\\perp}^2}{2B}$$\n由于 $\\mu$ 在领头阶上是常数，我们可以用 $\\mu$ 和局部磁场强度 $B$ 来表示动能的垂直分量：\n$$\\frac{1}{2}m v_{\\perp}^2 = \\mu B$$\n将此代入总动能的表达式中，我们得到：\n$$K = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B$$\n因为 $K$ 是一个运动常数，所以量 $\\frac{1}{2}m v_{\\parallel}^2 + \\mu B$ 在粒子导心轨迹上的所有点都必须具有相同的值。我们在一个参考位置 $s_0$ 和一个任意位置 $s$ 处计算这个守恒量。在 $s_0$ 处，磁场强度为 $B_0 \\equiv B(s_0)$，平行速度为 $v_{\\parallel 0} \\equiv v_{\\parallel}(s_0)$。在位置 $s$ 处，磁场强度为 $B(s)$，平行速度为 $v_{\\parallel}(s)$。令这两点处的守恒能量相等，可得：\n$$\\frac{1}{2}m v_{\\parallel}(s)^2 + \\mu B(s) = \\frac{1}{2}m v_{\\parallel 0}^2 + \\mu B_0$$\n这个方程描述了粒子的平行动能与一个类势能项 $\\mu B$ 之间的交换。负责这种交换的力是磁镜力，$F_{\\parallel} = -\\nabla_{\\parallel}(\\mu B) = -\\mu \\partial B / \\partial s$。\n\n为了求出 $v_{\\parallel}(s)$ 的表达式，我们重新整理守恒方程以解出 $v_{\\parallel}(s)^2$：\n$$\\frac{1}{2}m v_{\\parallel}(s)^2 = \\frac{1}{2}m v_{\\parallel 0}^2 + \\mu B_0 - \\mu B(s)$$\n$$v_{\\parallel}(s)^2 = v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))$$\n对两边取平方根，得到位置 $s$ 处平行速度的最终表达式：\n$$v_{\\parallel}(s) = \\pm \\sqrt{v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))}$$\n$\\pm$ 符号表示粒子可以沿磁感线向任一方向运动。如果粒子移动到 $B(s)$ 足够大的区域，使得平方根内的项变为零，则粒子的平行运动停止并被反射，其平行速度的符号反转。这就是磁镜的原理。\n\n关于由磁镜力驱动的 $v_{\\parallel}$ 的演化与曲率漂移之间的耦合，我们首先回顾曲率漂移速度 $\\mathbf{v}_c$ 的表达式。这种漂移的产生是因为，在均匀磁场的图像中，粒子沿弯曲磁感线运动时所受的离心力并未被洛伦兹力完全平衡。漂移速度由下式给出：\n$$\\mathbf{v}_c = \\frac{m v_{\\parallel}^2}{q B^2} \\mathbf{B} \\times (\\hat{\\mathbf{b}} \\cdot \\nabla \\hat{\\mathbf{b}})$$\n项 $\\hat{\\mathbf{b}} \\cdot \\nabla \\hat{\\mathbf{b}}$ 代表磁感线的曲率矢量。对于当前的讨论，关键在于曲率漂移的大小 $|\\mathbf{v}_c|$ 与平行速度的平方 $v_{\\parallel}^2$ 成正比。\n我们推导的第一部分表明，$v_{\\parallel}$ 通常不是恒定的。其值根据以下关系变化：\n$$v_{\\parallel}^2(s) = v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))$$\n这就建立了一个直接的耦合关系。当粒子的导心沿磁感线移动时，它会经历磁场强度 $B(s)$ 的变化。磁镜力作用于粒子，将平行动能转化为垂直动能（或反之），从而改变 $v_{\\parallel}(s)$。$v_{\\parallel}(s)$ 的这种变化继而直接调节曲率漂移 $\\mathbf{v}_c$ 的大小。例如，如果一个粒子进入一个更强的磁场区域（磁镜），$v_{\\parallel}$ 会减小，这又会降低曲率漂移的速度。相反，进入一个更弱的磁场区域会增加 $v_{\\parallel}$ 并增强曲率漂移。这整个过程发生时，磁矩 $\\mu$ 和总能量 $K$ 保持守恒。平行运动与垂直漂移之间的这种耦合是用于磁约束聚变的复杂磁几何结构中粒子动力学的一个基本方面。",
            "answer": "$$\\boxed{\\pm \\sqrt{v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))}}$$"
        },
        {
            "introduction": "在静态场的案例基础上，这项练习引入了时变电场 $\\mathbf{E}(t)$ 的影响。你将推导出极化漂移，这是一种惯性漂移，其产生原因在于粒子的质量使其无法瞬时跟随 $\\mathbf{E} \\times \\mathbf{B}$ 漂移速度的变化。理解这种漂移对于分析等离子体波和湍流输运至关重要 。",
            "id": "4200957",
            "problem": "一个电荷为 $q$、质量为 $m$ 的非相对论带电粒子在均匀、静态磁场 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$ 中运动。垂直电场在空间上是均匀的，严格垂直于 $\\mathbf{B}$，并随时间作谐波变化，形式为 $\\mathbf{E}_{\\perp}(t) = \\Re\\{\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\}$，其中 $\\mathbf{E}_{0}\\cdot\\hat{\\mathbf{z}}=0$ 且 $\\omega>0$。从洛伦兹方程 $m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right)$ 出发，在频率与回旋频率相比渐近小的区域（即 $\\omega/\\Omega \\ll 1$，其中 $\\Omega \\equiv |q|B/m$）进行分析。使用快回旋运动和慢漂移之间的系统性时间尺度分离方法，推导由 $\\mathbf{E}_{\\perp}(t)$ 的时间依赖性引起的对垂直导心速度的主要慢漂移贡献，记为 $\\mathbf{v}_{p}(t)$。然后，将其大小与瞬时电交磁（E×B）漂移 $\\mathbf{v}_{E}(t) \\equiv \\mathbf{E}_{\\perp}(t)\\times \\mathbf{B}/B^{2}$ 的大小进行比较，并确定在 $\\omega/\\Omega \\ll 1$ 的极限下它们大小的比值。\n\n以 $\\omega$ 和 $\\Omega$ 的闭式符号表达式形式给出比值 $\\left|\\mathbf{v}_{p}\\right|/\\left|\\mathbf{v}_{E}\\right|$ 作为你的最终答案。无需进行数值计算，且最终比值为无量纲量，因此不需要单位。",
            "solution": "本题要求在低频极限 $\\omega/\\Omega \\ll 1$ 下，推导带电粒子在均匀磁场和时变垂直电场中的极化漂移速度。然后，我们必须确定该漂移的大小与 E×B 漂移大小的比值。\n\n我们从电荷为 $q$、质量为 $m$ 的粒子的非相对论洛伦兹运动方程开始：\n$$\nm\\,\\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right)\n$$\n给定的场是均匀、静态的磁场 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$ 和垂直、时谐的电场 $\\mathbf{E}(t) = \\mathbf{E}_{\\perp}(t) = \\Re\\{\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\}$，其中 $\\mathbf{E}_{0}\\cdot\\hat{\\mathbf{z}}=0$。平行于 $\\mathbf{B}$ 的运动是平凡的（$E_{\\parallel}=0 \\implies v_{\\parallel}=\\text{常数}$），因此我们专注于垂直速度分量 $\\mathbf{v}_{\\perp}$。垂直运动的方程为：\n$$\nm\\,\\frac{d\\mathbf{v}_{\\perp}}{dt} = q\\left(\\mathbf{E}_{\\perp}(t) + \\mathbf{v}_{\\perp}\\times \\mathbf{B}\\right)\n$$\n这个问题涉及两个不同的时间尺度：以回旋频率 $\\Omega = |q|B/m$ 进行的快回旋运动，和以频率 $\\omega$ 变化的慢电场变化。条件 $\\omega \\ll \\Omega$ 允许将速度系统地分离为一个缓慢漂移的导心速度 $\\mathbf{v}_{GC}$ 和一个快速回旋的分量。总导心漂移是各种漂移之和。主要的漂移是电交磁（E×B）漂移，定义为：\n$$\n\\mathbf{v}_{E}(t) \\equiv \\frac{\\mathbf{E}_{\\perp}(t)\\times \\mathbf{B}}{B^{2}}\n$$\n我们寻求因 $\\mathbf{E}_{\\perp}(t)$ 的时间依赖性而产生的对该漂移的修正项。这个修正项就是极化漂移 $\\mathbf{v}_p(t)$。\n\n一种标准的推导方法是将总垂直速度 $\\mathbf{v}_{\\perp}$ 表示为一个迭代级数。对 $\\mathbf{v}_{\\perp}$ 的运动方程取与 $\\mathbf{B}$ 的叉积，可以得到一个精确的重排形式：\n$$\nm\\,\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) = q(\\mathbf{E}_{\\perp} \\times \\mathbf{B}) + q((\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\times \\mathbf{B})\n$$\n使用矢量三重积恒等式 $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$，并注意到 $\\mathbf{v}_{\\perp} \\cdot \\mathbf{B} = 0$，最后一项变为：\n$$\n(\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\times \\mathbf{B} = \\mathbf{B}(\\mathbf{v}_{\\perp}\\cdot\\mathbf{B}) - \\mathbf{v}_{\\perp}(\\mathbf{B}\\cdot\\mathbf{B}) = -B^2 \\mathbf{v}_{\\perp}\n$$\n将此代回，我们得到：\n$$\nm\\,\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) = q(\\mathbf{E}_{\\perp} \\times \\mathbf{B}) - qB^2 \\mathbf{v}_{\\perp}\n$$\n解出 $\\mathbf{v}_{\\perp}$，得到精确表达式：\n$$\n\\mathbf{v}_{\\perp} = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right)\n$$\n第一项是瞬时 E×B 漂移 $\\mathbf{v}_{E}$。第二项包含所有其他运动，包括回旋运动和任何附加的漂移。导心速度 $\\mathbf{v}_{GC}$ 是 $\\mathbf{v}_{\\perp}$ 在一个快回旋周期内的平均值，这会滤掉回旋运动。\n$$\n\\mathbf{v}_{GC} = \\langle\\mathbf{v}_{\\perp}\\rangle = \\langle\\mathbf{v}_{E}\\rangle - \\left\\langle \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\right\\rangle\n$$\n由于 $\\mathbf{v}_E$ 和 $\\mathbf{B}$ 仅在慢时间尺度上变化，它们在一个回旋轨道上实际上是常数，因此 $\\langle\\mathbf{v}_{E}\\rangle=\\mathbf{v}_{E}$。总速度导数的平均值是平均速度的导数，即 $\\langle d\\mathbf{v}_{\\perp}/dt \\rangle \\approx d\\langle\\mathbf{v}_{\\perp}\\rangle/dt = d\\mathbf{v}_{GC}/dt$。因此：\n$$\n\\mathbf{v}_{GC} \\approx \\mathbf{v}_{E} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{GC}}{dt} \\times \\mathbf{B}\\right)\n$$\n这是导心速度 $\\mathbf{v}_{GC}$ 的方程。我们可以基于修正项很小这一点来迭代求解。时间导数引入了一个因子 $\\omega$，而叉积中隐含的回旋运动涉及 $\\Omega$。因此，与主速度相比，修正项的量级为 $\\omega/\\Omega \\ll 1$。\n\n在主导阶上，导心速度就是 E×B 漂移：\n$$\n\\mathbf{v}_{GC}^{(0)} = \\mathbf{v}_{E}(t)\n$$\n为了找到一阶修正，我们将此近似代回到 $\\mathbf{v}_{GC}$ 方程的导数项中：\n$$\n\\mathbf{v}_{GC}^{(1)} = \\mathbf{v}_{E} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{E}}{dt} \\times \\mathbf{B}\\right)\n$$\n极化漂移 $\\mathbf{v}_{p}$ 定义为这个一阶修正项：\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{E}}{dt} \\times \\mathbf{B}\\right)\n$$\n我们现在代入 $\\mathbf{v}_{E}(t)$ 的定义：\n$$\n\\frac{d\\mathbf{v}_{E}}{dt} = \\frac{d}{dt}\\left(\\frac{\\mathbf{E}_{\\perp}(t) \\times \\mathbf{B}}{B^2}\\right) = \\frac{1}{B^2}\\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right)\n$$\n因为 $\\mathbf{B}$ 和 $B^2$ 是常数。$\\mathbf{v}_{p}$ 的表达式变为：\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^2}\\left[ \\frac{1}{B^2}\\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\times \\mathbf{B} \\right] = - \\frac{m}{qB^4}\\left[ \\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\times \\mathbf{B} \\right]\n$$\n使用和之前相同的矢量恒等式，并注意到 $d\\mathbf{E}_{\\perp}/dt$ 垂直于 $\\mathbf{B}$，我们有 $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{B} = -B^2\\mathbf{A}$，其中 $\\mathbf{A} = d\\mathbf{E}_{\\perp}/dt$。\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^4} \\left[ -B^2 \\frac{d\\mathbf{E}_{\\perp}}{dt} \\right] = \\frac{m}{qB^2} \\frac{d\\mathbf{E}_{\\perp}}{dt}\n$$\n这就是极化漂移速度的表达式。\n\n接下来，我们比较 $\\mathbf{v}_{p}(t)$ 和 $\\mathbf{v}_{E}(t)$ 的大小。对于谐波变化的量，最有意义的比较是它们振幅之间的比较。为简单起见，我们使用复数表示法，其中物理量是其实部。\n令 $\\tilde{\\mathbf{E}}_{\\perp}(t) = \\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)$。相应复速度的振幅将给出物理速度的振幅。\n复数 E×B 速度为：\n$$\n\\tilde{\\mathbf{v}}_{E}(t) = \\frac{\\tilde{\\mathbf{E}}_{\\perp}(t) \\times \\mathbf{B}}{B^2} = \\frac{\\mathbf{E}_{0} \\times \\mathbf{B}}{B^2} \\exp(-\\mathrm{i}\\,\\omega t)\n$$\n该速度的振幅，我们记为 $|\\mathbf{v}_{E}|$，是其复矢量部分的模：\n$$\n|\\mathbf{v}_{E}| = \\left|\\frac{\\mathbf{E}_{0} \\times \\mathbf{B}}{B^2}\\right| = \\frac{|\\mathbf{E}_{0}| |\\mathbf{B}| \\sin(\\pi/2)}{B^2} = \\frac{|\\mathbf{E}_{0}|B}{B^2} = \\frac{|\\mathbf{E}_{0}|}{B}\n$$\n这里我们用到了 $\\mathbf{E}_0$ 垂直于 $\\mathbf{B}$。\n\n复数极化漂移速度为：\n$$\n\\tilde{\\mathbf{v}}_{p}(t) = \\frac{m}{qB^2} \\frac{d\\tilde{\\mathbf{E}}_{\\perp}}{dt} = \\frac{m}{qB^2} \\frac{d}{dt}\\left(\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\right) = \\frac{-\\mathrm{i}\\,\\omega m}{qB^2} \\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n该速度的振幅，记为 $|\\mathbf{v}_{p}|$，是：\n$$\n|\\mathbf{v}_{p}| = \\left|\\frac{-\\mathrm{i}\\,\\omega m}{qB^2} \\mathbf{E}_{0}\\right| = \\frac{\\omega m}{|q|B^2} |\\mathbf{E}_{0}|\n$$\n现在，我们求这些大小的比值：\n$$\n\\frac{|\\mathbf{v}_{p}|}{|\\mathbf{v}_{E}|} = \\frac{\\frac{\\omega m |\\mathbf{E}_{0}|}{|q|B^2}}{\\frac{|\\mathbf{E}_{0}|}{B}} = \\frac{\\omega m}{|q|B}\n$$\n使用回旋频率的定义 $\\Omega = |q|B/m$，我们可以将分母重写为 $|q|B = m\\Omega$。\n$$\n\\frac{|\\mathbf{v}_{p}|}{|\\mathbf{v}_{E}|} = \\frac{\\omega m}{m\\Omega} = \\frac{\\omega}{\\Omega}\n$$\n这证实了在指定的极限 $\\omega/\\Omega \\ll 1$ 下，极化漂移是 E×B 漂移的一个小修正。它们大小的比值恰好是这个小参数。",
            "answer": "$$\n\\boxed{\\frac{\\omega}{\\Omega}}\n$$"
        },
        {
            "introduction": "最后的这项练习将 $\\mathbf{E} \\times \\mathbf{B}$ 漂移、梯度B漂移和曲率漂移等概念整合到一个具体的计算基准问题中。你将为一个类似于聚变装置中的轴对称磁场构型推导并实现这些漂移，并利用基本守恒律来验证计算结果。这项练习旨在将抽象理论与实际模拟联系起来 。",
            "id": "4200930",
            "problem": "考虑一个用于聚变相关磁几何中单粒子导心运动的轴对称基准问题。您需要使用完全解析的电场和磁场来验证漂移计算和不变量。从洛伦兹力定律和核心定义出发，不要依赖预先记下的漂移公式；相反，您应推导出相关的漂移必须是什么，它们为何产生，以及它们如何从基本定律中得出，然后将结果编码到一个程序中，用以计算指定的诊断量。\n\n几何与场。设空间位置在笛卡尔坐标中为 $\\mathbf{x} = (x,y,z)$，在 $x\\text{-}y$ 平面中的柱坐标半径定义为 $r = \\sqrt{x^2 + y^2}$。定义平面中的标准正交基矢量为\n$$\n\\mathbf{e}_r = \\frac{1}{r}\\,(x, y, 0),\\qquad\n\\mathbf{e}_\\theta = \\frac{1}{r}\\,(-y, x, 0),\\qquad\n\\mathbf{e}_z = (0,0,1).\n$$\n设磁场为纯角向场，并依赖于半径，形式如下\n$$\n\\mathbf{B}(\\mathbf{x}) = \\frac{B_0 R_0}{r}\\,\\mathbf{e}_\\theta,\n$$\n电场为纯径向场，大小恒定，形式如下\n$$\n\\mathbf{E}(\\mathbf{x}) = E_0\\,\\mathbf{e}_r,\n$$\n其中 $B_0$ 是以 $\\mathrm{Tesla}$ 为单位的参考磁场大小，$R_0$ 是以 $\\mathrm{meter}$ 为单位的参考长度，$E_0$ 是以 $\\mathrm{Volt}/\\mathrm{meter}$ 为单位的参考电场大小。\n\n基本原理。使用非相对论性洛伦兹力定律 $m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)$、导心磁矩的定义 $\\mu = m v_\\perp^2/(2 B)$ 以及运动学关系 $v = dx/dt$。取 $m$ 为以 $\\mathrm{kilogram}$ 为单位的粒子质量，$q$ 为以 $\\mathrm{Coulomb}$ 为单位的粒子电荷，$v_\\parallel$ 为 $\\mathbf{v}$ 沿 $\\mathbf{B}$ 的分量，$v_\\perp$ 为 $\\mathbf{v}$ 垂直于 $\\mathbf{B}$ 且与回旋运动相关的分量的大小。假设场是静态的，不存在平行电场，并且运动是绝热的，其特征尺度分离由小参数 $\\epsilon = \\rho_L/L$ 量化，其中 $\\rho_L = m v_\\perp/(|q| B)$ 是拉莫尔半径，$L$ 是磁场梯度特征长度。\n\n任务。从基本原理出发，推导在指定几何构型中与电场叉乘磁场（E×B）、磁场强度梯度和磁力线曲率相关的导心漂移速度。然后实现一个程序，对每个测试用例计算：\n- 沿 $\\mathbf{e}_z$ 方向的总漂移速度分量，单位为 $\\mathrm{m}/\\mathrm{s}$，通过将 E×B 漂移、梯度漂移和曲率漂移相加得到。\n- 一个由瞬时输入功率 $P = q\\,\\mathbf{E}\\cdot\\mathbf{v}_\\text{GC}$ 给出的能量守恒诊断量，其中 $\\mathbf{v}_\\text{GC}$ 是由平行分量和漂移分量组成的导心速度。如果 $|P|  \\tau_P$，则报告一个布尔值 true，否则报告 false。\n- 一个基于 $\\epsilon = \\rho_L/L$（其中 $L=r$）的磁矩绝热性诊断量，如果 $\\epsilon  \\tau_\\mu$，则报告一个布尔值 true，否则报告 false。\n\n单位。所有速度必须以 $\\mathrm{m}/\\mathrm{s}$ 计算和报告。功率 $P$ 必须在内部以 $\\mathrm{J}/\\mathrm{s}$ 计算，但只报告布尔诊断量。角度（在几何中隐式涉及）作为上述矢量基定义的一部分，以弧度处理。\n\n测试套件。在所有测试用例中使用以下常量：\n- $B_0 = 5\\,\\mathrm{T}$，$R_0 = 1\\,\\mathrm{m}$，$E_0 = 100\\,\\mathrm{V}/\\mathrm{m}$。\n- 基本电荷大小 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n- 质子质量 $m_p = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$。\n- 电子质量 $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$。\n- 能量容差 $\\tau_P = 10^{-25}$，单位 $\\mathrm{J}/\\mathrm{s}$。\n- 绝热性容差 $\\tau_\\mu = 10^{-3}$ (无量纲)。\n\n定义四个测试用例 $(m, q, x, y, v_\\parallel, v_\\perp)$ 来探测覆盖范围：\n1. 用例 A（理想情况，中等速度，质子）：$m = m_p$，$q = +e$，$x = 1.0\\,\\mathrm{m}$，$y = 0.0\\,\\mathrm{m}$，$v_\\parallel = 1.0\\times 10^{5}\\,\\mathrm{m}/\\mathrm{s}$，$v_\\perp = 2.0\\times 10^{4}\\,\\mathrm{m}/\\mathrm{s}$。\n2. 用例 B（强场区，小半径，质子）：$m = m_p$，$q = +e$，$x = 0.2\\,\\mathrm{m}$，$y = 0.0\\,\\mathrm{m}$，$v_\\parallel = 5.0\\times 10^{4}\\,\\mathrm{m}/\\mathrm{s}$，$v_\\perp = 2.0\\times 10^{4}\\,\\mathrm{m}/\\mathrm{s}$。\n3. 用例 C（电荷符号反转，电子）：$m = m_e$，$q = -e$，$x = 1.5\\,\\mathrm{m}$，$y = 0.0\\,\\mathrm{m}$，$v_\\parallel = 2.0\\times 10^{6}\\,\\mathrm{m}/\\mathrm{s}$，$v_\\perp = 1.0\\times 10^{5}\\,\\mathrm{m}/\\mathrm{s}$。\n4. 用例 D（绝热性临界，大 $v_\\perp$，质子）：$m = m_p$，$q = +e$，$x = 2.0\\,\\mathrm{m}$，$y = 0.0\\,\\mathrm{m}$，$v_\\parallel = 1.0\\times 10^{5}\\,\\mathrm{m}/\\mathrm{s}$，$v_\\perp = 5.0\\times 10^{6}\\,\\mathrm{m}/\\mathrm{s}$。\n\n程序要求。您的程序必须：\n- 实现给定几何构型中漂移速度的推导结果。\n- 对于每个测试用例，计算沿 $\\mathbf{e}_z$ 方向的总漂移速度分量（单位为 $\\mathrm{m}/\\mathrm{s}$），能量守恒布尔值（$|P|  \\tau_P$），以及磁矩绝热性布尔值（$\\epsilon  \\tau_\\mu$）。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按以下一维顺序排列\n$$\n[v_{z,A}, \\text{energy\\_ok}_A, \\text{mu\\_ok}_A, v_{z,B}, \\text{energy\\_ok}_B, \\text{mu\\_ok}_B, v_{z,C}, \\text{energy\\_ok}_C, \\text{mu\\_ok}_C, v_{z,D}, \\text{energy\\_ok}_D, \\text{mu\\_ok}_D],\n$$\n其中 $v_{z,\\cdot}$ 是以 $\\mathrm{m}/\\mathrm{s}$ 为单位的浮点数，诊断量是布尔值。\n\n科学真实性。所选的场在 $r=0$ 之外是无散的，反映了一个具有圆形磁力线的简单环形位形。电场处处垂直于磁场，确保没有平行的电场功。该测试套件探测了正常操作、强场邻近、电荷符号反转以及因 $v_\\perp$ 较大而导致的严格绝热性失效等情况。\n\n无输入。程序必须是自包含的，并且不得要求任何用户输入。",
            "solution": "该问题要求推导在指定的解析电场和磁场中带电粒子的导心漂移速度，然后通过数值实现来计算这些漂移及相关诊断量。推导必须源于非相对论性洛伦兹力定律所体现的基本原理。\n\n带电粒子在磁场中的运动可以分解为围绕磁力线的快速回旋运动和该回旋中心的较慢漂移，后者被称为导心。洛伦兹力方程控制着总运动：\n$$\nm \\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)\n$$\n其中 $m$ 是粒子质量，$q$ 是其电荷，$\\mathbf{v}$ 是其速度，$\\mathbf{E}$ 和 $\\mathbf{B}$ 分别是电场和磁场。\n\n在绝热运动的假设下，即特征拉莫尔半径 $\\rho_L$ 远小于磁场的空间尺度长度 $L$（$\\epsilon = \\rho_L/L \\ll 1$），我们可以在一个回旋周期内对运动方程进行平均。这个过程形式上得出了导心的运动方程。导心速度 $\\mathbf{v}_\\text{GC}$ 可以写成其平行于磁场的分量 $v_\\parallel \\mathbf{b}$ 和垂直于磁场的漂移速度 $\\mathbf{v}_D$ 之和，其中 $\\mathbf{b} = \\mathbf{B}/B$ 是沿磁场的单位矢量。\n$$\n\\mathbf{v}_\\text{GC} = v_\\parallel \\mathbf{b} + \\mathbf{v}_D\n$$\n由此平均过程产生的一般垂直漂移速度 $\\mathbf{v}_D$ 结合了多种效应。对于一般的非均匀磁场和垂直于它的静态电场，总漂移是 $\\mathbf{E}\\times\\mathbf{B}$ 漂移、梯度B漂移和曲率漂移之和：\n$$\n\\mathbf{v}_D = \\mathbf{v}_E + \\mathbf{v}_{\\nabla B} + \\mathbf{v}_R\n$$\n其中\n$$\n\\mathbf{v}_E = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}\n$$\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q} \\frac{\\mathbf{B} \\times \\nabla B}{B^2}\n$$\n$$\n\\mathbf{v}_R = \\frac{m v_\\parallel^2}{q} \\frac{\\mathbf{B} \\times ((\\mathbf{b} \\cdot \\nabla)\\mathbf{b})}{B^2}\n$$\n这里，$\\mu = m v_\\perp^2 / (2B)$ 是磁矩，它是一个绝热不变量。$(\\mathbf{b} \\cdot \\nabla)\\mathbf{b}$ 项代表磁力线的曲率。我们现在将这些一般结果应用于给定的场。\n\n给定的场是：\n$$\n\\mathbf{B}(\\mathbf{x}) = \\frac{B_0 R_0}{r}\\,\\mathbf{e}_\\theta, \\qquad \\mathbf{E}(\\mathbf{x}) = E_0\\,\\mathbf{e}_r\n$$\n磁场的大小为 $B = |\\mathbf{B}| = \\frac{B_0 R_0}{r}$。沿 $\\mathbf{B}$ 的单位矢量是 $\\mathbf{b} = \\mathbf{e}_\\theta$。\n\n**1. E×B 漂移速度 ($\\mathbf{v}_E$)**\n叉积 $\\mathbf{E} \\times \\mathbf{B}$ 是：\n$$\n\\mathbf{E} \\times \\mathbf{B} = (E_0 \\mathbf{e}_r) \\times (B \\mathbf{e}_\\theta) = E_0 B (\\mathbf{e}_r \\times \\mathbf{e}_\\theta)\n$$\n在柱坐标系中，径向和角向单位矢量的叉积是轴向单位矢量：$\\mathbf{e}_r \\times \\mathbf{e}_\\theta = \\mathbf{e}_z$。\n$$\n\\mathbf{E} \\times \\mathbf{B} = E_0 B \\mathbf{e}_z\n$$\n那么漂移速度是：\n$$\n\\mathbf{v}_E = \\frac{E_0 B \\mathbf{e}_z}{B^2} = \\frac{E_0}{B} \\mathbf{e}_z\n$$\n代入 $B$ 的表达式：\n$$\n\\mathbf{v}_E = \\frac{E_0}{B_0 R_0 / r} \\mathbf{e}_z = \\frac{E_0 r}{B_0 R_0} \\mathbf{e}_z\n$$\n这个漂移纯粹在 $\\mathbf{e}_z$ 方向上，并且与粒子的电荷或质量无关。\n\n**2. 梯度B漂移速度 ($\\mathbf{v}_{\\nabla B}$)**\n首先，我们计算磁场大小的梯度 $\\nabla B$：\n$$\nB(r) = \\frac{B_0 R_0}{r} \\implies \\nabla B = \\frac{dB}{dr} \\mathbf{e}_r = -\\frac{B_0 R_0}{r^2} \\mathbf{e}_r = -\\frac{B}{r} \\mathbf{e}_r\n$$\n接下来，我们计算叉积 $\\mathbf{B} \\times \\nabla B$：\n$$\n\\mathbf{B} \\times \\nabla B = (B \\mathbf{e}_\\theta) \\times \\left(-\\frac{B}{r} \\mathbf{e}_r\\right) = -\\frac{B^2}{r} (\\mathbf{e}_\\theta \\times \\mathbf{e}_r)\n$$\n因为 $\\mathbf{e}_\\theta \\times \\mathbf{e}_r = -(\\mathbf{e}_r \\times \\mathbf{e}_\\theta) = -\\mathbf{e}_z$，我们有：\n$$\n\\mathbf{B} \\times \\nabla B = -\\frac{B^2}{r} (-\\mathbf{e}_z) = \\frac{B^2}{r} \\mathbf{e}_z\n$$\n那么梯度B漂移是：\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q} \\frac{(B^2/r)\\mathbf{e}_z}{B^2} = \\frac{\\mu}{qr} \\mathbf{e}_z\n$$\n代入 $\\mu = m v_\\perp^2 / (2B)$ 和 $B = B_0 R_0 / r$：\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{m v_\\perp^2}{2qBr} \\mathbf{e}_z = \\frac{m v_\\perp^2}{2q(B_0 R_0/r)r} \\mathbf{e}_z = \\frac{m v_\\perp^2}{2q B_0 R_0} \\mathbf{e}_z\n$$\n这个漂移也纯粹在 $\\mathbf{e}_z$ 方向上。\n\n**3. 曲率漂移速度 ($\\mathbf{v}_R$)**\n首先，我们确定曲率矢量 $\\boldsymbol{\\kappa} = (\\mathbf{b} \\cdot \\nabla)\\mathbf{b}$。\n当 $\\mathbf{b} = \\mathbf{e}_\\theta$ 时，在柱坐标中算子 $(\\mathbf{b} \\cdot \\nabla)$ 是 $\\frac{1}{r}\\frac{\\partial}{\\partial \\theta}$。\n$$\n\\boldsymbol{\\kappa} = \\frac{1}{r} \\frac{\\partial \\mathbf{e}_\\theta}{\\partial \\theta}\n$$\n在笛卡尔分量中，$\\mathbf{e}_\\theta = (-\\sin\\theta, \\cos\\theta, 0)$。对 $\\theta$ 求导得到 $\\frac{\\partial \\mathbf{e}_\\theta}{\\partial \\theta} = (-\\cos\\theta, -\\sin\\theta, 0) = -\\mathbf{e}_r$。\n$$\n\\boldsymbol{\\kappa} = \\frac{1}{r}(-\\mathbf{e}_r) = -\\frac{\\mathbf{e}_r}{r}\n$$\n$\\mathbf{v}_R$ 分子中的叉积是：\n$$\n\\mathbf{B} \\times \\boldsymbol{\\kappa} = (B \\mathbf{e}_\\theta) \\times \\left(-\\frac{\\mathbf{e}_r}{r}\\right) = -\\frac{B}{r}(\\mathbf{e}_\\theta \\times \\mathbf{e}_r) = -\\frac{B}{r}(-\\mathbf{e}_z) = \\frac{B}{r} \\mathbf{e}_z\n$$\n曲率漂移是：\n$$\n\\mathbf{v}_R = \\frac{m v_\\parallel^2}{q} \\frac{(B/r)\\mathbf{e}_z}{B^2} = \\frac{m v_\\parallel^2}{qBr} \\mathbf{e}_z\n$$\n代入 $B = B_0 R_0 / r$：\n$$\n\\mathbf{v}_R = \\frac{m v_\\parallel^2}{q(B_0 R_0/r)r} \\mathbf{e}_z = \\frac{m v_\\parallel^2}{q B_0 R_0} \\mathbf{e}_z\n$$\n这个漂移也纯粹在 $\\mathbf{e}_z$ 方向上。\n\n**总漂移速度与诊断量**\n沿 $\\mathbf{e}_z$ 方向的总漂移速度分量是各漂移分量在 $z$ 方向上的和：\n$$\nv_{z, \\text{total}} = (\\mathbf{v}_E + \\mathbf{v}_{\\nabla B} + \\mathbf{v}_R) \\cdot \\mathbf{e}_z = \\frac{E_0 r}{B_0 R_0} + \\frac{m v_\\perp^2}{2 q B_0 R_0} + \\frac{m v_\\parallel^2}{q B_0 R_0}\n$$\n这可以紧凑地写成：\n$$\nv_{z, \\text{total}} = \\frac{E_0 r}{B_0 R_0} + \\frac{m}{q B_0 R_0} \\left( v_\\parallel^2 + \\frac{v_\\perp^2}{2} \\right)\n$$\n这就是第一个要求输出需要计算的表达式。\n\n能量守恒诊断量基于输入功率 $P = q\\,\\mathbf{E}\\cdot\\mathbf{v}_\\text{GC}$。导心速度为 $\\mathbf{v}_\\text{GC} = v_\\parallel \\mathbf{b} + \\mathbf{v}_D$。\n$$\n\\mathbf{v}_\\text{GC} = v_\\parallel \\mathbf{e}_\\theta + v_{z, \\text{total}} \\mathbf{e}_z\n$$\n电场为 $\\mathbf{E} = E_0\\mathbf{e}_r$。点积是：\n$$\n\\mathbf{E} \\cdot \\mathbf{v}_\\text{GC} = (E_0 \\mathbf{e}_r) \\cdot (v_\\parallel \\mathbf{e}_\\theta + v_{z, \\text{total}} \\mathbf{e}_z) = E_0 v_\\parallel (\\mathbf{e}_r \\cdot \\mathbf{e}_\\theta) + E_0 v_{z, \\text{total}} (\\mathbf{e}_r \\cdot \\mathbf{e}_z)\n$$\n由于基矢量是正交的，$\\mathbf{e}_r \\cdot \\mathbf{e}_\\theta = 0$ 且 $\\mathbf{e}_r \\cdot \\mathbf{e}_z = 0$。因此，$\\mathbf{E} \\cdot \\mathbf{v}_\\text{GC} = 0$，输入功率 $P=0$。诊断量 $|P|  \\tau_P$ 将是 $|0|  10^{-25}$，这总是为真。\n\n磁矩绝热性诊断量基于 $\\epsilon = \\rho_L/L$。问题指定 $L=r$。拉莫尔半径为 $\\rho_L = m v_\\perp / (|q|B)$。\n$$\n\\epsilon = \\frac{\\rho_L}{r} = \\frac{1}{r} \\left( \\frac{m v_\\perp}{|q|B} \\right)\n$$\n代入 $B = B_0 R_0 / r$：\n$$\n\\epsilon = \\frac{1}{r} \\left( \\frac{m v_\\perp}{|q| (B_0 R_0 / r)} \\right) = \\frac{m v_\\perp}{|q| B_0 R_0}\n$$\n该诊断量检查是否 $\\epsilon  \\tau_\\mu$。对于给定的磁场分布，此条件与位置 $r$ 无关。\n\n最终需要实现的公式是：\n1. 总漂移速度的 $z$ 分量：$v_z = \\frac{E_0 r}{B_0 R_0} + \\frac{m}{q B_0 R_0} \\left( v_\\parallel^2 + \\frac{v_\\perp^2}{2} \\right)$，其中 $r = \\sqrt{x^2+y^2}$。\n2. 能量守恒诊断量：始终为真，因为 $P=0$。\n3. 绝热性诊断量：如果 $\\frac{m v_\\perp}{|q| B_0 R_0}  \\tau_\\mu$ 则为真，否则为假。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes guiding-center drift properties for specified test cases.\n\n    This function implements the derived formulas for a charged particle's\n    drift velocity in an axisymmetric E-cross-B configuration. It processes\n    a fixed set of test cases, calculating the total vertical drift velocity\n    and two physics-based diagnostics for each.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement.\n    B0 = 5.0  # Reference magnetic field in Tesla\n    R0 = 1.0  # Reference length in meters\n    E0 = 100.0  # Electric field magnitude in V/m\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    m_p = 1.67262192369e-27  # Proton mass in kg\n    m_e = 9.1093837015e-31  # Electron mass in kg\n    \n    # Define numerical tolerances.\n    tau_P = 1.0e-25  # Power tolerance in J/s\n    tau_mu = 1.0e-3  # Adiabaticity parameter tolerance (dimensionless)\n\n    # Define the test cases (m, q, x, y, v_parallel, v_perp).\n    test_cases = [\n        # Case A: Happy path, moderate speeds, proton\n        (m_p, +e, 1.0, 0.0, 1.0e5, 2.0e4),\n        # Case B: Strong field region, small radius, proton\n        (m_p, +e, 0.2, 0.0, 5.0e4, 2.0e4),\n        # Case C: Charge sign reversal, electron\n        (m_e, -e, 1.5, 0.0, 2.0e6, 1.0e5),\n        # Case D: Adiabaticity edge, large v_perp, proton\n        (m_p, +e, 2.0, 0.0, 1.0e5, 5.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m, q, x, y, v_parallel, v_perp = case\n        \n        # Calculate cylindrical radius r = sqrt(x^2 + y^2)\n        r = np.sqrt(x**2 + y**2)\n        \n        # 1. Compute the total drift velocity component along e_z.\n        # This is the sum of E×B, grad-B, and curvature drifts.\n        # v_z = (E0*r / (B0*R0)) + (m/(q*B0*R0)) * (v_parallel^2 + 0.5*v_perp^2)\n        \n        # E-cross-B drift component in z\n        v_e_z = (E0 * r) / (B0 * R0)\n        \n        # Grad-B and Curvature drift components in z\n        # Note: The factor 1/(B0*R0) is common.\n        v_grad_curv_z = (m / (q * B0 * R0)) * (v_parallel**2 + 0.5 * v_perp**2)\n        \n        v_z_total = v_e_z + v_grad_curv_z\n        results.append(v_z_total)\n        \n        # 2. Compute the energy conservation diagnostic.\n        # P = q * E . v_GC. As derived, E . v_GC = 0 for the given fields.\n        # So, P is analytically zero.\n        power_input = 0.0\n        energy_ok = abs(power_input)  tau_P\n        results.append(energy_ok)\n        \n        # 3. Compute the magnetic moment adiabaticity diagnostic.\n        # Epsilon = rho_L / L, with L=r. This simplifies to m*v_perp / (|q|*B0*R0).\n        epsilon = (m * v_perp) / (abs(q) * B0 * R0)\n        mu_ok = epsilon  tau_mu\n        results.append(mu_ok)\n\n    # Format the final output as a single-line string.\n    # Booleans must be lower-case 'true' or 'false' for direct printing.\n    def format_item(item):\n        if isinstance(item, bool):\n            return str(item).lower()\n        return str(item)\n\n    print(f\"[{','.join(map(format_item, results))}]\")\n\nsolve()\n```"
        }
    ]
}