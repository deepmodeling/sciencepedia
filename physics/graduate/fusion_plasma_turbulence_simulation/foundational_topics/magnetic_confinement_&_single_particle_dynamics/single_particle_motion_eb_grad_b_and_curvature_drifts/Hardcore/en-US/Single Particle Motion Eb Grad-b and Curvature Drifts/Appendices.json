{
    "hands_on_practices": [
        {
            "introduction": "Understanding how charged particles behave in non-uniform magnetic fields is crucial for designing magnetic confinement fusion devices. This practice explores the \"mirror force,\" which arises from gradients in the magnetic field strength and governs the exchange between a particle's parallel and perpendicular kinetic energy. By applying the principles of energy conservation and the adiabatic invariance of the magnetic moment $\\mu$, you will derive the change in parallel velocity and see how this dynamic is linked to particle trapping and other guiding-center drifts .",
            "id": "4200941",
            "problem": "Consider a charged particle of mass $m$ and charge $q$ moving in a time-independent, nonuniform magnetic field $\\mathbf{B}(\\mathbf{x})$ with unit vector $\\hat{\\mathbf{b}} \\equiv \\mathbf{B}/B$ and field-aligned coordinate $s$ defined by $\\mathrm{d}\\mathbf{x}/\\mathrm{d}s = \\hat{\\mathbf{b}}$. Assume the guiding-center ordering $\\rho_{\\mathrm{L}}/L_{B} \\ll 1$, where $\\rho_{\\mathrm{L}}$ is the Larmor radius and $L_{B}$ is the characteristic scale length of magnetic-field variation, so that the gyromotion can be averaged and the magnetic moment $\\mu \\equiv m v_{\\perp}^{2}/(2B)$ is an adiabatic invariant to leading order. There is no electric field, $\\mathbf{E} = \\mathbf{0}$, so that any Electric field cross Magnetic field (E$\\times$B) drift is absent. The particle velocity decomposes as $\\mathbf{v} = v_{\\parallel}\\,\\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}$. Starting from Newton's second law with the Lorentz force, $m\\,\\mathrm{d}\\mathbf{v}/\\mathrm{d}t = q\\,\\mathbf{v}\\times\\mathbf{B}$, and using the guiding-center approximation, derive the effective parallel dynamics in the presence of magnetic-field-strength variation along the field line. In particular, focus on the mirror force $-\\mu\\,\\hat{\\mathbf{b}}\\cdot\\nabla B$ and compute the change in the parallel velocity $v_{\\parallel}$ as the particle moves from a reference location $s_{0}$ to a location $s$, where $B_{0} \\equiv B(s_{0})$ and $v_{\\parallel 0} \\equiv v_{\\parallel}(s_{0})$. Express your final result as a single closed-form analytic expression $v_{\\parallel}(s)$ in terms of $v_{\\parallel 0}$, $\\mu$, $m$, $B(s)$, and $B_{0}$. Then, discuss how the mirror-force-driven evolution of $v_{\\parallel}$ couples to the curvature drift that arises from field-line curvature, without altering the adiabatic invariant $\\mu$. Your final answer must be the requested analytic expression for $v_{\\parallel}(s)$ only; do not include any units inside your final boxed answer. No numerical evaluation or rounding is required.",
            "solution": "The problem is evaluated as scientifically grounded, well-posed, and objective. It is a standard problem in classical mechanics and plasma physics, specifically concerning the guiding-center approximation for charged particle motion. All provided information is consistent and sufficient for a unique solution. Therefore, the problem is deemed valid.\n\nThe motion of a charged particle of mass $m$ and charge $q$ in a magnetic field $\\mathbf{B}$ is governed by the Lorentz force, as stated in Newton's second law:\n$$m \\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t} = q \\mathbf{v} \\times \\mathbf{B}$$\nThe work done on the particle by the magnetic force is zero, because the force is always perpendicular to the velocity: $\\mathbf{F} \\cdot \\mathbf{v} = (q \\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{v} = 0$. Given that the electric field $\\mathbf{E}$ is zero, there is no other force doing work on the particle. Consequently, the kinetic energy $K$ of the particle is a constant of motion:\n$$\\frac{\\mathrm{d}K}{\\mathrm{d}t} = 0 \\implies K = \\text{constant}$$\nThe particle's velocity vector $\\mathbf{v}$ can be decomposed into components parallel and perpendicular to the magnetic field unit vector $\\hat{\\mathbf{b}} = \\mathbf{B}/B$: $\\mathbf{v} = v_{\\parallel} \\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}$. The total kinetic energy can then be expressed in terms of these components. Since $\\hat{\\mathbf{b}}$ and $\\mathbf{v}_{\\perp}$ are orthogonal, the squared magnitude of the velocity is $v^2 = \\mathbf{v} \\cdot \\mathbf{v} = v_{\\parallel}^2 + v_{\\perp}^2$. The conserved kinetic energy is:\n$$K = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2)$$\nThe problem states that within the guiding-center approximation, the magnetic moment, $\\mu$, is an adiabatic invariant. It is defined as:\n$$\\mu \\equiv \\frac{m v_{\\perp}^2}{2B}$$\nSince $\\mu$ is constant to leading order, we can express the perpendicular component of the kinetic energy in terms of $\\mu$ and the local magnetic field strength $B$:\n$$\\frac{1}{2}m v_{\\perp}^2 = \\mu B$$\nSubstituting this into the expression for the total kinetic energy, we obtain:\n$$K = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B$$\nBecause $K$ is a constant of motion, the quantity $\\frac{1}{2}m v_{\\parallel}^2 + \\mu B$ must have the same value at all points along the particle's guiding-center trajectory. Let's evaluate this conserved quantity at a reference location $s_0$ and an arbitrary location $s$. At $s_0$, the magnetic field strength is $B_0 \\equiv B(s_0)$ and the parallel velocity is $v_{\\parallel 0} \\equiv v_{\\parallel}(s_0)$. At location $s$, the field strength is $B(s)$ and the parallel velocity is $v_{\\parallel}(s)$. Equating the conserved energy at these two points gives:\n$$\\frac{1}{2}m v_{\\parallel}(s)^2 + \\mu B(s) = \\frac{1}{2}m v_{\\parallel 0}^2 + \\mu B_0$$\nThis equation describes the exchange between the parallel kinetic energy of the particle and a potential-like energy term $\\mu B$. The force responsible for this exchange is the mirror force, $F_{\\parallel} = -\\nabla_{\\parallel}(\\mu B) = -\\mu \\partial B / \\partial s$.\n\nTo find the expression for $v_{\\parallel}(s)$, we rearrange the conservation equation to solve for $v_{\\parallel}(s)^2$:\n$$\\frac{1}{2}m v_{\\parallel}(s)^2 = \\frac{1}{2}m v_{\\parallel 0}^2 + \\mu B_0 - \\mu B(s)$$\n$$v_{\\parallel}(s)^2 = v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))$$\nTaking the square root of both sides yields the final expression for the parallel velocity at location $s$:\n$$v_{\\parallel}(s) = \\pm \\sqrt{v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))}$$\nThe $\\pm$ sign indicates that the particle can be moving in either direction along the field line. If the particle moves into a region where $B(s)$ is sufficiently large such that the term inside the square root becomes zero, the particle's parallel motion stops and it is reflected, reversing the sign of its parallel velocity. This is the principle of a magnetic mirror.\n\nRegarding the coupling between the mirror-force-driven evolution of $v_{\\parallel}$ and the curvature drift, we first recall the expression for the curvature drift velocity $\\mathbf{v}_c$. This drift arises because the centrifugal force experienced by the particle moving along a curved field line is not perfectly balanced by the Lorentz force in a uniform-field picture. The drift velocity is given by:\n$$\\mathbf{v}_c = \\frac{m v_{\\parallel}^2}{q B^2} \\mathbf{B} \\times (\\hat{\\mathbf{b}} \\cdot \\nabla \\hat{\\mathbf{b}})$$\nThe term $\\hat{\\mathbf{b}} \\cdot \\nabla \\hat{\\mathbf{b}}$ represents the curvature vector of the magnetic field line. The crucial aspect for the present discussion is that the magnitude of the curvature drift, $|\\mathbf{v}_c|$, is directly proportional to the square of the parallel velocity, $v_{\\parallel}^2$.\nThe first part of our derivation showed that $v_{\\parallel}$ is not, in general, constant. Its value changes according to the relation:\n$$v_{\\parallel}^2(s) = v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))$$\nThis establishes a direct coupling. As a particle's guiding center moves along a magnetic field line, it experiences variations in the magnetic field strength $B(s)$. The mirror force acts on the particle, converting parallel kinetic energy into perpendicular kinetic energy (or vice-versa), thereby changing $v_{\\parallel}(s)$. This change in $v_{\\parallel}(s)$ then directly modulates the magnitude of the curvature drift $\\mathbf{v}_c$. For instance, if a particle travels into a stronger magnetic field region (a magnetic mirror), $v_{\\parallel}$ decreases, which in turn reduces the speed of the curvature drift. Conversely, moving into a weaker field region increases $v_{\\parallel}$ and enhances the curvature drift. This entire process occurs while the magnetic moment $\\mu$ and the total energy $K$ remain conserved. This coupling between parallel motion and perpendicular drifts is a fundamental aspect of particle dynamics in the complex magnetic geometries used for magnetic confinement fusion.",
            "answer": "$$\\boxed{\\pm \\sqrt{v_{\\parallel 0}^{2} + \\frac{2\\mu}{m}(B_{0} - B(s))}}$$"
        },
        {
            "introduction": "While the $\\mathbf{E}\\times\\mathbf{B}$ drift describes the primary motion in crossed fields, a particle's inertia becomes important when the electric field varies in time. This practice delves into the origin of the polarization drift, an inertial effect that represents the particle's delayed response to a changing $\\mathbf{E}$ field. By systematically analyzing the Lorentz force equation in the low-frequency limit, you will derive this crucial drift velocity and quantify its magnitude, which is fundamental to understanding plasma waves and transport .",
            "id": "4200957",
            "problem": "A nonrelativistic charged particle of charge $q$ and mass $m$ moves in a uniform, static magnetic field $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$. The perpendicular electric field is spatially uniform, strictly perpendicular to $\\mathbf{B}$, and varies harmonically in time as $\\mathbf{E}_{\\perp}(t) = \\Re\\{\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\}$, where $\\mathbf{E}_{0}\\cdot\\hat{\\mathbf{z}}=0$ and $\\omega>0$. Starting from the Lorentz equation $m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right)$, work in the regime where the frequency is asymptotically small compared to the cyclotron frequency, $\\omega/\\Omega \\ll 1$, with $\\Omega \\equiv |q|B/m$. Using a systematic separation of time scales between the fast gyromotion and the slow drift, derive the leading-order slow drift contribution to the perpendicular guiding-center velocity, denoted $\\mathbf{v}_{p}(t)$, in response to the time dependence of $\\mathbf{E}_{\\perp}(t)$. Then compare its magnitude to that of the instantaneous electric cross magnetic (E×B) drift, $\\mathbf{v}_{E}(t) \\equiv \\mathbf{E}_{\\perp}(t)\\times \\mathbf{B}/B^{2}$, and determine the ratio of their magnitudes in the limit $\\omega/\\Omega \\ll 1$.\n\nProvide your final answer as the closed-form symbolic expression for the ratio $\\left|\\mathbf{v}_{p}\\right|/\\left|\\mathbf{v}_{E}\\right|$ in terms of $\\omega$ and $\\Omega$. No numerical evaluation is required, and no units are needed for the final ratio since it is dimensionless.",
            "solution": "The problem requires the derivation of the polarization drift velocity for a charged particle in a uniform magnetic field and a time-varying perpendicular electric field, within the low-frequency limit $\\omega/\\Omega \\ll 1$. We must then determine the ratio of the magnitude of this drift to that of the E×B drift.\n\nWe begin with the nonrelativistic Lorentz equation of motion for a particle of charge $q$ and mass $m$:\n$$\nm\\,\\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right)\n$$\nThe given fields are a uniform, static magnetic field $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$ and a perpendicular, time-harmonic electric field $\\mathbf{E}(t) = \\mathbf{E}_{\\perp}(t) = \\Re\\{\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\}$, where $\\mathbf{E}_{0}\\cdot\\hat{\\mathbf{z}}=0$. The motion parallel to $\\mathbf{B}$ is trivial ($E_{\\parallel}=0 \\implies v_{\\parallel}=\\text{constant}$), so we focus on the perpendicular velocity components, $\\mathbf{v}_{\\perp}$. The equation for the perpendicular motion is:\n$$\nm\\,\\frac{d\\mathbf{v}_{\\perp}}{dt} = q\\left(\\mathbf{E}_{\\perp}(t) + \\mathbf{v}_{\\perp}\\times \\mathbf{B}\\right)\n$$\nThis problem involves two distinct time scales: the fast gyromotion at the cyclotron frequency $\\Omega = |q|B/m$, and the slow variation of the electric field at frequency $\\omega$. The condition $\\omega \\ll \\Omega$ allows for a systematic separation of the velocity into a slowly-drifting guiding-center velocity, $\\mathbf{v}_{GC}$, and a rapidly-gyrating component. The total guiding-center drift is the sum of various drifts. The dominant drift is the electric cross magnetic (E×B) drift, defined as:\n$$\n\\mathbf{v}_{E}(t) \\equiv \\frac{\\mathbf{E}_{\\perp}(t)\\times \\mathbf{B}}{B^{2}}\n$$\nWe seek the correction to this drift that arises due to the time-dependence of $\\mathbf{E}_{\\perp}(t)$. This correction is the polarization drift, $\\mathbf{v}_p(t)$.\n\nA standard method to derive this is to express the total perpendicular velocity $\\mathbf{v}_{\\perp}$ as an iterative series. An exact rearrangement of the equation of motion for $\\mathbf{v}_{\\perp}$ can be found by taking its cross product with $\\mathbf{B}$:\n$$\nm\\,\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) = q(\\mathbf{E}_{\\perp} \\times \\mathbf{B}) + q((\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\times \\mathbf{B})\n$$\nUsing the vector triple product identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$ and noting that $\\mathbf{v}_{\\perp} \\cdot \\mathbf{B} = 0$, the last term becomes:\n$$\n(\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\times \\mathbf{B} = \\mathbf{B}(\\mathbf{v}_{\\perp}\\cdot\\mathbf{B}) - \\mathbf{v}_{\\perp}(\\mathbf{B}\\cdot\\mathbf{B}) = -B^2 \\mathbf{v}_{\\perp}\n$$\nSubstituting this back, we get:\n$$\nm\\,\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) = q(\\mathbf{E}_{\\perp} \\times \\mathbf{B}) - qB^2 \\mathbf{v}_{\\perp}\n$$\nSolving for $\\mathbf{v}_{\\perp}$ yields the exact expression:\n$$\n\\mathbf{v}_{\\perp} = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right)\n$$\nThe first term is the instantaneous E×B drift, $\\mathbf{v}_{E}$. The second term contains all other motion, including the gyromotion and any additional drifts. The guiding-center velocity $\\mathbf{v}_{GC}$ is the time average of $\\mathbf{v}_{\\perp}$ over the fast gyroperiod, which filters out the gyromotion.\n$$\n\\mathbf{v}_{GC} = \\langle\\mathbf{v}_{\\perp}\\rangle = \\langle\\mathbf{v}_{E}\\rangle - \\left\\langle \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\right\\rangle\n$$\nSince $\\mathbf{v}_E$ and $\\mathbf{B}$ vary only on the slow time scale, they are effectively constant over a gyro-orbit, so $\\langle\\mathbf{v}_{E}\\rangle=\\mathbf{v}_{E}$. The average of the derivative of the total velocity is the derivative of the average velocity, $\\langle d\\mathbf{v}_{\\perp}/dt \\rangle \\approx d\\langle\\mathbf{v}_{\\perp}\\rangle/dt = d\\mathbf{v}_{GC}/dt$. Therefore:\n$$\n\\mathbf{v}_{GC} \\approx \\mathbf{v}_{E} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{GC}}{dt} \\times \\mathbf{B}\\right)\n$$\nThis is an equation for the guiding-center velocity $\\mathbf{v}_{GC}$. We can solve it iteratively based on the smallness of the correction term. The time derivative introduces a factor of $\\omega$, while the gyromotion implicit in the cross product involves $\\Omega$. The correction term is thus of order $\\omega/\\Omega \\ll 1$ compared to the main velocity.\n\nTo leading order, the guiding-center velocity is simply the E×B drift:\n$$\n\\mathbf{v}_{GC}^{(0)} = \\mathbf{v}_{E}(t)\n$$\nTo find the first-order correction, we substitute this approximation back into the derivative term of the equation for $\\mathbf{v}_{GC}$:\n$$\n\\mathbf{v}_{GC}^{(1)} = \\mathbf{v}_{E} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{E}}{dt} \\times \\mathbf{B}\\right)\n$$\nThe polarization drift $\\mathbf{v}_{p}$ is defined as this first-order correction term:\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{E}}{dt} \\times \\mathbf{B}\\right)\n$$\nWe now substitute the definition of $\\mathbf{v}_{E}(t)$:\n$$\n\\frac{d\\mathbf{v}_{E}}{dt} = \\frac{d}{dt}\\left(\\frac{\\mathbf{E}_{\\perp}(t) \\times \\mathbf{B}}{B^2}\\right) = \\frac{1}{B^2}\\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right)\n$$\nsince $\\mathbf{B}$ and $B^2$ are constant. The expression for $\\mathbf{v}_{p}$ becomes:\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^2}\\left[ \\frac{1}{B^2}\\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\times \\mathbf{B} \\right] = - \\frac{m}{qB^4}\\left[ \\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\times \\mathbf{B} \\right]\n$$\nUsing the same vector identity as before, and noting that $d\\mathbf{E}_{\\perp}/dt$ is perpendicular to $\\mathbf{B}$, we have $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{B} = -B^2\\mathbf{A}$, where $\\mathbf{A} = d\\mathbf{E}_{\\perp}/dt$.\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^4} \\left[ -B^2 \\frac{d\\mathbf{E}_{\\perp}}{dt} \\right] = \\frac{m}{qB^2} \\frac{d\\mathbf{E}_{\\perp}}{dt}\n$$\nThis is the expression for the polarization drift velocity.\n\nNext, we compare the magnitudes of $\\mathbf{v}_{p}(t)$ and $\\mathbf{v}_{E}(t)$. For harmonically varying quantities, the most meaningful comparison is between their amplitudes. We use complex notation for simplicity, where physical quantities are the real part.\nLet $\\tilde{\\mathbf{E}}_{\\perp}(t) = \\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)$. The amplitudes of the corresponding complex velocities will give the amplitudes of the physical velocities.\nThe complex E×B velocity is:\n$$\n\\tilde{\\mathbf{v}}_{E}(t) = \\frac{\\tilde{\\mathbf{E}}_{\\perp}(t) \\times \\mathbf{B}}{B^2} = \\frac{\\mathbf{E}_{0} \\times \\mathbf{B}}{B^2} \\exp(-\\mathrm{i}\\,\\omega t)\n$$\nThe amplitude of this velocity, which we denote $|\\mathbf{v}_{E}|$, is the magnitude of its complex vector part:\n$$\n|\\mathbf{v}_{E}| = \\left|\\frac{\\mathbf{E}_{0} \\times \\mathbf{B}}{B^2}\\right| = \\frac{|\\mathbf{E}_{0}| |\\mathbf{B}| \\sin(\\pi/2)}{B^2} = \\frac{|\\mathbf{E}_{0}|B}{B^2} = \\frac{|\\mathbf{E}_{0}|}{B}\n$$\nHere we used that $\\mathbf{E}_0$ is perpendicular to $\\mathbf{B}$.\n\nThe complex polarization drift velocity is:\n$$\n\\tilde{\\mathbf{v}}_{p}(t) = \\frac{m}{qB^2} \\frac{d\\tilde{\\mathbf{E}}_{\\perp}}{dt} = \\frac{m}{qB^2} \\frac{d}{dt}\\left(\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\right) = \\frac{-\\mathrm{i}\\,\\omega m}{qB^2} \\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\n$$\nThe amplitude of this velocity, denoted $|\\mathbf{v}_{p}|$, is:\n$$\n|\\mathbf{v}_{p}| = \\left|\\frac{-\\mathrm{i}\\,\\omega m}{qB^2} \\mathbf{E}_{0}\\right| = \\frac{\\omega m}{|q|B^2} |\\mathbf{E}_{0}|\n$$\nNow, we find the ratio of these magnitudes:\n$$\n\\frac{|\\mathbf{v}_{p}|}{|\\mathbf{v}_{E}|} = \\frac{\\frac{\\omega m |\\mathbf{E}_{0}|}{|q|B^2}}{\\frac{|\\mathbf{E}_{0}|}{B}} = \\frac{\\omega m}{|q|B}\n$$\nUsing the definition of the cyclotron frequency, $\\Omega = |q|B/m$, we can rewrite the denominator as $|q|B = m\\Omega$.\n$$\n\\frac{|\\mathbf{v}_{p}|}{|\\mathbf{v}_{E}|} = \\frac{\\omega m}{m\\Omega} = \\frac{\\omega}{\\Omega}\n$$\nThis confirms that the polarization drift is a small correction to the E×B drift in the specified limit $\\omega/\\Omega \\ll 1$. The ratio of their magnitudes is precisely this small parameter.",
            "answer": "$$\n\\boxed{\\frac{\\omega}{\\Omega}}\n$$"
        },
        {
            "introduction": "In a real fusion plasma, a particle's trajectory is determined by the combined action of several drifts. This exercise synthesizes your understanding by applying it to a benchmark case with an axisymmetric magnetic field, similar to that in a simple toroidal device. You will derive the $\\mathbf{E}\\times\\mathbf{B}$, gradient-B, and curvature drifts for this specific geometry and then implement a program to compute the total drift and verify the validity of the guiding-center approximation by checking fundamental conservation laws .",
            "id": "4200930",
            "problem": "Consider an axisymmetric benchmark for single-particle guiding-center motion in a fusion-relevant magnetic geometry. You are to verify drift computations and invariants using fully analytic electric and magnetic fields. Begin from the Lorentz force law and core definitions, and do not rely on pre-memorized drift formulas; instead, derive what the relevant drifts must be, why they arise, and how they follow from the underlying laws, then encode the result into a program that computes the specified diagnostics.\n\nGeometry and fields. Let the spatial position be $\\mathbf{x} = (x,y,z)$ in Cartesian coordinates, with the cylindrical radius in the $x\\text{-}y$ plane defined by $r = \\sqrt{x^2 + y^2}$. Define the orthonormal basis vectors in the plane by\n$$\n\\mathbf{e}_r = \\frac{1}{r}\\,(x, y, 0),\\qquad\n\\mathbf{e}_\\theta = \\frac{1}{r}\\,(-y, x, 0),\\qquad\n\\mathbf{e}_z = (0,0,1).\n$$\nLet the magnetic field be purely azimuthal and depend on radius as\n$$\n\\mathbf{B}(\\mathbf{x}) = \\frac{B_0 R_0}{r}\\,\\mathbf{e}_\\theta,\n$$\nand the electric field be purely radial with constant magnitude\n$$\n\\mathbf{E}(\\mathbf{x}) = E_0\\,\\mathbf{e}_r,\n$$\nwhere $B_0$ is a reference magnetic field magnitude in $\\mathrm{Tesla}$, $R_0$ is a reference length in $\\mathrm{meter}$, and $E_0$ is a reference electric field magnitude in $\\mathrm{Volt}/\\mathrm{meter}$.\n\nFundamental base. Use the nonrelativistic Lorentz force law $m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)$, the definition of the guiding-center magnetic moment $\\mu = m v_\\perp^2/(2 B)$, and the kinematic relations $v = dx/dt$. Take $m$ as the particle mass in $\\mathrm{kilogram}$, $q$ as the particle charge in $\\mathrm{Coulomb}$, $v_\\parallel$ as the component of $\\mathbf{v}$ along $\\mathbf{B}$, and $v_\\perp$ as the magnitude of the component of $\\mathbf{v}$ perpendicular to $\\mathbf{B}$ associated with gyromotion. Assume static fields, no parallel electric field, and adiabatic motion with characteristic scale separation quantified by the small parameter $\\epsilon = \\rho_L/L$, where $\\rho_L = m v_\\perp/(|q| B)$ is the Larmor radius and $L$ is the characteristic magnetic gradient scale length.\n\nTask. Derive from the fundamental base the guiding-center drift velocities associated with the electric field cross magnetic field (E×B), the magnetic field strength gradient, and magnetic field-line curvature in the specified geometry. Then implement a program that, for each test case, computes:\n- The total drift velocity component along $\\mathbf{e}_z$ in $\\mathrm{m}/\\mathrm{s}$, obtained by summing the E×B, gradient, and curvature drifts.\n- An energy-conservation diagnostic given by the instantaneous power input $P = q\\,\\mathbf{E}\\cdot\\mathbf{v}_\\text{GC}$, where $\\mathbf{v}_\\text{GC}$ is the guiding-center velocity comprised of the parallel component and the drift components. Report a boolean that is true if $|P|$ is below a numerical tolerance and false otherwise.\n- A magnetic-moment adiabaticity diagnostic based on $\\epsilon = \\rho_L/L$ with $L=r$, reporting a boolean that is true if $\\epsilon$ is below a specified tolerance and false otherwise.\n\nUnits. All velocities must be computed and reported in $\\mathrm{m}/\\mathrm{s}$. The power $P$ must be computed in $\\mathrm{J}/\\mathrm{s}$ internally, but only the boolean diagnostic is reported. Angles, where implicitly involved via the geometry, are handled in radians as part of the vector basis definitions above.\n\nTest suite. Use the following constants across all test cases:\n- $B_0 = 5\\,\\mathrm{T}$, $R_0 = 1\\,\\mathrm{m}$, $E_0 = 100\\,\\mathrm{V}/\\mathrm{m}$.\n- Elementary charge magnitude $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$.\n- Proton mass $m_p = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$.\n- Electron mass $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$.\n- Energy tolerance $\\tau_P = 10^{-25}$ in $\\mathrm{J}/\\mathrm{s}$.\n- Adiabaticity tolerance $\\tau_\\mu = 10^{-3}$ (dimensionless).\n\nDefine four test cases $(m, q, x, y, v_\\parallel, v_\\perp)$ to probe coverage:\n1. Case A (happy path, moderate speeds, proton): $m = m_p$, $q = +e$, $x = 1.0\\,\\mathrm{m}$, $y = 0.0\\,\\mathrm{m}$, $v_\\parallel = 1.0\\times 10^{5}\\,\\mathrm{m}/\\mathrm{s}$, $v_\\perp = 2.0\\times 10^{4}\\,\\mathrm{m}/\\mathrm{s}$.\n2. Case B (strong field region, small radius, proton): $m = m_p$, $q = +e$, $x = 0.2\\,\\mathrm{m}$, $y = 0.0\\,\\mathrm{m}$, $v_\\parallel = 5.0\\times 10^{4}\\,\\mathrm{m}/\\mathrm{s}$, $v_\\perp = 2.0\\times 10^{4}\\,\\mathrm{m}/\\mathrm{s}$.\n3. Case C (charge sign reversal, electron): $m = m_e$, $q = -e$, $x = 1.5\\,\\mathrm{m}$, $y = 0.0\\,\\mathrm{m}$, $v_\\parallel = 2.0\\times 10^{6}\\,\\mathrm{m}/\\mathrm{s}$, $v_\\perp = 1.0\\times 10^{5}\\,\\mathrm{m}/\\mathrm{s}$.\n4. Case D (adiabaticity edge, large $v_\\perp$, proton): $m = m_p$, $q = +e$, $x = 2.0\\,\\mathrm{m}$, $y = 0.0\\,\\mathrm{m}$, $v_\\parallel = 1.0\\times 10^{5}\\,\\mathrm{m}/\\mathrm{s}$, $v_\\perp = 5.0\\times 10^{6}\\,\\mathrm{m}/\\mathrm{s}$.\n\nProgram requirements. Your program must:\n- Implement the derivation results for the drift velocities in the given geometry.\n- For each test case, compute the total drift velocity component along $\\mathbf{e}_z$ in $\\mathrm{m}/\\mathrm{s}$, the energy-conservation boolean with $|P| < \\tau_P$, and the magnetic-moment adiabaticity boolean with $\\epsilon < \\tau_\\mu$.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the flat order\n$$\n[\\;v_{z,A},\\ \\text{energy\\_ok}_A,\\ \\text{mu\\_ok}_A,\\ v_{z,B},\\ \\text{energy\\_ok}_B,\\ \\text{mu\\_ok}_B,\\ v_{z,C},\\ \\text{energy\\_ok}_C,\\ \\text{mu\\_ok}_C,\\ v_{z,D},\\ \\text{energy\\_ok}_D,\\ \\text{mu\\_ok}_D\\;],\n$$\nwhere $v_{z,\\cdot}$ are floats in $\\mathrm{m}/\\mathrm{s}$ and the diagnostics are booleans.\n\nScientific realism. The chosen fields are divergence-free away from $r = 0$ and reflect a simple toroidal configuration with circular field lines. The electric field is everywhere perpendicular to the magnetic field, ensuring no parallel electric work. The test suite probes normal operation, strong-field proximity, charge sign reversal, and the breakdown of strict adiabaticity due to large $v_\\perp$.\n\nNo inputs. The program must be self-contained and must not request any user input.",
            "solution": "The problem requires the derivation of guiding-center drift velocities for a charged particle in specified analytic electric and magnetic fields, followed by a numerical implementation to compute these drifts and related diagnostics. The derivation must originate from the fundamental principles embodied in the nonrelativistic Lorentz force law.\n\nThe motion of a charged particle in a magnetic field can be decomposed into a fast gyration around a magnetic field line and a slower drift of the center of this gyration, known as the guiding center. The Lorentz force equation governs the total motion:\n$$\nm \\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)\n$$\nwhere $m$ is the particle mass, $q$ is its charge, $\\mathbf{v}$ is its velocity, and $\\mathbf{E}$ and $\\mathbf{B}$ are the electric and magnetic fields, respectively.\n\nUnder the assumption of adiabatic motion, where the characteristic Larmor radius $\\rho_L$ is much smaller than the spatial scale length $L$ of the magnetic field ($\\epsilon = \\rho_L/L \\ll 1$), we can average the equation of motion over one gyro-period. This procedure formally yields the equations of motion for the guiding center. The velocity of the guiding center, $\\mathbf{v}_\\text{GC}$, can be written as the sum of its component parallel to the magnetic field, $v_\\parallel \\mathbf{b}$, and a drift velocity, $\\mathbf{v}_D$, perpendicular to the magnetic field, where $\\mathbf{b} = \\mathbf{B}/B$ is the unit vector along the magnetic field.\n$$\n\\mathbf{v}_\\text{GC} = v_\\parallel \\mathbf{b} + \\mathbf{v}_D\n$$\nThe general perpendicular drift velocity $\\mathbf{v}_D$ arising from this averaging process combines several effects. For a general non-uniform magnetic field and a static electric field perpendicular to it, the total drift is the sum of the $\\mathbf{E}\\times\\mathbf{B}$ drift, the gradient-B drift, and the curvature drift:\n$$\n\\mathbf{v}_D = \\mathbf{v}_E + \\mathbf{v}_{\\nabla B} + \\mathbf{v}_R\n$$\nwhere\n$$\n\\mathbf{v}_E = \\frac{\\mathbf{E} \\times \\mathbf{B}}{B^2}\n$$\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q} \\frac{\\mathbf{B} \\times \\nabla B}{B^2}\n$$\n$$\n\\mathbf{v}_R = \\frac{m v_\\parallel^2}{q} \\frac{\\mathbf{B} \\times ((\\mathbf{b} \\cdot \\nabla)\\mathbf{b})}{B^2}\n$$\nHere, $\\mu = m v_\\perp^2 / (2B)$ is the magnetic moment, which is an adiabatic invariant. The term $(\\mathbf{b} \\cdot \\nabla)\\mathbf{b}$ represents the curvature of the magnetic field line. We will now specialize these general results to the fields provided.\n\nThe given fields are:\n$$\n\\mathbf{B}(\\mathbf{x}) = \\frac{B_0 R_0}{r}\\,\\mathbf{e}_\\theta, \\qquad \\mathbf{E}(\\mathbf{x}) = E_0\\,\\mathbf{e}_r\n$$\nThe magnitude of the magnetic field is $B = |\\mathbf{B}| = \\frac{B_0 R_0}{r}$. The unit vector along $\\mathbf{B}$ is $\\mathbf{b} = \\mathbf{e}_\\theta$.\n\n**1. E×B Drift Velocity ($\\mathbf{v}_E$)**\nThe cross product $\\mathbf{E} \\times \\mathbf{B}$ is:\n$$\n\\mathbf{E} \\times \\mathbf{B} = (E_0 \\mathbf{e}_r) \\times (B \\mathbf{e}_\\theta) = E_0 B (\\mathbf{e}_r \\times \\mathbf{e}_\\theta)\n$$\nIn a cylindrical system, the cross product of the radial and azimuthal unit vectors is the axial unit vector: $\\mathbf{e}_r \\times \\mathbf{e}_\\theta = \\mathbf{e}_z$.\n$$\n\\mathbf{E} \\times \\mathbf{B} = E_0 B \\mathbf{e}_z\n$$\nThe drift velocity is then:\n$$\n\\mathbf{v}_E = \\frac{E_0 B \\mathbf{e}_z}{B^2} = \\frac{E_0}{B} \\mathbf{e}_z\n$$\nSubstituting the expression for $B$:\n$$\n\\mathbf{v}_E = \\frac{E_0}{B_0 R_0 / r} \\mathbf{e}_z = \\frac{E_0 r}{B_0 R_0} \\mathbf{e}_z\n$$\nThis drift is purely in the $\\mathbf{e}_z$ direction and is independent of the particle's charge or mass.\n\n**2. Gradient-B Drift Velocity ($\\mathbf{v}_{\\nabla B}$)**\nFirst, we compute the gradient of the magnetic field magnitude, $\\nabla B$:\n$$\nB(r) = \\frac{B_0 R_0}{r} \\implies \\nabla B = \\frac{dB}{dr} \\mathbf{e}_r = -\\frac{B_0 R_0}{r^2} \\mathbf{e}_r = -\\frac{B}{r} \\mathbf{e}_r\n$$\nNext, we compute the cross product $\\mathbf{B} \\times \\nabla B$:\n$$\n\\mathbf{B} \\times \\nabla B = (B \\mathbf{e}_\\theta) \\times \\left(-\\frac{B}{r} \\mathbf{e}_r\\right) = -\\frac{B^2}{r} (\\mathbf{e}_\\theta \\times \\mathbf{e}_r)\n$$\nSince $\\mathbf{e}_\\theta \\times \\mathbf{e}_r = -(\\mathbf{e}_r \\times \\mathbf{e}_\\theta) = -\\mathbf{e}_z$, we have:\n$$\n\\mathbf{B} \\times \\nabla B = -\\frac{B^2}{r} (-\\mathbf{e}_z) = \\frac{B^2}{r} \\mathbf{e}_z\n$$\nThe gradient-B drift is then:\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{\\mu}{q} \\frac{(B^2/r)\\mathbf{e}_z}{B^2} = \\frac{\\mu}{qr} \\mathbf{e}_z\n$$\nSubstituting $\\mu = m v_\\perp^2 / (2B)$ and $B = B_0 R_0 / r$:\n$$\n\\mathbf{v}_{\\nabla B} = \\frac{m v_\\perp^2}{2qBr} \\mathbf{e}_z = \\frac{m v_\\perp^2}{2q(B_0 R_0/r)r} \\mathbf{e}_z = \\frac{m v_\\perp^2}{2q B_0 R_0} \\mathbf{e}_z\n$$\nThis drift is also purely in the $\\mathbf{e}_z$ direction.\n\n**3. Curvature Drift Velocity ($\\mathbf{v}_R$)**\nFirst, we determine the curvature vector $\\boldsymbol{\\kappa} = (\\mathbf{b} \\cdot \\nabla)\\mathbf{b}$.\nWith $\\mathbf{b} = \\mathbf{e}_\\theta$, the operator $(\\mathbf{b} \\cdot \\nabla)$ in cylindrical coordinates is $\\frac{1}{r}\\frac{\\partial}{\\partial \\theta}$.\n$$\n\\boldsymbol{\\kappa} = \\frac{1}{r} \\frac{\\partial \\mathbf{e}_\\theta}{\\partial \\theta}\n$$\nIn Cartesian components, $\\mathbf{e}_\\theta = (-\\sin\\theta, \\cos\\theta, 0)$. Differentiating with respect to $\\theta$ gives $\\frac{\\partial \\mathbf{e}_\\theta}{\\partial \\theta} = (-\\cos\\theta, -\\sin\\theta, 0) = -\\mathbf{e}_r$.\n$$\n\\boldsymbol{\\kappa} = \\frac{1}{r}(-\\mathbf{e}_r) = -\\frac{\\mathbf{e}_r}{r}\n$$\nThe cross product in the numerator of $\\mathbf{v}_R$ is:\n$$\n\\mathbf{B} \\times \\boldsymbol{\\kappa} = (B \\mathbf{e}_\\theta) \\times \\left(-\\frac{\\mathbf{e}_r}{r}\\right) = -\\frac{B}{r}(\\mathbf{e}_\\theta \\times \\mathbf{e}_r) = -\\frac{B}{r}(-\\mathbf{e}_z) = \\frac{B}{r} \\mathbf{e}_z\n$$\nThe curvature drift is:\n$$\n\\mathbf{v}_R = \\frac{m v_\\parallel^2}{q} \\frac{(B/r)\\mathbf{e}_z}{B^2} = \\frac{m v_\\parallel^2}{qBr} \\mathbf{e}_z\n$$\nSubstituting $B = B_0 R_0 / r$:\n$$\n\\mathbf{v}_R = \\frac{m v_\\parallel^2}{q(B_0 R_0/r)r} \\mathbf{e}_z = \\frac{m v_\\parallel^2}{q B_0 R_0} \\mathbf{e}_z\n$$\nThis drift is also purely in the $\\mathbf{e}_z$ direction.\n\n**Total Drift Velocity and Diagnostics**\nThe total drift velocity component along $\\mathbf{e}_z$ is the sum of the $z$-components of the individual drifts:\n$$\nv_{z, \\text{total}} = (\\mathbf{v}_E + \\mathbf{v}_{\\nabla B} + \\mathbf{v}_R) \\cdot \\mathbf{e}_z = \\frac{E_0 r}{B_0 R_0} + \\frac{m v_\\perp^2}{2 q B_0 R_0} + \\frac{m v_\\parallel^2}{q B_0 R_0}\n$$\nThis can be compactly written as:\n$$\nv_{z, \\text{total}} = \\frac{E_0 r}{B_0 R_0} + \\frac{m}{q B_0 R_0} \\left( v_\\parallel^2 + \\frac{v_\\perp^2}{2} \\right)\n$$\nThis is the expression to be computed for the first required output.\n\nThe energy-conservation diagnostic is based on the power input $P = q\\,\\mathbf{E}\\cdot\\mathbf{v}_\\text{GC}$. The guiding-center velocity is $\\mathbf{v}_\\text{GC} = v_\\parallel \\mathbf{b} + \\mathbf{v}_D$.\n$$\n\\mathbf{v}_\\text{GC} = v_\\parallel \\mathbf{e}_\\theta + v_{z, \\text{total}} \\mathbf{e}_z\n$$\nThe electric field is $\\mathbf{E} = E_0\\mathbf{e}_r$. The dot product is:\n$$\n\\mathbf{E} \\cdot \\mathbf{v}_\\text{GC} = (E_0 \\mathbf{e}_r) \\cdot (v_\\parallel \\mathbf{e}_\\theta + v_{z, \\text{total}} \\mathbf{e}_z) = E_0 v_\\parallel (\\mathbf{e}_r \\cdot \\mathbf{e}_\\theta) + E_0 v_{z, \\text{total}} (\\mathbf{e}_r \\cdot \\mathbf{e}_z)\n$$\nSince the basis vectors are orthogonal, $\\mathbf{e}_r \\cdot \\mathbf{e}_\\theta = 0$ and $\\mathbf{e}_r \\cdot \\mathbf{e}_z = 0$. Therefore, $\\mathbf{E} \\cdot \\mathbf{v}_\\text{GC} = 0$, and the power input $P=0$. The diagnostic $|P| < \\tau_P$ will be $|0| < 10^{-25}$, which is always true.\n\nThe magnetic-moment adiabaticity diagnostic is based on $\\epsilon = \\rho_L/L$. The problem specifies $L=r$. The Larmor radius is $\\rho_L = m v_\\perp / (|q|B)$.\n$$\n\\epsilon = \\frac{\\rho_L}{r} = \\frac{1}{r} \\left( \\frac{m v_\\perp}{|q|B} \\right)\n$$\nSubstituting $B = B_0 R_0 / r$:\n$$\n\\epsilon = \\frac{1}{r} \\left( \\frac{m v_\\perp}{|q| (B_0 R_0 / r)} \\right) = \\frac{m v_\\perp}{|q| B_0 R_0}\n$$\nThe diagnostic checks if $\\epsilon < \\tau_\\mu$. This condition is independent of position $r$ for the given magnetic field profile.\n\nThe final formulas to be implemented are:\n1.  Total drift velocity $z$-component: $v_z = \\frac{E_0 r}{B_0 R_0} + \\frac{m}{q B_0 R_0} \\left( v_\\parallel^2 + \\frac{v_\\perp^2}{2} \\right)$, with $r = \\sqrt{x^2+y^2}$.\n2.  Energy conservation diagnostic: Always True, as $P=0$.\n3.  Adiabaticity diagnostic: True if $\\frac{m v_\\perp}{|q| B_0 R_0} < \\tau_\\mu$, False otherwise.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes guiding-center drift properties for specified test cases.\n\n    This function implements the derived formulas for a charged particle's\n    drift velocity in an axisymmetric E-cross-B configuration. It processes\n    a fixed set of test cases, calculating the total vertical drift velocity\n    and two physics-based diagnostics for each.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement.\n    B0 = 5.0  # Reference magnetic field in Tesla\n    R0 = 1.0  # Reference length in meters\n    E0 = 100.0  # Electric field magnitude in V/m\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    m_p = 1.67262192369e-27  # Proton mass in kg\n    m_e = 9.1093837015e-31  # Electron mass in kg\n    \n    # Define numerical tolerances.\n    tau_P = 1.0e-25  # Power tolerance in J/s\n    tau_mu = 1.0e-3  # Adiabaticity parameter tolerance (dimensionless)\n\n    # Define the test cases (m, q, x, y, v_parallel, v_perp).\n    test_cases = [\n        # Case A: Happy path, moderate speeds, proton\n        (m_p, +e, 1.0, 0.0, 1.0e5, 2.0e4),\n        # Case B: Strong field region, small radius, proton\n        (m_p, +e, 0.2, 0.0, 5.0e4, 2.0e4),\n        # Case C: Charge sign reversal, electron\n        (m_e, -e, 1.5, 0.0, 2.0e6, 1.0e5),\n        # Case D: Adiabaticity edge, large v_perp, proton\n        (m_p, +e, 2.0, 0.0, 1.0e5, 5.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m, q, x, y, v_parallel, v_perp = case\n        \n        # Calculate cylindrical radius r = sqrt(x^2 + y^2)\n        r = np.sqrt(x**2 + y**2)\n        \n        # 1. Compute the total drift velocity component along e_z.\n        # This is the sum of E×B, grad-B, and curvature drifts.\n        # v_z = (E0*r / (B0*R0)) + (m/(q*B0*R0)) * (v_parallel^2 + 0.5*v_perp^2)\n        \n        # E-cross-B drift component in z\n        v_e_z = (E0 * r) / (B0 * R0)\n        \n        # Grad-B and Curvature drift components in z\n        # Note: The factor 1/(B0*R0) is common.\n        v_grad_curv_z = (m / (q * B0 * R0)) * (v_parallel**2 + 0.5 * v_perp**2)\n        \n        v_z_total = v_e_z + v_grad_curv_z\n        results.append(v_z_total)\n        \n        # 2. Compute the energy conservation diagnostic.\n        # P = q * E . v_GC. As derived, E . v_GC = 0 for the given fields.\n        # So, P is analytically zero.\n        power_input = 0.0\n        energy_ok = abs(power_input) < tau_P\n        results.append(energy_ok)\n        \n        # 3. Compute the magnetic moment adiabaticity diagnostic.\n        # Epsilon = rho_L / L, with L=r. This simplifies to m*v_perp / (|q|*B0*R0).\n        epsilon = (m * v_perp) / (abs(q) * B0 * R0)\n        mu_ok = epsilon < tau_mu\n        results.append(mu_ok)\n\n    # Format the final output as a single-line string.\n    # Booleans must be lower-case 'true' or 'false' for direct printing.\n    def format_item(item):\n        if isinstance(item, bool):\n            return str(item).lower()\n        return str(item)\n\n    print(f\"[{','.join(map(format_item, results))}]\")\n\nsolve()\n```"
        }
    ]
}