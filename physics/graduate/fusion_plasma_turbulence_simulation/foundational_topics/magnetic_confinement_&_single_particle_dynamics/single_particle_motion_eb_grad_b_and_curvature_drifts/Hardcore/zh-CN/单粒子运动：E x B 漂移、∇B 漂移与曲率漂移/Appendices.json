{
    "hands_on_practices": [
        {
            "introduction": "在非均匀磁场中的粒子运动是等离子体约束的基础。本练习将探讨“磁镜”效应，这一效应源于能量守恒和磁矩 $\\mu$ 的绝热守恒性。通过推导平行速度的变化，您将理解粒子如何被磁场捕获，以及这种平行运动如何直接与曲率漂移耦合——这是聚变装置中粒子输运的一个关键机制 。",
            "id": "4200941",
            "problem": "考虑一个质量为 $m$、电荷为 $q$ 的带电粒子，在一个与时间无关的非均匀磁场 $\\mathbf{B}(\\mathbf{x})$ 中运动，其单位矢量为 $\\hat{\\mathbf{b}} \\equiv \\mathbf{B}/B$，场向坐标 $s$ 定义为 $\\mathrm{d}\\mathbf{x}/\\mathrm{d}s = \\hat{\\mathbf{b}}$。假设引导中心级数关系 $\\rho_{\\mathrm{L}}/L_{B} \\ll 1$，其中 $\\rho_{\\mathrm{L}}$ 是拉莫尔半径，$L_{B}$ 是磁场变化的特征尺度长度，因此可以对回旋运动进行平均，并且磁矩 $\\mu \\equiv m v_{\\perp}^{2}/(2B)$ 在主导阶上是一个绝热不变量。没有电场，$\\mathbf{E} = \\mathbf{0}$，因此任何电场叉磁场（E$\\times$B）漂移都不存在。粒子速度分解为 $\\mathbf{v} = v_{\\parallel}\\,\\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}$。从带有洛伦兹力的牛顿第二定律 $m\\,\\mathrm{d}\\mathbf{v}/\\mathrm{d}t = q\\,\\mathbf{v}\\times\\mathbf{B}$ 出发，并使用引导中心近似，推导在沿磁力线方向存在磁场强度变化时的有效平行动力学。特别地，关注磁镜力 $-\\mu\\,\\hat{\\mathbf{b}}\\cdot\\nabla B$，并计算当粒子从参考位置 $s_{0}$ 移动到位置 $s$ 时平行速度 $v_{\\parallel}$ 的变化，其中 $B_{0} \\equiv B(s_{0})$ 且 $v_{\\parallel 0} \\equiv v_{\\parallel}(s_{0})$。将您的最终结果表示为关于 $v_{\\parallel 0}$、$\\mu$、$m$、$B(s)$ 和 $B_{0}$ 的 $v_{\\parallel}(s)$ 的单一闭式解析表达式。然后，讨论由磁镜力驱动的 $v_{\\parallel}$ 的演化如何与由磁力线曲率引起的曲率漂移耦合，而不改变绝热不变量 $\\mu$。您的最终答案必须仅为所要求的 $v_{\\parallel}(s)$ 的解析表达式；不要在最终的方框答案中包含任何单位。不需要进行数值计算或四舍五入。",
            "solution": "该问题被评估为具有科学依据、提法恰当且客观。这是经典力学和等离子体物理学中的一个标准问题，具体涉及带电粒子运动的引导中心近似。所有提供的信息都是一致的，并且足以得到唯一解。因此，该问题被认为是有效的。\n\n质量为 $m$、电荷为 $q$ 的带电粒子在磁场 $\\mathbf{B}$ 中的运动由洛伦兹力决定，如牛顿第二定律所述：\n$$m \\frac{\\mathrm{d}\\mathbf{v}}{\\mathrm{d}t} = q \\mathbf{v} \\times \\mathbf{B}$$\n磁力对粒子做的功为零，因为该力始终垂直于速度：$\\mathbf{F} \\cdot \\mathbf{v} = (q \\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{v} = 0$。鉴于电场 $\\mathbf{E}$ 为零，没有其他力对粒子做功。因此，粒子的动能 $K$ 是一个运动常数：\n$$\\frac{\\mathrm{d}K}{\\mathrm{d}t} = 0 \\implies K = \\text{constant}$$\n粒子的速度矢量 $\\mathbf{v}$ 可以分解为平行于和垂直于磁场单位矢量 $\\hat{\\mathbf{b}} = \\mathbf{B}/B$ 的分量：$\\mathbf{v} = v_{\\parallel} \\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}$。总动能可以用这些分量来表示。由于 $\\hat{\\mathbf{b}}$ 和 $\\mathbf{v}_{\\perp}$ 是正交的，速度大小的平方为 $v^2 = \\mathbf{v} \\cdot \\mathbf{v} = v_{\\parallel}^2 + v_{\\perp}^2$。守恒的动能是：\n$$K = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2)$$\n问题陈述，在引导中心近似下，磁矩 $\\mu$ 是一个绝热不变量。其定义为：\n$$\\mu \\equiv \\frac{m v_{\\perp}^2}{2B}$$\n由于 $\\mu$ 在主导阶上是常数，我们可以用 $\\mu$ 和局部磁场强度 $B$ 来表示动能的垂直分量：\n$$\\frac{1}{2}m v_{\\perp}^2 = \\mu B$$\n将此代入总动能的表达式，我们得到：\n$$K = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B$$\n因为 $K$ 是一个运动常数，所以量 $\\frac{1}{2}m v_{\\parallel}^2 + \\mu B$ 在粒子引导中心轨迹上的所有点都必须具有相同的值。让我们在一个参考位置 $s_0$ 和一个任意位置 $s$ 处计算这个守恒量。在 $s_0$ 处，磁场强度为 $B_0 \\equiv B(s_0)$，平行速度为 $v_{\\parallel 0} \\equiv v_{\\parallel}(s_0)$。在位置 $s$ 处，场强为 $B(s)$，平行速度为 $v_{\\parallel}(s)$。令这两点处的守恒能量相等，可得：\n$$\\frac{1}{2}m v_{\\parallel}(s)^2 + \\mu B(s) = \\frac{1}{2}m v_{\\parallel 0}^2 + \\mu B_0$$\n这个方程描述了粒子的平行动能和一个类势能项 $\\mu B$ 之间的交换。负责这种交换的力是磁镜力，$F_{\\parallel} = -\\nabla_{\\parallel}(\\mu B) = -\\mu \\partial B / \\partial s$。\n\n为了找到 $v_{\\parallel}(s)$ 的表达式，我们重新整理守恒方程以求解 $v_{\\parallel}(s)^2$：\n$$\\frac{1}{2}m v_{\\parallel}(s)^2 = \\frac{1}{2}m v_{\\parallel 0}^2 + \\mu B_0 - \\mu B(s)$$\n$$v_{\\parallel}(s)^2 = v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))$$\n对两边取平方根，得到位置 $s$ 处平行速度的最终表达式：\n$$v_{\\parallel}(s) = \\pm \\sqrt{v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))}$$\n$\\pm$ 号表示粒子可以沿磁力线向任一方向运动。如果粒子移动到一个 $B(s)$ 足够大的区域，使得平方根内的项变为零，则粒子的平行运动停止并被反射，其平行速度的符号反转。这就是磁镜的原理。\n\n关于由磁镜力驱动的 $v_{\\parallel}$ 演化与曲率漂移之间的耦合，我们首先回顾曲率漂移速度 $\\mathbf{v}_c$ 的表达式。这种漂移的产生是因为，在均匀场图像中，粒子沿弯曲磁力线运动时所受的离心力并未被洛伦兹力完全平衡。漂移速度由下式给出：\n$$\\mathbf{v}_c = \\frac{m v_{\\parallel}^2}{q B^2} \\mathbf{B} \\times (\\hat{\\mathbf{b}} \\cdot \\nabla \\hat{\\mathbf{b}})$$\n项 $\\hat{\\mathbf{b}} \\cdot \\nabla \\hat{\\mathbf{b}}$ 代表磁力线的曲率矢量。对于目前的讨论，关键在于曲率漂移的大小 $|\\mathbf{v}_c|$ 与平行速度的平方 $v_{\\parallel}^2$ 成正比。\n我们推导的第一部分表明，$v_{\\parallel}$ 通常不是恒定的。其值根据以下关系变化：\n$$v_{\\parallel}^2(s) = v_{\\parallel 0}^2 + \\frac{2\\mu}{m}(B_0 - B(s))$$\n这建立了一个直接的耦合关系。当粒子的引导中心沿着磁力线移动时，它会经历磁场强度 $B(s)$ 的变化。磁镜力作用于粒子，将平行动能转化为垂直动能（反之亦然），从而改变 $v_{\\parallel}(s)$。这个 $v_{\\parallel}(s)$ 的变化继而直接调节曲率漂移 $\\mathbf{v}_c$ 的大小。例如，如果一个粒子进入一个更强的磁场区域（一个磁镜），$v_{\\parallel}$ 会减小，这反过来又会降低曲率漂移的速度。相反，移动到较弱的磁场区域会增加 $v_{\\parallel}$ 并增强曲率漂移。整个过程发生时，磁矩 $\\mu$ 和总能量 $K$ 保持守恒。这种平行运动和垂直漂移之间的耦合是用于磁约束聚变的复杂磁几何结构中粒子动力学的一个基本方面。",
            "answer": "$$\\boxed{\\pm \\sqrt{v_{\\parallel 0}^{2} + \\frac{2\\mu}{m}(B_{0} - B(s))}}$$"
        },
        {
            "introduction": "除了空间不均匀性，时变电场在等离子体中也无处不在，并驱动着重要的漂移运动。本练习将引导您推导极化漂移，这是一种由粒子惯性 $m$ 在响应变化的电场时直接产生的运动。这个推导过程展示了时间尺度分离方法在等离子体理论中的威力，并量化了极化漂移相对于主导的 $\\mathbf{E}\\times\\mathbf{B}$ 漂移的标度关系，这对于理解低频等离子体波和湍流至关重要 。",
            "id": "4200957",
            "problem": "一个电荷为$q$、质量为$m$的非相对论带电粒子在均匀静磁场$\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$中运动。垂直电场在空间上是均匀的，严格垂直于$\\mathbf{B}$，并随时间谐振变化，其形式为$\\mathbf{E}_{\\perp}(t) = \\Re\\{\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\}$，其中$\\mathbf{E}_{0}\\cdot\\hat{\\mathbf{z}}=0$且$\\omega>0$。从洛伦兹方程$m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right)$出发，在频率与回旋频率相比渐进小（$\\omega/\\Omega \\ll 1$）的情况下进行分析，其中回旋频率定义为$\\Omega \\equiv |q|B/m$。利用快速回旋运动和慢速漂移之间的系统性时间尺度分离方法，推导响应于$\\mathbf{E}_{\\perp}(t)$时间依赖性的、对垂直导心速度的主导阶慢漂移贡献，记为$\\mathbf{v}_{p}(t)$。然后，将其大小与瞬时E×B漂移$\\mathbf{v}_{E}(t) \\equiv \\mathbf{E}_{\\perp}(t)\\times \\mathbf{B}/B^{2}$的大小进行比较，并确定在$\\omega/\\Omega \\ll 1$的极限下它们大小的比值。\n\n用$\\omega$和$\\Omega$表示比值$\\left|\\mathbf{v}_{p}\\right|/\\left|\\mathbf{v}_{E}\\right|$，并以闭合形式的符号表达式给出最终答案。不需要进行数值计算，由于最终比值为无量纲，因此也不需要单位。",
            "solution": "本问题要求在低频极限$\\omega/\\Omega \\ll 1$下，推导在均匀磁场和时变垂直电场中带电粒子的极化漂移速度。然后，我们必须确定该漂移的大小与E×B漂移大小的比值。\n\n我们从电荷为$q$、质量为$m$的粒子的非相对论洛伦兹运动方程开始：\n$$\nm\\,\\frac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}\\right)\n$$\n给定的场是均匀静磁场$\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$和垂直的时谐电场$\\mathbf{E}(t) = \\mathbf{E}_{\\perp}(t) = \\Re\\{\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\}$，其中$\\mathbf{E}_{0}\\cdot\\hat{\\mathbf{z}}=0$。平行于$\\mathbf{B}$的运动是平凡的（$E_{\\parallel}=0 \\implies v_{\\parallel}=\\text{常数}$），因此我们专注于垂直速度分量$\\mathbf{v}_{\\perp}$。垂直运动的方程为：\n$$\nm\\,\\frac{d\\mathbf{v}_{\\perp}}{dt} = q\\left(\\mathbf{E}_{\\perp}(t) + \\mathbf{v}_{\\perp}\\times \\mathbf{B}\\right)\n$$\n该问题涉及两个不同的时间尺度：以回旋频率$\\Omega = |q|B/m$进行的快速回旋运动，以及以频率$\\omega$进行的电场慢速变化。条件$\\omega \\ll \\Omega$允许将速度系统地分离为一个缓慢漂移的导心速度$\\mathbf{v}_{GC}$和一个快速回旋的分量。总导心漂移是各种漂移之和。主导的漂移是E×B漂移，定义为：\n$$\n\\mathbf{v}_{E}(t) \\equiv \\frac{\\mathbf{E}_{\\perp}(t)\\times \\mathbf{B}}{B^{2}}\n$$\n我们寻求由$\\mathbf{E}_{\\perp}(t)$的时间依赖性引起的对该漂移的修正。这个修正就是极化漂移，$\\mathbf{v}_p(t)$。\n\n推导它的一种标准方法是将总垂直速度$\\mathbf{v}_{\\perp}$表示为一个迭代级数。通过将$\\mathbf{v}_{\\perp}$的运动方程与$\\mathbf{B}$做叉积，可以得到该方程的一个精确重排：\n$$\nm\\,\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) = q(\\mathbf{E}_{\\perp} \\times \\mathbf{B}) + q((\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\times \\mathbf{B})\n$$\n使用矢量三重积恒等式$\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a}\\cdot\\mathbf{c}) - \\mathbf{c}(\\mathbf{a}\\cdot\\mathbf{b})$并注意到$\\mathbf{v}_{\\perp} \\cdot \\mathbf{B} = 0$，最后一项变为：\n$$\n(\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\times \\mathbf{B} = \\mathbf{B}(\\mathbf{v}_{\\perp}\\cdot\\mathbf{B}) - \\mathbf{v}_{\\perp}(\\mathbf{B}\\cdot\\mathbf{B}) = -B^2 \\mathbf{v}_{\\perp}\n$$\n将其代回，我们得到：\n$$\nm\\,\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) = q(\\mathbf{E}_{\\perp} \\times \\mathbf{B}) - qB^2 \\mathbf{v}_{\\perp}\n$$\n解出$\\mathbf{v}_{\\perp}$可得精确表达式：\n$$\n\\mathbf{v}_{\\perp} = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right)\n$$\n第一项是瞬时E×B漂移，$\\mathbf{v}_{E}$。第二项包含所有其他运动，包括回旋运动和任何附加的漂移。导心速度$\\mathbf{v}_{GC}$是$\\mathbf{v}_{\\perp}$在一个快速回旋周期上的时间平均，这会滤掉回旋运动。\n$$\n\\mathbf{v}_{GC} = \\langle\\mathbf{v}_{\\perp}\\rangle = \\langle\\mathbf{v}_{E}\\rangle - \\left\\langle \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\right\\rangle\n$$\n由于$\\mathbf{v}_E$和$\\mathbf{B}$仅在慢时间尺度上变化，它们在一个回旋轨道上可认为是常数，因此$\\langle\\mathbf{v}_{E}\\rangle=\\mathbf{v}_{E}$。总速度导数的平均值约等于平均速度的导数，即$\\langle d\\mathbf{v}_{\\perp}/dt \\rangle \\approx d\\langle\\mathbf{v}_{\\perp}\\rangle/dt = d\\mathbf{v}_{GC}/dt$。因此：\n$$\n\\mathbf{v}_{GC} \\approx \\mathbf{v}_{E} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{GC}}{dt} \\times \\mathbf{B}\\right)\n$$\n这是一个关于导心速度$\\mathbf{v}_{GC}$的方程。我们可以基于修正项很小这一点对其进行迭代求解。时间导数引入一个因子$\\omega$，而叉积中隐含的回旋运动涉及$\\Omega$。因此，与主速度相比，修正项的量级为$\\omega/\\Omega \\ll 1$。\n\n在主导阶上，导心速度就是E×B漂移：\n$$\n\\mathbf{v}_{GC}^{(0)} = \\mathbf{v}_{E}(t)\n$$\n为了求得一阶修正，我们将此近似代回到$\\mathbf{v}_{GC}$方程的导数项中：\n$$\n\\mathbf{v}_{GC}^{(1)} = \\mathbf{v}_{E} - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{E}}{dt} \\times \\mathbf{B}\\right)\n$$\n极化漂移$\\mathbf{v}_{p}$定义为这个一阶修正项：\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^2}\\left(\\frac{d\\mathbf{v}_{E}}{dt} \\times \\mathbf{B}\\right)\n$$\n我们现在代入$\\mathbf{v}_{E}(t)$的定义：\n$$\n\\frac{d\\mathbf{v}_{E}}{dt} = \\frac{d}{dt}\\left(\\frac{\\mathbf{E}_{\\perp}(t) \\times \\mathbf{B}}{B^2}\\right) = \\frac{1}{B^2}\\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right)\n$$\n因为$\\mathbf{B}$和$B^2$是常数。$\\mathbf{v}_{p}$的表达式变为：\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^2}\\left[ \\frac{1}{B^2}\\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\times \\mathbf{B} \\right] = - \\frac{m}{qB^4}\\left[ \\left(\\frac{d\\mathbf{E}_{\\perp}}{dt} \\times \\mathbf{B}\\right) \\times \\mathbf{B} \\right]\n$$\n使用与前面相同的矢量恒等式，并注意到$d\\mathbf{E}_{\\perp}/dt$垂直于$\\mathbf{B}$，我们有$(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{B} = -B^2\\mathbf{A}$，其中$\\mathbf{A} = d\\mathbf{E}_{\\perp}/dt$。\n$$\n\\mathbf{v}_{p} = - \\frac{m}{qB^4} \\left[ -B^2 \\frac{d\\mathbf{E}_{\\perp}}{dt} \\right] = \\frac{m}{qB^2} \\frac{d\\mathbf{E}_{\\perp}}{dt}\n$$\n这就是极化漂移速度的表达式。\n\n接下来，我们比较$\\mathbf{v}_{p}(t)$和$\\mathbf{v}_{E}(t)$的大小。对于谐振变化的量，最有意义的比较是比较它们的振幅。为简单起见，我们使用复数表示法，其中物理量是其实部。\n设$\\tilde{\\mathbf{E}}_{\\perp}(t) = \\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)$。相应复速度的振幅将给出物理速度的振幅。\n复数E×B速度为：\n$$\n\\tilde{\\mathbf{v}}_{E}(t) = \\frac{\\tilde{\\mathbf{E}}_{\\perp}(t) \\times \\mathbf{B}}{B^2} = \\frac{\\mathbf{E}_{0} \\times \\mathbf{B}}{B^2} \\exp(-\\mathrm{i}\\,\\omega t)\n$$\n该速度的振幅，我们记为$|\\mathbf{v}_{E}|$，是其复矢量部分的模：\n$$\n|\\mathbf{v}_{E}| = \\left|\\frac{\\mathbf{E}_{0} \\times \\mathbf{B}}{B^2}\\right| = \\frac{|\\mathbf{E}_{0}| |\\mathbf{B}| \\sin(\\pi/2)}{B^2} = \\frac{|\\mathbf{E}_{0}|B}{B^2} = \\frac{|\\mathbf{E}_{0}|}{B}\n$$\n这里我们用到了$\\mathbf{E}_0$垂直于$\\mathbf{B}$。\n\n复数极化漂移速度为：\n$$\n\\tilde{\\mathbf{v}}_{p}(t) = \\frac{m}{qB^2} \\frac{d\\tilde{\\mathbf{E}}_{\\perp}}{dt} = \\frac{m}{qB^2} \\frac{d}{dt}\\left(\\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\\right) = \\frac{-\\mathrm{i}\\,\\omega m}{qB^2} \\mathbf{E}_{0}\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n该速度的振幅，记为$|\\mathbf{v}_{p}|$，是：\n$$\n|\\mathbf{v}_{p}| = \\left|\\frac{-\\mathrm{i}\\,\\omega m}{qB^2} \\mathbf{E}_{0}\\right| = \\frac{\\omega m}{|q|B^2} |\\mathbf{E}_{0}|\n$$\n现在，我们求这两个大小的比值：\n$$\n\\frac{|\\mathbf{v}_{p}|}{|\\mathbf{v}_{E}|} = \\frac{\\frac{\\omega m |\\mathbf{E}_{0}|}{|q|B^2}}{\\frac{|\\mathbf{E}_{0}|}{B}} = \\frac{\\omega m}{|q|B}\n$$\n使用回旋频率的定义$\\Omega = |q|B/m$，我们可以将分母重写为$|q|B = m\\Omega$。\n$$\n\\frac{|\\mathbf{v}_{p}|}{|\\mathbf{v}_{E}|} = \\frac{\\omega m}{m\\Omega} = \\frac{\\omega}{\\Omega}\n$$\n这证实了在指定的极限$\\omega/\\Omega \\ll 1$下，极化漂移是E×B漂移的一个小修正。它们大小的比值恰好是这个小参数。",
            "answer": "$$\n\\boxed{\\frac{\\omega}{\\Omega}}\n$$"
        },
        {
            "introduction": "将物理理论转化为精确的数值模拟是计算等离子体物理学的核心技能。这个问题挑战您在数值网格上实现磁场曲率矢量 $\\boldsymbol{\\kappa}$ 和由此产生的曲率漂移速度 $\\mathbf{v}_c$ 的计算。通过将您的数值结果与解析解进行比较，您将获得有限差分方法的实践经验，并对数值误差如何影响物理模拟的准确性建立批判性的理解 。",
            "id": "4200936",
            "problem": "您将执行一项计算任务，该任务源于磁化等离子体中单粒子运动的引导中心理论。从基本动力学出发，您需要在周期性网格上使用数值微分来计算磁力线曲率矢量，并量化曲率估计中的数值误差如何影响曲率漂移速度的准确性。此任务必须通过实现一个完整的、可运行的程序来解决，该程序需报告指定测试套件所要求的数值精度。\n\n使用的基本原理是 Newton–Lorentz 方程和引导中心分解。考虑一个质量为 $m$、电荷为 $q$ 的粒子，在磁场 $\\mathbf{B}(\\mathbf{x})$ 中运动，其单位方向为 $\\hat{\\mathbf{b}}(\\mathbf{x}) = \\mathbf{B}(\\mathbf{x}) / \\|\\mathbf{B}(\\mathbf{x})\\|$。磁力线的曲率由曲率矢量 $\\boldsymbol{\\kappa}(\\mathbf{x}) = (\\hat{\\mathbf{b}} \\cdot \\nabla) \\hat{\\mathbf{b}}$ 量化，其中 $(\\hat{\\mathbf{b}} \\cdot \\nabla)$ 是沿 $\\hat{\\mathbf{b}}$ 方向的方向导数。曲率漂移速度 $\\mathbf{v}_c$ 取决于由 $\\boldsymbol{\\kappa}$ 编码的几何形状和平行速度 $v_{\\parallel}$，并且应在您的解决方案中从第一性原理推导得出。\n\n您的程序必须在三维周期性网格上，使用二阶中心有限差分计算所有偏导数，从而数值计算 $\\boldsymbol{\\kappa}$，然后计算相应的曲率漂移速度 $\\mathbf{v}_c$。您必须通过将数值计算的 $\\mathbf{v}_c$ 与给定磁场配置下解析推导的 $\\mathbf{v}_c$进行比较来评估准确性。比较度量必须是整个网格上 $\\mathbf{v}_c$ 的均方根误差 (RMSE)，以米/秒 (m/s) 表示，其中三角函数的参数应解释为弧度。RMSE 必须计算为每个网格点上误差矢量场的欧几里得范数平方的平均值的平方根。\n\n通过在有限差分中进行环绕处理，在所有方向上实现周期性边界条件。使用国际单位制 (SI)：$m$ 以千克 (kg) 为单位，$q$ 以库仑 (C) 为单位，$\\mathbf{B}$ 以特斯拉 (T) 为单位，长度以米 (m) 为单位，速度以米/秒 (m/s) 为单位，波数以弧度/米 (rad/m) 为单位。任何三角函数的角度单位均为弧度。\n\n在以下所有情况中，均采用一个氘离子，其电荷 $q = 1.602176634\\times 10^{-19}$ C，质量 $m = 3.34358372\\times 10^{-27}$ kg，并具有恒定的平行速度 $v_{\\parallel} = 1.0\\times 10^{5}$ m/s。磁场大小满足 $\\|\\mathbf{B}\\| = B_0$，其中 $B_0 = 2.0$ T。所有网格在每个维度上都是均匀且周期性的。\n\n定义以下磁场配置和网格：\n\n- 情况 A（均匀场，零曲率）：$\\mathbf{B}(\\mathbf{x}) = B_0\\,\\hat{\\mathbf{z}}$，区域尺寸 $L_x = L_y = L_z = 1.0$ m，分辨率 $N_x = N_y = N_z = 64$。\n\n- 情况 B（在区域上单周期平面旋转，粗网格）：$\\hat{\\mathbf{b}}(x) = [-\\sin(k x), \\cos(k x), 0]$，其中在 $x \\in [0, 2.0]$ m 上 $k = \\pi$ rad/m，且 $y,z$ 为常数；设 $\\mathbf{B}(x) = B_0 \\hat{\\mathbf{b}}(x)$。区域尺寸 $L_x = 2.0$ m, $L_y = L_z = 1.0$ m，分辨率 $N_x = 33$, $N_y = N_z = 1$。\n\n- 情况 C（平面旋转，细网格）：与情况 B 相同，但 $N_x = 257$。\n\n- 情况 D（带恒定平面外分量的倾斜旋转，粗网格）：$\\hat{\\mathbf{b}}(x) = [\\cos(k x), \\sin(k x), \\delta]/\\sqrt{1+\\delta^2}$，其中 $k = \\pi$ rad/m, $\\delta = 0.2$（无量纲），$\\mathbf{B}(x) = B_0 \\hat{\\mathbf{b}}(x)$，区域尺寸 $L_x = 2.0$ m, $L_y = L_z = 1.0$ m，分辨率 $N_x = 33$, $N_y = N_z = 1$。\n\n- 情况 E（倾斜旋转，细网格）：与情况 D 相同，但 $N_x = 257$。\n\n对于每种情况，您的程序必须：\n- 构建网格以及相应的 $\\hat{\\mathbf{b}}$ 和 $\\mathbf{B}$ 场。\n- 使用带周期性环绕的二阶中心差分法数值计算 $\\boldsymbol{\\kappa}(\\mathbf{x})$。\n- 从第一性原理计算曲率漂移速度场 $\\mathbf{v}_c(\\mathbf{x})$。\n- 推导与配置对应的 $\\mathbf{v}_c(\\mathbf{x})$ 的解析参考解，并与数值结果进行比较。\n- 计算整个网格上 $\\mathbf{v}_c$ 的 RMSE，单位为 m/s。\n\n您的程序应生成单行输出，其中包含按顺序排列的情况 A–E 的 RMSE，格式为方括号内逗号分隔的列表，例如 `\"[e_A,e_B,e_C,e_D,e_E]\"`，其中每个 $e_\\bullet$ 是一个以 m/s 为单位的浮点数。不得打印任何其他文本。\n\n测试套件覆盖原理：\n- 情况 A 验证零曲率行为和基线数值微分的稳定性。\n- 情况 B 和 C 验证了对于单位大小场中的平面内曲率，误差随网格间距的缩放关系。\n- 情况 D 和 E 验证了当 $\\hat{\\mathbf{b}}$ 包含恒定的平面外分量时，$\\mathbf{v}_c$ 中的交叉分量耦合，以及误差随网格间距的缩放关系。\n\n所有物理量必须以 SI 单位处理，角度必须为弧度。输出的 RMSE 值必须是代表 m/s 的浮点数。",
            "solution": "此问题是有效的，因为它具有科学依据，定义明确且客观。它提出了一个标准的计算物理任务，该任务源于磁场中单粒子动力学的第一性原理。所有参数、方法和评估标准都得到了足够精确的规定，从而可以得出一个唯一且可验证的解。\n\n问题的核心是计算带电粒子在磁场中的曲率漂移速度 $\\mathbf{v}_c$。这需要推导 $\\mathbf{v}_c$ 的表达式，计算磁场曲率矢量 $\\boldsymbol{\\kappa}$，并实现一个数值方案来在离散网格上估算这些量。\n\n**1. 曲率漂移速度的推导**\n\n在磁场 $\\mathbf{B}$ 中，质量为 $m$、电荷为 $q$ 的粒子的运动由 Newton-Lorentz 方程决定：\n$$\nm \\frac{d\\mathbf{v}}{dt} = q (\\mathbf{v} \\times \\mathbf{B})\n$$\n在引导中心理论中，粒子的运动被分解为围绕磁力线的快速回旋运动和引导中心的较慢漂移。当磁力线弯曲时，会产生这样一种漂移。一个以平行速度 $v_{\\parallel}$ 沿弯曲磁力线运动的粒子会受到离心力。\n\n磁力线的曲率由矢量 $\\boldsymbol{\\kappa} = (\\hat{\\mathbf{b}} \\cdot \\nabla) \\hat{\\mathbf{b}}$ 描述，其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/\\|\\mathbf{B}\\|$ 是沿磁场方向的单位矢量。曲率的大小为 $\\|\\boldsymbol{\\kappa}\\| = 1/R_c$，其中 $R_c$ 是局部曲率半径，其方向指向曲率中心。\n\n粒子因沿弯曲磁力线运动而感受到的离心力 $\\mathbf{F}_{cf}$ 为：\n$$\n\\mathbf{F}_{cf} = m v_{\\parallel}^2 \\boldsymbol{\\kappa}\n$$\n这个力垂直于磁场（因为 $\\boldsymbol{\\kappa} \\cdot \\hat{\\mathbf{b}} = 0$），从而引起漂移速度。由力 $\\mathbf{F}$ 引起的漂移速度 $\\mathbf{v}_F$ 的通用表达式为：\n$$\n\\mathbf{v}_F = \\frac{\\mathbf{F} \\times \\mathbf{B}}{q B^2}\n$$\n其中 $B = \\|\\mathbf{B}\\|$。将 $\\mathbf{F}_{cf}$ 代入 $\\mathbf{F}$ 即可得到曲率漂移速度 $\\mathbf{v}_c$：\n$$\n\\mathbf{v}_c = \\frac{(m v_{\\parallel}^2 \\boldsymbol{\\kappa}) \\times \\mathbf{B}}{q B^2}\n$$\n使用 $\\mathbf{B} = B \\hat{\\mathbf{b}}$，可简化为：\n$$\n\\mathbf{v}_c = \\frac{m v_{\\parallel}^2}{q B^2} (\\boldsymbol{\\kappa} \\times (B \\hat{\\mathbf{b}})) = \\frac{m v_{\\parallel}^2}{q B} (\\boldsymbol{\\kappa} \\times \\hat{\\mathbf{b}})\n$$\n这就是将要使用的曲率漂移速度的最终表达式。问题指定了恒定的磁场大小 $B = B_0 = 2.0$ T、粒子电荷 $q$、质量 $m$ 和平行速度 $v_{\\parallel}$。\n\n**2. 数值方法**\n\n为了数值计算 $\\boldsymbol{\\kappa}$，我们必须计算方向导数 $(\\hat{\\mathbf{b}} \\cdot \\nabla) \\hat{\\mathbf{b}}$。这涉及到在离散网格上计算 $\\hat{\\mathbf{b}}$ 各分量的偏导数。问题指定了均匀周期性网格和二阶中心差分格式。对于网格间距为 $\\Delta x, \\Delta y, \\Delta z$ 的网格上的函数 $f(x, y, z)$，其偏导数近似为：\n$$\n\\frac{\\partial f}{\\partial x}\\bigg|_{i,j,k} \\approx \\frac{f_{i+1,j,k} - f_{i-1,j,k}}{2 \\Delta x}\n$$\n$\\partial/\\partial y$ 和 $\\partial/\\partial z$ 也类似。周期性边界条件通过环绕网格索引来处理，例如 $f_{N_x,j,k} = f_{0,j,k}$ 和 $f_{-1,j,k} = f_{N_x-1,j,k}$。\n\n然后，数值曲率矢量 $\\boldsymbol{\\kappa}_{\\text{num}}$ 按分量组合而成：\n$$\n\\kappa_{x, \\text{num}} = b_x \\frac{\\partial b_x}{\\partial x} + b_y \\frac{\\partial b_x}{\\partial y} + b_z \\frac{\\partial b_x}{\\partial z}\n$$\n$$\n\\kappa_{y, \\text{num}} = b_x \\frac{\\partial b_y}{\\partial x} + b_y \\frac{\\partial b_y}{\\partial y} + b_z \\frac{\\partial b_y}{\\partial z}\n$$\n$$\n\\kappa_{z, \\text{num}} = b_x \\frac{\\partial b_z}{\\partial x} + b_y \\frac{\\partial b_z}{\\partial y} + b_z \\frac{\\partial b_z}{\\partial z}\n$$\n其中所有偏导数都是数值估计值。根据 $\\boldsymbol{\\kappa}_{\\text{num}}$，使用推导出的公式计算数值漂移速度 $\\mathbf{v}_{c, \\text{num}}$。\n\n**3. 解析参考解**\n\n为了评估准确性，我们为每种情况推导解析的曲率和漂移速度。\n\n- **情况 A（均匀场）：** $\\hat{\\mathbf{b}} = [0, 0, 1]$。由于 $\\hat{\\mathbf{b}}$ 是常数，其所有偏导数均为零。\n$$\n\\boldsymbol{\\kappa}_{\\text{analytic}} = \\mathbf{0} \\implies \\mathbf{v}_{c, \\text{analytic}} = \\mathbf{0}\n$$\n\n- **情况 B/C（平面旋转）：** $\\hat{\\mathbf{b}}(x) = [-\\sin(kx), \\cos(kx), 0]$。场仅依赖于 $x$。\n$$\n\\boldsymbol{\\kappa} = (\\hat{\\mathbf{b}} \\cdot \\nabla) \\hat{\\mathbf{b}} = b_x \\frac{\\partial \\hat{\\mathbf{b}}}{\\partial x} = -\\sin(kx) \\frac{d}{dx}[-\\sin(kx), \\cos(kx), 0] = [k\\sin(kx)\\cos(kx), k\\sin^2(kx), 0]\n$$\n漂移速度则为：\n$$\n\\mathbf{v}_{c, \\text{analytic}} = \\frac{m v_{\\parallel}^2}{q B_0} (\\boldsymbol{\\kappa} \\times \\hat{\\mathbf{b}}) = \\frac{m v_{\\parallel}^2}{q B_0} \\left( [k\\sin(kx)\\cos(kx), k\\sin^2(kx), 0] \\times [-\\sin(kx), \\cos(kx), 0] \\right)\n$$\n叉积的计算结果为 $k\\sin(kx)\\hat{\\mathbf{z}}$。因此，\n$$\n\\mathbf{v}_{c, \\text{analytic}}(x) = \\frac{m v_{\\parallel}^2 k}{q B_0} \\sin(kx) \\hat{\\mathbf{z}}\n$$\n\n- **情况 D/E（倾斜旋转）：** $\\hat{\\mathbf{b}}(x) = \\frac{1}{\\sqrt{1+\\delta^2}} [\\cos(kx), \\sin(kx), \\delta]$。同样，场仅随 $x$ 变化。\n$$\n\\boldsymbol{\\kappa} = b_x \\frac{\\partial \\hat{\\mathbf{b}}}{\\partial x} = \\frac{\\cos(kx)}{\\sqrt{1+\\delta^2}} \\frac{d}{dx} \\left( \\frac{1}{\\sqrt{1+\\delta^2}}[\\cos(kx), \\sin(kx), \\delta] \\right) = \\frac{k}{1+\\delta^2} [-\\sin(kx)\\cos(kx), \\cos^2(kx), 0]\n$$\n漂移速度为：\n$$\n\\mathbf{v}_{c, \\text{analytic}} = \\frac{m v_{\\parallel}^2}{q B_0} (\\boldsymbol{\\kappa} \\times \\hat{\\mathbf{b}}) = \\frac{m v_{\\parallel}^2}{q B_0} \\left( \\frac{k}{1+\\delta^2} [-\\sin(kx)\\cos(kx), \\cos^2(kx), 0] \\times \\frac{1}{\\sqrt{1+\\delta^2}} [\\cos(kx), \\sin(kx), \\delta] \\right)\n$$\n计算叉积可得：\n$$\n\\mathbf{v}_{c, \\text{analytic}}(x) = \\frac{m v_{\\parallel}^2 k}{q B_0 (1+\\delta^2)^{3/2}} [\\delta\\cos^2(kx), \\delta\\sin(kx)\\cos(kx), -\\cos(kx)]\n$$\n\n**4. 误差评估**\n\n数值解的准确性通过数值漂移速度场 $\\mathbf{v}_{c, \\text{num}}(\\mathbf{x})$ 和解析漂移速度场 $\\mathbf{v}_{c, \\text{analytic}}(\\mathbf{x})$ 之间的均方根误差 (RMSE) 来量化。每个网格点上的误差矢量为 $\\mathbf{e}(\\mathbf{x}) = \\mathbf{v}_{c, \\text{num}}(\\mathbf{x}) - \\mathbf{v}_{c, \\text{analytic}}(\\mathbf{x})$。RMSE 计算如下：\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\|\\mathbf{e}(\\mathbf{x}_i)\\|^2}\n$$\n其中，求和遍历网格中所有 $N = N_x N_y N_z$ 个点，$\\|\\cdot\\|$ 是欧几里得范数。\n\n程序将为每个指定情况实现此逻辑，并报告最终的 RMSE 值列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the curvature drift velocity and its numerical error for several\n    magnetic field configurations, as specified in the problem statement.\n    \"\"\"\n    # Physical constants (SI units)\n    Q = 1.602176634e-19  # Deuterium charge (C)\n    M = 3.34358372e-27   # Deuterium mass (kg)\n    V_PAR = 1.0e5        # Parallel speed (m/s)\n    B0 = 2.0             # Magnetic field strength (T)\n\n    # Test case configurations\n    test_cases = [\n        # Case A: Uniform field, zero curvature\n        {'name': 'A', 'Lx': 1.0, 'Ly': 1.0, 'Lz': 1.0, 'Nx': 64, 'Ny': 64, 'Nz': 64, 'k': 0.0, 'delta': 0.0},\n        # Case B: Planar rotation, coarse grid\n        {'name': 'B', 'Lx': 2.0, 'Ly': 1.0, 'Lz': 1.0, 'Nx': 33, 'Ny': 1, 'Nz': 1, 'k': np.pi, 'delta': 0.0},\n        # Case C: Planar rotation, fine grid\n        {'name': 'C', 'Lx': 2.0, 'Ly': 1.0, 'Lz': 1.0, 'Nx': 257, 'Ny': 1, 'Nz': 1, 'k': np.pi, 'delta': 0.0},\n        # Case D: Tilted rotation, coarse grid\n        {'name': 'D', 'Lx': 2.0, 'Ly': 1.0, 'Lz': 1.0, 'Nx': 33, 'Ny': 1, 'Nz': 1, 'k': np.pi, 'delta': 0.2},\n        # Case E: Tilted rotation, fine grid\n        {'name': 'E', 'Lx': 2.0, 'Ly': 1.0, 'Lz': 1.0, 'Nx': 257, 'Ny': 1, 'Nz': 1, 'k': np.pi, 'delta': 0.2},\n    ]\n\n    rmse_results = []\n\n    for case in test_cases:\n        # 1. Grid and Field Setup\n        Nx, Ny, Nz = case['Nx'], case['Ny'], case['Nz']\n        Lx, Ly, Lz = case['Lx'], case['Ly'], case['Lz']\n        k, delta = case['k'], case['delta']\n\n        # Construct periodic grid coordinates [0, L)\n        x_coords = np.linspace(0, Lx, Nx, endpoint=False)\n        y_coords = np.linspace(0, Ly, Ny, endpoint=False)\n        z_coords = np.linspace(0, Lz, Nz, endpoint=False)\n        xx, yy, zz = np.meshgrid(x_coords, y_coords, z_coords, indexing='ij')\n\n        dx, dy, dz = Lx / Nx, Ly / Ny, Lz / Nz\n\n        # Initialize field arrays\n        b_hat = np.zeros((Nx, Ny, Nz, 3))\n        vc_analytic = np.zeros((Nx, Ny, Nz, 3))\n\n        # Define analytical fields for the case\n        name = case['name']\n        if name == 'A':\n            b_hat[..., 2] = 1.0\n            # vc_analytic is already all zeros\n        elif name in ['B', 'C']:\n            kx = k * xx\n            b_hat[..., 0] = -np.sin(kx)\n            b_hat[..., 1] = np.cos(kx)\n            \n            vc_factor = (M * V_PAR**2 * k) / (Q * B0)\n            vc_analytic[..., 2] = vc_factor * np.sin(kx)\n        elif name in ['D', 'E']:\n            norm = np.sqrt(1 + delta**2)\n            kx = k * xx\n            cos_kx = np.cos(kx)\n            sin_kx = np.sin(kx)\n            \n            b_hat[..., 0] = cos_kx / norm\n            b_hat[..., 1] = sin_kx / norm\n            b_hat[..., 2] = delta / norm\n            \n            vc_factor = (M * V_PAR**2 * k) / (Q * B0 * (1 + delta**2)**1.5)\n            vc_analytic[..., 0] = vc_factor * delta * cos_kx**2\n            vc_analytic[..., 1] = vc_factor * delta * sin_kx * cos_kx\n            vc_analytic[..., 2] = -vc_factor * cos_kx\n\n        # 2. Numerical Computation of Curvature Vector (kappa)\n        bx, by, bz = b_hat[..., 0], b_hat[..., 1], b_hat[..., 2]\n        \n        # Helper function for central difference to handle N=1 cases cleanly\n        def central_diff(field, axis, step):\n            if field.shape[axis] > 1:\n                return (np.roll(field, -1, axis=axis) - np.roll(field, 1, axis=axis)) / (2 * step)\n            return np.zeros_like(field)\n\n        # Partial derivatives of b_hat components\n        dbx_dx, dbx_dy, dbx_dz = central_diff(bx, 0, dx), central_diff(bx, 1, dy), central_diff(bx, 2, dz)\n        dby_dx, dby_dy, dby_dz = central_diff(by, 0, dx), central_diff(by, 1, dy), central_diff(by, 2, dz)\n        dbz_dx, dbz_dy, dbz_dz = central_diff(bz, 0, dx), central_diff(bz, 1, dy), central_diff(bz, 2, dz)\n\n        # Assemble kappa = (b_hat . grad) b_hat\n        kappa_num = np.zeros_like(b_hat)\n        kappa_num[..., 0] = bx * dbx_dx + by * dbx_dy + bz * dbx_dz\n        kappa_num[..., 1] = bx * dby_dx + by * dby_dy + bz * dby_dz\n        kappa_num[..., 2] = bx * dbz_dx + by * dbz_dy + bz * dbz_dz\n\n        # 3. Numerical Computation of Curvature Drift Velocity (vc)\n        vc_factor = (M * V_PAR**2) / (Q * B0)\n        vc_num = vc_factor * np.cross(kappa_num, b_hat, axisa=-1, axisb=-1, axisc=-1)\n        \n        # 4. RMSE Calculation\n        error_vector = vc_num - vc_analytic\n        squared_error = np.sum(np.square(error_vector), axis=-1)\n        rmse = np.sqrt(np.mean(squared_error))\n        rmse_results.append(rmse)\n\n    # Final output formatting\n    print(f\"[{','.join(f'{r:.12e}' for r in rmse_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}