{
    "hands_on_practices": [
        {
            "introduction": "安全因子 $q$ 是磁约束中的一个关键参数，它描述了磁力线的螺旋缠绕程度。本练习将使您熟悉有理面的概念，有理面出现在 $q$ 值取有理数值 $m/n$ 的半径处，是磁岛和不稳定性形成的关键位置。通过从一个给定的剖面模型计算一个特定有理面的位置，您将获得将抽象的磁拓扑结构与等离子体内部具体空间位置联系起来的实践经验。",
            "id": "4194764",
            "problem": "考虑一个大环径比的轴对称托卡马克，其具有圆形同心磁通面，小半径为 $a$，大半径为 $R_0$。安全因子 $q(r)$ 定义为磁力线环向缠绕与极向缠绕的匝数比，在大环径比极限下可写为 $q(r) \\approx \\frac{r B_{\\phi}(r)}{R_0 B_{\\theta}(r)}$，其中 $B_{\\phi}$ 和 $B_{\\theta}$ 分别是环向和极向磁场分量。有理面位于半径 $r$ 处，其中 $q(r) = \\frac{m}{n}$（$m$ 和 $n$ 为整数）。已知这些磁面对磁流体力学（MHD）模是共振的，并能在聚变等离子体湍流模拟中激发微观湍流活动。\n\n假设在该托卡马克中测得的平衡安全因子剖面可由以下二次形式很好地近似：\n$$\nq(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^{2},\n$$\n其中 $q_0 > 0$ 和 $\\alpha > 0$ 是无量纲常数。假设该剖面在 $r$ 上是单调的，并且与中心汇聚的电流密度在物理上相容，请确定 $q = \\frac{3}{2}$ 的有理面位置，并计算相应的半径 $r_{3/2}$。\n\n使用以下参数：$a = 0.75\\,\\mathrm{m}$，$q_0 = 0.95$，以及 $\\alpha = 0.80$。将 $r_{3/2}$ 的最终数值答案四舍五入至四位有效数字，并以米为单位表示。",
            "solution": "对问题陈述进行了严格评估，认定其有效。该问题以应用于托卡马克等离子体的磁流体力学（MHD）原理为科学基础，是一个具有完整且一致的给定条件的适定问题，并以客观、正式的语言表述。所提供的安全因子剖面模型是一个标准且物理上合理的近似。所有指定参数均具有实际值。因此，可以确定一个解。\n\n在大环径比的圆形托卡马克中，平衡安全因子剖面 $q(r)$ 由以下二次形式给出：\n$$\nq(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^{2}\n$$\n此处，$r$ 是小径向坐标，$a$ 是等离子体小半径，$q_0$ 是磁轴（$r=0$）处的安全因子，$\\alpha$ 是一个决定剖面形状的无量纲参数。\n\n我们的任务是找到安全因子为 $q=\\frac{3}{2}$ 的有理面位置。有理面由条件 $q(r) = m/n$ 定义，其中 $m$ 和 $n$ 为整数。在本例中，我们关心的是 $m=3, n=2$ 的磁面。设该磁面的半径为 $r_{3/2}$。我们可以通过令 $q(r_{3/2})$ 等于 $\\frac{3}{2}$ 来求得此半径：\n$$\nq(r_{3/2}) = q_0 + \\alpha \\left(\\frac{r_{3/2}}{a}\\right)^{2} = \\frac{3}{2}\n$$\n我们的目标是解出此方程中的 $r_{3/2}$。我们可以通过代数方法重新整理方程，以分离出包含 $r_{3/2}$ 的项：\n$$\n\\alpha \\left(\\frac{r_{3/2}}{a}\\right)^{2} = \\frac{3}{2} - q_0\n$$\n两边同除以 $\\alpha$ 得：\n$$\n\\left(\\frac{r_{3/2}}{a}\\right)^{2} = \\frac{\\frac{3}{2} - q_0}{\\alpha}\n$$\n为了解出 $r_{3/2}$，我们对等式两边取平方根。由于 $r_{3/2}$ 代表物理半径，它必须是一个非负值。因此，我们取正平方根：\n$$\n\\frac{r_{3/2}}{a} = \\sqrt{\\frac{\\frac{3}{2} - q_0}{\\alpha}}\n$$\n最后，乘以小半径 $a$ 即可得到有理面位置的符号表达式：\n$$\nr_{3/2} = a \\sqrt{\\frac{\\frac{3}{2} - q_0}{\\alpha}}\n$$\n题目提供了以下参数的数值：\n$a = 0.75\\,\\mathrm{m}$\n$q_0 = 0.95$\n$\\alpha = 0.80$\n\n我们可以将这些数值代入符号表达式中。注意 $\\frac{3}{2} = 1.5$。\n$$\nr_{3/2} = 0.75 \\sqrt{\\frac{1.5 - 0.95}{0.80}}\n$$\n首先，我们计算平方根内的分子：\n$$\n1.5 - 0.95 = 0.55\n$$\n接着，我们计算平方根内的分数值：\n$$\n\\frac{0.55}{0.80} = 0.6875\n$$\n$r_{3/2}$ 的表达式变为：\n$$\nr_{3/2} = 0.75 \\sqrt{0.6875}\n$$\n计算平方根：\n$$\n\\sqrt{0.6875} \\approx 0.82915619758\n$$\n现在，我们乘以小半径 $a$：\n$$\nr_{3/2} \\approx 0.75 \\times 0.82915619758 \\approx 0.62186714818\\,\\mathrm{m}\n$$\n题目要求将最终答案四舍五入至四位有效数字。\n$$\nr_{3/2} \\approx 0.6219\\,\\mathrm{m}\n$$\n这个值具有物理意义，因为它位于等离子体小半径之内，即 $0 < r_{3/2} < a$ ($0.6219\\,\\mathrm{m} < 0.75\\,\\mathrm{m}$)。这与目标值 $q = 1.5$ 位于轴上值 $q(0) = q_0 = 0.95$ 和边界值 $q(a) = q_0 + \\alpha = 0.95 + 0.80 = 1.75$ 之间的情况相符。",
            "answer": "$$\n\\boxed{0.6219}\n$$"
        },
        {
            "introduction": "离子温度梯度（ITG）模是驱动聚变等离子体中显著热量损失的主要微观湍流形式。本实践应用了强大的“气球模”（ballooning）变换方法，该方法将三维的模式结构简化为沿单根磁力线的一维本征值问题，类似于薛定谔方程。通过对包括托卡马克和仿星器情景在内的不同磁位形数值求解该方程，您将直接洞察磁剪切和曲率等几何特性如何控制等离子体的稳定性。",
            "id": "4194738",
            "problem": "考虑磁约束等离子体（适用于托卡马克和仿星器磁几何）中静电离子温度梯度（ITG）模的简化线性气球模表示。沿着单根磁场线，涨落包络振幅 $ \\phi(\\theta) $ 满足以下形式的本征值问题：\n$$\n\\mathcal{H} \\, \\phi(\\theta) = \\mu \\, \\phi(\\theta),\n$$\n其中自伴算子为\n$$\n\\mathcal{H} = -\\frac{d^2}{d\\theta^2} + U(\\theta),\n$$\n这里 $ \\theta $ 是沿场线测量的气球模角（以弧度为单位），$ U(\\theta) $ 是一个有效势，其中包含了垂直波数和曲率驱动的信息。该有效势由以下模型描述：\n$$\nU(\\theta) = k_y^2 \\left[ 1 + \\left( s_{\\mathrm{eff}}(\\theta)\\, \\theta - \\alpha \\sin\\theta \\right)^2 \\right] - \\omega_D(\\theta),\n$$\n其中 $ k_y $ 是归一化到特征回旋半径的副法向波数，$ \\alpha $ 是压力梯度气球模参数，$ s_{\\mathrm{eff}}(\\theta) $ 是包含局域磁剪切反转贡献的有效磁剪切。曲率漂移驱动为\n$$\n\\omega_D(\\theta) = A_{\\mathrm{curv}} \\cos\\theta + A_{\\mathrm{hel}} \\cos(N_{\\mathrm{hel}} \\theta),\n$$\n其中 $ A_{\\mathrm{curv}} $ 是轴对称曲率振幅，$ A_{\\mathrm{hel}} $ 是代表三维仿星器效应的螺旋曲率振幅，其模数为 $ N_{\\mathrm{hel}} $。有效磁剪切定义为\n$$\ns_{\\mathrm{eff}}(\\theta) = \\hat{s} + s_{\\mathrm{rev}} \\exp\\!\\left[ -\\frac{(\\theta - \\theta_0)^2}{\\Delta^2} \\right],\n$$\n其中 $ \\hat{s} $ 是背景磁剪切，$ s_{\\mathrm{rev}} $ 是中心位于 $ \\theta_0 $、宽度为 $ \\Delta $ 的局域磁剪切反转的振幅。边界条件为在有限区间 $ \\theta \\in [-\\theta_{\\max}, \\theta_{\\max}] $ 上的齐次狄利克雷边界条件 $ \\phi(-\\theta_{\\max}) = \\phi(\\theta_{\\max}) = 0 $。\n\n从线性波传播的基本原理和二阶微分算子的自伴形式出发，谱 $ \\{ \\mu \\} $ 表征了起稳定作用的垂直压缩和起去稳定作用的曲率驱动之间的净平衡。一个负的最小本征值 $ \\mu_{\\min} $ 表明曲率驱动在局部上超过了垂直方向的稳定作用，从而产生一个局域化的束缚态，该束缚态可作为不稳定ITG模结构的代表。其空间局域化程度可以通过二阶矩宽度来量化：\n$$\nw = \\sqrt{ \\frac{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} \\theta^2 \\, |\\phi(\\theta)|^2 \\, d\\theta }{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} |\\phi(\\theta)|^2 \\, d\\theta } }.\n$$\n\n您的任务是在区间 $ [-\\theta_{\\max}, \\theta_{\\max}] $ 上使用均匀网格和二阶中心差分来离散化 $ \\mathcal{H} $（针对 $ -d^2/d\\theta^2 $），并施加齐次狄利克雷边界条件，构建 $ \\mathcal{H} $ 的对称三对角矩阵表示，并计算代数上最小的本征值 $ \\mu_{\\min} $ 及其对应的归一化本征矢量 $ \\phi(\\theta) $。然后，使用均匀间距的离散近似积分计算 $ w $。所有角度必须以弧度处理。所有量均为无量纲。将每个测试用例的 $ \\mu_{\\min} $ 和 $ w $ 表示为浮点数，并四舍五入到六位小数。\n\n使用以下数值规范，它们定义了测试套件：\n- 区间半宽：$ \\theta_{\\max} = 3\\pi $。\n- 网格点数：$ N = 2001 $，在 $ [-\\theta_{\\max}, \\theta_{\\max}] $ 上均匀分布。\n- 离散算子：$ \\mathcal{H} $ 由三对角矩阵表示，其主对角线元素为 $ 2/h^2 + U(\\theta_i) $，次对角线元素为 $ -1/h^2 $，其中 $ h $ 是均匀网格间距，该算子作用于内部点 $ i = 2, \\ldots, N-1 $。\n\n测试套件参数集 $ (k_y, \\hat{s}, \\alpha, s_{\\mathrm{rev}}, \\theta_0, \\Delta, A_{\\mathrm{curv}}, A_{\\mathrm{hel}}, N_{\\mathrm{hel}}) $:\n1.  托卡马克基准：$ (0.35, 1.0, 0.6, 0.0, 0.0, 0.7, 0.45, 0.0, 0) $。\n2.  在弱磁场侧中平面附近有局域磁剪切反转的托卡马克：$ (0.35, 0.8, 0.5, -1.2, 0.0, 0.6, 0.45, 0.0, 0) $。\n3.  类仿星器螺旋曲率和弱局域磁剪切反转：$ (0.30, 0.8, 0.4, -0.5, 1.2, 0.8, 0.30, 0.25, 3) $。\n4.  高气球模参数的稳定情况：$ (0.35, 0.5, 1.2, 0.0, 0.0, 0.6, 0.35, 0.0, 0) $。\n\n实现要求：\n- 完全按照上述规定构建 $ U(\\theta) $。\n- 为每个测试用例计算 $ \\mu_{\\min} $ 和 $ w $。\n- 将计算出的每个 $ \\mu_{\\min} $ 和 $ w $ 四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。对于从1到4的每个测试用例，依次输出 $ \\mu_{\\min} $ 和 $ w $。因此，最终列表必须包含八个浮点数，即 $ [\\mu_{\\min}^{(1)}, w^{(1)}, \\mu_{\\min}^{(2)}, w^{(2)}, \\mu_{\\min}^{(3)}, w^{(3)}, \\mu_{\\min}^{(4)}, w^{(4)}] $。",
            "solution": "用户提供了一个来自计算等离子体物理领域的明确问题，具体涉及磁约束等离子体中离子温度梯度（ITG）模的稳定性。该问题在科学上是合理的，数学上是完备的，并且在数值上是可行的。因此，我将着手提供一个完整的解决方案。\n\n该问题要求求解一维、不含时、类薛定谔方程，在此背景下也称为气球模方程：\n$$\n\\mathcal{H} \\, \\phi(\\theta) = \\mu \\, \\phi(\\theta)\n$$\n其中 $ \\mathcal{H} = -\\frac{d^2}{d\\theta^2} + U(\\theta) $ 是一个自伴算子，$ \\phi(\\theta) $ 是表示沿磁场线的模振幅的本征函数，$ \\mu $ 是对应的本征值。一个负的最小本征值 $ \\mu_{\\min} < 0 $ 意味着存在一个不稳定的模。任务是为几组物理参数找到 $ \\mu_{\\min} $ 和相应本征函数 $ \\phi_{\\min}(\\theta) $ 的空间宽度 $ w $。\n\n解决策略是在均匀网格上离散化微分算子 $ \\mathcal{H} $，然后求解得到的矩阵本征值问题。\n\n**1. 域和算子的离散化**\n\n连续域 $ \\theta \\in [-\\theta_{\\max}, \\theta_{\\max}] $ 被离散化为一个包含 $ N $ 个点的均匀网格。设网格点为 $ \\theta_i = -\\theta_{\\max} + (i-1)h $，其中 $ i = 1, 2, \\ldots, N $。网格间距为 $ h = (2\\theta_{\\max}) / (N-1) $。问题指定 $ \\theta_{\\max} = 3\\pi $ 和 $ N = 2001 $。\n\n二阶导数算子 $ d^2/d\\theta^2 $ 使用二阶中心有限差分格式进行近似：\n$$\n\\frac{d^2\\phi}{d\\theta^2}\\bigg|_{\\theta_i} \\approx \\frac{\\phi(\\theta_{i+1}) - 2\\phi(\\theta_i) + \\phi(\\theta_{i-1})}{h^2} = \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\n将此近似代入内部网格点 $ \\theta_i $ ($ i \\in \\{2, \\ldots, N-1\\} $) 的本征值方程，得到：\n$$\n-\\left( \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} \\right) + U(\\theta_i)\\phi_i = \\mu \\phi_i\n$$\n整理此方程可得：\n$$\n-\\frac{1}{h^2} \\phi_{i-1} + \\left(\\frac{2}{h^2} + U(\\theta_i)\\right) \\phi_i - \\frac{1}{h^2} \\phi_{i+1} = \\mu \\phi_i\n$$\n这定义了一个矩阵本征值问题 $ \\mathbf{H}\\vec{\\phi} = \\mu\\vec{\\phi} $。齐次狄利克雷边界条件 $ \\phi_1 = \\phi(-\\theta_{\\max}) = 0 $ 和 $ \\phi_N = \\phi(\\theta_{\\max}) = 0 $ 消去了完整 $ N \\times N $ 矩阵的第一行、第一列、最后一行和最后一列，从而为内部点向量 $ \\vec{\\phi}_{\\text{int}} = [\\phi_2, \\phi_3, \\ldots, \\phi_{N-1}]^T $ 导出一个有效的本征值问题。最终得到的矩阵 $ \\mathbf{H} $ 是一个 $ (N-2) \\times (N-2) $ 的实对称三对角矩阵，其元素为：\n- 主对角线元素：$ D_j = \\frac{2}{h^2} + U(\\theta_{j+1}) $，其中 $ j = 1, \\ldots, N-2 $。\n- 次对角线元素：$ E_j = -\\frac{1}{h^2} $，其中 $ j = 1, \\ldots, N-3 $。\n\n**2. 数值本征值求解**\n\n求解对称三对角矩阵的本征值和本征向量是数值线性代数中的一个经典且可高效解决的问题。我们只关心代数上最小的本征值 $ \\mu_{\\min} $及其相关的本征向量。为此，专用算法比通用本征求解器效率高得多。`scipy.linalg.eigh_tridiagonal` 函数非常适合这项任务，因为它针对对称三对角矩阵进行了优化，并且可以被指示仅计算本征对的特定子集。我们将请求与最低索引（$0$）对应的本征对，对于对称矩阵，这对应于最小的本征值。\n\n**3. 模宽度的计算**\n\n一旦找到与 $ \\mu_{\\min} $ 对应的本征向量 $ \\vec{\\phi}_{\\text{int}} $，就在其两端填充零，以重构在网格 $ \\{\\theta_i\\}_{i=1}^N $ 上的完整离散本征函数 $ \\vec{\\phi} $。这满足了边界条件 $ \\phi_1 = \\phi_N = 0 $。\n\n二阶矩宽度 $ w $ 由以下积分定义：\n$$\nw = \\sqrt{ \\frac{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} \\theta^2 \\, |\\phi(\\theta)|^2 \\, d\\theta }{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} |\\phi(\\theta)|^2 \\, d\\theta } }\n$$\n这些积分通过在网格点上进行数值求和来近似。对于均匀网格，积分 $ \\int f(\\theta) d\\theta $ 可近似为 $ \\sum_i f(\\theta_i) h $。将此应用于 $ w^2 $ 的定义：\n$$\nw^2 \\approx \\frac{ \\sum_{i=1}^{N} \\theta_i^2 |\\phi_i|^2 h }{ \\sum_{i=1}^{N} |\\phi_i|^2 h } = \\frac{ \\sum_{i=1}^{N} \\theta_i^2 |\\phi_i|^2 }{ \\sum_{i=1}^{N} |\\phi_i|^2 }\n$$\n网格间距 $ h $ 被约去。因此，计算过程涉及使用已计算的离散本征函数 $ \\vec{\\phi} $ 对网格进行两次加权求和。\n\n**4. 算法实现步骤**\n\n对于每个测试用例，总体算法按以下步骤进行：\n1.  定义数值参数：$ \\theta_{\\max} = 3\\pi $，$ N = 2001 $。\n2.  为 $ i=1, \\ldots, N $ 设置均匀网格 $ \\theta_i $，并计算网格间距 $ h $。\n3.  提取物理参数 $ (k_y, \\hat{s}, \\alpha, s_{\\mathrm{rev}}, \\theta_0, \\Delta, A_{\\mathrm{curv}}, A_{\\mathrm{hel}}, N_{\\mathrm{hel}}) $。\n4.  为内部网格点 $ i = 2, \\ldots, N-1 $ 构建势 $ U(\\theta_i) $。这首先需要计算 $ s_{\\mathrm{eff}}(\\theta_i) $ 和 $ \\omega_D(\\theta_i) $。\n5.  构建 $ (N-2) \\times (N-2) $ 三对角矩阵 $ \\mathbf{H} $ 的主对角线和次对角线。\n6.  使用 `scipy.linalg.eigh_tridiagonal` 计算最低本征值 $ \\mu_{\\min} $ 及其本征向量 $ \\vec{\\phi}_{\\text{int}} $。\n7.  通过在 $ \\vec{\\phi}_{\\text{int}} $ 两端填充零来构建长度为 $ N $ 的完整本征向量 $ \\vec{\\phi} $。\n8.  计算所有网格点上的和 $ \\sum \\theta_i^2 |\\phi_i|^2 $ 和 $ \\sum |\\phi_i|^2 $。\n9.  使用这些和的比值计算 $ w $。\n10. 将 $ \\mu_{\\min} $ 和 $ w $ 四舍五入到六位小数。\n11. 整理所有测试用例的结果，并按指定的输出字符串格式进行格式化。",
            "answer": "[-0.169123,2.379207,-0.485125,1.258169,-0.176461,2.062057,0.134704,2.380064]"
        },
        {
            "introduction": "在像仿星器这样的非轴对称装置中，新经典粒子输运本质上不是双极的，这意味着电子和离子的损失不会自动相等。为了维持准电中性，等离子体会自发产生一个径向电场 $E_r$ 来平衡这些粒子流。这项计算练习将指导您从第一性原理出发，推导并求解双极性条件以确定 $E_r$ 剖面，让您亲身体验仿星器物理学中深刻影响整体等离子体约束的核心要素。",
            "id": "4194799",
            "problem": "您的任务是通过令离子和电子的新经典径向粒子通量相等，为仿星器构建并实现一个有原理依据的双极电场确定模型，然后计算在选定磁通面半径处的双极径向电场剖面 $E_r(\\psi)$。推导必须从第一性原理和经过充分检验的事实出发，程序必须使用提供的参数为指定的测试套件计算数值结果。\n\n出发点是双极性（径向粒子输运的准中性），它要求电子和离子的径向粒子通量相等，记作 $\\Gamma_e = \\Gamma_i$。假设在每个磁通面上存在一个线性新经典输运闭合，其中粒子种类 $s \\in \\{e,i\\}$ 的径向粒子通量模型为\n$$\n\\Gamma_s = - n \\, D_s \\left( \\frac{d \\ln n}{dr} + \\alpha_s \\frac{d \\ln T_s}{dr} + \\beta_s \\frac{Z_s e E_r}{T_s} \\right),\n$$\n其中 $n$ 是密度，$D_s$ 是新经典输运系数，单位为 $\\mathrm{m^2/s}$，$T_s$ 是温度，$Z_s$ 是电荷态（$Z_e = -1$，$Z_i = +1$），$e$ 是元电荷，$r$ 是标记磁通面的类小半径坐标。系数 $\\alpha_s$ 和 $\\beta_s$ 是量级为1的无量纲热力学驱动力系数，表征新经典的交叉耦合。\n\n对 $D_s$ 采用一个复合的、跨区域的模型，该模型平滑地结合了 $1/\\nu$ 区（低碰撞频率）、$\\sqrt{\\nu}$ 区（中等碰撞频率）和 Pfirsch–Schlüter 区（高碰撞频率），表示为\n$$\nD_s = C_{1s} \\, \\epsilon_{\\mathrm{eff}}^{3/2} \\, \\frac{v_{\\mathrm{th},s}^2}{\\nu_s R^2} \\, \\rho_s^2 \\;+\\; C_{2s} \\, \\epsilon_{\\mathrm{eff}}^{1/2} \\, \\frac{v_{\\mathrm{th},s} \\, \\rho_s^2}{R} \\, \\sqrt{\\frac{\\nu_s}{\\Omega_{c,s}}} \\;+\\; C_{3s} \\, \\nu_s \\, \\rho_s^2,\n$$\n其中 $\\epsilon_{\\mathrm{eff}}$ 是有效磁场纹波，$R$ 是大半径，$v_{\\mathrm{th},s} = \\sqrt{2 T_s / m_s}$ 是热速度，$\\rho_s = v_{\\mathrm{th},s} / \\Omega_{c,s}$ 是回旋半径，$\\Omega_{c,s} = Z_s e B / m_s$ 是回旋频率，$B$ 是磁场强度，$\\nu_s$ 是粒子自身碰撞（对电子而言是电子-离子碰撞）频率。所有物理量均采用国际单位制 (SI)，在需要时通过乘以 $e$ 将温度从电子伏特转换为焦耳。\n\n使用来自 National Research Laboratory (NRL) Plasma Formulary 的以下经过充分检验的库仑碰撞频率近似公式（对单电荷离子 $Z_i = 1$ 有效），其中密度单位为 $\\mathrm{cm^{-3}}$，温度单位为 $\\mathrm{eV}$：\n- 电子-离子碰撞频率：\n$$\n\\nu_{ei} \\;[\\mathrm{s^{-1}}] = 2.91 \\times 10^{-6} \\; n_e \\;[\\mathrm{cm^{-3}}] \\; \\ln\\Lambda \\; \\left(T_e \\;[\\mathrm{eV}]\\right)^{-3/2}.\n$$\n- 离子-离子碰撞频率（对氢）：\n$$\n\\nu_{ii} \\;[\\mathrm{s^{-1}}] = 4.80 \\times 10^{-8} \\; n_i \\;[\\mathrm{cm^{-3}}] \\; \\ln\\Lambda \\; \\left(T_i \\;[\\mathrm{eV}]\\right)^{-3/2}.\n$$\n\n假设为单电荷、准中性等离子体，其中 $n_e \\approx n_i \\equiv n$。双极性条件 $\\Gamma_e = \\Gamma_i$ 与上述闭合关系一同在每个半径处给出了一个关于 $E_r$ 的标量方程。您必须显式求解 $E_r$，并实现一个程序来根据指定的剖面计算其值。\n\n采用以下参数值，除非明确说明，所有常数均采用 SI 单位制：\n- 几何与磁场位形：\n  - 大半径 $R = 1.5 \\,\\mathrm{m}$，\n  - 小半径 $a = 0.5 \\,\\mathrm{m}$，\n  - 磁场强度 $B = 2.7 \\,\\mathrm{T}$，\n  - 有效磁场纹波 $\\epsilon_{\\mathrm{eff}} = 0.01$。\n- 库仑对数：$\\ln\\Lambda = 17$ (无量纲)。\n- 粒子种类与常数：\n  - 元电荷 $e = 1.602176634 \\times 10^{-19} \\,\\mathrm{C}$，\n  - 电子质量 $m_e = 9.10938356 \\times 10^{-31} \\,\\mathrm{kg}$，\n  - 质子质量 $m_i = 1.6726219 \\times 10^{-27} \\,\\mathrm{kg}$，\n  - 离子电荷态 $Z_i = +1$，电子电荷态 $Z_e = -1$。\n- 作为r的函数的剖面模型：\n  - 密度，单位 $\\mathrm{m^{-3}}$：\n    $$\n    n(r) = n_{\\mathrm{edge}} + \\left(n_0 - n_{\\mathrm{edge}}\\right)\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right),\n    $$\n    其中 $n_0 = 1.2 \\times 10^{20}$ 且 $n_{\\mathrm{edge}} = 2.0 \\times 10^{19}$。\n  - 电子温度，单位 $\\mathrm{eV}$：\n    $$\n    T_e(r) = T_{e,\\mathrm{edge}} + \\left(T_{e0} - T_{e,\\mathrm{edge}}\\right)\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right),\n    $$\n    其中 $T_{e0} = 2000$ 且 $T_{e,\\mathrm{edge}} = 100$。\n  - 离子温度，单位 $\\mathrm{eV}$：\n    $$\n    T_i(r) = T_{i,\\mathrm{edge}} + \\left(T_{i0} - T_{i,\\mathrm{edge}}\\right)\\left(1 - \\left(\\frac{r}{a}\\right)^2\\right),\n    $$\n    其中 $T_{i0} = 1500$ 且 $T_{i,\\mathrm{edge}} = 100$。\n- 新经典系数：\n  - $\\alpha_e = 0.71$, $\\beta_e = 1.0$,\n  - $\\alpha_i = 0.50$, $\\beta_i = 1.0$,\n  - $C_{1e} = 0.66$, $C_{2e} = 0.40$, $C_{3e} = 0.30$,\n  - $C_{1i} = 0.66$, $C_{2i} = 0.50$, $C_{3i} = 0.30$.\n\n需要实现的推导和计算细节：\n- 使用链式法则从剖面解析地计算 $d \\ln n / dr$ 和 $d \\ln T_s / dr$。自然对数导数为 $d \\ln n / dr = \\left(1/n\\right) \\, dn/dr$ 和 $d \\ln T_s / dr = \\left(1/T_s\\right) \\, dT_s/dr$。请注意，在这些对数梯度中，$T_s$ 可以统一用 $\\mathrm{eV}$ 为单位进行处理，因为该比值是无量纲的；然而，在双极电场公式中，凡是 $T_s$ 与能量相乘或相除的地方，都必须通过 $T_s[\\mathrm{J}] = e \\, T_s[\\mathrm{eV}]$ 将其转换为焦耳。\n- 在计算提供的 NRL 公式中的 $\\nu_{ei}$ 和 $\\nu_{ii}$ 时，将密度转换为 $\\mathrm{cm^{-3}}$，然后将这些以 $\\mathrm{s^{-1}}$ 为单位的值直接用于 $D_s$ 的 SI 表达式。\n- 在 SI 单位制下计算 $v_{\\mathrm{th},s}$、$\\Omega_{c,s}$ 和 $\\rho_s$。\n- 组合出 $D_s$，然后施加 $\\Gamma_e = \\Gamma_i$ 条件来确定 $E_r$。\n\n您必须实现一个程序，使用上述输入在一组选定的半径上计算 $E_r$。最终电场以 $\\mathrm{V/m}$ 为单位表示。对于数值输出，在打印前将每个 $E_r$ 四舍五入到最近的整数。\n\n测试套件：\n- 需要计算 $E_r$ 的半径（单位：米）：\n  - 情况 1：$r = 0.05$，\n  - 情况 2：$r = 0.25$，\n  - 情况 3：$r = 0.49$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按测试套件半径的顺序列出，例如 $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3\\right]$，每个条目是代表 $\\mathrm{V/m}$ 的整数，并且输出行中没有任何空格。",
            "solution": "所提出的问题是确定仿星器等离子体中的双极径向电场 $E_r(r)$。这是新经典输运理论中的一个标准问题，它具有充分的科学依据并且在计算上是可行的。所有必需的物理模型、参数和边界条件都已提供，并且它们是一致且物理上现实的。该问题是适定的，对于每个指定的半径都能得到 $E_r$ 的唯一解。因此，该问题被认为是有效的，完整的解答如下。\n\n基本原理是双极性，它通过要求总电荷通量为零来强制实现径向粒子输运中的准中性。对于由电子（种类 $s=e$）和单一离子种类（种类 $s=i$）组成的简单等离子体，此条件简化为径向粒子通量相等：\n$$\n\\Gamma_e = \\Gamma_i\n$$\n该问题提供了一个线性的新经典闭合关系，它将粒子种类 $s$ 的粒子通量与热力学驱动力（密度和温度的梯度）以及径向电场联系起来：\n$$\n\\Gamma_s = - n \\, D_s \\left( \\frac{d \\ln n}{dr} + \\alpha_s \\frac{d \\ln T_s}{dr} + \\beta_s \\frac{Z_s e E_r}{T_s} \\right)\n$$\n此处，$n$ 是等离子体密度，$D_s$ 是新经典扩散系数，$\\alpha_s$ 和 $\\beta_s$ 是无量纲系数，$T_s$ 是以能量单位（焦耳）表示的粒子种类温度，$Z_s$ 是电荷态数（$Z_e = -1$，$Z_i = +1$），$e$ 是元电荷，$E_r$ 是径向电场。\n\n**步骤1：双极径向电场的推导**\n\n我们首先根据双极性条件，令电子和离子通量相等：\n$$\n- n D_e \\left( \\frac{d \\ln n}{dr} + \\alpha_e \\frac{d \\ln T_e}{dr} + \\beta_e \\frac{Z_e e E_r}{T_e} \\right) = - n D_i \\left( \\frac{d \\ln n}{dr} + \\alpha_i \\frac{d \\ln T_i}{dr} + \\beta_i \\frac{Z_i e E_r}{T_i} \\right)\n$$\n假设密度非零 $n > 0$，两边的公因子 $-n$ 可以消去。然后我们代入电荷数 $Z_e = -1$ 和 $Z_i = +1$：\n$$\nD_e \\left( \\frac{d \\ln n}{dr} + \\alpha_e \\frac{d \\ln T_e}{dr} - \\frac{\\beta_e e E_r}{T_e} \\right) = D_i \\left( \\frac{d \\ln n}{dr} + \\alpha_i \\frac{d \\ln T_i}{dr} + \\frac{\\beta_i e E_r}{T_i} \\right)\n$$\n为了求解 $E_r$，我们重排方程，将包含 $E_r$ 的项归到一边，所有其他项归到另一边：\n$$\nD_e \\left( \\frac{d \\ln n}{dr} + \\alpha_e \\frac{d \\ln T_e}{dr} \\right) - D_i \\left( \\frac{d \\ln n}{dr} + \\alpha_i \\frac{d \\ln T_i}{dr} \\right) = \\frac{D_e \\beta_e e E_r}{T_e} + \\frac{D_i \\beta_i e E_r}{T_i}\n$$\n提出右侧的公因子 $E_r$ 和 $e$ 可得：\n$$\nD_e \\left( \\frac{d \\ln n}{dr} + \\alpha_e \\frac{d \\ln T_e}{dr} \\right) - D_i \\left( \\frac{d \\ln n}{dr} + \\alpha_i \\frac{d \\ln T_i}{dr} \\right) = e E_r \\left( \\frac{D_e \\beta_e}{T_e} + \\frac{D_i \\beta_i}{T_i} \\right)\n$$\n最后，分离出 $E_r$ 就得到了双极径向电场的显式表达式。至关重要的是，为确保量纲一致性，分母中的温度 $T_e$ 和 $T_i$ 必须以焦耳为单位表示，因为它们是被能量单位 $e E_r$ 除的。\n$$\nE_r(r) = \\frac{D_e \\left( \\frac{d \\ln n}{dr} + \\alpha_e \\frac{d \\ln T_e}{dr} \\right) - D_i \\left( \\frac{d \\ln n}{dr} + \\alpha_i \\frac{d \\ln T_i}{dr} \\right)}{e \\left( \\frac{D_e \\beta_e}{T_e[\\mathrm{J}]} + \\frac{D_i \\beta_i}{T_i[\\mathrm{J}]} \\right)}\n$$\n这个方程是我们数值模型的核心。\n\n**步骤2：剖面梯度的计算**\n\n该问题为密度 $n(r)$ 和温度 $T_s(r)$ 指定了类抛物线剖面。设一个通用剖面表示为 $f(r)$：\n$$\nf(r) = f_{\\mathrm{edge}} + (f_0 - f_{\\mathrm{edge}}) \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)\n$$\n其中 $f_0$ 是在磁轴（$r=0$）处的值，$f_{\\mathrm{edge}}$ 是在等离子体边界（$r=a$）处的值。其径向导数为：\n$$\n\\frac{df}{dr} = (f_0 - f_{\\mathrm{edge}}) \\left( -\\frac{2r}{a^2} \\right) = - \\frac{2r(f_0 - f_{\\mathrm{edge}})}{a^2}\n$$\n出现在驱动力项中的对数径向梯度则为：\n$$\n\\frac{d \\ln f}{dr} = \\frac{1}{f(r)} \\frac{df}{dr} = \\frac{-2r(f_0 - f_{\\mathrm{edge}})}{a^2 \\left[ f_{\\mathrm{edge}} + (f_0 - f_{\\mathrm{edge}}) \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right) \\right]}\n$$\n该公式使用各自的中心值和边界值应用于 $n(r)$、$T_e(r)$ 和 $T_i(r)$。对于温度梯度， $T_s$ 的单位会消掉，因此可以统一使用电子伏特（$\\mathrm{eV}$）进行计算。\n\n**步骤3：新经典扩散系数的计算**\n\n复合扩散系数 $D_s$ 是对应不同碰撞频率区的三个项之和：\n$$\nD_s = C_{1s} \\epsilon_{\\mathrm{eff}}^{3/2} \\frac{v_{\\mathrm{th},s}^2}{\\nu_s R^2} \\rho_s^2 \\;+\\; C_{2s} \\epsilon_{\\mathrm{eff}}^{1/2} \\frac{v_{\\mathrm{th},s} \\rho_s^2}{R} \\sqrt{\\frac{\\nu_s}{\\Omega_{c,s}}} \\;+\\; C_{3s} \\nu_s \\rho_s^2\n$$\n为了计算在给定半径 $r$ 处每个粒子种类的 $D_s$，我们必须首先以 SI 单位计算几个中间量。\n\n- **碰撞频率 ($\\nu_s$)**：NRL 公式给出的密度单位是 $\\mathrm{cm^{-3}}$，温度单位是 $\\mathrm{eV}$。我们必须将密度 $n(r) [\\mathrm{m^{-3}}]$ 转换为 $n(r) [\\mathrm{cm^{-3}}] = n(r) [\\mathrm{m^{-3}}] \\times 10^{-6}$。对于电子，我们使用 $\\nu_e = \\nu_{ei}$；对于离子，我们使用 $\\nu_i = \\nu_{ii}$。\n$$\n\\nu_{ei} [\\mathrm{s^{-1}}] = 2.91 \\times 10^{-6} \\, n_e[\\mathrm{cm^{-3}}] \\, \\ln\\Lambda \\, (T_e[\\mathrm{eV}])^{-3/2}\n$$\n$$\n\\nu_{ii} [\\mathrm{s^{-1}}] = 4.80 \\times 10^{-8} \\, n_i[\\mathrm{cm^{-3}}] \\, \\ln\\Lambda \\, (T_i[\\mathrm{eV}])^{-3/2}\n$$\n\n- **回旋频率 ($\\Omega_{c,s}$)**：问题中给出 $\\Omega_{c,s} = Z_s e B / m_s$。然而，$D_s$ 表达式中的 $\\sqrt{\\nu_s/\\Omega_{c,s}}$ 项要求 $\\Omega_{c,s}$ 为正，以产生一个物理上必需的实值扩散系数。使用带符号的电荷 $Z_e = -1$ 将导致一个复数 $D_e$。因此，我们必须使用回旋频率作为正角频率的标准定义，即 $\\Omega_{c,s} = |Z_s| e B / m_s$。\n\n- **热速度 ($v_{\\mathrm{th},s}$)**：这需要以焦耳为单位的温度，$T_s[\\mathrm{J}] = T_s[\\mathrm{eV}] \\times e$。\n$$\nv_{\\mathrm{th},s} = \\sqrt{\\frac{2 T_s[\\mathrm{J}]}{m_s}}\n$$\n\n- **回旋半径 ($\\rho_s$)**:\n$$\n\\rho_s = \\frac{v_{\\mathrm{th},s}}{\\Omega_{c,s}}\n$$\n\n计算完这些分量后，可以将 $D_s$ 的三项组合并求和，以求得每种粒子的总扩散系数。\n\n**步骤4：数值实现**\n\n最后一步是在程序中实现上述计算序列。对于测试套件中的每个半径 $r$：\n1.  从它们的剖面函数计算 $n(r)$、$T_e(r)$ 和 $T_i(r)$。\n2.  计算对数梯度 $\\frac{d \\ln n}{dr}$、$\\frac{d \\ln T_e}{dr}$ 和 $\\frac{d \\ln T_i}{dr}$。\n3.  对于每种粒子 $s \\in \\{e, i\\}$：\n    a. 转换温度（$T_s[\\mathrm{eV}] \\to T_s[\\mathrm{J}]$）和密度（$n[\\mathrm{m^{-3}}] \\to n[\\mathrm{cm^{-3}}]$）的单位。\n    b. 计算碰撞频率 $\\nu_s$。\n    c. 计算回旋频率 $\\Omega_{c,s}$、热速度 $v_{\\mathrm{th},s}$ 和回旋半径 $\\rho_s$。\n    d. 组合 $D_s$ 的三个分量并求和。\n4.  将计算出的 $D_e$、$D_i$、对数梯度和以焦耳为单位的温度值代入推导出的 $E_r(r)$ 表达式中。\n5.  $E_r$ 的结果值将以 SI 单位伏特/米（$\\mathrm{V/m}$）表示。\n6.  按输出要求将最终值四舍五入到最近的整数。\n\n这个流程为解决所述问题提供了一个完整、分步的方法。",
            "answer": "[-1280,-6343,-11867]"
        }
    ]
}