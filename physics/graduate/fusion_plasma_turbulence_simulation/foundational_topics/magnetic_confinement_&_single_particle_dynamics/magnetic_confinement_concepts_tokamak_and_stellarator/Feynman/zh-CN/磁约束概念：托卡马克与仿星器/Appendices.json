{
    "hands_on_practices": [
        {
            "introduction": "安全因子$q$是描述磁约束等离子体中磁力线拓扑结构的关键参数。当$q$值为有理数$m/n$时所对应的磁面，即有理面，是磁流体动力学（MHD）不稳定性萌生的重要位置，也是湍流模拟中必须精确描述的基本结构。本练习将引导你基于一个给定的安全因子分布函数，动手计算一个特定有理面的空间位置，从而加深对托卡马克平衡构型的理解。",
            "id": "4194764",
            "problem": "考虑一个大环径比、轴对称的托卡马克，其具有圆形同心磁通量面，小半径为$a$，大半径为$R_0$。安全因子$q(r)$定义为磁力线环向缠绕与极向缠绕的匝数之比，在大环径比极限下可写为$q(r) \\approx \\frac{r B_{\\phi}(r)}{R_0 B_{\\theta}(r)}$，其中$B_{\\phi}$和$B_{\\theta}$分别是环向和极向磁场分量。有理面位于半径$r$处，其中$q(r) = \\frac{m}{n}$（$m$和$n$为整数）。已知此类磁面对磁流体动力学（MHD）模是共振的，并可在聚变等离子体湍流模拟中引发微观湍流活动。\n\n假设在该托卡马克中测得的平衡安全因子剖面可以很好地用以下二次形式近似：\n$$\nq(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^{2},\n$$\n其中$q_0 > 0$和$\\alpha > 0$是无量纲常数。假设该剖面在$r$上是单调的，并且与中心峰化的电流密度在物理上一致，请确定$q = \\frac{3}{2}$的有理面的位置，并计算相应的半径$r_{3/2}$。\n\n使用以下参数：$a = 0.75\\,\\mathrm{m}$，$q_0 = 0.95$和$\\alpha = 0.80$。将您计算的$r_{3/2}$的最终数值结果四舍五入到四位有效数字，并以米为单位表示。",
            "solution": "对问题陈述进行了严格评估，认定其有效。该问题科学上基于应用于托卡马克等离子体的磁流体动力学（MHD）原理，问题设定良好，给出的条件完整且一致，并以客观、正式的语言表述。所提供的安全因子剖面模型是一个标准且物理上合理的近似。所有指定参数均具有实际意义的数值。因此，可以确定一个解。\n\n在大环径比的圆形托卡马克中，平衡安全因子剖面$q(r)$由以下二次形式给出：\n$$\nq(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^{2}\n$$\n此处，$r$是小半径坐标，$a$是等离子体小半径，$q_0$是磁轴（$r=0$）处的安全因子，$\\alpha$是一个决定剖面形状的无量纲参数。\n\n我们的任务是找到安全因子为$q=\\frac{3}{2}$的有理面的位置。有理面由条件$q(r) = m/n$定义，其中$m$和$n$是整数。在本例中，我们关心的是$m=3, n=2$的磁面。设该磁面的半径为$r_{3/2}$。我们可以通过令$q(r_{3/2})$等于$\\frac{3}{2}$来找到这个半径：\n$$\nq(r_{3/2}) = q_0 + \\alpha \\left(\\frac{r_{3/2}}{a}\\right)^{2} = \\frac{3}{2}\n$$\n我们的目标是求解该方程以得到$r_{3/2}$。我们可以通过代数方法重新排列方程，以分离出包含$r_{3/2}$的项：\n$$\n\\alpha \\left(\\frac{r_{3/2}}{a}\\right)^{2} = \\frac{3}{2} - q_0\n$$\n两边同时除以$\\alpha$得：\n$$\n\\left(\\frac{r_{3/2}}{a}\\right)^{2} = \\frac{\\frac{3}{2} - q_0}{\\alpha}\n$$\n为求解$r_{3/2}$，我们对两边取平方根。由于$r_{3/2}$代表一个物理半径，它必须是一个非负量。因此，我们取正平方根：\n$$\n\\frac{r_{3/2}}{a} = \\sqrt{\\frac{\\frac{3}{2} - q_0}{\\alpha}}\n$$\n最后，乘以小半径$a$得到有理面位置的符号表达式：\n$$\nr_{3/2} = a \\sqrt{\\frac{\\frac{3}{2} - q_0}{\\alpha}}\n$$\n题目给出了以下参数的数值：\n$a = 0.75\\,\\mathrm{m}$\n$q_0 = 0.95$\n$\\alpha = 0.80$\n\n我们可以将这些数值代入符号表达式中。注意$\\frac{3}{2} = 1.5$。\n$$\nr_{3/2} = 0.75 \\sqrt{\\frac{1.5 - 0.95}{0.80}}\n$$\n首先，我们计算平方根内的分子：\n$$\n1.5 - 0.95 = 0.55\n$$\n接下来，我们计算平方根内的分数：\n$$\n\\frac{0.55}{0.80} = 0.6875\n$$\n$r_{3/2}$的表达式变为：\n$$\nr_{3/2} = 0.75 \\sqrt{0.6875}\n$$\n计算平方根：\n$$\n\\sqrt{0.6875} \\approx 0.82915619758\n$$\n现在，我们乘以小半径$a$：\n$$\nr_{3/2} \\approx 0.75 \\times 0.82915619758 \\approx 0.62186714818\\,\\mathrm{m}\n$$\n题目要求最终答案四舍五入到四位有效数字。\n$$\nr_{3/2} \\approx 0.6219\\,\\mathrm{m}\n$$\n这个值在物理上是有意义的，因为它位于等离子体小半径之内，即$0  r_{3/2}  a$（$0.6219\\,\\mathrm{m}  0.75\\,\\mathrm{m}$）。这与目标值$q = 1.5$位于轴上值$q(0) = q_0 = 0.95$和边界值$q(a) = q_0 + \\alpha = 0.95 + 0.80 = 1.75$之间这一事实是一致的。",
            "answer": "$$\n\\boxed{0.6219}\n$$"
        },
        {
            "introduction": "理解了静态的磁场平衡之后，我们进一步探讨等离子体的动态稳定性，这是湍流研究的核心。离子温度梯度（ITG）模等微观不稳定性由等离子体压力梯度驱动，其增长和饱和决定了能量和粒子的输运水平。本练习将通过求解一个简化但极具代表性的一维回旋坐标本征值问题，让你亲手实践如何分析不同磁场位形（如磁剪切）对ITG模结构和稳定性的影响，从而建立起从磁场几何到等离子体湍流物理的直观联系。",
            "id": "4194738",
            "problem": "考虑磁约束等离子体中静电离子温度梯度（ITG）模的简化线性气球模表示，该表示适用于托卡马克和仿星器磁几何。沿单根磁力线，涨落包络振幅$\\phi(\\theta)$满足以下形式的特征值问题\n$$\n\\mathcal{H} \\, \\phi(\\theta) = \\mu \\, \\phi(\\theta),\n$$\n其中自伴算子为\n$$\n\\mathcal{H} = -\\frac{d^2}{d\\theta^2} + U(\\theta),\n$$\n其中$\\theta$是沿磁力线测量的气球模角（单位为弧度），$U(\\theta)$是一个有效势，其包含了垂直波数和曲率驱动的信息。该有效势由以下模型描述\n$$\nU(\\theta) = k_y^2 \\left[ 1 + \\left( s_{\\mathrm{eff}}(\\theta)\\, \\theta - \\alpha \\sin\\theta \\right)^2 \\right] - \\omega_D(\\theta),\n$$\n其中$k_y$是由特征回旋半径归一化的副法向波数，$\\alpha$是压强梯度气球模参数，$s_{\\mathrm{eff}}(\\theta)$是包含局域剪切反转贡献的有效磁剪切。曲率漂移驱动为\n$$\n\\omega_D(\\theta) = A_{\\mathrm{curv}} \\cos\\theta + A_{\\mathrm{hel}} \\cos(N_{\\mathrm{hel}} \\theta),\n$$\n其中$A_{\\mathrm{curv}}$是轴对称曲率振幅，$A_{\\mathrm{hel}}$是一个螺旋曲率振幅，代表具有模数$N_{\\mathrm{hel}}$的三维仿星器效应。有效磁剪切指定为\n$$\ns_{\\mathrm{eff}}(\\theta) = \\hat{s} + s_{\\mathrm{rev}} \\exp\\!\\left[ -\\frac{(\\theta - \\theta_0)^2}{\\Delta^2} \\right],\n$$\n其中$\\hat{s}$是背景磁剪切，$s_{\\mathrm{rev}}$是中心位于$\\theta_0$、宽度为$\\Delta$的局域剪切反转振幅。在有限区间$\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$上，边界条件为齐次狄利克雷条件$\\phi(-\\theta_{\\max}) = \\phi(\\theta_{\\max}) = 0$。\n\n从线性波传播的基本原理和二阶微分算子的自伴形式出发，谱$\\{\\mu\\}$表征了稳定的垂直压缩与不稳定的曲率驱动之间的净平衡。一个负的最低特征值$\\mu_{\\min}$表明曲率驱动在局部上克服了垂直稳定作用，产生一个局域化的束缚态，该束缚态可作为不稳定ITG模结构的代表。空间局域化程度可以通过二阶矩宽度来量化\n$$\nw = \\sqrt{ \\frac{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} \\theta^2 \\, |\\phi(\\theta)|^2 \\, d\\theta }{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} |\\phi(\\theta)|^2 \\, d\\theta } }.\n$$\n\n你的任务是，在区间$[-\\theta_{\\max}, \\theta_{\\max}]$上，使用均匀网格和针对$-d^2/d\\theta^2$的二阶中心差分，对算子$\\mathcal{H}$进行离散化，并施加齐次狄利克雷边界条件；然后，构造$\\mathcal{H}$的对称三对角矩阵表示，并计算其代数最小特征值$\\mu_{\\min}$及其对应的归一化特征向量$\\phi(\\theta)$。之后，使用均匀间距的积分离散近似来计算$w$。所有角度必须以弧度处理。所有量均为无量纲量。对每个测试用例，将$\\mu_{\\min}$和$w$表示为浮点数，并四舍五入到六位小数。\n\n使用以下数值规范，它们定义了测试套件：\n- 区间半宽度：$\\theta_{\\max} = 3\\pi$。\n- 网格点数：$N = 2001$，在$[-\\theta_{\\max}, \\theta_{\\max}]$上均匀分布。\n- 离散算子：$\\mathcal{H}$由一个三对角矩阵表示，其主对角线元素为$2/h^2 + U(\\theta_i)$，次对角线元素为$-1/h^2$，其中$h$是均匀网格间距，该算子应用于内部点$i = 2, \\ldots, N-1$。\n\n测试套件参数集$(k_y, \\hat{s}, \\alpha, s_{\\mathrm{rev}}, \\theta_0, \\Delta, A_{\\mathrm{curv}}, A_{\\mathrm{hel}}, N_{\\mathrm{hel}})$：\n1. 托卡马克基准线：$(0.35, 1.0, 0.6, 0.0, 0.0, 0.7, 0.45, 0.0, 0)$。\n2. 在外侧中平面附近具有局域剪切反转的托卡马克：$(0.35, 0.8, 0.5, -1.2, 0.0, 0.6, 0.45, 0.0, 0)$。\n3. 仿星器型螺旋曲率和弱局域剪切反转：$(0.30, 0.8, 0.4, -0.5, 1.2, 0.8, 0.30, 0.25, 3)$。\n4. 高气球模参数稳定化情况：$(0.35, 0.5, 1.2, 0.0, 0.0, 0.6, 0.35, 0.0, 0)$。\n\n实现要求：\n- 完全按照上述规定构造$U(\\theta)$。\n- 为每个测试用例计算$\\mu_{\\min}$和$w$。\n- 将每个计算出的$\\mu_{\\min}$和$w$四舍五入到六位小数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于从1到4的每个测试用例，按顺序输出$\\mu_{\\min}$，后跟$w$。因此，最终列表必须包含八个浮点数，即$[\\mu_{\\min}^{(1)}, w^{(1)}, \\mu_{\\min}^{(2)}, w^{(2)}, \\mu_{\\min}^{(3)}, w^{(3)}, \\mu_{\\min}^{(4)}, w^{(4)}]$。",
            "solution": "用户提供了一个来自计算等离子体物理领域的适定问题，具体涉及磁约束等离子体中离子温度梯度（ITG）模的稳定性。该问题具有科学依据，数学上完备，并且数值上可行。因此，我将着手提供一个完整的解决方案。\n\n该问题需要求解一维、不含时（定态）的类薛定谔方程，在此背景下也称为气球模方程：\n$$\n\\mathcal{H} \\, \\phi(\\theta) = \\mu \\, \\phi(\\theta)\n$$\n其中$\\mathcal{H} = -\\frac{d^2}{d\\theta^2} + U(\\theta)$是一个自伴算子，$\\phi(\\theta)$是表示沿磁力线的模振幅的特征函数，$\\mu$是对应的特征值。一个负的最低特征值$\\mu_{\\min}  0$意味着一个不稳定的模。任务是针对几组物理参数，找出最低特征值$\\mu_{\\min}$以及对应特征函数$\\phi_{\\min}(\\theta)$的空间宽度$w$。\n\n解决策略是在均匀网格上离散化微分算子$\\mathcal{H}$，并求解由此产生的矩阵特征值问题。\n\n**1. 区域和算子的离散化**\n\n连续区域$\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$被离散化为一个包含$N$个点的均匀网格。设网格点为$\\theta_i = -\\theta_{\\max} + (i-1)h$，其中$i = 1, 2, \\ldots, N$。网格间距为$h = (2\\theta_{\\max}) / (N-1)$。问题指定了$\\theta_{\\max} = 3\\pi$和$N = 2001$。\n\n二阶导数算子$d^2/d\\theta^2$使用二阶中心有限差分格式进行近似：\n$$\n\\frac{d^2\\phi}{d\\theta^2}\\bigg|_{\\theta_i} \\approx \\frac{\\phi(\\theta_{i+1}) - 2\\phi(\\theta_i) + \\phi(\\theta_{i-1})}{h^2} = \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\n将此代入内部网格点$\\theta_i$ ($i \\in \\{2, \\ldots, N-1\\}$)的特征值方程，得到：\n$$\n-\\left( \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} \\right) + U(\\theta_i)\\phi_i = \\mu \\phi_i\n$$\n重新整理该方程得到：\n$$\n-\\frac{1}{h^2} \\phi_{i-1} + \\left(\\frac{2}{h^2} + U(\\theta_i)\\right) \\phi_i - \\frac{1}{h^2} \\phi_{i+1} = \\mu \\phi_i\n$$\n这定义了一个矩阵特征值问题$\\mathbf{H}\\vec{\\phi} = \\mu\\vec{\\phi}$。齐次狄利克雷边界条件$\\phi_1 = \\phi(-\\theta_{\\max}) = 0$和$\\phi_N = \\phi(\\theta_{\\max}) = 0$消去了完整$N \\times N$矩阵的第一行、最后一行、第一列和最后一列，从而为内部点向量$\\vec{\\phi}_{\\text{int}} = [\\phi_2, \\phi_3, \\ldots, \\phi_{N-1}]^T$导出一个有效的特征值问题。所得矩阵$\\mathbf{H}$是一个$(N-2) \\times (N-2)$的实对称三对角矩阵，其元素为：\n- 主对角线元素：$D_j = \\frac{2}{h^2} + U(\\theta_{j+1})$，其中$j = 1, \\ldots, N-2$。\n- 次对角线元素：$E_j = -\\frac{1}{h^2}$，其中$j = 1, \\ldots, N-3$。\n\n**2. 数值特征值求解**\n\n在数值线性代数中，寻找对称三对角矩阵的特征值和特征向量是一个经典且可高效求解的问题。我们只对代数最小的特征值$\\mu_{\\min}$及其关联的特征向量感兴趣。为此，专用算法远比通用特征值求解器高效。`scipy.linalg.eigh_tridiagonal`函数非常适合此任务，因为它针对对称三对角矩阵进行了优化，并且可以被指令仅计算特征对的一个特定子集。我们将请求与最低索引（$0$）对应的特征对，对于对称矩阵，这对应于最小的特征值。\n\n**3. 模宽度的计算**\n\n一旦找到与$\\mu_{\\min}$对应的特征向量$\\vec{\\phi}_{\\text{int}}$，就在其两端填充零，以在网格$\\{\\theta_i\\}_{i=1}^N$上重构完整的离散特征函数$\\vec{\\phi}$。这满足了边界条件$\\phi_1 = \\phi_N = 0$。\n\n二阶矩宽度$w$由以下积分定义：\n$$\nw = \\sqrt{ \\frac{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} \\theta^2 \\, |\\phi(\\theta)|^2 \\, d\\theta }{ \\int_{-\\theta_{\\max}}^{\\theta_{\\max}} |\\phi(\\theta)|^2 \\, d\\theta } }\n$$\n这些积分通过在网格点上进行数值求和来近似。对于均匀网格，积分$\\int f(\\theta) d\\theta$可近似为$\\sum_i f(\\theta_i) h$。将此应用于$w^2$的定义：\n$$\nw^2 \\approx \\frac{ \\sum_{i=1}^{N} \\theta_i^2 |\\phi_i|^2 h }{ \\sum_{i=1}^{N} |\\phi_i|^2 h } = \\frac{ \\sum_{i=1}^{N} \\theta_i^2 |\\phi_i|^2 }{ \\sum_{i=1}^{N} |\\phi_i|^2 }\n$$\n网格间距$h$被消掉。因此，计算过程涉及使用已计算出的离散特征函数$\\vec{\\phi}$在网格上计算两个加权和。\n\n**4. 算法实现步骤**\n\n针对每个测试用例，总体算法流程如下：\n1.  定义数值参数：$\\theta_{\\max} = 3\\pi$，$N = 2001$。\n2.  建立$i=1, \\ldots, N$的均匀网格$\\theta_i$，并计算网格间距$h$。\n3.  提取物理参数$(k_y, \\hat{s}, \\alpha, s_{\\mathrm{rev}}, \\theta_0, \\Delta, A_{\\mathrm{curv}}, A_{\\mathrm{hel}}, N_{\\mathrm{hel}})$。\n4.  为内部网格点$i = 2, \\ldots, N-1$构造势$U(\\theta_i)$。这首先需要计算$s_{\\mathrm{eff}}(\\theta_i)$和$\\omega_D(\\theta_i)$。\n5.  构成$(N-2) \\times (N-2)$三对角矩阵$\\mathbf{H}$的主对角线和次对角线。\n6.  使用`scipy.linalg.eigh_tridiagonal`计算最低特征值$\\mu_{\\min}$及其特征向量$\\vec{\\phi}_{\\text{int}}$。\n7.  通过在$\\vec{\\phi}_{\\text{int}}$两端填充零来构造长度为$N$的完整特征向量$\\vec{\\phi}$。\n8.  在所有网格点上计算和$\\sum \\theta_i^2 |\\phi_i|^2$与$\\sum |\\phi_i|^2$。\n9.  使用这些和的比率计算$w$。\n10. 将$\\mu_{\\min}$和$w$四舍五入到六位小数。\n11. 整理所有测试用例的结果，并将其格式化为指定的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Solves the 1D ballooning eigenvalue problem for ITG modes and calculates\n    the minimum eigenvalue and mode width for a given set of test cases.\n    \"\"\"\n    \n    # Numerical specifications\n    theta_max = 3.0 * np.pi\n    N = 2001\n\n    # Test suite parameter sets (ky, s_hat, alpha, s_rev, theta_0, delta, A_curv, A_hel, N_hel)\n    test_cases = [\n        (0.35, 1.0, 0.6, 0.0, 0.0, 0.7, 0.45, 0.0, 0),  # 1. Tokamak baseline\n        (0.35, 0.8, 0.5, -1.2, 0.0, 0.6, 0.45, 0.0, 0),  # 2. Tokamak with local shear reversal\n        (0.30, 0.8, 0.4, -0.5, 1.2, 0.8, 0.30, 0.25, 3),  # 3. Stellarator-like case\n        (0.35, 0.5, 1.2, 0.0, 0.0, 0.6, 0.35, 0.0, 0)   # 4. High ballooning parameter case\n    ]\n\n    results = []\n\n    # Set up the spatial grid\n    theta = np.linspace(-theta_max, theta_max, N)\n    h = theta[1] - theta[0]\n\n    # The eigenvalue problem is solved on the interior points\n    theta_interior = theta[1:-1]\n    num_interior_points = N - 2\n\n    for params in test_cases:\n        ky, s_hat, alpha, s_rev, theta_0, delta, A_curv, A_hel, N_hel = params\n\n        # 1. Construct the potential U(theta) on the interior grid\n        \n        # Effective magnetic shear\n        s_eff = s_hat + s_rev * np.exp(-((theta_interior - theta_0)**2) / delta**2)\n        \n        # Curvature drift drive\n        omega_D = A_curv * np.cos(theta_interior) + A_hel * np.cos(N_hel * theta_interior)\n        \n        # Total effective potential\n        U = ky**2 * (1.0 + (s_eff * theta_interior - alpha * np.sin(theta_interior))**2) - omega_D\n\n        # 2. Construct the tridiagonal matrix representation of the operator H\n        \n        # Main diagonal\n        main_diag = (2.0 / h**2) + U\n        \n        # Off-diagonal (constant value)\n        off_diag = np.full(num_interior_points - 1, -1.0 / h**2)\n        \n        # 3. Solve the eigenvalue problem for the lowest eigenvalue and eigenvector\n        \n        # We need only the eigenvalue at index 0 (the smallest one).\n        eigenvalues, eigenvectors = eigh_tridiagonal(\n            main_diag, \n            off_diag, \n            select='i', \n            select_range=(0, 0)\n        )\n        \n        mu_min = eigenvalues[0]\n        \n        # The eigenvector for the interior points\n        phi_interior = eigenvectors[:, 0]\n\n        # 4. Reconstruct the full eigenfunction and calculate its width\n        \n        # Create full eigenfunction vector, padding with zeros for Dirichlet BCs\n        phi = np.zeros(N)\n        phi[1:-1] = phi_interior\n        \n        # Normalize the eigenfunction on the grid (optional, as it cancels in w calculation)\n        # norm_const = np.sqrt(np.sum(phi**2) * h)\n        # phi /= norm_const\n        \n        # Calculate the second-moment width w\n        phi_sq = phi**2\n        norm_denominator = np.sum(phi_sq)\n        \n        # Avoid division by zero if the eigenfunction is numerically zero\n        if norm_denominator  1e-16:\n            w = 0.0\n        else:\n            width_numerator = np.sum(theta**2 * phi_sq)\n            w = np.sqrt(width_numerator / norm_denominator)\n\n        # 5. Store the rounded results\n        results.append(round(mu_min, 6))\n        results.append(round(w, 6))\n\n    # Print the final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了关键的物理概念后，我们将注意力转向等离子体湍流模拟的实际执行层面。在数值求解描述等离子体演化的偏微分方程时，显式时间积分格式的稳定性受到著名的Courant-Friedrichs-Lewy（CFL）条件的制约。本练习要求你推导并应用CFL条件来确定一个稳定可靠的模拟时间步长，其中考虑了沿磁力线的快速平行流动和垂直于磁力线的缓变漂移，并借此比较了托卡马克与仿星器在数值实现上的细微差别。",
            "id": "4194742",
            "problem": "考虑一个在磁约束装置中进行的聚变等离子体湍流模拟，该模拟使用场线追踪网格，坐标为$(x,y,s)$，其中$s$是沿磁场$\\mathbf{B}$的坐标（平行方向），$x$是穿过磁通面的径向坐标，$y$是磁通面内的副法线（气球模）坐标。由平行流和磁漂移平流的被动标量$f$的演化由第一性原理通过守恒律$\\partial f / \\partial t + \\mathbf{v} \\cdot \\nabla f = 0$决定，其中速度场为$\\mathbf{v} = v_{\\parallel} \\mathbf{b} + \\mathbf{v}_{d}$，$\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$是沿磁场的单位矢量，$\\mathbf{v}_{d}$代表在$(x,y)$平面上投影的磁曲率和梯度漂移。\n\n您需要确定一个在三维空间中采用非分裂显式有限体积、一阶迎风格式，并使用3阶强稳定性保持 Runge-Kutta (SSP-RK3) 方法进行时间积分的数值 Courant-Friedrichs-Lewy (CFL) 条件。网格间距是均匀的，由$\\Delta s = 0.20\\,\\mathrm{m}$、$\\Delta x = 0.005\\,\\mathrm{m}$和$\\Delta y = 0.010\\,\\mathrm{m}$给出（所有长度均沿其各自的物理方向）。平行流速度为$v_{\\parallel} = 2.0 \\times 10^{5}\\,\\mathrm{m/s}$。垂直平面上的磁漂移分量在不同装置中有所不同：对于托卡马克，$(v_{d,x}^{\\mathrm{T}}, v_{d,y}^{\\mathrm{T}}) = (20, 60)\\,\\mathrm{m/s}$；对于仿星器，$(v_{d,x}^{\\mathrm{S}}, v_{d,y}^{\\mathrm{S}}) = (20, 120)\\,\\mathrm{m/s}$。假设必须使用一个对两种装置都同时稳定的单一全局时间步长，并使用两者中最坏情况下的漂移速度大小。\n\n仅从守恒律以及采用 SSP-RK3 时间积分的迎风有限体积离散化的性质出发，推导适用于此非分裂格式在$(x,y,s)$方向上的多维 CFL 限制。然后，在给定参数下计算相应的最大稳定时间步长，并通过对最大稳定值应用安全因子$\\sigma = 0.80$来提出一个生产计算时间步长。将您最终提出的时间步长四舍五入到四位有效数字，并以秒（使用单位$\\mathrm{s}$）表示答案。",
            "solution": "该问题要求为等离子体湍流模拟确定一个稳定的数值时间步长。对问题陈述的验证证实了其科学和数学上的合理性、完整性和清晰性。该问题是适定的，并基于计算等离子体物理学的原理。\n\n被动标量$f$的控制方程是平流方程：\n$$\n\\frac{\\partial f}{\\partial t} + \\mathbf{v} \\cdot \\nabla f = 0\n$$\n在给定的场线追踪坐标$(x, y, s)$中，速度矢量$\\mathbf{v}$的分量为$(v_x, v_y, v_s)$，其中$v_x$和$v_y$是磁漂移速度$\\mathbf{v}_d$的分量，$v_s$是平行流速度$v_{\\parallel}$。该方程展开为：\n$$\n\\frac{\\partial f}{\\partial t} + v_x \\frac{\\partial f}{\\partial x} + v_y \\frac{\\partial f}{\\partial y} + v_s \\frac{\\partial f}{\\partial s} = 0\n$$\n这是一个三维线性双曲型偏微分方程。\n\n数值格式由空间上的一阶迎风有限体积离散化和用于时间积分的3阶强稳定性保持 Runge-Kutta (SSP-RK$3$) 方法组成。我们考虑的是一种非分裂显式格式。\n\n对于平流方程的一阶迎风离散化，显式时间步进格式的稳定性受到 Courant-Friedrichs-Lewy (CFL) 条件的限制。对于前向欧拉时间积分方法，一维问题$\\partial_t f + v \\partial_x f = 0$的稳定性条件由库朗数$C = \\frac{|v| \\Delta t}{\\Delta x} \\le 1$给出。\n\n对于三维非分裂格式，来自每个空间方向的贡献是可加的。以$(x_i, y_j, s_k)$为中心的网格单元的半离散形式是：\n$$\n\\frac{df_{i,j,k}}{dt} = \\mathcal{L}(f)_{i,j,k}\n$$\n其中$\\mathcal{L}$是空间离散算子。对于一阶迎风格式，该算子为：\n$$\n\\mathcal{L}(f)_{i,j,k} = - \\left( \\frac{|v_x|}{\\Delta x}(f_{i,j,k} - f_{\\text{upwind},x}) + \\frac{|v_y|}{\\Delta y}(f_{i,j,k} - f_{\\text{upwind},y}) + \\frac{|v_s|}{\\Delta s}(f_{i,j,k} - f_{\\text{upwind},s}) \\right)\n$$\n其中$f_{\\text{upwind},d}$是速度分量$v_d$在迎风方向上相邻单元中$f$的值。\n\n当使用前向欧拉方法$f^{n+1} = f^n + \\Delta t \\mathcal{L}(f^n)$进行积分时，如果更新公式中的所有系数都为非负，则该格式是稳定的（且单调的）。这导出了多维 CFL 条件：\n$$\n\\Delta t \\left( \\frac{|v_x|}{\\Delta x} + \\frac{|v_y|}{\\Delta y} + \\frac{|v_s|}{\\Delta s} \\right) \\le 1\n$$\n强稳定性保持 (SSP) 方法旨在保持前向欧拉方法的稳定性特性。一个 SSP-RK 方法可以表示为前向欧拉步的凸组合。对于一阶迎风空间离散化（在前向欧拉的 CFL 条件下是单调格式），SSP-RK$3$方法在相同条件下也是稳定的。对于这种空间和时间格式的特定组合，有效 SSP 系数为$1$。\n\n因此，最大稳定时间步长$\\Delta t_{max}$由以下等式给出：\n$$\n\\Delta t_{max} \\left( \\frac{|v_x|}{\\Delta x} + \\frac{|v_y|}{\\Delta y} + \\frac{|v_s|}{\\Delta s} \\right) = 1\n$$\n这可以重新整理以求解$\\Delta t_{max}$：\n$$\n\\Delta t_{max} = \\left( \\frac{|v_x|}{\\Delta x} + \\frac{|v_y|}{\\Delta y} + \\frac{|v_s|}{\\Delta s} \\right)^{-1}\n$$\n该问题要求基于最坏情况下的漂移速度大小，使用一个对托卡马克和仿星器两种构型都稳定的单一全局时间步长。最坏情况对应于最大的速度大小，因为这对时间步长施加了最严格的限制。\n\n给定的速度分量为：\n- 平行流：$v_s = v_{\\parallel} = 2.0 \\times 10^{5}\\,\\mathrm{m/s}$。\n- 托卡马克漂移：$(v_{d,x}^{\\mathrm{T}}, v_{d,y}^{\\mathrm{T}}) = (20, 60)\\,\\mathrm{m/s}$。\n- 仿星器漂移：$(v_{d,x}^{\\mathrm{S}}, v_{d,y}^{\\mathrm{S}}) = (20, 120)\\,\\mathrm{m/s}$。\n\n漂移速度的最坏情况（最大）大小为：\n- $|v_x| = \\max(|20|, |20|) = 20\\,\\mathrm{m/s}$。\n- $|v_y| = \\max(|60|, |120|) = 120\\,\\mathrm{m/s}$。\n\n网格间距给定为：\n- $\\Delta x = 0.005\\,\\mathrm{m}$。\n- $\\Delta y = 0.010\\,\\mathrm{m}$。\n- $\\Delta s = 0.20\\,\\mathrm{m}$。\n\n我们现在可以计算和中的各项：\n- $x$方向的 CFL 频率：$\\frac{|v_x|}{\\Delta x} = \\frac{20\\,\\mathrm{m/s}}{0.005\\,\\mathrm{m}} = 4000\\,\\mathrm{s}^{-1} = 4 \\times 10^3\\,\\mathrm{s}^{-1}$。\n- $y$方向的 CFL 频率：$\\frac{|v_y|}{\\Delta y} = \\frac{120\\,\\mathrm{m/s}}{0.010\\,\\mathrm{m}} = 12000\\,\\mathrm{s}^{-1} = 1.2 \\times 10^4\\,\\mathrm{s}^{-1}$。\n- $s$方向的 CFL 频率：$\\frac{|v_s|}{\\Delta s} = \\frac{2.0 \\times 10^5\\,\\mathrm{m/s}}{0.20\\,\\mathrm{m}} = 1000000\\,\\mathrm{s}^{-1} = 1 \\times 10^6\\,\\mathrm{s}^{-1}$。\n\n这些频率的总和是：\n$$\nS = \\frac{|v_x|}{\\Delta x} + \\frac{|v_y|}{\\Delta y} + \\frac{|v_s|}{\\Delta s} = (4 \\times 10^3 + 1.2 \\times 10^4 + 1 \\times 10^6)\\,\\mathrm{s}^{-1}\n$$\n$$\nS = (0.004 \\times 10^6 + 0.012 \\times 10^6 + 1.0 \\times 10^6)\\,\\mathrm{s}^{-1} = 1.016 \\times 10^6\\,\\mathrm{s}^{-1}\n$$\n最大稳定时间步长是这个总和的倒数：\n$$\n\\Delta t_{max} = \\frac{1}{S} = \\frac{1}{1.016 \\times 10^6\\,\\mathrm{s}^{-1}} \\approx 9.84252 \\times 10^{-7}\\,\\mathrm{s}\n$$\n问题指定使用安全因子$\\sigma = 0.80$来确定生产计算时间步长$\\Delta t_{prod}$：\n$$\n\\Delta t_{prod} = \\sigma \\cdot \\Delta t_{max} = 0.80 \\times \\frac{1}{1.016 \\times 10^6\\,\\mathrm{s}^{-1}}\n$$\n$$\n\\Delta t_{prod} \\approx 0.80 \\times 9.84252 \\times 10^{-7}\\,\\mathrm{s} \\approx 7.874016 \\times 10^{-7}\\,\\mathrm{s}\n$$\n最后，我们将此结果四舍五入到4位有效数字：\n$$\n\\Delta t_{prod} \\approx 7.874 \\times 10^{-7}\\,\\mathrm{s}\n$$",
            "answer": "$$\\boxed{7.874 \\times 10^{-7}}$$"
        }
    ]
}