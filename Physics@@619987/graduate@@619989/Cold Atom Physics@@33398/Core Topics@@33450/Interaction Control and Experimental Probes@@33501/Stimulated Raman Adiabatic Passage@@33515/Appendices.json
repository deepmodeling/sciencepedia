{"hands_on_practices": [{"introduction": "The extraordinary efficiency of Stimulated Raman Adiabatic Passage (STIRAP) stems from a subtle quantum interference effect that creates a 'dark state'. Before delving into the mathematical formalism, it is crucial to build a qualitative understanding of this process. This exercise challenges you to visualize the population flow in a three-level $\\Lambda$-system during an ideal STIRAP transfer, helping you to grasp why this technique is so powerful and fundamentally different from a simple sequential transfer. [@problem_id:2025912]", "problem": "An atomic system is modeled using three quantum states, denoted $|1\\rangle$, $|2\\rangle$, and $|3\\rangle$. States $|1\\rangle$ and $|3\\rangle$ are long-lived, nearly degenerate ground states, while state $|2\\rangle$ is an unstable excited state, forming a so-called $\\Lambda$-system. The goal is to transfer the entire atomic population from state $|1\\rangle$ to state $|3\\rangle$ efficiently.\n\nTo achieve this, a technique known as Stimulated Raman Adiabatic Passage (STIRAP) is employed. This method uses two coherent laser pulses: a \"pump\" pulse with a time-dependent Rabi frequency $\\Omega_P(t)$ that couples states $|1\\rangle$ and $|2\\rangle$, and a \"Stokes\" pulse with Rabi frequency $\\Omega_S(t)$ that couples states $|2\\rangle$ and $|3\\rangle$. The system is initially prepared entirely in state $|1\\rangle$. The STIRAP protocol requires a \"counter-intuitive\" pulse sequence, where the Stokes pulse partially precedes the pump pulse.\n\nLet $P_1(t)$, $P_2(t)$, and $P_3(t)$ represent the populations in states $|1\\rangle$, $|2\\rangle$, and $|3\\rangle$ as a function of time, respectively. Assume the process is ideal, meaning the evolution is perfectly adiabatic and there are no sources of decoherence or population loss.\n\nWhich of the following statements provides the most accurate description of the time evolution of the populations during this ideal STIRAP process?\n\nA. The pump pulse transfers the population from state $|1\\rangle$ to state $|2\\rangle$, after which the Stokes pulse transfers the population from state $|2\\rangle$ to state $|3\\rangle$. At an intermediate time, the population resides almost entirely in state $|2\\rangle$.\n\nB. Population is coherently transferred from state $|1\\rangle$ to state $|3\\rangle$ such that the population of state $|2\\rangle$ remains zero throughout the entire process. The population of state $|1\\rangle$ decreases monotonically, while the population of state $|3\\rangle$ increases monotonically until the transfer is complete.\n\nC. The system undergoes rapid Rabi oscillations involving all three states. The populations $P_1(t)$, $P_2(t)$, and $P_3(t)$ oscillate significantly with time, and a complete population transfer to state $|3\\rangle$ is not achieved.\n\nD. The population is transferred from $|1\\rangle$ to $|3\\rangle$, but the system must briefly populate state $|2\\rangle$ for the transfer to occur. Consequently, $P_2(t)$ exhibits a transient, non-zero peak during the pulse overlap region before returning to zero.", "solution": "We model the three-level system in the rotating-wave approximation on exact two-photon resonance. In the ordered basis $\\{|1\\rangle,|2\\rangle,|3\\rangle\\}$ and for zero one-photon detuning, the Hamiltonian reads\n$$\nH(t)=\\frac{\\hbar}{2}\\begin{pmatrix}\n0 & \\Omega_{P}(t) & 0\\\\\n\\Omega_{P}(t) & 0 & \\Omega_{S}(t)\\\\\n0 & \\Omega_{S}(t) & 0\n\\end{pmatrix}.\n$$\nWe seek an instantaneous eigenstate with no population in $|2\\rangle$ (the dark state). Make the ansatz\n$$\n|D(t)\\rangle=\\cos\\theta(t)\\,|1\\rangle-\\sin\\theta(t)\\,|3\\rangle,\n$$\nwith a mixing angle $\\theta(t)$ to be determined. Acting with $H(t)$ on $|D(t)\\rangle$ gives\n$$\nH(t)|D(t)\\rangle=\\frac{\\hbar}{2}\\left[\\Omega_{P}(t)\\cos\\theta(t)-\\Omega_{S}(t)\\sin\\theta(t)\\right]|2\\rangle.\n$$\nRequiring $|D(t)\\rangle$ to be an eigenstate with zero projection on $|2\\rangle$ implies\n$$\n\\Omega_{P}(t)\\cos\\theta(t)-\\Omega_{S}(t)\\sin\\theta(t)=0\\quad\\Rightarrow\\quad \\tan\\theta(t)=\\frac{\\Omega_{P}(t)}{\\Omega_{S}(t)}.\n$$\nThus $|D(t)\\rangle$ is a zero-eigenvalue eigenstate (dark state) with identically zero amplitude in $|2\\rangle$.\n\nUnder the adiabatic theorem, if the system is initially prepared in $|D(t_{i})\\rangle$ and the parameters $\\Omega_{P}(t)$ and $\\Omega_{S}(t)$ vary slowly enough to satisfy the adiabatic condition\n$$\n|\\dot{\\theta}(t)|\\ll \\Omega_{\\text{eff}}(t),\\quad \\Omega_{\\text{eff}}(t)=\\sqrt{\\Omega_{P}^{2}(t)+\\Omega_{S}^{2}(t)},\n$$\nthen the state vector remains in $|D(t)\\rangle$ up to a phase, without populating orthogonal eigenstates.\n\nFor the counter-intuitive sequence of STIRAP, the Stokes pulse precedes the pump, so initially $\\Omega_{P}(t_{i})=0$ while $\\Omega_{S}(t_{i})\\neq 0$. Hence\n$$\n\\tan\\theta(t_{i})=0\\;\\Rightarrow\\;\\theta(t_{i})=0\\;\\Rightarrow\\;|D(t_{i})\\rangle=|1\\rangle,\n$$\nwhich matches the initial preparation. At the end of the sequence, the fields are arranged so that $\\Omega_{S}(t_{f})\\to 0$ while $\\Omega_{P}(t_{f})\\neq 0$, yielding\n$$\n\\tan\\theta(t_{f})\\to \\infty\\;\\Rightarrow\\;\\theta(t_{f})\\to \\frac{\\pi}{2}\\;\\Rightarrow\\;|D(t_{f})\\rangle=-|3\\rangle.\n$$\nTherefore, under ideal adiabatic following, the time-dependent populations are\n$$\nP_{1}(t)=|\\langle 1|D(t)\\rangle|^{2}=\\cos^{2}\\theta(t),\\quad P_{3}(t)=|\\langle 3|D(t)\\rangle|^{2}=\\sin^{2}\\theta(t),\\quad P_{2}(t)=|\\langle 2|D(t)\\rangle|^{2}=0,\n$$\nwith $\\theta(t)$ changing monotonically from $0$ to $\\pi/2$ under the counter-intuitive pulse ordering. Hence $P_{1}(t)$ decreases monotonically from $1$ to $0$, $P_{3}(t)$ increases monotonically from $0$ to $1$, and $P_{2}(t)$ remains zero throughout.\n\nThis matches statement B. Statements A and D incorrectly assert transient population in $|2\\rangle$, which is absent in the ideal (perfectly adiabatic, decoherence-free) limit. Statement C describes nonadiabatic dynamics incompatible with ideal STIRAP and does not yield complete transfer.", "answer": "$$\\boxed{B}$$", "id": "2025912"}, {"introduction": "To truly understand STIRAP, we must move from a qualitative picture to a quantitative analysis based on the system's Hamiltonian. The dynamics are best understood in the basis of 'dressed states', which are the instantaneous eigenstates of the atom-light interaction Hamiltonian. This problem presents a specific scenario of simultaneous, identical pump and Stokes pulses, a case that is analytically tractable and provides invaluable practice in diagonalizing the Hamiltonian and calculating the final state populations from first principles. [@problem_id:1269145]", "problem": "A three-level atom, with states $|1\\rangle$, $|2\\rangle$, and $|3\\rangle$ arranged in a $\\Lambda$-configuration, is used for population transfer from state $|1\\rangle$ to state $|3\\rangle$ via Stimulated Raman Adiabatic Passage (STIRAP). The transition $|1\\rangle \\leftrightarrow |2\\rangle$ is driven by a pump laser with time-dependent Rabi frequency $\\Omega_P(t)$, and the transition $|2\\rangle \\leftrightarrow |3\\rangle$ is driven by a Stokes laser with Rabi frequency $\\Omega_S(t)$.\n\nIn the rotating wave approximation (RWA), the Hamiltonian for this system is given by:\n$$\nH(t) = \\frac{\\hbar}{2}\n\\begin{pmatrix}\n0 & \\Omega_P(t) & 0 \\\\\n\\Omega_P(t) & -2\\Delta & \\Omega_S(t) \\\\\n0 & \\Omega_S(t) & 0\n\\end{pmatrix}\n$$\nwhere $\\Delta$ is the one-photon detuning from the excited state $|2\\rangle$. We assume the system is on two-photon resonance.\n\nConsider a non-standard STIRAP scenario where the one-photon detuning is zero ($\\Delta=0$), and the pump and Stokes laser pulses are applied simultaneously with identical, time-dependent shapes. That is, $\\Omega_P(t) = \\Omega_S(t) = \\Omega(t)$ for all time $t$. The pulse $\\Omega(t)$ is non-zero only during a finite time interval, and its shape is such that the total pulse area is $A = \\int_{-\\infty}^{\\infty} \\Omega(t') dt'$.\n\nThe atom is initially in the ground state $|1\\rangle$ at $t \\to -\\infty$, i.e., $|\\psi(-\\infty)\\rangle = |1\\rangle$.\n\nCalculate the final population transfer efficiency to state $|3\\rangle$, defined as $P_3 = |\\langle 3|\\psi(+\\infty) \\rangle|^2$. Express your answer as a function of the total pulse area $A$.", "solution": "The problem asks for the final population in state $|3\\rangle$ for a three-level system under specific pulse conditions.\n\n1.  **Simplify the Hamiltonian:**\n    Given the conditions $\\Delta=0$ and $\\Omega_P(t) = \\Omega_S(t) = \\Omega(t)$, the Hamiltonian becomes:\n    $$\n    H(t) = \\frac{\\hbar \\Omega(t)}{2}\n    \\begin{pmatrix}\n    0 & 1 & 0 \\\\\n    1 & 0 & 1 \\\\\n    0 & 1 & 0\n    \\end{pmatrix}\n    $$\n    This Hamiltonian can be written as $H(t) = \\Omega(t) H_0$, where $H_0 = \\frac{\\hbar}{2} \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}$ is a time-independent matrix.\n\n2.  **Find Eigenstates and Eigenvalues:**\n    Since the spatial part of the Hamiltonian $H_0$ is time-independent, its eigenvectors (the \"dressed states\") are also time-independent. The eigenvalues will be proportional to $\\Omega(t)$. We find the eigenvalues $E$ by solving the characteristic equation $\\det(H_0 - \\frac{E}{\\Omega(t)} I) = 0$. Let $\\lambda = E / (\\hbar \\Omega(t))$.\n    $$\n    \\det \\begin{pmatrix}\n    -\\frac{\\lambda\\hbar}{2} & \\hbar/2 & 0 \\\\\n    \\hbar/2 & -\\frac{\\lambda\\hbar}{2} & \\hbar/2 \\\\\n    0 & \\hbar/2 & -\\frac{\\lambda\\hbar}{2}\n    \\end{pmatrix} = \\left(\\frac{\\hbar}{2}\\right)^3 \\det \\begin{pmatrix}\n    -\\lambda & 1 & 0 \\\\\n    1 & -\\lambda & 1 \\\\\n    0 & 1 & -\\lambda\n    \\end{pmatrix} = 0\n    $$\n    $-\\lambda(\\lambda^2 - 1) - 1(-\\lambda) = 0$\n    $-\\lambda^3 + \\lambda + \\lambda = 0 \\implies \\lambda^3 - 2\\lambda = 0$\n    $\\lambda(\\lambda^2 - 2) = 0$.\n    The solutions are $\\lambda_0 = 0$, $\\lambda_+ = \\sqrt{2}$, and $\\lambda_- = -\\sqrt{2}$.\n    The corresponding time-dependent eigenvalues are:\n    $E_0(t) = 0$\n    $E_+(t) = \\frac{\\hbar\\Omega(t)}{\\sqrt{2}}$\n    $E_-(t) = -\\frac{\\hbar\\Omega(t)}{\\sqrt{2}}$\n\n    Now, we find the corresponding normalized eigenvectors $|\\psi_0\\rangle$, $|\\psi_+\\rangle$, $|\\psi_-\\rangle$.\n    For $E_0=0$ (the dark state):\n    $H_0 \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = 0 \\implies c_2=0, c_1+c_3=0$.\n    Normalized, $|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle - |3\\rangle)$.\n\n    For $E_+ = \\hbar\\Omega(t)/\\sqrt{2}$:\n    $H_0 \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\frac{\\hbar\\Omega(t)}{\\sqrt{2}} \\frac{1}{\\Omega(t)} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\frac{\\hbar}{\\sqrt{2}} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix}$.\n    $\\frac{\\hbar}{2} c_2 = \\frac{\\hbar}{\\sqrt{2}} c_1 \\implies c_2 = \\sqrt{2}c_1$.\n    $\\frac{\\hbar}{2} (c_1+c_3) = \\frac{\\hbar}{\\sqrt{2}} c_2 = \\hbar c_1 \\implies c_1+c_3 = 2c_1 \\implies c_3=c_1$.\n    The eigenvector is proportional to $(1, \\sqrt{2}, 1)^T$. Normalized: $|\\psi_+\\rangle = \\frac{1}{2}(|1\\rangle + \\sqrt{2}|2\\rangle + |3\\rangle)$.\n\n    For $E_- = -\\hbar\\Omega(t)/\\sqrt{2}$:\n    A similar calculation yields $c_2 = -\\sqrt{2}c_1$ and $c_3=c_1$.\n    The eigenvector is proportional to $(1, -\\sqrt{2}, 1)^T$. Normalized: $|\\psi_-\\rangle = \\frac{1}{2}(|1\\rangle - \\sqrt{2}|2\\rangle + |3\\rangle)$.\n\n3.  **Decompose the Initial State:**\n    The system starts in $|\\psi(-\\infty)\\rangle = |1\\rangle$. We project this onto the time-independent eigenbasis:\n    $|1\\rangle = \\alpha_0|\\psi_0\\rangle + \\alpha_+|\\psi_+\\rangle + \\alpha_-|\\psi_-\\rangle$.\n    $\\alpha_0 = \\langle\\psi_0|1\\rangle = \\frac{1}{\\sqrt{2}}$.\n    $\\alpha_+ = \\langle\\psi_+|1\\rangle = \\frac{1}{2}$.\n    $\\alpha_- = \\langle\\psi_-|1\\rangle = \\frac{1}{2}$.\n    So, the initial state is $|\\psi(-\\infty)\\rangle = \\frac{1}{\\sqrt{2}}|\\psi_0\\rangle + \\frac{1}{2}|\\psi_+\\rangle + \\frac{1}{2}|\\psi_-\\rangle$.\n\n4.  **Time Evolution:**\n    Since the dressed states are time-independent, the solution to the Schrödinger equation $i\\hbar \\frac{d}{dt}|\\psi(t)\\rangle = H(t)|\\psi(t)\\rangle$ is a straightforward superposition of the evolving eigenstates. An eigenstate $|\\psi_k\\rangle$ evolves as $|\\psi_k(t)\\rangle = \\exp\\left(-\\frac{i}{\\hbar}\\int_{-\\infty}^t E_k(t') dt'\\right)|\\psi_k\\rangle$.\n    The state at $t \\to +\\infty$ is:\n    $$\n    |\\psi(+\\infty)\\rangle = \\alpha_0 e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_0 dt'}|\\psi_0\\rangle + \\alpha_+ e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_+(t') dt'}|\\psi_+\\rangle + \\alpha_- e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_-(t') dt'}|\\psi_-\\rangle\n    $$\n    The phase integrals are:\n    $\\int_{-\\infty}^\\infty E_0(t') dt' = 0$.\n    $\\int_{-\\infty}^\\infty E_\\pm(t') dt' = \\pm \\frac{\\hbar}{\\sqrt{2}}\\int_{-\\infty}^\\infty \\Omega(t') dt' = \\pm \\frac{\\hbar A}{\\sqrt{2}}$.\n    Substituting these into the expression for $|\\psi(+\\infty)\\rangle$:\n    $$\n    |\\psi(+\\infty)\\rangle = \\frac{1}{\\sqrt{2}}|\\psi_0\\rangle + \\frac{1}{2} e^{-i A/\\sqrt{2}} |\\psi_+\\rangle + \\frac{1}{2} e^{i A/\\sqrt{2}} |\\psi_-\\rangle\n    $$\n\n5.  **Calculate Final Population in State |3>:**\n    We need to compute $P_3 = |\\langle 3|\\psi(+\\infty) \\rangle|^2$. First, we find the amplitude $\\langle 3|\\psi(+\\infty) \\rangle$.\n    $\\langle 3|\\psi_0\\rangle = -1/\\sqrt{2}$\n    $\\langle 3|\\psi_+\\rangle = 1/2$\n    $\\langle 3|\\psi_-\\rangle = 1/2$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = \\frac{1}{\\sqrt{2}}\\langle 3|\\psi_0\\rangle + \\frac{1}{2} e^{-i A/\\sqrt{2}} \\langle 3|\\psi_+\\rangle + \\frac{1}{2} e^{i A/\\sqrt{2}} \\langle 3|\\psi_-\\rangle\n    $$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = \\frac{1}{\\sqrt{2}}\\left(-\\frac{1}{\\sqrt{2}}\\right) + \\frac{1}{2} e^{-i A/\\sqrt{2}} \\left(\\frac{1}{2}\\right) + \\frac{1}{2} e^{i A/\\sqrt{2}} \\left(\\frac{1}{2}\\right)\n    $$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = -\\frac{1}{2} + \\frac{1}{4}\\left(e^{-i A/\\sqrt{2}} + e^{i A/\\sqrt{2}}\\right)\n    $$\n    Using Euler's formula, $\\cos(x) = (e^{ix}+e^{-ix})/2$:\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = -\\frac{1}{2} + \\frac{1}{2}\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) = \\frac{1}{2}\\left(\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) - 1\\right)\n    $$\n    Now we calculate the probability $P_3$:\n    $$\n    P_3 = \\left| \\frac{1}{2}\\left(\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) - 1\\right) \\right|^2 = \\frac{1}{4}\\left(1 - \\cos\\left(\\frac{A}{\\sqrt{2}}\\right)\\right)^2\n    $$\n    Using the half-angle identity $1-\\cos(x) = 2\\sin^2(x/2)$:\n    $$\n    P_3 = \\frac{1}{4}\\left(2\\sin^2\\left(\\frac{A}{2\\sqrt{2}}\\right)\\right)^2 = \\frac{1}{4} \\left(4\\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)\\right)\n    $$\n    $$\n    P_3 = \\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)\n    $$\n    This is the final population transfer efficiency.", "answer": "$$\n\\boxed{\\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)}\n$$", "id": "1269145"}, {"introduction": "While analytical models provide deep insights, they are often limited to idealized conditions. To explore the full behavior of STIRAP under realistic conditions—including imperfect timing, detunings, and non-adiabatic effects—we turn to computational physics. This practice guides you in building a numerical simulator to solve the time-dependent Schrödinger equation, transforming your computer into a virtual laboratory for exploring quantum control and verifying the principles learned in the previous exercises. [@problem_id:2421268]", "problem": "You are to write a complete, runnable program that numerically solves the time-dependent Schrödinger equation for a three-level quantum system undergoing Stimulated Raman Adiabatic Passage (STIRAP). The goal is to compute the final population transferred to a target state for several parameter sets. You must use a principled time-dependent Hamiltonian description and a norm-preserving time-stepping scheme.\n\nStart from the fundamental law that the state vector evolves according to the time-dependent Schrödinger equation\n$$\ni\\hbar \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle .\n$$\nWork in units with reduced Planck constant set to unity, that is, set $\\hbar = 1$, so the governing equation is\n$$\ni \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle .\n$$\nConsider a three-level system with basis states $|1\\rangle$, $|2\\rangle$, and $|3\\rangle$ in a lambda configuration. In the Rotating Wave Approximation (RWA), and in a frame where the rapidly oscillating terms are removed, the Hamiltonian is taken to be\n$$\n\\hat{H}(t) =\n\\begin{pmatrix}\n0 & \\Omega_{\\mathrm{p}}(t)/2 & 0 \\\\\n\\Omega_{\\mathrm{p}}(t)/2 & \\Delta & \\Omega_{\\mathrm{s}}(t)/2 \\\\\n0 & \\Omega_{\\mathrm{s}}(t)/2 & \\delta\n\\end{pmatrix},\n$$\nwhere $\\Omega_{\\mathrm{p}}(t)$ is the pump Rabi frequency coupling $|1\\rangle \\leftrightarrow |2\\rangle$, $\\Omega_{\\mathrm{s}}(t)$ is the Stokes Rabi frequency coupling $|3\\rangle \\leftrightarrow |2\\rangle$, $\\Delta$ is the one-photon detuning of the intermediate state $|2\\rangle$, and $\\delta$ is the two-photon detuning between $|1\\rangle$ and $|3\\rangle$. The Rabi frequencies are time-dependent Gaussian pulses,\n$$\n\\Omega_{\\mathrm{p}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{p}})^2}{2\\sigma^2}\\right), \\quad\n\\Omega_{\\mathrm{s}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{s}})^2}{2\\sigma^2}\\right),\n$$\nwith common peak amplitude $\\Omega_{0}$, temporal width $\\sigma$, and pulse centers $t_{\\mathrm{p}}$ and $t_{\\mathrm{s}}$. In the counter-intuitive STIRAP sequence, the Stokes pulse precedes the pump pulse, meaning $t_{\\mathrm{s}} < t_{\\mathrm{p}}$.\n\nYou must:\n- Explicitly propagate the state vector by numerically integrating the time-dependent Schrödinger equation using a unitary, norm-preserving time-stepping scheme based on the matrix exponential of the Hamiltonian evaluated at the midpoint of each time step. That is, over a small time step $\\Delta t$ from $t$ to $t+\\Delta t$, use\n$$\n|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\!\\left(-i\\, \\hat{H}\\!\\left(t+\\frac{\\Delta t}{2}\\right)\\,\\Delta t\\right)\\,|\\psi(t)\\rangle .\n$$\n- Initialize the state at $t=t_{0}$ in $|1\\rangle$, that is, $|\\psi(t_{0})\\rangle = (1,0,0)^{\\mathsf{T}}$.\n- Use angular frequencies in radians per second for $\\Omega_{0}$, $\\Delta$, and $\\delta$, and seconds for time-related quantities. All computations must consistently use these units.\n- Choose a total simulation interval $[t_{0},t_{\\mathrm{f}}]$ wide enough that both pulses are negligible at the endpoints. A robust choice is $t_{0} = -6\\sigma - \\frac{\\tau}{2}$ and $t_{\\mathrm{f}} = +6\\sigma + \\frac{\\tau}{2}$, where $\\tau = |t_{\\mathrm{p}} - t_{\\mathrm{s}}|$ is the pulse separation. Use a fixed time step $\\Delta t$ sufficiently small to resolve both the pulse envelope and the fastest coherent dynamics.\n\nYour program must implement the following test suite of parameter sets. In each case, report the final population in $|3\\rangle$, given by $P_{3}(t_{\\mathrm{f}}) = |\\langle 3|\\psi(t_{\\mathrm{f}})\\rangle|^{2}$, as a floating-point number. Use the specified units and definitions.\n\nCommon definitions for all tests:\n- Let the Gaussian width be $\\sigma$ as specified per case.\n- Let the pulse separation be $\\tau = 2\\sigma$.\n- For the counter-intuitive order, set $t_{\\mathrm{s}} = -\\tau/2$ and $t_{\\mathrm{p}} = +\\tau/2$.\n- For the intuitive order, set $t_{\\mathrm{p}} = -\\tau/2$ and $t_{\\mathrm{s}} = +\\tau/2$.\n- Use a fixed step size $\\Delta t$ that satisfies $\\Delta t \\le \\min\\!\\left(\\frac{\\sigma}{200}, \\frac{1}{20\\,\\Omega_{0}}\\right)$.\n\nTest cases to implement:\n- Case $1$ (well-behaved STIRAP): $\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive order, $\\Delta = 0$, $\\delta = 0$.\n- Case $2$ (intuitive ordering, poor transfer): same as Case $1$ but intuitive order.\n- Case $3$ (non-adiabatic due to short pulses): $\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 5\\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive order, $\\Delta = 0$, $\\delta = 0$.\n- Case $4$ (one-photon detuning robustness): $\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive order, $\\Delta = 2\\pi \\times 50\\times 10^{6}\\ \\mathrm{rad/s}$, $\\delta = 0$.\n- Case $5$ (two-photon detuning sensitivity): $\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive order, $\\Delta = 0$, $\\delta = 2\\pi \\times 5\\times 10^{6}\\ \\mathrm{rad/s}$.\n\nAngle units, if any phases are considered, must be in radians. All physical quantities are to be treated in the specified units.\n\nRequired output:\n- Your program should produce a single line of output containing the final populations $P_{3}(t_{\\mathrm{f}})$ for Cases $1$ through $5$ in order, each rounded to exactly six decimal places, as a comma-separated list enclosed in square brackets. For example, output like $[0.999500,0.010000,0.450000,0.980000,0.600000]$.\n\nYour solution must be a single, complete program. It must not require any user input or external files. It must use a rigorous numerical method grounded in the above principles. The final answers are dimensionless populations in the unit interval $\\left[0,1\\right]$ expressed as decimals rounded to six decimal places.", "solution": "The problem statement has been subjected to a rigorous validation process.\n\n**Step 1: Extracted Givens**\n- **Governing Equation**: $i \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle$, with $\\hbar = 1$.\n- **Hamiltonian**: \n$$\n\\hat{H}(t) =\n\\begin{pmatrix}\n0 & \\Omega_{\\mathrm{p}}(t)/2 & 0 \\\\\n\\Omega_{\\mathrm{p}}(t)/2 & \\Delta & \\Omega_{\\mathrm{s}}(t)/2 \\\\\n0 & \\Omega_{\\mathrm{s}}(t)/2 & \\delta\n\\end{pmatrix}\n$$\n- **Rabi Frequencies**: $\\Omega_{\\mathrm{p}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{p}})^2}{2\\sigma^2}\\right)$, $\\Omega_{\\mathrm{s}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{s}})^2}{2\\sigma^2}\\right)$.\n- **Initial Condition**: $|\\psi(t_{0})\\rangle = (1,0,0)^{\\mathsf{T}}$.\n- **Numerical Method**: $|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\!\\left(-i\\, \\hat{H}\\!\\left(t+\\frac{\\Delta t}{2}\\right)\\,\\Delta t\\right)\\,|\\psi(t)\\rangle$.\n- **Simulation Time Interval**: $[t_{0}, t_{\\mathrm{f}}]$, with $t_{0} = -6\\sigma - \\frac{\\tau}{2}$ and $t_{\\mathrm{f}} = +6\\sigma + \\frac{\\tau}{2}$, where $\\tau = |t_{\\mathrm{p}} - t_{\\mathrm{s}}|$.\n- **Time Step**: $\\Delta t \\le \\min\\!\\left(\\frac{\\sigma}{200}, \\frac{1}{20\\,\\Omega_{0}}\\right)$.\n- **Pulse Timing**: $\\tau = 2\\sigma$. Counter-intuitive: $t_{\\mathrm{s}} = -\\tau/2$, $t_{\\mathrm{p}} = +\\tau/2$. Intuitive: $t_{\\mathrm{p}} = -\\tau/2$, $t_{\\mathrm{s}} = +\\tau/2$.\n- **Test Cases**:\n    1. Case 1: $\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive, $\\Delta = 0$, $\\delta = 0$.\n    2. Case 2: Same as Case 1 but intuitive order.\n    3. Case 3: $\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 5 \\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive, $\\Delta = 0$, $\\delta = 0$.\n    4. Case 4: $\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive, $\\Delta = 2\\pi \\times 50 \\times 10^{6}\\ \\mathrm{rad/s}$, $\\delta = 0$.\n    5. Case 5: $\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$, $\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$, counter-intuitive, $\\Delta = 0$, $\\delta = 2\\pi \\times 5 \\times 10^{6}\\ \\mathrm{rad/s}$.\n- **Required Output**: Final population $P_{3}(t_{\\mathrm{f}}) = |\\langle 3|\\psi(t_{\\mathrm{f}})\\rangle|^{2}$ for each case, rounded to six decimal places, in a specified list format.\n\n**Step 2: Validation Verdict**\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It describes a standard problem in computational quantum physics with all necessary parameters and methods clearly specified. There are no logical contradictions, factual inaccuracies, or ambiguities. The parameter values are physically realistic for atomic systems.\n\n**Verdict: The problem is valid.**\n\nWe proceed with the solution. The task is to integrate the time-dependent Schrödinger equation, a first-order linear ordinary differential equation for the state vector $|\\psi(t)\\rangle$:\n$$\n\\frac{d}{dt}|\\psi(t)\\rangle = -i \\hat{H}(t)|\\psi(t)\\rangle\n$$\nThe formal solution over a time interval from $t$ to $t+\\Delta t$ is given by $|\\psi(t+\\Delta t)\\rangle = \\hat{U}(t+\\Delta t, t)|\\psi(t)\\rangle$, where $\\hat{U}(t+\\Delta t, t)$ is the time-evolution operator. For a time-dependent Hamiltonian, this operator is given by the time-ordered exponential $\\hat{U}(t+\\Delta t, t) = \\mathcal{T} \\exp(-i \\int_t^{t+\\Delta t} \\hat{H}(t') dt')$.\n\nThe problem specifies a particular approximation for the propagator which is equivalent to a second-order Magnus expansion or a midpoint rule applied to the Hamiltonian within the integral:\n$$\n\\int_t^{t+\\Delta t} \\hat{H}(t') dt' \\approx \\hat{H}\\left(t+\\frac{\\Delta t}{2}\\right) \\Delta t\n$$\nThis results in the time-stepping formula:\n$$\n|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\left(-i \\hat{H}\\left(t+\\frac{\\Delta t}{2}\\right) \\Delta t\\right) |\\psi(t)\\rangle\n$$\nThis propagator is unitary, which guarantees that the norm of the state vector, $||\\psi(t)||^2$, is conserved throughout the simulation. This is a crucial physical requirement, as the total probability must remain unity.\n\nThe algorithm is implemented as follows:\n1.  **Initialization**: The system parameters for a given test case ($\\Omega_0$, $\\sigma$, $\\Delta$, $\\delta$, and pulse order) are defined. From these, the pulse timings $t_{\\mathrm{p}}$ and $t_{\\mathrm{s}}$, the simulation interval $[t_0, t_f]$, and the time step $\\Delta t$ are computed according to the specified formulae. The state vector is initialized in the state $|1\\rangle$, represented by the column vector $|\\psi(t_0)\\rangle = [1, 0, 0]^{\\mathsf{T}}$.\n\n2.  **Discretization**: The time interval $[t_0, t_f]$ is discretized into a series of points $t_k = t_0 + k \\Delta t$, where $k = 0, 1, 2, \\dots, N-1$, and $N \\Delta t \\approx t_f - t_0$.\n\n3.  **Time Evolution**: The state vector is evolved iteratively. For each step from time $t_k$ to $t_{k+1} = t_k + \\Delta t$:\n    a. The midpoint time $t_{k+1/2} = t_k + \\Delta t/2$ is calculated.\n    b. The time-dependent Rabi frequencies $\\Omega_{\\mathrm{p}}(t_{k+1/2})$ and $\\Omega_{\\mathrm{s}}(t_{k+1/2})$ are evaluated.\n    c. The Hamiltonian matrix $\\hat{H}(t_{k+1/2})$ is constructed using these frequencies and the given detunings $\\Delta$ and $\\delta$.\n    d. The unitary evolution operator for the step, $\\hat{U}_k = \\exp(-i \\hat{H}(t_{k+1/2}) \\Delta t)$, is computed using a matrix exponential function. This is the most computationally intensive part of the step.\n    e. The state vector is updated: $|\\psi(t_{k+1})\\rangle = \\hat{U}_k |\\psi(t_k)\\rangle$.\n\n4.  **Final Measurement**: After the final time step, the simulation yields the state vector at the final time, $|\\psi(t_f)\\rangle = [c_1(t_f), c_2(t_f), c_3(t_f)]^{\\mathsf{T}}$. The desired output, the population in state $|3\\rangle$, is then calculated as the squared magnitude of its amplitude: $P_3(t_f) = |c_3(t_f)|^2$.\n\nThis procedure is repeated for all five test cases. The resulting final populations are formatted as specified. The implementation uses numerical libraries capable of handling complex matrix algebra and matrix exponentiation efficiently.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the STIRAP problem for all test cases.\n    \"\"\"\n\n    def run_simulation(omega0, sigma, pulse_order, delta_one_photon, delta_two_photon):\n        \"\"\"\n        Numerically solves the TDSE for a single STIRAP parameter set.\n\n        Args:\n            omega0 (float): Peak Rabi frequency in rad/s.\n            sigma (float): Temporal width of Gaussian pulses in s.\n            pulse_order (str): 'counter-intuitive' or 'intuitive'.\n            delta_one_photon (float): One-photon detuning Delta in rad/s.\n            delta_two_photon (float): Two-photon detuning delta in rad/s.\n\n        Returns:\n            float: Final population in state |3>.\n        \"\"\"\n        # Define pulse separation and centers\n        tau = 2.0 * sigma\n        if pulse_order == 'counter-intuitive':\n            t_s = -tau / 2.0\n            t_p = tau / 2.0\n        elif pulse_order == 'intuitive':\n            t_p = -tau / 2.0\n            t_s = tau / 2.0\n        else:\n            raise ValueError(\"Invalid pulse_order specified.\")\n\n        # Set up simulation time grid\n        t0 = -6.0 * sigma - tau / 2.0\n        tf = 6.0 * sigma + tau / 2.0\n        dt = min(sigma / 200.0, 1.0 / (20.0 * omega0))\n        time_points = np.arange(t0, tf, dt)\n\n        # Initialize state vector |psi(t0)> = |1> = [1, 0, 0]^T\n        psi = np.array([1.0, 0.0, 0.0], dtype=np.complex128)\n\n        # Define Gaussian pulse shapes for pump and Stokes lasers\n        def omega_p(t):\n            return omega0 * np.exp(-(t - t_p)**2 / (2.0 * sigma**2))\n\n        def omega_s(t):\n            return omega0 * np.exp(-(t - t_s)**2 / (2.0 * sigma**2))\n\n        # Main time-stepping loop\n        for t in time_points:\n            t_mid = t + dt / 2.0\n\n            # Evaluate Rabi frequencies at the midpoint of the time step\n            omega_p_mid = omega_p(t_mid)\n            omega_s_mid = omega_s(t_mid)\n\n            # Construct the Hamiltonian matrix at the midpoint\n            h_mid = np.array([\n                [0.0, omega_p_mid / 2.0, 0.0],\n                [omega_p_mid / 2.0, delta_one_photon, omega_s_mid / 2.0],\n                [0.0, omega_s_mid / 2.0, delta_two_photon]\n            ], dtype=np.complex128)\n\n            # Compute the unitary time-evolution operator using matrix exponential\n            U = expm(-1j * h_mid * dt)\n\n            # Update the state vector\n            psi = U @ psi\n\n        # Calculate the final population in state |3>\n        p3_final = np.abs(psi[2])**2\n        return p3_final\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (well-behaved STIRAP): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, Delta=0, delta=0\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 2 (intuitive ordering, poor transfer): same as Case 1 but intuitive\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 3 (non-adiabatic due to short pulses): Omega0=2pi*15MHz, sigma=5ns, counter-intuitive\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 5e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 4 (one-photon detuning robustness): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, Delta=2pi*50MHz\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 2.0 * np.pi * 50e6, 'delta_two_photon': 0.0},\n        # Case 5 (two-photon detuning sensitivity): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, delta=2pi*5MHz\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 2.0 * np.pi * 5e6},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2421268"}]}