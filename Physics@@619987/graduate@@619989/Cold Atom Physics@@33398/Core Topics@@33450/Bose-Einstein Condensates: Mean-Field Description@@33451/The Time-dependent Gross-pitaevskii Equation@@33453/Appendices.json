{"hands_on_practices": [{"introduction": "The time-dependent Gross-Pitaevskii equation (TDGPE) governs not only the static ground state but also the rich dynamics of a Bose-Einstein condensate. The simplest form of dynamics arises from small fluctuations around equilibrium. This exercise demonstrates how linearizing the TDGPE reveals the spectrum of elementary excitations, and how in the long-wavelength limit, these excitations behave like sound waves with a well-defined speed. Calculating this speed of sound provides a crucial link between the microscopic interaction parameter $g$ and a macroscopic, measurable property of the quantum fluid. [@problem_id:1235560]", "problem": "A weakly interacting Bose-Einstein Condensate (BEC) of bosonic atoms is well-described at the mean-field level by the Gross-Pitaevskii theory. Elementary excitations above the condensate ground state can be analyzed by linearizing the time-dependent Gross-Pitaevskii equation, which leads to the Bogoliubov-de Gennes equations.\n\nFor a uniform BEC with condensate number density $n_0$, the dispersion relation for these elementary excitations (Bogoliubov modes) is given by:\n$$\n\\hbar \\omega_k = \\sqrt{\\epsilon_k (\\epsilon_k + 2 g n_0)}\n$$\nwhere $k$ is the wavevector of the excitation, $\\omega_k$ is its angular frequency, $\\hbar$ is the reduced Planck constant, and $\\epsilon_k = \\frac{\\hbar^2 k^2}{2m}$ is the kinetic energy of a free particle of mass $m$. The parameter $g$ represents the strength of the contact interaction between atoms.\n\nIn the long-wavelength limit (i.e., for small $k$), the dispersion relation becomes linear, $\\omega_k \\approx c_s k$. This behavior is characteristic of sound waves, and the coefficient $c_s$ is identified as the speed of sound in the condensate.\n\nConsider a BEC formed by $N$ atoms, each with mass $m$. The atoms are confined within a three-dimensional cubic box of side length $L$, resulting in a volume $V = L^3$. We assume the condensate is sufficiently dilute and uniform, with a number density $n_0 = N/V$. The interatomic interactions are repulsive and are characterized by a positive s-wave scattering length $a_s$. The interaction strength $g$ is related to $a_s$ by $g = \\frac{4 \\pi \\hbar^2 a_s}{m}$.\n\nUsing the provided Bogoliubov dispersion relation, determine the speed of sound, $c_s$, for this uniform BEC. Express your answer as a closed-form analytical expression in terms of $N$, $m$, $L$, $a_s$, and $\\hbar$.", "solution": "We start from the Bogoliubov dispersion for a uniform BEC,\n$$\n\\hbar \\omega_k \\;=\\;\\sqrt{\\epsilon_k\\,\\bigl(\\epsilon_k+2g\\,n_0\\bigr)},\n\\qquad\n\\epsilon_k=\\frac{\\hbar^2k^2}{2m}, \n\\;\\;n_0=\\frac{N}{L^3},\n\\;\\;g=\\frac{4\\pi\\hbar^2a_s}{m}.\n$$\nIn the long-wavelength limit $k\\to0$, we have $\\epsilon_k\\ll2g\\,n_0$, so\n$$\n\\hbar\\omega_k\\approx\\sqrt{\\epsilon_k\\,(2g\\,n_0)}\n=\\sqrt{2g\\,n_0\\,\\frac{\\hbar^2k^2}{2m}}\n=\\hbar k\\sqrt{\\frac{g\\,n_0}{m}}.\n$$\nThus the excitation frequency is linear in $k$,\n$$\n\\omega_k\\approx c_s\\,k,\n\\qquad\nc_s=\\sqrt{\\frac{g\\,n_0}{m}}.\n$$\nSubstituting $g=\\frac{4\\pi\\hbar^2a_s}{m}$ and $n_0=\\frac{N}{L^3}$ gives\n$$\nc_s=\\sqrt{\\frac{1}{m}\\,\\frac{4\\pi\\hbar^2a_s}{m}\\,\\frac{N}{L^3}}\n=\\sqrt{\\frac{4\\pi\\hbar^2a_sN}{m^2L^3}}\n=\\frac{\\hbar}{m}\\,\\sqrt{\\frac{4\\pi a_sN}{L^3}}.\n$$", "answer": "$$\\boxed{\\frac{\\hbar}{m}\\,\\sqrt{\\frac{4\\pi\\,a_s\\,N}{L^3}}}$$", "id": "1235560"}, {"introduction": "Beyond small oscillations, the TDGPE describes the large-scale collective motion of the entire condensate cloud. A classic experimental probe of BEC dynamics is to release the atoms from their magnetic trap and observe their subsequent free expansion. This practice explores how a powerful approximation, the scaling ansatz, can be used to model this expansion. By reducing the complexity of the partial differential equation to a set of coupled ordinary differential equations, you can predict the fascinating anisotropic dynamics, a hallmark phenomenon in early BEC experiments. [@problem_id:1276650]", "problem": "A cigar-shaped Bose-Einstein condensate (BEC) containing a large number of atoms is initially held in thermal equilibrium in an anisotropic harmonic trap. The trapping potential is given by $V_{ext}(\\mathbf{r}) = \\frac{1}{2}m(\\omega_\\rho^2(x^2+y^2) + \\omega_z^2 z^2)$, where $m$ is the mass of a single atom and the trapping frequencies satisfy $\\omega_z \\ll \\omega_\\rho$.\n\nIn the limit of a large number of atoms (the Thomas-Fermi regime), the ground state density profile has a parabolic shape. At time $t=0$, the harmonic trap is abruptly switched off, and the condensate begins to expand freely.\n\nThe evolution of the condensate's shape can be accurately described by a scaling ansatz, where the Thomas-Fermi radii in the radial ($\\rho$) and axial ($z$) directions, $R_\\rho(t)$ and $R_z(t)$, evolve as $R_\\rho(t) = R_\\rho(0)\\lambda_\\rho(t)$ and $R_z(t)=R_z(0)\\lambda_z(t)$. The dimensionless scaling parameters, $\\lambda_i(t)$, obey the following coupled differential equations:\n$$ \\ddot{\\lambda}_\\rho = \\frac{\\omega_\\rho^2}{\\lambda_\\rho^3 \\lambda_z} $$\n$$ \\ddot{\\lambda}_z = \\frac{\\omega_z^2}{\\lambda_\\rho^2 \\lambda_z^2} $$\nThe initial conditions, corresponding to release from the stationary ground state, are $\\lambda_\\rho(0) = 1$, $\\lambda_z(0) = 1$, $\\dot{\\lambda}_\\rho(0) = 0$, and $\\dot{\\lambda}_z(0) = 0$.\n\nThe aspect ratio of the condensate is defined as $A(t) = R_z(t)/R_\\rho(t)$. In the Thomas-Fermi regime, the initial radii are related to the trapping frequencies by $R_i(0) \\propto 1/\\omega_i$.\n\nCalculate the initial acceleration of the aspect ratio, $\\ddot{A}(0)$, immediately after the trap is turned off. Express your answer in terms of the trapping frequencies $\\omega_\\rho$ and $\\omega_z$.", "solution": "1. The aspect ratio is \n$$A(t)=\\frac{R_z(t)}{R_\\rho(t)}\n=\\frac{R_z(0)\\,\\lambda_z(t)}{R_\\rho(0)\\,\\lambda_\\rho(t)}\n=\\frac{R_z(0)}{R_\\rho(0)}\\frac{\\lambda_z}{\\lambda_\\rho}\\,. $$\nIn the Thomas–Fermi regime $R_i(0)\\propto1/\\omega_i$, so \n$$\\frac{R_z(0)}{R_\\rho(0)}=\\frac{\\omega_\\rho}{\\omega_z}\\,. $$\n\n2. Thus \n$$A(t)=\\frac{\\omega_\\rho}{\\omega_z}\\,\\frac{\\lambda_z}{\\lambda_\\rho}\\,. $$\n\n3. Compute the second derivative at $t=0$.  With \n$$A=\\beta\\frac{\\lambda_z}{\\lambda_\\rho},\\quad\\beta=\\frac{\\omega_\\rho}{\\omega_z},$$ \nwe have \n$$\\dot A=\\beta\\frac{\\dot\\lambda_z\\,\\lambda_\\rho-\\lambda_z\\,\\dot\\lambda_\\rho}\n{\\lambda_\\rho^2},$$\nand since $\\lambda_i(0)=1,\\;\\dot\\lambda_i(0)=0$, it follows $\\dot A(0)=0$.  Then\n$$\\ddot A(0)\n=\\beta\\Big[\\ddot\\lambda_z(0)-\\ddot\\lambda_\\rho(0)\\Big]\\,. $$\n\n4. From the scaling equations,\n$$\\ddot\\lambda_\\rho=\\frac{\\omega_\\rho^2}{\\lambda_\\rho^3\\lambda_z},\\quad\n\\ddot\\lambda_z=\\frac{\\omega_z^2}{\\lambda_\\rho^2\\lambda_z^2},$$\nso at $t=0$ ($\\lambda_\\rho=\\lambda_z=1$),\n$$\\ddot\\lambda_\\rho(0)=\\omega_\\rho^2,\\quad\n\\ddot\\lambda_z(0)=\\omega_z^2.$$\n\n5. Therefore,\n$$\\ddot A(0)\n=\\frac{\\omega_\\rho}{\\omega_z}\\bigl(\\omega_z^2-\\omega_\\rho^2\\bigr)\\,. $$", "answer": "$$\\boxed{\\frac{\\omega_\\rho}{\\omega_z}\\bigl(\\omega_z^2-\\omega_\\rho^2\\bigr)}$$", "id": "1276650"}, {"introduction": "While analytical approximations provide immense physical insight, the full power of the TDGPE is often unlocked through numerical simulation. This exercise introduces the split-operator method, a cornerstone algorithm for solving the time-dependent Schrödinger-like equations. Here, you will implement this method to find the ground state of a BEC by evolving the system in imaginary time, a robust technique for energy minimization. Mastering this \"hands-on\" computational approach is essential for exploring the GPE in complex potentials or studying dynamics far from equilibrium. [@problem_id:2441319]", "problem": "You are to implement a complete, runnable program that adapts the split-operator (time-splitting spectral) method to the nonlinear Gross-Pitaevskii equation in one spatial dimension, where the effective potential depends on the evolving wavefunction. Your task is to compute the chemical potential of the stationary state obtained by normalized imaginary-time propagation for a small test suite of cases, and to output the results on a single line in a specified format.\n\nStart from the time-dependent Gross-Pitaevskii equation in one dimension, in dimensionless units with reduced Planck constant equal to unity and particle mass equal to unity, i.e., $\\hbar = 1$ and $m = 1$:\n$$\n\\mathrm{i}\\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V_{\\mathrm{ext}}(x) \\;+\\; g\\,|\\psi(x,t)|^2 \\right] \\psi(x,t).\n$$\nEvolve in imaginary time to obtain the stationary ground state by replacing $t$ with $-\\,\\mathrm{i}\\,\\tau$ and enforcing normalization of the wavefunction after each time step so that $\\int |\\psi(x,\\tau)|^2\\,\\mathrm{d}x = 1$. Use a second-order accurate symmetric split-operator scheme that alternates between the kinetic operator in Fourier space and the combined external plus nonlinear potential in real space. Use periodic boundary conditions consistent with the discrete Fourier transform on a finite domain.\n\nFor a given final normalized state $\\psi(x)$, compute the chemical potential $\\mu$ of the stationary solution using its definition implied by the stationary Gross-Pitaevskii equation,\n$$\n\\mu\\,\\psi(x) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V_{\\mathrm{ext}}(x) \\;+\\; g\\,|\\psi(x)|^2 \\right]\\psi(x),\n$$\nand express $\\mu$ as a scalar computed from $\\psi(x)$ and its gradient. All integrals must be approximated by appropriate Riemann sums on the numerical grid, and spatial derivatives required for the kinetic contribution must be computed in a manner consistent with the Fourier representation on the chosen grid.\n\nAll quantities are in dimensionless units, so your program must output the chemical potentials in dimensionless energy units.\n\nImplement your program for the following test suite of parameter sets, all in one spatial dimension:\n- Case A (linear harmonic oscillator, baseline check):\n  - External potential $V_{\\mathrm{ext}}(x) = \\tfrac{1}{2}\\,\\omega^2 x^2$ with $\\omega = 1.0$.\n  - Interaction strength $g = 0.0$.\n  - Domain length $L = 20.0$ with periodic boundary conditions and $N = 512$ grid points, so that $\\Delta x = L/N$.\n  - Imaginary-time step $\\Delta \\tau = 0.001$ and number of steps $N_{\\mathrm{steps}} = 2500$.\n  - Initial wavefunction: normalized Gaussian $\\psi(x,0) \\propto \\exp\\!\\big(-x^2/(2\\sigma^2)\\big)$ with $\\sigma = 1.0$, normalized to $\\int |\\psi(x,0)|^2\\,\\mathrm{d}x = 1$.\n- Case B (repulsive nonlinear harmonic oscillator):\n  - External potential $V_{\\mathrm{ext}}(x) = \\tfrac{1}{2}\\,\\omega^2 x^2$ with $\\omega = 1.0$.\n  - Interaction strength $g = 1.0$.\n  - Domain length $L = 20.0$ with periodic boundary conditions and $N = 512$ grid points.\n  - Imaginary-time step $\\Delta \\tau = 0.001$ and number of steps $N_{\\mathrm{steps}} = 2500$.\n  - Initial wavefunction: normalized Gaussian with $\\sigma = 1.0$, normalized to unity.\n- Case C (periodic box, uniform stationary state):\n  - External potential $V_{\\mathrm{ext}}(x) = 0$.\n  - Interaction strength $g = 2.0$.\n  - Domain length $L = 10.0$ with periodic boundary conditions and $N = 512$ grid points.\n  - Imaginary-time step $\\Delta \\tau = 0.001$ and number of steps $N_{\\mathrm{steps}} = 10$.\n  - Initial wavefunction: uniform $\\psi(x,0) = 1/\\sqrt{L}$ so that it is exactly normalized.\n\nYour program must:\n- Use a symmetric split-operator scheme of second order in the imaginary-time step to propagate to the final time for each case, normalizing after each time step to maintain $\\int |\\psi|^2\\,\\mathrm{d}x = 1$.\n- Compute the chemical potential $\\mu$ for each case from the final normalized state.\n- Produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, for example, $\\texttt{[0.500000,1.234567,0.200000]}$, with each value rounded to $6$ decimal places.\n\nConstraints and implementation details:\n- Spatial grid: $x_j = x_{\\min} + j\\,\\Delta x$ with $x_{\\min} = -L/2$, $j = 0,1,\\dots,N-1$, and $\\Delta x = L/N$.\n- Wavenumbers: $k$-grid consistent with the discrete Fourier transform and periodic boundary conditions must be used for kinetic steps and spectral derivatives.\n- The algorithm must be fully self-contained and must not read any input.\n- Your program must compute and return the chemical potentials for the three cases above in the required output format.\n\nYour final program must be a complete, runnable script that prints only one line: a single list in the format $\\texttt{[}\\mu_A,\\mu_B,\\mu_C\\texttt{]}$ with each entry rounded to $6$ decimal places.", "solution": "The problem requires the implementation of a numerical algorithm to find the stationary ground state of the one-dimensional Gross-Pitaevskii equation (GPE) and compute its associated chemical potential, $\\mu$. The method specified is imaginary-time propagation using a second-order symmetric split-operator scheme.\n\nThe time-dependent GPE is given as:\n$$\n\\mathrm{i}\\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\hat{H}\\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V_{\\mathrm{ext}}(x) \\;+\\; g\\,|\\psi(x,t)|^2 \\right] \\psi(x,t)\n$$\nwhere the mass $m$ and reduced Planck constant $\\hbar$ are set to $1$. The Hamiltonian $\\hat{H}$ is composed of a kinetic energy operator, $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$, and a potential energy operator, $\\hat{V}(x, \\psi) = V_{\\mathrm{ext}}(x) + g\\,|\\psi(x,t)|^2$, which includes a term dependent on the wavefunction density itself.\n\nTo find the ground state, we employ the method of imaginary-time evolution. This is achieved by the substitution $t \\to -i\\tau$, transforming the Schrödinger equation into a diffusion-type equation in the imaginary-time variable $\\tau$:\n$$\n\\frac{\\partial \\psi(x,\\tau)}{\\partial \\tau} \\;=\\; -\\hat{H}\\psi(x,\\tau)\n$$\nThe formal solution to this equation over a small time step $\\Delta\\tau$ is $\\psi(x, \\tau+\\Delta\\tau) = e^{-\\hat{H}\\Delta\\tau}\\psi(x,\\tau)$. When an arbitrary initial state is propagated using this rule, components corresponding to higher-energy eigenstates decay more rapidly than the ground state component. By repeatedly applying the evolution operator and renormalizing the wavefunction at each step, the state converges to the ground state, which is the eigenstate of $\\hat{H}$ with the lowest eigenvalue.\n\nThe evolution operator $e^{-\\hat{H}\\Delta\\tau} = e^{-(\\hat{T} + \\hat{V})\\Delta\\tau}$ is difficult to compute directly because the kinetic operator $\\hat{T}$ and potential operator $\\hat{V}$ do not commute ($\\left[\\hat{T}, \\hat{V}\\right] \\neq 0$). The split-operator method approximates the evolution by separating the kinetic and potential propagations. A second-order accurate symmetric splitting, also known as the Strang splitting, is employed:\n$$\ne^{-(\\hat{T} + \\hat{V})\\Delta\\tau} \\approx e^{-\\hat{V}\\Delta\\tau/2} \\, e^{-\\hat{T}\\Delta\\tau} \\, e^{-\\hat{V}\\Delta\\tau/2} + O(\\Delta\\tau^3)\n$$\nThis scheme is implemented algorithmically for a single time step from $\\tau$ to $\\tau + \\Delta\\tau$:\n\n1.  **Potential Half-Step:** The wavefunction is first propagated under the potential operator for a half-step $\\Delta\\tau/2$. This operation is local in position space and amounts to a simple multiplication. For the nonlinear GPE, the potential must be calculated using the current state $\\psi(x,\\tau)$:\n    $$\n    \\psi'(x) = e^{-(V_{\\mathrm{ext}}(x) + g|\\psi(x,\\tau)|^2)\\Delta\\tau/2} \\psi(x,\\tau)\n    $$\n2.  **Kinetic Full-Step:** The kinetic energy operator $\\hat{T}$ is local in momentum (or $k$) space. The propagation is most efficiently performed using the Fast Fourier Transform (FFT). The state $\\psi'(x)$ is transformed to Fourier space, $\\tilde{\\psi}'(k) = \\mathcal{F}\\{\\psi'(x)\\}$. In this basis, the kinetic operator is diagonal, $\\hat{T}_k = k^2/2$, so the propagation is a multiplication:\n    $$\n    \\tilde{\\psi}''(k) = e^{-k^2\\Delta\\tau/2} \\tilde{\\psi}'(k)\n    $$\n    The result is then transformed back to position space: $\\psi''(x) = \\mathcal{F}^{-1}\\{\\tilde{\\psi}''(k)\\}$. The wavevector grid $k_j$ must be consistent with the spatial grid $x_j$, which is achieved using the `fftfreq` function, where $k_j = 2\\pi f_j$ and $f_j$ are the discrete frequencies. For a spatial domain of length $L$ with $N$ points and grid spacing $\\Delta x = L/N$, the wavevectors are $k = 2\\pi \\cdot \\texttt{fftfreq}(N, d=\\Delta x)$.\n\n3.  **Potential Half-Step (Second):** A final propagation under the potential operator for another half-step $\\Delta\\tau/2$ completes the symmetric step. The potential is recalculated using the updated wavefunction $\\psi''(x)$ to ensure symmetry and stability:\n    $$\n    \\psi(x, \\tau+\\Delta\\tau)_{\\text{un-norm}} = e^{-(V_{\\mathrm{ext}}(x) + g|\\psi''(x)|^2)\\Delta\\tau/2} \\psi''(x)\n    $$\n4.  **Normalization:** Since imaginary-time evolution does not conserve the norm, the wavefunction must be renormalized after each full step to maintain the physical constraint $\\int |\\psi|^2 dx = 1$. The integral is approximated by a Riemann sum: $I = \\sum_j |\\psi_j|^2 \\Delta x$. The wavefunction is then updated as $\\psi_j \\to \\psi_j / \\sqrt{I}$.\n\nAfter a sufficient number of steps, $N_{\\mathrm{steps}}$, the wavefunction $\\psi(x)$ converges to the stationary ground state. The chemical potential $\\mu$ is the eigenvalue corresponding to this state, defined by the stationary GPE: $\\hat{H}\\psi(x) = \\mu\\psi(x)$. The value of $\\mu$ is computed as the expectation value of the Hamiltonian with respect to the final normalized state:\n$$\n\\mu = \\langle \\psi | \\hat{H} | \\psi \\rangle = \\int \\psi^*(x) \\hat{H} \\psi(x) \\, dx\n$$\nThis expectation value is the sum of three energy contributions:\n- **Kinetic Energy:** $E_{kin} = \\int \\psi^*(x) \\left(-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}\\right) \\psi(x) \\, dx$. This is computed efficiently in Fourier space: $E_{kin} = \\int \\tilde{\\psi}^*(k) \\left(\\frac{k^2}{2}\\right) \\tilde{\\psi}(k) \\, dk$. Numerically, this is $\\sum_j |\\tilde{\\psi}_j|^2 \\frac{k_j^2}{2}$ (with appropriate FFT normalization) or, more directly, by applying the kinetic operator to $\\psi$ and computing the inner product: $E_{kin} \\approx \\Delta x \\sum_j \\psi_j^* \\mathcal{F}^{-1}\\{ (k^2/2) \\mathcal{F}\\{\\psi_j\\} \\}$.\n- **External Potential Energy:** $E_{pot, ext} = \\int V_{\\mathrm{ext}}(x) |\\psi(x)|^2 \\, dx$. This is approximated by the sum $\\Delta x \\sum_j V_{\\mathrm{ext}}(x_j) |\\psi_j|^2$.\n- **Interaction Energy:** $E_{int} = \\int g |\\psi(x)|^4 \\, dx$. This is approximated by the sum $\\Delta x \\sum_j g |\\psi_j|^4$.\n\nThe chemical potential is the sum $\\mu = E_{kin} + E_{pot, ext} + E_{int}$. The algorithm is applied to each of the three test cases specified, yielding their respective chemical potentials.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft, ifft, fftfreq\n\ndef compute_mu(params):\n    \"\"\"\n    Computes the chemical potential for a given Gross-Pitaevskii equation setup\n    using imaginary-time propagation with a split-operator method.\n\n    Args:\n        params (dict): A dictionary containing all simulation parameters:\n            - L (float): Domain length.\n            - N (int): Number of grid points.\n            - g (float): Interaction strength.\n            - V_ext_func (callable): Function for the external potential V_ext(x).\n            - dt (float): Imaginary time step (delta_tau).\n            - N_steps (int): Number of propagation steps.\n            - psi0_func (callable): Function for the initial wavefunction psi(x, 0).\n\n    Returns:\n        float: The computed chemical potential, mu.\n    \"\"\"\n    # Unpack parameters\n    L = params[\"L\"]\n    N = params[\"N\"]\n    g = params[\"g\"]\n    V_ext_func = params[\"V_ext_func\"]\n    dt = params[\"dt\"]\n    N_steps = params[\"N_steps\"]\n    psi0_func = params[\"psi0_func\"]\n\n    # 1. Setup spatial and momentum grids\n    dx = L / N\n    x = np.linspace(-L / 2, L / 2 - dx, N)\n    k = 2 * np.pi * fftfreq(N, d=dx)\n\n    # 2. Setup kinetic operator and time-evolution propagators\n    T_k = 0.5 * k**2\n    kinetic_propagator = np.exp(-T_k * dt)\n    V_ext = V_ext_func(x)\n\n    # 3. Setup initial wavefunction and normalize it\n    psi = psi0_func(x).astype(np.complex128)\n    norm_sq = np.sum(np.abs(psi)**2) * dx\n    psi = psi / np.sqrt(norm_sq)\n\n    # 4. Imaginary time evolution loop\n    for _ in range(N_steps):\n        # Symmetric split-operator step: V/2, T, V/2\n        \n        # First half-step in potential\n        V_eff = V_ext + g * np.abs(psi)**2\n        psi *= np.exp(-V_eff * dt / 2.0)\n\n        # Full step in kinetic energy (in Fourier space)\n        psi_k = fft(psi)\n        psi_k *= kinetic_propagator\n        psi = ifft(psi_k)\n\n        # Second half-step in potential\n        V_eff = V_ext + g * np.abs(psi)**2\n        psi *= np.exp(-V_eff * dt / 2.0)\n\n        # Renormalize the wavefunction after the full step\n        norm_sq = np.sum(np.abs(psi)**2) * dx\n        psi /= np.sqrt(norm_sq)\n\n    # 5. Calculate the chemical potential mu from the final stationary state\n    # mu = psi|H|psi = T + V_ext + V_int\n    \n    # Kinetic energy expectation value\n    psi_k = fft(psi)\n    T_psi = ifft(T_k * psi_k)\n    E_kin = np.sum(np.conj(psi) * T_psi).real * dx\n    \n    # External potential energy expectation value\n    E_pot_ext = np.sum(V_ext * np.abs(psi)**2).real * dx\n    \n    # Interaction energy expectation value\n    E_int = np.sum(g * np.abs(psi)**4).real * dx\n    \n    mu = E_kin + E_pot_ext + E_int\n\n    return mu\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Linear harmonic oscillator (g=0)\n        {\n            \"L\": 20.0, \"N\": 512, \"g\": 0.0, \"omega\": 1.0, \"sigma\": 1.0,\n            \"dt\": 0.001, \"N_steps\": 2500,\n            \"V_ext_func\": lambda x, w=1.0: 0.5 * w**2 * x**2,\n            \"psi0_func\": lambda x, s=1.0: np.exp(-x**2 / (2 * s**2))\n        },\n        # Case B: Repulsive nonlinear harmonic oscillator (g0)\n        {\n            \"L\": 20.0, \"N\": 512, \"g\": 1.0, \"omega\": 1.0, \"sigma\": 1.0,\n            \"dt\": 0.001, \"N_steps\": 2500,\n            \"V_ext_func\": lambda x, w=1.0: 0.5 * w**2 * x**2,\n            \"psi0_func\": lambda x, s=1.0: np.exp(-x**2 / (2 * s**2))\n        },\n        # Case C: Periodic box, uniform state\n        {\n            \"L\": 10.0, \"N\": 512, \"g\": 2.0,\n            \"dt\": 0.001, \"N_steps\": 10,\n            \"V_ext_func\": lambda x: np.zeros_like(x),\n            \"psi0_func\": lambda x, L=10.0: np.full_like(x, 1.0 / np.sqrt(L))\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        mu = compute_mu(case_params)\n        results.append(mu)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2441319"}]}