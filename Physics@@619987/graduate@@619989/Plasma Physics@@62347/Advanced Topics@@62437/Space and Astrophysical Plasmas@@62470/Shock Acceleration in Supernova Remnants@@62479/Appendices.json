{"hands_on_practices": [{"introduction": "The theory of diffusive shock acceleration (DSA) provides a powerful mechanism for understanding how particles, like cosmic rays, are accelerated to tremendous energies in astrophysical environments. A fundamental question in this process is: how fast does it happen? This exercise guides you through the derivation of the characteristic acceleration time, a crucial parameter that quantifies the efficiency of the DSA mechanism. By relating macroscopic shock properties, such as fluid speeds, to the microscopic physics of particle diffusion, you will build a foundational understanding of the engine driving particle acceleration in supernova remnants [@problem_id:326348].", "problem": "A test particle, such as a cosmic ray proton, with speed $v$ is being accelerated at a planar, non-relativistic, steady-state shock front. In the rest frame of the shock, the upstream fluid flows into the shock at speed $u_1$, and the downstream fluid flows away at speed $u_2$. The particle's motion is governed by diffusion, with a diffusion coefficient $D_1$ in the upstream region and $D_2$ in the downstream region. It is assumed that the particle's speed is much greater than the fluid speeds, i.e., $v \\gg u_1, u_2$.\n\nThe acceleration process, known as diffusive shock acceleration, relies on the particle repeatedly crossing the shock front. A full \"cycle\" consists of the particle crossing from upstream to downstream, diffusing in the downstream region, returning to the shock, crossing into the upstream region, diffusing, and finally returning to the shock front to begin the next cycle.\n\nThe average fractional energy gain per cycle is given by:\n$$\n\\langle \\frac{\\Delta E}{E} \\rangle = \\frac{4}{3v}(u_1 - u_2)\n$$\n\nThe characteristic acceleration time, $t_{acc}$, is defined as the time for the particle's energy to increase by a factor of $e$, which is given by $t_{acc} = \\left(\\frac{1}{E}\\frac{dE}{dt}\\right)^{-1}$. The rate of energy gain can be approximated as $\\frac{dE}{dt} \\approx \\frac{\\langle \\Delta E \\rangle}{T_{cycle}}$, where $T_{cycle}$ is the average time to complete one cycle.\n\nBy calculating the average residence time a particle spends in the upstream and downstream regions during one cycle, derive the characteristic acceleration time $t_{acc}$. Express your answer in terms of $u_1, u_2, D_1$, and $D_2$.", "solution": "1. Relevant equations:\n   - Average fractional energy gain per cycle:\n     $$ \\left\\langle\\frac{\\Delta E}{E}\\right\\rangle = \\frac{4}{3v}(u_1-u_2) $$\n   - Definition of acceleration time:\n     $$ t_{\\mathrm{acc}} = \\left(\\frac{1}{E}\\frac{dE}{dt}\\right)^{-1} $$\n   - Approximate energy gain rate:\n     $$ \\frac{dE}{dt} \\approx \\frac{\\langle\\Delta E\\rangle}{T_{\\mathrm{cycle}}} = E \\frac{\\langle\\Delta E/E\\rangle}{T_{\\mathrm{cycle}}} $$\n\n2. Therefore\n   $$ \\frac{1}{E}\\frac{dE}{dt} = \\frac{\\langle\\Delta E/E\\rangle}{T_{\\mathrm{cycle}}} \\quad\\Longrightarrow\\quad t_{\\mathrm{acc}} = \\frac{T_{\\mathrm{cycle}}}{\\langle\\Delta E/E\\rangle} $$\n\n3. Cycle time is the sum of residence times upstream and downstream. For isotropic diffusion with $v\\gg u_i$, the mean residence time in region $i$ is\n   $$ t_i = \\frac{4D_i}{v u_i} $$\n   so\n   $$ T_{\\mathrm{cycle}} = t_1 + t_2 = \\frac{4D_1}{v u_1} + \\frac{4D_2}{v u_2} $$\n\n4. Substitute into $t_{\\mathrm{acc}}$:\n   $$ t_{\\mathrm{acc}} = \\frac{\\frac{4D_1}{v u_1}+\\frac{4D_2}{v u_2}}{\\frac{4}{3v}(u_1-u_2)} = \\frac{3v}{4(u_1-u_2)}\\left(\\frac{4D_1}{v u_1}+\\frac{4D_2}{v u_2}\\right) = \\frac{3}{u_1-u_2}\\left(\\frac{D_1}{u_1}+\\frac{D_2}{u_2}\\right) $$", "answer": "$$\\boxed{\\frac{3}{u_1-u_2}\\left(\\frac{D_1}{u_1}+\\frac{D_2}{u_2}\\right)}$$", "id": "326348"}, {"introduction": "One of the most celebrated successes of diffusive shock acceleration theory is its natural prediction of a power-law energy spectrum for accelerated particles, a feature widely observed in cosmic rays. This practice explores the origin of this spectral shape by balancing the energy gain per shock-crossing cycle against the probability of escape. To mirror more realistic astrophysical conditions, this problem introduces a hypothetical energy loss term, allowing you to investigate how competition between acceleration and energy loss processes modifies the resulting particle energy spectrum, a key diagnostic tool for astronomers [@problem_id:326144].", "problem": "In the standard test-particle model of diffusive shock acceleration (DSA), charged particles are accelerated to high energies by repeatedly crossing a shock front. Consider a strong, non-relativistic, planar shock moving through a plasma. In the rest frame of the shock, the upstream fluid flows into the shock with speed $u_1$ and the downstream fluid flows away with speed $u_2$. The compression ratio of the shock is defined as $r = u_1/u_2$.\n\nIt is assumed that the accelerated particles are relativistic ($v \\approx c$) and have an isotropic pitch-angle distribution. Within this framework, two key quantities determine the resulting particle energy spectrum:\n1.  The average fractional energy gain per acceleration cycle (a cycle consists of a particle crossing from upstream to downstream and back), given by $\\beta_{gain} = \\frac{4}{3} \\frac{u_1 - u_2}{c}$.\n2.  The probability of a particle escaping the acceleration region by being advected downstream per cycle, given by $P_{esc} = \\frac{4 u_2}{c}$.\n\nIn the standard, lossless DSA model, these processes lead to a differential energy spectrum $n(E) \\propto E^{-p}$, where $p$ is the spectral index.\n\nNow, consider a modified scenario where the accelerated particles also suffer energy losses. Assume that during each acceleration cycle, in addition to the gain from the shock crossing, the particles lose a constant fraction, $\\eta$, of their energy. The net fractional energy change per cycle is thus a combination of the gain and the loss.\n\nLet $\\xi = \\eta / \\beta_{gain}$ be the dimensionless parameter that quantifies the strength of the energy loss relative to the energy gain per cycle. Assuming that both the energy gain and loss per cycle are small (i.e., $\\beta_{gain} \\ll 1$ and $\\eta \\ll 1$), derive the modified spectral index $p$ as a function of the shock compression ratio $r$ and the dimensionless loss parameter $\\xi$.", "solution": "We start from the standard relation for the differential energy spectrum in a cycle-based acceleration with escape probability $P_{\\mathrm{esc}}$ and net fractional energy gain per cycle $\\Delta\\equiv\\Delta E/E$:\n$$\np = 1 - \\frac{\\ln\\left(1 - P_{\\mathrm{esc}}\\right)}{\\ln\\left(1 + \\Delta\\right)}\n$$\nHere the net fractional gain is\n$$\n\\Delta = \\beta_{\\mathrm{gain}}-\\eta = \\beta_{\\mathrm{gain}}(1-\\xi)\n$$\nwith $\\xi=\\eta/\\beta_{\\mathrm{gain}}$. For small $P_{\\mathrm{esc}} \\ll 1$ and $\\Delta \\ll 1$ we use\n$$\n\\ln(1-P_{\\mathrm{esc}}) \\approx -P_{\\mathrm{esc}}, \n\\qquad\n\\ln(1+\\Delta) \\approx \\Delta,\n$$\nso that\n$$\np \\approx 1 + \\frac{P_{\\mathrm{esc}}}{\\Delta} = 1 + \\frac{P_{\\mathrm{esc}}}{\\beta_{\\mathrm{gain}}(1-\\xi)}\n$$\nSubstitute $P_{\\mathrm{esc}}=4u_2/c$ and $\\beta_{\\mathrm{gain}}=\\frac{4}{3}(u_1-u_2)/c$, and use $r=u_1/u_2$ so $u_1-u_2=u_2(r-1)$:\n$$\np = 1 + \\frac{4u_2/c}{\\left(\\frac{4}{3}(u_1-u_2)/c\\right)\\,(1-\\xi)} = 1 + \\frac{3u_2}{(u_1-u_2)(1-\\xi)} = 1 + \\frac{3}{(r-1)(1-\\xi)}\n$$", "answer": "$$\\boxed{1 + \\frac{3}{(r-1)(1 - \\xi)}}$$", "id": "326144"}, {"introduction": "Our previous explorations operated in the \"test-particle\" limit, assuming that accelerated particles are passive participants that don't influence their surroundings. In reality, a large population of cosmic rays can significantly alter the very shock environment that accelerates them. This advanced problem delves into this non-linear feedback loop, a frontier of modern astrophysics research. You will model how cosmic rays generate their own magnetic turbulence, which in turn governs their diffusion, leading to a self-regulated acceleration process that fundamentally differs from the simple test-particle picture [@problem_id:326190].", "problem": "Consider a one-dimensional model for the precursor of a strong supernova remnant shock. In this region, relativistic cosmic rays (CRs) stream ahead of the shock through a background plasma. This streaming generates magnetohydrodynamic waves, which in turn scatter the CRs, creating a self-regulated transport environment. Your task is to derive the non-linear diffusion coefficient that emerges from this feedback loop under the following assumptions.\n\nThe background plasma is characterized by a uniform magnetic field $B_0$ directed along the axis of propagation (the x-axis), an Alfven speed $v_A$, and an upstream flow speed $u_1$ towards the shock. We consider a representative population of CRs, which are protons with charge $e$ and a characteristic momentum $p_0$, moving at nearly the speed of light $c$. These CRs have a local pressure $P_{cr}$.\n\nThe physics of the interaction is governed by the following model:\n\n1.  **Wave Growth:** The streaming CRs create a pressure gradient $\\nabla P_{cr}$. This gradient does work on the background plasma, transferring energy to Alfven waves at a rate per unit volume given by $v_A |\\nabla P_{cr}|$.\n\n2.  **Wave Damping:** The primary mechanism for wave energy dissipation is a non-linear process (e.g., wave-wave interactions) that cascades energy to smaller scales. The damping rate for the total magnetic energy density of the waves, $W_B = \\frac{\\delta B^2}{8\\pi}$, is itself proportional to the wave energy density: $\\Gamma_d = \\alpha W_B$, where $\\alpha$ is a constant. The total energy loss rate per unit volume from damping is thus $2\\Gamma_d W_B$.\n\n3.  **Steady State:** In the shock precursor, a steady state is reached where the rate of wave energy growth is balanced by the rate of wave energy damping.\n\n4.  **CR Diffusion:** The CRs are scattered by the self-generated wave field $\\delta B$. The transport is described by a spatial diffusion coefficient, $\\kappa$. Assuming the wave power is concentrated in modes resonant with the characteristic momentum $p_0$, the diffusion coefficient is given by the quasi-linear relation:\n    $$ \\kappa = \\frac{1}{3} r_g c \\frac{B_0^2}{8\\pi W_B} $$\n    where $r_g = p_0 c / (e B_0)$ is the CR gyroradius.\n\n5.  **Precursor Structure:** In the steady-state shock precursor, the characteristic scale length of the CR pressure gradient, $L_{cr} = P_{cr}/|\\nabla P_{cr}|$, is determined by the balance between the advection of CRs into the shock at speed $u_1$ and their diffusion away from it. This balance dictates the relation $L_{cr} = \\kappa / u_1$.\n\nDerive the self-regulated diffusion coefficient, $\\kappa$, as a function of the background plasma parameters ($B_0$, $v_A$, $u_1$, $\\alpha$), CR parameters ($p_0$, $e$, $c$), and the local CR pressure $P_{cr}$.", "solution": "The goal is to derive an expression for the CR diffusion coefficient $\\kappa$. We will use the five physical assumptions provided to set up a system of equations and solve for $\\kappa$.\n\n**Step 1: Determine the steady-state wave energy density.**\nAccording to assumption 3, the wave energy growth rate equals the damping rate.\nFrom assumption 1, the energy growth rate per unit volume is:\n$$ \\dot{W}_{\\mathrm{growth}} = v_A |\\nabla P_{cr}| $$\nFrom assumption 2, the damping rate per unit volume is $2\\Gamma_d W_B$. With $\\Gamma_d = \\alpha W_B$, this becomes:\n$$ \\dot{W}_{\\mathrm{damp}} = 2(\\alpha W_B)W_B = 2\\alpha W_B^2 $$\nEquating the growth and damping rates for a steady state:\n$$ v_A |\\nabla P_{cr}| = 2\\alpha W_B^2 $$\nWe can solve this for the wave magnetic energy density $W_B$:\n$$ W_B = \\sqrt{\\frac{v_A |\\nabla P_{cr}|}{2\\alpha}} $$\n\n**Step 2: Relate the diffusion coefficient $\\kappa$ to the wave energy density $W_B$.**\nAssumption 4 provides the quasi-linear expression for $\\kappa$:\n$$ \\kappa = \\frac{1}{3} r_g c \\frac{B_0^2}{8\\pi W_B} $$\nWe can rearrange this to express $W_B$ in terms of $\\kappa$:\n$$ W_B = \\frac{r_g c B_0^2}{24\\pi \\kappa} $$\n\n**Step 3: Relate the CR pressure gradient $|\\nabla P_{cr}|$ to $\\kappa$ and $P_{cr}$.**\nAssumption 5 provides the relationship for the CR gradient scale length in the shock precursor: $L_{cr} = \\kappa / u_1$. The definition of the scale length is $L_{cr} = P_{cr}/|\\nabla P_{cr}|$.\nCombining these gives:\n$$ \\frac{P_{cr}}{|\\nabla P_{cr}|} = \\frac{\\kappa}{u_1} $$\nSolving for $|\\nabla P_{cr}|$, we find:\n$$ |\\nabla P_{cr}| = \\frac{u_1 P_{cr}}{\\kappa} $$\n\n**Step 4: Combine the equations to solve for $\\kappa$.**\nWe now have a closed system of equations. We can substitute the expressions for $W_B$ and $|\\nabla P_{cr}|$ into a single equation to find $\\kappa$. Let's start by equating the two expressions for $W_B$ from Step 1 and Step 2:\n$$ \\frac{r_g c B_0^2}{24\\pi \\kappa} = \\sqrt{\\frac{v_A |\\nabla P_{cr}|}{2\\alpha}} $$\nNow, substitute the expression for $|\\nabla P_{cr}|$ from Step 3 into this equation:\n$$ \\frac{r_g c B_0^2}{24\\pi \\kappa} = \\sqrt{\\frac{v_A}{2\\alpha} \\left( \\frac{u_1 P_{cr}}{\\kappa} \\right)} $$\nTo solve for $\\kappa$, we first square both sides of the equation:\n$$ \\left( \\frac{r_g c B_0^2}{24\\pi \\kappa} \\right)^2 = \\frac{v_A u_1 P_{cr}}{2\\alpha \\kappa} $$\n$$ \\frac{(r_g c B_0^2)^2}{(24\\pi)^2 \\kappa^2} = \\frac{v_A u_1 P_{cr}}{2\\alpha \\kappa} $$\nOne factor of $1/\\kappa$ cancels from both sides, assuming $\\kappa$ is non-zero:\n$$ \\frac{(r_g c B_0^2)^2}{(24\\pi)^2 \\kappa} = \\frac{v_A u_1 P_{cr}}{2\\alpha} $$\nNow we can isolate $\\kappa$:\n$$ \\kappa = \\frac{ (r_g c B_0^2)^2 }{ (24\\pi)^2 } \\frac{2\\alpha}{v_A u_1 P_{cr}} $$\n\n**Step 5: Substitute the expression for the gyroradius $r_g$ and simplify.**\nThe gyroradius is given as $r_g = p_0 c / (e B_0)$. Substituting this into the expression for $\\kappa$:\n$$ \\kappa = \\frac{ \\left( \\frac{p_0 c}{e B_0} c B_0^2 \\right)^2 }{ (24\\pi)^2 } \\frac{2\\alpha}{v_A u_1 P_{cr}} $$\n$$ \\kappa = \\frac{ \\left( \\frac{p_0 c^2 B_0}{e} \\right)^2 }{ 576\\pi^2 } \\frac{2\\alpha}{v_A u_1 P_{cr}} $$\n$$ \\kappa = \\frac{ \\frac{p_0^2 c^4 B_0^2}{e^2} }{ 576\\pi^2 } \\frac{2\\alpha}{v_A u_1 P_{cr}} $$\n$$ \\kappa = \\frac{p_0^2 c^4 B_0^2}{576\\pi^2 e^2} \\frac{2\\alpha}{v_A u_1 P_{cr}} $$\nFinally, simplifying the numerical factor gives the result:\n$$ \\kappa = \\frac{\\alpha p_0^2 c^4 B_0^2}{288 \\pi^2 e^2 v_A u_1 P_{cr}} $$\nThis is the final expression for the self-regulated diffusion coefficient. It shows that in this non-linear model, the diffusion coefficient is inversely proportional to the local CR pressure.", "answer": "$$ \\boxed{\\frac{\\alpha p_0^2 c^4 B_0^2}{288 \\pi^2 e^2 v_A u_1 P_{cr}}} $$", "id": "326190"}]}