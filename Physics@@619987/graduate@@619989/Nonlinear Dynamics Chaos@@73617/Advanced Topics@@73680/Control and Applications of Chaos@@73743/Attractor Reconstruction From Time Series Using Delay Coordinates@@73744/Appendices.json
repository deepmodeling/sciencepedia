{"hands_on_practices": [{"introduction": "The first critical step in reconstructing a system's phase space from a time series is choosing an appropriate time delay, $\\tau$. This parameter ensures that the coordinates of our reconstructed vectors, like $x(t)$ and $x(t-\\tau)$, are sufficiently independent to span the new space. One of the most common heuristics is to select the first time lag at which the signal's autocorrelation function drops to zero, indicating a loss of linear correlation. This exercise [@problem_id:854826] allows you to perform this fundamental calculation for a signal composed of two harmonics, providing direct practice in applying a cornerstone technique of time series analysis.", "problem": "In the study of nonlinear dynamical systems, a common technique for reconstructing the state space from a single time series observable $x(t)$ is the method of time-delay embedding. This method, supported by Takens' theorem, constructs a vector in a higher-dimensional space using delayed copies of the signal: $\\mathbf{X}(t) = (x(t), x(t-\\tau), x(t-2\\tau), \\dots, x(t-(m-1)\\tau))$. The choice of the time delay $\\tau$ is critical for a faithful reconstruction of the system's attractor.\n\nOne popular heuristic for selecting an optimal $\\tau$ is to choose the value corresponding to the first zero-crossing of the time series' autocorrelation function. This ensures that the coordinates $x(t)$ and $x(t-\\tau)$ are sufficiently independent.\n\nFor a continuous, zero-mean, periodic signal $x(t)$ with period $T$, the autocorrelation function is defined as:\n$$R_{xx}(\\tau) = \\frac{1}{T} \\int_0^T x(t) x(t+\\tau) \\,dt$$\n\nConsider the specific time series given by the superposition of two sinusoids:\n$$x(t) = A \\sin(\\omega t) + B \\sin(2\\omega t)$$\nwhere $A$, $B$, and $\\omega$ are positive real constants. This signal is periodic with period $T = 2\\pi/\\omega$ and has a mean value of zero.\n\nCalculate the smallest positive time delay $\\tau > 0$ for which the autocorrelation function $R_{xx}(\\tau)$ is zero.", "solution": "We have \n$$x(t)=A\\sin(\\omega t)+B\\sin(2\\omega t),\\quad T=\\frac{2\\pi}{\\omega}$$\nand the autocorrelation\n$$R_{xx}(\\tau)=\\frac{1}{T}\\int_0^T x(t)\\,x(t+\\tau)\\,dt.$$\n1. Expand the integrand and note that cross‐terms of different harmonics average to zero over one period.  Hence\n$$R_{xx}(\\tau)\n=\\frac{A^2}{T}\\int_0^T\\sin(\\omega t)\\sin[\\omega(t+\\tau)]\\,dt\n+\\frac{B^2}{T}\\int_0^T\\sin(2\\omega t)\\sin[2\\omega(t+\\tau)]\\,dt.$$\n2. Use the identity\n$$\\frac{1}{T}\\int_0^T\\sin(k t)\\sin[k(t+\\tau)]\\,dt=\\frac{1}{2}\\cos(k\\tau)$$\nfor integer $k$.  Thus\n$$R_{xx}(\\tau)\n=\\frac{A^2}{2}\\cos(\\omega\\tau)+\\frac{B^2}{2}\\cos(2\\omega\\tau).$$\n3. Set $R_{xx}(\\tau)=0$:\n$$A^2\\cos(\\omega\\tau)+B^2\\cos(2\\omega\\tau)=0.$$\n4. Use $\\cos(2\\theta)=2\\cos^2\\theta-1$ with $\\theta=\\omega\\tau$:\n$$A^2\\cos\\theta+B^2\\bigl(2\\cos^2\\theta-1\\bigr)=0\n\\;\\Rightarrow\\;2B^2c^2+A^2c-B^2=0,\\quad c=\\cos\\theta.$$\n5. Solve the quadratic in $c$:\n$$c=\\frac{-A^2\\pm\\sqrt{A^4+8B^4}}{4B^2}.$$\nOnly the root with “$+$” lies in $[-1,1]$.  Thus\n$$\\cos(\\omega\\tau)=\\frac{-A^2+\\sqrt{A^4+8B^4}}{4B^2}$$\nand the smallest positive solution is\n$$\\tau=\\frac{1}{\\omega}\\arccos\\!\\Bigl(\\frac{\\sqrt{A^4+8B^4}-A^2}{4B^2}\\Bigr).$$", "answer": "$$\\boxed{\\frac{1}{\\omega}\\arccos\\!\\Bigl(\\frac{\\sqrt{A^4+8B^4}-A^2}{4B^2}\\Bigr)}$$", "id": "854826"}, {"introduction": "With a time delay $\\tau$ selected, the next challenge is to determine the minimum embedding dimension $m$ required to fully unfold the attractor without self-intersections. The False Nearest Neighbors (FNN) algorithm is a powerful geometric method for this purpose, founded on a simple principle: points that are close in an insufficient dimension due to projection will move apart in a higher, more appropriate dimension. This practice [@problem_id:854905] zooms in on the core of the FNN algorithm, asking you to calculate the test ratio for a single pair of points. Mastering this fundamental step builds a strong intuition for how the method identifies the proper embedding dimension by distinguishing true neighbors from artifacts of projection.", "problem": "In nonlinear dynamics, the state space of a system can be reconstructed from a scalar time series using the method of time-delay coordinates. For a time series $x(t)$, one forms $m$-dimensional vectors $\\vec{y}(t) = (x(t), x(t+\\tau), \\dots, x(t+(m-1)\\tau))$, where $\\tau$ is a fixed time delay. According to Takens' theorem, if the embedding dimension $m$ is large enough, the geometry of the reconstructed attractor, traced by the vectors $\\vec{y}(t)$, is topologically equivalent to the original system's attractor.\n\nA crucial step is to determine the minimum sufficient embedding dimension, $m_{\\min}$. The False Nearest Neighbors (FNN) algorithm is a widely used heuristic for this task. The core idea is that if the dimension $m$ is too low, points that are far apart on the true attractor may be projected close to each other, creating \"false neighbors\". As the embedding dimension is increased to $m+1$, these false neighbors will typically move far apart.\n\nOne criterion to identify a false neighbor pair $(\\vec{P}, \\vec{Q})$ in $\\mathbb{R}^m$ is to calculate the ratio of their separation along the newly added dimension to their separation in the original $m$-dimensional space. Specifically, let $\\vec{P} = (p_1, \\dots, p_m)$ be a point and $\\vec{Q}=(q_1, \\dots, q_m)$ be its nearest neighbor in $\\mathbb{R}^m$. Let $p_{m+1}$ and $q_{m+1}$ be the components needed to form the corresponding vectors in $\\mathbb{R}^{m+1}$. The test ratio is defined as:\n$$ C = \\frac{|p_{m+1} - q_{m+1}|}{R_m(\\vec{P}, \\vec{Q})} $$\nwhere $R_m(\\vec{P}, \\vec{Q})$ is the Euclidean distance between $\\vec{P}$ and $\\vec{Q}$. A value of $C$ exceeding a certain threshold indicates that $\\vec{Q}$ is likely a false neighbor of $\\vec{P}$.\n\nConsider an analysis where the embedding dimension is being evaluated for an increase from $m=2$ to $m=3$. A reference point $\\vec{P}$ and its nearest neighbor $\\vec{Q}$ in the $2$-dimensional embedding space are given by:\n$$ \\vec{P} = (v, v/\\lambda) $$\n$$ \\vec{Q} = (v+\\delta, v/\\lambda - 2\\delta) $$\nThe time series values required to extend these vectors to the 3rd dimension are $p_3 = \\mu$ and $q_3 = \\nu$. The parameters $v, \\lambda, \\delta, \\mu, \\nu$ are positive real constants.\n\nCalculate the FNN test ratio $C$ for this pair of points.", "solution": "1. The FNN test ratio is \n$$\nC = \\frac{|p_3 - q_3|}{R_2(\\vec P,\\vec Q)}.\n$$\n2. Numerator: with $p_3=\\mu$, $q_3=\\nu$,\n$$\n|p_3 - q_3| = |\\mu - \\nu|.\n$$\n3. Denominator: the 2D distance\n$$\nR_2(\\vec P,\\vec Q)\n= \\sqrt{(p_1-q_1)^2 + (p_2-q_2)^2}.\n$$\n4. Substitute $\\vec P=(v,v/\\lambda)$, $\\vec Q=(v+\\delta,\\,v/\\lambda-2\\delta)$:\n\n$$\np_1-q_1 = v - (v+\\delta) = -\\delta,\n\\quad\np_2-q_2 = \\frac{v}{\\lambda} - \\Bigl(\\frac{v}{\\lambda}-2\\delta\\Bigr) = 2\\delta.\n$$\n\nHence\n$$\nR_2 = \\sqrt{(-\\delta)^2 + (2\\delta)^2}\n= \\sqrt{\\delta^2 + 4\\delta^2}\n= \\sqrt{5\\,\\delta^2}\n= \\delta\\sqrt{5}.\n$$\n5. Therefore\n$$\nC = \\frac{|\\mu - \\nu|}{\\delta\\sqrt{5}}.\n$$", "answer": "$$\\boxed{\\frac{|\\mu - \\nu|}{\\delta\\sqrt{5}}}$$", "id": "854905"}, {"introduction": "Once an attractor has been reconstructed using an appropriate delay $\\tau$ and dimension $m$, we can begin to analyze its geometric properties to extract dynamical invariants. A key measure is the correlation integral, $C(r)$, which quantifies the density of points on the attractor and forms the basis for estimating its correlation dimension. This exercise [@problem_id:854917] demystifies this important concept by guiding you through the calculation of $C(r)$ for a small, well-defined set of delay vectors. This hands-on computation solidifies your understanding of how to characterize the geometry of a reconstructed object, a central skill in nonlinear data analysis.", "problem": "In the study of nonlinear dynamical systems, a phase space can be reconstructed from a scalar time series using the method of delay coordinates. Given a discrete time series $\\{s_n\\}_{n=1}^L$ of length $L$, one can construct a sequence of vectors in an $m$-dimensional reconstructed phase space. For an embedding dimension $m$ and a time delay $\\tau$ (an integer multiple of the sampling interval), the state vectors are defined as:\n$$ \\vec{x}_n = (s_n, s_{n+\\tau}, s_{n+2\\tau}, \\dots, s_{n+(m-1)\\tau}) $$\nThese vectors are constructed for $n = 1, 2, \\dots, N$, where the total number of vectors is $N = L - (m-1)\\tau$.\n\nA fundamental geometric property of the resulting point cloud in the reconstructed space is captured by the correlation integral, $C(r)$. It quantifies the density of points on the attractor by measuring the fraction of pairs of points whose separation distance is no more than a specified radius $r$. The standard definition is:\n$$ C(r) = \\frac{1}{N(N-1)} \\sum_{i=1}^{N} \\sum_{j=1, j \\neq i}^{N} \\Theta(r - ||\\vec{x}_i - \\vec{x}_j||) $$\nHere, $\\Theta(z)$ is the Heaviside step function, defined as $\\Theta(z)=1$ for $z \\ge 0$ and $\\Theta(z)=0$ for $z < 0$. The distance between vectors is measured using a suitable norm, $||\\cdot||$.\n\nConsider the specific time series of length $L=6$ given by:\n$$ \\{s_n\\}_{n=1}^6 = \\{0, 3, 1, 4, 2, 5\\} $$\nUsing an embedding dimension of $m=2$ and a time delay of $\\tau=1$, construct the delay vectors. Subsequently, calculate the value of the correlation integral $C(r)$ for a radius of $r = 5/2$. For the distance calculation, use the maximum norm ($L_\\infty$ norm), which for two vectors $\\vec{a}=(a_1, \\dots, a_m)$ and $\\vec{b}=(b_1, \\dots, b_m)$ is given by $||\\vec{a} - \\vec{b}||_\\infty = \\max_{k=1,\\dots,m} |a_k - b_k|$.\n\nWhat is the exact value of $C(5/2)$?", "solution": "We have $L=6$, $m=2$, $\\tau=1$, hence\n$$N \\;=\\; L - (m-1)\\tau \\;=\\; 6 - 1 \\;=\\;5.$$\nThe delay vectors are\n$$\n\\vec x_1=(s_1,s_2)=(0,3),\\quad\n\\vec x_2=(3,1),\\quad\n\\vec x_3=(1,4),\\quad\n\\vec x_4=(4,2),\\quad\n\\vec x_5=(2,5).\n$$\nUsing the $L_\\infty$-norm,\n$$\nd_{ij} \\;=\\; \\|\\vec x_i-\\vec x_j\\|_\\infty\n\\;=\\;\\max\\bigl(|s_i-s_j|,\\;|s_{i+1}-s_{j+1}|\\bigr).\n$$\nCompute the distinct unordered distances ($i<j$):\n\n$$\n\\begin{array}{c|cccc}\n(i,j)&(1,2)&(1,3)&(1,4)&(1,5)\\\\\\hline\nd_{ij}&3&1&4&2\n\\end{array}\n\\quad\n\\begin{array}{c|ccc}\n(i,j)&(2,3)&(2,4)&(2,5)\\\\\\hline\nd_{ij}&3&1&4\n\\end{array}\n\\quad\n\\begin{array}{c|cc}\n(i,j)&(3,4)&(3,5)\\\\\\hline\nd_{ij}&3&1\n\\end{array}\n\\quad\n\\begin{array}{c|c}\n(i,j)&(4,5)\\\\\\hline\nd_{ij}&3\n\\end{array}\n$$\n\nFor radius $r=\\tfrac52$, the Heaviside test $\\Theta(r-d_{ij})=1$ holds exactly for the unordered pairs with $d_{ij}\\in\\{1,2\\}$, namely $(1,3),(1,5),(2,4),(3,5)$.  There are $4$ such unordered pairs, or $8$ ordered pairs.  Thus\n$$\nC\\!\\bigl(\\tfrac52\\bigr)\n\\;=\\;\\frac{1}{N(N-1)}\\sum_{i\\neq j}\\Theta\\!\\bigl(\\tfrac52-d_{ij}\\bigr)\n\\;=\\;\\frac{8}{5\\cdot4}\n\\;=\\;\\frac{2}{5}.\n$$", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "854917"}]}