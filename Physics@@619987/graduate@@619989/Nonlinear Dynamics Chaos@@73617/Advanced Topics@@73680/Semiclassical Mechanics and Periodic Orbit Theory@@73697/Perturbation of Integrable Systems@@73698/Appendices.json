{"hands_on_practices": [{"introduction": "Perturbing an integrable system often destroys its exact constants of motion. However, for small perturbations, we can often find new, \"deformed\" invariants that are approximately conserved. This exercise [@problem_id:886164] offers foundational practice in this concept by applying canonical perturbation theory to a simple harmonic oscillator, allowing you to explicitly calculate the first-order correction to the action variable. This is a core skill for analyzing the long-term behavior of near-integrable systems.", "problem": "A one-dimensional harmonic oscillator with mass $m$ and angular frequency $\\omega$ is described by the Hamiltonian $H_0(q, p) = \\frac{p^2}{2m} + \\frac{1}{2} m \\omega^2 q^2$. This system is integrable, and its dynamics can be described by action-angle variables $(I, \\theta)$, where $I = H_0/\\omega$ is the action and $\\theta$ is the angle variable. The transformation between $(q, p)$ and $(I, \\theta)$ is given by:\n$$q = \\sqrt{\\frac{2I}{m\\omega}} \\sin \\theta$$\n$$p = \\sqrt{2m\\omega I} \\cos \\theta$$\n\nNow, consider a perturbation to this system described by the Hamiltonian $H = H_0 + \\epsilon H_1$, where $H_1 = q^3$ and $\\epsilon$ is a small parameter. Due to the perturbation, the original action $I$ is no longer conserved. However, according to canonical perturbation theory, it is possible to find a new variable, the perturbed action $I'$, which is an approximate constant of motion. This new action can be expressed as a series in $\\epsilon$:\n$$I'(q,p) = I(q,p) + \\epsilon I_1(q,p) + O(\\epsilon^2)$$\nwhere $I_1(q,p)$ is the first-order correction to the action.\n\nYour task is to find the first-order correction, $I_1$, for the perturbed harmonic oscillator. Express your final answer as a function of the original phase-space coordinates $q$ and $p$.", "solution": "The total Hamiltonian of the system is given by $H = H_0 + \\epsilon H_1$, where $H_0 = \\frac{p^2}{2m} + \\frac{1}{2} m \\omega^2 q^2$ and $H_1 = q^3$.\n\nWe use canonical perturbation theory to find a new action variable $I'$ that is conserved to first order in $\\epsilon$. The standard procedure involves finding a canonical transformation from the old action-angle variables $(I, \\theta)$ to new variables $(I', \\theta')$, such that the new Hamiltonian $K(I')$ is independent of the new angle $\\theta'$ to first order in $\\epsilon$.\n\nThe first-order correction to the action $I_1$ is given by the formula:\n$$I_1 = -\\frac{H_1 - \\langle H_1 \\rangle_\\theta}{\\omega_0(I)}$$\nwhere $\\omega_0(I) = \\frac{dH_0}{dI}$ is the unperturbed frequency, and $\\langle H_1 \\rangle_\\theta$ is the average of the perturbation $H_1$ over one period of the unperturbed motion, which corresponds to averaging over the angle variable $\\theta$ from $0$ to $2\\pi$.\n\nFirst, we calculate the unperturbed frequency $\\omega_0$. The unperturbed Hamiltonian in terms of the action $I$ is $H_0(I) = I\\omega$.\n$$\\omega_0(I) = \\frac{d H_0}{dI} = \\frac{d(I\\omega)}{dI} = \\omega$$\nAs expected, the frequency of the simple harmonic oscillator is constant.\n\nNext, we express the perturbation $H_1 = q^3$ in terms of the unperturbed action-angle variables $(I, \\theta)$. Using the given transformation $q = \\sqrt{\\frac{2I}{m\\omega}} \\sin \\theta$:\n$$H_1(I, \\theta) = \\left(\\sqrt{\\frac{2I}{m\\omega}}\\right)^3 \\sin^3 \\theta = \\left(\\frac{2I}{m\\omega}\\right)^{3/2} \\sin^3 \\theta$$\n\nNow, we compute the average of $H_1$ over $\\theta$:\n$$\\langle H_1 \\rangle_\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} H_1(I, \\theta) \\,d\\theta = \\left(\\frac{2I}{m\\omega}\\right)^{3/2} \\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin^3 \\theta \\,d\\theta$$\nTo evaluate the integral, we can use the identity $\\sin^3\\theta = \\frac{3}{4}\\sin\\theta - \\frac{1}{4}\\sin(3\\theta)$.\n$$\\int_0^{2\\pi} \\sin^3 \\theta \\,d\\theta = \\int_0^{2\\pi} \\left(\\frac{3}{4}\\sin\\theta - \\frac{1}{4}\\sin(3\\theta)\\right) d\\theta$$\n$$= \\left[-\\frac{3}{4}\\cos\\theta + \\frac{1}{12}\\cos(3\\theta)\\right]_0^{2\\pi}$$\n$$= \\left(-\\frac{3}{4} + \\frac{1}{12}\\right) - \\left(-\\frac{3}{4} + \\frac{1}{12}\\right) = 0$$\nAlternatively, one can note that $\\sin^3\\theta$ is an odd function with respect to reflection about $\\theta=\\pi$, so its integral over $[0, 2\\pi]$ is zero.\n\nTherefore, the average of the perturbation is zero:\n$$\\langle H_1 \\rangle_\\theta = 0$$\n\nNow we substitute these results into the formula for $I_1$:\n$$I_1 = -\\frac{H_1 - 0}{\\omega} = -\\frac{H_1}{\\omega}$$\nThe problem asks for $I_1$ in terms of the original coordinates $(q,p)$. Since $H_1 = q^3$, we have:\n$$I_1(q,p) = -\\frac{q^3}{\\omega}$$\n\nThe new, approximately conserved action variable is thus:\n$$I' = I - \\epsilon \\frac{q^3}{\\omega} + O(\\epsilon^2) = \\frac{1}{\\omega}\\left(\\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2\\right) - \\epsilon \\frac{q^3}{\\omega} + O(\\epsilon^2)$$\nThe first-order correction term is $I_1 = -q^3/\\omega$.", "answer": "$$ \\boxed{-\\frac{q^3}{\\omega}} $$", "id": "886164"}, {"introduction": "A crucial consequence of perturbing an integrable system can be the birth of chaos, arising from the splitting of separatrices. The Melnikov method provides a powerful analytical criterion for this transition by measuring the separation of stable and unstable manifolds. This practice problem [@problem_id:886188] challenges you to apply this method to a damped and driven pendulum to find the critical forcing amplitude that induces heteroclinic tangency, a gateway to complex and chaotic dynamics.", "problem": "Consider a pendulum subjected to damping, a periodic external force, and a constant torque. Its equation of motion is given by:\n$$ \\ddot{\\theta} + \\delta \\dot{\\theta} + \\omega_0^2 \\sin\\theta = \\Gamma + \\gamma \\cos(\\omega t) $$\nwhere $\\theta$ is the angular position, $\\omega_0$ is the natural frequency of the undamped, unforced pendulum, $\\delta$ is the damping coefficient, $\\Gamma$ is the constant torque, $\\gamma$ is the amplitude of the periodic forcing, and $\\omega$ is its frequency. All parameters are positive real constants.\n\nWe analyze this system in the limit of small perturbations, i.e., $\\delta, \\Gamma, \\gamma$ are small. The system can be viewed as a perturbation of the integrable simple pendulum, $\\ddot{\\theta} + \\omega_0^2 \\sin\\theta = 0$. The unperturbed system, when viewed on the phase plane $(\\theta, \\dot{\\theta}) \\in \\mathbb{R}^2$, possesses saddle points at $((2k+1)\\pi, 0)$ for any integer $k$. A separatrix corresponding to a heteroclinic orbit connects the saddle point at $(-\\pi, 0)$ to the one at $(\\pi, 0)$.\n\nUnder the perturbation, the saddle points persist as hyperbolic periodic orbits. The stable and unstable manifolds of these orbits may intersect, leading to chaotic dynamics. The onset of this behavior can be predicted by the Melnikov method, which provides a measure of the distance between the manifolds. A heteroclinic tangency occurs when this distance function first develops a zero.\n\nUsing the Melnikov integral, find the critical forcing amplitude $\\gamma_c$ for the first occurrence of a heteroclinic tangency. Express your answer as a function of $\\delta, \\Gamma, \\omega_0$, and $\\omega$.", "solution": "The equation of motion is $\\ddot{\\theta} + \\delta \\dot{\\theta} + \\omega_0^2 \\sin\\theta = \\Gamma + \\gamma \\cos(\\omega t)$.\nWe can write this as a first-order system by letting $x = \\theta$ and $y = \\dot{\\theta}$:\n$$ \\dot{x} = y $$\n$$ \\dot{y} = -\\omega_0^2 \\sin x - \\delta y + \\Gamma + \\gamma \\cos(\\omega t) $$\nThis system can be written in the form $\\dot{\\mathbf{z}} = \\mathbf{f}_0(\\mathbf{z}) + \\mathbf{g}(\\mathbf{z}, t)$, where $\\mathbf{z} = (x, y)^T$.\n\nThe unperturbed system is the simple pendulum:\n$$ \\dot{x} = y = f_{0,x} $$\n$$ \\dot{y} = -\\omega_0^2 \\sin x = f_{0,y} $$\nThis is a Hamiltonian system with Hamiltonian $H(x,y) = \\frac{1}{2}y^2 - \\omega_0^2 \\cos x$. The saddle points are at $(x,y) = ((2k+1)\\pi, 0)$. The energy at the saddles is $H = -\\omega_0^2 \\cos(\\pi) = \\omega_0^2$.\n\nThe heteroclinic orbit $q_0(t) = (x_0(t), y_0(t))$ connecting the saddle at $(-\\pi,0)$ to the one at $(\\pi,0)$ lies on the energy level $H=\\omega_0^2$.\n$$ \\frac{1}{2}y_0^2 - \\omega_0^2 \\cos x_0 = \\omega_0^2 \\implies y_0^2 = 2\\omega_0^2(1+\\cos x_0) = 4\\omega_0^2 \\cos^2(x_0/2) $$\nThis gives $y_0 = \\pm 2\\omega_0 \\cos(x_0/2)$. We choose the positive root for the upper separatrix.\nFrom $\\dot{x}_0 = y_0$, we solve for $x_0(t)$:\n$$ \\frac{dx_0}{dt} = 2\\omega_0 \\cos(x_0/2) \\implies \\int \\frac{dx_0}{2\\cos(x_0/2)} = \\int \\omega_0 dt $$\n$$ \\int \\frac{1}{2}\\sec(x_0/2) dx_0 = \\omega_0 t + C' $$\nChoosing the convention $x_0(0)=0$ (the orbit's midpoint), we find a convenient parametrization:\n$$ x_0(t) = 2 \\arctan(\\sinh(\\omega_0 t)) $$\nThis satisfies $x_0(t) \\to \\pi$ as $t \\to \\infty$ and $x_0(t) \\to -\\pi$ as $t \\to -\\infty$.\nThe velocity is:\n$$ y_0(t) = \\dot{x}_0(t) = 2 \\frac{\\omega_0 \\cosh(\\omega_0 t)}{1+\\sinh^2(\\omega_0 t)} = 2 \\frac{\\omega_0 \\cosh(\\omega_0 t)}{\\cosh^2(\\omega_0 t)} = 2\\omega_0 \\text{sech}(\\omega_0 t) $$\nSo the unperturbed heteroclinic orbit is $q_0(t) = (2 \\arctan(\\sinh(\\omega_0 t)), 2\\omega_0 \\text{sech}(\\omega_0 t))$.\n\nThe perturbation vector is $\\mathbf{g}(x, y, t) = (0, -\\delta y + \\Gamma + \\gamma \\cos(\\omega t))$.\nThe Melnikov function $M(t_0)$ measures the signed distance between the stable and unstable manifolds in the Poincar√© section at time $t_0$. It is given by the integral:\n$$ M(t_0) = \\int_{-\\infty}^{\\infty} \\mathbf{f}_0(q_0(t)) \\wedge \\mathbf{g}(q_0(t), t+t_0) \\, dt $$\nThe wedge product is $\\mathbf{f}_0 \\wedge \\mathbf{g} = f_{0,x} g_y - f_{0,y} g_x$.\nSubstituting the components:\n$$ \\mathbf{f}_0(q_0(t)) \\wedge \\mathbf{g}(q_0(t), t+t_0) = y_0(t)[-\\delta y_0(t) + \\Gamma + \\gamma \\cos(\\omega(t+t_0))] - (-\\omega_0^2 \\sin x_0(t))[0] $$\n$$ = \\Gamma y_0(t) - \\delta y_0(t)^2 + \\gamma y_0(t) \\cos(\\omega(t+t_0)) $$\nThe Melnikov integral becomes:\n$$ M(t_0) = \\Gamma \\int_{-\\infty}^{\\infty} y_0(t) dt - \\delta \\int_{-\\infty}^{\\infty} y_0(t)^2 dt + \\gamma \\int_{-\\infty}^{\\infty} y_0(t) \\cos(\\omega(t+t_0)) dt $$\nWe evaluate each integral separately:\n\n1.  $\\int_{-\\infty}^{\\infty} y_0(t) dt = \\int_{-\\infty}^{\\infty} \\dot{x}_0(t) dt = x_0(\\infty) - x_0(-\\infty) = \\pi - (-\\pi) = 2\\pi$.\n\n2.  $\\int_{-\\infty}^{\\infty} y_0(t)^2 dt = \\int_{-\\infty}^{\\infty} (2\\omega_0 \\text{sech}(\\omega_0 t))^2 dt = 4\\omega_0^2 \\int_{-\\infty}^{\\infty} \\text{sech}^2(\\omega_0 t) dt$.\n    Let $u = \\omega_0 t$, $du = \\omega_0 dt$.\n    The integral is $4\\omega_0 \\int_{-\\infty}^{\\infty} \\text{sech}^2(u) du = 4\\omega_0 [\\tanh u]_{-\\infty}^{\\infty} = 4\\omega_0 (1 - (-1)) = 8\\omega_0$.\n\n3.  $\\int_{-\\infty}^{\\infty} y_0(t) \\cos(\\omega(t+t_0)) dt = \\int_{-\\infty}^{\\infty} 2\\omega_0 \\text{sech}(\\omega_0 t) (\\cos(\\omega t)\\cos(\\omega t_0) - \\sin(\\omega t)\\sin(\\omega t_0)) dt$.\n    Since $\\text{sech}(\\omega_0 t)$ is an even function, the integral of the term with $\\sin(\\omega t)$ (an odd function) is zero.\n    The integral becomes $2\\omega_0 \\cos(\\omega t_0) \\int_{-\\infty}^{\\infty} \\text{sech}(\\omega_0 t) \\cos(\\omega t) dt$.\n    This integral is the Fourier transform of the sech function.\n    $\\int_{-\\infty}^{\\infty} e^{-ikz} \\text{sech}(az) dz = \\frac{\\pi}{a} \\text{sech}(\\frac{\\pi k}{2a})$.\n    Taking the real part with $z=t, k=\\omega, a=\\omega_0$, we get $\\int_{-\\infty}^{\\infty} \\cos(\\omega t) \\text{sech}(\\omega_0 t) dt = \\frac{\\pi}{\\omega_0} \\text{sech}(\\frac{\\pi\\omega}{2\\omega_0})$.\n    So this part is $2\\omega_0 \\cos(\\omega t_0) \\left( \\frac{\\pi}{\\omega_0} \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right) \\right) = 2\\pi \\cos(\\omega t_0) \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right)$.\n\nCombining these results, the Melnikov function is:\n$$ M(t_0) = 2\\pi\\Gamma - 8\\omega_0\\delta + 2\\pi\\gamma \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right) \\cos(\\omega t_0) $$\nHeteroclinic tangency occurs when $M(t_0)$ has its first zero as $\\gamma$ is increased from zero. This corresponds to the condition where the constant term is equal in magnitude to the amplitude of the oscillatory term.\nThe critical amplitude $\\gamma_c$ is found when $\\max_{t_0} | - 2\\pi\\gamma_c \\text{sech}(\\frac{\\pi\\omega}{2\\omega_0}) \\cos(\\omega t_0) | = | 2\\pi\\Gamma - 8\\omega_0\\delta |$.\n$$ 2\\pi\\gamma_c \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right) = |2\\pi\\Gamma - 8\\omega_0\\delta| $$\nSolving for $\\gamma_c$:\n$$ \\gamma_c = \\frac{|2\\pi\\Gamma - 8\\omega_0\\delta|}{2\\pi \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right)} = \\frac{|\\pi\\Gamma - 4\\omega_0\\delta|}{\\pi} \\cosh\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right) $$", "answer": "$$ \\boxed{\\frac{|\\pi\\Gamma - 4\\omega_0\\delta|}{\\pi} \\cosh\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right)} $$", "id": "886188"}, {"introduction": "While perturbations can induce chaos, the celebrated Kolmogorov-Arnold-Moser (KAM) theorem shows that much of the regular structure of an integrable system can persist, albeit in a deformed shape. In this exercise [@problem_id:886255], you will explore this concept in the context of the Standard Map, a paradigmatic model of area-preserving maps. By explicitly calculating the first-order deformation of an invariant curve, you will gain hands-on insight into how robust structures, known as KAM tori, survive under perturbation.", "problem": "The standard map is a paradigmatic model in the study of Hamiltonian chaos, describing the dynamics of a \"kicked rotor\". The transformation from coordinates $(p_n, \\theta_n)$ at step $n$ to $(p_{n+1}, \\theta_{n+1})$ at step $n+1$ is given by\n$$\n\\begin{aligned}\np_{n+1} &= p_n + K \\sin(\\theta_n) \\\\\n\\theta_{n+1} &= \\theta_n + p_{n+1} \\pmod{2\\pi}\n\\end{aligned}\n$$\nHere, $p$ is the momentum, $\\theta \\in [0, 2\\pi)$ is the angle, and $K$ is the nonlinearity parameter.\n\nFor the integrable case $K=0$, the momentum is conserved, $p_{n+1} = p_n$. The phase space is foliated by invariant curves which are horizontal lines $p = I_0$, where $I_0$ is a constant. On each such curve, the angle $\\theta$ advances by $I_0$ at each step, so $I_0$ is the rotation number.\n\nFor small, non-zero $K$, the Kolmogorov-Arnold-Moser (KAM) theorem states that most of these invariant curves (those with \"sufficiently irrational\" rotation numbers) are not destroyed but merely deformed. We can find the shape of these perturbed curves using canonical perturbation theory.\n\nWe seek a canonical transformation from the original coordinates $(p, \\theta)$ to new coordinates $(I, \\phi)$, defined by a generating function of the form $S(\\theta, I) = \\theta I + K S_1(\\theta, I) + O(K^2)$, such that the new action $I$ is an invariant of the map. The perturbed invariant curve is then described by the condition $I=I_0$, where $I_0$ is the action of the unperturbed curve. The shape of this curve in the original phase space can be expressed as $p = p(\\theta)$.\n\nTo first order in $K$, the equation of the perturbed invariant curve corresponding to the unperturbed curve $p=I_0$ can be written as:\n$$\np(\\theta) = I_0 + K f(\\theta, I_0) + O(K^2)\n$$\nAssuming that $I_0$ is not a multiple of $2\\pi$, find the function $f(\\theta, I_0)$ that describes this first-order correction to the invariant curve.", "solution": "We seek $f(\\theta,I_0)$ such that on the perturbed invariant curve\n$$p(\\theta)=I_0+K\\,f(\\theta,I_0)+O(K^2)$$\nand the map\n$$\\begin{cases}\np_{n+1}=p_n+K\\sin\\theta_n,\\\\\n\\theta_{n+1}=\\theta_n+p_{n+1},\n\\end{cases}$$\ncarries $(\\theta,p(\\theta))\\mapsto(\\theta',p(\\theta'))$ with $\\theta'=\\theta+p(\\theta)+O(K^2)$ and\n$$p(\\theta')=p(\\theta)+K\\sin\\theta+O(K^2)\\,. $$\nEquating $I_0+K\\,f(\\theta',I_0)=I_0+K\\bigl(f(\\theta,I_0)+\\sin\\theta\\bigr)$ and dropping $O(K^2)$ gives the functional equation\n$$f(\\theta+I_0,I_0)-f(\\theta,I_0)=\\sin\\theta\\,. $$\nWe solve by Fourier series. Write\n$$f(\\theta)=\\sum_{m}f_m\\,e^{im\\theta},\\qquad \\sin\\theta=\\frac{e^{i\\theta}-e^{-i\\theta}}{2i}\\,. $$\nThen for each $m$,\n$$f_m\\bigl(e^{imI_0}-1\\bigr)=\\frac{1}{2i}\\bigl[\\delta_{m,1}-\\delta_{m,-1}\\bigr].$$\nThus only $m=\\pm1$ contribute:\n\n$$\nf_1=\\frac{1}{2i(e^{iI_0}-1)}\n=-\\frac{e^{-iI_0/2}}{4\\sin(I_0/2)}, \n\\quad\nf_{-1}=-\\frac{1}{2i(e^{-iI_0}-1)}\n=-\\frac{e^{\\,iI_0/2}}{4\\sin(I_0/2)}.\n$$\n\nHence\n\n$$\nf(\\theta)\n=f_1e^{i\\theta}+f_{-1}e^{-i\\theta}\n=-\\frac{1}{4\\sin(I_0/2)}\\Bigl(e^{i(\\theta-\\frac{I_0}{2})}+e^{-i(\\theta-\\frac{I_0}{2})}\\Bigr)\n=-\\frac{\\cos\\!\\bigl(\\theta-\\tfrac{I_0}{2}\\bigr)}{2\\sin(\\tfrac{I_0}{2})}\\,,\n$$\n\nwhich indeed satisfies $f(\\theta+I_0)-f(\\theta)=\\sin\\theta$.", "answer": "$$\\boxed{-\\frac{\\cos\\!\\bigl(\\theta-\\tfrac{I_0}{2}\\bigr)}{2\\sin\\!\\bigl(\\tfrac{I_0}{2}\\bigr)}}$$", "id": "886255"}]}