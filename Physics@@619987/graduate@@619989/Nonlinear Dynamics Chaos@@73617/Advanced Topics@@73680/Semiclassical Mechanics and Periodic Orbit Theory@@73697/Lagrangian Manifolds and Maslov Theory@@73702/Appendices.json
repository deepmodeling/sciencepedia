{"hands_on_practices": [{"introduction": "Canonical transformations, which preserve the structure of Hamilton's equations, are a cornerstone of advanced classical mechanics, and generating functions provide the primary method for constructing them. Lagrangian submanifolds are, in fact, defined by these functions. This exercise [@problem_id:880911] offers a foundational practice by tasking you with deriving the generating function for a crucial physical transformation: mapping the familiar simple harmonic oscillator into its action-angle variables. This provides a tangible link between abstract mathematical tools and a physically significant, integrable system.", "problem": "Consider a one-dimensional simple harmonic oscillator with mass $m$ and angular frequency $\\omega$. Its dynamics are described by the Hamiltonian:\n$$\nH(q, p) = \\frac{p^2}{2m} + \\frac{1}{2} m\\omega^2 q^2\n$$\nwhere $q$ is the position and $p$ is the momentum.\n\nWe wish to perform a canonical transformation from the phase space coordinates $(q, p)$ to action-angle variables $(\\phi, I)$. The action variable $I$ is defined by the phase space integral over one period of motion at constant energy $E$:\n$$\nI = \\frac{1}{2\\pi} \\oint p \\, dq\n$$\nThe new Hamiltonian $K$ in these coordinates depends only on the action, $K(I) = E(I)$.\n\nThis transformation can be described by a type-2 generating function, $F_2(q, I)$, which depends on the old position $q$ and the new momentum (the action) $I$. The old and new coordinates are related by the following equations:\n$$\np = \\frac{\\partial F_2(q, I)}{\\partial q}, \\quad \\phi = \\frac{\\partial F_2(q, I)}{\\partial I}\n$$\nYour task is to find the explicit form of the generating function $F_2(q, I)$. The final expression should be a function of $q$, $I$, and the parameters $m$ and $\\omega$. An arbitrary integration constant can be set to zero.", "solution": "1. The energyâ€“action relation for the harmonic oscillator is \n$$E=I\\omega,\\qquad E=\\frac{p^2}{2m}+\\frac12m\\omega^2q^2\\,.$$\nHence on the constant-$I$ orbit\n$$p^2=2mI\\omega-m^2\\omega^2q^2,\\quad \np=\\pm m\\omega\\sqrt{\\frac{2I}{m\\omega}-q^2}\\,. $$\n\n2. A type-2 generating function satisfies \n$$p=\\frac{\\partial F_2(q,I)}{\\partial q},\\qquad\n\\phi=\\frac{\\partial F_2(q,I)}{\\partial I}\\,. $$\n\n3. We choose the positive branch of $p$ and integrate in $q$:\n$$F_2(q,I)=\\int p\\,dq\n=m\\omega\\int\\sqrt{\\frac{2I}{m\\omega}-q^2}\\,dq.$$\n\n4. Using the standard integral \n$$\\int\\sqrt{a^2-q^2}\\,dq\n=\\frac q2\\sqrt{a^2-q^2}+\\frac{a^2}{2}\\arcsin\\!\\frac q a,$$\nwith $a^2=\\frac{2I}{m\\omega}$, gives\n$$F_2(q,I)\n=m\\omega\\Bigl[\n\\frac q2\\sqrt{\\tfrac{2I}{m\\omega}-q^2}\n+\\frac12\\frac{2I}{m\\omega}\\arcsin\\!\\Bigl(\\frac{q}{\\sqrt{\\tfrac{2I}{m\\omega}}}\\Bigr)\n\\Bigr].$$\n\n5. Simplifying,\n$$F_2(q,I)\n=\\frac{m\\omega q}{2}\\sqrt{\\frac{2I}{m\\omega}-q^2}\n+I\\arcsin\\!\\Bigl(q\\sqrt{\\tfrac{m\\omega}{2I}}\\Bigr)\\,,$$\nsetting the constant of integration to zero.", "answer": "$$\\boxed{F_2(q,I)\n=\\frac{m\\omega q}{2}\\sqrt{\\frac{2I}{m\\omega}-q^2}\n+I\\arcsin\\!\\Bigl(q\\sqrt{\\frac{m\\omega}{2I}}\\Bigr)}$$", "id": "880911"}, {"introduction": "The connection between classical and quantum mechanics is elegantly expressed through the semiclassical approximation, where the quantum propagator is constructed from classical trajectories. The amplitude of this propagator depends on the Van Vleck determinant, a quantity that measures the local stability and focusing of classical paths, which geometrically corresponds to the projection of the Lagrangian manifold. In this problem [@problem_id:880912], you will calculate this determinant for the inverted harmonic oscillator, a key model system, and gain insight into the classical structures that underpin semiclassical wave phenomena.", "problem": "In the semiclassical approximation of quantum mechanics, the propagator, which evolves a quantum state in time, can be expressed as a sum over classical trajectories connecting the initial and final points. According to the Van Vleck-Gutzwiller formula, for a one-dimensional system, the propagator $K(q_f, T; q_i, 0)$ is given by:\n$$ K(q_f, T; q_i, 0) \\approx \\sum_{\\text{cl. paths}} C \\exp\\left(\\frac{i}{\\hbar} S_{cl}(q_f, T; q_i, 0)\\right) $$\nThe amplitude factor $C$ depends on the stability of the classical path and is related to the Van Vleck determinant, $D$. This determinant measures how a bundle of classical trajectories starting near the initial point $q_i$ spreads out over time.\n\nFor a one-dimensional system evolving for a time $T$, the classical trajectory establishes a map from the initial phase space coordinates $(q_0, p_0)$ to the final ones $(q_T, p_T)$. The stability matrix (or monodromy matrix) $M(T)$ is the Jacobian of this map:\n$$ M(T) = \\frac{\\partial(q_T, p_T)}{\\partial(q_0, p_0)} = \\begin{pmatrix} \\frac{\\partial q_T}{\\partial q_0}  \\frac{\\partial q_T}{\\partial p_0} \\\\ \\frac{\\partial p_T}{\\partial q_0}  \\frac{\\partial p_T}{\\partial p_0} \\end{pmatrix} = \\begin{pmatrix} M_{qq}  M_{qp} \\\\ M_{pq}  M_{pp} \\end{pmatrix} $$\nThe Van Vleck determinant $D(T)$ can be conveniently calculated as the inverse of the $M_{qp}$ element of this matrix:\n$$ D(T) = (M_{qp}(T))^{-1} = \\left(\\frac{\\partial q_T}{\\partial p_0}\\right)^{-1} $$\nConsider a particle of mass $m$ moving in a one-dimensional repulsive potential given by $V(q) = -\\frac{1}{2}kq^2$, where $k$ is a positive real constant. This system is known as the inverted harmonic oscillator. For a classical evolution over a time interval $T$, calculate the Van Vleck determinant $D(T)$.", "solution": "The problem asks for the Van Vleck determinant $D(T)$ for a particle of mass $m$ in the potential $V(q) = -\\frac{1}{2}kq^2$. We will compute this using the stability matrix of the classical flow.\n\n**1. Hamiltonian and Equations of Motion**\n\nFirst, we write down the Hamiltonian $H$ for the system. The kinetic energy is $T = p^2/(2m)$ and the potential energy is $V(q) = -kq^2/2$.\n$$ H(q, p) = T + V = \\frac{p^2}{2m} - \\frac{1}{2}kq^2 $$\nThe classical dynamics are governed by Hamilton's equations:\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m} $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} = -(-kq) = kq $$\n\n**2. Linear System and Stability Matrix**\n\nHamilton's equations form a system of linear first-order ordinary differential equations. We can write them in matrix form. Let the state vector be $\\mathbf{x}(t) = \\begin{pmatrix} q(t) \\\\ p(t) \\end{pmatrix}$. Then the equations of motion are:\n$$ \\frac{d}{dt}\\mathbf{x}(t) = \\begin{pmatrix} \\dot{q} \\\\ \\dot{p} \\end{pmatrix} = \\begin{pmatrix} 0  1/m \\\\ k  0 \\end{pmatrix} \\begin{pmatrix} q \\\\ p \\end{pmatrix} $$\nThis is of the form $\\dot{\\mathbf{x}} = A\\mathbf{x}$, where the matrix $A$ is:\n$$ A = \\begin{pmatrix} 0  1/m \\\\ k  0 \\end{pmatrix} $$\nThe solution to this linear system is $\\mathbf{x}(T) = e^{AT} \\mathbf{x}(0)$. The matrix $M(T) = e^{AT}$ is precisely the stability matrix we need.\n\n**3. Computing the Matrix Exponential $M(T) = e^{AT}$**\n\nTo compute the matrix exponential, we first find the eigenvalues of $A$. The characteristic equation is $\\det(A - \\lambda I) = 0$.\n$$ \\det \\begin{pmatrix} -\\lambda  1/m \\\\ k  -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (1/m)(k) = \\lambda^2 - \\frac{k}{m} = 0 $$\nThe eigenvalues are $\\lambda_{1,2} = \\pm \\sqrt{k/m}$. Let us define the characteristic frequency $\\omega = \\sqrt{k/m}$. The eigenvalues are $\\pm\\omega$.\n\nSince the eigenvalues are distinct, we can use the Cayley-Hamilton theorem, which implies that $e^{AT}$ can be written as a linear combination of $I$ and $A$:\n$$ e^{AT} = c_0(T) I + c_1(T) A $$\nThe scalar coefficients $c_0(T)$ and $c_1(T)$ are found by solving the same relationship for the eigenvalues:\n$$ e^{\\lambda T} = c_0(T) + c_1(T) \\lambda $$\nSubstituting the two eigenvalues $\\lambda = \\omega$ and $\\lambda = -\\omega$:\n$$ e^{\\omega T} = c_0 + c_1 \\omega $$\n$$ e^{-\\omega T} = c_0 - c_1 \\omega $$\nAdding these two equations gives:\n$$ e^{\\omega T} + e^{-\\omega T} = 2c_0 \\implies c_0(T) = \\frac{e^{\\omega T} + e^{-\\omega T}}{2} = \\cosh(\\omega T) $$\nSubtracting the second equation from the first gives:\n$$ e^{\\omega T} - e^{-\\omega T} = 2c_1 \\omega \\implies c_1(T) = \\frac{e^{\\omega T} - e^{-\\omega T}}{2\\omega} = \\frac{\\sinh(\\omega T)}{\\omega} $$\nNow we can construct the stability matrix $M(T) = e^{AT}$:\n$$ M(T) = \\cosh(\\omega T) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{\\sinh(\\omega T)}{\\omega} \\begin{pmatrix} 0  1/m \\\\ k  0 \\end{pmatrix} $$\n$$ M(T) = \\begin{pmatrix} \\cosh(\\omega T)  \\frac{1}{m\\omega}\\sinh(\\omega T) \\\\ \\frac{k}{\\omega}\\sinh(\\omega T)  \\cosh(\\omega T) \\end{pmatrix} $$\nUsing $k = m\\omega^2$, the term $k/\\omega = m\\omega^2/\\omega = m\\omega$. So the stability matrix is:\n$$ M(T) = \\begin{pmatrix} \\cosh(\\omega T)  \\frac{1}{m\\omega}\\sinh(\\omega T) \\\\ m\\omega\\sinh(\\omega T)  \\cosh(\\omega T) \\endpmatrix} $$\n\n**4. Calculating the Van Vleck Determinant**\n\nThe components of the stability matrix are:\n$$ M_{qq}(T) = \\frac{\\partial q_T}{\\partial q_0} = \\cosh(\\omega T) $$\n$$ M_{qp}(T) = \\frac{\\partial q_T}{\\partial p_0} = \\frac{1}{m\\omega}\\sinh(\\omega T) $$\n$$ M_{pq}(T) = \\frac{\\partial p_T}{\\partial q_0} = m\\omega\\sinh(\\omega T) $$\n$$ M_{pp}(T) = \\frac{\\partial p_T}{\\partial p_0} = \\cosh(\\omega T) $$\nThe Van Vleck determinant is given by $D(T) = (M_{qp}(T))^{-1}$.\n$$ D(T) = \\left( \\frac{1}{m\\omega}\\sinh(\\omega T) \\right)^{-1} = \\frac{m\\omega}{\\sinh(\\omega T)} $$\nFinally, we substitute back $\\omega = \\sqrt{k/m}$:\n$$ D(T) = \\frac{m\\sqrt{k/m}}{\\sinh(T\\sqrt{k/m})} = \\frac{\\sqrt{m^2k/m}}{\\sinh(T\\sqrt{k/m})} = \\frac{\\sqrt{mk}}{\\sinh\\left(T\\sqrt{\\frac{k}{m}}\\right)} $$\nThis is the final expression for the Van Vleck determinant at time $T$.", "answer": "$$ \\boxed{\\frac{\\sqrt{mk}}{\\sinh\\left(T\\sqrt{\\frac{k}{m}}\\right)}} $$", "id": "880912"}, {"introduction": "The simple semiclassical amplitude, involving the Van Vleck determinant, diverges at caustics, precisely where classical trajectories focus. Maslov theory resolves this issue by introducing a topological phase correction known as the Maslov index, which accounts for the nontrivial geometry of the Lagrangian submanifold. This culminating exercise [@problem_id:880883] provides direct, hands-on experience in computing this crucial topological invariant for a closed loop on a Lagrangian submanifold, illustrating the heart of Maslov's contribution to semiclassical quantization.", "problem": "Consider the phase space $M = T^*\\mathbb{T}^2$, the cotangent bundle of the 2-torus, with canonical coordinates $(q_1, q_2, p_1, p_2)$ where $q_i \\in \\mathbb{R}/\\mathbb{Z}$ are configuration coordinates and $p_i$ are their conjugate momenta. The canonical symplectic form is $\\omega = dp_1 \\wedge dq_1 + dp_2 \\wedge dq_2$.\n\nA 2-dimensional submanifold $\\mathcal{L} \\subset M$ is called a Lagrangian submanifold if the symplectic form vanishes when restricted to it, i.e., $\\omega|_{\\mathcal{L}} = 0$.\n\nConsider the submanifold $\\mathcal{L}$ parametrized by angles $(\\theta_1, \\theta_2) \\in [0, 2\\pi) \\times [0, 2\\pi)$ as follows:\n$$\n\\begin{aligned}\nq_1(\\theta_1, \\theta_2) = \\frac{1}{2} + R_1 \\cos \\theta_1 \\\\\np_1(\\theta_1, \\theta_2) = R_1 \\sin \\theta_1 \\\\\nq_2(\\theta_1, \\theta_2) = \\frac{1}{2} + R_2 \\cos \\theta_2 \\\\\np_2(\\theta_1, \\theta_2) = R_2 \\sin \\theta_2\n\\end{aligned}\n$$\nwhere $R_1$ and $R_2$ are positive constants satisfying $0  R_1  1/2$ and $0  R_2  1/2$.\n\nLet $\\gamma: [0, 1] \\to \\mathcal{L}$ be a closed loop on this submanifold, defined by the path in the parameter space:\n$$\n\\theta_1(t) = 2\\pi t, \\quad \\theta_2(t) = \\frac{\\pi}{2}\n$$\nThe Maslov index of a loop $\\gamma(t)$ on a Lagrangian submanifold $\\mathcal{L}$ can be computed as the winding number of the complex-valued function $\\det(X(t) + iY(t))$, where $X(t)$ and $Y(t)$ are matrices that describe the tangent space to $\\mathcal{L}$ along the loop. Specifically, if the tangent space $T_{\\gamma(t)}\\mathcal{L}$ is spanned by the columns of the $2n \\times n$ matrix $\\begin{pmatrix} X(t) \\\\ Y(t) \\end{pmatrix}$, where $X(t)$ and $Y(t)$ are $n \\times n$ matrices, the Maslov index is given by:\n$$\n\\mu(\\gamma) = \\text{WindingNumber}(\\det(X(t) + iY(t))) = \\frac{1}{2\\pi i} \\oint \\frac{d(\\det)}{\\det}\n$$\n\nCalculate the Maslov index of the loop $\\gamma(t)$.", "solution": "We seek the Maslov index \n$$\\mu(\\gamma)=\\mathrm{Wind}\\bigl(\\det(X(t)+iY(t))\\bigr)\\,. $$ \n1.  Parametrization gives \n\n$$\nX(t)=\\begin{pmatrix}\n\\partial_{\\theta_1}q_1\\partial_{\\theta_2}q_1\\\\\n\\partial_{\\theta_1}q_2\\partial_{\\theta_2}q_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-R_1\\sin\\theta_10\\\\\n0-R_2\\sin\\theta_2\n\\end{pmatrix},\\quad\nY(t)=\\begin{pmatrix}\nR_1\\cos\\theta_10\\\\\n0R_2\\cos\\theta_2\n\\end{pmatrix}.\n$$\n\nAlong the loop $\\theta_1=2\\pi t,\\ \\theta_2=\\pi/2$ we have $\\sin\\theta_2=1,\\ \\cos\\theta_2=0$, so\n\n$$\nX(t)=\\begin{pmatrix}-R_1\\sin(2\\pi t)0\\\\0-R_2\\end{pmatrix},\\quad\nY(t)=\\begin{pmatrix}R_1\\cos(2\\pi t)0\\\\00\\end{pmatrix}.\n$$\n\n2.  Hence\n\n$$\n\\det\\bigl(X+iY\\bigr)\n=\\bigl(-R_1\\sin\\theta_1+iR_1\\cos\\theta_1\\bigr)(-R_2)\n=R_1R_2\\bigl(\\sin\\theta_1-i\\cos\\theta_1\\bigr)\n=-i\\,R_1R_2\\,e^{i\\theta_1}.\n$$\n\n3.  As $t$ goes from $0$ to $1$, $\\theta_1=2\\pi t$ increases by $2\\pi$, so the argument of $\\det$ winds once. Therefore \n\n$$\n\\mu(\\gamma)=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "880883"}]}