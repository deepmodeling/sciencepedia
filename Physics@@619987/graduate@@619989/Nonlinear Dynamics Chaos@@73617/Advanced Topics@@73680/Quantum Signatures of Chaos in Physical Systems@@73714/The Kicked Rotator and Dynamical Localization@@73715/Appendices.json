{"hands_on_practices": [{"introduction": "To appreciate the unique features of the quantum kicked rotator, we must first understand its classical behavior. This practice guides you through a foundational analysis of the classical standard map, a paradigm for Hamiltonian chaos. By examining the stability of a simple fixed point, you will discover the critical role of the kicking strength $K$ in the transition from stable, predictable motion to the onset of chaos [@problem_id:888012].", "problem": "The Chirikov standard map is a cornerstone in the study of Hamiltonian chaos. Its quantum counterpart, the quantum kicked rotor, is a paradigmatic model in quantum chaos, used to investigate phenomena like dynamical localization, which starkly contrasts with the classical system's diffusive behavior. A crucial first step in understanding the complex dynamics is to analyze the structure of the classical phase space, which is dictated by the location and stability of its fixed points.\n\nConsider a version of the area-preserving standard map defined on the cylinder $(\\theta, p) \\in \\mathbb{S}^1 \\times \\mathbb{R}$, given by the discrete-time evolution equations:\n$$\np_{n+1} = p_n - K \\sin(\\theta_n)\n$$\n$$\n\\theta_{n+1} = \\theta_n + p_{n+1} \\pmod{2\\pi}\n$$\nHere, $\\theta_n$ is the angular position, $p_n$ is the angular momentum, and $K$ is a positive parameter known as the kicking strength. A fixed point $(\\theta^*, p^*)$ of the map is a point that maps to itself, i.e., $(\\theta_{n+1}, p_{n+1}) = (\\theta_n, p_n)$.\n\nThe stability of a fixed point is determined by the eigenvalues of the Jacobian matrix of the map evaluated at that point. If the eigenvalues are complex conjugates on the unit circle, the point is stable (elliptic). If they are real and reciprocal (and not $\\pm 1$), the point is unstable (hyperbolic). The transition from stable to unstable behavior occurs when the eigenvalues become real.\n\nThe origin, $(\\theta, p) = (0, 0)$, is a fixed point of this map. Determine the critical value of the kicking strength, $K_c$, at which the origin fixed point transitions from being stable to unstable.", "solution": "1. The map is defined by the equations:\n$$\np_{n+1}=p_n-K\\sin\\theta_n\n$$\n$$\n\\theta_{n+1}=\\theta_n+p_{n+1}\\pmod{2\\pi}\n$$\nAt a fixed point $(\\theta^*,p^*)$ we have $p^*=p^*-K\\sin\\theta^* \\implies \\sin\\theta^*=0$, and $\\theta^*=\\theta^*+p^* \\pmod{2\\pi} \\implies p^*$ is a multiple of $2\\pi$. The fixed point at the origin $(0,0)$ satisfies these conditions.\n\n2. To analyze its stability, we compute the Jacobian matrix:\n$$\nJ=\\begin{pmatrix}\n\\frac{\\partial\\theta_{n+1}}{\\partial\\theta_n}&\\frac{\\partial\\theta_{n+1}}{\\partial p_n}\\\\\n\\frac{\\partial p_{n+1}}{\\partial\\theta_n}&\\frac{\\partial p_{n+1}}{\\partial p_n}\n\\end{pmatrix}\n=\\begin{pmatrix}\n1-K\\cos\\theta_n&1\\\\\n-K\\cos\\theta_n&1\n\\end{pmatrix}\n$$\nAt the origin $(0,0)$, where $\\cos(0)=1$, the Jacobian becomes:\n$$\nJ(0,0)=\\begin{pmatrix}1-K&1\\\\ -K&1\\end{pmatrix}\n$$\n\n3. The characteristic equation is $\\lambda^2-(\\operatorname{Tr}J)\\lambda+\\det J=0$. We compute the trace, $\\operatorname{Tr}J=(1-K)+1=2-K$, and the determinant, $\\det J=1$. The fixed point is stable (elliptic) if $|\\operatorname{Tr}J|<2$. The stability boundary is $|\\!2-K\\!|=2$, which gives:\n$$\n2-K=\\pm2 \\implies K=0\\text{ or }K=4\n$$\nSince $K>0$, the transition from stable to unstable occurs at:\n$$\nK_c=4\n$$", "answer": "$$\\boxed{4}$$", "id": "888012"}, {"introduction": "Having established the conditions for classical chaos, we now explore the system's quantum counterpart. This hands-on simulation [@problem_id:2403604] is your opportunity to witness one of the most striking phenomena in quantum chaos: dynamical localization. By numerically evolving the wavefunction, you will see how quantum interference fundamentally alters the dynamics, suppressing the chaotic diffusion of momentum that is unbound in the classical system.", "problem": "You will implement a simulation of the quantum kicked rotor that demonstrates dynamical localization, a quantum suppression of classical chaos, using first principles from the time-dependent Schrödinger equation and unitary evolution. The goal is to construct the one-period (Floquet) evolution from the Hamiltonian of a kicked rotor, design a numerically stable and unitary algorithm on a discrete torus, and verify diagnostic behaviors by computing momentum-space variance over time. Angles must be treated in radians, and all quantities are dimensionless.\n\nStart from the time-dependent Schrödinger equation $i \\hbar \\, \\partial_t \\psi(\\theta,t) = \\hat{H}(t)\\,\\psi(\\theta,t)$ with the kicked-rotor Hamiltonian on the circle,\n$$\n\\hat{H}(t) = \\frac{\\hat{p}^2}{2} + K \\cos\\hat{\\theta} \\sum_{n\\in\\mathbb{Z}} \\delta(t - n \\tau),\n$$\nwhere $\\hat{\\theta}$ is the angle operator with $2\\pi$-periodicity, $\\hat{p}$ is the angular momentum operator with integer eigenvalues, $K$ is the kick strength, and $\\tau$ is the time between kicks. For this assignment, set $\\hbar = 1$, $\\tau = 1$, and treat the system on a discrete torus with $N$ equally spaced angle grid points $\\theta_j = 2\\pi j/N$ for $j \\in \\{0,1,\\dots,N-1\\}$. The momentum index $m$ runs over the $N$ integers $m \\in \\{0,1,\\dots,N-1\\}$ in the Fast Fourier Transform (FFT) output order, which corresponds to the ordered set $\\{0,1,\\dots,N/2-1,-N/2,\\dots,-1\\}$ for even $N$. You must use an orthonormal discrete Fourier transform to preserve unitarity.\n\nTasks:\n1) From the fundamental laws and core definitions above, derive the one-period evolution in terms of a product of unitary operators associated with the free-rotor part and the impulsive kick. Show how these act diagonally in the momentum and angle representations, respectively, and explain how a unitary and numerically stable split-operator method on the torus uses a discrete Fourier transform to alternate between these representations without loss of norm.\n\n2) Design an algorithm that:\n- Represents the wavefunction on the angle grid of size $N$,\n- Applies the kick operator in angle space as a pointwise multiplication,\n- Applies the free-rotor operator in momentum space as a pointwise multiplication,\n- Transforms between angle and momentum representations using an orthonormal Fast Fourier Transform (FFT) with unitary normalization.\n\n3) Use the initial state that is a momentum eigenstate with $m=0$. In the angle representation this is the uniform state $\\psi(\\theta_j,0) = 1/\\sqrt{N}$. After each kick, compute the momentum-space probability distribution $P_m(n) = |\\Phi_m(n)|^2$, where $\\Phi_m(n)$ is the momentum-space wavefunction immediately after the $n$-th application of the one-period evolution operator. Then compute the momentum mean $\\langle m\\rangle_n = \\sum_m m \\, P_m(n)$ and variance $\\sigma_p^2(n) = \\sum_m m^2 P_m(n) - \\langle m\\rangle_n^2$.\n\n4) Numerically investigate the time evolution of $\\sigma_p^2(n)$ over $n \\in \\{1,2,\\dots,M\\}$ for the specified parameters, and use linear least-squares fits of $\\sigma_p^2(n)$ versus $n$ to estimate early-time and late-time slopes as diagnostics of growth or localization. All angles must be in radians.\n\nGlobal simulation parameters to use for all tests:\n- Hilbert-space size $N = 512$,\n- Number of kicks $M = 600$,\n- Kick interval $\\tau = 1$,\n- Reduced Planck constant $\\hbar = 1$,\n- Angle grid $\\theta_j = 2\\pi j/N$ for $j \\in \\{0,1,\\dots,N-1\\}$,\n- Orthonormal FFT normalization.\n\nWindows for slope estimation:\n- Early-time window: $n \\in \\{1,2,\\dots,60\\}$,\n- Late-time window: $n \\in \\{451,452,\\dots,600\\}$.\n\nTest suite:\n- Test $1$ (no dynamics beyond trivial free phase): $K = 0$. Output a boolean indicating whether the final variance satisfies $\\sigma_p^2(M) < 10^{-12}$.\n- Test $2$ (weak kicking): $K = 0.5$. Output a boolean indicating whether the final variance satisfies $\\sigma_p^2(M) < 1.0$.\n- Test $3$ (classically chaotic regime, early-time growth): $K = 5.0$. Output a boolean indicating whether the early-time slope is strictly positive and exceeds $0.01$.\n- Test $4$ (classically chaotic regime, late-time dynamical localization): $K = 5.0$. Output a boolean indicating whether the absolute value of the late-time slope is less than $0.05$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). The four entries must be in the order of Tests $1$ through $4$, and each entry must be a boolean.", "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The task is to simulate the quantum kicked rotor, a canonical model in the study of quantum chaos, to demonstrate the phenomenon of dynamical localization. We will proceed by first deriving the one-period evolution operator from the system's Hamiltonian and then constructing a numerically stable algorithm to simulate the system's dynamics and compute the required diagnostics.\n\nThe system is governed by the time-dependent Schrödinger equation, $i \\hbar \\frac{\\partial}{\\partial t} |\\psi(t)\\rangle = \\hat{H}(t) |\\psi(t)\\rangle$, with the Hamiltonian for the kicked rotor:\n$$\n\\hat{H}(t) = \\frac{\\hat{p}^2}{2} + K \\cos\\hat{\\theta} \\sum_{n \\in \\mathbb{Z}} \\delta(t - n\\tau)\n$$\nHere, $\\hat{p}$ is the angular momentum operator, whose eigenvalues we denote by $m$, and $\\hat{\\theta}$ is the angle operator. The problem specifies dimensionless units where the reduced Planck constant $\\hbar = 1$ and the kicking period $\\tau = 1$.\n\nThe evolution of the state vector $|\\psi(t)\\rangle$ over one period, from a time just after a kick, $t_n = n\\tau$, to the time just after the next kick, $t_{n+1} = (n+1)\\tau$, is described by the Floquet operator, $\\hat{F}$. This evolution consists of two distinct parts: free rotation for a duration $\\tau$, governed by the kinetic Hamiltonian $\\hat{H}_0 = \\hat{p}^2/2$, followed by an instantaneous kick described by the potential $\\hat{V}(\\theta) = K \\cos\\hat{\\theta}$.\n\nThe unitary operator for the free evolution over a period $\\tau$ is:\n$$\n\\hat{U}_0 = \\exp\\left(-\\frac{i}{\\hbar} \\hat{H}_0 \\tau\\right) = \\exp\\left(-\\frac{i \\hat{p}^2 \\tau}{2\\hbar}\\right)\n$$\nThe unitary operator for the kick, which is an impulse at time $t=(n+1)\\tau$, is:\n$$\n\\hat{U}_K = \\exp\\left(-\\frac{i}{\\hbar} \\int_{ (n+1)\\tau - \\epsilon }^{ (n+1)\\tau + \\epsilon } K \\cos\\hat{\\theta} \\, \\delta(t - (n+1)\\tau) \\, dt \\right) = \\exp\\left(-\\frac{i K \\cos\\hat{\\theta}}{\\hbar}\\right)\n$$\nThe Floquet operator $\\hat{F}$ is the product of these two operators. The state after kick $n$, $|\\psi_n\\rangle$, is evolved to the state after kick $n+1$, $|\\psi_{n+1}\\rangle$, by the action $|\\psi_{n+1}\\rangle = \\hat{F} |\\psi_n\\rangle$. The correct ordering, representing free evolution followed by a kick, is:\n$$\n\\hat{F} = \\hat{U}_K \\hat{U}_0 = \\exp\\left(-\\frac{i K \\cos\\hat{\\theta}}{\\hbar}\\right) \\exp\\left(-\\frac{i \\hat{p}^2 \\tau}{2\\hbar}\\right)\n$$\nWith $\\hbar=1$ and $\\tau=1$, this simplifies to:\n$$\n\\hat{F} = \\exp(-i K \\cos\\hat{\\theta}) \\exp\\left(-i \\frac{\\hat{p}^2}{2}\\right)\n$$\nThis structure is ideal for a split-operator numerical method. The operator $\\hat{U}_0$ is diagonal in the momentum basis, where $\\hat{p}$ acts as multiplication by its eigenvalue $m$. The operator $\\hat{U}_K$ is diagonal in the angle (position) basis, where $\\cos\\hat{\\theta}$ acts as multiplication by $\\cos\\theta$.\n\nA numerically stable and unitary algorithm is constructed by representing the wavefunction $\\psi$ on a discrete grid and switching between the angle and momentum representations using the Fast Fourier Transform (FFT). The system is discretized on a torus with $N$ angle points $\\theta_j = 2\\pi j/N$ for $j \\in \\{0, 1, \\dots, N-1\\}$. The corresponding discrete momentum eigenvalues are given by the integers $m \\in \\{0, 1, \\dots, N/2-1, -N/2, \\dots, -1\\}$, which is the standard order for FFT frequencies. An orthonormal FFT and its inverse (IFFT) serve as unitary transformations between the angle-space representation $\\psi_j$ and the momentum-space representation $\\Phi_m$. This ensures that the norm of the wavefunction is conserved throughout the simulation, which is a critical requirement for physical accuracy and numerical stability.\n\nThe algorithm for a single time step, advancing the state from after kick $n-1$ to after kick $n$, is as follows:\n$1$. Start with the wavefunction $\\psi^{(n-1)}$ in the angle representation.\n$2$. Transform to the momentum representation using an orthonormal FFT: $\\Phi^{(n-1)} = \\text{FFT}(\\psi^{(n-1)})$.\n$3$. Apply the free-rotor evolution operator, which is a diagonal matrix in this basis: $\\Phi' = \\exp(-i m^2/2) \\cdot \\Phi^{(n-1)}$.\n$4$. Transform back to the angle representation using an orthonormal IFFT: $\\psi' = \\text{IFFT}(\\Phi')$.\n$5$. Apply the kick operator, which is a diagonal matrix in this basis: $\\psi^{(n)} = \\exp(-i K \\cos\\theta_j) \\cdot \\psi'$. The result, $\\psi^{(n)}$, is the state immediately after the $n$-th kick.\n\nFor diagnostics, after each kick $n$, we compute the momentum-space variance.\n$1$. The momentum-space wavefunction after kick $n$ is $\\Phi^{(n)} = \\text{FFT}(\\psi^{(n)})$.\n$2$. The momentum probability distribution is $P_m(n) = |\\Phi_m(n)|^2$.\n$3$. The mean momentum is $\\langle m \\rangle_n = \\sum_m m P_m(n)$.\n$4$. The variance is $\\sigma_p^2(n) = \\langle m^2 \\rangle_n - \\langle m \\rangle_n^2 = \\sum_m m^2 P_m(n) - (\\langle m \\rangle_n)^2$.\n\nThe initial state is a momentum eigenstate with $m=0$. In the angle representation, this is a uniform state $\\psi(\\theta_j, 0) = 1/\\sqrt{N}$. Due to the symmetry of the initial state and the kicking potential (a cosine function), the mean momentum $\\langle m \\rangle_n$ is expected to remain zero throughout the simulation. The variance thus simplifies to the mean squared momentum, $\\sigma_p^2(n) = \\langle m^2 \\rangle_n$.\n\nThe simulation will be run for $M=600$ kicks using a Hilbert space of size $N=512$. The numerical tests investigate the behavior of $\\sigma_p^2(n)$ for different kick strengths $K$:\n- For $K=0$, the system undergoes only free evolution. Since the initial state is an eigenstate of the free-rotor Hamiltonian with energy $0$, it is a stationary state. The variance $\\sigma_p^2(n)$ should remain zero, up to machine precision.\n- For small $K$ (e.g., $K=0.5$), the system is in a weakly chaotic regime. The variance should grow initially and then saturate at a small value.\n- For large $K$ (e.g., $K=5.0$), the corresponding classical system is strongly chaotic. The quantum system initially mimics this chaos with a diffusive growth in momentum variance, $\\sigma_p^2(n) \\propto n$. This corresponds to a positive slope in the early-time evolution of $\\sigma_p^2(n)$. However, at later times, quantum interference effects suppress this diffusion, leading to dynamical localization. The variance saturates, and its growth rate approaches zero. This is verified by computing the slope of $\\sigma_p^2(n)$ vs. $n$ in a late-time window. Slopes are determined using a linear least-squares fit.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates the quantum kicked rotor to test for dynamical localization.\n    \"\"\"\n\n    # Global simulation parameters\n    N = 512\n    M = 600\n    TAU = 1.0\n    HBAR = 1.0\n\n    # Test suite parameters\n    test_cases = [\n        {'id': 1, 'K': 0.0, 'check': 'final_variance', 'params': {'threshold': 1e-12}},\n        {'id': 2, 'K': 0.5, 'check': 'final_variance', 'params': {'threshold': 1.0}},\n        {'id': 3, 'K': 5.0, 'check': 'early_slope', 'params': {'threshold': 0.01}},\n        {'id': 4, 'K': 5.0, 'check': 'late_slope', 'params': {'threshold': 0.05}},\n    ]\n\n    # Windows for slope estimation\n    early_time_window = np.arange(1, 61)\n    late_time_window = np.arange(451, 601)\n    \n    results = []\n\n    for case in test_cases:\n        K = case['K']\n        \n        # Discretized grids\n        theta_grid = 2 * np.pi * np.arange(N) / N\n        # Momentum eigenvalues in FFT order\n        m_grid = N * np.fft.fftfreq(N)\n\n        # Initial state: momentum eigenstate m=0\n        # This is a uniform state in the angle representation.\n        psi = np.ones(N, dtype=np.complex128) / np.sqrt(N)\n        \n        # Pre-compute evolution operators\n        kick_op = np.exp(-1j * K * np.cos(theta_grid) / HBAR)\n        free_op = np.exp(-1j * m_grid**2 * TAU / (2 * HBAR))\n\n        variances = []\n\n        for n in range(M):\n            # The one-period (Floquet) evolution: free evolution then kick.\n            # This is the split-operator method.\n            \n            # --- Free evolution part (in momentum space) ---\n            # 1. Transform to momentum space\n            phi = np.fft.fft(psi, norm='ortho')\n            # 2. Apply free evolution operator\n            phi = free_op * phi\n            # 3. Transform back to angle space\n            psi = np.fft.ifft(phi, norm='ortho')\n\n            # --- Kick part (in angle space) ---\n            # 4. Apply kick operator\n            psi = kick_op * psi\n\n            # --- Diagnostics after the kick ---\n            # Calculate momentum variance\n            phi_after_kick = np.fft.fft(psi, norm='ortho')\n            prob_dist = np.abs(phi_after_kick)**2\n            \n            # For the symmetric initial state and potential, mean momentum is zero.\n            # We calculate it for robustness.\n            mean_m = np.sum(m_grid * prob_dist)\n            mean_m_sq = np.sum(m_grid**2 * prob_dist)\n            variance = mean_m_sq - mean_m**2\n            variances.append(variance)\n\n        variances = np.array(variances)\n\n        # Perform the check required by the test case\n        check_type = case['check']\n        if check_type == 'final_variance':\n            final_variance = variances[-1]\n            threshold = case['params']['threshold']\n            # Tests 1 and 2 check if variance is below a threshold\n            result = final_variance  threshold\n        \n        elif check_type == 'early_slope':\n            var_early = variances[early_time_window - 1]\n            slope, _ = np.polyfit(early_time_window, var_early, 1)\n            threshold = case['params']['threshold']\n            # Test 3 checks for positive diffusive growth\n            result = slope > threshold\n\n        elif check_type == 'late_slope':\n            # For Test 3, we need the variances from the same run with K=5.0\n            var_late = variances[late_time_window - 1]\n            slope, _ = np.polyfit(late_time_window, var_late, 1)\n            threshold = case['params']['threshold']\n            # Test 4 checks for saturation (localization)\n            result = np.abs(slope)  threshold\n        \n        else:\n            # Should not happen\n            result = False\n\n        results.append(result)\n\n    # Format the final output as a string list of booleans\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2403604"}, {"introduction": "The quantum kicked rotator's behavior is remarkably sensitive to its parameters. While generic parameters often lead to the localization you observed previously, special \"resonant\" conditions can give rise to an entirely different and purely quantum phenomenon. This exercise [@problem_id:899177] challenges you to calculate the quantum revival time, demonstrating how delicate quantum coherence can lead to perfect periodic reconstruction of the initial state, a stark contrast to the seemingly random evolution of its classical analogue.", "problem": "A variant of the quantum kicked rotator is described by a time-dependent Hamiltonian $H(t) = H_0 + V(\\theta) \\sum_{j \\in \\mathbb{Z}} \\delta(t-jT)$, where $\\theta \\in [0, 2\\pi)$ is the angle operator and $\\hat{p}$ is its conjugate momentum operator, whose eigenvalues are integer multiples of a fundamental unit of action $\\hbar_0$. In this problem, we choose units where $\\hbar_0=1$, so the momentum eigenvalues are integers $n \\in \\mathbb{Z}$.\n\nThe free evolution part of the Hamiltonian is given by $H_0 = \\frac{\\hat{p}^2}{2I} + \\frac{\\alpha}{T} \\hat{p}$, which describes a particle on a ring with inertia $I$ subject to an additional constant driving field parametrized by $\\alpha$. The kicking potential is taken to be zero, $V(\\theta)=0$.\n\nThe one-period evolution operator (the Floquet operator) is $U = \\exp(-i H_0 T)$. In the momentum eigenbasis $\\{|n\\rangle\\}$, its action is diagonal:\n$$\nU |n\\rangle = \\exp\\left(-i\\left(\\frac{T}{2I}n^2 + \\alpha n\\right)\\right) |n\\rangle\n$$\nLet the dimensionless effective Planck's constant be $\\tau = T/I$. The system is prepared at a quantum resonance, where $\\tau$ is a rational multiple of $4\\pi$. Specifically, let $\\tau = 4\\pi p/q$, where $p$ and $q$ are coprime integers.\n\nThe driving field parameter $\\alpha$ is also chosen to be commensurate with $2\\pi$, such that $\\alpha = 2\\pi r/s$, where $r$ and $s$ are coprime integers.\n\nA full quantum revival occurs after $N_{\\text{rev}}$ periods (kicks) if the evolution operator raised to the power $N_{\\text{rev}}$ becomes a multiple of the identity operator, i.e., $U^{N_{\\text{rev}}} = c \\cdot I$ for some phase factor $c$, independent of the state. This ensures that any arbitrary initial state returns to itself, up to a global phase.\n\nCalculate the minimal full quantum revival time $N_{\\text{rev}}$ (as an integer number of periods $T$), assuming one exists. Express your answer in terms of $q$ and $s$.", "solution": "A full quantum revival after $N_{\\text{rev}}$ periods requires the evolution operator $U^{N_{\\text{rev}}}$ to be proportional to the identity operator. This means that for any momentum eigenstate $|n\\rangle$, the phase acquired after $N_{\\text{rev}}$ periods must be independent of $n$ (modulo $2\\pi$).\n\nThe phase acquired by state $|n\\rangle$ after $N_{\\text{rev}}$ periods is:\n$$\n\\phi_n = -N_{\\text{rev}} \\left( \\frac{T}{2I}n^2 + \\alpha n \\right)\n$$\nFor a revival to occur, we need $\\phi_n \\equiv \\phi_0 \\pmod{2\\pi}$ for all integers $n$. Since $\\phi_0 = 0$, this simplifies to $\\phi_n \\in 2\\pi\\mathbb{Z}$ for all $n$.\n\nSubstituting the given parameters $\\tau = T/I = 4\\pi p/q$ and $\\alpha = 2\\pi r/s$, the condition becomes:\n$$\nN_{\\text{rev}} \\left( \\frac{4\\pi p}{2q}n^2 + \\frac{2\\pi r}{s}n \\right) \\in 2\\pi\\mathbb{Z}\n$$\nDividing by $2\\pi$, we find that $f(n) = N_{\\text{rev}} \\left( \\frac{p}{q}n^2 + \\frac{r}{s}n \\right)$ must be an integer for all integers $n$.\n\nThis condition implies separate constraints from the quadratic and linear terms in $n$.\n1.  **Linear Term:** The revival time for the linear part of the Hamiltonian, $H_{\\text{lin}} = \\frac{\\alpha}{T}\\hat{p}$, must satisfy $N_{\\text{rev}} \\alpha n \\in 2\\pi\\mathbb{Z}$ for all $n$. For $n=1$, we need $N_{\\text{rev}} \\alpha \\in 2\\pi\\mathbb{Z}$, which is $N_{\\text{rev}} (2\\pi r/s) \\in 2\\pi\\mathbb{Z}$, or $N_{\\text{rev}} r/s \\in \\mathbb{Z}$. Since $r$ and $s$ are coprime, this implies $s | N_{\\text{rev}}$.\n\n2.  **Quadratic Term:** The revival time for the quadratic part, $H_{\\text{quad}} = \\frac{\\hat{p}^2}{2I}$, must satisfy $N_{\\text{rev}} \\frac{T}{2I}n^2 \\in 2\\pi\\mathbb{Z}$ for all $n$. This is equivalent to $N_{\\text{rev}} \\frac{\\tau}{2}n^2 \\in 2\\pi\\mathbb{Z}$, or $N_{\\text{rev}} \\frac{2\\pi p}{q}n^2 \\in 2\\pi\\mathbb{Z}$. This simplifies to $N_{\\text{rev}} \\frac{p}{q}n^2 \\in \\mathbb{Z}$ for all $n$. For a quadratic polynomial in $n$ to map all integers to integers, it is a known result that twice the coefficient of $n^2$ must be an integer. Thus, we require $2 N_{\\text{rev}} \\frac{p}{q} \\in \\mathbb{Z}$. Since $\\gcd(p,q)=1$, this implies $q | 2N_{\\text{rev}}$. The minimal period for this condition is $q$ if $q$ is odd, and $q/2$ if $q$ is even. This can be written as $q/\\gcd(q,2)$. Thus, $N_{\\text{rev}}$ must be a multiple of $q/\\gcd(q,2)$.\n\nThe minimal full revival time $N_{\\text{rev}}$ must be the least common multiple of the minimal revival times required by each part of the Hamiltonian.\n$$\nN_{\\text{rev}} = \\mathrm{lcm}\\left(s, \\frac{q}{\\gcd(q,2)}\\right)\n$$", "answer": "$$\\boxed{\\mathrm{lcm}\\left(s, \\frac{q}{\\gcd(q,2)}\\right)}$$", "id": "899177"}]}