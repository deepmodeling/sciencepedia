{"hands_on_practices": [{"introduction": "How can we build a network if all we know is the number of connections each node should have? The configuration model provides a simple and powerful answer, making it a cornerstone for understanding networks where the degree sequence is the primary driver of structure. This problem [@problem_id:876883] takes you directly into the model's engine room, where you will use combinatorial methods to calculate the probability of creating a specific graph. This hands-on calculation is key to understanding both the model's power and its potential to create non-simple graphs with loops and multiple edges.", "problem": "In the study of complex networks, the configuration model is a generative algorithm for constructing a random graph with a specified degree sequence. Consider a set of $N$ nodes, where each node $i$ is assigned a degree $k_i$. To generate a graph, each node $i$ is given $k_i$ \"stubs\" or \"half-edges\". The total number of stubs in the network is $L = \\sum_{i=1}^N k_i$, which must be even. A random graph is then formed by choosing a perfect matching on the set of $L$ stubs, where each possible perfect matching is equally likely. This process can produce graphs with multi-edges (multiple edges between the same two nodes) and self-loops (edges connecting a node to itself).\n\nA \"paw graph\" is a simple graph with four vertices and four edges, consisting of a triangle with a pendant node attached to one of the triangle's vertices. The degree sequence of a paw graph is $\\{3, 2, 2, 1\\}$.\n\nConsider a configuration model with $N=4$ labeled nodes $\\{v_1, v_2, v_3, v_4\\}$ and a prescribed degree sequence $\\{k_1, k_2, k_3, k_4\\} = \\{3, 2, 2, 1\\}$. Any simple graph generated from this model must be isomorphic to a paw graph, with $v_1$ being the degree-3 center, $v_4$ the degree-1 pendant node, and $v_2, v_3$ the other two degree-2 nodes of the triangle.\n\nCalculate the exact probability that the stub-matching procedure for this degree sequence results in a simple graph (i.e., the paw graph).", "solution": "We label the stubs of each node $i$ by $s_{i,1},\\dots,s_{i,k_i}$.  The total number of stubs is\n$$\nL=\\sum_{i=1}^4k_i=3+2+2+1=8.\n$$\n1. Total number of perfect matchings on $L$ labeled stubs is\n$$\n(8-1)!!=7\\cdot5\\cdot3\\cdot1=105.\n$$\n2. We count favorable matchings that yield the paw graph on $\\{v_1,v_2,v_3,v_4\\}$ with edges\n$$\n\\{v_1v_2,\\;v_1v_3,\\;v_1v_4,\\;v_2v_3\\}.\n$$\n(a) Pair one of the $3$ stubs of $v_1$ with the unique stub of $v_4$: $3$ choices.  \n(b) Of the remaining $2$ stubs of $v_1$, choose one to pair with $v_2$: $2$ choices; then choose which of the $2$ stubs of $v_2$ to use: $2$ choices.  \n(c) The last stub of $v_1$ pairs with one of the $2$ stubs of $v_3$: $2$ choices.  \n(d) Finally, the remaining single stub of $v_2$ pairs with the remaining single stub of $v_3$: $1$ way.  \nHence the total number of favorable matchings is\n$$\n3\\times2\\times2\\times2\\times1=24.\n$$\n3. Therefore the probability of obtaining the simple paw graph is\n$$\n\\frac{24}{105}=\\frac{8}{35}.\n$$", "answer": "$$\\boxed{\\frac{8}{35}}$$", "id": "876883"}, {"introduction": "The famous \"six degrees of separation\" illustrates the small-world phenomenon, where paths between any two individuals in a large network are remarkably short. The Watts-Strogatz model was a breakthrough in explaining how this structure emerges from a blend of local order and global randomness. In this exercise [@problem_id:876967], you'll perform a precise calculation to see this effect in action, determining the expected drop in path length after adding just one random shortcut to a regular ring. This provides a tangible, analytical grasp of how a little randomness can make a big world small.", "problem": "A simple generative model for a \"small-world\" network is constructed by starting with a regular graph and adding random shortcuts. Consider a one-dimensional ring lattice, which is a cycle graph $C_N$ with $N$ vertices, labeled $0, 1, \\dots, N-1$, where $N$ is a large even integer. The vertices are arranged in a circle, and each vertex $i$ is connected to its immediate neighbors, $i-1$ and $i+1$ (modulo $N$). The distance between two vertices $i$ and $j$ on this ring, denoted $d_0(i,j)$, is the number of edges in the shortest path between them, which is $d_0(i,j) = \\min(|i-j|, N-|i-j|)$.\n\nThe network is modified by adding a single shortcut. This shortcut is an edge $(u,v)$ chosen uniformly at random from all pairs of vertices $\\{u,v\\}$ that are not already connected by an edge in $C_N$.\n\nYour task is to calculate the expected shortest path length between a given vertex and its antipode, for instance, between vertex $0$ and vertex $N/2$, after the addition of one such random shortcut. Provide a closed-form analytic expression for this expected path length in terms of $N$.", "solution": "Let $S=0$ and $T=N/2$ be the source and target antipodal nodes. The initial shortest path length between them in the cycle graph $C_N$ is $d_0(S,T) = d_0(0, N/2) = N/2$.\n\nA single shortcut edge $(u,v)$ is added to the graph. The new shortest path length, $d(S,T)$, will be the minimum of the original path length and the length of any new path created by the shortcut. A path utilizing the shortcut must traverse from $S$ to one endpoint of the shortcut, say $u$, cross the shortcut edge (length 1), and then proceed from the other endpoint, $v$, to $T$. The length of such a path is $d_0(S,u) + 1 + d_0(v,T)$. Since the shortcut is undirected, we must consider both directions, so the shortest path length via the shortcut is $\\min(d_0(S,u) + 1 + d_0(v,T), d_0(S,v) + 1 + d_0(u,T))$.\n\nThe new shortest path length is $d(S,T) = \\min(N/2, d_0(S,u) + 1 + d_0(v,T), d_0(S,v) + 1 + d_0(u,T))$.\n\nAn important property on the ring for antipodal nodes $S=0$ and $T=N/2$ is that for any node $i$, the triangle equality is sharp along one of the two shortest paths from $S$ to $T$. This means $d_0(S,i) + d_0(i,T) = d_0(S,T) = N/2$ for all $i \\in \\{0, \\dots, N-1\\}$. Let's denote $X_i = d_0(S,i) = d_0(0,i)$. Then $d_0(i,T) = N/2 - X_i$.\n\nSubstituting this into the expression for the path length via the shortcut:\n$L(u,v) = \\min(X_u + 1 + (N/2 - X_v), X_v + 1 + (N/2 - X_u))$\n$L(u,v) = \\min(N/2 + 1 + X_u - X_v, N/2 + 1 + X_v - X_u)$\n$L(u,v) = N/2 + 1 - |X_u - X_v|$.\n\nThe new shortest path length is $d(u,v) = \\min(N/2, N/2 + 1 - |X_u - X_v|)$.\nThe reduction in path length from the original $N/2$ is $\\Delta(u,v) = N/2 - d(u,v) = \\max(0, |X_u - X_v| - 1)$.\n\nWe need to compute the expected value of $d(S,T)$, which is $\\mathbb{E}[d] = N/2 - \\mathbb{E}[\\Delta]$. The expectation is taken over all possible shortcuts.\nThe number of pairs of vertices is $\\binom{N}{2}$. The number of edges in $C_N$ is $N$.\nThe number of possible shortcuts is $|\\mathcal{C}| = \\binom{N}{2} - N = \\frac{N(N-1)}{2} - N = \\frac{N(N-3)}{2}$.\n$\\mathbb{E}[\\Delta] = \\frac{1}{|\\mathcal{C}|} \\sum_{\\{u,v\\} \\in \\mathcal{C}} \\Delta(u,v)$.\n\nThe value of $\\Delta(u,v)$ depends on $X_u=d_0(0,u)$ and $X_v=d_0(0,v)$.\nFor an edge $(i, i+1)$ in $C_N$, $|X_{i+1}-X_i| = |d_0(0,i+1)-d_0(0,i)|=1$.\nThus, for any adjacent pair $(u,v)$, $\\Delta(u,v) = \\max(0, 1-1) = 0$.\nSo, $\\sum_{\\{u,v\\} \\in \\mathcal{C}} \\Delta(u,v) = \\sum_{\\{u,v\\}, u\\neq v} \\Delta(u,v) - \\sum_{\\{u,v\\} \\in E(C_N)} \\Delta(u,v) = \\sum_{\\{u,v\\}, u\\neq v} \\Delta(u,v)$.\nThe sum over all distinct pairs $\\{u,v\\}$ is $\\frac{1}{2} \\sum_{u \\neq v} \\Delta(u,v) = \\frac{1}{2} \\sum_{u,v} \\Delta(u,v)$, since $\\Delta(u,u)=0$. Let $S_\\Delta = \\sum_{u,v} \\Delta(u,v)$. Then $\\mathbb{E}[\\Delta] = \\frac{S_\\Delta/2}{|\\mathcal{C}|} = \\frac{S_\\Delta}{N(N-3)}$.\n\nTo compute $S_\\Delta$, we average over all choices of $u, v \\in \\{0, \\dots, N-1\\}$. Let's define the distribution of $X_i=d_0(0,i)$.\nLet $P(k)$ be the number of nodes $i$ such that $X_i=k$.\n$X_i = k \\Leftrightarrow d_0(0,i)=k \\Leftrightarrow \\min(i, N-i)=k$.\nFor $k=0$, $i=0$, so $P(0)=1$.\nFor $k \\in \\{1, \\dots, N/2-1\\}$, $i=k$ or $i=N-k$, so $P(k)=2$.\nFor $k=N/2$, $i=N/2$, so $P(N/2)=1$.\n$\\sum_{k=0}^{N/2} P(k) = 1 + 2(N/2-1) + 1 = N$.\n\n$S_\\Delta = \\sum_{u,v} \\max(0, |X_u-X_v|-1) = \\sum_{k,l=0}^{N/2} P(k)P(l) \\max(0, |k-l|-1)$.\nThis can be calculated as $S_\\Delta = \\sum_{k,l} P(k)P(l) (|k-l|-1)$ for $|k-l|>1$.\nThis is $S_\\Delta = \\sum_{k,l}P(k)P(l)|k-l| - \\sum_{k,l,|k-l|\\ge 1}P(k)P(l) - \\sum_{k,l, |k-l|>1}P(k)P(l)$.\nA more direct method is finding $\\mathbb{E}[\\Delta]$ by decomposing it:\n$\\mathbb{E}_{u,v}[\\Delta] = \\mathbb{E}[|X_u-X_v|] - P(|X_u-X_v| \\ge 1) $ is not correct.\nLet's use $\\mathbb{E}[\\max(0,Z-1)] = \\mathbb{E}[Z-1 | Z>1] P(Z>1)$.\nLet $Z = |X_u-X_v|$.\n$S_\\Delta = \\sum_{k,l} P(k)P(l) (|k-l|-1) \\cdot \\mathbb{I}(|k-l|>1)$.\n$S_\\Delta = \\sum_{|k-l|>1} P(k)P(l)|k-l| - \\sum_{|k-l|>1} P(k)P(l)$.\nLet $S = \\sum_{k,l} P(k)P(l)|k-l|$. Then $\\sum_{|k-l|>1} P(k)P(l)|k-l| = S - \\sum_{|k-l|\\le 1} P(k)P(l)|k-l|$.\nThe second term is just $\\sum_{|k-l|=1} P(k)P(l)$.\n$\\sum_{|k-l|=1} P(k)P(l) = 2 \\sum_{k=0}^{N/2-1} P(k)P(k+1) = 2[P(0)P(1) + \\sum_{k=1}^{N/2-2}P(k)P(k+1) + P(N/2-1)P(N/2)]$.\n$= 2[1\\cdot 2 + (N/2-2) \\cdot 2 \\cdot 2 + 2\\cdot 1] = 2[2 + 2N-8 + 2] = 4N-8$.\nSo, $\\sum_{|k-l|>1} P(k)P(l)|k-l| = S - (4N-8)$.\nAnd $\\sum_{|k-l|>1} P(k)P(l) = N^2 - \\sum_{|k-l|\\le 1}P(k)P(l)$.\n$\\sum_{|k-l|\\le 1}P(k)P(l) = \\sum_k P(k)^2 + \\sum_{|k-l|=1}P(k)P(l) = [P(0)^2+P(N/2)^2 + \\sum_{k=1}^{N/2-1}P(k)^2] + (4N-8)$.\n$= [1+1+ (N/2-1)2^2] + 4N-8 = [2+2N-4]+4N-8 = 2N-2+4N-8=6N-10$.\nSo $\\sum_{|k-l|>1} P(k)P(l) = N^2 - (6N-10)$.\n$S_\\Delta = (S - (4N-8)) - (N^2 - (6N-10)) = S - N^2 + 2N - 18$.\n\nThe sum $S=\\sum_{k,l}P(k)P(l)|k-l|$ can be computed as $2\\sum_{k=1}^{N/2} [kP(k)C(k-1) - P(k)M(k-1)]$, where $C(k) = \\sum_{j=0}^k P(j)$ and $M(k) = \\sum_{j=0}^k jP(j)$.\nThe calculation yields $S = \\frac{N^3+2N}{6}$.\nSo, $S_\\Delta = \\frac{N^3+2N}{6} - N^2 + 2N - 18 = \\frac{N^3 - 6N^2 + 14N - 108}{6}$.\nThis expression for $S_\\Delta$ was re-checked and found to have a methodical error. The corrected calculation is:\n$S_\\Delta/N^2 = \\mathbb{E}[\\Delta] = \\mathbb{E}[|X-Y|] - P(|X-Y|\\geq 1)$ this is wrong.\nCorrect expression for the expectation of $\\Delta$ taken over all $N^2$ pairs $(u,v)$ is\n$\\mathbb{E}_{N^2}[\\Delta] = \\frac{1}{N^2}S_\\Delta = \\frac{1}{N^2}(\\frac{N^3-6N^2+14N-12}{6}) = \\frac{N}{6}-1+\\frac{7}{3N}-\\frac{2}{N^2}$.\nThis was derived via $\\mathbb{E}[\\Delta] = \\mathbb{E}[|X-Y| \\cdot 1_{|X-Y|>1}] - P(|X-Y|>1)$, which gives $\\frac{S-N^2+2N-2}{N^2}$. On substituting $S$, we obtain the stated result.\nSo, $S_\\Delta = N^2(\\frac{N}{6}-1+\\frac{7}{3N}-\\frac{2}{N^2}) = \\frac{N^3}{6}-N^2+\\frac{7N}{3}-2 = \\frac{N^3-6N^2+14N-12}{6}$.\n\nThis is the sum over all $N^2$ ordered pairs. The sum over $\\{u,v\\}\\in\\mathcal{C}$ is $\\frac{1}{2}S_\\Delta$.\nThe expected reduction is $\\mathbb{E}_{\\mathcal{C}}[\\Delta] = \\frac{S_\\Delta/2}{N(N-3)/2} = \\frac{S_\\Delta}{N(N-3)}$.\n$\\mathbb{E}_{\\mathcal{C}}[\\Delta] = \\frac{N^3-6N^2+14N-12}{6N(N-3)}$.\nUsing polynomial division for $(N^3-6N^2+14N-12) / (N^2-3N)$:\n$N(N^2-3N)=N^3-3N^2$. Remainder: $-3N^2+14N-12$.\n$-3(N^2-3N)=-3N^2+9N$. Remainder: $5N-12$.\nSo, $\\frac{N^3-6N^2+14N-12}{N^2-3N} = N-3 + \\frac{5N-12}{N^2-3N}$.\n$\\mathbb{E}_{\\mathcal{C}}[\\Delta] = \\frac{1}{6} \\left( N-3 + \\frac{5N-12}{N(N-3)} \\right) = \\frac{N}{6} - \\frac{1}{2} + \\frac{5N-12}{6N(N-3)}$.\n\nThe expected shortest path length is $\\mathbb{E}[d] = N/2 - \\mathbb{E}_{\\mathcal{C}}[\\Delta]$.\n$\\mathbb{E}[d] = \\frac{N}{2} - \\left(\\frac{N}{6} - \\frac{1}{2} + \\frac{5N-12}{6N(N-3)}\\right) = \\frac{N}{3} + \\frac{1}{2} - \\frac{5N-12}{6N(N-3)}$.\nTo write this as a single rational function:\n$\\mathbb{E}[d] = \\frac{(N/3+1/2)(6N(N-3)) - (5N-12)}{6N(N-3)} = \\frac{(2N+3)N(N-3) - (5N-12)}{6N(N-3)}$\n$= \\frac{(2N^2+3N)(N-3) - 5N+12}{6N(N-3)} = \\frac{2N^3-6N^2+3N^2-9N - 5N+12}{6N(N-3)}$\n$= \\frac{2N^3-3N^2-14N+12}{6N(N-3)}$.", "answer": "$$ \\boxed{\\frac{2N^3 - 3N^2 - 14N + 12}{6N(N-3)}} $$", "id": "876967"}, {"introduction": "What if, instead of following a fixed recipe to build one network, we could define a rich probability distribution over all possible networks that favors certain structural features? This is the power of Exponential Random Graph Models (ERGMs), which use principles from statistical mechanics to model complex network ensembles. This practice problem [@problem_id:876917] provides a clear window into how ERGMs work by tasking you to compare the likelihood of two simple graphs. By calculating this probability ratio, you will see precisely how the model parameters promote or penalize local structures like edges and 2-stars, a foundational skill for using ERGMs in research.", "problem": "Exponential Random Graph Models (ERGMs) provide a statistical framework for modeling the structure of complex networks. In an ERGM, a probability distribution is defined over the set of all possible graphs $\\mathcal{G}_N$ on a fixed number of $N$ vertices. The probability of observing a particular graph $G$ from this ensemble is given by:\n$$\nP(G) = \\frac{1}{Z} \\exp\\left(H(G)\\right)\n$$\nwhere $H(G)$ is the graph Hamiltonian, and $Z = \\sum_{G' \\in \\mathcal{G}_N} \\exp\\left(H(G')\\right)$ is the partition function that normalizes the distribution.\n\nThe Hamiltonian is a linear combination of various graph statistics (also called network observables), $s_k(G)$:\n$$\nH(G) = \\sum_k \\theta_k s_k(G)\n$$\nwhere $\\theta_k$ are the model parameters that determine the importance of each statistic.\n\nConsider an ERGM for undirected graphs on $N=5$ vertices, defined by two statistics: the number of edges, $L(G)$, and the number of 2-stars, $S_2(G)$. The Hamiltonian is given by:\n$$\nH(G) = \\theta_L L(G) + \\theta_S S_2(G)\n$$\nA 2-star is a subgraph consisting of three vertices $\\{i,j,k\\}$ where vertex $j$ is connected to both $i$ and $k$, but there is no edge between $i$ and $k$. The total number of 2-stars in a graph $G$ with vertex set $V$ can be calculated as $S_2(G) = \\sum_{j \\in V} \\binom{d_j}{2}$, where $d_j$ is the degree of vertex $j$.\n\nYour task is to compute the probability ratio $\\frac{P(C_5)}{P(P_5)}$, where $C_5$ is the cycle graph on 5 vertices and $P_5$ is the path graph on 5 vertices. Express your answer as an analytic function of the parameters $\\theta_L$ and $\\theta_S$.", "solution": "1. The probability ratio is\n$$\n\\frac{P(C_5)}{P(P_5)}\n=\\frac{\\exp\\bigl(H(C_5)\\bigr)}{\\exp\\bigl(H(P_5)\\bigr)}\n=\\exp\\bigl(H(C_5)-H(P_5)\\bigr).\n$$\n2. Compute edge counts:\n$$\nL(C_5)=5,\\quad L(P_5)=4.\n$$\n3. Compute 2-star counts using $S_2(G)=\\sum_{j}\\binom{d_j}{2}$.\n- For $C_5$, each vertex has $d_j=2$, so\n$$\nS_2(C_5)=5\\binom{2}{2}=5.\n$$\n- For $P_5$, two endpoints have $d_j=1$ and three internal vertices have $d_j=2$, so\n$$\nS_2(P_5)=2\\binom{1}{2}+3\\binom{2}{2}=0+3=3.\n$$\n4. The Hamiltonian difference is\n$$\nH(C_5)-H(P_5)\n=\\theta_L\\bigl(5-4\\bigr)+\\theta_S\\bigl(5-3\\bigr)\n=\\theta_L+2\\theta_S.\n$$\n5. Therefore,\n$$\n\\frac{P(C_5)}{P(P_5)}=\\exp\\bigl(\\theta_L+2\\theta_S\\bigr).\n$$", "answer": "$$\\boxed{\\exp\\bigl(\\theta_L+2\\theta_S\\bigr)}$$", "id": "876917"}]}