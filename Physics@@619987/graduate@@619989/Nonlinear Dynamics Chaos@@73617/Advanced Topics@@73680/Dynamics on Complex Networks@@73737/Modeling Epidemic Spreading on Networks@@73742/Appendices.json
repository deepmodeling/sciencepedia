{"hands_on_practices": [{"introduction": "To begin our exploration of epidemic dynamics, we first consider the fundamental question of how an infection traverses a network. This exercise simplifies the process to its static core, akin to a percolation problem, where we calculate the probability that an infection successfully travels from a source to a target node through various pathways. By analyzing a small, directed acyclic graph, you will apply the principle of inclusion-exclusion to account for multiple, overlapping infection routes, a foundational skill for understanding disease spread in any network context.", "problem": "Consider a Susceptible-Infected (SI) model for epidemic spreading on a directed network. In this model, nodes can be in one of two states: Susceptible (S) or Infected (I). The process starts with a single source node being in the Infected state, while all other nodes are Susceptible.\n\nThe infection spreads along the directed edges of the network. For each directed edge $(u, v)$ from an infected node $u$ to a susceptible node $v$, a transmission event occurs with a fixed probability $p$. All transmission events are independent. If a transmission event occurs, node $v$ becomes infected. Once a node is infected, it remains infected for the duration of the process.\n\nConsider a directed acyclic graph (DAG) with the set of nodes $V = \\{1, 2, 3, 4, 5, 6\\}$ and the set of edges $E = \\{(1, 2), (1, 3), (2, 4), (3, 4), (1, 5), (4, 5), (5, 6)\\}$. Node 1 is the initial source of the infection.\n\nCalculate the probability that node 6 is ever infected. Your final answer should be an analytical expression in terms of the transmission probability $p$.", "solution": "1. Identify all directed paths from node 1 to node 6:  \n   A: $1\\to5\\to6$, edges $e_{15},e_{56}$.  \n   B: $1\\to2\\to4\\to5\\to6$, edges $e_{12},e_{24},e_{45},e_{56}$.  \n   C: $1\\to3\\to4\\to5\\to6$, edges $e_{13},e_{34},e_{45},e_{56}$.\n\n2. Let $A,B,C$ be the events that paths A, B, C all succeed.  Since each edge transmits independently with probability $p$,\n   $$P(A)=p^2,\\quad P(B)=p^4,\\quad P(C)=p^4.$$\n   \n3. Intersections require the union of edges to succeed:\n   $$P(A\\cap B)=p^5,\\quad P(A\\cap C)=p^5,\\quad P(B\\cap C)=p^6,$$\n   $$P(A\\cap B\\cap C)=p^7.$$\n\n4. By inclusionâ€“exclusion,\n   \n$$\n     P(\\text{node }6\\text{ infected})\n     =P(A)+P(B)+P(C)\n     -\\bigl[P(A\\cap B)+P(A\\cap C)+P(B\\cap C)\\bigr]\n     +P(A\\cap B\\cap C).\n   $$\n\n   Substituting gives\n   \n$$\n     P\n     =p^2+2p^4-\\bigl(2p^5+p^6\\bigr)+p^7\n     =p^2+2p^4-2p^5-p^6+p^7.\n   $$", "answer": "$$\\boxed{p^2 + 2p^4 - 2p^5 - p^6 + p^7}$$", "id": "883373"}, {"introduction": "A pivotal question in epidemiology is determining the conditions under which a small outbreak becomes a full-blown epidemic. This critical tipping point is known as the epidemic threshold, which is intimately linked to the structure of the underlying contact network. In this practice, you will calculate this threshold for a quenched mean-field SIS model by finding the largest eigenvalue of the network's adjacency matrix, providing a powerful demonstration of how spectral graph theory can predict the macroscopic behavior of a complex dynamical system.", "problem": "In the study of epidemic spreading on networks, the quenched mean-field Susceptible-Infected-Susceptible (SIS) model describes the probability $p_i(t)$ of a node $i$ being infected at time $t$. For a network of $N$ nodes, the dynamics are governed by the following system of coupled differential equations:\n$$\n\\frac{dp_i}{dt} = \\beta (1-p_i) \\sum_{j=1}^{N} A_{ij} p_j - \\mu p_i, \\quad i=1, \\dots, N\n$$\nHere, $\\beta$ is the infection rate per infectious link, $\\mu$ is the recovery rate, and $A$ is the adjacency matrix of the network ($A_{ij}=1$ if nodes $i$ and $j$ are connected, and $A_{ij}=0$ otherwise). We assume the graph is undirected and has no self-loops ($A_{ii}=0$).\n\nThe epidemic threshold is the critical condition for the infection to persist in the network. This threshold is found by analyzing the stability of the disease-free equilibrium ($p_i=0$ for all $i$). An epidemic outbreak is possible if and only if the disease-free state is unstable. This condition is determined by the largest eigenvalue, $\\Lambda(A)$, of the adjacency matrix $A$. The critical ratio of the infection to recovery rate is given by $\\tau_c = (\\beta/\\mu)_c = 1/\\Lambda(A)$.\n\nConsider an epidemic spreading on a small network of five nodes. The network consists of two triangles of nodes that share a common central vertex. The nodes are labeled such that nodes $\\{1, 2, 3\\}$ form one triangle and nodes $\\{3, 4, 5\\}$ form the second triangle. The adjacency matrix $A$ for this network is given by:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n1 & 1 & 0 & 1 & 1 \\\\\n0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 1 & 0\n\\end{pmatrix}\n$$\nDetermine the exact value of the epidemic threshold $\\tau_c = (\\beta/\\mu)_c$ for this network.", "solution": "We seek the epidemic threshold \n$$\n\\tau_c \\;=\\;\\frac{1}{\\Lambda(A)}\n$$ \nwhere $\\Lambda(A)$ is the largest eigenvalue of the adjacency matrix\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n1 & 1 & 0 & 1 & 1 \\\\\n0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 1 & 0\n\\end{pmatrix}.\n$$\n\n1.  By symmetry, nodes 1 and 2 are equivalent, as are nodes 4 and 5.  We introduce the ansatz eigenvector \n$$v=(x,x,z,y,y)^T.$$\n2.  The eigenvalue equations $Av=\\lambda v$ give, for node 1,\n$$\n\\lambda x = x + z,\n$$\nfor node 4,\n$$\n\\lambda y = y + z,\n$$\nand for node 3,\n$$\n\\lambda z = 2(x+y).\n$$\n3.  From the first two,\n$$\nz = (\\lambda-1)x,\n\\qquad\nz=(\\lambda-1)y,\n$$\nso either $\\lambda=1$ or $x=y$.  The root $\\lambda=1$ is a valid eigenvalue but not the largest.  For $x=y$, set $a=x=y$, $z=a(\\lambda-1)$ and substitute into the third equation:\n$$\n\\lambda\\bigl[a(\\lambda-1)\\bigr]=2(2a)\n\\;\\;\\Longrightarrow\\;\\;\n\\lambda(\\lambda-1)=4\n\\;\\;\\Longrightarrow\\;\\;\n\\lambda^2-\\lambda-4=0.\n$$\n4.  The two solutions are\n$$\n\\lambda = \\frac{1\\pm\\sqrt{1+16}}{2}\n=\\frac{1\\pm\\sqrt{17}}{2}.\n$$\nHence the largest eigenvalue is\n$$\n\\Lambda(A)=\\frac{1+\\sqrt{17}}{2}.\n$$\n5.  Therefore the epidemic threshold is\n$$\n\\tau_c=\\frac{1}{\\Lambda(A)}\n=\\frac{2}{1+\\sqrt{17}}.\n$$", "answer": "$$\\boxed{\\frac{2}{1+\\sqrt{17}}}$$", "id": "883388"}, {"introduction": "To bridge the gap between theoretical models and real-world outbreaks, we must be able to estimate model parameters from observational data. This exercise puts you in the role of an epidemiologist analyzing the timeline of an unfolding epidemic on a small network. You will use the powerful technique of Maximum Likelihood Estimation (MLE) to infer the most probable transmission rate, $\\beta$, given the exact sequence of infection times, a core skill in quantitative epidemiology and model validation.", "problem": "Consider a disease spreading on a static network of $N$ nodes according to a continuous-time Susceptible-Infected (SI) model. In this model, nodes can be in one of two states: Susceptible (S) or Infected (I). An infected node remains infected indefinitely.\n\nThe disease spreads along the edges of the network. If a susceptible node is connected to an infected node, an infection event can occur. The time until a specific infected node transmits the disease to a specific susceptible neighbor is an exponential random variable with rate $\\beta$. Consequently, the total rate at which a susceptible node $j$ gets infected is $\\lambda_j = k_j(t) \\beta$, where $k_j(t)$ is the number of infected neighbors of node $j$ at time $t$.\n\nYou are given the complete history of an epidemic on a specific network of four nodes, $\\{v_0, v_1, v_2, v_3\\}$. The network structure is a star graph, where node $v_0$ is the central hub connected to the three peripheral nodes $v_1, v_2$, and $v_3$. The peripheral nodes are not connected to each other.\n\nThe observed infection history is as follows:\n1.  At time $t_0 = 0$, the central node $v_0$ is infected.\n2.  At time $t_1 > t_0$, node $v_1$ becomes infected.\n3.  At time $t_2 > t_1$, node $v_2$ becomes infected.\n4.  At time $t_3 > t_2$, node $v_3$ becomes infected, completing the spread.\n\nBased on this observed history, find the maximum likelihood estimate for the transmission rate $\\beta$. Express your answer as a closed-form analytical expression in terms of the given infection times $t_1$, $t_2$, and $t_3$.", "solution": "We label the observed event times as $t_1,t_2,t_3$ with $0<t_1<t_2<t_3$ and derive the joint density $L(\\beta)=f(t_1,t_2,t_3\\mid\\beta)$.\n\n1. Between $0$ and $t_1$, three susceptible nodes each have hazard~$\\beta$, so the time to first infection is $\\text{Exp}(3\\beta)$ and the probability it is $v_1$ is $1/3$. Thus\n$$\nL_1 \\;=\\; e^{-3\\beta t_1}\\,(3\\beta)\\,\\frac13 \\;=\\;\\beta e^{-3\\beta t_1}\\,. \n$$\n\n2. Between $t_1$ and $t_2$, two susceptibles remain, so the time to next infection is $\\text{Exp}(2\\beta)$ and the probability it is $v_2$ is $1/2$. Hence\n$$\nL_2 \\;=\\; e^{-2\\beta (t_2-t_1)}\\,(2\\beta)\\,\\frac12 \\;=\\;\\beta e^{-2\\beta (t_2-t_1)}\\,. \n$$\n\n3. Between $t_2$ and $t_3$, one susceptible remains, so the time to last infection is $\\text{Exp}(\\beta)$ and it must be $v_3$. Thus\n$$\nL_3 \\;=\\; e^{-\\beta (t_3-t_2)}\\,(\\beta) \\;=\\;\\beta e^{-\\beta (t_3-t_2)}\\,. \n$$\n\n4. The full likelihood is\n$$\nL(\\beta)\n= L_1\\,L_2\\,L_3\n= \\beta^3\\,\ne^{-\\,\\bigl[3\\beta t_1+2\\beta(t_2-t_1)+\\beta(t_3-t_2)\\bigr]}\n= \\beta^3e^{-\\beta(t_1+t_2+t_3)}\\,. \n$$\n\n5. The log-likelihood is \n$$\n\\ell(\\beta)=3\\ln\\beta-\\beta(t_1+t_2+t_3)\\,,\n$$\nso\n$$\n\\frac{d\\ell}{d\\beta}=\\frac{3}{\\beta}-(t_1+t_2+t_3)\\;\\overset{!}{=}0\n\\quad\\Longrightarrow\\quad\n\\hat\\beta=\\frac{3}{t_1+t_2+t_3}\\,. \n$$", "answer": "$$\\boxed{\\frac{3}{t_1+t_2+t_3}}$$", "id": "883335"}]}