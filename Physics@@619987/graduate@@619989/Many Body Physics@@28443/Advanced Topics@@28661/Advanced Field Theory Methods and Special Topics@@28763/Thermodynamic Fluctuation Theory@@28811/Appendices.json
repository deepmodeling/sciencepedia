{"hands_on_practices": [{"introduction": "A central tenet of statistical mechanics is that the response of a system to an external stimulus is intimately related to its spontaneous fluctuations in thermal equilibrium. This first exercise provides a classic and concrete demonstration of this principle by asking you to apply the fluctuation-compressibility theorem. By calculating the isothermal compressibility $\\kappa_T$ of a Van der Waals gas from its particle number fluctuations, you will solidify your understanding of the grand canonical ensemble and see how interactions modify the properties of a system away from the ideal gas limit. [@problem_id:1208415]", "problem": "In the grand canonical ensemble (GCE), a system is held at constant temperature $T$, volume $V$, and chemical potential $\\mu$. The number of particles $N$ is allowed to fluctuate. The variance of the particle number is related to the isothermal compressibility $\\kappa_T$ by the fluctuation-compressibility theorem:\n$$ \\kappa_T = \\frac{V}{\\langle N \\rangle^2 k_B T} \\langle (\\Delta N)^2 \\rangle $$\nwhere $\\langle (\\Delta N)^2 \\rangle = \\langle N^2 \\rangle - \\langle N \\rangle^2$ and $k_B$ is the Boltzmann constant. Furthermore, the particle number fluctuations are given by\n$$ \\langle (\\Delta N)^2 \\rangle = k_B T \\left(\\frac{\\partial \\langle N \\rangle}{\\partial \\mu}\\right)_{T, V} $$\nThe properties of a Van der Waals gas are derived from its Helmholtz free energy $F(N,V,T)$:\n$$ F(N, V, T) = -N k_B T \\left[ \\ln\\left(\\frac{V-Nb}{N\\lambda_T^3}\\right) + 1 \\right] - \\frac{a N^2}{V} $$\nwhere $a$ and $b$ are the Van der Waals parameters, and $\\lambda_T$ is the thermal de Broglie wavelength, which depends only on the temperature $T$ and the particle mass.\n\nUsing these relations, calculate the isothermal compressibility $\\kappa_T$ for a Van der Waals gas. Express your final answer in terms of the number density $n = N/V$, temperature $T$, and the parameters $a$ and $b$. In the thermodynamic limit, you can replace $\\langle N \\rangle$ with $N$.", "solution": "The isothermal compressibility $\\kappa_T$ is given by the fluctuation-compressibility theorem:\n\n$$\n\\kappa_T = \\frac{V}{\\langle N \\rangle^2 k_B T} \\langle (\\Delta N)^2 \\rangle\n$$\n\nwhere $\\langle (\\Delta N)^2 \\rangle = \\langle N^2 \\rangle - \\langle N \\rangle^2$. In the grand canonical ensemble, the particle number fluctuations are:\n\n$$\n\\langle (\\Delta N)^2 \\rangle = k_B T \\left( \\frac{\\partial \\langle N \\rangle}{\\partial \\mu} \\right)_{T, V}\n$$\n\nSubstituting this into the expression for $\\kappa_T$:\n\n$$\n\\kappa_T = \\frac{V}{\\langle N \\rangle^2 k_B T} \\cdot k_B T \\left( \\frac{\\partial \\langle N \\rangle}{\\partial \\mu} \\right)_{T, V} = \\frac{V}{\\langle N \\rangle^2} \\left( \\frac{\\partial \\langle N \\rangle}{\\partial \\mu} \\right)_{T, V}\n$$\n\nIn the thermodynamic limit, $\\langle N \\rangle$ is replaced by $N$, so:\n\n$$\n\\kappa_T = \\frac{V}{N^2} \\left( \\frac{\\partial N}{\\partial \\mu} \\right)_{T, V}\n$$\n\nThe chemical potential $\\mu$ is derived from the Helmholtz free energy $F(N, V, T)$ for a Van der Waals gas. The chemical potential is:\n\n$$\n\\mu = \\left( \\frac{\\partial F}{\\partial N} \\right)_{V, T}\n$$\n\nPerforming the derivative of the given Helmholtz free energy yields:\n\n$$\n\\mu = -k_B T \\ln \\left( \\frac{V - N b}{N \\lambda_T^3} \\right) + \\frac{N b k_B T}{V - N b} - \\frac{2 a N}{V}\n$$\n\nTo find $\\left( \\frac{\\partial N}{\\partial \\mu} \\right)_{T, V}$, we first compute $\\left( \\frac{\\partial \\mu}{\\partial N} \\right)_{T, V}$ and take its reciprocal. Differentiating $\\mu$ with respect to $N$:\n\n$$\n\\frac{\\partial \\mu}{\\partial N} = k_B T \\left[ \\frac{1}{N} + \\frac{b}{V - N b} + \\frac{b V}{(V - N b)^2} \\right] - \\frac{2 a}{V}\n$$\n\nThe term in the bracket can be simplified. Using the number density $n=N/V$, it can be shown that $V \\left[ \\frac{1}{N} + \\frac{b}{V - N b} + \\frac{b V}{(V - N b)^2} \\right] = \\frac{1}{n(1-bn)^2}$. Therefore:\n\n$$\n\\frac{\\partial \\mu}{\\partial N} = \\frac{1}{V} \\left[ \\frac{k_B T}{n (1 - b n)^2} - 2 a \\right]\n$$\n\nNow we find its reciprocal:\n\n$$\n\\left( \\frac{\\partial N}{\\partial \\mu} \\right)_{T, V} = \\frac{1}{\\frac{1}{V} \\left[ \\frac{k_B T}{n (1 - b n)^2} - 2 a \\right]} = \\frac{V}{\\frac{k_B T}{n (1 - b n)^2} - 2 a}\n$$\n\nSubstitute this into the expression for $\\kappa_T$:\n\n$$\n\\kappa_T = \\frac{V}{N^2} \\cdot \\frac{V}{\\frac{k_B T}{n (1 - b n)^2} - 2 a} = \\frac{V^2}{N^2} \\cdot \\frac{1}{\\frac{k_B T}{n (1 - b n)^2} - 2 a}\n$$\n\nSince $n = N/V$, then $V^2 / N^2 = 1 / n^2$:\n\n$$\n\\kappa_T = \\frac{1}{n^2} \\cdot \\frac{1}{\\frac{k_B T}{n (1 - b n)^2} - 2 a} = \\frac{1}{n^2 \\left( \\frac{k_B T - 2an(1-bn)^2}{n(1-bn)^2} \\right)}\n$$\n\nSimplifying this gives the final result for the isothermal compressibility of a Van der Waals gas.", "answer": "$$ \\boxed{\\dfrac{\\left(1 - b n\\right)^{2}}{n \\left[k_{B} T - 2 a n \\left(1 - b n\\right)^{2}\\right]}} $$", "id": "1208415"}, {"introduction": "Thermodynamic systems are characterized by several fluctuating quantities, and often their fluctuations are not independent. This exercise moves beyond the variance of a single variable to explore the covariance between two, specifically the entropy $S$ and volume $V$ in the isothermal-isobaric (NPT) ensemble. Calculating the correlator $\\langle \\Delta S \\Delta V \\rangle$ deepens your understanding of how different thermodynamic properties are intertwined and reveals its direct connection to the material's thermal expansion coefficient $\\alpha_P$. [@problem_id:1208926]", "problem": "Consider a system of $N$ particles in thermal equilibrium with a large reservoir at a constant temperature $T$ and constant pressure $P$. This corresponds to the isothermal-isobaric (NPT) ensemble in statistical mechanics. In this ensemble, the volume $V$ and the energy $E$ of the system are not fixed but fluctuate around their mean values. Consequently, the entropy $S$ of the system, being a function of its energy and volume, also fluctuates.\n\nWe are interested in the correlation between the fluctuations of the system's entropy and its volume. Let $\\Delta S = S - \\langle S \\rangle$ and $\\Delta V = V - \\langle V \\rangle$ be the deviations of the entropy and volume from their respective mean values.\n\nYour task is to derive an expression for the entropy-volume fluctuation correlator, $\\langle \\Delta S \\Delta V \\rangle$. Express your final answer in terms of the temperature $T$, the mean volume $\\langle V \\rangle$ (which we will denote simply as $V$), the Boltzmann constant $k_B$, and the isobaric thermal expansion coefficient $\\alpha_P$, defined as:\n$$ \\alpha_P = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_P $$", "solution": "We begin by expressing the entropy fluctuation $\\Delta S$ in terms of energy and volume fluctuations. The fundamental thermodynamic relation gives:\n\n$$\ndS = \\frac{1}{T} dE + \\frac{P}{T} dV\n$$\n\nFor small fluctuations, this implies:\n\n$$\n\\Delta S \\approx \\frac{1}{T} \\Delta E + \\frac{P}{T} \\Delta V\n$$\n\nwhere $\\Delta E = E - \\langle E \\rangle$ and $\\Delta V = V - \\langle V \\rangle$.\n\nThe entropy-volume fluctuation correlator is:\n\n$$\n\\langle \\Delta S \\Delta V \\rangle = \\left\\langle \\left( \\frac{1}{T} \\Delta E + \\frac{P}{T} \\Delta V \\right) \\Delta V \\right\\rangle = \\frac{1}{T} \\langle \\Delta E \\Delta V \\rangle + \\frac{P}{T} \\langle (\\Delta V)^2 \\rangle\n$$\n\n\nIn the NPT ensemble, the volume fluctuation variance is:\n\n$$\n\\langle (\\Delta V)^2 \\rangle = k_B T V \\kappa_T\n$$\n\nwhere $\\kappa_T = -\\frac{1}{V} \\left( \\frac{\\partial V}{\\partial P} \\right)_T$ is the isothermal compressibility.\n\nThe energy-volume correlator is given by:\n\n$$\n\\langle \\Delta E \\Delta V \\rangle = k_B T^2 \\left( \\frac{\\partial V}{\\partial T} \\right)_P - P \\langle (\\Delta V)^2 \\rangle\n$$\n\nSubstituting $\\langle (\\Delta V)^2 \\rangle$:\n\n$$\n\\langle \\Delta E \\Delta V \\rangle = k_B T^2 \\left( \\frac{\\partial V}{\\partial T} \\right)_P - P k_B T V \\kappa_T\n$$\n\n\nNow substitute this into the expression for $\\langle \\Delta S \\Delta V \\rangle$:\n\n$$\n\\langle \\Delta S \\Delta V \\rangle = \\frac{1}{T} \\left[ k_B T^2 \\left( \\frac{\\partial V}{\\partial T} \\right)_P - P k_B T V \\kappa_T \\right] + \\frac{P}{T} \\left( k_B T V \\kappa_T \\right)\n$$\n\nSimplifying:\n\n$$\n\\langle \\Delta S \\Delta V \\rangle = k_B T \\left( \\frac{\\partial V}{\\partial T} \\right)_P - P k_B V \\kappa_T + P k_B V \\kappa_T\n$$\n\nThe last two terms cancel, leaving:\n\n$$\n\\langle \\Delta S \\Delta V \\rangle = k_B T \\left( \\frac{\\partial V}{\\partial T} \\right)_P\n$$\n\n\nThe isobaric thermal expansion coefficient is defined as:\n\n$$\n\\alpha_P = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_P\n$$\n\nThus:\n\n$$\n\\left( \\frac{\\partial V}{\\partial T} \\right)_P = V \\alpha_P\n$$\n\nSubstituting this in:\n\n$$\n\\langle \\Delta S \\Delta V \\rangle = k_B T \\cdot V \\alpha_P\n$$\n\n\nTherefore, the entropy-volume fluctuation correlator is $k_B T V \\alpha_P$.", "answer": "The final result is:\n$$ \\boxed{k_B T V \\alpha_P} $$", "id": "1208926"}, {"introduction": "The power of fluctuation theorems extends far beyond analytical calculations, forming the bedrock of many modern computational methods. This final practice problem challenges you to act as a computational physicist, applying the same fluctuation-compressibility theorem from our first exercise to analyze simulated data from a Path Integral Monte Carlo (PIMC) run. By extracting the isothermal compressibility $\\kappa_T$ from a raw data series of particle numbers, you will experience firsthand how these fundamental principles are used to calculate material properties in cutting-edge research. [@problem_id:2425076]", "problem": "A quantum fluid is simulated using Path Integral Monte Carlo (PIMC). The system is modeled in the grand canonical ensemble at equilibrium, and the Path Integral Monte Carlo (PIMC) simulation produces a time series of particle numbers, one integer per configuration, denoted by the sequence $\\{N_i\\}_{i=1}^{M}$, for a fixed volume $V$ and temperature $T$. The isothermal compressibility $\\kappa_T$ is defined thermodynamically by $\\kappa_T = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_T$ and is related, in the grand canonical ensemble at equilibrium, to density fluctuations via equilibrium statistical mechanics. The Boltzmann constant has the exact value $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$. Using only first principles of statistical mechanics that connect equilibrium fluctuations of $\\{N_i\\}$ to $\\kappa_T$, compute $\\kappa_T$ for each dataset below. Express each final numerical result in inverse pascals ($\\mathrm{Pa}^{-1}$).\n\nInput data consist of four independent datasets, each specified by:\n- a list of particle numbers $\\{N_i\\}$ recorded from an equilibrated Path Integral Monte Carlo (PIMC) run,\n- a system volume $V$ in $\\mathrm{m}^3$,\n- a temperature $T$ in $\\mathrm{K}$.\n\nTest suite (use exactly these values):\n- Case $1$: $\\{N_i\\} = [64,63,65,64,66,62,64,65,63,64,66,63,65,64,64,63,66,62,64,65]$, $V = 2.935780\\times 10^{-27}\\ \\mathrm{m}^3$, $T = 2.0\\ \\mathrm{K}$.\n- Case $2$: $\\{N_i\\} = [50,50,50,50,50,50,50,50,50,50]$, $V = 2.293578\\times 10^{-27}\\ \\mathrm{m}^3$, $T = 3.0\\ \\mathrm{K}$.\n- Case $3$: $\\{N_i\\} = [29,30,31,30,29,32,28,31,30,29,31,30,30,29,32]$, $V = 1.376147\\times 10^{-27}\\ \\mathrm{m}^3$, $T = 1.5\\ \\mathrm{K}$.\n- Case $4$: $\\{N_i\\} = [100,100,100,99,101,100,100,100,100,100,99,101,100,100,100,100,100,100,100,100]$, $V = 4.587156\\times 10^{-27}\\ \\mathrm{m}^3$, $T = 10.0\\ \\mathrm{K}$.\n\nYour program must:\n- For each case, use the provided $\\{N_i\\}$, $V$, and $T$ to compute a single floating-point value for $\\kappa_T$ in $\\mathrm{Pa}^{-1}$.\n- Produce a single line of output containing the four results, in the order of the cases above, as a comma-separated list enclosed in square brackets. Each number must be formatted in scientific notation with six digits after the decimal point, using the exact format $\\{\\:.6\\mathrm{e}\\}$ for each entry. For example, an acceptable output format is $[x_1,x_2,x_3,x_4]$ where each $x_j$ appears like $1.234567\\mathrm{e}{-08}$.\n\nThere is no additional input. Angles do not appear. All outputs must be in $\\mathrm{Pa}^{-1}$ as specified. The only accepted final output is a single line of the specified list format.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique, meaningful solution. The problem asks for the computation of the isothermal compressibility, $\\kappa_T$, from particle number fluctuations observed in a Path Integral Monte Carlo (PIMC) simulation performed in the grand canonical ensemble. This is a standard application of the fluctuation-dissipation theorem in statistical mechanics.\n\nWe begin from first principles. The isothermal compressibility is defined thermodynamically as\n$$ \\kappa_T = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T,N} $$\nwhere $V$ is the volume, $P$ is the pressure, $T$ is the temperature, and the derivative is taken at a constant number of particles $N$. This definition is inconvenient for the grand canonical ensemble, where the natural variables are temperature $T$, volume $V$, and chemical potential $\\mu$. The number of particles $N$ fluctuates. We must therefore re-express $\\kappa_T$ in terms of particle number fluctuations.\n\nUsing thermodynamic identities, $\\kappa_T$ can be related to the derivative of pressure with respect to number density, $\\rho = N/V$, at constant temperature:\n$$ \\kappa_T = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial P}\\right)_T $$\nThe Gibbs-Duhem relation for a system at constant temperature is $N d\\mu = V dP$. This leads to $dP = (N/V) d\\mu = \\rho d\\mu$, which implies that $(\\partial P / \\partial \\mu)_T = \\rho$. Therefore, $(\\partial \\rho / \\partial P)_T = (\\partial \\rho / \\partial \\mu)_T (\\partial \\mu / \\partial P)_T = (\\partial \\rho / \\partial \\mu)_T (1/\\rho)$.\nSubstituting this into the expression for $\\kappa_T$ gives:\n$$ \\kappa_T = \\frac{1}{\\rho^2}\\left(\\frac{\\partial \\rho}{\\partial \\mu}\\right)_T $$\nAs the volume $V$ is fixed, we can write $\\rho = \\langle N \\rangle / V$, where $\\langle N \\rangle$ is the average number of particles. The derivative becomes $(\\partial \\rho / \\partial \\mu)_T = (1/V)(\\partial \\langle N \\rangle / \\partial \\mu)_{T,V}$. This yields:\n$$ \\kappa_T = \\frac{V}{\\langle N \\rangle^2}\\left(\\frac{\\partial \\langle N \\rangle}{\\partial \\mu}\\right)_{T,V} $$\nThe next step is to connect the response function $(\\partial \\langle N \\rangle / \\partial \\mu)_{T,V}$ to the fluctuations in the particle number. In the grand canonical ensemble, the average particle number is given by\n$$ \\langle N \\rangle = \\frac{\\sum_j N_j e^{-\\beta(E_j - \\mu N_j)}}{\\sum_j e^{-\\beta(E_j - \\mu N_j)}} $$\nwhere $\\beta = 1/(k_B T)$ and the sum is over all microstates $j$ of the system. Differentiating $\\langle N \\rangle$ with respect to $\\mu$ at constant $T$ and $V$ yields a central result of statistical mechanics:\n$$ \\left(\\frac{\\partial \\langle N \\rangle}{\\partial \\mu}\\right)_{T,V} = \\beta (\\langle N^2 \\rangle - \\langle N \\rangle^2) = \\frac{\\sigma_N^2}{k_B T} $$\nHere, $\\sigma_N^2 = \\langle N^2 \\rangle - \\langle N \\rangle^2$ is the variance of the particle number.\n\nBy substituting this fluctuation formula into our expression for $\\kappa_T$, we arrive at the final, computationally useful equation:\n$$ \\kappa_T = \\frac{V (\\langle N^2 \\rangle - \\langle N \\rangle^2)}{k_B T \\langle N \\rangle^2} $$\nThe problem provides a discrete time series of particle numbers, $\\{N_i\\}_{i=1}^{M}$, from which we must estimate the ensemble averages. For a sufficiently long and equilibrated simulation, these averages can be estimated by their sample counterparts:\n- The average particle number $\\langle N \\rangle$ is estimated by the sample mean $\\bar{N} = \\frac{1}{M}\\sum_{i=1}^{M} N_i$.\n- The particle number fluctuation term $\\langle N^2 \\rangle - \\langle N \\rangle^2$ is estimated by the sample variance (using the population formula, i.e., with denominator $M$), which is equivalent to $\\left(\\frac{1}{M}\\sum_{i=1}^{M} N_i^2\\right) - \\bar{N}^2$.\n\nThe entire calculation thus reduces to computing the mean and variance of the provided list of particle numbers $\\{N_i\\}$ for each case and substituting these values, along with the given $V$, $T$, and the constant $k_B$, into the derived formula. All units are in the SI system, so the input values for $V$ in $\\mathrm{m}^3$, $T$ in $\\mathrm{K}$, and $k_B$ in $\\mathrm{J/K}$ will produce a result for $\\kappa_T$ in $\\mathrm{Pa}^{-1}$, as required.\n\nFor Case $2$, where all $N_i$ are identical, the variance is zero, correctly yielding $\\kappa_T = 0$. This corresponds to an incompressible fluid, where no particle number fluctuations are observed in a fixed volume at fixed chemical potential.\n\nThe following Python program implements this procedure. It iterates through each dataset, computes the necessary statistical quantities using the `numpy` library, and calculates $\\kappa_T$ according to the derived formula. The results are then formatted and printed as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the isothermal compressibility from Path Integral Monte Carlo data\n    for four test cases.\n    \"\"\"\n    # The Boltzmann constant, k_B, in J/K.\n    k_B = 1.380649e-23\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            [64, 63, 65, 64, 66, 62, 64, 65, 63, 64, 66, 63, 65, 64, 64, 63, 66, 62, 64, 65],\n            2.935780e-27,\n            2.0\n        ),\n        (\n            [50, 50, 50, 50, 50, 50, 50, 50, 50, 50],\n            2.293578e-27,\n            3.0\n        ),\n        (\n            [29, 30, 31, 30, 29, 32, 28, 31, 30, 29, 31, 30, 30, 29, 32],\n            1.376147e-27,\n            1.5\n        ),\n        (\n            [100, 100, 100, 99, 101, 100, 100, 100, 100, 100, 99, 101, 100, 100, 100, 100, 100, 100, 100, 100],\n            4.587156e-27,\n            10.0\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        N_samples, V, T = case\n        \n        # Convert the list of particle numbers to a NumPy array for efficient calculation.\n        N_array = np.array(N_samples, dtype=np.float64)\n\n        # Estimate ensemble averages with sample averages.\n        # mean_N estimates N\n        mean_N = np.mean(N_array)\n        \n        # var_N (population variance, ddof=0 by default) estimates N^2 - N^2\n        var_N = np.var(N_array)\n\n        # The formula for isothermal compressibility in the grand canonical ensemble is:\n        # kappa_T = (V * (N^2 - N^2)) / (k_B * T * N^2)\n        # We handle the case where mean_N is zero to avoid division by zero,\n        # although it is not expected for the given data.\n        if mean_N == 0:\n            # If there are no particles on average, compressibility is ill-defined or infinite.\n            # In a physical context of fluctuations, var_N would also be 0, leading to an indeterminate form.\n            # For this problem, we can assume mean_N  0.\n            # Setting kappa_T to 0 is a safe choice if this case were to occur.\n            kappa_T = 0.0\n        else:\n            numerator = V * var_N\n            denominator = k_B * T * mean_N**2\n            kappa_T = numerator / denominator\n        \n        results.append(kappa_T)\n\n    # Final print statement in the exact required format.\n    # Each number is formatted in scientific notation with six digits after the decimal point.\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```", "id": "2425076"}]}