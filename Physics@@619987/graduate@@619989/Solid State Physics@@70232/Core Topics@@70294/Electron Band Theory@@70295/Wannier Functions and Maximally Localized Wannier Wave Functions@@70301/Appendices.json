{"hands_on_practices": [{"introduction": "We begin with the fundamental construction of a Wannier function. This exercise will guide you through the process of transforming a set of delocalized Bloch waves into a single localized Wannier function, reinforcing the core mathematical definition that connects the reciprocal-space and real-space descriptions of electrons in a crystal [@problem_id:260311].", "problem": "In solid-state physics, the electronic states in a periodic potential are described by Bloch functions, $\\psi_{nk}(\\mathbf{r}) = e^{i\\mathbf{k} \\cdot \\mathbf{r}} u_{n\\mathbf{k}}(\\mathbf{r})$, where $n$ is the band index, $\\mathbf{k}$ is the crystal momentum, and $u_{n\\mathbf{k}}(\\mathbf{r})$ is a periodic function with the same periodicity as the crystal lattice.\n\nAn alternative, equivalent basis is the set of Wannier functions, which are localized around the lattice sites. For a one-dimensional crystal with lattice constant $a$, the Wannier function for band $n$ centered at the origin ($R=0$) is defined as the Fourier transform of the corresponding Bloch functions over the first Brillouin zone:\n$$ w_n(x) = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\psi_{nk}(x) \\, dk $$\nSubstituting the Bloch form $\\psi_{nk}(x) = e^{ikx} u_{nk}(x)$, this becomes:\n$$ w_n(x) = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} e^{ikx} u_{nk}(x) \\, dk $$\nConsider a simplified model for the lowest energy band ($n=1$) of a one-dimensional crystal. The periodic part of the Bloch function, $u_{1k}(x)$, is given by:\n$$ u_{1k}(x) = A + 2B \\cos(ka) \\cos\\left(\\frac{2\\pi x}{a}\\right) $$\nwhere $A$ and $B$ are real constants. This form is real and satisfies the time-reversal symmetry condition $u_{1k}(x) = u_{1,-k}(x)$.\n\nYour task is to calculate the explicit form of the Wannier function $w_1(x)$ for this band, centered at the origin.", "solution": "The Wannier function for the lowest energy band ($n=1$) centered at the origin is defined as:\n$$\nw_1(x) = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\psi_{1k}(x)  dk\n$$\nwhere $\\psi_{1k}(x) = e^{ikx} u_{1k}(x)$ and $u_{1k}(x) = A + 2B \\cos(ka) \\cos\\left(\\frac{2\\pi x}{a}\\right)$. Substituting the expression for $\\psi_{1k}(x)$:\n$$\nw_1(x) = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} e^{ikx} \\left[ A + 2B \\cos(ka) \\cos\\left(\\frac{2\\pi x}{a}\\right) \\right]  dk\n$$\nSplit the integral into two parts:\n$$\nw_1(x) = \\frac{a}{2\\pi} \\left[ A \\int_{-\\pi/a}^{\\pi/a} e^{ikx}  dk + 2B \\cos\\left(\\frac{2\\pi x}{a}\\right) \\int_{-\\pi/a}^{\\pi/a} e^{ikx} \\cos(ka)  dk \\right]\n$$\nDenote the integrals as $I_1$ and $I_2$:\n$$\nI_1 = \\int_{-\\pi/a}^{\\pi/a} e^{ikx}  dk, \\quad I_2 = \\int_{-\\pi/a}^{\\pi/a} e^{ikx} \\cos(ka)  dk\n$$\n\nFirst, compute $I_1$ for $x \\neq 0$:\n$$\nI_1 = \\left[ \\frac{e^{ikx}}{ix} \\right]_{-\\pi/a}^{\\pi/a} = \\frac{1}{ix} \\left( e^{i\\pi x / a} - e^{-i\\pi x / a} \\right) = \\frac{2 \\sin(\\pi x / a)}{x}\n$$\n\nNext, compute $I_2$ using $\\cos(ka) = \\frac{e^{i ka} + e^{-i ka}}{2}$:\n$$\nI_2 = \\int_{-\\pi/a}^{\\pi/a} e^{ikx} \\cdot \\frac{e^{i ka} + e^{-i ka}}{2}  dk = \\frac{1}{2} \\left[ \\int_{-\\pi/a}^{\\pi/a} e^{i k (x + a)}  dk + \\int_{-\\pi/a}^{\\pi/a} e^{i k (x - a)}  dk \\right]\n$$\nEach integral is of the form $\\int_{-\\pi/a}^{\\pi/a} e^{i k p}  dk$ for $p = x + a$ and $p = x - a$, which evaluates to $\\frac{2 \\sin(\\pi p / a)}{p}$ for $p \\neq 0$. Thus:\n$$\nI_2 = \\frac{1}{2} \\left[ \\frac{2 \\sin(\\pi (x + a) / a)}{x + a} + \\frac{2 \\sin(\\pi (x - a) / a)}{x - a} \\right]\n$$\nSimplify the arguments:\n$$\n\\sin\\left(\\pi \\frac{x + a}{a}\\right) = \\sin\\left(\\frac{\\pi x}{a} + \\pi\\right) = -\\sin\\left(\\frac{\\pi x}{a}\\right), \\quad \\sin\\left(\\pi \\frac{x - a}{a}\\right) = \\sin\\left(\\frac{\\pi x}{a} - \\pi\\right) = -\\sin\\left(\\frac{\\pi x}{a}\\right)\n$$\nSo:\n$$\nI_2 = \\frac{1}{2} \\left[ \\frac{-2 \\sin(\\pi x / a)}{x + a} + \\frac{-2 \\sin(\\pi x / a)}{x - a} \\right] = -\\sin\\left(\\frac{\\pi x}{a}\\right) \\left[ \\frac{1}{x + a} + \\frac{1}{x - a} \\right]\n$$\nCombine the terms in the brackets:\n$$\n\\frac{1}{x + a} + \\frac{1}{x - a} = \\frac{(x - a) + (x + a)}{(x + a)(x - a)} = \\frac{2x}{x^2 - a^2}\n$$\nThus:\n$$\nI_2 = -\\sin\\left(\\frac{\\pi x}{a}\\right) \\cdot \\frac{2x}{x^2 - a^2} = -\\frac{2x \\sin(\\pi x / a)}{x^2 - a^2}\n$$\n\nSubstitute $I_1$ and $I_2$ back into the expression for $w_1(x)$:\n$$\nw_1(x) = \\frac{a}{2\\pi} \\left[ A \\cdot \\frac{2 \\sin(\\pi x / a)}{x} + 2B \\cos\\left(\\frac{2\\pi x}{a}\\right) \\cdot \\left( -\\frac{2x \\sin(\\pi x / a)}{x^2 - a^2} \\right) \\right]\n$$\nFactor out common terms:\n$$\nw_1(x) = \\frac{a}{2\\pi} \\cdot 2 \\sin\\left(\\frac{\\pi x}{a}\\right) \\left[ \\frac{A}{x} - \\frac{2B x \\cos(2\\pi x / a)}{x^2 - a^2} \\right] = \\frac{a \\sin(\\pi x / a)}{\\pi} \\left( \\frac{A}{x} - \\frac{2B x \\cos(2\\pi x / a)}{x^2 - a^2} \\right)\n$$\n\nThis is the explicit form of the Wannier function for $x \\neq 0, \\pm a$. The expression is valid for all $x$ except these points, and the form is as derived.", "answer": "$$ \\boxed{ \\dfrac{ a \\, \\sin\\left( \\dfrac{ \\pi x }{ a } \\right) }{ \\pi } \\left( \\dfrac{ A }{ x } - \\dfrac{ 2 B x \\, \\cos\\left( \\dfrac{ 2 \\pi x }{ a } \\right) }{ x^{2} - a^{2} } \\right) } $$", "id": "260311"}, {"introduction": "Beyond its shape, the average position, or 'center', of a Wannier function is a crucial physical quantity directly related to the material's electric polarization. This practice delves into calculating the Wannier center for the famous Su-Schrieffer-Heeger (SSH) model, providing a concrete example of the deep link between Wannier functions and the topological properties of matter [@problem_id:260308].", "problem": "Consider the one-dimensional Su-Schrieffer-Heeger (SSH) model of a dimerized chain of atoms. The system consists of a single chain of sites with alternating hopping amplitudes. The unit cell contains two sites, labeled A and B. The positions of the atoms in the $n$-th unit cell are given by $x_{n,A} = na$ and $x_{n,B} = na + d_0$, where $a$ is the lattice constant and $0 < d_0 < a$.\n\nThe tight-binding Hamiltonian for this system is given by:\n$$ H = \\sum_n \\left( v \\left( |n,A\\rangle\\langle n,B| + |n,B\\rangle\\langle n,A| \\right) + w \\left( |n,B\\rangle\\langle n+1,A| + |n+1,A\\rangle\\langle n,B| \\right) \\right) $$\nwhere $|n,\\alpha\\rangle$ is the atomic orbital at site $\\alpha \\in \\{A, B\\}$ in unit cell $n$. The intra-cell hopping amplitude is $v$ (between site A and B in the same cell) and the inter-cell hopping amplitude is $w$ (between site B of one cell and site A of the next). We neglect on-site energies.\n\nAssume the system is in the topologically non-trivial phase, defined by the condition $w > v > 0$. In this gapped phase, the occupied (lower energy) band is well-separated from the unoccupied (higher energy) band. This allows for the construction of well-localized Wannier functions for the occupied band.\n\nThe center of the maximally localized Wannier function for the occupied band, localized in the home unit cell ($n=0$), is given by the formula:\n$$ \\bar{x} = \\bar{x}_{\\text{inter}} + \\bar{x}_{\\text{intra}} $$\nwhere\n$$ \\bar{x}_{\\text{inter}} = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} A(k) \\, dk \\quad \\text{with} \\quad A(k) = i \\langle u(k) | \\frac{d}{dk} | u(k) \\rangle $$\nis the inter-cell contribution, and\n$$ \\bar{x}_{\\text{intra}} = \\frac{a}{2\\pi} \\int_{-\\pi/a}^{\\pi/a} \\langle u(k) | \\hat{x}_{\\text{cell}} | u(k) \\rangle \\, dk $$\nis the intra-cell contribution. Here, $|u(k)\\rangle$ is the cell-periodic part of the Bloch state for the occupied band, normalized within the unit cell. The operator $\\hat{x}_{\\text{cell}} = x_A |A\\rangle\\langle A| + x_B |B\\rangle\\langle B|$ is the position operator restricted to the home unit cell, with $x_A=0$ and $x_B=d_0$.\n\nCalculate the Wannier center $\\bar{x}$ for the occupied band. Express your answer in terms of the geometric parameters $a$ and $d_0$.", "solution": "1. Bloch Hamiltonian and eigenstates  \nThe SSH Bloch Hamiltonian in the sublattice basis $\\{|A\\rangle,|B\\rangle\\}$ is \n$$\nH(k)=\\begin{pmatrix}0 & v + w e^{-ika}\\\\\nv + w e^{ika} & 0\\end{pmatrix}\n=\\mathbf{h}(k)\\cdot\\boldsymbol\\sigma,\\quad\n\\mathbf{h}(k)=(h_x,h_y,0),\n$$\nwith \n$$\nh_x=v+w\\cos(ka),\\quad h_y=w\\sin(ka),\\quad \n|\\mathbf{h}(k)|=\\sqrt{v^2+w^2+2vw\\cos(ka)}.\n$$\nThe normalized lower‐band eigenstate may be written in the form\n$$\n|u(k)\\rangle\n=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}\ne^{-i\\phi(k)}\\\\-1\n\\end{pmatrix},\\qquad\ne^{i\\phi(k)}=\\frac{h_x+ih_y}{|\\mathbf{h}(k)|}.\n$$\n\n2. Inter‐cell (Zak‐phase) contribution  \n$$\nA(k)\n=i\\langle u|\\partial_k u\\rangle\n=\\frac12\\,\\partial_k\\phi(k),\n$$\nso the Zak phase is \n$$\n\\gamma=\\int_{-\\pi/a}^{\\pi/a}A(k)\\,dk\n=\\frac12\\bigl[\\phi(\\pi/a)-\\phi(-\\pi/a)\\bigr]\n=\\pi\\quad(\\text{for }w>v>0).\n$$\nHence\n$$\n\\bar x_{\\rm inter}\n=\\frac{a}{2\\pi}\\,\\gamma\n=\\frac{a}{2}.\n$$\n\n3. Intra‐cell contribution  \n$$\n\\bar x_{\\rm intra}\n=\\frac{a}{2\\pi}\\int_{-\\pi/a}^{\\pi/a}\n\\langle u(k)|\\hat x_{\\rm cell}|u(k)\\rangle\\,dk,\n\\quad\n\\hat x_{\\rm cell}=0\\cdot|A\\rangle\\langle A|+d_0\\,|B\\rangle\\langle B|.\n$$\nSince $|u(k)\\rangle=(u_A,u_B)^T$ with $|u_A|^2+|u_B|^2=1$ and by sublattice symmetry one shows\n$$\n\\frac{1}{2\\pi}\\int_{-\\pi/a}^{\\pi/a}|u_B(k)|^2\\,dk=\\frac12,\n$$\nwe get\n$$\n\\bar x_{\\rm intra}\n=d_0\\times\\frac12\n=\\frac{d_0}{2}.\n$$\n\n4. Total Wannier center  \n$$\n\\bar x\n=\\bar x_{\\rm inter}+\\bar x_{\\rm intra}\n=\\frac{a}{2}+\\frac{d_0}{2}\n=\\frac{a+d_0}{2}.\n$$", "answer": "$$\\boxed{\\frac{a+d_{0}}{2}}$$", "id": "260308"}, {"introduction": "The choice of Wannier functions is not unique; we can exploit this 'gauge freedom' to find an optimal basis that is maximally localized. This exercise offers a practical glimpse into a computational algorithm for finding Maximally Localized Wannier Functions (MLWFs) by having you perform a single optimization step using the steepest-descent method [@problem_id:1279726].", "problem": "In the study of ultracold atoms in optical lattices, one often seeks a basis of localized states analogous to Wannier functions in solid-state physics. Maximally Localized Wannier Functions (MLWFs) provide such a basis. They are constructed from the Bloch eigenstates $\\psi_{n,k}(x)$ of the periodic potential. For a set of $N$ bands, one introduces a unitary mixing matrix $U^{(k)}$ at each crystal momentum $k$ to define a new set of orthonormal states:\n$$\n\\tilde{\\psi}_{n,k}(x) = \\sum_{m=1}^{N} \\psi_{m,k}(x) U_{mn}^{(k)}\n$$\nThe goal of the MLWF procedure is to find the set of matrices $\\{U^{(k)}\\}$ that minimizes the total spread functional $\\Omega$, which is the sum of the variances of the position operator for each Wannier function. A standard method for this minimization is a steepest-descent algorithm. In this algorithm, the unitary matrices are updated iteratively according to the rule:\n$$\nU^{(k)} \\rightarrow \\exp(-\\eta G^{(k)}) U^{(k)}\n$$\nHere, $\\eta$ is a small, positive, real-valued constant representing the step size, and $G^{(k)}$ is the Hermitian gradient of the spread functional $\\Omega$ with respect to the matrix elements of $U^{(k)}$.\n\nConsider a one-dimensional system with two relevant energy bands ($N=2$). At the start of the optimization procedure ($t=0$), the mixing matrices are chosen to be identity matrices, $U^{(k)}_{t=0} = I$. For a specific crystal momentum $k_0$, the gradient of the spread functional is calculated to be:\n$$\nG^{(k_0)} = G_0 \\begin{pmatrix} 0 & 1 - i \\\\ 1 + i & 0 \\end{pmatrix}\n$$\nwhere $G_0$ is a positive real constant with dimensions of area.\n\nAfter a single steepest-descent optimization step, a new unitary matrix $U^{(k_0)}_{t=1}$ is obtained. Calculate the off-diagonal element $(U^{(k_0)}_{t=1})_{12}$ of this new matrix.", "solution": "1. The update rule after one step ($U_{t=0}=I$) is\n$$\nU_{t=1} \\;=\\;\\exp\\bigl(-\\eta\\,G^{(k_0)}\\bigr)\\,I \\;=\\;\\exp\\bigl(-\\eta G_0 M\\bigr)\n$$\nwhere we define \n$$\nM = \\begin{pmatrix}0 & 1-i\\\\1+i & 0\\end{pmatrix}.\n$$\n\n2. Note that \n$$\nM^2 = \\begin{pmatrix}0 & 1-i\\\\1+i & 0\\end{pmatrix}^2\n= \\begin{pmatrix}(1-i)(1+i)&0\\\\0&(1+i)(1-i)\\end{pmatrix}\n=2\\,I\n$$\nso $M^2=2I$ and hence \n$$\n\\bigl(-\\eta G_0 M\\bigr)^2 = (\\eta G_0)^2\\,2\\,I = (\\eta G_0\\sqrt2)^2\\,I.\n$$\n\n3. For any matrix $A$ with $A^2 = \\lambda^2 I$, one has\n$$\n\\exp(A) = \\cosh(\\lambda)\\,I + \\frac{A}{\\lambda}\\sinh(\\lambda).\n$$\nHere $A=-\\eta G_0 M$ and $\\lambda=\\eta G_0\\sqrt2$, so\n$$\n\\exp(-\\eta G_0M)\n= \\cosh(\\eta G_0\\sqrt2)\\,I - \\frac{M}{\\sqrt2}\\,\\sinh(\\eta G_0\\sqrt2).\n$$\n\n4. The off-diagonal element $(U_{t=1})_{12}$ is then\n$$\n-\\frac{M_{12}}{\\sqrt2}\\,\\sinh(\\eta G_0\\sqrt2)\n= -\\frac{1 - i}{\\sqrt2}\\,\\sinh\\!\\bigl(\\sqrt2\\,\\eta G_0\\bigr).\n$$", "answer": "$$\\boxed{-\\frac{1 - i}{\\sqrt{2}}\\sinh\\!\\bigl(\\sqrt{2}\\,\\eta\\,G_0\\bigr)}$$", "id": "1279726"}]}