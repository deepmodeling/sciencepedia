{"hands_on_practices": [{"introduction": "The starting point of any measurement-based computation is the creation of a suitable cluster state. This exercise [@problem_id:652622] gets to the heart of resource preparation by asking a critical question: how robust is our state to a single error in its creation? By calculating the fidelity after a single CPHASE gate fails to apply, you will gain a quantitative understanding of preparation faults and appreciate a fundamental property of graph states.", "problem": "An $N$-qubit linear cluster state, denoted $|C_N\\rangle$, is a fundamental resource for one-way quantum computing. It can be generated by preparing $N$ qubits in the state $|\\psi_0\\rangle = |+\\rangle^{\\otimes N}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$, and then sequentially applying controlled-phase (CPHASE or CZ) gates to adjacent qubits. The CPHASE gate acting on qubits $i$ and $j$, denoted $CZ_{i,j}$, applies a phase of $-1$ to the state $|11\\rangle_{ij}$ and leaves other computational basis states unchanged. The total unitary operation for generating the ideal state is $U_{ideal} = CZ_{N-1,N} \\circ \\dots \\circ CZ_{2,3} \\circ CZ_{1,2}$, where the gate $CZ_{j,j+1}$ is applied after $CZ_{j-1,j}$. Thus, the ideal linear cluster state is $|\\psi_{ideal}\\rangle = U_{ideal} |\\psi_0\\rangle$.\n\nConsider a scenario where the generation process is faulty. Specifically, one of the CPHASE gates, $CZ_{k,k+1}$ for a given $k \\in \\{1, 2, \\dots, N-1\\}$, fails to be applied. This is equivalent to replacing the $CZ_{k,k+1}$ operation with the identity operator, $I_{k,k+1}$. The resulting faulty state is denoted $|\\psi_{faulty}\\rangle$.\n\nYour task is to derive the fidelity, $F = |\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle|^2$, between the ideal $N$-qubit linear cluster state and the state produced by the faulty process. The final result should be a real number.", "solution": "The problem asks for the fidelity $F = |\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle|^2$ between an ideal $N$-qubit linear cluster state and a faulty version where one CPHASE gate was missed.\n\n1.  **Define the states and unitaries:**\n    The initial state is $|\\psi_0\\rangle = |+\\rangle^{\\otimes N}$.\n    The CPHASE gate is $CZ_{j,j+1}$. It is a Hermitian and unitary operator, so $CZ_{j,j+1}^\\dagger = CZ_{j,j+1}$ and $CZ_{j,j+1}^2 = I$.\n    The ideal unitary is $U_{ideal} = \\left(\\prod_{j=1}^{N-1} CZ_{j,j+1}\\right)$, applied sequentially. Let's write this as $U_{ideal} = U_{N-1} \\circ \\dots \\circ U_1$, where $U_j = CZ_{j,j+1}$.\n    The ideal state is $|\\psi_{ideal}\\rangle = U_{ideal} |\\psi_0\\rangle = U_{N-1} \\cdots U_1 |\\psi_0\\rangle$.\n\n    The faulty process misses the gate $U_k = CZ_{k,k+1}$. The faulty unitary is:\n    $U_{faulty} = U_{N-1} \\cdots U_{k+1} \\cdot I_{k, k+1} \\cdot U_{k-1} \\cdots U_1$.\n    The faulty state is $|\\psi_{faulty}\\rangle = U_{faulty} |\\psi_0\\rangle$.\n\n2.  **Simplify the fidelity expression:**\n    The fidelity is $F = |\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle|^2$.\n    The inner product is $\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle = \\langle \\psi_0 | U_{ideal}^\\dagger U_{faulty} | \\psi_0 \\rangle$.\n    Let's analyze the operator product $U_{ideal}^\\dagger U_{faulty}$.\n    Since each $U_j$ is Hermitian, $U_{ideal}^\\dagger = (U_{N-1} \\cdots U_1)^\\dagger = U_1^\\dagger \\cdots U_{N-1}^\\dagger = U_1 \\cdots U_{N-1}$.\n    The CPHASE gates do not all commute, so we cannot simplify $U_{ideal}^\\dagger U_{faulty}$ to just $U_k$. Instead, we relate the states directly.\n    Let $U_{>k} = U_{N-1} \\cdots U_{k+1}$ and $U_{<k} = U_{k-1} \\cdots U_1$.\n    $|\\psi_{ideal}\\rangle = U_{>k} U_k U_{<k} |\\psi_0\\rangle$.\n    $|\\psi_{faulty}\\rangle = U_{>k} U_{<k} |\\psi_0\\rangle$.\n    The inner product becomes:\n    $$\n    \\langle \\psi_{ideal} | \\psi_{faulty} \\rangle = \\langle \\psi_0 | (U_{>k} U_k U_{<k})^\\dagger (U_{>k} U_{<k}) | \\psi_0 \\rangle\n    $$\n    $$\n    = \\langle \\psi_0 | U_{<k}^\\dagger U_k^\\dagger U_{>k}^\\dagger U_{>k} U_{<k} | \\psi_0 \\rangle\n    $$\n    Since $U_{>k}$ is unitary, $U_{>k}^\\dagger U_{>k} = I$. Since $U_k$ is Hermitian, $U_k^\\dagger=U_k$.\n    $$\n    \\langle \\psi_{ideal} | \\psi_{faulty} \\rangle = \\langle \\psi_0 | U_{<k}^\\dagger U_k U_{<k} | \\psi_0 \\rangle\n    $$\n    Let's define an intermediate state $|\\phi_k\\rangle = U_{<k} |\\psi_0\\rangle = (CZ_{k-1,k} \\cdots CZ_{1,2}) |+\\rangle^{\\otimes N}$. The inner product is then $\\langle \\phi_k | U_k | \\phi_k \\rangle = \\langle \\phi_k | CZ_{k,k+1} | \\phi_k \\rangle$.\n\n3.  **Analyze the state $|\\phi_k\\rangle$:**\n    The unitary $U_{<k}$ acts only on qubits $1, \\dots, k$. The state of qubits $k+1, \\dots, N$ remains $|+\\rangle$.\n    The state of qubits $1, \\dots, k$ is $(CZ_{k-1,k} \\cdots CZ_{1,2}) |+\\rangle^{\\otimes k}$, which is precisely the definition of a $k$-qubit linear cluster state, $|C_k\\rangle$.\n    So, $|\\phi_k\\rangle = |C_k\\rangle \\otimes |+\\rangle^{\\otimes (N-k)}$.\n\n4.  **Calculate the expectation value:**\n    We need to compute $E = \\langle \\phi_k | CZ_{k,k+1} | \\phi_k \\rangle$. The operator $CZ_{k,k+1}$ acts only on qubits $k$ and $k+1$. The expectation value can be found by tracing over the reduced density matrix of these two qubits, $\\rho_{k,k+1}$.\n    $$\n    E = \\mathrm{Tr}_{k,k+1}(\\rho_{k,k+1} CZ_{k,k+1})\n    $$\n    The state $|\\phi_k\\rangle$ is a product state between the system of qubits $\\{1, \\dots, k\\}$ and the qubit $k+1$. So, the reduced density matrix factorizes: $\\rho_{k,k+1} = \\rho_k \\otimes \\rho_{k+1}$.\n    The state of qubit $k+1$ is $|+\\rangle$, so $\\rho_{k+1} = |+\\rangle\\langle+|$.\n    The state of qubit $k$ is given by its reduced density matrix from $|C_k\\rangle$, i.e., $\\rho_k = \\mathrm{Tr}_{\\{1,\\dots,k-1\\}}(|C_k\\rangle\\langle C_k|)$.\n\n    **Case 1: $k=1$**\n    $U_{<1}$ is an empty product, so it is the identity operator.\n    $|\\phi_1\\rangle = |\\psi_0\\rangle = |+\\rangle^{\\otimes N}$.\n    The relevant two-qubit state is $|++\\rangle_{1,2}$.\n    $E = \\langle ++ |_{1,2} CZ_{1,2} | ++ \\rangle_{1,2}$. The Pauli decomposition of the CZ gate is $CZ = \\frac{1}{2}(I\\otimes I + Z\\otimes I + I\\otimes Z - Z\\otimes Z)$.\n    The expectation value is:\n    $$\n    E = \\langle ++ | \\frac{1}{2}(I\\otimes I + Z\\otimes I + I\\otimes Z - Z\\otimes Z) | ++ \\rangle\n    $$\n    Since $\\langle+|I|+\\rangle = 1$ and $\\langle+|Z|+\\rangle = 0$, we get:\n    $$\n    E = \\frac{1}{2}(\\langle+|I|+\\rangle\\langle+|I|+\\rangle + \\langle+|Z|+\\rangle\\langle+|I|+\\rangle + \\langle+|I|+\\rangle\\langle+|Z|+\\rangle - \\langle+|Z|+\\rangle\\langle+|Z|+\\rangle) = \\frac{1}{2}(1 + 0 + 0 - 0) = \\frac{1}{2}\n    $$\n\n    **Case 2: $k > 1$**\n    For a linear cluster state $|C_k\\rangle$ with $k>1$, the qubit $k$ is connected to qubit $k-1$. For any qubit in a connected graph state (with more than one qubit), its single-qubit reduced density matrix is the maximally mixed state.\n    Therefore, $\\rho_k = \\frac{1}{2}I_k$.\n    The two-qubit reduced density matrix is $\\rho_{k,k+1} = \\rho_k \\otimes \\rho_{k+1} = (\\frac{1}{2}I_k) \\otimes (|+\\rangle_{k+1}\\langle+|)$.\n    The expectation value is:\n    $$\n    E = \\mathrm{Tr}_{k,k+1} \\left[ \\left(\\frac{1}{2}I_k \\otimes |+\\rangle_{k+1}\\langle+|\\right) \\cdot CZ_{k,k+1} \\right]\n    $$\n    Using the form $CZ_{k,k+1} = |0\\rangle_k\\langle 0| \\otimes I_{k+1} + |1\\rangle_k\\langle 1| \\otimes Z_{k+1}$:\n    $$\n    E = \\frac{1}{2} \\mathrm{Tr}_{k,k+1} \\left[ (I_k \\otimes |+\\rangle\\langle+|) \\cdot (|0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes Z) \\right]\n    $$\n    $$\n    E = \\frac{1}{2} \\mathrm{Tr}_{k,k+1} \\left[ |0\\rangle_k\\langle 0| \\otimes |+\\rangle_{k+1}\\langle+| + |1\\rangle_k\\langle 1| \\otimes |+\\rangle_{k+1}\\langle+|Z_{k+1} \\right]\n    $$\n    Now, take the trace over each qubit subspace:\n    $$\n    E = \\frac{1}{2} \\left[ \\mathrm{Tr}_k(|0\\rangle\\langle 0|) \\mathrm{Tr}_{k+1}(|+\\rangle\\langle+|) + \\mathrm{Tr}_k(|1\\rangle\\langle 1|) \\mathrm{Tr}_{k+1}(|+\\rangle\\langle+|Z_{k+1}) \\right]\n    $$\n    We know $\\mathrm{Tr}(|i\\rangle\\langle i|) = 1$ and $\\mathrm{Tr}(|+\\rangle\\langle+|) = 1$. The term $\\mathrm{Tr}_{k+1}(|+\\rangle\\langle+|Z_{k+1}) = \\langle +|Z|+\\rangle = 0$.\n    $$\n    E = \\frac{1}{2} [ (1)(1) + (1)(0) ] = \\frac{1}{2}\n    $$\n\n5.  **Final Fidelity Calculation:**\n    In both cases ($k=1$ and $k>1$), the inner product $\\langle \\psi_{ideal} | \\psi_{faulty} \\rangle$ is equal to $E = 1/2$.\n    The fidelity is therefore:\n    $$\n    F = |E|^2 = \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}\n    $$\n    The fidelity is independent of both the number of qubits $N$ and the position $k$ of the failed gate.", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "652622"}, {"introduction": "Once a resource state is prepared, we can use it to perform computations. This practice [@problem_id:652635] explores the simplest computational element—a \"quantum wire\"—which teleports a quantum state from one end of a linear cluster to the other. To make this more realistic, we analyze how a common type of noise, the depolarizing channel, affects the fidelity of the teleportation, connecting the abstract protocol to practical performance metrics.", "problem": "In one-way quantum computing, a quantum state can be teleported along a \"quantum wire\" composed of a linear cluster state. Consider a 3-qubit linear wire utilizing qubits labeled 1, 2, and 3.\n\nThe process unfolds as follows:\n1.  A 3-qubit linear cluster state $|\\psi_{cl}\\rangle_{123}$ is prepared. This state is generated by initializing the three qubits in the state $|+\\rangle^{\\otimes 3}$ (where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$) and then applying a Controlled-Z ($CZ$) gate to the pairs (1,2) and (2,3).\n2.  An arbitrary single-qubit state $|\\phi_{in}\\rangle = \\alpha|0\\rangle + \\beta|1\\rangle$ is encoded as the initial state of qubit 1. The full initial state of the system is thus $|\\Psi_0\\rangle = CZ_{23} CZ_{12} (|\\phi_{in}\\rangle_1 \\otimes |+\\rangle_2 \\otimes |+\\rangle_3)$.\n3.  Qubit 1 is measured in the X-basis, $\\{|+\\rangle, |-\\rangle\\}$, yielding classical outcome $s_1 \\in \\{0, 1\\}$.\n4.  After the measurement of qubit 1, the central qubit (qubit 2) is subjected to a depolarizing channel, $\\mathcal{E}_p$. The channel is defined by its action on a single-qubit density matrix $\\rho$: $\\mathcal{E}_p(\\rho) = (1-p)\\rho + p \\frac{I}{2}$, where $p$ is the error probability and $I$ is the $2 \\times 2$ identity matrix.\n5.  Qubit 2 is then measured in the X-basis, yielding classical outcome $s_2 \\in \\{0, 1\\}$.\n6.  Based on the outcomes $s_1$ and $s_2$, a final correction operator $U_{corr} = Z_3^{s_1} X_3^{s_2}$ is applied to qubit 3 to recover the teleported state.\n\nYour task is to derive the average fidelity $F$ of this teleportation process. The average fidelity is defined as $F = \\int d\\psi \\langle\\psi|\\rho_{out}(\\psi)|\\psi\\rangle$, where the integral is over all possible input states $|\\psi\\rangle$ on the Bloch sphere and $\\rho_{out}(\\psi)$ is the final density matrix of qubit 3 when the input is $|\\psi\\rangle$. For this channel, the fidelity is independent of the input state, so you may calculate it for an arbitrary $|\\phi_{in}\\rangle$.\n\nDerive the expression for the average fidelity $F$ as a function of the error probability $p$.", "solution": "1. Cluster-state teleportation yields an identity channel. After measuring qubit 1 in the $X$-basis with outcome $s_1$, and qubit 2 in the $X$-basis with outcome $s_2$, followed by the correction $Z_3^{s_1}X_3^{s_2}$, the overall transformation from qubit 1 to qubit 3 is perfect: \n$$\\rho_{in}\\;\\mapsto\\;\\rho_{3}=\\rho_{in}\\,. $$\n\n2. Inclusion of the depolarizing channel $\\mathcal E_p$ on qubit 2 inserts, in the middle of the perfect teleportation, the map \n$$\\mathcal E_p(\\rho)=(1-p)\\,\\rho+p\\,\\frac{I}{2}\\,. $$ \nSince the two halves of teleportation are ideal, the net channel from qubit 1 to qubit 3 is exactly $\\mathcal E_p$.\n\n3. The fidelity for a pure input $|\\psi\\rangle\\langle\\psi|=\\rho$ under $\\mathcal E_p$ is\n$$\nF(\\psi)=\\langle\\psi|\\mathcal E_p(\\rho)|\\psi\\rangle\n=(1-p)\\langle\\psi|\\rho|\\psi\\rangle+p\\,\\frac{\\langle\\psi|I|\\psi\\rangle}{2}\n=(1-p)+\\frac{p}{2}\n=1-\\frac{p}{2}\\,. \n$$\nThis is independent of $|\\psi\\rangle$, hence the average fidelity is\n$$\nF=1-\\frac{p}{2}\\,. \n$$", "answer": "$$\\boxed{1-\\frac{p}{2}}$$", "id": "652635"}, {"introduction": "Moving beyond simple wires, the true power of one-way computing lies in implementing universal gate sets. This advanced exercise [@problem_id:652736] examines the implementation of a CNOT gate and investigates how a physical error on a single qubit propagates through the computation. You will derive the resulting logical error channel on the output qubits, a key skill for understanding fault-tolerance in the measurement-based model.", "problem": "In the one-way quantum computing model, a computation is performed by applying a sequence of single-qubit measurements to a highly entangled resource state known as a cluster state. The choice of measurement bases determines the implemented quantum algorithm, and classical feed-forward of measurement outcomes is used for error correction and to ensure determinism.\n\nConsider a CNOT gate implemented on a 5-qubit 'cross' cluster state. The qubits are labeled 1 to 5, with qubit 3 at the center, connected to all other qubits (1, 2, 4, 5). The graph edges are $E = \\{(1,3), (2,3), (4,3), (5,3)\\}$. The cluster state is defined as $|G\\rangle = \\prod_{(i,j) \\in E} CZ_{ij} |+\\rangle^{\\otimes 5}$, where $CZ_{ij}$ is the controlled-Z gate between qubits $i$ and $j$, and $|+\\rangle = (|0\\rangle + |1\\rangle)/\\sqrt{2}$.\n\nThe CNOT gate operates on logical inputs encoded on qubits 1 (control) and 4 (target) and produces logical outputs on qubits 2 (control) and 5 (target). The gate implementation is as follows:\n1.  Qubit 1 is measured in the X-basis, yielding outcome $m_1 \\in \\{0,1\\}$.\n2.  Qubit 4 is measured in the X-basis, yielding outcome $m_4 \\in \\{0,1\\}$.\n3.  Qubit 3 is measured in the Y-basis, yielding outcome $m_3 \\in \\{0,1\\}$. (The Y-basis eigenstates are $|\\pm i\\rangle = (|0\\rangle \\pm i|1\\rangle)/\\sqrt{2}$.)\n4.  A final Pauli correction $K = K_C \\otimes K_T = (Z_2^{m_1} X_2^{m_3}) \\otimes (Z_5^{m_4} Z_5^{m_3})$ is applied to the output qubits 2 and 5.\n\nSuppose the central qubit (qubit 3) is subject to a depolarizing channel with probability $p$ before its measurement. The channel is described by the map $\\mathcal{E}(\\rho_3) = (1-p)\\rho_3 + \\frac{p}{3}(X_3\\rho_3 X_3 + Y_3\\rho_3 Y_3 + Z_3\\rho_3 Z_3)$. This physical error propagates and manifests as a logical error channel on the two-qubit output state. The logical error channel can be expressed as a mixture of Pauli errors:\n$$\n\\mathcal{E}_{\\text{logic}}(\\rho_{\\text{out}}) = \\sum_{i,j \\in \\{I,X,Y,Z\\}} c_{ij} (\\sigma_i \\otimes \\sigma_j) \\rho_{\\text{out}} (\\sigma_i \\otimes \\sigma_j)\n$$\nwhere $\\rho_{\\text{out}}$ is the ideal output state, and $\\sigma_i, \\sigma_j$ are the Pauli operators on the control (qubit 2) and target (qubit 5) outputs, respectively. The coefficients $c_{ij}$ form a $4 \\times 4$ matrix $C$.\n\nYou may use the following established rules for error propagation in cluster state computation for a qubit $c$ measured in the Y-basis, whose future neighbors (qubits yet to be measured) are the set $N(c)$:\n-   An error $E_c \\in \\{X_c, Z_c\\}$ (which anti-commutes with $Y_c$) flips the measurement outcome $m_c$. The error operator then propagates to the remaining qubits as $E_L^{(\\text{prop})}(X_c) = \\prod_{v \\in N(c)} Z_v$ and $E_L^{(\\text{prop})}(Z_c) = \\prod_{v \\in N(c)} X_v$.\n-   An error $E_c = Y_c$ (which commutes with $Y_c$) does not flip the measurement outcome. The error operator propagates as $E_L^{(\\text{prop})}(Y_c) = \\prod_{v \\in N(c)} Y_v$.\n\nYour task is to derive the $4 \\times 4$ logical Pauli error matrix $C = (c_{ij})$, where the rows are indexed by the control Pauli operator $\\{I,X,Y,Z\\}$ and columns by the target Pauli operator $\\{I,X,Y,Z\\}$.", "solution": "The depolarizing channel on qubit 3 introduces a Pauli error $E_3 \\in \\{X_3, Y_3, Z_3\\}$ with probability $p/3$ each. We trace the propagation of each error to a logical error on the output qubits 2 (control) and 5 (target). The future neighbors of qubit 3 are $N(3)=\\{2,5\\}$.\n\nThe propagation rules for a Y-basis measurement are:\n- $X_3 \\rightarrow E_L^{(\\text{prop})} = Z_2 \\otimes Z_5$. This error flips the measurement outcome $m_3$.\n- $Z_3 \\rightarrow E_L^{(\\text{prop})} = X_2 \\otimes X_5$. This error also flips the measurement outcome $m_3$.\n- $Y_3 \\rightarrow E_L^{(\\text{prop})} = Y_2 \\otimes Y_5$. This error does not affect the measurement outcome $m_3$.\n\nThe final correction includes the operator $X_2^{m_3} \\otimes Z_5^{m_3}$. If an error flips the outcome $m_3 \\to m_3 \\oplus 1$, an extra correction $E_{corr} = X_2 \\otimes Z_5$ is applied. The net logical error is the product of the propagated error and this extra correction.\n\nLet's evaluate the logical error for each case (up to a global phase):\n- **No Error ($I_3$, prob. $1-p$):** No propagated error, no outcome flip. Logical error is $I \\otimes I$.\n- **$X_3$ Error (prob. $p/3$):** Propagated error is $Z_2 \\otimes Z_5$. Outcome $m_3$ flips, so an extra correction $X_2 \\otimes Z_5$ is applied. Net logical error: $(X_2 \\otimes Z_5)(Z_2 \\otimes Z_5) = (X_2 Z_2) \\otimes (Z_5 Z_5) \\sim Y_2 \\otimes I$.\n- **$Z_3$ Error (prob. $p/3$):** Propagated error is $X_2 \\otimes X_5$. Outcome $m_3$ flips, so an extra correction $X_2 \\otimes Z_5$ is applied. Net logical error: $(X_2 \\otimes Z_5)(X_2 \\otimes X_5) = (X_2 X_2) \\otimes (Z_5 X_5) \\sim I \\otimes Y_5$.\n- **$Y_3$ Error (prob. $p/3$):** Propagated error is $Y_2 \\otimes Y_5$. Outcome $m_3$ is not flipped. Net logical error: $Y_2 \\otimes Y_5$.\n\nThe resulting logical channel is a mixture of these Pauli errors:\n$$ \\mathcal{E}_{\\text{logic}}(\\rho) = (1-p) (I \\otimes I) \\rho (I \\otimes I) + \\frac{p}{3} (Y \\otimes I) \\rho (Y \\otimes I) + \\frac{p}{3} (I \\otimes Y) \\rho (I \\otimes Y) + \\frac{p}{3} (Y \\otimes Y) \\rho (Y \\otimes Y) $$\nFrom this, we can read off the non-zero coefficients $c_{ij}$ of the Pauli error matrix $C$:\n$$ c_{II} = 1-p, \\quad c_{YI} = \\frac{p}{3}, \\quad c_{IY} = \\frac{p}{3}, \\quad c_{YY} = \\frac{p}{3} $$\nAll other coefficients are zero.", "answer": "$$\\boxed{\\begin{pmatrix}\n1-p & 0 & \\frac p3 & 0\\\\\n0 & 0 & 0 & 0\\\\\n\\frac p3 & 0 & \\frac p3 & 0\\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}}$$", "id": "652736"}]}