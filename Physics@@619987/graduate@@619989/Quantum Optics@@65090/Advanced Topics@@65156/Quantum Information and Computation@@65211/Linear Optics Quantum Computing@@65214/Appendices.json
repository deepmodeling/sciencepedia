{"hands_on_practices": [{"introduction": "This exercise explores the foundational principle of two-photon quantum interference within a Mach-Zehnder interferometer (MZI). By calculating how a controllable phase shift $\\phi$ governs the output distribution of two indistinguishable photons, you will directly engage with the mechanism that underpins operations in linear optical systems. This calculation demonstrates how interference can be harnessed to direct quantum information. [@problem_id:687032]", "problem": "In the field of linear optics quantum computing, heralded single photons are crucial resources. They are often generated using spontaneous parametric down-conversion (SPDC), where a pump laser incident on a nonlinear crystal probabilistically creates a pair of photons, commonly called signal (s) and idler (i). For a given pump pulse, the state produced by an SPDC source can be approximated by $|\\Psi\\rangle_{si} = \\sqrt{1-|\\lambda|^2}|0,0\\rangle_{si} + \\lambda|1,1\\rangle_{si}$, where $|n,m\\rangle_{si}$ denotes $n$ photons in the signal mode and $m$ photons in the idler mode, and $|\\lambda|^2 \\ll 1$ is the probability of creating a pair. Detecting a photon in the idler mode heralds the presence of a single photon in the signal mode.\n\nConsider an experiment where two independent, identical SPDC sources are used. The state produced by the two sources is $|\\Psi\\rangle_{total} = |\\Psi\\rangle_{s_1i_1} \\otimes |\\Psi\\rangle_{s_2i_2}$. The two signal modes, $s_1$ and $s_2$, are directed into the two input ports of a Mach-Zehnder interferometer (MZI). The two idler modes, $i_1$ and $i_2$, are sent to a detector setup. A successful heralding event is defined by the simultaneous detection of one photon in mode $i_1$ and one photon in mode $i_2$.\n\nThe Mach-Zehnder interferometer consists of two 50:50 beam splitters. The two input modes ($s_1, s_2$) are mixed on the first beam splitter, travel along two internal paths (path 1 and path 2), and are recombined on the second beam splitter to produce two output modes ($d_1, d_2$). A phase shift of $\\phi$ is applied to the light traveling along path 1 inside the MZI.\n\nThe action of a 50:50 beam splitter on the creation operators of its input modes ($a_{in,1}^\\dagger, a_{in,2}^\\dagger$) to produce output modes ($a_{out,1}^\\dagger, a_{out,2}^\\dagger$) is given by the transformation:\n$$\n\\begin{pmatrix} a_{out,1}^\\dagger \\\\ a_{out,2}^\\dagger \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} a_{in,1}^\\dagger \\\\ a_{in,2}^\\dagger \\end{pmatrix}\n$$\nAssume the MZI is constructed such that the input modes $(s_1, s_2)$ are transformed to the internal modes $(p_1, p_2)$ by the first beam splitter, and the internal modes (after one acquires a phase $e^{i\\phi}$) are transformed to the output modes $(d_1, d_2)$ by the second beam splitter.\n\nDerive the probability of detecting exactly one photon in output mode $d_1$ and one photon in output mode $d_2$, conditioned on a successful heralding event. Express your answer as a function of the phase $\\phi$.", "solution": "We condition on the heralding event which projects the idler modes onto $|1,1\\rangle_{i_1i_2}$, leaving the signal modes in the normalized two-photon state \n\n$$\n|\\psi_{\\text{in}}\\rangle_{s_1s_2}\n= a_{1}^\\dagger a_{2}^\\dagger|0\\rangle.\n$$\n\nA 50:50 beam splitter transforms the creation operators by\n\n$$\n\\begin{pmatrix}p_1^\\dagger\\\\p_2^\\dagger\\end{pmatrix}\n=\\frac1{\\sqrt2}\n\\begin{pmatrix}11\\\\1-1\\end{pmatrix}\n\\begin{pmatrix}a_1^\\dagger\\\\a_2^\\dagger\\end{pmatrix},\n$$\n\nso\n\n$$\np_1^\\dagger=\\frac{a_1^\\dagger+a_2^\\dagger}{\\sqrt2},\\quad\np_2^\\dagger=\\frac{a_1^\\dagger-a_2^\\dagger}{\\sqrt2}.\n$$\n\nA phase $e^{i\\phi}$ is applied to mode $p_1$, and then a second 50:50 BS gives output modes\n\n$$\n\\begin{pmatrix}d_1^\\dagger\\\\d_2^\\dagger\\end{pmatrix}\n=\\frac1{\\sqrt2}\n\\begin{pmatrix}11\\\\1-1\\end{pmatrix}\n\\begin{pmatrix}e^{i\\phi}p_1^\\dagger\\\\p_2^\\dagger\\end{pmatrix}.\n$$\n\nCombining these transformations yields\n\n$$\nd_1^\\dagger\n=\\frac{(e^{i\\phi}+1)a_1^\\dagger+(e^{i\\phi}-1)a_2^\\dagger}{2},\\quad\nd_2^\\dagger\n=\\frac{(e^{i\\phi}-1)a_1^\\dagger+(e^{i\\phi}+1)a_2^\\dagger}{2}.\n$$\n\nInverting to express $a_j^\\dagger$ in terms of $d_k^\\dagger$ gives\n\n$$\na_1^\\dagger\n=\\frac{(e^{i\\phi}+1)d_1^\\dagger-(e^{i\\phi}-1)d_2^\\dagger}{2e^{i\\phi}},\\quad\na_2^\\dagger\n=\\frac{-(e^{i\\phi}-1)d_1^\\dagger+(e^{i\\phi}+1)d_2^\\dagger}{2e^{i\\phi}}.\n$$\n\nHence, expressing the input state in terms of the output modes:\n\n$$\na_1^\\dagger a_2^\\dagger|0\\rangle\n=\\frac{-AB\\,|2,0\\rangle+(A^2+B^2)\\,|1,1\\rangle -AB\\,|0,2\\rangle}{4e^{2i\\phi}},\n$$\n\nwhere $A=e^{i\\phi}+1,\\;B=e^{i\\phi}-1$.  The probability of one photon in each output is\n\n$$\nP_{1,1}\n=\\Bigl|\\frac{A^2+B^2}{4e^{2i\\phi}}\\Bigr|^2\n=\\frac{|2(e^{2i\\phi}+1)|^2}{16}\n=\\cos^2\\phi.\n$$", "answer": "$$\\boxed{\\cos^2(\\phi)}$$", "id": "687032"}, {"introduction": "Building on the interferometer model, we now treat it as a computational elementâ€”specifically, a Hadamard gate. This practice introduces the critical real-world concept of operational fidelity by modeling the impact of environmental noise as random phase fluctuations. Your task will be to derive the process fidelity of this noisy gate, providing a quantitative measure of its performance and a deeper understanding of the challenges in building robust quantum hardware. [@problem_id:686999]", "problem": "In linear optics quantum computing, a qubit is often encoded in the \"dual-rail\" representation, where the state of the qubit is determined by the path of a single photon. The logical states $|0\\rangle_L$ and $|1\\rangle_L$ correspond to a photon in spatial mode 1 or 2, respectively. A crucial single-qubit gate is the Hadamard gate, whose ideal unitary operation is given by the matrix:\n$$\nH = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}\n$$\nA Mach-Zehnder interferometer (MZI) can be used to implement this gate. An MZI consists of two 50:50 beam splitters separating and then recombining two spatial modes. The unitary matrix for a single symmetric 50:50 beam splitter is given by:\n$$\nB = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  i \\\\ i  1 \\end{pmatrix}\n$$\nAn MZI with a phase shift $\\phi$ applied to the first path between the two beam splitters implements the total unitary operation $U_{MZI}(\\phi) = B \\cdot P(\\phi) \\cdot B$, where $P(\\phi) = \\begin{pmatrix} e^{i\\phi}  0 \\\\ 0  1 \\end{pmatrix}$.\n\nThe Hadamard gate $H$ can be realized (up to an irrelevant global phase) by setting the internal phase shift to an ideal value of $\\phi_0 = \\pi/2$. In a realistic device, this phase is subject to random fluctuations. Assume the actual phase in the interferometer arm is $\\phi = \\phi_0 + \\delta\\phi$, where the phase error $\\delta\\phi$ is a random variable described by a Gaussian probability distribution with zero mean and variance $\\sigma^2$:\n$$\np(\\delta\\phi) = \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-\\frac{\\delta\\phi^2}{2\\sigma^2}}\n$$\nThis noise turns the ideal unitary operation into a quantum channel. The process fidelity $F_p$ is a measure of how close this noisy channel is to the ideal gate. For this type of error, the process fidelity is given by the average of the fidelity over all possible phase errors, weighted by their probability:\n$$\nF_p = \\int_{-\\infty}^{\\infty} p(\\delta\\phi) \\left| \\frac{1}{d} \\text{Tr}\\left(U_{ideal}^\\dagger U_{actual}(\\delta\\phi)\\right) \\right|^2 d(\\delta\\phi)\n$$\nwhere $d$ is the dimension of the system ($d=2$ for a qubit), $U_{ideal} = H$, and $U_{actual}(\\delta\\phi)$ is the unitary operation of the MZI with the noisy phase $\\phi = \\pi/2 + \\delta\\phi$.\n\nDerive the process fidelity $F_p$ for this noisy Hadamard gate as a function of the noise variance $\\sigma^2$.", "solution": "1. The MZI unitary is \n$$B=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1i\\\\i1\\end{pmatrix},\\quad\nP(\\phi)=\\begin{pmatrix}e^{i\\phi}0\\\\01\\end{pmatrix},$$\nso \n$$U_{actual}(\\phi)=B\\,P(\\phi)\\,B\n=\\frac{1}{2}\\begin{pmatrix}e^{i\\phi}-1i(e^{i\\phi}+1)\\\\i(e^{i\\phi}+1)1-e^{i\\phi}\\end{pmatrix}.$$\nFor $\\phi=\\pi/2+\\delta\\phi$ one has $e^{i\\phi}=i\\,e^{i\\delta\\phi}$.\n2. The ideal Hadamard is \n$$H=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}11\\\\1-1\\end{pmatrix},$$ \nand with $d=2$  \n$$\\frac{1}{d}\\Tr\\bigl(H^\\dagger U_{actual}\\bigr)\n=\\frac{1}{2\\sqrt{2}}\\,(i-1)\\,(e^{i\\delta\\phi}+1).$$\n3. Its squared modulus is \n$$\\Bigl\\lvert\\frac{1}{d}\\Tr(\\cdots)\\Bigr\\rvert^2\n=\\frac{1}{8}\\lvert i-1\\rvert^2\\lvert e^{i\\delta\\phi}+1\\rvert^2\n=\\frac12\\bigl(1+\\cos\\delta\\phi\\bigr).$$\n4. Averaging over the Gaussian $p(\\delta\\phi)=\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{-\\delta\\phi^2/(2\\sigma^2)}$ gives\n$$F_p=\\int p(\\delta\\phi)\\,\\frac12(1+\\cos\\delta\\phi)\\,d\\delta\\phi\n=\\frac12\\bigl(1+e^{-\\sigma^2/2}\\bigr).$$", "answer": "$$\\boxed{\\frac12\\bigl(1+e^{-\\sigma^2/2}\\bigr)}$$", "id": "686999"}, {"introduction": "This final practice shifts our perspective from a single component's physics to the architectural level of circuit synthesis. In linear optics, complex multi-qubit gates like the Toffoli gate are not fundamental; they must be constructed from simpler, probabilistic two-qubit gates. By following a standard decomposition recipe, you will determine the total 'cost' of a Toffoli gate, a key metric for evaluating the resource overhead and scalability of linear optical quantum computers. [@problem_id:686849]", "problem": "In the field of linear optics quantum computing (LOQC), the implementation of quantum gates is subject to physical constraints. While single-qubit gates can be implemented deterministically with near-perfect fidelity (e.g., using wave plates and phase shifters), two-qubit entangling gates are fundamentally probabilistic, relying on quantum interference and post-selection based on measurement outcomes.\n\nTo quantify the resources required for a quantum algorithm in this architecture, a cost model is often used where the fundamental unit of cost is the implementation of one successful post-selected controlled-Z (CZ) gate. Deterministic single-qubit gates are considered to have zero cost.\n\nYou are given the following information for constructing a three-qubit Toffoli (CCNOT) gate:\n\n1.  **Fundamental Costs:**\n    *   The cost of any single-qubit gate is 0.\n    *   The cost of one CZ gate is 1 (by definition).\n    *   The cost of a CNOT gate is 1 CZ gate, as it can be constructed via the identity $CNOT = (I \\otimes H) \\cdot CZ \\cdot (I \\otimes H)$, where $H$ is the Hadamard gate.\n\n2.  **Gate Decomposition Recipe:**\n    A generic two-qubit controlled-U ($C_U$) gate can be decomposed into a circuit of two CNOT gates and three single-qubit gates ($A, B, C$) acting on the target qubit. The circuit is $(I \\otimes A) \\cdot CNOT \\cdot (I \\otimes B) \\cdot CNOT \\cdot (I \\otimes C)$. This decomposition is valid if the unitary $U$ can be expressed as $U = e^{i\\alpha} A X B X C$ for some global phase $\\alpha$ and single-qubit unitary operators $A, B, C$ that satisfy the condition $ABC = I$. The cost of any such $C_U$ gate is therefore equivalent to the cost of two CNOT gates.\n\n3.  **Toffoli Gate Synthesis:**\n    A Toffoli gate can be synthesized from a circuit composed of two CNOT gates, one controlled-V ($CV$) gate, and one controlled-$V^\\dagger$ ($CV^\\dagger$) gate. The gate $V$ is a unitary square-root of the Pauli-X gate ($V^2 = X$), given by the matrix:\n    $$\n    V = \\frac{1}{2}\\begin{pmatrix} 1+i  1-i \\\\ 1-i  1+i \\end{pmatrix}\n    $$\n\n**Derivation Task:**\nBased on the provided information, derive the total cost, in terms of the number of fundamental CZ gates, required to build one Toffoli gate. Your derivation must explicitly show that the $V$ gate can be decomposed in the manner required by the recipe in (2). You may assume that the cost of $CV^\\dagger$ is the same as the cost of $CV$.", "solution": "1. Relevant cost definitions:\n$$\\text{cost}(\\text{single-qubit gate})=0,\\quad \\text{cost}(CZ)=1.$$\nSince \n$$CNOT=(I\\otimes H)\\,CZ\\,(I\\otimes H),$$\nwe have\n$$\\text{cost}(CNOT)=1.$$\n\n2. Controlled-U decomposition [recipe (2)]:\nA general controlled-U uses two CNOTs and single-qubit gates, so\n$$\\text{cost}(C_U)=2\\;\\text{cost}(CNOT)=2.$$\n\n3. Verification for $V$:\nGiven \n$$V^2=X,$$\nand noting any $2\\times2$ unitary $U$ admits\n$$U=e^{i\\alpha}A\\,X\\,B\\,X\\,C,\\quad ABC=I,$$\nwe conclude \n$$\\text{cost}(CV)=2.$$\nSimilarly $\\text{cost}(CV^\\dagger)=2$.\n\n4. Toffoli synthesis:\nUsing two CNOTs, one $CV$, one $CV^\\dagger$,\n$$\\text{cost}(\\mathrm{Toffoli})\n=2\\,\\text{cost}(CNOT)+\\text{cost}(CV)+\\text{cost}(CV^\\dagger)\n=2\\cdot1+2+2=6.$$", "answer": "$$\\boxed{6}$$", "id": "686849"}]}