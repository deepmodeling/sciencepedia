{"hands_on_practices": [{"introduction": "The journey of a qubit through a communication channel, like an optical fiber, is fraught with peril. Environmental interactions can introduce errors that corrupt the quantum state. This first practice investigates how a simple but fundamental noise model—the bit-flip channel—affects the entanglement swapping protocol. By calculating the fidelity of the final entangled pair, you will directly quantify how noise in an intermediate link degrades the quality of the end-to-end entanglement, a core problem that quantum repeaters are designed to solve [@problem_id:669300].", "problem": "### Problem: Fidelity of Entanglement Swapping with a Bit-Flip Channel\n\nAn entanglement swapping protocol is designed to entangle two qubits that have never directly interacted. Consider two sources, A and B. Source A produces a pair of qubits (1, 2) in the Bell state $|\\Phi^+\\rangle_{12}$, and Source B produces a pair of qubits (3, 4) in the Bell state $|\\Phi^+\\rangle_{34}$. The state $|\\Phi^+\\rangle$ is defined as $\\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$.\n\nQubits 1 and 4 are delivered to two distant parties, Alice and Bob, respectively. Qubits 2 and 3 are sent to a central station, Charlie.\n\nThe standard, noiseless protocol is as follows:\n1.  The initial state of the four-qubit system is $|\\Psi\\rangle_{1234} = |\\Phi^+\\rangle_{12} \\otimes |\\Phi^+\\rangle_{34}$.\n2.  Charlie performs a Bell State Measurement (BSM) on the qubit pair (2, 3), projecting it onto one of the four Bell states:\n    -   $|\\Phi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle \\pm |11\\rangle)$\n    -   $|\\Psi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle \\pm |10\\rangle)$\n3.  Charlie communicates his measurement outcome to Alice via a classical channel.\n4.  Based on Charlie's message, Alice applies a local unitary correction to her qubit (qubit 1). The corrections are chosen to transform the resulting state of the pair (1, 4) into the target state $|\\Phi^+\\rangle_{14}$. The standard correction map is:\n    -   If outcome is $|\\Phi^+\\rangle_{23}$, Alice applies $I_1$ (identity).\n    -   If outcome is $|\\Phi^-\\rangle_{23}$, Alice applies $Z_1$ (Pauli-Z).\n    -   If outcome is $|\\Psi^+\\rangle_{23}$, Alice applies $X_1$ (Pauli-X).\n    -   If outcome is $|\\Psi^-\\rangle_{23}$, Alice applies $iY_1$ (where $Y_1 = -iXZ$).\n\nNow, consider a modification to this protocol. Before the BSM is performed by Charlie, qubit 3 passes through a single-qubit bit-flip channel. This channel is described by the quantum operation $\\mathcal{E}_3$, which acts on an arbitrary state $\\rho$ of qubit 3 as:\n$$\n\\mathcal{E}_3(\\rho) = (1-p)\\rho + p X_3 \\rho X_3\n$$\nwhere $X_3$ is the Pauli-X operator on qubit 3, and $p$ is the probability of a bit flip.\n\nDerive the fidelity, $F$, of the final state of the qubit pair (1, 4), $\\rho_{14}^{\\text{final}}$, with the ideal target Bell state $|\\Phi^+\\rangle_{14}$. The final state $\\rho_{14}^{\\text{final}}$ is the state after Charlie's BSM and Alice's corresponding correction have been performed. You will find that the fidelity is independent of Charlie's specific measurement outcome. Express your answer in terms of the bit-flip probability $p$.\n\nThe fidelity $F$ is defined as $F = \\langle\\Phi^+_{14}|\\rho_{14}^{\\text{final}}|\\Phi^+_{14}\\rangle$.", "solution": "1.  **Initial State and Channel:** The initial 4-qubit state is $|\\Psi\\rangle_{1234} = |\\Phi^+\\rangle_{12} \\otimes |\\Phi^+\\rangle_{34}$. Before the BSM, qubit 3 passes through a bit-flip channel $\\mathcal{E}_3$. The state of pair (3,4) becomes a mixed state $\\rho_{34}' = (1-p)|\\Phi^+\\rangle\\langle\\Phi^+|_{34} + p X_3|\\Phi^+\\rangle\\langle\\Phi^+|_{34}X_3$. Since $X_3|\\Phi^+\\rangle_{34} = |\\Psi^+\\rangle_{34}$, we have $\\rho_{34}' = (1-p)|\\Phi^+\\rangle\\langle\\Phi^+|_{34} + p |\\Psi^+\\rangle\\langle\\Psi^+|_{34}$. The total state before the BSM is $\\rho'_{1234} = |\\Phi^+\\rangle\\langle\\Phi^+|_{12} \\otimes \\rho_{34}'$.\n\n2.  **Entanglement Swapping Identity:** The core of entanglement swapping relies on the identity that for a starting state $|\\Phi^+\\rangle_{12} \\otimes |\\Phi^+\\rangle_{34}$, a BSM on qubits (2,3) projecting them onto a Bell state $|\\alpha\\rangle_{23}$ will project qubits (1,4) into the same Bell state $|\\alpha\\rangle_{14}$ (up to a global phase). The Pauli corrections are designed to transform any resulting state $|\\alpha\\rangle_{14}$ back to the target $|\\Phi^+\\rangle_{14}$.\n\n3.  **Analysis of State Components:** We can analyze the swapping process for the two components of the initial state separately.\n    -   **\"Good\" Component (Prob 1-p):** The state is $|\\Phi^+\\rangle_{12} \\otimes |\\Phi^+\\rangle_{34}$. After the BSM and Alice's subsequent correction, the final state of pair (1,4) is guaranteed to be the target state $|\\Phi^+\\rangle_{14}$.\n    -   **\"Error\" Component (Prob p):** The state is $|\\Phi^+\\rangle_{12} \\otimes |\\Psi^+\\rangle_{34}$. We need to determine the final state of (1,4) after a BSM on (2,3) and the *same* Pauli correction as in the good case (since Alice does not know an error occurred). A straightforward way to see the result is to use the identity: $|\\Phi^+\\rangle_{12} \\otimes |\\Psi^+\\rangle_{34} = \\frac{1}{2} \\sum_{\\alpha \\in \\{\\Phi^\\pm, \\Psi^\\pm\\}} \\sigma_\\alpha |\\alpha\\rangle_{14} \\otimes \\sigma'_\\alpha |\\alpha\\rangle_{23}$, where $\\sigma$ are Pauli operators. A simpler method is to analyze a single outcome.\n    \n    Let's assume Charlie's BSM outcome is $|\\Phi^+\\rangle_{23}$.\n    -   For the \"good\" component, the state of (1,4) becomes $|\\Phi^+\\rangle_{14}$. Alice applies correction $I_1$, so the final state is $|\\Phi^+\\rangle_{14}$.\n    -   For the \"error\" component, projecting $|\\Phi^+\\rangle_{12} \\otimes |\\Psi^+\\rangle_{34}$ onto $|\\Phi^+\\rangle_{23}$ leaves the pair (1,4) in state $|\\Psi^+\\rangle_{14}$. Alice, expecting the \"good\" case, applies correction $I_1$. The final state is $|\\Psi^+\\rangle_{14}$.\n\n    This pattern holds for all four BSM outcomes. For any given outcome, the correction that transforms the \"good\" component to $|\\Phi^+\\rangle_{14}$ will transform the \"error\" component to an orthogonal state (e.g., $|\\Psi^+\\rangle_{14}$).\n\n4.  **Final State and Fidelity:** Averaging over all measurement outcomes, the final state of the pair (1,4) is a statistical mixture:\n    $$ \\rho_{14}^{\\text{final}} = (1-p) |\\Phi^+\\rangle\\langle\\Phi^+|_{14} + p |\\Psi^+\\rangle\\langle\\Psi^+|_{14} $$\n    The fidelity with respect to the target state $|\\Phi^+\\rangle_{14}$ is:\n    $$ F = \\langle\\Phi^+_{14}|\\rho_{14}^{\\text{final}}|\\Phi^+_{14}\\rangle = (1-p) \\langle\\Phi^+|\\Phi^+\\rangle\\langle\\Phi^+|\\Phi^+\\rangle + p \\langle\\Phi^+|\\Psi^+\\rangle\\langle\\Psi^+|\\Phi^+\\rangle $$\n    Since $\\langle\\Phi^+|\\Phi^+\\rangle = 1$ and the Bell states are orthogonal, $\\langle\\Phi^+|\\Psi^+\\rangle = 0$. Therefore, the fidelity is:\n    $$ F = (1-p) \\cdot 1 + p \\cdot 0 = 1-p $$", "answer": "$$\\boxed{1-p}$$", "id": "669300"}, {"introduction": "Perfect entanglement swapping requires not only pristine quantum states but also flawless classical communication and control. This exercise presents a scenario where errors compound: a corrective operation is sent to the wrong party, and the classical message dictating that correction is itself corrupted. Deriving the complete density matrix of the final state will provide a deeper understanding of how systemic errors, both quantum and classical, combine to impact the outcome [@problem_id:669349].", "problem": "An elementary quantum repeater segment operates via entanglement swapping. Two sources produce ideal, entangled Bell pairs. The first pair, shared between Alice (A) and Bob (B), is in the state $|\\Phi^+_{AB}\\rangle$. The second pair, shared between Charlie (C) and David (D), is in the state $|\\Phi^+_{CD}\\rangle$. Alice and David are at distant locations, while Bob and Charlie are co-located at a central node. The state $|\\Phi^+\\rangle$ is defined as $\\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$.\n\nTo entangle Alice's and David's qubits, a Bell State Measurement (BSM) is performed on qubits B and C. The BSM projects the two-qubit state onto one of the four Bell states, $|\\Phi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle \\pm |11\\rangle)$ and $|\\Psi^\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle \\pm |10\\rangle)$. The outcome of the BSM is encoded into two classical bits, $m_1 m_0$, which are communicated to one of the end stations to perform a corrective Pauli rotation, thereby establishing a $|\\Phi^+\\rangle$ state between A and D. The mapping between the BSM measurement outcome and the two classical bits is:\n- $|\\Phi^+\\rangle_{BC} \\leftrightarrow 00$\n- $|\\Psi^+\\rangle_{BC} \\leftrightarrow 01$\n- $|\\Phi^-\\rangle_{BC} \\leftrightarrow 10$\n- $|\\Psi^-\\rangle_{BC} \\leftrightarrow 11$\n\nThe corresponding corrective Pauli operation for an outcome $m_1 m_0$ is $U = X^{m_0} Z^{m_1}$, where $X$ and $Z$ are the standard Pauli matrices.\n\nConsider a scenario where two implementation errors occur simultaneously:\n1.  The corrective Pauli operation $U$ is mistakenly applied to Alice's qubit (A) instead of David's qubit (D).\n2.  The classical communication channel that transmits the bits $(m_1, m_0)$ from the BSM station to Alice is faulty. It is a bit-flip channel that flips the second bit, $m_0$, with a probability $p$, while the first bit, $m_1$, is always transmitted correctly.\n\nDerive the density matrix $\\rho_{AD}$ of the final two-qubit state shared by Alice and David. Express your answer as a matrix in the computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$.", "solution": "1.  **Initial State and Swapping Identity:** The initial state is $|\\Psi_{ABCD}\\rangle=|\\Phi^+_{AB}\\rangle\\otimes|\\Phi^+_{CD}\\rangle$. The key to analyzing entanglement swapping is the identity:\n    $$|\\Phi^+_{AB}\\rangle\\otimes|\\Phi^+_{CD}\\rangle = \\frac{1}{2} \\left( |\\Phi^+_{AD}\\rangle|\\Phi^+_{BC}\\rangle + |\\Phi^-_{AD}\\rangle|\\Phi^-_{BC}\\rangle + |\\Psi^+_{AD}\\rangle|\\Psi^+_{BC}\\rangle + |\\Psi^-_{AD}\\rangle|\\Psi^-_{BC}\\rangle \\right)$$\n    This identity shows that a Bell State Measurement (BSM) on qubits B and C projects the qubits A and D into the exact same Bell state. Each of the four outcomes for the BSM on BC occurs with equal probability $1/4$.\n\n2.  **Tracing Errors:** Two errors occur:\n    a) The classical bit $m_0$ is flipped with probability $p$. The received bits are $(m_1, m'_0)$ where $m'_0 = m_0 \\oplus f$, and $f=1$ with probability $p$.\n    b) The correction $U = X^{m'_0} Z^{m_1}$ is applied to qubit A instead of D.\n\n3.  **Case-by-Case Analysis:** We analyze the final state of pair AD for each of the four equally likely BSM outcomes.\n    -   **Outcome $|\\Phi^+\\rangle_{BC}$:** $(m_1,m_0)=(0,0)$. The state of AD is $|\\Phi^+_{AD}\\rangle$.\n        -   With prob $1-p$, $(m_1, m'_0)=(0,0)$, Alice applies $U=I$. Final state: $|\\Phi^+_{AD}\\rangle$.\n        -   With prob $p$, $(m_1, m'_0)=(0,1)$, Alice applies $U=X_A$. Final state: $(X_A \\otimes I_D)|\\Phi^+_{AD}\\rangle = |\\Psi^+_{AD}\\rangle$.\n    -   **Outcome $|\\Psi^+\\rangle_{BC}$:** $(m_1,m_0)=(0,1)$. The state of AD is $|\\Psi^+_{AD}\\rangle$.\n        -   With prob $1-p$, $(m_1, m'_0)=(0,1)$, Alice applies $U=X_A$. Final state: $(X_A \\otimes I_D)|\\Psi^+_{AD}\\rangle = |\\Phi^+_{AD}\\rangle$.\n        -   With prob $p$, $(m_1, m'_0)=(0,0)$, Alice applies $U=I$. Final state: $|\\Psi^+_{AD}\\rangle$.\n    -   **Outcome $|\\Phi^-\\rangle_{BC}$:** $(m_1,m_0)=(1,0)$. The state of AD is $|\\Phi^-_{AD}\\rangle$.\n        -   With prob $1-p$, $(m_1, m'_0)=(1,0)$, Alice applies $U=Z_A$. Final state: $(Z_A \\otimes I_D)|\\Phi^-_{AD}\\rangle = |\\Phi^+_{AD}\\rangle$.\n        -   With prob $p$, $(m_1, m'_0)=(1,1)$, Alice applies $U=X_A Z_A = iY_A$. Final state: $(iY_A \\otimes I_D)|\\Phi^-_{AD}\\rangle = -|\\Psi^+_{AD}\\rangle$.\n    -   **Outcome $|\\Psi^-\\rangle_{BC}$:** $(m_1,m_0)=(1,1)$. The state of AD is $|\\Psi^-_{AD}\\rangle$.\n        -   With prob $1-p$, $(m_1, m'_0)=(1,1)$, Alice applies $U=X_A Z_A=iY_A$. Final state: $(iY_A \\otimes I_D)|\\Psi^-_{AD}\\rangle = -|\\Phi^+_{AD}\\rangle$.\n        -   With prob $p$, $(m_1, m'_0)=(1,0)$, Alice applies $U=Z_A$. Final state: $(Z_A \\otimes I_D)|\\Psi^-_{AD}\\rangle = -|\\Psi^+_{AD}\\rangle$.\n\n4.  **Final State Aggregation:** In every one of the four BSM cases, the outcome is $|\\Phi^+_{AD}\\rangle$ (or an equivalent state up to a global phase) with probability $1-p$ and $|\\Psi^+_{AD}\\rangle$ (or an equivalent state up to a global phase) with probability $p$. Since each BSM case has a probability of $1/4$, we can average over all possibilities.\n    The total probability of ending up in the state $|\\Phi^+\\rangle$ is: $\\frac{1}{4}(1-p) + \\frac{1}{4}(1-p) + \\frac{1}{4}(1-p) + \\frac{1}{4}(1-p) = 1-p$.\n    The total probability of ending up in the state $|\\Psi^+\\rangle$ is: $\\frac{1}{4}p + \\frac{1}{4}p + \\frac{1}{4}p + \\frac{1}{4}p = p$.\n    Therefore, the final state is a statistical mixture (a mixed state):\n    $$\\rho_{AD} = (1-p)|\\Phi^+\\rangle\\langle\\Phi^+| + p|\\Psi^+\\rangle\\langle\\Psi^+|$$\n\n5.  **Density Matrix:** In the computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$, the projectors are:\n    $$|\\Phi^+\\rangle\\langle\\Phi^+| = \\frac{1}{2}\\begin{pmatrix}1001\\\\0000\\\\0000\\\\1001\\end{pmatrix}, \\quad |\\Psi^+\\rangle\\langle\\Psi^+| = \\frac{1}{2}\\begin{pmatrix}0000\\\\0110\\\\0110\\\\0000\\end{pmatrix}$$\n    Combining these gives the final density matrix:\n    $$\\rho_{AD} = \\frac{1-p}{2}\\begin{pmatrix}1001\\\\0000\\\\0000\\\\1001\\end{pmatrix} + \\frac{p}{2}\\begin{pmatrix}0000\\\\0110\\\\0110\\\\0000\\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix}1-p001-p\\\\00\\\\00\\\\1-p001-p\\end{pmatrix}$$", "answer": "$$\\boxed{\\frac{1}{2}\\begin{pmatrix}1-p001-p\\\\00\\\\00\\\\1-p001-p\\end{pmatrix}}$$", "id": "669349"}, {"introduction": "While high fidelity is essential, the speed at which a repeater can successfully establish entanglement is equally critical for practical quantum networks. This final practice shifts our focus from the quality of a single event to the overall throughput of a repeater node. By modeling the system's operation as a probabilistic process, you will calculate the mean time to success, a key performance metric that directly influences the data rate of a quantum communication link [@problem_id:669382].", "problem": "A fundamental component of a quantum repeater is a station that performs entanglement swapping. Consider a repeater node designed to link two adjacent segments, Link A and Link B. The operation of this repeater is discretized into time steps.\n\nThe repeater operates under the following protocol:\n\n1.  **Generation Mode**: In each time step, the repeater attempts to generate an entangled pair of qubits on both Link A and Link B simultaneously. The probability of success for Link A in any given step is $p_A$, and for Link B it is $p_B$. These events are independent. If entanglement is generated on only one link, that pair is discarded at the end of the time step. The repeater remains in Generation Mode as long as it has not successfully generated pairs on *both* links in the same step.\n\n2.  **Swapping Mode**: If the repeater succeeds in generating entanglement on both links in a single time step, it transitions to Swapping Mode for the *immediately following* time step. During this single time step, no new entanglement generation is attempted. Instead, a Bell state measurement (BSM) is performed to swap the entanglement. This BSM succeeds with probability $p_S$.\n\n3.  **Outcome**:\n    - If the BSM is successful, the entanglement is swapped, and the overall process is complete.\n    - If the BSM fails, the qubit pairs are consumed and lost. The repeater then returns to Generation Mode in the subsequent time step.\n\nDerive the expression for the mean number of time steps, $\\langle T \\rangle$, required to achieve one successful entanglement swap, starting from an initial state with no stored entanglement. Express your answer in terms of the probabilities $p_A$, $p_B$, and $p_S$.", "solution": "This problem can be solved by modeling the repeater's operation as a process with distinct states and calculating the expected time to reach the successful final state. We define two states for the repeater node:\n\n-   **State $S_0$**: The repeater is in Generation Mode. It is attempting to generate entangled pairs on both links.\n-   **State $S_1$**: The repeater is in Swapping Mode. It has successfully generated pairs on both links in the previous step and is now attempting the entanglement swap.\n\nLet $E_0$ be the expected number of future time steps required to achieve a successful swap, given the system is currently in state $S_0$. Let $E_1$ be the expected number of future time steps, given the system is currently in state $S_1$. Our goal is to find $\\langle T \\rangle = E_0$.\n\nWe can set up a system of linear equations for $E_0$ and $E_1$ using the law of total expectation.\n\n**Analysis of State $S_0$:**\nIf the system is in state $S_0$, it spends one time step in Generation Mode. The outcome determines the state in the next step.\n-   The probability of successfully generating pairs on both links is $p_{gen} = p_A p_B$, since the events are independent. If this happens, the system transitions to state $S_1$.\n-   The probability of failing to generate pairs on both links is $1 - p_A p_B$. In this case, the system returns to state $S_0$ for the next time step.\n\nThe expected time $E_0$ is the sum of the current step (which is always 1) and the expected future time, weighted by the probabilities of the outcomes:\n$$\nE_0 = 1 + (p_A p_B) \\cdot E_1 + (1 - p_A p_B) \\cdot E_0\n$$\nWe can rearrange this equation to solve for $E_0$ in terms of $E_1$:\n$$\nE_0 - (1 - p_A p_B) E_0 = 1 + p_A p_B E_1\n$$\n$$\nE_0 (1 - (1 - p_A p_B)) = 1 + p_A p_B E_1\n$$\n$$\np_A p_B E_0 = 1 + p_A p_B E_1\n$$\n(1)\n$$\nE_0 = \\frac{1}{p_A p_B} + E_1\n$$\n\n**Analysis of State $S_1$:**\nIf the system is in state $S_1$, it spends one time step in Swapping Mode.\n-   The entanglement swap succeeds with probability $p_S$. The process terminates, so the future time required is 0.\n-   The entanglement swap fails with probability $1 - p_S$. The pairs are lost, and the system returns to state $S_0$ to start the generation process again. The expected future time from this point is $E_0$.\n\nThe expected time $E_1$ is therefore:\n$$\nE_1 = 1 + p_S \\cdot 0 + (1 - p_S) \\cdot E_0\n$$\n(2)\n$$\nE_1 = 1 + (1 - p_S) E_0\n$$\n\n**Solving the System of Equations:**\nWe now have a system of two linear equations for $E_0$ and $E_1$. We can solve for $E_0$ by substituting equation (2) into equation (1):\n$$\nE_0 = \\frac{1}{p_A p_B} + \\left(1 + (1 - p_S) E_0\\right)\n$$\nNow, we group the terms with $E_0$:\n$$\nE_0 - (1 - p_S) E_0 = \\frac{1}{p_A p_B} + 1\n$$\n$$\nE_0 (1 - (1 - p_S)) = \\frac{1 + p_A p_B}{p_A p_B}\n$$\n$$\nE_0 \\cdot p_S = \\frac{1 + p_A p_B}{p_A p_B}\n$$\nFinally, we solve for $E_0$, which is the mean total time $\\langle T \\rangle$:\n$$\nE_0 = \\frac{1 + p_A p_B}{p_S p_A p_B}\n$$\nThis expression can also be written as $\\langle T \\rangle = \\frac{1}{p_S} \\left(1 + \\frac{1}{p_A p_B}\\right)$, which represents the mean number of swapping attempts ($1/p_S$) multiplied by the mean time per attempt (1 step for the swap plus $1/(p_A p_B)$ mean steps for the generation).", "answer": "$$\n\\boxed{\\frac{1 + p_A p_B}{p_S p_A p_B}}\n$$", "id": "669382"}]}