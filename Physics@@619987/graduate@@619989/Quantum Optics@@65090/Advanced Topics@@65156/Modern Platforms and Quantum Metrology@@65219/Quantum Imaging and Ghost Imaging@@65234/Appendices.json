{"hands_on_practices": [{"introduction": "Ghost imaging demonstrates the remarkable possibility of forming an image of an object without a spatially resolving detector in the object's path. This practice problem delves into the foundational physics of ghost imaging using a classical chaotic thermal light source. By deriving the profile of the reconstructed image, you will gain a hands-on understanding of how second-order field correlations and the source's coherence properties directly shape the final image, providing a crucial basis for all ghost imaging techniques [@problem_id:718454].", "problem": "Consider a lensless ghost imaging setup. A partially coherent light source, modeled as a chaotic thermal source, is located at the plane $z=0$. The mutual coherence function of the source field $E_s(\\mathbf{r})$ is given by a stationary Gaussian profile:\n$$ \\langle E_s^*(\\mathbf{r}_1) E_s(\\mathbf{r}_2) \\rangle = I_0 \\exp\\left(-\\frac{|\\mathbf{r}_1 - \\mathbf{r}_2|^2}{2\\sigma_c^2}\\right) $$\nwhere $\\mathbf{r}_1$ and $\\mathbf{r}_2$ are transverse position vectors at $z=0$, $I_0$ is the average intensity, and $\\sigma_c$ represents the transverse coherence length. A 50/50 beam splitter at $z=0$ divides the beam into two paths.\n\n1.  **Test Path:** The beam propagates a distance $d$ in free space to an object plane. The object is a thin Gaussian aperture with an intensity transmission function given by $T(\\mathbf{r}_o) = \\exp(-|\\mathbf{r}_o|^2/\\sigma_a^2)$, where $\\mathbf{r}_o$ is the transverse coordinate in the object plane and $\\sigma_a$ is the characteristic radius of the aperture. The total transmitted intensity is measured by a bucket detector (a detector that integrates over all transverse spatial coordinates).\n2.  **Reference Path:** The beam propagates a distance $d$ (the same as in the test path) in free space to a high-resolution detector, such as a CCD camera. This detector measures the intensity distribution $I_R(\\mathbf{r}_r)$, where $\\mathbf{r}_r$ is the transverse coordinate in the reference detector plane.\n\nThe ghost image is reconstructed by calculating the correlation of the intensity fluctuations between the two detectors. The image profile is given by $G(\\mathbf{r}_r) = \\langle \\Delta I_T \\Delta I_R(\\mathbf{r}_r) \\rangle$, where $I_T$ is the bucket detector signal, and $\\Delta I = I - \\langle I \\rangle$ represents the intensity fluctuation. For a thermal source, this correlation is proportional to the square modulus of the field cross-correlation, integrated over the object's aperture:\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\, T(\\mathbf{r}_o) \\, \\left| \\langle E_T^*(\\mathbf{r}_o) E_R(\\mathbf{r}_r) \\rangle \\right|^2 $$\nwhere $E_T(\\mathbf{r}_o)$ is the field at the object plane (before the object) and $E_R(\\mathbf{r}_r)$ is the field at the reference detector plane.\n\nThe resulting ghost image profile $G(\\mathbf{r}_r)$ is a Gaussian function of $\\mathbf{r}_r$: $G(\\mathbf{r}_r) \\propto \\exp(-|\\mathbf{r}_r|^2/\\sigma_g^2)$. Derive the squared width, $\\sigma_g^2$, of this reconstructed ghost image.\n\nUse the paraxial approximation for free-space propagation (the Fresnel diffraction integral). The field $E(\\mathbf{r}, z)$ at a distance $z$ from a source plane with field $E_s(\\mathbf{r}')$ is given by:\n$$ E(\\mathbf{r}, z) = \\frac{-ik}{2\\pi z} e^{ikz} \\int d^2\\mathbf{r}' E_s(\\mathbf{r}') \\exp\\left(\\frac{ik}{2z} |\\mathbf{r} - \\mathbf{r}'|^2\\right) $$\nwhere $k$ is the wave number.", "solution": "The profile of the ghost image is given by:\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\, T(\\mathbf{r}_o) \\, \\left| C(\\mathbf{r}_o, \\mathbf{r}_r) \\right|^2 $$\nwhere $T(\\mathbf{r}_o) = \\exp(-|\\mathbf{r}_o|^2/\\sigma_a^2)$ is the object's transmission and $C(\\mathbf{r}_o, \\mathbf{r}_r) = \\langle E_T^*(\\mathbf{r}_o) E_R(\\mathbf{r}_r) \\rangle$ is the cross-correlation between the field at the object plane and the field at the reference detector plane.\n\n1.  **Calculate the cross-correlation function $C(\\mathbf{r}_o, \\mathbf{r}_r)$.**\n    Using the Fresnel diffraction integral, the fields at distance $d$ are:\n    $$ E_T(\\mathbf{r}_o) = \\int d^2\\mathbf{r}_1 P(\\mathbf{r}_o, \\mathbf{r}_1; d) E_s(\\mathbf{r}_1) $$\n    $$ E_R(\\mathbf{r}_r) = \\int d^2\\mathbf{r}_2 P(\\mathbf{r}_r, \\mathbf{r}_2; d) E_s(\\mathbf{r}_2) $$\n    where $P(\\mathbf{r}, \\mathbf{r}'; d) = \\frac{-ik}{2\\pi d} e^{ikd} \\exp\\left(\\frac{ik}{2d}|\\mathbf{r}-\\mathbf{r}'|^2\\right)$ is the paraxial propagator. The cross-correlation is:\n    $$ C(\\mathbf{r}_o, \\mathbf{r}_r) = \\iint d^2\\mathbf{r}_1 d^2\\mathbf{r}_2 P^*(\\mathbf{r}_o, \\mathbf{r}_1; d) P(\\mathbf{r}_r, \\mathbf{r}_2; d) \\langle E_s^*(\\mathbf{r}_1) E_s(\\mathbf{r}_2) \\rangle $$\n    Substituting the source coherence function and the propagators:\n    $$ C(\\mathbf{r}_o, \\mathbf{r}_r) \\propto \\iint d^2\\mathbf{r}_1 d^2\\mathbf{r}_2 \\exp\\left(-\\frac{ik}{2d}|\\mathbf{r}_o - \\mathbf{r}_1|^2\\right) \\exp\\left(\\frac{ik}{2d}|\\mathbf{r}_r - \\mathbf{r}_2|^2\\right) \\exp\\left(-\\frac{|\\mathbf{r}_1 - \\mathbf{r}_2|^2}{2\\sigma_c^2}\\right) $$\n    Change integration variables to $\\mathbf{u} = \\mathbf{r}_1 - \\mathbf{r}_2$ and $\\mathbf{U} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$. The phase terms involving the integration variables are:\n    $$ \\Phi = -\\frac{ik}{2d}|\\mathbf{r}_o - \\mathbf{U} - \\mathbf{u}/2|^2 + \\frac{ik}{2d}|\\mathbf{r}_r - \\mathbf{U} + \\mathbf{u}/2|^2 - \\frac{|\\mathbf{u}|^2}{2\\sigma_c^2} $$\n    The terms linear in $\\mathbf{U}$ within the phase are $\\frac{ik}{d}(\\mathbf{r}_o - \\mathbf{r}_r - \\mathbf{u})\\cdot \\mathbf{U}$. Integrating over $\\mathbf{U}$ yields a delta function, $\\delta(\\mathbf{r}_o - \\mathbf{r}_r - \\mathbf{u})$, which forces $\\mathbf{u} = \\mathbf{r}_o - \\mathbf{r}_r$.\n    The remaining phase terms are found to cancel, leaving:\n    $$ C(\\mathbf{r}_o, \\mathbf{r}_r) \\propto \\exp\\left(-\\frac{|\\mathbf{r}_o - \\mathbf{r}_r|^2}{2\\sigma_c^2}\\right) $$\n    Therefore, the squared modulus is:\n    $$ |C(\\mathbf{r}_o, \\mathbf{r}_r)|^2 \\propto \\exp\\left(-\\frac{|\\mathbf{r}_o - \\mathbf{r}_r|^2}{\\sigma_c^2}\\right) $$\n\n2.  **Calculate the ghost image profile $G(\\mathbf{r}_r)$.**\n    We now compute the integral for the image profile:\n    $$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\exp\\left(-\\frac{|\\mathbf{r}_o|^2}{\\sigma_a^2}\\right) \\exp\\left(-\\frac{|\\mathbf{r}_o - \\mathbf{r}_r|^2}{\\sigma_c^2}\\right) $$\n    This integral is a convolution of two Gaussian functions. The convolution of a Gaussian with squared width $W_1^2$ and another Gaussian with squared width $W_2^2$ results in a new Gaussian with a squared width equal to the sum of the individual squared widths, $W_1^2 + W_2^2$.\n    Here, the object function has a squared width of $\\sigma_a^2$, and the correlation function has a squared width of $\\sigma_c^2$.\n    The resulting ghost image profile is therefore:\n    $$ G(\\mathbf{r}_r) \\propto \\exp\\left(-\\frac{|\\mathbf{r}_r|^2}{\\sigma_a^2 + \\sigma_c^2}\\right) $$\n\n3.  **Identify the squared width $\\sigma_g^2$.**\n    By comparing our result with the form $G(\\mathbf{r}_r) \\propto \\exp(-|\\mathbf{r}_r|^2/\\sigma_g^2)$, we find the squared width of the ghost image to be:\n    $$ \\sigma_g^2 = \\sigma_a^2 + \\sigma_c^2 $$", "answer": "$$ \\boxed{\\sigma_a^2 + \\sigma_c^2} $$", "id": "718454"}, {"introduction": "While the concept of ghost imaging is powerful, its practical utility hinges on the ability to distinguish a true signal from background noise. This exercise moves from ideal theory to the realities of a quantum imaging experiment using entangled photons, focusing on the critical figure of merit: the signal-to-noise ratio ($SNR$) [@problem_id:718391]. By modeling detector inefficiencies, dark counts, and accidental coincidences, you will learn to quantify the quality of an entangled-photon ghost image and understand the trade-offs involved in a real-world setup.", "problem": "Consider an entangled-photon ghost imaging system. A source produces pairs of spatially entangled photons (signal and idler) at a total rate of $R_p$. The generated two-photon state exhibits perfect spatial correlation, meaning that if the idler photon is detected at a transverse position $\\vec{\\rho}$, the signal photon is guaranteed to be at the same transverse position $\\vec{\\rho}$.\n\nThe idler photon travels directly to a high-resolution detector, $D_i$, which consists of an array of identical pixels. The idler beam uniformly illuminates an area $A_{beam}$ on this detector. Each pixel has an area of $A_{pix}$ and a dark count rate of $D_i$. The quantum efficiency of the idler detector is $\\eta_i$.\n\nThe signal photon travels to an object and then to a bucket detector, $D_s$, which has no spatial resolution. The signal beam also uniformly illuminates an area $A_{beam}$ on the object plane. The object is a simple binary mask: an opaque screen covering the entire beam area, with a single transmissive aperture of area $A_{obj}$ located within the beam. The bucket detector $D_s$ has a quantum efficiency of $\\eta_s$ and a dark count rate of $D_s$.\n\nA coincidence logic unit records an event if signals from $D_s$ and a specific pixel on $D_i$ arrive within a coincidence time window $\\tau_c$. The image is reconstructed by plotting the number of coincidence counts for each pixel of $D_i$ over a total measurement time $T_{meas}$.\n\nAssume that the number of counts for any process follows Poisson statistics. The signal ($S$) for imaging the aperture is defined as the difference between the average number of coincidence counts for a pixel whose corresponding location on the object is transmissive ($N_{on}$) and the average number for a pixel whose corresponding location is opaque ($N_{off}$). The noise ($N$) is defined as the standard deviation of this difference, $N = \\sqrt{\\mathrm{Var}(N_{on} - N_{off})}$, assuming the \"on\" and \"off\" measurements are statistically independent.\n\nDerive the expression for the signal-to-noise ratio, $SNR = S/N$, for imaging the aperture. Your final answer should be expressed in terms of the given parameters: $R_p, \\eta_s, \\eta_i, D_s, D_i, A_{beam}, A_{obj}, A_{pix}, \\tau_c$, and $T_{meas}$.", "solution": "1.  **Define singles count rates.**\n    The rate of counts at a single pixel of the idler detector ($R_i$) is the sum of the photon rate and the dark count rate:\n    $$ R_i = R_p \\frac{A_{pix}}{A_{beam}} \\eta_i + D_i $$\n    The rate of counts at the signal bucket detector ($R_s$) depends on the object's transmission:\n    $$ R_s = R_p \\frac{A_{obj}}{A_{beam}} \\eta_s + D_s $$\n\n2.  **Define true and accidental coincidence rates.**\n    The true-coincidence rate ($R_t$) for a pixel corresponding to a transmissive part of the object occurs when an entangled pair is successfully detected by both detectors:\n    $$ R_t = R_p \\frac{A_{pix}}{A_{beam}} \\eta_i \\eta_s $$\n    The accidental coincidence rate ($R_{acc}$) is due to uncorrelated counts arriving within the coincidence window $\\tau_c$:\n    $$ R_{acc} = R_i R_s \\tau_c $$\n\n3.  **Calculate total counts for \"on\" and \"off\" pixels.**\n    For a pixel corresponding to the transmissive aperture (\"on\"), the total number of coincidence counts in time $T_{meas}$ is the sum of true and accidental counts:\n    $$ N_{on} = (R_t + R_{acc}) T_{meas} $$\n    For a pixel corresponding to an opaque part of the object (\"off\"), there are no true coincidences, only accidental ones:\n    $$ N_{off} = R_{acc} T_{meas} $$\n\n4.  **Calculate Signal and Noise.**\n    The signal is the difference in counts:\n    $$ S = N_{on} - N_{off} = (R_t + R_{acc}) T_{meas} - R_{acc} T_{meas} = R_t T_{meas} $$\n    Since the counts follow Poisson statistics, the variance of the count number is equal to the mean count number. The noise is the standard deviation of the difference:\n    $$ N^2 = \\mathrm{Var}(N_{on} - N_{off}) = \\mathrm{Var}(N_{on}) + \\mathrm{Var}(N_{off}) = N_{on} + N_{off} $$\n    $$ N^2 = (R_t + R_{acc})T_{meas} + R_{acc}T_{meas} = (R_t + 2R_{acc})T_{meas} $$\n    $$ N = \\sqrt{(R_t + 2R_{acc})T_{meas}} $$\n\n5.  **Derive the Signal-to-Noise Ratio (SNR).**\n    $$ \\mathrm{SNR} = \\frac{S}{N} = \\frac{R_t T_{meas}}{\\sqrt{(R_t + 2R_{acc})T_{meas}}} = \\frac{R_t \\sqrt{T_{meas}}}{\\sqrt{R_t + 2R_{acc}}} $$\n\n6.  **Substitute the full expressions.**\n    Substituting the expressions for $R_t$ and $R_{acc}$ gives the final answer.\n    $$ R_t = R_p \\frac{A_{pix}}{A_{beam}} \\eta_i \\eta_s $$\n    $$ R_{acc} = \\left(R_p \\frac{A_{pix}}{A_{beam}} \\eta_i + D_i\\right) \\left(R_p \\frac{A_{obj}}{A_{beam}} \\eta_s + D_s\\right) \\tau_c $$", "answer": "$$\\boxed{\n\\frac{R_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i}\\eta_{s}\\sqrt{T_{meas}}}\n{\\sqrt{\nR_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i}\\eta_{s}\n+2\\bigl(R_{p}\\frac{A_{pix}}{A_{beam}}\\eta_{i}+D_{i}\\bigr)\n\\bigl(R_{p}\\frac{A_{obj}}{A_{beam}}\\eta_{s}+D_{s}\\bigr)\\tau_{c}\n}}\n}$$", "id": "718391"}, {"introduction": "Computational Ghost Imaging (CGI) replaces the physical reference arm with a computer, offering significant experimental advantages. However, this technique is not immune to imperfections, which can manifest as artifacts in the final reconstruction. This problem explores how non-ideal detector behavior, specifically dark counts and pattern-correlated electronic noise, can introduce a systematic background bias into the image [@problem_id:718477]. Solving this will provide insight into diagnosing and understanding artifacts in CGI and highlight the importance of the specific correlation algorithm used for reconstruction.", "problem": "In a computational ghost imaging (CGI) experiment, an object is imaged by correlating a sequence of known, random intensity patterns with the corresponding total intensity measurements from a single-pixel \"bucket\" detector.\n\nConsider a CGI setup with the following characteristics:\n1.  The patterns are displayed on a spatial light modulator (SLM) with a total of $M$ pixels.\n2.  A sequence of $N$ random binary patterns, $\\{P_n(\\vec{\\rho}_k)\\}_{n=1}^N$, is used, where $\\vec{\\rho}_k$ is the position of the $k$-th pixel ($k=1, \\dots, M$).\n3.  For any given pattern $n$ and pixel $k$, the value $P_{n,k} \\equiv P_n(\\vec{\\rho}_k)$ is either $1$ (light on) or $0$ (light off). The patterns are statistically independent from pixel to pixel and from one realization to the next. The probability of any pixel being 'on' is $P(P_{n,k}=1) = p$.\n4.  The object is described by a transmission function $T_k \\equiv T(\\vec{\\rho}_k)$. The light transmitted through the object is collected by the bucket detector.\n5.  The signal measured by the bucket detector for the $n$-th pattern, $I_n$, consists of two parts: a signal proportional to the total transmitted light, and a noise signal.\n    -   The light-induced signal is $I_{s,n} = \\eta \\sum_{k=1}^M P_{n,k} T_k$, where $\\eta$ is the detection efficiency.\n    -   The total noise signal has two components: one from the detector's intrinsic constant dark count level, $D_0$, and an additional pattern-correlated noise component. This correlated noise arises from electronic crosstalk and is proportional to the total number of 'on' pixels in the pattern, given by $\\beta \\sum_{k=1}^M P_{n,k}$, where $\\beta$ is a coupling coefficient.\n    -   The total signal is therefore $I_n = \\eta \\sum_{k=1}^M P_{n,k} T_k + D_0 + \\beta \\sum_{k=1}^M P_{n,k}$.\n6.  The image $G_k$ is reconstructed using the standard differential correlation formula:\n    $$ G_k = \\langle I_n P_{n,k} \\rangle_n - \\langle I_n \\rangle_n \\langle P_{n,k} \\rangle_n $$\n    where $\\langle \\cdot \\rangle_n$ denotes the average over all $N$ patterns.\n\nAssuming the number of patterns $N$ is large enough to replace the sample averages with their statistical expectation values, derive the expression for the background bias, $B$, in the reconstructed image. The background bias is the portion of the reconstructed signal $G_k$ that is spatially uniform and independent of the object's transmission function $T_k$.", "solution": "The reconstructed image for the $k$-th pixel is given by the covariance:\n$$ G_k = \\langle I_n P_{n,k} \\rangle - \\langle I_n \\rangle \\langle P_{n,k} \\rangle $$\nThe bucket signal is:\n$$ I_n = \\eta \\sum_{j=1}^M P_{n,j} T_j + D_0 + \\beta \\sum_{j=1}^M P_{n,j} $$\nWe compute the two terms of the covariance separately, using the statistical properties of the patterns. Since $P_{n,k}$ is a binary variable (0 or 1), $P_{n,k}^2 = P_{n,k}$, so $\\langle P_{n,k}^2 \\rangle = \\langle P_{n,k} \\rangle = p$. For different pixels $j \\neq k$, $\\langle P_{n,j} P_{n,k} \\rangle = \\langle P_{n,j} \\rangle \\langle P_{n,k} \\rangle = p^2$ due to statistical independence.\n\n1.  **Compute $\\langle I_n P_{n,k} \\rangle$:**\n    $$ \\langle I_n P_{n,k} \\rangle = \\left\\langle \\left( \\eta \\sum_{j} T_j P_{n,j} + D_0 + \\beta \\sum_{j} P_{n,j} \\right) P_{n,k} \\right\\rangle $$\n    $$ = \\eta \\sum_j T_j \\langle P_{n,j} P_{n,k} \\rangle + D_0 \\langle P_{n,k} \\rangle + \\beta \\sum_j \\langle P_{n,j} P_{n,k} \\rangle $$\n    We split the sums into terms where $j=k$ and $j \\neq k$:\n    $$ \\langle I_n P_{n,k} \\rangle = \\eta (T_k \\langle P_{n,k}^2 \\rangle + \\sum_{j \\neq k} T_j \\langle P_{n,j}P_{n,k} \\rangle) + D_0 p + \\beta (\\langle P_{n,k}^2 \\rangle + \\sum_{j \\neq k} \\langle P_{n,j}P_{n,k} \\rangle) $$\n    $$ = \\eta (p T_k + p^2 \\sum_{j \\neq k} T_j) + D_0 p + \\beta (p + (M-1)p^2) $$\n\n2.  **Compute $\\langle I_n \\rangle \\langle P_{n,k} \\rangle$:**\n    First, find the average bucket signal $\\langle I_n \\rangle$:\n    $$ \\langle I_n \\rangle = \\eta \\sum_j T_j \\langle P_{n,j} \\rangle + D_0 + \\beta \\sum_j \\langle P_{n,j} \\rangle = \\eta p \\sum_j T_j + D_0 + \\beta M p $$\n    Then multiply by $\\langle P_{n,k} \\rangle = p$:\n    $$ \\langle I_n \\rangle \\langle P_{n,k} \\rangle = p \\left( \\eta p \\sum_j T_j + D_0 + \\beta M p \\right) = \\eta p^2 \\sum_j T_j + D_0 p + \\beta M p^2 $$\n\n3.  **Calculate $G_k$ by subtracting the terms:**\n    $$ G_k = \\left[ \\eta (p T_k + p^2 \\sum_{j \\neq k} T_j) + D_0 p + \\beta (p + (M-1)p^2) \\right] - \\left[ \\eta p^2 \\sum_j T_j + D_0 p + \\beta M p^2 \\right] $$\n    Let's simplify by grouping the terms by coefficient ($\\eta, D_0, \\beta$):\n    -   **$\\eta$ terms:** $\\eta p T_k + \\eta p^2 \\sum_{j \\neq k} T_j - \\eta p^2 \\sum_j T_j = \\eta p T_k - \\eta p^2 T_k = \\eta p(1-p)T_k$.\n    -   **$D_0$ terms:** $D_0 p - D_0 p = 0$.\n    -   **$\\beta$ terms:** $\\beta (p + Mp^2 - p^2) - \\beta M p^2 = \\beta p - \\beta p^2 = \\beta p(1-p)$.\n    \n    Combining these gives the full reconstructed signal:\n    $$ G_k = \\eta p(1-p)T_k + \\beta p(1-p) $$\n    The first term is proportional to the object's transmission $T_k$, representing the desired image. The second term is a constant offset, independent of the spatial coordinate $k$ and the object $T_k$. This is the background bias, $B$.\n    $$ B = \\beta p(1-p) $$", "answer": "$$\\boxed{\\beta p(1-p)}$$", "id": "718477"}]}