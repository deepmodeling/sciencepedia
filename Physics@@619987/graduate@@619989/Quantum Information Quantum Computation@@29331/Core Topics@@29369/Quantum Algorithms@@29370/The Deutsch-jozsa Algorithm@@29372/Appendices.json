{"hands_on_practices": [{"introduction": "The remarkable efficiency of the Deutsch-Jozsa algorithm relies on perfect constructive and destructive interference. This first exercise examines the algorithm's fragility when this perfection is slightly broken by a coherent error within the quantum oracle [@problem_id:151423]. By analyzing an oracle that imparts an imperfect phase, you will quantify how a small deviation from the ideal unitary operation leads to a non-zero failure probability, providing direct insight into the crucial role of precise quantum control.", "problem": "The Deutsch-Jozsa algorithm determines whether a function $f: \\{0,1\\}^n \\to \\{0,1\\}$ is constant (the output is the same for all inputs) or balanced (the output is $0$ for exactly half of the inputs and $1$ for the other half).\n\nThe standard algorithm proceeds as follows:\n1.  Initialize an $(n+1)$-qubit register to the state $|0\\rangle^{\\otimes n} |1\\rangle$.\n2.  Apply a Hadamard gate $H$ to each qubit. This prepares the state\n    $$|\\psi_1\\rangle = \\left(\\frac{1}{\\sqrt{2^n}}\\sum_{x=0}^{2^n-1} |x\\rangle\\right) \\otimes \\frac{|0\\rangle - |1\\rangle}{\\sqrt{2}}$$\n3.  Apply the quantum oracle $U_f$, which is a unitary transformation defined by its action on computational basis states: $U_f|x\\rangle|y\\rangle = |x\\rangle|y \\oplus f(x)\\rangle$. Due to the phase kickback mechanism, its action on $|\\psi_1\\rangle$ is equivalent to applying a phase to the first $n$ qubits:\n    $$U_f |\\psi_1\\rangle = \\left(\\frac{1}{\\sqrt{2^n}}\\sum_{x=0}^{2^n-1} (-1)^{f(x)}|x\\rangle\\right) \\otimes \\frac{|0\\rangle - |1\\rangle}{\\sqrt{2}}$$\n4.  Apply a Hadamard gate $H$ to each of the first $n$ qubits.\n5.  Measure the first $n$ qubits in the computational basis. If the result is $|0\\rangle^{\\otimes n}$, the function is constant. Otherwise, it is balanced.\n\nConsider a scenario where the oracle is imperfect. Instead of applying a phase of $-1 = e^{i\\pi}$ when $f(x)=1$, it applies an erroneous phase of $e^{i(\\pi + \\epsilon)}$, where $\\epsilon$ is a small, real-valued error parameter. The oracle's action when $f(x)=0$ remains unchanged (it applies a phase of $1$).\n\nGiven a balanced function $f: \\{0,1\\}^n \\to \\{0,1\\}$, determine the probability of measuring the all-zero state, $|0\\rangle^{\\otimes n}$, in the first register after running the algorithm with this imperfect oracle. Express your answer as a closed-form analytic expression in terms of $\\epsilon$.", "solution": "We are given that the function $f$ is balanced, so exactly half of the inputs $x \\in \\{0,1\\}^n$ satisfy $f(x)=0$ and the other half satisfy $f(x)=1$. The initial state after step 2 is:\n\n$$\n|\\psi_1\\rangle = \\left( \\frac{1}{\\sqrt{2^n}} \\sum_{x=0}^{2^n-1} |x\\rangle \\right) \\otimes \\frac{|0\\rangle - |1\\rangle}{\\sqrt{2}}\n$$\n\nAfter applying the imperfect oracle $U_f$, which applies a phase of $1$ when $f(x)=0$ and $e^{i(\\pi + \\epsilon)} = -e^{i\\epsilon}$ when $f(x)=1$, the state becomes:\n\n$$\nU_f |\\psi_1\\rangle = \\left( \\frac{1}{\\sqrt{2^n}} \\sum_{x} \\omega(x) |x\\rangle \\right) \\otimes \\frac{|0\\rangle - |1\\rangle}{\\sqrt{2}}\n$$\n\nwhere $\\omega(x) = \\begin{cases} \n1 & \\text{if } f(x) = 0 \\\\\n-e^{i\\epsilon} & \\text{if } f(x) = 1 \n\\end{cases}$.\n\nLet $S_0 = \\{ x \\mid f(x) = 0 \\}$ and $S_1 = \\{ x \\mid f(x) = 1 \\}$, each with size $2^{n-1}$. The first $n$ qubits are in the state:\n\n$$\n|\\psi_2\\rangle = \\frac{1}{\\sqrt{2^n}} \\left( \\sum_{x \\in S_0} |x\\rangle - e^{i\\epsilon} \\sum_{x \\in S_1} |x\\rangle \\right)\n$$\n\nApplying the Hadamard transform $H^{\\otimes n}$ to each of the first $n$ qubits:\n\n$$\nH^{\\otimes n} |x\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{z=0}^{2^n-1} (-1)^{x \\cdot z} |z\\rangle\n$$\n\nwhere $x \\cdot z$ is the bitwise inner product modulo 2. Thus, the state becomes:\n\n$$\n|\\psi_3\\rangle = H^{\\otimes n} |\\psi_2\\rangle = \\frac{1}{2^n} \\sum_{z} |z\\rangle \\left( \\sum_{x \\in S_0} (-1)^{x \\cdot z} - e^{i\\epsilon} \\sum_{x \\in S_1} (-1)^{x \\cdot z} \\right)\n$$\n\nThe amplitude of the state $|0\\rangle^{\\otimes n}$ (i.e., $z = 0$) is:\n\n$$\n\\alpha = \\langle 0^{\\otimes n} | \\psi_3 \\rangle = \\frac{1}{2^n} \\left( \\sum_{x \\in S_0} (-1)^{x \\cdot 0} - e^{i\\epsilon} \\sum_{x \\in S_1} (-1)^{x \\cdot 0} \\right)\n$$\n\nSince $x \\cdot 0 = 0$ for all $x$, $(-1)^{x \\cdot 0} = 1$, so:\n\n$$\n\\alpha = \\frac{1}{2^n} \\left( \\sum_{x \\in S_0} 1 - e^{i\\epsilon} \\sum_{x \\in S_1} 1 \\right) = \\frac{1}{2^n} \\left( 2^{n-1} - e^{i\\epsilon} \\cdot 2^{n-1} \\right) = \\frac{1}{2} \\left( 1 - e^{i\\epsilon} \\right)\n$$\n\nThe probability of measuring $|0\\rangle^{\\otimes n}$ is $|\\alpha|^2$:\n\n$$\n|\\alpha|^2 = \\left| \\frac{1}{2} (1 - e^{i\\epsilon}) \\right|^2 = \\frac{1}{4} |1 - e^{i\\epsilon}|^2\n$$\n\nNow, $|1 - e^{i\\epsilon}|^2 = (1 - e^{i\\epsilon})(1 - e^{-i\\epsilon}) = 1 - e^{-i\\epsilon} - e^{i\\epsilon} + e^{i\\epsilon} e^{-i\\epsilon} = 1 - (e^{i\\epsilon} + e^{-i\\epsilon}) + 1 = 2 - 2\\cos\\epsilon$. Thus:\n\n$$\n|\\alpha|^2 = \\frac{1}{4} (2 - 2\\cos\\epsilon) = \\frac{1}{4} \\cdot 2(1 - \\cos\\epsilon) = \\frac{1}{2} (1 - \\cos\\epsilon)\n$$\n\nUsing the identity $1 - \\cos\\epsilon = 2 \\sin^2(\\epsilon/2)$:\n\n$$\n|\\alpha|^2 = \\frac{1}{2} \\cdot 2 \\sin^2\\left(\\frac{\\epsilon}{2}\\right) = \\sin^2\\left(\\frac{\\epsilon}{2}\\right)\n$$\n\nTherefore, the probability of measuring the all-zero state is $\\sin^2(\\epsilon/2)$.", "answer": "$$\n\\boxed{\\sin^{2}\\left(\\frac{\\epsilon}{2}\\right)}\n$$", "id": "151423"}, {"introduction": "Beyond coherent gate errors, quantum computations are plagued by incoherent noise, which requires the more general formalism of density matrices. This practice investigates the effect of an imperfect initial state, where the ancilla qubit is prepared in a mixed state rather than a pure one [@problem_id:151531]. Working through this scenario will demonstrate how to model state preparation errors and reveal how probabilistic, incoherent noise fundamentally compromises the algorithm's determinism.", "problem": "The Deutsch-Jozsa algorithm provides a method for determining a property of a function $f: \\{0,1\\}^n \\to \\{0,1\\}$. The function is guaranteed to be either *constant* (the output is the same for all inputs) or *balanced* (the output is 0 for exactly half of the inputs and 1 for the other half).\n\nThe standard algorithm utilizes a quantum circuit with $n$ input qubits and one target (or ancilla) qubit. The initial state is $|0\\rangle^{\\otimes n}|1\\rangle$. The circuit applies a sequence of gates:\n1. A Hadamard gate on each of the $n+1$ qubits.\n2. The function oracle $U_f$, which performs the transformation $|x\\rangle|y\\rangle \\mapsto |x\\rangle|y \\oplus f(x)\\rangle$.\n3. A Hadamard gate on each of the first $n$ input qubits.\n\nFinally, the first $n$ qubits are measured in the computational basis. If the result is the all-zero state $|0\\rangle^{\\otimes n}$, the function is declared constant. If any other result is obtained, the function is declared balanced. In its ideal form, the algorithm is deterministic and always gives the correct answer.\n\nConsider a modification to this procedure where the state preparation of the target qubit is imperfect. The $n$ input qubits are correctly prepared in the state $|0\\rangle^{\\otimes n}$. However, the target qubit is prepared in the mixed state described by the density operator:\n$$\n\\rho_{\\text{target}} = (1-p) |1\\rangle\\langle 1| + p |0\\rangle\\langle 0|\n$$\nwhere $p \\in [0, 1]$ is a parameter characterizing the preparation error.\n\nThe rest of the algorithm (steps 1-3 and the final measurement rule) proceeds as described above. Assume that the function $f$ is known to be a balanced function. Calculate the probability of the algorithm correctly identifying it as balanced.", "solution": "The algorithm correctly identifies the function as balanced if the measurement of the first $n$ qubits is not the all-zero state $|0\\rangle^{\\otimes n}$. The initial state of the $n$ input qubits is $|0\\rangle^{\\otimes n}$, and the target qubit is in the mixed state:\n\n$$\n\\rho_{\\text{target}} = (1-p) |1\\rangle\\langle 1| + p |0\\rangle\\langle 0|\n$$\n\nThis mixed state corresponds to two scenarios:\n- Scenario A: Target qubit is $|1\\rangle$ with probability $1-p$.\n- Scenario B: Target qubit is $|0\\rangle$ with probability $p$.\n\nIn Scenario A (target initially $|1\\rangle$), the circuit is ideal. After applying the Hadamard gates, oracle $U_f$, and another set of Hadamard gates, the state of the first $n$ qubits for a balanced function $f$ has zero amplitude for $|0\\rangle^{\\otimes n}$. Thus, the probability of measuring $|0\\rangle^{\\otimes n}$ is 0.\n\nIn Scenario B (target initially $|0\\rangle$), after the first Hadamard gates, the target state is $|+\\rangle = \\frac{|0\\rangle + |1\\rangle}{\\sqrt{2}}$. The oracle $U_f$ acts as $|x\\rangle|y\\rangle \\mapsto |x\\rangle|y \\oplus f(x)\\rangle$. Since:\n\n$$\nU_f |x\\rangle|+\\rangle = |x\\rangle \\frac{|f(x)\\rangle + |1 \\oplus f(x)\\rangle}{\\sqrt{2}} = |x\\rangle|+\\rangle\n$$\n\nthe state remains unchanged by $U_f$. After the final Hadamard gates on the first $n$ qubits, the state becomes $|0\\rangle^{\\otimes n} \\otimes |+\\rangle$. Thus, the measurement of the first $n$ qubits always yields $|0\\rangle^{\\otimes n}$ with probability 1.\n\nThe overall probability of measuring $|0\\rangle^{\\otimes n}$ is the weighted average:\n\n$$\nP(\\text{measure } |0\\rangle^{\\otimes n}) = (1-p) \\cdot 0 + p \\cdot 1 = p\n$$\n\nThe algorithm incorrectly declares the function constant if $|0\\rangle^{\\otimes n}$ is measured. Since the function is balanced, the probability of correct identification (declaring balanced) is:\n\n$$\nP(\\text{correct}) = 1 - P(\\text{measure } |0\\rangle^{\\otimes n}) = 1 - p\n$$", "answer": "$$ \\boxed{1 - p} $$", "id": "151531"}, {"introduction": "In physical quantum processors, qubits are not perfectly isolated and can suffer from unwanted interactions, or \"crosstalk.\" This final exercise models a realistic correlated error, where a parasitic $Z_j Z_{j+1}$-interaction occurs between adjacent qubits in the input register during the oracle operation [@problem_id:151393]. By calculating the success probability in the presence of this multi-qubit coherent error, you will learn how such correlated noise propagates through a circuit and how its impact can scale with the size of the system.", "problem": "The Deutsch-Jozsa algorithm determines whether a function $f: \\{0, 1\\}^n \\to \\{0, 1\\}$ is constant or balanced, with the promise that it is one of the two. The algorithm uses an $n$-qubit input register and a single-qubit ancillary register.\n\nThe standard algorithm proceeds as follows:\n1.  Initialize the state to $|0\\rangle^{\\otimes n} |1\\rangle$.\n2.  Apply a Hadamard gate $H$ to each qubit, preparing the state $\\frac{1}{\\sqrt{2^n}} \\sum_{x \\in \\{0,1\\}^n} |x\\rangle \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$.\n3.  Apply the oracle query $U_f$, which maps $|x\\rangle|y\\rangle \\to |x\\rangle|y \\oplus f(x)\\rangle$. The action on the prepared state induces a phase kickback, transforming the state of the input register to $\\frac{1}{\\sqrt{2^n}} \\sum_{x \\in \\{0,1\\}^n} (-1)^{f(x)} |x\\rangle$. The ancillary qubit remains in the state $\\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$ and can be ignored henceforth.\n4.  Apply a Hadamard gate $H$ to each qubit of the input register.\n5.  Measure the input register in the computational basis. If the result is $|0\\rangle^{\\otimes n}$, the function is declared constant. Otherwise, it is declared balanced. For an ideal oracle, this determination is always correct.\n\nConsider a practical implementation where the $n$ qubits of the input register are arranged in a 1D chain. During the oracle application step, a parasitic ZZ crosstalk interaction occurs between adjacent qubits. This coherent error can be modeled by a unitary operator $U_{\\text{err}}$ that acts on the input register immediately after the ideal oracle $U_f$. The total transformation during the oracle step is thus $U_{\\text{err}} U_f$.\n\nThe error operator is given by:\n$$\nU_{\\text{err}} = \\exp\\left(-i \\theta \\sum_{j=1}^{n-1} Z_j Z_{j+1}\\right)\n$$\nwhere $Z_j$ is the Pauli-Z operator acting on the $j$-th qubit and $\\theta$ is a real, dimensionless parameter characterizing the strength of the parasitic interaction.\n\nAssuming the function $f$ is constant, calculate the probability, $P_{\\text{success}}$, that the algorithm correctly identifies it as such (i.e., the final measurement of the input register yields the $|0\\rangle^{\\otimes n}$ state).", "solution": "1. After the ideal oracle, for a constant $f(x)=0$, the input register is in the product state:\n$$|\\psi_1\\rangle = \\frac{1}{\\sqrt{2^n}}\\sum_{x\\in\\{0,1\\}^n}|x\\rangle = |+\\rangle^{\\otimes n}$$\n2. The coherent-error unitary is:\n$$U_{\\text{err}} = \\exp\\left(-i\\theta\\sum_{j=1}^{n-1}Z_j Z_{j+1}\\right)$$\n3. The final Hadamard layer plus measurement amplitude for $|0\\rangle^{\\otimes n}$ is:\n$$A = \\langle 0|^{\\otimes n} H^{\\otimes n} U_{\\text{err}} |+\\rangle^{\\otimes n}$$\n4. Use $H^{\\otimes n}Z_jZ_{j+1}H^{\\otimes n}=X_jX_{j+1}$ and $H|+\\rangle=|0\\rangle$ to rewrite:\n$$A = \\langle 0|^{\\otimes n}\\exp\\left(-i\\theta\\sum_j Z_j Z_{j+1}\\right)|+\\rangle^{\\otimes n} = \\langle 0|^{\\otimes n}\\exp\\left(-i\\theta\\sum_j X_j X_{j+1}\\right)|0\\rangle^{\\otimes n}$$\n5. Since the commuting pair-gates factor,\n$$\\exp\\left(-i\\theta\\sum_{j=1}^{n-1}X_j X_{j+1}\\right) = \\prod_{j=1}^{n-1}(\\cos\\theta \\cdot I - i\\sin\\theta \\cdot X_jX_{j+1})$$\nacting on $|0\\rangle^{\\otimes n}$. Each term $X_jX_{j+1}$ flips qubits $j,j+1$, and the only way to return to $|0\\rangle^{\\otimes n}$ is to pick the identity from every factor. Thus,\n$$A = (\\cos\\theta)^{n-1}$$\nand the success probability is:\n$$P_{\\text{success}} = |A|^2 = \\cos^{2(n-1)}\\theta$$", "answer": "$$\\boxed{\\cos^{2(n-1)}\\theta}$$", "id": "151393"}]}