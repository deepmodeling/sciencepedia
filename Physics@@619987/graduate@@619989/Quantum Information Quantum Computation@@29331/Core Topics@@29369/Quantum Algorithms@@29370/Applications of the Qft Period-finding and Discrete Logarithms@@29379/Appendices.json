{"hands_on_practices": [{"introduction": "To understand how the Quantum Fourier Transform (QFT) enables period-finding, we first examine the ideal scenario. This exercise ([@problem_id:48195]) explores the case where the quantum register size $Q$ is an exact multiple of the function's period $r$. By calculating the probability of a specific measurement outcome, you will see how the QFT concentrates all the probability into a few, perfectly sharp peaks at integer multiples of $Q/r$, revealing the period's structure in the frequency domain.", "problem": "In Shor's algorithm for factoring an integer $N$, the quantum core is a period-finding subroutine. Given a base $a$ coprime to $N$, the algorithm finds the period $r$ of the function $f(x) = a^x \\pmod N$. This is achieved by preparing a quantum state, applying a circuit for the unitary operator $U_f:|x\\rangle|y\\rangle \\to |x\\rangle|y \\oplus f(x)\\rangle$, measuring the second register, and then applying a Quantum Fourier Transform (QFT) to the first register before a final measurement.\n\nConsider the task of factoring $N=221$ using the base $a=138$. The period of the function $f(x)=138^x \\pmod{221}$ is given to be $r=8$. The first register consists of $n=11$ qubits, so its dimension is $Q=2^n$. After applying the QFT to the first register, a measurement is performed.\n\nCalculate the exact probability of measuring the outcome $k=257$. This outcome is known to successfully yield the period $r=8$ when processed by the classical continued fractions algorithm. Assume an ideal, noise-free quantum computer.", "solution": "We have $N=221$, base $a=138$, period $r=8$, and first-register size $n=11$, so $Q=2^{11}=2048$.  After measuring the second register to obtain some $y=f(c)$, the first register collapses to the equal-amplitude superposition over\n$$\n\\{\\,c,\\;c+r,\\;c+2r,\\;\\dots,\\;c+(m-1)r\\}\\,,\n\\qquad m=\\Big\\lfloor\\frac{Q-1-c}{r}\\Big\\rfloor+1\\,.\n$$\nSince $Q=2048$ and $r=8$, one checks $\\lfloor(2047-c)/8\\rfloor+1=256$ for every $0\\le c<8$, so $m=256$ and $rm=2048=Q$.  \n\n1.  Relevant equations.  \n   After the QFT on the first register and before the final measurement, the amplitude of outcome $k$ is\n   $$\n   A(k)\n   =\\frac{1}{\\sqrt{m\\,Q}}\n    \\sum_{\\ell=0}^{m-1}e^{2\\pi i k(c+\\ell r)/Q}\n   =\\frac{e^{2\\pi i kc/Q}}{\\sqrt{m\\,Q}}\\;\n    \\sum_{\\ell=0}^{m-1}\\bigl(e^{2\\pi i k r/Q}\\bigr)^\\ell,\n   $$\n   hence the probability is\n   $$\n   P(k)\n   =|A(k)|^2\n   =\\frac{1}{m\\,Q}\\,\n    \\Bigl|\\sum_{\\ell=0}^{m-1}e^{2\\pi i k r\\ell/Q}\\Bigr|^2.\n   $$\n\n2.  Sum of the geometric series.  \n   Let $\\omega=e^{2\\pi i k r/Q}=e^{2\\pi i k/256}$.  Then\n   $$\n   S=\\sum_{\\ell=0}^{255}\\omega^\\ell\n     =\\begin{cases}\n       256,&\\omega=1,\\\\\n       \\displaystyle\\frac{1-\\omega^{256}}{1-\\omega},&\\omega\\neq1.\n      \\end{cases}\n   $$\n   Since $\\omega^{256}=e^{2\\pi i k}=1$ for any integer $k$, we get\n   $$\n   S=\\begin{cases}\n       256,&\\omega=1\\;(k\\equiv0\\!\\!\\pmod{256}),\\\\\n       0,&\\omega\\neq1\\;(k\\not\\equiv0\\!\\!\\pmod{256}).\n     \\end{cases}\n   $$\n\n3.  Probability at $k=257$.  \n   Here $257\\not\\equiv0\\pmod{256}$, so $S=0$.  Thus\n   $$\n   P(257)\n   =\\frac{1}{256\\cdot2048}\\,|0|^2\n   =0.\n   $$\n\nHence the exact probability of measuring $k=257$ is zero.", "answer": "$$\\boxed{0}$$", "id": "48195"}, {"introduction": "While the ideal case provides a clear picture, practical implementations of Shor's algorithm rarely have the luxury of the register size $Q$ being a multiple of the unknown period $r$. This practice problem ([@problem_id:48198]) delves into this more general and realistic scenario. You will calculate the probability of an outcome that is not an integer multiple of $Q/r$, providing insight into why the measurement results are peaked near these target frequencies and justifying the necessity of classical algorithms like the continued fraction expansion.", "problem": "The quantum part of Shor's algorithm for factoring an integer $N$ relies on a subroutine called quantum order-finding. Given $N$ and a coprime integer $a < N$, this subroutine finds the smallest positive integer $r$ such that $a^r \\equiv 1 \\pmod{N}$.\n\nThe procedure uses two quantum registers. The first is an $L$-qubit register initialized to $|0\\rangle^{\\otimes L}$, and the second is a register large enough to hold values up to $N-1$, also initialized to $|0\\rangle$. Let $Q = 2^L$. The algorithm proceeds as follows:\n\n1.  Apply a Hadamard transform to each qubit of the first register, creating the state:\n    $$ |\\psi_1\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{x=0}^{Q-1} |x\\rangle |0\\rangle $$\n2.  Apply the modular exponentiation operator $U_f$, where $f(x) = a^x \\pmod{N}$, to the combined state:\n    $$ |\\psi_2\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{x=0}^{Q-1} |x\\rangle |a^x \\pmod{N}\\rangle $$\n3.  Apply the Quantum Fourier Transform (QFT) to the first register.\n4.  Measure the first register. The measurement result is an integer $k \\in \\{0, 1, ..., Q-1\\}$.\n\nThe measured value $k$ is likely to be close to an integer multiple of $Q/r$. The period $r$ can then be deduced from $k/Q$ using the continued fractions algorithm.\n\nConsider the case of factoring $N=21$ with the base $a=4$. Let the first register be comprised of $L=10$ qubits, so $Q=1024$. Suppose after step 4, the measured outcome for the first register is $k=171$. This outcome, when processed with the continued fractions algorithm, suggests a period candidate that is different from the true period. Calculate the exact probability, $P(k=171)$, of measuring this specific outcome.", "solution": "We wish to compute \n$$P(k)=\\frac{1}{Q^2}\\sum_{y=0}^{r-1}\\Bigl|\\sum_{m=0}^{M_y-1}e^{2\\pi i\\,k(y+m r)/Q}\\Bigr|^2$$\nfor $N=21$, $a=4$, so $r=\\min\\{r:a^r\\equiv1\\pmod{21}\\}=3$, $L=10$, $Q=2^{10}=1024$, and the observed $k=171$. \n\n1.  Determine $M_y=\\#\\{m\\ge0:y+mr\\le Q-1\\}=\\left\\lfloor\\frac{Q-1-y}{r}\\right\\rfloor+1$.  Since $Q=3\\cdot341+1$, one finds\n$$M_0=342,\\quad M_1=M_2=341.$$\n\n2.  Define \n$$\\theta=\\frac{2\\pi k r}{Q}=\\frac{2\\pi\\cdot171\\cdot3}{1024}\n=\\pi\\Bigl(1+\\tfrac1{512}\\Bigr),$$ \nand let $S_y=\\sum_{m=0}^{M_y-1}e^{i\\theta m}e^{2\\pi i k y/Q}$.  The geometric-series formula gives\n$$\\Bigl|S_y\\Bigr|\n=\\Bigl|\\frac{1-e^{iM_y\\theta}}{1-e^{i\\theta}}\\Bigr|\n=\\frac{\\bigl|\\sin(\\tfrac{M_y\\theta}{2})\\bigr|}{\\bigl|\\sin(\\tfrac{\\theta}{2})\\bigr|}.$$\n\n3.  Noting \n$$\\frac{\\theta}{2}=\\frac\\pi2+\\frac{\\pi}{1024},\\qquad\n\\sin\\!\\bigl(\\tfrac\\theta2\\bigr)=\\cos\\!\\bigl(\\tfrac\\pi{1024}\\bigr),$$\nand \n$$\\sin\\!\\bigl(171\\theta\\bigr)\n=\\sin\\!\\Bigl(\\pi\\frac{87723}{512}\\Bigr)\n=-\\sin\\!\\Bigl(\\frac{171\\pi}{512}\\Bigr),$$\n$$\\sin\\!\\bigl(341\\tfrac\\theta2\\bigr)\n=\\sin\\!\\Bigl(\\pi\\frac{174933}{1024}\\Bigr)\n=\\sin\\!\\Bigl(\\frac{853\\pi}{1024}\\Bigr)\n=\\sin\\!\\Bigl(\\frac{171\\pi}{1024}\\Bigr),$$\nwe get\n$$|S_0|^2\n=\\frac{\\sin^2\\!\\bigl(171\\pi/512\\bigr)}{\\cos^2\\!(\\pi/1024)},\\quad\n|S_1|^2=|S_2|^2\n=\\frac{\\sin^2\\!\\bigl(171\\pi/1024\\bigr)}{\\cos^2\\!(\\pi/1024)}.$$\n\n4.  Hence\n$$P(171)=\\frac{1}{1024^2}\\Bigl(|S_0|^2+2|S_1|^2\\Bigr)\n=\\frac{1}{1024^2\\cos^2(\\pi/1024)}\\Bigl[\\sin^2\\!\\bigl(\\tfrac{171\\pi}{512}\\bigr)\n+2\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\Bigr].$$\n\n5.  Finally use $\\sin(171\\pi/512)=2\\sin(171\\pi/1024)\\cos(171\\pi/1024)$ to combine terms:\n$$P(171)\n=\\frac{2\\,\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\bigl(2\\cos^2\\!\\tfrac{171\\pi}{1024}+1\\bigr)}\n{1024^2\\,\\cos^2\\!\\bigl(\\tfrac{\\pi}{1024}\\bigr)}.$$", "answer": "$$\\boxed{\\frac{2\\,\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\bigl(2\\cos^2\\!\\tfrac{171\\pi}{1024}+1\\bigr)}{1024^2\\,\\cos^2\\!\\bigl(\\tfrac{\\pi}{1024}\\bigr)}}$$", "id": "48198"}, {"introduction": "A successful quantum algorithm must be robust against the inevitable noise of a physical quantum computer. This exercise ([@problem_id:48239]) introduces a common noise model, the depolarizing channel, affecting the gates within the modular exponentiation oracle. By analyzing how this incoherent error affects the final state, you will calculate the resulting height of the primary Fourier peaks, offering a quantitative understanding of how decoherence degrades the algorithm's output and reduces the probability of success.", "problem": "**Background:** The quantum period-finding algorithm is a key subroutine in several quantum algorithms, including Shor's algorithm for factoring. It is designed to find the period $r$ of a function $f: \\{0, 1, \\dots, N-1\\} \\to Y$, which satisfies the property $f(x) = f(x+r)$ for all $x$. The algorithm typically starts with an $n$-qubit input register (where $N=2^n$) prepared in a uniform superposition $\\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1}|x\\rangle$, and an auxiliary output register. An oracle $U_f$ is applied to map the state to $\\frac{1}{\\sqrt{N}} \\sum_{x=0}^{N-1} |x\\rangle |f(x)\\rangle$. Subsequently, a Quantum Fourier Transform (QFT) is performed on the input register. A measurement on this register yields outcomes $k$ that are heavily concentrated at integer multiples of $N/r$. These concentrations are known as the primary Fourier peaks in the probability distribution of the measurement outcomes. For an ideal quantum computer, the probability of measuring any one of these peaks is $1/r$.\n\n**Problem:** Consider a noisy implementation of the period-finding algorithm where the function $f$ has a period $r$ that is a divisor of $N=2^n$. The oracle $U_f$ is constructed as a sequence of $n$ distinct two-qubit controlled-unitary gates. Following each of these $n$ gates, the two qubits involved are affected by a two-qubit depolarizing channel $\\mathcal{E}(\\rho_{2q}) = (1-p)\\rho_{2q} + p \\frac{I_4}{4}$, where $\\rho_{2q}$ is the state of the two qubits, $p$ is the error probability per gate, and $I_4$ is the identity operator on the two-qubit Hilbert space.\n\nYou are to model the cumulative effect of these $n$ noisy gates on the total system's density matrix, $\\rho_{sys}$, as a global depolarization process. That is, the final state of the system after the noisy oracle is given by:\n$$\n\\rho_{final} = (1-p_{eff})\\rho_{ideal} + p_{eff}\\frac{I_{total}}{D}\n$$\nwhere $\\rho_{ideal}$ is the state created by a perfect oracle, $p_{eff}$ is the effective probability of at least one error occurring across the $n$ gates, $I_{total}$ is the identity on the Hilbert space of both registers, and $D$ is the total dimension of this space. The output register is assumed to be large enough to store all function values uniquely.\n\nCalculate the probability of measuring a specific non-zero primary Fourier peak (e.g., the one corresponding to $k=N/r$) from the input register. Express your answer as a closed-form analytical expression in terms of $n$, the period $r$, and the per-gate error probability $p$.", "solution": "We model the action of the $n$ noisy two-qubit gates as a global depolarization with effective error probability \n$$\np_{\\rm eff}=1-(1-p)^n,\n$$\nsince each gate is followed by an independent depolarizing channel of error probability $p$.  Thus the final state after the oracle is\n$$\n\\rho_{\\rm final}=(1-p_{\\rm eff})\\rho_{\\rm ideal}+p_{\\rm eff}\\frac{I_{\\rm total}}{D},\n$$\nwith $D$ the total dimension.\n\nMeasurement of the input register in the Fourier basis yields for a specific peak $k$ the probability\n$$\nP(k)=(1-p_{\\rm eff})P_{\\rm ideal}(k)+p_{\\rm eff}P_{\\rm mixed}(k).\n$$\nFor a nonzero primary Fourier peak in the ideal case,\n$$\nP_{\\rm ideal}(k)=\\frac1r,\n$$\nand under the maximally mixed state the reduced input register is uniform over $N=2^n$ outcomes,\n$$\nP_{\\rm mixed}(k)=\\frac1N=\\frac1{2^n}.\n$$\nSubstituting $p_{\\rm eff}=1-(1-p)^n$ and $1-p_{\\rm eff}=(1-p)^n$ gives\n$$\nP(k)\n=(1-p)^n\\frac1r+\\bigl[1-(1-p)^n\\bigr]\\frac1{2^n}.\n$$", "answer": "$$\\boxed{\\frac{(1-p)^n}{r}+\\frac{1-(1-p)^n}{2^n}}$$", "id": "48239"}]}