{"hands_on_practices": [{"introduction": "The power of amplitude amplification is most clearly revealed through its geometric interpretation as a rotation in a two-dimensional plane. To build a robust intuition, this exercise challenges you to apply the algorithm to a non-standard initial state: the entangled Greenberger-Horne-Zeilinger (GHZ) state. By analyzing this scenario [@problem_id:45135], you will reinforce your understanding that the algorithm's dynamics depend fundamentally on the initial angle $ \\theta $ between your starting state and the target state, not on any fixed formula for the uniform superposition.", "problem": "The Grover search algorithm is a cornerstone of quantum computation, designed to find a specific \"marked\" item in an unstructured database. The core of the algorithm is the iterative application of the Grover operator, $G$, which progressively increases the amplitude of the marked quantum state.\n\nA single Grover iteration is described by the operator $G = U_s U_w$, where:\n1.  $U_w = I - 2|w\\rangle\\langle w|$ is the \"oracle\" operator, which flips the sign of the marked state $|w\\rangle$.\n2.  $U_s = 2|\\psi_0\\rangle\\langle \\psi_0| - I$ is the \"diffusion\" operator, which performs a reflection about the initial state $|\\psi_0\\rangle$.\n\nTypically, the algorithm starts from a uniform superposition of all possible states. In this problem, we explore a different scenario. Consider an $n$-qubit quantum computer, with $n \\ge 2$. The marked state is the ground state $|w\\rangle = |0\\rangle^{\\otimes n}$. However, the initial state $|\\psi_0\\rangle$ is not the uniform superposition, but the $n$-qubit Greenberger–Horne–Zeilinger (GHZ) state:\n$$\n|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}} \\left( |0\\rangle^{\\otimes n} + |1\\rangle^{\\otimes n} \\right)\n$$\nYour task is to calculate the probability of finding the system in the marked state $|w\\rangle$ after a single application of the Grover operator $G$ on the initial state $|\\psi_0\\rangle$. This is the success probability, $P_{success} = |\\langle w| G |\\psi_0\\rangle|^2$.", "solution": "The problem asks for the success probability of a modified Grover search after one iteration. The key to solving this problem is to use the geometric interpretation of the Grover algorithm. The entire process can be visualized as a rotation in a two-dimensional subspace of the full Hilbert space.\n\n**Step 1: Define the 2D Subspace**\nThe dynamics of the Grover algorithm are confined to the 2D plane spanned by the marked state $|w\\rangle$ and the initial state $|\\psi_0\\rangle$. It is more convenient to use an orthonormal basis for this plane. We choose the marked state $|w\\rangle$ as one basis vector. The other basis vector, which we denote as $|w^\\perp\\rangle$, is the component of the initial state $|\\psi_0\\rangle$ that is orthogonal to $|w\\rangle$, properly normalized.\n\nThe marked state is $|w\\rangle = |0\\rangle^{\\otimes n}$.\nThe initial state is $|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle^{\\otimes n} + |1\\rangle^{\\otimes n}) = \\frac{1}{\\sqrt{2}}(|w\\rangle + |1\\rangle^{\\otimes n})$.\nThe state $|1\\rangle^{\\otimes n}$ is orthogonal to $|w\\rangle = |0\\rangle^{\\otimes n}$ since $\\langle 0...0 | 1...1 \\rangle = 0$. It is also normalized. So, we can identify $|w^\\perp\\rangle = |1\\rangle^{\\otimes n}$.\n\n**Step 2: Express the Initial State in the 2D Basis**\nAny state in this 2D plane can be written as a linear combination of $|w\\rangle$ and $|w^\\perp\\rangle$. The initial state $|\\psi_0\\rangle$ can be written in the form:\n$$\n|\\psi_0\\rangle = \\sin(\\theta) |w\\rangle + \\cos(\\theta) |w^\\perp\\rangle\n$$\nfor some angle $\\theta$. The initial probability of finding the marked state is $\\sin^2(\\theta)$.\nFrom our states:\n$$\n|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}|w\\rangle + \\frac{1}{\\sqrt{2}}|w^\\perp\\rangle\n$$\nBy comparing the two forms, we can identify $\\sin(\\theta)$ and $\\cos(\\theta)$:\n$$\n\\sin(\\theta) = \\frac{1}{\\sqrt{2}}, \\quad \\cos(\\theta) = \\frac{1}{\\sqrt{2}}\n$$\nThis gives an initial angle of $\\theta = \\frac{\\pi}{4}$. The initial success probability is $|\\langle w|\\psi_0\\rangle|^2 = \\sin^2(\\pi/4) = 1/2$.\n\n**Step 3: Geometric Interpretation of the Grover Operator**\nThe Grover operator $G = U_s U_w$ corresponds to a rotation in the $(|w^\\perp\\rangle, |w\\rangle)$ plane.\n- The oracle $U_w = I - 2|w\\rangle\\langle w|$ is a reflection about the $|w^\\perp\\rangle$ axis.\n- The diffusion operator $U_s = 2|\\psi_0\\rangle\\langle \\psi_0| - I$ is a reflection about the initial state vector $|\\psi_0\\rangle$.\nThe composition of two reflections is a rotation. The angle of rotation is twice the angle between the two reflection axes. The angle between $|w^\\perp\\rangle$ and $|\\psi_0\\rangle$ is $\\theta$. Thus, one application of the Grover operator $G$ rotates the state vector by an angle of $2\\theta$ in the plane towards the target state $|w\\rangle$.\n\n**Step 4: Calculate the State After One Iteration**\nThe initial state $|\\psi_0\\rangle$ is at an angle $\\theta$ with respect to the $|w^\\perp\\rangle$ axis. After one Grover iteration, the new state $|\\psi_1\\rangle = G|\\psi_0\\rangle$ will be at an angle $\\theta + 2\\theta = 3\\theta$ with respect to the $|w^\\perp\\rangle$ axis.\nSo, the state after one iteration can be written as:\n$$\n|\\psi_1\\rangle = \\sin(3\\theta) |w\\rangle + \\cos(3\\theta) |w^\\perp\\rangle\n$$\n\n**Step 5: Calculate the Success Probability**\nThe success probability after one iteration is the squared magnitude of the amplitude of the marked state $|w\\rangle$ in the state $|\\psi_1\\rangle$.\n$$\nP_{success} = |\\langle w | \\psi_1 \\rangle|^2 = \\sin^2(3\\theta)\n$$\nWe found that $\\theta = \\pi/4$. Substituting this value:\n$$\nP_{success} = \\sin^2\\left(3 \\cdot \\frac{\\pi}{4}\\right) = \\sin^2\\left(\\frac{3\\pi}{4}\\right)\n$$\nWe evaluate the sine function:\n$$\n\\sin\\left(\\frac{3\\pi}{4}\\right) = \\sin\\left(\\pi - \\frac{\\pi}{4}\\right) = \\sin\\left(\\frac{\\pi}{4}\\right) = \\frac{1}{\\sqrt{2}}\n$$\nFinally, we compute the probability:\n$$\nP_{success} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{1}{2}\n$$\nInterestingly, the probability of finding the marked state remains unchanged after one iteration. This is a special case due to the initial angle being $\\theta=\\pi/4$.", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "45135"}, {"introduction": "Ideal quantum algorithms provide a theoretical benchmark, but real-world quantum computers are susceptible to errors. This exercise [@problem_id:45186] moves from the ideal to the practical by modeling a common imperfection: a faulty oracle that applies an incorrect phase to the marked state. By calculating the success probability in this scenario, you will learn to analyze how coherent errors impact performance and practice working directly with the core Grover operators, rather than relying on the simplified final formulas.", "problem": "Consider a quantum search problem in an $N$-dimensional Hilbert space with an orthonormal basis $\\{|0\\rangle, |1\\rangle, \\dots, |N-1\\rangle\\}$. There is a single unique \"marked\" state, denoted by $|w\\rangle$. The algorithm starts in the uniform superposition state:\n$$|\\psi_0\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$$\n\nA standard Grover iteration consists of applying the operator $G = U_s U_w$, where $U_w$ is the oracle and $U_s$ is the diffusion operator. The diffusion operator is defined as $U_s = 2|\\psi_0\\rangle\\langle \\psi_0| - I$, where $I$ is the identity operator.\n\nA correct oracle $U_w$ marks the state $|w\\rangle$ by applying a phase of $-1$, i.e., $U_w = I - 2|w\\rangle\\langle w|$. In this problem, we have a faulty oracle, $U_w(\\phi)$, which applies a phase of $e^{i\\phi}$ to the marked state. Its action is defined as:\n$$\nU_w(\\phi) |x\\rangle = \\begin{cases} e^{i\\phi} |x\\rangle & \\text{if } x=w \\\\ |x\\rangle & \\text{if } x\\neq w \\end{cases}\n$$\nThis faulty oracle can be written as the operator $U_w(\\phi) = I + (e^{i\\phi}-1)|w\\rangle\\langle w|$.\n\nThe state of the system after one iteration of this modified Grover algorithm is $|\\psi_1\\rangle = U_s U_w(\\phi) |\\psi_0\\rangle$.\n\nYour task is to calculate the probability of measuring the marked state $|w\\rangle$ after this single iteration, $P(w) = |\\langle w | \\psi_1 \\rangle|^2$. Provide the exact analytical expression for the specific case where the search space has size $N=8$ and the faulty oracle phase is $\\phi = 3\\pi/4$.", "solution": "We work in the two-dimensional subspace spanned by the marked state $|w\\rangle$ and the equal superposition of the others\n$$|\\alpha\\rangle=\\frac1{\\sqrt{N-1}}\\sum_{x\\neq w}|x\\rangle.$$ \nDefine \n$$s=\\frac1{\\sqrt N},\\qquad c=\\sqrt{\\frac{N-1}{N}},\\qquad|\\psi_0\\rangle=s|w\\rangle+c|\\alpha\\rangle.$$\nThe faulty oracle gives\n$$|\\psi'\\rangle=U_w(\\phi)|\\psi_0\\rangle\n=s\\,e^{i\\phi}|w\\rangle+c|\\alpha\\rangle\n\\equiv a|w\\rangle+b|\\alpha\\rangle.$$\nThe diffusion operator $U_s=2|\\psi_0\\rangle\\langle\\psi_0|-I$ yields\n$$|\\psi_1\\rangle\n=U_s|\\psi'\\rangle\n=2\\langle\\psi_0|\\psi'\\rangle\\,|\\psi_0\\rangle-|\\psi'\\rangle,\n\\qquad\\langle\\psi_0|\\psi'\\rangle\n=s^2e^{i\\phi}+c^2.$$\nProjecting onto $|w\\rangle$ gives\n\n$$\na_1=\\langle w|\\psi_1\\rangle\n=2s\\bigl(s^2e^{i\\phi}+c^2\\bigr)-s\\,e^{i\\phi}\n=s\\bigl((2s^2-1)e^{i\\phi}+2c^2\\bigr).\n$$\n\nSince $s^2=1/N$ and $c^2=(N-1)/N$ this becomes\n\n$$\na_1=\\frac1{N\\sqrt N}\\Bigl((2-N)e^{i\\phi}+2(N-1)\\Bigr).\n$$\n\nHence the success probability is $P(w)=|a_1|^2$. For $N=8$ and $\\phi=3\\pi/4$, we can substitute these values into the expression for $a_1$:\n$$\na_1 = \\frac{1}{8\\sqrt{8}} \\Bigl((2-8)e^{i3\\pi/4} + 2(8-1)\\Bigr) = \\frac{1}{16\\sqrt{2}} \\Bigl(-6e^{i3\\pi/4} + 14\\Bigr)\n$$\nUsing $e^{i3\\pi/4} = \\cos(3\\pi/4) + i\\sin(3\\pi/4) = -1/\\sqrt{2} + i/\\sqrt{2}$, we get:\n$$\na_1 = \\frac{1}{16\\sqrt{2}} \\Bigl(-6(-1/\\sqrt{2} + i/\\sqrt{2}) + 14\\Bigr) = \\frac{1}{16\\sqrt{2}} \\Bigl(14 + \\frac{6}{\\sqrt{2}} - i\\frac{6}{\\sqrt{2}}\\Bigr) = \\frac{1}{16\\sqrt{2}} (14 + 3\\sqrt{2} - i3\\sqrt{2})\n$$\nNow, we calculate the probability:\n$$\nP(w) = |a_1|^2 = \\frac{1}{(16\\sqrt{2})^2} \\left( (14+3\\sqrt{2})^2 + (-3\\sqrt{2})^2 \\right)\n$$\n$$\nP(w) = \\frac{1}{512} \\left( (196 + 84\\sqrt{2} + 18) + 18 \\right) = \\frac{232 + 84\\sqrt{2}}{512}\n$$\nSimplifying the fraction gives:\n$$\nP(w) = \\frac{58 + 21\\sqrt{2}}{128}\n$$", "answer": "$$\\boxed{\\frac{58+21\\sqrt2}{128}}$$", "id": "45186"}, {"introduction": "A critical challenge in applying amplitude amplification is that the optimal number of iterations depends on the initial success probability, which is often unknown. This advanced exercise [@problem_id:45157] places you in the role of an algorithm designer tasked with overcoming this uncertainty. You will analyze a widely used strategy involving successive search phases of exponentially increasing length and, through a process of optimization, derive a fundamental result for the most efficient design of a robust quantum search.", "problem": "A quantum search algorithm is designed to find a marked state $|w\\rangle$ from an initial state $|\\psi\\rangle$ prepared by a circuit $\\mathcal{A}$ such that $|\\psi\\rangle = \\mathcal{A}|0\\rangle$. The initial success probability is $a = |\\langle w | \\psi \\rangle|^2$, and it is assumed to be unknown but non-zero. For a small known success probability $a$, the standard amplitude amplification (Grover's) algorithm achieves a high success rate using a number of oracle queries $k_{opt} \\approx \\frac{\\pi}{4\\sqrt{a}}$.\n\nWhen $a$ is unknown, a common strategy is to perform the search in phases. In this particular algorithm, phase $j$ (for $j=0, 1, 2, \\dots$) consists of applying the Grover operator $k_j$ times, followed by a measurement. The number of applications in phase $j$ is set according to the rule $k_j = \\lambda^j$, where $\\lambda > 1$ is a fixed real-valued expansion factor. If a measurement fails to find the marked state, the algorithm proceeds to the next phase.\n\nWe want to choose the expansion factor $\\lambda$ to be as efficient as possible. An efficiency metric is the *worst-case query overhead* $\\mathcal{O}$, which is the ratio of the total queries used by the algorithm to the queries that would have been needed if $a$ were known ($k_{opt}$). The worst case for a given $\\lambda$ occurs when the optimal number of queries $k_{opt}$ is infinitesimally larger than the number of queries in one of the phases, say $k_J = \\lambda^J$. This means the algorithm completes phase $J$ and fails (as $k_J < k_{opt}$), forcing it to execute the much more expensive phase $J+1$.\n\nTo analyze this, we model the worst case by setting the optimal number of queries to be exactly $k_{opt} = \\lambda^J$ for some large integer $J$. In this scenario, the algorithm fails in all phases up to and including phase $J$, and we analyze the cost up to the completion of phase $J+1$. The total number of queries expended is $C_{J+1} = \\sum_{j=0}^{J+1} k_j$. The worst-case overhead is then defined as the ratio $\\mathcal{O} = C_{J+1} / k_{opt}$.\n\nAssuming the limit of very small success probability $a \\to 0$ (which corresponds to $k_{opt} \\to \\infty$ and thus $J \\to \\infty$), derive the value of the expansion factor $\\lambda$ that minimizes this worst-case query overhead $\\mathcal{O}$.", "solution": "Step 1: Expression for total queries $C_{J+1}$  \nThe total number of oracle queries after phases $0$ through $J+1$ is  \n$$\nC_{J+1}=\\sum_{j=0}^{J+1}k_j = \\sum_{j=0}^{J+1}\\lambda^j\n= \\frac{\\lambda^{J+2}-1}{\\lambda - 1}.\n$$\n\nStep 2: Worst-case overhead $\\mathcal{O}$  \nWith $k_{\\rm opt}=\\lambda^J$, the overhead is  \n$$\n\\mathcal{O}\n= \\frac{C_{J+1}}{k_{\\rm opt}}\n= \\frac{\\frac{\\lambda^{J+2}-1}{\\lambda - 1}}{\\lambda^J}\n= \\frac{\\lambda^2-\\lambda^{-J}}{\\lambda-1}.\n$$  \nTaking $J\\to\\infty$ gives  \n$$\n\\mathcal{O}(\\lambda)=\\frac{\\lambda^2}{\\lambda-1}.\n$$\n\nStep 3: Minimizing $\\mathcal{O}(\\lambda)$  \nCompute the derivative:  \n$$\n\\frac{d\\mathcal{O}}{d\\lambda}\n= \\frac{d}{d\\lambda}\\Bigl(\\frac{\\lambda^2}{\\lambda-1}\\Bigr)\n= \\frac{2\\lambda(\\lambda-1)-\\lambda^2}{(\\lambda-1)^2}\n= \\frac{\\lambda(\\lambda-2)}{(\\lambda-1)^2}.\n$$  \nSetting $\\frac{d\\mathcal{O}}{d\\lambda}=0$ yields $\\lambda=0$ or $\\lambda=2$.  \nSince $\\lambda>1$, the minimum is at  \n$$\n\\lambda=2.\n$$", "answer": "$$\\boxed{2}$$", "id": "45157"}]}