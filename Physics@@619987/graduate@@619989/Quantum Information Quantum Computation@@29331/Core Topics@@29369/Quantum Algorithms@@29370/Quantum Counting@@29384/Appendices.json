{"hands_on_practices": [{"introduction": "The standard Quantum Counting Algorithm (QCA) provides a powerful method for estimating the number of solutions $M$ in an $N$-dimensional search space. This exercise explores a common and practical variation where the solutions are known to exist only within a specific, smaller subspace of dimension $D$. By adapting the algorithm to focus its search on this relevant subspace, we can gain significant efficiencies and clarify which parameters truly govern the algorithm's dynamics [@problem_id:115905].", "problem": "The Quantum Counting Algorithm (QCA) is designed to determine the number of marked items, $M$, within a search space of size $N$. It achieves this by performing Quantum Phase Estimation (QPE) on the Grover search operator, $G$. The standard QCA assumes the search is conducted over the entire computational basis of a Hilbert space $\\mathcal{H}$ of dimension $N$, starting from a uniform superposition over all basis states.\n\nConsider a modified scenario. We are given a Hilbert space $\\mathcal{H}$ of total dimension $N$. Within this space, there is a specific subspace $\\mathcal{S} \\subset \\mathcal{H}$ of dimension $D < N$, which is spanned by a known orthonormal basis $\\{|s_j\\rangle\\}_{j=1}^D$. We are promised that all $M$ marked states, which we denote by the set $W$, are contained entirely within this subspace, i.e., $W \\subset \\{|s_j\\rangle\\}_{j=1}^D$.\n\nThe quantum search algorithm is adapted to this scenario. The initial state is prepared as a uniform superposition over the basis states of the known subspace $\\mathcal{S}$:\n$$\n|\\psi_{\\mathcal{S}}\\rangle = \\frac{1}{\\sqrt{D}} \\sum_{j=1}^{D} |s_j\\rangle\n$$\nThe Grover operator, $G$, is constructed using this specific initial state. The oracle, $S_w$, acts as usual, flipping the sign of any marked state: $S_w|x\\rangle = -|x\\rangle$ if $|x\\rangle \\in W$ and $S_w|x\\rangle = |x\\rangle$ otherwise. The diffusion operator, $S_{\\psi_{\\mathcal{S}}}$, reflects states about the initial state $|\\psi_{\\mathcal{S}}\\rangle$: $S_{\\psi_{\\mathcal{S}}} = I - 2|\\psi_{\\mathcal{S}}\\rangle\\langle\\psi_{\\mathcal{S}}|$. The full Grover operator is then $G = -S_{\\psi_{\\mathcal{S}}} S_w$.\n\nThe QCA applies QPE to the unitary operator $G$ using $|\\psi_{\\mathcal{S}}\\rangle$ as the input state. The algorithm provides an estimate for an eigenphase of $G$. The action of $G$ is confined to a two-dimensional subspace determined by the marked and unmarked states within $\\mathcal{S}$. Find the exact value of the positive eigenphase, $\\phi$, of the Grover operator $G$ that the algorithm seeks to estimate. Express your answer as a closed-form expression in terms of the subspace dimension $D$ and the number of marked states $M$.", "solution": "1. Define the marked- and unmarked-state superpositions within $\\mathcal{S}$:\n$$\n|\\beta\\rangle = \\frac{1}{\\sqrt{M}}\\sum_{|s_j\\rangle\\in W}|s_j\\rangle,\n\\qquad\n|\\alpha\\rangle = \\frac{1}{\\sqrt{D-M}}\\sum_{|s_j\\rangle\\notin W}|s_j\\rangle.\n$$\n2. Rewrite the initial state:\n$$\n|\\psi_{\\mathcal{S}}\\rangle\n=\\frac{1}{\\sqrt{D}}\\sum_{j=1}^D|s_j\\rangle\n=\\sqrt{\\frac{D-M}{D}}\\,|\\alpha\\rangle+\\sqrt{\\frac{M}{D}}\\,|\\beta\\rangle.\n$$\nSet\n$$\n\\cos\\theta=\\sqrt{\\frac{D-M}{D}}, \n\\quad\n\\sin\\theta=\\sqrt{\\frac{M}{D}}, \n\\quad\n\\theta=\\arcsin\\!\\Bigl(\\sqrt{\\tfrac{M}{D}}\\Bigr).\n$$\n3. The oracle reflection and diffusion operators act as reflections in the $\\{|\\alpha\\rangle,|\\beta\\rangle\\}$ subspace:\n$$\nS_w:\\;|\\beta\\rangle\\to-|\\beta\\rangle,\\;|\\alpha\\rangle\\to|\\alpha\\rangle,\n\\quad\nS_{\\psi_{\\mathcal{S}}}:\\;|\\psi_{\\mathcal{S}}\\rangle\\to-|\\psi_{\\mathcal{S}}\\rangle.\n$$\n4. The Grover iterate\n$$\nG=-S_{\\psi_{\\mathcal{S}}}S_w\n$$\nrestricts to a rotation by $2\\theta$ in the $\\{|\\alpha\\rangle,|\\beta\\rangle\\}$ plane. Its eigenvalues are $e^{\\pm i2\\theta}$, so the positive eigenphase is\n$$\n\\phi=2\\theta=2\\arcsin\\!\\Bigl(\\sqrt{\\frac{M}{D}}\\Bigr).\n$$", "answer": "$$\\boxed{2\\arcsin\\!\\Bigl(\\sqrt{\\frac{M}{D}}\\Bigr)}$$", "id": "115905"}, {"introduction": "While theoretical models of quantum algorithms often assume ideal hardware, real-world implementations are always a battle against noise and resource limitations. This practice problem models a critical trade-off in designing a quantum counting experiment: choosing the number of counting qubits $t$. A larger $t$ improves the theoretical precision but also increases the circuit depth, making it more susceptible to decoherence. By optimizing for the minimal total error, you will develop a quantitative understanding of how to balance algorithmic design against physical constraints [@problem_id:115894].", "problem": "The Quantum Counting algorithm is a cornerstone of quantum computation, designed to estimate the number of solutions, $M$, within a search space of size $N=2^n$. The algorithm achieves this by applying Quantum Phase Estimation (QPE) to the Grover operator, $G$. The relevant eigenvalues of $G$ are $e^{\\pm i \\theta}$, where the phase $\\theta$ is related to the number of solutions by $M/N = \\sin^2(\\theta/2)$. QPE uses $t$ auxiliary \"counting\" qubits to produce an estimate of $\\theta$.\n\nIn any realistic implementation, the accuracy of the estimated phase $\\hat{\\theta}$ is limited by two competing sources of error, which depend on the choice of $t$:\n\n1.  **Discretization Error:** The QPE algorithm fundamentally discretizes the continuous phase spectrum. The precision of this discretization is determined by the maximum effective evolution time, which is proportional to $2^t$ due to the use of controlled operators up to $G^{2^{t-1}}$. Based on the principles of quantum metrology, the variance of the phase estimator $\\hat{\\theta}$ from this \"Heisenberg-limited\" discretization scales inversely with the square of the evolution time. This contribution to the variance is given by:\n    $$ \\text{Var}_{\\text{disc}}(\\hat{\\theta}) = \\frac{\\alpha}{4^t} $$\n    where $\\alpha$ is a positive constant determined by the specifics of the QPE circuit and the true phase $\\theta$.\n\n2.  **Decoherence Error:** The quantum circuit for counting is subject to noise. We model this with a per-gate amplitude damping channel. The total depth of the circuit is dominated by the highest-power Grover operator and is therefore proportional to $2^t$. The cumulative effect of the damping channel throughout the computation is a diffusion of the phase information, which introduces an additional, independent source of variance. A well-motivated model for this decoherence-induced variance is that it grows linearly with the circuit depth. This contribution is given by:\n    $$ \\text{Var}_{\\text{deco}}(\\hat{\\theta}) = \\beta \\cdot 2^t $$\n    where $\\beta$ is a positive constant representing the strength of the decoherence process.\n\nAssuming a Bayesian estimation framework with a non-informative prior for the phase $\\theta$, the posterior distribution for $\\theta$ is well-approximated by a Gaussian. Its variance is the sum of the variances from these two independent error sources, $\\text{Var}_{\\text{total}} = \\text{Var}_{\\text{disc}} + \\text{Var}_{\\text{deco}}$.\n\nYour task is to find the optimal number of counting qubits, $t_{\\text{opt}}$, that minimizes this total posterior variance. For the purpose of optimization, treat $t$ as a continuous, positive real variable. Derive the expression for $t_{\\text{opt}}$ in terms of the constants $\\alpha$ and $\\beta$.", "solution": "We wish to minimize \n$$\n\\text{Var}_{\\text{total}}(t)=\\alpha\\,4^{-t}+\\beta\\,2^{t}\n$$\nwith respect to the continuous variable $t>0$. \n\n1. Compute the derivative:\n$$\n\\frac{d}{dt}\\text{Var}_{\\text{total}}\n=\\alpha\\frac{d}{dt}2^{-2t}+\\beta\\frac{d}{dt}2^{t}\n=\\alpha(-2\\ln2)\\,2^{-2t}+\\beta(\\ln2)\\,2^{t}\\,.\n$$\n\n2. Set the derivative to zero for an extremum:\n$$\n-2\\alpha\\ln2\\,2^{-2t}+\\beta\\ln2\\,2^{t}=0\n\\quad\\Longrightarrow\\quad\n\\beta\\,2^{t}=2\\alpha\\,2^{-2t}\\,.\n$$\n\n3. Solve for $t$:\n$$\n\\beta\\,2^{3t}=2\\alpha\n\\quad\\Longrightarrow\\quad\n2^{3t}=\\frac{2\\alpha}{\\beta}\n\\quad\\Longrightarrow\\quad\n3t\\ln2=\\ln\\!\\bigl(2\\alpha/\\beta\\bigr)\n\\quad\\Longrightarrow\\quad\nt=\\frac{1}{3}\\,\\frac{\\ln\\!\\bigl(2\\alpha/\\beta\\bigr)}{\\ln2}\n=\\frac{1}{3}\\log_{2}\\!\\frac{2\\alpha}{\\beta}\\,.\n$$\n\nOne checks the second derivative is positive at this point, confirming a minimum.", "answer": "$$\\boxed{\\frac{1}{3}\\log_{2}\\!\\frac{2\\alpha}{\\beta}}$$", "id": "115894"}, {"introduction": "The output of the Quantum Counting Algorithm is a measurement outcome that provides an estimate of the number of solutions, $M$. However, a single measurement is just one piece of evidence. This problem reframes quantum counting as a tool for statistical inference, asking you to apply Bayes' theorem to update your belief about $M$ after a measurement. This exercise demonstrates how to move from a raw quantum outcome to a formal posterior probability distribution, a crucial step in the scientific interpretation of quantum experimental data [@problem_id:115909].", "problem": "The quantum counting algorithm is a method to determine the number of solutions, $M$, to a search problem within a database of size $N=2^n$. It combines the Grover search algorithm with the quantum phase estimation (QPE) algorithm.\n\nThe core idea is to apply QPE to the Grover iteration operator, $G$. For $0 < M < N$, the operator $G$ has two relevant eigenvalues, $e^{i 2\\theta_M}$ and $e^{-i 2\\theta_M}$, where the angle $\\theta_M$ is related to the number of solutions by $\\sin^2(\\theta_M) = M/N$. The initial state of the search register, the uniform superposition $|s\\rangle$, is an equal superposition of the two corresponding eigenvectors.\n\nQPE uses a $t$-qubit counting register to estimate the phase of an eigenvector. When applied to $|s\\rangle$, the algorithm produces an estimate for one of the two phases $\\phi_M = \\theta_M/\\pi$ or $1-\\phi_M$. After running the QPE circuit and performing an inverse Quantum Fourier Transform on the counting register, a measurement yields an integer $y \\in \\{0, 1, \\dots, 2^t-1\\}$. The probability of obtaining the outcome $y$ given $M$ solutions is denoted $P(y|M)$.\n\nFor the two special cases:\n1.  If $M=0$, the initial state $|s\\rangle$ is an eigenstate of $G$ with eigenvalue $-1$. The phase is $\\pi$, so $\\phi_0=1/2$, and QPE will ideally measure $y=2^{t-1}$ with certainty.\n2.  If $M=N$, the initial state $|s\\rangle$ is an eigenstate of $G$ with eigenvalue $1$. The phase is $0$, so $\\phi_N=0$, and QPE will ideally measure $y=0$ with certainty.\n\nFor $0 < M < N$, the probability distribution for the measurement $y$ reflects the superposition of the two phases. The probability is given by:\n$$\nP(y|M) = \\frac{1}{2} \\left( P(y|\\phi_M) + P(y|1-\\phi_M) \\right)\n$$\nwhere $P(y|\\phi)$ is the probability of measuring $y$ for a true phase $\\phi$, given by:\n$$\nP(y|\\phi) = \\frac{\\sin^2\\left(\\pi\\left(2^t\\phi - y\\right)\\right)}{2^{2t}\\sin^2\\left(\\pi\\left(\\phi - \\frac{y}{2^t}\\right)\\right)}\n$$\n\n**Problem:**\nConsider a quantum counting experiment on a search space of size $N$, using a counting register with $t=1$ qubit. The experiment is performed, and the counting qubit is measured in the state $|0\\rangle$, so the measurement outcome is $y=0$.\n\nAssuming a uniform prior probability distribution for the number of marked items, $P(M) = \\text{const}$ for $M \\in \\{0, 1, \\dots, N\\}$, calculate the posterior probability $P(M=M_0|y=0)$ for a specific number of solutions $M_0$ such that $0 < M_0 < N$. Express your answer as a symbolic expression in terms of $N$ and $M_0$.", "solution": "We want to compute the posterior probability $P(M=M_0|y=0)$ using Bayes' theorem. With a uniform prior $P(M=k) = 1/(N+1)$ for $k \\in \\{0, 1, \\dots, N\\}$, the theorem simplifies to:\n$$\nP(M=M_0|y=0) = \\frac{P(y=0|M=M_0)P(M=M_0)}{\\sum_{k=0}^{N} P(y=0|M=k)P(M=k)} = \\frac{P(y=0|M_0)}{\\sum_{k=0}^{N} P(y=0|k)}\n$$\nOur main task is to evaluate the likelihoods $P(y=0|M=k)$ for all possible values of $k$ and then compute the sum.\n\n**Step 1: Evaluate $P(y=0|M=k)$ for the special cases $k=0$ and $k=N$.**\n\nFor $M=k=0$, the true phase is $\\phi_0=1/2$. The QPE with $t=1$ is supposed to yield $y=2^{t-1} = 2^{1-1} = 1$. Thus, the probability of measuring $y=0$ is zero.\n$$\nP(y=0|M=0) = 0\n$$\n\nFor $M=k=N$, the true phase is $\\phi_N=0$. The QPE is supposed to yield $y=2^t \\phi_N = 0$. Thus, the probability of measuring $y=0$ is one.\n$$\nP(y=0|M=N) = 1\n$$\n\n**Step 2: Evaluate $P(y=0|M=k)$ for $0 < k < N$.**\n\nFor these cases, we use the provided formula for $P(y|M)$. With $t=1$ and $y=0$, the probability $P(y=0|\\phi)$ becomes:\n$$\nP(y=0|\\phi) = \\frac{\\sin^2(2\\pi\\phi)}{4\\sin^2(\\pi\\phi)}\n$$\nUsing the double-angle identity $\\sin(2x) = 2\\sin(x)\\cos(x)$, we can simplify this expression:\n$$\nP(y=0|\\phi) = \\frac{(2\\sin(\\pi\\phi)\\cos(\\pi\\phi))^2}{4\\sin^2(\\pi\\phi)} = \\frac{4\\sin^2(\\pi\\phi)\\cos^2(\\pi\\phi)}{4\\sin^2(\\pi\\phi)} = \\cos^2(\\pi\\phi)\n$$\nThe phase $\\phi_k$ is related to $k$ by $\\phi_k = \\theta_k/\\pi = \\frac{1}{\\pi}\\arcsin(\\sqrt{k/N})$. So, $\\pi\\phi_k = \\arcsin(\\sqrt{k/N})$.\n$$\nP(y=0|\\phi_k) = \\cos^2(\\arcsin(\\sqrt{k/N}))\n$$\nUsing the identity $\\cos(\\arcsin(z)) = \\sqrt{1-z^2}$, we get:\n$$\nP(y=0|\\phi_k) = \\left(\\sqrt{1 - (\\sqrt{k/N})^2}\\right)^2 = 1 - k/N\n$$\nNow we compute $P(y=0|1-\\phi_k)$:\n$$\nP(y=0|1-\\phi_k) = \\cos^2(\\pi(1-\\phi_k)) = \\cos^2(\\pi - \\pi\\phi_k) = (-\\cos(\\pi\\phi_k))^2 = \\cos^2(\\pi\\phi_k) = 1-k/N\n$$\nFinally, for $0 < k < N$:\n$$\nP(y=0|M=k) = \\frac{1}{2} \\left( P(y=0|\\phi_k) + P(y=0|1-\\phi_k) \\right) = \\frac{1}{2} \\left( (1-k/N) + (1-k/N) \\right) = 1 - k/N\n$$\n\n**Step 3: Compute the normalization sum.**\n\nThe sum in the denominator of Bayes' theorem is:\n$$\nS = \\sum_{k=0}^{N} P(y=0|k) = P(y=0|0) + \\left( \\sum_{k=1}^{N-1} P(y=0|k) \\right) + P(y=0|N)\n$$\nSubstituting the expressions we found:\n$$\nS = 0 + \\sum_{k=1}^{N-1} (1-k/N) + 1\n$$\n$$\nS = 1 + \\sum_{k=1}^{N-1} 1 - \\frac{1}{N}\\sum_{k=1}^{N-1} k\n$$\nThe sums are standard: $\\sum_{k=1}^{N-1} 1 = N-1$ and $\\sum_{k=1}^{N-1} k = \\frac{(N-1)N}{2}$.\n$$\nS = 1 + (N-1) - \\frac{1}{N} \\left(\\frac{(N-1)N}{2}\\right) = N - \\frac{N-1}{2} = \\frac{2N - (N-1)}{2} = \\frac{N+1}{2}\n$$\n\n**Step 4: Calculate the final posterior probability.**\n\nWe are interested in $P(M=M_0|y=0)$ for a value $M_0$ where $0 < M_0 < N$. The likelihood term in the numerator is $P(y=0|M=M_0) = 1 - M_0/N$.\n$$\nP(M=M_0|y=0) = \\frac{P(y=0|M_0)}{S} = \\frac{1 - M_0/N}{(N+1)/2}\n$$\nSimplifying the expression:\n$$\nP(M=M_0|y=0) = \\frac{(N-M_0)/N}{(N+1)/2} = \\frac{2(N-M_0)}{N(N+1)}\n$$\nThis is the final expression for the posterior probability.", "answer": "$$\n\\boxed{\\frac{2(N-M_0)}{N(N+1)}}\n$$", "id": "115909"}]}