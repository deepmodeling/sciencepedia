{"hands_on_practices": [{"introduction": "To grasp why the order-finding algorithm works, it is essential to understand the final measurement stage. This exercise [@problem_id:160729] bridges theory and practice by having you calculate the probability of a specific measurement outcome. By working through this example, you will see how the inverse Quantum Fourier Transform concentrates the probability amplitude onto integer values that directly reveal the order, $r$.", "problem": "The quantum order-finding algorithm is a key component of Shor's algorithm for factoring integers. It is designed to find the smallest positive integer $r$, called the order, such that $x^r \\equiv 1 \\pmod{N}$ for given coprime integers $x$ and $N$.\n\nThe algorithm uses two quantum registers: a control register with $Q=2^n$ states (for some integer $n$) and a target register. After a series of operations involving controlled modular exponentiation, a measurement on the target register projects the control register into a periodic superposition of computational basis states. For simplicity, we will consider the case where this post-measurement state is given by:\n$$\n|\\psi\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} |mr\\rangle\n$$\nHere, $r$ is the order, and the sum is over all non-negative integers $m$ such that $mr < Q$. The normalization factor is $1/\\sqrt{M}$, where $M$ is the total number of terms in the superposition.\n\nThe final step of the algorithm is to apply the inverse Quantum Fourier Transform (QFT) to the state $|\\psi\\rangle$ and measure the control register. The action of the inverse QFT on a basis state $|j\\rangle$ is defined as:\n$$\n\\text{QFT}^\\dagger |j\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{k=0}^{Q-1} e^{-2\\pi i jk/Q} |k\\rangle\n$$\n\nConsider the specific problem of finding the order of $x=10$ modulo $N=21$. The order for this case is $r=6$. Let the size of the control register be $Q=256$. Assuming the state of the control register before the QFT is exactly the state $|\\psi\\rangle$ described above, calculate the probability of measuring the outcome $k=128$ in the control register.", "solution": "The state before the inverse QFT is given by:\n\n$$\n|\\psi\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} |m r\\rangle\n$$\n\nwhere $r = 6$ is the order, $Q = 256$ is the size of the control register, and $M$ is the number of terms satisfying $m r < Q$. The values of $m$ range from 0 to the maximum integer such that $m r < Q$. Since $r = 6$ and $Q = 256$:\n\n$$\nm_{\\text{max}} = \\left\\lfloor \\frac{Q - 1}{r} \\right\\rfloor = \\left\\lfloor \\frac{255}{6} \\right\\rfloor = 42\n$$\n\nThus, $m = 0, 1, 2, \\ldots, 42$, which gives $M = 43$.\n\nThe inverse QFT acts on a basis state $|j\\rangle$ as:\n\n$$\n\\text{QFT}^\\dagger |j\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{k=0}^{Q-1} e^{-2\\pi i j k / Q} |k\\rangle\n$$\n\nApplying the inverse QFT to $|\\psi\\rangle$:\n\n$$\n\\text{QFT}^\\dagger |\\psi\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} \\text{QFT}^\\dagger |m r\\rangle = \\frac{1}{\\sqrt{M}} \\sum_{m=0}^{M-1} \\left( \\frac{1}{\\sqrt{Q}} \\sum_{k=0}^{Q-1} e^{-2\\pi i (m r) k / Q} |k\\rangle \\right)\n$$\n\nThe amplitude for state $|k\\rangle$ is:\n\n$$\n\\alpha_k = \\frac{1}{\\sqrt{M Q}} \\sum_{m=0}^{M-1} e^{-2\\pi i m r k / Q}\n$$\n\nThe probability of measuring outcome $k$ is $|\\alpha_k|^2$. For $k = 128$:\n\n$$\n\\alpha_{128} = \\frac{1}{\\sqrt{M Q}} \\sum_{m=0}^{M-1} e^{-2\\pi i m \\cdot 6 \\cdot 128 / 256}\n$$\n\nSimplify the exponent:\n\n$$\n\\frac{6 \\cdot 128}{256} = \\frac{768}{256} = 3\n$$\n\nThus:\n\n$$\ne^{-2\\pi i m \\cdot 3} = e^{-6\\pi i m} = (e^{-2\\pi i})^{3m} = 1^{3m} = 1\n$$\n\nsince $e^{-2\\pi i} = 1$. The sum becomes:\n\n$$\n\\sum_{m=0}^{M-1} 1 = M\n$$\n\nSo the amplitude is:\n\n$$\n\\alpha_{128} = \\frac{1}{\\sqrt{M Q}} \\cdot M = \\sqrt{\\frac{M}{Q}}\n$$\n\nThe probability is:\n\n$$\n|\\alpha_{128}|^2 = \\left( \\sqrt{\\frac{M}{Q}} \\right)^2 = \\frac{M}{Q}\n$$\n\nSubstituting $M = 43$ and $Q = 256$:\n\n$$\n\\frac{43}{256}\n$$", "answer": "$$ \\boxed{\\dfrac{43}{256}} $$", "id": "160729"}, {"introduction": "While ideal quantum algorithms perform flawlessly, real-world hardware is susceptible to noise. This problem [@problem_id:160805] explores the impact of a single-bit flip error during measurement, a common type of decoherence. You will trace how this seemingly small physical error propagates through the classical post-processing to yield an incorrect result, underscoring the critical need for fault-tolerant quantum computation.", "problem": "The classical part of Shor's order-finding algorithm relies on finding a good rational approximation of the fraction $\\frac{k}{Q}$, where $k$ is the integer obtained from measuring the first register of a quantum computer, and $Q=2^t$ is the dimension of the register's Hilbert space, with $t$ being the number of qubits. The measurement outcome $k$ is expected to be an integer close to one of the fractions $\\frac{sQ}{r}$ for an integer $s \\in \\{0, 1, \\dots, r-1\\}$, where $r$ is the order we wish to find.\n\nThe continued fraction algorithm is used to find a sequence of successively better rational approximations (convergents) to $\\frac{k}{Q}$. The denominators of these convergents provide a list of candidates for the order $r$.\n\nConsider an instance of the order-finding algorithm with the following parameters:\n- The true order to be found is $r$.\n- The size of the computational basis for the first register is $Q = 2^t$.\n- The ideal measurement is associated with the integer $s=1$.\n\nIn an ideal, error-free execution, the measurement outcome would be $k_{ideal} = \\lfloor \\frac{sQ}{r} \\rfloor$. However, a single-bit error occurs during the measurement process. Specifically, the most significant bit (MSB) of the $t$-bit binary representation of $k_{ideal}$ is flipped. Let the resulting erroneous measurement be $k_{err}$.\n\nThe standard classical procedure is then applied to the erroneous fraction $\\frac{k_{err}}{Q}$. The algorithm generates the denominators of the convergents as candidates for the order. These candidates are tested sequentially. Given that the true order is $r$, a candidate $r'_{cand}$ is considered successful if $x^{r'_{cand}} \\equiv 1 \\pmod N$, which is guaranteed if $r'_{cand}$ is a multiple of $r$.\n\nGiven the true order $r=17$ and a $t=10$ qubit register ($Q=2^{10}$), calculate the first candidate order $r'$ that would be successfully identified by the classical post-processing when applied to the erroneous measurement $k_{err}$.", "solution": "1. The ideal measurement outcome is \n$$k_{\\rm ideal} = \\Big\\lfloor \\frac{s\\,Q}{r}\\Big\\rfloor,\\quad s=1,\\;Q=2^t=2^{10},\\;r=17,$$\nso \n$$k_{\\rm ideal} = \\Big\\lfloor \\frac{2^{10}}{17}\\Big\\rfloor.$$\n\n2. In binary (10 bits) $k_{\\rm ideal} = \\lfloor2^{10}/17\\rfloor =60_{10}=0000111100_2$. Flipping the MSB (bit 9) adds $2^9$, so\n$$k_{\\rm err} = 2^9 + \\Big\\lfloor\\frac{2^{10}}{17}\\Big\\rfloor =512 +60 =572,$$\nand\n$$\\frac{k_{\\rm err}}{Q} = \\frac{572}{1024} = \\frac{143}{256}.$$\n\n3. Compute the continuedâ€fraction of $\\tfrac{143}{256}$. One finds\n$$\\frac{143}{256}=[0;1,1,3,1,3,3,2],$$\nwith convergent denominators\n$$q_1=1,\\;q_2=2,\\;q_3=7,\\;q_4=9,\\;q_5=34,\\;q_6=111,\\;q_7=256.$$\n\n4. The true order is $r=17$. The first denominator $q_i$ that is a multiple of $17$ is \n$$q_5 = 34 = 2\\cdot17.$$\nHence the first successful candidate is $r'=34\\,. $", "answer": "$$\\boxed{34}$$", "id": "160805"}, {"introduction": "A single run of the order-finding algorithm does not always reveal the full order, $r$; sometimes it yields only a factor of $r$. This hands-on problem [@problem_id:160640] demonstrates a crucial real-world strategy for overcoming this common occurrence. By learning to combine the partial information from two 'failed' runs, you will see how to reconstruct the true order using the least common multiple, a powerful technique in classical post-processing.", "problem": "The quantum order-finding algorithm is a key component of Shor's algorithm for integer factorization. Its goal is to find the order $r$ of an integer $a$ modulo $M$, which is the smallest positive integer such that $a^r \\equiv 1 \\pmod{M}$.\n\nThe algorithm utilizes a quantum computer to prepare a specific state, and a measurement on a control register yields an integer outcome $k$. This outcome is used in a classical post-processing step. With high probability, the ratio $k/N$, where $N$ is the size of the control register's Hilbert space, is a good approximation of a rational number $j/r$ for some integer $j$ between $0$ and $r-1$. The continued fraction algorithm is then used to efficiently extract the fraction $j/s$ from the estimate $k/N$.\n\nIf the integer $j$ (which is randomly determined by the quantum state) is coprime to the true order $r$ (i.e., $\\gcd(j, r) = 1$), the denominator $s$ found by the continued fraction algorithm will be the true order $r$. However, if $\\gcd(j, r) = d > 1$, the fraction $j/r$ is not in lowest terms. The continued fraction algorithm will instead find the reduced fraction $j'/s'$, where $j/r = j'/s'$. The resulting denominator, $s'$, will be a factor of the true order, specifically $s' = r/d$.\n\nAn experimentalist is attempting to find the order $r$ of an element $a$ modulo $M$. They perform two independent runs of the quantum order-finding algorithm.\n1. The first run yields a candidate order $s_1$. Testing this classically, they find that $a^{s_1} \\not\\equiv 1 \\pmod{M}$.\n2. The second run yields a different candidate order $s_2$. They also find that $a^{s_2} \\not\\equiv 1 \\pmod{M}$.\n\nThe experimentalist concludes that both runs correspond to the failure mode described above, meaning that both $s_1$ and $s_2$ are proper divisors of the true order $r$. Given the two observed sub-orders $s_1 = 90$ and $s_2 = 105$, determine the most likely value for the true order $r$. Assume that $r$ is the smallest integer that is consistent with both measurement outcomes.", "solution": "We are given two observed sub-orders $s_1=90$ and $s_2=105$ which both properly divide the true order $r$. The smallest $r$ consistent with these observations must satisfy\n\n$$\ns_1\\mid r,\\quad s_2\\mid r,\n$$\n\nand be minimal.  Hence\n\n$$\nr=\\mathrm{lcm}(s_1,s_2).\n$$\n\nCompute the prime factorizations:\n\n$$\n90 = 2\\cdot 3^2\\cdot 5,\\qquad\n105 = 3\\cdot 5\\cdot 7.\n$$\n\nThe least common multiple takes the highest power of each prime:\n\n$$\n\\mathrm{lcm}(90,105)\n=2^1\\cdot3^2\\cdot5^1\\cdot7^1\n=2\\cdot9\\cdot5\\cdot7\n=630.\n$$\n\nThus the smallest possible true order is $r=630$.", "answer": "$$\\boxed{630}$$", "id": "160640"}]}