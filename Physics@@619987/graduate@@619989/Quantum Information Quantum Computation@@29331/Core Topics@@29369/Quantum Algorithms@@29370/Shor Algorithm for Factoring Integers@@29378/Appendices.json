{"hands_on_practices": [{"introduction": "Shor's algorithm, despite its fame as a quantum algorithm, begins with a purely classical check. Before engaging the quantum components, we first test if our randomly chosen base, $a$, shares a factor with the number $N$ we want to factor. This simple practice [@problem_id:132584] demonstrates this crucial first step, which can sometimes solve the problem with surprising efficiency using the classical Euclidean algorithm.", "problem": "Shor's algorithm is a quantum algorithm for integer factorization. Given a composite integer $N$, the algorithm aims to find a non-trivial factor of $N$. The procedure begins with a classical pre-check. A random integer $a$ is chosen in the range $1 < a < N$. The greatest common divisor (GCD) of $a$ and $N$ is computed. If $\\text{gcd}(a, N) > 1$, then this GCD is a non-trivial factor of $N$, and the algorithm successfully terminates without needing to use its quantum components. Only if $\\text{gcd}(a, N) = 1$ does the algorithm proceed to the quantum order-finding subroutine.\n\nConsider the task of factoring the integer $N=143$. Suppose that in the first step of Shor's algorithm, the chosen random integer is $a=26$. Determine the factor of $N$ that is found during this initial classical pre-check.", "solution": "We are given $N = 143$ and a randomly chosen integer $a = 26$ in the range $1 < a < N$.  \nThe classical pre-check of Shor's algorithm requires computing the greatest common divisor (GCD) of $a$ and $N$, denoted $\\gcd(a, N)$.  \nIf $\\gcd(a, N) > 1$, then this GCD is a non-trivial factor of $N$.  \n\nUsing the Euclidean algorithm to compute $\\gcd(26, 143)$:  \n- Divide $143$ by $26$: $143 = 26 \\times 5 + 13$, since $26 \\times 5 = 130$ and $143 - 130 = 13$.  \n- Now, $\\gcd(143, 26) = \\gcd(26, 13)$.  \n- Divide $26$ by $13$: $26 = 13 \\times 2 + 0$.  \n- Since the remainder is $0$, $\\gcd(26, 13) = 13$.  \n\nTherefore, $\\gcd(26, 143) = 13$.  \nSince $13 > 1$, it is a non-trivial factor of $143$.  \nThe algorithm terminates at the classical pre-check, and the factor found is $13$.", "answer": "$$\\boxed{13}$$", "id": "132584"}, {"introduction": "Once the quantum core of Shor's algorithm provides a measurement, we are left with a classical challenge: decoding this quantum signal to find the period. This is accomplished using the continued fraction algorithm, which finds the best rational approximations for the measurement result. This exercise [@problem_id:132555] takes you a step further than mere computation by asking you to test the very condition that guarantees the success of this method, providing insight into why it is so powerful.", "problem": "In the classical post-processing stage of Shor's algorithm for factoring an integer $N$, a measurement of the first quantum register yields an integer $y$. This measurement provides an approximation $x = y/Q$ to an unknown rational number $k/r$, where $r$ is the period of the function $f(a) = a^x \\pmod{N}$ for a randomly chosen base $a$, $k$ is an integer, and $Q$ is the size of the measurement register, typically a power of 2.\n\nThe continued fraction algorithm is used to find good rational approximations (convergents) $p_n/q_n$ to the measured value $x$. A key result, often attributed to Legendre, states that if a rational number $k/r$ satisfies the inequality\n$$ \\left| x - \\frac{k}{r} \\right| < \\frac{1}{2r^2} $$\nthen $k/r$ must be one of the convergents of the continued fraction expansion of $x$. In Shor's algorithm, we compute the convergents of $x=y/Q$ and check their denominators as candidates for the period $r$.\n\nConsider a hypothetical measurement result from an implementation of Shor's algorithm where the measured value is $y$ and the register size is $Q$. The resulting fraction is $x = y/Q = 491/2048$.\n\nYour task is to analyze the convergents of this measured fraction. Calculate the sequence of convergents $p_n/q_n$ for $x$. Then, for each convergent, test whether it satisfies the aforementioned inequality, treating the convergent itself as the fraction $k/r$ (i.e., test if $\\left|x - \\frac{p_n}{q_n}\\right|  \\frac{1}{2q_n^2}$).\n\nDetermine the denominator $q_n$ of the **first** convergent $p_n/q_n$ in the sequence (starting from $n=0$) that **fails** to satisfy this condition.", "solution": "We wish to find the convergents of \n$$x=\\frac{491}{2048}$$ \nand determine the first convergent $p_n/q_n$ for which \n$$\\Bigl|x-\\frac{p_n}{q_n}\\Bigr|\\ge\\frac1{2q_n^2}\\,. $$\n\n1.  Continued-fraction expansion of $491/2048$.\n\n    Set \n    $$x_0=\\frac{491}{2048},\\quad a_0=\\lfloor x_0\\rfloor=0,\\quad r_0=x_0-a_0.$$\n    Then\n    $$x_1=\\frac1{r_0}=\\frac{2048}{491}=4+\\frac{84}{491},\\quad a_1=4,\\quad r_1=\\frac{84}{491}.$$\n    $$x_2=\\frac1{r_1}=\\frac{491}{84}=5+\\frac{71}{84},\\quad a_2=5,\\quad r_2=\\frac{71}{84}.$$\n    $$x_3=\\frac1{r_2}=\\frac{84}{71}=1+\\frac{13}{71},\\quad a_3=1,\\quad r_3=\\frac{13}{71}.$$\n    $$x_4=\\frac1{r_3}=\\frac{71}{13}=5+\\frac{6}{13},\\quad a_4=5,\\quad r_4=\\frac{6}{13}.$$\n    $$x_5=\\frac1{r_4}=\\frac{13}{6}=2+\\frac{1}{6},\\quad a_5=2,\\quad r_5=\\frac{1}{6}.$$\n    $$x_6=\\frac1{r_5}=6,\\quad a_6=6,\\quad r_6=0.$$\n\n    Hence the continued fraction is\n    $$\\frac{491}{2048}=[0;4,5,1,5,2,6].$$\n\n2.  Convergents $p_n/q_n$ via\n    $$p_{-2}=0,\\;p_{-1}=1,\\quad q_{-2}=1,\\;q_{-1}=0,$$\n    $$p_n=a_n p_{n-1}+p_{n-2},\\quad q_n=a_nq_{n-1}+q_{n-2}.$$\n    We find\n    n=0: $p_0=0,\\;q_0=1\\;\\Rightarrow0/1.$  \n    n=1: $p_1=1,\\;q_1=4\\;\\Rightarrow1/4.$  \n    n=2: $p_2=5,\\;q_2=21\\;\\Rightarrow5/21.$  \n    n=3: $p_3=6,\\;q_3=25\\;\\Rightarrow6/25.$  \n    n=4: $p_4=35,\\;q_4=146\\;\\Rightarrow35/146.$  \n    n=5: $p_5=76,\\;q_5=317\\;\\Rightarrow76/317.$  \n    n=6: $p_6=491,\\;q_6=2048\\;\\Rightarrow491/2048.$  \n\n3.  Test each convergent against \n    $$\\Bigl|\\,x-\\frac{p_n}{q_n}\\Bigr|\\frac1{2q_n^2}.$$\n\n    n=0: $0/1$.  LHS $=491/2048$, RHS $=1/2$.  Since $491/20481/2$, holds.  \n    n=1: $1/4$.  LHS $=\\bigl|491/2048-512/2048\\bigr|=21/2048$,  \n    RHS $=1/(2\\cdot4^2)=1/32=64/2048$.  Since $2164$, holds.  \n    n=2: $5/21$.  LHS \n      $$\\Bigl|\\frac{491}{2048}-\\frac{5}{21}\\Bigr|\n        =\\Bigl|\\frac{491\\cdot21-5\\cdot2048}{2048\\cdot21}\\Bigr|\n        =\\frac{71}{43008}.$$\n    RHS \n      $$\\frac1{2\\cdot21^2}=\\frac1{882}.$$\n    Compare by cross-multiplying:\n      $$71\\cdot882\\;=\\;62622,\\quad 4300862622\n      \\;\\Longrightarrow\\;\\frac{71}{43008}\\frac1{882}.$$\n    Hence the inequality fails first at $n=2$ with denominator $q_2=21$.", "answer": "$$\\boxed{21}$$", "id": "132555"}, {"introduction": "Building a quantum computer capable of running Shor's algorithm requires careful resource planning, and a key question is how many qubits are needed for the phase estimation to be successful. This practice [@problem_id:132696] directly addresses this by linking the mathematical precision required by the classical post-processing step [@problem_id:132555] to the physical size of the quantum register. It demonstrates how to calculate the minimum number of qubits needed to ensure the algorithm's success with a given probability.", "problem": "In Shor's algorithm for factoring an integer $N$, a key subroutine is the Quantum Phase Estimation (QPE) algorithm. This subroutine is used to find the period $r$ of the function $f(x) = a^x \\pmod N$ for a randomly chosen base $a$ that is coprime to $N$. The QPE algorithm is applied to the unitary operator $U$ defined by its action on computational basis states $|y\\rangle$ as $U|y\\rangle = |ay \\pmod N\\rangle$. The eigenvalues of this operator are of the form $e^{i\\phi_s}$ where the phases are $\\phi_s = 2\\pi s/r$ for integers $s \\in \\{0, 1, \\ldots, r-1\\}$.\n\nThe QPE algorithm uses a $t$-qubit register (the 'phase register') and outputs an integer $j \\in \\{0, 1, \\dots, 2^t-1\\}$. This measurement is used to produce a rational approximation $\\tilde{\\phi} = j/2^t$ for one of the phases $\\phi = s/r$ (where we drop the factor of $2\\pi$).\n\nFor the subsequent classical part of Shor's algorithm, which uses the continued fractions algorithm to find the period $r$ from the estimate $j/2^t$, the phase estimation must be highly accurate. Specifically, the error must satisfy the inequality:\n$$ \\left| \\frac{s}{r} - \\frac{j}{2^t} \\right|  \\frac{1}{2N^2} $$\nTo achieve a high probability of success, the number of qubits $t$ in the phase register must be chosen carefully. The QPE algorithm guarantees that it can estimate a phase $\\phi$ to an accuracy of $n$ bits (i.e., the error $|\\phi - \\tilde{\\phi}|$ is bounded by $2^{-n}$) with a probability of success of at least $1 - \\epsilon$. This guarantee holds if the number of qubits $t$ is chosen as:\n$$ t = n + \\left\\lceil \\log_2\\left(2 + \\frac{1}{2\\epsilon}\\right) \\right\\rceil $$\nYour task is to calculate the minimum integer number of qubits $t$ required for the phase-estimation register to factor the integer $N=511$, ensuring that the measured phase is accurate enough for the continued fractions algorithm to succeed with a probability of at least $1 - \\epsilon$, for a failure tolerance of $\\epsilon = 1/4$.", "solution": "We require the phase-estimation error bound \n$$\\Bigl|\\frac{s}{r}-\\frac{j}{2^t}\\Bigr|\\frac1{2N^2}$$\nand QPE guarantees an error $|\\phi-\\tilde\\phi|\\le2^{-n}$, so we impose\n$$2^{-n}\\le\\frac1{2N^2} \\quad\\Longrightarrow\\quad 2^n\\ge2N^2 \\quad\\Longrightarrow\\quad \nn\\ge\\bigl\\lceil\\log_2(2N^2)\\bigr\\rceil.$$\nFor $N=511$ we compute\n$$2N^2=2\\cdot511^2=2\\cdot261121=522242,$$\nand since $2^{18}=262144522242524288=2^{19}$, we have\n$$n=\\lceil\\log_2(522242)\\rceil=19.$$\nNext, to succeed with failure tolerance $\\epsilon=1/4$, we use\n$$t=n+\\Bigl\\lceil\\log_2\\Bigl(2+\\frac1{2\\epsilon}\\Bigr)\\Bigr\\rceil\n=19+\\Bigl\\lceil\\log_2\\bigl(2+2\\bigr)\\Bigr\\rceil\n=19+\\lceil\\log_2(4)\\rceil\n=19+2=21.$$", "answer": "$$\\boxed{21}$$", "id": "132696"}]}