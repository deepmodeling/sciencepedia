{"hands_on_practices": [{"introduction": "The geometric picture describes Grover's algorithm as a rotation of the state vector toward the target state. This exercise explores the expectation value of the oracle operator, $\\langle U_\\omega \\rangle$, showing how it acts as a direct probe of the state vector's angle in the search plane. Calculating this value after $k$ iterations connects the abstract geometry to a physically measurable quantity, reinforcing the core dynamic principle of the algorithm [@problem_id:88187].", "problem": "Grover's search algorithm provides a quadratic speedup for unstructured search problems. The core of the algorithm is an iterative process that amplifies the amplitude of a marked quantum state within a larger state space.\n\nConsider a quantum system with an $N$-dimensional Hilbert space, spanned by an orthonormal computational basis $\\{|x\\rangle\\}_{x=0}^{N-1}$. The task is to find a single marked state, denoted by $|\\omega\\rangle$, from this basis. The algorithm starts in a uniform superposition of all basis states, $|s\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$.\n\nEach iteration of the algorithm consists of applying the Grover operator, $G$, to the state of the system. The Grover operator is a product of two unitary operators, $G = U_s U_\\omega$, where:\n1.  The oracle operator, $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$, flips the phase of the marked state $|\\omega\\rangle$. Here, $I$ is the identity operator.\n2.  The diffusion operator, $U_s = 2|s\\rangle\\langle s| - I$, reflects the state about the initial state $|s\\rangle$.\n\nAfter $k$ iterations, the system is in the state $|\\psi_k\\rangle = G^k |s\\rangle$.\n\nYour task is to compute the expectation value of the oracle operator $U_\\omega$ with respect to the state $|\\psi_k\\rangle$. This quantity, $\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$, provides insight into how the state aligns with the eigenspaces of the oracle as the algorithm progresses.\n\nExpress your answer as a function of the number of items $N$ and the number of iterations $k$.", "solution": "To compute the expectation value $\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$, where $|\\psi_k\\rangle = G^k |s\\rangle$, we utilize the two-dimensional subspace spanned by the marked state $|\\omega\\rangle$ and the uniform superposition of unmarked states. Define $|\\alpha\\rangle$ as the normalized state orthogonal to $|\\omega\\rangle$:\n\n\n$$\n|\\alpha\\rangle = \\frac{1}{\\sqrt{N-1}} \\sum_{x \\neq \\omega} |x\\rangle.\n$$\n\n\nThe initial state $|s\\rangle$ is:\n\n\n$$\n|s\\rangle = \\sqrt{\\frac{1}{N}} |\\omega\\rangle + \\sqrt{\\frac{N-1}{N}} |\\alpha\\rangle = \\sin\\theta \\, |\\omega\\rangle + \\cos\\theta \\, |\\alpha\\rangle,\n$$\n\n\nwhere $\\theta = \\arcsin(1/\\sqrt{N})$, so $\\sin\\theta = 1/\\sqrt{N}$ and $\\cos\\theta = \\sqrt{(N-1)/N}$.\n\nThe Grover operator $G$ rotates the state in the $\\{|\\alpha\\rangle, |\\omega\\rangle\\}$ plane by an angle $2\\theta$. After $k$ iterations, the state is:\n\n\n$$\n|\\psi_k\\rangle = \\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle.\n$$\n\n\nThe oracle operator is $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$. Applying it to $|\\psi_k\\rangle$:\n\n\n$$\nU_\\omega |\\psi_k\\rangle = (I - 2|\\omega\\rangle\\langle\\omega|) \\left[ \\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle \\right] = -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle.\n$$\n\n\nNow compute the expectation value:\n\n\n$$\n\\langle \\psi_k | U_\\omega | \\psi_k \\rangle = \\left[ \\sin((2k+1)\\theta) \\, \\langle\\omega| + \\cos((2k+1)\\theta) \\, \\langle\\alpha| \\right] \\left[ -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle \\right].\n$$\n\n\nExpanding the product and using orthonormality ($\\langle\\omega|\\alpha\\rangle = 0$, $\\langle\\alpha|\\omega\\rangle = 0$, $\\langle\\omega|\\omega\\rangle = 1$, $\\langle\\alpha|\\alpha\\rangle = 1$):\n\n\n$$\n\\begin{aligned}\n\\langle \\psi_k | U_\\omega | \\psi_k \\rangle &= \\sin((2k+1)\\theta) \\cdot (-\\sin((2k+1)\\theta)) \\langle\\omega|\\omega\\rangle + \\sin((2k+1)\\theta) \\cdot \\cos((2k+1)\\theta) \\langle\\omega|\\alpha\\rangle \\\\\n&\\quad + \\cos((2k+1)\\theta) \\cdot (-\\sin((2k+1)\\theta)) \\langle\\alpha|\\omega\\rangle + \\cos((2k+1)\\theta) \\cdot \\cos((2k+1)\\theta) \\langle\\alpha|\\alpha\\rangle \\\\\n&= -\\sin^2((2k+1)\\theta) + \\cos^2((2k+1)\\theta) \\\\\n&= \\cos(2(2k+1)\\theta),\n\\end{aligned}\n$$\n\n\nusing the double-angle identity $\\cos(2\\phi) = \\cos^2\\phi - \\sin^2\\phi$ with $\\phi = (2k+1)\\theta$. Substituting $\\theta = \\arcsin(1/\\sqrt{N})$:\n\n\n$$\n\\langle U_\\omega \\rangle_k = \\cos\\left(2(2k+1) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right).\n$$\n\n\nSimplifying the argument:\n\n\n$$\n2(2k+1) = 4k+2,\n$$\n\n\nso the expression is:\n\n\n$$\n\\langle U_\\omega \\rangle_k = \\cos\\left((4k+2) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right).\n$$", "answer": "$$\n\\boxed{ \\cos\\left( (4k+2) \\arcsin\\left( \\frac{1}{\\sqrt{N}} \\right) \\right) }\n$$", "id": "88187"}, {"introduction": "Real-world quantum computers are susceptible to errors, and state preparation is a critical step. This practice problem models a common imperfection where the initial state is not perfectly confined to the ideal two-dimensional Grover subspace due to leakage [@problem_id:88215]. By analyzing the effect of this leakage, you will understand why confinement to the search plane is crucial and how such errors fundamentally limit the algorithm's maximum success probability.", "problem": "Consider Grover's search algorithm for a single marked item $|w\\rangle$ in a database of $N$ items. The algorithm operates in an $N$-dimensional Hilbert space $\\mathcal{H}$. The standard algorithm evolves states within a 2D subspace $\\mathcal{H}_G$ spanned by the target state $|w\\rangle$ and the uniform superposition state $|\\psi_{\\text{unif}}\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{i=0}^{N-1}|i\\rangle$.\n\nSuppose that due to an imperfection in state preparation, the initial state $|\\psi_0\\rangle$ is not the perfect uniform superposition. Instead, it is a pure state with a fidelity $F=|\\langle \\psi_{\\text{unif}} | \\psi_0 \\rangle|^2 = 1-\\epsilon^2$ with respect to $|\\psi_{\\text{unif}}\\rangle$, where $0 < \\epsilon < 1$ is a small parameter. The imperfection is modeled as a leakage of amplitude into a state $|\\psi_{\\text{leak}}\\rangle$ which is normalized and lies in the subspace $\\mathcal{H}_G^\\perp$, the orthogonal complement of $\\mathcal{H}_G$. Specifically, the initial state is given by\n$$\n|\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle\n$$\nwhere we assume $\\epsilon$ is real and positive.\n\nThe search is performed by applying the standard Grover operator $G = U_{\\psi_{\\text{unif}}} U_w$, where $U_w = I-2|w\\rangle\\langle w|$ is the oracle and $U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$ is the diffusion operator.\n\nAssume that the size of the database $N$ is such that for an ideal search (starting from $|\\psi_{\\text{unif}}\\rangle$), there exists an optimal integer number of iterations, denoted $k_{\\text{opt}}$, that finds the marked state $|w\\rangle$ with probability 1.\n\nCalculate the success probability of finding the state $|w\\rangle$ if we run the algorithm on the imperfect initial state $|\\psi_0\\rangle$ for this same optimal number of iterations $k_{\\text{opt}}$.", "solution": "The initial state is given by:\n\n$$\n|\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle\n$$\n\nwhere $|\\psi_{\\text{leak}}\\rangle$ is normalized and lies in $\\mathcal{H}_G^\\perp$, the orthogonal complement of the 2D subspace $\\mathcal{H}_G$ spanned by $|w\\rangle$ and $|\\psi_{\\text{unif}}\\rangle$. Thus, $\\langle w | \\psi_{\\text{leak}} \\rangle = 0$ and $\\langle \\psi_{\\text{unif}} | \\psi_{\\text{leak}} \\rangle = 0$.\n\nThe Grover operator is $G = U_{\\psi_{\\text{unif}}} U_w$, with $U_w = I - 2|w\\rangle\\langle w|$ and $U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$. For any state $|v\\rangle \\in \\mathcal{H}_G^\\perp$, the action of $G$ is:\n\n$$\nG |v\\rangle = U_{\\psi_{\\text{unif}}} U_w |v\\rangle = U_{\\psi_{\\text{unif}}} |v\\rangle = -|v\\rangle\n$$\n\nsince $U_w |v\\rangle = |v\\rangle$ (because $\\langle w | v \\rangle = 0$) and $U_{\\psi_{\\text{unif}}} |v\\rangle = -|v\\rangle$ (because $\\langle \\psi_{\\text{unif}} | v \\rangle = 0$). Thus, after $k$ iterations:\n\n$$\nG^k |v\\rangle = (-1)^k |v\\rangle.\n$$\n\n\nAfter $k_{\\text{opt}}$ iterations, the state evolves to:\n\n$$\n|\\psi_{k_{\\text{opt}}}\\rangle = G^{k_{\\text{opt}}} |\\psi_0\\rangle = \\sqrt{1-\\epsilon^2}  G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle + \\epsilon  G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle.\n$$\n\n\nBy assumption, for the ideal initial state $|\\psi_{\\text{unif}}\\rangle$, $G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle = |w\\rangle$. Also, $G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle = (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle$. Substituting these:\n\n$$\n|\\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle.\n$$\n\n\nThe success probability is $|\\langle w | \\psi_{k_{\\text{opt}}}\\rangle|^2$. Compute the inner product:\n\n$$\n\\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\langle w | \\left( \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle \\right) = \\sqrt{1-\\epsilon^2} \\langle w | w \\rangle + \\epsilon (-1)^{k_{\\text{opt}}} \\langle w | \\psi_{\\text{leak}} \\rangle.\n$$\n\nSince $|\\psi_{\\text{leak}}\\rangle \\in \\mathcal{H}_G^\\perp$ and $|w\\rangle \\in \\mathcal{H}_G$, $\\langle w | \\psi_{\\text{leak}} \\rangle = 0$. Thus:\n\n$$\n\\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2}.\n$$\n\n\nThe success probability is:\n\n$$\n|\\langle w | \\psi_{k_{\\text{opt}}}\\rangle|^2 = \\left( \\sqrt{1-\\epsilon^2} \\right)^2 = 1 - \\epsilon^2.\n$$", "answer": "$$ \\boxed{1 - \\epsilon^2} $$", "id": "88215"}, {"introduction": "The geometric model is not just a descriptive tool; it is a predictive framework that can be used to interpret experimental results. This final exercise challenges you to work backward from a set of hypothetical measurement outcomes, $P_1$ and $P_2$, to determine the fundamental parameters of a Grover-like search [@problem_id:88172]. This \"inverse problem\" demonstrates how the geometric visualization provides a powerful framework for characterizing and calibrating quantum algorithms in practice.", "problem": "In the geometric interpretation of a Grover-like quantum search algorithm, the state of the system is described by a vector in a two-dimensional real Hilbert space spanned by the target state $|t\\rangle$ and an orthogonal state $|o\\rangle$. Any state in this plane can be parameterized by an angle $\\theta$ as $|\\psi(\\theta)\\rangle = \\sin(\\theta) |t\\rangle + \\cos(\\theta) |o\\rangle$. The probability of measuring the target state is thus $P(\\theta) = |\\langle t | \\psi(\\theta) \\rangle|^2 = \\sin^2(\\theta)$.\n\nEach iteration of the algorithm corresponds to a rotation of the state vector by a fixed angle $\\phi$ in this plane. If the initial state is $|\\psi_0\\rangle = |\\psi(\\theta_0)\\rangle$, then after $k$ iterations, the state becomes $|\\psi_k\\rangle = |\\psi(\\theta_0 + k\\phi)\\rangle$. Consequently, the probability of measuring the target state after $k$ iterations is $P_k = \\sin^2(\\theta_0 + k\\phi)$.\n\nAn experiment is conducted using such an algorithm. An initial state is prepared with an angle $\\theta_0$. The search algorithm is run for one and two iterations, and the probabilities of finding the target state are measured to be $P_1$ and $P_2$, respectively. It is known from the physical setup that the initial angle $\\theta_0$ and the rotation angle per iteration $\\phi$ are both positive and sufficiently small such that all relevant angles in the first two iterations, i.e., $(\\theta_0+\\phi)$ and $(\\theta_0+2\\phi)$, lie in the first quadrant $(0, \\pi/2)$.\n\nBased on the measured probabilities $P_1$ and $P_2$, determine a closed-form expression for the initial angle $\\theta_0$.", "solution": "The problem provides the relationship between the angle of the state vector and the probability of measuring the target state. After $k$ iterations of the Grover-like algorithm, the angle is $\\theta_k = \\theta_0 + k\\phi$, and the corresponding probability is $P_k = \\sin^2(\\theta_k)$.\n\nWe are given the probabilities after one and two iterations:\n$$\nP_1 = \\sin^2(\\theta_0 + \\phi)\n$$\n$$\nP_2 = \\sin^2(\\theta_0 + 2\\phi)\n$$\n\nWe are asked to solve for the initial angle $\\theta_0$ in terms of the known quantities $P_1$ and $P_2$.\n\nFirst, we can take the square root of both equations. Since the problem states that the angles $(\\theta_0+\\phi)$ and $(\\theta_0+2\\phi)$ are in the interval $(0, \\pi/2)$, the sine of these angles will be positive. Therefore, we can take the positive square root without ambiguity:\n$$\n\\sqrt{P_1} = \\sin(\\theta_0 + \\phi)\n$$\n$$\n\\sqrt{P_2} = \\sin(\\theta_0 + 2\\phi)\n$$\n\nNext, we can isolate the angles by applying the arcsin function. Since the angles are in $(0, \\pi/2)$, the range of the standard `arcsin` function, $[-\\pi/2, \\pi/2]$, correctly recovers the angles.\n$$\n\\theta_0 + \\phi = \\arcsin(\\sqrt{P_1})\n$$\n$$\n\\theta_0 + 2\\phi = \\arcsin(\\sqrt{P_2})\n$$\n\nWe now have a system of two linear equations with two unknowns, $\\theta_0$ and $\\phi$.\nLet's label the equations for clarity:\n1. $\\theta_0 + \\phi = \\arcsin(\\sqrt{P_1})$\n2. $\\theta_0 + 2\\phi = \\arcsin(\\sqrt{P_2})$\n\nTo solve for $\\theta_0$, we first find an expression for $\\phi$ and then substitute it back. We can find $\\phi$ by subtracting the first equation from the second:\n$$\n(\\theta_0 + 2\\phi) - (\\theta_0 + \\phi) = \\arcsin(\\sqrt{P_2}) - \\arcsin(\\sqrt{P_1})\n$$\n$$\n\\phi = \\arcsin(\\sqrt{P_2}) - \\arcsin(\\sqrt{P_1})\n$$\n\nNow, we substitute this expression for $\\phi$ back into the first equation:\n$$\n\\theta_0 + \\left( \\arcsin(\\sqrt{P_2}) - \\arcsin(\\sqrt{P_1}) \\right) = \\arcsin(\\sqrt{P_1})\n$$\n\nSolving for $\\theta_0$ by isolating it on one side of the equation:\n$$\n\\theta_0 = \\arcsin(\\sqrt{P_1}) - \\left( \\arcsin(\\sqrt{P_2}) - \\arcsin(\\sqrt{P_1}) \\right)\n$$\n$$\n\\theta_0 = \\arcsin(\\sqrt{P_1}) - \\arcsin(\\sqrt{P_2}) + \\arcsin(\\sqrt{P_1})\n$$\n$$\n\\theta_0 = 2\\arcsin(\\sqrt{P_1}) - \\arcsin(\\sqrt{P_2})\n$$\n\nThis expression provides the initial angle $\\theta_0$ as a function of the measured probabilities $P_1$ and $P_2$. It is a closed-form analytic expression as required.", "answer": "$$ \\boxed{2\\arcsin(\\sqrt{P_1}) - \\arcsin(\\sqrt{P_2})} $$", "id": "88172"}]}