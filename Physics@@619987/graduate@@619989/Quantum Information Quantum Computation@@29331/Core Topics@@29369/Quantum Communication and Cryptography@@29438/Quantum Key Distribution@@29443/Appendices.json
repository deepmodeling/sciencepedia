{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we address the most fundamental question of security in the BB84 protocol: how is an eavesdropper detected? This exercise [@problem_id:1651422] guides you through calculating the quantum bit error rate (QBER) induced by a canonical intercept-resend attack. By working through this scenario, you will quantitatively demonstrate that the very act of eavesdropping introduces a statistically significant and detectable disturbance, revealing the core principle that underpins quantum key distribution's security.", "problem": "Two physicists, Alice and Bob, are testing their new Quantum Key Distribution (QKD) system, which operates based on the BB84 protocol. In this protocol, Alice sends quantum bits (qubits) to Bob, encoding classical bits of information.\n\nThe encoding scheme is as follows:\n- To send a classical bit '0', Alice can prepare a qubit in the state $|0\\rangle$ (from the rectilinear basis) or in the state $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ (from the diagonal basis).\n- To send a classical bit '1', Alice can prepare a qubit in the state $|1\\rangle$ (from the rectilinear basis) or in the state $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$ (from the diagonal basis).\n\nFor each qubit she sends, Alice makes two independent random choices: she chooses the classical bit to send (0 or 1, each with 50% probability) and she chooses the basis to use (rectilinear or diagonal, each with 50% probability).\n\nAn eavesdropper, Eve, implements an intercept-resend attack on every single qubit transmitted from Alice to Bob. For each qubit she intercepts, Eve, not knowing Alice's basis choice, randomly chooses a basis (rectilinear or diagonal, each with 50% probability) to perform a measurement. She then sends a new qubit to Bob, prepared in the state corresponding to her measurement outcome and in the basis she used for her measurement.\n\nBob receives the qubit from Eve and, not knowing Alice's or Eve's basis choice, also randomly chooses a basis (rectilinear or diagonal, each with 50% probability) to perform his measurement.\n\nAfter the entire sequence of qubits has been transmitted and measured, Alice and Bob communicate over a public channel to compare the bases they used for each bit. They discard all bits for which their basis choices did not match. The remaining bits form the sifted key.\n\nCalculate the expected Quantum Bit Error Rate (QBER), defined as the probability that a bit in Bob's sifted key does not match the corresponding bit that Alice originally sent. Express your answer as a decimal.", "solution": "Let $X \\in \\{0,1\\}$ denote Alice's bit, $A \\in \\{\\mathcal{R},\\mathcal{D}\\}$ Alice's basis (rectilinear or diagonal), $E \\in \\{\\mathcal{R},\\mathcal{D}\\}$ Eve's basis, and $B \\in \\{\\mathcal{R},\\mathcal{D}\\}$ Bob's basis. Let $Y \\in \\{0,1\\}$ denote Bob's measurement outcome interpreted as a bit in his chosen basis. The sifted set corresponds to the event $S=\\{A=B\\}$. The Quantum Bit Error Rate (QBER) is the conditional probability\n$$\n\\mathrm{QBER}=P(Y \\neq X \\mid S).\n$$\nUsing the law of total probability with respect to whether Eve's basis matches Alice's basis,\n$$\nP(Y \\neq X \\mid S)=P(E=A \\mid S)\\,P(Y \\neq X \\mid S,E=A)+P(E \\neq A \\mid S)\\,P(Y \\neq X \\mid S,E \\neq A).\n$$\nBecause $E$ is chosen independently of $A$ and $B$, conditioning on $S$ does not change the distribution of $E$ relative to $A$:\n$$\nP(E=A \\mid S)=\\frac{P(E=A, S)}{P(S)}=\\frac{P(E=A)\\,P(S)}{P(S)}=P(E=A)=\\frac{1}{2},\n$$\nand thus $P(E \\neq A \\mid S)=\\frac{1}{2}$.\n\nEvaluate the two conditional error probabilities:\n1) If $E=A$ and $S$ holds (so $B=A$), Eve measures in Alice's basis and resends the corresponding eigenstate in that basis. Bob then measures in the same basis $A$, obtaining the same bit with certainty by projective measurement of an eigenstate. Hence\n$$\nP(Y \\neq X \\mid S,E=A)=0.\n$$\n2) If $E \\neq A$ and $S$ holds (so $B=A \\neq E$), Eve measures in the conjugate basis. For example, if Alice sent $|0\\rangle$ (basis $\\mathcal{R}$) and Eve measures in $\\mathcal{D}$, Eve's result is $|+\\rangle$ or $|-\\rangle$ with probability $\\frac{1}{2}$ each, and she resends that state. Bob measures in $\\mathcal{R}$; the Born rule gives\n$$\n|\\langle 0|+\\rangle|^{2}=|\\langle 1|+\\rangle|^{2}=|\\langle 0|-\\rangle|^{2}=|\\langle 1|-\\rangle|^{2}=\\left|\\frac{1}{\\sqrt{2}}\\right|^{2}=\\frac{1}{2},\n$$\nso Bob's outcome is uniformly random relative to Alice's original bit. Therefore\n$$\nP(Y \\neq X \\mid S,E \\neq A)=\\frac{1}{2}.\n$$\n\nCombining these,\n$$\n\\mathrm{QBER}=\\left(\\frac{1}{2}\\right)\\cdot 0+\\left(\\frac{1}{2}\\right)\\cdot \\left(\\frac{1}{2}\\right)=\\frac{1}{4}=0.25.\n$$", "answer": "$$\\boxed{0.25}$$", "id": "1651422"}, {"introduction": "Moving from idealized protocols to practical implementations, we must account for the inevitable imperfections of physical hardware. This problem [@problem_id:122603] challenges you to construct a more realistic model of a QKD system by synthesizing the effects of three distinct, non-ideal components: systematic basis misalignment ($\\theta$), detector dark counts ($p_{dark}$), and channel loss ($\\eta$). By deriving the total QBER in the presence of these simultaneous noise sources, you will gain valuable experience in modeling the performance of real-world quantum communication systems.", "problem": "In a practical implementation of the BB84 quantum key distribution (QKD) protocol, Alice sends single-photon states to Bob. The protocol utilizes two polarization bases: the rectilinear basis ($Z$), consisting of horizontal ($|H\\rangle$, representing logical bit 0) and vertical ($|V\\rangle$, logical bit 1) polarization states, and the diagonal basis ($X$), consisting of diagonal ($|D\\rangle = \\frac{1}{\\sqrt{2}}(|H\\rangle+|V\\rangle)$, logical 0) and anti-diagonal ($|A\\rangle = \\frac{1}{\\sqrt{2}}(|H\\rangle-|V\\rangle)$, logical 1) states. Alice randomly prepares and sends photons in one of these four states. Bob randomly chooses to measure in either the $Z$ or $X$ basis.\n\nAfter the quantum transmission phase, Alice and Bob publicly announce their basis choices for each transmitted photon. They keep only the results from instances where their bases matched, forming the \"sifted key\". The Quantum Bit Error Rate (QBER) is the fraction of bits in this sifted key that are incorrect.\n\nConsider a QKD system where the ideal protocol is affected by the following imperfections:\n\n1.  **Basis Misalignment:** There is a systematic, constant angular misalignment $\\theta$ between Alice's and Bob's corresponding polarization bases. If Alice's bases are $\\{|H\\rangle, |V\\rangle\\}$ and $\\{|D\\rangle, |A\\rangle\\}$, Bob's bases are $\\{|H'\\rangle, |V'\\rangle\\}$ and $\\{|D'\\rangle, |A'\\rangle\\}$, where $|H'\\rangle = \\cos\\theta |H\\rangle + \\sin\\theta |V\\rangle$ and $|V'\\rangle = -\\sin\\theta |H\\rangle + \\cos\\theta |V\\rangle$. The same rotation applies to the diagonal basis.\n\n2.  **Detector Dark Counts:** Bob's measurement apparatus for each basis consists of a polarizing beam splitter followed by two single-photon detectors. Each of these detectors has an identical probability, $p_{dark}$, of registering a \"click\" during a measurement time window, even if no photon is present. These dark counts are independent for each detector.\n\n3.  **Channel Loss:** The quantum channel connecting Alice and Bob is lossy, characterized by a transmission efficiency $\\eta$. This means a photon sent by Alice has a probability $\\eta$ of arriving at Bob's detection setup.\n\nBob's detection outcome is determined as follows: for a chosen measurement basis, if exactly one of the two corresponding detectors clicks, a bit value is recorded. If both detectors click or neither detector clicks, the event is considered invalid and is discarded.\n\nAssuming Alice sends each of the four BB84 states with equal probability and Bob chooses his measurement basis with equal probability, determine the total QBER of the sifted key. Express your answer as a function of the transmission efficiency $\\eta$, the misalignment angle $\\theta$, and the dark count probability $p_{dark}$.", "solution": "1. Define events and parameters:  \n   - Photon arrival: $p_{\\rm arr}=\\eta$, loss: $1-\\eta$.  \n   - Detector dark‐count probability: $p_d=p_{dark}$ per detector.  \n   - Misalignment projection probabilities in matched basis:  \n     $$T_{\\rm correct}=\\cos^2\\theta,\\quad T_{\\rm error}=\\sin^2\\theta,\\quad \n       T_{\\rm correct}+T_{\\rm error}=1.$$\n\n2. Case 1: photon arrives (probability $\\eta$).  \n   Exactly one click occurs if the photon induces one click (in either detector) and no dark count occurs in the other detector.  \n   Total valid probability in this case:  \n   $$P_{\\rm valid|arr}\n     =\\sum_{d}\\!T_d\\,(1-p_d)\n     =(T_{\\rm correct}+T_{\\rm error})(1-p_d)\n     =1-p_d.$$  \n   Error occurs only when the photon goes to the “wrong’’ detector and the other has no dark click:  \n   $$P_{\\rm err|arr}\n     =T_{\\rm error}(1-p_d).$$  \n   Hence conditional error rate on arrival:  \n   $$e_{\\rm arr}\n     =\\frac{T_{\\rm error}(1-p_d)}{1-p_d}\n     =T_{\\rm error}\n     =\\sin^2\\theta.$$\n\n3. Case 2: photon lost (probability $1-\\eta$).  \n   Clicks arise solely from dark counts. Exactly one dark click occurs with probability  \n   $$P_{\\rm valid|loss}\n     =2\\,p_d\\,(1-p_d).$$  \n   This single‐click bit is random, so error probability is $1/2$ per event:  \n   $$P_{\\rm err|loss}\n     =2\\,p_d\\,(1-p_d)\\times\\frac12\n     =(1-\\eta)\\,p_d\\,(1-p_d)\\quad\\text{(including prefactor }1-\\eta\\text{).}$$\n\n4. Total valid sifted events per signal:  \n   $$P_{\\rm valid}\n     =\\eta(1-p_d)+(1-\\eta)\\,2\\,p_d\\,(1-p_d).$$  \n   Total error probability per signal:  \n   $$P_{\\rm err}\n     =\\eta\\,T_{\\rm error}(1-p_d)+(1-\\eta)\\,p_d\\,(1-p_d)\n     =\\eta\\,\\sin^2\\theta\\,(1-p_d)+(1-\\eta)\\,p_d\\,(1-p_d).$$\n\n5. QBER is the ratio:  \n   $$Q\n     =\\frac{P_{\\rm err}}{P_{\\rm valid}}\n     =\\frac{\\eta\\sin^2\\theta\\,(1-p_d)+(1-\\eta)p_d\\,(1-p_d)}\n           {\\eta(1-p_d)+(1-\\eta)2p_d\\,(1-p_d)}.$$\n   Factor out $(1-p_d)$ from numerator and denominator:  \n   $$Q\n     =\\frac{\\eta\\sin^2\\theta+(1-\\eta)p_d}\n           {\\eta+2(1-\\eta)p_d}.$$", "answer": "$$\\boxed{\\frac{\\eta\\sin^2\\theta+(1-\\eta)p_{dark}}{\\eta+2(1-\\eta)p_{dark}}}$$", "id": "122603"}, {"introduction": "A crucial aspect of practical QKD security involves analyzing vulnerabilities that arise from non-ideal sources. This advanced problem [@problem_id:122661] delves into the potent photon-number splitting (PNS) attack, which exploits the fact that most QKD systems use weak coherent pulses rather than true single-photon sources. You will analyze the Poissonian statistics of these sources to quantify the fraction of the sifted key that an eavesdropper can perfectly ascertain, highlighting the necessity for advanced countermeasures like the decoy-state protocol.", "problem": "In a practical implementation of the BB84 quantum key distribution protocol, Alice does not use a true single-photon source. Instead, she uses a weak coherent pulse (WCP) source, which emits quantum states $|\\alpha\\rangle$. The photon number $n$ in such a pulse follows a Poisson distribution with mean $\\mu = |\\alpha|^2$:\n$$P(n) = e^{-\\mu} \\frac{\\mu^n}{n!}$$\nAn eavesdropper, Eve, can exploit this by performing a photon-number splitting (PNS) attack. Consider the following scenario:\n\n1.  **Eve's Strategy**: Eve uses a quantum non-demolition (QND) measurement to determine the photon number $n$ of each pulse from Alice without altering the quantum state of the photons.\n    *   If $n=0$ (vacuum pulse) or $n=1$ (single-photon pulse), she lets the pulse pass undisturbed to Bob.\n    *   If $n \\ge 2$ (multi-photon pulse), she splits off exactly one photon, stores it in a lossless quantum memory, and sends the remaining $n-1$ photons to Bob in the same state.\n\n2.  **Channel and Detection**: The total channel and detector system between Alice (or Eve) and Bob has a combined efficiency $\\eta$. A single photon sent towards Bob's detector is detected with probability $\\eta$. Bob uses a threshold detector that cannot resolve photon numbers; it either \"clicks\" if one or more photons arrive, or it doesn't. The probability of a click for an incoming $m$-photon pulse is $1-(1-\\eta)^m$.\n\n3.  **Sifting**: After transmission, Alice and Bob publicly announce their basis choices for each pulse. They keep only the bits corresponding to instances where they chose the same basis and Bob's detector clicked. Eve also listens to this public discussion and measures her stored photons in the correct basis for the sifted bits.\n\nAssuming this idealized PNS attack, calculate the fraction of bits in the final sifted key that are known to Eve. Your answer should be an expression in terms of the mean photon number $\\mu$ and the overall efficiency $\\eta$.", "solution": "We seek the fraction of sifted bits (i.e. pulses where Bob clicks and bases match) that originate from multi‐photon pulses ($n\\ge2$), since Eve learns those bits perfectly.  Basis‐sifting (probability $1/2$) cancels in the ratio.  \n\n1. Photon‐number distribution and Bob’s click‐probability  \n$$P(n)=e^{-\\mu}\\frac{\\mu^n}{n!},\\quad\np_{\\rm click}(n)=1-(1-\\eta)^m,\\;m=\\begin{cases}n,&n\\le1,\\\\\nn-1,&n\\ge2.\\end{cases}$$  \n\nThus  \n– For $n=1$: $p_{\\rm click}(1)=\\eta$.  \n– For $n\\ge2$: $p_{\\rm click}(n)=1-(1-\\eta)^{\\,n-1}$.  \n\n2. Total rate of sifted bits (up to a common $1/2$ that cancels)  \n$$R_{\\rm sift}=\\sum_{n=1}^\\infty P(n)\\,p_{\\rm click}(n)\n=e^{-\\mu}\\Big[\\mu\\,\\eta+\\sum_{n=2}^\\infty\\frac{\\mu^n}{n!}\\big(1-(1-\\eta)^{n-1}\\big)\\Big].$$  \n\n3. Rate of sifted bits from multi‐photon pulses (known to Eve)  \n$$R_{E}=\\sum_{n=2}^\\infty P(n)\\,p_{\\rm click}(n)\n=e^{-\\mu}\\sum_{n=2}^\\infty\\frac{\\mu^n}{n!}\\big[1-(1-\\eta)^{n-1}\\big].$$  \n\n4. Evaluate the sums.  Define  \n$$S_1=\\sum_{n=2}^\\infty\\frac{\\mu^n}{n!}\n=e^\\mu-1-\\mu,\\qquad\nS_2=\\sum_{n=2}^\\infty\\frac{\\mu^n}{n!}(1-\\eta)^{\\,n-1}\n=\\frac{e^{\\mu(1-\\eta)}-1-\\mu(1-\\eta)}{1-\\eta}.$$  \nHence  \n$$R_{E}=e^{-\\mu}\\big[S_1-S_2\\big],\\qquad\nR_{\\rm sift}=e^{-\\mu}\\big[\\mu\\eta+S_1-S_2\\big].$$  \n\n5. Fraction known to Eve  \n$$f_E=\\frac{R_E}{R_{\\rm sift}}\n=\\frac{S_1-S_2}{\\,\\mu\\eta+S_1-S_2\\,}\n=\\frac{e^\\mu-1-\\mu-\\dfrac{e^{\\mu(1-\\eta)}-1-\\mu(1-\\eta)}{1-\\eta}}\n{\\,e^\\mu-1-\\mu-\\dfrac{e^{\\mu(1-\\eta)}-1-\\mu(1-\\eta)}{1-\\eta}+\\mu\\eta\\,}.$$", "answer": "$$\\boxed{\\frac{e^\\mu-1-\\mu-\\frac{e^{\\mu(1-\\eta)}-1-\\mu(1-\\eta)}{1-\\eta}}\n{\\,e^\\mu-1-\\mu-\\frac{e^{\\mu(1-\\eta)}-1-\\mu(1-\\eta)}{1-\\eta}+\\mu\\eta\\,}}$$", "id": "122661"}]}