{"hands_on_practices": [{"introduction": "To build a secure quantum key distribution system, we must first understand its vulnerabilities. This exercise explores the simplest and most intuitive eavesdropping strategy, the intercept-resend attack, against the BB84 protocol. By calculating the Quantum Bit Error Rate (QBER) Eve induces, we establish a direct, quantitative link between her intervention and an observable signature, which is the foundational step in any QKD security analysis [@problem_id:171243].", "problem": "In the BB84 protocol for quantum key distribution (QKD), Alice sends a sequence of single qubits to Bob. For each qubit, she randomly and independently chooses to encode a bit in one of two bases: the rectilinear (Z) basis, with eigenstates $\\{|0\\rangle, |1\\rangle\\}$, or the diagonal (X) basis, with eigenstates $\\{|+\\rangle, |-\\rangle\\}$. The states are defined as:\n$$\n|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad |1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle), \\quad |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)\n$$\nBob, for each incoming qubit, also randomly and independently chooses to measure in either the Z-basis or the X-basis. After the transmission, Alice and Bob communicate over a public channel to compare the bases they used for each qubit. They keep only the bits for which their basis choices matched, forming the \"sifted key\". The quantum bit error rate (QBER) is the fraction of bits in this sifted key that are different between Alice and Bob.\n\nAn eavesdropper, Eve, performs a symmetric intercept-resend attack. For each qubit sent by Alice, Eve intercepts it, measures it in either the Z-basis or the X-basis with equal probability, and then sends a new qubit to Bob prepared in the state she measured. Assume Eve's choice of basis is random and independent for each qubit.\n\nCalculate the expected QBER induced by Eve's attack.", "solution": "In the BB84 protocol with Eve's symmetric intercept-resend attack, the expected quantum bit error rate (QBER) is the probability that, for a qubit in the sifted key (where Alice and Bob used the same basis), Bob's measurement outcome differs from Alice's sent bit. The sifted key is conditioned on Alice and Bob choosing the same basis.\n\nConsider a single qubit transmission. Due to symmetry, assume without loss of generality that Alice uses the rectilinear basis (Z-basis). Alice sends $|0\\rangle$ or $|1\\rangle$ with equal probability $\\frac{1}{2}$. Fix the bit to $|0\\rangle$ (by symmetry, the error probability is the same for $|1\\rangle$). Eve intercepts and chooses a basis randomly: Z-basis with probability $\\frac{1}{2}$ or X-basis with probability $\\frac{1}{2}$.\n\n- **Case 1: Eve chooses Z-basis (probability $\\frac{1}{2}$)**  \n  Eve measures $|0\\rangle$ in Z-basis, obtaining $|0\\rangle$ and sends $|0\\rangle$ to Bob.  \n  Bob measures in Z-basis (conditioned on sifted key), obtaining $0$ with certainty. Error probability: $0$.\n\n- **Case 2: Eve chooses X-basis (probability $\\frac{1}{2}$)**  \n  Eve measures $|0\\rangle$ in X-basis:  \n  - Obtains $|+\\rangle$ with probability $\\frac{1}{2}$, sends $|+\\rangle$ to Bob.  \n  - Obtains $|-\\rangle$ with probability $\\frac{1}{2}$, sends $|-\\rangle$ to Bob.  \n  Bob measures in Z-basis:  \n  - For $|+\\rangle$, Bob obtains $0$ or $1$ each with probability $\\frac{1}{2}$. Error occurs if $1$ (probability $\\frac{1}{2}$).  \n  - For $|-\\rangle$, Bob obtains $0$ or $1$ each with probability $\\frac{1}{2}$. Error occurs if $1$ (probability $\\frac{1}{2}$).  \n  Thus, conditional on Eve choosing X-basis, the error probability is:  \n  $$\n  \\frac{1}{2} \\cdot \\frac{1}{2} + \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}.\n  $$\n\nThe overall error probability, given Alice sent $|0\\rangle$ and Bob measured in Z-basis, is:  \n$$\nP(\\text{error} \\mid \\text{Alice Z, Bob Z}) = P(\\text{Case 1}) \\cdot 0 + P(\\text{Case 2}) \\cdot \\frac{1}{2} = \\frac{1}{2} \\cdot 0 + \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}.\n$$\n\nBy symmetry, if Alice uses the diagonal basis (X-basis), sending $|+\\rangle$ or $|-\\rangle$, the error probability conditioned on Bob also using X-basis is also $\\frac{1}{4}$. Since the sifted key includes only same-basis qubits, and the conditional error probability is $\\frac{1}{4}$ for both basis choices, the expected QBER is $\\frac{1}{4}$.", "answer": "$$\\boxed{\\dfrac{1}{4}}$$", "id": "171243"}, {"introduction": "In a real-world scenario, Alice and Bob cannot check every transmitted bit for errors; they only sample a small portion of their sifted key. This raises a crucial statistical question: how confident can they be that the QBER measured on this small sample accurately reflects the true QBER of the entire key? This practice introduces Hoeffding's inequality as a rigorous tool to answer this question, allowing us to calculate the minimum amount of data required to estimate the QBER with a desired precision and confidence level [@problem_id:171195].", "problem": "In the BB84 quantum key distribution (QKD) protocol, Alice sends quantum states to Bob, who measures them. They later perform a \"sifting\" procedure by publicly communicating the bases they used for preparation and measurement, and they discard all instances where their bases did not match. This results in a \"sifted key\".\n\nTo ensure the security of the protocol, Alice and Bob must estimate the Quantum Bit Error Rate (QBER), denoted by $Q$. The QBER is the fraction of bits in the sifted key that would be different between them. An eavesdropper's intervention inevitably increases this rate. To estimate $Q$, they sacrifice a randomly chosen subset of their sifted key, called the \"test key\" of size $m$. They publicly compare the bit values in this test key to compute an empirical QBER, $\\hat{Q}$. This $\\hat{Q}$ serves as an estimate for the true QBER, $Q$, over the entire channel.\n\nThe accuracy of this estimation is a probabilistic statement. Alice and Bob require that their estimate $\\hat{Q}$ is close to the true value $Q$, specifically $|\\hat{Q} - Q| \\leq \\delta$, where $\\delta$ is the desired precision. They want this to be true with high probability, meaning the probability of a larger error, $P(|\\hat{Q} - Q| > \\delta)$, should be no more than a small \"parameter estimation\" security parameter, $\\epsilon_{PE}$. The confidence level is thus $1 - \\epsilon_{PE}$.\n\nThis problem can be addressed using Hoeffding's inequality, which bounds the probability that the sample mean of a set of independent random variables deviates from its expected value. For $m$ independent and identically distributed (i.i.d.) random variables $X_1, \\dots, X_m$ bounded in the interval $[a, b]$, and their sample mean $\\bar{X} = \\frac{1}{m}\\sum_{i=1}^m X_i$, Hoeffding's inequality states:\n$$P(|\\bar{X} - E[\\bar{X}]| \\geq \\delta) \\leq 2 \\exp\\left( - \\frac{2m\\delta^2}{(b-a)^2} \\right)$$\nwhere $E[\\bar{X}]$ is the true mean of the underlying distribution.\n\nUsing this inequality, determine the minimum size $m$ of the test key required to estimate the QBER, $Q$, with a precision $\\delta$ and a confidence level of at least $1-\\epsilon_{PE}$. Express your answer as a function of $\\delta$ and $\\epsilon_{PE}$.", "solution": "To estimate the minimum size $m$ of the test key for the BB84 protocol, we use Hoeffding's inequality. The empirical Quantum Bit Error Rate (QBER), $\\hat{Q}$, is the sample mean of $m$ independent Bernoulli random variables $X_i$, where each $X_i$ represents an error in the test key:\n\n$$\nX_i = \n\\begin{cases} \n1 & \\text{with probability } Q, \\\\\n0 & \\text{with probability } 1 - Q.\n\\end{cases}\n$$\n\nThus, $\\hat{Q} = \\frac{1}{m} \\sum_{i=1}^m X_i$, and $E[\\hat{Q}] = Q$. The random variables $X_i$ are bounded in $[0, 1]$, so $a = 0$ and $b = 1$.\n\nHoeffding's inequality states:\n\n$$\nP(|\\hat{Q} - Q| \\geq \\delta) \\leq 2 \\exp\\left( - \\frac{2m\\delta^2}{(b-a)^2} \\right).\n$$\n\nSubstituting $b - a = 1$:\n\n$$\nP(|\\hat{Q} - Q| \\geq \\delta) \\leq 2 \\exp(-2m\\delta^2).\n$$\n\nAlice and Bob require this probability to be at most $\\epsilon_{PE}$:\n\n$$\n2 \\exp(-2m\\delta^2) \\leq \\epsilon_{PE}.\n$$\n\nSolving for $m$:\n\n$$\n\\exp(-2m\\delta^2) \\leq \\frac{\\epsilon_{PE}}{2},\n$$\n\n\n$$\n-2m\\delta^2 \\leq \\ln\\left( \\frac{\\epsilon_{PE}}{2} \\right),\n$$\n\n\n$$\n2m\\delta^2 \\geq -\\ln\\left( \\frac{\\epsilon_{PE}}{2} \\right) = \\ln\\left( \\frac{2}{\\epsilon_{PE}} \\right),\n$$\n\n\n$$\nm \\geq \\frac{\\ln\\left( \\frac{2}{\\epsilon_{PE}} \\right)}{2\\delta^2}.\n$$\n\nThe minimum $m$ that satisfies this bound is given by the expression above.", "answer": "$$ \\boxed{ \\dfrac{ \\ln \\left( \\dfrac{2}{\\epsilon_{PE}} \\right) }{ 2 \\delta^{2} } } $$", "id": "171195"}, {"introduction": "The final and most critical step in a security proof is to translate the observed disturbance into a guarantee of secrecy. Having established how to measure the QBER, $Q_X$, in the conjugate basis, we now connect this value to Eve's knowledge about the key bits encoded in the computational basis. This problem demonstrates how a fundamental concept, the entropic uncertainty relation, provides a powerful lower bound on Eve's uncertainty, thereby quantifying the amount of secret key that can be securely extracted [@problem_id:143203].", "problem": "In the context of the BB84 quantum key distribution (QKD) protocol, the security of the final key is fundamentally limited by the information an eavesdropper, Eve (E), can gain about the raw key transmitted from Alice (A) to Bob (B). This information leakage can be quantified and bounded using entropic uncertainty relations.\n\nConsider a BB84 implementation where Alice prepares and sends single-qubit states to Bob. Her raw key bits are encoded in the computational basis, or Z-basis ($\\{|0\\rangle, |1\\rangle\\}$). To detect eavesdropping, Alice and Bob publicly compare a random subset of their bits that were prepared and measured in the conjugate basis, or X-basis ($\\{|+\\rangle, |-\\rangle\\}$), where $|\\pm\\rangle = (|0\\rangle \\pm |1\\rangle)/\\sqrt{2}$. From this comparison, they determine the quantum bit error rate (QBER) in the X-basis, denoted as $Q_X$.\n\nA crucial quantity for security is the conditional min-entropy of Alice's bit given Eve's quantum side-information, $H_{min}(A|E)$. This quantifies the unpredictability of Alice's bit from Eve's perspective. The secret key rate is directly proportional to a lower bound on this quantity.\n\nA powerful tool for this analysis is the entropic uncertainty relation with quantum side information. For any tripartite pure state $|\\Psi\\rangle_{ABE}$, the conditional von Neumann entropies of Alice's measurement outcomes for the Z and X bases are bounded as follows:\n$$S(Z_A|E) + S(X_A|B) \\ge 1$$\nHere, $S(M_A|S)$ is the conditional von Neumann entropy of Alice's outcome for measurement $M$ (where $M \\in \\{X, Z\\}$) given the system $S$ (where $S \\in \\{B, E\\}$). All entropies are calculated using the base-2 logarithm.\n\n**Problem:**\nAssuming that (i) the effective quantum channel between Alice and Bob in the X-basis behaves as a binary symmetric channel with crossover (error) probability $Q_X$, and (ii) for the purpose of deriving a security bound, the conditional von Neumann entropy $S(A|E)$ serves as a tight lower bound for the conditional min-entropy $H_{min}(A|E)$, determine the lower bound on $H_{min}(A|E)$ as a function of the observed QBER, $Q_X$. Express your answer in terms of $Q_X$ and the base-2 logarithm.", "solution": "We are given the entropic uncertainty relation for the conditional von Neumann entropies:\n$$ S(Z_A|E) + S(X_A|B) \\geq 1 $$\nwhere $S(M_A|S)$ is the conditional von Neumann entropy of Alice's outcome for measurement $M$ given system $S$, and the entropies are in base-2.\n\nThe goal is to find a lower bound on the conditional min-entropy $H_{\\min}(A|E)$, which is bounded below by $S(Z_A|E)$ (as per the problem statement). Thus, we focus on bounding $S(Z_A|E)$.\n\nFrom the uncertainty relation:\n$$ S(Z_A|E) \\geq 1 - S(X_A|B) $$\n\nWe now express $S(X_A|B)$ in terms of the quantum bit error rate $Q_X$. The problem states that the effective quantum channel in the X-basis is a binary symmetric channel with crossover probability $Q_X$. This means:\n- Alice prepares a bit $a \\in \\{0,1\\}$ uniformly in the X-basis, so $P(X_A = a) = \\frac{1}{2}$.\n- Bob's outcome $b \\in \\{0,1\\}$ satisfies $P(X_B = b \\mid X_A = a) = \\begin{cases} 1 - Q_X & \\text{if } b = a \\\\ Q_X & \\text{if } b \\neq a \\end{cases}$.\n\nThe joint probability distribution is:\n$$ P(X_A = 0, X_B = 0) = \\frac{1}{2}(1 - Q_X), \\quad P(X_A = 0, X_B = 1) = \\frac{1}{2}Q_X $$\n$$ P(X_A = 1, X_B = 0) = \\frac{1}{2}Q_X, \\quad P(X_A = 1, X_B = 1) = \\frac{1}{2}(1 - Q_X) $$\n\nThe conditional von Neumann entropy $S(X_A|B)$ for this classical-quantum state (where $X_A$ is classical and $B$ is quantum, but the states are diagonal in the X-basis) equals the classical conditional entropy $H(X_A | X_B)$, because Bob's measurement in the X-basis yields classical outcomes that capture the relevant information.\n\nThe marginal distribution for $X_B$ is:\n$$ P(X_B = 0) = P(X_A=0, X_B=0) + P(X_A=1, X_B=0) = \\frac{1}{2}(1 - Q_X) + \\frac{1}{2}Q_X = \\frac{1}{2} $$\n$$ P(X_B = 1) = \\frac{1}{2} $$\n\nThe conditional entropy $H(X_A | X_B = b)$ is:\n- For $X_B = 0$:\n  $$ P(X_A = 0 | X_B = 0) = \\frac{P(X_A=0, X_B=0)}{P(X_B=0)} = 1 - Q_X $$\n  $$ P(X_A = 1 | X_B = 0) = Q_X $$\n  The entropy is $h_2(Q_X) = -Q_X \\log_2 Q_X - (1 - Q_X) \\log_2 (1 - Q_X)$ (binary entropy function).\n- For $X_B = 1$:\n  $$ P(X_A = 0 | X_B = 1) = Q_X $$\n  $$ P(X_A = 1 | X_B = 1) = 1 - Q_X $$\n  The entropy is also $h_2(Q_X)$.\n\nThus:\n$$ H(X_A | X_B) = P(X_B=0) h_2(Q_X) + P(X_B=1) h_2(Q_X) = \\frac{1}{2} h_2(Q_X) + \\frac{1}{2} h_2(Q_X) = h_2(Q_X) $$\nTherefore:\n$$ S(X_A|B) = h_2(Q_X) = -Q_X \\log_2 Q_X - (1 - Q_X) \\log_2 (1 - Q_X) $$\n\nSubstituting into the uncertainty relation:\n$$ S(Z_A|E) \\geq 1 - h_2(Q_X) = 1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X) $$\n\nSince $H_{\\min}(A|E) \\geq S(Z_A|E)$ (as a tight lower bound per the problem), we have:\n$$ H_{\\min}(A|E) \\geq 1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X) $$\n\nThis is the lower bound in terms of $Q_X$ and base-2 logarithms.", "answer": "$$ \\boxed{1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X)} $$", "id": "143203"}]}