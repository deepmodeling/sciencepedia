{"hands_on_practices": [{"introduction": "The security of the E91 protocol hinges on verifying the quantum nature of the correlations between Alice and Bob's measurements. This is achieved by performing a Bell test and checking for a violation of the Clauser-Horne-Shimony-Holt (CHSH) inequality. This first exercise [@problem_id:152753] provides a foundational calculation of the CHSH value for an ideal singlet state, demonstrating the maximal violation predicted by quantum mechanics and establishing the benchmark against which security is assessed.", "problem": "The E91 quantum key distribution protocol, proposed by Artur Ekert in 1991, leverages the properties of quantum entanglement to ensure secure communication. A key part of the protocol involves two parties, Alice and Bob, performing a Bell test on shared pairs of entangled qubits to verify the security of their quantum channel. This test checks for a violation of the Clauser-Horne-Shimony-Holt (CHSH) inequality, which is a necessary condition for the correlations to be explainable by local hidden-variable theories.\n\nSuppose Alice and Bob share a great number of qubit pairs, each prepared in the singlet state:\n$$|\\psi^{-}\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\nTo perform the Bell test, Alice and Bob each measure the spin of their respective qubit along one of two chosen directions. The measurement operator for a spin projection along a direction vector $\\vec{u}$ in the x-z plane making an angle $\\theta$ with the positive z-axis is given by $\\sigma(\\theta) = \\vec{u} \\cdot \\vec{\\sigma} = \\sin\\theta \\, \\sigma_x + \\cos\\theta \\, \\sigma_z$, where $\\vec{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices.\n\nAlice randomly chooses between two measurement settings, $A = \\sigma(\\theta_A)$ and $A' = \\sigma(\\theta_{A'})$, with angles $\\theta_A = 0$ and $\\theta_{A'} = \\pi/2$.\nSimilarly, Bob randomly chooses between his two settings, $B = \\sigma(\\theta_B)$ and $B' = \\sigma(\\theta_{B'})$, with angles $\\theta_B = \\pi/4$ and $\\theta_{B'} = 3\\pi/4$.\n\nThe CHSH parameter, $S$, is constructed from the expectation values of the products of these measurements:\n$$S = E(A, B) - E(A, B') + E(A', B) + E(A', B')$$\nwhere, for example, $E(A, B) = \\langle \\psi^{-} | A \\otimes B | \\psi^{-} \\rangle$. Calculate the value of $S$ for the given state and measurement settings.", "solution": "The singlet state is given by:\n$$|\\psi^{-}\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\n\nThe measurement operators are defined as $\\sigma(\\theta) = \\sin\\theta \\, \\sigma_x + \\cos\\theta \\, \\sigma_z$. For Alice:\n- $A = \\sigma(0) = \\cos(0) \\, \\sigma_z = \\sigma_z$ (since $\\sin(0)=0$)\n- $A' = \\sigma(\\pi/2) = \\sin(\\pi/2) \\, \\sigma_x = \\sigma_x$ (since $\\cos(\\pi/2)=0$)\n\nFor Bob:\n- $B = \\sigma(\\pi/4) = \\sin(\\pi/4) \\, \\sigma_x + \\cos(\\pi/4) \\, \\sigma_z = \\frac{\\sqrt{2}}{2} (\\sigma_x + \\sigma_z)$\n- $B' = \\sigma(3\\pi/4) = \\sin(3\\pi/4) \\, \\sigma_x + \\cos(3\\pi/4) \\, \\sigma_z = \\frac{\\sqrt{2}}{2} (\\sigma_x - \\sigma_z)$\n\nThe expectation value for the singlet state is given by:\n$$\\langle \\psi^{-} | (\\vec{a} \\cdot \\vec{\\sigma}) \\otimes (\\vec{b} \\cdot \\vec{\\sigma}) | \\psi^{-} \\rangle = -\\vec{a} \\cdot \\vec{b}$$\nwhere $\\vec{a}$ and $\\vec{b}$ are unit vectors in the directions of the measurements.\n\nThe direction vectors in the x-z plane are:\n- For $A$: $\\vec{a}_A = (0, 0, 1)$ (along z-axis)\n- For $A'$: $\\vec{a}_{A'} = (1, 0, 0)$ (along x-axis)\n- For $B$: $\\vec{b}_B = (\\sin(\\pi/4), 0, \\cos(\\pi/4)) = \\left( \\frac{\\sqrt{2}}{2}, 0, \\frac{\\sqrt{2}}{2} \\right)$\n- For $B'$: $\\vec{b}_{B'} = (\\sin(3\\pi/4), 0, \\cos(3\\pi/4)) = \\left( \\frac{\\sqrt{2}}{2}, 0, -\\frac{\\sqrt{2}}{2} \\right)$\n\nNow compute each expectation value:\n- $E(A, B) = -\\vec{a}_A \\cdot \\vec{b}_B = - \\left[ (0)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (1)\\left(\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n- $E(A, B') = -\\vec{a}_A \\cdot \\vec{b}_{B'} = - \\left[ (0)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (1)\\left(-\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\left(-\\frac{\\sqrt{2}}{2}\\right) = \\frac{\\sqrt{2}}{2}$\n- $E(A', B) = -\\vec{a}_{A'} \\cdot \\vec{b}_B = - \\left[ (1)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (0)\\left(\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n- $E(A', B') = -\\vec{a}_{A'} \\cdot \\vec{b}_{B'} = - \\left[ (1)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (0)\\left(-\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n\nThe CHSH parameter is:\n$$S = E(A, B) - E(A, B') + E(A', B) + E(A', B')$$\nSubstitute the values:\n$$S = \\left(-\\frac{\\sqrt{2}}{2}\\right) - \\left(\\frac{\\sqrt{2}}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right) = -\\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} = -4 \\cdot \\frac{\\sqrt{2}}{2} = -2\\sqrt{2}$$", "answer": "$$\\boxed{-2\\sqrt{2}}$$", "id": "152753"}, {"introduction": "Having established the ideal CHSH value, we now turn to the central security claim of the E91 protocol: the ability to detect an eavesdropper. This practice [@problem_id:152778] models a common eavesdropping strategy, the intercept-resend attack, where Eve measures the qubit sent to Bob and forwards a new one. By calculating the CHSH value under this attack, you will see how Eve's intervention inevitably disturbs the quantum correlations in a detectable way.", "problem": "In the E91 protocol for quantum key distribution, Alice and Bob share a large number of entangled qubit pairs to establish a secret key. A crucial part of the protocol is to test for the presence of an eavesdropper (Eve) by checking for a violation of a Bell inequality on a subset of the shared pairs.\n\nConsider that the source produces pairs of qubits in the singlet state:\n$$|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\nOne qubit is sent to Alice, and the other to Bob. To test the security of the channel, they perform measurements according to the Clauser-Horne-Shimony-Holt (CHSH) formalism. Alice chooses between two measurement observables, $A_1$ and $A_2$, and Bob chooses between $B_1$ and $B_2$. The observables are defined as follows:\n- Alice's observables: $A_1 = \\sigma_Z$, $A_2 = \\sigma_X$\n- Bob's observables: $B_1 = \\frac{1}{\\sqrt{2}}(\\sigma_Z + \\sigma_X)$, $B_2 = \\frac{1}{\\sqrt{2}}(-\\sigma_Z + \\sigma_X)$\n\nwhere $\\sigma_X, \\sigma_Y, \\sigma_Z$ are the standard Pauli matrices. The effectiveness of the test is quantified by the CHSH value $S$, defined as:\n$$S = \\langle A_1 B_1 \\rangle - \\langle A_1 B_2 \\rangle + \\langle A_2 B_1 \\rangle + \\langle A_2 B_2 \\rangle$$\nwhere $\\langle \\cdot \\rangle$ denotes the expectation value with respect to the shared quantum state. For a pure singlet state, these settings yield $S = -2\\sqrt{2}$, maximally violating the classical bound of $|S| \\le 2$.\n\nNow, suppose an eavesdropper, Eve, performs an intercept-resend attack on the channel to Bob. For every qubit traveling from the source to Bob, Eve intercepts it, measures it in the computational basis $\\{|0\\rangle, |1\\rangle\\}$, and then sends a new qubit to Bob prepared in the state corresponding to her measurement outcome. Specifically, if Eve measures the qubit in the state $|0\\rangle$, she sends a fresh qubit in the state $|0\\rangle$ to Bob. If she measures $|1\\rangle$, she sends $|1\\rangle$.\n\nCalculate the value of the CHSH parameter $S$ that Alice and Bob would observe under this specific intercept-resend attack.", "solution": "We first determine the post-attack state $\\rho_{AB}$ that Alice and Bob share. Eve measures Bob’s qubit in the computational basis and resends that outcome. For the singlet state, a computational-basis measurement on Bob collapses Alice’s qubit to the opposite computational state. Thus with probability $\\frac{1}{2}$ they end up in $|1\\rangle_A|0\\rangle_B$, and with probability $\\frac{1}{2}$ in $|0\\rangle_A|1\\rangle_B$. Hence\n$$ \\rho_{AB} = \\frac{1}{2}(|1,0\\rangle\\langle 1,0| + |0,1\\rangle\\langle 0,1|) . $$\n\nWe now compute each correlator.\n1.  $\\langle A_1B_1\\rangle$ with $A_1=\\sigma_Z$ and $B_1=\\frac{1}{\\sqrt{2}}(\\sigma_Z+\\sigma_X)$. For a product state like $|1,0\\rangle$, the expectation value separates: $\\langle \\sigma_Z \\otimes B_1 \\rangle = \\langle \\sigma_Z \\rangle_A \\langle B_1 \\rangle_B$.\n   For $|1,0\\rangle$:\n   $\\langle\\sigma_Z\\rangle_A=-1$, $\\langle\\sigma_Z\\rangle_B=+1$, $\\langle\\sigma_X\\rangle_B=0 \\Longrightarrow \\langle B_1\\rangle=\\frac{1}{\\sqrt{2}}(1+0)=\\frac{1}{\\sqrt{2}}$.\n   The product is $(-1) \\cdot \\frac{1}{\\sqrt{2}} = -\\frac{1}{\\sqrt{2}}$.\n   For $|0,1\\rangle$:\n   $\\langle\\sigma_Z\\rangle_A=+1$, $\\langle\\sigma_Z\\rangle_B=-1$, $\\langle\\sigma_X\\rangle_B=0 \\Longrightarrow \\langle B_1\\rangle=-\\frac{1}{\\sqrt{2}}$.\n   The product is $(+1) \\cdot (-\\frac{1}{\\sqrt{2}}) = -\\frac{1}{\\sqrt{2}}$.\n   Averaging the two outcomes gives:\n   $$ \\langle A_1B_1\\rangle = \\frac{1}{2}\\left(-\\frac{1}{\\sqrt{2}} - \\frac{1}{\\sqrt{2}}\\right) = -\\frac{1}{\\sqrt{2}} . $$\n\n2.  $\\langle A_1B_2\\rangle$ with $B_2=\\frac{1}{\\sqrt{2}}(-\\sigma_Z+\\sigma_X)$.\n   For $|1,0\\rangle$:\n   $\\langle B_2\\rangle=\\frac{1}{\\sqrt{2}}(-1+0)=-\\frac{1}{\\sqrt{2}}$. The product with $\\langle\\sigma_Z\\rangle_A=-1$ is $(-1)(-\\frac{1}{\\sqrt{2}})=+\\frac{1}{\\sqrt{2}}$.\n   For $|0,1\\rangle$:\n   $\\langle B_2\\rangle=\\frac{1}{\\sqrt{2}}(+1+0)=\\frac{1}{\\sqrt{2}}$. The product with $\\langle\\sigma_Z\\rangle_A=+1$ is $(+1)(+\\frac{1}{\\sqrt{2}})=+\\frac{1}{\\sqrt{2}}$.\n   Averaging gives:\n   $$ \\langle A_1B_2\\rangle = \\frac{1}{2}\\left(\\frac{1}{\\sqrt{2}}+\\frac{1}{\\sqrt{2}}\\right) = +\\frac{1}{\\sqrt{2}} . $$\n\n3.  $\\langle A_2B_1\\rangle$ with $A_2=\\sigma_X$. On $|0\\rangle$ or $|1\\rangle$, $\\langle\\sigma_X\\rangle=0$, so:\n   $$ \\langle A_2B_1\\rangle=0, \\qquad \\langle A_2B_2\\rangle=0 . $$\n\nFinally the CHSH parameter:\n$$ S=\\langle A_1B_1\\rangle-\\langle A_1B_2\\rangle+\\langle A_2B_1\\rangle+\\langle A_2B_2\\rangle = -\\frac{1}{\\sqrt{2}}-\\frac{1}{\\sqrt{2}}+0+0 = -\\frac{2}{\\sqrt{2}}=-\\sqrt{2} . $$", "answer": "$$\\boxed{-\\sqrt{2}}$$", "id": "152778"}, {"introduction": "Moving beyond idealized scenarios, it is crucial to understand how the E91 protocol performs in the presence of real-world imperfections. This exercise [@problem_id:152873] models the effect of environmental noise by subjecting one of the entangled qubits to a depolarizing channel. Calculating the maximum achievable CHSH value as a function of the noise strength reveals the protocol's robustness and helps determine the critical noise threshold beyond which secure key distribution is no longer possible.", "problem": "In the E91 protocol for quantum key distribution, Alice and Bob share a large number of entangled two-qubit pairs. To ensure the security of their communication channel, they perform a statistical test on a subset of these pairs to check for violations of a Bell inequality, typically the Clauser-Horne-Shimony-Holt (CHSH) inequality. A significant violation confirms the presence of quantum correlations and bounds the information an eavesdropper could have gained.\n\nSuppose Alice and Bob ideally share pairs in the singlet state $|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$. However, the quantum channel is noisy. Specifically, Bob's qubit of each pair is subjected to a depolarizing channel before his measurement. The single-qubit depolarizing channel $\\mathcal{E}_p$ is described by its action on an arbitrary single-qubit state $\\rho_B$:\n$$ \\mathcal{E}_p(\\rho_B) = (1-p)\\rho_B + p \\frac{I_B}{2} $$\nwhere $p$ is the depolarization probability ($0 \\le p \\le 1$) and $I_B$ is the identity operator on Bob's Hilbert space.\n\nAlice and Bob perform measurements of spin projections along chosen directions. These measurements correspond to observables $A_i = \\vec{a}_i \\cdot \\vec{\\sigma}$ for Alice and $B_j = \\vec{b}_j \\cdot \\vec{\\sigma}$ for Bob, where $\\vec{a}_i$ and $\\vec{b}_j$ are unit vectors in $\\mathbb{R}^3$ and $\\vec{\\sigma}=(\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices. They use two measurement settings each ($i, j \\in \\{1, 2\\}$) to test the CHSH inequality. The CHSH value is the expectation value of the operator:\n$$ S = A_1 \\otimes B_1 - A_1 \\otimes B_2 + A_2 \\otimes B_1 + A_2 \\otimes B_2 $$\nCalculate the maximum possible value of $\\langle S \\rangle$, maximized over all possible measurement directions $(\\vec{a}_1, \\vec{a}_2, \\vec{b}_1, \\vec{b}_2)$, as a function of the depolarization probability $p$.", "solution": "The initial state is the singlet state:\n\n$$\n|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle), \\quad \\rho_{AB} = |\\psi^-\\rangle\\langle\\psi^-|.\n$$\n\nAfter the depolarizing channel acts on Bob's qubit, the state becomes:\n\n$$\n\\rho_{AB}' = (I_A \\otimes \\mathcal{E}_p)(\\rho_{AB}) = (1-p) \\rho_{AB} + p \\left( \\operatorname{Tr}_B(\\rho_{AB}) \\otimes \\frac{I_B}{2} \\right),\n$$\n\nsince the reduced state for Alice is $\\rho_A = \\operatorname{Tr}_B(\\rho_{AB}) = I_A / 2$. The total state is $\\rho_{AB}' = (1-p)\\rho_{AB} + p \\frac{I_A}{2} \\otimes \\frac{I_B}{2} = (1-p)\\rho_{AB} + p \\frac{I_{AB}}{4}$.\n\nThe expectation value of an operator $O$ is:\n\n$$\n\\langle O \\rangle = \\operatorname{Tr}(\\rho_{AB}' O) = (1-p) \\operatorname{Tr}(\\rho_{AB} O) + p \\operatorname{Tr}\\left( \\frac{I_{AB}}{4} O \\right).\n$$\n\nFor the CHSH operator $S$, each term $A_i \\otimes B_j$ has trace zero because $A_i = \\vec{a}_i \\cdot \\vec{\\sigma}$ and $B_j = \\vec{b}_j \\cdot \\vec{\\sigma}$ are traceless (Pauli matrices are traceless). Thus:\n\n$$\n\\operatorname{Tr}(A_i \\otimes B_j) = \\operatorname{Tr}(A_i) \\operatorname{Tr}(B_j) = 0,\n$$\nwhich means $\\operatorname{Tr}(S) = 0$. Therefore, the second term in the expectation value vanishes:\n$$\n\\langle S \\rangle = (1-p) \\langle S \\rangle_0,\n$$\nwhere $\\langle \\cdot \\rangle_0$ denotes the expectation in the pure singlet state. To maximize $\\langle S \\rangle$, we need to maximize $\\langle S \\rangle_0$, as $(1-p) \\ge 0$.\n\nIn the singlet state, the correlation for arbitrary spin measurements is:\n$$\n\\langle A_i \\otimes B_j \\rangle_0 = \\langle (\\vec{a}_i \\cdot \\vec{\\sigma}) \\otimes (\\vec{b}_j \\cdot \\vec{\\sigma}) \\rangle_0 = -\\vec{a}_i \\cdot \\vec{b}_j.\n$$\n\nTherefore, the CHSH expectation is:\n\n$$\n\\langle S \\rangle_0 = \\langle A_1 B_1 \\rangle_0 - \\langle A_1 B_2 \\rangle_0 + \\langle A_2 B_1 \\rangle_0 + \\langle A_2 B_2 \\rangle_0 = -(\\vec{a}_1 \\cdot \\vec{b}_1) - (-\\vec{a}_1 \\cdot \\vec{b}_2) + (-\\vec{a}_2 \\cdot \\vec{b}_1) + (-\\vec{a}_2 \\cdot \\vec{b}_2)\n$$\n$$\n\\langle S \\rangle_0 = -\\vec{a}_1 \\cdot \\vec{b}_1 + \\vec{a}_1 \\cdot \\vec{b}_2 - \\vec{a}_2 \\cdot \\vec{b}_1 - \\vec{a}_2 \\cdot \\vec{b}_2 = \\vec{a}_1 \\cdot (\\vec{b}_2 - \\vec{b}_1) - \\vec{a}_2 \\cdot (\\vec{b}_1 + \\vec{b}_2).\n$$\nTo maximize this value over all unit vectors, we can choose $\\vec{a}_1 = (\\vec{b}_2 - \\vec{b}_1)/|\\vec{b}_2 - \\vec{b}_1|$ and $\\vec{a}_2 = -(\\vec{b}_1 + \\vec{b}_2)/|\\vec{b}_1 + \\vec{b}_2|$. This gives:\n$$\n\\max_{\\vec{a}_1, \\vec{a}_2} \\langle S \\rangle_0 = |\\vec{b}_2 - \\vec{b}_1| + |\\vec{b}_1 + \\vec{b}_2|.\n$$\nLet $\\theta$ be the angle between $\\vec{b}_1$ and $\\vec{b}_2$. Then $|\\vec{b}_1 \\cdot \\vec{b}_2| = \\cos\\theta$.\n$$|\\vec{b}_2 - \\vec{b}_1|^2 = |\\vec{b}_2|^2 + |\\vec{b}_1|^2 - 2\\vec{b}_1 \\cdot \\vec{b}_2 = 2 - 2\\cos\\theta$$\n$$|\\vec{b}_1 + \\vec{b}_2|^2 = |\\vec{b}_1|^2 + |\\vec{b}_2|^2 + 2\\vec{b}_1 \\cdot \\vec{b}_2 = 2 + 2\\cos\\theta$$\nThe expression to maximize is $\\sqrt{2 - 2\\cos\\theta} + \\sqrt{2 + 2\\cos\\theta}$. Let's find the maximum of $f(\\theta) = \\sqrt{1 - \\cos\\theta} + \\sqrt{1 + \\cos\\theta}$. By Cauchy-Schwarz, or by squaring the function, we find the maximum is at $\\cos\\theta = 0$ (i.e., $\\vec{b}_1 \\perp \\vec{b}_2$).\nAt $\\theta = \\pi/2$, $f(\\pi/2) = \\sqrt{1} + \\sqrt{1} = 2$.\nSo, $\\max (|\\vec{b}_2 - \\vec{b}_1| + |\\vec{b}_1 + \\vec{b}_2|) = \\sqrt{2} \\cdot 2 = 2\\sqrt{2}$.\n\nThus, the maximum value for the CHSH operator in the singlet state is $2\\sqrt{2}$. This can also be achieved with the other sign, yielding $-2\\sqrt{2}$. The question asks for the maximum possible value, which is $2\\sqrt{2}$.\nTherefore, the maximum possible value of $\\langle S \\rangle$ for the noisy state is:\n$$\n\\max \\langle S \\rangle = (1-p) \\cdot 2\\sqrt{2} = 2\\sqrt{2} (1-p).\n$$", "answer": "$$ \\boxed{2\\sqrt{2}\\left(1 - p\\right)} $$", "id": "152873"}]}