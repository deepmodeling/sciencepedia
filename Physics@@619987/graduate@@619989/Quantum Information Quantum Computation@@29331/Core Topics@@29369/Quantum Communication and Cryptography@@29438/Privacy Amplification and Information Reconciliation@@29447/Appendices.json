{"hands_on_practices": [{"introduction": "The security of a secret key is fundamentally tied to its unpredictability from an adversary's perspective, a concept formally captured by min-entropy. Any information leaked during a protocol can reduce this entropy, thereby weakening the key's security. This first exercise provides a direct and tangible example of how even a single bit of public information can impact the key's quality, offering a foundational understanding of information leakage [@problem_id:110589].", "problem": "In a quantum key distribution (QKD) protocol, after the phases of quantum communication, sifting, and information reconciliation, Alice and Bob share a secret key $X \\in \\{0,1\\}^n$ which they believe to be identical. From their perspective, the key $X$ is a uniformly random bit string of length $n$.\n\nAn eavesdropper, Eve, has been monitoring the process. Her side information on the key is modeled as follows: she has perfectly learned the first $k$ bits of the key, where $0 \\le k < n$. The remaining $n-k$ bits are completely unknown to her, meaning that from her perspective, they are uniformly random. The security of the final key is quantified by its min-entropy conditioned on Eve's knowledge. The min-entropy of a key $K$ given side information $E$ is defined as $H_{\\min}(K|E) = -\\log_2 P_{\\text{guess}}(K|E)$, where $P_{\\text{guess}}(K|E)$ is the maximum probability with which an adversary possessing knowledge $E$ can guess the value of $K$.\n\nBefore performing privacy amplification, Alice and Bob decide to perform an additional, but flawed, error-verification step. They generate a publicly accessible random bit string $R \\in \\{0,1\\}^n$. Alice then computes the Hamming distance $d(X, R)$ between her key $X$ and the public string $R$. Finally, she publicly announces the parity of this Hamming distance, i.e., she broadcasts the single bit $Z = d(X, R) \\pmod 2$.\n\nCalculate the final min-entropy of the key $X$ from Eve's perspective after she incorporates the knowledge of the publicly announced bit $Z$. Express your answer in terms of $n$ and $k$.", "solution": "1. Relevant definitions and known facts  \nAlice’s key $X\\in\\{0,1\\}^n$ is uniform. Eve’s side information $E$ consists of the first $k$ bits of $X$, so she knows $X_1,\\dots,X_k$ exactly and has no information on the remaining $m=n-k$ bits, which are uniform from her perspective.  \nThe conditional min-entropy before leakage is  \n$$\nH_{\\min}(X\\mid E)\\;=\\;-\\log_2P_{\\rm guess}(X\\mid E)\n=\\;-\\log_2\\Bigl(2^{-(n-k)}\\Bigr)\n=\\;n-k\\,.\n$$\n\n2. Public leakage via $Z$  \nAlice announces \n$$\nZ \\;=\\;\\bigl[d(X,R)\\bmod2\\bigr]\n=\\;\\Bigl(\\sum_{i=1}^n (X_i\\oplus R_i)\\Bigr)\\bmod2.\n$$\nSince $R$ is public, define the known constant\n$$\nc=\\sum_{i=1}^nR_i\\pmod2,\n$$\nso\n$$\nZ=c+\\sum_{i=1}^nX_i\\pmod2\n\\quad\\Longrightarrow\\quad\n\\sum_{i=1}^nX_i\\pmod2=Z-c.\n$$\n\n3. Effect on the unknown bits  \nSplit the sum over known and unknown bits:\n$$\n\\sum_{i=1}^nX_i\n=\\sum_{i=1}^kX_i+\\sum_{i=k+1}^nX_i.\n$$\nThe term $\\sum_{i=1}^kX_i$ is known to Eve; denote its value by $d$.  Hence  \n$$\n\\sum_{i=k+1}^nX_i\\pmod2\n=Z-c-d\\;=\\;z',\n$$\nwhich is a single linear (parity) constraint on the $m=n-k$ unknown bits.  A uniform string of length $m$ subject to one parity constraint has support size $2^{m-1}$.\n\n4. Final guessing probability and min-entropy  \nAfter learning $Z$, Eve’s best guess has success probability\n$$\nP_{\\rm guess}(X\\mid E,Z)=\\frac1{2^{m-1}}=\\;2^{-(n-k-1)}.\n$$\nThus the conditional min-entropy is\n$$\nH_{\\min}(X\\mid E,Z)\n=-\\log_2P_{\\rm guess}(X\\mid E,Z)\n=n-k-1.\n$$", "answer": "$$\\boxed{\\,n-k-1\\,}$$", "id": "110589"}, {"introduction": "Information reconciliation protocols are the engines that correct errors in raw keys, with Low-Density Parity-Check (LDPC) codes being a popular and powerful choice due to their excellent performance. To understand their effectiveness, we must analyze their decoding algorithms. This practice invites you to analyze the performance of the iterative Belief Propagation decoder on a Binary Erasure Channel, a standard model for reconciliation scenarios, thereby linking the code's structure to its error-correction capability [@problem_id:110643].", "problem": "In quantum key distribution (QKD), information reconciliation is a crucial step where two parties, Alice and Bob, correct errors in their shared, sifted key. This is often accomplished using classical error-correcting codes, such as Low-Density Parity-Check (LDPC) codes. The performance of these codes is typically analyzed over a simplified channel model relevant to the errors observed in the sifted key.\n\nAn LDPC code is a linear block code defined by a sparse binary parity-check matrix $H$. Its structure is conveniently represented by a Tanner graph, a bipartite graph with variable nodes representing the codeword bits and check nodes representing the parity-check equations. An edge connects a variable node $v_i$ to a check node $c_j$ if bit $i$ participates in check equation $j$.\n\nConsider a scenario where the shared key is modeled as a codeword transmitted over a Binary Erasure Channel (BEC), which erases each bit with a probability $p$ and transmits it correctly with probability $1-p$. To recover the erased bits (i.e., decode the codeword), an iterative message-passing algorithm called Belief Propagation (BP) is used. In the context of a BEC, the BP algorithm works as follows:\n- An erased variable node is recovered if at least one of its adjacent check nodes provides its correct value.\n- A check node can determine the value of an adjacent erased variable node if and only if all other variable nodes participating in that same check equation are known (i.e., not erased).\n\nConsider a specific regular (2,4) LDPC code, meaning every variable node has degree 2 and every check node has degree 4. The code has $N=8$ variable nodes, denoted $\\{v_1, \\dots, v_8\\}$, and $M=4$ check nodes, denoted $\\{c_1, \\dots, c_4\\}$. The Tanner graph of the code is defined by the following connectivity:\n- $c_1$ is connected to $\\{v_1, v_2, v_3, v_4\\}$.\n- $c_2$ is connected to $\\{v_5, v_6, v_7, v_8\\}$.\n- $c_3$ is connected to $\\{v_1, v_2, v_5, v_6\\}$.\n- $c_4$ is connected to $\\{v_3, v_4, v_7, v_8\\}$.\n\nA codeword generated from this code is sent over a BEC with erasure probability $p$. Your task is to calculate the probability that a randomly chosen variable node, given that it was initially erased, remains unrecovered after a single iteration of the belief propagation algorithm. Provide the answer as a closed-form analytical expression in terms of $p$.", "solution": "The problem involves a (2,4) regular LDPC code with $N=8$ variable nodes and $M=4$ check nodes. The Tanner graph is defined by:\n- $c_1$ connected to $\\{v_1, v_2, v_3, v_4\\}$\n- $c_2$ connected to $\\{v_5, v_6, v_7, v_8\\}$\n- $c_3$ connected to $\\{v_1, v_2, v_5, v_6\\}$\n- $c_4$ connected to $\\{v_3, v_4, v_7, v_8\\}$\n\nEach variable node has degree 2. The goal is to find the probability that a randomly chosen variable node, given it was initially erased on a BEC with erasure probability $p$, remains unrecovered after one iteration of the belief propagation algorithm.\n\nFor a variable node $v_i$ that is erased, it can be recovered if at least one of its adjacent check nodes provides its value. A check node $c_j$ adjacent to $v_i$ can recover $v_i$ only if all other variable nodes connected to $c_j$ are known (not erased).\n\nConsider an erased variable node $v_i$. Let $c_A$ and $c_B$ be its two adjacent check nodes. Define:\n- Event $A$: The three other variable nodes in $c_A$ are known.\n- Event $B$: The three other variable nodes in $c_B$ are known.\n\n$v_i$ is recovered if at least one of $A$ or $B$ occurs. The probability that $v_i$ remains unrecovered is:\n$$\nP(\\text{unrecovered} \\mid \\text{erased}) = 1 - P(A \\cup B \\mid \\text{erased})\n$$\nBy inclusion-exclusion:\n$$\nP(A \\cup B \\mid \\text{erased}) = P(A \\mid \\text{erased}) + P(B \\mid \\text{erased}) - P(A \\cap B \\mid \\text{erased})\n$$\n\nThe erasures are independent, and conditioning on $v_i$ being erased does not affect other nodes. Thus:\n$$\nP(A \\mid \\text{erased}) = P(\\text{three specific nodes known}) = (1-p)^3\n$$\nSimilarly, $P(B \\mid \\text{erased}) = (1-p)^3$.\n\nThe sets for $A$ and $B$ share exactly one common variable node. For example:\n- For $v_1$: $c_A = c_1$ (others: $\\{v_2, v_3, v_4\\}$), $c_B = c_3$ (others: $\\{v_2, v_5, v_6\\}$), sharing $v_2$.\n- Similarly, every $v_i$ has two sets of three other nodes sharing one node, so $A \\cap B$ requires five distinct nodes to be known.\n\nThus:\n$$\nP(A \\cap B \\mid \\text{erased}) = (1-p)^5\n$$\n\nSubstituting:\n$$\nP(A \\cup B \\mid \\text{erased}) = (1-p)^3 + (1-p)^3 - (1-p)^5 = 2(1-p)^3 - (1-p)^5\n$$\n\nTherefore:\n$$\nP(\\text{unrecovered} \\mid \\text{erased}) = 1 - \\left[ 2(1-p)^3 - (1-p)^5 \\right] = 1 - 2(1-p)^3 + (1-p)^5\n$$\n\nThis expression holds for any variable node due to symmetry.", "answer": "$$ \\boxed{1 - 2(1-p)^3 + (1-p)^5} $$", "id": "110643"}, {"introduction": "A robust security analysis must account not just for random noise but also for malicious, active adversaries. Building on the analysis of LDPC codes, this final practice explores a more advanced threat model where an attacker deliberately corrupts the public communication. You will determine how the graphical structure of the code, specifically its node degrees and girth, directly dictates the system's vulnerability and the extent of the damage an attacker can inflict [@problem_id:110732].", "problem": "In a quantum key distribution (QKD) system, Alice and Bob perform information reconciliation on their sifted keys using a Low-Density Parity-Check (LDPC) code of block length $n$. The code is defined by a parity-check matrix $H$ which can be represented as a bipartite Tanner graph. The code is regular, with all variable nodes having degree $d_v$ and all check nodes having degree $d_c$. You are given that $d_v$ is an odd integer and the girth (length of the shortest cycle) of the Tanner graph is $g$.\n\nDuring reconciliation, Alice sends the syndrome $S=HE^T$ to Bob over a public channel, where $E$ is the initial error vector between their keys. An active adversary, Eve, intercepts the syndrome and corrupts it by flipping a single bit, corresponding to an arbitrary check node $c_k$. Bob receives the corrupted syndrome $S'$. Assume the initial quantum bit error rate (QBER) is low enough that the original error vector $E$ would have been perfectly correctable. Hence, the final error vector between Alice and Bob's reconciled keys is solely due to Eve's tampering.\n\nBob's decoder, upon receiving the corrupted syndrome $S'$, is assumed to find the error pattern of minimum possible Hamming weight, denoted as $\\Delta E$, that is consistent with the corruption. That is, $\\Delta E$ is the minimum weight binary vector satisfying $H(\\Delta E)^T = e_k$, where $e_k$ is the standard basis vector with a '1' at the position corresponding to the attacked check node $c_k$.\n\nThe support of this minimal error vector, $\\Delta E$, forms a specific structure in the Tanner graph. This structure consists of:\n1. A single \"central\" variable node, $v_0$, which is a neighbor of the attacked check node $c_k$.\n2. The other $d_v-1$ check nodes adjacent to $v_0$ are denoted $\\{c_1, c_2, \\ldots, c_{d_v-1}\\}$. These must be \"satisfied\" by the error pattern. This is achieved by introducing additional variable nodes that form disjoint paths between pairs of these check nodes. Since $d_v-1$ is even, these check nodes can be perfectly paired up.\n3. There are $(d_v-1)/2$ such paths. The variable nodes in the support of $\\Delta E$ are the central node $v_0$ plus all variable nodes lying on these $(d_v-1)/2$ paths.\n4. It is given that the shortest path between any two check nodes $c_i, c_j$ that share a common adjacent variable node $v_0$ is part of a girth cycle of length $g$ that contains $v_0, c_i,$ and $c_j$.\n\nDerive the post-reconciliation key error rate, which is defined as $\\frac{\\text{wt}(\\Delta E)}{n}$, in terms of the given parameters $d_v$, $g$, and $n$.", "solution": "We note that $\\Delta E$’s support consists of a central variable node $v_0$ plus $(d_v-1)/2$ disjoint shortest paths, each connecting two check nodes adjacent to $v_0$. Each such path, together with the two edges $c_i\\!-\\!v_0\\!-\\!c_j$, forms a cycle of length $g$. Hence the path itself has\n$$L = g - 2$$\nedges. In the bipartite Tanner graph, a path of $L$ edges between check nodes contains\n$$\\frac{L}{2}$$\nvariable nodes. \n\nThus each of the $(d_v-1)/2$ paths contributes $(g-2)/2$ variable nodes. Including the central node,\n$$\\mathrm{wt}(\\Delta E)\n=1+\\frac{d_v-1}{2}\\cdot\\frac{g-2}{2}\n=1+\\frac{(d_v-1)(g-2)}{4}.$$\n\nDividing by the block length $n$, the post-reconciliation key error rate is\n$$\\frac{\\mathrm{wt}(\\Delta E)}{n}\n=\\frac{1+\\frac{(d_v-1)(g-2)}{4}}{n}\n=\\frac{4+(d_v-1)(g-2)}{4n}.$$", "answer": "$$\\boxed{\\frac{4+(d_v-1)(g-2)}{4n}}$$", "id": "110732"}]}