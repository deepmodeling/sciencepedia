{"hands_on_practices": [{"introduction": "Quantum circuits are not just for implementing algorithms; they are fundamental tools for preparing and studying complex quantum states. This exercise [@problem_id:165050] explores how a \"staircase\" of controlled-rotation gates can efficiently generate a Matrix Product State (MPS), a powerful description for many-body quantum systems. By tracking the state evolution and calculating the von Neumann entropy for a bipartition, you will gain hands-on experience in analyzing the entanglement structure created by a circuit.", "problem": "Consider a 4-qubit quantum register, with qubits labeled 1, 2, 3, and 4, initialized in the state $|\\psi_0\\rangle = |0000\\rangle$. A quantum circuit is applied to this register, consisting of a sequence of gates.\n\nThe elementary gates used are the Hadamard gate $H$, and the controlled-Y rotation gate $CR_y(\\theta)$. Their matrix representations in the computational basis $\\{|0\\rangle, |1\\rangle\\}$ are:\n$$\nH = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad R_y(\\theta) = \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix}\n$$\nThe controlled-Y rotation gate, $CR_y(\\theta)$, acting on a control qubit $c$ and a target qubit $t$, is defined as $CR_y(\\theta)_{c,t} = |0\\rangle_c\\langle 0| \\otimes I_t + |1\\rangle_c\\langle 1| \\otimes R_y(\\theta)_t$.\n\nThe circuit is constructed as a sequence of four operations:\n1.  A Hadamard gate $H$ is applied to qubit 1.\n2.  A $CR_y(\\theta_{12})$ gate is applied with qubit 1 as the control and qubit 2 as the target.\n3.  A $CR_y(\\theta_{23})$ gate is applied with qubit 2 as the control and qubit 3 as the target.\n4.  A $CR_y(\\theta_{34})$ gate is applied with qubit 3 as the control and qubit 4 as the target.\n\nThe final state of the 4-qubit system is $|\\psi\\rangle$. We consider a bipartition of the system into two 2-qubit subsystems: subsystem A, consisting of qubits 1 and 2, and subsystem B, consisting of qubits 3 and 4. The reduced density matrix of subsystem A is $\\rho_A = \\text{Tr}_B(|\\psi\\rangle\\langle\\psi|)$.\n\nYour task is to calculate the von Neumann entropy of subsystem A, given by $S(\\rho_A) = -\\text{Tr}(\\rho_A \\log_2 \\rho_A)$, for the specific case where the rotation angles are $\\theta_{12} = \\pi/2$ and $\\theta_{23} = 2\\pi/3$. Note that the result may not depend on all gate parameters.", "solution": "Let the 4-qubit computational basis states be denoted by $|i_1i_2i_3i_4\\rangle$, where $i_k \\in \\{0, 1\\}$. The initial state is $|\\psi_0\\rangle = |0000\\rangle$. We track the state of the system as each gate is applied. For convenience, we will use the notation $c_k = \\cos(\\theta_{k,k+1}/2)$ and $s_k = \\sin(\\theta_{k,k+1}/2)$.\n\n1.  **Hadamard on qubit 1:**\n    The first gate is $H_1 = H \\otimes I \\otimes I \\otimes I$. Applying this to the initial state gives:\n    $$\n    |\\psi_1\\rangle = H_1 |\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\otimes |000\\rangle = \\frac{1}{\\sqrt{2}}(|0000\\rangle + |1000\\rangle)\n    $$\n\n2.  **$CR_y(\\theta_{12})$ on (Q1, Q2):**\n    The second gate is $CR_y(\\theta_{12})_{1,2}$. It acts on $|0000\\rangle$ as the identity (control qubit 1 is $|0\\rangle$) and on $|1000\\rangle$ by applying $R_y(\\theta_{12})$ to qubit 2 (control qubit 1 is $|1\\rangle$).\n    $CR_y(\\theta_{12}) |1000\\rangle = |1\\rangle \\otimes (R_y(\\theta_{12})|0\\rangle) \\otimes |00\\rangle = |1\\rangle \\otimes (\\cos(\\theta_{12}/2)|0\\rangle + \\sin(\\theta_{12}/2)|1\\rangle) \\otimes |00\\rangle = c_1|1000\\rangle + s_1|1100\\rangle$.\n    So, the state becomes:\n    $$\n    |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}}(|0000\\rangle + c_1|1000\\rangle + s_1|1100\\rangle)\n    $$\n\n3.  **$CR_y(\\theta_{23})$ on (Q2, Q3):**\n    The third gate is $CR_y(\\theta_{23})_{2,3}$. We check its action on each term of $|\\psi_2\\rangle$:\n    -   $|0000\\rangle$: control qubit 2 is $|0\\rangle$, so the state is unchanged.\n    -   $|1000\\rangle$: control qubit 2 is $|0\\rangle$, so the state is unchanged.\n    -   $|1100\\rangle$: control qubit 2 is $|1\\rangle$, so $R_y(\\theta_{23})$ is applied to qubit 3.\n        $CR_y(\\theta_{23})|1100\\rangle = |11\\rangle \\otimes (R_y(\\theta_{23})|0\\rangle) \\otimes |0\\rangle = c_2|1100\\rangle + s_2|1110\\rangle$.\n    The state after this gate is:\n    $$\n    |\\psi_3\\rangle = \\frac{1}{\\sqrt{2}}(|0000\\rangle + c_1|1000\\rangle + s_1(c_2|1100\\rangle + s_2|1110\\rangle))\n    $$\n    $$\n    |\\psi_3\\rangle = \\frac{1}{\\sqrt{2}}(|0000\\rangle + c_1|1000\\rangle + s_1c_2|1100\\rangle + s_1s_2|1110\\rangle)\n    $$\n\n4.  **$CR_y(\\theta_{34})$ on (Q3, Q4) and Entanglement Entropy:**\n    The von Neumann entropy of a bipartition is invariant under local unitary operations on either subsystem. The final gate, $CR_y(\\theta_{34})$, acts only on qubits 3 and 4, which constitute subsystem B. Therefore, this gate is a local unitary on B and does not change the entanglement between A and B. The entropy of the final state $|\\psi\\rangle$ is the same as the entropy of $|\\psi_3\\rangle$. We proceed to calculate the entropy for $|\\psi_3\\rangle$.\n\nWe can write the state $|\\psi_3\\rangle$ by grouping the subsystems A (qubits 1, 2) and B (qubits 3, 4).\n$$\n|\\psi_3\\rangle = \\left(\\frac{1}{\\sqrt{2}}(|00\\rangle_A + c_1|10\\rangle_A + s_1c_2|11\\rangle_A)\\right) \\otimes |00\\rangle_B + \\left(\\frac{1}{\\sqrt{2}}s_1s_2|11\\rangle_A\\right) \\otimes |10\\rangle_B\n$$\nThis is of the form $|\\psi_3\\rangle = |\\phi_1\\rangle_A \\otimes |v_1\\rangle_B + |\\phi_2\\rangle_A \\otimes |v_2\\rangle_B$, where $|v_1\\rangle_B = |00\\rangle$ and $|v_2\\rangle_B = |10\\rangle$. Since $\\langle v_1 | v_2 \\rangle = 0$, the reduced density matrix of subsystem A, $\\rho_A = \\text{Tr}_B(|\\psi_3\\rangle\\langle\\psi_3|)$, is given by $\\rho_A = |\\phi_1\\rangle\\langle\\phi_1| + |\\phi_2\\rangle\\langle\\phi_2|$. The eigenvalues of $\\rho_A$ are the same as the eigenvalues of the Gram matrix $K_{ij} = \\langle \\phi_i | \\phi_j \\rangle$.\n\nLet's work in an orthonormal basis for the subspace of A spanned by $\\{|00\\rangle, |10\\rangle, |11\\rangle\\}$. Let $|\\hat{u}\\rangle = \\frac{1}{\\sqrt{1+c_1^2}}(|00\\rangle+c_1|10\\rangle)$ and $|\\hat{v}\\rangle=|11\\rangle$. These are orthogonal.\nWe can express $|\\phi_1\\rangle$ and $|\\phi_2\\rangle$ in this basis:\n$|\\phi_1\\rangle = \\frac{\\sqrt{1+c_1^2}}{\\sqrt{2}} |\\hat{u}\\rangle + \\frac{s_1c_2}{\\sqrt{2}}|\\hat{v}\\rangle$\n$|\\phi_2\\rangle = \\frac{s_1s_2}{\\sqrt{2}}|\\hat{v}\\rangle$\nThen $\\rho_A = |\\phi_1\\rangle\\langle\\phi_1| + |\\phi_2\\rangle\\langle\\phi_2|$ becomes:\n$$\n\\rho_A = \\frac{1+c_1^2}{2}|\\hat{u}\\rangle\\langle\\hat{u}| + \\frac{s_1^2(c_2^2+s_2^2)}{2}|\\hat{v}\\rangle\\langle\\hat{v}| + \\frac{\\sqrt{1+c_1^2}s_1c_2}{2}(|\\hat{u}\\rangle\\langle\\hat{v}|+|\\hat{v}\\rangle\\langle\\hat{u}|)\n$$\nUsing $c_2^2+s_2^2=1$, the matrix for $\\rho_A$ in the $\\{|\\hat{u}\\rangle, |\\hat{v}\\rangle\\}$ basis is:\n$$\n\\rho_A' = \\frac{1}{2}\\begin{pmatrix} 1+c_1^2  \\sqrt{1+c_1^2}s_1c_2 \\\\ \\sqrt{1+c_1^2}s_1c_2  s_1^2 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are found from the characteristic equation $\\lambda^2 - \\text{Tr}(\\rho_A')\\lambda + \\det(\\rho_A') = 0$.\n$\\text{Tr}(\\rho_A') = \\frac{1}{2}(1+c_1^2+s_1^2) = 1$.\n$\\det(\\rho_A') = \\frac{1}{4}((1+c_1^2)s_1^2 - (1+c_1^2)s_1^2c_2^2) = \\frac{(1+c_1^2)s_1^2(1-c_2^2)}{4} = \\frac{(1+c_1^2)s_1^2s_2^2}{4}$.\nThe equation is $\\lambda^2 - \\lambda + \\frac{(1+c_1^2)s_1^2s_2^2}{4} = 0$.\nThe eigenvalues are $\\lambda_\\pm = \\frac{1 \\pm \\sqrt{1 - (1+c_1^2)s_1^2s_2^2}}{2}$.\n\nNow, we substitute the given values: $\\theta_{12} = \\pi/2$ and $\\theta_{23} = 2\\pi/3$.\nFor $\\theta_{12} = \\pi/2$: $\\theta_{12}/2 = \\pi/4$, so $c_1 = \\cos(\\pi/4) = 1/\\sqrt{2}$ and $s_1 = \\sin(\\pi/4) = 1/\\sqrt{2}$. Thus $c_1^2=1/2, s_1^2=1/2$.\nFor $\\theta_{23} = 2\\pi/3$: $\\theta_{23}/2 = \\pi/3$, so $c_2 = \\cos(\\pi/3) = 1/2$ and $s_2 = \\sin(\\pi/3) = \\sqrt{3}/2$. Thus $c_2^2=1/4, s_2^2=3/4$.\n\nLet's compute the term under the square root:\n$D = 1 - (1+c_1^2)s_1^2s_2^2 = 1 - (1+1/2)(1/2)(3/4) = 1 - (3/2)(3/8) = 1 - 9/16 = 7/16$.\nThe eigenvalues are:\n$$\n\\lambda_\\pm = \\frac{1 \\pm \\sqrt{7/16}}{2} = \\frac{1 \\pm \\sqrt{7}/4}{2} = \\frac{4 \\pm \\sqrt{7}}{8}\n$$\nThe two non-zero eigenvalues of $\\rho_A$ are $\\lambda_1 = \\frac{4+\\sqrt{7}}{8}$ and $\\lambda_2 = \\frac{4-\\sqrt{7}}{8}$. The von Neumann entropy is $S(\\rho_A) = -\\sum_i \\lambda_i \\log_2 \\lambda_i$.\n$$\nS(\\rho_A) = - \\left( \\frac{4+\\sqrt{7}}{8} \\log_2\\left(\\frac{4+\\sqrt{7}}{8}\\right) + \\frac{4-\\sqrt{7}}{8} \\log_2\\left(\\frac{4-\\sqrt{7}}{8}\\right) \\right)\n$$\nThis is the final analytical expression for the entropy.", "answer": "$$\n\\boxed{- \\left( \\frac{4+\\sqrt{7}}{8} \\log_2\\left(\\frac{4+\\sqrt{7}}{8}\\right) + \\frac{4-\\sqrt{7}}{8} \\log_2\\left(\\frac{4-\\sqrt{7}}{8}\\right) \\right)}\n$$", "id": "165050"}, {"introduction": "While ideal quantum circuits operate perfectly, real-world quantum processors are susceptible to noise, which can corrupt the computation. This practice problem [@problem_id:165011] introduces the depolarizing channel, a standard model for noise, into the simple yet fundamental circuit for creating a Bell state. Calculating the fidelity between the ideal state and the noisy output will provide you with a quantitative measure of the circuit's performance and a deeper understanding of how noise impacts entanglement.", "problem": "A fundamental operation in quantum computing is the creation of entangled states. A standard circuit to generate a Bell state, specifically the state $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$, acts on an initial two-qubit state $|\\psi_{in}\\rangle = |00\\rangle$. The circuit consists of a Hadamard gate ($H$) applied to the first qubit, followed by a Controlled-NOT (CNOT) gate where the first qubit is the control and the second is the target.\n\nThe actions of the ideal gates on the computational basis states are as follows:\n- Hadamard gate: $H|0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ and $H|1\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$.\n- CNOT gate: $CNOT|x, y\\rangle = |x, y \\oplus x\\rangle$, where $\\oplus$ denotes addition modulo 2.\n\nIn a realistic quantum computer, operations are subject to noise. We model this by considering a noisy version of the Bell state preparation circuit. In this noisy circuit, the CNOT gate is immediately followed by a two-qubit depolarizing channel, $\\mathcal{E}$. This channel describes a process where, with probability $p$, the state is replaced by the maximally mixed state, and with probability $1-p$, it remains unchanged. The action of the channel on any two-qubit density matrix $\\rho$ is given by:\n$$\n\\mathcal{E}(\\rho) = (1-p)\\rho + p\\frac{I_4}{4}\n$$\nwhere $I_4$ is the $4 \\times 4$ identity matrix on the two-qubit Hilbert space.\n\nLet $|\\psi_{ideal}\\rangle$ be the final state of the ideal circuit, and let $\\rho_{noisy}$ be the final density matrix of the noisy circuit. The fidelity between a pure state $|\\psi\\rangle$ and a mixed state $\\rho$ is a measure of their closeness, defined as $F(|\\psi\\rangle, \\rho) = \\sqrt{\\langle\\psi|\\rho|\\psi\\rangle}$.\n\nCalculate the fidelity $F(|\\psi_{ideal}\\rangle, \\rho_{noisy})$ as a function of the error probability $p$.", "solution": "The solution involves three main steps:\n1.  Derive the ideal final state $|\\psi_{ideal}\\rangle$.\n2.  Determine the noisy final state $\\rho_{noisy}$.\n3.  Calculate the fidelity between these two states.\n\n**Step 1: Ideal Final State**\n\nThe initial state of the two-qubit system is $|\\psi_{in}\\rangle = |00\\rangle = |0\\rangle \\otimes |0\\rangle$.\n\nFirst, a Hadamard gate is applied to the first qubit. The state of the system becomes:\n$$\n|\\psi_1\\rangle = (H \\otimes I) |00\\rangle = (H|0\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |10\\rangle)\n$$\n\nNext, a CNOT gate is applied, with the first qubit as control and the second as target. The CNOT gate acts linearly on the superposition:\n$$\n|\\psi_{ideal}\\rangle = \\text{CNOT} |\\psi_1\\rangle = \\text{CNOT} \\left( \\frac{1}{\\sqrt{2}}(|00\\rangle + |10\\rangle) \\right)\n$$\n$$\n|\\psi_{ideal}\\rangle = \\frac{1}{\\sqrt{2}} (\\text{CNOT}|00\\rangle + \\text{CNOT}|10\\rangle)\n$$\nUsing the definition of the CNOT gate, $\\text{CNOT}|00\\rangle = |00\\rangle$ and $\\text{CNOT}|10\\rangle = |11\\rangle$. Substituting these into the expression:\n$$\n|\\psi_{ideal}\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)\n$$\nThis is the well-known Bell state $|\\Phi^+\\rangle$. The density matrix for this ideal pure state is $\\rho_{ideal} = |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|$.\n\n**Step 2: Noisy Final State**\n\nIn the noisy circuit, the ideal operations (Hadamard and CNOT) are performed first, resulting in the state $\\rho_{ideal}$. This state then passes through the two-qubit depolarizing channel $\\mathcal{E}$. The final state of the noisy circuit, $\\rho_{noisy}$, is therefore:\n$$\n\\rho_{noisy} = \\mathcal{E}(\\rho_{ideal})\n$$\nSubstituting the definition of the channel $\\mathcal{E}$:\n$$\n\\rho_{noisy} = (1-p) \\rho_{ideal} + p \\frac{I_4}{4}\n$$\nwhere $\\rho_{ideal} = |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|$. So,\n$$\n\\rho_{noisy} = (1-p) |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}| + \\frac{p}{4} I_4\n$$\n\n**Step 3: Fidelity Calculation**\n\nThe fidelity between the ideal pure state $|\\psi_{ideal}\\rangle$ and the noisy mixed state $\\rho_{noisy}$ is given by the formula:\n$$\nF = F(|\\psi_{ideal}\\rangle, \\rho_{noisy}) = \\sqrt{\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle}\n$$\nWe compute the term inside the square root, $\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle$:\n$$\n\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle = \\langle\\psi_{ideal}| \\left( (1-p) |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}| + \\frac{p}{4} I_4 \\right) |\\psi_{ideal}\\rangle\n$$\nUsing the linearity of the inner product, we can split this into two terms:\n$$\n\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle = (1-p) \\langle\\psi_{ideal}|(|\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|)|\\psi_{ideal}\\rangle + \\frac{p}{4} \\langle\\psi_{ideal}|I_4|\\psi_{ideal}\\rangle\n$$\nNow, we evaluate each term. Since $|\\psi_{ideal}\\rangle$ is a normalized state vector, we have $\\langle\\psi_{ideal}|\\psi_{ideal}\\rangle = 1$.\nThe first term becomes:\n$$\n\\langle\\psi_{ideal}|(|\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|)|\\psi_{ideal}\\rangle = (\\langle\\psi_{ideal}|\\psi_{ideal}\\rangle)(\\langle\\psi_{ideal}|\\psi_{ideal}\\rangle) = (1)(1) = 1\n$$\nThe second term involves the identity operator $I_4$:\n$$\n\\langle\\psi_{ideal}|I_4|\\psi_{ideal}\\rangle = \\langle\\psi_{ideal}|\\psi_{ideal}\\rangle = 1\n$$\nSubstituting these results back into the expression for the inner product:\n$$\n\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle = (1-p)(1) + \\frac{p}{4}(1) = 1 - p + \\frac{p}{4} = 1 - \\frac{3p}{4}\n$$\nFinally, the fidelity is the square root of this result:\n$$\nF = \\sqrt{1 - \\frac{3p}{4}}\n$$", "answer": "$$ \\boxed{\\sqrt{1 - \\frac{3p}{4}}} $$", "id": "165011"}, {"introduction": "Building a reliable quantum computer requires us to actively combat noise through clever circuit design. This problem [@problem_id:165134] demonstrates a foundational technique in fault tolerance: using a \"flag\" ancilla qubit to detect errors that occur during a CNOT operation. By analyzing how a specific error on a data qubit propagates through the circuit gadget, you will see how it triggers the flag, signaling that the operation may have failed and that corrective action is needed.", "problem": "A three-qubit quantum circuit is designed to perform a fault-detecting CNOT operation. The circuit consists of a control qubit (C), a target qubit (T), and a flag ancilla qubit (F). The CNOT operation from C to T is implemented via the following sequence of gates: $U = U_{CF}^{(3)} U_{CT}^{(2)} U_{CF}^{(1)}$, where $U_{AB}^{(i)}$ is a CNOT gate with qubit A as control and qubit B as target, and the superscript indicates the order of application.\n\nThe system is initialized with the control qubit in the state $|\\psi\\rangle_C = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$, and the target and flag qubits in the state $|0\\rangle$, i.e., the total initial state is $|\\Psi_{init}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle_C + |1\\rangle_C) \\otimes |0\\rangle_T \\otimes |0\\rangle_F$.\n\nThis circuit is affected by an error on the control qubit. Specifically, a single-qubit depolarizing channel $\\mathcal{E}_p$ with strength $p$ acts on the control qubit C *after* the first gate $U_{CF}^{(1)}$ but *before* the second gate $U_{CT}^{(2)}$. The action of the depolarizing channel on a single-qubit density matrix $\\rho$ is given by:\n$$\n\\mathcal{E}_p(\\rho) = (1-p) \\rho + p \\frac{I}{2}\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix.\n\nThe purpose of the flag qubit is to signal that an error has occurred. Calculate the probability that a measurement of the flag qubit F in the computational basis at the end of the full circuit $U$ yields the outcome 1.", "solution": "1. After the first CNOT $U_{CF}^{(1)}$, the pure state is\n\n$$\n|\\Psi_{1}\\rangle\n=\\frac{1}{\\sqrt{2}}\\bigl(|0_C0_T0_F\\rangle+|1_C0_T1_F\\rangle\\bigr)\\,,\n$$\n\nso\n\n$$\n\\rho_{1}=|\\Psi_{1}\\rangle\\langle\\Psi_{1}|\\,.\n$$\n\n2. The depolarizing channel on $C$ yields\n\n$$\n\\rho_{2}\n=(1-p)\\,\\rho_{1}\n+ p\\;\\Bigl(\\frac{I_C}{2}\\otimes\\Tr_C[\\rho_{1}]\\Bigr)\\,.\n$$\n\n3. We compute the two contributions to the flag-1 probability:\n   A. From the $(1-p)\\rho_{1}$ term.  The remaining gates are $U_{CF}^{(3)} U_{CT}^{(2)}$. Applying these to $|\\Psi_1\\rangle$ gives the final pure state\n   $|\\Psi_{\\mathrm{out}}\\rangle=\\frac{1}{\\sqrt{2}}(|000\\rangle+|110\\rangle)$,\n   for which $\\Pr(F=1)=0$.  Hence\n   \n$$\n   P_A=(1-p)\\times0=0.\n   $$\n\n   B. From the $p$-term.  Note\n   $\\Tr_C[\\rho_{1}]=\\frac{1}{2}\\bigl(|00\\rangle\\langle00|+|01\\rangle\\langle01|\\bigr)_{TF}$.\n   Thus after depolarization the state part corresponding to the error is\n   $\\rho_{\\mathrm{dep}}\n   =\\frac{1}{4}\\,I_C\\otimes\\bigl(|00\\rangle\\langle00|+|01\\rangle\\langle01|\\bigr)_{TF}.$\n   This is an equal mixture of four states $|000\\rangle, |100\\rangle, |001\\rangle, |101\\rangle$. Propagating each basis state through the remaining gates $U_{CT}^{(2)}$ then $U_{CF}^{(3)}$:\n    - $|000\\rangle \\to |000\\rangle$ (Flag=0)\n    - $|100\\rangle \\to |111\\rangle$ (Flag=1)\n    - $|001\\rangle \\to |001\\rangle$ (Flag=1)\n    - $|110\\rangle \\to |110\\rangle$ (Flag=0)\n   Two of the four equally-weighted terms produce F=1. The probability of F=1 from this part is $\\frac{1}{2}$. Therefore\n   \n$$\n   P_B\n   =p\\times\\frac{1}{2}\n   =\\frac{p}{2}.\n   $$\n\n4. Summing,\n\n$$\n\\Pr(F=1)=P_A+P_B=0+\\frac p2=\\frac p2.\n$$", "answer": "$$\\boxed{\\frac p2}$$", "id": "165134"}]}