{"hands_on_practices": [{"introduction": "This first practice exercise provides a foundational test of your understanding of multi-qubit gate operations. You will trace the evolution of a three-qubit system, initially in a superposition, as it passes through a circuit containing SWAP and Toffoli gates. This problem reinforces the core mechanics of how these gates act on the computational basis states and how to calculate measurement probabilities from the resulting final state vector [@problem_id:103296].", "problem": "A three-qubit quantum system is considered, with its state space spanned by the computational basis states $|q_1 q_2 q_3\\rangle$, where $q_i \\in \\{0, 1\\}$. The standard single-qubit states are defined as $|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, $|1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, and the Hadamard state $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$.\n\nWe use two types of three-qubit gates:\n1.  The $\\text{SWAP}_{ij}$ gate, which swaps the states of qubit $i$ and qubit $j$. Its action on a basis state is given by $U_{\\text{SWAP}_{ij}} |q_1 \\dots q_i \\dots q_j \\dots q_n \\rangle = |q_1 \\dots q_j \\dots q_i \\dots q_n \\rangle$.\n2.  The Toffoli gate (or CCNOT gate), denoted as $\\text{Toffoli}_{ijk}$. This gate has two control qubits, $i$ and $j$, and one target qubit, $k$. It applies a Pauli-X gate to the target qubit $k$ if and only if both control qubits are in the state $|1\\rangle$. Its action on a basis state is $U_{\\text{Toffoli}_{ijk}} |q_i q_j q_k\\rangle = |q_i q_j (q_k \\oplus (q_i \\cdot q_j))\\rangle$, where $\\oplus$ denotes addition modulo 2, and the states of other qubits are unaffected.\n\nThe system is initialized in the state:\n$$\n|\\psi_{in}\\rangle = |+\\rangle \\otimes |1\\rangle \\otimes |0\\rangle\n$$\n\nA sequence of two quantum gates is applied to this initial state. First, a $\\text{SWAP}_{23}$ gate acts on the system, followed by a $\\text{Toffoli}_{123}$ gate. The final state is then measured in the computational basis.\n\nCalculate the probability of measuring the outcome $|101\\rangle$.", "solution": "The initial state is given by:\n\n$$\n|\\psi_{\\text{in}}\\rangle = |+\\rangle \\otimes |1\\rangle \\otimes |0\\rangle\n$$\n\nwhere $|+\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle + |1\\rangle)$. Thus:\n\n$$\n|\\psi_{\\text{in}}\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle + |1\\rangle) \\otimes |1\\rangle \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle \\otimes |1\\rangle \\otimes |0\\rangle + |1\\rangle \\otimes |1\\rangle \\otimes |0\\rangle)\n$$\n\nIn the computational basis, this is:\n\n$$\n|\\psi_{\\text{in}}\\rangle = \\frac{1}{\\sqrt{2}} (|010\\rangle + |110\\rangle)\n$$\n\n\nApply the $\\text{SWAP}_{23}$ gate, which swaps qubit 2 and qubit 3. Its action on a basis state $|q_1 q_2 q_3\\rangle$ is:\n\n$$\nU_{\\text{SWAP}_{23}} |q_1 q_2 q_3\\rangle = |q_1 q_3 q_2\\rangle\n$$\n\nApplying to each term:\n\n$$\nU_{\\text{SWAP}_{23}} |010\\rangle = |001\\rangle, \\quad U_{\\text{SWAP}_{23}} |110\\rangle = |101\\rangle\n$$\n\nSo the state after $\\text{SWAP}_{23}$ is:\n\n$$\n|\\psi_{\\text{after swap}}\\rangle = \\frac{1}{\\sqrt{2}} (|001\\rangle + |101\\rangle)\n$$\n\n\nNext, apply the $\\text{Toffoli}_{123}$ gate with control qubits 1 and 2, and target qubit 3. Its action on a basis state $|q_1 q_2 q_3\\rangle$ is:\n\n$$\nU_{\\text{Toffoli}_{123}} |q_1 q_2 q_3\\rangle = |q_1 q_2 (q_3 \\oplus (q_1 \\cdot q_2))\\rangle\n$$\n\nApplying to each term:\n- For $|001\\rangle$: $q_1 = 0$, $q_2 = 0$, $q_3 = 1$. Since $q_1 \\cdot q_2 = 0$, $q_3 \\oplus 0 = 1$, so:\n  \n$$\n  U_{\\text{Toffoli}_{123}} |001\\rangle = |001\\rangle\n  $$\n\n- For $|101\\rangle$: $q_1 = 1$, $q_2 = 0$, $q_3 = 1$. Since $q_1 \\cdot q_2 = 0$, $q_3 \\oplus 0 = 1$, so:\n  \n$$\n  U_{\\text{Toffoli}_{123}} |101\\rangle = |101\\rangle\n  $$\n\nThus, the final state is:\n\n$$\n|\\psi_{\\text{final}}\\rangle = \\frac{1}{\\sqrt{2}} (|001\\rangle + |101\\rangle)\n$$\n\n\nThe probability of measuring $|101\\rangle$ is the square of the absolute value of its coefficient in the final state. The coefficient is $\\frac{1}{\\sqrt{2}}$, so:\n\n$$\n|\\langle 101 | \\psi_{\\text{final}}\\rangle|^2 = \\left| \\frac{1}{\\sqrt{2}} \\right|^2 = \\left( \\frac{1}{\\sqrt{2}} \\right)^2 = \\frac{1}{2}\n$$\n\nThe states $|001\\rangle$ and $|101\\rangle$ are orthogonal, and the norm of the state is conserved:\n\n$$\n\\left| \\frac{1}{\\sqrt{2}} \\right|^2 + \\left| \\frac{1}{\\sqrt{2}} \\right|^2 = \\frac{1}{2} + \\frac{1}{2} = 1\n$$\n\nThus, the probability is $\\frac{1}{2}$.", "answer": "$$ \\boxed{\\dfrac{1}{2}} $$", "id": "103296"}, {"introduction": "Multi-qubit gates are essential for creating and manipulating the entangled states that power many quantum algorithms. This exercise explores how a sequence of CNOT gates transforms a maximally entangled Greenberger-Horne-Zeilinger (GHZ) state. By calculating the fidelity between the initial and final states, you will gain insight into how gate sequences can alter quantum correlations and learn to use a key metric for comparing quantum states [@problem_id:103319].", "problem": "A three-qubit system is prepared in the Greenberger-Horne-Zeilinger (GHZ) state, which is a maximally entangled state defined as:\n$$\n|\\psi_{GHZ}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)\n$$\nHere, the state is represented in the computational basis $|q_1 q_2 q_3\\rangle$, where $q_i \\in \\{0, 1\\}$ is the state of the $i$-th qubit.\n\nA quantum circuit applies a sequence of three controlled-NOT (CNOT) gates to this initial state. The total unitary operation is given by $U = U_3 U_2 U_1$, where the gates are applied sequentially from right to left:\n1.  $U_1 = \\text{CNOT}_{12}$ (qubit 1 is control, qubit 2 is target)\n2.  $U_2 = \\text{CNOT}_{23}$ (qubit 2 is control, qubit 3 is target)\n3.  $U_3 = \\text{CNOT}_{31}$ (qubit 3 is control, qubit 1 is target)\n\nThe action of a $\\text{CNOT}_{ij}$ gate on the computational basis states $|c\\rangle_i|t\\rangle_j$ is to flip the target qubit $t$ if the control qubit $c$ is $|1\\rangle$. This can be written as $|c\\rangle_i|t\\rangle_j \\mapsto |c\\rangle_i|t \\oplus c\\rangle_j$, where $\\oplus$ denotes addition modulo 2. The gate acts as the identity on all other qubits not involved.\n\nLet the final state of the system after the application of the full sequence of gates be $|\\psi_{final}\\rangle = U |\\psi_{GHZ}\\rangle$. Calculate the fidelity, $F$, between the initial GHZ state and the final state. The fidelity is defined as the squared magnitude of the inner product of the two states: $F = |\\langle\\psi_{GHZ}|\\psi_{final}\\rangle|^2$.", "solution": "The problem asks for the fidelity between an initial three-qubit GHZ state, $|\\psi_{GHZ}\\rangle$, and the final state, $|\\psi_{final}\\rangle$, obtained after applying a specific quantum circuit.\n\nThe initial state is given by:\n$$\n|\\psi_{GHZ}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)\n$$\n\nThe unitary operator for the circuit is $U = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}$. We need to calculate the final state $|\\psi_{final}\\rangle = U |\\psi_{GHZ}\\rangle$. Due to the linearity of quantum mechanics, we can apply the operator to each term in the superposition separately:\n$$\n|\\psi_{final}\\rangle = U \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle) = \\frac{1}{\\sqrt{2}} (U|000\\rangle + U|111\\rangle)\n$$\n\nLet's first calculate the action of $U$ on the basis state $|000\\rangle$:\n1.  Apply $\\text{CNOT}_{12}$: The control qubit (qubit 1) is in state $|0\\rangle$, so the target qubit (qubit 2) is not flipped.\n    $$\n    \\text{CNOT}_{12}|000\\rangle = |000\\rangle\n    $$\n2.  Apply $\\text{CNOT}_{23}$: The control qubit (qubit 2) is in state $|0\\rangle$, so the target qubit (qubit 3) is not flipped.\n    $$\n    \\text{CNOT}_{23}|000\\rangle = |000\\rangle\n    $$\n3.  Apply $\\text{CNOT}_{31}$: The control qubit (qubit 3) is in state $|0\\rangle$, so the target qubit (qubit 1) is not flipped.\n    $$\n    \\text{CNOT}_{31}|000\\rangle = |000\\rangle\n    $$\nCombining these steps, we find that the state $|000\\rangle$ is a fixed point of the transformation $U$:\n$$\nU|000\\rangle = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}|000\\rangle = |000\\rangle\n$$\n\nNext, we calculate the action of $U$ on the basis state $|111\\rangle$:\n1.  Apply $\\text{CNOT}_{12}$: The control qubit (qubit 1) is $|1\\rangle$, so we flip the target qubit (qubit 2).\n    $$\n    \\text{CNOT}_{12}|111\\rangle = |1, 1\\oplus1, 1\\rangle = |101\\rangle\n    $$\n2.  Apply $\\text{CNOT}_{23}$ to the result $|101\\rangle$: The control qubit (qubit 2) is $|0\\rangle$, so the target qubit (qubit 3) is not flipped.\n    $$\n    \\text{CNOT}_{23}|101\\rangle = |1,0,1\\oplus0\\rangle = |101\\rangle\n    $$\n3.  Apply $\\text{CNOT}_{31}$ to the result $|101\\rangle$: The control qubit (qubit 3) is $|1\\rangle$, so we flip the target qubit (qubit 1).\n    $$\n    \\text{CNOT}_{31}|101\\rangle = |1\\oplus1, 0, 1\\rangle = |001\\rangle\n    $$\nSo, the action of $U$ on $|111\\rangle$ is:\n$$\nU|111\\rangle = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}|111\\rangle = |001\\rangle\n$$\n\nNow we can write the final state $|\\psi_{final}\\rangle$:\n$$\n|\\psi_{final}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |001\\rangle)\n$$\nThis final state is a superposition of $|000\\rangle$ and $|001\\rangle$. It can also be written as a product state: $|\\psi_{final}\\rangle = |00\\rangle \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) = |00\\rangle|+\\rangle_3$.\n\nThe final step is to calculate the fidelity $F = |\\langle\\psi_{GHZ}|\\psi_{final}\\rangle|^2$. We first compute the inner product $\\langle\\psi_{GHZ}|\\psi_{final}\\rangle$:\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\left( \\frac{1}{\\sqrt{2}}(\\langle 000| + \\langle 111|) \\right) \\left( \\frac{1}{\\sqrt{2}}(|000\\rangle + |001\\rangle) \\right)\n$$\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\frac{1}{2} (\\langle 000|000\\rangle + \\langle 000|001\\rangle + \\langle 111|000\\rangle + \\langle 111|001\\rangle)\n$$\nUsing the orthogonality of the computational basis states, $\\langle ijk|lmn\\rangle = \\delta_{il}\\delta_{jm}\\delta_{kn}$, we get:\n$$\n\\langle 000|000\\rangle = 1\n$$\n$$\n\\langle 000|001\\rangle = 0\n$$\n$$\n\\langle 111|000\\rangle = 0\n$$\n$$\n\\langle 111|001\\rangle = 0\n$$\nSubstituting these values back into the inner product expression:\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\frac{1}{2} (1 + 0 + 0 + 0) = \\frac{1}{2}\n$$\nFinally, the fidelity is the square of the magnitude of this inner product:\n$$\nF = \\left|\\frac{1}{2}\\right|^2 = \\frac{1}{4}\n$$", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "103319"}, {"introduction": "Ideal quantum circuits are a useful theoretical abstraction, but real-world quantum computers are susceptible to errors. This problem introduces the practical concept of a coherent error in state preparation and asks you to analyze its impact on the output of a Toffoli gate. Calculating the fidelity between the ideal and actual outcomes provides a quantitative measure of the gate's performance, offering a crucial first step into the vital field of quantum error analysis [@problem_id:103383].", "problem": "The Toffoli gate, also known as the CCNOT gate, is a universal reversible 3-qubit gate. Its action on the computational basis states $|c_1 c_2 t\\rangle$ (where $c_1, c_2$ are the control qubits and $t$ is the target qubit) is defined as $U_{T}|c_1 c_2 t\\rangle = |c_1 c_2, t \\oplus (c_1 \\cdot c_2)\\rangle$, where $\\oplus$ denotes addition modulo 2.\n\nConsider a quantum computation where the intended initial state of a 3-qubit register is $|\\psi_{\\text{ideal, in}}\\rangle = |1\\rangle_1 |1\\rangle_2 |0\\rangle_3 \\equiv |110\\rangle$. The ideal operation involves applying a Toffoli gate $U_{T}$ to this state, resulting in an ideal final state $|\\psi_{\\text{ideal, out}}\\rangle = U_{T} |\\psi_{\\text{ideal, in}}\\rangle$.\n\nHowever, due to an imperfection in the state preparation process, a small coherent error is introduced on the first control qubit. The actual prepared state is given by:\n$$|\\psi_{\\text{actual, in}}\\rangle = \\left(\\sqrt{1-\\epsilon^2}|1\\rangle_1 + \\epsilon|0\\rangle_1\\right) \\otimes |1\\rangle_2 \\otimes |0\\rangle_3$$\nwhere $\\epsilon$ is a small, real parameter representing the error amplitude. The same Toffoli gate $U_T$ is then applied to this actual state, producing the actual final state $|\\psi_{\\text{actual, out}}\\rangle = U_{T} |\\psi_{\\text{actual, in}}\\rangle$.\n\nThe fidelity $F$ between two pure quantum states $|\\phi\\rangle$ and $|\\psi\\rangle$ is given by $F = |\\langle\\phi|\\psi\\rangle|^2$.\n\nCalculate the fidelity $F = |\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle|^2$ between the ideal and actual output states. Express your answer in terms of $\\epsilon$.", "solution": "The solution involves three main steps:\n1.  Determine the ideal output state $|\\psi_{\\text{ideal, out}}\\rangle$.\n2.  Determine the actual output state $|\\psi_{\\text{actual, out}}\\rangle$.\n3.  Calculate the fidelity $F$ using the definition.\n\n**Step 1: Determine the ideal output state**\n\nThe ideal initial state is given as $|\\psi_{\\text{ideal, in}}\\rangle = |110\\rangle$. We apply the Toffoli gate $U_T$ to this state. The action of the Toffoli gate is to flip the target qubit if and only if both control qubits are in the state $|1\\rangle$.\n\n$$|\\psi_{\\text{ideal, out}}\\rangle = U_T |\\psi_{\\text{ideal, in}}\\rangle = U_T |110\\rangle$$\n\nHere, the control qubits (the first two) are $|1\\rangle$ and $|1\\rangle$. Thus, the target qubit (the third one) is flipped ($0 \\rightarrow 1$).\n\n$$|\\psi_{\\text{ideal, out}}\\rangle = |111\\rangle$$\n\n**Step 2: Determine the actual output state**\n\nThe actual initial state is given by:\n$$|\\psi_{\\text{actual, in}}\\rangle = \\left(\\sqrt{1-\\epsilon^2}|1\\rangle_1 + \\epsilon|0\\rangle_1\\right) \\otimes |1\\rangle_2 \\otimes |0\\rangle_3$$\n\nWe can expand this into the computational basis:\n$$|\\psi_{\\text{actual, in}}\\rangle = \\sqrt{1-\\epsilon^2}|110\\rangle + \\epsilon|010\\rangle$$\n\nNow, we apply the Toffoli gate $U_T$ to this state. Due to the linearity of quantum mechanics, we can apply the gate to each term in the superposition separately:\n$$|\\psi_{\\text{actual, out}}\\rangle = U_T \\left(\\sqrt{1-\\epsilon^2}|110\\rangle + \\epsilon|010\\rangle\\right) = \\sqrt{1-\\epsilon^2} U_T|110\\rangle + \\epsilon U_T|010\\rangle$$\n\nWe evaluate the action of $U_T$ on each basis state:\n-   For $|110\\rangle$, both controls are $|1\\rangle$, so the target flips: $U_T|110\\rangle = |111\\rangle$.\n-   For $|010\\rangle$, the controls are not both $|1\\rangle$ (the first control is $|0\\rangle$), so the target is not flipped: $U_T|010\\rangle = |010\\rangle$.\n\nSubstituting these back into the expression for the actual output state:\n$$|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}|111\\rangle + \\epsilon|010\\rangle$$\n\n**Step 3: Calculate the fidelity**\n\nThe fidelity is $F = |\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle|^2$. First, we compute the inner product $\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle$.\n\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\langle 111 | \\left(\\sqrt{1-\\epsilon^2}|111\\rangle + \\epsilon|010\\rangle\\right)$$\n\nUsing the distributive property of the inner product:\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}\\langle 111 | 111 \\rangle + \\epsilon\\langle 111 | 010 \\rangle$$\n\nThe computational basis states are orthonormal, meaning $\\langle ijk|lmn \\rangle = \\delta_{il}\\delta_{jm}\\delta_{kn}$. Therefore:\n-   $\\langle 111 | 111 \\rangle = 1$\n-   $\\langle 111 | 010 \\rangle = 0$\n\nSubstituting these values:\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}(1) + \\epsilon(0) = \\sqrt{1-\\epsilon^2}$$\n\nFinally, we compute the fidelity by squaring the magnitude of the inner product. Since $\\epsilon$ is a small real parameter, we assume $\\epsilon^2 < 1$, so $\\sqrt{1-\\epsilon^2}$ is real and positive.\n$$F = |\\sqrt{1-\\epsilon^2}|^2 = 1-\\epsilon^2$$", "answer": "$$\n\\boxed{1 - \\epsilon^2}\n$$", "id": "103383"}]}