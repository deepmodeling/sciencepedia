{"hands_on_practices": [{"introduction": "The Controlled-NOT (CNOT) gate is a cornerstone for creating entanglement from separable states. While its primary function is to flip a target qubit based on a control, a deeper question arises about the reciprocal effect: how does this interaction affect the control qubit itself? This exercise [@problem_id:64987] delves into this \"back-action,\" challenging you to find the specific initial state of the target qubit that leaves the control qubit's state perfectly undisturbed after the CNOT operation. Solving this requires using the reduced density matrix, providing essential practice in analyzing subsystems and understanding the precise conditions for entanglement generation.", "problem": "Consider a two-qubit system composed of a control qubit, denoted by subscript $c$, and a target qubit, denoted by subscript $t$. The CNOT (Controlled-NOT) gate acts on this system. Its action in the computational basis $\\{|0\\rangle, |1\\rangle\\}$ is defined as $U_{CNOT}|c\\rangle_c|t\\rangle_t = |c\\rangle_c|t \\oplus c\\rangle_t$, where $\\oplus$ denotes addition modulo 2.\n\nThe initial state of the system is given by the product state $|\\Psi_{in}\\rangle = |+\\rangle_c |\\psi\\rangle_t$. The control qubit is prepared in the state $|+\\rangle_c = \\frac{1}{\\sqrt{2}}(|0\\rangle_c + |1\\rangle_c)$. The target qubit is in a state $|\\psi\\rangle_t = \\alpha|0\\rangle_t + \\beta|1\\rangle_t$, where $\\alpha$ is a complex coefficient and $\\beta = \\sqrt{1-|\\alpha|^2}$. The square root is taken to be the principal (non-negative real) root, so $\\beta$ is a non-negative real number.\n\nWhen the CNOT gate is applied to the system, it is found that the state of the control qubit remains undisturbed. The state of a qubit subsystem is described by its reduced density matrix. Find the complex coefficient $\\alpha$ for which this condition holds.", "solution": "The initial state is $|\\Psi_{\\text{in}}\\rangle = |+\\rangle_c |\\psi\\rangle_t$, where $|+\\rangle_c = \\frac{1}{\\sqrt{2}}(|0\\rangle_c + |1\\rangle_c)$ and $|\\psi\\rangle_t = \\alpha|0\\rangle_t + \\beta|1\\rangle_t$ with $\\beta = \\sqrt{1 - |\\alpha|^2}$ (non-negative real). The CNOT gate acts as $U_{\\text{CNOT}}|c\\rangle_c|t\\rangle_t = |c\\rangle_c|t \\oplus c\\rangle_t$.\n\nThe state after applying CNOT is:\n\n$$\n|\\Psi_{\\text{out}}\\rangle = U_{\\text{CNOT}}|\\Psi_{\\text{in}}\\rangle = \\frac{1}{\\sqrt{2}} \\left[ \\alpha |00\\rangle + \\beta |01\\rangle + \\beta |10\\rangle + \\alpha |11\\rangle \\right],\n$$\n\nusing the shorthand $|ab\\rangle = |a\\rangle_c |b\\rangle_t$.\n\nThe reduced density matrix of the control qubit is found by tracing out the target qubit:\n\n$$\n\\rho_{c,\\text{out}} = \\operatorname{Tr}_t(|\\Psi_{\\text{out}}\\rangle\\langle\\Psi_{\\text{out}}|).\n$$\n\nThe matrix elements in the control qubit basis $\\{|0\\rangle_c, |1\\rangle_c\\}$ are:\n- Diagonal elements:\n  \n$$\n  \\langle 0| \\rho_{c,\\text{out}} |0\\rangle = \\langle 00| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |00 \\rangle + \\langle 01| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |01 \\rangle = \\left| \\frac{\\alpha}{\\sqrt{2}} \\right|^2 + \\left| \\frac{\\beta}{\\sqrt{2}} \\right|^2 = \\frac{|\\alpha|^2}{2} + \\frac{\\beta^2}{2}.\n  $$\n\n  Since $\\beta^2 = 1 - |\\alpha|^2$,\n  \n$$\n  \\langle 0| \\rho_{c,\\text{out}} |0\\rangle = \\frac{|\\alpha|^2}{2} + \\frac{1 - |\\alpha|^2}{2} = \\frac{1}{2}.\n  $$\n\n  Similarly,\n  \n$$\n  \\langle 1| \\rho_{c,\\text{out}} |1\\rangle = \\frac{\\beta^2}{2} + \\frac{|\\alpha|^2}{2} = \\frac{1}{2}.\n  $$\n\n- Off-diagonal elements:\n  \n$$\n  \\langle 0| \\rho_{c,\\text{out}} |1\\rangle = \\langle 00| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |10 \\rangle + \\langle 01| \\Psi_{\\text{out}} \\rangle \\langle \\Psi_{\\text{out}} |11 \\rangle = \\left( \\frac{\\alpha}{\\sqrt{2}} \\right) \\left( \\frac{\\beta}{\\sqrt{2}} \\right)^* + \\left( \\frac{\\beta}{\\sqrt{2}} \\right) \\left( \\frac{\\alpha}{\\sqrt{2}} \\right)^* = \\frac{\\alpha \\beta}{2} + \\frac{\\beta \\alpha^*}{2} = \\beta \\operatorname{Re}(\\alpha).\n  $$\n\n  Similarly,\n  \n$$\n  \\langle 1| \\rho_{c,\\text{out}} |0\\rangle = \\beta \\operatorname{Re}(\\alpha).\n  $$\n\nThus,\n\n$$\n\\rho_{c,\\text{out}} = \\begin{pmatrix}\n\\frac{1}{2} & \\beta \\operatorname{Re}(\\alpha) \\\\\n\\beta \\operatorname{Re}(\\alpha) & \\frac{1}{2}\n\\end{pmatrix}.\n$$\n\n\nThe initial reduced density matrix of the control qubit is:\n\n$$\n\\rho_{c,\\text{in}} = |+\\rangle\\langle+|_c = \\frac{1}{2} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}.\n$$\n\n\nFor the control qubit to remain undisturbed, $\\rho_{c,\\text{out}} = \\rho_{c,\\text{in}}$, so:\n\n$$\n\\beta \\operatorname{Re}(\\alpha) = \\frac{1}{2}.\n$$\n\nSubstituting $\\beta = \\sqrt{1 - |\\alpha|^2}$,\n\n$$\n\\sqrt{1 - |\\alpha|^2} \\cdot \\operatorname{Re}(\\alpha) = \\frac{1}{2}.\n$$\n\nLet $\\alpha = a + ib$ with $a, b \\in \\mathbb{R}$, so $| \\alpha |^2 = a^2 + b^2$ and $\\operatorname{Re}(\\alpha) = a$:\n\n$$\n\\sqrt{1 - (a^2 + b^2)} \\cdot a = \\frac{1}{2}.\n$$\n\nSquaring both sides,\n\n$$\na^2 (1 - a^2 - b^2) = \\frac{1}{4}.\n$$\n\nSince $b^2 \\geq 0$ and $1 - a^2 - b^2 \\geq 0$, define $r^2 = a^2 + b^2$:\n\n$$\na^2 (1 - r^2) = \\frac{1}{4}.\n$$\n\nAlso, $r^2 \\geq a^2$. Solving for $r^2$,\n\n$$\nr^2 = 1 - \\frac{1}{4a^2}, \\quad a \\neq 0.\n$$\n\nThe constraint $r^2 \\geq a^2$ gives:\n\n$$\n1 - \\frac{1}{4a^2} \\geq a^2.\n$$\n\nRearranging,\n\n$$\n4a^4 - 4a^2 + 1 \\leq 0 \\implies (2a^2 - 1)^2 \\leq 0.\n$$\n\nThe square is non-negative and equals zero only when $2a^2 - 1 = 0$, so $a^2 = \\frac{1}{2}$. Then,\n\n$$\nr^2 = 1 - \\frac{1}{4 \\cdot \\frac{1}{2}} = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n\nThus, $b^2 = r^2 - a^2 = \\frac{1}{2} - \\frac{1}{2} = 0$, so $b = 0$. Then $a^2 = \\frac{1}{2}$ and the equation $a \\sqrt{1 - r^2} = a \\beta = \\frac{1}{2}$ becomes:\n\n$$\na \\cdot \\sqrt{1 - \\frac{1}{2}} = a \\cdot \\frac{1}{\\sqrt{2}} = \\frac{1}{2}.\n$$\n\nSolving, $a = \\frac{\\sqrt{2}}{2} = \\frac{1}{\\sqrt{2}}$. Since $\\beta \\operatorname{Re}(\\alpha) = \\frac{1}{2} > 0$ and $\\beta > 0$, $a > 0$, so:\n\n$$\n\\alpha = \\frac{1}{\\sqrt{2}}.\n$$", "answer": "$$ \\boxed{\\dfrac{1}{\\sqrt{2}}} $$", "id": "64987"}, {"introduction": "Moving beyond ideal pure states, this practice explores how controlled operations behave when the control qubit is in a more realistic mixed state, described by a density operator $\\rho_c$. We compare the outcomes of two distinct gates, the CNOT and the Controlled-Hadamard, to understand how different controlled unitaries impart different transformations on the target. This problem [@problem_id:65069] will have you calculate the trace distance between the two resulting states of the target qubit, offering a concrete way to quantify how distinguishable the effects of these two fundamental gates are.", "problem": "Consider a two-qubit quantum system, composed of a control qubit (subscript $c$) and a target qubit (subscript $t$). The control qubit is prepared in a mixed state described by the density operator $\\rho_c = p|0\\rangle_c\\langle0|_c + (1-p)|1\\rangle_c\\langle1|_c$, where $p \\in [0, 1]$ is a real parameter. The target qubit is prepared in the pure state $|\\psi_t\\rangle = |+\\rangle_t = \\frac{1}{\\sqrt{2}}(|0\\rangle_t + |1\\rangle_t)$. The total initial state of the system is $\\rho_{in} = \\rho_c \\otimes |\\psi_t\\rangle\\langle\\psi_t|$.\n\nTwo different controlled operations are applied to this initial state in two separate scenarios.\n1.  **Scenario A:** A Controlled-NOT (CNOT) gate is applied. The CNOT gate is represented by the unitary operator $U_{CNOT} = |0\\rangle_c\\langle0|_c \\otimes I_t + |1\\rangle_c\\langle1|_c \\otimes X_t$, where $I_t$ is the identity operator and $X_t$ is the Pauli-X operator on the target qubit.\n2.  **Scenario B:** A Controlled-Hadamard (CH) gate is applied. The CH gate is represented by the unitary operator $U_{CH} = |0\\rangle_c\\langle0|_c \\otimes I_t + |1\\rangle_c\\langle1|_c \\otimes H_t$, where $H_t$ is the Hadamard operator on the target qubit.\n\nAfter each operation, the control qubit is traced out to obtain the final state of the target qubit. Let $\\rho_{t,A}$ and $\\rho_{t,B}$ be the final density operators for the target qubit in Scenario A and Scenario B, respectively.\n\nYour task is to calculate the trace distance, $D(\\rho_{t,A}, \\rho_{t,B}) = \\frac{1}{2}\\text{Tr}\\sqrt{(\\rho_{t,A} - \\rho_{t,B})^\\dagger(\\rho_{t,A} - \\rho_{t,B})}$, between these two final states of the target qubit. Express your answer as a function of the parameter $p$.", "solution": "1. **Initial state**\n$$\n\\rho_{\\text{in}}=\\bigl(p|0\\rangle\\langle0|+(1-p)|1\\rangle\\langle1|\\bigr)_c \\otimes |+\\rangle\\langle+|_t, \\quad \\text{where } |+\\rangle=\\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle).\n$$\n\n2. **Scenario A (CNOT)**\nUnder CNOT:\n- if control is $|0\\rangle_c$, target $|+\\rangle \\mapsto I|+\\rangle = |+\\rangle$.\n- if control is $|1\\rangle_c$, target $|+\\rangle \\mapsto X|+\\rangle = |+\\rangle$.\nHence the target state after tracing out the control is always $|+\\rangle\\langle+|$, so:\n$$\n\\rho_{t,A}=|+\\rangle\\langle+|.\n$$\n\n3. **Scenario B (CH)**\nUnder CH:\n- if control is $|0\\rangle_c$, target $|+\\rangle \\mapsto I|+\\rangle = |+\\rangle$.\n- if control is $|1\\rangle_c$, target $|+\\rangle \\mapsto H|+\\rangle=|0\\rangle$.\nThus the final target state is:\n$$\n\\rho_{t,B}=p\\,|+\\rangle\\langle+|+(1-p)\\,|0\\rangle\\langle0|.\n$$\n\n4. **Difference and trace distance**\nDefine $\\Delta=\\rho_{t,A}-\\rho_{t,B}=(1-p)\\bigl(|+\\rangle\\langle+|-|0\\rangle\\langle0|\\bigr)$.\nCompute the operator $\\sigma=|+\\rangle\\langle+|-|0\\rangle\\langle0|$:\n$$\n\\sigma=\\frac{1}{2}\\begin{pmatrix}1  1\\\\1  1\\end{pmatrix}-\\begin{pmatrix}1  0\\\\0  0\\end{pmatrix}\n=\\begin{pmatrix}-\\frac{1}{2}  \\frac{1}{2}\\\\\\frac{1}{2}  \\frac{1}{2}\\end{pmatrix}.\n$$\nIts eigenvalues $\\lambda$ solve $\\det(\\sigma - \\lambda I) = (-\\frac{1}{2}-\\lambda)(\\frac{1}{2}-\\lambda)-\\frac{1}{4} = \\lambda^2 - \\frac{1}{2} = 0$, which implies $\\lambda=\\pm\\frac{1}{\\sqrt{2}}$.\nThe trace norm (sum of singular values) is $\\|\\sigma\\|_1=\\sum|\\lambda|= \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} =\\sqrt{2}$.\nHence, the trace distance is:\n$$\nD = \\frac{1}{2}\\text{Tr}|\\Delta|=\\frac{1}{2}(1-p)\\|\\sigma\\|_1=\\frac{1-p}{2}\\sqrt{2}=\\frac{1-p}{\\sqrt{2}}.\n$$", "answer": "$$\\boxed{\\frac{1-p}{\\sqrt{2}}}$$", "id": "65069"}, {"introduction": "Many powerful quantum algorithms, especially for near-term devices, rely on circuits with tunable parameters that are optimized classically. This exercise [@problem_id:64998] introduces this paradigm by examining a controlled-rotation gate, $C-R_y(\\theta)$, whose action is governed by a continuous angle $\\theta$. Your task is to compute the analytic gradient of a measurement outcome with respect to this angle, a procedure that lies at the heart of variational algorithms and gradient-based quantum circuit optimization. This practice provides a direct link between the theory of controlled gates and the practical methods used to train quantum neural networks and find molecular ground states.", "problem": "Consider a two-qubit quantum system, with the first qubit designated as the control qubit and the second as the target qubit. The system is initialized in the product state $|\\psi_{in}\\rangle = |+\\rangle_1 |0\\rangle_2$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$.\n\nA controlled-$R_y(\\theta)$ gate, denoted as $C-R_y(\\theta)$, is applied to this initial state. The action of this gate is to apply the identity operator $I$ to the target qubit if the control qubit is in the state $|0\\rangle$, and to apply the single-qubit rotation $R_y(\\theta)$ to the target qubit if the control qubit is in the state $|1\\rangle$. The operator can be written as:\n$$C-R_y(\\theta) = |0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes R_y(\\theta)$$\nThe rotation gate $R_y(\\theta)$ is defined by the matrix:\n$$R_y(\\theta) = \\exp\\left(-i \\frac{\\theta}{2} Y\\right) = \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix}$$\nwhere $Y$ is the Pauli-Y matrix. The state of the system after the gate is $|\\psi_{out}(\\theta)\\rangle = C-R_y(\\theta) |\\psi_{in}\\rangle$.\n\nFinally, a measurement of the Pauli-Z operator is performed on the target qubit. The observable is thus $M = I_1 \\otimes Z_2$.\n\nYour task is to compute the analytic gradient of the expectation value of the observable $M$ with respect to the gate parameter $\\theta$. Find a closed-form expression for $\\frac{d}{d\\theta} \\langle M \\rangle$, where $\\langle M \\rangle(\\theta) = \\langle\\psi_{out}(\\theta)| M |\\psi_{out}(\\theta)\\rangle$.", "solution": "The initial state is $|\\psi_{in}\\rangle = |+\\rangle_1 |0\\rangle_2 = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |10\\rangle)$.\n\nThe controlled-$R_y(\\theta)$ gate acts as:\n\n$$\nC-R_y(\\theta) = |0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes R_y(\\theta)\n$$\n\nApplying the gate:\n\n$$\nC-R_y(\\theta) |00\\rangle = |0\\rangle \\otimes I|0\\rangle = |00\\rangle\n$$\n\n\n$$\nC-R_y(\\theta) |10\\rangle = |1\\rangle \\otimes R_y(\\theta)|0\\rangle = |1\\rangle \\otimes \\left( \\cos\\left(\\frac{\\theta}{2}\\right) |0\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |1\\rangle \\right) = \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle\n$$\n\nThus, the output state is:\n\n$$\n|\\psi_{out}(\\theta)\\rangle = C-R_y(\\theta) |\\psi_{in}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n\nThe observable is $M = I_1 \\otimes Z_2$. The expectation value $\\langle M \\rangle = \\langle \\psi_{out}(\\theta) | M | \\psi_{out}(\\theta) \\rangle$.\n\nFirst, apply $M$ to $|\\psi_{out}(\\theta)\\rangle$:\n\n$$\nM |\\psi_{out}(\\theta)\\rangle = (I_1 \\otimes Z_2) \\cdot \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\nSince $Z_2 |0\\rangle = |0\\rangle$ and $Z_2 |1\\rangle = -|1\\rangle$:\n\n$$\nM |\\psi_{out}(\\theta)\\rangle = \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle - \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n\nNow compute the inner product:\n\n$$\n\\langle M \\rangle = \\langle \\psi_{out}(\\theta) | M | \\psi_{out}(\\theta) \\rangle = \\frac{1}{2} \\left( \\langle 00| + \\cos\\left(\\frac{\\theta}{2}\\right) \\langle 10| + \\sin\\left(\\frac{\\theta}{2}\\right) \\langle 11| \\right) \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle - \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\nUsing orthonormality of basis states:\n\n$$\n\\langle M \\rangle = \\frac{1}{2} \\left[ \\langle 00|00\\rangle + \\cos^2\\left(\\frac{\\theta}{2}\\right) \\langle 10|10\\rangle - \\sin^2\\left(\\frac{\\theta}{2}\\right) \\langle 11|11\\rangle \\right] = \\frac{1}{2} \\left[ 1 + \\cos^2\\left(\\frac{\\theta}{2}\\right) - \\sin^2\\left(\\frac{\\theta}{2}\\right) \\right]\n$$\n\nUsing the double-angle identity $\\cos(2\\alpha) = \\cos^2(\\alpha) - \\sin^2(\\alpha)$ with $\\alpha = \\theta/2$:\n\n$$\n\\langle M \\rangle = \\frac{1}{2} \\left[ 1 + \\cos(\\theta) \\right]\n$$\n\n\nThe derivative with respect to $\\theta$ is:\n\n$$\n\\frac{d}{d\\theta} \\langle M \\rangle = \\frac{d}{d\\theta} \\left[ \\frac{1}{2} (1 + \\cos(\\theta)) \\right] = \\frac{1}{2} \\cdot (-\\sin(\\theta)) = -\\frac{1}{2} \\sin(\\theta)\n$$", "answer": "$$ \\boxed{-\\dfrac{1}{2}\\sin(\\theta)} $$", "id": "64998"}]}