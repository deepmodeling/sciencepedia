{"hands_on_practices": [{"introduction": "The commutation and anti-commutation relations between Pauli operators are the cornerstone of many quantum information protocols, particularly in the theory of stabilizer codes. Mastering these rules is an essential first step. This exercise offers fundamental practice in applying the commutation laws to identify which operators commute with a given Pauli string, a core skill for constructing and understanding stabilizer groups. [@problem_id:162035]", "problem": "The $n$-qubit Pauli group, denoted $G_n$, plays a fundamental role in quantum error correction and quantum computation. It is defined as the set of operators\n$$\nG_n = \\{ \\gamma P_1 \\otimes P_2 \\otimes \\dots \\otimes P_n \\mid \\gamma \\in \\{+1, -1, +i, -i\\}, P_k \\in \\{I, X, Y, Z\\} \\text{ for each } k=1, \\dots, n \\}\n$$\nwhere $I, X, Y, Z$ are the standard single-qubit Pauli matrices. The *weight* of a Pauli operator $P \\in G_n$ is defined as the number of tensor factors $P_k$ that are not the identity matrix $I$.\n\nTwo Pauli operators $P, Q \\in G_n$ can either commute ($PQ=QP$) or anti-commute ($PQ=-QP$). The commutation relation is determined by the number of positions where both operators have non-identity, anti-commuting Pauli matrices. Specifically, for $P = \\gamma_P \\bigotimes_k P_k$ and $Q = \\gamma_Q \\bigotimes_k Q_k$, we have $PQ = (-1)^c QP$, where $c$ is the number of indices $k$ for which $\\{P_k, Q_k\\} = P_k Q_k + Q_k P_k = 0$. Note that any Pauli matrix commutes with $I$ and itself, while two distinct non-identity Pauli matrices (e.g., $X$ and $Y$) anti-commute.\n\nConsider a system of $n$ qubits with $n \\ge 2$. Let $Q$ be the specific weight-2 operator in $G_n$ given by\n$$\nQ = X_1 \\otimes Z_2 \\otimes I_3 \\otimes \\dots \\otimes I_n\n$$\nYour task is to count the total number of weight-1 operators $P \\in G_n$ that commute with $Q$. Find this number as a function of $n$.", "solution": "The goal is to count the total number of weight-1 operators in the $n$-qubit Pauli group $G_n$ that commute with the fixed weight-2 operator $Q = X_1 \\otimes Z_2 \\otimes I_3 \\otimes \\dots \\otimes I_n$.\n\nA weight-1 operator $P \\in G_n$ acts non-trivially on exactly one qubit. Thus, $P$ has the form:\n\n$$\nP = \\gamma \\bigotimes_{k=1}^n R_k, \\quad \\gamma \\in \\{+1, -1, +i, -i\\},\n$$\n\nwhere exactly one $R_k$ is in $\\{X, Y, Z\\}$ and all others are $I$. The commutation relation between $P$ and $Q$ is independent of the phase factor $\\gamma$, as $\\gamma$ commutes with all operators. Therefore, the commutation depends only on the non-phase part of $P$.\n\nLet $P' = \\bigotimes_{k=1}^n R_k$ denote the non-phase part of $P$. The commutation relation is determined by the anti-commutation at each qubit position. Specifically, $P'$ and $Q$ commute if the number of positions $k$ where $\\{R_k, S_k\\} = 0$ (with $S_k$ the Pauli matrix in $Q$ at position $k$) is even. Since $P'$ is weight-1, it acts non-trivially at only one position $j$, so:\n- At positions $k \\neq j$, $R_k = I$, and $I$ commutes with any Pauli matrix.\n- At position $j$, we check if $R_j$ commutes with the Pauli matrix in $Q$ at $j$.\n\nThe operator $Q$ has:\n- $X$ at position 1,\n- $Z$ at position 2,\n- $I$ at positions $3$ to $n$.\n\nConsider the position $j$ where $P'$ acts non-trivially:\n\n- **Case 1: $j = 1$**  \n  $R_1$ must commute with $X$ (the Pauli in $Q$ at position 1). The commutation relations are:\n  - $X$ commutes with $X$,\n  - $X$ anti-commutes with $Y$,\n  - $X$ anti-commutes with $Z$.  \n  Thus, only $R_1 = X$ commutes. There is 1 such non-phase operator.\n\n- **Case 2: $j = 2$**  \n  $R_2$ must commute with $Z$ (the Pauli in $Q$ at position 2). The commutation relations are:\n  - $Z$ commutes with $Z$,\n  - $Z$ anti-commutes with $X$,\n  - $Z$ anti-commutes with $Y$.  \n  Thus, only $R_2 = Z$ commutes. There is 1 such non-phase operator.\n\n- **Case 3: $j \\geq 3$**  \n  At position $j$, $Q$ has $I$, and $I$ commutes with any Pauli matrix. Thus, $R_j$ can be $X$, $Y$, or $Z$. There are 3 choices per position. Since $j$ ranges from 3 to $n$, there are $n-2$ positions, giving $3(n-2)$ non-phase operators.\n\nSumming the non-phase operators that commute with $Q$:\n\n$$\n1 + 1 + 3(n-2) = 2 + 3n - 6 = 3n - 4.\n$$\n\nEach non-phase operator corresponds to 4 operators in $G_n$ due to the phase factor $\\gamma \\in \\{+1, -1, +i, -i\\}$. Therefore, the total number of weight-1 operators commuting with $Q$ is:\n\n$$\n4 \\times (3n - 4) = 12n - 16.\n$$\n\nThis result holds for $n \\geq 2$.", "answer": "$$ \\boxed{12n - 16} $$", "id": "162035"}, {"introduction": "Analyzing the effect of quantum gates by direct matrix multiplication becomes unwieldy for multi-qubit systems. A more elegant and scalable approach is the symplectic representation, which maps the action of Clifford gates on Pauli operators to simple matrix-vector operations over the binary field $\\mathbb{F}_2$. This practice guides you through the derivation of the symplectic matrix for the CNOT gate, a fundamental skill for simulating Clifford circuits and analyzing quantum error-correcting codes. [@problem_id:162038]", "problem": "The $n$-qubit Pauli group $P_n$ is the group generated by tensor products of the Pauli matrices $\\{I, X, Y, Z\\}$, including phase factors $\\{\\pm 1, \\pm i\\}$. Elements of the Clifford group $C_n$ are unitary operators that normalize the Pauli group, i.e., for any $U \\in C_n$ and $P \\in P_n$, we have $U P U^\\dagger \\in P_n$.\n\nAn element of the Pauli group (up to a phase factor) can be represented by a binary vector of length $2n$. Let's consider a specific representation for $n=2$ qubits. A Pauli operator $P = P_1 \\otimes P_2$, where $P_k \\in \\{I, X, Y, Z\\}$, can be associated with a vector $v = (x_1, z_1, x_2, z_2)^T \\in \\mathbb{F}_2^4$. The mapping is defined by the generators:\n$X_1 = X \\otimes I \\quad \\leftrightarrow \\quad v_{X_1} = (1, 0, 0, 0)^T$\n$Z_1 = Z \\otimes I \\quad \\leftrightarrow \\quad v_{Z_1} = (0, 1, 0, 0)^T$\n$X_2 = I \\otimes X \\quad \\leftrightarrow \\quad v_{X_2} = (0, 0, 1, 0)^T$\n$Z_2 = I \\otimes Z \\quad \\leftrightarrow \\quad v_{Z_2} = (0, 0, 0, 1)^T$\nThis establishes a basis for $\\mathbb{F}_2^4$. An arbitrary Pauli operator $P = X_1^{a_1} Z_1^{b_1} X_2^{a_2} Z_2^{b_2}$ (ignoring phases) is represented by the vector $(a_1, b_1, a_2, b_2)^T$.\n\nThe action of a Clifford gate $U$ on a Pauli operator $P(v)$ corresponds to a linear transformation on its vector representation $v$. That is, if $U P(v) U^\\dagger = c \\cdot P(v')$ for some phase $c$, then $v' = S_U v$, where $S_U$ is a $2n \\times 2n$ matrix over $\\mathbb{F}_2$ called a symplectic matrix.\n\nConsider the two-qubit Controlled-NOT (CNOT) gate, with qubit 1 as the control and qubit 2 as the target. Its matrix in the computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ is\n$$ CNOT = |0\\rangle\\langle0| \\otimes I + |1\\rangle\\langle1| \\otimes X = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} $$\nDetermine the $4 \\times 4$ symplectic matrix $S_{CNOT}$ over the field $\\mathbb{F}_2$ that describes the transformation of the vector representation $(x_1, z_1, x_2, z_2)^T$ under conjugation by the CNOT gate.", "solution": "A Pauli operator on two qubits is represented by the vector $v = (x_1, z_1, x_2, z_2)^T$ for the operator $P(v)=X_1^{x_1}Z_1^{z_1}X_2^{x_2}Z_2^{z_2}.$\n\nConjugation by the CNOT gate $U$ acts on the generators as:\n$$U X_1 U^\\dagger = X_1X_2, \\quad U Z_1 U^\\dagger = Z_1, \\quad U X_2 U^\\dagger = X_2, \\quad U Z_2 U^\\dagger = Z_1Z_2.$$\n\nFor a general operator $P(v)$, conjugation gives $U\\,P(v)\\,U^\\dagger = (X_1X_2)^{x_1}Z_1^{z_1}X_2^{x_2}(Z_1Z_2)^{z_2}$. Up to an overall phase, this simplifies to $X_1^{x_1}Z_1^{z_1+z_2}X_2^{x_1+x_2}Z_2^{z_2}$.\n\nReading off the new exponents modulo 2, we find the transformation $v \\to v' = S_{CNOT} v$:\n$$\n\\begin{cases}\n    x_1' = x_1 \\\\\n    z_1' = z_1 + z_2 \\\\\n    x_2' = x_1 + x_2 \\\\\n    z_2' = z_2\n\\end{cases}\n$$\nThis transformation corresponds to the symplectic matrix over $\\mathbb F_2$:\n$$\nS_{CNOT} = \n\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 1\\\\\n1 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 1\\\\\n1 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}}$$", "id": "162038"}, {"introduction": "The set of Pauli strings forms a complete orthogonal basis for the space of operators acting on $n$ qubits, a property with profound implications for quantum information processing. One key application is the ability to decompose any quantum gate, such as the Controlled-Z ($CZ$) gate, into a linear combination of Pauli operators. This exercise challenges you to find the component of the $CZ$ gate that aligns most strongly with a Pauli operator, measured via the Hilbert-Schmidt inner product, providing insight into techniques for gate characterization and quantum process tomography. [@problem_id:162016]", "problem": "The $n$-qubit Pauli group, $G_n$, is the group generated by the $n$-fold tensor products of the single-qubit Pauli matrices $\\{I, X, Y, Z\\}$ and the phase factors $\\{1, -1, i, -i\\}$. Any element $P \\in G_n$ can be written as $P = \\gamma \\sigma_{k_1} \\otimes \\sigma_{k_2} \\otimes \\dots \\otimes \\sigma_{k_n}$, where $\\gamma \\in \\{1, -1, i, -i\\}$, each $\\sigma_{k_j} \\in \\{I, X, Y, Z\\}$, and the single-qubit Pauli matrices are given by:\n$$\nI = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad X = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad Y = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}, \\quad Z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}.\n$$\n\nThe Hilbert-Schmidt inner product between two operators $A$ and $B$ acting on a $d$-dimensional Hilbert space is defined as $\\langle A, B \\rangle_{HS} = \\text{Tr}(A^\\dagger B)$.\n\nThe controlled-Z (CZ) gate is a fundamental two-qubit quantum gate. In the standard computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$, its matrix representation is:\n$$\nU_{CZ} = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & -1\n\\end{pmatrix}\n$$\n\nYour task is to determine the maximum possible value of the squared Hilbert-Schmidt overlap, $|\\langle U_{CZ}, P \\rangle_{HS}|^2$, between the two-qubit CZ gate, $U_{CZ}$, and any element $P$ from the two-qubit Pauli group $G_2$.", "solution": "We want to find the maximum value of the squared Hilbert-Schmidt overlap between the controlled-Z gate $U_{CZ}$ and an element $P$ of the two-qubit Pauli group $G_2$. Let this maximum value be $M$.\n$$\nM = \\max_{P \\in G_2} |\\langle U_{CZ}, P \\rangle_{HS}|^2\n$$\n\nThe Hilbert-Schmidt inner product is defined as $\\langle A, B \\rangle_{HS} = \\text{Tr}(A^\\dagger B)$. For our case, this is $\\langle U_{CZ}, P \\rangle_{HS} = \\text{Tr}(U_{CZ}^\\dagger P)$. The CZ gate is both unitary ($U_{CZ}^\\dagger U_{CZ} = I$) and Hermitian ($U_{CZ}^\\dagger = U_{CZ}$), so $U_{CZ}^\\dagger = U_{CZ}$.\nThe expression for the inner product becomes $\\langle U_{CZ}, P \\rangle_{HS} = \\text{Tr}(U_{CZ} P)$.\n\nAn element $P \\in G_2$ is of the form $P = \\gamma (\\sigma_j \\otimes \\sigma_k)$, where $\\gamma \\in \\{1, -1, i, -i\\}$ and $\\sigma_j, \\sigma_k \\in \\{I, X, Y, Z\\}$.\nLet's analyze the squared overlap:\n$$\n|\\langle U_{CZ}, P \\rangle_{HS}|^2 = |\\text{Tr}(U_{CZ} (\\gamma (\\sigma_j \\otimes \\sigma_k)))|^2 = |\\gamma \\text{Tr}(U_{CZ} (\\sigma_j \\otimes \\sigma_k))|^2\n$$\nSince $\\gamma$ is a phase factor, $|\\gamma|^2 = 1$. Therefore, the phase factor does not affect the magnitude of the squared overlap. We can write:\n$$\n|\\langle U_{CZ}, P \\rangle_{HS}|^2 = |\\text{Tr}(U_{CZ} (\\sigma_j \\otimes \\sigma_k))|^2\n$$\nThe problem is now reduced to maximizing this quantity over the $4 \\times 4 = 16$ possible choices for the Pauli string $\\sigma_j \\otimes \\sigma_k$.\n\nThe set of Pauli strings $\\{\\sigma_j \\otimes \\sigma_k\\}$ for $j,k \\in \\{I,X,Y,Z\\}$ forms an orthogonal basis for the space of $4 \\times 4$ matrices. Any operator on the two-qubit space, such as $U_{CZ}$, can be expanded in this basis:\n$$\nU_{CZ} = \\sum_{j,k \\in \\{I,X,Y,Z\\}} c_{jk} (\\sigma_j \\otimes \\sigma_k)\n$$\nThe coefficients $c_{jk}$ are found using the orthogonality property of the Pauli basis, $\\text{Tr}((\\sigma_a \\otimes \\sigma_b)(\\sigma_c \\otimes \\sigma_d)) = 4 \\delta_{ac}\\delta_{bd}$. The coefficient is given by:\n$$\nc_{jk} = \\frac{\\text{Tr}((\\sigma_j \\otimes \\sigma_k)^\\dagger U_{CZ})}{\\text{Tr}((\\sigma_j \\otimes \\sigma_k)^\\dagger (\\sigma_j \\otimes \\sigma_k))} = \\frac{\\text{Tr}((\\sigma_j \\otimes \\sigma_k) U_{CZ})}{4}\n$$\nwhere we used that Pauli matrices are Hermitian.\nFrom this, we see that $\\text{Tr}(U_{CZ} (\\sigma_j \\otimes \\sigma_k)) = 4 c_{jk}$.\nThe quantity we want to maximize is therefore:\n$$\nM = \\max_{j,k} |4 c_{jk}|^2 = 16 \\max_{j,k} |c_{jk}|^2\n$$\nWe need to compute the coefficients $c_{jk}$. This involves calculating the trace $\\text{Tr}((\\sigma_j \\otimes \\sigma_k) U_{CZ})$.\nThe matrix $U_{CZ}$ is diagonal in the computational basis: $U_{CZ} = \\text{diag}(1, 1, 1, -1)$.\nThe trace of a product of a diagonal matrix $D$ and any matrix $A$ is $\\text{Tr}(DA) = \\sum_i D_{ii}A_{ii}$.\nHere, $A = \\sigma_j \\otimes \\sigma_k$. For the trace to be non-zero, the matrix $A$ must have at least one non-zero diagonal element. The Pauli tensor products $\\sigma_j \\otimes \\sigma_k$ have non-zero diagonal elements only if both $\\sigma_j$ and $\\sigma_k$ are diagonal matrices themselves. The only diagonal Pauli matrices are $I$ and $Z$.\nTherefore, we only need to consider the four cases where $j,k \\in \\{I,Z\\}$. For all other 12 pairs, the trace is zero, so $c_{jk}=0$.\n\nLet's compute the four non-zero coefficients:\n1.  $j=I, k=I$: $\\sigma_I \\otimes \\sigma_I = I \\otimes I = \\text{diag}(1,1,1,1)$.\n    $\\text{Tr}((I \\otimes I)U_{CZ}) = \\text{Tr}(\\text{diag}(1,1,1,1) \\cdot \\text{diag}(1,1,1,-1)) = \\text{Tr}(\\text{diag}(1,1,1,-1)) = 1+1+1-1=2$.\n    $c_{II} = \\frac{2}{4} = \\frac{1}{2}$.\n\n2.  $j=I, k=Z$: $\\sigma_I \\otimes \\sigma_Z = I \\otimes Z = \\text{diag}(1,-1,1,-1)$.\n    $\\text{Tr}((I \\otimes Z)U_{CZ}) = \\text{Tr}(\\text{diag}(1,-1,1,-1) \\cdot \\text{diag}(1,1,1,-1)) = \\text{Tr}(\\text{diag}(1,-1,1,1)) = 1-1+1+1=2$.\n    $c_{IZ} = \\frac{2}{4} = \\frac{1}{2}$.\n\n3.  $j=Z, k=I$: $\\sigma_Z \\otimes \\sigma_I = Z \\otimes I = \\text{diag}(1,1,-1,-1)$.\n    $\\text{Tr}((Z \\otimes I)U_{CZ}) = \\text{Tr}(\\text{diag}(1,1,-1,-1) \\cdot \\text{diag}(1,1,1,-1)) = \\text{Tr}(\\text{diag}(1,1,-1,1)) = 1+1-1+1=2$.\n    $c_{ZI} = \\frac{2}{4} = \\frac{1}{2}$.\n\n4.  $j=Z, k=Z$: $\\sigma_Z \\otimes \\sigma_Z = Z \\otimes Z = \\text{diag}(1,-1,-1,1)$.\n    $\\text{Tr}((Z \\otimes Z)U_{CZ}) = \\text{Tr}(\\text{diag}(1,-1,-1,1) \\cdot \\text{diag}(1,1,1,-1)) = \\text{Tr}(\\text{diag}(1,-1,-1,-1)) = 1-1-1-1=-2$.\n    $c_{ZZ} = \\frac{-2}{4} = -\\frac{1}{2}$.\n\nAll other coefficients $c_{jk}$ are zero. The set of non-zero coefficients is $\\{c_{II}, c_{IZ}, c_{ZI}, c_{ZZ}\\}$. Their magnitudes are all equal:\n$|c_{II}| = |c_{IZ}| = |c_{ZI}| = |c_{ZZ}| = \\frac{1}{2}$.\nThe maximum squared magnitude is $\\max_{j,k} |c_{jk}|^2 = (\\frac{1}{2})^2 = \\frac{1}{4}$.\n\nFinally, the maximum squared Hilbert-Schmidt overlap is $|\\langle U_{CZ}, P \\rangle_{HS}|^2 = |\\text{Tr}(U_{CZ} P)|^2$. For $P=\\gamma(\\sigma_j \\otimes \\sigma_k)$, this is $|\\text{Tr}(U_{CZ} (\\sigma_j \\otimes \\sigma_k))|^2$. The maximum value of $|\\text{Tr}(U_{CZ} (\\sigma_j \\otimes \\sigma_k))|$ is $|-2|=2$. Therefore, the maximum squared overlap is $2^2=4$.\nThis maximum value is achieved for any Pauli group element $P$ of the form $\\gamma(\\sigma_j \\otimes \\sigma_k)$ where $j,k \\in \\{I,Z\\}$ and $\\gamma$ is any of the allowed phase factors.", "answer": "$$\n\\boxed{4}\n$$", "id": "162016"}]}