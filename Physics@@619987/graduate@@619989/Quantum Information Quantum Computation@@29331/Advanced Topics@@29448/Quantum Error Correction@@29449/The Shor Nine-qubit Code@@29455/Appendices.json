{"hands_on_practices": [{"introduction": "The Shor code's robustness stems from its hierarchical, concatenated structure. The nine physical qubits are partitioned into three nearly independent blocks, with entanglement existing primarily within each block. This introductory exercise [@problem_id:172094] invites you to probe this structure by calculating joint measurement probabilities on qubits from different blocks, providing a hands-on feel for the statistical properties of the logical zero state, $|\\bar{0}\\rangle$.", "problem": "The Shor nine-qubit code is a landmark in quantum error correction, capable of protecting a single logical qubit from arbitrary single-qubit errors. It is a concatenated code constructed in two stages. First, a single qubit is encoded using a three-qubit phase-flip code. Then, each of these three qubits is individually encoded using a three-qubit bit-flip code.\n\nLet's trace the encoding of the logical zero state, $|0\\rangle$:\n1.  **Outer Code (Phase-Flip Protection):** The state $|0\\rangle$ is first encoded into a three-qubit state using a code that turns phase-flips into bit-flips. This is achieved by encoding in the Hadamard basis: $|0\\rangle \\mapsto |+\\rangle|+\\rangle|+\\rangle$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$.\n2.  **Inner Code (Bit-Flip Protection):** Each of the three $|+\\rangle$ qubits is then encoded using the three-qubit bit-flip code, which protects against $X$ errors. The state $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ is transformed into $\\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)$.\n\nThe final nine-qubit logical zero state, denoted $|\\bar{0}\\rangle$, is the tensor product of the three resulting three-qubit blocks. Thus, the state of the nine physical qubits (labeled 1 to 9) is:\n$$ |\\bar{0}\\rangle = \\left[\\frac{1}{\\sqrt{2}}(|000\\rangle+|111\\rangle)\\right]_{1,2,3} \\otimes \\left[\\frac{1}{\\sqrt{2}}(|000\\rangle+|111\\rangle)\\right]_{4,5,6} \\otimes \\left[\\frac{1}{\\sqrt{2}}(|000\\rangle+|111\\rangle)\\right]_{7,8,9} $$\n\nGiven a quantum system prepared in the logical zero state $|\\bar{0}\\rangle$ of the Shor code, suppose a measurement is performed on the first and fourth physical qubits in the Hadamard basis. What is the probability that both measurements yield the outcome $|+\\rangle$?", "solution": "The nine-qubit logical zero state $|\\bar{0}\\rangle$ factorizes into a tensor product of three independent three-qubit block states. Therefore, measurements on qubit 1 (in block 1) and qubit 4 (in block 2) are uncorrelated. We can compute the probability of measuring the outcome $|+\\rangle$ for a single qubit in one block and then square it to find the joint probability.\n\n1.  The state of a single three-qubit block is:\n    $$ |\\psi_{\\text{blk}}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle) $$\n\n2.  To find the state of the first qubit in the block, we trace out the other two qubits to find its reduced density matrix $\\rho_1$:\n    $$ \\rho_1 = \\mathrm{Tr}_{2,3}(|\\psi_{\\text{blk}}\\rangle\\langle\\psi_{\\text{blk}}|) = \\frac{1}{2}\\left( |0\\rangle\\langle0| + |1\\rangle\\langle1| \\right) = \\frac{1}{2}I $$\n    This is the maximally mixed state, indicating the qubit is in a completely random state.\n\n3.  The probability of measuring this qubit in the state $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ is given by $P(+) = \\langle+|\\rho_1|+\\rangle$:\n    $$ P(+) = \\langle+|\\left(\\frac{1}{2}I\\right)|+\\rangle = \\frac{1}{2}\\langle+|+\\rangle = \\frac{1}{2} $$\n\n4.  Since the outcomes for qubit 1 and qubit 4 are independent events, the joint probability of both yielding $|+\\rangle$ is the product of their individual probabilities:\n    $$ P(+,+) = P(+)_{\\text{qubit 1}} \\times P(+)_{\\text{qubit 4}} = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4} $$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "172094"}, {"introduction": "A crucial step in quantum error correction is the digitization of analog physical errors into discrete syndromes. This practice [@problem_id:172122] provides a concrete example of this process by considering a coherent rotation error, described by an angle $\\theta$. You will calculate the probability that a stabilizer measurement yields a non-trivial outcome, demonstrating how the continuous nature of the error is translated into a discrete, detectable signal that forms the basis of error diagnosis.", "problem": "The Shor nine-qubit code is a quantum error-correcting code that encodes a single logical qubit into nine physical qubits. It is designed to protect against arbitrary single-qubit errors. The logical zero state, denoted as $|\\bar{0}\\rangle$, is constructed through a two-level concatenation process. First, a logical qubit is encoded using a three-qubit phase-flip code. Then, each of the three resulting qubits is encoded using a three-qubit bit-flip code. This procedure yields the state:\n$$|\\bar{0}\\rangle = \\frac{1}{2\\sqrt{2}} \\left(|000\\rangle + |111\\rangle\\right) \\otimes \\left(|000\\rangle + |111\\rangle\\right) \\otimes \\left(|000\\rangle + |111\\rangle\\right)$$\nwhere the qubits are numbered 1 to 9, with qubits $\\{1, 2, 3\\}$, $\\{4, 5, 6\\}$, and $\\{7, 8, 9\\}$ forming the three respective blocks.\n\nThe code is a stabilizer code, and one of its stabilizer generators is $S_1 = Z_1 Z_2$, where $Z_i$ is the Pauli-Z operator acting on qubit $i$. A syndrome measurement of $S_1$ on a state $|\\psi\\rangle$ projects the state onto one of the eigenspaces of $S_1$, corresponding to eigenvalues $+1$ or $-1$.\n\nSuppose the system is prepared in the logical zero state $|\\bar{0}\\rangle$. A coherent rotation error occurs on the first qubit, described by the operator $E = R_x(\\theta) = \\exp(-i \\frac{\\theta}{2} X_1)$, where $X_1$ is the Pauli-X operator on qubit 1 and $\\theta$ is a real-valued rotation angle.\n\nCalculate the probability that a subsequent measurement of the stabilizer $S_1 = Z_1 Z_2$ yields the syndrome result $-1$. Express your answer in terms of $\\theta$.", "solution": "1. The initial state is the logical zero state $|\\bar{0}\\rangle$. After the error $E = R_x(\\theta)$ on qubit 1, the state becomes $|\\psi\\rangle = E|\\bar{0}\\rangle$. The stabilizer $S_1=Z_1Z_2$ only acts on the first block of qubits, so we only need to consider the state of qubits {1, 2, 3}. The initial state of this block is $|\\psi_{\\text{blk}}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle+|111\\rangle)$.\n\n2. The error operator is $E = R_x(\\theta) = \\cos(\\frac{\\theta}{2})I_1 - i\\sin(\\frac{\\theta}{2})X_1$. Applying this to the block state:\n$$ |\\psi'_{\\text{blk}}\\rangle = E |\\psi_{\\text{blk}}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\cos\\left(\\frac{\\theta}{2}\\right)I_1 - i\\sin\\left(\\frac{\\theta}{2}\\right)X_1 \\right) (|000\\rangle + |111\\rangle) $$\n$$ |\\psi'_{\\text{blk}}\\rangle = \\frac{1}{\\sqrt{2}} \\left[ \\cos\\left(\\frac{\\theta}{2}\\right) (|000\\rangle + |111\\rangle) - i\\sin\\left(\\frac{\\theta}{2}\\right) (|100\\rangle + |011\\rangle) \\right] $$\n\n3. We want to find the probability of measuring the syndrome $-1$ for the stabilizer $S_1 = Z_1Z_2$. This corresponds to projecting the state $|\\psi'_{\\text{blk}}\\rangle$ onto the eigenspace of $S_1$ with eigenvalue $-1$. The projector for this outcome is $\\Pi_- = \\frac{1}{2}(I - Z_1Z_2)$. The probability is $P(-1) = \\langle\\psi'_{\\text{blk}}|\\Pi_-|\\psi'_{\\text{blk}}\\rangle$.\n\nAn equivalent way is to find the total probability of the state being in basis states that are eigenvectors of $S_1$ with eigenvalue $-1$. The operator $Z_1Z_2$ has an eigenvalue of $-1$ for states where qubits 1 and 2 are different (e.g., $|01\\rangle$ and $|10\\rangle$). From the expression for $|\\psi'_{\\text{blk}}\\rangle$, the basis states corresponding to the $-1$ eigenspace are $|100\\rangle$ and $|011\\rangle$.\n\n4. The probability is the sum of the squared magnitudes of the amplitudes of these basis states:\n$$ P(-1) = \\left| \\frac{-i\\sin(\\theta/2)}{\\sqrt{2}} \\right|^2 + \\left| \\frac{-i\\sin(\\theta/2)}{\\sqrt{2}} \\right|^2 $$\n$$ P(-1) = \\frac{\\sin^2(\\theta/2)}{2} + \\frac{\\sin^2(\\theta/2)}{2} = \\sin^2\\left(\\frac{\\theta}{2}\\right) $$", "answer": "$$\\boxed{\\sin^2\\left(\\frac{\\theta}{2}\\right)}$$", "id": "172122"}, {"introduction": "While designed to perfectly handle any single-qubit error, all quantum codes have limitations. This advanced practice [@problem_id:172113] explores what happens when the Shor code confronts a correlated two-qubit error, an event it is not designed to correct. By tracing the standard correction procedure's response, you will discover how the uncorrected portion of the physical error can manifest as a detrimental logical operation on the encoded qubit, a critical concept in fault-tolerant design.", "problem": "The Shor nine-qubit code is a quantum error-correcting code that can protect a single logical qubit from an arbitrary single-qubit error on any of its nine physical qubits. The code is a concatenated code, and one standard construction leads to the logical basis states $|\\bar{0}\\rangle$ and $|\\bar{1}\\rangle$ defined as follows.\n\nFirst, define the three-qubit states:\n$$|C_0\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)$$\n$$|C_1\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle - |111\\rangle)$$\n\nThe nine qubits are partitioned into three blocks: block A (qubits 1, 2, 3), block B (qubits 4, 5, 6), and block C (qubits 7, 8, 9). The logical basis states are then given by:\n$$|\\bar{0}\\rangle = |C_0\\rangle_A \\otimes |C_0\\rangle_B \\otimes |C_0\\rangle_C$$\n$$|\\bar{1}\\rangle = |C_1\\rangle_A \\otimes |C_1\\rangle_B \\otimes |C_1\\rangle_C$$\n\nError correction is performed by measuring a set of stabilizer generators. There are two types of generators for this code:\n1.  Six generators to detect bit-flip type errors within each block:\n    $S_Z = \\{Z_1Z_2, Z_2Z_3, Z_4Z_5, Z_5Z_6, Z_7Z_8, Z_8Z_9\\}$\n2.  Two generators to detect phase-flip type errors across the blocks:\n    $S_X = \\{ X_1X_2X_3X_4X_5X_6, X_4X_5X_6X_7X_8X_9 \\}$\n\nThe standard decoding procedure for single-qubit errors involves measuring the eigenvalues of all eight stabilizer generators. A non-trivial syndrome (any eigenvalue being -1) indicates an error. The procedure assumes at most a single-qubit error has occurred. If a syndrome indicates an error localized to a specific block (e.g., a phase error on block C), the correction operation is, by convention, applied to the first qubit of that block (e.g., $Z_7$ for a phase error on block C).\n\nSuppose the system is initialized in the state:\n$$|\\psi_{in}\\rangle = \\frac{1}{\\sqrt{3}}|\\bar{0}\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{1}\\rangle$$\nA correlated two-qubit error $E = Z_1Z_4$ occurs, where $Z_k$ is the Pauli-Z operator on qubit $k$. Following this error, the standard single-qubit error correction procedure described above is performed.\n\nCalculate the final fidelity $F = |\\langle \\psi_{in} | \\psi_{final} \\rangle|^2$, where $|\\psi_{final}\\rangle$ is the state of the system after the error and the subsequent correction attempt.", "solution": "The problem asks for the fidelity between an initial state $|\\psi_{in}\\rangle$ and the final state $|\\psi_{final}\\rangle$ after a correlated error $E=Z_1Z_4$ and a subsequent standard single-qubit error correction procedure.\n\n**Step 1: Analyze the error and the resulting syndrome**\n\nThe state after the error is $|\\psi_{err}\\rangle = E |\\psi_{in}\\rangle = Z_1Z_4 |\\psi_{in}\\rangle$. The error correction procedure measures the eigenvalues of the stabilizer generators. An operator $O$ gives eigenvalue $+1$ if it commutes with the error ($[E,O]=0$) and $-1$ if it anti-commutes ($\\{E,O\\}=0$), assuming the initial state is a stabilized state.\n\nFirst, we check the bit-flip syndromes by measuring the stabilizers in $S_Z$:\nFor any generator $Z_iZ_j \\in S_Z$, the Pauli-Z operators commute with each other. Thus, $[Z_1Z_4, Z_iZ_j] = 0$ for all generators in $S_Z$. The measurement of all six $S_Z$ generators will yield $+1$. The decoder concludes that no $X$ or $Y$ error has occurred.\n\nNext, we check the phase-flip syndromes by measuring the stabilizers in $S_X$:\nLet $S_{X,1} = X_1X_2X_3X_4X_5X_6$ and $S_{X,2} = X_4X_5X_6X_7X_8X_9$. We check their commutation with the error $E=Z_1Z_4$.\nFor $S_{X,1}$:\nSince $X_i$ and $Z_j$ anti-commute if $i=j$ and commute otherwise, $X_1$ anti-commutes with $Z_1$, and $X_4$ anti-commutes with $Z_4$. There are two anti-commuting pairs, so the overall operators commute: $S_{X,1}E = S_{X,1}Z_1Z_4 = (-Z_1S_{X,1})Z_4 = -Z_1(-Z_4S_{X,1}) = Z_1Z_4S_{X,1} = ES_{X,1}$.\nSo, $[S_{X,1}, E] = 0$. The measurement of $S_{X,1}$ yields $+1$.\n\nFor $S_{X,2}$:\nHere, only $X_4$ anti-commutes with a term in $E$ (namely $Z_4$). There is one anti-commutation, so the operators anti-commute: $S_{X,2}E = S_{X,2}Z_1Z_4 = Z_1S_{X,2}Z_4 = Z_1(-Z_4S_{X,2}) = -ES_{X,2}$.\nSo, $\\{S_{X,2}, E\\} = 0$. The measurement of $S_{X,2}$ yields $-1$.\n\nThe full syndrome for phase errors is $(+1, -1)$.\n\n**Step 2: Determine the correction operator**\n\nThe decoder is designed to correct single-qubit errors. It interprets the syndrome $(+1, -1)$ as arising from a single Pauli-Z error.\n- A single $Z$ error on block A (qubits 1,2,3) would anti-commute with $S_{X,1}$ and commute with $S_{X,2}$, giving syndrome $(-1, +1)$.\n- A single $Z$ error on block B (qubits 4,5,6) would anti-commute with both $S_{X,1}$ and $S_{X,2}$, giving syndrome $(-1, -1)$.\n- A single $Z$ error on block C (qubits 7,8,9) would commute with $S_{X,1}$ and anti-commute with $S_{X,2}$, giving syndrome $(+1, -1)$.\n\nThe measured syndrome $(+1, -1)$ matches a single $Z$ error on block C. By the stated convention, a correction is applied to the first qubit of that block. So, the correction operator is $C = Z_7$.\n\n**Step 3: Determine the residual logical operator**\n\nThe final state after the correction attempt is:\n$|\\psi_{final}\\rangle = C |\\psi_{err}\\rangle = C E |\\psi_{in}\\rangle = Z_7 (Z_1Z_4) |\\psi_{in}\\rangle$.\nThe state is transformed by the residual operator $O_{res} = Z_1Z_4Z_7$.\n\nWe need to determine how this operator acts on the logical subspace. We examine its action on the logical basis states $|\\bar{0}\\rangle$ and $|\\bar{1}\\rangle$. Recall the action of a single Pauli-Z on the block-level states:\n$Z_i |C_0\\rangle = Z_i \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle) = \\frac{1}{\\sqrt{2}}(|000\\rangle - |111\\rangle) = |C_1\\rangle$\n$Z_i |C_1\\rangle = Z_i \\frac{1}{\\sqrt{2}}(|000\\rangle - |111\\rangle) = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle) = |C_0\\rangle$\nfor any qubit $i$ in the corresponding block.\n\nNow, we apply $O_{res} = Z_1Z_4Z_7$ to the logical basis states:\n$O_{res} |\\bar{0}\\rangle = (Z_1Z_4Z_7) (|C_0\\rangle_A |C_0\\rangle_B |C_0\\rangle_C) = (Z_1|C_0\\rangle_A)(Z_4|C_0\\rangle_B)(Z_7|C_0\\rangle_C) = |C_1\\rangle_A|C_1\\rangle_B|C_1\\rangle_C = |\\bar{1}\\rangle$.\n$O_{res} |\\bar{1}\\rangle = (Z_1Z_4Z_7) (|C_1\\rangle_A |C_1\\rangle_B |C_1\\rangle_C) = (Z_1|C_1\\rangle_A)(Z_4|C_1\\rangle_B)(Z_7|C_1\\rangle_C) = |C_0\\rangle_A|C_0\\rangle_B|C_0\\rangle_C = |\\bar{0}\\rangle$.\n\nThe operator $O_{res}$ swaps the logical basis states. This is the definition of the logical Pauli-X operator, $\\bar{X}$. So, $O_{res} = \\bar{X}$.\n\n**Step 4: Calculate the fidelity**\n\nThe initial state is $|\\psi_{in}\\rangle = \\frac{1}{\\sqrt{3}}|\\bar{0}\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{1}\\rangle$.\nThe final state is $|\\psi_{final}\\rangle = O_{res} |\\psi_{in}\\rangle = \\bar{X} |\\psi_{in}\\rangle$.\nApplying $\\bar{X}$ to $|\\psi_{in}\\rangle$:\n$$|\\psi_{final}\\rangle = \\bar{X} \\left( \\frac{1}{\\sqrt{3}}|\\bar{0}\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{1}\\rangle \\right) = \\frac{1}{\\sqrt{3}}\\bar{X}|\\bar{0}\\rangle + \\sqrt{\\frac{2}{3}}\\bar{X}|\\bar{1}\\rangle = \\frac{1}{\\sqrt{3}}|\\bar{1}\\rangle + \\sqrt{\\frac{2}{3}}|\\bar{0}\\rangle$$\n\nNow we calculate the fidelity $F = |\\langle \\psi_{in} | \\psi_{final} \\rangle|^2$:\n$$\\langle \\psi_{in} | \\psi_{final} \\rangle = \\left( \\frac{1}{\\sqrt{3}}\\langle\\bar{0}| + \\sqrt{\\frac{2}{3}}\\langle\\bar{1}| \\right) \\left( \\sqrt{\\frac{2}{3}}|\\bar{0}\\rangle + \\frac{1}{\\sqrt{3}}|\\bar{1}\\rangle \\right)$$\nUsing the orthogonality of the logical basis states, $\\langle\\bar{i}|\\bar{j}\\rangle = \\delta_{ij}$:\n$$\\langle \\psi_{in} | \\psi_{final} \\rangle = \\frac{1}{\\sqrt{3}}\\sqrt{\\frac{2}{3}}\\langle\\bar{0}|\\bar{0}\\rangle + \\frac{1}{\\sqrt{3}}\\frac{1}{\\sqrt{3}}\\langle\\bar{0}|\\bar{1}\\rangle + \\sqrt{\\frac{2}{3}}\\sqrt{\\frac{2}{3}}\\langle\\bar{1}|\\bar{0}\\rangle + \\sqrt{\\frac{2}{3}}\\frac{1}{\\sqrt{3}}\\langle\\bar{1}|\\bar{1}\\rangle$$\n$$\\langle \\psi_{in} | \\psi_{final} \\rangle = \\frac{\\sqrt{2}}{3} \\cdot 1 + \\frac{1}{3} \\cdot 0 + \\frac{2}{3} \\cdot 0 + \\frac{\\sqrt{2}}{3} \\cdot 1 = \\frac{\\sqrt{2}}{3} + \\frac{\\sqrt{2}}{3} = \\frac{2\\sqrt{2}}{3}$$\nThe fidelity is the squared modulus of this value:\n$$F = \\left|\\frac{2\\sqrt{2}}{3}\\right|^2 = \\frac{4 \\cdot 2}{9} = \\frac{8}{9}$$", "answer": "$$ \\boxed{\\frac{8}{9}} $$", "id": "172113"}]}