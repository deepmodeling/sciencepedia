{"hands_on_practices": [{"introduction": "A key challenge in quantum computing is the high cost associated with implementing non-Clifford gates fault-tolerantly. One practical strategy to manage these resources is to use probabilistic \"Repeat-Until-Success\" (RUS) protocols, which herald the successful application of a gate with a certain probability. This exercise [@problem_id:105288] provides an opportunity to analyze a concrete RUS circuit for the T-gate, building foundational skills in calculating success probabilities and understanding the mechanics of probabilistic gate synthesis.", "problem": "In the pursuit of universal quantum computation, non-Clifford gates are essential resources. The T-gate, given by the matrix $T = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix}$, is a canonical example of a non-Clifford gate. One method to implement such gates is through \"Repeat-Until-Success\" (RUS) protocols. These protocols use a quantum circuit involving a target qubit and an ancilla qubit. The circuit concludes with a measurement on the ancilla. A specific measurement outcome heralds the successful application of the desired gate on the target qubit.\n\nConsider a proposed RUS circuit for generating a T-gate. The circuit acts on a two-qubit system, composed of a target qubit ($q_t$) and an ancilla qubit ($q_a$). The target qubit is initially in an arbitrary state $|\\psi\\rangle_t = \\alpha|0\\rangle_t + \\beta|1\\rangle_t$, and the ancilla is initialized to $|0\\rangle_a$.\n\nThe circuit consists of the following sequence of gates:\n1.  A Hadamard gate ($H$) is applied to the ancilla $q_a$.\n2.  A Controlled-S ($CS$) gate is applied, with the ancilla $q_a$ as the control qubit and the target $q_t$ as the target qubit. The S-gate is defined as $S = \\begin{pmatrix} 1 & 0 \\\\ 0 & i \\end{pmatrix}$.\n3.  A Controlled-NOT ($CNOT$) gate is applied, with the target $q_t$ as the control and the ancilla $q_a$ as the target.\n4.  A final Hadamard gate ($H$) is applied to the ancilla $q_a$.\n\nFollowing this sequence, the ancilla qubit $q_a$ is measured in the computational basis $\\{|0\\rangle, |1\\rangle\\}$. The protocol is declared a \"success\" if the measurement outcome for the ancilla is 0.\n\nYour task is to calculate the success probability of this protocol for a specific input state on the target qubit. Determine the success probability, $P(\\text{success})$, given that the initial state of the target qubit is $|\\psi\\rangle_t = |+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$.", "solution": "We label the ancilla qubit by $a$ and the target qubit by $t$. The target is initialized in \n$$|\\psi\\rangle_t = |+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle_t + |1\\rangle_t),$$ \nand the ancilla in $|0\\rangle_a$. We track the joint state step by step:\n\n1. Initial state\n$$|\\Psi_0\\rangle = |0\\rangle_a \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle_t+|1\\rangle_t).$$\n\n2. After $H$ on ancilla ($H|0\\rangle_a=(|0\\rangle_a+|1\\rangle_a)/\\sqrt{2}$),\n$$|\\Psi_1\\rangle\n=\\frac{1}{\\sqrt{2}}\\left(|0\\rangle_a+|1\\rangle_a\\right)\\otimes\\frac{1}{\\sqrt{2}}(|0\\rangle_t+|1\\rangle_t)\n=\\frac{1}{2}\\sum_{a,t\\in\\{0,1\\}}|a\\rangle_a|t\\rangle_t.$$\n\n3. After $CS$ (control $a$, apply $S$ to $t$ when $a=1$, with $S|1\\rangle=i|1\\rangle$),\n$$|\\Psi_2\\rangle\n=\\frac{1}{2}\\left(|00\\rangle + |01\\rangle + |10\\rangle + i\\,|11\\rangle\\right).$$\n\n4. After CNOT (control $t$, target $a$, so $|a\\rangle_a|1\\rangle_t \\mapsto |a\\oplus1\\rangle_a|1\\rangle_t$),\n\n$$\n|\\Psi_3\\rangle\n=\\frac{1}{2}\\left(|00\\rangle + |11\\rangle + |10\\rangle + i\\,|01\\rangle\\right).\n$$\n\nWe regroup by ancilla value:\n\n$$\n|\\Psi_3\\rangle\n=\\sum_{a=0}^1|a\\rangle_a\\,|\\phi_a\\rangle_t,\n\\quad\n|\\phi_0\\rangle_t=\\frac{1}{2}\\left(|0\\rangle+i|1\\rangle\\right),\\;\n|\\phi_1\\rangle_t=\\frac{1}{2}\\left(|0\\rangle+|1\\rangle\\right).\n$$\n\n\n5. After final $H$ on the ancilla,\n\n$$\n|\\Psi_4\\rangle\n=\\sum_{a=0}^1\\frac{|0\\rangle_a+(-1)^a|1\\rangle_a}{\\sqrt{2}}\\,|\\phi_a\\rangle_t.\n$$\n\nMeasuring the ancilla in $\\{|0\\rangle,|1\\rangle\\}$, the “success’’ outcome is $0$. The unnormalized post-measurement target state is\n\n$$\n\\frac{1}{\\sqrt{2}}\\left(|\\phi_0\\rangle+|\\phi_1\\rangle\\right),\n$$\n\nso the success probability is\n\n$$\nP(\\mathrm{success})\n=\\frac{1}{2}\\langle\\phi_0+\\phi_1\\mid\\phi_0+\\phi_1\\rangle\n=\\frac{1}{2}\\left(\\langle\\phi_0|\\phi_0\\rangle+\\langle\\phi_1|\\phi_1\\rangle\n+2\\Re\\langle\\phi_0|\\phi_1\\rangle\\right).\n$$\n\nWe compute\n\n$$\n\\langle\\phi_0|\\phi_0\\rangle=\\frac{1}{2},\\quad\n\\langle\\phi_1|\\phi_1\\rangle=\\frac{1}{2},\\quad\n\\langle\\phi_0|\\phi_1\\rangle=\\frac{1-i}{4}\\;\\Longrightarrow\\;\\Re\\langle\\phi_0|\\phi_1\\rangle=\\frac{1}{4}.\n$$\n\nHence\n\n$$\nP(\\mathrm{success})\n=\\frac{1}{2}\\left(\\frac{1}{2}+\\frac{1}{2}+2\\times\\frac{1}{4}\\right)\n=\\frac{3}{4}.\n$$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "105288"}, {"introduction": "Complex gates essential for quantum algorithms, such as the Toffoli gate, are often synthesized from a sequence of elementary Clifford and T-gates involving ancilla qubits. Understanding how a single physical error propagates through such a construction is fundamental to the study of fault tolerance. In this practice problem [@problem_id:105338], you will quantify the impact of a single Pauli error on an ancilla qubit during an ancilla-assisted Toffoli gate implementation by calculating the resulting state fidelity, providing a concrete measure of the fragility of uncorrected computations.", "problem": "An ancilla-assisted Toffoli gate is a common construction in fault-tolerant quantum computing. Consider a specific four-qubit operation $U_{op}$ acting on two control qubits ($c_1, c_2$), one target qubit ($t$), and one ancilla qubit ($a$). This operation, $U_{op}$, is built from a sequence of more elementary gates.\n\nLet the elementary gates be defined as follows:\n- The Hadamard gate: $H = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$.\n- The T-gate: $T = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix}$. Its adjoint is $T^\\dagger = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{-i\\pi/4} \\end{pmatrix}$.\n- The Controlled-NOT (CNOT) gate, $CNOT(c, t)$, which flips the target qubit $t$ if the control qubit $c$ is in the state $|1\\rangle$.\n- The Pauli-X gate: $X = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$.\n\nThe operation $U_{op}$ is composed of two stages. First, a unitary $U_{AND}'$ acts on qubits $c_1, c_2, a$. Then, a final sequence of gates completes the operation. The gate $U_{AND}'$ is defined by the following circuit, where gate labels indicate the qubit they act on:\n$$\nU_{AND}' = T_a^\\dagger \\circ CNOT(c_2, a) \\circ T_a \\circ CNOT(c_1, a) \\circ T_a^\\dagger \\circ CNOT(c_2, a) \\circ T_a \\circ H_a\n$$\nNote that the circuit is read from right to left, so $H_a$ is the first gate applied.\n\nThe full ideal operation $U_{ideal}$ is given by:\n$$\nU_{ideal} = CNOT(a, t) \\circ H_a \\circ U_{AND}'\n$$\n\nConsider an initial state of the four-qubit system given by:\n$$\n|\\psi_{in}\\rangle = \\frac{1}{2} \\left( |00\\rangle + |01\\rangle + |10\\rangle + |11\\rangle \\right)_{c_1 c_2} \\otimes |0\\rangle_t \\otimes |0\\rangle_a\n$$\n\nNow, suppose a single bit-flip error, represented by a Pauli-X gate, occurs on the ancilla qubit $a$ at a specific point in the circuit. The faulty operation, $U_{faulty}$, is described by the same sequence of gates as $U_{ideal}$, but with an $X_a$ gate inserted immediately after the $U_{AND}'$ block and before the final $H_a$ gate.\n$$\nU_{faulty} = CNOT(a, t) \\circ H_a \\circ X_a \\circ U_{AND}'\n$$\nThe state fidelity between the ideal final state $|\\psi_{ideal}\\rangle = U_{ideal}|\\psi_{in}\\rangle$ and the faulty final state $|\\psi_{faulty}\\rangle = U_{faulty}|\\psi_{in}\\rangle$ is given by $F = |\\langle\\psi_{ideal}|\\psi_{faulty}\\rangle|^2$.\n\nCalculate the fidelity $F$.", "solution": "1. After $U_{AND}'$ on $|x,y,0\\rangle_{c_1c_2a}$ one finds the ancilla state\n   $$|\\phi_{x,y}\\rangle_a=\\begin{cases}\n     |+\\rangle & (x,y)\\neq(1,1),\\\\\n     i\\,|-\\rangle & (x,y)=(1,1),\n   \\end{cases}$$\n   where $|+\\rangle=(|0\\rangle+|1\\rangle)/\\sqrt{2}$, $|-\\rangle=(|0\\rangle-|1\\rangle)/\\sqrt{2}$.\n2. In the ideal circuit $H_a$ acts next: \n   $$\\alpha_{x,y}:=H_a|\\phi_{x,y}\\rangle_a\n     =\\begin{cases}\n       |0\\rangle_a&(x,y)\\neq(1,1),\\\\\n       i\\,|1\\rangle_a&(x,y)=(1,1).\n     \\end{cases}$$\n   In the faulty circuit $X_a$ precedes $H_a$, giving\n   $$\\beta_{x,y}:=H_aX_a|\\phi_{x,y}\\rangle_a\n     =\\begin{cases}\n       |0\\rangle_a&(x,y)\\neq(1,1),\\\\\n       -i\\,|1\\rangle_a&(x,y)=(1,1).\n     \\end{cases}$$\n3. After the final $CNOT(a,t)$ each branch $(x,y)$ yields\n   $$|\\psi^{\\rm id}_{x,y}\\rangle_{ta}\n     =\\alpha_{x,y}^0|0,0\\rangle_{t,a}+\\alpha_{x,y}^1|1,1\\rangle_{t,a},$$\n   $$|\\psi^{\\rm f}_{x,y}\\rangle_{ta}\n     =\\beta_{x,y}^0|0,0\\rangle_{t,a}+\\beta_{x,y}^1|1,1\\rangle_{t,a}.$$\n   Hence for $(x,y)\\neq(1,1)$ both are $|0,0\\rangle$ so their overlap is $1$, while for $(1,1)$\n   $$\\langle\\psi^{\\rm id}_{1,1}|\\psi^{\\rm f}_{1,1}\\rangle\n     =(i)^*(-i)\\langle1,1|1,1\\rangle=-1.$$\n4. The total inner product is\n   $$\\langle\\psi_{\\rm ideal}|\\psi_{\\rm faulty}\\rangle\n     =\\frac{1}{4}\\Big(3\\cdot1+(-1)\\Big)=\\frac{1}{2},$$\n   so the fidelity\n   $$F=\\left|\\langle\\psi_{\\rm ideal}|\\psi_{\\rm faulty}\\rangle\\right|^2\n         =\\frac{1}{4}. $$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "105338"}, {"introduction": "The ultimate goal of fault-tolerant quantum computation is to perform reliable logical operations despite underlying physical noise. For non-Clifford gates, this is typically achieved by injecting high-fidelity \"magic states\" into an error-corrected circuit, with these states being prepared by resource-intensive distillation factories. This capstone exercise [@problem_id:105327] integrates these concepts, challenging you to perform a full-stack resource estimation that connects hardware parameters like the physical error rate $p$ and code distance $d$ to the total number of initial magic states needed for a single fault-tolerant CCZ gate.", "problem": "In fault-tolerant quantum computation using surface codes, non-Clifford gates like the CCZ (controlled-controlled-Z) gate are particularly expensive. Their implementation relies on the injection of \"magic states,\" such as the T-state $|T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$, which must be prepared with extremely high fidelity. This fidelity is achieved through a process called magic state distillation.\n\nConsider a quantum computer architecture based on distance-$d$ surface code logical qubits. The physical error rate for any single-qubit gate or state preparation is denoted by $p$. A fault-tolerant CCZ gate is constructed using a circuit requiring $N_T$ logical T-gates and a number of logical Clifford gates. The intrinsic logical error probability of the physical circuit that implements a single T-gate (excluding the error from the magic state itself) is given by $P_{logic} = A p^{(d+1)/2}$, where $A$ is a constant related to the specifics of the error correction protocol.\n\nTo produce the high-fidelity T-states required, a multi-level distillation factory is used. The factory starts with initial T-states prepared with a physical error probability of $p$. It then applies successive levels of a 15-to-1 distillation protocol based on the Reed-Muller code. At each level, this protocol consumes 15 input states to produce 1 output state whose error probability $P_{out}$ is related to the input error probability $P_{in}$ by the formula $P_{out} = C P_{in}^3$, where $C$ is a constant factor.\n\nFor the overall computation to be reliable, the error probability of the final distilled magic state, $P_{magic}$, must be no larger than the intrinsic logical error of the T-gate ancellary circuitry, $P_{logic}$. Therefore, the number of distillation levels, $k$, must be chosen as the *minimum integer* that satisfies the condition $P_{magic}^{(k)} \\le P_{logic}$.\n\nDerive a closed-form expression for the total number of initial physical T-states, $\\mathcal{T}_{total}$, required to implement a single CCZ gate. Your answer should be in terms of the parameters $N_T, d, p, A$, and $C$. Use the natural logarithm, $\\ln$, in your derivation.", "solution": "1. Logical T-gate error:  \n$$P_{logic}=A\\,p^{\\frac{d+1}{2}}$$  \n2. Distillation recursion: if $P^{(0)}=p$ and  \n$$P^{(i)}=C\\,\\left(P^{(i-1)}\\right)^3$$  \nthen by induction  \n$$P^{(k)}=C^{\\sum_{j=0}^{k-1}3^j}\\,p^{3^k}\n=C^{\\frac{3^k-1}{2}}\\,p^{3^k}$$  \n3. Require $P^{(k)}\\le P_{logic}$, i.e.  \n$$C^{\\frac{3^k-1}{2}}\\,p^{3^k}\\le A\\,p^{\\frac{d+1}{2}}$$  \n4. Take natural log:  \n$$\\frac{3^k-1}{2}\\ln C+3^k\\ln p\\le\\ln A+\\frac{d+1}{2}\\ln p$$  \nRearrange:  \n$$3^k\\left(\\ln p+\\frac{1}{2}\\ln C\\right)\\le \\ln A+\\frac{d+1}{2}\\ln p+\\frac{1}{2}\\ln C$$  \n5. Let $D=\\ln p+\\frac{1}{2}\\ln C$ and $N=\\ln A+\\frac{d+1}{2}\\ln p+\\frac{1}{2}\\ln C$. Since $p$ is small, $D$ is negative, so dividing by it reverses the inequality:  \n$$3^k \\ge \\frac{N}{D} \\quad\\Longrightarrow\\quad\nk \\ge \\log_3\\left(\\frac{N}{D}\\right)$$  \nThus the minimum integer is\n$$k=\\left\\lceil\\log_3\\frac{2\\ln A+(d+1)\\ln p+\\ln C}{2\\ln p+\\ln C}\\right\\rceil$$  \n6. Each distilled T-state requires $15^k$ raw states, and a CCZ gate uses $N_T$ of them. Hence  \n$$\\mathcal{T}_{total}=N_T\\,15^k$$", "answer": "$$\\boxed{N_T\\,15^{\\left\\lceil\\log_3\\left(\\frac{2\\ln A+(d+1)\\ln p+\\ln C}{2\\ln p+\\ln C}\\right)\\right\\rceil}}$$", "id": "105327"}]}