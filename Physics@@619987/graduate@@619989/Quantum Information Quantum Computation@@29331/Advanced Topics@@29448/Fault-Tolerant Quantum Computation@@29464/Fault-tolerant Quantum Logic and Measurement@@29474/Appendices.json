{"hands_on_practices": [{"introduction": "A cornerstone of fault-tolerant design is not only protecting data qubits but also ensuring the integrity of the error correction process itself. This exercise provides a detailed, hands-on analysis of how a single fault within a syndrome extraction circuit can cascade into a logical error. By tracing the propagation of a fault in a CNOT gate through the measurement of a Shor code stabilizer, you will see how corrupted syndrome information leads to an incorrect \"correction\" and ultimately flips the logical state, providing crucial insight into the failure modes of realistic quantum circuits [@problem_id:84591].", "problem": "In the standard implementation of the Shor $[[9,1,3]]$ code, bit-flip errors are corrected by measuring the error syndrome for each of the three 3-qubit blocks. For a single block, the stabilizers are $S_1 = Z_1 Z_2$ and $S_2 = Z_2 Z_3$. A standard circuit to measure $S_1$ uses an ancilla qubit, initialized to $|0\\rangle$, in the following sequence of gates: Hadamard on ancilla, CNOT with data qubit 1 as control and ancilla as target, CNOT with data qubit 2 as control and ancilla as target, and finally a Hadamard on the ancilla before it is measured.\n\nConsider a faulty CNOT gate between the first data qubit (control) and the ancilla qubit (target) during the measurement of the $S_1$ stabilizer for the first block of qubits (qubits 1, 2, 3). The fault is modeled as an additional Pauli-$Y$ operator applied to the ancilla qubit immediately after the CNOT gate's action. The initial state of the 9-qubit register is an error-free logical zero state, $|\\bar{0}\\rangle_L$.\n\nAssume the rest of the syndrome extraction circuit for both $S_1$ and $S_2$ in the first block, and all operations on other blocks, are perfect. The standard correction procedure is applied based on the measured syndrome $(s_1, s_2)$ for the first block. After this, a full round of phase-flip correction is performed, which we can assume to be perfect and to not detect the resulting error.\n\nThe described fault and the subsequent miscorrection result in a final state $|\\psi_f\\rangle$ that is different from the initial state $|\\bar{0}\\rangle_L$. Calculate the fidelity $F = |\\langle\\bar{0}_L|\\psi_f\\rangle|^2$.", "solution": "The problem asks for the fidelity between the initial state $|\\bar{0}\\rangle_L$ and the final state $|\\psi_f\\rangle$ after a specific fault and subsequent correction procedures.\n\n**1. Initial State and Shor Code Structure**\nThe logical zero state of the Shor code is given by the concatenation of a 3-qubit phase-flip code and a 3-qubit bit-flip code.\nThe outer code (phase-flip) encodes $|\\bar{0}\\rangle_L \\rightarrow |+\\rangle_p |+\\rangle_p |+\\rangle_p$, where $|+\\rangle_p = \\frac{1}{\\sqrt{2}}(|0\\rangle_L + |1\\rangle_L)$.\nThe inner code (bit-flip) encodes $|0\\rangle_L \\rightarrow |000\\rangle$ and $|1\\rangle_L \\rightarrow |111\\rangle$. More relevant for the phase-basis states of the outer code, it encodes $|+\\rangle \\rightarrow \\frac{1}{\\sqrt{2}}(|000\\rangle+|111\\rangle) \\equiv |+\\rangle_B$ and $|-\\rangle \\rightarrow \\frac{1}{\\sqrt{2}}(|000\\rangle-|111\\rangle) \\equiv |-\\rangle_B$.\nSo, the initial 9-qubit state is:\n$$\n|\\bar{0}\\rangle_L = |+\\rangle_{B1} |+\\rangle_{B2} |+\\rangle_{B3} = \\frac{1}{\\sqrt{8}}(|000\\rangle+|111\\rangle)_1(|000\\rangle+|111\\rangle)_2(|000\\rangle+|111\\rangle)_3\n$$\nwhere the subscript on the kets indicates the qubit block. The fault occurs in block 1.\n\n**2. Analysis of the Faulty Syndrome Measurement**\nLet the initial state be $|\\psi\\rangle = |\\bar{0}\\rangle_L$. The measurement of $S_1 = Z_1Z_2$ begins with the ancilla in state $|0\\rangle_a$.\nThe sequence of operations on the data (qubits 1, 2) and ancilla ($a$) for measuring $S_1$ is:\n1.  Prepare ancilla: state is $|\\psi\\rangle|0\\rangle_a$.\n2.  Hadamard on ancilla: The state becomes $|\\psi\\rangle \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle_a + |1\\rangle_a) = |\\psi\\rangle|+\\rangle_a$.\n3.  Faulty CNOT(1, a): The gate is $U_{faulty} = (I_d \\otimes Y_a) \\cdot \\text{CNOT}(1, a)$. Let's analyze its action.\n    A CNOT(c, t) gate acting on $|c\\rangle_c |t\\rangle_t$ gives $|c\\rangle_c |t \\oplus c\\rangle_t$.\n    So, CNOT(1, a) acting on $|c\\rangle_1 |+\\rangle_a = |c\\rangle_1 \\frac{1}{\\sqrt{2}}(|0\\rangle_a+|1\\rangle_a)$ gives $|c\\rangle_1 \\frac{1}{\\sqrt{2}}(|c\\rangle_a+|1\\oplus c\\rangle_a)$.\n    Applying the fault $Y_a$ to this gives $|c\\rangle_1 \\frac{1}{\\sqrt{2}}Y_a(|c\\rangle_a+|1\\oplus c\\rangle_a)$.\n    If $c=0$: $|0\\rangle_1 \\frac{1}{\\sqrt{2}}Y_a(|0\\rangle_a+|1\\rangle_a) = |0\\rangle_1 \\frac{i}{\\sqrt{2}}(|0\\rangle_a-|1\\rangle_a) = i|0\\rangle_1 |-\\rangle_a$.\n    If $c=1$: $|1\\rangle_1 \\frac{1}{\\sqrt{2}}Y_a(|1\\rangle_a+|0\\rangle_a) = |1\\rangle_1 \\frac{i}{\\sqrt{2}}(-|1\\rangle_a-|0\\rangle_a) = -i|1\\rangle_1 |-\\rangle_a$.\n    We can express this action on a general state of qubit 1 as applying the operator $iZ_1$ to qubit 1 and putting the ancilla in state $|-\\rangle_a$.\n    So, the state of the system becomes $i(Z_1 \\otimes I_{2..9})|\\psi\\rangle \\otimes |-\\rangle_a$.\n4.  Standard CNOT(2, a): This CNOT acts on the state from step 3. The control is qubit 2, target is ancilla $a$ in state $|-\\rangle_a$.\n    CNOT(2, a) acting on $|c\\rangle_2 |-\\rangle_a = |c\\rangle_2 \\frac{1}{\\sqrt{2}}(|0\\rangle_a-|1\\rangle_a)$ gives $|c\\rangle_2 \\frac{1}{\\sqrt{2}}(|c\\rangle_a-|1\\oplus c\\rangle_a)$.\n    If $c=0$: $|0\\rangle_2 \\frac{1}{\\sqrt{2}}(|0\\rangle_a-|1\\rangle_a) = |0\\rangle_2|-\\rangle_a$.\n    If $c=1$: $|1\\rangle_2 \\frac{1}{\\sqrt{2}}(|1\\rangle_a-|0\\rangle_a) = -|1\\rangle_2|-\\rangle_a$.\n    This is equivalent to applying $-Z_2$ on data qubit 2. So the total transformation on the data is $-Z_2$.\n    The state of the system becomes $(-Z_2) \\cdot i(Z_1|\\psi\\rangle) \\otimes |-\\rangle_a = -i Z_1 Z_2 |\\psi\\rangle \\otimes |-\\rangle_a$.\n5.  Hadamard on ancilla: $H_a |-\\rangle_a = |1\\rangle_a$. The final state before measurement is $-i Z_1 Z_2 |\\psi\\rangle |1\\rangle_a$.\n6.  Measurement: The ancilla is measured in the computational basis. The outcome is $s_1=1$ with certainty. The data state collapses to $Z_1 Z_2 |\\psi\\rangle = Z_1 Z_2 |\\bar{0}\\rangle_L$.\n\nSince $|\\bar{0}\\rangle_L$ is a valid codeword, it is an eigenstate of all stabilizers with eigenvalue +1. $S_1=Z_1Z_2$ is a stabilizer for the bit-flip code in block 1. Thus, $Z_1Z_2|\\bar{0}\\rangle_L = |\\bar{0}\\rangle_L$. The state of the data is actually unchanged by the fault propagation, but the syndrome bit is incorrectly measured as $s_1=1$.\n\nThe measurement for $S_2=Z_2Z_3$ is perfect. Since the data state is still $|\\bar{0}\\rangle_L$, the outcome is $s_2=0$.\nThe measured syndrome for block 1 is $(s_1,s_2)=(1,0)$.\n\n**3. Bit-Flip Correction**\nThe syndrome $(1,0)$ for the stabilizers $(Z_1Z_2, Z_2Z_3)$ indicates a single bit-flip error on the first qubit, $X_1$.\nThe correction procedure applies an $X_1$ operation to the first qubit.\nThe state of the system after bit-flip correction is $|\\psi'\\rangle = X_1 |\\bar{0}\\rangle_L$.\n\n**4. Phase-Flip Correction**\nThe problem states that the subsequent phase-flip correction does not detect the error. Let's verify this. The phase-flip stabilizers are of the form $S_p = (\\prod_{j\\in B_k}X_j)(\\prod_{j\\in B_l}X_j)$. The error is $X_1$. As $X_1$ commutes with all phase-flip stabilizers (since they contain an even number of $X$ operators acting on block 1, or none), the error $X_1$ is indeed not detected. So, no phase-flip correction is applied.\nThe final state is $|\\psi_f\\rangle = X_1 |\\bar{0}\\rangle_L$.\n\n**5. Fidelity Calculation**\nWe need to calculate $F = |\\langle\\bar{0}_L|\\psi_f\\rangle|^2 = |\\langle\\bar{0}_L|X_1|\\bar{0}_L\\rangle|^2$.\nLet's analyze the action of $X_1$ on $|\\bar{0}\\rangle_L$.\n$|\\bar{0}\\rangle_L = |+\\rangle_{B1} \\otimes |+\\rangle_{B2} \\otimes |+\\rangle_{B3}$.\n$|+\\rangle_{B1} = \\frac{1}{\\sqrt{2}}(|000\\rangle_1+|111\\rangle_1)$.\n$X_1$ acts on the first qubit of the first block.\n$$\nX_1 |+\\rangle_{B1} = X_1 \\frac{1}{\\sqrt{2}}(|000\\rangle_1+|111\\rangle_1) = \\frac{1}{\\sqrt{2}}(|100\\rangle_1+|011\\rangle_1) \\equiv |\\chi\\rangle_1\n$$\nSo, the final state is $|\\psi_f\\rangle = |\\chi\\rangle_1 |+\\rangle_{B2} |+\\rangle_{B3}$.\nThe overlap with the initial state is:\n$$\n\\langle\\bar{0}_L|\\psi_f\\rangle = (\\langle+|_{B1}|\\chi\\rangle_1) \\cdot (\\langle+|_{B2}|+\\rangle_{B2}) \\cdot (\\langle+|_{B3}|+\\rangle_{B3})\n$$\nThe overlaps for blocks 2 and 3 are 1. We compute the overlap for block 1:\n$$\n\\langle+|_{B1}|\\chi\\rangle_1 = \\left( \\frac{1}{\\sqrt{2}}(\\langle 000|_1+\\langle 111|_1) \\right) \\left( \\frac{1}{\\sqrt{2}}(|100\\rangle_1+|011\\rangle_1) \\right)\n$$\n$$\n= \\frac{1}{2}(\\langle 000|100\\rangle + \\langle 000|011\\rangle + \\langle 111|100\\rangle + \\langle 111|011\\rangle)\n$$\nAll the inner products are between orthogonal computational basis states.\n$$\n= \\frac{1}{2}(0 + 0 + 0 + 0) = 0\n$$\nTherefore, the fidelity is $F = |0|^2 = 0$.", "answer": "$$\\boxed{0}$$", "id": "84591"}, {"introduction": "Beyond simply preserving quantum states, fault-tolerant protocols are essential for preparing the high-fidelity resource states required for universal quantum computation. This practice explores the 15-to-1 magic state distillation protocol, a key routine for generating the states needed for the non-Clifford $T$ gate. This hypothetical scenario, where a correlated error corrupts the input, allows you to calculate its effect on the output state's fidelity and understand a fundamental principle of distillation: the protocol is designed to transform complex input errors into well-defined Pauli errors on the purified logical qubit [@problem_id:84659].", "problem": "The 15-to-1 magic state distillation protocol is a cornerstone of fault-tolerant quantum computation. It is designed to take 15 noisy copies of the magic state $|A\\rangle$ and produce a single, higher-fidelity copy of $|A\\rangle$. The magic state is given by $|A\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$, which is essential for implementing the non-Clifford $T$ gate.\n\nThe protocol leverages a $[[15,1,3]]$ quantum error-correcting code. A key functional characteristic of this protocol is its interaction with input errors:\n1.  Errors affecting only a single input qubit are perfectly corrected, meaning the output is the ideal state $|A\\rangle$.\n2.  Errors affecting two input qubits, such as a Pauli error $P_i P_j$ on qubits $i$ and $j$, are not corrected. Instead, the protocol is designed such that these errors are converted into a specific, non-trivial logical Pauli error on the single output qubit.\n\nConsider a scenario where the 15 input states are prepared such that with probability $1-\\epsilon$, the system is in the ideal state $|A\\rangle^{\\otimes 15}$, and with probability $\\epsilon$, it is in the corrupted state $X_1 X_2 |A\\rangle^{\\otimes 15}$. Here, $X_1 X_2$ represents a correlated Pauli $X$ error on the first two input qubits.\n\nAssume that for this protocol, an input error of the form $X_1X_2$ is transformed into a Pauli $Y$ error on the output qubit. Furthermore, you may assume that to leading order in $\\epsilon$, the probability of the protocol succeeding and producing an output qubit is independent of whether this specific error was present on the input.\n\nCalculate the fidelity $F = \\langle A|\\rho_{\\text{out}}|A\\rangle$ of the output state $\\rho_{\\text{out}}$ with the ideal magic state $|A\\rangle$. Express your answer to leading order in $\\epsilon$.", "solution": "The output state $\\rho_{\\text{out}}$ is a mixture of two cases, conditioned on the protocol succeeding:\n- With probability $1 - \\epsilon$, the input is ideal, and the output is $|A\\rangle$.\n- With probability $\\epsilon$, the input has the error $X_1 X_2$, which the protocol converts to a $Y$ error on the output, resulting in $Y |A\\rangle$.\n\nThus, the output density matrix is:\n$$\n\\rho_{\\text{out}} = (1 - \\epsilon) |A\\rangle\\langle A| + \\epsilon  (Y |A\\rangle\\langle A| Y^\\dagger)\n$$\nSince $Y$ is Hermitian ($Y^\\dagger = Y$), this simplifies to:\n$$\n\\rho_{\\text{out}} = (1 - \\epsilon) |A\\rangle\\langle A| + \\epsilon  (Y |A\\rangle\\langle A| Y)\n$$\n\nThe fidelity is defined as $F = \\langle A| \\rho_{\\text{out}} |A\\rangle$. Substituting $\\rho_{\\text{out}}$:\n$$\nF = \\langle A| \\left[ (1 - \\epsilon) |A\\rangle\\langle A| + \\epsilon  Y |A\\rangle\\langle A| Y \\right] |A\\rangle\n$$\nExpanding:\n$$\nF = (1 - \\epsilon) \\langle A|A\\rangle\\langle A|A\\rangle + \\epsilon  \\langle A| Y |A\\rangle \\langle A| Y |A\\rangle\n$$\nSince $|A\\rangle$ is normalized, $\\langle A|A\\rangle = 1$. Thus:\n$$\nF = (1 - \\epsilon) + \\epsilon  \\left( \\langle A| Y |A\\rangle \\right)^2\n$$\n\nNow we compute $\\langle A| Y |A\\rangle$. The magic state is:\n$$\n|A\\rangle = \\frac{1}{\\sqrt{2}} \\left( |0\\rangle + e^{i\\pi/4} |1\\rangle \\right)\n$$\nApplying $Y$:\n$$\nY |A\\rangle = \\frac{1}{\\sqrt{2}} \\left( Y|0\\rangle + e^{i\\pi/4} Y|1\\rangle \\right) = \\frac{1}{\\sqrt{2}} \\left( i |1\\rangle - i e^{i\\pi/4} |0\\rangle \\right) = \\frac{i}{\\sqrt{2}} \\left( |1\\rangle - e^{i\\pi/4} |0\\rangle \\right)\n$$\nThe inner product is:\n$$\n\\langle A| Y |A\\rangle = \\left[ \\frac{1}{\\sqrt{2}} \\left( \\langle 0| + e^{-i\\pi/4} \\langle 1| \\right) \\right] \\left[ \\frac{i}{\\sqrt{2}} \\left( |1\\rangle - e^{i\\pi/4} |0\\rangle \\right) \\right]\n$$\nExpanding:\n$$\n\\langle A| Y |A\\rangle = \\frac{i}{2} \\left[ \\langle 0|1\\rangle - e^{i\\pi/4} \\langle 0|0\\rangle + e^{-i\\pi/4} \\langle 1|1\\rangle - e^{-i\\pi/4} e^{i\\pi/4} \\langle 1|0\\rangle \\right]\n$$\nUsing orthonormality ($\\langle i|j\\rangle = \\delta_{ij}$):\n$$\n\\langle A| Y |A\\rangle = \\frac{i}{2} \\left[ 0 - e^{i\\pi/4} \\cdot 1 + e^{-i\\pi/4} \\cdot 1 - 0 \\right] = \\frac{i}{2} \\left( e^{-i\\pi/4} - e^{i\\pi/4} \\right)\n$$\nThe expression $e^{-i\\pi/4} - e^{i\\pi/4} = -2i \\sin(\\pi/4)$, so:\n$$\n\\langle A| Y |A\\rangle = \\frac{i}{2} \\left( -2i \\sin(\\pi/4) \\right) = \\frac{i \\cdot (-2i)}{2} \\sin(\\pi/4) = \\frac{2}{2} \\sin(\\pi/4) = \\sin(\\pi/4)\n$$\nSince $\\sin(\\pi/4) = \\sqrt{2}/2$:\n$$\n\\langle A| Y |A\\rangle = \\frac{\\sqrt{2}}{2}\n$$\n\nSquaring this result:\n$$\n\\left( \\langle A| Y |A\\rangle \\right)^2 = \\left( \\frac{\\sqrt{2}}{2} \\right)^2 = \\frac{2}{4} = \\frac{1}{2}\n$$\n\nSubstituting back into the fidelity:\n$$\nF = (1 - \\epsilon) + \\epsilon \\cdot \\frac{1}{2} = 1 - \\epsilon + \\frac{\\epsilon}{2} = 1 - \\frac{\\epsilon}{2}\n$$\nThis expression is to leading order in $\\epsilon$, as higher-order terms in $\\epsilon$ are negligible.", "answer": "$$ \\boxed{1 - \\frac{\\epsilon}{2}} $$", "id": "84659"}, {"introduction": "The principles of fault tolerance extend beyond discrete-variable systems of qubits. This exercise delves into the Gottesman-Kitaev-Preskill (GKP) code, where a logical qubit is encoded into the continuous phase space of a harmonic oscillator. You will analyze how continuous physical displacements, described by a uniform probability distribution, translate into discrete logical error probabilities after a round of correction. This practice provides a valuable opportunity to apply the core concepts of error detection and correction to a different, yet powerful, encoding paradigm and to derive the logical error rate from the underlying physical noise model [@problem_id:84613].", "problem": "A Gottesman-Kitaev-Preskill (GKP) qubit is encoded in the continuous-variable state space of a harmonic oscillator. The logical basis states, in the position representation, are idealized as infinite superpositions of position eigenstates:\n$$|0\\rangle_L \\propto \\sum_{k=-\\infty}^{\\infty} |q = 2k\\sqrt{\\pi}\\rangle$$\n$$|1\\rangle_L \\propto \\sum_{k=-\\infty}^{\\infty} |q = (2k+1)\\sqrt{\\pi}\\rangle$$\nThis creates a periodic \"comb\" structure in phase space. The dual-basis states are similarly defined in the momentum representation, with momentum eigenstates separated by $\\sqrt{\\pi}$.\n\nThe primary error model for such a qubit is a random displacement in phase space, described by the operator $D(\\delta q, \\delta p) = \\exp[i(\\delta p \\hat{q} - \\delta q \\hat{p})/\\hbar]$ (with $\\hbar = 1$), which shifts the state by $(\\delta q, \\delta p)$. GKP error correction is designed to detect and reverse these small displacements.\n\nConsider a single GKP qubit subjected to a specific physical noise process. Over a characteristic time, the process induces a random displacement $(\\delta q, \\delta p)$, where $\\delta q$ and $\\delta p$ are statistically independent random variables. Each is drawn from a uniform probability distribution over the interval $[-\\Delta, \\Delta]$, where $\\Delta > 0$ is a parameter characterizing the noise strength.\n\nFollowing the noise, one round of ideal Steane-like error correction is performed. This procedure measures the syndromes corresponding to the displacements, effectively determining $\\delta q \\pmod{\\sqrt{\\pi}}$ and $\\delta p \\pmod{\\sqrt{\\pi}}$. Based on these syndromes, the correction protocol applies a displacement that assumes the original error was minimal, i.e., within the central Wigner cell $|q|  \\sqrt{\\pi}/2$ and $|p|  \\sqrt{\\pi}/2$. A logical X-flip occurs if the position correction is wrong, which happens when the initial displacement $|\\delta q| > \\sqrt{\\pi}/2$. Similarly, a logical Z-flip occurs if $|\\delta p| > \\sqrt{\\pi}/2$.\n\nDerive a single, closed-form analytic expression for the total logical error rate, $P_L$, which is the probability of incurring at least one logical flip (X, Z, or both) after one correction cycle. Your expression should be valid for any value of $\\Delta > 0$. You may use the Heaviside step function, defined as $\\Theta(x)=1$ for $x \\ge 0$ and $\\Theta(x)=0$ for $x  0$.", "solution": "The total logical error rate $P_L$ is the probability of at least one logical flip (X, Z, or both) after one correction cycle. A logical X-flip occurs if $|\\delta q| > \\sqrt{\\pi}/2$, and a logical Z-flip occurs if $|\\delta p| > \\sqrt{\\pi}/2$. The displacements $\\delta q$ and $\\delta p$ are independent random variables, each uniformly distributed over $[-\\Delta, \\Delta]$.\n\nDefine the critical displacement:\n$$\na = \\frac{\\sqrt{\\pi}}{2}\n$$\nThe probability of no logical error is the probability that both $|\\delta q| \\leq a$ and $|\\delta p| \\leq a$. Due to independence:\n$$\nP(\\text{no error}) = P(|\\delta q| \\leq a) \\cdot P(|\\delta p| \\leq a)\n$$\nSince $\\delta q$ and $\\delta p$ are identically distributed:\n$$\nP(|\\delta q| \\leq a) = P(|\\delta p| \\leq a)\n$$\nThe uniform probability density function is $f(x) = \\frac{1}{2\\Delta}$ for $x \\in [-\\Delta, \\Delta]$. The probability $P(|\\delta q| \\leq a)$ depends on $\\Delta$ relative to $a$:\n- If $\\Delta \\leq a$, then $|\\delta q| \\leq \\Delta \\leq a$ always holds, so $P(|\\delta q| \\leq a) = 1$.\n- If $\\Delta > a$, then:\n$$\nP(|\\delta q| \\leq a) = \\int_{-a}^{a} \\frac{1}{2\\Delta}  dq = \\frac{1}{2\\Delta} \\cdot 2a = \\frac{a}{\\Delta}\n$$\nUsing the Heaviside step function $\\Theta(x)$ (where $\\Theta(x) = 1$ for $x \\geq 0$ and $\\Theta(x) = 0$ for $x  0$):\n$$\nP(|\\delta q| \\leq a) = \\Theta(a - \\Delta) + \\frac{a}{\\Delta} \\Theta(\\Delta - a)\n$$\nSimilarly for $\\delta p$. Thus:\n$$\nP(\\text{no error}) = \\left[ \\Theta(a - \\Delta) + \\frac{a}{\\Delta} \\Theta(\\Delta - a) \\right]^2\n$$\nThe logical error rate is:\n$$\nP_L = 1 - P(\\text{no error}) = 1 - \\left[ \\Theta(a - \\Delta) + \\frac{a}{\\Delta} \\Theta(\\Delta - a) \\right]^2\n$$\nExpanding the square:\n$$\n\\left[ \\Theta(a - \\Delta) + \\frac{a}{\\Delta} \\Theta(\\Delta - a) \\right]^2 = \\Theta^2(a - \\Delta) + 2 \\Theta(a - \\Delta) \\frac{a}{\\Delta} \\Theta(\\Delta - a) + \\left( \\frac{a}{\\Delta} \\right)^2 \\Theta^2(\\Delta - a)\n$$\nNote that $\\Theta(a - \\Delta)$ and $\\Theta(\\Delta - a)$ are mutually exclusive except at $\\Delta = a$, but $\\Theta(0) = 1$. However:\n- When $\\Delta  a$, $\\Theta(a - \\Delta) = 1$ and $\\Theta(\\Delta - a) = 0$, so $P(\\text{no error}) = 1^2 = 1$.\n- When $\\Delta > a$, $\\Theta(a - \\Delta) = 0$ and $\\Theta(\\Delta - a) = 1$, so $P(\\text{no error}) = \\left( \\frac{a}{\\Delta} \\right)^2$.\n- When $\\Delta = a$, $\\Theta(a - \\Delta) = \\Theta(0) = 1$ and $\\Theta(\\Delta - a) = \\Theta(0) = 1$, but $a/\\Delta = 1$, so:\n$$\n\\Theta(a - \\Delta) + \\frac{a}{\\Delta} \\Theta(\\Delta - a) = 1 + 1 \\cdot 1 = 2 \\quad \\text{(incorrect)}\n$$\nTo resolve, use:\n$$\nP(|\\delta q| \\leq a) = \\Theta(a - \\Delta) + \\frac{a}{\\Delta} [1 - \\Theta(a - \\Delta)]\n$$\nThis gives:\n- For $\\Delta \\leq a$: $\\Theta(a - \\Delta) = 1$, so $P(|\\delta q| \\leq a) = 1 + \\frac{a}{\\Delta}(0) = 1$.\n- For $\\Delta > a$: $\\Theta(a - \\Delta) = 0$, so $P(|\\delta q| \\leq a) = 0 + \\frac{a}{\\Delta}(1) = \\frac{a}{\\Delta}$.\n\nThus:\n$$\nP(\\text{no error}) = \\left( \\Theta(a - \\Delta) + \\frac{a}{\\Delta} [1 - \\Theta(a - \\Delta)] \\right)^2\n$$\nThen:\n$$\nP_L = 1 - \\left( \\Theta(a - \\Delta) + \\frac{a}{\\Delta} [1 - \\Theta(a - \\Delta)] \\right)^2\n$$\nAlternatively, express $P_L$ using the probability of an X-flip or Z-flip. Define:\n$$\nP_X = P(|\\delta q| > a), \\quad P_Z = P(|\\delta p| > a)\n$$\nDue to identical distributions and independence:\n$$\nP_X = P_Z = \\begin{cases} \n0  \\text{if } \\Delta \\leq a \\\\\n1 - \\frac{a}{\\Delta}  \\text{if } \\Delta > a \n\\end{cases} = \\left(1 - \\frac{a}{\\Delta}\\right) \\Theta(\\Delta - a)\n$$\nThe probability of at least one flip is:\n$$\nP_L = P_X + P_Z - P_X P_Z = 2P_X - P_X^2\n$$\nSubstituting:\n$$\nP_L = 2 \\left(1 - \\frac{a}{\\Delta}\\right) \\Theta(\\Delta - a) - \\left[ \\left(1 - \\frac{a}{\\Delta}\\right) \\Theta(\\Delta - a) \\right]^2\n$$\nSimplify:\n$$\nP_L = \\left[ 2 \\left(1 - \\frac{a}{\\Delta}\\right) - \\left(1 - \\frac{a}{\\Delta}\\right)^2 \\right] \\Theta(\\Delta - a) = \\left[ 2 - 2\\frac{a}{\\Delta} - \\left(1 - 2\\frac{a}{\\Delta} + \\frac{a^2}{\\Delta^2} \\right) \\right] \\Theta(\\Delta - a) = \\left(1 - \\frac{a^2}{\\Delta^2}\\right) \\Theta(\\Delta - a)\n$$\nSubstitute $a = \\frac{\\sqrt{\\pi}}{2}$:\n$$\na^2 = \\left( \\frac{\\sqrt{\\pi}}{2} \\right)^2 = \\frac{\\pi}{4}\n$$\nThus:\n$$\nP_L = \\left(1 - \\frac{\\pi}{4 \\Delta^2}\\right) \\Theta\\left(\\Delta - \\frac{\\sqrt{\\pi}}{2}\\right)\n$$\nThis expression is valid for any $\\Delta > 0$.", "answer": "$$\\boxed{ \\left(1 - \\frac{\\pi}{4 \\Delta^{2}}\\right) \\Theta\\left(\\Delta - \\frac{\\sqrt{\\pi}}{2}\\right) }$$", "id": "84613"}]}