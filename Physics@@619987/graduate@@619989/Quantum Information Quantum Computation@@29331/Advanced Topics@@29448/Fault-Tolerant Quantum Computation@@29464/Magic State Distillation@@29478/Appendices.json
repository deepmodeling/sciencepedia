{"hands_on_practices": [{"introduction": "Magic state distillation is a cornerstone of fault-tolerant quantum computing, fundamentally a process of purifying quantum states. This first exercise provides a quantitative look into the core mechanism of one of the most famous distillation protocols, the 15-to-1 routine proposed by Bravyi and Kitaev. By analyzing how the protocol's success is tied to the combinatorial properties of the underlying quantum Reed-Muller code, you will derive the leading-order improvement in state fidelity [@problem_id:105364]. This calculation reveals the characteristic error suppression that makes distillation an indispensable tool for building a quantum computer.", "problem": "In fault-tolerant quantum computation, non-Clifford gates such as the $T$ gate are essential for achieving universality. Since these gates are notoriously difficult to implement with high fidelity, protocols for \"magic state distillation\" are employed. These protocols take multiple noisy copies of a \"magic state\" as input and produce a single copy with much higher fidelity. The purified magic state can then be used to implement the desired non-Clifford gate via a teleportation-based circuit.\n\nA key magic state for the $T$ gate, $$T = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix},$$ is the state $|A\\rangle = T|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$.\nConsider a supply of noisy magic states, where each state is described by the density matrix\n$$ \\rho_{in} = (1-\\epsilon) |A\\rangle\\langle A| + \\epsilon |A^{\\perp}\\rangle\\langle A^{\\perp}| $$\nHere, $|A^{\\perp}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - e^{i\\pi/4}|1\\rangle)$ is the state orthogonal to $|A\\rangle$, and $\\epsilon$ is the initial error probability. The initial fidelity of these states is $F_{in} = \\langle A|\\rho_{in}|A\\rangle = 1-\\epsilon$. It can be shown that this error model is equivalent to a quantum channel that applies a Pauli $Z$ error to the ideal state $|A\\rangle$ with probability $\\epsilon$.\n\nThe 15-to-1 magic state distillation protocol, first proposed by Bravyi and Kitaev, takes 15 copies of $\\rho_{in}$ and attempts to produce one higher-fidelity state $\\rho_{out}$. The protocol is based on the [[15, 1, 3]] quantum Reed-Muller code. It works by encoding the logical state into 15 physical qubits and then measuring the stabilizer generators of the code. If the measurement syndrome is trivial (all outcomes are $+1$), the output state is accepted. Otherwise, it is discarded.\n\nFor your calculation, you will need the following essential properties of the [[15, 1, 3]] code used in this protocol, which is a CSS code derived from the classical $[15, 11, 3]$ Hamming code:\n1.  The code has a distance of $d=3$. This implies that all error patterns affecting one or two qubits are detected by the stabilizer measurements.\n2.  The error model corresponds to Pauli $Z$ errors. An error operator consisting of a product of $Z$s on a set of qubits $S$, denoted $Z_S$, is undetected if it commutes with all stabilizers. For this specific code, this occurs if $S$ is a codeword in the classical [15, 11, 3] Hamming code.\n3.  If an undetected error occurs, it corrupts the output state, causing a logical error. The lowest weight of such error operators is 3. The number of classical codewords of weight 3 in the $[15, 11, 3]$ Hamming code is exactly 35.\n\nAssuming the initial error probability $\\epsilon$ is small, calculate the fidelity $F_{out}$ of the output state $\\rho_{out}$ from the 15-to-1 distillation protocol. Your answer should be an expression in terms of $\\epsilon$, accurate to the lowest non-vanishing order of $\\epsilon$.", "solution": "The fidelity of the output state, $ F_{\\text{out}} $, is the probability that the output state is correct given that it is accepted. The protocol accepts the state when the error pattern corresponds to a codeword in the classical [15, 11, 3] Hamming code. The error model applies a Pauli $ Z $ error to each qubit independently with probability $ \\epsilon $.\n\nThe probability that the error pattern is the zero codeword (no errors) is:\n\n$$\n\\Pr(\\text{no error}) = (1 - \\epsilon)^{15}\n$$\n\n\nThe probability that the error pattern is a specific non-zero codeword of weight $ w $ is:\n\n$$\n\\Pr(\\text{specific codeword of weight } w) = \\epsilon^w (1 - \\epsilon)^{15 - w}\n$$\n\n\nThe total acceptance probability is the sum over all codewords:\n\n$$\nP_{\\text{accept}} = \\sum_{c \\in \\mathcal{C}} \\epsilon^{w(c)} (1 - \\epsilon)^{15 - w(c)}\n$$\n\nwhere $ \\mathcal{C} $ is the set of all 2048 codewords of the Hamming code.\n\nThe output state is correct only for the zero codeword. Thus, the fidelity is:\n\n$$\nF_{\\text{out}} = \\frac{\\Pr(\\text{no error})}{P_{\\text{accept}}} = \\frac{(1 - \\epsilon)^{15}}{\\sum_{c \\in \\mathcal{C}} \\epsilon^{w(c)} (1 - \\epsilon)^{15 - w(c)}}\n$$\n\n\nFor small $ \\epsilon $, expand to lowest non-vanishing order. The numerator is:\n\n$$\n(1 - \\epsilon)^{15} = 1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\nThe denominator includes:\n- The zero codeword: $ (1 - \\epsilon)^{15} $\n- 35 codewords of weight 3: $ 35 \\epsilon^3 (1 - \\epsilon)^{12} $\n- Higher weight codewords, which contribute $ O(\\epsilon^4) $\n\nThus:\n\n$$\nP_{\\text{accept}} = (1 - \\epsilon)^{15} + 35 \\epsilon^3 (1 - \\epsilon)^{12} + O(\\epsilon^4)\n$$\n\n\nExpand $ (1 - \\epsilon)^{12} $:\n\n$$\n(1 - \\epsilon)^{12} = 1 - 12\\epsilon + 66\\epsilon^2 - 220\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\nSo:\n\n$$\n35 \\epsilon^3 (1 - \\epsilon)^{12} = 35 \\epsilon^3 (1 - 12\\epsilon + 66\\epsilon^2 - 220\\epsilon^3) + O(\\epsilon^4) = 35\\epsilon^3 - 420\\epsilon^4 + O(\\epsilon^4)\n$$\n\nSince $ \\epsilon^4 $ terms are absorbed in $ O(\\epsilon^4) $, we keep only $ 35\\epsilon^3 $ for order $ \\epsilon^3 $.\n\nThen:\n\n$$\nP_{\\text{accept}} = [1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3] + 35\\epsilon^3 + O(\\epsilon^4) = 1 - 15\\epsilon + 105\\epsilon^2 - 420\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\nThe fidelity ratio is:\n\n$$\nF_{\\text{out}} = \\frac{1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3 + O(\\epsilon^4)}{1 - 15\\epsilon + 105\\epsilon^2 - 420\\epsilon^3 + O(\\epsilon^4)}\n$$\n\n\nSet $ y = 15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3 + O(\\epsilon^4) $, so the denominator is $ 1 - y $. Then:\n\n$$\n(1 - y)^{-1} = 1 + y + y^2 + y^3 + O(\\epsilon^4)\n$$\n\n\nCompute:\n\n$$\ny = 15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n$$\ny^2 = (15\\epsilon)^2 + 2(15\\epsilon)(-105\\epsilon^2) + O(\\epsilon^4) = 225\\epsilon^2 - 3150\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n$$\ny^3 = (15\\epsilon)^3 + O(\\epsilon^4) = 3375\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\nSo:\n\n$$\n(1 - y)^{-1} = 1 + (15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3) + (225\\epsilon^2 - 3150\\epsilon^3) + 3375\\epsilon^3 + O(\\epsilon^4) = 1 + 15\\epsilon + 120\\epsilon^2 + 645\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\nNow multiply by the numerator:\n\n$$\nF_{\\text{out}} = (1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3)(1 + 15\\epsilon + 120\\epsilon^2 + 645\\epsilon^3) + O(\\epsilon^4)\n$$\n\n\nPerforming the multiplication:\n- $ 1 \\cdot 1 = 1 $\n- $ 1 \\cdot 15\\epsilon = 15\\epsilon $\n- $ 1 \\cdot 120\\epsilon^2 = 120\\epsilon^2 $\n- $ 1 \\cdot 645\\epsilon^3 = 645\\epsilon^3 $\n- $ -15\\epsilon \\cdot 1 = -15\\epsilon $\n- $ -15\\epsilon \\cdot 15\\epsilon = -225\\epsilon^2 $\n- $ -15\\epsilon \\cdot 120\\epsilon^2 = -1800\\epsilon^3 $\n- $ 105\\epsilon^2 \\cdot 1 = 105\\epsilon^2 $\n- $ 105\\epsilon^2 \\cdot 15\\epsilon = 1575\\epsilon^3 $\n- $ -455\\epsilon^3 \\cdot 1 = -455\\epsilon^3 $\n\nSumming coefficients:\n- Constant: 1\n- $ \\epsilon $: $ 15 - 15 = 0 $\n- $ \\epsilon^2 $: $ 120 - 225 + 105 = 0 $\n- $ \\epsilon^3 $: $ 645 - 1800 + 1575 - 455 = -35 $\n\nThus:\n\n$$\nF_{\\text{out}} = 1 - 35\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\nThe lowest non-vanishing order correction is $ -35\\epsilon^3 $, so the fidelity to this order is $ 1 - 35\\epsilon^3 $.", "answer": "$$ \\boxed{1 - 35\\epsilon^{3}} $$", "id": "105364"}, {"introduction": "While the previous exercise analyzed distillation based on an abstract error probability $p$, real-world quantum devices are affected by physical noise processes like damping and dephasing. This practice bridges the gap between abstract models and physical reality by examining the 15-to-1 protocol when the input states suffer from phase-damping noise [@problem_id:98576]. Your task is to first model the effect of the physical noise channel in the appropriate basis and then use this result to determine the final fidelity of the distilled state. This \"theory-to-practice\" calculation is essential for predicting the performance of distillation protocols on actual hardware.", "problem": "In quantum computation, fault-tolerant implementation of non-Clifford gates is a crucial and resource-intensive task. One of the leading methods is magic state distillation. This problem concerns the 15-to-1 T-state distillation protocol.\n\nThe ideal T-state is a magic state given by $|T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$. Suppose we can only prepare noisy T-states. The noise is introduced by an independent phase-damping channel acting on each ideal T-state. The action of a phase-damping channel with strength $\\gamma$ on a single-qubit density matrix $\\rho$ is described by the Kraus operators $K_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\sqrt{1-\\gamma} \\end{pmatrix}$ and $K_1 = \\begin{pmatrix} 0 & 0 \\\\ 0 & \\sqrt{\\gamma} \\end{pmatrix}$, such that the noisy state is $\\rho_{in} = K_0 \\rho K_0^\\dagger + K_1 \\rho K_1^\\dagger$.\n\nThe 15-to-1 distillation protocol takes 15 such noisy states $\\rho_{in}$ and, upon successful completion, outputs one state $\\rho_{out}$ with higher fidelity. The fidelity of a state $\\rho$ with respect to the ideal state $|T\\rangle$ is $F = \\langle T | \\rho | T \\rangle$.\n\nThe noise on the input T-states can be modeled as a bit-flip channel in the T-basis $\\{|T\\rangle, |-T\\rangle\\}$, where $|-T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - e^{i\\pi/4}|1\\rangle)$. That is, $\\rho_{in}$ can be written as $\\rho_{in} = (1-p)\\rho_T + p\\rho_{-T}$, where $\\rho_T=|T\\rangle\\langle T|$, $\\rho_{-T}=|-T\\rangle\\langle -T|$, and $p$ is the input error probability.\n\nThe distillation protocol succeeds if the pattern of errors on the 15 input states is not detected by a set of stabilizer measurements. The output state is correct if the error pattern is not a logical error of the underlying quantum code. For this problem, assume that the probability of the protocol succeeding with the correct logical outcome, $P_I(p)$, is dominated by the no-error term, and the probability of succeeding with an incorrect logical outcome, $P_Z(p)$, is dominated by the weight-3 logical error term, which has a multiplicity of 35. This leads to the relations:\n- $P_I(p) = (1-p)^{15}$\n- $P_Z(p) = 35 p^3 (1-p)^{12}$\n\nThe output error probability is given by $p_{out} = \\frac{P_Z(p)}{P_I(p) + P_Z(p)}$, and the output state is $\\rho_{out} = (1-p_{out})\\rho_T + p_{out}\\rho_{-T}$.\n\nYour task is to calculate the fidelity $F_{out}$ of the output state $\\rho_{out}$ as a function of the phase-damping channel strength $\\gamma$.", "solution": "1. Input error probability in the $T$‚Äêbasis is \n$$p=\\langle -T|\\rho_{in}|-T\\rangle\n=\\sum_{k=0}^1|\\langle -T|K_k|T\\rangle|^2.$$ \nWith $|T\\rangle=\\tfrac1{\\sqrt2}\\bigl[1,e^{i\\pi/4}\\bigr]^T$ and \n$|-T\\rangle=\\tfrac1{\\sqrt2}\\bigl[1,-e^{i\\pi/4}\\bigr]^T$, one finds\n$$\\langle -T|K_0|T\\rangle\n=\\frac1{2}\\bigl(1-\\sqrt{1-\\gamma}\\bigr),\\qquad\n\\langle -T|K_1|T\\rangle\n=-\\frac{\\sqrt\\gamma}{2}.$$\nHence\n$$p\n=\\frac1{4}\\bigl(1-\\sqrt{1-\\gamma}\\bigr)^2+\\frac\\gamma4\n=\\frac{1-\\sqrt{1-\\gamma}}2.$$\n\n2. The 15-to-1 protocol gives\n$$P_I=(1-p)^{15},\\qquad \nP_Z=35\\,p^3(1-p)^{12},\\qquad\np_{\\rm out}=\\frac{P_Z}{P_I+P_Z}.$$\nThe output fidelity is \n$$F_{out}=1-p_{\\rm out}\n=\\frac{(1-p)^{15}}{(1-p)^{15}+35\\,p^3(1-p)^{12}}\n=\\frac{(1-p)^3}{(1-p)^3+35\\,p^3}.$$\n\n3. Substitute $p=\\frac{1-\\sqrt{1-\\gamma}}2$:\n$$(1-p)=\\frac{1+\\sqrt{1-\\gamma}}2,\\qquad\np=\\frac{1-\\sqrt{1-\\gamma}}2.$$\nThus\n$$F_{out}\n=\\frac{\\bigl(\\tfrac{1+\\sqrt{1-\\gamma}}2\\bigr)^3}\n{\\bigl(\\tfrac{1+\\sqrt{1-\\gamma}}2\\bigr)^3\n+35\\bigl(\\tfrac{1-\\sqrt{1-\\gamma}}2\\bigr)^3}\n=\\frac{(1+\\sqrt{1-\\gamma})^3}{(1+\\sqrt{1-\\gamma})^3\n+35\\,(1-\\sqrt{1-\\gamma})^3}.$$", "answer": "$$\\boxed{\\frac{(1+\\sqrt{1-\\gamma})^3}{(1+\\sqrt{1-\\gamma})^3+35\\,(1-\\sqrt{1-\\gamma})^3}}$$", "id": "98576"}, {"introduction": "A truly fault-tolerant system must be resilient not only to noisy input states but also to failures within the error correction process itself. This exercise shifts the focus from input noise to procedural faults by exploring a scenario where an error is correctly detected but incorrectly corrected due to a hardware malfunction [@problem_id:98634]. By tracing how the initial error and the faulty recovery operation combine, you will determine the resulting logical error that corrupts the final state. This analysis provides critical insight into how physical faults propagate to the logical level, a key concept in designing robust quantum algorithms.", "problem": "A fault-tolerant quantum computation scheme uses the [[5,1,3]] error-correcting code to prepare high-fidelity T-states. The five-qubit code is defined by the stabilizer generators:\n$$ g_1 = X \\otimes Z \\otimes Z \\otimes X \\otimes I $$\n$$ g_2 = I \\otimes X \\otimes Z \\otimes Z \\otimes X $$\n$$ g_3 = X \\otimes I \\otimes X \\otimes Z \\otimes Z $$\n$$ g_4 = Z \\otimes X \\otimes I \\otimes X \\otimes Z $$\nThe corresponding logical Pauli operators are:\n$$ \\bar{X} = X \\otimes X \\otimes X \\otimes X \\otimes X $$\n$$ \\bar{Z} = Z \\otimes Z \\otimes Z \\otimes Z \\otimes Z $$\n$$ \\bar{Y} = i\\bar{X}\\bar{Z} $$\n\nThe protocol is designed to produce a logical T-state, denoted $|T\\rangle_L$, which corresponds to the ideal single-qubit T-state $|T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$ in the logical basis $\\{|0\\rangle_L, |1\\rangle_L\\}$.\n\nSuppose that during one run of the protocol, a single-qubit Pauli Z error occurs on the first physical qubit, described by the operator $E = Z \\otimes I \\otimes I \\otimes I \\otimes I$. The error is detected by measuring the stabilizer generators. However, due to a hardware malfunction, an incorrect recovery operation is applied. Instead of the proper correction, a Pauli X operator is applied to the first physical qubit, $C = X \\otimes I \\otimes I \\otimes I \\otimes I$.\n\nAssume the protocol proceeds as if the correction was successful, meaning the state is then processed by the subsequent logical operations. The net effect of the initial error and the faulty correction is a residual error operator $E_{res} = C \\cdot E$ acting on the encoded logical state $|T\\rangle_L$. The action of a physical error operator on the codespace is equivalent to the action of a corresponding logical Pauli operator. This logical operator is determined by the commutation relations of the physical error operator with the logical operators $\\bar{X}$ and $\\bar{Z}$.\n\nCalculate the fidelity, $F = |\\langle T|_L |\\psi_{out}\\rangle_L|^2$, between the ideal logical T-state $|T\\rangle_L$ and the final state of the logical qubit, $|\\psi_{out}\\rangle_L$.", "solution": "The residual error operator is $E_{\\text{res}} = C \\cdot E = (X \\otimes I \\otimes I \\otimes I \\otimes I) \\cdot (Z \\otimes I \\otimes I \\otimes I \\otimes I) = (XZ) \\otimes I \\otimes I \\otimes I \\otimes I$. This operator anticommutes with both logical operators $\\bar{X} = X \\otimes X \\otimes X \\otimes X \\otimes X$ and $\\bar{Z} = Z \\otimes Z \\otimes Z \\otimes Z \\otimes Z$, as determined by their commutation relations. The only logical Pauli operator that anticommutes with both $\\bar{X}$ and $\\bar{Z}$ is $\\bar{Y} = i \\bar{X} \\bar{Z}$. Thus, $E_{\\text{res}}$ acts as $\\bar{Y}$ on the logical state up to a global phase, which does not affect the fidelity.\n\nThe ideal logical T-state is $|T\\rangle_L = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + e^{i\\pi/4} |1\\rangle_L)$. The state after the error and faulty correction is $|\\psi_{out}\\rangle_L = \\bar{Y} |T\\rangle_L$. Applying $\\bar{Y}$:\n$$\n\\bar{Y} |0\\rangle_L = i |1\\rangle_L, \\quad \\bar{Y} |1\\rangle_L = -i |0\\rangle_L\n$$\n$$\n|\\psi_{out}\\rangle_L = \\frac{1}{\\sqrt{2}} \\left( \\bar{Y} |0\\rangle_L + e^{i\\pi/4} \\bar{Y} |1\\rangle_L \\right) = \\frac{1}{\\sqrt{2}} \\left( i |1\\rangle_L - i e^{i\\pi/4} |0\\rangle_L \\right) = \\frac{i}{\\sqrt{2}} \\left( |1\\rangle_L - e^{i\\pi/4} |0\\rangle_L \\right)\n$$\nThe fidelity is $F = \\left| \\langle T|_L | \\psi_{out}\\rangle_L \\right|^2$. We compute the inner product:\n$$\n\\langle T|_L |\\psi_{out}\\rangle_L = \\left( \\frac{\\langle 0|_L + e^{-i\\pi/4} \\langle 1|_L}{\\sqrt{2}} \\right) \\left( \\frac{i}{\\sqrt{2}} \\left( |1\\rangle_L - e^{i\\pi/4} |0\\rangle_L \\right) \\right) = \\frac{i}{2} \\left( e^{-i\\pi/4} - e^{i\\pi/4} \\right)\n$$\nUsing the identity $e^{i\\theta} - e^{-i\\theta} = 2i \\sin(\\theta)$, we have $e^{-i\\pi/4} - e^{i\\pi/4} = -2i \\sin(\\pi/4) = -2i \\frac{\\sqrt{2}}{2} = -i\\sqrt{2}$.\n$$\n\\langle T|_L |\\psi_{out}\\rangle_L = \\frac{i}{2} \\left( -i\\sqrt{2} \\right) = \\frac{\\sqrt{2}}{2}\n$$\nThe magnitude squared is:\n$$\nF = \\left| \\frac{\\sqrt{2}}{2} \\right|^2 = \\left( \\frac{\\sqrt{2}}{2} \\right)^2 = \\frac{2}{4} = \\frac{1}{2}\n$$", "answer": "$$ \\boxed{\\dfrac{1}{2}} $$", "id": "98634"}]}