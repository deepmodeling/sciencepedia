{"hands_on_practices": [{"introduction": "A core skill in analyzing fault-tolerant circuits is tracking how physical errors on resource states propagate to become logical errors on data qubits. The CNOT gate teleportation protocol provides a clear example of this \"error pushing\" mechanism. This exercise [@problem_id:86807] will guide you through the process of commuting Pauli errors on an entangled resource pair through the teleportation circuit to determine the resulting correlated logical error.", "problem": "In fault-tolerant quantum computation, logical gates between encoded qubits are often implemented using gate teleportation to avoid direct interactions that can spread errors. Consider a scenario where we wish to perform a logical CNOT gate, $CNOT_{12}$, between a control logical qubit $|\\psi_1\\rangle_L$ and a target logical qubit $|\\psi_2\\rangle_L$. Both qubits are encoded using the 5-qubit perfect code $[[5, 1, 3]]$. The logical Pauli operators for any such encoded qubit will be denoted by $X_L, Y_L, Z_L$.\n\nThe CNOT gate is implemented using the following teleportation protocol:\n1.  An EPR resource state, ideally $|\\Phi^+\\rangle_{AB} = \\frac{1}{\\sqrt{2}}(|00\\rangle_{AB} + |11\\rangle_{AB})$, is shared between two locations, A and B.\n2.  A transversal $CNOT_{1,A}$ gate is applied, with the logical qubit 1 as control and ancilla qubit A as target.\n3.  A transversal $CNOT_{2,B}$ gate is applied, with the logical qubit 2 as control and ancilla qubit B as target. The order of these two CNOTs does not affect the outcome.\n4.  Ancilla A is measured in the X-basis (eigenstates $|\\pm\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle \\pm |1\\rangle)$), yielding outcome $m_A \\in \\{0, 1\\}$.\n5.  Ancilla B is measured in the Z-basis (eigenstates $|0\\rangle, |1\\rangle$), yielding outcome $m_B \\in \\{0, 1\\}$.\n6.  Pauli corrections $C = Z_1^{m_B} X_2^{m_A}$ are applied to the logical qubits.\n\nSuppose the EPR resource state is not prepared perfectly, but rather in the faulty state $|\\Psi_{err}\\rangle_{AB} = (Y_A \\otimes Z_B) |\\Phi^+\\rangle_{AB}$, where $Y_A$ and $Z_B$ are the standard Pauli operators acting on the respective ancilla qubits. This physical error on the resource propagates through the teleportation circuit and manifests as a logical error on the data qubits.\n\nDetermine the pair of correlated logical Pauli errors $(L_1, L_2)$, corresponding to the operator $L_1 \\otimes L_2$, that is applied to the logical state $|\\psi_1\\rangle_L |\\psi_2\\rangle_L$ as a result of the faulty resource state. Your answer should be a pair of logical Pauli operators, ignoring any overall complex phase. For example, a valid answer would be of the form $(X_L, Z_L)$.", "solution": "We wish to track the resource error  \n$$E=(Y_A\\otimes Z_B)\\,|\\Phi^+\\rangle_{AB}$$  \nthrough the teleportation circuit \n$$U=\\mathrm{CNOT}_{2,B}\\;\\mathrm{CNOT}_{1,A}\\,. $$  \n1. Conjugation by CNOT on Pauli operators gives (up to a phase):  \n$$\\mathrm{CNOT}_{c,t}(I_c\\otimes X_t)\\mathrm{CNOT}_{c,t}=I_c\\otimes X_t,\\quad\n\\mathrm{CNOT}_{c,t}(I_c\\otimes Z_t)\\mathrm{CNOT}_{c,t}=Z_c\\otimes Z_t,$$  \nand hence for $Y_t=iX_tZ_t$  \n$$\\mathrm{CNOT}_{c,t}(I\\otimes Y)\\mathrm{CNOT}_{c,t}=Z_c\\otimes Y_t\\,. $$  \nThus  \n$$E' \\;=\\; U\\,(Y_A\\,Z_B)\\,U^\\dagger\n=\\bigl(\\mathrm{CNOT}_{1,A}Y_A\\mathrm{CNOT}_{1,A}\\bigr)\\,\n  \\bigl(\\mathrm{CNOT}_{2,B}Z_B\\mathrm{CNOT}_{2,B}\\bigr) \n=Z_1\\,Y_A\\;\\times\\;Z_2\\,Z_B\\,. $$\n\n2. Next we perform an X-basis measurement on $A$ with feedforward $X_2^{m_A}$.  \nA $Z_A$ error anticommutes with $X_A$ and hence flips $m_A\\mapsto m_A\\oplus1$,  \nso $Z_A$ on $A$ induces an $X_2$ on qubit 2.  An $X_A$ error commutes and has no effect.  \nTherefore $Y_A=iX_AZ_A$ yields one $X_2$ on qubit 2.  \n\n3. We also measure $B$ in the $Z$ basis with feedforward $Z_1^{m_B}$.  \nA $Z_B$ error commutes with $Z_B$ and so has no effect on $m_B$ or on qubit 1.  \n\n4. Collecting all data‐qubit errors: direct factors $Z_1Z_2$ from $E'$ together with the induced $X_2$ give  \n$$Z_1\\,Z_2\\;X_2 = Z_1\\,(Z_2X_2)\\;\\simeq\\;Z_1\\,Y_2$$  \nup to an overall phase.  Hence the logical error pair is  \n$$(L_1,L_2)=(Z_L,\\;Y_L)\\,. $$", "answer": "$$\\boxed{(Z_L,\\,Y_L)}$$", "id": "86807"}, {"introduction": "Beyond identifying errors, it is crucial to quantify their impact on performance. Magic state injection is a cornerstone for performing non-Clifford T-gates, and the fidelity of the prepared magic state directly affects the fidelity of the entire computation. In this problem [@problem_id:86863], you will analyze how a standard depolarizing noise channel on a physical ancilla degrades the quality of a logical magic state, connecting a physical error probability $p$ to the final state fidelity.", "problem": "A common technique for preparing logical magic states, required for non-Clifford gates in many fault-tolerant quantum computation schemes, is state injection. Consider the Steane `[[7,1,3]]` quantum error-correcting code, which encodes one logical qubit into seven physical qubits. We wish to prepare the logical magic state $|\\psi_T\\rangle_L = \\frac{1}{\\sqrt{2}}(|0\\rangle_L + e^{i\\pi/4}|1\\rangle_L)$, where $|0\\rangle_L$ and $|1\\rangle_L$ are the logical basis states.\n\nThe state preparation protocol is as follows:\n1.  Initialize a logical data qubit in the $|0\\rangle_L$ state.\n2.  Prepare a physical ancilla qubit, ideally in the magic state $|\\psi_T\\rangle_a = \\frac{1}{\\sqrt{2}}(|0\\rangle_a + e^{i\\pi/4}|1\\rangle_a)$. However, the preparation is faulty and affected by a single-qubit depolarizing channel $\\mathcal{E}(\\rho) = (1-p)\\rho + p \\frac{I}{2}$. The ancilla state is thus $\\rho_a = \\mathcal{E}(|\\psi_T\\rangle_a\\langle\\psi_T|_a)$.\n3.  Apply a fault-tolerant logical CNOT gate, $U_{CNOT, a \\to L}$, with the ancilla as the control qubit and the logical qubit as the target. The action of this gate on the logical basis states is defined as $U_{CNOT, a \\to L} (|b\\rangle_a \\otimes |\\psi\\rangle_L) = |b\\rangle_a \\otimes (X_L)^b |\\psi\\rangle_L$, where $b \\in \\{0, 1\\}$ and $X_L$ is the logical Pauli-X operator.\n4.  Measure the ancilla qubit in the Hadamard basis, $\\{|+\\rangle_a, |-\\rangle_a\\}$, where $|\\pm\\rangle_a = \\frac{1}{\\sqrt{2}}(|0\\rangle_a \\pm |1\\rangle_a)$.\n5.  If the measurement outcome is '−', apply a logical Pauli-Z ($Z_L$) correction to the logical qubit. The logical $Z_L$ operator acts as $Z_L|0\\rangle_L=|0\\rangle_L$ and $Z_L|1\\rangle_L=-|1\\rangle_L$.\n\nAssume the logical CNOT gate, the measurement, and the potential correction are all performed perfectly. The only source of error is the initial preparation of the ancilla state.\n\nCalculate the fidelity $F = \\langle\\psi_T|_L \\rho_{final} |\\psi_T\\rangle_L$ between the final state of the logical qubit, $\\rho_{final}$, and the ideal logical magic state $|\\psi_T\\rangle_L$. Express your answer in terms of the depolarization probability $p$.", "solution": "1. Ancilla noise model:  \n$$\\rho_a = \\mathcal{E}(|\\psi_T\\rangle\\langle\\psi_T|) = (1-p)|\\psi_T\\rangle\\langle\\psi_T| + p\\,\\frac{I}{2}.$$\n\n2. Initial joint state (ancilla + logical data in $|0\\rangle_L$):  \n$$\\rho_{aL} = \\rho_a \\otimes |0\\rangle_L\\langle0|.$$\n\n3. After fault-free logical CNOT $U_{CNOT,a\\to L}$:\n$$\\rho'_{aL} = U_{CNOT}\\,\\rho_{aL}\\,U_{CNOT}^\\dagger.$$\nFor a pure ancilla component $|\\psi_T\\rangle_a = \\tfrac1{\\sqrt2}(|0\\rangle_a + e^{i\\pi/4}|1\\rangle_a)$ one obtains  \n$$|\\Phi\\rangle_{aL} = \\frac1{\\sqrt2}\\bigl(|0\\rangle_a|0\\rangle_L + e^{i\\pi/4}|1\\rangle_a|1\\rangle_L\\bigr).$$\n\n4. Measure ancilla in $\\{|\\pm\\rangle_a\\}$ and apply $Z_L$ if outcome is “–”. This teleports the ancilla state onto the logical qubit. Linearity implies the final logical density matrix is  \n$$\\rho_{final} \\;=\\;(1-p)\\,|\\psi_T\\rangle_L\\langle\\psi_T| + p\\,\\frac{I_L}{2}.$$\n\n5. Fidelity with the ideal magic state:  \n$$F = \\langle\\psi_T|_L\\,\\rho_{final}\\,|\\psi_T\\rangle_L = (1-p)\\cdot1 + p\\cdot\\frac12 = 1 - \\frac p2.$$", "answer": "$$\\boxed{1 - \\frac{p}{2}}$$", "id": "86863"}, {"introduction": "Moving to a concrete architectural context, this problem considers a fault within a surface code implementation of a CZ gate. The geometric nature of surface code logical operators means that the impact of a physical fault often depends on its location within the code patch. This advanced exercise [@problem_id:86816] challenges you to calculate the probability that a single faulty physical CNOT gate leads to a logical error, linking the teleportation protocol with the structural properties of the error-correcting code.", "problem": "A fault-tolerant Controlled-Z (CZ) gate between two logical data qubits, $D_1$ and $D_2$, is implemented using a logical ancilla qubit, $A$. The logical qubits are all encoded using a distance-$d$ planar surface code. The number of data qubits in each logical qubit is $N_{data} = 2d^2 - 2d + 1$. The sequence of ideal operations is as follows:\n1. The ancilla qubit $A$ is prepared in the logical state $|+\\rangle_L = \\frac{1}{\\sqrt{2}}(|0\\rangle_L + |1\\rangle_L)$.\n2. A transversal CNOT gate is applied with $D_1$ as the logical control and $A$ as the logical target.\n3. A transversal CNOT gate is applied with $D_2$ as the logical control and $A$ as the logical target.\n4. The ancilla qubit $A$ is measured in the logical X-basis. The logical measurement of an operator like $X_L$ is performed by measuring all its physical data qubits in the X-basis and then computing the parity of the outcomes for a specific string of $d$ data qubits. Let the logical outcome be $m_A \\in \\{0, 1\\}$.\n5. If the outcome $m_A=1$, a correction operator $C = Z_{D_1} \\otimes Z_{D_2}$ is applied to the data qubits. Otherwise, no correction is applied.\n\nConsider a single fault occurring during this process. Specifically, during the first transversal CNOT gate (from $D_1$ to $A$), one of the $N_{data}$ physical CNOT gates fails. This faulty CNOT acts between physical data qubit $i$ of $D_1$ and the corresponding physical data qubit $i$ of $A$. The fault is modeled as the application of an additional Pauli error operator $E_i = X_{D_1, i} \\otimes Z_{A, i}$ immediately following the otherwise perfect physical CNOT gate at location $i$. The location $i$ is chosen uniformly at random from all $N_{data}$ possible locations.\n\nAssume this error event is not immediately detected or corrected. The $X_{D_1, i}$ component of the error is a local physical error that, by itself, is perfectly correctable and does not produce a logical error on $D_1$. The entire logical CZ gate sequence, including the final measurement of $A$, completes before any correction is attempted.\n\nCalculate the probability, $P$, that this single faulty CNOT gate ultimately results in an uncorrected logical Pauli error of $Z_{D_1} \\otimes Z_{D_2}$ being applied to the final state of the data qubits.", "solution": "We have one faulty physical CNOT at a random location $i\\in\\{1,\\dots,N_{data}\\}$, introducing the Pauli error\n$$E_i \\;=\\; X_{D_1,i}\\,\\otimes\\,Z_{A,i}\\,. $$\nSince $X_{D_1,i}$ by itself is a single‐qubit error on $D_1$, it is correctable and cannot produce a logical error on $D_1$.  We therefore focus on the $Z_{A,i}$ component.\n\nStep 1: Propagation through the second CNOT ($D_2\\to A$).  Under\n$$\\mathrm{CNOT}(D_2\\to A):\\quad Z_A\\;\\mapsto\\;Z_{D_2}\\,Z_A,$$\nthe error on qubit $i$ becomes\n$$Z_{A,i}\\;\\longrightarrow\\;Z_{D_2,i}\\,Z_{A,i}\\,.$$\nThe factor $Z_{D_2,i}$ is a single‐qubit $Z$ on $D_2$, also correctable by the distance‐$d$ code, so we ignore it for logical error analysis.\n\nStep 2: Effect on ancilla logical $X$ measurement.  The ancilla logical $X_L$ is measured by measuring all physical qubits in the $X$ basis and taking the parity of a chosen string of $d$ qubits.  A $Z_{A,i}$ error flips the $X$ outcome on qubit $i$, and thus flips the \\emph{logical} outcome if and only if $i$ lies on the chosen string of size $d$.  Since the fault location $i$ is uniform over $N_{data}$ qubits, the probability of flipping the logical outcome is\n$$P \\;=\\;\\frac{d}{N_{data}}\\;=\\;\\frac{d}{2d^2-2d+1}\\,. $$\n\nStep 3: Connection to uncorrected $Z_{D_1}Z_{D_2}$.  In the ideal protocol, a flipped ancilla outcome $m_A$ causes the referee to apply the correction $Z_{D_1}Z_{D_2}$ incorrectly, yielding a residual logical $Z_{D_1}Z_{D_2}$ error.  Thus the above $P$ is exactly the probability of an uncorrected logical $Z_{D_1}Z_{D_2}$.\n\nTherefore,\n$$P \\;=\\;\\frac{d}{2d^2-2d+1}\\,. $$", "answer": "$$\\boxed{\\frac{d}{2d^2 - 2d + 1}}$$", "id": "86816"}]}