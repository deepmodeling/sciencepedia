{"hands_on_practices": [{"introduction": "The proof that BQP is contained in PP relies on representing quantum amplitudes as values computable by a special class of functions called GapP. This exercise provides a concrete, hands-on calculation to demonstrate this fundamental link. By analyzing a simple quantum circuit with rational parameters, you will directly compute the corresponding GapP value for a specific transition amplitude, solidifying your understanding of this crucial concept in complexity theory [@problem_id:130916].", "problem": "**Background:** The complexity class GapP consists of functions $f(x)$ that compute the difference between the number of accepting and rejecting paths of a non-deterministic polynomial-time Turing machine. Transition amplitudes of quantum circuits constructed from gates with rational-valued matrix entries are themselves rational numbers. For a transition amplitude $A = p/q$, the integer numerator $p$ can be computed by a GapP function for a fixed denominator $q$. This integer $p$ is referred to as the GapP value of the amplitude for the specified denominator $q$.\n\n**Problem:** Consider a 2-qubit system prepared in the initial state $|\\psi_{in}\\rangle = |00\\rangle$. A quantum circuit $U$ is applied, which is defined as the sequence of three operations: $U = U_3 U_2 U_1$. The operations are as follows:\n1.  $U_1 = H \\otimes I$: A Hadamard gate $H$ is applied to the first qubit, while the second qubit is unchanged.\n2.  $U_2 = C-R$: A controlled gate, with the first qubit as the control and the second qubit as the target. The single-qubit unitary operation $R$ is described by the real-valued matrix:\n    $$\n    R = \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n    $$\n    where $s = a/d$ and $c = b/d$ are rational parameters, with $a, b, d$ being integers.\n3.  $U_3 = H \\otimes I$: Another Hadamard gate is applied to the first qubit.\n\nYour task is to compute the GapP value of the transition amplitude $A = \\langle 11 | U | 00 \\rangle$. The denominator for this amplitude is fixed to be $2d$. Express your answer in terms of the parameter $a$.", "solution": "1. Initial state and first Hadamard:\n$$|\\psi_0\\rangle = |0\\rangle\\otimes|0\\rangle,\\quad\nU_1=H\\otimes I,\\quad\nH|0\\rangle=\\frac{|0\\rangle+|1\\rangle}{\\sqrt2}.$$\nThus\n$$|\\psi_1\\rangle\n=U_1|\\psi_0\\rangle\n=\\frac{1}{\\sqrt2}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle\n=\\frac{|00\\rangle+|10\\rangle}{\\sqrt2}.$$\n\n2. Controlled-$R$ with\n$$R=\\begin{pmatrix}c&-s\\\\s&c\\end{pmatrix},\\quad\nc=\\frac{b}{d},\\;s=\\frac{a}{d}.$$\nOn $|00\\rangle$ (control=0) it acts trivially; on $|10\\rangle$ (control=1):\n$$|10\\rangle\\mapsto|1\\rangle\\otimes R|0\\rangle\n=|1\\rangle\\otimes\\bigl(c|0\\rangle+s|1\\rangle\\bigr)\n=c|10\\rangle+s|11\\rangle.$$\nHence\n$$|\\psi_2\\rangle\n=\\frac{1}{\\sqrt2}\\bigl(|00\\rangle+c|10\\rangle+s|11\\rangle\\bigr).$$\n\n3. Second Hadamard on the first qubit:\n$$U_3=H\\otimes I,\\quad\nH|0\\rangle=\\tfrac{|0\\rangle+|1\\rangle}{\\sqrt2},\\;\nH|1\\rangle=\\tfrac{|0\\rangle-|1\\rangle}{\\sqrt2}.$$\nApply to each term in $|\\psi_2\\rangle$:\n\n$$\n\\begin{aligned}\n|00\\rangle&\\mapsto\\tfrac1{\\sqrt2}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle,\\\\\nc\\,|10\\rangle&\\mapsto\\tfrac{c}{\\sqrt2}(|0\\rangle-|1\\rangle)\\otimes|0\\rangle,\\\\\ns\\,|11\\rangle&\\mapsto\\tfrac{s}{\\sqrt2}(|0\\rangle-|1\\rangle)\\otimes|1\\rangle.\n\\end{aligned}\n$$\n\nSumming and including the prefactor $1/\\sqrt2$ gives\n$$|\\psi_3\\rangle\n=\\frac1{2}\\Bigl[(1+c)|00\\rangle+(1-c)|10\\rangle\n+s\\,|01\\rangle -s\\,|11\\rangle\\Bigr].$$\n\n4. Extract the amplitude $A=\\langle11|\\psi_3\\rangle$:\n$$A=-\\frac{s}{2}=-\\frac{a/d}{2}=-\\frac{a}{2d}.$$\n\n5. For denominator $2d$, the integer numerator (GapP value) is\n$$p=-a.$$", "answer": "$$\\boxed{-a}$$", "id": "130916"}, {"introduction": "While the connection to GapP is exact for circuits with rational amplitudes, general quantum algorithms use gates with irrational entries that must be approximated for classical simulation. This practice problem delves into the mechanics of this approximation, a cornerstone of the BQP $\\subseteq$ PP proof [@problem_id:130813]. You will calculate a #P value representing the number of \"accepting\" computational paths in a simulated quantum circuit, gaining insight into the constructive nature of the proof.", "problem": "In the study of computational complexity, the relationship between the quantum complexity class BQP (Bounded-error Quantum Polynomial time) and classical complexity classes like P and NP is a subject of fundamental importance. It has been shown that BQP is contained in PP (Probabilistic Polynomial time), a class of problems solvable by a probabilistic Turing machine with an exponentially small probability gap. The proof of this containment, BQP $\\subseteq$ PP, relies on simulating a quantum computation via a path integral formalism, reminiscent of Feynman's path integrals in quantum mechanics.\n\nA quantum computation is described by a sequence of unitary gates $U = U_m U_{m-1} \\dots U_1$. The amplitude of transitioning from an initial state $|x\\rangle$ to a final state $|y\\rangle$ is given by the sum over all possible computational paths:\n$$\n\\langle y | U | x \\rangle = \\sum_{z_1, \\dots, z_{m-1}} \\langle y | U_m | z_{m-1} \\rangle \\dots \\langle z_1 | U_1 | x \\rangle\n$$\nEach term in the sum corresponds to the amplitude of a single path. To simulate this on a classical probabilistic machine, the gate amplitudes, which can be irrational complex numbers, are approximated by dyadic rationals (fractions with a power-of-two denominator). For a given precision parameter $p$, each real-valued gate matrix element $g_{uv} = \\langle u | G | v \\rangle$ is approximated by $\\tilde{g}_{uv} = k_{uv}/2^p$, where $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$ is an integer. For complex amplitudes, real and imaginary parts are approximated separately.\n\nThe total approximate amplitude is a sum of products of these dyadic rationals, which can be written as $S / 2^{mp}$. The integer quantity $S = \\sum_{\\text{paths}} \\prod_{\\text{gates}} k_{uv}$ is a GapP function, meaning it can be expressed as the difference between the number of accepting paths ($N_{acc}$) and rejecting paths ($N_{rej}$) of a non-deterministic Turing machine. Specifically, we define the weight of a path as the product of its integer numerators $W(\\text{path}) = \\prod k_{uv}$. Then, $N_{acc} = \\sum_{W>0} W(\\text{path})$ and $N_{rej} = \\sum_{W<0} |W(\\text{path})|$. The values $N_{acc}$ and $N_{rej}$ are computable in #P.\n\nYour task is to perform such a calculation for a specific 2-qubit quantum circuit.\n\n**Problem Statement:**\n\nConsider a 2-qubit quantum circuit described by the unitary operator $U = U_3 U_2 U_1$, where:\n1.  $U_1 = -H \\otimes I$, where $H$ is the Hadamard gate and $I$ is the identity gate.\n2.  $U_2$ is a controlled-$R_Y(\\theta)$ gate, with the first qubit as control and the second as target, with rotation angle $\\theta = \\pi/3$. The $R_Y(\\theta)$ gate is defined as $R_Y(\\theta) = \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix}$.\n3.  $U_3 = H \\otimes I$.\n\nThe gate matrices act on the standard computational basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$. All gate matrix entries are real. The dyadic approximation for a gate entry $g_{uv}$ is $\\tilde{g}_{uv} = k_{uv} / 2^p$, with the integer numerator $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$ and precision $p=5$. The `round()` function rounds a real number to the nearest integer (with half-integers rounded up).\n\nCalculate the value of $N_{acc}$ for the transition amplitude from initial state $|x\\rangle = |00\\rangle$ to final state $|y\\rangle = |11\\rangle$. This value is the sum of weights of all computational paths that have a positive total weight.", "solution": "1. The amplitude for the transition $|00\\rangle\\to|11\\rangle$ is\n$$\n\\langle11|U_3U_2U_1|00\\rangle\n=\\sum_{z_1,z_2}\\langle11|U_3|z_2\\rangle\\langle z_2|U_2|z_1\\rangle\\langle z_1|U_1|00\\rangle.\n$$\n\n2. Matrix‐element amplitudes (exact):\n- $U_1=-H\\otimes I$ gives \n  $$\\langle z_1|U_1|00\\rangle=\n  \\begin{cases}\n  -\\tfrac1{\\sqrt2},&z_1=00,10,\\\\\n  0,&\\text{otherwise.}\n  \\end{cases}$$\n- $U_2=\\mathrm{C}\\!R_Y(\\pi/3)$ acts as identity if first bit $=0$, and as\n  $$R_Y(\\tfrac\\pi3)=\\begin{pmatrix}\\cos\\tfrac\\pi6&-\\sin\\tfrac\\pi6\\\\\\sin\\tfrac\\pi6&\\cos\\tfrac\\pi6\\end{pmatrix}\n  $$\n  if first bit $=1$.  Hence\n  $$\\langle z_2|U_2|z_1\\rangle\\neq0\\iff z_1=10,\\ z_2\\in\\{10,11\\},$$\n  with \n  $$\\langle11|U_2|10\\rangle=\\sin\\tfrac\\pi6=\\tfrac12.$$\n- $U_3=H\\otimes I$ gives\n  $$\\langle11|U_3|z_2\\rangle\\neq0\\iff z_2\\in\\{01,11\\},\\quad\n  \\langle11|U_3|11\\rangle=-\\tfrac1{\\sqrt2}.$$\n\n3. The only nonzero path is $00\\to z_1=10\\to z_2=11\\to11$, with exact amplitude\n$$\n(-\\tfrac1{\\sqrt2})\\times(\\tfrac12)\\times(-\\tfrac1{\\sqrt2})\n=\\;\\frac1{4}.\n$$\n\n4. Dyadic approximation with $p=5$: multiply each exact entry $g$ by $2^5=32$ and round.\n   - For $U_1$: $g=-\\tfrac1{\\sqrt2}=-\\tfrac{\\sqrt2}{2}\\;\\Longrightarrow\\;k_1=\\round(32\\cdot(-\\tfrac{\\sqrt2}{2}))=\\round(-16\\sqrt2)=-23$.\n   - For $U_2$: $g=\\tfrac12\\;\\Longrightarrow\\;k_2=\\round(32\\cdot\\tfrac12)=16$.\n   - For $U_3$: $g=-\\tfrac1{\\sqrt2}\\;\\Longrightarrow\\;k_3=-23$.\n\n5. The integer weight of the unique path is\n$$\nW = k_1\\,k_2\\,k_3 = (-23)\\times16\\times(-23)=23^2\\cdot16=8464>0.\n$$\nThus $N_{acc}$, the sum of positive weights, is $8464$.", "answer": "$$\\boxed{8464}$$", "id": "130813"}, {"introduction": "Theoretical models often assume perfect, noiseless quantum evolution, but real quantum computers are subject to decoherence, which alters their computational power. This advanced exercise extends the simulation framework to a noisy quantum process described by a phase-damping channel [@problem_id:130839]. By deriving how a key measurable quantity relates to the noise parameter $\\gamma$, you will explore how the principles connecting quantum dynamics and classical complexity theory can be applied to more realistic physical scenarios.", "problem": "**Background:**\n\nIn quantum complexity theory, BQP (Bounded-error Quantum Polynomial time) is the class of decision problems solvable by a quantum computer in polynomial time with an error probability of at most 1/3. The relationship between BQP and classical complexity classes like P and NP is a central area of research. It is known that BQP is contained in the classical complexity class PP (Probabilistic Polynomial time).\n\nA language is in PP if there is a probabilistic Turing machine that accepts strings in the language with probability greater than 1/2, and rejects strings not in the language with probability less than 1/2. The gap from 1/2 can be exponentially small. The behavior of a PP machine can be characterized by a function in the class GapP, which is the closure of #P (counting problems) under subtraction. Specifically, a function $g(x)$ is in GapP if it can be expressed as $N_{acc}(x) - N_{rej}(x)$, where $N_{acc}$ and $N_{rej}$ are the number of accepting and rejecting paths of a non-deterministic Turing machine. A language is in PP if its membership can be decided by the sign of a corresponding GapP function.\n\nThe proof that BQP $\\subseteq$ PP involves constructing a PP machine that simulates the quantum computation. For a noiseless quantum circuit $U$, the difference between acceptance and rejection probabilities, $p_{acc} - p_{rej}$, can be shown to be proportional to a value computable by a GapP function. For a circuit starting in state $|0^n\\rangle$ where acceptance is defined by measuring the first qubit as '0', this value is $\\langle 0^n | U^\\dagger Z_1 U | 0^n \\rangle$, where $Z_1$ is the Pauli-Z operator on the first qubit.\n\nThis problem explores how this connection is altered in the presence of decoherence.\n\n**Problem Statement:**\n\nConsider a single-qubit quantum system, initially prepared in the state $|\\psi_0\\rangle = |0\\rangle$. A quantum circuit consisting of a single Hadamard gate, $U=H$, is applied to the qubit. After the gate application, the qubit undergoes a phase-damping noisy evolution described by the channel $\\mathcal{E}$. The Kraus operators for this channel are:\n$$\nK_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\sqrt{1-\\gamma} \\end{pmatrix}, \\quad K_1 = \\begin{pmatrix} 0 & 0 \\\\ 0 & \\sqrt{\\gamma} \\end{pmatrix}\n$$\nwhere $\\gamma \\in [0, 1]$ is the damping parameter. The action of the channel on a density matrix $\\rho$ is $\\mathcal{E}(\\rho) = K_0 \\rho K_0^\\dagger + K_1 \\rho K_1^\\dagger$.\n\nThe final state of the system is $\\rho_f = \\mathcal{E}(H |\\psi_0\\rangle \\langle\\psi_0| H^\\dagger)$.\n\nA measurement is then performed in the basis of the Pauli-X operator. The acceptance probability, $p_{acc}$, is the probability of obtaining the outcome $+1$ (corresponding to the state $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$). The rejection probability, $p_{rej}$, is the probability of obtaining the outcome $-1$ (corresponding to the state $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$).\n\nThe quantity $P = p_{acc} - p_{rej}$ is the effective polarization of the final state in the X-basis. This quantity is what a PP machine would need to estimate to simulate this noisy quantum process. Derive the exact expression for this polarization $P$ as a function of the damping parameter $\\gamma$.", "solution": "We have initial state $|\\psi_0\\rangle=|0\\rangle$ and apply $H$, so\n$$\n\\rho_1=H\\,|0\\rangle\\langle0|\\,H^\\dagger\n=\\frac12\\begin{pmatrix}1&1\\\\1&1\\end{pmatrix}.\n$$\nThe phase‐damping channel gives\n$$\n\\rho_f=K_0\\,\\rho_1\\,K_0^\\dagger+K_1\\,\\rho_1\\,K_1^\\dagger,\n\\quad\nK_0=\\begin{pmatrix}1&0\\\\0&\\sqrt{1-\\gamma}\\end{pmatrix},\n\\;\nK_1=\\begin{pmatrix}0&0\\\\0&\\sqrt{\\gamma}\\end{pmatrix}.\n$$\nCompute each term:\n$$\nK_0\\,\\rho_1\n=\\frac12\\begin{pmatrix}1&1\\\\\\sqrt{1-\\gamma}&\\sqrt{1-\\gamma}\\end{pmatrix},\n\\quad\nK_0\\,\\rho_1\\,K_0^\\dagger\n=\\frac12\\begin{pmatrix}1&\\sqrt{1-\\gamma}\\\\\\sqrt{1-\\gamma}&1-\\gamma\\end{pmatrix}.\n$$\n$$\nK_1\\,\\rho_1\n=\\frac12\\begin{pmatrix}0&0\\\\\\sqrt{\\gamma}&\\sqrt{\\gamma}\\end{pmatrix},\n\\quad\nK_1\\,\\rho_1\\,K_1^\\dagger\n=\\frac12\\begin{pmatrix}0&0\\\\0&\\gamma\\end{pmatrix}.\n$$\nSumming,\n$$\n\\rho_f\n=\\frac12\\begin{pmatrix}1&\\sqrt{1-\\gamma}\\\\\\sqrt{1-\\gamma}&1-\\gamma\\end{pmatrix}\n+\\frac12\\begin{pmatrix}0&0\\\\0&\\gamma\\end{pmatrix}\n=\\frac12\\begin{pmatrix}1&\\sqrt{1-\\gamma}\\\\\\sqrt{1-\\gamma}&1\\end{pmatrix}.\n$$\nThe polarization in the $X$‐basis is\n$$\nP=p_{acc}-p_{rej}\n=\\Tr\\bigl(X\\,\\rho_f\\bigr)\n=\\rho_{f,01}+\\rho_{f,10}\n=\\sqrt{1-\\gamma}.\n$$", "answer": "$$\\boxed{\\sqrt{1-\\gamma}}$$", "id": "130839"}]}