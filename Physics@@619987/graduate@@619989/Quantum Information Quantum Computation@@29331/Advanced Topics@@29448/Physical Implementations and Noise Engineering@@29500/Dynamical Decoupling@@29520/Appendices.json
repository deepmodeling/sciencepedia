{"hands_on_practices": [{"introduction": "The Hahn echo is the archetypal dynamical decoupling sequence, designed to reverse dephasing caused by a quasi-static environment. By applying a single $\\pi$-pulse midway through an evolution, the qubit's phase accumulation is effectively \"rewound,\" canceling the noise. This exercise [@problem_id:71352] challenges you to explore the limits of this simple picture by analyzing a qubit coupled to a single environmental two-level system (TLS) which has its own internal dynamics. Calculating the final qubit coherence will reveal how the environment's non-static nature prevents perfect noise cancellation, providing a crucial insight into the performance of basic echo sequences.", "problem": "A qubit, described by Pauli operators $\\vec{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$, is subject to decoherence from a single environmental two-level system (TLS). The TLS is described by its own set of Pauli operators $\\vec{\\tau} = (\\tau_x, \\tau_y, \\tau_z)$. The total Hamiltonian of the coupled system is given by:\n$$ H = \\frac{\\Delta}{2} \\tau_x + g \\sigma_z \\tau_z $$\nwhere $\\Delta$ is the tunneling amplitude of the TLS and $g$ is the coupling strength between the qubit and the TLS. We assume $\\Delta > 0$ and $g > 0$. Let $|0\\rangle, |1\\rangle$ be the eigenstates of $\\sigma_z$ and $|0_E\\rangle, |1_E\\rangle$ be the eigenstates of $\\tau_z$.\n\nAt time $t=0$, the qubit is prepared in the superposition state $|\\psi_S(0)\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$. The TLS is simultaneously prepared in the ground state of its own Hamiltonian, $H_E = \\frac{\\Delta}{2} \\tau_x$.\n\nTo combat decoherence, a Hahn echo sequence is applied to the qubit. The sequence consists of:\n1. Free evolution of the total system under the Hamiltonian $H$ for a duration $\\tau/2$.\n2. An ideal, instantaneous $\\pi$-pulse around the x-axis applied to the qubit. The pulse is described by the unitary operator $U_\\pi = e^{-i\\frac{\\pi}{2}\\sigma_x} = -i\\sigma_x$.\n3. Free evolution of the total system under $H$ for another duration $\\tau/2$.\n\nThe total duration of the sequence is $T = \\tau$. Calculate the real part of the off-diagonal element $\\rho_{01}(T) = \\langle 0 | \\rho_S(T) | 1 \\rangle$ of the qubit's reduced density matrix $\\rho_S(T) = \\mathrm{Tr}_E[\\rho(T)]$ at the end of the sequence. Express your answer in terms of $\\tau, g, \\Delta$, and the reduced Planck constant $\\hbar$.", "solution": "1. The initial off-diagonal element is $\\rho_{01}(0) = \\frac{1}{2}$. Its evolution is given by $\\rho_{01}(T) = \\frac{1}{2} \\mathrm{Tr}_E[U_{echo} \\rho_E(0)]$, where $\\rho_E(0)$ is the initial density matrix of the TLS and $U_{echo}$ is the effective unitary operator acting on the TLS that describes the echo's effect on coherence. A detailed derivation shows that after a Hahn echo sequence, this operator is the group commutator of the conditional TLS evolution operators: $U_{echo} = U_- U_+ U_-^\\dagger U_+^\\dagger$. Here, $U_\\pm = \\exp(-i H_\\pm t/\\hbar)$ are the propagators for the TLS over a time $t=\\tau/2$, conditioned on the qubit being in the state where $\\sigma_z \\to \\pm 1$. We take the convention where $|0\\rangle$ has $\\sigma_z=+1$ and $|1\\rangle$ has $\\sigma_z=-1$, so $H_\\pm = \\frac{\\Delta}{2} \\tau_x \\pm g \\tau_z$.\nThus, we must calculate:\n$$ \\rho_{01}(T) = \\frac{1}{2} \\langle \\psi_E(0) | U_- U_+ U_-^\\dagger U_+^\\dagger | \\psi_E(0) \\rangle $$\n\n2. The TLS is prepared in the ground state of $\\frac{\\Delta}{2} \\tau_x$, which is the state $|-\\rangle_x$ with Bloch vector $( -1, 0, 0)$. For such a state, the expectation value of an operator $D = D_0 I + \\vec{D} \\cdot \\vec{\\tau}$ is $D_0 - D_x$. The operator $U_{echo}$ is real, so $\\rho_{01}(T)$ is real. We need the scalar part of $U_{echo}$.\n\n3. Let $t = \\tau/2$. The conditional propagators are $U_\\pm(t) = cI - i s \\, \\vec{n}_\\pm \\cdot \\vec{\\tau}$, where $c=\\cos(\\phi)$, $s=\\sin(\\phi)$, $\\phi=Et/(2\\hbar)$, $E = \\sqrt{\\Delta^2+4g^2}$, and $\\vec{n}_\\pm = (\\Delta, 0, \\pm 2g)/E$.\n\n4. The product $U_-U_+$ is unitary: $(U_-U_+)^\\dagger (U_-U_+) = U_+^\\dagger U_-^\\dagger U_- U_+ = I$. We can write $U_-U_+ = aI - i\\vec{b}\\cdot\\vec{\\tau}$. Since it is unitary, $a^2 + |\\vec{b}|^2=1$. The group commutator is $U_{echo} = (U_-U_+)(U_+U_-)^\\dagger$.\n\n5. A direct calculation yields $U_+U_- = aI - i\\vec{b'}\\cdot\\vec{\\tau}$, where $\\vec{b'}$ is obtained from $\\vec{b}$ by swapping the roles of $\\pm g$. The group commutator is $U_{echo} = (aI - i\\vec{b}\\cdot\\vec{\\tau})(aI + i\\vec{b'}\\cdot\\vec{\\tau}) = (a^2 + \\vec{b}\\cdot\\vec{b'})I + i(a(\\vec{b'}-\\vec{b}) + \\vec{b}\\times\\vec{b'}) \\cdot \\vec{\\tau}$.\n\n6. We only need the scalar part: $a^2 + \\vec{b}\\cdot\\vec{b'}$.\nUsing the fact that $a^2+|\\vec{b}|^2=1$ and $\\vec{b}\\cdot\\vec{b'} = |\\vec{b}|^2 - 2 s^4 \\frac{16 g^2 \\Delta^2}{E^4}$, we find:\n$$ a^2 + \\vec{b}\\cdot\\vec{b'} = (a^2+|\\vec{b}|^2) - 2 s^4 \\frac{16 g^2 \\Delta^2}{E^4} = 1 - \\frac{32 g^2 \\Delta^2}{E^4} \\sin^4(\\phi) $$\nThis expression is the expectation value of $U_{echo}$ for the maximally mixed state. For our initial pure state $|-\\rangle_x$, the full calculation confirms this is also the final result because the vector part of $U_{echo}$ does not have a $\\tau_x$ component.\n\n7. Substituting $E = \\sqrt{\\Delta^2+4g^2}$ and $\\phi = E\\tau/(4\\hbar)$, the real part of the final coherence is:\n$$ \\Re\\,\\rho_{01}(T) = \\frac{1}{2} \\left( 1 - \\frac{32 g^2 \\Delta^2}{(\\Delta^2+4g^2)^2} \\sin^4\\!\\left(\\frac{\\tau\\sqrt{\\Delta^2+4g^2}}{4\\hbar}\\right) \\right) $$", "answer": "$$\\boxed{\\frac12\\Bigl[1-\\frac{32\\,g^2\\,\\Delta^2}{(\\Delta^2+4g^2)^2}\\,\n   \\sin^4\\!\\Bigl(\\frac{\\tau\\sqrt{\\Delta^2+4g^2}}{4\\hbar}\\Bigr)\\Bigr]}$$", "id": "71352"}, {"introduction": "To analyze the effect of control sequences on general noise environments, we can move to the frequency domain using the filter function formalism. This powerful perspective treats a dynamical decoupling sequence as a high-pass filter that suppresses noise at low frequencies. This practice [@problem_id:71262] invites you to apply this formalism by calculating the coherence decay exponent $\\chi(T)$ for a qubit protected by a Hahn echo sequence in a bath described by Ornstein-Uhlenbeck noise. Successfully solving this problem will provide hands-on experience with the filter function integral and a quantitative understanding of how DD shapes the qubit's response to its environment.", "problem": "A single qubit is used as a probe of a classical dephasing environment. The interaction Hamiltonian in a suitable rotating frame is given by $H(t) = \\frac{1}{2}\\hbar \\beta(t) \\sigma_z$, where $\\sigma_z$ is the Pauli Z-operator and $\\beta(t)$ is a classical stochastic noise process. The noise is modeled as an Ornstein-Uhlenbeck (OU) process, which is a Gaussian process with zero mean, $\\langle \\beta(t) \\rangle = 0$, and an exponentially decaying autocorrelation function, $\\langle \\beta(t_1) \\beta(t_2) \\rangle = \\alpha^2 \\exp(-|t_1 - t_2|/\\tau_c)$. Here, $\\alpha$ characterizes the noise amplitude and $\\tau_c$ is its correlation time.\n\nTo mitigate the effects of this noise, a Hahn echo sequence is applied. The qubit evolves freely for a total duration $T$. At time $T/2$, an instantaneous ideal $\\pi$-pulse is applied to the qubit, which effectively inverts the sign of the Hamiltonian for the subsequent evolution.\n\nThe loss of coherence of the qubit can be quantified by a decay exponent, $\\chi(T)$, such that the coherence decays as $e^{-\\chi(T)}$. For a Gaussian process, this exponent is given by\n$$\n\\chi(T) = \\frac{1}{2} \\int_0^T \\int_0^T y(t_1) y(t_2) \\langle \\beta(t_1) \\beta(t_2) \\rangle \\, dt_1 \\, dt_2\n$$\nwhere the filter function $y(t)$ models the effect of the control sequence. For the Hahn echo sequence, the filter function is a piecewise constant function:\n$$\ny(t) = \\begin{cases} +1 & \\text{for } 0 \\le t < T/2 \\\\ -1 & \\text{for } T/2 \\le t \\le T \\end{cases}\n$$\n\nCalculate the coherence decay exponent $\\chi(T)$ for the qubit. Express your answer as a function of the total time $T$, the noise amplitude $\\alpha$, and the correlation time $\\tau_c$.", "solution": "The coherence decay exponent is given by:\n\n$$\n\\chi(T) = \\frac{1}{2} \\int_0^T \\int_0^T y(t_1) y(t_2) \\langle \\beta(t_1) \\beta(t_2) \\rangle  dt_1  dt_2\n$$\n\nwhere $\\langle \\beta(t_1) \\beta(t_2) \\rangle = \\alpha^2 \\exp\\left(-\\frac{|t_1 - t_2|}{\\tau_c}\\right)$ and the filter function $y(t)$ for the Hahn echo sequence is:\n\n$$\ny(t) = \\begin{cases} \n+1 & 0 \\leq t < T/2 \\\\\n-1 & T/2 \\leq t \\leq T \n\\end{cases}\n$$\n\nDue to the piecewise nature of $y(t)$, the integral is split into four regions:\n- Region 1: $0 \\leq t_1 < T/2$, $0 \\leq t_2 < T/2$ → $y(t_1)y(t_2) = 1$\n- Region 2: $0 \\leq t_1 < T/2$, $T/2 \\leq t_2 \\leq T$ → $y(t_1)y(t_2) = -1$\n- Region 3: $T/2 \\leq t_1 \\leq T$, $0 \\leq t_2 < T/2$ → $y(t_1)y(t_2) = -1$\n- Region 4: $T/2 \\leq t_1 \\leq T$, $T/2 \\leq t_2 \\leq T$ → $y(t_1)y(t_2) = 1$\n\nThe double integral becomes:\n\n$$\n\\int_0^T \\int_0^T y(t_1)y(t_2) \\exp\\left(-\\frac{|t_1 - t_2|}{\\tau_c}\\right)  dt_1  dt_2 = \\int_0^{T/2} \\int_0^{T/2} \\dots + \\int_{T/2}^T \\int_{T/2}^T \\dots - \\int_0^{T/2} \\int_{T/2}^T \\dots - \\int_{T/2}^T \\int_0^{T/2} \\dots\n$$\n\nThe first two integrals are identical and denoted as $I_1$, and the last two are identical and denoted as $I_3$. Thus, the total integral is $2I_1 - 2I_3$.\n\nA known result for the integral of the OU correlation function over a square domain $[0, \\mathcal{T}] \\times [0, \\mathcal{T}]$ is:\n$$I(\\mathcal{T}) = \\int_0^{\\mathcal{T}} \\int_0^{\\mathcal{T}} \\exp\\left(-\\frac{|t_1 - t_2|}{\\tau_c}\\right) dt_1 dt_2 = 2\\tau_c \\left(\\mathcal{T} - \\tau_c\\left(1 - e^{-\\mathcal{T}/\\tau_c}\\right)\\right)$$\nSo, $I_1 = I(T/2) = 2\\tau_c \\left(\\frac{T}{2} - \\tau_c\\left(1 - e^{-T/2\\tau_c}\\right)\\right) = \\tau_c T - 2\\tau_c^2\\left(1 - e^{-T/2\\tau_c}\\right)$.\n\nFor $I_3$, since $t_1 \\in [0, T/2)$ and $t_2 \\in [T/2, T]$, we have $t_2 > t_1$, so $|t_1 - t_2| = t_2 - t_1$.\n$$\nI_3 = \\int_0^{T/2} \\int_{T/2}^T \\exp\\left(-\\frac{t_2 - t_1}{\\tau_c}\\right) dt_2 dt_1\n$$\nIntegrating over $t_2$ first:\n$$\nI_3 = \\int_0^{T/2} e^{t_1/\\tau_c} \\left[ -\\tau_c e^{-t_2/\\tau_c} \\right]_{T/2}^T dt_1 = \\tau_c \\int_0^{T/2} e^{t_1/\\tau_c} \\left(e^{-T/2\\tau_c} - e^{-T/\\tau_c}\\right) dt_1\n$$\nIntegrating over $t_1$:\n$$\nI_3 = \\tau_c \\left(e^{-T/2\\tau_c} - e^{-T/\\tau_c}\\right) \\left[ \\tau_c e^{t_1/\\tau_c} \\right]_0^{T/2} = \\tau_c^2 \\left(e^{-T/2\\tau_c} - e^{-T/\\tau_c}\\right) \\left(e^{T/2\\tau_c} - 1\\right)\n$$\n$$\nI_3 = \\tau_c^2 \\left(1 - e^{-T/2\\tau_c} - e^{-T/2\\tau_c} + e^{-T/\\tau_c}\\right) = \\tau_c^2 \\left(1 - 2e^{-T/2\\tau_c} + e^{-T/\\tau_c}\\right) = \\tau_c^2 \\left(1 - e^{-T/2\\tau_c}\\right)^2\n$$\n\nNow combine:\n$$\n2I_1 - 2I_3 = 2\\left[\\tau_c T - 2\\tau_c^2\\left(1 - e^{-T/2\\tau_c}\\right)\\right] - 2\\tau_c^2\\left(1 - 2e^{-T/2\\tau_c} + e^{-T/\\tau_c}\\right)\n$$\n$$\n= 2\\tau_c T - 4\\tau_c^2 + 4\\tau_c^2 e^{-T/2\\tau_c} - 2\\tau_c^2 + 4\\tau_c^2 e^{-T/2\\tau_c} - 2\\tau_c^2 e^{-T/\\tau_c}\n$$\n$$\n= 2\\tau_c T - 6\\tau_c^2 + 8\\tau_c^2 e^{-T/2\\tau_c} - 2\\tau_c^2 e^{-T/\\tau_c}\n$$\n\nFinally, we find $\\chi(T)$:\n$$\n\\chi(T) = \\frac{\\alpha^2}{2} \\left( 2\\tau_c T - 6\\tau_c^2 + 8\\tau_c^2 e^{-T/2\\tau_c} - 2\\tau_c^2 e^{-T/\\tau_c} \\right)\n$$\n$$\n= \\alpha^2 \\tau_c^2 \\left( \\frac{T}{\\tau_c} - 3 + 4 \\exp\\left(-\\frac{T}{2\\tau_c}\\right) - \\exp\\left(-\\frac{T}{\\tau_c}\\right) \\right)\n$$", "answer": "$$\n\\boxed{\\alpha^{2} \\tau_{c}^{2} \\left( \\frac{T}{\\tau_{c}} - 3 + 4 \\exp\\left(-\\frac{T}{2\\tau_{c}}\\right) - \\exp\\left(-\\frac{T}{\\tau_{c}}\\right) \\right)}\n$$", "id": "71262"}, {"introduction": "Dynamical decoupling can be used not only to suppress unwanted interactions but also to engineer entirely new effective Hamiltonians. This is achieved by viewing the system's evolution in a \"toggling frame\" that rotates with the control pulses and averaging the transformed Hamiltonian over a full cycle, a technique known as Average Hamiltonian Theory (AHT). This exercise [@problem_id:71366] provides a classic example of Hamiltonian engineering, where a staggered spin echo sequence transforms an isotropic Heisenberg interaction into a purely anisotropic form. By calculating the zeroth-order average Hamiltonian, you will see how precise temporal control can fundamentally alter the intrinsic dynamics of a quantum system.", "problem": "Dynamical decoupling sequences are a powerful tool in quantum control, used to mitigate the effects of unwanted interactions or environmental noise. By applying a series of rapid control pulses, the time-averaged Hamiltonian of a system can be engineered to have a desired form. The resulting dynamics over one cycle of the pulse sequence can be described by an effective Hamiltonian, which, to the lowest order in Average Hamiltonian Theory (AHT), is given by the time-average of the interaction Hamiltonian in a reference frame that rotates with the control pulses (the \"toggling frame\").\n\nConsider a system of two qubits whose interaction is described by the isotropic Heisenberg Hamiltonian:\n$$ H_{int} = J (\\sigma_x^{(1)}\\sigma_x^{(2)} + \\sigma_y^{(1)}\\sigma_y^{(2)} + \\sigma_z^{(1)}\\sigma_z^{(2)}) $$\nwhere $J$ is a real coupling constant, and $\\sigma_k^{(i)}$ is the Pauli-$k$ operator acting on qubit $i \\in \\{1, 2\\}$.\n\nTo manipulate this interaction, we apply a \"staggered\" spin echo sequence over a total period $T$. The sequence consists of three instantaneous, ideal $\\pi_y$ pulses. A $\\pi_y$ pulse on qubit $i$ is described by the unitary operator $P_y^{(i)} = \\exp(-i\\frac{\\pi}{2}\\sigma_y^{(i)})$. The pulses are applied at the following times:\n1.  At $t_1 = T/4$, a pulse $P_y^{(1)}$ is applied to qubit 1.\n2.  At $t_2 = T/2$, a pulse $P_y^{(1)} \\otimes P_y^{(2)}$ is applied to both qubits simultaneously.\n3.  At $t_3 = 3T/4$, a pulse $P_y^{(2)}$ is applied to qubit 2.\n\nBetween these pulses, the system evolves freely under the Hamiltonian $H_{int}$. Calculate the effective Hamiltonian, $H_{eff}$, that describes the system's evolution over one full cycle using the leading (zeroth) order of Average Hamiltonian Theory.", "solution": "The problem asks for the effective Hamiltonian of a two-qubit system under a specific dynamical decoupling sequence, using zeroth-order Average Hamiltonian Theory (AHT).\n\nThe effective Hamiltonian to zeroth order is given by the average of the interaction Hamiltonian in the toggling frame over one cycle period $T$:\n$$ H_{eff} = \\frac{1}{T} \\int_0^T H_{tog}(t) dt $$\nwhere $H_{tog}(t) = U_{ctrl}^\\dagger(t) H_{int} U_{ctrl}(t)$. The control propagator $U_{ctrl}(t)$ is the accumulated operator of the pulses up to time $t$.\n\nThe pulse operator for a $\\pi_y$ rotation is $P_y = \\exp(-i\\frac{\\pi}{2}\\sigma_y) = -i\\sigma_y$. The action of this pulse on the Pauli operators is:\n$P_y^\\dagger \\sigma_x P_y = -\\sigma_x$\n$P_y^\\dagger \\sigma_y P_y = \\sigma_y$\n$P_y^\\dagger \\sigma_z P_y = -\\sigma_z$\nSo, a $\\pi_y$ pulse flips the sign of $\\sigma_x$ and $\\sigma_z$, while leaving $\\sigma_y$ unchanged.\n\nLet's determine $U_{ctrl}(t)$ and $H_{tog}(t)$ for each of the four intervals of duration $T/4$:\n**Interval 1: $t \\in [0, T/4)$**\n$U_{ctrl}(t) = I$.\n$H_{tog,1} = H_{int} = J (\\sigma_x^{(1)}\\sigma_x^{(2)} + \\sigma_y^{(1)}\\sigma_y^{(2)} + \\sigma_z^{(1)}\\sigma_z^{(2)})$.\n\n**Interval 2: $t \\in [T/4, T/2)$**\n$U_{ctrl}(t) = P_y^{(1)}$.\n$H_{tog,2} = (P_y^{(1)})^\\dagger H_{int} P_y^{(1)} = J (-\\sigma_x^{(1)}\\sigma_x^{(2)} + \\sigma_y^{(1)}\\sigma_y^{(2)} - \\sigma_z^{(1)}\\sigma_z^{(2)})$.\n\n**Interval 3: $t \\in [T/2, 3T/4)$**\n$U_{ctrl}(t) = (P_y^{(1)}P_y^{(2)}) P_y^{(1)} = P_y^{(2)}(P_y^{(1)})^2 = -P_y^{(2)}$. The global phase does not affect the Hamiltonian transformation.\n$H_{tog,3} = (P_y^{(2)})^\\dagger H_{int} P_y^{(2)} = J (-\\sigma_x^{(1)}\\sigma_x^{(2)} + \\sigma_y^{(1)}\\sigma_y^{(2)} - \\sigma_z^{(1)}\\sigma_z^{(2)})$.\n\n**Interval 4: $t \\in [3T/4, T)$**\n$U_{ctrl}(t) = P_y^{(2)} U_{ctrl}(T/2) = P_y^{(2)}(-P_y^{(2)}) = -(-I) = I$.\n$H_{tog,4} = H_{int} = J (\\sigma_x^{(1)}\\sigma_x^{(2)} + \\sigma_y^{(1)}\\sigma_y^{(2)} + \\sigma_z^{(1)}\\sigma_z^{(2)})$.\n\nNow we can compute the average Hamiltonian. Since each $H_{tog,k}$ is constant over an interval of duration $T/4$, the integral becomes a sum:\n$$ H_{eff} = \\frac{1}{T} \\sum_{k=1}^4 H_{tog,k} \\frac{T}{4} = \\frac{1}{4} (H_{tog,1} + H_{tog,2} + H_{tog,3} + H_{tog,4}) $$\nSumming the coefficients for each term:\n- $\\sigma_x^{(1)}\\sigma_x^{(2)}$ term: $J(1 - 1 - 1 + 1) = 0$\n- $\\sigma_y^{(1)}\\sigma_y^{(2)}$ term: $J(1 + 1 + 1 + 1) = 4J$\n- $\\sigma_z^{(1)}\\sigma_z^{(2)}$ term: $J(1 - 1 - 1 + 1) = 0$\n\nThe sum of the Hamiltonians is $4J\\sigma_y^{(1)}\\sigma_y^{(2)}$.\nFinally, we find the effective Hamiltonian:\n$$ H_{eff} = \\frac{1}{4} (4J\\sigma_y^{(1)}\\sigma_y^{(2)}) = J\\sigma_y^{(1)}\\sigma_y^{(2)} $$\nIt is worth noting that for the Heisenberg interaction, the three components $H_x, H_y, H_z$ all commute with each other. This implies that the toggling-frame Hamiltonians at different times, $H_{tog}(t_1)$ and $H_{tog}(t_2)$, also commute. As a result, all higher-order correction terms in the Magnus expansion for $H_{eff}$ are zero, and the zeroth-order result is exact.", "answer": "$$ \\boxed{J \\sigma_y^{(1)} \\sigma_y^{(2)}} $$", "id": "71366"}]}