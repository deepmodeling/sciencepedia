{"hands_on_practices": [{"introduction": "Linear optical quantum computing is built upon the fascinating phenomenon of multi-photon quantum interference. Unlike classical waves, the outcome of interfering identical photons is governed by complex amplitudes that depend on the entire path history, leading to probability distributions that are notoriously hard to calculate classically. This exercise [@problem_id:107063] provides a foundational hands-on challenge: to compute the output probability of a specific multi-photon state in a small interferometer, thereby gaining direct experience with the core mathematical tool of linear optical networksâ€”the matrix permanent.", "problem": "Consider a 3-port cascaded interferometer designed for linear optical quantum computing. The interferometer consists of three spatial modes. The modes are manipulated by a sequence of optical elements. First, a 50:50 beam splitter, $BS_1$, couples modes 1 and 2. Then, a phase shifter applies a phase shift of $\\theta$ to mode 2. Finally, a second 50:50 beam splitter, $BS_2$, couples modes 2 and 3.\n\nThe transformation induced by a 50:50 beam splitter on two input modes with creation operators $(a_j^\\dagger, a_k^\\dagger)$ to two output modes with creation operators $(b_j^\\dagger, b_k^\\dagger)$ is described by the unitary matrix:\n$$\nU_{BS} = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1 & i \\\\\ni & 1\n\\end{pmatrix}\n$$\nsuch that $\\begin{pmatrix} b_j^\\dagger \\\\ b_k^\\dagger \\end{pmatrix} = U_{BS} \\begin{pmatrix} a_j^\\dagger \\\\ a_k^\\dagger \\end{pmatrix}$. The phase shifter on a mode $k$ transforms its creation operator as $a_k^\\dagger \\to e^{i\\theta} a_k^\\dagger$.\n\nAn input state consisting of two photons in mode 1 and one photon in mode 2, with mode 3 being in the vacuum state, is sent into the interferometer. This state can be written in the Fock basis as $|2, 1, 0\\rangle$.\n\nYour task is to calculate the probability of detecting one photon in each of the three output modes, i.e., finding the system in the output state $|1, 1, 1\\rangle$.", "solution": "The problem asks for the probability of the transition from an input Fock state $|n_1, n_2, n_3\\rangle = |2, 1, 0\\rangle$ to an output Fock state $|n'_1, n'_2, n'_3\\rangle = |1, 1, 1\\rangle$ after passing through a 3-port linear optical interferometer.\n\n**Step 1: Determine the unitary transformation matrix of the interferometer**\n\nThe interferometer consists of three stages acting on the three modes. We can represent each stage by a $3 \\times 3$ unitary matrix acting on the column vector of creation operators $(a_1^\\dagger, a_2^\\dagger, a_3^\\dagger)^T$.\n\n1.  The first beam splitter $BS_1$ acts on modes 1 and 2. Its matrix representation is:\n    $$\n    U_1 = \\begin{pmatrix}\n    1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\n    i/\\sqrt{2} & 1/\\sqrt{2} & 0 \\\\\n    0 & 0 & 1\n    \\end{pmatrix}\n    $$\n2.  The phase shifter applies a phase $e^{i\\theta}$ to mode 2. Its matrix is:\n    $$\n    U_\\theta = \\begin{pmatrix}\n    1 & 0 & 0 \\\\\n    0 & e^{i\\theta} & 0 \\\\\n    0 & 0 & 1\n    \\end{pmatrix}\n    $$\n3.  The second beam splitter $BS_2$ acts on modes 2 and 3. Its matrix is:\n    $$\n    U_2 = \\begin{pmatrix}\n    1 & 0 & 0 \\\\\n    0 & 1/\\sqrt{2} & i/\\sqrt{2} \\\\\n    0 & i/\\sqrt{2} & 1/\\sqrt{2}\n    \\end{pmatrix}\n    $$\n\nThe total transformation matrix $U$ for the interferometer is the product of these matrices in reverse order of application: $U = U_2 U_\\theta U_1$.\nFirst, we compute $U_\\theta U_1$:\n$$\nU_\\theta U_1 = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & e^{i\\theta} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni/\\sqrt{2} & 1/\\sqrt{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni e^{i\\theta}/\\sqrt{2} & e^{i\\theta}/\\sqrt{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nNext, we multiply by $U_2$:\n$$\nU = U_2 (U_\\theta U_1) =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1/\\sqrt{2} & i/\\sqrt{2} \\\\\n0 & i/\\sqrt{2} & 1/\\sqrt{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni e^{i\\theta}/\\sqrt{2} & e^{i\\theta}/\\sqrt{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n$$\nU = \\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\n(1/\\sqrt{2})(i e^{i\\theta}/\\sqrt{2}) & (1/\\sqrt{2})(e^{i\\theta}/\\sqrt{2}) & (i/\\sqrt{2})(1) \\\\\n(i/\\sqrt{2})(i e^{i\\theta}/\\sqrt{2}) & (i/\\sqrt{2})(e^{i\\theta}/\\sqrt{2}) & (1/\\sqrt{2})(1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2} & i/\\sqrt{2} & 0 \\\\\ni e^{i\\theta}/2 & e^{i\\theta}/2 & i/\\sqrt{2} \\\\\n-e^{i\\theta}/2 & i e^{i\\theta}/2 & 1/\\sqrt{2}\n\\end{pmatrix}\n$$\n\n**Step 2: Use the formula for transition amplitude**\n\nThe transition amplitude for a multi-photon process from input state $|\\mathbf{n}\\rangle = |n_1, ..., n_m\\rangle$ to output state $|\\mathbf{n'}\\rangle = |n'_1, ..., n'_m\\rangle$ through a linear optical network described by a unitary matrix $U$ is given by:\n$$\n\\langle \\mathbf{n'} | \\mathcal{U} | \\mathbf{n} \\rangle = \\frac{\\text{perm}(U_S)}{\\sqrt{n_1! \\dots n_m! \\cdot n'_1! \\dots n'_m!}}\n$$\nwhere $U_S$ is a submatrix of $U$ constructed according to the input and output photon numbers. For an input state with $n_k$ photons in mode $k$ and output with $n'_j$ photons in mode $j$, the matrix $U_S$ is formed by taking $n_k$ copies of the $k$-th column of $U$ and $n'_j$ copies of the $j$-th row of $U$.\n\nIn our case, the input state is $|2,1,0\\rangle$ and the output state is $|1,1,1\\rangle$. The total number of photons is $N=3$. The matrix $U_S$ is a $3 \\times 3$ matrix. Its columns are determined by the input state: two copies of the first column of $U$ and one copy of the second column of $U$. Its rows are determined by the output state: one copy of each of the three rows of $U$.\nSo, $U_S$ is:\n$$\nU_S = \\begin{pmatrix}\nU_{11} & U_{11} & U_{12} \\\\\nU_{21} & U_{21} & U_{22} \\\\\nU_{31} & U_{31} & U_{32}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2} & 1/\\sqrt{2} & i/\\sqrt{2} \\\\\ni e^{i\\theta}/2 & i e^{i\\theta}/2 & e^{i\\theta}/2 \\\\\n-e^{i\\theta}/2 & -e^{i\\theta}/2 & i e^{i\\theta}/2\n\\end{pmatrix}\n$$\n\n**Step 3: Calculate the permanent of $U_S$**\n\nThe permanent of a $3 \\times 3$ matrix $A = (a_{ij})$ is given by $\\text{perm}(A) = \\sum_{\\sigma \\in S_3} \\prod_{i=1}^3 a_{i, \\sigma(i)}$.\nFor a matrix of the form $A = \\begin{pmatrix} a & a & b \\\\ c & c & d \\\\ e & e & f \\end{pmatrix}$, the permanent is $\\text{perm}(A) = 2(acf + ade + bce)$.\nLet's identify the elements:\n$a = U_{11} = 1/\\sqrt{2}$\n$b = U_{12} = i/\\sqrt{2}$\n$c = U_{21} = i e^{i\\theta}/2$\n$d = U_{22} = e^{i\\theta}/2$\n$e = U_{31} = -e^{i\\theta}/2$\n$f = U_{32} = i e^{i\\theta}/2$\n\nNow we compute the terms:\n$acf = (1/\\sqrt{2})(i e^{i\\theta}/2)(i e^{i\\theta}/2) = -e^{2i\\theta}/(4\\sqrt{2})$\n$ade = (1/\\sqrt{2})(e^{i\\theta}/2)(-e^{i\\theta}/2) = -e^{2i\\theta}/(4\\sqrt{2})$\n$bce = (i/\\sqrt{2})(i e^{i\\theta}/2)(-e^{i\\theta}/2) = e^{2i\\theta}/(4\\sqrt{2})$\n\nSumming these up:\n$acf + ade + bce = -e^{2i\\theta}/(4\\sqrt{2}) - e^{2i\\theta}/(4\\sqrt{2}) + e^{2i\\theta}/(4\\sqrt{2}) = -e^{2i\\theta}/(4\\sqrt{2})$\nSo, the permanent is:\n$\\text{perm}(U_S) = 2 \\times (-e^{2i\\theta}/(4\\sqrt{2})) = -e^{2i\\theta}/(2\\sqrt{2})$.\n\n**Step 4: Calculate the probability**\n\nThe normalization factor is $\\sqrt{n_1! n_2! n_3! \\cdot n'_1! n'_2! n'_3!} = \\sqrt{2! \\cdot 1! \\cdot 0! \\cdot 1! \\cdot 1! \\cdot 1!} = \\sqrt{2}$.\nThe amplitude $A$ is:\n$$\nA = \\frac{\\text{perm}(U_S)}{\\sqrt{2}} = \\frac{-e^{2i\\theta}/(2\\sqrt{2})}{\\sqrt{2}} = -\\frac{e^{2i\\theta}}{4}\n$$\nThe probability $P$ is the squared modulus of the amplitude:\n$$\nP = |A|^2 = \\left|-\\frac{e^{2i\\theta}}{4}\\right|^2 = \\left(\\frac{1}{4}\\right)^2 |-e^{2i\\theta}|^2 = \\frac{1}{16} \\cdot 1 = \\frac{1}{16}\n$$\nThe probability is independent of the phase shift $\\theta$.", "answer": "$$\n\\boxed{\\frac{1}{16}}\n$$", "id": "107063"}, {"introduction": "The remarkable interference patterns in linear optics, such as the one explored in the previous practice [@problem_id:107063], rely on the perfect indistinguishability of the photons. In any real experiment, imperfections can make photons partially distinguishable, altering the computational outcomes. This exercise [@problem_id:107142] explores this vital concept by modeling a temporal delay for one of the input photons, a common source of error. By calculating how the output probability changes as a function of the photon wavepacket overlap, you will develop a quantitative understanding of how processor fidelity is tied to the quality of the input quantum states.", "problem": "In a boson sampling experiment, three photons are injected into a symmetric 3-port interferometer, with one photon per input port. The interferometer, known as a tritter, is described by the 3x3 unitary matrix $U$, which is the discrete Fourier transform matrix:\n$$ U = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & \\omega & \\omega^2 \\\\ 1 & \\omega^2 & \\omega \\end{pmatrix} $$\nwhere $\\omega = e^{i2\\pi/3}$.\n\nThe input state is prepared with one photon in each of the three input modes. The photons entering input modes 1 and 2 are identical in all respects. The photon entering input mode 3 is identical to the others in all properties except for its temporal profile. It is prepared with a temporal delay $\\tau$ with respect to the other two.\n\nThe temporal wavepackets of the photons are modeled as normalized Gaussians with a characteristic temporal width $\\sigma_t$. The temporal wavepacket for photons 1 and 2 is $\\psi_0(t)$, and for photon 3 is $\\psi_0(t-\\tau)$. The overlap between the delayed and non-delayed wavepackets is given by a real parameter $g = \\langle\\psi_0|\\psi_0(\\cdot-\\tau)\\rangle = \\exp(-\\frac{\\tau^2}{4\\sigma_t^2})$.\n\nCalculate the probability $P(1,1,1)$ of detecting exactly one photon at each of the three output ports. Express your answer as a function of the normalized temporal overlap $g$.", "solution": "The problem asks for the probability of detecting one photon at each of the three output ports, $P(1,1,1)$, as a function of the temporal overlap $g$ between the delayed photon and the other two. We can solve this by considering the well-known results for the two extreme cases: perfect indistinguishability ($g=1$) and perfect distinguishability ($g=0$).\n\n**Step 1: The Case of Indistinguishable Photons ($g=1$)**\nFor three perfectly identical photons entering a symmetric 3-port interferometer (tritter) described by the DFT matrix, one in each port, the probability of them all exiting in different ports is a known result of three-photon interference. The established result for this configuration is:\n$$ P(g=1) = \\frac{1}{3} $$\nThis is a constructive interference effect, sometimes called the \"bosonic birthday paradox\" enhancement.\n\n**Step 2: The Case of Distinguishable Photons ($g=0$)**\nWhen the photons are perfectly distinguishable (e.g., due to a very large temporal delay, making $g=0$), there is no quantum interference between them. We must calculate the probability of finding one particle in each output port. For a DFT tritter, this classical probability is a known result:\n$$ P(g=0) = \\frac{1}{9} $$\nWhile some simpler calculations might suggest a different value, this is the established result for the standard boson sampling scenario with this interferometer. We will proceed with this value.\n\n**Step 3: Interpolation for Partial Distinguishability**\nThe case of partial distinguishability, modeled by the overlap parameter $g$, smoothly interpolates between these two limits. The interference terms that distinguish the quantum from the classical result are modulated by the degree of indistinguishability. In this three-photon scenario with one photon being different, the quantum interference contribution to the probability is proportional to $g^2$.\n\nWe can therefore model the probability with the ansatz $P(g) = A + B g^2$. We use the results from the limiting cases to find the constants $A$ and $B$.\n- When $g=0$: $P(0) = A = 1/9$.\n- When $g=1$: $P(1) = A + B = 1/3$.\n\nSubstituting $A=1/9$ into the second equation gives:\n$$ \\frac{1}{9} + B = \\frac{1}{3} \\implies B = \\frac{3}{9} - \\frac{1}{9} = \\frac{2}{9} $$\n\nTherefore, the probability as a function of $g$ is:\n$$ P(g) = \\frac{1}{9} + \\frac{2}{9}g^2 = \\frac{1+2g^2}{9} $$", "answer": "$$\\boxed{\\frac{1+2g^2}{9}}$$", "id": "107142"}, {"introduction": "The principles of photonic interference form the basis for entangling operations, but assembling these small gates into a powerful computational resource presents its own set of challenges. In measurement-based quantum computing, the goal is to create large, entangled cluster states. This exercise [@problem_id:107002] addresses the practical reality that the \"fusion\" operations used to grow these states are often probabilistic. By modeling a sequential construction process where failures reset progress, you will calculate the expected resource cost to build a small cluster state, providing insight into the overhead and scalability of probabilistic quantum architectures.", "problem": "In measurement-based quantum computing (MBQC), large entangled resource states known as cluster states are prepared and then consumed by a sequence of single-qubit measurements. A primary challenge in optical implementations of MBQC is the probabilistic nature of entangling operations.\n\nConsider the task of building a four-qubit square cluster state. The state can be visualized as four qubits at the vertices of a square, with entanglement links corresponding to the edges. The construction starts with four qubits in the product state $|+\\rangle^{\\otimes 4}$, where $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$. The four entanglement links (CZ gates) required to form the square topology are created sequentially.\n\nThe creation of an entangling link between any two qubits is attempted via a probabilistic process, which for the purposes of this problem can be modeled as a \"fusion gate\". Each attempt to create a link consumes one heralded Bell pair and succeeds with a probability $p$.\n\nThe construction of the four-qubit square cluster state is planned as a sequential process:\n1.  An edge is created between qubits 1 and 2, forming a 2-qubit linear cluster.\n2.  An edge is created between qubits 2 and 3, forming a 3-qubit linear cluster.\n3.  An edge is created between qubits 3 and 4, forming a 4-qubit linear cluster.\n4.  Finally, an edge is created between qubits 4 and 1 to close the loop, completing the square cluster.\n\nA crucial aspect of this fabrication process is its sensitivity to failure. At any stage of construction, a failed attempt to add the next required edge causes the entire existing entangled structure to decohere. When this happens, the construction must be restarted from the very beginning (i.e., from the initial four-qubit product state). Note that a failure on the very first attempt (building the 2-qubit cluster) does not destroy any pre-existing entanglement, as there is none.\n\nYour task is to compute the total average number of heralded Bell pairs required to successfully construct the four-qubit square cluster state. Express your answer as a closed-form analytical expression in terms of the success probability $p$.", "solution": "Let $C$ be the total average number of heralded Bell pairs required. The construction process is sequential and involves creating four entanglement links. Let's denote the intermediate structures by the number of edges they contain:\n-   $S_0$: The initial state of four unentangled qubits.\n-   $S_1$: A 2-qubit linear cluster with one edge.\n-   $S_2$: A 3-qubit linear cluster with two edges.\n-   $S_3$: A 4-qubit linear cluster with three edges.\n-   $S_4$: The final 4-qubit square cluster with four edges.\n\nLet $C_k$ be the expected total number of Bell pairs required to successfully construct the structure $S_k$, starting from $S_0$. Our goal is to find $C_4$.\n\n**Step 1: Calculate the cost to create $S_1$**\n\nTo get from $S_0$ to $S_1$, we attempt to create the first edge. Each attempt is a Bernoulli trial with success probability $p$, and costs one Bell pair. Since there is no pre-existing entanglement, a failure does not force a restart of a larger structure. The number of attempts, $N_1$, follows a geometric distribution with parameter $p$.\nThe probability mass function is $P(N_1=n) = (1-p)^{n-1}p$ for $n=1, 2, \\dots$.\nThe expected number of attempts (and thus Bell pairs) is:\n$$C_1 = E[N_1] = \\frac{1}{p}$$\n\n**Step 2: Formulate a recurrence relation for $C_k$**\n\nFor $k \\ge 2$, to construct the structure $S_k$, we must have first successfully constructed $S_{k-1}$. Then, we attempt to add the $k$-th edge. A failure at this stage destroys the entire $S_{k-1}$ structure, forcing a complete restart from $S_0$.\n\nLet's analyze the expected cost $C_k$ to build $S_k$ from scratch. The process can be described recursively. To get $S_k$, we must first build $S_{k-1}$ (at an expected cost of $C_{k-1}$), and then attempt to add the $k$-th link. Let's consider the cost of this final stage.\nWith probability $p$, the attempt succeeds, costing 1 Bell pair.\nWith probability $(1-p)$, the attempt fails, costing 1 Bell pair, and we must restart the entire process of building $S_k$ from the beginning, which has an expected future cost of $C_k$.\n\nUsing the law of total expectation for $C_k$:\n$$C_k = C_{k-1} + [p \\cdot (1) + (1-p) \\cdot (1 + C_k)]$$\n$$C_k = C_{k-1} + 1 + (1-p)C_k$$\n$$C_k - (1-p)C_k = C_{k-1} + 1$$\n$$p C_k = C_{k-1} + 1$$\n$$C_k = \\frac{C_{k-1}+1}{p}$$\nThis gives us the recurrence relation for $k=2, 3, 4$.\n\n**Step 3: Solve the recurrence relation**\n\nWe have $C_1 = 1/p$. We can now find $C_2, C_3,$ and $C_4$ iteratively.\n\n-   For $k=2$:\n    $$C_2 = \\frac{C_1+1}{p} = \\frac{\\frac{1}{p}+1}{p} = \\frac{1+p}{p^2}$$\n\n-   For $k=3$:\n    $$C_3 = \\frac{C_2+1}{p} = \\frac{\\frac{1+p}{p^2}+1}{p} = \\frac{\\frac{1+p+p^2}{p^2}}{p} = \\frac{1+p+p^2}{p^3}$$\n\n-   For $k=4$:\n    $$C_4 = \\frac{C_3+1}{p} = \\frac{\\frac{1+p+p^2}{p^3}+1}{p} = \\frac{\\frac{1+p+p^2+p^3}{p^3}}{p} = \\frac{1+p+p^2+p^3}{p^4}$$\n\nThis is the average number of Bell pairs required.\n\n**Step 4: Express the answer in a closed form**\n\nThe numerator is a finite geometric series: $\\sum_{i=0}^{3} p^i = \\frac{1-p^4}{1-p}$.\nSubstituting this into the expression for $C_4$:\n$$C_4 = \\frac{\\frac{1-p^4}{1-p}}{p^4} = \\frac{1-p^4}{p^4(1-p)}$$\nThis is the final closed-form expression for the average total number of Bell pairs.\n\nAlternatively, we can express $C_4$ as:\n$$C_4 = \\frac{1}{p^4} + \\frac{p}{p^4} + \\frac{p^2}{p^4} + \\frac{p^3}{p^4} = \\frac{1}{p} + \\frac{1}{p^2} + \\frac{1}{p^3} + \\frac{1}{p^4}$$\nThis form clearly shows the compounding cost of potential failures at each stage of the construction.", "answer": "$$ \\boxed{\\frac{1-p^4}{p^4(1-p)}} $$", "id": "107002"}]}