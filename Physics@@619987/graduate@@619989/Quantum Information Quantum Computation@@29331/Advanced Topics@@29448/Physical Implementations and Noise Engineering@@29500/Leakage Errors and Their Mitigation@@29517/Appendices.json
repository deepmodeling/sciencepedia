{"hands_on_practices": [{"introduction": "Understanding leakage begins with quantifying its impact on fundamental quantum operations. This first exercise explores a common scenario: preparing an entangled Bell state, a building block for many quantum algorithms, using a faulty CNOT gate. By calculating the fidelity of the final state, you will gain a concrete sense of how leakage from a single gate corrupts a pristine quantum state.[@problem_id:96482]", "problem": "In many quantum computing architectures, qubits are implemented using the two lowest energy levels of a multi-level quantum system (e.g., a transmon or a quantum dot). An unwanted transition to a higher energy level is known as a leakage error. This problem explores the impact of such an error during the preparation of an entangled state.\n\nConsider a system of two qutrits, whose states are denoted by $|ij\\rangle$ where $i, j \\in \\{0, 1, 2\\}$. The computational subspace, which serves as our two-qubit space, is spanned by the basis states $\\{|ij\\rangle | i,j \\in \\{0,1\\}\\}$. The states $|i2\\rangle$ and $|2j\\rangle$ for $i,j \\in \\{0,1,2\\}$ are considered leakage states.\n\nWe aim to prepare the Bell state $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$ using the following standard quantum circuit, starting from the initial state $|\\psi_0\\rangle = |00\\rangle$:\n1.  Apply an ideal Hadamard gate $H$ on the first qutrit (acting as a qubit).\n2.  Apply a CNOT gate with the first qutrit as the control and the second as the target.\n\nThe Hadamard gate is assumed to be ideal and acts only within the computational subspace of the first qutrit. The CNOT gate, however, is faulty and can induce leakage. Let's denote this leaky CNOT gate by $\\tilde{U}_{CNOT}$. Its action is defined as follows:\n-   If the control (first) qutrit is in state $|0\\rangle$, the gate acts as the identity on the target qutrit's computational states: $\\tilde{U}_{CNOT}|0j\\rangle = |0j\\rangle$ for $j \\in \\{0,1\\}$.\n-   The non-trivial action occurs when the control qutrit is in state $|1\\rangle$. Specifically, when acting on the state $|10\\rangle$, where the target qutrit state should be flipped from $|0\\rangle$ to $|1\\rangle$, a leakage error occurs with probability $p$. The gate action is described by:\n    $$\n    \\tilde{U}_{CNOT}|10\\rangle = \\sqrt{1-p} |11\\rangle + \\sqrt{p} |12\\rangle\n    $$\n    where $p$ is a real parameter with $0 \\le p \\le 1$. For the purpose of this problem, the action of $\\tilde{U}_{CNOT}$ on other basis states is not required.\n\nCalculate the fidelity $F$ between the final state $|\\psi_f\\rangle$ generated by this leaky circuit and the ideal target Bell state $|\\Phi^+\\rangle$. The fidelity between two pure states $|\\psi\\rangle$ and $|\\phi\\rangle$ is defined as $F=|\\langle\\psi|\\phi\\rangle|$. The ideal state $|\\Phi^+\\rangle$ should be treated as a vector in the full two-qutrit Hilbert space, having zero amplitude in any of the leakage levels.", "solution": "The initial state is $|\\psi_0\\rangle = |00\\rangle$.\n\n**Step 1: Apply the ideal Hadamard gate on the first qutrit.**  \nThe Hadamard gate acts on the first qutrit within the computational subspace $\\{ |0\\rangle, |1\\rangle \\}$:  \n\n$$\nH|0\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle + |1\\rangle), \\quad H|1\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle - |1\\rangle).\n$$\n  \nSince the second qutrit is unaffected, the state after applying $H \\otimes I$ is:  \n\n$$\n|\\psi_1\\rangle = (H \\otimes I) |00\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle + |1\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}} (|00\\rangle + |10\\rangle).\n$$\n\n\n**Step 2: Apply the leaky CNOT gate $\\tilde{U}_{\\text{CNOT}}$.**  \nThe leaky CNOT gate acts as follows:  \n- When the control (first qutrit) is $|0\\rangle$, it acts as identity on the target's computational states: $\\tilde{U}_{\\text{CNOT}} |0j\\rangle = |0j\\rangle$ for $j \\in \\{0,1\\}$.  \n- When the control is $|1\\rangle$ and the target is $|0\\rangle$: $\\tilde{U}_{\\text{CNOT}} |10\\rangle = \\sqrt{1-p} |11\\rangle + \\sqrt{p} |12\\rangle$.  \n\nApply $\\tilde{U}_{\\text{CNOT}}$ to $|\\psi_1\\rangle$:  \n\n$$\n\\tilde{U}_{\\text{CNOT}} |\\psi_1\\rangle = \\tilde{U}_{\\text{CNOT}} \\left( \\frac{1}{\\sqrt{2}} (|00\\rangle + |10\\rangle) \\right) = \\frac{1}{\\sqrt{2}} \\left( \\tilde{U}_{\\text{CNOT}} |00\\rangle + \\tilde{U}_{\\text{CNOT}} |10\\rangle \\right).\n$$\n  \nUsing the gate definitions:  \n- $\\tilde{U}_{\\text{CNOT}} |00\\rangle = |00\\rangle$,  \n- $\\tilde{U}_{\\text{CNOT}} |10\\rangle = \\sqrt{1-p} |11\\rangle + \\sqrt{p} |12\\rangle$.  \nThus,  \n\n$$\n|\\psi_f\\rangle = \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\sqrt{1-p} |11\\rangle + \\sqrt{p} |12\\rangle \\right).\n$$\n\n\n**Step 3: Compute fidelity with the ideal Bell state.**  \nThe ideal Bell state is $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}} (|00\\rangle + |11\\rangle)$. The fidelity is defined as $F = |\\langle \\Phi^+ | \\psi_f \\rangle|$.  \nFirst, compute the inner product:  \n\n$$\n\\langle \\Phi^+ | \\psi_f \\rangle = \\left( \\frac{1}{\\sqrt{2}} (\\langle 00| + \\langle 11|) \\right) \\left( \\frac{1}{\\sqrt{2}} (|00\\rangle + \\sqrt{1-p} |11\\rangle + \\sqrt{p} |12\\rangle) \\right).\n$$\n  \nExpanding:  \n\n$$\n\\langle \\Phi^+ | \\psi_f \\rangle = \\frac{1}{2} \\left( \\langle 00|00\\rangle + \\langle 00| \\sqrt{1-p} |11\\rangle + \\langle 00| \\sqrt{p} |12\\rangle + \\langle 11|00\\rangle + \\langle 11| \\sqrt{1-p} |11\\rangle + \\langle 11| \\sqrt{p} |12\\rangle \\right).\n$$\n  \nUsing orthonormality ($\\langle ij | kl \\rangle = \\delta_{ik} \\delta_{jl}$):  \n- $\\langle 00|00\\rangle = 1$,  \n- $\\langle 00|11\\rangle = 0$, $\\langle 00|12\\rangle = 0$,  \n- $\\langle 11|00\\rangle = 0$,  \n- $\\langle 11|11\\rangle = 1$, $\\langle 11|12\\rangle = 0$.  \nThus,  \n\n$$\n\\langle \\Phi^+ | \\psi_f \\rangle = \\frac{1}{2} \\left( 1 + \\sqrt{1-p} \\cdot 1 \\right) = \\frac{1}{2} (1 + \\sqrt{1-p}).\n$$\n  \nThe fidelity is the absolute value:  \n\n$$\nF = \\left| \\frac{1}{2} (1 + \\sqrt{1-p}) \\right|.\n$$\n  \nSince $0 \\leq p \\leq 1$, $\\sqrt{1-p} \\geq 0$, so:  \n\n$$\nF = \\frac{1}{2} (1 + \\sqrt{1-p}).\n$$", "answer": "$$\\boxed{\\dfrac{1}{2}\\left(1 + \\sqrt{1 - p}\\right)}$$", "id": "96482"}, {"introduction": "The consequences of leakage extend beyond simple state corruption; they can undermine the very mechanisms of error correction. This practice investigates a critical failure mode where a leakage error on a data qubit interferes with a stabilizer measurement, the cornerstone of quantum error correction. You will calculate the probability of obtaining an incorrect syndrome, revealing how physical errors can compromise logical-level diagnostics.[@problem_id:96431]", "problem": "A two-qubit quantum system is designed to operate within the computational subspace spanned by $\\{|0\\rangle, |1\\rangle\\}$ for each qubit. However, the physical implementation allows for leakage into a single, orthogonal \"leaked\" state $|L\\rangle$ for each qubit, such that $\\langle L|0\\rangle = \\langle L|1\\rangle = 0$.\n\nThe system is initialized in the state $|00\\rangle$. This state is a $+1$ eigenstate of the two-qubit Pauli operator $S = Z_1 Z_2$. Immediately after initialization, qubit 1 is subject to a leakage error. With probability $1-p$, its state is unaffected. With probability $p$, its state is projected into the leaked state $|L_1\\rangle$. This process results in a statistical mixture where the system is in state $|00\\rangle$ with probability $1-p$ and in state $|L_1 0\\rangle$ with probability $p$.\n\nFollowing this potential error, a non-demolition measurement of the stabilizer $S = Z_1 Z_2$ is performed to detect errors. The measurement circuit uses a single ancilla qubit, initialized to $|0\\rangle_a$. The sequence of operations is:\n1.  Apply a Hadamard gate to the ancilla ($H_a$).\n2.  Apply a Controlled-NOT (CNOT) gate with qubit 1 as control and the ancilla as target ($C_{1a}$).\n3.  Apply a CNOT gate with qubit 2 as control and the ancilla as target ($C_{2a}$).\n4.  Apply a Hadamard gate to the ancilla ($H_a$).\n5.  Measure the ancilla in the $Z$-basis ($\\{|0\\rangle_a, |1\\rangle_a\\}$).\n\nThe measurement outcome '0' corresponds to the $+1$ eigenspace of $S$, and '1' corresponds to the $-1$ eigenspace. Since the ideal state $|00\\rangle$ has a $+1$ eigenvalue for $S$, an ancilla outcome of '1' represents an incorrect syndrome.\n\nThe physical behavior of the CNOT gates depends on the state of the control qubit.\n- If the control qubit is in the computational subspace, the CNOT gate functions normally ($|c,t\\rangle \\to |c, t \\oplus c\\rangle$).\n- If the control qubit is in the leaked state $|L\\rangle$, the gate interaction causes a complete depolarization of the target qubit. This is described by the quantum channel $\\mathcal{D}(\\rho_t) = I_t/2$, where $\\rho_t$ is the density matrix of the target qubit and $I_t$ is the identity operator on the target's Hilbert space. The leaked state of the control qubit itself is assumed to be unaffected.\n\nCalculate the total probability of obtaining an incorrect syndrome outcome (i.e., measuring the ancilla as '1') as a function of the leakage probability $p$.", "solution": "The initial state of the system and ancilla is the mixture\n$$\n\\rho^{(0)}_{12,a}\n=\\Bigl((1-p)\\ket{00}\\bra{00}+p\\,\\ket{L_1\\,0}\\bra{L_1\\,0}\\Bigr)\\otimes\\ket{0}_a\\bra{0}\\,.\n$$\nWe compute the ancilla-measurement outcome conditioned on each branch:\n\nBranch 1: with weight $1-p$, system in $\\ket{00}$. The ideal stabilizer circuit yields ancilla in $\\ket{0}_a$ with certainty, so\n$$P(1\\mid\\ket{00})=0\\,. $$\n\nBranch 2: with weight $p$, system in $\\ket{L_1\\,0}$. Track ancilla state through the circuit:\n\n1. Hadamard on ancilla:\n$$\n\\rho_a^{(1)}=H\\,\\ket{0}\\bra{0}\\,H^\\dagger=\\ket{+}\\bra{+}\\,.\n$$\n2. CNOT$_{1\\to a}$ with control $\\ket{L_1}$: this induces complete depolarization on the ancilla,\n$$\n\\rho_a^{(2)}=\\mathcal{D}(\\rho_a^{(1)})=\\frac{I_a}{2}\\,.\n$$\n3. CNOT$_{2\\to a}$ with control $\\ket{0}_2$: no change,\n$$\n\\rho_a^{(3)}=\\frac{I_a}{2}\\,.\n$$\n4. Hadamard on ancilla:\n$$\n\\rho_a^{(4)}=H\\,\\frac{I_a}{2}\\,H^\\dagger=\\frac{I_a}{2}\\,.\n$$\n5. Measure in the $Z$ basis:\n$$\nP(1\\mid\\ket{L_1\\,0})\n=\\Tr\\bigl(\\ket{1}_a\\bra{1}\\,\\tfrac{I_a}{2}\\bigr)=\\frac12\\,.\n$$\n\nCombining branches,\n$$\nP(\\text{incorrect})=(1-p)\\cdot0+p\\cdot\\frac12=\\frac{p}{2}\\,.\n$$", "answer": "$$\\boxed{\\frac{p}{2}}$$", "id": "96431"}, {"introduction": "After diagnosing the problem, we turn to mitigation. One of the most effective strategies is to fight leakage at its source: the physical control pulses that drive quantum gates. This exercise introduces an elegant and practical pulse-shaping technique known as DRAG (Derivative Removal by Adiabatic Gate), demonstrating how a carefully designed control field can significantly suppress unwanted transitions to leaky states.[@problem_id:96500]", "problem": "A three-level quantum system (qutrit) with states $|0\\rangle, |1\\rangle, |2\\rangle$ is a common model for a superconducting transmon qubit where leakage to non-computational states can occur. The system is described by the Hamiltonian $H_0 = \\hbar\\omega_{01} |1\\rangle\\langle 1| + \\hbar(2\\omega_{01}-\\delta)|2\\rangle\\langle 2|$, where $\\delta > 0$ is the anharmonicity. We drive the $|0\\rangle \\leftrightarrow |1\\rangle$ transition with a control field, which in a rotating frame at frequency $\\omega_{01}$ and under the rotating wave approximation, results in the following interaction Hamiltonian:\n$$\nH(t)/\\hbar = \\begin{pmatrix} 0 & \\Omega^*(t)/2 & 0 \\\\ \\Omega(t)/2 & 0 & \\sqrt{2}\\Omega^*(t)/2 \\\\ 0 & \\sqrt{2}\\Omega(t)/2 & -\\delta \\end{pmatrix}\n$$\nHere, $\\Omega(t) = \\Omega_x(t) + i\\Omega_y(t)$ is the complex envelope of the control pulse. We wish to implement a $\\pi$-pulse that drives the system from the initial state $|1\\rangle$ to the final state $|0\\rangle$.\n\nConsider two different pulse schemes for this operation:\n\n1.  **Standard Gaussian Pulse:** The pulse has only an in-phase component, $\\Omega(t) = \\Omega_S(t)$, which is a real-valued Gaussian function:\n    $$\n    \\Omega_S(t) = A_G \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)\n    $$\n    The amplitude $A_G$ is chosen such that the total pulse area is $\\int_{-\\infty}^{\\infty} \\Omega_S(t) dt = \\pi$.\n\n2.  **DRAG-corrected Pulse:** This pulse, $\\Omega_D(t)$, uses the same in-phase component as the standard pulse, but adds a specifically shaped out-of-phase component to reduce leakage to the $|2\\rangle$ state. The complex envelope is given by:\n    $$\n    \\Omega_D(t) = \\Omega_S(t) + i\\frac{1}{2\\delta} \\frac{d\\Omega_S(t)}{dt}\n    $$\n\nTo simplify the analysis, assume that the pulse duration is short enough and the anharmonicity $\\delta$ is large enough such that the leakage probability $P_{1\\to 2}$ is dominated by the spectral content of the pulse envelope at the detuning frequency. Specifically, the probability is proportional to the squared magnitude of the Fourier transform of the complex envelope $\\Omega(t)$, evaluated at the anharmonicity $\\delta$:\n$$\nP_{1\\to 2} \\propto |\\tilde{\\Omega}(\\delta)|^2, \\quad \\text{where} \\quad \\tilde{\\Omega}(\\omega) = \\int_{-\\infty}^{\\infty} \\Omega(t) e^{-i\\omega t} dt\n$$\n\nCalculate the ratio of the leakage probability for the DRAG-corrected pulse to that of the standard Gaussian pulse, $R = P_{1\\to 2}^{(D)} / P_{1\\to 2}^{(S)}$.", "solution": "1. Pulse area constraint for $\\Omega_S(t)=A_G e^{-t^2/(2\\sigma^2)}$:\n$$\n\\int_{-\\infty}^\\infty\\Omega_S(t)\\,dt\n= A_G\\int_{-\\infty}^\\infty e^{-t^2/(2\\sigma^2)}dt\n= A_G\\,\\sigma\\sqrt{2\\pi}\n\\stackrel{!}{=}\\pi\n\\;\\;\\Rightarrow\\;\\;\nA_G=\\frac{\\pi}{\\sigma\\sqrt{2\\pi}}.\n$$\n\n2. Fourier transform of the Gaussian envelope:\n$$\n\\tilde\\Omega_S(\\omega)\n=\\int_{-\\infty}^\\infty A_G e^{-t^2/(2\\sigma^2)}e^{-i\\omega t}dt\n=A_G\\,\\sigma\\sqrt{2\\pi}\\,e^{-\\sigma^2\\omega^2/2}\n=\\pi\\,e^{-\\sigma^2\\omega^2/2}.\n$$\n\nThus at $\\omega=\\delta$,\n$$\n\\tilde\\Omega_S(\\delta)=\\pi\\,e^{-\\sigma^2\\delta^2/2},\n\\quad\nP_{1\\to2}^{(S)}\\propto\\bigl|\\tilde\\Omega_S(\\delta)\\bigr|^2\n=\\pi^2e^{-\\sigma^2\\delta^2}.\n$$\n\n3. DRAG pulse transform:\n$$\n\\Omega_D(t)=\\Omega_S(t)+\\frac{i}{2\\delta}\\dot\\Omega_S(t)\n\\;\\Longrightarrow\\;\n\\tilde\\Omega_D(\\omega)\n=\\tilde\\Omega_S(\\omega)\n+\\frac{i}{2\\delta}(i\\omega)\\tilde\\Omega_S(\\omega)\n=\\tilde\\Omega_S(\\omega)\\Bigl(1-\\frac{\\omega}{2\\delta}\\Bigr).\n$$\n\nAt $\\omega=\\delta$,\n$$\n\\tilde\\Omega_D(\\delta)\n=\\tilde\\Omega_S(\\delta)\\Bigl(1-\\tfrac12\\Bigr)\n=\\frac12\\,\\pi e^{-\\sigma^2\\delta^2/2},\n\\quad\nP_{1\\to2}^{(D)}\\propto\\bigl|\\tilde\\Omega_D(\\delta)\\bigr|^2\n=\\frac{\\pi^2}{4}e^{-\\sigma^2\\delta^2}.\n$$\n\n4. Ratio of leakage probabilities:\n$$\nR=\\frac{P_{1\\to2}^{(D)}}{P_{1\\to2}^{(S)}}\n=\\frac{\\tfrac{\\pi^2}{4}e^{-\\sigma^2\\delta^2}}{\\pi^2e^{-\\sigma^2\\delta^2}}\n=\\frac14.\n$$", "answer": "$$\\boxed{\\frac14}$$", "id": "96500"}]}