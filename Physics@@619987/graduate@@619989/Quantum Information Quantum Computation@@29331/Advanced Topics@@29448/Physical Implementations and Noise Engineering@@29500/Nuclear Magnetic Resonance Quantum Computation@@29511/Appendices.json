{"hands_on_practices": [{"introduction": "A cornerstone of Nuclear Magnetic Resonance (NMR) is the ability to selectively manipulate spins using shaped radio-frequency (RF) pulses. However, in a real sample, not all spins experience the exact same magnetic field, leading to a distribution of resonance frequencies, a phenomenon known as inhomogeneous broadening. This exercise [@problem_id:106579] provides a practical foundation for understanding how to model and predict the outcome of applying a realistic pulse with a Gaussian shape to an entire ensemble of spins that possess a Gaussian distribution of resonance offsets. Mastering this calculation is crucial for designing effective and selective quantum gates in any NMR-based quantum computer.", "problem": "In Nuclear Magnetic Resonance (NMR) quantum computation, shaped radio-frequency (RF) pulses are used to perform quantum gates. The effect of a pulse on an ensemble of spins is complicated by the fact that not all spins have the same resonance frequency due to, for instance, magnetic field inhomogeneity. This leads to a distribution of resonance offsets.\n\nConsider an ensemble of non-interacting spin-1/2 nuclei initially in thermal equilibrium, producing a net magnetization vector $\\vec{M}$ of magnitude $M_0$ aligned with the z-axis. A weak RF pulse, linearly polarized along the x-axis in the rotating frame, is applied to the ensemble. The Hamiltonian for any given spin in a frame rotating at the carrier frequency of the pulse is given by:\n$$\nH(t) = -\\Delta\\omega \\hat{I}_z - \\omega_1(t) \\hat{I}_x\n$$\nwhere $\\Delta\\omega$ is the resonance offset of the spin, $\\omega_1(t)$ is the time-dependent amplitude of the RF field in frequency units, and $\\hat{I}_k$ are the dimensionless spin operators.\n\nThe pulse has a Gaussian envelope, centered at $t=0$:\n$$\n\\omega_1(t) = \\Omega_0 \\exp\\left(-\\frac{t^2}{2\\sigma_t^2}\\right)\n$$\nwhere $\\Omega_0$ is the peak amplitude and $\\sigma_t$ is the characteristic duration of the pulse.\n\nIn the linear response regime (i.e., for small total flip angles), the complex transverse magnetization, $M_{xy}(\\Delta\\omega) = M_x(\\Delta\\omega) + i M_y(\\Delta\\omega)$, generated for a spin isochromat with offset $\\Delta\\omega$ is given by its response to the pulse:\n$$\nM_{xy}(\\Delta\\omega) = i M_0 \\int_{-\\infty}^{\\infty} \\omega_1(t) e^{i\\Delta\\omega t} dt\n$$\n\nThe ensemble of spins has a distribution of resonance offsets $P(\\Delta\\omega)$ that is also Gaussian, reflecting the inhomogeneous broadening of the spectral line:\n$$\nP(\\Delta\\omega) = \\frac{1}{\\sqrt{2\\pi}\\sigma_\\omega} \\exp\\left(-\\frac{(\\Delta\\omega)^2}{2\\sigma_\\omega^2}\\right)\n$$\nwhere $\\sigma_\\omega$ is the standard deviation of the resonance offset frequencies.\n\nYour task is to calculate the total y-component of magnetization, $M_{y,\\text{tot}}$, for the entire ensemble after the pulse has been applied. Express your answer as a closed-form expression in terms of $M_0$, $\\Omega_0$, $\\sigma_t$, and $\\sigma_\\omega$.", "solution": "1. The transverse response for a single isochromat is\n$$\nM_{xy}(\\Delta\\omega)\n= iM_0\\int_{-\\infty}^{\\infty}\\Omega_0 e^{-t^2/(2\\sigma_t^2)}e^{i\\Delta\\omega t}\\,dt\n= iM_0\\Omega_0\\sqrt{2\\pi}\\,\\sigma_t\\exp\\Big(-\\tfrac12\\Delta\\omega^2\\sigma_t^2\\Big).\n$$\nHence the y‐component is\n$$\nM_y(\\Delta\\omega)\n=\\Im\\{M_{xy}\\}\n=M_0\\Omega_0\\sqrt{2\\pi}\\,\\sigma_t\\exp\\Big(-\\tfrac12\\Delta\\omega^2\\sigma_t^2\\Big).\n$$\n\n2. The total y‐magnetization is\n$$\nM_{y,\\rm tot}\n=\\int_{-\\infty}^\\infty M_y(\\Delta\\omega)\\,P(\\Delta\\omega)\\,d\\Delta\\omega\n=\\frac{M_0\\Omega_0\\sqrt{2\\pi}\\,\\sigma_t}{\\sqrt{2\\pi}\\,\\sigma_\\omega}\n\\int_{-\\infty}^\\infty\n\\exp\\Big(-\\tfrac12\\Delta\\omega^2\\sigma_t^2\\Big)\n\\exp\\Big(-\\tfrac12\\frac{\\Delta\\omega^2}{\\sigma_\\omega^2}\\Big)\nd\\Delta\\omega.\n$$\n\n3. Combine exponents:\n$$\n-\\tfrac12\\Delta\\omega^2\\Big(\\sigma_t^2+\\frac1{\\sigma_\\omega^2}\\Big)\n\\equiv -\\tfrac12A\\,\\Delta\\omega^2,\\quad\nA=\\sigma_t^2+\\frac1{\\sigma_\\omega^2}.\n$$\nUse $\\int e^{-A x^2/2}dx=\\sqrt{2\\pi/A}$ to get\n$$\nM_{y,\\rm tot}\n=\\frac{M_0\\Omega_0\\sigma_t}{\\sigma_\\omega}\\sqrt{\\frac{2\\pi}{A}}\n=\\frac{M_0\\Omega_0\\sigma_t}{\\sigma_\\omega}\\sqrt{\\frac{2\\pi}{\\sigma_t^2+\\frac1{\\sigma_\\omega^2}}}\n=\\frac{M_0\\Omega_0\\sigma_t}{\\sigma_\\omega}\\sqrt{\\frac{2\\pi\\sigma_\\omega^2}{1+\\sigma_t^2\\sigma_\\omega^2}}\n=M_0\\Omega_0\\sigma_t\\sqrt{\\frac{2\\pi}{1+\\sigma_t^2\\sigma_\\omega^2}}.\n$$", "answer": "$$\n\\boxed{M_0\\Omega_0\\sigma_t\\sqrt{\\frac{2\\pi}{1+\\sigma_t^2\\sigma_\\omega^2}}}\n$$", "id": "106579"}, {"introduction": "The ability to reverse quantum evolution is a powerful concept, forming the basis of spin-echo techniques and dynamical decoupling, which are essential for combating decoherence. The Loschmidt echo is a protocol designed to measure the fidelity of this time-reversal process. This problem [@problem_id:106638] explores the practical limits of such a technique by introducing a common systematic error: an imperfect refocusing pulse. By calculating the final fidelity, you will gain insight into how coherent control errors compromise our ability to undo decoherence, a critical consideration in the design of robust quantum operations.", "problem": "In the field of Nuclear Magnetic Resonance Quantum Computation (NMR-QC), the spin-echo technique is a fundamental tool for mitigating the effects of dephasing. A Loschmidt echo is a specific implementation of this idea to measure the stability of quantum evolution under perturbations. This problem investigates the fidelity of such a sequence in the presence of a coherent control error.\n\nConsider a system of two coupled spin-1/2 particles, labeled 1 and 2. The $|\\uparrow\\rangle$ and $|\\downarrow\\rangle$ states are the eigenstates of the Pauli $\\sigma_z$ operator with eigenvalues $+1$ and $-1$, respectively. The system's dynamics are governed solely by the scalar J-coupling Hamiltonian:\n$$\nH = \\Omega \\, \\sigma_{1z} \\otimes \\sigma_{2z}\n$$\nwhere $\\sigma_{1z}$ is the Pauli-Z operator for particle 1, $\\sigma_{2z}$ is the Pauli-Z operator for particle 2, and $\\Omega$ is the coupling strength expressed in units of angular frequency.\n\nAt time $t=0$, the system is prepared in the initial state:\n$$\n|\\psi(0)\\rangle = \\left( \\frac{|\\uparrow\\rangle_1 + |\\downarrow\\rangle_1}{\\sqrt{2}} \\right) \\otimes |\\uparrow\\rangle_2\n$$\n\nA spin-echo sequence is applied to the system. This sequence consists of:\n1. Free evolution under the Hamiltonian $H$ for a duration of $t/2$.\n2. Application of a refocusing pulse $P$.\n3. Free evolution under the Hamiltonian $H$ for another duration of $t/2$.\n\nThe refocusing pulse $P$ is a selective pulse applied only to particle 1. Ideally, this would be a perfect $\\pi$-pulse ($180^\\circ$ rotation) about the x-axis. However, the pulse generator has a systematic error, resulting in a fractional flip-angle error of $\\epsilon$. The pulse operator is therefore given by:\n$$\nP = \\exp\\left(-i \\frac{\\pi(1+\\epsilon)}{2} \\sigma_{1x}\\right) \\otimes \\mathbb{I}_2\n$$\nwhere $\\sigma_{1x}$ is the Pauli-X operator for particle 1 and $\\mathbb{I}_2$ is the identity operator for particle 2.\n\nCalculate the Loschmidt echo fidelity, $F(t)$, for this sequence at a total time $t$. The fidelity is defined as the squared overlap of the final state with the initial state:\n$$\nF(t) = |\\langle\\psi(0)| U(t) |\\psi(0)\\rangle|^2\n$$\nwhere $U(t)$ is the total unitary propagator for the entire spin-echo sequence. Express your answer as a closed-form analytic expression in terms of the total time $t$, coupling strength $\\Omega$, and fractional error $\\epsilon$.", "solution": "We denote $\\theta=\\pi(1+\\epsilon)$, $C=\\cos\\frac{\\theta}{2}$, $S=\\sin\\frac{\\theta}{2}$.  The sequence is\n$$U(t)=e^{-iH\\frac{t}{2}}\\;P\\;e^{-iH\\frac{t}{2}},\\qquad\nP=e^{-i\\frac{\\theta}{2}\\,\\sigma_{1x}}\\otimes\\mathbb I_2.$$\n1. In the $\\{|\\uparrow\\rangle_1|\\uparrow\\rangle_2,\\;|\\downarrow\\rangle_1|\\uparrow\\rangle_2\\}$ subspace,\n$$H|\\uparrow\\uparrow\\rangle = \\Omega|\\uparrow\\uparrow\\rangle,\\quad\nH|\\downarrow\\uparrow\\rangle = -\\Omega|\\downarrow\\uparrow\\rangle,$$\nso\n$$e^{-iH\\frac{t}{2}}\\Bigl(\\tfrac{|\\uparrow\\rangle+|\\downarrow\\rangle}{\\sqrt2}\\otimes|\\uparrow\\rangle\\Bigr)\n=\\frac1{\\sqrt2}\\Bigl(e^{-i\\frac{\\Omega t}{2}}|\\uparrow\\uparrow\\rangle+e^{+i\\frac{\\Omega t}{2}}|\\downarrow\\uparrow\\rangle\\Bigr).$$\n2.  Apply $P$ on spin 1:\n$$P|\\uparrow\\rangle=C\\,|\\uparrow\\rangle-iS\\,|\\downarrow\\rangle,\\quad\nP|\\downarrow\\rangle=-iS\\,|\\uparrow\\rangle+C\\,|\\downarrow\\rangle.$$\nHence after $P$ the (unnormalized) state is\n\n$$\n\\frac1{\\sqrt2}\\Bigl(\ne^{-i\\frac{\\Omega t}{2}}(C|\\uparrow\\rangle-iS|\\downarrow\\rangle)\n+e^{+i\\frac{\\Omega t}{2}}(-iS|\\uparrow\\rangle+C|\\downarrow\\rangle)\\Bigr)\\otimes|\\uparrow\\rangle.\n$$\n\n3.  A second free evolution $e^{-iH\\frac{t}{2}}$ multiplies $|\\uparrow\\uparrow\\rangle$ by $e^{-i\\frac{\\Omega t}{2}}$ and $|\\downarrow\\uparrow\\rangle$ by $e^{+i\\frac{\\Omega t}{2}}$, giving\n\n$$\n|\\psi(t)\\rangle=\\frac1{\\sqrt2}\\Bigl((e^{-i\\Omega t}C - iS)\\,|\\uparrow\\rangle+(-\\,iS+e^{i\\Omega t}C)\\,|\\downarrow\\rangle\\Bigr)\\otimes|\\uparrow\\rangle.\n$$\n\n4.  The overlap with $|\\psi(0)\\rangle=(|\\uparrow\\rangle+|\\downarrow\\rangle)/\\sqrt2\\otimes|\\uparrow\\rangle$ is\n\n$$\nA=\\langle\\psi(0)|\\psi(t)\\rangle\n=\\frac12\\bigl(e^{-i\\Omega t}C - iS +(-\\,iS+e^{i\\Omega t}C)\\bigr)\n=C\\cos(\\Omega t)-iS.\n$$\n\n5.  Thus the fidelity is\n$$\nF(t)=|A|^2=C^2\\cos^2(\\Omega t)+S^2\n=\\cos^2\\!\\Bigl(\\frac{\\pi(1+\\epsilon)}{2}\\Bigr)\\cos^2(\\Omega t)\n+\\sin^2\\!\\Bigl(\\frac{\\pi(1+\\epsilon)}{2}\\Bigr).\n$$", "answer": "$$\\boxed{\\cos^2\\!\\Bigl(\\frac{\\pi(1+\\epsilon)}{2}\\Bigr)\\,\\cos^2(\\Omega t)\n+\\sin^2\\!\\Bigl(\\frac{\\pi(1+\\epsilon)}{2}\\Bigr)}$$", "id": "106638"}, {"introduction": "Liquid-state NMR quantum computers operate on a vast ensemble of molecules, meaning that any observable signal is an average over the entire sample. This has profound consequences for the nature of the quantum states we can prepare. This exercise [@problem_id:106548] guides you through a quintessential NMR-QC scenario: preparing an entangled Bell state across an ensemble that is subject to a static magnetic field gradient. You will calculate how the position-dependent evolution leads to a macroscopic mixed state, and quantify the resulting loss of \"quantumness\" by calculating the ensemble's purity. This practice provides a clear, quantitative understanding of how spatial inhomogeneity leads to a fundamental form of dephasing in ensemble-based quantum computing.", "problem": "In the context of liquid-state Nuclear Magnetic Resonance (NMR) quantum computing, consider a system of two coupled spin-1/2 particles, qubit A and qubit B, with distinct gyromagnetic ratios $\\gamma_A$ and $\\gamma_B$. The goal is to prepare a two-qubit Bell state.\n\nThe system is initially prepared in the pure state $|\\psi_0\\rangle = |00\\rangle$. The following sequence of operations is applied:\n1.  An ideal, instantaneous Hadamard gate is applied to qubit A.\n2.  The system undergoes a period of free evolution for a time duration $T$. During this period, the system is subject to a static linear magnetic field gradient $\\vec{G}$ aligned with the main quantization axis $\\hat{z}$, i.e., $\\vec{G} = G \\hat{z}$. The sample containing the molecules is uniformly distributed along the $z$-axis over a length $L$, centered at $z=0$ (from $z=-L/2$ to $z=L/2$). The Hamiltonian governing this free evolution is solely due to the gradient, given by $H(z) = \\frac{\\hbar}{2} (\\delta\\omega_A(z) \\sigma_z^A + \\delta\\omega_B(z) \\sigma_z^B)$, where $\\sigma_z^i$ is the Pauli Z operator for qubit $i$, and $\\delta\\omega_i(z) = \\gamma_i G z$ is the position-dependent Larmor frequency offset. Effects of J-coupling and chemical shifts are considered to be refocused during this period.\n3.  Following the free evolution, an ideal, instantaneous Controlled-NOT (CNOT) gate is applied, with qubit A as the control and qubit B as the target. The action of the CNOT is defined as $U_{CNOT}|x,y\\rangle = |x, x \\oplus y\\rangle$ where $x, y \\in \\{0, 1\\}$ and $\\oplus$ denotes addition modulo 2.\n\nDue to the position-dependent evolution, the final state of a molecule at position $z$, $\\rho(z)$, is different from that of other molecules. The final state of the entire ensemble is a mixed state $\\bar{\\rho}$ obtained by averaging over the positions of all molecules in the sample.\n\nCalculate the purity, $P = \\text{Tr}(\\bar{\\rho}^2)$, of this final ensemble-averaged state $\\bar{\\rho}$. Express your answer as a closed-form analytic expression in terms of the given symbolic parameters $\\gamma_A$, $G$, $T$, and $L$.", "solution": "1. After the Hadamard on qubit A,\n$$|\\psi_1\\rangle = \\frac{1}{\\sqrt2}(|0\\rangle_A+|1\\rangle_A)\\otimes|0\\rangle_B\n=\\frac1{\\sqrt2}\\bigl(|00\\rangle+|10\\rangle\\bigr). $$\n\n2. During free evolution at position $z$, \n$$H(z)=\\frac\\hbar2\\bigl(\\delta\\omega_A(z)\\,\\sigma_z^A+\\delta\\omega_B(z)\\,\\sigma_z^B\\bigr),\\quad\n\\delta\\omega_i(z)=\\gamma_i\\,G\\,z,$$\nso\n$$U(z)=\\exp\\!\\Bigl[-\\frac{iT}{\\hbar}H(z)\\Bigr]\n=\\exp\\!\\Bigl[-\\frac{iT}{2}\\bigl(\\delta\\omega_A\\sigma_z^A+\\delta\\omega_B\\sigma_z^B\\bigr)\\Bigr] \n=U_A\\otimes U_B$$\nwith\n$$U_i|0\\rangle_i=e^{-i\\,\\delta\\omega_iT/2}|0\\rangle_i,\\quad\nU_i|1\\rangle_i=e^{\\,i\\,\\delta\\omega_iT/2}|1\\rangle_i.$$\n\n3. Acting on $|\\psi_1\\rangle$,\n$$U(z)\\,|\\psi_1\\rangle\n=\\frac1{\\sqrt2}\\Bigl(e^{-i(\\phi_A+\\phi_B)}|00\\rangle\n+e^{\\,i(\\phi_A-\\phi_B)}|10\\rangle\\Bigr),\\quad\n\\phi_i=\\frac{\\delta\\omega_iT}{2}.$$\n\n4. The CNOT$(A\\to B)$ maps $|00\\rangle\\to|00\\rangle,\\;|10\\rangle\\to|11\\rangle$, giving\n$$|\\psi(z)\\rangle\n=\\frac{e^{-i(\\phi_A+\\phi_B)}}{\\sqrt2}\\Bigl(|00\\rangle\n+e^{\\,i2\\phi_A}\\,|11\\rangle\\Bigr)\n\\;\\widehat{=}\\;\\frac1{\\sqrt2}\\bigl(|00\\rangle+e^{i\\,\\Delta(z)}|11\\rangle\\bigr),$$\nwhere\n$$\\Delta(z)=2\\phi_A=\\delta\\omega_A(z)\\,T=\\gamma_A\\,G\\,T\\,z.$$\n\n5. The pure state at $z$ is\n$$\\rho(z)=|\\psi(z)\\rangle\\langle\\psi(z)|\n=\\frac12\\Bigl(|00\\rangle\\langle00|+|11\\rangle\\langle11|\n+e^{-i\\Delta(z)}|00\\rangle\\langle11|+e^{i\\Delta(z)}|11\\rangle\\langle00|\\Bigr).$$\n\n6. Averaging uniformly over $z\\in[-L/2,L/2]$,\n$$\\bar\\rho=\\frac1L\\int_{-L/2}^{L/2}\\rho(z)\\,dz\n=\\frac12\\Bigl(|00\\rangle\\langle00|+|11\\rangle\\langle11|\\Bigr)\n+\\frac12\\,M\\,\\bigl(|00\\rangle\\langle11|+|11\\rangle\\langle00|\\bigr),$$\nwith\n$$M=\\frac1L\\int_{-L/2}^{L/2}e^{-i\\gamma_A G T z}\\,dz\n=\\frac{2}{\\gamma_A G T\\,L}\\,\\sin\\!\\Bigl(\\tfrac{\\gamma_A G T\\,L}{2}\\Bigr)\n=\\mathrm{sinc}\\!\\Bigl(\\tfrac{\\gamma_A G T\\,L}{2}\\Bigr).$$\n\n7. In the $\\{|00\\rangle,|11\\rangle\\}$ subspace,\n$$\\bar\\rho=\\frac12\\begin{pmatrix}1 & M\\\\ M & 1\\end{pmatrix},$$\nso\n$$\\bar\\rho^2=\\frac{1}{4}\\begin{pmatrix}1+M^2&2M\\\\2M&1+M^2\\end{pmatrix},\\quad\nP=\\Tr(\\bar\\rho^2)=\\frac12\\bigl(1+M^2\\bigr).$$\n\n8. Substituting $M=\\sin(\\tfrac{\\gamma_AGTL}{2})/(\\tfrac{\\gamma_AGTL}{2})$ gives\n$$P=\\frac12\\Biggl[1+\\Bigl(\\frac{\\sin\\!\\bigl(\\tfrac{\\gamma_A G T L}{2}\\bigr)}{\\tfrac{\\gamma_A G T L}{2}}\\Bigr)^{\\!2}\\Biggr].$$", "answer": "$$\\boxed{\\frac12\\Bigl[1+\\Bigl(\\frac{\\sin\\!\\bigl(\\tfrac{\\gamma_A G T L}{2}\\bigr)}{\\tfrac{\\gamma_A G T L}{2}}\\Bigr)^{\\!2}\\Bigr]}$$", "id": "106548"}]}