{"hands_on_practices": [{"introduction": "The essence of weak localization lies in the constructive interference between an electron traversing a closed loop and its time-reversed counterpart. A powerful way to probe this quantum phenomenon is to break the time-reversal symmetry that underpins it. This exercise guides you through the foundational mechanism by which an external magnetic field achieves this, connecting the macroscopic negative magnetoresistance characteristic of weak localization to the fundamental Aharonov-Bohm effect [@problem_id:3024156]. By deriving the gauge-invariant phase difference between time-reversed paths, you will build a concrete understanding of how the Cooperon—the propagator for this interference process—is suppressed.", "problem": "Consider a phase-coherent electron of charge $e$ moving diffusively in a thin quasi-one-dimensional disordered metallic ring of circumference $L$ that encloses a static, spatially uniform magnetic field $\\mathbf{B}$ threading total magnetic flux $\\Phi$ through the ring. Assume elastic scattering dominates and the electron dynamics can be described by the Schrödinger equation with minimal coupling to the electromagnetic vector potential $\\mathbf{A}$, and that the loop formed by time-reversed diffusive trajectories around the ring is topologically equivalent to a closed contour encircling the flux $\\Phi$. The magnetic flux quantum is defined as $\\Phi_{0} = h c / e$, where $h$ is Planck’s constant and $c$ is the speed of light.\n\nStarting from first principles, derive the gauge-invariant phase accumulated by the electron along one such closed loop due to $\\mathbf{A}$ and express it in terms of $\\Phi$ and $\\Phi_{0}$. Express the final phase in radians. Then, explain qualitatively how this loop phase affects the interference between time-reversed paths and thereby suppresses the so-called Cooperon (the two-particle, time-reversed interference propagator) contribution to weak localization.\n\nYour final reported answer must be a single closed-form analytical expression for the loop phase in terms of $\\Phi$ and $\\Phi_{0}$, expressed in radians, with no additional commentary or units. No rounding is required.", "solution": "The problem requires the derivation of the gauge-invariant phase accumulated by a charge along a closed loop in the presence of a magnetic flux, and a qualitative explanation of its effect on weak localization.\n\nFirst, we derive the phase. The dynamics of an electron with charge $e$ in a magnetic field described by a vector potential $\\mathbf{A}$ are governed by the Schrödinger equation with the principle of minimal coupling. The canonical momentum operator $\\mathbf{p}_{\\text{can}} = -i\\hbar\\nabla$ is replaced by the kinetic momentum operator $\\mathbf{p}_{\\text{kin}} = \\mathbf{p}_{\\text{can}} - \\frac{e}{c}\\mathbf{A}$, where $c$ is the speed of light. Rearranging, the canonical momentum is related to the kinetic momentum $\\mathbf{p}_{\\text{kin}} = m\\mathbf{v}$ by $\\mathbf{p}_{\\text{can}} = \\mathbf{p}_{\\text{kin}} + \\frac{e}{c}\\mathbf{A}$.\n\nIn the semi-classical picture, the change in the phase of an electron's wavefunction $\\psi$ along an infinitesimal path element $d\\mathbf{l}$ is given by $\\frac{1}{\\hbar}$ times the projection of the canonical momentum onto the path, i.e., $d\\phi = \\frac{1}{\\hbar}\\mathbf{p}_{\\text{can}} \\cdot d\\mathbf{l}$. The total phase accumulated along a path $\\mathcal{C}$ is the integral of this quantity:\n$$ \\Delta\\phi_{\\text{total}} = \\int_{\\mathcal{C}} \\frac{\\mathbf{p}_{\\text{can}}}{\\hbar} \\cdot d\\mathbf{l} = \\frac{1}{\\hbar} \\int_{\\mathcal{C}} (\\mathbf{p}_{\\text{kin}} + \\frac{e}{c}\\mathbf{A}) \\cdot d\\mathbf{l} $$\nThis expression separates into two terms:\n$$ \\Delta\\phi_{\\text{total}} = \\frac{1}{\\hbar} \\int_{\\mathcal{C}} \\mathbf{p}_{\\text{kin}} \\cdot d\\mathbf{l} + \\frac{e}{\\hbar c} \\int_{\\mathcal{C}} \\mathbf{A} \\cdot d\\mathbf{l} $$\nThe first term is the dynamical phase, which depends on the particle's velocity and path length. The second term is the magnetic phase, often called the Aharonov-Bohm phase, which depends only on the geometry of the path relative to the vector potential.\n\nThe problem asks for the gauge-invariant phase accumulated along a closed loop due to $\\mathbf{A}$. This corresponds to the magnetic phase term, evaluated over a closed contour $\\mathcal{C}_{\\text{loop}}$ that encircles the magnetic flux. Let us call this phase $\\Delta\\phi_{\\text{loop}}$:\n$$ \\Delta\\phi_{\\text{loop}} = \\frac{e}{\\hbar c} \\oint_{\\mathcal{C}_{\\text{loop}}} \\mathbf{A} \\cdot d\\mathbf{l} $$\nThis expression is gauge-invariant. A gauge transformation $\\mathbf{A} \\rightarrow \\mathbf{A}' = \\mathbf{A} + \\nabla\\chi$ adds a term $\\frac{e}{\\hbar c} \\oint \\nabla\\chi \\cdot d\\mathbf{l}$ to the phase. For any single-valued function $\\chi$, the integral of its gradient around a closed loop is zero, so $\\Delta\\phi_{\\text{loop}}$ remains unchanged.\n\nUsing Stokes' theorem, the line integral of the vector potential around the closed loop can be expressed as the surface integral of its curl over the area $\\mathcal{S}$ enclosed by the loop:\n$$ \\oint_{\\mathcal{C}_{\\text{loop}}} \\mathbf{A} \\cdot d\\mathbf{l} = \\iint_{\\mathcal{S}} (\\nabla \\times \\mathbf{A}) \\cdot d\\mathbf{S} $$\nThe curl of the vector potential is the magnetic field, $\\mathbf{B} = \\nabla \\times \\mathbf{A}$. The surface integral $\\iint_{\\mathcal{S}} \\mathbf{B} \\cdot d\\mathbf{S}$ is, by definition, the total magnetic flux $\\Phi$ passing through the loop.\nThus, the phase becomes:\n$$ \\Delta\\phi_{\\text{loop}} = \\frac{e\\Phi}{\\hbar c} $$\nTo express this in terms of the given magnetic flux quantum $\\Phi_{0} = hc/e$, we use the relation between Planck's constant $h$ and the reduced Planck's constant $\\hbar$, which is $\\hbar = h/(2\\pi)$.\n$$ \\Delta\\phi_{\\text{loop}} = \\frac{e\\Phi}{(h/2\\pi)c} = \\frac{2\\pi e \\Phi}{hc} $$\nSubstituting $\\frac{e}{hc} = \\frac{1}{\\Phi_{0}}$, we arrive at the final expression for the loop phase:\n$$ \\Delta\\phi_{\\text{loop}} = 2\\pi \\frac{\\Phi}{\\Phi_{0}} $$\nThis phase is expressed in radians, as requested.\n\nNext, we explain how this phase affects the interference between time-reversed paths and suppresses the Cooperon contribution to weak localization.\nWeak localization is a quantum correction to the classical conductivity of a disordered conductor, arising from the constructive interference of an electron traversing a closed-loop path and its time-reversed counterpart.\nLet's consider a pair of such time-reversed paths, $\\mathcal{C}_{1}$ and $\\mathcal{C}_{2}$. They start at the same point, trace the same sequence of elastic scattering events in opposite temporal order, and return to the starting point, thereby forming a closed loop enclosing a flux $\\Phi$.\nThe amplitude for each path is $A_{j} = |A| \\exp(i\\phi_{j})$. The total probability of return is proportional to $|A_1 + A_2|^2$, which contains an interference term dependent on the phase difference $\\Delta\\phi_{\\text{rel}} = \\phi_{1} - \\phi_{2}$.\nThe total phase for each path has a dynamical component and a magnetic component. The dynamical phase is identical for both paths due to the time-reversal symmetry of elastic scattering. The magnetic phase, however, depends on the direction of traversal. If path $\\mathcal{C}_{1}$ (e.g., clockwise) accumulates a magnetic phase of $\\Delta\\phi_{\\text{loop}}$, its time-reversed partner $\\mathcal{C}_{2}$ (counter-clockwise) traverses the loop in the opposite direction, acquiring a magnetic phase of $-\\Delta\\phi_{\\text{loop}}$.\nThe relative phase difference between the two paths is therefore:\n$$ \\Delta\\phi_{\\text{rel}} = \\phi_{1} - \\phi_{2} = ( \\phi_{\\text{dyn}} + \\Delta\\phi_{\\text{loop}} ) - ( \\phi_{\\text{dyn}} - \\Delta\\phi_{\\text{loop}} ) = 2\\Delta\\phi_{\\text{loop}} = 4\\pi \\frac{\\Phi}{\\Phi_{0}} $$\nThe interference term in the return probability is proportional to $\\cos(\\Delta\\phi_{\\text{rel}}) = \\cos(4\\pi \\Phi/\\Phi_{0})$.\nIn the absence of a magnetic field ($\\Phi=0$), the phase difference $\\Delta\\phi_{\\text{rel}}$ is $0$, and the interference is perfectly constructive ($\\cos(0)=1$). This enhancement of backscattering probability leads to an increase in resistance, known as weak localization. The Cooperon is the object in diagrammatic perturbation theory that mathematically describes this sum over all interfering time-reversed path pairs.\nWhen a magnetic field is applied ($\\Phi \\neq 0$), a non-zero phase difference is introduced. For a large ensemble of diffusive loops of varying sizes and shapes, this phase difference will vary. When the flux through a typical loop area becomes a significant fraction of $\\Phi_{0}$, the phase factor averages out the constructive interference effect. This destruction of time-reversal symmetry by the magnetic field suppresses the Cooperon contribution, thereby suppressing weak localization and leading to a decrease in resistance (a characteristic negative magnetoresistance).", "answer": "$$\\boxed{2\\pi \\frac{\\Phi}{\\Phi_{0}}}$$", "id": "3024156"}, {"introduction": "With the physical mechanism established, we can quantify its impact on a key transport property: electrical conductivity. This practice takes you to the heart of weak localization theory by calculating the quantum correction to conductivity, $\\delta\\sigma$, as a function of spatial dimension $d$ [@problem_id:3024128]. By evaluating the integral over the Cooperon propagator, you will directly uncover the remarkable dimensional dependence of quantum interference, providing the mathematical basis for understanding why localization is inevitable in one and two dimensions but allows for a metal-insulator transition in three.", "problem": "Consider weak localization arising from coherent backscattering in a $d$-dimensional diffusive conductor. In the diffusion approximation with dephasing time $\\tau_{\\phi}$ and diffusion constant $D$, the quantum correction to the direct-current conductivity $\\delta \\sigma$ can be written, after disorder averaging and resummation of maximally crossed diagrams, as\n$$\n\\delta \\sigma \\;=\\; -\\frac{e^{2} D}{\\pi \\hbar} \\int \\frac{d^{d} q}{(2\\pi)^{d}} \\, \\frac{1}{D q^{2} + \\tau_{\\phi}^{-1}} \\, ,\n$$\nwhere $e$ is the elementary charge, $\\hbar$ is the reduced Planck constant, and $q$ is the wavevector conjugate to position in the diffusion propagator. The integral is controlled by the diffusive ultraviolet cutoff $q_{\\max} \\sim 1/\\ell$, with $\\ell$ the elastic mean free path, and the infrared regularization supplied by dephasing through the phase-coherence length $L_{\\phi} = \\sqrt{D \\tau_{\\phi}}$. Assume the system is in the orthogonal symmetry class (time-reversal symmetry present, negligible spin-orbit for simplicity), and that the diffusion description is valid for $|q| \\le q_{\\max}$.\n\nEvaluate the integral explicitly for $d=1,2,3$ using $q_{\\max} = 1/\\ell$, and express each result in closed form in terms of $e$, $\\hbar$, $L_{\\phi}$, and $\\ell$. Present your final answer as a single row matrix whose three entries are $\\delta \\sigma$ in $d=1$, $d=2$, and $d=3$, in that order. Do not evaluate numerically. The associated physical unit, if evaluated numerically, should be expressed in the International System of Units (Siemens per meter). Any inverse trigonometric function should be interpreted in radians.\n\nYour derivation should begin from the provided representation of $\\delta \\sigma$ and use only standard facts about diffusive transport and well-posed cutoffs. Conclude by briefly indicating how the dimensional dependence ($d=1,2,3$) emerges from your evaluated expressions.", "solution": "The given expression for the conductivity correction is:\n$$ \\delta \\sigma_d = -\\frac{e^{2} D}{\\pi \\hbar} \\int_{|q| \\le 1/\\ell} \\frac{d^{d} q}{(2\\pi)^{d}} \\, \\frac{1}{D q^{2} + \\tau_{\\phi}^{-1}} $$\nFirst, we simplify the expression by factoring $D$ from the denominator of the integrand and using the definition $L_{\\phi} = \\sqrt{D \\tau_{\\phi}}$, which implies $\\tau_{\\phi}^{-1} = D/L_{\\phi}^2$.\n$$ \\delta \\sigma_d = -\\frac{e^{2} D}{\\pi \\hbar} \\int_{|q| \\le 1/\\ell} \\frac{d^{d} q}{(2\\pi)^{d}} \\, \\frac{1}{D (q^{2} + (D\\tau_{\\phi})^{-1})} = -\\frac{e^{2}}{\\pi \\hbar} \\int_{|q| \\le 1/\\ell} \\frac{d^{d} q}{(2\\pi)^{d}} \\, \\frac{1}{q^{2} + L_{\\phi}^{-2}} $$\nThe integral is spherically symmetric in $q$-space. We can switch to hyperspherical coordinates, where the volume element is $d^d q = S_{d-1} q^{d-1} dq$, and $S_{d-1} = 2\\pi^{d/2}/\\Gamma(d/2)$ is the surface area of a $(d-1)$-dimensional unit sphere. The integral becomes:\n$$ \\delta \\sigma_d = -\\frac{e^{2}}{\\pi \\hbar} \\frac{S_{d-1}}{(2\\pi)^d} \\int_0^{1/\\ell} \\frac{q^{d-1}}{q^2 + L_\\phi^{-2}} \\, dq $$\nWe now evaluate this for $d=1$, $d=2$, and $d=3$.\n\n**Case d=1:**\nFor $d=1$, the \"sphere\" consists of two points, so $S_0=2$.\n$$ \\delta \\sigma_1 = -\\frac{e^{2}}{\\pi \\hbar} \\frac{2}{(2\\pi)^1} \\int_0^{1/\\ell} \\frac{q^{1-1}}{q^2 + L_\\phi^{-2}} \\, dq = -\\frac{e^{2}}{\\pi^2 \\hbar} \\int_0^{1/\\ell} \\frac{1}{q^2 + L_\\phi^{-2}} \\, dq $$\nThe integral is a standard arctangent form $\\int \\frac{dx}{x^2+a^2} = \\frac{1}{a}\\arctan(\\frac{x}{a})$. With $a = L_\\phi^{-1}$, we have:\n$$ \\int_0^{1/\\ell} \\frac{dq}{q^2 + L_\\phi^{-2}} = \\left[ L_\\phi \\arctan(q L_\\phi) \\right]_0^{1/\\ell} = L_\\phi \\arctan\\left(\\frac{L_\\phi}{\\ell}\\right) - 0 = L_\\phi \\arctan\\left(\\frac{L_\\phi}{\\ell}\\right) $$\nSubstituting this back, the conductivity correction in one dimension is:\n$$ \\delta \\sigma_1 = -\\frac{e^2 L_\\phi}{\\pi^2 \\hbar} \\arctan\\left(\\frac{L_\\phi}{\\ell}\\right) $$\n\n**Case d=2:**\nFor $d=2$, the surface is a circle with circumference $S_1 = 2\\pi$.\n$$ \\delta \\sigma_2 = -\\frac{e^{2}}{\\pi \\hbar} \\frac{2\\pi}{(2\\pi)^2} \\int_0^{1/\\ell} \\frac{q^{2-1}}{q^2 + L_\\phi^{-2}} \\, dq = -\\frac{e^{2}}{2\\pi^2 \\hbar} \\int_0^{1/\\ell} \\frac{q}{q^2 + L_\\phi^{-2}} \\, dq $$\nThis integral can be solved using a substitution $u = q^2 + L_\\phi^{-2}$, which gives $du = 2q dq$.\n$$ \\int_0^{1/\\ell} \\frac{q \\, dq}{q^2 + L_\\phi^{-2}} = \\frac{1}{2}\\int_{L_\\phi^{-2}}^{1/\\ell^2 + L_\\phi^{-2}} \\frac{du}{u} = \\frac{1}{2} \\left[ \\ln|u| \\right]_{L_\\phi^{-2}}^{1/\\ell^2 + L_\\phi^{-2}} $$\n$$ = \\frac{1}{2} \\left( \\ln\\left(\\frac{1}{\\ell^2} + \\frac{1}{L_\\phi^2}\\right) - \\ln\\left(\\frac{1}{L_\\phi^2}\\right) \\right) = \\frac{1}{2} \\ln\\left(\\frac{1/\\ell^2 + 1/L_\\phi^2}{1/L_\\phi^2}\\right) = \\frac{1}{2} \\ln\\left(\\frac{L_\\phi^2}{\\ell^2} + 1\\right) $$\nSubstituting this back, the conductivity correction in two dimensions is:\n$$ \\delta \\sigma_2 = -\\frac{e^2}{2\\pi^2 \\hbar} \\cdot \\frac{1}{2} \\ln\\left(1 + \\left(\\frac{L_\\phi}{\\ell}\\right)^2\\right) = -\\frac{e^2}{4\\pi^2 \\hbar} \\ln\\left(1 + \\left(\\frac{L_\\phi}{\\ell}\\right)^2\\right) $$\n\n**Case d=3:**\nFor $d=3$, the surface is a sphere with area $S_2 = 4\\pi$.\n$$ \\delta \\sigma_3 = -\\frac{e^{2}}{\\pi \\hbar} \\frac{4\\pi}{(2\\pi)^3} \\int_0^{1/\\ell} \\frac{q^{3-1}}{q^2 + L_\\phi^{-2}} \\, dq = -\\frac{e^{2}}{2\\pi^3 \\hbar} \\int_0^{1/\\ell} \\frac{q^2}{q^2 + L_\\phi^{-2}} \\, dq $$\nTo evaluate the integral, we rewrite the integrand: $\\frac{q^2}{q^2 + a^2} = \\frac{(q^2+a^2)-a^2}{q^2+a^2} = 1 - \\frac{a^2}{q^2+a^2}$. With $a=L_\\phi^{-1}$:\n$$ \\int_0^{1/\\ell} \\left(1 - \\frac{L_\\phi^{-2}}{q^2 + L_\\phi^{-2}}\\right) dq = \\left[ q - L_\\phi^{-2} \\cdot L_\\phi \\arctan(q L_\\phi) \\right]_0^{1/\\ell} $$\n$$ = \\left[ q - \\frac{1}{L_\\phi} \\arctan(q L_\\phi) \\right]_0^{1/\\ell} = \\left(\\frac{1}{\\ell} - \\frac{1}{L_\\phi} \\arctan\\left(\\frac{L_\\phi}{\\ell}\\right)\\right) - 0 $$\nSubstituting this back, the conductivity correction in three dimensions is:\n$$ \\delta \\sigma_3 = -\\frac{e^2}{2\\pi^3 \\hbar} \\left( \\frac{1}{\\ell} - \\frac{1}{L_\\phi} \\arctan\\left(\\frac{L_\\phi}{\\ell}\\right) \\right) $$\n\nThe results demonstrate a strong dependence on the dimensionality $d$. In the physically relevant limit where the phase-coherence length is much larger than the elastic mean free path ($L_\\phi \\gg \\ell$), the behavior of the correction term $\\delta\\sigma_d$ is qualitatively different for each dimension. For $d=1$, $\\delta\\sigma_1 \\propto -L_\\phi$; for $d=2$, $\\delta\\sigma_2 \\propto -\\ln(L_\\phi/\\ell)$; for $d=3$, $\\delta\\sigma_3$ approaches a finite constant. This dimensional dependence arises fundamentally from the phase space volume available for scattering, as captured by the $q^{d-1}$ term in the momentum-space integral.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{e^2 L_\\phi}{\\pi^2 \\hbar} \\arctan\\left(\\frac{L_\\phi}{\\ell}\\right) & -\\frac{e^2}{4\\pi^2 \\hbar} \\ln\\left(1 + \\left(\\frac{L_\\phi}{\\ell}\\right)^2\\right) & -\\frac{e^2}{2\\pi^3 \\hbar} \\left( \\frac{1}{\\ell} - \\frac{1}{L_\\phi} \\arctan\\left(\\frac{L_\\phi}{\\ell}\\right) \\right)\n\\end{pmatrix}\n}\n$$", "id": "3024128"}, {"introduction": "Our analytical results for weak localization are derived from perturbation theory and are only valid for weak disorder, where the Ioffe-Regel criterion $k_F \\ell_e \\gg 1$ holds. This hands-on numerical experiment allows you to explore what happens beyond this limit, at the frontier between weak and strong localization [@problem_id:3024137]. By implementing the Anderson model and computing conductivity via the Kubo-Greenwood formula, you will directly witness the breakdown of the perturbative logarithmic correction in two dimensions and gain practical insight into the conditions that govern the transition to a fully insulating state.", "problem": "Consider a two-dimensional disordered tight-binding model on a square lattice that exhibits Weak Localization (WL) and transitions toward strong localization as disorder increases. The lattice has linear size $L$ (number of sites per side) with periodic boundary conditions, and nearest-neighbor hopping amplitude $t$. On-site disorder is modeled by a random potential $V(\\mathbf{r})$ uniformly distributed in the interval $[-W/2, W/2]$, where $W$ is the disorder strength. Work in dimensionless units with electron charge $e = 1$, reduced Planck constant $\\hbar = 1$, lattice constant $a = 1$, and hopping $t = 1$. The Fermi energy is at $E_F = 0$ (half-filling). \n\nThe Hamiltonian is defined by the Anderson model,\n$$\nH = -t \\sum_{\\langle \\mathbf{r}, \\mathbf{r}'\\rangle} \\left( c_{\\mathbf{r}}^\\dagger c_{\\mathbf{r}'} + c_{\\mathbf{r}'}^\\dagger c_{\\mathbf{r}} \\right) + \\sum_{\\mathbf{r}} V(\\mathbf{r})\\, c_{\\mathbf{r}}^\\dagger c_{\\mathbf{r}},\n$$\nwhere $\\langle \\mathbf{r}, \\mathbf{r}'\\rangle$ denotes nearest neighbors on the square lattice, and $V(\\mathbf{r})$ are independent identically distributed random variables with zero mean and variance $\\mathrm{Var}(V) = W^2/12$.\n\nThe longitudinal current operator along $x$ is defined by the Peierls substitution and reads\n$$\nJ_x = i t \\sum_{\\mathbf{r}} \\left( c_{\\mathbf{r}+\\hat{x}}^\\dagger c_{\\mathbf{r}} - c_{\\mathbf{r}}^\\dagger c_{\\mathbf{r}+\\hat{x}} \\right).\n$$\n\nDefine the zero-temperature direct current conductivity via the Kubo-Greenwood approximation at the Fermi surface using a finite broadening $\\eta$:\n$$\n\\sigma_{xx}^{\\mathrm{num}}(0) \\approx \\frac{\\pi}{L^2} \\sum_{n,m} \\left| \\langle n | J_x | m \\rangle \\right|^2 \\delta_\\eta(E_n - E_F)\\,\\delta_\\eta(E_m - E_F),\n$$\nwhere $|n\\rangle$ are exact eigenstates of $H$ with eigenvalues $E_n$, and $\\delta_\\eta(E) = \\frac{1}{\\pi} \\frac{\\eta}{E^2 + \\eta^2}$ is the Lorentzian broadened delta function. All quantities are dimensionless in the chosen units.\n\nAs a baseline, the Drude conductivity can be estimated from the Einstein relation for diffusion in two dimensions,\n$$\n\\sigma_{xx}^{\\mathrm{Drude}} = \\mathcal{N}(E_F)\\, D,\n$$\nwhere $\\mathcal{N}(E_F)$ is the density of states per unit area at the Fermi energy, and the diffusion constant $D$ is estimated from $D \\approx \\frac{1}{2} v_F^2 \\tau_e$, with $v_F$ the Fermi velocity and $\\tau_e$ the elastic scattering time. In the first Born approximation for short-range uncorrelated disorder,\n$$\n\\frac{1}{\\tau_e} \\approx 2\\pi\\, \\mathrm{Var}(V)\\, \\mathcal{N}_0(E_F),\n$$\nwhere $\\mathcal{N}_0(E_F)$ is the clean-system density of states at the Fermi energy.\n\nFor a two-dimensional orthogonal symmetry class, the WL correction to the conductivity is, in the perturbative diffusive regime,\n$$\n\\delta \\sigma^{\\mathrm{WL}} \\approx -\\frac{1}{2\\pi^2} \\ln\\left( \\frac{L_\\phi}{\\ell_e} \\right),\n$$\nwhere $\\ell_e = v_F \\tau_e$ is the elastic mean free path, and $L_\\phi$ is the phase-coherence length. In the absence of inelastic scattering, $L_\\phi$ is limited by the system size and the diffusion time, which we take as $L_\\phi \\approx L$ for the purposes of this numerical assessment. The perturbative WL formula is applicable when the Ioffe-Regel criterion satisfies $k_F \\ell_e \\gg 1$.\n\nYour task is to implement a numerical experiment that, for a fixed lattice size and parameters, computes:\n- The numerical conductivity $\\sigma_{xx}^{\\mathrm{num}}$ using the Kubo-Greenwood approximation.\n- The Drude conductivity $\\sigma_{xx}^{\\mathrm{Drude}}$ using the Einstein relation with $\\tau_e$ from the Born approximation and $v_F$ estimated from the clean dispersion on the Fermi surface.\n- The predicted perturbative WL correction $\\delta \\sigma^{\\mathrm{WL}}$ using the formula above with $L_\\phi = L$ and $\\ell_e = v_F \\tau_e$.\n- The numerical correction $\\delta \\sigma^{\\mathrm{num}} = \\sigma_{xx}^{\\mathrm{num}} - \\sigma_{xx}^{\\mathrm{Drude}}$.\n- The Ioffe-Regel parameter $k_F \\ell_e$ from the clean dispersion at half filling.\n\nDefine a boolean decision rule to flag the reliability of the perturbative WL correction at each disorder level as follows: declare the WL perturbation quantitatively reliable if both $k_F \\ell_e > k_{\\mathrm{thr}}$ and \n$$\n\\frac{ \\left| \\delta \\sigma^{\\mathrm{num}} - \\delta \\sigma^{\\mathrm{WL}} \\right| }{ \\max\\left(10^{-12}, \\left| \\delta \\sigma^{\\mathrm{WL}} \\right| \\right) } < r_{\\mathrm{thr}},\n$$\nwith thresholds $k_{\\mathrm{thr}}$ and $r_{\\mathrm{thr}}$ specified below. Otherwise, declare it unreliable.\n\nImplement the following parameter choices:\n- Lattice linear size $L = 18$ (thus $N = L^2 = 324$ sites).\n- Hopping amplitude $t = 1$.\n- Fermi energy $E_F = 0$.\n- Broadening $\\eta = 0.05$.\n- Clean-system Fermi velocity $v_F$ and Fermi wavevector magnitude $k_F$ estimated from the clean dispersion $E(\\mathbf{k}) = -2(\\cos k_x + \\cos k_y)$ by sampling the Brillouin zone and averaging over the set of $\\mathbf{k}$ satisfying $|E(\\mathbf{k}) - E_F| < \\varepsilon_k$, with $\\varepsilon_k = 0.05$. Use the velocity $\\mathbf{v}(\\mathbf{k}) = \\nabla_{\\mathbf{k}} E(\\mathbf{k}) = (2 \\sin k_x, 2 \\sin k_y)$ and $|\\mathbf{k}| = \\sqrt{k_x^2 + k_y^2}$ to estimate $v_F$ and $k_F$ as the averages of $|\\mathbf{v}|$ and $|\\mathbf{k}|$ over that set.\n- Density of states at $E_F$ for the Drude conductivity, $\\mathcal{N}(E_F)$, estimated from the disordered eigenvalue spectrum within window $[-\\Delta E, \\Delta E]$ using $\\Delta E = 0.2$ as $\\mathcal{N}(E_F) \\approx \\frac{N_{\\mathrm{win}}}{N \\cdot 2\\Delta E}$, where $N_{\\mathrm{win}}$ is the count of eigenvalues in the window.\n- Clean-system density of states $\\mathcal{N}_0(E_F)$ estimated once from the clean Hamiltonian using the same window.\n- Thresholds $k_{\\mathrm{thr}} = 5.0$ and $r_{\\mathrm{thr}} = 0.5$.\n\nTest suite:\n- Use the following disorder strengths $W$ to probe different regimes: $W = 0.5$ (weak disorder), $W = 2.0$ (moderate disorder), $W = 3.5$ (crossover regime), $W = 6.0$ (strong disorder).\n- Each test case is a single float $W$.\n\nFor each test case $W$, your program must output a boolean indicating whether the perturbative WL correction is reliable according to the decision rule above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,False]\"). All outputs are dimensionless numbers or booleans in the chosen units, so no physical unit conversion is required. Angles (e.g., momenta) are treated in radians consistently by construction from the dispersion. Percentages are not used; any fractional comparisons are expressed as decimal ratios internally by the program.\n\nYour program must be self-contained, take no input, and compute and print the results for the specified test suite.", "solution": "The solution requires creating a Python program to perform a numerical experiment on the 2D Anderson model. The program will calculate conductivity using the Kubo-Greenwood formula and compare it to theoretical predictions from Drude theory and perturbative weak localization theory.\n\nThe overall approach is as follows:\n1.  **Clean System Properties:** First, calculate properties of the non-disordered system, which are independent of the disorder strength $W$. These include the Fermi velocity $v_F$, Fermi wavevector $k_F$, and the clean density of states at the Fermi level, $\\mathcal{N}_0(E_F)$. These are computed once by analyzing the clean dispersion relation $E(\\mathbf{k})$ over the Brillouin zone.\n2.  **Disorder Loop:** For each specified value of $W$ in the test suite:\n    a.  **Construct System:** Generate a random on-site potential matrix and add it to the clean tight-binding Hamiltonian to create the full disordered Hamiltonian $H$. The current operator matrix $J_x$ is also constructed.\n    b.  **Solve System:** Numerically diagonalize the disordered Hamiltonian $H$ to find its eigenvalues $\\{E_n\\}$ and eigenvectors $\\{|n\\rangle\\}$.\n    c.  **Calculate $\\sigma_{xx}^{\\mathrm{num}}$:** Evaluate the Kubo-Greenwood formula by transforming the current operator into the eigenbasis of $H$ and performing the summation over all pairs of eigenstates, using the specified Lorentzian broadening $\\eta$.\n    d.  **Calculate Theoretical Quantities:** Compute the disordered density of states $\\mathcal{N}(E_F)$, the elastic scattering time $\\tau_e$ from the Born approximation, the Drude conductivity $\\sigma_{xx}^{\\mathrm{Drude}}$, the elastic mean free path $\\ell_e$, the Ioffe-Regel parameter $k_F \\ell_e$, and the perturbative weak localization correction $\\delta \\sigma^{\\mathrm{WL}}$.\n    e.  **Check Reliability:** Evaluate the two conditions of the decision rule: the Ioffe-Regel criterion and the relative agreement between the numerical correction ($\\delta \\sigma^{\\mathrm{num}} = \\sigma_{xx}^{\\mathrm{num}} - \\sigma_{xx}^{\\mathrm{Drude}}$) and the theoretical prediction $\\delta \\sigma^{\\mathrm{WL}}$. Determine the boolean result (True for reliable, False for unreliable).\n3.  **Output:** Collect the boolean results for all $W$ values and format them into the specified output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_clean_properties(L, t, E_F, eps_k, delta_E):\n    \"\"\"\n    Calculates properties of the clean system: Fermi velocity, Fermi wavevector,\n    and density of states at the Fermi energy.\n    \"\"\"\n    N = L * L\n    \n    # k-vectors in the Brillouin Zone, centered around zero\n    k_vals = 2 * np.pi * np.fft.fftfreq(L)\n    kx_grid, ky_grid = np.meshgrid(k_vals, k_vals)\n\n    # Clean dispersion relation\n    energies_k = -2 * t * (np.cos(kx_grid) + np.cos(ky_grid))\n\n    # Find k-points on the Fermi surface\n    fermi_surface_mask = np.abs(energies_k - E_F) < eps_k\n    \n    if not np.any(fermi_surface_mask):\n        raise ValueError(\"No states found on the Fermi surface for clean system.\")\n    \n    k_fs_x = kx_grid[fermi_surface_mask]\n    k_fs_y = ky_grid[fermi_surface_mask]\n\n    # Calculate average Fermi velocity and wavevector magnitudes\n    v_magnitudes = 2 * t * np.sqrt(np.sin(k_fs_x)**2 + np.sin(k_fs_y)**2)\n    k_magnitudes = np.sqrt(k_fs_x**2 + k_fs_y**2)\n    vF = np.mean(v_magnitudes)\n    kF = np.mean(k_magnitudes)\n\n    # Calculate clean Density of States N0_EF using k-space states\n    N_win_clean = np.sum(np.abs(energies_k - E_F) <= delta_E)\n    # DOS per unit area (a=1) per unit energy is N_win / (Area * 2*dE)\n    N0_EF = N_win_clean / (N * 2.0 * delta_E)\n\n    return vF, kF, N0_EF\n\ndef run_simulation_for_w(W, L, t, eta, delta_E, k_thr, r_thr, clean_props):\n    \"\"\"\n    Performs the simulation and analysis for a single disorder strength W.\n    \"\"\"\n    N = L * L\n    E_F = 0.0\n    vF, kF, N0_EF = clean_props\n\n    # --- Construct Hamiltonian and Current Operator ---\n    rows = np.arange(N)\n    idx_grid = rows.reshape((L, L))\n    \n    # Hopping matrix H0 using row-major indexing (i = y*L + x)\n    right_neighbors = np.roll(idx_grid, -1, axis=1).ravel()\n    down_neighbors = np.roll(idx_grid, -1, axis=0).ravel()\n    \n    H0 = np.zeros((N, N), dtype=float)\n    H0[rows, right_neighbors] = -t\n    H0[rows, down_neighbors] = -t\n    H0 = H0 + H0.T\n\n    # Current operator Jx for the x direction (axis=1 in this indexing)\n    # <r'|J|r''> -> J_r',r''. J is anti-hermitian: J_r+x,r = it; J_r,r+x = -it\n    Jx = np.zeros((N, N), dtype=np.complex128)\n    Jx[right_neighbors, rows] = 1j * t\n    Jx[rows, right_neighbors] = -1j * t\n\n    # --- Disordered System Calculation ---\n    V_disorder = np.random.uniform(-W / 2.0, W / 2.0, N)\n    H = H0 + np.diag(V_disorder)\n\n    eigenvalues, eigenvectors = np.linalg.eigh(H)\n\n    # --- Calculate Numerical Conductivity (Kubo-Greenwood) ---\n    Jx_eig_basis = eigenvectors.T.conj() @ Jx @ eigenvectors\n    delta_factors = (1.0 / np.pi) * eta / ((eigenvalues - E_F)**2 + eta**2)\n    \n    # Efficiently compute sigma = (pi/N) * Sum_{n,m} |J_nm|^2 delta_n delta_m\n    sum_val = np.einsum('n,m,nm->', delta_factors, delta_factors, np.abs(Jx_eig_basis)**2)\n    sigma_num = (np.pi / N) * sum_val\n\n    # --- Calculate Theoretical Quantities ---\n    N_win = np.sum(np.abs(eigenvalues - E_F) <= delta_E)\n    N_EF = N_win / (N * 2.0 * delta_E)\n\n    var_V = W**2 / 12.0\n    if N0_EF < 1e-15 or var_V < 1e-15:\n        # Ballistic limit where scattering time is infinite. WL theory is invalid.\n        return False\n    \n    tau_e = 1.0 / (2.0 * np.pi * var_V * N0_EF)\n    D = 0.5 * vF**2 * tau_e\n    sigma_drude = N_EF * D\n\n    ell_e = vF * tau_e\n    L_phi = L  # As per problem statement\n    arg_log = L_phi / ell_e\n    \n    if arg_log <= 1.0: # Failsafe for ballistic/crossover where log is not positive\n        delta_sigma_wl = np.inf # Mark as invalid\n    else:\n        # Corrected WL formula prefactor for 2D spinful electrons\n        delta_sigma_wl = -(1.0 / (2 * np.pi**2)) * np.log(arg_log)\n\n    i_r_param = kF * ell_e\n\n    # --- Apply Decision Rule ---\n    delta_sigma_num = sigma_num - sigma_drude\n\n    is_ir_ok = i_r_param > k_thr\n\n    rel_error_num = np.abs(delta_sigma_num - delta_sigma_wl)\n    rel_error_den = np.max([1e-12, np.abs(delta_sigma_wl)])\n    rel_error = rel_error_num / rel_error_den\n    is_rel_error_ok = rel_error < r_thr\n\n    is_reliable = is_ir_ok and is_rel_error_ok\n\n    return is_reliable\n\ndef solve():\n    \"\"\"\n    Main function to run the complete analysis for the specified test suite.\n    \"\"\"\n    # Define the fixed parameters from the problem statement.\n    L = 18\n    t = 1.0\n    E_F = 0.0\n    eta = 0.05\n    eps_k = 0.05\n    delta_E = 0.2\n    k_thr = 5.0\n    r_thr = 0.5\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.5, 2.0, 3.5, 6.0]\n\n    # Set a random seed for reproducible disorder realizations\n    np.random.seed(42)\n    \n    # Pre-calculate clean system properties once\n    clean_props = calculate_clean_properties(L, t, E_F, eps_k, delta_E)\n\n    results = []\n    for W in test_cases:\n        is_reliable = run_simulation_for_w(W, L, t, eta, delta_E, k_thr, r_thr, clean_props)\n        results.append(is_reliable)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3024137"}]}