{"hands_on_practices": [{"introduction": "Before delving into the complexities of twisted bilayers, it's essential to master the electronic properties of a single graphene sheet. This practice guides you through the fundamental derivation of graphene's low-energy effective Hamiltonian, starting from a simple tight-binding model [@problem_id:3022822]. By linearizing the band structure near the Brillouin zone corners, you will uncover the celebrated Dirac cones and derive an expression for the Fermi velocity, $v_F$, providing a cornerstone for understanding the kinetic energy term in the continuum model of twisted bilayer graphene.", "problem": "Consider a single-layer graphene sheet whose low-energy band structure underlies the continuum description of Twisted Bilayer Graphene (TBG). Let the honeycomb lattice be formed by two triangular sublattices, denoted as sublattice $\\mathrm{A}$ and sublattice $\\mathrm{B}$. Each lattice site hosts one $p_{z}$ orbital, and only nearest-neighbor hopping is included with real amplitude $t>0$. Let $a_{cc}$ denote the carbon–carbon bond length, i.e., the nearest-neighbor distance within the honeycomb lattice. Work in two dimensions with crystal momentum $\\boldsymbol{k}=(k_{x},k_{y})$.\n\nStarting from the nearest-neighbor tight-binding Hamiltonian in second quantized form and constructing the Bloch Hamiltonian in the $\\{\\mathrm{A},\\mathrm{B}\\}$ sublattice basis, derive the effective low-energy Hamiltonian near a Brillouin-zone corner $\\boldsymbol{K}$ by linearizing in the small deviation $\\boldsymbol{q}=\\boldsymbol{k}-\\boldsymbol{K}$. Identify the Dirac structure in terms of Pauli matrices acting on the sublattice degree of freedom and compute the Fermi velocity $v_{F}$ solely in terms of $t$, $a_{cc}$, and the reduced Planck constant $\\hbar$. Express your final answer for $v_{F}$ as a closed-form analytic expression; no numerical evaluation and no units are required in the final expression.", "solution": "The problem asks for the derivation of the Fermi velocity, $v_F$, in single-layer graphene from a nearest-neighbor tight-binding model. The derivation proceeds in several steps: construction of the Bloch Hamiltonian, identification of the low-energy points in the Brillouin zone (the Dirac points), and linearization of the Hamiltonian around these points to extract the Fermi velocity.\n\nFirst, we define the geometry of the honeycomb lattice. It consists of two interpenetrating triangular sublattices, A and B. We place an atom of sublattice A at the origin of our coordinate system. Its three nearest neighbors, all on sublattice B, are located at positions given by the vectors $\\boldsymbol{\\delta}_j$. A convenient and symmetric choice for these vectors, given a carbon-carbon distance of $a_{cc}$, is:\n$$\n\\boldsymbol{\\delta}_1 = a_{cc}(1, 0)\n$$\n$$\n\\boldsymbol{\\delta}_2 = a_{cc}\\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)\n$$\n$$\n\\boldsymbol{\\delta}_3 = a_{cc}\\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)\n$$\nNote that $\\sum_{j=1}^3 \\boldsymbol{\\delta}_j = \\boldsymbol{0}$.\n\nThe tight-binding Hamiltonian, considering only nearest-neighbor hopping with amplitude $t$, is given in second quantization as:\n$$\nH = -t \\sum_{\\langle i, j \\rangle} (c_i^\\dagger c_j + \\text{h.c.})\n$$\nwhere $\\langle i, j \\rangle$ denotes a sum over nearest-neighbor pairs of sites. Since nearest neighbors of an A-site are always B-sites, we can write this explicitly in terms of sublattice operators $a_{\\boldsymbol{R}}$ and $b_{\\boldsymbol{R'}}$ which annihilate an electron on an A-site at position $\\boldsymbol{R}$ and a B-site at $\\boldsymbol{R'}$, respectively.\n$$\nH = -t \\sum_{\\boldsymbol{R} \\in A} \\sum_{j=1}^3 (a_{\\boldsymbol{R}}^\\dagger b_{\\boldsymbol{R}+\\boldsymbol{\\delta}_j} + b_{\\boldsymbol{R}+\\boldsymbol{\\delta}_j}^\\dagger a_{\\boldsymbol{R}})\n$$\nWe perform a Fourier transform to momentum space for the operators on each sublattice:\n$$\na_{\\boldsymbol{R}} = \\frac{1}{\\sqrt{N}} \\sum_{\\boldsymbol{k}} e^{i\\boldsymbol{k} \\cdot \\boldsymbol{R}} a_{\\boldsymbol{k}}\n$$\n$$\nb_{\\boldsymbol{R}+\\boldsymbol{\\delta}_j} = \\frac{1}{\\sqrt{N}} \\sum_{\\boldsymbol{k}} e^{i\\boldsymbol{k} \\cdot (\\boldsymbol{R}+\\boldsymbol{\\delta}_j)} b_{\\boldsymbol{k}}\n$$\nwhere $N$ is the number of unit cells and $\\boldsymbol{k}=(k_x, k_y)$ is the crystal momentum. Substituting these into the Hamiltonian and using the identity $\\sum_{\\boldsymbol{R}} e^{i(\\boldsymbol{k'}-\\boldsymbol{k})\\cdot\\boldsymbol{R}} = N \\delta_{\\boldsymbol{k},\\boldsymbol{k'}}$, we obtain the Hamiltonian in momentum space:\n$$\nH = \\sum_{\\boldsymbol{k}}\n\\begin{pmatrix} a_{\\boldsymbol{k}}^\\dagger & b_{\\boldsymbol{k}}^\\dagger \\end{pmatrix}\n\\mathcal{H}(\\boldsymbol{k})\n\\begin{pmatrix} a_{\\boldsymbol{k}} \\\\ b_{\\boldsymbol{k}} \\end{pmatrix}\n$$\nThe $2 \\times 2$ matrix $\\mathcal{H}(\\boldsymbol{k})$ is the Bloch Hamiltonian in the $\\{\\mathrm{A}, \\mathrm{B}\\}$ sublattice basis. On-site energies are taken to be zero, so the diagonal elements vanish. The off-diagonal elements connect the two sublattices.\n$$\n\\mathcal{H}(\\boldsymbol{k}) = \\begin{pmatrix} 0 & h(\\boldsymbol{k}) \\\\ h^*(\\boldsymbol{k}) & 0 \\end{pmatrix}\n$$\nwhere the off-diagonal element $h(\\boldsymbol{k})$ is given by:\n$$\nh(\\boldsymbol{k}) = -t \\sum_{j=1}^3 e^{i\\boldsymbol{k} \\cdot \\boldsymbol{\\delta}_j}\n$$\nSubstituting our choice for $\\boldsymbol{\\delta}_j$:\n$$\nh(\\boldsymbol{k}) = -t \\left( e^{ia_{cc}k_x} + e^{ia_{cc}(-\\frac{1}{2}k_x + \\frac{\\sqrt{3}}{2}k_y)} + e^{ia_{cc}(-\\frac{1}{2}k_x - \\frac{\\sqrt{3}}{2}k_y)} \\right)\n$$\n$$\nh(\\boldsymbol{k}) = -t \\left( e^{ia_{cc} k_x} + 2e^{-i\\frac{a_{cc}}{2}k_x} \\cos\\left(\\frac{\\sqrt{3}}{2}a_{cc} k_y\\right) \\right)\n$$\nThe energy eigenvalues of this Hamiltonian are $E(\\boldsymbol{k}) = \\pm |h(\\boldsymbol{k})|$. The valence and conduction bands touch when $E(\\boldsymbol{k})=0$, which requires $h(\\boldsymbol{k})=0$. These points are the Dirac points. The condition $h(\\boldsymbol{k})=0$ implies:\n$$\ne^{i\\frac{3}{2}a_{cc}k_x} = -2\\cos\\left(\\frac{\\sqrt{3}}{2}a_{cc} k_y\\right)\n$$\nSince the left hand side has modulus $1$, we must have $|\\cos(\\frac{\\sqrt{3}}{2}a_{cc} k_y)| = \\frac{1}{2}$. One set of solutions corresponds to the corners of the first Brillouin zone. Let's choose one such Dirac point, denoted $\\boldsymbol{K}$:\n$$\n\\frac{\\sqrt{3}}{2}a_{cc}k_y = \\pm\\frac{\\pi}{3} \\quad \\text{and} \\quad \\frac{3}{2}a_{cc}k_x = \\pm\\pi\n$$\nThis gives a Dirac point at $\\boldsymbol{K} = \\left(\\frac{2\\pi}{3a_{cc}}, \\frac{2\\pi}{3\\sqrt{3}a_{cc}}\\right)$.\n\nNext, we derive the effective low-energy Hamiltonian by linearizing $\\mathcal{H}(\\boldsymbol{k})$ around this point $\\boldsymbol{K}$. We set $\\boldsymbol{k} = \\boldsymbol{K}+\\boldsymbol{q}$, where $\\boldsymbol{q}=(q_x, q_y)$ is a small momentum deviation. The off-diagonal element $h(\\boldsymbol{K}+\\boldsymbol{q})$ is expanded to first order in $\\boldsymbol{q}$:\n$$\nh(\\boldsymbol{K}+\\boldsymbol{q}) \\approx h(\\boldsymbol{K}) + \\boldsymbol{q} \\cdot \\nabla_{\\boldsymbol{k}}h(\\boldsymbol{k})|_{\\boldsymbol{k}=\\boldsymbol{K}}\n$$\nSince $h(\\boldsymbol{K})=0$, we have $h(\\boldsymbol{K}+\\boldsymbol{q}) \\approx q_x \\frac{\\partial h}{\\partial k_x}|_{\\boldsymbol{K}} + q_y \\frac{\\partial h}{\\partial k_y}|_{\\boldsymbol{K}}$. We compute the partial derivatives of $h(\\boldsymbol{k})$:\n$$\n\\frac{\\partial h}{\\partial k_x} = -ia_{cc}t \\left( e^{ia_{cc} k_x} - e^{-i\\frac{a_{cc}}{2}k_x} \\cos\\left(\\frac{\\sqrt{3}}{2}a_{cc} k_y\\right) \\right)\n$$\n$$\n\\frac{\\partial h}{\\partial k_y} = a_{cc}t\\sqrt{3} \\, e^{-i\\frac{a_{cc}}{2}k_x} \\sin\\left(\\frac{\\sqrt{3}}{2}a_{cc} k_y\\right)\n$$\nAt $\\boldsymbol{K} = (\\frac{2\\pi}{3a_{cc}}, \\frac{2\\pi}{3\\sqrt{3}a_{cc}})$, we have $a_{cc}k_x = \\frac{2\\pi}{3}$ and $\\frac{\\sqrt{3}}{2}a_{cc}k_y = \\frac{\\pi}{3}$.\nEvaluating the derivatives at $\\boldsymbol{K}$:\n$$\n\\frac{\\partial h}{\\partial k_x}\\bigg|_{\\boldsymbol{K}} = -ia_{cc}t \\left( e^{i2\\pi/3} - e^{-i\\pi/3}\\cos(\\pi/3) \\right) = -ia_{cc}t \\left( \\left(-\\frac{1}{2}+i\\frac{\\sqrt{3}}{2}\\right) - \\left(\\frac{1}{2}-i\\frac{\\sqrt{3}}{2}\\right)\\frac{1}{2} \\right) = a_{cc}t\\left(\\frac{3\\sqrt{3}}{4} + i\\frac{3}{4}\\right)\n$$\n$$\n\\frac{\\partial h}{\\partial k_y}\\bigg|_{\\boldsymbol{K}} = a_{cc}t\\sqrt{3} \\, e^{-i\\pi/3} \\sin(\\pi/3) = a_{cc}t\\sqrt{3} \\left(\\frac{1}{2}-i\\frac{\\sqrt{3}}{2}\\right)\\frac{\\sqrt{3}}{2} = a_{cc}t\\left(\\frac{3}{4} - i\\frac{3\\sqrt{3}}{4}\\right)\n$$\nThe linearized off-diagonal term is thus:\n$$\nh(\\boldsymbol{K}+\\boldsymbol{q}) \\approx q_x a_{cc}t\\left(\\frac{3\\sqrt{3}}{4} + i\\frac{3}{4}\\right) + q_y a_{cc}t\\left(\\frac{3}{4} - i\\frac{3\\sqrt{3}}{4}\\right)\n$$\nThe low-energy dispersion is given by $E(\\boldsymbol{q}) = \\pm |h(\\boldsymbol{K}+\\boldsymbol{q})|$. We calculate the squared modulus:\n$$\n|h(\\boldsymbol{K}+\\boldsymbol{q})|^2 \\approx \\left| q_x a_{cc}t\\left(\\frac{3\\sqrt{3}}{4} + i\\frac{3}{4}\\right) + q_y a_{cc}t\\left(\\frac{3}{4} - i\\frac{3\\sqrt{3}}{4}\\right) \\right|^2\n$$\nLet $C_x = a_{cc}t(\\frac{3\\sqrt{3}}{4} + i\\frac{3}{4})$ and $C_y = a_{cc}t(\\frac{3}{4} - i\\frac{3\\sqrt{3}}{4})$.\n$|C_x|^2 = (a_{cc}t)^2 ((\\frac{3\\sqrt{3}}{4})^2 + (\\frac{3}{4})^2) = (a_{cc}t)^2 (\\frac{27}{16} + \\frac{9}{16}) = (a_{cc}t)^2 \\frac{36}{16} = \\left(\\frac{3a_{cc}t}{2}\\right)^2$.\n$|C_y|^2 = (a_{cc}t)^2 ((\\frac{3}{4})^2 + (-\\frac{3\\sqrt{3}}{4})^2) = (a_{cc}t)^2 (\\frac{9}{16} + \\frac{27}{16}) = \\left(\\frac{3a_{cc}t}{2}\\right)^2$.\nThe cross-term in the expansion of $|C_x q_x + C_y q_y|^2$ is $2\\text{Re}(C_x C_y^* q_x q_y)$.\n$C_x C_y^* = (a_{cc}t)^2 (\\frac{3\\sqrt{3}}{4} + i\\frac{3}{4})(\\frac{3}{4} + i\\frac{3\\sqrt{3}}{4}) = (a_{cc}t)^2 \\frac{9}{16} (\\sqrt{3}+i)(1+i\\sqrt{3}) = (a_{cc}t)^2 \\frac{9}{16} (4i\\sqrt{3})$. The real part is zero.\n\nThe modulus calculation simplifies to:\n$$\n|h(\\boldsymbol{K}+\\boldsymbol{q})|^2 \\approx |C_x|^2 q_x^2 + |C_y|^2 q_y^2 = \\left(\\frac{3a_{cc}t}{2}\\right)^2 (q_x^2 + q_y^2) = \\left(\\frac{3a_{cc}t}{2}\\right)^2 |\\boldsymbol{q}|^2\n$$\nTaking the square root, we find the magnitude of the linearized off-diagonal element:\n$$\n|h(\\boldsymbol{K}+\\boldsymbol{q})| \\approx \\frac{3a_{cc}t}{2}|\\boldsymbol{q}|\n$$\nThe energy dispersion near the Dirac point $\\boldsymbol{K}$ is therefore linear and isotropic:\n$$\nE(\\boldsymbol{q}) = \\pm \\frac{3a_{cc}t}{2}|\\boldsymbol{q}|\n$$\nThe effective Hamiltonian is a $2\\times 2$ matrix that can be expressed in terms of Pauli matrices $\\boldsymbol{\\sigma}=(\\sigma_x, \\sigma_y)$ operating on the sublattice space. It takes the form of the massless Dirac Hamiltonian in two dimensions, $H_{eff} = \\hbar v_F \\boldsymbol{\\sigma} \\cdot \\boldsymbol{q}'$ for some rotated momentum coordinates $\\boldsymbol{q}'$. The energy spectrum for such a Hamiltonian is $E(\\boldsymbol{q}') = \\pm \\hbar v_F |\\boldsymbol{q}'|$. Since a rotation does not change the magnitude of the momentum vector ($|\\boldsymbol{q}'|=|\\boldsymbol{q}|$), we have:\n$$\nE(\\boldsymbol{q}) = \\pm \\hbar v_F |\\boldsymbol{q}|\n$$\nBy comparing this general form with our derived dispersion relation, we can identify the Fermi velocity $v_F$:\n$$\n\\hbar v_F = \\frac{3a_{cc}t}{2}\n$$\nSolving for $v_F$ yields the final expression:\n$$\nv_F = \\frac{3a_{cc}t}{2\\hbar}\n$$\nThis is the velocity of the massless Dirac fermions that describe the low-energy electronic excitations in single-layer graphene.", "answer": "$$\\boxed{\\frac{3a_{cc}t}{2\\hbar}}$$", "id": "3022822"}, {"introduction": "The defining feature of magic-angle graphene is the emergence of extraordinarily flat electronic bands, which dramatically enhances the role of electron-electron interactions. This exercise puts the renowned Bistritzer–MacDonald continuum model into practice, allowing you to calculate the first magic angle where the renormalized Fermi velocity vanishes [@problem_id:3022739]. By applying a perturbative analysis, you will develop a concrete understanding of how the interplay between single-layer kinetics and interlayer tunneling gives rise to this pivotal condition for strong correlation physics.", "problem": "Twisted Bilayer Graphene (TBG) at small twist angle $\\theta$ can be described by two massless Dirac Hamiltonians, one for each layer, coupled by a spatially modulated interlayer tunneling. In the Bistritzer–MacDonald continuum model, the moiré scale is set by the wavevector $k_{\\theta} = 2|\\mathbf{K}|\\sin(\\theta/2)$, where $|\\mathbf{K}| = 4\\pi/(3a_{lat})$ and $a_{lat}$ is the monolayer graphene lattice constant. The interlayer tunneling is dominated by three symmetry-related processes characterized by amplitudes $w_0$ (intra-sublattice, often labeled AA) and $w_1$ (inter-sublattice, often labeled AB/BA). The low-energy Dirac velocity $v^{*}(\\theta)$ at the moiré Brillouin-zone center is renormalized by virtual interlayer scattering, and the first “magic angle” is defined operationally as the smallest $\\theta$ at which $v^{*}(\\theta)=0$.\n\nStarting from the continuum Dirac Hamiltonian for each layer and treating the interlayer tunneling perturbatively to second order in the dimensionless coupling $\\alpha = w_1/(\\hbar v_F k_{\\theta})$, derive the leading-order condition for $v^{*}(\\theta)=0$ in terms of a critical $\\alpha_{\\mathrm{c}}$ and solve for the corresponding $\\theta$. Then, using the parameter values $v_F = 1.00 \\times 10^{6}$ m/s, $w_1 = 0.110$ eV, $a_{lat} = 0.246 \\times 10^{-9}$ m, and $\\hbar = 6.582 \\times 10^{-16}$ eV·s, compute the numerical value of the first magic angle. Express your final angle in degrees and round your answer to four significant figures.\n\nFinally, discuss qualitatively the sensitivity of the solution to the ratio $w_0/w_1$ and to relaxation effects that reduce $w_0$ relative to $w_1$, explaining how these enter the leading-order condition and how they shift the estimated magic angle.\n\nYour final reported value must be a single number. State the angle in degrees in your final answer (do not include units inside the box).", "solution": "The problem asks for the derivation and calculation of the first magic angle in twisted bilayer graphene (TBG) based on the continuum model.\n\nThe key physical quantities and relations given are:\n- Moiré wavevector: $k_{\\theta} = 2|\\mathbf{K}|\\sin(\\theta/2)$, where $\\theta$ is the twist angle.\n- Monolayer reciprocal lattice vector magnitude: $|\\mathbf{K}| = 4\\pi/(3a_{lat})$, with $a_{lat}$ being the monolayer lattice constant.\n- Interlayer tunneling amplitudes: $w_0$ (intra-sublattice) and $w_1$ (inter-sublattice).\n- Renormalized Fermi velocity at the moiré Brillouin zone center: $v^{*}(\\theta)$.\n- Definition of the first magic angle: The smallest $\\theta > 0$ for which $v^{*}(\\theta)=0$.\n- Dimensionless coupling parameter: $\\alpha = w_1/(\\hbar v_F k_{\\theta})$.\n- The derivation is to be performed using second-order perturbation theory.\n\nFor small angles $\\theta$, the moiré wavevector can be approximated as $k_{\\theta} \\approx 2|\\mathbf{K}|(\\theta/2) = |\\mathbf{K}|\\theta$.\n\nThe low-energy electronic properties of TBG near the charge neutrality point can be described by an effective Hamiltonian. In the continuum model, the Dirac cones of the two graphene layers are coupled by the moiré interlayer potential. Treating this coupling as a perturbation on the kinetic energy of the individual layers, one can derive an effective Hamiltonian for the low-energy bands. The velocity of the charge carriers is renormalized by virtual scattering processes between the two layers mediated by the moiré potential.\n\nThe problem specifies using second-order perturbation theory. The standard result from this approach for the renormalized velocity $v^*$ at the moiré $\\Gamma$ point, in the chiral limit ($w_0=0$), is given by:\n$$ \\frac{v^{*}(\\theta)}{v_F} = 1 - 3\\alpha^2 $$\nThe factor of $3$ arises from the three equivalent scattering wavevectors that connect the Dirac points of the two layers' Brillouin zones. The term $3\\alpha^2$ is the second-order correction to the velocity.\n\nThe magic angle is defined by the condition $v^{*}(\\theta)=0$. Applying this to the perturbative result gives:\n$$ 1 - 3\\alpha_c^2 = 0 $$\nwhere $\\alpha_c$ is the critical value of the coupling parameter. Solving for $\\alpha_c$ yields:\n$$ \\alpha_c = \\frac{1}{\\sqrt{3}} $$\nThis provides the leading-order condition for the magic angle.\n\nNow, we solve for the angle $\\theta$ that satisfies this condition. We substitute the definitions of $\\alpha$, $k_{\\theta}$, and $|\\mathbf{K}|$ into the equation $\\alpha = \\alpha_c$.\n$$ \\frac{w_1}{\\hbar v_F k_{\\theta}} = \\frac{1}{\\sqrt{3}} $$\nUsing the small angle approximation $k_{\\theta} \\approx |\\mathbf{K}|\\theta = \\frac{4\\pi}{3a_{lat}}\\theta$, we get:\n$$ \\frac{w_1}{\\hbar v_F \\left(\\frac{4\\pi}{3a_{lat}}\\theta\\right)} = \\frac{1}{\\sqrt{3}} $$\nSolving for the magic angle, $\\theta_m$:\n$$ \\theta_m = \\frac{\\sqrt{3} w_1}{\\hbar v_F \\left(\\frac{4\\pi}{3a_{lat}}\\right)} = \\frac{3\\sqrt{3} a_{lat} w_1}{4\\pi \\hbar v_F} $$\nThis is the analytical expression for the first magic angle in radians, within the specified model and approximations.\n\nNext, we compute the numerical value using the provided parameters:\n- $v_F = 1.00 \\times 10^{6}$ m/s\n- $w_1 = 0.110$ eV\n- $a_{lat} = 0.246 \\times 10^{-9}$ m\n- $\\hbar = 6.582 \\times 10^{-16}$ eV·s\n\nSubstituting these values into the expression for $\\theta_m$:\n$$ \\theta_m = \\frac{3\\sqrt{3} (0.246 \\times 10^{-9} \\, \\text{m}) (0.110 \\, \\text{eV})}{4\\pi (6.582 \\times 10^{-16} \\, \\text{eV·s}) (1.00 \\times 10^6 \\, \\text{m/s})} $$\nThe units (m·eV)/(eV·s·m/s) cancel, leaving a dimensionless result (radians), as expected.\n$$ \\theta_m \\approx \\frac{3 \\times 1.73205 \\times 0.246 \\times 10^{-9} \\times 0.110}{4 \\times 3.14159 \\times 6.582 \\times 10^{-16} \\times 1.00 \\times 10^6} \\approx \\frac{1.40403 \\times 10^{-10}}{8.27104 \\times 10^{-9}} \\approx 0.016975 \\, \\text{rad} $$\nTo convert this to degrees, we multiply by $180/\\pi$:\n$$ \\theta_m (\\text{deg}) = 0.016975 \\times \\frac{180}{\\pi} \\approx 0.9725^{\\circ} $$\nRounding to four significant figures, the first magic angle is $0.9725^{\\circ}$.\n\nFinally, a qualitative discussion on the sensitivity to the ratio $w_0/w_1$ and lattice relaxation is required.\n\nThe calculation above assumed the chiral limit, where the intra-sublattice tunneling $w_0$ is zero. If $w_0 \\neq 0$, the tunneling matrices become more complex. Within the Bistritzer-MacDonald model, a non-zero $w_0$ (typically $w_0 < w_1$) makes the velocity renormalization less effective. That is, for a given angle $\\theta$, the velocity $v^*$ is less suppressed when $w_0/w_1$ is larger. To achieve the flat-band condition ($v^*=0$), a stronger effective interlayer coupling is required. This corresponds to a larger value of the dimensionless parameter $\\alpha = w_1/(\\hbar v_F k_\\theta)$. Since $\\alpha$ is inversely proportional to $k_\\theta$ (and thus to $\\theta$ for small angles), a larger $\\alpha$ necessitates a smaller twist angle $\\theta$. Therefore, the leading-order condition is modified, and a larger ratio of $w_0/w_1$ is predicted to decrease the magic angle.\n\nLattice relaxation refers to the reconstruction of the atomic positions away from the ideal, rigid-lattice configuration. In TBG, relaxation leads to the expansion of energetically favorable AB/BA-stacked regions and the contraction of unfavorable AA-stacked regions. This contraction of AA regions increases the local interlayer distance, which exponentially suppresses the corresponding tunneling amplitude $w_0$. The AB/BA tunneling $w_1$ is less affected. The primary consequence of lattice relaxation is thus a significant reduction in the ratio $w_0/w_1$, driving the system closer to the chiral limit ($w_0/w_1 \\approx 0$). Based on the argument above, a smaller $w_0/w_1$ ratio makes velocity renormalization more efficient, meaning a smaller value of $\\alpha$ is required to achieve $v^*=0$. This, in turn, implies a larger moiré wavelength and therefore a larger magic angle $\\theta$. In summary, lattice relaxation is expected to increase the value of the first magic angle compared to what would be predicted for an unrelaxed lattice with its larger intrinsic $w_0/w_1$ ratio.", "answer": "$$\\boxed{0.9725}$$", "id": "3022739"}, {"introduction": "With the kinetic energy quenched in the flat bands of magic-angle graphene, electron-electron-interactions take center stage, leading to a landscape of competing correlated ground states. This computational problem challenges you to explore this landscape using mean-field theory, a foundational tool for studying many-body physics [@problem_id:3022777]. By comparing the energies of different ansatz states, such as flavor-polarized and intervalley-coherent phases, you will gain hands-on insight into how electronic order emerges from interactions and its dependence on parameters like electron filling $\\nu$ and coupling constants $g_{\\mathrm{H}}$, $g_{\\mathrm{X}}$, and $J$.", "problem": "Consider a simplified mean-field model for twisted bilayer graphene near the first so-called magic angle, where the narrow moiré bands can be approximated as flat and described by an approximate special unitary group of degree $4$ ($\\text{SU}(4)$) flavor symmetry comprising two valleys and two spins. Denote the four flavors by indices $\\alpha \\in \\{1,2,3,4\\}$ corresponding to $(\\tau,\\sigma)$ where $\\tau \\in \\{K,K'\\}$ is the valley and $\\sigma \\in \\{\\uparrow,\\downarrow\\}$ is the spin. Assume a single flat band per flavor per moiré unit cell at zero temperature. Let $n_{\\alpha} \\in [0,1]$ be the mean occupation of flavor $\\alpha$ per cell, and the total filling per cell be $\\nu = \\sum_{\\alpha} n_{\\alpha} \\in [0,4]$. All quantities in this problem are to be expressed in dimensionless units where the single-particle bandwidth is set to $1$.\n\nThe interaction Hamiltonian is flavor-symmetric and comprises three parts: a Hartree density-density repulsion, an $\\text{SU}(4)$-symmetric exchange (Fock) term, and an intervalley coherence (valley-exchange) term. In the Hartree-Fock approximation, the mean-field energy per cell can be expressed in terms of one-body density matrix elements. Denote by $n_{\\tau\\sigma}$ the occupation of valley $\\tau \\in \\{K,K'\\}$ with spin $\\sigma \\in \\{\\uparrow,\\downarrow\\}$, and by $\\Delta_{\\sigma} = \\langle c^{\\dagger}_{K\\sigma} c_{K'\\sigma} \\rangle$ the intervalley coherence order parameter for spin $\\sigma$. The total energy per cell takes the form\n$$\nE = \\frac{g_{\\mathrm{H}}}{2}\\,\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\sum_{\\alpha=1}^{4} n_{\\alpha}^2 \\;-\\; J \\sum_{\\sigma=\\uparrow,\\downarrow} |\\Delta_{\\sigma}|^2,\n$$\nwhere $g_{\\mathrm{H}} > 0$ is the Hartree coefficient, $g_{\\mathrm{X}} < 0$ is the exchange coefficient, and $J > 0$ is the intervalley coherence coupling. At zero temperature, and for a two-level valley subspace at fixed spin $\\sigma$, positivity and normalization of the $2\\times 2$ one-body density matrix imply the bound\n$$\n|\\Delta_{\\sigma}| \\le \\min\\!\\left(\\frac{n_{\\sigma}}{2},\\,\\frac{2 - n_{\\sigma}}{2}\\right),\n$$\nwhere $n_{\\sigma} = n_{K\\sigma} + n_{K'\\sigma} \\in [0,2]$ is the total occupancy in the valley subspace of spin $\\sigma$. This bound is saturated when the valley occupations are equal within each spin and the occupied state is a coherent superposition in the valley subspace, and it vanishes when the valley subspace is either empty ($n_{\\sigma}=0$) or fully filled ($n_{\\sigma}=2$).\n\nTwo candidate mean-field phases are to be compared:\n\n1. A flavor-polarized phase (FP), in which particles accumulate into as few flavors as allowed by the filling constraint. In this phase $|\\Delta_{\\sigma}| = 0$ for both spins. Under the constraint $0 \\le n_{\\alpha} \\le 1$, maximal flavor polarization at fixed $\\nu$ is achieved by filling one flavor completely before starting to fill the next, yielding a piecewise occupation configuration that maximizes $\\sum_{\\alpha} n_{\\alpha}^2$.\n\n2. An intervalley-coherent phase (IVC), in which spins are unpolarized and valley occupations are equal within each spin, saturating the bound for $|\\Delta_{\\sigma}|$. In this phase the flavor occupations are equal across all four flavors, $n_{\\alpha} = \\nu/4$, and the coherence per spin is $|\\Delta_{\\sigma}| = \\min\\!\\left(\\frac{n_{\\sigma}}{2},\\,\\frac{2 - n_{\\sigma}}{2}\\right)$ with $n_{\\sigma} = \\nu/2$.\n\nDefine the flavor polarization order parameter\n$$\nM = \\left(\\sum_{\\alpha=1}^{4} n_{\\alpha}^2\\right) - \\frac{\\nu^2}{4},\n$$\nwhich measures deviation from equal flavor occupation ($M=0$ indicates perfectly equal flavor occupation), and the total intervalley coherence order parameter\n$$\n|\\Delta| = \\sqrt{|\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2}.\n$$\n\nTask. Implement a program that, for each specified test case, computes the mean-field energies $E_{\\mathrm{FP}}$ and $E_{\\mathrm{IVC}}$ of the two ansatz phases using the definitions above, identifies the phase with the lower energy as the ground state (breaking ties in favor of the flavor-polarized phase), and outputs for each test case:\n- The phase identifier as an integer ($0$ for FP, $1$ for IVC).\n- The corresponding flavor polarization order parameter $M$.\n- The corresponding total intervalley coherence order parameter $|\\Delta|$.\n\nYour program should treat the Hartree contribution $\\frac{g_{\\mathrm{H}}}{2} \\nu^2$ consistently but note that it does not affect the phase competition at fixed $\\nu$ because it is independent of flavor distribution.\n\nUse the following test suite of parameter sets $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J)$ in dimensionless units:\n- Test $1$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (0, 1, -0.5, 0.1)$.\n- Test $2$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (1, 1, -0.5, 0.1)$.\n- Test $3$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (2, 1, -0.2, 0.5)$.\n- Test $4$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (3.2, 1, -0.8, 0.1)$.\n- Test $5$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (2, 1, -0.8, 1.2)$.\n- Test $6$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (4, 1, -0.5, 0.5)$.\n\nFinal output format. Your program should produce a single line of output containing the results for the six test cases as a comma-separated list of lists enclosed in square brackets. Each inner list must be of the form $[\\text{phase\\_id}, M, |\\Delta|]$, with numerical values expressed as Python floats or integers. For example, an output line has the form\n$[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$.", "solution": "The problem requires a comparison of the mean-field energies of two candidate ground states for a simplified model of twisted bilayer graphene: a flavor-polarized (FP) phase and an intervalley-coherent (IVC) phase. The ground state is determined by the lower energy, with ties broken in favor of the FP phase. For the determined ground state, we must compute the flavor polarization order parameter $M$ and the total intervalley coherence order parameter $|\\Delta|$.\n\nThe total energy per moiré unit cell is given by\n$$\nE = \\frac{g_{\\mathrm{H}}}{2}\\,\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\sum_{\\alpha=1}^{4} n_{\\alpha}^2 \\;-\\; J \\sum_{\\sigma=\\uparrow,\\downarrow} |\\Delta_{\\sigma}|^2\n$$\nwhere $\\nu$ is the total filling, $g_{\\mathrm{H}}$, $g_{\\mathrm{X}}$, and $J$ are coupling constants, $n_{\\alpha}$ are the flavor occupations, and $|\\Delta_{\\sigma}|$ are the spin-dependent intervalley coherence amplitudes. The Hartree term $\\frac{g_{\\mathrm{H}}}{2}\\nu^2$ is identical for both phases at a fixed filling $\\nu$ and thus does not influence the phase competition. However, it must be included in the total energy calculation.\n\nWe will now derive the specific expressions for the energy and order parameters for each of the two phases.\n\n**1. Flavor-Polarized (FP) Phase**\n\nIn the FP phase, particles occupy the minimum number of flavors possible. The occupations $n_{\\alpha}$ are chosen to maximize the term $\\sum_{\\alpha} n_{\\alpha}^2$. For a total filling $\\nu \\in [0, 4]$, this is achieved by filling $\\lfloor\\nu\\rfloor$ flavors completely (occupation $1$), one flavor partially with the remainder $\\nu - \\lfloor\\nu\\rfloor$, and leaving the other $4 - \\lfloor\\nu\\rfloor - 1$ flavors empty.\n\n- **Flavor Occupations ($n_{\\alpha}$)**: Let $k = \\lfloor\\nu\\rfloor$. The set of four flavor occupations is $\\{\\underbrace{1, \\dots, 1}_{k \\text{ times}}, \\nu - k, \\underbrace{0, \\dots, 0}_{3-k \\text{ times}}\\}$. For $\\nu=4$, this correctly gives $\\{1,1,1,1\\}$.\n\n- **Sum of Squared Occupations ($\\sum n_{\\alpha}^2$)**: Based on these occupations, the sum is\n$$\n\\sum_{\\alpha=1}^{4} n_{\\alpha}^2 = k \\cdot 1^2 + (\\nu-k)^2 = \\lfloor\\nu\\rfloor + (\\nu - \\lfloor\\nu\\rfloor)^2.\n$$\n\n- **Intervalley Coherence ($|\\Delta_{\\sigma}|$)**: By definition of the FP phase, the intervalley coherence is zero: $|\\Delta_{\\sigma}| = 0$ for $\\sigma \\in \\{\\uparrow,\\downarrow\\}$.\n\n- **Energy ($E_{\\mathrm{FP}}$)**: Substituting these into the general energy formula gives\n$$\nE_{\\mathrm{FP}}(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = \\frac{g_{\\mathrm{H}}}{2}\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\left[ \\lfloor\\nu\\rfloor + (\\nu - \\lfloor\\nu\\rfloor)^2 \\right].\n$$\n\n- **Flavor Polarization ($M_{\\mathrm{FP}}$)**: The order parameter $M$ is defined as $M = \\left(\\sum n_{\\alpha}^2\\right) - \\frac{\\nu^2}{4}$. For the FP phase:\n$$\nM_{\\mathrm{FP}} = \\left[ \\lfloor\\nu\\rfloor + (\\nu - \\lfloor\\nu\\rfloor)^2 \\right] - \\frac{\\nu^2}{4}.\n$$\n\n- **Total Coherence ($|\\Delta|_{\\mathrm{FP}}$)**: The total coherence parameter $|\\Delta| = \\sqrt{|\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2}$ is\n$$\n|\\Delta|_{\\mathrm{FP}} = \\sqrt{0^2 + 0^2} = 0.\n$$\n\n**2. Intervalley-Coherent (IVC) Phase**\n\nIn the IVC phase, flavor occupations are distributed equally, spins are unpolarized, and intervalley coherence is maximized.\n\n- **Flavor Occupations ($n_{\\alpha}$)**: The occupations are equal for all four flavors: $n_{\\alpha} = \\nu/4$ for $\\alpha \\in \\{1,2,3,4\\}$.\n\n- **Sum of Squared Occupations ($\\sum n_{\\alpha}^2$)**:\n$$\n\\sum_{\\alpha=1}^{4} n_{\\alpha}^2 = 4 \\left(\\frac{\\nu}{4}\\right)^2 = \\frac{\\nu^2}{4}.\n$$\n\n- **Intervalley Coherence ($|\\Delta_{\\sigma}|$)**: The coherence for each spin channel saturates the bound $|\\Delta_{\\sigma}| \\le \\min\\left(\\frac{n_{\\sigma}}{2},\\,\\frac{2 - n_{\\sigma}}{2}\\right)$. With unpolarized spins, the total filling per spin is $n_{\\sigma} = n_{K\\sigma} + n_{K'\\sigma} = \\nu/4 + \\nu/4 = \\nu/2$. Therefore,\n$$\n|\\Delta_{\\uparrow}| = |\\Delta_{\\downarrow}| = \\min\\left(\\frac{\\nu/2}{2},\\, \\frac{2-\\nu/2}{2}\\right) = \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right).\n$$\nThis expression evaluates to $\\nu/4$ for $\\nu \\le 2$ and $1-\\nu/4$ for $\\nu > 2$.\n\n- **Energy ($E_{\\mathrm{IVC}}$)**: Substituting into the energy formula:\n$$\nE_{\\mathrm{IVC}}(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = \\frac{g_{\\mathrm{H}}}{2}\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\left(\\frac{\\nu^2}{4}\\right) - J \\left[ |\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2 \\right]\n$$\n$$\nE_{\\mathrm{IVC}} = \\frac{g_{\\mathrm{H}}}{2}\\nu^2 + \\frac{g_{\\mathrm{X}}}{8}\\nu^2 - 2J \\left[ \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right) \\right]^2.\n$$\n\n- **Flavor Polarization ($M_{\\mathrm{IVC}}$)**:\n$$\nM_{\\mathrm{IVC}} = \\left(\\frac{\\nu^2}{4}\\right) - \\frac{\\nu^2}{4} = 0.\n$$\nThis is expected, as the IVC state has uniform flavor occupations.\n\n- **Total Coherence ($|\\Delta|_{\\mathrm{IVC}}$)**:\n$$\n|\\Delta|_{\\mathrm{IVC}} = \\sqrt{|\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2} = \\sqrt{2 \\left[ \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right) \\right]^2} = \\sqrt{2} \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right).\n$$\n\n**Computational Logic**\n\nFor each test case $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J)$:\n1.  Calculate $E_{\\mathrm{FP}}$, $M_{\\mathrm{FP}}$, and $|\\Delta|_{\\mathrm{FP}}$ using the derived formulas.\n2.  Calculate $E_{\\mathrm{IVC}}$, $M_{\\mathrm{IVC}}$, and $|\\Delta|_{\\mathrm{IVC}}$ using their derived formulas.\n3.  Compare the energies. If $E_{\\mathrm{FP}} \\le E_{\\mathrm{IVC}}$, the ground state is FP (phase ID $0$). The output is $[0, M_{\\mathrm{FP}}, |\\Delta|_{\\mathrm{FP}}]$.\n4.  Otherwise, if $E_{\\mathrm{IVC}} < E_{\\mathrm{FP}}$, the ground state is IVC (phase ID $1$). The output is $[1, M_{\\mathrm{IVC}}, |\\Delta|_{\\mathrm{IVC}}]$.\n\nThis procedure is implemented for each test case to generate the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the ground state properties for two competing phases in a \n    simplified model of twisted bilayer graphene.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (nu, g_H, g_X, J)\n    test_cases = [\n        (0.0, 1.0, -0.5, 0.1),\n        (1.0, 1.0, -0.5, 0.1),\n        (2.0, 1.0, -0.2, 0.5),\n        (3.2, 1.0, -0.8, 0.1),\n        (2.0, 1.0, -0.8, 1.2),\n        (4.0, 1.0, -0.5, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        nu, g_H, g_X, J = case\n        \n        # --- Flavor-Polarized (FP) Phase Calculation ---\n        k = np.floor(nu)\n        \n        # Sum of squared occupations\n        sum_n_sq_fp = k + (nu - k)**2\n        \n        # Energy of the FP phase\n        # The coherence term is zero by definition\n        E_fp = (g_H / 2.0) * nu**2 + (g_X / 2.0) * sum_n_sq_fp\n        \n        # Flavor polarization order parameter M for FP phase\n        M_fp = sum_n_sq_fp - (nu**2 / 4.0)\n        \n        # Total intervalley coherence |Delta| for FP phase is 0\n        Delta_fp = 0.0\n\n        # --- Intervalley-Coherent (IVC) Phase Calculation ---\n        \n        # Sum of squared occupations\n        sum_n_sq_ivc = nu**2 / 4.0\n        \n        # Intervalley coherence amplitude per spin\n        delta_sigma_ivc = min(nu / 4.0, 1.0 - nu / 4.0)\n        \n        # Sum of squared coherence amplitudes\n        sum_delta_sq_ivc = 2.0 * delta_sigma_ivc**2\n        \n        # Energy of the IVC phase\n        E_ivc = (g_H / 2.0) * nu**2 + (g_X / 2.0) * sum_n_sq_ivc - J * sum_delta_sq_ivc\n        \n        # Flavor polarization order parameter M for IVC phase is 0\n        M_ivc = 0.0\n        \n        # Total intervalley coherence |Delta| for IVC phase\n        Delta_ivc = np.sqrt(2.0) * delta_sigma_ivc\n\n        # --- Phase Competition ---\n        # Compare energies to find the ground state.\n        # Tie-breaking rule: favor FP phase if energies are equal.\n        if E_fp = E_ivc:\n            # Ground state is Flavor-Polarized\n            phase_id = 0\n            M_gs = M_fp\n            Delta_gs = Delta_fp\n        else:\n            # Ground state is Intervalley-Coherent\n            phase_id = 1\n            M_gs = M_ivc\n            Delta_gs = Delta_ivc\n            \n        results.append([phase_id, M_gs, Delta_gs])\n\n    # Final print statement in the exact required format.\n    # The use of map(str, ...) on a list of lists is intentional to match the spec.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3022777"}]}