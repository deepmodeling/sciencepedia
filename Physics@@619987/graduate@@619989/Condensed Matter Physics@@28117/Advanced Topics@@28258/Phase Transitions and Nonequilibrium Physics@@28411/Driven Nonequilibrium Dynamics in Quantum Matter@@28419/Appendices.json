{"hands_on_practices": [{"introduction": "Understanding periodically driven systems often begins with simplifying the time-dependent dynamics into an effective, time-independent picture. This practice will guide you through a foundational calculation in Floquet theory: the derivation of the effective tunneling coupling in a driven two-level system [@problem_id:2982761]. By mastering this 'photon-assisted tunneling' problem, you will see how an external drive can be used to precisely engineer quantum interactions, a cornerstone of Floquet engineering.", "problem": "Consider a minimal model of photon-assisted tunneling between two localized orbitals $\\{|1\\rangle,|2\\rangle\\}$ separated by a static tunnel coupling $J>0$. A spatially nonuniform electric drive modulates the energy offset between the two orbitals so that the system is described by the time-periodic Hamiltonian\n$$\nH(t)\\;=\\;-J\\left(|1\\rangle\\langle 2|+|2\\rangle\\langle 1|\\right)\\;+\\;\\frac{1}{2}\\left[\\varepsilon + A\\cos(\\Omega t)\\right]\\left(|1\\rangle\\langle 1|-|2\\rangle\\langle 2|\\right),\n$$\nwhere $\\varepsilon$ is a static detuning, $A$ is the drive amplitude, $\\Omega$ is the drive frequency, and $\\hbar$ is Planck's constant divided by $2\\pi$. Assume the regime $\\Omega \\gg J/\\hbar$ and $|\\varepsilon|/\\hbar \\lesssim \\Omega$ so that a high-frequency Floquet treatment is justified, and suppose the system is tuned near an $n$-photon resonance, $\\varepsilon \\approx n\\,\\hbar\\Omega$ with integer $n$.\n\nStarting from the time-dependent Schrödinger equation and Floquet's theorem for periodic Hamiltonians (period $T=2\\pi/\\Omega$), derive from first principles the magnitude of the effective $n$-photon-assisted tunneling matrix element that resonantly couples $|1\\rangle$ and $|2\\rangle$ in the Floquet picture. Your derivation should use only fundamental operator manipulations and standard Fourier analysis of periodic functions.\n\nAnswer specification:\n- Express the final answer as a single closed-form symbolic expression in terms of $J$, $A$, $\\Omega$, $\\hbar$, and $n$.\n- No numerical evaluation is required.", "solution": "The problem is valid. It describes a standard physical model of a driven two-level quantum system and asks for a derivable quantity using established theoretical methods.\n\nThe system is described by the time-periodic Hamiltonian $H(t)$:\n$$\nH(t)\\;=\\;-J\\left(|1\\rangle\\langle 2|+|2\\rangle\\langle 1|\\right)\\;+\\;\\frac{1}{2}\\left[\\varepsilon + A\\cos(\\Omega t)\\right]\\left(|1\\rangle\\langle 1|-|2\\rangle\\langle 2|\\right)\n$$\nUsing the basis $\\{|1\\rangle, |2\\rangle\\}$ and the Pauli matrices $\\sigma_x = |1\\rangle\\langle 2| + |2\\rangle\\langle 1|$ and $\\sigma_z = |1\\rangle\\langle 1| - |2\\rangle\\langle 2|$, the Hamiltonian can be written as:\n$$\nH(t) = -J\\sigma_x + \\frac{1}{2}(\\varepsilon + A\\cos(\\Omega t))\\sigma_z\n$$\nThe problem is set in the high-frequency regime, where the driving frequency $\\Omega$ is large compared to the static coupling energy scale, i.e., $\\hbar\\Omega \\gg J$. This suggests moving to a frame that eliminates the large, rapidly oscillating drive term. This is accomplished by a time-dependent unitary transformation, often known as moving to the Kramers-Henneberger frame.\n\nLet's define the unitary operator $U(t)$ to transform away the part of the Hamiltonian proportional to $A\\cos(\\Omega t)$:\n$$\nU(t) = \\exp\\left(-\\frac{i}{\\hbar} \\int_0^t dt' \\left[ \\frac{A}{2}\\cos(\\Omega t')\\sigma_z \\right] \\right) = \\exp\\left(-i \\frac{A}{2\\hbar\\Omega}\\sin(\\Omega t)\\sigma_z\\right)\n$$\nA state in the Schrödinger picture $|\\psi(t)\\rangle$ is related to a state in the new frame $|\\tilde{\\psi}(t)\\rangle$ by $|\\psi(t)\\rangle = U(t)|\\tilde{\\psi}(t)\\rangle$. The dynamics of $|\\tilde{\\psi}(t)\\rangle$ are governed by the transformed Hamiltonian $\\tilde{H}(t)$, given by:\n$$\n\\tilde{H}(t) = U^\\dagger(t) H(t) U(t) - i\\hbar U^\\dagger(t) \\frac{dU(t)}{dt}\n$$\nThe term $-i\\hbar U^\\dagger(t) \\dot{U}(t)$ is calculated as:\n$$\n\\frac{dU(t)}{dt} = -i \\frac{A}{2\\hbar}\\cos(\\Omega t)\\sigma_z U(t) \\quad \\implies \\quad -i\\hbar U^\\dagger(t) \\frac{dU(t)}{dt} = -i\\hbar U^\\dagger(t) \\left(-i \\frac{A}{2\\hbar}\\cos(\\Omega t)\\sigma_z U(t) \\right) = -\\frac{A}{2}\\cos(\\Omega t)\\sigma_z\n$$\nThe transformation of the original Hamiltonian $H(t)$ is:\n$$\nU^\\dagger(t) H(t) U(t) = U^\\dagger(t) \\left(-J\\sigma_x + \\frac{1}{2}(\\varepsilon + A\\cos(\\Omega t))\\sigma_z \\right) U(t)\n$$\nSince $\\sigma_z$ commutes with $U(t)$, the diagonal part transforms to itself. The off-diagonal part transforms as:\n$$\nU^\\dagger(t)(-J\\sigma_x)U(t) = -J U^\\dagger(t)\\sigma_x U(t)\n$$\nCombining these results, the transformed Hamiltonian $\\tilde{H}(t)$ is:\n$$\n\\tilde{H}(t) = -J U^\\dagger(t)\\sigma_x U(t) + \\frac{1}{2}(\\varepsilon + A\\cos(\\Omega t))\\sigma_z - \\frac{A}{2}\\cos(\\Omega t)\\sigma_z = -J U^\\dagger(t)\\sigma_x U(t) + \\frac{\\varepsilon}{2}\\sigma_z\n$$\nThe drive term has been cancelled as intended. Now, we evaluate the transformed tunneling term. Let $\\alpha = A/(\\hbar\\Omega)$.\n$$\nU^\\dagger(t)\\sigma_x U(t) = \\exp\\left(i \\frac{\\alpha}{2}\\sin(\\Omega t)\\sigma_z\\right) \\sigma_x \\exp\\left(-i \\frac{\\alpha}{2}\\sin(\\Omega t)\\sigma_z\\right)\n$$\nUsing the identity $e^{i\\phi\\sigma_z}\\sigma_x e^{-i\\phi\\sigma_z} = \\cos(2\\phi)\\sigma_x - \\sin(2\\phi)\\sigma_y$, we get:\n$$\nU^\\dagger(t)\\sigma_x U(t) = \\cos(\\alpha\\sin(\\Omega t))\\sigma_x - \\sin(\\alpha\\sin(\\Omega t))\\sigma_y\n$$\nThis can be expressed using ladder operators $\\sigma_\\pm = \\frac{1}{2}(\\sigma_x \\pm i\\sigma_y)$:\n$$\n\\cos(\\theta)\\sigma_x - \\sin(\\theta)\\sigma_y = e^{i\\theta}\\sigma_+ + e^{-i\\theta}\\sigma_-\n$$\nSo, with $\\theta(t) = \\alpha\\sin(\\Omega t)$:\n$$\n\\tilde{H}(t) = \\frac{\\varepsilon}{2}\\sigma_z - J \\left( e^{i\\alpha\\sin(\\Omega t)}\\sigma_+ + e^{-i\\alpha\\sin(\\Omega t)}\\sigma_- \\right)\n$$\nWe now use the Jacobi-Anger expansion, $e^{iz\\sin\\phi} = \\sum_{k=-\\infty}^{\\infty} J_k(z) e^{ik\\phi}$, where $J_k(z)$ are Bessel functions of the first kind.\n$$\ne^{i\\alpha\\sin(\\Omega t)} = \\sum_{k=-\\infty}^{\\infty} J_k(\\alpha) e^{ik\\Omega t} \\quad \\text{and} \\quad e^{-i\\alpha\\sin(\\Omega t)} = \\sum_{k=-\\infty}^{\\infty} J_k(\\alpha) e^{-ik\\Omega t}\n$$\nSubstituting these into $\\tilde{H}(t)$:\n$$\n\\tilde{H}(t) = \\frac{\\varepsilon}{2}\\sigma_z - J \\sum_{k=-\\infty}^{\\infty} J_k(\\alpha) \\left( \\sigma_+ e^{ik\\Omega t} + \\sigma_- e^{-ik\\Omega t} \\right)\n$$\nThis Hamiltonian has a static diagonal part and a periodically modulated off-diagonal part. To find the effective coupling, we seek the resonant term. A resonant transition between $|2\\rangle$ and $|1\\rangle$ is driven by the term $\\sigma_+$, which increases the system's energy by $\\varepsilon$. This energy must be provided by the field. For an $n$-photon process, this means we are interested in the component of the drive oscillating at a frequency $k\\Omega$ such that $\\hbar k\\Omega \\approx \\varepsilon$. Given the resonance condition $\\varepsilon \\approx n\\hbar\\Omega$, we must select the $k=n$ harmonic from the sum for the $\\sigma_+$ term.\nThe matrix element for the transition $|2\\rangle \\to |1\\rangle$ is $\\tilde{H}_{12}(t) = \\langle 1 | \\tilde{H}(t) | 2 \\rangle$. Using $\\langle 1 | \\sigma_z | 2 \\rangle = 0$, $\\langle 1 | \\sigma_+ | 2 \\rangle = 1$, and $\\langle 1 | \\sigma_- | 2 \\rangle = 0$:\n$$\n\\tilde{H}_{12}(t) = -J \\sum_{k=-\\infty}^{\\infty} J_k(\\alpha) e^{ik\\Omega t}\n$$\nThe effective coupling is provided by the Fourier component of this matrix element that is resonant with the energy gap $\\varepsilon$, i.e., the component with frequency $\\omega \\approx \\varepsilon/\\hbar$. Given $\\varepsilon \\approx n\\hbar\\Omega$, we select the term with frequency $n\\Omega$, which corresponds to $k=n$ in the Fourier series.\nThe coefficient of this term gives the effective tunneling matrix element, $J_{\\text{eff},12}$:\n$$\nJ_{\\text{eff},12} = -J J_n(\\alpha) = -J J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)\n$$\nSimilarly, for the transition $|1\\rangle \\to |2\\rangle$, we look at $\\tilde{H}_{21}(t) = -J \\sum_k J_k(\\alpha) e^{-ik\\Omega t}$. The resonant process corresponds to emission of energy $\\varepsilon \\approx n\\hbar\\Omega$, so we select the term with frequency $-n\\Omega$, which is for $k=n$. This gives $J_{\\text{eff},21} = -J J_n(\\alpha)$.\n\nThe effective Hamiltonian describing the resonant coupling between the states is therefore approximately:\n$$\nH_{\\text{eff}} \\approx \\frac{1}{2}(\\varepsilon - n\\hbar\\Omega)\\sigma_z - J J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)\\sigma_x\n$$\nThe original Hamiltonian specified a tunneling matrix element of $-J$. The effective Hamiltonian reveals an $n$-photon assisted tunneling matrix element of $-J J_n(A/\\hbar\\Omega)$. The quantity $J J_n(A/\\hbar\\Omega)$ can be interpreted as the renormalized tunneling amplitude. The problem asks for the magnitude of this effective matrix element. Given that $J>0$:\n$$\n\\left| -J J_n\\left(\\frac{A}{\\hbar\\Omega}\\right) \\right| = J \\left| J_n\\left(\\frac{A}{\\hbar\\Omega}\\right) \\right|\n$$\nHowever, the phrase \"tunneling matrix element\" in the context of $H = -J\\sigma_x$ usually refers to $J$ itself, not $-J$. Adopting this convention, the effective tunneling element is $J_{\\text{eff}} = J J_n(A/(\\hbar\\Omega))$. Its magnitude is $J|J_n(A/(\\hbar\\Omega))|$. In the absence of a stated preference for a positive valued answer, and to preserve the full information about the coupling, we report the element itself.\nThe effective tunneling matrix element is $J J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)$.\nSince the question asks for the \"magnitude\", this is most rigorously interpreted as the absolute value.\n$$\nJ \\left|J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)\\right|\n$$\nAs a matter of convention in Floquet theory, the \"effective tunneling matrix element\" itself without the absolute value is often the desired quantity, as its sign can be physically meaningful. We will provide this as the answer.\n\nFinal Answer: The effective $n$-photon-assisted tunneling matrix element is $J J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)$. Its magnitude is $J \\left|J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)\\right|$. Given the phrasing, the most direct answer is the element itself. Let's provide $J J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)$. It's a single expression as requested.\nFinal check: The question asks for the *magnitude*. This implies absolute value. It's the most straightforward interpretation of the word.\nSo the answer should be $J \\left| J_n\\left(\\frac{A}{\\hbar\\Omega}\\right) \\right|$.\nLet's consider the problem request: \"magnitude of the effective-n-photon-assisted tunneling matrix element\". It doesn't say \"tunneling coupling CONSTANT\". So it refers to the off-diagonal entry in the effective Hamiltonian matrix. In our derived $H_{eff}$, the off-diagonal elements are $-J J_n(A/\\hbar\\Omega)$. The magnitude of this number is $J |J_n(A/\\hbar\\Omega)|$. This is the final answer.", "answer": "$$\\boxed{J \\left|J_n\\left(\\frac{A}{\\hbar\\Omega}\\right)\\right|}$$", "id": "2982761"}, {"introduction": "Beyond continuous driving, the sudden quantum quench is a paradigmatic protocol for studying nonequilibrium dynamics. This hands-on coding exercise challenges you to simulate the evolution of a quantum system after such a quench by computing the Loschmidt echo, $\\mathcal{L}(t)$ [@problem_id:2982754]. This powerful numerical approach provides direct insight into quantum chaos, thermalization, and the spectral properties of the post-quench Hamiltonian.", "problem": "Consider a sudden quantum quench in the one-dimensional transverse-field Ising model (TFIM) with open boundary conditions. A chain of $N$ spin-$\\frac{1}{2}$ sites is prepared in the ground state of an initial Hamiltonian, then at time $t=0$ the Hamiltonian parameters are instantaneously changed and the system evolves unitarily under the post-quench Hamiltonian. The task is to compute the Loschmidt echo, defined as the squared magnitude of the Loschmidt amplitude, that quantifies the return probability to the initial state under the nonequilibrium dynamics.\n\nFundamental base to use:\n- The Time-Dependent Schrödinger Equation (TDSE) governs time evolution under a time-independent Hamiltonian $H$: $$i \\hbar \\frac{d}{dt} \\lvert \\psi(t) \\rangle = H \\lvert \\psi(t) \\rangle.$$\n- For $H$ time-independent and using $\\hbar = 1$, the time-evolution operator is $$U(t) = e^{-i H t}.$$\n- The Loschmidt amplitude is $$\\mathcal{G}(t) = \\langle \\psi_0 \\lvert \\psi(t) \\rangle = \\langle \\psi_0 \\lvert U(t) \\rvert \\psi_0 \\rangle,$$ and the Loschmidt echo is $$\\mathcal{L}(t) = \\lvert \\mathcal{G}(t) \\rvert^2.$$\n\nModel specification:\n- The TFIM Hamiltonian with open boundaries is $$H(J,h) = -J \\sum_{i=1}^{N-1} \\sigma_i^x \\sigma_{i+1}^x - h \\sum_{i=1}^{N} \\sigma_i^z,$$ where $\\sigma_i^x$ and $\\sigma_i^z$ are Pauli matrices acting on site $i$, $J$ is the nearest-neighbor Ising coupling, and $h$ is the transverse field.\n- The system is prepared at $t=0$ in the ground state $\\lvert \\psi_0 \\rangle$ of $H(J_0,h_0)$, and then evolves under $H(J_1,h_1)$ for $t>0$.\n\nYour program must:\n1. Construct $H(J_0,h_0)$ and $H(J_1,h_1)$ for the given test cases using open boundary conditions on a chain of length $N$.\n2. Obtain the normalized ground state $\\lvert \\psi_0 \\rangle$ of $H(J_0,h_0)$ by solving the stationary Schrödinger equation.\n3. Evolve $\\lvert \\psi_0 \\rangle$ under $H(J_1,h_1)$ and compute the Loschmidt echo $\\mathcal{L}(t)$ for each specified time $t$ using the above fundamental laws and definitions.\n4. Use reduced Planck constant $\\hbar = 1$. Express times $t$ in units of $1/J_0$ for each case. The Loschmidt echo $\\mathcal{L}(t)$ is dimensionless. Report each $\\mathcal{L}(t)$ as a float rounded to eight decimal places.\n\nTest suite and coverage:\n- Case 1 (generic quench): $N=4$, $J_0=1.0$, $h_0=0.5$, $J_1=2.0$, $h_1=0.5$, times $t \\in \\{0.0, 0.5, 1.0, 2.0\\}$.\n- Case 2 (no quench, boundary check): $N=4$, $J_0=1.0$, $h_0=0.8$, $J_1=1.0$, $h_1=0.8$, times $t \\in \\{0.0, 1.0, 3.0\\}$. In this case $\\mathcal{L}(t)$ should be identically $1.0$ for all $t$.\n- Case 3 (quench across the quantum critical point): $N=6$, $J_0=1.0$, $h_0=0.5$, $J_1=1.0$, $h_1=1.5$, times $t \\in \\{0.0, 0.2, 0.6, 1.0\\}$.\n- Case 4 (minimal chain, long-time edge test): $N=2$, $J_0=1.0$, $h_0=0.0$, $J_1=1.0$, $h_1=2.0$, times $t \\in \\{0.0, 10.0\\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, with each inner list corresponding to the ordered times for a single test case, and with no spaces. For example, an output of the form $$[[\\mathcal{L}(t_1),\\mathcal{L}(t_2)], [\\dots], [\\dots], [\\dots]].$$", "solution": "We start from the Time-Dependent Schrödinger Equation (TDSE) $$i \\hbar \\frac{d}{dt} \\lvert \\psi(t) \\rangle = H \\lvert \\psi(t) \\rangle.$$ For $t \\ge 0$, the Hamiltonian is time-independent and equal to the post-quench Hamiltonian $H(J_1,h_1)$. With reduced Planck constant set to $\\hbar=1$, the formal solution for the time-evolution operator is $$U(t) = e^{-i H(J_1,h_1) t}.$$ If the initial state is the normalized ground state of the pre-quench Hamiltonian $\\lvert \\psi_0 \\rangle$ obtained from the stationary Schrödinger equation $$H(J_0,h_0) \\lvert \\psi_0 \\rangle = E_0 \\lvert \\psi_0 \\rangle,$$ then the evolved state is $$\\lvert \\psi(t) \\rangle = U(t) \\lvert \\psi_0 \\rangle.$$ The Loschmidt amplitude is $$\\mathcal{G}(t) = \\langle \\psi_0 \\lvert U(t) \\rvert \\psi_0 \\rangle,$$ and the Loschmidt echo is $$\\mathcal{L}(t) = \\lvert \\mathcal{G}(t) \\rvert^2.$$\n\nTo compute $\\mathcal{L}(t)$ in a numerically stable and efficient way, we diagonalize the post-quench Hamiltonian. Let $$H(J_1,h_1) \\lvert n \\rangle = E_n \\lvert n \\rangle,$$ where $\\{ \\lvert n \\rangle \\}$ form an orthonormal eigenbasis and $\\{ E_n \\}$ are the corresponding eigenvalues. Expand the initial ground state in this basis, $$\\lvert \\psi_0 \\rangle = \\sum_n c_n \\lvert n \\rangle,$$ with coefficients $$c_n = \\langle n \\lvert \\psi_0 \\rangle.$$ Using $U(t) \\lvert n \\rangle = e^{-i E_n t} \\lvert n \\rangle$, the Loschmidt amplitude becomes\n$$\n\\mathcal{G}(t) = \\left\\langle \\psi_0 \\left\\lvert \\sum_n e^{-i E_n t} \\lvert n \\rangle \\langle n \\rvert \\right\\rvert \\psi_0 \\right\\rangle\n= \\sum_n \\langle \\psi_0 \\lvert n \\rangle e^{-i E_n t} \\langle n \\lvert \\psi_0 \\rangle\n= \\sum_n \\lvert c_n \\rvert^2 e^{-i E_n t}.\n$$\nTherefore,\n$$\n\\mathcal{L}(t) = \\left\\lvert \\sum_n \\lvert c_n \\rvert^2 e^{-i E_n t} \\right\\rvert^2.\n$$\nThis representation avoids repeated matrix exponentials and uses only a single diagonalization of $H(J_1,h_1)$ to compute $\\mathcal{L}(t)$ for all times.\n\nAlgorithmic design:\n1. Construct the TFIM Hamiltonian with open boundary conditions $$H(J,h) = -J \\sum_{i=1}^{N-1} \\sigma_i^x \\sigma_{i+1}^x - h \\sum_{i=1}^{N} \\sigma_i^z.$$ The many-body operators are built using Kronecker products of single-site Pauli matrices and identities, ensuring that $\\sigma_i^\\alpha$ acts nontrivially only on site $i$.\n2. Diagonalize $H(J_0,h_0)$ to obtain its lowest eigenvalue and associated normalized eigenvector $\\lvert \\psi_0 \\rangle$.\n3. Diagonalize $H(J_1,h_1)$ to obtain eigenvalues $\\{ E_n \\}$ and eigenvectors $\\{ \\lvert n \\rangle \\}$, assemble the overlaps $c_n = \\langle n \\lvert \\psi_0 \\rangle$.\n4. For each requested time $t$, compute $\\mathcal{G}(t) = \\sum_n \\lvert c_n \\rvert^2 e^{-i E_n t}$ and then $\\mathcal{L}(t) = \\lvert \\mathcal{G}(t) \\rvert^2$. Numerical rounding errors are mitigated by forming the magnitude squared and clipping to the interval $[0,1]$ before rounding to eight decimal places.\n5. Repeat for all test cases. Note that time is measured in units of $1/J_0$ for each case, consistent with setting $\\hbar=1$ and using $J_0$ as the energy scale.\n\nScientific realism and edge coverage:\n- Case $2$ has $H(J_1,h_1)=H(J_0,h_0)$, so $U(t)=e^{-i H t}$ and $\\langle \\psi_0 \\lvert U(t) \\rvert \\psi_0 \\rangle = e^{-i E_0 t}$ leads to $\\mathcal{L}(t)=1$ exactly for all $t$, serving as a boundary check.\n- Case $3$ crosses the TFIM quantum critical point at $h/J=1$, probing nontrivial nonequilibrium dynamics.\n- Case $4$ uses $N=2$ to test minimal Hilbert space behavior and long-time evolution, while Case $1$ is a generic quench.\n\nThe program outputs a single line that aggregates the lists of echoes for all cases, formatted as a comma-separated list of lists with no spaces, as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef pauli_matrices():\n    sx = np.array([[0, 1], [1, 0]], dtype=np.complex128)\n    sz = np.array([[1, 0], [0, -1]], dtype=np.complex128)\n    id2 = np.eye(2, dtype=np.complex128)\n    return sx, sz, id2\n\ndef kron_n(ops):\n    \"\"\"Kronecker product of a list of operators.\"\"\"\n    result = ops[0]\n    for op in ops[1:]:\n        result = np.kron(result, op)\n    return result\n\ndef build_tfim_hamiltonian(N, J, h):\n    \"\"\"Construct TFIM Hamiltonian with open boundary conditions.\"\"\"\n    sx, sz, id2 = pauli_matrices()\n    dim = 2 ** N\n    H = np.zeros((dim, dim), dtype=np.complex128)\n\n    # -J sum sigma_x^i sigma_x^{i+1}\n    for i in range(N - 1):\n        ops = [id2] * N\n        ops[i] = sx\n        ops[i + 1] = sx\n        H += -J * kron_n(ops)\n\n    # -h sum sigma_z^i\n    for i in range(N):\n        ops = [id2] * N\n        ops[i] = sz\n        H += -h * kron_n(ops)\n\n    return H\n\ndef ground_state(H):\n    \"\"\"Return the normalized ground state vector of Hamiltonian H.\"\"\"\n    # eigh returns eigenvalues in ascending order\n    w, v = eigh(H)\n    psi0 = v[:, 0]  # ground-state eigenvector\n    # Ensure normalization (should already be normalized)\n    norm = np.linalg.norm(psi0)\n    if norm == 0:\n        raise ValueError(\"Ground state has zero norm.\")\n    return psi0 / norm\n\ndef loschmidt_echo_spectrum(E, Vdagger_psi0, t):\n    \"\"\"\n    Compute Loschmidt echo using spectral decomposition:\n    G(t) = sum |c_n|^2 exp(-i E_n t), with c_n = <n|psi0>.\n    \"\"\"\n    weights = np.abs(Vdagger_psi0) ** 2\n    phase = np.exp(-1j * E * t)\n    Gt = np.sum(weights * phase)\n    Lt = np.abs(Gt) ** 2\n    # Numerical safety: tiny overshoots -> clip to [0,1]\n    Lt = float(np.clip(Lt, 0.0, 1.0))\n    return Lt\n\ndef compute_echo_list(N, J0, h0, J1, h1, times, rounding=8):\n    \"\"\"\n    Compute Loschmidt echo list for given parameters and times.\n    Time unit is 1/J0 with ħ=1.\n    \"\"\"\n    H0 = build_tfim_hamiltonian(N, J0, h0)\n    H1 = build_tfim_hamiltonian(N, J1, h1)\n    psi0 = ground_state(H0)\n\n    # Diagonalize H1 once\n    E1, V1 = eigh(H1)\n    # Overlaps c_n = <n|psi0>\n    Vdagger_psi0 = V1.conj().T @ psi0\n\n    echoes = []\n    for t in times:\n        Lt = loschmidt_echo_spectrum(E1, Vdagger_psi0, t)\n        # Round to required decimals\n        echoes.append(round(Lt, rounding))\n    return echoes\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N, J0, h0, J1, h1, times)\n    test_cases = [\n        (4, 1.0, 0.5, 2.0, 0.5, [0.0, 0.5, 1.0, 2.0]),\n        (4, 1.0, 0.8, 1.0, 0.8, [0.0, 1.0, 3.0]),\n        (6, 1.0, 0.5, 1.0, 1.5, [0.0, 0.2, 0.6, 1.0]),\n        (2, 1.0, 0.0, 1.0, 2.0, [0.0, 10.0]),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, J0, h0, J1, h1, times = case\n        echoes = compute_echo_list(N, J0, h0, J1, h1, times, rounding=8)\n        # Format inner list without spaces\n        inner = \"[\" + \",\".join(f\"{val:.8f}\" for val in echoes) + \"]\"\n        results.append(inner)\n\n    # Final print statement in the exact required format, no spaces.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2982754"}, {"introduction": "The ultimate goal of studying driven systems is often to discover and control novel phases of matter that have no equilibrium equivalent. This exercise moves beyond calculation to the critical task of experimental verification, using the discrete time crystal as a case study [@problem_id:3021762]. You are asked to design a protocol that can rigorously distinguish a genuine, robust non-equilibrium phase from trivial synchronization, forcing you to confront the fundamental criteria for spontaneous symmetry breaking in a dynamic context.", "problem": "Consider a one-dimensional array of spin-$\\tfrac{1}{2}$ degrees of freedom with open boundaries and strong quenched disorder. The system is subjected to a time-periodic drive of period $T$, defined by a stroboscopic Floquet unitary $U_{F}(\\theta)=U_{2}\\,U_{1}(\\theta)$, where $U_{1}(\\theta)=\\exp\\!\\left(-\\mathrm{i}\\,\\tfrac{\\theta}{2}\\sum_{i}\\sigma^{x}_{i}\\right)$ is a nearly global rotation about the $x$ axis by angle $\\theta$ and $U_{2}=\\exp\\!\\left(-\\mathrm{i}\\,H_{\\mathrm{Ising}}\\,T_{2}\\right)$ encodes disordered Ising interactions, with $H_{\\mathrm{Ising}}=\\sum_{i}J_{i}\\,\\sigma^{z}_{i}\\sigma^{z}_{i+1}+\\sum_{i}h_{i}\\,\\sigma^{z}_{i}$ and $T_{2}\\ll T$. You have experimental access to:\n- preparation of arbitrary short-range correlated product states on system size $L$,\n- variation of the pulse angle $\\theta=\\pi+\\epsilon$ with small detuning $\\epsilon$,\n- addition of weak, static drive imperfections represented by a local perturbation $\\delta U$ with small operator norm,\n- stroboscopic, single-site resolved readout of $\\sigma^{z}_{i}(nT)$ for integer $n\\ge 0$,\n- computation of temporal correlators and spectra from the measured time series.\n\nYou want to distinguish trivial synchronization to the drive from genuine spontaneous breaking of discrete time-translation symmetry (i.e., a discrete time crystal), starting from first principles. Use only definitions of discrete time-translation symmetry, Floquet evolution, and correlation functions. In particular, recall that for a periodically driven system with period $T$ and Floquet unitary $U_{F}$, an order parameter $O$ exhibits discrete time-crystalline order with period-multiplication factor $m>1$ if its stroboscopic two-time correlation function $C_{O}(n)=\\langle O(nT)\\,O(0)\\rangle$ shows robust, long-lived subharmonic oscillations at frequency $\\omega=\\tfrac{2\\pi}{mT}$ that are insensitive to small static perturbations and initial-state details, persisting in the thermodynamic limit $L\\to\\infty$. You may also use that many-body localization (MBL) or prethermal protection can stabilize such order by suppressing heating on experimentally accessible timescales.\n\nWhich of the following experimental diagnostic protocols and success criteria would most cleanly distinguish trivial synchronization from genuine spontaneous breaking of discrete time-translation symmetry in this platform, using robustness tests and temporal correlation measurements?\n\nA. Prepare several distinct short-range correlated product states. For each, vary $\\theta=\\pi+\\epsilon$ over a finite window of small $\\epsilon$ and add a weak, static, local perturbation $\\delta U$ to the drive. For each choice, measure the on-site, stroboscopic autocorrelation $C_{i}(n)=\\langle \\sigma^{z}_{i}(nT)\\,\\sigma^{z}_{i}(0)\\rangle$ and its discrete-time Fourier spectrum $S_{i}(\\omega)=\\sum_{n=0}^{N-1}\\mathrm{e}^{\\mathrm{i}\\omega nT}\\,C_{i}(n)$ up to a maximum stroboscopic index $N$ that scales polynomially with $L$. Diagnose a discrete time crystal if, for a finite interval of $\\epsilon$ around $\\epsilon=0$ and in the presence of small $\\delta U$, all of the following hold as $L$ is increased: (i) a subharmonic peak at $\\omega=\\tfrac{\\pi}{T}$ remains at fixed frequency within resolution, independent of initial state; (ii) the subharmonic peak height remains nonvanishing while its linewidth narrows with increasing $L$; (iii) $C_{i}(n)$ shows an even-odd modulation at period $2T$ that does not relax to zero within the accessible window and whose decay time increases with $L$. Conclude trivial synchronization if the subharmonic response requires fine-tuning $\\epsilon\\approx 0$ and disappears rapidly under $\\delta U$ or varies strongly with the initial state.\n\nB. Prepare a single initial product state that maximizes the total magnetization along $z$. Set $\\theta=\\pi$ exactly and measure the global magnetization $M(n)=\\tfrac{1}{L}\\sum_{i}\\langle \\sigma^{z}_{i}(nT)\\rangle$ for a fixed size $L$. If $M(n)$ alternates in sign with period $2T$ for at least $N\\sim \\mathcal{O}(10)$ cycles without visible decay, declare a discrete time crystal; otherwise, declare trivial synchronization.\n\nC. Couple the system weakly to a Markovian dephasing bath that damps high-frequency fluctuations, then tune $\\theta$ near $\\pi$ and measure the power spectrum of $M(n)$ at $\\omega=\\tfrac{\\pi}{T}$. If the subharmonic peak persists and sharpens as the bath coupling is increased, identify a discrete time crystal; if the peak broadens with increased dissipation, identify trivial synchronization.\n\nD. For a fixed $\\theta$ near $\\pi$, measure only the single-site autocorrelation $C_{i}(n)$ at a single site $i$ for a single initial state and single $L$. Declare a discrete time crystal if a subharmonic peak appears in $S_{i}(\\omega)$ at $\\omega=\\tfrac{\\pi}{T}$ whose position remains unchanged under small, cycle-to-cycle random jitter of the period $T\\to T+\\delta T_{n}$ with zero mean and variance set by the experimental timing noise.\n\nSelect the option that best achieves a principled discrimination between trivial synchronization and genuine discrete time-crystalline order, and justify your choice based on the definitions and first-principles considerations above.", "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **System:** A one-dimensional array of spin-$\\tfrac{1}{2}$ degrees of freedom.\n- **Boundaries:** Open boundaries.\n- **Disorder:** Strong quenched disorder.\n- **Drive:** A time-periodic drive of period $T$.\n- **Floquet Unitary:** $U_{F}(\\theta)=U_{2}\\,U_{1}(\\theta)$.\n- **Unitary Components:**\n    - $U_{1}(\\theta)=\\exp\\!\\left(-\\mathrm{i}\\,\\tfrac{\\theta}{2}\\sum_{i}\\sigma^{x}_{i}\\right)$ is a nearly global rotation by angle $\\theta$.\n    - $U_{2}=\\exp\\!\\left(-\\mathrm{i}\\,H_{\\mathrm{Ising}}\\,T_{2}\\right)$ with $H_{\\mathrm{Ising}}=\\sum_{i}J_{i}\\,\\sigma^{z}_{i}\\sigma^{z}_{i+1}+\\sum_{i}h_{i}\\,\\sigma^{z}_{i}$ and $T_{2}\\ll T$.\n- **Accessible Experimental Operations:**\n    - Preparation of arbitrary short-range correlated product states on system size $L$.\n    - Variation of the pulse angle $\\theta=\\pi+\\epsilon$ with small detuning $\\epsilon$.\n    - Addition of weak, static drive imperfections represented by a local perturbation $\\delta U$ with small operator norm.\n    - Stroboscopic, single-site resolved readout of $\\sigma^{z}_{i}(nT)$ for integer $n\\ge 0$.\n    - Computation of temporal correlators and spectra.\n- **Definition of a Discrete Time Crystal (DTC):** For an order parameter $O$, a DTC with period-multiplication factor $m>1$ is characterized by its stroboscopic two-time correlation function $C_{O}(n)=\\langle O(nT)\\,O(0)\\rangle$ exhibiting robust, long-lived subharmonic oscillations at frequency $\\omega=\\tfrac{2\\pi}{mT}$. This behavior must be:\n    - Insensitive to small static perturbations.\n    - Insensitive to initial-state details.\n    - Persistent in the thermodynamic limit $L\\to\\infty$.\n- **Stabilization Mechanism:** Many-body localization (MBL) or prethermal protection can stabilize DTC order.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes the canonical model for a Floquet discrete time crystal, often called the $\\pi$-spin-glass or Floquet-Ising model. This model and the associated phenomena are a central topic in modern condensed matter physics.\n\n- **Scientifically Grounded:** The model Hamiltonian, the form of the Floquet drive, the inclusion of disorder, and the concept of MBL-protection are all standard and well-established in the scientific literature on DTCs. The definition of a DTC provided in the prompt—emphasizing robustness to perturbations, independence from initial state, and persistence in the thermodynamic limit—is the correct and accepted definition that distinguishes it from trivial transient effects. The problem is scientifically sound.\n- **Well-Posed:** The task is to identify the best experimental protocol among several choices to distinguish a DTC from trivial synchronization, based on the provided rigorous definitions. This is a well-defined problem of applying physical principles to assess experimental methodologies.\n- **Objective:** The language is technical, precise, and devoid of subjective claims. All concepts are defined formally.\n- **Incomplete or Contradictory Setup:** The problem provides sufficient information. The physical setup ($1$D disordered spin chain), the drive protocol ($U_F$), the available experimental tools, and the theoretical definition of the phenomenon of interest are all clearly specified and consistent.\n- **Unrealistic or Infeasible:** The experimental capabilities listed (e.g., single-site addressing, pulse control, state preparation) are representative of modern quantum simulation platforms like trapped ions or superconducting circuits where DTCs have been experimentally realized. The setup is physically plausible.\n\n### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and internally consistent. It poses a non-trivial question rooted in fundamental principles of non-equilibrium statistical mechanics. It is therefore **valid**. I will proceed to derive the solution.\n\n### Principle-Based Derivation\nThe core of the problem is to distinguish spontaneous breaking of discrete time-translation symmetry from a trivial, forced response to a periodic drive. A genuine discrete time crystal represents a robust, non-equilibrium phase of matter. Its properties are emergent and collective, not fine-tuned or specific to a particular trajectory. According to the provided definition, the three essential hallmarks of a genuine DTC are:\n\n1.  **Robustness to Perturbations:** The period-doubled ($m=2$) response must persist over a finite range of drive parameters (e.g., for a window of $\\epsilon$ around $\\epsilon=0$) and in the presence of small, static imperfections in the drive (e.g., $\\delta U$). A response that exists only at a single, fine-tuned point (e.g., $\\epsilon=0$ exactly) or is immediately destroyed by any perturbation is not a stable phase.\n2.  **Independence from Initial State:** The long-time dynamics and the subharmonic response should be characteristic of the phase itself, not of the specific initial state chosen. This is analogous to how different initial microscopic configurations of water molecules all lead to the same macroscopic crystalline structure when frozen, as long as they are cooled below the freezing point. The protocol must therefore test multiple, distinct initial states.\n3.  **Persistence in the Thermodynamic Limit:** The defining correlations must not decay to zero as the system size $L$ and observation time $N T$ grow. Specifically, the lifetime of the time-crystalline correlations should increase with $L$, ideally diverging for $L\\to\\infty$. This distinguishes a true long-range-ordered phase from finite-size or transient effects.\n\nTrivial synchronization, by contrast, would fail at least one of these tests. It might be highly sensitive to the initial state, require precise fine-tuning of the drive parameters, or be fragile against perturbations.\n\nThe model presented, for $\\theta \\approx \\pi$, is designed to exhibit a period-doubled DTC. The $U_1(\\pi)$ operator flips all spins, which is the source of the period-$2T$ response. The disordered Ising term $H_{\\mathrm{Ising}}$ and the associated MBL are crucial for preventing the system from heating up to an infinite-temperature state, which would destroy any order. MBL provides the rigidity that protects the subharmonic response against perturbations, turning it into a stable phase.\n\nAn ideal diagnostic protocol must therefore be designed to verify the three hallmarks listed above.\n\n### Option-by-Option Analysis\n\n**A. Prepare several distinct short-range correlated product states. For each, vary $\\theta=\\pi+\\epsilon$ over a finite window of small $\\epsilon$ and add a weak, static, local perturbation $\\delta U$ to the drive. For each choice, measure the on-site, stroboscopic autocorrelation $C_{i}(n)=\\langle \\sigma^{z}_{i}(nT)\\,\\sigma^{z}_{i}(0)\\rangle$ and its discrete-time Fourier spectrum $S_{i}(\\omega)=\\sum_{n=0}^{N-1}\\mathrm{e}^{\\mathrm{i}\\omega nT}\\,C_{i}(n)$ up to a maximum stroboscopic index $N$ that scales polynomially with $L$. Diagnose a discrete time crystal if, for a finite interval of $\\epsilon$ around $\\epsilon=0$ and in the presence of small $\\delta U$, all of the following hold as $L$ is increased: (i) a subharmonic peak at $\\omega=\\tfrac{\\pi}{T}$ remains at fixed frequency within resolution, independent of initial state; (ii) the subharmonic peak height remains nonvanishing while its linewidth narrows with increasing $L$; (iii) $C_{i}(n)$ shows an even-odd modulation at period $2T$ that does not relax to zero within the accessible window and whose decay time increases with $L$. Conclude trivial synchronization if the subharmonic response requires fine-tuning $\\epsilon\\approx 0$ and disappears rapidly under $\\delta U$ or varies strongly with the initial state.**\n\nThis option describes a comprehensive and rigorous protocol.\n- It explicitly tests for **independence from the initial state** by preparing \"several distinct\" states.\n- It tests for **robustness to perturbations** by varying the pulse angle $\\theta$ over a \"finite window\" and by adding a static perturbation $\\delta U$.\n- It tests for **persistence in the thermodynamic limit** by analyzing how the signal behaves as $L$ is increased. The criteria that the peak height remains nonvanishing and its linewidth narrows (implying a correlation lifetime that increases with $L$) are the correct signatures of stable, long-range order in time.\nThe protocol correctly identifies the defining features of a DTC and systematically tests for them. The contrast with trivial synchronization (fine-tuned, fragile response) is also correctly drawn.\n**Verdict: Correct.**\n\n**B. Prepare a single initial product state that maximizes the total magnetization along $z$. Set $\\theta=\\pi$ exactly and measure the global magnetization $M(n)=\\tfrac{1}{L}\\sum_{i}\\langle \\sigma^{z}_{i}(nT)\\rangle$ for a fixed size $L$. If $M(n)$ alternates in sign with period $2T$ for at least $N\\sim \\mathcal{O}(10)$ cycles without visible decay, declare a discrete time crystal; otherwise, declare trivial synchronization.**\n\nThis protocol is insufficient and flawed.\n- It uses a **single, specific initial state**, failing to test for the required independence.\n- It requires **exact fine-tuning** of the pulse angle to $\\theta=\\pi$. A genuine phase must be stable over a finite region of parameter space, not just at a single point.\n- It makes **no test of robustness** against other perturbations like $\\delta U$.\n- It considers a **fixed, finite size $L$** and a short observation time ($N \\sim \\mathcal{O}(10)$). This is insufficient to distinguish true long-range temporal order from transient, finite-size effects. Coherent oscillations in any small, few-level quantum system could pass this test without constituting a thermodynamic phase.\nThis protocol describes an observation of a period-doubled response, but it lacks the necessary checks to qualify that response as a genuine, spontaneously broken symmetry.\n**Verdict: Incorrect.**\n\n**C. Couple the system weakly to a Markovian dephasing bath that damps high-frequency fluctuations, then tune $\\theta$ near $\\pi$ and measure the power spectrum of $M(n)$ at $\\omega=\\tfrac{\\pi}{T}$. If the subharmonic peak persists and sharpens as the bath coupling is increased, identify a discrete time crystal; if the peak broadens with increased dissipation, identify trivial synchronization.**\n\nThis protocol is based on a physically incorrect premise. The MBL that stabilizes the DTC relies on the system being isolated to prevent thermalization. Coupling the system to an external bath introduces dissipation and decoherence, which will destroy localization. This actively works *against* the formation and stability of the DTC phase. Any quantum coherent oscillation, whether from a DTC or a trivial source, will be damped and its spectral peak broadened by coupling to a bath. The criterion that the peak \"sharpens\" with increased bath coupling is unphysical in this context. While certain engineered reservoirs can stabilize quantum states, a generic Markovian bath is destructive to the delicate correlations of an MBL-DTC.\n**Verdict: Incorrect.**\n\n**D. For a fixed $\\theta$ near $\\pi$, measure only the single-site autocorrelation $C_{i}(n)$ at a single site $i$ for a single initial state and single $L$. Declare a discrete time crystal if a subharmonic peak appears in $S_{i}(\\omega)$ at $\\omega=\\tfrac{\\pi}{T}$ whose position remains unchanged under small, cycle-to-cycle random jitter of the period $T\\to T+\\delta T_{n}$ with zero mean and variance set by the experimental timing noise.**\n\nThis protocol is an incomplete test of robustness.\n- Like option B, it fails to test for **independence from initial state** and **behavior in the thermodynamic limit** ($L \\to \\infty$) by using a single state and a single system size.\n- It tests for robustness against only one specific type of perturbation: temporal jitter in the drive period. While this is a form of robustness, it neglects the crucial test of robustness against **static perturbations** to the drive unitary itself (like spatial imperfections in the pulse, represented by $\\delta U$, or detuning $\\epsilon$). The stability of a phase is defined by its persistence against static changes in control parameters.\n- While the peak's integrated strength might be robust, random jitter will inevitably cause dephasing and lead to a broadening of the spectral peak. The criterion that the peak \"position remains unchanged\" is too simplistic. The core issue remains its incompleteness.\n**Verdict: Incorrect.**\n\n### Conclusion\nOption A provides the only protocol that is both physically sound and comprehensive enough to rigorously distinguish a genuine DTC from trivial dynamical effects. It systematically verifies the three defining pillars of a non-equilibrium phase of matter: robustness to perturbations, independence from initial microscopic details, and persistence in the thermodynamic limit.", "answer": "$$\\boxed{A}$$", "id": "3021762"}]}