{"hands_on_practices": [{"introduction": "Understanding how a system responds to external stimuli is fundamental to characterizing phase transitions. The magnetic susceptibility, $\\chi$, quantifies the change in magnetization in response to a small magnetic field and is a key experimental observable. This practice [@problem_id:3008443] guides you through a foundational calculation in Landau theory: deriving the susceptibility above the critical temperature by minimizing the free-energy functional, revealing the characteristic divergence as the system approaches the transition.", "problem": "Consider a scalar order parameter $m$ in a system undergoing a continuous phase transition at the critical temperature $T_{c}$. Within the Landau theory of phase transitions, the free-energy density per unit volume, measured in units of the Boltzmann constant times temperature (so that it is dimensionless), is expanded near $T_{c}$ as\n$$\nf(m;T,h) \\;=\\; f_{0}(T) \\;+\\; \\frac{1}{2}\\,r(T)\\,m^{2} \\;+\\; \\frac{1}{4}\\,u\\,m^{4} \\;-\\; h\\,m,\n$$\nwhere $u0$ is a temperature-independent constant and $h$ is the external field conjugate to $m$. Assume $TT_{c}$ so that $r(T)0$. Near $T_{c}$, take $r(T)$ to be linear in temperature, $r(T)=a\\,(T-T_{c})$ with $a0$. Using the principle that equilibrium minimizes the free energy with respect to $m$ at fixed $T$ and $h$, derive the linear-response susceptibility above $T_{c}$,\n$$\n\\chi_{+}(T) \\;=\\; \\left.\\frac{\\partial m}{\\partial h}\\right|_{h\\to 0,TT_{c}},\n$$\nin terms of $T$, $T_{c}$, and the constant $a$. Work consistently to leading order in $h$ appropriate for the linear-response regime above $T_{c}$ and state the final result as a single closed-form expression. All quantities are dimensionless; no unit needs to be reported for the final answer.", "solution": "The problem statement is a standard exercise in the Landau theory of second-order phase transitions and is deemed valid. It is scientifically grounded, well-posed, and objective. We proceed with the solution.\n\nThe free-energy density per unit volume, $f(m;T,h)$, is given as a function of the scalar order parameter $m$, temperature $T$, and external field $h$:\n$$\nf(m;T,h) = f_{0}(T) + \\frac{1}{2}\\,r(T)\\,m^{2} + \\frac{1}{4}\\,u\\,m^{4} - h\\,m\n$$\nThe system is in thermodynamic equilibrium when the free-energy density is minimized with respect to the order parameter $m$, at fixed $T$ and $h$. This condition is expressed mathematically by setting the first partial derivative of $f$ with respect to $m$ to zero:\n$$\n\\frac{\\partial f}{\\partial m} = 0\n$$\nWe first compute this derivative using the given expression for $f(m;T,h)$:\n$$\n\\frac{\\partial f}{\\partial m} = \\frac{\\partial}{\\partial m} \\left( f_{0}(T) + \\frac{1}{2}\\,r(T)\\,m^{2} + \\frac{1}{4}\\,u\\,m^{4} - h\\,m \\right) = r(T)\\,m + u\\,m^{3} - h\n$$\nSetting this derivative to zero yields the equation of state, which relates the equilibrium order parameter $m$ to the temperature $T$ and the external field $h$:\n$$\nr(T)\\,m + u\\,m^{3} - h = 0\n$$\nWe are asked to find the linear-response susceptibility above the critical temperature $T_{c}$, which is defined as:\n$$\n\\chi_{+}(T) = \\left.\\frac{\\partial m}{\\partial h}\\right|_{h\\to 0, TT_{c}}\n$$\nTo find this quantity, we can use implicit differentiation on the equation of state with respect to the external field $h$. Treating $m$ as a function of $h$ (and $T$), we differentiate the equation $r(T)\\,m + u\\,m^{3} - h = 0$ with respect to $h$:\n$$\n\\frac{d}{dh} \\left( r(T)\\,m(h) + u\\,m(h)^{3} - h \\right) = \\frac{d}{dh} (0)\n$$\nApplying the chain rule, we obtain:\n$$\nr(T)\\,\\frac{dm}{dh} + 3u\\,m^{2}\\,\\frac{dm}{dh} - 1 = 0\n$$\nWe can now solve for the derivative $\\frac{dm}{dh}$:\n$$\n\\left( r(T) + 3u\\,m^{2} \\right) \\frac{dm}{dh} = 1\n$$\n$$\n\\frac{dm}{dh} = \\frac{1}{r(T) + 3u\\,m^{2}}\n$$\nThe susceptibility $\\chi_{+}(T)$ is this derivative evaluated in the limit as $h \\to 0$ for a temperature $T  T_{c}$. First, we must determine the value of the order parameter $m$ in this limit. From the equation of state, $m(r(T) + u\\,m^{2}) = h$, when we set $h=0$, we have $m(r(T) + u\\,m^{2}) = 0$. Since the problem specifies $T  T_{c}$, we have $r(T)  0$. Also, we are given $u  0$. Therefore, the term $r(T) + u\\,m^{2}$ is always positive for any real $m$. The only real solution to the equation is thus $m=0$.\nSo, in the limit $h \\to 0$ for $T  T_{c}$, the equilibrium order parameter is $m=0$.\n\nWe can now evaluate the expression for the susceptibility in this limit:\n$$\n\\chi_{+}(T) = \\lim_{h\\to 0, TT_{c}} \\frac{dm}{dh} = \\lim_{m\\to 0} \\frac{1}{r(T) + 3u\\,m^{2}} = \\frac{1}{r(T) + 3u(0)^{2}} = \\frac{1}{r(T)}\n$$\nThis is the general expression for the susceptibility in the disordered phase within Landau theory. The problem provides a specific form for the coefficient $r(T)$ near the critical temperature:\n$$\nr(T) = a\\,(T-T_{c})\n$$\nwhere $a$ is a positive constant. Substituting this into our expression for $\\chi_{+}(T)$, we arrive at the final result:\n$$\n\\chi_{+}(T) = \\frac{1}{a(T-T_{c})}\n$$\nThis result is the Curie-Weiss law, a hallmark of mean-field theories for phase transitions, which correctly captures the divergence of the susceptibility as the temperature approaches the critical temperature from above.", "answer": "$$\n\\boxed{\\frac{1}{a(T-T_{c})}}\n$$", "id": "3008443"}, {"introduction": "Beyond a system's response to external fields, phase transitions leave a distinct fingerprint on its thermodynamic properties, such as the specific heat, $C$. This quantity reflects how the system's entropy changes with temperature. This exercise [@problem_id:3008513] involves calculating the equilibrium free energy on both sides of a second-order transition to determine the jump in specific heat at the critical point, a classic prediction of mean-field theory.", "problem": "Consider a homogeneous system undergoing a continuous (second-order) phase transition described by a scalar order parameter $m$. The Landau free-energy density near the transition can be expanded as\n$$\nf(T,m)=f_{\\mathrm{reg}}(T)+a(T)m^{2}+b\\,m^{4},\n$$\nwhere $f_{\\mathrm{reg}}(T)$ is a regular (analytic) background contribution, $b0$ is a $T$-independent constant, and $a(T)=a'(T-T_{c})$ with $a'0$ and $T_{c}$ the critical temperature. Assume thermodynamic equilibrium is obtained by minimizing $f(T,m)$ with respect to $m$ at fixed temperature $T$. Define the entropy density as $s(T)=-\\partial f_{\\mathrm{eq}}(T)/\\partial T$ and the specific heat per unit volume as $C(T)=T\\,\\partial s(T)/\\partial T=-T\\,\\partial^{2}f_{\\mathrm{eq}}(T)/\\partial T^{2}$.\n\nWorking from these definitions and the equilibrium condition $\\partial f/\\partial m=0$, compute the singular contribution to the specific heat jump at the transition,\n$$\n\\Delta C \\equiv \\lim_{T\\to T_{c}^{-}}C(T)-\\lim_{T\\to T_{c}^{+}}C(T),\n$$\nattributable to the Landau term $a(T)m^{2}+b\\,m^{4}$, explicitly in terms of $T_{c}$, $a'$, and $b$ (you may ignore the regular background $f_{\\mathrm{reg}}(T)$ when evaluating the jump). Then, using the definition of the specific heat critical exponent $\\alpha$ through the singular part $C_{\\mathrm{sing}}(T)\\sim |t|^{-\\alpha}$ as $t\\to 0$ with $t=(T-T_{c})/T_{c}$, determine the mean-field value of $\\alpha$ for this Landau theory.\n\nYour final answer should list the two quantities $\\Delta C$ and $\\alpha$ as a single row matrix. No numerical evaluation or rounding is required; express your answer symbolically.", "solution": "The problem requires the calculation of the specific heat jump, $\\Delta C$, and the critical exponent, $\\alpha$, for a system described by a Landau free-energy density near a second-order phase transition.\n\nThe Landau free-energy density is given by\n$$\nf(T,m)=f_{\\mathrm{reg}}(T)+a(T)m^{2}+b\\,m^{4}\n$$\nwhere $a(T)=a'(T-T_{c})$ with $a'0$, and $b0$. Thermodynamic equilibrium is found by minimizing $f(T,m)$ with respect to the order parameter $m$. The equilibrium condition is $\\frac{\\partial f}{\\partial m}=0$.\n\nTaking the derivative, we get:\n$$\n\\frac{\\partial f}{\\partial m} = 2a(T)m + 4bm^3 = 2m(a(T) + 2bm^2) = 0\n$$\nThis equation has two types of solutions: $m=0$ or $m^2 = -\\frac{a(T)}{2b}$. To determine which solution corresponds to a minimum, we examine the second derivative:\n$$\n\\frac{\\partial^2 f}{\\partial m^2} = 2a(T) + 12bm^2\n$$\nA stable solution requires $\\frac{\\partial^2 f}{\\partial m^2}  0$.\n\nCase 1: High-temperature phase ($TT_{c}$)\nIn this regime, $a(T) = a'(T-T_c)  0$. Since $b0$, the solution $m^2 = -a(T)/(2b)$ is not physical as it would give an imaginary $m$. The only real solution is $m=0$.\nAt $m=0$, the second derivative is $\\frac{\\partial^2 f}{\\partial m^2} = 2a(T)  0$, indicating a minimum.\nThus, the equilibrium order parameter is $m_{\\mathrm{eq}}=0$ for $TT_{c}$.\n\nCase 2: Low-temperature phase ($TT_{c}$)\nIn this regime, $a(T) = a'(T-T_c)  0$. The possible real solutions are $m=0$ and $m = \\pm \\sqrt{-a(T)/(2b)}$.\nAt $m=0$, the second derivative is $\\frac{\\partial^2 f}{\\partial m^2} = 2a(T)  0$, which corresponds to a maximum. This solution is unstable.\nFor $m^2 = -a(T)/(2b)$, the second derivative is:\n$$\n\\frac{\\partial^2 f}{\\partial m^2} = 2a(T) + 12b\\left(-\\frac{a(T)}{2b}\\right) = 2a(T) - 6a(T) = -4a(T)\n$$\nSince $a(T)0$ for $TT_c$, we have $-4a(T)0$, indicating a stable minimum.\nThus, for $TT_{c}$, the equilibrium order parameter satisfies $m_{\\mathrm{eq}}^2 = -\\frac{a(T)}{2b} = \\frac{a'(T_c-T)}{2b}$.\n\nNext, we find the equilibrium free energy, $f_{\\mathrm{eq}}(T)$, by substituting $m_{\\mathrm{eq}}(T)$ back into $f(T,m)$. We are interested in the singular part, arising from the terms involving $m$. Let $f_{\\mathrm{eq, sing}}(T)$ be this contribution.\n\nFor $TT_{c}$, $m_{\\mathrm{eq}}=0$, so $f_{\\mathrm{eq, sing}}(T) = a(T)(0)^2 + b(0)^4 = 0$.\nFor $TT_{c}$, $m_{\\mathrm{eq}}^2 = -a(T)/(2b)$, so\n$$\nf_{\\mathrm{eq, sing}}(T) = a(T)m_{\\mathrm{eq}}^2 + bm_{\\mathrm{eq}}^4 = a(T)\\left(-\\frac{a(T)}{2b}\\right) + b\\left(-\\frac{a(T)}{2b}\\right)^2 = -\\frac{a(T)^2}{2b} + \\frac{a(T)^2}{4b} = -\\frac{a(T)^2}{4b}\n$$\nSubstituting $a(T) = a'(T-T_c)$, we get:\n$$\nf_{\\mathrm{eq, sing}}(T) = -\\frac{(a')^2(T-T_c)^2}{4b}\n$$\nIn summary:\n$$\nf_{\\mathrm{eq, sing}}(T) = \\begin{cases} 0  \\text{for } T \\geq T_c \\\\ -\\frac{(a')^2(T-T_c)^2}{4b}  \\text{for } T  T_c \\end{cases}\n$$\nThe problem specifies that contributions from the regular part, $f_{\\mathrm{reg}}(T)$, can be ignored when calculating the jump $\\Delta C$, as its derivatives will be continuous at $T_c$.\n\nThe entropy density is $s(T) = -\\frac{\\partial f_{\\mathrm{eq}}(T)}{\\partial T}$. The singular contribution to the entropy, $s_{\\mathrm{sing}}(T)$, is:\n$$\ns_{\\mathrm{sing}}(T) = -\\frac{\\partial f_{\\mathrm{eq, sing}}(T)}{\\partial T}\n$$\nFor $TT_{c}$, $s_{\\mathrm{sing}}(T) = -\\frac{\\partial}{\\partial T}(0) = 0$.\nFor $TT_{c}$,\n$$\ns_{\\mathrm{sing}}(T) = -\\frac{\\partial}{\\partial T}\\left(-\\frac{(a')^2(T-T_c)^2}{4b}\\right) = \\frac{(a')^2}{4b} \\cdot 2(T-T_c) = \\frac{(a')^2(T-T_c)}{2b}\n$$\nNote that $\\lim_{T \\to T_c^-} s_{\\mathrm{sing}}(T) = 0$, so the entropy is continuous at $T_c$, as expected for a second-order transition.\n\nThe specific heat is $C(T) = T \\frac{\\partial s(T)}{\\partial T}$. The singular contribution, $C_{\\mathrm{sing}}(T)$, is:\n$$\nC_{\\mathrm{sing}}(T) = T \\frac{\\partial s_{\\mathrm{sing}}(T)}{\\partial T}\n$$\nFor $TT_{c}$, $C_{\\mathrm{sing}}(T) = T \\frac{\\partial}{\\partial T}(0) = 0$.\nFor $TT_{c}$,\n$$\nC_{\\mathrm{sing}}(T) = T \\frac{\\partial}{\\partial T}\\left(\\frac{(a')^2(T-T_c)}{2b}\\right) = T \\frac{(a')^2}{2b}\n$$\nThe specific heat jump at the transition, $\\Delta C$, is defined as:\n$$\n\\Delta C = \\lim_{T\\to T_{c}^{-}}C(T) - \\lim_{T\\to T_{c}^{+}}C(T) = \\lim_{T\\to T_{c}^{-}}C_{\\mathrm{sing}}(T) - \\lim_{T\\to T_{c}^{+}}C_{\\mathrm{sing}}(T)\n$$\n$$\n\\lim_{T\\to T_{c}^{-}}C_{\\mathrm{sing}}(T) = \\lim_{T\\to T_{c}^{-}}\\left(T \\frac{(a')^2}{2b}\\right) = \\frac{(a')^2 T_c}{2b}\n$$\n$$\n\\lim_{T\\to T_{c}^{+}}C_{\\mathrm{sing}}(T) = \\lim_{T\\to T_{c}^{+}}(0) = 0\n$$\nTherefore, the jump is:\n$$\n\\Delta C = \\frac{(a')^2 T_c}{2b} - 0 = \\frac{(a')^2 T_c}{2b}\n$$\nTo determine the critical exponent $\\alpha$, we analyze the behavior of the singular part of the specific heat, $C_{\\mathrm{sing}}(T)$, as $T \\to T_c$. The scaling law is defined as $C_{\\mathrm{sing}}(T) \\sim |t|^{-\\alpha}$, where $t=(T-T_c)/T_c$.\nAs shown above, for $TT_c$ ($t0$), $C_{\\mathrm{sing}}(T)=0$. For $TT_c$ ($t0$), $C_{\\mathrm{sing}}(T)$ approaches a finite, non-zero constant, $\\frac{(a')^2 T_c}{2b}$, as $T \\to T_c^-$. This finite jump discontinuity means that the specific heat does not diverge. The scaling behavior is that of a constant, which can be written as $|t|^0=1$.\n$$\nC_{\\mathrm{sing}}(T) \\sim |t|^{-\\alpha} \\sim \\text{constant} \\propto |t|^0\n$$\nComparing the exponents, we find $-\\alpha = 0$, which implies $\\alpha=0$. This value for the exponent $\\alpha$ is the standard mean-field result for a system with a specific heat jump.\n\nThe two quantities to be determined are the specific heat jump $\\Delta C$ and the critical exponent $\\alpha$.\n$$\n\\Delta C = \\frac{(a')^2 T_c}{2b}\n$$\n$$\n\\alpha = 0\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(a')^{2} T_{c}}{2b}  0 \\end{pmatrix}}\n$$", "id": "3008513"}, {"introduction": "While the Landau expansion provides a powerful general framework, its principles are vividly illustrated when applied to a specific microscopic model like the Ising ferromagnet. This hands-on computational practice [@problem_id:3008495] bridges the gap between phenomenological theory and a concrete statistical model using the Weiss mean-field approximation. By numerically solving the self-consistency equation for magnetization, you will not only calculate equilibrium properties but also explore the crucial concept of selecting the thermodynamically stable state, bringing the theory to life through computation.", "problem": "Consider a ferromagnetic Ising-like system in the Weiss Mean-Field Theory (MFT). Let the order parameter be the magnetization per spin, denoted by $m$, and the microscopic exchange parameter be $Jgt;0$ with coordination number $z$. In MFT, the uniform magnetization at temperature $T$ and external field $h$ satisfies the self-consistency relation\n$$\nm \\;=\\; \\tanh\\!\\big(\\beta\\,[z J\\, m + h]\\big),\n$$\nwith $\\beta \\equiv 1/T$. Work in units where the Boltzmann constant is set to unity (so $T$ and $h$ carry energy units set by $J$). The critical temperature in MFT is $T_c = zJ$. The thermodynamically stable branch must be selected by minimizing the mean-field free energy per spin\n$$\nf(m;T,h) \\;=\\; \\tfrac{1}{2}\\, z J\\, m^2 \\;-\\; \\frac{1}{\\beta}\\,\\ln\\!\\Big[2\\cosh\\!\\big(\\beta\\,(zJ\\,m+h)\\big)\\Big],\n$$\nover $m\\in[-1,1]$. The magnetic susceptibility is defined as the differential response at zero field,\n$$\n\\chi(T) \\;\\equiv\\; \\left.\\frac{\\partial m}{\\partial h}\\right|_{h=0},\n$$\nwhich can be expressed exactly by differentiating the self-consistency equation with respect to $h$ and evaluating the result on the stable solution at $h=0$.\n\nYour tasks are:\n- Implement a robust numerical routine to compute the stable magnetization $m(h,T)$ for given $(h,T)$ by solving the self-consistency equation and selecting the thermodynamically stable solution via the free-energy minimization criterion stated above.\n- Derive an exact expression for $\\chi(T)$ in terms of $\\beta$, $zJ$, $m$, and hyperbolic functions by differentiating the self-consistency equation with respect to $h$ and solving algebraically for $\\partial m/\\partial h$. Implement this expression, evaluated at $h=0$ and at the stable $m(h=0,T)$, to compute $\\chi(T)$.\n- Use $z=6$, $J=1$, so that $T_c = 6$. All temperatures $T$ and fields $h$ below are given in units with $k_B=1$ and $J=1$, and magnetization $m$ is dimensionless. The susceptibility $\\chi$ is to be reported in inverse-field units consistent with these choices.\n\nTest suite. Your program must compute:\n- Magnetization values $m(h,T)$ for the following $(T,h)$ pairs:\n  1. $(T,h)=(6.5,\\,0.1)$,\n  2. $(T,h)=(5.5,\\,0.0)$, where in the case of multiple thermodynamically equivalent minima at $h=0$, return the nonnegative stable solution,\n  3. $(T,h)=(6.0,\\,10^{-4})$,\n  4. $(T,h)=(100.0,\\,1.0)$,\n  5. $(T,h)=(0.5,\\,-10^{-6})$.\n- Zero-field susceptibilities at temperatures near the critical point:\n  6. $\\chi(T)$ at $T=6.1$,\n  7. $\\chi(T)$ at $T=5.9$,\n  8. The amplitude ratio $R \\equiv \\chi(6.1)/\\chi(5.9)$.\n\nScientific realism and interpretation notes: You should expect a smooth paramagnetic curve for $Tgt;T_c$, spontaneous symmetry breaking below $T_c$ with $m\\neq 0$ at $h=0$, a nonlinear critical response near $T_c$ at small $h$ with an infinite slope at $h=0$, and saturation at low $T$. The susceptibility should diverge as $T\\to T_c$ and exhibit distinct amplitudes above and below $T_c$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$$\n[m(0.1,6.5),\\,m(0.0,5.5),\\,m(10^{-4},6.0),\\,m(1.0,100.0),\\,m(-10^{-6},0.5),\\,\\chi(6.1),\\,\\chi(5.9),\\,R].\n$$\nAll entries must be printed as floating-point numbers. No additional text or units should be printed. Angles are not involved in this problem. Physical quantities are to be reported in the units specified above.", "solution": "The problem is assessed to be **valid**. It provides a self-contained, scientifically sound, and well-posed problem within the standard framework of Weiss Mean-Field Theory for an Ising ferromagnet. All necessary equations, parameters, and conditions are explicitly stated and are consistent with established principles of statistical mechanics.\n\nThe solution proceeds in two main parts: first, the implementation of a numerical solver for the stable magnetization $m(T,h)$, and second, the derivation and implementation of an analytical expression for the zero-field magnetic susceptibility $\\chi(T)$.\n\n**1. Numerical Solution for Stable Magnetization $m(T,h)$**\n\nThe magnetization per spin, $m$, is determined by the self-consistency equation:\n$$\nm = \\tanh(\\beta(zJm + h))\n$$\nwhere $\\beta = 1/T$, $z$ is the coordination number, $J$ is the exchange coupling, and $h$ is the external magnetic field. This is a transcendental equation for $m$. To facilitate numerical solution, it is rewritten as a root-finding problem for the function $g(m)$:\n$$\ng(m) = m - \\tanh(\\beta(zJm + h)) = 0\n$$\nThe domain for $m$ is physically constrained to $m \\in [-1, 1]$. An analysis of $g(m)$ reveals that $g(-1) = -1 - \\tanh(\\beta(-zJ+h))  0$ and $g(1) = 1 - \\tanh(\\beta(zJ+h))  0$, which guarantees the existence of at least one root within the interval $[-1, 1]$.\n\nFor temperatures $T$ above the critical temperature $T_c = zJ$, there is a unique solution for $m$. For $T  T_c$, there can be up to three distinct real roots. The physically realized, thermodynamically stable state corresponds to the value of $m$ that minimizes the mean-field free energy per spin, $f(m; T, h)$:\n$$\nf(m;T,h) = \\frac{1}{2} z J m^2 - T \\ln\\Big[2\\cosh\\big(\\beta(zJm+h)\\big)\\Big]\n$$\nThe numerical algorithm to find the stable magnetization $m(T,h)$ is as follows:\n1.  Define the function $g(m)$ for the given parameters $T$ and $h$.\n2.  Find all roots of $g(m)=0$ in the interval $m \\in [-1, 1]$. This is robustly achieved by dividing the interval into a fine grid and using a bracketing root-finder, such as Brent's method (`scipy.optimize.brentq`), in any sub-interval where a sign change of $g(m)$ is detected. This ensures all solutions are found.\n3.  For each root $m_i$ found, evaluate the free energy $f(m_i; T, h)$. To prevent numerical overflow for large arguments of the hyperbolic cosine, the term $\\ln(2\\cosh(x))$ is computed using the identity $\\ln(2\\cosh(x)) = |x| + \\ln(1 + e^{-2|x|})$.\n4.  The stable solution is the root $m^*$ that corresponds to the global minimum of the free energy.\n5.  A special condition is handled for $T  T_c$ and $h=0$: the free energy is an even function of $m$, leading to two degenerate minima at $\\pm m_0$. As instructed, the non-negative solution, $+m_0$, is returned.\n\n**2. Analytical Expression for Susceptibility $\\chi(T)$**\n\nThe zero-field magnetic susceptibility is defined as $\\chi(T) \\equiv (\\partial m / \\partial h)|_{h=0}$. An analytical expression is derived by implicitly differentiating the self-consistency equation with respect to $h$:\n$$\n\\frac{\\partial m}{\\partial h} = \\frac{d}{dh} \\left[ \\tanh(\\beta(zJm + h)) \\right]\n$$\nApplying the chain rule:\n$$\n\\frac{\\partial m}{\\partial h} = \\text{sech}^2(\\beta(zJm + h)) \\cdot \\left[ \\beta \\left( zJ \\frac{\\partial m}{\\partial h} + 1 \\right) \\right]\n$$\nSolving this equation for $\\partial m / \\partial h$ yields:\n$$\n\\frac{\\partial m}{\\partial h} = \\frac{\\beta\\,\\text{sech}^2(\\beta(zJm + h))}{1 - \\beta zJ\\,\\text{sech}^2(\\beta(zJm + h))}\n$$\nTo find $\\chi(T)$, we evaluate this expression at $h=0$. Let $m_0(T)$ be the stable, zero-field magnetization at temperature $T$. The susceptibility is:\n$$\n\\chi(T) = \\frac{\\beta\\,\\text{sech}^2(\\beta zJ m_0)}{1 - \\beta zJ\\,\\text{sech}^2(\\beta zJ m_0)}\n$$\nUsing the identity $\\text{sech}^2(x) = 1 - \\tanh^2(x)$ and the fact that $m_0 = \\tanh(\\beta zJ m_0)$ at $h=0$, we can rewrite $\\text{sech}^2(\\beta zJ m_0) = 1 - m_0^2$. This gives a more elegant and numerically stable formula:\n$$\n\\chi(T) = \\frac{\\beta(1 - m_0^2)}{1 - \\beta zJ(1 - m_0^2)}\n$$\nThe computational procedure for $\\chi(T)$ is:\n1.  For a given temperature $T$, compute the stable zero-field magnetization $m_0(T)$ using the numerical method described in Part 1.\n2.  Substitute the values of $T$ (as $\\beta=1/T$) and the computed $m_0(T)$ into the final expression for $\\chi(T)$.\n\nFor the specified parameters, we use $z=6$ and $J=1$, which gives a critical temperature $T_c=6$. All calculations are performed in these units. The implementation follows these derived principles to compute the required values for the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main solver function to compute magnetization and susceptibility for the given test cases\n    within the Weiss Mean-Field Theory for an Ising model.\n    \"\"\"\n    \n    # Define physical constants from the problem statement\n    Z = 6.0\n    J = 1.0\n    TC = Z * J  # Critical temperature\n\n    def _get_m_roots(T, h):\n        \"\"\"\n        Finds all real roots of the self-consistency equation m = tanh(β(zJm + h))\n        in the interval [-1, 1] using a grid search and a bracketing root-finder.\n        \"\"\"\n        if T = 0:\n            raise ValueError(\"Temperature must be positive.\")\n        \n        beta = 1.0 / T\n        zJ = Z * J\n\n        def g(m_val):\n            return m_val - np.tanh(beta * (zJ * m_val + h))\n\n        roots = set()\n\n        # The function g(m) has g(-1)  0 and g(1)  0, so at least one root exists.\n        # To find all roots (up to three), we scan for sign changes on a fine grid.\n        m_grid = np.linspace(-1.0, 1.0, num=4001)\n        g_grid = g(m_grid)\n        \n        for i in range(len(m_grid) - 1):\n            if np.sign(g_grid[i]) != np.sign(g_grid[i+1]):\n                try:\n                    root = brentq(g, m_grid[i], m_grid[i+1])\n                    roots.add(root)\n                except ValueError:\n                    # This should not be reached due to the check for sign change\n                    pass\n        \n        # Ensure m=0 is considered if it is a root (case h=0)\n        if h == 0.0 and np.isclose(g(0.0), 0.0):\n            roots.add(0.0)\n\n        # As a fallback, if no sign changes were found (e.g., tangent root),\n        # brentq on the whole interval guarantees finding at least one root.\n        if not roots:\n            try:\n                root = brentq(g, -1.0, 1.0)\n                roots.add(root)\n            except ValueError:\n                # Highly unlikely given the properties of g(m)\n                pass\n\n        return list(roots)\n\n    def solve_m(T, h):\n        \"\"\"\n        Computes the stable magnetization m(T, h) by finding the root of the\n        self-consistency equation that minimizes the mean-field free energy.\n        \"\"\"\n        beta = 1.0 / T\n        zJ = Z * J\n        \n        roots = _get_m_roots(T, h)\n        \n        if not roots:\n            raise RuntimeError(f\"Could not find any solution for m at T={T}, h={h}.\")\n\n        if len(roots) == 1:\n            return roots[0]\n            \n        def free_energy(m_val):\n            \"\"\"Numerically stable free energy function.\"\"\"\n            arg = beta * (zJ * m_val + h)\n            # Use stable log(2*cosh(x)) = |x| + log(1+exp(-2|x|)) to avoid overflow\n            log_2cosh_term = np.abs(arg) + np.log(1.0 + np.exp(-2.0 * np.abs(arg)))\n            return 0.5 * zJ * m_val**2 - T * log_2cosh_term\n\n        energies = [free_energy(m_val) for m_val in roots]\n        stable_m = roots[np.argmin(energies)]\n        \n        # Apply special rule from problem for TTc, h=0 (degenerate minima)\n        if T  TC and h == 0.0:\n            return np.abs(stable_m)\n        \n        return stable_m\n\n    def calculate_chi(T):\n        \"\"\"\n        Calculates the zero-field susceptibility χ(T) using the analytical formula\n        derived from the self-consistency equation.\n        \"\"\"\n        beta = 1.0 / T\n        zJ = Z * J\n        \n        # Find the stable magnetization at zero field, m0\n        m0 = solve_m(T, 0.0)\n        \n        # Use derived expression: χ = β(1-m₀²)/(1-βzJ(1-m₀²))\n        m0_sq = m0**2\n        numerator = beta * (1.0 - m0_sq)\n        denominator = 1.0 - beta * zJ * (1.0 - m0_sq)\n        \n        if np.isclose(denominator, 0.0):\n            # This happens exactly at T=Tc, where χ diverges\n            return np.inf\n        \n        return numerator / denominator\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'm', 'T': 6.5, 'h': 0.1},\n        {'type': 'm', 'T': 5.5, 'h': 0.0},\n        {'type': 'm', 'T': 6.0, 'h': 1e-4},\n        {'type': 'm', 'T': 100.0, 'h': 1.0},\n        {'type': 'm', 'T': 0.5, 'h': -1.0e-6},\n        {'type': 'chi', 'T': 6.1},\n        {'type': 'chi', 'T': 5.9},\n    ]\n\n    results = []\n    \n    # Calculate magnetizations and susceptibilities\n    for case in test_cases:\n        if case['type'] == 'm':\n            results.append(solve_m(case['T'], case['h']))\n        elif case['type'] == 'chi':\n            results.append(calculate_chi(case['T']))\n\n    # The 8th result is the amplitude ratio R\n    chi_6_1 = results[5]\n    chi_5_9 = results[6]\n    R = chi_6_1 / chi_5_9\n    results.append(R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3008495"}]}