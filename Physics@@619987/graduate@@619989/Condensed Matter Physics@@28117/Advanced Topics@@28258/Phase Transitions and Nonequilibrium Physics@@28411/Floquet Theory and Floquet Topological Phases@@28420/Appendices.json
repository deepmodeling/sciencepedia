{"hands_on_practices": [{"introduction": "A central theme in Floquet theory is the distinction between high-frequency driving and resonant driving. While high-frequency expansions provide a powerful tool for creating effective static Hamiltonians, they fundamentally break down when the drive frequency $\\Omega$ is tuned close to a natural transition frequency $\\omega_{0}$ of the system. This practice [@problem_id:2990411] challenges you to explain the physical origin of this failure and identify the indispensable alternative framework—the rotating-wave approximation (RWA)—which correctly captures the non-perturbative physics of resonant phenomena like Rabi splitting.", "problem": "Consider a periodically driven $2$-level system with Hamiltonian $H(t)$ that is strictly periodic in time, $H(t+T)=H(t)$ with period $T=2\\pi/\\Omega$. The unperturbed Hamiltonian is $H_{0}=\\frac{\\hbar \\omega_{0}}{2}\\sigma_{z}$, and the drive couples the two levels via $H_{\\mathrm{d}}(t)=\\hbar g\\cos(\\Omega t)\\,\\sigma_{x}$, so that\n$$\nH(t)=\\frac{\\hbar \\omega_{0}}{2}\\sigma_{z}+\\hbar g\\cos(\\Omega t)\\,\\sigma_{x}.\n$$\nFloquet theory states that solutions of the Schrödinger equation with time-periodic Hamiltonian can be written as $|\\psi_{\\alpha}(t)\\rangle=e^{-\\mathrm{i}\\varepsilon_{\\alpha}t/\\hbar}|u_{\\alpha}(t)\\rangle$, where $|u_{\\alpha}(t)\\rangle$ is $T$-periodic and $\\varepsilon_{\\alpha}$ are the quasienergies. High-frequency expansions such as the Floquet-Magnus expansion (FME) or van Vleck expansion aim to construct an effective time-independent Hamiltonian $H_{\\mathrm{eff}}$ valid when the drive frequency $\\Omega$ is the largest energy scale.\n\nIn the resonant regime $\\Omega\\approx\\omega_{0}$, explain from first principles why high-frequency expansions fail and identify an alternative method that correctly captures the quasienergy (Rabi) splitting. Your explanation should use only core definitions and well-tested facts about Floquet theory, and it must articulate the physical mechanism behind the breakdown and the mathematical construction of an effective description that remains valid near resonance. Then, select the option that most accurately states both the reason for the failure and a correct rotating-frame treatment that yields the appropriate effective Hamiltonian and the resulting quasienergy splitting.\n\nA. High-frequency expansions converge more rapidly at resonance because the drive averages out exactly; the correct effective Hamiltonian is the static time average $H_{\\mathrm{eff}}=\\frac{\\hbar \\omega_{0}}{2}\\sigma_{z}$, and the quasienergy splitting is $\\Delta\\varepsilon=\\frac{\\hbar g}{2}$.\n\nB. High-frequency expansions fail at resonance due to small denominators that arise from near-degenerate couplings between neighboring photon sectors in the extended (Sambe) space; transforming to the rotating frame with $U(t)=\\exp\\!\\left(\\mathrm{i}\\frac{\\Omega t}{2}\\sigma_{z}\\right)$ and applying the rotating-wave approximation (RWA) yields $H_{\\mathrm{eff}}^{\\mathrm{RWA}}=\\frac{\\hbar \\delta}{2}\\sigma_{z}+\\frac{\\hbar g}{2}\\sigma_{x}$ with $\\delta=\\omega_{0}-\\Omega$, and the quasienergy (Rabi) splitting $\\Delta\\varepsilon=\\hbar\\sqrt{\\delta^{2}+g^{2}}$.\n\nC. High-frequency expansions fail because the cosine drive breaks time periodicity, so Floquet theory is inapplicable; diagonalizing in the $\\sigma_{x}$ basis produces the effective splitting $\\Delta\\varepsilon=\\hbar|\\omega_{0}-\\Omega|$ without any rotating-frame transformation.\n\nD. High-frequency expansions fail only because they omit counter-rotating terms; using a rotating frame about $\\sigma_{x}$ at frequency $2\\Omega$ gives $H_{\\mathrm{eff}}=\\frac{\\hbar}{2}\\left(\\omega_{0}-2\\Omega\\right)\\sigma_{x}+\\hbar g\\,\\sigma_{z}$ and the quasienergy splitting $\\Delta\\varepsilon=\\hbar\\sqrt{\\left(\\omega_{0}-2\\Omega\\right)^{2}+\\left(2g\\right)^{2}}$.\n\nE. At resonance, off-diagonal couplings vanish in the Magnus expansion, so the eigenstates remain exact and there is no level repulsion; a static Schrieffer-Wolff transformation that integrates out the drive yields $H_{\\mathrm{eff}}=\\frac{\\hbar \\omega_{0}}{2}\\sigma_{z}$ with zero splitting.", "solution": "The problem statement is a valid and standard exercise in the study of periodically driven quantum systems, a central topic in condensed matter physics and quantum optics. It concerns the behavior of a driven two-level system in the resonant regime, a scenario where high-frequency approximations break down and a different approach is required.\n\n### Principle-Based Derivation\n\nThe analysis of a time-periodic Hamiltonian $H(t)=H(t+T)$ is framed by Floquet's theorem. It asserts that the solutions to the time-dependent Schrödinger equation $i\\hbar \\frac{d}{dt}|\\psi(t)\\rangle=H(t)|\\psi(t)\\rangle$ can be written in the form $|\\psi_{\\alpha}(t)\\rangle=e^{-\\mathrm{i}\\varepsilon_{\\alpha}t/\\hbar}|u_{\\alpha}(t)\\rangle$, where $|u_{\\alpha}(t)\\rangle$ are the periodic Floquet modes, $|u_{\\alpha}(t+T)\\rangle=|u_{\\alpha}(t)\\rangle$, and $\\varepsilon_{\\alpha}$ are the quasienergies. The quasienergies are eigenvalues of the Floquet Hamiltonian $\\mathcal{K} = H(t) - i\\hbar\\frac{d}{dt}$, defined on an extended Hilbert space (the Sambe space) $\\mathcal{H} \\otimes \\mathcal{F}$, where $\\mathcal{H}$ is the system's Hilbert space and $\\mathcal{F}$ is the space of $T$-periodic functions.\n\nThe Hamiltonian is given by $H(t) = H_0 + V(t)$, with $H_{0}=\\frac{\\hbar \\omega_{0}}{2}\\sigma_{z}$ and $V(t)=\\hbar g\\cos(\\Omega t)\\,\\sigma_{x} = \\frac{\\hbar g}{2}\\sigma_x(e^{i\\Omega t} + e^{-i\\Omega t})$. In the Sambe space, using a basis of states $|\\sigma, n\\rangle$, where $\\sigma \\in \\{\\uparrow, \\downarrow\\}$ and $n \\in \\mathbb{Z}$ represents the Fourier mode $e^{in\\Omega t}$, the Floquet Hamiltonian $\\mathcal{K}$ has matrix elements:\n$$\n\\langle\\langle \\sigma', m | \\mathcal{K} | \\sigma, n \\rangle\\rangle = \\langle \\sigma' | H_0 | \\sigma \\rangle \\delta_{m,n} + n\\hbar\\Omega \\delta_{\\sigma',\\sigma}\\delta_{m,n} + \\langle \\sigma' | V_k | \\sigma \\rangle \\delta_{m,n+k}\n$$\nwhere $V_k$ are the Fourier components of the drive $V(t) = \\sum_k V_k e^{ik\\Omega t}$. The non-zero components are for $k = \\pm 1$.\n\nThe \"unperturbed\" diagonal energies in this basis are the eigenvalues of $H_0 + n\\hbar\\Omega$, which are $E_{\\uparrow,n} = \\frac{\\hbar\\omega_0}{2} + n\\hbar\\Omega$ and $E_{\\downarrow,n} = -\\frac{\\hbar\\omega_0}{2} + n\\hbar\\Omega$. The driving term $\\frac{\\hbar g}{2}\\sigma_x$ couples states $|\\sigma, n\\rangle$ to $|\\sigma', n\\pm 1\\rangle$.\n\n**1. Failure of High-Frequency Expansions at Resonance:**\nHigh-frequency expansions, like the Floquet-Magnus or van Vleck expansion, are perturbative treatments in powers of $1/\\Omega$. Such expansions are valid when the coupling strength (here, $\\hbar g$) is much smaller than the energy separation of the states it connects. The drive couples states such as $|\\uparrow, n\\rangle$ and $|\\downarrow, n+1\\rangle$. The energy difference between these states is:\n$$\n\\Delta E = E_{\\uparrow,n} - E_{\\downarrow,n+1} = \\left(\\frac{\\hbar\\omega_0}{2} + n\\hbar\\Omega\\right) - \\left(-\\frac{\\hbar\\omega_0}{2} + (n+1)\\hbar\\Omega\\right) = \\hbar(\\omega_0 - \\Omega)\n$$\nIn the resonant regime, $\\omega_0 \\approx \\Omega$, this energy difference $\\Delta E$ approaches zero. Perturbation theory involves terms with denominators of the form $1/\\Delta E$. As $\\Delta E \\to 0$, these terms diverge. This is the \"small denominator problem\". The perturbative series fails to converge, invalidating the high-frequency expansion. The physical reason is that the drive frequency matches the system's natural transition frequency, leading to efficient energy exchange and Rabi oscillations, a non-perturbative phenomenon.\n\n**2. Alternative Method: Rotating-Wave Approximation (RWA):**\nWhen a particular coupling becomes resonant, it must be treated exactly. This is achieved by transforming into a reference frame that rotates with the drive frequency $\\Omega$. We define a unitary transformation $U(t) = e^{-i\\Omega t\\sigma_z/2}$ and compute the transformed Hamiltonian using the standard definition $H_R(t) = U(t)^\\dagger H(t) U(t) - i\\hbar U(t)^\\dagger \\frac{dU(t)}{dt}$. The static part and the transformation term combine to give the detuning:\n$$ U^\\dagger H_0 U - i\\hbar U^\\dagger \\frac{dU}{dt} = \\frac{\\hbar\\omega_0}{2}\\sigma_z - \\frac{\\hbar\\Omega}{2}\\sigma_z = \\frac{\\hbar\\delta}{2}\\sigma_z, \\quad \\text{where } \\delta = \\omega_0 - \\Omega. $$\nThe drive term transforms into a combination of a static part and a fast-oscillating part:\n$$ U^\\dagger V(t) U = \\frac{\\hbar g}{2}\\sigma_x + \\frac{\\hbar g}{2}(\\sigma_x \\cos(2\\Omega t) - \\sigma_y \\sin(2\\Omega t)). $$\nThe rotating-wave approximation (RWA) consists of neglecting the fast-oscillating (\"counter-rotating\") terms, which average to zero over the timescale of the resonant dynamics. This approximation is valid when $|\\delta|, |g| \\ll \\Omega$. This procedure yields the time-independent effective Hamiltonian:\n$$\nH_{\\mathrm{eff}}^{\\mathrm{RWA}} = \\frac{\\hbar\\delta}{2}\\sigma_z + \\frac{\\hbar g}{2}\\sigma_x\n$$\n\n**3. Quasienergy Splitting:**\nThe eigenvalues of this effective Hamiltonian correspond to the quasienergies in the rotating frame. For a Hamiltonian of the form $A\\sigma_z + B\\sigma_x$, the eigenvalues are $\\pm\\sqrt{A^2+B^2}$. With $A=\\frac{\\hbar\\delta}{2}$ and $B=\\frac{\\hbar g}{2}$, the eigenvalues are:\n$$\n\\varepsilon_{\\pm} = \\pm\\sqrt{\\left(\\frac{\\hbar\\delta}{2}\\right)^2 + \\left(\\frac{\\hbar g}{2}\\right)^2} = \\pm\\frac{\\hbar}{2}\\sqrt{\\delta^2+g^2}\n$$\nThe splitting between these quasienergy levels is the difference $\\varepsilon_+ - \\varepsilon_-$, known as the Rabi splitting:\n$$\n\\Delta\\varepsilon = \\hbar\\sqrt{\\delta^2 + g^2}\n$$\nThis result correctly captures the resonant physics, showing a minimum gap of $\\hbar g$ at exact resonance ($\\delta=0$)—a feature entirely missed by naive high-frequency expansions.\n\n### Option-by-Option Analysis\n\n**A. High-frequency expansions converge more rapidly at resonance because the drive averages out exactly; the correct effective Hamiltonian is the static time average $H_{\\mathrm{eff}}=\\frac{\\hbar \\omega_{0}}{2}\\sigma_{z}$, and the quasienergy splitting is $\\Delta\\varepsilon=\\frac{\\hbar g}{2}$.**\nThis statement is fundamentally incorrect. High-frequency expansions *fail* at resonance, they do not converge more rapidly. The effective Hamiltonian given is the zeroth-order approximation, which is inadequate at resonance. The stated splitting is also incorrect. **Incorrect**.\n\n**B. High-frequency expansions fail at resonance due to small denominators that arise from near-degenerate couplings between neighboring photon sectors in the extended (Sambe) space; transforming to the rotating frame with $U(t)=\\exp\\!\\left(\\mathrm{i}\\frac{\\Omega t}{2}\\sigma_{z}\\right)$ and applying the rotating-wave approximation (RWA) yields $H_{\\mathrm{eff}}^{\\mathrm{RWA}}=\\frac{\\hbar \\delta}{2}\\sigma_{z}+\\frac{\\hbar g}{2}\\sigma_{x}$ with $\\delta=\\omega_{0}-\\Omega$, and the quasienergy (Rabi) splitting $\\Delta\\varepsilon=\\hbar\\sqrt{\\delta^{2}+g^{2}}$.**\nThis option provides a precise and complete account. It correctly identifies the failure mechanism (small denominators from near-degenerate photon sectors), prescribes the correct alternative method (transformation to rotating frame and RWA), presents the correct effective Hamiltonian, and states the correct formula for the quasienergy splitting. Every part of this statement aligns with the first-principles derivation above. (Note: The specific choice of sign in the exponent of $U$ is a convention, but it leads to the same physical result). **Correct**.\n\n**C. High-frequency expansions fail because the cosine drive breaks time periodicity, so Floquet theory is inapplicable; diagonalizing in the $\\sigma_{x}$ basis produces the effective splitting $\\Delta\\varepsilon=\\hbar|\\omega_{0}-\\Omega|$ without any rotating-frame transformation.**\nThis is incorrect. A cosine drive is periodic, making Floquet theory the appropriate framework. The premise is false. The proposed solution and resulting splitting are also incorrect and physically meaningless in this context. **Incorrect**.\n\n**D. High-frequency expansions fail only because they omit counter-rotating terms; using a rotating frame about $\\sigma_{x}$ at frequency $2\\Omega$ gives $H_{\\mathrm{eff}}=\\frac{\\hbar}{2}\\left(\\omega_{0}-2\\Omega\\right)\\sigma_{x}+\\hbar g\\,\\sigma_{z}$ and the quasienergy splitting $\\Delta\\varepsilon=\\hbar\\sqrt{\\left(\\omega_{0}-2\\Omega\\right)^{2}+\\left(2g\\right)^{2}}$.**\nThe reason for failure is the divergence of the perturbation series, not merely the omission of counter-rotating terms (which is part of the RWA solution). The proposed transformation (rotation about $\\sigma_x$ at frequency $2\\Omega$) is incorrect for this problem, leading to a wrong effective Hamiltonian and splitting. **Incorrect**.\n\n**E. At resonance, off-diagonal couplings vanish in the Magnus expansion, so the eigenstates remain exact and there is no level repulsion; a static Schrieffer-Wolff transformation that integrates out the drive yields $H_{\\mathrm{eff}}=\\frac{\\hbar \\omega_{0}}{2}\\sigma_{z}$ with zero splitting.**\nThis statement is wrong on multiple counts. Off-diagonal couplings in the Magnus expansion do not vanish; in fact, they diverge. Resonance causes maximum level repulsion (the Rabi gap), not its absence. A Schrieffer-Wolff transformation is a perturbative tool, equivalent to van Vleck expansion, and fails at resonance for the same reasons. The proposed effective Hamiltonian is the incorrect zeroth-order approximation. **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "2990411"}, {"introduction": "One of the most powerful applications of periodic driving is \"Floquet engineering\"—the creation of effective band structures with properties not found in the static system. This exercise [@problem_id:2990451] provides a concrete example by showing how a simple drive can open a gap in the otherwise gapless Su-Schrieffer-Heeger (SSH) model at its critical point. You will put the formal theory into practice by constructing and diagonalizing a truncated Floquet-Sambe Hamiltonian, a cornerstone technique for analyzing periodically driven lattice systems.", "problem": "Consider the Su-Schrieffer-Heeger (SSH) model, a one-dimensional dimerized tight-binding chain with intracell hopping amplitude $t_{1}$ and intercell hopping amplitude $t_{2}$. In crystal momentum representation, the static Bloch Hamiltonian in the sublattice basis can be written as $H_{0}(k) = d_{x}(k)\\,\\sigma_{x} + d_{y}(k)\\,\\sigma_{y}$, where $d_{x}(k) = t_{1} + t_{2}\\cos k$ and $d_{y}(k) = t_{2}\\sin k$, and $\\sigma_{x}$, $\\sigma_{y}$ are Pauli matrices acting in the sublattice (A/B) space. Now subject the system to a monochromatic drive that periodically modulates the intracell hopping as $t_{1}(t) = t_{1} + A\\cos(\\omega t)$ with amplitude $A$ and angular frequency $\\omega$, so that the full Hamiltonian is $H(k,t) = H_{0}(k) + V(k)\\cos(\\omega t)$, with $V(k) = A\\,\\sigma_{x}$.\n\nUsing the Floquet theorem and the Sambe space construction, define Fourier components $H_{m}(k) = \\frac{1}{T}\\int_{0}^{T} \\mathrm{d}t\\, H(k,t)\\,\\exp(-\\mathrm{i} m \\omega t)$ for $T = 2\\pi/\\omega$, and consider the truncated Sambe (extended Hilbert) space restricted to Fourier indices $m \\in \\{-1,0,+1\\}$. Starting from the time-dependent Schrödinger equation and the Floquet eigenvalue formulation in Sambe space, write down the explicit $3 \\times 3$ block matrix representation of the truncated Floquet-Sambe Hamiltonian $H_{\\mathrm{S}}(k)$, where each block acts in the $2 \\times 2$ sublattice space.\n\nThen, specialize to the critical point of the static SSH band structure where the gap closes at $k = \\pi$ when $t_{1} = t_{2}$, so that $H_{0}(\\pi) = 0$. In this situation, diagonalize the truncated Sambe matrix by an appropriate choice of sublattice basis to obtain the nonzero quasi-energy magnitude generated by the coupling between Floquet replicas in this truncation. Express that nonzero quasi-energy magnitude as a closed-form analytic expression in terms of $\\omega$ and $A$.\n\nFinally, based on first principles, discuss the validity regime of the $|m| \\leq 1$ truncation. Your discussion should be grounded in the hierarchy of energy scales, the structure of Fourier components of the drive, and the suppression of higher-photon processes, without invoking any pre-derived shortcut formulas.\n\nYour final answer should be the single closed-form analytic expression for the nonzero quasi-energy magnitude at the critical point described above. No rounding is required.", "solution": "The problem asks for an analysis of a periodically driven Su-Schrieffer-Heeger (SSH) model using Floquet theory. We are tasked with constructing the truncated Floquet-Sambe Hamiltonian, diagonalizing it at a specific critical point to find the induced quasi-energy gap, and discussing the validity of the truncation.\n\nFirst, we establish the Floquet-Sambe formalism. For a time-periodic Hamiltonian $H(t) = H(t+T)$ with period $T = 2\\pi/\\omega$, the solutions to the time-dependent Schrödinger equation $\\mathrm{i}\\hbar\\frac{\\partial}{\\partial t}|\\psi(t)\\rangle = H(t)|\\psi(t)\\rangle$ (with $\\hbar=1$) can be written as Floquet states $|\\psi_\\alpha(t)\\rangle = \\exp(-\\mathrm{i}\\epsilon_\\alpha t)|\\phi_\\alpha(t)\\rangle$. Here, $\\epsilon_\\alpha$ is the quasi-energy and $|\\phi_\\alpha(t)\\rangle$ is a periodic function with the same period $T$. These periodic Floquet modes can be expanded in a Fourier series, $|\\phi_\\alpha(t)\\rangle = \\sum_m \\exp(\\mathrm{i}m\\omega t)|\\phi_{\\alpha,m}\\rangle$. This leads to an eigenvalue equation in the extended Sambe space, an infinite-dimensional Hilbert space spanned by basis states $|m, \\beta\\rangle$, where $m$ is the Fourier index and $\\beta$ labels the basis of the original system. The Floquet-Sambe Hamiltonian, $H_\\mathrm{S}$, has matrix elements given by:\n$$ (H_\\mathrm{S})_{mn} = H_{m-n} + m\\omega I \\delta_{mn} $$\nwhere $I$ is the identity matrix in the system's Hilbert space and $H_{p}$ are the Fourier components of the time-dependent Hamiltonian:\n$$ H_{p} = \\frac{1}{T}\\int_{0}^{T} H(t) \\exp(-\\mathrm{i}p\\omega t) \\, \\mathrm{d}t $$\n\nThe given Hamiltonian is $H(k,t) = H_0(k) + V(k)\\cos(\\omega t)$, with $H_0(k) = (t_1 + t_2\\cos k)\\sigma_x + (t_2\\sin k)\\sigma_y$ and $V(k) = A\\sigma_x$. We can write $V(k)\\cos(\\omega t) = \\frac{A\\sigma_x}{2}(\\exp(\\mathrm{i}\\omega t) + \\exp(-\\mathrm{i}\\omega t))$.\nThe Fourier components are:\n$H_0 = \\frac{1}{T}\\int_0^T H(t) \\, \\mathrm{d}t = H_0(k)$.\n$H_1 = \\frac{1}{T}\\int_0^T H(t) \\exp(-\\mathrm{i}\\omega t) \\, \\mathrm{d}t = \\frac{A\\sigma_x}{2}$.\n$H_{-1} = \\frac{1}{T}\\int_0^T H(t) \\exp(\\mathrm{i}\\omega t) \\, \\mathrm{d}t = \\frac{A\\sigma_x}{2}$.\nAll other components $H_p$ for $|p| > 1$ are zero due to the monochromatic nature of the drive.\n\nThe problem requires truncating the Sambe space to Fourier indices $m \\in \\{-1, 0, 1\\}$. With the basis ordered as $\\{|1\\rangle, |0\\rangle, |-1\\rangle\\}$, the truncated $3 \\times 3$ block matrix representation of the Floquet-Sambe Hamiltonian $H_{\\mathrm{S}}(k)$ is:\n$$ H_\\mathrm{S}(k) = \\begin{pmatrix} H_0 + \\omega I & H_1 & H_2 \\\\ H_{-1} & H_0 & H_1 \\\\ H_{-2} & H_{-1} & H_0 - \\omega I \\end{pmatrix} $$\nSubstituting the calculated Fourier components ($H_{\\pm 1} = \\frac{A}{2}\\sigma_x$, $H_{\\pm 2} = 0$), we obtain the explicit form:\n$$ H_\\mathrm{S}(k) = \\begin{pmatrix} H_0(k) + \\omega I & \\frac{A}{2}\\sigma_x & 0 \\\\ \\frac{A}{2}\\sigma_x & H_0(k) & \\frac{A}{2}\\sigma_x \\\\ 0 & \\frac{A}{2}\\sigma_x & H_0(k) - \\omega I \\end{pmatrix} $$\nEach entry in this matrix is a $2 \\times 2$ matrix acting on the sublattice space.\n\nNext, we specialize to the critical point of the static SSH model, which occurs for $t_1 = t_2$ at momentum $k = \\pi$. At this point, the components of the static Bloch Hamiltonian are $d_x(\\pi) = t_1 + t_2\\cos(\\pi) = t_1 - t_2 = 0$ and $d_y(\\pi) = t_2\\sin(\\pi) = 0$. Therefore, the static Hamiltonian vanishes: $H_0(\\pi) = 0$.\nThe truncated Sambe Hamiltonian at this critical point, which we denote $H_\\mathrm{S}^{\\mathrm{crit}}$, simplifies to:\n$$ H_\\mathrm{S}^{\\mathrm{crit}} = \\begin{pmatrix} \\omega I & \\frac{A}{2}\\sigma_x & 0 \\\\ \\frac{A}{2}\\sigma_x & 0 & \\frac{A}{2}\\sigma_x \\\\ 0 & \\frac{A}{2}\\sigma_x & -\\omega I \\end{pmatrix} $$\nThis is a $6 \\times 6$ matrix, as each entry is a $2 \\times 2$ matrix. All matrix blocks are proportional to either the identity matrix $I$ or the Pauli matrix $\\sigma_x$. This structure implies that the Hamiltonian is block-diagonal in the eigenbasis of $\\sigma_x$. The eigenvalues of $\\sigma_x$ are $\\lambda = \\pm 1$. We can rotate the sublattice basis to this eigenbasis, which decouples the $6 \\times 6$ problem into two independent $3 \\times 3$ problems.\nIn the eigenspace corresponding to $\\lambda = +1$, $\\sigma_x$ is replaced by its eigenvalue $+1$, and the Hamiltonian becomes:\n$$ H_+ = \\begin{pmatrix} \\omega & A/2 & 0 \\\\ A/2 & 0 & A/2 \\\\ 0 & A/2 & -\\omega \\end{pmatrix} $$\nIn the eigenspace corresponding to $\\lambda = -1$, $\\sigma_x$ is replaced by $-1$, and the Hamiltonian becomes:\n$$ H_- = \\begin{pmatrix} \\omega & -A/2 & 0 \\\\ -A/2 & 0 & -A/2 \\\\ 0 & -A/2 & -\\omega \\end{pmatrix} $$\nNote that $H_-$ is unitarily equivalent to $-H_+$, so if the eigenvalues of $H_+$ are $\\{\\epsilon_i\\}$, the eigenvalues of $H_-$ are $\\{-\\epsilon_i\\}$. We only need to diagonalize $H_+$.\n\nThe quasi-energies $\\epsilon$ are the eigenvalues of $H_+$. We solve the characteristic equation $\\det(H_+ - \\epsilon I) = 0$:\n$$ \\det \\begin{pmatrix} \\omega - \\epsilon & A/2 & 0 \\\\ A/2 & -\\epsilon & A/2 \\\\ 0 & A/2 & -\\omega - \\epsilon \\end{pmatrix} = 0 $$\nExpanding the determinant gives:\n$$ (\\omega - \\epsilon) \\left( (-\\epsilon)(-\\omega - \\epsilon) - \\left(\\frac{A}{2}\\right)^2 \\right) - \\frac{A}{2} \\left( \\frac{A}{2}(-\\omega - \\epsilon) \\right) = 0 $$\n$$ (\\omega - \\epsilon) (\\epsilon^2 + \\omega\\epsilon - \\frac{A^2}{4}) + \\frac{A^2}{4}(\\omega + \\epsilon) = 0 $$\n$$ \\omega\\epsilon^2 + \\omega^2\\epsilon - \\frac{\\omega A^2}{4} - \\epsilon^3 - \\omega\\epsilon^2 + \\frac{\\epsilon A^2}{4} + \\frac{\\omega A^2}{4} + \\frac{\\epsilon A^2}{4} = 0 $$\nSeveral terms cancel, simplifying the equation to:\n$$ -\\epsilon^3 + (\\omega^2 + \\frac{A^2}{2})\\epsilon = 0 $$\n$$ -\\epsilon (\\epsilon^2 - (\\omega^2 + \\frac{A^2}{2})) = 0 $$\nThe solutions for $\\epsilon$ are $\\epsilon_1=0$ and $\\epsilon_{2,3} = \\pm\\sqrt{\\omega^2 + \\frac{A^2}{2}}$.\nThese are the three quasi-energies for the $\\sigma_x = +1$ sector. The quasi-energies for the $\\sigma_x = -1$ sector are the negatives of these, which results in the same set of values. Thus, the six quasi-energies of the truncated system at the critical point are $\\{0, 0, \\sqrt{\\omega^2 + \\frac{A^2}{2}}, \\sqrt{\\omega^2 + \\frac{A^2}{2}}, -\\sqrt{\\omega^2 + \\frac{A^2}{2}}, -\\sqrt{\\omega^2 + \\frac{A^2}{2}}\\}$. The drive lifts the degeneracy at the zero-energy crossing, opening a gap in the quasi-energy spectrum. The magnitude of the nonzero quasi-energies is $\\sqrt{\\omega^2 + \\frac{A^2}{2}}$.\n\nFinally, we discuss the validity regime of the $|m| \\leq 1$ truncation from first principles. The truncation neglects the Floquet replicas with $|m| \\geq 2$. This approximation is justified if the coupling to these higher-energy replicas is weak enough to be ignored.\nThe structure of the Floquet-Sambe Hamiltonian reveals that the diagonal blocks, indexed by $m$, are separated in energy by integer multiples of the drive frequency $\\omega$. Specifically, the unperturbed energy of the $m$-th block is $m\\omega$ (since $H_0(\\pi)=0$). The off-diagonal blocks $H_{\\pm 1} = \\frac{A}{2}\\sigma_x$ represent the coupling between adjacent replicas, with a strength proportional to the drive amplitude $A$.\nThe truncation is valid in the high-frequency regime, where the drive frequency $\\omega$ is much larger than the energy scale of the coupling it induces. In terms of the parameters of the problem, this condition is $A \\ll \\omega$. In this limit, transitions to higher Floquet replicas ($m=\\pm 2, \\pm 3, \\ldots$) are energetically costly and thus suppressed.\nFrom a perturbative standpoint, the effect of the $|m|=2$ replica on the $|m|=1$ replica can be estimated. The coupling is of order $A/2$, and the energy separation is $|(H_0+2\\omega I)-(H_0+\\omega I)| \\approx \\omega$. The second-order energy correction to the states in the $|m| \\le 1$ subspace due to coupling with the $|m|=2$ states is roughly of the order $(A/2)^2/\\omega = A^2/(4\\omega)$. For the truncation to be valid, this correction must be small compared to the energy scales of interest, such as the calculated quasi-energy gap itself. As the quasi-energy is on the order of $\\omega$ in this limit, the condition $A^2/(4\\omega) \\ll \\omega$, or $A^2 \\ll 4\\omega^2$, simplifies to $A \\ll \\omega$.\nIt is also essential that the drive is monochromatic, containing only the $\\pm\\omega$ frequency components. This ensures that $H_m=0$ for $|m| \\ge 2$, meaning there are no direct couplings between non-adjacent Floquet blocks (e.g., between $m=0$ and $m=2$). The coupling to higher replicas is only indirect (e.g., $0 \\to 1 \\to 2$), which further suppresses their effect and strengthens the validity of the truncation in the $A \\ll \\omega$ regime.", "answer": "$$ \\boxed{\\sqrt{\\omega^2 + \\frac{A^2}{2}}} $$", "id": "2990451"}, {"introduction": "The ultimate promise of Floquet engineering is the creation of novel topological phases of matter, which have no static counterparts. This computational exercise [@problem_id:2990386] brings this concept to life by examining the driven Kitaev chain, a paradigmatic model for topological superconductivity. You will translate the abstract theory of Floquet topological phases into a tangible numerical simulation, identifying their definitive signature: protected Majorana modes localized at the edges of the system with quasi-energies of $0$ and $\\pi/T$.", "problem": "Consider the one-dimensional spinless p-wave superconducting Kitaev chain under a time-periodic drive. The Brillouin zone momentum-space Bogoliubov–de Gennes (BdG) Hamiltonian is defined as a $2 \\times 2$ matrix on the Nambu spinor basis $\\Psi_k = (c_k, c_{-k}^\\dagger)^\\top$,\n$$\nH_k(t) = h_z(k,t)\\,\\tau_z + h_y(k,t)\\,\\tau_y,\n$$\nwith $h_z(k,t) = -\\mu(t) - 2 t \\cos k$ and $h_y(k,t) = 2 \\Delta(t) \\sin k$, where $t$ is the real hopping amplitude, $\\mu(t)$ is the time-dependent chemical potential, $\\Delta(t)$ is the time-dependent p-wave pairing amplitude, and $\\tau_{x,y,z}$ are Pauli matrices in Nambu space. Assume a two-step piecewise constant drive over a single period $T = T_1 + T_2$ with\n$$\nH_k(t) = \n\\begin{cases}\nH_k^{(1)} \\equiv h_z^{(1)}(k)\\,\\tau_z + h_y^{(1)}(k)\\,\\tau_y, & 0 \\le t < T_1, \\\\\nH_k^{(2)} \\equiv h_z^{(2)}(k)\\,\\tau_z + h_y^{(2)}(k)\\,\\tau_y, & T_1 \\le t < T,\n\\end{cases}\n$$\nwhere $h_z^{(j)}(k) = -\\mu_j - 2 t \\cos k$ and $h_y^{(j)}(k) = 2 \\Delta_j \\sin k$ for steps $j=1,2$. The Floquet operator in momentum space over one period is\n$$\nU_k(T) = \\mathcal{T}\\exp\\left(-i\\int_0^T H_k(t)\\,dt\\right) = e^{-i H_k^{(2)} T_2}\\, e^{-i H_k^{(1)} T_1}.\n$$\nYour task is to write a complete program that, for each specified test case:\n1) Computes the momentum-space Floquet operator $U_k(T)$ on a uniform grid of $k \\in [-\\pi,\\pi)$ using the identity for exponentiating a traceless $2 \\times 2$ Hermitian matrix $H = \\mathbf{d}\\cdot\\boldsymbol{\\tau}$,\n$$\ne^{-i H \\Delta t} = \\cos\\!\\left(\\Delta t\\, \\lVert \\mathbf{d}\\rVert\\right)\\,\\tau_0 - i\\, \\sin\\!\\left(\\Delta t\\, \\lVert \\mathbf{d}\\rVert\\right)\\, \\frac{\\mathbf{d}}{\\lVert \\mathbf{d}\\rVert}\\cdot\\boldsymbol{\\tau},\n$$\nwhere $\\tau_0$ is the identity matrix and $\\lVert \\mathbf{d}\\rVert = \\sqrt{h_y^2 + h_z^2}$.\n2) Constructs the real-space BdG Hamiltonian for a chain of $N$ sites with open boundary conditions,\n$$\nH^{\\mathrm{BdG}} = \\begin{pmatrix} A & B \\\\ B^\\dagger & -A^\\top \\end{pmatrix},\n$$\nwhere $A$ encodes the normal terms $A_{i,i} = -\\mu$, $A_{i,i+1} = A_{i+1,i} = -t$, and $B$ is the antisymmetric pairing block with $B_{i,i+1} = \\Delta$, $B_{i+1,i} = -\\Delta$, all other elements zero. Over one drive period, define the real-space Floquet operator\n$$\nU(T) = e^{-i H^{\\mathrm{BdG}}(\\mu_2,\\Delta_2) T_2}\\, e^{-i H^{\\mathrm{BdG}}(\\mu_1,\\Delta_1) T_1}.\n$$\n3) Diagonalizes $U(T)$ and identifies whether there exist edge-localized Floquet Majorana modes at quasienergies $0$ and $\\pi/T$ by checking for eigenphases $\\phi$ close to $0$ (within a specified tolerance, in radians) or close to $\\pi$ (within a specified tolerance, in radians), together with strong edge localization of the corresponding eigenvectors. For localization, use the site-resolved norm of the Nambu components and require that the fraction of weight within the first and last few sites exceeds a given threshold.\n\nUse dimensionless parameters and express all angles in radians. The numerical tolerances and thresholds must be internally documented and used consistently. Your program must aggregate the results for each test case as pairs of booleans $[\\text{has\\_zero}, \\text{has\\_pi}]$ indicating whether edge-localized Majorana modes are detected at quasienergy $0$ and at quasienergy $\\pi/T$, respectively.\n\nTest Suite:\nProvide the following test cases, each as a tuple $(t,\\mu_1,\\mu_2,\\Delta_1,\\Delta_2,T_1,T_2,N)$ with $N$ the number of lattice sites:\n- Case 1 (general topological regime): $(1.0,0.0,0.0,0.4,0.4,0.7,0.3,80)$.\n- Case 2 (trivial regime, large chemical potential): $(1.0,3.2,3.2,0.2,0.2,0.5,0.5,80)$.\n- Case 3 (drive between contrasting chemical potentials): $(1.0,-3.0,3.0,0.4,0.4,0.5,0.5,80)$.\n- Case 4 (boundary condition near gap closing at $k=0$): $(1.0,-2.0,-2.0,0.4,0.4,0.5,0.5,80)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-boolean list corresponding to a test case, for example, \"[[true,false],[false,true],[false,false],[true,true]]\". Note that booleans should be lowercase textual representations \"true\" or \"false\".", "solution": "The problem statement has been evaluated against the required criteria and is determined to be valid. It is scientifically grounded in the established principles of condensed matter physics, specifically the theory of topological phases in the Kitaev model and Floquet dynamics. The problem is well-posed, objective, and internally consistent. It provides all necessary information to proceed with a numerical solution, delegating the choice of specific numerical tolerances to the solver, which is a standard and acceptable practice in computational physics problems.\n\nThe task requires identifying Floquet Majorana modes by analyzing a finite chain with open boundary conditions (OBC), as detailed in tasks 2 and 3 of the problem description. While the momentum-space formulation (task 1) is useful for analyzing the bulk system's topological invariants, detecting the edge-localized modes requires a real-space calculation. The provided code therefore focuses on implementing the real-space method: constructing the BdG Hamiltonian for a finite chain, computing the corresponding real-space Floquet operator, and analyzing its eigensystem for the signatures of Majorana modes.\n\nThe computational methodology proceeds as follows:\n\n1.  **Construct Real-Space Hamiltonians**: For each of the two steps in the driving protocol, indexed by $j \\in \\{1, 2\\}$, the $2N \\times 2N$ Bogoliubov-de Gennes (BdG) Hamiltonian $H^{\\mathrm{BdG}}_j$ for a chain of $N$ sites with open boundary conditions is constructed. This Hamiltonian acts on the Nambu spinor basis $(c_1, \\dots, c_N, c_1^\\dagger, \\dots, c_N^\\dagger)^\\top$. It is a block matrix of the form:\n    $$\n    H^{\\mathrm{BdG}}_j = \\begin{pmatrix} A_j & B_j \\\\ B_j^\\dagger & -A_j^\\top \\end{pmatrix}\n    $$\n    where the $N \\times N$ blocks $A_j$ and $B_j$ are defined by the parameters $(t, \\mu_j, \\Delta_j)$. Specifically, $A_j$ is a real, symmetric tridiagonal matrix representing the on-site potential and nearest-neighbor hopping: $(A_j)_{i,i} = -\\mu_j$ and $(A_j)_{i,i+1} = (A_j)_{i+1,i} = -t$. The matrix $B_j$ is a real, antisymmetric matrix describing the p-wave pairing: $(B_j)_{i,i+1} = \\Delta_j$ and $(B_j)_{i+1,i} = -\\Delta_j$. Since $A_j$ is symmetric ($A_j^\\top = A_j$) and $B_j$ is real and antisymmetric ($B_j^\\dagger = B_j^* = B_j^\\top = -B_j$), the Hamiltonian simplifies to $H^{\\mathrm{BdG}}_j = \\begin{pmatrix} A_j & B_j \\\\ -B_j & -A_j \\end{pmatrix}$.\n\n2.  **Compute Floquet Operator**: The time-evolution operator over one full period $T = T_1 + T_2$ is the Floquet operator $U(T)$. For the specified piecewise-constant drive, it is the product of the time-evolution operators for each step:\n    $$\n    U(T) = U_2 U_1 = e^{-i H^{\\mathrm{BdG}}_2 T_2} e^{-i H^{\\mathrm{BdG}}_1 T_1}\n    $$\n    The matrix exponentials are computed using standard, numerically stable algorithms.\n\n3.  **Eigensystem Analysis**: The Floquet operator $U(T)$ is a unitary matrix. It is diagonalized to find its eigenvalues $\\lambda_n$ and corresponding eigenvectors $|\\psi_n\\rangle$. The eigenvalues are complex numbers on the unit circle, $\\lambda_n = e^{-i\\phi_n}$, where $\\phi_n$ are the eigenphases, which are related to the quasienergies $\\varepsilon_n$ by $\\phi_n = \\varepsilon_n T$.\n\n4.  **Identify Majorana Modes**: The identification of Majorana modes is a two-step process for each eigenpair $(\\phi_n, |\\psi_n\\rangle)$:\n    a.  **Phase Criterion**: A search is conducted for eigenphases that are numerically close to the hallmark values of $0$ and $\\pi$. We check if $|\\phi_n|$ is close to $0$ or if $|\\phi_n|$ is close to $\\pi$. A small numerical tolerance, $\\delta_\\phi = 10^{-5}$ radians, is used for this comparison.\n    b.  **Localization Criterion**: For each eigenvector $|\\psi_n\\rangle$ that satisfies the phase criterion, its spatial localization is quantified. The eigenvector is a $2N$-component Nambu spinor. The probability density at site $i$ is $p_i = |u_i|^2 + |v_i|^2$, where $u_i$ and $v_i$ are the particle and hole components of the eigenvector at site $i$. A state is considered strongly edge-localized if a significant fraction of its total probability density resides on the physical ends of the chain. We will require that the combined probability on the first $10$ and last $10$ sites of the $N=80$ site chain exceeds a threshold of $0.8$.\n\n    A Floquet Majorana mode (either zero or $\\pi$) is confirmed to exist if and only if at least one eigenstate satisfies both the phase and the localization criteria for the respective phase value. This procedure is repeated for each test case provided.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm, eig\n\n# This program solves for the presence of Floquet Majorana modes in a driven Kitaev chain.\n\n# Define numerical hyperparameters for mode identification.\n# These values are chosen to be reasonably strict to distinguish true, localized topological\n# modes from delocalized bulk states.\n\n# Tolerance for an eigenphase to be considered 0 or pi.\nPHASE_TOLERANCE = 1e-5\n\n# Number of sites at each end of the chain to check for localization. For N=80,\n# this corresponds to the outermost 12.5% on each side.\nNUM_EDGE_SITES = 10\n\n# Minimum fraction of the total probability density that must be in the\n# defined edge sites for a state to be considered \"edge-localized\".\nLOCALIZATION_THRESHOLD = 0.8\n\n\ndef build_h_bdg(N, t_hop, mu, delta):\n    \"\"\"\n    Constructs the 2N x 2N real-space Bogoliubov-de Gennes Hamiltonian\n    for the Kitaev chain with open boundary conditions.\n\n    Args:\n        N (int): Number of sites in the chain.\n        t_hop (float): Hopping amplitude.\n        mu (float): Chemical potential.\n        delta (float): p-wave pairing amplitude.\n\n    Returns:\n        numpy.ndarray: The 2N x 2N BdG Hamiltonian matrix.\n    \"\"\"\n    # Block A: hopping and on-site potential\n    A_diag = -mu * np.ones(N)\n    A_offdiag = -t_hop * np.ones(N - 1)\n    A = np.diag(A_diag) + np.diag(A_offdiag, k=1) + np.diag(A_offdiag, k=-1)\n\n    # Block B: p-wave pairing\n    B_offdiag = delta * np.ones(N - 1)\n    B = np.diag(B_offdiag, k=1) - np.diag(B_offdiag, k=-1)\n\n    # Assemble the full 2N x 2N BdG Hamiltonian\n    H_BdG = np.zeros((2 * N, 2 * N), dtype=np.complex128)\n    H_BdG[:N, :N] = A\n    H_BdG[:N, N:] = B\n    # B^dagger = B.T = -B since B is real and antisymmetric\n    H_BdG[N:, :N] = -B\n    # -A^T = -A since A is real and symmetric\n    H_BdG[N:, N:] = -A\n\n    return H_BdG\n\n\ndef check_majorana_modes(U, N):\n    \"\"\"\n    Diagonalizes the Floquet operator U and checks for the presence of\n    edge-localized 0- and pi-modes.\n\n    Args:\n        U (numpy.ndarray): The 2N x 2N Floquet operator.\n        N (int): Number of sites in the chain.\n\n    Returns:\n        tuple[bool, bool]: A pair of booleans (has_zero_mode, has_pi_mode).\n    \"\"\"\n    has_zero_mode = False\n    has_pi_mode = False\n\n    # Diagonalize the Floquet operator to get eigenphases and eigenvectors\n    eigvals, eigvecs = eig(U)\n    phases = np.angle(eigvals)\n\n    for i in range(2 * N):\n        phase = phases[i]\n        vec = eigvecs[:, i]\n\n        # Check if the eigenphase is close to 0 or pi\n        is_zero_candidate = abs(phase) < PHASE_TOLERANCE\n        is_pi_candidate = abs(abs(phase) - np.pi) < PHASE_TOLERANCE\n\n        if is_zero_candidate or is_pi_candidate:\n            # If it is a candidate, check for spatial localization.\n            # The eigenvector has N particle components followed by N hole components.\n            u_part = vec[:N]\n            v_part = vec[N:]\n            \n            # site_probs[i] = |u_i|^2 + |v_i|^2\n            site_probs = np.abs(u_part)**2 + np.abs(v_part)**2\n\n            # Check that the eigenvector is properly normalized (should be handled by eig)\n            # assert np.isclose(np.sum(site_probs), 1.0)\n            \n            # Calculate the total probability weight at the edges of the chain\n            edge_weight = np.sum(site_probs[:NUM_EDGE_SITES]) + \\\n                          np.sum(site_probs[N - NUM_EDGE_SITES:])\n\n            if edge_weight > LOCALIZATION_THRESHOLD:\n                if is_zero_candidate:\n                    has_zero_mode = True\n                if is_pi_candidate:\n                    has_pi_mode = True\n\n    return has_zero_mode, has_pi_mode\n\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all specified test cases.\n    \"\"\"\n    # Test cases: (t, mu1, mu2, delta1, delta2, T1, T2, N)\n    test_cases = [\n        (1.0, 0.0, 0.0, 0.4, 0.4, 0.7, 0.3, 80),\n        (1.0, 3.2, 3.2, 0.2, 0.2, 0.5, 0.5, 80),\n        (1.0, -3.0, 3.0, 0.4, 0.4, 0.5, 0.5, 80),\n        (1.0, -2.0, -2.0, 0.4, 0.4, 0.5, 0.5, 80),\n    ]\n\n    results = []\n    for case in test_cases:\n        t_hop, mu1, mu2, delta1, delta2, T1, T2, N = case\n\n        # Build the BdG Hamiltonians for each step of the drive\n        H1 = build_h_bdg(N, t_hop, mu1, delta1)\n        H2 = build_h_bdg(N, t_hop, mu2, delta2)\n\n        # Compute the time evolution operators for each step\n        U1 = expm(-1j * H1 * T1)\n        U2 = expm(-1j * H2 * T2)\n\n        # The full Floquet operator for one period\n        U_total = U2 @ U1\n\n        # Check for Majorana modes\n        has_zero, has_pi = check_majorana_modes(U_total, N)\n        results.append(f\"[{str(has_zero).lower()},{str(has_pi).lower()}]\")\n        \n    # Print the final result in the specified format\n    print(f\"[{','.join(results)}]\")\n\n\nsolve()\n```", "id": "2990386"}]}