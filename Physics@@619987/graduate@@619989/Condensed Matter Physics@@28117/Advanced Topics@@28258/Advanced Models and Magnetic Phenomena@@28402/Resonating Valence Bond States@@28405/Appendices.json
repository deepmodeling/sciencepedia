{"hands_on_practices": [{"introduction": "To build a concrete understanding of the Resonating Valence Bond (RVB) concept, we begin with the smallest system that exhibits non-trivial resonance: four spins on a square plaquette. The RVB state is a quantum superposition of different ways to pair these spins into singlets. This practice requires a first-principles calculation of the nearest-neighbor spin correlation, $\\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle$, forcing a direct confrontation with the consequences of this superposition. By computing the overlap between different valence-bond coverings and evaluating the cross-terms in the expectation value, you will see precisely how quantum interference between bonding patterns gives rise to the state's energetic and magnetic properties [@problem_id:3013864].", "problem": "Consider a system of $4$ spin-$\\tfrac{1}{2}$ degrees of freedom on the vertices of a square, labeled in cyclic order by sites $1,2,3,4$. Assume a bipartite decomposition with sublattices $A=\\{1,3\\}$ and $B=\\{2,4\\}$. Let the two nearest-neighbor valence-bond coverings be\n- the horizontal covering $\\lvert h\\rangle=\\lvert s_{12}\\rangle\\otimes\\lvert s_{34}\\rangle$,\n- the vertical covering $\\lvert v\\rangle=\\lvert s_{23}\\rangle\\otimes\\lvert s_{41}\\rangle$,\nwhere the spin singlet on sites $i,j$ is $\\lvert s_{ij}\\rangle=\\left(\\lvert\\uparrow_i\\downarrow_j\\rangle-\\lvert\\downarrow_i\\uparrow_j\\rangle\\right)/\\sqrt{2}$.\n\nDefine the equal-amplitude resonating valence bond (RVB) state\n$$\n\\lvert \\psi\\rangle=\\mathcal{N}\\left(\\lvert h\\rangle+\\lvert v\\rangle\\right),\n$$\nwith normalization factor $\\mathcal{N}$ chosen such that $\\langle\\psi\\vert\\psi\\rangle=1$. Work exclusively from the defining properties of spin-$\\tfrac{1}{2}$ operators, singlet states, and basic tensor-product structure; do not assume any specialized overlap formulas a priori.\n\nStarting from first principles, compute the exact expectation value of the local Heisenberg correlator $\\,\\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle\\,$, where $\\mathbf{S}_i=\\left(S_i^x,S_i^y,S_i^z\\right)$ are spin-$\\tfrac{1}{2}$ operators at site $i$. In your derivation, explicitly identify the separate contributions from the single-covering terms and from the cross terms that arise from the RVB superposition, and explain how the latter are tied to the reconfiguration of valence bonds around the elementary loop of length $4$.\n\nProvide your final result as a single exact number. No rounding is required, and no physical units are associated with the answer.", "solution": "This problem requires the calculation of a spin-spin correlation function for a resonating valence bond (RVB) state on a $4$-site square lattice. The calculation must be performed from first principles.\n\nThe system consists of four spin-$\\frac{1}{2}$ particles at sites labeled $1, 2, 3, 4$ in cyclic order.\nThe two nearest-neighbor valence-bond (VB) coverings are given by:\nThe horizontal covering:\n$$ \\lvert h\\rangle = \\lvert s_{12}\\rangle \\otimes \\lvert s_{34}\\rangle $$\nThe vertical covering:\n$$ \\lvert v\\rangle = \\lvert s_{23}\\rangle \\otimes \\lvert s_{41}\\rangle $$\nwhere the spin singlet state for sites $i$ and $j$ is defined as:\n$$ \\lvert s_{ij}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\lvert\\uparrow_i\\downarrow_j\\rangle - \\lvert\\downarrow_i\\uparrow_j\\rangle \\right) $$\nThe equal-amplitude RVB state is a normalized superposition of these two coverings:\n$$ \\lvert \\psi\\rangle = \\mathcal{N}\\left(\\lvert h\\rangle+\\lvert v\\rangle\\right) $$\nThe normalization condition is $\\langle\\psi\\vert\\psi\\rangle = 1$.\n\nFirst, we determine the normalization constant $\\mathcal{N}$. The normalization condition expands to:\n$$ \\langle\\psi\\vert\\psi\\rangle = |\\mathcal{N}|^2 \\left( \\langle h\\vert h\\rangle + \\langle v\\vert v\\rangle + \\langle h\\vert v\\rangle + \\langle v\\vert h\\rangle \\right) = 1 $$\nBy definition, the VB coverings are normalized, so $\\langle h\\vert h\\rangle = 1$ and $\\langle v\\vert v\\rangle = 1$. We must compute the overlap integral $\\langle h\\vert v\\rangle$. To do this, we expand both states in the computational basis, denoted $|\\sigma_1\\sigma_2\\sigma_3\\sigma_4\\rangle$.\n\nThe horizontal state is:\n$$ \\lvert h\\rangle = \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_1\\downarrow_2\\rangle - \\lvert\\downarrow_1\\uparrow_2\\rangle\\right) \\otimes \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_3\\downarrow_4\\rangle - \\lvert\\downarrow_3\\uparrow_4\\rangle\\right) $$\n$$ \\lvert h\\rangle = \\frac{1}{2} \\left( \\lvert\\uparrow\\downarrow\\uparrow\\downarrow\\rangle - \\lvert\\uparrow\\downarrow\\downarrow\\uparrow\\rangle - \\lvert\\downarrow\\uparrow\\uparrow\\downarrow\\rangle + \\lvert\\downarrow\\uparrow\\downarrow\\uparrow\\rangle \\right) $$\nThe vertical state is:\n$$ \\lvert v\\rangle = \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_2\\downarrow_3\\rangle - \\lvert\\downarrow_2\\uparrow_3\\rangle\\right) \\otimes \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_4\\downarrow_1\\rangle - \\lvert\\downarrow_4\\uparrow_1\\rangle\\right) $$\n$$ \\lvert v\\rangle = \\frac{1}{2} \\left( \\lvert\\downarrow_1\\uparrow_2\\downarrow_3\\uparrow_4\\rangle - \\lvert\\uparrow_1\\uparrow_2\\downarrow_3\\downarrow_4\\rangle - \\lvert\\downarrow_1\\downarrow_2\\uparrow_3\\uparrow_4\\rangle + \\lvert\\uparrow_1\\downarrow_2\\uparrow_3\\downarrow_4\\rangle \\right) $$\nNow, we compute the inner product $\\langle h\\vert v\\rangle$. Due to the orthogonality of the basis states, only terms with identical spin configurations survive:\n$$ \\langle h\\vert v\\rangle = \\frac{1}{4} \\left( \\langle\\uparrow\\downarrow\\uparrow\\downarrow\\vert\\uparrow\\downarrow\\uparrow\\downarrow\\rangle + \\langle\\downarrow\\uparrow\\downarrow\\uparrow\\vert\\downarrow\\uparrow\\downarrow\\uparrow\\rangle \\right) = \\frac{1}{4} (1+1) = \\frac{1}{2} $$\nThe overlap is real, so $\\langle v\\vert h\\rangle = \\langle h\\vert v\\rangle^* = \\frac{1}{2}$.\nSubstituting into the normalization condition:\n$$ |\\mathcal{N}|^2 \\left( 1 + 1 + \\frac{1}{2} + \\frac{1}{2} \\right) = |\\mathcal{N}|^2 (3) = 1 $$\nChoosing $\\mathcal{N}$ to be real and positive, we find $\\mathcal{N} = \\frac{1}{\\sqrt{3}}$.\n\nNext, we compute the expectation value $\\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle$.\n$$ \\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle = \\mathcal{N}^2 \\langle h+v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h+v\\rangle $$\n$$ = \\frac{1}{3} \\left( \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle + \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle + \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle + \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle \\right) $$\nSince $\\mathbf{S}_1\\cdot \\mathbf{S}_2$ is a Hermitian operator, the last two terms are complex conjugates. The states are real, so the matrix elements are real, and $\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle$.\n$$ \\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle = \\frac{1}{3} \\left( \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle + \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle + 2\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle \\right) $$\nWe evaluate each term separately.\n\n1.  Single-covering term for $\\lvert h\\rangle$: $\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle$\nThe operator $\\mathbf{S}_1\\cdot \\mathbf{S}_2$ acts only on the Hilbert space of sites $1$ and $2$.\nThe total spin of a pair is $\\mathbf{S}_{ij} = \\mathbf{S}_i+\\mathbf{S}_j$, so $\\mathbf{S}_{ij}^2 = \\mathbf{S}_i^2+\\mathbf{S}_j^2+2\\mathbf{S}_i\\cdot\\mathbf{S}_j$. This gives $\\mathbf{S}_i\\cdot \\mathbf{S}_j = \\frac{1}{2}(\\mathbf{S}_{ij}^2 - \\mathbf{S}_i^2 - \\mathbf{S}_j^2)$.\nFor a spin-$\\frac{1}{2}$ particle, $\\mathbf{S}_i^2$ has the eigenvalue $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$ (in units of $\\hbar^2=1$).\nThe state $\\lvert s_{12}\\rangle$ is a singlet with total spin $S_{12}=0$, so $\\mathbf{S}_{12}^2$ has eigenvalue $0$.\nThus, $\\mathbf{S}_1\\cdot \\mathbf{S}_2$ acting on $\\lvert s_{12}\\rangle$ yields the eigenvalue $\\frac{1}{2}(0 - \\frac{3}{4} - \\frac{3}{4}) = -\\frac{3}{4}$.\n$$ \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle = \\langle s_{12}s_{34}\\vert (\\mathbf{S}_1\\cdot \\mathbf{S}_2 \\otimes I_{34})\\vert s_{12}s_{34}\\rangle = \\langle s_{12}\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert s_{12}\\rangle \\langle s_{34}\\vert s_{34}\\rangle = -\\frac{3}{4} \\times 1 = -\\frac{3}{4} $$\n\n2.  Single-covering term for $\\lvert v\\rangle$: $\\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle$\nIn the state $\\lvert v\\rangle = \\lvert s_{23}\\rangle\\otimes\\lvert s_{41}\\rangle$, sites $1$ and $2$ are not in the same singlet pair. We must evaluate this directly. The operator is $\\mathbf{S}_1\\cdot \\mathbf{S}_2=S_1^zS_2^z + \\frac{1}{2}(S_1^+S_2^- + S_1^-S_2^+)$.\nThe state is $\\lvert v\\rangle = \\frac{1}{2} \\left( \\lvert\\downarrow\\uparrow\\downarrow\\uparrow\\rangle - \\lvert\\uparrow\\uparrow\\downarrow\\downarrow\\rangle - \\lvert\\downarrow\\downarrow\\uparrow\\uparrow\\rangle + \\lvert\\uparrow\\downarrow\\uparrow\\downarrow\\rangle \\right)$.\nThe state $|v\\rangle$ has total spin $S_{tot}^z=0$ and is invariant under global spin flip, ensuring spin-rotation invariance. Thus, $\\langle \\mathbf{S}_1\\cdot \\mathbf{S}_2\\rangle = 3\\langle S_1^zS_2^z\\rangle$.\nLet's calculate $\\langle v\\vert S_1^zS_2^z\\vert v\\rangle$. The operator $S_1^zS_2^z$ is diagonal in the computational basis.\n$$ \\langle v\\vert S_1^zS_2^z\\vert v\\rangle = \\frac{1}{4} \\left[ (1)^2(-\\frac{1}{4}) + (-1)^2(\\frac{1}{4}) + (-1)^2(\\frac{1}{4}) + (1)^2(-\\frac{1}{4}) \\right] = \\frac{1}{4}\\left(-\\frac{1}{4}+\\frac{1}{4}+\\frac{1}{4}-\\frac{1}{4}\\right)=0 $$\nSince the $z$-component correlation is zero, the total correlation is zero:\n$$ \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = 0 $$\n\n3.  Cross term: $2\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle$\nThis term represents the quantum interference between the two coverings.\nWe can act with the operator on $\\lvert h\\rangle$:\n$$ \\mathbf{S}_1\\cdot \\mathbf{S}_2 \\lvert h\\rangle = \\mathbf{S}_1\\cdot \\mathbf{S}_2 \\lvert s_{12}s_{34}\\rangle = (-\\frac{3}{4}) \\lvert s_{12}s_{34}\\rangle = -\\frac{3}{4} \\lvert h\\rangle $$\nSo the matrix element becomes:\n$$ \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = \\langle h \\vert -\\frac{3}{4} \\vert v \\rangle = -\\frac{3}{4} \\langle h\\vert v\\rangle $$\nUsing our previously calculated overlap $\\langle h\\vert v\\rangle = \\frac{1}{2}$:\n$$ \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = -\\frac{3}{4} \\times \\frac{1}{2} = -\\frac{3}{8} $$\nThis term is real, so $2\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = 2 \\times (-\\frac{3}{8}) = -\\frac{3}{4}$.\n\nThis cross-term contribution is fundamentally tied to the ability of the valence bonds to reconfigure. The term's existence depends on the non-zero overlap $\\langle h\\vert v\\rangle$, which quantifies the projection of one bond configuration onto another. The loop structure of the combined graphs of $\\lvert h\\rangle$ and $\\lvert v\\rangle$ governs this overlap. The operator $\\mathbf{S}_1 \\cdot \\mathbf{S}_2$ probes the correlation between sites $1$ and $2$. The cross term measures the amplitude for the system to transition between the vertical and horizontal coverings under this probing interaction. Since $\\lvert h\\rangle$ is an eigenstate of the operator, this transition amplitude is directly proportional to the structural overlap $\\langle h \\vert v \\rangle$.\n\nFinally, we assemble the total expectation value:\n$$ \\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle = \\frac{1}{3} \\left( \\left(-\\frac{3}{4}\\right) + (0) + \\left(-\\frac{3}{4}\\right) \\right) $$\n$$ = \\frac{1}{3} \\left( -\\frac{6}{4} \\right) = \\frac{1}{3} \\left( -\\frac{3}{2} \\right) = -\\frac{1}{2} $$\nThe contributions are:\n-   From $\\lvert h\\rangle$ covering (diagonal): weighted contribution is $\\frac{1}{3} \\times (-\\frac{3}{4}) = -\\frac{1}{4}$.\n-   From $\\lvert v\\rangle$ covering (diagonal): weighted contribution is $\\frac{1}{3} \\times (0) = 0$.\n-   From interference (cross term): weighted contribution is $\\frac{1}{3} \\times (-\\frac{3}{4}) = -\\frac{1}{4}$.\nThe sum is $-\\frac{1}{4} + 0 - \\frac{1}{4} = -\\frac{1}{2}$.", "answer": "$$ \\boxed{-\\frac{1}{2}} $$", "id": "3013864"}, {"introduction": "While the explicit superposition of valence-bond coverings is intuitive, it becomes unwieldy for larger systems. A more powerful and scalable framework represents the RVB state as a Gutzwiller-projected Bardeen-Cooper-Schrieffer (BCS) wavefunction. This exercise introduces this essential technique by applying it to the same four-site system from our first practice. You will construct the RVB state by starting with a \"sea\" of paired fermions and then projecting out states with unphysical double-occupancy, which is the essence of the Gutzwiller projection. This problem not only reinforces our previous result for the spin correlation but also provides hands-on experience with the fermionic representation and the mathematical tools, like the Pfaffian, that are crucial for modern computational studies of RVB physics [@problem_id:3013855].", "problem": "Consider a spin-$\\tfrac{1}{2}$ fermionic system on a periodic ring of $4$ sites labeled $1,2,3,4$, with the bipartition $A=\\{1,3\\}$ and $B=\\{2,4\\}$. Define a real-space spin-singlet Bardeen–Cooper–Schrieffer (BCS) pairing function $f_{ij}$ that is nonzero only on nearest-neighbor bonds connecting the two sublattices, with $f_{12}=f_{23}=f_{34}=f_{41}=\\Delta$ and $f_{ji}=-f_{ij}$ for all $i,j$, and $f_{ij}=0$ otherwise, where $\\Delta>0$ is real. The projected BCS resonating valence bond (RVB) state at half filling is\n$$\n|\\Psi_{\\mathrm{RVB}}\\rangle=\\mathcal{P}_{G}\\left[\\sum_{i<j}f_{ij}\\left(c_{i\\uparrow}^{\\dagger}c_{j\\downarrow}^{\\dagger}-c_{i\\downarrow}^{\\dagger}c_{j\\uparrow}^{\\dagger}\\right)\\right]^{2}|0\\rangle,\n$$\nwhere $\\mathcal{P}_{G}$ is the Gutzwiller projector onto the subspace with exactly one electron per site.\n\nUsing the Pfaffian or determinant formalism for projected BCS states and starting only from fundamental operator identities and definitions in second quantization, do the following:\n\n1. Compute the unnormalized norm squared $\\langle\\Psi_{\\mathrm{RVB}}|\\Psi_{\\mathrm{RVB}}\\rangle$ as an explicit function of $\\Delta$.\n\n2. Compute the nearest-neighbor spin–spin correlator $\\langle \\mathbf{S}_{1}\\cdot \\mathbf{S}_{2}\\rangle$ in the normalized RVB state, where $\\mathbf{S}_{i}$ is the spin operator on site $i$ and $\\mathbf{S}_{i}\\cdot \\mathbf{S}_{j}=S_{i}^{x}S_{j}^{x}+S_{i}^{y}S_{j}^{y}+S_{i}^{z}S_{j}^{z}$.\n\n3. Based on the Pfaffian/determinant structure and the bipartite nature of the pairing, explain the conditions under which the sign problem is absent in Monte Carlo sampling of $|\\Psi_{\\mathrm{RVB}}|^{2}$ on general bipartite lattices with real $f_{ij}$.\n\nProvide your final answer as the exact value of the correlator $\\langle \\mathbf{S}_{1}\\cdot \\mathbf{S}_{2}\\rangle$ in the normalized RVB state (no units, no rounding).", "solution": "This problem requires solving for properties of a resonating valence bond (RVB) state defined via a Gutzwiller-projected BCS wavefunction on a 4-site ring.\n\n### Part 1: Calculation of the Norm\n\nLet's define the singlet pair creation operator as $b_{ij}^{\\dagger} = c_{i\\uparrow}^{\\dagger}c_{j\\downarrow}^{\\dagger}-c_{i\\downarrow}^{\\dagger}c_{j\\uparrow}^{\\dagger}$. The unnormalized RVB state is:\n$$|\\Psi_{\\mathrm{RVB}}\\rangle = \\mathcal{P}_{G} \\left(\\sum_{i<j} f_{ij} b_{ij}^{\\dagger}\\right)^2 |0\\rangle$$\nThe Gutzwiller projection $\\mathcal{P}_{G}$ ensures one electron per site, so any term $b_{ij}^{\\dagger}b_{kl}^{\\dagger}|0\\rangle$ survives only if the sites $\\{i,j,k,l\\}$ are all distinct. For our $N=4$ system, this means we sum over partitions of the four sites into two pairs.\n$$|\\Psi_{\\mathrm{RVB}}\\rangle = \\mathcal{P}_{G} \\left( f_{12}f_{34} b_{12}^\\dagger b_{34}^\\dagger + f_{13}f_{24} b_{13}^\\dagger b_{24}^\\dagger + f_{14}f_{23} b_{14}^\\dagger b_{23}^\\dagger \\right) |0\\rangle$$\nUsing the given values $f_{12}=f_{23}=f_{34}=f_{41}=\\Delta$, $f_{ji}=-f_{ij}$, and $f_{ij}=0$ for non-nearest neighbors:\n$f_{12}f_{34} = \\Delta \\cdot \\Delta = \\Delta^2$.\n$f_{13}f_{24} = 0 \\cdot 0 = 0$.\n$f_{14}f_{23} = (-f_{41})f_{23} = (-\\Delta) \\cdot \\Delta = -\\Delta^2$.\n\nThe state becomes:\n$$|\\Psi_{\\mathrm{RVB}}\\rangle = \\Delta^2 \\left( b_{12}^\\dagger b_{34}^\\dagger - b_{14}^\\dagger b_{23}^\\dagger \\right) |0\\rangle$$\nLet $|\\psi_1\\rangle = b_{12}^\\dagger b_{34}^\\dagger |0\\rangle$ and $|\\psi_2\\rangle = b_{14}^\\dagger b_{23}^\\dagger |0\\rangle$. These are products of unnormalized singlet states.\nThe norm squared is $\\langle\\Psi_{\\mathrm{RVB}}|\\Psi_{\\mathrm{RVB}}\\rangle = \\Delta^4 \\langle \\psi_1 - \\psi_2 | \\psi_1 - \\psi_2 \\rangle = \\Delta^4 (\\langle\\psi_1|\\psi_1\\rangle + \\langle\\psi_2|\\psi_2\\rangle - 2 \\text{Re}\\langle\\psi_1|\\psi_2\\rangle)$.\nThe norm of a single unnormalized singlet pair is $\\langle b_{ij}^\\dagger | b_{ij}^\\dagger \\rangle = \\langle 0 | b_{ij}b_{ij}^\\dagger | 0 \\rangle = 2$.\nThus, $\\langle\\psi_1|\\psi_1\\rangle = \\langle b_{12}^\\dagger b_{34}^\\dagger | b_{12}^\\dagger b_{34}^\\dagger \\rangle = 4$. Similarly, $\\langle\\psi_2|\\psi_2\\rangle = 4$.\nThe overlap term is $\\langle\\psi_1|\\psi_2\\rangle = \\langle 0 | b_{34}b_{12} b_{14}^\\dagger b_{23}^\\dagger |0\\rangle$. This corresponds to the overlap of two different dimer coverings of the 4-site ring. The result is $\\langle\\psi_1|\\psi_2\\rangle = -2$.\nSo, $\\langle \\psi_1 - \\psi_2 | \\psi_1 - \\psi_2 \\rangle = 4 + 4 - 2(-2) = 12$.\nThe unnormalized norm squared is $\\langle\\Psi_{\\mathrm{RVB}}|\\Psi_{\\mathrm{RVB}}\\rangle = 12\\Delta^4$.\n\n### Part 2: Spin-Spin Correlator\n\nThe normalized state is $|\\tilde{\\Psi}\\rangle = \\frac{1}{\\sqrt{12}\\Delta^2}|\\Psi_{\\mathrm{RVB}}\\rangle = \\frac{1}{\\sqrt{12}}(|\\psi_1\\rangle - |\\psi_2\\rangle)$. We compute $\\langle \\mathbf{S}_1 \\cdot \\mathbf{S}_2 \\rangle$:\n$$ \\langle \\mathbf{S}_1 \\cdot \\mathbf{S}_2 \\rangle = \\frac{1}{12} \\left( \\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_1\\rangle + \\langle\\psi_2|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle - 2\\text{Re}\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle \\right) $$\n1.  **Term 1**: $\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_1\\rangle = \\langle b_{12}^\\dagger b_{34}^\\dagger | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | b_{12}^\\dagger b_{34}^\\dagger \\rangle$. Since sites 1 and 2 form a singlet, the operator $\\mathbf{S}_1 \\cdot \\mathbf{S}_2$ has an eigenvalue of $-3/4$ on that pair. The total term becomes $(-\\frac{3}{4}) \\langle b_{12}^\\dagger | b_{12}^\\dagger \\rangle \\langle b_{34}^\\dagger | b_{34}^\\dagger \\rangle = (-\\frac{3}{4}) \\cdot 2 \\cdot 2 = -3$.\n2.  **Term 2**: $\\langle\\psi_2|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle = \\langle b_{14}^\\dagger b_{23}^\\dagger | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | b_{14}^\\dagger b_{23}^\\dagger \\rangle$. In state $|\\psi_2\\rangle$, spins on sites $1$ and $2$ are in different singlet pairs and are thus uncorrelated. By spin-rotation symmetry, the expectation value is zero.\n3.  **Cross Term**: For $\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle$, we use the fact that $\\mathbf{S}_1 \\cdot \\mathbf{S}_2 |\\psi_1\\rangle = (-3/4)|\\psi_1\\rangle$. The matrix element becomes $(-3/4)\\langle\\psi_1|\\psi_2\\rangle = (-3/4)(-2) = 3/2$.\n\nPutting it all together:\n$$ \\langle \\mathbf{S}_1 \\cdot \\mathbf{S}_2 \\rangle = \\frac{1}{12} \\left[ -3 + 0 - 2\\left(\\frac{3}{2}\\right) \\right] = \\frac{1}{12}(-3 - 3) = \\frac{-6}{12} = -\\frac{1}{2} $$\nThe result is independent of $\\Delta$, as expected.\n\n### Part 3: Absence of the Sign Problem\n\nFor a spin system on a bipartite lattice, a wavefunction is considered \"sign-problem-free\" for certain quantum Monte Carlo methods if its amplitudes in the standard $S^z$ basis are all real and obey the Marshall-Peierls sign rule. This rule states that the sign of the amplitude for a configuration $C$, $\\Psi(C)$, is given by $(-1)^{N_\\downarrow^A(C)}$, where $N_\\downarrow^A(C)$ is the number of down spins on sublattice A. Such a sign structure can be \"gauged away\" by a local unitary transformation, rendering all amplitudes positive and allowing for importance sampling without oscillating signs.\n\nThe projected BCS state $|\\Psi_{\\mathrm{RVB}}\\rangle$ satisfies this condition if:\n1.  The lattice is bipartite.\n2.  The pairing function $f_{ij}$ is real.\n3.  Pairing occurs only between sites on different sublattices (i.e., $f_{ij}=0$ if sites $i$ and $j$ belong to the same sublattice).\n\nUnder these conditions, it can be proven that the resulting wavefunction has real amplitudes that obey the Marshall-Peierls sign rule. This makes the wavefunction an ideal trial state for projector QMC and allows for efficient VMC sampling of the probability distribution $|\\Psi(C)|^2$ without encountering a fundamental sign problem. The specific structure of the problem, a bipartite ring with real nearest-neighbor pairing, fulfills these conditions.", "answer": "$$\n\\boxed{-\\frac{1}{2}}\n$$", "id": "3013855"}, {"introduction": "The ultimate goal in studying quantum matter is to understand its behavior in the thermodynamic limit. This practice transitions from small, exactly tractable systems to the numerical investigation of an extended two-dimensional lattice, a crucial step towards modeling real materials. You will implement a mean-field treatment of a canonical quantum spin liquid, the $\\pi$-flux or Dirac spin liquid, using the slave-fermion representation. The central task involves numerically diagonalizing the mean-field Hamiltonian on finite lattices with various boundary conditions and calculating the variational energy. By performing a finite-size scaling analysis on these results, you will learn how to systematically extrapolate away finite-size effects to determine a fundamental property of the macroscopic state: its ground-state energy density [@problem_id:3013886].", "problem": "Consider the spin-$\\tfrac{1}{2}$ antiferromagnetic Heisenberg model on a two-dimensional square lattice with Hamiltonian $H = J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$, where $J > 0$ and $\\langle i j \\rangle$ denotes nearest-neighbor pairs. In the fermionic (slave-particle) representation, the spin operators are written as $\\mathbf{S}_i = \\tfrac{1}{2} f^\\dagger_{i\\alpha} \\boldsymbol{\\sigma}_{\\alpha\\beta} f_{i\\beta}$ subject to the single-occupancy constraint $\\sum_{\\alpha} f^\\dagger_{i\\alpha} f_{i\\alpha} = 1$, with $f_{i\\alpha}$ fermionic spinon operators and $\\boldsymbol{\\sigma}$ the Pauli matrices. A resonating valence bond (RVB) Dirac spin liquid (DSL) ansatz can be constructed at the mean-field level by a nearest-neighbor hopping Hamiltonian on the square lattice that realizes a $\\pi$-flux per plaquette:\n$$\nH_{\\text{MF}} = \\sum_{\\langle ij \\rangle,\\sigma} t_{ij} f^\\dagger_{i\\sigma} f_{j\\sigma} + \\text{h.c.},\n$$\nwith a gauge choice such that horizontal bonds have $t_{ij} = t$ and vertical bonds have $t_{ij} = t (-1)^{x_i}$, where $x_i$ is the $x$-coordinate of site $i$ and $t>0$ sets the mean-field energy scale. The $\\pi$-flux condition is enforced by this pattern, since the product of hoppings around any plaquette has a phase of $\\pi$. Boundary conditions along each spatial direction are either periodic or antiperiodic; antiperiodic boundary conditions are implemented by inserting a phase of $\\pi$ across the boundary in that direction.\n\nStarting from the Heisenberg Hamiltonian and the fermionic representation above, derive the mean-field variational energy per site $E/N$ in units of $J$ for the Dirac spin liquid ansatz in terms of the ground-state fermionic correlation functions on nearest-neighbor bonds. You must base your derivation on standard decoupling of the spin interaction into fermion bilinears, define the bond expectation value $\\chi_{ij} = \\sum_\\sigma \\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle$, and use the ground-state projector of $H_{\\text{MF}}$ at half-filling to evaluate $\\chi_{ij}$ on finite lattices with specified boundary conditions. Do not assume any shortcut formulas not derived from the stated fundamental starting point; your program must implement the derivation you provide.\n\nFinite-size effects in a Dirac spin liquid with linearly dispersing spinons lead to characteristic corrections to the energy density. Using systematic lattice sizes $L \\times L$ (with $L$ even to ensure half-filling per spin species) and boundary conditions, compute the finite-size energy per site $E(L)$, and extract the thermodynamic-limit energy $E_\\infty$ by fitting to a scaling form\n$$\nE(L) = E_\\infty + \\frac{c}{L^3},\n$$\nwhere $c$ is a non-universal constant depending on boundary conditions. All energies must be expressed in units of $J$ (i.e., $E/J$ and $E_\\infty/J$), as dimensionless floats.\n\nImplementation requirements:\n- Construct $H_{\\text{MF}}$ in real space for one spin species on an $L \\times L$ lattice with the $\\pi$-flux gauge choice $t_{x} = t$ on horizontal bonds and $t_{y}(x) = t (-1)^x$ on vertical bonds. Enforce periodic or antiperiodic boundary conditions along $x$ and $y$ by multiplying hopping terms that cross the boundary by $-1$ for antiperiodic conditions in that direction (and by $+1$ for periodic).\n- Diagonalize $H_{\\text{MF}}$, fill the lowest $N/2$ single-particle states for one spin species at half-filling, where $N = L^2$ is the number of lattice sites. Form the ground-state projector $P$ from occupied eigenvectors. The single-species correlation is $\\langle f^\\dagger_i f_j \\rangle = P_{j i}$, and the spin-summed bond expectation is $\\chi_{ij} = 2 P_{j i}$ due to spin degeneracy.\n- Compute the nearest-neighbor bonds $\\langle i j \\rangle$ by enumerating $(i, i+\\hat{x})$ and $(i, i+\\hat{y})$ for all sites $i$ with periodic wrap-around. Using your derived mean-field expression, evaluate the variational energy per site $E(L)/J$ on each finite lattice.\n- For each boundary condition set, fit $E(L)$ versus $L^{-3}$ to extract $E_\\infty$ as the intercept. Also compute a boolean indicating whether $E(L)$ is monotonic in $L$ for the given boundary condition set (use monotonic decrease with increasing $L$ for this check).\n\nTest suite:\n- Use $t=1$ and $J=1$.\n- Case 1: $L \\in \\{10, 14, 18\\}$ with boundary conditions $(x,y) = (\\text{periodic}, \\text{periodic})$.\n- Case 2: $L \\in \\{8, 12, 16\\}$ with boundary conditions $(x,y) = (\\text{antiperiodic}, \\text{periodic})$.\n- Case 3: $L \\in \\{8, 12, 16\\}$ with boundary conditions $(x,y) = (\\text{antiperiodic}, \\text{antiperiodic})$.\n- Case 4: $L \\in \\{6, 8, 10\\}$ with boundary conditions $(x,y) = (\\text{periodic}, \\text{antiperiodic})$.\n\nAnswer specification and output format:\n- For each case, your program must return two items: the fitted thermodynamic-limit energy per site $E_\\infty/J$ as a float, and the monotonicity boolean.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above: $[E_{\\infty,1}, \\text{monotonic}_1, E_{\\infty,2}, \\text{monotonic}_2, E_{\\infty,3}, \\text{monotonic}_3, E_{\\infty,4}, \\text{monotonic}_4]$.", "solution": "The task is to compute the mean-field variational energy per site, $E/N$, of the spin-$\\frac{1}{2}$ antiferromagnetic Heisenberg model for a Dirac spin liquid (DSL) ansatz. The starting point is the Hamiltonian $H = J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$, with $J>0$. The variational state $|\\Psi_{MF}\\rangle$ is the ground state of a mean-field Hamiltonian $H_{\\text{MF}}$ describing non-interacting fermions on a square lattice with a $\\pi$-flux through each plaquette.\n\nFirst, we derive the expression for the variational energy $E = \\langle \\Psi_{MF} | H | \\Psi_{MF} \\rangle$. The spin operators are expressed in the fermionic slave-particle representation: $\\mathbf{S}_i = \\frac{1}{2} \\sum_{\\alpha, \\beta} f^\\dagger_{i\\alpha} \\boldsymbol{\\sigma}_{\\alpha\\beta} f_{i\\beta}$, where $f_{i\\alpha}$ are fermion annihilation operators for spin $\\alpha \\in \\{\\uparrow, \\downarrow\\}$ at site $i$, and $\\boldsymbol{\\sigma}$ is the vector of Pauli matrices.\n\nThe energy is the sum of expectation values over nearest-neighbor bonds, $E = J \\sum_{\\langle ij \\rangle} \\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle$. The ansatz state $|\\Psi_{MF}\\rangle$ is the ground state of a spin-independent hopping Hamiltonian, forming a product of two identical Slater determinants for up and down spins: $|\\Psi_{MF}\\rangle = |\\Psi_0\\rangle_\\uparrow \\otimes |\\Psi_0\\rangle_\\downarrow$. This state is a spin-singlet, meaning it is invariant under global SU(2) spin rotations. Consequently, the expectation values of the spin-spin correlation functions are isotropic:\n$$\n\\langle S_i^x S_j^x \\rangle = \\langle S_i^y S_j^y \\rangle = \\langle S_i^z S_j^z \\rangle\n$$\nThis allows us to write the total correlation as $\\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = 3 \\langle S_i^z S_j^z \\rangle$.\n\nWe now calculate $\\langle S_i^z S_j^z \\rangle$. The $z$-component of the spin operator is $S_i^z = \\frac{1}{2}(f^\\dagger_{i\\uparrow}f_{i\\uparrow} - f^\\dagger_{i\\downarrow}f_{i\\downarrow}) = \\frac{1}{2}(n_{i\\uparrow} - n_{i\\downarrow})$. The expectation value is:\n$$\n\\langle S_i^z S_j^z \\rangle = \\frac{1}{4} \\langle (n_{i\\uparrow} - n_{i\\downarrow})(n_{j\\uparrow} - n_{j\\downarrow}) \\rangle = \\frac{1}{4} \\left( \\langle n_{i\\uparrow} n_{j\\uparrow} \\rangle - \\langle n_{i\\uparrow} n_{j\\downarrow} \\rangle - \\langle n_{i\\downarrow} n_{j\\uparrow} \\rangle + \\langle n_{i\\downarrow} n_{j\\downarrow} \\rangle \\right)\n$$\nSince the mean-field Hamiltonian $H_{\\text{MF}}$ has no terms coupling the two spin species, the expectation value of operators involving different spins factorizes, e.g., $\\langle n_{i\\uparrow} n_{j\\downarrow} \\rangle = \\langle n_{i\\uparrow} \\rangle \\langle n_{j\\downarrow} \\rangle$. For a non-magnetic state at half-filling, $\\langle n_{i\\sigma} \\rangle = 1/2$ for all $i$ and $\\sigma$. Thus, $\\langle n_{i\\uparrow} n_{j\\downarrow} \\rangle = \\langle n_{i\\downarrow} n_{j\\uparrow} \\rangle = (1/2)(1/2) = 1/4$.\n\nFor operators of the same spin species, we apply Wick's theorem for a free-fermion ground state. For $i \\ne j$:\n$$\n\\langle n_{i\\sigma} n_{j\\sigma} \\rangle = \\langle f^\\dagger_{i\\sigma} f_{i\\sigma} f^\\dagger_{j\\sigma} f_{j\\sigma} \\rangle = \\langle n_{i\\sigma} \\rangle \\langle n_{j\\sigma} \\rangle - |\\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle|^2\n$$\nLet's define the single-species correlation function $C_{ij} = \\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle$. This is independent of spin $\\sigma$ because $|\\Psi_0\\rangle_\\uparrow$ and $|\\Psi_0\\rangle_\\downarrow$ are identical. Thus, $\\langle n_{i\\sigma} n_{j\\sigma} \\rangle = (1/2)(1/2) - |C_{ij}|^2 = 1/4 - |C_{ij}|^2$.\n\nSubstituting these results back into the expression for $\\langle S_i^z S_j^z \\rangle$:\n$$\n\\langle S_i^z S_j^z \\rangle = \\frac{1}{4} \\left( (1/4 - |C_{ij}|^2) - 1/4 - 1/4 + (1/4 - |C_{ij}|^2) \\right) = -\\frac{1}{2} |C_{ij}|^2\n$$\nThe total spin-spin correlation is then:\n$$\n\\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = 3 \\langle S_i^z S_j^z \\rangle = -\\frac{3}{2} |C_{ij}|^2\n$$\nThe problem defines the spin-summed bond expectation value $\\chi_{ij} = \\sum_\\sigma \\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle = 2 C_{ij}$ (since $C_{ij}$ is spin-independent). Therefore, $C_{ij} = \\chi_{ij}/2$. Substituting this gives:\n$$\n\\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = -\\frac{3}{2} \\left| \\frac{\\chi_{ij}}{2} \\right|^2 = -\\frac{3}{8} |\\chi_{ij}|^2\n$$\nThe total variational energy is obtained by summing over all nearest-neighbor bonds:\n$$\nE = J \\sum_{\\langle ij \\rangle} \\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = -J \\frac{3}{8} \\sum_{\\langle ij \\rangle} |\\chi_{ij}|^2\n$$\nThe energy per site, in units of $J$, is:\n$$\n\\frac{E}{NJ} = -\\frac{3}{8N} \\sum_{\\langle ij \\rangle} |\\chi_{ij}|^2\n$$\nThis is the final expression to be implemented. The calculation proceeds by numerically constructing and diagonalizing $H_{\\text{MF}}$ for a single spin species to find the ground state projector $P$, from which we get $\\chi_{ij} = 2 P_{ji}$. The sum over $\\langle ij \\rangle$ runs over all $2N$ bonds on the $L \\times L$ torus.\n\n### Python Implementation\nThe numerical implementation performs the following steps, as detailed in the problem description:\n1. For each $(L, \\text{BC})$ pair, construct the $N \\times N$ ($N=L^2$) real-space matrix for $H_{\\text{MF}}$.\n2. Diagonalize $H_{\\text{MF}}$ and use the eigenvectors corresponding to the $N/2$ lowest eigenvalues to form the ground-state projector matrix $P$.\n3. Compute $\\chi_{ij} = 2P_{ji}$ for all nearest-neighbor bonds $\\langle ij \\rangle$.\n4. Calculate the energy per site $E(L)/J$ using the derived formula.\n5. For each set of boundary conditions, fit the results to $E(L) = E_\\infty + c/L^3$ to find $E_\\infty/J$.\n6. Check for monotonic decrease in energy with increasing $L$.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_energy_per_site(L, bc_x_str, bc_y_str):\n    \"\"\"\n    Calculates the mean-field variational energy per site for the DSL ansatz.\n\n    Args:\n        L (int): The linear size of the L x L square lattice.\n        bc_x_str (str): Boundary condition in x ('periodic' or 'antiperiodic').\n        bc_y_str (str): Boundary condition in y ('periodic' or 'antiperiodic').\n\n    Returns:\n        float: The variational energy per site in units of J.\n    \"\"\"\n    N = L * L\n    \n    # Set BC phases: +1 for Periodic, -1 for Anti-periodic\n    bc_x_phase = -1.0 if bc_x_str == 'antiperiodic' else 1.0\n    bc_y_phase = -1.0 if bc_y_str == 'antiperiodic' else 1.0\n\n    # 1. Construct the mean-field Hamiltonian H_MF for one spin species\n    H_mf = np.zeros((N, N), dtype=np.float64)\n    t = 1.0  # Mean-field hopping amplitude scale\n\n    for i in range(N):\n        x, y = i % L, i // L\n\n        # Horizontal hopping (i to i+x_hat)\n        j_h = y * L + (x + 1) % L\n        phase_h = bc_x_phase if x == L - 1 else 1.0\n        H_mf[i, j_h] = t * phase_h\n        H_mf[j_h, i] = t * phase_h\n\n        # Vertical hopping (i to i+y_hat)\n        # Hopping strength depends on x-coordinate due to pi-flux\n        t_v = t * (1.0 if x % 2 == 0 else -1.0)\n        j_v = ((y + 1) % L) * L + x\n        phase_v = bc_y_phase if y == L - 1 else 1.0\n        H_mf[i, j_v] = t_v * phase_v\n        H_mf[j_v, i] = t_v * phase_v\n\n    # 2. Diagonalize H_MF and form the ground-state projector P\n    eigvals, eigvecs = np.linalg.eigh(H_mf)\n    \n    # At half-filling, occupy the lowest N/2 states\n    num_occupied = N // 2\n    occupied_vecs = eigvecs[:, :num_occupied]\n    \n    # Projector P = V @ V_dagger. P_ij = sum_k v_ik v_jk\n    P = occupied_vecs @ occupied_vecs.T\n\n    # 3. Compute the variational energy per site using the derived formula\n    # E/(NJ) = - (3 / (8N)) * sum_{<ij>} |chi_ij|^2\n    # The sum is over all unique nearest-neighbor bonds.\n    \n    chi_sq_sum_bonds = 0.0\n    for i in range(N):\n        x, y = i % L, i // L\n        \n        # Horizontal bond <i, j_h>\n        j_h = y * L + (x + 1) % L\n        # chi_ij = 2 * P_ji\n        chi_ij_h = 2.0 * P[j_h, i]\n        chi_sq_sum_bonds += chi_ij_h**2\n        \n        # Vertical bond <i, j_v>\n        j_v = ((y + 1) % L) * L + x\n        chi_ij_v = 2.0 * P[j_v, i]\n        chi_sq_sum_bonds += chi_ij_v**2\n    \n    # The loop over i considers neighbors to the right and down, covering all\n    # 2N bonds on the torus exactly once.\n    \n    energy_per_site_over_J = - (3.0 / (8.0 * N)) * chi_sq_sum_bonds\n    \n    return energy_per_site_over_J\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'L_values': [10, 14, 18], 'bc_x': 'periodic', 'bc_y': 'periodic'},\n        # Case 2\n        {'L_values': [8, 12, 16], 'bc_x': 'antiperiodic', 'bc_y': 'periodic'},\n        # Case 3\n        {'L_values': [8, 12, 16], 'bc_x': 'antiperiodic', 'bc_y': 'antiperiodic'},\n        # Case 4\n        {'L_values': [6, 8, 10], 'bc_x': 'periodic', 'bc_y': 'antiperiodic'},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L_values = case['L_values']\n        bc_x = case['bc_x']\n        bc_y = case['bc_y']\n        \n        energies = []\n        L_inv_cubed = []\n        for L in L_values:\n            e = calculate_energy_per_site(L, bc_x, bc_y)\n            energies.append(e)\n            L_inv_cubed.append(1.0 / (L**3))\n        \n        # Fit E(L) = E_inf + c/L^3, which is a linear model y = c*x + E_inf\n        # where y = E(L) and x = 1/L^3.\n        # np.polyfit with deg=1 returns [slope, intercept].\n        coeffs = np.polyfit(L_inv_cubed, energies, 1)\n        E_infinity = coeffs[1]\n        \n        # Check for monotonic decrease of energy with increasing L\n        is_monotonic = all(energies[i] > energies[i+1] for i in range(len(energies) - 1))\n        \n        results.append(E_infinity)\n        results.append(is_monotonic)\n\n    # Final print statement in the exact required format.\n    # Convert booleans to strings ('True', 'False') and join all items.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "answer": "[-0.4623101851881682,False,-0.4622222222222221,False,-0.4623101851851852,False,-0.4622222222222222,True]", "id": "3013886"}]}