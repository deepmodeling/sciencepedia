{"hands_on_practices": [{"introduction": "To build a solid foundation in unconventional superconductivity, one must first master the mathematical language used to describe different pairing symmetries. The momentum-space structure of the superconducting order parameter, $\\Delta(\\mathbf{k})$, can be systematically classified by decomposing it into a basis of functions that respect the point-group symmetry of the crystal lattice. This exercise provides direct practice in this essential skill by having you perform a Fourier decomposition of a given anisotropic gap function on a simple circular Fermi surface, connecting the abstract labels of $s$-wave, $d$-wave, and $g$-wave pairing to their concrete mathematical representations [@problem_id:3023139].", "problem": "A two-dimensional ($2$D) isotropic Fermi surface admits an angular decomposition of a spin-singlet, even-parity superconducting gap function $\\Delta(\\theta)$ in a basis of real angular harmonics $\\{\\cos(n\\theta)\\}_{n=0}^{\\infty}$, where $\\theta$ is the Fermi surface polar angle. Consider the anisotropic gap\n$$\n\\Delta(\\theta)=\\Delta_{0}\\left[\\frac{1}{5}+\\cos^{2}\\!\\left(2\\theta\\right)+\\frac{1}{3}\\cos\\!\\left(2\\theta\\right)\\cos\\!\\left(4\\theta\\right)+\\frac{2}{7}\\cos^{3}\\!\\left(2\\theta\\right)\\right],\n$$\nwith $\\Delta_{0}>0$ a real amplitude. Using only the orthogonality of trigonometric functions on $[0,2\\pi]$ and basic trigonometric identities, decompose $\\Delta(\\theta)$ into angular momentum channels by determining the coefficients $a_{n}$ in\n$$\n\\Delta(\\theta)=\\sum_{n=0}^{\\infty}a_{n}\\cos(n\\theta).\n$$\nThen, identify which coefficients correspond to the $s$-wave, $d$-wave, and $g$-wave contributions on a circular Fermi surface, and report the triple $(a_{0}/\\Delta_{0},a_{2}/\\Delta_{0},a_{4}/\\Delta_{0})$ explicitly.\n\nExpress your final answer as a row matrix $\\begin{pmatrix}a_{0}/\\Delta_{0} & a_{2}/\\Delta_{0} & a_{4}/\\Delta_{0}\\end{pmatrix}$ using exact rational numbers. No rounding is required.", "solution": "The problem requires the decomposition of the given superconducting gap function $\\Delta(\\theta)$ into its angular momentum components. For a two-dimensional system with a circular Fermi surface, these components are represented by a Fourier cosine series, as the provided gap function is of even parity ($\\Delta(\\theta) = \\Delta(-\\theta)$). The target form is $\\Delta(\\theta)=\\sum_{n=0}^{\\infty}a_{n}\\cos(n\\theta)$. We are tasked with finding the specific coefficients $a_{0}$, $a_{2}$, and $a_{4}$, which correspond to the $s$-wave, $d$-wave, and $g$-wave pairing channels, respectively.\n\nWe begin by analyzing the normalized gap function, $\\frac{\\Delta(\\theta)}{\\Delta_0}$:\n$$\n\\frac{\\Delta(\\theta)}{\\Delta_0} = \\frac{1}{5}+\\cos^{2}\\!\\left(2\\theta\\right)+\\frac{1}{3}\\cos\\!\\left(2\\theta\\right)\\cos\\!\\left(4\\theta\\right)+\\frac{2}{7}\\cos^{3}\\!\\left(2\\theta\\right)\n$$\nTo express this function as a linear combination of $\\cos(n\\theta)$ terms, we will systematically linearize each term using fundamental trigonometric identities.\n\nThe relevant identities are:\n1.  Power-reduction for cosine squared: $\\cos^2(x) = \\frac{1}{2}\\left(1 + \\cos(2x)\\right)$\n2.  Power-reduction for cosine cubed: $\\cos^3(x) = \\frac{1}{4}\\left(3\\cos(x) + \\cos(3x)\\right)$\n3.  Product-to-sum for cosines: $\\cos(A)\\cos(B) = \\frac{1}{2}\\left(\\cos(A-B) + \\cos(A+B)\\right)$\n\nWe now apply these identities to each term of the normalized gap function.\n\nThe first term, $\\frac{1}{5}$, is a constant, which corresponds to the $n=0$ harmonic, as $\\cos(0\\theta) = 1$. So, this term is $\\frac{1}{5}\\cos(0\\theta)$.\n\nThe second term is $\\cos^{2}(2\\theta)$. Using the power-reduction formula with $x=2\\theta$:\n$$\n\\cos^{2}(2\\theta) = \\frac{1}{2}\\left(1 + \\cos(2 \\cdot 2\\theta)\\right) = \\frac{1}{2} + \\frac{1}{2}\\cos(4\\theta)\n$$\n\nThe third term is $\\frac{1}{3}\\cos(2\\theta)\\cos(4\\theta)$. Using the product-to-sum formula with $A=4\\theta$ and $B=2\\theta$:\n$$\n\\frac{1}{3}\\cos(2\\theta)\\cos(4\\theta) = \\frac{1}{3} \\cdot \\frac{1}{2}\\left(\\cos(4\\theta-2\\theta) + \\cos(4\\theta+2\\theta)\\right) = \\frac{1}{6}\\left(\\cos(2\\theta) + \\cos(6\\theta)\\right)\n$$\n\nThe fourth term is $\\frac{2}{7}\\cos^{3}(2\\theta)$. Using the power-reduction formula for a cube with $x=2\\theta$:\n$$\n\\frac{2}{7}\\cos^{3}(2\\theta) = \\frac{2}{7} \\cdot \\frac{1}{4}\\left(3\\cos(2\\theta) + \\cos(3 \\cdot 2\\theta)\\right) = \\frac{1}{14}\\left(3\\cos(2\\theta) + \\cos(6\\theta)\\right) = \\frac{3}{14}\\cos(2\\theta) + \\frac{1}{14}\\cos(6\\theta)\n$$\n\nNow, we sum these linearized components to reconstruct the full expression for $\\frac{\\Delta(\\theta)}{\\Delta_0}$:\n$$\n\\frac{\\Delta(\\theta)}{\\Delta_0} = \\frac{1}{5} + \\left(\\frac{1}{2} + \\frac{1}{2}\\cos(4\\theta)\\right) + \\left(\\frac{1}{6}\\cos(2\\theta) + \\frac{1}{6}\\cos(6\\theta)\\right) + \\left(\\frac{3}{14}\\cos(2\\theta) + \\frac{1}{14}\\cos(6\\theta)\\right)\n$$\nWe group the terms by the order of the harmonic, $n$:\n$$\n\\frac{\\Delta(\\theta)}{\\Delta_0} = \\left(\\frac{1}{5} + \\frac{1}{2}\\right)\\cos(0\\theta) + \\left(\\frac{1}{6} + \\frac{3}{14}\\right)\\cos(2\\theta) + \\left(\\frac{1}{2}\\right)\\cos(4\\theta) + \\left(\\frac{1}{6} + \\frac{1}{14}\\right)\\cos(6\\theta)\n$$\nNext, we compute the sums of the coefficients for each harmonic.\n\nFor $n=0$ ($s$-wave component), the coefficient is $a_0/\\Delta_0$:\n$$\n\\frac{a_{0}}{\\Delta_{0}} = \\frac{1}{5} + \\frac{1}{2} = \\frac{2}{10} + \\frac{5}{10} = \\frac{7}{10}\n$$\n\nFor $n=2$ ($d$-wave component), the coefficient is $a_2/\\Delta_0$:\n$$\n\\frac{a_{2}}{\\Delta_{0}} = \\frac{1}{6} + \\frac{3}{14} = \\frac{7}{42} + \\frac{9}{42} = \\frac{16}{42} = \\frac{8}{21}\n$$\n\nFor $n=4$ ($g$-wave component), the coefficient is $a_4/\\Delta_0$:\n$$\n\\frac{a_{4}}{\\Delta_{0}} = \\frac{1}{2}\n$$\n\nFor completeness, for $n=6$ ($i$-wave component), the coefficient is $a_6/\\Delta_0$:\n$$\n\\frac{a_{6}}{\\Delta_{0}} = \\frac{1}{6} + \\frac{1}{14} = \\frac{7}{42} + \\frac{3}{42} = \\frac{10}{42} = \\frac{5}{21}\n$$\nThe problem asks for the triple $(a_{0}/\\Delta_{0}, a_{2}/\\Delta_{0}, a_{4}/\\Delta_{0})$, which we have now determined. These are the normalized coefficients for the $s$-wave, $d$-wave, and $g$-wave contributions to the superconducting gap.\n\nThe requested values are:\n$a_{0}/\\Delta_{0} = \\frac{7}{10}$\n$a_{2}/\\Delta_{0} = \\frac{8}{21}$\n$a_{4}/\\Delta_{0} = \\frac{1}{2}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{7}{10} & \\frac{8}{21} & \\frac{1}{2} \\end{pmatrix}}\n$$", "id": "3023139"}, {"introduction": "A defining feature of unconventional superconductors is that their internal gap symmetry can give rise to remarkable and directly observable phenomena at boundaries. This practice delves into one of the most celebrated examples: the formation of zero-energy Andreev bound states (ZEABS) at the surface of a $d$-wave superconductor. By working through the quasiclassical Andreev approximation, you will derive firsthand how the sign change of the $d_{x^2-y^2}$ order parameter upon quasiparticle reflection at a [110] surface necessarily leads to the emergence of a protected, dispersionless band of states at the Fermi energy [@problem_id:3023173].", "problem": "Consider a clean, quasi-two-dimensional spin-singlet $d_{x^{2}-y^{2}}$ superconductor occupying the half-space $x>0$, with a perfectly specular, atomically flat [110] surface located at $x=0$. Assume a cylindrical Fermi surface with Fermi momentum $k_{F}$ and Fermi velocity $v_{F}$. The crystalline axes are rotated such that the surface normal coincides with the crystallographic [110] direction. Work within the quasiclassical Andreev approximation of the Bogoliubovâ€“de Gennes (BdG) equations, in which the quasiparticle dynamics reduce to one-dimensional Andreev equations along classical trajectories labeled by the incidence angle $\\theta$ relative to the surface normal. The superconducting pair potential may be taken to depend only on the momentum direction through the usual $d_{x^{2}-y^{2}}$ form, $\\Delta(\\theta)=\\Delta_{0}\\cos\\left(2(\\theta-\\alpha)\\right)$, where $\\alpha$ is the orientation angle between the crystalline $a$ axis and the surface normal. For the [110] surface, take $\\alpha=\\pi/4$. The surface is impenetrable, and there is no time-reversal symmetry breaking at the boundary.\n\nStarting from the BdG equations under the Andreev approximation and enforcing physically correct boundary conditions for a specularly reflecting interface, derive the surface-bound-state spectrum $E(\\theta)$ for subgap Andreev bound states localized near $x=0$. Then map the incidence angle to the conserved surface momentum $k_{\\parallel}$ via $k_{\\parallel}=k_{F}\\sin\\theta$, and express the dispersion $E(k_{\\parallel})$ of the zero-energy flat band localized at the [110] surface. You may assume that the bulk pair potential is spatially uniform away from the surface and real, and you may neglect self-consistent suppression of the magnitude near the boundary provided your derivation remains controlled within the Andreev approximation. Provide the final analytic expression for $E(k_{\\parallel})$ in closed form. No numerical evaluation or rounding is required, and no physical units are to be reported in the final answer.", "solution": "The problem requires the derivation of the surface-bound-state dispersion $E(k_{\\parallel})$ for a $d_{x^{2}-y^{2}}$ superconductor occupying the half-space $x>0$ with a [110] surface at $x=0$. We will work within the quasiclassical Andreev approximation.\n\nFirst, we must establish the form of the pair potential, $\\Delta$, experienced by a quasiparticle along its classical trajectory. The problem specifies the pair potential's momentum dependence as $\\Delta(\\phi_k)=\\Delta_{0}\\cos(2\\phi_k)$, where $\\phi_k$ is the angle of the quasiparticle momentum $\\mathbf{k}$ with respect to the crystalline $a$-axis ([100] direction). However, the problem statement provides a slightly different but equivalent form $\\Delta(\\theta')=\\Delta_{0}\\cos\\left(2(\\theta'-\\alpha)\\right)$, where $\\theta'$ is the angle of the momentum vector and $\\alpha$ is the angle between the surface normal and the $a$-axis. For a [110] surface, $\\alpha=\\pi/4$.\n\nA quasiparticle trajectory is labeled by its angle of incidence $\\theta \\in [0, \\pi/2]$ with respect to the surface normal (the $x$-axis). Due to specular reflection at the surface $x=0$, a quasiparticle incident on the surface has its velocity component $v_x$ reversed, while the parallel component $v_y$ is conserved.\nLet the lab coordinate system be $(x,y)$, with the $x$-axis normal to the surface. The crystalline $a$-axis is rotated by $\\alpha=\\pi/4$ with respect to the $x$-axis.\nThe momentum vector $\\mathbf{k}$ for a quasiparticle on a trajectory with angle $\\theta'$ relative to the $x$-axis makes an angle $\\phi_k = \\theta' - \\alpha$ with the $a$-axis. The pair potential it experiences is $\\Delta(\\theta') = \\Delta_0 \\cos(2(\\theta' - \\alpha))$.\n\nAn incoming quasiparticle moves towards the surface ($x=0$) from the bulk ($x>0$). Its velocity is $\\mathbf{v}_{in} = (-v_F\\cos\\theta, v_F\\sin\\theta)$, so its momentum vector $\\mathbf{k}_{in}$ makes an angle $\\theta'_{in} = \\pi-\\theta$ with the $+x$-axis.\nThe pair potential for the incoming path is:\n$$ \\Delta_{in} = \\Delta(\\theta'_{in}) = \\Delta_0 \\cos(2((\\pi-\\theta) - \\pi/4)) = \\Delta_0 \\cos(2(3\\pi/4 - \\theta)) = \\Delta_0 \\cos(3\\pi/2 - 2\\theta) = -\\Delta_0 \\sin(2\\theta) $$\nA reflected quasiparticle moves away from the surface. Its velocity is $\\mathbf{v}_{out} = (v_F\\cos\\theta, v_F\\sin\\theta)$, so its momentum vector $\\mathbf{k}_{out}$ makes an angle $\\theta'_{out} = \\theta$ with the $+x$-axis.\nThe pair potential for the outgoing path is:\n$$ \\Delta_{out} = \\Delta(\\theta'_{out}) = \\Delta_0 \\cos(2(\\theta - \\pi/4)) = \\Delta_0 \\cos(2\\theta - \\pi/2) = \\Delta_0 \\sin(2\\theta) $$\nCrucially, for a [110] surface, we find that the pair potential changes sign upon reflection: $\\Delta_{in} = -\\Delta_{out}$. We assume the pair potential is real, consistent with the given $d_{x^2-y^2}$ form. Let's denote $\\Delta_\\theta \\equiv \\Delta_{out}$, so $\\Delta_{in} = -\\Delta_\\theta$.\n\nThe surface bound state wavefunction $\\Psi(\\mathbf{r})$ must vanish at the impenetrable surface: $\\Psi(x=0, y, z) = 0$. Within the quasiclassical approximation, the wavefunction is written as a product of rapidly oscillating plane waves and slowly varying envelope functions.\n$$ \\Psi(\\mathbf{r}) = \\left[ \\psi_{out}(x) e^{i k_{Fx} x} + \\psi_{in}(x) e^{-i k_{Fx} x} \\right] e^{i k_{\\parallel} y} $$\nwhere $k_{Fx} = k_F \\cos\\theta$ and $k_\\parallel = k_F \\sin\\theta$. The envelope functions $\\psi_{out}(x)$ and $\\psi_{in}(x)$ are two-component Nambu spinors, $\\psi = (u, v)^T$. The boundary condition at $x=0$ implies:\n$$ \\psi_{out}(0) + \\psi_{in}(0) = 0 $$\nThe envelope functions for the outgoing and incoming trajectories satisfy separate 1D Andreev equations. For a bound state with energy $|E| < |\\Delta_\\theta|$, the solutions must decay exponentially into the bulk as $x \\to \\infty$. Let the solutions be of the form $\\psi(x) = \\psi_0 e^{-\\kappa x}$.\n\nFor the outgoing path (velocity $+v_{Fx}$), the Andreev equation is:\n$$ \\begin{pmatrix} -i\\hbar v_{Fx}\\partial_x - E & \\Delta_{out} \\\\ \\Delta_{out} & i\\hbar v_{Fx}\\partial_x - E \\end{pmatrix} \\psi_{out}(x) = 0 $$\nSubstituting $\\psi_{out}(x) = \\psi_{out,0} e^{-\\kappa x}$ leads to an algebraic system. A non-trivial solution exists if the determinant of the coefficient matrix is zero, which gives the decay constant $\\kappa$:\n$$ (\\hbar v_{Fx} \\kappa)^2 + E^2 - \\Delta_{out}^2 = 0 \\implies \\kappa = \\frac{\\sqrt{\\Delta_{out}^2 - E^2}}{\\hbar v_{Fx}} $$\nThe corresponding eigenvector is $\\psi_{out,0} \\propto \\begin{pmatrix} \\Delta_{out} \\\\ E - i\\hbar v_{Fx}\\kappa \\end{pmatrix} = \\begin{pmatrix} \\Delta_{out} \\\\ E - i\\sqrt{\\Delta_{out}^2 - E^2} \\end{pmatrix}$.\n\nFor the incoming path (velocity $-v_{Fx}$), the Andreev equation is:\n$$ \\begin{pmatrix} i\\hbar v_{Fx}\\partial_x - E & \\Delta_{in} \\\\ \\Delta_{in} & -i\\hbar v_{Fx}\\partial_x - E \\end{pmatrix} \\psi_{in}(x) = 0 $$\nSubstituting $\\psi_{in}(x) = \\psi_{in,0} e^{-\\kappa x}$ and using $|\\Delta_{in}| = |\\Delta_{out}|$ gives the same decay constant $\\kappa$. The eigenvector is $\\psi_{in,0} \\propto \\begin{pmatrix} \\Delta_{in} \\\\ E + i\\hbar v_{Fx}\\kappa \\end{pmatrix} = \\begin{pmatrix} \\Delta_{in} \\\\ E + i\\sqrt{\\Delta_{in}^2 - E^2} \\end{pmatrix}$.\n\nLet $\\Omega = \\sqrt{\\Delta_\\theta^2 - E^2}$. Since $|\\Delta_{in}| = |\\Delta_{out}| = |\\Delta_\\theta|$, we have $\\sqrt{\\Delta_{in}^2-E^2} = \\sqrt{\\Delta_{out}^2-E^2} = \\Omega$.\nThe envelopes are $\\psi_{in}(x) = A_{in} \\begin{pmatrix} -\\Delta_\\theta \\\\ E+i\\Omega \\end{pmatrix} e^{-\\kappa x}$ and $\\psi_{out}(x) = A_{out} \\begin{pmatrix} \\Delta_\\theta \\\\ E-i\\Omega \\end{pmatrix} e^{-\\kappa x}$, where $A_{in}$ and $A_{out}$ are constants.\nApplying the boundary condition $\\psi_{out}(0) + \\psi_{in}(0) = 0$:\n$$ A_{out} \\begin{pmatrix} \\Delta_\\theta \\\\ E-i\\Omega \\end{pmatrix} + A_{in} \\begin{pmatrix} -\\Delta_\\theta \\\\ E+i\\Omega \\end{pmatrix} = 0 $$\nThis vector equation gives a system of two linear equations:\n1. $A_{out}\\Delta_\\theta - A_{in}\\Delta_\\theta = 0 \\implies A_{out} = A_{in}$ (for $\\Delta_\\theta \\neq 0$).\n2. $A_{out}(E-i\\Omega) + A_{in}(E+i\\Omega) = 0$.\n\nSubstituting $A_{out}=A_{in}$ into the second equation (and assuming $A_{in} \\neq 0$ for a non-trivial solution):\n$$ (E-i\\Omega) + (E+i\\Omega) = 0 $$\n$$ 2E = 0 \\implies E = 0 $$\nThis remarkable result shows that for any trajectory $\\theta$ for which the pair potential is non-zero ($\\Delta_\\theta \\ne 0$), there exists a surface-bound state precisely at zero energy. The condition $\\Delta_\\theta = \\Delta_0\\sin(2\\theta) \\neq 0$ holds for all incidence angles $\\theta \\in (0, \\pi/2)$. These angles correspond to a range of surface momenta $k_\\parallel = k_F \\sin\\theta$.\n\nThe dispersion relation $E(k_\\parallel)$ describes the energy of these bound states as a function of the momentum parallel to the surface. Since we found that the energy is $E=0$ for all allowed values of $k_\\parallel$ (i.e., for $k_\\parallel \\in (0, k_F)$), the dispersion relation is that of a flat band at the Fermi level.\nThe expression for the dispersion is therefore:\n$$ E(k_\\parallel) = 0 $$", "answer": "$$\\boxed{0}$$", "id": "3023173"}, {"introduction": "This computational exercise bridges the gap between theoretical models and experimental data analysis, a critical skill in modern physics. In many real materials, different pairing symmetries may compete or even coexist, and spectroscopic probes like electronic Raman scattering are essential for disentangling them. You will work with a realistic model for symmetry-resolved Raman spectra, generate synthetic data, and then perform a nonlinear least-squares fit to extract the relative weights and energy scales of competing $s$-wave and $d$-wave components [@problem_id:3023137]. This practice highlights how quantitative information about the pairing state is extracted from complex, noisy experimental signals.", "problem": "You are given a simplified, symmetry-resolved model for the electronic Raman response of a superconductor with unconventional pairing, where a mixed order parameter with competing $s$-wave and $d$-wave components produces distinct pair-breaking features in different symmetry channels. The observable in a fixed symmetry channel is modeled as an additive superposition of two broadened pair-breaking peaks centered near twice the gap magnitudes, with symmetry-selective Raman vertices weighting the two contributions differently. Use this model to generate synthetic spectra for specified parameter sets and, from those synthetic data, extract the relative $s$- versus $d$-wave weights and the corresponding pair-breaking peak positions by fitting the data simultaneously across the symmetry channels.\n\nBase and assumptions:\n- The Raman intensity in a given channel is proportional to a symmetry-projected density response. Under the assumptions of linear response and in the clean limit broadened by residual scattering, the channel-resolved intensity can be well approximated as a sum of two Lorentzian features centered at the pair-breaking energies of the competing components. Concretely, for each symmetry channel $m$ and Raman shift $\\omega$ (in inverse centimeters), the synthetic intensity is\n$$\nI_m(\\omega) \\;=\\; \\sum_{c\\in\\{s,d\\}} w_c\\, v_{m,c}\\, L(\\omega;\\,\\Omega_c,\\Gamma_c) \\;+\\; \\epsilon_m(\\omega),\n$$\nwhere $w_c\\ge 0$ are the component weights satisfying $w_s+w_d=1$, $v_{m,c}$ are known, channel-dependent Raman vertex coefficients, $L(\\omega;\\Omega,\\Gamma)$ is a Lorentzian line shape, and $\\epsilon_m(\\omega)$ is additive Gaussian noise with zero mean and a specified standard deviation. The Lorentzian is defined by\n$$\nL(\\omega;\\Omega,\\Gamma) \\;=\\; \\frac{\\Gamma^2}{(\\omega-\\Omega)^2+\\Gamma^2},\n$$\nso that $L(\\Omega;\\Omega,\\Gamma)=1$.\n- The pair-breaking peak positions are $\\Omega_s$ and $\\Omega_d$ (both in $\\mathrm{cm}^{-1}$), and the broadenings are $\\Gamma_s$ and $\\Gamma_d$ (both in $\\mathrm{cm}^{-1}$). Assume the broadenings are known and channel independent. The vertices are fixed numbers per channel and component.\n\nFitting objective:\n- Given noisy synthetic data generated from the above model in two symmetry channels, simultaneously infer the relative $s$-wave fraction $f_s:=w_s$ and $f_d:=w_d=1-f_s$, as well as the two peak positions $\\Omega_s$ and $\\Omega_d$. To make labeling unambiguous in the reported answer, define the reported $\\Omega_s$ to be the larger of the two fitted peak positions and $\\Omega_d$ to be the smaller of the two fitted peak positions.\n\nNumerical setup and required units:\n- Frequency grid: use an evenly spaced grid $\\{\\omega_i\\}$ from $\\omega_{\\min}=100\\,\\mathrm{cm}^{-1}$ to $\\omega_{\\max}=500\\,\\mathrm{cm}^{-1}$ with step $\\Delta\\omega=1\\,\\mathrm{cm}^{-1}$. All reported peak positions must be expressed in $\\mathrm{cm}^{-1}$ and rounded to one decimal place in the final output. The weights $f_s$ and $f_d$ are dimensionless and must be rounded to four decimal places in the final output.\n- Channels and vertices: use two channels, labeled $B_{1g}$ and $B_{2g}$, with vertex coefficients\n$$\nv_{B_{1g},s}=0.15,\\quad v_{B_{1g},d}=1.0,\\quad v_{B_{2g},s}=0.70,\\quad v_{B_{2g},d}=0.35.\n$$\n- Broadenings: use $\\Gamma_s=12\\,\\mathrm{cm}^{-1}$ and $\\Gamma_d=16\\,\\mathrm{cm}^{-1}$ in all test cases.\n- Noise: in each channel independently, add Gaussian noise with zero mean and standard deviation $\\sigma=\\eta \\cdot \\max_{\\omega,m} I^{(0)}_m(\\omega)$, where $I^{(0)}_m(\\omega)$ is the noise-free intensity and $\\eta$ is a case-specific noise factor. For reproducibility, use the fixed random seed $12345$.\n\nTest suite (three distinct cases to ensure coverage of balanced, nearly single-component, and overlapping-peak regimes):\n1. Case A (balanced, well-separated peaks): true parameters\n   - $(w_s,w_d)=(0.60,0.40)$,\n   - $(\\Omega_s,\\Omega_d)=(380.0\\,\\mathrm{cm}^{-1},320.0\\,\\mathrm{cm}^{-1})$,\n   - $\\eta=0.015$.\n2. Case B (strongly $d$-dominated): true parameters\n   - $(w_s,w_d)=(0.05,0.95)$,\n   - $(\\Omega_s,\\Omega_d)=(370.0\\,\\mathrm{cm}^{-1},300.0\\,\\mathrm{cm}^{-1})$,\n   - $\\eta=0.010$.\n3. Case C (overlapping peaks, equal weights): true parameters\n   - $(w_s,w_d)=(0.50,0.50)$,\n   - $(\\Omega_s,\\Omega_d)=(350.0\\,\\mathrm{cm}^{-1},340.0\\,\\mathrm{cm}^{-1})$,\n   - $\\eta=0.015$.\n\nTask:\n- Implement a program that, for each of the above cases, generates the synthetic two-channel spectra on the specified grid using the given parameters and noise model, then estimates the parameters $(f_s,f_d,\\Omega_s,\\Omega_d)$ by fitting the model intensities to the noisy data simultaneously across both channels using least squares. The estimation must enforce $0\\le f_s\\le 1$ and report $f_d=1-f_s$. To standardize labeling, if the two fitted peak positions are $(\\Omega_1,\\Omega_2)$ with $\\Omega_1\\ge \\Omega_2$, report $\\Omega_s=\\Omega_1$ and $\\Omega_d=\\Omega_2$.\n- Angle units are not used in this problem. All reported peak positions must be in $\\mathrm{cm}^{-1}$ as specified above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test caseâ€™s result must itself be a list of four numbers $[f_s,f_d,\\Omega_s,\\Omega_d]$ in that order, with $f_s$ and $f_d$ rounded to four decimal places and $\\Omega_s$ and $\\Omega_d$ rounded to one decimal place, and the three case results must be aggregated into a single list. For example, the printed line should look like\n\"[[0.6000,0.4000,380.0,320.0],[...],[...]]\"\ncorresponding to the three cases in the order A, B, C.", "solution": "This computational problem is solved by implementing a routine that first generates synthetic spectral data and then fits a model to this data to recover the underlying parameters via nonlinear least-squares optimization.\n\n### Problem Formulation and Methodology\n\nThe core of the task is to fit a model for the Raman intensity $I_m(\\omega)$ to noisy data. The model, for a given symmetry channel $m$, is a weighted sum of two Lorentzian peaks corresponding to competing $s$-wave and $d$-wave components:\n$$\nI_{\\text{model},m}(\\omega; f_s, \\Omega_s, \\Omega_d) = f_s v_{m,s} L(\\omega; \\Omega_s, \\Gamma_s) + (1-f_s) v_{m,d} L(\\omega; \\Omega_d, \\Gamma_d)\n$$\nThe parameters to be determined from the fit are the $s$-wave fraction $f_s$ and the two peak positions, $\\Omega_s$ and $\\Omega_d$. The Raman vertices $v_{m,c}$ and broadenings $\\Gamma_c$ are given constants.\n\nThe overall strategy involves two main steps for each test case:\n1.  **Data Generation**: Synthetic data is created by computing the noise-free intensities $I^{(0)}_m(\\omega)$ using the true parameters provided for each case. Gaussian noise is then added, with its standard deviation $\\sigma$ determined by the noise factor $\\eta$ and the maximum noise-free intensity. A fixed random seed ($12345$) is used for reproducibility.\n\n2.  **Parameter Estimation (Fitting)**: To best constrain the parameters, a simultaneous fit is performed across both channels ($B_{1g}$ and $B_{2g}$). A single model function is passed to the `scipy.optimize.curve_fit` routine, which estimates the parameters $(f_s, \\Omega_s, \\Omega_d)$ by minimizing the sum of squared residuals between the model and the noisy data. The fit is constrained such that $0 \\le f_s \\le 1$.\n\nAfter the fit yields the optimal parameters, the results are processed according to the specified output format: the $d$-wave fraction $f_d$ is calculated as $1 - f_s$, the two fitted peak positions are sorted so that the reported $\\Omega_s$ is the larger value, and the final numbers are rounded to the required precision. The Python code in the `answer` block implements this entire procedure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Generates synthetic Raman spectra for a two-component superconductor model,\n    then fits the model to the noisy data to estimate the component weights and\n    pair-breaking peak positions.\n    \"\"\"\n\n    # Define constants and shared parameters\n    OMEGA_MIN = 100.0\n    OMEGA_MAX = 500.0\n    DELTA_OMEGA = 1.0\n    omega_grid = np.arange(OMEGA_MIN, OMEGA_MAX + DELTA_OMEGA, DELTA_OMEGA)\n    \n    VERTICES = {\n        'B1g': {'s': 0.15, 'd': 1.0},\n        'B2g': {'s': 0.70, 'd': 0.35}\n    }\n    \n    GAMMA_S = 12.0\n    GAMMA_D = 16.0\n    \n    RANDOM_SEED = 12345\n    rng = np.random.default_rng(RANDOM_SEED)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (balanced, well-separated peaks)\n        {'w_s': 0.60, 'w_d': 0.40, 'Omega_s': 380.0, 'Omega_d': 320.0, 'eta': 0.015},\n        # Case B (strongly d-dominated)\n        {'w_s': 0.05, 'w_d': 0.95, 'Omega_s': 370.0, 'Omega_d': 300.0, 'eta': 0.010},\n        # Case C (overlapping peaks, equal weights)\n        {'w_s': 0.50, 'w_d': 0.50, 'Omega_s': 350.0, 'Omega_d': 340.0, 'eta': 0.015},\n    ]\n\n    def lorentzian(omega, Omega, Gamma):\n        \"\"\"Computes the Lorentzian lineshape.\"\"\"\n        return Gamma**2 / ((omega - Omega)**2 + Gamma**2)\n\n    def simultaneous_model(omega_cat, f_s, Omega_s, Omega_d):\n        \"\"\"\n        Global model function for simultaneous fitting across two channels.\n        The s-component is defined by Gamma_s, the d-component by Gamma_d.\n        \"\"\"\n        n_points = len(omega_grid)\n        omega = omega_cat[:n_points]  # Both channels use the same omega grid\n\n        # Calculate intensity for B1g channel\n        i_b1g = (f_s * VERTICES['B1g']['s'] * lorentzian(omega, Omega_s, GAMMA_S) +\n                 (1 - f_s) * VERTICES['B1g']['d'] * lorentzian(omega, Omega_d, GAMMA_D))\n        \n        # Calculate intensity for B2g channel\n        i_b2g = (f_s * VERTICES['B2g']['s'] * lorentzian(omega, Omega_s, GAMMA_S) +\n                 (1 - f_s) * VERTICES['B2g']['d'] * lorentzian(omega, Omega_d, GAMMA_D))\n        \n        return np.concatenate((i_b1g, i_b2g))\n\n    results = []\n    for case in test_cases:\n        # 1. Generate synthetic data\n        \n        # Noise-free intensities\n        i_b1g_0 = (case['w_s'] * VERTICES['B1g']['s'] * lorentzian(omega_grid, case['Omega_s'], GAMMA_S) +\n                   case['w_d'] * VERTICES['B1g']['d'] * lorentzian(omega_grid, case['Omega_d'], GAMMA_D))\n        i_b2g_0 = (case['w_s'] * VERTICES['B2g']['s'] * lorentzian(omega_grid, case['Omega_s'], GAMMA_S) +\n                   case['w_d'] * VERTICES['B2g']['d'] * lorentzian(omega_grid, case['Omega_d'], GAMMA_D))\n        \n        # Determine noise standard deviation\n        max_i_0 = np.max(np.concatenate((i_b1g_0, i_b2g_0)))\n        sigma = case['eta'] * max_i_0\n        \n        # Generate noisy data\n        noise_b1g = rng.normal(0, sigma, size=len(omega_grid))\n        noise_b2g = rng.normal(0, sigma, size=len(omega_grid))\n        i_b1g_noisy = i_b1g_0 + noise_b1g\n        i_b2g_noisy = i_b2g_0 + noise_b2g\n        \n        # Prepare data for fitting\n        x_data = np.concatenate((omega_grid, omega_grid))\n        y_data = np.concatenate((i_b1g_noisy, i_b2g_noisy))\n        \n        # 2. Perform the fit\n        \n        # Initial guess and bounds for the parameters (f_s, Omega_s, Omega_d)\n        p0 = (0.5, 360, 310)\n        bounds = ([0, OMEGA_MIN, OMEGA_MIN], [1, OMEGA_MAX, OMEGA_MAX])\n        \n        popt, _ = curve_fit(simultaneous_model, x_data, y_data, p0=p0, bounds=bounds)\n        \n        f_s_fit, omega_s_fit_raw, omega_d_fit_raw = popt\n        \n        # 3. Process and format results\n        \n        f_d_fit = 1 - f_s_fit\n        \n        # Apply the reporting convention for peak positions\n        omega_s_report = max(omega_s_fit_raw, omega_d_fit_raw)\n        omega_d_report = min(omega_s_fit_raw, omega_d_fit_raw)\n        \n        # Format the result string for this case\n        fs_str = f\"{f_s_fit:.4f}\"\n        fd_str = f\"{f_d_fit:.4f}\"\n        omegas_str = f\"{omega_s_report:.1f}\"\n        omegad_str = f\"{omega_d_report:.1f}\"\n        \n        result_str = f\"[{fs_str},{fd_str},{omegas_str},{omegad_str}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[[{results[0]},{results[1]},{results[2]}]]\")\n\nsolve()\n```", "id": "3023137"}]}