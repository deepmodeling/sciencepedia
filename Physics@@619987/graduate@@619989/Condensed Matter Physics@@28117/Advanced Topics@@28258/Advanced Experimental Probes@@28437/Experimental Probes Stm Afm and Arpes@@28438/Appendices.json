{"hands_on_practices": [{"introduction": "Scanning Tunneling Spectroscopy (STS) is a powerful tool for probing the electronic density of states with atomic precision. However, the energy resolution of any STS measurement is fundamentally limited by the thermal energy of the system. This practice will guide you through the derivation of this thermal broadening effect, starting from the Fermi-Dirac distribution, to quantify how temperature places a limit on the sharpness of spectral features we can observe [@problem_id:2988543]. Mastering this calculation is essential for correctly interpreting STS data and understanding its intrinsic limitations.", "problem": "In scanning tunneling spectroscopy (STS), which is performed using scanning tunneling microscopy (STM), the measured differential conductance $dI/dV$ as a function of the bias voltage $V$ can be modeled as a convolution of the sample’s electronic density of states with the energy derivative of the Fermi–Dirac distribution. Assume the sample’s density of states is slowly varying on the energy scale of thermal broadening so that the energy resolution is limited by the width of the thermal kernel $-\\mathrm{d}f/\\mathrm{d}E$, where $f(E)$ is the Fermi–Dirac distribution. Starting from the definition of the Fermi–Dirac distribution at temperature $T$,\n$$\nf(E)=\\frac{1}{1+\\exp\\!\\left(\\frac{E}{k_{B}T}\\right)},\n$$\nderive the full-width at half-maximum (FWHM) of the kernel $-\\mathrm{d}f/\\mathrm{d}E$ in closed form, and use it to compute the thermal energy resolution at $T=4\\,\\mathrm{K}$, ignoring instrumental broadening such as voltage noise or lock-in modulation. Express the final energy in $\\mathrm{meV}$, and round your answer to four significant figures.", "solution": "The user has asked for a derivation of the full-width at half-maximum (FWHM) of the thermal broadening kernel used in scanning tunneling spectroscopy (STS) and its numerical evaluation at a specific temperature.\n\n### Step 1: Problem Validation\n\nThe problem is first validated against the required criteria.\n\n**1. Extract Givens:**\n- The measured differential conductance is $dI/dV$.\n- $dI/dV$ is a convolution of the sample's density of states (DOS) and the energy derivative of the Fermi-Dirac distribution, $-\\frac{df}{dE}$.\n- The energy resolution is limited by the FWHM of the kernel $-\\frac{df}{dE}$.\n- The Fermi-Dirac distribution is defined as $f(E) = \\frac{1}{1+\\exp\\left(\\frac{E}{k_B T}\\right)}$. Note that the chemical potential $\\mu$ is implicitly set to $0$ for this calculation, which is a standard convention as the width of the derivative peak is independent of its energy position.\n- Task 1: Derive the FWHM of $-\\frac{df}{dE}$ in closed form.\n- Task 2: Compute the thermal energy resolution (FWHM) at temperature $T=4\\,\\mathrm{K}$.\n- The final answer must be in units of $\\mathrm{meV}$ and rounded to four significant figures.\n\n**2. Validate Using Extracted Givens:**\n- **Scientifically Grounded:** The problem is firmly rooted in the principles of condensed matter physics and surface science. The T-dependent broadening of features in STS is a well-understood phenomenon, and its modeling via the derivative of the Fermi-Dirac distribution is a standard textbook approach derived from the Bardeen tunneling model.\n- **Well-Posed:** The problem is well-defined. It asks for the derivation of a specific quantity (FWHM) for a given mathematical function and for a subsequent numerical calculation. The function is continuous and has a single peak, so its FWHM is unique and well-defined.\n- **Objective:** The problem is stated using precise, objective scientific language.\n- **Flaw Check:** The problem exhibits no flaws. It is scientifically sound, internally consistent, complete, and solvable. It is a standard and relevant problem in the context of experimental condensed matter physics.\n\n**3. Verdict and Action:**\nThe problem is valid. The solution will proceed.\n\n### Step 2: Derivation of the FWHM\n\nThe thermal broadening kernel is given by the negative derivative of the Fermi-Dirac distribution with respect to energy $E$. Let us denote the kernel as $K(E)$.\n$$\nK(E) = -\\frac{df}{dE}\n$$\nThe Fermi-Dirac distribution is given by:\n$$\nf(E) = \\frac{1}{1+\\exp\\left(\\frac{E}{k_B T}\\right)} = \\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^{-1}\n$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nWe compute the derivative using the chain rule:\n$$\n\\frac{df}{dE} = -1 \\cdot \\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^{-2} \\cdot \\frac{d}{dE}\\left(\\exp\\left(\\frac{E}{k_B T}\\right)\\right)\n$$\n$$\n\\frac{df}{dE} = -\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^{-2} \\cdot \\exp\\left(\\frac{E}{k_B T}\\right) \\cdot \\frac{1}{k_B T}\n$$\n$$\n\\frac{df}{dE} = -\\frac{1}{k_B T} \\frac{\\exp\\left(\\frac{E}{k_B T}\\right)}{\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^2}\n$$\nTherefore, the kernel is:\n$$\nK(E) = -\\frac{df}{dE} = \\frac{1}{k_B T} \\frac{\\exp\\left(\\frac{E}{k_B T}\\right)}{\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^2}\n$$\nTo simplify this expression, we can use the identity for the hyperbolic secant function, $\\text{sech}(x) = 1/\\cosh(x)$. We know that $\\cosh(x) = \\frac{e^x+e^{-x}}{2}$. Let's manipulate the kernel's expression by multiplying the numerator and denominator by $\\exp\\left(-\\frac{E}{k_B T}\\right)$:\n$$\nK(E) = \\frac{1}{k_B T} \\frac{1}{\\exp\\left(-\\frac{E}{2k_B T}\\right)^2 \\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)^2} = \\frac{1}{k_B T} \\frac{1}{\\left(\\exp\\left(-\\frac{E}{2k_B T}\\right)\\left(1+\\exp\\left(\\frac{E}{k_B T}\\right)\\right)\\right)^2}\n$$\n$$\nK(E) = \\frac{1}{k_B T} \\frac{1}{\\left(\\exp\\left(-\\frac{E}{2k_B T}\\right) + \\exp\\left(\\frac{E}{2k_B T}\\right)\\right)^2}\n$$\nUsing the identity $2\\cosh(x) = e^x + e^{-x}$ with $x = \\frac{E}{2k_B T}$, we get:\n$$\nK(E) = \\frac{1}{k_B T} \\frac{1}{\\left(2\\cosh\\left(\\frac{E}{2k_B T}\\right)\\right)^2} = \\frac{1}{4k_B T} \\frac{1}{\\cosh^2\\left(\\frac{E}{2k_B T}\\right)}\n$$\n$$\nK(E) = \\frac{1}{4k_B T} \\text{sech}^2\\left(\\frac{E}{2k_B T}\\right)\n$$\nThis function is symmetric about $E=0$. To find the FWHM, we first determine the maximum value of $K(E)$. The function $\\text{sech}^2(x)$ has a maximum value of $1$ at $x=0$. Thus, $K(E)$ has its maximum at $E=0$:\n$$\nK_{max} = K(0) = \\frac{1}{4k_B T} \\text{sech}^2(0) = \\frac{1}{4k_B T}\n$$\nNext, we find the energy values $\\pm E_{HW}$ (where HW stands for half-width) at which the function is equal to half of its maximum value:\n$$\nK(E_{HW}) = \\frac{1}{2} K_{max}\n$$\n$$\n\\frac{1}{4k_B T} \\text{sech}^2\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\frac{1}{2} \\left(\\frac{1}{4k_B T}\\right)\n$$\n$$\n\\text{sech}^2\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\frac{1}{2}\n$$\nTaking the square root of both sides (and considering only the positive root as $\\text{sech}(x) > 0$):\n$$\n\\text{sech}\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\frac{1}{\\sqrt{2}}\n$$\nSince $\\text{sech}(x) = 1/\\cosh(x)$, this implies:\n$$\n\\cosh\\left(\\frac{E_{HW}}{2k_B T}\\right) = \\sqrt{2}\n$$\nTo solve for the argument, we use the inverse hyperbolic cosine function, $\\text{arccosh}(y) = \\ln(y + \\sqrt{y^2-1})$ for $y \\ge 1$:\n$$\n\\frac{E_{HW}}{2k_B T} = \\text{arccosh}(\\sqrt{2}) = \\ln\\left(\\sqrt{2} + \\sqrt{(\\sqrt{2})^2-1}\\right) = \\ln(\\sqrt{2} + \\sqrt{1})\n$$\n$$\n\\frac{E_{HW}}{2k_B T} = \\ln(1+\\sqrt{2})\n$$\nSolving for $E_{HW}$:\n$$\nE_{HW} = 2k_B T \\ln(1+\\sqrt{2})\n$$\nThe FWHM, denoted as $\\Delta E$, is twice the half-width:\n$$\n\\Delta E = 2 E_{HW} = 4k_B T \\ln(1+\\sqrt{2})\n$$\nThis is the closed-form expression for the FWHM of the thermal broadening kernel.\n\n### Step 3: Numerical Calculation\n\nWe are asked to compute this energy resolution for $T = 4\\,\\mathrm{K}$. We use the value of the Boltzmann constant $k_B \\approx 8.617333 \\times 10^{-5} \\, \\mathrm{eV/K}$. For this problem, it is convenient to express it in $\\mathrm{meV/K}$:\n$$\nk_B \\approx 0.08617333 \\, \\mathrm{meV/K}\n$$\nThe numerical value of the constant factor is:\n$$\n\\ln(1+\\sqrt{2}) \\approx \\ln(1 + 1.41421356) = \\ln(2.41421356) \\approx 0.88137359\n$$\nNow, we substitute the values into the FWHM formula:\n$$\n\\Delta E = 4 \\times (0.08617333 \\, \\mathrm{meV/K}) \\times (4 \\, \\mathrm{K}) \\times \\ln(1+\\sqrt{2})\n$$\n$$\n\\Delta E \\approx 4 \\times (0.08617333) \\times 4 \\times (0.88137359) \\, \\mathrm{meV}\n$$\n$$\n\\Delta E \\approx 1.215158 \\, \\mathrm{meV}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta E \\approx 1.215 \\, \\mathrm{meV}\n$$", "answer": "$$\\boxed{1.215}$$", "id": "2988543"}, {"introduction": "The remarkable sensitivity of modern Atomic Force Microscopy (AFM) allows for the detection of forces at the piconewton scale and even the imaging of individual chemical bonds. This sensitivity, however, is not infinite and is ultimately constrained by the laws of statistical mechanics. In this exercise, you will explore this fundamental limit by applying the equipartition theorem to an AFM cantilever, connecting its random thermal fluctuations to the minimum detectable force gradient [@problem_id:2988559]. This analysis is crucial for understanding the ultimate performance limits of AFM and appreciating the design principles behind high-sensitivity force measurements.", "problem": "An atomic force microscopy (AFM) experiment in the frequency-modulation (FM) mode uses a single-mode cantilever that can be modeled as a damped harmonic oscillator with spring constant $k$, resonance frequency $f_0$, and quality factor $Q$. The cantilever is driven at $f_0$ to a stable oscillation amplitude $A$. The environment is at temperature $T$, and the measurement channel has an equivalent noise bandwidth $B$ (in hertz), set by the phase-locked loop and demodulation filters. Thermal fluctuations of the oscillator set a limit to the precision with which a small, conservative tip-sample force gradient can be detected via resonance frequency shift.\n\nStarting only from fundamental principles and well-tested formulas for thermal noise in damped harmonic oscillators, derive an analytic expression for the minimum detectable conservative force gradient in FM-AFM, defined as the gradient whose induced resonance frequency shift equals the root-mean-square thermal frequency noise within the measurement bandwidth. As an intermediate step, compute the thermal root-mean-square deflection amplitude from equipartition. Then evaluate both the thermal deflection amplitude and the minimum detectable force gradient numerically for the following parameters:\n- $k = 200~\\mathrm{N/m}$,\n- $f_0 = 2.50 \\times 10^{4}~\\mathrm{Hz}$,\n- $Q = 2.50 \\times 10^{4}$,\n- $A = 5.00 \\times 10^{-10}~\\mathrm{m}$,\n- $T = 5.00~\\mathrm{K}$,\n- $B = 2.00 \\times 10^{2}~\\mathrm{Hz}$,\nand the Boltzmann constant $k_B = 1.380649 \\times 10^{-23}~\\mathrm{J/K}$.\n\nRound both requested numerical values to three significant figures. Express the thermal deflection amplitude in meters and the minimum detectable force gradient in $\\mathrm{N/m}$. Provide your final answer as a two-entry row matrix containing, in order, the thermal deflection amplitude and the minimum detectable force gradient.", "solution": "The solution involves a two-part derivation followed by numerical calculation.\n\n### Part 1: Derivation of Thermal RMS Deflection Amplitude\nThe cantilever is modeled as a harmonic oscillator in thermal equilibrium with its environment at temperature $T$. According to the equipartition theorem, each quadratic degree of freedom of the system has an average energy of $\\frac{1}{2}k_B T$. The potential energy stored in the cantilever spring due to a deflection $z$ is $E_p = \\frac{1}{2}kz^2$. Equating the average potential energy to the thermal energy gives:\n$$\n\\langle E_p \\rangle = \\frac{1}{2}k\\langle z_{th}^2 \\rangle = \\frac{1}{2}k_B T\n$$\nSolving for the root-mean-square (RMS) thermal deflection amplitude, $z_{th,rms}$:\n$$\nz_{th,rms} = \\sqrt{\\langle z_{th}^2 \\rangle} = \\sqrt{\\frac{k_B T}{k}}\n$$\n\n### Part 2: Derivation of Minimum Detectable Force Gradient\nA small conservative tip-sample force gradient, $k_{ts} = \\frac{dF_{ts}}{dz}$, acts as an additional spring. For small perturbations, the frequency shift $\\delta f$ is related to the force gradient by:\n$$\n\\delta f \\approx -\\frac{f_0}{2k} k_{ts}\n$$\nThe ability to measure this shift is limited by frequency noise. The spectral density of thermal frequency noise for FM-AFM is given by the formula:\n$$\nS_{\\delta f} = \\frac{f_0 k_B T}{\\pi Q k A^2} \\quad [\\text{in units of Hz}^2/\\text{Hz}]\n$$\nThe total RMS frequency noise, $\\delta f_{rms}$, within a measurement bandwidth $B$ is found by integrating this white noise density:\n$$\n\\delta f_{rms} = \\sqrt{S_{\\delta f} \\cdot B} = \\sqrt{\\frac{f_0 k_B T B}{\\pi Q k A^2}} = \\frac{1}{A} \\sqrt{\\frac{f_0 k_B T B}{\\pi Q k}}\n$$\nThe minimum detectable force gradient, $k_{ts,min}$, is the gradient that produces a frequency shift equal in magnitude to the RMS noise ($\\vert\\delta f\\vert = \\delta f_{rms}$).\n$$\nk_{ts,min} = \\frac{2k}{f_0} \\delta f_{rms} = \\frac{2k}{f_0 A} \\sqrt{\\frac{f_0 k_B T B}{\\pi Q k}} = \\frac{2}{A} \\sqrt{\\frac{k^2 f_0 k_B T B}{f_0^2 \\pi Q k}}\n$$\nThis simplifies to the final analytic expression:\n$$\nk_{ts,min} = \\frac{2}{A} \\sqrt{\\frac{k k_B T B}{\\pi f_0 Q}}\n$$\n\n### Part 3: Numerical Calculation\nUsing the given parameters:\n1.  **Thermal RMS deflection amplitude:**\n    $$\n    z_{th,rms} = \\sqrt{\\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\cdot (5.00\\,\\mathrm{K})}{200\\,\\mathrm{N/m}}} = \\sqrt{3.4516225 \\times 10^{-25}\\,\\mathrm{m}^2} \\approx 5.875 \\times 10^{-13}\\,\\mathrm{m}\n    $$\n2.  **Minimum detectable force gradient:**\n    $$\n    k_{ts,min} = \\frac{2}{5.00 \\times 10^{-10}\\,\\mathrm{m}} \\sqrt{\\frac{(200\\,\\mathrm{N/m}) (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) (5.00\\,\\mathrm{K}) (2.00 \\times 10^{2}\\,\\mathrm{Hz})}{\\pi (2.50 \\times 10^4\\,\\mathrm{Hz}) (2.50 \\times 10^4)}}\n    $$\n    $$\n    k_{ts,min} = (4.00 \\times 10^9\\,\\mathrm{m}^{-1}) \\sqrt{\\frac{2.761298 \\times 10^{-18}\\,\\mathrm{J} \\cdot \\mathrm{N/m}}{1.963495 \\times 10^9}} = (4.00 \\times 10^9\\,\\mathrm{m}^{-1}) \\sqrt{1.40626 \\times 10^{-27}\\,\\mathrm{N}^2}\n    $$\n    $$\n    k_{ts,min} \\approx 1.500 \\times 10^{-4}\\,\\mathrm{N/m}\n    $$\nRounding to three significant figures:\n- Thermal deflection amplitude: $5.88 \\times 10^{-13}\\,\\mathrm{m}$.\n- Minimum detectable force gradient: $1.50 \\times 10^{-4}\\,\\mathrm{N/m}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.88 \\times 10^{-13} & 1.50 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$", "id": "2988559"}, {"introduction": "Angle-Resolved Photoemission Spectroscopy (ARPES) provides a direct window into the electronic band structure of a crystal by mapping occupied states in reciprocal space. One of its most powerful quantitative applications is the determination of charge carrier density via Luttinger's theorem, which relates the volume of the Fermi surface to the number of charge carriers. This practice challenges you to derive this foundational relationship for a two-dimensional system and apply it to determine the carrier density from various Fermi surface shapes measured in a hypothetical ARPES experiment [@problem_id:2988548]. This task bridges the gap between abstract reciprocal space concepts and tangible macroscopic material properties.", "problem": "Consider a two-dimensional electron system probed by Angle-Resolved Photoemission Spectroscopy (ARPES). ARPES maps the Fermi surface contour in the two-dimensional Brillouin zone, providing a set of points in reciprocal space that approximate the boundary separating occupied and unoccupied states at zero temperature. Assume periodic boundary conditions in a square sample of side length $L$, so that allowed crystal momenta are quantized as $\\mathbf{k} = \\frac{2\\pi}{L}\\mathbf{n}$ with integer components. The density of $\\mathbf{k}$-states per unit area in reciprocal space follows from this quantization. Each $\\mathbf{k}$-state carries a degeneracy factor $g \\equiv g_s g_v$, where $g_s$ is the spin degeneracy and $g_v$ is any additional valley or band degeneracy that duplicates the Fermi pockets.\n\nStarting from the definitions above and fundamental state-counting arguments, derive the relation between the enclosed Fermi surface area and the carrier density for a two-dimensional system. Treat both electron-like pockets (where the Fermi surface encloses occupied states) and hole-like pockets (where the Fermi surface encloses unoccupied states near the top of a band) consistently by interpreting the ARPES-measured pocket area as the measure of mobile carriers (electrons for electron-like pockets, holes for hole-like pockets). Your derivation must begin from the stated quantization of $\\mathbf{k}$-states and end with an expression that depends only on the enclosed area in reciprocal space and the degeneracy $g$.\n\nYour program must implement the following computational steps:\n- Given ARPES-measured Fermi surface contours in two dimensions, compute the enclosed area in reciprocal space using appropriate geometry. When contours are described by a set of ordered points in $\\mathbf{k}$-space, use a robust polygon area computation. When contours are described analytically (e.g., circle or ellipse), use exact geometric formulas for area to avoid discretization error.\n- Convert all reciprocal space quantities to International System of Units (SI). The reciprocal space coordinates are provided in inverse Angstroms, where $1\\,\\mathrm{\\AA} = 10^{-10}\\,\\mathrm{m}$, so $1\\,\\mathrm{\\AA}^{-1} = 10^{10}\\,\\mathrm{m}^{-1}$. The area in reciprocal space therefore converts as $1\\,\\mathrm{\\AA}^{-2} = 10^{20}\\,\\mathrm{m}^{-2}$.\n- Use the derived expression to compute the carrier density. Report electron carrier density for electron-like pockets and hole carrier density for hole-like pockets, both as positive floats.\n- Express the final answers in $\\mathrm{m}^{-2}$ as floats.\n\nTest suite:\nProvide results for the following five cases. In all cases, the output must be a float representing the carrier density in $\\mathrm{m}^{-2}$, rounded to six significant digits.\n\n1. A single circular electron pocket centered at the origin with radius $k_F = 0.5\\,\\mathrm{\\AA}^{-1}$, spin degeneracy $g_s = 2$, valley degeneracy $g_v = 1$.\n2. A single circular hole pocket centered at a zone corner with radius $k_h = 0.2\\,\\mathrm{\\AA}^{-1}$, spin degeneracy $g_s = 2$, valley degeneracy $g_v = 1$.\n3. A single elliptical electron pocket centered at the origin with semi-axes $k_x = 0.3\\,\\mathrm{\\AA}^{-1}$ and $k_y = 0.5\\,\\mathrm{\\AA}^{-1}$, spin degeneracy $g_s = 2$, valley degeneracy $g_v = 2$.\n4. A single circular electron pocket in a fully spin-polarized system with radius $k_F = 0.35\\,\\mathrm{\\AA}^{-1}$, spin degeneracy $g_s = 1$, valley degeneracy $g_v = 1$.\n5. An anisotropic electron pocket described by an ordered set of ARPES points (in $\\mathrm{\\AA}^{-1}$) forming a simple closed contour:\n$\\{(0.40, 0.00), (0.35, 0.20), (0.15, 0.35), (0.00, 0.40), (-0.10, 0.35), (-0.25, 0.15), (-0.30, -0.05), (-0.10, -0.25), (0.20, -0.30), (0.35, -0.15)\\}$, with spin degeneracy $g_s = 2$, valley degeneracy $g_v = 1$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the float carrier density in $\\mathrm{m}^{-2}$ rounded to six significant digits.", "solution": "The problem is valid as it is scientifically grounded in the principles of condensed matter physics, is well-posed, and contains all necessary information for a unique solution. The core of the problem is to derive and apply the relationship between the carrier density of a two-dimensional electron gas and the area enclosed by its Fermi surface in reciprocal space.\n\nThe derivation begins from the quantization of crystal momentum $\\mathbf{k}$ in a finite system with periodic boundary conditions. For a two-dimensional square sample of side length $L$, the allowed momentum vectors are given by:\n$$ \\mathbf{k} = (k_x, k_y) = \\left( \\frac{2\\pi}{L}n_x, \\frac{2\\pi}{L}n_y \\right) $$\nwhere $n_x$ and $n_y$ are integers. These allowed $\\mathbf{k}$-vectors form a uniform square grid in the reciprocal plane. The area in reciprocal space associated with a single unique orbital $\\mathbf{k}$-state is therefore:\n$$ A_{\\text{state}} = \\Delta k_x \\Delta k_y = \\left( \\frac{2\\pi}{L} \\right)^2 = \\frac{4\\pi^2}{L^2} $$\nThe real-space area of the sample is $A = L^2$, so we can write the area per $\\mathbf{k}$-state as $A_{\\text{state}} = \\frac{4\\pi^2}{A}$. This means the density of orbital states in reciprocal space is $\\frac{1}{A_{\\text{state}}} = \\frac{A}{4\\pi^2}$.\n\nAt zero temperature, all states with energy below the Fermi energy are occupied, and those above are empty. The Fermi surface is the contour of constant energy $E_F$ that separates occupied from unoccupied states in $\\mathbf{k}$-space. For an electron-like pocket, the Fermi surface encloses occupied states. The total number of occupied orbital states, $N_{\\text{orb}}$, is found by integrating the density of states over the area $A_k$ enclosed by the Fermi surface:\n$$ N_{\\text{orb}} = \\iint_{A_k} \\frac{d^2k}{A_{\\text{state}}} = \\frac{1}{A_{\\text{state}}} \\iint_{A_k} d^2k = \\frac{A_k}{A_{\\text{state}}} = \\frac{A_k A}{4\\pi^2} $$\nFor a hole-like pocket, the Fermi surface encloses unoccupied states within an otherwise filled band. The area $A_k$ corresponds to the missing electrons, which are equivalent to the number of hole carriers. The counting argument remains identical for determining the number of holes.\n\nEach orbital $\\mathbf{k}$-state can have additional degeneracies. The problem specifies a total degeneracy factor $g = g_s g_v$, where $g_s$ is the spin degeneracy and $g_v$ is the valley or band degeneracy. Thus, the total number of carriers (electrons or holes), $N_{\\text{carriers}}$, is:\n$$ N_{\\text{carriers}} = g \\times N_{\\text{orb}} = g \\frac{A_k A}{4\\pi^2} $$\nThe carrier density, $n$, is the number of carriers per unit area in real space. It is an intensive quantity and should not depend on the sample size $L$ (or $A$).\n$$ n = \\frac{N_{\\text{carriers}}}{A} = \\frac{1}{A} \\left( g \\frac{A_k A}{4\\pi^2} \\right) $$\nThe real-space area $A$ cancels, yielding the final, fundamental relationship:\n$$ n = g \\frac{A_k}{4\\pi^2} $$\nThis expression connects the macroscopic carrier density $n$ to the microscopic Fermi surface area $A_k$ and is valid for both electron and hole pockets, where $A_k$ is the area of the respective pocket.\n\nTo solve the problem computationally, this formula is applied to each test case.\nFirst, the area $A_k$ must be calculated in units of $\\mathrm{\\AA}^{-2}$.\n- For a circular pocket of radius $k_F$, the area is $A_k = \\pi k_F^2$.\n- For an elliptical pocket with semi-axes $k_x$ and $k_y$, the area is $A_k = \\pi k_x k_y$.\n- For a pocket described by an ordered set of vertices $(k_{x,i}, k_{y,i})$, the area is calculated using the Shoelace formula for a polygon: $A_k = \\frac{1}{2} |\\sum_{i=1}^{N} (k_{x,i} k_{y,i+1} - k_{x,i+1} k_{y,i})|$, where the $(N+1)$-th vertex is the same as the first.\n\nSecond, the area $A_k$ is converted from $\\mathrm{\\AA}^{-2}$ to SI units ($\\mathrm{m}^{-2}$) using the conversion factor $1\\,\\mathrm{\\AA}^{-2} = (10^{10}\\,\\mathrm{m}^{-1})^2 = 10^{20}\\,\\mathrm{m}^{-2}$.\n\nFinally, the carrier density $n$ in $\\mathrm{m}^{-2}$ is computed using the derived formula with the SI value for $A_k$ and the given total degeneracy $g = g_s g_v$. The result is then rounded to six significant digits. The following Python code implements this procedure.", "answer": "```python\nimport numpy as np\nimport math\n\ndef round_to_significant_digits(num, sig_figs):\n    \"\"\"\n    Rounds a number to a specified number of significant digits.\n    \"\"\"\n    if num == 0:\n        return 0.0\n    # Calculate the power of 10 for the desired rounding precision.\n    power = -math.floor(math.log10(abs(num))) + (sig_figs - 1)\n    return round(num, power)\n\ndef compute_carrier_density(Ak_inv_angstroms_sq, g, sig_figs=6):\n    \"\"\"\n    Computes carrier density from Fermi surface area and degeneracy.\n\n    Args:\n        Ak_inv_angstroms_sq (float): Enclosed Fermi surface area in inverse Angstroms squared.\n        g (int): Total degeneracy factor (g_s * g_v).\n        sig_figs (int): Number of significant digits for the final result.\n\n    Returns:\n        float: Carrier density in m^-2, rounded to sig_figs.\n    \"\"\"\n    # Conversion factor for area from A^-2 to m^-2\n    ANGSTROM_SQ_TO_METER_SQ = 1e20\n\n    # Convert area to SI units (m^-2)\n    Ak_si = Ak_inv_angstroms_sq * ANGSTROM_SQ_TO_METER_SQ\n\n    # Apply the 2D carrier density formula: n = g * Ak / (4 * pi^2)\n    density = g * Ak_si / (4 * np.pi**2)\n\n    return round_to_significant_digits(density, sig_figs)\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Circular electron pocket\n        {'type': 'circle', 'params': {'r': 0.5}, 'gs': 2, 'gv': 1},\n        # Case 2: Circular hole pocket\n        {'type': 'circle', 'params': {'r': 0.2}, 'gs': 2, 'gv': 1},\n        # Case 3: Elliptical electron pocket\n        {'type': 'ellipse', 'params': {'kx': 0.3, 'ky': 0.5}, 'gs': 2, 'gv': 2},\n        # Case 4: Circular electron pocket, spin-polarized\n        {'type': 'circle', 'params': {'r': 0.35}, 'gs': 1, 'gv': 1},\n        # Case 5: Anisotropic electron pocket (polygon)\n        {\n            'type': 'polygon',\n            'params': {\n                'points': np.array([\n                    (0.40, 0.00), (0.35, 0.20), (0.15, 0.35), (0.00, 0.40),\n                    (-0.10, 0.35), (-0.25, 0.15), (-0.30, -0.05),\n                    (-0.10, -0.25), (0.20, -0.30), (0.35, -0.15)\n                ])\n            },\n            'gs': 2, 'gv': 1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Ak = 0.0\n        if case['type'] == 'circle':\n            r = case['params']['r']\n            # Area of a circle: pi * r^2\n            Ak = np.pi * r**2\n        elif case['type'] == 'ellipse':\n            kx = case['params']['kx']\n            ky = case['params']['ky']\n            # Area of an ellipse: pi * kx * ky\n            Ak = np.pi * kx * ky\n        elif case['type'] == 'polygon':\n            points = case['params']['points']\n            x = points[:, 0]\n            y = points[:, 1]\n            # Shoelace formula for polygon area\n            Ak = 0.5 * np.abs(np.dot(x, np.roll(y, -1)) - np.dot(y, np.roll(x, -1)))\n        \n        g = case['gs'] * case['gv']\n        density = compute_carrier_density(Ak, g)\n        results.append(density)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2988548"}]}