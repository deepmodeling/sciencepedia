{"hands_on_practices": [{"introduction": "A crucial first step in interpreting Muon Spin Rotation (µSR) data from a magnetic material is to connect the observed precession frequencies to the underlying crystal and magnetic structure. This requires calculating the local magnetic field at potential muon stopping sites from first principles. This exercise provides hands-on practice in performing such a calculation, where you will compute the net magnetic dipolar field at a candidate muon site by summing the contributions from nearby magnetic moments in a specified antiferromagnetic structure [@problem_id:3006863]. Mastering this fundamental skill is essential for predicting frequencies, identifying muon sites, and building a quantitative model of magnetism at the microscopic level.", "problem": "A collinear antiferromagnet with layered order is studied by Muon Spin Rotation ($\\mu$SR) below the Néel temperature ($T_N$). The crystallographic structure is tetragonal with lattice parameters $a$ and $c$. The magnetic structure consists of ferromagnetic square layers (moments collinear along the crystallographic $z$-axis) stacked antiferromagnetically along $c$. A candidate interstitial muon site is at the center of a square plaquette in one layer and midway between adjacent layers. Relative to the muon position (taken as the origin), the six nearest localized magnetic moments are at the following positions (in Cartesian coordinates, using the crystallographic axes as $x$, $y$, and $z$):\n- In-plane neighbors at $(\\pm a/2, 0, 0)$ and $(0, \\pm a/2, 0)$, each carrying a magnetic moment $+\\mathbf{m}$ with $\\mathbf{m} = m\\,\\hat{\\mathbf{z}}$.\n- Out-of-plane neighbors at $(0, 0, \\pm c/2)$, each carrying a magnetic moment $-\\mathbf{m}$ with $\\mathbf{m} = m\\,\\hat{\\mathbf{z}}$.\n\nAssume the localized moment magnitude is $m = 2.0\\,\\mu_B$, where $\\mu_B$ is the Bohr magneton. Neglect all contributions to the local field other than the magnetic dipole fields from these six moments, and neglect demagnetization, Lorentz, and contact hyperfine fields.\n\nStarting only from fundamental magnetostatics and the definition of Larmor precession, compute the net dipolar field at the muon site and the corresponding zero-field muon precession frequency expected below $T_N$ if the initial muon spin polarization is along the $x$-axis. Use the following constants:\n- $\\mu_0/(4\\pi) = 1.0 \\times 10^{-7}\\ \\mathrm{T\\,m/A}$,\n- $\\mu_B = 9.274 \\times 10^{-24}\\ \\mathrm{A\\,m^2}$,\n- $(\\gamma_{\\mu}/2\\pi) = 135.538\\ \\mathrm{MHz/T}$.\n\nTake $a = 5.00\\ \\mathrm{\\AA}$ and $c = 8.00\\ \\mathrm{\\AA}$, with $1\\ \\mathrm{\\AA} = 1.0 \\times 10^{-10}\\ \\mathrm{m}$. Express the final precession frequency in $\\mathrm{MHz}$ and round your answer to $4$ significant figures.", "solution": "The problem is assessed to be valid. It is scientifically grounded in fundamental principles of magnetostatics and quantum mechanics, is well-posed with all necessary information provided, and is objectively stated. The assumptions and simplifications are clearly defined, making the problem self-contained and solvable.\n\nThe problem requires the computation of the magnetic dipolar field at an interstitial muon site and the corresponding Larmor precession frequency. The total magnetic field at the muon site (taken as the origin of the coordinate system) is the vector sum of the fields produced by the six nearest magnetic moments.\n\nThe magnetic field $\\mathbf{B}$ at the origin, generated by a magnetic dipole moment $\\mathbf{m}_i$ located at position $\\mathbf{r}_i$, is given by the formula from magnetostatics:\n$$\n\\mathbf{B}_i = \\frac{\\mu_0}{4\\pi} \\left( \\frac{3(\\mathbf{m}_i \\cdot \\mathbf{r}_i)\\mathbf{r}_i}{|\\mathbf{r}_i|^5} - \\frac{\\mathbf{m}_i}{|\\mathbf{r}_i|^3} \\right)\n$$\nThe total field $\\mathbf{B}_{net}$ at the muon site is the superposition of the fields from the six specified moments:\n$$\n\\mathbf{B}_{net} = \\sum_{i=1}^{6} \\mathbf{B}_i\n$$\nThe moments can be separated into two groups for calculation.\n\n**Group 1: Four in-plane neighbors**\nThese are located at $\\mathbf{r}_1 = (\\frac{a}{2}, 0, 0)$, $\\mathbf{r}_2 = (-\\frac{a}{2}, 0, 0)$, $\\mathbf{r}_3 = (0, \\frac{a}{2}, 0)$, and $\\mathbf{r}_4 = (0, -\\frac{a}{2}, 0)$. Each carries a magnetic moment $\\mathbf{m}_i = +\\mathbf{m} = m\\,\\hat{\\mathbf{z}}$.\n\nFor each of these four moments, the position vector $\\mathbf{r}_i$ is in the $xy$-plane, while the moment vector $\\mathbf{m}_i$ is along the $z$-axis. Therefore, the scalar product $\\mathbf{m}_i \\cdot \\mathbf{r}_i$ is zero for $i=1, 2, 3, 4$.\nThe field contribution from each of these moments simplifies to:\n$$\n\\mathbf{B}_i = \\frac{\\mu_0}{4\\pi} \\left( \\frac{3(0)\\mathbf{r}_i}{|\\mathbf{r}_i|^5} - \\frac{m\\,\\hat{\\mathbf{z}}}{|\\mathbf{r}_i|^3} \\right) = - \\frac{\\mu_0}{4\\pi} \\frac{m\\,\\hat{\\mathbf{z}}}{|\\mathbf{r}_i|^3}\n$$\nThe distance for each of these moments is $|\\mathbf{r}_i| = \\frac{a}{2}$. Thus, the contribution from each is:\n$$\n\\mathbf{B}_i = - \\frac{\\mu_0}{4\\pi} \\frac{m\\,\\hat{\\mathbf{z}}}{(\\frac{a}{2})^3} = - \\frac{\\mu_0}{4\\pi} \\frac{8m}{a^3}\\hat{\\mathbf{z}}\n$$\nThe total field from these four identical contributions is:\n$$\n\\mathbf{B}_{group1} = 4 \\times \\left( - \\frac{\\mu_0}{4\\pi} \\frac{8m}{a^3}\\hat{\\mathbf{z}} \\right) = - \\frac{\\mu_0}{4\\pi} \\frac{32m}{a^3}\\hat{\\mathbf{z}}\n$$\n\n**Group 2: Two out-of-plane neighbors**\nThese are located at $\\mathbf{r}_5 = (0, 0, \\frac{c}{2})$ and $\\mathbf{r}_6 = (0, 0, -\\frac{c}{2})$. Each carries a magnetic moment $\\mathbf{m}_i = -\\mathbf{m} = -m\\,\\hat{\\mathbf{z}}$.\n\nFor the moment at $\\mathbf{r}_5 = \\frac{c}{2}\\hat{\\mathbf{z}}$ with $\\mathbf{m}_5 = -m\\hat{\\mathbf{z}}$:\nThe distance is $|\\mathbf{r}_5| = \\frac{c}{2}$. The scalar product is $\\mathbf{m}_5 \\cdot \\mathbf{r}_5 = (-m\\hat{\\mathbf{z}}) \\cdot (\\frac{c}{2}\\hat{\\mathbf{z}}) = -\\frac{mc}{2}$.\nThe field contribution is:\n$$\n\\mathbf{B}_5 = \\frac{\\mu_0}{4\\pi} \\left( \\frac{3(-\\frac{mc}{2})(\\frac{c}{2}\\hat{\\mathbf{z}})}{(\\frac{c}{2})^5} - \\frac{-m\\hat{\\mathbf{z}}}{(\\frac{c}{2})^3} \\right) = \\frac{\\mu_0}{4\\pi} \\left( \\frac{-3m(\\frac{c}{2})^2}{(\\frac{c}{2})^5}\\hat{\\mathbf{z}} + \\frac{m}{(\\frac{c}{2})^3}\\hat{\\mathbf{z}} \\right)\n$$\n$$\n\\mathbf{B}_5 = \\frac{\\mu_0}{4\\pi} \\frac{m}{(\\frac{c}{2})^3} (-3+1)\\hat{\\mathbf{z}} = -2 \\frac{\\mu_0}{4\\pi} \\frac{m}{(\\frac{c}{2})^3}\\hat{\\mathbf{z}} = - \\frac{\\mu_0}{4\\pi} \\frac{16m}{c^3}\\hat{\\mathbf{z}}\n$$\nFor the moment at $\\mathbf{r}_6 = -\\frac{c}{2}\\hat{\\mathbf{z}}$ with $\\mathbf{m}_6 = -m\\hat{\\mathbf{z}}$:\nThe distance is $|\\mathbf{r}_6| = \\frac{c}{2}$. The scalar product is $\\mathbf{m}_6 \\cdot \\mathbf{r}_6 = (-m\\hat{\\mathbf{z}}) \\cdot (-\\frac{c}{2}\\hat{\\mathbf{z}}) = \\frac{mc}{2}$.\nThe field contribution is:\n$$\n\\mathbf{B}_6 = \\frac{\\mu_0}{4\\pi} \\left( \\frac{3(\\frac{mc}{2})(-\\frac{c}{2}\\hat{\\mathbf{z}})}{(\\frac{c}{2})^5} - \\frac{-m\\hat{\\mathbf{z}}}{(\\frac{c}{2})^3} \\right) = \\frac{\\mu_0}{4\\pi} \\left( \\frac{-3m(\\frac{c}{2})^2}{(\\frac{c}{2})^5}\\hat{\\mathbf{z}} + \\frac{m}{(\\frac{c}{2})^3}\\hat{\\mathbf{z}} \\right)\n$$\nThis gives the same result: $\\mathbf{B}_6 = - \\frac{\\mu_0}{4\\pi} \\frac{16m}{c^3}\\hat{\\mathbf{z}}$.\nThe total field from these two identical contributions is:\n$$\n\\mathbf{B}_{group2} = \\mathbf{B}_5 + \\mathbf{B}_6 = 2 \\times \\left( - \\frac{\\mu_0}{4\\pi} \\frac{16m}{c^3}\\hat{\\mathbf{z}} \\right) = - \\frac{\\mu_0}{4\\pi} \\frac{32m}{c^3}\\hat{\\mathbf{z}}\n$$\n\n**Total Net Field**\nThe net dipolar field at the muon site is the sum of the contributions from both groups:\n$$\n\\mathbf{B}_{net} = \\mathbf{B}_{group1} + \\mathbf{B}_{group2} = - \\frac{\\mu_0}{4\\pi} \\frac{32m}{a^3}\\hat{\\mathbf{z}} - \\frac{\\mu_0}{4\\pi} \\frac{32m}{c^3}\\hat{\\mathbf{z}}\n$$\n$$\n\\mathbf{B}_{net} = - \\frac{\\mu_0}{4\\pi} 32m \\left( \\frac{1}{a^3} + \\frac{1}{c^3} \\right) \\hat{\\mathbf{z}}\n$$\nThe field is directed along the negative $z$-axis. Since the initial muon polarization is along the $x$-axis, it is perpendicular to the local field and will precess. The magnitude of the field is:\n$$\nB_{net} = |\\mathbf{B}_{net}| = \\frac{\\mu_0}{4\\pi} 32m \\left( \\frac{1}{a^3} + \\frac{1}{c^3} \\right)\n$$\n\n**Muon Precession Frequency**\nThe Larmor precession frequency $f_{\\mu}$ of a muon spin in a magnetic field of magnitude $B_{net}$ is given by:\n$$\nf_{\\mu} = \\left(\\frac{\\gamma_{\\mu}}{2\\pi}\\right) B_{net}\n$$\nwhere $\\gamma_{\\mu}$ is the muon gyromagnetic ratio. Substituting the expression for $B_{net}$:\n$$\nf_{\\mu} = \\left(\\frac{\\gamma_{\\mu}}{2\\pi}\\right) \\frac{\\mu_0}{4\\pi} 32m \\left( \\frac{1}{a^3} + \\frac{1}{c^3} \\right)\n$$\n\n**Numerical Calculation**\nWe substitute the given values:\n- $\\frac{\\mu_0}{4\\pi} = 1.0 \\times 10^{-7}\\ \\mathrm{T\\,m/A}$\n- $m = 2.0\\,\\mu_B = 2.0 \\times 9.274 \\times 10^{-24}\\ \\mathrm{A\\,m^2} = 1.8548 \\times 10^{-23}\\ \\mathrm{A\\,m^2}$\n- $a = 5.00\\ \\mathrm{\\AA} = 5.00 \\times 10^{-10}\\ \\mathrm{m}$, so $a^3 = 1.25 \\times 10^{-28}\\ \\mathrm{m^3}$\n- $c = 8.00\\ \\mathrm{\\AA} = 8.00 \\times 10^{-10}\\ \\mathrm{m}$, so $c^3 = 5.12 \\times 10^{-28}\\ \\mathrm{m^3}$\n- $\\frac{\\gamma_{\\mu}}{2\\pi} = 135.538\\ \\mathrm{MHz/T} = 1.35538 \\times 10^8\\ \\mathrm{Hz/T}$\n\nFirst, calculate the magnitude of the field, $B_{net}$:\n$$\nB_{net} = (1.0 \\times 10^{-7}) \\times 32 \\times (1.8548 \\times 10^{-23}) \\left( \\frac{1}{1.25 \\times 10^{-28}} + \\frac{1}{5.12 \\times 10^{-28}} \\right)\n$$\n$$\nB_{net} = (5.93536 \\times 10^{-29}) \\left( 8.0 \\times 10^{27} + 1.953125 \\times 10^{27} \\right)\n$$\n$$\nB_{net} = (5.93536 \\times 10^{-29}) \\left( 9.953125 \\times 10^{27} \\right) \\approx 0.590791\\ \\mathrm{T}\n$$\nNow, calculate the frequency $f_{\\mu}$:\n$$\nf_{\\mu} = (135.538\\ \\mathrm{MHz/T}) \\times (0.590791\\ \\mathrm{T}) \\approx 80.0710\\ \\mathrm{MHz}\n$$\nRounding the final answer to $4$ significant figures, we get $80.07\\ \\mathrm{MHz}$.", "answer": "$$\n\\boxed{80.07}\n$$", "id": "3006863"}, {"introduction": "While the previous exercise involved calculating a signal from a known structure, experimentalists often face the inverse problem: deducing unknown properties of a material from an observed signal. In µSR, it is common to observe several distinct precession frequencies, corresponding to crystallographically inequivalent muon stopping sites. This exercise simulates this realistic scenario, challenging you to work backward from a set of measured frequencies to identify the corresponding muon sites and determine a single, consistent value for the ordered magnetic moment, $m$ [@problem_id:3006859]. This practice hones critical data interpretation and modeling skills, demonstrating how µSR can be used to solve microscopic magnetic structures.", "problem": "In a zero-field Muon Spin Rotation spectroscopy (μSR) experiment on a collinear antiferromagnet, three oscillatory components are observed in the asymmetry signal with frequencies $f_{1} = 3.46~\\text{MHz}$, $f_{2} = 5.06~\\text{MHz}$, and $f_{3} = 10.90~\\text{MHz}$ at low temperature. The material has a single magnetic species forming two sublattices with ordered moments collinear along the crystallographic $z$-axis. The muon is known to bind near oxygen ions, and there are three inequivalent oxygen environments that produce distinct candidate muon stopping sites relative to the nearest magnetic ion, each characterized by a dominant nearest-neighbor magnetic dipole contribution to the local field. The three candidate sites are:\n\n- Site $\\mathcal{A}$: Displaced along the $z$-axis from a single nearest magnetic ion by a distance $d_{\\mathcal{A}} = 2.40~\\text{\\AA}$ (axial geometry).\n- Site $\\mathcal{B}$: Displaced within the plane perpendicular to the $z$-axis from a single nearest magnetic ion by a distance $d_{\\mathcal{B}} = 2.80~\\text{\\AA}$ (equatorial geometry).\n- Site $\\mathcal{C}$: Displaced along the $z$-axis from a single nearest magnetic ion by a distance $d_{\\mathcal{C}} = 3.10~\\text{\\AA}$ (axial geometry).\n\nAssume static long-range magnetic order and that the local field at each muon site is dominated by the magnetic dipolar field of the single nearest magnetic ion with ordered moment magnitude $m$ (in the direction $\\pm \\hat{\\mathbf{z}}$), with all more distant dipolar and contact hyperfine contributions negligible. The initial muon spin polarization is perpendicular to the local field at each site so that the observed oscillation frequencies directly reflect the local Larmor precession.\n\nConstants: the vacuum magnetic constant factor is $\\mu_{0}/(4\\pi) = 1.000 \\times 10^{-7}~\\text{T}\\,\\text{m}/\\text{A}$; the Bohr magneton is $\\mu_{B} = 9.274\\,010\\,0783 \\times 10^{-24}~\\text{A}\\,\\text{m}^{2}$; the positive muon gyromagnetic ratio is $\\gamma_{\\mu}/(2\\pi) = 135.538~\\text{MHz}/\\text{T}$. You may treat $1~\\text{\\AA} = 1.0 \\times 10^{-10}~\\text{m}$.\n\nUsing only fundamental magnetostatics and the Larmor precession relation, first infer which of the observed frequencies $f_{1}$, $f_{2}$, $f_{3}$ correspond to Sites $\\mathcal{A}$, $\\mathcal{B}$, and $\\mathcal{C}$. Then, under the single-dipole dominance assumption above, estimate the ordered moment magnitude $m$ per magnetic ion that is consistent with all three frequencies.\n\nExpress your final numerical answer for $m$ in units of the Bohr magneton per magnetic ion, and round your answer to four significant figures.", "solution": "The problem requires relating measured muon precession frequencies to candidate muon sites and then determining the magnitude of the magnetic moment, $m$.\n\n**1. Field Calculation for Candidate Sites**\nThe local magnetic field, $B$, at a distance $d$ from a magnetic dipole moment $m$ depends on the geometry. For a moment $\\mathbf{m}$ along $\\hat{\\mathbf{z}}$, the field magnitude is:\n-   **Axial geometry** (Sites $\\mathcal{A}$ and $\\mathcal{C}$): The muon is displaced along the axis of the dipole. The field is given by $B = \\frac{\\mu_0}{4\\pi} \\frac{2m}{d^3}$.\n-   **Equatorial geometry** (Site $\\mathcal{B}$): The muon is displaced in the plane perpendicular to the dipole axis. The field is given by $B = \\frac{\\mu_0}{4\\pi} \\frac{m}{d^3}$.\n\n**2. Matching Frequencies to Sites**\nThe muon precession frequency is directly proportional to the local field magnitude: $f = (\\gamma_\\mu / 2\\pi) B$. Thus, $f \\propto B/m$. We can calculate the structural factor $B/m$ for each site to determine the expected ordering of frequencies.\n-   $B_{\\mathcal{A}}/m = \\frac{\\mu_0}{4\\pi} \\frac{2}{d_{\\mathcal{A}}^3} = \\frac{\\mu_0}{4\\pi} \\frac{2}{(2.40\\,\\text{\\AA})^3} \\propto 0.1447$\n-   $B_{\\mathcal{B}}/m = \\frac{\\mu_0}{4\\pi} \\frac{1}{d_{\\mathcal{B}}^3} = \\frac{\\mu_0}{4\\pi} \\frac{1}{(2.80\\,\\text{\\AA})^3} \\propto 0.04555$\n-   $B_{\\mathcal{C}}/m = \\frac{\\mu_0}{4\\pi} \\frac{2}{d_{\\mathcal{C}}^3} = \\frac{\\mu_0}{4\\pi} \\frac{2}{(3.10\\,\\text{\\AA})^3} \\propto 0.06713$\n\nThe expected frequency ordering is $f_{\\mathcal{A}} > f_{\\mathcal{C}} > f_{\\mathcal{B}}$. The observed frequencies are $f_3 = 10.90~\\text{MHz}$, $f_2 = 5.06~\\text{MHz}$, and $f_1 = 3.46~\\text{MHz}$. By matching the order, we deduce the correspondence:\n-   Site $\\mathcal{A} \\leftrightarrow f_3 = 10.90~\\text{MHz}$\n-   Site $\\mathcal{C} \\leftrightarrow f_2 = 5.06~\\text{MHz}$\n-   Site $\\mathcal{B} \\leftrightarrow f_1 = 3.46~\\text{MHz}$\n\nThis assignment is consistent, as the ratio $f_3/f_2 \\approx 2.154$ closely matches the theoretical ratio $(d_{\\mathcal{C}}/d_{\\mathcal{A}})^3 \\approx (3.10/2.40)^3 \\approx 2.155$.\n\n**3. Estimating the Magnetic Moment**\nWe need to find a single value of $m$ that is consistent with all three frequency-site pairings. Each pairing gives an equation of the form $f_i = G_i \\cdot m$, where $G_i$ is a constant incorporating the gyromagnetic ratio and the site geometry.\n-   $f_3 = (\\gamma_\\mu/2\\pi) \\frac{\\mu_0}{4\\pi} \\frac{2m}{d_{\\mathcal{A}}^3}$\n-   $f_2 = (\\gamma_\\mu/2\\pi) \\frac{\\mu_0}{4\\pi} \\frac{2m}{d_{\\mathcal{C}}^3}$\n-   $f_1 = (\\gamma_\\mu/2\\pi) \\frac{\\mu_0}{4\\pi} \\frac{m}{d_{\\mathcal{B}}^3}$\n\nA robust method to determine a single $m$ from this overdetermined system is a linear least-squares fit, which minimizes the sum of squared differences between the observed frequencies and the model predictions. The model is linear in $m$. The best-fit value of $m$ is given by $m = (\\sum f_i G_i) / (\\sum G_i^2)$.\n\nLet's calculate the terms:\nThe constant factor is $C = (\\gamma_\\mu/2\\pi)(\\mu_0/4\\pi) = (135.538 \\times 10^6~\\text{Hz/T}) \\times (1.0 \\times 10^{-7}~\\text{T m/A}) = 13.5538~\\text{Hz m/A}$.\n-   $G_{\\mathcal{A}} = 2C/d_{\\mathcal{A}}^3 = 2(13.5538)/(2.40\\times10^{-10})^3 \\approx 1.9608 \\times 10^{30}~\\text{Hz m}^{-2}\\text{A}^{-1}$\n-   $G_{\\mathcal{C}} = 2C/d_{\\mathcal{C}}^3 = 2(13.5538)/(3.10\\times10^{-10})^3 \\approx 0.90995 \\times 10^{30}~\\text{Hz m}^{-2}\\text{A}^{-1}$\n-   $G_{\\mathcal{B}} = C/d_{\\mathcal{B}}^3 = (13.5538)/(2.80\\times10^{-10})^3 \\approx 0.61744 \\times 10^{30}~\\text{Hz m}^{-2}\\text{A}^{-1}$\n\nUsing these values and the corresponding frequencies ($f_3, f_2, f_1$), the least-squares fit yields:\n$m_{\\text{fit}} = 5.5624 \\times 10^{-24}~\\text{A}\\cdot\\text{m}^2$.\n\n**4. Final Conversion and Rounding**\nThe result must be expressed in units of the Bohr magneton, $\\mu_B$.\n$$\nm \\text{ (in } \\mu_B) = \\frac{m_{\\text{fit}}}{\\mu_B} = \\frac{5.5624 \\times 10^{-24}~\\text{A}\\cdot\\text{m}^2}{9.27401 \\times 10^{-24}~\\text{A}\\cdot\\text{m}^2} \\approx 0.60000\n$$\nRounding to four significant figures gives $0.6000~\\mu_B$.", "answer": "$$\n\\boxed{0.6000}\n$$", "id": "3006859"}, {"introduction": "One of the most powerful applications of µSR is the study of continuous phase transitions, where the local magnetic field, $B_{\\mathrm{loc}}$, serves as a direct measure of the magnetic order parameter. According to the theory of critical phenomena, the order parameter vanishes at the critical temperature, $T_C$, following a universal power law characterized by a critical exponent, $\\beta$. This final practice moves from analyzing single data points to fitting a complete temperature-dependent dataset, a common task in experimental physics [@problem_id:3006870]. By fitting the model $B_{\\mathrm{loc}}(T) \\propto (1-T/T_C)^{\\beta}$ to synthetic µSR data, you will learn how to extract fundamental physical constants and test the predictions of scaling theory.", "problem": "A researcher uses Muon Spin Rotation (µSR) spectroscopy to probe the evolution of local magnetic fields in ordered condensed matter systems near a continuous phase transition. The muon spin precession frequency is proportional to the local magnetic field $B_{\\mathrm{loc}}(T)$ at the muon stopping site, and $B_{\\mathrm{loc}}(T)$ is proportional to the thermodynamic order parameter of the magnetic phase. Near a continuous phase transition at critical temperature $T_c$ (or Néel temperature $T_N$), scaling theory asserts that the order parameter behaves as a power law in the reduced temperature, characterized by a critical exponent. From first principles, use the scaling hypothesis of continuous phase transitions together with the proportionality of $B_{\\mathrm{loc}}(T)$ to the order parameter to derive the functional dependence of $B_{\\mathrm{loc}}(T)$ for $T < T_c$ in terms of an amplitude, the critical temperature, and a critical exponent. Then, implement a parameter estimation procedure to fit this functional dependence to data and extract the critical exponent.\n\nYou are given three synthetic datasets representing measurements of $B_{\\mathrm{loc}}(T)$ in Tesla (T) as a function of temperature $T$ in Kelvin (K), obtained below the critical temperature. Each dataset is self-consistent and includes small deterministic deviations to mimic experimental scatter. Your task is to fit the appropriate power-law model for $T < T_c$ and return the estimated critical exponent for each dataset. The exponent must be reported as a unitless decimal rounded to three decimal places.\n\nUse temperatures $T$ in Kelvin and local fields $B_{\\mathrm{loc}}$ in Tesla as provided:\n\n- Dataset A (representative ferromagnet near $T_c$): temperatures $[10,30,60,90,120,135,145]$ K, measured local fields $[0.2449,0.2292,0.2089,0.1793,0.1405,0.1089,0.0737]$ T.\n- Dataset B (representative antiferromagnet near $T_N$): temperatures $[20,60,100,150,180,195]$ K, measured local fields $[0.2118,0.1961,0.1751,0.1389,0.10316,0.06504]$ T.\n- Dataset C (edge case with very near-critical data, including the critical point): temperatures $[85,92,96,99,100]$ K, measured local fields $[0.0387298,0.0282843,0.02,0.01,0.0]$ T.\n\nDesign a robust fitting algorithm with the following constraints and goals:\n- Only consider $T \\leq T_c$ contributions to the order parameter; ensure the model does not produce nonphysical values for $T > T_c$.\n- Estimate an amplitude factor, the critical temperature $T_c$, and the critical exponent from the data by minimizing a suitable objective function.\n- Use physically sensible parameter bounds that enforce a positive amplitude and a positive critical temperature not smaller than the maximum temperature in a given dataset.\n\nDefine the test suite as the ordered list of the three datasets above. For each dataset, return the estimated critical exponent as a float rounded to three decimal places. There are no angles involved. Express the final answers as unitless decimals, not with a percentage sign.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[0.333,0.350,0.500]$), corresponding to Dataset A, Dataset B, and Dataset C, respectively.", "solution": "The problem requires fitting a theoretical model for the temperature dependence of a magnetic order parameter to experimental data.\n\n**1. Derivation of the Physical Model**\nThe theory of continuous phase transitions states that near a critical temperature $T_c$, the spontaneous order parameter (e.g., magnetization $M$) scales with the reduced temperature $t = (T-T_c)/T_c$. For temperatures below the transition ($T < T_c$), this relationship is a power law:\n$$\nM(T) \\propto (-t)^{\\beta} = \\left(\\frac{T_c - T}{T_c}\\right)^{\\beta} = \\left(1 - \\frac{T}{T_c}\\right)^{\\beta}\n$$\nHere, $\\beta$ is the critical exponent for the order parameter. In a µSR experiment on a magnetic material, the local magnetic field at the muon site, $B_{\\mathrm{loc}}$, is directly proportional to the order parameter, $M(T)$. We can therefore write a model for the measured field by introducing an amplitude $B_0$, which represents the field at $T=0$:\n$$\nB_{\\mathrm{loc}}(T) = B_0 \\left(1 - \\frac{T}{T_c}\\right)^{\\beta} \\quad \\text{for } T \\leq T_c\n$$\nFor $T > T_c$, the spontaneous order is zero, so $B_{\\mathrm{loc}}(T) = 0$.\n\n**2. Parameter Estimation Procedure**\nThe goal is to determine the three unknown parameters of this model—the amplitude $B_0$, the critical temperature $T_c$, and the critical exponent $\\beta$—by fitting it to the provided datasets. This is a non-linear regression problem. The standard method is non-linear least squares, which finds the set of parameters $(B_0, T_c, \\beta)$ that minimizes the sum of squared residuals (SSR) between the model's predictions and the measured data points $(T_i, B_{\\mathrm{meas}, i})$:\n$$\n\\text{SSR}(B_0, T_c, \\beta) = \\sum_{i} \\left[ B_{\\mathrm{meas}, i} - B_{\\mathrm{loc}}(T_i; B_0, T_c, \\beta) \\right]^2\n$$\nThis minimization is performed numerically, typically using an algorithm like the Levenberg-Marquardt algorithm, as implemented in scientific computing libraries.\n\n**3. Implementation Details and Constraints**\nTo ensure a physically meaningful fit, the following constraints (bounds) are applied during the optimization:\n-   $B_0 > 0$: The amplitude must be positive.\n-   $T_c \\geq \\max(T_i)$: The critical temperature must be at or above the highest temperature at which a non-zero field was measured.\n-   $\\beta > 0$: The critical exponent must be positive.\n\nThe Python code in the answer block implements this procedure using the `scipy.optimize.curve_fit` function. It defines the power-law model, iterates through each dataset, applies the appropriate bounds and initial guesses for the parameters, and performs the fit to extract the value of $\\beta$. The final results are rounded and formatted as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Derives and fits a power-law model for the local magnetic field B_loc(T)\n    near a continuous phase transition to extract the critical exponent for\n    three given datasets.\n    \"\"\"\n\n    # Define the theoretical model for the local magnetic field B_loc as a\n    # function of temperature T for T <= Tc.\n    # The model is B_loc(T) = B0 * (1 - T/Tc)^beta.\n    def power_law_model(T, B0, Tc, beta):\n        \"\"\"\n        Power-law model for the order parameter near a critical temperature.\n        \n        Args:\n            T (np.ndarray): Temperature values.\n            B0 (float): Amplitude, corresponding to B_loc at T=0.\n            Tc (float): Critical temperature.\n            beta (float): Critical exponent.\n        \n        Returns:\n            np.ndarray: Calculated local magnetic field values.\n        \"\"\"\n        # (1 - T/Tc) can be negative if the optimizer tries T > Tc.\n        # np.maximum ensures the base of the power is non-negative, preventing nans.\n        # The bounds on Tc should prevent T > Tc for the final fitted parameters.\n        reduced_temp_term = np.maximum(0, 1 - T / Tc)\n        return B0 * (reduced_temp_term ** beta)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (temperature_array, local_field_array).\n    test_cases = [\n        # Dataset A (representative ferromagnet)\n        (np.array([10, 30, 60, 90, 120, 135, 145]), \n         np.array([0.2449, 0.2292, 0.2089, 0.1793, 0.1405, 0.1089, 0.0737])),\n        \n        # Dataset B (representative antiferromagnet)\n        (np.array([20, 60, 100, 150, 180, 195]), \n         np.array([0.2118, 0.1961, 0.1751, 0.1389, 0.10316, 0.06504])),\n        \n        # Dataset C (edge case near-critical, including Tc)\n        (np.array([85, 92, 96, 99, 100]), \n         np.array([0.0387298, 0.0282843, 0.02, 0.01, 0.0]))\n    ]\n\n    results = []\n    \n    for T_data, B_data in test_cases:\n        # Determine the physical lower bound for the critical temperature Tc.\n        # Tc must be >= the maximum temperature measured in the ordered phase.\n        Tc_min = np.max(T_data)\n\n        # Set bounds for the fitting parameters [B0, Tc, beta].\n        # B0 > 0.\n        # Tc >= Tc_min.\n        # Beta is physically expected to be positive. A range like [0.01, 2.0]\n        # is generous and covers all standard university classes, improving stability.\n        bounds = ([0, Tc_min, 0.01], [np.inf, np.inf, 2.0])\n\n        # Provide initial guesses [B0_guess, Tc_guess, beta_guess] for the optimizer.\n        # - B0 can be approximated from the first data point (lowest T).\n        # - Tc is guessed to be slightly above the maximum measured temperature.\n        # - beta is guessed to be a typical value from theory (e.g., 3D Heisenberg ~0.37).\n        p0 = [B_data[0], Tc_min + 5.0, 0.4]\n\n        # Perform the non-linear least squares fit.\n        # maxfev is increased to ensure convergence for challenging fits.\n        popt, pcov = curve_fit(power_law_model, T_data, B_data, p0=p0, bounds=bounds, maxfev=5000)\n        \n        # Extract the fitted critical exponent beta.\n        beta_fit = popt[2]\n        \n        # Round the result to three decimal places and append to the results list.\n        results.append(round(beta_fit, 3))\n\n    # Format the output as a comma-separated list in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3006870"}]}