{"hands_on_practices": [{"introduction": "Understanding magnetic resonance begins at the quantum level. This exercise walks you through the foundational calculation of how a nuclear spin's energy levels are split by a magnetic field, a phenomenon known as the Zeeman effect. By deriving the energy eigenvalues for a spin-$I = 3/2$ system and applying the magnetic dipole selection rules, you will determine the resonance frequency, which is the cornerstone of all NMR and ESR experiments [@problem_id:3003350].", "problem": "A nucleus with spin quantum number $I = \\frac{3}{2}$ is placed in a static, spatially uniform magnetic field $\\mathbf{B}_0$ aligned along the $z$-axis. Consider the Zeeman interaction Hamiltonian $H_Z$ for the nuclear magnetic moment interacting with the field. Starting from the definition of the nuclear magnetic moment operator $\\boldsymbol{\\mu}$, the basic form of the magnetic interaction energy, and the angular momentum eigenvalue properties of $I_z$, derive the energy eigenvalues $E_m$ for the magnetic quantum numbers $m \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$, and compute the magnitude of the splitting between successive $m$-levels. Using the nuclear magnetic resonance selection rule $\\Delta m = \\pm 1$, enumerate the allowed transitions and determine their angular frequencies.\n\nExpress the magnitude of the energy splitting in Joules and the transition angular frequencies in radians per second. Provide your final answer as a single row matrix whose first entry is the magnitude of the adjacent-level energy splitting and whose remaining entries are the angular frequencies of the allowed transitions, in increasing $m$ order. No numerical rounding is required; express your result symbolically in terms of the nuclear gyromagnetic ratio $\\gamma$, the reduced Planck constant $\\hbar$, and the magnetic field magnitude $B_0$.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the quantum mechanics of magnetic resonance. All necessary information is provided, and the premises are consistent with established physical principles.\n\nThe solution proceeds as follows.\n\nThe nuclear magnetic moment operator $\\boldsymbol{\\mu}$ is proportional to the nuclear spin angular momentum operator $\\mathbf{I}$, with the constant of proportionality being the nuclear gyromagnetic ratio $\\gamma$.\n$$\n\\boldsymbol{\\mu} = \\gamma \\mathbf{I}\n$$\nThe Zeeman Hamiltonian $H_Z$ describes the interaction energy of this magnetic moment with an external static magnetic field $\\mathbf{B}_0$. It is given by the negative of the scalar product of the magnetic moment and the magnetic field.\n$$\nH_Z = - \\boldsymbol{\\mu} \\cdot \\mathbf{B}_0\n$$\nSubstituting the expression for $\\boldsymbol{\\mu}$, we obtain:\n$$\nH_Z = - (\\gamma \\mathbf{I}) \\cdot \\mathbf{B}_0 = -\\gamma (\\mathbf{I} \\cdot \\mathbf{B}_0)\n$$\nThe problem specifies that the magnetic field $\\mathbf{B}_0$ is uniform and aligned with the $z$-axis. We can write it as $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$, where $B_0$ is the magnitude of the field. The spin angular momentum operator is $\\mathbf{I} = I_x \\hat{\\mathbf{x}} + I_y \\hat{\\mathbf{y}} + I_z \\hat{\\mathbf{z}}$. The scalar product is thus:\n$$\n\\mathbf{I} \\cdot \\mathbf{B}_0 = (I_x \\hat{\\mathbf{x}} + I_y \\hat{\\mathbf{y}} + I_z \\hat{\\mathbf{z}}) \\cdot (B_0 \\hat{\\mathbf{z}}) = I_z B_0\n$$\nThe Hamiltonian simplifies to:\n$$\nH_Z = -\\gamma B_0 I_z\n$$\nThe energy eigenvalues $E_m$ of this system are the eigenvalues of the Hamiltonian operator $H_Z$. The eigenstates of the system are the simultaneous eigenstates of the operators $I^2$ and $I_z$, denoted as $|I, m\\rangle$. The action of the $I_z$ operator on these states is given by the eigenvalue equation:\n$$\nI_z |I, m\\rangle = m \\hbar |I, m\\rangle\n$$\nwhere $m$ is the magnetic quantum number, and $\\hbar$ is the reduced Planck constant. For a given spin quantum number $I$, $m$ can take on the $2I+1$ values from $-I$ to $+I$ in integer steps.\n\nApplying the Hamiltonian $H_Z$ to an eigenstate $|I, m\\rangle$:\n$$\nH_Z |I, m\\rangle = (-\\gamma B_0 I_z) |I, m\\rangle = -\\gamma B_0 (I_z |I, m\\rangle) = -\\gamma B_0 (m \\hbar) |I, m\\rangle\n$$\nThis is an eigenvalue equation for $H_Z$ with eigenvalues $E_m$:\n$$\nE_m = -m \\gamma \\hbar B_0\n$$\nThe problem states that the nucleus has a spin quantum number $I = \\frac{3}{2}$. Therefore, the possible values for $m$ are $m \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$. This gives four distinct energy levels.\n\nNext, we compute the magnitude of the energy splitting between successive $m$-levels. Let's consider two adjacent levels corresponding to quantum numbers $m$ and $m+1$. The energy difference is:\n$$\n\\Delta E = E_{m+1} - E_m = (-(m+1)\\gamma\\hbar B_0) - (-m\\gamma\\hbar B_0) = -m\\gamma\\hbar B_0 - \\gamma\\hbar B_0 + m\\gamma\\hbar B_0 = -\\gamma\\hbar B_0\n$$\nThis result shows that the energy levels are equally spaced. The splitting between any two adjacent levels is constant. The problem asks for the magnitude of this splitting. Since the gyromagnetic ratio $\\gamma$ can be either positive or negative for different nuclei, and an energy splitting magnitude must be a non-negative quantity, we must take the absolute value:\n$$\n|\\Delta E| = |-\\gamma\\hbar B_0| = |\\gamma|\\hbar B_0\n$$\nThis gives the energy splitting in units of Joules.\n\nFinally, we determine the angular frequencies of the allowed transitions. The selection rule for magnetic dipole transitions in NMR is $\\Delta m = \\pm 1$. This means transitions are only allowed between adjacent energy levels. The energy of a photon, $E_{\\text{photon}}$, absorbed or emitted during such a transition must equal the magnitude of the energy difference between the initial and final states:\n$$\nE_{\\text{photon}} = |E_{\\text{final}} - E_{\\text{initial}}| = |\\Delta E| = |\\gamma|\\hbar B_0\n$$\nThe energy of a photon is related to its angular frequency $\\omega$ by $E_{\\text{photon}} = \\hbar \\omega$. Equating the two expressions for the photon energy:\n$$\n\\hbar \\omega = |\\gamma|\\hbar B_0\n$$\nSolving for the angular frequency $\\omega$ (in radians per second) gives:\n$$\n\\omega = |\\gamma|B_0\n$$\nThis frequency is known as the Larmor frequency. Since the energy splitting is the same between all adjacent levels, all allowed transitions occur at this single frequency.\n\nThe problem asks to enumerate the allowed transitions. For $I=3/2$, there are three possible transitions satisfying $\\Delta m = \\pm 1$:\n\\begin{enumerate}\n    \\item Transition between $m = -\\frac{3}{2}$ and $m = -\\frac{1}{2}$.\n    \\item Transition between $m = -\\frac{1}{2}$ and $m = \\frac{1}{2}$.\n    \\item Transition between $m = \\frac{1}{2}$ and $m = \\frac{3}{2}$.\n\\end{enumerate}\nThe angular frequency for each of these transitions is the same, $\\omega = |\\gamma|B_0$.\n\nThe final answer is to be provided as a single row matrix. The first entry is the magnitude of the energy splitting, $|\\gamma|\\hbar B_0$. The subsequent entries are the angular frequencies of the allowed transitions, ordered by increasing $m$ (of the lower state in the transition pair). Thus, we list the frequency for each of the three transitions, even though they are identical.\n\nThe matrix entries are:\n\\begin{itemize}\n    \\item Energy splitting: $|\\gamma|\\hbar B_0$\n    \\item Frequency for transition $1$ ($m = -3/2 \\leftrightarrow -1/2$): $|\\gamma|B_0$\n    \\item Frequency for transition $2$ ($m = -1/2 \\leftrightarrow 1/2$): $|\\gamma|B_0$\n    \\item Frequency for transition $3$ ($m = 1/2 \\leftrightarrow 3/2$): $|\\gamma|B_0$\n\\end{itemize}", "answer": "$$\n\\boxed{\\begin{pmatrix} |\\gamma|\\hbar B_0 & |\\gamma|B_0 & |\\gamma|B_0 & |\\gamma|B_0 \\end{pmatrix}}\n$$", "id": "3003350"}, {"introduction": "While the Zeeman interaction sets the resonance frequency, relaxation times govern the dynamics and provide rich information about the local environment of the spins. This practice focuses on the spin-lattice relaxation time, $T_1$, by solving the phenomenological Bloch equation for the recovery of longitudinal magnetization. You will apply this solution to the widely used inversion-recovery experiment, learning how to extract this crucial physical parameter from experimental data [@problem_id:3003371].", "problem": "A homogeneous ensemble of spin-$\\tfrac{1}{2}$ nuclei is studied using Nuclear Magnetic Resonance (NMR). Assume the longitudinal relaxation is single-exponential with spin-lattice relaxation time $T_1$, and transverse processes do not affect the longitudinal component during recovery delays. The system is in the high-temperature, strong-field limit so that the equilibrium longitudinal magnetization $M_0$ is constant in time at fixed temperature and static field. Start from the longitudinal Bloch equation\n$$\n\\frac{d M_z}{d t} \\;=\\; -\\,\\frac{M_z - M_0}{T_1}\\,,\n$$\nand treat the radiofrequency pulses as instantaneous rotations that set the initial condition of $M_z$ at the start of each recovery period.\n\n(a) Immediately after a saturation pulse that equalizes the spin populations, the longitudinal magnetization is $M_z(0)=0$. Derive the explicit time dependence $M_z(t)$ for $t>0$.\n\n(b) In an inversion-recovery experiment with a perfect $180^{\\circ}$ inversion pulse followed by a variable delay $\\tau$ and a perfect $90^{\\circ}$ read-out pulse, the detected signal is proportional to the longitudinal magnetization $M_z(\\tau)$ immediately before the $90^{\\circ}$ pulse. Using the same Bloch-equation framework and assuming ideal pulses, derive $M_z(\\tau)$ for $t=\\tau$.\n\nA measurement on this sample finds that the inversion-recovery signal changes sign at a delay $\\tau_0 = 72.00\\ \\mathrm{ms}$, meaning $M_z(\\tau_0)=0$. Using the single-exponential model and your derivation, compute $T_1$ from this zero-crossing delay. Round your numerical value of $T_1$ to four significant figures. Express the relaxation time in $\\mathrm{s}$.\n\nProvide your final answer as the ordered pair consisting of the analytic expression from part (a) and the numerical value of $T_1$ extracted in part (b).", "solution": "The problem requires the analysis of longitudinal magnetization relaxation in a Nuclear Magnetic Resonance (NMR) experiment, governed by the first-order linear ordinary differential equation known as the longitudinal Bloch equation:\n$$\n\\frac{d M_z}{d t} = -\\frac{M_z - M_0}{T_1}\n$$\nHere, $M_z(t)$ is the longitudinal magnetization at time $t$, $M_0$ is the thermal equilibrium magnetization, and $T_1$ is the spin-lattice or longitudinal relaxation time. We must solve this equation for two different experimental scenarios.\n\nThe differential equation is separable and can be rewritten as:\n$$\n\\frac{d M_z}{M_z - M_0} = -\\frac{1}{T_1} dt\n$$\nWe can integrate this equation from an initial time $t=0$ with initial magnetization $M_z(0)$ to a later time $t$ with magnetization $M_z(t)$:\n$$\n\\int_{M_z(0)}^{M_z(t)} \\frac{dM'_z}{M'_z - M_0} = \\int_0^t -\\frac{1}{T_1} dt'\n$$\nPerforming the integration yields:\n$$\n\\left[ \\ln|M'_z - M_0| \\right]_{M_z(0)}^{M_z(t)} = -\\frac{t}{T_1}\n$$\n$$\n\\ln|M_z(t) - M_0| - \\ln|M_z(0) - M_0| = -\\frac{t}{T_1}\n$$\n$$\n\\ln\\left( \\frac{|M_z(t) - M_0|}{|M_z(0) - M_0|} \\right) = -\\frac{t}{T_1}\n$$\nFor physical relaxation processes where $M_z(t)$ approaches $M_0$ monotonically from an initial value $M_z(0)$, the quantity $(M_z - M_0)$ does not change sign during the relaxation. We can thus remove the absolute value signs. Exponentiating both sides gives:\n$$\n\\frac{M_z(t) - M_0}{M_z(0) - M_0} = \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\nRearranging to solve for $M_z(t)$, we obtain the general solution for the longitudinal magnetization recovery:\n$$\nM_z(t) = M_0 + \\left( M_z(0) - M_0 \\right) \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\nThis general expression will be used to solve both parts of the problem.\n\n(a) Derivation for a saturation-recovery experiment.\nIn a saturation-recovery experiment, an initial pulse (or a train of pulses) is applied to saturate the spin system. Saturation means the equalization of spin populations, which corresponds to zero net longitudinal magnetization. Therefore, the initial condition at time $t=0$ is $M_z(0) = 0$.\nSubstituting this initial condition into the general solution:\n$$\nM_z(t) = M_0 + \\left( 0 - M_0 \\right) \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n$$\nM_z(t) = M_0 - M_0 \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\nThis can be written in the standard form for saturation-recovery:\n$$\nM_z(t) = M_0 \\left(1 - \\exp\\left(-\\frac{t}{T_1}\\right)\\right)\n$$\nThis is the explicit time dependence of the longitudinal magnetization following a saturation pulse.\n\n(b) Calculation of $T_1$ from an inversion-recovery experiment.\nIn an inversion-recovery experiment, the experiment begins with the system at thermal equilibrium, $M_z = M_0$. A perfect $180^{\\circ}$ inversion pulse is applied at $t=0$. Such a pulse inverts the longitudinal magnetization, so the initial condition for the subsequent recovery period of duration $\\tau$ is $M_z(0) = -M_0$.\nWe use the general solution again, this time with $t=\\tau$ and the new initial condition $M_z(0) = -M_0$:\n$$\nM_z(\\tau) = M_0 + \\left( (-M_0) - M_0 \\right) \\exp\\left(-\\frac{\\tau}{T_1}\\right)\n$$\n$$\nM_z(\\tau) = M_0 - 2M_0 \\exp\\left(-\\frac{\\tau}{T_1}\\right)\n$$\nThis gives the dependence of the measured signal on the delay time $\\tau$:\n$$\nM_z(\\tau) = M_0 \\left(1 - 2\\exp\\left(-\\frac{\\tau}{T_1}\\right)\\right)\n$$\nThe problem states that the signal becomes zero at a specific delay $\\tau_0 = 72.00 \\, \\mathrm{ms}$. This is the null point or zero-crossing time of the inversion-recovery curve. At this time, $M_z(\\tau_0) = 0$.\n$$\n0 = M_0 \\left(1 - 2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right)\\right)\n$$\nSince the equilibrium magnetization $M_0$ is non-zero, we can divide by it:\n$$\n0 = 1 - 2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right)\n$$\nNow, we solve for $T_1$:\n$$\n2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right) = 1\n$$\n$$\n\\exp\\left(-\\frac{\\tau_0}{T_1}\\right) = \\frac{1}{2}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\frac{\\tau_0}{T_1} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\n\\frac{\\tau_0}{T_1} = \\ln(2)\n$$\nFinally, solving for $T_1$:\n$$\nT_1 = \\frac{\\tau_0}{\\ln(2)}\n$$\nWe are given $\\tau_0 = 72.00 \\, \\mathrm{ms}$. We must express $T_1$ in seconds, so $\\tau_0 = 72.00 \\times 10^{-3} \\, \\mathrm{s}$.\n$$\nT_1 = \\frac{72.00 \\times 10^{-3} \\, \\mathrm{s}}{\\ln(2)}\n$$\nUsing the value $\\ln(2) \\approx 0.69314718$:\n$$\nT_1 \\approx \\frac{72.00 \\times 10^{-3}}{0.69314718} \\, \\mathrm{s} \\approx 0.1038732 \\, \\mathrm{s}\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $1$, $0$, $3$, $8$, and the fifth digit is $7$, so we round up.\n$$\nT_1 \\approx 0.1039 \\, \\mathrm{s}\n$$\nThe final answer is an ordered pair consisting of the analytical expression from part (a) and the numerical value of $T_1$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nM_0 \\left(1 - \\exp\\left(-\\frac{t}{T_1}\\right)\\right) & 0.1039\n\\end{pmatrix}\n}\n$$", "id": "3003371"}, {"introduction": "Real-world samples are rarely perfect, and magnetic fields are never perfectly homogeneous. This computational practice challenges you to model the consequences of such non-idealities, exploring both static inhomogeneous broadening that gives rise to the Free Induction Decay (FID) and the effects of molecular diffusion in a field gradient. By implementing the physics of spin dephasing and the refocusing principle of the Hahn echo, you will gain a deeper, quantitative understanding of transverse relaxation and its connection to molecular dynamics [@problem_id:3003340].", "problem": "Consider an ensemble of noninteracting spins probed by Nuclear Magnetic Resonance (NMR) or Electron Spin Resonance (ESR) in a solid or liquid, placed in a static external magnetic field with a uniform main component $B_0$ and a superposed linear spatial gradient $G$ along the $x$-axis so that $B(x) = B_0 + G x$. The local Larmor angular frequency is $\\omega(x) = \\gamma B(x)$, where $\\gamma$ is the gyromagnetic ratio in $\\mathrm{rad \\, s^{-1} \\, T^{-1}}$. Assume the transverse magnetization follows precessional dynamics governed by the Bloch equation and that the ensemble-averaged free induction decay can be modeled by averaging over frequency offsets arising from the spatial distribution of $x$, while the Hahn echo envelope at time $2\\tau$ after a $\\pi/2$–$\\pi$ pulse sequence is influenced by both intrinsic transverse relaxation and stochastic motion in the field gradient.\n\nYou must derive from first principles and implement the following computational tasks for a one-dimensional sample:\n\n1) Static inhomogeneous broadening and free induction decay (FID): Assume the static distribution of spin positions along $x$ is Gaussian with mean $0$ and variance $\\sigma_x^2$, implying a corresponding Gaussian distribution of instantaneous Larmor frequencies. Using the definition of ensemble averaging and properties of Gaussian random variables, compute the normalized transverse magnetization envelope $M_{\\mathrm{FID}}(t)$ at time $t$ due solely to the static inhomogeneous broadening (i.e., neglect intrinsic transverse relaxation), and express it as a dimensionless float.\n\n2) Hahn echo decay in a constant gradient with diffusion: Model molecular motion along $x$ as one-dimensional Brownian motion with diffusion coefficient $D$ in $\\mathrm{m^2 \\, s^{-1}}$. Under a constant gradient $G$ in $\\mathrm{T \\, m^{-1}}$, the time-dependent Larmor frequency becomes a stochastic process $\\omega(t) = \\gamma G x(t)$. Using the definition of the accumulated phase under the toggling frame for a Hahn echo with a $\\pi$ pulse at time $\\tau$ and the Gaussian nature of $x(t)$, compute the normalized echo envelope $M_{\\mathrm{echo}}(2\\tau)$ at time $2\\tau$ including both intrinsic transverse relaxation characterized by $T_2$ (in $\\mathrm{s}$) and dephasing due to diffusion in the gradient. Express the result as a dimensionless float.\n\nYour program must, for each test case below, compute and return a pair $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$. Use the following scientifically plausible test suite with parameters specified in SI units:\n\n- Test case 1 (general happy path):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 1.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$.\n\n- Test case 2 (boundary: zero gradient):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 0.0$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$.\n\n- Test case 3 (edge: zero diffusion, static gradient only):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 1.0 \\times 10^{-2}$,\n  - $D = 0.0$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$.\n\n- Test case 4 (edge: very long $T_2$, diffusion-dominated echo):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 3.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.0 \\times 10^{3}$,\n  - $\\tau = 5.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-5}$.\n\n- Test case 5 (edge: small $\\tau$):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 2.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 5.0 \\times 10^{-1}$,\n  - $\\tau = 5.0 \\times 10^{-3}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 7.0 \\times 10^{-5}$.\n\nAll quantities must be treated in SI units as provided. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets of lists, where each inner list corresponds to one test case and contains $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$ in that order. For example, the output format must be like $[[a_1,b_1],[a_2,b_2],\\dots]$, with each $a_i$ and $b_i$ being floats.", "solution": "We begin from the precessional dynamics of a magnetic moment in a magnetic field given by the Bloch equation $\\frac{d\\mathbf{M}}{dt} = \\gamma \\mathbf{M} \\times \\mathbf{B}$, which implies a local Larmor angular frequency $\\omega(x) = \\gamma B(x)$ for spins at position $x$ along the gradient direction when $\\mathbf{B}(x) = B_0 \\hat{z} + G x \\hat{z}$. The ensemble transverse magnetization is obtained by averaging over the distribution of local frequencies and, for time-dependent situations, over stochastic realizations of motion.\n\nStatic inhomogeneous broadening and $M_{\\mathrm{FID}}(t)$: If the spatial distribution of positions $x$ is Gaussian with mean $0$ and variance $\\sigma_x^2$, then the induced distribution of local Larmor angular frequencies $\\omega$ is also Gaussian because $\\omega(x) = \\gamma (B_0 + G x)$ and the offset from the mean is proportional to $x$. Specifically, if $x \\sim \\mathcal{N}(0,\\sigma_x^2)$, then the offset frequency $\\Delta \\omega = \\gamma G x$ is Gaussian with mean $0$ and variance $\\sigma_\\omega^2 = (\\gamma G)^2 \\sigma_x^2$. The transverse magnetization envelope under free induction decay is the characteristic function of the Gaussian frequency distribution evaluated at time $t$, normalized to unity at $t=0$. Let $p(\\Delta \\omega)$ be the Gaussian probability density. Then\n$$\nM_{\\mathrm{FID}}(t) = \\left\\langle e^{i \\Delta \\omega \\, t} \\right\\rangle_{\\Delta \\omega} = \\int_{-\\infty}^{\\infty} e^{i \\Delta \\omega \\, t} \\, \\frac{1}{\\sqrt{2\\pi} \\sigma_\\omega} \\exp\\left(-\\frac{\\Delta \\omega^2}{2 \\sigma_\\omega^2}\\right) \\, d(\\Delta \\omega).\n$$\nThe integral is the characteristic function of a zero-mean Gaussian, which equals\n$$\nM_{\\mathrm{FID}}(t) = \\exp\\left( - \\frac{1}{2} \\sigma_\\omega^2 t^2 \\right) = \\exp\\left( - \\frac{1}{2} (\\gamma G)^2 \\sigma_x^2 \\, t^2 \\right).\n$$\nThis captures inhomogeneous dephasing due solely to static spatial broadening and neglects intrinsic transverse relaxation. The result is dimensionless.\n\nHahn echo decay in a constant gradient with diffusion: Consider a Hahn echo sequence with a $\\pi$ pulse applied at time $\\tau$ after an initial $\\pi/2$. In the presence of a constant gradient $G$, and one-dimensional Brownian motion $x(t)$ with diffusion coefficient $D$ satisfying $\\langle x(t)\\rangle = 0$ and covariance $\\langle x(t_1) x(t_2) \\rangle = 2 D \\min(t_1,t_2)$, the instantaneous angular frequency becomes a stochastic process $\\omega(t) = \\gamma G x(t)$. The accumulated phase in the toggling frame is\n$$\n\\phi = \\int_0^{2\\tau} \\omega(t) f(t) \\, dt = \\gamma G \\int_0^{2\\tau} x(t) f(t) \\, dt,\n$$\nwhere the toggling function $f(t)$ accounts for the sign inversion induced by the $\\pi$ pulse: $f(t) = +1$ for $0 \\le t < \\tau$ and $f(t) = -1$ for $\\tau \\le t \\le 2\\tau$. Since $x(t)$ is a zero-mean Gaussian process and $\\phi$ is a linear functional of $x(t)$, $\\phi$ is a zero-mean Gaussian random variable. The normalized echo amplitude from dephasing due to diffusion is the characteristic function $\\langle e^{i \\phi} \\rangle$, which for a Gaussian variable equals $\\exp\\left(- \\frac{1}{2} \\mathrm{Var}(\\phi)\\right)$. The variance is\n$$\n\\mathrm{Var}(\\phi) = (\\gamma G)^2 \\int_0^{2\\tau} \\int_0^{2\\tau} f(t_1) f(t_2) \\, \\langle x(t_1) x(t_2) \\rangle \\, dt_1 dt_2\n= 2 D (\\gamma G)^2 \\int_0^{2\\tau} \\int_0^{2\\tau} f(t_1) f(t_2) \\, \\min(t_1,t_2) \\, dt_1 dt_2.\n$$\nUsing the identity\n$$\n\\int_0^{T} \\int_0^{T} \\min(t_1,t_2) \\, a(t_1) a(t_2) \\, dt_1 dt_2 = \\int_0^{T} \\left( \\int_t^{T} a(u) \\, du \\right)^2 dt,\n$$\nwith $a(t) = f(t)$ and $T = 2\\tau$, we compute the inner integral $S(t) = \\int_t^{2\\tau} f(u) \\, du$. For $0 \\le t \\le \\tau$, $S(t) = \\int_t^{\\tau} 1 \\, du + \\int_{\\tau}^{2\\tau} (-1) \\, du = (\\tau - t) - \\tau = -t$. For $\\tau \\le t \\le 2\\tau$, $S(t) = \\int_t^{2\\tau} (-1) \\, du = -(2\\tau - t) = t - 2\\tau$. Therefore,\n$$\n\\mathrm{Var}(\\phi) = 2 D (\\gamma G)^2 \\left[ \\int_0^{\\tau} t^2 \\, dt + \\int_{\\tau}^{2\\tau} (t - 2\\tau)^2 \\, dt \\right] = 2 D (\\gamma G)^2 \\left( \\frac{\\tau^3}{3} + \\frac{\\tau^3}{3} \\right) = \\frac{4}{3} D (\\gamma G)^2 \\tau^3.\n$$\nThe diffusion-induced attenuation factor for the Hahn echo is then\n$$\nM_{\\mathrm{diff}}(2\\tau) = \\exp\\left( - \\frac{1}{2} \\mathrm{Var}(\\phi) \\right) = \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right).\n$$\nIntrinsic transverse relaxation with characteristic time $T_2$ contributes a multiplicative decay factor $\\exp(-2\\tau / T_2)$ to the echo envelope. The combined normalized echo envelope is therefore the product of these two independent factors:\n$$\nM_{\\mathrm{echo}}(2\\tau) = \\exp\\left( - \\frac{2 \\tau}{T_2} \\right) \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right).\n$$\nThis result has the expected limits: if $G = 0$ or $D = 0$, diffusion-induced dephasing vanishes and $M_{\\mathrm{echo}}(2\\tau) = \\exp(-2\\tau/T_2)$; for very small $\\tau$, the diffusion factor approaches $1$ since the exponent scales as $\\tau^3$.\n\nAlgorithmic design: For each test case, compute $\\sigma_\\omega = \\gamma G \\sigma_x$ from the given parameters, then evaluate\n$$\nM_{\\mathrm{FID}}(t) = \\exp\\left( - \\frac{1}{2} \\sigma_\\omega^2 \\, t^2 \\right),\n\\quad\nM_{\\mathrm{echo}}(2\\tau) = \\exp\\left( - \\frac{2 \\tau}{T_2} \\right) \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right),\n$$\nand return the pair $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$ as floats for that test case. All input parameters are in SI units and the outputs are dimensionless floats. The final program aggregates the results for all specified test cases into a single list of lists and prints it in the required single-line format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fid_amplitude(gamma, G, sigma_x, t):\n    \"\"\"\n    Compute M_FID(t) due to static Gaussian distribution of positions in a linear B0 gradient.\n    sigma_omega = gamma * G * sigma_x\n    M_FID = exp(-0.5 * (sigma_omega * t)^2)\n    \"\"\"\n    sigma_omega = gamma * G * sigma_x\n    return float(np.exp(-0.5 * (sigma_omega * t) ** 2))\n\ndef echo_amplitude(gamma, G, D, T2, tau):\n    \"\"\"\n    Compute M_echo(2*tau) including intrinsic T2 and diffusion in a constant gradient.\n    M_echo = exp(-2*tau / T2) * exp( - (2/3) * D * (gamma*G)^2 * tau^3 )\n    \"\"\"\n    # Handle extremely large T2 robustly (although not strictly necessary with given values)\n    t2_factor = np.exp(-2.0 * tau / T2) if T2 > 0 else 0.0\n    diff_factor = np.exp(-(2.0 / 3.0) * D * (gamma * G) ** 2 * tau ** 3)\n    return float(t2_factor * diff_factor)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: gamma, G, D, T2, tau, sigma_x, t\n    test_cases = [\n        (2.675e8, 1.0e-2, 2.0e-9, 1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 1\n        (2.675e8, 0.0,    2.0e-9, 1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 2\n        (2.675e8, 1.0e-2, 0.0,    1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 3\n        (2.675e8, 3.0e-2, 2.0e-9, 1.0e3,  5.0e-2, 5.0e-3, 1.0e-5),  # Case 4\n        (2.675e8, 2.0e-2, 2.0e-9, 5.0e-1, 5.0e-3, 5.0e-3, 7.0e-5),  # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, G, D, T2, tau, sigma_x, t = case\n        fid = fid_amplitude(gamma, G, sigma_x, t)\n        echo = echo_amplitude(gamma, G, D, T2, tau)\n        results.append([fid, echo])\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of lists with floats\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3003340"}]}