{"hands_on_practices": [{"introduction": "The imaginary-time Green's function, $G(\\tau)$, is a cornerstone of the finite-temperature formalism, yet its behavior can be counter-intuitive. This exercise probes one of its most fundamental and revealing properties: the discontinuity at $\\tau=0$. You will demonstrate that this discontinuity is not a mere mathematical artifact but is directly determined by the equal-time (anti)commutation relations of the field operators, linking the analytic structure of the Green's function to the fundamental algebraic rules of quantum theory [@problem_id:3004451].", "problem": "Consider a single fermionic mode with annihilation operator $c$ and creation operator $c^{\\dagger}$ obeying the canonical equal-time anticommutation relation $\\{c,c^{\\dagger}\\}=1$. Work in the grand canonical ensemble with inverse temperature $\\beta=1/(k_{B}T)$ and grand potential operator $K=H-\\mu N$, where $H$ is the Hamiltonian, $\\mu$ is the chemical potential, and $N$ is the particle number operator. Define the imaginary-time Heisenberg operator $c(\\tau)=e^{\\tau K} c e^{-\\tau K}$ and the imaginary-time-ordered Green's function\n$$\nG(\\tau)=\\langle T_{\\tau}\\,c(\\tau)\\,c^{\\dagger}(0)\\rangle=\\frac{\\mathrm{Tr}\\big[\\exp(-\\beta K)\\,T_{\\tau}\\,c(\\tau)\\,c^{\\dagger}(0)\\big]}{\\mathrm{Tr}\\big[\\exp(-\\beta K)\\big]},\n$$\nwhere $T_{\\tau}$ is the imaginary-time-ordering operator and $\\langle\\cdots\\rangle$ denotes the thermal average.\n\n1) Starting only from these definitions and the canonical equal-time anticommutation relation, derive a general expression for the equal-time discontinuity\n$$\n\\Delta G\\equiv \\lim_{\\epsilon\\to 0^{+}}\\big(G(0^{-})-G(0^{+})\\big)\n$$\nin terms of an equal-time anticommutator thermal expectation value.\n\n2) Specialize to a non-interacting fermionic level with $K=\\epsilon c^{\\dagger}c$, where $\\epsilon$ is the single-particle energy measured relative to the chemical potential. Evaluate $\\Delta G$ at arbitrary finite temperature. Express your final answer as a single real number without units.", "solution": "We begin from first principles: the imaginary-time Heisenberg operator $c(\\tau)=e^{\\tau K} c e^{-\\tau K}$, the imaginary-time-ordering operator $T_{\\tau}$, and the thermal average $\\langle\\cdots\\rangle$ defined with respect to $e^{-\\beta K}$.\n\nStep 1: Time-ordering decomposition and side limits at $\\tau=0$.\nFor any two fermionic operators $A(\\tau)$ and $B(\\tau')$, the imaginary-time-ordering operator acts as\n$$\nT_{\\tau}\\,A(\\tau)\\,B(\\tau')=\\theta(\\tau-\\tau')\\,A(\\tau)\\,B(\\tau')-\\theta(\\tau'-\\tau)\\,B(\\tau')\\,A(\\tau),\n$$\nwhere $\\theta$ is the Heaviside step function. Applying this to $G(\\tau)=\\langle T_{\\tau}\\,c(\\tau)\\,c^{\\dagger}(0)\\rangle$ gives\n$$\nG(\\tau)=\\theta(\\tau)\\,\\langle c(\\tau)\\,c^{\\dagger}(0)\\rangle-\\theta(-\\tau)\\,\\langle c^{\\dagger}(0)\\,c(\\tau)\\rangle.\n$$\nTaking the limits $\\tau\\to 0^{+}$ and $\\tau\\to 0^{-}$ and using the continuity of $c(\\tau)$ as an operator-valued function of $\\tau$ at equal times, we obtain\n$$\nG(0^{+})=\\langle c(0)\\,c^{\\dagger}(0)\\rangle,\\qquad G(0^{-})=-\\langle c^{\\dagger}(0)\\,c(0)\\rangle.\n$$\nTherefore, the equal-time discontinuity is\n$$\n\\Delta G\\equiv G(0^{-})-G(0^{+})=-\\langle c^{\\dagger}(0)\\,c(0)\\rangle-\\langle c(0)\\,c^{\\dagger}(0)\\rangle=-\\left\\langle \\{c(0),c^{\\dagger}(0)\\}\\right\\rangle.\n$$\nSince the thermal average is time-translation invariant and the anticommutator here is at equal times, we can write more simply\n$$\n\\Delta G=-\\langle\\{c,c^{\\dagger}\\}\\rangle.\n$$\n\nStep 2: Evaluation for a non-interacting fermionic level.\nFor a single non-interacting fermionic level with $K=\\epsilon c^{\\dagger}c$, the canonical anticommutation relation gives the operator identity\n$$\n\\{c,c^{\\dagger}\\}=1.\n$$\nTaking the thermal average preserves this identity because the right-hand side is a $c$-number:\n$$\n\\langle\\{c,c^{\\dagger}\\}\\rangle=\\langle 1\\rangle=1.\n$$\nHence, from the general expression derived above,\n$$\n\\Delta G=-\\langle\\{c,c^{\\dagger}\\}\\rangle=-1.\n$$\n\nOptional consistency check via explicit thermal averages: For completeness, one may compute $G(0^{\\pm})$ directly using $c(\\tau)=e^{-\\epsilon\\tau}c$ and the thermal averages $\\langle c^{\\dagger}c\\rangle=f(\\epsilon)$ and $\\langle cc^{\\dagger}\\rangle=1-f(\\epsilon)$, where $f(\\epsilon)=1/(e^{\\beta\\epsilon}+1)$ is the Fermi-Dirac distribution. Then\n$$\nG(0^{+})=\\langle c\\,c^{\\dagger}\\rangle=1-f(\\epsilon),\\qquad G(0^{-})=-\\langle c^{\\dagger}c\\rangle=-f(\\epsilon),\n$$\nso\n$$\n\\Delta G=G(0^{-})-G(0^{+})=-f(\\epsilon)-\\big(1-f(\\epsilon)\\big)=-1,\n$$\nin agreement with the anticommutator result. This confirms that the discontinuity is purely kinematic and independent of temperature and the level energy for canonical fermions.", "answer": "$$\\boxed{-1}$$", "id": "3004451"}, {"introduction": "Transforming from the imaginary-time domain to the frequency domain introduces infinite sums over discrete Matsubara frequencies. Evaluating these sums is a critical skill, and this practice introduces the most powerful tool for the job: contour integration. By applying residue calculus to a fundamental fermionic sum, you will not only master a ubiquitous technique but also derive a profound connection between the non-interacting Green's function and the Fermi-Dirac distribution, reaffirming the physical consistency of the formalism [@problem_id:3004458].", "problem": "Consider a noninteracting fermionic mode of energy $\\epsilon \\in \\mathbb{R}$ at finite temperature $T$, with inverse temperature $\\beta \\equiv 1/(k_B T)$. Let $\\omega_n = (2n+1)\\pi/\\beta$ with $n \\in \\mathbb{Z}$ denote the fermionic Matsubara frequencies. Define the Matsubara sum\n$$\nS(\\epsilon) \\equiv \\frac{1}{\\beta} \\sum_{n=-\\infty}^{\\infty} \\frac{1}{i \\omega_n - \\epsilon} \\, .\n$$\nStarting only from the definitions of the fermionic Matsubara frequencies and the Fermi-Dirac distribution, evaluate $S(\\epsilon)$ by contour integration in the complex plane. Provide a closed-form analytic expression for $S(\\epsilon)$ as a function of $\\beta$ and $\\epsilon$. If you introduce any infinitesimal convergence factor, ensure its removal is well-justified. Express your final answer as a single analytic expression with no units.", "solution": "The task is to evaluate the Matsubara sum\n$$\nS(\\epsilon) = \\frac{1}{\\beta} \\sum_{n=-\\infty}^{\\infty} \\frac{1}{i \\omega_n - \\epsilon}\n$$\nwhere $\\omega_n = (2n+1)\\pi/\\beta$ are the fermionic Matsubara frequencies for $n \\in \\mathbb{Z}$, $\\epsilon \\in \\mathbb{R}$ is a constant energy, and $\\beta$ is the inverse temperature.\n\nThe sum is conditionally convergent, as for large $|n|$, the term behaves as $1/n$. To ensure a well-defined result, we must introduce a regularization. The standard physical prescription, which corresponds to evaluating the time-ordered Green's function at a negative infinitesimal time $\\tau = 0^-$, is to introduce a convergence factor $e^{i\\omega_n \\eta}$ with $\\eta \\to 0^+$. Thus, we first evaluate the regularized sum:\n$$\nS_{\\eta}(\\epsilon) = \\frac{1}{\\beta} \\sum_{n=-\\infty}^{\\infty} \\frac{e^{i\\omega_n \\eta}}{i \\omega_n - \\epsilon}\n$$\nand then take the limit $\\eta \\to 0^+$ at the end of the calculation.\n\nWe can express this sum as a contour integral in the complex plane. The key is to find an auxiliary function that has simple poles at the Matsubara frequencies $i\\omega_n$. The Fermi-Dirac distribution function, $n_F(E) = \\frac{1}{e^{\\beta E} + 1}$, when extended to the complex plane as $n_F(z) = \\frac{1}{e^{\\beta z} + 1}$, has poles precisely where we need them. The poles of $n_F(z)$ occur when $e^{\\beta z} + 1 = 0$, which implies $e^{\\beta z} = -1 = e^{i(2k+1)\\pi}$ for any integer $k$. The solutions are $z_k = i(2k+1)\\pi/\\beta = i\\omega_k$. These are simple poles.\n\nLet's construct the integrand for our contour integral. Consider the function:\n$$\nf(z) = \\frac{e^{z\\eta}}{z-\\epsilon} n_F(z) = \\frac{e^{z\\eta}}{(z-\\epsilon)(e^{\\beta z} + 1)}\n$$\nThe poles of this function $f(z)$ are:\n1. A simple pole at $z = \\epsilon$.\n2. Simple poles at the fermionic Matsubara frequencies $z_n = i\\omega_n$ for all $n \\in \\mathbb{Z}$.\n\nWe evaluate the residues of $f(z)$ at these poles.\nFor the pole at $z=\\epsilon$:\n$$\n\\text{Res}(f, \\epsilon) = \\lim_{z \\to \\epsilon} (z-\\epsilon) f(z) = \\lim_{z \\to \\epsilon} \\frac{e^{z\\eta}}{e^{\\beta z} + 1} = \\frac{e^{\\epsilon\\eta}}{e^{\\beta\\epsilon}+1} = n_F(\\epsilon) e^{\\epsilon\\eta}\n$$\nFor the poles at $z_n=i\\omega_n$:\nThe residue of $n_F(z)$ at $z_n$ is given by $\\lim_{z \\to z_n} (z-z_n) \\frac{1}{e^{\\beta z}+1}$. Using L'Hôpital's rule for a $0/0$ form (or the formula for a simple pole $P(z_n)/Q'(z_n)$), the residue is $\\frac{1}{\\beta e^{\\beta z_n}} = \\frac{1}{\\beta e^{i(2n+1)\\pi}} = -\\frac{1}{\\beta}$.\nThus, the residue of $f(z)$ at $z_n$ is:\n$$\n\\text{Res}(f, i\\omega_n) = \\left. \\frac{e^{z\\eta}}{z-\\epsilon} \\right|_{z=i\\omega_n} \\times \\text{Res}(n_F(z), i\\omega_n) = \\frac{e^{i\\omega_n \\eta}}{i\\omega_n - \\epsilon} \\left(-\\frac{1}{\\beta}\\right)\n$$\nThe sum of these residues is directly related to our target sum $S_{\\eta}(\\epsilon)$:\n$$\n\\sum_{n=-\\infty}^{\\infty} \\text{Res}(f, i\\omega_n) = \\sum_{n=-\\infty}^{\\infty} -\\frac{1}{\\beta} \\frac{e^{i\\omega_n \\eta}}{i\\omega_n - \\epsilon} = -S_{\\eta}(\\epsilon)\n$$\nNow, we apply the residue theorem. Let $C_R$ be a circular contour of radius $R$ centered at the origin, with $R$ large enough to enclose all poles of interest. The theorem states:\n$$\n\\frac{1}{2\\pi i} \\oint_{C_R} f(z) dz = \\sum_{k} \\text{Res}(f, z_k) = \\text{Res}(f, \\epsilon) + \\sum_{n=-\\infty}^{\\infty} \\text{Res}(f, i\\omega_n)\n$$\n$$\n\\frac{1}{2\\pi i} \\oint_{C_R} f(z) dz = n_F(\\epsilon) e^{\\epsilon\\eta} - S_{\\eta}(\\epsilon)\n$$\nWe must show that the contour integral vanishes as $R \\to \\infty$. Let $z=Re^{i\\theta}$. For large $|z|=R$, we have $|z-\\epsilon| \\approx R$.\nThe magnitude of the integrand is:\n$$\n|f(z)| \\approx \\frac{|e^{z\\eta}|}{R |e^{\\beta z} + 1|} = \\frac{e^{\\eta R \\cos\\theta}}{R |e^{\\beta R\\cos\\theta}e^{i\\beta R\\sin\\theta} + 1|}\n$$\nWe analyze the behavior in two parts of the complex plane:\n1. Right half-plane ($\\text{Re}(z) = R\\cos\\theta > 0$, i.e., $-\\pi/2  \\theta  \\pi/2$):\nAs $R\\to\\infty$, $e^{\\beta R\\cos\\theta}$ grows exponentially, so $|e^{\\beta z}+1| \\sim e^{\\beta R\\cos\\theta}$.\n$$\n|f(z)| \\sim \\frac{e^{\\eta R \\cos\\theta}}{R e^{\\beta R \\cos\\theta}} = \\frac{1}{R} e^{-(\\beta-\\eta)R\\cos\\theta}\n$$\nSince $\\eta \\to 0^+$, we have $\\beta - \\eta > 0$. As $\\cos\\theta > 0$ in this region, the exponential term causes $|f(z)|$ to vanish much faster than $1/R$.\n2. Left half-plane ($\\text{Re}(z) = R\\cos\\theta  0$, i.e., $\\pi/2  \\theta  3\\pi/2$):\nAs $R\\to\\infty$, $e^{\\beta R\\cos\\theta} \\to 0$, so $|e^{\\beta z}+1| \\sim 1$.\n$$\n|f(z)| \\sim \\frac{e^{\\eta R \\cos\\theta}}{R}\n$$\nSince $\\eta > 0$ and $\\cos\\theta  0$ in this region, the exponential term $e^{\\eta R\\cos\\theta}$ decays to zero exponentially fast.\n\nIn both half-planes, the integrand $|f(z)|$ vanishes faster than $1/R$ as $R\\to\\infty$. The length of the contour is $2\\pi R$. By the ML-inequality, the magnitude of the integral is bounded by $(2\\pi R) \\times \\max_{z \\in C_R} |f(z)|$, which tends to zero. Therefore,\n$$\n\\lim_{R\\to\\infty} \\oint_{C_R} f(z) dz = 0\n$$\nFrom the residue theorem, it follows that the sum of all residues must be zero:\n$$\nn_F(\\epsilon) e^{\\epsilon\\eta} - S_{\\eta}(\\epsilon) = 0\n$$\nThis gives an expression for the regularized sum:\n$$\nS_{\\eta}(\\epsilon) = n_F(\\epsilon) e^{\\epsilon\\eta}\n$$\nFinally, to obtain the value of the original sum, we remove the regularization by taking the limit $\\eta \\to 0^+$. This is a well-defined limit:\n$$\nS(\\epsilon) = \\lim_{\\eta \\to 0^+} S_{\\eta}(\\epsilon) = \\lim_{\\eta \\to 0^+} \\left( n_F(\\epsilon) e^{\\epsilon\\eta} \\right) = n_F(\\epsilon) e^0 = n_F(\\epsilon)\n$$\nSubstituting the definition of the Fermi-Dirac distribution, we arrive at the closed-form analytic expression:\n$$\nS(\\epsilon) = \\frac{1}{e^{\\beta\\epsilon}+1}\n$$", "answer": "$$\n\\boxed{\\frac{1}{\\exp(\\beta \\epsilon) + 1}}\n$$", "id": "3004458"}, {"introduction": "While Matsubara Green's functions provide a powerful computational framework, they exist at imaginary frequencies and cannot be directly measured. To connect theory with experiment, one must perform an analytic continuation to the real frequency axis, a process that can be subtle. This practice provides a concrete, hands-on example of this procedure for a bosonic mode coupled to an environment, a scenario frequently encountered in condensed matter physics, guiding you through the steps to obtain the physically meaningful retarded Green's function [@problem_id:925214].", "problem": "In quantum many-body theory at finite temperature, the dynamics of bosonic excitations are described by the thermal (or Matsubara) Green's function, $\\mathcal{G}(i\\nu_m)$, defined at a discrete set of imaginary frequencies called bosonic Matsubara frequencies, $\\nu_m = 2\\pi m T$, where $m$ is an integer and $T$ is the temperature (we set the Boltzmann constant $k_B=1$ and Planck's constant $\\hbar=1$).\n\nPhysical observables related to real-frequency dynamics, such as response functions and spectral densities, are obtained from the retarded Green's function, $\\mathcal{G}^R(\\omega)$. This function is derived from the Matsubara Green's function via analytic continuation. The procedure involves finding a function $\\mathcal{G}(z)$ that is analytic in the upper half of the complex plane ($z \\in \\mathbb{C}, \\text{Im}(z) > 0$) and coincides with $\\mathcal{G}(i\\nu_m)$ for positive Matsubara frequencies ($i\\nu_m$ with $\\nu_m > 0$). The retarded Green's function is then given by the limit $\\mathcal{G}^R(\\omega) = \\mathcal{G}(z \\to \\omega + i\\eta)$ as $\\eta \\to 0^+$.\n\nConsider a bosonic mode with a bare frequency $\\omega_0$. This mode interacts with an environment, which is modeled by a frequency-dependent self-energy, $\\Sigma(i\\nu_m)$. The full Matsubara Green's function is given by the Dyson equation:\n$$\n\\mathcal{G}(i\\nu_m) = \\frac{1}{(i\\nu_m)^2 - \\omega_0^2 - \\Sigma(i\\nu_m)}\n$$\nFor this problem, the self-energy is modeled as arising from coupling to a single, damped harmonic mode of frequency $\\Omega$ and damping rate $\\gamma$:\n$$\n\\Sigma(i\\nu_m) = \\frac{\\lambda^2}{i\\nu_m - \\Omega + i\\gamma}\n$$\nHere, $\\lambda$ is the coupling strength. The parameters $\\omega_0$, $\\lambda$, $\\Omega$, and $\\gamma$ are all real and positive constants.\n\nYour task is to calculate the imaginary part of the retarded Green's function, $\\text{Im}[\\mathcal{G}^R(\\omega)]$, as a function of the real frequency $\\omega$ and the parameters $\\omega_0, \\lambda, \\Omega, \\gamma$.", "solution": "1. Analytic continuation of the self‐energy:\n$$\n\\Sigma^R(\\omega)=\\frac{\\lambda^2}{\\omega-\\Omega+i\\gamma}\n=\\frac{\\lambda^2\\bigl(\\omega-\\Omega-i\\gamma\\bigr)}{(\\omega-\\Omega)^2+\\gamma^2}\\,.\n$$\n\n2. Separate into real and imaginary parts:\n$$\n\\Re\\Sigma^R(\\omega)=\\frac{\\lambda^2(\\omega-\\Omega)}{(\\omega-\\Omega)^2+\\gamma^2},\n\\quad\n\\Im\\Sigma^R(\\omega)=-\\frac{\\lambda^2\\gamma}{(\\omega-\\Omega)^2+\\gamma^2}\\,.\n$$\n\n3. Denominator of the retarded Green’s function:\n$$\nD(\\omega)\n=(\\omega+i0^+)^2-\\omega_0^2-\\Sigma^R(\\omega)\n=\\bigl[\\omega^2-\\omega_0^2-\\Re\\Sigma^R(\\omega)\\bigr]\n+i\\bigl[-\\Im\\Sigma^R(\\omega)\\bigr]\\,.\n$$\nDefine \n$$\nA(\\omega)=\\omega^2-\\omega_0^2-\\Re\\Sigma^R(\\omega),\n\\quad\nB(\\omega)=-\\Im\\Sigma^R(\\omega)=\\frac{\\lambda^2\\gamma}{(\\omega-\\Omega)^2+\\gamma^2}\\,.\n$$\n\n4. Imaginary part of $G^R(\\omega)=1/[A(\\omega)+iB(\\omega)]$:\n$$\n\\Im G^R(\\omega)\n=\\Im\\frac{1}{A+iB}\n=-\\frac{B}{A^2+B^2}\\,.\n$$\n\n5. Substitute $A$ and $B$:\n$$\n\\Im G^R(\\omega)\n=-\\frac{\\displaystyle\\frac{\\lambda^2\\gamma}{(\\omega-\\Omega)^2+\\gamma^2}}\n{\\Bigl[\\omega^2-\\omega_0^2-\\frac{\\lambda^2(\\omega-\\Omega)}{(\\omega-\\Omega)^2+\\gamma^2}\\Bigr]^2\n+\\Bigl[\\frac{\\lambda^2\\gamma}{(\\omega-\\Omega)^2+\\gamma^2}\\Bigr]^2}\\,. \n$$", "answer": "$$\n\\boxed{\n-\\frac{\\displaystyle\\frac{\\lambda^2\\gamma}{(\\omega-\\Omega)^2+\\gamma^2}}\n{\\Bigl[\\omega^2-\\omega_0^2-\\frac{\\lambda^2(\\omega-\\Omega)}{(\\omega-\\Omega)^2+\\gamma^2}\\Bigr]^2\n+\\displaystyle\\Bigl[\\frac{\\lambda^2\\gamma}{(\\omega-\\Omega)^2+\\gamma^2}\\Bigr]^2}\n}\n$$", "id": "925214"}]}