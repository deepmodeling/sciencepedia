{"hands_on_practices": [{"introduction": "Our journey into the practical application of exchange-correlation concepts begins with the cornerstone model of many-body physics: the homogeneous electron gas (HEG). This idealized system of interacting electrons in a uniform positive background is foundational for developing most practical density functionals. By deriving its exchange energy from first principles, you will not only obtain a classic and vital result but also gain proficiency with the mathematical machinery, such as Fourier analysis, that is indispensable in condensed matter theory. [@problem_id:2987011]", "problem": "Consider a three-dimensional homogeneous electron gas at zero temperature, in the spin-unpolarized case, confined in a cubic box of volume $V$ with periodic boundary conditions. Electrons occupy plane-wave orbitals up to the Fermi wavevector $k_F$, and the electron-electron interaction in Gaussian electrostatic units is $v(\\mathbf r - \\mathbf r') = e^2/|\\mathbf r - \\mathbf r'|$. The exchange energy can be written in terms of the spin-resolved exchange hole $h_x^{\\sigma}(\\mathbf r, \\mathbf r')$ as\n$$\nE_x \\equiv \\frac{1}{2} \\sum_{\\sigma} \\int d\\mathbf r \\int d\\mathbf r' \\, \\frac{e^2 \\, n_{\\sigma}(\\mathbf r) \\, h_x^{\\sigma}(\\mathbf r, \\mathbf r')}{|\\mathbf r - \\mathbf r'|},\n$$\nwhere $n_{\\sigma}(\\mathbf r)$ is the spin-$\\sigma$ electron density. Using only the following foundational facts:\n- The homogeneous electron gas is translationally invariant, so $n_{\\sigma}(\\mathbf r) = n_{\\sigma}$ is constant and all two-point quantities depend only on $\\mathbf s \\equiv \\mathbf r - \\mathbf r'$.\n- The one-particle density matrix for spin $\\sigma$ is\n$$\n\\gamma_{\\sigma}(\\mathbf s) \\equiv \\int_{|\\mathbf k| \\le k_F} \\frac{d^3 k}{(2\\pi)^3} \\, \\exp(i \\mathbf k \\cdot \\mathbf s),\n$$\nand the spin-$\\sigma$ number density is $n_{\\sigma} = \\int_{|\\mathbf k| \\le k_F} \\frac{d^3 k}{(2\\pi)^3} = \\frac{k_F^3}{6\\pi^2}$ in the spin-unpolarized case.\n- For independent electrons, the same-spin pair density satisfies $\\rho^{(2)}_{\\sigma\\sigma}(\\mathbf r, \\mathbf r') = n_{\\sigma}^2 - |\\gamma_{\\sigma}(\\mathbf r - \\mathbf r')|^2$, and the exchange hole is the deviation of the conditional same-spin density from $n_{\\sigma}$, so $h_x^{\\sigma}(\\mathbf r, \\mathbf r') = -|\\gamma_{\\sigma}(\\mathbf r - \\mathbf r')|^2/n_{\\sigma}$.\n\nStarting from these bases, derive the exchange energy per electron $E_x/N$ of the homogeneous electron gas as a closed-form function of the Fermi wavevector $k_F$ and the electron charge $e$. Your derivation must be self-contained and logically complete, and you may employ the Fourier transform of $1/|\\mathbf s|$, namely\n$$\n\\int d^3 s \\, \\frac{\\exp(i \\mathbf q \\cdot \\mathbf s)}{|\\mathbf s|} = \\frac{4\\pi}{q^2},\n$$\nas a well-known mathematical fact. Express the final result symbolically in Gaussian electrostatic units, in terms of $e$ and $k_F$. No numerical evaluation or rounding is required. The final answer must be a single closed-form analytic expression.", "solution": "The user wants to derive the exchange energy per electron for a homogeneous electron gas.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- System: Three-dimensional homogeneous electron gas at zero temperature, spin-unpolarized, in a cubic box of volume $V$ with periodic boundary conditions.\n- Electron-electron interaction (Gaussian electrostatic units): $v(\\mathbf r - \\mathbf r') = e^2/|\\mathbf r - \\mathbf r'|$.\n- Definition of exchange energy: $E_x \\equiv \\frac{1}{2} \\sum_{\\sigma} \\int d\\mathbf r \\int d\\mathbf r' \\, \\frac{e^2 \\, n_{\\sigma}(\\mathbf r) \\, h_x^{\\sigma}(\\mathbf r, \\mathbf r')}{|\\mathbf r - \\mathbf r'|}$.\n- Translational invariance properties: $n_{\\sigma}(\\mathbf r) = n_{\\sigma}$ is constant and two-point quantities depend on the separation vector $\\mathbf s \\equiv \\mathbf r - \\mathbf r'$.\n- One-particle density matrix for spin $\\sigma$: $\\gamma_{\\sigma}(\\mathbf s) \\equiv \\int_{|\\mathbf k| \\le k_F} \\frac{d^3 k}{(2\\pi)^3} \\, \\exp(i \\mathbf k \\cdot \\mathbf s)$.\n- Spin-$\\sigma$ number density (spin-unpolarized case): $n_{\\sigma} = \\int_{|\\mathbf k| \\le k_F} \\frac{d^3 k}{(2\\pi)^3} = \\frac{k_F^3}{6\\pi^2}$.\n- Exchange hole definition: For independent electrons, the same-spin pair density satisfies $\\rho^{(2)}_{\\sigma\\sigma}(\\mathbf r, \\mathbf r') = n_{\\sigma}^2 - |\\gamma_{\\sigma}(\\mathbf r - \\mathbf r')|^2$. The exchange hole is given as $h_x^{\\sigma}(\\mathbf r, \\mathbf r') = -|\\gamma_{\\sigma}(\\mathbf r - \\mathbf r')|^2/n_{\\sigma}$.\n- Mathematical tool: The Fourier transform of $1/|\\mathbf s|$ is $\\int d^3 s \\, \\frac{\\exp(i \\mathbf q \\cdot \\mathbf s)}{|\\mathbf s|} = \\frac{4\\pi}{q^2}$.\n- Objective: Derive the exchange energy per electron, $E_x/N$, as a function of $k_F$ and $e$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes a standard derivation of the exchange energy within the Hartree-Fock approximation for the homogeneous electron gas (jellium model). This is a foundational topic in solid-state and many-body physics. All provided definitions and relations are standard and correct for this model.\n- **Well-Posed:** The problem provides a clear starting point, all necessary definitions and intermediate relations, and a clear goal. The setup allows for a unique, deterministic solution.\n- **Objective:** The problem is stated using precise, standard scientific terminology, free of any subjectivity or ambiguity.\n- **Conclusion:** The problem is scientifically sound, self-contained, and well-posed. No flaws are detected.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A detailed derivation will be provided.\n\n**Derivation of the Exchange Energy per Electron**\n\nWe begin with the provided expression for the exchange energy, $E_x$:\n$$\nE_x = \\frac{1}{2} \\sum_{\\sigma} \\int d\\mathbf r \\int d\\mathbf r' \\, \\frac{e^2 \\, n_{\\sigma}(\\mathbf r) \\, h_x^{\\sigma}(\\mathbf r, \\mathbf r')}{|\\mathbf r - \\mathbf r'|}\n$$\nThe system is a homogeneous electron gas, so the spin density $n_{\\sigma}(\\mathbf r)$ is a constant, $n_{\\sigma}$. The exchange hole $h_x^{\\sigma}(\\mathbf r, \\mathbf r')$ depends only on the difference coordinate $\\mathbf s = \\mathbf r - \\mathbf r'$. We substitute the given expression for the exchange hole, $h_x^{\\sigma}(\\mathbf s) = -|\\gamma_{\\sigma}(\\mathbf s)|^2/n_{\\sigma}$:\n$$\nE_x = \\frac{1}{2} \\sum_{\\sigma} \\int d\\mathbf r \\int d\\mathbf r' \\, \\frac{e^2 \\, n_{\\sigma}}{|\\mathbf r - \\mathbf r'|} \\left( -\\frac{|\\gamma_{\\sigma}(\\mathbf r - \\mathbf r')|^2}{n_{\\sigma}} \\right)\n$$\nThe densities $n_{\\sigma}$ cancel out:\n$$\nE_x = -\\frac{e^2}{2} \\sum_{\\sigma} \\int d\\mathbf r \\int d\\mathbf r' \\, \\frac{|\\gamma_{\\sigma}(\\mathbf r - \\mathbf r')|^2}{|\\mathbf r - \\mathbf r'|}\n$$\nWe perform a change of integration variables from $(\\mathbf r, \\mathbf r')$ to $(\\mathbf r, \\mathbf s)$, where $\\mathbf s = \\mathbf r - \\mathbf r'$. The Jacobian of this transformation is unity. The integral over $\\mathbf r$ becomes decoupled from the rest of the integrand:\n$$\nE_x = -\\frac{e^2}{2} \\sum_{\\sigma} \\left( \\int d\\mathbf r \\right) \\left( \\int d\\mathbf s \\, \\frac{|\\gamma_{\\sigma}(\\mathbf s)|^2}{|\\mathbf s|} \\right)\n$$\nThe integral $\\int d\\mathbf r$ over the entire system volume yields $V$.\n$$\nE_x = -\\frac{e^2 V}{2} \\sum_{\\sigma} \\int d\\mathbf s \\, \\frac{|\\gamma_{\\sigma}(\\mathbf s)|^2}{|\\mathbf s|}\n$$\nThe system is specified as spin-unpolarized, which means the properties are identical for spin-up and spin-down electrons. Thus, $\\gamma_{\\uparrow}(\\mathbf s) = \\gamma_{\\downarrow}(\\mathbf s)$. We can denote this common function as $\\gamma(\\mathbf s)$. The summation over spin $\\sigma$ therefore contributes a factor of $2$:\n$$\nE_x = -\\frac{e^2 V}{2} (2) \\int d\\mathbf s \\, \\frac{|\\gamma(\\mathbf s)|^2}{|\\mathbf s|} = -e^2 V \\int d\\mathbf s \\, \\frac{|\\gamma(\\mathbf s)|^2}{|\\mathbf s|}\n$$\nThe remaining integral is difficult to evaluate in real space. We employ Fourier analysis. The integral has the form $\\int f(\\mathbf s)g(\\mathbf s) d\\mathbf s$. We can use the convolution theorem or Plancherel's theorem. Let's express the Coulomb interaction term $1/|\\mathbf s|$ using its Fourier representation. Its Fourier transform is $\\tilde{v}(\\mathbf q) = \\int d^3 s \\, \\exp(-i \\mathbf q \\cdot \\mathbf s) \\frac{1}{|\\mathbf s|} = \\frac{4\\pi}{q^2}$. The inverse transform is:\n$$\n\\frac{1}{|\\mathbf s|} = \\int \\frac{d^3 q}{(2\\pi)^3} \\tilde{v}(\\mathbf q) \\exp(i \\mathbf q \\cdot \\mathbf s) = \\int \\frac{d^3 q}{(2\\pi)^3} \\frac{4\\pi}{q^2} \\exp(i \\mathbf q \\cdot \\mathbf s)\n$$\nSubstituting this into the expression for $E_x$:\n$$\nE_x = -e^2 V \\int d\\mathbf s |\\gamma(\\mathbf s)|^2 \\left( \\int \\frac{d^3 q}{(2\\pi)^3} \\frac{4\\pi}{q^2} \\exp(i \\mathbf q \\cdot \\mathbf s) \\right)\n$$\nWe exchange the order of integration:\n$$\nE_x = -e^2 V \\int \\frac{d^3 q}{(2\\pi)^3} \\frac{4\\pi}{q^2} \\left( \\int d\\mathbf s |\\gamma(\\mathbf s)|^2 \\exp(i \\mathbf q \\cdot \\mathbf s) \\right)\n$$\nThe inner integral is the Fourier transform of $|\\gamma(\\mathbf s)|^2$. According to the convolution theorem, the Fourier transform of a product of functions is the convolution of their individual Fourier transforms (up to a factor of $(2\\pi)^{-3}$). The density matrix is given by $\\gamma(\\mathbf s) = \\int_{|\\mathbf k| \\le k_F} \\frac{d^3 k}{(2\\pi)^3} \\exp(i \\mathbf k \\cdot \\mathbf s)$. This is an inverse Fourier transform. The corresponding forward Fourier transform is $\\tilde{\\gamma}(\\mathbf k) = \\Theta(k_F - |\\mathbf k|)$, where $\\Theta$ is the Heaviside step function. Since the integration domain for $\\mathbf k$ in the definition of $\\gamma(\\mathbf s)$ is symmetric, $\\gamma(\\mathbf s)$ is a real function, so $|\\gamma(\\mathbf s)|^2 = \\gamma(\\mathbf s)^2$.\n\nThe Fourier transform of $\\gamma(\\mathbf s)^2$ is the convolution of $\\tilde{\\gamma}(\\mathbf k)$ with itself:\n$$\n\\mathcal{F}[\\gamma(\\mathbf s)^2](\\mathbf q) = \\int d\\mathbf s \\, \\gamma(\\mathbf s)^2 \\exp(-i \\mathbf q \\cdot \\mathbf s) = \\frac{1}{(2\\pi)^3} \\int d^3 k \\, \\tilde{\\gamma}(\\mathbf k) \\tilde{\\gamma}(\\mathbf q - \\mathbf k)\n$$\nNote: a sign change in the exponential argument $\\exp(i \\mathbf q \\cdot \\mathbf s)$ vs $\\exp(-i \\mathbf q \\cdot \\mathbf s)$ will result in a sign change in the argument of the convolution, which is inconsequential for this problem. Thus we have:\n$$\n\\int d\\mathbf s |\\gamma(\\mathbf s)|^2 \\exp(i \\mathbf q \\cdot \\mathbf s) = \\frac{1}{(2\\pi)^3} \\int d^3 k \\, \\Theta(k_F - |\\mathbf k|) \\Theta(k_F - |\\mathbf k - \\mathbf q|)\n$$\nThis integral represents the volume of intersection of two spheres of radius $k_F$, with their centers displaced by a vector $\\mathbf q$. The volume depends only on the magnitude $q = |\\mathbf q|$. It is non-zero only for $0 \\le q \\le 2k_F$. The volume of intersection is a standard geometrical result:\n$$\nI(q) = \\int d^3 k \\, \\Theta(k_F - |\\mathbf k|) \\Theta(k_F - |\\mathbf q - \\mathbf k|) = 2\\pi \\int_{q/2}^{k_F} (k_F^2 - x^2) dx = 2\\pi \\left[k_F^2 x - \\frac{x^3}{3}\\right]_{q/2}^{k_F}\n$$\n$$\nI(q) = 2\\pi \\left( (k_F^3 - \\frac{k_F^3}{3}) - (k_F^2 \\frac{q}{2} - \\frac{q^3}{24}) \\right) = 2\\pi \\left(\\frac{2}{3}k_F^3 - \\frac{k_F^2 q}{2} + \\frac{q^3}{24}\\right) = \\frac{4\\pi}{3} k_F^3 - \\pi k_F^2 q + \\frac{\\pi q^3}{12}\n$$\nNow we substitute this back into the expression for $E_x$:\n$$\nE_x = -e^2 V \\int \\frac{d^3 q}{(2\\pi)^3} \\frac{4\\pi}{q^2} \\left[ \\frac{1}{(2\\pi)^3} I(q) \\right] = -\\frac{4\\pi e^2 V}{(2\\pi)^6} \\int d^3 q \\, \\frac{I(q)}{q^2}\n$$\nThe integrand depends only on the magnitude $q$, so we switch to spherical coordinates for the $\\mathbf q$-integration, where $d^3 q = 4\\pi q^2 dq$.\n$$\nE_x = -\\frac{4\\pi e^2 V}{64\\pi^6} \\int_0^{2k_F} 4\\pi q^2 dq \\, \\frac{I(q)}{q^2} = -\\frac{e^2 V}{4\\pi^4} \\int_0^{2k_F} I(q) dq\n$$\nSubstitute the expression for $I(q)$:\n$$\nE_x = -\\frac{e^2 V}{4\\pi^4} \\int_0^{2k_F} \\left( \\frac{4\\pi}{3} k_F^3 - \\pi k_F^2 q + \\frac{\\pi q^3}{12} \\right) dq\n$$\nFactor out $\\pi$ from the integrand:\n$$\nE_x = -\\frac{\\pi e^2 V}{4\\pi^4} \\int_0^{2k_F} \\left( \\frac{4}{3} k_F^3 - k_F^2 q + \\frac{q^3}{12} \\right) dq = -\\frac{e^2 V}{4\\pi^3} \\left[ \\frac{4}{3} k_F^3 q - \\frac{k_F^2 q^2}{2} + \\frac{q^4}{48} \\right]_0^{2k_F}\n$$\nEvaluate the integral at the limits:\n$$\nE_x = -\\frac{e^2 V}{4\\pi^3} \\left[ \\left( \\frac{4}{3} k_F^3 (2k_F) - \\frac{k_F^2 (2k_F)^2}{2} + \\frac{(2k_F)^4}{48} \\right) - (0) \\right]\n$$\n$$\nE_x = -\\frac{e^2 V}{4\\pi^3} \\left[ \\frac{8}{3} k_F^4 - \\frac{4k_F^4}{2} + \\frac{16k_F^4}{48} \\right] = -\\frac{e^2 V}{4\\pi^3} \\left[ \\frac{8}{3} k_F^4 - 2 k_F^4 + \\frac{1}{3} k_F^4 \\right]\n$$\n$$\nE_x = -\\frac{e^2 V}{4\\pi^3} \\left[ \\frac{9}{3} k_F^4 - 2 k_F^4 \\right] = -\\frac{e^2 V}{4\\pi^3} \\left[ 3 k_F^4 - 2 k_F^4 \\right] = -\\frac{e^2 V k_F^4}{4\\pi^3}\n$$\nThis is the total exchange energy. To find the exchange energy per electron, $E_x/N$, we need the total number of electrons, $N$. The total electron density is $n = n_{\\uparrow} + n_{\\downarrow}$. For a spin-unpolarized system, $n_\\uparrow=n_\\downarrow=n_\\sigma$. Using the provided expression for $n_\\sigma$:\n$$\nn = 2 n_{\\sigma} = 2 \\left( \\frac{k_F^3}{6\\pi^2} \\right) = \\frac{k_F^3}{3\\pi^2}\n$$\nThe total number of electrons is $N = nV = \\frac{k_F^3 V}{3\\pi^2}$.\nFinally, we compute the ratio $E_x/N$:\n$$\n\\frac{E_x}{N} = \\frac{-e^2 V k_F^4 / (4\\pi^3)}{k_F^3 V / (3\\pi^2)} = -\\frac{e^2 V k_F^4}{4\\pi^3} \\cdot \\frac{3\\pi^2}{k_F^3 V}\n$$\nCanceling common factors:\n$$\n\\frac{E_x}{N} = -\\frac{3e^2 k_F}{4\\pi}\n$$\nThis is the exchange energy per electron for the homogeneous electron gas, expressed in terms of the elementary charge $e$ and the Fermi wavevector $k_F$.", "answer": "$$\n\\boxed{-\\frac{3 e^2 k_F}{4 \\pi}}\n$$", "id": "2987011"}, {"introduction": "While the homogeneous electron gas provides the basis for many approximations, its uniformity can obscure certain fundamental properties. This next practice provides a clearer lens by focusing on a simple, finite two-electron system. Here, we will tackle the infamous self-interaction problem head-on, demonstrating explicitly how the exact exchange energy works to perfectly cancel the unphysical repulsion of an electron with itself that is present in the classical Hartree energy. [@problem_id:2987037] Understanding this cancellation is crucial for appreciating the successes and failures of various approximate functionals.", "problem": "Consider a spin-singlet two-electron system described within the Kohn-Sham (KS) formalism of density functional theory, where both electrons occupy the same normalized spatial orbital $\\varphi(\\mathbf{r})$ with opposite spins. Work in Hartree atomic units, and take the Coulomb kernel to be $v(\\mathbf{r},\\mathbf{r}') = |\\mathbf{r}-\\mathbf{r}'|^{-1}$.\n\nUse the following foundational definitions for a noninteracting fermionic system:\n- The spin-resolved one-particle reduced density matrix is $\\gamma_{\\sigma}(\\mathbf{r},\\mathbf{r}') = \\sum_{i} \\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{i\\sigma}(\\mathbf{r}')$.\n- The spin-resolved density is $n_{\\sigma}(\\mathbf{r}) = \\gamma_{\\sigma}(\\mathbf{r},\\mathbf{r})$.\n- The exact-exchange (EXX) hole for spin $\\sigma$ is defined by $h_{x,\\sigma}(\\mathbf{r},\\mathbf{r}') = -\\frac{|\\gamma_{\\sigma}(\\mathbf{r},\\mathbf{r}')|^{2}}{n_{\\sigma}(\\mathbf{r})}$, and the corresponding EXX energy is $E_{x} = \\frac{1}{2}\\sum_{\\sigma}\\int d^{3}\\mathbf{r}\\,n_{\\sigma}(\\mathbf{r})\\int d^{3}\\mathbf{r}'\\,h_{x,\\sigma}(\\mathbf{r},\\mathbf{r}')\\,v(\\mathbf{r},\\mathbf{r}')$.\n\nStarting from these definitions and the KS representation for the singlet, perform the following:\n1. Construct the exact-exchange hole $h_{x,\\sigma}(\\mathbf{r},\\mathbf{r}')$ for each spin channel.\n2. Use the result to obtain $E_{x}$ in terms of $\\varphi(\\mathbf{r})$.\n3. Compute the Hartree energy $E_{H}$ in terms of $\\varphi(\\mathbf{r})$.\n4. Combine the two to determine $E_{H}+E_{x}$ and explicitly demonstrate the cancellation of the unphysical self-interaction contributions, leaving only the physically meaningful electron-electron interaction between opposite spins.\n\nProvide your final answer as a single closed-form analytical expression for $E_{H}+E_{x}$ written as a double spatial integral in Hartree atomic units. You may leave your answer in terms of $\\varphi(\\mathbf{r})$ and $|\\mathbf{r}-\\mathbf{r}'|^{-1}$. No numerical evaluation is required, and no rounding is needed. Express the final energy in Hartree atomic units.", "solution": "This problem requires us to follow four steps to demonstrate how the exact exchange energy cancels the self-interaction error present in the Hartree energy for a simple two-electron system.\n\n**1. Construct the exact-exchange hole $h_{x,\\sigma}(\\mathbf{r},\\mathbf{r}')$**\n\nIn a spin-singlet two-electron system, both electrons occupy the same spatial orbital $\\varphi(\\mathbf{r})$, one with spin up ($\\sigma=\\uparrow$) and one with spin down ($\\sigma=\\downarrow$).\n\nFirst, we construct the spin-resolved one-particle reduced density matrices. For each spin channel, there is only one occupied orbital:\n- Spin-up: $\\gamma_{\\uparrow}(\\mathbf{r},\\mathbf{r}') = \\varphi^{*}(\\mathbf{r})\\varphi(\\mathbf{r}')$\n- Spin-down: $\\gamma_{\\downarrow}(\\mathbf{r},\\mathbf{r}') = \\varphi^{*}(\\mathbf{r})\\varphi(\\mathbf{r}')$\n\nNext, we find the spin-resolved densities by setting $\\mathbf{r}' = \\mathbf{r}$:\n- Spin-up density: $n_{\\uparrow}(\\mathbf{r}) = \\gamma_{\\uparrow}(\\mathbf{r},\\mathbf{r}) = |\\varphi(\\mathbf{r})|^2$\n- Spin-down density: $n_{\\downarrow}(\\mathbf{r}) = \\gamma_{\\downarrow}(\\mathbf{r},\\mathbf{r}) = |\\varphi(\\mathbf{r})|^2$\n\nNow we can use the definition of the exact-exchange hole, $h_{x,\\sigma}(\\mathbf{r},\\mathbf{r}') = -|\\gamma_{\\sigma}(\\mathbf{r},\\mathbf{r}')|^{2} / n_{\\sigma}(\\mathbf{r})$:\n- For spin-up: $h_{x,\\uparrow}(\\mathbf{r},\\mathbf{r}') = -\\frac{|\\varphi^{*}(\\mathbf{r})\\varphi(\\mathbf{r}')|^{2}}{|\\varphi(\\mathbf{r})|^2} = -\\frac{|\\varphi(\\mathbf{r})|^2 |\\varphi(\\mathbf{r}')|^2}{|\\varphi(\\mathbf{r})|^2} = -|\\varphi(\\mathbf{r}')|^2$\n- For spin-down: The calculation is identical, yielding $h_{x,\\downarrow}(\\mathbf{r},\\mathbf{r}') = -|\\varphi(\\mathbf{r}')|^2$\n\nSo, for each spin channel, the exchange hole is the negative of the single-orbital density.\n\n**2. Obtain the exact-exchange energy $E_{x}$**\n\nWe use the provided formula for the exchange energy:\n$$E_{x} = \\frac{1}{2}\\sum_{\\sigma}\\int d^{3}\\mathbf{r}\\,n_{\\sigma}(\\mathbf{r})\\int d^{3}\\mathbf{r}'\\,h_{x,\\sigma}(\\mathbf{r},\\mathbf{r}')\\,v(\\mathbf{r},\\mathbf{r}')$$\nWe sum the contributions from the up and down spins:\n$$E_{x} = \\frac{1}{2} \\int d^{3}\\mathbf{r} \\, n_{\\uparrow}(\\mathbf{r}) \\int d^{3}\\mathbf{r}' \\, h_{x,\\uparrow}(\\mathbf{r},\\mathbf{r}') v(\\mathbf{r},\\mathbf{r}') + \\frac{1}{2} \\int d^{3}\\mathbf{r} \\, n_{\\downarrow}(\\mathbf{r}) \\int d^{3}\\mathbf{r}' \\, h_{x,\\downarrow}(\\mathbf{r},\\mathbf{r}') v(\\mathbf{r},\\mathbf{r}')$$\nSubstituting our results from step 1:\n$$E_{x} = \\frac{1}{2} \\int d^{3}\\mathbf{r} \\, |\\varphi(\\mathbf{r})|^{2} \\int d^{3}\\mathbf{r}' \\, (-|\\varphi(\\mathbf{r}')|^{2}) v(\\mathbf{r},\\mathbf{r}') + \\frac{1}{2} \\int d^{3}\\mathbf{r} \\, |\\varphi(\\mathbf{r})|^{2} \\int d^{3}\\mathbf{r}' \\, (-|\\varphi(\\mathbf{r}')|^{2}) v(\\mathbf{r},\\mathbf{r}')$$\nThe two terms are identical. Combining them and using the Coulomb kernel $v(\\mathbf{r},\\mathbf{r}') = |\\mathbf{r}-\\mathbf{r}'|^{-1}$:\n$$E_{x} = - \\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{|\\varphi(\\mathbf{r})|^{2} |\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|}$$\n\n**3. Compute the Hartree energy $E_{H}$**\n\nThe Hartree energy is the classical electrostatic self-repulsion of the total electron density $n(\\mathbf{r})$.\nThe total density is $n(\\mathbf{r}) = n_{\\uparrow}(\\mathbf{r}) + n_{\\downarrow}(\\mathbf{r}) = 2|\\varphi(\\mathbf{r})|^{2}$.\nThe definition of Hartree energy is:\n$$E_{H} = \\frac{1}{2} \\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{n(\\mathbf{r})n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$$\nSubstituting the total density:\n$$E_{H} = \\frac{1}{2} \\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{(2|\\varphi(\\mathbf{r})|^{2})(2|\\varphi(\\mathbf{r}')|^{2})}{|\\mathbf{r}-\\mathbf{r}'|} = 2 \\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{|\\varphi(\\mathbf{r})|^{2} |\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|}$$\n\n**4. Combine $E_{H}+E_{x}$ and demonstrate cancellation**\n\nWe now add the expressions for $E_H$ and $E_x$:\n$$E_{H}+E_{x} = \\left( 2 \\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{|\\varphi(\\mathbf{r})|^{2} |\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|} \\right) + \\left( - \\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{|\\varphi(\\mathbf{r})|^{2} |\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|} \\right)$$\n$$E_{H}+E_{x} = \\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{|\\varphi(\\mathbf{r})|^{2} |\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|}$$\nThis final expression represents the physical Coulomb interaction between the two electrons. The unphysical self-interaction has been cancelled.\n\nTo see this cancellation explicitly, we can expand the Hartree energy in terms of spin densities:\n$$E_H = \\frac{1}{2}\\iint \\frac{(n_{\\uparrow}(\\mathbf{r})+n_{\\downarrow}(\\mathbf{r}))(n_{\\uparrow}(\\mathbf{r}')+n_{\\downarrow}(\\mathbf{r}'))}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}'$$\n$$E_H = \\underbrace{\\frac{1}{2}\\iint \\frac{n_{\\uparrow}n_{\\uparrow}'}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}'}_{\\text{Up self-interaction}} + \\underbrace{\\frac{1}{2}\\iint \\frac{n_{\\downarrow}n_{\\downarrow}'}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}'}_{\\text{Down self-interaction}} + \\underbrace{\\iint \\frac{n_{\\uparrow}n_{\\downarrow}'}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}'}_{\\text{Up-Down interaction}}$$\nThe exchange energy is the sum of spin-channel contributions, $E_x = E_{x,\\uparrow} + E_{x,\\downarrow}$, where:\n$$E_{x,\\uparrow} = -\\frac{1}{2}\\iint \\frac{n_{\\uparrow}(\\mathbf{r})n_{\\uparrow}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}' \\quad \\text{and} \\quad E_{x,\\downarrow} = -\\frac{1}{2}\\iint \\frac{n_{\\downarrow}(\\mathbf{r})n_{\\downarrow}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}d\\mathbf{r}d\\mathbf{r}'$$\nWhen we sum $E_H + E_x$, the up-spin self-interaction term in $E_H$ is perfectly cancelled by $E_{x,\\uparrow}$, and the down-spin self-interaction term is cancelled by $E_{x,\\downarrow}$. This leaves only the physically correct interaction between the spin-up and spin-down electron densities, which is exactly the final result we obtained.", "answer": "$$\n\\boxed{\\int d^{3}\\mathbf{r} \\int d^{3}\\mathbf{r}' \\frac{|\\varphi(\\mathbf{r})|^{2} |\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|}}\n$$", "id": "2987037"}, {"introduction": "Having explored exact properties in both infinite and finite systems, we now turn to the art and science of building approximations. Since the exact exchange-correlation functional is unknown, we must construct models that are both computationally tractable and physically sound. This exercise delves into the design of Generalized Gradient Approximations (GGAs), showing how we can enforce known exact constraints—like the correct coordinate scaling of the exchange energy and the particle-conservation sum rule for the correlation hole—to guide the construction of more accurate and robust functionals. [@problem_id:2987047]", "problem": "Consider a spin-unpolarized electronic system within Density Functional Theory (DFT). The Generalized Gradient Approximation (GGA) for the exchange energy uses the reduced density gradient and constructs the exchange energy as an integral of a local quantity times an enhancement factor, while GGA correlation models often construct a real-space correlation hole that obeys exact constraints.\n\nYou are given the following definitions and modeling choices:\n- The Fermi wavevector is defined by $k_{F}(\\mathbf{r}) = \\left( 3 \\pi^{2} n(\\mathbf{r}) \\right)^{1/3}$ for an electron density $n(\\mathbf{r})$.\n- The reduced density gradient is $s(\\mathbf{r}) = \\frac{|\\nabla n(\\mathbf{r})|}{2 k_{F}(\\mathbf{r})\\, n(\\mathbf{r})}$.\n- The Local Density Approximation (LDA) exchange energy per particle is $\\varepsilon_{x}^{\\mathrm{LDA}}(n) = -\\frac{3}{4}\\left( \\frac{3}{\\pi} \\right)^{1/3} n^{1/3}$, so that the LDA exchange energy density is $n\\,\\varepsilon_{x}^{\\mathrm{LDA}}(n) \\propto n^{4/3}$.\n- A GGA exchange energy functional is written in the form\n$$\nE_{x}^{\\mathrm{GGA}}[n] = \\int d^{3}r\\, n(\\mathbf{r})\\, \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}))\\, F_{x}(s(\\mathbf{r})),\n$$\nwhere the enhancement factor $F_{x}(s)$ is a dimensionless function of $s$ and contains only dimensionless parameters.\n- The correlation hole $h_{c}(\\mathbf{r},\\mathbf{r}')$ is modeled in an isotropic real-space GGA form as a function of $u = |\\mathbf{r}' - \\mathbf{r}|$ by\n$$\nh_{c}(\\mathbf{r},u) = n(\\mathbf{r})\\left[ A(s(\\mathbf{r}))\\, \\exp(-y) \\;+\\; B(s(\\mathbf{r}))\\, y\\, \\exp(-y) \\right],\n$$\nwith the scaled separation $y = k_{F}(\\mathbf{r})\\, u$, and $A(s)$, $B(s)$ are smooth functions of the reduced gradient $s$.\n\nTasks:\n1. Starting from the uniform coordinate scaling of the density $n_{\\gamma}(\\mathbf{r}) = \\gamma^{3}\\, n(\\gamma\\, \\mathbf{r})$ with a positive scaling parameter $\\gamma$, derive how $k_{F}$, $\\nabla n$, and $s$ transform under this scaling. Then, using only the stated definitions and the structure of $E_{x}^{\\mathrm{GGA}}[n]$, show that $E_{x}^{\\mathrm{GGA}}[n_{\\gamma}] = \\gamma\\, E_{x}^{\\mathrm{GGA}}[n]$ provided $F_{x}$ depends only on $s$ and contains no dimensional parameters. Explain the mathematical steps clearly and completely.\n2. Using the particle-conservation sum rule for the correlation hole,\n$$\n\\int d^{3}r'\\, h_{c}(\\mathbf{r},\\mathbf{r}') \\;=\\; \\int_{0}^{\\infty} 4\\pi u^{2}\\, h_{c}(\\mathbf{r},u)\\, du \\;=\\; 0 \\quad \\text{for all }\\mathbf{r},\n$$\napply the given $h_{c}(\\mathbf{r},u)$ form to derive a constraint between $A(s)$ and $B(s)$ that enforces the sum rule at every point $\\mathbf{r}$. You may treat $A(s)$ and $B(s)$ as arbitrary functions of $s$ subject to this constraint, and you should carry out the integral exactly.\n\nExpress your final answer as a single closed-form analytic expression for $B(s)$ in terms of $A(s)$. No numerical evaluation or rounding is required, and no units should appear in the final answer.", "solution": "### Task 1: Uniform Coordinate Scaling of the GGA Exchange Energy\n\nThe objective of this task is to demonstrate that the Generalized Gradient Approximation (GGA) exchange energy functional, as defined, scales linearly with the scaling parameter $\\gamma$ under uniform coordinate scaling of the electron density. The scaling transformation for the density is given by $n_{\\gamma}(\\mathbf{r}) = \\gamma^{3}\\, n(\\gamma\\, \\mathbf{r})$. We must derive how the constituent parts of the energy expression transform under this scaling.\n\nFirst, let us analyze the scaling of the Fermi wavevector, $k_{F}(\\mathbf{r})$. For the scaled density $n_{\\gamma}(\\mathbf{r})$, the corresponding Fermi wavevector $k_{F, \\gamma}(\\mathbf{r})$ is:\n$$\nk_{F, \\gamma}(\\mathbf{r}) = \\left( 3 \\pi^{2} n_{\\gamma}(\\mathbf{r}) \\right)^{1/3} = \\left( 3 \\pi^{2} \\gamma^{3} n(\\gamma \\mathbf{r}) \\right)^{1/3} = \\gamma \\left( 3 \\pi^{2} n(\\gamma \\mathbf{r}) \\right)^{1/3} = \\gamma\\, k_{F}(\\gamma \\mathbf{r})\n$$\nwhere $k_F(\\gamma\\mathbf{r})$ is the original Fermi wavevector function evaluated at the scaled coordinate $\\gamma\\mathbf{r}$.\n\nNext, we determine the scaling of the gradient of the density, $\\nabla n(\\mathbf{r})$. Using the chain rule for differentiation, where we define a new coordinate variable $\\mathbf{r}' = \\gamma \\mathbf{r}$, the gradient operator with respect to $\\mathbf{r}$ is $\\nabla_{\\mathbf{r}} = \\gamma \\nabla_{\\mathbf{r}'}$.\n$$\n\\nabla n_{\\gamma}(\\mathbf{r}) = \\nabla_{\\mathbf{r}} \\left( \\gamma^{3} n(\\gamma \\mathbf{r}) \\right) = \\gamma^{3} \\nabla_{\\mathbf{r}} n(\\gamma \\mathbf{r})\n$$\nApplying the chain rule:\n$$\n\\nabla_{\\mathbf{r}} n(\\gamma \\mathbf{r}) = \\gamma \\left( \\nabla n \\right)(\\gamma \\mathbf{r})\n$$\nwhere $(\\nabla n)(\\gamma \\mathbf{r})$ is the gradient of the original density function $n$, evaluated at the scaled coordinate $\\gamma\\mathbf{r}$. Substituting this back gives:\n$$\n\\nabla n_{\\gamma}(\\mathbf{r}) = \\gamma^{3} \\left( \\gamma (\\nabla n)(\\gamma \\mathbf{r}) \\right) = \\gamma^{4} (\\nabla n)(\\gamma \\mathbf{r})\n$$\n\nNow we can find the scaling of the reduced density gradient, $s(\\mathbf{r})$. Let $s_{\\gamma}(\\mathbf{r})$ be the reduced gradient for the scaled density $n_{\\gamma}(\\mathbf{r})$.\n$$\ns_{\\gamma}(\\mathbf{r}) = \\frac{|\\nabla n_{\\gamma}(\\mathbf{r})|}{2 k_{F, \\gamma}(\\mathbf{r})\\, n_{\\gamma}(\\mathbf{r})} = \\frac{|\\gamma^{4} (\\nabla n)(\\gamma \\mathbf{r})|}{2 \\left( \\gamma k_{F}(\\gamma \\mathbf{r}) \\right) \\left( \\gamma^{3} n(\\gamma \\mathbf{r}) \\right)} = \\frac{\\gamma^{4} |(\\nabla n)(\\gamma \\mathbf{r})|}{2 \\gamma^{4} k_{F}(\\gamma \\mathbf{r})\\, n(\\gamma \\mathbf{r})}\n$$\nThe factors of $\\gamma^4$ cancel, leaving:\n$$\ns_{\\gamma}(\\mathbf{r}) = \\frac{|(\\nabla n)(\\gamma \\mathbf{r})|}{2 k_{F}(\\gamma \\mathbf{r})\\, n(\\gamma \\mathbf{r})} = s(\\gamma \\mathbf{r})\n$$\nThis shows that the reduced gradient $s$ evaluated for the scaled density at point $\\mathbf{r}$ is equal to the reduced gradient $s$ for the original density evaluated at the scaled point $\\gamma\\mathbf{r}$.\n\nThe Local Density Approximation (LDA) exchange energy per particle, $\\varepsilon_{x}^{\\mathrm{LDA}}(n)$, scales as:\n$$\n\\varepsilon_{x}^{\\mathrm{LDA}}(n_{\\gamma}(\\mathbf{r})) = -\\frac{3}{4}\\left( \\frac{3}{\\pi} \\right)^{1/3} [n_{\\gamma}(\\mathbf{r})]^{1/3} = -\\frac{3}{4}\\left( \\frac{3}{\\pi} \\right)^{1/3} [\\gamma^{3} n(\\gamma \\mathbf{r})]^{1/3} = \\gamma \\left( -\\frac{3}{4}\\left( \\frac{3}{\\pi} \\right)^{1/3} [n(\\gamma \\mathbf{r})]^{1/3} \\right) = \\gamma\\, \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\gamma \\mathbf{r}))\n$$\n\nNow we assemble these pieces into the expression for $E_{x}^{\\mathrm{GGA}}[n_{\\gamma}]$:\n$$\nE_{x}^{\\mathrm{GGA}}[n_{\\gamma}] = \\int d^{3}r\\, n_{\\gamma}(\\mathbf{r})\\, \\varepsilon_{x}^{\\mathrm{LDA}}(n_{\\gamma}(\\mathbf{r}))\\, F_{x}(s_{\\gamma}(\\mathbf{r}))\n$$\nSubstituting the scaling relations we derived:\n$$\nE_{x}^{\\mathrm{GGA}}[n_{\\gamma}] = \\int d^{3}r\\, \\left( \\gamma^{3} n(\\gamma \\mathbf{r}) \\right) \\left( \\gamma\\, \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\gamma\\mathbf{r})) \\right) F_{x}(s(\\gamma \\mathbf{r})) = \\int d^{3}r\\, \\gamma^{4} n(\\gamma \\mathbf{r})\\, \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\gamma\\mathbf{r}))\\, F_{x}(s(\\gamma \\mathbf{r}))\n$$\nTo evaluate this integral, we perform a change of variables in the integration. Let $\\mathbf{r}' = \\gamma \\mathbf{r}$. This implies $\\mathbf{r} = \\mathbf{r}'/\\gamma$ and the volume element transforms as $d^{3}r = d^{3}r' / \\gamma^{3}$.\n$$\nE_{x}^{\\mathrm{GGA}}[n_{\\gamma}] = \\int \\frac{d^{3}r'}{\\gamma^{3}}\\, \\gamma^{4} n(\\mathbf{r}')\\, \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}'))\\, F_{x}(s(\\mathbf{r}'))\n$$\nThe factor $\\gamma^{4}/\\gamma^{3}$ simplifies to $\\gamma$. We can pull this constant factor out of the integral.\n$$\nE_{x}^{\\mathrm{GGA}}[n_{\\gamma}] = \\gamma \\int d^{3}r'\\, n(\\mathbf{r}')\\, \\varepsilon_{x}^{\\mathrm{LDA}}(n(\\mathbf{r}'))\\, F_{x}(s(\\mathbf{r}'))\n$$\nThe remaining integral is, by definition, the exchange energy of the original density, $E_{x}^{\\mathrm{GGA}}[n]$. Therefore, we have proven the desired scaling relation:\n$$\nE_{x}^{\\mathrm{GGA}}[n_{\\gamma}] = \\gamma\\, E_{x}^{\\mathrm{GGA}}[n]\n$$\nThis result is contingent on the GGA form where the enhancement factor $F_x$ is a function only of the dimensionless reduced gradient $s$ and contains no dimensionful parameters.\n\n### Task 2: Correlation Hole Sum Rule Constraint\n\nThe second task is to derive a relationship between the functions $A(s)$ and $B(s)$ by enforcing the particle-conservation sum rule for the correlation hole, $h_{c}$. The sum rule states that the integral of the correlation hole over all space must be zero at every reference point $\\mathbf{r}$.\n$$\n\\int d^{3}r'\\, h_{c}(\\mathbf{r},\\mathbf{r}') \\;=\\; 0 \\quad \\text{for all }\\mathbf{r}\n$$\nGiven the isotropic form $h_{c}(\\mathbf{r},u)$ where $u = |\\mathbf{r}' - \\mathbf{r}|$, this integral becomes:\n$$\n\\int_{0}^{\\infty} 4\\pi u^{2}\\, h_{c}(\\mathbf{r},u)\\, du \\;=\\; 0\n$$\nWe are given the model for the correlation hole:\n$$\nh_{c}(\\mathbf{r},u) = n(\\mathbf{r})\\left[ A(s(\\mathbf{r}))\\, \\exp(-y) \\;+\\; B(s(\\mathbf{r}))\\, y\\, \\exp(-y) \\right]\n$$\nwith $y = k_{F}(\\mathbf{r})\\, u$. At a fixed point $\\mathbf{r}$, the quantities $n(\\mathbf{r})$, $s(\\mathbf{r})$, $k_{F}(\\mathbf{r})$, $A(s(\\mathbf{r}))$, and $B(s(\\mathbf{r}))$ are constants with respect to the integration variable $u$. Let's substitute the model into the sum rule integral:\n$$\n\\int_{0}^{\\infty} 4\\pi u^{2}\\, n(\\mathbf{r})\\left[ A(s)\\, \\exp(-k_{F} u) \\;+\\; B(s)\\, (k_{F} u)\\, \\exp(-k_{F} u) \\right] du = 0\n$$\nFor brevity, we write $A(s)$ for $A(s(\\mathbf{r}))$, etc. Since the sum rule must hold for any non-zero density $n(\\mathbf{r}) \\ne 0$, we can divide out the factor $4\\pi n(\\mathbf{r})$:\n$$\n\\int_{0}^{\\infty} u^{2}\\left[ A(s)\\, \\exp(-k_{F} u) \\;+\\; B(s)\\, k_{F} u\\, \\exp(-k_{F} u) \\right] du = 0\n$$\nWe can separate this into two integrals:\n$$\nA(s) \\int_{0}^{\\infty} u^{2} \\exp(-k_{F} u) du + B(s) k_{F} \\int_{0}^{\\infty} u^{3} \\exp(-k_{F} u) du = 0\n$$\nThese are standard integrals of the form of the Gamma function, $\\int_{0}^{\\infty} x^{n} \\exp(-ax) dx = \\frac{n!}{a^{n+1}}$.\nFor the first integral, we have $n=2$ and $a=k_{F}$:\n$$\n\\int_{0}^{\\infty} u^{2} \\exp(-k_{F} u) du = \\frac{2!}{k_{F}^{2+1}} = \\frac{2}{k_{F}^{3}}\n$$\nFor the second integral, we have $n=3$ and $a=k_{F}$:\n$$\n\\int_{0}^{\\infty} u^{3} \\exp(-k_{F} u) du = \\frac{3!}{k_{F}^{3+1}} = \\frac{6}{k_{F}^{4}}\n$$\nSubstituting these results back into our equation:\n$$\nA(s) \\left( \\frac{2}{k_{F}^{3}} \\right) + B(s) k_{F} \\left( \\frac{6}{k_{F}^{4}} \\right) = 0\n$$\nSimplifying the second term:\n$$\n\\frac{2 A(s)}{k_{F}^{3}} + \\frac{6 B(s)}{k_{F}^{3}} = 0\n$$\nSince $k_{F} = (3\\pi^2 n)^{1/3}$ is non-zero for any physical system, we can multiply the entire equation by $k_{F}^{3}/2$:\n$$\nA(s) + 3 B(s) = 0\n$$\nFinally, we solve for $B(s)$ in terms of $A(s)$ to find the required constraint:\n$$\nB(s) = -\\frac{1}{3} A(s)\n$$\nThis relationship ensures that the model for the correlation hole satisfies the zero-sum rule for all values of the reduced gradient $s$.", "answer": "$$\n\\boxed{B(s) = -\\frac{1}{3}A(s)}\n$$", "id": "2987047"}]}