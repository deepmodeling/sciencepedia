{"hands_on_practices": [{"introduction": "The replica trick, with its prescription of analytic continuation from integer replica numbers $n$ to the limit $n \\to 0$, can seem mysterious at first. To build intuition and confidence in this powerful tool, we begin with an exactly solvable zero-dimensional toy model where the quenched average can be computed without approximation. This exercise [@problem_id:3020431] allows you to perform every step of the replica method on the random partition function $Z_J(a)$, focusing purely on the mathematical mechanics of calculating the quenched average logarithm $\\mathbb{E}_J[\\ln Z_J(a)]$ and seeing how analytic continuation yields a precise result.", "problem": "Consider a zero-dimensional toy model of a disordered magnet defined by the random partition function\n$$\nZ_J(a) \\equiv \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{a}{2}x^{2} + J x\\right)\\,dx,\n$$\nwhere $a>0$ is a control parameter and $J$ is a Gaussian random variable with zero mean and variance $\\Delta>0$, that is, $J \\sim \\mathcal{N}(0,\\Delta)$. The quenched averaged log-partition-function is defined as $\\mathbb{E}_J[\\ln Z_J(a)]$, where $\\mathbb{E}_J[\\cdot]$ denotes the average over the disorder.\n\nUsing the replica method as the foundational definition of the quenched average, proceed as follows: for integer $n \\ge 1$ evaluate $\\mathbb{E}_J[Z_J(a)^{n}]$ exactly; identify the open domain in real $n$ containing $n=0$ where the result admits an analytic continuation; then extract $\\mathbb{E}_J[\\ln Z_J(a)]$ from the analytic continuation as $n \\to 0$.\n\nYour final answer must be a single closed-form analytic expression in terms of $a$ and $\\Delta$. Do not introduce any additional parameters. Express the answer without units.", "solution": "The problem requires the calculation of the quenched averaged log-partition-function, $\\mathbb{E}_J[\\ln Z_J(a)]$, for a zero-dimensional disordered system using the replica method. The procedure, as specified, involves three main steps: first, calculating the disorder-averaged replicated partition function $\\mathbb{E}_J[Z_J(a)^n]$ for integer $n \\ge 1$; second, performing an analytic continuation of this result to real $n$; and third, taking the limit as $n \\to 0$ according to the replica formula.\n\nStep 1: Evaluation of the partition function $Z_J(a)$.\nThe partition function $Z_J(a)$ for a fixed realization of the disorder $J$ is given by the Gaussian integral:\n$$\nZ_J(a) = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{a}{2}x^{2} + J x\\right)\\,dx\n$$\nTo evaluate this integral, we complete the square in the exponent. The argument of the exponential is:\n$$\n-\\frac{a}{2}x^{2} + J x = -\\frac{a}{2}\\left(x^2 - \\frac{2J}{a}x\\right) = -\\frac{a}{2}\\left[\\left(x - \\frac{J}{a}\\right)^2 - \\left(\\frac{J}{a}\\right)^2\\right] = -\\frac{a}{2}\\left(x - \\frac{J}{a}\\right)^2 + \\frac{J^2}{2a}\n$$\nSubstituting this back into the integral, we get:\n$$\nZ_J(a) = \\int_{-\\infty}^{\\infty} \\exp\\left[-\\frac{a}{2}\\left(x - \\frac{J}{a}\\right)^2 + \\frac{J^2}{2a}\\right]\\,dx = \\exp\\left(\\frac{J^2}{2a}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left[-\\frac{a}{2}\\left(x - \\frac{J}{a}\\right)^2\\right]\\,dx\n$$\nLet $y = x - J/a$, so $dy = dx$. The integral becomes a standard Gaussian integral:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{a}{2}y^2\\right)\\,dy = \\sqrt{\\frac{2\\pi}{a}}\n$$\nThis is valid since the problem states $a > 0$. Therefore, the partition function for a given $J$ is:\n$$\nZ_J(a) = \\sqrt{\\frac{2\\pi}{a}} \\exp\\left(\\frac{J^2}{2a}\\right)\n$$\n\nStep 2: Calculation of the averaged replicated partition function $\\mathbb{E}_J[Z_J(a)^n]$.\nFor an integer $n \\ge 1$, the $n$-th power of the partition function is:\n$$\nZ_J(a)^n = \\left[\\sqrt{\\frac{2\\pi}{a}} \\exp\\left(\\frac{J^2}{2a}\\right)\\right]^n = \\left(\\frac{2\\pi}{a}\\right)^{n/2} \\exp\\left(\\frac{n J^2}{2a}\\right)\n$$\nNext, we average this quantity over the disorder $J$. The variable $J$ is drawn from a Gaussian distribution $P(J)$ with zero mean and variance $\\Delta$:\n$$\nP(J) = \\frac{1}{\\sqrt{2\\pi\\Delta}} \\exp\\left(-\\frac{J^2}{2\\Delta}\\right)\n$$\nThe expectation value $\\mathbb{E}_J[Z_J(a)^n]$ is given by the integral:\n$$\n\\mathbb{E}_J[Z_J(a)^n] = \\int_{-\\infty}^{\\infty} Z_J(a)^n P(J) \\,dJ = \\int_{-\\infty}^{\\infty} \\left(\\frac{2\\pi}{a}\\right)^{n/2} \\exp\\left(\\frac{n J^2}{2a}\\right) \\frac{1}{\\sqrt{2\\pi\\Delta}} \\exp\\left(-\\frac{J^2}{2\\Delta}\\right) \\,dJ\n$$\nCombining the constant terms and the exponents, we have:\n$$\n\\mathbb{E}_J[Z_J(a)^n] = \\frac{1}{\\sqrt{2\\pi\\Delta}} \\left(\\frac{2\\pi}{a}\\right)^{n/2} \\int_{-\\infty}^{\\infty} \\exp\\left[\\left(\\frac{n}{2a} - \\frac{1}{2\\Delta}\\right)J^2\\right] \\,dJ\n$$\nThe term in the exponent is:\n$$\n\\left(\\frac{n}{2a} - \\frac{1}{2\\Delta}\\right)J^2 = -\\left(\\frac{1}{2\\Delta} - \\frac{n}{2a}\\right)J^2 = -\\left(\\frac{a - n\\Delta}{2a\\Delta}\\right)J^2\n$$\nThe integral is another Gaussian integral, which converges if the coefficient of $J^2$ is negative. This requires $a - n\\Delta > 0$, or $n < a/\\Delta$. The integral evaluates to:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left[-\\left(\\frac{a - n\\Delta}{2a\\Delta}\\right)J^2\\right] \\,dJ = \\sqrt{\\frac{\\pi}{\\frac{a - n\\Delta}{2a\\Delta}}} = \\sqrt{\\frac{2\\pi a\\Delta}{a - n\\Delta}}\n$$\nSubstituting this result back into the expression for the expectation value:\n$$\n\\mathbb{E}_J[Z_J(a)^n] = \\frac{1}{\\sqrt{2\\pi\\Delta}} \\left(\\frac{2\\pi}{a}\\right)^{n/2} \\sqrt{\\frac{2\\pi a\\Delta}{a - n\\Delta}} = \\left(\\frac{2\\pi}{a}\\right)^{n/2} \\sqrt{\\frac{a}{a - n\\Delta}}\n$$\nThis can be rewritten as:\n$$\n\\mathbb{E}_J[Z_J(a)^n] = \\left(\\frac{2\\pi}{a}\\right)^{n/2} \\left(1 - \\frac{n\\Delta}{a}\\right)^{-1/2}\n$$\nThis expression, derived for integer $n \\ge 1$, provides the analytic continuation to real values of $n$. The continuation is well-defined in the open domain $n \\in (-\\infty, a/\\Delta)$. Since $a>0$ and $\\Delta>0$, this domain contains $n=0$.\n\nStep 3: Application of the replica formula.\nThe replica method defines the quenched averaged log-partition-function as the limit:\n$$\n\\mathbb{E}_J[\\ln Z_J(a)] = \\lim_{n \\to 0} \\frac{\\mathbb{E}_J[Z_J(a)^n] - 1}{n}\n$$\nLet $f(n) = \\mathbb{E}_J[Z_J(a)^n]$. At $n=0$, $f(0) = (2\\pi/a)^0 (1-0)^{-1/2} = 1$. The limit is of the indeterminate form $0/0$, so we can evaluate it by finding the derivative $f'(0)$. Alternatively, we can use a Taylor series expansion of $f(n)$ around $n=0$.\nThe two factors in $f(n)$ are expanded as:\n$$\n\\left(\\frac{2\\pi}{a}\\right)^{n/2} = \\exp\\left(\\frac{n}{2} \\ln\\left(\\frac{2\\pi}{a}\\right)\\right) = 1 + \\frac{n}{2} \\ln\\left(\\frac{2\\pi}{a}\\right) + O(n^2)\n$$\nand using the generalized binomial theorem $(1+x)^\\alpha \\approx 1+\\alpha x$ for small $x$:\n$$\n\\left(1 - \\frac{n\\Delta}{a}\\right)^{-1/2} = 1 + \\left(-\\frac{1}{2}\\right)\\left(-\\frac{n\\Delta}{a}\\right) + O(n^2) = 1 + \\frac{n\\Delta}{2a} + O(n^2)\n$$\nMultiplying these two expansions gives:\n$$\nf(n) = \\left(1 + \\frac{n}{2} \\ln\\left(\\frac{2\\pi}{a}\\right)\\right) \\left(1 + \\frac{n\\Delta}{2a}\\right) + O(n^2)\n$$\n$$\nf(n) = 1 + \\frac{n\\Delta}{2a} + \\frac{n}{2} \\ln\\left(\\frac{2\\pi}{a}\\right) + O(n^2)\n$$\nNow we can compute the limit:\n$$\n\\mathbb{E}_J[\\ln Z_J(a)] = \\lim_{n \\to 0} \\frac{\\left[1 + n\\left(\\frac{\\Delta}{2a} + \\frac{1}{2} \\ln\\left(\\frac{2\\pi}{a}\\right)\\right) + O(n^2)\\right] - 1}{n}\n$$\n$$\n\\mathbb{E}_J[\\ln Z_J(a)] = \\lim_{n \\to 0} \\left[\\frac{\\Delta}{2a} + \\frac{1}{2} \\ln\\left(\\frac{2\\pi}{a}\\right) + O(n)\\right]\n$$\n$$\n\\mathbb{E}_J[\\ln Z_J(a)] = \\frac{\\Delta}{2a} + \\frac{1}{2} \\ln\\left(\\frac{2\\pi}{a}\\right)\n$$\nThis is the final closed-form expression for the quenched averaged log-partition-function.", "answer": "$$\\boxed{\\frac{\\Delta}{2a} + \\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a}\\right)}$$", "id": "3020431"}, {"introduction": "Armed with a grasp of the replica method's mechanics, we now tackle its canonical application: the fully-connected Sherrington-Kirkpatrick (SK) model of a spin glass. This practice [@problem_id:3020430] guides you through the complete derivation of the replica-symmetric (RS) free energy, a cornerstone of mean-field spin glass theory. You will see how disorder averaging couples the replicas and how the Hubbard-Stratonovich transformation and a saddle-point approximation allow the system's thermodynamics to be expressed in terms of the physical order parameter $q$, which measures the similarity between different equilibrium states.", "problem": "Consider the fully connected Sherrington–Kirkpatrick (SK) model of an Ising spin glass, defined by the Hamiltonian $H[\\boldsymbol{s}] = -\\sum_{1 \\leq i < j \\leq N} J_{ij} s_i s_j$ with spins $s_i \\in \\{-1,+1\\}$ and independent, identically distributed quenched couplings $J_{ij}$ drawn from a Gaussian distribution of mean $0$ and variance $J^2/N$. Let the inverse temperature be $\\beta = 1/T$, and set the Boltzmann constant to $k_B = 1$. The disorder-averaged (quenched) free-energy density is $f(\\beta,J) = -\\frac{1}{\\beta N} \\mathbb{E}_{J} \\ln Z[J]$, where the partition function is $Z[J] = \\sum_{\\{s_i\\}} \\exp\\!\\left(\\beta \\sum_{i<j} J_{ij} s_i s_j\\right)$ and $\\mathbb{E}_J[\\cdot]$ denotes the average over the disorder.\n\nStarting from the replica trick identity $\\ln Z = \\lim_{n \\to 0} \\frac{Z^n - 1}{n}$ and using only standard properties of Gaussian integrals and large-$N$ saddle-point methods, compute the disorder-averaged free-energy density under the Replica Symmetric (RS) Ansatz in zero external field. In the RS Ansatz, the overlap matrix $q_{ab} \\equiv \\frac{1}{N} \\sum_{i=1}^{N} s_i^{a} s_i^{b}$ satisfies $q_{aa} = 1$ and $q_{ab} = q$ for $a \\neq b$, with $a,b \\in \\{1,\\dots,n\\}$ labeling replicas.\n\nDerive the explicit RS free-energy density $f_{\\mathrm{RS}}(\\beta,J;q)$ in closed analytical form. Your final expression must be written as a function of $\\beta$, $J$, and $q$ and may involve the standard normal Gaussian measure $\\mathcal{D}z \\equiv \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}} \\exp(-z^2/2)$. Do not assume or quote any formula for $f_{\\mathrm{RS}}$; obtain it from first principles as specified. Express your final answer as a single closed-form analytic expression. No rounding is required, and no units should be included in the final answer.", "solution": "The objective is to compute the replica-symmetric (RS) free-energy density for the Sherrington-Kirkpatrick (SK) model. The disorder-averaged free-energy density is given by $f = -\\frac{1}{\\beta N} \\mathbb{E}_{J} \\ln Z[J]$, where $\\mathbb{E}_J$ denotes the average over the quenched random couplings $J_{ij}$. We employ the replica trick, which uses the identity $\\ln Z = \\lim_{n \\to 0} \\frac{Z^n - 1}{n}$. The calculation of the free energy then requires computing the disorder-averaged replicated partition function, $\\mathbb{E}_{J}[Z^n]$.\n\nStep 1: Write down $\\mathbb{E}_{J}[Z^n]$.\nThe partition function for a given realization of the disorder is $Z[J] = \\sum_{\\{s_i\\}} \\exp\\left(\\beta \\sum_{1 \\leq i < j \\leq N} J_{ij} s_i s_j\\right)$.\nThe $n$-th power of the partition function involves $n$ copies (replicas) of the system, indexed by $a=1, \\dots, n$.\n$$Z[J]^n = \\left(\\sum_{\\{s_i\\}} \\exp\\left(\\beta \\sum_{i<j} J_{ij} s_i s_j\\right)\\right)^n = \\sum_{\\{s_i^1\\}} \\dots \\sum_{\\{s_i^n\\}} \\exp\\left(\\beta \\sum_{a=1}^n \\sum_{i<j} J_{ij} s_i^a s_j^a\\right)$$\nWe can swap the sums and the product over replicas:\n$$Z[J]^n = \\sum_{\\{s_i^a\\}} \\exp\\left(\\beta \\sum_{i<j} J_{ij} \\sum_{a=1}^n s_i^a s_j^a\\right)$$\nNow we take the average over the disorder. Since the couplings $J_{ij}$ are independent for each pair $(i,j)$, the average can be brought inside the product over pairs.\n$$\\mathbb{E}_J[Z^n] = \\sum_{\\{s_i^a\\}} \\prod_{i<j} \\mathbb{E}_{J_{ij}}\\left[\\exp\\left(\\beta J_{ij} \\sum_{a=1}^n s_i^a s_j^a\\right)\\right]$$\n\nStep 2: Perform the Gaussian average over $J_{ij}$.\nThe couplings $J_{ij}$ are drawn from a Gaussian distribution with mean $0$ and variance $J^2/N$. For a Gaussian variable $x$ with mean $\\mu$ and variance $\\sigma^2$, the identity $\\mathbb{E}[\\exp(kx)] = \\exp(k\\mu + \\frac{1}{2}k^2\\sigma^2)$ holds. Here, $x=J_{ij}$, $\\mu=0$, $\\sigma^2 = J^2/N$, and $k = \\beta \\sum_a s_i^a s_j^a$.\n$$\\mathbb{E}_{J_{ij}}\\left[\\exp\\left(\\beta J_{ij} \\sum_{a=1}^n s_i^a s_j^a\\right)\\right] = \\exp\\left( \\frac{1}{2} \\left(\\beta \\sum_{a=1}^n s_i^a s_j^a\\right)^2 \\frac{J^2}{N} \\right) = \\exp\\left( \\frac{(\\beta J)^2}{2N} \\left(\\sum_{a=1}^n s_i^a s_j^a\\right)^2 \\right)$$\nSubstituting this back, we get:\n$$\\mathbb{E}_J[Z^n] = \\sum_{\\{s_i^a\\}} \\exp\\left( \\frac{(\\beta J)^2}{2N} \\sum_{i<j} \\left(\\sum_{a=1}^n s_i^a s_j^a\\right)^2 \\right)$$\n\nStep 3: Introduce the overlap matrix $q_{ab}$.\nThe term in the exponent couples four spins across two sites. We simplify this.\n$$\\left(\\sum_{a=1}^n s_i^a s_j^a\\right)^2 = \\sum_{a,b=1}^n (s_i^a s_j^a)(s_i^b s_j^b) = \\sum_{a,b=1}^n (s_i^a s_i^b)(s_j^a s_j^b)$$\nIn the large $N$ limit, we can approximate the sum $\\sum_{i<j} \\approx \\frac{1}{2}\\sum_{i \\neq j}$.\nThe exponent becomes $\\frac{(\\beta J)^2}{4N} \\sum_{i \\neq j} \\sum_{a,b} (s_i^a s_i^b)(s_j^a s_j^b) = \\frac{(\\beta J)^2}{4N} \\sum_{a,b} \\left[ \\left(\\sum_i s_i^a s_i^b\\right)^2 - \\sum_i (s_i^a s_i^b)^2 \\right]$.\nSince $s_i \\in \\{-1,1\\}$, $(s_i^a s_i^b)^2 = 1$. The second term is $\\sum_i 1 = N$. So we have $\\sum_i (s_i^a s_i^b)^2 = N$.\nLet's define the replica overlap matrix $q_{ab} \\equiv \\frac{1}{N} \\sum_{i=1}^N s_i^a s_i^b$. The diagonal elements are $q_{aa}=\\frac{1}{N}\\sum_i (s_i^a)^2 = 1$.\nThe term $\\left(\\sum_i s_i^a s_i^b\\right)^2$ becomes $(N q_{ab})^2 = N^2 q_{ab}^2$.\nThe exponent is $\\frac{(\\beta J)^2}{4N} \\sum_{a,b} (N^2 q_{ab}^2 - N) = \\frac{N(\\beta J)^2}{4} \\sum_{a,b} q_{ab}^2 - \\frac{Nn^2(\\beta J)^2}{4}$.\nThe replicated partition function now depends on the configuration $\\{s_i^a\\}$ only through the $q_{ab}$ matrix.\n\nStep 4: Use the saddle-point method.\nWe can express $\\mathbb{E}_J[Z^n]$ by integrating over all possible values of the overlap matrix elements $q_{ab}$ for $a<b$, enforcing their definition with delta functions.\n$$\\mathbb{E}_J[Z^n] = \\int \\left(\\prod_{a<b} \\mathrm{d}q_{ab}\\right) e^{\\frac{N(\\beta J)^2}{4} \\left(\\sum_a q_{aa}^2 + 2\\sum_{a<b}q_{ab}^2\\right)-\\frac{N n^2 (\\beta J)^2}{4}} \\sum_{\\{s_i^a\\}} \\prod_{a<b}\\delta\\left(q_{ab}-\\frac{1}{N}\\sum_i s_i^a s_i^b\\right)$$\nUsing $q_{aa}=1$, we have $\\sum_a q_{aa}^2=n$. Using the integral representation of the delta function with conjugate variables $\\hat{q}_{ab}$, and reorganizing, we arrive at an expression of the form $\\mathbb{E}_J[Z^n] = \\int \\mathcal{D}q \\mathcal{D}\\hat{q} \\exp(N \\cdot S[q,\\hat{q}])$. In the large $N$ limit, this integral is dominated by its saddle point. The saddle-point action (or free energy functional) is found to be:\n$$S_n(\\{q_{ab}\\}) = -\\frac{(\\beta J)^2}{2} \\sum_{a<b} q_{ab}^2 + \\frac{(\\beta J)^2}{4}(n-n^2) + \\ln \\mathrm{Tr}_{\\{s^a\\}} \\exp\\left((\\beta J)^2 \\sum_{a<b} q_{ab} s^a s^b\\right)$$\nwhere $\\mathrm{Tr}_{\\{s^a\\}}$ denotes the sum over the $2^n$ states of a single-site replica vector $(s^1, \\dots, s^n)$.\n\nStep 5: Apply the Replica-Symmetric (RS) ansatz.\nThe RS ansatz assumes that all off-diagonal elements of the overlap matrix are equal: $q_{ab} = q$ for all $a \\neq b$.\nThere are $n(n-1)/2$ such pairs.\nSubstituting this into the action:\n$$\\sum_{a<b} q_{ab}^2 = \\frac{n(n-1)}{2} q^2 \\quad \\text{and} \\quad \\sum_{a<b} q_{ab} s^a s^b = q \\sum_{a<b} s^a s^b = \\frac{q}{2}\\left[\\left(\\sum_a s^a\\right)^2 - \\sum_a(s^a)^2\\right] = \\frac{q}{2}\\left[\\left(\\sum_a s^a\\right)^2 - n\\right]$$\nThe action under the RS ansatz becomes:\n$$S_{RS}(q) = -\\frac{(\\beta J)^2}{4} n(n-1) q^2 + \\frac{(\\beta J)^2}{4}(n-n^2) + \\ln \\mathrm{Tr}_{\\{s^a\\}} \\exp\\left(\\frac{(\\beta J)^2 q}{2}\\left(\\left(\\sum_a s^a\\right)^2 - n\\right)\\right)$$\n$$S_{RS}(q) = \\frac{(\\beta J)^2}{4}(n-n^2)(1+q^2) - \\frac{n(\\beta J)^2 q}{2} + \\ln \\mathrm{Tr}_{\\{s^a\\}} \\exp\\left(\\frac{(\\beta J)^2 q}{2}\\left(\\sum_a s^a\\right)^2\\right)$$\n\nStep 6: Evaluate the trace with a second Hubbard-Stratonovich transformation.\nWe evaluate the trace term using the Gaussian identity $\\exp(\\frac{A}{2}X^2) = \\int \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}} \\exp(-\\frac{z^2}{2} + \\sqrt{A} z X)$, with $A=(\\beta J)^2q$ and $X=\\sum_a s^a$.\n$$\\mathrm{Tr}_{\\{s^a\\}} \\exp\\left(\\frac{(\\beta J)^2 q}{2}\\left(\\sum_a s^a\\right)^2\\right) = \\mathrm{Tr}_{\\{s^a\\}} \\int \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}}e^{-z^2/2} \\exp\\left(\\beta J \\sqrt{q} z \\sum_a s^a\\right)$$\nInterchanging trace and integral, the trace decouples over replicas:\n$$ \\int \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}}e^{-z^2/2} \\prod_{a=1}^n \\sum_{s^a=\\pm 1} \\exp(\\beta J \\sqrt{q} z s^a) = \\int \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}}e^{-z^2/2} \\left[2 \\cosh(\\beta J \\sqrt{q} z)\\right]^n$$\nThe logarithm of this trace term is $\\ln \\int \\mathcal{D}z \\exp(n \\ln(2\\cosh(\\beta J \\sqrt{q} z)))$, where $\\mathcal{D}z = \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}} \\exp(-z^2/2)$.\n\nStep 7: Take the $n \\to 0$ limit to find the free energy.\nThe disorder-averaged free-energy density is $f = -\\frac{1}{\\beta N} \\lim_{n \\to 0} \\frac{\\mathbb{E}_J[Z^n] - 1}{n}$. In the large $N$ saddle-point approximation, $\\mathbb{E}_J[Z^n] \\approx e^{N S_{RS}(q)}$. For small $n$, $S_{RS}(q)$ is of order $n$, so $e^{N S_{RS}(q)} \\approx 1+N S_{RS}(q)$.\nThus, $f \\approx -\\frac{1}{\\beta N} \\frac{N S_{RS}(q)}{n} = -\\frac{1}{\\beta} \\lim_{n \\to 0} \\frac{S_{RS}(q)}{n}$.\nWe compute the limit of each term in $S_{RS}(q)/n$:\n$$\\lim_{n\\to 0} \\frac{S_{RS}(q)}{n} = \\lim_{n\\to 0} \\left[ \\frac{(\\beta J)^2}{4}(1-n)(1+q^2) - \\frac{(\\beta J)^2 q}{2} + \\frac{1}{n}\\ln \\int \\mathcal{D}z e^{n \\ln(2\\cosh(\\beta J \\sqrt{q} z))} \\right]$$\nThe limit of the algebraic terms is $\\frac{(\\beta J)^2}{4}(1+q^2) - \\frac{(\\beta J)^2 q}{2} = \\frac{(\\beta J)^2}{4}(1-q)^2$.\nFor the logarithmic term, since $\\int \\mathcal{D}z=1$, we use $\\lim_{n \\to 0} \\frac{1}{n} \\ln \\langle e^{nA} \\rangle_z = \\langle A \\rangle_z$:\n$$\\lim_{n\\to 0} \\frac{1}{n} \\ln \\int \\mathcal{D}z e^{n \\ln(2\\cosh(\\dots))} = \\int \\mathcal{D}z \\ln(2\\cosh(\\beta J \\sqrt{q} z))$$\nCombining these results:\n$$\\lim_{n \\to 0} \\frac{S_{RS}(q)}{n} = \\frac{(\\beta J)^2}{4}(1-q)^2 + \\int \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}} e^{-z^2/2} \\ln(2\\cosh(\\beta J \\sqrt{q} z))$$\nFinally, we obtain the RS free-energy density:\n$$f_{\\mathrm{RS}}(\\beta,J;q) = -\\frac{1}{\\beta} \\left[ \\frac{(\\beta J)^2}{4}(1-q)^2 + \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) \\ln\\left(2 \\cosh\\left(\\beta J \\sqrt{q} z\\right)\\right) \\right]$$\n$$f_{\\mathrm{RS}}(\\beta,J;q) = -\\frac{\\beta J^2}{4}(1-q)^2 - \\frac{1}{\\beta} \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) \\ln\\left(2 \\cosh\\left(\\beta J \\sqrt{q} z\\right)\\right)$$\nThis is the desired expression for the Replica Symmetric free-energy density as a function of $\\beta$, $J$, and the order parameter $q$. The value of $q$ for a given temperature and coupling strength is determined by extremizing this functional, i.e., by solving $\\partial f_{\\mathrm{RS}}/\\partial q = 0$.", "answer": "$$\n\\boxed{-\\frac{\\beta J^2}{4}(1-q)^2 - \\frac{1}{\\beta} \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}z}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) \\ln\\left(2 \\cosh\\left(\\beta J \\sqrt{q} z\\right)\\right)}\n$$", "id": "3020430"}, {"introduction": "The Replica Symmetric (RS) solution provides an elegant description of the spin glass transition, but is it physically correct at all temperatures? This practice challenges you to investigate the stability of the RS paramagnetic phase, a critical step that historically revealed the theory's incompleteness and the profound nature of the spin glass state. By analyzing the fluctuations of the overlap matrix around the RS saddle point [@problem_id:3020435], you will identify the 'replicon' eigenmode and derive the famous de Almeida–Thouless (AT) line, which marks the boundary where replica symmetry is broken.", "problem": "Consider the Sherrington–Kirkpatrick (SK) model of a spin glass with Hamiltonian $H = -\\sum_{1 \\leq i<j \\leq N} J_{ij} \\sigma_i \\sigma_j - h \\sum_{i=1}^{N} \\sigma_i$, where $\\sigma_i \\in \\{-1,+1\\}$ are Ising spins and the quenched couplings $J_{ij}$ are independent and identically distributed Gaussian random variables with mean $0$ and variance $\\mathbb{E}[J_{ij}^{2}] = J^{2}/N$. Work in units with Boltzmann constant $k_{B} = 1$, so that the inverse temperature is $\\beta = 1/T$. Using the replica method, the disorder-averaged free energy is obtained via $\\overline{\\ln Z} = \\lim_{n \\to 0} \\frac{\\overline{Z^{n}} - 1}{n}$, where $Z = \\sum_{\\{\\sigma\\}} \\exp(-\\beta H)$ and the overline denotes the average over $J_{ij}$. Focus on the replica-symmetric (RS) paramagnetic saddle in zero external field $h=0$, characterized by vanishing off-diagonal overlap $q_{ab} = \\frac{1}{N}\\sum_{i} \\sigma_{i}^{a} \\sigma_{i}^{b} = 0$ for $a \\neq b$. \n\nStarting from the replicated, disorder-averaged partition function in zero field and introducing the overlap variables by a Hubbard–Stratonovich decoupling, perform a stability analysis of the RS paramagnetic saddle by computing the Hessian of the replicated action with respect to the off-diagonal overlaps $q_{ab}$ at $q_{ab}=0$. Identify the “replicon” eigenmode and derive its eigenvalue $\\lambda_{R}(T)$ in terms of fundamental single-site spin correlations under the effective RS single-site measure. Then, by enforcing the marginal stability condition for the de Almeida–Thouless (AT) line, $\\lambda_{R}(T_{\\mathrm{AT}})=0$, determine the zero-field AT temperature $T_{\\mathrm{AT}}$ as an analytic expression in $J$. \n\nExpress your final answer as a single closed-form symbolic expression. No numerical rounding is required.", "solution": "The problem requires a stability analysis of the replica-symmetric (RS) paramagnetic saddle point of the Sherrington-Kirkpatrick (SK) model at zero external field ($h=0$). The goal is to find the de Almeida-Thouless (AT) temperature, which marks the onset of instability of this saddle point.\n\nWe begin with the disorder-averaged replicated partition function, $\\overline{Z^n}$. For the SK model, the Hamiltonian is $H = -\\sum_{1 \\leq i<j \\leq N} J_{ij} \\sigma_i \\sigma_j$. We are in units where the Boltzmann constant $k_B=1$. The couplings $J_{ij}$ are Gaussian random variables with mean $\\mathbb{E}[J_{ij}]=0$ and variance $\\mathbb{E}[J_{ij}^2] = J^2/N$.\n\nThe average over the disorder gives:\n$$ \\overline{Z^n} = \\overline{\\sum_{\\{\\sigma^a\\}} \\exp\\left( \\beta \\sum_{a=1}^n \\sum_{1 \\leq i<j \\leq N} J_{ij} \\sigma_i^a \\sigma_j^a \\right)} = \\sum_{\\{\\sigma^a\\}} \\exp\\left( \\frac{\\beta^2}{2} \\sum_{1 \\leq i<j \\leq N} \\mathbb{E}[J_{ij}^2] \\left( \\sum_{a=1}^n \\sigma_i^a \\sigma_j^a \\right)^2 \\right) $$\nUsing $\\mathbb{E}[J_{ij}^2] = J^2/N$ and approximating the sum over pairs $\\sum_{i<j} \\approx \\frac{1}{2}\\sum_{i,j}$ for large $N$, the exponent becomes:\n$$ \\frac{(\\beta J)^2}{2N} \\frac{1}{2} \\sum_{i,j=1}^N \\sum_{a,b=1}^n \\sigma_i^a \\sigma_j^a \\sigma_i^b \\sigma_j^b = \\frac{(\\beta J)^2}{4N} \\sum_{a,b=1}^n \\left(\\sum_{i=1}^N \\sigma_i^a \\sigma_i^b\\right) \\left(\\sum_{j=1}^N \\sigma_j^a \\sigma_j^b\\right) $$\nWe introduce the replica overlap matrix $Q_{ab} = \\frac{1}{N} \\sum_{i=1}^N \\sigma_i^a \\sigma_i^b$. The exponent is $\\frac{N(\\beta J)^2}{4} \\sum_{a,b=1}^n Q_{ab}^2$. The diagonal terms are $Q_{aa} = \\frac{1}{N} \\sum_i (\\sigma_i^a)^2 = 1$. Separating diagonal and off-diagonal terms:\n$$ \\frac{N(\\beta J)^2}{4} \\left( \\sum_{a \\neq b} Q_{ab}^2 + \\sum_{a=1}^n Q_{aa}^2 \\right) = \\frac{N(\\beta J)^2}{2} \\sum_{1 \\leq a<b \\leq n} Q_{ab}^2 + \\frac{n N(\\beta J)^2}{4} $$\nTo proceed, we use the Hubbard-Stratonovich transformation, introducing auxiliary fields $q_{ab}$ corresponding to the overlaps $Q_{ab}$ for $a<b$. This leads to an expression for $\\overline{Z^n}$ as an integral over these fields. In the thermodynamic limit $N\\to\\infty$, the integral is dominated by its saddle point, and we can write $\\overline{Z^n} \\approx \\exp(-N S_{\\text{eff}}[q])$, where $S_{\\text{eff}}[q]$ is the effective action (or free energy density functional) per replica pair summation. The normalized free energy per spin is obtained in the limit $n \\to 0$.\n\nThe effective action for the fields $q_{ab}$ (with $a<b$) is:\n$$ S[q] = \\frac{(\\beta J)^2}{2} \\sum_{a<b} q_{ab}^2 - \\ln Z_1[q] $$\nwhere $Z_1[q]$ is the single-site partition function for $n$ replicas:\n$$ Z_1[q] = \\operatorname{Tr}_{\\{\\sigma^a\\}} \\exp\\left( (\\beta J)^2 \\sum_{a<b} q_{ab} \\sigma^a \\sigma^b \\right) $$\nThe trace is a sum over all $2^n$ configurations of the $n$ Ising spins $\\sigma^a \\in \\{-1, +1\\}$. The saddle-point equations are $\\frac{\\partial S}{\\partial q_{ab}} = 0$, which yields $q_{ab} = \\langle \\sigma^a \\sigma^b \\rangle_q$, where the average is taken with the Boltzmann weight defined by $Z_1[q]$.\n\nThe problem asks to analyze the stability of the RS paramagnetic saddle point at $h=0$. This corresponds to setting all off-diagonal overlaps to zero: $q_{ab}=0$ for $a \\neq b$. This is a valid saddle point because at $q_{ab}=0$, the spins in $Z_1[0]$ are decoupled: $\\langle \\sigma^a \\sigma^b \\rangle_0 = \\langle \\sigma^a \\rangle_0 \\langle \\sigma^b \\rangle_0 = 0$ for $a \\neq b$, satisfying $q_{ab}=0$.\n\nTo analyze stability, we compute the Hessian matrix of the action $S[q]$ at this saddle point. The elements of the Hessian are $\\mathcal{H}_{(ab),(cd)} = \\frac{\\partial^2 S}{\\partial q_{ab} \\partial q_{cd}}$, where $(ab)$ and $(cd)$ denote pairs with $a<b$ and $c<d$.\n$$ \\frac{\\partial S}{\\partial q_{ab}} = (\\beta J)^2 q_{ab} - \\frac{1}{Z_1[q]} \\frac{\\partial Z_1[q]}{\\partial q_{ab}} = (\\beta J)^2 q_{ab} - (\\beta J)^2 \\langle \\sigma^a \\sigma^b \\rangle_q $$\nDifferentiating again with respect to $q_{cd}$:\n$$ \\mathcal{H}_{(ab),(cd)} = (\\beta J)^2 \\delta_{(ab),(cd)} - (\\beta J)^2 \\frac{\\partial}{\\partial q_{cd}} \\langle \\sigma^a \\sigma^b \\rangle_q $$\nThe derivative of the average is a connected correlation function:\n$$ \\frac{\\partial}{\\partial q_{cd}} \\langle \\sigma^a \\sigma^b \\rangle_q = (\\beta J)^2 \\left( \\langle \\sigma^a \\sigma^b \\sigma^c \\sigma^d \\rangle_q - \\langle \\sigma^a \\sigma^b \\rangle_q \\langle \\sigma^c \\sigma^d \\rangle_q \\right) $$\nWe evaluate the Hessian at the saddle point $q_{ab}=0$. The averages $\\langle \\cdot \\rangle_q$ become averages $\\langle \\cdot \\rangle_0$ over $n$ independent Ising spins (the effective measure is flat).\n$$ \\langle \\sigma^a \\sigma^b \\rangle_0 = \\frac{\\operatorname{Tr}(\\sigma^a \\sigma^b)}{\\operatorname{Tr}(1)} = 0 \\quad \\text{for } a \\neq b. $$\nThe Hessian at the saddle point is:\n$$ \\mathcal{H}_{(ab),(cd)}|_{q=0} = (\\beta J)^2 \\delta_{(ab),(cd)} - (\\beta J)^4 \\langle \\sigma^a \\sigma^b \\sigma^c \\sigma^d \\rangle_0 $$\nThe four-spin correlation $\\langle \\sigma^a \\sigma^b \\sigma^c \\sigma^d \\rangle_0$ for independent spins is non-zero only if the set of indices $\\{a,b,c,d\\}$ consists of pairs of identical indices. Since the indices of the Hessian are pairs $(a,b)$ and $(c,d)$ with $a \\neq b$ and $c \\neq d$, the correlation is non-zero only if $\\{a,b\\} = \\{c,d\\}$. Given the ordering convention $a<b$ and $c<d$, this implies $(a,b)=(c,d)$.\nSpecifically:\n- If $(a,b) = (c,d)$: $\\langle \\sigma^a \\sigma^b \\sigma^a \\sigma^b \\rangle_0 = \\langle (\\sigma^a)^2 (\\sigma^b)^2 \\rangle_0 = \\langle 1 \\cdot 1 \\rangle_0 = 1$.\n- If $(a,b) \\neq (c,d)$: The set of indices $\\{a,b,c,d\\}$ contains at least three distinct indices, so at least one spin variable appears linearly in the trace, making the average zero. For instance, if the pairs share one index, e.g., $(a,b)$ and $(a,c)$ with $b \\neq c$, we have $\\langle \\sigma^a \\sigma^b \\sigma^a \\sigma^c \\rangle_0 = \\langle (\\sigma^a)^2 \\sigma^b \\sigma^c \\rangle_0 = \\langle \\sigma^b \\sigma^c \\rangle_0 = 0$.\n\nTherefore, the Hessian matrix is diagonal at the paramagnetic saddle point:\n$$ \\mathcal{H}_{(ab),(cd)}|_{q=0} = \\left( (\\beta J)^2 - (\\beta J)^4 \\right) \\delta_{(ab),(cd)} $$\nThe stability of the saddle point requires all eigenvalues of the Hessian to be non-negative. All fluctuation modes corresponding to $\\delta q_{ab}$ are eigenmodes with the same eigenvalue. These are known as the \"replicon\" modes in the context of replica symmetry breaking. At this highly symmetric point, they are all degenerate. The replicon eigenvalue is:\n$$ \\lambda_R(T) = (\\beta J)^2 - (\\beta J)^4 = (\\beta J)^2 (1 - (\\beta J)^2) $$\nThe single-site spin correlation that determines this eigenvalue is $\\langle (\\sigma^a \\sigma^b)^2 \\rangle_0 = 1$, where the average is over the effective single-site measure which is trivial for the paramagnetic state.\n\nThe de Almeida-Thouless (AT) line marks the boundary where the RS solution becomes unstable. This occurs when the lowest eigenvalue of the Hessian becomes zero. We set $\\lambda_R(T_{\\text{AT}}) = 0$:\n$$ (\\beta_{\\text{AT}} J)^2 (1 - (\\beta_{\\text{AT}} J)^2) = 0 $$\nwhere $\\beta_{\\text{AT}} = 1/T_{\\text{AT}}$. This equation has two solutions: $(\\beta_{\\text{AT}} J)^2 = 0$ (the trivial $T \\to \\infty$ case) and $(\\beta_{\\text{AT}} J)^2 = 1$. The non-trivial condition gives the AT temperature.\n$$ (\\beta_{\\text{AT}} J)^2 = 1 \\implies \\beta_{\\text{AT}} J = 1 $$\nSince $\\beta_{\\text{AT}} = 1/T_{\\text{AT}}$, we have:\n$$ \\frac{J}{T_{\\text{AT}}} = 1 \\implies T_{\\text{AT}} = J $$\nThus, for temperatures $T<J$, the paramagnetic RS solution is unstable, signaling a phase transition to a spin glass phase.", "answer": "$$\\boxed{J}$$", "id": "3020435"}]}