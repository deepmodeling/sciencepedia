{"hands_on_practices": [{"introduction": "In many spintronic devices, the spin current generated by the Spin Hall Effect (SHE) within a nonmagnetic material is used to manipulate an adjacent magnetic layer. However, the spin current injected into the magnet is not necessarily equal to the bulk spin current generated, especially in thin films. This is due to spin diffusion and a resulting \"spin backflow,\" which reduces the efficiency of spin injection. This first practice [@problem_id:3020529] guides you through a classic boundary-value problem to model this effect, deriving the thickness dependence of the effective spin Hall angle and using this model to extract a crucial material parameter, the spin diffusion length $\\lambda_s$, from experimental data.", "problem": "A nonmagnetic metal (NM) thin film of thickness $t$ and electrical conductivity $\\sigma$ is in contact at $z=0$ with a ferromagnet (FM) that perfectly absorbs spin accumulation (i.e., the interfacial spin accumulation vanishes), and has a vacuum top surface at $z=t$ through which no spin current can flow. A uniform in-plane electric field $E_x$ drives a charge current density $j_c=\\sigma E_x$ in the NM. Due to the Spin Hall Effect (SHE), this charge current generates a uniform bulk spin Hall source corresponding to a $z$-directed spin current with spin polarization along $y$, written as $j_{s}^{\\mathrm{SH}}=\\theta_{\\mathrm{SH}} j_c$, where $\\theta_{\\mathrm{SH}}$ is the intrinsic spin Hall angle. The steady-state spin accumulation $\\mu_s(z)$ in the NM obeys one-dimensional spin diffusion with spin diffusion length $\\lambda_s$.\n\nStarting from the one-dimensional steady-state spin diffusion equation and the constitutive relation between spin current and spin accumulation gradient, derive how a finite spin diffusion length $\\lambda_s$ and thickness $t$ modify the measured (effective) spin Hall angle. Define the measured effective spin Hall angle as $\\theta_{\\mathrm{eff}}(t)\\equiv j_s(0)/j_c$, where $j_s(0)$ is the net spin current density injected into the FM at $z=0$.\n\nYou are provided the following experimental data for a NM/FM bilayer, where the measured effective spin Hall angles at thicknesses $t$ are:\n- $t=2.0\\,\\mathrm{nm}$, $\\theta_{\\mathrm{eff}}(t)=0.0600$,\n- $t=4.0\\,\\mathrm{nm}$, $\\theta_{\\mathrm{eff}}(t)=0.146$,\n- $t=8.0\\,\\mathrm{nm}$, $\\theta_{\\mathrm{eff}}(t)=0.220$,\n- $t=30.0\\,\\mathrm{nm}$, $\\theta_{\\mathrm{eff}}(t)=0.240$.\n\nAssume that the $t=30.0\\,\\mathrm{nm}$ sample is thick enough to represent the asymptotic (bulk) limit, so that $\\theta_{\\mathrm{SH}}=\\theta_{\\mathrm{eff}}(30.0\\,\\mathrm{nm})$. Using your derived thickness dependence, determine the spin diffusion length $\\lambda_s$. Express your final result in nanometers and round your answer to three significant figures.", "solution": "### Derivation of the Effective Spin Hall Angle\n\nThe spatial distribution of the spin accumulation $\\mu_s(z)$ is governed by the one-dimensional steady-state spin diffusion equation:\n$$\n\\frac{d^2\\mu_s(z)}{dz^2} - \\frac{\\mu_s(z)}{\\lambda_s^2} = 0\n$$\nThe general solution to this second-order ODE is:\n$$\n\\mu_s(z) = A \\cosh\\left(\\frac{z}{\\lambda_s}\\right) + B \\sinh\\left(\\frac{z}{\\lambda_s}\\right)\n$$\nWe apply the boundary conditions to find the constants $A$ and $B$.\n\n1.  At the NM/FM interface ($z=0$), the ferromagnet is a perfect spin sink, so spin accumulation vanishes: $\\mu_s(0) = 0$.\n    $$\n    \\mu_s(0) = A \\cosh(0) + B \\sinh(0) = A \\cdot 1 + B \\cdot 0 = A = 0\n    $$\n    Thus, the spin accumulation profile simplifies to $\\mu_s(z) = B \\sinh\\left(\\frac{z}{\\lambda_s}\\right)$.\n\n2.  The total spin current density $j_s(z)$ is the sum of the constant bulk Spin Hall current $j_s^{\\mathrm{SH}}$ and the diffusive backflow current, which is proportional to the gradient of the spin accumulation:\n    $$\n    j_s(z) = j_s^{\\mathrm{SH}} - C \\frac{d\\mu_s(z)}{dz} = \\theta_{\\mathrm{SH}}j_c - C \\frac{B}{\\lambda_s} \\cosh\\left(\\frac{z}{\\lambda_s}\\right)\n    $$\n    where $C$ is a spin transport coefficient. At the NM/vacuum interface ($z=t$), no spin current can flow, so $j_s(t) = 0$.\n    $$\n    j_s(t) = \\theta_{\\mathrm{SH}}j_c - \\frac{CB}{\\lambda_s} \\cosh\\left(\\frac{t}{\\lambda_s}\\right) = 0\n    $$\n    We can solve for the constant $B$:\n    $$\n    B = \\frac{\\theta_{\\mathrm{SH}}j_c \\lambda_s}{C \\cosh(t/\\lambda_s)}\n    $$\n\nThe net spin current density injected into the FM at $z=0$ is $j_s(0)$.\n$$\nj_s(0) = \\theta_{\\mathrm{SH}}j_c - \\frac{CB}{\\lambda_s} \\cosh(0) = \\theta_{\\mathrm{SH}}j_c - \\frac{CB}{\\lambda_s}\n$$\nSubstituting the expression for $B$, the unknown coefficient $C$ cancels out:\n$$\nj_s(0) = \\theta_{\\mathrm{SH}}j_c - \\frac{C}{\\lambda_s} \\left( \\frac{\\theta_{\\mathrm{SH}}j_c \\lambda_s}{C \\cosh(t/\\lambda_s)} \\right) = \\theta_{\\mathrm{SH}}j_c \\left( 1 - \\frac{1}{\\cosh(t/\\lambda_s)} \\right)\n$$\nThe effective spin Hall angle $\\theta_{\\mathrm{eff}}(t) = j_s(0)/j_c$ is therefore:\n$$\n\\theta_{\\mathrm{eff}}(t) = \\theta_{\\mathrm{SH}}\\left( 1 - \\operatorname{sech}\\left(\\frac{t}{\\lambda_s}\\right) \\right)\n$$\n\n### Determination of the Spin Diffusion Length\n\nFirst, we use the assumption that the thickest sample ($t=30.0\\,\\mathrm{nm}$) gives the bulk intrinsic spin Hall angle $\\theta_{\\mathrm{SH}}$, since for $t \\gg \\lambda_s$, $\\operatorname{sech}(t/\\lambda_s) \\to 0$.\n$$\n\\theta_{\\mathrm{SH}} = \\theta_{\\mathrm{eff}}(30.0\\,\\mathrm{nm}) = 0.240\n$$\nNext, we rearrange the derived formula to solve for the spin diffusion length $\\lambda_s$:\n$$\n\\lambda_s = \\frac{t}{\\arccosh\\left(\\frac{\\theta_{\\mathrm{SH}}}{\\theta_{\\mathrm{SH}} - \\theta_{\\mathrm{eff}}(t)}\\right)}\n$$\nWe now use the other data points to calculate $\\lambda_s$:\n-   For $t_1 = 2.0\\,\\mathrm{nm}$, $\\theta_{\\mathrm{eff}}(t_1) = 0.0600$:\n    $$ \\lambda_{s,1} = \\frac{2.0}{\\arccosh\\left(\\frac{0.240}{0.240 - 0.0600}\\right)} = \\frac{2.0}{\\arccosh(4/3)} \\approx \\frac{2.0}{0.79537} \\approx 2.514\\,\\mathrm{nm} $$\n-   For $t_2 = 4.0\\,\\mathrm{nm}$, $\\theta_{\\mathrm{eff}}(t_2) = 0.146$:\n    $$ \\lambda_{s,2} = \\frac{4.0}{\\arccosh\\left(\\frac{0.240}{0.240 - 0.146}\\right)} = \\frac{4.0}{\\arccosh(0.240/0.094)} \\approx \\frac{4.0}{1.5897} \\approx 2.516\\,\\mathrm{nm} $$\n-   For $t_3 = 8.0\\,\\mathrm{nm}$, $\\theta_{\\mathrm{eff}}(t_3) = 0.220$:\n    $$ \\lambda_{s,3} = \\frac{8.0}{\\arccosh\\left(\\frac{0.240}{0.240 - 0.220}\\right)} = \\frac{8.0}{\\arccosh(12)} \\approx \\frac{8.0}{3.1763} \\approx 2.519\\,\\mathrm{nm} $$\n\nThe values are highly consistent. We take their average to find the best estimate for $\\lambda_s$:\n$$\n\\lambda_s = \\frac{2.514 + 2.516 + 2.519}{3} \\approx 2.516\\,\\mathrm{nm}\n$$\nRounding the result to three significant figures gives $\\lambda_s = 2.52\\,\\mathrm{nm}$.", "answer": "$$\\boxed{2.52}$$", "id": "3020529"}, {"introduction": "Beyond the intrinsic SHE, spin-dependent scattering from impurities gives rise to the extrinsic Spin Hall Effect. The two primary extrinsic mechanisms, skew scattering and side-jump, have distinct physical origins and, importantly, different dependencies on the material's resistivity. This exercise [@problem_id:3020544] focuses on the practical task of disentangling these contributions from experimental data, using a well-established phenomenological model. You will not only calculate the total spin Hall angle but also perform a rigorous uncertainty analysis, a vital skill for interpreting and reporting experimental results.", "problem": "Consider a nonmagnetic metallic film in the dilute-impurity, low-temperature regime, where the Spin Hall Effect (SHE) is dominated by extrinsic scattering. The spin Hall angle, defined as the dimensionless ratio $\\theta_{\\mathrm{SH}} \\equiv J_{s}/J_{c}$ of transverse spin current $J_{s}$ to longitudinal charge current $J_{c}$, receives two additive extrinsic contributions: (i) skew scattering, which yields a resistivity-independent increment to $\\theta_{\\mathrm{SH}}$, and (ii) side-jump, which yields an increment that scales linearly with the residual resistivity. These statements are well-established in the theory of impurity-induced spin-orbit scattering in metals.\n\nAn experiment provides the following data at low temperature:\n- Residual resistivity $\\,\\rho_{0} = 8.3\\,\\mu\\Omega\\cdot\\mathrm{cm}\\,$ with standard uncertainty $\\,\\sigma_{\\rho} = 0.2\\,\\mu\\Omega\\cdot\\mathrm{cm}\\,$.\n- Fitted skew-scattering coefficient $\\,a_{\\mathrm{sk}} = 5.8 \\times 10^{-3}\\,$ with standard uncertainty $\\,\\sigma_{a} = 0.3 \\times 10^{-3}\\,$.\n- Fitted side-jump coefficient $\\,\\gamma_{\\mathrm{sj}} = 1.7 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}\\,$ with standard uncertainty $\\,\\sigma_{\\gamma} = 0.2 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}\\,$.\n\nA joint fit to the resistivity-dependence of the spin Hall angle yields a correlation coefficient $\\,r = -0.35\\,$ between the estimates of $a_{\\mathrm{sk}}$ and $\\gamma_{\\mathrm{sj}}$. The residual resistivity measurement is independent of the fit, so it may be treated as uncorrelated with $a_{\\mathrm{sk}}$ and $\\gamma_{\\mathrm{sj}}$.\n\nUsing only the foregoing definitions and well-tested scaling facts about skew scattering and side-jump, derive the expression for the total extrinsic spin Hall angle at $\\,\\rho_{0}\\,$ and estimate its value by combining the skew and side-jump contributions. Propagate the uncertainties to first order in the small parameter variations (linear approximation), explicitly incorporating the covariance between $a_{\\mathrm{sk}}$ and $\\gamma_{\\mathrm{sj}}$ implied by $r$, and treating $\\rho_{0}$ as independent of both fit parameters.\n\nReport your result as a two-component row matrix containing:\n- the central estimate of the total extrinsic spin Hall angle at $\\,\\rho_{0}\\,$, and\n- its one-standard-deviation uncertainty.\n\nRound each component to four significant figures. The spin Hall angle is dimensionless; express both components as pure numbers (no units).", "solution": "### Calculation of the Total Extrinsic Spin Hall Angle\n\nThe total extrinsic spin Hall angle, $\\theta_{\\mathrm{SH}}$, is given by the linear model combining the skew-scattering ($a_{\\mathrm{sk}}$) and side-jump ($\\gamma_{\\mathrm{sj}}\\rho_0$) contributions:\n$$\n\\theta_{\\mathrm{SH}}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}}, \\rho_0) = a_{\\mathrm{sk}} + \\gamma_{\\mathrm{sj}} \\rho_0\n$$\nUsing the provided central values:\n- $a_{\\mathrm{sk}} = 5.8 \\times 10^{-3}$\n- $\\gamma_{\\mathrm{sj}} = 1.7 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}$\n- $\\rho_0 = 8.3\\,\\mu\\Omega\\cdot\\mathrm{cm}$\n\nThe central estimate of the spin Hall angle is:\n$$\n\\theta_{\\mathrm{SH}} = (5.8 \\times 10^{-3}) + (1.7 \\times 10^{-3}) \\times (8.3) = 5.8 \\times 10^{-3} + 14.11 \\times 10^{-3} = 19.91 \\times 10^{-3}\n$$\n$$\n\\theta_{\\mathrm{SH}} = 0.01991\n$$\n\n### Uncertainty Propagation\n\nThe variance $\\sigma_{\\theta}^2$ of a function $f(x_1, x_2, \\dots)$ is found using the formula for propagation of uncertainty. For our function $\\theta_{\\mathrm{SH}}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}}, \\rho_0)$, the variance is:\n$$\n\\sigma_{\\theta}^2 = \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial a_{\\mathrm{sk}}}\\right)^2 \\sigma_a^2 + \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\gamma_{\\mathrm{sj}}}\\right)^2 \\sigma_\\gamma^2 + \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\rho_0}\\right)^2 \\sigma_\\rho^2 + 2 \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial a_{\\mathrm{sk}}}\\right) \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\gamma_{\\mathrm{sj}}}\\right) \\text{Cov}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}})\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial a_{\\mathrm{sk}}} = 1, \\quad \\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\gamma_{\\mathrm{sj}}} = \\rho_0, \\quad \\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\rho_0} = \\gamma_{\\mathrm{sj}}\n$$\nThe covariance is $\\text{Cov}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}}) = r \\sigma_a \\sigma_\\gamma$. Since $\\rho_0$ is uncorrelated with $a_{\\mathrm{sk}}$ and $\\gamma_{\\mathrm{sj}}$, their covariance terms are zero. The variance formula becomes:\n$$\n\\sigma_{\\theta}^2 = \\sigma_a^2 + \\rho_0^2 \\sigma_\\gamma^2 + \\gamma_{\\mathrm{sj}}^2 \\sigma_\\rho^2 + 2 \\rho_0 r \\sigma_a \\sigma_\\gamma\n$$\nSubstituting the given uncertainties and values:\n- $\\sigma_a = 0.3 \\times 10^{-3}$\n- $\\sigma_\\gamma = 0.2 \\times 10^{-3}$\n- $\\sigma_\\rho = 0.2$\n- $r = -0.35$\n\nThe terms of the variance are:\n1.  $\\sigma_a^2 = (0.3 \\times 10^{-3})^2 = 0.09 \\times 10^{-6}$\n2.  $\\rho_0^2 \\sigma_\\gamma^2 = (8.3)^2 \\times (0.2 \\times 10^{-3})^2 = 68.89 \\times 0.04 \\times 10^{-6} = 2.7556 \\times 10^{-6}$\n3.  $\\gamma_{\\mathrm{sj}}^2 \\sigma_\\rho^2 = (1.7 \\times 10^{-3})^2 \\times (0.2)^2 = 2.89 \\times 10^{-6} \\times 0.04 = 0.1156 \\times 10^{-6}$\n4.  $2 \\rho_0 r \\sigma_a \\sigma_\\gamma = 2 \\times 8.3 \\times (-0.35) \\times (0.3 \\times 10^{-3}) \\times (0.2 \\times 10^{-3}) = -0.3486 \\times 10^{-6}$\n\nSumming the terms:\n$$\n\\sigma_{\\theta}^2 = (0.09 + 2.7556 + 0.1156 - 0.3486) \\times 10^{-6} = 2.6126 \\times 10^{-6}\n$$\nThe standard uncertainty is the square root of the variance:\n$$\n\\sigma_{\\theta} = \\sqrt{2.6126 \\times 10^{-6}} \\approx 1.61635 \\times 10^{-3} = 0.00161635\n$$\n\n### Final Result\n\nRounding to four significant figures, the central estimate is $0.01991$ and the uncertainty is $0.001616$. The result as a row matrix is $(\\theta_{\\mathrm{SH}}, \\sigma_{\\theta})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01991 & 0.001616 \\end{pmatrix}}\n$$", "id": "3020544"}, {"introduction": "The intrinsic Spin Hall Effect is a fundamental property of a material's electronic band structure, arising even in a perfectly clean crystal without impurities. Its theoretical description is rooted in quantum mechanical linear response theory, specifically the Kubo formula, which relates the conductivity to the \"spin Berry curvature\" integrated over the occupied states in the Brillouin zone. This final practice [@problem_id:2860271] provides a hands-on opportunity to bridge this advanced theory with practical computation. You will implement a numerical algorithm to calculate the intrinsic SHE for a canonical tight-binding model, gaining direct insight into how band structure topology gives rise to this fascinating transport phenomenon.", "problem": "You are to implement a numerical evaluation of the intrinsic spin Hall conductivity, denoted by $\\sigma_{sH}$, for a two-dimensional inversion-asymmetric tight-binding model using a Wannier interpolation strategy. The purpose is to connect fundamental definitions in linear response theory to a concrete algorithm that can be executed, and to assess the convergence of $\\sigma_{sH}$ with respect to Brillouin zone sampling.\n\nConsider a single-orbital square lattice with lattice constant set to $a=1$ and periodic boundary conditions. In momentum space, the Bloch Hamiltonian is a $2 \\times 2$ matrix in spin space with spin-orbit coupling induced by inversion asymmetry (Rashba form):\n$$\nH(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\,\\sigma_0 + \\alpha \\left( \\sin k_y \\,\\sigma_x - \\sin k_x \\,\\sigma_y \\right),\n$$\nwhere $\\mathbf{k} = (k_x,k_y)$, $\\varepsilon(\\mathbf{k}) = -2t \\left( \\cos k_x + \\cos k_y \\right)$, $\\sigma_0$ is the $2 \\times 2$ identity, $\\sigma_{x,y,z}$ are the Pauli matrices acting in spin space, $t>0$ is the nearest-neighbor hopping, and $\\alpha$ is the Rashba spin-orbit coupling strength. Angles are to be treated in radians, and the Brillouin zone is $k_x,k_y \\in [-\\pi,\\pi)$.\n\nUse the following fundamental definitions and facts as your starting point:\n- Kubo linear response theory relates $\\sigma_{sH}$ to equilibrium properties of the crystal and its eigenstates.\n- The velocity operator is defined by $v_\\mu(\\mathbf{k}) = \\partial H(\\mathbf{k})/\\partial k_\\mu$, with $\\mu \\in \\{x,y\\}$.\n- The spin operator is $s_z = \\frac{1}{2}\\sigma_z$. The $x$-directed spin current with spin polarization along $z$ is the symmetrized product $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\}$.\n- Wannier interpolation in this context means working in a localized (tight-binding/Wannier) basis to obtain $H(\\mathbf{k})$ and its derivatives analytically from real-space hopping amplitudes, rather than via finite differences in $\\mathbf{k}$-space.\n\nFrom these bases, derive an implementable formula suitable for numerical integration over the Brillouin zone that produces the intrinsic spin Hall conductivity at zero temperature and a specified Fermi energy $E_F$. Use the convention $\\hbar = 1$ and $e = 1$, so that the numerical value you compute is $\\sigma_{sH}$ expressed in units of $e/\\hbar$. In this convention, the Brillouin zone average replaces the factor $(2\\pi)^{-2}\\int_{\\text{BZ}} d^2k$, so that the integral over the Brillouin zone is approximated by the uniform average over a grid of $N_k \\times N_k$ $\\mathbf{k}$-points.\n\nYour program must:\n1. Implement the model above and construct $H(\\mathbf{k})$, $v_x(\\mathbf{k})$, $v_y(\\mathbf{k})$, and $j_x^{(s)}(\\mathbf{k})$ analytically from the tight-binding form (this is the Wannier interpolation step).\n2. Use zero-temperature Fermi occupation with a given Fermi energy $E_F$.\n3. Evaluate $\\sigma_{sH}$ by integrating over the Brillouin zone using a uniform Monkhorst–Pack style grid $k_x,k_y \\in [-\\pi,\\pi)$ with $N_k$ points along each direction. Angles are in radians.\n4. Express the final result in units of $e/\\hbar$ as a pure number.\n\nTest suite and required outputs:\n- Use the following five parameter sets $(t,\\alpha,E_F,N_k)$:\n    1. $(1.0,\\,0.35,\\,-3.20,\\,25)$\n    2. $(1.0,\\,0.35,\\,-3.20,\\,51)$\n    3. $(1.0,\\,0.35,\\,-3.20,\\,101)$\n    4. $(1.0,\\,0.00,\\,0.00,\\,31)$\n    5. $(1.0,\\,0.60,\\,0.00,\\,81)$\n- For each case, compute $\\sigma_{sH}$ in units of $e/\\hbar$ and round the result to six decimal places.\n- Your program should produce a single line of output containing the five results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\"), where each $r_i$ is the rounded floating-point value for the corresponding test case.\n\nScientific realism and applicability notes:\n- The chosen Hamiltonian is a minimal inversion-asymmetric tight-binding model that supports a finite intrinsic spin Hall response in the clean limit.\n- The Wannier interpolation requirement is satisfied by using the analytical derivatives of the tight-binding Hamiltonian with respect to $\\mathbf{k}$ derived from real-space hoppings.\n- Convergence with respect to $N_k$ is assessed by comparing the first three outputs; stability across these demonstrates sampling convergence.\n\nAll angles must be in radians. All final numerical answers must be reported in units of $e/\\hbar$ as specified, rounded to six decimal places. The final output format must be exactly a single line with a Python list containing the five results.", "solution": "### Derivation of the Computable Formula\n\nThe intrinsic spin Hall conductivity, $\\sigma_{sH}$ (or more precisely $\\sigma_{xy}^{s_z}$, the spin current $j_x^{(s_z)}$ in response to an electric field $E_y$), can be calculated using the Kubo-Středa formula. At zero temperature and for a clean system, this simplifies to an integral of the spin Berry curvature over the occupied states in the Brillouin zone (BZ).\n\nFor a two-band system with eigenvalues $E_{n\\mathbf{k}}$ and eigenvectors $|u_{n\\mathbf{k}}\\rangle$ ($n=1,2$), the formula is:\n$$\n\\sigma_{sH} = \\sum_{n=1,2} \\int_{\\text{BZ}} \\frac{d^2k}{(2\\pi)^2} \\Theta(E_F - E_{n\\mathbf{k}}) \\, \\Omega_{n,xy}^{(s)}(\\mathbf{k})\n$$\nwhere $\\Theta$ is the Heaviside step function for zero-temperature occupation, and $\\Omega_{n,xy}^{(s)}(\\mathbf{k})$ is the spin Berry curvature for band $n$:\n$$\n\\Omega_{n,xy}^{(s)}(\\mathbf{k}) = -2 \\, \\text{Im} \\sum_{m \\neq n} \\frac{ \\langle u_{n\\mathbf{k}} | j_x^{(s)}(\\mathbf{k}) | u_{m\\mathbf{k}} \\rangle \\langle u_{m\\mathbf{k}} | v_y(\\mathbf{k}) | u_{n\\mathbf{k}} \\rangle }{(E_{n\\mathbf{k}} - E_{m\\mathbf{k}})^2}\n$$\n\n**1. Define Operators:**\nFirst, we find the analytical forms of the operators from the given Hamiltonian $H(\\mathbf{k})$:\n- **Velocity operator $v_y(\\mathbf{k}) = \\frac{\\partial H}{\\partial k_y}$:**\n$$\nv_y(\\mathbf{k}) = \\frac{\\partial}{\\partial k_y} \\left[ -2t(\\cos k_x + \\cos k_y)\\sigma_0 + \\alpha(\\sin k_y \\sigma_x - \\sin k_x \\sigma_y) \\right] = (2t \\sin k_y)\\sigma_0 + (\\alpha \\cos k_y)\\sigma_x\n$$\n- **Spin current operator $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\}$:**\nFirst, $v_x(\\mathbf{k}) = \\frac{\\partial H}{\\partial k_x} = (2t \\sin k_x)\\sigma_0 - (\\alpha \\cos k_x)\\sigma_y$.\nWith $s_z = \\frac{1}{2}\\sigma_z$, we have $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{4}\\{\\sigma_z, v_x(\\mathbf{k})\\} = \\frac{1}{4} [ (2t \\sin k_x)\\{\\sigma_z, \\sigma_0\\} - (\\alpha \\cos k_x)\\{\\sigma_z, \\sigma_y\\} ]$.\nUsing $\\{\\sigma_z, \\sigma_0\\}=2\\sigma_z$ and $\\{\\sigma_z, \\sigma_y\\}=0$, this simplifies to:\n$$\nj_x^{(s)}(\\mathbf{k}) = (t \\sin k_x) \\sigma_z\n$$\n\n**2. Simplify for the Two-Band Model:**\nFor our $2 \\times 2$ system, the sum over $m \\neq n$ has only one term. The spin Berry curvatures for the two bands are related: $\\Omega_{2,xy}^{(s)}(\\mathbf{k}) = -\\Omega_{1,xy}^{(s)}(\\mathbf{k})$. The conductivity expression becomes:\n$$\n\\sigma_{sH} = \\int_{\\text{BZ}} \\frac{d^2k}{(2\\pi)^2} \\left[ \\Theta(E_F - E_{1\\mathbf{k}}) - \\Theta(E_F - E_{2\\mathbf{k}}) \\right] \\Omega_{1,xy}^{(s)}(\\mathbf{k})\n$$\nSince $E_{1\\mathbf{k}} \\le E_{2\\mathbf{k}}$, the term in brackets is non-zero (and equal to 1) only if the Fermi energy $E_F$ lies between the two bands. The integral is only over states where the lower band is filled and the upper band is empty.\n\n**3. Numerical Algorithm:**\nThe problem specifies approximating the BZ integral with a normalized sum over a uniform $N_k \\times N_k$ grid. The algorithm is as follows:\n1. Create a uniform $N_k \\times N_k$ grid of $\\mathbf{k}=(k_x, k_y)$ points covering the BZ, e.g., $k_{x,y} \\in [-\\pi, \\pi)$.\n2. Initialize a sum `total_sigma = 0`.\n3. For each $\\mathbf{k}$ point on the grid:\n    a. Construct the $2 \\times 2$ matrix $H(\\mathbf{k})$.\n    b. Numerically diagonalize $H(\\mathbf{k})$ to find its eigenvalues $E_1, E_2$ and corresponding eigenvectors $|u_1\\rangle, |u_2\\rangle$.\n    c. If the energy gap $E_2 - E_1$ is close to zero, skip the point to avoid numerical instability.\n    d. Construct the matrices for $v_y(\\mathbf{k})$ and $j_x^{(s)}(\\mathbf{k})$.\n    e. Compute the off-diagonal matrix elements: $j_{12} = \\langle u_1| j_x^{(s)} |u_2 \\rangle$ and $v_{21} = \\langle u_2| v_y |u_1 \\rangle$.\n    f. Calculate the spin Berry curvature for the lower band: $\\Omega_{1} = -2 \\, \\text{Im}(j_{12} \\cdot v_{21}) / (E_1 - E_2)^2$.\n    g. Based on the Fermi energy, add the correct contribution to the sum:\n       - If $E_1  E_F$, add $\\Omega_1$ to `total_sigma`.\n       - If $E_2  E_F$, subtract $\\Omega_1$ from `total_sigma` (since this state's contribution is $\\Omega_2 = -\\Omega_1$).\n4. The final conductivity is the average: $\\sigma_{sH} = \\text{total\\_sigma} / (N_k \\times N_k)$.\n\nThis procedure directly implements the Kubo formula for the given model.\n\n### Sample Implementation\nBelow is a Python code snippet that implements the described algorithm to compute the required values.\n\n```python\nimport numpy as np\n\ndef calculate_sigma_sh(t, alpha, E_F, Nk):\n    \"\"\"\n    Calculates sigma_sH for a single set of parameters.\n    \"\"\"\n    if alpha == 0:\n        return 0.0\n\n    sigma0 = np.array([[1, 0], [0, 1]], dtype=complex)\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=complex)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=complex)\n\n    k_coords = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n    kx_grid, ky_grid = np.meshgrid(k_coords, k_coords)\n\n    total_sigma_sh_sum = 0.0\n\n    for ikx in range(Nk):\n        for iky in range(Nk):\n            kx = kx_grid[ikx, iky]\n            ky = ky_grid[ikx, iky]\n\n            epsilon_k = -2 * t * (np.cos(kx) + np.cos(ky))\n            H_k = epsilon_k * sigma0 + alpha * (np.sin(ky) * sigma_x - np.sin(kx) * sigma_y)\n\n            energies, eigenstates = np.linalg.eigh(H_k)\n            E1, E2 = energies[0], energies[1]\n            u1, u2 = eigenstates[:, 0], eigenstates[:, 1]\n            \n            energy_gap = E2 - E1\n            if np.abs(energy_gap)  1e-9:\n                continue\n\n            vy_k = (2 * t * np.sin(ky)) * sigma0 + alpha * np.cos(ky) * sigma_x\n            jxs_k = (t * np.sin(kx)) * sigma_z\n            \n            v_21 = np.vdot(u2, vy_k @ u1)\n            j_12 = np.vdot(u1, jxs_k @ u2)\n            \n            numerator_im_part = np.imag(j_12 * v_21)\n            Omega1 = -2 * numerator_im_part / (energy_gap**2)\n\n            contribution = 0.0\n            if E1  E_F:\n                contribution += Omega1\n            if E2  E_F:\n                contribution -= Omega1\n\n            total_sigma_sh_sum += contribution\n\n    sigma_sh = total_sigma_sh_sum / (Nk**2)\n    return sigma_sh\n```", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the intrinsic spin Hall conductivity for a 2D Rashba\n    tight-binding model using Wannier interpolation (analytical operators)\n    and Kubo formalism.\n    \"\"\"\n\n    # Pauli matrices and identity\n    sigma0 = np.array([[1, 0], [0, 1]], dtype=complex)\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=complex)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=complex)\n\n    def calculate_sigma_sh(t, alpha, E_F, Nk):\n        \"\"\"\n        Calculates sigma_sH for a single set of parameters.\n        \"\"\"\n        # Case alpha=0: No spin-orbit coupling, so SHE is zero.\n        if alpha == 0:\n            return 0.0\n\n        # Create a uniform k-grid in the 1st Brillouin Zone: [-pi, pi)\n        k_coords = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n        kx_grid, ky_grid = np.meshgrid(k_coords, k_coords)\n\n        total_sigma_sh_sum = 0.0\n\n        for ikx in range(Nk):\n            for iky in range(Nk):\n                kx = kx_grid[ikx, iky]\n                ky = ky_grid[ikx, iky]\n\n                # 1. Construct Hamiltonian H(k)\n                epsilon_k = -2 * t * (np.cos(kx) + np.cos(ky))\n                H_k = epsilon_k * sigma0 + alpha * (np.sin(ky) * sigma_x - np.sin(kx) * sigma_y)\n\n                # 2. Diagonalize H(k) to get eigenvalues and eigenvectors\n                # eigh ensures real eigenvalues and orthonormal eigenvectors\n                energies, eigenstates = np.linalg.eigh(H_k)\n                E1, E2 = energies[0], energies[1]\n                u1, u2 = eigenstates[:, 0], eigenstates[:, 1]\n                \n                # Energy denominator\n                energy_gap = E2 - E1\n                if np.abs(energy_gap)  1e-9:  # Avoid division by zero at degeneracies\n                    continue\n\n                # 3. Construct operators v_y(k) and j_x^s(k)\n                vy_k = (2 * t * np.sin(ky)) * sigma0 + alpha * np.cos(ky) * sigma_x\n                jxs_k = (t * np.sin(kx)) * sigma_z\n                \n                # 4. Calculate matrix elements\n                # Numpy's vdot computes u_conj.T @ v\n                v_21 = np.vdot(u2, vy_k @ u1)\n                j_12 = np.vdot(u1, jxs_k @ u2)\n                \n                # 5. Calculate numerator of spin Berry curvature\n                numerator_im_part = np.imag(j_12 * v_21)\n\n                # 6. Calculate spin Berry curvature for the lower band (n=1)\n                Omega1 = -2 * numerator_im_part / (energy_gap**2)\n\n                # 7. Sum contributions based on Fermi level occupation\n                # sigma_sH = sum_k (f(E1)*Omega1 + f(E2)*Omega2)\n                # Since Omega2 = -Omega1, this is sum_k (f(E1)-f(E2))*Omega1\n                # At T=0, f(E) is a step function Theta(E_F - E).\n                contribution = 0.0\n                if E1  E_F:\n                    contribution += Omega1\n                if E2  E_F:\n                    contribution -= Omega1 # equivalent to adding Omega2\n\n                total_sigma_sh_sum += contribution\n\n        # Average over all k-points\n        sigma_sh = total_sigma_sh_sum / (Nk**2)\n        \n        return sigma_sh\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (t,   alpha, E_F,   Nk)\n        (1.0, 0.35, -3.20, 25),\n        (1.0, 0.35, -3.20, 51),\n        (1.0, 0.35, -3.20, 101),\n        (1.0, 0.00, 0.00, 31),\n        (1.0, 0.60, 0.00, 81),\n    ]\n\n    results = []\n    for params in test_cases:\n        t, alpha, E_F, Nk = params\n        result = calculate_sigma_sh(t, alpha, E_F, Nk)\n        # Round to six decimal places as required\n        results.append(round(result, 6))\n\n    # Format and print the final output as a single-line list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2860271"}]}