{"hands_on_practices": [{"introduction": "The Jullière model provides the first quantitative link between the macroscopic tunneling magnetoresistance (TMR) effect and the microscopic electronic structure of the ferromagnetic electrodes. It posits that the TMR ratio depends directly on the spin polarization $P$ of the materials at the Fermi level. This foundational exercise [@problem_id:1825627] will allow you to apply the Jullière model to calculate the TMR ratio for an asymmetric junction, building a crucial intuition for how material properties govern spintronic device performance.", "problem": "In the development of next-generation data storage technologies, such as Magnetic Random-Access Memory (MRAM), the Magnetic Tunnel Junction (MTJ) is a critical component. An MTJ consists of two ferromagnetic electrodes separated by a thin insulating barrier. The electrical resistance of the device depends on the relative orientation of the magnetization of the two electrodes. This phenomenon is known as Tunneling Magnetoresistance (TMR).\n\nConsider an asymmetric MTJ being designed for an MRAM cell. The two ferromagnetic electrodes are made of different materials, leading to different effective spin polarizations at the Fermi level. Let the spin polarization of the first electrode be $P_1 = 0.35$ and that of the second electrode be $P_2 = 0.52$. The spin polarization $P$ of a material is defined by the density of states for spin-up ($N_{\\uparrow}$) and spin-down ($N_{\\downarrow}$) electrons at the Fermi level as $P = (N_{\\uparrow} - N_{\\downarrow}) / (N_{\\uparrow} + N_{\\downarrow})$.\n\nThe TMR ratio is defined as $TMR = (R_{AP} - R_P) / R_P$, where $R_P$ is the resistance when the magnetizations of the electrodes are parallel, and $R_{AP}$ is the resistance when they are antiparallel.\n\nAssuming that the tunneling process is spin-conserving and that the tunneling conductance is proportional to the product of the densities of states of the two electrodes at the Fermi level for each spin channel (the Jullière model), calculate the theoretical TMR ratio for this device. Express your answer as a dimensionless decimal value, rounded to three significant figures.", "solution": "We use the Jullière model with spin-conserving tunneling, where the conductance for each spin channel is proportional to the product of the corresponding densities of states at the Fermi level. Let $N_{i\\uparrow}$ and $N_{i\\downarrow}$ denote spin-up and spin-down densities of states for electrode $i$, and $N_{i}=N_{i\\uparrow}+N_{i\\downarrow}$ its total density of states. The spin polarization is $P_{i}=(N_{i\\uparrow}-N_{i\\downarrow})/N_{i}$, so\n$$\nN_{i\\uparrow}=\\frac{1+P_{i}}{2}N_{i},\\qquad N_{i\\downarrow}=\\frac{1-P_{i}}{2}N_{i}.\n$$\nThe parallel and antiparallel conductances are\n$$\nG_{P}\\propto N_{1\\uparrow}N_{2\\uparrow}+N_{1\\downarrow}N_{2\\downarrow},\\qquad\nG_{AP}\\propto N_{1\\uparrow}N_{2\\downarrow}+N_{1\\downarrow}N_{2\\uparrow}.\n$$\nSubstituting the expressions for $N_{i\\uparrow}$ and $N_{i\\downarrow}$ gives\n$$\nG_{P}\\propto \\frac{N_{1}N_{2}}{4}\\left[(1+P_{1})(1+P_{2})+(1-P_{1})(1-P_{2})\\right]\n=\\frac{N_{1}N_{2}}{2}\\left(1+P_{1}P_{2}\\right),\n$$\n$$\nG_{AP}\\propto \\frac{N_{1}N_{2}}{4}\\left[(1+P_{1})(1-P_{2})+(1-P_{1})(1+P_{2})\\right]\n=\\frac{N_{1}N_{2}}{2}\\left(1-P_{1}P_{2}\\right).\n$$\nSince resistance is inversely proportional to conductance, the TMR ratio is\n$$\nTMR=\\frac{R_{AP}-R_{P}}{R_{P}}=\\frac{G_{P}}{G_{AP}}-1\n=\\frac{1+P_{1}P_{2}}{1-P_{1}P_{2}}-1=\\frac{2P_{1}P_{2}}{1-P_{1}P_{2}}.\n$$\nWith $P_{1}=0.35$ and $P_{2}=0.52$, we have $P_{1}P_{2}=0.182$, so\n$$\nTMR=\\frac{2\\times 0.182}{1-0.182}=\\frac{0.364}{0.818}\\approx 0.445,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{0.445}$$", "id": "1825627"}, {"introduction": "While the Jullière model offers valuable initial insight, it fails to explain the exceptionally high TMR ratios observed in modern magnetic tunnel junctions with crystalline barriers like magnesium oxide (MgO). The key lies in coherent quantum tunneling and symmetry filtering, where the barrier preferentially transmits electrons of a specific symmetry, such as the $\\Delta_1$ channel. This practice [@problem_id:3022680] challenges you to first apply the simple Jullière model using Density Functional Theory (DFT) data and then contrast this result with a more physically accurate analysis based on the symmetry-resolved density of states, revealing the profound impact of coherent effects.", "problem": "Consider symmetric magnetic tunnel junctions with a magnesium oxide barrier, where coherent tunneling is known to be dominated by the $\\Delta_{1}$ Bloch symmetry channel at the Brillouin-zone center. Two candidate ferromagnetic electrodes, labeled material $A$ and material $B$, have been characterized by Density Functional Theory (DFT) calculations of their spin- and symmetry-resolved partial density of states (DOS) at the Fermi energy $E_{F}$, reported per atom in states per electronvolt. The available data are:\n- Material $A$: $\\Delta_{1}$ majority $N_{A,\\Delta_{1}}^{\\uparrow} = 1.8$, $\\Delta_{1}$ minority $N_{A,\\Delta_{1}}^{\\downarrow} = 0.05$, $\\Delta_{5}$ majority $N_{A,\\Delta_{5}}^{\\uparrow} = 0.6$, $\\Delta_{5}$ minority $N_{A,\\Delta_{5}}^{\\downarrow} = 0.4$.\n- Material $B$: $\\Delta_{1}$ majority $N_{B,\\Delta_{1}}^{\\uparrow} = 0.9$, $\\Delta_{1}$ minority $N_{B,\\Delta_{1}}^{\\downarrow} = 0.7$, $\\Delta_{5}$ majority $N_{B,\\Delta_{5}}^{\\uparrow} = 1.0$, $\\Delta_{5}$ minority $N_{B,\\Delta_{5}}^{\\downarrow} = 0.2$.\n\nAssume that the Julliere approximation holds, in which spin-dependent tunneling conductance is determined by the spin polarization of the electrodes defined from the total spin-resolved DOS at $E_{F}$ (summing all symmetry channels that contribute to tunneling). Using only the provided DOS values and starting from first principles of spin-dependent transport, compute the expected tunneling magnetoresistance ratio for each symmetric junction $A/A$ and $B/B$ under the Julliere approximation.\n\nAdditionally, based only on the symmetry-resolved DOS, determine which material is more promising for coherent enhancement with a magnesium oxide barrier, and justify your choice qualitatively in your reasoning.\n\nExpress each tunneling magnetoresistance ratio as a decimal number (dimensionless). Round your answers to four significant figures.", "solution": "The solution involves two parts: a quantitative calculation using the Jullière model and a qualitative analysis based on the principles of coherent symmetry filtering.\n\n**Part 1: TMR Calculation using the Jullière Model**\n\nThe Jullière model relates the TMR to the spin polarizations of the electrodes ($P_1, P_2$). For a symmetric junction ($P_1 = P_2 = P$), the formula is:\n$$ TMR = \\frac{2 P^2}{1 - P^2} $$\nThe spin polarization $P$ is calculated from the total majority-spin ($N^{\\uparrow}$) and minority-spin ($N^{\\downarrow}$) density of states (DOS) at the Fermi energy:\n$$ P = \\frac{N^{\\uparrow} - N^{\\downarrow}}{N^{\\uparrow} + N^{\\downarrow}} $$\nFor the Jullière model, we sum the DOS over all provided symmetry channels.\n\n**Calculation for Material A ($A/A$ junction):**\n1.  Calculate total spin-resolved DOS for material A:\n    *   Total majority-spin DOS: $N_A^{\\uparrow} = N_{A,\\Delta_{1}}^{\\uparrow} + N_{A,\\Delta_{5}}^{\\uparrow} = 1.8 + 0.6 = 2.4$ states/eV/atom.\n    *   Total minority-spin DOS: $N_A^{\\downarrow} = N_{A,\\Delta_{1}}^{\\downarrow} + N_{A,\\Delta_{5}}^{\\downarrow} = 0.05 + 0.4 = 0.45$ states/eV/atom.\n2.  Compute the spin polarization $P_A$:\n    $$ P_A = \\frac{N_A^{\\uparrow} - N_A^{\\downarrow}}{N_A^{\\uparrow} + N_A^{\\downarrow}} = \\frac{2.4 - 0.45}{2.4 + 0.45} = \\frac{1.95}{2.85} \\approx 0.68421 $$\n3.  Calculate the TMR for the symmetric $A/A$ junction:\n    $$ TMR_A = \\frac{2 P_A^2}{1 - P_A^2} = \\frac{2 (0.68421)^2}{1 - (0.68421)^2} \\approx \\frac{0.93628}{0.53186} \\approx 1.76033 $$\n    Rounding to four significant figures, $TMR_A = 1.760$.\n\n**Calculation for Material B ($B/B$ junction):**\n1.  Calculate total spin-resolved DOS for material B:\n    *   Total majority-spin DOS: $N_B^{\\uparrow} = N_{B,\\Delta_{1}}^{\\uparrow} + N_{B,\\Delta_{5}}^{\\uparrow} = 0.9 + 1.0 = 1.9$ states/eV/atom.\n    *   Total minority-spin DOS: $N_B^{\\downarrow} = N_{B,\\Delta_{1}}^{\\downarrow} + N_{B,\\Delta_{5}}^{\\downarrow} = 0.7 + 0.2 = 0.9$ states/eV/atom.\n2.  Compute the spin polarization $P_B$:\n    $$ P_B = \\frac{N_B^{\\uparrow} - N_B^{\\downarrow}}{N_B^{\\uparrow} + N_B^{\\downarrow}} = \\frac{1.9 - 0.9}{1.9 + 0.9} = \\frac{1.0}{2.8} \\approx 0.35714 $$\n3.  Calculate the TMR for the symmetric $B/B$ junction:\n    $$ TMR_B = \\frac{2 P_B^2}{1 - P_B^2} = \\frac{2 (0.35714)^2}{1 - (0.35714)^2} \\approx \\frac{0.25510}{0.87245} \\approx 0.29239 $$\n    Rounding to four significant figures, $TMR_B = 0.2924$.\n\n**Part 2: Qualitative Assessment for Coherent Tunneling with MgO**\n\nCoherent tunneling through a crystalline MgO barrier is dominated by symmetry filtering. The MgO barrier preferentially transmits electrons with $\\Delta_1$ symmetry because their wavefunctions decay much more slowly inside the barrier compared to other symmetries like $\\Delta_5$. Therefore, a material's potential for high TMR in an MgO-based junction is determined by the spin polarization of its $\\Delta_1$ states, not its total spin polarization.\n\nAn ideal material would have a large number of $\\Delta_1$ states for one spin channel and very few for the other.\n*   **Material A:** Has a large majority-spin $\\Delta_1$ DOS ($N_{A,\\Delta_{1}}^{\\uparrow} = 1.8$) and a very small minority-spin $\\Delta_1$ DOS ($N_{A,\\Delta_{1}}^{\\downarrow} = 0.05$). This creates a high degree of spin polarization within the dominant tunneling channel, making it an excellent candidate for high TMR.\n*   **Material B:** Has comparable majority-spin ($N_{B,\\Delta_{1}}^{\\uparrow} = 0.9$) and minority-spin ($N_{B,\\Delta_{1}}^{\\downarrow} = 0.7$) $\\Delta_1$ DOS. The spin polarization of its $\\Delta_1$ channel is low, making it a poor candidate for a high-TMR device with an MgO barrier.\n\nTherefore, **material A is significantly more promising** for achieving high TMR due to its highly spin-polarized $\\Delta_1$ electronic states, which are perfectly suited for the symmetry filtering mechanism of the MgO barrier.", "answer": "$$ \\boxed{\\begin{pmatrix} 1.760  0.2924 \\end{pmatrix}} $$", "id": "3022680"}, {"introduction": "To quantitatively capture the physics of coherent tunneling, we must move beyond simple models and employ advanced computational techniques. This practice [@problem_id:3022624] guides you through the implementation of a state-of-the-art simulation using the Non-Equilibrium Green's Function (NEGF) formalism combined with a tight-binding Hamiltonian. By calculating the spin-dependent conductances from the $k$-resolved transmission across the Brillouin zone, you will gain hands-on experience with the powerful first-principles methods that are essential for designing and understanding next-generation spintronic devices.", "problem": "Consider a collinear spin, ballistic transport calculation of tunneling magnetoresistance through an epitaxial Iron/Magnesium Oxide/Iron junction modeled at the level of Density Functional Theory (DFT) mapped onto a nearest-neighbor Wannier tight-binding Hamiltonian. Your task is to construct a two-dimensional in-plane, $k$-resolved Non-Equilibrium Green’s Function (NEGF) calculation of the parallel and antiparallel conductances, denoted $G_P$ and $G_{AP}$, for an $\\mathrm{Fe}/\\mathrm{MgO}/\\mathrm{Fe}$ junction. Use the Landauer–Büttiker formalism and a spin-diagonal Hamiltonian without spin–orbit coupling. Treat each in-plane wavevector $k_\\parallel \\equiv (k_x,k_y)$ independently and assume perfect in-plane translational invariance.\n\nFundamental base to use:\n- The Landauer–Büttiker formula for conductance at zero temperature and low bias, $G = \\dfrac{e^2}{h} \\mathcal{T}$, where $e$ is the elementary charge, $h$ is Planck’s constant, and $\\mathcal{T}$ is the total transmission probability at the Fermi energy.\n- For a two-dimensional crystal with in-plane periodicity, the total conductance is the integral over the two-dimensional Brillouin zone of the $k$-resolved transmission, $G = \\dfrac{e^2}{h} \\dfrac{A_c}{(2\\pi)^2} \\int_{\\mathrm{BZ}} \\mathrm{d}^2 k_\\parallel \\, T(k_\\parallel)$, where $A_c$ is the in-plane unit cell area and $T(k_\\parallel)$ is the transmission at $k_\\parallel$.\n- In the NEGF approach, with retarded Green’s function $G^r$ at energy $E$, and left/right lead coupling matrices $\\Gamma_L$ and $\\Gamma_R$, the transmission for a given $k_\\parallel$ is $T(k_\\parallel) = \\mathrm{Tr}\\left[\\Gamma_L(k_\\parallel) G^r(k_\\parallel) \\Gamma_R(k_\\parallel) G^a(k_\\parallel)\\right]$, where $G^a$ is the advanced Green’s function and $G^a = (G^r)^\\dagger$ for Hermitian systems.\n- A semi-infinite periodic lead, represented in a principal-layer form with on-site energy $\\alpha(k_\\parallel)$ and interlayer coupling $\\beta$, has a surface Green’s function $g_s(k_\\parallel)$ that solves the quadratic equation $\\beta^2 g_s^2 - (E - \\alpha(k_\\parallel)) g_s + 1 = 0$, with the retarded root selected by the condition $\\mathrm{Im}\\, g_s(k_\\parallel)  0$. The corresponding retarded self-energy is $\\Sigma^r = \\tau^2 g_s$, where $\\tau$ is the interface coupling between the device region and the lead’s surface principal layer, and the coupling/broadening is $\\Gamma = i\\left(\\Sigma^r - \\Sigma^a\\right)$ with $\\Sigma^a = (\\Sigma^r)^\\dagger$.\n\nModel specification:\n- Treat the device region as $N_b$ layers of $\\mathrm{MgO}$ stacked along the transport direction $z$, with a scalar tight-binding Hamiltonian per $k_\\parallel$. The in-plane dispersion in each barrier layer is $e_b(k_\\parallel) = \\epsilon_b + 2 t_{b,\\parallel}\\left[\\cos(k_x a) + \\cos(k_y a)\\right]$, and interlayer hopping $t_{b,z}$ between adjacent barrier layers. The device Hamiltonian $H_b(k_\\parallel)$ is tridiagonal of size $N_b \\times N_b$ with diagonal elements $e_b(k_\\parallel)$ and off-diagonal elements $t_{b,z}$.\n- The left and right $\\mathrm{Fe}$ leads are semi-infinite, each described in the same principal-layer scheme with in-plane dispersions $e_{s}(k_\\parallel) = \\epsilon_s + 2 t_{s,\\parallel}\\left[\\cos(k_x a) + \\cos(k_y a)\\right]$, interlayer coupling $t_{s,z}$, and interface couplings $\\tau_s$ to the barrier, for spin $s \\in \\{\\uparrow,\\downarrow\\}$.\n- The Fermi energy is $E_F$, and a small positive imaginary part $i\\eta$ is added to $E$ to ensure the retarded boundary condition, i.e., $E \\to E_F + i\\eta$.\n\nSpin alignment:\n- Parallel (P): The left and right leads share the same spin parameters for each spin channel; the total transmission at $k_\\parallel$ is $T_P(k_\\parallel) = T_\\uparrow(k_\\parallel) + T_\\downarrow(k_\\parallel)$.\n- Antiparallel (AP): The left lead’s majority channel couples to the right lead’s minority parameters, and vice versa; the total transmission at $k_\\parallel$ is $T_{AP}(k_\\parallel) = T_{\\uparrow \\to \\downarrow}(k_\\parallel) + T_{\\downarrow \\to \\uparrow}(k_\\parallel)$.\n\nPer $k_\\parallel$ and per spin channel, for a scalar device chain of length $N_b$, the transmission reduces to $T(k_\\parallel) = \\Gamma_L(k_\\parallel)\\,\\Gamma_R(k_\\parallel)\\,\\left|G^r_{1N}(k_\\parallel)\\right|^2$, where $G^r_{1N}$ is the end-to-end matrix element of the device Green’s function including the self-energies at the ends. Use $G^r(k_\\parallel) = \\left[(E_F + i\\eta) I - H_b(k_\\parallel) - \\Sigma_L^r(k_\\parallel) - \\Sigma_R^r(k_\\parallel)\\right]^{-1}$, where $\\Sigma_L^r$ and $\\Sigma_R^r$ are added only to the $(1,1)$ and $(N,N)$ positions respectively.\n\nIntegration over $k_\\parallel$:\n- Use a uniform mesh of $N_{kx} \\times N_{ky}$ points in the two-dimensional Brillouin zone of a square lattice with lattice parameter $a$, sampling $k_x a, k_y a \\in [-\\pi,\\pi)$ uniformly. Show that, for the square lattice unit cell with area $A_c = a^2$, the conductance simplifies to $G = \\dfrac{e^2}{h}\\,\\dfrac{1}{N_{kx} N_{ky}}\\sum_{k_\\parallel} T(k_\\parallel)$, i.e., the Brillouin-zone average of the transmission times $\\dfrac{e^2}{h}$.\n\nAcronyms to define: Density Functional Theory (DFT), Non-Equilibrium Green’s Function (NEGF), Tunneling Magnetoresistance (TMR).\n\nUnits and output:\n- Express all energies in electronvolts and the final conductances in siemens. The angle variables $k_x a$ and $k_y a$ must be in radians. The final outputs $G_P$ and $G_{AP}$ for each test case must be reported in siemens as floats.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each float formatted in scientific notation with $6$ significant digits, in the order $[G_P^{(1)},G_{AP}^{(1)},G_P^{(2)},G_{AP}^{(2)},G_P^{(3)},G_{AP}^{(3)}]$.\n\nTest suite:\nUse the following three scientifically plausible parameter sets (the lead parameters emulate DFT-derived Wannier tight-binding for $\\mathrm{Fe}$, and the barrier parameters emulate $\\mathrm{MgO}$; all energies in electronvolts, $a$ is the in-plane lattice constant):\n- Common constants for all tests: $E_F = 0$, $\\eta = 10^{-6}$, $a = 2.86\\times 10^{-10}\\,\\mathrm{m}$.\n- Lead parameters (left and right identical in structure; spins differ):\n  - Majority spin ($\\uparrow$): $\\epsilon_\\uparrow = -1.0$, $t_{\\uparrow,\\parallel} = 1.0$, $t_{\\uparrow,z} = 1.5$, $\\tau_\\uparrow = 0.9$.\n  - Minority spin ($\\downarrow$): $\\epsilon_\\downarrow = 0.5$, $t_{\\downarrow,\\parallel} = 0.8$, $t_{\\downarrow,z} = 1.2$, $\\tau_\\downarrow = 0.6$.\n- Test case $1$ (happy path, moderate barrier): $N_b = 6$, $\\epsilon_b = 6.0$, $t_{b,\\parallel} = 0.1$, $t_{b,z} = 0.2$, $N_{kx} = 31$, $N_{ky} = 31$.\n- Test case $2$ (boundary, ultrathin barrier): $N_b = 1$, $\\epsilon_b = 6.0$, $t_{b,\\parallel} = 0.1$, $t_{b,z} = 0.2$, $N_{kx} = 31$, $N_{ky} = 31$.\n- Test case $3$ (edge, thicker and higher barrier, coarser sampling): $N_b = 8$, $\\epsilon_b = 8.0$, $t_{b,\\parallel} = 0.1$, $t_{b,z} = 0.2$, $N_{kx} = 9$, $N_{ky} = 9$.\n\nYour program must implement the above model to compute $G_P$ and $G_{AP}$ for each test case by $k$-resolved Green’s functions and output them in the specified format. No external input is permitted; all parameters must be hard-coded exactly as above.", "solution": "The problem posed is a well-defined and scientifically grounded exercise in computational condensed matter physics. It requires the calculation of tunneling magnetoresistance (TMR) for an $\\mathrm{Fe}/\\mathrm{MgO}/\\mathrm{Fe}$ magnetic tunnel junction. The model is based on a nearest-neighbor tight-binding Hamiltonian, and the transport properties are to be determined using the Non-Equilibrium Green's Function (NEGF) formalism within the Landauer-Büttiker framework. All necessary parameters, equations, and a clear computational procedure are provided.\n\nFirst, we define the key acronyms as requested:\n- **Density Functional Theory (DFT):** A quantum mechanical modeling method used in physics, chemistry, and materials science to investigate the electronic structure (principally the ground state) of many-body systems, particularly atoms, molecules, and the condensed phases.\n- **Non-Equilibrium Green’s Function (NEGF):** A powerful theoretical framework used to study quantum transport phenomena in nanoscale systems. It allows for the calculation of properties like current and conductance, even when the system is driven out of thermal equilibrium by external biases.\n- **Tunneling Magnetoresistance (TMR):** A quantum mechanical magnetoresistive effect that occurs in a magnetic tunnel junction (MTJ), which consists of two ferromagnetic electrodes separated by a thin insulating layer. The junction's electrical resistance depends on the relative orientation of the magnetization in the two electrodes, being low for parallel (P) alignment and high for antiparallel (AP) alignment.\n\nThe overall goal is to compute the spin-resolved conductances for both parallel ($G_P$) and antiparallel ($G_{AP}$) magnetic configurations. The calculation is performed at zero temperature and low bias, where the conductance $G$ is given by the Landauer-Büttiker formula:\n$$\nG = \\frac{e^2}{h} \\mathcal{T}\n$$\nwhere $\\frac{e^2}{h}$ is the quantum of conductance and $\\mathcal{T}$ is the total transmission probability at the Fermi energy, $E_F$. For a system with two-dimensional periodicity in the plane transverse to transport, the total conductance is found by integrating the $k$-resolved transmission, $T(k_\\parallel)$, over the 2D Brillouin Zone (BZ):\n$$\nG = \\frac{e^2}{h} \\frac{A_c}{(2\\pi)^2} \\int_{\\mathrm{BZ}} \\mathrm{d}^2 k_\\parallel \\, T(k_\\parallel)\n$$\nHere, $k_\\parallel = (k_x, k_y)$ is the in-plane wavevector and $A_c = a^2$ is the area of the in-plane unit cell for a square lattice with constant $a$. The problem specifies using a discrete uniform mesh of $N_{kx} \\times N_{ky}$ points in the BZ. This transforms the integral into a summation:\n$$\nG = \\frac{e^2}{h} \\frac{a^2}{(2\\pi)^2} \\sum_{k_\\parallel} T(k_\\parallel) \\Delta k_x \\Delta k_y = \\frac{e^2}{h} \\frac{a^2}{(2\\pi)^2} \\sum_{k_\\parallel} T(k_\\parallel) \\left(\\frac{2\\pi/a}{N_{kx}}\\right) \\left(\\frac{2\\pi/a}{N_{ky}}\\right) = \\frac{e^2}{h} \\frac{1}{N_{kx} N_{ky}} \\sum_{k_\\parallel} T(k_\\parallel)\n$$\nThus, the conductance is the conductance quantum multiplied by the average transmission over the sampled $k$-points. Our primary task is to calculate $T(k_\\parallel)$ for each configuration.\n\nThe calculation of $T(k_\\parallel)$ for a specific spin channel is performed using the NEGF framework. The system is divided into a central device region (the $\\mathrm{MgO}$ barrier) and two semi-infinite leads (the $\\mathrm{Fe}$ electrodes). The effect of the leads on the device is captured by self-energies, $\\Sigma_L^r(k_\\parallel)$ and $\\Sigma_R^r(k_\\parallel)$.\n\nThe algorithm proceeds as follows for each point $k_\\parallel$ in the BZ mesh, for each spin channel specified by the left and right lead parameters:\n\n1.  **Calculate Lead Properties:** For each lead (left and right), we first determine its retarded self-energy $\\Sigma^r$ and broadening $\\Gamma$. This requires the surface Green's function of the semi-infinite lead, $g_s(k_\\parallel)$, which is obtained by solving the quadratic matrix equation for a principal layer representation. For the scalar case here, this simplifies to:\n    $$\n    \\beta^2 g_s^2 - (E - \\alpha(k_\\parallel)) g_s + 1 = 0\n    $$\n    Here, $E = E_F + i\\eta$ is the complex energy ($E_F=0$ in this problem), $\\alpha(k_\\parallel) = \\epsilon_s + 2 t_{s,\\parallel}(\\cos(k_x a) + \\cos(k_y a))$ is the $k_\\parallel$-dependent on-site energy of a principal layer in lead $s$, and $\\beta = t_{s,z}$ is the interlayer coupling. We solve this for $g_s$ and select the retarded root, which satisfies the condition $\\mathrm{Im}[g_s(k_\\parallel)]  0$. The self-energy and broadening are then given by:\n    $$\n    \\Sigma^r(k_\\parallel) = \\tau_s^2 g_s(k_\\parallel)\n    $$\n    $$\n    \\Gamma(k_\\parallel) = i[\\Sigma^r(k_\\parallel) - \\Sigma^a(k_\\parallel)] = i[\\Sigma^r(k_\\parallel) - (\\Sigma^r(k_\\parallel))^\\dagger] = -2\\,\\mathrm{Im}[\\Sigma^r(k_\\parallel)]\n    $$\n    where $\\tau_s$ is the coupling between the lead and the device region. This is done for both left ($L$) and right ($R$) leads, which may have different spin parameters in the AP configuration.\n\n2.  **Construct the Device Green's Function:** The device is described by an $N_b \\times N_b$ tight-binding Hamiltonian matrix $H_b(k_\\parallel)$. It is tridiagonal, with diagonal elements $H_{b,ii} = e_b(k_\\parallel) = \\epsilon_b + 2 t_{b,\\parallel}(\\cos(k_x a) + \\cos(k_y a))$ and off-diagonal elements $H_{b,i,i+1} = H_{b,i+1,i} = t_{b,z}$. The retarded Green's function of the device, including the influence of the leads, is found by matrix inversion:\n    $$\n    G^r(k_\\parallel) = \\left[ (E_F + i\\eta)I - H_b(k_\\parallel) - \\Sigma_L^r(k_\\parallel) - \\Sigma_R^r(k_\\parallel) \\right]^{-1}\n    $$\n    where $I$ is the identity matrix, and the self-energies $\\Sigma_L^r$ and $\\Sigma_R^r$ are non-zero only at the $(1,1)$ and $(N_b, N_b)$ positions of the matrix, respectively.\n\n3.  **Calculate Transmission:** For a one-dimensional chain-like device, the transmission simplifies from a general trace formula to:\n    $$\n    T_{\\text{channel}}(k_\\parallel) = \\Gamma_L(k_\\parallel) \\Gamma_R(k_\\parallel) |G^r_{1,N_b}(k_\\parallel)|^2\n    $$\n    where $G^r_{1,N_b}$ is the matrix element of the Green's function connecting the first and last layers of the barrier.\n\nThis procedure gives the transmission for a single spin channel. To find the total transmission at $k_\\parallel$ for the P and AP configurations, we sum over the relevant spin channels:\n-   **Parallel (P) Configuration:** The spin character is conserved. We calculate $T_\\uparrow$ (L-up to R-up) and $T_\\downarrow$ (L-down to R-down) independently and sum them.\n    $$\n    T_P(k_\\parallel) = T_{\\uparrow \\to \\uparrow}(k_\\parallel) + T_{\\downarrow \\to \\downarrow}(k_\\parallel)\n    $$\n-   **Antiparallel (AP) Configuration:** The majority spin channel of the left lead couples to the minority of the right, and vice versa.\n    $$\n    T_{AP}(k_\\parallel) = T_{\\uparrow \\to \\downarrow}(k_\\parallel) + T_{\\downarrow \\to \\uparrow}(k_\\parallel)\n    $$\n\nFinally, we sum these $T_P(k_\\parallel)$ and $T_{AP}(k_\\parallel)$ values over all $k_\\parallel$ points in the BZ mesh, divide by the total number of points $N_{kx}N_{ky}$ to get the average transmissions $\\bar{T}_P$ and $\\bar{T}_{AP}$, and multiply by the conductance quantum $e^2/h$ to obtain the final conductances $G_P$ and $G_{AP}$. The entire procedure is repeated for each of the three test cases.\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for TMR in Fe/MgO/Fe junctions for given test cases.\n    \"\"\"\n    # Physical constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    H_PLANCK = 6.62607015e-34    # Planck's constant in J*s\n    G0 = E_CHARGE**2 / H_PLANCK # Conductance quantum in Siemens\n\n    # Common parameters for all test cases (energies in eV)\n    E_F = 0.0\n    eta = 1e-6\n\n    # Lead parameters (Fe), spin-dependent (energies in eV)\n    up_params = {'eps': -1.0, 't_par': 1.0, 't_z': 1.5, 'tau': 0.9}\n    down_params = {'eps': 0.5, 't_par': 0.8, 't_z': 1.2, 'tau': 0.6}\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nb, eps_b, t_b_par, t_b_z, Nkx, Nky)\n        (6, 6.0, 0.1, 0.2, 31, 31),  # Test case 1\n        (1, 6.0, 0.1, 0.2, 31, 31),  # Test case 2\n        (8, 8.0, 0.1, 0.2, 9, 9),    # Test case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        Nb, eps_b, t_b_par, t_b_z, Nkx, Nky = case\n        \n        # Unpack case-specific barrier parameters\n        barrier_params = {'eps': eps_b, 't_par': t_b_par, 't_z': t_b_z}\n        \n        # Calculate conductances for the current case\n        gp, gap = calculate_conductances(\n            Nb, barrier_params, Nkx, Nky, E_F, eta, G0,\n            up_params, down_params\n        )\n        results.extend([gp, gap])\n\n    # Format output as specified\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_lead_properties(kxa, kya, E_complex, lead_params):\n    \"\"\"\n    Calculates the retarded self-energy and broadening for a semi-infinite lead.\n    \"\"\"\n    eps_s, t_s_par, t_s_z, tau_s = lead_params['eps'], lead_params['t_par'], lead_params['t_z'], lead_params['tau']\n\n    alpha_k = eps_s + 2 * t_s_par * (np.cos(kxa) + np.cos(kya))\n    beta = t_s_z\n\n    # Solve quadratic equation for surface Green's function gs\n    term_in_sqrt = (E_complex - alpha_k)**2 - 4 * beta**2\n    sqrt_term = np.sqrt(term_in_sqrt)\n    \n    gs1 = ((E_complex - alpha_k) + sqrt_term) / (2 * beta**2)\n    gs2 = ((E_complex - alpha_k) - sqrt_term) / (2 * beta**2)\n\n    # Select the retarded root (Im(gs)  0)\n    gs = gs1 if gs1.imag  0 else gs2\n    \n    # Self-energy Sigma_r\n    sigma_r = tau_s**2 * gs\n\n    # Broadening Gamma = -2 * Im(Sigma_r)\n    gamma = -2 * sigma_r.imag\n\n    return sigma_r, gamma\n\ndef get_transmission(kxa, kya, Nb, eb_k, t_b_z, E_complex, left_lead_params, right_lead_params):\n    \"\"\"\n    Calculates the transmission for a single k-point and a single spin channel.\n    \"\"\"\n    sigma_L, gamma_L = calculate_lead_properties(kxa, kya, E_complex, left_lead_params)\n    sigma_R, gamma_R = calculate_lead_properties(kxa, kya, E_complex, right_lead_params)\n\n    if gamma_L == 0 or gamma_R == 0:\n        return 0.0\n\n    if Nb == 1:\n        M_scalar = E_complex - eb_k - sigma_L - sigma_R\n        Gr_1N = 1.0 / M_scalar\n    else:\n        H_b = np.zeros((Nb, Nb), dtype=complex)\n        np.fill_diagonal(H_b, eb_k)\n        off_diag = np.full(Nb - 1, -t_b_z)\n        H_b += np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n        \n        M = E_complex * np.identity(Nb) - H_b\n        M[0, 0] -= sigma_L\n        M[Nb-1, Nb-1] -= sigma_R\n        \n        try:\n            Gr = np.linalg.inv(M)\n            Gr_1N = Gr[0, Nb-1]\n        except np.linalg.LinAlgError:\n            return 0.0\n\n    T = gamma_L * gamma_R * np.abs(Gr_1N)**2\n    return T\n\ndef calculate_conductances(Nb, barrier_params, Nkx, Nky, E_F, eta, G0, up_params, down_params):\n    \"\"\"\n    Calculates and returns G_P and G_AP by integrating over the Brillouin zone.\n    \"\"\"\n    E_complex = E_F + 1j * eta\n    \n    kx_a = np.linspace(-np.pi, np.pi, Nkx, endpoint=False)\n    ky_a = np.linspace(-np.pi, np.pi, Nky, endpoint=False)\n\n    total_T_P = 0.0\n    total_T_AP = 0.0\n\n    for kxa in kx_a:\n        for kya in ky_a:\n            cos_term = np.cos(kxa) + np.cos(kya)\n            eb_k = barrier_params['eps'] + 2 * barrier_params['t_par'] * cos_term\n            \n            # --- Parallel Configuration ---\n            T_up_up = get_transmission(kxa, kya, Nb, eb_k, barrier_params['t_z'], E_complex, up_params, up_params)\n            T_down_down = get_transmission(kxa, kya, Nb, eb_k, barrier_params['t_z'], E_complex, down_params, down_params)\n            total_T_P += (T_up_up + T_down_down)\n            \n            # --- Antiparallel Configuration ---\n            T_up_down = get_transmission(kxa, kya, Nb, eb_k, barrier_params['t_z'], E_complex, up_params, down_params)\n            T_down_up = get_transmission(kxa, kya, Nb, eb_k, barrier_params['t_z'], E_complex, down_params, up_params)\n            total_T_AP += (T_up_down + T_down_up)\n            \n    avg_T_P = total_T_P / (Nkx * Nky)\n    avg_T_AP = total_T_AP / (Nkx * Nky)\n\n    G_P = G0 * avg_T_P\n    G_AP = G0 * avg_T_AP\n\n    return G_P, G_AP\n\n# The following lines are for execution and would be used to generate the answer.\n# if __name__ == '__main__':\n#     solve()\n```", "answer": "[1.32684e-06,2.02941e-10,2.15579e-05,1.26712e-07,3.13600e-11,2.50291e-15]", "id": "3022624"}]}