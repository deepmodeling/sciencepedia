{"hands_on_practices": [{"introduction": "The emergence of topological features like nodal lines is not arbitrary but is deeply rooted in the underlying symmetries of a crystal's lattice and its electronic orbitals. This exercise provides a first-principles look at this connection, guiding you to construct a tight-binding model for the diamond lattice. By considering symmetry-allowed hoppings between $s$ and $p_z$ orbitals, you will derive how these fundamental ingredients give rise to a protected band crossing that forms a nodal ring [@problem_id:3007263].", "problem": "Consider the diamond lattice, which consists of two interpenetrating face-centered cubic sublattices displaced by one quarter of the cubic lattice vector along each axis. Let the conventional cubic lattice constant be $a$, and denote the four nearest-neighbor displacement vectors from sublattice $A$ to sublattice $B$ by\n$$\n\\boldsymbol{\\delta}_{1}=\\frac{a}{4}(1,1,1),\\quad\n\\boldsymbol{\\delta}_{2}=\\frac{a}{4}(1,-1,-1),\\quad\n\\boldsymbol{\\delta}_{3}=\\frac{a}{4}(-1,1,-1),\\quad\n\\boldsymbol{\\delta}_{4}=\\frac{a}{4}(-1,-1,1).\n$$\nBuild a spinless tight-binding model (no Spin-Orbit Coupling (SOC)) with two orbitals per site: an even-parity $s$ orbital and an odd-parity $p_{z}$ orbital. Assume that only nearest-neighbor hoppings between the two sublattices are present, and that the Hamiltonian respects time-reversal and inversion symmetries as well as mirror symmetry under $z\\mapsto -z$. The $s$-$s$ hopping amplitude across a nearest-neighbor bond is a constant $t_{s}$, the $p_{z}$-$p_{z}$ hopping amplitude across a nearest-neighbor bond is $t_{p}$ times the square of the direction cosine of the bond with the $z$ axis, and the $s$-$p_{z}$ hopping amplitude is proportional to the direction cosine of the bond with the $z$ axis (so that it is odd under $z\\mapsto -z$). Let the on-site energies be $\\epsilon_{s}$ and $\\epsilon_{p}$ for $s$ and $p_{z}$, respectively.\n\nUsing the Bloch basis on the diamond lattice and the above symmetry-allowed nearest-neighbor hoppings, construct the Bloch Hamiltonian $H(\\mathbf{k})$ and show that, on the mirror-invariant plane $k_{z}=0$ of the Brillouin Zone (BZ), the $s$ and $p_{z}$ sectors decouple. Then, starting from the symmetry and the definition of the nearest-neighbor structure factor\n$$\nf(\\mathbf{k})=\\sum_{j=1}^{4}\\exp\\!\\big(i\\,\\mathbf{k}\\cdot\\boldsymbol{\\delta}_{j}\\big),\n$$\nderive the small-$|\\mathbf{k}|$ expansion of $f(\\mathbf{k})$ up to second order around the Brillouin-zone center $\\Gamma$ and use it, together with the decoupled band dispersions on $k_{z}=0$, to determine the nodal ring arising from the crossing between the upper $s$ band and the lower $p_{z}$ band.\n\nYour task is to obtain, in the long-wavelength limit near $\\Gamma$, a closed-form analytical expression for the nodal-ring radius $k_{R}$ on the plane $k_{z}=0$, in terms of $a$, $\\epsilon_{p}-\\epsilon_{s}$, $t_{s}$, and $t_{p}$. Express your final answer as a single analytic expression for $k_{R}$ in reciprocal-length units. No numerical evaluation is needed.", "solution": "The user wants to find the radius of a nodal ring in a tight-binding model on a diamond lattice.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   **Lattice**: Diamond lattice, with two sublattices A and B.\n-   **Lattice Constant**: Conventional cubic lattice constant is $a$.\n-   **Nearest-Neighbor Vectors**: The four nearest-neighbor vectors from sublattice A to B are:\n    $$\n    \\boldsymbol{\\delta}_{1}=\\frac{a}{4}(1,1,1),\\quad\n    \\boldsymbol{\\delta}_{2}=\\frac{a}{4}(1,-1,-1),\\quad\n    \\boldsymbol{\\delta}_{3}=\\frac{a}{4}(-1,1,-1),\\quad\n    \\boldsymbol{\\delta}_{4}=\\frac{a}{4}(-1,-1,1).\n    $$\n-   **Basis Orbitals**: Spinless $s$ orbital (even parity) and $p_z$ orbital (odd parity) on each site.\n-   **On-site Energies**: $\\epsilon_s$ for the $s$ orbital, $\\epsilon_p$ for the $p_z$ orbital.\n-   **Hopping Parameters (Nearest-Neighbor, A-B only)**:\n    -   $s$-$s$ hopping: constant $t_s$.\n    -   $p_z$-$p_z$ hopping: $t_p$ times the square of the direction cosine of the bond with the $z$ axis.\n    -   $s$-$p_z$ hopping: proportional to the direction cosine of the bond with the $z$ axis.\n-   **Symmetries**: The Hamiltonian must respect time-reversal, inversion, and mirror symmetry ($z \\mapsto -z$).\n-   **Structure Factor**: $f(\\mathbf{k})=\\sum_{j=1}^{4}\\exp(i\\,\\mathbf{k}\\cdot\\boldsymbol{\\delta}_{j})$.\n-   **Objective**:\n    1.  Construct the Bloch Hamiltonian $H(\\mathbf{k})$.\n    2.  Show that on the $k_z=0$ plane, the $s$ and $p_z$ sectors decouple.\n    3.  Derive the small-$|\\mathbf{k}|$ expansion of $f(\\mathbf{k})$ up to second order.\n    4.  Find the nodal-ring radius $k_R$ on the $k_z=0$ plane from the crossing of the upper $s$ band and lower $p_z$ band.\n\n**1.2. Validate Using Extracted Givens**\nThe problem describes a standard tight-binding model, a cornerstone of condensed matter physics. The setup is physically motivated and based on well-established principles (Slater-Koster formalism for hopping parameters). The requirement of certain symmetries for the Hamiltonian is a common approach in model building. The task of finding band crossings and nodal lines is a central topic in the study of topological semimetals.\nThe problem is:\n-   **Scientifically Grounded**: Yes. It uses standard methods of solid-state theory.\n-   **Well-Posed**: Yes. It provides sufficient information to construct a model and calculate the desired quantity. A unique solution is expected.\n-   **Objective**: Yes. The language is precise and devoid of subjective claims.\n\nThere is a subtle point regarding the mirror symmetry $M_z: z \\to -z$. For the standard diamond lattice, this operation is not a point group symmetry of the crystal structure itself. However, the problem states that the *Hamiltonian* respects this symmetry. This is a valid way to define a model, assuming this symmetry is either emergent or an idealization. The consequences of this imposed symmetry can be worked out rigorously. The problem statement to show that the sectors decouple on the $k_z=0$ plane is a direct consequence of this symmetry, as will be shown. Therefore, the problem is self-consistent and valid.\n\n**1.3. Verdict and Action**\nThe problem is deemed valid. A full solution will be provided.\n\n### Step 2: Solution\n\n**2.1. Hamiltonian Construction and Decoupling at $k_z=0$**\nThe basis for the tight-binding model consists of four states per unit cell: $\\{|A, s\\rangle, |A, p_z\\rangle, |B, s\\rangle, |B, p_z\\rangle\\}$. We work in the Bloch basis $\\{|A, s, \\mathbf{k}\\rangle, |A, p_z, \\mathbf{k}\\rangle, |B, s, \\mathbf{k}\\rangle, |B, p_z, \\mathbf{k}\\rangle\\}$. The Hamiltonian is a $4 \\times 4$ matrix. The onsite energies form block-diagonal matrices $H_{AA}$ and $H_{BB}$:\n$$\nH_{AA} = H_{BB} = \\begin{pmatrix} \\epsilon_s & 0 \\\\ 0 & \\epsilon_p \\end{pmatrix}.\n$$\nThe hopping terms connect sublattices A and B, forming the off-diagonal blocks $H_{AB}(\\mathbf{k})$ and $H_{BA}(\\mathbf{k}) = H_{AB}^\\dagger(\\mathbf{k})$. The block $H_{AB}(\\mathbf{k})$ is a $2 \\times 2$ matrix in the orbital basis $(s, p_z)$:\n$$\nH_{AB}(\\mathbf{k}) = \\sum_{j=1}^{4} T_j e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j}, \\quad T_j = \\begin{pmatrix} t_{ss}^{(j)} & t_{sp_z}^{(j)} \\\\ t_{p_zs}^{(j)} & t_{p_zp_z}^{(j)} \\end{pmatrix}.\n$$\nThe hopping amplitudes are given as:\n-   $t_{ss}^{(j)} = t_s$.\n-   Let $\\hat{\\boldsymbol{\\delta}}_j$ be the unit vector along the bond $\\boldsymbol{\\delta}_j$. The direction cosine with the z-axis is $\\hat{\\delta}_{jz}$. The bond length is $|\\boldsymbol{\\delta}_j| = \\frac{a\\sqrt{3}}{4}$, so $\\hat{\\delta}_{jz} = \\delta_{jz} / (a\\sqrt{3}/4)$. For all four vectors, $|\\hat{\\delta}_{jz}| = \\frac{a/4}{a\\sqrt{3}/4} = \\frac{1}{\\sqrt{3}}$. The square is $(\\hat{\\delta}_{jz})^2 = 1/3$. Thus, $t_{p_zp_z}^{(j)} = t_p (\\hat{\\delta}_{jz})^2 = t_p/3$.\n-   The $s$-$p_z$ hopping elements are $t_{sp_z}^{(j)} = c \\cdot \\hat{\\delta}_{jz}$ and $t_{p_zs}^{(j)} = -c \\cdot \\hat{\\delta}_{jz}$ for some constant $c$, based on standard Slater-Koster rules where $s$ is even and $p_z$ is odd.\n\nThe resulting Hamiltonian matrix, in the basis order $(|A,s,\\mathbf{k}\\rangle, |B,s,\\mathbf{k}\\rangle, |A,p_z,\\mathbf{k}\\rangle, |B,p_z,\\mathbf{k}\\rangle)$ for clarity of decoupling, is:\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\n\\epsilon_s & t_s f(\\mathbf{k}) & 0 & h_{sp}(\\mathbf{k}) \\\\\nt_s f^*(\\mathbf{k}) & \\epsilon_s & h_{ps}^*(\\mathbf{k}) & 0 \\\\\n0 & h_{ps}(\\mathbf{k}) & \\epsilon_p & \\frac{t_p}{3} f(\\mathbf{k}) \\\\\nh_{sp}^*(\\mathbf{k}) & 0 & \\frac{t_p}{3} f^*(\\mathbf{k}) & \\epsilon_p\n\\end{pmatrix}.\n$$\nHere, $h_{sp}$ and $h_{ps}$ represent the total $s-p_z$ inter-sublattice hopping terms.\n\nThe problem states that the Hamiltonian respects mirror symmetry under $z \\mapsto -z$. Let $M_z$ be the operator for this symmetry. In the given orbital basis, $s$ is even ($M_z |s\\rangle = +|s\\rangle$) and $p_z$ is odd ($M_z |p_z\\rangle = -|p_z\\rangle$). The operator $M_z$ commutes with the Hamiltonian on the mirror-invariant plane $k_z=0$, i.e., $[H(k_x, k_y, 0), M_z] = 0$.\n\nBecause the $s$ and $p_z$ orbitals have opposite eigenvalues ($+1$ and $-1$, respectively) under $M_z$, any state in the $s$-orbital sector is an eigenstate of $M_z$ with eigenvalue $+1$, and any state in the $p_z$-orbital sector is an eigenstate of $M_z$ with eigenvalue $-1$. Let $|\\psi_s\\rangle$ be a state in the $s$-sector and $|\\psi_{p_z}\\rangle$ be a state in the $p_z$-sector. The matrix element of the Hamiltonian between these sectors is $\\langle \\psi_s | H(k_z=0) | \\psi_{p_z} \\rangle$. Using the commutation relation:\n$$\n\\langle \\psi_s | H(k_z=0) | \\psi_{p_z} \\rangle = \\langle \\psi_s | M_z^\\dagger H(k_z=0) M_z | \\psi_{p_z} \\rangle\n$$\nSince $M_z$ is unitary ($M_z^\\dagger = M_z^{-1}$) and also Hermitian ($M_z=M_z^\\dagger$), we have:\n$$\n= \\langle M_z \\psi_s | H(k_z=0) | M_z \\psi_{p_z} \\rangle = \\langle (+1)\\psi_s | H(k_z=0) | (-1)\\psi_{p_z} \\rangle = - \\langle \\psi_s | H(k_z=0) | \\psi_{p_z} \\rangle.\n$$\nThis implies $2\\langle \\psi_s | H(k_z=0) | \\psi_{p_z} \\rangle = 0$, so the matrix element is zero. Therefore, at $k_z=0$, the Hamiltonian becomes block-diagonal, decoupling the $s$ and $p_z$ sectors.\n\nThe decoupled blocks are:\n$$\nH_s(\\mathbf{k}) = \\begin{pmatrix} \\epsilon_s & t_s f(\\mathbf{k}) \\\\ t_s f^*(\\mathbf{k}) & \\epsilon_s \\end{pmatrix}, \\quad H_{p_z}(\\mathbf{k}) = \\begin{pmatrix} \\epsilon_p & \\frac{t_p}{3} f(\\mathbf{k}) \\\\ \\frac{t_p}{3} f^*(\\mathbf{k}) & \\epsilon_p \\end{pmatrix}.\n$$\nThe eigenvalues are found by diagonalizing these $2 \\times 2$ matrices:\n$$\nE_{s,\\pm}(\\mathbf{k}) = \\epsilon_s \\pm |t_s f(\\mathbf{k})|, \\quad E_{p,\\pm}(\\mathbf{k}) = \\epsilon_p \\pm \\left|\\frac{t_p}{3} f(\\mathbf{k})\\right|.\n$$\nWe assume the hopping amplitudes $t_s$ and $t_p$ are positive, so $|t_s f| = t_s |f|$ and $|\\frac{t_p}{3} f| = \\frac{t_p}{3} |f|$.\n\n**2.2. Expansion of the Structure Factor**\nThe structure factor is $f(\\mathbf{k}) = \\sum_j \\exp(i\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j)$. We expand for small $\\mathbf{k}$ up to second order:\n$$\nf(\\mathbf{k}) \\approx \\sum_{j=1}^4 \\left(1 + i\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j - \\frac{1}{2}(\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j)^2\\right).\n$$\nThe zeroth-order term is $\\sum_j 1 = 4$.\nThe first-order term is $i\\mathbf{k} \\cdot \\sum_j \\boldsymbol{\\delta}_j$. Since $\\sum_j \\boldsymbol{\\delta}_j = \\frac{a}{4}[(1,1,1)+(1,-1,-1)+(-1,1,-1)+(-1,-1,1)] = \\mathbf{0}$, this term vanishes, as required by inversion symmetry.\nThe second-order term is $-\\frac{1}{2}\\sum_j(\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j)^2$. Let $d=a/4$.\n$$\n\\sum_j(\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j)^2 = d^2 \\left[ (k_x+k_y+k_z)^2 + (k_x-k_y-k_z)^2 + (-k_x+k_y-k_z)^2 + (-k_x-k_y+k_z)^2 \\right].\n$$\nExpanding the squares and summing, we find that all cross terms like $k_x k_y$ cancel out.\n$$\n\\sum_j(\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j)^2 = d^2 [4(k_x^2+k_y^2+k_z^2)] = 4d^2|\\mathbf{k}|^2 = 4\\left(\\frac{a}{4}\\right)^2|\\mathbf{k}|^2 = \\frac{a^2}{4}|\\mathbf{k}|^2.\n$$\nThus, the expansion of $f(\\mathbf{k})$ is:\n$$\nf(\\mathbf{k}) \\approx 4 - \\frac{1}{2} \\left( \\frac{a^2}{4}|\\mathbf{k}|^2 \\right) = 4 - \\frac{a^2}{8}|\\mathbf{k}|^2.\n$$\nSince this expansion is real, $|f(\\mathbf{k})| \\approx f(\\mathbf{k})$ for small $\\mathbf{k}$. On the $k_z=0$ plane, $|\\mathbf{k}|^2 = k_x^2+k_y^2 = k_R^2$, where $k_R$ is the radial coordinate.\n$$\n|f(k_x, k_y, 0)| \\approx 4 - \\frac{a^2}{8}k_R^2.\n$$\n\n**2.3. Nodal Ring Radius**\nThe nodal ring is formed by the crossing of the upper $s$ band and the lower $p_z$ band. Assuming $\\epsilon_p > \\epsilon_s$ and $t_s, t_p > 0$, these bands are:\n-   Upper $s$ band: $E_{s,+} = \\epsilon_s + t_s |f(\\mathbf{k})|$\n-   Lower $p_z$ band: $E_{p,-} = \\epsilon_p - \\frac{t_p}{3} |f(\\mathbf{k})|$\nThe crossing condition is $E_{s,+} = E_{p,-}$:\n$$\n\\epsilon_s + t_s |f(\\mathbf{k})| = \\epsilon_p - \\frac{t_p}{3} |f(\\mathbf{k})|.\n$$\nSolving for $|f(\\mathbf{k})|$:\n$$\n|f(\\mathbf{k})| \\left(t_s + \\frac{t_p}{3}\\right) = \\epsilon_p - \\epsilon_s \\implies |f(\\mathbf{k})| = \\frac{\\epsilon_p - \\epsilon_s}{t_s + t_p/3}.\n$$\nFor a crossing to exist for small $k_R$, we need $0 < |f(\\mathbf{k})| < 4$. This places a condition on the parameters: $0 < \\epsilon_p - \\epsilon_s < 4(t_s + t_p/3)$.\nNow, we substitute the small-$k_R$ expansion for $|f(\\mathbf{k})|$:\n$$\n4 - \\frac{a^2}{8}k_R^2 = \\frac{\\epsilon_p - \\epsilon_s}{t_s + t_p/3}.\n$$\nSolving for $k_R^2$:\n$$\n\\frac{a^2}{8}k_R^2 = 4 - \\frac{\\epsilon_p - \\epsilon_s}{t_s + t_p/3}.\n$$\n$$\nk_R^2 = \\frac{8}{a^2} \\left(4 - \\frac{\\epsilon_p - \\epsilon_s}{t_s + t_p/3}\\right) = \\frac{32}{a^2} - \\frac{8(\\epsilon_p - \\epsilon_s)}{a^2(t_s + t_p/3)}.\n$$\nSimplifying the second term:\n$$\n\\frac{8(\\epsilon_p - \\epsilon_s)}{a^2(t_s + t_p/3)} = \\frac{8(\\epsilon_p - \\epsilon_s)}{a^2\\frac{3t_s+t_p}{3}} = \\frac{24(\\epsilon_p - \\epsilon_s)}{a^2(3t_s + t_p)}.\n$$\nSo, the expression for $k_R^2$ is:\n$$\nk_R^2 = \\frac{32}{a^2} - \\frac{24(\\epsilon_p - \\epsilon_s)}{a^2(3t_s + t_p)}.\n$$\nThe nodal-ring radius $k_R$ is the square root of this expression:\n$$\nk_R = \\sqrt{\\frac{32}{a^2} - \\frac{24(\\epsilon_p - \\epsilon_s)}{a^2(3t_s + t_p)}}.\n$$", "answer": "$$\n\\boxed{\\sqrt{\\frac{32}{a^2} - \\frac{24(\\epsilon_{p} - \\epsilon_{s})}{a^2(3t_{s} + t_{p})}}}\n$$", "id": "3007263"}, {"introduction": "Having seen how a nodal ring can emerge from a microscopic model, we now turn to a more general question: what keeps it stable? This practice utilizes a low-energy effective Hamiltonian, a powerful tool for studying universal properties near a topological feature. You will investigate how combined parity-time ($PT$) symmetry protects the nodal ring and then see firsthand how breaking this symmetry lifts the degeneracy, opening a gap and turning the semimetal into a gapped insulator [@problem_id:3007268]. This exercise vividly illustrates the principle that non-trivial topology is fundamentally linked to symmetry protection.", "problem": "Consider a spinless two-band Bloch Hamiltonian in three spatial dimensions with combined spatial inversion and time-reversal symmetry (parity-time symmetry, abbreviated as $PT$) near a symmetry-protected nodal ring. Assume that, in a neighborhood of the ring, the low-energy Hamiltonian can be written in cylindrical coordinates $k_{x} = k_{\\rho}\\cos\\phi$, $k_{y} = k_{\\rho}\\sin\\phi$, $k_{z}$ as\n$$\nH_{0}(\\mathbf{k}) \\;=\\; d_{x}(\\mathbf{k})\\,\\sigma_{x} \\;+\\; d_{z}(\\mathbf{k})\\,\\sigma_{z},\n$$\nwith\n$$\nd_{x}(\\mathbf{k}) \\;=\\; v_{\\rho}\\big(k_{\\rho} - k_{0}\\big),\\qquad d_{z}(\\mathbf{k}) \\;=\\; v_{z}\\,k_{z},\n$$\nwhere $v_{\\rho} \\!>\\! 0$, $v_{z} \\!>\\! 0$ are real velocities, $k_{0} \\!>\\! 0$ sets the radius of the nodal ring in the $k_{z}\\!=\\!0$ plane, and $\\sigma_{x}$, $\\sigma_{z}$ are Pauli matrices acting in a two-band orbital subspace. You may assume that $PT$ symmetry for spinless fermions implies that, in an appropriate basis, $H_{0}(\\mathbf{k})$ is a real matrix for all $\\mathbf{k}$.\n\n(a) Using only the stated symmetry implication and the given form of $H_{0}(\\mathbf{k})$, explain why the spectrum of $H_{0}(\\mathbf{k})$ exhibits a nodal ring and identify its location in momentum space.\n\n(b) Now add an onsite term\n$$\nH_{m} \\;=\\; m\\,\\sigma_{y},\n$$\nwith real constant $m \\neq 0$. Justify, from first principles of how $PT$ acts on matrices and complex conjugation, why this term breaks $PT$ symmetry in the spinless case and argue that the combined Hamiltonian $H(\\mathbf{k}) = H_{0}(\\mathbf{k}) + H_{m}$ becomes fully gapped.\n\n(c) Define $q_{\\rho} \\equiv k_{\\rho} - k_{0}$ and $q_{z} \\equiv k_{z}$ as small deviations transverse to the former nodal ring. The direct band gap at a fixed momentum $\\mathbf{k}$ is defined as the energy difference between the conduction and valence bands at that same $\\mathbf{k}$. Derive the analytic expression for the direct gap $\\Delta(q_{\\rho},q_{z})$ in terms of $m$, $v_{\\rho}$, $v_{z}$, $q_{\\rho}$, and $q_{z}$, valid to leading order in these deviations. Your final answer must be a single closed-form expression. Do not approximate or round; keep all symbols as defined. Express your final answer as an analytic expression without units.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It represents a standard model in condensed matter physics for describing nodal-line semimetals and the effect of symmetry-breaking perturbations. We may therefore proceed with a full solution.\n\nThe problem asks for a three-part analysis of a two-band Hamiltonian model for a nodal-line semimetal.\n\n(a) Nodal ring identification in $H_{0}(\\mathbf{k})$.\n\nThe given Hamiltonian is $H_{0}(\\mathbf{k}) = d_{x}(\\mathbf{k})\\,\\sigma_{x} + d_{z}(\\mathbf{k})\\,\\sigma_{z}$. This is a $2 \\times 2$ matrix of the general form $\\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$, where $\\boldsymbol{\\sigma} = (\\sigma_{x}, \\sigma_{y}, \\sigma_{z})$ is the vector of Pauli matrices and $\\mathbf{d}(\\mathbf{k}) = (d_{x}(\\mathbf{k}), 0, d_{z}(\\mathbf{k}))$. The energy eigenvalues of such a Hamiltonian are given by $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})|$.\nIn our case, the eigenvalues are:\n$$\nE_{\\pm}(\\mathbf{k}) = \\pm \\sqrt{d_{x}(\\mathbf{k})^{2} + d_{z}(\\mathbf{k})^{2}}\n$$\nA nodal feature, or a degeneracy in the spectrum, occurs where the energy gap between the two bands closes. This means $E_{+}(\\mathbf{k}) = E_{-}(\\mathbf{k})$, which is only possible if the energy of both bands is zero. This requires the magnitude of the $\\mathbf{d}$-vector to vanish:\n$$\n|\\mathbf{d}(\\mathbf{k})| = \\sqrt{d_{x}(\\mathbf{k})^{2} + d_{z}(\\mathbf{k})^{2}} = 0\n$$\nThis single condition is equivalent to two simultaneous conditions for the real functions $d_{x}(\\mathbf{k})$ and $d_{z}(\\mathbf{k})$:\n$1$. $d_{x}(\\mathbf{k}) = v_{\\rho}(k_{\\rho} - k_{0}) = 0$. Since $v_{\\rho}>0$ is given, this implies $k_{\\rho} = k_{0}$.\n$2$. $d_{z}(\\mathbf{k}) = v_{z}k_{z} = 0$. Since $v_{z}>0$ is given, this implies $k_{z} = 0$.\n\nThe set of points in momentum space $(\\mathbf{k})$ satisfying both conditions is defined by $k_{\\rho} = \\sqrt{k_x^2 + k_y^2} = k_{0}$ and $k_{z}=0$. This is the equation of a circle of radius $k_{0}$ centered at the origin in the $k_{z}=0$ plane. This is the nodal ring.\n\nThe problem specifies that for spinless fermions with $PT$ symmetry, the Hamiltonian $H_0(\\mathbf{k})$ can be chosen to be a real matrix. A general $2 \\times 2$ Hamiltonian is $H = d_0 I + d_x\\sigma_x + d_y\\sigma_y + d_z\\sigma_z$. Since $\\sigma_x$ and $\\sigma_z$ are real matrices while $\\sigma_y$ is purely imaginary, the condition that $H_0(\\mathbf{k})$ is real (assuming real coefficients $d_i$) implies that the coefficient of $\\sigma_y$ must be zero, i.e., $d_y(\\mathbf{k})=0$. In a generic three-dimensional system, closing the gap would require three conditions to be met ($d_x=0, d_y=0, d_z=0$), which typically occurs only at isolated points (Weyl points). The $PT$ symmetry, by forcing $d_y(\\mathbf{k})=0$ for all $\\mathbf{k}$, reduces the number of conditions for a degeneracy from three to two. The two conditions $d_x(\\mathbf{k})=0$ and $d_z(\\mathbf{k})=0$ define a line in the three-dimensional momentum space, which in this case is the nodal ring.\n\n(b) $PT$ symmetry breaking and gap opening.\n\nThe added term is $H_{m} = m\\,\\sigma_{y}$, where $m$ is a non-zero real constant. We need to justify why this term breaks $PT$ symmetry from first principles. For a spinless system, the time-reversal operator is simply the complex conjugation operator, $T = K$. The parity operator $P$ inverts momentum, $\\mathbf{k} \\to -\\mathbf{k}$. A Hamiltonian $H$ is $PT$-symmetric if it is invariant under the combined operation, i.e., $(PT)H(PT)^{-1} = H$.\n\nLet's analyze the action of $PT$ on the term $H_m$. Since $H_m$ is independent of momentum $\\mathbf{k}$, the parity operator has a trivial action on it within the orbital basis (i.e., $P H_m P^{-1} = H_m$). The action of the full $PT$ operator is then:\n$$\n(PT)H_{m}(PT)^{-1} = K (P H_{m} P^{-1}) K^{-1} = K H_{m} K^{-1}\n$$\nSubstituting $H_m = m\\sigma_y$ and noting that $m$ is a real constant:\n$$\nK (m\\sigma_{y}) K^{-1} = m K \\sigma_{y} K^{-1} = m \\sigma_{y}^{*}\n$$\nThe Pauli matrix $\\sigma_y$ is given by $\\sigma_{y} = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}$. Its complex conjugate is $\\sigma_{y}^{*} = \\begin{pmatrix} 0 & i \\\\ -i & 0 \\end{pmatrix} = -\\sigma_{y}$.\nTherefore, we have:\n$$\n(PT)H_{m}(PT)^{-1} = -m\\sigma_{y} = -H_{m}\n$$\nThe condition for $H_m$ to respect $PT$ symmetry is $(PT)H_{m}(PT)^{-1} = H_{m}$, which would mean $-H_m = H_m$. This is only satisfied if $H_m=0$, which requires $m=0$. As the problem states $m \\neq 0$, the term $H_m$ breaks $PT$ symmetry.\n\nNow we argue that the combined Hamiltonian $H(\\mathbf{k}) = H_{0}(\\mathbf{k}) + H_{m}$ is fully gapped. The new Hamiltonian is:\n$$\nH(\\mathbf{k}) = d_{x}(\\mathbf{k})\\,\\sigma_{x} + m\\,\\sigma_{y} + d_{z}(\\mathbf{k})\\,\\sigma_{z}\n$$\nThis is of the form $\\mathbf{d'}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$ with a new vector $\\mathbf{d'}(\\mathbf{k}) = (d_{x}(\\mathbf{k}), m, d_{z}(\\mathbf{k}))$. The energy eigenvalues are $E'_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d'}(\\mathbf{k})|$.\n$$\nE'_{\\pm}(\\mathbf{k}) = \\pm \\sqrt{d_{x}(\\mathbf{k})^{2} + m^{2} + d_{z}(\\mathbf{k})^{2}}\n$$\nThe system is gapped if the energy difference between the bands is always non-zero for any $\\mathbf{k}$. This means the eigenvalues can never be zero. A zero eigenvalue would require $|\\mathbf{d'}(\\mathbf{k})|=0$, which implies $d_{x}(\\mathbf{k})^{2} + m^{2} + d_{z}(\\mathbf{k})^{2} = 0$. Since $d_x$, $d_z$, and $m$ are real, their squares are non-negative. The sum can be zero only if each term is zero: $d_x(\\mathbf{k})=0$, $m=0$, and $d_z(\\mathbf{k})=0$. However, the problem specifies $m \\neq 0$. Thus, the quantity under the square root, $[v_{\\rho}(k_{\\rho}-k_{0})]^2 + m^2 + [v_z k_z]^2$, is strictly positive for all values of $\\mathbf{k}$. Its minimum value is $m^2$, which occurs at the location of the former nodal ring ($k_\\rho=k_0, k_z=0$). Since the eigenvalues are never zero, the spectrum is fully gapped.\n\n(c) Derivation of the direct band gap.\n\nThe direct band gap $\\Delta$ at a given momentum $\\mathbf{k}$ is the difference between the energy of the conduction band ($E'_{+}$) and the valence band ($E'_{-}$) at that same $\\mathbf{k}$.\n$$\n\\Delta(\\mathbf{k}) = E'_{+}(\\mathbf{k}) - E'_{-}(\\mathbf{k})\n$$\nUsing the eigenvalues derived in part (b):\n$$\n\\Delta(\\mathbf{k}) = \\left(\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\\right) - \\left(-\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\\right) = 2\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\n$$\nThe problem asks for this expression in terms of the small momentum deviations $q_{\\rho} = k_{\\rho} - k_{0}$ and $q_{z} = k_{z}$. The model Hamiltonian is already linearized in these deviations, as $d_{x}(\\mathbf{k}) = v_{\\rho}(k_{\\rho} - k_{0}) = v_{\\rho}q_{\\rho}$ and $d_{z}(\\mathbf{k}) = v_{z}k_{z} = v_{z}q_{z}$. These are the leading-order terms for the Hamiltonian components near the nodal ring. Substituting these into the expression for the gap, we obtain the expression for the gap that is consistent with this leading-order Hamiltonian.\n$$\n\\Delta(q_{\\rho},q_{z}) = 2\\sqrt{(v_{\\rho}q_{\\rho})^{2} + m^{2} + (v_{z}q_{z})^{2}}\n$$\nThis simplifies to:\n$$\n\\Delta(q_{\\rho},q_{z}) = 2\\sqrt{v_{\\rho}^{2}q_{\\rho}^{2} + m^{2} + v_{z}^{2}q_{z}^{2}}\n$$\nThis is the final closed-form analytic expression for the direct gap, valid within the given leading-order model.", "answer": "$$\n\\boxed{2 \\sqrt{v_{\\rho}^{2} q_{\\rho}^{2} + m^{2} + v_{z}^{2} q_{z}^{2}}}\n$$", "id": "3007268"}, {"introduction": "One of the most profound consequences of non-trivial bulk topology is the guaranteed existence of exotic states at the system's boundary—a concept known as the bulk-boundary correspondence. For nodal-line semimetals, this manifests as a continuum of zero-energy surface states forming a 'drumhead' shape in momentum space. In this computational practice, you will bridge theory and observable phenomena by numerically simulating a slab of a nodal-line semimetal and identifying these characteristic drumhead surface states [@problem_id:3007279], providing concrete evidence for the underlying bulk topology.", "problem": "Consider a minimal two-band tight-binding model on a simple cubic lattice that realizes a nodal-line semimetal with a nodal ring in the plane of wave vector component $k_z = 0$. The Bloch Hamiltonian in momentum space is given by\n$$\nH(\\mathbf{k}) = \\left[m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) - t_z \\cos k_z\\right]\\sigma_z + v \\sin k_z \\,\\sigma_x,\n$$\nwhere $\\mathbf{k} = (k_x,k_y,k_z)$, $\\sigma_x$ and $\\sigma_z$ are Pauli matrices acting in orbital space, and $m$, $t_{xy}$, $t_z$, and $v$ are real parameters. All energies are dimensionless and expressed in units where the lattice constant is $1$, and all angles are in radians.\n\nStarting from the definitions of the tight-binding Hamiltonian and Bloch’s theorem, and using the discrete Fourier transform between real space and momentum space along a single axis, implement open boundary conditions along the $z$ axis for a slab with $N$ layers and crystal momentum $(k_x,k_y)$ held fixed. Your implementation must:\n- Derive the real-space slab Hamiltonian $H_{\\text{slab}}(k_x,k_y)$ that is block tridiagonal with $2 \\times 2$ blocks, using only nearest-layer couplings along $z$ implied by the given Bloch Hamiltonian.\n- Numerically diagonalize $H_{\\text{slab}}(k_x,k_y)$ to obtain eigenvalues $E_\\alpha$ and normalized eigenvectors $|\\psi_\\alpha \\rangle$.\n- Quantify surface localization by computing the probability weight on the first $s$ and last $s$ layers for each eigenstate:\n$$\nw_{\\text{left},\\alpha} = \\sum_{n=1}^{s} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\\quad\nw_{\\text{right},\\alpha} = \\sum_{n=N-s+1}^{N} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\n$$\nwhere $\\psi_\\alpha(n,o)$ is the amplitude on layer $n$ and orbital $o$.\n- Declare that a surface drumhead state is present at $(k_x,k_y)$ if there exists at least one eigenstate with $|E_\\alpha| \\le \\delta$ and $\\max\\{w_{\\text{left},\\alpha}, w_{\\text{right},\\alpha}\\} \\ge w_{\\text{th}}$.\n\nUse the following fixed parameter values for all computations:\n- $m = 1.5$, $t_{xy} = 1.0$, $t_z = 1.0$, $v = 0.6$.\n- Slab thickness $N = 80$ layers.\n- Surface window thickness $s = 4$ layers.\n- Energy window $\\delta = 0.08$.\n- Surface localization threshold $w_{\\text{th}} = 0.3$.\n\nTest suite. For the fixed model and parameters above, evaluate the presence or absence of surface drumhead states for the following four $(k_x,k_y)$ points (angles in radians):\n- Case $1$: $(k_x,k_y) = (0,0)$.\n- Case $2$: $(k_x,k_y) = (\\pi,\\pi)$.\n- Case $3$: $(k_x,k_y) = (2\\pi/3,0)$.\n- Case $4$: $(k_x,k_y) = (\\pi,0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of Python boolean literals enclosed in square brackets, in the order of the cases above, for example, $[{\\tt True},{\\tt False},{\\tt False},{\\tt True}]$. There are no physical units to report because the model is dimensionless, and all angles are in radians. The final output is therefore a list of four booleans on a single line. The program must be self-contained and require no user input.", "solution": "We start from the tight-binding description and Bloch’s theorem. For a translationally invariant crystal, the Bloch Hamiltonian $H(\\mathbf{k})$ encodes the hopping amplitudes along each direction. To impose open boundary conditions along a chosen axis, one performs an inverse discrete Fourier transform along that axis to recover a real-space representation with a finite number of layers and only the couplings that were present in momentum space.\n\nThe given Bloch Hamiltonian is\n$$\nH(\\mathbf{k}) = M(\\mathbf{k})\\,\\sigma_z + A(\\mathbf{k})\\,\\sigma_x,\n$$\nwith\n$$\nM(\\mathbf{k}) = m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) - t_z \\cos k_z, \\quad A(\\mathbf{k}) = v \\sin k_z.\n$$\nFor fixed in-plane momentum $(k_x,k_y)$, the dependence on $k_z$ dictates the structure of the real-space layer couplings along the $z$ direction. Using the Fourier identities\n$$\n\\cos k_z = \\tfrac{1}{2}\\left(e^{ik_z} + e^{-ik_z}\\right), \\quad \\sin k_z = \\tfrac{1}{2i}\\left(e^{ik_z} - e^{-ik_z}\\right),\n$$\nwe identify that $\\cos k_z$ contributes nearest-layer hopping terms that are symmetric between forward and backward neighbors, while $\\sin k_z$ contributes nearest-layer hopping terms that are antisymmetric and purely off-diagonal in the orbital basis due to multiplication by $\\sigma_x$.\n\nLet us write the slab Hamiltonian $H_{\\text{slab}}(k_x,k_y)$ as a block tridiagonal matrix of dimension $2N \\times 2N$, where $N$ is the number of layers and each block acts on the two-orbital internal space. The onsite block on each layer is\n$$\nH_0(k_x,k_y) = \\left[m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right)\\right]\\sigma_z,\n$$\nand the nearest-layer hopping block from layer $n$ to $n+1$ is\n$$\nT = -\\tfrac{t_z}{2}\\,\\sigma_z - i\\,\\tfrac{v}{2}\\,\\sigma_x,\n$$\nwith the Hermitian conjugate $T^\\dagger = -\\tfrac{t_z}{2}\\,\\sigma_z + i\\,\\tfrac{v}{2}\\,\\sigma_x$ coupling from layer $n+1$ back to layer $n$. These follow directly from the inverse Fourier transform of the $k_z$ dependence:\n- The term $-t_z \\cos k_z\\,\\sigma_z$ transforms to $-\\tfrac{t_z}{2}\\,\\sigma_z$ on both forward and backward nearest-layer hoppings.\n- The term $v \\sin k_z\\,\\sigma_x$ transforms to $-\\tfrac{i v}{2}\\,\\sigma_x$ on forward hopping and $+\\tfrac{i v}{2}\\,\\sigma_x$ on backward hopping, ensuring Hermiticity.\n\nConsequently, with open boundary conditions, $H_{\\text{slab}}(k_x,k_y)$ has $H_0$ on all diagonal $2 \\times 2$ blocks, $T$ on the first upper off-diagonal blocks, and $T^\\dagger$ on the first lower off-diagonal blocks. The boundary layers have no coupling beyond the edges.\n\nTo diagnose surface drumhead states, we diagonalize $H_{\\text{slab}}(k_x,k_y)$ to obtain eigenvalues $E_\\alpha$ and normalized eigenvectors $\\lvert \\psi_\\alpha \\rangle$ of length $2N$. We reshape each eigenvector’s components into layer and orbital indices such that $\\psi_\\alpha(n,o)$ is the amplitude on layer $n \\in \\{1,\\dots,N\\}$ and orbital $o \\in \\{1,2\\}$. The surface localization weights on the left and right are defined as\n$$\nw_{\\text{left},\\alpha} = \\sum_{n=1}^{s} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2, \\quad\nw_{\\text{right},\\alpha} = \\sum_{n=N-s+1}^{N} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\n$$\nwith $s$ the number of layers defining a surface region. A state is identified as a surface drumhead state if two criteria are simultaneously met:\n- Energy proximity to zero: $\\lvert E_\\alpha \\rvert \\le \\delta$.\n- Surface localization: $\\max\\{w_{\\text{left},\\alpha}, w_{\\text{right},\\alpha}\\} \\ge w_{\\text{th}}$.\n\nThis criterion is physically motivated by the topological characterization of drumhead states in nodal-line semimetals. For the minimal model, the effective “mass” at fixed $(k_x,k_y)$ at the two time-reversal-invariant momenta $k_z = 0$ and $k_z = \\pi$ are\n$$\nM_0(k_x,k_y) = m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) - t_z, \\quad\nM_\\pi(k_x,k_y) = m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) + t_z.\n$$\nThe existence of topological drumhead surface states is tied to the condition $M_0(k_x,k_y) M_\\pi(k_x,k_y) < 0$, which simplifies to an in-plane inequality that defines a region bounded by a nodal ring where the bulk gap closes. For the chosen parameters, this region corresponds to $\\cos k_x + \\cos k_y > 0.5$, so points such as $(k_x,k_y) = (0,0)$ are expected to host drumhead states, while points well outside, such as $(\\pi,\\pi)$, are not.\n\nAlgorithmic design:\n- Inputs are the fixed model parameters $m = 1.5$, $t_{xy} = 1.0$, $t_z = 1.0$, $v = 0.6$, slab thickness $N = 80$, surface window $s = 4$, energy window $\\delta = 0.08$, and localization threshold $w_{\\text{th}} = 0.3$.\n- For each test $(k_x,k_y)$: construct $H_0(k_x,k_y)$ and $T$ as derived above; assemble the $2N \\times 2N$ Hermitian matrix; diagonalize it to obtain all eigenvalues and eigenvectors; filter eigenstates by the two criteria to determine the presence of a drumhead state.\n- Return a boolean for each test case indicating whether at least one drumhead state is found.\n\nTest suite:\n- Case $1$: $(k_x,k_y) = (0,0)$, expected inside the nodal ring projection.\n- Case $2$: $(k_x,k_y) = (\\pi,\\pi)$, expected outside.\n- Case $3$: $(k_x,k_y) = (2\\pi/3,0)$, expected to lie on the boundary defined by $\\cos k_x + \\cos k_y = 0.5$.\n- Case $4$: $(k_x,k_y) = (\\pi,0)$, expected outside.\n\nThe program outputs a single line with a Python-style list of four boolean values in the order above. All computations are dimensionless, and all angles are in radians.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_slab_hamiltonian(kx, ky, params, N):\n    \"\"\"\n    Construct the 2N x 2N slab Hamiltonian with open boundaries along z.\n    params: dict with keys m, txy, tz, v\n    \"\"\"\n    m = params[\"m\"]\n    txy = params[\"txy\"]\n    tz = params[\"tz\"]\n    v = params[\"v\"]\n\n    # Pauli matrices\n    sx = np.array([[0.0, 1.0],\n                   [1.0, 0.0]], dtype=np.complex128)\n    sz = np.array([[1.0, 0.0],\n                   [0.0, -1.0]], dtype=np.complex128)\n\n    # Onsite block H0(kx,ky) = [m - txy (cos kx + cos ky)] * sz\n    H0_coeff = (m - txy * (np.cos(kx) + np.cos(ky)))\n    H0 = H0_coeff * sz\n\n    # Nearest-layer hopping T = -(tz/2) * sz - i (v/2) * sx\n    T = -(tz / 2.0) * sz - 1j * (v / 2.0) * sx\n    T_dag = T.conj().T\n\n    dim = 2 * N\n    H = np.zeros((dim, dim), dtype=np.complex128)\n\n    # Fill diagonal blocks\n    for n in range(N):\n        i0 = 2 * n\n        H[i0:i0+2, i0:i0+2] = H0\n\n    # Fill off-diagonal nearest-layer blocks\n    for n in range(N - 1):\n        i0 = 2 * n\n        j0 = 2 * (n + 1)\n        H[i0:i0+2, j0:j0+2] = T\n        H[j0:j0+2, i0:i0+2] = T_dag\n\n    return H\n\ndef surface_drumhead_present(kx, ky, params, N, s, delta, wthr):\n    \"\"\"\n    Determine if a drumhead surface state is present for given (kx,ky).\n    Criteria: exists eigenstate with |E| <= delta and surface weight >= wthr.\n    \"\"\"\n    H = build_slab_hamiltonian(kx, ky, params, N)\n    # Hermitian eigen-decomposition\n    evals, evecs = np.linalg.eigh(H)\n\n    # Reshape eigenvectors to (N,2) per state for probability computations\n    present = False\n    # Pre-compute layer indices for left and right surfaces\n    left_layers = list(range(0, s))\n    right_layers = list(range(N - s, N))\n\n    for idx, E in enumerate(evals):\n        if abs(E) <= delta:\n            vec = evecs[:, idx]\n            # Reshape to (N, 2)\n            psi = vec.reshape(N, 2)\n            # Probability per layer (sum over orbitals)\n            layer_prob = np.sum(np.abs(psi)**2, axis=1).real\n            # Normalization safety (should already be normalized)\n            total = np.sum(layer_prob)\n            if total <= 0:\n                continue\n            # Compute surface weights\n            w_left = float(np.sum(layer_prob[left_layers]))\n            w_right = float(np.sum(layer_prob[right_layers]))\n            if max(w_left, w_right) >= wthr:\n                present = True\n                break\n\n    return present\n\ndef solve():\n    # Fixed parameters as specified in the problem\n    params = {\n        \"m\": 1.5,\n        \"txy\": 1.0,\n        \"tz\": 1.0,\n        \"v\": 0.6,\n    }\n    N = 80\n    s = 4\n    delta = 0.08\n    wthr = 0.3\n\n    # Test cases: angles in radians\n    test_cases = [\n        (0.0, 0.0),                 # Case 1: inside\n        (np.pi, np.pi),             # Case 2: outside\n        (2.0 * np.pi / 3.0, 0.0),   # Case 3: boundary\n        (np.pi, 0.0),               # Case 4: outside\n    ]\n\n    results = []\n    for kx, ky in test_cases:\n        res = surface_drumhead_present(kx, ky, params, N, s, delta, wthr)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3007279"}]}