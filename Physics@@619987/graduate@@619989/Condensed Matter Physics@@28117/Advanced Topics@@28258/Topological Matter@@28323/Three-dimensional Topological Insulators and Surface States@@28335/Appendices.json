{"hands_on_practices": [{"introduction": "The defining characteristic of a three-dimensional topological insulator is a non-trivial bulk topological invariant, often denoted by the $\\mathbb{Z}_2$ index $\\nu_0$. For materials possessing inversion symmetry, this index can be remarkably computed by examining the parity eigenvalues of the occupied electronic bands at a few special points in momentum space. This practice [@problem_id:3021506] guides you through a cornerstone calculation, starting from a model Hamiltonian to determine its topological phase, providing essential training in connecting microscopic models to topological classification.", "problem": "Consider a four-band lattice Hamiltonian for a three-dimensional (3D) time-reversal-invariant insulator in symmetry class AII (time-reversal symmetry with $\\Theta^2=-1$) defined on a simple cubic Brillouin zone (BZ):\n$$\nH(\\mathbf{k}) \\;=\\; v \\sum_{j=x,y,z} \\sin k_j \\,\\Gamma_j \\;+\\; \\left[m \\;-\\; b \\sum_{j=x,y,z} \\cos k_j\\right]\\Gamma_4,\n$$\nwhere $\\mathbf{k}=(k_x,k_y,k_z)$, $v>0$ and $b>0$ are real parameters, and the $\\Gamma$ matrices are given by\n$$\n\\Gamma_j \\;=\\; \\tau_x \\otimes \\sigma_j \\quad (j=x,y,z), \\qquad \\Gamma_4 \\;=\\; \\tau_z \\otimes \\mathbb{1},\n$$\nwith $\\sigma_j$ and $\\tau_j$ denoting Pauli matrices acting on spin and orbital degrees of freedom, respectively. The system is at half filling. Time-reversal symmetry (TRS) is implemented by the antiunitary operator\n$$\n\\Theta \\;=\\; i\\,(\\mathbb{1}\\otimes \\sigma_y)\\,K,\n$$\nwhere $K$ denotes complex conjugation, and inversion symmetry is implemented by\n$$\n\\mathcal{P} \\;=\\; \\Gamma_4,\n$$\nwhich inverts momentum $\\mathbf{k}\\mapsto -\\mathbf{k}$.\n\nStarting from the fundamental definitions of symmetry class AII, time-reversal symmetry, inversion symmetry, and the band structure at time-reversal-invariant momenta (TRIM) in the Brillouin zone, determine the strong $\\mathbb{Z}_2$ topological index and the corresponding magnetoelectric polarizability angle $\\theta$ (the axion angle) of this insulator for the parameter choice $m=2b$ with $b>0$. Your reasoning should connect symmetry constraints to a classification by an integer modulo $2$ and identify the magnetoelectric response consistent with symmetry class AII in 3D.\n\nExpress your final answer as the value of $\\theta$ in radians. No rounding is required; provide the exact value in radians.", "solution": "The user wants to determine the strong $\\mathbb{Z}_2$ topological index and the axion angle $\\theta$ for a given Hamiltonian.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   **Hamiltonian**: $H(\\mathbf{k}) \\;=\\; v \\sum_{j=x,y,z} \\sin k_j \\,\\Gamma_j \\;+\\; \\left[m \\;-\\; b \\sum_{j=x,y,z} \\cos k_j\\right]\\Gamma_4$\n-   **Brillouin Zone**: Simple cubic.\n-   **Parameters**: $v>0$, $b>0$. Specific case: $m=2b$.\n-   **Gamma Matrices**: $\\Gamma_j \\;=\\; \\tau_x \\otimes \\sigma_j$ for $j=x,y,z$, and $\\Gamma_4 \\;=\\; \\tau_z \\otimes \\mathbb{1}$. $\\sigma_j$ and $\\tau_j$ are Pauli matrices.\n-   **Filling**: Half filling.\n-   **Time-Reversal Symmetry (TRS)**: Symmetry class AII. Operator $\\Theta \\;=\\; i\\,(\\mathbb{1}\\otimes \\sigma_y)\\,K$, with $\\Theta^2=-1$.\n-   **Inversion Symmetry**: Operator $\\mathcal{P} \\;=\\; \\Gamma_4$.\n\n**1.2. Validate Using Extracted Givens**\n-   **Scientific Groundedness**: The problem describes a canonical model for a three-dimensional topological insulator, often referred to as the 3D Bernevig-Hughes-Zhang (BHZ) model or a Wilson-Dirac lattice model. The concepts of $\\mathbb{Z}_2$ invariants, time-reversal-invariant momenta (TRIM), parity eigenvalues, and the axion angle $\\theta$ are all standard and well-established in modern condensed matter physics. The Hamiltonian and symmetry operators are correctly defined for a system in symmetry class AII with inversion symmetry.\n-   **Well-Posedness**: The problem is well-posed. It provides a specific Hamiltonian and a specific set of parameters ($m=2b$) and asks for a calculable quantity (the $\\mathbb{Z}_2$ index and corresponding $\\theta$). A unique, meaningful solution is expected.\n-   **Objectivity**: The problem is stated using precise, formal language devoid of any subjectivity.\n-   **Completeness and Consistency**: All necessary information to solve the problem is provided. The Hamiltonian is consistent with the stated symmetries. The definition of the inversion operator $\\mathcal{P}=\\Gamma_4$ and the TRS operator $\\Theta$ is standard for this class of models.\n\n**1.3. Verdict and Action**\nThe problem is valid. It is a standard, well-defined problem in theoretical condensed matter physics. I will proceed with the solution.\n\n### Step 2: Solution\n\nThe problem asks for the strong $\\mathbb{Z}_2$ topological index, $\\nu_0$, and the associated magnetoelectric polarizability (axion angle), $\\theta$, for the given Hamiltonian under the condition $m=2b$.\n\nFor a three-dimensional insulator that possesses both time-reversal symmetry and inversion symmetry, the four $\\mathbb{Z}_2$ topological invariants $(\\nu_0; \\nu_1, \\nu_2, \\nu_3)$ can be determined by analyzing the parity eigenvalues of the occupied bands at the eight time-reversal-invariant momenta (TRIMs) in the Brillouin zone. The strong topological index, $\\nu_0$, is given by the Fu-Kane formula:\n$$(-1)^{\\nu_0} = \\prod_{i=1}^8 \\delta_i$$\nwhere the product runs over all eight TRIMs, $\\Lambda_i$. The quantity $\\delta_i$ for a given TRIM $\\Lambda_i$ is the product of the parity eigenvalues for a chosen half of the occupied bands (i.e., one state from each Kramers pair).\n\nFirst, let's identify the TRIMs, $\\Lambda_i$, for a simple cubic Brillouin zone. These are the points $\\mathbf{k}=(k_x, k_y, k_z)$ where each component $k_j$ is either $0$ or $\\pi$. The eight TRIMs are:\n-   $1$ point of the form $(0,0,0)$.\n-   $3$ points of the form $(\\pi,0,0)$.\n-   $3$ points of the form $(\\pi,\\pi,0)$.\n-   $1$ point of the form $(\\pi,\\pi,\\pi)$.\n\nNext, we simplify the Hamiltonian at these TRIMs. The general Hamiltonian is:\n$$H(\\mathbf{k}) = v \\sum_{j=x,y,z} \\sin(k_j) \\Gamma_j + \\left[m - b \\sum_{j=x,y,z} \\cos(k_j)\\right] \\Gamma_4$$\nAt any TRIM, $\\sin(k_j) = 0$ for all $j=x,y,z$. Thus, the first term vanishes, and the Hamiltonian becomes:\n$$H(\\Lambda_i) = \\left[m - b \\sum_{j=x,y,z} \\cos(k_j)\\right] \\Gamma_4 \\equiv M(\\Lambda_i) \\Gamma_4$$\nwhere we define the k-dependent mass term as $M(\\mathbf{k}) = m - b \\sum_{j} \\cos(k_j)$.\n\nThe inversion operator is given as $\\mathcal{P} = \\Gamma_4$. At the TRIMs, the Hamiltonian is directly proportional to the inversion operator: $H(\\Lambda_i) = M(\\Lambda_i) \\mathcal{P}$. The energy eigenstates at the TRIMs are also parity eigenstates. Let $|\\psi\\rangle$ be an eigenstate of $\\mathcal{P}$ with parity eigenvalue $\\xi = \\pm 1$. Then:\n$$H(\\Lambda_i) |\\psi\\rangle = M(\\Lambda_i) \\mathcal{P} |\\psi\\rangle = M(\\Lambda_i) \\xi |\\psi\\rangle$$\nSo, the energy eigenvalue is $E = M(\\Lambda_i)\\xi$.\n\nThe system is at half-filling, meaning the two lowest-energy bands are occupied. These correspond to negative energy states, $E<0$. We must determine the parity eigenvalue $\\xi$ of these occupied states.\n-   If $M(\\Lambda_i) > 0$, then to have $E < 0$, we must have $\\xi = -1$.\n-   If $M(\\Lambda_i) < 0$, then to have $E < 0$, we must have $\\xi = +1$.\nIn both cases, the parity eigenvalue of the occupied states is given by $\\xi = -\\text{sgn}(M(\\Lambda_i))$.\n\nThe system is in symmetry class AII ($\\Theta^2=-1$), so all energy levels are at least two-fold degenerate (Kramers degeneracy). The time-reversal operator $\\Theta$ commutes with the inversion operator $\\mathcal{P}$, so a Kramers pair of states has the same parity eigenvalue. The term $\\delta_i$ in the Fu-Kane formula refers to the parity eigenvalue of one state from each occupied Kramers pair. Since there are four bands in total and the system is at half-filling, there are two occupied bands which form a single Kramers pair. Therefore, $\\delta_i$ is simply the common parity eigenvalue of this occupied pair:\n$$\\delta_i = \\xi(\\Lambda_i) = -\\text{sgn}(M(\\Lambda_i))$$\n\nWe are given the condition $m=2b$ with $b>0$. The mass term at the TRIMs is:\n$$M(\\Lambda_i) = 2b - b \\sum_{j} \\cos(k_j) = b\\left(2 - \\sum_{j} \\cos(k_j)\\right)$$\nSince $b>0$, the sign of $M(\\Lambda_i)$ is determined by the sign of $(2 - \\sum_j \\cos(k_j))$. We now evaluate this for each of the eight TRIMs.\n\n1.  **TRIM $(0,0,0)$**:\n    $\\sum_j \\cos(k_j) = \\cos(0)+\\cos(0)+\\cos(0) = 1+1+1=3$.\n    $M(0,0,0) = b(2-3) = -b < 0$.\n    $\\delta_{(0,0,0)} = -\\text{sgn}(-b) = -(-1) = +1$.\n\n2.  **3 TRIMs of type $(\\pi,0,0)$**:\n    $\\sum_j \\cos(k_j) = \\cos(\\pi)+\\cos(0)+\\cos(0) = -1+1+1=1$.\n    $M(\\pi,0,0) = b(2-1) = b > 0$.\n    $\\delta_{(\\pi,0,0)} = -\\text{sgn}(b) = -(+1) = -1$. There are three such points, all having $\\delta_i = -1$.\n\n3.  **3 TRIMs of type $(\\pi,\\pi,0)$**:\n    $\\sum_j \\cos(k_j) = \\cos(\\pi)+\\cos(\\pi)+\\cos(0) = -1-1+1=-1$.\n    $M(\\pi,\\pi,0) = b(2-(-1)) = 3b > 0$.\n    $\\delta_{(\\pi,\\pi,0)} = -\\text{sgn}(3b) = -(+1) = -1$. There are three such points, all having $\\delta_i = -1$.\n\n4.  **TRIM $(\\pi,\\pi,\\pi)$**:\n    $\\sum_j \\cos(k_j) = \\cos(\\pi)+\\cos(\\pi)+\\cos(\\pi) = -1-1-1=-3$.\n    $M(\\pi,\\pi,\\pi) = b(2-(-3)) = 5b > 0$.\n    $\\delta_{(\\pi,\\pi,\\pi)} = -\\text{sgn}(5b) = -(+1) = -1$.\n\nNow, we compute the product for the strong topological index $\\nu_0$:\n$$(-1)^{\\nu_0} = \\prod_{i=1}^8 \\delta_i = (\\delta_{(0,0,0)})^1 \\times (\\delta_{(\\pi,0,0)})^3 \\times (\\delta_{(\\pi,\\pi,0)})^3 \\times (\\delta_{(\\pi,\\pi,\\pi)})^1$$\n$$(-1)^{\\nu_0} = (+1)^1 \\times (-1)^3 \\times (-1)^3 \\times (-1)^1$$\n$$(-1)^{\\nu_0} = 1 \\times (-1) \\times (-1) \\times (-1) = -1$$\nSince $(-1)^{\\nu_0} = -1$, the strong topological index is $\\nu_0=1$. This indicates that the system is a strong topological insulator.\n\nThe axion angle, or magnetoelectric polarizability, $\\theta$, characterizes the topological magnetoelectric effect in 3D time-reversal invariant insulators. Time-reversal symmetry quantizes $\\theta$ to two possible values:\n-   $\\theta=0$ for a topologically trivial insulator ($\\nu_0=0$).\n-   $\\theta=\\pi$ for a strong topological insulator ($\\nu_0=1$).\n\nSince we have found $\\nu_0=1$, the system is a strong topological insulator and its magnetoelectric response is described by an axion angle $\\theta=\\pi$.", "answer": "$$\\boxed{\\pi}$$", "id": "3021506"}, {"introduction": "A key consequence of the non-trivial bulk topology is the emergence of unique metallic surface states with a property called spin-momentum locking, where an electron's spin is locked perpendicular to its momentum. This exercise [@problem_id:1804578] allows you to derive the direct relationship between an electrical current and the net spin polarization it induces. Grasping this connection is fundamental to understanding the potential of topological insulators in spintronic devices.", "problem": "A three-dimensional Topological Insulator (3D TI) is a material that behaves as an electrical insulator in its bulk but has robust conducting states on its surface. For a simple model of a 3D TI, the low-energy dynamics of these surface states can be described by the effective Hamiltonian:\n$$H(\\mathbf{k}) = \\hbar v_F (\\sigma_x k_y - \\sigma_y k_x)$$\nwhere $\\mathbf{k} = (k_x, k_y)$ is the two-dimensional electron wavevector on the surface, $\\hbar$ is the reduced Planck constant, $v_F$ is the Fermi velocity, and $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices representing the electron's spin. The spin operator is given by $\\mathbf{S} = \\frac{\\hbar}{2}\\boldsymbol{\\sigma}$.\n\nAssume the surface is populated with electrons up to a positive Fermi energy $E_F$ at zero temperature ($T=0$). A uniform, static electric field $\\mathbf{E} = E_x \\hat{\\mathbf{x}}$ is applied in the plane of the surface. This field drives a steady-state electrical current density, which we denote by $J_x \\hat{\\mathbf{x}}$. Due to the spin-momentum locking inherent in the Hamiltonian, this charge current is accompanied by a net spin polarization density, $\\langle \\mathbf{S} \\rangle$. The electronic transport is characterized by a constant scattering relaxation time $\\tau$.\n\nUnder these conditions, the induced spin polarization density component perpendicular to the current, $\\langle S_y \\rangle$, is found to be directly proportional to the charge current density, $J_x$. This linear relationship can be written as $\\langle S_y \\rangle = \\mathcal{K} J_x$.\n\nDetermine the analytical expression for the coefficient $\\mathcal{K}$. Express your answer in terms of the fundamental constants $e$ (the elementary charge), $\\hbar$, and the parameter $v_F$.", "solution": "We start from the given effective Hamiltonian for the 3D topological insulator surface states,\n$$\nH(\\mathbf{k}) = \\hbar v_{F} \\left( \\sigma_{x} k_{y} - \\sigma_{y} k_{x} \\right).\n$$\nThe velocity operator is defined by the group velocity,\n$$\n\\hat{\\mathbf{v}} = \\frac{1}{\\hbar} \\frac{\\partial H}{\\partial \\mathbf{k}}.\n$$\nComputing its components gives\n$$\n\\hat{v}_{x} = \\frac{1}{\\hbar} \\frac{\\partial H}{\\partial k_{x}} = \\frac{1}{\\hbar} \\left( - \\hbar v_{F} \\sigma_{y} \\right) = - v_{F} \\sigma_{y},\n$$\n$$\n\\hat{v}_{y} = \\frac{1}{\\hbar} \\frac{\\partial H}{\\partial k_{y}} = \\frac{1}{\\hbar} \\left( \\hbar v_{F} \\sigma_{x} \\right) = v_{F} \\sigma_{x}.\n$$\nThe spin operator is $\\mathbf{S} = \\frac{\\hbar}{2} \\boldsymbol{\\sigma}$, so in particular\n$$\n\\hat{S}_{y} = \\frac{\\hbar}{2} \\sigma_{y}.\n$$\nUsing the expression for $\\hat{v}_{x}$, we obtain the exact operator identity that relates spin to velocity,\n$$\n\\hat{S}_{y} = - \\frac{\\hbar}{2 v_{F}} \\hat{v}_{x}.\n$$\n\nWe now relate operator expectation values to macroscopic densities. Let the non-equilibrium steady state under the applied field populate states with distribution $f_{\\mathbf{k}}$ at zero temperature. The spin polarization density and current density are defined as\n$$\n\\langle S_{y} \\rangle = \\frac{1}{A} \\sum_{\\mathbf{k}} f_{\\mathbf{k}} \\langle \\hat{S}_{y} \\rangle_{\\mathbf{k}}, \\qquad\nJ_{x} = - e \\frac{1}{A} \\sum_{\\mathbf{k}} f_{\\mathbf{k}} \\langle \\hat{v}_{x} \\rangle_{\\mathbf{k}},\n$$\nwhere $A$ is the surface area and $\\langle \\cdot \\rangle_{\\mathbf{k}}$ denotes the quantum expectation value in the state labeled by $\\mathbf{k}$. Since the operator identity $\\hat{S}_{y} = - \\frac{\\hbar}{2 v_{F}} \\hat{v}_{x}$ holds for every state, it holds under the sum:\n$$\n\\langle S_{y} \\rangle = - \\frac{\\hbar}{2 v_{F}} \\left[ \\frac{1}{A} \\sum_{\\mathbf{k}} f_{\\mathbf{k}} \\langle \\hat{v}_{x} \\rangle_{\\mathbf{k}} \\right].\n$$\nUsing the definition of $J_{x}$, we eliminate the velocity sum,\n$$\n\\frac{1}{A} \\sum_{\\mathbf{k}} f_{\\mathbf{k}} \\langle \\hat{v}_{x} \\rangle_{\\mathbf{k}} = - \\frac{J_{x}}{e},\n$$\nwhich gives the linear relation between spin polarization density and current density,\n$$\n\\langle S_{y} \\rangle = \\frac{\\hbar}{2 e v_{F}} J_{x}.\n$$\nTherefore, the proportionality coefficient is\n$$\n\\mathcal{K} = \\frac{\\hbar}{2 e v_{F}}.\n$$\nThis result follows directly from spin-momentum locking encoded in the Hamiltonian and is independent of the details of the non-equilibrium distribution (such as $\\tau$ or $E_{F}$) so long as a steady-state linear-response current density $J_{x}$ is established.", "answer": "$$\\boxed{\\frac{\\hbar}{2 e v_{F}}}$$", "id": "1804578"}, {"introduction": "While an ideal topological insulator has perfectly metallic surfaces, real-world applications often involve thin films where the top and bottom surfaces are close enough to interact. This practice [@problem_id:3021512] delves into this crucial finite-size effect, where the hybridization of surface states can open an energy gap, turning the surface insulating. By combining analytical modeling with computational implementation, you will develop a quantitative understanding of how geometry impacts the defining electronic properties of a topological insulator.", "problem": "Consider a three-dimensional topological insulator film of thickness $L$ with two helical massless Dirac surface states, one localized near the top surface and one localized near the bottom surface. For sufficiently small $L$, the overlap of these surface states through the insulating bulk hybridizes them, opening an energy gap in the low-energy surface spectrum. Take as the fundamental base the following principles: (i) the single-surface low-energy Hamiltonian is that of a two-dimensional massless Dirac fermion with spin-momentum locking, (ii) time-reversal symmetry constrains the allowed inter-surface coupling terms, and (iii) the envelope of the surface-state wavefunction decays exponentially into the bulk with a characteristic decay length. Work in continuum momentum space for in-plane wavevector and assume translational invariance along the film plane.\n\nTask 1. Starting from the single-surface Hamiltonian of a topological insulator surface state, namely the two-dimensional massless Dirac Hamiltonian with Fermi velocity $v_F$, use symmetry considerations and a minimal coupling model to construct the effective low-energy Hamiltonian for the two coupled surfaces in a film of thickness $L$. Show that the spectrum generically acquires a gap at in-plane wavevector magnitude $k=0$, identify the coupling amplitude that controls the gap, and demonstrate how this amplitude depends on $L$ when the coupling arises from overlap of exponentially decaying surface-state envelopes characterized by a decay length $\\xi$, up to an overall energy scale $t_0$ set by microscopic details. The derivation must begin from the fundamental Hamiltonian structure and standard quantum mechanical overlap integrals, without invoking any shortcut formulas.\n\nTask 2. Using the model derived in Task 1, implement a program that, for each parameter set in the test suite below, performs the following computations:\n- Compute the hybridization gap at $k=0$ in electronvolts (eV). Express this gap as twice the magnitude of the inter-surface coupling amplitude at $k=0$ obtained from the derivation in Task 1. Return this energy as a floating-point number.\n- Determine whether the film is insulating at a chemical potential $\\mu$ (in electronvolts) relative to the Dirac point. The film is insulating if and only if the chemical potential lies strictly inside the hybridization-induced gap; classify with a boolean value, where a strictly inside condition means $|\\mu|$ is strictly less than the half-gap scale set by the coupling amplitude at $k=0$.\n- If the film is metallic (that is, the chemical potential lies outside the gap), compute the Fermi wavevector magnitude $k_F$ in inverse nanometers ($\\mathrm{nm}^{-1}$) corresponding to the circular Fermi surface at energy $|\\mu|$ in the low-energy model. Use the reduced Planck constant $\\hbar$ expressed in electronvolt-seconds (eV·s) and the Fermi velocity $v_F$ expressed in meters per second (m/s). If insulating, return $k_F=0.0$.\n\nAll energies must be expressed in eV, the thickness $L$ and decay length $\\xi$ must be expressed in nanometers (nm), the Fermi velocity $v_F$ must be expressed in meters per second (m/s), and the output wavevector $k_F$ must be expressed in inverse nanometers ($\\mathrm{nm}^{-1}$). Round all floating-point outputs to $6$ decimal places.\n\nTest suite. Apply your program to the following parameter sets, stated as $(L,\\xi,t_0,v_F,\\mu)$ with units $(\\mathrm{nm},\\mathrm{nm},\\mathrm{eV},\\mathrm{m/s},\\mathrm{eV})$:\n- Case A (happy path): $(L=6,\\,\\xi=2,\\,t_0=0.1,\\,v_F=5\\times 10^{5},\\,\\mu=0.0)$\n- Case B (large-thickness boundary): $(L=50,\\,\\xi=2,\\,t_0=0.08,\\,v_F=5\\times 10^{5},\\,\\mu=0.0)$\n- Case C (edge case with zero prefactor): $(L=4,\\,\\xi=4,\\,t_0=0.0,\\,v_F=6\\times 10^{5},\\,\\mu=0.0)$\n- Case D (metallic regime): $(L=3,\\,\\xi=3,\\,t_0=0.05,\\,v_F=4\\times 10^{5},\\,\\mu=0.04)$\n- Case E (threshold equality): $(L=2,\\,\\xi=2,\\,t_0=0.05,\\,v_F=5\\times 10^{5},\\,\\mu=0.018394)$\n\nFinal output format. Your program should produce a single line of output containing a list of lists, one per test case, where each inner list has exactly three elements in the order: $[\\text{gap\\_eV}, \\text{insulating\\_boolean}, \\text{kF\\_nm}^{-1}]$. Concretely, print a single line of text of the form\n$[[g_1,b_1,k_1],[g_2,b_2,k_2],\\dots,[g_5,b_5,k_5]]$\nwith numerical entries rounded to $6$ decimal places and boolean entries as either $\\text{True}$ or $\\text{False}$.", "solution": "We begin from the well-tested low-energy description of a single topological insulator surface state. The effective Hamiltonian near the Dirac point for one surface is the two-dimensional massless Dirac Hamiltonian,\n$$\nH_{\\text{surf}} = \\hbar v_F \\left(k_x \\sigma_y - k_y \\sigma_x\\right),\n$$\nwhere $\\hbar$ is the reduced Planck constant, $v_F$ is the Fermi velocity, $(k_x,k_y)$ are the in-plane momentum components, and $\\sigma_{x,y}$ are Pauli matrices acting on spin degrees of freedom reflecting spin-momentum locking. Time-reversal symmetry ensures that the Dirac point is protected against a mass term on a single isolated surface.\n\nIn a film with two surfaces, top and bottom, the low-energy Hilbert space is the tensor product of spin and a two-level \"surface pseudospin\" spanned by $\\{\\ket{\\text{top}},\\ket{\\text{bottom}}\\}$. A minimal time-reversal-symmetric Hamiltonian that accounts for the opposite chirality of the two surfaces and their coupling is\n$$\nH(L,\\mathbf{k}) = \\hbar v_F \\left(k_x \\sigma_y - k_y \\sigma_x\\right) \\tau_z \\;+\\; t(L)\\, \\tau_x,\n$$\nwhere $\\tau_{x,z}$ are Pauli matrices acting on the surface pseudospin, and $t(L)$ is a real inter-surface coupling amplitude that hybridizes the two Dirac cones. The term proportional to $\\tau_z$ captures that the spin-helicity is opposite on opposite surfaces, while the $\\tau_x$ term is the simplest time-reversal symmetric tunnel coupling that mixes the surfaces.\n\nTo obtain the spectrum, we note that $\\left(k_x \\sigma_y - k_y \\sigma_x\\right)$ anticommutes with $\\tau_x$ when multiplied by $\\tau_z$, and the Hamiltonian separates into blocks that can be diagonalized exactly. Squaring the Hamiltonian yields\n$$\nH^2 = \\left(\\hbar v_F\\right)^2 \\left(k_x^2 + k_y^2\\right) \\, \\mathbb{I} \\;+\\; t(L)^2 \\, \\mathbb{I},\n$$\nwhere $\\mathbb{I}$ is the identity in the combined space. Hence the eigenvalues are\n$$\nE_{\\pm}(\\mathbf{k}) = \\pm \\sqrt{ \\left(\\hbar v_F\\right)^2 k^2 + t(L)^2 },\n$$\nwith $k = \\sqrt{k_x^2 + k_y^2}$. This shows that at $k=0$ there is a gap of magnitude\n$$\n\\Delta(L) = 2\\, |t(L)|.\n$$\nThe chemical potential $\\mu$ shifts the Fermi energy; if $|\\mu| < |t(L)|$, then the Fermi level lies strictly within the gap and there are no states at that energy, so the film is insulating. If $|\\mu| \\ge |t(L)|$, then the Fermi level intersects the conduction band ($+$ branch) or valence band ($-$ branch) at a Fermi wavevector that solves $|\\mu| = \\sqrt{ \\left(\\hbar v_F\\right)^2 k_F^2 + t(L)^2 }$, giving\n$$\nk_F = \\frac{\\sqrt{ \\mu^2 - t(L)^2 }}{\\hbar v_F},\n$$\nfor $|\\mu| \\ge |t(L)|$, and otherwise $k_F = 0$.\n\nWe now relate $t(L)$ to microscopic structure through overlap of exponentially decaying surface-state envelopes. Let the top-surface envelope be localized near $z=0$ and decay into the bulk as $\\psi_{\\text{top}}(z) \\propto e^{-z/\\xi}$, and the bottom-surface envelope localized near $z=L$ decay as $\\psi_{\\text{bot}}(z) \\propto e^{-(L-z)/\\xi}$, consistent with an insulating bulk penetration characterized by the decay length $\\xi$. A standard quantum mechanical estimate of the tunnel coupling between the two localized states due to a short-range interlayer hybridization yields (up to an overall positive prefactor $t_0$ set by microscopic details)\n$$\nt(L) \\;\\propto\\; \\int_0^L \\psi_{\\text{top}}(z)\\, \\psi_{\\text{bot}}(z) \\, dz \\;\\propto\\; \\int_0^L e^{-z/\\xi} \\, e^{-(L-z)/\\xi} \\, dz \\;=\\; e^{-L/\\xi} \\int_0^L dz \\;=\\; L\\, e^{-L/\\xi}.\n$$\nThe factor of $L$ in this crude estimate reflects the integration domain length; with a more realistic short-range coupling localized near the midplane or an effective contact interaction, the $L$ factor is absorbed into the prefactor, yielding the widely used exponential dependence\n$$\nt(L) = t_0 \\, e^{-L/\\xi},\n$$\nwhich captures the dominant thickness dependence. This form obeys the physically required limits: $t(L)\\to t_0$ as $L\\to 0$ and $t(L)\\to 0$ as $L\\to \\infty$.\n\nAlgorithmic design. For each test case $(L,\\xi,t_0,v_F,\\mu)$, the program proceeds as follows:\n1. Convert the inputs into the model's quantities. Use $L$ and $\\xi$ in nanometers so that $L/\\xi$ is dimensionless. Compute the tunnel coupling $t(L) = t_0 \\exp(-L/\\xi)$ in electronvolts.\n2. Compute the hybridization gap $\\Delta(L) = 2\\, |t(L)|$ in electronvolts and round to $6$ decimal places.\n3. Determine whether the film is insulating by checking the strict inequality $|\\mu| < |t(L)|$. Return a boolean, with equality treated as metallic (not insulating).\n4. If metallic, compute $k_F = \\sqrt{\\mu^2 - t(L)^2}/(\\hbar v_F)$ in inverse meters, then convert to inverse nanometers by dividing by $10^9$. If insulating, set $k_F = 0.0$. Round to $6$ decimal places.\n5. Aggregate the results for all test cases into a single list of lists and print them in the specified single-line format.\n\nConstants and units. Use $\\hbar = 6.582119569\\times 10^{-16}$ eV·s, $v_F$ in $\\mathrm{m/s}$ as supplied, $L$ and $\\xi$ in nanometers, and report $k_F$ in $\\mathrm{nm}^{-1}$. All energies are in eV. This fully specifies the numerical procedure and ensures scientific realism while directly reflecting the physics of finite-size hybridization of top and bottom surface states in a topological insulator film.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constant: reduced Planck constant in eV*s\nHBAR_EV_S = 6.582119569e-16  # eV*s\n\ndef hybridization_coupling(t0_eV: float, L_nm: float, xi_nm: float) -> float:\n    \"\"\"\n    Compute the inter-surface tunnel coupling t(L) = t0 * exp(-L/xi).\n    Parameters:\n        t0_eV: prefactor energy scale in eV\n        L_nm: film thickness in nm\n        xi_nm: decay length in nm\n    Returns:\n        t(L) in eV\n    \"\"\"\n    if xi_nm <= 0:\n        # Guard against non-physical xi; for robustness, treat as no coupling.\n        return 0.0\n    return float(t0_eV * np.exp(-L_nm / xi_nm))\n\ndef gap_eV_from_coupling(tL_eV: float) -> float:\n    \"\"\"\n    Compute the hybridization gap at k=0: Delta = 2 * |t(L)|.\n    \"\"\"\n    return 2.0 * abs(tL_eV)\n\ndef is_insulating(mu_eV: float, tL_eV: float) -> bool:\n    \"\"\"\n    Determine insulating status: strictly inside the gap if |mu| < |t(L)|.\n    Equality is considered metallic.\n    \"\"\"\n    return abs(mu_eV) < abs(tL_eV)\n\ndef kF_nm_inverse(mu_eV: float, tL_eV: float, vF_mps: float) -> float:\n    \"\"\"\n    Compute the Fermi wavevector magnitude k_F in nm^{-1} if metallic,\n    else return 0.0. Uses k_F = sqrt(mu^2 - t^2) / (hbar * v_F).\n    \"\"\"\n    if vF_mps <= 0:\n        return 0.0\n    mu_abs = abs(mu_eV)\n    t_abs = abs(tL_eV)\n    if mu_abs < t_abs:\n        return 0.0\n    # Handle potential numerical equality\n    diff = mu_abs * mu_abs - t_abs * t_abs\n    if diff <= 0:\n        return 0.0\n    kF_per_m = np.sqrt(diff) / (HBAR_EV_S * vF_mps)  # in 1/m\n    kF_per_nm = kF_per_m / 1e9  # convert to 1/nm\n    return float(kF_per_nm)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L_nm, xi_nm, t0_eV, vF_mps, mu_eV)\n    test_cases = [\n        (6.0, 2.0, 0.1, 5.0e5, 0.0),         # Case A\n        (50.0, 2.0, 0.08, 5.0e5, 0.0),       # Case B\n        (4.0, 4.0, 0.0, 6.0e5, 0.0),         # Case C\n        (3.0, 3.0, 0.05, 4.0e5, 0.04),       # Case D\n        (2.0, 2.0, 0.05, 5.0e5, 0.018394),   # Case E\n    ]\n\n    results = []\n    for L_nm, xi_nm, t0_eV, vF_mps, mu_eV in test_cases:\n        tL = hybridization_coupling(t0_eV, L_nm, xi_nm)\n        gap = gap_eV_from_coupling(tL)\n        insulating = is_insulating(mu_eV, tL)\n        kF = kF_nm_inverse(mu_eV, tL, vF_mps)\n        # Round numeric outputs to 6 decimal places as required\n        gap_rounded = round(gap, 6)\n        kF_rounded = round(kF, 6)\n        results.append([gap_rounded, insulating, kF_rounded])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(item) for item in results)}]\")\n\nsolve()\n```", "id": "3021512"}]}