{"hands_on_practices": [{"introduction": "Understanding topological phases begins with the ability to compute their defining topological invariants. This first practice exercise [@problem_id:3003983] focuses on the foundational calculation of the Majorana number, $\\mathcal{M}$, for the celebrated Kitaev chain model. By working through the Bogoliubov-de Gennes (BdG) formalism at specific high-symmetry points in the Brillouin zone, you will apply the Pfaffian method to directly determine whether the system is in a trivial or a topological phase, thereby building a crucial skill for analyzing any 1D topological superconductor in symmetry class D.", "problem": "Consider a one-dimensional spinless fermion lattice with nearest-neighbor hopping and real $p$-wave pairing in the mean-field approximation. The Bogoliubov-de Gennes (BdG) Hamiltonian is written as a momentum-space bilinear,\n$$\nH=\\frac{1}{2}\\sum_{k}\\Psi_{k}^{\\dagger}\\, \\mathcal{H}(k)\\, \\Psi_{k},\n$$\nwhere the Nambu spinor is $\\Psi_{k}=\\begin{pmatrix}c_{k} \\\\ c_{-k}^{\\dagger}\\end{pmatrix}$ and the Bloch BdG matrix is\n$$\n\\mathcal{H}(k)=\\xi(k)\\,\\tau_{z}+2\\Delta\\,\\sin k\\, \\tau_{y},\n$$\nwith $\\xi(k)=-\\mu-2t\\cos k$, hopping amplitude $t0$, real pairing amplitude $\\Delta0$, and chemical potential $\\mu$. Here $\\tau_{x}$, $\\tau_{y}$, and $\\tau_{z}$ are Pauli matrices in Nambu space, and the matrix $\\mathcal{H}(k)$ satisfies particle-hole symmetry implemented by $C=\\tau_{x}K$, where $K$ denotes complex conjugation. The Kitaev Majorana number $\\mathcal{M}$ for class $D$ in one dimension can be evaluated at the particle-hole symmetric momenta $k=0$ and $k=\\pi$ by using the sign of the product of Pfaffians of an antisymmetric matrix constructed from $\\mathcal{H}(k)$ at those points. The Pfaffian $\\mathrm{Pf}(\\cdot)$ is defined for an antisymmetric matrix and satisfies $\\mathrm{Pf}(M)^{2}=\\det(M)$.\n\nUsing only the fundamental structure of the BdG formalism and particle-hole symmetry, construct the appropriate antisymmetric matrix $B(k)$ at $k=0$ and $k=\\pi$, and then evaluate the sign of $\\mathrm{Pf}[B(0)]\\,\\mathrm{Pf}[B(\\pi)]$ for the parameter set $t=1$, $\\Delta=0.7$, and $\\mu=\\tfrac{3}{2}$. Provide the final value of the Majorana number $\\mathcal{M}$ as a single real number $\\pm 1$. No rounding is needed.", "solution": "The problem requires the calculation of the Majorana number $\\mathcal{M}$ for a one-dimensional $p$-wave superconductor described by the Bogoliubov-de Gennes (BdG) Hamiltonian $\\mathcal{H}(k)$. The Majorana number for a class $D$ system in one dimension is a $\\mathbb{Z}_2$ topological invariant, which can be determined by examining the properties of the Hamiltonian at the particle-hole symmetric momenta, $k=0$ and $k=\\pi$.\n\nThe Majorana number $\\mathcal{M}$ is given by the formula:\n$$\n\\mathcal{M} = \\mathrm{sign}\\left( \\mathrm{Pf}[B(0)] \\cdot \\mathrm{Pf}[B(\\pi)] \\right)\n$$\nwhere $\\mathrm{Pf}[\\cdot]$ denotes the Pfaffian, and $B(k)$ is an antisymmetric matrix constructed from the BdG Hamiltonian $\\mathcal{H}(k)$ at the momenta $k=0$ and $k=\\pi$.\n\nThe particle-hole symmetry (PHS) is implemented by the operator $C = \\tau_x K$, where $\\tau_x$ is the first Pauli matrix and $K$ is the complex conjugation operator. The Hamiltonian satisfies the symmetry relation $C \\mathcal{H}(k) C^{-1} = -\\mathcal{H}(-k)$. At the PHS-invariant momenta $k_{inv} \\in \\{0, \\pi\\}$, this relation simplifies because $-k_{inv} \\equiv k_{inv} \\pmod{2\\pi}$. The relation becomes:\n$$\n(\\tau_x K) \\mathcal{H}(k_{inv}) (K^{-1} \\tau_x^{-1}) = \\tau_x \\mathcal{H}^*(k_{inv}) \\tau_x = -\\mathcal{H}(k_{inv})\n$$\nThe appropriate antisymmetric matrix $B(k)$ is constructed as $B(k) = \\mathcal{H}(k) U$, where $U$ is the unitary part of the PHS operator. In this case, $U = \\tau_x$. Let's construct $B(k_{inv}) = \\mathcal{H}(k_{inv}) \\tau_x$ and verify that it is antisymmetric. A matrix $M$ is antisymmetric if its transpose $M^T$ is equal to $-M$.\n\nThe transpose of $B(k_{inv})$ is $B(k_{inv})^T = (\\mathcal{H}(k_{inv}) \\tau_x)^T = \\tau_x^T \\mathcal{H}(k_{inv})^T = \\tau_x \\mathcal{H}(k_{inv})^T$. Since $\\mathcal{H}(k)$ is a Hermitian matrix, $\\mathcal{H}(k_{inv})^\\dagger = \\mathcal{H}(k_{inv})$, which means $\\mathcal{H}(k_{inv})^T = \\mathcal{H}(k_{inv})^*$.\nSo, $B(k_{inv})^T = \\tau_x \\mathcal{H}(k_{inv})^*$.\n\nFrom the PHS relation, we have $\\tau_x \\mathcal{H}^*(k_{inv}) \\tau_x = -\\mathcal{H}(k_{inv})$. Multiplying by $\\tau_x$ from the right yields $\\tau_x \\mathcal{H}^*(k_{inv}) = -\\mathcal{H}(k_{inv})\\tau_x$.\nThis shows that $B(k_{inv})^T = -\\mathcal{H}(k_{inv})\\tau_x = -B(k_{inv})$. Thus, the matrix $B(k_{inv})$ is indeed antisymmetric, and its Pfaffian is well-defined.\n\nNow, we must find the explicit form of $B(k_{inv})$. The BdG Hamiltonian is given by:\n$$\n\\mathcal{H}(k) = \\xi(k)\\,\\tau_{z}+2\\Delta\\,\\sin k\\, \\tau_{y}\n$$\nAt the momenta $k=0$ and $k=\\pi$, the term $\\sin k$ is zero. Therefore, the Hamiltonian simplifies to:\n$$\n\\mathcal{H}(k_{inv}) = \\xi(k_{inv})\\,\\tau_{z}\n$$\nWe can now construct $B(k_{inv})$:\n$$\nB(k_{inv}) = \\mathcal{H}(k_{inv})\\tau_x = (\\xi(k_{inv})\\,\\tau_{z})\\tau_x = \\xi(k_{inv})(\\tau_z \\tau_x)\n$$\nUsing the Pauli matrix identity $\\tau_z \\tau_x = i\\tau_y$, we get:\n$$\nB(k_{inv}) = i\\xi(k_{inv})\\tau_y = i\\xi(k_{inv}) \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix} = \\xi(k_{inv}) \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}\n$$\nThis is a $2 \\times 2$ real antisymmetric matrix. For a general $2 \\times 2$ antisymmetric matrix $M = \\begin{pmatrix} 0  a \\\\ -a  0 \\end{pmatrix}$, the Pfaffian is defined as $\\mathrm{Pf}(M) = a$.\nIn our case, the off-diagonal element is $a = \\xi(k_{inv})$. Therefore, the Pfaffian is:\n$$\n\\mathrm{Pf}[B(k_{inv})] = \\xi(k_{inv})\n$$\nThe Majorana number is then given by the sign of the product of the Pfaffians at $k=0$ and $k=\\pi$:\n$$\n\\mathcal{M} = \\mathrm{sign}(\\xi(0) \\cdot \\xi(\\pi))\n$$\nWe are given the parameters $t=1$, $\\Delta=0.7$, and $\\mu=\\frac{3}{2}$. The dispersion is $\\xi(k) = -\\mu-2t\\cos k$. The value of $\\Delta$ is not needed for this calculation as it only affects the off-diagonal terms of $\\mathcal{H}(k)$ which vanish at $k=0$ and $k=\\pi$.\n\nLet's evaluate $\\xi(k)$ at $k=0$ and $k=\\pi$:\nFor $k=0$:\n$$\n\\xi(0) = -\\mu - 2t\\cos(0) = -\\frac{3}{2} - 2(1)(1) = -\\frac{3}{2} - 2 = -\\frac{7}{2}\n$$\nFor $k=\\pi$:\n$$\n\\xi(\\pi) = -\\mu - 2t\\cos(\\pi) = -\\frac{3}{2} - 2(1)(-1) = -\\frac{3}{2} + 2 = \\frac{1}{2}\n$$\nNow, we can compute the Majorana number $\\mathcal{M}$:\n$$\n\\mathcal{M} = \\mathrm{sign}\\left( \\left(-\\frac{7}{2}\\right) \\cdot \\left(\\frac{1}{2}\\right) \\right) = \\mathrm{sign}\\left(-\\frac{7}{4}\\right)\n$$\nThe sign of a negative number is $-1$. Therefore, the Majorana number is:\n$$\n\\mathcal{M} = -1\n$$\nThis indicates that for the given parameters, the system is in the topologically non-trivial phase, which hosts Majorana zero modes at its ends.", "answer": "$$\\boxed{-1}$$", "id": "3003983"}, {"introduction": "While analytical calculations are essential for foundational understanding, modern condensed matter physics heavily relies on computational methods to explore complex models and vast parameter spaces. This next exercise [@problem_id:3003940] challenges you to translate the theoretical procedure for computing the $\\mathbb{Z}_2$ invariant into a concrete, runnable algorithm. By implementing a numerically stable Pfaffian function and applying it to the Kitaev chain, you will gain hands-on experience in the computational verification of topological properties, a vital skill for theoretical research.", "problem": "You must write a complete, runnable program that, given a translationally invariant one-dimensional Bogoliubov-de Gennes (BdG) Hamiltonian with particle-hole symmetry, computes the one-dimensional $\\mathbb{Z}_2$ topological invariant in symmetry class D by evaluating the sign of the Pfaffian at the time-reversal-invariant momenta $k=0$ and $k=\\pi$ (wave vector $k$ in radians). The invariant is defined as the product of these signs, and a negative product indicates a nontrivial phase with a Majorana zero mode. Start from fundamental principles: (i) the Majorana representation of quadratic fermionic Hamiltonians yields a real antisymmetric matrix whose Pfaffian encodes the ground-state fermion parity, and (ii) in one dimension the $\\mathbb{Z}_2$ invariant is captured by the change in Pfaffian sign between $k=0$ and $k=\\pi$.\n\nYour program must implement the following algorithmic steps for a general even-dimensional lattice BdG problem, and then specialize and test it on a discretized Kitaev chain:\n\n1. Given a BdG Hamiltonian $H(k)$ in Nambu basis $\\Psi_k=(c_k, c_{-k}^\\dagger)$ that is particle-hole symmetric and translationally invariant, construct a real antisymmetric Majorana matrix $A(k)$ at $k=0$ and $k=\\pi$. The Majorana quadratic form can be written as $\\frac{i}{4}\\,\\Gamma^\\top A(k) \\Gamma$, where $\\Gamma$ collects Majorana operators. For a single-band spinless Kitaev chain with real parameters, the antisymmetric $A(k)$ at $k=0$ and $k=\\pi$ reduces to a $2\\times 2$ matrix \n$$A(k)=\\begin{pmatrix}0  g(k)\\\\ -g(k)  0\\end{pmatrix}$$\n with $g(k)=-\\mu-2t\\cos k$, where $\\mu$ is the chemical potential and $t$ is the hopping amplitude. The pairing amplitude $\\Delta$ does not affect $A(k)$ at $k=0$ and $k=\\pi$ because $\\sin k=0$ there (assuming real $\\Delta$).\n\n2. Implement a numerically stable Pfaffian computation for a real antisymmetric matrix $A$ of even dimension by recursive skew-symmetric elimination: choose a nonzero pivot $p=A_{0,1}$ (after potential row/column swaps tracked as a permutation sign), update the trailing block $B$ by $B\\leftarrow B + \\frac{1}{p}(u v^\\top - v u^\\top)$ where $u=A_{0,2:}$ and $v=A_{1,2:}$, and recurse. If all potential pivots vanish, return $0$ for the Pfaffian.\n\n3. Define the sign function $\\operatorname{sgn}(\\operatorname{Pf}(A(k)))$ to return $-1$ if $\\operatorname{Pf}(A(k))0$, $+1$ if $\\operatorname{Pf}(A(k))0$, and $0$ if $|\\operatorname{Pf}(A(k))|$ is below a small tolerance (indicating a gap-closing boundary).\n\n4. The $\\mathbb{Z}_2$ invariant is given by $\\nu=\\operatorname{sgn}(\\operatorname{Pf}(A(0)))\\times \\operatorname{sgn}(\\operatorname{Pf}(A(\\pi)))$. A negative product yields the nontrivial topological phase (Majorana zero modes), a positive product yields the trivial phase, and any zero factor indicates a boundary (gap closing).\n\nTest Suite Specification and Output Format:\n- Specialize to the spinless Kitaev chain with BdG Hamiltonian $H(k)=\\xi(k)\\,\\tau_z+\\Delta \\sin k\\,\\tau_y$ in the Nambu basis, with $\\xi(k)=-\\mu-2t\\cos k$, where $\\tau_x$, $\\tau_y$, and $\\tau_z$ are Pauli matrices acting in particle-hole space and $\\Delta$ is taken real. For this chain, use \n$$A(k)=\\begin{pmatrix}0  -\\mu-2t\\cos k\\\\ \\mu+2t\\cos k  0\\end{pmatrix}$$ at $k=0$ and $k=\\pi$.\n- Implement and run the algorithm on the following parameter sets (angles $k$ are in radians; no physical units are required):\n    1. $t=1$, $\\mu=0$, $\\Delta=0.3$ (generic nontrivial case).\n    2. $t=1$, $\\mu=3$, $\\Delta=0.3$ (generic trivial case).\n    3. $t=1$, $\\mu=-3$, $\\Delta=0.7$ (generic trivial case with negative $\\mu$).\n    4. $t=1$, $\\mu=2$, $\\Delta=0.5$ (boundary case where one Pfaffian vanishes).\n    5. $t=1$, $\\mu=-2$, $\\Delta=0.5$ (boundary case where one Pfaffian vanishes).\n    6. $t=-1$, $\\mu=0$, $\\Delta=0.4$ (sign of $t$ flipped; classification should depend on $|\\mu|2|t|$).\n- For each parameter set, output a list $[s_0,s_\\pi,\\text{topological}]$, where $s_0=\\operatorname{sgn}(\\operatorname{Pf}(A(0)))$ and $s_\\pi=\\operatorname{sgn}(\\operatorname{Pf}(A(\\pi)))$ are integers in $\\{-1,0,+1\\}$ and $\\text{topological}$ is a boolean indicating whether $\\nu=-1$ strictly (i.e., neither $s_0$ nor $s_\\pi$ is $0$ and their product is $-1$).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry corresponding to one test case in the same order as above. For example: `[[$s_0, s_\\pi, \\text{topological}],\\ldots]`.\n\nNo external input is allowed; the program must run and print the answer directly.", "solution": "The problem asks for the computation of the one-dimensional $\\mathbb{Z}_2$ topological invariant for a Kitaev chain, a canonical model of a topological superconductor in symmetry class D. This requires implementing a general, numerically stable algorithm for computing the Pfaffian of a real antisymmetric matrix and then applying it to the specific case of the Kitaev chain at high-symmetry points in momentum space.\n\nThe solution proceeds from fundamental principles. First, we establish the connection between quadratic fermionic Hamiltonians, the Majorana representation, and the Pfaffian. Second, we define the $\\mathbb{Z}_2$ invariant in terms of the Pfaffian signs at specific momenta. Third, we detail the implementation of a robust recursive algorithm for the Pfaffian. Finally, we apply this machinery to the provided test cases for the Kitaev chain.\n\n**1. Majorana Representation and the Pfaffian**\n\nA general quadratic Hamiltonian of fermions can be written as $H = \\sum_{i,j} c_i^\\dagger H_{ij} c_j + \\frac{1}{2}\\sum_{i,j} (\\Delta_{ij} c_i^\\dagger c_j^\\dagger + \\text{h.c.})$, where $c_i$ are fermion annihilation operators. By introducing Majorana fermion operators, $\\gamma_{2i-1} = c_i + c_i^\\dagger$ and $\\gamma_{2i} = -i(c_i - c_i^\\dagger)$, which are Hermitian and satisfy $\\{\\gamma_a, \\gamma_b\\} = 2\\delta_{ab}$, we can express any such Hamiltonian in the form\n$$H = \\frac{i}{4} \\sum_{a,b} \\Gamma_a^\\top A_{ab} \\Gamma_b$$\nwhere $\\Gamma$ is a vector of all Majorana operators and $A$ is a real, antisymmetric matrix.\n\nThe significance of this representation is that the ground state properties of $H$ are encoded in the Pfaffian of the matrix $A$. The Pfaffian, $\\operatorname{Pf}(A)$, is a polynomial in the matrix entries such that $(\\operatorname{Pf}(A))^2 = \\det(A)$. For a system in symmetry class D (characterized by particle-hole symmetry $P$ with $P^2=1$), the matrix $A$ is real and antisymmetric. The sign of the Pfaffian, $\\operatorname{sgn}(\\operatorname{Pf}(A))$, corresponds to the fermion parity of the ground state, $(-1)^{N_F}$, where $N_F$ is the ground-state fermion number. A value of $\\operatorname{sgn}(\\operatorname{Pf}(A))=+1$ indicates an even number of fermions (including zero), while $\\operatorname{sgn}(\\operatorname{Pf}(A))=-1$ indicates an odd number.\n\n**2. The $\\mathbb{Z}_2$ Topological Invariant in 1D**\n\nFor a one-dimensional, translationally invariant system, the Hamiltonian and the corresponding Majorana matrix $A$ are functions of the wave vector $k$, which is defined in the Brillouin zone $k \\in [-\\pi, \\pi)$. The system has two special, time-reversal-invariant momenta (TRIMs), $k=0$ and $k=\\pi$.\n\nThe $\\mathbb{Z}_2$ topological invariant, $\\nu$, for a class D system in one dimension, is determined by the change in the ground-state fermion parity between these two TRIMs. It is defined as the product of the signs of the Pfaffian at these points:\n$$\\nu = \\operatorname{sgn}(\\operatorname{Pf}(A(k=0))) \\times \\operatorname{sgn}(\\operatorname{Pf}(A(k=\\pi)))$$\n- If $\\nu = +1$, the ground state has the same fermion parity at $k=0$ and $k=\\pi$. The system is in a topologically trivial phase.\n- If $\\nu = -1$, the parity changes, indicating a band inversion and a topological phase transition must occur for some $k \\in (0, \\pi)$. The system is in a topologically nontrivial phase, which hosts a protected Majorana zero mode at each end when the chain has open boundaries.\n- If either $\\operatorname{Pf}(A(0))$ or $\\operatorname{Pf}(A(\\pi))$ is zero, the energy gap closes at that TRIM. This corresponds to a topological phase boundary.\n\n**3. Application to the Kitaev Chain**\n\nThe problem provides the Bogoliubov-de Gennes (BdG) Hamiltonian for a spinless Kitaev chain in the Nambu basis $\\Psi_k^\\dagger = (c_k^\\dagger, c_{-k})$:\n$$H(k) = \\xi(k)\\,\\tau_z + \\Delta \\sin k\\,\\tau_y = \\begin{pmatrix} \\xi(k)  -i\\Delta\\sin k \\\\ i\\Delta\\sin k  -\\xi(k) \\end{pmatrix}$$\nwith $\\xi(k) = -\\mu - 2t \\cos k$. At the TRIMs $k=0$ and $k=\\pi$, the term $\\sin k$ vanishes. The Hamiltonian simplifies to $H(k) = \\xi(k)\\tau_z$. The corresponding Majorana matrix $A(k)$ becomes block-diagonal, and the relevant sub-block for computing the fermion parity is given by:\n$$A(k) = \\begin{pmatrix} 0  g(k) \\\\ -g(k)  0 \\end{pmatrix}, \\quad \\text{where } g(k) = \\xi(k) = -\\mu - 2t \\cos k$$\nfor $k \\in \\{0, \\pi\\}$. The Pfaffian of this $2\\times 2$ matrix is simply $\\operatorname{Pf}(A(k)) = g(k)$.\n\nTherefore, the invariant is computed as:\n$$\\nu = \\operatorname{sgn}(g(0)) \\times \\operatorname{sgn}(g(\\pi)) = \\operatorname{sgn}(-\\mu - 2t) \\times \\operatorname{sgn}(-\\mu + 2t)$$\nA nontrivial phase ($\\nu=-1$) exists if and only if $(-\\mu - 2t)$ and $(-\\mu + 2t)$ have opposite signs. This inequality holds when $\\mu$ lies strictly between $-2t$ and $2t$, which simplifies to $|\\mu|  2|t|$ for $t0$.\n\n**4. Pfaffian Computation Algorithm**\n\nThe problem requires implementing a general, numerically stable algorithm for computing the Pfaffian of an even-dimensional, real antisymmetric matrix $A$. The specified method is a recursive elimination procedure. Let $A$ be a $2n \\times 2n$ matrix.\n\n1.  **Base Case**: If $n=0$ (the matrix is $0 \\times 0$), the Pfaffian is $1$ by definition.\n2.  **Pivot Selection**: For numerical stability, we select a pivot $p = A_{i,j}$ such that $|A_{i,j}|$ is the largest off-diagonal element in magnitude. We then perform row and column swaps to move this element to the $A_{0,1}$ position. This permutation incurs a sign change if the number of swaps is odd. Let's say we swap row/col $0$ with $i$ and row/col $1$ with $j$. The sign of the permutation must be tracked. A simpler, stable approach is to find the maximum element in the first row, say $A_{0,j}$, and swap column/row $1$ with $j$. The sign change is $(-1)$ if $j \\neq 1$.\n3.  **Recursive Step**: After pivoting, the matrix has the form:\n    $$A' = \\begin{pmatrix} 0  p  \\mathbf{u} \\\\ -p  0  \\mathbf{v} \\\\ -\\mathbf{u}^\\top  -\\mathbf{v}^\\top  B \\end{pmatrix}$$\n    where $p=A'_{0,1}$, $\\mathbf{u}=A'_{0,2:}$, $\\mathbf{v}=A'_{1,2:}$ are row vectors of size $2n-2$, and $B$ is the trailing $(2n-2) \\times (2n-2)$ antisymmetric submatrix. The Pfaffian of $A$ is related to the Pfaffian of a smaller matrix derived from $B$. The required update rule, equivalent to finding the Pfaffian of the Schur complement, is:\n    $$B_{new} = B + \\frac{1}{p}(\\mathbf{v}^\\top \\mathbf{u} - \\mathbf{u}^\\top \\mathbf{v})$$\n    where $\\mathbf{u}^\\top\\mathbf{v}$ denotes the outer product of the vectors. The recursion relation for the Pfaffian is:\n    $$\\operatorname{Pf}(A) = (\\text{sign of permutation}) \\times p \\times \\operatorname{Pf}(B_{new})$$\n4.  **Zero Pfaffian**: If all off-diagonal elements of the matrix are zero (within a numerical tolerance), the Pfaffian is $0$.\n\nThis algorithm is implemented for general even-dimensional matrices and then applied to the $2 \\times 2$ matrices from the Kitaev chain model, as required. A sign function with a small tolerance is used to categorize the Pfaffian values into $\\{-1, 0, +1\\}$.", "answer": "```python\nimport numpy as np\n\ndef pfaffian_recursive(matrix, tol=1e-12):\n    \"\"\"\n    Computes the Pfaffian of a real antisymmetric matrix using recursive\n    skew-symmetric elimination.\n\n    Args:\n        matrix (np.ndarray): A real, antisymmetric square matrix of even dimension.\n        tol (float): Tolerance for checking if a value is zero.\n\n    Returns:\n        float: The Pfaffian of the matrix.\n    \"\"\"\n    n = matrix.shape[0]\n    \n    if n % 2 != 0:\n        raise ValueError(\"Matrix must have an even dimension.\")\n    \n    if n == 0:\n        return 1.0\n\n    # Make a copy to avoid modifying the original matrix\n    A = matrix.copy()\n\n    # Find the largest off-diagonal element in magnitude to use as pivot for stability.\n    # We only need to search the upper triangle.\n    pivot_row, pivot_col = 0, 1\n    max_val = 0.0\n    for i in range(n):\n        for j in range(i + 1, n):\n            if abs(A[i, j])  max_val:\n                max_val = abs(A[i, j])\n                pivot_row, pivot_col = i, j\n\n    if max_val  tol:\n        return 0.0\n\n    # Permutation sign from swaps\n    perm_sign = 1.0\n    \n    # Swap row/col pivot_row with 0\n    if pivot_row != 0:\n        A[[0, pivot_row], :] = A[[pivot_row, 0], :]\n        A[:, [0, pivot_row]] = A[:, [pivot_row, 0]]\n        perm_sign *= -1.0\n        \n    # Swap row/col pivot_col with 1\n    if pivot_col != 1:\n        # If pivot_col was originally 0, it's now at pivot_row\n        if pivot_col == 0:\n            pivot_col = pivot_row\n            \n        A[[1, pivot_col], :] = A[[pivot_col, 1], :]\n        A[:, [1, pivot_col]] = A[:, [pivot_col, 1]]\n        perm_sign *= -1.0\n        \n    p = A[0, 1]\n    \n    if n == 2:\n        return perm_sign * p\n\n    # Extract submatrices for the recursive step\n    B = A[2:, 2:]\n    u = A[0, 2:]  # Row vector\n    v = A[1, 2:]  # Row vector\n    \n    # Update trailing submatrix B using the specified formula\n    # np.outer(v, u) corresponds to v^T u in mathematical notation for row vectors u, v\n    B_new = B + (np.outer(v, u) - np.outer(u, v)) / p\n    \n    return perm_sign * p * pfaffian_recursive(B_new, tol)\n\ndef sign_pf(val, tol=1e-9):\n    \"\"\"\n    Computes the sign of the Pfaffian, treating values below tolerance as zero.\n    \"\"\"\n    if abs(val)  tol:\n        return 0\n    return 1 if val  0 else -1\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite of the Kitaev chain.\n    \"\"\"\n    test_cases = [\n        # (t, mu, Delta)\n        (1.0, 0.0, 0.3),    # nontrivial\n        (1.0, 3.0, 0.3),    # trivial\n        (1.0, -3.0, 0.7),   # trivial\n        (1.0, 2.0, 0.5),    # boundary\n        (1.0, -2.0, 0.5),   # boundary\n        (-1.0, 0.0, 0.4),   # nontrivial (t0)\n    ]\n\n    results = []\n    for t, mu, delta in test_cases:\n        # Define g(k) = -mu - 2*t*cos(k)\n        g0 = -mu - 2 * t * np.cos(0)\n        g_pi = -mu - 2 * t * np.cos(np.pi)\n        \n        # Construct the 2x2 Majorana matrices at k=0 and k=pi\n        A0 = np.array([[0, g0], [-g0, 0]])\n        A_pi = np.array([[0, g_pi], [-g_pi, 0]])\n        \n        # Compute Pfaffians using the general recursive algorithm\n        pf0 = pfaffian_recursive(A0)\n        pf_pi = pfaffian_recursive(A_pi)\n        \n        # Compute the signs\n        s0 = sign_pf(pf0)\n        s_pi = sign_pf(pf_pi)\n        \n        # Determine if the phase is topological (invariant nu = -1)\n        # It's topological only if s0*s_pi is strictly -1.\n        is_topological = (s0 * s_pi == -1)\n        \n        results.append([s0, s_pi, is_topological])\n\n    # Format the output string as a list of lists.\n    # str() on a list automatically adds brackets, which matches the required format.\n    result_strings = [str(r) for r in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3003940"}, {"introduction": "The ultimate goal of this field is the experimental detection and manipulation of Majorana zero modes, but this endeavor is fraught with subtlety. In realistic devices, trivial, non-topological states can arise at low energies and mimic the expected signatures of true Majorana zero modes (MZMs), leading to potential misinterpretation. This final practice [@problem_id:3003997] hones your ability to think like an experimentalist, tasking you with critically evaluating the physical mechanisms and spectroscopic signatures that can distinguish a topologically-protected MZM from a trivial 'impostor' state. Mastering these distinctions is paramount for critically assessing experimental claims and designing robust verification protocols.", "problem": "A ferromagnetic chain of magnetic adatoms on the surface of an $s$-wave superconductor forms a Yu–Shiba–Rusinov band which, in the presence of spin–orbit coupling, can be modeled at low energies as an effectively spinless $1\\mathrm{D}$ superconducting channel described by a Bogoliubov–de Gennes (BdG) Hamiltonian with particle–hole symmetry in symmetry class $D$. Consider an effective continuum description in which the local chemical potential $ \\mu(x) $ varies smoothly near the chain ends over a length scale $ \\ell $ that satisfies $k_F^{-1} \\ll \\ell \\lesssim \\xi$, where $ k_F $ is the Fermi wave number of the emergent Shiba band and $ \\xi $ is the superconducting coherence length set by the induced gap. Assume that for uniform parameters the chain would be in the topologically trivial phase. \n\nUsing first principles of the BdG formalism and the notion that smooth spatial inhomogeneity produces semiclassical turning points for quasiparticles, reason how a smooth end-of-chain potential $ \\mu(x) $ can generate near-zero-energy end states without changing the bulk topological invariant. Based on this mechanism, identify which of the following statements about physical consequences and distinguishing measurements are correct.\n\nOptions:\n\nA. A slowly varying $ \\mu(x) $ can create near-zero-energy Andreev bound states localized at the chain end by producing a spatial region where an effective mass term in a reduced $1\\mathrm{D}$ Dirac description changes sign, yielding a pair of strongly overlapping Majorana components confined by a soft boundary; the global topological invariant remains trivial because the bulk never undergoes a true gap closing.\n\nB. In scanning tunneling microscopy, trivial smooth-potential end states and true Majorana zero modes are indistinguishable because both must produce a quantized zero-bias conductance of $2e^2/h$ at zero temperature even for weak tunnel coupling.\n\nC. In a floating Shiba-chain island with finite charging energy, end-to-end nonlocal spectroscopy that gates one end and measures both ends shows correlated shifts and splittings of the zero-bias features for true Majorana zero modes, whereas trivial smooth-potential end states respond only locally to the gate.\n\nD. As a function of magnetic exchange strength or effective chemical potential, the energy splitting of true Majorana zero modes in a long uniform topological segment generically oscillates with a wave vector set by $ k_F $ and decays as $e^{-L/\\xi}$ with chain length $ L $, while trivial smooth-potential end states exhibit pinning near zero energy over finite parameter ranges without coherent oscillations.\n\nE. Spin-resolved tunneling can serve as a definitive discriminator: trivial smooth-potential end states inherit strong spin polarization from Yu–Shiba–Rusinov states and thus yield highly spin-polarized zero-bias peaks, whereas true Majorana zero modes in this setting are exactly spin-unpolarized at all energies.\n\nSelect all correct statements.", "solution": "The problem statement describes a realistic scenario in condensed matter physics relevant to the search for Majorana zero modes (MZMs). It presents a system—a ferromagnetic atom chain on an $s$-wave superconductor—known to be a platform for realizing an effective $1\\mathrm{D}$ topological superconductor. The core of the problem is to distinguish \"true\" topologically protected MZMs from \"trivial\" near-zero-energy Andreev bound states (ABS) that can arise from smooth potential variations at the chain ends.\n\nThe problem is scientifically grounded, well-posed, and objective. All terms used, such as Bogoliubov–de Gennes (BdG) Hamiltonian, symmetry class $D$, Yu-Shiba-Rusinov (YSR) bands, Fermi wave number $k_F$, and coherence length $\\xi$, are standard in the field. The premise that a chain, which is topologically trivial in its bulk, can host near-zero-energy states due to boundary effects is a central topic of current research. The problem is therefore valid.\n\n**Theoretical Framework**\n\nThe low-energy physics of the system is described by an effective $1\\mathrm{D}$ spinless $p$-wave superconductor. The BdG Hamiltonian for such a system can be written as:\n$$ H_{BdG} = \\int dx \\, \\Psi^\\dagger(x) \\begin{pmatrix} -\\frac{\\hbar^2}{2m^*}\\partial_x^2 - \\mu(x)  \\Delta_p \\frac{\\hbar}{i}\\partial_x \\\\ \\Delta_p^* \\frac{\\hbar}{i}\\partial_x  \\frac{\\hbar^2}{2m^*}\\partial_x^2 + \\mu(x) \\end{pmatrix} \\Psi(x) $$\nwhere $\\Psi(x) = (\\psi(x), \\psi^\\dagger(x))^T$ is the Nambu spinor, $m^*$ is the effective mass, $\\Delta_p$ is the induced $p$-wave pairing amplitude, and $\\mu(x)$ is the local chemical potential.\n\nThe topological phase is determined by the sign of the chemical potential $\\mu$ in the bulk. For a uniform system, the bulk is topologically non-trivial for $\\mu  0$, hosting a zero-energy MZM at each end. For $\\mu  0$, the bulk is topologically trivial, and no topologically protected end states exist.\n\nThe problem states that the bulk is topologically trivial, so we assume $\\mu(x) \\to \\mu_{bulk} > 0$ far from the ends. However, a smooth potential $\\mu(x)$ near an end can vary. If $\\mu(x)$ smoothly changes and creates a region where it locally behaves as if in the topological phase (e.g., by dipping below zero), it can trap a low-energy ABS. This state is not topologically protected because the bulk invariant is unchanged. It can be understood as a fermionic excitation $c = \\gamma_1 + i\\gamma_2$ where its two Majorana components, $\\gamma_1$ and $\\gamma_2$, are localized in the same region near the chain end. Their spatial overlap generally leads to a finite hybridization energy, splitting the state away from zero. A smooth potential can make this energy split accidentally small, creating a \"quasi-Majorana\" state that mimics a true MZM.\n\nWith this framework, we can evaluate the options.\n\n**Option-by-Option Analysis**\n\n**A. A slowly varying $ \\mu(x) $ can create near-zero-energy Andreev bound states localized at the chain end by producing a spatial region where an effective mass term in a reduced $1\\mathrm{D}$ Dirac description changes sign, yielding a pair of strongly overlapping Majorana components confined by a soft boundary; the global topological invariant remains trivial because the bulk never undergoes a true gap closing.**\n\nThis statement accurately describes the formation mechanism of a \"trivial\" near-zero-energy state. Linearizing the BdG Hamiltonian around the Fermi points $\\pm k_F$ yields a Dirac-like equation where the chemical potential $\\mu$ plays the role of a mass term. A spatial domain wall where this mass term changes sign is known to bind a zero-energy state (a Jackiw-Rebbi mode). In this context, if the smooth potential $\\mu(x)$ dips locally below zero near the end (while being positive in the bulk), it creates such a domain wall, trapping an ABS. This ABS, being a single localized fermion, is composed of two co-located (thus \"strongly overlapping\") Majorana components. Since the bulk properties (where $\\mu > 0$) are unchanged, the global topological invariant remains trivial. The description is physically sound.\n\n**Verdict: Correct**\n\n**B. In scanning tunneling microscopy, trivial smooth-potential end states and true Majorana zero modes are indistinguishable because both must produce a quantized zero-bias conductance of $ 2e^2/h $ at zero temperature even for weak tunnel coupling.**\n\nThis statement is incorrect. The quantized zero-bias conductance peak (ZBCP) of $ G = 2e^2/h $ at zero temperature $T=0$ and in the weak tunneling limit is a hallmark signature of a perfectly isolated MZM. This quantization arises from perfect Andreev reflection mediated by the MZM. A trivial ABS, being a conventional fermion state with energy $E_{ABS}$, gives rise to two conductance peaks at bias voltages $V = \\pm E_{ABS}/e$. If $E_{ABS}$ is very small, these peaks merge into a single ZBCP. However, the height of this peak is generally not quantized and is less than $2e^2/h$. While its electron and hole components might be nearly equal for a state very close to zero energy, leading to a conductance approaching the quantized value, it is not a guaranteed or required feature as it is for a true MZM. Therefore, the premise that both *must* produce a quantized peak is false, and they are, in principle, distinguishable by this measure.\n\n**Verdict: Incorrect**\n\n**C. In a floating Shiba-chain island with finite charging energy, end-to-end nonlocal spectroscopy that gates one end and measures both ends shows correlated shifts and splittings of the zero-bias features for true Majorana zero modes, whereas trivial smooth-potential end states respond only locally to the gate.**\n\nThis statement describes a key test for non-locality. A topologically non-trivial chain hosts two MZMs, $\\gamma_A$ and $\\gamma_B$, at its opposite ends. These two modes form a single, non-local fermionic degree of freedom, $f = (\\gamma_A + i\\gamma_B)/2$, whose state occupancy determines the island's charge parity. Gating the potential near one end (say, end A) perturbs the wavefunction of $\\gamma_A$, which in turn affects the hybridization energy and properties of the entire non-local $f$ state. Consequently, tunneling spectroscopy measurements at *both* end A and end B will show correlated responses (shifts, splittings) to the gate at end A. In contrast, trivial end states are local ABSs. The state at end A is physically separate from the state at end B. Gating end A will only significantly affect the local ABS at A. Spectroscopy at end B will be largely insensitive to the gate at end A (assuming the chain is long enough). This locality versus non-locality is a fundamental distinction.\n\n**Verdict: Correct**\n\n**D. As a function of magnetic exchange strength or effective chemical potential, the energy splitting of true Majorana zero modes in a long uniform topological segment generically oscillates with a wave vector set by $ k_F $ and decays as $ e^{-L/\\xi} $ with chain length $ L $, while trivial smooth-potential end states exhibit pinning near zero energy over finite parameter ranges without coherent oscillations.**\n\nThis statement correctly contrasts the characteristic parameter dependencies. For a finite topological wire of length $L$, the wavefunctions of the two end MZMs overlap, leading to an energy splitting $\\delta E$. This overlap integral depends on the interference between wavefunctions from the two ends, resulting in an oscillatory dependence on parameters like the Fermi wavevector $k_F$ and length $L$, i.e., $\\delta E \\propto e^{-L/\\xi} \\cos(k_F L)$. As a system parameter (like chemical potential or magnetic field) is varied, $k_F$ changes, causing $\\delta E$ to oscillate around zero. Trivial end states, on the other hand, are single bound states whose energy $E_{ABS}$ is determined by local conditions. Their energy does not exhibit the systematic $k_F L$ oscillations characteristic of MZM hybridization. Instead, the energy of these quasi-Majorana states can be \"sticky\" or \"pinned\" near $E=0$ over finite parameter ranges, a behavior that can be linked to disorder-induced effects in class D systems, before moving away non-periodically. This qualitative difference in the parameter-dependence of the low-energy state is a valid and important discriminator.\n\n**Verdict: Correct**\n\n**E. Spin-resolved tunneling can serve as a definitive discriminator: trivial smooth-potential end states inherit strong spin polarization from Yu–Shiba–Rusinov states and thus yield highly spin-polarized zero-bias peaks, whereas true Majorana zero modes in this setting are exactly spin-unpolarized at all energies.**\n\nThis statement is factually incorrect regarding the spin polarization of the MZM. The system described (ferromagnetic adatoms with SOC) produces an effective p-wave superconductor where the underlying electrons are spinful. The MZM is a superposition of these electron and hole states. Due to the presence of the strong local magnetic moments (ferromagnetic chain) and SOC, there is no general symmetry that would enforce the MZM to be spin-unpolarized. In fact, theoretical models and numerical simulations for such systems consistently show that the MZM is spin-polarized, with its polarization direction tied to the magnetic field and SOC axes. While the trivial ABS formed from the polarized YSR bands is also expected to be spin-polarized, the claim that the true MZM is \"exactly spin-unpolarized\" is false. The difference in spin texture or orientation between a trivial ABS and a true MZM might be a valid discriminator, but the premise presented in this option is wrong.\n\n**Verdict: Incorrect**", "answer": "$$\\boxed{ACD}$$", "id": "3003997"}]}