{"hands_on_practices": [{"introduction": "Understanding magnetocrystalline anisotropy begins with its measurement. This practice demonstrates a powerful thermodynamic method to determine the uniaxial anisotropy constant, $K_u$, directly from experimental magnetization curves [@problem_id:3002886]. By calculating the work required to magnetize a sample along its easy and hard axes, you will bridge the gap between macroscopic magnetometry data and a fundamental microscopic energy parameter.", "problem": "A uniaxial ferromagnet at fixed temperature is measured in the quasi-static, reversible regime. The internal magnetic field as a function of magnetization is obtained along the crystallographic easy axis and the hard axis after correcting for demagnetizing fields. The saturation magnetization is $M_{s}=8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}}$. Over the range $0\\leq M\\leq M_{s}$, the reversible internal field–magnetization relations are well described by\n$$H_{\\text{hard}}(M)=1.25\\,M,$$\n$$H_{\\text{easy}}(M)=0.08\\,M+0.04\\,\\frac{M^{3}}{M_{s}^{2}},$$\nwhere $H$ and $M$ are in $\\mathrm{A\\,m^{-1}}$. Assume that magnetoelastic effects and any extrinsic pinning contributions are negligible, and that the measurements are made sufficiently slowly to avoid eddy-current dissipation. Work in the International System of Units (SI), where the quasi-static magnetic work density is related to changes in magnetization by $dW=\\mu_{0}\\,H\\,dM$ with $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$.\n\nStarting from the thermodynamic work expression and the definition of magnetocrystalline anisotropy energy density as the reversible work per unit volume required to rotate the magnetization from the easy axis to the hard axis at fixed $M$, derive an expression for the uniaxial anisotropy constant $K_{u}$ in terms of the area between the hard-axis and easy-axis reversible curves in the $H$–$M$ plane. State clearly the assumptions required for this construction to be valid. Then, using the given $H(M)$ relations, evaluate $K_{u}$ numerically.\n\nExpress your final answer for $K_{u}$ in $\\mathrm{kJ\\,m^{-3}}$ and round your answer to four significant figures.", "solution": "The problem asks for a derivation of the uniaxial anisotropy constant, $K_u$, in terms of the area between the hard-axis and easy-axis magnetization curves, a statement of the underlying assumptions, and a numerical calculation of $K_u$.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- Saturation magnetization: $M_{s}=8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}}$\n- Hard-axis internal field-magnetization relation: $H_{\\text{hard}}(M)=1.25\\,M$ for $0\\leq M\\leq M_{s}$\n- Easy-axis internal field-magnetization relation: $H_{\\text{easy}}(M)=0.08\\,M+0.04\\,\\frac{M^{3}}{M_{s}^{2}}$ for $0\\leq M\\leq M_{s}$\n- Quasi-static magnetic work density change: $dW=\\mu_{0}\\,H\\,dM$\n- Permeability of free space: $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$\n- Definition of magnetocrystalline anisotropy energy density: the reversible work per unit volume required to rotate the magnetization from the easy axis to the hard axis at a fixed magnitude of magnetization, $M$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the principles of magnetism within condensed matter physics. It uses standard definitions for magnetic work and magnetocrystalline anisotropy. The provided functional forms for the field-magnetization relations, $H(M)$, are phenomenological but physically plausible for reversible magnetization processes in a uniaxial material. The problem is well-posed, self-contained, and all necessary data for a unique solution are provided. The language is objective and unambiguous. The values provided are physically realistic. The problem is a standard exercise in magnetism and is not trivial or ill-posed.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\n### Derivation and Solution\n\nThe magnetic work done per unit volume, $W$, to magnetize a material from a demagnetized state ($M=0$) to a state with magnetization magnitude $M$ is given by the integral of the work density expression:\n$$W(M) = \\int_0^M \\mu_0 H(m) dm$$\nThis work corresponds to the change in the magnetic part of the Helmholtz free energy density of the system at constant temperature.\n\nFor a uniaxial magnetic material, the magnetocrystalline anisotropy energy density, $E_a$, is the energy that depends on the orientation of the magnetization vector with respect to the crystallographic axes. For the simplest uniaxial case, it is given by:\n$$E_a(\\theta) = K_u \\sin^2(\\theta)$$\nwhere $K_u$ is the first-order uniaxial anisotropy constant and $\\theta$ is the angle between the magnetization vector and the easy axis.\n\nWhen the material is magnetized along the easy axis, $\\theta=0$, so the anisotropy energy stored is $E_a(0) = K_u \\sin^2(0) = 0$. The work done to saturate the material to $M_s$ along the easy axis is:\n$$W_{\\text{easy}} = \\int_0^{M_s} \\mu_0 H_{\\text{easy}}(M) dM$$\n\nWhen the material is magnetized along the hard axis, the magnetization is forced to align perpendicular to the easy axis, so $\\theta=\\frac{\\pi}{2}$. The stored anisotropy energy density in this state is $E_a(\\frac{\\pi}{2}) = K_u \\sin^2(\\frac{\\pi}{2}) = K_u$. The work done to saturate the material to $M_s$ along the hard axis is:\n$$W_{\\text{hard}} = \\int_0^{M_s} \\mu_0 H_{\\text{hard}}(M) dM$$\n\nThe difference in the work required to saturate the material along the hard and easy axes must be equal to the difference in the stored anisotropy energy between these two states.\n$$\\Delta W = W_{\\text{hard}} - W_{\\text{easy}} = E_a(\\frac{\\pi}{2}) - E_a(0) = K_u - 0 = K_u$$\nTherefore, we can express $K_u$ as:\n$$K_u = \\int_0^{M_s} \\mu_0 H_{\\text{hard}}(M) dM - \\int_0^{M_s} \\mu_0 H_{\\text{easy}}(M) dM$$\n$$K_u = \\mu_0 \\int_0^{M_s} \\left[ H_{\\text{hard}}(M) - H_{\\text{easy}}(M) \\right] dM$$\nThe integral term, $A = \\int_0^{M_s} [H_{\\text{hard}}(M) - H_{\\text{easy}}(M)] dM$, represents the area enclosed between the hard-axis and easy-axis magnetization curves in the $H-M$ plane, from $M=0$ to $M=M_s$. Thus, the expression for the uniaxial anisotropy constant is:\n$$K_u = \\mu_0 A$$\n\nThe main assumptions required for this derivation are:\n1.  The magnetization processes are thermodynamically reversible and quasi-static.\n2.  The free energy of the system can be additively separated into a magnetocrystalline anisotropy term and a term related to the interaction with the magnetic field.\n3.  The uniaxial anisotropy energy density is adequately described by the first-order term $E_a = K_u \\sin^2(\\theta)$, and higher-order terms are negligible.\n4.  The anisotropy constant $K_u$ is independent of the magnitude of magnetization $M$.\n5.  Extrinsic effects such as domain wall pinning, magnetoelastic contributions, and sample shape (demagnetizing fields) are negligible or have been properly corrected for, as stated in the problem.\n6.  The measurements are performed on a single crystal or a perfectly oriented polycrystalline sample.\n\nNow, we proceed with the numerical calculation. First, we find the area $A$ by integrating the difference between the given field expressions from $M=0$ to $M=M_s$.\n$$H_{\\text{hard}}(M) - H_{\\text{easy}}(M) = (1.25\\,M) - \\left(0.08\\,M+0.04\\,\\frac{M^{3}}{M_{s}^{2}}\\right) = 1.17\\,M - 0.04\\,\\frac{M^{3}}{M_{s}^{2}}$$\n$$A = \\int_0^{M_s} \\left( 1.17\\,M - 0.04\\,\\frac{M^{3}}{M_{s}^{2}} \\right) dM$$\nPerforming the integration:\n$$A = \\left[ \\frac{1.17}{2} M^{2} - \\frac{0.04}{4 M_{s}^{2}} M^{4} \\right]_0^{M_s}$$\n$$A = \\left[ 0.585 M^{2} - \\frac{0.01}{M_{s}^{2}} M^{4} \\right]_0^{M_s}$$\nEvaluating the definite integral:\n$$A = \\left( 0.585 M_{s}^{2} - \\frac{0.01}{M_{s}^{2}} M_{s}^{4} \\right) - (0) = 0.585 M_{s}^{2} - 0.01 M_{s}^{2} = 0.575 M_{s}^{2}$$\nNow, we calculate $K_u$:\n$$K_u = \\mu_0 A = \\mu_0 (0.575 M_{s}^{2})$$\nSubstituting the given values, $M_{s}=8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}}$ and $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$:\n$$K_u = (4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}) \\times 0.575 \\times (8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}})^{2}$$\n$$K_u = (4\\pi\\times 10^{-7}) \\times 0.575 \\times (64.0 \\times 10^{10})\\ \\mathrm{N\\,m^{-2}}$$\nThe units $\\mathrm{N\\,m^{-2}}$ are equivalent to $\\mathrm{J\\,m^{-3}}$, which is correct for energy density.\n$$K_u = (4\\pi \\times 0.575 \\times 64.0) \\times 10^{-7} \\times 10^{10}\\ \\mathrm{J\\,m^{-3}}$$\n$$K_u = (462.4424...) \\times 10^{3}\\ \\mathrm{J\\,m^{-3}}$$\nThe problem asks for the answer in kilojoules per cubic meter ($\\mathrm{kJ\\,m^{-3}}$).\n$$K_u = 462.4424...\\ \\mathrm{kJ\\,m^{-3}}$$\nRounding to four significant figures as requested:\n$$K_u \\approx 462.4\\ \\mathrm{kJ\\,m^{-3}}$$", "answer": "$$\\boxed{462.4}$$", "id": "3002886"}, {"introduction": "Beyond a material's intrinsic properties, anisotropy can be tailor-made by introducing mechanical strain, a technique central to thin-film magnetism. This exercise explores the physics of magnetoelasticity, where you will derive the effective uniaxial anisotropy induced in a cubic film by epitaxial strain [@problem_id:3002883]. Mastering this derivation provides insight into how strain engineering is used to control the magnetic behavior of materials at the nanoscale.", "problem": "A cubic ferromagnetic film is grown epitaxially on a cubic substrate so that a homogeneous, equi-biaxial in-plane strain is imposed. The strain state is diagonal and given by $\\,\\epsilon_{xx}=\\epsilon_{yy}=\\epsilon\\,$ and $\\,\\epsilon_{zz}=-2\\nu\\,\\epsilon\\,$, with no shear components. Here $\\,\\nu\\,$ is an effective elastic coupling appropriate for the biaxial epitaxial constraint and $\\,\\epsilon\\,$ is the imposed in-plane strain. The magnetization direction is described by the direction cosines $\\,\\alpha_{x},\\alpha_{y},\\alpha_{z}\\,$ relative to the cubic axes $[100],[010],[001]$, respectively.\n\nStarting from the general linear magnetoelastic coupling for a cubic crystal in the small-strain limit and using only well-established constitutive relations, recast the magnetoelastic energy density into a uniaxial form with respect to the film normal (the $z$-axis). Define the effective uniaxial anisotropy constant $\\,K_{\\text{me}}\\,$ by writing the magnetoelastic contribution as $\\,F_{\\text{me}}=K_{\\text{me}}\\sin^{2}\\theta+\\text{const}\\,$, where $\\,\\theta\\,$ is the angle between the magnetization and the film normal (take angles in radians). Compute $\\,K_{\\text{me}}\\,$ in terms of the cubic magnetoelastic coupling constant $\\,B_{1}\\,$, the in-plane strain $\\,\\epsilon\\,$, and $\\,\\nu\\,$. Provide your final result as a single closed-form analytic expression. Do not insert any numerical values. Express the final energy constant in Joules per cubic meter if you were to assign units, but report only the symbolic expression as the answer.", "solution": "The problem asks for the derivation of the effective uniaxial magnetoelastic anisotropy constant, $K_{\\text{me}}$, for a cubic ferromagnetic film under a specific state of biaxial strain. The derivation begins with the general expression for the magnetoelastic energy density, $F_{\\text{me}}$, in a cubic crystal, which is given as a function of the strain tensor components $\\epsilon_{ij}$ and the magnetization direction cosines $\\alpha_i$.\n\nThe general expression for the magnetoelastic energy density of a cubic crystal, considering terms linear in strain, is:\n$$F_{\\text{me}} = B_{1}(\\epsilon_{xx}\\alpha_{x}^{2} + \\epsilon_{yy}\\alpha_{y}^{2} + \\epsilon_{zz}\\alpha_{z}^{2}) + B_{2}(\\epsilon_{xy}\\alpha_{x}\\alpha_{y} + \\epsilon_{yz}\\alpha_{y}\\alpha_{z} + \\epsilon_{zx}\\alpha_{z}\\alpha_{x})$$\nHere, $B_{1}$ and $B_{2}$ are the magnetoelastic coupling constants. An additional isotropic term proportional to $\\epsilon_{xx}+\\epsilon_{yy}+\\epsilon_{zz}$ is independent of the magnetization direction and can be omitted as it only contributes to the constant energy offset.\n\nThe problem specifies the strain state of the film. It is an equi-biaxial in-plane strain, with the film normal along the $z$-axis. The non-zero strain components are:\n$$ \\epsilon_{xx} = \\epsilon_{yy} = \\epsilon $$\n$$ \\epsilon_{zz} = -2\\nu\\epsilon $$\nAll shear strain components are zero:\n$$ \\epsilon_{xy} = \\epsilon_{yz} = \\epsilon_{zx} = 0 $$\nwhere $\\epsilon$ is the magnitude of the in-plane strain and $\\nu$ is an effective elastic coupling constant.\n\nSubstituting these strain components into the general expression for $F_{\\text{me}}$:\n$$F_{\\text{me}} = B_{1}(\\epsilon\\alpha_{x}^{2} + \\epsilon\\alpha_{y}^{2} + (-2\\nu\\epsilon)\\alpha_{z}^{2}) + B_{2}(0 \\cdot \\alpha_{x}\\alpha_{y} + 0 \\cdot \\alpha_{y}\\alpha_{z} + 0 \\cdot \\alpha_{z}\\alpha_{x})$$\nThe term proportional to $B_{2}$ vanishes due to the absence of shear strains. The expression simplifies to:\n$$F_{\\text{me}} = B_{1}\\epsilon(\\alpha_{x}^{2} + \\alpha_{y}^{2} - 2\\nu\\alpha_{z}^{2})$$\nThe direction cosines $\\alpha_{x}$, $\\alpha_{y}$, and $\\alpha_{z}$ are subject to the normalization condition:\n$$ \\alpha_{x}^{2} + \\alpha_{y}^{2} + \\alpha_{z}^{2} = 1 $$\nThis allows us to eliminate the in-plane components $\\alpha_{x}^{2}$ and $\\alpha_{y}^{2}$:\n$$ \\alpha_{x}^{2} + \\alpha_{y}^{2} = 1 - \\alpha_{z}^{2} $$\nSubstituting this into the expression for $F_{\\text{me}}$:\n$$F_{\\text{me}} = B_{1}\\epsilon((1 - \\alpha_{z}^{2}) - 2\\nu\\alpha_{z}^{2})$$\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu)\\alpha_{z}^{2})$$\nThe problem defines $\\theta$ as the angle between the magnetization vector and the film normal (the $z$-axis). The direction cosine $\\alpha_{z}$ is therefore related to $\\theta$ by:\n$$ \\alpha_{z} = \\cos\\theta $$\nSubstituting this relationship into the energy expression:\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu)\\cos^{2}\\theta)$$\nThe problem requires the final energy expression to be in the form $F_{\\text{me}} = K_{\\text{me}}\\sin^{2}\\theta + \\text{const}$. To achieve this, we use the trigonometric identity $\\cos^{2}\\theta = 1 - \\sin^{2}\\theta$:\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu)(1 - \\sin^{2}\\theta))$$\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu) + (1 + 2\\nu)\\sin^{2}\\theta)$$\n$$F_{\\text{me}} = B_{1}\\epsilon(-2\\nu + (1 + 2\\nu)\\sin^{2}\\theta)$$\nDistributing the leading factor $B_{1}\\epsilon$:\n$$F_{\\text{me}} = B_{1}\\epsilon(1 + 2\\nu)\\sin^{2}\\theta - 2\\nu B_{1}\\epsilon$$\nThis expression is now in the desired uniaxial form $F_{\\text{me}} = K_{\\text{me}}\\sin^{2}\\theta + \\text{const}$, where the constant term is independent of $\\theta$. By comparing the two forms, we can identify the effective uniaxial anisotropy constant $K_{\\text{me}}$ as the coefficient of the $\\sin^{2}\\theta$ term.\n\nTherefore, the effective magnetoelastic anisotropy constant is:\n$$ K_{\\text{me}} = B_{1}\\epsilon(1 + 2\\nu) $$\nThe constant offset is $\\text{const} = -2\\nu B_{1}\\epsilon$. The problem asks only for the expression for $K_{\\text{me}}$.", "answer": "$$\n\\boxed{B_{1}\\epsilon(1 + 2\\nu)}\n$$", "id": "3002883"}, {"introduction": "To predict the complex behavior of magnetic domains and dynamics, we turn to computational modeling governed by the Landau-Lifshitz-Gilbert (LLG) equation. This problem guides you through the foundational steps of setting up a micromagnetic simulation, from discretizing the LLG equation to analyzing its numerical stability [@problem_id:3002841]. This practice is essential for anyone aiming to use or develop computational tools to investigate the rich dynamics of magnetic systems.", "problem": "You are asked to design a finite-difference time-domain computation for the magnetization dynamics in a one-dimensional ferromagnetic film with cubic magnetocrystalline anisotropy. The evolution is governed by the Landau-Lifshitz-Gilbert (LLG) equation, with the magnetization unit vector field denoted by $m(x,t) = \\left(m_x,m_y,m_z\\right)$, and effective field $H_{\\mathrm{eff}}(x,t)$ derived from the total micromagnetic energy density. Your task is to start from fundamental definitions, construct an explicit finite-difference spatial discretization and a forward-Euler time-stepping scheme, and then determine a stability constraint on the timestep using a linear stability analysis about a uniform easy-axis state. The analysis must be based on:\n\n- The Landau-Lifshitz-Gilbert (LLG) equation in its standard micromagnetic form with $H_{\\mathrm{eff}}$ measured in ampere per meter, and gyromagnetic constant $\\gamma_0$ measured in second$^{-1}$ meter per ampere:\n  $$\\frac{\\partial m}{\\partial t} = - \\gamma_0\\, m \\times H_{\\mathrm{eff}} + \\alpha\\, m \\times \\frac{\\partial m}{\\partial t},$$\n  where $\\alpha$ is the dimensionless Gilbert damping parameter and $|m| = 1$.\n\n- The exchange energy density,\n  $$E_{\\mathrm{ex}} = A\\, |\\nabla m|^2,$$\n  where $A$ is the exchange stiffness (in joule per meter).\n\n- The cubic magnetocrystalline anisotropy energy density,\n  $$E_{\\mathrm{cub}} = K_1 \\left(m_x^2 m_y^2 + m_y^2 m_z^2 + m_z^2 m_x^2\\right),$$\n  where $K_1$ is the first-order cubic anisotropy constant (in joule per meter cubed).\n\n- The effective field obtained from variational differentiation of the energy,\n  $$H_{\\mathrm{eff}} = -\\frac{1}{\\mu_0 M_s}\\, \\frac{\\delta E}{\\delta m},$$\n  where $\\mu_0$ is the vacuum permeability (in henry per meter) and $M_s$ is the saturation magnetization (in ampere per meter).\n\nPerform the following:\n\n1. Derive a consistent one-dimensional central-difference discretization for the exchange term and compute its discrete Laplacian eigenvalue bound on a uniform grid with spacing $\\Delta x$. Derive the explicit forward-Euler time-stepping update for $m_j^n \\approx m(x_j, t_n)$, and specify any normalization step needed to enforce $|m_j^{n+1}|=1$.\n\n2. Linearize your discrete scheme about a uniform easy-axis equilibrium $m_0 = (1,0,0)$, retaining leading-order terms in small transverse components. Use this linearization to determine a bound on the highest precessional frequency supported by the discrete system as a function of material parameters and grid spacing.\n\n3. From the linearized discrete dynamics, derive a sufficient stability condition for the explicit Euler method in terms of a maximum allowed timestep $\\Delta t_{\\max}$ expressed using physical parameters $A$, $K_1$, $M_s$, $\\mu_0$, $\\gamma_0$, and the grid spacing $\\Delta x$. Clearly state all assumptions used in the derivation. Your stability condition must be expressed in seconds.\n\n4. Implement a program that, for each test case below, computes the corresponding $\\Delta t_{\\max}$ and returns a boolean stating whether a given $\\Delta t$ satisfies your stability constraint. All quantities must be treated in the International System of Units (SI): $A$ in joule per meter, $K_1$ in joule per meter cubed, $M_s$ in ampere per meter, $\\mu_0$ in henry per meter, $\\gamma_0$ in second$^{-1}$ meter per ampere, $\\Delta x$ in meter, and $\\Delta t$ in second. The angle unit is not needed because the output is purely numerical in SI units.\n\n5. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-entry list of the form $[\\Delta t_{\\max}, \\mathrm{is\\_stable}]$. The first entry is a floating-point number in seconds, and the second entry is a boolean, with the stability predicate defined as $\\Delta t \\le \\Delta t_{\\max}$.\n\nUse the following test suite, which probes a variety of regimes. For each case, use $\\mu_0 = 4\\pi \\times 10^{-7}$ and $\\gamma_0 = 2.211 \\times 10^{5}$. The parameters are:\n\n- Case 1 (general, exchange-dominated grid, happy path): $A = 1.3 \\times 10^{-11}$, $K_1 = 4.8 \\times 10^{4}$, $M_s = 8.0 \\times 10^{5}$, $\\Delta x = 2.0 \\times 10^{-9}$, $\\alpha = 2.0 \\times 10^{-2}$, and test $\\Delta t = 1.0 \\times 10^{-15}$.\n\n- Case 2 (near-stability boundary, slightly inside): $A = 1.3 \\times 10^{-11}$, $K_1 = 4.8 \\times 10^{4}$, $M_s = 8.0 \\times 10^{5}$, $\\Delta x = 2.0 \\times 10^{-9}$, $\\alpha = 2.0 \\times 10^{-2}$, and test $\\Delta t = 6.9 \\times 10^{-15}$.\n\n- Case 3 (vanishing damping, instability expected): $A = 1.3 \\times 10^{-11}$, $K_1 = 4.8 \\times 10^{4}$, $M_s = 8.0 \\times 10^{5}$, $\\Delta x = 2.0 \\times 10^{-9}$, $\\alpha = 1.0 \\times 10^{-6}$, and test $\\Delta t = 1.0 \\times 10^{-15}$.\n\n- Case 4 (very fine grid, exchange-dominated instability): $A = 1.3 \\times 10^{-11}$, $K_1 = 4.8 \\times 10^{4}$, $M_s = 8.0 \\times 10^{5}$, $\\Delta x = 5.0 \\times 10^{-10}$, $\\alpha = 2.0 \\times 10^{-2}$, and test $\\Delta t = 1.0 \\times 10^{-15}$.\n\n- Case 5 (no exchange, anisotropy-dominated): $A = 0$, $K_1 = 2.0 \\times 10^{5}$, $M_s = 1.0 \\times 10^{6}$, $\\Delta x = 1.0 \\times 10^{-9}$, $\\alpha = 1.0 \\times 10^{-1}$, and test $\\Delta t = 2.0 \\times 10^{-12}$.\n\n- Case 6 (negative cubic anisotropy, typical iron-like sign): $A = 2.1 \\times 10^{-11}$, $K_1 = -1.0 \\times 10^{5}$, $M_s = 1.7 \\times 10^{6}$, $\\Delta x = 1.0 \\times 10^{-9}$, $\\alpha = 2.0 \\times 10^{-2}$, and test $\\Delta t = 2.0 \\times 10^{-15}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example: $[[\\Delta t_{\\max,1}, \\mathrm{is\\_stable}_1],[\\Delta t_{\\max,2}, \\mathrm{is\\_stable}_2],\\dots]$.", "solution": "The problem requires the derivation of a numerical stability condition for a finite-difference time-domain (FDTD) simulation of the one-dimensional Landau-Lifshitz-Gilbert (LLG) equation with cubic anisotropy. The solution proceeds in several steps: formalizing the equations of motion, discretizing them in space and time, linearizing the discrete system around an equilibrium state, and finally performing a von Neumann stability analysis to find the maximum stable timestep $\\Delta t_{\\max}$.\n\nFirst, we state the given Landau-Lifshitz-Gilbert (LLG) equation in Gilbert form:\n$$ \\frac{\\partial m}{\\partial t} = - \\gamma_0\\, m \\times H_{\\mathrm{eff}} + \\alpha\\, m \\times \\frac{\\partial m}{\\partial t} $$\nwhere $m$ is the normalized magnetization vector ($|m|=1$), $\\gamma_0$ is the gyromagnetic constant, $\\alpha$ is the Gilbert damping parameter, and $H_{\\mathrm{eff}}$ is the effective magnetic field. This equation can be rearranged into the equivalent Landau-Lifshitz (LL) form, which is more convenient for analysis:\n$$ \\frac{\\partial m}{\\partial t} = - \\frac{\\gamma_0}{1+\\alpha^2} \\left( m \\times H_{\\mathrm{eff}} \\right) - \\frac{\\alpha \\gamma_0}{1+\\alpha^2} \\left( m \\times (m \\times H_{\\mathrm{eff}}) \\right) $$\n\nThe effective field $H_{\\mathrm{eff}}$ is derived from the total energy density $E = E_{\\mathrm{ex}} + E_{\\mathrm{cub}}$ via the variational derivative:\n$$ H_{\\mathrm{eff}} = -\\frac{1}{\\mu_0 M_s} \\frac{\\delta E}{\\delta m} $$\nThe energy density terms are the exchange energy $E_{\\mathrm{ex}} = A |\\nabla m|^2$ and the cubic anisotropy energy $E_{\\mathrm{cub}} = K_1 (m_x^2 m_y^2 + m_y^2 m_z^2 + m_z^2 m_x^2)$. The corresponding contributions to the effective field are:\n$$ H_{\\mathrm{eff, ex}} = -\\frac{1}{\\mu_0 M_s} \\frac{\\delta E_{\\mathrm{ex}}}{\\delta m} = \\frac{2A}{\\mu_0 M_s} \\nabla^2 m $$\n$$ H_{\\mathrm{eff, cub}} = -\\frac{1}{\\mu_0 M_s} \\frac{\\delta E_{\\mathrm{cub}}}{\\delta m} = -\\frac{2K_1}{\\mu_0 M_s} \\begin{pmatrix} m_x(1-m_x^2) \\\\ m_y(1-m_y^2) \\\\ m_z(1-m_z^2) \\end{pmatrix} $$\nThus, the total effective field is $H_{\\mathrm{eff}} = H_{\\mathrm{eff, ex}} + H_{\\mathrm{eff, cub}}$.\n\nFor the FDTD scheme, we discretize the 1D space onto a grid with points $x_j = j \\Delta x$. The second spatial derivative (Laplacian) is approximated using a second-order central difference:\n$$ (\\nabla^2 m)_j \\approx \\frac{m_{j+1} - 2m_j + m_{j-1}}{(\\Delta x)^2} $$\nFor a plane wave mode $m_j \\propto e^{ikx_j}$, the eigenvalue of this discrete Laplacian is $\\lambda_k = -\\frac{4}{(\\Delta x)^2}\\sin^2(\\frac{k\\Delta x}{2})$. The eigenvalue with the largest magnitude occurs at the highest spatial frequency (Nyquist frequency) $k_{\\max}=\\pi/\\Delta x$, which gives $\\lambda_{k_{\\max}} = -4/(\\Delta x)^2$.\n\nThe time evolution is discretized using the explicit forward Euler method:\n$$ \\frac{m_j^{n+1} - m_j^n}{\\Delta t} = \\left(\\frac{\\partial m}{\\partial t}\\right)_j^n $$\n$$ m_j^{*,n+1} = m_j^n + \\Delta t \\left(\\frac{\\partial m}{\\partial t}\\right)_j^n $$\nwhere the RHS is evaluated using the LL form with the discretized effective field at time step $n$. Since this update does not preserve the unit length of $m$, a normalization step is required: $m_j^{n+1} = m_j^{*,n+1} / |m_j^{*,n+1}|$.\n\nTo analyze the numerical stability, we linearize the system around the uniform equilibrium state $m_0 = (1,0,0)$. Let $m = (1, m_y, m_z)$, where $m_y$ and $m_z$ are small transverse perturbations. To first order, $m_x \\approx 1$. The effective field linearizes to $H_{\\mathrm{eff}} \\approx (0, \\mathcal{L}m_y, \\mathcal{L}m_z)$, where $\\mathcal{L}$ is a linear operator:\n$$ \\mathcal{L}m_p = \\frac{2A}{\\mu_0 M_s} \\nabla^2 m_p - \\frac{2K_1}{\\mu_0 M_s} m_p, \\quad p \\in \\{y,z\\} $$\nSubstituting this into the LL equation and retaining only first-order terms in $m_y$ and $m_z$, we obtain a linear system for the transverse components:\n$$ \\frac{\\partial}{\\partial t} \\begin{pmatrix} m_y \\\\ m_z \\end{pmatrix} = -\\frac{\\gamma_0}{1+\\alpha^2} \\begin{pmatrix} \\alpha(-\\mathcal{L}) & -(-\\mathcal{L}) \\\\ -\\mathcal{L} & \\alpha(-\\mathcal{L}) \\end{pmatrix} \\begin{pmatrix} m_y \\\\ m_z \\end{pmatrix} = \\frac{\\gamma_0 \\mathcal{L}}{1+\\alpha^2} \\begin{pmatrix} \\alpha & 1 \\\\ -1 & \\alpha \\end{pmatrix} \\begin{pmatrix} m_y \\\\ m_z \\end{pmatrix} $$\nIn the spatial Fourier domain (von Neumann analysis), the operator $\\mathcal{L}$ becomes a scalar eigenvalue $L_k$ for each wavevector $k$:\n$$ L_k = \\frac{2A}{\\mu_0 M_s}\\left(-\\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2}\\right) - \\frac{2K_1}{\\mu_0 M_s} = -\\frac{2}{\\mu_0 M_s}\\left(\\frac{4A\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} + K_1\\right) $$\nThe eigenvalues of the time-evolution matrix are then $\\Omega_k = \\frac{\\gamma_0 L_k}{1+\\alpha^2}(\\alpha \\pm i)$.\n\nFor the forward Euler method to be stable, the amplification factor for every mode must have a magnitude no greater than $1$. That is, $|1 + \\Delta t \\Omega_k| \\le 1$ for all $k$. This inequality describes a circle of radius $1$ centered at $(-1,0)$ in the complex plane. The condition is equivalent to $2 \\mathrm{Re}(\\Delta t \\Omega_k) + |\\Delta t \\Omega_k|^2 \\le 0$. Since $\\Delta t > 0$, this simplifies to:\n$$ \\Delta t \\le -\\frac{2 \\mathrm{Re}(\\Omega_k)}{|\\Omega_k|^2} $$\nThe real part and squared modulus of $\\Omega_k$ are:\n$$ \\mathrm{Re}(\\Omega_k) = \\frac{\\gamma_0 L_k \\alpha}{1+\\alpha^2} $$\n$$ |\\Omega_k|^2 = \\frac{(\\gamma_0 L_k)^2(\\alpha^2+1)}{(1+\\alpha^2)^2} = \\frac{(\\gamma_0 L_k)^2}{1+\\alpha^2} $$\nSubstituting these gives the condition for each mode:\n$$ \\Delta t \\le -\\frac{2 \\left(\\frac{\\gamma_0 L_k \\alpha}{1+\\alpha^2}\\right)}{\\frac{(\\gamma_0 L_k)^2}{1+\\alpha^2}} = -\\frac{2\\alpha}{\\gamma_0 L_k} $$\nFor physical stability of the equilibrium, we require that the real part of the physical system's eigenvalues be non-positive. For $m_0=(1,0,0)$ to be a stable equilibrium (easy axis), $K_1$ should be positive. In this case, $L_k$ is always negative. If $K_1<0$, $m_0$ is a saddle point, unstable to long-wavelength perturbations. However, the numerical stability is determined by the mode with the largest rate, which can be either a decay rate or a growth rate.\nThe stability constraint must hold for all $k$, so we must use the most restrictive case, which corresponds to the largest value of $|\\Omega_k|$. This occurs when $|L_k|$ is maximal. We must find the maximum of $|L_k|$ over $k \\in [0, \\pi/\\Delta x]$.\n$$ |L_k| = \\frac{2}{\\mu_0 M_s} \\left| \\frac{4A\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} + K_1 \\right| $$\nThe term dependent on $k$ is monotonic, so the maximum of $|L_k|$ must occur at the boundaries of the $k$ domain, $k=0$ or $k=\\pi/\\Delta x$.\n$$ |L_{k=0}| = \\frac{2|K_1|}{\\mu_0 M_s} $$\n$$ |L_{k=\\pi/\\Delta x}| = \\frac{2}{\\mu_0 M_s} \\left| \\frac{4A}{(\\Delta x)^2} + K_1 \\right| $$\nLet $|L_{\\max}| = \\max(|L_{k=0}|, |L_{k=\\pi/\\Delta x}|)$. The stability condition becomes $\\Delta t \\le \\frac{2\\alpha}{\\gamma_0 |L_{\\max}|}$.\nThus, the maximum allowed time step is:\n$$ \\Delta t_{\\max} = \\frac{2\\alpha}{\\gamma_0 |L_{\\max}|} = \\frac{2\\alpha}{\\gamma_0 \\frac{2}{\\mu_0 M_s} \\max\\left(|K_1|, \\left|\\frac{4A}{(\\Delta x)^2} + K_1\\right|\\right)} = \\frac{\\alpha \\mu_0 M_s}{\\gamma_0 \\max\\left(|K_1|, \\left|\\frac{4A}{(\\Delta x)^2} + K_1\\right|\\right)} $$\nThis is the final expression used for computation.\nNote the assumptions: linearization about $m_0=(1,0,0)$, central difference spatial discretization, forward Euler time integration, and periodic boundary conditions (implicit in the Fourier analysis). We test stability against all modes, including physically unstable ones when $K_1 < 0$, as these fast-growing modes also constrain the numerical timestep.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum stable timestep in a 1D FDTD micromagnetic simulation.\n    \"\"\"\n    \n    # Define physical constants.\n    MU_0 = 4 * np.pi * 1e-7  # Vacuum permeability in H/m\n    GAMMA_0 = 2.211e5        # Gyromagnetic constant in m/(A*s)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (A, K1, Ms, dx, alpha, dt_test)\n        (1.3e-11, 4.8e4, 8.0e5, 2.0e-9, 2.0e-2, 1.0e-15),\n        # Case 2:\n        (1.3e-11, 4.8e4, 8.0e5, 2.0e-9, 2.0e-2, 6.9e-15),\n        # Case 3:\n        (1.3e-11, 4.8e4, 8.0e5, 2.0e-9, 1.0e-6, 1.0e-15),\n        # Case 4:\n        (1.3e-11, 4.8e4, 8.0e5, 5.0e-10, 2.0e-2, 1.0e-15),\n        # Case 5:\n        (0.0, 2.0e5, 1.0e6, 1.0e-9, 1.0e-1, 2.0e-12),\n        # Case 6:\n        (2.1e-11, -1.0e5, 1.7e6, 1.0e-9, 2.0e-2, 2.0e-15),\n    ]\n\n    results = []\n    for params in test_cases:\n        A, K1, Ms, dx, alpha, dt_test = params\n        \n        # Calculate the maximum eigenvalue of the discrete spatial operator.\n        # This determines the highest frequency/rate in the system.\n        \n        # Contribution from anisotropy term alone (corresponds to k=0 mode).\n        # This is |K1|.\n        L_term1 = abs(K1)\n        \n        # Contribution from exchange and anisotropy (corresponds to k=pi/dx mode).\n        # This is |4A/dx^2 + K1|.\n        exchange_term_max = 4 * A / (dx**2)\n        L_term2 = abs(exchange_term_max + K1)\n        \n        # The maximum value that drives the stability limit.\n        max_L_term = max(L_term1, L_term2)\n        \n        # The stability condition for explicit Euler applied to the LLG equation is:\n        # dt_max = (alpha * mu_0 * Ms) / (gamma_0 * max(|K1|, |4A/dx^2 + K1|))\n        \n        numerator = alpha * MU_0 * Ms\n        denominator = GAMMA_0 * max_L_term\n        \n        # Handle the case where the denominator is zero (e.g., A=0, K1=0).\n        # This would correspond to a free spin, no fields, dt_max is infinite.\n        if denominator == 0:\n            dt_max = float('inf')\n        else:\n            dt_max = numerator / denominator\n\n        # Check if the given timestep is stable.\n        is_stable = dt_test <= dt_max\n        \n        results.append([dt_max, is_stable])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3002841"}]}