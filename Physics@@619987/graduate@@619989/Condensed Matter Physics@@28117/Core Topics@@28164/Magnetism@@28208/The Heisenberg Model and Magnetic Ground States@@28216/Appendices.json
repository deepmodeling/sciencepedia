{"hands_on_practices": [{"introduction": "We begin our exploration with the simplest possible interacting spin system: a dimer of two spin-$\\frac{1}{2}$ moments. This \"hydrogen atom\" of magnetism allows for an exact diagonalization of the Heisenberg Hamiltonian, providing a clear, first-principles understanding of how exchange interactions lead to a splitting between singlet and triplet states. This exercise [@problem_id:3012185] demonstrates how to connect a microscopic model parameter, the exchange constant $J$, to a macroscopic experimental measurement from inelastic neutron scattering.", "problem": "Consider a dimer of two localized spin-$\\frac{1}{2}$ moments in a quasi-one-dimensional magnetic insulator, well separated from other dimers so that interdimer couplings are negligible on the energy scale of the intradimer exchange. The low-energy magnetic interactions are isotropic and described by the Heisenberg Hamiltonian $\\hat{H} = J \\,\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}$, where $J$ is the exchange constant and $\\mathbf{S}_{i}$ are dimensionless spin operators appropriate to lattice spin models. Assume rotational invariance in spin space. Starting from fundamental angular momentum addition in quantum mechanics, use the total spin construction to diagonalize $\\hat{H}$ and determine the energies of the singlet and triplet eigenstates as functions of $J$. \n\nAn experiment using Inelastic Neutron Scattering (INS) detects a single gapped magnetic mode that is threefold degenerate, arising from a nondegenerate ground state. The energy transfer of this mode from the ground state is measured to be $2.947$ meV. Using the splitting and degeneracy information, infer the sign of $J$ and compute $J$. Round your final numerical answer to four significant figures and express it in meV. Output only the value of $J$ (with its sign) as your final answer.", "solution": "The system consists of two localized spin-$\\frac{1}{2}$ moments, described by the isotropic Heisenberg Hamiltonian:\n$$\n\\hat{H} = J \\,\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}\n$$\nHere, $J$ is the exchange constant and $\\mathbf{S}_{1}$ and $\\mathbf{S}_{2}$ are dimensionless spin-$\\frac{1}{2}$ operators. To diagonalize this Hamiltonian, we employ the total spin construction. The total spin operator $\\mathbf{S}$ is defined as the vector sum of the individual spin operators:\n$$\n\\mathbf{S} = \\mathbf{S}_{1} + \\mathbf{S}_{2}\n$$\nBy squaring the total spin operator, we obtain:\n$$\n\\mathbf{S}^2 = (\\mathbf{S}_{1} + \\mathbf{S}_{2}) \\cdot (\\mathbf{S}_{1} + \\mathbf{S}_{2}) = \\mathbf{S}_{1}^2 + \\mathbf{S}_{2}^2 + 2\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}\n$$\nFrom this relation, we can express the interaction term $\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2}$ in terms of the squared spin operators, whose eigenvalues are known in the total spin basis.\n$$\n\\mathbf{S}_{1}\\cdot\\mathbf{S}_{2} = \\frac{1}{2} (\\mathbf{S}^2 - \\mathbf{S}_{1}^2 - \\mathbf{S}_{2}^2)\n$$\nSubstituting this back into the Hamiltonian gives:\n$$\n\\hat{H} = \\frac{J}{2} (\\mathbf{S}^2 - \\mathbf{S}_{1}^2 - \\mathbf{S}_{2}^2)\n$$\nThis form of the Hamiltonian is diagonal in the basis of eigenstates of the total spin, denoted by $|s, m_s\\rangle$, where $s$ is the total spin quantum number and $m_s$ is its projection. For a given state $|s, s_1, s_2\\rangle$, the eigenvalues of the squared spin operators are $s(s+1)$, $s_1(s_1+1)$, and $s_2(s_2+1)$, as the operators are dimensionless (i.e., in units where $\\hbar=1$).\n\nFor two spin-$\\frac{1}{2}$ particles, we have $s_1 = \\frac{1}{2}$ and $s_2 = \\frac{1}{2}$. The rules of angular momentum addition allow for total spin quantum numbers $s$ ranging from $|s_1 - s_2|$ to $s_1 + s_2$. Thus, the possible values are:\n$$\ns \\in \\left\\{ \\left|\\frac{1}{2} - \\frac{1}{2}\\right|, \\dots, \\frac{1}{2} + \\frac{1}{2} \\right\\} \\implies s \\in \\{0, 1\\}\n$$\nThese two values of $s$ correspond to two distinct energy levels:\n1.  The **singlet** state, with $s=0$. This state is nondegenerate, as its multiplicity is $2s+1 = 2(0)+1=1$.\n2.  The **triplet** state, with $s=1$. This state is threefold degenerate, as its multiplicity is $2s+1 = 2(1)+1=3$.\n\nWe now calculate the energy eigenvalues for each of these states. The eigenvalues for $\\mathbf{S}_1^2$ and $\\mathbf{S}_2^2$ are identical for both states: $s_1(s_1+1) = s_2(s_2+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$.\n\nFor the singlet state ($s=0$):\nThe eigenvalue of $\\mathbf{S}^2$ is $s(s+1) = 0(0+1) = 0$.\nThe energy of the singlet state, $E_S$, is:\n$$\nE_S = \\frac{J}{2} \\left(0 - \\frac{3}{4} - \\frac{3}{4}\\right) = \\frac{J}{2} \\left(-\\frac{3}{2}\\right) = -\\frac{3}{4}J\n$$\n\nFor the triplet state ($s=1$):\nThe eigenvalue of $\\mathbf{S}^2$ is $s(s+1) = 1(1+1) = 2$.\nThe energy of the triplet state, $E_T$, is:\n$$\nE_T = \\frac{J}{2} \\left(2 - \\frac{3}{4} - \\frac{3}{4}\\right) = \\frac{J}{2} \\left(2 - \\frac{3}{2}\\right) = \\frac{J}{2} \\left(\\frac{1}{2}\\right) = +\\frac{1}{4}J\n$$\n\nThe experimental results from Inelastic Neutron Scattering (INS) provide crucial information. A single magnetic mode is observed, corresponding to an excitation from a **nondegenerate ground state** to a **threefold degenerate excited state**. Our analysis shows that the singlet state ($s=0$) is nondegenerate and the triplet state ($s=1$) is threefold degenerate. Therefore, the experiment observes a transition from the singlet to the triplet (or vice versa). For the singlet to be the ground state, its energy must be lower than the triplet's energy:\n$$\nE_S < E_T \\implies -\\frac{3}{4}J < \\frac{1}{4}J\n$$\nAdding $\\frac{3}{4}J$ to both sides of the inequality gives:\n$$\n0 < \\frac{1}{4}J + \\frac{3}{4}J \\implies 0 < J\n$$\nThis implies that the exchange constant $J$ must be positive ($J>0$), which corresponds to an antiferromagnetic interaction. The nondegenerate ground state is the singlet, and the threefold degenerate excited state is the triplet.\n\nThe energy transfer, $\\Delta E$, measured in the INS experiment is the energy difference between the excited state and the ground state:\n$$\n\\Delta E = E_{\\text{excited}} - E_{\\text{ground}} = E_T - E_S\n$$\nSubstituting the expressions for the energies:\n$$\n\\Delta E = \\left(\\frac{1}{4}J\\right) - \\left(-\\frac{3}{4}J\\right) = \\frac{1}{4}J + \\frac{3}{4}J = J\n$$\nThe problem states that the measured energy transfer is $\\Delta E = 2.947$ meV. Therefore, we can directly equate this to the exchange constant $J$:\n$$\nJ = 2.947 \\, \\text{meV}\n$$\nThe sign of $J$ is positive, as inferred from the state degeneracies. The value is already given to four significant figures.", "answer": "$$\n\\boxed{2.947}\n$$", "id": "3012185"}, {"introduction": "Moving from a single dimer to a macroscopic lattice, we next examine the ground state of a three-dimensional Heisenberg ferromagnet. This practice [@problem_id:2865507] explores a fundamental property: the fully polarized state is an exact eigenstate of the ferromagnetic Hamiltonian, a feature with profound consequences. You will use spin-wave theory to understand why, to leading order, quantum fluctuations do not reduce the ordered moment at zero temperature, providing a crucial contrast to the behavior of antiferromagnets.", "problem": "Consider an isotropic quantum Heisenberg ferromagnet on a three-dimensional Bravais lattice with nearest-neighbor exchange interaction and spin magnitude $S=\\frac{1}{2}$ at each site. The Hamiltonian is\n$$\n\\hat{H} \\;=\\; -J \\sum_{\\langle i j \\rangle} \\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j}, \\qquad J>0,\n$$\nwith $\\langle i j \\rangle$ denoting nearest neighbors. The LandÃ© factor is $g=2$, and the Bohr magneton is $\\mu_{B}$. Assume an infinitesimal uniform magnetic field along the $+\\hat{z}$ direction is applied and then taken to zero to select the ordered direction. Starting only from fundamental commutation relations of spin operators and the structure of the Heisenberg Hamiltonian, determine the zero-temperature spontaneous magnetization per site $M_{s}(0)$ and justify, to leading order in the $1/S$ expansion, why quantum fluctuations do not reduce $M_{s}(0)$ in three dimensions.\n\nYour answer must include:\n- A first-principles argument for the identity of the ground state of the ferromagnetic Heisenberg model and the evaluation of $M_{s}(0)$ from it.\n- A spin-wave-theory-based explanation (to leading order in $1/S$) for the absence of zero-point reduction of $M_{s}(0)$ in the ferromagnet, explicitly contrasting the structure of the quadratic bosonic Hamiltonian with that of systems where such a reduction occurs.\n\nExpress the final magnetization per site in units of the Bohr magneton $\\mu_{B}$ as a pure number. No rounding is required.", "solution": "The solution proceeds in two parts. First, we identify the exact ground state of the Hamiltonian and calculate the spontaneous magnetization from it. Second, we use spin-wave theory to analyze the role of quantum fluctuations.\n\nPart 1: Ground State and Spontaneous Magnetization\n\nThe Hamiltonian for the system is given by $\\hat{H} = -J \\sum_{\\langle i j \\rangle} \\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j}$, where $J>0$ indicates a ferromagnetic interaction. To find the ground state, we seek the state that minimizes the energy. This is equivalent to maximizing the value of each term $\\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j}$ for every nearest-neighbor pair $\\langle i j \\rangle$.\n\nLet us consider the fully polarized ferromagnetic state, $|\\text{FM}\\rangle$, where all spins are aligned in the $+\\hat{z}$ direction, as selected by the infinitesimal external field. In this state, every spin has its maximum projection along the $z$-axis, i.e., $\\hat{S}^z_i |\\text{FM}\\rangle = S |\\text{FM}\\rangle$ for all sites $i$. For the given problem, $S=\\frac{1}{2}$.\n\nWe will demonstrate that $|\\text{FM}\\rangle$ is an exact eigenstate of the Hamiltonian $\\hat{H}$. We expand the dot product:\n$$\n\\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j} = \\hat{S}^z_i \\hat{S}^z_j + \\frac{1}{2}(\\hat{S}^+_i \\hat{S}^-_j + \\hat{S}^-_i \\hat{S}^+_j)\n$$\nwhere $\\hat{S}^{\\pm}_i = \\hat{S}^x_i \\pm i\\hat{S}^y_i$ are the spin ladder operators. The raising operator $\\hat{S}^+_i$ annihilates a state where the spin $i$ is maximally polarized up: $\\hat{S}^+_i |\\text{FM}\\rangle = 0$. Consequently, for any pair $\\langle i j \\rangle$, the term $\\hat{S}^-_i \\hat{S}^+_j$ acting on $|\\text{FM}\\rangle$ yields zero:\n$$\n\\hat{S}^-_i \\hat{S}^+_j |\\text{FM}\\rangle = \\hat{S}^-_i (0) = 0\n$$\nThe term $\\hat{S}^+_i \\hat{S}^-_j$ also gives zero because the sum is over nearest neighbors, meaning $i \\neq j$. The operator $\\hat{S}^-_j$ flips the spin at site $j$, creating a state orthogonal to $|\\text{FM}\\rangle$. The subsequent operator $\\hat{S}^+_i$ acts on spin $i$, which is still in the state $|S, S\\rangle$, and thus annihilates it. Therefore, $\\hat{S}^+_i \\hat{S}^-_j |\\text{FM}\\rangle = 0$ for $i \\neq j$.\n\nOnly the $\\hat{S}^z_i \\hat{S}^z_j$ term contributes. Applying the Hamiltonian to $|\\text{FM}\\rangle$:\n$$\n\\hat{H} |\\text{FM}\\rangle = -J \\sum_{\\langle i j \\rangle} \\hat{S}^z_i \\hat{S}^z_j |\\text{FM}\\rangle = -J \\sum_{\\langle i j \\rangle} (S \\cdot S) |\\text{FM}\\rangle = -J S^2 \\sum_{\\langle i j \\rangle} 1 \\cdot |\\text{FM}\\rangle\n$$\nIf there are $N$ sites and the coordination number is $z$, the number of nearest-neighbor pairs is $\\frac{Nz}{2}$. The energy of this state is $E_0 = -J S^2 \\frac{Nz}{2}$. Since the maximum possible eigenvalue of $\\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j}$ for a pair of spins is $S^2$ (achieved when they are parallel), and $|\\text{FM}\\rangle$ is the state in which all pairs achieve this maximum simultaneously, it must be the ground state.\n\nThe zero-temperature spontaneous magnetization per site, $M_s(0)$, is the expectation value of the magnetization operator per site, $\\hat{M}_z = \\frac{1}{N} \\sum_i g \\mu_B \\hat{S}^z_i$, in the ground state:\n$$\nM_s(0) = \\langle \\text{FM} | \\hat{M}_z | \\text{FM} \\rangle = \\frac{g \\mu_B}{N} \\sum_i \\langle \\text{FM} | \\hat{S}^z_i | \\text{FM} \\rangle\n$$\nSince $\\hat{S}^z_i |\\text{FM}\\rangle = S |\\text{FM}\\rangle$ for all $i$:\n$$\nM_s(0) = \\frac{g \\mu_B}{N} \\sum_i S = \\frac{g \\mu_B}{N} (NS) = g \\mu_B S\n$$\nSubstituting the given values $g=2$ and $S=\\frac{1}{2}$:\n$$\nM_s(0) = (2) \\mu_B \\left(\\frac{1}{2}\\right) = \\mu_B\n$$\nThe magnetization per site, in units of $\\mu_B$, is $1$.\n\nPart 2: Justification via Spin-Wave Theory\n\nQuantum fluctuations can, in principle, reduce the ordered moment from its classical value. We analyze this using linear spin-wave theory, which is the leading order in a $\\frac{1}{S}$ expansion. We introduce bosonic operators via the Holstein-Primakoff transformation, expanding around the fully polarized ferromagnetic ground state:\n$$\n\\hat{S}^z_i = S - a_i^\\dagger a_i\n$$\n$$\n\\hat{S}^+_i = \\sqrt{2S} \\sqrt{1 - \\frac{a_i^\\dagger a_i}{2S}} a_i \\approx \\sqrt{2S} a_i\n$$\n$$\n\\hat{S}^-_i = \\sqrt{2S} a_i^\\dagger \\sqrt{1 - \\frac{a_i^\\dagger a_i}{2S}} \\approx \\sqrt{2S} a_i^\\dagger\n$$\nwhere $a_i$ and $a_i^\\dagger$ are bosonic annihilation and creation operators at site $i$. The operator $a_i^\\dagger a_i$ counts the number of spin deviations (magnons) at site $i$.\n\nSubstituting these into the Hamiltonian and keeping terms up to quadratic order in the operators:\n$$\n\\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j} \\approx (S - a_i^\\dagger a_i)(S - a_j^\\dagger a_j) + \\frac{1}{2}((\\sqrt{2S}a_i)(\\sqrt{2S}a_j^\\dagger) + (\\sqrt{2S}a_i^\\dagger)(\\sqrt{2S}a_j))\n$$\n$$\n\\approx S^2 - S(a_i^\\dagger a_i + a_j^\\dagger a_j) + S(a_i a_j^\\dagger + a_i^\\dagger a_j)\n$$\nSince $i \\neq j$ for nearest neighbors, $[a_i, a_j^\\dagger] = 0$. We can rewrite this as:\n$$\n\\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j} \\approx S^2 - S(a_i^\\dagger a_i + a_j^\\dagger a_j - a_i^\\dagger a_j - a_j^\\dagger a_i) = S^2 - S(a_i^\\dagger - a_j^\\dagger)(a_i - a_j)\n$$\nThe Hamiltonian becomes:\n$$\n\\hat{H} \\approx -J \\sum_{\\langle i j \\rangle} \\left[ S^2 - S(a_i^\\dagger - a_j^\\dagger)(a_i - a_j) \\right] = E_0 + JS \\sum_{\\langle i j \\rangle} (a_i^\\dagger a_i + a_j^\\dagger a_j - a_i^\\dagger a_j - a_j^\\dagger a_i)\n$$\nBy performing a Fourier transform, $a_j = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i \\mathbf{k} \\cdot \\mathbf{r}_j} a_{\\mathbf{k}}$, the quadratic part of the Hamiltonian is diagonalized:\n$$\n\\hat{H}_{SW} = \\sum_{\\mathbf{k}} \\hbar\\omega_{\\mathbf{k}} a_{\\mathbf{k}}^\\dagger a_{\\mathbf{k}}\n$$\nwhere $\\hbar\\omega_{\\mathbf{k}} = JSz(1-\\gamma_{\\mathbf{k}})$ is the magnon dispersion relation, with $z$ being the coordination number and $\\gamma_{\\mathbf{k}} = \\frac{1}{z} \\sum_{\\boldsymbol{\\delta}} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}}$ where $\\boldsymbol{\\delta}$ are the nearest-neighbor vectors.\n\nThe crucial point is that the ferromagnetic spin-wave Hamiltonian is already diagonal in the magnon number operators $a_{\\mathbf{k}}^\\dagger a_{\\mathbf{k}}$. There are no \"anomalous\" terms such as $a_{\\mathbf{k}}a_{-\\mathbf{k}}$ or $a_{\\mathbf{k}}^\\dagger a_{-\\mathbf{k}}^\\dagger$. The ground state of this quadratic Hamiltonian is the magnon vacuum, $|0\\rangle_{SW}$, defined by $a_{\\mathbf{k}} |0\\rangle_{SW} = 0$ for all $\\mathbf{k}$. This corresponds to a state with no spin deviations.\n\nThe reduction in magnetization at $T=0$ is given by the ground-state expectation value of the total number of spin deviations.\n$$\n\\Delta S^z(0) = \\frac{1}{N} \\sum_i \\langle \\hat{S}^z_i \\rangle - S = \\frac{1}{N} \\sum_i \\langle S - a_i^\\dagger a_i \\rangle - S = - \\frac{1}{N} \\sum_i \\langle a_i^\\dagger a_i \\rangle_0\n$$\nThe expectation value is taken in the ground state $|0\\rangle_{SW}$:\n$$\n\\langle a_i^\\dagger a_i \\rangle_0 = \\langle 0 |_{SW} a_i^\\dagger a_i | 0 \\rangle_{SW} = \\langle 0 |_{SW} \\left( \\frac{1}{N} \\sum_{\\mathbf{k}, \\mathbf{k}'} e^{i(\\mathbf{k}-\\mathbf{k}')\\cdot\\mathbf{r}_i} a_{\\mathbf{k}'}^\\dagger a_{\\mathbf{k}} \\right) | 0 \\rangle_{SW} = 0\n$$\nsince $\\langle 0 |_{SW} a_{\\mathbf{k}'}^\\dagger a_{\\mathbf{k}} | 0 \\rangle_{SW} = 0$ for all $\\mathbf{k}, \\mathbf{k}'$. Therefore, $\\Delta S^z(0) = 0$. To the leading order of spin-wave theory, there are no zero-point quantum fluctuations that reduce the spontaneous magnetization. This is a direct consequence of the fact that the fully polarized state is an exact eigenstate of the Hamiltonian.\n\nContrast with Antiferromagnets:\nThe situation is fundamentally different for an antiferromagnet ($J<0$ in our notation, or $J>0$ if $\\hat{H}=+J \\sum \\hat{\\mathbf{S}}_{i}\\cdot \\hat{\\mathbf{S}}_{j}$). The classical ground state is the NÃ©el state (e.g., $|\\uparrow\\downarrow\\uparrow\\downarrow \\dots \\rangle$), which is not an eigenstate of the Heisenberg Hamiltonian. Applying the transverse term $\\hat{S}^+_i \\hat{S}^-_j$ to an antiparallel pair flips both spins, changing the state.\nBecause the classical state is not an eigenstate, the true ground state is a quantum superposition containing fluctuations away from the perfect NÃ©el order. In the corresponding spin-wave theory (using two boson species for the two sublattices, $a_{\\mathbf{k}}$ and $b_{\\mathbf{k}}$), the quadratic Hamiltonian contains anomalous terms of the form $B_{\\mathbf{k}}(a_{\\mathbf{k}}b_{-\\mathbf{k}} + a_{\\mathbf{k}}^\\dagger b_{-\\mathbf{k}}^\\dagger)$, which create and annihilate pairs of magnons. To diagonalize this Hamiltonian, a Bogoliubov transformation is required, which mixes creation and annihilation operators. The resulting true ground state (the Bogoliubov vacuum) contains a finite density of original magnons, i.e., the ground-state expectation value $\\langle a_{\\mathbf{k}}^\\dagger a_{\\mathbf{k}} \\rangle_0 = v_{\\mathbf{k}}^2 \\neq 0$, where $v_{\\mathbf{k}}$ is a Bogoliubov coefficient. This finite occupation at $T=0$ leads to a non-zero reduction of the sublattice magnetization, $\\Delta S^z > 0$.\n\nIn summary, the absence of zero-point reduction in the ferromagnet stems from its ground state being a true eigenstate, which manifests in a spin-wave Hamiltonian that is diagonal in the magnon number operators without the need for a Bogoliubov transformation.", "answer": "$$\n\\boxed{1}\n$$", "id": "2865507"}, {"introduction": "Our final practice introduces the crucial concept of frustration, where competing interactions prevent the formation of a simple, fully ordered ground state. We will analyze the classical $J_1$-$J_2$ Heisenberg model on a square lattice, a canonical model for studying the effects of frustration. This exercise [@problem_id:3019393] combines analytical derivation with computational methods to determine how the ground state evolves from simple ferromagnetic or antiferromagnetic order into complex, incommensurate spiral phases, mirroring techniques used at the forefront of condensed matter research.", "problem": "Consider the classical isotropic Heisenberg model on a two-dimensional square lattice with periodic boundary conditions. The Hamiltonian involves interactions between Nearest Neighbors (NN) and Next-Nearest Neighbors (NNN). The model is defined by the parameters $J_1$, $J_2$, and fixed spin length $S$, with the Hamiltonian\n$$\nH = \\sum_{\\langle i,j\\rangle} J_1\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j + \\sum_{\\langle\\langle i,j\\rangle\\rangle} J_2\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j,\n$$\nwhere $\\mathbf{S}_i$ are classical spins of fixed magnitude $S$ and the sums $\\langle i,j\\rangle$ and $\\langle\\langle i,j\\rangle\\rangle$ run over NN and NNN bonds respectively, each counted once.\n\nStarting from the Hamiltonian and the definitions of NN and NNN on the square lattice, derive the classical energy per site for a single-$\\mathbf{Q}$ spiral configuration $ \\mathbf{S}(\\mathbf{r}_i) = S\\left(\\cos(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,\\sin(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,0\\right) $, and reduce it to a function $E(\\mathbf{Q})/N$ of the ordering wavevector $\\mathbf{Q}=(q_x,q_y)$, where $q_x$ and $q_y$ are components expressed in radians. Your derivation must begin from the Hamiltonian and use only lattice geometry and translational invariance, without assuming any shortcut formulas.\n\nThen, implement a program to determine the classical ground state by minimizing the derived $E(\\mathbf{Q})/N$ over the Brillouin Zone. The search domain for the components of the wavevector must be $q_x\\in[-\\pi,\\pi]$ and $q_y\\in[-\\pi,\\pi]$ (angles in radians). Use a uniform grid sampling that includes the endpoints $-\\pi$ and $\\pi$. If multiple $\\mathbf{Q}$ values minimize $E(\\mathbf{Q})/N$ to within a numerical tolerance $\\epsilon$ (use $\\epsilon=10^{-12}$), select a unique minimizer with the deterministic tie-breaking rule: choose the $\\mathbf{Q}$ with the lexicographically smallest pair $(q_x,q_y)$ in the domain $[-\\pi,\\pi]\\times[-\\pi,\\pi]$.\n\nFor each parameter set in the test suite below, compute:\n- The minimizing wavevector components $q_x$ and $q_y$ (in radians).\n- The corresponding classical energy per site $E(\\mathbf{Q})/N$ (dimensionless, since $J_1$, $J_2$, and $S$ are taken in consistent units).\n\nExpress the final program output as a single line containing a comma-separated list of results enclosed in square brackets. Each test case result must itself be a list of three floats $[q_x,q_y,E/N]$, so the full output will look like $[[q_{x,1},q_{y,1},E_1],[q_{x,2},q_{y,2},E_2],\\dots]$. Angles must be in radians, and the program should round each reported number to $6$ decimal places.\n\nTest Suite (use $S=1.0$ for all cases):\n- Case $1$: $J_1=1.0$, $J_2=0.3$.\n- Case $2$: $J_1=1.0$, $J_2=0.6$.\n- Case $3$: $J_1=1.0$, $J_2=0.5$.\n- Case $4$: $J_1=-1.0$, $J_2=0.3$.\n- Case $5$: $J_1=0.0$, $J_2=1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces, in the exact format:\n$$\n\\left[\\,[q_{x,1},q_{y,1},E_1],[q_{x,2},q_{y,2},E_2],\\dots\\,\\right].\n$$", "solution": "The problem requires a two-part solution: first, a derivation of the classical energy per site for a spiral magnetic configuration on a square lattice, and second, a numerical implementation to find the ground state for given interaction parameters.\n\n### Part 1: Derivation of the Energy per Site\n\nThe starting point is the classical Heisenberg Hamiltonian on a two-dimensional square lattice with nearest-neighbor ($J_1$) and next-nearest-neighbor ($J_2$) interactions:\n$$\nH = \\sum_{\\langle i,j\\rangle} J_1\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j + \\sum_{\\langle\\langle i,j\\rangle\\rangle} J_2\\,\\mathbf{S}_i\\cdot\\mathbf{S}_j\n$$\nHere, $\\mathbf{S}_i$ is a classical spin vector of fixed magnitude $S$ at lattice site $i$. The sums $\\langle i,j\\rangle$ and $\\langle\\langle i,j\\rangle\\rangle$ are over all unique nearest-neighbor (NN) and next-nearest-neighbor (NNN) bonds, respectively.\n\nWe consider a single-$\\mathbf{Q}$ planar spiral spin configuration, where the spins are confined to a plane (e.g., the $xy$-plane) and their orientation varies sinusoidally across the lattice. The spin at a site $\\mathbf{r}_i$ is given by:\n$$\n\\mathbf{S}(\\mathbf{r}_i) = S\\left(\\cos(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,\\sin(\\mathbf{Q}\\cdot \\mathbf{r}_i),\\,0\\right)\n$$\nwhere $\\mathbf{Q} = (q_x, q_y)$ is the ordering wavevector.\n\nThe interaction energy between two spins at sites $\\mathbf{r}_i$ and $\\mathbf{r}_j$ is proportional to their dot product:\n$$\n\\mathbf{S}_i \\cdot \\mathbf{S}_j = \\mathbf{S}(\\mathbf{r}_i) \\cdot \\mathbf{S}(\\mathbf{r}_j) = S^2 \\left[ \\cos(\\mathbf{Q}\\cdot\\mathbf{r}_i)\\cos(\\mathbf{Q}\\cdot\\mathbf{r}_j) + \\sin(\\mathbf{Q}\\cdot\\mathbf{r}_i)\\sin(\\mathbf{Q}\\cdot\\mathbf{r}_j) \\right]\n$$\nUsing the trigonometric identity $\\cos(A-B) = \\cos A \\cos B + \\sin A \\sin B$, this simplifies to:\n$$\n\\mathbf{S}_i \\cdot \\mathbf{S}_j = S^2 \\cos(\\mathbf{Q}\\cdot\\mathbf{r}_i - \\mathbf{Q}\\cdot\\mathbf{r}_j) = S^2 \\cos(\\mathbf{Q}\\cdot(\\mathbf{r}_i - \\mathbf{r}_j))\n$$\n\nThe total energy $E$ is the value of the Hamiltonian for this configuration. To find the energy per site, $E/N$, where $N$ is the total number of sites, we can exploit the translational invariance of the lattice and the spin configuration. The energy contribution from each site is identical. We can calculate the energy associated with a reference site (say, at the origin $\\mathbf{r}_0 = \\mathbf{0}$) interacting with its neighbors, and then divide by $2$ to correct for the double counting of bonds (since the bond energy between sites $i$ and $j$ is shared between them).\n\nThe energy per site $E/N$ is therefore:\n$$\n\\frac{E}{N} = \\frac{1}{2} \\left[ \\sum_{j \\in \\text{NN of } 0} J_1 \\mathbf{S}_0 \\cdot \\mathbf{S}_j + \\sum_{j \\in \\text{NNN of } 0} J_2 \\mathbf{S}_0 \\cdot \\mathbf{S}_j \\right]\n$$\nThe positions of the neighbors relative to the origin are given by the displacement vectors $\\boldsymbol{\\delta}$. For a site at $\\mathbf{r}_0 = \\mathbf{0}$, a neighbor is at $\\mathbf{r}_j = \\boldsymbol{\\delta}$. The interaction term becomes:\n$$\n\\mathbf{S}_0 \\cdot \\mathbf{S}_j = S^2 \\cos(\\mathbf{Q}\\cdot(\\mathbf{0} - \\boldsymbol{\\delta})) = S^2 \\cos(-\\mathbf{Q}\\cdot\\boldsymbol{\\delta}) = S^2 \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta})\n$$\nThe energy per site can now be written as a sum over these displacement vectors:\n$$\n\\frac{E(\\mathbf{Q})}{N} = \\frac{1}{2} \\left[ J_1 S^2 \\sum_{\\boldsymbol{\\delta}_{\\mathrm{NN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NN}}) + J_2 S^2 \\sum_{\\boldsymbol{\\delta}_{\\mathrm{NNN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NNN}}) \\right]\n$$\n\nLet the lattice constant be $a=1$. The neighbor vectors for a square lattice are:\n- Nearest-Neighbors (NN): $\\boldsymbol{\\delta}_{\\mathrm{NN}} \\in \\{(1,0), (-1,0), (0,1), (0,-1)\\}$. There are $z_1=4$ such neighbors.\n- Next-Nearest-Neighbors (NNN): $\\boldsymbol{\\delta}_{\\mathrm{NNN}} \\in \\{(1,1), (1,-1), (-1,1), (-1,-1)\\}$. There are $z_2=4$ such neighbors.\n\nWe now evaluate the sums.\nFor nearest-neighbors:\n$$\n\\sum_{\\boldsymbol{\\delta}_{\\mathrm{NN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NN}}) = \\cos(q_x) + \\cos(-q_x) + \\cos(q_y) + \\cos(-q_y) = 2\\cos(q_x) + 2\\cos(q_y)\n$$\nFor next-nearest-neighbors:\n$$\n\\sum_{\\boldsymbol{\\delta}_{\\mathrm{NNN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NNN}}) = \\cos(q_x+q_y) + \\cos(q_x-q_y) + \\cos(-q_x+q_y) + \\cos(-q_x-q_y)\n$$\nUsing $\\cos(-A)=\\cos(A)$ and $\\cos(A+B)+\\cos(A-B) = 2\\cos A \\cos B$:\n$$\n\\sum_{\\boldsymbol{\\delta}_{\\mathrm{NNN}}} \\cos(\\mathbf{Q}\\cdot\\boldsymbol{\\delta}_{\\mathrm{NNN}}) = 2(\\cos(q_x+q_y) + \\cos(q_x-q_y)) = 2(2\\cos(q_x)\\cos(q_y)) = 4\\cos(q_x)\\cos(q_y)\n$$\nSubstituting these sums back into the expression for the energy per site:\n$$\n\\frac{E(\\mathbf{Q})}{N} = \\frac{S^2}{2} \\left[ J_1(2\\cos(q_x) + 2\\cos(q_y)) + J_2(4\\cos(q_x)\\cos(q_y)) \\right]\n$$\nThis simplifies to the final expression for the classical energy per site for a spiral configuration:\n$$\n\\frac{E(\\mathbf{Q})}{N} = S^2 \\left[ J_1(\\cos(q_x) + \\cos(q_y)) + 2J_2\\cos(q_x)\\cos(q_y) \\right]\n$$\nThis completes the derivation.\n\n### Part 2: Numerical Minimization\n\nThe classical ground state corresponds to the wavevector $\\mathbf{Q}=(q_x, q_y)$ that minimizes this energy function $E(\\mathbf{Q})/N$. The program will find this minimum by evaluating the derived energy function on a fine, uniform grid over the first Brillouin zone, defined by $q_x, q_y \\in [-\\pi, \\pi]$. A large number of grid points is used to ensure the minimum is located with sufficient accuracy.\n\nAfter calculating the energy for every $(\\mathbf{q}_x, \\mathbf{q}_y)$ pair on the grid, the minimum energy value is identified. All grid points yielding this minimum energy (within a small numerical tolerance $\\epsilon = 10^{-12}$) are collected as candidates. The problem specifies a deterministic tie-breaking rule: from the set of candidate wavevectors, the one with the lexicographically smallest pair $(q_x, q_y)$ is chosen as the unique solution. The program implements this by sorting the candidate vectors and selecting the first one. This procedure yields the ground state wavevector and energy for each specified set of parameters $(J_1, J_2)$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the classical ground state wavevector and energy for the J1-J2\n    Heisenberg model on a 2D square lattice for several parameter sets.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (J1, J2)\n        (1.0, 0.3),\n        (1.0, 0.6),\n        (1.0, 0.5),\n        (-1.0, 0.3),\n        (0.0, 1.0),\n    ]\n\n    # Parameters from the problem\n    S = 1.0\n    epsilon = 1e-12\n\n    # Grid setup for minimizing the energy function.\n    # A fine grid ensures accuracy in finding the minimum. The grid includes\n    # endpoints -pi and pi as required.\n    N_points = 4001\n    q_vals = np.linspace(-np.pi, np.pi, N_points)\n    qx_grid, qy_grid = np.meshgrid(q_vals, q_vals)\n\n    results = []\n    for j1, j2 in test_cases:\n        # Calculate energy per site for the entire grid of wavevectors (qx, qy)\n        # using the derived formula:\n        # E/N = S^2 * [J1*(cos(qx) + cos(qy)) + 2*J2*cos(qx)*cos(qy)]\n        cos_qx = np.cos(qx_grid)\n        cos_qy = np.cos(qy_grid)\n        \n        energy_grid = S**2 * (j1 * (cos_qx + cos_qy) + 2 * j2 * cos_qx * cos_qy)\n\n        # Find the minimum energy value on the grid.\n        min_energy = np.min(energy_grid)\n\n        # Find all grid indices where the energy is equal to the minimum\n        # within the specified numerical tolerance.\n        min_indices = np.argwhere(np.abs(energy_grid - min_energy) < epsilon)\n\n        # Collect all candidate (qx, qy) wavevectors that produce the minimum energy.\n        candidates = []\n        for idx_pair in min_indices:\n            # np.meshgrid with 'xy' indexing (default) means qx_grid.shape[1] is\n            # the length of q_vals and qy_grid.shape[0] is the length of q_vals.\n            # argwhere returns (row, col) which corresponds to (qy_idx, qx_idx).\n            qy_idx, qx_idx = idx_pair\n            qx = q_vals[qx_idx]\n            qy = q_vals[qy_idx]\n            candidates.append((qx, qy))\n            \n        # Apply the deterministic tie-breaking rule: choose the wavevector\n        # with the lexicographically smallest (qx, qy) pair.\n        # Python's default tuple sorting is lexicographical.\n        candidates.sort()\n        best_qx, best_qy = candidates[0]\n        \n        # Calculate the final energy corresponding to the chosen wavevector.\n        # This re-calculation ensures precision for the chosen point.\n        final_energy = S**2 * (j1 * (np.cos(best_qx) + np.cos(best_qy)) + 2 * j2 * np.cos(best_qx) * np.cos(best_qy))\n        \n        # Round results to 6 decimal places as required.\n        q_x_r = best_qx\n        q_y_r = best_qy\n        E_r = final_energy\n        \n        # Format the numbers and append to the results list.\n        # The f-string format specifier '{:.6f}' ensures 6 decimal places.\n        # An explicit check for -0.0 is included for clean output.\n        if round(q_x_r, 6) == -0.0: q_x_r = 0.0\n        if round(q_y_r, 6) == -0.0: q_y_r = 0.0\n        if round(E_r, 6) == -0.0: E_r = 0.0\n        \n        results.append(f\"[{q_x_r:.6f},{q_y_r:.6f},{E_r:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3019393"}]}