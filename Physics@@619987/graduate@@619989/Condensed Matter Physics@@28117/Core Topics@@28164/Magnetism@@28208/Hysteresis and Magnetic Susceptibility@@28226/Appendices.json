{"hands_on_practices": [{"introduction": "A key feature of ferromagnets is hysteresis, which is not just a curiosity but has a direct thermodynamic consequence: energy dissipation. This exercise provides a direct calculation of this loss for an idealized but insightful rectangular hysteresis loop. By working from the fundamental energy balance of magnetostatics [@problem_id:2995439], you will establish the direct link between the area enclosed by the $M-H$ loop and the dissipated energy, a foundational concept in the application and characterization of magnetic materials.", "problem": "A bulk ferromagnet with negligible electrical conductivity is driven in the quasistatic regime by a spatially uniform external magnetic field $H(t)$ of amplitude $H_{0}$ that satisfies $H_{0} \\ge H_{c}$. The material exhibits a rectangular hysteresis loop in the magnetization $M$ versus field $H$: the magnetization saturates at $M=\\pm M_{s}$ for $|H|H_{c}$ and switches discontinuously between $-M_{s}$ and $+M_{s}$ when $H$ crosses the coercive field values $\\pm H_{c}$. Assume that the magnetic induction is given by $B=\\mu_{0}(H+M)$, where $\\mu_{0}$ is the permeability of free space in the International System of Units (SI), and that there are no additional dynamic losses beyond quasistatic hysteresis.\n\nStarting from a fundamental energy balance for magnetostatics, derive the energy dissipated per unit volume in one complete cycle of $H(t)$ in terms of $\\mu_{0}$, $M_{s}$, and $H_{c}$. Then, using the same foundation, explain why this energy loss is independent of the drive frequency in the quasistatic regime. Express the final energy loss per cycle per unit volume as a single closed-form analytic expression in Joules per cubic meter per cycle. Do not provide any numerical approximation.", "solution": "The problem asks for the derivation of the energy dissipated per unit volume in a ferromagnetic material over one complete cycle of an applied magnetic field, based on a fundamental energy balance. The material is characterized by a rectangular hysteresis loop.\n\nThe starting point for the energy balance in magnetostatics is the differential work, $dW$, done per unit volume by an external source to change the magnetic induction by $dB$ in the presence of a magnetic field $H$. This is given by:\n$$dW = H \\, dB$$\nThe total energy supplied by the source per unit volume over one complete cycle of the magnetic field $H(t)$ is the integral of this quantity over the cycle:\n$$W_{cycle} = \\oint H \\, dB$$\nThe magnetic induction $B$ is given by the constitutive relation $B = \\mu_{0}(H+M)$, where $\\mu_{0}$ is the permeability of free space, $H$ is the magnetic field, and $M$ is the magnetization of the material. The differential of $B$ is therefore:\n$$dB = \\mu_{0}(dH + dM)$$\nSubstituting this into the expression for the work per cycle gives:\n$$W_{cycle} = \\oint H \\mu_{0}(dH + dM) = \\mu_{0} \\oint H \\, dH + \\mu_{0} \\oint H \\, dM$$\nThe first term, $\\mu_{0} \\oint H \\, dH$, represents the energy stored in the magnetic field itself. Since $H$ is a state variable, its value at the beginning and end of a cycle is the same. Therefore, the integral of a perfect differential like $H \\, dH = d(\\frac{1}{2}H^2)$ over a closed path is zero:\n$$\\mu_{0} \\oint H \\, dH = \\mu_{0} \\int d\\left(\\frac{1}{2}H^2\\right) = 0$$\nThis term corresponds to energy that is reversibly stored in the field and returned to the source.\n\nThe second term, $W_{diss} = \\mu_{0} \\oint H \\, dM$, represents the irreversible work done on the magnetic domains within the material. This work is dissipated as heat, and it is non-zero because the relationship between $M$ and $H$ is hysteretic, meaning $M$ is not a single-valued function of $H$. The dissipated energy per unit volume per cycle is thus given by this integral, which corresponds to $\\mu_{0}$ times the area enclosed by the $M$ versus $H$ hysteresis loop.\n$$W_{diss} = \\mu_{0} \\oint H \\, dM$$\nWe now evaluate this integral for the specified rectangular hysteresis loop. The cycle of the external field $H(t)$ has an amplitude $H_{0}$ such that $H_{0} \\ge H_{c}$. Let's trace one full cycle, starting from the point $(H, M) = (H_{0}, M_{s})$.\n\n1.  **Path 1: $H$ decreases from $H_{0}$ to $-H_{c}$.**\n    The material is saturated, so the magnetization $M$ remains constant at $M_s$. Along this path, $dM = 0$. The contribution to the integral is zero:\n    $$\\int_{H_{0}}^{-H_{c}} H \\, (0) = 0$$\n\n2.  **Path 2: $H$ is at $-H_{c}$ and the magnetization switches.**\n    At $H = -H_{c}$, the magnetization discontinuously switches from $M = +M_{s}$ to $M = -M_{s}$. During this switch, $H$ is constant at $-H_{c}$. The integral along this vertical segment of the loop is:\n    $$\\int_{+M_{s}}^{-M_{s}} (-H_{c}) \\, dM = -H_{c} [M]_{+M_{s}}^{-M_{s}} = -H_{c}(-M_{s} - M_{s}) = 2H_{c}M_{s}$$\n\n3.  **Path 3: $H$ decreases from $-H_{c}$ to $-H_{0}$.**\n    The magnetization is now saturated in the opposite direction, so $M$ remains constant at $-M_s$. Along this path, $dM = 0$. The contribution to the integral is zero.\n\n4.  **Path 4: $H$ increases from $-H_{0}$ to $+H_{c}$.**\n    Similarly, $M$ remains constant at $-M_s$, so $dM = 0$. The contribution to the integral is zero.\n\n5.  **Path 5: $H$ is at $+H_{c}$ and the magnetization switches back.**\n    At $H = +H_c$, the magnetization discontinuously switches from $M = -M_s$ to $M = +M_s$. During this switch, $H$ is constant at $+H_c$. The integral is:\n    $$\\int_{-M_{s}}^{+M_{s}} (+H_{c}) \\, dM = H_{c} [M]_{-M_{s}}^{+M_{s}} = H_{c}(M_{s} - (-M_{s})) = 2H_{c}M_{s}$$\n\n6.  **Path 6: $H$ increases from $+H_{c}$ to $H_{0}$.**\n    The magnetization is again saturated at $M_s$, so $dM = 0$. The contribution is zero.\n\nSumming the contributions from all paths gives the total area enclosed by the loop:\n$$\\oint H \\, dM = 0 + 2H_{c}M_{s} + 0 + 0 + 2H_{c}M_{s} + 0 = 4H_{c}M_{s}$$\nThis value is the area of the rectangle in the $M-H$ plane, which has a width of $2H_{c}$ and a height of $2M_{s}$.\n\nThe total energy dissipated per unit volume in one complete cycle is therefore:\n$$W_{diss} = \\mu_{0} \\oint H \\, dM = 4\\mu_{0}H_{c}M_{s}$$\n\nNext, we must explain why this energy loss is independent of the drive frequency in the quasistatic regime. The term \"quasistatic\" implies that the system is driven so slowly that at any point in time, it is arbitrarily close to magnetostatic equilibrium. In this regime, the state of the system, specifically its magnetization $M$, is a function only of the instantaneous applied field $H$, following the prescribed static hysteresis loop. The shape of the $M-H$ loop, defined by the material parameters $M_{s}$ and $H_{c}$, is therefore independent of how quickly or slowly the field $H(t)$ is varied.\n\nSince the dissipated energy per cycle, $W_{diss}$, is directly proportional to the area enclosed by the $M-H$ loop, and this area is constant in the quasistatic regime, the energy dissipated *per cycle* is independent of the drive frequency. The assumption of \"negligible electrical conductivity\" and \"no additional dynamic losses\" is crucial, as it explicitly excludes frequency-dependent loss mechanisms such as eddy currents or other dynamic relaxation effects that would cause the area of the hysteresis loop to increase with frequency. It is important to note that while the energy loss per cycle is constant, the time-averaged power dissipation, $P_{diss} = W_{diss} \\times f$ (where $f$ is the frequency), is directly proportional to the frequency.", "answer": "$$\n\\boxed{4\\mu_{0}H_{c}M_{s}}\n$$", "id": "2995439"}, {"introduction": "Having established that hysteresis causes energy loss, we now explore its microscopic origins. This practice [@problem_id:2995361] models a domain wall as an elastic object interacting with a single pinning defect, a common scenario in magnetic materials. Through the powerful technique of energy minimization, you will determine how the wall deforms under a magnetic field and ultimately breaks free, allowing you to derive the coercive field and hysteresis width from fundamental parameters like domain wall tension and defect strength.", "problem": "Consider a ferromagnetic thin film hosting a straight one-dimensional $180^{\\circ}$ domain wall of total span $L$ along the coordinate $y$. The wall is modeled as an elastic string with line tension $\\Gamma$, so that its elastic energy for a displacement field $z(y)$ is given by $E_{\\mathrm{el}}[z] = \\frac{\\Gamma}{2} \\int_{-L/2}^{L/2} (\\partial_{y} z)^{2} \\, dy$. A single localized defect at $y=0$ couples to the wall through a short-range binding potential whose effect on the wall can be approximated, in terms of the wallâ€™s center displacement $x \\equiv z(0)$, by an additional local quadratic energy $V_{\\mathrm{def}}(x) = \\frac{U}{2} x^{2}$ provided $|x| \\leq \\xi$, and $V_{\\mathrm{def}}(x) = 0$ if $|x|  \\xi$. Here $U$ is the defect stiffness and $\\xi$ is its capture radius. An external uniform magnetic field $H$ along the easy axis exerts a pressure on the wall that produces a line force density $f_{\\ell} = 2 \\mu_{0} M_{s} H \\, t$, where $\\mu_{0}$ is the vacuum permeability, $M_{s}$ is the saturation magnetization, and $t$ is the film thickness. Assume quasi-static evolution and that the wall endpoints are anchored in the sense $z(-L/2) = z(L/2) = 0$.\n\nStarting from the above ingredients and using first principles of energy minimization, perform the following:\n\n1. Determine the minimal elastic energy $E_{\\mathrm{el}}(x)$ of the wall when its center is constrained to a displacement $x$ and the endpoints satisfy $z(\\pm L/2)=0$. From this, identify an effective elastic stiffness $K$ such that $E_{\\mathrm{el}}(x) = \\frac{K}{2} x^{2}$.\n\n2. Include the work of the line force $f_{\\ell}$ due to the external field by evaluating $\\int_{-L/2}^{L/2} z(y) \\, dy$ for the energy-minimizing shape with center displacement $x$, and write the total quasi-static energy $E(x)$ for the wall as a function of $x$ in the two regimes $|x| \\leq \\xi$ and $|x|  \\xi$.\n\n3. For a slow increase of $H$ from $0$, determine the forward depinning threshold $H_{c}^{+}$ at which the metastable pinned minimum at $|x| \\leq \\xi$ ceases to exist. For a slow decrease of $H$ after depinning, determine the backward repinning threshold $H_{c}^{-}$ at which the unpinned minimum at $|x|  \\xi$ re-enters the defect capture radius. Then obtain the hysteresis width $\\Delta H \\equiv H_{c}^{+} - H_{c}^{-}$.\n\nExpress your final answers for $H_{c}^{+}$, $H_{c}^{-}$, and $\\Delta H$ in Ampere per meter (A/m), in terms of $\\Gamma$, $U$, $\\xi$, $L$, $\\mu_{0}$, $M_{s}$, and $t$. The final answer must be a single closed-form analytic expression. No rounding is required.", "solution": "### 1. Minimal Elastic Energy and Effective Stiffness $K$\n\nThe elastic energy of the domain wall is given by the functional $E_{\\mathrm{el}}[z] = \\frac{\\Gamma}{2} \\int_{-L/2}^{L/2} (\\partial_{y} z)^{2} \\, dy$. To find the wall shape $z(y)$ that minimizes this energy subject to the boundary conditions $z(\\pm L/2) = 0$ and the constraint $z(0)=x$, we use the calculus of variations. The Euler-Lagrange equation for the integrand $\\mathcal{L} = \\frac{\\Gamma}{2} (\\partial_{y} z)^{2}$ is:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial z} - \\frac{d}{dy}\\left(\\frac{\\partial \\mathcal{L}}{\\partial (\\partial_{y} z)}\\right) = 0\n$$\nSince $\\frac{\\partial \\mathcal{L}}{\\partial z} = 0$ and $\\frac{\\partial \\mathcal{L}}{\\partial (\\partial_{y} z)} = \\Gamma \\partial_{y} z$, the equation becomes:\n$$\n-\\frac{d}{dy}(\\Gamma \\partial_{y} z) = -\\Gamma \\partial_{yy} z = 0 \\implies \\partial_{yy} z = 0\n$$\nThe general solution is a linear function of $y$. Due to the constraint at $y=0$, we must consider two separate segments for the wall shape: one for $y \\in [-L/2, 0]$ and another for $y \\in [0, L/2]$.\n\nFor the segment $y \\in [0, L/2]$:\nThe general solution is $z(y) = A_1 y + B_1$. Applying the conditions $z(0)=x$ and $z(L/2)=0$:\n- $z(0) = A_1(0) + B_1 = x \\implies B_1 = x$.\n- $z(L/2) = A_1(L/2) + x = 0 \\implies A_1 = -2x/L$.\nSo, for $y \\in [0, L/2]$, the shape is $z(y) = x(1 - 2y/L)$.\n\nFor the segment $y \\in [-L/2, 0]$:\nThe general solution is $z(y) = A_2 y + B_2$. Applying the conditions $z(0)=x$ and $z(-L/2)=0$:\n- $z(0) = A_2(0) + B_2 = x \\implies B_2 = x$.\n- $z(-L/2) = A_2(-L/2) + x = 0 \\implies A_2 = 2x/L$.\nSo, for $y \\in [-L/2, 0]$, the shape is $z(y) = x(1 + 2y/L)$.\n\nThese two expressions can be combined into a single one using the absolute value: $z(y) = x(1 - 2|y|/L)$. This describes a triangular or \"tent\" shape for the domain wall.\n\nNow, we calculate the minimal elastic energy $E_{\\mathrm{el}}(x)$ for this configuration. The derivative is $\\partial_y z = - (2x/L)\\mathrm{sgn}(y)$ for $y \\neq 0$. Its square is $(\\partial_y z)^2 = 4x^2/L^2$.\n$$\nE_{\\mathrm{el}}(x) = \\frac{\\Gamma}{2} \\int_{-L/2}^{L/2} \\left(\\frac{4x^2}{L^2}\\right) dy = \\frac{2\\Gamma x^2}{L^2} \\int_{-L/2}^{L/2} dy = \\frac{2\\Gamma x^2}{L^2} (L) = \\frac{2\\Gamma x^2}{L}\n$$\nWe are asked to identify an effective elastic stiffness $K$ from the relation $E_{\\mathrm{el}}(x) = \\frac{K}{2} x^2$.\n$$\n\\frac{K}{2} x^2 = \\frac{2\\Gamma x^2}{L} \\implies K = \\frac{4\\Gamma}{L}\n$$\n\n### 2. Total Quasi-static Energy $E(x)$\n\nThe total energy $E(x)$ is the sum of the elastic energy $E_{\\mathrm{el}}(x)$, the defect potential energy $V_{\\mathrm{def}}(x)$, and the potential energy due to the external field. The work done by the line force $f_{\\ell}$ on the wall for a displacement $z(y)$ is $W = \\int f_{\\ell} z(y) dy$. The corresponding potential energy term is $-W$.\nThe integral of the displacement profile is:\n$$\n\\int_{-L/2}^{L/2} z(y) dy = \\int_{-L/2}^{L/2} x(1 - 2|y|/L) dy = 2x \\int_{0}^{L/2} (1 - 2y/L) dy\n$$\n$$\n= 2x \\left[ y - \\frac{y^2}{L} \\right]_{0}^{L/2} = 2x \\left( \\frac{L}{2} - \\frac{(L/2)^2}{L} \\right) = 2x \\left( \\frac{L}{2} - \\frac{L}{4} \\right) = \\frac{xL}{2}\n$$\nThe potential energy from the field is $-f_{\\ell} \\int z(y) dy$. Substituting $f_{\\ell} = 2 \\mu_{0} M_{s} H t$:\n$$\nE_{\\mathrm{field}}(x) = -(2 \\mu_{0} M_{s} H t) \\left(\\frac{xL}{2}\\right) = -\\mu_{0} M_{s} t L H x\n$$\nThe total energy $E(x)$ is thus:\n$$\nE(x) = E_{\\mathrm{el}}(x) + V_{\\mathrm{def}}(x) + E_{\\mathrm{field}}(x) = \\frac{2\\Gamma}{L} x^2 + V_{\\mathrm{def}}(x) - \\mu_{0} M_{s} t L H x\n$$\nWe now write this for the two regimes of the defect potential:\n- For $|x| \\leq \\xi$ (pinned regime): $V_{\\mathrm{def}}(x) = \\frac{U}{2}x^2$.\n$$\nE_{\\mathrm{pinned}}(x) = \\frac{2\\Gamma}{L} x^2 + \\frac{U}{2} x^2 - \\mu_{0} M_{s} t L H x = \\frac{1}{2} \\left(\\frac{4\\Gamma}{L} + U\\right)x^2 - \\mu_{0} M_{s} t L H x\n$$\nUsing $K=4\\Gamma/L$, this is $E_{\\mathrm{pinned}}(x) = \\frac{1}{2}(K+U)x^2 - \\mu_{0} M_{s} t L H x$.\n- For $|x|  \\xi$ (unpinned regime): $V_{\\mathrm{def}}(x) = 0$.\n$$\nE_{\\mathrm{unpinned}}(x) = \\frac{2\\Gamma}{L} x^2 - \\mu_{0} M_{s} t L H x = \\frac{K}{2} x^2 - \\mu_{0} M_{s} t L H x\n$$\n\n### 3. Depinning, Repinning, and Hysteresis\n\nThe critical fields correspond to changes in the stability of the minima of the total energy $E(x)$. We assume $H0$, so we are interested in $x0$.\n\n**Forward Depinning Threshold $H_{c}^{+}$**:\nStarting from $H=0$, the wall is in the pinned state, with its equilibrium position determined by the minimum of $E_{\\mathrm{pinned}}(x)$. We find the minimum by setting the derivative to zero:\n$$\n\\frac{dE_{\\mathrm{pinned}}}{dx} = (K+U)x - \\mu_{0} M_{s} t L H = 0 \\implies x_{\\mathrm{min,p}} = \\frac{\\mu_{0} M_{s} t L H}{K+U}\n$$\nThis represents a stable local minimum as long as $x_{\\mathrm{min,p}}  \\xi$. The depinning occurs when this local minimum ceases to exist within the capture radius. This happens when the minimum is pushed to the boundary of the defect region, i.e., $x_{\\mathrm{min,p}} = \\xi$. The field at which this occurs is the forward depinning threshold $H_{c}^{+}$:\n$$\n\\xi = \\frac{\\mu_{0} M_{s} t L H_{c}^{+}}{K+U} \\implies H_{c}^{+} = \\frac{(K+U)\\xi}{\\mu_{0} M_{s} t L}\n$$\nSubstituting $K = 4\\Gamma/L$:\n$$\nH_{c}^{+} = \\frac{(4\\Gamma/L + U)\\xi}{\\mu_{0} M_{s} t L} = \\frac{(4\\Gamma + UL)\\xi}{\\mu_{0} M_{s} t L^2}\n$$\n\n**Backward Repinning Threshold $H_{c}^{-}$**:\nAfter depinning ($H  H_{c}^{+}$), the wall is in the unpinned state, and its equilibrium position is given by the minimum of $E_{\\mathrm{unpinned}}(x)$:\n$$\n\\frac{dE_{\\mathrm{unpinned}}}{dx} = Kx - \\mu_{0} M_{s} t L H = 0 \\implies x_{\\mathrm{min,u}} = \\frac{\\mu_{0} M_{s} t L H}{K}\n$$\nWhen the field $H$ is decreased from a large value, $x_{\\mathrm{min,u}}$ decreases. Repinning occurs when the unpinned minimum re-enters the defect capture radius, i.e., at the threshold where $x_{\\mathrm{min,u}} = \\xi$. This defines the backward repinning threshold $H_{c}^{-}$:\n$$\n\\xi = \\frac{\\mu_{0} M_{s} t L H_{c}^{-}}{K} \\implies H_{c}^{-} = \\frac{K\\xi}{\\mu_{0} M_{s} t L}\n$$\nSubstituting $K = 4\\Gamma/L$:\n$$\nH_{c}^{-} = \\frac{(4\\Gamma/L)\\xi}{\\mu_{0} M_{s} t L} = \\frac{4\\Gamma\\xi}{\\mu_{0} M_{s} t L^2}\n$$\n\n**Hysteresis Width $\\Delta H$**:\nThe hysteresis width is the difference between the forward and backward critical fields:\n$$\n\\Delta H = H_{c}^{+} - H_{c}^{-} = \\frac{(K+U)\\xi}{\\mu_{0} M_{s} t L} - \\frac{K\\xi}{\\mu_{0} M_{s} t L}\n$$\n$$\n\\Delta H = \\frac{(K+U-K)\\xi}{\\mu_{0} M_{s} t L} = \\frac{U\\xi}{\\mu_{0} M_{s} t L}\n$$\nThis result shows that the hysteresis width is directly proportional to the defect strength, characterized by the product $U\\xi$, and inversely proportional to the magnetic pressure coupling constant $\\mu_0 M_s t$ and the effective length $L$ over which the force acts.\n\nThe final expressions are:\n$H_{c}^{+} = \\frac{(4\\Gamma + UL)\\xi}{\\mu_{0} M_{s} t L^2}$\n$H_{c}^{-} = \\frac{4\\Gamma\\xi}{\\mu_{0} M_{s} t L^2}$\n$\\Delta H = \\frac{U\\xi}{\\mu_{0} M_{s} t L}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(4\\Gamma + UL)\\xi}{\\mu_{0} M_{s} t L^{2}}  \\frac{4\\Gamma\\xi}{\\mu_{0} M_{s} t L^{2}}  \\frac{U\\xi}{\\mu_{0} M_{s} t L} \\end{pmatrix}}\n$$", "id": "2995361"}, {"introduction": "Real-world applications often involve alternating fields, making it crucial to understand the frequency-dependent dynamic susceptibility, $\\chi(\\omega)$. This practice [@problem_id:2995419] explores the profound connection between a system's dissipative and reactive responses, which is governed by the principle of causality and mathematically expressed by the Kramers-Kronig relations. You will derive these fundamental relations and then implement a numerical algorithm to reconstruct the real part of the susceptibility from its imaginary part, a task that bridges deep theory with practical computational physics.", "problem": "Consider a linear, causal magnetic medium where the magnetization response $M(t)$ to an applied magnetic field $H(t)$ in the time domain is encoded by a retarded susceptibility $\\chi(t)$, such that $M(t) = \\int_{-\\infty}^{\\infty} \\chi(t - t') H(t') \\, dt'$. By causality, $\\chi(t) = 0$ for $t  0$, and the frequency-domain susceptibility $\\chi(\\omega)$, obtained by Fourier transformation with angular frequency $\\omega$ in radians per second, is analytic in the upper half of the complex $\\omega$-plane. The imaginary part $\\chi''(\\omega)$ describes dissipation and corresponds to the absorptive part of the response. The real part $\\chi'(\\omega)$ and the imaginary part $\\chi''(\\omega)$ are interrelated by analyticity and causality, and consistency of $\\chi(\\omega)$ with static susceptibility requires appropriate sum rules.\n\nYou are given a family of physically plausible ferromagnetic resonance (FMR) lineshapes for the imaginary part of the susceptibility, built from a single damped resonance superposed on a high-frequency constant background. The total susceptibility is modeled as the sum of a constant high-frequency limit and a single-resonance contribution. The resonance contribution is governed by a characteristic angular resonance frequency $\\omega_0$ and a dimensionless amplitude $\\Delta \\chi$, along with a positive damping rate $\\Gamma$ that controls the resonance linewidth. For numerical reconstruction, the measured spectrum $\\chi''(\\omega)$ is sampled uniformly on a finite frequency grid $\\{\\omega_i\\}$ restricted to nonnegative $\\omega$.\n\nTasks:\n1. Starting from the causality of the retarded response and the analyticity of $\\chi(\\omega)$, derive the dispersion relation that determines the real part $\\chi'(\\omega)$ from the imaginary part $\\chi''(\\omega)$ using a principal value integral over the positive-frequency axis. Do not assume any specific functional form beyond causality, real-valued time-domain response, and sufficiently fast decay at large $|\\omega|$ to guarantee convergence.\n2. State and justify a sum rule that connects the static susceptibility difference $\\chi(0) - \\chi_{\\infty}$ to an integral over $\\chi''(\\omega)$ on the positive-frequency axis, where $\\chi_{\\infty}$ is the high-frequency limit of $\\chi'(\\omega)$.\n3. Implement a program that, for each test case described below, does the following:\n   - Constructs the \"measured\" imaginary part $\\chi''(\\omega)$ over the grid $\\omega \\in [0,\\omega_{\\max}]$ using a single-resonance FMR lineshape that is consistent with a causal susceptibility and a constant high-frequency limit $\\chi_{\\infty}$, with the resonance characterized by $\\omega_0$ and $\\Gamma$, and amplitude $\\Delta \\chi$.\n   - Reconstructs the real part $\\chi'(\\omega)$ from the sampled $\\chi''(\\omega)$ using the dispersion relation derived in Task 1, implemented as a numerical principal value integral over $\\omega \\ge 0$ with an appropriate quadrature on the given grid. Handle the principal value at singular points by excluding the self-term in the discrete sum.\n   - Computes the static real part $\\chi'(0)$ from the reconstruction and compares it to $\\chi_{\\infty} + \\Delta \\chi$, verifying consistency with the static susceptibility.\n   - Evaluates the sum rule from Task 2 numerically using the same grid and compares the result to $\\Delta \\chi$, thereby testing consistency between the measured dissipation and static response.\n   - Computes the maximum absolute error between the reconstructed $\\chi'(\\omega)$ and the exact real part of the single-resonance model used to generate $\\chi''(\\omega)$ on the same grid, thus verifying the correctness of the reconstruction algorithm.\n4. Use the following test suite and specifications:\n   - Units: Angular frequency must be in radians per second, and susceptibility must be dimensionless.\n   - Frequency grid: For each test case, use a uniform grid of $N = 4001$ points from $\\omega = 0$ to $\\omega = \\omega_{\\max} = 20 \\, \\omega_0$.\n   - Numerical tolerances for pass/fail:\n     - For the dispersion reconstruction, the maximum absolute error in $\\chi'(\\omega)$ must not exceed $10^{-2}$ (dimensionless).\n     - For the sum rule, the absolute difference between the numerical integral and $\\Delta \\chi$ must not exceed $5 \\times 10^{-3}$ (dimensionless).\n     - For the static susceptibility, the absolute difference between the reconstructed $\\chi'(0)$ and $\\chi_{\\infty} + \\Delta \\chi$ must not exceed $5 \\times 10^{-3}$ (dimensionless).\n   - Test cases (each specified by $(\\omega_0, \\Gamma, \\Delta \\chi, \\chi_{\\infty})$):\n     1. $(2\\pi \\times 10^{10}\\,\\text{rad/s}, \\, 0.05 \\, \\omega_0, \\, 1.2, \\, 0.15)$\n     2. $(2\\pi \\times 5 \\times 10^{9}\\,\\text{rad/s}, \\, 0.005 \\, \\omega_0, \\, 0.8, \\, 0.10)$\n     3. $(2\\pi \\times 1.5 \\times 10^{10}\\,\\text{rad/s}, \\, 0.5 \\, \\omega_0, \\, 2.0, \\, 0.05)$\n   - For the exact model used to generate $\\chi''(\\omega)$ and for validation, the complex single-resonance susceptibility is given implicitly by a causal form consistent with a damped oscillator response around $\\omega_0$ and a high-frequency limit $\\chi_{\\infty}$. Your program must construct $\\chi''(\\omega)$ from this model and use the analyticity constraints to reconstruct $\\chi'(\\omega)$; this ensures internal consistency for validation.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- For each test case, output a three-element list $[\\text{KK\\_ok}, \\text{sum\\_rule\\_ok}, \\text{static\\_ok}]$, where each element is a boolean indicating whether the corresponding check passed under the specified tolerance.\n- Thus, the final output must be of the form $[[b_{11},b_{12},b_{13}],[b_{21},b_{22},b_{23}],[b_{31},b_{32},b_{33}]]$ with no spaces, where $b_{ij}$ are boolean literals.", "solution": "The problem requires the derivation of fundamental relations for a causal magnetic susceptibility, followed by the implementation and verification of a numerical algorithm to reconstruct the real part of the susceptibility from its imaginary part. The process will be detailed in three parts: theoretical derivations, the choice of an explicit model, and the description of the numerical implementation.\n\n### Task 1: Derivation of the Kramers-Kronig Dispersion Relation\n\nThe foundation of the relationship between the real and imaginary parts of the susceptibility, $\\chi'(\\omega)$ and $\\chi''(\\omega)$, lies in the principle of causality. The statement that the response $M(t)$ cannot precede the stimulus $H(t)$ implies that the retarded susceptibility $\\chi(t)$ must be zero for $t  0$. A consequence of this, via the properties of the Fourier transform, is that its frequency-domain counterpart, $\\chi(\\omega)$, is an analytic function in the upper half of the complex frequency plane ($\\text{Im}(\\omega)  0$).\n\nThe problem states that the susceptibility approaches a constant value $\\chi_{\\infty}$ at high frequencies. It is more convenient to work with a function that vanishes at infinity. Let us define $\\phi(\\omega) = \\chi(\\omega) - \\chi_{\\infty}$. This function is also analytic in the upper half-plane and $\\phi(\\omega) \\to 0$ as $|\\omega| \\to \\infty$.\n\nBy Cauchy's integral formula, for any point $\\omega$ in the upper half-plane, we have:\n$$\n\\phi(\\omega) = \\frac{1}{2\\pi i} \\oint_C \\frac{\\phi(z)}{z - \\omega} dz\n$$\nWe choose the contour $C$ to be the real axis from $-R$ to $+R$ and a large semicircle $\\Gamma_R$ of radius $R$ in the upper half-plane. As $R \\to \\infty$, the integral over the semicircle vanishes, provided $\\phi(z) \\to 0$ as $|z| \\to \\infty$. For any physical response, this condition holds. Thus, the integral reduces to an integral along the real axis:\n$$\n\\phi(\\omega) = \\frac{1}{2\\pi i} \\int_{-\\infty}^{\\infty} \\frac{\\phi(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\nTo find the value for a real frequency $\\omega$, we take the limit as the imaginary part of our complex frequency point goes to zero from above, i.e., $\\omega \\to \\omega_r + i\\epsilon$ with $\\epsilon \\to 0^+$. Using the Sokhotski-Plemelj theorem, which states $\\lim_{\\epsilon \\to 0^+} \\frac{1}{x \\pm i\\epsilon} = \\mp i\\pi \\delta(x) + \\mathcal{P}\\frac{1}{x}$, the integral becomes:\n$$\n\\phi(\\omega_r) = \\frac{1}{2\\pi i} \\left( \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\phi(\\omega')}{\\omega' - \\omega_r} d\\omega' + i\\pi \\phi(\\omega_r) \\right)\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value. Rearranging this equation gives:\n$$\n\\phi(\\omega_r) = \\frac{1}{i\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\phi(\\omega')}{\\omega' - \\omega_r} d\\omega'\n$$\nSubstituting $\\phi(\\omega) = \\chi(\\omega) - \\chi_{\\infty} = (\\chi'(\\omega) - \\chi_{\\infty}) + i\\chi''(\\omega)$ and equating the real parts (and dropping the subscript $r$ for real frequencies):\n$$\n\\chi'(\\omega) - \\chi_{\\infty} = \\text{Re}\\left[ \\frac{1}{i\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{(\\chi'(\\omega') - \\chi_{\\infty}) + i\\chi''(\\omega')}{\\omega' - \\omega} d\\omega' \\right] = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\nFor a real-valued time-domain response $\\chi(t)$, we have the symmetry property $\\chi(-\\omega) = \\chi^*(\\omega)$, which implies that $\\chi'(\\omega)$ is an even function of $\\omega$ and $\\chi''(\\omega)$ is an odd function. We can use the oddness of $\\chi''(\\omega)$ to rewrite the integral over the domain $[0, \\infty)$:\n$$\n\\int_{-\\infty}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega' - \\omega} d\\omega' = \\int_{0}^{\\infty} \\chi''(\\omega') \\left( \\frac{1}{\\omega' - \\omega} + \\frac{1}{\\omega' + \\omega} \\right) d\\omega' = \\int_{0}^{\\infty} \\frac{2\\omega' \\chi''(\\omega')}{(\\omega')^2 - \\omega^2} d\\omega'\n$$\nThis leads to the final form of the Kramers-Kronig relation for the real part, as requested:\n$$\n\\chi'(\\omega) = \\chi_{\\infty} + \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' \\chi''(\\omega')}{(\\omega')^2 - \\omega^2} d\\omega'\n$$\n\n### Task 2: Derivation of the Sum Rule\n\nA sum rule connecting the static response to the total dissipation can be derived by evaluating the Kramers-Kronig relation at $\\omega = 0$. Since $\\chi''(\\omega)$ is odd, $\\chi''(0)=0$, and thus $\\chi(0) = \\chi'(0)$. Setting $\\omega=0$ in the derived relation yields:\n$$\n\\chi'(0) - \\chi_{\\infty} = \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' \\chi''(\\omega')}{(\\omega')^2 - 0^2} d\\omega' = \\frac{2}{\\pi} \\int_{0}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega'} d\\omega'\n$$\nThe principal value is no longer necessary, as the singularity at $\\omega' = 0$ is removed. For a physical system, the imaginary part of susceptibility near zero frequency typically behaves as $\\chi''(\\omega') \\propto \\omega'$, making the integrand $\\chi''(\\omega')/\\omega'$ finite at $\\omega'=0$ and the integral convergent. The problem defines $\\Delta\\chi$ as the amplitude, which corresponds to the static contribution from the resonance, so $\\chi(0) = \\chi_{\\infty} + \\Delta\\chi$. Therefore, the sum rule relates $\\Delta\\chi$ to the integral over the dissipative part across all positive frequencies:\n$$\n\\Delta\\chi = \\chi'(0) - \\chi_{\\infty} = \\frac{2}{\\pi} \\int_{0}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega'} d\\omega'\n$$\n\n### Task 3: Numerical Implementation and Verification\n\n**Analytical Model**\nTo generate the \"measured\" $\\chi''(\\omega)$ data and provide an exact solution for $\\chi'(\\omega)$ for verification, we must choose a specific functional form for $\\chi(\\omega)$ that is consistent with the problem description. A causal single-resonance lineshape with a high-frequency offset is well-described by the Damped Harmonic Oscillator (DHO) model. This model has poles only in the lower-half complex-frequency plane (ensuring causality), satisfies $\\chi(-\\omega) = \\chi^*(\\omega)$, and correctly represents the parameters $\\Delta\\chi$, $\\omega_0$, $\\Gamma$, and $\\chi_{\\infty}$. The DHO susceptibility is:\n$$\n\\chi(\\omega) = \\chi_{\\infty} + \\frac{\\Delta\\chi \\omega_0^2}{\\omega_0^2 - \\omega^2 - i\\omega\\Gamma}\n$$\nSeparating this into real and imaginary parts gives the exact expressions used for generating data and for validation:\n$$\n\\chi'_{\\text{exact}}(\\omega) = \\chi_{\\infty} + \\frac{\\Delta\\chi \\omega_0^2 (\\omega_0^2 - \\omega^2)}{(\\omega_0^2 - \\omega^2)^2 + (\\omega\\Gamma)^2}\n$$\n$$\n\\chi''_{\\text{model}}(\\omega) = \\frac{\\Delta\\chi \\omega_0^2 (\\omega\\Gamma)}{(\\omega_0^2 - \\omega^2)^2 + (\\omega\\Gamma)^2}\n$$\n\n**Numerical Algorithm**\nThe program will perform the following steps for each test case:\n1.  **Grid and Model Data:** A uniform frequency grid of $N=4001$ points is created from $\\omega=0$ to $\\omega_{\\max}=20\\omega_0$. The values of $\\chi''_{\\text{model}}(\\omega)$ are calculated at each grid point to serve as the \"measured\" input data. The exact $\\chi'_{\\text{exact}}(\\omega)$ values are also calculated for later comparison.\n2.  **Kramers-Kronig Reconstruction:** The integral for $\\chi'(\\omega)$ is implemented numerically. For each target frequency $\\omega_i$ on the grid, the integral is computed via the trapezoidal rule over the same grid. The calculation is vectorized for efficiency. A matrix `integrand_matrix[j, i]` is constructed, holding the value of the integrand for $\\omega'=\\omega_j$ and $\\omega=\\omega_i$. To handle the Cauchy Principal Value, the diagonal terms `[i, i]`, where the denominator is zero, are set to $0$. This corresponds to the problem's specified method of \"excluding the self-term\". The integral for each $\\omega_i$ is then the trapezoidal sum of the corresponding column in this matrix.\n3.  **Static Susceptibility Check:** The reconstructed value $\\chi'_{\\text{recon}}(0)$ (the first point of the reconstructed array) is compared to the expected static value $\\chi_{\\infty} + \\Delta\\chi$. The absolute difference is checked against the tolerance of $5 \\times 10^{-3}$.\n4.  **Sum Rule Check:** The sum rule integral $\\frac{2}{\\pi} \\int_{0}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega'} d\\omega'$ is computed numerically. The integrand $\\chi''(\\omega')/\\omega'$ has a removable singularity at $\\omega'=0$. Its limit as $\\omega' \\to 0$ is $\\Delta\\chi \\Gamma / \\omega_0^2$. This value is used for the first point of the integrand array. The integral is then computed using the trapezoidal rule and the result is compared to $\\Delta\\chi$ with a tolerance of $5 \\times 10^{-3}$.\n5.  **Reconstruction Accuracy Check:** The maximum absolute error between the reconstructed spectrum $\\chi'_{\\text{recon}}(\\omega)$ and the analytical solution $\\chi'_{\\text{exact}}(\\omega)$ is calculated across all grid points. This error is checked against the tolerance of $10^{-2}$.\n\nFinally, the boolean outcomes of these three checks are reported for each test case. It is noted that for Test Case 2, the damping $\\Gamma = 0.005\\omega_0$ is very small, resulting in an extremely sharp resonance. The grid spacing $d\\omega = 20\\omega_0 / 4000 = 0.005\\omega_0$ is equal to the approximate full-width-at-half-maximum of the resonance peak. This coarse sampling relative to the feature size is expected to introduce significant numerical error in the trapezoidal integration, potentially causing the checks for this case to fail.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing the real part of magnetic susceptibility from the\n    imaginary part using the Kramers-Kronig relations and verifies the results.\n    \"\"\"\n\n    # Test cases defined by (omega_0 [rad/s], Gamma [fraction of omega_0], Delta_chi, Chi_infinity)\n    test_cases = [\n        (2 * np.pi * 1e10, 0.05, 1.2, 0.15),\n        (2 * np.pi * 5e9, 0.005, 0.8, 0.10),\n        (2 * np.pi * 1.5e10, 0.5, 2.0, 0.05),\n    ]\n\n    # Numerical parameters\n    N = 4001  # Number of points in the frequency grid\n\n    # Tolerances for checks\n    kk_tolerance = 1e-2\n    sum_rule_tolerance = 5e-3\n    static_tolerance = 5e-3\n    \n    results = []\n\n    for case in test_cases:\n        w0, gamma_frac, delta_chi, chi_inf = case\n        gamma = gamma_frac * w0\n        w_max = 20 * w0\n\n        # 1. Construct frequency grid and \"measured\" susceptibility data\n        # Using linspace for a uniform grid\n        w_grid = np.linspace(0, w_max, N)\n        \n        # Damped Harmonic Oscillator (DHO) model for susceptibility\n        # Denominator of the resonance term\n        denom_dho = (w0**2 - w_grid**2)**2 + (w_grid * gamma)**2\n        \n        # Avoid division by zero if denom_dho happens to be zero\n        # In practice, with damping gamma  0, this denominator is always positive for real omega.\n        \n        # Exact real part (for validation)\n        chi_p_exact = chi_inf + (delta_chi * w0**2 * (w0**2 - w_grid**2)) / denom_dho\n        \n        # \"Measured\" imaginary part (input for reconstruction)\n        chi_pp_measured = (delta_chi * w0**2 * (w_grid * gamma)) / denom_dho\n\n        # 2. Reconstruct the real part chi'(w) using Kramers-Kronig\n        \n        # Vectorized calculation of the principal value integral.\n        # Let w_prime be the integration variable (rows, axis=0)\n        # Let w be the evaluation point (columns, axis=1)\n        w_prime_col = w_grid[:, np.newaxis]\n        \n        # Denominator for the KK integrand: (w_prime^2 - w^2)\n        kk_denom = w_prime_col**2 - w_grid**2\n        \n        # Prevent division by zero on the diagonal. The value here does not matter\n        # as the corresponding integrand values will be set to zero.\n        np.fill_diagonal(kk_denom, 1.0)\n        \n        # Numerator for the KK integrand: 2 * w_prime * chi_pp(w_prime)\n        kk_num = 2 * w_prime_col * chi_pp_measured[:, np.newaxis]\n        \n        integrand_matrix = kk_num / kk_denom\n        \n        # Handle the principal value by setting the singular term to 0\n        np.fill_diagonal(integrand_matrix, 0.0)\n        \n        # Integrate each column (for each w) using the trapezoidal rule\n        integral_vals = np.trapz(integrand_matrix, x=w_grid, axis=0)\n        \n        chi_p_reconstructed = chi_inf + (1 / np.pi) * integral_vals\n\n        # 3. Perform the required checks\n        \n        # Check 1: Kramers-Kronig reconstruction accuracy\n        kk_error = np.max(np.abs(chi_p_reconstructed - chi_p_exact))\n        kk_ok = kk_error = kk_tolerance\n        \n        # Check 2: Sum rule verification\n        # Integrand is chi_pp(w') / w'\n        # Handle the removable singularity at w' = 0\n        integrand_sum_rule = np.zeros_like(w_grid)\n        # For w'  0\n        integrand_sum_rule[1:] = chi_pp_measured[1:] / w_grid[1:]\n        # The limit of the integrand as w' - 0 is (Delta_chi * Gamma) / w0^2\n        integrand_sum_rule[0] = (delta_chi * gamma) / (w0**2)\n        \n        sum_rule_integral = (2 / np.pi) * np.trapz(integrand_sum_rule, x=w_grid)\n        sum_rule_diff = np.abs(sum_rule_integral - delta_chi)\n        sum_rule_ok = sum_rule_diff = sum_rule_tolerance\n        \n        # Check 3: Static susceptibility reconstruction\n        # The reconstructed static value is the first element of the array\n        chi_p_static_recon = chi_p_reconstructed[0]\n        # The exact static value is chi_inf + delta_chi\n        static_diff = np.abs(chi_p_static_recon - (chi_inf + delta_chi))\n        static_ok = static_diff = static_tolerance\n\n        # Collect boolean results for the current case\n        results.append([kk_ok, sum_rule_ok, static_ok])\n\n    # Final print statement in the exact required format\n    # Convert boolean to lowercase string 'true' or 'false'\n    formatted_results = [\n        f\"[{str(r[0]).lower()},{str(r[1]).lower()},{str(r[2]).lower()}]\" \n        for r in results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2995419"}]}