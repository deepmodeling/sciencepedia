{"hands_on_practices": [{"introduction": "Understanding the Cooper instability begins with a foundational calculation: the derivation of the superconducting critical temperature, $T_c$. This exercise [@problem_id:2977400] guides you through the canonical Bardeen–Cooper–Schrieffer (BCS) formalism for a simple attractive interaction. By solving the linearized gap equation, you will see firsthand how an arbitrarily weak attraction between electrons near the Fermi surface invariably leads to a phase transition, revealing the famous exponential dependence of $T_c$ on the coupling strength.", "problem": "Consider electrons in a three-dimensional metal with a constant single-spin density of states at the Fermi level, denoted by $N(0)$, interacting via a separable isotropic $s$-wave attraction that is nonzero only within an energy shell of width $\\hbar \\omega_D$ around the Fermi energy. The interaction is\n$$\nV_{\\mathbf{k}\\mathbf{k}'}=-V\\,\\Theta\\!\\left(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|\\right)\\Theta\\!\\left(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|\\right),\n$$\nwhere $V>0$, $\\omega_D$ is the Debye angular frequency, $\\xi_{\\mathbf{k}}$ is the single-particle energy measured relative to the Fermi level, and $\\Theta(x)$ is the Heaviside step function.\n\nStarting from the mean-field Bardeen–Cooper–Schrieffer (BCS) self-consistency condition linearized at the transition temperature $T_c$, and using the normal-state Green’s function $G(\\mathbf{k},i\\epsilon_n)=\\left(i\\epsilon_n-\\xi_{\\mathbf{k}}\\right)^{-1}$ with fermionic Matsubara energies $\\epsilon_n=(2n+1)\\pi k_B T$, derive the criterion for the Cooper instability and solve it in the weak-coupling limit $0<N(0)V\\ll 1$ to obtain a closed-form analytic expression for the critical temperature. You may assume $k_B T_c\\ll \\hbar \\omega_D$ so that the relevant Matsubara sum has a large upper cutoff index, and you may use well-known properties of the digamma function $\\psi(z)$ and the Euler–Mascheroni constant $\\gamma$ where appropriate.\n\nAnswer specification:\n- Provide your final result as a single closed-form analytic expression for the dimensionless ratio $k_B T_c/(\\hbar \\omega_D)$ in terms of $N(0)V$ and fundamental constants.\n- Do not substitute numerical values for constants and do not round; no significant-figure instruction applies because the answer is fully analytic.\n- Do not include any units inside your final boxed answer.", "solution": "The starting point for determining the superconducting transition temperature $T_c$ is the linearized Bardeen–Cooper–Schrieffer (BCS) gap equation. In the Matsubara formalism, this equation describes the condition for the onset of a non-trivial solution for the superconducting gap $\\Delta_{\\mathbf{k}}$ at $T=T_c$. The equation is an eigenvalue problem, and the instability occurs when the largest eigenvalue reaches $1$. It is given by:\n$$\n\\Delta_{\\mathbf{k}} = - k_B T_c \\sum_{\\mathbf{k}', n} V_{\\mathbf{k}\\mathbf{k}'} G(\\mathbf{k}', i\\epsilon_n) G(-\\mathbf{k}', -i\\epsilon_n) \\Delta_{\\mathbf{k}'}\n$$\nwhere $\\epsilon_n = (2n+1)\\pi k_B T_c$ are the fermionic Matsubara frequencies for integer $n$, and $G(\\mathbf{k}, i\\epsilon_n) = (i\\epsilon_n - \\xi_{\\mathbf{k}})^{-1}$ is the normal-state Green's function. The single-particle energy $\\xi_{\\mathbf{k}}$ is measured relative to the Fermi level, and for an isotropic system, we have $\\xi_{-\\mathbf{k}} = \\xi_{\\mathbf{k}}$. The product of Green's functions is:\n$$\nG(\\mathbf{k}', i\\epsilon_n) G(-\\mathbf{k}', -i\\epsilon_n) = \\frac{1}{i\\epsilon_n - \\xi_{\\mathbf{k}'}} \\frac{1}{-i\\epsilon_n - \\xi_{\\mathbf{k}'}} = \\frac{-1}{(i\\epsilon_n)^2 - \\xi_{\\mathbf{k}'}^2} = \\frac{1}{\\epsilon_n^2 + \\xi_{\\mathbf{k}'}^2}\n$$\nThe interaction potential is given as $V_{\\mathbf{k}\\mathbf{k}'}=-V\\,\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)$, where $V>0$. This separable form implies that the gap parameter $\\Delta_{\\mathbf{k}}$ is constant, $\\Delta_0$, for states within the energy shell $|\\xi_{\\mathbf{k}}| < \\hbar\\omega_D$ and zero otherwise.\n$$\n\\Delta_{\\mathbf{k}} = \\Delta_0 \\, \\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)\n$$\nSubstituting these into the gap equation, we can consider a state $\\mathbf{k}$ with $|\\xi_{\\mathbf{k}}| < \\hbar\\omega_D$, for which $\\Delta_{\\mathbf{k}} = \\Delta_0$.\n$$\n\\Delta_0 = - k_B T_c \\sum_{\\mathbf{k}', n} \\left[-V\\,\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)\\right] \\left(\\frac{1}{\\epsilon_n^2 + \\xi_{\\mathbf{k}'}^2}\\right) \\Delta_0 \\, \\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)\n$$\nSince $T_c$ corresponds to the temperature where a non-zero solution $\\Delta_0 \\neq 0$ first appears, we can divide by $\\Delta_0$. The condition $\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)=1$ is already satisfied on the left-hand side. The term $\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)$ is just $\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)$.\n$$\n1 = V k_B T_c \\sum_{\\mathbf{k}', n} \\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|) \\frac{1}{\\epsilon_n^2 + \\xi_{\\mathbf{k}'}^2}\n$$\nThis equation is the criterion for the Cooper instability. To solve it, we convert the sum over momentum states $\\mathbf{k}'$ to an integral over energy, weighted by the single-spin density of states, $N(0)$. The sum $\\sum_{\\mathbf{k}'}$ becomes $\\int N(\\xi') d\\xi'$. The problem states $N(\\xi')$ can be taken as constant, $N(0)$, within the energy shell.\n$$\n1 = V N(0) k_B T_c \\sum_{n=-\\infty}^{\\infty} \\int_{-\\hbar\\omega_D}^{\\hbar\\omega_D} d\\xi' \\frac{1}{\\epsilon_n^2 + (\\xi')^2}\n$$\nWe first perform the integral over $\\xi'$:\n$$\n\\int_{-\\hbar\\omega_D}^{\\hbar\\omega_D} \\frac{d\\xi'}{\\epsilon_n^2 + (\\xi')^2} = \\left[ \\frac{1}{|\\epsilon_n|} \\arctan\\left(\\frac{\\xi'}{|\\epsilon_n|}\\right) \\right]_{-\\hbar\\omega_D}^{\\hbar\\omega_D} = \\frac{2}{|\\epsilon_n|} \\arctan\\left(\\frac{\\hbar\\omega_D}{|\\epsilon_n|}\\right)\n$$\nSubstituting this back, the criterion becomes:\n$$\n1 = V N(0) k_B T_c \\sum_{n=-\\infty}^{\\infty} \\frac{2}{|\\epsilon_n|} \\arctan\\left(\\frac{\\hbar\\omega_D}{|\\epsilon_n|}\\right)\n$$\nThe terms in the sum are identical for $n$ and $-n-1$ since $|\\epsilon_n| = |\\epsilon_{-n-1}| = (2n+1)\\pi k_B T_c$ for $n \\ge 0$. Thus, the sum over all integers can be written as twice the sum over non-negative integers.\n$$\n1 = V N(0) k_B T_c \\cdot 2 \\sum_{n=0}^{\\infty} \\frac{2}{\\epsilon_n} \\arctan\\left(\\frac{\\hbar\\omega_D}{\\epsilon_n}\\right)\n$$\nLet $\\lambda = N(0)V$ be the dimensionless coupling constant. Substituting $\\epsilon_n = (2n+1)\\pi k_B T_c$:\n$$\n\\frac{1}{\\lambda} = 4 k_B T_c \\sum_{n=0}^{\\infty} \\frac{1}{(2n+1)\\pi k_B T_c} \\arctan\\left(\\frac{\\hbar\\omega_D}{(2n+1)\\pi k_B T_c}\\right)\n$$\n$$\n\\frac{1}{\\lambda} = \\frac{4}{\\pi} \\sum_{n=0}^{\\infty} \\frac{1}{2n+1} \\arctan\\left(\\frac{\\hbar\\omega_D}{(2n+1)\\pi k_B T_c}\\right)\n$$\nWe solve this equation in the weak-coupling limit, $0 < \\lambda \\ll 1$, for which $1/\\lambda$ is large. This requires the sum on the right to be large, which implies that the argument of the arctangent function is large for many terms. This corresponds to the assumption $k_B T_c \\ll \\hbar\\omega_D$.\nLet us define a cutoff index $n_D$ where the energy of the Matsubara frequency becomes comparable to the Debye energy cutoff: $(2n_D+1)\\pi k_B T_c \\approx \\hbar\\omega_D$. For $n \\ll n_D$, the argument of arctan is large, and we can approximate $\\arctan(x) \\approx \\pi/2$. For $n \\gg n_D$, the argument is small, and the terms in the sum become negligible. We thus approximate the sum by taking $\\arctan \\approx \\pi/2$ and summing up to $n_D-1$.\n$$\n\\frac{1}{\\lambda} \\approx \\frac{4}{\\pi} \\sum_{n=0}^{n_D-1} \\frac{1}{2n+1} \\left(\\frac{\\pi}{2}\\right) = 2 \\sum_{n=0}^{n_D-1} \\frac{1}{2n+1}\n$$\nThe sum can be approximated using the asymptotic formula involving the Euler–Mascheroni constant, $\\gamma \\approx 0.577$:\n$$\n\\sum_{k=0}^{N-1} \\frac{1}{2k+1} \\approx \\frac{1}{2}\\ln(N) + \\frac{\\ln(4)+\\gamma}{2}\n$$\nApplying this to our sum with $N=n_D$:\n$$\n\\frac{1}{\\lambda} \\approx 2 \\left( \\frac{1}{2}\\ln(n_D) + \\frac{\\ln(4)+\\gamma}{2} \\right) = \\ln(n_D) + \\ln(4) + \\gamma = \\ln(4n_D) + \\gamma\n$$\nFrom the definition of the cutoff index, $2n_D\\pi k_B T_c \\approx \\hbar\\omega_D$, we have $n_D \\approx \\frac{\\hbar\\omega_D}{2\\pi k_B T_c}$. Substituting this into the equation for $1/\\lambda$:\n$$\n\\frac{1}{\\lambda} \\approx \\ln\\left(4 \\cdot \\frac{\\hbar\\omega_D}{2\\pi k_B T_c}\\right) + \\gamma = \\ln\\left(\\frac{2\\hbar\\omega_D}{\\pi k_B T_c}\\right) + \\gamma\n$$\nNow, we solve for $T_c$:\n$$\n\\frac{1}{\\lambda} - \\gamma = \\ln\\left(\\frac{2\\hbar\\omega_D}{\\pi k_B T_c}\\right)\n$$\nExponentiating both sides:\n$$\n\\exp\\left(\\frac{1}{\\lambda} - \\gamma\\right) = \\frac{2\\hbar\\omega_D}{\\pi k_B T_c}\n$$\n$$\nk_B T_c = \\frac{2\\hbar\\omega_D}{\\pi} \\exp\\left(\\gamma - \\frac{1}{\\lambda}\\right) = \\frac{2e^{\\gamma}}{\\pi} \\hbar\\omega_D \\exp\\left(-\\frac{1}{\\lambda}\\right)\n$$\nSubstituting back $\\lambda = N(0)V$:\n$$\nk_B T_c = \\frac{2e^{\\gamma}}{\\pi} \\hbar\\omega_D \\exp\\left(-\\frac{1}{N(0)V}\\right)\n$$\nThe problem asks for the dimensionless ratio $k_B T_c / (\\hbar\\omega_D)$.\n$$\n\\frac{k_B T_c}{\\hbar\\omega_D} = \\frac{2e^{\\gamma}}{\\pi} \\exp\\left(-\\frac{1}{N(0)V}\\right)\n$$\nThis is the celebrated BCS formula for the critical temperature in the weak-coupling limit.", "answer": "$$\\boxed{\\frac{2e^{\\gamma}}{\\pi}\\exp\\left(-\\frac{1}{N(0)V}\\right)}$$", "id": "2977400"}, {"introduction": "While the simple $s$-wave model is instructive, real materials often feature more complex, anisotropic interactions that can lead to unconventional pairing symmetries. This practice [@problem_id:2977330] generalizes the gap equation to a scenario with competing $s$-wave and $d$-wave pairing channels. Formulating the problem in matrix form allows you to find the dominant instability by identifying the largest eigenvalue of the pairing kernel, a powerful technique essential for predicting the gap structure in modern superconductors.", "problem": "Consider a single-band, isotropic $2$-dimensional metal with a circular Fermi surface and a constant density of states $N(0)$ per spin at the Fermi level. In the particle-particle (Cooper) channel, the effective interaction is assumed to be separable and to mix the leading $s$-wave and $d$-wave harmonics according to\n$$\nV(\\mathbf{k},\\mathbf{k}') \\equiv -\\Big[g_{s}\\,\\phi_{s}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')+g_{d}\\,\\phi_{d}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+g_{m}\\,\\big(\\phi_{s}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+\\phi_{d}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')\\big)\\Big],\n$$\nwhere $g_{s}$, $g_{d}$, and $g_{m}$ are real, temperature-independent coupling constants. The basis functions are taken to be orthonormal on the Fermi surface, with $\\phi_{s}(\\mathbf{k}) \\equiv 1$ and $\\phi_{d}(\\mathbf{k}) \\equiv \\sqrt{2}\\cos(2\\theta_{\\mathbf{k}})$ for a Fermi surface angle $\\theta_{\\mathbf{k}}$, satisfying $\\langle \\phi_{i}\\phi_{j}\\rangle_{\\mathrm{FS}}=\\delta_{ij}$, where $\\langle \\cdots \\rangle_{\\mathrm{FS}}$ denotes the Fermi-surface average.\n\nNear the superconducting transition, the linearized Bardeen–Cooper–Schrieffer (BCS) gap equation for the gap function $\\Delta(\\mathbf{k})$ at temperature $T$ is\n$$\n\\Delta(\\mathbf{k})=-\\sum_{\\mathbf{k}'}V(\\mathbf{k},\\mathbf{k}')\\,\\frac{\\tanh\\!\\big(\\xi_{\\mathbf{k}'}/(2T)\\big)}{2\\,\\xi_{\\mathbf{k}'}}\\,\\Delta(\\mathbf{k}'),\n$$\nwhere $\\xi_{\\mathbf{k}}$ is the single-particle energy relative to the Fermi level. Assume an energy cutoff $\\omega_{c}$ common to both harmonics and define the logarithmic Cooper integral\n$$\n\\mathcal{I}(T)\\equiv \\int_{0}^{\\omega_{c}}\\mathrm{d}\\xi\\,\\frac{\\tanh\\!\\big(\\xi/(2T)\\big)}{\\xi}.\n$$\nAssume the gap has the form $\\Delta(\\mathbf{k})=\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k})$, derive the coupled eigenvalue equations that determine the onset of pairing, and cast them as a $2\\times 2$ eigenvalue problem for the vector $(\\Delta_{s},\\Delta_{d})^{\\top}$. Using only the assumptions stated above, determine explicitly the largest eigenvalue $\\lambda_{\\max}$ of the resulting dimensionless pairing kernel in terms of $g_{s}$, $g_{d}$, $g_{m}$, $N(0)$, and $\\mathcal{I}(T)$.\n\nYour final answer must be a single closed-form symbolic expression for $\\lambda_{\\max}$. No numerical evaluation is required and no units are needed.", "solution": "The starting point is the linearized Bardeen–Cooper–Schrieffer (BCS) gap equation near the superconducting transition temperature $T$:\n$$\n\\Delta(\\mathbf{k})=-\\sum_{\\mathbf{k}'}V(\\mathbf{k},\\mathbf{k}')\\,\\frac{\\tanh\\!\\big(\\xi_{\\mathbf{k}'}/(2T)\\big)}{2\\,\\xi_{\\mathbf{k}'}}\\,\\Delta(\\mathbf{k}')\n$$\nHere, $\\Delta(\\mathbf{k})$ is the superconducting gap function, $V(\\mathbf{k},\\mathbf{k}')$ is the effective interaction potential, and $\\xi_{\\mathbf{k}'}$ is the single-particle energy relative to the Fermi level.\n\nWe are given the ansatz for the gap function as a linear combination of an $s$-wave component and a $d$-wave component:\n$$\n\\Delta(\\mathbf{k})=\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k})\n$$\nThe interaction potential is given as a separable form:\n$$\nV(\\mathbf{k},\\mathbf{k}') = -\\Big[g_{s}\\,\\phi_{s}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')+g_{d}\\,\\phi_{d}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+g_{m}\\,\\big(\\phi_{s}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+\\phi_{d}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')\\big)\\Big]\n$$\nThe sum over momentum states $\\mathbf{k}'$ can be converted into an integral over energy and an average over the Fermi surface. Assuming a constant density of states $N(0)$ per spin near the Fermi level, this conversion is $\\sum_{\\mathbf{k}'} \\to \\int \\mathrm{d}\\xi' N(\\xi') \\langle \\dots \\rangle_{\\mathrm{FS}} \\approx N(0)\\int \\mathrm{d}\\xi' \\langle \\dots \\rangle_{\\mathrm{FS}}$. The energy integral is restricted to a window $[-\\omega_{c}, \\omega_{c}]$ around the Fermi level. The relevant integral over energy is\n$$\n\\int_{-\\omega_{c}}^{\\omega_{c}} \\mathrm{d}\\xi' \\frac{\\tanh(\\xi'/(2T))}{2\\xi'} = 2 \\int_{0}^{\\omega_{c}} \\mathrm{d}\\xi' \\frac{\\tanh(\\xi'/(2T))}{2\\xi'} = \\int_{0}^{\\omega_{c}} \\mathrm{d}\\xi' \\frac{\\tanh(\\xi'/(2T))}{\\xi'} \\equiv \\mathcal{I}(T)\n$$\nThe gap equation thus becomes an integral equation over the Fermi surface:\n$$\n\\Delta(\\mathbf{k}) = N(0)\\,\\mathcal{I}(T) \\left\\langle \\Big[g_{s}\\,\\phi_{s}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')+g_{d}\\,\\phi_{d}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+g_{m}\\,\\big(\\phi_{s}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+\\phi_{d}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')\\big)\\Big] \\Delta(\\mathbf{k}') \\right\\rangle_{\\mathrm{FS}(\\mathbf{k}')}\n$$\nwhere $\\langle \\dots \\rangle_{\\mathrm{FS}(\\mathbf{k}')}$ denotes the average over the momentum direction $\\mathbf{k}'$ on the Fermi surface.\n\nWe substitute the ansatz for $\\Delta(\\mathbf{k}')$ into the equation:\n$$\n\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}) = N(0)\\,\\mathcal{I}(T) \\left\\langle \\Big[ \\dots \\Big] \\Big[\\Delta_{s}\\,\\phi_{s}(\\mathbf{k}')+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}')\\Big] \\right\\rangle_{\\mathrm{FS}(\\mathbf{k}')}\n$$\nThe Fermi-surface average is evaluated using the orthonormality of the basis functions, $\\langle \\phi_{i}(\\mathbf{k}')\\phi_{j}(\\mathbf{k}')\\rangle_{\\mathrm{FS}} = \\delta_{ij}$. The terms within the average expand as follows:\n\\begin{align*}\n& \\left\\langle \\Big[ \\dots \\Big] \\Big[\\Delta_{s}\\,\\phi_{s}(\\mathbf{k}')+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}')\\Big] \\right\\rangle_{\\mathrm{FS}(\\mathbf{k}')} \\\\\n=\\ & g_{s}\\phi_{s}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{s}^{2}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{s}\\phi_{d}\\rangle_{\\mathrm{FS}}\\Big) + g_{d}\\phi_{d}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{d}\\phi_{s}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{d}^{2}\\rangle_{\\mathrm{FS}}\\Big) \\\\\n& + g_{m}\\phi_{s}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{d}\\phi_{s}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{d}^{2}\\rangle_{\\mathrm{FS}}\\Big) + g_{m}\\phi_{d}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{s}^{2}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{s}\\phi_{d}\\rangle_{\\mathrm{FS}}\\Big) \\\\\n=\\ & g_{s}\\phi_{s}(\\mathbf{k}) (\\Delta_{s} \\cdot 1 + \\Delta_{d} \\cdot 0) + g_{d}\\phi_{d}(\\mathbf{k}) (\\Delta_{s} \\cdot 0 + \\Delta_{d} \\cdot 1) \\\\\n& + g_{m}\\phi_{s}(\\mathbf{k}) (\\Delta_{s} \\cdot 0 + \\Delta_{d} \\cdot 1) + g_{m}\\phi_{d}(\\mathbf{k}) (\\Delta_{s} \\cdot 1 + \\Delta_{d} \\cdot 0) \\\\\n=\\ & (g_{s}\\Delta_{s} + g_{m}\\Delta_{d})\\phi_{s}(\\mathbf{k}) + (g_{m}\\Delta_{s} + g_{d}\\Delta_{d})\\phi_{d}(\\mathbf{k})\n\\end{align*}\nInserting this result into the gap equation gives:\n$$\n\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}) = N(0)\\,\\mathcal{I}(T) \\Big[ (g_{s}\\Delta_{s} + g_{m}\\Delta_{d})\\phi_{s}(\\mathbf{k}) + (g_{m}\\Delta_{s} + g_{d}\\Delta_{d})\\phi_{d}(\\mathbf{k}) \\Big]\n$$\nBy linear independence of the basis functions $\\phi_{s}(\\mathbf{k})$ and $\\phi_{d}(\\mathbf{k})$, we can equate their coefficients on both sides of the equation. This yields a system of two coupled linear equations for $\\Delta_{s}$ and $\\Delta_{d}$:\n\\begin{align*}\n\\Delta_{s} &= N(0)\\,\\mathcal{I}(T) (g_{s}\\Delta_{s} + g_{m}\\Delta_{d}) \\\\\n\\Delta_{d} &= N(0)\\,\\mathcal{I}(T) (g_{m}\\Delta_{s} + g_{d}\\Delta_{d})\n\\end{align*}\nThis system can be written as a $2 \\times 2$ matrix eigenvalue problem. Let the vector of gap coefficients be $\\vec{\\Delta} = (\\Delta_{s}, \\Delta_{d})^{\\top}$. The equations become:\n$$\n\\begin{pmatrix} \\Delta_{s} \\\\ \\Delta_{d} \\end{pmatrix} = N(0)\\,\\mathcal{I}(T) \\begin{pmatrix} g_{s} & g_{m} \\\\ g_{m} & g_{d} \\end{pmatrix} \\begin{pmatrix} \\Delta_{s} \\\\ \\Delta_{d} \\end{pmatrix}\n$$\nThis is an eigenvalue equation of the form $\\vec{\\Delta} = \\mathbf{K} \\vec{\\Delta}$, where the matrix $\\mathbf{K}$ is the dimensionless pairing kernel. For a non-trivial solution to exist (i.e., $\\vec{\\Delta} \\neq 0$), the kernel $\\mathbf{K}$ must have an eigenvalue of $1$. The problem asks for the largest eigenvalue, $\\lambda_{\\max}$, of this kernel, which is given by:\n$$\n\\mathbf{K} = N(0)\\,\\mathcal{I}(T) \\begin{pmatrix} g_{s} & g_{m} \\\\ g_{m} & g_{d} \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $\\mathbf{K}$ are related to the eigenvalues $\\mu$ of the matrix $\\mathbf{G} = \\begin{pmatrix} g_{s} & g_{m} \\\\ g_{m} & g_{d} \\end{pmatrix}$ by the scalar factor $\\lambda = N(0)\\,\\mathcal{I}(T)\\,\\mu$. We find the eigenvalues of $\\mathbf{G}$ from its characteristic equation, $\\det(\\mathbf{G} - \\mu\\mathbf{I})=0$:\n$$\n\\det \\begin{pmatrix} g_{s} - \\mu & g_{m} \\\\ g_{m} & g_{d} - \\mu \\end{pmatrix} = (g_{s}-\\mu)(g_{d}-\\mu) - g_{m}^{2} = 0\n$$\nThis quadratic equation for $\\mu$ is $\\mu^{2} - (g_{s}+g_{d})\\mu + (g_{s}g_{d} - g_{m}^{2}) = 0$. The solutions are given by the quadratic formula:\n$$\n\\mu = \\frac{(g_{s}+g_{d}) \\pm \\sqrt{(g_{s}+g_{d})^{2} - 4(g_{s}g_{d} - g_{m}^{2})}}{2} = \\frac{(g_{s}+g_{d}) \\pm \\sqrt{(g_{s}-g_{d})^{2} + 4g_{m}^{2}}}{2}\n$$\nThe largest eigenvalue, $\\mu_{\\max}$, corresponds to the positive sign:\n$$\n\\mu_{\\max} = \\frac{g_{s}+g_{d} + \\sqrt{(g_{s}-g_{d})^{2} + 4g_{m}^{2}}}{2}\n$$\nThe largest eigenvalue of the full dimensionless pairing kernel $\\mathbf{K}$ is therefore $\\lambda_{\\max} = N(0)\\,\\mathcal{I}(T)\\,\\mu_{\\max}$.\n$$\n\\lambda_{\\max} = N(0)\\,\\mathcal{I}(T) \\left(\\frac{g_{s} + g_{d} + \\sqrt{(g_{s} - g_{d})^{2} + 4g_{m}^{2}}}{2}\\right)\n$$\nThe onset of superconductivity occurs at the critical temperature $T_{c}$ determined by the condition $\\lambda_{\\max}(T_{c}) = 1$.", "answer": "$$\\boxed{N(0)\\,\\mathcal{I}(T) \\frac{g_{s} + g_{d} + \\sqrt{(g_{s} - g_{d})^{2} + 4g_{m}^{2}}}{2}}$$", "id": "2977330"}, {"introduction": "Analytical solutions to the gap equation are only possible for the simplest models. To tackle realistic materials, we must turn to numerical methods. This exercise [@problem_id:2977260] provides a hands-on guide to discretizing the Fermi surface and formulating the linearized gap equation as a matrix eigenvalue problem suitable for computational analysis. You will learn the crucial step of constructing a properly weighted, symmetric operator, enabling you to write a robust program that can determine the leading pairing instability for any given interaction.", "problem": "You are asked to design and implement a numerical procedure to determine the onset of the Cooper instability by computing the largest eigenvalue associated with the linearized superconducting gap equation restricted to a discretized Fermi surface. The goal is to derive, from first principles, a mathematically precise operator whose largest eigenvalue governs the instability, and then implement a robust algorithm to compute that largest eigenvalue for several provided cases.\n\nStarting point and fundamental base:\n\n- Consider the Bardeen–Cooper–Schrieffer (BCS) framework, where low-energy quasiparticles on the Fermi surface interact via an effective pairing interaction $V_{\\mathbf{k}\\mathbf{k}'}$.\n- At temperatures near the superconducting transition, linear response theory implies that the gap function $ \\Delta(\\mathbf{k}) $ satisfies a homogeneous linear equation obtained by combining the effective interaction and the normal-state two-particle susceptibility restricted to the Fermi surface.\n- Discretize the Fermi surface into patches indexed by $i$ and approximate surface integrals by weighted sums using quadrature weights. The outcome is a linear operator acting on a vector of patch values of the gap function. The instability is controlled by the largest eigenvalue of this operator.\n\nYour task:\n\n- Derive the weighted, discrete operator that emerges from these principles without assuming any pre-given closed-form expression, explain how it can be reduced to a symmetric matrix acting in a properly weighted inner-product space, and justify why its largest eigenvalue determines the instability.\n- Implement a numerical scheme that:\n  1. Accepts as input a discretized Fermi-surface quadrature via a list of nonnegative weights $w_i$ and a real matrix representation of the interaction $V_{ij}$ between patches $i$ and $j$.\n  2. Constructs the appropriate symmetric matrix whose largest eigenvalue is the physically relevant quantity controlling the instability.\n  3. Computes the largest eigenvalue using a numerically stable algorithm designed for symmetric matrices.\n  4. Handles non-symmetric $V_{ij}$ arising from discretization noise by an appropriate symmetrization justified by physical reciprocity and Hermiticity.\n\nNo physical units are required for the output since the eigenvalue is dimensionless. Angles in any intermediate steps must be in radians if used.\n\nInput and output specification for the program:\n\n- You will be provided a small test suite of parameter sets, each consisting of a matrix $V$ and a list of weights $w$. Your program must, for each case, construct the symmetric operator implied by the derivation and return the largest eigenvalue as a float.\n- The final output must be a single line containing the results as a comma-separated list enclosed in square brackets, for example, $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$.\n\nTest suite to implement and evaluate:\n\n- Case $1$ (happy path, uniform attractive channel): \n  - $N = 4$, $w = [0.3, 0.3, 0.3, 0.3]$,\n  - $V_{ij} = -0.9$ for all $i,j$.\n\n- Case $2$ (boundary condition, zero interaction):\n  - $N = 3$, $w = [0.5, 0.3, 0.2]$,\n  - $V_{ij} = 0$ for all $i,j$.\n\n- Case $3$ (anisotropic channel on a circular Fermi surface with a $d$-wave harmonic):\n  - $N = 8$, $w_i = 1/8$ for $i = 0, \\dots, 7$,\n  - $\\theta_i = 2\\pi i / 8$ in radians,\n  - $V_{ij} = -0.6 \\cos\\!\\left(2(\\theta_i - \\theta_j)\\right)$.\n\n- Case $4$ (non-symmetric discretization noise with anisotropic weights):\n  - $N = 5$, $w = [0.15, 0.05, 0.4, 0.3, 0.1]$,\n  - \n    $V = \n    \\begin{pmatrix}\n    -0.3 & -0.1 & -0.05 & 0.0 & -0.02 \\\\\n    -0.12 & -0.28 & -0.08 & -0.01 & 0.02 \\\\\n    -0.05 & -0.07 & -0.25 & -0.02 & -0.03 \\\\\n    -0.01 & -0.02 & -0.04 & -0.2 & -0.06 \\\\\n    -0.03 & 0.01 & -0.02 & -0.07 & -0.22\n    \\end{pmatrix}\n    $.\n\nYour program should produce a single line of output containing the largest eigenvalues for the four cases in the exact format $[\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4]$, where each $\\lambda_i$ is a float computed from the corresponding case. No additional text should be printed.", "solution": "The problem requires the derivation of a numerical method to identify the onset of the Cooper instability in a superconductor, based on the linearized Bardeen–Cooper–Schrieffer (BCS) gap equation. The core of the task is to formulate a symmetric matrix eigenvalue problem from a discretized representation of the Fermi surface and the pairing interaction, and then to compute its largest eigenvalue.\n\n### Derivation of the Symmetric Operator\n\n1.  **The Linearized Gap Equation**\n\n    The starting point is the BCS gap equation, which determines the superconducting energy gap $\\Delta(\\mathbf{k})$. Near the critical temperature $T_c$, the gap is infinitesimally small, allowing the equation to be linearized. In this limit, it becomes a homogeneous linear integral equation for the gap function evaluated on the Fermi surface ($FS$):\n    $$\n    \\Delta(\\mathbf{k}) = \\lambda_T \\int_{FS} \\left(-V(\\mathbf{k}, \\mathbf{k'})\\right) \\Delta(\\mathbf{k'}) d\\mu(\\mathbf{k'})\n    $$\n    Here, $V(\\mathbf{k}, \\mathbf{k'})$ is the effective pairing interaction between electron states $\\mathbf{k}$ and $\\mathbf{k'}$. An attractive interaction corresponds to $V < 0$. The kernel of the integral operator is therefore taken as $-V(\\mathbf{k}, \\mathbf{k'})$, which is positive for an attractive potential. The coefficient $\\lambda_T > 0$ encapsulates the temperature dependence and material properties like the density of states. Specifically, within BCS theory, $\\lambda_T$ is proportional to $\\ln(1/T)$, where $T$ is the temperature. The term $d\\mu(\\mathbf{k'})$ represents the integration measure over the Fermi surface.\n\n    A non-trivial solution ($\\Delta(\\mathbf{k}) \\not\\equiv 0$) signifying the onset of superconductivity exists only if this eigenvalue equation is satisfied. This occurs when the temperature-dependent term $\\lambda_T$ is such that $1$ becomes an eigenvalue of the operator $\\mathcal{K}$ defined by $(\\mathcal{K}f)(\\mathbf{k}) = \\lambda_T \\int_{FS} (-V(\\mathbf{k}, \\mathbf{k'})) f(\\mathbf{k'}) d\\mu(\\mathbf{k'})$.\n\n    Rearranging the equation into a standard eigenvalue problem:\n    $$\n    \\frac{1}{\\lambda_T} \\Delta(\\mathbf{k}) = \\int_{FS} \\left(-V(\\mathbf{k}, \\mathbf{k'})\\right) \\Delta(\\mathbf{k'}) d\\mu(\\mathbf{k'})\n    $$\n    Let $\\Lambda = 1/\\lambda_T$. The transition to a superconducting state occurs at a critical temperature $T_c$, which is the highest possible temperature for which a non-trivial solution exists. Since $\\lambda_T$ increases as $T$ decreases, maximizing $T_c$ is equivalent to maximizing $\\lambda_T$, which in turn is equivalent to maximizing its corresponding eigenvalue $\\Lambda$. The instability is therefore governed by the largest eigenvalue, $\\Lambda_{max}$, of the integral operator with kernel $-V(\\mathbf{k}, \\mathbf{k'})$.\n\n2.  **Discretization and Matrix Formulation**\n\n    The problem provides a discretized Fermi surface consisting of $N$ patches, with associated positive quadrature weights $w_i$ that approximate the measure $d\\mu(\\mathbf{k})$. The integral equation is thus transformed into a matrix equation. Let $\\Delta_i = \\Delta(\\mathbf{k}_i)$ be the gap on patch $i$ and $V_{ij} = V(\\mathbf{k}_i, \\mathbf{k}_j)$ be the interaction matrix. The discretized eigenvalue equation is:\n    $$\n    \\Lambda \\Delta_i = \\sum_{j=1}^{N} (-V_{ij}) \\Delta_j w_j\n    $$\n    This can be written in matrix form as $\\Lambda \\vec{\\Delta} = K \\vec{\\Delta}$, where the matrix $K$ has elements $K_{ij} = (-V_{ij}) w_j$. This matrix $K$ is generally not symmetric because of the factor $w_j$, which complicates the eigenvalue calculation and can lead to numerical instabilities.\n\n3.  **Symmetrization of the Eigenvalue Problem**\n\n    To obtain a more robust numerical problem, we transform this into an equivalent problem for a symmetric matrix. This is achieved by working in a properly weighted inner product space. We define a new vector $\\vec{\\psi}$ whose components are $\\psi_i = \\sqrt{w_i} \\Delta_i$. This assumes all weights are non-negative, $w_i \\ge 0$, as specified. If $w_i > 0$, we have $\\Delta_i = \\psi_i / \\sqrt{w_i}$. Substituting this into the discretized equation:\n    $$\n    \\Lambda \\frac{\\psi_i}{\\sqrt{w_i}} = \\sum_{j=1}^{N} (-V_{ij}) \\left(\\frac{\\psi_j}{\\sqrt{w_j}}\\right) w_j = \\sum_{j=1}^{N} (-V_{ij}) \\sqrt{w_j} \\psi_j\n    $$\n    Multiplying both sides by $\\sqrt{w_i}$ yields:\n    $$\n    \\Lambda \\psi_i = \\sum_{j=1}^{N} \\left( \\sqrt{w_i} (-V_{ij}) \\sqrt{w_j} \\right) \\psi_j\n    $$\n    This is a standard eigenvalue problem $\\Lambda \\vec{\\psi} = S \\vec{\\psi}$, where the matrix $S$ has elements:\n    $$\n    S_{ij} = \\sqrt{w_i} (-V_{ij}) \\sqrt{w_j}\n    $$\n    The eigenvalues $\\Lambda$ of $S$ are identical to those of the original non-symmetric matrix $K$. The fundamental physical principle of reciprocity requires that the interaction potential be Hermitian. For a real potential, this implies symmetry: $V(\\mathbf{k}, \\mathbf{k'}) = V(\\mathbf{k'}, \\mathbf{k})$, so $V_{ij} = V_{ji}$. If $V$ is symmetric, then $S$ is also symmetric:\n    $$\n    S_{ji} = \\sqrt{w_j} (-V_{ji}) \\sqrt{w_i} = \\sqrt{w_j} (-V_{ij}) \\sqrt{w_i} = S_{ij}\n    $$\n    The problem of finding the largest eigenvalue of this real, symmetric matrix $S$ is well-posed and can be solved efficiently with stable numerical algorithms.\n\n4.  **Handling Non-Symmetric Discretization Noise**\n\n    In practice, the provided interaction matrix $V$ may not be perfectly symmetric due to numerical errors or discretization artifacts. Since the underlying physical interaction must be symmetric, any anti-symmetric component is unphysical noise. We can filter out this noise by replacing $V$ with its symmetric part, $V^{\\text{sym}}$:\n    $$\n    V^{\\text{sym}}_{ij} = \\frac{V_{ij} + V_{ji}}{2}\n    $$\n    Our final symmetric matrix is therefore $S_{ij} = \\sqrt{w_i} (-V^{\\text{sym}}_{ij}) \\sqrt{w_j}$.\n\n### Numerical Implementation Strategy\n\nThe procedure to calculate the largest eigenvalue for each test case is as follows:\n1.  Given the input matrix $V$ and the vector of weights $w$.\n2.  Construct the symmetrized interaction matrix $V^{\\text{sym}} = (V + V^T)/2$.\n3.  Define the kernel of the eigenvalue problem as $K = -V^{\\text{sym}}$.\n4.  Construct the final symmetric matrix $S$ with elements $S_{ij} = \\sqrt{w_i} K_{ij} \\sqrt{w_j}$. This can be performed efficiently using matrix multiplication: $S = \\text{diag}(\\sqrt{w}) \\cdot K \\cdot \\text{diag}(\\sqrt{w})$.\n5.  Compute the eigenvalues of the real symmetric matrix $S$ using a numerically stable algorithm, such as the one provided by `numpy.linalg.eigh`.\n6.  The result is the maximum value among the computed real eigenvalues.\n\nThis procedure is applied to each of the four test cases provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_max_eigenvalue(V_in, w_in):\n    \"\"\"\n    Computes the largest eigenvalue governing the Cooper instability.\n\n    Args:\n        V_in (list of lists of floats): The pairing interaction matrix V_ij.\n        w_in (list of floats): The quadrature weights w_i.\n\n    Returns:\n        float: The largest eigenvalue of the symmetrized operator.\n    \"\"\"\n    # Convert inputs to numpy arrays for efficient computation.\n    V = np.array(V_in, dtype=float)\n    w = np.array(w_in, dtype=float)\n\n    # 1. Symmetrize the interaction matrix V to remove unphysical noise.\n    # V_sym = (V + V.T) / 2\n    V_sym = 0.5 * (V + V.T)\n\n    # 2. Define the kernel of the eigenvalue problem, which is -V for\n    #    an attractive interaction.\n    kernel = -V_sym\n\n    # 3. Construct the symmetric matrix S = sqrt(w_i) * kernel_ij * sqrt(w_j).\n    # This can be done efficiently via matrix multiplication.\n    # Let sqrt_w_diag be a diagonal matrix with sqrt(w_i) on the diagonal.\n    # Then S = sqrt_w_diag @ kernel @ sqrt_w_diag.\n    sqrt_w = np.sqrt(w)\n    # Using broadcasting for an efficient element-wise multiplication\n    # S_ij = kernel_ij * sqrt(w_i) * sqrt(w_j)\n    S = kernel * np.outer(sqrt_w, sqrt_w)\n\n    # 4. Compute the eigenvalues of the real symmetric matrix S.\n    # numpy.linalg.eigh is specialized for Hermitian (or real symmetric)\n    # matrices and is numerically stable. It returns eigenvalues in\n    # ascending order.\n    eigenvalues = np.linalg.eigh(S)[0]\n\n    # 5. The instability is governed by the largest (most positive) eigenvalue.\n    # Since eigh returns them sorted, the largest is the last one.\n    # Using np.max() is also robust in case the sorting order isn't guaranteed.\n    max_eigenvalue = np.max(eigenvalues)\n\n    return max_eigenvalue\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the results.\n    \"\"\"\n    # Case 1 (happy path, uniform attractive channel):\n    N1 = 4\n    w1 = [0.3, 0.3, 0.3, 0.3]\n    V1 = [[-0.9 for _ in range(N1)] for _ in range(N1)]\n\n    # Case 2 (boundary condition, zero interaction):\n    N2 = 3\n    w2 = [0.5, 0.3, 0.2]\n    V2 = [[0.0 for _ in range(N2)] for _ in range(N2)]\n    \n    # Case 3 (anisotropic channel on a circular Fermi surface):\n    N3 = 8\n    w3 = [1/8 for _ in range(N3)]\n    thetas3 = [2 * np.pi * i / N3 for i in range(N3)]\n    V3 = np.zeros((N3, N3))\n    for i in range(N3):\n        for j in range(N3):\n            V3[i, j] = -0.6 * np.cos(2 * (thetas3[i] - thetas3[j]))\n\n    # Case 4 (non-symmetric discretization noise with anisotropic weights):\n    w4 = [0.15, 0.05, 0.4, 0.3, 0.1]\n    V4 = [\n        [-0.3, -0.1, -0.05, 0.0, -0.02],\n        [-0.12, -0.28, -0.08, -0.01, 0.02],\n        [-0.05, -0.07, -0.25, -0.02, -0.03],\n        [-0.01, -0.02, -0.04, -0.2, -0.06],\n        [-0.03, 0.01, -0.02, -0.07, -0.22]\n    ]\n\n    test_cases = [\n        (V1, w1),\n        (V2, w2),\n        (V3, w3),\n        (V4, w4)\n    ]\n\n    results = []\n    for V, w in test_cases:\n        result = compute_max_eigenvalue(V, w)\n        # Rounding close-to-zero results for clean output.\n        if np.isclose(result, 0):\n            results.append(0.0)\n        else:\n            results.append(result)\n\n    # Final print statement in the exact required format.\n    # The output format is a comma-separated list of floats inside square brackets.\n    # Using repr() to ensure accurate float representation without losing precision.\n    print(f\"[{','.join(map(repr, results))}]\")\n\nsolve()\n```", "id": "2977260"}]}