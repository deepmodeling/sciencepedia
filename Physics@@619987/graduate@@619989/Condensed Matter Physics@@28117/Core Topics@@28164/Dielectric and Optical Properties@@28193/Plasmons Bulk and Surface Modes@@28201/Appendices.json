{"hands_on_practices": [{"introduction": "The concept of a surface plasmon begins with the idea of a collective electron oscillation confined to an interface. This first exercise explores the fundamental case of a surface plasmon at a metal-dielectric boundary in the non-retarded (or electrostatic) limit, where the wavelength is very short. By applying electrostatic principles and electromagnetic boundary conditions, we can derive the existence condition for such a mode and its characteristic frequency, providing a foundational understanding of this surface-bound wave [@problem_id:3010379].", "problem": "A semi-infinite Drude metal occupies the half-space $z<0$ and is adjacent to a lossless, dispersionless dielectric of relative permittivity $\\varepsilon_{d}$ occupying $z>0$. The metal is described by a collisionless Drude dielectric response with an interband background, so that its relative permittivity is $\\varepsilon_{m}(\\omega)=\\varepsilon_{\\infty}-\\omega_{p}^{2}/\\omega^{2}$, where $\\varepsilon_{\\infty}>1$ accounts for high-frequency polarization of bound charges and $\\omega_{p}$ is the bare plasma frequency of the conduction electrons. Consider longitudinal surface charge oscillations at the planar interface $z=0$ in the non-retarded (electrostatic) limit, where the wavelength along the interface is much shorter than any electromagnetic retardation scale.\n\nStarting from the electrostatic equation $\\nabla\\cdot\\left(\\varepsilon(\\omega)\\nabla\\phi\\right)=0$ in each medium and the boundary conditions that the scalar potential $\\phi$ is continuous and the normal component of the electric displacement $\\mathbf{D}=\\varepsilon(\\omega)\\varepsilon_{0}\\mathbf{E}$ is continuous at $z=0$, derive the existence condition for a bound interfacial mode and obtain the surface plasmon frequency $\\omega_{s}$ as a closed-form analytic expression in terms of $\\omega_{p}$, $\\varepsilon_{\\infty}$, and $\\varepsilon_{d}$.\n\nExpress your final answer as a single closed-form expression. No numerical evaluation is required.", "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- A Drude metal occupies the half-space $z<0$.\n- A lossless, dispersionless dielectric occupies the half-space $z>0$.\n- The relative permittivity of the metal is $\\varepsilon_{m}(\\omega)=\\varepsilon_{\\infty}-\\omega_{p}^{2}/\\omega^{2}$.\n- The relative permittivity of the dielectric is $\\varepsilon_{d}$.\n- Constraint: $\\varepsilon_{\\infty}>1$.\n- The system is in the non-retarded (electrostatic) limit.\n- The governing equation is $\\nabla\\cdot\\left(\\varepsilon(\\omega)\\nabla\\phi\\right)=0$.\n- Boundary conditions at the interface $z=0$:\n    1. The scalar potential $\\phi$ is continuous.\n    2. The normal component of the electric displacement $\\mathbf{D}=\\varepsilon(\\omega)\\varepsilon_{0}\\mathbf{E}$ is continuous.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a classic physical system for studying surface plasmons. The Drude model for the metal's permittivity, the assumption of a lossless dielectric, the electrostatic limit, the governing equation, and the electromagnetic boundary conditions are all standard and fundamental concepts in condensed matter physics and electromagnetism. The setup is scientifically sound.\n- **Well-Posed**: The problem is clearly stated, providing all necessary physical models, equations, and boundary conditions to derive a unique expression for the surface plasmon frequency. It asks for a specific derivation and a final analytical expression, which is a well-defined task.\n- **Objective**: The problem is formulated using precise, objective scientific language, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, self-contained, and consistent. A solution will be derived.\n\nThe problem asks for the frequency of longitudinal surface charge oscillations at the interface between two media. We start from the provided electrostatic equation, which holds in a source-free region:\n$$\n\\nabla\\cdot\\left(\\varepsilon(\\mathbf{r}, \\omega)\\nabla\\phi(\\mathbf{r}, \\omega)\\right) = 0\n$$\nIn this problem, the permittivity $\\varepsilon$ is a function of frequency $\\omega$ but is spatially uniform within each half-space. Thus, in each medium, the equation simplifies to Laplace's equation for the scalar potential $\\phi$:\n$$\n\\nabla^2\\phi = 0\n$$\nWe are looking for a bound surface mode, which is a wave that propagates along the interface (in the $xy$-plane) and decays exponentially into both media away from the interface. Due to the translational symmetry in the $xy$-plane, we can seek a solution of the form:\n$$\n\\phi(x, y, z) = f(z) e^{i(k_x x + k_y y)}\n$$\nwhere $\\mathbf{k}_‖ = (k_x, k_y)$ is the in-plane wavevector. Let's align the propagation direction with the $x$-axis without loss of generality, so $k_y=0$ and the wavevector magnitude is $k_‖ = |k_x|$. The potential then takes the form $\\phi(x, z) = f(z)e^{ik_x x}$. Substituting this into Laplace's equation, $\\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial z^2}\\right)\\phi = 0$, gives:\n$$\n(-k_x^2 f(z) + \\frac{d^2f(z)}{dz^2})e^{ik_x x} = 0\n$$\nThis leads to an ordinary differential equation for $f(z)$:\n$$\n\\frac{d^2f(z)}{dz^2} - k_x^2 f(z) = 0\n$$\nThe general solution to this equation is $f(z) = A e^{k_x z} + B e^{-k_x z}$. We must apply this solution to each medium and enforce the boundary condition that the potential vanishes far from the interface, i.e., $\\phi \\to 0$ as $|z| \\to \\infty$. We assume $k_x$ is real and positive.\n\nIn the dielectric medium ($z>0$), the potential must decay as $z \\to \\infty$. This requires the coefficient of the $e^{k_x z}$ term to be zero. Thus, the potential in the dielectric is:\n$$\n\\phi_d(x, z) = A e^{-k_x z} e^{ik_x x} \\quad \\text{for} \\quad z>0\n$$\nIn the metal medium ($z<0$), the potential must decay as $z \\to -\\infty$. This requires the coefficient of the $e^{-k_x z}$ term to be zero. Thus, the potential in the metal is:\n$$\n\\phi_m(x, z) = B e^{k_x z} e^{ik_x x} \\quad \\text{for} \\quad z<0\n$$\nNow, we apply the boundary conditions at the interface $z=0$.\n\n1.  Continuity of the scalar potential $\\phi$:\n    $$\n    \\phi_d(x, z=0) = \\phi_m(x, z=0)\n    $$\n    $$\n    A e^0 e^{ik_x x} = B e^0 e^{ik_x x} \\implies A = B\n    $$\n    For simplicity, we can set $B=A$.\n\n2.  Continuity of the normal component of the electric displacement field $\\mathbf{D}$. The normal direction is the $z$-direction. The component $D_z$ is given by $D_z = \\varepsilon(\\omega) \\varepsilon_0 E_z = -\\varepsilon(\\omega) \\varepsilon_0 \\frac{\\partial\\phi}{\\partial z}$. The boundary condition is:\n    $$\n    \\varepsilon_d \\varepsilon_0 \\frac{\\partial\\phi_d}{\\partial z}\\bigg|_{z=0} = \\varepsilon_m(\\omega) \\varepsilon_0 \\frac{\\partial\\phi_m}{\\partial z}\\bigg|_{z=0}\n    $$\n    The constant $\\varepsilon_0$ cancels out. Let's compute the derivatives:\n    $$\n    \\frac{\\partial\\phi_d}{\\partial z} = -k_x A e^{-k_x z} e^{ik_x x} \\implies \\frac{\\partial\\phi_d}{\\partial z}\\bigg|_{z=0} = -k_x A e^{ik_x x}\n    $$\n    $$\n    \\frac{\\partial\\phi_m}{\\partial z} = k_x A e^{k_x z} e^{ik_x x} \\implies \\frac{\\partial\\phi_m}{\\partial z}\\bigg|_{z=0} = k_x A e^{ik_x x}\n    $$\n    Substituting these into the boundary condition gives:\n    $$\n    \\varepsilon_d (-k_x A e^{ik_x x}) = \\varepsilon_m(\\omega) (k_x A e^{ik_x x})\n    $$\n    For a non-trivial solution to exist, we must have $A \\neq 0$ and $k_x \\neq 0$. We can thus divide both sides by $-k_x A e^{ik_x x}$:\n    $$\n    \\varepsilon_d = -\\varepsilon_m(\\omega)\n    $$\n    This relation, $\\varepsilon_d + \\varepsilon_m(\\omega) = 0$, is the general existence condition for a surface plasmon mode at the interface between two media in the electrostatic limit. For a bound mode to exist, we require that the permittivities have opposite signs. Since $\\varepsilon_d > 0$ for a dielectric, we must have $\\varepsilon_m(\\omega) < 0$, which is characteristic of a metal below its plasma frequency.\n\nTo find the surface plasmon frequency $\\omega_s$, we substitute the given expression for the metal's permittivity, $\\varepsilon_{m}(\\omega)=\\varepsilon_{\\infty}-\\omega_{p}^{2}/\\omega^{2}$, into the existence condition. Let $\\omega_s$ be the frequency that satisfies this condition:\n$$\n\\varepsilon_d + \\left(\\varepsilon_{\\infty} - \\frac{\\omega_p^2}{\\omega_s^2}\\right) = 0\n$$\nRearranging the terms to solve for $\\omega_s$:\n$$\n\\varepsilon_d + \\varepsilon_{\\infty} = \\frac{\\omega_p^2}{\\omega_s^2}\n$$\n$$\n\\omega_s^2 = \\frac{\\omega_p^2}{\\varepsilon_{\\infty} + \\varepsilon_d}\n$$\nTaking the square root gives the final expression for the surface plasmon frequency:\n$$\n\\omega_s = \\frac{\\omega_p}{\\sqrt{\\varepsilon_{\\infty} + \\varepsilon_d}}\n$$\nSince $\\varepsilon_d>0$ and $\\varepsilon_{\\infty}>1$, the denominator is real and greater than $1$, ensuring that $\\omega_s < \\omega_p$. The condition $\\varepsilon_m(\\omega_s) = -\\varepsilon_d < 0$ is satisfied, confirming the physical consistency of the solution.", "answer": "$$\n\\boxed{\\frac{\\omega_{p}}{\\sqrt{\\varepsilon_{\\infty} + \\varepsilon_{d}}}}\n$$", "id": "3010379"}, {"introduction": "Moving beyond phenomenological models, a deeper understanding of plasmons comes from treating them as quantum mechanical collective excitations of an electron gas. This practice delves into the Random Phase Approximation (RPA) to derive the dispersion relation of a bulk plasmon, which describes how the plasmon energy $\\hbar\\omega$ varies with its momentum $\\hbar q$. Calculating the small-$q$ expansion for the plasmon frequency $\\omega_p(q)$ reveals the dynamic nature of this collective mode and provides a more accurate picture than the simple, dispersionless plasma frequency [@problem_id:3010353].", "problem": "Consider a three-dimensional homogeneous electron gas of number density $n$ at zero temperature with isotropic parabolic dispersion $\\epsilon_{\\mathbf{k}}=\\hbar^{2}k^{2}/(2m)$ and Fermi wave number $k_{F}$ and Fermi velocity $v_{F}=\\hbar k_{F}/m$. The electrons move in a uniform positive background characterized by a frequency-independent background permittivity $\\varepsilon_{b}$ (in the International System of Units). Within the Random Phase Approximation (RPA), the longitudinal dielectric function is\n$$\n\\varepsilon(\\omega,q)=1-V_{q}\\,\\Pi^{0}(\\omega,q),\n$$\nwhere $V_{q}=e^{2}/(\\varepsilon_{b}q^{2})$ is the Fourier transform of the Coulomb interaction and $\\Pi^{0}(\\omega,q)$ is the noninteracting density-density response function (the Lindhard function), defined at zero temperature by\n$$\n\\Pi^{0}(\\omega,q)=2\\int \\frac{d^{3}k}{(2\\pi)^{3}}\\;\\frac{f(\\epsilon_{\\mathbf{k}})-f(\\epsilon_{\\mathbf{k}+\\mathbf{q}})}{\\hbar\\omega+\\epsilon_{\\mathbf{k}}-\\epsilon_{\\mathbf{k}+\\mathbf{q}}+i0^{+}},\n$$\nwith $f(\\epsilon)$ the Fermi-Dirac distribution. In the collisionless long-wavelength regime $q\\ll k_{F}$ and $\\omega\\gg q v_{F}$, solve $\\varepsilon(\\omega,q)=0$ to obtain the longitudinal plasmon dispersion $\\omega_{p}(q)$ and compute its small-$q$ expansion up to and including order $q^{2}$. You may introduce the bulk plasma frequency $\\omega_{p}$ defined by $\\omega_{p}^{2}=n e^{2}/(m\\varepsilon_{b})$. Express your final answer as a single closed-form analytic expression in terms of $\\omega_{p}$, $v_{F}$, and $q$. Do not evaluate numerically; give a symbolic expression only.", "solution": "The problem requires finding the longitudinal plasmon dispersion $\\omega_{p}(q)$ for a three-dimensional homogeneous electron gas up to order $q^{2}$ in the small wavevector limit. The dispersion relation is found by solving the equation $\\varepsilon(\\omega, q) = 0$, where $\\varepsilon(\\omega, q)$ is the longitudinal dielectric function within the Random Phase Approximation (RPA).\n\nThe given dielectric function is:\n$$ \\varepsilon(\\omega,q)=1-V_{q}\\,\\Pi^{0}(\\omega,q) $$\nwhere $V_{q}=e^{2}/(\\varepsilon_{b}q^{2})$ is the Fourier component of the Coulomb interaction and $\\Pi^{0}(\\omega,q)$ is the noninteracting density-density response function (Lindhard function) at zero temperature $T=0$.\n\nThe condition $\\varepsilon(\\omega, q) = 0$ implies:\n$$ 1 = V_{q}\\,\\Pi^{0}(\\omega,q) = \\frac{e^2}{\\varepsilon_{b}q^2} \\Pi^{0}(\\omega,q) $$\nTo solve for $\\omega(q)$, we must first find an appropriate expression for $\\Pi^{0}(\\omega,q)$ in the specified long-wavelength, high-frequency regime, which is defined by $q\\ll k_{F}$ and $\\omega\\gg q v_{F}$. The Lindhard function is given by:\n$$ \\Pi^{0}(\\omega,q)=2\\int \\frac{d^{3}k}{(2\\pi)^{3}}\\;\\frac{f(\\epsilon_{\\mathbf{k}})-f(\\epsilon_{\\mathbf{k}+\\mathbf{q}})}{\\hbar\\omega+\\epsilon_{\\mathbf{k}}-\\epsilon_{\\mathbf{k}+\\mathbf{q}}+i0^{+}} $$\nAt zero temperature, the Fermi-Dirac distribution $f(\\epsilon_{\\mathbf{k}})$ is a step function, being $1$ for $\\epsilon_{\\mathbf{k}} < \\epsilon_F$ (i.e., $k < k_F$) and $0$ for $\\epsilon_{\\mathbf{k}} > \\epsilon_F$. A more tractable form for $\\Pi^0$ in this limit can be derived from the linearized Vlasov equation, which gives:\n$$ \\Pi^{0}(\\omega,q) = 2 \\int \\frac{d^3k}{(2\\pi)^3} \\left(-\\frac{df(\\epsilon_{\\mathbf{k}})}{d\\epsilon_{\\mathbf{k}}}\\right) \\frac{(\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}})^{2}}{\\omega^2 - (\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}})^2} $$\nwhere $\\mathbf{v}_{\\mathbf{k}} = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}\\epsilon_{\\mathbf{k}} = \\frac{\\hbar\\mathbf{k}}{m}$.\nIn the limit $\\omega \\gg qv_F \\ge qv_k$, we can expand the denominator:\n$$ \\frac{1}{\\omega^2 - (\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}})^2} = \\frac{1}{\\omega^2} \\left(1 - \\left(\\frac{\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}}}{\\omega}\\right)^2\\right)^{-1} \\approx \\frac{1}{\\omega^2}\\left(1 + \\left(\\frac{\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}}}{\\omega}\\right)^2 + \\dots \\right) $$\nSubstituting this into the integral for $\\Pi^{0}(\\omega,q)$:\n$$ \\Pi^0(\\omega,q) \\approx 2 \\int \\frac{d^3k}{(2\\pi)^3} \\left(-\\frac{df}{d\\epsilon_k}\\right) \\left[ \\frac{(\\mathbf{q}\\cdot\\mathbf{v_k})^2}{\\omega^2} + \\frac{(\\mathbf{q}\\cdot\\mathbf{v_k})^4}{\\omega^4} + \\dots \\right] $$\nAt zero temperature, $-\\frac{df}{d\\epsilon_k} = \\delta(\\epsilon_k - \\epsilon_F)$. The integral is thus restricted to the Fermi surface where $k=k_F$ and $v_k=v_F$. Let's evaluate the terms.\n\nThe first term is:\n$$ \\Pi^0_{(1)} = \\frac{2}{\\omega^2} \\int \\frac{d^3k}{(2\\pi)^3} \\delta(\\epsilon_k - \\epsilon_F) (\\mathbf{q}\\cdot\\mathbf{v_k})^2 $$\nLet the direction of $\\mathbf{q}$ be the $z$-axis. Then $\\mathbf{q}\\cdot\\mathbf{v_k} = qv_k \\cos\\theta$. For $k=k_F$, this is $qv_F\\cos\\theta$.\nThe integral over the delta function gives the density of states at the Fermi energy, $D(\\epsilon_F) = 2 \\int \\frac{d^3k}{(2\\pi)^3} \\delta(\\epsilon_k - \\epsilon_F) = \\frac{mk_F}{\\pi^2\\hbar^2}$.\nThe velocity term must be averaged over the Fermi surface: $\\langle (\\mathbf{q}\\cdot\\mathbf{v_k})^2 \\rangle_{FS} = \\langle q^2v_F^2\\cos^2\\theta \\rangle = q^2v_F^2 \\frac{\\int \\cos^2\\theta d\\Omega}{\\int d\\Omega} = q^2v_F^2 \\frac{4\\pi/3}{4\\pi}=\\frac{1}{3}q^2v_F^2$.\nSo, $\\Pi^0_{(1)} = \\frac{1}{\\omega^2} D(\\epsilon_F) \\frac{1}{3}q^2v_F^2 = \\frac{1}{\\omega^2} \\frac{mk_F}{\\pi^2\\hbar^2} \\frac{1}{3}q^2 \\left(\\frac{\\hbar k_F}{m}\\right)^2 = \\frac{k_F^3 q^2}{3\\pi^2 m \\omega^2}$.\nUsing the relation for electron density $n = k_F^3/(3\\pi^2)$, we get:\n$$ \\Pi^0_{(1)} = \\frac{nq^2}{m\\omega^2} $$\nThis is the leading term for $\\Pi^0(\\omega,q)$.\n\nThe second term in the expansion is:\n$$ \\Pi^0_{(2)} = \\frac{2}{\\omega^4} \\int \\frac{d^3k}{(2\\pi)^3} \\delta(\\epsilon_k - \\epsilon_F) (\\mathbf{q}\\cdot\\mathbf{v_k})^4 = \\frac{D(\\epsilon_F)}{\\omega^4} \\langle(\\mathbf{q}\\cdot\\mathbf{v_k})^4\\rangle_{FS} $$\nThe angular average is $\\langle(\\mathbf{q}\\cdot\\mathbf{v_k})^4\\rangle_{FS} = \\langle q^4v_F^4\\cos^4\\theta \\rangle = q^4v_F^4 \\frac{\\int\\cos^4\\theta d\\Omega}{\\int d\\Omega} = q^4v_F^4 \\frac{4\\pi/5}{4\\pi} = \\frac{1}{5}q^4v_F^4$.\nThus, $\\Pi^0_{(2)} = \\frac{D(\\epsilon_F)}{\\omega^4} \\frac{1}{5}q^4v_F^4 = \\frac{mk_F}{\\pi^2\\hbar^2\\omega^4}\\frac{1}{5}q^4v_F^4 = \\frac{mk_F q^4}{5\\pi^2\\hbar^2\\omega^4} \\left(\\frac{\\hbar k_F}{m}\\right)^4 = \\frac{k_F^5 \\hbar^2 q^4}{5\\pi^2 m^3 \\omega^4}$.\nUsing $n=k_F^3/(3\\pi^2)$ and $v_F=\\hbar k_F/m$:\n$$ \\Pi^0_{(2)} = \\frac{(3\\pi^2 n) k_F^2 \\hbar^2 q^4}{5\\pi^2 m^3 \\omega^4} = \\frac{3n q^4}{5 m \\omega^4} \\frac{\\hbar^2 k_F^2}{m^2} = \\frac{3nq^4v_F^2}{5m\\omega^4} $$\nCombining the terms, the expansion for $\\Pi^0(\\omega,q)$ is:\n$$ \\Pi^0(\\omega,q) \\approx \\frac{nq^2}{m\\omega^2} + \\frac{3nq^4v_F^2}{5m\\omega^4} = \\frac{nq^2}{m\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\nNow, we substitute this into the plasmon condition $1 = \\frac{e^2}{\\varepsilon_{b}q^2}\\Pi^0(\\omega,q)$:\n$$ 1 = \\frac{e^2}{\\varepsilon_{b}q^2} \\cdot \\frac{nq^2}{m\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\n$$ 1 = \\frac{ne^2}{m\\varepsilon_{b}\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\nUsing the definition of the bulk plasma frequency, $\\omega_{p}^{2} = ne^2/(m\\varepsilon_{b})$:\n$$ 1 = \\frac{\\omega_{p}^2}{\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\nThis gives an implicit equation for the dispersion $\\omega(q)$:\n$$ \\omega^2 = \\omega_{p}^2\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\nTo find the small-$q$ expansion, we can solve this iteratively. To lowest order ($q=0$), we have $\\omega^2 = \\omega_p^2$, so $\\omega(0) = \\omega_p$.\nFor the next order term, we can approximate $\\omega$ in the correction term (which is already of order $q^2$) by its zeroth-order value, $\\omega \\approx \\omega_p$.\n$$ \\omega(q)^2 \\approx \\omega_{p}^2\\left(1 + \\frac{3q^2v_F^2}{5\\omega_{p}^2}\\right) = \\omega_{p}^2 + \\frac{3}{5}q^2v_F^2 $$\nThe problem asks for $\\omega_p(q)$ expanded to order $q^2$. We take the square root of the above expression:\n$$ \\omega_p(q) = \\sqrt{\\omega_{p}^2 + \\frac{3}{5}q^2v_F^2} = \\omega_{p}\\left(1 + \\frac{3q^2v_F^2}{5\\omega_{p}^2}\\right)^{1/2} $$\nUsing the binomial expansion $(1+x)^{1/2} \\approx 1 + \\frac{1}{2}x$ for small $x$:\n$$ \\omega_p(q) \\approx \\omega_{p}\\left(1 + \\frac{1}{2} \\cdot \\frac{3q^2v_F^2}{5\\omega_{p}^2}\\right) = \\omega_{p} + \\frac{3}{10}\\frac{v_F^2 q^2}{\\omega_{p}} $$\nThis is the plasmon dispersion relation expanded to the second order in $q$.", "answer": "$$\\boxed{\\omega_{p} + \\frac{3 v_{F}^{2}}{10 \\omega_{p}} q^{2}}$$", "id": "3010353"}, {"introduction": "To bridge the gap between theory and experiment, we must be able to describe the optical properties of real materials accurately. This final hands-on practice demonstrates how to use synthetic experimental data for a metal's complex dielectric function, $\\varepsilon_m(\\omega)$, to construct and validate a physically realistic Drude-Lorentz model. This powerful exercise [@problem_id:3010327] showcases a critical workflow in physics and engineering: fitting a model to data to predict other physical phenomena, in this case, the dispersion relation of a surface plasmon polariton at an interface with the characterized metal.", "problem": "Consider a semi-infinite metal characterized by a frequency-dependent dielectric function and a semi-infinite dielectric with constant permittivity. You will work with a synthetic optical ellipsometry dataset consisting of the complex dielectric function of the metal as a function of photon energy. Your task is to construct a physically grounded model for the metal dielectric function based on a charged-oscillator picture, estimate its parameters by fitting to the dataset, and then predict the surface plasmon polariton (SPP) dispersion at a metal–dielectric interface using the fitted dielectric function. You must implement three models to highlight the roles of the high-frequency permittivity and interband transitions: (i) a full Drude–Lorentz model with a high-frequency constant and one interband Lorentz oscillator, (ii) a Drude-only model with the high-frequency constant fixed to unity, and (iii) a Drude-only model with a free high-frequency constant.\n\nFundamental base to be used:\n- Maxwell’s equations in linear, homogeneous, isotropic media and the associated boundary conditions for fields at planar interfaces.\n- Linear response theory for polarization induced by an electric field, modeled by collections of bound and free classical charges subject to harmonic forces and damping.\n- The constitutive relation between polarization and the electric field, defining the electric susceptibility and dielectric function.\n- The condition for existence of a bound surface plasmon polariton mode at a flat interface derived from electromagnetic boundary conditions.\n\nData and units:\n- Photon energy grid (in electronvolts): $E = [1.2, 1.5, 1.8, 2.1, 2.4, 2.7, 3.0]$.\n- Measured complex dielectric function values for the metal at these photon energies, given as $[\\operatorname{Re}\\,\\varepsilon_m(E), \\operatorname{Im}\\,\\varepsilon_m(E)]$ pairs:\n  - $1.2\\,\\mathrm{eV}$: $[-49.690,\\ 3.616]$\n  - $1.5\\,\\mathrm{eV}$: $[-29.357,\\ 2.283]$\n  - $1.8\\,\\mathrm{eV}$: $[-18.187,\\ 2.114]$\n  - $2.1\\,\\mathrm{eV}$: $[-11.770,\\ 2.833]$\n  - $2.4\\,\\mathrm{eV}$: $[-9.051,\\ 3.349]$\n  - $2.7\\,\\mathrm{eV}$: $[-7.278,\\ 2.154]$\n  - $3.0\\,\\mathrm{eV}$: $[-5.152,\\ 1.172]$\n- Physical constants shall be used in SI units when computing SPP dispersion:\n  - Speed of light $c$ in $\\mathrm{m/s}$.\n  - Elementary charge $e$ in $\\mathrm{C}$.\n  - Reduced Planck’s constant $\\hbar$ in $\\mathrm{J\\,s}$.\n- The dielectric permittivity of the non-metallic partner is taken as real and frequency-independent, denoted $\\varepsilon_d$ (dimensionless).\n\nModeling and fitting tasks:\n1. Construct a causal, linear-response dielectric function model for the metal with these three variants:\n   (a) Full Drude–Lorentz model including a high-frequency constant contribution and a single interband Lorentz oscillator alongside a free-electron Drude term. The model must be parameterized by a dimensionless high-frequency constant $\\varepsilon_\\infty$, a Drude plasma energy (in electronvolts), a Drude damping energy (in electronvolts), a Lorentz oscillator strength (dimensionless), a Lorentz resonance energy (in electronvolts), and a Lorentz damping energy (in electronvolts).\n   (b) Drude-only model with $\\varepsilon_\\infty$ fixed to the dimensionless value $1$ and no Lorentz oscillator, parameterized by a Drude plasma energy (in electronvolts) and a Drude damping energy (in electronvolts).\n   (c) Drude-only model with a free $\\varepsilon_\\infty$ and no Lorentz oscillator, parameterized by the dimensionless $\\varepsilon_\\infty$, a Drude plasma energy (in electronvolts), and a Drude damping energy (in electronvolts).\n2. Fit the parameters of each model to the provided dataset by minimizing the sum of squared residuals between the modeled complex dielectric function and the measured values over the energy grid. The residuals must include both the real and imaginary parts at every energy point. Ensure that all physically constrained parameters that represent energies or damping are strictly positive, and that the oscillator strength is nonnegative. The high-frequency constant $\\varepsilon_\\infty$ must be positive.\n3. Using the fitted dielectric function from each model, compute the SPP in-plane wavevector $k_x(\\omega)$ at a flat interface between the metal and a dielectric with constant permittivity $\\varepsilon_d$ by solving the dispersion relation implied by Maxwell’s equations and boundary conditions. Express results in terms of the effective index $n_{\\mathrm{eff}}(\\omega)$ defined as $n_{\\mathrm{eff}}(\\omega) = \\operatorname{Re}\\left\\{\\frac{c\\,k_x(\\omega)}{\\omega}\\right\\}$. Here, $\\omega$ is the angular frequency in $\\mathrm{rad/s}$ related to photon energy by $\\omega = E\\,e/\\hbar$ with $E$ in $\\mathrm{eV}$. The effective index is dimensionless.\n4. Test suite and outputs: Compute $n_{\\mathrm{eff}}$ for each of the three models at the following test cases, where the dielectric partner has constant permittivity $\\varepsilon_d$ (dimensionless) and the photon energy is $E$ (in electronvolts):\n   - Case A: $\\varepsilon_d = 1.0$, $E = 1.55$.\n   - Case B: $\\varepsilon_d = 2.25$, $E = 2.00$.\n   - Case C: $\\varepsilon_d = 3.06$, $E = 2.75$.\n   For each case, produce three results corresponding to the three models in the order: full Drude–Lorentz, Drude-only with $\\varepsilon_\\infty = 1$, Drude-only with free $\\varepsilon_\\infty$.\n\nAlgorithmic and numerical requirements:\n- Perform nonlinear least-squares fitting on the complex-valued dataset by stacking real and imaginary residuals into a single real vector objective. Use numerically stable handling of complex arithmetic.\n- Ensure physically meaningful bounds on parameters as specified above.\n- Handle the complex square root consistently to select the physically relevant branch for $n_{\\mathrm{eff}}$ with nonnegative real part.\n\nFinal output format:\n- Your program should produce a single line of output containing the nine results as a comma-separated list enclosed in square brackets, ordered by test case (A, B, C) and, within each case, by model (full Drude–Lorentz, Drude-only with $\\varepsilon_\\infty = 1$, Drude-only with free $\\varepsilon_\\infty$).\n- Each float must be rounded to six decimal places.\n- The final output line must look like: \"[x1,x2,x3,x4,x5,x6,x7,x8,x9]\" where $x_i$ are the six-decimal-place floats corresponding to the effective indices in the specified order.\n\nAll dielectric functions are dimensionless, photon energies must be provided in electronvolts, angular frequency in radians per second, and the effective index is dimensionless. Angles are not involved in this problem. No percentages are involved; all numerical results must be in decimal notation.", "solution": "The user-provided problem is assessed to be **valid**. It is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. The task involves modeling the optical properties of a metal, fitting these models to provided data, and subsequently using the fitted models to predict the behavior of surface plasmon polaritons (SPPs) at a metal-dielectric interface. This is a standard and conceptually significant problem in condensed matter physics and nanophotonics.\n\n### 1. Theoretical Framework: Dielectric Function of Metals\n\nThe optical response of a metal to an external electromagnetic field is characterized by its frequency-dependent complex dielectric function, $\\varepsilon_m(\\omega)$. This function can be physically modeled by considering the collective motion of electrons. These electrons are broadly categorized into two groups: \"free\" conduction electrons and \"bound\" core electrons.\n\n#### 1.1 The Drude Model for Free Electrons\n\nThe Drude model provides a classical description of the conduction electrons as a free electron gas subject to a damping force (representing scattering events). The equation of motion for an electron of charge $-e$ and effective mass $m^*$ in an electric field $\\vec{E}(t) = \\vec{E}_0 e^{-i\\omega t}$ is:\n$$ m^* \\frac{d^2\\vec{r}}{dt^2} + m^*\\gamma_D \\frac{d\\vec{r}}{dt} = -e \\vec{E}(t) $$\nHere, $\\gamma_D$ is the damping rate or collision frequency. Solving for the steady-state displacement $\\vec{r}(t)$ leads to the induced polarization $\\vec{P} = -ne\\vec{r} = \\varepsilon_0 \\chi(\\omega) \\vec{E}$, where $n$ is the electron density. The resulting electric susceptibility $\\chi_{Drude}(\\omega)$ gives the Drude contribution to the dielectric function $\\varepsilon(\\omega) = 1 + \\chi(\\omega)$:\n$$ \\varepsilon_{Drude}(\\omega) = 1 - \\frac{\\omega_p^2}{\\omega^2 + i\\gamma_D \\omega} $$\nwhere $\\omega_p = \\sqrt{ne^2/(m^*\\varepsilon_0)}$ is the plasma frequency. At high frequencies, contributions from bound core electrons become significant. This is accounted for by a constant offset $\\varepsilon_\\infty$, which represents the dielectric constant from all other polarization mechanisms at frequencies much higher than the plasma and resonance frequencies considered. The generalized Drude model is:\n$$ \\varepsilon_m(\\omega) = \\varepsilon_\\infty - \\frac{\\omega_p^2}{\\omega^2 + i\\gamma_D \\omega} $$\nFor implementation, it is convenient to work with photon energy $E = \\hbar\\omega$. Defining the corresponding energy parameters $E_p = \\hbar\\omega_p$ and $\\Gamma_D = \\hbar\\gamma_D$, the equation becomes:\n$$ \\varepsilon_m(E) = \\varepsilon_\\infty - \\frac{E_p^2}{E^2 + i E \\Gamma_D} $$\n\n#### 1.2 The Lorentz Model for Bound Electrons\n\nInterband transitions, where an electron is excited from a filled band to an empty band, can be modeled classically as a collection of damped harmonic oscillators. The equation of motion for a bound electron with resonance frequency $\\omega_L$ and damping rate $\\gamma_L$ is:\n$$ m \\frac{d^2\\vec{r}}{dt^2} + m\\gamma_L \\frac{d\\vec{r}}{dt} + m\\omega_L^2 \\vec{r} = -e \\vec{E}(t) $$\nThis leads to the Lorentz susceptibility:\n$$ \\chi_{Lorentz}(\\omega) = \\frac{\\omega_{p,L}^2}{\\omega_L^2 - \\omega^2 - i\\gamma_L \\omega} $$\nwhere $\\omega_{p,L}$ is a plasma frequency associated with the density of these bound oscillators.\n\n#### 1.3 The Combined Drude-Lorentz Model\n\nA more complete model for a real metal combines these effects. The total dielectric function is the sum of the high-frequency constant, the free-electron Drude response, and one or more Lorentz oscillators for interband transitions:\n$$ \\varepsilon_m(\\omega) = \\varepsilon_\\infty - \\frac{\\omega_p^2}{\\omega^2 + i\\gamma_D \\omega} + \\sum_j \\frac{S_j \\omega_{L,j}^2}{\\omega_{L,j}^2 - \\omega^2 - i\\gamma_L \\omega} $$\nThe parameter $S_j$ is the dimensionless strength of the $j$-th oscillator, related to $\\omega_{p,L,j}$. In terms of energy, the full model with one Lorentz oscillator is:\n$$ \\varepsilon_m(E) = \\varepsilon_\\infty - \\frac{E_p^2}{E^2 + i E \\Gamma_D} + \\frac{S_L E_L^2}{E_L^2 - E^2 - i E \\Gamma_L} $$\n\n### 2. Parameter Estimation via Least-Squares Fitting\n\nThe problem specifies three variants of this model:\n(a) Full Drude-Lorentz: Parameters $(\\varepsilon_\\infty, E_p, \\Gamma_D, S_L, E_L, \\Gamma_L)$.\n(b) Drude-only with $\\varepsilon_\\infty \\equiv 1$: Parameters $(E_p, \\Gamma_D)$.\n(c) Drude-only with free $\\varepsilon_\\infty$: Parameters $(\\varepsilon_\\infty, E_p, \\Gamma_D)$.\n\nTo determine the optimal parameters for each model, we fit the model function $\\varepsilon_{model}(E; \\vec{p})$ to the provided experimental data $(\\{E_j\\}, \\{\\varepsilon_{data}(E_j)\\})$. The fitting is performed by minimizing the sum of squared residuals (SSR) between the model and the data. Since $\\varepsilon_m$ is complex, the objective function is defined over both its real and imaginary parts:\n$$ \\mathrm{SSR}(\\vec{p}) = \\sum_j \\left[ (\\operatorname{Re}\\{\\varepsilon_{model}(E_j; \\vec{p})\\} - \\operatorname{Re}\\{\\varepsilon_{data}(E_j)\\})^2 + (\\operatorname{Im}\\{\\varepsilon_{model}(E_j; \\vec{p})\\} - \\operatorname{Im}\\{\\varepsilon_{data}(E_j)\\})^2 \\right] $$\nThis is equivalent to minimizing the squared $L_2$-norm of the complex residual vector, $||\\vec{\\varepsilon}_{model} - \\vec{\\varepsilon}_{data}||^2$. This nonlinear least-squares problem is solved numerically using an optimization algorithm (e.g., Levenberg-Marquardt), subject to physical constraints on the parameters (e.g., energies and damping must be positive).\n\n### 3. Surface Plasmon Polariton (SPP) Dispersion\n\nAn SPP is a transverse-magnetic (TM) surface electromagnetic wave that propagates along the interface between a metal (with dielectric function $\\varepsilon_m(\\omega)$) and a dielectric (with permittivity $\\varepsilon_d$). The existence condition and dispersion relation are derived by solving Maxwell's equations with the continuity boundary conditions for the fields at the interface. This yields the SPP dispersion relation for the in-plane wavevector $k_x$:\n$$ k_x(\\omega) = \\frac{\\omega}{c} \\sqrt{\\frac{\\varepsilon_m(\\omega) \\varepsilon_d}{\\varepsilon_m(\\omega) + \\varepsilon_d}} $$\nFor a low-loss SPP to exist, two conditions are typically required: $\\operatorname{Re}\\{\\varepsilon_m\\} < -\\varepsilon_d$ and $\\operatorname{Im}\\{\\varepsilon_m\\}$ must be small and positive. The effective refractive index, $n_{\\mathrm{eff}}$, is a dimensionless quantity describing the phase velocity of the SPP relative to the speed of light in vacuum:\n$$ n_{\\mathrm{eff}}(\\omega) = \\frac{c k_x(\\omega)}{\\omega} $$\nSubstituting the expression for $k_x(\\omega)$, we obtain:\n$$ n_{\\mathrm{eff}}(\\omega) = \\sqrt{\\frac{\\varepsilon_m(\\omega) \\varepsilon_d}{\\varepsilon_m(\\omega) + \\varepsilon_d}} $$\nSince $\\varepsilon_m(\\omega)$ is complex, $k_x$ and $n_{\\mathrm{eff}}$ are also complex. The real part, $\\operatorname{Re}\\{n_{\\mathrm{eff}}\\}$, determines the phase velocity, while the imaginary part relates to propagation loss. The problem asks for $\\operatorname{Re}\\{n_{\\mathrm{eff}}\\}$, where the branch of the complex square root is chosen to have a non-negative real part, corresponding to a physically meaningful forward-propagating or evanescently decaying wave.\n\n### 4. Algorithmic Implementation\n\nThe solution is implemented as follows:\n1.  **Model Definition**: Three Python functions are created, one for each dielectric model specified in the problem. These functions take photon energy $E$ (in eV) and a parameter vector as input and return the complex dielectric constant $\\varepsilon_m(E)$.\n2.  **Fitting**: For each model, a residual function is defined to compute the vector of differences between the model's predictions and the experimental data, stacked into a real-valued array `[Re(diff_1), Im(diff_1), ...]`. The `scipy.optimize.least_squares` function is used to find the parameter vector that minimizes the sum of squares of these residuals. Physically motivated initial guesses and bounds are provided to ensure convergence to a meaningful solution.\n3.  **SPP Calculation**: A function `calculate_neff` is implemented. It takes the photon energy $E$, the dielectric's permittivity $\\varepsilon_d$, the chosen model function, and its fitted parameters. It computes $\\varepsilon_m(E)$ and then evaluates the expression for $n_{\\mathrm{eff}}(\\omega)$, returning its real part.\n4.  **Execution**: The main script first performs the fitting procedures for all three models to obtain three sets of optimized parameters. It then iterates through the specified test cases (A, B, C). For each case, it calculates $\\operatorname{Re}\\{n_{\\mathrm{eff}}\\}$ using each of the three fitted models. The nine resulting values are collected and formatted into a single string as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the plasmonics problem by fitting dielectric models and calculating SPP effective indices.\n    \"\"\"\n\n    # --- Dielectric Function Models ---\n    # The models accept energy E in eV and parameters are also in eV where applicable.\n\n    def model_a(E, params):\n        \"\"\"Full Drude-Lorentz model.\"\"\"\n        eps_inf, E_p, Gamma_D, S_L, E_L, Gamma_L = params\n        E = np.asarray(E, dtype=complex)\n        E2 = E**2\n        \n        drude_term = E_p**2 / (E2 + 1j * E * Gamma_D)\n        lorentz_term = (S_L * E_L**2) / (E_L**2 - E2 - 1j * E * Gamma_L)\n        \n        return eps_inf - drude_term + lorentz_term\n\n    def model_b(E, params):\n        \"\"\"Drude-only model with eps_inf = 1.\"\"\"\n        E_p, Gamma_D = params\n        E = np.asarray(E, dtype=complex)\n        E2 = E**2\n        \n        drude_term = E_p**2 / (E2 + 1j * E * Gamma_D)\n        \n        return 1.0 - drude_term\n\n    def model_c(E, params):\n        \"\"\"Drude-only model with free eps_inf.\"\"\"\n        eps_inf, E_p, Gamma_D = params\n        E = np.asarray(E, dtype=complex)\n        E2 = E**2\n        \n        drude_term = E_p**2 / (E2 + 1j * E * Gamma_D)\n        \n        return eps_inf - drude_term\n\n    # --- Residual Functions for Fitting ---\n\n    def residuals(params, E_data, eps_data, model_func):\n        \"\"\"Generic residuals function.\"\"\"\n        eps_model = model_func(E_data, params)\n        diff = eps_model - eps_data\n        return np.concatenate((diff.real, diff.imag))\n\n    # --- SPP Effective Index Calculation ---\n\n    def calculate_neff(E, eps_d, model_func, params):\n        \"\"\"Calculates the SPP effective index n_eff.\"\"\"\n        eps_m = model_func(E, params)\n        arg = (eps_m * eps_d) / (eps_m + eps_d)\n        n_eff_complex = np.sqrt(arg.astype(np.complex128))\n        return n_eff_complex.real\n\n    # --- Data and Constants ---\n    E_data = np.array([1.2, 1.5, 1.8, 2.1, 2.4, 2.7, 3.0])\n    eps_data = np.array([\n        -49.690 + 3.616j, -29.357 + 2.283j, -18.187 + 2.114j,\n        -11.770 + 2.833j, -9.051 + 3.349j,  -7.278 + 2.154j,\n        -5.152 + 1.172j\n    ])\n\n    # --- Fitting ---\n    \n    # Model (a): Full Drude-Lorentz\n    # Params: [eps_inf, E_p, Gamma_D, S_L, E_L, Gamma_L]\n    p0_a = [5.0, 9.0, 0.1, 0.5, 2.5, 0.8]\n    bounds_a = ([1e-9, 1e-9, 1e-9, 0, 1e-9, 1e-9], \n                [np.inf, np.inf, np.inf, np.inf, np.inf, np.inf])\n    res_a = least_squares(residuals, p0_a, args=(E_data, eps_data, model_a), bounds=bounds_a)\n    params_a = res_a.x\n\n    # Model (b): Drude-only, eps_inf = 1\n    # Params: [E_p, Gamma_D]\n    p0_b = [8.5, 0.1]\n    bounds_b = ([1e-9, 1e-9], [np.inf, np.inf])\n    res_b = least_squares(residuals, p0_b, args=(E_data, eps_data, model_b), bounds=bounds_b)\n    params_b = res_b.x\n\n    # Model (c): Drude-only, free eps_inf\n    # Params: [eps_inf, E_p, Gamma_D]\n    p0_c = [6.8, 9.0, 0.1]\n    bounds_c = ([1e-9, 1e-9, 1e-9], [np.inf, np.inf, np.inf])\n    res_c = least_squares(residuals, p0_c, args=(E_data, eps_data, model_c), bounds=bounds_c)\n    params_c = res_c.x\n    \n    # --- Test Cases and Calculation ---\n    test_cases = [\n        (1.0, 1.55),   # Case A: eps_d, E\n        (2.25, 2.00),  # Case B\n        (3.06, 2.75)   # Case C\n    ]\n\n    models_params_ordered = [\n        (model_a, params_a),\n        (model_b, params_b),\n        (model_c, params_c)\n    ]\n    \n    results = []\n    for eps_d_test, E_test in test_cases:\n        for model_func, params in models_params_ordered:\n            n_eff = calculate_neff(E_test, eps_d_test, model_func, params)\n            results.append(n_eff)\n\n    # --- Format and Print Output ---\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3010327"}]}