{"hands_on_practices": [{"introduction": "The defining characteristic of a polariton is its hybrid nature, existing as a quantum mechanical mixture of light and matter. This exercise provides a quantitative foundation for this concept by asking you to determine the 'photon' and 'phonon' character of a polariton state. By calculating the bare-energy partition fraction from the system's Hamiltonian [@problem_id:3010562], you will derive how the energy detuning between the uncoupled modes and their mutual coupling strength control the fundamental composition of this quintessential quasi-particle.", "problem": "Consider a single-mode electromagnetic field (photon) of angular frequency $\\omega_{c}$ interacting with a single dispersionless transverse optical phonon (transverse optical (TO) phonon) of angular frequency $\\omega_{TO}$ in a polar crystal. In the rotating-wave approximation, the coupled system is modeled by the Hamiltonian\n$$\nH=\\hbar\\,\\omega_{c}\\,a^{\\dagger}a+\\hbar\\,\\omega_{TO}\\,b^{\\dagger}b+\\hbar\\,g\\left(a^{\\dagger}b+b^{\\dagger}a\\right),\n$$\nwhere $a$ ($a^{\\dagger}$) annihilates (creates) a photon, $b$ ($b^{\\dagger}$) annihilates (creates) a phonon, and $g$ is a real, positive photon-phonon coupling rate. Work entirely within the single-excitation sector spanned by $\\{|1_{c},0_{TO}\\rangle,|0_{c},1_{TO}\\rangle\\}$, and assume the ground state is the tensor vacuum $|0_{c},0_{TO}\\rangle$.\n\nDefine the lower polariton creation operator $P_{-}^{\\dagger}=u_{-}\\,a^{\\dagger}+v_{-}\\,b^{\\dagger}$ such that $P_{-}^{\\dagger}|0_{c},0_{TO}\\rangle$ is an eigenstate of $H$ in the single-excitation sector, and the coefficients $u_{-}$ and $v_{-}$ are chosen to ensure bosonic normalization in this sector.\n\nLet the bare photon and bare phonon energies be $H_{\\text{ph}}=\\hbar\\,\\omega_{c}\\,a^{\\dagger}a$ and $H_{\\text{TO}}=\\hbar\\,\\omega_{TO}\\,b^{\\dagger}b$, respectively. In the lower polariton state $|1_{-}\\rangle=P_{-}^{\\dagger}|0_{c},0_{TO}\\rangle$, define the bare-energy partition fraction\n$$\nf_{-}=\\frac{\\langle 1_{-}|\\,H_{\\text{TO}}\\,|1_{-}\\rangle}{\\langle 1_{-}|\\,H_{\\text{ph}}+H_{\\text{TO}}\\,|1_{-}\\rangle}.\n$$\n\nStarting from the Hamiltonian above and first principles of coupled bosonic modes, derive an explicit closed-form analytic expression for $f_{-}$ in terms of $\\omega_{c}$, $\\omega_{TO}$, and $g$ only. Your final answer must be a single expression. No numerical evaluation is required.", "solution": "The user wants to find the bare-energy partition fraction, $f_{-}$, for the lower polariton state in a system of coupled photon and phonon modes.\n\nTo solve this problem, we will follow these steps:\n1.  Represent the Hamiltonian as a matrix in the single-excitation subspace.\n2.  Find the eigenvalues and the eigenvector corresponding to the lower energy (lower polariton).\n3.  Use the eigenvector to determine the coefficients $|u_{-}|^2$ and $|v_{-}|^2$.\n4.  Calculate the expectation values in the definition of $f_{-}$.\n5.  Substitute the coefficients into the expression for $f_{-}$ and simplify to obtain the final answer in terms of the given parameters $\\omega_{c}$, $\\omega_{TO}$, and $g$.\n\nThe single-excitation sector is spanned by the two basis states: $|1_{c},0_{TO}\\rangle$, representing one photon and zero phonons, and $|0_{c},1_{TO}\\rangle$, representing zero photons and one phonon.\n\nStep 1: Hamiltonian Matrix\nThe Hamiltonian is $H=\\hbar\\,\\omega_{c}\\,a^{\\dagger}a+\\hbar\\,\\omega_{TO}\\,b^{\\dagger}b+\\hbar\\,g\\left(a^{\\dagger}b+b^{\\dagger}a\\right)$.\nWe compute the matrix elements $H_{ij} = \\langle i | H | j \\rangle$ in the basis $\\{|1_{c},0_{TO}\\rangle, |0_{c},1_{TO}\\rangle\\}$.\n\nThe diagonal elements are:\n$H_{11} = \\langle 1_{c},0_{TO}| H |1_{c},0_{TO}\\rangle = \\langle 1_{c},0_{TO}| \\hbar\\omega_{c} a^\\dagger a |1_{c},0_{TO}\\rangle = \\hbar\\omega_{c}$.\n$H_{22} = \\langle 0_{c},1_{TO}| H |0_{c},1_{TO}\\rangle = \\langle 0_{c},1_{TO}| \\hbar\\omega_{TO} b^\\dagger b |0_{c},1_{TO}\\rangle = \\hbar\\omega_{TO}$.\n\nThe off-diagonal elements are determined by the interaction term $\\hbar g(a^\\dagger b + b^\\dagger a)$:\n$H_{12} = \\langle 1_{c},0_{TO}| H |0_{c},1_{TO}\\rangle = \\langle 1_{c},0_{TO}| \\hbar g a^\\dagger b |0_{c},1_{TO}\\rangle = \\hbar g \\langle 1_{c},0_{TO}| a^\\dagger |0_{c},0_{TO}\\rangle = \\hbar g$.\n$H_{21} = \\langle 0_{c},1_{TO}| H |1_{c},0_{TO}\\rangle = \\langle 0_{c},1_{TO}| \\hbar g b^\\dagger a |1_{c},0_{TO}\\rangle = \\hbar g \\langle 0_{c},1_{TO}| b^\\dagger |0_{c},0_{TO}\\rangle = \\hbar g$.\nSince $g$ is real, $H_{21} = H_{12}^* = H_{12}$.\n\nThe Hamiltonian in this basis is represented by the matrix:\n$$\nH = \\begin{pmatrix} \\hbar \\omega_c  \\hbar g \\\\ \\hbar g  \\hbar \\omega_{TO} \\end{pmatrix}\n$$\n\nStep 2: Eigenvalues and Eigenvector\nThe eigenvalues $E$ are found by solving the characteristic equation $\\det(H - E I) = 0$:\n$$\n(\\hbar \\omega_c - E)(\\hbar \\omega_{TO} - E) - (\\hbar g)^2 = 0\n$$\n$$\nE^2 - E\\hbar(\\omega_c + \\omega_{TO}) + \\hbar^2\\omega_c\\omega_{TO} - \\hbar^2g^2 = 0\n$$\nThe solutions for the energy eigenvalues $E_{\\pm}$ are:\n$$\nE_{\\pm} = \\frac{\\hbar}{2} \\left[ (\\omega_c + \\omega_{TO}) \\pm \\sqrt{(\\omega_c + \\omega_{TO})^2 - 4(\\omega_c\\omega_{TO} - g^2)} \\right]\n$$\n$$\nE_{\\pm} = \\frac{\\hbar}{2} \\left[ (\\omega_c + \\omega_{TO}) \\pm \\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2} \\right]\n$$\nThe lower polariton corresponds to the lower energy eigenvalue, $E_{-}$:\n$$\nE_{-} = \\frac{\\hbar}{2} \\left[ (\\omega_c + \\omega_{TO}) - \\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2} \\right]\n$$\n\nStep 3: Determine Coefficients\nThe lower polariton state is $|1_{-}\\rangle = u_{-}|1_{c},0_{TO}\\rangle + v_{-}|0_{c},1_{TO}\\rangle$. This is the eigenvector corresponding to $E_{-}$. The coefficients $u_{-}$ and $v_{-}$ satisfy the eigenvalue equation:\n$$\n\\begin{pmatrix} \\hbar \\omega_c  \\hbar g \\\\ \\hbar g  \\hbar \\omega_{TO} \\end{pmatrix} \\begin{pmatrix} u_{-} \\\\ v_{-} \\end{pmatrix} = E_{-} \\begin{pmatrix} u_{-} \\\\ v_{-} \\end{pmatrix}\n$$\nFrom the first row, we have $\\hbar\\omega_c u_{-} + \\hbar g v_{-} = E_{-} u_{-}$, which gives the ratio:\n$$\n\\frac{v_{-}}{u_{-}} = \\frac{E_{-} - \\hbar\\omega_c}{\\hbar g}\n$$\nThe coefficients are normalized such that $|u_{-}|^2 + |v_{-}|^2 = 1$. Let's define the detuning $\\Delta = \\omega_c - \\omega_{TO}$ and the generalized Rabi frequency $\\Omega_R = \\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2} = \\sqrt{\\Delta^2 + 4g^2}$.\nThe energy can be written as $E_{-} = \\frac{\\hbar}{2}(\\omega_c + \\omega_{TO} - \\Omega_R)$.\nThen $E_{-} - \\hbar\\omega_c = \\frac{\\hbar}{2}(\\omega_{TO} - \\omega_c - \\Omega_R) = -\\frac{\\hbar}{2}(\\Delta + \\Omega_R)$.\nThe ratio of coefficients squared is:\n$$\n\\frac{|v_{-}|^2}{|u_{-}|^2} = \\left(\\frac{-\\frac{\\hbar}{2}(\\Delta + \\Omega_R)}{\\hbar g}\\right)^2 = \\frac{(\\Delta + \\Omega_R)^2}{4g^2}\n$$\nUsing the normalization condition $|u_{-}|^2(1 + |v_{-}|^2/|u_{-}|^2) = 1$, we find:\n$$\n|u_{-}|^2 = \\frac{1}{1 + \\frac{(\\Delta + \\Omega_R)^2}{4g^2}} = \\frac{4g^2}{4g^2 + (\\Delta + \\Omega_R)^2}\n$$\n$$\n|v_{-}|^2 = 1 - |u_{-}|^2 = \\frac{(\\Delta + \\Omega_R)^2}{4g^2 + (\\Delta + \\Omega_R)^2}\n$$\nWe can simplify the denominator: $4g^2 + (\\Delta + \\Omega_R)^2 = 4g^2 + \\Delta^2 + 2\\Delta\\Omega_R + \\Omega_R^2 = (\\Delta^2+4g^2) + \\Delta^2 + 2\\Delta\\Omega_R + \\Omega_R^2 = 2(\\Delta^2+4g^2) + 2\\Delta\\Omega_R = 2\\Omega_R^2 + 2\\Delta\\Omega_R = 2\\Omega_R(\\Omega_R+\\Delta)$.\nSo, the coefficients are:\n$$\n|u_{-}|^2 = \\frac{4g^2}{2\\Omega_R(\\Omega_R+\\Delta)} = \\frac{2g^2}{\\Omega_R(\\Omega_R+\\Delta)}\n$$\n$$\n|v_{-}|^2 = \\frac{(\\Delta + \\Omega_R)^2}{2\\Omega_R(\\Omega_R+\\Delta)} = \\frac{\\Delta + \\Omega_R}{2\\Omega_R}\n$$\nWe can verify that $|u_{-}|^2 + |v_{-}|^2 = \\frac{2g^2}{\\Omega_R(\\Omega_R+\\Delta)} + \\frac{(\\Omega_R+\\Delta)^2}{2\\Omega_R(\\Omega_R+\\Delta)} \\times \\frac{1}{\\Omega_R+\\Delta} = ...$\nLet's use an identity: $4g^2 = \\Omega_R^2 - \\Delta^2 = (\\Omega_R-\\Delta)(\\Omega_R+\\Delta)$.\nThen $|u_{-}|^2 = \\frac{2g^2(\\Omega_R-\\Delta)}{\\Omega_R(\\Omega_R+\\Delta)(\\Omega_R-\\Delta)} = \\frac{2g^2(\\Omega_R-\\Delta)}{\\Omega_R(4g^2)} = \\frac{\\Omega_R-\\Delta}{2\\Omega_R}$.\nSo we have $|u_{-}|^2 = \\frac{\\Omega_R-\\Delta}{2\\Omega_R}$ and $|v_{-}|^2 = \\frac{\\Omega_R+\\Delta}{2\\Omega_R}$. Their sum is $\\frac{\\Omega_R-\\Delta + \\Omega_R+\\Delta}{2\\Omega_R} = \\frac{2\\Omega_R}{2\\Omega_R} = 1$. These are the correct simplified forms.\n\nStep 4: Calculate Expectation Values\nThe bare-energy partition fraction is $f_{-} = \\frac{\\langle 1_{-}|H_{\\text{TO}}|1_{-}\\rangle}{\\langle 1_{-}|H_{\\text{ph}}+H_{\\text{TO}}|1_{-}\\rangle}$.\nThe operators are $H_{\\text{TO}} = \\hbar\\omega_{TO}b^{\\dagger}b$ and $H_{\\text{ph}} = \\hbar\\omega_{c}a^{\\dagger}a$.\nNumerator: $\\langle 1_{-}|H_{\\text{TO}}|1_{-}\\rangle = \\langle u_{-}^{*}\\langle 1_{c},0_{TO}| + v_{-}^{*}\\langle 0_{c},1_{TO}| | \\hbar\\omega_{TO}b^{\\dagger}b | u_{-}|1_{c},0_{TO}\\rangle + v_{-}|0_{c},1_{TO}\\rangle \\rangle = |v_{-}|^2 \\hbar\\omega_{TO}$.\nDenominator: $\\langle 1_{-}|H_{\\text{ph}}+H_{\\text{TO}}|1_{-}\\rangle = |u_{-}|^2 \\hbar\\omega_{c} + |v_{-}|^2 \\hbar\\omega_{TO}$.\n\nStep 5: Final Expression for $f_{-}$\nSubstituting the expectation values, we get:\n$$\nf_{-} = \\frac{|v_{-}|^2 \\hbar\\omega_{TO}}{|u_{-}|^2 \\hbar\\omega_{c} + |v_{-}|^2 \\hbar\\omega_{TO}} = \\frac{|v_{-}|^2 \\omega_{TO}}{|u_{-}|^2 \\omega_{c} + |v_{-}|^2 \\omega_{TO}}\n$$\nNow, substitute the expressions for $|u_{-}|^2$ and $|v_{-}|^2$ in terms of $\\Delta$ and $\\Omega_R$:\n$$\nf_{-} = \\frac{\\left(\\frac{\\Omega_R+\\Delta}{2\\Omega_R}\\right) \\omega_{TO}}{\\left(\\frac{\\Omega_R-\\Delta}{2\\Omega_R}\\right) \\omega_c + \\left(\\frac{\\Omega_R+\\Delta}{2\\Omega_R}\\right) \\omega_{TO}}\n$$\nMultiplying the numerator and denominator by $2\\Omega_R$:\n$$\nf_{-} = \\frac{(\\Omega_R+\\Delta)\\omega_{TO}}{(\\Omega_R-\\Delta)\\omega_c + (\\Omega_R+\\Delta)\\omega_{TO}}\n$$\nLet's expand the denominator and simplify:\nDenominator = $\\Omega_R\\omega_c - \\Delta\\omega_c + \\Omega_R\\omega_{TO} + \\Delta\\omega_{TO} = \\Omega_R(\\omega_c+\\omega_{TO}) + \\Delta(\\omega_{TO}-\\omega_c) = \\Omega_R(\\omega_c+\\omega_{TO}) - \\Delta^2$.\nSo, the expression becomes:\n$$\nf_{-} = \\frac{(\\Omega_R+\\Delta)\\omega_{TO}}{\\Omega_R(\\omega_c+\\omega_{TO}) - \\Delta^2}\n$$\nFinally, we substitute back the definitions of $\\Delta = \\omega_c - \\omega_{TO}$ and $\\Omega_R = \\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2}$:\n$$\nf_{-} = \\frac{\\left(\\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2} + \\omega_c - \\omega_{TO}\\right)\\omega_{TO}}{(\\omega_c+\\omega_{TO})\\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2} - (\\omega_c - \\omega_{TO})^2}\n$$\nThis is the final closed-form expression for the bare-energy partition fraction $f_{-}$.", "answer": "$$\n\\boxed{\\frac{\\left(\\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2} + \\omega_c - \\omega_{TO}\\right)\\omega_{TO}}{(\\omega_c+\\omega_{TO})\\sqrt{(\\omega_c - \\omega_{TO})^2 + 4g^2} - (\\omega_c - \\omega_{TO})^2}}\n$$", "id": "3010562"}, {"introduction": "In any real physical system, energy is not perfectly conserved, leading to finite lifetimes and spectral linewidths. This practice extends our understanding from the ideal, lossless polariton to a more realistic scenario that includes damping. By treating the photon and phonon damping rates as a perturbation [@problem_id:3010552], you will discover that the linewidth of a polariton is a weighted average of its constituent parts, providing a key link between the quantum composition of the quasi-particle and what is observed in experimental spectroscopy.", "problem": "Consider a homogeneous polar crystal supporting a single transverse optical phonon of angular frequency $\\omega_{0}$ and phenomenological damping rate $\\Gamma$, coupled to a transverse photon mode of angular frequency $\\omega_{c}(k)$ at wavevector $k$ and damping rate $\\kappa$. In the linear-response regime and under the Rotating Wave Approximation (RWA), the coupled photon-phonon system can be modeled as two linearly coupled harmonic modes with real coupling strength $g$. Assume weak damping, meaning $\\kappa, \\Gamma \\ll \\omega_{c}(k), \\omega_{0}, g, |\\omega_{c}(k) - \\omega_{0}|$, such that the hybridization is primarily determined by the conservative coupling and damping can be treated perturbatively.\n\nStarting from the classical equations of motion for the coupled mode amplitudes and using standard eigenmode analysis, derive the analytic expression for the full width at half maximum (FWHM) linewidth of the lower phonon-polariton (LP) mode, denoted $\\gamma_{\\mathrm{LP}}(k)$, at fixed wavevector $k$. Express your answer in terms of the detuning $\\Delta \\equiv \\omega_{c}(k) - \\omega_{0}$, the coupling $g$, and the damping rates $\\kappa$ and $\\Gamma$. Define $\\gamma_{\\mathrm{LP}}(k)$ as twice the absolute value of the imaginary part of the complex LP eigenfrequency, and assume the LP eigenvector is normalized such that the sum of photon and phonon intensity fractions equals unity. Your final answer must be a single closed-form analytic expression.", "solution": "The problem asks for the analytic expression for the full width at half maximum (FWHM) linewidth of the lower phonon-polariton (LP) mode, denoted $\\gamma_{\\mathrm{LP}}(k)$, in a system where a transverse optical phonon is coupled to a transverse photon.\n\nThe dynamics of the coupled system, under the Rotating Wave Approximation (RWA) and including damping, can be described by a set of two coupled linear differential equations for the complex amplitudes of the photon mode, $a(t)$, and the phonon mode, $b(t)$. In matrix form, these equations are:\n$$\ni\\frac{d}{dt} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} \\omega_c(k) - i\\frac{\\kappa}{2}  g \\\\ g  \\omega_0 - i\\frac{\\Gamma}{2} \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix}\n$$\nHere, $\\omega_c(k)$ and $\\omega_0$ are the resonant frequencies of the uncoupled photon and phonon modes, respectively. The parameters $\\kappa$ and $\\Gamma$ are the phenomenological energy damping rates, which correspond to amplitude damping rates of $\\frac{\\kappa}{2}$ and $\\frac{\\Gamma}{2}$. The real parameter $g$ represents the coupling strength between the two modes.\n\nWe search for eigenmode solutions of the form $\\begin{pmatrix} a(t) \\\\ b(t) \\end{pmatrix} = \\begin{pmatrix} a_0 \\\\ b_0 \\end{pmatrix} e^{-i\\Omega t}$, where $\\Omega$ is the complex eigenfrequency of the polariton mode. Substituting this ansatz into the equations of motion yields the eigenvalue problem:\n$$\n\\begin{pmatrix} \\omega_c(k) - i\\frac{\\kappa}{2}  g \\\\ g  \\omega_0 - i\\frac{\\Gamma}{2} \\end{pmatrix} \\begin{pmatrix} a_0 \\\\ b_0 \\end{pmatrix} = \\Omega \\begin{pmatrix} a_0 \\\\ b_0 \\end{pmatrix}\n$$\nThe problem states that the damping is weak ($\\kappa, \\Gamma \\ll g, |\\omega_c(k) - \\omega_0|$), which justifies a perturbative approach. We first determine the eigenmodes of the conservative (undamped) system and then calculate the effect of damping as a first-order perturbation.\n\nThe undamped system is described by the Hermitian matrix:\n$$\nH_0 = \\begin{pmatrix} \\omega_c(k)  g \\\\ g  \\omega_0 \\end{pmatrix}\n$$\nThe eigenvalues $\\omega_{\\pm}$ of $H_0$ represent the real parts of the polariton frequencies. They are found by solving the characteristic equation $\\det(H_0 - \\omega I) = 0$:\n$$\n(\\omega_c(k) - \\omega)(\\omega_0 - \\omega) - g^2 = 0\n$$\nThe solutions are the frequencies of the upper polariton (UP, $\\omega_+$) and lower polariton (LP, $\\omega_-$) branches:\n$$\n\\omega_{\\pm} = \\frac{\\omega_c(k) + \\omega_0}{2} \\pm \\frac{1}{2}\\sqrt{(\\omega_c(k) - \\omega_0)^2 + 4g^2}\n$$\nWe are interested in the lower polariton mode, with real frequency $\\omega_{\\mathrm{LP}} = \\omega_-$.\n\nThe corresponding eigenvector for the LP mode, $|\\psi_{\\mathrm{LP}}\\rangle$, is a linear combination of the uncoupled photon state $|a\\rangle$ and phonon state $|b\\rangle$: $|\\psi_{\\mathrm{LP}}\\rangle = C_{\\mathrm{LP}}|a\\rangle + X_{\\mathrm{LP}}|b\\rangle$. The squared magnitudes of the coefficients, $|C_{\\mathrm{LP}}|^2$ and $|X_{\\mathrm{LP}}|^2$, are the Hopfield coefficients, which represent the photonic and phononic fractions of the LP mode, respectively. The normalization condition is $|C_{\\mathrm{LP}}|^2 + |X_{\\mathrm{LP}}|^2 = 1$. These coefficients depend on the detuning $\\Delta \\equiv \\omega_c(k) - \\omega_0$ and the coupling $g$. The well-established expressions for these fractions for the LP branch are:\n- Photon fraction: $|C_{\\mathrm{LP}}|^2 = \\frac{1}{2}\\left(1 - \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4g^2}}\\right)$\n- Phonon fraction: $|X_{\\mathrm{LP}}|^2 = \\frac{1}{2}\\left(1 + \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4g^2}}\\right)$\n\nNext, we treat the damping terms as a perturbation $V$ to the conservative Hamiltonian $H_0$:\n$$\nV = \\begin{pmatrix} -i\\frac{\\kappa}{2}  0 \\\\ 0  -i\\frac{\\Gamma}{2} \\end{pmatrix}\n$$\nAccording to first-order perturbation theory, the correction to the LP eigenfrequency is the expectation value of the perturbation in the unperturbed LP state:\n$$\n\\delta\\Omega_{\\mathrm{LP}} = \\langle\\psi_{\\mathrm{LP}}|V|\\psi_{\\mathrm{LP}}\\rangle = \\begin{pmatrix} C_{\\mathrm{LP}}^*  X_{\\mathrm{LP}}^* \\end{pmatrix} V \\begin{pmatrix} C_{\\mathrm{LP}} \\\\ X_{\\mathrm{LP}} \\end{pmatrix} = -i\\frac{\\kappa}{2}|C_{\\mathrm{LP}}|^2 - i\\frac{\\Gamma}{2}|X_{\\mathrm{LP}}|^2\n$$\nThis correction is purely imaginary and adds to the real frequency $\\omega_{\\mathrm{LP}}$ to give the complex eigenfrequency $\\Omega_{\\mathrm{LP}}$:\n$$\n\\Omega_{\\mathrm{LP}} = \\omega_{\\mathrm{LP}} + \\delta\\Omega_{\\mathrm{LP}} = \\omega_{\\mathrm{LP}} - i\\left(\\frac{\\kappa}{2}|C_{\\mathrm{LP}}|^2 + \\frac{\\Gamma}{2}|X_{\\mathrm{LP}}|^2\\right)\n$$\nThe imaginary part of the LP eigenfrequency is therefore:\n$$\n\\operatorname{Im}(\\Omega_{\\mathrm{LP}}) = -\\frac{1}{2}\\left(\\kappa|C_{\\mathrm{LP}}|^2 + \\Gamma|X_{\\mathrm{LP}}|^2\\right)\n$$\nThe problem defines the FWHM linewidth $\\gamma_{\\mathrm{LP}}(k)$ as twice the absolute value of this imaginary part:\n$$\n\\gamma_{\\mathrm{LP}}(k) = 2|\\operatorname{Im}(\\Omega_{\\mathrm{LP}})| = 2\\left|\\frac{1}{2}\\left(\\kappa|C_{\\mathrm{LP}}|^2 + \\Gamma|X_{\\mathrm{LP}}|^2\\right)\\right| = \\kappa|C_{\\mathrm{LP}}|^2 + \\Gamma|X_{\\mathrm{LP}}|^2\n$$\nThis result confirms the intuition that the linewidth of the composite particle is a weighted average of the linewidths of its constituent parts, where the weights are their respective fractional contents.\n\nFinally, we substitute the expressions for the Hopfield coefficients into the equation for $\\gamma_{\\mathrm{LP}}(k)$:\n$$\n\\gamma_{\\mathrm{LP}}(k) = \\kappa\\left[\\frac{1}{2}\\left(1 - \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4g^2}}\\right)\\right] + \\Gamma\\left[\\frac{1}{2}\\left(1 + \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4g^2}}\\right)\\right]\n$$\nGrouping the terms yields the final closed-form analytic expression for the linewidth:\n$$\n\\gamma_{\\mathrm{LP}}(k) = \\frac{\\kappa + \\Gamma}{2} + \\frac{\\Gamma - \\kappa}{2} \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4g^2}}\n$$", "answer": "$$\n\\boxed{\\frac{\\kappa + \\Gamma}{2} + \\frac{\\Gamma - \\kappa}{2} \\frac{\\Delta}{\\sqrt{\\Delta^2 + 4g^2}}}\n$$", "id": "3010552"}, {"introduction": "The microscopic physics of phonon-polaritons gives rise to distinct, macroscopic optical signatures, most notably the Reststrahlen band of high infrared reflectivity. This comprehensive exercise challenges you to model this phenomenon from first principles, connecting a classical Lorentz oscillator description of the lattice to Maxwell's equations and Fresnel analysis. By implementing your derivation in a computational model [@problem_id:3010573], you will simulate the full reflectivity spectrum and gain a practical understanding of how to predict and interpret the unique optical properties of polar materials.", "problem": "Consider a semi-infinite polar insulating crystal occupying $z \\ge 0$, interfaced with vacuum for $z  0$. The crystal hosts a single infrared (IR) active optical phonon that couples to the electromagnetic field and produces photon-phonon polaritons. You are asked to derive and implement the reflectivity at the vacuum-crystal interface using Fresnel analysis based on first principles. \n\nStarting only from the following bases:\n- Maxwell’s equations in matter together with the constitutive relations $\\mathbf{D} = \\varepsilon_0 \\mathbf{E} + \\mathbf{P}$ and $\\mathbf{B} = \\mu_0 \\mathbf{H}$.\n- A Lorentz oscillator description of the IR-active lattice polarization with a single resonance at the transverse optical (TO) phonon frequency, i.e., the driven damped harmonic oscillator equation of motion for the ionic displacement.\n- The applicability of boundary conditions at a planar interface ensuring continuity of tangential $\\mathbf{E}$ and $\\mathbf{H}$ fields, and Snell’s law generalized to complex refractive indices.\n\nYour task is to:\n1. Derive the complex, frequency-dependent dielectric function $\\varepsilon(\\omega)$ of the crystal in terms of the high-frequency dielectric constant $\\varepsilon_\\infty$, the transverse optical phonon angular frequency $\\omega_{\\mathrm{TO}}$, the longitudinal optical phonon angular frequency $\\omega_{\\mathrm{LO}}$, and the damping rate $\\gamma$. Use the Lorentz oscillator model for the lattice polarization and impose the longitudinal optical (LO) condition associated with zeros of $\\varepsilon(\\omega)$ in the lossless limit to express the response in a form consistent with the Lyddane–Sachs–Teller relation.\n2. Derive the Fresnel reflection amplitude coefficients for $s$-polarization (transverse electric) and $p$-polarization (transverse magnetic) at the vacuum-crystal interface for an arbitrary real incidence angle $\\theta_1$ in vacuum, taking into account a complex refractive index of the crystal $n_2(\\omega) = \\sqrt{\\varepsilon(\\omega)}$. The vacuum refractive index is $n_1 = 1$. Define the reflectivity $R$ as the squared modulus of the corresponding reflection amplitude.\n3. Implement these derivations in a program that computes the reflectivity for a specified set of test cases. The transmitted angle $\\theta_2$ inside the crystal must be obtained via the generalized Snell’s law $n_1 \\sin \\theta_1 = n_2 \\sin \\theta_2$, choosing the branch of $\\cos \\theta_2$ consistent with energy not radiating to infinity inside an absorbing medium.\n\nPhysical units and output requirements:\n- All angular frequencies must be expressed and handled in $\\mathrm{rad/s}$.\n- All angles must be expressed and handled in radians.\n- Reflectivity is dimensionless and must be returned as a floating-point number.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, following the order specified in the test suite.\n\nUse the following fixed material parameters for all test cases:\n- High-frequency dielectric constant: $\\varepsilon_\\infty = 5.0$.\n- Transverse optical phonon angular frequency: $\\omega_{\\mathrm{TO}} = 6.0 \\times 10^{13}\\ \\mathrm{rad/s}$.\n- Longitudinal optical phonon angular frequency: $\\omega_{\\mathrm{LO}} = 1.0 \\times 10^{14}\\ \\mathrm{rad/s}$.\n- Damping rate: $\\gamma = 5.0 \\times 10^{11}\\ \\mathrm{s^{-1}}$.\n- Speed of light: $c = 2.99792458 \\times 10^8\\ \\mathrm{m/s}$ (if needed in intermediate steps; it does not appear explicitly in the final Fresnel interface formulas).\n\nDefine polarization selector $p_{\\mathrm{sel}}$ as $0$ for $s$-polarization and $1$ for $p$-polarization.\n\nTest suite (provide outputs in the exact order below):\n- Case 1 (general case, below resonance): Compute reflectivity $R$ at $\\omega = 3.0 \\times 10^{13}\\ \\mathrm{rad/s}$, $\\theta_1 = 0$ (normal incidence), $p_{\\mathrm{sel}} = 0$.\n- Case 2 (inside Reststrahlen band): Compute $R$ at $\\omega = 8.0 \\times 10^{13}\\ \\mathrm{rad/s}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 3 (above LO): Compute $R$ at $\\omega = 1.5 \\times 10^{14}\\ \\mathrm{rad/s}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 4 (oblique incidence, $s$): Compute $R$ at $\\omega = 1.5 \\times 10^{14}\\ \\mathrm{rad/s}$, $\\theta_1 = \\pi/4$, $p_{\\mathrm{sel}} = 0$.\n- Case 5 (near Brewster-like incidence in the weakly absorbing high-frequency regime, $p$): Compute $R$ at $\\omega = 1.5 \\times 10^{14}\\ \\mathrm{rad/s}$, $\\theta_1 = \\arctan\\!\\left(\\sqrt{\\varepsilon_\\infty}\\right)$, $p_{\\mathrm{sel}} = 1$.\n- Case 6 (at TO resonance): Compute $R$ at $\\omega = \\omega_{\\mathrm{TO}}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 7 (at LO frequency): Compute $R$ at $\\omega = \\omega_{\\mathrm{LO}}$, $\\theta_1 = 0$, $p_{\\mathrm{sel}} = 0$.\n- Case 8 (Lyddane–Sachs–Teller check): Return a boolean value indicating whether $\\left|\\frac{\\varepsilon(0)}{\\varepsilon_\\infty} - \\left(\\frac{\\omega_{\\mathrm{LO}}}{\\omega_{\\mathrm{TO}}}\\right)^2\\right|  10^{-9}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order: $[R_1, R_2, R_3, R_4, R_5, R_6, R_7, \\text{LST\\_check}]$.", "solution": "The problem requires the derivation of the reflectivity at a vacuum-crystal interface, accounting for photon-phonon coupling in the crystal. The solution is structured in three parts: first, a derivation of the crystal's dielectric function $\\varepsilon(\\omega)$ from the Lorentz oscillator model; second, the derivation of the Fresnel reflection coefficients; and third, the implementation of these formulas to compute reflectivity for specific cases.\n\n### Part 1: Derivation of the Dielectric Function $\\varepsilon(\\omega)$\n\nWe begin by modeling the response of the infrared (IR) active optical phonons in the polar crystal to an external electric field $\\mathbf{E}$. The ionic displacement $\\mathbf{w}$ relative to the equilibrium positions can be described by the equation of a driven, damped harmonic oscillator:\n$$ M(\\ddot{\\mathbf{w}} + \\gamma \\dot{\\mathbf{w}} + \\omega_{\\mathrm{TO}}^2 \\mathbf{w}) = q^* \\mathbf{E} $$\nHere, $M$ is the reduced mass of the ion pair, $q^*$ is the effective ionic charge, $\\gamma$ is the phenomenological damping rate, and $\\omega_{\\mathrm{TO}}$ is the natural resonance frequency, corresponding to the transverse optical (TO) phonon frequency.\n\nAssuming a harmonic time dependence for the fields, $\\mathbf{E}(t) = \\mathbf{E}_0 e^{-i\\omega t}$ and $\\mathbf{w}(t) = \\mathbf{w}_0 e^{-i\\omega t}$, the equation of motion becomes algebraic:\n$$ M(-\\omega^2 - i\\omega\\gamma + \\omega_{\\mathrm{TO}}^2) \\mathbf{w} = q^* \\mathbf{E} $$\nSolving for the displacement $\\mathbf{w}$:\n$$ \\mathbf{w} = \\frac{q^*/M}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} \\mathbf{E} $$\nThis displacement creates a lattice polarization $\\mathbf{P}_{\\text{ion}} = N \\mathbf{p} = N q^* \\mathbf{w}$, where $N$ is the density of ion pairs:\n$$ \\mathbf{P}_{\\text{ion}} = \\frac{N (q^*)^2 / M}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} \\mathbf{E} $$\nThe total dielectric displacement $\\mathbf{D}$ is given by the constitutive relation $\\mathbf{D} = \\varepsilon_0 \\mathbf{E} + \\mathbf{P}$, where $\\varepsilon_0$ is the vacuum permittivity. The total polarization $\\mathbf{P}$ has two contributions: the ionic polarization $\\mathbf{P}_{\\text{ion}}$ and the electronic polarization $\\mathbf{P}_{\\text{elec}}$, which arises from the distortion of electron clouds. At frequencies far above the phonon resonance ($\\omega \\gg \\omega_{\\mathrm{TO}}$), the ions cannot respond, so only the electronic part contributes. In this limit, the dielectric function is the high-frequency dielectric constant $\\varepsilon_\\infty$, so $\\mathbf{D} = \\varepsilon_0 \\varepsilon_\\infty \\mathbf{E}$. This implies $\\mathbf{P}_{\\text{elec}} = \\varepsilon_0(\\varepsilon_\\infty - 1)\\mathbf{E}$.\n\nThe total displacement is therefore $\\mathbf{D} = \\varepsilon_0\\mathbf{E} + \\mathbf{P}_{\\text{elec}} + \\mathbf{P}_{\\text{ion}} = \\varepsilon_0\\varepsilon_\\infty\\mathbf{E} + \\mathbf{P}_{\\text{ion}}$. We define the frequency-dependent dielectric function $\\varepsilon(\\omega)$ via $\\mathbf{D} = \\varepsilon_0 \\varepsilon(\\omega) \\mathbf{E}$. Comparing these expressions gives:\n$$ \\varepsilon_0 \\varepsilon(\\omega) \\mathbf{E} = \\varepsilon_0 \\varepsilon_\\infty \\mathbf{E} + \\frac{N (q^*)^2 / (M \\varepsilon_0)}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} \\mathbf{E} $$\n$$ \\varepsilon(\\omega) = \\varepsilon_\\infty + \\frac{N (q^*)^2 / (M \\varepsilon_0)}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} $$\nTo express this in terms of the given parameters, we must determine the oscillator strength term. The problem instructs us to use the longitudinal optical (LO) phonon condition, which states that for longitudinal modes, $\\varepsilon(\\omega_{\\mathrm{LO}}) = 0$ in the lossless limit ($\\gamma = 0$).\n\nIn the lossless limit, the dielectric function is:\n$$ \\varepsilon(\\omega) = \\varepsilon_\\infty + \\frac{S \\omega_{\\mathrm{TO}}^2}{\\omega_{\\mathrm{TO}}^2 - \\omega^2} $$\nwhere we have defined an oscillator strength parameter $S \\omega_{\\mathrm{TO}}^2 = N (q^*)^2 / (M \\varepsilon_0)$. Applying the condition $\\varepsilon(\\omega_{\\mathrm{LO}}) = 0$:\n$$ 0 = \\varepsilon_\\infty + \\frac{S \\omega_{\\mathrm{TO}}^2}{\\omega_{\\mathrm{TO}}^2 - \\omega_{\\mathrm{LO}}^2} \\implies S \\omega_{\\mathrm{TO}}^2 = -\\varepsilon_\\infty(\\omega_{\\mathrm{TO}}^2 - \\omega_{\\mathrm{LO}}^2) = \\varepsilon_\\infty(\\omega_{\\mathrm{LO}}^2 - \\omega_{\\mathrm{TO}}^2) $$\nSubstituting this back into the full damped expression for $\\varepsilon(\\omega)$:\n$$ \\varepsilon(\\omega) = \\varepsilon_\\infty + \\frac{\\varepsilon_\\infty(\\omega_{\\mathrm{LO}}^2 - \\omega_{\\mathrm{TO}}^2)}{\\omega_{\\mathrm{TO}}^2 - \\omega^2 - i\\omega\\gamma} $$\nThis is the required formula for the dielectric function. As a check, we can evaluate this at $\\omega=0$ to find the static dielectric constant $\\varepsilon_s = \\varepsilon(0)$:\n$$ \\varepsilon_s = \\varepsilon_\\infty + \\frac{\\varepsilon_\\infty(\\omega_{\\mathrm{LO}}^2 - \\omega_{\\mathrm{TO}}^2)}{\\omega_{\\mathrm{TO}}^2} = \\varepsilon_\\infty \\left(1 + \\frac{\\omega_{\\mathrm{LO}}^2}{\\omega_{\\mathrm{TO}}^2} - 1\\right) = \\varepsilon_\\infty \\left(\\frac{\\omega_{\\mathrm{LO}}}{\\omega_{\\mathrm{TO}}}\\right)^2 $$\nThis yields the Lyddane-Sachs-Teller (LST) relation: $\\varepsilon_s/\\varepsilon_\\infty = (\\omega_{\\mathrm{LO}}/\\omega_{\\mathrm{TO}})^2$.\n\n### Part 2: Fresnel Reflection Coefficients\n\nWe consider a plane wave incident from vacuum (medium 1, refractive index $n_1=1$) onto the crystal (medium 2, complex refractive index $n_2(\\omega) = \\sqrt{\\varepsilon(\\omega)}$). The angle of incidence in vacuum is $\\theta_1$. The angle of transmission into the crystal is $\\theta_2$.\n\nThe relationship between angles is given by the generalized Snell's law: $n_1 \\sin\\theta_1 = n_2 \\sin\\theta_2$. With $n_1=1$:\n$$ \\sin\\theta_2 = \\frac{\\sin\\theta_1}{n_2(\\omega)} $$\nWe need $\\cos\\theta_2 = \\sqrt{1 - \\sin^2\\theta_2}$.\n$$ \\cos\\theta_2 = \\sqrt{1 - \\frac{\\sin^2\\theta_1}{n_2^2(\\omega)}} = \\frac{\\sqrt{n_2^2(\\omega) - \\sin^2\\theta_1}}{n_2(\\omega)} = \\frac{\\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}}{n_2(\\omega)} $$\nThe wave propagating into medium 2 has a spatial dependence of the form $e^{i k_{2z} z}$. For the wave to be physically realistic (i.e., not growing infinitely inside an absorbing medium), its amplitude must decay with increasing $z$. This requires the z-component of the wavevector, $k_{2z} = k_2 \\cos\\theta_2 = \\frac{\\omega}{c} n_2 \\cos\\theta_2$, to have a non-negative imaginary part: $\\text{Im}(k_{2z}) \\ge 0$.\n$$ k_{2z} = \\frac{\\omega}{c} \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1} $$\nThus, we must choose the branch of the complex square root such that $\\text{Im}(\\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}) \\ge 0$.\n\nThe Fresnel amplitude reflection coefficients $r$ are given for the electric field components. For $s$-polarization (TE, E-field perpendicular to the plane of incidence):\n$$ r_s = \\frac{n_1 \\cos\\theta_1 - n_2 \\cos\\theta_2}{n_1 \\cos\\theta_1 + n_2 \\cos\\theta_2} = \\frac{\\cos\\theta_1 - \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}}{\\cos\\theta_1 + \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}} $$\nFor $p$-polarization (TM, E-field parallel to the plane of incidence):\n$$ r_p = \\frac{n_2 \\cos\\theta_1 - n_1 \\cos\\theta_2}{n_2 \\cos\\theta_1 + n_1 \\cos\\theta_2} = \\frac{\\varepsilon(\\omega)\\cos\\theta_1 - \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}}{\\varepsilon(\\omega)\\cos\\theta_1 + \\sqrt{\\varepsilon(\\omega) - \\sin^2\\theta_1}} $$\nThe reflectivity $R$ is the squared modulus of the reflection coefficient: $R_s = |r_s|^2$ and $R_p = |r_p|^2$.\n\nFor normal incidence ($\\theta_1 = 0$), these simplify. We have $\\cos\\theta_1=1$ and $\\sin\\theta_1=0$.\n$$ r_s = r_p = \\frac{1 - \\sqrt{\\varepsilon(\\omega)}}{1 + \\sqrt{\\varepsilon(\\omega)}} = \\frac{1 - n_2(\\omega)}{1 + n_2(\\omega)} $$\nThe reflectivity is $R = \\left|\\frac{1 - n_2(\\omega)}{1 + n_2(\\omega)}\\right|^2$.\n\n### Part 3: Implementation Strategy\n\nThe implementation will follow the derived formulas.\n1. A function calculates $\\varepsilon(\\omega)$ using the derived expression for any given angular frequency $\\omega$.\n2. For a specified set of input parameters ($\\omega$, $\\theta_1$, $p_{\\mathrm{sel}}$), the program computes the reflectivity.\n3. For normal incidence ($\\theta_1=0$), the simplified formula is used. The complex refractive index $n_2(\\omega) = \\sqrt{\\varepsilon(\\omega)}$ is computed, ensuring the principal root (positive real and imaginary parts for a passive medium) is taken.\n4. For oblique incidence ($\\theta_1 > 0$), the quantity $Y = \\varepsilon(\\omega) - \\sin^2\\theta_1$ is calculated. Its square root, $\\sqrt{Y}$, is computed and its sign is adjusted if necessary to ensure its imaginary part is non-negative, satisfying the physical condition for a decaying wave. The appropriate Fresnel coefficient ($r_s$ or $r_p$) is then computed.\n5. The reflectivity $R$ is calculated as the squared absolute value of the complex reflection coefficient.\n6. For the LST check, $\\varepsilon(0)$ is computed using the general formula with $\\omega=0$, and the result is compared against the LST prediction within a small tolerance.\nThe program structure will process each test case and format the results into the required output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes reflectivity for a vacuum-crystal interface and performs LST check.\n    The crystal's dielectric function is modeled using a Lorentz oscillator\n    accounting for photon-phonon coupling.\n    \"\"\"\n    # Fixed material parameters\n    eps_inf = 5.0\n    w_TO = 6.0e13  # rad/s\n    w_LO = 1.0e14  # rad/s\n    gamma = 5.0e11 # s^-1\n\n    params = {\n        'eps_inf': eps_inf,\n        'w_TO': w_TO,\n        'w_LO': w_LO,\n        'gamma': gamma\n    }\n\n    def get_epsilon(omega, p):\n        \"\"\"Calculates the complex dielectric function epsilon(omega).\"\"\"\n        w_sq = omega**2\n        w_TO_sq = p['w_TO']**2\n        w_LO_sq = p['w_LO']**2\n        \n        numerator = p['eps_inf'] * (w_LO_sq - w_TO_sq)\n        denominator = w_TO_sq - w_sq - 1j * omega * p['gamma']\n        \n        return p['eps_inf'] + numerator / denominator\n\n    def get_reflectivity(omega, theta1, p_sel, p):\n        \"\"\"\n        Calculates reflectivity R for s- or p-polarization.\n        p_sel = 0 for s-polarization, 1 for p-polarization.\n        \"\"\"\n        epsilon = get_epsilon(omega, p)\n\n        if np.isclose(theta1, 0):\n            # Normal incidence\n            n2 = np.sqrt(epsilon)\n            # Principal root of sqrt for complex has Re(n2) = 0.\n            # For a passive medium, Im(epsilon) = 0, which implies Im(n2) = 0.\n            # So, the principal root is the correct one.\n            r = (1.0 - n2) / (1.0 + n2)\n            return np.abs(r)**2\n\n        # Oblique incidence\n        cos_theta1 = np.cos(theta1)\n        sin_theta1_sq = np.sin(theta1)**2\n\n        # Calculate sqrt(epsilon - sin^2(theta1))\n        # The branch must be chosen such that the wave decays into the medium,\n        # which means Im(k_z) = 0. k_z is proportional to this square root.\n        # Thus, we need Im(sqrt_term) = 0.\n        sqrt_term_arg = epsilon - sin_theta1_sq\n        sqrt_term = np.sqrt(sqrt_term_arg)\n        if np.imag(sqrt_term)  0:\n            sqrt_term = -sqrt_term\n\n        if p_sel == 0:  # s-polarization\n            r = (cos_theta1 - sqrt_term) / (cos_theta1 + sqrt_term)\n        else:  # p-polarization\n            r = (epsilon * cos_theta1 - sqrt_term) / (epsilon * cos_theta1 + sqrt_term)\n        \n        return np.abs(r)**2\n\n    test_cases = [\n        # Case 1: general case, below resonance\n        {'omega': 3.0e13, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 2: inside Reststrahlen band\n        {'omega': 8.0e13, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 3: above LO\n        {'omega': 1.5e14, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 4: oblique incidence, s-pol\n        {'omega': 1.5e14, 'theta1': np.pi/4, 'p_sel': 0, 'type': 'R'},\n        # Case 5: near Brewster-like incidence, p-pol\n        {'omega': 1.5e14, 'theta1': np.arctan(np.sqrt(eps_inf)), 'p_sel': 1, 'type': 'R'},\n        # Case 6: at TO resonance\n        {'omega': w_TO, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 7: at LO frequency\n        {'omega': w_LO, 'theta1': 0.0, 'p_sel': 0, 'type': 'R'},\n        # Case 8: Lyddane–Sachs–Teller check\n        {'type': 'LST'}\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'R':\n            result = get_reflectivity(case['omega'], case['theta1'], case['p_sel'], params)\n            results.append(f\"{result:.10f}\")\n        elif case['type'] == 'LST':\n            # Calculate epsilon(0) using the general function\n            epsilon_0 = get_epsilon(0.0, params)\n            \n            # The LST relation is derived from the oscillator model, so it should be exact.\n            # The check is whether the implementation of epsilon(omega) fulfills the LST relation.\n            ratio_eps = epsilon_0 / params['eps_inf']\n            ratio_w_sq = (params['w_LO'] / params['w_TO'])**2\n            \n            lst_check_val = np.abs(ratio_eps - ratio_w_sq)  1e-9\n            results.append(str(lst_check_val))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3010573"}]}