{"hands_on_practices": [{"introduction": "The semiclassical model provides a powerful and intuitive picture of electron dynamics in a crystal lattice. This exercise is a foundational application of that model, allowing you to derive a key observable of Bloch oscillations: their real-space amplitude. By working through this problem [@problem_id:1762346], you will directly connect the energy bandwidth, a fundamental property of the material's electronic structure, to the macroscopic motion of an electron under an electric field.", "problem": "In the study of advanced semiconductor devices, one-dimensional superlattices are engineered periodic structures that create artificial minibands in the electronic energy spectrum. Consider a simplified model of such a superlattice where the energy dispersion relation for an electron in the first conduction miniband is given by the tight-binding approximation:\n$$E(k) = E_c - \\Delta \\cos(ka)$$\nHere, $k$ is the electron's crystal momentum, $a$ is the superlattice period, $E_c$ is the constant energy at the center of the miniband, and $\\Delta$ is a positive constant that determines half the width of the miniband.\n\nA uniform, static electric field of magnitude $\\mathcal{E}$ is applied along the direction of the superlattice. An electron is initially at rest at the bottom of this energy band. Using the semiclassical model of electron dynamics, determine the maximum spatial displacement of the electron from its initial position. Provide your answer as an analytic expression in terms of $\\Delta$, $e$, $\\mathcal{E}$, and $a$, where $e$ is the elementary charge.", "solution": "We use the semiclassical equations of motion for an electron in a periodic band under a uniform electric field:\n$$\\hbar \\dot{k} = -e \\mathcal{E}, \\qquad v(k) = \\frac{1}{\\hbar}\\frac{dE}{dk}.$$\nWith $E(k) = E_{c} - \\Delta \\cos(ka)$, we compute the group velocity by differentiating:\n$$\\frac{dE}{dk} = -\\Delta \\frac{d}{dk}\\cos(ka) = -\\Delta \\left(-\\sin(ka)\\right)a = \\Delta a \\sin(ka),$$\nso\n$$v(k) = \\frac{\\Delta a}{\\hbar}\\sin(ka).$$\nFor a uniform field $\\mathcal{E}$, the crystal momentum evolves as\n$$k(t) = k(0) - \\frac{e \\mathcal{E}}{\\hbar}t.$$\nThe electron is initially at rest at the bottom of the band, which occurs at $k(0) = 0$ and gives $v(0)=0$. Therefore,\n$$k(t) = -\\frac{e \\mathcal{E}}{\\hbar}t,$$\nand using $a k(t) = -\\omega_{B} t$ with the Bloch frequency $\\omega_{B} \\equiv \\frac{e \\mathcal{E} a}{\\hbar}$, the velocity becomes\n$$v(t) = \\frac{\\Delta a}{\\hbar}\\sin\\big(a k(t)\\big) = \\frac{\\Delta a}{\\hbar}\\sin(-\\omega_{B} t) = -\\frac{\\Delta a}{\\hbar}\\sin(\\omega_{B} t).$$\nThe displacement from the initial position is then\n$$x(t) - x(0) = \\int_{0}^{t} v(t')\\,dt' = -\\frac{\\Delta a}{\\hbar}\\int_{0}^{t}\\sin(\\omega_{B} t')\\,dt' = \\frac{\\Delta a}{\\hbar \\omega_{B}}\\big[\\cos(\\omega_{B} t) - 1\\big].$$\nThe cosine term ranges between $-1$ and $1$, so the displacement is bounded. Its maximum magnitude occurs when $\\cos(\\omega_{B} t) = -1$, giving\n$$\\max|x(t) - x(0)| = \\frac{\\Delta a}{\\hbar \\omega_{B}}\\big|(-1) - 1\\big| = \\frac{2\\Delta a}{\\hbar \\omega_{B}}.$$\nSubstituting $\\omega_{B} = \\frac{e \\mathcal{E} a}{\\hbar}$ yields\n$$\\max|x(t) - x(0)| = \\frac{2\\Delta a}{\\hbar}\\cdot \\frac{\\hbar}{e \\mathcal{E} a} = \\frac{2\\Delta}{e \\mathcal{E}}.$$\nThis is the maximum spatial displacement from the initial position.", "answer": "$$\\boxed{\\frac{2\\Delta}{e \\mathcal{E}}}$$", "id": "1762346"}, {"introduction": "For Bloch oscillations to occur, the energy band must be both periodic and bounded. This conceptual problem [@problem_id:1762347] challenges you to explore what happens when this condition is not met, using a simplified model for graphene's linear energy dispersion as a test case. By applying the semiclassical rules to this gapless, unbounded spectrum, you will gain a deeper appreciation for the specific requirements of the band structure that enable this remarkable oscillatory motion.", "problem": "In a simplified two-dimensional model of graphene, the low-energy electronic excitations near a specific point in momentum space, known as a Dirac point, can be described by the linear energy dispersion relation $E(\\mathbf{k}) = \\hbar v_F |\\mathbf{k}|$. Here, $\\mathbf{k} = (k_x, k_y)$ is the crystal momentum vector relative to the Dirac point, $v_F$ is a constant with units of velocity called the Fermi velocity, and $\\hbar$ is the reduced Planck constant.\n\nAn electron is described by this model. At time $t=0$, it is located at the Dirac point, corresponding to a crystal momentum $\\mathbf{k}(0) = \\mathbf{0}$. Simultaneously, a uniform and constant electric field $\\mathbf{E} = E_0 \\hat{\\mathbf{x}}$ is applied to the graphene sheet. The evolution of the electron's crystal momentum is governed by the semiclassical equation of motion $\\frac{d\\mathbf{k}}{dt} = -\\frac{e}{\\hbar}\\mathbf{E}$, where $-e$ is the charge of the electron.\n\nAssume that the electron stays within the energy band described by this linear dispersion for all relevant times and that this simplified model holds true. Which one of the following statements correctly describes the magnitude of the electron's group velocity, $|\\mathbf{v}_g(t)|$, for any time $t > 0$?\n\nA. It remains zero for all time $t > 0$.\n\nB. It increases linearly with time, proportional to $t$.\n\nC. It is a periodic, oscillatory function of time.\n\nD. It is constant and equal to the Fermi velocity $v_F$ for all $t > 0$.\n\nE. It is undefined for all time $t > 0$.", "solution": "We are given the dispersion relation $E(\\mathbf{k}) = \\hbar v_{F} |\\mathbf{k}|$ and the semiclassical equation of motion for crystal momentum,\n$$\n\\frac{d\\mathbf{k}}{dt} = -\\frac{e}{\\hbar}\\mathbf{E}.\n$$\nWith $\\mathbf{E} = E_{0}\\hat{\\mathbf{x}}$ and initial condition $\\mathbf{k}(0)=\\mathbf{0}$, integrating in time gives\n$$\n\\mathbf{k}(t) = \\mathbf{k}(0) - \\frac{e}{\\hbar}\\mathbf{E}\\,t = -\\frac{e}{\\hbar}E_{0}t\\,\\hat{\\mathbf{x}}.\n$$\nFor any $t>0$, this satisfies $|\\mathbf{k}(t)| = \\frac{e}{\\hbar}E_{0}t > 0$.\n\nThe group velocity is defined semiclassically by\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}} E(\\mathbf{k}).\n$$\nUsing $E(\\mathbf{k}) = \\hbar v_{F}|\\mathbf{k}|$, we compute\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}\\left(\\hbar v_{F}|\\mathbf{k}|\\right) = v_{F}\\nabla_{\\mathbf{k}}|\\mathbf{k}|.\n$$\nFor $\\mathbf{k}\\neq \\mathbf{0}$, the gradient satisfies $\\nabla_{\\mathbf{k}}|\\mathbf{k}| = \\frac{\\mathbf{k}}{|\\mathbf{k}|}$, hence\n$$\n\\mathbf{v}_{g}(\\mathbf{k}) = v_{F}\\frac{\\mathbf{k}}{|\\mathbf{k}|}, \\quad \\text{so} \\quad |\\mathbf{v}_{g}(\\mathbf{k})| = v_{F}.\n$$\nSince for all $t>0$ we have $\\mathbf{k}(t)\\neq \\mathbf{0}$, it follows that the magnitude of the group velocity is constant in time and equal to $v_{F}$. Therefore, the correct statement is that $|\\mathbf{v}_{g}(t)|$ is constant and equal to $v_{F}$ for all $t>0$.", "answer": "$$\\boxed{D}$$", "id": "1762347"}, {"introduction": "While the semiclassical model is an invaluable tool, it is ultimately an approximation of the full quantum dynamics. This advanced computational exercise [@problem_id:2972562] invites you to bridge the gap between theory and numerical reality by solving the time-dependent Schrödinger equation directly. By comparing the exact quantum evolution of a wave packet to its semiclassical counterpart, you will quantitatively explore the limits of the semiclassical approximation and gain insight into phenomena that lie beyond its scope.", "problem": "Consider a one-dimensional nearest-neighbor tight-binding chain with open boundary conditions, subject to a spatially uniform, static electric field. Work in natural units where the reduced Planck constant is set to $1$, the lattice constant is set to $1$, and the elementary charge is set to $1$. All quantities are therefore dimensionless. The single-particle Hamiltonian on a chain of $N$ sites is\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( |n\\rangle\\langle n+1| + |n+1\\rangle\\langle n| \\right) + F \\sum_{n=0}^{N-1} n |n\\rangle\\langle n|,\n$$\nwhere $J>0$ is the hopping amplitude, $F>0$ is the electric field magnitude, and $|n\\rangle$ denotes the Wannier state localized on site $n$. The time-dependent Schrödinger equation is\n$$\ni \\frac{d}{dt} |\\psi(t)\\rangle = \\hat{H} |\\psi(t)\\rangle.\n$$\nYou will compare the full quantum dynamics to the semiclassical dynamics of a wave packet.\n\nInitial state. The initial wave function is a Gaussian wave packet centered at site $n_0$ with quasimomentum $k_0$,\n$$\n\\psi_n(0) = \\mathcal{N} \\exp\\!\\left( -\\frac{(n-n_0)^2}{2 \\sigma^2} \\right) e^{i k_0 n},\n$$\nwhere $\\sigma$ is the real-space standard deviation, and $\\mathcal{N}$ is the normalization chosen so that $\\sum_{n=0}^{N-1} |\\psi_n(0)|^2 = 1$. The quantum expectation value of position at time $t$ is\n$$\nx_{\\mathrm{qm}}(t) = \\sum_{n=0}^{N-1} n \\, |\\psi_n(t)|^2.\n$$\n\nSemiclassical description. In the single-band semiclassical limit of a narrow wave packet in quasimomentum, use the following well-tested foundational relations as your starting point:\n- The energy dispersion for the nearest-neighbor tight-binding band is $\\varepsilon(k) = -2J \\cos k$.\n- The group velocity is $v(k) = \\frac{1}{\\hbar} \\frac{d \\varepsilon}{d k}$, which reduces in these units to $v(k) = \\frac{d \\varepsilon}{d k}$.\n- The acceleration theorem is $\\hbar \\, \\frac{d k}{d t} = -F$, which in these units reduces to $\\frac{d k}{d t} = -F$.\n\nTreat the wave packet as characterized by a single quasimomentum $k_0$ initially, and integrate the semiclassical equations of motion to obtain the semiclassical position $x_{\\mathrm{sc}}(t)$, with the initial condition $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0)$. Do not assume any final formulas; derive and implement what you need directly from these principles.\n\nComparison metric. For a given parameter set and a time interval $[0,T]$ with a uniform grid of $M$ sample times, define the root-mean-square deviation between the quantum and semiclassical positions as\n$$\n\\Delta = \\sqrt{ \\frac{1}{M} \\sum_{m=1}^{M} \\left( x_{\\mathrm{qm}}(t_m) - x_{\\mathrm{sc}}(t_m) \\right)^2 }.\n$$\nReport $\\Delta$ as a dimensionless float in lattice-site units. Round each reported value to $6$ decimal places.\n\nImplementation requirements.\n- Solve the full quantum dynamics exactly for the finite chain by diagonalizing $\\hat{H}$ and using unitary time evolution to obtain $|\\psi(t)\\rangle$ at the required times.\n- Implement the semiclassical evolution using the principles listed above.\n- Use open boundary conditions. Choose the center $n_0$ near the middle of the chain. No artificial absorbing boundaries or windowing are allowed.\n\nAngle unit. The quasimomentum $k_0$ must be specified and treated in radians.\n\nTime grid. For each case below, use a uniform grid of $M$ times $t_m = m \\, T / M$ for $m = 1, 2, \\dots, M$.\n\nTest suite. Use the following four parameter sets that probe the convergence to semiclassics and its breakdown:\n- Case $1$ (broad wave packet, weak field): $N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n- Case $2$ (narrow wave packet, same weak field): $N=201$, $J=1.0$, $F=0.05$, $k_0=0.7$, $\\sigma=3.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n- Case $3$ (broad wave packet, stronger field): $N=201$, $J=1.0$, $F=0.3$, $k_0=0.7$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n- Case $4$ (boundary-limited motion): $N=121$, $J=1.0$, $F=0.02$, $k_0=0.0$, $\\sigma=12.0$, $n_0 = \\lfloor N/2 \\rfloor$, $T = 2\\pi/F$, $M=256$.\n\nOutput format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $4$. For example, the output must look like\n$$\n[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4],\n$$\nwith each $\\Delta_i$ rounded to $6$ decimal places. The output is dimensionless and must be interpreted in lattice-site units.", "solution": "The problem requires a detailed comparison between the full quantum-mechanical evolution of a wave packet in a one-dimensional tight-binding chain and its corresponding semiclassical trajectory. This is a classic problem in solid-state physics for studying Bloch oscillations and the quantum-to-classical correspondence. I will first derive the necessary formulas for both descriptions and then outline the numerical implementation.\n\n### Quantum-Mechanical Dynamics\n\nThe system is a finite chain of $N$ discrete sites, indexed by the integer $n=0, 1, \\dots, N-1$. The state of a particle on this chain is described by a state vector $|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} \\psi_n(t) |n\\rangle$, where $\\psi_n(t)$ is the complex amplitude for the particle to be at site $n$ at time $t$. The dynamics are governed by the time-dependent Schrödinger equation, $i \\frac{d}{dt} |\\psi(t)\\rangle = \\hat{H} |\\psi(t)\\rangle$, with units where $\\hbar=1$.\n\nThe Hamiltonian $\\hat{H}$ is given by:\n$$\n\\hat{H} = -J \\sum_{n=0}^{N-2} \\left( |n\\rangle\\langle n+1| + |n+1\\rangle\\langle n| \\right) + F \\sum_{n=0}^{N-1} n |n\\rangle\\langle n|\n$$\nThe first term describes hopping between adjacent sites with amplitude $J$, and the second term represents a linear potential due to a static electric field of magnitude $F$. This potential gives rise to the Wannier-Stark ladder.\n\nThis operator can be represented as an $N \\times N$ real symmetric (and thus Hermitian) matrix $H$ in the site basis $\\{|n\\rangle\\}$. The matrix elements are:\n$$\nH_{ij} = \\langle i | \\hat{H} | j \\rangle = \\begin{cases}\n    F \\cdot i & \\text{if } i=j \\\\\n    -J & \\text{if } |i-j|=1 \\\\\n    0 & \\text{otherwise}\n\\end{cases}\n$$\nSince the Hamiltonian is time-independent, the formal solution to the Schrödinger equation is $|\\psi(t)\\rangle = e^{-iHt} |\\psi(0)\\rangle$, where $|\\psi(0)\\rangle$ is the initial state. A numerically exact solution can be obtained by diagonalizing the Hamiltonian matrix $H$. Let the eigenvalues be $E_j$ and the corresponding eigenvectors be $|\\phi_j\\rangle$, satisfying $H|\\phi_j\\rangle = E_j|\\phi_j\\rangle$. The time evolution operator can be expressed in this eigenbasis as $e^{-iHt} = \\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|$.\n\nThe state at time $t$ is then:\n$$\n|\\psi(t)\\rangle = \\left(\\sum_j e^{-iE_j t} |\\phi_j\\rangle\\langle\\phi_j|\\right) |\\psi(0)\\rangle = \\sum_j c_j e^{-iE_j t} |\\phi_j\\rangle\n$$\nwhere $c_j = \\langle\\phi_j|\\psi(0)\\rangle$ are the coefficients of the initial state projected onto the eigenbasis.\n\nThe initial state is a Gaussian wave packet:\n$$\n\\psi_n(0) = \\langle n | \\psi(0) \\rangle = \\mathcal{N} \\exp\\left( -\\frac{(n-n_0)^2}{2\\sigma^2} \\right) e^{ik_0n}\n$$\nThe normalization constant $\\mathcal{N}$ is chosen such that $\\sum_{n=0}^{N-1} |\\psi_n(0)|^2 = 1$, which gives $\\mathcal{N} = 1 / \\sqrt{\\sum_{n=0}^{N-1} \\exp\\left(-\\frac{(n-n_0)^2}{\\sigma^2}\\right)}$.\n\nThe quantum expectation value of the position at time $t$ is calculated by:\n$$\nx_{\\mathrm{qm}}(t) = \\langle\\psi(t)|\\hat{x}|\\psi(t)\\rangle = \\sum_{n=0}^{N-1} n |\\psi_n(t)|^2\n$$\n\n### Semiclassical Dynamics\n\nThe semiclassical model treats the wave packet as a point-like particle whose dynamics are governed by the band structure $\\varepsilon(k)$ and the acceleration theorem.\nThe provided principles are:\n1.  Energy dispersion: $\\varepsilon(k) = -2J \\cos(k)$.\n2.  Group velocity: $v(k) = \\frac{d\\varepsilon}{dk} = 2J \\sin(k)$.\n3.  Acceleration: $\\frac{dk}{dt} = -F$.\n\nIntegrating the acceleration equation with the initial condition $k(0) = k_0$ gives the time-dependent quasimomentum:\n$$\nk(t) = k_0 - Ft\n$$\nThe semiclassical position $x_{\\mathrm{sc}}(t)$ is found by integrating the group velocity, $\\frac{dx_{\\mathrm{sc}}}{dt} = v(k(t))$:\n$$\n\\frac{dx_{\\mathrm{sc}}}{dt} = 2J \\sin(k_0 - Ft)\n$$\nIntegrating this from $t=0$ to $t$ yields the change in position:\n$$\nx_{\\mathrm{sc}}(t) - x_{\\mathrm{sc}}(0) = \\int_0^t 2J \\sin(k_0 - Ft') dt' = 2J \\left[ \\frac{\\cos(k_0 - Ft')}{F} \\right]_0^t\n$$\n$$\nx_{\\mathrm{sc}}(t) = x_{\\mathrm{sc}}(0) + \\frac{2J}{F} \\left( \\cos(k_0 - Ft) - \\cos(k_0) \\right)\n$$\nThe initial semiclassical position $x_{\\mathrm{sc}}(0)$ is set equal to the initial quantum expectation value, $x_{\\mathrm{sc}}(0) = x_{\\mathrm{qm}}(0) = \\sum_{n=0}^{N-1} n |\\psi_n(0)|^2$.\n\n### Numerical Implementation and Comparison\n\nThe algorithm proceeds as follows for each test case:\n1.  **Set up**: Define all parameters ($N, J, F, k_0, \\sigma, n_0, T, M$) and construct the uniform time grid $t_m = m T/M$ for $m=1, \\dots, M$.\n2.  **Initial State**: Construct the discrete initial wave function $\\psi_n(0)$ and normalize it.\n3.  **Quantum Dynamics**:\n    a. Construct the $N \\times N$ Hamiltonian matrix $H$.\n    b. Numerically diagonalize $H$ using a standard eigensolver for Hermitian matrices (e.g., `numpy.linalg.eigh`) to obtain the eigenvalues $\\{E_j\\}$ and the unitary matrix of eigenvectors $U$ (whose columns are $|\\phi_j\\rangle$).\n    c. Project the initial state into the eigenbasis: $|\\psi(0)\\rangle_{\\mathrm{eig}} = U^\\dagger |\\psi(0)\\rangle$.\n    d. For each time $t_m$ in the grid, compute the evolved state by applying the phase factors $e^{-iE_j t_m}$ to the components of $|\\psi(0)\\rangle_{\\mathrm{eig}}$ and transforming back to the site basis: $|\\psi(t_m)\\rangle = U (e^{-iE t_m} |\\psi(0)\\rangle_{\\mathrm{eig}})$. This is implemented efficiently using vectorized operations for all times at once.\n    e. Compute the array of quantum positions $x_{\\mathrm{qm}}(t_m)$.\n4.  **Semiclassical Dynamics**:\n    a. Compute the initial position $x_{\\mathrm{qm}}(0)$ and set $x_{\\mathrm{sc}}(0)$ to this value.\n    b. Use the derived analytical formula to compute the array of semiclassical positions $x_{\\mathrm{sc}}(t_m)$.\n5.  **Deviation**: Calculate the root-mean-square deviation $\\Delta$ using the computed arrays $x_{\\mathrm{qm}}(t_m)$ and $x_{\\mathrm{sc}}(t_m)$ over the time grid.\n6.  **Output**: The final $\\Delta$ value is rounded to $6$ decimal places and stored. The results for all cases are then formatted into the required output string.\n\nThis procedure provides a rigorous and numerically exact (within machine precision) evaluation of the quantum dynamics on the finite chain, allowing for a precise comparison with the idealized semiclassical model.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the root-mean-square deviation between quantum and semiclassical\n    dynamics for four specified test cases.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # (N, J, F, k0, sigma, M)\n    # n0 and T are derived from these.\n    test_cases_params = [\n        (201, 1.0, 0.05, 0.7, 12.0, 256),\n        (201, 1.0, 0.05, 0.7, 3.0, 256),\n        (201, 1.0, 0.3, 0.7, 12.0, 256),\n        (121, 1.0, 0.02, 0.0, 12.0, 256),\n    ]\n\n    results = []\n\n    for N, J, F, k0, sigma, M in test_cases_params:\n        # Derived parameters\n        n0 = N // 2\n        T = 2 * np.pi / F\n        \n        # 1. Time grid\n        # The sum for Delta is from m=1 to M, so we start at t=T/M.\n        times = np.linspace(T / M, T, M)\n        \n        # 2. Site indices\n        sites = np.arange(N)\n        \n        # 3. Initial State Preparation\n        psi_unnormalized = np.exp(-(sites - n0)**2 / (2 * sigma**2)) * np.exp(1j * k0 * sites)\n        norm = np.linalg.norm(psi_unnormalized)\n        psi_0 = psi_unnormalized / norm\n\n        # 4. Quantum Dynamics Calculation\n        # a. Construct Hamiltonian\n        H_diag = F * sites\n        H_offdiag = -J * np.ones(N - 1)\n        H = np.diag(H_diag) + np.diag(H_offdiag, k=1) + np.diag(H_offdiag, k=-1)\n        \n        # b. Eigendecomposition of the Hermitian Hamiltonian\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # c. Project initial state onto the eigenbasis\n        # For a real symmetric matrix H, eigenvectors are real, so U.T.conj()=U.T\n        psi_0_eigenbasis = eigenvectors.T @ psi_0\n        \n        # d. Evolve state in time (vectorized for all time steps)\n        # Outer product creates an (N, M) matrix of phases e^{-i*E_j*t_m}\n        time_evolution_factors = np.exp(np.outer(-1j * eigenvalues, times))\n        # Multiply each eigen-coefficient with its time evolution factor\n        psi_t_eigenbasis = psi_0_eigenbasis[:, np.newaxis] * time_evolution_factors\n        # Transform back to the site basis\n        psi_t = eigenvectors @ psi_t_eigenbasis  # Shape (N, M)\n        \n        # e. Calculate quantum expectation value of position\n        x_qm = np.sum(sites[:, np.newaxis] * np.abs(psi_t)**2, axis=0) # Shape (M,)\n\n        # 5. Semiclassical Dynamics Calculation\n        # a. Initial position\n        x_qm_0 = np.sum(sites * np.abs(psi_0)**2)\n        x_sc_0 = x_qm_0\n\n        # b. Semiclassical trajectory for all time steps\n        x_sc = x_sc_0 + (2 * J / F) * (np.cos(k0 - F * times) - np.cos(k0))\n        \n        # 6. Comparison Metric\n        deviation = np.sqrt(np.mean((x_qm - x_sc)**2))\n        results.append(deviation)\n\n    # 7. Final output formatting\n    # Round to 6 decimal places and format to ensure trailing zeros.\n    formatted_results = [f'{round(r, 6):.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2972562"}]}