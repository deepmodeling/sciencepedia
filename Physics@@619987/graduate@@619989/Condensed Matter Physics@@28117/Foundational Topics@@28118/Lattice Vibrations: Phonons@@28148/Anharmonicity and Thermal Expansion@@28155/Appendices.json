{"hands_on_practices": [{"introduction": "The most fundamental origin of thermal expansion lies in the asymmetric shape of the interatomic potential. While the simple harmonic oscillator model is useful, its symmetric potential well leads to zero thermal expansion. This exercise delves into the core mechanism by exploring a more realistic model, the Morse potential, which captures the essential asymmetry of atomic bonds. By applying classical statistical mechanics and a perturbative approach, you will directly calculate the leading-order thermal expansion, explicitly linking the microscopic anharmonicity to the macroscopic phenomenon of a temperature-dependent average atomic separation [@problem_id:2969949].", "problem": "Consider a one-dimensional interatomic separation coordinate $r$ governed by the Morse potential $V(r)=D\\left(\\exp\\!\\left(-2a(r-r_0)\\right)-2\\exp\\!\\left(-a(r-r_0)\\right)\\right)$ with well depth $D0$, range parameter $a0$, and minimum located at $r=r_0$. In the classical canonical ensemble (Canonical Ensemble (CE)), the thermal average $\\langle r\\rangle_T$ at absolute temperature $T$ is defined via the Boltzmann weight $\\exp(-\\beta V(r))$, where the inverse temperature is $\\beta=1/(k_B T)$ and $k_B$ is the Boltzmann constant ($k_B$). Starting from the fundamental definition of the canonical average and using a systematic expansion of $V(r)$ about its minimum $r_0$, compute the leading thermal expansion in the classical limit by evaluating $\\langle r\\rangle_T$ to order $T$. Treat the anharmonicity perturbatively and assume the distribution is sufficiently localized near $r_0$ so that the expansion and Gaussian moment identities are valid. Express your final result as a closed-form analytic expression for $\\langle r\\rangle_T$ up to and including the term linear in $T$, in terms of $D$, $a$, $r_0$, and $k_B$. Do not include units inside the final boxed answer. No rounding is required since the answer is symbolic.", "solution": "The problem asks for the thermal average of the interatomic separation, $\\langle r \\rangle_T$, for a one-dimensional system governed by the Morse potential in the classical canonical ensemble. We are tasked to find the expression for $\\langle r \\rangle_T$ up to the term linear in temperature $T$. This corresponds to the leading order contribution to thermal expansion.\n\nThe Morse potential is given by\n$$V(r) = D\\left(\\exp(-2a(r-r_0)) - 2\\exp(-a(r-r_0))\\right)$$\nwhere $D  0$ is the well depth, $a  0$ is a range parameter, and $r_0$ is the equilibrium separation corresponding to the potential minimum.\n\nThe thermal average of the separation $r$ at a temperature $T$ is given by the canonical average:\n$$\\langle r \\rangle_T = \\frac{\\int_0^\\infty r \\exp(-\\beta V(r)) dr}{\\int_0^\\infty \\exp(-\\beta V(r)) dr}$$\nwhere $\\beta = 1/(k_B T)$ and $k_B$ is the Boltzmann constant.\n\nTo analyze the low-temperature behavior, we expand the potential $V(r)$ in a Taylor series around its minimum at $r=r_0$. Let $x = r-r_0$ be the displacement from equilibrium. The potential as a function of $x$ is $V(r_0+x)$. The Taylor series is:\n$$V(r_0+x) = V(r_0) + V'(r_0)x + \\frac{1}{2!}V''(r_0)x^2 + \\frac{1}{3!}V'''(r_0)x^3 + \\mathcal{O}(x^4)$$\nWe compute the necessary derivatives of $V(r)$ and evaluate them at $r=r_0$:\n- $V(r_0) = D(\\exp(0) - 2\\exp(0)) = -D$.\n- $V'(r) = D(-2a\\exp(-2a(r-r_0)) + 2a\\exp(-a(r-r_0)))$, so $V'(r_0) = D(-2a+2a)=0$, as expected for a minimum.\n- $V''(r) = D(4a^2\\exp(-2a(r-r_0)) - 2a^2\\exp(-a(r-r_0)))$, so $V''(r_0) = D(4a^2-2a^2)=2Da^2$.\n- $V'''(r) = D(-8a^3\\exp(-2a(r-r_0)) + 2a^3\\exp(-a(r-r_0)))$, so $V'''(r_0) = D(-8a^3+2a^3)=-6Da^3$.\n\nSubstituting these into the Taylor series, the potential up to the cubic term is:\n$$V(r_0+x) \\approx -D + \\frac{1}{2}(2Da^2)x^2 + \\frac{1}{6}(-6Da^3)x^3 = -D + Da^2x^2 - Da^3x^3$$\nWe can separate this into a harmonic part, $V_h(x)$, and an anharmonic perturbation, $V_a(x)$. Let $k = 2Da^2$ be the effective spring constant.\n$$V(r_0+x) = \\underbrace{-D + \\frac{1}{2}kx^2}_{V_h(x)} \\underbrace{- Da^3x^3}_{V_a(x)} + \\mathcal{O}(x^4)$$\nThe constant term $-D$ in the potential leads to a factor $\\exp(\\beta D)$ that cancels in the numerator and denominator of the average, so we can neglect it.\n\nThe average displacement from equilibrium is $\\langle x \\rangle_T = \\langle r-r_0 \\rangle_T = \\langle r \\rangle_T - r_0$. We want to compute $\\langle x \\rangle_T$.\n$$\\langle x \\rangle_T = \\frac{\\int_{-\\infty}^\\infty x \\exp(-\\beta (V_h(x) + V_a(x))) dx}{\\int_{-\\infty}^\\infty \\exp(-\\beta (V_h(x) + V_a(x))) dx}$$\nThe integration limits are extended from $(-r_0, \\infty)$ to $(-\\infty, \\infty)$ which is a valid approximation for low temperatures where the Boltzmann weight $\\exp(-\\beta V(x))$ is sharply peaked around $x=0$.\nFor low temperatures, $\\beta V_a(x)$ is small, so we can expand the exponential of the anharmonic term: $\\exp(-\\beta V_a(x)) \\approx 1 - \\beta V_a(x)$.\n$$\\langle x \\rangle_T \\approx \\frac{\\int x (1-\\beta V_a(x)) \\exp(-\\beta V_h(x)) dx}{\\int (1-\\beta V_a(x)) \\exp(-\\beta V_h(x)) dx}$$\nLet $\\langle A \\rangle_0$ denote the thermal average with respect to the harmonic potential $V_h(x)$:\n$$\\langle A \\rangle_0 = \\frac{\\int A(x) \\exp(-\\beta V_h(x)) dx}{\\int \\exp(-\\beta V_h(x)) dx}$$\nIn this notation, $\\langle x \\rangle_T$ becomes:\n$$\\langle x \\rangle_T \\approx \\frac{\\langle x(1-\\beta V_a(x)) \\rangle_0}{\\langle 1-\\beta V_a(x) \\rangle_0} = \\frac{\\langle x \\rangle_0 - \\beta \\langle xV_a(x) \\rangle_0}{1 - \\beta \\langle V_a(x) \\rangle_0}$$\nThe harmonic potential $V_h(x) = \\frac{1}{2}kx^2$ is an even function of $x$. The corresponding Boltzmann distribution is a Gaussian, which is also an even function. Therefore, the average of any odd function of $x$ over this distribution is zero.\n- $\\langle x \\rangle_0 = 0$.\n- $V_a(x) = -Da^3x^3$ is an odd function, so $\\langle V_a(x) \\rangle_0 = -Da^3 \\langle x^3 \\rangle_0 = 0$.\n- The product $xV_a(x) = -Da^3x^4$ is an even function, so its average is non-zero.\n\nWith these simplifications, the expression for $\\langle x \\rangle_T$ becomes:\n$$\\langle x \\rangle_T \\approx \\frac{0 - \\beta \\langle xV_a(x) \\rangle_0}{1 - 0} = -\\beta \\langle xV_a(x) \\rangle_0$$\nSubstituting $V_a(x)$:\n$$\\langle x \\rangle_T \\approx -\\beta \\langle x(-Da^3x^3) \\rangle_0 = \\beta Da^3 \\langle x^4 \\rangle_0$$\nWe now need to calculate the fourth moment $\\langle x^4 \\rangle_0$ for the harmonic oscillator. The harmonic distribution is a Gaussian with zero mean. The moments of this distribution are well-known. First, the second moment (variance) is found from the equipartition theorem, $\\frac{1}{2}k\\langle x^2 \\rangle_0 = \\frac{1}{2}k_BT$, which gives:\n$$\\langle x^2 \\rangle_0 = \\frac{k_BT}{k} = \\frac{k_BT}{2Da^2} = \\frac{1}{2\\beta Da^2}$$\nFor a zero-mean Gaussian distribution, the fourth moment is related to the second moment by $\\langle x^4 \\rangle_0 = 3(\\langle x^2 \\rangle_0)^2$.\n$$\\langle x^4 \\rangle_0 = 3 \\left( \\frac{1}{2\\beta Da^2} \\right)^2 = \\frac{3}{4\\beta^2 D^2 a^4}$$\nNow, we substitute this back into the expression for $\\langle x \\rangle_T$:\n$$\\langle x \\rangle_T \\approx \\beta Da^3 \\left( \\frac{3}{4\\beta^2 D^2 a^4} \\right) = \\frac{3Da^3}{4\\beta D^2 a^4} = \\frac{3}{4\\beta Da}$$\nFinally, we substitute $\\beta = 1/(k_B T)$:\n$$\\langle x \\rangle_T \\approx \\frac{3k_B T}{4Da}$$\nThis is the average displacement from equilibrium, which is linear in temperature. The average separation $\\langle r \\rangle_T$ is then:\n$$\\langle r \\rangle_T = r_0 + \\langle x \\rangle_T \\approx r_0 + \\frac{3k_B T}{4Da}$$\nThis expression includes the constant term $r_0$ and the term linear in $T$, as required. The positive sign of the correction term indicates that the average separation increases with temperature, which is the phenomenon of thermal expansion. This arises from the asymmetry of the interatomic potential, mathematically captured by the non-zero cubic anharmonic term.", "answer": "$$\\boxed{r_0 + \\frac{3k_B T}{4Da}}$$", "id": "2969949"}, {"introduction": "Building upon the single-oscillator picture, we now generalize to a full crystalline solid using the quasiharmonic approximation. This powerful framework connects the volume-dependence of individual phonon mode frequencies, quantified by the mode Grüneisen parameter $\\gamma_{\\mathbf{q}\\nu}$, to the macroscopic volumetric thermal expansion coefficient $\\alpha(T)$. This exercise first guides you through the derivation of this central relationship and then applies it to explain the counterintuitive phenomenon of negative thermal expansion (NTE), demonstrating how it can arise from the competition between different phonon populations [@problem_id:2969960].", "problem": "A crystalline solid is well described by the quasiharmonic approximation in which the phonon frequencies $\\omega_{\\mathbf{q}\\nu}$ depend on the crystal volume $V$. The total Helmholtz free energy can be written as $F(V,T) = U_{0}(V) + F_{\\text{ph}}(V,T)$, where $U_{0}(V)$ is the static lattice energy and the phonon part is\n$$\nF_{\\text{ph}}(V,T) = \\sum_{\\mathbf{q}\\nu} \\left[ \\tfrac{1}{2}\\hbar \\omega_{\\mathbf{q}\\nu}(V) + k_{B} T \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{\\hbar \\omega_{\\mathbf{q}\\nu}(V)}{k_{B} T}\\right)\\right)\\right].\n$$\nThe mode Grüneisen parameter is defined by $\\gamma_{\\mathbf{q}\\nu} \\equiv -\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial \\ln V}$, the isothermal bulk modulus by $B_{T} \\equiv -V\\left(\\frac{\\partial P}{\\partial V}\\right)_{T}$, and the volumetric thermal expansion coefficient by $\\alpha(T) \\equiv \\frac{1}{V}\\left(\\frac{\\partial V}{\\partial T}\\right)_{P}$.\n\nTasks:\n1) Starting only from the definitions above and fundamental thermodynamic relations, derive a general expression for $\\alpha(T)$ in terms of the phonon heat capacities $C_{\\mathbf{q}\\nu}(T)$, the mode Grüneisen parameters $\\gamma_{\\mathbf{q}\\nu}$, the isothermal bulk modulus $B_{T}$, and the volume $V$. From your expression, state a necessary and sufficient condition for negative thermal expansion at temperature $T$ in a multimode system.\n\n2) Consider a toy multimode crystal with two sets of dispersionless (Einstein) optical modes:\n- A low-frequency set with degeneracy $g_{-}$, energy $\\hbar\\omega_{-}$, and mode Grüneisen parameter $\\gamma_{-}0$.\n- A high-frequency set with degeneracy $g_{+}$, energy $\\hbar\\omega_{+}$, and mode Grüneisen parameter $\\gamma_{+}0$.\nAssume $B_{T}$ and $V$ are temperature independent in the range of interest, and that the phonon heat capacity of an Einstein mode of energy $\\hbar \\omega$ is\n$$\nC_{E}(\\omega,T) = k_{B}\\,\\frac{x^{2}\\exp(x)}{\\left[\\exp(x)-1\\right]^{2}},\\quad x \\equiv \\frac{\\hbar \\omega}{k_{B}T}.\n$$\n\nFor the numerical model with parameters $g_{-}=3$, $\\hbar\\omega_{-}=8\\,\\text{meV}$, $\\gamma_{-}=-2.5$, $g_{+}=9$, $\\hbar\\omega_{+}=20\\,\\text{meV}$, and $\\gamma_{+}=+1.0$, determine the temperature $T^{\\star}$ at which the sign of $\\alpha(T)$ changes. You may take the Boltzmann constant as $k_{B}=0.0861733\\,\\text{meV/K}$. Report the numerical value of $T^{\\star}$ rounded to $3$ significant figures. Express your final answer in kelvin.", "solution": "This problem consists of two parts. The first part requires the derivation of a general expression for the volumetric thermal expansion coefficient $\\alpha(T)$ within the quasiharmonic approximation and the condition for negative thermal expansion (NTE). The second part applies this result to a specific toy model to calculate the temperature $T^{\\star}$ at which the thermal expansion changes sign.\n\n### Part 1: Derivation of $\\alpha(T)$ and Condition for NTE\n\nThe volumetric thermal expansion coefficient $\\alpha(T)$ is defined as\n$$\n\\alpha(T) \\equiv \\frac{1}{V}\\left(\\frac{\\partial V}{\\partial T}\\right)_{P}\n$$\nwhere $V$ is the volume, $T$ is the temperature, and $P$ is the pressure. The derivative is taken at constant pressure. To facilitate the calculation, we use the triple product rule for partial derivatives, which states\n$$\n\\left(\\frac{\\partial V}{\\partial T}\\right)_{P} \\left(\\frac{\\partial T}{\\partial P}\\right)_{V} \\left(\\frac{\\partial P}{\\partial V}\\right)_{T} = -1\n$$\nRearranging this identity gives\n$$\n\\left(\\frac{\\partial V}{\\partial T}\\right)_{P} = -\\left(\\frac{\\partial V}{\\partial P}\\right)_{T} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\nSubstituting this into the definition of $\\alpha(T)$:\n$$\n\\alpha(T) = -\\frac{1}{V} \\left(\\frac{\\partial V}{\\partial P}\\right)_{T} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\nThe isothermal bulk modulus $B_T$ is defined as $B_{T} \\equiv -V\\left(\\frac{\\partial P}{\\partial V}\\right)_{T}$. Therefore, $-\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T} = \\frac{1}{B_T}$. This simplifies the expression for $\\alpha(T)$ to\n$$\n\\alpha(T) = \\frac{1}{B_{T}} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\nThis is a standard thermodynamic relation. Now we must evaluate the term $\\left(\\frac{\\partial P}{\\partial T}\\right)_{V}$. Pressure $P$ is related to the Helmholtz free energy $F(V,T)$ by the fundamental relation $P = -\\left(\\frac{\\partial F}{\\partial V}\\right)_{T}$. The given total Helmholtz free energy is $F(V,T) = U_{0}(V) + F_{\\text{ph}}(V,T)$.\nThe pressure is then\n$$\nP(V,T) = -\\left(\\frac{\\partial U_{0}}{\\partial V}\\right)_{T} - \\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{T}\n$$\nWe need to compute the change in pressure with temperature at constant volume:\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = -\\frac{\\partial}{\\partial T}\\left(\\frac{\\partial U_{0}}{\\partial V}\\right)_{V} - \\frac{\\partial}{\\partial T}\\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{V} = -\\frac{\\partial^2 F_{\\text{ph}}}{\\partial T \\partial V}\n$$\nThe term involving $U_0(V)$ vanishes because $U_0$ is a function of $V$ only. Since $F_{\\text{ph}}$ is a well-behaved function, we can switch the order of differentiation: $\\frac{\\partial^2 F_{\\text{ph}}}{\\partial T \\partial V} = \\frac{\\partial^2 F_{\\text{ph}}}{\\partial V \\partial T}$.\n\nThe phonon contribution to the free energy is a sum over all phonon modes $(\\mathbf{q}\\nu)$:\n$$\nF_{\\text{ph}}(V,T) = \\sum_{\\mathbf{q}\\nu} F_{\\mathbf{q}\\nu}(V,T) = \\sum_{\\mathbf{q}\\nu} \\left[ \\tfrac{1}{2}\\hbar \\omega_{\\mathbf{q}\\nu}(V) + k_{B} T \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{\\hbar \\omega_{\\mathbf{q}\\nu}(V)}{k_{B} T}\\right)\\right)\\right]\n$$\nLet's first compute the derivative of a single mode's free energy $F_{\\mathbf{q}\\nu}$ with respect to volume $V$. The frequency $\\omega_{\\mathbf{q}\\nu}$ is a function of $V$.\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial \\omega_{\\mathbf{q}\\nu}} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar + k_B T \\frac{-\\exp(-\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) \\cdot (-\\hbar/k_B T)}{1-\\exp(-\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T)} \\right]\n$$\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar + \\frac{\\hbar}{ \\exp(\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) - 1 } \\right] = \\frac{1}{\\omega_{\\mathbf{q}\\nu}} \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar\\omega_{\\mathbf{q}\\nu} + \\frac{\\hbar\\omega_{\\mathbf{q}\\nu}}{ \\exp(\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) - 1 } \\right]\n$$\nThe term in the bracket is the mean energy of a quantum harmonic oscillator, $U_{\\mathbf{q}\\nu}(T)$. So, $\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = U_{\\mathbf{q}\\nu}(T) \\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial V}$.\nUsing the definition of the mode Grüneisen parameter, $\\gamma_{\\mathbf{q}\\nu} \\equiv -\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial \\ln V} = -\\frac{V}{\\omega_{\\mathbf{q}\\nu}}\\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V}$, we can write $\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial V} = -\\frac{\\gamma_{\\mathbf{q}\\nu}}{V}$.\nThus,\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = - U_{\\mathbf{q}\\nu}(T) \\frac{\\gamma_{\\mathbf{q}\\nu}}{V}\n$$\nSumming over all modes gives the phonon pressure contribution:\n$$\nP_{\\text{ph}}(V,T) = -\\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{T} = \\sum_{\\mathbf{q}\\nu} \\frac{\\gamma_{\\mathbf{q}\\nu} U_{\\mathbf{q}\\nu}(T)}{V}\n$$\nNow, we can compute $\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\left(\\frac{\\partial P_{\\text{ph}}}{\\partial T}\\right)_{V}$:\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\frac{\\partial}{\\partial T} \\left( \\sum_{\\mathbf{q}\\nu} \\frac{\\gamma_{\\mathbf{q}\\nu} U_{\\mathbf{q}\\nu}(T)}{V} \\right)_{V} = \\frac{1}{V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} \\left(\\frac{\\partial U_{\\mathbf{q}\\nu}}{\\partial T}\\right)_{V}\n$$\nThe quantity $\\left(\\frac{\\partial U_{\\mathbf{q}\\nu}}{\\partial T}\\right)_{V}$ is the heat capacity of the mode $(\\mathbf{q}\\nu)$, denoted by $C_{\\mathbf{q}\\nu}(T)$.\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\frac{1}{V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)\n$$\nSubstituting this back into the expression for $\\alpha(T)$, we obtain the final result:\n$$\n\\alpha(T) = \\frac{1}{B_{T} V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)\n$$\nThis is the general expression for $\\alpha(T)$ in terms of the specified quantities.\n\nFor negative thermal expansion, we must have $\\alpha(T)  0$. The isothermal bulk modulus $B_T$ must be positive for a thermodynamically stable solid ($B_T  0$), and the volume $V$ is also positive. The heat capacity of any mode, $C_{\\mathbf{q}\\nu}(T)$, is a non-negative quantity ($C_{\\mathbf{q}\\nu}(T) \\ge 0$). Therefore, the sign of $\\alpha(T)$ is determined solely by the sign of the sum $\\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)$.\nA necessary and sufficient condition for negative thermal expansion at a temperature $T$ is:\n$$\n\\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)  0\n$$\n\n### Part 2: Calculation of the Sign-Change Temperature $T^{\\star}$\n\nFor the given toy model, the sum over modes consists of two parts: a low-frequency set with degeneracy $g_{-}$, frequency $\\omega_{-}$, and Grüneisen parameter $\\gamma_{-}$, and a high-frequency set with degeneracy $g_{+}$, frequency $\\omega_{+}$, and Grüneisen parameter $\\gamma_{+}$. The sum becomes:\n$$\n\\sum_{\\text{modes}} \\gamma_{\\text{mode}} C_{\\text{mode}}(T) = g_{-} \\gamma_{-} C_{E}(\\omega_{-}, T) + g_{+} \\gamma_{+} C_{E}(\\omega_{+}, T)\n$$\nwhere $C_{E}(\\omega, T)$ is the heat capacity of a single Einstein mode.\nThe thermal expansion coefficient $\\alpha(T)$ changes sign when $\\alpha(T) = 0$. Since the prefactor $\\frac{1}{B_T V}$ is positive, this occurs when the sum is zero:\n$$\ng_{-} \\gamma_{-} C_{E}(\\omega_{-}, T^{\\star}) + g_{+} \\gamma_{+} C_{E}(\\omega_{+}, T^{\\star}) = 0\n$$\nThe problem provides the expression for the Einstein heat capacity: $C_{E}(\\omega,T) = k_{B}\\,\\frac{x^{2}\\exp(x)}{\\left[\\exp(x)-1\\right]^{2}}$ with $x \\equiv \\frac{\\hbar \\omega}{k_{B}T}$.\nSubstituting this into our equation:\n$$\ng_{-} \\gamma_{-} k_{B} \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2} + g_{+} \\gamma_{+} k_{B} \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 0\n$$\nwhere $x_{-} \\equiv \\frac{\\hbar\\omega_{-}}{k_B T^{\\star}}$ and $x_{+} \\equiv \\frac{\\hbar\\omega_{+}}{k_B T^{\\star}}$. The Boltzmann constant $k_B$ cancels out.\nPlugging in the numerical values $g_{-}=3$, $\\gamma_{-}=-2.5$, $g_{+}=9$, $\\gamma_{+}=+1.0$:\n$$\n(3)(-2.5) \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2} + (9)(1.0) \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 0\n$$\n$$\n9 \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 7.5 \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\nThe variables $x_{-}$ and $x_{+}$ are related: $x_{+} = \\frac{\\hbar\\omega_{+}}{k_B T^{\\star}} = \\frac{\\hbar\\omega_{-}}{k_B T^{\\star}} \\frac{\\hbar\\omega_{+}}{\\hbar\\omega_{-}} = x_{-} \\frac{20\\,\\text{meV}}{8\\,\\text{meV}} = 2.5 x_{-}$.\nSubstituting $x_{+} = 2.5x_{-}$, the equation becomes:\n$$\n9 \\frac{(2.5x_{-})^2 \\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\nFor $T^{\\star}  0$, we have $x_{-} \\ne 0$, so we can cancel $x_{-}^2$ from both sides:\n$$\n9 \\cdot (2.5)^2 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n$$\n56.25 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\nDividing by $7.5$ gives:\n$$\n7.5 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\nThis is a transcendental equation for $x_{-}$. We solve it numerically. Let's define a function $f(y) = 7.5 \\exp(2.5y)(\\exp(y)-1)^2 - \\exp(y)(\\exp(2.5y)-1)^2$ and find its root $y=x_{-}$.\nBy testing values, we found that for $y=0.65$, $f(0.65)  0$, and for $y=0.66$, $f(0.66)  0$. Further refinement shows that the root is very close to $x_{-} \\approx 0.6529$.\nNow we can compute the temperature $T^{\\star}$:\n$$\nT^{\\star} = \\frac{\\hbar\\omega_{-}}{k_B x_{-}}\n$$\nUsing the given values $\\hbar\\omega_{-} = 8\\,\\text{meV}$ and $k_B=0.0861733\\,\\text{meV/K}$:\n$$\nT^{\\star} = \\frac{8\\,\\text{meV}}{(0.0861733\\,\\text{meV/K}) \\cdot (0.6529)} = \\frac{8}{0.056262}\\,\\text{K} \\approx 142.189\\,\\text{K}\n$$\nRounding the result to $3$ significant figures gives $142\\,\\text{K}$. At low temperatures, the negative $\\gamma_{-}$ of the softer modes dominates, leading to contraction upon heating ($\\alpha  0$). At higher temperatures, the positive $\\gamma_{+}$ of the more numerous higher-energy modes becomes significant, leading to expansion ($\\alpha  0$). $T^{\\star}$ is the crossover temperature.", "answer": "$$\\boxed{142}$$", "id": "2969960"}, {"introduction": "While the quasiharmonic approximation (QHA) is foundational, its validity is limited in systems with strong anharmonicity. This computational exercise challenges you to go beyond QHA and implement the more advanced Self-Consistent Phonon (SCP) method, which accounts for higher-order (quartic) anharmonicity through a variational, self-consistent framework. By comparing the predictions of QHA and SCP against hypothetical experimental data for a perovskite, you will gain hands-on experience with the numerical techniques used in modern materials modeling and appreciate why sophisticated theories are essential for quantitatively describing the thermal properties of strongly anharmonic materials [@problem_id:2970007].", "problem": "You are to implement a program that computes the volumetric thermal expansion coefficient as a function of temperature, denoted by $\\alpha(T)$, for a simplified model of a perovskite with strong anharmonicity. You must compare predictions from the Quasi-Harmonic Approximation (QHA) and the Self-Consistent Phonon (SCP) method and quantitatively assess the impact of quartic anharmonicity on reproducing experimental expansion trends.\n\nFoundational definitions and modeling assumptions to be used:\n- The Helmholtz free energy $F(T,V)$ at temperature $T$ and volume $V$ is composed of a lattice elastic contribution and a vibrational contribution. The Gibbs free energy at fixed external pressure $P_{\\mathrm{ext}}$ is $G(T,V) = E_{\\mathrm{el}}(V) + F_{\\mathrm{vib}}(T,V) + P_{\\mathrm{ext}} V$, and thermal equilibrium at given $T$ satisfies minimization of $G(T,V)$ with respect to $V$ at fixed $P_{\\mathrm{ext}}$.\n- The volumetric thermal expansion coefficient is defined by $\\alpha(T) = \\frac{1}{V(T)} \\left( \\frac{\\partial V(T)}{\\partial T} \\right)_{P_{\\mathrm{ext}}}$, which you must compute numerically using a central finite-difference approximation.\n- The elastic contribution is modeled as a quadratic expansion around a reference volume $V_0$ with bulk modulus $B$: $E_{\\mathrm{el}}(V) = \\frac{B}{2 V_0} \\left(V - V_0\\right)^2$.\n- The vibrational spectrum is represented by $s$ identical optical modes that couple to volume through a Grüneisen-type relation $\\omega(V) = \\omega_0 \\left( \\frac{V}{V_0} \\right)^{-\\gamma}$, where $\\omega_0$ is a reference angular frequency and $\\gamma$ is the Grüneisen parameter.\n- The harmonic oscillator Helmholtz free energy per mode is $F_{\\mathrm{harm}}(T,\\omega) = k_B T \\ln\\left(1 - e^{-\\hbar \\omega / k_B T}\\right) + \\frac{1}{2} \\hbar \\omega$, so that the total QHA vibrational free energy is $F_{\\mathrm{QHA}}(T,V) = s \\, F_{\\mathrm{harm}}(T, \\omega(V))$. Here $k_B$ is the Boltzmann constant and $\\hbar$ is the reduced Planck constant.\n- In the Self-Consistent Phonon (SCP) treatment of quartic anharmonicity, each mode is governed by a single-coordinate potential $U(x;V) = \\frac{1}{2} M \\, \\omega(V)^2 \\, x^2 + \\frac{1}{4} \\beta \\, x^4$, where $M$ is an effective mass and $\\beta$ is the quartic coefficient. The renormalized angular frequency $\\Omega$ is determined implicitly by the self-consistency condition\n$$\nM \\, \\Omega^2 = M \\, \\omega(V)^2 + 3 \\, \\beta \\, \\langle x^2 \\rangle_{\\Omega},\n$$\nwith the harmonic coordinate variance\n$$\n\\langle x^2 \\rangle_{\\Omega} = \\frac{\\hbar}{2 M \\Omega} \\, \\coth\\left( \\frac{\\hbar \\Omega}{2 k_B T} \\right).\n$$\nUse $\\langle x^4 \\rangle_{\\Omega} = 3 \\, \\langle x^2 \\rangle_{\\Omega}^2$. The SCP variational free energy per mode at the self-consistent $\\Omega$ is\n$$\nF_{\\mathrm{SCP,mode}}(T,V) = F_{\\mathrm{harm}}(T,\\Omega) + \\frac{1}{2} M \\left( \\omega(V)^2 - \\Omega^2 \\right) \\langle x^2 \\rangle_{\\Omega} + \\frac{1}{4} \\beta \\, \\langle x^4 \\rangle_{\\Omega},\n$$\nand $F_{\\mathrm{SCP}}(T,V) = s \\, F_{\\mathrm{SCP,mode}}(T,V)$.\n\nComputational tasks:\n1. For each specified parameter set and temperature $T$, compute the equilibrium volume $V(T)$ by minimizing $G(T,V)$ with respect to $V$ at fixed external pressure $P_{\\mathrm{ext}}$ for:\n   - QHA using $F_{\\mathrm{QHA}}(T,V)$.\n   - SCP using $F_{\\mathrm{SCP}}(T,V)$, where the renormalized $\\Omega$ must be obtained self-consistently from the implicit equation above. If $\\beta = 0$, then $\\Omega = \\omega(V)$ exactly.\n2. Compute $\\alpha(T)$ at each target $T$ using the central finite difference approximation:\n$$\n\\alpha(T) \\approx \\frac{1}{V(T)} \\cdot \\frac{V(T + \\Delta T) - V(T - \\Delta T)}{2 \\, \\Delta T},\n$$\nwith $\\Delta T = 1 \\, \\mathrm{K}$.\n3. For each test case, also compute the relative deviation from the provided experimental reference $\\alpha_{\\mathrm{exp}}(T)$ as a decimal fraction:\n$$\n\\delta(T) = \\frac{\\alpha(T) - \\alpha_{\\mathrm{exp}}(T)}{\\alpha_{\\mathrm{exp}}(T)}.\n$$\n\nUnits and numerical reporting:\n- All physical quantities must be treated in International System of Units (SI). The thermal expansion coefficient must be reported in $\\mathrm{K}^{-1}$.\n- Report all numerical outputs rounded to seven decimal places.\n\nTest suite:\nImplement the computations for the following three parameter sets that probe distinct regimes:\n\n- Test Case 1 (Strongly anharmonic perovskite):\n  - $V_0 = 64 \\times 10^{-30} \\, \\mathrm{m}^3$, $B = 1.10 \\times 10^{11} \\, \\mathrm{Pa}$, $M = 3.0 \\times 10^{-26} \\, \\mathrm{kg}$, $\\omega_0 = 2.0 \\times 10^{13} \\, \\mathrm{rad/s}$, $\\gamma = 2.0$, $\\beta = 6.0 \\times 10^{20} \\, \\mathrm{J/m}^4$, $s = 3$, $P_{\\mathrm{ext}} = 0 \\, \\mathrm{Pa}$, target temperatures $T \\in \\{300 \\, \\mathrm{K}, 900 \\, \\mathrm{K}\\}$, experimental references $\\alpha_{\\mathrm{exp}}(300 \\, \\mathrm{K}) = 1.40 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ and $\\alpha_{\\mathrm{exp}}(900 \\, \\mathrm{K}) = 1.20 \\times 10^{-5} \\, \\mathrm{K}^{-1}$.\n- Test Case 2 (Moderately anharmonic):\n  - Same as Test Case 1, except $\\beta = 1.5 \\times 10^{20} \\, \\mathrm{J/m}^4$, and experimental references $\\alpha_{\\mathrm{exp}}(300 \\, \\mathrm{K}) = 1.30 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ and $\\alpha_{\\mathrm{exp}}(900 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$.\n- Test Case 3 (Harmonic limit boundary):\n  - Same as Test Case 1, except $\\beta = 0$, and experimental references $\\alpha_{\\mathrm{exp}}(300 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ and $\\alpha_{\\mathrm{exp}}(900 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The entry for each test case must be a list containing eight numbers:\n  - $[\\alpha_{\\mathrm{QHA}}(300 \\, \\mathrm{K}), \\alpha_{\\mathrm{QHA}}(900 \\, \\mathrm{K}), \\alpha_{\\mathrm{SCP}}(300 \\, \\mathrm{K}), \\alpha_{\\mathrm{SCP}}(900 \\, \\mathrm{K}), \\delta_{\\mathrm{QHA}}(300 \\, \\mathrm{K}), \\delta_{\\mathrm{QHA}}(900 \\, \\mathrm{K}), \\delta_{\\mathrm{SCP}}(300 \\, \\mathrm{K}), \\delta_{\\mathrm{SCP}}(900 \\, \\mathrm{K})]$,\n  rounded to seven decimal places, all values in $\\mathrm{K}^{-1}$ for $\\alpha$ and unitless decimals for $\\delta$.\n- For the three test cases, the final output must therefore look like a single list of three lists, for example: $[[a_1,a_2,a_3,a_4,a_5,a_6,a_7,a_8],[b_1,\\dots,b_8],[c_1,\\dots,c_8]]$ with numerical values replacing each symbol.", "solution": "The user's request to compute the volumetric thermal expansion coefficient, $\\alpha(T)$, for a model perovskite under two different theoretical approximations (Quasi-Harmonic Approximation and Self-Consistent Phonon method) has been validated as a scientifically sound, well-posed, and complete problem in condensed matter physics. We will proceed with a detailed solution.\n\nThe core of the problem is to determine the equilibrium volume of the crystal, $V(T)$, at a given temperature $T$ and external pressure $P_{\\mathrm{ext}}$. Thermodynamically, this corresponds to the volume that minimizes the Gibbs free energy $G(T,V)$. Once $V(T)$ is determined, the thermal expansion coefficient $\\alpha(T)$ can be computed.\n\n### 1. Thermodynamic Framework\n\nThe Gibbs free energy is given by:\n$$\nG(T,V) = E_{\\mathrm{el}}(V) + F_{\\mathrm{vib}}(T,V) + P_{\\mathrm{ext}} V\n$$\nwhere $E_{\\mathrm{el}}(V)$ is the static elastic energy of the lattice and $F_{\\mathrm{vib}}(T,V)$ is the vibrational Helmholtz free energy. The equilibrium volume $V(T)$ is found by solving the minimization problem:\n$$\n\\left( \\frac{\\partial G(T,V)}{\\partial V} \\right)_T = 0\n$$\nThe problem specifies the following models for the energy contributions:\n\n-   **Elastic Energy**: A simple quadratic model describing the energy cost of compressing or expanding the lattice from its reference volume $V_0$.\n    $$\n    E_{\\mathrm{el}}(V) = \\frac{B}{2 V_0} (V - V_0)^2\n    $$\n    Here, $B$ is the bulk modulus.\n\n-   **Vibrational Free Energy**: This term depends on the chosen approximation for handling atomic vibrations (phonons). The crystal's vibrational behavior is simplified to $s$ identical optical phonon modes whose frequency $\\omega$ changes with volume according to the Grüneisen relation:\n    $$\n    \\omega(V) = \\omega_0 \\left( \\frac{V}{V_0} \\right)^{-\\gamma}\n    $$\n    where $\\gamma$ is the Grüneisen parameter.\n\n### 2. Quasi-Harmonic Approximation (QHA)\n\nThe QHA is the simpler model. It treats phonons as perfect harmonic oscillators but allows their frequency to depend on the crystal volume. The total vibrational free energy is the sum of the contributions from each mode:\n$$\nF_{\\mathrm{QHA}}(T,V) = s \\cdot F_{\\mathrm{harm}}(T, \\omega(V))\n$$\nwhere $F_{\\mathrm{harm}}$ is the standard statistical mechanical result for a quantum harmonic oscillator:\n$$\nF_{\\mathrm{harm}}(T,\\omega) = k_B T \\ln\\left(1 - e^{-\\hbar \\omega / k_B T}\\right) + \\frac{1}{2} \\hbar \\omega\n$$\nThe term $\\frac{1}{2} \\hbar \\omega$ is the zero-point energy.\n\n### 3. Self-Consistent Phonon (SCP) Method\n\nThe SCP method provides a more sophisticated treatment of anharmonicity, essential for materials where the harmonic approximation fails. The potential for each mode includes a quartic term: $U(x) = \\frac{1}{2} M \\omega(V)^2 x^2 + \\frac{1}{4} \\beta x^4$. This term introduces interactions between phonons. The SCP method approximates this interacting system with an effective non-interacting system of phonons with a *renormalized* frequency $\\Omega$, which must be determined self-consistently.\n\nThe self-consistency condition relates the renormalized frequency $\\Omega$ to the mean-square displacement $\\langle x^2 \\rangle_{\\Omega}$ of the effective harmonic oscillator:\n$$\nM \\Omega^2 = M \\omega(V)^2 + 3 \\beta \\langle x^2 \\rangle_{\\Omega}\n$$\nThe mean-square displacement itself depends on $\\Omega$:\n$$\n\\langle x^2 \\rangle_{\\Omega} = \\frac{\\hbar}{2 M \\Omega} \\coth\\left( \\frac{\\hbar \\Omega}{2 k_B T} \\right)\n$$\nFor a given volume $V$ and temperature $T$, this forms an implicit equation for $\\Omega$ that must be solved numerically, for instance, using a root-finding algorithm like the Brent-Dekker method.\n\nOnce the self-consistent $\\Omega$ is found, the SCP vibrational free energy is calculated. Using the self-consistency condition, the given expression for $F_{\\mathrm{SCP,mode}}$ can be simplified to:\n$$\nF_{\\mathrm{SCP,mode}}(T,V) = F_{\\mathrm{harm}}(T,\\Omega) - \\frac{3}{4}\\beta (\\langle x^2 \\rangle_{\\Omega})^2\n$$\nThe total SCP vibrational free energy is then $F_{\\mathrm{SCP}}(T,V) = s \\cdot F_{\\mathrm{SCP,mode}}(T,V)$. A crucial check is that if the anharmonicity coefficient $\\beta = 0$, the self-consistency equation yields $\\Omega = \\omega(V)$, and the SCP free energy correctly reduces to the QHA free energy.\n\n### 4. Computational Algorithm\n\nThe overall computational procedure is as follows:\n\n1.  **For each Test Case and Model (QHA/SCP):**\n    a. We define a function for the Gibbs free energy, $G(V)$, at a fixed temperature $T$. This function encapsulates the calculation of $E_{\\mathrm{el}}(V)$ and the appropriate $F_{\\mathrm{vib}}(T,V)$.\n    b. For the SCP model, the evaluation of $F_{\\mathrm{vib}}(T,V)$ requires an inner step: solving the self-consistency equation for $\\Omega$ at each $(T,V)$ pair using a numerical root-finder (`scipy.optimize.brentq`).\n    c. We find the equilibrium volume $V(T)$ by numerically minimizing $G(V)$ with respect to $V$ using an optimization routine (`scipy.optimize.minimize_scalar`).\n\n2.  **Calculate Thermal Expansion Coefficient $\\alpha(T)$:**\n    The problem specifies a central finite-difference approximation for the derivative $\\left( \\frac{\\partial V}{\\partial T} \\right)_P$. This requires calculating the equilibrium volume at three temperatures: $T - \\Delta T$, $T$, and $T + \\Delta T$, where $\\Delta T = 1 \\, \\mathrm{K}$.\n    $$\n    \\alpha(T) \\approx \\frac{1}{V(T)} \\frac{V(T + \\Delta T) - V(T - \\Delta T)}{2 \\Delta T}\n    $$\n\n3.  **Calculate Relative Deviation $\\delta(T)$:**\n    The calculated $\\alpha(T)$ is compared to the provided experimental reference value $\\alpha_{\\mathrm{exp}}(T)$ to quantify the model's accuracy:\n    $$\n    \\delta(T) = \\frac{\\alpha(T) - \\alpha_{\\mathrm{exp}}(T)}{\\alpha_{\\mathrm{exp}}(T)}\n    $$\n\n4.  **Final Output:**\n    The results for each test case—eight floating-point numbers comprising the calculated $\\alpha$ and $\\delta$ values for both models at two temperatures—are collected, rounded, and formatted into the specified list-of-lists structure. The implementation uses SI units throughout.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar, brentq\n\ndef solve():\n    \"\"\"\n    Computes volumetric thermal expansion coefficient for QHA and SCP models\n    and compares them to experimental data.\n    \"\"\"\n    \n    # Fundamental constants in SI units\n    HBAR = 1.054571817e-34  # J.s\n    KB = 1.380649e-23      # J/K\n    \n    # Finite difference step for temperature\n    DT = 1.0\n\n    # Test cases as defined in the problem statement\n    test_cases = [\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 6.0e20, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.40e-5, 1.20e-5]\n        },\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 1.5e20, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.30e-5, 1.25e-5]\n        },\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 0.0, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.25e-5, 1.25e-5]\n        }\n    ]\n\n    all_results = []\n    \n    # Memoization caches to speed up repeated calculations during minimization\n    memo_F_vib = {}\n    memo_omega_scp = {}\n\n    def get_omega_V(V, p):\n        return p['omega0'] * (V / p['V0'])**(-p['gamma'])\n\n    def get_E_el(V, p):\n        return p['B'] / (2 * p['V0']) * (V - p['V0'])**2\n\n    def get_F_harm_mode(T, omega):\n        if T = 1e-9 or omega = 1e-9:\n             return 0.5 * HBAR * omega\n        \n        arg = HBAR * omega / (KB * T)\n        # Avoid overflow/underflow issues in np.exp\n        if arg  700:\n            return 0.5 * HBAR * omega\n        \n        return KB * T * np.log(1 - np.exp(-arg)) + 0.5 * HBAR * omega\n\n    def get_F_qha(T, V, p):\n        key = ('QHA', T, V)\n        if key in memo_F_vib: return memo_F_vib[key]\n        \n        omega = get_omega_V(V, p)\n        result = p['s'] * get_F_harm_mode(T, omega)\n        memo_F_vib[key] = result\n        return result\n\n    def solve_omega_scp_for_V_T(V, T, p):\n        key = (T, V)\n        if key in memo_omega_scp: return memo_omega_scp[key]\n        \n        if p['beta'] == 0:\n            omega_scp = get_omega_V(V, p)\n            memo_omega_scp[key] = omega_scp\n            return omega_scp\n            \n        omega_bare_sq = get_omega_V(V, p)**2\n        \n        def scp_equation(Omega):\n            if Omega = 1e-12: return -np.inf\n            \n            arg_coth = HBAR * Omega / (2 * KB * T)\n            coth_val = 1.0 / np.tanh(arg_coth) if arg_coth  300 else 1.0\n                \n            x2_mean = (HBAR / (2 * p['M'] * Omega)) * coth_val\n            return Omega**2 - omega_bare_sq - (3 * p['beta'] / p['M']) * x2_mean\n        \n        omega_bare = np.sqrt(omega_bare_sq)\n        lower_bound = omega_bare * 1e-6\n        upper_bound = omega_bare * 20\n        \n        # Protect against brentq failure due to boundary signs\n        try:\n            val_lower = scp_equation(lower_bound)\n            val_upper = scp_equation(upper_bound)\n            if np.sign(val_lower) == np.sign(val_upper):\n                upper_bound *= 5\n        except (OverflowError, ValueError):\n            pass\n            \n        omega_scp = brentq(scp_equation, lower_bound, upper_bound, xtol=1e-15, rtol=1e-15)\n        memo_omega_scp[key] = omega_scp\n        return omega_scp\n\n    def get_F_scp(T, V, p):\n        key = ('SCP', T, V)\n        if key in memo_F_vib: return memo_F_vib[key]\n\n        if p['beta'] == 0:\n             return get_F_qha(T, V, p)\n        \n        Omega_scp = solve_omega_scp_for_V_T(V, T, p)\n        \n        arg_coth = HBAR * Omega_scp / (2 * KB * T)\n        coth_val = 1.0 / np.tanh(arg_coth) if arg_coth  300 else 1.0\n        \n        x2_mean = (HBAR / (2 * p['M'] * Omega_scp)) * coth_val\n        \n        F_harm_scp = p['s'] * get_F_harm_mode(T, Omega_scp)\n        correction = p['s'] * (-0.75 * p['beta'] * x2_mean**2)\n        \n        result = F_harm_scp + correction\n        memo_F_vib[key] = result\n        return result\n\n    def get_equilibrium_volume(T, p, model):\n        F_vib_func = get_F_qha if model == 'QHA' else get_F_scp\n\n        def gibbs_G(V):\n            Eel = get_E_el(V, p)\n            Fvib = F_vib_func(T, V, p)\n            return Eel + Fvib + p['P_ext'] * V\n            \n        bounds = (p['V0'] * 0.9, p['V0'] * 1.1)\n        res = minimize_scalar(gibbs_G, bounds=bounds, method='bounded', options={'xatol': 1e-25})\n        return res.x\n\n    for case in test_cases:\n        params = case[\"params\"]\n        \n        memo_F_vib.clear()\n        memo_omega_scp.clear()\n        \n        alphas = []\n        for model in ['QHA', 'SCP']:\n            for T_target in case[\"temps\"]:\n                V_T = get_equilibrium_volume(T_target, params, model)\n                V_plus = get_equilibrium_volume(T_target + DT, params, model)\n                V_minus = get_equilibrium_volume(T_target - DT, params, model)\n                \n                alpha = (1.0 / V_T) * (V_plus - V_minus) / (2.0 * DT)\n                alphas.append(alpha)\n        \n        alpha_qha = alphas[0:2]\n        alpha_scp = alphas[2:4]\n        \n        delta_qha = [(a - a_exp) / a_exp for a, a_exp in zip(alpha_qha, case[\"alpha_exp\"])]\n        delta_scp = [(a - a_exp) / a_exp for a, a_exp in zip(alpha_scp, case[\"alpha_exp\"])]\n        \n        case_result = [\n            round(alpha_qha[0], 7), round(alpha_qha[1], 7),\n            round(alpha_scp[0], 7), round(alpha_scp[1], 7),\n            round(delta_qha[0], 7), round(delta_qha[1], 7),\n            round(delta_scp[0], 7), round(delta_scp[1], 7)\n        ]\n        all_results.append(case_result)\n        \n    # Format the final output string as per requirements\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2970007"}]}