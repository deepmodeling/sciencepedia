{"hands_on_practices": [{"introduction": "Before we can analyze the thermodynamic and kinetic behavior of interstitials, we must first answer a fundamental geometric question: where can they physically reside within a crystal? This exercise takes you back to the crystallographic foundations of the face-centered cubic (fcc) lattice, a common structure for many metals and semiconductors. By applying geometric reasoning, you will identify and enumerate the high-symmetry tetrahedral and octahedral interstitial sites, a crucial first step in building any quantitative model of interstitial defects [@problem_id:2978756].", "problem": "An ideal monatomic crystal has a face-centered cubic (fcc) Bravais lattice with conventional cubic lattice parameter $a$. The conventional cubic cell has lattice points at fractional coordinates $\\left(0,0,0\\right)$, $\\left(0,\\tfrac{1}{2},\\tfrac{1}{2}\\right)$, $\\left(\\tfrac{1}{2},0,\\tfrac{1}{2}\\right)$, and $\\left(\\tfrac{1}{2},\\tfrac{1}{2},0\\right)$. Define an interstitial site as a point in space where a small test atom could be placed such that its nearest neighboring host atoms form, respectively, a regular tetrahedron (a tetrahedral interstitial) or a regular octahedron (an octahedral interstitial).\n\nStarting from the crystallographic definitions of the fcc Bravais lattice and the geometric characterization of regular tetrahedra and octahedra formed by nearest neighbors, do the following:\n\n1. Enumerate all symmetry-inequivalent tetrahedral and octahedral interstitial site positions within the conventional cubic cell by giving representative fractional coordinates and arguing why they exhaust all nearest-neighbor interstices of those types.\n\n2. By accounting for space group symmetry and the sharing of sites on cell boundaries between adjacent conventional cells, determine the total number of tetrahedral and octahedral interstitial sites that belong to a single conventional cubic cell.\n\n3. Using the relation between the conventional cubic cell and the primitive cell of an fcc lattice, compute the densities of tetrahedral and octahedral interstitial sites per primitive cell, defined as the number of such sites associated with a single primitive cell.\n\nExpress your final answer as a two-entry row vector $\\left(N_{\\mathrm{tet}},\\,N_{\\mathrm{oct}}\\right)$ giving the tetrahedral and octahedral site densities per primitive cell. No rounding is necessary. The answer is dimensionless and should be given as exact integers.", "solution": "The problem requires the identification and quantification of tetrahedral and octahedral interstitial sites in a face-centered cubic (fcc) crystal lattice. The solution will proceed by first identifying the coordinates of these sites based on the geometric definitions provided, then counting the number of sites per conventional cell, and finally calculating the density of sites per primitive cell.\n\n**1. Identification and Enumeration of Interstitial Sites**\n\nThe fcc lattice in a conventional cubic cell of side length $a$ has atoms at the 8 corners and the 6 face centers. The fractional coordinates of the atoms are $(0,0,0)$, $(\\frac{1}{2},\\frac{1}{2},0)$, $(\\frac{1}{2},0,\\frac{1}{2})$, $(0,\\frac{1}{2},\\frac{1}{2})$ and all positions generated by integer translations, which gives atoms at all corners (e.g., $(0,0,0)$, $(1,0,0)$) and face centers (e.g., $(\\frac{1}{2},\\frac{1}{2},0)$, $(1,\\frac{1}{2},\\frac{1}{2})$).\n\n**A. Octahedral Interstitial Sites**\n\nAn octahedral interstitial site is a point equidistant from 6 host atoms that form a regular octahedron.\n\nLet us first examine the point at the body center of the conventional cubic cell, with fractional coordinates $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$. The nearest host atoms to this point are the 6 atoms located at the centers of the faces of the cube. These face-centered atoms are at positions:\n$(\\frac{1}{2}, \\frac{1}{2}, 0)$, $(1, \\frac{1}{2}, \\frac{1}{2})$, $(0, \\frac{1}{2}, \\frac{1}{2})$, $(\\frac{1}{2}, 1, \\frac{1}{2})$, $(\\frac{1}{2}, 0, \\frac{1}{2})$, $(\\frac{1}{2}, \\frac{1}{2}, 1)$.\nThe distance from the body-center site $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})a$ to each of these 6 face-center atoms is $\\frac{a}{2}$. For example, the distance to $(\\frac{1}{2}, \\frac{1}{2}, 0)a$ is $\\sqrt{(0)^2 + (0)^2 + (\\frac{a}{2})^2} = \\frac{a}{2}$.\nThese 6 atoms form a regular octahedron centered at $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$. Thus, the body center is an octahedral interstitial site.\n\nNext, consider the midpoint of an edge of the conventional cell, for example, the point with fractional coordinates $(\\frac{1}{2}, 0, 0)$. Its nearest neighboring atoms are the two corner atoms at $(0,0,0)$ and $(1,0,0)$, and the four face-center atoms at $(\\frac{1}{2}, \\frac{1}{2}, 0)$, $(\\frac{1}{2}, -\\frac{1}{2}, 0)$, $(\\frac{1}{2}, 0, \\frac{1}{2})$, and $(\\frac{1}{2}, 0, -\\frac{1}{2})$. Note that two of these face-center atoms are in adjacent unit cells. The distance from $(\\frac{1}{2}, 0, 0)a$ to each of these 6 atoms is $\\frac{a}{2}$. These 6 atoms also form a regular octahedron. Thus, the midpoints of all 12 edges of the conventional cell are also octahedral interstitial sites.\n\nAll octahedral sites are symmetry-equivalent in the fcc lattice (space group Fm-3m). For example, translating the body-center site at $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$ by the fcc basis vector $(\\frac{1}{2}, \\frac{1}{2}, 0)$ yields $(1, 1, \\frac{1}{2})$, which is crystallographically equivalent to $(0, 0, \\frac{1}{2})$, an edge-center site. Thus, there is only one symmetry-inequivalent type of octahedral site. We choose $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$ as its representative fractional coordinate.\n\n**B. Tetrahedral Interstitial Sites**\n\nA tetrahedral interstitial site is a point equidistant from 4 host atoms that form a regular tetrahedron.\n\nLet's divide the conventional cell into 8 smaller cubes (octants), each with side length $\\frac{a}{2}$. Consider the octant at the origin, a cube with corners from $(0,0,0)$ to $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$. The vertices of this small cube that are occupied by host atoms are the corner atom at $(0,0,0)$ and the three face-center atoms at $(\\frac{1}{2}, \\frac{1}{2}, 0)$, $(\\frac{1}{2}, 0, \\frac{1}{2})$, and $(0, \\frac{1}{2}, \\frac{1}{2})$.\nThese four atoms form a regular tetrahedron. The distance between any two of them is the nearest-neighbor distance in the fcc lattice, $d = \\sqrt{(\\frac{a}{2})^2 + (\\frac{a}{2})^2} = \\frac{a}{\\sqrt{2}}$.\nThe center of this tetrahedron is the geometric center of the octant, which is at fractional coordinates $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$. The distance from this point to each of the four coordinating atoms is $\\sqrt{(\\frac{a}{4})^2 + (\\frac{a}{4})^2 + (\\frac{a}{4})^2} = \\frac{a\\sqrt{3}}{4}$. Thus, the point $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$ is a tetrahedral interstitial site.\n\nBy symmetry, there is an identical tetrahedral site at the center of each of the 8 octants of the conventional cell. The coordinates of these 8 sites are of the form $(\\pm\\frac{1}{4}, \\pm\\frac{1}{4}, \\pm\\frac{1}{4})$ relative to the cell center $(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$, giving absolute coordinates: $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$, $(\\frac{3}{4}, \\frac{1}{4}, \\frac{1}{4})$, $(\\frac{1}{4}, \\frac{3}{4}, \\frac{1}{4})$, $(\\frac{1}{4}, \\frac{1}{4}, \\frac{3}{4})$, $(\\frac{3}{4}, \\frac{3}{4}, \\frac{1}{4})$, $(\\frac{3}{4}, \\frac{1}{4}, \\frac{3}{4})$, $(\\frac{1}{4}, \\frac{3}{4}, \\frac{3}{4})$, and $(\\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4})$.\nAll these 8 sites are symmetry-equivalent. For example, the site at $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$ is mapped to $(\\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4})$ by inversion through the cell center $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$, which is a symmetry operation of the fcc lattice. Therefore, there is only one symmetry-inequivalent type of tetrahedral site. We choose $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$ as its representative fractional coordinate.\n\nThe stringent requirement that the coordinating host atoms form a regular polyhedron ensures that these sites must be at positions of high symmetry. A full group-theoretical analysis (using Wyckoff positions) confirms that these are the only types of interstitial sites satisfying the given nearest-neighbor definitions.\n\n**2. Number of Sites per Conventional Cell**\n\nTo find the total number of sites belonging to a single conventional cell, we must account for the sharing of sites on the cell boundaries.\n\n*   **Tetrahedral Sites ($N_{\\mathrm{tet, conv}}$)**:\n    The 8 tetrahedral sites, with coordinates like $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$ and $(\\frac{3}{4}, \\frac{1}{4}, \\frac{1}{4})$, are all located strictly inside the conventional cell. None of their coordinates are $0$ or $1$. Therefore, they are not shared with adjacent cells.\n    The total number of tetrahedral sites per conventional cell is $8$.\n    $$N_{\\mathrm{tet, conv}} = 8$$\n\n*   **Octahedral Sites ($N_{\\mathrm{oct, conv}}$)**:\n    The octahedral sites are found at two types of locations:\n    1.  The body center of the cube: There is $1$ such site at $(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$. It is entirely within the cell, contributing $1$ to the count.\n    2.  The midpoints of the edges: There are $12$ edges on a cube. Each site on an edge (e.g., at $(\\frac{1}{2}, 0, 0)$) is shared by $4$ adjacent conventional cells. Thus, each edge site contributes $\\frac{1}{4}$ to the count.\n    The total contribution from edge sites is $12 \\times \\frac{1}{4} = 3$.\n    The total number of octahedral sites per conventional cell is the sum of these contributions:\n    $$N_{\\mathrm{oct, conv}} = 1 (\\text{body center}) + 12 \\times \\frac{1}{4} (\\text{edge centers}) = 1 + 3 = 4$$\n\n**3. Site Densities per Primitive Cell**\n\nThe density of interstitial sites per primitive cell is the number of sites per host atom. First, we determine the number of atoms in a conventional fcc cell ($N_{\\mathrm{atoms, conv}}$).\nThere are 8 atoms at the corners, each shared by 8 cells, and 6 atoms at the face centers, each shared by 2 cells.\n$$N_{\\mathrm{atoms, conv}} = 8 \\times \\frac{1}{8} + 6 \\times \\frac{1}{2} = 1 + 3 = 4$$\nA conventional fcc cell contains 4 atoms (and thus the equivalent of 4 primitive cells, since a primitive cell contains 1 atom by definition).\n\nThe density of each type of site per primitive cell is the total number of sites in the conventional cell divided by the number of atoms in the conventional cell.\n\n*   **Density of Tetrahedral Sites ($N_{\\mathrm{tet}}$)**:\n    $$N_{\\mathrm{tet}} = \\frac{N_{\\mathrm{tet, conv}}}{N_{\\mathrm{atoms, conv}}} = \\frac{8}{4} = 2$$\n    There are $2$ tetrahedral sites per primitive cell.\n\n*   **Density of Octahedral Sites ($N_{\\mathrm{oct}}$)**:\n    $$N_{\\mathrm{oct}} = \\frac{N_{\\mathrm{oct, conv}}}{N_{\\mathrm{atoms, conv}}} = \\frac{4}{4} = 1$$\n    There is $1$ octahedral site per primitive cell.\n\nThe final answer is the pair of densities $(N_{\\mathrm{tet}}, N_{\\mathrm{oct}})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 2 & 1 \\end{pmatrix}\n}\n$$", "id": "2978756"}, {"introduction": "Defects in semiconductors are not neutral entities by default; they can trap or donate electrons, acquiring a charge that profoundly affects their stability. The formation energy of a defect in a given charge state $q$ is not a fixed number but depends linearly on the electron chemical potential, or Fermi level $E_F$. This practice guides you through the thermodynamic formalism to derive this crucial linear relationship and use it to calculate the charge-state transition level, a key parameter that dictates which defect charge state is most stable for a given $E_F$ [@problem_id:2852086].", "problem": "A point defect in a semiconductor crystal is formed in the presence of atomic and electronic reservoirs. Consider the grand-canonical formation process that exchanges atoms with atomic reservoirs of chemical potentials and exchanges electrons with an electron reservoir of chemical potential (the Fermi level). Let the defect be a vacancy in a binary compound with the valence-band maximum chosen as the zero of energy, so that the Fermi level is $E_F \\ge 0$ within the band gap. Assume temperature is sufficiently low that entropic contributions to the formation free energy can be neglected, and the formation energy is well approximated by ground-state energies and chemical potentials.\n\nStarting from the thermodynamic definition of formation energy for a defect in charge state $q$, constructed as a Legendre transform with respect to the electron number using the electron chemical potential $E_F$, derive the functional dependence of the formation energy $E_f^q(E_F)$ on $E_F$ and obtain its slope $\\mathrm{d}E_f^q/\\mathrm{d}E_F$ for general integer $q$.\n\nThen, consider a specific vacancy for which the following total formation energies at the valence-band maximum are known from reliable calculations:\n- $E_f^{+1}(0) = 2.70\\,\\mathrm{eV}$,\n- $E_f^{0}(0) = 3.10\\,\\mathrm{eV}$.\n\nHere $E_f^{q}(0)$ denotes the formation energy evaluated at $E_F = 0$ (i.e., at the valence-band maximum). Using your derived slope result and the definition of a thermodynamic charge-state transition level as the Fermi level at which two charge states have equal formation energies, compute the transition level $\\varepsilon(+1/0)$, defined relative to the valence-band maximum.\n\nExpress the final answer in electronvolts and round your answer to four significant figures.", "solution": "The problem requires the derivation of the functional dependence of the defect formation energy on the Fermi level, the slope of this function, and the subsequent calculation of a specific charge-state transition level.\n\nFirst, we must establish the thermodynamic definition for the formation energy of a point defect in a charge state $q$, denoted as $E_f^q$. The system is a crystal in contact with atomic reservoirs (with chemical potentials $\\mu_i$ for each atomic species $i$) and an electron reservoir (with chemical potential $E_F$, the Fermi level). This corresponds to a grand-canonical ensemble.\n\nThe formation energy $E_f^q$ is the difference in the grand potential of the system with and without the defect. When a defect is formed, a number $n_i$ of atoms of species $i$ are exchanged with the reservoirs, and a number of electrons corresponding to a net charge $q$ are exchanged with the electron reservoir. The sign convention is that $n_i > 0$ for atoms added to the crystal from the reservoir, and $q$ is the net charge of the defect, meaning $q$ electrons have been removed from the defect and transferred to the electron reservoir at energy $E_F$. The formation energy is given by:\n$$\nE_f^q(E_F, \\{\\mu_i\\}) = E_{tot}(defect, q) - E_{tot}(perfect) - \\sum_i n_i \\mu_i + q E_{F}\n$$\nwhere $E_{tot}(defect, q)$ is the total energy of the crystal containing one defect in charge state $q$, and $E_{tot}(perfect)$ is the total energy of the perfect crystal. The problem specifies that the valence-band maximum (VBM) is the zero of the energy scale, so $E_F$ is measured from the VBM.\n\nThe term $[E_{tot}(defect, q) - E_{tot}(perfect) - \\sum_i n_i \\mu_i]$ depends on the charge state $q$ and the atomic chemical potentials $\\{\\mu_i\\}$, but it is independent of the Fermi level $E_F$. This term represents the formation energy when the Fermi level is at the reference energy zero, i.e., at the VBM ($E_F=0$). Let us denote this quantity as $E_f^q(0)$:\n$$\nE_f^q(0) = E_{tot}(defect, q) - E_{tot}(perfect) - \\sum_i n_i \\mu_i\n$$\nSubstituting this into the general expression, we obtain the functional dependence of the formation energy on the Fermi level:\n$$\nE_f^q(E_F) = E_f^q(0) + qE_F\n$$\nThis equation shows that the formation energy of a defect in a specific charge state $q$ is a linear function of the Fermi level $E_F$.\n\nThe second task is to find the slope of this function, which is its derivative with respect to $E_F$. Taking the derivative of the expression above:\n$$\n\\frac{\\mathrm{d}E_f^q}{\\mathrm{d}E_F} = \\frac{\\mathrm{d}}{\\mathrm{d}E_F} \\left[ E_f^q(0) + qE_F \\right]\n$$\nSince $E_f^q(0)$ is a constant with respect to $E_F$, its derivative is zero. The derivative of $qE_F$ with respect to $E_F$ is simply $q$.\nTherefore, the slope is:\n$$\n\\frac{\\mathrm{d}E_f^q}{\\mathrm{d}E_F} = q\n$$\nThe slope of the formation energy versus Fermi level diagram is equal to the charge state of the defect.\n\nThe final task is to compute the thermodynamic charge-state transition level $\\varepsilon(+1/0)$. This level is defined as the value of the Fermi level $E_F$ at which the formation energies of the two charge states, $q=+1$ and $q=0$, are equal.\n$$\nE_f^{+1}(\\varepsilon(+1/0)) = E_f^{0}(\\varepsilon(+1/0))\n$$\nUsing the derived linear relationship for each charge state:\n$$\nE_f^{+1}(0) + (+1)\\varepsilon(+1/0) = E_f^{0}(0) + (0)\\varepsilon(+1/0)\n$$\nThis simplifies to:\n$$\nE_f^{+1}(0) + \\varepsilon(+1/0) = E_f^{0}(0)\n$$\nSolving for the transition level $\\varepsilon(+1/0)$:\n$$\n\\varepsilon(+1/0) = E_f^{0}(0) - E_f^{+1}(0)\n$$\nWe are given the numerical values for the formation energies at the VBM ($E_F=0$):\n- $E_f^{+1}(0) = 2.70\\,\\mathrm{eV}$\n- $E_f^{0}(0) = 3.10\\,\\mathrm{eV}$\n\nSubstituting the numerical parts of these values into the expression for the transition level:\n$$\n\\varepsilon(+1/0) = 3.10 - 2.70 = 0.40\n$$\nSince the formation energies are given in electronvolts ($\\mathrm{eV}$), the resulting transition level is also in electronvolts. Thus, $\\varepsilon(+1/0) = 0.40\\,\\mathrm{eV}$.\nThe problem requires the answer to be expressed in electronvolts and rounded to four significant figures. The calculated value is $0.40$. To express this with four significant figures, we write it as $0.4000$.", "answer": "$$\n\\boxed{0.4000}\n$$", "id": "2852086"}, {"introduction": "We now arrive at a powerful synthesis that illustrates the deep connection between defect thermodynamics and the electronic properties of a semiconductor. While the concentration of charged defects depends on the Fermi level $E_F$, the Fermi level itself is determined by the total balance of all charges in the crystal—holes, electrons, and the defects themselves. This exercise challenges you to implement a self-consistent calculation that solves this feedback loop, determining the equilibrium $E_F(T)$ by enforcing the charge neutrality condition, a central task in modern computational materials science for predicting and engineering material behavior [@problem_id:2978777].", "problem": "You are to derive, implement, and compute the self-consistent Fermi level for a semiconductor containing charged vacancies and interstitials using first principles of equilibrium statistical mechanics and charge conservation. The system is defined by a single, non-degenerate semiconductor with parabolic bands and dilute defects. All energies must be treated in electronvolts (eV), all temperatures in kelvin (K), and all number densities in per cubic centimeter (cm$^{-3}$). The final results must be expressed in eV.\n\nStarting from fundamental laws and core definitions, use the following base:\n- Charge conservation in equilibrium requires that the total net charge density vanishes. The net charge density is the sum of the positive charge density minus the sum of the negative charge density and depends on the Fermi level $E_F$.\n- The conduction band minimum is at energy $E_c$, the valence band maximum is at energy $E_v$, and the band gap is $E_g = E_c - E_v$. By convention, set $E_v = 0$, so $E_c = E_g$, and measure $E_F$ relative to $E_v$.\n- Under the Maxwell–Boltzmann approximation for non-degenerate carriers with parabolic bands, the electron and hole number densities as functions of $E_F$ at temperature $T$ are given by the effective density of states and Fermi-Dirac statistics in the non-degenerate limit: $n(E_F,T)$ and $p(E_F,T)$. You must express these in terms of $N_c$, $N_v$, $E_g$, $E_F$, and $T$, using the Boltzmann constant $k_B$.\n- For each defect species $j$ (such as a vacancy or an interstitial), enumerate its allowed charge states $q$ and provide the formation energy at $E_F = 0$, denoted $E_{f,0}^{(j,q)}$. The dilute-equilibrium concentration of defects in charge state $q$ is proportional to a Boltzmann factor governed by its formation energy at the current $E_F$, a site density $N_{\\text{sites}}^{(j)}$, and an optional degeneracy factor $g^{(j,q)}$. The formation energy depends linearly on $E_F$ through the charge $q$.\n\nDerive the charge neutrality condition by equating the total positive charge density to the total negative charge density in terms of $p(E_F,T)$, $n(E_F,T)$, and the defect charge densities constructed from the concentrations of each defect charge state. Write the neutrality function as a scalar function of $E_F$ that must be zero at equilibrium, and explain how its monotonicity and continuity enable reliable root finding for $E_F$ in the band gap. Then design an algorithm to solve for $E_F(T)$ self-consistently: for given parameters, construct the neutrality function and use a robust bracketed root-finding method to find the unique $E_F$ within the physically meaningful interval. If needed, implement a systematic bracket search to guarantee a sign change.\n\nImplement a complete program that, for each test case below, computes the self-consistent Fermi level $E_F$ in eV relative to the valence band maximum, rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n\nAll mathematical symbols, variables, functions, operators, and numbers must be written in LaTeX. The physical units for any outputs must be explicitly specified. Angles are not involved. If any fraction is required, it must be expressed as a decimal number.\n\nUse the Boltzmann constant $k_B = 8.617333262145 \\times 10^{-5}$ eV/K. For each defect species $j$, model the concentration of charge state $q$ at temperature $T$ and Fermi level $E_F$ as\n$$\nc^{(j,q)}(E_F,T) = N_{\\text{sites}}^{(j)} \\, g^{(j,q)} \\, \\exp\\!\\left( -\\frac{E_{f}^{(j,q)}(E_F)}{k_B T} \\right),\n$$\nwith\n$$\nE_{f}^{(j,q)}(E_F) = E_{f,0}^{(j,q)} + q \\, E_F.\n$$\nAssume dilute defects so that site depletion is negligible and charge states are non-interacting.\n\nDefine the electron and hole densities for non-degenerate semiconductors with parabolic bands as\n$$\nn(E_F,T) = N_c \\, \\exp\\!\\left( -\\frac{E_c - E_F}{k_B T} \\right), \\quad\np(E_F,T) = N_v \\, \\exp\\!\\left( -\\frac{E_F - E_v}{k_B T} \\right),\n$$\nwith $E_v = 0$ and $E_c = E_g$. These are well-tested formulas under the Maxwell–Boltzmann approximation.\n\nThe neutrality function is constructed from the difference between the total positive and total negative charge densities. This function must be zero at equilibrium. Solve for $E_F$ in the interval $[0, E_g]$ using a bracketed root-finding method; if a sign change is not immediately available, implement a systematic bracket search over an expanded interval to reliably locate a sign change.\n\nTest Suite and Parameters (all energies in eV and all densities in cm$^{-3}$; $E_F$ must be returned in eV relative to $E_v$):\n- Test case $1$ (intrinsic-like, moderate defects):\n  - $E_g = 1.12$, $N_c = 2.8 \\times 10^{19}$, $N_v = 1.04 \\times 10^{19}$, $T = 300$.\n  - Vacancy: $N_{\\text{sites}}^{(\\mathrm{V})} = 5.0 \\times 10^{22}$; charge states $q = [0, -1, -2]$; $E_{f,0}^{(\\mathrm{V},q)} = [3.6, 3.4, 3.3]$; $g^{(\\mathrm{V},q)} = [1, 1, 1]$.\n  - Interstitial: $N_{\\text{sites}}^{(\\mathrm{I})} = 5.0 \\times 10^{22}$; charge states $q = [0, +1, +2]$; $E_{f,0}^{(\\mathrm{I},q)} = [3.6, 3.7, 3.9]$; $g^{(\\mathrm{I},q)} = [1, 1, 1]$.\n- Test case $2$ (high temperature, donor-like interstitials):\n  - $E_g = 1.12$, $N_c = 2.8 \\times 10^{19}$, $N_v = 1.04 \\times 10^{19}$, $T = 1000$.\n  - Vacancy: $N_{\\text{sites}}^{(\\mathrm{V})} = 5.0 \\times 10^{22}$; charge states $q = [0, -1, -2]$; $E_{f,0}^{(\\mathrm{V},q)} = [3.8, 3.6, 3.5]$; $g^{(\\mathrm{V},q)} = [1, 1, 1]$.\n  - Interstitial: $N_{\\text{sites}}^{(\\mathrm{I})} = 5.0 \\times 10^{22}$; charge states $q = [0, +1, +2]$; $E_{f,0}^{(\\mathrm{I},q)} = [2.0, 1.4, 1.5]$; $g^{(\\mathrm{I},q)} = [1, 1, 1]$.\n- Test case $3$ (narrow-gap semiconductor, balanced defects):\n  - $E_g = 0.5$, $N_c = 1.5 \\times 10^{19}$, $N_v = 1.5 \\times 10^{19}$, $T = 600$.\n  - Vacancy: $N_{\\text{sites}}^{(\\mathrm{V})} = 1.0 \\times 10^{22}$; charge states $q = [0, -1, -2]$; $E_{f,0}^{(\\mathrm{V},q)} = [2.2, 2.0, 1.9]$; $g^{(\\mathrm{V},q)} = [1, 1, 1]$.\n  - Interstitial: $N_{\\text{sites}}^{(\\mathrm{I})} = 1.0 \\times 10^{22}$; charge states $q = [0, +1]$; $E_{f,0}^{(\\mathrm{I},q)} = [2.5, 2.6]$; $g^{(\\mathrm{I},q)} = [1, 1]$.\n- Test case $4$ (no defects, intrinsic reference):\n  - $E_g = 1.12$, $N_c = 2.8 \\times 10^{19}$, $N_v = 1.04 \\times 10^{19}$, $T = 300$.\n  - Vacancy: $N_{\\text{sites}}^{(\\mathrm{V})} = 0$; charge states $q = [0]$; $E_{f,0}^{(\\mathrm{V},q)} = [10.0]$; $g^{(\\mathrm{V},q)} = [1]$.\n  - Interstitial: $N_{\\text{sites}}^{(\\mathrm{I})} = 0$; charge states $q = [0]$; $E_{f,0}^{(\\mathrm{I},q)} = [10.0]$; $g^{(\\mathrm{I},q)} = [1]$.\n- Test case $5$ (heavily donor-like interstitials):\n  - $E_g = 1.8$, $N_c = 2.0 \\times 10^{19}$, $N_v = 2.0 \\times 10^{19}$, $T = 800$.\n  - Vacancy: $N_{\\text{sites}}^{(\\mathrm{V})} = 1.0 \\times 10^{22}$; charge states $q = [0, -1]$; $E_{f,0}^{(\\mathrm{V},q)} = [3.0, 2.8]$; $g^{(\\mathrm{V},q)} = [1, 1]$.\n  - Interstitial: $N_{\\text{sites}}^{(\\mathrm{I})} = 1.0 \\times 10^{22}$; charge states $q = [0, +1]$; $E_{f,0}^{(\\mathrm{I},q)} = [1.0, 0.6]$; $g^{(\\mathrm{I},q)} = [1, 2]$.\n\nYour program must compute $E_F$ for each test case and print a single line with a comma-separated list of the five $E_F$ values in eV, rounded to six decimal places, enclosed in square brackets. For example, a valid output line is \"[0.547200,0.650000,0.250000,0.547200,1.676000]\".", "solution": "The equilibrium Fermi level $E_F$ is determined by the principle of charge neutrality, which states that the total positive charge density must equal the total negative charge density. The total charge density $\\rho(E_F, T)$ is the sum of charges from holes ($p$), electrons ($n$), and all charged defects.\n\nThe charge neutrality condition is expressed as $\\rho(E_F, T) = 0$, where:\n$$\n\\rho(E_F, T) = p(E_F, T) - n(E_F, T) + \\sum_{j,q} q \\cdot c^{(j,q)}(E_F, T)\n$$\nHere, $j$ indexes the defect species (vacancy, interstitial) and $q$ indexes the charge states. The concentrations are given by the expressions in the problem statement:\n- Hole density: $p(E_F, T) = N_v \\exp(-E_F / k_B T)$\n- Electron density: $n(E_F, T) = N_c \\exp(-(E_g - E_F) / k_B T)$\n- Defect concentration: $c^{(j,q)}(E_F, T) = N_{\\text{sites}}^{(j)} g^{(j,q)} \\exp(-(E_{f,0}^{(j,q)} + q E_F) / k_B T)$\n\nThe function $\\rho(E_F, T)$, which we seek to find the root of, is a continuous and strictly monotonically decreasing function of $E_F$. This can be seen by examining the derivative of each term with respect to $E_F$:\n- $\\frac{\\partial p}{\\partial E_F} < 0$\n- $\\frac{\\partial (-n)}{\\partial E_F} < 0$\n- For a donor state ($q>0$), the term is $q c^{(j,q)}$. Its derivative with respect to $E_F$ is negative.\n- For an acceptor state ($q0$), the term is $q c^{(j,q)}$. Its derivative with respect to $E_F$ is also negative.\nSince all terms are monotonically decreasing, their sum $\\rho(E_F, T)$ is also monotonically decreasing. This property, combined with the fact that $\\rho(E_F) \\to +\\infty$ as $E_F \\to -\\infty$ and $\\rho(E_F) \\to -\\infty$ as $E_F \\to +\\infty$, guarantees that there is a unique value of $E_F$ for which $\\rho(E_F, T) = 0$.\n\nThe algorithm to find the self-consistent Fermi level is as follows:\n1.  Define a function `neutrality_function(E_F)` that computes $\\rho(E_F, T)$ for a given set of material parameters ($E_g, N_c, N_v, T$) and defect properties.\n2.  Choose a search interval for $E_F$ that is guaranteed to contain the root. A physically meaningful and robust choice is an interval that spans the band gap with some margin, for example, $[-1.0, E_g + 1.0]$ eV.\n3.  Use a numerical root-finding algorithm that is efficient for monotonic functions, such as the bisection method or Brent's method, to find the value of $E_F$ where `neutrality_function(E_F)` is zero to a desired precision.\n\nThis procedure is implemented for each test case to compute the corresponding equilibrium Fermi level $E_F$.", "answer": "$$\n\\boxed{[\\text{0.547200,0.650000,0.250000,0.547200,1.675971}]}\n$$", "id": "2978777"}]}