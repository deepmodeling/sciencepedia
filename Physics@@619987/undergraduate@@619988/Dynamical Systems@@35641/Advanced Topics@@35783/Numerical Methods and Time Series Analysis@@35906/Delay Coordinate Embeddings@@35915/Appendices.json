{"hands_on_practices": [{"introduction": "The first step in using delay coordinate embedding is to translate a one-dimensional time series into a multi-dimensional state space. This exercise provides direct, hands-on practice with this fundamental procedure. By constructing delay vectors from a sample environmental dataset, you will solidify your understanding of how the embedding dimension $m$ and time delay $\\tau$ are used to build the reconstructed phase space. This foundational skill is the gateway to visualizing and analyzing the dynamics hidden within a single stream of data [@problem_id:1671692].", "problem": "A common technique in the analysis of nonlinear dynamical systems is to reconstruct a phase space from a single time series using delay coordinate embedding. Consider a time series of a single observable, represented as a sequence of measurements $s_1, s_2, s_3, \\dots, s_N$. A delay vector $\\mathbf{v}_k$ in the reconstructed phase space is formed by taking $m$ values from the time series, separated by a time delay $\\tau$. The $k$-th vector, starting from the measurement $s_k$, is defined as:\n$$\n\\mathbf{v}_k = (s_k, s_{k+\\tau}, s_{k+2\\tau}, \\dots, s_{k+(m-1)\\tau})\n$$\nAn environmental scientist has recorded the monthly average atmospheric CO2 concentration for a year. The time series data, denoted by $c_k$ for the $k$-th month, is given in parts per million (ppm) as:\n$C = \\{410.5, 411.2, 412.1, 413.0, 412.8, 411.7, 410.1, 408.9, 409.5, 410.8, 412.3, 413.5\\}$\n\nUsing an embedding dimension of $m=4$ and a time delay of $\\tau=2$ months, the first three valid delay vectors that can be constructed are $\\mathbf{v}_1$, $\\mathbf{v}_2$, and $\\mathbf{v}_3$.\n\nCalculate the magnitude (Euclidean norm) of the vector sum $\\mathbf{V} = \\mathbf{v}_1 + \\mathbf{v}_2 + \\mathbf{v}_3$. Express your final answer in ppm, rounded to five significant figures.", "solution": "We are given the monthly time series $C=\\{c_{1},c_{2},\\dots,c_{12}\\}$ with $c_{1}=410.5$, $c_{2}=411.2$, $c_{3}=412.1$, $c_{4}=413.0$, $c_{5}=412.8$, $c_{6}=411.7$, $c_{7}=410.1$, $c_{8}=408.9$, $c_{9}=409.5$, $c_{10}=410.8$, $c_{11}=412.3$, $c_{12}=413.5$. For embedding dimension $m=4$ and delay $\\tau=2$, the delay vectors are defined by\n$$\n\\mathbf{v}_{k}=(c_{k},c_{k+2},c_{k+4},c_{k+6}).\n$$\nThe first three valid vectors (for $k=1,2,3$) are\n$$\n\\mathbf{v}_{1}=(c_{1},c_{3},c_{5},c_{7})=(410.5,\\,412.1,\\,412.8,\\,410.1),\n$$\n$$\n\\mathbf{v}_{2}=(c_{2},c_{4},c_{6},c_{8})=(411.2,\\,413.0,\\,411.7,\\,408.9),\n$$\n$$\n\\mathbf{v}_{3}=(c_{3},c_{5},c_{7},c_{9})=(412.1,\\,412.8,\\,410.1,\\,409.5).\n$$\nTheir sum is computed componentwise:\n$$\n\\mathbf{V}=\\mathbf{v}_{1}+\\mathbf{v}_{2}+\\mathbf{v}_{3}=(410.5+411.2+412.1,\\,412.1+413.0+412.8,\\,412.8+411.7+410.1,\\,410.1+408.9+409.5),\n$$\n$$\n\\mathbf{V}=(1233.8,\\,1237.9,\\,1234.6,\\,1228.5).\n$$\nThe Euclidean norm is\n$$\n\\|\\mathbf{V}\\|=\\sqrt{(1233.8)^{2}+(1237.9)^{2}+(1234.6)^{2}+(1228.5)^{2}}.\n$$\nCompute each square:\n$$\n(1233.8)^{2}=1{,}522{,}262.44,\\quad (1237.9)^{2}=1{,}532{,}396.41,\\quad (1234.6)^{2}=1{,}524{,}237.16,\\quad (1228.5)^{2}=1{,}509{,}212.25.\n$$\nSum:\n$$\n1{,}522{,}262.44+1{,}532{,}396.41+1{,}524{,}237.16+1{,}509{,}212.25=6{,}088{,}108.26.\n$$\nThus\n$$\n\\|\\mathbf{V}\\|=\\sqrt{6{,}088{,}108.26}\\approx 2467.409\\ldots\n$$\nRounded to five significant figures, this is $2467.4$ (ppm).", "answer": "$$\\boxed{2467.4}$$", "id": "1671692"}, {"introduction": "Choosing an appropriate time delay $\\tau$ is crucial for a successful embedding; it must be long enough to reveal new information but short enough that the components are not yet causally disconnected. This problem explores this principle through a clear, conceptual example involving a periodic signal. By determining the specific delays that transform a simple sine wave into a perfect circle, you will gain a powerful intuition for how $\\tau$ interacts with the intrinsic timescales of a system to unfold its dynamics geometrically [@problem_id:1671698].", "problem": "In the study of dynamical systems, a delay coordinate embedding is a technique used to reconstruct a multi-dimensional phase space from a single time-series measurement.\n\nConsider a one-dimensional, zero-mean periodic signal $x(t)$ with a fundamental period $T > 0$. A two-dimensional delay coordinate embedding is constructed from this signal, defined by the vector $\\vec{v}(t) = (x(t), x(t+\\tau))$, where $\\tau$ is a constant time delay.\n\nIt is observed that for certain choices of $\\tau$, the trajectory traced by $\\vec{v}(t)$ as a function of time $t$ in the two-dimensional phase space is a perfect circle centered at the origin. Assuming the periodic signal $x(t)$ can be well-approximated by its fundamental sinusoidal component, which of the following options describes all possible relationships between the time delay $\\tau$ and the period $T$ that result in such a circular trajectory?\n\nA. $\\tau = \\frac{nT}{2}$ for any integer $n \\ge 1$.\n\nB. $\\tau = \\frac{nT}{4}$ for any integer $n \\ge 1$.\n\nC. $\\tau = \\frac{(2n+1)T}{4}$ for any integer $n \\ge 0$.\n\nD. $\\tau = \\frac{(2n+1)T}{2}$ for any integer $n \\ge 0$.\n\nE. $\\tau = \\frac{T}{\\pi}$ for any integer $n \\ge 0$.", "solution": "Assume the zero-mean periodic signal is well-approximated by its fundamental sinusoidal component, so write\n$$\nx(t)=A\\cos(\\omega t+\\phi),\n$$\nwhere $A$ is the amplitude, $\\omega=\\frac{2\\pi}{T}$ is the angular frequency, and $\\phi$ is a phase. Define\n$$\n\\theta=\\omega t+\\phi,\\qquad \\Delta=\\omega \\tau=\\frac{2\\pi}{T}\\,\\tau,\n$$\nso the delay-embedded vector is\n$$\n(x,y)=\\bigl(x(t),x(t+\\tau)\\bigr)=\\bigl(A\\cos\\theta,\\;A\\cos(\\theta+\\Delta)\\bigr).\n$$\nTo find the locus in the $(x,y)$-plane, eliminate $\\theta$. Using $\\cos(\\theta+\\Delta)=\\cos\\theta\\cos\\Delta-\\sin\\theta\\sin\\Delta$, we have\n$$\n\\frac{y}{A}=\\frac{x}{A}\\cos\\Delta-\\sin\\theta\\,\\sin\\Delta,\n$$\nso\n$$\n\\sin\\theta=\\frac{\\frac{x}{A}\\cos\\Delta-\\frac{y}{A}}{\\sin\\Delta},\\qquad \\cos\\theta=\\frac{x}{A}.\n$$\nImpose $\\cos^{2}\\theta+\\sin^{2}\\theta=1$:\n$$\n\\left(\\frac{x}{A}\\right)^{2}+\\left(\\frac{\\frac{x}{A}\\cos\\Delta-\\frac{y}{A}}{\\sin\\Delta}\\right)^{2}=1.\n$$\nMultiply by $A^{2}\\sin^{2}\\Delta$ and expand:\n$$\nx^{2}\\sin^{2}\\Delta+(x\\cos\\Delta-y)^{2}=A^{2}\\sin^{2}\\Delta,\n$$\n$$\nx^{2}\\sin^{2}\\Delta+x^{2}\\cos^{2}\\Delta-2xy\\cos\\Delta+y^{2}=A^{2}\\sin^{2}\\Delta,\n$$\n$$\nx^{2}-2xy\\cos\\Delta+y^{2}=A^{2}\\sin^{2}\\Delta.\n$$\nThis is the equation of a conic centered at the origin. It becomes a circle centered at the origin precisely when the cross term vanishes, i.e., when $\\cos\\Delta=0$. Then $\\sin^{2}\\Delta=1$ and the equation reduces to\n$$\nx^{2}+y^{2}=A^{2},\n$$\na circle of radius $A$. The condition $\\cos\\Delta=0$ gives\n$$\n\\Delta=\\frac{\\pi}{2}+k\\pi=\\frac{(2k+1)\\pi}{2},\\qquad k\\in\\mathbb{Z}.\n$$\nSince $\\Delta=\\omega\\tau=\\frac{2\\pi}{T}\\tau$, solve for $\\tau$:\n$$\n\\frac{2\\pi}{T}\\,\\tau=\\frac{(2k+1)\\pi}{2}\\quad\\Longrightarrow\\quad \\tau=\\frac{(2k+1)T}{4}.\n$$\nThus the delays that yield a perfect circle are the odd quarter-periods of $T$. Among the options, this is exactly described by $\\tau=\\frac{(2n+1)T}{4}$ for integers $n\\ge 0$, which is option C. Other listed families include values that do not satisfy $\\cos\\Delta=0$ (e.g., half-period delays give lines, not circles), so they do not describe exclusively the required set.", "answer": "$$\\boxed{C}$$", "id": "1671698"}, {"introduction": "According to Takens' theorem, an embedding dimension $m$ that is large enough will guarantee a faithful reconstruction of the original dynamics, but how do we find the *minimum* sufficient $m$? This practice introduces the False Nearest Neighbors (FNN) algorithm, a standard method for answering this question. By analyzing how FNN works on the classic logistic map, you will see how the algorithm leverages the local stretching and folding of the dynamics to computationally detect when an embedding dimension is too small to resolve the attractor's geometry [@problem_id:1671708].", "problem": "The method of delay coordinate embedding is a powerful technique for reconstructing the state space of a dynamical system from a single time series. One common algorithm to determine the minimum sufficient embedding dimension, $m$, is the False Nearest Neighbors (FNN) algorithm. The core idea is to see if points that are close in an embedding of dimension $m$ remain close in dimension $m+1$. If they do not, they are considered \"false\" neighbors, implying that the dimension $m$ was too small to unfold the attractor.\n\nConsider a time series $\\{x_n\\}_{n=0,1,2,\\dots}$ generated by the one-dimensional logistic map, defined by the iterative equation $x_{n+1} = f(x_n) = r x_n (1-x_n)$, where the state $x_n$ is confined to the interval $[0, 1]$. We will analyze this time series with a time delay of $\\tau=1$.\n\nA delay vector in an embedding dimension $m$ is given by $\\vec{V}_n^{(m)} = (x_n, x_{n+1}, \\dots, x_{n+m-1})$. The FNN algorithm proceeds as follows:\n1. For each vector $\\vec{V}_i^{(m)}$, find its nearest neighbor $\\vec{V}_j^{(m)}$ in the sense of Euclidean distance.\n2. This pair is classified as a \"false neighbor\" if their separation grows disproportionately when moving to dimension $m+1$. A standard criterion for this is to check if the ratio\n$$ C_{ij}^{(m)} = \\frac{|x_{i+m} - x_{j+m}|}{||\\vec{V}_i^{(m)} - \\vec{V}_j^{(m)}||} $$\nexceeds a certain threshold, $R_{tol}$. The term $|x_{i+m} - x_{j+m}|$ represents the additional separation introduced by the $(m+1)$-th coordinate.\n\nYour task is to analyze the FNN algorithm for the transition from $m=1$ to $m=2$. For two points $x_i$ and $x_j$ that are infinitesimally close (i.e., $|x_i - x_j| \\to 0$), the ratio $C_{ij}^{(1)}$ approaches a value determined by the local dynamics of the map. Assuming the logistic map parameter is set to $r=4$, determine the maximum possible value of this limiting ratio over the entire domain $x \\in [0, 1]$. This value provides a physical upper bound on the FNN test statistic due to local stretching and informs the choice of a suitable threshold $R_{tol}$ to avoid misclassifying true neighbors.", "solution": "For embedding dimension $m=1$, each delay vector is $\\vec{V}_{n}^{(1)}=(x_{n})$, so the Euclidean distance between two vectors is $||\\vec{V}_{i}^{(1)}-\\vec{V}_{j}^{(1)}|| = |x_{i}-x_{j}|$. The false-nearest-neighbor statistic for $m=1$ is\n$$\nC_{ij}^{(1)}=\\frac{|x_{i+1}-x_{j+1}|}{|x_{i}-x_{j}|}=\\frac{|f(x_{i})-f(x_{j})|}{|x_{i}-x_{j}|}.\n$$\nFor infinitesimally close points, let $\\Delta=x_{j}-x_{i}\\to 0$. By the mean value theorem, there exists $\\xi$ between $x_{i}$ and $x_{j}$ such that\n$$\nf(x_{j})-f(x_{i})=f'(\\xi)(x_{j}-x_{i}),\n$$\nhence\n$$\n\\lim_{\\Delta\\to 0} C_{ij}^{(1)}=\\lim_{\\Delta\\to 0}\\frac{|f(x_{i})-f(x_{j})|}{|x_{i}-x_{j}|}=\\lim_{\\Delta\\to 0}|f'(\\xi)|=|f'(x)|,\n$$\nwhere $x$ is the common limit point of $x_{i}$ and $x_{j}$.\n\nFor the logistic map $f(x)=r x(1-x)$, the derivative is\n$$\nf'(x)=r(1-2x).\n$$\nWith $r=4$, this becomes $f'(x)=4(1-2x)$, so the limiting ratio is\n$$\n|f'(x)|=4|1-2x|.\n$$\nOver $x\\in[0,1]$, the function $|1-2x|$ attains its maximum value $1$ at $x=0$ and $x=1$. Therefore, the maximum possible value of the limiting ratio is\n$$\n\\max_{x\\in[0,1]}|f'(x)|=\\max_{x\\in[0,1]}4|1-2x|=4.\n$$\nThis is the physical upper bound on the FNN test statistic due to local stretching for the transition from $m=1$ to $m=2$ with $\\tau=1$ in the logistic map at $r=4$.", "answer": "$$\\boxed{4}$$", "id": "1671708"}]}