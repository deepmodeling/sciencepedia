{"hands_on_practices": [{"introduction": "The fundamental principle of surrogate data testing is to compare a statistical property of your observed data against a distribution of the same property derived from randomized \"surrogate\" datasets. This first practice exercise provides a concrete, step-by-step demonstration of the entire hypothesis testing procedure. By analyzing a simple time series from a hypothetical physics experiment, you will calculate a key statistic, compare it to the values from shuffled surrogates, and determine the statistical significance of your finding, thereby gaining a foundational understanding of the method in action. [@problem_id:1712276]", "problem": "A physicist is investigating a system where a small, highly elastic ball bounces on a specialized surface whose temperature is actively, but imperfectly, controlled. The hypothesis is that the sequence of peak bounce heights is an Independent and Identically Distributed (IID) process, meaning there is no \"memory\" or correlation between consecutive bounces. To test this null hypothesis, a surrogate data method is employed.\n\nThe recorded time series of five consecutive peak bounce heights, in meters, is given by:\n$$ H_{data} = \\{0.80, 0.60, 0.65, 0.45, 0.50\\} $$\n\nTo create a reference distribution under the null hypothesis, four surrogate time series were generated by shuffling the original data:\n- $S_1 = \\{0.45, 0.50, 0.60, 0.65, 0.80\\}$\n- $S_2 = \\{0.60, 0.80, 0.45, 0.50, 0.65\\}$\n- $S_3 = \\{0.80, 0.45, 0.65, 0.50, 0.60\\}$\n- $S_4 = \\{0.50, 0.80, 0.60, 0.45, 0.65\\}$\n\nThe test statistic used to quantify temporal correlation is the lag-1 autocorrelation coefficient, $r_1$. For a time series $x = \\{x_1, x_2, \\dots, x_N\\}$ with mean $\\bar{x}$, the lag-1 autocorrelation is defined as:\n$$ r_1 = \\frac{\\sum_{i=1}^{N-1} (x_i - \\bar{x})(x_{i+1} - \\bar{x})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2} $$\n\nYour task is to perform the significance test. Calculate the p-value, defined as the proportion of the provided surrogate datasets whose lag-1 autocorrelation is greater than or equal to the lag-1 autocorrelation of the original data, $H_{data}$. Express your answer as a decimal rounded to two significant figures.", "solution": "We use the lag-1 autocorrelation definition\n$$\nr_{1}=\\frac{\\sum_{i=1}^{N-1}(x_{i}-\\bar{x})(x_{i+1}-\\bar{x})}{\\sum_{i=1}^{N}(x_{i}-\\bar{x})^{2}},\n$$\nwith $N=5$ for each series. Since all surrogates are permutations of the same values, each has the same mean and the same denominator as the original.\n\nFor $H_{data}=\\{0.80,0.60,0.65,0.45,0.50\\}$, the mean is\n$$\n\\bar{x}=\\frac{0.80+0.60+0.65+0.45+0.50}{5}=\\frac{3.00}{5}=0.60.\n$$\nDeviations are $d=\\{0.20,0.00,0.05,-0.15,-0.10\\}$. The denominator is\n$$\n\\sum_{i=1}^{5}d_{i}^{2}=0.20^{2}+0.00^{2}+0.05^{2}+(-0.15)^{2}+(-0.10)^{2}=0.0750.\n$$\nThe numerator is\n$$\n\\sum_{i=1}^{4}d_{i}d_{i+1}=(0.20)(0.00)+(0.00)(0.05)+(0.05)(-0.15)+(-0.15)(-0.10)=0.0075,\n$$\nso\n$$\nr_{1}(H_{data})=\\frac{0.0075}{0.0750}=0.10.\n$$\n\nFor each surrogate, $\\bar{x}=0.60$ and the denominator is $0.0750$. Compute numerators and $r_{1}$:\n\n- $S_{1}=\\{0.45,0.50,0.60,0.65,0.80\\}$ has deviations $\\{-0.15,-0.10,0.00,0.05,0.20\\}$, numerator $0.015+0+0+0.010=0.025$, so\n$$\nr_{1}(S_{1})=\\frac{0.025}{0.075}=\\frac{1}{3}\\approx 0.333\\ldots\n$$\n- $S_{2}=\\{0.60,0.80,0.45,0.50,0.65\\}$ has deviations $\\{0.00,0.20,-0.15,-0.10,0.05\\}$, numerator $0-0.030+0.015-0.005=-0.020$, so\n$$\nr_{1}(S_{2})=\\frac{-0.020}{0.075}=-0.266\\ldots\n$$\n- $S_{3}=\\{0.80,0.45,0.65,0.50,0.60\\}$ has deviations $\\{0.20,-0.15,0.05,-0.10,0.00\\}$, numerator $-0.030-0.0075-0.005+0=-0.0425$, so\n$$\nr_{1}(S_{3})=\\frac{-0.0425}{0.075}=-0.566\\ldots\n$$\n- $S_{4}=\\{0.50,0.80,0.60,0.45,0.65\\}$ has deviations $\\{-0.10,0.20,0.00,-0.15,0.05\\}$, numerator $-0.020+0+0-0.0075=-0.0275$, so\n$$\nr_{1}(S_{4})=\\frac{-0.0275}{0.075}=-0.366\\ldots\n$$\n\nWe compare with $r_{1}(H_{data})=0.10$. Among the surrogates, only $S_{1}$ has $r_{1}\\geq 0.10$, giving $1$ out of $4$. Therefore, the p-value is\n$$\np=\\frac{1}{4}=0.25,\n$$\nwhich rounded to two significant figures is $0.25$.", "answer": "$$\\boxed{0.25}$$", "id": "1712276"}, {"introduction": "Moving beyond simple shuffling, more sophisticated surrogate methods like Fourier Transform (FT) surrogates are designed to test for specific features such as nonlinearity. This exercise challenges you to think critically about the relationship between a dynamical system's behavior and the surrogate test's outcome. By considering the logistic map—a classic model in nonlinear dynamics—you will explore why a test might fail to distinguish a non-chaotic signal from its randomized counterpart, deepening your understanding of the assumptions and limitations inherent in these powerful tools. [@problem_id:1712286]", "problem": "A student in an introductory nonlinear dynamics course is investigating the logistic map, a simple model for population growth described by the iterative equation $x_{n+1} = r x_n(1 - x_n)$, where $x_n$ is the population at generation $n$, scaled to be between 0 and 1. The student sets the growth parameter $r=2.8$ and generates a time series of 1000 points starting from an initial condition of $x_0 = 0.2$.\n\nTo test for nonlinearity, the student decides to use the surrogate data method. Specifically, they generate a Fourier Transform (FT) surrogate time series. The procedure for generating this surrogate is as follows:\n1. Compute the Discrete Fourier Transform of the original time series.\n2. Keep the magnitudes of the resulting complex Fourier coefficients, but replace their phases with random numbers uniformly distributed between $0$ and $2\\pi$. Special care is taken to ensure the reality condition of the signal (i.e., the spectrum remains symmetric).\n3. Compute the inverse Discrete Fourier Transform of the modified coefficients to obtain the surrogate time series.\n\nUpon plotting both the original time series from the logistic map and the newly generated FT surrogate, the student observes that they are visually very similar and difficult to distinguish from one another.\n\nWhich of the following statements provides the most accurate physical and mathematical explanation for this observation?\n\nA. The logistic map with $r=2.8$ produces a non-chaotic time series that converges to a stable fixed point. The Fourier Transform surrogate, by construction, has the same power spectrum as the original series. As the original dynamics are simple and lack the strong nonlinear phase correlations of chaos, the resulting linear stochastic surrogate series is not easily distinguishable from the original transient decay using visual inspection or linear statistics.\n\nB. For $r=2.8$, the logistic map is in a deeply chaotic regime. The resulting time series is already noise-like, so a surrogate created by randomizing phases will be statistically indistinguishable from the original chaotic noise.\n\nC. The Fourier Transform surrogate method is known to fail for non-stationary data. Since the time series converges to a fixed point, it is non-stationary, and this failure causes the surrogate to be an exact replica of the original series.\n\nD. The power spectrum of the logistic map at $r=2.8$ is completely flat, which is characteristic of white noise. Since the Fourier Transform surrogate is constructed to also have a flat power spectrum, the two time series are indistinguishable.\n\nE. The logistic map time series and its Fourier Transform surrogate are difficult to distinguish because both time series have identical amplitude distributions and identical finite-time Lyapunov exponents.", "solution": "The logistic map is defined by $x_{n+1}=f(x_{n})=r x_{n}\\left(1-x_{n}\\right)$. Fixed points satisfy $x^{*}=f(x^{*})$, giving\n$$\nx^{*}=r x^{*}\\left(1-x^{*}\\right)\\quad\\Longrightarrow\\quad x^{*}\\in\\left\\{0,\\;1-\\frac{1}{r}\\right\\}.\n$$\nFor $r>1$, the nonzero fixed point $x^{*}=1-\\frac{1}{r}$ lies in $(0,1)$. Local stability is determined by $|f'(x^{*})|<1$, where\n$$\nf'(x)=r(1-2x),\\qquad f'(x^{*})=r\\left(1-2\\left(1-\\frac{1}{r}\\right)\\right)=2-r.\n$$\nThe stability condition $|2-r|<1$ yields $1<r<3$. With $r=2.8$, the nonzero fixed point is stable, and the dynamics converge geometrically to $x^{*}$:\n$$\nx_{n+1}-x^{*}\\approx f'(x^{*})(x_{n}-x^{*})=(2-r)(x_{n}-x^{*}),\\quad |2-r|<1,\n$$\nso the time series consists of a transient decay followed by an approximately constant segment, with no chaos.\n\nAn FT surrogate is constructed by preserving the magnitudes of the Discrete Fourier Transform (DFT) coefficients $|X_{k}|$ and randomizing phases $\\phi_{k}$ uniformly on $[0,2\\pi)$ subject to Hermitian symmetry to ensure a real-valued inverse DFT. This guarantees that the surrogate has the same power spectrum\n$$\nS_{k}=|X_{k}|^{2}\n$$\nas the original series. By the Wiener–Khinchin theorem, the autocorrelation function is the inverse Fourier transform of the power spectrum, so the surrogate and the original share identical second-order (linear) temporal statistics.\n\nAt $r=2.8$, the original series is dominated by convergence to a constant $x^{*}$; its spectrum is concentrated at low frequency (especially near zero frequency) with modest contributions from the transient. Because the FT surrogate preserves $S_{k}$, it reproduces the same linear correlation structure and overall smooth, low-frequency character. Randomized phases remove nonlinear phase couplings, but for a signal that is simply decaying to a fixed point (i.e., lacking the strong nonlinear phase correlations characteristic of chaos), these differences are not pronounced under visual inspection or linear statistics.\n\nTherefore:\n- It is false that $r=2.8$ is chaotic.\n- The power spectrum is not flat (not white noise).\n- FT surrogates are not exact replicas, even if the original is non-stationary.\n- Standard FT surrogates do not, in general, preserve the amplitude distribution, nor do they preserve Lyapunov exponents.\n\nThe most accurate explanation is that the original dynamics are non-chaotic and simple (stable fixed point), and the FT surrogate, having identical power spectrum (and thus autocorrelation), looks very similar despite randomized phases.\n\nHence, option A is correct.", "answer": "$$\\boxed{A}$$", "id": "1712286"}, {"introduction": "Ultimately, the goal of any statistical test is to make a sound scientific inference, and a numerical result is only as good as its interpretation. This final practice problem places you in the role of a researcher who has just obtained a borderline result from a surrogate data test designed to detect nonlinearity. You will grapple with the nuances of statistical significance, p-values, and statistical power, learning how to draw careful and responsible conclusions when the data does not provide a clear-cut answer—a common and important scenario in scientific investigation. [@problem_id:1712258]", "problem": "An astrophysicist is analyzing the time series of brightness fluctuations, $x(t)$, from a distant star to determine if the underlying dynamics are purely linear or exhibit nonlinear behavior. The null hypothesis, $H_0$, is that the time series is generated by a stationary, linear, Gaussian stochastic process. The alternative hypothesis, $H_a$, is that the dynamics contain a nonlinear component.\n\nTo test this, the astrophysicist employs a surrogate data test. They choose a test statistic sensitive to time-reversal asymmetry, a common signature of nonlinearity. For the time series of length $N$ with a chosen time lag $\\tau$, the statistic is calculated as $T = \\frac{1}{N-2\\tau} \\sum_{k=\\tau+1}^{N-\\tau} (x_k - x_{k-\\tau})^3$. For a process obeying the null hypothesis, the expected value of $T$ is zero. Many nonlinear processes are expected to yield a non-zero value for $T$.\n\nThe astrophysicist first calculates the statistic for the original data, obtaining $T_{orig}$. Then, they generate $M=199$ surrogate datasets. Each surrogate is generated using a phase-randomization algorithm that precisely preserves the power spectrum and the distribution of values (the histogram) of the original time series, consistent with the properties of $H_0$. They calculate the test statistic $T_i$ for each surrogate series $i=1, \\dots, 199$.\n\nFor a one-sided test, where the specific alternative hypothesis predicts $T > 0$, the value $T_{orig}$ is compared to the distribution of the surrogate values $\\{T_i\\}$. The analysis reveals that $T_{orig}$ is larger than 189 of the surrogate values, but smaller than the other 10 surrogate values.\n\nGiven a standard significance level of $\\alpha = 0.05$, which of the following statements provides the most accurate and complete interpretation of this finding?\n\nA. The null hypothesis is rejected at the $\\alpha = 0.05$ significance level, which provides strong evidence that the stellar dynamics are nonlinear.\n\nB. The null hypothesis is not rejected. This confirms that the underlying stellar dynamics can be fully described by a linear stochastic process.\n\nC. The result is inconclusive. Although the null hypothesis is not formally rejected, the test statistic is on the margin of the significance threshold, suggesting the test might be underpowered and a more definitive conclusion could potentially be reached with a larger number of surrogates.\n\nD. The surrogate generation method must be flawed. If the method were correct and the null hypothesis true, the original statistic $T_{orig}$ should be located near the median of the surrogate distribution.\n\nE. A Type I error (false positive) has likely occurred, as the test statistic is unusually high, but not high enough to formally reject the null hypothesis.", "solution": "Under the null hypothesis $H_0$, the time series is a stationary, linear, Gaussian process. The chosen statistic is\n$$\nT=\\frac{1}{N-2\\tau}\\sum_{k=\\tau+1}^{N-\\tau}(x_{k}-x_{k-\\tau})^{3},\n$$\nwhich has $\\mathbb{E}[T]=0$ when $H_0$ holds. For a one-sided test with alternative $H_a: T > 0$, the empirical $p$-value is computed using surrogate data consistent with $H_0$.\n\nGiven $M=199$ surrogates, let $k$ denote the number of surrogates whose statistic is at least as large as the observed value $T_{orig}$. The recommended unbiased estimate of the one-sided $p$-value is\n$$\np=\\frac{k+1}{M+1}.\n$$\nThe data indicate that $T_{orig}$ is larger than $189$ surrogate values and smaller than $10$ surrogate values. Assuming no ties, the number of surrogates with statistic at least $T_{orig}$ is\n$$\nk=10.\n$$\nTherefore,\n$$\np=\\frac{k+1}{M+1}=\\frac{10+1}{199+1}=\\frac{11}{200}=0.055.\n$$\nWith a significance level $\\alpha=0.05$, we compare $p$ to $\\alpha$ and find $p > \\alpha$. Thus, we do not reject $H_0$ at the $\\alpha=0.05$ level. However, the result is marginal because the discrete resolution of the surrogate test is $\\frac{1}{M+1}=\\frac{1}{200}=0.005$, and the critical boundary for rejection corresponds to $k \\leq 9$. The observed $k=10$ is one count above this boundary, indicating that the test is close to, but does not reach, significance. This does not confirm that the process is linear; rather, it suggests an inconclusive outcome that could potentially be clarified with more surrogates (increasing $M$ reduces the $p$-value resolution).\nThe most accurate and complete interpretation among the options is that the null is not rejected, the result is borderline, and additional surrogates could provide a more definitive conclusion.", "answer": "$$\\boxed{C}$$", "id": "1712258"}]}