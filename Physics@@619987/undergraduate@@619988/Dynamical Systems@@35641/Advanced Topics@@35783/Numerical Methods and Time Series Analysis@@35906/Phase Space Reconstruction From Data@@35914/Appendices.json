{"hands_on_practices": [{"introduction": "Before we can analyze the beautiful and complex geometry of a reconstructed attractor, we must first master the fundamental mechanics of its construction. The method of time-delay embedding builds higher-dimensional state vectors from a simple scalar time series. This powerful technique, however, comes with a practical constraint: the number of valid vectors we can create is always less than the number of points in our original dataset. This first exercise [@problem_id:1699327] walks you through the essential calculation of determining the exact size of your reconstructed dataset based on the embedding dimension $m$ and the time delay $\\tau$, a critical first step for any real-world analysis.", "problem": "An experimental physicist is analyzing the dynamics of a weakly turbulent fluid flow by tracking the position of a single tracer particle. The particle's one-dimensional position, $p(t)$, is recorded at discrete, uniform time intervals, generating a scalar time series consisting of $N = 1000$ data points, which we can denote as $\\{p_1, p_2, \\dots, p_N\\}$.\n\nTo reconstruct the system's attractor and study its underlying geometric structure, the physicist employs the method of time-delay embedding. This technique constructs a set of state vectors, $\\mathbf{V}_i$, in a higher-dimensional space. Each vector is formed using values from the original time series according to the rule:\n$$\n\\mathbf{V}_i = (p_i, p_{i+\\tau}, p_{i+2\\tau}, \\dots, p_{i+(m-1)\\tau})\n$$\nA vector $\\mathbf{V}_i$ is only considered a valid point in the reconstructed phase space if all of its components are actual data points from the original time series. For this analysis, an embedding dimension of $m=5$ and a time delay of $\\tau=10$ steps are chosen.\n\nCalculate the total number of valid state vectors $\\mathbf{V}_i$ that can be constructed from the given time series.", "solution": "The problem asks for the total number of valid state vectors that can be constructed using the method of time-delay embedding.\n\nThe original time series is given by $\\{p_1, p_2, \\dots, p_N\\}$, where the total number of points is $N=1000$. The indices of the data points range from $1$ to $N$.\n\nEach state vector in the reconstructed phase space is of the form:\n$$\n\\mathbf{V}_i = (p_i, p_{i+\\tau}, p_{i+2\\tau}, \\dots, p_{i+(m-1)\\tau})\n$$\nwhere $m$ is the embedding dimension and $\\tau$ is the time delay. The given values are $m=5$ and $\\tau=10$.\n\nA vector $\\mathbf{V}_i$ is valid if and only if every one of its components corresponds to an existing data point in the original time series. This means the index of each component must be between $1$ and $N$. Let's examine the indices of the components of $\\mathbf{V}_i$:\nThe first component is $p_i$, with index $i$.\nThe second component is $p_{i+\\tau}$, with index $i+\\tau$.\n...\nThe last component is $p_{i+(m-1)\\tau}$, with index $i+(m-1)\\tau$.\n\nFor the vector $\\mathbf{V}_i$ to be valid, all these indices must be less than or equal to $N$. Since the indices are increasing, we only need to ensure that the largest index is no greater than $N$. The largest index corresponds to the last component of the vector.\nTherefore, the condition for a valid vector is:\n$$\ni + (m-1)\\tau \\le N\n$$\n\nThe starting index $i$ of the vector must be at least $1$. So, the range of possible values for the starting index $i$ is from $1$ up to some maximum value, $i_{max}$. To find $i_{max}$, we solve the inequality for $i$:\n$$\ni \\le N - (m-1)\\tau\n$$\nSince $i$ must be an integer, the maximum value for $i$ is $i_{max} = N - (m-1)\\tau$.\n\nThe total number of valid vectors is the number of possible integer values for the starting index $i$. Since $i$ can range from $1$ to $i_{max}$, the total count of valid vectors is:\n$$\n\\text{Total Vectors} = i_{max} - 1 + 1 = i_{max} = N - (m-1)\\tau\n$$\n\nNow, we substitute the given numerical values:\n$N = 1000$\n$m = 5$\n$\\tau = 10$\n\n$$\n\\text{Total Vectors} = 1000 - (5-1) \\times 10\n$$\n$$\n\\text{Total Vectors} = 1000 - (4) \\times 10\n$$\n$$\n\\text{Total Vectors} = 1000 - 40\n$$\n$$\n\\text{Total Vectors} = 960\n$$\n\nThus, 960 valid state vectors can be constructed from the time series.", "answer": "$$\\boxed{960}$$", "id": "1699327"}, {"introduction": "The success of phase space reconstruction hinges on the careful selection of its parameters, especially the time delay $\\tau$. A well-chosen $\\tau$ can elegantly unfold a tangled time series into a clear geometric object that reflects the system's underlying dynamics. Conversely, a poor choice can obscure the very structure we hope to find. This practice [@problem_id:1699289] uses the simple, intuitive case of a harmonic oscillator to explore how the choice of $\\tau$ transforms the reconstructed portrait, helping you build a strong intuition for what makes a \"good\" delay.", "problem": "A common technique in the analysis of time series data from dynamical systems is time-delay embedding. For a given time series $x(t)$, a two-dimensional trajectory is constructed by plotting points $(v_1, v_2) = (x(t), x(t-\\tau))$ for a chosen time delay $\\tau$. The shape of the resulting curve in the $v_1$-$v_2$ plane reveals properties of the underlying dynamics.\n\nConsider four different systems, each producing a time series $x(t)$, where $T$ is the fundamental period of the oscillation for the sinusoidal components. For which of the following systems will the time-delay embedding procedure, with the specified time delay $\\tau$, produce a perfect circle centered at the origin?\n\nA. A simple harmonic oscillator with $x(t) = A\\sin(\\omega t)$ and time delay $\\tau = T/8$, where $T = 2\\pi/\\omega$.\n\nB. A damped harmonic oscillator with $x(t) = A\\exp(-\\gamma t)\\cos(\\omega t)$ (for some constant $\\gamma > 0$) and time delay $\\tau = T/4$, where $T = 2\\pi/\\omega$.\n\nC. A system with two frequency components with $x(t) = A\\sin(\\omega t) + B\\sin(2\\omega t)$ and time delay $\\tau = T/4$, where $T = 2\\pi/\\omega$.\n\nD. An undamped harmonic oscillator with $x(t) = A\\cos(\\omega t)$ and time delay $\\tau = T/4$, where $T = 2\\pi/\\omega$.", "solution": "We consider the time-delay embedding $(v_{1},v_{2})=(x(t),x(t-\\tau))$ and determine when the locus is a perfect circle centered at the origin. For sinusoidal signals of a single frequency and constant amplitude, a necessary and sufficient condition for a circle is that the two coordinates are equal-amplitude quadrature components, i.e., they differ in phase by $\\pm \\pi/2$ (modulo $\\pi$), so that $v_{1}^{2}+v_{2}^{2}$ is constant.\n\nA. Let $x(t)=A\\sin(\\omega t)$ and $\\tau=T/8$, with $T=2\\pi/\\omega$. Define $\\theta=\\omega t$ and $\\phi=\\omega\\tau=\\omega(T/8)=\\pi/4$. Then\n$$\nv_{1}=A\\sin\\theta,\\quad v_{2}=A\\sin(\\theta-\\phi)=A(\\sin\\theta\\cos\\phi-\\cos\\theta\\sin\\phi).\n$$\nLet $u=v_{1}/A=\\sin\\theta$ and $v=v_{2}/A$. Eliminating $\\theta$ via $\\sin^{2}\\theta+\\cos^{2}\\theta=1$:\n$$\nv=u\\cos\\phi-\\cos\\theta\\sin\\phi\\quad\\Rightarrow\\quad \\cos\\theta=\\frac{u\\cos\\phi-v}{\\sin\\phi},\n$$\nso\n$$\nu^{2}+\\left(\\frac{u\\cos\\phi-v}{\\sin\\phi}\\right)^{2}=1.\n$$\nThis is the equation of an ellipse for $0<\\phi<\\pi$, becoming a circle only if $\\cos\\phi=0$. Here $\\phi=\\pi/4$ gives $\\cos\\phi\\neq 0$, so the curve is not a circle.\n\nB. Let $x(t)=A\\exp(-\\gamma t)\\cos(\\omega t)$ with $\\gamma>0$ and $\\tau=T/4$, so $\\phi=\\omega\\tau=\\pi/2$. With $\\theta=\\omega t$,\n$$\nv_{1}=A\\exp(-\\gamma t)\\cos\\theta,\\quad v_{2}=A\\exp[-\\gamma(t-\\tau)]\\cos(\\theta-\\phi)=A\\exp(-\\gamma t)\\exp(\\gamma\\tau)\\sin\\theta.\n$$\nThen\n$$\nv_{1}^{2}+\\left(\\frac{v_{2}}{\\exp(\\gamma\\tau)}\\right)^{2}=A^{2}\\exp(-2\\gamma t)\\big(\\cos^{2}\\theta+\\sin^{2}\\theta\\big)=A^{2}\\exp(-2\\gamma t),\n$$\nwhich depends on $t$. The locus is not a single circle (it traces a shrinking spiral/elliptical family), so it is not a perfect circle.\n\nC. Let $x(t)=A\\sin(\\omega t)+B\\sin(2\\omega t)$ and $\\tau=T/4$, so $\\phi=\\omega\\tau=\\pi/2$. With $\\theta=\\omega t$,\n$$\nv_{1}=A\\sin\\theta+B\\sin(2\\theta),\\quad v_{2}=A\\sin(\\theta-\\phi)+B\\sin(2\\theta-2\\phi)=-A\\cos\\theta-B\\sin(2\\theta).\n$$\nCompute\n$$\nv_{1}^{2}+v_{2}^{2}=A^{2}(\\sin^{2}\\theta+\\cos^{2}\\theta)+2B^{2}\\sin^{2}(2\\theta)+2AB\\sin(2\\theta)(\\sin\\theta+\\cos\\theta),\n$$\nwhich depends on $\\theta$ unless $B=0$. Therefore, for $B\\neq 0$ the curve is not a circle.\n\nD. Let $x(t)=A\\cos(\\omega t)$ and $\\tau=T/4$, so $\\phi=\\omega\\tau=\\pi/2$ and $\\theta=\\omega t$. Then\n$$\nv_{1}=A\\cos\\theta,\\quad v_{2}=A\\cos(\\theta-\\phi)=A\\sin\\theta,\n$$\nhence\n$$\nv_{1}^{2}+v_{2}^{2}=A^{2}(\\cos^{2}\\theta+\\sin^{2}\\theta)=A^{2},\n$$\na constant. The locus is the circle of radius $A$ centered at the origin.\n\nTherefore, only option D produces a perfect circle centered at the origin under the stated time-delay embedding.", "answer": "$$\\boxed{D}$$", "id": "1699289"}, {"introduction": "We now move from qualitative intuition to quantitative analysis to understand one of the most common pitfalls in phase space reconstruction: choosing a time delay $\\tau$ that is too small. When $\\tau$ is close to zero, the coordinates of our reconstructed vectors, such as $x(t)$ and $x(t+\\tau)$, are nearly identical, providing redundant information. This practice [@problem_id:1699326] demonstrates how to use the covariance matrix and its eigenvalues as a powerful tool to measure this redundancy, providing a rigorous mathematical explanation for why the reconstructed attractor appears to collapse onto a featureless line.", "problem": "An experimentalist records a scalar time series, $x(t)$, from a complex chaotic system. To analyze its dynamics, the method of time-delay embedding is employed to reconstruct a state space. A two-dimensional state vector $\\vec{v}(t)$ is constructed from the time series using a time delay $\\tau$, such that $\\vec{v}(t) = (x(t), x(t+\\tau))$. For very small values of the time delay $\\tau$, it is observed that the set of reconstructed points, when plotted in the $(x(t), x(t+\\tau))$ plane, appears to collapse onto a thin line.\n\nTo quantify this observation, we treat the collection of points $\\{\\vec{v}(t)\\}$ as a statistical distribution and analyze its covariance matrix. The shape and orientation of the data cloud are described by the eigenvalues and eigenvectors of this matrix.\n\nAssume that the time series $x(t)$ is a stationary process with a mean of zero and a variance of $\\sigma_x^2$. Its time derivative, $\\dot{x}(t)$, also has a mean of zero and a variance of $\\sigma_{\\dot{x}}^2$. Furthermore, assume that $x(t)$ and its derivative $\\dot{x}(t)$ are statistically uncorrelated.\n\nFor a small time delay $\\tau$, you can use the first-order Taylor approximation $x(t+\\tau) \\approx x(t) + \\dot{x}(t)\\tau$. The eigenvalues of the covariance matrix of the data cloud $\\{\\vec{v}(t)\\}$ represent the variance of the data along its principal axes.\n\nCalculate the ratio of the smaller eigenvalue to the larger eigenvalue of the covariance matrix. Express your answer as an analytic function of $\\tau$, $\\sigma_x$, and $\\sigma_{\\dot{x}}$. In your derivation, you may neglect any terms of order $\\tau^3$ or higher.", "solution": "We construct the two-dimensional vector using the first-order Taylor approximation for small $\\tau$:\n$$\n\\vec{v}(t)=\\begin{pmatrix}x(t)\\\\ x(t+\\tau)\\end{pmatrix}\\approx\\begin{pmatrix}x\\\\ x+\\tau\\dot{x}\\end{pmatrix}.\n$$\nGiven stationarity and zero mean, the covariance matrix $\\Sigma$ of $\\vec{v}(t)$ is $\\Sigma=\\mathbb{E}[\\vec{v}\\,\\vec{v}^{\\top}]$. Using $\\mathbb{E}[x]=\\mathbb{E}[\\dot{x}]=0$, $\\operatorname{Var}(x)=\\sigma_{x}^{2}$, $\\operatorname{Var}(\\dot{x})=\\sigma_{\\dot{x}}^{2}$, and $\\operatorname{Cov}(x,\\dot{x})=0$, its entries are:\n$$\n\\Sigma_{11}=\\mathbb{E}[x^{2}]=\\sigma_{x}^{2},\n$$\n$$\n\\Sigma_{12}=\\mathbb{E}[x(x+\\tau\\dot{x})]=\\mathbb{E}[x^{2}]+\\tau\\,\\mathbb{E}[x\\dot{x}]=\\sigma_{x}^{2},\n$$\n$$\n\\Sigma_{22}=\\mathbb{E}[(x+\\tau\\dot{x})^{2}]=\\mathbb{E}[x^{2}]+2\\tau\\,\\mathbb{E}[x\\dot{x}]+\\tau^{2}\\mathbb{E}[\\dot{x}^{2}]=\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}.\n$$\nThus,\n$$\n\\Sigma=\\begin{pmatrix}\n\\sigma_{x}^{2} & \\sigma_{x}^{2} \\\\\n\\sigma_{x}^{2} & \\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}\n\\end{pmatrix}.\n$$\nFor a symmetric $2\\times 2$ matrix $\\begin{pmatrix}a & b\\\\ b & c\\end{pmatrix}$, the eigenvalues are\n$$\n\\lambda_{\\pm}=\\frac{(a+c)\\pm\\sqrt{(a-c)^{2}+4b^{2}}}{2}.\n$$\nWith $a=\\sigma_{x}^{2}$, $b=\\sigma_{x}^{2}$, $c=\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}$, we have\n$$\n\\operatorname{tr}\\Sigma=2\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2},\\qquad \\det\\Sigma=\\sigma_{x}^{2}\\tau^{2}\\sigma_{\\dot{x}}^{2},\n$$\nand\n$$\n\\lambda_{\\pm}=\\frac{2\\sigma_{x}^{2}+\\tau^{2}\\sigma_{\\dot{x}}^{2}\\pm\\sqrt{4\\sigma_{x}^{4}+\\tau^{4}\\sigma_{\\dot{x}}^{4}}}{2}.\n$$\nFor small $\\tau$, expand the square root to the order permitted. Since\n$$\n\\sqrt{4\\sigma_{x}^{4}+\\tau^{4}\\sigma_{\\dot{x}}^{4}}=2\\sigma_{x}^{2}\\sqrt{1+\\frac{\\tau^{4}\\sigma_{\\dot{x}}^{4}}{4\\sigma_{x}^{4}}}=2\\sigma_{x}^{2}+O(\\tau^{4}),\n$$\nand terms of order $\\tau^{3}$ or higher may be neglected, we obtain\n$$\n\\lambda_{+}=2\\sigma_{x}^{2}+\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}+O(\\tau^{4}),\\qquad\n\\lambda_{-}=\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}+O(\\tau^{4}).\n$$\nTherefore, the ratio of the smaller to the larger eigenvalue, keeping terms up to order $\\tau^{2}$ and neglecting $\\tau^{3}$ and higher, is\n$$\n\\frac{\\lambda_{-}}{\\lambda_{+}}=\\frac{\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}}{2\\sigma_{x}^{2}+\\frac{1}{2}\\tau^{2}\\sigma_{\\dot{x}}^{2}}=\\frac{\\tau^{2}\\sigma_{\\dot{x}}^{2}}{4\\sigma_{x}^{2}}\\left[1+O(\\tau^{2})\\right].\n$$\nDiscarding terms of order $\\tau^{3}$ or higher yields the final expression:\n$$\n\\frac{\\lambda_{\\min}}{\\lambda_{\\max}}=\\frac{\\tau^{2}\\sigma_{\\dot{x}}^{2}}{4\\sigma_{x}^{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\tau^{2}\\sigma_{\\dot{x}}^{2}}{4\\sigma_{x}^{2}}}$$", "id": "1699326"}]}