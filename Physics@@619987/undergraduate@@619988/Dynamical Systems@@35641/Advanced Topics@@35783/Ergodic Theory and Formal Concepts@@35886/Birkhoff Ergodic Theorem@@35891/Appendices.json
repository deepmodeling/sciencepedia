{"hands_on_practices": [{"introduction": "We begin our exploration with a foundational and intuitive example. This practice considers a simple dynamical system where states evolve in a predictable, finite cycle [@problem_id:1447062]. By directly calculating the long-term time average for an observable in this system, you will build a concrete understanding of how time averages are computed and see firsthand how they converge to a single value, independent of the starting state. This serves as a tangible entry point to the core idea of the Birkhoff Ergodic Theorem.", "problem": "Consider a system with a finite number of states, labeled by the integers in the set $X = \\{1, 2, \\dots, N\\}$ for some integer $N \\ge 2$. The system evolves in discrete time steps. If the system is in state $k$ at time $t$, it transitions to a new state at time $t+1$ according to the transformation rule $T: X \\to X$, defined as $T(k) = (k \\pmod N) + 1$.\n\nAn observable quantity, denoted by $f$, is measured at each state. The value of this observable when the system is in state $k$ is given by the function $f(k) = k$.\n\nFor any initial state $k_0 \\in X$, we can define the time average of the observable $f$ along the trajectory starting from $k_0$. If the sequence of states visited is $k_0, k_1, k_2, \\dots$, where $k_{m+1} = T(k_m)$, the time average is given by the limit:\n$$\n\\hat{f}(k_0) = \\lim_{M \\to \\infty} \\frac{1}{M}\\sum_{m=0}^{M-1} f(k_m)\n$$\nIt can be shown that this limit exists and is independent of the starting state $k_0$. Calculate this time average. Your answer should be a closed-form analytic expression in terms of $N$.", "solution": "The map $T(k)=(k \\bmod N)+1$ generates a cycle through all states in $X=\\{1,2,\\dots,N\\}$. For any initial $k_{0}\\in X$, define the trajectory by $k_{m+1}=T(k_{m})$. By induction one obtains the explicit form\n$$\nk_{m}=\\bigl((k_{0}+m-1)\\bmod N\\bigr)+1,\n$$\nso the sequence $\\{k_{m}\\}_{m=0}^{N-1}$ is a permutation of $\\{1,2,\\dots,N\\}$ and $k_{m+N}=k_{m}$ for all $m$, i.e., the orbit is periodic with period $N$.\n\nLet $S_{N}=\\sum_{j=1}^{N}j$. Because each block of $N$ consecutive steps visits every state exactly once, for any integer $\\ell\\ge 0$,\n$$\n\\sum_{m=\\ell N}^{\\ell N+N-1} f(k_{m})=\\sum_{m=\\ell N}^{\\ell N+N-1} k_{m}=S_{N}.\n$$\nFor an arbitrary $M$, write $M=qN+r$ with integers $q\\ge 0$ and $0\\le r<N$. Then\n$$\n\\sum_{m=0}^{M-1} f(k_{m})=\\sum_{m=0}^{qN-1} f(k_{m})+\\sum_{m=qN}^{qN+r-1} f(k_{m})=qS_{N}+R_{r},\n$$\nwhere $R_{r}=\\sum_{m=qN}^{qN+r-1} f(k_{m})$ satisfies $0\\le R_{r}\\le rN$. Hence the time average satisfies\n$$\n\\frac{1}{M}\\sum_{m=0}^{M-1} f(k_{m})=\\frac{qS_{N}+R_{r}}{qN+r}.\n$$\nTaking $M\\to\\infty$ forces $q\\to\\infty$ while $0\\le r<N$ remains bounded, so $R_{r}/(qN+r)\\to 0$ and\n$$\n\\hat{f}(k_{0})=\\lim_{M\\to\\infty}\\frac{1}{M}\\sum_{m=0}^{M-1} f(k_{m})=\\frac{S_{N}}{N}.\n$$\nEvaluating $S_{N}$ gives\n$$\nS_{N}=\\sum_{j=1}^{N} j=\\frac{N(N+1)}{2},\n$$\nso the time average, independent of $k_{0}$, is\n$$\n\\hat{f}(k_{0})=\\frac{1}{N}\\cdot \\frac{N(N+1)}{2}=\\frac{N+1}{2}.\n$$", "answer": "$$\\boxed{\\frac{N+1}{2}}$$", "id": "1447062"}, {"introduction": "Having seen how averages behave in a simple ergodic system, we now investigate what happens when the ergodicity condition is not met. This exercise presents a system that is decomposable into separate, non-communicating orbits [@problem_id:1447100]. Calculating the time averages here reveals a crucial insight: the limit now depends on the initial state, converging to different values on different invariant components of the space. This highlights why ergodicity is a fundamental hypothesis for the time average to be a global constant.", "problem": "Let $X = \\{1, 2, 3, 4, 5\\}$ be a discrete space. Consider a transformation $T: X \\to X$ defined by the permutation $T(1)=2$, $T(2)=3$, $T(3)=1$, $T(4)=5$, and $T(5)=4$. Let $f: X \\to \\mathbb{R}$ be a function defined by $f(k) = k^2$.\n\nThe long-term time average of the function $f$ starting from a point $k \\in X$ is defined by the limit:\n$$ \\bar{f}(k) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} f(T^n k) $$\nwhere $T^n k$ denotes applying the transformation $T$ for $n$ times, with $T^0 k = k$.\n\nYour task is to compute the function $\\bar{f}: X \\to \\mathbb{R}$. Which of the following options correctly specifies the function $\\bar{f}$?\n\nA. $\\bar{f}(k) = 11$ for all $k \\in X$.\n\nB. $\\bar{f}(k) = 2$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = 4.5$ for $k \\in \\{4,5\\}$.\n\nC. $\\bar{f}(k) = \\frac{14}{3}$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = \\frac{41}{2}$ for $k \\in \\{4,5\\}$.\n\nD. $\\bar{f}(k) = \\frac{41}{2}$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = \\frac{14}{3}$ for $k \\in \\{4,5\\}$.\n\nE. $\\bar{f}(k) = \\frac{14}{5}$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = \\frac{41}{5}$ for $k \\in \\{4,5\\}$.", "solution": "Because $X$ is finite and $T$ is a permutation, every point $k \\in X$ lies on a periodic orbit. If the period of $k$ is $m \\in \\mathbb{N}$, then $T^{m}k=k$ and the sequence $\\{f(T^{n}k)\\}_{n \\geq 0}$ is periodic with period $m$. For $N=qm+r$ with $q \\in \\mathbb{N}$ and $0 \\leq r < m$, we have\n$$\n\\sum_{n=0}^{N-1} f(T^{n}k)=q \\sum_{n=0}^{m-1} f(T^{n}k)+\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\nDividing by $N$ gives\n$$\n\\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k) = \\frac{q}{N} \\sum_{n=0}^{m-1} f(T^{n}k) + \\frac{1}{N}\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\nAs $N \\to \\infty$, we have $\\frac{q}{N} \\to \\frac{1}{m}$ and the remainder term tends to $0$ since $f$ is bounded on the finite set $X$. Therefore,\n$$\n\\bar{f}(k)=\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k)=\\frac{1}{m}\\sum_{n=0}^{m-1} f(T^{n}k),\n$$\nthe average of $f$ over one period of the orbit through $k$.\n\nThe permutation $T$ has two disjoint cycles: $(1\\,2\\,3)$ of length $3$ and $(4\\,5)$ of length $2$. Hence, for $k \\in \\{1,2,3\\}$,\n$$\n\\bar{f}(k)=\\frac{1}{3}\\big(f(1)+f(2)+f(3)\\big)=\\frac{1}{3}\\big(1^{2}+2^{2}+3^{2}\\big)=\\frac{1+4+9}{3}=\\frac{14}{3},\n$$\nand for $k \\in \\{4,5\\}$,\n$$\n\\bar{f}(k)=\\frac{1}{2}\\big(f(4)+f(5)\\big)=\\frac{1}{2}\\big(4^{2}+5^{2}\\big)=\\frac{16+25}{2}=\\frac{41}{2}.\n$$\nComparing with the options, this matches option C.", "answer": "$$\\boxed{C}$$", "id": "1447100"}, {"introduction": "We now transition from discrete systems to the more complex world of continuous and chaotic dynamics using the classic \"doubling map\" on an interval [@problem_id:1447114]. For such a system, direct calculation of the time average is intractable. This is where the Birkhoff Ergodic Theorem demonstrates its true power, enabling us to find the time average by computing a much simpler space average—an integral. This problem illuminates the theorem's utility in analyzing chaotic behavior and introduces the essential concept of convergence for \"almost every\" initial state.", "problem": "Consider a deterministic dynamical system whose state, a number $x \\in [0,1)$, evolves in discrete time steps. The evolution of the state from time $k$ to time $k+1$ is governed by the map $T: [0,1) \\to [0,1)$, defined as $T(x) = 2x \\pmod{1}$. This is the fractional part of $2x$.\n\nFor any given initial state $x_0 = x$, the trajectory of the system is the sequence $x_0, x_1, x_2, \\ldots$, where $x_{k+1} = T(x_k)$. Let's study a particular observable of this system, which is simply the value of the state itself, given by the function $f(x) = x$. The long-term time average of this observable is defined by the limit:\n$$\nA(x) = \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} f(T^k(x))\n$$\nIt is a known result from ergodic theory that for this specific system, the limit $A(x)$ exists and converges to the same constant value for almost every initial state $x \\in [0,1)$ with respect to the standard Lebesgue measure.\n\nYour task is to determine this constant value.", "solution": "We are given the dynamical system on $[0,1)$ with the doubling map $T(x)=2x \\pmod{1}$ and the observable $f(x)=x$. For $x \\in [0,1)$, the time average is\n$$\nA(x)=\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} f(T^{k}(x))=\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} T^{k}(x).\n$$\nWe use Birkhoff’s ergodic theorem: if $(X,\\mathcal{B},\\mu,T)$ is measure-preserving and ergodic and $f \\in L^{1}(\\mu)$, then for $\\mu$-almost every $x \\in X$,\n$$\n\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} f(T^{k}(x))=\\int_{X} f \\,\\mathrm{d}\\mu.\n$$\nThus, to determine $A(x)$ for almost every $x$, it suffices to identify an invariant ergodic probability measure and compute the space average of $f$ with respect to it.\n\nFirst, Lebesgue measure $m$ on $[0,1)$ is invariant for $T$. To see this, note that for any interval $I \\subset [0,1)$,\n$$\nT^{-1}(I)=\\left\\{x \\in [0,1): 2x \\pmod{1} \\in I \\right\\}=\\frac{I}{2} \\cup \\frac{I+1}{2},\n$$\nwhere $\\frac{I}{2}=\\{x: 2x \\in I\\}$ and $\\frac{I+1}{2}=\\{x: 2x-1 \\in I\\}$. The lengths satisfy $m\\!\\left(\\frac{I}{2}\\right)=\\frac{1}{2}m(I)$ and $m\\!\\left(\\frac{I+1}{2}\\right)=\\frac{1}{2}m(I)$, hence $m(T^{-1}(I))=m(I)$. By standard extension from intervals to the Borel $\\sigma$-algebra, $m$ is $T$-invariant.\n\nSecond, $T$ is ergodic with respect to $m$. This follows from the binary expansion representation: for $x=\\sum_{j=1}^{\\infty} b_{j} 2^{-j}$ (excluding the measure-zero set of dyadic rationals with two expansions), $T$ shifts the sequence $(b_{j})$ to the left by one place, which is the Bernoulli shift on $\\{0,1\\}^{\\mathbb{N}}$ with the product measure assigning equal weights to $0$ and $1$. The Bernoulli shift is ergodic, hence $T$ is ergodic with respect to $m$.\n\nBy Birkhoff’s theorem applied with $\\mu=m$ and $f(x)=x \\in L^{1}(m)$, for $m$-almost every $x$,\n$$\nA(x)=\\int_{0}^{1} x \\,\\mathrm{d}x.\n$$\nCompute the integral:\n$$\n\\int_{0}^{1} x \\,\\mathrm{d}x=\\left[\\frac{x^{2}}{2}\\right]_{0}^{1}=\\frac{1}{2}.\n$$\nTherefore, for almost every initial state $x \\in [0,1)$, the long-term time average $A(x)$ equals $\\frac{1}{2}$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1447114"}]}