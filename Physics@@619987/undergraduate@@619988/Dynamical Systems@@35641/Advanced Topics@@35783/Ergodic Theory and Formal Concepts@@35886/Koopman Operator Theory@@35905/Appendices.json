{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will start with the most fundamental concept: applying the Koopman operator to an observable function. This first exercise [@problem_id:1689046] uses a simple one-dimensional linear system to demonstrate how certain functions, called eigenfunctions, transform in a particularly simple way under the system's dynamics. By calculating how the operator acts on a monomial observable, you will directly compute a Koopman eigenvalue and see the core principle of this theory in action.", "problem": "Consider a simplified one-dimensional discrete-time dynamical system whose state $z_k$ at time step $k$ evolves according to the linear map $z_{k+1} = f(z_k) = \\alpha z_k$, where $\\alpha$ is a non-zero real constant.\n\nIn the study of this system using the Koopman operator framework, we analyze the evolution of observables, which are functions of the state. Let's consider a family of monomial observables given by $g_n(z) = z^n$ for any positive integer $n$.\n\nThe Koopman operator, denoted by $K$, describes the evolution of any observable $g$ by mapping it to a new function $Kg$ defined as $(Kg)(z) = g(f(z))$. It has been observed that for this specific system and the family of monomial observables $g_n$, the action of the Koopman operator is particularly simple. Applying the operator to $g_n$ yields a function that is merely a scaled version of the original observable, such that $(Kg_n)(z) = \\mu_n g_n(z)$, where $\\mu_n$ is a scaling factor that depends on $\\alpha$ and $n$.\n\nDetermine the expression for this scaling factor $\\mu_n$ in terms of $\\alpha$ and $n$.", "solution": "The Koopman operator acts by composition with the dynamics. By definition, for any observable $g$,\n$$(Kg)(z) = g(f(z)).$$\nFor the monomial observable $g_{n}(z) = z^{n}$ and the linear map $f(z) = \\alpha z$, we compute\n$$(Kg_{n})(z) = g_{n}(f(z)) = \\left(f(z)\\right)^{n}.$$\nSubstituting $f(z) = \\alpha z$ gives\n$$\\left(f(z)\\right)^{n} = (\\alpha z)^{n}.$$\nUsing the exponent rule for products yields\n$$(\\alpha z)^{n} = \\alpha^{n} z^{n} = \\alpha^{n} g_{n}(z).$$\nThus $(Kg_{n})(z) = \\mu_{n} g_{n}(z)$ with\n$$\\mu_{n} = \\alpha^{n}.$$", "answer": "$$\\boxed{\\alpha^{n}}$$", "id": "1689046"}, {"introduction": "Having seen how the Koopman operator works for discrete time steps, we now extend our analysis to continuous-time systems described by differential equations. This practice problem [@problem_id:1689034] introduces the infinitesimal generator, which captures the instantaneous rate of change of an observable along the system's flow. You will determine this generator for a simple decay process, revealing the direct and elegant relationship between the generator and the system's underlying vector field.", "problem": "In the study of dynamical systems, the Koopman operator provides a powerful linear perspective on nonlinear dynamics. Consider a one-dimensional continuous-time dynamical system described by the differential equation $\\frac{dx}{dt} = F(x)$, where $x(t)$ is the state of the system at time $t$. The flow map, denoted by $\\phi_t(x_0)$, gives the state of the system at time $t$ starting from the initial condition $x(0) = x_0$.\n\nThe Koopman operator, $U^t$, acts on a function $g(x)$, called an observable, and is defined by its action on the function at a point $x_0$:\n$$(U^t g)(x_0) = g(\\phi_t(x_0))$$\n\nThe infinitesimal generator of the Koopman operator, denoted by $\\mathcal{L}$, describes the instantaneous rate of change of the observable along the system's trajectories. It is defined as the time derivative of the operator at $t=0$:\n$$\\mathcal{L}g = \\lim_{t \\to 0} \\frac{U^t g - g}{t}$$\n\nConsider the specific one-dimensional dynamical system representing exponential decay:\n$$\\frac{dx}{dt} = -\\gamma x$$\nwhere $\\gamma$ is a positive real constant.\n\nYour task is to determine the explicit form of the infinitesimal generator $\\mathcal{L}$ acting on a general differentiable function $g(x)$. Express your answer for $\\mathcal{L}g(x)$ in terms of $x$, $\\gamma$, the function $g(x)$, and its derivative $g'(x) = \\frac{dg}{dx}$.", "solution": "We begin with the definitions. For a one-dimensional system $\\frac{dx}{dt}=F(x)$ with flow $\\phi_{t}(x)$, the Koopman operator acts as $(U^{t}g)(x)=g(\\phi_{t}(x))$. The infinitesimal generator is\n$$\n(\\mathcal{L}g)(x)=\\lim_{t\\to 0}\\frac{(U^{t}g)(x)-g(x)}{t}=\\lim_{t\\to 0}\\frac{g(\\phi_{t}(x))-g(x)}{t}.\n$$\nFor the specific system $\\frac{dx}{dt}=-\\gamma x$, we solve the ODE by separation of variables:\n$$\n\\frac{dx}{x}=-\\gamma\\,dt \\quad \\Rightarrow \\quad \\ln|x|=-\\gamma t + C \\quad \\Rightarrow \\quad x(t)=C_{1}\\exp(-\\gamma t).\n$$\nImposing $x(0)=x$ gives $C_{1}=x$, hence the flow is\n$$\n\\phi_{t}(x)=x\\,\\exp(-\\gamma t).\n$$\nTherefore,\n$$\n(\\mathcal{L}g)(x)=\\lim_{t\\to 0}\\frac{g\\!\\left(x\\,\\exp(-\\gamma t)\\right)-g(x)}{t}.\n$$\nUsing the first-order Taylor expansion of $g$ about $x$,\n$$\ng\\!\\left(x\\,\\exp(-\\gamma t)\\right)=g(x)+g'(x)\\left(x\\,\\exp(-\\gamma t)-x\\right)+o\\!\\left(\\left|x\\left(\\exp(-\\gamma t)-1\\right)\\right|\\right),\n$$\nand the expansion $\\exp(-\\gamma t)-1=-\\gamma t+o(t)$ as $t\\to 0$, we obtain\n$$\ng\\!\\left(x\\,\\exp(-\\gamma t)\\right)-g(x)=g'(x)\\,x\\left(-\\gamma t+o(t)\\right)+o(t)= -\\gamma x g'(x)\\,t+o(t).\n$$\nDividing by $t$ and letting $t\\to 0$ yields\n$$\n(\\mathcal{L}g)(x)=-\\gamma x\\,g'(x).\n$$\nEquivalently, using the chain rule,\n$$\n(\\mathcal{L}g)(x)=\\left.\\frac{d}{dt}g(\\phi_{t}(x))\\right|_{t=0}=g'(x)\\left.\\frac{d\\phi_{t}(x)}{dt}\\right|_{t=0}=g'(x)F(x)=-\\gamma x\\,g'(x).\n$$\nThus the infinitesimal generator acts by multiplication with the vector field and differentiation of the observable.", "answer": "$$\\boxed{-\\gamma x\\,g'(x)}$$", "id": "1689034"}, {"introduction": "The power of the Koopman operator framework truly shines when applied to nonlinear systems, but it also introduces new challenges. While the operator is always linear, its action on simple functions can be complex, as this exercise [@problem_id:1688996] demonstrates using the classic logistic map. By applying the operator to a simple quadratic observable, you will discover that the result is a higher-degree polynomial, revealing that the space of polynomials of a fixed degree is not a \"Koopman-invariant subspace,\" a fundamental insight into the infinite-dimensional nature of the operator for nonlinear dynamics.", "problem": "The Koopman operator provides a linear perspective on nonlinear dynamical systems by describing the evolution of observable functions on the system's state space. Consider the discrete-time dynamical system described by the logistic map, where the state $x_k$ at time step $k$ evolves according to the rule:\n$$x_{k+1} = f(x_k) = r x_k(1-x_k)$$\nHere, $x_k \\in \\mathbb{R}$ is the state, and $r$ is a real-valued parameter.\n\nThe action of the Koopman operator, $\\mathcal{K}$, on an observable function $g(x)$ is defined by the composition $(\\mathcal{K}g)(x_k) = g(f(x_k))$. This means applying the operator to a function $g$ yields a new function whose value at state $x_k$ is the value of $g$ at the next state, $x_{k+1}$.\n\nLet us investigate the properties of this operator on the vector space of polynomials. Consider the specific observable function $g(x) = x^2$. Evaluate the action of the Koopman operator on this observable, $(\\mathcal{K}g)(x_k)$, and express the result as a polynomial in the variable $x_k$.\n\nDetermine the coefficient of the $x_k^3$ term in the resulting polynomial expression for $(\\mathcal{K}g)(x_k)$. Your answer should be a symbolic expression in terms of the parameter $r$.", "solution": "We are given the discrete-time logistic map defined by $x_{k+1} = f(x_k) = r x_k(1 - x_k)$, and the Koopman operator $\\mathcal{K}$ acting on an observable $g$ by $(\\mathcal{K}g)(x_k) = g(f(x_k))$. For the observable $g(x) = x^{2}$, we compute:\n$$(\\mathcal{K}g)(x_k) = g(f(x_k)) = \\left(f(x_k)\\right)^{2}.$$\nSubstituting $f(x_k) = r x_k(1 - x_k)$ yields:\n$$(\\mathcal{K}g)(x_k) = \\left(r x_k(1 - x_k)\\right)^{2} = r^{2} x_k^{2} (1 - x_k)^{2}.$$\nExpanding the square using the binomial theorem,\n$$(1 - x_k)^{2} = 1 - 2 x_k + x_k^{2},$$\nwe obtain\n$$(\\mathcal{K}g)(x_k) = r^{2} x_k^{2} \\left(1 - 2 x_k + x_k^{2}\\right) = r^{2}\\left(x_k^{2} - 2 x_k^{3} + x_k^{4}\\right).$$\nTherefore, the coefficient of the $x_k^{3}$ term in $(\\mathcal{K}g)(x_k)$ is $-2 r^{2}$.", "answer": "$$\\boxed{-2 r^{2}}$$", "id": "1688996"}]}