{"hands_on_practices": [{"introduction": "This first practice explores a fundamental question in the study of random processes: the \"first passage time\" problem. We will use the martingale property of the Wiener process, a key characteristic, to calculate the probability of a randomly evolving system reaching one boundary before another. This type of analysis is crucial in many applications, from modeling stock prices as in this hypothetical scenario [@problem_id:1710319] to understanding diffusion-limited chemical reactions.", "problem": "A financial analyst models the evolution of a speculative asset's price, $P(t)$, over time $t$. The model assumes that the natural logarithm of the price ratio relative to its initial price $P(0)$, defined as $X_t = \\ln(P(t)/P(0))$, follows the dynamics of a standard one-dimensional Wiener process $W_t$. The process starts from $X_0 = 0$.\n\nThe analyst implements an automated trading strategy based on two predefined thresholds. A 'take-profit' order is triggered if the process $X_t$ first reaches an upper boundary $a > 0$. A 'stop-loss' order is triggered if $X_t$ first reaches a lower boundary $-b$, where $b > 0$. We assume the process will eventually hit one of these boundaries.\n\nFind the probability that the trading position is closed due to the 'take-profit' order being triggered, rather than the 'stop-loss' order. Your answer should be a symbolic expression in terms of $a$ and $b$.", "solution": "Let $X_{t}=W_{t}$ be a standard Wiener process with $X_{0}=0$. Define the first hitting time of the two-sided barriers by\n$$\n\\tau=\\inf\\{t\\ge 0:\\,X_{t}\\in\\{-b,a\\}\\}.\n$$\nLet $p=\\mathbb{P}(X_{\\tau}=a)$ denote the probability that the upper boundary $a$ is hit before the lower boundary $-b$.\n\nSince $X_{t}$ is a standard Brownian motion, it is a martingale. The stopped process $(X_{t\\wedge\\tau})_{t\\ge 0}$ is bounded by $\\max\\{a,b\\}$ because before hitting a barrier it lies in $(-b,a)$ and after hitting it equals either $a$ or $-b$. Hence $(X_{t\\wedge\\tau})_{t\\ge 0}$ is a bounded martingale, so for all $t\\ge 0$,\n$$\n\\mathbb{E}[X_{t\\wedge\\tau}]=\\mathbb{E}[X_{0}]=0.\n$$\nMoreover, $X_{t\\wedge\\tau}\\to X_{\\tau}$ almost surely as $t\\to\\infty$, and $|X_{t\\wedge\\tau}|\\le \\max\\{a,b\\}$ for all $t$, so by dominated convergence,\n$$\n\\mathbb{E}[X_{\\tau}]=\\lim_{t\\to\\infty}\\mathbb{E}[X_{t\\wedge\\tau}]=0.\n$$\nAt the stopping time $\\tau$, the random variable $X_{\\tau}$ takes the value $a$ with probability $p$ and $-b$ with probability $1-p$. Therefore,\n$$\n\\mathbb{E}[X_{\\tau}]=a\\,p+(-b)\\,(1-p)=0.\n$$\nSolving this linear equation for $p$ gives\n$$\na\\,p-b+b\\,p=0\\quad\\Longrightarrow\\quad (a+b)\\,p=b\\quad\\Longrightarrow\\quad p=\\frac{b}{a+b}.\n$$\nThus, the probability that the process hits the upper level $a$ before the lower level $-b$ is $\\frac{b}{a+b}$.", "answer": "$$\\boxed{\\frac{b}{a+b}}$$", "id": "1710319"}, {"introduction": "A central task in dynamical systems is predicting a system's long-term fate. This exercise demonstrates the power of Itô's lemma, the cornerstone of stochastic calculus, to solve a common SDE and analyze its behavior. By studying a model for population dynamics, we will uncover how random noise dramatically alters the conditions for long-term stability, a profound insight with implications far beyond the specific model used [@problem_id:1710345].", "problem": "A simplified model for the population size of a species, denoted by $X_t$ at time $t$, is used to study the effects of a randomly fluctuating environment. The population dynamics are governed by the following linear Stochastic Differential Equation (SDE):\n$$dX_t = a X_t dt + X_t dW_t$$\nwhere the initial population $X_0$ is positive. In this model, $a$ is a dimensionless constant that represents the population's net intrinsic growth rate, combining birth and death rates under average environmental conditions. The term $W_t$ represents a standard Wiener process, which models unpredictable, random shocks to the population due to environmental variability.\n\nThe long-term survival of the species is a key concern. The species is considered to face certain extinction if its population size converges to zero almost surely as time approaches infinity, i.e., $\\lim_{t \\to \\infty} X_t = 0$ with probability one. It can be shown that there exists a critical value for the intrinsic growth rate, which we denote as $a_c$. If the species' actual growth rate $a$ is less than this critical value ($a < a_c$), the population is guaranteed to go extinct. Conversely, if $a > a_c$, the population has a non-zero probability of long-term survival.\n\nDetermine the exact value of this critical growth rate $a_c$.", "solution": "We analyze the linear SDE $dX_{t}=aX_{t}\\,dt+X_{t}\\,dW_{t}$ with $X_{0}>0$. To determine the almost sure long-time behavior, we apply Itô's formula to $f(x)=\\ln x$. For $f(x)=\\ln x$, we have $f'(x)=x^{-1}$ and $f''(x)=-x^{-2}$. Writing the SDE in the form $dX_{t}=b(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}$ with $b(x)=ax$ and $\\sigma(x)=x$, Itô's formula gives\n$$\nd\\ln X_{t}\n= \\left(\\frac{b(X_{t})}{X_{t}} - \\frac{1}{2}\\frac{\\sigma(X_{t})^{2}}{X_{t}^{2}}\\right)dt + \\frac{\\sigma(X_{t})}{X_{t}}\\,dW_{t}\n= \\left(a - \\frac{1}{2}\\right)dt + dW_{t}.\n$$\nIntegrating from $0$ to $t$ yields\n$$\n\\ln X_{t} = \\ln X_{0} + \\left(a - \\frac{1}{2}\\right)t + W_{t},\n$$\nhence\n$$\nX_{t} = X_{0}\\,\\exp\\!\\left(\\left(a - \\frac{1}{2}\\right)t + W_{t}\\right).\n$$\nThis representation shows $X_{t}>0$ for all $t\\geq 0$.\n\nTo determine extinction versus survival, consider the scaled logarithm\n$$\n\\frac{1}{t}\\ln X_{t} = \\frac{1}{t}\\ln X_{0} + \\left(a - \\frac{1}{2}\\right) + \\frac{W_{t}}{t}.\n$$\nBy the strong law for Brownian motion, $\\lim_{t\\to\\infty} W_{t}/t = 0$ almost surely, and clearly $\\lim_{t\\to\\infty} (\\ln X_{0})/t = 0$. Therefore,\n$$\n\\lim_{t\\to\\infty} \\frac{1}{t}\\ln X_{t} = a - \\frac{1}{2} \\quad \\text{almost surely}.\n$$\nConsequently:\n- If $a - \\frac{1}{2} < 0$, then $\\ln X_{t} \\to -\\infty$ almost surely, so $X_{t} \\to 0$ almost surely (certain extinction).\n- If $a - \\frac{1}{2} > 0$, then $\\ln X_{t} \\to +\\infty$ almost surely, so $X_{t} \\to \\infty$ almost surely (hence extinction does not occur; survival has probability one).\n\nThus, the critical growth rate is the threshold at which the drift of $\\ln X_{t}$ changes sign, namely\n$$\na_{c} = \\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1710345"}, {"introduction": "While analytical solutions provide deep understanding, many real-world SDEs require numerical simulation. This final practice bridges theory and computation by examining the stability of the Euler-Maruyama method, a foundational numerical scheme. By determining the conditions for 'mean-square' stability, we establish a critical link between the theoretical parameters of an SDE and the practical constraints of its computer simulation [@problem_id:1710321].", "problem": "A stochastic model for a certain quantity $X_t$ is described by the scalar linear Stochastic Differential Equation (SDE):\n$$\ndX_t = \\lambda X_t dt + \\mu X_t dW_t\n$$\nwhere $t$ is time, $X_0$ is the non-zero initial value, $W_t$ is a standard Wiener process, and $\\lambda$ and $\\mu$ are real constants with $\\lambda \\neq 0$. The parameters $\\lambda$ and $\\mu$ are such that the exact solution $X_t$ is mean-square stable, meaning $\\lim_{t \\to \\infty} \\mathbb{E}[X_t^2] = 0$.\n\nTo approximate the solution numerically, the explicit Euler-Maruyama (EM) method is applied with a constant time step $\\Delta t > 0$, generating a sequence of approximations $\\{X_n\\}_{n \\geq 0}$ where $X_n \\approx X(n\\Delta t)$. The EM method is said to be mean-square stable if the sequence of second moments of the numerical solution, $\\mathbb{E}[X_n^2]$, converges to zero as $n \\to \\infty$.\n\nDetermine the maximum allowable time step, $\\Delta t_{max}$, for which the EM scheme is guaranteed to be mean-square stable. Express your answer as a single analytic expression in terms of $\\lambda$ and $\\mu$.", "solution": "The given Stochastic Differential Equation (SDE) is $dX_t = \\lambda X_t dt + \\mu X_t dW_t$.\nThe explicit Euler-Maruyama (EM) scheme for a general SDE $dY_t = a(t, Y_t) dt + b(t, Y_t) dW_t$ is given by $Y_{n+1} = Y_n + a(t_n, Y_n) \\Delta t + b(t_n, Y_n) \\Delta W_n$, where $\\Delta t = t_{n+1} - t_n$ and $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$. The increments of the Wiener process $\\Delta W_n$ are independent and identically distributed normal random variables with mean $\\mathbb{E}[\\Delta W_n] = 0$ and variance $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$.\n\nApplying the EM scheme to the specific SDE in the problem, we get the discrete-time update rule:\n$$\nX_{n+1} = X_n + \\lambda X_n \\Delta t + \\mu X_n \\Delta W_n\n$$\nWe can factor out $X_n$ to write this as:\n$$\nX_{n+1} = X_n (1 + \\lambda \\Delta t + \\mu \\Delta W_n)\n$$\nTo analyze the mean-square stability, we need to examine the evolution of the second moment, $\\mathbb{E}[X_n^2]$. We start by squaring the expression for $X_{n+1}$:\n$$\nX_{n+1}^2 = X_n^2 (1 + \\lambda \\Delta t + \\mu \\Delta W_n)^2\n$$\nExpanding the squared term gives:\n$$\nX_{n+1}^2 = X_n^2 (1 + \\lambda^2 (\\Delta t)^2 + \\mu^2 (\\Delta W_n)^2 + 2\\lambda \\Delta t + 2\\mu \\Delta W_n + 2\\lambda\\mu \\Delta t \\Delta W_n)\n$$\nNow, we take the expectation of both sides. It is most rigorous to first take the conditional expectation with respect to the filtration $\\mathcal{F}_{t_n}$ (the information available up to time $t_n$). Since $X_n$ and $\\Delta t$ are known at time $t_n$, they can be treated as constants inside the conditional expectation. The increment $\\Delta W_n$ is independent of $\\mathcal{F}_{t_n}$.\n$$\n\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}] = X_n^2 \\mathbb{E}[(1 + \\lambda^2 (\\Delta t)^2 + \\mu^2 (\\Delta W_n)^2 + 2\\lambda \\Delta t + 2\\mu \\Delta W_n + 2\\lambda\\mu \\Delta t \\Delta W_n) | \\mathcal{F}_{t_n}]\n$$\nUsing the linearity of expectation and the properties $\\mathbb{E}[\\Delta W_n | \\mathcal{F}_{t_n}] = \\mathbb{E}[\\Delta W_n] = 0$ and $\\mathbb{E}[(\\Delta W_n)^2 | \\mathcal{F}_{t_n}] = \\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$, we get:\n$$\n\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}] = X_n^2 (1 + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t + 2\\lambda \\Delta t + 0 + 0)\n$$\n$$\n\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}] = X_n^2 (1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t)\n$$\nUsing the law of total expectation, $\\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{E}[Y | \\mathcal{G}]]$, we have:\n$$\n\\mathbb{E}[X_{n+1}^2] = \\mathbb{E}[\\mathbb{E}[X_{n+1}^2 | \\mathcal{F}_{t_n}]] = \\mathbb{E}[X_n^2 (1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t)]\n$$\nSince the term in the parentheses is constant, we can pull it out of the outer expectation:\n$$\n\\mathbb{E}[X_{n+1}^2] = (1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t) \\mathbb{E}[X_n^2]\n$$\nThis is a geometric recurrence relation for the sequence of second moments. Let the amplification factor be $R(\\Delta t) = 1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t$.\nFor the numerical scheme to be mean-square stable, we require $\\lim_{n \\to \\infty} \\mathbb{E}[X_n^2] = 0$. This holds if and only if the magnitude of the amplification factor is less than one, i.e., $|R(\\Delta t)| < 1$.\n\nWe can rewrite $R(\\Delta t)$ as:\n$$\nR(\\Delta t) = (1 + \\lambda \\Delta t)^2 + \\mu^2 \\Delta t\n$$\nSince $(\\Delta t) > 0$ and $\\mu^2 \\geq 0$, the term $\\mu^2 \\Delta t$ is non-negative. Also, $(1 + \\lambda \\Delta t)^2$ is non-negative. Therefore, $R(\\Delta t) \\geq 0$. The stability condition $|R(\\Delta t)| < 1$ simplifies to $R(\\Delta t) < 1$.\n$$\n1 + 2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t < 1\n$$\nSubtracting 1 from both sides gives:\n$$\n2\\lambda \\Delta t + \\lambda^2 (\\Delta t)^2 + \\mu^2 \\Delta t < 0\n$$\nSince $\\Delta t > 0$, we can divide by $\\Delta t$ without changing the inequality's direction:\n$$\n2\\lambda + \\lambda^2 \\Delta t + \\mu^2 < 0\n$$\nNow, we solve for $\\Delta t$. Rearranging the terms, we get:\n$$\n\\lambda^2 \\Delta t < -2\\lambda - \\mu^2\n$$\nFor this inequality to have any solution for $\\Delta t > 0$, the right-hand side must be positive, which means $-2\\lambda - \\mu^2 > 0$, or $2\\lambda + \\mu^2 < 0$. This is precisely the condition for the exact SDE to be mean-square stable, which was given in the problem statement.\nSince the problem states that $\\lambda \\neq 0$, we have $\\lambda^2 > 0$. We can divide by $\\lambda^2$ to isolate $\\Delta t$:\n$$\n\\Delta t < \\frac{-2\\lambda - \\mu^2}{\\lambda^2}\n$$\nThe right-hand side of this inequality represents the upper bound on the time step for mean-square stability. Therefore, the maximum allowable time step is:\n$$\n\\Delta t_{max} = \\frac{-2\\lambda - \\mu^2}{\\lambda^2}\n$$", "answer": "$$\\boxed{\\frac{-2\\lambda - \\mu^{2}}{\\lambda^{2}}}$$", "id": "1710321"}]}