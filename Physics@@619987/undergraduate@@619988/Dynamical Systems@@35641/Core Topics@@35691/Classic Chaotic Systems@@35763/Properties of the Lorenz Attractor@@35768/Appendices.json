{"hands_on_practices": [{"introduction": "The first step in understanding the long-term behavior of a dynamical system is to identify its equilibrium states, or fixed points. This practice [@problem_id:1702122] will guide you through the fundamental algebraic process of locating the non-trivial fixed points of the Lorenz system for its classic parameter set, which famously gives rise to chaotic behavior. Solving for these steady-state solutions provides the coordinates for the centers of the two 'lobes' around which the chaotic trajectory revolves.", "problem": "The Lorenz system is a simplified mathematical model for atmospheric convection, first derived by Edward Lorenz in 1963. It describes the behavior of a fluid layer heated from below and cooled from above. The state of the system at any time $t$ is described by three variables, $x(t)$, $y(t)$, and $z(t)$, which are proportional to the rate of convection, the horizontal temperature variation, and the vertical temperature variation, respectively. The system is governed by the following set of coupled ordinary differential equations:\n\n$$\n\\begin{aligned}\n\\frac{dx}{dt} &= \\sigma (y - x) \\\\\n\\frac{dy}{dt} &= x (\\rho - z) - y \\\\\n\\frac{dz}{dt} &= xy - \\beta z\n\\end{aligned}\n$$\n\nHere, $\\sigma$ is the Prandtl number, $\\rho$ is a normalized Rayleigh number, and $\\beta$ is a geometric factor. All three parameters are positive real numbers.\n\nFixed points of the system correspond to steady-state solutions where the variables do not change over time, i.e., where $\\frac{dx}{dt} = \\frac{dy}{dt} = \\frac{dz}{dt} = 0$. For certain parameter values, the system exhibits one fixed point at the origin $(0, 0, 0)$, corresponding to a state of no convection, and two other \"non-trivial\" fixed points, which represent stable states of steady convection.\n\nConsider the system with the classic parameter values used by Lorenz: $\\sigma = 10$, $\\rho = 28$, and $\\beta = 8/3$. Determine the coordinates $(x, y, z)$ of the non-trivial fixed point that has a positive $x$ coordinate.", "solution": "Fixed points satisfy $\\frac{dx}{dt}=\\frac{dy}{dt}=\\frac{dz}{dt}=0$. Setting the right-hand sides to zero gives the algebraic system\n$$\n\\begin{aligned}\n0 &= \\sigma (y - x), \\\\\n0 &= x (\\rho - z) - y, \\\\\n0 &= xy - \\beta z.\n\\end{aligned}\n$$\nFrom $0=\\sigma(y-x)$ with $\\sigma>0$, we obtain\n$$\ny = x.\n$$\nSubstitute $y=x$ into $0=xy-\\beta z$ to get\n$$\n0 = x^{2} - \\beta z \\quad \\Rightarrow \\quad z = \\frac{x^{2}}{\\beta}.\n$$\nSubstitute $y=x$ into $0=x(\\rho - z)-y$ to obtain\n$$\n0 = x(\\rho - z) - x = x(\\rho - z - 1).\n$$\nThis yields two cases:\n- If $x=0$, then $y=0$ and from $0=xy-\\beta z$ we get $z=0$, giving the trivial fixed point $(0,0,0)$.\n- For non-trivial fixed points with $x\\neq 0$, we must have\n$$\n\\rho - z - 1 = 0 \\quad \\Rightarrow \\quad z = \\rho - 1.\n$$\nCombining this with $z = \\frac{x^{2}}{\\beta}$ gives\n$$\n\\frac{x^{2}}{\\beta} = \\rho - 1 \\quad \\Rightarrow \\quad x^{2} = \\beta(\\rho - 1) \\quad \\Rightarrow \\quad x = \\pm \\sqrt{\\beta(\\rho - 1)}.\n$$\nSince $y=x$, we have the two non-trivial fixed points\n$$\n\\left(\\pm \\sqrt{\\beta(\\rho - 1)}, \\pm \\sqrt{\\beta(\\rho - 1)}, \\rho - 1\\right).\n$$\nFor the classic parameter values $\\sigma=10$, $\\rho=28$, and $\\beta=\\frac{8}{3}$, we compute\n$$\n\\rho - 1 = 27, \\quad \\beta(\\rho - 1) = \\frac{8}{3}\\cdot 27 = 72, \\quad \\sqrt{72} = 6\\sqrt{2}.\n$$\nThe non-trivial fixed point with positive $x$ is therefore\n$$\n\\left(6\\sqrt{2},\\, 6\\sqrt{2},\\, 27\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 6 \\sqrt{2} & 6 \\sqrt{2} & 27 \\end{pmatrix}}$$", "id": "1702122"}, {"introduction": "While fixed points are zero-dimensional equilibria, dynamical systems can also possess higher-dimensional structures called invariant manifolds, which are regions that trap trajectories. This exercise [@problem_id:1702174] provides a hands-on look at this concept by asking you to verify that the $z$-axis is an invariant line for the Lorenz system. You will see how a trajectory starting on this axis evolves in a simple, predictable way, even though it exists within a system capable of chaos.", "problem": "The Lorenz system is a set of coupled, first-order, nonlinear ordinary differential equations which model a simplified form of atmospheric convection. The state of the system at any time $t$ is described by a point $(x(t), y(t), z(t))$ in three-dimensional space. The equations of motion are given by:\n$$\n\\begin{aligned}\n\\frac{dx}{dt} &= \\sigma(y - x) \\\\\n\\frac{dy}{dt} &= x(\\rho - z) - y \\\\\n\\frac{dz}{dt} &= xy - \\beta z\n\\end{aligned}\n$$\nHere, $\\sigma$, $\\rho$, and $\\beta$ are positive real parameters representing physical properties of the fluid. The variables $x, y, z,$ and the time $t$ are all dimensionless.\n\nConsider a particle whose trajectory is governed by this system. The particle is initially placed at the position $(x_0, y_0, z_0) = (0, 0, z_A)$, where $z_A$ is a positive constant. Calculate the total distance the particle travels from time $t=0$ to $t=\\infty$. Provide your answer as a closed-form analytic expression.", "solution": "We evaluate the right-hand sides at the initial condition $(x(0),y(0),z(0))=(0,0,z_{A})$. The Lorenz system is smooth, so the local existence and uniqueness theorem applies. At $(x,y)=(0,0)$, we have\n$$\n\\frac{dx}{dt}=\\sigma(y-x)=0,\\qquad \\frac{dy}{dt}=x(\\rho-z)-y=0.\n$$\nWith $x(0)=0$ and $y(0)=0$, uniqueness implies $x(t)=0$ and $y(t)=0$ for all $t\\geq 0$. Then $z$ evolves according to\n$$\n\\frac{dz}{dt}=xy-\\beta z=-\\beta z,\\qquad z(0)=z_{A}.\n$$\nSolving this linear ODE gives\n$$\nz(t)=z_{A}\\exp(-\\beta t),\\qquad t\\geq 0.\n$$\nThe speed of the particle is the magnitude of the velocity vector:\n$$\nv(t)=\\sqrt{\\left(\\frac{dx}{dt}\\right)^{2}+\\left(\\frac{dy}{dt}\\right)^{2}+\\left(\\frac{dz}{dt}\\right)^{2}}.\n$$\nAlong the trajectory $x(t)=0$, $y(t)=0$, this reduces to\n$$\nv(t)=\\left|\\frac{dz}{dt}\\right|=|-\\beta z(t)|=\\beta z_{A}\\exp(-\\beta t),\n$$\nsince $z(t)\\geq 0$ for all $t\\geq 0$. The total distance traveled from $t=0$ to $t=\\infty$ is\n$$\n\\int_{0}^{\\infty} v(t)\\,dt=\\int_{0}^{\\infty} \\beta z_{A}\\exp(-\\beta t)\\,dt=z_{A}.\n$$\nEquivalently, since $z(t)$ is monotone decreasing and $x,y$ are constant, the path lies along the $z$-axis from $z_{A}$ to $0$, so the arc length is $|z(\\infty)-z(0)|=z_{A}$.", "answer": "$$\\boxed{z_{A}}$$", "id": "1702174"}, {"introduction": "The defining feature of the Lorenz attractor is its chaotic nature, where tiny differences in initial conditions lead to vastly different outcomes over time. This sensitivity is quantified by the Lyapunov exponent, and a positive value is a definitive indicator of chaos. This advanced practice [@problem_id:1702190] offers a direct computational experience, guiding you through a numerical approximation of the largest Lyapunov exponent to provide a tangible measure of the system's exponential divergence of nearby trajectories.", "problem": "The Lorenz system is a set of three coupled, nonlinear ordinary differential equations that models a simplified form of atmospheric convection. The equations are given by:\n$$\n\\begin{aligned}\n\\frac{dx}{dt} &= \\sigma(y - x) \\\\\n\\frac{dy}{dt} &= x(\\rho - z) - y \\\\\n\\frac{dz}{dt} &= xy - \\beta z\n\\end{aligned}\n$$\nFor certain parameter values, the system exhibits chaotic behavior, characterized by a sensitive dependence on initial conditions. This sensitivity can be quantified by the largest Lyapunov exponent, $\\lambda$. A positive value of $\\lambda$ is a hallmark of chaos.\n\nThis problem requires you to approximate $\\lambda$ using a direct computational method. The method involves tracking the evolution of an infinitesimal separation vector, $\\vec{\\delta}(t)$, between two initially close trajectories. The evolution of this separation vector is governed by the linearized system $\\frac{d\\vec{\\delta}}{dt} = J(\\vec{r}(t))\\vec{\\delta}$, where $\\vec{r}(t) = (x(t), y(t), z(t))$ is the state vector of the reference trajectory and $J$ is the Jacobian matrix of the system:\n$$\nJ(\\vec{r}) = \\begin{pmatrix}\n-\\sigma & \\sigma & 0 \\\\\n\\rho - z & -1 & -x \\\\\ny & x & -\\beta\n\\end{pmatrix}\n$$\nYou will implement a numerical algorithm for a small number of steps to find an estimate for $\\lambda$.\n\n**Algorithm:**\n1.  Initialize the reference trajectory at $\\vec{r}(0)$ and the separation vector at $\\vec{\\delta}(0)$. The initial magnitude of the separation is $d_0 = |\\vec{\\delta}(0)|$.\n2.  The calculation proceeds in $N$ cycles, each of duration $\\tau$. For each cycle $k=1, \\dots, N$:\n    a.  Simultaneously integrate both $\\frac{d\\vec{r}}{dt} = \\vec{F}(\\vec{r})$ and $\\frac{d\\vec{\\delta}}{dt} = J(\\vec{r})\\vec{\\delta}$ over the time interval from $t_{k-1} = (k-1)\\tau$ to $t_k = k\\tau$. Use the Forward Euler method with a time step $h$. The reference trajectory $\\vec{r}(t)$ and Jacobian $J(\\vec{r}(t))$ are updated at each Euler step.\n    b.  At the end of the cycle (at time $t_k$), denote the final separation vector as $\\vec{\\delta}(t_k)$. Calculate its magnitude $d_k = |\\vec{\\delta}(t_k)|$.\n    c.  Compute the contribution to the exponent for this cycle: $s_k = \\ln\\left(\\frac{d_k}{d_0}\\right)$.\n    d.  Renormalize the separation vector for the start of the next cycle: the new initial condition for the separation vector becomes $\\vec{\\delta}_{\\text{new}}(t_k) = \\frac{d_0}{d_k}\\vec{\\delta}(t_k)$. The reference trajectory $\\vec{r}(t_k)$ continues from its position.\n3.  After $N$ cycles, the largest Lyapunov exponent is approximated by the average of the logarithmic growth rates: $\\lambda \\approx \\frac{1}{N\\tau} \\sum_{k=1}^{N} s_k$.\n\n**Task:**\nUsing the parameter values $\\sigma=10$, $\\rho=28$, and $\\beta=8/3$, perform this calculation for $N=2$ cycles.\n\nUse the following numerical and initial conditions:\n- Initial reference state: $\\vec{r}(0) = (0.1, 0.1, 0.1)$.\n- Initial separation vector: $\\vec{\\delta}(0) = (1.0 \\times 10^{-6}, 0, 0)$.\n- Euler time step: $h = 0.01$ s.\n- Cycle duration: $\\tau = 0.02$ s (i.e., each cycle consists of two Euler steps).\n\nCalculate the value of $\\lambda$. Express your answer in units of inverse seconds, rounded to three significant figures.", "solution": "We are given the Lorenz system\n$$\n\\begin{aligned}\n\\frac{dx}{dt} &= \\sigma(y-x),\\\\\n\\frac{dy}{dt} &= x(\\rho - z) - y,\\\\\n\\frac{dz}{dt} &= xy - \\beta z,\n\\end{aligned}\n$$\nwith parameters $\\sigma=10$, $\\rho=28$, $\\beta=\\frac{8}{3}$, and the Jacobian\n$$\nJ(\\vec{r})=\\begin{pmatrix}\n-\\sigma & \\sigma & 0\\\\\n\\rho - z & -1 & -x\\\\\ny & x & -\\beta\n\\end{pmatrix}.\n$$\nWe approximate the largest Lyapunov exponent using $N=2$ cycles of duration $\\tau=0.02$ with Forward Euler time step $h=0.01$ (two Euler steps per cycle). The initial conditions are $\\vec{r}(0)=(0.1,0.1,0.1)$ and $\\vec{\\delta}(0)=(1.0\\times 10^{-6},0,0)$, so $d_{0}=|\\vec{\\delta}(0)|=1.0\\times 10^{-6}$.\n\nAt each Euler step, update the reference trajectory by\n$$\n\\vec{r}_{n+1}=\\vec{r}_{n}+h\\,\\vec{F}(\\vec{r}_{n}),\n$$\nand the separation vector by\n$$\n\\vec{\\delta}_{n+1}=\\vec{\\delta}_{n}+h\\,J(\\vec{r}_{n})\\,\\vec{\\delta}_{n}.\n$$\n\nCycle 1 (steps at $t=0$ and $t=0.01$):\n- Step at $t=0$:\nCompute $\\vec{F}(\\vec{r}_{0})$ at $\\vec{r}_{0}=(0.1,0.1,0.1)$:\n$$\n\\begin{aligned}\n\\dot{x}&=10(0.1-0.1)=0,\\\\\n\\dot{y}&=0.1(28-0.1)-0.1=2.69,\\\\\n\\dot{z}&=(0.1)(0.1)-\\tfrac{8}{3}(0.1)=0.01-\\tfrac{8}{3}\\times 0.1=-0.2566666666666667.\n\\end{aligned}\n$$\nThus\n$$\n\\vec{r}_{1}=\\vec{r}_{0}+0.01\\,(0,2.69,-0.2566666667)=(0.1,\\,0.1269,\\,0.09743333333333333).\n$$\nCompute $J(\\vec{r}_{0})$:\n$$\nJ(\\vec{r}_{0})=\\begin{pmatrix}\n-10 & 10 & 0\\\\\n27.9 & -1 & -0.1\\\\\n0.1 & 0.1 & -\\tfrac{8}{3}\n\\end{pmatrix}.\n$$\nWith $\\vec{\\delta}_{0}=(1.0\\times 10^{-6},0,0)$,\n$$\nJ(\\vec{r}_{0})\\,\\vec{\\delta}_{0}=10^{-6}\\,(-10,\\,27.9,\\,0.1),\n$$\nso\n$$\n\\vec{\\delta}_{1}=\\vec{\\delta}_{0}+0.01\\,J(\\vec{r}_{0})\\,\\vec{\\delta}_{0}=(9.0\\times 10^{-7},\\,2.79\\times 10^{-7},\\,1.0\\times 10^{-9}).\n$$\n\n- Step at $t=0.01$:\nCompute $\\vec{F}(\\vec{r}_{1})$ at $\\vec{r}_{1}=(0.1,0.1269,0.0974333333)$:\n$$\n\\begin{aligned}\n\\dot{x}&=10(0.1269-0.1)=0.269,\\\\\n\\dot{y}&=0.1(28-0.0974333333)-0.1269=2.663356666666667,\\\\\n\\dot{z}&=0.1\\cdot 0.1269-\\tfrac{8}{3}\\cdot 0.0974333333=-0.24713222222222224.\n\\end{aligned}\n$$\nThus\n$$\n\\vec{r}_{2}=\\vec{r}_{1}+0.01\\,(0.269,\\,2.663356666666667,\\,-0.24713222222222224)=(0.10269,\\,0.15353356666666667,\\,0.0949620111111111).\n$$\nCompute $J(\\vec{r}_{1})$ at $(x,y,z)=(0.1,0.1269,0.0974333333)$:\n$$\nJ(\\vec{r}_{1})=\\begin{pmatrix}\n-10 & 10 & 0\\\\\n27.902566666666667 & -1 & -0.1\\\\\n0.1269 & 0.1 & -\\tfrac{8}{3}\n\\end{pmatrix}.\n$$\nThen\n$$\nJ(\\vec{r}_{1})\\,\\vec{\\delta}_{1}\\approx(-6.21\\times 10^{-6},\\,2.483321\\times 10^{-5},\\,1.39463333\\times 10^{-7}),\n$$\nand\n$$\n\\vec{\\delta}_{2}=\\vec{\\delta}_{1}+0.01\\,J(\\vec{r}_{1})\\,\\vec{\\delta}_{1}=(8.379\\times 10^{-7},\\,5.273321\\times 10^{-7},\\,2.39463333\\times 10^{-9}).\n$$\nThe magnitude at the end of cycle 1 is\n$$\nd_{1}=|\\vec{\\delta}_{2}|=\\sqrt{(8.379\\times 10^{-7})^{2}+(5.273321\\times 10^{-7})^{2}+(2.39463333\\times 10^{-9})^{2}}\\approx 9.900367\\times 10^{-7}.\n$$\nHence\n$$\ns_{1}=\\ln\\left(\\frac{d_{1}}{d_{0}}\\right)=\\ln(0.9900367)\\approx -0.0100133.\n$$\nRenormalize for the next cycle:\n$$\n\\vec{\\delta}_{\\text{start2}}=\\frac{d_{0}}{d_{1}}\\vec{\\delta}_{2},\\quad \\text{so that }|\\vec{\\delta}_{\\text{start2}}|=d_{0}.\n$$\nNumerically, this gives a starting direction with components approximately\n$$\n\\vec{\\delta}_{\\text{start2}}\\approx(8.46332\\times 10^{-7},\\,5.32639\\times 10^{-7},\\,2.4187\\times 10^{-9}).\n$$\n\nCycle 2 (steps at $t=0.02$ and $t=0.03$), continuing $\\vec{r}$ from $\\vec{r}_{2}$ and using $\\vec{\\delta}_{\\text{start2}}$:\n- Step at $t=0.02$:\nCompute $\\vec{F}(\\vec{r}_{2})$ at $\\vec{r}_{2}=(0.10269,0.15353356666666667,0.0949620111111111)$:\n$$\n\\begin{aligned}\n\\dot{x}&=10(0.15353356666666667-0.10269)=0.5084356666666667,\\\\\n\\dot{y}&=0.10269(28-0.0949620111111111)-0.15353356666666667=2.7120347844133333,\\\\\n\\dot{z}&=0.10269\\cdot 0.15353356666666667-\\tfrac{8}{3}\\cdot 0.0949620111111111=-0.23746566766862626.\n\\end{aligned}\n$$\nThus\n$$\n\\vec{r}_{3}=\\vec{r}_{2}+0.01\\,(0.5084356666666667,\\,2.7120347844133333,\\,-0.23746566766862626)=(0.10777435666666667,\\,0.1806539145108,\\,0.09258735443442484).\n$$\nCompute $J(\\vec{r}_{2})$ and apply to $\\vec{\\delta}_{\\text{start2}}$:\n$$\nJ(\\vec{r}_{2})=\\begin{pmatrix}\n-10 & 10 & 0\\\\\n27.90503798888889 & -1 & -0.10269\\\\\n0.15353356666666667 & 0.10269 & -\\tfrac{8}{3}\n\\end{pmatrix},\n$$\nso\n$$\nJ(\\vec{r}_{2})\\,\\vec{\\delta}_{\\text{start2}}\\approx(-3.13693\\times 10^{-6},\\,2.308428736\\times 10^{-5},\\,1.781871\\times 10^{-7}),\n$$\nand\n$$\n\\vec{\\delta}_{3}=\\vec{\\delta}_{\\text{start2}}+0.01\\,J(\\vec{r}_{2})\\,\\vec{\\delta}_{\\text{start2}}=(8.149627\\times 10^{-7},\\,7.634818736\\times 10^{-7},\\,4.200571\\times 10^{-9}).\n$$\n\n- Step at $t=0.03$:\nCompute $\\vec{F}(\\vec{r}_{3})$ at $\\vec{r}_{3}=(0.10777435666666667,0.1806539145108,0.09258735443442484)$:\n$$\n\\begin{aligned}\n\\dot{x}&=10(0.1806539145108-0.10777435666666667)=0.7287955784413334,\\\\\n\\dot{y}&=0.10777435666666667(28-0.09258735443442484)-0.1806539145108=2.8270495295962,\\\\\n\\dot{z}&=0.10777435666666667\\cdot 0.1806539145108-\\tfrac{8}{3}\\cdot 0.09258735443442484=-0.2274297534751329.\n\\end{aligned}\n$$\nThus\n$$\n\\vec{r}_{4}=\\vec{r}_{3}+0.01\\,(0.7287955784413334,\\,2.8270495295962,\\,-0.2274297534751329)=(0.11506231245108,\\,0.208924409806762,\\,0.09031305689967351).\n$$\nCompute $J(\\vec{r}_{3})$ and apply to $\\vec{\\delta}_{3}$:\n$$\nJ(\\vec{r}_{3})=\\begin{pmatrix}\n-10 & 10 & 0\\\\\n27.907412645565575 & -1 & -0.10777435666666667\\\\\n0.1806539145108 & 0.10777435666666667 & -\\tfrac{8}{3}\n\\end{pmatrix},\n$$\ngiving\n$$\nJ(\\vec{r}_{3})\\,\\vec{\\delta}_{3}\\approx(-5.14808264\\times 10^{-7},\\,2.19800180338\\times 10^{-5},\\,2.18308446972\\times 10^{-7}),\n$$\nand\n$$\n\\vec{\\delta}_{4}=\\vec{\\delta}_{3}+0.01\\,J(\\vec{r}_{3})\\,\\vec{\\delta}_{3}=(8.0981461736\\times 10^{-7},\\,9.83282053938\\times 10^{-7},\\,6.38365546972\\times 10^{-9}).\n$$\nThe magnitude at the end of cycle 2 is\n$$\nd_{2}=|\\vec{\\delta}_{4}|=\\sqrt{(8.0981461736\\times 10^{-7})^{2}+(9.83282053938\\times 10^{-7})^{2}+(6.38365546972\\times 10^{-9})^{2}}\\approx 1.2738302\\times 10^{-6}.\n$$\nTherefore\n$$\ns_{2}=\\ln\\left(\\frac{d_{2}}{d_{0}}\\right)=\\ln(1.2738302)\\approx 0.24203.\n$$\n\nAssembling the estimate after $N=2$ cycles,\n$$\n\\lambda \\approx \\frac{1}{N\\tau}\\sum_{k=1}^{N} s_{k}=\\frac{1}{2\\times 0.02}\\left(s_{1}+s_{2}\\right)\\approx \\frac{1}{0.04}\\left(-0.0100133+0.24203\\right)\\approx \\frac{0.232017}{0.04}\\approx 5.80.\n$$\nIn units of inverse seconds, rounded to three significant figures, the result is $5.80$.", "answer": "$$\\boxed{5.80}$$", "id": "1702190"}]}