{"hands_on_practices": [{"introduction": "The foundation of any statistical mechanics simulation is the energy function, or Hamiltonian, which assigns an energy value to every possible configuration of the system. Before we can simulate how a system evolves, we must be able to precisely calculate this energy for any given state. This first practice sharpens that essential skill for the celebrated Ising model, a cornerstone for understanding magnetism and phase transitions. By working through this problem [@problem_id:1964969], you will gain hands-on experience with the concepts of nearest-neighbor interactions and periodic boundary conditions, which are fundamental to many computational physics models.", "problem": "Consider a two-dimensional Ising model on a 3x3 square lattice. Each lattice site $i$ is occupied by a spin $s_i$ that can take values of +1 (spin up) or -1 (spin down). The total energy $E$ of a spin configuration is given by the Hamiltonian $E = -J \\sum_{\\langle i,j \\rangle} s_i s_j$, where $J$ is a positive ferromagnetic coupling constant and the sum is over all unique nearest-neighbor pairs of spins.\n\nThe system is subject to periodic boundary conditions. This means the lattice wraps around toroidally: the rightmost column of spins is considered a nearest neighbor to the leftmost column, and the bottom row of spins is a nearest neighbor to the top row.\n\nA specific configuration of spins is given as follows, described row by row from top to bottom, with spins within each row listed from left to right:\n- Row 1: +1, -1, +1\n- Row 2: +1, +1, -1\n- Row 3: -1, +1, -1\n\nCalculate the total energy $E$ of this specific configuration. Express your answer as a single numerical value in units of the coupling constant $J$.", "solution": "The Hamiltonian is $E=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}$, where the sum runs over all unique nearest-neighbor bonds. On a $3\\times 3$ square lattice with periodic boundary conditions, there are $2L^{2}=18$ unique bonds: $9$ horizontal and $9$ vertical.\n\nLabel the spins by $s_{r,c}$ with $r,c\\in\\{1,2,3\\}$, and use the given configuration:\n$s_{1,1}=+1$, $s_{1,2}=-1$, $s_{1,3}=+1$;\n$s_{2,1}=+1$, $s_{2,2}=+1$, $s_{2,3}=-1$;\n$s_{3,1}=-1$, $s_{3,2}=+1$, $s_{3,3}=-1$.\n\nCompute the horizontal bond sums row by row, using periodicity within each row:\n$H_{1}=s_{1,1}s_{1,2}+s_{1,2}s_{1,3}+s_{1,3}s_{1,1}=(-1)+(-1)+(+1)=-1$,\n$H_{2}=s_{2,1}s_{2,2}+s_{2,2}s_{2,3}+s_{2,3}s_{2,1}=(+1)+(-1)+(-1)=-1$,\n$H_{3}=s_{3,1}s_{3,2}+s_{3,2}s_{3,3}+s_{3,3}s_{3,1}=(-1)+(-1)+(+1)=-1$.\nThus $\\sum_{\\text{horizontal}}s_{i}s_{j}=H_{1}+H_{2}+H_{3}=-3$.\n\nCompute the vertical bond sums column by column, using periodicity within each column:\n$V_{1}=s_{1,1}s_{2,1}+s_{2,1}s_{3,1}+s_{3,1}s_{1,1}=(+1)+(-1)+(-1)=-1$,\n$V_{2}=s_{1,2}s_{2,2}+s_{2,2}s_{3,2}+s_{3,2}s_{1,2}=(-1)+(+1)+(-1)=-1$,\n$V_{3}=s_{1,3}s_{2,3}+s_{2,3}s_{3,3}+s_{3,3}s_{1,3}=(-1)+(+1)+(-1)=-1$.\nThus $\\sum_{\\text{vertical}}s_{i}s_{j}=V_{1}+V_{2}+V_{3}=-3$.\n\nTherefore the total nearest-neighbor sum is\n$$\n\\sum_{\\langle i,j\\rangle}s_{i}s_{j}=(-3)+(-3)=-6,\n$$\nand the energy is\n$$\nE=-J\\left(-6\\right)=6J.\n$$\nExpressed in units of $J$, this gives $E/J=6$.", "answer": "$$\\boxed{6}$$", "id": "1964969"}, {"introduction": "Monte Carlo simulations explore a system's vast landscape of possible configurations through a sequence of proposed \"moves.\" The genius of the Metropolis algorithm lies in its probabilistic rule for accepting or rejecting these moves, a rule designed to ensure the system eventually samples states according to the Boltzmann distribution. This exercise [@problem_id:1964929] provides a concrete example of calculating this acceptance probability for a particle in a continuous potential, moving beyond discrete lattice models. Mastering this calculation is core to implementing any equilibrium simulation and understanding how systems can sometimes move to higher-energy states to achieve thermal equilibrium.", "problem": "A computational simulation is used to study the statistical behavior of a single particle moving in one dimension. The particle is subjected to an asymmetric potential given by the function $V(x) = A x^4 - B x^3$, where all quantities are expressed in a consistent system of dimensionless units. For this particular system, the constants are $A = 1.0$ and $B = 4.0$. The particle is in thermal equilibrium with a heat bath, characterized by a constant thermal energy of $k_B T = 10.0$ units, where $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nThe simulation algorithm generates a series of particle positions. At a certain step, the particle is at an initial position $x_i = 3.0$. A trial move to a new position $x_f = 4.0$ is proposed. The rule for accepting this trial move is as follows:\n- If the potential energy at the new position is less than or equal to the energy at the current position, the move is always accepted.\n- If the potential energy at the new position is greater than the energy at the current position, the move is accepted with a probability $P = \\exp(-\\Delta V / (k_B T))$, where $\\Delta V$ is the change in potential energy.\n\nCalculate the probability that this specific trial move from $x_i = 3.0$ to $x_f = 4.0$ will be accepted. Express your answer as a decimal rounded to three significant figures.", "solution": "The potential is given by $V(x) = A x^{4} - B x^{3}$ with $A = 1.0$ and $B = 4.0$, and the thermal energy is $k_{B}T = 10.0$.\n\nCompute the potential at the initial and final positions:\n$$\nV(x_{i}) = V(3.0) = (3.0)^{4} - 4.0\\,(3.0)^{3} = 81 - 108 = -27,\n$$\n$$\nV(x_{f}) = V(4.0) = (4.0)^{4} - 4.0\\,(4.0)^{3} = 256 - 256 = 0.\n$$\n\nThe change in potential energy is\n$$\n\\Delta V = V(x_{f}) - V(x_{i}) = 0 - (-27) = 27.\n$$\n\nSince $\\Delta V > 0$, the acceptance probability is given by the Metropolis rule\n$$\nP = \\exp\\!\\left(-\\frac{\\Delta V}{k_{B}T}\\right) = \\exp\\!\\left(-\\frac{27}{10.0}\\right) = \\exp(-2.7).\n$$\n\nNumerically,\n$$\nP \\approx \\exp(-2.7) \\approx 0.0672\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{0.0672}$$", "id": "1964929"}, {"introduction": "A successful Monte Carlo simulation rests on two pillars: a correct acceptance rule and an unbiased proposal mechanism that allows the system to explore its entire relevant state space (a property called ergodicity). While the previous practices focused on energy and the acceptance rule, this thought experiment [@problem_id:1964972] challenges you to diagnose a simulation where the proposal step is fundamentally broken. By predicting the non-physical outcome of such a simulation, you will gain a deeper appreciation for the subtle yet crucial conditions required for a simulation to be a reliable tool for scientific discovery.", "problem": "A student is implementing a Metropolis Monte Carlo simulation to study the equilibrium properties of a single classical particle. The particle is confined to a one-dimensional box of length $L$, extending from position $x=0$ to $x=L$. The potential energy $V(x)$ of the particle is zero for $0 < x < L$ and infinite elsewhere.\n\nThe simulation algorithm proceeds in steps:\n1.  From the current position $x_{old}$, a new trial position $x_{new}$ is proposed. The proposal mechanism is defined by $x_{new} = x_{old} + \\Delta(2r - 1)$, where $\\Delta$ is a fixed maximum step size (with $\\Delta < L$) and $r$ is a random number.\n2.  The trial move is accepted or rejected based on the Metropolis criterion. If the proposed position $x_{new}$ is outside the box (i.e., $x_{new} < 0$ or $x_{new} > L$), the move is automatically rejected. If $x_{new}$ is inside the box, the change in potential energy is $\\Delta V = 0$, so the acceptance probability $\\min(1, \\exp(-\\Delta V / (k_B T)))$ is 1, and the move is always accepted.\n\nThe student's program has a subtle bug: the pseudo-random number generator that is supposed to produce the number $r$ uniformly in the interval $[0, 1]$ is flawed. Instead, it only generates numbers uniformly in the interval $[0.0, 0.1]$.\n\nAfter running the simulation for a very large number of steps, which of the following statements best describes the resulting probability distribution function, $P(x)$, for finding the particle at position $x$?\n\nA. The distribution $P(x)$ will be uniform across the box, i.e., $P(x)$ is constant for $0 < x < L$.\n\nB. The distribution $P(x)$ will be peaked at the center of the box, $x = L/2$.\n\nC. The distribution $P(x)$ will be strongly peaked at or near one of the boundaries of the box (either $x=0$ or $x=L$).\n\nD. The particle will remain at its initial position, as all proposed moves will be rejected.\n\nE. The distribution $P(x)$ will have two peaks of equal height, one near each boundary of the box ($x=0$ and $x=L$).", "solution": "We analyze the Markov chain defined by the flawed proposal and the Metropolis acceptance.\n\nWith the bug, the pseudo-random number satisfies $r \\in [0, 0.1]$, uniformly. Hence\n$$\n2r - 1 \\in [-1, -0.8],\n$$\nand the proposal step is\n$$\nS = \\Delta(2r - 1) \\in [-\\Delta, -0.8\\Delta],\n$$\nso every proposed move is strictly negative. The trial position from $x$ is\n$$\ny = x + S \\in [x - \\Delta, x - 0.8\\Delta].\n$$\nBecause $V(x)$ is zero inside $(0, L)$ and infinite outside, the Metropolis acceptance is $1$ if $y \\in (0, L)$ and $0$ if $y \\notin (0, L)$.\n\nConsider three regimes:\n\n1) If $x \\geq \\Delta$, then $x - \\Delta \\geq 0$ and $x - 0.8\\Delta \\leq L - 0.8\\Delta < L$, so the entire proposal interval $[x - \\Delta, x - 0.8\\Delta]$ lies inside $(0, L)$. Therefore the acceptance probability is $1$, and the position strictly decreases by at least $0.8\\Delta$ each accepted step:\n$$\nX_{n+1} = X_{n} + S_{n}, \\quad S_{n} \\in [-\\Delta, -0.8\\Delta], \\quad \\Rightarrow \\quad X_{n+1} \\leq X_{n} - 0.8\\Delta.\n$$\nIt follows that after at most $N$ steps with\n$$\nN > \\frac{X_{0} - \\Delta}{0.8\\Delta},\n$$\nthe chain reaches the region $X_{n} < \\Delta$.\n\n2) If $x \\in (0.8\\Delta, \\Delta)$, then part of the proposal interval falls outside $(0, L)$. The accepted portion is $y \\in (0, x - 0.8\\Delta]$, whose length is $x - 0.8\\Delta$. The total proposal length is $\\Delta - 0.8\\Delta = 0.2\\Delta$. Hence the acceptance probability is\n$$\np_{\\text{acc}}(x) = \\frac{x - 0.8\\Delta}{0.2\\Delta}, \\quad x \\in (0.8\\Delta, \\Delta),\n$$\nand, conditional on acceptance, $y$ is uniform on $(0, x - 0.8\\Delta]$. Any accepted move from this region lands in\n$$\ny \\in (0, x - 0.8\\Delta] \\subset (0, 0.2\\Delta],\n$$\nwhich lies strictly below $0.8\\Delta$. If a move is rejected, the position stays at $x$ and another proposal is drawn. Since $p_{\\text{acc}}(x) > 0$ for $x \\in (0.8\\Delta, \\Delta)$, with probability one an accepted move eventually occurs, sending the chain into $(0, 0.2\\Delta]$.\n\n3) If $x \\leq 0.8\\Delta$, then every proposal satisfies $S \\leq -0.8\\Delta \\leq -x$, so $y = x + S \\leq 0$ and is rejected with probability $1$. Thus\n$$\nX_{n+1} = X_{n} \\quad \\text{almost surely},\n$$\nso every $x \\in (0, 0.8\\Delta]$ is an absorbing state.\n\nCombining these facts: starting from any $x \\in (0, L)$, the chain decreases monotonically while $x \\geq \\Delta$, reaches $(0.8\\Delta, \\Delta)$ in finitely many steps, and then with probability one takes an accepted step into $(0, 0.2\\Delta] \\subset (0, 0.8\\Delta]$. From that moment on it remains fixed forever. Therefore, in the long-time limit, the time-averaged distribution $P(x)$ concentrates at a single location in $(0, 0.8\\Delta]$ near the left boundary $x = 0$, determined by the last accepted step. Across an ensemble of runs, $P(x)$ is strongly peaked near the boundary $x = 0$. It is not uniform, not centered, not double-peaked, and the particle does not remain at its initial position.\n\nThe correct choice is that the distribution will be strongly peaked at or near one of the boundaries (in this specific case, near $x = 0$).", "answer": "$$\\boxed{C}$$", "id": "1964972"}]}