{"hands_on_practices": [{"introduction": "To begin, we'll walk through the Metropolis algorithm by hand, demystifying the process step-by-step. This exercise considers a single classical particle moving in a one-dimensional potential well, a fundamental scenario in statistical mechanics. By manually calculating the energy changes and applying the probabilistic acceptance rule, $\\min(1, \\exp(-\\Delta V / k_B T))$, for a short sequence of proposed moves, you will gain a concrete understanding of how the algorithm generates a trajectory that correctly samples the system's states at a given temperature [@problem_id:2005962].", "problem": "A single classical particle moves in one dimension under the influence of a potential given by $V(x) = x^4 - 2x^2$. The particle is in thermal equilibrium with a heat bath at a temperature $T$. We wish to estimate its average potential energy, $\\langle V \\rangle$, by performing a small Monte Carlo simulation using the Metropolis algorithm.\n\nThe simulation proceeds in discrete steps. Starting from an initial position $x_0$, a new position $x_{new}$ is proposed at each step $i$ by taking a random step $\\delta_i$: $x_{new} = x_{old} + \\delta_i$. The change in potential energy is $\\Delta V = V(x_{new}) - V(x_{old})$. The proposed move is accepted with a probability $P_{acc}$ given by:\n$$P_{acc} = \\min\\left(1, \\exp\\left(-\\frac{\\Delta V}{k_B T}\\right)\\right)$$\nTo decide whether to accept the move, a random number $r_i$, drawn uniformly from the interval $[0, 1)$, is compared to $P_{acc}$. If $r_i < P_{acc}$, the move is accepted, and the particle's new position is $x_i = x_{new}$. If $r_i \\ge P_{acc}$, the move is rejected, and the particle remains at its old position, so $x_i = x_{old}$. Note that in either case, the configuration (either the new or the repeated old one) is added to the trajectory for calculating averages.\n\nFor this simulation, use the following parameters:\n- The thermal energy is $k_B T = 1.0$ in arbitrary units of energy. The potential $V(x)$ is also expressed in these same units.\n- The initial position of the particle is $x_0 = 1.0$.\n- You will simulate 4 steps (from $i=1$ to $i=4$).\n- The sequence of random step displacements is: $\\delta_1 = 0.40$, $\\delta_2 = -0.30$, $\\delta_3 = 0.10$, $\\delta_4 = -0.50$.\n- The sequence of random numbers for the acceptance check is: $r_1 = 0.50$, $r_2 = 0.20$, $r_3 = 0.90$, $r_4 = 0.10$.\n\nCalculate the average potential energy over the full trajectory of 5 states (the initial state at $i=0$ and the states after each of the 4 steps). Report your answer as a single real number, rounded to three significant figures.", "solution": "We use the Metropolis algorithm with potential $V(x)=x^{4}-2x^{2}$, thermal energy $k_{B}T=1$, initial position $x_{0}=1.0$, and the given sequences $\\delta_{i}$ and $r_{i}$. At each step, propose $x_{\\text{new}}=x_{\\text{old}}+\\delta_{i}$, compute $\\Delta V=V(x_{\\text{new}})-V(x_{\\text{old}})$, and accept with probability $P_{\\text{acc}}=\\min\\left(1,\\exp\\left(-\\frac{\\Delta V}{k_{B}T}\\right)\\right)=\\min\\left(1,\\exp(-\\Delta V)\\right)$ since $k_{B}T=1$.\n\nInitial state $i=0$: $x_{0}=1.0$, so\n$$\nV(x_{0})=1^{4}-2\\cdot 1^{2}=1-2=-1.\n$$\n\nStep $i=1$: $\\delta_{1}=0.40$. Propose $x_{\\text{new}}=1.0+0.40=1.40$.\n$$\nV(1.40)=1.40^{4}-2\\cdot 1.40^{2}=3.8416-3.92=-0.0784.\n$$\n$$\n\\Delta V=-0.0784-(-1)=0.9216,\\quad P_{\\text{acc}}=\\exp(-0.9216)\\approx 0.398.\n$$\nSince $r_{1}=0.50>0.398$, reject. Thus $x_{1}=1.0$ and $V(x_{1})=-1$.\n\nStep $i=2$: $\\delta_{2}=-0.30$. Propose $x_{\\text{new}}=1.0-0.30=0.70$.\n$$\nV(0.70)=0.70^{4}-2\\cdot 0.70^{2}=0.2401-0.98=-0.7399.\n$$\n$$\n\\Delta V=-0.7399-(-1)=0.2601,\\quad P_{\\text{acc}}=\\exp(-0.2601)\\approx 0.771.\n$$\nSince $r_{2}=0.20<0.771$, accept. Thus $x_{2}=0.70$ and $V(x_{2})=-0.7399$.\n\nStep $i=3$: $\\delta_{3}=0.10$. Propose $x_{\\text{new}}=0.70+0.10=0.80$.\n$$\nV(0.80)=0.80^{4}-2\\cdot 0.80^{2}=0.4096-1.28=-0.8704.\n$$\n$$\n\\Delta V=-0.8704-(-0.7399)=-0.1305.\n$$\nSince $\\Delta V<0$, $P_{\\text{acc}}=1$, so accept. Thus $x_{3}=0.80$ and $V(x_{3})=-0.8704$.\n\nStep $i=4$: $\\delta_{4}=-0.50$. Propose $x_{\\text{new}}=0.80-0.50=0.30$.\n$$\nV(0.30)=0.30^{4}-2\\cdot 0.30^{2}=0.0081-0.18=-0.1719.\n$$\n$$\n\\Delta V=-0.1719-(-0.8704)=0.6985,\\quad P_{\\text{acc}}=\\exp(-0.6985)\\approx 0.498.\n$$\nSince $r_{4}=0.10<0.498$, accept. Thus $x_{4}=0.30$ and $V(x_{4})=-0.1719$.\n\nThe trajectory potentials are\n$$\nV(x_{0})=-1,\\quad V(x_{1})=-1,\\quad V(x_{2})=-0.7399,\\quad V(x_{3})=-0.8704,\\quad V(x_{4})=-0.1719.\n$$\nSum:\n$$\nS=-1-1-0.7399-0.8704-0.1719=-3.7822.\n$$\nAverage over $5$ states:\n$$\n\\langle V\\rangle=\\frac{S}{5}=\\frac{-3.7822}{5}=-0.75644\\approx -0.756\\ \\text{(to three significant figures)}.\n$$", "answer": "$$\\boxed{-0.756}$$", "id": "2005962"}, {"introduction": "Having seen the algorithm in action for a continuous system, we now turn to a common application in condensed matter physics: discrete spin models. This problem uses a simplified model of a magnetic material, where spins on a lattice interact with their neighbors [@problem_id:2006007]. You will focus on a single, crucial step—calculating the energy change and acceptance probability for flipping one spin—to see how the Metropolis algorithm governs the thermal fluctuations in an interacting many-body system.", "problem": "Consider a simplified model of a one-dimensional magnetic system composed of a ring of three spins, labeled $S_1, S_2,$ and $S_3$. Each spin is a three-state variable, capable of taking values from the set $\\{-1, 0, 1\\}$. The total energy of the system is described by the Hamiltonian $E = -J \\sum_{\\langle i,j \\rangle} S_i S_j$, where $J$ is a positive coupling constant representing the interaction strength. The sum is taken over all nearest-neighbor pairs. Due to the ring geometry, the nearest-neighbor pairs are $(S_1, S_2)$, $(S_2, S_3)$, and $(S_3, S_1)$.\n\nThe system is in thermal equilibrium with a heat bath at a constant temperature $T$. Its state evolves according to the Metropolis algorithm. Suppose the system is currently in the microstate specified by $(S_1, S_2, S_3) = (1, 1, 0)$. A trial move is proposed in which the spin at site 2 is changed from $S_2=1$ to a new state $S'_2 = -1$, while the other spins remain unchanged. The proposed new microstate is thus $(1, -1, 0)$.\n\nCalculate the probability of accepting this trial move. Your answer should be a closed-form analytic expression in terms of the coupling constant $J$, the temperature $T$, and the Boltzmann constant $k_B$.", "solution": "The Hamiltonian is given by\n$$\nE=-J\\sum_{\\langle i,j\\rangle}S_{i}S_{j},\n$$\nwith nearest-neighbor pairs $(S_{1},S_{2})$, $(S_{2},S_{3})$, and $(S_{3},S_{1})$ on a ring.\n\nFor the initial microstate $(S_{1},S_{2},S_{3})=(1,1,0)$, the energy is\n$$\nE_{\\text{old}}=-J\\left(S_{1}S_{2}+S_{2}S_{3}+S_{3}S_{1}\\right)\n=-J\\left(1\\cdot 1+1\\cdot 0+0\\cdot 1\\right)=-J.\n$$\n\nFor the proposed microstate $(S_{1},S_{2}',S_{3})=(1,-1,0)$, the energy is\n$$\nE_{\\text{new}}=-J\\left(1\\cdot(-1)+(-1)\\cdot 0+0\\cdot 1\\right)=+J.\n$$\n\nThe energy change is\n$$\n\\Delta E=E_{\\text{new}}-E_{\\text{old}}=J-(-J)=2J.\n$$\n\nThe Metropolis acceptance probability is\n$$\nP_{\\text{acc}}=\\min\\!\\left(1,\\exp\\!\\left(-\\frac{\\Delta E}{k_{B}T}\\right)\\right).\n$$\nSince $\\Delta E=2J>0$, this becomes\n$$\nP_{\\text{acc}}=\\exp\\!\\left(-\\frac{2J}{k_{B}T}\\right).\n$$", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{2J}{k_{B}T}\\right)}$$", "id": "2006007"}, {"introduction": "Our final practice explores a more subtle but critical aspect of designing Monte Carlo simulations: the choice of the move set. Using a 2D lattice gas model, a versatile tool for simulating phenomena like adsorption and diffusion, you will compare two different ways to propose a new state [@problem_id:2005984]. This exercise highlights how different microscopic moves can have vastly different acceptance probabilities and reveals the important implications of physical principles, such as particle indistinguishability, in a computational context.", "problem": "A computational model is used to simulate the behavior of a thin film material, which is simplified as a 2D lattice gas. The system consists of a $4 \\times 4$ square lattice with periodic boundary conditions, meaning the right edge of the lattice wraps around to the left edge, and the top edge wraps around to the bottom. On this lattice, there are $M=4$ identical, indistinguishable particles. The total energy of the system is determined by the interactions between particles on adjacent sites. The energy is given by $E = -\\epsilon \\sum_{\\langle i,j \\rangle} n_i n_j$, where $\\epsilon$ is a positive constant representing the bond energy, the sum is over all unique nearest-neighbor pairs of sites $\\langle i,j \\rangle$, and $n_k$ is the occupation number of site $k$ ($n_k=1$ if occupied, $n_k=0$ if empty). The system is maintained at a constant temperature $T$, such that the dimensionless quantity $\\frac{\\epsilon}{k_B T}$ is equal to $2.0$, where $k_B$ is the Boltzmann constant.\n\nThe simulation starts from an initial configuration, denoted $C_0$, where the four particles are located at sites with coordinates (1,1), (1,2), (2,1), and (4,4). The coordinates (row, column) are 1-indexed. From this initial state, two different microscopic moves are proposed and their acceptance probabilities are evaluated using the Metropolis algorithm.\n\n- **Move A:** The particle at site (1,2) is proposed to move to the empty site (3,3).\n- **Move B:** A swap is proposed between the particle at site (1,1) and the particle at site (4,4).\n\nCalculate the ratio of the acceptance probability of Move A to that of Move B, that is, $P_{\\text{acc,A}} / P_{\\text{acc,B}}$. Round your final answer to three significant figures.", "solution": "The problem asks for the ratio of the Metropolis acceptance probabilities for two different proposed moves, A and B, starting from the same initial configuration $C_0$. The acceptance probability $P_{\\text{acc}}$ for a move from a state with energy $E_i$ to a state with energy $E_f$ is given by $P_{\\text{acc}} = \\min(1, \\exp(-\\Delta E/k_B T))$, where $\\Delta E = E_f - E_i$.\n\nFirst, we must calculate the energy of the initial configuration, $C_0$. The particles are located at sites (1,1), (1,2), (2,1), and (4,4). The energy is $E = -\\epsilon$ times the number of nearest-neighbor bonds. We must check all occupied sites for occupied neighbors, taking into account the periodic boundary conditions on the $4 \\times 4$ lattice.\n- The neighbors of site (1,1) are (1,2), (2,1), (1,4), and (4,1). The occupied neighbors are (1,2) and (2,1).\n- The neighbors of site (1,2) are (1,1), (2,2), (1,3), and (4,2). The only occupied neighbor is (1,1).\n- The neighbors of site (2,1) are (1,1), (2,2), (3,1), and (4,1). The only occupied neighbor is (1,1).\n- The neighbors of site (4,4) are (4,3), (1,4), (4,1), and (3,4). None of these are occupied.\nThe unique bonds are between ((1,1), (1,2)) and ((1,1), (2,1)). There are 2 such bonds.\nSo, the initial energy is $E_0 = -2\\epsilon$.\n\nNext, we analyze Move A. a particle moves from (1,2) to (3,3). The new configuration, $C_A$, has particles at (1,1), (2,1), (3,3), and (4,4). We calculate the energy of this new state, $E_A$.\n- The neighbors of (1,1) are (1,2), (2,1), (1,4), (4,1). The only occupied neighbor is (2,1).\n- The neighbors of (2,1) are (1,1), (2,2), (3,1), (4,1). The only occupied neighbor is (1,1).\n- The sites (3,3) and (4,4) have no occupied neighbors.\nThe only unique bond is between (1,1) and (2,1). There is 1 such bond.\nSo, the energy of configuration $C_A$ is $E_A = -1\\epsilon = -\\epsilon$.\n\nThe change in energy for Move A is $\\Delta E_A = E_A - E_0 = (-\\epsilon) - (-2\\epsilon) = \\epsilon$.\nThe acceptance probability for Move A is $P_{\\text{acc,A}} = \\min(1, \\exp(-\\Delta E_A / k_B T))$. Since $\\epsilon>0$, $\\Delta E_A > 0$, so the probability is less than 1.\n$P_{\\text{acc,A}} = \\exp(-\\epsilon / k_B T)$.\n\nNow, we analyze Move B. This move proposes to swap the particle at (1,1) with the particle at (4,4). The problem states that the particles are identical and indistinguishable. Swapping two indistinguishable particles does not produce a new physical configuration. The set of occupied sites remains {(1,1), (1,2), (2,1), (4,4)}, which is identical to the initial configuration $C_0$.\nTherefore, the final configuration $C_B$ is the same as the initial configuration $C_0$.\nThe final energy $E_B$ is equal to the initial energy $E_0$.\nThe change in energy for Move B is $\\Delta E_B = E_B - E_0 = E_0 - E_0 = 0$.\nThe acceptance probability for Move B is $P_{\\text{acc,B}} = \\min(1, \\exp(-\\Delta E_B / k_B T)) = \\min(1, \\exp(0)) = \\min(1,1) = 1$.\n\nFinally, we calculate the required ratio, $R = P_{\\text{acc,A}} / P_{\\text{acc,B}}$.\n$R = \\frac{\\exp(-\\epsilon / k_B T)}{1} = \\exp(-\\epsilon / k_B T)$.\nWe are given that the dimensionless quantity $\\frac{\\epsilon}{k_B T} = 2.0$.\nSubstituting this value, we get $R = \\exp(-2.0)$.\n\nTo get the numerical answer, we compute the value and round to three significant figures.\n$R = \\exp(-2.0) \\approx 0.135335...$\nRounding to three significant figures gives $0.135$.", "answer": "$$\\boxed{0.135}$$", "id": "2005984"}]}