{"hands_on_practices": [{"introduction": "Molecular dynamics simulations often require maintaining a constant temperature to mimic experimental conditions. The Berendsen thermostat provides an intuitive and computationally simple way to achieve this by weakly coupling the system to an external heat bath. This practice explores the core parameter of this method, the time coupling constant $\\tau_T$, which dictates the strength of this coupling. By calculating the temperature change for different values of $\\tau_T$, you will gain a hands-on understanding of how to tune this parameter to ensure a stable and realistic simulation without introducing artificial oscillations. [@problem_id:2013279]", "problem": "In molecular dynamics (MD) simulations, a thermostat is an algorithm used to control the temperature of the simulated system. One common method is the Berendsen thermostat, which weakly couples the system to an external heat bath with a fixed target temperature, $T_0$. This is achieved by rescaling the velocities of all particles at each timestep, $\\Delta t$, by a common factor, $\\lambda$.\n\nThe temperature of the system is proportional to its total kinetic energy. Therefore, rescaling the velocities by $\\lambda$ changes the kinetic energy by $\\lambda^2$, and consequently, the temperature is also scaled by $\\lambda^2$. The scaling factor is calculated using the following formula:\n$$ \\lambda^2 = 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T} - 1 \\right) $$\nwhere $T$ is the instantaneous temperature of the system at the beginning of the timestep, and $\\tau_T$ is the time coupling constant that determines how quickly the system's temperature relaxes towards the target temperature. A smaller $\\tau_T$ implies a stronger coupling to the heat bath and a faster temperature relaxation.\n\nA researcher is simulating a system of argon atoms. At a particular point in the simulation, the system's temperature is measured to be $T = 360.0 \\text{ K}$. The target temperature is set to $T_0 = 300.0 \\text{ K}$, and the simulation timestep is $\\Delta t = 2.0 \\text{ fs}$. For reference, 1 picosecond (ps) = 1000 femtoseconds (fs).\n\nThe researcher wants to understand how the choice of the coupling constant affects the temperature evolution. They consider two scenarios: a \"strong\" coupling with $\\tau_T^{\\text{strong}} = 0.4 \\text{ ps}$ and a \"weak\" coupling with $\\tau_T^{\\text{weak}} = 4.0 \\text{ ps}$. Calculate the expected temperature of the system after one timestep, $T(t+\\Delta t)$, for both the strong and weak coupling scenarios.\n\nWhich of the following options correctly gives the pair of temperatures, $(T_{\\text{strong}}(t+\\Delta t), T_{\\text{weak}}(t+\\Delta t))$? All temperatures are in Kelvin (K).\n\nA. (359.7 K, 359.97 K)\n\nB. (360.3 K, 360.03 K)\n\nC. (300.0 K, 300.0 K)\n\nD. (363.0 K, 360.3 K)\n\nE. (357.0 K, 359.7 K)", "solution": "The problem asks for the temperature of the system after a single timestep, $T(t+\\Delta t)$, under two different thermostat coupling constants, $\\tau_T^{\\text{strong}}$ and $\\tau_T^{\\text{weak}}$.\n\nThe temperature at the new timestep, $T(t+\\Delta t)$, is obtained by scaling the current temperature, $T(t)$, by the Berendsen scaling factor $\\lambda^2$.\n$$ T(t+\\Delta t) = \\lambda^2 T(t) $$\nThe formula for the scaling factor is given as:\n$$ \\lambda^2 = 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) $$\nSubstituting the expression for $\\lambda^2$ into the temperature update equation, we get:\n$$ T(t+\\Delta t) = T(t) \\left[ 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) \\right] $$\nThis expression can be simplified by distributing $T(t)$:\n$$ T(t+\\Delta t) = T(t) + T(t) \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) $$\n$$ T(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T} \\left( T(t) \\frac{T_0}{T(t)} - T(t) \\right) $$\n$$ T(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T} (T_0 - T(t)) $$\nThis simplified formula gives the new temperature directly from the temperature difference. We will now use this formula with the given parameters.\n\nThe given parameters are:\nCurrent temperature, $T(t) = 360.0 \\text{ K}$\nTarget temperature, $T_0 = 300.0 \\text{ K}$\nTimestep, $\\Delta t = 2.0 \\text{ fs}$\n\nWe need to ensure consistent units for time. We are given $\\tau_T$ in picoseconds (ps) and $\\Delta t$ in femtoseconds (fs). We use the conversion 1 ps = 1000 fs.\nSo, $\\Delta t = 2.0 \\text{ fs} = 0.0020 \\text{ ps}$.\n\n**Case 1: Strong coupling**\nFor the strong coupling scenario, $\\tau_T^{\\text{strong}} = 0.4 \\text{ ps}$.\nFirst, we calculate the dimensionless ratio $\\frac{\\Delta t}{\\tau_T^{\\text{strong}}}$:\n$$ \\frac{\\Delta t}{\\tau_T^{\\text{strong}}} = \\frac{0.0020 \\text{ ps}}{0.4 \\text{ ps}} = 0.005 $$\nNow, we calculate the temperature at the next step, $T_{\\text{strong}}(t+\\Delta t)$:\n$$ T_{\\text{strong}}(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T^{\\text{strong}}} (T_0 - T(t)) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} + 0.005 \\times (300.0 \\text{ K} - 360.0 \\text{ K}) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} + 0.005 \\times (-60.0 \\text{ K}) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} - 0.3 \\text{ K} $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 359.7 \\text{ K} $$\n\n**Case 2: Weak coupling**\nFor the weak coupling scenario, $\\tau_T^{\\text{weak}} = 4.0 \\text{ ps}$.\nFirst, we calculate the dimensionless ratio $\\frac{\\Delta t}{\\tau_T^{\\text{weak}}}$:\n$$ \\frac{\\Delta t}{\\tau_T^{\\text{weak}}} = \\frac{0.0020 \\text{ ps}}{4.0 \\text{ ps}} = 0.0005 $$\nNow, we calculate the temperature at the next step, $T_{\\text{weak}}(t+\\Delta t)$:\n$$ T_{\\text{weak}}(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T^{\\text{weak}}} (T_0 - T(t)) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} + 0.0005 \\times (300.0 \\text{ K} - 360.0 \\text{ K}) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} + 0.0005 \\times (-60.0 \\text{ K}) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} - 0.03 \\text{ K} $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 359.97 \\text{ K} $$\n\nThe calculated pair of temperatures is $(359.7 \\text{ K}, 359.97 \\text{ K})$. This corresponds to option A. As expected, the stronger coupling (smaller $\\tau_T$) results in a larger temperature change in a single step, moving the system's temperature more quickly towards the target temperature.", "answer": "$$\\boxed{A}$$", "id": "2013279"}, {"introduction": "While controlling system-wide properties like total kinetic energy seems like a straightforward way to thermostat a system, it can lead to unphysical artifacts. This exercise explores the famous \"flying ice cube\" problem, a classic cautionary tale in molecular simulation that arises from such a naive approach. By analyzing this extreme scenario, you will see how energy can be improperly partitioned into center-of-mass motion, violating the fundamental principle of equipartition and failing to generate a correct thermodynamic ensemble. [@problem_id:2013248]", "problem": "A molecular dynamics simulation is performed on a system of $N$ identical, non-interacting particles, each of mass $m$. The simulation employs a primitive thermostat that strictly enforces a constant total kinetic energy for the system. Initially, at time $t=0$, the particles are distributed in a way that corresponds to thermal equilibrium at a temperature $T_0$, and the center of mass of the entire system is at rest. Due to numerical inaccuracies inherent in the thermostat's algorithm, the system evolves into a non-physical state known as a \"flying ice cube\". In this final, extreme state, all relative motion between the particles has ceased, and they move together as a single rigid body. The total kinetic energy of the system is the same as its initial value. Determine the final speed of the system's center of mass. Express your answer in terms of $m$, $T_0$, and the Boltzmann constant $k_B$.", "solution": "Let the particle velocities be $\\{\\mathbf{v}_{i}\\}_{i=1}^{N}$, each of mass $m$. The total kinetic energy is\n$$\nK=\\sum_{i=1}^{N}\\frac{1}{2}m|\\mathbf{v}_{i}|^{2}.\n$$\nAt thermal equilibrium at temperature $T_{0}$ for $N$ non-interacting point particles in three spatial dimensions, equipartition of energy gives\n$$\nK=\\frac{3}{2}N k_{B}T_{0}.\n$$\nThe primitive thermostat enforces $K$ to remain equal to its initial value, so the total kinetic energy at all later times is also $K=\\frac{3}{2}N k_{B}T_{0}$.\n\nIn the final flying-ice-cube state, all relative motion has ceased and all particles move together with the same velocity $\\mathbf{V}_{\\mathrm{cm}}$. The system behaves as a rigid body of total mass $M=Nm$, so its kinetic energy is purely center-of-mass translational:\n$$\nK=\\frac{1}{2}M|\\mathbf{V}_{\\mathrm{cm}}|^{2}=\\frac{1}{2}(Nm)V_{\\mathrm{cm}}^{2}.\n$$\nEquating this to the conserved kinetic energy,\n$$\n\\frac{1}{2}(Nm)V_{\\mathrm{cm}}^{2}=\\frac{3}{2}N k_{B}T_{0},\n$$\nand solving for $V_{\\mathrm{cm}}$ yields\n$$\nm V_{\\mathrm{cm}}^{2}=3 k_{B}T_{0}\\quad\\Rightarrow\\quad V_{\\mathrm{cm}}=\\sqrt{\\frac{3 k_{B}T_{0}}{m}}.\n$$\nThis result is independent of $N$.", "answer": "$$\\boxed{\\sqrt{\\frac{3 k_{B} T_{0}}{m}}}$$", "id": "2013248"}, {"introduction": "Moving beyond simple rescaling algorithms, the Langevin thermostat offers a more physically rigorous approach by modeling the interactions with a solvent heat bath. It introduces two key forces: a frictional drag and a random stochastic force, representing dissipation and thermal fluctuations, respectively. This problem delves into the profound connection between these two forces, an example of the fluctuation-dissipation theorem. By deriving the relationship between the friction coefficient and the properties of the random force, you will uncover the deep statistical mechanics principles that ensure a system coupled to a Langevin thermostat correctly samples the canonical ensemble. [@problem_id:2013289]", "problem": "A single spherical nanoparticle of mass $m$ is suspended in a stationary fluid. Its one-dimensional motion along the x-axis is studied. The system is maintained at a constant equilibrium temperature $T$. The nanoparticle's velocity $v(t)$ is well-described by the Langevin equation: $m \\frac{dv}{dt} = F_{drag} + F_{stochastic}$.\n\nThe drag force from the fluid is given by $F_{drag} = -\\gamma v$, where $\\gamma$ is a positive constant known as the friction coefficient. The term $F_{stochastic}(t)$ represents a rapidly fluctuating stochastic force due to random collisions with the fluid molecules. This force has a zero mean, $\\langle F_{stochastic}(t) \\rangle = 0$ for all $t$.\n\nA key property of the stochastic force is its time-autocorrelation. Experimental measurements have determined the value of the integrated autocorrelation, which is defined as:\n$$ \\Sigma = \\int_{-\\infty}^{\\infty} \\langle F_{stochastic}(0) F_{stochastic}(\\tau) \\rangle d\\tau $$\nwhere $\\langle \\dots \\rangle$ denotes an ensemble average.\n\nAssuming the system is in thermal equilibrium, find an analytic expression for the equilibrium temperature $T$. Your answer should be expressed in terms of $\\gamma$, $\\Sigma$, and the Boltzmann constant $k_B$.", "solution": "We start from the one-dimensional Langevin equation\n$$\nm \\frac{dv}{dt}=-\\gamma v+F(t),\n$$\nwhere $F(t)\\equiv F_{stochastic}(t)$ is a zero-mean stationary random force with autocorrelation $C_{F}(\\tau)=\\langle F(0)F(\\tau)\\rangle$ and integrated autocorrelation\n$$\n\\Sigma=\\int_{-\\infty}^{\\infty}C_{F}(\\tau)\\,d\\tau.\n$$\nWe solve the linear stochastic differential equation in the stationary, causal form. The impulse response of the deterministic part is $h(t)=\\frac{1}{m}\\exp\\!\\left(-\\frac{\\gamma}{m}t\\right)H(t)$, where $H$ is the Heaviside step function, so the velocity is\n$$\nv(t)=\\int_{-\\infty}^{t}h(t-s)F(s)\\,ds=\\frac{1}{m}\\int_{-\\infty}^{t}\\exp\\!\\left(-\\frac{\\gamma}{m}(t-s)\\right)F(s)\\,ds.\n$$\nFor energy balance, multiply the Langevin equation by $v(t)$ and average:\n$$\nm\\,\\Big\\langle v\\frac{dv}{dt}\\Big\\rangle=-\\gamma\\langle v^{2}\\rangle+\\langle F(t)v(t)\\rangle.\n$$\nSince $\\frac{d}{dt}\\left(\\frac{1}{2}m\\langle v^{2}\\rangle\\right)=m\\langle v\\,\\frac{dv}{dt}\\rangle$, the steady state implies $\\frac{d}{dt}\\langle v^{2}\\rangle=0$, hence\n$$\n\\gamma\\langle v^{2}\\rangle=\\langle F(t)v(t)\\rangle.\n$$\nUsing the linear solution for $v(t)$,\n$$\n\\langle F(t)v(t)\\rangle=\\frac{1}{m}\\int_{-\\infty}^{t}\\exp\\!\\left(-\\frac{\\gamma}{m}(t-s)\\right)\\langle F(t)F(s)\\rangle\\,ds.\n$$\nBy stationarity, $\\langle F(t)F(s)\\rangle=C_{F}(t-s)$. Let $\\tau=t-s\\geq 0$, so $ds=-d\\tau$ and the integration limits map to $\\tau\\in[0,\\infty)$. Then\n$$\n\\langle F(t)v(t)\\rangle=\\frac{1}{m}\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau.\n$$\nTherefore,\n$$\n\\gamma\\langle v^{2}\\rangle=\\frac{1}{m}\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau.\n$$\nAt thermal equilibrium, equipartition gives\n$$\n\\frac{1}{2}m\\langle v^{2}\\rangle=\\frac{1}{2}k_{B}T\\quad\\Rightarrow\\quad \\langle v^{2}\\rangle=\\frac{k_{B}T}{m}.\n$$\nSubstituting this into the balance relation and multiplying both sides by $m$ yields\n$$\n\\gamma k_{B}T=\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau.\n$$\nThe force is described as rapidly fluctuating, so its correlation time is much shorter than the relaxation time $m/\\gamma$. In this limit, the exponential factor can be approximated by unity over the domain where $C_{F}(\\tau)$ is appreciable:\n$$\n\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau\\approx\\int_{0}^{\\infty}C_{F}(\\tau)\\,d\\tau.\n$$\nSince $C_{F}(\\tau)$ is an even function for a real stationary process, we have\n$$\n\\Sigma=\\int_{-\\infty}^{\\infty}C_{F}(\\tau)\\,d\\tau=2\\int_{0}^{\\infty}C_{F}(\\tau)\\,d\\tau.\n$$\nHence,\n$$\n\\gamma k_{B}T\\approx\\frac{\\Sigma}{2}.\n$$\nEquivalently, in the white-noise limit $C_{F}(\\tau)=2\\gamma k_{B}T\\,\\delta(\\tau)$, the integral of $C_{F}$ over all $\\tau$ is exactly $\\Sigma=2\\gamma k_{B}T$, leading to the same result. Solving for $T$ gives the equilibrium temperature\n$$\nT=\\frac{\\Sigma}{2\\gamma k_{B}}.\n$$", "answer": "$$\\boxed{\\frac{\\Sigma}{2\\gamma k_{B}}}$$", "id": "2013289"}]}