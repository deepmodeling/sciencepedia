{"hands_on_practices": [{"introduction": "We begin with a foundational model in statistical physics: a collection of classical harmonic oscillators. This exercise asks you to compute the heat capacity, a key thermodynamic quantity, using the tools of the canonical ensemble. By demonstrating that the result aligns with the equipartition theorem, this practice [@problem_id:1965282] reinforces core calculational techniques and shows how a single ensemble can yield the correct macroscopic properties in the thermodynamic limit.", "problem": "A one-dimensional solid is modeled as a chain of $N$ identical, independent classical harmonic oscillators. The oscillators are distinguishable by their fixed positions. Each has mass $m$ and natural angular frequency $\\omega$. In the thermodynamic limit, where the number of oscillators $N$ is very large, the macroscopic thermal properties like temperature and heat capacity become well-defined.\n\nDetermine the heat capacity per oscillator, $C/N$, for this system in the thermodynamic limit. Express your answer solely in terms of the Boltzmann constant $k_B$.", "solution": "We model a single classical harmonic oscillator with Hamiltonian\n$$\nH(x,p)=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega^{2}x^{2}.\n$$\nIn the canonical ensemble at temperature $T$, define $\\beta=\\frac{1}{k_{B}T}$. The one-oscillator partition function is\n$$\nZ_{1}=\\frac{1}{h}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}\\exp\\!\\big(-\\beta H(x,p)\\big)\\,dx\\,dp=\\frac{1}{h}\\left[\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\beta\\frac{p^{2}}{2m}\\right)dp\\right]\\left[\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\beta\\frac{1}{2}m\\omega^{2}x^{2}\\right)dx\\right].\n$$\nEvaluating the Gaussian integrals,\n$$\n\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\beta\\frac{p^{2}}{2m}\\right)dp=\\sqrt{\\frac{2\\pi m}{\\beta}},\\qquad\n\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\beta\\frac{1}{2}m\\omega^{2}x^{2}\\right)dx=\\sqrt{\\frac{2\\pi}{\\beta m\\omega^{2}}},\n$$\nso\n$$\nZ_{1}=\\frac{1}{h}\\cdot\\frac{2\\pi}{\\beta\\omega}.\n$$\nThe mean energy of one oscillator is\n$$\nU_{1}=-\\frac{\\partial}{\\partial\\beta}\\ln Z_{1}=-\\frac{\\partial}{\\partial\\beta}\\left[\\ln\\!\\left(\\frac{2\\pi}{h\\omega}\\right)-\\ln\\beta\\right]=\\frac{1}{\\beta}=k_{B}T.\n$$\nFor $N$ independent, distinguishable oscillators, $Z_{N}=Z_{1}^{N}$ and the total internal energy is $U=NU_{1}=Nk_{B}T$. The heat capacity is\n$$\nC=\\frac{\\partial U}{\\partial T}=N k_{B},\n$$\nhence the heat capacity per oscillator in the thermodynamic limit is\n$$\n\\frac{C}{N}=k_{B}.\n$$\nThis result is consistent with the equipartition theorem: a one-dimensional harmonic oscillator has two quadratic degrees of freedom, each contributing $\\frac{1}{2}k_{B}T$ to the mean energy, giving $U_{1}=k_{B}T$ and thus $C/N=k_{B}$.", "answer": "$$\\boxed{k_{B}}$$", "id": "1965282"}, {"introduction": "Having established how a single ensemble works, we now tackle the concept of equivalence directly by comparing two different descriptions of an ideal gas: one at fixed volume (NVT ensemble) and one at fixed pressure where volume fluctuates (NPT ensemble). This problem [@problem_id:1965260] guides you to show that in the limit of a large system, the average volume in the NPT ensemble becomes indistinguishable from the fixed volume in the corresponding NVT ensemble. This provides a concrete demonstration of why different ensembles yield the same thermodynamics for macroscopic properties.", "problem": "Consider a system of $N$ identical, non-interacting particles of a classical monatomic gas. We will compare two different statistical descriptions of this system.\n\nFirst, consider the system described by the Isothermal-Isobaric (NPT) ensemble, which is in thermal and mechanical contact with a large reservoir at a constant temperature $T$ and constant pressure $P_0$. In this ensemble, the particle number $N$ is fixed, but the volume of the system, $V$, is a fluctuating quantity.\n\nSecond, consider the same gas in a Canonical (NVT) ensemble, also with a fixed particle number $N$ and at the same temperature $T$. The volume of this second system is held fixed at a value $V_{NVT}$. This volume $V_{NVT}$ is specifically chosen such that the thermodynamic pressure calculated within the canonical ensemble is exactly equal to the pressure parameter $P_0$ of the NPT ensemble.\n\nThe canonical partition function for this ideal gas is given by the general form $Z_{NVT}(N,V,T) = C(N,T) \\cdot V^N$, where $C(N,T)$ is a function that depends on $N$ and $T$ but is independent of the volume $V$. The pressure in the canonical ensemble is given by the relation $P = k_B T \\left(\\frac{\\partial \\ln Z_{NVT}}{\\partial V}\\right)_{N,T}$, where $k_B$ is the Boltzmann constant.\n\nThe isothermal-isobaric partition function $\\Delta(N,P_0,T)$ is constructed from the canonical partition function via the relation $\\Delta(N,P_0,T) = \\int_0^\\infty \\exp(-\\frac{P_0 V}{k_B T}) Z_{NVT}(N,V,T) dV$. The average volume in the NPT ensemble is then found using $\\langle V \\rangle_{NPT} = -k_B T \\left(\\frac{\\partial \\ln \\Delta}{\\partial P_0}\\right)_{N,T}$.\n\nCalculate the value of the ratio $\\frac{\\langle V \\rangle_{NPT}}{V_{NVT}}$ in the thermodynamic limit, where $N \\rightarrow \\infty$. Your final answer should be a single numerical value.", "solution": "For the ideal classical gas with canonical partition function $Z_{NVT}(N,V,T)=C(N,T)\\,V^{N}$, the canonical pressure follows from\n$$\nP=k_{B}T\\left(\\frac{\\partial \\ln Z_{NVT}}{\\partial V}\\right)_{N,T}\n=k_{B}T\\left(\\frac{\\partial}{\\partial V}\\left[\\ln C(N,T)+N\\ln V\\right]\\right)\n=\\frac{N k_{B}T}{V}.\n$$\nImposing $P=P_{0}$ in the canonical ensemble yields\n$$\nV_{NVT}=\\frac{N k_{B}T}{P_{0}}.\n$$\nThe isothermal-isobaric partition function is\n$$\n\\Delta(N,P_{0},T)=\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{P_{0}V}{k_{B}T}\\right)Z_{NVT}(N,V,T)\\,dV\n=C(N,T)\\int_{0}^{\\infty}V^{N}\\exp(-\\alpha V)\\,dV,\n$$\nwhere $\\alpha\\equiv P_{0}/(k_{B}T)$. Using the standard Gamma-function integral $\\int_{0}^{\\infty}x^{N}\\exp(-\\alpha x)\\,dx=\\Gamma(N+1)\\alpha^{-(N+1)}$ gives\n$$\n\\Delta(N,P_{0},T)=C(N,T)\\,\\Gamma(N+1)\\,\\alpha^{-(N+1)}=C(N,T)\\,N!\\left(\\frac{k_{B}T}{P_{0}}\\right)^{N+1}.\n$$\nHence\n$$\n\\ln \\Delta=\\ln C(N,T)+\\ln(N!)+(N+1)\\ln\\!\\left(\\frac{k_{B}T}{P_{0}}\\right).\n$$\nThe NPT average volume is\n$$\n\\langle V\\rangle_{NPT}=-k_{B}T\\left(\\frac{\\partial \\ln \\Delta}{\\partial P_{0}}\\right)_{N,T}\n=-k_{B}T\\left(-(N+1)\\frac{1}{P_{0}}\\right)=\\frac{(N+1)k_{B}T}{P_{0}}.\n$$\nTherefore,\n$$\n\\frac{\\langle V\\rangle_{NPT}}{V_{NVT}}=\\frac{\\frac{(N+1)k_{B}T}{P_{0}}}{\\frac{N k_{B}T}{P_{0}}}=\\frac{N+1}{N}=1+\\frac{1}{N}.\n$$\nIn the thermodynamic limit $N\\to\\infty$, this ratio tends to $1$.", "answer": "$$\\boxed{1}$$", "id": "1965260"}, {"introduction": "In the previous exercise, we saw that volume fluctuations in the NPT ensemble become sharply peaked around the mean. This practice [@problem_id:1965273] explores the deeper meaning of these very fluctuations by connecting them to a macroscopic response function, the isothermal compressibility $\\kappa_T$. You will prove that the compressibility calculated from the magnitude of volume fluctuations yields the exact same result as that derived from the macroscopic equation of state, confirming one of the most powerful consequences of ensemble equivalence: the fluctuation-response theorem.", "problem": "For a system in thermal and mechanical equilibrium with its surroundings, its macroscopic properties can be calculated using different statistical mechanical ensembles. This problem explores the consistency of such calculations for the isothermal compressibility of a classical ideal gas.\n\nA classical ideal gas containing a large number $N$ of particles is held at a constant temperature $T$.\n\nFirst, consider the gas described by its macroscopic equation of state, $PV = Nk_B T$, where $V$ is the volume, $P$ is the pressure, and $k_B$ is the Boltzmann constant. From this, compute the isothermal compressibility, which is defined as $\\kappa_{T, \\text{eos}} = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T,N}$.\n\nSecond, consider the same gas as part of an Isobaric-Isothermal (NPT) ensemble, where the volume $V$ is a fluctuating quantity with an average value $\\langle V \\rangle$. The isothermal compressibility can also be derived from volume fluctuations via the relation $\\kappa_{T, \\text{fluct}} = \\frac{\\langle (\\Delta V)^2 \\rangle}{k_B T \\langle V \\rangle}$, where $\\langle (\\Delta V)^2 \\rangle = \\langle V^2 \\rangle - \\langle V \\rangle^2$ represents the mean-square fluctuation of the volume. A key result from statistical mechanics connects these fluctuations to a thermodynamic response function: $\\langle (\\Delta V)^2 \\rangle = -k_B T \\left(\\frac{\\partial \\langle V \\rangle}{\\partial P}\\right)_{T,N}$. In the thermodynamic limit (for large $N$), the average volume $\\langle V \\rangle$ in the NPT ensemble is equivalent to the thermodynamic volume $V$ from the equation of state.\n\nUsing the information and definitions provided, calculate the numerical value of the ratio $\\frac{\\kappa_{T, \\text{eos}}}{\\kappa_{T, \\text{fluct}}}$.", "solution": "We start from the ideal-gas equation of state $PV = N k_{B} T$. At fixed $T$ and $N$, solve for the volume as a function of pressure:\n$$\nV(P) = \\frac{N k_{B} T}{P}.\n$$\nDifferentiate with respect to $P$ at constant $T$ and $N$:\n$$\n\\left(\\frac{\\partial V}{\\partial P}\\right)_{T,N} = -\\frac{N k_{B} T}{P^{2}} = -\\frac{V}{P}.\n$$\nThe isothermal compressibility from the equation of state is defined as $\\kappa_{T,\\text{eos}} = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T,N}$, hence\n$$\n\\kappa_{T,\\text{eos}} = -\\frac{1}{V}\\left(-\\frac{V}{P}\\right) = \\frac{1}{P}.\n$$\n\nIn the isobaric-isothermal ensemble, the isothermal compressibility from fluctuations is given by $\\kappa_{T,\\text{fluct}} = \\frac{\\langle (\\Delta V)^{2}\\rangle}{k_{B} T \\langle V\\rangle}$, with the fluctuation-response relation\n$$\n\\langle (\\Delta V)^{2}\\rangle = - k_{B} T \\left(\\frac{\\partial \\langle V\\rangle}{\\partial P}\\right)_{T,N}.\n$$\nSubstituting this into the fluctuation expression yields\n$$\n\\kappa_{T,\\text{fluct}} = \\frac{- k_{B} T \\left(\\frac{\\partial \\langle V\\rangle}{\\partial P}\\right)_{T,N}}{k_{B} T \\langle V\\rangle} = -\\frac{1}{\\langle V\\rangle}\\left(\\frac{\\partial \\langle V\\rangle}{\\partial P}\\right)_{T,N}.\n$$\nIn the thermodynamic limit (large $N$), $\\langle V\\rangle = V$ from the equation of state, so\n$$\n\\kappa_{T,\\text{fluct}} = -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T,N} = \\frac{1}{P}.\n$$\nTherefore, both methods give the same result, and the ratio is\n$$\n\\frac{\\kappa_{T,\\text{eos}}}{\\kappa_{T,\\text{fluct}}} = \\frac{1/P}{1/P} = 1.\n$$", "answer": "$$\\boxed{1}$$", "id": "1965273"}]}