{"hands_on_practices": [{"introduction": "Before any simulation can begin, we must provide the computer with a precise geometric description of the material. This exercise focuses on identifying the minimal structural information required to define a periodic crystal, forming the very first step in any DFT calculation for solids [@problem_id:1768601]. Understanding these inputs bridges the gap between an abstract material concept and the concrete data needed for a computational model.", "problem": "A researcher is preparing to perform a first-principles calculation using Density Functional Theory (DFT) to determine the electronic properties of bulk crystalline silicon. In DFT calculations for periodic solids, the complex problem of a macroscopic crystal is simplified by focusing on a single, repeating unit cell and applying periodic boundary conditions. Before any electronic structure calculation can begin, the fundamental geometric arrangement of the atomic nuclei must be precisely defined. This structural information serves as the input that defines the potential in which the electrons move.\n\nFrom the list below, identify the two essential pieces of **structural** information that must be specified to uniquely define the crystal structure for the DFT calculation. Select two options.\n\nA. The total mass of the macroscopic silicon sample.\n\nB. The experimental value of the silicon band gap.\n\nC. The Bravais lattice vectors defining the periodic unit cell.\n\nD. The coordinates of the atoms within one unit cell (the basis).\n\nE. The temperature at which the crystal is held.\n\nF. The crystal's cleavage planes.", "solution": "In periodic DFT for crystals, the external potential experienced by electrons is generated by the nuclei arranged periodically. This periodicity is encoded through lattice translations and a basis of atoms within a primitive unit cell. The periodicity condition is expressed as $V_{\\text{ext}}(\\mathbf{r}+\\mathbf{R})=V_{\\text{ext}}(\\mathbf{r})$, where the Bravais lattice translation vectors are $\\mathbf{R}=n_{1}\\mathbf{a}_{1}+n_{2}\\mathbf{a}_{2}+n_{3}\\mathbf{a}_{3}$ with integers $n_{1},n_{2},n_{3}$ and primitive lattice vectors $\\mathbf{a}_{1},\\mathbf{a}_{2},\\mathbf{a}_{3}$. The nuclei within a unit cell are specified by a set of basis position vectors $\\{\\boldsymbol{\\tau}_{s}\\}$, typically given in fractional coordinates relative to $\\mathbf{a}_{i}$. The external potential can be written schematically as\n$$\nV_{\\text{ext}}(\\mathbf{r})=\\sum_{\\mathbf{R}}\\sum_{s} v_{s}\\!\\left(\\mathbf{r}-\\mathbf{R}-\\boldsymbol{\\tau}_{s}\\right),\n$$\nwhere $v_{s}$ is the (pseudo)potential associated with species $s$. Therefore, to uniquely define the crystal structure and hence $V_{\\text{ext}}(\\mathbf{r})$, one must specify:\n- The Bravais lattice via the primitive vectors $\\mathbf{a}_{1},\\mathbf{a}_{2},\\mathbf{a}_{3}$ (option C).\n- The atomic basis within the unit cell via coordinates $\\boldsymbol{\\tau}_{s}$ (option D).\n\nThe other options are not required structural inputs: the total mass of the macroscopic sample (A) does not define the periodic geometry; the band gap (B) is an electronic property typically computed from the structure; the temperature (E) can influence structure indirectly (e.g., thermal expansion) but is not itself a structural descriptor; cleavage planes (F) are derived from the crystal structure rather than defining it.", "answer": "$$\\boxed{CD}$$", "id": "1768601"}, {"introduction": "Once the crystal structure is defined, the calculation enters the Self-Consistent Field (SCF) cycle, the iterative engine that finds the ground-state electron density. This practice deconstructs this crucial computational loop, asking you to order the core steps correctly [@problem_id:1768566]. Mastering this sequence is fundamental to understanding how DFT programs converge on a solution.", "problem": "In the field of computational materials science, Kohn-Sham Density Functional Theory (DFT) is a powerful method for determining the electronic structure of materials. A central part of DFT calculations is an iterative process called the Self-Consistent Field (SCF) cycle, which aims to find the ground-state electron density.\n\nThis iterative cycle involves a sequence of specific computational steps that are repeated until a convergence criterion is met. Below are three of the core tasks performed within a single iteration, presented in alphabetical order:\n\n(A) Calculation of the output electron density, $n_{\\text{out}}(\\mathbf{r})$, by summing the squared magnitudes of the occupied single-particle orbitals.\n(B) Construction of the effective Kohn-Sham potential, $v_{\\text{eff}}(\\mathbf{r})$, which is a function of the input electron density from the current or previous iteration, $n_{\\text{in}}(\\mathbf{r})$.\n(C) Solution of the single-particle Kohn-Sham equations for the current effective potential to determine a new set of single-particle orbitals, $\\{\\psi_j(\\mathbf{r})\\}$.\n\nGiven an input density $n_{\\text{in}}(\\mathbf{r})$ at the start of an iteration, determine the correct chronological sequence of these three tasks to produce an output density $n_{\\text{out}}(\\mathbf{r})$ within that single iteration. Choose the correct sequence from the options below.\n\nA. (A) $\\rightarrow$ (B) $\\rightarrow$ (C)\n\nB. (B) $\\rightarrow$ (A) $\\rightarrow$ (C)\n\nC. (C) $\\rightarrow$ (A) $\\rightarrow$ (B)\n\nD. (B) $\\rightarrow$ (C) $\\rightarrow$ (A)\n\nE. (A) $\\rightarrow$ (C) $\\rightarrow$ (B)\n\nF. (C) $\\rightarrow$ (B) $\\rightarrow$ (A)", "solution": "The goal of the Self-Consistent Field (SCF) cycle in Density Functional Theory (DFT) is to find a ground-state electron density $n(\\mathbf{r})$ that is \"self-consistent\". This means that if we use this density as an input to the calculation, the output density produced by the calculation is the same as the input density. The process is iterative, starting with an initial guess and refining the density at each step until this condition is met. Let's analyze the logical dependencies between the three tasks to establish their correct order.\n\nThe iterative loop starts with a guess for the electron density, which we call the input density, $n_{\\text{in}}(\\mathbf{r})$.\n\nStep 1: The first task in the cycle must be to use this input density $n_{\\text{in}}(\\mathbf{r})$ to construct the quantities needed for the next step. The Kohn-Sham formalism states that the effective potential, $v_{\\text{eff}}(\\mathbf{r})$, is a functional of the electron density. Specifically, $v_{\\text{eff}}[n](\\mathbf{r}) = v_{\\text{ext}}(\\mathbf{r}) + v_{\\text{H}}[n](\\mathbf{r}) + v_{\\text{xc}}[n](\\mathbf{r})$, where the Hartree potential $v_{\\text{H}}$ and the exchange-correlation potential $v_{\\text{xc}}$ both depend on the density $n(\\mathbf{r})$. Therefore, the first logical step is to use $n_{\\text{in}}(\\mathbf{r})$ to calculate $v_{\\text{eff}}(\\mathbf{r})$. This corresponds to task (B).\n\nStep 2: Once the effective potential $v_{\\text{eff}}(\\mathbf{r})$ is known, it can be used to define the single-particle Kohn-Sham Hamiltonian, $\\hat{H}_{\\text{KS}} = -\\frac{\\hbar^2}{2m}\\nabla^2 + v_{\\text{eff}}(\\mathbf{r})$. The next step is to solve the eigenvalue problem for this Hamiltonian, which is the set of Kohn-Sham equations: $\\hat{H}_{\\text{KS}} \\psi_j(\\mathbf{r}) = \\epsilon_j \\psi_j(\\mathbf{r})$. Solving these equations yields the set of single-particle orbitals, $\\{\\psi_j(\\mathbf{r})\\}$, and their corresponding energies, $\\{\\epsilon_j\\}$. This corresponds to task (C). Task (C) must follow task (B) because it requires the potential calculated in (B).\n\nStep 3: After solving the Kohn-Sham equations, we have the orbitals $\\{\\psi_j(\\mathbf{r})\\}$. The fundamental principle of DFT is that the electron density can be constructed from these orbitals. For a system with $N$ electrons, the density is calculated by summing the probability densities of the $N$ lowest-energy (occupied) orbitals. This gives the output electron density, $n_{\\text{out}}(\\mathbf{r}) = \\sum_{j=1}^{N} |\\psi_j(\\mathbf{r})|^2$. This corresponds to task (A). Task (A) must follow task (C) because it requires the orbitals calculated in (C).\n\nTo summarize the flow within one iteration:\n1.  Start with $n_{\\text{in}}(\\mathbf{r})$.\n2.  Perform task (B): Use $n_{\\text{in}}(\\mathbf{r})$ to construct $v_{\\text{eff}}(\\mathbf{r})$.\n3.  Perform task (C): Use $v_{\\text{eff}}(\\mathbf{r})$ to solve for the orbitals $\\{\\psi_j(\\mathbf{r})\\}$.\n4.  Perform task (A): Use the orbitals $\\{\\psi_j(\\mathbf{r})\\}$ to calculate the output density $n_{\\text{out}}(\\mathbf{r})$.\n\nThe correct sequence of tasks is therefore (B) $\\rightarrow$ (C) $\\rightarrow$ (A). After this sequence, the SCF procedure would compare $n_{\\text{out}}(\\mathbf{r})$ to $n_{\\text{in}}(\\mathbf{r})$ to check for convergence. If not converged, a new $n_{\\text{in}}(\\mathbf{r})$ would be generated (often by mixing the old input and new output densities) and the cycle would repeat.\n\nLooking at the given options, the sequence (B) $\\rightarrow$ (C) $\\rightarrow$ (A) corresponds to option D.", "answer": "$$\\boxed{D}$$", "id": "1768566"}, {"introduction": "For most materials, calculating the behavior of every single electron is computationally immense, which is where approximations become essential. This problem introduces the powerful pseudopotential method, which simplifies calculations by replacing the chemically inert core electrons and the sharp nuclear potential with a smoother, effective potential [@problem_id:1768562]. This practice is key to a practical appreciation of the balance between accuracy and computational feasibility that defines modern materials simulation.", "problem": "A computational physicist is setting up a simulation for a crystalline silicon (Si) solid using Density Functional Theory (DFT), a powerful method for calculating the electronic structure of materials. In its natural state, a silicon atom has 14 electrons with the electronic configuration $1s^2 2s^2 2p^6 3s^2 3p^2$. The $1s^2 2s^2 2p^6$ electrons are considered \"core\" electrons, as they are tightly bound to the nucleus and do not significantly participate in chemical bonding. The remaining four $3s^2 3p^2$ electrons are \"valence\" electrons, which determine the material's chemical and electronic properties.\n\nTo make the calculation computationally tractable, the physicist employs the pseudopotential approximation. This approach modifies the fundamental problem being solved.\n\nWhich of the following statements accurately describe the primary role and computational consequences of using a pseudopotential in this DFT calculation? Select all that apply.\n\nA. The pseudopotential replaces the strong, singular Coulomb potential of the silicon nucleus and the explicit treatment of the 10 core electrons with a weaker, smoother effective potential that acts only on the 4 valence electrons.\n\nB. The main purpose of the pseudopotential is to increase the accuracy of the calculated energies and wavefunctions of the core electron states ($1s, 2s, 2p$).\n\nC. The pseudopotential is an approximation for the complex exchange-correlation interactions that occur between the valence electrons.\n\nD. By creating a smoother potential and correspondingly smoother valence wavefunctions near the nucleus, the pseudopotential allows the wavefunctions to be represented accurately with a significantly smaller and computationally cheaper basis set.\n\nE. The pseudopotential method simplifies the calculation by replacing the 4 chemically active valence electrons with an effective potential, allowing the simulation to focus on the complex interactions of the 10 core electrons.\n\nF. The use of a pseudopotential transforms the approximate DFT problem into an exact, non-approximate solution of the many-body Schrödinger equation for the silicon crystal's valence electrons.", "solution": "We begin from the Kohn–Sham formulation of Density Functional Theory, which replaces the interacting many-electron problem by noninteracting electrons moving in an effective potential:\n$$\n\\left[-\\frac{\\hbar^{2}}{2m_{e}}\\nabla^{2} + V_{\\text{ext}}(\\mathbf{r}) + V_{\\text{H}}[n](\\mathbf{r}) + V_{\\text{xc}}[n](\\mathbf{r})\\right]\\psi_{i}(\\mathbf{r}) = \\varepsilon_{i}\\psi_{i}(\\mathbf{r}),\n$$\nwhere $V_{\\text{ext}}$ is the external potential due to the nuclei and core electrons, $V_{\\text{H}}[n]$ is the Hartree potential determined by the electron density $n(\\mathbf{r})$, and $V_{\\text{xc}}[n]$ is the exchange-correlation potential. For an all-electron calculation, the external potential for a nucleus of charge $Z$ located at $\\mathbf{R}_{I}$ is Coulombic,\n$$\nV_{\\text{ext}}(\\mathbf{r}) = \\sum_{I} -\\frac{Z_{I} e^{2}}{4\\pi \\varepsilon_{0}|\\mathbf{r}-\\mathbf{R}_{I}|},\n$$\nwhich is singular at the nuclear positions. In atoms with core electrons, valence orbitals must also remain orthogonal to tightly bound core orbitals, which forces rapid oscillations of the valence wavefunctions near the nuclei.\n\nThe pseudopotential approximation modifies the Kohn–Sham problem by replacing the combination of the nuclear Coulomb potential and the explicit core-electron effects by an effective ionic pseudopotential $V_{\\text{ps}}$ acting only on the valence electrons:\n$$\nV_{\\text{ext}}(\\mathbf{r}) \\;\\longrightarrow\\; V_{\\text{ps}}(\\mathbf{r}),\n$$\nwhile the Kohn–Sham electrons explicitly treated are restricted to the valence subspace. The pseudopotential is constructed so that outside a chosen core radius it reproduces the valence scattering properties of the all-electron potential, but inside the core region it is smooth and lacks the singularity. Correspondingly, the pseudo-wavefunctions are smooth and nodeless near the nuclei yet match the true valence wavefunctions outside the core region.\n\nThis smoothing has direct computational consequences. Plane-wave expansions require a kinetic-energy cutoff that grows with the largest Fourier components of the wavefunctions. Because the pseudo-wavefunctions lack the rapid near-nuclear oscillations, their Fourier spectra decay faster, allowing accurate representation with a significantly smaller basis (lower plane-wave cutoff), which reduces computational cost.\n\nWe now evaluate each statement:\n\nA. True. The pseudopotential replaces the singular nuclear Coulomb potential and the explicit treatment of core electrons by a weaker, smoother effective potential acting on the valence electrons only. This is the essence of the frozen-core pseudopotential approach.\n\nB. False. The goal is to reproduce valence properties (eigenvalues, scattering, bonding) accurately; core states are not treated explicitly and their detailed energies and wavefunctions are not the target of increased accuracy.\n\nC. False. Exchange-correlation effects are represented by $V_{\\text{xc}}[n]$ and are independent of the pseudopotential. The pseudopotential approximates the external ionic plus core effects, not the exchange-correlation functional.\n\nD. True. By smoothing the potential and removing near-nuclear oscillations, the pseudo-wavefunctions become smoother, enabling accurate representation with a substantially smaller and cheaper basis set.\n\nE. False. The method keeps valence electrons explicit and replaces the core electrons and nuclear potential with an effective potential. It does not replace the valence electrons.\n\nF. False. The approach remains within approximate Kohn–Sham DFT and does not yield an exact solution to the many-body Schrödinger equation for the solid; the pseudopotential itself is an additional approximation.\n\nTherefore, the correct selections are A and D.", "answer": "$$\\boxed{AD}$$", "id": "1768562"}]}