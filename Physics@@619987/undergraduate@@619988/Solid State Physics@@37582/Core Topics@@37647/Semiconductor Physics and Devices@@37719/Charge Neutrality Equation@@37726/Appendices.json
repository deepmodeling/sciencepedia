{"hands_on_practices": [{"introduction": "Mastering the charge neutrality equation begins with understanding how to apply it to realistic materials. This exercise [@problem_id:1787500] challenges you to calculate the electron concentration in a \"compensated\" semiconductor, which contains both donor and acceptor impurities. By simultaneously applying the law of mass action ($np = n_i^2$) and the charge neutrality condition ($n + N_{a} = p + N_{d}$), you will derive and solve the governing quadratic equation, a fundamental skill for analyzing nearly all semiconductor devices.", "problem": "A materials scientist is developing a novel semiconductor material, named 'Cryptonium,' intended for use in high-frequency electronic devices. At an operating temperature of 300 K, pure Cryptonium has an intrinsic carrier concentration of $n_i = 1.5 \\times 10^{13} \\text{ cm}^{-3}$. To precisely control its electrical properties, the material is simultaneously doped with both donor and acceptor impurities, a process known as compensation. The concentration of donor atoms is $N_d = 4.0 \\times 10^{13} \\text{ cm}^{-3}$, and the concentration of acceptor atoms is $N_a = 1.0 \\times 10^{13} \\text{ cm}^{-3}$. For this material at the given temperature, it is an excellent approximation to assume that all dopant atoms are fully ionized. The behavior of charge carriers in this material is governed by the law of mass action and the principle of charge neutrality.\n\nCalculate the equilibrium electron concentration $n$ in this doped Cryptonium sample. Express your answer in units of $\\text{cm}^{-3}$, rounded to three significant figures.", "solution": "Given intrinsic carrier concentration $n_{i}$ and full ionization of dopants, the governing relations are:\n- Law of mass action: $n p = n_{i}^{2}$.\n- Charge neutrality: $n + N_{a} = p + N_{d}$.\n\nFrom charge neutrality, rearrange to obtain:\n$$n - p = N_{d} - N_{a} \\equiv \\Delta N.$$\nExpress $p$ in terms of $n$ using this relation:\n$$p = n - \\Delta N.$$\nSubstitute into the mass action law:\n$$n(n - \\Delta N) = n_{i}^{2},$$\nwhich yields the quadratic equation in $n$:\n$$n^{2} - \\Delta N\\, n - n_{i}^{2} = 0.$$\nSolving using the quadratic formula and selecting the physically meaningful (positive) root:\n$$n = \\frac{\\Delta N + \\sqrt{\\Delta N^{2} + 4 n_{i}^{2}}}{2}.$$\n\nNow substitute the given values $N_{d} = 4.0 \\times 10^{13}\\ \\text{cm}^{-3}$, $N_{a} = 1.0 \\times 10^{13}\\ \\text{cm}^{-3}$, and $n_{i} = 1.5 \\times 10^{13}\\ \\text{cm}^{-3}$:\n$$\\Delta N = N_{d} - N_{a} = 3.0 \\times 10^{13}\\ \\text{cm}^{-3},$$\n$$\\Delta N^{2} = 9.0 \\times 10^{26}, \\quad 4 n_{i}^{2} = 4 \\times (1.5 \\times 10^{13})^{2} = 9.0 \\times 10^{26},$$\n$$\\Delta N^{2} + 4 n_{i}^{2} = 1.8 \\times 10^{27}, \\quad \\sqrt{\\Delta N^{2} + 4 n_{i}^{2}} \\approx 4.242640687 \\times 10^{13}.$$\nTherefore,\n$$n = \\frac{3.0 \\times 10^{13} + 4.242640687 \\times 10^{13}}{2} \\approx 3.621320343 \\times 10^{13}.$$\nRounding to three significant figures gives $n \\approx 3.62 \\times 10^{13}$ in $\\text{cm}^{-3}$.", "answer": "$$\\boxed{3.62 \\times 10^{13}}$$", "id": "1787500"}, {"introduction": "A key skill in physics and engineering is knowing when a complex equation can be simplified. This practice [@problem_id:1764213] explores the validity of the common approximation that electron concentration equals the net donor concentration ($n \\approx N_D$) in an n-type material. By calculating the intrinsic carrier concentration for a hypothetical wide-bandgap semiconductor, you will quantify the error introduced by this simplification and gain a deeper appreciation for why it is so effective in certain materials.", "problem": "In the analysis of doped semiconductors, it is common to make approximations to simplify the charge neutrality equation. This problem explores the validity of such an approximation for a wide-bandgap material.\n\nConsider a hypothetical wide-bandgap semiconductor at thermal equilibrium at a temperature $T = 300 \\text{ K}$. The material properties are as follows:\n- Bandgap energy: $E_g = 3.20 \\text{ eV}$\n- Effective density of states in the conduction band: $N_C = 1.0 \\times 10^{19} \\text{ cm}^{-3}$\n- Effective density of states in the valence band: $N_V = 5.0 \\times 10^{19} \\text{ cm}^{-3}$\n\nThe semiconductor is doped with a concentration of shallow donors $N_D = 2.0 \\times 10^{16} \\text{ cm}^{-3}$, and it is assumed that all donor atoms are ionized. There are no acceptor impurities.\n\nThe equilibrium electron concentration, $n_{exact}$, is the exact solution to the charge neutrality equation. A common simplification for such an n-type semiconductor is to use the approximation $n_{approx} = N_D$.\n\nCalculate the relative error introduced by this approximation, which is defined as $\\frac{|n_{approx} - n_{exact}|}{n_{exact}}$. Express your final answer as a decimal rounded to two significant figures.\n\nFor your calculations, use the Boltzmann constant $k_B = 8.617 \\times 10^{-5} \\text{ eV/K}$.", "solution": "At thermal equilibrium, charge neutrality for an n-type semiconductor with fully ionized donors and no acceptors is given by the condition $N_{D}^{+} + p = n + N_{A}^{-}$. With $N_{A}^{-} = 0$ and $N_{D}^{+} = N_{D}$, this reduces to\n$$\nn = N_{D} + p.\n$$\nUnder nondegenerate (Maxwell-Boltzmann) statistics, the mass-action law holds:\n$$\nn p = n_{i}^{2},\n$$\nwhere the intrinsic carrier concentration is\n$$\nn_{i} = \\sqrt{N_{C} N_{V}} \\exp\\!\\left(-\\frac{E_{g}}{2 k_{B} T}\\right).\n$$\nCombining $n = N_{D} + p$ with $p = \\frac{n_{i}^{2}}{n}$ gives a quadratic for $n$:\n$$\nn^{2} - N_{D} n - n_{i}^{2} = 0,\n$$\nwhose positive solution is\n$$\nn_{\\text{exact}} = \\frac{N_{D} + \\sqrt{N_{D}^{2} + 4 n_{i}^{2}}}{2}.\n$$\nThe approximation is $n_{\\text{approx}} = N_{D}$. The relative error is\n$$\n\\frac{|n_{\\text{approx}} - n_{\\text{exact}}|}{n_{\\text{exact}}} = \\frac{n_{\\text{exact}} - N_{D}}{n_{\\text{exact}}} = \\frac{p}{n_{\\text{exact}}} = \\frac{n_{i}^{2}}{n_{\\text{exact}}^{2}}.\n$$\nFor numerical evaluation at $T = 300\\,\\text{K}$ with $k_{B} = 8.617 \\times 10^{-5}\\,\\text{eV/K}$, $E_{g} = 3.20\\,\\text{eV}$, $N_{C} = 1.0 \\times 10^{19}\\,\\text{cm}^{-3}$, $N_{V} = 5.0 \\times 10^{19}\\,\\text{cm}^{-3}$, first compute\n$$\nk_{B} T = 8.617 \\times 10^{-5} \\times 300 \\,\\text{eV} = 0.025851\\,\\text{eV},\n$$\n$$\n\\frac{E_{g}}{k_{B} T} = \\frac{3.20}{0.025851} \\approx 123.786,\n$$\nso\n$$\nn_{i}^{2} = N_{C} N_{V} \\exp\\!\\left(-\\frac{E_{g}}{k_{B} T}\\right) \\approx \\left(5.0 \\times 10^{38}\\right) \\times \\exp(-123.786) \\approx 8.7 \\times 10^{-16}\\,\\text{cm}^{-6}.\n$$\nWith $N_{D} = 2.0 \\times 10^{16}\\,\\text{cm}^{-3}$, $N_{D}^{2} = 4.0 \\times 10^{32}\\,\\text{cm}^{-6}$. Since $n_{i}^{2} \\ll N_{D}^{2}$, $n_{\\text{exact}} \\approx N_{D}$ and\n$$\n\\frac{|n_{\\text{approx}} - n_{\\text{exact}}|}{n_{\\text{exact}}} \\approx \\frac{n_{i}^{2}}{N_{D}^{2}} \\approx \\frac{8.7 \\times 10^{-16}}{4.0 \\times 10^{32}} = 2.175 \\times 10^{-48}.\n$$\nRounded to two significant figures, the relative error is $2.2 \\times 10^{-48}$.", "answer": "$$\\boxed{2.2 \\times 10^{-48}}$$", "id": "1764213"}, {"introduction": "This computational exercise [@problem_id:2377959] bridges the gap between abstract concepts and practical problem-solving by connecting charge neutrality to the Fermi energy, $E_F$. Instead of solving for carrier concentrations directly, you will solve the fundamental equation $n(E_F) = p(E_F)$ using a numerical root-finding method. This reveals how the Fermi level acts as the thermodynamic parameter that balances electron and hole populations, a technique widely used in modern materials simulation.", "problem": "You are tasked with implementing a bracketing method to numerically determine the Fermi energy $E_F$ in an intrinsic semiconductor at temperature $T$ by solving the charge neutrality equation $n(E_F, T) - p(E_F, T) = 0$. Your approach must begin from well-established expressions for non-degenerate semiconductors and use a bracketing root-finding method to locate the unique solution within the band gap. All energies must be expressed in electronvolts (eV). Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nFundamental base and definitions to be used:\n- In the non-degenerate limit and under the effective mass approximation, the electron concentration and hole concentration are given by\n$$ n(E_F, T) = N_c(T)\\,\\exp\\!\\left(-\\frac{E_c - E_F}{k_B T}\\right), \\quad p(E_F, T) = N_v(T)\\,\\exp\\!\\left(-\\frac{E_F - E_v}{k_B T}\\right), $$\nwhere $E_c$ is the conduction-band edge, $E_v$ is the valence-band edge, $k_B$ is the Boltzmann constant, and $N_c(T)$ and $N_v(T)$ are the effective density of states in the conduction and valence bands, respectively.\n- The effective density of states for parabolic bands in three dimensions is\n$$ N_c(T) = 2 \\left( \\frac{2\\pi m_n^\\ast k_B T}{h^2} \\right)^{3/2}, \\quad N_v(T) = 2 \\left( \\frac{2\\pi m_p^\\ast k_B T}{h^2} \\right)^{3/2}, $$\nwhere $m_n^\\ast$ and $m_p^\\ast$ are the effective masses for electrons and holes, respectively, $h$ is Planckâ€™s constant, and the factor $2$ accounts for spin degeneracy. These expressions yield $N_c(T)$ and $N_v(T)$ in units of $\\mathrm{m}^{-3}$ when $m_n^\\ast$, $m_p^\\ast$, $k_B$, and $h$ are in SI units.\n- Assume an intrinsic semiconductor with $E_v = 0\\,\\text{eV}$ and $E_c = E_g$, where $E_g$ is the band gap in electronvolts. You must solve the equation\n$$ f(E_F) \\equiv n(E_F, T) - p(E_F, T) = 0 $$\nfor $E_F$.\n\nAlgorithmic requirements:\n- Implement a bracketing root-finding method based on first principles, such as the bisection method, to solve for $E_F$.\n- Use a conservative energy bracket\n$$ [\\,E_v - 0.5\\,\\text{eV}, \\; E_c + 0.5\\,\\text{eV}\\,] $$\nto ensure a sign change of $f(E_F)$ across the interval.\n- Use the Boltzmann constant in electronvolts per kelvin for exponents, $k_B = 8.617333262145\\times 10^{-5}\\,\\text{eV/K}$, so that energies in the exponent are consistently in electronvolts. For $N_c(T)$ and $N_v(T)$, use $k_B = 1.380649\\times 10^{-23}\\,\\text{J/K}$, $h = 6.62607015\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$, and the electron rest mass $m_e = 9.1093837015\\times 10^{-31}\\,\\text{kg}$. Treat $m_n^\\ast$ and $m_p^\\ast$ as multiples of $m_e$, i.e., use $m_n^\\ast m_e$ and $m_p^\\ast m_e$ in the formula for $N_c(T)$ and $N_v(T)$.\n- Use a stopping criterion based on the interval width in energy: stop when the interval width is less than $10^{-12}\\,\\text{eV}$ or after a maximum of $200$ iterations, whichever occurs first.\n- Express your final answers for $E_F$ in electronvolts, rounded to six decimal places.\n\nTest suite:\nUse the following four independent test cases. In each case, set $E_v = 0\\,\\text{eV}$ and $E_c = E_g$.\n1. Case A (silicon-like asymmetry): $T = 300\\,\\text{K}$, $E_g = 1.12\\,\\text{eV}$, $m_n^\\ast = 1.08$, $m_p^\\ast = 0.60$.\n2. Case B (symmetric bands): $T = 450\\,\\text{K}$, $E_g = 1.42\\,\\text{eV}$, $m_n^\\ast = 0.50$, $m_p^\\ast = 0.50$.\n3. Case C (strong valence-band DOS dominance): $T = 300\\,\\text{K}$, $E_g = 0.66\\,\\text{eV}$, $m_n^\\ast = 0.20$, $m_p^\\ast = 1.50$.\n4. Case D (small gap, low temperature): $T = 100\\,\\text{K}$, $E_g = 0.05\\,\\text{eV}$, $m_n^\\ast = 0.30$, $m_p^\\ast = 0.30$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the $E_F$ results for the four test cases, in the same order as listed above, as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4]$ with each $x_i$ rounded to six decimal places and expressed in $\\text{eV}$.", "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically sound, well-posed, and complete. It presents a standard problem in computational solid-state physics that is solvable using the specified methods and data. We may therefore proceed with the derivation of a solution.\n\nThe fundamental task is to solve the charge neutrality equation for an intrinsic semiconductor, which dictates that the electron concentration $n$ must equal the hole concentration $p$. The equation to be solved is thus $f(E_F) = n(E_F, T) - p(E_F, T) = 0$, where $E_F$ is the Fermi energy and $T$ is the temperature.\n\nThe concentrations are given by the Maxwell-Boltzmann approximations for non-degenerate semiconductors:\n$$ n(E_F, T) = N_c(T)\\,\\exp\\!\\left(-\\frac{E_c - E_F}{k_B T}\\right) $$\n$$ p(E_F, T) = N_v(T)\\,\\exp\\!\\left(-\\frac{E_F - E_v}{k_B T}\\right) $$\nHere, $E_c$ and $E_v$ are the conduction and valence band edges, and $k_B$ is the Boltzmann constant. $N_c(T)$ and $N_v(T)$ are the effective densities of states, defined as:\n$$ N_c(T) = 2 \\left( \\frac{2\\pi m_n^\\ast m_e k_B T}{h^2} \\right)^{3/2} $$\n$$ N_v(T) = 2 \\left( \\frac{2\\pi m_p^\\ast m_e k_B T}{h^2} \\right)^{3/2} $$\nwhere $m_n^\\ast m_e$ and $m_p^\\ast m_e$ are the electron and hole effective masses, and $h$ is Planck's constant. For these expressions, all physical constants ($k_B, h, m_e$) must be in SI units to yield densities in units of $\\mathrm{m}^{-3}$. In the exponential terms for concentration, energies are given in electronvolts ($eV$), so the product $k_B T$ must also be in $eV$. This requires using $k_B$ in units of $eV/K$. The problem statement provides both values, which is correct and necessary for consistency.\n\nThe function to solve for the root $E_F$ is:\n$$ f(E_F) = N_c(T)\\,\\exp\\!\\left(\\frac{E_F - E_c}{k_B T}\\right) - N_v(T)\\,\\exp\\!\\left(\\frac{E_v - E_F}{k_B T}\\right) = 0 $$\nThe derivative of $f(E_F)$ with respect to $E_F$ is:\n$$ \\frac{df}{dE_F} = \\frac{1}{k_B T} \\left[ N_c(T)\\,\\exp\\!\\left(\\frac{E_F - E_c}{k_B T}\\right) + N_v(T)\\,\\exp\\!\\left(\\frac{E_v - E_F}{k_B T}\\right) \\right] = \\frac{n+p}{k_B T} $$\nSince $n, p, k_B, T$ are all positive quantities, $\\frac{df}{dE_F} > 0$ for all $E_F$. This proves that $f(E_F)$ is a strictly monotonic function, which guarantees that if a root exists, it is unique. The problem specifies a bracketing interval of $[E_v - 0.5\\,\\text{eV}, E_c + 0.5\\,\\text{eV}]$. At the lower bound, $E_F$ is far below $E_v$, making $p \\gg n$ and thus $f(E_F)  0$. At the upper bound, $E_F$ is far above $E_c$, making $n \\gg p$ and thus $f(E_F)  0$. By the Intermediate Value Theorem, a root must exist within this bracket.\n\nDirect numerical evaluation of $f(E_F)$ can lead to floating-point overflow or underflow due to the large positive or negative arguments of the exponential functions, especially for low temperatures or wide band gaps. A more numerically stable formulation is required. Let us define the intrinsic energy level $E_i = (E_c + E_v)/2$ and express the Fermi energy as a deviation $\\delta_E$ from this level: $E_F = E_i + \\delta_E$. With the given conditions $E_v=0$ and $E_c=E_g$, we have $E_i = E_g/2$.\nSubstituting $E_F = E_g/2 + \\delta_E$ into the charge neutrality equation $n=p$:\n$$ N_c(T)\\,\\exp\\!\\left(-\\frac{E_g - (E_g/2 + \\delta_E)}{k_B T}\\right) = N_v(T)\\,\\exp\\!\\left(-\\frac{(E_g/2 + \\delta_E) - 0}{k_B T}\\right) $$\n$$ N_c(T)\\,\\exp\\!\\left(-\\frac{E_g/2 - \\delta_E}{k_B T}\\right) = N_v(T)\\,\\exp\\!\\left(-\\frac{E_g/2 + \\delta_E}{k_B T}\\right) $$\nDividing both sides by $\\exp(-E_g/(2k_B T))$ yields:\n$$ N_c(T)\\,\\exp\\!\\left(\\frac{\\delta_E}{k_B T}\\right) = N_v(T)\\,\\exp\\!\\left(-\\frac{\\delta_E}{k_B T}\\right) $$\nWe define a new function $g(\\delta_E)$ whose root we seek:\n$$ g(\\delta_E) = N_c(T)\\,\\exp\\!\\left(\\frac{\\delta_E}{k_B T}\\right) - N_v(T)\\,\\exp\\!\\left(-\\frac{\\delta_E}{k_B T}\\right) = 0 $$\nThis form is numerically robust as it avoids the large, shared term $\\exp(-E_g/(2k_B T))$.\n\nThe algorithm to find the root $\\delta_E$ will be the bisection method, implemented as required from first principles.\n1.  For a given test case ($T, E_g, m_n^\\ast, m_p^\\ast$), first compute the constants $N_c(T)$ and $N_v(T)$ using the SI values for $h, k_B, m_e$.\n2.  Define the initial search bracket for $E_F$ as $[a_F, b_F] = [-0.5, E_g + 0.5]$.\n3.  Transform this bracket to the $\\delta_E$ domain: $[a_\\delta, b_\\delta] = [a_F - E_g/2, b_F - E_g/2] = [-0.5 - E_g/2, 0.5 + E_g/2]$.\n4.  Initialize the bisection algorithm with the interval $[a,b] = [a_\\delta, b_\\delta]$. Check that $g(a)$ and $g(b)$ have opposite signs.\n5.  Iterate up to a maximum of $200$ times:\n    a. Calculate the midpoint, $c = (a+b)/2$.\n    b. If the interval width $(b-a)$ is less than the tolerance of $10^{-12}\\,\\text{eV}$, the iteration terminates.\n    c. Evaluate $g(c)$.\n    d. If $g(a)$ and $g(c)$ have the same sign, the root lies in $[c,b]$; therefore, set $a=c$.\n    e. Otherwise, the root lies in $[a,c]$; therefore, set $b=c$.\n6.  The an estimate for the root is $\\delta_E^\\ast = (a+b)/2$.\n7.  The final Fermi energy is recovered by $E_F = E_i + \\delta_E^\\ast = E_g/2 + \\delta_E^\\ast$. This value is then rounded to six decimal places.\n\nThis procedure is systematic, physically grounded, and numerically stable, and it will be implemented to solve the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Fermi energy in an intrinsic semiconductor for four test cases\n    using a bisection root-finding method.\n    \"\"\"\n    \n    # Define physical constants as specified in the problem statement.\n    # For exponents, in eV/K:\n    KB_EV = 8.617333262145e-5\n    # For Nc and Nv calculations, in SI units:\n    KB_SI = 1.380649e-23      # J/K\n    H_SI = 6.62607015e-34    # J*s\n    ME_SI = 9.1093837015e-31  # kg\n\n    # Define the test cases from the problem statement.\n    # Format: (T in K, Eg in eV, m_n_star, m_p_star)\n    test_cases = [\n        (300, 1.12, 1.08, 0.60),   # Case A (silicon-like asymmetry)\n        (450, 1.42, 0.50, 0.50),   # Case B (symmetric bands)\n        (300, 0.66, 0.20, 1.50),   # Case C (strong valence-band DOS dominance)\n        (100, 0.05, 0.30, 0.30),   # Case D (small gap, low temperature)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T, Eg, mn_star, mp_star = case\n        result = find_fermi_energy(T, Eg, mn_star, mp_star, KB_EV, KB_SI, H_SI, ME_SI)\n        results.append(result)\n\n    # Format the final results as a comma-separated string in brackets,\n    # with each value rounded to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef find_fermi_energy(T, Eg, mn_star, mp_star, kb_ev, kb_si, h_si, me_si):\n    \"\"\"\n    Calculates the Fermi energy for a given set of semiconductor parameters.\n    \n    This function implements a bisection method to solve the charge neutrality\n    equation in a numerically stable form.\n\n    Args:\n        T (float): Temperature in Kelvin.\n        Eg (float): Band gap in electronvolts (eV).\n        mn_star (float): Effective mass factor for electrons.\n        mp_star (float): Effective mass factor for holes.\n        kb_ev (float): Boltzmann constant in eV/K.\n        kb_si (float): Boltzmann constant in J/K.\n        h_si (float): Planck's constant in J*s.\n        me_si (float): Electron rest mass in kg.\n\n    Returns:\n        float: The calculated Fermi energy in eV.\n    \"\"\"\n    \n    # --- 1. Calculate Effective Densities of States (Nc, Nv) ---\n    # Pre-calculate the constant part of the N_c/N_v formula for efficiency.\n    # N(T) = 2 * (2*pi*m*kb*T/h^2)^(3/2) = [2*(2*pi*me*kb/h^2)^(3/2)] * (m_star*T)^(3/2)\n    # The term m*T is incorrect based on derivation; it should be (m_star)^(3/2) * T^(3/2)\n    const_factor = 2 * ( (2 * np.pi * me_si * kb_si) / (h_si**2) )**1.5\n    \n    Nc = const_factor * (mn_star**1.5) * (T**1.5)\n    Nv = const_factor * (mp_star**1.5) * (T**1.5)\n    \n    # --- 2. Define the Numerically Stable Objective Function g(delta_E) ---\n    # We solve g(delta_E) = Nc*exp(delta_E/kbT) - Nv*exp(-delta_E/kbT) = 0\n    # where E_F = E_i + delta_E and E_i = Eg/2.\n    kbT_ev = kb_ev * T\n\n    def g(delta_E):\n        term1 = Nc * np.exp(delta_E / kbT_ev)\n        term2 = Nv * np.exp(-delta_E / kbT_ev)\n        return term1 - term2\n\n    # --- 3. Set up and run the Bisection Method ---\n    # Initial bracket for E_F: [Ev - 0.5, Ec + 0.5] = [-0.5, Eg + 0.5]\n    # Corresponding bracket for delta_E = E_F - Eg/2:\n    # [-0.5 - Eg/2, 0.5 + Eg/2]\n    Ei = Eg / 2.0\n    a = -0.5 - Ei\n    b = 0.5 + Ei\n    \n    max_iter = 200\n    tolerance = 1.0e-12\n    \n    # Evaluate g(a) once before the loop\n    ga = g(a)\n\n    for _ in range(max_iter):\n        # Check for convergence based on interval width\n        if (b - a)  tolerance:\n            break\n            \n        midpoint = a + (b - a) / 2.0 # More stable than (a+b)/2\n        g_mid = g(midpoint)\n        \n        # Update the bracket\n        if ga * g_mid > 0:\n            a = midpoint\n            ga = g_mid\n        else:\n            b = midpoint\n\n    # The root is the final midpoint of the delta_E interval\n    delta_E_root = a + (b - a) / 2.0\n    \n    # Convert back to Fermi energy E_F = Ei + delta_E\n    Ef = Ei + delta_E_root\n    \n    return Ef\n\nsolve()\n```", "id": "2377959"}]}