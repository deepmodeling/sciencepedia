{"hands_on_practices": [{"introduction": "A central concept in Density Functional Theory is that the particle density profile, $\\rho(\\mathbf{r})$, contains all the information about a system's equilibrium properties. This first practice provides a concrete example by tasking you with a foundational calculation: computing the total external potential energy of a system from its known density distribution [@problem_id:2059839]. Mastering this step is essential for understanding how macroscopic observables are extracted from the theory's core variable.", "problem": "Consider a one-dimensional system composed of $N$ non-interacting classical particles in thermal equilibrium at a constant absolute temperature $T$. The particles are confined by an external harmonic potential given by $V_{\\text{ext}}(x) = \\frac{1}{2} k x^2$, where $k$ is a positive constant and $x$ is the position.\n\nIn the framework of classical statistical mechanics, the spatial distribution of these particles can be described by a particle number density, $\\rho(x)$, which represents the number of particles per unit length at position $x$. For this system, the equilibrium particle density is found to be a Gaussian function:\n$$\n\\rho(x) = N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right)\n$$\nwhere $\\beta = \\frac{1}{k_B T}$ and $k_B$ is the Boltzmann constant.\n\nCalculate the total potential energy stored in the entire system of particles due to the external confining potential. Express your answer as a closed-form analytic expression in terms of the total number of particles $N$, the Boltzmann constant $k_B$, and the temperature $T$.", "solution": "The total external potential energy, $U_{\\text{ext}}$, of a system described by a particle number density $\\rho(x)$ in the presence of an external potential $V_{\\text{ext}}(x)$ is given by the integral of the energy density over all space. The energy density at a point $x$ is the product of the particle density $\\rho(x)$ and the potential energy per particle $V_{\\text{ext}}(x)$.\n\nThe defining integral is:\n$$\nU_{\\text{ext}} = \\int_{-\\infty}^{\\infty} \\rho(x) V_{\\text{ext}}(x) \\, dx\n$$\n\nWe are given the expressions for the particle density and the external potential:\n$$\n\\rho(x) = N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right)\n$$\n$$\nV_{\\text{ext}}(x) = \\frac{1}{2} k x^2\n$$\n\nSubstituting these expressions into the integral for $U_{\\text{ext}}$:\n$$\nU_{\\text{ext}} = \\int_{-\\infty}^{\\infty} \\left( N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\right) \\left( \\frac{1}{2} k x^2 \\right) \\, dx\n$$\n\nWe can pull all the constant terms out of the integral:\n$$\nU_{\\text{ext}} = N \\left( \\sqrt{\\frac{\\beta k}{2\\pi}} \\right) \\left( \\frac{k}{2} \\right) \\int_{-\\infty}^{\\infty} x^2 \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\, dx\n$$\n\nTo evaluate the integral, we can use a standard result for Gaussian integrals of the form $\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^2) \\, dx$. Let's first consider the fundamental Gaussian integral:\n$$\nI_0(a) = \\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\, dx = \\sqrt{\\frac{\\pi}{a}}\n$$\nWe can obtain the integral we need, $\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx$, by differentiating $I_0(a)$ with respect to the parameter $a$:\n$$\n\\frac{d}{da} I_0(a) = \\frac{d}{da} \\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\, dx\n$$\nUsing Leibniz's rule for differentiation under the integral sign:\n$$\n\\frac{d}{da} I_0(a) = \\int_{-\\infty}^{\\infty} \\frac{\\partial}{\\partial a} \\exp(-ax^2) \\, dx = \\int_{-\\infty}^{\\infty} (-x^2) \\exp(-ax^2) \\, dx = - \\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx\n$$\nWe also differentiate the right-hand side of the $I_0(a)$ expression:\n$$\n\\frac{d}{da} \\left( \\sqrt{\\frac{\\pi}{a}} \\right) = \\sqrt{\\pi} \\frac{d}{da} (a^{-1/2}) = \\sqrt{\\pi} \\left( -\\frac{1}{2} a^{-3/2} \\right) = -\\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\nEquating the two results for the derivative:\n$$\n- \\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx = -\\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\nThus, the integral we need is:\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx = \\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\nIn our specific problem, the parameter $a$ corresponds to $a = \\frac{1}{2}\\beta k$. Substituting this into the integral result:\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\, dx = \\frac{1}{2} \\sqrt{\\frac{\\pi}{(\\frac{1}{2}\\beta k)^3}} = \\frac{1}{2} \\sqrt{\\frac{8\\pi}{(\\beta k)^3}} = \\frac{1}{2} \\frac{2\\sqrt{2\\pi}}{(\\beta k)^{3/2}} = \\frac{\\sqrt{2\\pi}}{(\\beta k)^{3/2}}\n$$\nNow, we substitute this result back into our expression for $U_{\\text{ext}}$:\n$$\nU_{\\text{ext}} = N \\left( \\sqrt{\\frac{\\beta k}{2\\pi}} \\right) \\left( \\frac{k}{2} \\right) \\left( \\frac{\\sqrt{2\\pi}}{(\\beta k)^{3/2}} \\right)\n$$\nLet's simplify this algebraic expression:\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\left( \\frac{(\\beta k)^{1/2}}{(2\\pi)^{1/2}} \\right) \\left( \\frac{(2\\pi)^{1/2}}{(\\beta k)^{3/2}} \\right)\n$$\nThe $\\sqrt{2\\pi}$ terms cancel out:\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\frac{(\\beta k)^{1/2}}{(\\beta k)^{3/2}} = \\frac{Nk}{2} (\\beta k)^{1/2 - 3/2} = \\frac{Nk}{2} (\\beta k)^{-1}\n$$\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\frac{1}{\\beta k} = \\frac{N}{2\\beta}\n$$\nFinally, we substitute the definition $\\beta = \\frac{1}{k_B T}$:\n$$\nU_{\\text{ext}} = \\frac{N}{2(1/k_B T)} = \\frac{1}{2} N k_B T\n$$\nThis result is consistent with the equipartition theorem, which states that each quadratic degree of freedom (like the potential energy $V \\propto x^2$) contributes an average energy of $\\frac{1}{2}k_B T$ to the system. For $N$ particles, the total potential energy is $N \\times \\frac{1}{2}k_B T$.", "answer": "$$\\boxed{\\frac{1}{2} N k_B T}$$", "id": "2059839"}, {"introduction": "The primary \"forward problem\" in DFT is to determine the equilibrium density profile for a given set of particle interactions and an external potential. This is achieved by minimizing the grand potential functional, $\\Omega[\\rho]$, a principle that lies at the heart of the theory. In this exercise, you will apply variational calculus to a model functional to derive the density profile for an interacting gas, revealing how interactions modify the system's structure from the simple ideal gas case [@problem_id:2059873].", "problem": "Consider a one-dimensional classical gas of interacting particles confined to the semi-infinite line $x \\geq 0$. This system serves as a simplified model for phenomena like the sedimentation of colloids under gravity. The thermodynamic state of the gas at equilibrium can be described by finding the particle number density profile, $\\rho(x)$, that minimizes the grand potential functional, $\\Omega[\\rho]$.\n\nThe grand potential functional for this system is given by:\n$$\n\\Omega[\\rho] = k_B T \\int_{0}^{\\infty} \\rho(x) [\\ln(\\Lambda \\rho(x)) - 1] dx + \\frac{\\alpha}{2} \\int_{0}^{\\infty} \\rho(x)^2 dx + \\int_{0}^{\\infty} \\rho(x) (V_{ext}(x) - \\mu) dx\n$$\n\nThe terms in this functional represent different contributions to the total energy:\n1.  The first term is the ideal gas contribution to the free energy.\n2.  The second term models a weak, short-range repulsive interaction between particles at a mean-field level.\n3.  The third term accounts for the particles' interaction with an external potential and their connection to a particle reservoir.\n\nThe parameters in the functional are all constants:\n-   $k_B$ is the Boltzmann constant.\n-   $T$ is the absolute temperature.\n-   $\\Lambda$ is the thermal de Broglie wavelength.\n-   $\\alpha$ is a positive constant representing the strength of the repulsive interaction.\n-   $\\mu$ is the chemical potential of the gas.\n-   $V_{ext}(x) = gx$ is a linear external potential, where $g$ is a positive constant representing the strength of a uniform field (e.g., gravity).\n\nYour task is to determine the equilibrium density profile, $\\rho(x)$, that minimizes this grand potential functional. Provide your answer as a single closed-form analytic expression for $\\rho(x)$ in terms of $x$ and the given parameters. The solution may involve the Lambert W function, denoted as $W(z)$, which is defined as the solution to the equation $z = W(z) \\exp(W(z))$.", "solution": "We minimize the grand potential functional by setting its first functional derivative to zero. Since the integrand depends only locally on $\\rho(x)$ (there are no gradients of $\\rho$), the Eulerâ€“Lagrange condition reduces to the pointwise equation $\\delta \\Omega / \\delta \\rho(x)=0$.\n\nCompute the functional derivative term by term. For the ideal-gas term, write $f(\\rho)=\\rho[\\ln(\\Lambda \\rho)-1]=\\rho \\ln(\\Lambda \\rho)-\\rho$. Then\n$$\n\\frac{d f}{d \\rho}=\\ln(\\Lambda \\rho)+\\frac{\\rho}{\\rho}-1=\\ln(\\Lambda \\rho).\n$$\nFor the mean-field interaction, $(\\alpha/2)\\rho^{2}\\mapsto \\alpha \\rho$. For the external and reservoir term, $\\rho(V_{ext}-\\mu)\\mapsto V_{ext}-\\mu=gx-\\mu$. Hence the stationarity condition is\n$$\nk_B T\\,\\ln(\\Lambda \\rho(x))+\\alpha \\rho(x)+g x-\\mu=0.\n$$\n\nRearrange to isolate the logarithm:\n$$\nk_B T\\,\\ln(\\Lambda \\rho(x))=\\mu-g x-\\alpha \\rho(x),\n$$\n$$\n\\ln(\\Lambda \\rho(x))=\\frac{\\mu-g x-\\alpha \\rho(x)}{k_B T}.\n$$\nExponentiating both sides gives\n$$\n\\Lambda \\rho(x)=\\exp\\!\\left(\\frac{\\mu-g x}{k_B T}\\right)\\exp\\!\\left(-\\frac{\\alpha \\rho(x)}{k_B T}\\right),\n$$\nwhich we rewrite as\n$$\n\\rho(x)\\,\\exp\\!\\left(\\frac{\\alpha \\rho(x)}{k_B T}\\right)=\\frac{1}{\\Lambda}\\,\\exp\\!\\left(\\frac{\\mu-g x}{k_B T}\\right).\n$$\nMultiplying both sides by $\\alpha/(k_B T)$ yields\n$$\n\\frac{\\alpha}{k_B T}\\,\\rho(x)\\,\\exp\\!\\left(\\frac{\\alpha \\rho(x)}{k_B T}\\right)=\\frac{\\alpha}{\\Lambda k_B T}\\,\\exp\\!\\left(\\frac{\\mu-g x}{k_B T}\\right).\n$$\nLet $u=\\frac{\\alpha \\rho(x)}{k_B T}$. Then the equation has the form $u\\exp(u)=z$ with\n$$\nz=\\frac{\\alpha}{\\Lambda k_B T}\\,\\exp\\!\\left(\\frac{\\mu-g x}{k_B T}\\right).\n$$\nBy the definition of the Lambert $W$ function, $u=W(z)$, so\n$$\n\\frac{\\alpha \\rho(x)}{k_B T}=W\\!\\left(\\frac{\\alpha}{\\Lambda k_B T}\\,\\exp\\!\\left(\\frac{\\mu-g x}{k_B T}\\right)\\right),\n$$\nand therefore\n$$\n\\rho(x)=\\frac{k_B T}{\\alpha}\\,W\\!\\left(\\frac{\\alpha}{\\Lambda k_B T}\\,\\exp\\!\\left(\\frac{\\mu-g x}{k_B T}\\right)\\right).\n$$\n\nSince $\\alpha0$, $\\Lambda0$, and $\\exp((\\mu-g x)/(k_B T))0$, the argument of $W$ is positive for all $x\\geq 0$, so the principal branch yields a unique positive density. The integrand is strictly convex in $\\rho$ because its second derivative is $k_B T/\\rho+\\alpha0$ for $\\rho0$, ensuring that this stationary solution is the unique global minimizer. In the limit $\\alpha \\to 0^{+}$, $W(z)\\sim z$ and the expression reduces to the ideal barometric law $\\rho(x)=\\Lambda^{-1}\\exp((\\mu-g x)/(k_B T))$, as expected.", "answer": "$$\\boxed{\\frac{k_B T}{\\alpha}\\,W\\!\\left(\\frac{\\alpha}{\\Lambda k_B T}\\,\\exp\\!\\left(\\frac{\\mu-g x}{k_B T}\\right)\\right)}$$", "id": "2059873"}, {"introduction": "The one-to-one correspondence between the external potential and the ground-state density is a cornerstone of DFT, enabling a powerful \"inverse\" approach to system design. Instead of predicting the density that results from a potential, we can specify a desired target density and then determine the precise potential needed to stabilize it. This exercise walks you through this inverse problem, demonstrating how DFT can be a tool for engineering systems with specific structural properties [@problem_id:2059864].", "problem": "Within the framework of classical Density Functional Theory (DFT), the equilibrium properties of a fluid are described by its one-body density profile, $\\rho(\\mathbf{r})$. Consider a one-dimensional fluid of interacting particles confined to the $x$-axis at a constant temperature $T$. The intrinsic Helmholtz free energy functional, $F[\\rho]$, for this fluid is approximated by a model that includes both ideal gas contributions and pairwise interactions at a local mean-field level:\n$$F[\\rho] = k_B T \\int_{-\\infty}^{\\infty} \\rho(x) \\left[\\ln(\\rho(x) \\Lambda) - 1\\right] dx + \\frac{A}{2} \\int_{-\\infty}^{\\infty} [\\rho(x)]^2 dx$$\nHere, $k_B$ is the Boltzmann constant, $\\Lambda$ is the thermal de Broglie wavelength representing the ideal gas contribution, and $A$ is a positive constant that quantifies the strength of repulsive interactions between particles.\n\nThe Hohenberg-Kohn theorems of DFT establish that for a system at fixed temperature and chemical potential $\\mu$, there is a unique external potential $V_{\\text{ext}}(x)$ that stabilizes any given non-degenerate ground state density profile $\\rho(x)$. This equilibrium density is the one that minimizes the grand potential functional $\\Omega[\\rho] = F[\\rho] + \\int \\rho(x) [V_{\\text{ext}}(x) - \\mu] dx$.\n\nYour task is to solve the inverse problem: determine the external potential $V_{\\text{ext}}(x)$ that is required to stabilize a specific target density profile given by a Gaussian function:\n$$\\rho_{\\text{target}}(x) = \\rho_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$$\nwhere $\\rho_0$ is the peak density at $x=0$ and $\\sigma$ is a characteristic width.\n\nSince the potential is defined only up to an arbitrary additive constant, express your final answer as the potential difference $V_{\\text{ext}}(x) - V_{\\text{ext}}(0)$ in terms of $k_B, T, A, \\rho_0, \\sigma$, and the coordinate $x$.", "solution": "We start from the grand potential functional at fixed temperature and chemical potential,\n$$\n\\Omega[\\rho] = F[\\rho] + \\int_{-\\infty}^{\\infty} \\rho(x) \\left[V_{\\text{ext}}(x) - \\mu \\right] dx,\n$$\nand the equilibrium profile satisfies the Eulerâ€“Lagrange condition\n$$\n\\frac{\\delta \\Omega}{\\delta \\rho(x)} = 0 \\quad \\Rightarrow \\quad \\frac{\\delta F}{\\delta \\rho(x)} + V_{\\text{ext}}(x) - \\mu = 0.\n$$\nWith the given functional,\n$$\nF[\\rho] = k_B T \\int_{-\\infty}^{\\infty} \\rho(x) \\left[\\ln\\!\\big(\\rho(x)\\Lambda\\big) - 1\\right] dx + \\frac{A}{2} \\int_{-\\infty}^{\\infty} \\left[\\rho(x)\\right]^{2} dx,\n$$\nwe compute each functional derivative locally. For the ideal part, using $f(\\rho)=\\rho\\left[\\ln(\\rho\\Lambda)-1\\right]$,\n$$\n\\frac{d f}{d \\rho} = \\ln(\\rho \\Lambda) + \\rho \\frac{1}{\\rho} - 1 = \\ln(\\rho \\Lambda),\n$$\nso\n$$\n\\frac{\\delta F_{\\text{id}}}{\\delta \\rho(x)} = k_B T \\ln\\!\\big(\\rho(x)\\Lambda\\big).\n$$\nFor the interaction term,\n$$\n\\frac{\\delta}{\\delta \\rho(x)} \\left[\\frac{A}{2} \\int \\rho^{2}(x') dx' \\right] = A \\rho(x).\n$$\nTherefore,\n$$\n\\frac{\\delta F}{\\delta \\rho(x)} = k_B T \\ln\\!\\big(\\rho(x)\\Lambda\\big) + A \\rho(x).\n$$\nThe Eulerâ€“Lagrange equation yields\n$$\nV_{\\text{ext}}(x) = \\mu - k_B T \\ln\\!\\big(\\rho(x)\\Lambda\\big) - A \\rho(x).\n$$\nThe potential is defined up to an additive constant, so we consider the difference\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = - k_B T \\left[\\ln\\!\\big(\\rho(x)\\Lambda\\big) - \\ln\\!\\big(\\rho(0)\\Lambda\\big)\\right] - A \\left[\\rho(x) - \\rho(0)\\right].\n$$\nThe factor $\\Lambda$ cancels inside the logarithm, giving\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = - k_B T \\ln\\!\\left(\\frac{\\rho(x)}{\\rho(0)}\\right) - A \\left[\\rho(x) - \\rho(0)\\right].\n$$\nFor the target Gaussian density profile\n$$\n\\rho_{\\text{target}}(x) = \\rho_{0} \\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right),\n$$\nwe have $\\rho(0)=\\rho_{0}$ and\n$$\n\\ln\\!\\left(\\frac{\\rho(x)}{\\rho(0)}\\right) = -\\frac{x^{2}}{2 \\sigma^{2}}, \\qquad \\rho(x) - \\rho(0) = \\rho_{0} \\left[\\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right) - 1\\right].\n$$\nSubstituting into the potential difference gives\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = k_B T \\frac{x^{2}}{2 \\sigma^{2}} + A \\rho_{0} \\left[1 - \\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right)\\right].\n$$\nThis expresses the required external potential difference entirely in terms of $k_B, T, A, \\rho_{0}, \\sigma$, and $x$.", "answer": "$$\\boxed{\\frac{k_B T}{2 \\sigma^{2}} x^{2} + A \\rho_{0} \\left[1 - \\exp\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right)\\right]}$$", "id": "2059864"}]}