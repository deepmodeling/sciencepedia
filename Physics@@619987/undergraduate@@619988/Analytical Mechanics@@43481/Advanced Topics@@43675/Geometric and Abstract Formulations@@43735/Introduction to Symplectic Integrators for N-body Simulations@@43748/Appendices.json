{"hands_on_practices": [{"introduction": "Getting started with numerical integrators means rolling up our sleeves and performing a calculation by hand. This first exercise walks you through a single time step of the Symplectic Euler B method, a foundational algorithm for Hamiltonian systems. By manually updating the position and momentum of a particle, you will gain a concrete feel for how these integrators advance a system through time, paying close attention to the sequential nature of the updates [@problem_id:2060449].", "problem": "A particle's state in one-dimensional phase space is described by its position $q$ and momentum $p$. The equations governing the evolution of this system are given by:\n$$ \\frac{dq}{dt} = p $$\n$$ \\frac{dp}{dt} = -\\sin(q) $$\nTo numerically approximate the particle's trajectory, we use a symplectic integration scheme. The update rules for advancing the state from $(q_n, p_n)$ at time $t_n$ to $(q_{n+1}, p_{n+1})$ at time $t_{n+1} = t_n + \\Delta t$ are given by the Symplectic Euler B method:\n1.  Update position: $q_{n+1} = q_n + \\Delta t \\cdot p_n$\n2.  Update momentum: $p_{n+1} = p_n - \\Delta t \\cdot \\sin(q_{n+1})$\n\nNotice that the momentum update uses the newly computed position $q_{n+1}$.\n\nGiven that the particle has an initial state of $(q_0, p_0) = (0, 1)$, determine the state $(q_1, p_1)$ after a single time step of duration $\\Delta t$. Express your answer as a pair of expressions for $q_1$ and $p_1$ in terms of $\\Delta t$.", "solution": "We are given the system with evolution equations $dq/dt=p$ and $dp/dt=-\\sin(q)$ and the Symplectic Euler B update:\n$$q_{n+1}=q_{n}+\\Delta t\\, p_{n},$$\n$$p_{n+1}=p_{n}-\\Delta t\\, \\sin(q_{n+1}).$$\nWith the initial state $(q_{0},p_{0})=(0,1)$, substitute $n=0$ into the position update:\n$$q_{1}=q_{0}+\\Delta t\\, p_{0}=0+\\Delta t \\cdot 1=\\Delta t.$$\nNext, use the momentum update with the newly computed $q_{1}$:\n$$p_{1}=p_{0}-\\Delta t\\, \\sin(q_{1})=1-\\Delta t\\, \\sin(\\Delta t).$$\nTherefore, after one time step of duration $\\Delta t$, the state is $(q_{1},p_{1})=(\\Delta t,\\;1-\\Delta t\\, \\sin(\\Delta t))$.", "answer": "$$\\boxed{\\begin{pmatrix}\\Delta t & 1-\\Delta t \\sin(\\Delta t)\\end{pmatrix}}$$", "id": "2060449"}, {"introduction": "Now that you've performed a basic integration step, we'll explore the unique property that gives symplectic integrators their name and power. This practice contrasts the symplectic Euler method with the more common (but non-symplectic) forward Euler method to demonstrate the principle of phase-space area preservation [@problem_id:2060446]. Calculating how an area element evolves under each scheme provides a direct, quantitative insight into why symplectic integrators are essential for maintaining the geometric structure of physical systems.", "problem": "A fundamental concept in the numerical simulation of Hamiltonian systems is the preservation of phase-space volume, a property known as symplecticity. This problem explores the difference between a non-symplectic and a symplectic integrator by examining how they transform an area element in phase space.\n\nConsider a one-dimensional harmonic oscillator whose dynamics are governed by the dimensionless Hamiltonian $H(q, p) = \\frac{1}{2}(p^2 + q^2)$, where $q$ is the position and $p$ is the momentum. The corresponding equations of motion are $\\dot{q} = p$ and $\\dot{p} = -q$.\n\nWe will analyze the evolution of the system using two different numerical integration schemes with a fixed time step $\\Delta t$.\n\n**Method 1 (Forward Euler):**\nThe state $(q_{n+1}, p_{n+1})$ at time step $n+1$ is calculated from the state $(q_n, p_n)$ at step $n$ using the forward Euler method:\n$$q_{n+1} = q_n + \\Delta t \\cdot p_n$$\n$$p_{n+1} = p_n - \\Delta t \\cdot q_n$$\n\n**Method 2 (Symplectic Euler A):**\nThe state is updated using a semi-implicit or symplectic Euler scheme as follows:\n$$p_{n+1} = p_n - \\Delta t \\cdot q_n$$\n$$q_{n+1} = q_n + \\Delta t \\cdot p_{n+1}$$\n\nAn initial, small square patch in phase space is defined by its four vertices centered at $(q_c, p_c) = (1.2, 0.5)$. The vertices are located at $(1.2 \\pm 0.01, 0.5 \\pm 0.01)$.\n\nApply a single time step of size $\\Delta t = 0.15$ to these four vertices using both Method 1 and Method 2. This transforms the initial square into two different parallelograms. Let $A_{FE}$ be the area of the parallelogram resulting from Method 1, and $A_{SEA}$ be the area of the parallelogram resulting from Method 2.\n\nCalculate the ratio $\\frac{A_{FE}}{A_{SEA}}$. Provide your answer as a number rounded to four significant figures.", "solution": "We consider the linear maps induced by one time step of each method. For a linear update $(q_{n+1},p_{n+1})^{T} = M (q_{n},p_{n})^{T}$, the area of any small patch is multiplied by $|\\det M|$. Since the harmonic oscillator and both integrators here are linear in $(q,p)$, the Jacobian is constant across the phase plane, so the area scaling is the same for the entire patch, independent of its center and size.\n\nLet $h=\\Delta t$.\n\nMethod 1 (Forward Euler): The update is\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix}.\n$$\nThus $M_{FE}=\\begin{pmatrix}1 & h\\\\ -h & 1\\end{pmatrix}$ and\n$$\n\\det M_{FE} = 1\\cdot 1 - (h)(-h) = 1 + h^{2}.\n$$\nTherefore the area scales as $A_{FE} = (1+h^{2})A_{0}$, where $A_{0}$ is the initial squareâ€™s area.\n\nMethod 2 (Symplectic Euler A): The update is\n$$\np_{n+1}=p_{n}-h q_{n},\\qquad q_{n+1}=q_{n}+h p_{n+1}=q_{n}+h p_{n}-h^{2} q_{n}=(1-h^{2})q_{n}+h p_{n}.\n$$\nHence\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1-h^{2} & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix},\n$$\nso $M_{SEA}=\\begin{pmatrix}1-h^{2} & h\\\\ -h & 1\\end{pmatrix}$ and\n$$\n\\det M_{SEA}=(1-h^{2})\\cdot 1 - h(-h) = 1-h^{2}+h^{2}=1.\n$$\nTherefore $A_{SEA}=A_{0}$.\n\nThe requested ratio is\n$$\n\\frac{A_{FE}}{A_{SEA}}=\\frac{(1+h^{2})A_{0}}{A_{0}}=1+h^{2}.\n$$\nWith $h=\\Delta t=0.15$, we obtain\n$$\n\\frac{A_{FE}}{A_{SEA}}=1+0.15^{2}=1.0225,\n$$\nwhich rounded to four significant figures is $1.023$.", "answer": "$$\\boxed{1.023}$$", "id": "2060446"}, {"introduction": "The theoretical elegance of preserving phase-space structure translates into tangible benefits for long-term simulations. In this final practice, we investigate one of the most important practical consequences: the order of convergence, which measures how quickly the simulation error decreases as the time step gets smaller [@problem_id:2060505]. By analyzing pre-computed simulation data, you will empirically determine and compare the accuracy of a symplectic integrator versus a non-symplectic one, solidifying the connection between geometric preservation and numerical fidelity.", "problem": "In many areas of physics, from celestial mechanics to molecular dynamics, the equations of motion are too complex to be solved analytically. Instead, physicists rely on numerical integration algorithms to approximate the solution over discrete time steps. The accuracy of such a simulation depends critically on the chosen algorithm and the size of the time step, $\\Delta t$. A key characteristic of an integrator is its *order of convergence*, an integer exponent $p$ that describes how the global error $\\epsilon$ (the difference between the numerical and exact solution at a fixed final time) scales with the time step, according to the relation $\\epsilon \\approx C (\\Delta t)^p$ for some constant $C$ as $\\Delta t \\to 0$.\n\nConsider a simple harmonic oscillator consisting of a particle of mass $m$ attached to a spring of constant $k$. The equation of motion is $\\ddot{x} = -\\omega^2 x$, where $\\omega = \\sqrt{k/m}$. For this problem, we set $\\omega = 1 \\text{ rad/s}$. The particle is released from rest at an initial position $x(0) = 1 \\text{ m}$ and $v(0) = 0 \\text{ m/s}$.\n\nWe will compare two common numerical integration schemes.\n\n**Scheme A:**\nFor a time step $\\Delta t$, the position $x_i$ and velocity $v_i$ at time $t_i$ are updated to the next step $t_{i+1} = t_i + \\Delta t$ using the following rules:\n$$v_{i+1} = v_i - \\Delta t \\cdot \\omega^2 x_i$$\n$$x_{i+1} = x_i + \\Delta t \\cdot v_i$$\n\n**Scheme B (Velocity Verlet formulation):**\nThe position and velocity are updated using a half-step for velocity:\n$$v_{i+1/2} = v_i - \\frac{\\Delta t}{2} \\cdot \\omega^2 x_i$$\n$$x_{i+1} = x_i + \\Delta t \\cdot v_{i+1/2}$$\n$$v_{i+1} = v_{i+1/2} - \\frac{\\Delta t}{2} \\cdot \\omega^2 x_{i+1}$$\n\nTo determine the order of convergence for each scheme, the system is simulated up to a final time of $T_{final} = 10\\pi$ seconds. Below are the numerically obtained final positions for two different time steps.\n\nFor **Scheme A**:\n- With a time step $\\Delta t_1 = \\frac{\\pi}{10}$ s, the final position is $x_{A,1}(T_{final}) \\approx 1.54781$.\n- With a time step $\\Delta t_2 = \\frac{\\pi}{20}$ s, the final position is $x_{A,2}(T_{final}) \\approx 1.25893$.\n\nFor **Scheme B**:\n- With a time step $\\Delta t_1 = \\frac{\\pi}{10}$ s, the final position is $x_{B,1}(T_{final}) \\approx 1.04223$.\n- With a time step $\\Delta t_2 = \\frac{\\pi}{20}$ s, the final position is $x_{B,2}(T_{final}) \\approx 1.01052$.\n\nBased on this numerical evidence, determine the pair of integer exponents $(p_A, p_B)$ that best represent the order of convergence for Scheme A and Scheme B, respectively.", "solution": "The goal is to find the integer orders of convergence, $p_A$ and $p_B$, for the two numerical schemes. The order $p$ is defined by the scaling of the global error $\\epsilon$ with the time step $\\Delta t$, given by $\\epsilon \\approx C(\\Delta t)^p$.\n\nFirst, we must determine the exact solution to find the true value at $T_{final}$ and compute the errors. The equation of motion is $\\ddot{x} = -\\omega^2 x$ with $\\omega=1$. The general solution is $x(t) = A\\cos(\\omega t) + B\\sin(\\omega t)$. The initial conditions are $x(0) = 1$ and $v(0) = \\dot{x}(0) = 0$.\nApplying $x(0)=1$: $1 = A\\cos(0) + B\\sin(0) \\implies A=1$.\nThe velocity is $\\dot{x}(t) = -A\\omega\\sin(\\omega t) + B\\omega\\cos(\\omega t)$.\nApplying $v(0)=0$: $0 = -1\\cdot 1\\sin(0) + B\\cdot 1\\cos(0) \\implies B=0$.\nSo, the exact solution is $x(t) = \\cos(t)$.\n\nThe final time of the simulation is $T_{final} = 10\\pi$ seconds. The exact position at this time is:\n$x_{exact}(T_{final}) = x(10\\pi) = \\cos(10\\pi) = 1$.\n\nNow, we can calculate the global error $\\epsilon = |x_{num}(T_{final}) - x_{exact}(T_{final})|$ for each case provided in the problem.\n\nLet's analyze Scheme A.\nThe global error for the time step $\\Delta t_1 = \\pi/10$ is:\n$\\epsilon_{A,1} = |x_{A,1}(T_{final}) - 1| = |1.54781 - 1| = 0.54781$.\nThe global error for the time step $\\Delta t_2 = \\pi/20$ is:\n$\\epsilon_{A,2} = |x_{A,2}(T_{final}) - 1| = |1.25893 - 1| = 0.25893$.\n\nTo find the exponent $p_A$, we use the scaling relation for both time steps:\n$\\epsilon_{A,1} \\approx C(\\Delta t_1)^{p_A}$\n$\\epsilon_{A,2} \\approx C(\\Delta t_2)^{p_A}$\nDividing the first equation by the second gives:\n$\\frac{\\epsilon_{A,1}}{\\epsilon_{A,2}} \\approx \\left(\\frac{\\Delta t_1}{\\Delta t_2}\\right)^{p_A}$\nWe can solve for $p_A$ by taking the natural logarithm of both sides:\n$\\ln\\left(\\frac{\\epsilon_{A,1}}{\\epsilon_{A,2}}\\right) = p_A \\ln\\left(\\frac{\\Delta t_1}{\\Delta t_2}\\right)$\n$p_A = \\frac{\\ln(\\epsilon_{A,1}/\\epsilon_{A,2})}{\\ln(\\Delta t_1/\\Delta t_2)}$\n\nThe ratio of the time steps is $\\frac{\\Delta t_1}{\\Delta t_2} = \\frac{\\pi/10}{\\pi/20} = 2$.\nPlugging in the error values for Scheme A:\n$p_A = \\frac{\\ln(0.54781 / 0.25893)}{\\ln(2)} = \\frac{\\ln(2.11574\\dots)}{\\ln(2)} \\approx \\frac{0.7494}{0.6931} \\approx 1.081$\nThe closest integer to this value is $p_A = 1$.\n\nNext, let's analyze Scheme B.\nThe global error for the time step $\\Delta t_1 = \\pi/10$ is:\n$\\epsilon_{B,1} = |x_{B,1}(T_{final}) - 1| = |1.04223 - 1| = 0.04223$.\nThe global error for the time step $\\Delta t_2 = \\pi/20$ is:\n$\\epsilon_{B,2} = |x_{B,2}(T_{final}) - 1| = |1.01052 - 1| = 0.01052$.\n\nUsing the same formula for the exponent $p_B$:\n$p_B = \\frac{\\ln(\\epsilon_{B,1}/\\epsilon_{B,2})}{\\ln(\\Delta t_1/\\Delta t_2)}$\nPlugging in the error values for Scheme B:\n$p_B = \\frac{\\ln(0.04223 / 0.01052)}{\\ln(2)} = \\frac{\\ln(4.01425\\dots)}{\\ln(2)} \\approx \\frac{1.3900}{0.6931} \\approx 2.005$\nThe closest integer to this value is $p_B = 2$.\n\nThus, Scheme A has a convergence order of 1, and Scheme B has a convergence order of 2. The pair of integer exponents is $(p_A, p_B) = (1, 2)$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2 \\end{pmatrix}}$$", "id": "2060505"}]}