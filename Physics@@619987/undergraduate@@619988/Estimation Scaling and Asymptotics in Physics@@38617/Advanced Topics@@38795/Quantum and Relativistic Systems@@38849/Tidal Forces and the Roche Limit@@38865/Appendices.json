{"hands_on_practices": [{"introduction": "A fundamental application of the Roche limit is understanding why some celestial bodies can orbit closer to their parent planet than others. This practice explores a key factor in this relationship: the density of the satellite itself. By comparing two hypothetical moonlets of different compositions—one of ice and one of iron—you will use the standard Roche limit formula to see how a satellite's own internal gravity, determined by its density, contributes to its resistance against tidal disruption [@problem_id:1944659].", "problem": "In an extrasolar system, two small, spherical moonlets, Glacies and Ferrum, orbit a large gas giant planet. We can model these moonlets as fluid bodies held together by their own gravity. Glacies is composed primarily of water ice, while Ferrum is composed of dense, rocky and metallic material, which we will approximate as pure iron for this problem.\n\nThe Roche limit is the distance from a primary celestial body within which a secondary body, held together only by its own gravity, will disintegrate due to the primary's tidal forces. For a fluid-like, spherical satellite, this distance, $d$, can be approximated by the formula:\n$$ d \\approx C \\left(\\frac{\\rho_M}{\\rho_m}\\right)^{1/3} $$\nwhere $C$ is a constant that depends on the properties of the primary body (the gas giant), $\\rho_M$ is the average density of the primary body, and $\\rho_m$ is the average density of the satellite moonlet.\n\nAssume the following average densities for the materials composing the moonlets:\n-   Density of Glacies (water ice): $\\rho_{\\text{ice}} = 1000 \\text{ kg/m}^3$\n-   Density of Ferrum (iron): $\\rho_{\\text{iron}} = 8000 \\text{ kg/m}^3$\n\nCalculate the ratio of the Roche limit for the iron moonlet, Ferrum, to the Roche limit for the ice moonlet, Glacies. That is, compute the value of the ratio $d_{\\text{Ferrum}} / d_{\\text{Glacies}}$. Express your answer as a single numerical value.", "solution": "We use the given Roche limit approximation for a fluid-like, spherical satellite:\n$$\nd \\approx C \\left(\\frac{\\rho_{M}}{\\rho_{m}}\\right)^{1/3},\n$$\nwhere $C$ and $\\rho_{M}$ are properties of the primary body (the gas giant), and $\\rho_{m}$ is the density of the satellite. For two satellites orbiting the same primary, $C$ and $\\rho_{M}$ are identical, so the ratio of their Roche limits is determined solely by their densities.\n\nLet $d_{\\text{Ferrum}}$ and $d_{\\text{Glacies}}$ be the Roche limits for Ferrum and Glacies, with densities $\\rho_{\\text{iron}}$ and $\\rho_{\\text{ice}}$, respectively. Then\n$$\n\\frac{d_{\\text{Ferrum}}}{d_{\\text{Glacies}}}\n= \\frac{C \\left(\\frac{\\rho_{M}}{\\rho_{\\text{iron}}}\\right)^{1/3}}{C \\left(\\frac{\\rho_{M}}{\\rho_{\\text{ice}}}\\right)^{1/3}}\n= \\left(\\frac{\\rho_{M}}{\\rho_{\\text{iron}}}\\right)^{1/3} \\left(\\frac{\\rho_{\\text{ice}}}{\\rho_{M}}\\right)^{1/3}\n= \\left(\\frac{\\rho_{\\text{ice}}}{\\rho_{\\text{iron}}}\\right)^{1/3}.\n$$\nSubstituting the given densities $\\rho_{\\text{ice}} = 1000 \\text{ kg/m}^{3}$ and $\\rho_{\\text{iron}} = 8000 \\text{ kg/m}^{3}$,\n$$\n\\frac{d_{\\text{Ferrum}}}{d_{\\text{Glacies}}}\n= \\left(\\frac{1000}{8000}\\right)^{1/3}\n= \\left(\\frac{1}{8}\\right)^{1/3}\n= \\frac{1}{2}.\n$$\nThus the ratio is a dimensionless value equal to one-half.", "answer": "$$\\boxed{0.5}$$", "id": "1944659"}, {"introduction": "While the Roche limit is often presented as a fixed formula, its true power comes from understanding its physical origins. This exercise moves beyond simple application and challenges you to derive the condition for tidal stability from first principles [@problem_id:1944654]. By balancing the Sun's disruptive tidal forces against a comet's own self-gravity, you will estimate the minimum density a \"rubble pile\" comet needs to survive a close encounter, gaining a deeper appreciation for the fundamental physics at play.", "problem": "A \"rubble pile\" comet is a celestial body composed of numerous small, rocky pieces held together solely by their mutual gravitational attraction, with negligible cohesive strength. Consider such a comet, modeled as a non-rotating, perfect sphere of uniform density $\\rho_c$. This comet travels in a highly elliptical orbit around the Sun. At its closest approach (perihelion), the distance between the center of the Sun and the center of the comet is $d = 2 R_{\\odot}$, where $R_{\\odot}$ is the radius of the Sun.\n\nDisruption of the comet occurs if the Sun's tidal forces at the comet's surface exceed the comet's own gravitational binding force. Assuming the comet's radius is much smaller than its perihelion distance, estimate the minimum average density $\\rho_{c, \\text{min}}$ the comet must have to survive this pass.\n\nUse the following values for the Sun's properties:\n- Mass of the Sun, $M_{\\odot} = 1.989 \\times 10^{30}$ kg\n- Radius of the Sun, $R_{\\odot} = 6.963 \\times 10^{8}$ m\n\nExpress your final answer in kg/m³, rounded to three significant figures.", "solution": "Assume the comet is a uniform, non-rotating sphere of density $\\rho_{c}$ and radius $R_{c}$ at distance $d$ from the Sun. The comet’s own surface gravity is\n$$\na_{g}=\\frac{G M_{c}}{R_{c}^{2}}, \\quad M_{c}=\\frac{4}{3}\\pi \\rho_{c} R_{c}^{3} \\;\\Rightarrow\\; a_{g}=\\frac{4}{3}\\pi G \\rho_{c} R_{c}.\n$$\nThe differential (tidal) acceleration exerted by the Sun across the comet is obtained from the radial gradient of the Sun’s gravitational field, $|\\partial (G M_{\\odot}/r^{2})/\\partial r|=2 G M_{\\odot}/d^{3}$, acting over a distance $R_{c}$:\n$$\na_{\\text{tidal}}=\\frac{2 G M_{\\odot}}{d^{3}}\\,R_{c}.\n$$\nTo avoid disruption, require $a_{g} \\ge a_{\\text{tidal}}$:\n$$\n\\frac{4}{3}\\pi G \\rho_{c} R_{c} \\ge \\frac{2 G M_{\\odot}}{d^{3}}\\,R_{c}.\n$$\nCancel $G$ and $R_{c}$ to get the density threshold\n$$\n\\rho_{c,\\text{min}}=\\frac{3}{2\\pi}\\,\\frac{M_{\\odot}}{d^{3}}.\n$$\nWith $d=2 R_{\\odot}$ this becomes\n$$\n\\rho_{c,\\text{min}}=\\frac{3 M_{\\odot}}{16 \\pi R_{\\odot}^{3}}.\n$$\nNow substitute the given numerical values. First compute $R_{\\odot}^{3}$:\n$$\nR_{\\odot}^{3}=(6.963 \\times 10^{8}\\,\\text{m})^{3}=(6.963)^{3} \\times 10^{24}\\,\\text{m}^{3}=337.589698 \\times 10^{24}\\,\\text{m}^{3}=3.37589698 \\times 10^{26}\\,\\text{m}^{3}.\n$$\nThen the denominator $16 \\pi R_{\\odot}^{3}$:\n$$\n16 \\pi R_{\\odot}^{3}=16 \\pi \\times 3.37589698 \\times 10^{26}\\,\\text{m}^{3}\\approx 1.69691090426 \\times 10^{28}\\,\\text{m}^{3}.\n$$\nThe numerator is\n$$\n3 M_{\\odot}=3 \\times 1.989 \\times 10^{30}\\,\\text{kg}=5.967 \\times 10^{30}\\,\\text{kg}.\n$$\nTherefore,\n$$\n\\rho_{c,\\text{min}}=\\frac{5.967 \\times 10^{30}}{1.69691090426 \\times 10^{28}}\\,\\text{kg/m}^{3}\\approx 3.516 \\times 10^{2}\\,\\text{kg/m}^{3}\\approx 351.7\\,\\text{kg/m}^{3}.\n$$\nRounded to three significant figures, the minimum density is $352$ in kg/m$^{3}$.", "answer": "$$\\boxed{352}$$", "id": "1944654"}, {"introduction": "The traditional Roche limit provides a powerful static estimate, but real celestial encounters are complex, dynamic events. This advanced practice invites you to step into the role of a computational astrophysicist by simulating the full gravitational interaction of a binary comet flying by a star [@problem_id:2447942]. By numerically integrating the equations of motion, you will investigate how an object's trajectory and internal energy evolve over time and apply a precise, physically-motivated criterion to determine if it is truly torn apart, offering a glimpse into how modern science tackles problems that defy simple analytic solutions.", "problem": "You are to write a complete, runnable program that simulates, by direct Newtonian gravitational integration, the tidal interaction of a binary comet (modeled as two gravitationally bound point masses) during a single flyby past a star. The goal is to determine, for each specified case, whether the binary is tidally disrupted according to a precise energetic and kinematic criterion.\n\nPhysical model and equations. Consider a star of mass $M_{\\star}$ fixed at the origin. Two cometary components with masses $m_1$ and $m_2$ move under Newtonian gravity, interacting with the star and with each other. Let $\\mathbf{r}_1(t)$ and $\\mathbf{r}_2(t)$ be their position vectors relative to the star and $\\mathbf{v}_1(t)$ and $\\mathbf{v}_2(t)$ their velocities. The equations of motion are governed by the gravitational constant $G$ and read\n$$\n\\ddot{\\mathbf{r}}_1 = -\\frac{G M_{\\star}}{\\lVert \\mathbf{r}_1 \\rVert^3}\\,\\mathbf{r}_1 \\;-\\; G m_2 \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert^3}, \n\\qquad\n\\ddot{\\mathbf{r}}_2 = -\\frac{G M_{\\star}}{\\lVert \\mathbf{r}_2 \\rVert^3}\\,\\mathbf{r}_2 \\;-\\; G m_1 \\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_1 \\rVert^3}.\n$$\n\nInitial conditions. The binary comet’s center of mass starts at distance $r_0$ from the star on the $+x$ axis and follows a star-centric parabolic orbit with prescribed periastron distance $q$. Let $\\mathbf{r}_{\\mathrm{COM}}(0) = (r_0, 0, 0)$ with $r_0 = 5 q$, and let the initial center-of-mass velocity be chosen so that the specific orbital energy is zero and the periastron equals $q$. In polar components at $r=r_0$,\n$$\nh = \\sqrt{2 G M_{\\star} q}, \\quad v_t = \\frac{h}{r_0}, \\quad v_r = -\\sqrt{\\frac{2 G M_{\\star}}{r_0} - v_t^2},\n$$\nso that $\\mathbf{v}_{\\mathrm{COM}}(0) = (v_r, v_t, 0)$. The internal binary is initialized as a circular mutual orbit of separation $s_0$ with relative position vector $\\mathbf{r}_{12}(0) = (0, s_0, 0)$ and relative speed $v_{\\mathrm{rel}} = \\sqrt{G (m_1 + m_2)/s_0}$ tangent to $\\mathbf{r}_{12}$. With total mass $m_{\\mathrm{tot}} = m_1 + m_2$, set\n$$\n\\mathbf{r}_1(0) = \\mathbf{r}_{\\mathrm{COM}}(0) + \\frac{m_2}{m_{\\mathrm{tot}}}\\,\\mathbf{r}_{12}(0), \n\\quad \n\\mathbf{r}_2(0) = \\mathbf{r}_{\\mathrm{COM}}(0) - \\frac{m_1}{m_{\\mathrm{tot}}}\\,\\mathbf{r}_{12}(0),\n$$\nand\n$\n\\mathbf{u}_1 = \\frac{m_2}{m_{\\mathrm{tot}}}\\,(v_{\\mathrm{rel}}, 0, 0), \\;\n\\mathbf{u}_2 = -\\frac{m_1}{m_{\\mathrm{tot}}}\\,(v_{\\mathrm{rel}}, 0, 0),\n$\nso that\n$\n\\mathbf{v}_1(0) = \\mathbf{v}_{\\mathrm{COM}}(0) + \\mathbf{u}_1,\\;\n\\mathbf{v}_2(0) = \\mathbf{v}_{\\mathrm{COM}}(0) + \\mathbf{u}_2.\n$\n\nSimulation interval. Integrate the motion from $t=0$ to\n$$\nt_{\\mathrm{final}} = 30 \\,\\sqrt{\\frac{q^3}{G M_{\\star}}},\n$$\nwhich is long enough to capture the periastron passage and subsequent separation for the given cases.\n\nDisruption criterion. Define the relative position $\\mathbf{r}(t) = \\mathbf{r}_1(t) - \\mathbf{r}_2(t)$ with magnitude $r(t) = \\lVert \\mathbf{r}(t) \\rVert$ and relative velocity $\\mathbf{v}(t) = \\mathbf{v}_1(t) - \\mathbf{v}_2(t)$. Let the reduced mass be $\\mu = \\frac{m_1 m_2}{m_1 + m_2}$. The relative mechanical energy is\n$$\nE_{\\mathrm{rel}}(t) = \\frac{1}{2}\\,\\mu \\,\\lVert \\mathbf{v}(t) \\rVert^2 - \\frac{G m_1 m_2}{r(t)}.\n$$\nLet $t_p$ be the time of periastron of the center of mass with respect to the star (the time at which $\\lVert \\mathbf{r}_{\\mathrm{COM}}(t) \\rVert$ is minimal). The binary is deemed “disrupted” if and only if there exists some time $t \\ge t_p$ such that simultaneously\n$$\nE_{\\mathrm{rel}}(t) > 0, \\quad r(t) > 3 s_0, \\quad \\frac{d r}{d t}(t) > 0.\n$$\nOtherwise, it is considered “bound.”\n\nConstants and units. Use the following constants and parameters, with all inputs and outputs expressed in SI units: $G = 6.67430\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$, $M_{\\star} = 1.98847\\times 10^{30}\\ \\mathrm{kg}$, $R_{\\star} = 6.957\\times 10^{8}\\ \\mathrm{m}$. The comet components have masses $m_1 = 1.2\\times 10^{13}\\ \\mathrm{kg}$ and $m_2 = 0.8\\times 10^{13}\\ \\mathrm{kg}$, and initial separation $s_0 = 4.0\\times 10^{3}\\ \\mathrm{m}$. No physical radii are used in the dynamics; treat the comet components as point masses. Angles, if any are used internally, must be in radians.\n\nTest suite. Run three independent cases that only differ in the center-of-mass periastron distance $q$:\n- Case A (outside the classical Roche limit): $q = 5.0\\,R_{\\star}$.\n- Case B (near the classical Roche limit from outside): $q = 4.5\\,R_{\\star}$.\n- Case C (well inside the classical Roche limit): $q = 1.5\\,R_{\\star}$.\n\nRequired program output. Your program must produce a single line containing a Python-style list of three boolean values corresponding to Cases A, B, and C, in that order, where each value is True if the binary is disrupted according to the criterion above and False otherwise. The printed line must have the exact format\n$\n[\\text{result\\_A},\\text{result\\_B},\\text{result\\_C}]\n$\nwith no extra text. For example, a valid output might look like $[\\mathrm{False},\\mathrm{False},\\mathrm{True}]$.", "solution": "The problem statement has been analyzed and is determined to be valid. It is a well-posed initial value problem in computational physics, grounded in the established principles of Newtonian mechanics. All necessary constants, equations, initial conditions, and criteria for analysis are provided, and they are scientifically and mathematically consistent. There are no ambiguities or contradictions that would prevent a rigorous and unique solution.\n\nThe problem requires the numerical integration of the equations of motion for a three-body system, comprising a central star of mass $M_{\\star}$ and two cometary components of mass $m_1$ and $m_2$. The goal is to determine if the binary comet is tidally disrupted during a parabolic flyby.\n\nThe state of the two cometary components at any time $t$ can be described by a $12$-dimensional state vector $\\mathbf{Y}(t)$, which concatenates their position and velocity vectors:\n$$\n\\mathbf{Y}(t) = \\begin{bmatrix} \\mathbf{r}_1(t) \\\\ \\mathbf{r}_2(t) \\\\ \\mathbf{v}_1(t) \\\\ \\mathbf{v}_2(t) \\end{bmatrix} \\in \\mathbb{R}^{12}\n$$\nThe time evolution of this state is governed by a system of first-order ordinary differential equations (ODEs), $\\frac{d\\mathbf{Y}}{dt} = f(t, \\mathbf{Y})$. This system is constructed from the given second-order equations of motion:\n$$\n\\frac{d\\mathbf{r}_1}{dt} = \\mathbf{v}_1, \\quad \\frac{d\\mathbf{r}_2}{dt} = \\mathbf{v}_2\n$$\n$$\n\\frac{d\\mathbf{v}_1}{dt} = \\mathbf{a}_1 = -\\frac{G M_{\\star}}{\\lVert \\mathbf{r}_1 \\rVert^3}\\,\\mathbf{r}_1 - G m_2 \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert^3}\n$$\n$$\n\\frac{d\\mathbf{v}_2}{dt} = \\mathbf{a}_2 = -\\frac{G M_{\\star}}{\\lVert \\mathbf{r}_2 \\rVert^3}\\,\\mathbf{r}_2 - G m_1 \\frac{\\mathbf{r}_2 - \\mathbf{r}_1}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_1 \\rVert^3}\n$$\nwhere $\\mathbf{a}_1$ and $\\mathbf{a}_2$ are the acceleration vectors for mass $m_1$ and $m_2$, respectively.\n\nFor each of the three test cases defined by a periastron distance $q$, the initial state vector $\\mathbf{Y}(0)$ is calculated. First, the properties of the center-of-mass (COM) orbit are determined. The COM starts at $\\mathbf{r}_{\\mathrm{COM}}(0) = (r_0, 0, 0)$ where $r_0 = 5q$. For a parabolic orbit, the initial velocity $\\mathbf{v}_{\\mathrm{COM}}(0) = (v_r, v_t, 0)$ is found using the specific angular momentum $h = \\sqrt{2 G M_{\\star} q}$, which gives the tangential component $v_t = h/r_0$. The radial component $v_r = -\\sqrt{\\frac{2 G M_{\\star}}{r_0} - v_t^2}$ is derived from the vis-viva equation for a zero-energy orbit.\n\nNext, the initial internal state of the binary is set up. The total mass is $m_{\\mathrm{tot}} = m_1 + m_2$. The initial relative separation vector is $\\mathbf{r}_{12}(0) = \\mathbf{r}_1(0) - \\mathbf{r}_2(0) = (0, s_0, 0)$. The initial relative velocity required for a circular orbit is of magnitude $v_{\\mathrm{rel}} = \\sqrt{G (m_1 + m_2)/s_0}$ and is directed perpendicular to the separation vector. The problem specifies the corresponding velocity vectors $\\mathbf{u}_1$ and $\\mathbf{u}_2$ in the COM frame. The individual initial positions and velocities for $m_1$ and $m_2$ are then constructed by combining the COM motion and the internal motion:\n$$\n\\mathbf{r}_1(0) = \\mathbf{r}_{\\mathrm{COM}}(0) + \\frac{m_2}{m_{\\mathrm{tot}}}\\mathbf{r}_{12}(0), \\quad \\mathbf{r}_2(0) = \\mathbf{r}_{\\mathrm{COM}}(0) - \\frac{m_1}{m_{\\mathrm{tot}}}\\mathbf{r}_{12}(0)\n$$\n$$\n\\mathbf{v}_1(0) = \\mathbf{v}_{\\mathrm{COM}}(0) + \\mathbf{u}_1, \\quad \\mathbf{v}_2(0) = \\mathbf{v}_{\\mathrm{COM}}(0) + \\mathbf{u}_2\n$$\nWith the initial state vector $\\mathbf{Y}(0)$ established, the system of ODEs is numerically integrated from $t=0$ to $t_{\\mathrm{final}} = 30 \\sqrt{q^3 / (G M_{\\star})}$. The `scipy.integrate.solve_ivp` function with an adaptive Runge-Kutta method (such as `RK45`) is appropriate for this task. High-precision tolerances (e.g., $rtol=10^{-8}, atol=10^{-8}$) are necessary to ensure accuracy in orbital calculations. The `dense_output=True` option is essential, as it provides a continuous representation of the solution, which is required for subsequent analysis.\n\nFollowing the integration, the disruption criterion must be evaluated. This requires first determining the time of periastron, $t_p$, for the COM. This is the time $t \\in [0, t_{\\mathrm{final}}]$ that minimizes the distance $\\lVert \\mathbf{r}_{\\mathrm{COM}}(t) \\rVert = \\lVert (m_1 \\mathbf{r}_1(t) + m_2 \\mathbf{r}_2(t)) / m_{\\mathrm{tot}} \\rVert$. This minimum is found efficiently by applying a numerical optimization algorithm, such as `scipy.optimize.minimize_scalar`, to the dense output of the integrator.\n\nFinally, for each time step $t \\ge t_p$, the disruption conditions are checked. The binary is considered disrupted if there exists a time $t$ in this interval where all three of the following conditions hold simultaneously:\n1.  The relative energy is positive: $E_{\\mathrm{rel}}(t) = \\frac{1}{2}\\mu \\lVert \\mathbf{v}(t) \\rVert^2 - \\frac{G m_1 m_2}{r(t)} > 0$, where $\\mathbf{r}(t) = \\mathbf{r}_1 - \\mathbf{r}_2$, $\\mathbf{v}(t) = \\mathbf{v}_1 - \\mathbf{v}_2$, and $\\mu = \\frac{m_1 m_2}{m_1+m_2}$.\n2.  The separation is significant: $r(t) = \\lVert \\mathbf{r}(t) \\rVert > 3s_0$.\n3.  The components are moving apart: $\\frac{dr}{dt}(t) = \\frac{\\mathbf{r}(t) \\cdot \\mathbf{v}(t)}{r(t)} > 0$.\n\nThe check is performed over a fine grid of time points from $t_p$ to $t_{\\mathrm{final}}$. If the conditions are met, the result for that case is `True`; otherwise, it is `False`. This procedure is repeated for each of the three specified values of $q$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    # Define physical constants in SI units.\n    G = 6.67430e-11  # Gravitational constant\n    M_STAR = 1.98847e30  # Mass of the star\n    R_STAR = 6.957e8  # Radius of the star\n    M1 = 1.2e13  # Mass of comet component 1\n    M2 = 0.8e13  # Mass of comet component 2\n    S0 = 4.0e3  # Initial separation of the binary comet\n\n    # Define the periastron distances for the three test cases.\n    test_cases_q = [\n        5.0 * R_STAR,  # Case A\n        4.5 * R_STAR,  # Case B\n        1.5 * R_STAR,  # Case C\n    ]\n\n    results = []\n    # Loop through each case, run the simulation, and store the result.\n    for q in test_cases_q:\n        disrupted = run_simulation_case(q, G, M_STAR, R_STAR, M1, M2, S0)\n        results.append(disrupted)\n\n    # Print the final results in the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef derivatives(t, y, G, M_star, m1, m2):\n    \"\"\"\n    Computes the time derivative of the state vector for the two cometary bodies.\n    The state vector y is a 12-element array: [r1_x, r1_y, r1_z, r2_x, r2_y, r2_z, v1_x, v1_y, v1_z, v2_x, v2_y, v2_z].\n    \"\"\"\n    r1 = y[0:3]\n    r2 = y[3:6]\n    v1 = y[6:9]\n    v2 = y[9:12]\n\n    # Calculate vector norms and separation vectors.\n    r1_norm = np.linalg.norm(r1)\n    r2_norm = np.linalg.norm(r2)\n    r12_vec = r1 - r2\n    r12_norm = np.linalg.norm(r12_vec)\n    \n    # To prevent division by zero in case of a collision (highly unlikely).\n    if r1_norm == 0 or r2_norm == 0 or r12_norm == 0:\n        return np.zeros_like(y)\n\n    # Calculate accelerations based on Newtonian gravity.\n    # a1 = (force on m1 from star) + (force on m1 from m2)\n    a1 = -G * M_star * r1 / r1_norm**3 - G * m2 * r12_vec / r12_norm**3\n    # a2 = (force on m2 from star) + (force on m2 from m1)\n    a2 = -G * M_star * r2 / r2_norm**3 + G * m1 * r12_vec / r12_norm**3\n\n    # Return the derivatives [dr1/dt, dr2/dt, dv1/dt, dv2/dt]\n    return np.concatenate((v1, v2, a1, a2))\n\ndef run_simulation_case(q, G, M_star, R_star, m1, m2, s0):\n    \"\"\"\n    Runs the simulation for a single case defined by the periastron distance q.\n    \"\"\"\n    # 1. Calculate Initial Conditions\n    m_tot = m1 + m2\n    mu = (m1 * m2) / m_tot\n\n    # COM initial conditions for a parabolic orbit\n    r0 = 5.0 * q\n    r_com_0 = np.array([r0, 0.0, 0.0])\n    \n    h = np.sqrt(2 * G * M_star * q)\n    v_t = h / r0\n    # The term under the square root simplifies to 2*G*M_star/r0 - (2*G*M_star*q)/r0^2\n    v_r = -np.sqrt(2 * G * M_star / r0 - v_t**2)\n    v_com_0 = np.array([v_r, v_t, 0.0])\n\n    # Internal binary initial conditions for a circular mutual orbit\n    r12_0 = np.array([0.0, s0, 0.0])\n    v_rel = np.sqrt(G * m_tot / s0)\n    \n    u1 = (m2 / m_tot) * np.array([v_rel, 0.0, 0.0])\n    u2 = -(m1 / m_tot) * np.array([v_rel, 0.0, 0.0])\n\n    r1_0 = r_com_0 + (m2 / m_tot) * r12_0\n    r2_0 = r_com_0 - (m1 / m_tot) * r12_0\n    v1_0 = v_com_0 + u1\n    v2_0 = v_com_0 + u2\n\n    y0 = np.concatenate((r1_0, r2_0, v1_0, v2_0))\n\n    # 2. Integrate ODE\n    t_final = 30.0 * np.sqrt(q**3 / (G * M_star))\n    \n    sol = solve_ivp(\n        fun=derivatives,\n        t_span=[0, t_final],\n        y0=y0,\n        method='RK45',\n        args=(G, M_star, m1, m2),\n        dense_output=True,\n        rtol=1e-8,\n        atol=1e-8\n    )\n\n    # 3. Find Periastron Time (t_p)\n    def com_distance_sq(t):\n        y = sol.sol(t)\n        r1 = y[0:3]\n        r2 = y[3:6]\n        r_com = (m1 * r1 + m2 * r2) / m_tot\n        return np.dot(r_com, r_com)\n\n    res = minimize_scalar(com_distance_sq, bounds=(0, t_final), method='bounded')\n    t_p = res.x\n\n    # 4. Check Disruption Criterion\n    # Evaluate solution on a fine grid from t_p to t_final\n    times_to_check = np.linspace(t_p, t_final, 2000)\n    ys = sol.sol(times_to_check)\n    \n    G_m1_m2 = G * m1 * m2\n\n    for i in range(len(times_to_check)):\n        r1 = ys[0:3, i]\n        r2 = ys[3:6, i]\n        v1 = ys[6:9, i]\n        v2 = ys[9:12, i]\n\n        r_vec = r1 - r2\n        v_vec = v1 - v2\n        \n        r = np.linalg.norm(r_vec)\n        v_sq = np.dot(v_vec, v_vec)\n\n        # Condition 1: Relative energy\n        E_rel = 0.5 * mu * v_sq - G_m1_m2 / r\n        if E_rel <= 0:\n            continue\n\n        # Condition 2: Separation\n        if r <= 3 * s0:\n            continue\n        \n        # Condition 3: Rate of change of separation\n        dr_dt = np.dot(r_vec, v_vec) / r\n        if dr_dt <= 0:\n            continue\n\n        # If all three conditions are met, the binary is disrupted.\n        return True\n\n    # If the loop finishes without disruption, it is considered bound.\n    return False\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2447942"}]}