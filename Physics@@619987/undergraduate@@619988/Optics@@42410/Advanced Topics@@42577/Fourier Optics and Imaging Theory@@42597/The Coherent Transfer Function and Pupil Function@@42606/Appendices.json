{"hands_on_practices": [{"introduction": "The most fundamental principle connecting the pupil function and the Coherent Transfer Function (CTF) is that the CTF is a scaled replica of the pupil aperture. This exercise provides a direct, hands-on comparison of how two common pupil shapes—a circle and a square—with identical areas affect a system's frequency response. By calculating and comparing their cutoff frequencies, you will gain a concrete understanding of how pupil geometry directly dictates the resolution limits of a coherent imaging system [@problem_id:2259626].", "problem": "In a coherent optical imaging system, the ability to resolve fine details is fundamentally limited by diffraction at the system's aperture, often called the pupil. This limitation is described by the Coherent Transfer Function (CTF), which specifies the range of spatial frequencies the system can transmit to the image.\n\nThe CTF, denoted as $H(f_x, f_y)$, can be understood as a scaled version of the pupil function, $P(u, v)$. The pupil function is defined in the pupil plane coordinates $(u, v)$ and has a value of 1 inside the open aperture and 0 outside. The relationship between the spatial frequency coordinates $(f_x, f_y)$ and the pupil plane coordinates is given by $f_x = u/(\\lambda d_i)$ and $f_y = v/(\\lambda d_i)$, where $\\lambda$ is the wavelength of the coherent light and $d_i$ is the distance from the imaging lens to the image plane.\n\nThe \"cutoff frequency\" in a particular direction is the maximum spatial frequency magnitude in that direction for which the CTF is non-zero. This corresponds to the maximum spatial-extent of the pupil from the origin along the corresponding axis in the pupil plane.\n\nConsider two different coherent imaging systems that are identical except for their pupil shapes.\n- System A uses a circular pupil with a radius $R$.\n- System B uses a square pupil with a side length $L$. The sides of the square are oriented parallel to the $u$ and $v$ axes.\n\nThe areas of the two pupils are designed to be exactly the same.\n\nDetermine the ratio of the cutoff frequency of the circular pupil system (System A) to the cutoff frequency of the square pupil system (System B), where both cutoff frequencies are measured along the $f_x$-axis direction. Present your answer as a single closed-form analytic expression.", "solution": "For coherent imaging, the CTF $H(f_{x},f_{y})$ is a scaled version of the pupil function $P(u,v)$ via the mapping $u=\\lambda d_{i} f_{x}$ and $v=\\lambda d_{i} f_{y}$. Therefore, along the $f_{x}$-axis (i.e., $f_{y}=0$), the cutoff frequency is determined by the maximum extent of the pupil along the $u$-axis, scaled by $\\lambda d_{i}$. Specifically, if $u_{\\max}$ is the maximum value of $|u|$ for which $P(u,0)=1$, then the cutoff frequency along $f_{x}$ is\n$$\nf_{c}=\\frac{u_{\\max}}{\\lambda d_{i}}.\n$$\nFor System A (circular pupil of radius $R$), the maximum extent along the $u$-axis is $u_{\\max}^{(A)}=R$, giving\n$$\nf_{c}^{(A)}=\\frac{R}{\\lambda d_{i}}.\n$$\nFor System B (square pupil of side length $L$, axis-aligned), the maximum extent along the $u$-axis is $u_{\\max}^{(B)}=\\frac{L}{2}$, giving\n$$\nf_{c}^{(B)}=\\frac{L}{2\\lambda d_{i}}.\n$$\nThe areas are equal: for the circle $\\pi R^{2}$ and for the square $L^{2}$, so\n$$\n\\pi R^{2}=L^{2}\\quad\\Rightarrow\\quad L=\\sqrt{\\pi}\\,R.\n$$\nThe desired ratio is\n$$\n\\frac{f_{c}^{(A)}}{f_{c}^{(B)}}=\\frac{\\frac{R}{\\lambda d_{i}}}{\\frac{L}{2\\lambda d_{i}}}=\\frac{2R}{L}=\\frac{2R}{\\sqrt{\\pi}\\,R}=\\frac{2}{\\sqrt{\\pi}}.\n$$\nThis ratio is independent of $\\lambda$ and $d_{i}$ because they cancel in the quotient.", "answer": "$$\\boxed{\\frac{2}{\\sqrt{\\pi}}}$$", "id": "2259626"}, {"introduction": "Real-world optical systems often employ complex aperture shapes to achieve specific imaging characteristics. This practice moves beyond simple pupils to a more intricate cross-shaped aperture, introducing a powerful analytical technique: decomposing a complex function using the principle of inclusion-exclusion. Mastering this method will enable you to calculate the far-field diffraction pattern—and thus the CTF—for a wide variety of engineered pupils by breaking them down into simpler, manageable parts [@problem_id:2259611].", "problem": "In a coherent optical imaging system, the aperture stop in the pupil plane is defined by a transparent, cross-shaped opening on an otherwise opaque screen. The pupil plane is described by a Cartesian coordinate system $(u, v)$. The cross is centered at the origin and is formed by the union of two rectangular regions: a vertical rectangle with width $w$ and height $L$, and a horizontal rectangle with width $L$ and height $w$. It is given that $L > w$.\n\nA uniform monochromatic plane wave is incident normally upon this aperture. The resulting far-field (Fraunhofer) diffraction pattern is observed. Determine an expression, up to an overall constant of proportionality, for the complex amplitude distribution in the far-field pattern. Express your answer as a function of the spatial frequencies $(f_x, f_y)$ and the aperture dimensions $L$ and $w$.\n\nFor your calculations, use the unnormalized sinc function, which is defined as $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$.", "solution": "The Fraunhofer diffraction amplitude in the far field is proportional to the Fourier transform of the aperture transmission function. With pupil-plane coordinates $(u,v)$ and spatial frequencies $(f_{x},f_{y})$, the complex amplitude is, up to an overall constant independent of $(f_{x},f_{y})$,\n$$\nU(f_{x},f_{y}) \\propto \\iint T(u,v)\\,\\exp\\!\\left(-i 2\\pi\\left(f_{x}u+f_{y}v\\right)\\right)\\,du\\,dv,\n$$\nwhere $T(u,v)$ is the characteristic function of the cross-shaped aperture.\n\nThe cross is the union of:\n- a vertical rectangle of width $w$ (along $u$) and height $L$ (along $v$), and\n- a horizontal rectangle of width $L$ (along $u$) and height $w$ (along $v$),\n\nboth centered at the origin. Using inclusion–exclusion to avoid double counting the overlap, the indicator function is\n$$\nT(u,v)=R_{w,L}(u,v)+R_{L,w}(u,v)-R_{w,w}(u,v),\n$$\nwhere $R_{a,b}(u,v)$ equals $1$ for $|u|\\leq a/2$ and $|v|\\leq b/2$, and $0$ otherwise.\n\nThe Fourier transform of a centered rectangle of size $a\\times b$ factorizes:\n$$\n\\iint_{|u|\\leq a/2,\\;|v|\\leq b/2}\\exp\\!\\left(-i 2\\pi\\left(f_{x}u+f_{y}v\\right)\\right)\\,du\\,dv\n=\\left(\\int_{-a/2}^{a/2}\\exp(-i2\\pi f_{x}u)\\,du\\right)\\left(\\int_{-b/2}^{b/2}\\exp(-i2\\pi f_{y}v)\\,dv\\right).\n$$\nEach one-dimensional integral evaluates to\n$$\n\\int_{-a/2}^{a/2}\\exp(-i2\\pi f u)\\,du=a\\,\\text{sinc}(a f),\n$$\nwhere $\\text{sinc}(x)=\\frac{\\sin(\\pi x)}{\\pi x}$. Therefore,\n$$\n\\mathcal{F}\\{R_{a,b}\\}(f_{x},f_{y})=ab\\,\\text{sinc}(a f_{x})\\,\\text{sinc}(b f_{y}).\n$$\n\nBy linearity and inclusion–exclusion,\n$$\nU(f_{x},f_{y}) \\propto wL\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(L f_{y})\n+Lw\\,\\text{sinc}(L f_{x})\\,\\text{sinc}(w f_{y})\n-w^{2}\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(w f_{y}).\n$$\nThis gives the complex amplitude distribution in the Fraunhofer region up to an overall constant of proportionality. Equivalently, one may factor $wL$ to write\n$$\nU(f_{x},f_{y}) \\propto wL\\left[\\text{sinc}(w f_{x})\\,\\text{sinc}(L f_{y})\n+\\text{sinc}(L f_{x})\\,\\text{sinc}(w f_{y})\n-\\frac{w}{L}\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(w f_{y})\\right].\n$$\nEither form is valid since the overall constant can absorb $wL$.", "answer": "$$\\boxed{wL\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(L f_{y})+Lw\\,\\text{sinc}(L f_{x})\\,\\text{sinc}(w f_{y})-w^{2}\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(w f_{y})}$$", "id": "2259611"}, {"introduction": "Our final practice reverses the direction of analysis, bridging the gap between theoretical design and experimental characterization. Instead of predicting performance from a known pupil, this problem shows how to determine the system's complete frequency response from limited, practical measurements of its Point Spread Function (PSF). You will leverage the property of separability, a common simplification in optical design, to reconstruct the full two-dimensional CTF from just two one-dimensional cross-sections, a technique central to practical system evaluation [@problem_id:2259613].", "problem": "An optical engineer is characterizing a novel coherent imaging system. The system's performance is described by its coherent Point Spread Function (PSF), denoted as $h(x, y)$, which is the image of an ideal point source. The system's response to different spatial frequencies is given by the coherent Transfer Function (CTF), $H(f_x, f_y)$, which is related to the PSF by the two-dimensional Fourier transform. The Fourier transform and its inverse are defined as:\n$$\nH(f_x, f_y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} h(x, y) \\exp(-i 2\\pi (f_x x + f_y y)) \\,dx\\,dy\n$$\n$$\nh(x, y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} H(f_x, f_y) \\exp(i 2\\pi (x f_x + y f_y)) \\,df_x\\,df_y\n$$\nFrom the design of the optical components, the engineer knows that the PSF is separable in Cartesian coordinates, meaning it can be written as a product of two one-dimensional functions, $h(x, y) = h_X(x)h_Y(y)$.\n\nBy placing a narrow slit aperture along the $y$-axis and then along the $x$-axis, the engineer measures the cross-sectional profiles of the PSF. The measurements yield the following functions:\n- Along the x-axis: $h(x, 0) = A_0 \\left(1 - \\frac{|x|}{W_x}\\right)$ for $|x| \\le W_x$, and $h(x, 0) = 0$ otherwise.\n- Along the y-axis: $h(0, y) = A_0 \\left(1 - \\frac{|y|}{W_y}\\right)$ for $|y| \\le W_y$, and $h(0, y) = 0$ otherwise.\n\nHere, $A_0$, $W_x$, and $W_y$ are known positive real constants representing the peak amplitude and the spatial extents of the PSF, respectively.\n\nBased on this information, derive a complete expression for the two-dimensional coherent Transfer Function $H(f_x, f_y)$ of the system in terms of the given parameters and the spatial frequencies $f_x$ and $f_y$.", "solution": "We are given that the coherent PSF is separable, so it can be written as $h(x,y)=h_{X}(x)h_{Y}(y)$. The measured cross-sections along the axes are\n$h(x,0)=A_{0}\\left(1-\\frac{|x|}{W_{x}}\\right)$ for $|x|\\leq W_{x}$ and $0$ otherwise, and\n$h(0,y)=A_{0}\\left(1-\\frac{|y|}{W_{y}}\\right)$ for $|y|\\leq W_{y}$ and $0$ otherwise.\nSince $h(x,0)=h_{X}(x)h_{Y}(0)$ and $h(0,y)=h_{X}(0)h_{Y}(y)$, and the triangular shapes have unit peak at the origin, we can write\n$h_{X}(x)=C_{x}\\,t_{x}(x)$ and $h_{Y}(y)=C_{y}\\,t_{y}(y)$\nwith\n$t_{x}(x)=\\begin{cases}1-\\frac{|x|}{W_{x}},&|x|\\leq W_{x}\\\\0,&\\text{otherwise}\\end{cases}$ and $t_{y}(y)=\\begin{cases}1-\\frac{|y|}{W_{y}},&|y|\\leq W_{y}\\\\0,&\\text{otherwise}\\end{cases}$,\nand the product of constants satisfies $C_{x}C_{y}=A_{0}$ so that $h(x,0)=A_{0}t_{x}(x)$ and $h(0,y)=A_{0}t_{y}(y)$ as measured.\n\nWith the given Fourier transform convention,\n$$\nH(f_{x},f_{y})=\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}h(x,y)\\exp\\!\\big(-i2\\pi(f_{x}x+f_{y}y)\\big)\\,dx\\,dy,\n$$\nthe separability implies\n$$\nH(f_{x},f_{y})=\\left(\\int_{-\\infty}^{\\infty}h_{X}(x)\\exp(-i2\\pi f_{x}x)\\,dx\\right)\\left(\\int_{-\\infty}^{\\infty}h_{Y}(y)\\exp(-i2\\pi f_{y}y)\\,dy\\right)\\equiv H_{X}(f_{x})H_{Y}(f_{y}).\n$$\nWe now compute the one-dimensional transforms. Note that the triangular function can be written as a normalized convolution of rectangles:\n$t_{x}(x)=\\frac{1}{W_{x}}\\big(\\mathrm{rect}(x/W_{x})*\\mathrm{rect}(x/W_{x})\\big)$,\nwhere $\\mathrm{rect}(u)=1$ for $|u|\\leq \\frac{1}{2}$ and $0$ otherwise. Using the convolution theorem and the standard transform pair\n$$\n\\int_{-\\infty}^{\\infty}\\mathrm{rect}(x/W)\\exp(-i2\\pi f x)\\,dx=W\\,\\frac{\\sin(\\pi W f)}{\\pi W f},\n$$\nwe obtain\n$$\n\\int_{-\\infty}^{\\infty}t_{x}(x)\\exp(-i2\\pi f_{x}x)\\,dx=W_{x}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2}.\n$$\nTherefore,\n$$\nH_{X}(f_{x})=C_{x}W_{x}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2},\\quad\nH_{Y}(f_{y})=C_{y}W_{y}\\left(\\frac{\\sin(\\pi W_{y} f_{y})}{\\pi W_{y} f_{y}}\\right)^{2}.\n$$\nMultiplying and using $C_{x}C_{y}=A_{0}$ yields the coherent Transfer Function\n$$\nH(f_{x},f_{y})=A_{0}W_{x}W_{y}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2}\\left(\\frac{\\sin(\\pi W_{y} f_{y})}{\\pi W_{y} f_{y}}\\right)^{2}.\n$$\nThis expression is real, even in both $f_{x}$ and $f_{y}$, and satisfies $H(0,0)=\\iint h(x,y)\\,dx\\,dy=A_{0}W_{x}W_{y}$, consistent with the transform definition.", "answer": "$$\\boxed{A_{0}W_{x}W_{y}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2}\\left(\\frac{\\sin(\\pi W_{y} f_{y})}{\\pi W_{y} f_{y}}\\right)^{2}}$$", "id": "2259613"}]}