{"hands_on_practices": [{"introduction": "The fundamental concept in linear imaging theory is that the final image is a \"blurred\" version of the true object. This process is mathematically described by the convolution of the object's light distribution with the system's Point Spread Function (PSF), which is its response to a perfect point source. This exercise provides a concrete, hands-on calculation to solidify your understanding of this convolution process, using a simplified one-dimensional star system to see exactly how the PSF shapes the final image intensity [@problem_id:2264542].", "problem": "A one-dimensional imaging system, used for astronomical observations, is aimed at a distant binary star system. The two stars have identical brightness and are closely spaced. The object's spatial intensity profile, $o(x)$, can be modeled as a sum of two point sources, each emitting a total power (flux) $F_0$. The stars are located at positions $x = -d/2$ and $x = +d/2$. Thus, the object profile is given by $o(x) = F_0 \\left[ \\delta(x + d/2) + \\delta(x - d/2) \\right]$, where $\\delta(x)$ is the Dirac delta function.\n\nDue to imperfections in the optics, the imaging system blurs the point sources. This blurring is characterized by the system's one-dimensional Point Spread Function (PSF), denoted by $h(x)$. The PSF is normalized such that its total area is unity, ensuring that the total detected power equals the total emitted power. The specific form of the PSF for this system is a triangular function:\n$$\nh(x) = \\begin{cases} \\frac{1}{W} \\left(1 - \\frac{|x|}{W}\\right) & \\text{for } |x| \\le W \\\\ 0 & \\text{for } |x| > W \\end{cases}\n$$\nwhere $W$ is a parameter representing the extent of the blur. The final image intensity profile, $i(x)$, is the convolution of the object profile with the PSF.\n\nGiven the following parameters:\n- Total flux from each star, $F_0 = 1.00 \\times 10^{-7}$ W\n- Separation between the stars, $d = 6.00$ micrometers\n- PSF width parameter, $W = 10.0$ micrometers\n\nCalculate the intensity of the resulting image at the midpoint between the geometric centers of the two stellar images (i.e., at $x=0$). Express your answer in units of W/m, rounded to three significant figures.", "solution": "The objectâ€™s one-dimensional intensity profile is $o(x) = F_{0}\\left[\\delta(x+d/2)+\\delta(x-d/2)\\right]$. The image intensity is the convolution of $o(x)$ with the PSF $h(x)$:\n$$\ni(x) = \\int_{-\\infty}^{\\infty} o(\\xi)\\,h(x-\\xi)\\,d\\xi.\n$$\nUsing the sifting property of the Dirac delta and linearity of convolution,\n$$\ni(x) = F_{0}\\left[h\\left(x+\\frac{d}{2}\\right) + h\\left(x-\\frac{d}{2}\\right)\\right].\n$$\nAt the midpoint $x=0$,\n$$\ni(0) = F_{0}\\left[h\\left(\\frac{d}{2}\\right) + h\\left(-\\frac{d}{2}\\right)\\right] = 2F_{0}\\,h\\left(\\frac{d}{2}\\right),\n$$\nsince $h(x)$ is even. The PSF is\n$$\nh(x) = \\begin{cases}\n\\frac{1}{W}\\left(1-\\frac{|x|}{W}\\right), & |x|\\leq W,\\\\\n0, & |x|>W,\n\\end{cases}\n$$\nand with $\\frac{d}{2} < W$ we have\n$$\nh\\left(\\frac{d}{2}\\right) = \\frac{1}{W}\\left(1-\\frac{d}{2W}\\right).\n$$\nTherefore,\n$$\ni(0) = 2F_{0}\\,\\frac{1}{W}\\left(1-\\frac{d}{2W}\\right) = \\frac{2F_{0}}{W} - \\frac{F_{0}d}{W^{2}}.\n$$\nSubstitute the given values with units converted to meters: $F_{0} = 1.00\\times 10^{-7}\\ \\text{W}$, $d = 6.00\\times 10^{-6}\\ \\text{m}$, $W = 1.00\\times 10^{-5}\\ \\text{m}$:\n$$\n\\frac{2F_{0}}{W} = \\frac{2\\times 1.00\\times 10^{-7}}{1.00\\times 10^{-5}} = 2.00\\times 10^{-2}\\ \\text{W/m},\n$$\n$$\n\\frac{F_{0}d}{W^{2}} = \\frac{1.00\\times 10^{-7}\\times 6.00\\times 10^{-6}}{\\left(1.00\\times 10^{-5}\\right)^{2}} = 6.00\\times 10^{-3}\\ \\text{W/m}.\n$$\nHence,\n$$\ni(0) = 2.00\\times 10^{-2} - 6.00\\times 10^{-3} = 1.40\\times 10^{-2}\\ \\text{W/m}.\n$$\nRounded to three significant figures, the intensity at $x=0$ is $1.40\\times 10^{-2}$ in units of W/m.", "answer": "$$\\boxed{1.40 \\times 10^{-2}}$$", "id": "2264542"}, {"introduction": "Now that we have seen how a PSF affects an image, a natural question arises: what physical aspect of an imaging system determines the shape of the PSF itself? In an ideal, aberration-free system, the PSF is fundamentally a consequence of diffraction, and its shape is directly related to the system's aperture, or pupil. This problem explores the profound connection between the pupil's geometry and the resulting diffraction pattern in the image plane, governed by the principles of the Fourier transform [@problem_id:2264538].", "problem": "In an idealized, aberration-free optical imaging system, the distribution of light in the image plane from a single point source of light is described by the Point Spread Function (PSF). The PSF is determined by the diffraction of light from the system's exit pupil. The relationship between the pupil's transmission function, $P(x_p, y_p)$, and the complex amplitude of the light in the focal plane, $U(x_f, y_f)$, is given by a two-dimensional Fourier transform. The pupil function $P(x_p, y_p)$ is equal to 1 for coordinates $(x_p, y_p)$ within the open aperture and 0 otherwise. The PSF is the squared magnitude of this complex amplitude: $\\text{PSF}(x_f, y_f) = |U(x_f, y_f)|^2$.\n\nConsider the shape of the pupil of such a system. Which of the following pupil shapes would produce a PSF whose central bright region is noticeably elongated along the horizontal axis (the $x_f$-axis) and compressed along the vertical axis (the $y_f$-axis)?\n\nA. A circular pupil with radius $R$.\n\nB. A square pupil with side length $L$.\n\nC. A rectangular pupil with a horizontal width of $W$ and a vertical height of $2W$.\n\nD. A rectangular pupil with a horizontal width of $2W$ and a vertical height of $W$.\n\nE. An equilateral triangular pupil.", "solution": "The Fraunhofer diffraction principle states that the complex amplitude in the focal plane is proportional to the Fourier transform of the pupil transmission function. Using focal length $f$ and wavelength $\\lambda$, the scalar diffraction integral gives\n$$\nU(x_{f},y_{f}) \\propto \\iint P(x_{p},y_{p}) \\exp\\!\\left(-i 2\\pi \\frac{x_{p}x_{f}+y_{p}y_{f}}{\\lambda f}\\right)\\,dx_{p}\\,dy_{p}.\n$$\nThe point spread function is the intensity\n$$\n\\text{PSF}(x_{f},y_{f}) = |U(x_{f},y_{f})|^{2}.\n$$\n\nFor separable, rectangular pupils, let the horizontal width be $a$ and the vertical height be $b$. Write the pupil as $P(x_{p},y_{p}) = \\Pi(x_{p}/a)\\,\\Pi(y_{p}/b)$, where $\\Pi$ is the unit rectangle function. The Fourier transform factorizes, yielding\n$$\nU(x_{f},y_{f}) \\propto \\operatorname{sinc}\\!\\left(\\frac{a\\,x_{f}}{\\lambda f}\\right)\\,\\operatorname{sinc}\\!\\left(\\frac{b\\,y_{f}}{\\lambda f}\\right),\n$$\nwith $\\operatorname{sinc}(\\xi) = \\frac{\\sin(\\pi \\xi)}{\\pi \\xi}$. The first zeros of the main lobe occur at\n$$\n\\frac{a\\,x_{f}}{\\lambda f} = \\pm 1 \\quad\\Rightarrow\\quad |x_{f}|=\\frac{\\lambda f}{a}, \n\\qquad\n\\frac{b\\,y_{f}}{\\lambda f} = \\pm 1 \\quad\\Rightarrow\\quad |y_{f}|=\\frac{\\lambda f}{b}.\n$$\nThus, the central lobe width along $x_{f}$ is proportional to $\\lambda f/a$, and along $y_{f}$ to $\\lambda f/b$. Therefore:\n- Larger pupil extent in a given pupil coordinate produces a narrower main lobe along the corresponding focal-plane coordinate.\n- Smaller pupil extent produces a broader main lobe.\n\nApply this to the options:\n\nA. Circular pupil of radius $R$. The amplitude is $U \\propto \\frac{J_{1}(kR\\rho)}{kR\\rho}$ with $k=2\\pi/\\lambda$ and $\\rho=\\sqrt{x_{f}^{2}+y_{f}^{2}}/f$, giving an isotropic Airy pattern. The central bright region is circular, not elongated.\n\nB. Square pupil of side $L$. This is a special case of the rectangle with $a=b=L$, so the main-lobe widths along $x_{f}$ and $y_{f}$ are equal. No elongation.\n\nC. Rectangular pupil with horizontal width $W$ and vertical height $2W$. Here $a=W$ and $b=2W$, so the main-lobe widths are $\\lambda f/W$ along $x_{f}$ and $\\lambda f/(2W)$ along $y_{f}$. Hence the central bright region is wider along $x_{f}$ and narrower along $y_{f}$, i.e., elongated horizontally and compressed vertically, as required.\n\nD. Rectangular pupil with horizontal width $2W$ and vertical height $W$. Here $a=2W$ and $b=W$, giving widths $\\lambda f/(2W)$ horizontally and $\\lambda f/W$ vertically. This produces the opposite effect: compressed horizontally and elongated vertically.\n\nE. Equilateral triangular pupil. Its Fourier transform exhibits threefold rotational symmetry; the central lobe is not specifically elongated along the horizontal axis and compressed along the vertical axis in the manner described. It does not match the stated elongation.\n\nTherefore, only option C produces a PSF with a central bright region elongated along $x_{f}$ and compressed along $y_{f}$.", "answer": "$$\\boxed{C}$$", "id": "2264538"}, {"introduction": "Real-world imaging systems are composed of multiple elements, such as a main lens, relay optics, and a digital sensor, each contributing its own blurring effect to the final image. A powerful feature of modeling these systems as linear is that the overall system response can be determined from its individual parts. This final practice demonstrates how the PSFs of separate subsystems combine to form the total system PSF, illustrating a core principle of systems engineering where the total impulse response is the convolution of the individual impulse responses [@problem_id:2264567].", "problem": "An optical engineer is characterizing a new digital imaging system. The system can be modeled as two independent optical subsystems placed in series: a primary lens and a digital sensor array. For a linear, space-invariant imaging system, the image formed, $I(x, y)$, is the two-dimensional convolution of the true object brightness distribution, $O(x, y)$, with the system's Point Spread Function (PSF), $h(x, y)$. The PSF represents the system's response to an idealized point source of light.\n\nThe blurring effect of each subsystem is described by its own PSF. Assume that both subsystems introduce a circularly symmetric Gaussian blur.\n\nThe PSF of the primary lens, $h_L(x, y)$, is given by:\n$$h_L(x, y) = \\frac{1}{2\\pi \\sigma_L^2} \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_L^2}\\right)$$\nwhere $\\sigma_L$ is the standard deviation characterizing the lens blur.\n\nThe intrinsic PSF of the digital sensor, $h_S(x, y)$, which accounts for effects like charge diffusion between pixels, is given by:\n$$h_S(x, y) = \\frac{1}{2\\pi \\sigma_S^2} \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_S^2}\\right)$$\nwhere $\\sigma_S$ is the standard deviation characterizing the sensor blur.\n\nWhen these two subsystems are combined in series, the overall PSF of the entire imaging system, $h_{total}(x, y)$, is the convolution of their individual PSFs. Determine the analytical expression for the total PSF, $h_{total}(x, y)$, in terms of $x$, $y$, $\\sigma_L$, and $\\sigma_S$.", "solution": "For a linear, space-invariant system, the total PSF is the convolution of the individual PSFs:\n$$\nh_{total}(x,y) = \\iint_{-\\infty}^{\\infty} h_{L}(x-u,y-v)\\,h_{S}(u,v)\\, \\mathrm{d}u\\,\\mathrm{d}v.\n$$\nEach PSF is circularly symmetric Gaussian:\n$$\nh_{L}(x,y) = \\frac{1}{2\\pi \\sigma_{L}^{2}} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\sigma_{L}^{2}}\\right), \\quad\nh_{S}(x,y) = \\frac{1}{2\\pi \\sigma_{S}^{2}} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\sigma_{S}^{2}}\\right).\n$$\nThese are separable in $x$ and $y$, since\n$$\nh_{L}(x,y) = \\left[\\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{x^{2}}{2\\sigma_{L}^{2}}\\right)\\right]\\left[\\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{y^{2}}{2\\sigma_{L}^{2}}\\right)\\right],\n$$\nand similarly for $h_{S}(x,y)$ with $\\sigma_{S}$. Therefore the 2D convolution factorizes into the product of two 1D convolutions in $x$ and $y$. Consider the $x$-component:\n$$\nI_{x}(x) = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{(x-u)^{2}}{2\\sigma_{L}^{2}}\\right)\\,\\frac{1}{\\sqrt{2\\pi}\\sigma_{S}} \\exp\\!\\left(-\\frac{u^{2}}{2\\sigma_{S}^{2}}\\right)\\,\\mathrm{d}u.\n$$\nCombine exponents:\n$$\n-\\frac{(x-u)^{2}}{2\\sigma_{L}^{2}}-\\frac{u^{2}}{2\\sigma_{S}^{2}}=-\\frac{x^{2}}{2\\sigma_{L}^{2}}+\\frac{x}{\\sigma_{L}^{2}}u-\\frac{1}{2}\\left(\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}\\right)u^{2}.\n$$\nDefine $a=\\frac{1}{2}\\left(\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}\\right)$ and $b=\\frac{x}{\\sigma_{L}^{2}}$. Completing the square gives\n$$\n-\\!a u^{2}+b u-\\frac{x^{2}}{2\\sigma_{L}^{2}}=-a\\left(u-\\frac{b}{2a}\\right)^{2}+a\\left(\\frac{b}{2a}\\right)^{2}-\\frac{x^{2}}{2\\sigma_{L}^{2}}.\n$$\nWith $2a=\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}=\\frac{\\sigma_{L}^{2}+\\sigma_{S}^{2}}{\\sigma_{L}^{2}\\sigma_{S}^{2}}$ and $b=\\frac{x}{\\sigma_{L}^{2}}$, we have\n$$\n\\frac{b}{2a}=\\frac{x\\sigma_{S}^{2}}{\\sigma_{L}^{2}+\\sigma_{S}^{2}}, \\quad a\\left(\\frac{b}{2a}\\right)^{2}-\\frac{x^{2}}{2\\sigma_{L}^{2}}=-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}.\n$$\nThus\n$$\nI_{x}(x)=\\frac{1}{2\\pi \\sigma_{L}\\sigma_{S}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right)\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-a\\left(u-\\frac{b}{2a}\\right)^{2}\\right)\\mathrm{d}u.\n$$\nUsing the Gaussian integral $\\int_{-\\infty}^{\\infty}\\exp(-a(u-\\mu)^{2})\\,\\mathrm{d}u=\\sqrt{\\pi/a}$ for $a>0$ and $a=\\frac{\\sigma_{L}^{2}+\\sigma_{S}^{2}}{2\\sigma_{L}^{2}\\sigma_{S}^{2}}$, we obtain\n$$\nI_{x}(x)=\\frac{1}{2\\pi \\sigma_{L}\\sigma_{S}}\\sqrt{\\frac{\\pi}{a}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right)=\\frac{1}{\\sqrt{2\\pi}\\sqrt{\\sigma_{L}^{2}+\\sigma_{S}^{2}}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\nBy the same computation for $y$, we get\n$$\nI_{y}(y)=\\frac{1}{\\sqrt{2\\pi}\\sqrt{\\sigma_{L}^{2}+\\sigma_{S}^{2}}}\\exp\\!\\left(-\\frac{y^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\nTherefore, multiplying the independent $x$ and $y$ results, the total PSF is\n$$\nh_{total}(x,y)=I_{x}(x)\\,I_{y}(y)=\\frac{1}{2\\pi(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\nThis is a circularly symmetric Gaussian with variance equal to the sum of the individual variances, as expected from convolution of independent Gaussian blurs.", "answer": "$$\\boxed{\\frac{1}{2\\pi\\left(\\sigma_{L}^{2}+\\sigma_{S}^{2}\\right)}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\left(\\sigma_{L}^{2}+\\sigma_{S}^{2}\\right)}\\right)}$$", "id": "2264567"}]}