{"hands_on_practices": [{"introduction": "The Kohn-Sham equations present a circular challenge: the effective potential depends on the electron density, which in turn is derived from orbitals obtained by solving for that very potential. To break this circle, computational methods employ an iterative procedure known as the Self-Consistent Field (SCF) cycle. This practice [@problem_id:1768566] deconstructs the SCF loop into its fundamental steps, challenging you to reassemble them into a logical sequence to build a robust mental flowchart of how DFT calculations are practically performed.", "problem": "In the field of computational materials science, Kohn-Sham Density Functional Theory (DFT) is a powerful method for determining the electronic structure of materials. A central part of DFT calculations is an iterative process called the Self-Consistent Field (SCF) cycle, which aims to find the ground-state electron density.\n\nThis iterative cycle involves a sequence of specific computational steps that are repeated until a convergence criterion is met. Below are three of the core tasks performed within a single iteration, presented in alphabetical order:\n\n(A) Calculation of the output electron density, $n_{\\text{out}}(\\mathbf{r})$, by summing the squared magnitudes of the occupied single-particle orbitals.\n(B) Construction of the effective Kohn-Sham potential, $v_{\\text{eff}}(\\mathbf{r})$, which is a function of the input electron density from the current or previous iteration, $n_{\\text{in}}(\\mathbf{r})$.\n(C) Solution of the single-particle Kohn-Sham equations for the current effective potential to determine a new set of single-particle orbitals, $\\{\\psi_j(\\mathbf{r})\\}$.\n\nGiven an input density $n_{\\text{in}}(\\mathbf{r})$ at the start of an iteration, determine the correct chronological sequence of these three tasks to produce an output density $n_{\\text{out}}(\\mathbf{r})$ within that single iteration. Choose the correct sequence from the options below.\n\nA. (A) $\\rightarrow$ (B) $\\rightarrow$ (C)\n\nB. (B) $\\rightarrow$ (A) $\\rightarrow$ (C)\n\nC. (C) $\\rightarrow$ (A) $\\rightarrow$ (B)\n\nD. (B) $\\rightarrow$ (C) $\\rightarrow$ (A)\n\nE. (A) $\\rightarrow$ (C) $\\rightarrow$ (B)\n\nF. (C) $\\rightarrow$ (B) $\\rightarrow$ (A)", "solution": "The goal of the Self-Consistent Field (SCF) cycle in Density Functional Theory (DFT) is to find a ground-state electron density $n(\\mathbf{r})$ that is \"self-consistent\". This means that if we use this density as an input to the calculation, the output density produced by the calculation is the same as the input density. The process is iterative, starting with an initial guess and refining the density at each step until this condition is met. Let's analyze the logical dependencies between the three tasks to establish their correct order.\n\nThe iterative loop starts with a guess for the electron density, which we call the input density, $n_{\\text{in}}(\\mathbf{r})$.\n\nStep 1: The first task in the cycle must be to use this input density $n_{\\text{in}}(\\mathbf{r})$ to construct the quantities needed for the next step. The Kohn-Sham formalism states that the effective potential, $v_{\\text{eff}}(\\mathbf{r})$, is a functional of the electron density. Specifically, $v_{\\text{eff}}[n](\\mathbf{r}) = v_{\\text{ext}}(\\mathbf{r}) + v_{\\text{H}}[n](\\mathbf{r}) + v_{\\text{xc}}[n](\\mathbf{r})$, where the Hartree potential $v_{\\text{H}}$ and the exchange-correlation potential $v_{\\text{xc}}$ both depend on the density $n(\\mathbf{r})$. Therefore, the first logical step is to use $n_{\\text{in}}(\\mathbf{r})$ to calculate $v_{\\text{eff}}(\\mathbf{r})$. This corresponds to task (B).\n\nStep 2: Once the effective potential $v_{\\text{eff}}(\\mathbf{r})$ is known, it can be used to define the single-particle Kohn-Sham Hamiltonian, $\\hat{H}_{\\text{KS}} = -\\frac{\\hbar^2}{2m}\\nabla^2 + v_{\\text{eff}}(\\mathbf{r})$. The next step is to solve the eigenvalue problem for this Hamiltonian, which is the set of Kohn-Sham equations: $\\hat{H}_{\\text{KS}} \\psi_j(\\mathbf{r}) = \\epsilon_j \\psi_j(\\mathbf{r})$. Solving these equations yields the set of single-particle orbitals, $\\{\\psi_j(\\mathbf{r})\\}$, and their corresponding energies, $\\{\\epsilon_j\\}$. This corresponds to task (C). Task (C) must follow task (B) because it requires the potential calculated in (B).\n\nStep 3: After solving the Kohn-Sham equations, we have the orbitals $\\{\\psi_j(\\mathbf{r})\\}$. The fundamental principle of DFT is that the electron density can be constructed from these orbitals. For a system with $N$ electrons, the density is calculated by summing the probability densities of the $N$ lowest-energy (occupied) orbitals. This gives the output electron density, $n_{\\text{out}}(\\mathbf{r}) = \\sum_{j=1}^{N} |\\psi_j(\\mathbf{r})|^2$. This corresponds to task (A). Task (A) must follow task (C) because it requires the orbitals calculated in (C).\n\nTo summarize the flow within one iteration:\n1.  Start with $n_{\\text{in}}(\\mathbf{r})$.\n2.  Perform task (B): Use $n_{\\text{in}}(\\mathbf{r})$ to construct $v_{\\text{eff}}(\\mathbf{r})$.\n3.  Perform task (C): Use $v_{\\text{eff}}(\\mathbf{r})$ to solve for the orbitals $\\{\\psi_j(\\mathbf{r})\\}$.\n4.  Perform task (A): Use the orbitals $\\{\\psi_j(\\mathbf{r})\\}$ to calculate the output density $n_{\\text{out}}(\\mathbf{r})$.\n\nThe correct sequence of tasks is therefore (B) $\\rightarrow$ (C) $\\rightarrow$ (A). After this sequence, the SCF procedure would compare $n_{\\text{out}}(\\mathbf{r})$ to $n_{\\text{in}}(\\mathbf{r})$ to check for convergence. If not converged, a new $n_{\\text{in}}(\\mathbf{r})$ would be generated (often by mixing the old input and new output densities) and the cycle would repeat.\n\nLooking at the given options, the sequence (B) $\\rightarrow$ (C) $\\rightarrow$ (A) corresponds to option D.", "answer": "$$\\boxed{D}$$", "id": "1768566"}, {"introduction": "A cornerstone of the Kohn-Sham method is the construction of the system's electron density from a set of fictitious, non-interacting orbitals. While the orbitals themselves are a mathematical convenience, the density is the key physical quantity that determines all ground-state properties. This exercise [@problem_id:2088813] provides a direct, hands-on opportunity to perform this crucial construction, calculating the total electron density $n(x)$ for a simple two-electron system from its given ground-state orbital.", "problem": "In the Kohn-Sham formalism of Density Functional Theory (DFT), a system of interacting electrons is mapped to a fictitious system of non-interacting electrons moving in an effective potential. The properties of the real system, including the electron density, are then calculated from the orbitals of this fictitious system.\n\nConsider a simple one-dimensional model system containing two electrons. These two electrons are spin-paired, meaning they have opposite spins, and they both occupy the lowest-energy (ground state) normalized Kohn-Sham spatial orbital, $\\phi_0(x)$. The mathematical form of this orbital is given by:\n$$\n\\phi_0(x) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/4} \\exp(-\\alpha x^2)\n$$\nwhere $x$ is the position and $\\alpha$ is a positive real constant that characterizes the confinement of the electrons.\n\nDetermine the total electron density, $n(x)$, for this system. Express your answer as a function of $x$ and $\\alpha$.", "solution": "In Kohn-Sham DFT, the total electron density is obtained by summing the densities of the occupied Kohn-Sham orbitals, including spin. For spin-paired electrons occupying the same normalized spatial orbital $\\phi_{0}(x)$, the density is\n$$\nn(x) = 2\\,|\\phi_{0}(x)|^{2}.\n$$\nThe given orbital is\n$$\n\\phi_{0}(x) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/4} \\exp(-\\alpha x^{2}),\n$$\nso its modulus squared is\n$$\n|\\phi_{0}(x)|^{2} = \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/2} \\exp(-2\\alpha x^{2}).\n$$\nTherefore,\n$$\nn(x) = 2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{1/2} \\exp(-2\\alpha x^{2}) = \\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2} \\exp(-2\\alpha x^{2}).\n$$\nAs a consistency check, the integral over all space yields the total number of electrons:\n$$\n\\int_{-\\infty}^{\\infty} n(x)\\,dx = \\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} \\exp(-2\\alpha x^{2})\\,dx = \\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2} \\sqrt{\\frac{\\pi}{2\\alpha}} = 2.\n$$\nThis confirms that the density is correctly normalized for two electrons.", "answer": "$$\\boxed{\\left(\\frac{8\\alpha}{\\pi}\\right)^{1/2}\\exp(-2\\alpha x^{2})}$$", "id": "2088813"}, {"introduction": "While powerful, the practical application of DFT relies on approximate exchange-correlation functionals, which can introduce unphysical artifacts. One of the most well-known is the Self-Interaction Error (SIE), where an electron spuriously interacts with its own density, leading to incorrect predictions for stretched bonds or systems with fractional charges. This practice [@problem_id:1363355] uses a simplified analytical model for the dissociation of the $H_2^+$ molecular ion to explore the consequences of SIE, allowing you to calculate the resulting energy error and understand why many standard functionals fail for such systems.", "problem": "In quantum chemistry, the dissociation of the hydrogen molecular ion, $H_2^+$, provides a fundamental test case for the accuracy of electronic structure methods. In the limit of infinite internuclear separation ($R \\to \\infty$), the system correctly separates into a neutral hydrogen atom (H) and a bare proton ($H^+$).\n\nMany common approximations within Density Functional Theory (DFT), such as those based on the Generalized Gradient Approximation (GGA), suffer from a pervasive issue known as the Self-Interaction Error (SIE). A primary consequence of SIE is the spurious stabilization of delocalized electron densities. For the dissociation of $H_2^+$, this leads to a qualitatively incorrect description at $R \\to \\infty$, where the single electron remains artificially delocalized over both protons. The system is thus erroneously described as a pair of identical fragments, each composed of a proton and, on average, half an electron.\n\nTo model this error, consider a simplified expression for the ground-state energy of a hydrogen-like fragment containing $N$ electrons (where $0 \\le N \\le 1$), as calculated by such an approximate DFT functional:\n$$E_{\\text{DFT}}(N) = E_0 N + U N(1-N)$$\nHere, $E_0$ is the exact ground-state energy of a neutral hydrogen atom ($N=1$), and $U$ is a positive constant that parametrizes the magnitude of the self-interaction energy present in the functional for fractional electron numbers.\n\nThe exact total energy of the dissociated $H_2^+$ system at $R \\to \\infty$ is $E_{\\text{exact}} = E_0$. Determine the error in the total energy at infinite separation, $\\Delta E = E_{\\text{total, DFT}} - E_{\\text{exact}}$, as predicted by this approximate DFT model. Express your answer as a closed-form analytic expression in terms of the parameter $U$.", "solution": "At infinite separation, the two protons are noninteracting fragments, so the approximate DFT total energy is the sum of the fragment energies. Self-interaction error drives delocalization, so the single electron is equally shared, giving $N_{A}=N_{B}=\\frac{1}{2}$ with $N_{A}+N_{B}=1$.\n\nFor a fragment with electron number $N$, the model gives\n$$\nE_{\\text{DFT}}(N)=E_{0}N+U N(1-N).\n$$\nEvaluating at $N=\\frac{1}{2}$,\n$$\nE_{\\text{DFT}}\\!\\left(\\tfrac{1}{2}\\right)=E_{0}\\left(\\tfrac{1}{2}\\right)+U\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\frac{E_{0}}{2}+\\frac{U}{4}.\n$$\nThus the total approximate DFT energy at $R\\to\\infty$ is\n$$\nE_{\\text{total, DFT}}=2\\,E_{\\text{DFT}}\\!\\left(\\tfrac{1}{2}\\right)=2\\left(\\frac{E_{0}}{2}+\\frac{U}{4}\\right)=E_{0}+\\frac{U}{2}.\n$$\nThe exact total energy is $E_{\\text{exact}}=E_{0}$, so the error is\n$$\n\\Delta E=E_{\\text{total, DFT}}-E_{\\text{exact}}=\\left(E_{0}+\\frac{U}{2}\\right)-E_{0}=\\frac{U}{2}.\n$$", "answer": "$$\\boxed{\\frac{U}{2}}$$", "id": "1363355"}]}