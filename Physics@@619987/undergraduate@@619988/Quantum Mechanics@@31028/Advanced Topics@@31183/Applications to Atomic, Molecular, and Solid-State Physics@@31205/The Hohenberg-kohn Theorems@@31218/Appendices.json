{"hands_on_practices": [{"introduction": "The second Hohenberg-Kohn theorem provides a powerful variational principle that is the workhorse of modern Density Functional Theory. It gives us a simple but profound criterion for judging the quality of an approximate calculation: the lower the energy, the better the result, as it provides a tighter upper bound to the true ground-state energy. This exercise [@problem_id:1407248] presents a common scenario in computational chemistry where you must interpret the energies from two different trial densities to determine which provides a better approximation of the system's true energy.", "problem": "In the field of computational chemistry, Density Functional Theory (DFT) is a powerful method for approximating the ground-state electronic energy of a molecule. The theory is founded on the Hohenberg-Kohn theorems. The second of these theorems establishes a variational principle for the energy.\n\nA student is performing two separate DFT calculations, labeled A and B, for the same neutral molecule in its ground state. The molecule has a total of $N$ electrons. Both calculations are based on the (unknown) exact energy functional.\n- Calculation A uses a trial electron density $n_A(\\mathbf{r})$ that yields a total energy of $E_A = -289.44$ Hartrees.\n- Calculation B uses a different trial electron density $n_B(\\mathbf{r})$ that yields a total energy of $E_B = -289.51$ Hartrees.\n\nYou are given that both trial densities are \"v-representable\" (meaning they correspond to the ground-state density of some system of $N$ electrons with some local external potential) and they both correctly integrate to the total number of electrons $N$.\n\nBased *exclusively* on the variational principle as stated by the second Hohenberg-Kohn theorem, what is the most definitive conclusion that can be drawn from these results?\n\nA. The density $n_B(\\mathbf{r})$ is a more accurate representation of the true ground-state electron density than $n_A(\\mathbf{r})$.\n\nB. The true ground-state energy of the molecule must be less than or equal to -289.51 Hartrees.\n\nC. The energy difference, $|E_A - E_B| = 0.07$ Hartrees, represents the fundamental error in the exchange-correlation functional used.\n\nD. Both calculations are flawed, as the Hohenberg-Kohn theorems guarantee that any two valid trial densities must yield the same energy.\n\nE. The true ground-state energy of the molecule is exactly the average of the two results, $\\frac{1}{2}(E_A + E_B)$.", "solution": "By the second Hohenberg-Kohn (HK) theorem (variational principle), for the exact energy functional and any $N$-electron, $v$-representable trial density $n(\\mathbf{r})$,\n$$\nE[n]\\geq E[n_{0}]\\equiv E_{0},\n$$\nwith equality if and only if $n(\\mathbf{r})=n_{0}(\\mathbf{r})$, the true ground-state density.\n\nApplying this to the two given $N$-electron, $v$-representable trial densities $n_{A}(\\mathbf{r})$ and $n_{B}(\\mathbf{r})$,\n$$\nE_{A}=E[n_{A}]\\geq E_{0},\\quad E_{B}=E[n_{B}]\\geq E_{0}.\n$$\nWith the reported values $E_{A}=-289.44$ Hartrees and $E_{B}=-289.51$ Hartrees, both are upper bounds to $E_{0}$. Since $E_{B}<E_{A}$, the tightest upper bound provided is\n$$\nE_{0}\\leq E_{B}=-289.51\\ \\text{Hartrees}.\n$$\n\nNo additional conclusion about the relative accuracy of the densities themselves can be drawn from the variational principle alone; it constrains energies, not distances between densities. The energy difference $|E_{A}-E_{B}|$ does not quantify functional error here (the functional is exact), and different valid trial densities generally yield different energies above $E_{0}$. The exact energy is not guaranteed to equal the average of two trial energies.\n\nTherefore, the most definitive conclusion is that the true ground-state energy must be less than or equal to the lower of the two trial energies, namely $-289.51$ Hartrees.", "answer": "$$\\boxed{B}$$", "id": "1407248"}, {"introduction": "While the variational principle is powerful, it operates under a crucial assumption: the trial electron density, $n(\\mathbf{r})$, must be physically realistic. This means not every mathematical function that integrates to the correct number of electrons is a valid density. This exercise [@problem_id:1407240] delves into this essential prerequisite, known as \"N-representability,\" by asking you to identify the fundamental flaw in a seemingly plausible trial density. Understanding this concept is key to appreciating why the theoretical framework of DFT is constructed so carefully.", "problem": "In an introductory course on Density Functional Theory (DFT), a student investigates a simple one-dimensional system containing a single electron. The electron is confined to the region between $x = -L$ and $x = L$. To test the application of the Hohenberg-Kohn variational principle, the student proposes the following trial electron density function, $n'(x)$:\n\n$$\nn'(x) = \n\\begin{cases} \n\\frac{3}{2L}\\left(1 - \\frac{2x^2}{L^2}\\right) & \\text{for } |x| \\le L \\\\\n0 & \\text{for } |x| > L \n\\end{cases}\n$$\n\nThis trial density is correctly normalized such that $\\int_{-\\infty}^{\\infty} n'(x) dx = 1$. However, this density is fundamentally invalid and cannot correspond to the ground state of any physical potential. Which of the following statements provides the most fundamental reason why $n'(x)$ is an unacceptable trial density?\n\nA. The proposed density is not symmetric under the operation $x \\to -x$, which is a required symmetry for any one-dimensional bound system centered at the origin.\n\nB. The kinetic energy associated with this density cannot be calculated because the function is not smooth at $x = \\pm L$.\n\nC. The proposed density is not derivable from any valid single-particle wavefunction, because the density function itself is not non-negative over its entire domain.\n\nD. Any wavefunction that could produce this density would not be square-integrable, violating a fundamental postulate of quantum mechanics.\n\nE. The proposed density does not satisfy the Heisenberg uncertainty principle, as it is zero outside a finite region of space.", "solution": "For a one-electron system in one dimension, any physically acceptable density must be N-representable. The necessary conditions include:\n- Normalization: $\\int_{-\\infty}^{\\infty} n(x)\\,dx = 1$.\n- Non-negativity: $n(x) \\ge 0$ for all $x$.\n- Existence of a square-integrable wavefunction $\\psi(x)$ such that $n(x) = |\\psi(x)|^{2}$.\n\nConfirming the stated normalization, for the proposed $n'(x)$,\n$$\n\\int_{-\\infty}^{\\infty} n'(x)\\,dx\n= \\int_{-L}^{L} \\frac{3}{2L}\\left(1 - \\frac{2x^{2}}{L^{2}}\\right) dx\n= \\frac{3}{L} \\int_{0}^{L} \\left(1 - \\frac{2x^{2}}{L^{2}}\\right) dx\n= \\frac{3}{L}\\left[ x - \\frac{2}{3}\\frac{x^{3}}{L^{2}} \\right]_{0}^{L}\n= \\frac{3}{L}\\left( L - \\frac{2}{3}L \\right)\n= 1.\n$$\nThus the normalization is correct.\n\nNext, check symmetry:\n$$\nn'(-x) = \\frac{3}{2L}\\left(1 - \\frac{2(-x)^{2}}{L^{2}}\\right) = \\frac{3}{2L}\\left(1 - \\frac{2x^{2}}{L^{2}}\\right) = n'(x),\n$$\nso the density is even; lack of symmetry is not an issue.\n\nThe fundamental N-representability condition is non-negativity. On the interval $|x| \\le L$, the factor\n$$\n1 - \\frac{2x^{2}}{L^{2}}\n$$\nsatisfies\n$$\n1 - \\frac{2x^{2}}{L^{2}} < 0 \\iff \\frac{2x^{2}}{L^{2}} > 1 \\iff |x| > \\frac{L}{\\sqrt{2}}.\n$$\nTherefore, for $\\frac{L}{\\sqrt{2}} < |x| \\le L$, one has $n'(x) < 0$. Since a physical one-electron density must be of the form $n(x) = |\\psi(x)|^{2} \\ge 0$ pointwise, no wavefunction can produce a density that is negative on a set of nonzero measure. Hence $n'(x)$ is not N-representable.\n\nRegarding the other options:\n- Smoothness at $x = \\pm L$ (option B) is not the most fundamental obstruction; even if a density is not smooth, non-negativity is the primary requirement, and smoothness issues can be secondary.\n- Square-integrability of a corresponding wavefunction (option D) would follow from non-negativity and normalization via $\\psi(x) = \\sqrt{n(x)}\\exp(i\\theta(x))$, so the failure here is not square-integrability but the impossibility of defining $\\sqrt{n'(x)}$ where $n'(x) < 0$.\n- The Heisenberg uncertainty principle (option E) does not forbid compact support; a wavefunction with compact support does not violate $\\sigma_{x}\\sigma_{p} \\ge \\hbar/2$. This is not the issue here.\n\nTherefore, the most fundamental reason the trial density is unacceptable is that it becomes negative and thus cannot be the modulus square of any wavefunction.\n\nThe correct choice is C.", "answer": "$$\\boxed{C}$$", "id": "1407240"}, {"introduction": "We now turn to the first Hohenberg-Kohn theorem, which establishes a remarkable one-to-one mapping between the ground-state electron density and the external potential. This implies that the density itself implicitly contains all information about the system. This advanced practice [@problem_id:2464823] moves from concept to application, challenging you to perform the \"inverse problem\": starting from an analytically known ground-state density for a model system, you will computationally derive the unique external potential that corresponds to it. This exercise makes the abstract power of the first theorem tangible and demonstrates its foundational role in DFT.", "problem": "Consider the density-to-potential mapping guaranteed by the Hohenberg–Kohn theorems in Density Functional Theory (DFT). For a non-degenerate ground state, the ground-state density uniquely determines the external potential up to an additive constant. In atomic units, assume nonrelativistic kinematics with electron mass and reduced Planck constant equal to $1$. To make the task precise and testable, you will work with analytically specified ground-state densities for model systems that are chosen to be solvable from first principles without requiring any empirical data or external files.\n\nYour task is to write a program that, for each of the following test cases, computes the external potential values at specified points, up to an additive constant chosen as stated. All energies must be reported in hartree and all distances in bohr. The final output must be a single line containing a comma-separated list of floating-point numbers enclosed in square brackets, ordered exactly as specified below.\n\nTest cases:\n\nCase A (one-dimensional, spin-singlet, two noninteracting electrons). The system has a one-dimensional, even, nodeless ground-state density\n$$\nn_{A,\\alpha}(x) = 2 \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} e^{-\\alpha x^2},\n$$\nwith occupancy factor $2$. For each value of $\\alpha$ below, compute the external potential $v_{A,\\alpha}(x)$ that yields this density as the noninteracting ground state, and fix the additive constant by imposing $v_{A,\\alpha}(0)=0$.\n- A1: use $\\alpha = 1/2$ and report $v_{A,1/2}(x)$ at $x=0$ and $x=1$.\n- A2: use $\\alpha = 3/2$ and report $v_{A,3/2}(x)$ at $x=0$ and $x=0.4$.\n\nCase B (three-dimensional, spherically symmetric, one electron). The system has a spherically symmetric ground-state density\n$$\n\\rho_{B,Z}(r) = \\frac{Z^3}{\\pi} e^{-2 Z r},\n$$\nwith occupancy factor $1$. Compute the spherically symmetric external potential $v_{B,Z}(r)$ that yields this density as the ground state, and fix the additive constant by imposing $\\lim_{r\\to\\infty} v_{B,Z}(r)=0$. Use $Z=2$ and report $v_{B,2}(r)$ at $r=0.5$ and $r=2.0$.\n\nRequirements and conventions:\n\n- All quantities are in atomic units: lengths in bohr and energies in hartree.\n- Angles do not appear, so no angular unit is required.\n- Your program must not read any input. It must compute, for the test suite above, a single line of output that aggregates the requested potential values in the following order:\n  $[v_{A,1/2}(0), v_{A,1/2}(1), v_{A,3/2}(0), v_{A,3/2}(0.4), v_{B,2}(0.5), v_{B,2}(2.0)]$.\n- The final answers must be floating-point numbers.\n\nThe problem setup is universally applicable and requires only first-principles reasoning from the definitions of the ground state for noninteracting systems and the uniqueness of the density-to-potential mapping ensured by the Hohenberg–Kohn theorems. This exercise is motivated by the question of reconstructing the external potential $v_0(\\mathbf{r})$ from the exact ground-state density $\\rho_0(\\mathbf{r})$ for a real atom such as lithium; here you will perform the fully specified inversion on analytically defined model densities where the mapping is well-posed and unambiguous.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[a,b,c,d,e,f]$) in the exact order specified above.", "solution": "The problem is valid. It is scientifically grounded in the principles of quantum mechanics and Density Functional Theory, well-posed, and contains all necessary information for a unique solution. I will proceed with the derivation.\n\nThe fundamental task is to determine the external potential, $v(\\mathbf{r})$, which for a system of noninteracting electrons yields a given ground-state electron density, $\\rho(\\mathbf{r})$. This is a direct application of the invertibility of the density-to-potential map, guaranteed by the first Hohenberg-Kohn theorem for a non-degenerate ground state. We operate in atomic units, where the electron mass $m_e$ and the reduced Planck constant $\\hbar$ are both equal to $1$.\n\nFor a system of noninteracting electrons, the stationary Schrödinger equation for a single-particle orbital $\\psi_i(\\mathbf{r})$ with energy $\\epsilon_i$ is:\n$$\n\\hat{H} \\psi_i(\\mathbf{r}) = \\left[ -\\frac{1}{2}\\nabla^2 + v(\\mathbf{r}) \\right] \\psi_i(\\mathbf{r}) = \\epsilon_i \\psi_i(\\mathbf{r})\n$$\nBy rearranging this equation, we can express the external potential $v(\\mathbf{r})$ in terms of the ground-state eigenfunction $\\psi_0(\\mathbf{r})$ and its corresponding eigenvalue $\\epsilon_0$:\n$$\nv(\\mathbf{r}) = \\epsilon_0 + \\frac{1}{2} \\frac{\\nabla^2 \\psi_0(\\mathbf{r})}{\\psi_0(\\mathbf{r})}\n$$\nThe ground-state density, $\\rho(\\mathbf{r})$, is constructed from the occupied orbitals. For the cases presented, only the lowest energy spatial orbital, $\\psi_0(\\mathbf{r})$, is occupied. If this orbital is occupied by $N_{occ}$ electrons, the density is given by $\\rho(\\mathbf{r}) = N_{occ} |\\psi_0(\\mathbf{r})|^2$. From the given density $\\rho(\\mathbf{r})$, we can therefore determine the ground-state orbital $\\psi_0(\\mathbf{r})$ up to an irrelevant constant phase factor, which we can choose to be zero, making $\\psi_0(\\mathbf{r})$ a real and positive function.\n\nCase A: One-dimensional, two noninteracting electrons\nThe system consists of $N=2$ noninteracting electrons in a spin-singlet state, meaning both electrons occupy the lowest spatial orbital $\\psi_{0,\\alpha}(x)$. The occupancy factor is $N_{occ}=2$. The ground-state density is given as:\n$$\nn_{A,\\alpha}(x) = 2 \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} e^{-\\alpha x^2}\n$$\nFrom the relation $n_{A,\\alpha}(x) = 2 |\\psi_{0,\\alpha}(x)|^2$, we find the ground-state orbital:\n$$\n|\\psi_{0,\\alpha}(x)|^2 = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} e^{-\\alpha x^2}\n$$\nChoosing the wavefunction to be real and positive, we get:\n$$\n\\psi_{0,\\alpha}(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/4} e^{-\\alpha x^2 / 2}\n$$\nTo find the potential, we compute the second derivative of $\\psi_{0,\\alpha}(x)$. Let $C = (\\alpha/\\pi)^{1/4}$.\n$$\n\\frac{d\\psi_{0,\\alpha}}{dx} = C e^{-\\alpha x^2 / 2} (-\\alpha x) = -\\alpha x \\, \\psi_{0,\\alpha}(x)\n$$\n$$\n\\frac{d^2\\psi_{0,\\alpha}}{dx^2} = -\\alpha \\, \\psi_{0,\\alpha}(x) - \\alpha x \\frac{d\\psi_{0,\\alpha}}{dx} = -\\alpha \\, \\psi_{0,\\alpha}(x) - \\alpha x (-\\alpha x \\, \\psi_{0,\\alpha}(x)) = (\\alpha^2 x^2 - \\alpha) \\psi_{0,\\alpha}(x)\n$$\nThe kinetic energy term divided by the wavefunction is:\n$$\n\\frac{\\frac{d^2\\psi_{0,\\alpha}}{dx^2}}{\\psi_{0,\\alpha}(x)} = \\alpha^2 x^2 - \\alpha\n$$\nSubstituting this into the one-dimensional version of the potential-inversion formula:\n$$\nv_{A,\\alpha}(x) = \\epsilon_{0,\\alpha} + \\frac{1}{2} (\\alpha^2 x^2 - \\alpha) = \\frac{1}{2}\\alpha^2 x^2 + (\\epsilon_{0,\\alpha} - \\frac{\\alpha}{2})\n$$\nThe term $(\\epsilon_{0,\\alpha} - \\alpha/2)$ is an additive constant, which we determine using the condition $v_{A,\\alpha}(0)=0$.\n$$\nv_{A,\\alpha}(0) = \\frac{1}{2}\\alpha^2 (0)^2 + (\\epsilon_{0,\\alpha} - \\frac{\\alpha}{2}) = 0 \\implies \\epsilon_{0,\\alpha} - \\frac{\\alpha}{2} = 0\n$$\nThus, the external potential is uniquely determined as:\n$$\nv_{A,\\alpha}(x) = \\frac{1}{2}\\alpha^2 x^2\n$$\nFor case A1, $\\alpha = 1/2$. The potential is $v_{A,1/2}(x) = \\frac{1}{2}(1/2)^2 x^2 = \\frac{1}{8} x^2$.\n- At $x=0$: $v_{A,1/2}(0) = \\frac{1}{8}(0)^2 = 0$.\n- At $x=1$: $v_{A,1/2}(1) = \\frac{1}{8}(1)^2 = 0.125$.\n\nFor case A2, $\\alpha = 3/2$. The potential is $v_{A,3/2}(x) = \\frac{1}{2}(3/2)^2 x^2 = \\frac{9}{8} x^2$.\n- At $x=0$: $v_{A,3/2}(0) = \\frac{9}{8}(0)^2 = 0$.\n- At $x=0.4$: $v_{A,3/2}(0.4) = \\frac{9}{8}(0.4)^2 = \\frac{9}{8}(0.16) = 0.18$.\n\nCase B: Three-dimensional, one electron\nThe system consists of a single electron, $N=1$, so $N_{occ}=1$. The spherically symmetric ground-state density is:\n$$\n\\rho_{B,Z}(r) = \\frac{Z^3}{\\pi} e^{-2 Z r}\n$$\nFrom $\\rho_{B,Z}(r) = |\\psi_{0,Z}(r)|^2$, we find the ground-state orbital:\n$$\n\\psi_{0,Z}(r) = \\left(\\frac{Z^3}{\\pi}\\right)^{1/2} e^{-Z r}\n$$\nFor a spherically symmetric function $f(r)$, the Laplacian is $\\nabla^2 f(r) = \\frac{d^2f}{dr^2} + \\frac{2}{r}\\frac{df}{dr}$. Let's compute the derivatives of $\\psi_{0,Z}(r)$:\n$$\n\\frac{d\\psi_{0,Z}}{dr} = -Z \\, \\psi_{0,Z}(r)\n$$\n$$\n\\frac{d^2\\psi_{0,Z}}{dr^2} = Z^2 \\, \\psi_{0,Z}(r)\n$$\nThe Laplacian of the orbital is:\n$$\n\\nabla^2 \\psi_{0,Z}(r) = Z^2 \\psi_{0,Z}(r) + \\frac{2}{r}(-Z \\psi_{0,Z}(r)) = \\left(Z^2 - \\frac{2Z}{r}\\right)\\psi_{0,Z}(r)\n$$\nThe kinetic energy term divided by the wavefunction is:\n$$\n\\frac{\\nabla^2 \\psi_{0,Z}(r)}{\\psi_{0,Z}(r)} = Z^2 - \\frac{2Z}{r}\n$$\nSubstituting this into the potential-inversion formula:\n$$\nv_{B,Z}(r) = \\epsilon_{0,Z} + \\frac{1}{2} \\left(Z^2 - \\frac{2Z}{r}\\right) = -\\frac{Z}{r} + \\left(\\epsilon_{0,Z} + \\frac{Z^2}{2}\\right)\n$$\nThe term $(\\epsilon_{0,Z} + Z^2/2)$ is the additive constant. We fix it with the condition $\\lim_{r\\to\\infty} v_{B,Z}(r)=0$.\n$$\n\\lim_{r\\to\\infty} \\left(-\\frac{Z}{r} + \\epsilon_{0,Z} + \\frac{Z^2}{2}\\right) = 0 + \\epsilon_{0,Z} + \\frac{Z^2}{2} = 0\n$$\nThus, the constant is zero, and the external potential is:\n$$\nv_{B,Z}(r) = -\\frac{Z}{r}\n$$\nFor case B, we are given $Z=2$. The potential is $v_{B,2}(r) = -2/r$.\n- At $r=0.5$: $v_{B,2}(0.5) = -2/0.5 = -4.0$.\n- At $r=2.0$: $v_{B,2}(2.0) = -2/2.0 = -1.0$.\n\nSummary of calculated values:\n- $v_{A,1/2}(0) = 0.0$\n- $v_{A,1/2}(1) = 0.125$\n- $v_{A,3/2}(0) = 0.0$\n- $v_{A,3/2}(0.4) = 0.18$\n- $v_{B,2}(0.5) = -4.0$\n- $v_{B,2}(2.0) = -1.0$\nThe ordered list of results is $[0.0, 0.125, 0.0, 0.18, -4.0, -1.0]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the external potential values for specified ground-state densities\n    based on the inversion of the noninteracting Schrödinger equation.\n    \"\"\"\n\n    # This list will store the results in the required order.\n    results = []\n\n    # Case A: 1D, two noninteracting electrons\n    # The derived potential is v_A(x) = 0.5 * alpha^2 * x^2, with the constant fixed by v_A(0) = 0.\n\n    # A1: alpha = 1/2\n    alpha_1 = 0.5\n    x_vals_1 = [0.0, 1.0]\n    # v_A,1/2 (x) = 0.5 * (0.5)^2 * x^2 = 0.125 * x^2\n    v_A1_0 = 0.125 * x_vals_1[0]**2\n    v_A1_1 = 0.125 * x_vals_1[1]**2\n    results.extend([v_A1_0, v_A1_1])\n\n    # A2: alpha = 3/2\n    alpha_2 = 1.5\n    x_vals_2 = [0.0, 0.4]\n    # v_A,3/2 (x) = 0.5 * (1.5)^2 * x^2 = 1.125 * x^2\n    v_A2_0 = 1.125 * x_vals_2[0]**2\n    v_A2_04 = 1.125 * x_vals_2[1]**2\n    results.extend([v_A2_0, v_A2_04])\n\n    # Case B: 3D, one electron\n    # The derived potential is v_B(r) = -Z/r, with the constant fixed by lim_{r->inf} v_B(r) = 0.\n\n    # B: Z = 2\n    Z = 2.0\n    r_vals = [0.5, 2.0]\n    # v_B,2 (r) = -2.0 / r\n    v_B_05 = -Z / r_vals[0]\n    v_B_20 = -Z / r_vals[1]\n    results.extend([v_B_05, v_B_20])\n    \n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of floating-point numbers enclosed in square brackets.\n    # e.g., [0.0,0.125,0.0,0.18,-4.0,-1.0]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2464823"}]}