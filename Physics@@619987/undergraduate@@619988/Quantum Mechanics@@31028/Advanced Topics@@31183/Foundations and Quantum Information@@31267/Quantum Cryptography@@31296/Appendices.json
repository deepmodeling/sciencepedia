{"hands_on_practices": [{"introduction": "The security of the BB84 protocol hinges on a fundamental principle of quantum mechanics: observation disturbs the system. An eavesdropper, conventionally named Eve, cannot measure a quantum state without risking its alteration. This first exercise [@problem_id:2111556] invites you to quantify this disturbance by calculating the Quantum Bit Error Rate (QBER) that a basic \"intercept-resend\" attack introduces, providing a tangible measure of how Eve's snooping reveals her presence.", "problem": "Alice and Bob wish to establish a secure communication channel using the principles of quantum mechanics. They employ a simplified version of the Bennett-Brassard 1984 (BB84) quantum key distribution protocol. The protocol uses two mutually unbiased bases for encoding information on single qubits: the computational basis (Z-basis), with orthonormal states $|0\\rangle$ and $|1\\rangle$, and the diagonal basis (X-basis), with orthonormal states $|+\\rangle$ and $|-\\rangle$. These bases are related by the expressions $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ and $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$.\n\nThe protocol proceeds as follows: For each qubit in a long sequence, Alice randomly chooses a bit to send (0 or 1) and a basis to encode it in (Z or X). For example, to send a '1' in the X-basis, she would prepare a qubit in the state $|-\\rangle$. Bob, unaware of Alice's choices, randomly chooses a basis (Z or X) to measure each incoming qubit.\n\nAn eavesdropper, Eve, executes an \"intercept-resend\" attack on every qubit transmitted. For each qubit she intercepts from Alice, Eve randomly chooses to measure it in either the Z-basis or the X-basis, with each basis being chosen with a probability of $1/2$. She then sends a new qubit to Bob, prepared in the state corresponding to her measurement outcome.\n\nAfter the entire sequence is transmitted, Alice and Bob publicly announce the basis they used for each qubit. They discard all instances where their bases did not match. They then compare a sample of their results from the remaining instances (where their bases matched) to check for eavesdropping. What is the expected probability of a disagreement (an error) for any given qubit in this matched-basis subset?\n\nExpress your answer as an exact fraction.", "solution": "The problem asks for the expected probability of a disagreement between Alice's sent bit and Bob's measured bit for the cases where they both chose the same basis, given Eve's intercept-resend attack. This probability is often called the Quantum Bit Error Rate (QBER).\n\nWe need to consider the subset of communications where Alice's basis choice, $B_A$, is the same as Bob's basis choice, $B_B$. There are two scenarios for this matched-basis condition:\n1.  Alice and Bob both use the Z-basis ($B_A = B_B = Z$).\n2.  Alice and Bob both use the X-basis ($B_A = B_B = X$).\n\nSince Alice and Bob's basis choices are random and independent, these two scenarios are equally likely to occur within the matched-basis subset. We can calculate the error probability for each case. Let's denote Eve's randomly chosen basis as $B_E$.\n\n**Case 1: Alice and Bob both use the Z-basis ($B_A = B_B = Z$).**\n\nAlice sends either $|0\\rangle$ or $|1\\rangle$. Without loss of generality, let's assume Alice sends the bit '0' by preparing a qubit in the state $|0\\rangle$. An error occurs if Bob measures '1'.\n\nEve intercepts the $|0\\rangle$ state.\n- **Subcase 1a:** Eve chooses the Z-basis ($B_E=Z$) with probability $1/2$.\n  She measures the state $|0\\rangle$ in the $\\{|0\\rangle, |1\\rangle\\}$ basis. Her outcome will be '0' with probability $|\\langle 0 | 0 \\rangle|^2 = 1$. She then sends a new qubit in the state $|0\\rangle$ to Bob. Bob measures this state in the Z-basis and correctly obtains '0' with probability 1. The error probability in this subcase is 0.\n\n- **Subcase 1b:** Eve chooses the X-basis ($B_E=X$) with probability $1/2$.\n  She measures the state $|0\\rangle$ in the $\\{|+\\rangle, |-\\rangle\\}$ basis.\n  The probability of measuring '+' is $P_E(+) = |\\langle + | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}(\\langle 0| + \\langle 1|)|0\\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$. She then sends $|+\\rangle$ to Bob.\n  The probability of measuring '-' is $P_E(-) = |\\langle - | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}(\\langle 0| - \\langle 1|)|0\\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$. She then sends $|-\\rangle$ to Bob.\n  Bob receives the qubit from Eve and measures in the Z-basis. An error occurs if he measures '1'.\n  - If Bob receives $|+\\rangle$, the probability of measuring '1' is $P_B(1|+) = |\\langle 1 | + \\rangle|^2 = |\\langle 1 | \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$.\n  - If Bob receives $|-\\rangle$, the probability of measuring '1' is $P_B(1|-) = |\\langle 1 | - \\rangle|^2 = |\\langle 1 | \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle) \\rangle|^2 = |-\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$.\n  The total probability of an error in this subcase is the probability that Eve sends a state that causes Bob to measure an error, which is $\\frac{1}{2}$.\n\nThe total error probability for Case 1 is the weighted sum of the error probabilities from the subcases:\n$P(\\text{error}|B_A=B_B=Z) = P(B_E=Z) \\times P(\\text{error}|B_E=Z) + P(B_E=X) \\times P(\\text{error}|B_E=X)$\n$P(\\text{error}|B_A=B_B=Z) = \\left(\\frac{1}{2}\\right) \\times 0 + \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$.\n\n**Case 2: Alice and Bob both use the X-basis ($B_A = B_B = X$).**\n\nAlice sends either $|+\\rangle$ or $|-\\rangle$. Without loss of generality, let's assume Alice sends the bit '0' in this basis, which corresponds to the state $|+\\rangle$. An error occurs if Bob measures '-'.\n\nEve intercepts the $|+\\rangle$ state.\n- **Subcase 2a:** Eve chooses the X-basis ($B_E=X$) with probability $1/2$.\n  She measures the state $|+\\rangle$ in the $\\{|+\\rangle, |-\\rangle\\}$ basis. She will obtain '+' with probability $|\\langle + | + \\rangle|^2 = 1$. She sends $|+\\rangle$ to Bob. Bob measures in the X-basis and correctly gets '+' with probability 1. The error probability is 0.\n\n- **Subcase 2b:** Eve chooses the Z-basis ($B_E=Z$) with probability $1/2$.\n  She measures the state $|+\\rangle$ in the $\\{|0\\rangle, |1\\rangle\\}$ basis.\n  The probability of measuring '0' is $P_E(0) = |\\langle 0 | + \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$. She then sends $|0\\rangle$ to Bob.\n  The probability of measuring '1' is $P_E(1) = |\\langle 1 | + \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$. She then sends $|1\\rangle$ to Bob.\n  Bob receives the qubit from Eve and measures in the X-basis. An error occurs if he measures '-'.\n  - If Bob receives $|0\\rangle$, the probability of measuring '-' is $P_B(-|0) = |\\langle - | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$.\n  - If Bob receives $|1\\rangle$, the probability of measuring '-' is $P_B(-|1) = |\\langle - | 1 \\rangle|^2 = |-\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$.\n  The total probability of an error in this subcase is $\\frac{1}{2}$.\n\nThe total error probability for Case 2 is:\n$P(\\text{error}|B_A=B_B=X) = P(B_E=X) \\times P(\\text{error}|B_E=X) + P(B_E=Z) \\times P(\\text{error}|B_E=Z)$\n$P(\\text{error}|B_A=B_B=X) = \\left(\\frac{1}{2}\\right) \\times 0 + \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$.\n\n**Conclusion:**\nIn both possible scenarios where Alice and Bob's bases match (both Z or both X), the probability of an error due to Eve's eavesdropping is exactly $\\frac{1}{4}$. Therefore, the overall expected probability of a disagreement in the matched-basis subset is $\\frac{1}{4}$.", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2111556"}, {"introduction": "In a real-world implementation, errors in quantum communication arise not only from malicious attacks but also from unavoidable interactions with the environment, a process known as decoherence. This practice [@problem_id:2111559] shifts our focus from an active eavesdropper to a passive, noisy channel that causes \"pure dephasing.\" By calculating the QBER caused by this environmental noise, you will grapple with a critical challenge in quantum cryptography: distinguishing a determined adversary from the inherent imperfections of the physical world.", "problem": "In a quantum communication system, Alice wishes to send a secret key to Bob using the BB84 protocol. Alice prepares qubits in one of two bases: the rectilinear (Z) basis, with states $|0\\rangle$ and $|1\\rangle$, or the diagonal (X) basis, with states $|+\\rangle$ and $|-\\rangle$. She randomly chooses one of the four states $|0\\rangle, |1\\rangle, |+\\rangle, |-\\rangle$ with equal probability for each transmission.\n\nThe states are defined as:\n$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$, $|1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$, $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$\n\nThe qubits are transmitted from Alice to Bob through a noisy quantum channel that introduces pure dephasing. The effect of this channel on a qubit's density matrix $\\rho$ is described by the Kraus operator-sum representation $\\mathcal{E}(\\rho) = E_0 \\rho E_0^\\dagger + E_1 \\rho E_1^\\dagger$, with the Kraus operators given by:\n$E_0 = \\sqrt{1-p} \\cdot I$\n$E_1 = \\sqrt{p} \\cdot Z$\n\nHere, $p$ is the probability that a dephasing error occurs, $I$ is the $2 \\times 2$ identity matrix, and $Z$ is the Pauli-Z matrix, $Z = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$.\n\nUpon receiving each qubit, Bob randomly chooses to measure it in either the Z-basis or the X-basis. After the transmission is complete, Alice and Bob publicly announce the sequence of bases they used for each qubit and discard all instances where their bases did not match.\n\nThe performance of the protocol is quantified by the Quantum Bit Error Rate (QBER), which is the fraction of qubits that have different bit values for Alice and Bob in the sifted key (i.e., the subset of bits where they used the same measurement basis).\n\nCalculate the QBER for this protocol as a function of the dephasing probability $p$.", "solution": "Alice sends each of the four BB84 states with equal probability. The noisy channel is a phase-flip (pure dephasing) described by the Kraus operators $E_{0}=\\sqrt{1-p}\\,I$ and $E_{1}=\\sqrt{p}\\,Z$, so for any qubit density matrix $\\rho$,\n$$\n\\mathcal{E}(\\rho)=E_{0}\\rho E_{0}^{\\dagger}+E_{1}\\rho E_{1}^{\\dagger}=(1-p)\\rho+p\\,Z\\rho Z.\n$$\nBob measures in either the $Z$-basis or the $X$-basis, and the sifted key retains only the events where Alice’s and Bob’s bases match.\n\nFirst consider the $Z$-basis inputs. For $|0\\rangle$ and $|1\\rangle$, the density matrices are $\\rho_{0}=|0\\rangle\\langle 0|$ and $\\rho_{1}=|1\\rangle\\langle 1|$. Using $Z|0\\rangle=|0\\rangle$ and $Z|1\\rangle=-|1\\rangle$, we have\n$$\nZ\\rho_{0}Z=\\rho_{0},\\qquad Z\\rho_{1}Z=\\rho_{1}.\n$$\nTherefore,\n$$\n\\mathcal{E}(\\rho_{0})=(1-p)\\rho_{0}+p\\rho_{0}=\\rho_{0},\\qquad \\mathcal{E}(\\rho_{1})=\\rho_{1}.\n$$\nA projective measurement in the $Z$-basis yields the same bit Alice sent with certainty, so the error probability conditioned on matching $Z$ bases is $0$.\n\nNext consider the $X$-basis inputs. The density matrices are\n$$\n\\rho_{+}=|+\\rangle\\langle +|=\\tfrac{1}{2}\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix},\\qquad\n\\rho_{-}=|-\\rangle\\langle -|=\\tfrac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}.\n$$\nUsing $Z|+\\rangle=|-\\rangle$ and $Z|-\\rangle=|+\\rangle$, we obtain\n$$\nZ\\rho_{+}Z=\\rho_{-},\\qquad Z\\rho_{-}Z=\\rho_{+},\n$$\nhence\n$$\n\\mathcal{E}(\\rho_{+})=(1-p)\\rho_{+}+p\\rho_{-},\\qquad \\mathcal{E}(\\rho_{-})=(1-p)\\rho_{-}+p\\rho_{+}.\n$$\nFor an $X$-basis measurement with projectors $P_{+}=\\rho_{+}$ and $P_{-}=\\rho_{-}$, the probability of obtaining the correct outcome from $\\mathcal{E}(\\rho_{+})$ is\n$$\n\\operatorname{Pr}(+|\\rho_{+})=\\operatorname{tr}(P_{+}\\mathcal{E}(\\rho_{+}))=(1-p)\\operatorname{tr}(P_{+}\\rho_{+})+p\\,\\operatorname{tr}(P_{+}\\rho_{-})=(1-p)\\cdot 1+p\\cdot 0=1-p,\n$$\nso the error probability is $p$. The same holds starting from $\\rho_{-}$. Therefore, conditioned on matching $X$ bases, the error probability is $p$.\n\nThe sifted key consists of all events where the bases match. Alice chooses $Z$ or $X$ with probability $\\tfrac{1}{2}$ each, and Bob chooses independently with probability $\\tfrac{1}{2}$ for each basis. Conditioned on a match, the probability that the matched basis is $Z$ equals the probability it is $X$, namely $\\tfrac{1}{2}$. Therefore the Quantum Bit Error Rate (QBER), defined as the fraction of erroneous bits in the sifted key, is the weighted average\n$$\n\\mathrm{QBER}=\\tfrac{1}{2}\\cdot 0+\\tfrac{1}{2}\\cdot p=\\tfrac{p}{2}.\n$$", "answer": "$$\\boxed{\\frac{p}{2}}$$", "id": "2111559"}, {"introduction": "Detecting an eavesdropper by observing an elevated error rate is the first step, but a complete security analysis requires us to answer a more profound question: exactly how much information can Eve steal? This final practice [@problem_id:2111588] introduces a powerful tool from information theory, the Shannon mutual information, to precisely quantify the knowledge Eve gains. By calculating the mutual information $I(A:E)$ between Alice's key and Eve's records, you move beyond simple error detection to the core of quantum security proofs, establishing a hard limit on the information leaked to any potential eavesdropper.", "problem": "In the context of quantum key distribution (QKD), the BB84 protocol (named after its inventors Charles Bennett and Gilles Brassard) allows two parties, Alice and Bob, to establish a secret key. The security of this key relies on the principles of quantum mechanics.\n\nConsider a simplified BB84 protocol where Alice sends a sequence of single photons to Bob. For each photon, she randomly and independently chooses a bit value (0 or 1) and a polarization basis to encode it.\nThe two bases are:\n1.  The rectilinear basis (+), where bit `0` is encoded as a horizontally polarized photon (state $|H\\rangle$) and bit `1` is encoded as a vertically polarized photon (state $|V\\rangle$).\n2.  The diagonal basis (×), where bit `0` is encoded as a diagonally polarized photon at +45° (state $|D\\rangle = (|H\\rangle + |V\\rangle)/\\sqrt{2}$) and bit `1` is encoded as an anti-diagonally polarized photon at -45° (state $|A\\rangle = (|H\\rangle - |V\\rangle)/\\sqrt{2}$).\n\nAssume Alice's choices of bit value and basis are uniformly random, i.e., $P(\\text{bit}=0)=P(\\text{bit}=1)=1/2$ and $P(\\text{basis}=+)=P(\\text{basis}=\\times)=1/2$.\n\nAn eavesdropper, Eve, attempts to learn the key by mounting an \"intercept-resend\" attack. For every photon Alice sends, Eve intercepts it, measures its polarization, and then sends a new photon to Bob prepared in the state she measured. Eve does not know Alice's basis choice for each photon, so she also chooses her measurement basis (rectilinear or diagonal) uniformly at random for each interception.\n\nLet $A$ be the random variable representing Alice's original bit value, and $E$ be the random variable representing the bit value Eve obtains from her measurement. The Shannon mutual information between two random variables $X$ and $Y$ is a measure of their mutual dependence, given by the formula:\n$$I(X:Y) = \\sum_{x,y} p(x,y) \\log_2 \\left( \\frac{p(x,y)}{p(x)p(y)} \\right)$$\nwhere $p(x,y)$ is the joint probability distribution of $X$ and $Y$, and $p(x)$ and $p(y)$ are the marginal probability distributions.\n\nCalculate the mutual information $I(A:E)$ between Alice's bit value and Eve's measured bit value. Express your answer in units of bits, rounded to four significant figures.", "solution": "Alice chooses basis and bit uniformly at random. Eve, per interception, also chooses her measurement basis uniformly at random and maps her measurement outcome in that basis to a bit. Let $A\\in\\{0,1\\}$ be Alice’s bit and $E\\in\\{0,1\\}$ be Eve’s measured bit.\n\nBy construction, the probability that Eve uses the same basis as Alice is\n$$\nP(\\text{same basis})=\\frac{1}{2},\\quad P(\\text{different basis})=\\frac{1}{2}.\n$$\nPhysical principle (Born rule): measurement outcome probabilities are given by squared inner products of the state with measurement eigenstates. The rectilinear and diagonal bases are mutually unbiased: for example, $|D\\rangle=(|H\\rangle+|V\\rangle)/\\sqrt{2}$ and $|A\\rangle=(|H\\rangle-|V\\rangle)/\\sqrt{2}$ imply\n$$\n|\\langle D|H\\rangle|^{2}=|\\langle A|H\\rangle|^{2}=\\frac{1}{2},\\quad\n|\\langle D|V\\rangle|^{2}=|\\langle A|V\\rangle|^{2}=\\frac{1}{2}.\n$$\nThus:\n- If Eve measures in the same basis as Alice, the outcome deterministically matches Alice’s encoded bit:\n$$\nP(E=A\\mid \\text{same basis})=1,\\quad P(E\\neq A\\mid \\text{same basis})=0.\n$$\n- If Eve measures in the different basis, outcomes are equiprobable and independent of $A$:\n$$\nP(E=A\\mid \\text{different basis})=\\frac{1}{2},\\quad P(E\\neq A\\mid \\text{different basis})=\\frac{1}{2}.\n$$\nAveraging over Eve’s basis choice gives the binary symmetric channel from $A$ to $E$ with crossover probability\n$$\nq=P(E\\neq A)=\\frac{1}{2}\\cdot 0+\\frac{1}{2}\\cdot \\frac{1}{2}=\\frac{1}{4},\n$$\nso\n$$\nP(E=A)=1-q=\\frac{3}{4}.\n$$\nBecause of symmetry and $P(A=0)=P(A=1)=\\frac{1}{2}$, the marginal of $E$ is also uniform:\n$$\nP(E=0)=\\frac{1}{2}\\cdot \\frac{3}{4}+\\frac{1}{2}\\cdot \\frac{1}{4}=\\frac{1}{2},\\quad P(E=1)=\\frac{1}{2}.\n$$\n\nThe Shannon mutual information can be computed via\n$$\nI(A:E)=H(E)-H(E\\mid A),\n$$\nwith entropy in bits using $\\log_{2}$. Since $E$ is uniform, $H(E)=1$. The conditional entropy for a binary symmetric channel with crossover $q=\\frac{1}{4}$ is the binary entropy\n$$\nH(E\\mid A)=H_{2}\\!\\left(\\frac{1}{4}\\right)=-\\frac{1}{4}\\log_{2}\\!\\left(\\frac{1}{4}\\right)-\\frac{3}{4}\\log_{2}\\!\\left(\\frac{3}{4}\\right).\n$$\nTherefore\n$$\nI(A:E)=1-H_{2}\\!\\left(\\frac{1}{4}\\right)\n=1-\\left[-\\frac{1}{4}\\log_{2}\\!\\left(\\frac{1}{4}\\right)-\\frac{3}{4}\\log_{2}\\!\\left(\\frac{3}{4}\\right)\\right].\n$$\nUsing $\\log_{2}\\!\\left(\\frac{1}{4}\\right)=-2$ and $-\\log_{2}\\!\\left(\\frac{3}{4}\\right)=\\log_{2}\\!\\left(\\frac{4}{3}\\right)$,\n$$\nH_{2}\\!\\left(\\frac{1}{4}\\right)=\\frac{1}{2}+\\frac{3}{4}\\log_{2}\\!\\left(\\frac{4}{3}\\right)\\approx 0.811278\\dots,\n$$\nso\n$$\nI(A:E)=1-0.811278\\dots\\approx 0.1887219\\dots \\text{ bits}.\n$$\nRounded to four significant figures, this is $0.1887$ bits.", "answer": "$$\\boxed{0.1887}$$", "id": "2111588"}]}