{"hands_on_practices": [{"introduction": "In quantum mechanics, particles in stationary states exhibit static properties, meaning the expectation values of observables like position and momentum do not change over time. This practice explores what happens in a non-stationary stateâ€”a superposition of different energy eigenstates. By calculating the time evolution of the average position, $\\langle x \\rangle(t)$, for a particle in an infinite potential well, you will witness the dynamic \"sloshing\" motion of the probability density, a quintessential quantum interference effect. This exercise provides a concrete illustration of why a framework like the Ehrenfest theorem is essential for describing the dynamics of quantum expectation values [@problem_id:2089747].", "problem": "A particle of mass $m$ is confined to a one-dimensional infinite potential well of length $L$. The potential energy function is given by $V(x) = 0$ for $0 < x < L$ and $V(x) = \\infty$ otherwise. The normalized, real-valued stationary state wavefunctions for this system are given by $\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right)$ for $n=1, 2, 3, \\ldots$.\n\nAt time $t=0$, the particle is prepared in a non-stationary state described by the normalized wavefunction:\n$$\n\\Psi(x,0) = \\frac{1}{\\sqrt{2}} \\left( \\psi_1(x) + \\psi_2(x) \\right)\n$$\nwhere $\\psi_1(x)$ and $\\psi_2(x)$ are the ground state and the first excited state, respectively.\n\nDetermine the expectation value of the particle's position, $\\langle x \\rangle(t)$, for any time $t > 0$. Express your answer as a closed-form analytic expression in terms of the parameters $L$, $m$, $t$, and the reduced Planck constant $\\hbar$.", "solution": "The time-dependent state in an infinite well is constructed from stationary states via the time-evolution operator. For stationary states with energy eigenvalues $E_{n}$, the time evolution is given by the principle of unitary evolution:\n$$\n\\Psi(x,t)=\\sum_{n} c_{n}\\,\\psi_{n}(x)\\,\\exp\\!\\left(-\\frac{i E_{n} t}{\\hbar}\\right).\n$$\nGiven $\\Psi(x,0)=\\frac{1}{\\sqrt{2}}\\left(\\psi_{1}(x)+\\psi_{2}(x)\\right)$, the coefficients are $c_{1}=c_{2}=1/\\sqrt{2}$ and $c_{n}=0$ otherwise. Thus,\n$$\n\\Psi(x,t)=\\frac{1}{\\sqrt{2}}\\left[\\psi_{1}(x)\\,\\exp\\!\\left(-\\frac{i E_{1} t}{\\hbar}\\right)+\\psi_{2}(x)\\,\\exp\\!\\left(-\\frac{i E_{2} t}{\\hbar}\\right)\\right],\n$$\nwith $E_{n}=\\frac{n^{2}\\pi^{2}\\hbar^{2}}{2 m L^{2}}$ for the infinite well.\n\nThe expectation value of position is\n$$\n\\langle x\\rangle(t)=\\int_{0}^{L}\\Psi^{*}(x,t)\\,x\\,\\Psi(x,t)\\,dx.\n$$\nSubstituting $\\Psi(x,t)$ and using the reality of $\\psi_{n}(x)$ gives\n$$\n\\langle x\\rangle(t)=\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle+\\exp\\!\\left(-\\frac{i\\Delta E\\, t}{\\hbar}\\right)\\langle 1|x|2\\rangle+\\exp\\!\\left(\\frac{i\\Delta E\\, t}{\\hbar}\\right)\\langle 2|x|1\\rangle\\right],\n$$\nwhere $\\Delta E=E_{2}-E_{1}$ and $\\langle n|x|m\\rangle=\\int_{0}^{L}\\psi_{n}(x)\\,x\\,\\psi_{m}(x)\\,dx$. Since $x$ is Hermitian and the basis is real, $\\langle 2|x|1\\rangle=\\langle 1|x|2\\rangle$, and the cross terms combine to $2\\langle 1|x|2\\rangle\\cos\\!\\left(\\frac{\\Delta E\\, t}{\\hbar}\\right)$:\n$$\n\\langle x\\rangle(t)=\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle\\right]+\\langle 1|x|2\\rangle\\,\\cos\\!\\left(\\frac{\\Delta E\\, t}{\\hbar}\\right).\n$$\n\nEvaluate the diagonal elements $\\langle n|x|n\\rangle$:\n$$\n\\langle n|x|n\\rangle=\\frac{2}{L}\\int_{0}^{L}x\\sin^{2}\\!\\left(\\frac{n\\pi x}{L}\\right)\\,dx.\n$$\nUsing $\\sin^{2}\\theta=\\frac{1}{2}\\left(1-\\cos 2\\theta\\right)$ and the integral $J(k)=\\int_{0}^{L}x\\cos(kx)\\,dx=\\left[\\frac{x\\sin(kx)}{k}+\\frac{\\cos(kx)-1}{k^{2}}\\right]_{0}^{L}$, with $k=\\frac{2n\\pi}{L}$ giving $\\sin(kL)=0$ and $\\cos(kL)=1$, we obtain $J(k)=0$. Therefore,\n$$\n\\langle n|x|n\\rangle=\\frac{2}{L}\\cdot\\frac{1}{2}\\int_{0}^{L}x\\,dx=\\frac{2}{L}\\cdot\\frac{1}{2}\\cdot\\frac{L^{2}}{2}=\\frac{L}{2}.\n$$\nThus $\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle\\right]=\\frac{L}{2}$.\n\nNow evaluate the off-diagonal element $\\langle 1|x|2\\rangle$:\n$$\n\\langle 1|x|2\\rangle=\\frac{2}{L}\\int_{0}^{L}x\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)dx.\n$$\nUse $\\sin\\alpha\\sin\\beta=\\frac{1}{2}\\left[\\cos(\\alpha-\\beta)-\\cos(\\alpha+\\beta)\\right]$. Let $a=\\frac{\\pi}{L}$ and $b=\\frac{2\\pi}{L}$. Then\n$$\n\\int_{0}^{L}x\\sin(ax)\\sin(bx)\\,dx=\\frac{1}{2}\\left[J(a-b)-J(a+b)\\right],\n$$\nwith $J(k)$ as above. For $k_{1}=a-b=-\\frac{\\pi}{L}$, $k_{1}L=-\\pi$, so $\\sin(k_{1}L)=0$ and $\\cos(k_{1}L)=-1$, yielding $J(k_{1})=-\\frac{2}{k_{1}^{2}}=-\\frac{2L^{2}}{\\pi^{2}}$. For $k_{2}=a+b=\\frac{3\\pi}{L}$, $k_{2}L=3\\pi$, giving $J(k_{2})=-\\frac{2}{k_{2}^{2}}=-\\frac{2L^{2}}{9\\pi^{2}}$. Therefore,\n$$\n\\int_{0}^{L}x\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)dx=\\frac{1}{2}\\left(-\\frac{2L^{2}}{\\pi^{2}}+\\frac{2L^{2}}{9\\pi^{2}}\\right)=-\\frac{8L^{2}}{9\\pi^{2}},\n$$\nand hence\n$$\n\\langle 1|x|2\\rangle=\\frac{2}{L}\\left(-\\frac{8L^{2}}{9\\pi^{2}}\\right)=-\\frac{16L}{9\\pi^{2}}.\n$$\n\nThe energy difference is\n$$\n\\Delta E=E_{2}-E_{1}=\\frac{(4-1)\\pi^{2}\\hbar^{2}}{2 m L^{2}}=\\frac{3\\pi^{2}\\hbar^{2}}{2 m L^{2}},\n$$\nso $\\frac{\\Delta E}{\\hbar}=\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}$. Combining everything,\n$$\n\\langle x\\rangle(t)=\\frac{L}{2}-\\frac{16L}{9\\pi^{2}}\\cos\\!\\left(\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}\\,t\\right).\n$$\nThis is the required closed-form expression in terms of $L$, $m$, $t$, and $\\hbar$.", "answer": "$$\\boxed{\\frac{L}{2}-\\frac{16L}{9\\pi^{2}}\\cos\\!\\left(\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}\\,t\\right)}$$", "id": "2089747"}, {"introduction": "This exercise provides a direct, hands-on application of Ehrenfest's theorem in its most classical-looking form: the rate of change of average momentum equals the average force. You are tasked with calculating the initial acceleration of a quantum wave packet in a non-harmonic potential, putting your skills in computing expectation values to the test. This problem solidifies the deep connection between the potential landscape a particle experiences and the resulting dynamics of its average momentum, bridging the gap between abstract quantum states and tangible mechanical predictions [@problem_id:543546].", "problem": "A particle of mass $m$ moves in one dimension under the influence of an anharmonic potential $V(x) = \\frac{1}{2}k x^2 + \\lambda x^4$, where $k$ and $\\lambda$ are positive real constants. At time $t=0$, the particle's quantum state is described by the normalized wave function:\n$$ \\Psi(x, 0) = \\left(\\frac{2a}{\\pi}\\right)^{1/4} \\exp\\left(-a(x-x_0)^2 + \\frac{i p_0 x}{\\hbar}\\right) $$\nwhere $a > 0$, $x_0$, and $p_0$ are real constants.\n\nEhrenfest's theorem states that for a particle moving in a potential $V(x)$, the time derivative of the expectation value of momentum is given by $\\frac{d\\langle \\hat{p} \\rangle}{dt} = \\left\\langle -\\frac{dV(\\hat{x})}{dx} \\right\\rangle$.\n\nUsing this theorem, determine the initial rate of change of the expectation value of the particle's momentum, $\\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0}$.", "solution": "The problem asks for the initial rate of change of the expectation value of momentum, $\\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0}$. According to Ehrenfest's theorem, this is given by the expectation value of the force operator at $t=0$.\n\nFirst, we find the force operator $\\hat{F}$ corresponding to the potential $V(\\hat{x}) = \\frac{1}{2}k \\hat{x}^2 + \\lambda \\hat{x}^4$. The force is the negative gradient of the potential:\n$$ \\hat{F} = -\\frac{dV(\\hat{x})}{d\\hat{x}} = -\\frac{d}{d\\hat{x}}\\left(\\frac{1}{2}k \\hat{x}^2 + \\lambda \\hat{x}^4\\right) = -k\\hat{x} - 4\\lambda\\hat{x}^3 $$\n\nNow, we need to compute the expectation value of this operator in the initial state $\\Psi(x, 0)$.\n$$ \\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0} = \\langle \\hat{F} \\rangle_{t=0} = \\langle -k\\hat{x} - 4\\lambda\\hat{x}^3 \\rangle_{t=0} $$\n\nUsing the linearity of expectation values, this can be written as:\n$$ \\langle \\hat{F} \\rangle_{t=0} = -k\\langle \\hat{x} \\rangle_{t=0} - 4\\lambda\\langle \\hat{x}^3 \\rangle_{t=0} $$\n\nWe must now calculate the expectation values $\\langle \\hat{x} \\rangle_{t=0}$ and $\\langle \\hat{x}^3 \\rangle_{t=0}$. The expectation value of an operator $\\hat{O}$ is given by $\\langle \\hat{O} \\rangle = \\int_{-\\infty}^{\\infty} \\Psi^*(x, 0) \\hat{O} \\Psi(x, 0) dx$. The probability density at $t=0$ is:\n$$ |\\Psi(x, 0)|^2 = \\Psi^*(x, 0)\\Psi(x, 0) = \\left(\\left(\\frac{2a}{\\pi}\\right)^{1/4} \\exp\\left(-a(x-x_0)^2 - \\frac{i p_0 x}{\\hbar}\\right)\\right) \\left(\\left(\\frac{2a}{\\pi}\\right)^{1/4} \\exp\\left(-a(x-x_0)^2 + \\frac{i p_0 x}{\\hbar}\\right)\\right) $$\n$$ |\\Psi(x, 0)|^2 = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\exp\\left(-2a(x-x_0)^2\\right) $$\nNote that the momentum term $p_0$ does not affect the probability density.\n\n1.  **Calculate $\\langle \\hat{x} \\rangle_{t=0}$:**\n    $$ \\langle \\hat{x} \\rangle_{t=0} = \\int_{-\\infty}^{\\infty} x |\\Psi(x, 0)|^2 dx = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x e^{-2a(x-x_0)^2} dx $$\n    Let $u = x - x_0$, so $x = u + x_0$ and $du = dx$. The integral becomes:\n    $$ \\langle \\hat{x} \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} (u + x_0) e^{-2au^2} du $$\n    $$ = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ \\int_{-\\infty}^{\\infty} u e^{-2au^2} du + x_0 \\int_{-\\infty}^{\\infty} e^{-2au^2} du \\right] $$\n    The first integral is of an odd function over a symmetric interval, so it is zero. For the second integral, we use the standard Gaussian integral formula $\\int_{-\\infty}^{\\infty} e^{-bu^2}du = \\sqrt{\\frac{\\pi}{b}}$. With $b=2a$, we have:\n    $$ \\langle \\hat{x} \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ 0 + x_0 \\sqrt{\\frac{\\pi}{2a}} \\right] = x_0 $$\n\n2.  **Calculate $\\langle \\hat{x}^3 \\rangle_{t=0}$:**\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\int_{-\\infty}^{\\infty} x^3 |\\Psi(x, 0)|^2 dx = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} x^3 e^{-2a(x-x_0)^2} dx $$\n    Using the same substitution $u = x-x_0$:\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} (u+x_0)^3 e^{-2au^2} du $$\n    Expand the cubic term: $(u+x_0)^3 = u^3 + 3u^2x_0 + 3ux_0^2 + x_0^3$.\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\int_{-\\infty}^{\\infty} (u^3 + 3u^2x_0 + 3ux_0^2 + x_0^3) e^{-2au^2} du $$\n    The terms with odd powers of $u$ integrate to zero. We are left with:\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ 3x_0 \\int_{-\\infty}^{\\infty} u^2 e^{-2au^2} du + x_0^3 \\int_{-\\infty}^{\\infty} e^{-2au^2} du \\right] $$\n    We use the known Gaussian integrals. For the new integral, $\\int_{-\\infty}^{\\infty} u^2 e^{-bu^2}du = \\frac{1}{2b}\\sqrt{\\frac{\\pi}{b}}$. With $b=2a$:\n    $$ \\int_{-\\infty}^{\\infty} u^2 e^{-2au^2} du = \\frac{1}{2(2a)}\\sqrt{\\frac{\\pi}{2a}} = \\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}} $$\n    Substituting the integral results:\n    $$ \\langle \\hat{x}^3 \\rangle_{t=0} = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\left[ 3x_0 \\left(\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}\\right) + x_0^3 \\left(\\sqrt{\\frac{\\pi}{2a}}\\right) \\right] $$\n    $$ = \\left(\\frac{2a}{\\pi}\\right)^{1/2} \\sqrt{\\frac{\\pi}{2a}} \\left[ \\frac{3x_0}{4a} + x_0^3 \\right] = \\frac{3x_0}{4a} + x_0^3 $$\n\nFinally, we substitute the expectation values back into the expression for the rate of change of momentum:\n$$ \\frac{d\\langle \\hat{p} \\rangle}{dt}\\bigg|_{t=0} = -k\\langle \\hat{x} \\rangle_{t=0} - 4\\lambda\\langle \\hat{x}^3 \\rangle_{t=0} $$\n$$ = -k(x_0) - 4\\lambda\\left(\\frac{3x_0}{4a} + x_0^3\\right) $$\n$$ = -kx_0 - \\frac{3\\lambda x_0}{a} - 4\\lambda x_0^3 $$\n$$ = -x_0 \\left( k + 4\\lambda x_0^2 + \\frac{3\\lambda}{a} \\right) $$", "answer": "$$ \\boxed{-x_0 \\left( k + 4\\lambda x_0^2 + \\frac{3\\lambda}{a} \\right)} $$", "id": "543546"}, {"introduction": "Moving from analytical calculation to computational physics, this practice challenges you to bring the Ehrenfest theorem to life. You will write a program to simulate the time evolution of a quantum wave packet subject to a constant force, a scenario analogous to a ball rolling down a ramp. By numerically solving the SchrÃ¶dinger equation and tracking the expectation value of momentum, $\\langle p \\rangle(t)$, you can verify that the quantum system, on average, obeys the simple laws of classical mechanics. This task not only reinforces the theorem but also equips you with powerful computational methods for exploring quantum dynamics [@problem_id:2450185].", "problem": "You are to write a complete, runnable program that simulates the time evolution of a one-dimensional nonrelativistic quantum wave packet under a linear potential ramp and quantitatively verifies the Ehrenfest theorem for the expectation value of momentum. Work in a dimensionless unit system where the reduced Planck constant $\\hbar$ equals $1$ and the particle mass $m$ equals $1$. The dynamics are governed by the time-dependent SchrÃ¶dinger equation\n$$\ni \\,\\partial_t \\psi(x,t) \\;=\\; \\left[-\\tfrac{1}{2}\\,\\partial_{x}^2 \\;+\\; V(x)\\right]\\psi(x,t),\n$$\nwith the linear potential\n$$\nV(x) \\;=\\; \\alpha\\,x,\n$$\nwhere $\\alpha$ is a real constant. The wave packet at time $t=0$ shall be a normalized Gaussian minimum-uncertainty state centered at position $x_0$ with root-mean-square width $\\sigma$ and mean wavenumber $k_0$,\n$$\n\\psi(x,0) \\;\\propto\\; \\exp\\!\\left(-\\frac{(x-x_0)^2}{4\\sigma^2} + i\\,k_0\\,x\\right),\n$$\nnormalized so that\n$$\n\\int_{-\\infty}^{\\infty} |\\psi(x,0)|^2\\,dx \\;=\\; 1.\n$$\nOn a finite, periodic, one-dimensional spatial domain of length $L$ discretized into $N$ evenly spaced grid points, simulate the evolution for a total time $T = N_t\\,\\Delta t$ with uniform time step $\\Delta t$, starting from the given initial state. At each time $t$, define the expectation value of momentum by the inner product\n$$\n\\langle p \\rangle(t) \\;=\\; \\int_{-L/2}^{L/2} \\psi^*(x,t)\\, \\left(-i\\,\\partial_x\\right)\\,\\psi(x,t)\\,dx.\n$$\nThe Ehrenfest theorem implies that\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) \\;=\\; -\\left\\langle \\frac{\\partial V}{\\partial x} \\right\\rangle(t).\n$$\nFor the linear potential $V(x)=\\alpha x$, one has $\\partial_x V(x)=\\alpha$, hence\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) \\;=\\; -\\alpha.\n$$\nYour program must, for each specified test case, estimate the best-fit slope $s$ of the function $\\langle p \\rangle(t)$ with respect to $t$ over the full simulation interval $[0,T]$ by linear least squares, and then compare $s$ to the theoretical value $-\\alpha$. For each test, report a boolean indicating whether the absolute deviation satisfies\n$$\n|\\,s - (-\\alpha)\\,| \\;\\le\\; \\tau,\n$$\nwhere $\\tau$ is a given tolerance.\n\nUse the following test suite of parameter sets. All symbols are as defined above, and all numbers are dimensionless. The spatial domain is periodic on $[-L/2,\\,L/2)$ and the same grid and time parameters are used for all tests.\n- Common simulation parameters: $L = 200$, $N = 1024$, $\\Delta t = 0.002$, $N_t = 1500$, $\\sigma = 5$, $x_0 = -50$.\n- Test set A (general case): $\\alpha = 0.2$, $k_0 = 3.0$, tolerance $\\tau = 0.03$.\n- Test set B (free evolution boundary case): $\\alpha = 0.0$, $k_0 = 2.0$, tolerance $\\tau = 0.02$.\n- Test set C (negative ramp case): $\\alpha = -0.3$, $k_0 = 0.0$, tolerance $\\tau = 0.03$.\n\nYour program must output a single line containing a list of booleans corresponding to the three tests in the order A, B, C, each boolean being true if the condition is met for that test and false otherwise. The exact required output format is one line of the form\n$$\n[\\text{result\\_A},\\text{result\\_B},\\text{result\\_C}],\n$$\nfor example, $[{\\rm True},{\\rm False},{\\rm True}]$.", "solution": "The problem as stated is valid. It is a well-defined problem in computational quantum mechanics, based on sound physical and mathematical principles, with all necessary parameters provided for a complete numerical solution. We shall proceed to construct the solution.\n\nThe task is to simulate the time evolution of a one-dimensional quantum wave packet $\\psi(x,t)$ governed by the time-dependent SchrÃ¶dinger equation. In the specified dimensionless units where the reduced Planck constant $\\hbar=1$ and the particle mass $m=1$, this equation is:\n$$\ni \\,\\frac{\\partial \\psi(x,t)}{\\partial t} = \\hat{H}\\psi(x,t) = \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\\right]\\psi(x,t)\n$$\nThe potential is a linear ramp, $V(x) = \\alpha x$. The formal solution for the evolution over a time interval $\\Delta t$ is given by the action of the time evolution operator, $\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)$.\n\nTo implement this numerically, we adopt the split-step Fourier method, which is highly efficient and stable for this class of problems. The Hamiltonian $\\hat{H}$ is a sum of the kinetic energy operator, $\\hat{T} = -\\frac{1}{2}\\partial_x^2$, and the potential energy operator, $\\hat{V} = V(x)$. Since $\\hat{T}$ and $\\hat{V}$ do not commute, the exponential of their sum is approximated. We use the second-order accurate symmetric Strang splitting:\n$$\ne^{-i(\\hat{T}+\\hat{V})\\Delta t} \\approx e^{-i\\hat{V}\\Delta t/2} \\, e^{-i\\hat{T}\\Delta t} \\, e^{-i\\hat{V}\\Delta t/2} + O(\\Delta t^3)\n$$\nThis decomposition allows us to handle each operator in its preferred basis. The action of $e^{-i\\hat{V}\\Delta t/2}$ is a simple multiplication in position space. The action of $e^{-i\\hat{T}\\Delta t}$ is a simple multiplication in momentum (Fourier) space. The transition between these spaces is efficiently handled by the Fast Fourier Transform (FFT).\n\nThe algorithm to advance the wave function from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ consists of these steps:\n1.  Apply the first potential operator half-step in position space: $\\psi' = e^{-iV(x)\\Delta t/2} \\psi(x,t_n)$.\n2.  Transform to momentum space using FFT: $\\tilde{\\psi}' = \\mathcal{F}\\{\\psi'\\}$.\n3.  Apply the full kinetic operator step in momentum space: $\\tilde{\\psi}'' = e^{-i k^2 \\Delta t/2} \\tilde{\\psi}'$, where $k$ is the wavenumber.\n4.  Transform back to position space using inverse FFT: $\\psi'' = \\mathcal{F}^{-1}\\{\\tilde{\\psi}''\\}$.\n5.  Apply the second potential operator half-step: $\\psi(x,t_{n+1}) = e^{-iV(x)\\Delta t/2} \\psi''$.\n\nThis process is repeated $N_t$ times to simulate the evolution over the total time $T = N_t \\Delta t$.\n\nThe simulation is set up on a discrete grid. The spatial domain $[-L/2, L/2)$ is discretized into $N$ points, yielding a grid spacing of $\\Delta x = L/N$. The initial state at $t=0$ is a normalized Gaussian wave packet defined by:\n$$\n\\psi(x,0) = A \\cdot \\exp\\left(-\\frac{(x-x_0)^2}{4\\sigma^2} + i k_0 x\\right)\n$$\nThe normalization constant $A = (2\\pi\\sigma^2)^{-1/4}$ ensures $\\int|\\psi|^2 dx = 1$. For numerical implementation, the wave function is initialized on the discrete grid and then numerically re-normalized to enforce $\\sum_j |\\psi_j|^2 \\Delta x = 1$.\n\nThe primary goal is to verify the Ehrenfest theorem for the expectation value of momentum, $\\langle p \\rangle(t)$:\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) = \\left\\langle -\\frac{\\partial V}{\\partial x} \\right\\rangle(t)\n$$\nFor the potential $V(x)=\\alpha x$, the force is constant, $-\\partial V/\\partial x = -\\alpha$. This implies that the expectation value of momentum should change linearly with time, with a slope of $-\\alpha$:\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) = -\\alpha\n$$\nAt each time step $t_n$, we must compute $\\langle p \\rangle(t_n)$. This is given by the integral:\n$$\n\\langle p \\rangle(t) = \\int \\psi^*(x,t) \\hat{p} \\psi(x,t) dx = \\int \\psi^*(x,t) \\left(-i\\frac{\\partial}{\\partial x}\\right) \\psi(x,t) dx\n$$\nFor maximum accuracy and consistency with the spectral evolution method, the spatial derivative $\\partial_x \\psi$ is computed using FFTs: $\\partial_x \\psi = \\mathcal{F}^{-1}\\{ i k \\mathcal{F}\\{\\psi\\} \\}$. The integral is then computed as a sum over the grid points. The expectation value $\\langle p \\rangle$ must be real for a Hermitian operator like momentum; any small imaginary part arising from numerical imprecision is discarded.\n\nAfter the simulation, a time series of momentum expectation values, $(t_n, \\langle p \\rangle(t_n))$, for $n=0, \\ldots, N_t$, is obtained. A linear least-squares regression is performed on this data to determine the numerical slope, $s$. The `numpy.polyfit` function is suitable for this task.\n\nFinally, for each test case, the computed slope $s$ is compared to the theoretical value $-\\alpha$. The boolean condition $|\\,s - (-\\alpha)\\,| \\leq \\tau$ is evaluated, and the results for all tests are consolidated into the specified output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation for all test cases and print the results.\n    \"\"\"\n\n    def run_simulation(L, N, dt, Nt, sigma, x0, alpha, k0, tau):\n        \"\"\"\n        Simulates the time evolution of a 1D Gaussian wave packet in a linear potential\n        and quantitatively verifies Ehrenfest's theorem for momentum.\n\n        Args:\n            L (float): Length of the periodic spatial domain.\n            N (int): Number of grid points.\n            dt (float): Time step for the simulation.\n            Nt (int): Total number of time steps.\n            sigma (float): Initial root-mean-square width of the wave packet.\n            x0 (float): Initial center position of the wave packet.\n            alpha (float): Slope of the linear potential V(x) = alpha * x.\n            k0 (float): Initial mean wavenumber of the wave packet.\n            tau (float): Tolerance for comparing the theoretical and numerical slopes.\n\n        Returns:\n            bool: True if the absolute deviation between the measured slope and the\n                  theoretical slope (-alpha) is within the tolerance tau, False otherwise.\n        \"\"\"\n        # 1. Setup of Computational Grids\n        # Spatial grid (domain from -L/2 to L/2)\n        dx = L / N\n        x = np.linspace(-L / 2.0, L / 2.0 - dx, N)\n        # Wavenumber (momentum) grid for FFT\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n        # 2. Initialization of the Wave Packet\n        # Analytic normalization constant for an infinite domain\n        norm_factor = (2 * np.pi * sigma**2)**(-0.25)\n        # Initial wave function (Gaussian packet)\n        psi = norm_factor * np.exp(-(x - x0)**2 / (4 * sigma**2) + 1j * k0 * x)\n        # Numerical normalization on the discrete periodic grid\n        psi /= np.sqrt(np.sum(np.abs(psi)**2) * dx)\n\n        # 3. Preparation of Time Evolution Operators\n        # These are pre-calculated for efficiency in the loop.\n        # Potential operator for a half time step in position space\n        V_op_half = np.exp(-0.5j * (alpha * x) * dt)\n        # Kinetic operator for a full time step in momentum space\n        T_op_full = np.exp(-0.5j * k**2 * dt)\n\n        # Arrays for storing data at each time step for final analysis\n        times = np.zeros(Nt + 1)\n        p_expectations = np.zeros(Nt + 1)\n\n        # 4. Time Evolution via Split-Step Fourier Method\n        for i in range(Nt + 1):\n            # Store current time\n            times[i] = i * dt\n\n            # Calculate and store the expectation value of momentum âŸ¨pâŸ©\n            # âŸ¨pâŸ© = integral(psi* (-i * d/dx) psi) dx\n            # The derivative is computed spectrally for consistency.\n            dpsi_dx = np.fft.ifft(1j * k * np.fft.fft(psi))\n            p_integrand = np.conj(psi) * (-1j * dpsi_dx)\n            p_exp = np.sum(p_integrand) * dx\n            p_expectations[i] = np.real(p_exp) # Must be real, np.real handles numerical noise.\n\n            # Evolve the wave function by one time step dt (if not the last point)\n            if i  Nt:\n                # First half-step in potential\n                psi *= V_op_half\n                # Full step in kinetic energy (in k-space)\n                psi_k = np.fft.fft(psi)\n                psi_k *= T_op_full\n                psi = np.fft.ifft(psi_k)\n                # Second half-step in potential\n                psi *= V_op_half\n\n        # 5. Analysis and Verification of Ehrenfest's Theorem\n        # Perform a linear least-squares fit on âŸ¨pâŸ©(t) vs t to find the slope.\n        # This finds coefficients [slope, intercept] for the best-fit line.\n        slope, _ = np.polyfit(times, p_expectations, 1)\n\n        # According to Ehrenfest's theorem, the theoretical slope is -alpha.\n        theoretical_slope = -alpha\n\n        # Check if the absolute deviation is within the specified tolerance.\n        return np.abs(slope - theoretical_slope) = tau\n\n    # Common simulation parameters for all test cases\n    L = 200.0\n    N = 1024\n    dt = 0.002\n    Nt = 1500\n    sigma = 5.0\n    x0 = -50.0\n\n    # Definition of test cases from the problem statement\n    # Each tuple is (alpha, k0, tolerance)\n    test_cases = [\n        (0.2, 3.0, 0.03),   # Test set A (general case)\n        (0.0, 2.0, 0.02),   # Test set B (free evolution)\n        (-0.3, 0.0, 0.03),  # Test set C (negative ramp)\n    ]\n\n    # Run simulation for each case and collect boolean results\n    results = []\n    for alpha, k0, tau in test_cases:\n        is_verified = run_simulation(L, N, dt, Nt, sigma, x0, alpha, k0, tau)\n        results.append(is_verified)\n\n    # Final print statement in the exact required format: [result_A,result_B,result_C]\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function to run the program.\nsolve()\n```", "id": "2450185"}]}