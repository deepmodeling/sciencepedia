{"hands_on_practices": [{"introduction": "This first practice problem lays the groundwork for analyzing coupled mechanical systems. We will explore a classic setup of two masses and two springs, which serves as a fundamental model for understanding how vibrations propagate through a system. The key skill you'll develop is translating the physical system's equations of motion into a compact matrix equation, $M\\ddot{\\mathbf{x}} + K\\mathbf{x} = 0$, a cornerstone of modern dynamical analysis [@problem_id:2205585]. This exercise also reveals an elegant mathematical shortcut for determining properties of the normal frequencies.", "problem": "A mechanical system consists of two blocks, with masses $m_1$ and $m_2$, constrained to move horizontally along a single axis on a frictionless surface. A fixed wall is connected to the first block (mass $m_1$) by a spring of spring constant $k_1$. The two blocks are connected to each other by a second spring of spring constant $k_2$. For this system, there are two characteristic modes of oscillation, each with a specific normal angular frequency. Determine the sum of the squares of these two normal angular frequencies, $\\omega_1^2 + \\omega_2^2$. Express your answer as a single closed-form analytic expression in terms of $m_1, m_2, k_1,$ and $k_2$.", "solution": "Let $x_{1}(t)$ and $x_{2}(t)$ denote the displacements of masses $m_{1}$ and $m_{2}$ from equilibrium along the horizontal axis. The forces are linear due to the springs. The equations of motion from Newton’s second law are\n$$\nm_{1}\\ddot{x}_{1}=-k_{1}x_{1}-k_{2}(x_{1}-x_{2}), \\quad m_{2}\\ddot{x}_{2}=-k_{2}(x_{2}-x_{1}).\n$$\nThese can be written in matrix form as\n$$\nM\\ddot{\\boldsymbol{x}}+K\\boldsymbol{x}=0,\n$$\nwith\n$$\nM=\\begin{pmatrix} m_{1} & 0 \\\\ 0 & m_{2} \\end{pmatrix}, \\quad K=\\begin{pmatrix} k_{1}+k_{2} & -k_{2} \\\\ -k_{2} & k_{2} \\end{pmatrix}, \\quad \\boldsymbol{x}=\\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}.\n$$\nSeeking normal modes of the form $\\boldsymbol{x}(t)=\\boldsymbol{a}\\exp(i\\omega t)$ gives the generalized eigenvalue problem\n$$\n\\left(K-\\omega^{2}M\\right)\\boldsymbol{a}=0.\n$$\nNontrivial solutions require $\\det\\left(K-\\omega^{2}M\\right)=0$. The eigenvalues $\\omega^{2}$ are the generalized eigenvalues of the pencil $(K,M)$, equivalently the ordinary eigenvalues of $M^{-1}K$. Therefore, the sum of the two eigenvalues satisfies\n$$\n\\omega_{1}^{2}+\\omega_{2}^{2}=\\operatorname{tr}\\!\\left(M^{-1}K\\right).\n$$\nCompute $M^{-1}K$:\n$$\nM^{-1}K=\\begin{pmatrix} \\frac{1}{m_{1}} & 0 \\\\ 0 & \\frac{1}{m_{2}} \\end{pmatrix}\\begin{pmatrix} k_{1}+k_{2} & -k_{2} \\\\ -k_{2} & k_{2} \\end{pmatrix}=\\begin{pmatrix} \\frac{k_{1}+k_{2}}{m_{1}} & -\\frac{k_{2}}{m_{1}} \\\\ -\\frac{k_{2}}{m_{2}} & \\frac{k_{2}}{m_{2}} \\end{pmatrix}.\n$$\nThus,\n$$\n\\omega_{1}^{2}+\\omega_{2}^{2}=\\operatorname{tr}\\!\\left(M^{-1}K\\right)=\\frac{k_{1}+k_{2}}{m_{1}}+\\frac{k_{2}}{m_{2}}.\n$$\nAs a direct check, form the characteristic equation\n$$\n\\det\\begin{pmatrix} k_{1}+k_{2}-m_{1}\\omega^{2} & -k_{2} \\\\ -k_{2} & k_{2}-m_{2}\\omega^{2} \\end{pmatrix}=0,\n$$\nwhich expands to\n$$\nm_{1}m_{2}\\omega^{4}-\\left[(k_{1}+k_{2})m_{2}+m_{1}k_{2}\\right]\\omega^{2}+k_{1}k_{2}=0.\n$$\nThe sum of the roots in $\\omega^{2}$ is the coefficient of $\\omega^{2}$ with a minus sign divided by the leading coefficient, yielding\n$$\n\\omega_{1}^{2}+\\omega_{2}^{2}=\\frac{(k_{1}+k_{2})m_{2}+m_{1}k_{2}}{m_{1}m_{2}}=\\frac{k_{1}+k_{2}}{m_{1}}+\\frac{k_{2}}{m_{2}},\n$$\nin agreement with the trace result.", "answer": "$$\\boxed{\\frac{k_{1}+k_{2}}{m_{1}}+\\frac{k_{2}}{m_{2}}}$$", "id": "2205585"}, {"introduction": "Moving beyond simple linear motion, this exercise challenges you to analyze a system that combines both translational and rotational degrees of freedom. You will apply the powerful Lagrangian method to derive the equations of motion for a sliding block supporting two pendulums, a setup that models more complex real-world structures. This practice demonstrates how the matrix formalism for normal modes elegantly scales to systems with multiple degrees of freedom, allowing you to efficiently analyze their collective behavior [@problem_id:631963].", "problem": "A rigid block of mass $M$ is constrained to slide without friction on a horizontal track. Two identical simple pendulums, each consisting of a point mass $m$ attached to a massless rod of length $L$, are suspended from the block. The pendulums are free to oscillate in a single vertical plane which is parallel to the track.\n\nLet $x$ be the horizontal displacement of the block from its equilibrium position, and let $\\theta_1$ and $\\theta_2$ be the small angular displacements of the two pendulums from the vertical, respectively. The system, under the small-angle approximation, exhibits three normal modes of oscillation with corresponding angular frequencies $\\omega_1, \\omega_2,$ and $\\omega_3$.\n\nDerive an expression for the sum of the squares of these three normal mode frequencies, $\\sum_{i=1}^3 \\omega_i^2$. Your answer should be in terms of $M, m, L$, and the acceleration due to gravity $g$.", "solution": "We choose generalized coordinates $q=(x,\\theta_1,\\theta_2)$ and work to quadratic order in velocities and displacements.  Under the small‐angle approximation:\n1. Kinetic energy  \n$$T=\\frac12M\\,\\dot x^2+\\sum_{i=1}^2\\frac12m\\bigl(\\dot x+L\\dot\\theta_i\\bigr)^2\n=\\frac12(M+2m)\\dot x^2+mL\\dot x(\\dot\\theta_1+\\dot\\theta_2)+\\frac12mL^2(\\dot\\theta_1^2+\\dot\\theta_2^2).$$\n2. Potential energy  \n$$V=\\sum_{i=1}^2\\frac12m gL\\,\\theta_i^2=\\frac12m gL(\\theta_1^2+\\theta_2^2).$$\nThus the mass matrix $M_{ij}$ and stiffness matrix $K_{ij}$ are\n$$M=\\begin{pmatrix}M+2m & mL & mL\\\\mL & mL^2 & 0\\\\mL&0& mL^2\\end{pmatrix},\\qquad\nK=\\begin{pmatrix}0&0&0\\\\0&m gL&0\\\\0&0&m gL\\end{pmatrix}.$$\nThe normal‐mode frequencies $\\omega_i^2$ are the eigenvalues of $M^{-1}K$, whose sum is\n$$\\sum_{i=1}^3\\omega_i^2=\\Tr\\bigl(M^{-1}K\\bigr)\n=K_{22}M^{-1}_{22}+K_{33}M^{-1}_{33}=2\\,m gL\\,M^{-1}_{22}.$$\nTo find $M^{-1}_{22}$ we use the block‐inverse formula.  Writing\n$$A=M+2m,\\;B=(mL,mL),\\;D=mL^2\\,I_{2},$$\nthe Schur complement is\n$$S=D-\\frac1A B^T B=\\frac{mL^2}{M+2m}\\begin{pmatrix}M+m&-m\\\\-m&M+m\\end{pmatrix},$$\nwhose inverse is\n$$S^{-1}=\\frac1{mL^2M}\\begin{pmatrix}M+m&m\\\\m&M+m\\end{pmatrix}.$$\nHence $M^{-1}_{22}=S^{-1}_{11}=(M+m)/(mL^2M)$ and\n$$\\sum_{i=1}^3\\omega_i^2=2\\,m gL\\;\\frac{M+m}{mL^2M}\n=\\frac{2g\\,(M+m)}{L\\,M}\\,. $$", "answer": "$$\\boxed{\\frac{2g\\,(M+m)}{L\\,M}}$$", "id": "631963"}, {"introduction": "Our final practice problem bridges the gap between the discrete mass-spring systems we've studied and the behavior of continuous media, like a vibrating guitar string. Here, you will contrast the exact analytical solution derived from the wave equation with a numerical approximation using the Finite Element Method (FEM), a cornerstone of modern engineering analysis. This computational exercise [@problem_id:2414089] not only deepens your understanding of normal modes in continuous systems but also provides practical experience with the powerful numerical techniques used to model complex physical phenomena.", "problem": "Consider an ideal taut string of length $L$ under constant tension $T$ with uniform linear mass density $\\mu$. The transverse displacement $u(x,t)$ satisfies the one-dimensional wave equation with fixed-fixed boundary conditions, namely $u(0,t)=0$ and $u(L,t)=0$. Treat the system as continuous to obtain the exact eigenfrequencies and eigenmodes, and also approximate it using a uniform, piecewise-linear finite element model to obtain discrete eigenfrequencies and eigenmodes.\n\nYour program must, for each specified test case, do the following from first principles:\n- For the continuous string, derive the exact $n$-th angular eigenfrequency $\\omega_n^{\\mathrm{exact}}$ and the corresponding normalized exact mode shape $\\phi_n^{\\mathrm{exact}}(x)$, where normalization is with respect to the Euclidean norm of the vector of nodal samples on a uniform mesh.\n- For the finite element discretization with $N_e$ uniform linear elements over $[0,L]$, assemble the exact global stiffness and mass matrices by integrating the weak form over each element, impose the fixed boundary conditions at $x=0$ and $x=L$, and solve the resulting generalized eigenvalue problem to obtain the $n$-th discrete angular eigenfrequency $\\omega_n^{\\mathrm{fem}}$ and the corresponding normalized discrete mode shape vector $\\phi_n^{\\mathrm{fem}}$ (normalized by the Euclidean norm of the full nodal vector, including the zero boundary nodes).\n- Compare the discrete mode shape to the exact mode shape sampled at the same mesh nodes by first aligning the sign of $\\phi_n^{\\mathrm{fem}}$ to maximize the dot product with the sampled exact mode vector, then computing the maximum absolute nodal error.\n- Compute two metrics for each test case: the relative angular frequency error $|\\omega_n^{\\mathrm{fem}}-\\omega_n^{\\mathrm{exact}}|/\\omega_n^{\\mathrm{exact}}$ (dimensionless) and the maximum absolute nodal mode shape error $\\max_i|\\phi_{n,i}^{\\mathrm{fem}}-\\phi_{n,i}^{\\mathrm{exact}}|$ (dimensionless), where $i$ ranges over all mesh nodes including the boundary nodes.\n\nUse the following physical parameters for all test cases: length $L=1\\,\\mathrm{m}$, tension $T=100\\,\\mathrm{N}$, and linear density $\\mu=0.01\\,\\mathrm{kg/m}$. Angular quantities must be in radians per second. Report all errors as dimensionless real numbers.\n\nTest suite (each test case is a pair $(N_e,n)$ of the number of uniform elements and the mode index):\n- Case $1$: $(N_e,n)=(2,1)$.\n- Case $2$: $(N_e,n)=(4,1)$.\n- Case $3$: $(N_e,n)=(8,2)$.\n- Case $4$: $(N_e,n)=(16,3)$.\n- Case $5$: $(N_e,n)=(8,7)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list of real numbers $[\\text{frequency\\_relative\\_error},\\text{mode\\_shape\\_max\\_nodal\\_error}]$. For the five cases above, the final output format must be\n$[[e_{1,f},e_{1,s}],[e_{2,f},e_{2,s}],[e_{3,f},e_{3,s}],[e_{4,f},e_{4,s}],[e_{5,f},e_{5,s}]]$\nwhere $e_{k,f}$ is the relative angular frequency error and $e_{k,s}$ is the maximum absolute nodal mode shape error for case $k$.", "solution": "The problem presented is a well-defined exercise in computational structural dynamics, specifically the comparison of an analytical solution with a numerical approximation via the Finite Element Method (FEM). It is scientifically grounded, mathematically consistent, and all necessary parameters are provided. Therefore, the problem is valid and I will proceed with a full derivation and solution.\n\nThe analysis is divided into three parts: first, the derivation of the exact eigen-solution for the continuous system; second, the formulation and solution of the discrete finite element model; and third, the definition of error metrics for comparison.\n\n**1. Continuous System: Exact Analytical Solution**\n\nThe transverse displacement $u(x,t)$ of an ideal taut string is governed by the one-dimensional wave equation:\n$$\n\\mu \\frac{\\partial^2 u}{\\partial t^2} - T \\frac{\\partial^2 u}{\\partial x^2} = 0, \\quad x \\in [0, L]\n$$\nwhere $\\mu$ is the linear mass density, $T$ is the tension, $L$ is the length of the string, $x$ is the spatial coordinate, and $t$ is time. The boundary conditions are fixed-fixed, meaning $u(0,t) = 0$ and $u(L,t) = 0$.\n\nTo find the natural frequencies and mode shapes (the eigen-solution), we seek standing wave solutions using the method of separation of variables. We assume a solution of the form $u(x,t) = \\phi(x)q(t)$. Substituting this into the wave equation and rearranging yields:\n$$\n\\frac{1}{q(t)} \\frac{d^2 q}{dt^2} = \\frac{T}{\\mu} \\frac{1}{\\phi(x)} \\frac{d^2 \\phi}{dx^2}\n$$\nSince the left side depends only on $t$ and the right side only on $x$, both must be equal to a constant, which we denote as $-\\omega^2$. This yields two ordinary differential equations:\n$$\n\\frac{d^2 q}{dt^2} + \\omega^2 q = 0\n$$\n$$\n\\frac{d^2 \\phi}{dx^2} + k^2 \\phi = 0, \\quad \\text{where } k^2 = \\frac{\\mu \\omega^2}{T}\n$$\nThe spatial equation for the mode shape $\\phi(x)$ has the general solution:\n$$\n\\phi(x) = A \\sin(kx) + B \\cos(kx)\n$$\nApplying the boundary conditions:\n1.  $\\phi(0) = 0 \\implies A \\sin(0) + B \\cos(0) = 0 \\implies B = 0$.\n2.  $\\phi(L) = 0 \\implies A \\sin(kL) = 0$. For a non-trivial solution ($A \\neq 0$), we must have $\\sin(kL) = 0$.\n\nThis condition is satisfied when $kL = n\\pi$ for any integer $n=1, 2, 3, \\dots$. This quantizes the admissible wavenumbers $k_n$:\n$$\nk_n = \\frac{n\\pi}{L}\n$$\nSubstituting this back into the relation for $\\omega^2$, we find the discrete set of angular eigenfrequencies $\\omega_n^{\\mathrm{exact}}$:\n$$\n(\\omega_n^{\\mathrm{exact}})^2 = \\frac{T}{\\mu} k_n^2 = \\frac{T}{\\mu} \\left(\\frac{n\\pi}{L}\\right)^2 \\implies \\omega_n^{\\mathrm{exact}} = \\frac{n\\pi}{L} \\sqrt{\\frac{T}{\\mu}}\n$$\nThe corresponding mode shapes (eigenmodes) are given by:\n$$\n\\phi_n^{\\mathrm{exact}}(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\nwhere the amplitude has been set to $1$ for simplicity, as it will be handled by normalization. For comparison with the FEM solution on a mesh with $N_e$ elements (and thus $N_e+1$ nodes), we sample this continuous function at the nodal coordinates $x_i = i \\cdot (L/N_e)$ for $i=0, 1, \\dots, N_e$. The resulting sampled vector must be normalized by its Euclidean norm, yielding the vector $\\boldsymbol{\\phi}_n^{\\mathrm{exact}}$.\n\n**2. Discrete System: Finite Element Method**\n\nWe begin with the weak form of the spatial governing equation, $-T u'' = \\omega^2 \\mu u$. For a test function $v(x)$ that satisfies the same homogeneous boundary conditions (i.e., $v(0)=v(L)=0$), the weak form is:\n$$\n\\int_0^L v(-T u'') dx = \\int_0^L v(\\omega^2 \\mu u) dx\n$$\nIntegrating the left side by parts gives:\n$$\n\\int_0^L T u' v' dx - [T u' v]_0^L = \\omega^2 \\int_0^L \\mu u v dx\n$$\nThe boundary term $[T u' v]_0^L$ vanishes because $v(0)=v(L)=0$. The weak form becomes:\n$$\n\\int_0^L T u' v' dx = \\omega^2 \\int_0^L \\mu u v dx\n$$\nWe discretize the domain $[0,L]$ into $N_e$ linear elements, each of length $h = L/N_e$. Within each element, the displacement is approximated by linear shape functions $N_1(\\xi), N_2(\\xi)$, where $\\xi \\in [0,h]$ is the local coordinate: $u^e(\\xi) = N_1(\\xi) d_1 + N_2(\\xi) d_2$. The shape functions are $N_1(\\xi) = 1-\\xi/h$ and $N_2(\\xi)=\\xi/h$.\n\nThe element stiffness matrix $k^e$ and mass matrix $m^e$ are derived by substituting the approximation into the weak form, integrating over one element:\n$$\nk_{ij}^e = \\int_0^h T N_i' N_j' d\\xi = \\frac{T}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n$$\nm_{ij}^e = \\int_0^h \\mu N_i N_j d\\xi = \\frac{\\mu h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\nThis is the consistent mass matrix formulation, as required for accurate eigen-analysis. The global matrices $K$ and $M$ of size $(N_e+1) \\times (N_e+1)$ are assembled by summing the contributions from all $N_e$ elements. This results in the global generalized eigenvalue problem:\n$$\nK\\boldsymbol{\\phi} = \\omega^2 M\\boldsymbol{\\phi}\n$$\nThe fixed boundary conditions $u(0)=0$ and $u(L)=0$ mean that the first and last nodal displacements are zero. We enforce this by removing the first and last rows and columns from $K$ and $M$, creating the reduced system $K_{red}\\boldsymbol{\\phi}_{red} = \\omega^2 M_{red}\\boldsymbol{\\phi}_{red}$ of size $(N_e-1) \\times (N_e-1)$ for the internal nodes.\n\nSolving this reduced eigenvalue problem yields $N_e-1$ pairs of eigenvalues $(\\omega_n^{\\mathrm{fem}})^2$ and eigenvectors $\\boldsymbol{\\phi}_{n,red}^{\\mathrm{fem}}$. The full mode shape vector $\\boldsymbol{\\phi}_n^{\\mathrm{fem}}$ is reconstructed by padding the reduced eigenvector with zeros at the boundaries. This full vector is then normalized by its Euclidean norm.\n\n**3. Error Computation**\n\nFor each test case $(N_e, n)$, we compute the two specified metrics:\n- **Relative Frequency Error**: The relative error between the $n$-th FEM eigenfrequency and the $n$-th exact eigenfrequency.\n$$\ne_f = \\frac{|\\omega_n^{\\mathrm{fem}} - \\omega_n^{\\mathrm{exact}}|}{\\omega_n^{\\mathrm{exact}}}\n$$\n- **Maximum Nodal Mode Shape Error**: First, we must align the sign of the numerically computed eigenvector. An eigenvector $\\boldsymbol{\\phi}$ and its negative $-\\boldsymbol{\\phi}$ are mathematically equivalent. We ensure a consistent comparison by multiplying $\\boldsymbol{\\phi}_n^{\\mathrm{fem}}$ by $\\text{sign}(\\boldsymbol{\\phi}_n^{\\mathrm{fem}} \\cdot \\boldsymbol{\\phi}_n^{\\mathrm{exact}})$, where $\\boldsymbol{\\phi}_n^{\\mathrm{exact}}$ is the vector of sampled exact mode shape values. After alignment, the error is the maximum absolute difference between the components of the normalized FEM and normalized exact mode vectors.\n$$\ne_s = \\max_i |\\phi_{n,i}^{\\mathrm{fem}} - \\phi_{n,i}^{\\mathrm{exact}}|\n$$\nThis procedure provides a rigorous quantification of the accuracy of the finite element model for both frequency and mode shape prediction. Higher-order modes and coarser meshes are expected to yield larger errors.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves for the eigenfrequencies and eigenmodes of a taut string using both an\n    analytical continuous model and a discrete finite element model, and computes\n    the error between them for specified test cases.\n    \"\"\"\n    # Physical parameters\n    L = 1.0  # m\n    T = 100.0  # N\n    MU = 0.01  # kg/m\n\n    # Test suite: (Number of elements Ne, Mode index n)\n    test_cases = [\n        (2, 1),\n        (4, 1),\n        (8, 2),\n        (16, 3),\n        (8, 7),\n    ]\n\n    all_results = []\n\n    for Ne, n_mode in test_cases:\n        # --- 1. Exact Analytical Solution ---\n        # Exact angular eigenfrequency\n        omega_exact = (n_mode * np.pi / L) * np.sqrt(T / MU)\n\n        # Nodal coordinates for a mesh with Ne elements\n        num_nodes = Ne + 1\n        nodes = np.linspace(0, L, num_nodes)\n\n        # Sample the exact mode shape at the nodes\n        phi_exact_sampled = np.sin(n_mode * np.pi * nodes / L)\n        \n        # Normalize the sampled exact mode shape vector by its Euclidean norm\n        norm_exact = np.linalg.norm(phi_exact_sampled)\n        # Avoid division by zero if the mode shape is accidentally all zeros\n        phi_exact_normalized = phi_exact_sampled / norm_exact if norm_exact > 0 else phi_exact_sampled\n\n        # --- 2. Finite Element Method (FEM) Solution ---\n        h = L / Ne  # Element length\n\n        # Element stiffness matrix k^e\n        k_e = (T / h) * np.array([[1, -1], [-1, 1]])\n\n        # Element consistent mass matrix m^e\n        m_e = (MU * h / 6.0) * np.array([[2, 1], [1, 2]])\n\n        # Assemble global matrices K and M\n        K_global = np.zeros((num_nodes, num_nodes))\n        M_global = np.zeros((num_nodes, num_nodes))\n\n        for i in range(Ne):\n            # Assembly indices for the two nodes of element i\n            idx = np.array([i, i + 1])\n            K_global[np.ix_(idx, idx)] += k_e\n            M_global[np.ix_(idx, idx)] += m_e\n\n        # Apply fixed-fixed boundary conditions by reducing the system\n        # (remove first and last rows/columns, corresponding to nodes 0 and Ne)\n        internal_dofs = slice(1, Ne)\n        K_red = K_global[internal_dofs, internal_dofs]\n        M_red = M_global[internal_dofs, internal_dofs]\n\n        # Solve the generalized eigenvalue problem: K_red * v = lambda * M_red * v\n        # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n        # The number of internal DoFs is Ne - 1.\n        # This will fail if n_mode > Ne - 1, as the model cannot capture that mode.\n        if n_mode > Ne - 1:\n            # This case is physically not representable by the mesh,\n            # though the problem setup avoids this.\n            all_results.append([np.inf, np.inf])\n            continue\n            \n        eigenvalues, eigenvectors = eigh(K_red, M_red)\n\n        # The n-th eigenvalue (_lambda) corresponds to omega^2\n        # Use (n_mode - 1) for 0-based indexing\n        _lambda = eigenvalues[n_mode - 1]\n        omega_fem = np.sqrt(_lambda)\n\n        # Get the corresponding eigenvector for the reduced system\n        phi_fem_red = eigenvectors[:, n_mode - 1]\n\n        # Reconstruct the full mode shape vector including boundary nodes\n        phi_fem_full = np.zeros(num_nodes)\n        phi_fem_full[internal_dofs] = phi_fem_red\n        \n        # Normalize the full FEM mode shape vector by its Euclidean norm\n        norm_fem = np.linalg.norm(phi_fem_full)\n        phi_fem_normalized = phi_fem_full / norm_fem if norm_fem > 0 else phi_fem_full\n\n        # --- 3. Comparison and Error Calculation ---\n\n        # Align sign of FEM eigenvector to match the exact one\n        if np.dot(phi_fem_normalized, phi_exact_normalized)  0:\n            phi_fem_normalized *= -1.0\n\n        # Relative angular frequency error\n        freq_rel_error = np.abs(omega_fem - omega_exact) / omega_exact\n\n        # Maximum absolute nodal mode shape error\n        mode_shape_max_error = np.max(np.abs(phi_fem_normalized - phi_exact_normalized))\n\n        all_results.append([freq_rel_error, mode_shape_max_error])\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join([f\"[{e[0]},{e[1]}]\" for e in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2414089"}]}