{"hands_on_practices": [{"introduction": "The cornerstone of a successful Finite Element analysis is the correct mathematical formulation of the physical problem. This exercise challenges you to define the governing equations for a magnetostatic system with different materials and current sources. By selecting the right set of partial differential equations, you practice the essential first step of translating a real-world device into a solvable numerical model [@problem_id:1616428].", "problem": "An engineer is tasked with modeling the magnetic field distribution in a long electromagnetic actuator using the Finite Element Method (FEM). The actuator's cross-section in the $xy$-plane consists of three distinct regions: a central iron core ($\\Omega_{iron}$), a non-concentric cylindrical air gap within the core ($\\Omega_{air}$), and a copper coil region ($\\Omega_{coil}$) surrounding the core. The iron core is made of a soft magnetic material with a constant relative permeability $\\mu_r$, so its magnetic permeability is $\\mu_{iron} = \\mu_r \\mu_0$. The air gap and the copper coil region are assumed to have the permeability of free space, $\\mu_0$. The coil carries a steady, uniform Direct Current (DC) that creates an axial current density $\\mathbf{J} = J_z \\hat{\\mathbf{k}}$ within the region $\\Omega_{coil}$, and the current density is zero everywhere else.\n\nDue to the system's length, the problem can be treated as two-dimensional. The magnetic field is generated by the current $J_z$, and the appropriate potential to solve for is the $z$-component of the magnetic vector potential, $A_z(x, y)$. The entire actuator is computationally modeled inside a large bounding box, and on the outer boundary of this box, $\\Gamma_{box}$, the magnetic vector potential is assumed to be zero, i.e., $A_z = 0$.\n\nTo set up the simulation, the engineer must define the governing partial differential equation for $A_z$ in each of the three regions ($\\Omega_{iron}$, $\\Omega_{air}$, $\\Omega_{coil}$). Which of the following sets of equations correctly describes the physical problem to be solved by the FEM software?\n\nA. The problem is described by the Laplace equation in all regions:\n- In $\\Omega_{iron}$: $-\\nabla^2 A_z = 0$\n- In $\\Omega_{air}$: $-\\nabla^2 A_z = 0$\n- In $\\Omega_{coil}$: $-\\nabla^2 A_z = 0$\n\nB. The problem is described by a Poisson equation where the source term $J_z$ is present in all regions:\n- In $\\Omega_{iron}$: $-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = J_z$\n- In $\\Omega_{air}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n- In $\\Omega_{coil}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nC. The problem is described by a set of equations where the source term $J_z$ is non-zero only in the coil region:\n- In $\\Omega_{iron}$: $-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = 0$\n- In $\\Omega_{air}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = 0$\n- In $\\Omega_{coil}$: $-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nD. The problem is described by an incorrect formulation that improperly uses permeability instead of reluctivity:\n- In $\\Omega_{iron}$: $-\\nabla \\cdot (\\mu_{iron} \\nabla A_z) = 0$\n- In $\\Omega_{air}$: $-\\nabla \\cdot (\\mu_0 \\nabla A_z) = 0$\n- In $\\Omega_{coil}$: $-\\nabla \\cdot (\\mu_0 \\nabla A_z) = J_z$\n\nE. The problem is described by a single form of the Poisson equation, $-\\nabla^2 A_z = \\mu J_z$, applied to all regions:\n- In $\\Omega_{iron}$: $-\\nabla^2 A_z = \\mu_{iron} J_z$\n- In $\\Omega_{air}$: $-\\nabla^2 A_z = \\mu_0 J_z$\n- In $\\Omega_{coil}$: $-\\nabla^2 A_z = \\mu_0 J_z$", "solution": "We work in magnetostatics and use Maxwell’s equations with the magnetic vector potential. The governing equations are\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\mathbf{B} = \\mu \\mathbf{H}, \\quad \\mathbf{B} = \\nabla \\times \\mathbf{A}.\n$$\nChoosing the magnetic vector potential with only a nonzero axial component in a two-dimensional setting, we set $\\mathbf{A} = A_{z}(x,y)\\,\\hat{\\mathbf{k}}$. Then\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A} = \\left(\\frac{\\partial A_{z}}{\\partial y}\\right)\\hat{\\mathbf{i}} - \\left(\\frac{\\partial A_{z}}{\\partial x}\\right)\\hat{\\mathbf{j}} + 0\\,\\hat{\\mathbf{k}}.\n$$\nUsing the constitutive relation $\\mathbf{H} = \\frac{1}{\\mu}\\mathbf{B}$ (with scalar, piecewise constant $\\mu$), we have\n$$\nH_{x} = \\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}, \\quad H_{y} = -\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}.\n$$\nAmpere’s law gives the source equation for the $z$-component:\n$$\nJ_{z} = \\left(\\nabla \\times \\mathbf{H}\\right)_{z} = \\frac{\\partial H_{y}}{\\partial x} - \\frac{\\partial H_{x}}{\\partial y}.\n$$\nSubstituting $H_{x}$ and $H_{y}$,\n$$\nJ_{z} = \\frac{\\partial}{\\partial x}\\left(-\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right)\n= -\\frac{\\partial}{\\partial x}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right).\n$$\nThis is compactly written as\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu}\\nabla A_{z}\\right) = J_{z}.\n$$\nBoundary condition on the outer boundary is $A_{z} = 0$ on $\\Gamma_{box}$.\n\nThe material properties are piecewise constant:\n$$\n\\mu = \\mu_{iron} = \\mu_{r}\\mu_{0} \\text{ in } \\Omega_{iron}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{air}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{coil}.\n$$\nThe source current density is axial and confined to the coil:\n$$\nJ_{z} \\neq 0 \\text{ in } \\Omega_{coil}, \\quad J_{z} = 0 \\text{ in } \\Omega_{iron} \\cup \\Omega_{air}.\n$$\nTherefore, the governing PDE in each region is\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{iron}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{iron},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{air},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = J_{z} \\quad \\text{in } \\Omega_{coil}.\n$$\nThis matches option C. Option A omits the source in the coil. Option B incorrectly applies the source in all regions. Option D incorrectly uses $\\mu$ instead of $1/\\mu$ in the differential operator. Option E uses $-\\nabla^{2}A_{z}=\\mu J_{z}$; while equivalent within a single homogeneous region with constant $\\mu$, it is not the correct heterogeneous formulation needed across multiple regions with different $\\mu$, and it also misleadingly presents a source term in regions where $J_{z}=0$ must be enforced explicitly. Hence the correct formulation is option C.", "answer": "$$\\boxed{C}$$", "id": "1616428"}, {"introduction": "Once the governing equation is set, FEM breaks the problem down into small pieces, or 'elements', and builds a matrix for each one. This practice takes you into the engine room of FEM, asking you to compute a specific term in an element matrix for an AC problem involving eddy currents. This calculation reveals how physical properties like permeability $\\mu$ and conductivity $\\sigma$, along with angular frequency $\\omega$, are integrated at the most fundamental level of the simulation [@problem_id:1616444].", "problem": "In the numerical modeling of eddy currents in conductors using the Finite Element Method (FEM), a key computational task is to evaluate coupling integrals over small, discrete triangular elements that mesh the conductor's cross-section. These integrals form the entries of an element's characteristic matrix.\n\nConsider one such linear triangular element, defined by three nodes at vertices with coordinates: Node 1 at $(0, 0)$, Node 2 at $(h, 0)$, and Node 3 at $(0, a)$. A physical quantity within this element is approximated using linear basis functions (also known as shape functions) $N_1(x,y)$, $N_2(x,y)$, and $N_3(x,y)$. The basis function $N_i(x,y)$ has a value of 1 at Node $i$ and 0 at the other two nodes.\n\nYour task is to compute the complex-valued coupling integral $Z_{12}$ between basis functions $N_1$ and $N_2$ for this element. The integral is defined as:\n$$ Z_{12} = \\int_{\\text{element}} \\left( \\frac{1}{\\mu} (\\nabla N_1 \\cdot \\nabla N_2) + j\\omega\\sigma (N_1 N_2) \\right) dA $$\nwhere $\\mu$ is the magnetic permeability, $\\sigma$ is the electrical conductivity, $\\omega$ is the angular frequency, $j = \\sqrt{-1}$, and the integration is over the area of the triangular element.\n\nCalculate the numerical value of $Z_{12}$ using the following parameters for a non-magnetic copper conductor:\n- Element dimensions: $h = 1.000$ mm, $a = 2.000$ mm\n- Electrical conductivity: $\\sigma = 5.800 \\times 10^7$ S/m\n- Magnetic permeability: $\\mu = 4\\pi \\times 10^{-7}$ H/m\n- Operating frequency: $f = 60.00$ Hz\n\nYour answer should be given as a row matrix containing the real and imaginary parts of $Z_{12}$, in the form $[\\text{Re}(Z_{12}) \\quad \\text{Im}(Z_{12})]$. The values must be expressed in the SI unit of $m \\cdot \\Omega^{-1} \\cdot s^{-1}$ and rounded to four significant figures. Do not include the units in your final answer.", "solution": "We model the linear triangular element with nodes at $(0,0)$, $(h,0)$, and $(0,a)$ using linear shape functions that satisfy $N_{i}=1$ at node $i$ and $0$ at the others. For this right triangle,\n$$\nN_{1}(x,y)=1-\\frac{x}{h}-\\frac{y}{a},\\quad N_{2}(x,y)=\\frac{x}{h},\\quad N_{3}(x,y)=\\frac{y}{a}.\n$$\nTheir gradients (constant over the element) are\n$$\n\\nabla N_{1}=\\left(-\\frac{1}{h},-\\frac{1}{a}\\right),\\quad \\nabla N_{2}=\\left(\\frac{1}{h},0\\right),\\quad \\nabla N_{3}=\\left(0,\\frac{1}{a}\\right).\n$$\nHence,\n$$\n\\nabla N_{1}\\cdot \\nabla N_{2}=-\\frac{1}{h^{2}}.\n$$\nThe element area is $A=\\frac{1}{2}ah$. The coupling integral is\n$$\nZ_{12}=\\int_{\\text{element}}\\left(\\frac{1}{\\mu}\\,\\nabla N_{1}\\cdot \\nabla N_{2}+j\\omega\\sigma\\,N_{1}N_{2}\\right)\\,dA\n=\\frac{1}{\\mu}\\left(\\nabla N_{1}\\cdot \\nabla N_{2}\\right)A+j\\omega\\sigma\\int_{\\text{element}}N_{1}N_{2}\\,dA.\n$$\nFor linear triangles, the consistent mass entry satisfies $\\int_{\\text{element}}N_{1}N_{2}\\,dA=\\frac{A}{12}$. We can also verify by direct integration:\n$$\n\\int_{\\text{element}}N_{1}N_{2}\\,dA=\\int_{0}^{h}\\int_{0}^{a(1-x/h)}\\left(\\frac{x}{h}\\right)\\left(1-\\frac{x}{h}-\\frac{y}{a}\\right)\\,dy\\,dx\n=\\frac{ah}{24}=\\frac{A}{12}.\n$$\nTherefore,\n$$\nZ_{12}=-\\frac{A}{\\mu h^{2}}+j\\,\\omega\\sigma\\,\\frac{A}{12}\n=-\\frac{a}{2\\mu h}+j\\,\\omega\\sigma\\,\\frac{ah}{24}.\n$$\nInsert the given parameters, converting to SI units: $h=1.000\\times 10^{-3}\\,\\text{m}$, $a=2.000\\times 10^{-3}\\,\\text{m}$, $\\sigma=5.800\\times 10^{7}\\,\\text{S/m}$, $\\mu=4\\pi\\times 10^{-7}\\,\\text{H/m}$, and $\\omega=2\\pi f=2\\pi\\times 60.00=120\\pi\\,\\text{s}^{-1}$. Compute the real part:\n$$\n\\operatorname{Re}(Z_{12})=-\\frac{a}{2\\mu h}=-\\frac{2.000\\times 10^{-3}}{2\\,(4\\pi\\times 10^{-7})\\,(1.000\\times 10^{-3})}=-\\frac{1}{4\\pi\\times 10^{-7}}.\n$$\nThus $\\operatorname{Re}(Z_{12})=-\\frac{10^{7}}{4\\pi}\\approx -7.957747\\times 10^{5}$.\n\nCompute the imaginary part:\n$$\n\\operatorname{Im}(Z_{12})=\\omega\\sigma\\,\\frac{ah}{24}=\\frac{2\\pi f\\,\\sigma\\,ah}{24}=\\frac{\\pi f\\,\\sigma\\,ah}{12}.\n$$\nWith $f=60.00$, this simplifies to\n$$\n\\operatorname{Im}(Z_{12})=5\\pi\\,\\sigma\\,a h=5\\pi\\,(5.800\\times 10^{7})\\,(2.000\\times 10^{-3})(1.000\\times 10^{-3})=5\\pi\\,(116)=580\\pi\\approx 1.822\\times 10^{3}.\n$$\nBoth parts have units $\\,\\text{m}\\cdot\\Omega^{-1}\\cdot\\text{s}^{-1}$, as required. Rounding to four significant figures gives\n$$\n\\operatorname{Re}(Z_{12})\\approx -7.958\\times 10^{5},\\quad \\operatorname{Im}(Z_{12})\\approx 1.822\\times 10^{3}.\n$$\nThus the requested row matrix is as follows.", "answer": "$$\\boxed{\\begin{bmatrix}-7.958 \\times 10^{5} & 1.822 \\times 10^{3}\\end{bmatrix}}$$", "id": "1616444"}, {"introduction": "FEM is more than just an engineering tool; it can provide deep insights into fundamental physics. This problem explores the non-intuitive nature of the magnetic vector potential $\\mathbf{A}$ in a region where the magnetic field $\\mathbf{B}$ is zero—a scenario conceptually related to the Aharonov-Bohm effect. By numerically calculating the circulation of the vector potential, you can verify its connection to an enclosed magnetic flux and appreciate how FEM handles problems with non-trivial topology [@problem_id:1616410].", "problem": "Consider an idealized, infinitely long solenoid aligned with the $z$-axis, with a radius $R$. It carries a steady current that produces a uniform magnetic field $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$ for radial distances $\\rho \\le R$ and a null magnetic field, $\\mathbf{B} = \\mathbf{0}$, for $\\rho > R$. The total magnetic flux confined within the solenoid is denoted by $\\Phi_B$.\n\nIn the exterior region ($\\rho > R$), although the magnetic field is zero, the magnetic vector potential $\\mathbf{A}$ is non-zero and non-trivial due to the topologically non-simply connected nature of the space. A numerical simulation using the Finite Element Method (FEM) is performed to solve for the vector potential $\\mathbf{A}$ in the $xy$-plane for the region exterior to the solenoid. The simulation outputs the values of $\\mathbf{A}$ at a series of discrete points (nodes). These nodes are located at the vertices of a regular $N$-sided polygon, centered at the origin, with all vertices lying on a circle of radius $r_p > R$.\n\nYour task is to compute the numerical approximation for the circulation of the vector potential, $\\oint \\mathbf{A} \\cdot d\\mathbf{l}$, along the perimeter of this $N$-sided polygon. The calculation must be performed by summing the contributions from each of the $N$ straight line segments that form the polygon. For each segment, the vector potential $\\mathbf{A}$ should be approximated by a linear interpolation between its known values at the two vertices that define the segment.\n\nDetermine a closed-form expression for this numerically approximated circulation in terms of the total magnetic flux $\\Phi_B$ and the number of polygon sides $N$.", "solution": "Because $\\mathbf{B}=\\mathbf{0}$ for $\\rho>R$ and the region is multiply connected, a suitable gauge choice for the exterior vector potential that captures the enclosed flux $\\Phi_{B}$ is the azimuthally symmetric form\n$$\n\\mathbf{A}(\\rho)=\\frac{\\Phi_{B}}{2\\pi \\rho}\\,\\hat{\\boldsymbol{\\phi}},\n$$\nwhich satisfies $\\nabla\\times\\mathbf{A}=\\mathbf{0}$ for $\\rho>R$ and yields $\\oint \\mathbf{A}\\cdot d\\mathbf{l}=\\Phi_{B}$ for any circle of radius $\\rho>R$ by Stokes’ theorem.\n\nLet the $N$ vertices of the regular polygon of radius $r_{p}>R$ lie at angles $\\theta_{k}=\\frac{2\\pi k}{N}$ with position vectors $\\mathbf{r}_{k}=r_{p}\\,\\hat{\\boldsymbol{\\rho}}_{k}$, for $k=0,1,\\dots,N-1$. At each vertex,\n$$\n\\mathbf{A}_{k}=\\mathbf{A}(\\mathbf{r}_{k})=\\frac{\\Phi_{B}}{2\\pi r_{p}}\\,\\hat{\\boldsymbol{\\phi}}_{k}\\equiv A_{0}\\,\\hat{\\boldsymbol{\\phi}}_{k},\n$$\nwhere $A_{0}=\\frac{\\Phi_{B}}{2\\pi r_{p}}$.\n\nConsider the edge from vertex $k$ to $k+1$. The chord vector is\n$$\n\\mathbf{d}_{k}=\\mathbf{r}_{k+1}-\\mathbf{r}_{k}=2r_{p}\\sin\\!\\left(\\frac{\\pi}{N}\\right)\\hat{\\boldsymbol{\\phi}}_{\\text{mid}},\n$$\nwhere $\\hat{\\boldsymbol{\\phi}}_{\\text{mid}}=\\hat{\\boldsymbol{\\phi}}(\\theta_{\\text{mid}})$ with $\\theta_{\\text{mid}}=\\frac{\\theta_{k}+\\theta_{k+1}}{2}$. Hence, the edge length and unit tangent are\n$$\nL_{k}=|\\mathbf{d}_{k}|=2r_{p}\\sin\\!\\left(\\frac{\\pi}{N}\\right),\\qquad \\hat{\\mathbf{t}}_{k}=\\hat{\\boldsymbol{\\phi}}_{\\text{mid}}.\n$$\n\nApproximating $\\mathbf{A}$ linearly along the edge by\n$$\n\\mathbf{A}^{(\\text{lin})}(s)=(1-s)\\mathbf{A}_{k}+s\\,\\mathbf{A}_{k+1},\\qquad s\\in[0,1],\n$$\nthe contribution of this edge to the circulation is\n$$\nI_{k}\\approx \\int_{0}^{1}\\mathbf{A}^{(\\text{lin})}(s)\\cdot \\hat{\\mathbf{t}}_{k}\\,L_{k}\\,ds\n=L_{k}\\,\\hat{\\mathbf{t}}_{k}\\cdot \\frac{\\mathbf{A}_{k}+\\mathbf{A}_{k+1}}{2}.\n$$\nUsing $\\hat{\\boldsymbol{\\phi}}_{\\alpha}\\cdot \\hat{\\boldsymbol{\\phi}}_{\\beta}=\\cos(\\alpha-\\beta)$, we get\n$$\n\\hat{\\mathbf{t}}_{k}\\cdot \\mathbf{A}_{k}=A_{0}\\cos(\\theta_{k}-\\theta_{\\text{mid}})=A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right),\n$$\n$$\n\\hat{\\mathbf{t}}_{k}\\cdot \\mathbf{A}_{k+1}=A_{0}\\cos(\\theta_{k+1}-\\theta_{\\text{mid}})=A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right),\n$$\nso\n$$\nI_{k}=L_{k}\\,A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right)=2r_{p}\\sin\\!\\left(\\frac{\\pi}{N}\\right)A_{0}\\cos\\!\\left(\\frac{\\pi}{N}\\right)\n=r_{p}A_{0}\\sin\\!\\left(\\frac{2\\pi}{N}\\right).\n$$\nSumming over all $N$ edges,\n$$\n\\sum_{k=0}^{N-1} I_{k}=N\\,r_{p}A_{0}\\sin\\!\\left(\\frac{2\\pi}{N}\\right).\n$$\nSubstituting $A_{0}=\\frac{\\Phi_{B}}{2\\pi r_{p}}$ yields the closed-form expression\n$$\n\\sum_{k=0}^{N-1} I_{k}=\\frac{N}{2\\pi}\\,\\Phi_{B}\\,\\sin\\!\\left(\\frac{2\\pi}{N}\\right).\n$$\nThis converges to $\\Phi_{B}$ as $N\\to\\infty$, consistent with the exact circulation.", "answer": "$$\\boxed{\\frac{N}{2\\pi}\\,\\Phi_{B}\\,\\sin\\!\\left(\\frac{2\\pi}{N}\\right)}$$", "id": "1616410"}]}