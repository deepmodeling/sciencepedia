{"hands_on_practices": [{"introduction": "The Hohenberg-Kohn variational principle is a cornerstone of Density Functional Theory, stating that the energy calculated from any trial density $n(\\vec{r})$ provides an upper bound to the true ground-state energy $E_0$. This exercise presents a thought-provoking paradox to deepen your grasp of this fundamental theorem. By analyzing a hypothetical scenario that appears to violate this rule [@problem_id:1407256], you will uncover the crucial and often subtle precondition of \"N-representability,\" which governs what constitutes a physically valid electron density.", "problem": "An undergraduate student is exploring the foundations of Density Functional Theory (DFT). They decide to test the Hohenberg-Kohn (HK) variational principle on the simplest possible system: a single, non-relativistic hydrogen atom.\n\nThe external potential for the hydrogen atom is given by $v_{ext}(\\vec{r}) = -1/r$ in atomic units. The exact ground-state energy is known to be $E_0 = -0.5$ Hartrees. For a one-electron system, the total energy can be expressed as an exact functional of the electron density $n(\\vec{r})$:\n$$E[n] = T_s[n] + \\int v_{ext}(\\vec{r}) n(\\vec{r}) d^3\\vec{r}$$\nwhere $T_s[n]$ is the kinetic energy functional for a single non-interacting electron with density $n(\\vec{r})$.\n\nThe student performs two calculations using two different trial electron densities, $n_A(\\vec{r})$ and $n_B(\\vec{r})$.\n1.  Using the trial density $n_A(\\vec{r})$, the calculated energy is $E[n_A] = -0.46$ Hartrees.\n2.  Using the trial density $n_B(\\vec{r})$, the calculated energy is $E[n_B] = -0.53$ Hartrees.\n\nThe second result, where $E[n_B] < E_0$, appears to be a direct violation of the second Hohenberg-Kohn theorem (the variational principle), which states that any valid trial density must yield an energy greater than or equal to the true ground-state energy. Assuming the kinetic energy functional $T_s[n]$ was evaluated exactly and all numerical integrations were performed without error, what is the most fundamental theoretical reason for this paradoxical result?\n\nA. The Hohenberg-Kohn theorems are derived for many-electron systems and are known to fail for the special case of a one-electron system like hydrogen.\n\nB. The variational principle in DFT is only an approximation itself and does not guarantee a lower bound for the energy.\n\nC. The result must be due to the use of an approximate kinetic energy functional $T_s[n]$, as the exact form of this functional is unknown even for a single electron.\n\nD. The trial density $n_B(\\vec{r})$ is not a physically valid density for a one-electron system (i.e., it is not \"N-representable\"), thereby violating a crucial precondition for the variational principle to apply.\n\nE. Calculation B has uncovered a more stable electronic state for the hydrogen atom than was previously known, indicating that $E_0 = -0.5$ Hartrees is not the true ground state.", "solution": "We begin from the exact Hohenberg-Kohn variational formulation in the Levy-Lieb constrained-search form. For a given external potential $v(\\vec r)$ and particle number $N$, define the universal functional\n$$\nF[n] = \\min_{\\Psi \\to n} \\langle \\Psi | \\hat T + \\hat V_{ee} | \\Psi \\rangle,\n$$\nwhere the minimization is over all antisymmetric $N$-electron wavefunctions $\\Psi$ yielding the density $n(\\vec r)$. For any density $n$ that is $N$-representable (i.e., comes from at least one such $\\Psi$), the DFT energy functional is\n$$\nE_{v}[n] = F[n] + \\int v(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r.\n$$\nLet $\\Psi_{n}$ be a wavefunction that attains (or arbitrarily approaches) the minimum in the definition of $F[n]$. Then\n$$\nE_{v}[n] = \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} | \\Psi_{n} \\rangle + \\int v \\, n\n= \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} + \\hat V | \\Psi_{n} \\rangle \\ge E_{0},\n$$\nwhere $E_{0}$ is the exact ground-state energy and the inequality follows from the Rayleigh-Ritz principle. Hence, for every $N$-representable density $n$, one has\n$$\nE_{v}[n] \\ge E_{0}.\n$$\n\nSpecializing to a one-electron system, $\\hat V_{ee} = 0$ and\n$$\nF[n] = T_{s}[n] = \\min_{\\psi \\to n} \\langle \\psi | \\hat T | \\psi \\rangle = T_{W}[n],\n$$\nwith the exact Weizsäcker functional\n$$\nT_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\vec r)|^{2}}{n(\\vec r)} \\, d^{3}\\vec r,\n$$\nprovided $n$ is $N$-representable and sufficiently regular so that $\\sqrt{n} \\in H^{1}(\\mathbb{R}^{3})$ (ensuring finite kinetic energy). Therefore, for any physically valid one-electron density $n$,\n$$\nE[n] = T_{s}[n] + \\int v_{ext}(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r \\ge E_{0}.\n$$\n\nIn the problem, $E[n_{B}] < E_{0}$ is obtained while assuming $T_{s}[n]$ is evaluated exactly and integrations are exact. The inequality above shows that such a result cannot occur for any $N$-representable one-electron density. Thus, the only remaining logical possibility is that $n_{B}$ is not a physically admissible one-electron density (fails $N$-representability or, equivalently for the HK variational bound via constrained search, lies outside the domain of $F[n]$). Typical violations include lack of nonnegativity, incorrect normalization to $N=1$, or insufficient regularity such that no wavefunction $\\psi$ with $|\\psi|^{2} = n_{B}$ and finite kinetic energy exists.\n\nEvaluating the options:\n- A is false: the HK theorems apply to any $N$, and for $N=1$ the functional is exactly known.\n- B is false: the DFT variational principle is rigorous for the constrained-search functional on its domain.\n- C is false: for $N=1$, $T_{s}[n]$ is exactly $T_{W}[n]$.\n- D is correct: the paradox arises because $n_{B}$ is not $N$-representable, invalidating the variational bound.\n- E is false: $E_{0}$ for hydrogen is exactly known and cannot be undercut by a physical density.\n\nTherefore, the fundamental theoretical reason is that the trial density $n_{B}$ is not $N$-representable.", "answer": "$$\\boxed{D}$$", "id": "1407256"}, {"introduction": "Within the Kohn-Sham framework, the total energy is partitioned into distinct components, including kinetic energy, electron-nucleus attraction, the classical Hartree repulsion $E_H[n]$, and the quantum mechanical exchange-correlation energy $E_{xc}[n]$. This practice uses the simplest possible quantum system—a single electron—to reveal a fundamental principle about electron self-interaction. You will investigate why, for an exact theory, the unphysical interaction of an electron with itself must be perfectly cancelled [@problem_id:1999035], a concept that is critical for understanding the limitations of many practical approximations.", "problem": "In the Kohn-Sham formulation of Density Functional Theory (DFT), the total electronic energy $E[n]$ for a system with electron density $n(\\vec{r})$ is expressed as a sum of four components:\n$$E[n] = T_s[n] + E_{ext}[n] + E_H[n] + E_{xc}[n]$$\nHere, $T_s[n]$ is the kinetic energy of a reference system of non-interacting electrons, $E_{ext}[n]$ is the potential energy of the electrons in the external field of the atomic nuclei, and $E_H[n]$ is the Hartree energy. The Hartree energy represents the classical electrostatic Coulomb repulsion of the electron density with itself. The final term, $E_{xc}[n]$, is the exchange-correlation energy, which accounts for all the quantum mechanical effects not included in the other terms. For our purposes, we can consider $E_{xc}[n] = E_x[n] + E_c[n]$, where $E_x[n]$ is the exchange energy and $E_c[n]$ is the correlation energy.\n\nA student is using a computational chemistry package with a hypothetically exact exchange-correlation functional to study the electronic structure of an isolated hydrogen atom. A hydrogen atom consists of a single proton and a single electron. Upon analyzing the energy components from the calculation, the student observes that the sum of the Hartree energy and the exchange energy is precisely zero: $E_H[n] + E_x[n] = 0$.\n\nWhich of the following statements provides the correct physical explanation for this exact cancellation?\n\nA. The Hartree energy for a single electron is an unphysical self-interaction energy, and the definition of the exact exchange energy requires it to precisely cancel this artifact.\n\nB. The correlation energy, which describes how electrons avoid each other, is zero for a one-electron system, and as a consequence, the exchange energy must be equal and opposite to the Hartree energy to conserve total energy.\n\nC. For any one-electron system, the Kohn-Sham kinetic energy $T_s[n]$ is identical to the true kinetic energy, a condition which forces the sum of the Hartree and exchange energies to be zero.\n\nD. The system has perfect spherical symmetry, which mathematically constrains the spherically averaged electrostatic repulsion and the corresponding exchange correction to be equal and opposite.\n\nE. The exchange energy represents the classical repulsion of the electron with itself, while the Hartree energy is a purely quantum mechanical correction term; for a single electron, these two effects are equal in magnitude and opposite in sign.", "solution": "In Kohn-Sham DFT the electron-electron interaction energy is represented as the sum $E_{H}[n] + E_{xc}[n]$. For a one-electron system, the exact expectation value of the true electron-electron interaction operator,\n$$\n\\hat{V}_{ee} = \\frac{1}{2}\\sum_{i\\neq j}\\frac{1}{|\\mathbf{r}_{i}-\\mathbf{r}_{j}|},\n$$\nis identically zero because there are no electron pairs. Therefore, for the exact functional one must have\n$$\nE_{H}[n] + E_{xc}[n] = 0 \\quad \\text{for any one-electron density } n.\n$$\nThe Hartree energy is the classical self-Coulomb energy of the density,\n$$\nE_{H}[n] = \\frac{1}{2}\\iint \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\nFor a single electron with Kohn-Sham orbital $\\phi(\\mathbf{r})$ and density $n(\\mathbf{r}) = |\\phi(\\mathbf{r})|^{2}$, the exact exchange energy (the exchange energy of a single Slater determinant) is\n$$\nE_{x} = -\\frac{1}{2}\\sum_{\\sigma}\\sum_{i,j}\\iint \\frac{\\phi_{i\\sigma}^{*}(\\mathbf{r})\\phi_{j\\sigma}(\\mathbf{r})\\,\\phi_{j\\sigma}^{*}(\\mathbf{r}')\\phi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\nWith only one occupied orbital (say, $i=j=1$ and a single spin channel), this reduces to\n$$\nE_{x} = -\\frac{1}{2}\\iint \\frac{|\\phi(\\mathbf{r})|^{2}\\,|\\phi(\\mathbf{r}')|^{2}}{|\\mathbf{r}-\\mathbf{r}'|}\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}' = -E_{H}[n].\n$$\nHence, the Hartree self-interaction energy is exactly canceled by the exchange energy in a one-electron system:\n$$\nE_{H}[n] + E_{x}[n] = 0.\n$$\nFor completeness, in a one-electron system the correlation energy vanishes, $E_{c}[n]=0$, and the Kohn-Sham kinetic energy equals the true kinetic energy. However, neither of these facts is the mechanism that enforces the cancellation; rather, the cancellation arises because $E_{H}[n]$ is an unphysical self-interaction for one electron and exact exchange is defined to remove this self-interaction exactly.\n\nEvaluating the options:\n- A correctly states that $E_{H}[n]$ is an unphysical self-interaction for one electron and exact exchange cancels it.\n- B notes $E_{c}[n]=0$ (true) but incorrectly assigns the cause of the cancellation to this fact; the cancellation follows from self-interaction removal by exchange.\n- C and D do not enforce $E_{H}+E_{x}=0$.\n- E reverses the physical roles of Hartree and exchange.\n\nTherefore, A is correct.", "answer": "$$\\boxed{A}$$", "id": "1999035"}, {"introduction": "A practical DFT calculation yields two key sets of energy values: the total electronic energy $E[\\rho]$ and the set of Kohn-Sham orbital energies, $\\epsilon_i$. A frequent point of confusion is that the sum of these orbital energies for all occupied states does not equal the total energy of the system. This final practice directly addresses this important distinction [@problem_id:1999063], guiding you to deconstruct the energy expressions to see precisely how the sum of eigenvalues double-counts electron-electron repulsion, thereby solidifying your understanding of how to interpret real computational results.", "problem": "In the framework of Kohn-Sham (KS) Density Functional Theory (DFT), the total electronic energy of a ground-state N-electron system is given by the functional:\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\nHere, $T_s[\\rho]$ is the kinetic energy of a non-interacting reference system with the same density $\\rho$, $E_{ext}[\\rho]$ is the potential energy from the external potential (usually from atomic nuclei), $E_H[\\rho]$ is the classical electron-electron Coulomb repulsion energy (the Hartree energy), and $E_{xc}[\\rho]$ is the exchange-correlation energy, which contains all the non-classical many-body effects.\n\nThe electron density $\\rho(\\mathbf{r})$ is constructed from a set of single-particle orbitals, $\\phi_i$, as $\\rho(\\mathbf{r}) = \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2$. These orbitals are solutions to the KS equations:\n$$ \\left( -\\frac{\\hbar^2}{2m} \\nabla^2 + v_{eff}(\\mathbf{r}) \\right) \\phi_i(\\mathbf{r}) = \\epsilon_i \\phi_i(\\mathbf{r}) $$\nwhere $\\epsilon_i$ are the KS eigenvalues (orbital energies).\n\nFor a neutral nitrogen atom (N, atomic number Z=7), a DFT calculation yields the following occupied KS eigenvalues:\n$\\epsilon_{1s} = -381.5$ eV\n$\\epsilon_{2s} = -18.6$ eV\n$\\epsilon_{2p_x} = \\epsilon_{2p_y} = \\epsilon_{2p_z} = -8.1$ eV\n\nThe same calculation gives a total electronic energy of $E[\\rho] = -1483.2$ eV. The sum of the occupied KS eigenvalues is $\\sum_{i}^{occ} \\epsilon_i = 2 \\times (-381.5) + 2 \\times (-18.6) + 3 \\times (-8.1) = -824.5$ eV. This sum is clearly not equal to the total electronic energy.\n\nWhich of the following statements provides the correct physical reason for this discrepancy?\n\nA. The sum of the eigenvalues is physically meaningless, and its difference from the total energy is a computational artifact of the specific exchange-correlation functional used.\n\nB. The sum of the eigenvalues fails to properly account for the electron-electron interactions; specifically, it double-counts the classical Hartree repulsion energy and incorrectly represents the exchange-correlation energy contribution.\n\nC. The sum of the eigenvalues represents only the potential energy of the electrons, and the discrepancy arises from the complete omission of the electronic kinetic energy.\n\nD. The sum of the eigenvalues accurately represents all electron-electron and kinetic energy contributions, but it completely omits the interaction energy between the electrons and the nucleus.\n\nE. The total energy calculation is flawed because, by the Hellmann-Feynman theorem, the total energy must be equal to the sum of the orbital energies for any self-consistent calculation.", "solution": "The core of this problem is to understand the relationship between the Kohn-Sham (KS) total energy, $E[\\rho]$, and the sum of the occupied KS eigenvalues, $\\sum_i^{occ} \\epsilon_i$.\n\nLet's start with the expression for the total electronic energy in KS-DFT:\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\nwhere $T_s$ is the non-interacting kinetic energy, $E_{ext}$ is the electron-nucleus attraction energy, $E_H$ is the classical electron-electron (Hartree) repulsion energy, and $E_{xc}$ is the exchange-correlation energy.\n\nNow, let's analyze the sum of the occupied eigenvalues. The KS eigenvalue $\\epsilon_i$ is obtained from the KS equation:\n$$H_{KS} \\phi_i = \\epsilon_i \\phi_i$$\nwhere $H_{KS}$ is the KS Hamiltonian. The eigenvalue $\\epsilon_i$ is the expectation value of the KS Hamiltonian with respect to the orbital $\\phi_i$:\n$$ \\epsilon_i = \\langle \\phi_i | H_{KS} | \\phi_i \\rangle $$\nThe KS Hamiltonian is defined as $H_{KS} = T_{op} + v_{eff}(\\mathbf{r})$, where $T_{op} = -\\frac{\\hbar^2}{2m} \\nabla^2$ is the kinetic energy operator and $v_{eff}$ is the effective potential. The effective potential is given by:\n$$ v_{eff}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r}) $$\nHere, $v_{ext}$ is the external potential, $v_H(\\mathbf{r}) = \\frac{\\delta E_H}{\\delta \\rho}$ is the Hartree potential, and $v_{xc}(\\mathbf{r}) = \\frac{\\delta E_{xc}}{\\delta \\rho}$ is the exchange-correlation potential.\n\nThe sum of the occupied eigenvalues is therefore:\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} + v_{ext} + v_H + v_{xc} | \\phi_i \\rangle $$\nWe can separate the terms:\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle $$\n\nLet's identify each of these summed terms with the components of the total energy functional:\n1.  $\\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle = T_s[\\rho]$, the non-interacting kinetic energy.\n2.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle = \\int \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2 v_{ext}(\\mathbf{r}) d\\mathbf{r} = \\int \\rho(\\mathbf{r}) v_{ext}(\\mathbf{r}) d\\mathbf{r} = E_{ext}[\\rho]$, the electron-nucleus attraction energy.\n3.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$. The Hartree energy functional is $E_H[\\rho] = \\frac{1}{2} \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$. This factor of $\\frac{1}{2}$ is crucial; it prevents double-counting the interaction between pairs of electrons. Therefore, the term in the eigenvalue sum is exactly twice the Hartree energy: $\\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r} = 2E_H[\\rho]$.\n4.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}$. This term is the expectation value of the exchange-correlation potential, which is generally not equal to the exchange-correlation energy functional, $E_{xc}[\\rho]$.\n\nSo, the sum of the eigenvalues is:\n$$ \\sum_{i=1}^{N} \\epsilon_i = T_s[\\rho] + E_{ext}[\\rho] + 2E_H[\\rho] + \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r} $$\n\nNow, we compare this to the total energy expression:\n$$ E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho] $$\n\nThe discrepancy arises from two terms related to electron-electron interactions:\n- The sum of eigenvalues contains $2E_H[\\rho]$, while the total energy contains $E_H[\\rho]$. The eigenvalue sum double-counts the classical Coulomb repulsion.\n- The sum of eigenvalues contains the term $\\int \\rho v_{xc} d\\mathbf{r}$, while the total energy contains the exchange-correlation energy $E_{xc}[\\rho]$. These are not the same.\n\nTherefore, the relationship between the total energy and the sum of eigenvalues is:\n$$ E[\\rho] = \\sum_{i=1}^{N} \\epsilon_i - E_H[\\rho] + (E_{xc}[\\rho] - \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}) $$\n\nThe sum of eigenvalues is not the total energy because it improperly accounts for electron-electron interactions. Let's evaluate the given options:\nA. Incorrect. The sum of eigenvalues has a physical meaning (related to the total energy via the equation above) and is not just a computational artifact.\nB. Correct. This statement accurately identifies that the sum of eigenvalues double-counts the Hartree energy and incorrectly treats the exchange-correlation energy contribution. This is the precise reason for the discrepancy.\nC. Incorrect. The sum of eigenvalues explicitly includes the kinetic energy term, $T_s[\\rho]$.\nD. Incorrect. The sum of eigenvalues explicitly includes the electron-nucleus interaction energy, $E_{ext}[\\rho]$.\nE. Incorrect. The Hellmann-Feynman theorem relates the derivative of the total energy to the expectation value of the derivative of the Hamiltonian, which is a different concept. There is no general theorem stating that the total energy must equal the sum of orbital energies in KS-DFT (this is only true for non-interacting particles or in Hartree-Fock theory where Koopmans' theorem provides a link, but even there the sum of orbital energies is not the total energy).", "answer": "$$\\boxed{B}$$", "id": "1999063"}]}