{"hands_on_practices": [{"introduction": "Every iterative process needs a starting point, and the Self-Consistent Field (SCF) method is no exception. This practice [@problem_id:2031975] challenges you to select a physically meaningful initial guess for the electron orbitals, which serves as the seed for the entire calculation. By applying fundamental principles of atomic structure, such as the Aufbau principle, you will learn how to construct a reasonable starting configuration, a crucial first step for any successful Hartree model simulation.", "problem": "The Hartree method is an iterative procedure used to approximate the ground state wavefunction and energy of a multi-electron atom. This iterative process, often called the Self-Consistent Field (SCF) procedure, must begin with an initial, physically reasonable guess for the set of single-particle wavefunctions (orbitals) occupied by the electrons. A standard approach is to use hydrogenic wavefunctions as this initial guess, which are the exact solutions for an atom with only one electron and a nucleus of charge $+Ze$.\n\nConsider a neutral Boron atom, which has a nuclear charge of $Z=5$. Your task is to determine the most appropriate initial guess for the set of *distinct occupied spatial orbitals* needed to start an SCF calculation for this atom in its ground state. The hydrogenic wavefunctions are denoted by $\\psi_{n,l,m_l}$, where $n$, $l$, and $m_l$ are the principal, azimuthal, and magnetic quantum numbers, respectively.\n\nWhich of the following represents the most physically reasonable set of distinct spatial wavefunctions for the initial guess?\n\nA. $\\{ \\psi_{1,0,0}, \\psi_{1,0,0}, \\psi_{1,0,0}, \\psi_{1,0,0}, \\psi_{1,0,0} \\}$\n\nB. $\\{ \\psi_{1,0,0}, \\psi_{2,0,0}, \\psi_{2,1,0} \\}$\n\nC. $\\{ \\psi_{1,0,0}, \\psi_{2,0,0}, \\psi_{3,0,0} \\}$\n\nD. $\\{ \\psi_{2,1,-1}, \\psi_{2,1,0}, \\psi_{2,1,1}, \\psi_{3,0,0} \\}$\n\nE. $\\{ \\psi_{5,0,0}, \\psi_{5,1,0}, \\psi_{5,2,0} \\}$", "solution": "For a neutral boron atom, the number of electrons is $Z=5$. In the independent-particle starting point for a Hartree SCF, we occupy hydrogenic spatial orbitals according to the Aufbau principle, subject to the Pauli exclusion principle and Hund’s rule. The Pauli exclusion principle states that at most two electrons (with opposite spin) can occupy the same spatial orbital. For hydrogenic orbitals labeled $\\psi_{n,l,m_{l}}$, the subshell capacity is $2(2l+1)$ because there are $2l+1$ values of $m_{l}$ and two spin states per spatial orbital.\n\nFollowing the Aufbau order for a many-electron atom, the lowest-energy occupation for $5$ electrons is $1s^{2}\\,2s^{2}\\,2p^{1}$. This uses:\n- the $1s$ spatial orbital $\\psi_{1,0,0}$, which can host two electrons with opposite spins;\n- the $2s$ spatial orbital $\\psi_{2,0,0}$, which can host two electrons with opposite spins;\n- one of the three degenerate $2p$ spatial orbitals $\\psi_{2,1,m_{l}}$ with $m_{l}\\in\\{-1,0,1\\}$, which hosts the fifth electron (Hund’s rule indicates singly occupying one $2p$ orbital before pairing).\n\nThe question asks for the set of distinct occupied spatial orbitals, i.e., counting each spatial function only once regardless of spin multiplicity. Thus the appropriate initial set is $\\{\\psi_{1,0,0},\\ \\psi_{2,0,0},\\ \\psi_{2,1,m_{l}}\\}$ with any one allowed $m_{l}$. Among the given options, this is represented by choosing $m_{l}=0$, namely $\\{\\psi_{1,0,0},\\ \\psi_{2,0,0},\\ \\psi_{2,1,0}\\}$, which matches option B. All other options either repeat the same spatial orbital multiple times, omit required lower-energy orbitals, or select orbitals corresponding to much higher principal quantum numbers inconsistent with the ground-state configuration.", "answer": "$$\\boxed{B}$$", "id": "2031975"}, {"introduction": "With an initial guess established, the iterative heart of the SCF procedure begins to beat. This exercise [@problem_id:2031953] guides you through a single, crucial step of this cycle: calculating the effective potential that an electron experiences. You will learn how this potential is built from the averaged charge distributions of all other electrons from the previous iteration, gaining insight into the meaning of \"self-consistency\" and the importance of avoiding unphysical self-interaction.", "problem": "Consider a Self-Consistent Field (SCF) calculation for a neutral Beryllium atom (Be), which has a nuclear charge of $Z=4$ and an electron configuration of $1s^2 2s^2$. The SCF procedure, based on the Hartree model, is an iterative method to find the approximate single-particle electronic orbitals.\n\nThe process begins with an initial guess for the orbitals, denoted as $\\psi_{nl}^{(0)}(r)$. These are the 'zeroth iteration' orbitals. From these, an effective potential is constructed to solve for a new set of orbitals, $\\psi_{nl}^{(1)}$, in the first iteration. This process is repeated until the orbitals and their energies converge.\n\nLet's establish the notation for the problem:\n-   The orbital for an electron in the state with principal quantum number $n$ and angular momentum quantum number $l$ after the $k$-th iteration is $\\psi_{nl}^{(k)}(r_j)$, where $r_j$ is the position of the electron.\n-   The potential energy of an electron at position $r_i$ due to the nucleus is $V_{\\text{nuc}}(r_i) = -\\frac{Ze^2}{4\\pi\\epsilon_0 r_i}$.\n-   The potential energy contribution at position $r_i$ from the time-averaged charge distribution of a single electron in orbital $\\psi_{nl}^{(k)}$ at position $r_j$ is given by the integral:\n$$ U_{nl}^{(k)}(r_i) = \\int |\\psi_{nl}^{(k)}(r_j)|^2 \\frac{e^2}{4\\pi\\epsilon_0 |r_i - r_j|} d^3 r_j $$\n\nThe task is to determine the effective potential for a specific electron at a particular stage of the calculation. Which of the following expressions represents the total effective potential energy operator, $V(r_i)$, that would be used in the time-independent Schrödinger equation to calculate the *second-iteration* orbital for one of the 2s electrons, namely $\\psi_{2s}^{(2)}(r_i)$?\n\nA. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(0)}(r_i) + U_{2s}^{(0)}(r_i)$\n\nB. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(1)}(r_i) + U_{2s}^{(1)}(r_i)$\n\nC. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(1)}(r_i) + 2 U_{2s}^{(1)}(r_i)$\n\nD. $V(r_i) = V_{nuc}(r_i) + U_{1s}^{(1)}(r_i) + U_{2s}^{(1)}(r_i)$\n\nE. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(2)}(r_i) + U_{2s}^{(2)}(r_i)$", "solution": "In the Hartree SCF method, each orbital $\\psi_{nl}^{(k)}(r)$ at iteration $k$ is obtained by solving the single-particle Schrödinger equation with an effective potential constructed from the average charge densities of the other electrons from the previous iteration. The time-independent Schrödinger equation for the 2s orbital at iteration $k=2$ is\n$$\n\\left[-\\frac{\\hbar^{2}}{2m}\\nabla_{i}^{2} + V^{(2)}(r_{i})\\right]\\psi_{2s}^{(2)}(r_{i}) = \\varepsilon_{2s}^{(2)}\\psi_{2s}^{(2)}(r_{i}).\n$$\nThe effective potential for electron $i$ contains (i) the nuclear attraction and (ii) the Coulomb repulsion from all other electrons. Using the definitions provided,\n$$\nV_{nuc}(r_{i}) = -\\frac{Z e^{2}}{4\\pi\\epsilon_{0} r_{i}}, \\qquad U_{nl}^{(k)}(r_{i}) = \\int |\\psi_{nl}^{(k)}(r_{j})|^{2}\\frac{e^{2}}{4\\pi\\epsilon_{0}|r_{i}-r_{j}|}\\,d^{3}r_{j}.\n$$\nBecause $U_{nl}^{(k)}$ is defined as the potential from the time-averaged charge distribution of a single electron in orbital $(n,l)$ at iteration $k$, the contribution from an occupied subshell is its occupation number multiplied by $U_{nl}^{(k)}$. However, when constructing the potential for a given electron, self-interaction must be excluded: for the specific 2s electron under consideration, only the other 2s electron contributes.\n\nFor Beryllium with configuration $1s^{2}2s^{2}$, the other electrons seen by a particular 2s electron are two $1s$ electrons and one other $2s$ electron. In an SCF iteration, the potential used to compute $\\psi_{2s}^{(2)}$ must be built from the orbitals obtained in the previous iteration, i.e., iteration $k=1$. Therefore,\n$$\nV^{(2)}(r_{i}) = V_{nuc}(r_{i}) + 2\\,U_{1s}^{(1)}(r_{i}) + 1\\,U_{2s}^{(1)}(r_{i}).\n$$\nThis matches option B. Options A and E use the wrong iteration densities; C double-counts the $2s$ contribution by including self-interaction; D omits one $1s$ electron.", "answer": "$$\\boxed{B}$$", "id": "2031953"}, {"introduction": "In the real world of computational science, algorithms do not always converge smoothly. The simple iterative scheme of the Hartree method can sometimes become unstable, with the electron density oscillating instead of settling into a solution. This practical exercise [@problem_id:2031988] introduces this phenomenon of \"charge sloshing\" and asks you to formulate a more robust update rule, a technique known as density mixing, to dampen these oscillations and guide the calculation toward a stable, converged result.", "problem": "In the Hartree model for a many-electron atom, one aims to find a self-consistent solution for the electronic structure. The procedure is iterative, and is a foundational example of a Self-Consistent Field (SCF) method. Let's define the core steps of one iteration, indexed by $k$ (where $k=0, 1, 2, ...$):\n\n1.  Start with an input electron density, $\\rho^{(k)}(\\mathbf{r})$.\n2.  Calculate the mean-field potential (e.g., the Hartree potential) $V^{(k)}(\\mathbf{r})$ that the electrons experience, which is a functional of $\\rho^{(k)}(\\mathbf{r})$.\n3.  Solve the set of one-electron Schrödinger equations with the potential $V^{(k)}(\\mathbf{r})$ to obtain a new set of single-particle orbitals, $\\{\\phi_i^{(k)}\\}$, and their corresponding energies.\n4.  Construct an output electron density, $\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$, from the occupied orbitals of the set $\\{\\phi_i^{(k)}\\}$.\n5.  Use the output density to generate the input density for the next iteration, $\\rho^{(k+1)}(\\mathbf{r})$.\n\nThe simplest update scheme is direct substitution: $\\rho^{(k+1)}(\\mathbf{r}) = \\rho_{\\text{out}}^{(k)}(\\mathbf{r})$. This process is repeated until the input and output densities are sufficiently close, i.e., $||\\rho^{(k+1)} - \\rho^{(k)}|| < \\epsilon$ for some small tolerance $\\epsilon$.\n\nHowever, for systems with a small energy gap between the highest occupied and lowest unoccupied orbitals, this direct substitution method often fails to converge. Instead, it enters a state of persistent oscillation where the electron density shifts back and forth between two (or more) configurations in successive iterations, a phenomenon sometimes called \"charge sloshing\". For example, the difference between successive densities, $||\\rho^{(k+1)} - \\rho^{(k)}||$, might converge to a large, non-zero constant instead of approaching zero.\n\nTo address this instability, propose a modified update rule for step 5. Your new rule should introduce a single, dimensionless real parameter $\\alpha$, where $0 < \\alpha \\leq 1$, to control the rate of update. The goal is to take a more conservative step toward the new output density, rather than adopting it entirely. Formulate an expression for the input density for the next iteration, $\\rho^{(k+1)}(\\mathbf{r})$, in terms of the input density from the current iteration, $\\rho^{(k)}(\\mathbf{r})$, the output density from the current iteration, $\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$, and your introduced parameter $\\alpha$.", "solution": "We seek a stable fixed-point iteration for the SCF map that takes an input density to an output density: define a nonlinear map $F$ by $F[\\rho^{(k)}](\\mathbf{r}) \\equiv \\rho_{\\text{out}}^{(k)}(\\mathbf{r})$. The SCF solution is a fixed point $\\rho^{\\ast}(\\mathbf{r})$ satisfying $F[\\rho^{\\ast}](\\mathbf{r})=\\rho^{\\ast}(\\mathbf{r})$. The direct substitution scheme is the Picard iteration $\\rho^{(k+1)}(\\mathbf{r})=F[\\rho^{(k)}](\\mathbf{r})$, which can be unstable and oscillatory when the Jacobian of $F$ near the fixed point has eigenvalues with magnitude close to or larger than one.\n\nTo damp these oscillations, introduce a relaxation parameter $0<\\alpha\\leq 1$ and take an underrelaxed step from $\\rho^{(k)}$ toward $F[\\rho^{(k)}]$. The modified update is\n$$\n\\rho^{(k+1)}(\\mathbf{r})=\\rho^{(k)}(\\mathbf{r})+\\alpha\\big(F[\\rho^{(k)}](\\mathbf{r})-\\rho^{(k)}(\\mathbf{r})\\big).\n$$\nWriting $F[\\rho^{(k)}](\\mathbf{r})=\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$, this becomes the linear mixing rule\n$$\n\\rho^{(k+1)}(\\mathbf{r})=(1-\\alpha)\\,\\rho^{(k)}(\\mathbf{r})+\\alpha\\,\\rho_{\\text{out}}^{(k)}(\\mathbf{r}).\n$$\nThis rule preserves the fixed point: if $\\rho^{(k)}=\\rho^{\\ast}$ and $F[\\rho^{\\ast}]=\\rho^{\\ast}$, then $\\rho^{(k+1)}=\\rho^{\\ast}$. It also reduces to direct substitution when $\\alpha=1$. If both $\\rho^{(k)}(\\mathbf{r})$ and $\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$ are nonnegative and integrate to the same particle number $N$, then $\\rho^{(k+1)}(\\mathbf{r})$ is a convex combination that remains nonnegative and integrates to $N$, since\n$$\n\\int \\rho^{(k+1)}(\\mathbf{r})\\,d\\mathbf{r}=(1-\\alpha)\\int \\rho^{(k)}(\\mathbf{r})\\,d\\mathbf{r}+\\alpha\\int \\rho_{\\text{out}}^{(k)}(\\mathbf{r})\\,d\\mathbf{r}=N.\n$$\nA linear stability analysis near a fixed point $\\rho^{\\ast}$ with Jacobian $J=\\delta F/\\delta \\rho|_{\\rho^{\\ast}}$ gives for the error $\\delta \\rho^{(k)}=\\rho^{(k)}-\\rho^{\\ast}$:\n$$\n\\delta \\rho^{(k+1)}=\\big((1-\\alpha)I+\\alpha J\\big)\\,\\delta \\rho^{(k)},\n$$\nso choosing $\\alpha$ sufficiently small can reduce the spectral radius of $(1-\\alpha)I+\\alpha J$ below $1$, damping oscillations and improving convergence while preserving the correct fixed point.", "answer": "$$\\boxed{\\rho^{(k+1)}(\\mathbf{r})=(1-\\alpha)\\,\\rho^{(k)}(\\mathbf{r})+\\alpha\\,\\rho_{\\text{out}}^{(k)}(\\mathbf{r})}$$", "id": "2031988"}]}