{"hands_on_practices": [{"introduction": "Numerical relativity simulations must grapple with enormous ranges of physical scales, from the compact regions near black holes to the distant zones where gravitational waves are measured. This exercise explores Adaptive Mesh Refinement (AMR), a critical technique that concentrates computational power only where it is needed. By completing this practice, you will quantify the staggering efficiency gains of AMR compared to a simple, uniform grid, making previously intractable simulations possible [@problem_id:1814393].", "problem": "Numerical simulations in general relativity, particularly those involving binary black hole mergers, must handle physical phenomena occurring on vastly different length scales. The computational grid must be fine enough to resolve the strong gravitational fields near the black holes, yet large enough to encompass the entire system and extract the outgoing gravitational waves far away. This poses a significant computational challenge.\n\nTo analyze this, consider a simplified model of a 3D simulation of a binary system. The simulation is performed within a large cubic computational domain of side length $L$. The smallest dynamically important feature size that must be resolved throughout the simulation is $\\delta$.\n\nWe will compare two different strategies for discretizing this domain:\n\n1.  **Uniform Grid:** A straightforward approach is to use a single, uniform cubic grid that covers the entire domain. To resolve the smallest feature size $\\delta$ everywhere, the grid spacing must be set to $\\Delta x = \\delta$ throughout the domain of side $L$. Let the total number of grid cells in this case be $N_{unif}$.\n\n2.  **Adaptive Mesh Refinement (AMR) Grid:** A more sophisticated approach is Adaptive Mesh Refinement (AMR), which uses a hierarchy of nested grids with different resolutions. Consider a setup with three refinement levels:\n    *   **Level 0:** A coarse base grid with spacing $\\Delta x_0$ that covers the entire domain of side $L$.\n    *   **Level 1:** An intermediate cubic grid with spacing $\\Delta x_1$ that covers a smaller region of side length $L/C_1$ centered within the domain.\n    *   **Level 2:** A fine cubic grid with spacing $\\Delta x_2$ that covers the innermost region of side length $L/C_2$ where the black holes are located.\n\n    The grid spacing between successive levels is related by a constant refinement factor, $r$, such that $\\Delta x_{k+1} = \\Delta x_k / r$. The finest grid must resolve the smallest physical scale, so we set $\\Delta x_2 = \\delta$. For the purposes of this problem, assume the total number of grid cells in the AMR grid, $N_{AMR}$, is the sum of the cells at each of the three individual grid levels.\n\nGiven the dimensionless parameters $r=2$, $C_1=4$, and $C_2=32$, calculate the ratio $N_{unif} / N_{AMR}$. This ratio represents the factor by which the total number of computational cells is reduced by using this specific AMR strategy compared to a uniform grid. Round your final answer to three significant figures.", "solution": "We require the total number of 3D grid cells for each strategy.\n\nUniform grid:\nTo resolve the smallest feature size everywhere, set $\\Delta x=\\delta$. The number of cells per side is $L/\\delta$, so the total number of cells is\n$$\nN_{unif}=\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\n\nAMR grid:\nThe refinement relation is $\\Delta x_{k+1}=\\Delta x_{k}/r$, with $\\Delta x_{2}=\\delta$. Thus\n$$\n\\Delta x_{1}=r\\,\\delta,\\qquad \\Delta x_{0}=r^{2}\\delta.\n$$\nThe number of cells at each level is the region side length divided by the level spacing, cubed:\n$$\nN_{0}=\\left(\\frac{L}{\\Delta x_{0}}\\right)^{3}=\\left(\\frac{L}{r^{2}\\delta}\\right)^{3}=r^{-6}\\left(\\frac{L}{\\delta}\\right)^{3},\n$$\n$$\nN_{1}=\\left(\\frac{L/C_{1}}{\\Delta x_{1}}\\right)^{3}=\\left(\\frac{L}{C_{1}r\\delta}\\right)^{3}=C_{1}^{-3}r^{-3}\\left(\\frac{L}{\\delta}\\right)^{3},\n$$\n$$\nN_{2}=\\left(\\frac{L/C_{2}}{\\Delta x_{2}}\\right)^{3}=\\left(\\frac{L}{C_{2}\\delta}\\right)^{3}=C_{2}^{-3}\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\nSumming levels (as specified),\n$$\nN_{AMR}=N_{0}+N_{1}+N_{2}=\\left[r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}\\right]\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\nTherefore the ratio is\n$$\n\\frac{N_{unif}}{N_{AMR}}=\\frac{\\left(L/\\delta\\right)^{3}}{\\left[r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}\\right]\\left(L/\\delta\\right)^{3}}=\\frac{1}{r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}}.\n$$\nWith $r=2$, $C_{1}=4$, $C_{2}=32$,\n$$\nr^{-6}=\\frac{1}{64},\\quad C_{1}^{-3}r^{-3}=\\frac{1}{64}\\cdot\\frac{1}{8}=\\frac{1}{512},\\quad C_{2}^{-3}=\\frac{1}{32768},\n$$\nso\n$$\n\\frac{N_{unif}}{N_{AMR}}=\\frac{1}{\\frac{1}{64}+\\frac{1}{512}+\\frac{1}{32768}}=\\frac{1}{\\frac{512+64+1}{32768}}=\\frac{32768}{577}\\approx 56.790\\ldots\n$$\nRounded to three significant figures, the ratio is $56.8$.", "answer": "$$\\boxed{56.8}$$", "id": "1814393"}, {"introduction": "The beauty of Einstein's equations comes with a challenge: they include constraints that must be satisfied at every moment. Numerical errors can cause violations of these constraints, leading to unphysical and unstable simulations. This exercise delves into a simplified model of \"constraint damping,\" a powerful method used in modern codes to actively suppress these violations and ensure the simulation's stability and accuracy [@problem_id:1814401].", "problem": "In numerical relativity, the Einstein field equations are often cast into a system of first-order partial differential equations that describe the time evolution of geometric quantities. A critical feature of these equations is the existence of constraint equations, such as the Hamiltonian and momentum constraints, which must be satisfied at all times. However, numerical methods can introduce errors that cause solutions to drift away from the \"constraint surface\" where these constraints are zero. This phenomenon is known as constraint violation.\n\nTo combat this, modern evolution schemes often incorporate \"constraint damping\" terms. These are carefully chosen additions to the evolution equations designed to actively drive the constraint violations back towards zero.\n\nConsider a simplified one-dimensional toy model that mimics this behavior. The system is described by three fields: $\\phi(x,t)$, $\\Pi(x,t)$, and an auxiliary field $K(x,t)$. The \"constraint\" in this model is defined as the quantity $C(x,t) = K(x,t) - \\frac{\\partial \\phi}{\\partial x}(x,t)$. For a physically exact solution, this constraint must be zero everywhere for all time.\n\nTo ensure stability, the evolution equations for the fields are modified with damping terms as follows:\n1.  $\\frac{\\partial \\phi}{\\partial t} = \\Pi + \\alpha C$\n2.  $\\frac{\\partial \\Pi}{\\partial t} = \\frac{\\partial K}{\\partial x}$\n3.  $\\frac{\\partial K}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C$\n\nHere, $\\alpha$ and $\\beta$ are positive real constants representing the strength of the damping and propagation of the constraint.\n\nSuppose that at time $t=0$, a small, localized numerical error results in an initial constraint violation given by a Gaussian profile:\n$$C(x,0) = C_0 \\exp\\left(-\\frac{x^2}{w^2}\\right)$$\nwhere $C_0$ is the initial amplitude of the violation and $w$ is its characteristic width.\n\nDerive the analytical expression for the constraint violation, $C(x,t)$, for all subsequent times $t > 0$.", "solution": "We begin with the definition of the constraint $C(x,t) = K(x,t) - \\frac{\\partial \\phi}{\\partial x}(x,t)$. Differentiate this with respect to time and use the given evolution equations to obtain a closed equation for $C$.\n\nCompute the time derivative:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial K}{\\partial t} - \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\phi}{\\partial x}\\right).\n$$\nSubstitute the evolution equations $\\frac{\\partial K}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C$ and $\\frac{\\partial \\phi}{\\partial t} = \\Pi + \\alpha C$:\n$$\n\\frac{\\partial C}{\\partial t} = \\left(\\frac{\\partial \\Pi}{\\partial x} - \\beta C\\right) - \\frac{\\partial}{\\partial x}\\left(\\Pi + \\alpha C\\right).\n$$\nExpand the spatial derivative:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C - \\frac{\\partial \\Pi}{\\partial x} - \\alpha \\frac{\\partial C}{\\partial x}.\n$$\nCancel the $\\frac{\\partial \\Pi}{\\partial x}$ terms to obtain the linear first-order PDE:\n$$\n\\frac{\\partial C}{\\partial t} + \\alpha \\frac{\\partial C}{\\partial x} = -\\beta C.\n$$\n\nSolve this by the method of characteristics. Along characteristic curves defined by\n$$\n\\frac{d x}{d t} = \\alpha,\n$$\nthe constraint satisfies the ordinary differential equation\n$$\n\\frac{d C}{d t} = -\\beta C.\n$$\nIntegrating the characteristic equations gives $x(t) = x_{0} + \\alpha t$ and\n$$\nC(x(t),t) = C(x_{0},0)\\exp\\left(-\\beta t\\right).\n$$\nEliminate $x_{0}$ using $x_{0} = x - \\alpha t$ to write the general solution:\n$$\nC(x,t) = \\exp\\left(-\\beta t\\right) C(x - \\alpha t,0).\n$$\n\nApply the given initial condition $C(x,0) = C_{0} \\exp\\left(-\\frac{x^{2}}{w^{2}}\\right)$ to determine\n$$\nC(x,t) = C_{0} \\exp\\left(-\\beta t\\right) \\exp\\left(-\\frac{(x - \\alpha t)^{2}}{w^{2}}\\right).\n$$\nThis expression shows that the initial Gaussian constraint violation is advected with speed $\\alpha$ and damped at rate $\\beta$, retaining its Gaussian shape and width $w$ for all $t > 0$.", "answer": "$$\\boxed{C(x,t) = C_{0}\\,\\exp\\left(-\\beta t\\right)\\,\\exp\\left(-\\frac{(x-\\alpha t)^{2}}{w^{2}}\\right)}$$", "id": "1814401"}, {"introduction": "A key goal of simulating black hole mergers is to track the formation and properties of the final black hole. In a dynamic spacetime, we locate black holes by finding \"apparent horizons\"â€”surfaces that trap light at a given instant. This practice provides a hands-on look at the core task of an apparent horizon-finding algorithm: solving for the location where the expansion of outgoing light rays vanishes, signaling the boundary of the trapped region [@problem_id:1814403].", "problem": "In a numerical relativity simulation of a collapsing star, a simplified model is used to describe the spacetime on a particular time slice. In this model, the expansion $\\theta$ of outgoing light rays from a test sphere of coordinate radius $r$ is approximated by the expression:\n$$\n\\theta(r) = \\frac{2}{r}\\left(1 - \\frac{M}{r}\\right) - K\n$$\nHere, $M$ is a positive parameter related to the mass of the collapsing core, and $K$ is a positive constant related to the dynamics of the spacetime geometry. An apparent horizon is a spherical surface where these outgoing light rays have zero expansion. In numerical simulations, an 'apparent horizon finder' is an algorithm that searches for the radius $r_{AH}$ of such a surface.\n\nBased on this model, which of the following expressions gives the radius (or radii) $r_{AH}$ of the apparent horizon? You may assume that the parameters $M$ and $K$ are such that at least one real, positive solution for the radius exists.\n\nA. $r_{AH} = \\frac{1 \\pm \\sqrt{1 - 2 K M}}{K}$\n\nB. $r_{AH} = \\frac{1 + \\sqrt{1 + 2 K M}}{K}$\n\nC. $r_{AH} = M$\n\nD. $r_{AH} = \\frac{2}{K}$\n\nE. $r_{AH} = \\frac{1 \\pm \\sqrt{1 - 4 K M}}{2K}$", "solution": "An apparent horizon is defined as a surface where the expansion of outgoing light rays vanishes, so we set $\\theta(r)=0$. Given\n$$\n\\theta(r)=\\frac{2}{r}\\left(1-\\frac{M}{r}\\right)-K,\n$$\nthe apparent horizon radius $r_{AH}$ satisfies\n$$\n\\frac{2}{r}\\left(1-\\frac{M}{r}\\right)-K=0.\n$$\nAdd $K$ to both sides:\n$$\n\\frac{2}{r}\\left(1-\\frac{M}{r}\\right)=K.\n$$\nMultiply both sides by $r^{2}$ (valid for $r>0$):\n$$\n2r-2M=Kr^{2}.\n$$\nRearrange to standard quadratic form in $r$:\n$$\nKr^{2}-2r+2M=0.\n$$\nApply the quadratic formula with $a=K$, $b=-2$, $c=2M$:\n$$\nr_{AH}=\\frac{-(-2)\\pm\\sqrt{(-2)^{2}-4K(2M)}}{2K}=\\frac{2\\pm\\sqrt{4-8KM}}{2K}=\\frac{2\\pm 2\\sqrt{1-2KM}}{2K}=\\frac{1\\pm\\sqrt{1-2KM}}{K}.\n$$\nAssuming parameters yield at least one real, positive solution corresponds to the discriminant condition $1-2KM\\geq 0$. The resulting expression matches option A.", "answer": "$$\\boxed{A}$$", "id": "1814403"}]}