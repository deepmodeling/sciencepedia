{"hands_on_practices": [{"introduction": "神经心理学测试的原始分数本身几乎没有临床意义，必须参照适当的常模人群进行解释。本练习提供了一个将原始分数转换为标准化$z$分数的实践机会，该转换使用基于回归的常模来调整年龄和教育等人口统计学变量的影响。掌握这项技能对于量化认知表现、识别特定认知域的损伤以及为轻度认知障碍（MCI）的诊断奠定基础至关重要。", "problem": "一位$72$岁、右利手的个体，接受过$16$年正规教育，因疑似轻度认知障碍（MCI）在一家记忆障碍诊所接受评估。我们在四个认知领域对他进行了标准的神经心理学测试。每个测试都有考虑了年龄和教育程度的基于回归的常模，以及相应的残差标准差。年龄和教育程度分别以$60$岁和$12$年为中心进行中心化，因此一个测试的常模期望值由以下公式给出：\n$$\nE[\\text{score}] \\;=\\; \\alpha \\;+\\; \\beta_{\\text{age}} \\cdot (\\text{Age} - 60) \\;+\\; \\beta_{\\text{edu}} \\cdot (\\text{Education} - 12).\n$$\n对于原始分数越高表示表现越好的测试，使用期望值和测试的残差标准差将原始分数标准化为$z$分数。对于用时越少表示表现越好的计时测试，标准化应使得标准化后的值越高表示表现越好。\n\n患者的原始分数和回归参数如下：\n- 记忆领域：\n  - 即刻言语列表回忆（回忆项目数，范围$0$到$15$）：参数 $\\alpha = 11.0$，$\\beta_{\\text{age}} = -0.04$，$\\beta_{\\text{edu}} = 0.25$，残差 $\\sigma_{\\epsilon} = 1.2$。原始分数 $= 9$。\n  - 延迟言语列表回忆（回忆项目数，范围$0$到$15$）：参数 $\\alpha = 8.5$，$\\beta_{\\text{age}} = -0.03$，$\\beta_{\\text{edu}} = 0.20$，残差 $\\sigma_{\\epsilon} = 1.0$。原始分数 $= 6$。\n- 执行功能领域：\n  - 连线测试B部分完成时间（秒；数值越低表示表现越好）：参数 $\\alpha = 85$，$\\beta_{\\text{age}} = 0.8$，$\\beta_{\\text{edu}} = -1.5$，残差 $\\sigma_{\\epsilon} = 18$。原始分数 $= 120$。\n- 语言领域：\n  - 类别流畅性（每分钟说出的动物）：参数 $\\alpha = 20$，$\\beta_{\\text{age}} = -0.10$，$\\beta_{\\text{edu}} = 0.50$，残差 $\\sigma_{\\epsilon} = 3$。原始分数 $= 16$。\n- 视觉空间领域：\n  - Rey–Osterrieth复杂图形测试复制分数（范围$0$到$36$）：参数 $\\alpha = 29$，$\\beta_{\\text{age}} = -0.05$, $\\beta_{\\text{edu}} = 0.15$，残差 $\\sigma_{\\epsilon} = 2$。原始分数 $= 26$。\n\n任务：\n- 使用基于回归的期望值和残差标准差计算每个测试的标准化$z$分数，并调整方向，使得所有测试中标准化后的值越高表示表现越好。\n- 将记忆领域的领域水平$z$分数计算为两个记忆测试$z$分数的算术平均值。执行、语言和视觉空间领域的领域水平$z$分数等于其各自单个测试的标准化$z$分数。\n- 使用“如果一个认知领域的领域水平$z$分数小于或等于$-1.5$，则该领域被认为受损”这一标准，对每个领域进行分类。\n- 最后，计算加权总体认知$z$分数\n$$\nz_{\\text{global}} \\;=\\; w_{\\text{mem}} z_{\\text{mem}} \\;+\\; w_{\\text{exec}} z_{\\text{exec}} \\;+\\; w_{\\text{lang}} z_{\\text{lang}} \\;+\\; w_{\\text{vis}} z_{\\text{vis}},\n$$\n权重为 $\\mathbf{w} = (w_{\\text{mem}}, w_{\\text{exec}}, w_{\\text{lang}}, w_{\\text{vis}}) = (0.30,\\, 0.25,\\, 0.25,\\, 0.20)$。\n\n将最终的加权总体认知$z$分数表示为一个实数，并四舍五入到四位有效数字。最终答案不需要单位。", "solution": "首先验证问题，以确保其是适定、有科学依据且客观的。\n\n### 第1步：提取已知条件\n- 患者人口统计学信息：年龄 $= 72$ 岁，教育程度 $= 16$ 年，右利手。\n- 常模模型：$E[\\text{score}] = \\alpha + \\beta_{\\text{age}} \\cdot (\\text{Age} - 60) + \\beta_{\\text{edu}} \\cdot (\\text{Education} - 12)$。\n- 标准化规则：对于分数越高越好的测试，$z = (\\text{原始分数} - E[\\text{分数}]) / \\sigma_{\\epsilon}$。对于分数越低越好的测试，标准化应使更高的$z$值表示更好的表现。\n- 记忆/即刻回忆（越高越好）：原始分数 $= 9$，$\\alpha = 11.0$，$\\beta_{\\text{age}} = -0.04$，$\\beta_{\\text{edu}} = 0.25$，$\\sigma_{\\epsilon} = 1.2$。\n- 记忆/延迟回忆（越高越好）：原始分数 $= 6$，$\\alpha = 8.5$，$\\beta_{\\text{age}} = -0.03$，$\\beta_{\\text{edu}} = 0.20$，$\\sigma_{\\epsilon} = 1.0$。\n- 执行/连线测试B（越低越好）：原始分数 $= 120$ 秒，$\\alpha = 85$，$\\beta_{\\text{age}} = 0.8$，$\\beta_{\\text{edu}} = -1.5$，$\\sigma_{\\epsilon} = 18$。\n- 语言/类别流畅性（越高越好）：原始分数 $= 16$，$\\alpha = 20$，$\\beta_{\\text{age}} = -0.10$，$\\beta_{\\text{edu}} = 0.50$，$\\sigma_{\\epsilon} = 3$。\n- 视觉空间/Rey–Osterrieth复制（越高越好）：原始分数 $= 26$，$\\alpha = 29$，$\\beta_{\\text{age}} = -0.05$，$\\beta_{\\text{edu}} = 0.15$，$\\sigma_{\\epsilon} = 2$。\n- 领域分数汇总：记忆领域的$z$分数是其两个测试$z$分数的算术平均值。其他领域分数是它们各自单个测试的$z$分数。\n- 受损标准：如果一个领域的领域水平$z$分数 $\\le -1.5$，则该领域受损。\n- 总体认知分数：$z_{\\text{global}} = w_{\\text{mem}} z_{\\text{mem}} + w_{\\text{exec}} z_{\\text{exec}} + w_{\\text{lang}} z_{\\text{lang}} + w_{\\text{vis}} z_{\\text{vis}}$。\n- 权重：$(w_{\\text{mem}}, w_{\\text{exec}}, w_{\\text{lang}}, w_{\\text{vis}}) = (0.30, 0.25, 0.25, 0.20)$。\n- 最终指令：将最终的加权总体认知$z$分数四舍五入至四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n- **有科学依据：** 问题使用了标准的神经心理学评估方法，包括基于回归的常模和$z$分数转换。所列的认知测试均为标准工具，其方法学与临床神经心理学中诊断轻度认知障碍等病症的实践相符。\n- **适定性：** 提供了所有必要的数据（原始分数、回归参数、标准差、公式）。任务按顺序定义，并导向一个唯一的数值解。\n- **客观性：** 问题以定量和形式化的术语陈述，没有主观或模糊的语言。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n第一步是为回归模型计算患者特定的人口统计学变量。患者年龄为$72$岁，教育程度为$16$年。中心化后的变量是：\n- 中心化年龄：$\\text{Age} - 60 = 72 - 60 = 12$。\n- 中心化教育程度：$\\text{Education} - 12 = 16 - 12 = 4$。\n\n接下来，我们计算每个测试的期望分数和标准化$z$分数。\n\n**1. 记忆领域：即刻言语列表回忆**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{mem,imm}} = 11.0 + (-0.04)(\\text{Age} - 60) + (0.25)(\\text{Education} - 12) $$\n$$ E_{\\text{mem,imm}} = 11.0 + (-0.04)(12) + (0.25)(4) = 11.0 - 0.48 + 1.0 = 11.52 $$\n- 标准化$z$分数为：\n$$ z_{\\text{mem,imm}} = \\frac{\\text{Raw Score} - E_{\\text{mem,imm}}}{\\sigma_{\\epsilon}} = \\frac{9 - 11.52}{1.2} = \\frac{-2.52}{1.2} = -2.1 $$\n\n**2. 记忆领域：延迟言语列表回忆**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{mem,del}} = 8.5 + (-0.03)(\\text{Age} - 60) + (0.20)(\\text{Education} - 12) $$\n$$ E_{\\text{mem,del}} = 8.5 + (-0.03)(12) + (0.20)(4) = 8.5 - 0.36 + 0.8 = 8.94 $$\n- 标准化$z$分数为：\n$$ z_{\\text{mem,del}} = \\frac{\\text{Raw Score} - E_{\\text{mem,del}}}{\\sigma_{\\epsilon}} = \\frac{6 - 8.94}{1.0} = -2.94 $$\n\n**3. 执行功能领域：连线测试B部分**\n这是一个“分数越低越好”（计时）的测试。为了调整方向使得标准化后的值越高表示表现越好，我们将$z$分数的分子反转。\n- 期望分数（时间）为：\n$$ E_{\\text{exec}} = 85 + (0.8)(\\text{Age} - 60) + (-1.5)(\\text{Education} - 12) $$\n$$ E_{\\text{exec}} = 85 + (0.8)(12) + (-1.5)(4) = 85 + 9.6 - 6.0 = 88.6 $$\n- 标准化$z$分数为：\n$$ z_{\\text{exec}} = \\frac{E_{\\text{exec}} - \\text{Raw Score}}{\\sigma_{\\epsilon}} = \\frac{88.6 - 120}{18} = \\frac{-31.4}{18} \\approx -1.7444... $$\n\n**4. 语言领域：类别流畅性**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{lang}} = 20 + (-0.10)(\\text{Age} - 60) + (0.50)(\\text{Education} - 12) $$\n$$ E_{\\text{lang}} = 20 + (-0.10)(12) + (0.50)(4) = 20 - 1.2 + 2.0 = 20.8 $$\n- 标准化$z$分数为：\n$$ z_{\\text{lang}} = \\frac{\\text{Raw Score} - E_{\\text{lang}}}{\\sigma_{\\epsilon}} = \\frac{16 - 20.8}{3} = \\frac{-4.8}{3} = -1.6 $$\n\n**5. 视觉空间领域：Rey–Osterrieth复杂图形测试复制**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{vis}} = 29 + (-0.05)(\\text{Age} - 60) + (0.15)(\\text{Education} - 12) $$\n$$ E_{\\text{vis}} = 29 + (-0.05)(12) + (0.15)(4) = 29 - 0.6 + 0.6 = 29.0 $$\n- 标准化$z$分数为：\n$$ z_{\\text{vis}} = \\frac{\\text{Raw Score} - E_{\\text{vis}}}{\\sigma_{\\epsilon}} = \\frac{26 - 29.0}{2} = \\frac{-3.0}{2} = -1.5 $$\n\n接下来，我们计算领域水平的$z$分数。\n- **记忆领域分数**：$z_{\\text{mem}}$ 是两个记忆测试$z$分数的平均值。\n$$ z_{\\text{mem}} = \\frac{z_{\\text{mem,imm}} + z_{\\text{mem,del}}}{2} = \\frac{-2.1 + (-2.94)}{2} = \\frac{-5.04}{2} = -2.52 $$\n- **其他领域分数**：\n  - 执行：$z_{\\text{exec}} = -31.4 / 18$\n  - 语言：$z_{\\text{lang}} = -1.6$\n  - 视觉空间：$z_{\\text{vis}} = -1.5$\n\n现在，我们根据受损标准（$z \\le -1.5$）对每个领域进行分类。\n- 记忆：$z_{\\text{mem}} = -2.52 \\le -1.5$。受损。\n- 执行：$z_{\\text{exec}} \\approx -1.74 \\le -1.5$。受损。\n- 语言：$z_{\\text{lang}} = -1.6 \\le -1.5$。受损。\n- 视觉空间：$z_{\\text{vis}} = -1.5 \\le -1.5$。受损。\n所有四个认知领域都符合受损标准。\n\n最后，我们计算加权总体认知$z$分数，$z_{\\text{global}}$。\n$$ z_{\\text{global}} = w_{\\text{mem}} z_{\\text{mem}} + w_{\\text{exec}} z_{\\text{exec}} + w_{\\text{lang}} z_{\\text{lang}} + w_{\\text{vis}} z_{\\text{vis}} $$\n权重为 $\\mathbf{w} = (0.30, 0.25, 0.25, 0.20)$。\n$$ z_{\\text{global}} = (0.30)(-2.52) + (0.25)\\left(\\frac{-31.4}{18}\\right) + (0.25)(-1.6) + (0.20)(-1.5) $$\n$$ z_{\\text{global}} = -0.756 + (0.25)(-1.7444...) - 0.40 - 0.30 $$\n$$ z_{\\text{global}} = -0.756 - 0.436111... - 0.40 - 0.30 $$\n$$ z_{\\text{global}} = -1.892111... $$\n\n问题要求将结果四舍五入到四位有效数字。\n这个数字是 $-1.892111...$。前四位有效数字是 $1$、$8$、$9$ 和 $2$。第五位有效数字是 $1$，所以我们向下舍入（即，在第四位有效数字处截断）。\n$$ z_{\\text{global}} \\approx -1.892 $$", "answer": "$$\\boxed{-1.892}$$", "id": "4496131"}, {"introduction": "在MCI的临床管理中，纵向监测认知变化至关重要，但区分真实的认知衰退与测量误差所致的随机波动是一个核心挑战。本练习将引导您从经典测试理论（CTT）的第一性原理出发，推导并应用可靠变化指数（Reliable Change Index, RCI）。通过这个练习，您将学会如何严谨地评估一名患者在两次测试间的得分变化是否具有统计学意义，这是监测疾病进展或评估干预效果的关键技能 [@problem_id:4496192]。", "problem": "一家神经心理学诊所对一名患有轻度认知障碍 (MCI) 的老年人进行两次随访，以监测其情景记忆。在时间点 $1$ 和时间点 $2$，使用等值但平行的版本进行了相同的延迟回忆测试。您需要形式化一个标准，以判断观测到的变化是否超出了仅由测量误差所能解释的范围。仅使用经典测量理论 (CTT) 的基础：分数分解 $X = T + E$（其中 $\\mathbb{E}[E] = 0$）以及信度定义 $r = \\mathrm{Var}(T)/\\mathrm{Var}(X) = 1 - \\mathrm{Var}(E)/\\mathrm{Var}(X)$。假设以下被广泛接受且可检验的条件在此情境下成立：在真实分数无变化的零假设下，真实分数在两次测量中保持稳定；两次测量采用信度相等的平行版本；两次测量的误差项独立且方差相等，并且在所关注的能力范围内方差齐性；由于使用了等值版本，在给定的重测间隔内，任何系统性练习效应都可以忽略不计。该诊所从一个匹配的稳定老年人样本中得知，该测试的观测分数标准差为 $\\sigma = 8$，在相同间隔内的重测信度为 $r = 0.90$。该患者在基线时的观测分数为 $X_1 = 35$，在 $6$ 个月后的观测分数为 $X_2 = 29$。\n\n根据这些基本定义和假设，推导出一个z标准化变化指数，该指数在真实分数无变化的零假设下服从标准正态分布，并用 $X_1$、$X_2$、$r$ 和 $\\sigma^2$ 明确表示。然后，使用所提供的数据计算该指数的值，并说明在双尾 $\\alpha = 0.05$ 的水平下，该变化是否具有统计显著性。最后，确定在 MCI 监测的背景下，该指数能有效指示超出测量误差的变化所需的最小假设集。\n\n哪个选项正确陈述了本案例中的通用表达式、必要假设和数值结论？\n\nA. 标准化变化指数为 $(X_2 - X_1)/\\sqrt{2(1 - r)\\sigma^2}$。其有效性条件为：CTT 成立，两次测量为信度相等的平行版本，误差项在两次测量中独立、方差相等且均值为 $0$，误差方差在所考虑的能力范围内是方差齐性的，任何练习效应均可忽略不计（或已被移除），且误差分布近似正态分布以适用z阈值。信度 $r$ 是在匹配的稳定样本中估计的重测信度，$\\sigma^2$ 是该样本的观测分数方差。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-1.68$，未超过双尾 $\\alpha = 0.05$ 的临界值 $\\pm 1.96$，因此该下降未超出测量误差范围。\n\nB. 标准化变化指数为 $(X_2 - X_1)/\\sqrt{2 r \\sigma^2}$。它仅要求版本是平行的；内部一致性信度可以替代重测信度，且z阈值不需要正态性。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-0.56$，在 $\\alpha = 0.05$ 双尾水平下不显著。\n\nC. 标准化变化指数为 $(X_2 - X_1)/\\sqrt{(1 - r)\\sigma^2}$，这反映了如果误差随时间相关，则在重测时只有一个误差项起作用。它假设误差相关且无练习效应，并允许使用患者的基线变异性来代替 $\\sigma$。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-2.37$，表明在 $\\alpha = 0.05$ 双尾水平下有显著下降。\n\nD. 标准化变化指数为 $(X_2 - X_1 - \\mu_{\\mathrm{retest}})/\\sqrt{2(1 - r)\\sigma^2}$，其中 $\\mu_{\\mathrm{retest}}$ 是来自任何参考组的预期平均重测增益；因为 MCI 中的练习效应通常很小，$\\mu_{\\mathrm{retest}}$ 可以设为 $0$ 而不失有效性，并且克朗巴赫α系数可用于 $r$。z阈值不需要误差的正态性。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-1.68$，在 $\\alpha = 0.05$ 双尾水平下不显著。", "solution": "用户提供了一个心理测量学领域的问题，具体涉及经典测量理论 (CTT) 在临床神经心理学中的应用。任务是验证该问题，为分数变化推导一个标准化指数，将其应用于给定数据，并评估所提供的选项。\n\n### 问题验证\n\n**第1步：提取给定条件**\n\n*   **理论框架**：经典测量理论 (CTT)\n*   **CTT 定义**：\n    *   观测分数 ($X$) = 真实分数 ($T$) + 误差 ($E$)，即 $X = T + E$。\n    *   误差的期望值：$\\mathbb{E}[E] = 0$。\n    *   信度 ($r$)：$r = \\mathrm{Var}(T)/\\mathrm{Var}(X) = 1 - \\mathrm{Var}(E)/\\mathrm{Var}(X)$。\n*   **时间点**：时间点 $1$ (基线) 和 时间点 $2$ ($6$ 个月后)。\n*   **真实分数无变化的零假设下的假设**：\n    1.  稳定的真实分数：$T_1 = T_2$。\n    2.  信度相等的平行测验版本。\n    3.  误差项 ($E_1$, $E_2$) 独立。\n    4.  误差项方差相等。\n    5.  误差方差具有方差齐性。\n    6.  练习效应可忽略不计。\n*   **总体/样本参数 (来自一个匹配的稳定样本)**：\n    *   观测分数的标准差：$\\sigma = 8$。\n    *   重测信度：$r = 0.90$。\n*   **患者数据**：\n    *   基线观测分数：$X_1 = 35$。\n    *   随访观测分数：$X_2 = 29$。\n*   **统计标准**：双尾显著性水平 $\\alpha = 0.05$。\n\n**第2步：使用提取的给定条件进行验证**\n\n*   **科学依据**：该问题牢固地植根于经典测量理论，这是心理和教育测量学中的一个基本和标准的框架。问题要求推导的可靠变化指数 (Reliable Change Index, RCI) 是临床实践和研究中用于评估个体变化的成熟统计工具。所有定义和假设都是该领域的标准。\n*   **问题的适定性**：问题提供了所有必要的数据（$\\sigma$、$r$、$X_1$、$X_2$）和一套清晰的假设，以推导出一个唯一的标准化变化指数。问题是明确无歧义的。\n*   **客观性**：问题以精确、客观和定量的术语陈述。它不含主观或基于意见的主张。\n*   **缺陷清单**：该问题没有违反任何指定的无效标准。它在科学上是合理的、可形式化的、完整的、现实的且适定的。参数（$r=0.90$, $\\sigma=8$）对于一个好的神经心理学测试来说是合理的。\n\n**第3步：结论与行动**\n\n问题陈述有效。可以继续进行解答过程。\n\n### 推导与分析\n\n**1. 标准化变化指数的推导**\n\n目标是为观测分数的变化 $\\Delta X = X_2 - X_1$ 创建一个z标准化统计量，在零假设 ($H_0$) 即个体真实分数没有变化的情况下。一个z统计量的一般形式是 (观测值 - 期望值) / 标准差。\n\n*   **观测值**：观测到的变化是 $\\Delta X = X_2 - X_1$。\n\n*   **期望值**：我们需要在 $H_0$ 下 $\\Delta X$ 的期望值。\n    根据 CTT，$X_1 = T_1 + E_1$ 且 $X_2 = T_2 + E_2$。\n    零假设指出真实分数是稳定的，所以 $T_1 = T_2 = T$。\n    变化分数是 $\\Delta X = (T_2 + E_2) - (T_1 + E_1) = (T + E_2) - (T + E_1) = E_2 - E_1$。\n    期望值是 $\\mathbb{E}[\\Delta X] = \\mathbb{E}[E_2 - E_1]$。\n    利用期望的线性性质和 CTT 假设 $\\mathbb{E}[E_1] = \\mathbb{E}[E_2] = 0$：\n    $\\mathbb{E}[\\Delta X] = \\mathbb{E}[E_2] - \\mathbb{E}[E_1] = 0 - 0 = 0$。\n\n*   **标准差**：我们需要 $\\Delta X$ 的标准差，即其方差 $\\mathrm{Var}(\\Delta X)$ 的平方根。差值 $\\Delta X = E_2 - E_1$ 的方差由以下公式给出：\n    $\\mathrm{Var}(\\Delta X) = \\mathrm{Var}(E_2 - E_1) = \\mathrm{Var}(E_2) + \\mathrm{Var}(E_1) - 2\\mathrm{Cov}(E_1, E_2)$。\n    问题陈述我们假设误差项是独立的，这意味着它们的协方差为零：$\\mathrm{Cov}(E_1, E_2) = 0$。\n    问题还指出，测试具有相等的信度并且是平行的，这意味着相等的误差方差：$\\mathrm{Var}(E_1) = \\mathrm{Var}(E_2) = \\sigma_E^2$。\n    因此，差值的方差简化为：\n    $\\mathrm{Var}(\\Delta X) = \\sigma_E^2 + \\sigma_E^2 = 2\\sigma_E^2$。该方差也被称为差异标准误 (Standard Error of Difference, SED) 的平方。\n\n    接下来，我们必须用给定的可观测量，即信度 ($r$) 和观测分数方差 ($\\sigma^2$) 来表示误差方差 $\\sigma_E^2$。\n    根据 CTT 的信度定义：$r = 1 - \\mathrm{Var}(E) / \\mathrm{Var}(X) = 1 - \\sigma_E^2 / \\sigma^2$。\n    重新排列以求解 $\\sigma_E^2$：\n    $\\sigma_E^2 / \\sigma^2 = 1 - r$\n    $\\sigma_E^2 = (1 - r)\\sigma^2$。\n\n    将此代回 $\\mathrm{Var}(\\Delta X)$ 的表达式中：\n    $\\mathrm{Var}(\\Delta X) = 2 \\times [(1 - r)\\sigma^2] = 2(1 - r)\\sigma^2$。\n\n    变化分数的标准差（即 SED）是该方差的平方根：\n    $\\sigma_{\\Delta X} = \\sqrt{2(1 - r)\\sigma^2}$。\n\n*   **最终的z指数**：结合这些部分，z标准化变化指数为：\n    $$z = \\frac{\\Delta X - \\mathbb{E}[\\Delta X]}{\\sigma_{\\Delta X}} = \\frac{(X_2 - X_1) - 0}{\\sqrt{2(1 - r)\\sigma^2}} = \\frac{X_2 - X_1}{\\sqrt{2(1 - r)\\sigma^2}}$$\n    此公式是可靠变化指数 (Reliable Change Index, RCI) 的一种标准形式。为使z统计量服从标准正态分布，我们还必须假设误差项 $E_1$ 和 $E_2$ 是正态分布的。\n\n**2. 为患者计算**\n\n使用所提供的数据：\n*   $X_1 = 35$\n*   $X_2 = 29$\n*   $r = 0.90$\n*   $\\sigma = 8$，所以 $\\sigma^2 = 8^2 = 64$\n\n观测到的变化是 $X_2 - X_1 = 29 - 35 = -6$。\n分母（差异标准误）为：\n$\\sigma_{\\Delta X} = \\sqrt{2(1 - 0.90)(64)} = \\sqrt{2(0.10)(64)} = \\sqrt{0.2 \\times 64} = \\sqrt{12.8}$。\n\nz指数为：\n$z = \\frac{-6}{\\sqrt{12.8}} \\approx \\frac{-6}{3.5777} \\approx -1.6769$。\n\n四舍五入到两位小数，$z \\approx -1.68$。\n\n**3. 统计结论**\n\n对于 $\\alpha = 0.05$ 的双尾检验，标准正态分布的临界值为 $z_{critical} = \\pm 1.96$。\n计算出的值为 $z = -1.68$。\n我们必须将计算出的统计量的绝对值与临界值进行比较：$|-1.68| = 1.68$。\n由于 $1.68  1.96$，计算出的z分数没有落入拒绝域。结果不具有统计显著性。我们未能拒绝真实分数无变化的零假设。观测到的下降与仅由测量误差可能预期到的情况是一致的。\n\n**4. 假设总结**\n此程序的有效性取决于：\n1.  CTT 模型（$X=T+E$ 等）。\n2.  工具属性：具有相等信度 ($r$) 和误差方差 ($\\sigma_E^2$) 的平行版本。\n3.  评估随时间变化的具体条件：$H_0$ 下的稳定真实分数、独立的误差和可忽略的练习效应。\n4.  参数 $r$ 和 $\\sigma^2$ 对该个体是合适的（即，从相关的、匹配的样本中估计得出）。信度 $r$ 必须是重测信度，以捕捉重测间隔内的误差方差。\n5.  假设检验的统计假设：变化分数（以及因此的基础误差分布）的分布必须近似正态，以证明使用如 $\\pm 1.96$ 等标准正态临界值是合理的。\n\n### 逐项分析选项\n\n**A. 标准化变化指数为 $(X_2 - X_1)/\\sqrt{2(1 - r)\\sigma^2}$。其有效性条件为：CTT 成立，两次测量为信度相等的平行版本，误差项在两次测量中独立、方差相等且均值为 $0$，误差方差在所考虑的能力范围内是方差齐性的，任何练习效应均可忽略不计（或已被移除），且误差分布近似正态分布以适用z阈值。信度 $r$ 是在匹配的稳定样本中估计的重测信度，$\\sigma^2$ 是该样本的观测分数方差。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-1.68$，未超过双尾 $\\alpha = 0.05$ 的临界值 $\\pm 1.96$，因此该下降未超出测量误差范围。**\n\n*   **公式**：公式 $(X_2 - X_1)/\\sqrt{2(1 - r)\\sigma^2}$ 与推导出的公式相同。**正确**。\n*   **假设**：所列的假设是全面且准确的。它正确地指出了 CTT 的核心原则、变化分数模型的条件（平行版本、独立误差等）、使用重测信度的必要性以及z检验需要正态误差分布。**正确**。\n*   **计算**：计算值 $-1.68$与推导结果相符。**正确**。\n*   **结论**：由于 $|-1.68|  1.96$，变化不显著的统计结论也是正确的。**正确**。\n\n此选项的所有部分均正确。\n**结论：正确**\n\n**B. 标准化变化指数为 $(X_2 - X_1)/\\sqrt{2 r \\sigma^2}$。它仅要求版本是平行的；内部一致性信度可以替代重测信度，且z阈值不需要正态性。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-0.56$，在 $\\alpha = 0.05$ 双尾水平下不显著。**\n\n*   **公式**：分母为 $\\sqrt{2 r \\sigma^2}$，它使用的是 $r$ 而不是 $(1-r)$。这从根本上是错误的。项 $r \\sigma^2$ 是真实分数方差 $\\mathrm{Var}(T)$，与此处所需的误差方差无关。**错误**。\n*   **假设**：声称内部一致性信度（例如克朗巴赫α系数）可以替代重测信度在此应用中是错误的。内部一致性忽略了随时间变化的误差来源（例如，特定场合的波动），从而低估了总误差并人为地夸大了变化指数。声称z阈值不需要正态性也是错误的；这些阈值直接从标准正态分布推导出来。**错误**。\n\n**结论：错误**\n\n**C. 标准化变化指数为 $(X_2 - X_1)/\\sqrt{(1 - r)\\sigma^2}$，这反映了如果误差随时间相关，则在重测时只有一个误差项起作用。它假设误差相关且无练习效应，并允许使用患者的基线变异性来代替 $\\sigma$。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-2.37$，表明在 $\\alpha = 0.05$ 双尾水平下有显著下降。**\n\n*   **公式**：分母 $\\sqrt{(1 - r)\\sigma^2}$ 是测量标准误 (Standard Error of Measurement, SEM) 即 $\\sigma_E$ 的公式，而不是差异标准误 (Standard Error of Difference, SED) 的公式。它缺少了由两个误差项组合而来的因子 $2$。**错误**。\n*   **假设**：它错误地陈述模型假设误差是相关的。推导过程明确假设误差是*独立的*。它还荒谬地建议使用“患者的基线变異性”，这是一个无法从单个数据点确定的量。**错误**。\n\n**结论：错误**\n\n**D. 标准化变化指数为 $(X_2 - X_1 - \\mu_{\\mathrm{retest}})/\\sqrt{2(1 - r)\\sigma^2}$，其中 $\\mu_{\\mathrm{retest}}$ 是来自任何参考组的预期平均重测增益；因为 MCI 中的练习效应通常很小，$\\mu_{\\mathrm{retest}}$ 可以设为 $0$ 而不失有效性，并且克朗巴赫α系数可用于 $r$。z阈值不需要误差的正态性。当 $X_1 = 35$，$X_2 = 29$，$r = 0.90$，$\\sigma = 8$ 时，该指数约等于 $-1.68$，在 $\\alpha = 0.05$ 双尾水平下不显著。**\n\n*   **公式**：虽然这个公式正确地推广了该指数以考虑练习效应（$\\mu_{\\mathrm{retest}}$），但问题陈述明确假设练习效应可以忽略不计，使得 $\\mu_{\\mathrm{retest}}=0$。因此，尽管该公式是一个有效的心理测量学结构，但围绕它的理由是有缺陷的。\n*   **假设**：声称克朗巴赫α系数可用于 $r$ 是一个关键错误，如选项 B 所解释。声称z阈值不需要正态性也是错误的，如选项 B 所解释。断言可以根据关于 MCI 的一般启发式方法將 $\\mu_{\\mathrm{retest}}$ 设为 $0$ 而“不失有效性”，这并不能很好地替代问题中明确的、针对具体案例的假设。**错误**。\n\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "4496192"}, {"introduction": "确定MCI的潜在病因（如阿尔茨海默病）是实现精准诊断和治疗的前提，这日益依赖于整合来自多个数据源的信息。本高级练习模拟了这一前沿诊断过程，指导您构建一个朴素贝叶斯分类器。您将学习如何在一个概率框架下，融合神经心理学分数、影像学测量和脑脊液生物标志物数据，从而估算MCI由阿尔茨海默病所致的后验概率 [@problem_id:4496161]。", "problem": "您需要形式化并实现一个规范的贝叶斯分类器，用以估计轻度认知障碍患者的病因是阿尔茨海默病的后验概率。该分类器的构建必须从贝叶斯定理的基本定义和标准分布假设出发。您必须整合多种模态的数据：神经心理学评分、结构磁共振成像和脑脊液生物标志物。这个问题是纯数学问题；所有必需的参数均已指定，您将根据下面描述的测试套件计算数值输出。\n\n假设存在以下生成模型。设类别标签为 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示由阿尔茨海默病引起的轻度认知障碍，而 $Y=0$ 表示非由阿尔茨海默病引起的轻度认知障碍。特征向量为 $X = (S,H,A,T)$，其中 $S$ 是神经心理学综合 $z$-分数（无单位），$H$ 是源自结构磁共振成像的海马体体积 $z$-分数（无单位），$A$ 是脑脊液淀粉样蛋白-beta 42（$\\mathrm{pg/mL}$），而 $T$ 是脑脊液磷酸化 tau 181 蛋白（$\\mathrm{pg/mL}$）。先验概率为 $P(Y=1)=\\pi$（其中 $\\pi = 0.4$）和 $P(Y=0)=1-\\pi$。\n\n以 $Y=y$ 为条件，并假设特征之间条件独立且服从高斯似然。对于索引为 $j \\in \\{S,H,A,T\\}$ 的每个特征 $X_j$ 和类别 $y \\in \\{0,1\\}$，\n$$\nX_j \\mid (Y=y) \\sim \\mathcal{N}\\!\\left(\\mu_{j,y}, \\sigma_{j,y}^2\\right).\n$$\n使用以下类条件参数（所有数值均采用上文指定的自然单位）：\n\n- 对于 $Y=1$ (阿尔茨海默病)：\n  - $S$: $\\mu_{S,1} = -1.5$, $\\sigma_{S,1} = 0.5$.\n  - $H$: $\\mu_{H,1} = -1.0$, $\\sigma_{H,1} = 0.6$.\n  - $A$: $\\mu_{A,1} = 450.0$, $\\sigma_{A,1} = 80.0$.\n  - $T$: $\\mu_{T,1} = 80.0$, $\\sigma_{T,1} = 15.0$.\n\n- 对于 $Y=0$ (非阿尔茨海默病)：\n  - $S$: $\\mu_{S,0} = -0.75$, $\\sigma_{S,0} = 0.5$.\n  - $H$: $\\mu_{H,0} = -0.3$, $\\sigma_{H,0} = 0.6$.\n  - $A$: $\\mu_{A,0} = 800.0$, $\\sigma_{A,0} = 100.0$.\n  - $T$: $\\mu_{T,0} = 45.0$, $\\sigma_{T,0} = 10.0$.\n\n您的任务是，对于测试套件中的每个观测到的特征向量 $x=(s,h,a,t)$，使用以下基本表达式计算后验概率 $P(Y=1 \\mid X=x)$：\n$$\nP(Y=1 \\mid X=x) \\;=\\; \\frac{P(Y=1)\\, \\prod_{j \\in \\mathcal{O}(x)} f_{j,1}(x_j)}{\\sum_{y \\in \\{0,1\\}} P(Y=y)\\, \\prod_{j \\in \\mathcal{O}(x)} f_{j,y}(x_j)},\n$$\n其中 $f_{j,y}(\\cdot)$ 表示参数为 $(\\mu_{j,y},\\sigma_{j,y}^2)$ 的单变量高斯密度，而 $\\mathcal{O}(x)$ 是 $x$ 中已观测（非缺失）特征的索引集。如果一个特征值缺失，它将由特殊标记 $\\mathrm{NaN}$ 表示，并且必须在独立性和高斯假设下通过精确边缘化来处理，这等同于在计算两个类别的似然项乘积时都省略该特征。为确保对极端输入的数值稳定性，请使用对数和 log-sum-exp 变换来计算密度乘积和归一化。\n\n测试套件。对于以下各种情况，计算标量后验概率 $P(Y=1 \\mid X=x)$，并将其报告为四舍五入到 $6$ 位小数的小数。\n\n- 情况 A: $x = (s,h,a,t) = (-1.4,-0.9,430.0,85.0)$。\n- 情况 B: $x = (s,h,a,t) = (-1.0,-0.7,650.0,60.0)$。\n- 情况 C: $x = (s,h,a,t) = (-0.5,0.0,900.0,40.0)$。\n- 情况 D: $x = (s,h,a,t) = (-1.3,-1.1,\\mathrm{NaN},70.0)$。\n- 情况 E: $x = (s,h,a,t) = (-0.6,-0.2,420.0,45.0)$。\n- 情况 F: $x = (s,h,a,t) = (-3.0,-2.5,350.0,120.0)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含按 A、B、C、D、E、F 顺序排列的结果，形式为一个包含在方括号中的、以逗号分隔的列表。每个元素必须是四舍五入到 $6$ 位小数的十进制浮点数。例如，包含三个情况的输出将遵循 $\\texttt{[0.123456,0.654321,0.500000]}$ 的模式。", "solution": "目标是计算在给定观测到的生物标志物向量 $X=x$ 的情况下，患者因阿尔茨海默病而出现轻度认知障碍的后验概率，记作 $P(Y=1 \\mid X=x)$。该问题提供了一个基于朴素贝叶斯分类器的生成模型，该分类器对四个特征使用高斯似然：神经心理学评分 $S$、海马体体积 $H$、脑脊液淀粉样蛋白-beta $A$ 和脑脊液磷酸化 tau $T$。\n\n此计算的基本原理是贝叶斯定理，其表述如下：\n$$\nP(Y=1 \\mid X=x) = \\frac{P(X=x \\mid Y=1) P(Y=1)}{P(X=x)}\n$$\n项 $P(X=x)$ 是观测到数据的边缘概率，它作为归一化常数。通过对所有可能的类别求和来计算：\n$$\nP(X=x) = \\sum_{y \\in \\{0,1\\}} P(X=x \\mid Y=y) P(Y=y)\n$$\n将此代入主方程，得到后验概率的完整表达式：\n$$\nP(Y=1 \\mid X=x) = \\frac{P(X=x \\mid Y=1) P(Y=1)}{P(X=x \\mid Y=1) P(Y=1) + P(X=x \\mid Y=0) P(Y=0)}\n$$\n问题指定了先验概率 $P(Y=1) = \\pi = 0.4$ 和 $P(Y=0) = 1-\\pi = 0.6$。\n\n项 $P(X=x \\mid Y=y)$ 是特征向量 $x=(s,h,a,t)$ 的类条件似然。朴素贝叶斯模型的一个关键假设是特征在给定类别标签 $Y$ 的情况下条件独立。这使我们能够将联合似然表示为单个特征似然的乘积：\n$$\nP(X=x \\mid Y=y) = P(S=s \\mid Y=y) \\cdot P(H=h \\mid Y=y) \\cdot P(A=a \\mid Y=y) \\cdot P(T=t \\mid Y=y)\n$$\n设特征索引为 $j \\in \\{S, H, A, T\\}$。对于每个特征 $X_j$，其似然由一个单变量高斯（正态）概率密度函数 (PDF) $f_{j,y}(x_j)$ 建模，该函数具有特定于类的参数 $(\\mu_{j,y}, \\sigma_{j,y}^2)$：\n$$\nf_{j,y}(x_j) = P(X_j=x_j \\mid Y=y) = \\frac{1}{\\sqrt{2\\pi\\sigma_{j,y}^2}} \\exp\\left(-\\frac{(x_j - \\mu_{j,y})^2}{2\\sigma_{j,y}^2}\\right)\n$$\n该问题要求处理以 $\\mathrm{NaN}$ 表示的缺失数据。在条件独立性假设下，处理缺失特征的正确方法是在分子和分母的乘积中都省略其对应的似然项。这等同于将缺失特征边缘化。\n\n直接计算小概率密度的乘积可能导致数值下溢。为确保稳定性，我们在对数域中进行计算。设 $\\ell_y$ 为类别 $y$ 的未归一化后验概率的对数：\n$$\n\\ell_y = \\log \\left( P(Y=y) \\prod_{j \\in \\mathcal{O}(x)} f_{j,y}(x_j) \\right) = \\log(P(Y=y)) + \\sum_{j \\in \\mathcal{O}(x)} \\log(f_{j,y}(x_j))\n$$\n其中 $\\mathcal{O}(x)$ 是 $x$ 中已观测（非缺失）特征的索引集。高斯分布的对数概率密度函数为：\n$$\n\\log(f_{j,y}(x_j)) = -\\frac{(x_j - \\mu_{j,y})^2}{2\\sigma_{j,y}^2} - \\log(\\sigma_{j,y}) - \\frac{1}{2}\\log(2\\pi)\n$$\n我们使用给定的参数计算 $\\ell_1$ 和 $\\ell_0$。然后，后验概率 $P(Y=1 \\mid X=x)$ 可以恢复为：\n$$\nP(Y=1 \\mid X=x) = \\frac{\\exp(\\ell_1)}{\\exp(\\ell_1) + \\exp(\\ell_0)}\n$$\n一种更鲁棒的计算方法是使用对数优势比的 logistic sigmoid 函数，这样可以避免指数运算中出现巨大的中间值。对数优势比为 $\\Lambda = \\ell_1 - \\ell_0$。后验概率则为：\n$$\nP(Y=1 \\mid X=x) = \\frac{1}{1 + \\exp(-(\\ell_1 - \\ell_0))} = \\frac{1}{1+\\exp(-\\Lambda)}\n$$\n该公式在数值上是稳定的，并能直接得出所需的概率。\n\n对于每个测试用例 $x=(s,h,a,t)$ 的算法步骤如下：\n1.  用对数先验初始化对数未归一化后验：\n    -   $\\ell_1 = \\log(\\pi) = \\log(0.4)$\n    -   $\\ell_0 = \\log(1-\\pi) = \\log(0.6)$\n2.  对于向量 $x$ 中的每个具有观测值 $x_j$ 的特征 $X_j$：\n    a. 使用参数 $(\\mu_{j,1}, \\sigma_{j,1}^2)$ 计算阿尔茨海默病类别 ($Y=1$) 的对数似然：$\\log(f_{j,1}(x_j))$。\n    b. 将此值加到 $\\ell_1$ 上。\n    c. 使用参数 $(\\mu_{j,0}, \\sigma_{j,0}^2)$ 计算非阿尔茨海默病类别 ($Y=0$) 的对数似然：$\\log(f_{j,0}(x_j))$。\n    d. 将此值加到 $\\ell_0$ 上。\n    e. 如果特征值缺失 ($\\mathrm{NaN}$)，则对两个类别完全跳过该特征。\n3.  计算对数优势比：$\\Lambda = \\ell_1 - \\ell_0$。\n4.  计算阿尔茨海默病类别的最终后验概率：$P(Y=1 \\mid X=x) = \\frac{1}{1 + \\exp(-\\Lambda)}$。\n5.  按要求将结果四舍五入到6位小数。\n\n该过程将应用于所提供的六个测试用例中的每一个，从而得出最终的结果列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the posterior probability of Alzheimer's disease for patients with\n    mild cognitive impairment using a Naive Bayes classifier.\n    \"\"\"\n\n    # Define the prior probability for the Alzheimer's class (Y=1).\n    pi = 0.4\n    log_prior_1 = np.log(pi)\n    log_prior_0 = np.log(1 - pi)\n\n    # Define the class-conditional parameters (means and standard deviations).\n    # The structure is {feature: {'mu': [mu_0, mu_1], 'sigma': [sigma_0, sigma_1]}}.\n    params = {\n        'S': {'mu': [-0.75, -1.5], 'sigma': [0.5, 0.5]},\n        'H': {'mu': [-0.3, -1.0], 'sigma': [0.6, 0.6]},\n        'A': {'mu': [800.0, 450.0], 'sigma': [100.0, 80.0]},\n        'T': {'mu': [45.0, 80.0], 'sigma': [10.0, 15.0]}\n    }\n    feature_names = ['S', 'H', 'A', 'T']\n\n    # Define the test cases from the problem statement.\n    # Missing values are represented by np.nan.\n    test_cases_raw = [\n        (-1.4, -0.9, 430.0, 85.0),  # Case A\n        (-1.0, -0.7, 650.0, 60.0),  # Case B\n        (-0.5, 0.0, 900.0, 40.0),   # Case C\n        (-1.3, -1.1, np.nan, 70.0), # Case D\n        (-0.6, -0.2, 420.0, 45.0),  # Case E\n        (-3.0, -2.5, 350.0, 120.0)  # Case F\n    ]\n\n    results = []\n    for case_values in test_cases_raw:\n        # Initialize log unnormalized posteriors with log priors.\n        log_posterior_unnorm_1 = log_prior_1\n        log_posterior_unnorm_0 = log_prior_0\n\n        # Iterate through each observed feature and add its log-likelihood.\n        for i, value in enumerate(case_values):\n            if not np.isnan(value):\n                feature = feature_names[i]\n                \n                # Parameters for class Y=0 (non-Alzheimer's)\n                mu0 = params[feature]['mu'][0]\n                sigma0 = params[feature]['sigma'][0]\n                \n                # Parameters for class Y=1 (Alzheimer's)\n                mu1 = params[feature]['mu'][1]\n                sigma1 = params[feature]['sigma'][1]\n                \n                # Calculate log-likelihoods using scipy's stable function.\n                log_lik_0 = norm.logpdf(value, loc=mu0, scale=sigma0)\n                log_lik_1 = norm.logpdf(value, loc=mu1, scale=sigma1)\n                \n                log_posterior_unnorm_0 += log_lik_0\n                log_posterior_unnorm_1 += log_lik_1\n        \n        # Calculate the log-odds ratio.\n        log_odds_ratio = log_posterior_unnorm_1 - log_posterior_unnorm_0\n        \n        # Convert log-odds to probability using the logistic sigmoid function.\n        # This is a numerically stable way to compute exp(l1) / (exp(l0) + exp(l1)).\n        prob_1 = 1 / (1 + np.exp(-log_odds_ratio))\n        \n        # Format the result to 6 decimal places.\n        results.append(f\"{prob_1:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4496161"}]}