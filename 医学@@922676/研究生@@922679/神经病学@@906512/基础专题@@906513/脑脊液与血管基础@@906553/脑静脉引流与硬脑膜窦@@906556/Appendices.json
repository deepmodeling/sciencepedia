{"hands_on_practices": [{"introduction": "要掌握整个静脉系统的血液动力学，我们必须首先理解其基本组成部分的行为。本练习将基础的哈根-泊肃叶方程 (Hagen-Poiseuille equation) 应用于一段硬脑膜静脉窦，让你能够计算压力降，并体会为何这些大口径血管是如此高效、低阻力的大脑引流通道。[@problem_id:4467210]", "problem": "一个硬脑膜静脉窦段被近似为一个横截面均匀的刚性圆形导管。假设为牛顿流体的稳态、不可压缩、轴对称层流。一段均匀的静脉窦半径为 $r=4\\ \\text{mm}$，动力粘度为 $\\mu=3.5\\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$，长度为 $L=30\\ \\text{cm}$，体积流量为 $Q=6\\ \\text{ml/s}$。从适用于圆形管道中粘性流动的连续介质力学平衡方程出发，推导连接轴向压降 $\\Delta P$ 与体积流量 $Q$ 之间的关系，然后计算该段的 $\\Delta P$。将最终的 $\\Delta P$ 以毫米汞柱 (mmHg) 表示，并四舍五入到三位有效数字。最后，从生理学角度简要解释所计算的 $\\Delta P$ 的量级与硬脑膜静脉窦中的脑静脉引流的关系。", "solution": "该问题需经过验证。\n\n### 步骤 1：提取已知条件\n-   **模型：**一个硬脑膜静脉窦段被近似为一个横截面均匀的刚性圆形导管。\n-   **流动条件：**稳态、不可压缩、轴对称层流。\n-   **流体性质：**牛顿流体，动力粘度 $\\mu=3.5\\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$。\n-   **几何参数：**半径 $r=4\\ \\text{mm}$，长度 $L=30\\ \\text{cm}$。\n-   **流量：**体积流量 $Q=6\\ \\text{ml/s}$。\n-   **目标 1：**从连续介质力学平衡方程出发，推导连接轴向压降 $\\Delta P$ 与体积流量 $Q$ 之间的关系。\n-   **目标 2：**计算该段的 $\\Delta P$。\n-   **目标 3：**将最终的 $\\Delta P$ 以毫米汞柱 (mmHg) 表示，并四舍五入到三位有效数字。\n-   **目标 4：**从生理学角度简要解释结果的量级。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：**该问题是流体动力学在简化血流模型中的一个经典应用。其控制原理（用于粘性流动的Navier-Stokes方程）是基础性的。模型假设（刚性管道中的稳态、层流、不可压缩、牛顿流体流动）是进行动脉或大血管静脉流动一阶分析（即哈根-泊肃叶流）的标准假设。所提供的血液粘度、静脉窦尺寸和流量值对于一个主要的硬脑膜静脉窦来说在生理上是合理的。\n-   **适定性：**该问题是适定的。所提供的数据和明确陈述的假设足以推导出所需的关系并计算出压降的唯一值。\n-   **客观性：**问题以精确、客观的语言陈述，没有主观或非科学的主张。\n-   **结论：**该问题没有科学上的不健全、模糊不清和内部矛盾。这是一个生物物理流体动力学中有效且适定的问题。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n推导始于不可压缩牛顿流体的Navier-Stokes方程，用圆柱坐标 $(R, \\theta, z)$ 表示，其中 $z$ 是导管的轴向。动量平衡的轴向分量为：\n$$ \\rho \\left( \\frac{\\partial v_z}{\\partial t} + v_R \\frac{\\partial v_z}{\\partial R} + \\frac{v_\\theta}{R} \\frac{\\partial v_z}{\\partial \\theta} + v_z \\frac{\\partial v_z}{\\partial z} \\right) = -\\frac{\\partial P}{\\partial z} + \\mu \\left[ \\frac{1}{R} \\frac{\\partial}{\\partial R} \\left( R \\frac{\\partial v_z}{\\partial R} \\right) + \\frac{1}{R^2} \\frac{\\partial^2 v_z}{\\partial \\theta^2} + \\frac{\\partial^2 v_z}{\\partial z^2} \\right] + \\rho g_z $$\n我们应用问题中给出的简化假设：\n1.  **稳态流：**所有时间导数均为零，因此 $\\frac{\\partial v_z}{\\partial t} = 0$。\n2.  **轴对称流：**切向没有变化，因此 $\\frac{\\partial}{\\partial \\theta} = 0$。切向速度分量为零， $v_\\theta=0$。\n3.  **充分发展的层流：**速度剖面沿轴向恒定，因此 $\\frac{\\partial v_z}{\\partial z} = 0$。对于在横截面恒定的管道中的不可压缩流体，连续性方程 $\\nabla \\cdot \\mathbf{v} = 0$ 得以简化，并结合壁面上的无滑移条件，意味着径向速度分量也为零， $v_R=0$。\n4.  重力体力 $\\rho g_z$ 被假定为可忽略不计或已包含在压力项 $P$ 中。\n\n应用这些简化后，动量方程大大简化。左侧的所有项（对流加速度）都变为零。粘度括号内的第二项和第三项也变为零。方程简化为：\n$$ 0 = -\\frac{dP}{dz} + \\frac{\\mu}{R} \\frac{d}{dR} \\left( R \\frac{d v_z}{dR} \\right) $$\n在这里，我们使用全导数，因为可以证明压力 $P$ 仅是 $z$ 的函数，而轴向速度 $v_z$ 仅是 $R$ 的函数。重排此常微分方程得到：\n$$ \\frac{d}{dR} \\left( R \\frac{d v_z}{dR} \\right) = \\frac{R}{\\mu} \\frac{dP}{dz} $$\n对 $R$ 积分一次：\n$$ R \\frac{d v_z}{dR} = \\frac{R^2}{2\\mu} \\frac{dP}{dz} + C_1 $$\n除以 $R$ 并进行第二次积分：\n$$ v_z(R) = \\frac{R^2}{4\\mu} \\frac{dP}{dz} + C_1 \\ln(R) + C_2 $$\n为了确定积分常数 $C_1$ 和 $C_2$，我们应用边界条件：\n1.  在管道中心线（$R=0$）处，速度必须是有限的。由于当 $R \\to 0$ 时 $\\ln(R)$ 趋近于 $-\\infty$，我们必须有 $C_1 = 0$ 以避免物理上不可能的无限大速度。\n2.  在管壁（$R=r$）处的无滑移条件要求流体速度为零：$v_z(r) = 0$。\n    $$ 0 = \\frac{r^2}{4\\mu} \\frac{dP}{dz} + C_2 \\implies C_2 = -\\frac{r^2}{4\\mu} \\frac{dP}{dz} $$\n将常数代回速度方程，得到抛物线速度剖面：\n$$ v_z(R) = \\frac{1}{4\\mu} \\frac{dP}{dz} (R^2 - r^2) $$\n由于我们预期压力会沿流动方向降低，压力梯度 $\\frac{dP}{dz}$ 是负的。对于长度为 $L$、总压降为 $\\Delta P = P_{in} - P_{out}$ 的管道，我们可以将恒定的压力梯度近似为 $\\frac{dP}{dz} = -\\frac{\\Delta P}{L}$。代入后得到：\n$$ v_z(R) = \\frac{\\Delta P}{4\\mu L} (r^2 - R^2) $$\n体积流量 $Q$ 是通过将此速度剖面在圆形横截面上积分得到的，其面积微元为 $dA = 2\\pi R dR$：\n$$ Q = \\int_0^r v_z(R) (2\\pi R) dR = \\int_0^r \\frac{\\Delta P}{4\\mu L} (r^2 - R^2) (2\\pi R) dR $$\n$$ Q = \\frac{2\\pi \\Delta P}{4\\mu L} \\int_0^r (r^2 R - R^3) dR = \\frac{\\pi \\Delta P}{2\\mu L} \\left[ \\frac{r^2 R^2}{2} - \\frac{R^4}{4} \\right]_0^r $$\n$$ Q = \\frac{\\pi \\Delta P}{2\\mu L} \\left( \\frac{r^4}{2} - \\frac{r^4}{4} \\right) = \\frac{\\pi \\Delta P}{2\\mu L} \\left( \\frac{r^4}{4} \\right) $$\n这就得到了哈根-泊肃叶方程：\n$$ Q = \\frac{\\pi r^4}{8\\mu L} \\Delta P $$\n问题要求推导连接压降 $\\Delta P$ 与流量 $Q$ 的关系。求解 $\\Delta P$ 可得：\n$$ \\Delta P = \\frac{8\\mu L Q}{\\pi r^4} $$\n推导完成。\n\n接下来，我们计算 $\\Delta P$ 的值。所有给定值必须转换为一致的国际单位制单位（米、千克、秒）。\n-   $r = 4\\ \\text{mm} = 4 \\times 10^{-3}\\ \\text{m}$\n-   $\\mu = 3.5 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$\n-   $L = 30\\ \\text{cm} = 0.30\\ \\text{m}$\n-   $Q = 6\\ \\text{ml/s} = 6\\ \\text{cm}^3/\\text{s} = 6 \\times (10^{-2}\\ \\text{m})^3/\\text{s} = 6 \\times 10^{-6}\\ \\text{m}^3/\\text{s}$\n\n在计算之前，我们验证“层流”假设是否一致。这需要计算雷诺数，$Re = \\frac{\\rho v_m D}{\\mu}$，其中 $v_m$ 是平均速度，$D$ 是直径，$\\rho$ 是流体密度。问题未提供血液密度，因此我们假定一个标准的生理值 $\\rho \\approx 1060\\ \\text{kg}/\\text{m}^3$。平均速度是 $v_m = \\frac{Q}{A} = \\frac{Q}{\\pi r^2}$，直径是 $D=2r$。\n$$ Re = \\frac{\\rho (\\frac{Q}{\\pi r^2}) (2r)}{\\mu} = \\frac{2\\rho Q}{\\pi r \\mu} $$\n$$ Re = \\frac{2(1060)(6 \\times 10^{-6})}{\\pi (4 \\times 10^{-3})(3.5 \\times 10^{-3})} \\approx \\frac{1.272 \\times 10^{-2}}{4.398 \\times 10^{-5}} \\approx 289 $$\n由于 $Re \\approx 289$ 远低于管道中向湍流过渡的典型临界值（$Re_{crit} \\approx 2300$），因此层流的初始假设是有效的。\n\n现在，我们将国际单位制的值代入推导出的压降方程：\n$$ \\Delta P = \\frac{8(3.5 \\times 10^{-3})(0.30)(6 \\times 10^{-6})}{\\pi (4 \\times 10^{-3})^4} $$\n$$ \\Delta P = \\frac{5.04 \\times 10^{-8}}{\\pi (256 \\times 10^{-12})} = \\frac{5.04 \\times 10^{-8}}{8.0425 \\times 10^{-10}} \\approx 62.669\\ \\text{Pa} $$\n问题要求答案以毫米汞柱 (mmHg) 表示。标准换算关系为 $1\\ \\text{atm} = 760\\ \\text{mmHg} = 101325\\ \\text{Pa}$。因此，$1\\ \\text{mmHg} \\approx 133.322\\ \\text{Pa}$。\n$$ \\Delta P_{\\text{mmHg}} = \\frac{\\Delta P_{\\text{Pa}}}{133.322\\ \\text{Pa/mmHg}} = \\frac{62.669}{133.322} \\approx 0.4700\\ \\text{mmHg} $$\n四舍五入到三位有效数字，压降为 $0.470\\ \\text{mmHg}$。\n\n最后，需要进行简要的生理学解释。正常的颅内压 (ICP) 通常低于 $15\\ \\text{mmHg}$。硬脑膜静脉窦是从大脑引流静脉血的主要通道，其内部压力是ICP的关键决定因素。在 $30\\ \\text{cm}$ 这样一段相当长的距离上，计算出的压降 $\\Delta P \\approx 0.470\\ \\text{mmHg}$ 是一个非常小的梯度。这个结果定量地表明，大直径的硬脑膜静脉窦是阻力极低的通路。这种低阻力对于确保有效的脑静脉引流和最小的背压至关重要，这有助于维持低而稳定的颅内压，对正常的大脑功能至关重要。", "answer": "$$\n\\boxed{0.470}\n$$", "id": "4467210"}, {"introduction": "大脑静脉解剖结构常常表现出显著的变异，例如横窦的非对称性就十分常见。本练习将此情景建模为一个并联液压回路，要求你预测血流如何在优势窦和较小窦之间进行分配。这个练习有力地展示了血管半径对血液动力学传导率和流量分布的巨大影响 ($G \\propto r^4$)。[@problem_id:4467245]", "problem": "一名患者的双侧横窦不对称，经高分辨率静脉造影测量其半径为：右横窦半径 $r_{R} = 5\\ \\text{mm}$，左横窦半径 $r_{L} = 3\\ \\text{mm}$。假设从窦汇到乙状窦交界处的每段窦管均表现为内含牛顿流体层流的刚性圆柱形管道，且两段窦管长度均为 $L$，经历相同的压降 $\\Delta P$，动力黏度 $\\mu$ 均一。使用水力传导率 $G$ 作为体积流量 $Q$ 与压降 $\\Delta P$ 之间比例因子的定义，并以公认的哈根-泊肃叶关系为基本依据，推导左右横窦的相对传导率。然后，将两横窦建模为两条并联通路，从上矢状窦和直窦的汇合处接收总计 $Q_{\\text{total}} = 10\\ \\text{ml/s}$ 的体积流量，并预测分别流经左右通路的流量 $Q_{R}$ 和 $Q_{L}$。将两个流速均以毫升/秒为单位，表示为精确有理数。无需四舍五入。给出 $Q_{R}$ 和 $Q_{L}$ 的最终数值。", "solution": "对问题陈述的有效性进行评估。\n\n### 步骤 1：提取已知条件\n-   右横窦半径：$r_{R} = 5\\ \\text{mm}$\n-   左横窦半径：$r_{L} = 3\\ \\text{mm}$\n-   假设：窦管为刚性圆柱形管道。\n-   假设：血流为层流。\n-   假设：流体（血液）为牛顿流体。\n-   假设：两段窦管长度相等，为 $L$。\n-   假设：两段窦管经历相同的压降 $\\Delta P$。\n-   假设：动力黏度 $\\mu$ 均一。\n-   定义：水力传导率 $G$ 由 $Q = G \\Delta P$ 定义，其中 $Q$ 是体积流量。\n-   基本模型：哈根-泊肃叶关系。\n-   来自汇合处的总体积流量：$Q_{\\text{total}} = 10\\ \\text{ml/s}$。\n-   模型：两横窦被视为并联通路。\n-   目标：推导相对传导率，并预测流量 $Q_{R}$ 和 $Q_{L}$。\n-   要求输出格式：将 $Q_{R}$ 和 $Q_{L}$ 表示为以 ml/s 为单位的精确有理数。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于流体动力学的基石——哈根-泊肃叶方程。对于像硬脑膜窦这样的大血管中的血液，层流和牛顿流体行为的假设虽然是简化，但在初阶生物物理建模中是标准且可接受的。横窦不对称的解剖学前提以及给定的物理值（$r_R, r_L, Q_{\\text{total}}$）在生理上是合理的。\n-   **适定性**：该问题定义清晰且自成体系。它提供了所有必要的参数和一个明确定义的物理模型（并联液压回路），从而可以计算出流量分配的唯一、稳定解。\n-   **客观性**：该问题以精确、无偏见的科学语言陈述。\n\n### 步骤 3：结论与行动\n该问题被判定为有效。它具有科学依据，问题适定，且表述客观。它没有违反任何指定的无效标准。我们可以继续进行求解。\n\n求解始于哈根-泊肃叶方程，该方程描述了牛顿流体在长度为 $L$、半径为 $r$ 的刚性圆柱形管道中，在压降 $\\Delta P$ 驱动下层流时的体积流量 $Q$：\n$$Q = \\frac{\\pi r^4}{8 \\mu L} \\Delta P$$\n其中 $\\mu$ 是流体的动力黏度。\n\n问题将水力传导率 $G$ 定义为关系式 $Q = G \\Delta P$ 中的比例常数。通过将此定义与哈根-泊肃叶方程进行比较，我们可以将传导率表示为：\n$$G = \\frac{\\pi r^4}{8 \\mu L}$$\n该方程表明，传导率高度依赖于管道的半径，与半径的四次方成正比。\n\n我们现在可以写出右侧（$G_R$）和左侧（$G_L$）横窦的具体传导率：\n$$G_R = \\frac{\\pi r_{R}^4}{8 \\mu L}$$\n$$G_L = \\frac{\\pi r_{L}^4}{8 \\mu L}$$\n问题要求的是相对传导率。这最直接地表示为 $G_R$ 与 $G_L$ 的比值：\n$$\\frac{G_R}{G_L} = \\frac{\\frac{\\pi r_{R}^4}{8 \\mu L}}{\\frac{\\pi r_{L}^4}{8 \\mu L}} = \\left(\\frac{r_R}{r_L}\\right)^4$$\n公共因子 $\\pi$、$8$、$\\mu$ 和 $L$ 被消去，因为假设这些参数对于两个横窦是相同的。\n\n接下来，我们将两横窦建模为两条并联的液压通路。对于并联回路，适用两条原则：\n$1$. 总流量是各个分支流量之和：\n$$Q_{\\text{total}} = Q_R + Q_L$$\n$2$. 每个并联分支上的压降是相同的。这与问题初始设定的公共压降 $\\Delta P$ 的假设一致。\n$$Q_R = G_R \\Delta P$$\n$$Q_L = G_L \\Delta P$$\n\n从这些关系中，我们可以得出流量的比值：\n$$\\frac{Q_R}{Q_L} = \\frac{G_R \\Delta P}{G_L \\Delta P} = \\frac{G_R}{G_L}$$\n代入我们推导出的传导率比值表达式：\n$$\\frac{Q_R}{Q_L} = \\left(\\frac{r_R}{r_L}\\right)^4$$\n这表明总流量将按照两横窦各自半径的四次方成比例地在两者之间分配。\n\n我们得到了一个包含两个未知数 $Q_R$ 和 $Q_L$ 的双方程系统：\n$$Q_R + Q_L = Q_{\\text{total}}$$\n$$Q_R = Q_L \\left(\\frac{r_R}{r_L}\\right)^4$$\n将第二个方程代入第一个方程：\n$$Q_L \\left(\\frac{r_R}{r_L}\\right)^4 + Q_L = Q_{\\text{total}}$$\n$$Q_L \\left(1 + \\left(\\frac{r_R}{r_L}\\right)^4\\right) = Q_{\\text{total}}$$\n求解 $Q_L$：\n$$Q_L = Q_{\\text{total}} \\frac{1}{1 + \\frac{r_R^4}{r_L^4}} = Q_{\\text{total}} \\frac{r_L^4}{r_L^4 + r_R^4}$$\n同样地，我们可以求解 $Q_R$：\n$$Q_R = Q_{\\text{total}} \\frac{r_R^4}{r_L^4 + r_R^4}$$\n这些表达式根据每个通道的传导率（$r^4$）对总传导率（$r_R^4 + r_L^4$）的贡献来分配总流量。\n\n现在，我们代入给定的数值：\n$r_R = 5\\ \\text{mm}$\n$r_L = 3\\ \\text{mm}$\n$Q_{\\text{total}} = 10\\ \\text{ml/s}$\n\n首先，我们计算半径的四次方。在比值中单位是不需要的。\n$$r_R^4 = 5^4 = 625$$\n$$r_L^4 = 3^4 = 81$$\n这些值的和是：\n$$r_R^4 + r_L^4 = 625 + 81 = 706$$\n现在我们可以计算流量 $Q_R$ 和 $Q_L$：\n$$Q_R = (10\\ \\text{ml/s}) \\times \\frac{625}{706} = \\frac{6250}{706}\\ \\text{ml/s}$$\n$$Q_L = (10\\ \\text{ml/s}) \\times \\frac{81}{706} = \\frac{810}{706}\\ \\text{ml/s}$$\n问题要求答案为精确有理数。我们通过将分子和分母除以它们的最大公约数 $2$ 来简化分数。\n$$Q_R = \\frac{6250 \\div 2}{706 \\div 2} = \\frac{3125}{353}\\ \\text{ml/s}$$\n$$Q_L = \\frac{810 \\div 2}{706 \\div 2} = \\frac{405}{353}\\ \\text{ml/s}$$\n作为检验，我们可以将流量相加：\n$$Q_R + Q_L = \\frac{3125}{353} + \\frac{405}{353} = \\frac{3125 + 405}{353} = \\frac{3530}{353} = 10$$\n总和正确地等于总流量 $Q_{\\text{total}} = 10\\ \\text{ml/s}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3125}{353}  \\frac{405}{353} \\end{pmatrix}}$$", "id": "4467245"}, {"introduction": "在理解了单个组件之后，要理解复杂的静脉病理，系统层面的视角至关重要。这项高级实践要求你构建一个硬脑膜静脉窦网络的计算模型，将其视为一个电阻电路。通过在不同条件下求解该网络，你将深入了解诸如狭窄或下游压力变化等局部问题如何对整个大脑的血液动力学产生广泛影响。[@problem_id:4467211]", "problem": "构建一个程序来模拟简化的硬脑膜静脉窦血流动力学网络，该模型使用基于刚性管内层流的电阻网络抽象。在此模型中，每条边代表一个具有给定导水率（单位：毫升/秒/毫米汞柱，$\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$）的静脉窦段，每个节点代表一个具有标量压力（单位：毫米汞柱，$\\mathrm{mmHg}$）的连接点。边流量遵循由泊肃叶定律（Poiseuille’s law）推导出的线性本构关系，质量守恒在每个内部节点上均成立，并且某些节点具有代表源和汇的指定压力（狄利克雷边界条件，Dirichlet boundary conditions）。您的任务是计算边流量，并根据一个有原则的定量标准识别瓶颈段。\n\n基本原理和假设：\n- 节点 $i$ 和 $j$ 之间的边流量由 $Q_{ij} = G_{ij}\\,(P_i - P_j)$ 给出，其中 $Q_{ij}$ 的单位是 $\\mathrm{mL}/\\mathrm{s}$，$G_{ij}$ 是边的导水率，单位是 $\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$，$P_i, P_j$ 是压力，单位是 $\\mathrm{mmHg}$。这是稳态、层流条件下泊肃叶定律的线性电阻形式。\n- 每个内部节点 $k$ 的质量守恒要求 $\\sum_{m \\in \\mathcal{N}(k)} G_{km}\\,(P_k - P_m) = 0$，其中 $\\mathcal{N}(k)$ 表示网络中节点 $k$ 的邻居节点集合。\n- 具有狄利克雷边界条件的节点具有指定的压力，无需求解；所有其他节点的压力通过求解得到的线性系统来确定。\n\n网络定义（节点和边）：\n- 节点（及其索引和解剖学标签）：$0$（上矢状窦入口），$1$（直窦入口），$2$（窦汇，或称希罗菲勒斯氏汇 torcular Herophili），$3$（左横窦），$4$（右横窦），$5$（左乙状窦），$6$（右乙状窦），$7$（左颈内静脉球），$8$（右颈内静脉球）。\n- 边（及其索引、用于符号约定的方向和解剖学标签）：\n  - $0$：$(0 \\rightarrow 2)$ 上矢状窦至窦汇，\n  - $1$：$(1 \\rightarrow 2)$ 直窦至窦汇，\n  - $2$：$(2 \\rightarrow 3)$ 窦汇至左横窦，\n  - $3$：$(2 \\rightarrow 4)$ 窦汇至右横窦，\n  - $4$：$(3 \\rightarrow 5)$ 左横窦至左乙状窦，\n  - $5$：$(4 \\rightarrow 6)$ 右横窦至右乙状窦，\n  - $6$：$(5 \\rightarrow 7)$ 左乙状窦至左颈内静脉球，\n  - $7$：$(6 \\rightarrow 8)$ 右乙状窦至右颈内静脉球。\n\n边界条件：\n- 指定的（狄利克雷）节点压力：节点 $0$、$1$、$7$ 和 $8$ 具有指定的压力 $P_0$、$P_1$、$P_7$ 和 $P_8$（单位 $\\mathrm{mmHg}$）。所有其他节点的压力都是未知的，必须求解。\n\n流量计算和符号约定：\n- 对于每条导水率为 $G_e$ 的边 $e = (i \\rightarrow j)$，计算流量 $Q_e = G_e\\,(P_i - P_j)$（单位 $\\mathrm{mL}/\\mathrm{s}$）。$Q_e$ 为正表示流量沿所列的边方向；$Q_e$ 为负表示净流量与所列的边方向相反。\n\n瓶颈标准：\n- 将边上的功率耗散定义为 $D_e = Q_e^2 / G_e$，该公式由 $D_e = Q_e\\,\\Delta P_e$ 和 $\\Delta P_e = Q_e/G_e$ 推导而来。设总耗散为 $D_{\\mathrm{tot}} = \\sum_e D_e$。当 $D_{\\mathrm{tot}} > 0$ 时，定义耗散份额 $S_e = D_e / D_{\\mathrm{tot}}$，否则 $S_e = 0$。对于固定的阈值 $\\tau = 0.3$，如果 $S_e \\ge \\tau$，则判定该边为瓶颈。\n\n单位：\n- 压力必须以 $\\mathrm{mmHg}$ 为单位。\n- 导水率必须以 $\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$ 为单位。\n- 流量必须以 $\\mathrm{mL}/\\mathrm{s}$ 为单位报告。\n- 流量表示为四舍五入到六位小数的数值（数值四舍五入；数字输出中不包括单位）。\n\n角度单位不适用。如果需要任何比率，请用小数表示（不带百分号）。\n\n测试组：\n使用以下四个测试用例。每个测试用例提供：\n- 边的导水率向量 $\\mathbf{G} = [G_0,G_1,G_2,G_3,G_4,G_5,G_6,G_7]$，单位为 $\\mathrm{mL}/(\\mathrm{s}\\cdot\\mathrm{mmHg})$。\n- 节点 $0$、$1$、$7$、$8$ 处的指定压力，单位为 $\\mathrm{mmHg}$。\n- 所有情况下阈值固定为 $\\tau = 0.3$。\n\n情况 A（基线，左横窦发育不全）：\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.15,\\,0.6,\\,0.5,\\,0.6,\\,0.5,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 5$\n\n情况 B（对称横窦流出）：\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.6,\\,0.6,\\,0.6,\\,0.6,\\,0.6,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 5$\n\n情况 C（右颈静脉压力升高）：\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.4,\\,0.6,\\,0.5,\\,0.6,\\,0.5,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 8$\n\n情况 D（右横窦狭窄）：\n- $\\mathbf{G} = [\\,0.8,\\,0.7,\\,0.6,\\,0.02,\\,0.5,\\,0.6,\\,0.5,\\,0.6\\,]$\n- $P_0 = 12$, $P_1 = 11$, $P_7 = 5$, $P_8 = 5$\n\n要求的最终输出格式：\n- 对于每个测试用例，输出一个包含两个元素的列表：一个是边流量列表 $[Q_0,Q_1,\\dots,Q_7]$（单位 $\\mathrm{mL}/\\mathrm{s}$），每个值都按照上面定义的边顺序进行数值四舍五入至六位小数；另一个是满足 $S_e \\ge \\tau$ 的瓶颈边索引（整数）列表，按升序排序。\n- 将四个用例的结果聚合到一个列表中，并精确地打印一行，该行包含此聚合结果，格式为单个方括号括起来的、逗号分隔的列表。例如：\n  - $[\\,[\\,[q\\_0,\\dots,q\\_7],\\,[i\\_1,i\\_2,\\dots]\\,],\\,[\\,[\\dots],\\,[\\dots]\\,],\\,[\\,[\\dots],\\,[\\dots]\\,],\\,[\\,[\\dots],\\,[\\dots]\\,]\\,]$", "solution": "问题要求分析一个代表硬脑膜静脉窦的简化血流动力学网络。该网络被建模为一个线性电阻电路，其中血流类似于电流，压力差类似于电压，导水率类似于电导。主要任务是确定内部连接点（节点）的压力，计算通过每个血管段（边）的流速，并根据功率耗散标准识别瓶颈段。\n\n分析分为两个主要阶段：首先，通过建立并求解从质量守恒原理推导出的线性方程组来求解未知节点压力；其次，使用完整的节点压力集来计算边流量并评估瓶颈标准。\n\n首先，我们为未知压力建立线性系统。该网络有 $9$ 个节点，索引从 $0$到$8$。节点 $0$、$1$、$7$ 和 $8$ 的压力被指定为狄利克雷边界条件（$P_0, P_1, P_7, P_8$）。其余 $5$ 个内部节点（$P_2, P_3, P_4, P_5, P_6$）的压力是待确定的未知数。\n\n控制原理是不可压缩流体在稳态下的质量守恒，该原理规定流入任何内部节点的流量总和必须为零。从节点 $i$ 到节点 $j$ 的流量 $Q_{ij}$ 由线性本构关系 $Q_{ij} = G_{ij}\\,(P_i - P_j)$ 给出，其中 $G_{ij}$ 是导水率。因此，内部节点 $k$ 处的守恒定律是 $\\sum_{m \\in \\mathcal{N}(k)} Q_{km} = 0$，可以用压力表示为：\n$$\n\\sum_{m \\in \\mathcal{N}(k)} G_{km}\\,(P_k - P_m) = 0\n$$\n其中 $\\mathcal{N}(k)$ 是节点 $k$ 的邻居节点集合。将此应用于 $5$ 个内部节点中的每一个，得到一个包含 $5$ 个线性方程的方程组。边的导水率由向量 $\\mathbf{G} = [G_0, G_1, \\dots, G_7]$ 给出。连接关系为：$G_0=G_{02}$, $G_1=G_{12}$, $G_2=G_{23}$, $G_3=G_{24}$, $G_4=G_{35}$, $G_5=G_{46}$, $G_6=G_{57}$, $G_7=G_{68}$。\n\n内部节点的方程如下：\n1.  节点 $2$（窦汇）：邻居节点是 $0, 1, 3, 4$。\n    $G_{20}(P_2 - P_0) + G_{21}(P_2 - P_1) + G_{23}(P_2 - P_3) + G_{24}(P_2 - P_4) = 0$\n    使用边的导水率索引： $G_0(P_2 - P_0) + G_1(P_2 - P_1) + G_2(P_2 - P_3) + G_3(P_2 - P_4) = 0$\n2.  节点 $3$（左横窦）：邻居节点是 $2, 5$。\n    $G_{32}(P_3 - P_2) + G_{35}(P_3 - P_5) = 0 \\implies G_2(P_3 - P_2) + G_4(P_3 - P_5) = 0$\n3.  节点 $4$（右横窦）：邻居节点是 $2, 6$。\n    $G_{42}(P_4 - P_2) + G_{46}(P_4 - P_6) = 0 \\implies G_3(P_4 - P_2) + G_5(P_4 - P_6) = 0$\n4.  节点 $5$（左乙状窦）：邻居节点是 $3, 7$。\n    $G_{53}(P_5 - P_3) + G_{57}(P_5 - P_7) = 0 \\implies G_4(P_5 - P_3) + G_6(P_5 - P_7) = 0$\n5.  节点 $6$（右乙状窦）：邻居节点是 $4, 8$。\n    $G_{64}(P_6 - P_4) + G_{68}(P_6 - P_8) = 0 \\implies G_5(P_6 - P_4) + G_7(P_6 - P_8) = 0$\n\n设未知压力向量为 $\\mathbf{p} = [P_2, P_3, P_4, P_5, P_6]^T$。我们可以将上述方程重排为矩阵形式 $\\mathbf{A} \\mathbf{p} = \\mathbf{b}$：\n$$\n\\begin{pmatrix}\nG_0+G_1+G_2+G_3  -G_2  -G_3  0  0 \\\\\n-G_2  G_2+G_4  0  -G_4  0 \\\\\n-G_3  0  G_3+G_5  0  -G_5 \\\\\n0  -G_4  0  G_4+G_6  0 \\\\\n0  0  -G_5  0  G_5+G_7\n\\end{pmatrix}\n\\begin{pmatrix} P_2 \\\\ P_3 \\\\ P_4 \\\\ P_5 \\\\ P_6 \\end{pmatrix}\n=\n\\begin{pmatrix}\nG_0 P_0 + G_1 P_1 \\\\\n0 \\\\\n0 \\\\\nG_6 P_7 \\\\\nG_7 P_8\n\\end{pmatrix}\n$$\n使用标准的线性代数求解器求解该系统以得到 $\\mathbf{p}$。所得压力与边界值相结合，便得到整个网络的完整压力场。\n\n在确定所有节点压力后，每条边 $k=(i \\to j)$ 的流量 $Q_k$ 使用公式 $Q_k = G_k (P_i - P_j)$ 计算。边的方向在问题描述中已指定：\n- $Q_0 = G_0 (P_0 - P_2)$\n- $Q_1 = G_1 (P_1 - P_2)$\n- $Q_2 = G_2 (P_2 - P_3)$\n- $Q_3 = G_3 (P_2 - P_4)$\n- $Q_4 = G_4 (P_3 - P_5)$\n- $Q_5 = G_5 (P_4 - P_6)$\n- $Q_6 = G_6 (P_5 - P_7)$\n- $Q_7 = G_7 (P_6 - P_8)$\n\n最后，我们识别瓶颈段。由粘性力在边 $k$ 上耗散的功率为 $D_k = Q_k \\Delta P_k = Q_k (Q_k/G_k) = Q_k^2 / G_k$。如果 $G_k=0$，则没有流量通过，因此 $Q_k=0$ 且耗散 $D_k=0$。网络中的总耗散为 $D_{\\mathrm{tot}} = \\sum_k D_k$。每条边的耗散份额为 $S_k = D_k / D_{\\mathrm{tot}}$（如果 $D_{\\mathrm{tot}}=0$ 则定义为 $0$）。如果一条边 $k$ 的耗散份额 $S_k$ 大于或等于给定的阈值 $\\tau=0.3$，则该边被归类为瓶颈。\n\n每个测试用例的算法如下：\n1.  根据给定的导水率 $\\mathbf{G}$ 和边界压力 $P_0, P_1, P_7, P_8$ 构建 $5 \\times 5$ 矩阵 $\\mathbf{A}$ 和 $5 \\times 1$ 向量 $\\mathbf{b}$。\n2.  求解线性系统 $\\mathbf{A} \\mathbf{p} = \\mathbf{b}$ 以找到内部压力 $P_2, \\dots, P_6$。\n3.  使用完整的节点压力集计算流速 $Q_0, \\dots, Q_7$。\n4.  计算每条边的耗散 $D_k$、总耗散 $D_{\\mathrm{tot}}$ 和耗散份额 $S_k$。\n5.  识别所有满足 $S_k \\ge 0.3$ 的边的索引。\n6.  流量被数值四舍五入到六位小数，瓶颈索引列表被排序。结果按指定格式进行格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for flows and bottlenecks in a dural venous sinus network model.\n    \"\"\"\n    \n    test_cases = [\n        # Case A (baseline with hypoplastic left transverse sinus)\n        {\n            \"G\": [0.8, 0.7, 0.15, 0.6, 0.5, 0.6, 0.5, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 5},\n            \"tau\": 0.3\n        },\n        # Case B (symmetric transverse outflow)\n        {\n            \"G\": [0.8, 0.7, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 5},\n            \"tau\": 0.3\n        },\n        # Case C (elevated right jugular pressure)\n        {\n            \"G\": [0.8, 0.7, 0.4, 0.6, 0.5, 0.6, 0.5, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 8},\n            \"tau\": 0.3\n        },\n        # Case D (right transverse stenosis)\n        {\n            \"G\": [0.8, 0.7, 0.6, 0.02, 0.5, 0.6, 0.5, 0.6],\n            \"P_bc\": {\"P0\": 12, \"P1\": 11, \"P7\": 5, \"P8\": 5},\n            \"tau\": 0.3\n        }\n    ]\n\n    # Node indices: 0..8\n    # Edge indices: 0..7\n    # Unknown pressure vector p_sol corresponds to [P2, P3, P4, P5, P6]\n    \n    # Edge definitions: (from_node, to_node) for calculating flows\n    # Q_k = G_k * (P_from - P_to)\n    edge_node_map = [\n        (0, 2),  # Edge 0: SSS to Confluence\n        (1, 2),  # Edge 1: Straight Sinus to Confluence\n        (2, 3),  # Edge 2: Confluence to L. Transverse\n        (2, 4),  # Edge 3: Confluence to R. Transverse\n        (3, 5),  # Edge 4: L. Transverse to L. Sigmoid\n        (4, 6),  # Edge 5: R. Transverse to R. Sigmoid\n        (5, 7),  # Edge 6: L. Sigmoid to L. Jugular\n        (6, 8)   # Edge 7: R. Sigmoid to R. Jugular\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        G = case[\"G\"]\n        P_bc = case[\"P_bc\"]\n        tau = case[\"tau\"]\n\n        # Assemble the linear system Ap = b\n        # p = [P2, P3, P4, P5, P6]\n        A = np.zeros((5, 5))\n        b = np.zeros(5)\n\n        # Equation for Node 2\n        A[0, 0] = G[0] + G[1] + G[2] + G[3]\n        A[0, 1] = -G[2]\n        A[0, 2] = -G[3]\n        b[0] = G[0] * P_bc[\"P0\"] + G[1] * P_bc[\"P1\"]\n\n        # Equation for Node 3\n        A[1, 0] = -G[2]\n        A[1, 1] = G[2] + G[4]\n        A[1, 3] = -G[4]\n        # b[1] is 0\n\n        # Equation for Node 4\n        A[2, 0] = -G[3]\n        A[2, 2] = G[3] + G[5]\n        A[2, 4] = -G[5]\n        # b[2] is 0\n\n        # Equation for Node 5\n        A[3, 1] = -G[4]\n        A[3, 3] = G[4] + G[6]\n        b[3] = G[6] * P_bc[\"P7\"]\n\n        # Equation for Node 6\n        A[4, 2] = -G[5]\n        A[4, 4] = G[5] + G[7]\n        b[4] = G[7] * P_bc[\"P8\"]\n        \n        # Solve for unknown pressures\n        p_sol = np.linalg.solve(A, b)\n\n        # Reconstruct the full pressure vector [P0, P1, ..., P8]\n        P_full = np.zeros(9)\n        P_full[0] = P_bc[\"P0\"]\n        P_full[1] = P_bc[\"P1\"]\n        P_full[2:7] = p_sol\n        P_full[7] = P_bc[\"P7\"]\n        P_full[8] = P_bc[\"P8\"]\n        \n        # Calculate edge flows\n        Q = np.zeros(8)\n        for i in range(8):\n            n_from, n_to = edge_node_map[i]\n            Q[i] = G[i] * (P_full[n_from] - P_full[n_to])\n\n        # Calculate power dissipation and identify bottlenecks\n        D = np.zeros(8)\n        for i in range(8):\n            if G[i] > 1e-9:  # Avoid division by zero\n                D[i] = Q[i]**2 / G[i]\n            else:\n                D[i] = 0.0\n        \n        D_tot = np.sum(D)\n        \n        bottleneck_indices = []\n        if D_tot > 1e-9:\n            S = D / D_tot\n            for i in range(8):\n                if S[i] >= tau:\n                    bottleneck_indices.append(i)\n        \n        # Format results for this case\n        rounded_flows = [round(flow, 6) for flow in Q]\n        case_result = [rounded_flows, sorted(bottleneck_indices)]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(all_results)\n\nsolve()\n```", "id": "4467211"}]}