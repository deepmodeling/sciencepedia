{"hands_on_practices": [{"introduction": "尖峰时间依赖可塑性（Spike-Timing-Dependent Plasticity, STDP）是赫布学习理论的一种具体形式，它根据突触前后神经元放电的精确时间差来调整突触连接的强度。本练习旨在让你通过定量计算，亲身体体验神经活动模式如何直接转化为突触的长时程增强（long-term potentiation, LTP）或长时程抑制（long-term depression, LTD）。掌握这一核心机制的计算 [@problem_id:4501810] 是理解活动依赖性可塑性的基础，而后者正是学习、记忆和中风后康复的基石。", "problem": "在一个支持缺血性中风后运动恢复的皮层微环路中，考虑一个从前运动神经元到运动皮层神经元的兴奋性突触，该突触正在经历脉冲时序依赖可塑性（STDP；Spike-Timing-Dependent Plasticity）。基于脉冲对的STDP具有以下基本特征：(i) 当突触前脉冲比突触后脉冲提前一个时间间隔 $\\Delta t = t_{\\mathrm{post}} - t_{\\mathrm{pre}} > 0$ 时，突触变化为正（长时程增强），并随着 $\\Delta t$ 的增加，根据一个幅度参数为 $A_{+}$、时间常数为 $\\tau_{+}$ 的指数窗口衰减；(ii) 当突触后脉冲比突触前脉冲提前一个时间间隔 $\\Delta t  0$ 时，突触变化为负（长时程抑制），其幅值随着 $|\\Delta t|$ 的增加，根据一个幅度参数为 $A_{-}$、时间常数为 $\\tau_{-}$ 的指数窗口衰减；以及 (iii) 对于多个脉冲对，总的突触变化是各脉冲对贡献的总和。假设在测量期间STDP过程是平稳的，且突触权重是无量纲的。\n\n在一个康复训练时期，该突触上出现了两个脉冲对：首先是一个因果脉冲对，其 $\\Delta t_{1} = +10~\\mathrm{ms}$；之后是一个反因果脉冲对，其 $\\Delta t_{2} = -20~\\mathrm{ms}$。该突触表现出基于脉冲对的指数STDP，其参数为 $A_{+} = 0.004$，$\\tau_{+} = 20~\\mathrm{ms}$，$A_{-} = 0.005$，以及 $\\tau_{-} = 30~\\mathrm{ms}$。\n\n从上述基本事实出发，推导适用于 $\\Delta t>0$ 和 $\\Delta t0$ 的脉冲对更新函数，将它们应用于这两个脉冲间隔，并计算净突触权重变化 $\\Delta w_{\\mathrm{net}}$，即两个特定脉冲对更新的总和。将你的最终数值答案保留到四位有效数字。将最终答案表示为无量纲量。", "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 模型是针对单个兴奋性突触的脉冲时序依赖可塑性 (STDP)。\n- STDP机制是基于脉冲对且可加的。\n- 对于突触前脉冲先于突触后脉冲的情况 ($\\Delta t = t_{\\mathrm{post}} - t_{\\mathrm{pre}}  0$)，发生长时程增强 (LTP)。突触变化为正，并随幅度参数 $A_{+}$ 和时间常数 $\\tau_{+}$ 指数衰减。\n- 对于突触后脉冲先于突触前脉冲的情况 ($\\Delta t  0$)，发生长时程抑制 (LTD)。突触变化为负，其幅值随幅度参数 $A_{-}$ 和时间常数 $\\tau_{-}$ 指数衰减。\n- 发生两个脉冲对：一个 $\\Delta t_{1} = +10~\\mathrm{ms}$，另一个 $\\Delta t_{2} = -20~\\mathrm{ms}$。\n- 模型参数为：$A_{+} = 0.004$，$\\tau_{+} = 20~\\mathrm{ms}$，$A_{-} = 0.005$，以及 $\\tau_{-} = 30~\\mathrm{ms}$。\n- 突触权重是无量纲量。\n- 任务是计算净突触权重变化 $\\Delta w_{\\mathrm{net}}$，即两个脉冲对变化的总和，并将结果保留到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据充分**：该问题描述了STDP的一个经典模型，这是神经科学中的一个基本概念。用于LTP和LTD的指数衰减函数是一种成熟且广泛使用的形式化方法（例如，Song-Miller-Abbott模型）。中风后恢复的背景是一个有效且活跃的研究领域，其中神经可塑性是关键机制。参数值在此类模型的合理范围内。该问题在科学上是合理的。\n- **良构的**：该问题是良构的。它清晰地定义了可塑性规则，提供了所有必要的数值参数，以及要分析的具体事件（脉冲对）。将各脉冲对贡献相加的指令为计算净变化提供了一种明确的方法。存在唯一、稳定且有意义的解。\n- **客观的**：该问题使用精确、客观的科学语言陈述。没有主观或模糊的术语。\n\n### 步骤 3：结论与行动\n该问题是有效的。它有充分的科学依据，是良构的、客观的。没有矛盾、信息缺失或其他缺陷。将提供完整的解答。\n\n### 解题推导\n\n根据提供的基本事实，我们首先将突触权重变化 $\\Delta w$ 的数学函数形式化，作为时间差 $\\Delta t$ 的函数。\n\n事实(i)指出，对于 $\\Delta t  0$，变化为正（LTP），并从幅度 $A_{+}$ 开始指数衰减。这可以表示为：\n$$\n\\Delta w(\\Delta t) = A_{+} \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right) \\quad \\text{for } \\Delta t  0\n$$\n\n事实(ii)指出，对于 $\\Delta t  0$，变化为负（LTD），其幅值从幅度 $A_{-}$ 开始指数衰减。变化的幅值为 $|\\Delta w| = A_{-} \\exp(-\\frac{|\\Delta t|}{\\tau_{-}})$。由于 $\\Delta t  0$，我们有 $|\\Delta t| = -\\Delta t$。变化本身是负的，所以我们写成：\n$$\n\\Delta w(\\Delta t) = -A_{-} \\exp\\left(-\\frac{|\\Delta t|}{\\tau_{-}}\\right) = -A_{-} \\exp\\left(\\frac{\\Delta t}{\\tau_{-}}\\right) \\quad \\text{for } \\Delta t  0\n$$\n\n将这些组合起来，得到单个脉冲对的完整分段函数：\n$$\n\\Delta w(\\Delta t) =\n\\begin{cases}\nA_{+} \\exp\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)  \\text{if } \\Delta t  0 \\\\\n-A_{-} \\exp\\left(\\frac{\\Delta t}{\\tau_{-}}\\right)  \\text{if } \\Delta t  0\n\\end{cases}\n$$\n\n问题指定了两个脉冲对，并假设了一个可加模型，其中净变化 $\\Delta w_{\\mathrm{net}}$ 是单个变化的总和。\n$$\n\\Delta w_{\\mathrm{net}} = \\Delta w(\\Delta t_1) + \\Delta w(\\Delta t_2)\n$$\n\n给定了两个脉冲对的值：$\\Delta t_1 = 10~\\mathrm{ms}$ 和 $\\Delta t_2 = -20~\\mathrm{ms}$。也给定了参数：$A_{+} = 0.004$，$\\tau_{+} = 20~\\mathrm{ms}$，$A_{-} = 0.005$，以及 $\\tau_{-} = 30~\\mathrm{ms}$。\n\n首先，我们计算因果脉冲对引起的变化 $\\Delta w_1 = \\Delta w(\\Delta t_1)$。由于 $\\Delta t_1 = 10~\\mathrm{ms}  0$，我们使用LTP规则：\n$$\n\\Delta w_1 = A_{+} \\exp\\left(-\\frac{\\Delta t_1}{\\tau_{+}}\\right) = 0.004 \\exp\\left(-\\frac{10~\\mathrm{ms}}{20~\\mathrm{ms}}\\right) = 0.004 \\exp(-0.5)\n$$\n\n接着，我们计算反因果脉冲对引起的变化 $\\Delta w_2 = \\Delta w(\\Delta t_2)$。由于 $\\Delta t_2 = -20~\\mathrm{ms}  0$，我们使用LTD规则：\n$$\n\\Delta w_2 = -A_{-} \\exp\\left(\\frac{\\Delta t_2}{\\tau_{-}}\\right) = -0.005 \\exp\\left(\\frac{-20~\\mathrm{ms}}{30~\\mathrm{ms}}\\right) = -0.005 \\exp\\left(-\\frac{2}{3}\\right)\n$$\n\n净突触权重变化是这两个贡献的总和：\n$$\n\\Delta w_{\\mathrm{net}} = \\Delta w_1 + \\Delta w_2 = 0.004 \\exp(-0.5) - 0.005 \\exp\\left(-\\frac{2}{3}\\right)\n$$\n\n现在，我们计算数值：\n$$\n\\exp(-0.5) \\approx 0.60653066\n$$\n$$\n\\exp\\left(-\\frac{2}{3}\\right) \\approx 0.51341712\n$$\n代入这些值：\n$$\n\\Delta w_{\\mathrm{net}} \\approx (0.004 \\times 0.60653066) - (0.005 \\times 0.51341712)\n$$\n$$\n\\Delta w_{\\mathrm{net}} \\approx 0.0024261226 - 0.0025670856\n$$\n$$\n\\Delta w_{\\mathrm{net}} \\approx -0.000140963\n$$\n\n问题要求将最终答案保留到四位有效数字。第一个有效数字是 $1$，后面是 $4$、$0$ 和 $9$。第五个有效数字是 $6$，所以我们将第四个有效数字（$9$）向上取整。这将序列 $1409$ 变为 $1410$。\n$$\n\\Delta w_{\\mathrm{net}} \\approx -0.0001410\n$$\n用标准科学记数法表示，这是 $-1.410 \\times 10^{-4}$。尾随的零是有效数字。", "answer": "$$\\boxed{-1.410 \\times 10^{-4}}$$", "id": "4501810"}, {"introduction": "中风后的运动功能恢复通常呈现出一种非线性的饱和过程，这可以通过数学模型来描述。一个常见的模型假设，功能改善的速率与剩余的恢复潜力成正比。本练习将带领你从细胞机制走向可观察的临床现象，通过将恢复模型拟合到假设的患者数据 [@problem_id:4501745]，你将学会如何量化康复过程的动态特性并估算关键参数，如恢复速率$k$。这项技能对于预测患者的预后和优化治疗方案至关重要。", "problem": "神经康复学中的一个核心观察是，中风后由治疗驱动的运动功能恢复表现出饱和行为，这与一阶趋近渐近线的动力学模型一致。考虑 Fugl-Meyer 上肢评估 (FMA-UE) 分数的增益 $G(H)$ 作为治疗小时数 $H$ 的函数。从一个基本假设出发：每单位治疗小时的增益变化率与剩余未实现的潜力成正比，且该潜力受已知最大值的限制。基于突触效能的稳态调节，我们假设存在以下微分定律和初始条件：\n$$\\frac{dG}{dH} = k \\left(G_{\\max} - G(H)\\right), \\quad G(0) = 0,$$\n其中 $k$ 是一个单位为 $1/\\text{hour}$ 的正常数速率常数，$G_{\\max}$ 是已知的 FMA-UE 分数可能的最大增益。设 $G_{\\max} = 66$ 分，与 Fugl-Meyer 上肢评估 (FMA-UE) 的满分范围相匹配。\n\n给定一组假设的观测数据 $\\{(H_i, y_i)\\}_{i=1}^n$，其中 $H_i$ 是治疗小时数，$y_i$ 是测得的 FMA-UE 分数增益。假设测量噪声是加性的、独立同分布的，且服从零均值和恒定方差的高斯分布。从该微分定律出发，推导 $G(H)$ 的显式形式，并在高斯噪声假设下，构建对 $k$ 的最大似然估计。证明这等价于带有约束 $k  0$ 的关于 $k$ 的非线性最小二乘问题。然后，实现一个算法，该算法能够：\n- 通过约束非线性最小二乘法估计 $k$。\n- 计算 $k$ 的不确定性，表示为从观测 Fisher 信息中获得的近似标准误差，计算时使用模型在估计的 $k$ 值处的雅可比矩阵以及残差方差的估计值。\n\n您的程序必须处理以下测试用例集，每个用例由治疗小时数 $H$（单位：小时）和观测增益 $y$（单位：FMA-UE 分数）的数组定义：\n\n- 测试用例 1（一般情况，$H$ 值覆盖范围适中）：\n  - $H = [0, 5, 10, 20, 30, 40]$\n  - $y = [0.0, 22.1, 35.4, 53.7, 61.1, 63.5]$\n- 测试用例 2（边界情况，$H$ 值较小且集中在零附近）：\n  - $H = [0, 2, 4, 6, 8, 10]$\n  - $y = [0.0, 6.1, 12.0, 17.5, 21.6, 25.4]$\n- 测试用例 3（边缘情况，$H$ 值较大且接近饱和）：\n  - $H = [20, 40, 60, 80, 100, 120]$\n  - $y = [29.1, 47.0, 54.4, 60.5, 63.0, 64.4]$\n\n科学真实性考量：\n- 增益 $y$ 的上界为 $G_{\\max} = 66$ 分。\n- 模型参数 $k$ 必须满足 $k  0$，单位为 $1/\\text{hour}$。\n- 噪声模型是同方差高斯模型，且测量误差是独立的。\n\n算法要求：\n- 使用从微分定律推导出的 $G(H)$ 的显式解，并通过带正值约束的非线性最小二乘法来拟合 $k$。\n- 将残差平方和除以 $n - p$ 来估计残差方差 $\\hat{\\sigma}^2$，其中 $n$ 是观测次数，$p = 1$ 是参数数量。\n- 在估计的 $k$ 值处计算雅可比矩阵的元素 $\\frac{\\partial G(H_i; k)}{\\partial k}$，并使用近似公式 $\\operatorname{Var}(\\hat{k}) \\approx \\hat{\\sigma}^2 \\left(J^\\top J\\right)^{-1}$ 来获得标准误差。\n\n输出规格：\n- 对每个测试用例，报告估计的 $k$（单位：$1/\\text{hour}$）及其标准误差（单位：$1/\\text{hour}$）。\n- 将所有报告值表示为四舍五入到 $6$ 位小数的浮点数。\n- 单位：$k$ 及其标准误差以 $1/\\text{hour}$ 为单位报告。\n- 最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，顺序为 $[k_1, s_1, k_2, s_2, k_3, s_3]$，其中 $k_j$ 是测试用例 $j$ 的估计值，$s_j$ 是其标准误差。例如：$[0.012345,0.001234,0.023456,0.002345,0.034567,0.003456]$。", "solution": "用户提供的问题是一个有效、适定且具有科学依据的生物物理模型参数估计任务。它要求推导并应用一种非线性回归算法，从实验数据中估计一个速率常数，这是定量科学中的一个标准流程。该问题是自洽的，提供了所有必要的数据、常数和方法论规范。其中没有矛盾、歧义或违反科学原则之处。\n\n### 步骤1：推导增益函数 $G(H)$\n\n问题始于一个描述运动功能增益 $G$ 相对于治疗小时数 $H$ 的变化率的微分定律。\n$$\n\\frac{dG}{dH} = k (G_{\\max} - G(H))\n$$\n这是一个一阶线性常微分方程，可以通过分离变量法求解。常数 $k$ 是速率常数（单位：$1/\\text{hour}$），$G_{\\max}$ 是可能的最大增益。初始条件为 $G(0) = 0$，表示在治疗开始前没有增益。\n\n我们重排方程以分离变量 $G$ 和 $H$：\n$$\n\\frac{dG}{G_{\\max} - G} = k \\, dH\n$$\n对两边进行积分，我们得到：\n$$\n\\int \\frac{1}{G_{\\max} - G} \\, dG = \\int k \\, dH\n$$\n积分结果为：\n$$\n-\\ln|G_{\\max} - G| = kH + C\n$$\n其中 $C$ 是积分常数。由于增益 $G(H)$ 不会超过最大潜在增益 $G_{\\max}$，项 $G_{\\max} - G$ 始终为非负，因此我们可以去掉绝对值符号。\n$$\n\\ln(G_{\\max} - G) = -kH - C\n$$\n对两边取指数可得：\n$$\nG_{\\max} - G = e^{-kH - C} = e^{-C} e^{-kH}\n$$\n令 $A = e^{-C}$ 为一个新的常数。$G(H)$ 的方程为：\n$$\nG(H) = G_{\\max} - A e^{-kH}\n$$\n我们使用初始条件 $G(0) = 0$ 来确定常数 $A$：\n$$\nG(0) = 0 = G_{\\max} - A e^{-k(0)} = G_{\\max} - A e^0 = G_{\\max} - A\n$$\n这意味着 $A = G_{\\max}$。将此代回 $G(H)$ 的表达式，我们得到增益函数的显式形式：\n$$\nG(H; k) = G_{\\max}(1 - e^{-kH})\n$$\n\n### 步骤2：最大似然估计与非线性最小二乘法\n\n问题陈述，在治疗小时数 $H_i$ 处的观测增益 $y_i$ 被建模为真实增益加上一个加性的、独立同分布 (i.i.d.) 的高斯噪声 $\\epsilon_i$：\n$$\ny_i = G(H_i; k) + \\epsilon_i, \\quad \\text{where } \\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)\n$$\n对于单个观测值 $y_i$，给定参数 $k$ 和 $\\sigma^2$ 的概率密度函数 (PDF) 是：\n$$\np(y_i | k, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - G(H_i; k))^2}{2\\sigma^2} \\right)\n$$\n由于噪声项的独立性，整个数据集 $\\{(H_i, y_i)\\}_{i=1}^n$ 的似然函数是各个概率密度函数的乘积：\n$$\nL(k, \\sigma^2; \\mathbf{y}, \\mathbf{H}) = \\prod_{i=1}^n p(y_i | k, \\sigma^2) = \\left( \\frac{1}{2\\pi\\sigma^2} \\right)^{n/2} \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (y_i - G(H_i; k))^2 \\right)\n$$\n为了找到 $k$ 的最大似然估计 (MLE)，最大化对数似然函数 $\\ln L$ 更为方便：\n$$\n\\ln L(k, \\sigma^2) = -\\frac{n}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n (y_i - G(H_i; k))^2\n$$\n为了关于 $k$ 最大化 $\\ln L$，我们只需要考虑依赖于 $k$ 的项。这等价于最小化残差平方和 (SSR)：\n$$\n\\text{SSR}(k) = \\sum_{i=1}^n (y_i - G(H_i; k))^2\n$$\n因此，$k$ 的最大似然估计由下式给出：\n$$\n\\hat{k}_{\\text{MLE}} = \\arg\\min_{k} \\text{SSR}(k) = \\arg\\min_{k} \\sum_{i=1}^n (y_i - G_{\\max}(1 - e^{-kH_i}))^2\n$$\n考虑到速率常数必须为正 ($k  0$) 的约束，该估计问题正是一个约束非线性最小二乘问题。\n\n### 步骤3：参数与不确定性估计算法\n\n算法流程如下：\n\n1.  **估计 $\\hat{k}$**：找到使 SSR 函数最小化的值 $\\hat{k}$，同时满足约束 $\\hat{k}  0$。这是一个数值优化问题。\n\n2.  **估计残差方差 $\\hat{\\sigma}^2$**：找到 $\\hat{k}$ 后，计算噪声方差 $\\sigma^2$ 的无偏估计。对于 $n$ 个观测值和 $p=1$ 个待估参数，残差的自由度为 $n-p$。\n    $$\n    \\hat{\\sigma}^2 = \\frac{1}{n-p} \\sum_{i=1}^n (y_i - G(H_i; \\hat{k}))^2 = \\frac{\\text{SSR}(\\hat{k})}{n-1}\n    $$\n\n3.  **计算 $\\hat{k}$ 的标准误差**：估计值 $\\hat{k}$ 的不确定性由其标准误差给出。在非线性最小二乘法中，参数估计的方差可以使用模型函数的雅可比矩阵来近似。对于我们的模型，雅可比矩阵 $J$ 是一个 $n \\times 1$ 的列向量，其中第 $i$ 个元素是模型函数关于参数 $k$ 的偏导数，在观测点 $H_i$ 处求值。\n    $$\n    J_i = \\frac{\\partial G(H_i; k)}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ G_{\\max}(1 - e^{-kH_i}) \\right] = -G_{\\max} \\left( e^{-kH_i} \\cdot (-H_i) \\right) = G_{\\max} H_i e^{-kH_i}\n    $$\n    $\\hat{k}$ 的方差近似为：\n    $$\n    \\operatorname{Var}(\\hat{k}) \\approx \\hat{\\sigma}^2 (J(\\hat{k})^\\top J(\\hat{k}))^{-1}\n    $$\n    由于我们只有一个参数，$J^\\top J$ 是一个标量：\n    $$\n    J^\\top J = \\sum_{i=1}^n \\left( \\frac{\\partial G(H_i; \\hat{k})}{\\partial k} \\right)^2 = \\sum_{i=1}^n (G_{\\max} H_i e^{-\\hat{k}H_i})^2\n    $$\n    那么方差为：\n    $$\n    \\operatorname{Var}(\\hat{k}) \\approx \\frac{\\hat{\\sigma}^2}{\\sum_{i=1}^n (G_{\\max} H_i e^{-\\hat{k}H_i})^2}\n    $$\n    标准误差是方差的平方根：\n    $$\n    \\text{se}(\\hat{k}) = \\sqrt{\\operatorname{Var}(\\hat{k})}\n    $$\n这些步骤提供了估计参数 $\\hat{k}$ 及其标准误差，后者量化了估计的精度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves for the rate constant k and its standard error for three test cases\n    of post-stroke motor recovery data.\n    \"\"\"\n    \n    # The maximum possible gain in FMA-UE points is given as a constant.\n    G_max = 66.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            np.array([0, 5, 10, 20, 30, 40], dtype=float),\n            np.array([0.0, 22.1, 35.4, 53.7, 61.1, 63.5], dtype=float)\n        ),\n        (\n            np.array([0, 2, 4, 6, 8, 10], dtype=float),\n            np.array([0.0, 6.1, 12.0, 17.5, 21.6, 25.4], dtype=float)\n        ),\n        (\n            np.array([20, 40, 60, 80, 100, 120], dtype=float),\n            np.array([29.1, 47.0, 54.4, 60.5, 63.0, 64.4], dtype=float)\n        )\n    ]\n\n    results = []\n\n    # Model function G(H; k)\n    def model_gain(k_val, H_vals, G_max_val):\n        return G_max_val * (1.0 - np.exp(-k_val * H_vals))\n\n    # Objective function: Sum of Squared Residuals (SSR)\n    def ssr(k, H_vals, y_vals, G_max_val):\n        k_val = k[0]\n        y_pred = model_gain(k_val, H_vals, G_max_val)\n        return np.sum((y_vals - y_pred)**2)\n\n    for H, y in test_cases:\n        # Initial guess for the rate constant k.\n        # A value of 0.1 corresponds to a time constant of 10 hours, a reasonable starting point.\n        k_initial_guess = [0.1]\n        \n        # Constraint k  0. A small positive lower bound is used for numerical stability.\n        bounds = [(1e-9, None)]\n\n        # Perform constrained nonlinear least squares optimization.\n        opt_result = minimize(\n            fun=ssr,\n            x0=k_initial_guess,\n            args=(H, y, G_max),\n            method='L-BFGS-B',\n            bounds=bounds\n        )\n        \n        k_hat = opt_result.x[0]\n\n        # --- Uncertainty Calculation ---\n        \n        # 1. Estimate residual variance (sigma^2)\n        n = len(H)\n        p = 1  # Number of parameters being estimated\n        \n        residuals = y - model_gain(k_hat, H, G_max)\n        ssr_val = np.sum(residuals**2)\n        \n        # Unbiased estimator for the variance of the error term\n        sigma2_hat = ssr_val / (n - p)\n        \n        # 2. Compute the Jacobian at the estimated k\n        # The Jacobian is a column vector dG/dk for each H_i.\n        jacobian_vector = G_max * H * np.exp(-k_hat * H)\n        \n        # 3. Calculate (J^T * J)\n        # Since J is a vector, J^T * J is the dot product of J with itself.\n        JtJ = np.dot(jacobian_vector, jacobian_vector)\n        \n        # 4. Compute the variance and standard error of k_hat\n        if JtJ  1e-12:  # Avoid division by zero\n            k_variance = sigma2_hat / JtJ\n            k_std_error = np.sqrt(k_variance)\n        else:\n            k_std_error = np.inf # If JtJ is zero, variance is undefined/infinite\n\n        results.extend([k_hat, k_std_error])\n\n    # Format the final output string as required.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4501745"}, {"introduction": "评估一种疗法的有效性，不仅仅是观察平均改善值，它涉及到量化效应的幅度（即效应量），并将其与对患者而言有意义的最小临床重要差异（Minimal Clinically Important Difference, MCID）进行比较。这最后一个练习旨在解决转化研究中的一个关键问题：如何判断临床相关性。你将计算一个标准化的效应量（科恩$d$值），并结合已知的MCID阈值，就某项疗法是否具有临床意义进行严谨的论证 [@problem_id:4501776]。这项实践能够磨练你批判性评估临床试验证据、并将统计结果与以患者为中心的结果联系起来的能力。", "problem": "一组慢性缺血性卒中幸存者完成了一项为期 $8$ 周的任务特异性运动训练，该训练结合了经颅直流电刺激 (tDCS)，旨在激活患侧运动回路中的 Hebbian 学习机制和长时程增强 (LTP) 样神经可塑性。主要结局指标是 Fugl-Meyer 上肢功能评定量表 (FMA-UE)，这是一个由临床医生评定的量表，在神经康复的组分析中通常被视为等距水平数据。在 $n$ 名参与者中，FMA-UE 从治疗前到治疗后的平均变化为 $6$ 分，变化分数的样本标准差为 $8$ 分。在基于锚定法的临床可解释性研究中，据报道 FMA-UE 的最小临床重要差异 (MCID) 因恢复阶段而异；为便于本练习，我们采用两个代表性阈值：$5$ 分（慢性期卒中）和 $7$ 分（亚急性期卒中）。\n\n从“标准化效应是以该差异的变异性为单位来量化平均差异”这一第一性原理概念出发，推导出适用于被试内（前后）设计的标准化平均变化效应量，即基于变化分数的 Cohen's $d$ 版本。然后，计算所描述数据集的该效应量值。最后，使用给定的 MCID 阈值，就观察到的平均变化在慢性期与亚急性期卒中后恢复中是否可能具有临床意义，提出一个有理有据的论证，并将您的推理建立在基于锚定法的阈值和基于分布的效应量之间的关系上。\n\n请将您最终的 Cohen’s $d$ 数值答案表示为一个精确分数。无需四舍五入，最终答案中不应包含单位。", "solution": "该问题有效。它在神经康复和生物统计学领域有科学依据，问题阐述清晰，提供了足够的信息以获得唯一解，并且语言客观。它要求推导和计算一个标准的统计量，并在临床背景下对结果进行有理有据的解释。\n\n第一个任务是为被试内（前后）设计推导标准化平均变化效应量 Cohen’s $d$ 的公式。我们从第一性原理定义开始，即标准化效应是用标准差单位表示的平均差异。\n\n在前后设计中，数据在两个时间点从 $n$ 名参与者中的每一位收集，即干预前 ($X_{pre}$) 和干预后 ($X_{post}$)。每位参与者 $i$ 的变化被定义为差异分数：\n$$D_i = X_{post, i} - X_{pre, i}$$\n“平均差异”是这些变化分数在整个样本中的平均值：\n$$\\bar{D} = \\frac{1}{n} \\sum_{i=1}^{n} D_i$$\n“该差异的变异性”是这些变化分数的样本标准差：\n$$s_D = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (D_i - \\bar{D})^2}$$\n根据第一性原理的定义，标准化平均变化是平均变化除以变化分数的标准差。这种 Cohen's $d$ 的变体，有时表示为 $d_z$ 或 $d_{avg}$，由以下公式给出：\n$$d = \\frac{\\bar{D}}{s_D}$$\n对于单组前后设计，当关注点在于变化本身的幅度时，这是合适的效应量。\n\n第二个任务是为给定的数据集计算此效应量的值。问题从研究队列中提供了以下数值：\nFMA-UE 的前后平均变化，$\\bar{D} = 6$ 分。\n变化分数的样本标准差，$s_D = 8$ 分。\n\n将这些值代入推导出的公式：\n$$d = \\frac{6}{8}$$\n简化此分数可得效应量的值：\n$$d = \\frac{3}{4}$$\n用小数表示，这是 $0.75$。按照传统标准（例如，Cohen 的指导方针），这种幅度的效应量被认为是大的（小 $\\approx 0.2$，中 $\\approx 0.5$，大 $\\approx 0.8$）。\n\n第三个任务是就此变化的临床意义提供一个有理有据的论证。这需要将我们刚刚计算的基于分布的度量（Cohen's $d$）与所提供的基于锚定法的阈值（最小临床重要差异，MCID）进行对比。\n\nMCID 是一个基于锚定法的估计，指的是患者会认为重要或有益的结局分数的最小变化。它为个体层面的临床相关性提供了一个基准。相比之下，Cohen's $d$ 是一个基于分布的度量，它量化了平均效应相对于样本内变异的大小。它说明了在群体水平上效应的幅度和一致性。完整的解释需要同时考虑两者。\n\n观察到的群体平均变化是 $\\bar{D} = 6$ 分。\n\n情况1：慢性期卒中后恢复\n慢性期卒中患者的 MCID 被定为 $5$ 分。\n该组的平均改善（$\\bar{D} = 6$）超过了被认为是该人群中个体最小临床重要改善的阈值（$\\text{MCID} = 5$）。这表明，平均而言，参与者经历了一种他们可能会认为是受益的变化。大的效应量（$d = 0.75$）通过表明 $6$ 分的平均变化相对于患者间反应的变异性是大的，从而强化了这一结论。因此，对于慢性期卒中人群，观察到的平均变化很可能具有临床意义。\n\n情况2：亚急性期卒中后恢复（假设情境）\n亚急性期卒中患者的 MCID 被定为 $7$ 分。\n在这种情况下，该组的平均改善（$\\bar{D} = 6$）未达到被认为是最小临床重要改善的阈值（$\\text{MCID} = 7$）。尽管统计效应量仍然很大（$d = 0.75$），表明在分布上存在显著变化，但这个平均变化的幅度没有达到亚急性期临床相关性的更高标准。这说明了一个关键区别：一个统计上显著且大的效应不一定具有临床意义。临床意义的解释是依赖于情境的，并依赖于外部的、基于锚定法的标准，如 MCID。在这个假设的亚急性期情境中，可以得出结论，该干预虽然产生了可测量的效应，但平均而言，并未达到在该特定恢复阶段被患者认为重要的改善水平。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "4501776"}]}