{"hands_on_practices": [{"introduction": "成功地将超声波能量传递到颅内目标面临着一个主要障碍：颅骨本身。由于水（耦合介质）和颅骨之间的声阻抗存在显著差异，大部分入射能量会被反射。本练习 [@problem_id:4480737] 旨在量化这一基本挑战，通过计算水-颅骨界面处的压力反射系数，帮助您理解经颅聚焦超声中能量传递效率的第一个决定因素。", "problem": "一个经颅聚焦超声 (FUS) 系统将声能从水浴耦合到人颅骨中，以到达深部脑靶点。在入射点局部，将相互作用近似为一维、时谐平面纵波正入射到两种无损耗、均匀、类流体介质之间的平面界面上：介质 $1$（水）和介质 $2$（颅骨）。忽略吸收、剪切波模式转换以及曲率或厚度效应，从而该界面可被视为两种半无限介质之间的边界。使用比声阻抗 $Z$ 的定义 $Z=\\rho c$，其中 $\\rho$ 是质量密度， $c$ 是介质中的纵波声速。\n\n从总声压和质点速度的法向分量在界面上连续的线性声学边界条件出发，并利用每种介质中压力和质点速度的平面波关系，推导正入射复压反射系数（反射波与入射波压力振幅之比），用 $Z_1$ 和 $Z_2$ 表示。然后，对于水-颅骨界面，使用水和颅骨的比声阻抗分别为 $Z_1 = 1.5\\ \\mathrm{MRayl}$ 和 $Z_2 = 7.0\\ \\mathrm{MRayl}$ 进行数值计算。\n\n报告无量纲压力反射系数幅值的最终数值，四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "设介质 $1$ 和介质 $2$ 之间的界面位于平面 $x=0$ 处。介质 $1$ 占据 $x  0$ 的空间，介质 $2$ 占据 $x > 0$ 的空间。一束平面波从介质 $1$ 沿 $x$ 轴向介质 $2$ 传播。\n\n我们将时谐声压波表示为复指数形式。角频率为 $\\omega$，介质中的波数分别为 $k_1$ 和 $k_2$。\n\n在介质 $1$（$x  0$）中，总声压 $p_1$ 是入射波 $p_i$ 和反射波 $p_r$ 的和：\n$$p_i(x,t) = P_i \\exp(j(\\omega t - k_1 x))$$\n$$p_r(x,t) = P_r \\exp(j(\\omega t + k_1 x))$$\n$$p_1(x,t) = p_i(x,t) + p_r(x,t) = (P_i \\exp(-j k_1 x) + P_r \\exp(j k_1 x)) \\exp(j\\omega t)$$\n这里，$P_i$ 和 $P_r$ 分别是入射波和反射波的复压幅。\n\n在介质 $2$（$x > 0$）中，只有透射波 $p_t$：\n$$p_t(x,t) = P_t \\exp(j(\\omega t - k_2 x))$$\n$$p_2(x,t) = p_t(x,t) = P_t \\exp(j(\\omega t - k_2 x))$$\n这里，$P_t$ 是透射波的复压幅。\n\n对于平面波，声压 $p$ 和质点速度 $u$ 之间的关系由比声阻抗 $Z$ 给出。对于沿 $+x$ 方向传播的波，$p = Z u$。对于沿 $-x$ 方向传播的波，$p = -Z u$。\n因此，与压力波相对应的质点速度为：\n入射速度：$u_i(x,t) = \\frac{p_i(x,t)}{Z_1} = \\frac{P_i}{Z_1} \\exp(j(\\omega t - k_1 x))$\n反射速度：$u_r(x,t) = -\\frac{p_r(x,t)}{Z_1} = -\\frac{P_r}{Z_1} \\exp(j(\\omega t + k_1 x))$\n透射速度：$u_t(x,t) = \\frac{p_t(x,t)}{Z_2} = \\frac{P_t}{Z_2} \\exp(j(\\omega t - k_2 x))$\n\n每种介质中的总质点速度为：\n在介质 $1$ 中：$u_1(x,t) = u_i(x,t) + u_r(x,t) = (\\frac{P_i}{Z_1} \\exp(-j k_1 x) - \\frac{P_r}{Z_1} \\exp(j k_1 x)) \\exp(j\\omega t)$\n在介质 $2$ 中：$u_2(x,t) = u_t(x,t) = \\frac{P_t}{Z_2} \\exp(j(\\omega t - k_2 x))$\n\n现在，我们在界面 $x=0$ 处应用边界条件。\n1. 声压连续性：$p_1(0,t) = p_2(0,t)$\n$$(P_i \\exp(0) + P_r \\exp(0)) \\exp(j\\omega t) = P_t \\exp(0) \\exp(j\\omega t)$$\n$$P_i + P_r = P_t$$\n\n2. 法向质点速度连续性：$u_1(0,t) = u_2(0,t)$\n$$(\\frac{P_i}{Z_1} \\exp(0) - \\frac{P_r}{Z_1} \\exp(0)) \\exp(j\\omega t) = \\frac{P_t}{Z_2} \\exp(0) \\exp(j\\omega t)$$\n$$\\frac{P_i - P_r}{Z_1} = \\frac{P_t}{Z_2}$$\n\n我们现在得到一个关于幅值 $P_i$、$P_r$ 和 $P_t$ 的二元一次方程组：\n(1) $P_i + P_r = P_t$\n(2) $P_i - P_r = \\frac{Z_1}{Z_2} P_t$\n\n目标是求出压力反射系数 $R_p = \\frac{P_r}{P_i}$。我们可以从方程组中消去 $P_t$。将方程 (1) 代入方程 (2)：\n$$P_i - P_r = \\frac{Z_1}{Z_2} (P_i + P_r)$$\n两边同乘以 $Z_2$：\n$$Z_2(P_i - P_r) = Z_1(P_i + P_r)$$\n$$Z_2 P_i - Z_2 P_r = Z_1 P_i + Z_1 P_r$$\n重新整理各项，将 $P_i$ 和 $P_r$ 分别组合：\n$$Z_2 P_i - Z_1 P_i = Z_1 P_r + Z_2 P_r$$\n$$P_i (Z_2 - Z_1) = P_r (Z_1 + Z_2)$$\n最后，求解比值 $\\frac{P_r}{P_i}$：\n$$R_p = \\frac{P_r}{P_i} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$$\n这就是推导出的正入射压力反射系数的表达式。\n\n接下来，我们对水-颅骨界面的该系数进行数值计算。问题给出：\n$Z_1 = 1.5\\ \\mathrm{MRayl}$\n$Z_2 = 7.0\\ \\mathrm{MRayl}$\n\n由于介质是无损耗的，阻抗 $Z_1$ 和 $Z_2$ 是实数。因此，反射系数 $R_p$ 也是实数。反射系数的幅值 $|R_p|$ 是其绝对值。\n$$R_p = \\frac{7.0 - 1.5}{7.0 + 1.5} = \\frac{5.5}{8.5}$$\nMRayl 单位被消掉，正如无量纲系数所预期的那样。\n计算数值：\n$$R_p = \\frac{5.5}{8.5} \\approx 0.6470588235...$$\n由于 $Z_2  Z_1$， $R_p$ 的值为正，因此幅值等于其本身。\n问题要求结果四舍五入到四位有效数字。\n$$|R_p| \\approx 0.6471$$", "answer": "$$\\boxed{0.6471}$$", "id": "4480737"}, {"introduction": "除了能量反射外，颅骨的不均匀性还对超声波的聚焦精度构成了另一个严峻挑战。当超声波穿过厚度不一、声速变化的颅骨时，波前会发生畸变，导致焦点偏移和模糊。本练习 [@problem_id:4480671] 通过一个简化模型，演示了颅骨厚度变化如何引起关键的相位误差，从而阐明为何必须使用相控阵技术进行精确的相位校正。", "problem": "经颅聚焦超声需要精确的阵列元件间相位对准，以补偿声波通过颅骨的非均匀传播。计算机断层扫描（CT）衍生的图谱提供了颅骨局部的声速和厚度估计。考虑一个相对于标称声束路径遇到额外颅骨厚度的阵列元件。假设频率为 $f$ 的单色声场在声速为 $c$ 的介质中传播，并回想沿路径累积的相位与传播时间相关。从通过长度为 $L$、声速为 $c$ 的介质段的传播时间的基本运动学关系 $t = L/c$ 出发，以及角频率为 $\\omega$ 的正弦波在时间 $t$ 内的瞬时相位推进定义为 $\\phi = \\omega t$（其中 $\\omega = 2\\pi f$），推导当一小段额外长度 $\\Delta L$ 在颅骨中而不是在水中传播时产生的相位误差 $\\Delta \\phi$ 的解析表达式。将额外段建模为相对于在水中传播相同长度所贡献的时间差 $\\Delta t$，并用 $\\Delta L$、$f$、$c_{\\mathrm{bone}}$ 和 $c_{\\mathrm{water}}$ 表示 $\\Delta \\phi$。然后，对于一个代表性的经颅案例，其中 $f = 650\\ \\mathrm{kHz}$，$\\Delta L = 3\\ \\mathrm{mm}$，$c_{\\mathrm{bone}} = 2800\\ \\mathrm{m/s}$，$c_{\\mathrm{water}} = 1480\\ \\mathrm{m/s}$，计算 $\\Delta \\phi$ 的数值。将最终数值答案四舍五入至四位有效数字，并以弧度表示相位。", "solution": "相位误差 $\\Delta \\phi$ 源于声波在颅骨中传播距离 $\\Delta L$ 与在水中传播相同距离所需的时间差 $\\Delta t$。\n首先，我们定义声波在颅骨中传播长度为 $\\Delta L$ 的一段所需的时间。使用给定的运动学关系，这个时间 $t_{\\mathrm{bone}}$ 为：\n$$t_{\\mathrm{bone}} = \\frac{\\Delta L}{c_{\\mathrm{bone}}}$$\n接下来，我们定义如果该长度为 $\\Delta L$ 的段充满了水，声波传播所需的时间。这个参考时间 $t_{\\mathrm{water}}$ 为：\n$$t_{\\mathrm{water}} = \\frac{\\Delta L}{c_{\\mathrm{water}}}$$\n这两条路径之间的时间差 $\\Delta t$ 是相位误差的来源。我们将 $\\Delta t$ 定义为在像差介质（骨骼）中传播的时间减去在参考介质（水）中传播的时间：\n$$\\Delta t = t_{\\mathrm{bone}} - t_{\\mathrm{water}}$$\n代入 $t_{\\mathrm{bone}}$ 和 $t_{\\mathrm{water}}$ 的表达式：\n$$\\Delta t = \\frac{\\Delta L}{c_{\\mathrm{bone}}} - \\frac{\\Delta L}{c_{\\mathrm{water}}}$$\n提出公因式 $\\Delta L$：\n$$\\Delta t = \\Delta L \\left( \\frac{1}{c_{\\mathrm{bone}}} - \\frac{1}{c_{\\mathrm{water}}} \\right)$$\n问题陈述相位推进 $\\phi$ 与时间 $t$ 的关系为 $\\phi = \\omega t$，其中角频率 $\\omega$ 由 $\\omega = 2\\pi f$ 给出。因此，相位误差 $\\Delta \\phi$ 与时间差 $\\Delta t$ 成正比：\n$$\\Delta \\phi = \\omega \\Delta t = (2\\pi f) \\Delta t$$\n将 $\\Delta t$ 的表达式代入此方程，得到相位误差的最终解析表达式：\n$$\\Delta \\phi = 2\\pi f \\Delta L \\left( \\frac{1}{c_{\\mathrm{bone}}} - \\frac{1}{c_{\\mathrm{water}}} \\right)$$\n这就是所要求的用 $\\Delta L$、$f$、$c_{\\mathrm{bone}}$ 和 $c_{\\mathrm{water}}$ 表示的 $\\Delta \\phi$ 的表达式。\n\n现在，我们使用给定的参数计算 $\\Delta \\phi$ 的数值。首先，我们将所有给定值转换为标准的国际单位制（SI）单位。\n-   频率：$f = 650\\ \\mathrm{kHz} = 650 \\times 10^3\\ \\mathrm{Hz} = 6.5 \\times 10^5\\ \\mathrm{s}^{-1}$\n-   额外路径长度：$\\Delta L = 3\\ \\mathrm{mm} = 3 \\times 10^{-3}\\ \\mathrm{m}$\n-   骨中声速：$c_{\\mathrm{bone}} = 2800\\ \\mathrm{m/s}$\n-   水中声速：$c_{\\mathrm{water}} = 1480\\ \\mathrm{m/s}$\n\n将这些值代入推导出的 $\\Delta \\phi$ 表达式中：\n$$\\Delta \\phi = 2\\pi (6.5 \\times 10^5) (3 \\times 10^{-3}) \\left( \\frac{1}{2800} - \\frac{1}{1480} \\right)$$\n首先，我们简化括号外的项：\n$$2\\pi (6.5 \\times 10^5) (3 \\times 10^{-3}) = 2\\pi \\times (6.5 \\times 3) \\times (10^5 \\times 10^{-3}) = 2\\pi \\times 19.5 \\times 10^2 = 3900\\pi$$\n现在，我们计算括号内的项：\n$$\\frac{1}{2800} - \\frac{1}{1480} = \\frac{1480 - 2800}{2800 \\times 1480} = \\frac{-1320}{4144000}$$\n现在，我们结合这些结果来计算 $\\Delta \\phi$：\n$$\\Delta \\phi = 3900\\pi \\left( \\frac{-1320}{4144000} \\right) = - \\frac{3900 \\times 1320 \\times \\pi}{4144000} = - \\frac{5148000 \\pi}{4144000}$$\n化简分数：\n$$\\Delta \\phi = - \\frac{5148}{4144} \\pi = - \\frac{1287}{1036} \\pi$$\n现在我们计算数值：\n$$\\Delta \\phi \\approx -1.24227799... \\times \\pi \\approx -3.902783... \\ \\mathrm{rad}$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $3$、$9$、$0$ 和 $2$。$2$ 后面的数字是 $7$，所以我们向上取整。\n$$\\Delta \\phi \\approx -3.903\\ \\mathrm{rad}$$\n负号表示与在水中传播相同距离的波相比，穿过骨骼段的波到达得更早（相位超前），因为骨骼中的声速更高。这是必须通过施加相应的相位延迟来补偿的相位误差。", "answer": "$$ \\boxed{-3.903} $$", "id": "4480671"}, {"introduction": "在克服了颅骨的障碍并将超声波精确聚焦到靶点后，下一个关键问题是如何量化其治療效果，尤其是在热消融应用中。热剂量是预测和控制组织损伤范围的核心概念，它将温度和时间的历程整合为一个生物学等效指标。本练习 [@problem_id:4480735] 让您亲手计算一个关键的热剂量单位——43°C等效累积分钟数（$CEM43$），从而将物理上的加热过程与临床所需的生物效应联系起来。", "problem": "聚焦超声 (FUS) 在神经病学中用于热消融，例如在丘脑切开术中靶向腹侧中间核以治疗特发性震颤。加热引起的组织损伤动力学可以在基础层面上通过阿伦尼乌斯型损伤积分进行建模，这意味着单位时间内累积的损伤随温度单调增加。在热神经外科手术中，一个广泛使用的操作性度量是 $43^\\circ\\mathrm{C}$ 累积等效分钟数，缩写为 CEM43 (Cumulative Equivalent Minutes at $43^\\circ\\mathrm{C}$)。该度量通过一个依赖于温度的权重因子，将任意的温度-时间历史 $T(t)$ 映射到参考温度 $43^\\circ\\mathrm{C}$ 下的等效暴露时长。基于热损伤动力学的经验校准支持使用分段常数权重参数 $R$，使得对于等于或高于 $43^\\circ\\mathrm{C}$ 的温度，有 $R=0.5$。这反映了当温度高于 $43^\\circ\\mathrm{C}$ 时，每升高 $1^\\circ\\mathrm{C}$，损伤率大约加倍的观测结果。\n\n从单位时间内的损伤累积随温度成倍增长的阿伦尼乌斯概念出发，并使用上述对于等于或高于 $43^\\circ\\mathrm{C}$ 温度下 $R$ 的经验校准，推导出 CEM43 作为带有适当温度权重的时间积分表达式。然后，应用您推导的表达式，计算在一次磁共振引导聚焦超声 (MRgFUS) 神经外科超声照射过程中，维持 $T(t)=55^\\circ\\mathrm{C}$ 的恒温平台 $20\\ \\mathrm{s}$ 所对应的 CEM43 值。在 CEM43 定义中，时间变量使用分钟作为单位，并假设对于 $T\\ge 43^\\circ\\mathrm{C}$ 有 $R=0.5$。以分钟表示最终的热剂量，并将您的答案四舍五入到四位有效数字。您的最终答案必须是一个实数值。", "solution": "该问题需要两部分：首先，推导 $43^\\circ\\mathrm{C}$ 累积等效分钟数 (CEM43) 的数学表达式；其次，将此表达式应用于一个具体的热暴露场景。\n\n#### 第1部分：CEM43 表达式的推导\n\nCEM43 是一种热剂量度量，它将给定的温度-时间历史 $T(t)$ 标准化为在恒定参考温度 $T_{\\text{ref}} = 43^\\circ\\mathrm{C}$ 下的等效暴露时长。其基本原理源于阿伦尼乌斯动力学，即热诱导生物损伤的速率（我们将其表示为 $\\dot{\\Omega}$）是温度的强函数。\n\n在从 $t=0$ 到 $t=t_{\\text{final}}$ 的时间间隔内，总累积损伤 $\\Omega$ 由损伤速率的积分给出：\n$$ \\Omega = \\int_0^{t_{\\text{final}}} \\dot{\\Omega}(T(t)) dt $$\nCEM43 定义为：如果温度恒定保持在 $T_{\\text{ref}}$，产生相同总损伤 $\\Omega$ 所需的时间 $t_{\\text{eq}}$：\n$$ \\Omega = \\dot{\\Omega}(T_{\\text{ref}}) \\cdot t_{\\text{eq}} = \\dot{\\Omega}(T_{\\text{ref}}) \\cdot \\text{CEM43} $$\n令两个关于 $\\Omega$ 的表达式相等，可得：\n$$ \\dot{\\Omega}(T_{\\text{ref}}) \\cdot \\text{CEM43} = \\int_0^{t_{\\text{final}}} \\dot{\\Omega}(T(t)) dt $$\n求解 CEM43，我们得到：\n$$ \\text{CEM43} = \\int_0^{t_{\\text{final}}} \\frac{\\dot{\\Omega}(T(t))}{\\dot{\\Omega}(T_{\\text{ref}})} dt $$\n项 $\\frac{\\dot{\\Omega}(T(t))}{\\dot{\\Omega}(T_{\\text{ref}})}$ 是无量纲的、依赖于温度的权重因子。问题陈述，对于温度 $T \\ge 43^\\circ\\mathrm{C}$，每升高 $1^\\circ\\mathrm{C}$，损伤率大约加倍。让我们将此关系形式化。在温度 $T$ 下的损伤率与参考温度 $T_{\\text{ref}} = 43^\\circ\\mathrm{C}$ 下的损伤率之比可以表示为一个指数函数。相对于 $T_{\\text{ref}}$ 每升高一摄氏度，速率乘以因子 $2$。因此，对于 $(T - T_{\\text{ref}})$ 度的温差，速率将乘以 $2$ 这么多次。\n这导出了 $T \\ge T_{\\text{ref}}$ 时的权重因子：\n$$ \\frac{\\dot{\\Omega}(T)}{\\dot{\\Omega}(T_{\\text{ref}})} = 2^{(T - T_{\\text{ref}})} $$\n其中温度单位为摄氏度。\n\n问题使用参数 $R=0.5$ 来定义模型。让我们展示这如何与我们推导的权重因子相关联。CEM43 积分的标准公式使用 $R$：\n$$ \\text{CEM43} = \\int_0^{t_{\\text{final}}} R^{(T_{\\text{ref}} - T(t))} dt $$\n对于 $T \\ge 43^\\circ\\mathrm{C}$，给定 $R=0.5$。代入此值，权重因子变为：\n$$ R^{(T_{\\text{ref}} - T)} = (0.5)^{(T_{\\text{ref}} - T)} = \\left(\\frac{1}{2}\\right)^{(T_{\\text{ref}} - T)} = (2^{-1})^{(T_{\\text{ref}} - T)} = 2^{-(T_{\\text{ref}} - T)} = 2^{(T - T_{\\text{ref}})} $$\n这证实了使用 $R=0.5$ 的标准公式与“温度高于 $43^\\circ\\mathrm{C}$ 时每升高 $1^\\circ\\mathrm{C}$ 损伤率加倍”的经验观察完全一致。\n\n因此，推导出的 CEM43 表达式（其中时间 $t$ 以分钟为单位）是：\n$$ \\text{CEM43} = \\int_0^{t_{\\text{final}}} R^{(43 - T(t))} dt $$\n其中对于 $T(t) \\ge 43^\\circ\\mathrm{C}$ 有 $R=0.5$。\n\n#### 第2部分：针对特定场景的计算\n\n我们需要计算在 $T(t) = T_{\\text{plateau}} = 55^\\circ\\mathrm{C}$ 的恒温平台下维持 $20\\ \\mathrm{s}$ 的 CEM43 值。\n\n首先，我们必须将持续时间转换为所要求的单位——分钟。设 $\\Delta t$ 为持续时间。\n$$ \\Delta t = 20\\ \\mathrm{s} \\times \\frac{1\\ \\text{min}}{60\\ \\mathrm{s}} = \\frac{20}{60}\\ \\text{min} = \\frac{1}{3}\\ \\text{min} $$\n暴露时间从 $t=0$ 开始，到 $t_{\\text{final}} = \\frac{1}{3}$ 分钟结束。\n\n由于在整个时间间隔内温度恒定为 $T(t)=55^\\circ\\mathrm{C}$，且 $55^\\circ\\mathrm{C} \\ge 43^\\circ\\mathrm{C}$，我们使用 $R=0.5$。被积函数 $R^{(43 - T(t))}$ 是一个常数。\n$$ R^{(43 - T(t))} = (0.5)^{(43 - 55)} = (0.5)^{(-12)} $$\n该积分简化为常数被积函数乘以时间间隔的长度：\n$$ \\text{CEM43} = \\int_0^{1/3} (0.5)^{(-12)} dt = (0.5)^{(-12)} \\cdot \\int_0^{1/3} dt $$\n$$ \\text{CEM43} = (0.5)^{(-12)} \\cdot \\left[t\\right]_0^{1/3} = (0.5)^{(-12)} \\cdot \\left(\\frac{1}{3} - 0\\right) $$\n$$ \\text{CEM43} = (0.5)^{(-12)} \\cdot \\frac{1}{3} $$\n现在我们对该表达式进行数值计算。\n$$ (0.5)^{(-12)} = \\left(\\frac{1}{2}\\right)^{(-12)} = 2^{12} $$\n我们知道 $2^{10} = 1024$，所以 $2^{12} = 2^{10} \\times 2^2 = 1024 \\times 4 = 4096$。\n$$ \\text{CEM43} = 4096 \\cdot \\frac{1}{3} = \\frac{4096}{3} $$\n$$ \\text{CEM43} \\approx 1365.333... \\text{ 分钟} $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$3$、$6$ 和 $5$。第五位数字是 $3$，小于 $5$，所以我们向下舍入。\n结果值为 $1365$。", "answer": "$$\n\\boxed{1365}\n$$", "id": "4480735"}]}