{"hands_on_practices": [{"introduction": "在临床实践中，诊断性病性溃疡疾病不仅需要了解检测方法的内在性能（如敏感性和特异性），还必须能够根据特定患者群体的疾病流行率来解释检测结果。这项练习将通过计算阳性预测值（$PPV$）和阴性预测值（$NPV$）来实践贝叶斯定理的应用，这是将检测数据转化为有意义的临床概率、从而指导后续诊断与治疗决策的核心技能。通过这个基于腹股沟肉芽肿（杜诺凡病）诊断场景的练习[@problem_id:4419765]，你将掌握如何评估一个诊断测试在特定临床环境下的真实价值。", "problem": "一家位于腹股沟肉芽肿（杜诺凡病）发病率稳定地区的性传播感染诊所，使用直接组织涂片配合 Wright-Giemsa 染色来检测细胞内的 Donovan 小体。对于一位有症状的患者，临床医生估计其患有杜诺凡病的检验前概率为 $10\\%$。已发表的关于该涂片检查的验证研究显示，当应用于此临床情境时，其灵敏度为 $80\\%$，特异度为 $95\\%$。\n\n请仅从灵敏度、特异度、检验前概率（为在可比队列中进行概率计算，可将其解释为疾病患病率）和贝叶斯定理的基本定义出发，推导阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式，其中 PPV 是指在检测结果为阳性的条件下患有该疾病的后验概率，NPV 是指在检测结果为阴性的条件下未患该疾病的后验概率。然后，使用给定的参数计算在此情境下该检验的 PPV 和 NPV 的数值。\n\n请以行矩阵 $\\begin{pmatrix}\\text{PPV}  \\text{NPV}\\end{pmatrix}$ 的形式报告最终结果，其中每个条目均表示为小数并四舍五入至四位有效数字。答案中任何地方都不得使用百分号。", "solution": "所述问题是有效的。它在科学上基于生物统计学和流行病学的原理，问题提法清晰，提供了所有必要的数据，且表述客观。我们可以开始求解。\n\n设 $D$ 为患者患有杜诺凡病的事件，$D^c$ 为患者未患杜诺凡病的事件。设 $T^+$ 为检测结果为阳性的事件，$T^-$ 为检测结果为阴性的事件。\n\n问题陈述中给出的条件可转换为以下概率术语：\n1.  疾病的检验前概率，解释为患病率：$P(D) = 0.10$。\n2.  检验的灵敏度，即在患有疾病的情况下检测结果为阳性的概率：$P(T^+|D) = 0.80$。\n3.  检验的特异度，即在未患疾病的情况下检测结果为阴性的概率：$P(T^-|D^c) = 0.95$。\n\n根据这些已知条件，我们可以推导出以下互补概率：\n- 患者未患病的概率为 $P(D^c) = 1 - P(D) = 1 - 0.10 = 0.90$。\n- 假阴性（在患病的情况下检测结果为阴性）的概率为 $P(T^-|D) = 1 - P(T^+|D) = 1 - 0.80 = 0.20$。\n- 假阳性（在未患病的情况下检测结果为阳性）的概率为 $P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - 0.95 = 0.05$。\n\n问题要求推导和计算阳性预测值 (PPV) 和阴性预测值 (NPV)。\n\n**1. 阳性预测值 (PPV) 的推导与计算**\n\nPPV 是指在检测结果为阳性的条件下，患者确实患病的后验概率，记为 $P(D|T^+)$。我们使用贝叶斯定理进行推导：\n$$ \\text{PPV} = P(D|T^+) = \\frac{P(T^+|D) P(D)}{P(T^+)} $$\n\n分母 $P(T^+)$ 是获得阳性检测结果的总概率。它可以通过全概率公式计算，即对两种互斥情况（患病和未患病）的概率求和。\n$$ P(T^+) = P(T^+|D)P(D) + P(T^+|D^c)P(D^c) $$\n\n将此展开式代入贝叶斯定理表达式，即可得到用给定参数（灵敏度、特异度和患病率）表示的 PPV 完整公式：\n$$ \\text{PPV} = \\frac{P(T^+|D) P(D)}{P(T^+|D) P(D) + P(T^+|D^c) P(D^c)} $$\n我们将灵敏度记为 $\\text{sens} = P(T^+|D)$，特异度记为 $\\text{spec} = P(T^-|D^c)$，患病率记为 $\\text{prev} = P(D)$。则表达式变为：\n$$ \\text{PPV} = \\frac{\\text{sens} \\times \\text{prev}}{(\\text{sens} \\times \\text{prev}) + ((1 - \\text{spec}) \\times (1 - \\text{prev}))} $$\n\n现在，我们代入数值：\n$$ \\text{PPV} = \\frac{0.80 \\times 0.10}{(0.80 \\times 0.10) + (0.05 \\times 0.90)} $$\n$$ \\text{PPV} = \\frac{0.08}{0.08 + 0.045} $$\n$$ \\text{PPV} = \\frac{0.08}{0.125} = 0.64 $$\n\n**2. 阴性预测值 (NPV) 的推导与计算**\n\nNPV 是指在检测结果为阴性的条件下，患者确实未患病的后验概率，记为 $P(D^c|T^-)$。我们再次使用贝叶斯定理：\n$$ \\text{NPV} = P(D^c|T^-) = \\frac{P(T^-|D^c) P(D^c)}{P(T^-)} $$\n\n分母 $P(T^-)$ 是获得阴性检测结果的总概率。它通过全概率公式计算：\n$$ P(T^-) = P(T^-|D)P(D) + P(T^-|D^c)P(D^c) $$\n\n将此代入贝叶斯定理表达式，即可得到 NPV 的完整公式：\n$$ \\text{NPV} = \\frac{P(T^-|D^c) P(D^c)}{P(T^-|D) P(D) + P(T^-|D^c) P(D^c)} $$\n用灵敏度、特异度和患病率表示：\n$$ \\text{NPV} = \\frac{\\text{spec} \\times (1 - \\text{prev})}{((1 - \\text{sens}) \\times \\text{prev}) + (\\text{spec} \\times (1 - \\text{prev}))} $$\n\n现在，我们代入数值：\n$$ \\text{NPV} = \\frac{0.95 \\times 0.90}{(0.20 \\times 0.10) + (0.95 \\times 0.90)} $$\n$$ \\text{NPV} = \\frac{0.855}{0.02 + 0.855} $$\n$$ \\text{NPV} = \\frac{0.855}{0.875} $$\n$$ \\text{NPV} \\approx 0.977142857... $$\n\n问题要求将结果四舍五入至四位有效数字。\n- PPV: $0.64$ 变为 $0.6400$。\n- NPV: $0.977142857...$ 四舍五入到四位有效数字是 $0.9771$。\n\n最终答案以行矩阵 $\\begin{pmatrix}\\text{PPV}  \\text{NPV}\\end{pmatrix}$ 的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6400  0.9771 \\end{pmatrix}}$$", "id": "4419765"}, {"introduction": "成功治疗软下疳不仅取决于药物的固有疗效，还受到患者依从性的显著影响，尤其是在比较单剂量与多剂量治疗方案时。本练习将探讨“方案依从疗效”与“总体治愈概率”之间的关键区别，强调在真实世界中评估治疗方案有效性时必须考虑患者行为因素。通过这个实践[@problem_id:4419826]，你将学会量化依从性对治疗结果的影响，这对于制定更有效、更切合实际的公共卫生策略至关重要。", "problem": "一组成年患者因感染 Haemophilus ducreyi 而出现软下疳，正在考虑两种符合指南的抗菌药物方案。方案1是为期多日的 ciprofloxacin 疗程，方案2是单剂量的 azithromycin。设事件 $A$ 表示对处方方案的完全依从性，事件 $C$ 表示细菌学治愈。符合方案疗效（Per-protocol efficacy）定义为在完全依从性条件下的治愈概率，即 $P(C \\mid A)$，并假设不依从导致可忽略的抗菌药物暴露，此时 $P(C \\mid \\neg A) = 0$。对于 ciprofloxacin，假设依从比例为 $P(A) = 0.70$，符合方案疗效为 $P(C \\mid A) = 0.95$。对于 azithromycin，假设完全依从，$P(A) = 1$，且符合方案疗效为 $P(C \\mid A) = 0.90$。仅使用基本概率定义和给定假设，计算 azithromycin 和 ciprofloxacin 之间总体治愈概率的绝对差值，并以小数表示。将最终答案四舍五入至四位有效数字，并提供不带单位的结果。", "solution": "我们从总体治愈概率的基本定义出发，并用依从性来表示。设 $A$ 为依从事件，$C$ 为治愈事件。根据应用于划分 $\\{A, \\neg A\\}$ 的全概率公式，给定方案的总体治愈概率为\n$$\nP(C) = P(C \\mid A) P(A) + P(C \\mid \\neg A) P(\\neg A).\n$$\n在不依从导致可忽略的抗菌药物暴露这一既定假设下，我们设 $P(C \\mid \\neg A) = 0$。因此，总体治愈概率简化为\n$$\nP(C) = P(C \\mid A) P(A).\n$$\n\n对于 ciprofloxacin 方案，我们已知 $P(A) = 0.70$ 和 $P(C \\mid A) = 0.95$。因此，\n$$\nP(C)_{\\text{cip}} = 0.95 \\times 0.70 = 0.665.\n$$\n\n对于 azithromycin 方案，我们已知 $P(A) = 1$ 和 $P(C \\mid A) = 0.90$。因此，\n$$\nP(C)_{\\text{azi}} = 0.90 \\times 1 = 0.90.\n$$\n\nazithromycin 和 ciprofloxacin 之间总体治愈概率的绝对差值为\n$$\n\\Delta = \\left| P(C)_{\\text{azi}} - P(C)_{\\text{cip}} \\right| = |0.90 - 0.665| = 0.235.\n$$\n\n将 $\\Delta$ 四舍五入至四位有效数字可得\n$$\n0.2350.\n$$", "answer": "$$\\boxed{0.2350}$$", "id": "4419826"}, {"introduction": "从个体患者的治疗转向群体层面的疾病控制，需要我们运用流行病学模型来理解和预测疫情动态。本练习将引导你从基本原理出发，推导在异质性接触网络中（这更贴近性传播疾病的真实传播模式）的基本再生数（$R_0$）。通过分析一个假设的高接触网络场景[@problem_id:4419796]，你将计算出通过缩短感染持续时间来控制疫情所需的干预力度，从而深入理解网络结构和关键参数如何决定流行病的传播阈值。", "problem": "一个有患上性传播溃疡性疾病（如软下疳（由杜克雷嗜血杆菌引起））和腹股沟肉芽肿或多诺万病（由肉芽肿克雷伯菌引起））风险的人群，被组织成一个高接触性行为网络。假设以下基本前提：直接传播感染的基本再生数$R_0$定义为，在完全易感的人群中引入一个典型的感染个体所产生的预期继发感染数；并且传播是由作为泊松过程发生的独立性接触事件引起的。设每次接触的传播概率为$\\beta$，每段伴侣关系的接触率为$f$（单位时间内的接触次数），平均感染持续时间为$D$。\n\n在均匀混合模型中，再生数由每次接触的传播概率、接触率和感染持续时间的乘积得出。在具有度异质性的配置模型网络中，新感染的个体更可能有较高的度，这通过度分布的二阶矩与一阶矩之比放大了传播机会，并且在一个感染期内沿一条边的传播率取决于独立接触事件的聚合。\n\n从这些原则出发，不借助任何预先给出的简化公式，推导流行病阈值的表达式，该表达式用一个感染期内每条边的传播率和度矩来表示，并对每条边的传播率使用由较小的每次接触传播风险所证明合理的一阶近似。然后，考虑以下与软下疳和多诺万病控制相关的高接触子网络的科学真实参数：\n\n- 度矩：平均度为 $\\langle k \\rangle = 5$，超额度矩为 $\\langle k^2 - k \\rangle = 20$。\n- 每次接触的传播概率为 $\\beta = 0.01$。\n- 每段伴侣关系的接触率为 $f = 5$ 次/周。\n- 无治疗情况下的基线平均感染持续时间为 $D_0 = 10$ 周。\n\n假设实施了一项单剂量治疗方案，使得平均感染持续时间乘性缩短为 $D = (1 - r) D_0$，其中 $0 \\leq r \\leq 1$ 是通过快速病例发现和立即治疗实现的比例减少量，并且$\\beta$和$f$保持不变。使用您推导的表达式，计算将再生数推至流行病阈值以下所需的最小$r$值。将最小比例减少量$r$表示为小数，并将您的答案四舍五入到四位有效数字。", "solution": "该问题陈述被评估为有效。它在科学上基于网络流行病学的原理，问题设定良好，目标明确，信息充分，并使用客观、正式的语言。该问题要求推导在异质网络上传播的疾病的基本再生数，并随后计算一个控制参数，这是数学流行病学中的一个标准任务。\n\n推导和求解过程如下。\n\n在异质网络的背景下，基本再生数$R_0$最恰当的定义是：在疫情爆发初期，由单个感染个体产生的预期继发感染数，同时考虑到早期被感染的个体并非从总体中均匀随机选择的。在网络中，感染沿边传播，因此新感染的个体是通过从一个具传染性的邻居处沿某条边被感染的。因此，这样一个体度的并非代表整个人群的典型情况，而是从超额度分布中抽取的。\n\n我们首先推导传播率$T$，它是在整个感染期$D$内，感染在一对相连个体之间（沿一条边）传播的概率。问题陈述，性接触以每个伴侣关系每单位时间$f$次的速率，作为一个泊松过程发生。因此，在感染持续时间$D$内，单条伴侣关系边上的接触次数$c$遵循平均值为$\\lambda = fD$的泊松分布。发生$c$次接触的概率由$P(c) = \\frac{(fD)^c \\exp(-fD)}{c!}$给出。\n\n每次接触的传播概率是$\\beta$。单次接触*不*发生传播的概率是$1-\\beta$。对于$c$次独立接触，不发生传播的概率是$(1-\\beta)^c$。因此，至少发生一次传播事件（即，该伴侣关系导致感染）的概率是$1 - (1-\\beta)^c$。\n\n为了求出在持续时间$D$内的总传播率$T$，我们必须将这个概率在所有可能的$c$值上进行平均，并以泊松分布为权重：\n$$\nT = \\sum_{c=0}^{\\infty} \\left[1 - (1-\\beta)^c\\right] P(c) = \\sum_{c=0}^{\\infty} \\left[1 - (1-\\beta)^c\\right] \\frac{(fD)^c \\exp(-fD)}{c!}\n$$\n我们可以拆分这个求和：\n$$\nT = \\sum_{c=0}^{\\infty} \\frac{(fD)^c \\exp(-fD)}{c!} - \\sum_{c=0}^{\\infty} (1-\\beta)^c \\frac{(fD)^c \\exp(-fD)}{c!}\n$$\n第一项是完整概率分布的和，等于$1$。对于第二项，我们合并幂次并提出指数项：\n$$\nT = 1 - \\exp(-fD) \\sum_{c=0}^{\\infty} \\frac{[(1-\\beta)fD]^c}{c!}\n$$\n该求和是指数函数的泰勒级数，$\\sum_{n=0}^{\\infty} \\frac{x^n}{n!} = \\exp(x)$。令$x = (1-\\beta)fD$，我们得到：\n$$\nT = 1 - \\exp(-fD) \\exp((1-\\beta)fD) = 1 - \\exp(-fD + fD - \\beta fD) = 1 - \\exp(-\\beta f D)\n$$\n问题要求对$T$使用一阶近似，理由是每次接触的传播概率$\\beta$很小。$T(\\beta) = 1 - \\exp(-\\beta f D)$在$\\beta=0$附近的泰勒展开为：\n$$\nT(\\beta) = 1 - \\left(1 - (\\beta f D) + \\frac{(\\beta f D)^2}{2!} - \\dots\\right) = \\beta f D - \\frac{(\\beta f D)^2}{2} + \\dots\n$$\n因此，一阶近似为$T \\approx \\beta f D$。\n\n接下来，我们推导$R_0$的表达式。在具有度异质性的网络中，$R_0$是一个新感染个体的易感伴侣的平均数与对每个伴侣的传播率$T$的乘积。通过遍历随机边到达的节点的度分布是超额度分布。对于这样一个度为$k$的节点，可供其传播的伴侣数量为$k-1$。这个量在超额度分布上的期望值，给出了一个新感染节点的平均出边数。这就是平均超额度，$\\langle k_{excess} \\rangle$。\n$$\n\\langle k_{excess} \\rangle = \\sum_{k} (k-1) \\frac{k P(k)}{\\langle k \\rangle} = \\frac{1}{\\langle k \\rangle} \\sum_{k} (k^2 - k) P(k) = \\frac{\\langle k^2 - k \\rangle}{\\langle k \\rangle}\n$$\n其中$\\langle k \\rangle$是平均度，$\\langle k^2 - k \\rangle$是度分布的二阶阶乘矩。\n\n再生数$R_0$是平均超额度与每条边的传播率$T$的乘积：\n$$\nR_0 = \\langle k_{excess} \\rangle T = \\frac{\\langle k^2 - k \\rangle}{\\langle k \\rangle} T\n$$\n流行病阈值是条件$R_0 = 1$。使用$T$的一阶近似：\n$$\nR_0 \\approx \\frac{\\langle k^2 - k \\rangle}{\\langle k \\rangle} (\\beta f D)\n$$\n问题陈述，一个治疗方案将平均感染持续时间从基线$D_0$减少到$D = (1 - r) D_0$，其中$r$是比例减少量。将此代入$R_0$的表达式：\n$$\nR_0(r) = \\frac{\\langle k^2 - k \\rangle}{\\langle k \\rangle} \\beta f (1 - r) D_0\n$$\n我们可以定义基线再生数$R_{0, \\text{baseline}}$为当$r=0$（无干预）时的$R_0$值：\n$$\nR_{0, \\text{baseline}} = \\frac{\\langle k^2 - k \\rangle}{\\langle k \\rangle} \\beta f D_0\n$$\n所以，$R_0(r) = R_{0, \\text{baseline}} (1-r)$。目标是找到将再生数降至流行病阈值$1$以下的最小$r$。这个最小值对应于设置$R_0(r) = 1$。\n$$\n1 = R_{0, \\text{baseline}} (1-r)\n$$\n解出$r$：\n$$\n1 - r = \\frac{1}{R_{0, \\text{baseline}}} \\implies r = 1 - \\frac{1}{R_{0, \\text{baseline}}}\n$$\n现在，我们代入给定的数值：\n- 平均度：$\\langle k \\rangle = 5$\n- 超额度矩：$\\langle k^2 - k \\rangle = 20$\n- 每次接触的传播概率：$\\beta = 0.01$\n- 每段伴侣关系的接触率：$f = 5$ 次/周\n- 基线感染持续时间：$D_0 = 10$ 周\n\n首先，计算基线再生数$R_{0, \\text{baseline}}$：\n$$\nR_{0, \\text{baseline}} = \\frac{20}{5} \\times 0.01 \\times 5 \\times 10 = 4 \\times 0.5 = 2\n$$\n基线再生数为$2$。这意味着平均而言，每个感染会导致两个新感染，疫情将会增长。\n现在，我们计算达到$R_0 = 1$所需的最小比例减少量$r$：\n$$\nr = 1 - \\frac{1}{2} = 0.5\n$$\n需要将平均感染持续时间减少$0.5$的比例，才能将再生数降至阈值$1$。对于任何$r > 0.5$，再生数将低于$1$，疫情将会消退。问题要求的是最小的$r$，即这个临界值。表示为四位有效数字的小数，即$0.5000$。", "answer": "$$\n\\boxed{0.5000}\n$$", "id": "4419796"}]}