{"hands_on_practices": [{"introduction": "评估任何人工智能（AI）诊断工具的第一步是量化其性能。混淆矩阵是此评估的基础，而诸如灵敏度（sensitivity）、特异性（specificity）和阳性预测值（positive predictive value）等指标，是描述模型准确性的通用语言。本练习将通过一个关于黑色素瘤分类器的假设场景，让您亲手计算这些核心性能指标，从而掌握评估AI分类器在远程皮肤病学应用中表现的基本技能。[@problem_id:4496240]", "problem": "一个远程皮肤病学服务集成了一个人工智能（AI）黑色素瘤分类器来对皮肤镜图像进行分诊。在一个独立测试集上，记录的混淆矩阵计数为：$TP=95$（真阳性），$FP=15$（假阳性），$FN=5$（假阴性），和$TN=85$（真阴性）。仅从医学二元诊断评估中使用的核心定义出发——敏感性量化了被正确识别的实际患病比例，特异性量化了被正确识别的非患病比例，阳性预测值量化了在测试结果为阳性条件下患病的概率，阴性预测值量化了在测试结果为阴性条件下不患病的概率，以及$F1$-分数是精确率和召回率的调和平均数——推导适用于该测试集的敏感性$Se$、特异性$Sp$、阳性预测值$PPV$、阴性预测值$NPV$和$F1$-分数$F1$的解析表达式，并使用所提供的计数进行评估。将每个结果表示为最简形式的精确分数。以单行矩阵的形式提供你的最终答案，顺序为 $Se$、$Sp$、$PPV$、$NPV$、$F1$。", "solution": "该问题要求在给定混淆矩阵计数的情况下，推导和评估一个二元诊断测试的五个标准性能指标。所提供的计数为：真阳性（$TP=95$），假阳性（$FP=15$），假阴性（$FN=5$），和真阴性（$TN=85$）。需要确定的指标是敏感性（$Se$）、特异性（$Sp$）、阳性预测值（$PPV$）、阴性预测值（$NPV$）和$F1$-分数（$F1$）。我们将根据每个指标的定义推导其解析表达式，然后使用给定数据进行评估。\n\n首先，我们根据基本计数定义一些复合量。患病受试者总数（实际阳性）是真阳性和假阴性之和：\n$$P = TP + FN$$\n未患病受试者总数（实际阴性）是真阴性和假阳性之和：\n$$N = TN + FP$$\n阳性测试结果总数（预测阳性）是真阳性和假阳性之和：\n$$P_{pred} = TP + FP$$\n阴性测试结果总数（预测阴性）是真阴性和假阴性之和：\n$$N_{pred} = TN + FN$$\n\n现在我们推导每个指标。\n\n1.  **敏感性 ($Se$)**：问题将敏感性定义为被正确识别的实际患病比例。这是真阳性数与患病受试者总数的比率。\n    解析表达式为：\n    $$Se = \\frac{TP}{P} = \\frac{TP}{TP + FN}$$\n    代入给定值：\n    $$Se = \\frac{95}{95 + 5} = \\frac{95}{100}$$\n    化为最简分数，得到：\n    $$Se = \\frac{19}{20}$$\n\n2.  **特异性 ($Sp$)**：问题将特异性定义为被正确识别的非患病比例。这是真阴性数与未患病受试者总数的比率。\n    解析表达式为：\n    $$Sp = \\frac{TN}{N} = \\frac{TN}{TN + FP}$$\n    代入给定值：\n    $$Sp = \\frac{85}{85 + 15} = \\frac{85}{100}$$\n    化为最简分数，得到：\n    $$Sp = \\frac{17}{20}$$\n\n3.  **阳性预测值 ($PPV$)**：问题将阳性预测值定义为在测试结果为阳性条件下患病的概率。这是真阳性数与阳性测试结果总数的比率。\n    解析表达式为：\n    $$PPV = \\frac{TP}{P_{pred}} = \\frac{TP}{TP + FP}$$\n    代入给定值：\n    $$PPV = \\frac{95}{95 + 15} = \\frac{95}{110}$$\n    化为最简分数，得到：\n    $$PPV = \\frac{19}{22}$$\n\n4.  **阴性预测值 ($NPV$)**：问题将阴性预测值定义为在测试结果为阴性条件下不患病的概率。这是真阴性数与阴性测试结果总数的比率。\n    解析表达式为：\n    $$NPV = \\frac{TN}{N_{pred}} = \\frac{TN}{TN + FN}$$\n    代入给定值：\n    $$NPV = \\frac{85}{85 + 5} = \\frac{85}{90}$$\n    化为最简分数，得到：\n    $$NPV = \\frac{17}{18}$$\n\n5.  **F1-分数 ($F1$)**：问题将$F1$-分数定义为精确率和召回率的调和平均数。按照标准惯例，‘召回率’是敏感性（$Se$）的另一个术语，而‘精确率’是阳性预测值（$PPV$）的另一个术语。两个数 $a$ 和 $b$ 的调和平均数是 $H = \\frac{2ab}{a+b}$。\n    因此，$F1$-分数为：\n    $$F1 = \\frac{2 \\times PPV \\times Se}{PPV + Se}$$\n    我们可以代入 $Se$ 和 $PPV$ 的解析表达式，以基本计数来推导公式：\n    $$F1 = \\frac{2 \\left( \\frac{TP}{TP+FP} \\right) \\left( \\frac{TP}{TP+FN} \\right)}{\\frac{TP}{TP+FP} + \\frac{TP}{TP+FN}}$$\n    通过通分和化简，该表达式简化为：\n    $$F1 = \\frac{2TP}{2TP + FP + FN}$$\n    使用此表达式进行计算非常直接。代入给定值：\n    $$F1 = \\frac{2 \\times 95}{2 \\times 95 + 15 + 5} = \\frac{190}{190 + 20} = \\frac{190}{210}$$\n    化为最简分数，得到：\n    $$F1 = \\frac{19}{21}$$\n\n评估的五个指标，以最简精确分数表示为：$Se = \\frac{19}{20}$，$Sp = \\frac{17}{20}$，$PPV = \\frac{19}{22}$，$NPV = \\frac{17}{18}$，以及 $F1 = \\frac{19}{21}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{19}{20}  \\frac{17}{20}  \\frac{19}{22}  \\frac{17}{18}  \\frac{19}{21}\n\\end{pmatrix}\n}\n$$", "id": "4496240"}, {"introduction": "掌握AI模型的原始性能指标后，下一步是学习如何将其融入临床诊断思维。贝叶斯定理为我们提供了一个严谨的框架，用以根据新证据（即AI的检测结果）更新我们对疾病可能性的判断。[@problem_id:4496218]将指导您如何利用已知的灵敏度$Se$和特异性$Sp$，结合先验概率，来计算阳性结果后的疾病后验概率，这是在远程医疗中进行循证决策的一项关键技能。", "problem": "一个远程皮肤科分诊服务部署了一个人工智能（AI）分类器，用于分析远程提交的皮肤镜图像，以进行黑色素瘤风险分层。在此背景下，考虑针对与初级保健转诊相似的人群进行黑色素瘤与非黑色素瘤的二元分类。该分类器的诊断性能由灵敏度和特异度来概括，并且在分类器输出阳性结果后，使用贝叶斯推断来更新疾病概率。\n\n从灵敏度 $Se$ 是条件概率 $P(\\text{positive} \\mid \\text{melanoma})$ 和特异度 $Sp$ 是条件概率 $P(\\text{negative} \\mid \\text{no melanoma})$ 的基本定义出发，并根据经过充分检验的贝叶斯定理赔率形式（即后验赔率等于先验赔率乘以观察结果的似然比），请从 $Se$ 和 $Sp$ 推导出阳性似然比，然后计算在AI结果为阳性后，患有黑色素瘤的后验赔率和后验概率。\n\n假设灵敏度 $Se=0.92$，特异度 $Sp=0.88$，以及黑色素瘤的检验前（先验）概率 $p=0.10$。仅使用这些输入和上述基本定义与事实，确定：\n- 阳性似然比，\n- 在AI结果为阳性时的后验赔率，\n- 在AI结果为阳性时患有黑色素瘤的后验概率。\n\n以精确值（不进行四舍五入）表示您的最终结果。不包含单位。请按以上顺序回答这三个量。", "solution": "问题陈述经评估有效。它在科学上基于医学统计学和贝叶斯推断的既定原则，问题提法严谨，提供了所有必要数据，并且其表述是客观的。因此，我们可以开始求解。\n\n问题要求计算三个量：阳性似然比 ($LR+$)，在检验结果为阳性时患有黑色素瘤的后验赔率，以及在检验结果为阳性时患有黑色素瘤的后验概率。我们已知以下数值：\n- 灵敏度, $Se = P(\\text{positive} \\mid \\text{melanoma}) = 0.92$\n- 特异度, $Sp = P(\\text{negative} \\mid \\text{no melanoma}) = 0.88$\n- 黑色素瘤的检验前（先验）概率, $p = P(\\text{melanoma}) = 0.10$\n\n设 $M$ 表示患者患有黑色素瘤的事件，$M^c$ 表示患者没有患黑色素瘤的事件。设 $T^+$ 表示AI分类器结果为阳性的事件，$T^-$ 表示结果为阴性的事件。给定信息可以写成：\n- $Se = P(T^+ \\mid M) = 0.92$\n- $Sp = P(T^- \\mid M^c) = 0.88$\n- $p = P(M) = 0.10$。从此，没有患黑色素瘤的先验概率是 $P(M^c) = 1 - P(M) = 1 - 0.10 = 0.90$。\n\n**1. 阳性似然比 ($LR+$) 的推导与计算**\n\n阳性似然比 $LR+$ 定义为患病个体中检验结果为阳性的概率与未患病个体中检验结果为阳性的概率之比。\n$$LR+ = \\frac{P(T^+ \\mid M)}{P(T^+ \\mid M^c)}$$\n分子是灵敏度 $Se$，其值为 $0.92$。\n$$P(T^+ \\mid M) = Se = 0.92$$\n分母 $P(T^+ \\mid M^c)$ 是假阳性概率。我们已知特异度 $Sp = P(T^- \\mid M^c)$。由于检验结果只能是阳性或阴性，对于非黑色素瘤组，这些条件概率之和必须为 $1$。\n$$P(T^+ \\mid M^c) + P(T^- \\mid M^c) = 1$$\n因此，我们可以如下求出假阳性率：\n$$P(T^+ \\mid M^c) = 1 - P(T^- \\mid M^c) = 1 - Sp$$\n代入给定的 $Sp$ 值：\n$$P(T^+ \\mid M^c) = 1 - 0.88 = 0.12$$\n现在，我们可以计算阳性似然比：\n$$LR+ = \\frac{Se}{1 - Sp} = \\frac{0.92}{0.12} = \\frac{92}{12}$$\n将分子和分母同除以它们的最大公约数 $4$ 来化简分数：\n$$LR+ = \\frac{23}{3}$$\n\n**2. 后验赔率的计算**\n\n问题陈述指出，后验赔率是通过将先验赔率乘以似然比来计算的。首先，我们必须计算黑色素瘤的先验赔率。先验赔率是患病的先验概率与不患病的先验概率之比。\n$$\\text{Prior Odds} = \\frac{P(M)}{P(M^c)} = \\frac{p}{1-p}$$\n使用给定的先验概率 $p=0.10$：\n$$\\text{Prior Odds} = \\frac{0.10}{1 - 0.10} = \\frac{0.10}{0.90} = \\frac{1}{9}$$\n现在我们对阳性检验结果应用贝叶斯定理的赔率形式：\n$$\\text{Posterior Odds} = \\text{Prior Odds} \\times LR+$$\n代入我们已经计算出的值：\n$$\\text{Posterior Odds} = \\frac{1}{9} \\times \\frac{23}{3} = \\frac{23}{27}$$\n这就是在AI结果为阳性的情况下患有黑色素瘤的后验赔率。\n\n**3. 后验概率的计算**\n\n最后一步是将后验赔率转换回概率。设后验概率为 $p_{post} = P(M \\mid T^+)$。后验赔率定义为后验概率与其补集之比：\n$$\\text{Posterior Odds} = \\frac{P(M \\mid T^+)}{P(M^c \\mid T^+)} = \\frac{p_{post}}{1 - p_{post}}$$\n我们已经求得后验赔率为 $\\frac{23}{27}$。我们可以建立方程并求解 $p_{post}$：\n$$\\frac{p_{post}}{1 - p_{post}} = \\frac{23}{27}$$\n$$27 \\cdot p_{post} = 23(1 - p_{post})$$\n$$27 \\cdot p_{post} = 23 - 23 \\cdot p_{post}$$\n$$27 \\cdot p_{post} + 23 \\cdot p_{post} = 23$$\n$$50 \\cdot p_{post} = 23$$\n$$p_{post} = \\frac{23}{50}$$\n或者，可以使用将赔率 ($O$) 转换为概率 ($P$) 的通用公式：$P = \\frac{O}{1+O}$。\n$$p_{post} = \\frac{\\text{Posterior Odds}}{1 + \\text{Posterior Odds}} = \\frac{23/27}{1 + 23/27} = \\frac{23/27}{(27/27) + (23/27)} = \\frac{23/27}{50/27} = \\frac{23}{50}$$\n这就是在AI结果为阳性的情况下患有黑色素瘤的后验概率。其小数形式为 $0.46$。\n\n所要求的三个量按顺序为：\n- 阳性似然比：$\\frac{23}{3}$\n- 后验赔率：$\\frac{23}{27}$\n- 后验概率：$\\frac{23}{50}$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{23}{3}  \\frac{23}{27}  \\frac{23}{50} \\end{pmatrix}}$$", "id": "4496218"}, {"introduction": "人工智能在皮肤病学中的应用远不止于二元分类。它还能执行复杂的图像分割任务，以量化病变的范围，例如在评估银屑病皮损面积和严重程度指数（Psoriasis Area and Severity Index, PASI）时。[@problem_id:4496220]将向您介绍评估分割模型准确性的黄金标准——戴斯系数（Dice coefficient），并让您通过计算来理解其在远程医疗中对于疾病定量评估的实际意义。", "problem": "一个远程皮肤病学服务部署了一个人工智能（AI）系统，用于从智能手机照片中分割银屑病斑块，以辅助估计银屑病面积和严重程度指数（PASI）。对于单张图像，该系统的二值分割输出与皮肤科医生的手动标注进行比较。设混淆矩阵的条目定义如下：真阳性（$TP$）是被正确分割的斑块像素，假阳性（$FP$）是被分割为斑块的非斑块像素，假阴性（$FN$）是分割中遗漏的斑块像素。假设该系统得出 $TP=800$，$FP=200$ 和 $FN=100$。\n\n从两个掩码之间重叠的基于集合的定义出发，推导Dice系数作为 $TP$，$FP$ 和 $FN$ 函数的公式，然后计算其在此情况下的精确值。将Dice系数精确表示为一个分数。最后，基于PASI面积分量的基本属性以及分割重叠在面积估计中的作用，简要解释所计算出的Dice值对于远程护理中面积估计可靠性的临床意义。\n\n您的最终数值答案必须是Dice系数，以精确分数形式表示，無需四舍五入。不需要单位。", "solution": "该问题是有效的，因为它具有科学依据、提法明確且客观。它提供了所有必要的数据来推导所需公式、计算数值并支持临床解释。\n\n按照要求，解答过程分为三部分：Dice系数公式的推导，根据给定数据计算其值，以及临床解释。\n\n**1. Dice系数公式的推导**\n\nDice系数，也称为 Sørensen–Dice 系数，是用于衡量两个样本相似性的统计量。在图像分割的背景下，它衡量预测分割掩码和真实掩码之间的重叠程度。\n\n设 $A$ 为人工智能（AI）系统分割为斑块的像素集合（预测集），设 $B$ 为皮肤科医生手动标注为斑块的像素集合（真实集）。\n\nDice系数 $D$ 根据这些集合定义为它们交集大小的两倍除以它们大小的总和：\n$$D = \\frac{2 |A \\cap B|}{|A| + |B|}$$\n其中 $|S|$ 表示集合 $S$ 的基数（元素数量）。\n\n我们可以使用像素级二分类的标准混淆矩阵术语来表示基数 $|A \\cap B|$、$|A|$ 和 $|B|$：真阳性（$TP$）、假阳性（$FP$）和假阴性（$FN$）。\n\n-   集合的交集 $|A \\cap B|$ 代表同时存在于预测掩码和真实掩碼中的像素数量。根据定义，这些是被正确识别为斑块的像素，对应于真阳性的数量。因此：\n    $$|A \\cap B| = TP$$\n\n-   预测集的大小 $|A|$ 是 AI 分类为斑块的总像素数。这包括被正确识别为斑块的像素（$TP$）和被错误识别为斑塊的像素（被分类为斑块的非斑块像素），即假阳性（$FP$）。因此：\n    $$|A| = TP + FP$$\n\n-   真实集的大小 $|B|$ 是实际上是斑块的总像素数。这包括被正确识别为斑块的像素（$TP$）和 AI 未能识别的实际斑块像素，即假阴性（$FN$）。因此：\n    $$|B| = TP + FN$$\n\n将这些表达式代入Dice系数的基于集合的定义，得出以 $TP$，$FP$ 和 $FN$ 表示的公式：\n$$D = \\frac{2 (TP)}{(TP + FP) + (TP + FN)}$$\n$$D = \\frac{2 TP}{2 TP + FP + FN}$$\n这就是推导出的Dice系数公式。\n\n**2. Dice系数的计算**\n\n问题提供了AI系统在单张图像上性能的以下数值：\n-   $TP = 800$\n-   $FP = 200$\n-   $FN = 100$\n\n我们将这些值代入推导出的公式：\n$$D = \\frac{2 \\times 800}{2 \\times 800 + 200 + 100}$$\n进行算术运算：\n$$D = \\frac{1600}{1600 + 200 + 100}$$\n$$D = \\frac{1600}{1900}$$\n为了将其表示为最简精确分数，我们将分子和分母除以它们的最大公约数 $100$：\n$$D = \\frac{16}{19}$$\n\n**3. 临床解释**\n\n银屑病面积和严重程度指数（PASI）是一个综合评分，其中包括对受银屑病影响的体表面积的评估。在远程皮肤病学环境中，该面积是通过照片中分割出的斑块区域来估计的。因此，这种面积估计的可靠性关键取决于分割算法的准确性。\n\nDice系数定量地衡量了AI分割与临床真实情况之间的空间重叠。值为 $1$ 表示完美重叠，而值为 $0$ 表示没有重叠。计算出的Dice系数为 $\\frac{16}{19} \\approx 0.842$，表明AI与皮肤科医生之間有高度的一致性。\n\n这个高值表明AI系统在估计斑块面积方面在很大程度上是可靠的。然而，它并非完美。基础指标揭示了一种特定的偏差：真实掩码的面积是 $|B| = TP + FN = 800 + 100 = 900$ 像素，而AI预测掩码的面积是 $|A| = TP + FP = 800 + 200 = 1000$ 像素。由于 $FP > FN$，该系统倾向于高估斑块面积。这种高估虽然在整体高度重叠的背景下相对较小，但可能导致PASI面积分数略微偏高。对于远程患者监测，临床决策可能由PASI分数的变化趋势指导，因此理解这种系统性偏差对于临床医生正确解读AI辅助测量并做出明智的治疗调整至关重要。Dice系数为这种分割质量提供了一个单一、稳健的汇总指标，这对于建立对AI工具在远程护理中效用的信任至关重要。", "answer": "$$\\boxed{\\frac{16}{19}}$$", "id": "4496220"}]}