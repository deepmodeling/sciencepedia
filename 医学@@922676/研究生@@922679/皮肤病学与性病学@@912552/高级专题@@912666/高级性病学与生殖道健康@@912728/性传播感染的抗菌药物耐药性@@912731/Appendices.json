{"hands_on_practices": [{"introduction": "本实践探讨了在治疗期间细菌群体中耐药性如何产生的基本问题。它将从头突变（de novo mutation）作为一种罕见的随机事件引入，并指导学生使用强大的概率工具——泊松分布——来对此过程进行建模。这项练习 [@problem_id:4412822] 对于理解耐药性并非一种适应性反应，而是预先存在或随机发生的基因变异的结果至关重要。", "problem": "一名患者因 Neisseria gonorrhoeae 引起的尿道炎到性传播感染（STIs）诊所就诊。在抗菌治疗期间，可能会从头（de novo）出现耐药突变体。设 $N$ 表示在治疗窗口期内赋予耐药性的突变发生的独立机会的有效数量，设 $\\mu$ 表示每次机会中发生赋予耐药性的突变的概率（即，每次机会的耐药突变率）。假设以下基本原则成立：(i) 突变在不同机会之间独立发生，(ii) 每次机会导致赋予耐药性突变的概率为 $\\mu$，以及 (iii) 这是一个稀有事件情景，其中 $\\mu$ 很小，$N$ 很大，且乘积 $N\\mu$ 保持在 $1$ 的数量级。\n\n从独立稀有事件的二项模型出发，并仅使用概率论中的标准泊松极限（稀有事件定律）作为基础事实，推导在治疗期间至少出现一个耐药突变体的概率表达式，该表达式用 $N$ 和 $\\mu$ 表示。然后，对于一个具有 $N=10^{8}$ 次有效机会和每次机会 $\\mu=10^{-8}$ 的淋球菌群体，计算这个概率。将最终概率表示为小数（而非百分比），并将最终数值答案四舍五入到 $4$ 位有效数字。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 设 $N$ 为赋予耐药性突变的独立机会的有效数量。\n- 设 $\\mu$ 为每次机会发生赋予耐药性突变的概率。\n- 假设 (i)：突变在不同机会之间独立发生。\n- 假设 (ii)：每次机会导致赋予耐药性突变的概率恒为 $\\mu$。\n- 假设 (iii)：这是一个稀有事件情景，其中 $\\mu$ 很小，$N$ 很大，且乘积 $N\\mu$ 保持在 $1$ 的数量级。\n- 推导必须从二项模型开始。\n- 推导必须使用标准泊松极限（稀有事件定律）。\n- 目标是推导至少出现一个耐药突变体的概率表达式。\n- 需要对特定值 $N=10^{8}$ 和 $\\mu=10^{-8}$ 进行数值评估。\n- 最终数值答案必须是四舍五入到 $4$ 位有效数字的小数。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据充分**：该问题描述了群体遗传学和进化生物学中的一个基础模型，用于理解突变的出现，例如那些赋予抗菌药物耐药性的突变。独立、稀有事件的假设在这种背景下是标准的一阶近似。群体大小（$N$）和突变率（$\\mu$）的值对于细菌感染是现实的。该问题牢固地植根于概率论和生物学的既定原则。\n- **问题定义明确**：问题定义清晰。它指明了起始模型（二项分布）、要使用的极限过程（泊松分布）、要推导的量（至少一个事件的概率）以及用于数值评估的参数。存在唯一且有意义的解。\n- **客观性**：语言精确、数学化，没有主观或含糊的术语。\n\n该问题没有任何列出的缺陷（科学上不健全、不可形式化、不完整/矛盾、不切实际、不适定、伪深刻、无法验证）。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供解答。\n\n***\n\n设 $K$ 为代表治疗期间从头出现的耐药突变体数量的随机变量。根据问题陈述，有 $N$ 次独立的机会（试验）发生突变，在任何单次机会（成功）中发生突变的概率是 $\\mu$。这种情况恰好可以用二项分布来描述。因此，耐药突变体的数量 $K$ 服从参数为 $N$ 和 $\\mu$ 的二项分布，我们记为 $K \\sim \\text{Binomial}(N, \\mu)$。\n\n二项分布的概率质量函数（PMF）给出了在 $N$ 次试验中观察到恰好 $k$ 次成功事件的概率：\n$$P(K=k) = \\binom{N}{k} \\mu^k (1-\\mu)^{N-k}$$\n对于 $k \\in \\{0, 1, 2, \\dots, N\\}$。\n\n问题要求计算至少出现一个耐药突变体的概率。这个概率是 $P(K \\ge 1)$。通常更直接的方法是使用其互补事件来计算，即没有耐药突变体出现的概率 $P(K=0)$。\n$$P(K \\ge 1) = 1 - P(K=0)$$\n\n使用二项分布的 PMF，零个突变体的概率是：\n$$P(K=0) = \\binom{N}{0} \\mu^0 (1-\\mu)^{N-0} = 1 \\cdot 1 \\cdot (1-\\mu)^N = (1-\\mu)^N$$\n因此，在二项模型下的确切概率是：\n$$P(K \\ge 1) = 1 - (1-\\mu)^N$$\n\n问题要求我们使用泊松极限（稀有事件定律），这在所述条件下是合适的：$N$ 很大，$\\mu$ 很小，且它们的乘积 $\\lambda = N\\mu$ 是一个数量级为 $1$ 的有限常数。在这些条件下，二项分布 $\\text{Binomial}(N, \\mu)$ 收敛于均值为 $\\lambda = N\\mu$ 的泊松分布。\n\n均值为 $\\lambda$ 的泊松分布随机变量 $K$ 的 PMF 是：\n$$P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n为了展示二项概率 $P(K=0)$ 如何逼近泊松概率，我们可以分析二项表达式的极限。设 $\\lambda=N\\mu$。那么 $\\mu=\\lambda/N$。\n$$P(K=0) = (1-\\mu)^N = \\left(1 - \\frac{\\lambda}{N}\\right)^N$$\n根据指数函数的基本定义 $\\exp(x) = \\lim_{n \\to \\infty} (1 + x/n)^n$，我们看到当 $N \\to \\infty$ 时：\n$$\\lim_{N \\to \\infty} \\left(1 - \\frac{\\lambda}{N}\\right)^N = \\exp(-\\lambda)$$\n因此，对于大的 $N$ 和小的 $\\mu$，我们有近似值 $P(K=0) \\approx \\exp(-\\lambda) = \\exp(-N\\mu)$。\n\n那么，至少出现一个耐药突变体的概率近似为：\n$$P(K \\ge 1) = 1 - P(K=0) \\approx 1 - \\exp(-N\\mu)$$\n这就是在泊松近似下，用 $N$ 和 $\\mu$ 表示的至少出现一个耐药突变体的概率的推导表达式。\n\n接下来，我们必须用给定的参数 $N=10^{8}$ 和 $\\mu=10^{-8}$ 来计算这个概率。\n首先，我们计算期望的突变体数量 $\\lambda$：\n$$\\lambda = N\\mu = (10^{8}) \\times (10^{-8}) = 1$$\n将这个值代入我们推导的表达式中：\n$$P(K \\ge 1) \\approx 1 - \\exp(-1)$$\n使用数学常数 $e \\approx 2.71828...$ 的值，我们求出 $\\exp(-1)$：\n$$\\exp(-1) \\approx \\frac{1}{2.71828...} \\approx 0.36787944...$$\n那么，概率是：\n$$P(K \\ge 1) \\approx 1 - 0.36787944... = 0.63212055...$$\n问题要求最终答案四舍五入到 $4$ 位有效数字。前四位有效数字是 $6$、$3$、$2$ 和 $1$。第五位数字是 $2$，小于 $5$，所以我们向下舍入（即截断）。\n最终的数值概率是 $0.6321$。", "answer": "$$\n\\boxed{0.6321}\n$$", "id": "4412822"}, {"introduction": "一旦出现耐药性，我们需要可靠的方法来检测它。本实践深入探讨了解读抗微生物药物耐药性诊断测试的现实挑战，例如那些检测特定基因突变的测试。通过应用贝叶斯定理，学生将学会计算阳性预测值 [@problem_id:4412869]，这是一个关键指标，它量化了我们在考虑测试特性和人群中耐药性流行率的情况下，对测试结果的信任程度。", "problem": "在性传播感染（STI）门诊环境中，使用一种分子检测方法来预测从淋病奈瑟菌 (*Neisseria gonorrhoeae*) 分离株中获得的 DNA 促旋酶 A 亚基基因 (*gyrA*) 的喹诺酮类耐药决定区的状态，从而预测其对环丙沙星的表型药敏性。该检测返回一个二元结果：当密码子 $91$ 是野生型时，结果为“敏感”；当密码子 $91$ 带有耐药相关替换时，结果为“不敏感”。当目标条件是表型对环丙沙星敏感时，考虑该检测的以下特征：在真正敏感的分离株中，报告为“敏感”的灵敏度为 $0.98$；在真正不敏感的分离株中，报告为“不敏感”的特异性为 $0.95$；在受检群体中，敏感分离株的患病率为 $0.60$。从贝叶斯定理以及灵敏度、特异性和患病率的基本定义出发，推导在检测结果为“敏感”的情况下，一个分离株确实是敏感的后验概率表达式，然后根据给定的参数计算其数值。将您的最终数值四舍五入到四位有效数字，并以无量纲的小数形式表示（不要使用百分号）。", "solution": "首先验证问题，以确保其科学根据充分、问题定义明确且客观。\n\n### 步骤 1：提取已知条件\n- **目标条件：** 淋病奈瑟菌 (*Neisseria gonorrhoeae*) 分离株对环丙沙星的表型药敏性。\n- **检测结果：** 基于 *gyrA* 基因密码子 $91$ 的二元结果，“敏感”或“不敏感”。\n- **灵敏度：** 对于真正敏感的分离株，检测结果为“敏感”的概率是 $0.98$。\n- **特异性：** 对于真正不敏感的分离株，检测结果为“不敏感”的概率是 $0.95$。\n- **患病率：** 群体中真正敏感的分离株的比例是 $0.60$。\n- **目标：** 推导在检测结果为“敏感”的情况下，一个分离株确实是敏感的后验概率表达式，然后计算其数值，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学根据：** 该问题基于分子诊断学和流行病学的既定原则。*N. gonorrhoeae* 中 *gyrA* 突变与喹诺酮类耐药性之间的联系是已有充分文献记载的科学事实。使用灵敏度、特异性、患病率和贝叶斯定理来评估诊断测试性能是医学统计学的基石。该问题在科学上是合理的。\n- **问题定义明确：** 计算所需后验概率（阳性预测值）的所有必要参数（灵敏度、特异性、患病率）均已提供。问题清晰明确，并有唯一的稳定解。\n- **客观性：** 问题陈述使用精确的定量语言，不含主观或基于意见的论断。\n\n### 步骤 3：结论与行动\n问题被判定为有效。将生成解答。\n\n### 推导与计算\n我们首先根据提供的基本定义，用符号来定义事件。\n设 $S$ 为一个分离株对环丙沙星确实具有表型敏感性的事件。\n设 $S^c$ 为一个分离株确实是不敏感（即耐药）的事件。这是 $S$ 的补集。\n设 $T_S$ 为分子检测返回“敏感”结果的事件。\n设 $T_{NS}$ 为检测返回“不敏感”结果的事件。\n\n根据问题陈述的已知条件，我们可以将概率形式化：\n1.  敏感分离株的患病率是事件 $S$ 的先验概率：\n    $$P(S) = 0.60$$\n    因此，不敏感分离株的患病率为：\n    $$P(S^c) = 1 - P(S) = 1 - 0.60 = 0.40$$\n\n2.  灵敏度是检测在分离株确实敏感的情况下报告为“敏感”的概率。这是给定 $S$ 时 $T_S$ 的条件概率：\n    $$\\text{灵敏度} = P(T_S | S) = 0.98$$\n\n3.  特异性是检测在分离株确实不敏感的情况下报告为“不敏感”的概率。这是给定 $S^c$ 时 $T_{NS}$ 的条件概率：\n    $$\\text{特异性} = P(T_{NS} | S^c) = 0.95$$\n\n我们的目标是推导并计算在收到“敏感”检测结果的情况下，一个分离株确实是敏感的后验概率。这就是条件概率 $P(S | T_S)$，也称为阳性预测值（PPV）。\n\n我们从贝叶斯定理开始，该定理关联了两个事件的条件概率：\n$$P(S | T_S) = \\frac{P(T_S | S) P(S)}{P(T_S)}$$\n\n分母 $P(T_S)$ 是检测结果为“敏感”的总概率。可以使用全概率定律，在由 $S$ 和 $S^c$ 划分的样本空间上将其展开：\n$$P(T_S) = P(T_S | S) P(S) + P(T_S | S^c) P(S^c)$$\n\n项 $P(T_S | S^c)$ 是在分离株不敏感的情况下，检测结果为“敏感”的概率。这是假阳性率。由于检测结果是二元的（$T_S$ 或 $T_{NS}$），对于任何给定的真实状态，各种结果的概率之和必须为 $1$。因此，对于不敏感状态 $S^c$：\n$$P(T_S | S^c) + P(T_{NS} | S^c) = 1$$\n我们可以通过重新整理这个方程并使用特异性的定义来找到 $P(T_S | S^c)$：\n$$P(T_S | S^c) = 1 - P(T_{NS} | S^c) = 1 - \\text{特异性}$$\n其数值为：\n$$P(T_S | S^c) = 1 - 0.95 = 0.05$$\n\n现在，我们将 $P(T_S)$ 的展开形式代入贝叶斯定理，得到所需后验概率的完整表达式：\n$$P(S | T_S) = \\frac{P(T_S | S) P(S)}{P(T_S | S) P(S) + P(T_S | S^c) P(S^c)}$$\n这是用灵敏度、特异性（通过 $1-P(T_{NS}|S^c)$）和患病率表示的推导表达式。让我们用这些临床术语明确地写出来：\n$$P(S | T_S) = \\frac{(\\text{灵敏度}) (\\text{患病率})}{(\\text{灵敏度}) (\\text{患病率}) + (1 - \\text{特异性}) (1 - \\text{患病率})}$$\n\n现在，我们可以将给定的数值代入此表达式以计算最终答案。\n-   $P(S) = \\text{患病率} = 0.60$\n-   $P(S^c) = 1 - 0.60 = 0.40$\n-   $P(T_S | S) = \\text{灵敏度} = 0.98$\n-   $P(T_S | S^c) = 1 - \\text{特异性} = 0.05$\n\n$$P(S | T_S) = \\frac{(0.98)(0.60)}{(0.98)(0.60) + (0.05)(0.40)}$$\n首先，计算分子和分母中的各项：\n-   分子： $0.98 \\times 0.60 = 0.588$\n-   分母第 1 项： $0.98 \\times 0.60 = 0.588$\n-   分母第 2 项： $0.05 \\times 0.40 = 0.020$\n将分母中的各项相加：\n$$P(T_S) = 0.588 + 0.020 = 0.608$$\n最后，我们计算这个分数：\n$$P(S | T_S) = \\frac{0.588}{0.608}$$\n$$P(S | T_S) \\approx 0.967105263...$$\n按照要求将结果四舍五入到四位有效数字，我们得到 $0.9671$。", "answer": "$$\n\\boxed{0.9671}\n$$", "id": "4412869"}, {"introduction": "掌握了耐药性流行率和诊断数据后，临床医生必须做出治疗选择。这最后一个实践将流行病学数据转化为一个具体的临床指标：需治数（Number Needed to Treat, NNT）。学生将推导出 NNT [@problem_id:4412867]，以理解在面对日益增长的耐药性时，必须有多少患者改用替代疗法（例如，用多西环素替代阿奇霉素治疗衣原体）才能预防一次治疗失败，从而为比较不同治疗策略提供了有力的工具。", "problem": "一个皮肤性病科正在评估，在大环内酯类药物耐药性日益增加的背景下，用于无并发症泌尿生殖道 Chlamydia trachomatis 感染经验性治疗的抗菌药物选择。设使用 azithromycin 治疗时，在标准化的疗效检测中微生物学失败的概率为 $p_{A}$，使用 doxycycline 治疗时为 $p_{D}$，其中 $p_{A}=0.12$ 且 $p_{D}=0.05$。假设对于接受特定治疗方案的每位患者，微生物学失败是一个伯努利结果，其概率等于该方案特定的风险，且这些风险在患者之间是同质的，患者之间的结果是相互独立的。\n\n仅使用以下基本要素：(i) 将风险定义为长期事件概率，(ii) 应用于独立伯努利试验的期望线性性质，以及 (iii) 为预防一个事件而需要治疗的患者数（NNT）的定义，即最小患者数 $n$，使得将所有 $n$ 名患者的治疗方案从 azithromycin 转换为 doxycycline 所规避的预期事件数等于 1，推导出一个用 $p_{A}$ 和 $p_{D}$ 表示 NNT 的表达式，然后根据给定的风险计算其确切值。将最终答案表示为一个无单位的单一简化分数。", "solution": "用户要求我在解题前验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   使用 azithromycin 的微生物学失败概率为 $p_{A}$。\n-   使用 doxycycline 的微生物学失败概率为 $p_{D}$。\n-   $p_{A} = 0.12$。\n-   $p_{D} = 0.05$。\n-   对于接受特定治疗方案的每位患者，微生物学失败是具有方案特定概率的伯努利结果。\n-   风险在患者之间是同质的。\n-   患者之间的结果是相互独立的。\n-   解决方案必须仅使用三个基本要素推导得出：\n    1.  将风险定义为长期事件概率。\n    2.  应用于独立伯努利试验的期望线性性质。\n    3.  为预防一个事件而需要治疗的患者数（NNT）的定义，即最小患者数 $n$，使得将所有 $n$ 名患者的治疗方案从 azithromycin 转换为 doxycycline 所规避的预期事件数等于 1。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于标准的流行病学和统计学原理（风险、伯努利试验、期望值、需治数）。抗菌药物对 *Chlamydia trachomatis* 的耐药性以及 azithromycin 和 doxycycline 的失败率等临床背景是现实的。模型的假设（如同质风险）是此类问题的常见简化。该问题不违反任何科学定律或数学逻辑。\n-   **适定性**：该问题是适定的。它提供了明确的目标（推导 NNT 的表达式并计算其值）、充足的数据（$p_{A}$ 和 $p_{D}$）以及一个用于推导的精确、形式化的 NNT 定义。存在唯一、稳定且有意义的解。\n-   **客观性**：问题以客观、定量的语言陈述，没有主观或模糊的术语。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。它在科学上是合理的、自洽的且适定的。我现在将继续进行解答。\n\n### 推导与求解\n\n设 $p_{A}$ 为使用 azithromycin 治疗的患者治疗失败（我们关注的事件）的概率，$p_{D}$ 为使用 doxycycline 治疗的患者失败的概率。已知数值为 $p_{A} = 0.12$ 和 $p_{D} = 0.05$。\n\n问题陈述指出，单个个体的治疗失败是一个伯努利结果。我们为单个患者的结果定义一个随机变量。设 $X$ 表示接受 azithromycin 治疗患者的结果，$Y$ 表示接受 doxycycline 治疗患者的结果。我们可以将失败赋值为 $1$，成功（治愈）赋值为 $0$。\n-   对于接受 azithromycin 治疗的患者，其随机变量为 $X \\sim \\text{Bernoulli}(p_{A})$。\n-   对于接受 doxycycline 治疗的患者，其随机变量为 $Y \\sim \\text{Bernoulli}(p_{D})$。\n\n根据第一个基本要素（风险作为长期事件概率），单次伯努利试验的期望结果是其概率参数。因此，一名接受 azithromycin 治疗的患者的预期失败次数为 $E[X] = p_{A}$，一名接受 doxycycline 治疗的患者的预期失败次数为 $E[Y] = p_{D}$。\n\n现在，考虑一个由 $n$ 名患者组成的队列。设 $\\{X_1, X_2, \\dots, X_n\\}$ 是所有 $n$ 名患者都接受 azithromycin 治疗时的结果。该组的总失败次数是总和 $S_{A} = \\sum_{i=1}^{n} X_i$。根据第二个基本要素（期望的线性性质），预期的总失败次数是各个期望值的总和：\n$$E[S_{A}] = E\\left[\\sum_{i=1}^{n} X_i\\right] = \\sum_{i=1}^{n} E[X_i] = \\sum_{i=1}^{n} p_{A} = n p_{A}$$\n\n同样，如果这 $n$ 名患者组成的同一队列接受 doxycycline 治疗，结果将是 $\\{Y_1, Y_2, \\dots, Y_n\\}$，总失败次数将是 $S_{D} = \\sum_{i=1}^{n} Y_i$。doxycycline 组的预期总失败次数为：\n$$E[S_{D}] = E\\left[\\sum_{i=1}^{n} Y_i\\right] = \\sum_{i=1}^{n} E[Y_i] = \\sum_{i=1}^{n} p_{D} = n p_{D}$$\n\n将所有 $n$ 名患者的治疗方案从 azithromycin 转换为 doxycycline 所规避的事件（失败）数是失败次数的差值，$S_{A} - S_{D}$。通过再次应用期望的线性性质，可以找到预期的规避事件数：\n$$E\\left[\\text{events averted}\\right] = E[S_{A} - S_{D}] = E[S_{A}] - E[S_{D}] = n p_{A} - n p_{D} = n(p_{A} - p_{D})$$\n项 $p_{A} - p_{D}$ 是绝对风险降低值（ARR）。\n\n根据第三个基本要素，需治数（NNT）是使得预期规避事件数恰好为 1 的患者数 $n$。我们建立方程：\n$$n(p_{A} - p_{D}) = 1$$\n\n解出 $n$ 即可得到 NNT 的所需表达式：\n$$\\text{NNT} = \\frac{1}{p_{A} - p_{D}}$$\n\n最后，我们将给定的数值 $p_{A} = 0.12$ 和 $p_{D} = 0.05$ 代入此表达式：\n$$\\text{NNT} = \\frac{1}{0.12 - 0.05} = \\frac{1}{0.07}$$\n\n问题要求答案以单一简化分数形式表示。我们将分母中的小数转换为分数：$0.07 = \\frac{7}{100}$。代入后得到：\n$$\\text{NNT} = \\frac{1}{\\frac{7}{100}} = \\frac{100}{7}$$\n这就是作为简化分数的最终精确值。", "answer": "$$\\boxed{\\frac{100}{7}}$$", "id": "4412867"}]}