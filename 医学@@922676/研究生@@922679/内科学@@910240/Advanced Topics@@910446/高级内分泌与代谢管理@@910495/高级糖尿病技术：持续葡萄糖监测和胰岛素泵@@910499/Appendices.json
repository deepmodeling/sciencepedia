{"hands_on_practices": [{"introduction": "连续血糖监测 (CGM) 的可靠性对于安全有效的糖尿病管理至关重要。在我们信任 CGM 数据并将其用于治疗决策之前，我们必须能够量化其准确性。本练习将指导您计算平均绝对相对差 (MARD)，这是评估 CGM 性能的金标准指标。通过处理一个样本数据集，您将具体理解传感器准确性是如何被评估的，以及它如何在不同血糖范围内变化，这对于解读临床试验数据和选择合适的设备是一项关键技能。[@problem_id:4791370]", "problem": "一位临床医生正在使用传统的基于参考的平均绝对相对差异 (MARD) 来评估连续血糖监测 (CGM) 相对于静脉血浆葡萄糖的性能。在内科学中，MARD是根据测量误差的第一性原理构建的，即以静脉血浆葡萄糖为参考值，计算出的绝对相对误差的算术平均值。使用绝对差异、相对差异和算术平均值的标准定义，并根据静脉血糖值将每对读数分为以下血糖范围：如果 $G_{\\text{venous}}  70\\,\\text{mg/dL}$ 则为低血糖，如果 $70 \\leq G_{\\text{venous}} \\leq 180\\,\\text{mg/dL}$ 则为正常血糖，如果 $G_{\\text{venous}} > 180\\,\\text{mg/dL}$ 则为高血糖。计算各特定范围的MARD，并在不同血糖范围间进行比较。然后计算所有读数的总体MARD。\n\n配对的静脉（参考）和CGM值（单位均为 $\\text{mg/dL}$）如下：\n- 低血糖范围候选值：\n  - $G_{\\text{venous}} = 58$, $G_{\\text{CGM}} = 62$\n  - $G_{\\text{venous}} = 65$, $G_{\\text{CGM}} = 60$\n  - $G_{\\text{venous}} = 68$, $G_{\\text{CGM}} = 72$\n- 正常血糖范围候选值：\n  - $G_{\\text{venous}} = 92$, $G_{\\text{CGM}} = 95$\n  - $G_{\\text{venous}} = 110$, $G_{\\text{CGM}} = 108$\n  - $G_{\\text{venous}} = 145$, $G_{\\text{CGM}} = 150$\n  - $G_{\\text{venous}} = 160$, $G_{\\text{CGM}} = 152$\n  - $G_{\\text{venous}} = 175$, $G_{\\text{CGM}} = 184$\n- 高血糖范围候选值：\n  - $G_{\\text{venous}} = 190$, $G_{\\text{CGM}} = 200$\n  - $G_{\\text{venous}} = 205$, $G_{\\text{CGM}} = 196$\n  - $G_{\\text{venous}} = 230$, $G_{\\text{CGM}} = 220$\n  - $G_{\\text{venous}} = 260$, $G_{\\text{CGM}} = 270$\n\n在所有计算中，将静脉血浆葡萄糖作为参考值。使用基于绝对相对误差和算术平均值的MARD标准概念。在确定各特定范围的MARD并找出哪个范围的MARD最高和最低之后，计算所有读数的总体MARD，并以无单位的小数形式报告该总体值。将最终报告的总体MARD四舍五入到四位有效数字。最终答案不使用百分号表示。", "solution": "该问题提法明确，有科学依据，并为得出唯一解提供了所有必要的数据和定义。任务是为一组配对的血糖测量值计算平均绝对相对差异（MARD），包括针对特定血糖范围的计算和总体计算。\n\n基本量是单个配对测量值 $i$ 的绝对相对差异 (ARD)，定义为：\n$$\n\\text{ARD}_i = \\frac{|G_{\\text{CGM}, i} - G_{\\text{ref}, i}|}{G_{\\text{ref}, i}}\n$$\n其中 $G_{\\text{CGM}, i}$ 是来自连续血糖监测仪的值，$G_{\\text{ref}, i}$ 是参考值，即静脉血浆葡萄糖，表示为 $G_{\\text{venous}}$。\n\n一组 $N$ 个测量值的MARD是各个ARD值的算术平均值：\n$$\n\\text{MARD} = \\frac{1}{N} \\sum_{i=1}^{N} \\text{ARD}_i = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{|G_{\\text{CGM}, i} - G_{\\text{venous}, i}|}{G_{\\text{venous}, i}}\n$$\n问题要求MARD以无单位小数表示，这与该公式一致。\n\n首先，我们根据提供的定义，基于它们的 $G_{\\text{venous}}$ 值，将所有数据点分类到各自的血糖范围：\n- 低血糖：$G_{\\text{venous}}  70$ mg/dL\n- 正常血糖：$70 \\leq G_{\\text{venous}} \\leq 180$ mg/dL\n- 高血糖：$G_{\\text{venous}} > 180$ mg/dL\n\n提供的数据点正确地落入其候选范围：\n- 低血糖配对 ($N_{\\text{hypo}}=3$)：($58$, $62$)、($65$, $60$)、($68$, $72$)，因为 $58  70$、$65  70$ 且 $68  70$。\n- 正常血糖配对 ($N_{\\text{eu}}=5$)：($92$, $95$)、($110$, $108$)、($145$, $150$)、($160$, $152$)、($175$, $184$)，因为所有 $G_{\\text{venous}}$ 值都在 [$70, 180$] 范围内。\n- 高血糖配对 ($N_{\\text{hyper}}=4$)：($190$, $200$)、($205$, $196$)、($230$, $220$)、($260$, $270$)，因为所有 $G_{\\text{venous}}$ 值都 $> 180$。\n\n我们现在计算特定范围的MARD。\n\n**1. 低血糖范围MARD ($M_{\\text{hypo}}$)**\n各个ARD为：\n$$\n\\text{ARD}_1 = \\frac{|62 - 58|}{58} = \\frac{4}{58}\n$$\n$$\n\\text{ARD}_2 = \\frac{|60 - 65|}{65} = \\frac{5}{65}\n$$\n$$\n\\text{ARD}_3 = \\frac{|72 - 68|}{68} = \\frac{4}{68}\n$$\n该范围的MARD为：\n$$\nM_{\\text{hypo}} = \\frac{1}{3} \\left( \\frac{4}{58} + \\frac{5}{65} + \\frac{4}{68} \\right) \\approx \\frac{1}{3} (0.068966 + 0.076923 + 0.058824) \\approx 0.068237\n$$\n\n**2. 正常血糖范围MARD ($M_{\\text{eu}}$)**\n各个ARD为：\n$$\n\\text{ARD}_4 = \\frac{|95 - 92|}{92} = \\frac{3}{92}\n$$\n$$\n\\text{ARD}_5 = \\frac{|108 - 110|}{110} = \\frac{2}{110}\n$$\n$$\n\\text{ARD}_6 = \\frac{|150 - 145|}{145} = \\frac{5}{145}\n$$\n$$\n\\text{ARD}_7 = \\frac{|152 - 160|}{160} = \\frac{8}{160} = \\frac{1}{20}\n$$\n$$\n\\text{ARD}_8 = \\frac{|184 - 175|}{175} = \\frac{9}{175}\n$$\n该范围的MARD为：\n$$\nM_{\\text{eu}} = \\frac{1}{5} \\left( \\frac{3}{92} + \\frac{2}{110} + \\frac{5}{145} + \\frac{1}{20} + \\frac{9}{175} \\right) \\approx \\frac{1}{5} (0.032609 + 0.018182 + 0.034483 + 0.05 + 0.051429) \\approx 0.037340\n$$\n\n**3. 高血糖范围MARD ($M_{\\text{hyper}}$)**\n各个ARD为：\n$$\n\\text{ARD}_9 = \\frac{|200 - 190|}{190} = \\frac{10}{190} = \\frac{1}{19}\n$$\n$$\n\\text{ARD}_{10} = \\frac{|196 - 205|}{205} = \\frac{9}{205}\n$$\n$$\n\\text{ARD}_{11} = \\frac{|220 - 230|}{230} = \\frac{10}{230} = \\frac{1}{23}\n$$\n$$\n\\text{ARD}_{12} = \\frac{|270 - 260|}{260} = \\frac{10}{260} = \\frac{1}{26}\n$$\n该范围的MARD为：\n$$\nM_{\\text{hyper}} = \\frac{1}{4} \\left( \\frac{1}{19} + \\frac{9}{205} + \\frac{1}{23} + \\frac{1}{26} \\right) \\approx \\frac{1}{4} (0.052632 + 0.043902 + 0.043478 + 0.038462) \\approx 0.044618\n$$\n\n**各特定范围MARD的比较**\n比较计算出的值：\n- $M_{\\text{hypo}} \\approx 0.0682$\n- $M_{\\text{eu}} \\approx 0.0373$\n- $M_{\\text{hyper}} \\approx 0.0446$\n\n最高的MARD出现在**低血糖**范围。最低的MARD出现在**正常血糖**范围 ($M_{\\text{eu}}  M_{\\text{hyper}}  M_{\\text{hypo}}$)。这是一个常见的发现，因为在较低的血糖值下，CGM的准确性往往会降低，这时绝对差异占参考值的比例更大。\n\n**总体MARD**\n总体MARD是所有 $N = N_{\\text{hypo}} + N_{\\text{eu}} + N_{\\text{hyper}} = 3 + 5 + 4 = 12$ 个ARD值的算术平均值。\n$$\nM_{\\text{overall}} = \\frac{1}{12} \\sum_{i=1}^{12} \\text{ARD}_i\n$$\n所有ARD的总和是每个范围总和的和：\n$$\n\\sum_{i=1}^{12} \\text{ARD}_i = \\left(\\frac{4}{58} + \\frac{5}{65} + \\frac{4}{68}\\right) + \\left(\\frac{3}{92} + \\frac{2}{110} + \\frac{5}{145} + \\frac{8}{160} + \\frac{9}{175}\\right) + \\left(\\frac{10}{190} + \\frac{9}{205} + \\frac{10}{230} + \\frac{10}{260}\\right)\n$$\n$$\n\\sum_{i=1}^{12} \\text{ARD}_i \\approx 0.204712 + 0.186702 + 0.178474 = 0.569888\n$$\n现在，我们计算总体MARD：\n$$\nM_{\\text{overall}} = \\frac{0.569888}{12} \\approx 0.04749067\n$$\n问题要求将最终的总体MARD四舍五入到四位有效数字。\n$$\nM_{\\text{overall}} \\approx 0.04749\n$$\n这个值就是最终答案。", "answer": "$$\n\\boxed{0.04749}\n$$", "id": "4791370"}, {"introduction": "现代糖尿病管理需要整合多个动态变量来确定正确的胰岛素剂量。一个简单的血糖读数已不再足够；我们还必须考虑血糖变化的方向和速率、膳食成分以及先前胰岛素剂量的残留效应。本练习模拟了一个复杂的真实世界大剂量计算场景，融合了 CGM 趋势数据、碳水化合物计数、活性胰岛素 (IOB) 甚至近期运动的生理影响。完成此问题将提升您将各种临床数据综合为单一优化治疗方案的能力，这正反映了高级大剂量计算器和混合闭环系统中的决策过程。[@problem_id:4791432]", "problem": "一位使用持续皮下胰岛素输注泵和实时动态血糖监测（CGM）系统的1型糖尿病患者正准备进餐。使用以下临床标准量和模型：\n\n- CGM显示当前组织间液葡萄糖为 $G_{0} = 218\\,\\mathrm{mg/dL}$，局部线性趋势（斜率）为 $v = -1.2\\,\\mathrm{mg/dL/min}$。由于组织间液葡萄糖大约滞后于血浆葡萄糖 $\\tau_{\\mathrm{CGM}} = 10\\,\\mathrm{min}$，请使用基于 $v$ 的一阶线性预测来估计能更好地反映同步血浆葡萄糖的近期组织间液葡萄糖 $G_{\\mathrm{pred}}$。\n- 目标血糖为 $T = 110\\,\\mathrm{mg/dL}$。胰岛素敏感性因子（ISF）为 $\\mathrm{ISF} = 45\\,\\mathrm{mg/dL/U}$，定义为在静息条件下，每单位（U）速效胰岛素引起的血浆葡萄糖预期下降值。\n- 患者计划摄入 $C = 60\\,\\mathrm{g}$ 的碳水化合物。胰岛素碳水化合物比（ICR）为 $\\mathrm{ICR} = 9\\,\\mathrm{g/U}$，定义为在血糖达标且静息时，每单位（U）速效胰岛素所能覆盖的碳水化合物克数。\n- 体内活性胰岛素（IOB）来自于 $t_{\\mathrm{prev}} = 100\\,\\mathrm{min}$ 前注射的剂量为 $B_{\\mathrm{prev}} = 4.0\\,\\mathrm{U}$ 的前一餐追加剂量。假设采用线性胰岛素活性模型，胰岛素作用持续时间为 $\\mathrm{DIA} = 4.5\\,\\mathrm{h} = 270\\,\\mathrm{min}$，因此在经过时间 $t$ 后的活性分数为 $f(t) = \\max\\!\\left(0, 1 - \\frac{t}{\\mathrm{DIA}}\\right)$，且 $\\mathrm{IOB} = B_{\\mathrm{prev}} \\cdot f(t_{\\mathrm{prev}})$。\n- 患者在 $\\Delta t = 0.5\\,\\mathrm{h}$ 前完成了持续 $40\\,\\mathrm{min}$、强度为 $6$ 代谢当量（METs）的中等强度自行车运动。一个基于生理学的模型将运动后胰岛素敏感性的增强表示为 $\\mathrm{ISF}$ 的乘性增加，该增加随运动后时间的推移呈指数衰减：\n$$\n\\mathrm{ISF}_{\\mathrm{eff}} = \\mathrm{ISF} \\left(1 + \\alpha \\, E \\, \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right),\n$$\n其中 $E$ 是以 $\\mathrm{MET}\\cdot\\mathrm{h}$ 为单位的运动剂量，$\\alpha = 0.06\\,(\\text{per MET}\\cdot\\text{h})$，$\\tau = 3\\,\\mathrm{h}$。请根据给定的METs和持续时间计算 $E$。\n\n仅使用上述定义和模型：\n1) 根据 $G_{0}$、$v$ 和 $\\tau_{\\mathrm{CGM}}$ 预测近期组织间液葡萄糖 $G_{\\mathrm{pred}}$。\n2) 通过比较 $G_{\\mathrm{pred}}$ 和 $T$ 并除以 $\\mathrm{ISF}_{\\mathrm{eff}}$，确定经活动调整的校正追加剂量。\n3) 根据 $C$ 和 $\\mathrm{ICR}$ 确定餐时追加剂量。\n4) 根据 $B_{\\mathrm{prev}}$、$t_{\\mathrm{prev}}$ 和 $\\mathrm{DIA}$ 确定 $\\mathrm{IOB}$。\n5) 综合以上各项，得出用于此餐的即时总追加剂量，其定义为餐时追加剂量与经活动调整的校正追加剂量之和，再减去体内活性胰岛素。\n\n此外，根据定量模型和观测到的CGM趋势，论证是否应因近期活动而减少校正剂量部分，并确保最终数值结果反映任何合理的减少。\n\n以 U 为单位表示最终剂量，并将您的答案四舍五入至三位有效数字。", "solution": "首先将对问题陈述的科学合理性、完整性和清晰度进行验证。\n\n### 步骤 1：提取已知条件\n- 当前组织间液葡萄糖：$G_{0} = 218\\,\\mathrm{mg/dL}$\n- 组织间液葡萄糖的局部线性趋势：$v = -1.2\\,\\mathrm{mg/dL/min}$\n- CGM延迟时间：$\\tau_{\\mathrm{CGM}} = 10\\,\\mathrm{min}$\n- 目标血糖：$T = 110\\,\\mathrm{mg/dL}$\n- 胰岛素敏感性因子（基础）：$\\mathrm{ISF} = 45\\,\\mathrm{mg/dL/U}$\n- 餐食碳水化合物含量：$C = 60\\,\\mathrm{g}$\n- 胰岛素碳水化合物比：$\\mathrm{ICR} = 9\\,\\mathrm{g/U}$\n- 前次追加剂量：$B_{\\mathrm{prev}} = 4.0\\,\\mathrm{U}$\n- 距前次追加的时间：$t_{\\mathrm{prev}} = 100\\,\\mathrm{min}$\n- 胰岛素作用持续时间：$\\mathrm{DIA} = 4.5\\,\\mathrm{h} = 270\\,\\mathrm{min}$\n- 体内活性胰岛素（IOB）模型：$\\mathrm{IOB} = B_{\\mathrm{prev}} \\cdot \\max\\!\\left(0, 1 - \\frac{t}{\\mathrm{DIA}}\\right)$\n- 运动强度：$6\\,\\mathrm{METs}$\n- 运动持续时间：$40\\,\\mathrm{min}$\n- 距运动结束的时间：$\\Delta t = 0.5\\,\\mathrm{h}$\n- 有效ISF模型：$\\mathrm{ISF}_{\\mathrm{eff}} = \\mathrm{ISF} \\left(1 + \\alpha \\, E \\, \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right)$\n- 运动模型参数：$\\alpha = 0.06\\,(\\text{per MET}\\cdot\\text{h})$\n- 运动模型时间常数：$\\tau = 3\\,\\mathrm{h}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，使用了在临床糖尿病学和自动化胰岛素输送系统工程中普遍使用的标准（尽管简化了的）药代动力学和药效动力学模型。提供的参数（$G_0$, $v$, ISF, ICR 等）均在1型糖尿病患者的实际生理范围内。IOB和运动后胰岛素敏感性的模型是该领域公认的启发式方法。\n\n该问题是适定的。它提供了执行一系列计算以得出唯一数值答案所需的所有数据和定义。单位是一致的，尽管需要进行少量转换（分钟到小时）。\n\n该问题是客观的，没有不可形式化或不科学的前提。“论证是否应减少校正剂量部分”的指令并未引入模糊性，因为所提供的用于血糖预测（从趋势 $v$ 得出 $G_{\\mathrm{pred}}$）和活动调整的敏感性（$\\mathrm{ISF}_{\\mathrm{eff}}$）的模型正是实现此种减少的定量机制。任务是使用这些模型进行计算，并解释它们如何实现这一临床目标。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将提供完整的解决方案。\n\n### 解答\n\n总胰岛素追加剂量 $B_{\\mathrm{total}}$ 计算为餐时追加剂量（$B_{\\mathrm{meal}}$）和校正追加剂量（$B_{\\mathrm{corr}}$）之和，并根据体内活性胰岛素（$\\mathrm{IOB}$）进行调整：\n$$\nB_{\\mathrm{total}} = B_{\\mathrm{meal}} + B_{\\mathrm{corr}} - \\mathrm{IOB}\n$$\n每个组成部分将根据提供的模型进行系统性计算。\n\n**1) 预测的近期组织间液葡萄糖 ($G_{\\mathrm{pred}}$)**\nCGM测量的组织间液葡萄糖滞后于实际血浆葡萄糖。使用一阶线性预测来估计更能反映当前状态的血糖水平。\n已知 $G_{0} = 218\\,\\mathrm{mg/dL}$，$v = -1.2\\,\\mathrm{mg/dL/min}$，以及 $\\tau_{\\mathrm{CGM}} = 10\\,\\mathrm{min}$：\n$$\nG_{\\mathrm{pred}} = G_{0} + v \\cdot \\tau_{\\mathrm{CGM}} = 218\\,\\mathrm{mg/dL} + (-1.2\\,\\mathrm{mg/dL/min}) \\cdot (10\\,\\mathrm{min})\n$$\n$$\nG_{\\mathrm{pred}} = 218 - 12 = 206\\,\\mathrm{mg/dL}\n$$\n此预测值将用于校正计算。\n\n**2) 经活动调整的校正追加剂量 ($B_{\\mathrm{corr}}$)**\n校正追加剂量取决于有效胰岛素敏感性 $\\mathrm{ISF}_{\\mathrm{eff}}$，后者受近期运动的调节。\n\n首先，计算以 $\\mathrm{MET}\\cdot\\mathrm{h}$ 为单位的运动剂量 $E$。\n持续时间为 $40\\,\\mathrm{min}$，即 $\\frac{40}{60}\\,\\mathrm{h} = \\frac{2}{3}\\,\\mathrm{h}$。\n$$\nE = (6\\,\\mathrm{METs}) \\cdot \\left(\\frac{2}{3}\\,\\mathrm{h}\\right) = 4\\,\\mathrm{MET}\\cdot\\mathrm{h}\n$$\n接下来，使用给定的模型计算 $\\mathrm{ISF}_{\\mathrm{eff}}$：\n$$\n\\mathrm{ISF}_{\\mathrm{eff}} = \\mathrm{ISF} \\left(1 + \\alpha \\, E \\, \\exp\\!\\left(-\\frac{\\Delta t}{\\tau}\\right)\\right)\n$$\n代入数值 $\\mathrm{ISF} = 45$，$\\alpha = 0.06$，$E = 4$，$\\Delta t = 0.5\\,\\mathrm{h}$，以及 $\\tau = 3\\,\\mathrm{h}$：\n$$\n\\mathrm{ISF}_{\\mathrm{eff}} = 45 \\left(1 + (0.06) \\cdot (4) \\cdot \\exp\\!\\left(-\\frac{0.5}{3}\\right)\\right) = 45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)\n$$\n校正追加剂量 $B_{\\mathrm{corr}}$ 是将预测血糖 $G_{\\mathrm{pred}}$ 降至目标值 $T$ 所需的胰岛素量。仅当 $G_{\\mathrm{pred}} > T$ 时才进行此计算。\n$$\nB_{\\mathrm{corr}} = \\frac{G_{\\mathrm{pred}} - T}{\\mathrm{ISF}_{\\mathrm{eff}}} = \\frac{206 - 110}{45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)} = \\frac{96}{45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)}\n$$\n\n**3) 餐时追加剂量 ($B_{\\mathrm{meal}}$)**\n餐时追加剂量用于覆盖将要摄入的碳水化合物。\n已知 $C = 60\\,\\mathrm{g}$ 和 $\\mathrm{ICR} = 9\\,\\mathrm{g/U}$：\n$$\nB_{\\mathrm{meal}} = \\frac{C}{\\mathrm{ICR}} = \\frac{60}{9} = \\frac{20}{3}\\,\\mathrm{U}\n$$\n\n**4) 体内活性胰岛素 ($\\mathrm{IOB}$)**\nIOB说明了前一次追加剂量中胰岛素的活性。\n已知 $B_{\\mathrm{prev}} = 4.0\\,\\mathrm{U}$，$t_{\\mathrm{prev}} = 100\\,\\mathrm{min}$，以及 $\\mathrm{DIA} = 270\\,\\mathrm{min}$：\n$$\n\\mathrm{IOB} = B_{\\mathrm{prev}} \\cdot \\max\\!\\left(0, 1 - \\frac{t_{\\mathrm{prev}}}{\\mathrm{DIA}}\\right) = 4.0 \\cdot \\left(1 - \\frac{100}{270}\\right)\n$$\n$$\n\\mathrm{IOB} = 4.0 \\cdot \\left(\\frac{270 - 100}{270}\\right) = 4 \\cdot \\frac{170}{270} = 4 \\cdot \\frac{17}{27} = \\frac{68}{27}\\,\\mathrm{U}\n$$\n\n**剂量减少的论证**\n问题要求论证减少校正部分是否合理。所提供的计算框架已经通过两个主要机制实现了这种合理的减少：\n1.  **基于趋势的血糖预测：** 计算未使用静态血糖读数 $G_0 = 218\\,\\mathrm{mg/dL}$，而是使用了经趋势调整的预测值 $G_{\\mathrm{pred}} = 206\\,\\mathrm{mg/dL}$。负趋势 $v  0$ 表示血糖已经在下降。使用较低的 $G_{\\mathrm{pred}}$ 值减小了校正追加剂量分数中的分子（$G_{\\mathrm{pred}} - T$），从而审慎地减少了剂量，以考虑血糖的下降势头。\n2.  **经活动调整的胰岛素敏感性：** 近期运动会增加胰岛素敏感性。该模型通过计算一个大于基线 $\\mathrm{ISF}$ 的有效敏感性 $\\mathrm{ISF}_{\\mathrm{eff}}$ 来反映这一点。这增大了校正追加剂量分数中的分母，表明达到相同的降糖效果需要更少的胰岛素。\n\n与基于 $G_0$ 和基础 ISF 的简单计算相比，这两个因素都定量地减少了计算出的校正追加剂量。因此，按规定执行计算*就是*应用合理减少的方法。\n\n**5) 总追加剂量 ($B_{\\mathrm{total}}$)**\n现在，组合各个部分。总追加剂量必须为非负值。\n$$\nB_{\\mathrm{total}} = B_{\\mathrm{meal}} + B_{\\mathrm{corr}} - \\mathrm{IOB} = \\frac{20}{3} + \\frac{96}{45 \\left(1 + 0.24 \\exp\\!\\left(-\\frac{1}{6}\\right)\\right)} - \\frac{68}{27}\n$$\n现在，我们计算数值：\n$\\exp\\!\\left(-\\frac{1}{6}\\right) \\approx 0.8464817$\n$$\nB_{\\mathrm{corr}} \\approx \\frac{96}{45 \\left(1 + 0.24 \\cdot 0.8464817\\right)} = \\frac{96}{45 \\left(1 + 0.2031556\\right)} = \\frac{96}{45 \\cdot 1.2031556} \\approx \\frac{96}{54.14200} \\approx 1.77313\\,\\mathrm{U}\n$$\n$$\nB_{\\mathrm{meal}} = \\frac{20}{3} \\approx 6.66667\\,\\mathrm{U}\n$$\n$$\n\\mathrm{IOB} = \\frac{68}{27} \\approx 2.51852\\,\\mathrm{U}\n$$\n$$\nB_{\\mathrm{total}} \\approx 6.66667 + 1.77313 - 2.51852 = 8.43980 - 2.51852 = 5.92128\\,\\mathrm{U}\n$$\n四舍五入到三位有效数字，最终的追加剂量为 $5.92\\,\\mathrm{U}$。", "answer": "$$\n\\boxed{5.92}\n$$", "id": "4791432"}, {"introduction": "“胰岛素叠加”和“活性胰岛素”(IOB) 等概念通常被当作简单的经验法则，但其根源在于胰岛素作用的复杂药代动力学和药效学。为了构建真正智能的自动化胰岛素输注 (AID) 系统，我们必须用严谨的数学方法来为这些过程建模。本问题介绍了一种来自系统工程的强大方法——将胰岛素作用建模为大剂量输入与脉冲响应函数的卷积。通过推导和应用此模型，您将对多个胰岛素剂量的效应如何随时间累积获得更深刻的定量理解，从而洞察现代 AID 系统算法基础的精髓。[@problem_id:4791423]", "problem": "一名1型糖尿病患者使用连续血糖监测（CGM）和胰岛素泵（IP）来输注皮下速效胰岛素。胰岛素叠加是指多次推注的时间进程重叠，产生累加的降糖效应，若不加以考虑可能导致低血糖的生理现象。假设在感兴趣的时间窗口内，在CGM观测到的动态水平上，胰岛素-血糖系统可以近似为一个线性时不变（LTI）输入-输出系统，其中推注的胰岛素输入产生一个时变的降糖驱动。\n\n设推注输入模型为 $b(t) = \\sum_{i=1}^{N} B_{i}\\,\\delta(t - t_{i})$，其中 $\\delta(\\cdot)$ 是狄拉克δ分布，$B_{i}$ 是以胰岛素单位（U）计的推注剂量，$t_{i}$ 是以分钟计的推注时间。设单位胰岛素的胰岛素作用脉冲响应由一个Γ形核函数给出\n$$\nh(t) = \\begin{cases}\n\\dfrac{S}{\\Gamma(n)\\,\\tau}\\left(\\dfrac{t}{\\tau}\\right)^{n-1}\\exp\\!\\left(-\\dfrac{t}{\\tau}\\right),  t \\ge 0, \\\\\n0,  t  0,\n\\end{cases}\n$$\n其中 $S$ 是单位胰岛素的总积分降糖效应（胰岛素敏感性因子），单位为 $\\mathrm{mg/dL}$/单位；$\\Gamma(\\cdot)$ 是Γ函数；$\\tau$ 是以分钟计的时间尺度；$n$ 是无量纲的形状参数。瞬时降糖速率由卷积定义\n$$\nr(t) = (b * h)(t) = \\int_{-\\infty}^{\\infty} b(\\xi)\\,h(t - \\xi)\\,d\\xi,\n$$\n单位为 $\\mathrm{mg/dL}$/分钟。\n\n从上述定义出发，且不使用任何快捷公式，推导有限离散推注集合下 $r(t)$ 的表达式，然后针对以下临床实际情景计算 $r(90)$：\n- 两次推注：$t_{1} = 0$ 分钟时 $B_{1} = 6$ (U)，$t_{2} = 45$ 分钟时 $B_{2} = 4$ (U)。\n- 与速效类似物药效学一致的脉冲响应参数：$S = 30$ ($\\mathrm{mg/dL}$/单位)，$\\tau = 30$ (分钟)，$n = 3$。\n\n将您在 $t = 90$ 分钟时的瞬时降糖速率的最终数值答案以 $\\mathrm{mg/dL}$/分钟表示，并将答案四舍五入至四位有效数字。", "solution": "该问题要求推导一系列胰岛素推注的瞬时降糖速率 $r(t)$，并根据给定的一组参数计算其在特定时间点的值。该系统被建模为一个线性时不变（LTI）系统。\n\n首先，我将验证问题陈述。\n\n**第一步：提取已知条件**\n- 推注输入模型：$b(t) = \\sum_{i=1}^{N} B_{i}\\,\\delta(t - t_{i})$，其中 $B_i$ 是推注剂量 (U)，$t_i$ 是推注时间 (min)，$\\delta(\\cdot)$ 是狄拉克δ分布。\n- 脉冲响应函数：\n$$\nh(t) = \\begin{cases}\n\\dfrac{S}{\\Gamma(n)\\,\\tau}\\left(\\dfrac{t}{\\tau}\\right)^{n-1}\\exp\\!\\left(-\\dfrac{t}{\\tau}\\right),  t \\ge 0, \\\\\n0,  t  0,\n\\end{cases}\n$$\n其中 $S$ 是胰岛素敏感性 ($\\mathrm{mg/dL}$/U)，$\\tau$ 是时间尺度 (min)，$n$ 是形状参数，$\\Gamma(\\cdot)$ 是Γ函数。\n- 输出定义：瞬时降糖速率 $r(t)$ 由卷积 $r(t) = (b * h)(t) = \\int_{-\\infty}^{\\infty} b(\\xi)\\,h(t - \\xi)\\,d\\xi$ 给出，单位为 $\\mathrm{mg/dL}$/min。\n- 具体情景数据：\n  - 推注：$t_{1} = 0$ 分钟时 $B_{1} = 6$ U；$t_{2} = 45$ 分钟时 $B_{2} = 4$ U。\n  - 参数：$S = 30$ $\\mathrm{mg/dL}$/U, $\\tau = 30$ min, $n = 3$。\n- 任务：推导 $r(t)$ 的通用表达式，然后计算 $r(90)$ 并将结果四舍五入至四位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n这个问题具有科学依据，代表了生物医学工程中用于糖尿病技术的标准药代动力学/药效学（PK/PD）建模方法。LTI系统近似和Γ形脉冲响应是建模胰岛素作用的成熟方法。这个问题是适定的，为得到唯一解提供了所有必要的定义、方程和参数。语言客观且量化。单位是一致的，因为单位为 $\\mathrm{mg/dL}$/min 的 $r(t)$ 是由 $b(t)$（单位为 U/min）和 $h(t)$（单位为 ($\\mathrm{mg/dL}$/U)/min）的卷积得出的。给定的参数值对于速效胰岛素类似物来说是临床上切合实际的。这个问题并非微不足道，需要对卷积和系统响应理论有清晰的理解。\n\n**第三步：结论与行动**\n这个问题是有效的。我将继续进行详细的解答。\n\n瞬时降糖速率 $r(t)$ 定义为输入推注信号 $b(t)$ 与脉冲响应函数 $h(t)$ 的卷积：\n$$\nr(t) = (b * h)(t) = \\int_{-\\infty}^{\\infty} b(\\xi)\\,h(t - \\xi)\\,d\\xi\n$$\n将输入信号的表达式 $b(t) = \\sum_{i=1}^{N} B_{i}\\,\\delta(t - t_{i})$ 代入卷积分中得到：\n$$\nr(t) = \\int_{-\\infty}^{\\infty} \\left( \\sum_{i=1}^{N} B_{i}\\,\\delta(\\xi - t_{i}) \\right) h(t - \\xi)\\,d\\xi\n$$\n根据积分算子的线性性质，我们可以交换求和与积分的顺序：\n$$\nr(t) = \\sum_{i=1}^{N} B_{i} \\int_{-\\infty}^{\\infty} \\delta(\\xi - t_{i})\\,h(t - \\xi)\\,d\\xi\n$$\n该积分可利用狄拉克δ分布的筛选性质进行计算，该性质表明 $\\int_{-\\infty}^{\\infty} f(\\xi)\\,\\delta(\\xi - a)\\,d\\xi = f(a)$。在我们的例子中，函数是 $h(t - \\xi)$，位移是 $t_i$。积分的结果是 $h(t - t_i)$。\n因此，降糖速率的通用表达式为：\n$$\nr(t) = \\sum_{i=1}^{N} B_{i}\\,h(t - t_{i})\n$$\n此表达式表明，总速率是每个独立推注响应的线性叠加，每个响应按推注剂量进行缩放并按推注时间进行延迟。这是LTI系统的一个基本特性。\n\n接下来，我们将此通用结果应用于所提供的具体情景。我们有两次推注（$N=2$）：\n- $t_{1} = 0$ 分钟时 $B_{1} = 6$ U\n- $t_{2} = 45$ 分钟时 $B_{2} = 4$ U\n\n$r(t)$ 的表达式变为：\n$$\nr(t) = B_{1}\\,h(t - t_{1}) + B_{2}\\,h(t - t_{2}) = 6\\,h(t - 0) + 4\\,h(t - 45)\n$$\n现在，我们必须使用给定的参数 $S = 30$, $\\tau = 30$ 和 $n = 3$ 来确定脉冲响应函数 $h(t)$。\n首先，我们计算整数 $n=3$ 时的Γ函数 $\\Gamma(n)$。对于正整数，$\\Gamma(n) = (n-1)!$。\n$$\n\\Gamma(3) = (3-1)! = 2! = 2\n$$\n将所有参数值代入 $h(t)$ 的定义中：\n$$\nh(t) = \\dfrac{30}{2 \\cdot 30}\\left(\\dfrac{t}{30}\\right)^{3-1}\\exp\\!\\left(-\\dfrac{t}{30}\\right) = \\dfrac{1}{2}\\left(\\dfrac{t}{30}\\right)^{2}\\exp\\!\\left(-\\dfrac{t}{30}\\right) \\quad \\text{for } t \\ge 0\n$$\n简化表达式：\n$$\nh(t) = \\dfrac{1}{2 \\cdot 30^2} t^2 \\exp\\!\\left(-\\dfrac{t}{30}\\right) = \\dfrac{1}{1800} t^2 \\exp\\!\\left(-\\dfrac{t}{30}\\right) \\quad \\text{for } t \\ge 0\n$$\n且当 $t  0$ 时，$h(t)=0$。\n\n我们需要计算 $t = 90$ 分钟时的 $r(t)$。\n$$\nr(90) = 6\\,h(90 - 0) + 4\\,h(90 - 45) = 6\\,h(90) + 4\\,h(45)\n$$\n$h$ 的自变量（90 和 45）都大于或等于0，所以我们使用推导出的 $h(t)$ 表达式。\n\n我们来计算 $h(90)$：\n$$\nh(90) = \\dfrac{1}{1800} (90)^2 \\exp\\!\\left(-\\dfrac{90}{30}\\right) = \\dfrac{8100}{1800} \\exp(-3) = 4.5\\,\\exp(-3)\n$$\n接下来，我们计算 $h(45)$：\n$$\nh(45) = \\dfrac{1}{1800} (45)^2 \\exp\\!\\left(-\\dfrac{45}{30}\\right) = \\dfrac{2025}{1800} \\exp(-1.5) = 1.125\\,\\exp(-1.5)\n$$\n现在，我们将这些值代回 $r(90)$ 的表达式中：\n$$\nr(90) = 6 \\cdot (4.5\\,\\exp(-3)) + 4 \\cdot (1.125\\,\\exp(-1.5))\n$$\n$$\nr(90) = 27\\,\\exp(-3) + 4.5\\,\\exp(-1.5)\n$$\n为了得到最终的数值答案，我们使用指数函数的值：\n$$\n\\exp(-3) \\approx 0.049787068\n$$\n$$\n\\exp(-1.5) \\approx 0.223130160\n$$\n$$\nr(90) \\approx 27 \\cdot (0.049787068) + 4.5 \\cdot (0.223130160)\n$$\n$$\nr(90) \\approx 1.344250836 + 1.004085720\n$$\n$$\nr(90) \\approx 2.348336556\n$$\n题目要求将答案四舍五入至四位有效数字。\n$$\nr(90) \\approx 2.348\n$$\n$r(t)$ 的单位是 $\\mathrm{mg/dL}$/分钟。", "answer": "$$\n\\boxed{2.348}\n$$", "id": "4791423"}]}