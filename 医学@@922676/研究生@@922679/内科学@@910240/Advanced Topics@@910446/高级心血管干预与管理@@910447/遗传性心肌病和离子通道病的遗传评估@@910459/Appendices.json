{"hands_on_practices": [{"introduction": "遗传性心脏病的诊断基石在于准确地将基因变异分为致病性或良性。本练习将带您实践美国医学遗传学与基因组学学会 (ACMG) 和临床基因组资源 (ClinGen) 推荐的定量贝叶斯框架。通过该练习，您将学习如何整合多种证据（如功能数据、人群频率和计算机预测），并使用似然比来计算一个变异的致病性后验概率，这是现代基因诊断流程中的一项核心技能[@problem_id:4838933]。", "problem": "一家心脏病遗传学诊所正在评估在一个临床表型符合遗传性心脏离子通道病的先证者中发现的钠电压门控通道α亚基$5$基因（$SCN5A$）的一个错义变异。该变异使用美国医学遗传学与基因组学学会（ACMG）框架进行分类，具有以下证据代码：PS3（具有破坏性效应的强功能证据）、PM1（位于突变热点或功能域的中等证据）、PM2（在人群对照（例如基因组聚合数据库 gnomAD）中缺失的中等证据）、PP3（有害效应的支持性计算证据）和 BS1（等位基因频率过高的强良性证据，但在该疾病背景下针对 $SCN5A$ 被明确否定）。\n\n假设该诊所采用与临床基因组资源序列变异解读（ClinGen SVI）建议一致的贝叶斯定量框架，其中每个ACMG证据强度都映射到一个似然比（LR）。对于此变异，使用以下似然比：PS3: $18.7$，PM1: $4.33$，PM2: $4.33$，PP3: $2.08$，BS1（被否定）: $1$。假设在致病性状态为条件的情况下，这些证据项对总似然的贡献是独立的。\n\n假设在一个已确定有效性的基因-疾病对中，正在评估的一个罕见的 $SCN5A$ 错义变异是致病的先验概率为 $P_{0} = 0.1$。\n\n使用基本的贝叶斯原理，计算在给定指定证据的情况下该变异是致病的后验概率。将最终的后验概率四舍五入到$4$位有效数字，并以小数形式表示。", "solution": "目标是计算在给定一组证据代码的情况下，指定变异是致病的后验概率。这可以表示为 $P(\\text{致病性} | \\text{证据})$。我们将使用贝叶斯定理，在处理似然比时，使用其优势比形式最为方便。\n\n设 $H_P$ 为变异是致病的假设， $H_B$ 为变异是良性的假设。致病性的先验概率给定为 $P(H_P) = P_0 = 0.1$。因此，变异是良性的先验概率为 $P(H_B) = 1 - P(H_P) = 1 - 0.1 = 0.9$。\n\n支持致病性的先验优势比定义为先验概率之比：\n$$\nO_{prior} = \\frac{P(H_P)}{P(H_B)}\n$$\n代入给定值：\n$$\nO_{prior} = \\frac{0.1}{0.9} = \\frac{1}{9}\n$$\n\n证据由五个项目组成，每个项目都有一个相关的似然比（$LR$）。对于一条证据 $E_i$，其似然比由 $LR_i = \\frac{P(E_i | H_P)}{P(E_i | H_B)}$ 给出。问题为给定的ACMG证据代码提供了以下似然比：\n- $LR_{PS3} = 18.7$\n- $LR_{PM1} = 4.33$\n- $LR_{PM2} = 4.33$\n- $LR_{PP3} = 2.08$\n- $LR_{BS1} = 1$（此代码被否定，意味着它提供中性证据，对应于$1$的$LR$。）\n\n问题陈述指出，在致病性状态为条件的情况下，这些证据项是独立贡献的。因此，对于组合的证据集 $E = \\{E_{PS3}, E_{PM1}, E_{PM2}, E_{PP3}, E_{BS1}\\}$，总似然比是各个似然比的乘积：\n$$\nLR_{total} = LR_{PS3} \\times LR_{PM1} \\times LR_{PM2} \\times LR_{PP3} \\times LR_{BS1}\n$$\n代入数值：\n$$\nLR_{total} = 18.7 \\times 4.33 \\times 4.33 \\times 2.08 \\times 1\n$$\n$$\nLR_{total} = 18.7 \\times (4.33)^2 \\times 2.08\n$$\n$$\nLR_{total} = 18.7 \\times 18.7489 \\times 2.08\n$$\n$$\nLR_{total} = 729.256792\n$$\n\n根据贝叶斯定理的优势比形式，后验优势比是先验优势比和总似然比的乘积：\n$$\nO_{posterior} = O_{prior} \\times LR_{total}\n$$\n代入计算出的 $O_{prior}$ 和 $LR_{total}$ 的值：\n$$\nO_{posterior} = \\frac{1}{9} \\times 729.256792 \\approx 81.0285324\n$$\n\n最后，我们将后验优势比转换回后验概率。致病性的后验概率 $P_{posterior} = P(H_P | E)$ 与后验优势比通过以下公式相关：\n$$\nP_{posterior} = \\frac{O_{posterior}}{1 + O_{posterior}}\n$$\n代入 $O_{posterior}$ 的值：\n$$\nP_{posterior} = \\frac{81.0285324}{1 + 81.0285324} = \\frac{81.0285324}{82.0285324}\n$$\n$$\nP_{posterior} \\approx 0.9878090\n$$\n\n问题要求将最终答案四舍五入到$4$位有效数字。\n$$\nP_{posterior} \\approx 0.9878\n$$\n根据ClinGen SVI框架，此后验概率将该变异置于“致病性”分类范畴。该框架为“致病性”（Pathogenic）设定的阈值为 $P(\\text{致病性} | \\text{证据}) \\ge 0.99$，为“可能致病性”（Likely Pathogenic）设定的阈值为 $0.90 - 0.99$。计算出的约 $0.988$ 的值落入“可能致病性”的范围内。然而，确切的阈值可能会有所不同，计算本身是主要目标。四舍五入到四位有效数字的最终计算值为 $0.9878$。", "answer": "$$\n\\boxed{0.9878}\n$$", "id": "4838933"}, {"introduction": "在确定患者携带致病性变异后，临床管理的下一步是进行精确的风险分层。本练习将指导您如何利用整合了基因型和临床风险因素（如射血分数和心律失常）的预后模型来制定重要的治疗决策。您将通过从第一性原理推导一个植入式心律转复除颤器 (ICD) 的决策阈值，从而将抽象的统计模型转化为具体的临床实践指南[@problem_id:4838940]。", "problem": "一个A型/C型层粘连蛋白 (LMNA) 相关心肌病患者队列因恶性室性心律失常事件而受到随访。您将使用一个基于回归的风险评分来制定一个基于风险的植入式心律转复除颤器 (ICD) 植入策略，该评分包含了非持续性室性心动过速 (NSVT)、左心室射血分数 (LVEF)、男性以及非错义变异状态这些因素。假设以下建模框架和参数化是有效的，并且已经从一个大型、表型特征明确的基因阳性队列中估算得出：\n\n- 事件时间模型是一个比例风险模型，其个体风险函数为 $h(t \\mid X) = h_{0}(t)\\exp(\\eta)$，其中 $\\eta = \\beta_{1}x_{1} + \\beta_{2}x_{2} + \\beta_{3}x_{3} + \\beta_{4}x_{4}$ 是线性预测因子。\n- 协变量定义如下：$x_{1}$ 是过去 $12$ 个月内发生非持续性室性心动过速 (NSVT) 的指示变量 ($x_{1} \\in \\{0,1\\}$)，$x_{2}$ 是LVEF低于 $55$ 的 $10$ 个百分点的递减单位数（即 $x_{2} = \\max\\{0, (55 - \\text{LVEF})/10\\}$），$x_{3}$ 是男性的指示变量 ($x_{3} \\in \\{0,1\\}$)，$x_{4}$ 是非错义变异（例如，截断或剪接）的指示变量 ($x_{4} \\in \\{0,1\\}$)。\n- 回归系数为：$\\beta_{1} = 0.90$，$\\beta_{2} = 0.35$，$\\beta_{3} = 0.40$，以及 $\\beta_{4} = 0.60$。\n- $5$年基线生存率（即当 $\\eta = 0$ 时的生存率）是 $S_{0}(5) = 0.94$。\n\n从比例风险模型中生存和风险的基本原理出发，推导线性预测因子 $\\eta$ 的一个闭式决策阈值 $T$，使得当且仅当预测的5年风险超过 $0.10$ 时，推荐植入ICD。然后使用 $S_{0}(5) = 0.94$ 对 $T$ 进行数值计算。\n\n给出您的最终数值阈值，并四舍五入到四位有效数字。答案中不要包含任何单位。", "solution": "该问题要求在比例风险模型中，为用于风险分层的线性预测因子 $\\eta$ 推导出一个决策阈值 $T$。该策略是如果预测的5年恶性室性心律失常事件风险超过某个值，则推荐植入式心律转复除颤器 (ICD)。\n\n此问题的基础在于生存分析。设 $h(t)$ 为风险函数，表示在生存到时间 $t$ 的条件下，在时间 $t$ 发生事件的瞬时速率。累积风险函数 $H(t)$ 是风险函数从时间 $0$ 到 $t$ 的积分：\n$$H(t) = \\int_{0}^{t} h(u) \\,du$$\n生存函数 $S(t)$，即生存超过时间 $t$ 的概率，与累积风险函数的关系如下：\n$$S(t) = \\exp(-H(t))$$\n\n问题指定了一个比例风险模型，其中个体的风险函数通过一个线性预测因子 $\\eta$ 依赖于一组协变量 $X$。对于具有协变量 $X$ 的个体，其风险函数由下式给出：\n$$h(t \\mid X) = h_{0}(t)\\exp(\\eta)$$\n其中 $h_{0}(t)$ 是基线风险函数（当 $\\eta = 0$ 时的风险），$\\eta = \\beta_{1}x_{1} + \\beta_{2}x_{2} + \\beta_{3}x_{3} + \\beta_{4}x_{4}$ 是基于个体特定风险因素的线性预测因子。\n\n该个体的累积风险 $H(t \\mid X)$ 因此是：\n$$H(t \\mid X) = \\int_{0}^{t} h(u \\mid X) \\,du = \\int_{0}^{t} h_{0}(u)\\exp(\\eta) \\,du$$\n由于 $\\exp(\\eta)$ 不是积分变量 $u$ 的函数，它可以被视为一个常数因子：\n$$H(t \\mid X) = \\exp(\\eta) \\int_{0}^{t} h_{0}(u) \\,du$$\n积分项是基线累积风险 $H_{0}(t)$。因此，我们得到了累积风险函数的比例风险关系：\n$$H(t \\mid X) = H_{0}(t) \\exp(\\eta)$$\n\n现在，我们可以用基线生存函数 $S_{0}(t)$ 来表示个体的生存函数 $S(t \\mid X)$。个体生存率为：\n$$S(t \\mid X) = \\exp(-H(t \\mid X)) = \\exp(-H_{0}(t) \\exp(\\eta))$$\n基线生存函数对应于 $\\eta=0$ 的情况，所以 $S_{0}(t) = \\exp(-H_{0}(t))$。我们可以将基线累积风险表示为 $H_{0}(t) = -\\ln(S_{0}(t))$。将此代入 $S(t \\mid X)$ 的方程中：\n$$S(t \\mid X) = \\exp( -(-\\ln(S_{0}(t))) \\exp(\\eta) ) = \\exp(\\ln(S_{0}(t)) \\exp(\\eta))$$\n使用恒等式 $a^b = \\exp(b \\ln a)$，这可以简化为比例风险模型中的一个基本关系：\n$$S(t \\mid X) = [S_{0}(t)]^{\\exp(\\eta)}$$\n\n决策规则是，如果预测的5年风险超过 $0.10$，则推荐植入ICD。到时间 $t$ 发生事件的风险记为 $R(t)$，其值为 $1 - S(t)$。因此，条件是：\n$$R(5 \\mid X) > 0.10$$\n$$1 - S(5 \\mid X) > 0.10$$\n$$S(5 \\mid X)  0.90$$\n\n我们现在将推导出的生存函数表达式代入这个不等式：\n$$[S_{0}(5)]^{\\exp(\\eta)}  0.90$$\n为了解出 $\\eta$，我们对两边取自然对数。由于 $\\ln(x)$ 是一个严格单调递增函数，不等号的方向保持不变。\n$$\\ln\\left( [S_{0}(5)]^{\\exp(\\eta)} \\right)  \\ln(0.90)$$\n$$\\exp(\\eta) \\ln(S_{0}(5))  \\ln(0.90)$$\n问题给出的5年基线生存率为 $S_{0}(5) = 0.94$。由于 $0  S_{0}(5)  1$，其自然对数 $\\ln(S_{0}(5))$ 是一个负数。当我们将不等式两边同除以这个负数时，我们必须反转不等号的方向：\n$$\\exp(\\eta) > \\frac{\\ln(0.90)}{\\ln(S_{0}(5))}$$\n为了分离出 $\\eta$，我们再次对两边取自然对数。不等号方向保持不变。\n$$\\eta > \\ln\\left( \\frac{\\ln(0.90)}{\\ln(S_{0}(5))} \\right)$$\n当 $\\eta$ 超过这个值时，策略是推荐植入ICD。因此，线性预测因子 $\\eta$ 的决策阈值 $T$ 是：\n$$T = \\ln\\left( \\frac{\\ln(0.90)}{\\ln(S_{0}(5))} \\right)$$\n\n现在，我们使用给定的值 $S_{0}(5) = 0.94$ 对此表达式进行数值计算。\n$$T = \\ln\\left( \\frac{\\ln(0.90)}{\\ln(0.94)} \\right)$$\n首先，我们计算对数值：\n$$\\ln(0.90) \\approx -0.1053605$$\n$$\\ln(0.94) \\approx -0.0618754$$\n接下来，我们计算比率：\n$$\\frac{\\ln(0.90)}{\\ln(0.94)} \\approx \\frac{-0.1053605}{-0.0618754} \\approx 1.702827$$\n最后，我们计算这个比率的自然对数：\n$$T \\approx \\ln(1.702827) \\approx 0.532305$$\n问题要求将最终的数值阈值四舍五入到四位有效数字。\n$$T \\approx 0.5323$$\n这个值 $T$ 是线性预测因子 $\\eta$ 的阈值。如果一个个体计算出的 $\\eta$ 大于 $0.5323$，其恶性室性心律失常事件的5年预测风险就大于10%，根据此策略将推荐植入ICD。给定的回归系数 $\\beta_{1}, \\beta_{2}, \\beta_{3}, \\beta_{4}$ 将用于根据特定患者的临床特征计算其 $\\eta$ 值。", "answer": "$$\\boxed{0.5323}$$", "id": "4838940"}, {"introduction": "遗传咨询有时会遇到复杂的特殊情况，例如当一个“新生”变异的患儿父母检测结果呈阴性时，嵌合体现象便是其中一种重要可能。本练习将探讨父母嵌合体对子代再发风险评估的影响，展示如何利用新一代测序技术检测到的等位基因分数 (Allele Fraction, AF) 这一量化指标来修正风险评估。这个案例凸显了高灵敏度检测技术在精确化遗传咨询中的关键作用[@problem_id:4838952]。", "problem": "一名先证者因β-肌球蛋白重链基因 (MYH7) 的致病性变异而表现出肥厚型心肌病。最初通过标准Sanger测序对双亲进行的检测结果为阴性，因此对其未来同胞的复发风险估计接近于零。然而，后续对父亲外周血的深度下一代测序 (NGS) 发现，在 MYH7 变异位点存在等位基因分数 (AF) 为 $0.05$ 的低水平亲代嵌合体。假设遵循以下基本原则和定义：\n\n- 嵌合体是由合子后突变产生的，导致一部分体细胞和生殖细胞对该变异呈杂合状态。\n- 在NGS中，组织中观察到的AF是携带变异等位基因的读数比例。在等位基因均等表达的二倍体杂合性标准模型下，由比例为 $f_{\\text{cells}}$ 的杂合细胞组成的样本中，AF满足 $AF \\approx \\frac{1}{2} f_{\\text{cells}}$。\n- 对于影响多个细胞谱系的早期合子后变异，血液中杂合细胞的比例约等于生殖系中杂合细胞的比例，因此 $f_{\\text{germ}} \\approx f_{\\text{blood}}$。\n- 在常染色体显性遗传中，对于一个杂合的生殖细胞，根据孟德尔分离定律，配子携带该变异等位基因的概率为 $\\frac{1}{2}$。\n- 每次受孕都是独立事件，并且遗传的致病性 MYH7 变异的外显率是完全的。\n\n利用这些原则，根据给定的父亲血液中AF为 $0.05$ 的观察结果，从第一性原理推导每个未来后代的复发风险。将最终的复发风险表示为小数（不带百分号），并将答案四舍五入至四位有效数字。除上述说明外，不要假定任何额外的组织特异性校正因子，并在本次计算中忽略测序错误。", "solution": "复发风险（记为 $R$）是该夫妇的未来后代将遗传到该致病性变异的概率。由于母亲的基因检测结果为阴性，我们假设她为野生型等位基因的纯合子，她传递该致病性变异的概率为 $0$。因此，全部复发风险取决于父亲对该变异的传递。\n$R = P(\\text{offspring inherits variant}) = P(\\text{father transmits variant})$\n\n父亲是嵌合体，意味着他的身体由两种细胞群体组成：一部分细胞对该致病性变异呈杂合状态，其余部分细胞为野生型等位基因的纯合子。复发风险取决于其生殖系（产生精子的细胞）中携带该变异的细胞比例。设 $f_{\\text{germ}}$ 为父亲生殖系细胞中对 *MYH7* 变异呈杂合状态的比例。剩余的比例 $1 - f_{\\text{germ}}$ 为野生型。\n\n从父亲体内随机选择一个配子携带该致病性变异的概率可以通过全概率定律确定。一个配子可以来自杂合的生殖细胞，也可以来自野生型的生殖细胞。\n\n$P(\\text{variant gamete}) = P(\\text{variant gamete} | \\text{germ cell is heterozygous}) \\times P(\\text{germ cell is heterozygous}) + P(\\text{variant gamete} | \\text{germ cell is wild-type}) \\times P(\\text{germ cell is wild-type})$\n\n根据问题的原则：\n- 配子源自杂合生殖细胞的概率是 $P(\\text{germ cell is heterozygous}) = f_{\\text{germ}}$。\n- 配子源自野生型生殖细胞的概率是 $P(\\text{germ cell is wild-type}) = 1 - f_{\\text{germ}}$。\n- 根据孟德尔分离定律，变异配子由杂合生殖细胞产生的概率是 $P(\\text{variant gamete} | \\text{germ cell is heterozygous}) = \\frac{1}{2}$。\n- 变异配子由野生型生殖细胞产生的概率是 $P(\\text{variant gamete} | \\text{germ cell is wild-type}) = 0$。\n\n将这些代入复发风险 $R$ 的方程中：\n$$R = \\left(\\frac{1}{2}\\right) \\times f_{\\text{germ}} + (0) \\times (1 - f_{\\text{germ}})$$\n$$R = \\frac{1}{2} f_{\\text{germ}}$$\n\n现在的任务是确定 $f_{\\text{germ}}$ 的值。问题提供了来自血液样本的数据以及一个将其与生殖系关联起来的原则。我们已知血液中的等位基因分数 $AF_{\\text{blood}} = 0.05$。\n\n等位基因分数与给定组织中杂合细胞的比例 $f_{\\text{cells}}$ 之间的关系如下：\n$$AF \\approx \\frac{1}{2} f_{\\text{cells}}$$\n对于血液样本，该关系变为：\n$$AF_{\\text{blood}} \\approx \\frac{1}{2} f_{\\text{blood}}$$\n我们可以解出 $f_{\\text{blood}}$：\n$$f_{\\text{blood}} \\approx 2 \\times AF_{\\text{blood}}$$\n代入给定值 $AF_{\\text{blood}} = 0.05$：\n$$f_{\\text{blood}} \\approx 2 \\times 0.05 = 0.10$$\n这表明父亲外周血中大约有 $10\\%$ 的细胞对该变异呈杂合状态。\n\n问题陈述中要求假设血液中杂合细胞的比例约等于生殖系中的比例：\n$$f_{\\text{germ}} \\approx f_{\\text{blood}}$$\n因此，我们有：\n$$f_{\\text{germ}} \\approx 0.10$$\n\n最后，我们将这个值代回到我们的复发风险 $R$ 的方程中：\n$$R = \\frac{1}{2} f_{\\text{germ}} \\approx \\frac{1}{2} \\times 0.10 = 0.05$$\n\n每个未来后代的复发风险是 $0.05$。这个结果可以通过组合符号表达式更直接地推导出：$R = \\frac{1}{2} f_{\\text{germ}} \\approx \\frac{1}{2} f_{\\text{blood}} \\approx \\frac{1}{2} (2 \\times AF_{\\text{blood}}) = AF_{\\text{blood}}$。因此，在给定的简化假设下，复发风险在数值上等于在父亲血液中测得的等位基因分数。\n\n问题要求答案以小数形式表示，并四舍五入至四位有效数字。计算出的风险为 $0.05$。为了用四位有效数字表示，我们将其写为 $0.0500$。", "answer": "$$\\boxed{0.0500}$$", "id": "4838952"}]}