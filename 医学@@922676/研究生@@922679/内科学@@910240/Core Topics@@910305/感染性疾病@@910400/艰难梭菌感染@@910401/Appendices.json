{"hands_on_practices": [{"introduction": "诊断性检测的解读是临床医学的基石。这项练习将带领您深入了解检测性能背后的基本数学原理，运用贝叶斯定理计算阳性预测值（$PPV$）。通过这个实践[@problem_id:4816273]，您将理解一个检测的临床效用如何关键性地取决于疾病的患病率，这是做出准确临床判断的核心技能。", "problem": "一家三级医院正在评估一种用于诊断艰难梭菌感染 (CDI) 的粪便毒素酶免疫分析 (EIA) 检测。该检测的特性如下：灵敏度 $Se = 0.70$，特异性 $Sp = 0.95$。在所考虑的住院患者群体中，CDI 的时点患病率为 $P = 0.25$。请仅使用灵敏度、特异性、患病率和贝叶斯定理的基本定义，推导在该情况下毒素 EIA 检测的阳性预测值 (PPV) 的表达式，然后根据给定参数计算其数值。将最终的 PPV 表示为小数，并将答案四舍五入至四位有效数字。在您的回答中不要使用百分号。", "solution": "该问题要求推导和计算一种诊断测试的阳性预测值 (PPV)。推导过程必须从灵敏度、特异性、患病率和贝叶斯定理的基本定义出发。让我们根据问题陈述来定义相关事件和概率。\n\n设 $D$ 为患者患有艰难梭菌 (*Clostridioides difficile*) 感染 (CDI) 的事件，设 $D^c$ 为患者未患有 CDI 的事件。\n设 $T^+$ 为粪便毒素酶免疫分析 (EIA) 检测结果为阳性的事件，设 $T^-$ 为检测结果为阴性的事件。\n\n根据问题陈述，我们得到以下概率：\nCDI 的患病率 $P$ 是患者患有该疾病的先验概率：\n$$ P(D) = P = 0.25 $$\n患者未患病的概率是患病率的补集：\n$$ P(D^c) = 1 - P(D) = 1 - P = 1 - 0.25 = 0.75 $$\n该检测的灵敏度 $Se$ 是在患者患病的情况下，检测结果为阳性的概率：\n$$ Se = P(T^+ | D) = 0.70 $$\n该检测的特异性 $Sp$ 是在患者未患病的情况下，检测结果为阴性的概率：\n$$ Sp = P(T^- | D^c) = 0.95 $$\n\n需要确定的是阳性预测值 (PPV)。PPV 定义为在检测结果为阳性的情况下，患者确实患有该疾病的概率，即条件概率 $P(D | T^+)$。\n\n使用条件概率的定义，该定义可以重排为贝叶斯定理的形式，我们可以将 PPV 表示为：\n$$ PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)} $$\n分母 $P(T^+)$ 表示获得阳性检测结果的总概率。我们可以使用全概率定律来计算它，对患病 ($D$) 或不患病 ($D^c$) 这两种互斥状态求和：\n$$ P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c) $$\n使用条件概率的定义 $P(A \\cap B) = P(A|B)P(B)$，我们可以将其重写为：\n$$ P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c) $$\n第一项 $P(T^+ | D)$ 是灵敏度 $Se$。第二项 $P(T^+ | D^c)$ 是未患病患者检测结果为阳性（假阳性）的概率。这是特异性 $Sp$ 的补集，因为对于一个未患病的患者，检测结果可以是阳性或阴性。\n$$ P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp $$\n将 $Se$、$Sp$ 和 $P$ 代入 $P(T^+)$ 的表达式中，我们得到：\n$$ P(T^+) = (Se \\cdot P) + ((1 - Sp) \\cdot (1 - P)) $$\n现在，我们将这个 $P(T^+)$ 的表达式代回到 PPV 的贝叶斯定理公式中：\n$$ PPV = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)} $$\n这样就得到了以灵敏度 ($Se$)、特异性 ($Sp$) 和患病率 ($P$) 表示的 PPV 的最终推导表达式：\n$$ PPV = \\frac{Se \\cdot P}{Se \\cdot P + (1 - Sp) \\cdot (1 - P)} $$\n至此，任务的推导部分完成。\n\n接下来，我们使用给定的参数计算 PPV 的数值：$Se = 0.70$，$Sp = 0.95$，$P = 0.25$。\n将这些值代入推导出的公式中：\n$$ PPV = \\frac{(0.70)(0.25)}{(0.70)(0.25) + (1 - 0.95)(1 - 0.25)} $$\n首先，我们计算分子和分母中的各项：\n分子是真阳性的概率：\n$$ Se \\cdot P = 0.70 \\times 0.25 = 0.175 $$\n分母中的第二项是假阳性的概率：\n$$ (1 - Sp) \\cdot (1 - P) = (1 - 0.95) \\times (1 - 0.25) = 0.05 \\times 0.75 = 0.0375 $$\n现在，我们将这些值代回 PPV 方程：\n$$ PPV = \\frac{0.175}{0.175 + 0.0375} $$\n$$ PPV = \\frac{0.175}{0.2125} $$\n进行除法运算：\n$$ PPV \\approx 0.82352941176... $$\n问题要求将答案四舍五入到四位有效数字。\n$$ PPV \\approx 0.8235 $$\n因此，在该住院患者群体中，毒素 EIA 检测的阳性预测值约为 $0.8235$。", "answer": "$$\\boxed{0.8235}$$", "id": "4816273"}, {"introduction": "在真实的临床情境中，诊断过程往往比单一检测更为复杂。这项练习将引导您处理一个棘手的诊断难题：当多步骤诊断流程（如艰难梭菌感染的诊断）产生不一致结果时应如何决策。您将学习如何整合多个数据点，包括核酸扩增测试（NAAT）的循环阈值（$C_t$值）等量化信息，利用似然比来更新后验概率，从而更精确地区分感染与定植，并做出明智的临床决策[@problem_id:4816255]。", "problem": "一名近期接触过广谱抗生素的住院患者出现腹泻，符合临床检测标准（$24$ 小时内至少 $3$ 次不成形粪便且未使用泻药）。临床团队根据症状出现时间、风险因素以及无其他替代病因，估计产毒性 Clostridioides difficile 感染的验前概率为 $p_0 = 0.25$。实验室采用多步算法：谷氨酸脱氢酶免疫分析法（Glutamate Dehydrogenase (GDH)）、毒素酶免疫分析法（Enzyme Immunoassay (EIA)），并在GDH和毒素EIA结果不一致时，使用核酸扩增检测（Nucleic Acid Amplification Test (NAAT)）作为决胜方法。对该患者而言，粪便检测结果为GDH阳性、毒素EIA阴性、NAAT阳性，其中NAAT报告的循环阈值为 $C_t = 33$。\n\n根据经过充分测试的临床验证研究，假设以下性能特征参照毒素活性标准（以细胞毒性中和试验（Cell Cytotoxicity Neutralization Assay (CCNA)）阳性作为疾病定义）：\n- GDH：敏感性 $= 0.95$，特异性 $= 0.75$。\n- 毒素 EIA：敏感性 $= 0.60$，特异性 $= 0.95$。\n- NAAT：当结果为阳性时，证据强度取决于通过 $C_t$ 估算的细菌载量。对CCNA阳性使用如下分层阳性似然比 $LR^+$：$C_t \\le 26$ 意味着 $LR^+ = 12$，$26   C_t \\le 30$ 意味着 $LR^+ = 5$，$C_t  30$ 意味着 $LR^+ = 1.5$。\n\n假设这些检测是序贯应用的，并且为了临床决策，它们的似然比可以相乘以更新基于验前概率的几率。根据GDH阳性/毒素阴性/NAAT阳性（$C_t = 33$）这一不一致的模式，推断最可能的临床状态，并以科学合理的方式选择最佳的下一步措施或基于阈值的方法来解决剩余的不确定性。\n\n哪个选项最能反映综合解释和最合适的额外步骤？\n\nA. 鉴于细菌载量低（$C_t  30$）和毒素阴性，最可能是产毒性 Clostridioides difficile 菌株定植；推迟抗 Clostridioides difficile 治疗，并通过获取CCNA或使用载量阈值（例如，仅在 $C_t \\le 26$ 或临床严重程度增加时治疗）来解决不确定性。\n\nB. 最可能是活动性 Clostridioides difficile 感染，因为任何NAAT阳性都可确诊疾病；立即开始口服 vancomycin，并且不进行进一步的检测或使用阈值。\n\nC. NAAT很可能是假阳性；忽略GDH和NAAT，仅依赖毒素EIA，即使症状持续也避免治疗。\n\nD. 立即使用 fidaxomicin 进行经验性治疗并重复NAAT；如果重复的NAAT仍为阳性，则无论$C_t$值、毒素EIA或临床轨迹如何，都继续治疗。\n\nE. 最可能是定植；然而，当 $C_t \\le 35$ 时应开始治疗，因为该阈值无需额外检测即可可靠地区分疾病与定植。", "solution": "## 问题验证 ##\n\n在尝试任何解决方案之前，问题陈述都经过了严格的验证过程。\n\n### 步骤1：提取给定信息\n- **患者情况**：住院，近期接触广谱抗生素，腹泻（$24$ 小时内至少 $3$ 次不成形粪便，未使用泻药）。\n- **验前概率**：对产毒性 *Clostridioides difficile* 感染（CDI）的初步临床估计为 $p_0 = P(\\text{疾病}) = 0.25$。\n- **检测结果**：患者的粪便样本通过多步算法得出以下结果：\n    - 谷氨酸脱氢酶（GDH）免疫分析法：阳性\n    - 毒素酶免疫分析法（EIA）：阴性\n    - 核酸扩增检测（NAAT）：阳性，循环阈值（$C_t$）为$33$。\n- **金标准**：定义活动性疾病的参考标准是细胞毒性中和试验（Cell Cytotoxicity Neutralization Assay (CCNA)）阳性。\n- **检测性能特征（相对于CCNA）**：\n    - GDH：敏感性 $S_e(\\text{GDH}) = 0.95$，特异性 $S_p(\\text{GDH}) = 0.75$。\n    - 毒素 EIA：敏感性 $S_e(\\text{EIA}) = 0.60$，特异性 $S_p(\\text{EIA}) = 0.95$。\n    - NAAT（阳性结果分层）：\n        - 对于 $C_t \\le 26$，阳性似然比为 $LR^+ = 12$。\n        - 对于 $26   C_t \\le 30$，阳性似然比为 $LR^+ = 5$。\n        - 对于 $C_t  30$，阳性似然比为 $LR^+ = 1.5$。\n- **问题假设**：序贯检测的似然比可以相乘以更新验前几率。\n\n### 步骤2：使用提取的给定信息进行验证\n1.  **科学依据**：该问题具有科学合理性。它呈现了一个在传染病领域常见且具有挑战性的临床情景。诊断算法（GDH/EIA，以NAAT作为决胜方法）与主要学会（如IDSA/SHEA）的现行指南一致。使用CCNA作为参考标准，尽管多为历史做法，但对于定义检测特性是合适的。使用$C_t$值量化细菌载量并对NAAT结果进行分层的概念，是当前研究和临床实践中旨在区分定植与活动性感染的一个关键领域。提供的检测性能值是合理的。\n2.  **适定性**：该问题是适定的。它提供了所有必要的定量信息（验前概率、检测结果以及以敏感性、特异性和似然比形式表示的性能特征），以得出一个唯一的验后概率。问题要求进行解释并选择后续行动，这是贝叶斯推理在临床背景下的标准应用。\n3.  **客观性**：问题陈述是客观的，没有主观或偏见的语言。所有数据均以定量参数形式呈现。\n\n### 步骤3：结论与行动\n问题陈述有效。它具有科学依据，适定、客观，且不包含内部矛盾或缺失信息。可以进行求解过程。\n\n## 解题推导 ##\n\n目标是根据给定的检测结果和$p_0 = 0.25$的验前概率，计算活动性CDI的验后概率。我们将使用贝叶斯定理的几率-似然比形式。设$D$为活动性疾病事件（CCNA阳性）。\n\n1.  **计算验前几率**:\n    验前概率为 $P(D) = 0.25$。\n    验前几率计算如下：\n    $$\n    \\text{Odds}_{\\text{pre}} = \\frac{P(D)}{1 - P(D)} = \\frac{0.25}{1 - 0.25} = \\frac{0.25}{0.75} = \\frac{1}{3}\n    $$\n\n2.  **计算每个检测结果的似然比（LR）**:\n    - **GDH阳性 (GDH+)**：这对应于阳性似然比，$LR^+$。\n    $$\n    LR(\\text{GDH+}) = \\frac{\\text{sensitivity}}{\\text{1 - specificity}} = \\frac{S_e(\\text{GDH})}{1 - S_p(\\text{GDH})} = \\frac{0.95}{1 - 0.75} = \\frac{0.95}{0.25} = 3.8\n    $$\n    - **毒素EIA阴性 (EIA−)**：这对应于阴性似然比，$LR^-$。\n    $$\n    LR(\\text{EIA−}) = \\frac{\\text{1 - sensitivity}}{\\text{specificity}} = \\frac{1 - S_e(\\text{EIA})}{S_p(\\text{EIA})} = \\frac{1 - 0.60}{0.95} = \\frac{0.40}{0.95} = \\frac{40}{95} = \\frac{8}{19}\n    $$\n    - **NAAT阳性 (NAAT+) 且 $C_t = 33$**：问题直接提供了分层的$LR^+$。由于$33  30$，我们使用相应的值。\n    $$\n    LR(\\text{NAAT+}, C_t=33) = 1.5\n    $$\n\n3.  **计算组合似然比**:\n    根据问题的假设，我们将各个似然比相乘。\n    $$\n    LR_{\\text{combined}} = LR(\\text{GDH+}) \\times LR(\\text{EIA−}) \\times LR(\\text{NAAT+}, C_t=33)\n    $$\n    $$\n    LR_{\\text{combined}} = 3.8 \\times \\frac{8}{19} \\times 1.5 = \\frac{38}{10} \\times \\frac{8}{19} \\times \\frac{15}{10} = \\frac{2 \\times 19}{10} \\times \\frac{8}{19} \\times \\frac{15}{10} = \\frac{2 \\times 8 \\times 15}{100} = \\frac{240}{100} = 2.4\n    $$\n\n4.  **计算验后几率**:\n    验后几率是验前几率与组合似然比的乘积。\n    $$\n    \\text{Odds}_{\\text{post}} = \\text{Odds}_{\\text{pre}} \\times LR_{\\text{combined}} = \\frac{1}{3} \\times 2.4 = 0.8\n    $$\n\n5.  **计算验后概率**:\n    最后，我们将验后几率转换回概率。\n    $$\n    P_{\\text{post}}(D) = \\frac{\\text{Odds}_{\\text{post}}}{1 + \\text{Odds}_{\\text{post}}} = \\frac{0.8}{1 + 0.8} = \\frac{0.8}{1.8} = \\frac{8}{18} = \\frac{4}{9}\n    $$\n    该概率约为 $P_{\\text{post}}(D) \\approx 0.444$，即 $44.4\\%$。\n\n### 解释与选项分析\n\n活动性CDI的验后概率约为$44\\%$。这是一个中间概率，处于诊断不确定性区域。活动性疾病的概率从最初的$25\\%$有所增加，但仍低于$50\\%$。这意味着患者*不*患有活动性CDI的可能性略高（$P(\\neg D) = 1 - 4/9 = 5/9 \\approx 56\\%$）。在这种临床背景下（GDH+和NAAT+），无活动性疾病意味着产毒菌株的定植。高$C_t$值NAAT的低证据强度（$LR^+=1.5$）不足以克服来自毒素EIA的强阴性证据（$LR^- \\approx 0.42$）。\n\n**A. 鉴于细菌载量低（$C_t  30$）和毒素阴性，最可能是产毒性 Clostridioides difficile 菌株定植；推迟抗 Clostridioides difficile 治疗，并通过获取CCNA或使用载量阈值（例如，仅在 $C_t \\le 26$ 或临床严重程度增加时治疗）来解决不确定性。**\n- **解释**：“最可能是定植”这一说法与我们发现的活动性疾病概率低于$50\\%$的结果一致。所提供的理由（高$C_t$值导致的低载量和毒素阴性）准确地指出了这一结论的关键驱动因素。\n- **处理**：提议的计划——推迟治疗并寻求更多信息——是处理中等概率结果的标准方法。解决不确定性的方法是合理的：使用金标准检测（CCNA），采用更严格、有证据支持的治疗阈值（例如，更低的$C_t$），或监测患者的临床状态。这代表了卓越的临床和科学推理。\n- **结论**：**正确**。\n\n**B. 最可能是活动性 Clostridioides difficile 感染，因为任何NAAT阳性都可确诊疾病；立即开始口服 vancomycin，并且不进行进一步的检测或使用阈值。**\n- **解释**：“最可能是活动性...感染”在数量上是错误的；计算出的概率是$44\\%$。\n- **理由**：“任何NAAT阳性都可确诊疾病”这一说法是一个关键错误。它忽略了定植这一重要问题，并与问题自身的数据相矛盾，该数据根据$C_t$值对NAAT结果进行了分层。将NAAT视为一个简单的二元检测是一个已知的陷阱。\n- **结论**：**不正确**。\n\n**C. NAAT很可能是假阳性；忽略GDH和NAAT，仅依赖毒素EIA，即使症状持续也避免治疗。**\n- **解释**：NAAT很可能是毒素基因存在的真阳性，这与分析意义上的“假阳性”不同。该结果对于疾病是“假阳性”，但对于基因不是。主张“忽略GDH和NAAT”是不科学的；综合方法更为优越。\n- **处理**：“即使症状持续也避免治疗”的建议在临床上是危险且不可接受的。临床状况恶化总是需要重新考虑诊断和治疗计划。\n- **结论**：**不正确**。\n\n**D. 立即使用 fidaxomicin 进行经验性治疗并重复NAAT；如果重复的NAAT仍为阳性，则无论$C_t$值、毒素EIA或临床轨迹如何，都继续治疗。**\n- **解释**：$44\\%$的验后概率不支持立即治疗。\n- **处理**：不建议使用重复NAAT作为CDI的“治愈检测”。该检测在临床缓解后数周内仍可保持阳性，并不能可靠地指示治疗失败。做出“不考虑...临床轨迹”的治疗决策是严重的医疗错误。\n- **结论**：**不正确**。\n\n**E. 最可能是定植；然而，当 $C_t \\le 35$ 时应开始治疗，因为该阈值无需额外检测即可可靠地区分疾病与定植。**\n- **解释**：“最可能是定植”是一个正确的评估。\n- **处理**：提议的阈值（$C_t \\le 35$）将导致治疗该患者（$C_t=33$）。然而，问题中关于$C_t  30$的数据给出的$LR^+$仅为$1.5$，表明该范围为疾病提供了非常弱的证据。因此，$35$的阈值不可能是“可靠的”，因为它对活动性感染的特异性会更低。其可靠性的说法是一个很强的断言，但并未得到所提供数据或该领域普遍共识的支持。\n- **结论**：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "4816255"}, {"introduction": "有效的感染控制策略需要严格的量化评估。这项练习将您的视角从单个患者的管理提升到整个医院层面的感染预防。您将构建一个描述环境污染动态变化的数学模型，并结合流行病学中的双重差分法（Difference-in-Differences），来精确量化一项高级消毒干预措施相比于标准清洁流程所能带来的额外益处。这个实践展示了如何运用定量推理来评估和支持医疗机构中的公共卫生政策[@problem_id:4634749]。", "problem": "考虑一个医院病房，其中与艰难梭菌感染相关的环境污染水平在清洁事件之间根据线性质量平衡模型演变。设 $C(t)$ 表示时间 $t$（单位为天）时的污染水平（任意单位）。在两次清洁之间，污染以恒定速率 $s$（单位/天）因脱落而累积，并以速率 $\\delta$（/天）因自然衰减而被清除，因此其演变由常微分方程 $dC/dt = s - \\delta C$ 控制。在以固定间隔 $\\tau$（单位为天）分隔的预定清洁时间点，污染水平会瞬时减少一个比例 $\\varepsilon$（无量纲，且 $0 \\le \\varepsilon \\le 1$），因此清洁后，$C$ 立即变为 $(1 - \\varepsilon) \\times C$。\n\n假设每患者日的艰难梭菌感染的患者层面风险（发病率）与一个清洁周期内的平均污染水平成正比。具体来说，发病率为 $\\lambda = \\beta \\times \\overline{C}$，其中 $\\beta$（单位为 感染/（污染单位·天））是一个比例常数，$\\overline{C}$ 是稳态下一个周期内 $C(t)$ 的平均值。假设在后期对干预组病房实施了净化干预（紫外线-C (UVC) 或过氧化氢蒸汽 (HPV)），通过将清洁清除比例从 $\\varepsilon_{\\mathrm{s}}$（标准清洁）更改为 $\\varepsilon_{\\mathrm{i}}$（干预清洁），而对照组病房则继续使用 $\\varepsilon_{\\mathrm{s}}$。设一个在后期对两组均有影响的长期趋势变化由作用于发病率的乘法因子 $\\theta$ 表示。前期的因子为 $1$。\n\n使用双重差分法原理，将相对于标准清洁的干预所带来的增量效益（每患者日避免的感染数）定义为发病率的双重差分估计值的负数，即 $B = -\\Delta$，其中 $\\Delta = (\\lambda_{\\mathrm{T,post}} - \\lambda_{\\mathrm{T,pre}}) - (\\lambda_{\\mathrm{C,post}} - \\lambda_{\\mathrm{C,pre}})$，$\\mathrm{T}$ 表示干预组，$\\mathrm{C}$ 表示对照组。请以每 $10{,}000$ 患者日避免的感染数来表示最终的增量效益，结果为小数。\n\n您的任务是：\n- 从给定的动力学定律 $dC/dt = s - \\delta C$ 和瞬时清洁减少规则出发，推导在给定清除比例 $\\varepsilon$ 以及参数 $s$ 和 $\\delta$ 的情况下，一个长度为 $\\tau$ 的周期内的稳态平均污染水平 $\\overline{C}$。\n- 使用发病率定义 $\\lambda = \\beta \\overline{C}$ 和双重差分结构，为每组参数计算 $B$。\n- 对于每个测试用例，输出增量效益 $B \\times 10{,}000$（每 $10{,}000$ 患者日避免的感染数），结果为浮点数，并四舍五入到六位小数。\n\n使用以下测试套件（每个用例是一个元组 $(s, \\delta, \\tau, \\beta, \\varepsilon_{\\mathrm{s}}, \\varepsilon_{\\mathrm{i}}, \\theta)$）：\n- 用例 1：$(50, 1.0, 1.0, 0.0004, 0.5, 0.9, 0.9)$。\n- 用例 2：$(50, 1.0, 1.0, 0.0004, 0.5, 0.99, 0.9)$。\n- 用例 3：$(50, 5.0, 1.0, 0.0004, 0.5, 0.9, 0.9)$。\n- 用例 4：$(50, 1.0, 2.0, 0.0004, 0.5, 0.9, 0.9)$。\n- 用例 5：$(50, 1.0, 1.0, 0.0004, 0.5, 0.5, 1.0)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是相应测试用例计算出的浮点数，并四舍五入到六位小数。", "solution": "该问题被评估为有效的，因为它具有科学依据、提法恰当，并包含获得唯一解所需的所有信息。\n\n求解过程分三步进行：\n1.  推导单个清洁周期内的稳态污染水平 $C(t)$。\n2.  计算平均稳态污染水平 $\\overline{C}$。\n3.  应用双重差分 (DiD) 框架来计算增量效益 $B$。\n\n### 第 1 步：稳态污染周期\n\n环境污染水平 $C(t)$ 在清洁事件之间的演变由以下线性一阶常微分方程控制：\n$$\n\\frac{dC}{dt} = s - \\delta C\n$$\n这可以重写为 $\\frac{dC}{dt} + \\delta C = s$。该方程的通解为：\n$$\nC(t) = \\frac{s}{\\delta} + K e^{-\\delta t}\n$$\n其中 $K$ 是一个积分常数。\n\n让我们考虑一个持续时间为 $\\tau$ 的单个清洁周期，从 $t=0$ 时刻（紧随一次清洁事件之后）开始。设 $C_0$ 为 $t=0$ 时的污染水平。\n使用初始条件 $C(0) = C_0$，我们可以解出 $K$：\n$$\nC_0 = \\frac{s}{\\delta} + K e^0 \\implies K = C_0 - \\frac{s}{\\delta}\n$$\n因此，在周期 $[0, \\tau)$ 内的污染水平为：\n$$\nC(t) = \\frac{s}{\\delta} + \\left(C_0 - \\frac{s}{\\delta}\\right) e^{-\\delta t}\n$$\n在周期结束时，即下一次清洁发生前的 $t=\\tau$ 时刻，污染水平达到：\n$$\nC(\\tau^-) = \\frac{s}{\\delta} + \\left(C_0 - \\frac{s}{\\delta}\\right) e^{-\\delta \\tau}\n$$\n清洁过程将此水平降低一个比例 $\\varepsilon$。清洁后瞬间的水平是：\n$$\nC(\\tau^+) = (1 - \\varepsilon) C(\\tau^-) = (1 - \\varepsilon) \\left[ \\frac{s}{\\delta} + \\left(C_0 - \\frac{s}{\\delta}\\right) e^{-\\delta \\tau} \\right]\n$$\n在稳态周期中，每个周期开始时的污染水平是相同的。因此，我们必须有 $C(\\tau^+) = C(0) = C_0$。\n$$\nC_0 = (1 - \\varepsilon) \\left[ \\frac{s}{\\delta} + \\left(C_0 - \\frac{s}{\\delta}\\right) e^{-\\delta \\tau} \\right]\n$$\n对该方程求解 $C_0$：\n$$\nC_0 = (1 - \\varepsilon)\\frac{s}{\\delta} + (1 - \\varepsilon)C_0 e^{-\\delta \\tau} - (1 - \\varepsilon)\\frac{s}{\\delta} e^{-\\delta \\tau}\n$$\n$$\nC_0 \\left(1 - (1 - \\varepsilon)e^{-\\delta \\tau}\\right) = \\frac{s}{\\delta} (1 - \\varepsilon) (1 - e^{-\\delta \\tau})\n$$\n$$\nC_0 = \\frac{s}{\\delta} \\frac{(1 - \\varepsilon)(1 - e^{-\\delta \\tau})}{1 - (1 - \\varepsilon)e^{-\\delta \\tau}}\n$$\n这是每次清洁事件后瞬间的稳态污染水平。\n\n### 第 2 步：平均稳态污染 $\\overline{C}$\n\n一个周期内的平均污染水平定义为 $\\overline{C} = \\frac{1}{\\tau} \\int_0^{\\tau} C(t) \\,dt$。\n$$\n\\overline{C} = \\frac{1}{\\tau} \\int_0^{\\tau} \\left[ \\frac{s}{\\delta} + \\left(C_0 - \\frac{s}{\\delta}\\right) e^{-\\delta t} \\right] dt\n$$\n$$\n\\overline{C} = \\frac{1}{\\tau} \\left[ \\frac{s}{\\delta}t - \\frac{1}{\\delta}\\left(C_0 - \\frac{s}{\\delta}\\right) e^{-\\delta t} \\right]_0^{\\tau}\n$$\n$$\n\\overline{C} = \\frac{1}{\\tau} \\left[ \\left(\\frac{s\\tau}{\\delta} - \\frac{1}{\\delta}\\left(C_0 - \\frac{s}{\\delta}\\right) e^{-\\delta \\tau}\\right) - \\left(0 - \\frac{1}{\\delta}\\left(C_0 - \\frac{s}{\\delta}\\right)\\right) \\right]\n$$\n$$\n\\overline{C} = \\frac{s}{\\delta} + \\frac{1}{\\delta \\tau}\\left(C_0 - \\frac{s}{\\delta}\\right)(1 - e^{-\\delta \\tau})\n$$\n为简化此式，我们首先求出项 $(C_0 - s/\\delta)$ 的表达式：\n$$\nC_0 - \\frac{s}{\\delta} = \\frac{s}{\\delta} \\frac{(1 - \\varepsilon)(1 - e^{-\\delta \\tau})}{1 - (1 - \\varepsilon)e^{-\\delta \\tau}} - \\frac{s}{\\delta} = \\frac{s}{\\delta} \\left[ \\frac{(1 - \\varepsilon)(1 - e^{-\\delta \\tau}) - (1 - (1 - \\varepsilon)e^{-\\delta \\tau})}{1 - (1 - \\varepsilon)e^{-\\delta \\tau}} \\right]\n$$\n$$\nC_0 - \\frac{s}{\\delta} = \\frac{s}{\\delta} \\left[ \\frac{1 - e^{-\\delta \\tau} - \\varepsilon + \\varepsilon e^{-\\delta \\tau} - 1 + e^{-\\delta \\tau} - \\varepsilon e^{-\\delta \\tau}}{1 - (1 - \\varepsilon)e^{-\\delta \\tau}} \\right] = \\frac{s}{\\delta} \\left[ \\frac{-\\varepsilon}{1 - (1 - \\varepsilon)e^{-\\delta \\tau}} \\right]\n$$\n将此结果代回 $\\overline{C}$ 的表达式中：\n$$\n\\overline{C}(\\varepsilon) = \\frac{s}{\\delta} + \\frac{1}{\\delta \\tau} \\left( \\frac{s}{\\delta} \\frac{-\\varepsilon}{1 - (1 - \\varepsilon)e^{-\\delta \\tau}} \\right) (1 - e^{-\\delta \\tau})\n$$\n$$\n\\overline{C}(\\varepsilon) = \\frac{s}{\\delta} \\left[ 1 - \\frac{\\varepsilon(1 - e^{-\\delta \\tau})}{\\delta \\tau (1 - (1 - \\varepsilon)e^{-\\delta \\tau})} \\right]\n$$\n该表达式给出了作为清洁效率 $\\varepsilon$ 函数的平均稳态污染，其中其他模型参数是固定的。\n\n### 第 3 步：双重差分计算\n\n发病率 $\\lambda$ 与平均污染水平成正比，即 $\\lambda = \\beta \\overline{C}$，并且在后期受长期趋势因子 $\\theta$ 的影响（前期 $\\theta=1$）。我们为四个组定义发病率：\n- 对照组，前期： $\\lambda_{\\mathrm{C,pre}} = \\beta \\overline{C}(\\varepsilon_{\\mathrm{s}})$\n- 对照组，后期： $\\lambda_{\\mathrm{C,post}} = \\theta \\beta \\overline{C}(\\varepsilon_{\\mathrm{s}})$\n- 干预组，前期： $\\lambda_{\\mathrm{T,pre}} = \\beta \\overline{C}(\\varepsilon_{\\mathrm{s}})$\n- 干预组，后期： $\\lambda_{\\mathrm{T,post}} = \\theta \\beta \\overline{C}(\\varepsilon_{\\mathrm{i}})$\n\nDiD 估计量 $\\Delta$ 定义为：\n$$\n\\Delta = (\\lambda_{\\mathrm{T,post}} - \\lambda_{\\mathrm{T,pre}}) - (\\lambda_{\\mathrm{C,post}} - \\lambda_{\\mathrm{C,pre}})\n$$\n代入发病率的表达式：\n$$\n\\Delta = (\\theta \\beta \\overline{C}(\\varepsilon_{\\mathrm{i}}) - \\beta \\overline{C}(\\varepsilon_{\\mathrm{s}})) - (\\theta \\beta \\overline{C}(\\varepsilon_{\\mathrm{s}}) - \\beta \\overline{C}(\\varepsilon_{\\mathrm{s}}))\n$$\n$$\n\\Delta = \\theta \\beta \\overline{C}(\\varepsilon_{\\mathrm{i}}) - \\theta \\beta \\overline{C}(\\varepsilon_{\\mathrm{s}}) = \\theta \\beta (\\overline{C}(\\varepsilon_{\\mathrm{i}}) - \\overline{C}(\\varepsilon_{\\mathrm{s}}))\n$$\n增量效益 $B$ 是 DiD 估计值的负数：\n$$\nB = -\\Delta = - \\theta \\beta (\\overline{C}(\\varepsilon_{\\mathrm{i}}) - \\overline{C}(\\varepsilon_{\\mathrm{s}})) = \\theta \\beta (\\overline{C}(\\varepsilon_{\\mathrm{s}}) - \\overline{C}(\\varepsilon_{\\mathrm{i}}))\n$$\n期望的输出是每 $10,000$ 患者日的效益，即 $B \\times 10,000$。\n使用推导出的 $\\overline{C}(\\varepsilon)$ 公式，每个测试用例最终需要计算的量是：\n$$\n10,000 \\times \\theta \\beta \\left( \\overline{C}(\\varepsilon_{\\mathrm{s}}) - \\overline{C}(\\varepsilon_{\\mathrm{i}}) \\right)\n$$\n其中 $\\overline{C}(\\varepsilon_{\\mathrm{s}})$ 和 $\\overline{C}(\\varepsilon_{\\mathrm{i}})$ 使用第 2 步中推导的公式计算。", "answer": "[36.599401,40.528409,3.659648,48.243545,0.0]", "id": "4634749"}]}