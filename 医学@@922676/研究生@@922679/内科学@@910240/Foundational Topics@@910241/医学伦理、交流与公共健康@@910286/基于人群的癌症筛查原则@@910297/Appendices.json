{"hands_on_practices": [{"introduction": "阳性预测值（$PPV$）和阴性预测值（$NPV$）是指导临床决策和患者沟通的核心指标。与检测固有的灵敏度（$Se$）和特异性（$Sp$）不同，预测值会受到疾病患病率（$\\pi$）的显著影响。本练习 ([@problem_id:4889589]) 将通过从第一性原理出发推导这些值，帮助您深刻理解在低患病率人群中进行筛查的数学现实及其对临床的启示。", "problem": "一个公共卫生系统正在考虑针对平均风险的成年人群，采用单步检测法对一种无症状癌症进行基于人群的筛查项目。该检测的特性已在大型验证队列中确立，其灵敏度$Se=0.90$，特异度$Sp=0.95$。目标人群的疾病患病率$\\pi=0.01$。请从灵敏度、特异度、患病率和条件概率的基本定义出发，不使用任何预先记忆的快捷公式，推导出阳性预测值$PPV$和阴性预测值$NPV$关于$Se$、$Sp$和$\\pi$的表达式，然后根据给定参数计算它们的数值。最后，解释$PPV$和$NPV$的量值应如何指导患者咨询以及在真实世界的筛查项目中下游确诊性诊断的预期使用。\n\n将$PPV$和$NPV$以小数形式报告，并四舍五入到四位有效数字。在最终答案中，将两个数字以行矩阵$(PPV,\\,NPV)$的形式呈现。", "solution": "在尝试解答之前，对问题陈述的有效性进行评估。\n\n### 第1步：提取已知条件\n-   检测的灵敏度：$Se = 0.90$\n-   检测的特异度：$Sp = 0.95$\n-   目标人群中的疾病患病率：$\\pi = 0.01$\n-   任务1：从基本定义推导阳性预测值（$PPV$）和阴性预测值（$NPV$）的表达式。\n-   任务2：计算$PPV$和$NPV$的数值。\n-   任务3：解释计算出的$PPV$和$NPV$值对于患者咨询和下游诊断规划的意义。\n-   取整说明：将$PPV$和$NPV$以小数形式报告，并四舍五入到四位有效数字。\n-   最终答案格式：行矩阵$(\\text{PPV}, \\text{NPV})$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于概率论的基本原理（特别是贝叶斯定理）在流行病学和医学诊断学中的应用。灵敏度、特异度、患病率、$PPV$和$NPV$的概念是医学和公共卫生领域标准的、定义明确的指标。所提供的数值对于一种低患病率疾病的筛查检测是符合实际的。\n-   **适定性**：问题陈述清晰，提供了推导所需表达式和计算数值的全部必要信息。存在唯一、稳定且有意义的解。\n-   **客观性**：问题使用了精确、标准和无偏见的术语。不含主观或基于观点的陈述。\n\n### 第3步：结论与行动\n该问题具有科学依据、适定性好且客观。它不包含矛盾、歧义或无效前提。因此，该问题是**有效的**。将提供完整解答。\n\n### 解题推导\n\n我们首先根据所提供的信息，正式定义事件和概率。\n设$D$为从人群中抽出的个体患有该疾病（癌症）的事件，而$D^c$为该个体未患该疾病的事件。\n设$T^+$为检测结果为阳性的事件，而$T^-$为检测结果为阴性的事件。\n\n根据问题陈述，我们可以将给定的参数转化为条件概率：\n1.  **患病率（$\\pi$）**：随机选择的个体患有该疾病的先验概率。\n    $$P(D) = \\pi = 0.01$$\n    因此，不患该疾病的概率为：\n    $$P(D^c) = 1 - P(D) = 1 - \\pi = 1 - 0.01 = 0.99$$\n\n2.  **灵敏度（$Se$）**：在个体患有该疾病的条件下，检测结果为阳性的概率。这是真阳性率。\n    $$Se = P(T^+ | D) = 0.90$$\n\n3.  **特异度（$Sp$）**：在个体未患该疾病的条件下，检测结果为阴性的概率。这是真阴性率。\n    $$Sp = P(T^- | D^c) = 0.95$$\n\n从这些定义中，我们也可以定义互补概率：\n-   假阴性率（FNR），即患病个体检测结果为阴性的概率，是：\n    $$P(T^- | D) = 1 - P(T^+ | D) = 1 - Se$$\n-   假阳性率（FPR），即无病个体检测结果为阳性的概率，是：\n    $$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp$$\n\n我们的目标是推导阳性预测值（$PPV$）和阴性预测值（$NPV$）的表达式。\n\n**1. 阳性预测值（$PPV$）的推导**\n$PPV$是在个体收到阳性检测结果的条件下，其确实患有该疾病的概率。形式上，这是条件概率$P(D | T^+)$。\n根据条件概率的定义（贝叶斯定理）：\n$$PPV = P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)}$$\n分子表示同时患有疾病且检测结果为阳性的联合概率。它可以表示为：\n$$P(D \\cap T^+) = P(T^+ | D) P(D) = Se \\cdot \\pi$$\n分母$P(T^+)$是在人群中收到阳性检测结果的总概率。我们使用全概率定律，对两种互斥状态（患病或不患病）进行求和来计算此值：\n$$P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)$$\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n代入已知项：\n$$P(T^+) = (Se \\cdot \\pi) + ((1 - Sp) \\cdot (1 - \\pi))$$\n现在，我们可以组合成$PPV$的最终表达式：\n$$PPV = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)} = \\frac{Se \\cdot \\pi}{(Se \\cdot \\pi) + ((1 - Sp) \\cdot (1 - \\pi))}$$\n\n**2. 阴性预测值（$NPV$）的推导**\n$NPV$是在个体收到阴性检测结果的条件下，其确实未患该疾病的概率。形式上，这是条件概率$P(D^c | T^-)$。\n根据条件概率的定义：\n$$NPV = P(D^c | T^-) = \\frac{P(D^c \\cap T^-)}{P(T^-)}$$\n分子是同时未患疾病且检测结果为阴性的联合概率：\n$$P(D^c \\cap T^-) = P(T^- | D^c) P(D^c) = Sp \\cdot (1 - \\pi)$$\n分母$P(T^-)$是收到阴性检测结果的总概率。使用全概率定律：\n$$P(T^-) = P(T^- \\cap D^c) + P(T^- \\cap D)$$\n$$P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)$$\n代入已知项：\n$$P(T^-) = (Sp \\cdot (1 - \\pi)) + ((1 - Se) \\cdot \\pi)$$\n组合成$NPV$的最终表达式：\n$$NPV = \\frac{P(T^- | D^c) P(D^c)}{P(T^- | D^c) P(D^c) + P(T^- | D) P(D)} = \\frac{Sp \\cdot (1 - \\pi)}{(Sp \\cdot (1 - \\pi)) + ((1 - Se) \\cdot \\pi)}$$\n\n### 数值计算\n现在我们代入给定值：$Se=0.90$，$Sp=0.95$，以及$\\pi=0.01$。\n\n**$PPV$的计算：**\n$$PPV = \\frac{0.90 \\cdot 0.01}{(0.90 \\cdot 0.01) + ((1 - 0.95) \\cdot (1 - 0.01))}$$\n$$PPV = \\frac{0.009}{(0.009) + (0.05 \\cdot 0.99)}$$\n$$PPV = \\frac{0.009}{0.009 + 0.0495}$$\n$$PPV = \\frac{0.009}{0.0585} \\approx 0.15384615...$$\n四舍五入到四位有效数字，$PPV = 0.1538$。\n\n**$NPV$的计算：**\n$$NPV = \\frac{0.95 \\cdot (1 - 0.01)}{(0.95 \\cdot (1 - 0.01)) + ((1 - 0.90) \\cdot 0.01)}$$\n$$NPV = \\frac{0.95 \\cdot 0.99}{(0.95 \\cdot 0.99) + (0.10 \\cdot 0.01)}$$\n$$NPV = \\frac{0.9405}{0.9405 + 0.001}$$\n$$NPV = \\frac{0.9405}{0.9415} \\approx 0.99893786...$$\n四舍五入到四位有效数字，$NPV = 0.9989$。\n\n### 解释\n计算出的$PPV$和$NPV$值对临床实践具有深远影响。\n\n-   **阳性预测值（$PPV \\approx 0.1538$）：** $PPV$值惊人地低。这表示，对于来自这个平均风险人群中收到阳性筛查结果的个体，他们实际患有癌症的概率仅约为$15.4\\%$。反过来说，该阳性结果为假阳性的可能性约为$84.6\\%$。这种现象是将一个特异度不完美的检测应用于一个低疾病患病率人群的直接数学结果。\n    -   **患者咨询：** 临床医生必须向患者解释，阳性筛查结果并非诊断，而是一种风险分层工具。应告知患者，虽然他们现在的风险高于一般人群，但他们没有患癌症的可能性仍然要大得多。这种沟通对于管理患者焦虑和确保其依从后续随访至关重要。\n    -   **下游诊断：** 低$PPV$意味着需要进行大量的确诊性诊断程序（例如，活检、更先进的影像学检查）。具体而言，阳性筛查与真阳性病例的比率是$1/PPV \\approx 1/0.1538 \\approx 6.5$。每$6.5$个被送去做确诊性检测的个体中，只有$1$个会被发现患有该疾病。卫生系统必须具备足够的能力和资源来管理这部分实际上无病个体所需的大量后续检测负担。\n\n-   **阴性预测值（$NPV \\approx 0.9989$）：** $NPV$值极高，接近$1$。这表明，对于收到阴性检测结果的个体，他们确实未患该疾病的概率约为$99.9\\%$。\n    -   **患者咨询：** 阴性结果非常令人放心。临床医生可以自信地告知患者，他们患有该癌症的可能性极低。可以建议患者按照其风险状况，回归标准的筛查间隔。\n    -   **下游诊断：** 阴性结果有效地排除了被筛查个体患有该疾病的可能性。基于此检测结果，无需进行进一步的即时诊断检查，这为绝大多数被筛查人群避免了不必要的程序和成本。\n\n总之，对于一种低患病率的疾病，有效的筛查检测必须具有非常高的$NPV$以提供保障，但即使具有良好的灵敏度和特异度，其$PPV$也可能很低。这就要求进行仔细的患者沟通，并为确诊性诊断制定稳健的计划。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1538  0.9989 \\end{pmatrix}}\n$$", "id": "4889589"}, {"introduction": "评估筛查项目在人群层面的有效性，需要超越单个测试的性能指标。绝对风险降低（$ARR$）和相对风险（$RR$）是衡量筛查干预措施真实效果的关键流行病学指标。通过这项练习 ([@problem_id:4889573])，您将学会区分并计算这两个重要概念，从而更准确地解读筛查研究的结局。", "problem": "一项全国性的、基于人群的、使用粪便免疫化学检测的结直肠癌筛查项目，报告了在两个基线风险相同且随访完整的队列中，经过一个固定的、等长的随访期后的结果：一个筛查队列和一个同期的、未接受筛查的对照队列。感兴趣的事件是在随访期内因结直肠癌死亡。在同一时期内测得的，该事件的观测累积发病率（发病比例）在筛查队列中为 $5/1000$，在对照队列中为 $6.25/1000$。\n\n从用于评估筛查项目的核心流行病学定义出发，用风险来简要定义绝对风险降低（ARR）和相对风险（RR）。然后，使用这些定义，为上述数据计算这两个量，并明确地将报告的事件计数视为风险（累积发病率），因为随访是完整的且等长的。请将您的答案表示为无单位的小数（而不是分数或百分比），将每个答案四舍五入到四位有效数字，并按 $\\text{ARR}$ 然后 $\\text{RR}$ 的顺序将最终答案表示为一个行矩阵。", "solution": "问题陈述被认为是有效的。它在科学上基于既定的流行病学原理，问题提出得当，提供了所有必要信息，并且语言客观。数据对于一项基于人群的筛查研究来说是合理的。因此，我们可以着手解决。\n\n问题要求根据一个癌症筛查项目提供的累积发病率数据，给出绝对风险降低（ARR）和相对风险（RR）的定义并进行计算。\n\n设 $R_{\\text{screened}}$ 为筛查队列中感兴趣事件（因结直肠癌死亡）的风险（累积发病率）。\n设 $R_{\\text{control}}$ 为未筛查的对照队列中该事件的风险。\n\n根据问题陈述，我们已知：\n$$R_{\\text{screened}} = \\frac{5}{1000} = 0.005$$\n$$R_{\\text{control}} = \\frac{6.25}{1000} = 0.00625$$\n问题指明，由于两个队列的随访是完整的且长度相等，因此观测到的累积发病率可以为这些计算直接视为风险。\n\n首先，我们用这些风险来定义所需的流行病学指标。\n\n**绝对风险降低 (ARR)**\n绝对风险降低，也称为风险差，衡量的是对照组与干预（筛查）组之间风险的绝对差异。它量化了与对照组相比，筛查组中不良事件发生概率的实际降低程度。正的ARR表示筛查与较低的结果风险相关。其定义为：\n$$ARR = R_{\\text{control}} - R_{\\text{screened}}$$\n\n**相对风险 (RR)**\n相对风险，也称为风险比，是干预（筛查）组中事件风险与对照组中风险的比值。它表明了筛查相对于对照组基线风险的效果大小。小于 $1$ 的相对风险表明筛查具有保护作用。其定义为：\n$$RR = \\frac{R_{\\text{screened}}}{R_{\\text{control}}}$$\n\n现在，我们使用给定的数据计算ARR和RR的数值。\n\n**ARR的计算**\n将给定的风险值代入ARR的定义中：\n$$ARR = 0.00625 - 0.005 = 0.00125$$\n问题要求将此答案四舍五入到四位有效数字。数字 $0.00125$ 有三位有效数字（$1$、$2$、$5$）。为了用四位有效数字表示它，我们在末尾添加一个零：\n$$ARR \\approx 0.001250$$\n\n**RR的计算**\n将给定的风险值代入RR的定义中：\n$$RR = \\frac{0.005}{0.00625}$$\n为了简化分数，我们可以将其写为：\n$$RR = \\frac{5 \\times 10^{-3}}{6.25 \\times 10^{-3}} = \\frac{5}{6.25} = \\frac{500}{625}$$\n将分子和分母同时除以它们的最大公约数 $125$：\n$$RR = \\frac{500 \\div 125}{625 \\div 125} = \\frac{4}{5} = 0.8$$\n问题要求将此答案四舍五入到四位有效数字。数字 $0.8$ 有一位有效数字。为了用四位有效数字表示它，我们在末尾添加三个零：\n$$RR \\approx 0.8000$$\n\n最终答案应以 [ARR, RR] 的顺序表示为一个行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.001250  0.8000\n\\end{pmatrix}\n}\n$$", "id": "4889573"}, {"introduction": "任何筛查项目都伴随着潜在的危害，其中假阳性结果是最常见的一种。对于需要定期重复进行的筛查，假阳性的风险会随着时间累积，对个人和医疗系统造成持续的负担。本练习 ([@problem_id:4889536]) 旨在通过数学建模，量化在多轮筛查中遭遇至少一次假阳性结果的累积概率，从而深化对筛查长期影响的认识。", "problem": "一项国家计划对基线时无乳腺癌的女性队列实施年度乳腺X线摄影筛查。为减少假阳性检测结果造成的总体伤害，该计划根据入组前的风险评估和研究中心的能力，将参与者分层为两个互斥的方案组。比例为 $w = 0.7$ 的参与者接受标准方案，其单次筛查假阳性概率为 $p_{1} = 0.10$；剩余比例为 $1-w = 0.3$ 的参与者接受高特异性方案，其单次筛查假阳性概率为 $p_{2} = 0.05$。每位参与者在一个固定的时间范围内被安排进行 $n = 10$ 轮独立的年度筛查。假设以方案组为条件，每轮的假阳性概率在各轮次间保持不变，且对于同一个体，各轮次的假阳性结果是相互独立的。同时假设在此时间范围内没有新发癌症（因此本次建模练习中的所有阳性结果均为假阳性），并忽略失访和死亡率。\n\n仅使用概率的补集法则和各轮次间的独立性，从第一性原理推导出一个解析表达式，用于表示随机选择的一名参与者在 $n$ 轮筛查中经历至少一次假阳性结果的人群平均累积概率，然后根据给定的参数值 $w$、$p_{1}$、$p_{2}$ 和 $n$ 对该表达式进行数值计算。将最终答案表示为无单位的小数。将您的答案四舍五入至四位有效数字。", "solution": "该问题要求推导一个解析表达式，用于表示随机选择的一名参与者在 $n$ 轮筛查中经历至少一次假阳性结果的人群平均累积概率，然后对该表达式进行数值计算。解法必须从第一性原理出发，使用补集法则和独立性进行推导。\n\n首先，我们根据问题陈述定义相关事件和参数。\n参与者群体被分层为两个互斥的组：\n- 第1组：标准方案组。比例为 $w$ 的参与者属于此组。\n- 第2组：高特异性方案组。比例为 $1-w$ 的参与者属于此组。\n\n参数如下：\n- $w = 0.7$：第1组参与者的比例。\n- $1-w = 0.3$：第2组参与者的比例。\n- $p_1 = 0.10$：第1组的单次筛查假阳性概率。\n- $p_2 = 0.05$：第2组的单次筛查假阳性概率。\n- $n = 10$：独立的年度筛查轮次数。\n\n令 $A$ 为随机选择的一名参与者在 $n$ 轮筛查中经历至少一次假阳性结果的事件。我们要求该事件的概率 $P(A)$。\n令 $G_1$ 为随机选择的参与者属于第1组的事件，$G_2$ 为该参与者属于第2组的事件。根据问题陈述，我们有：\n$$P(G_1) = w$$\n$$P(G_2) = 1 - w$$\n\n由于 $G_1$ 和 $G_2$ 构成了样本空间的一个划分（它们是互斥且穷尽的），我们可以使用全概率定律来求 $P(A)$：\n$$P(A) = P(A|G_1) P(G_1) + P(A|G_2) P(G_2)$$\n其中 $P(A|G_1)$ 是在参与者属于第1组的条件下事件 $A$ 发生的条件概率，$P(A|G_2)$ 是在参与者属于第2组的条件下事件 $A$ 发生的条件概率。\n\n问题要求我们使用补集法则。令 $A^c$ 为事件 $A$ 的补事件。$A^c$ 是指参与者在所有 $n$ 轮筛查中经历*零*次假阳性结果的事件。概率之间的关系是：\n$$P(A|G_i) = 1 - P(A^c|G_i) \\quad \\text{for } i \\in \\{1, 2\\}$$\n\n我们来计算 $P(A^c|G_1)$。这是在参与者属于第1组的条件下，在 $n$ 轮筛查中没有假阳性结果的概率。对于第1组中的人，在任何单次筛查中出现假阳性的概率是 $p_1$。因此，在单次筛查中*不*出现假阳性（即结果为阴性）的概率是 $1 - p_1$。由于 $n$ 轮筛查的结果是独立的，所以在所有 $n$ 轮中都没有假阳性的概率是每轮结果为阴性的概率的乘积：\n$$P(A^c|G_1) = (1 - p_1) \\times (1 - p_1) \\times \\dots \\times (1 - p_1) = (1 - p_1)^n$$\n使用补集法则，第1组参与者经历至少一次假阳性的概率是：\n$$P(A|G_1) = 1 - (1 - p_1)^n$$\n\n类似地，对于第2组的参与者，每轮的假阳性概率是 $p_2$。在单次筛查中结果为阴性的概率是 $1 - p_2$。由于各轮次间的独立性，在 $n$ 轮中都没有假阳性的概率是：\n$$P(A^c|G_2) = (1 - p_2)^n$$\n所以，第2组参与者经历至少一次假阳性的概率是：\n$$P(A|G_2) = 1 - (1 - p_2)^n$$\n\n现在，我们将这些条件概率代回到全概率定律方程中。这就得出了我们所求的、至少一次假阳性的人群平均累积概率的解析表达式：\n$$P(A) = \\left[1 - (1 - p_1)^n\\right] w + \\left[1 - (1 - p_2)^n\\right] (1 - w)$$\n\n最后一步是使用给定的参数值 $w = 0.7$、$p_1 = 0.10$、$p_2 = 0.05$ 和 $n = 10$ 对该表达式进行数值计算。\n代入数值：\n$$P(A) = \\left[1 - (1 - 0.10)^{10}\\right] (0.7) + \\left[1 - (1 - 0.05)^{10}\\right] (1 - 0.7)$$\n$$P(A) = \\left[1 - (0.90)^{10}\\right] (0.7) + \\left[1 - (0.95)^{10}\\right] (0.3)$$\n首先，我们计算指数项的值：\n$$(0.90)^{10} \\approx 0.34867844$$\n$$(0.95)^{10} \\approx 0.59873694$$\n接下来，我们计算每个组的概率：\n$$P(A|G_1) = 1 - (0.90)^{10} \\approx 1 - 0.34867844 = 0.65132156$$\n$$P(A|G_2) = 1 - (0.95)^{10} \\approx 1 - 0.59873694 = 0.40126306$$\n最后，我们计算加权平均值：\n$$P(A) \\approx (0.65132156)(0.7) + (0.40126306)(0.3)$$\n$$P(A) \\approx 0.45592509 + 0.12037892$$\n$$P(A) \\approx 0.57630401$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $5$、$7$、$6$ 和 $3$。第五位有效数字是 $0$，所以我们向下舍入（截断）。\n$$P(A) \\approx 0.5763$$", "answer": "$$\n\\boxed{0.5763}\n$$", "id": "4889536"}]}