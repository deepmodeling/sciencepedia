{"hands_on_practices": [{"introduction": "免疫系统的强大适应能力源于其能够产生海量多样性的T细胞受体（TCR）和B细胞受体（BCR）。这种多样性的基础之一是组合多样性，即通过从V、D、J基因片段库中随机挑选并重组来形成功能性受体基因。本练习将引导我们通过一个基础的计算，来估算仅由基因片段组合产生的“初始”免疫组库大小，从而直观地理解免疫多样性的巨大潜力。[@problem_id:5120792]", "problem": "在分子和免疫诊断中，一个靶向高通量测序面板在滤除假基因和非功能性开放阅读框后，可对免疫球蛋白重链 (IGH) 和 T 细胞受体 β 链 (TRB) 的功能性重组基因片段进行计数。在体内，体细胞重组通过选择一个可变 ($V$) 片段、一个多样性 ($D$) 片段和一个连接 ($J$) 片段，形成一个重排的 VDJ 外显子。在本练习中，考虑该测序面板上可用的基因片段的以下科学上切合实际的计数：对于 IGH，有 $37$ 个 $V$ 片段、$21$ 个 $D$ 片段和 $6$ 个 $J$ 片段；对于 TRB，有 $45$ 个 $V$ 片段、$2$ 个 $D$ 片段和 $13$ 个 $J$ 片段。假设每个基因座内片段的选择是独立的，并明确忽略连接区多样性、等位基因排斥、重组信号序列限制和读码框限制，计算两个基因座的总初始组合库大小，其定义为 IGH 上可获得的不同 VDJ 组合总数加上 TRB 上可获得的总数。将最终答案表示为一个不带单位的精确整数。", "solution": "该问题是有效的，因为它科学地基于分子免疫学原理，特别是 V(D)J 重组，并且提出了一个定义明确的组合问题，提供了所有必要的数据和约束条件。\n\n目标是计算免疫球蛋白重链 (IGH) 和 T 细胞受体 β 链 (TRB) 基因座的总初始组合库大小。这被定义为 IGH 的不同 VDJ 组合总数与 TRB 的不同 VDJ 组合总数之和。该计算依赖于计数的基本原理（乘法法则），前提是假设片段选择是独立的。\n\n首先，我们确定 IGH 基因座可能的 VDJ 组合数。设 $N_{V, IGH}$、$N_{D, IGH}$ 和 $N_{J, IGH}$ 分别代表 IGH 可用的功能性可变 ($V$)、多样性 ($D$) 和连接 ($J$) 基因片段的数量。问题提供了以下计数：\n- $N_{V, IGH} = 37$\n- $N_{D, IGH} = 21$\n- $N_{J, IGH} = 6$\n\nIGH 的唯一 VDJ 组合总数，我们记为 $C_{IGH}$，是每种类型可用片段数量的乘积，因为每种类型必须选择一个片段，且选择是独立的。\n$$C_{IGH} = N_{V, IGH} \\times N_{D, IGH} \\times N_{J, IGH}$$\n代入给定值：\n$$C_{IGH} = 37 \\times 21 \\times 6$$\n进行乘法运算：\n$$C_{IGH} = 777 \\times 6 = 4662$$\n因此，IGH 基因座有 $4662$ 种可能的初始 VDJ 组合。\n\n接下来，我们对 TRB 基因座进行相同的计算。设 $N_{V, TRB}$、$N_{D, TRB}$ 和 $N_{J, TRB}$ 代表 TRB 可用的功能性 $V$、$D$ 和 $J$ 基因片段的数量。给出的计数如下：\n- $N_{V, TRB} = 45$\n- $N_{D, TRB} = 2$\n- $N_{J, TRB} = 13$\n\nTRB 的唯一 VDJ 组合总数，记为 $C_{TRB}$，是这些计数的乘积：\n$$C_{TRB} = N_{V, TRB} \\times N_{D, TRB} \\times N_{J, TRB}$$\n代入这些值：\n$$C_{TRB} = 45 \\times 2 \\times 13$$\n进行乘法运算：\n$$C_{TRB} = 90 \\times 13 = 1170$$\n因此，TRB 基因座有 $1170$ 种可能的初始 VDJ 组合。\n\n最后，问题将两个基因座的总初始组合库大小 $C_{total}$ 定义为来自每个基因座的组合之和。这是因为 IGH 和 TRB 库是截然不同的，彼此不发生组合；它们分别代表 B 细胞和 T 细胞的平行可能性集合。\n$$C_{total} = C_{IGH} + C_{TRB}$$\n$$C_{total} = 4662 + 1170$$\n$$C_{total} = 5832$$\n两个基因座的总初始组合库大小为 $5832$。", "answer": "$$\\boxed{5832}$$", "id": "5120792"}, {"introduction": "在通过高通量测序技术来量化免疫组库时，我们测得的克隆频率往往并非其真实比例的完美反映，其中一个主要干扰因素是多重PCR扩增过程中存在的偏好性。本练习模拟了这一常见技术挑战，即不同的V基因由于引物亲和力等差异导致扩增效率不同。通过这个练习，我们将学习如何量化由扩增偏好性导致的观测频率与真实频率之间的偏差，并推导出一个基于逆效率加权的校正方法，这是免疫组库数据分析中的一个关键步骤。[@problem_id:5120814]", "problem": "在T细胞受体（TCR）β链的免疫组库测序中，多重聚合酶链式反应（PCR）通常会引入基因特异性的扩增偏差。考虑一个包含3个TCR V基因的最小系统，分别表示为$V1$、$V2$和$V3$。设这些V基因的真实克隆型频率为 $f = (f_1, f_2, f_3) = \\left(0.5, 0.3, 0.2\\right)$，其中 $\\sum_{i=1}^{3} f_i = 1$。由于引物结合和延伸动力学，每个基因的相对扩增效率为 $e = (e_1, e_2, e_3) = \\left(1.0, 0.8, 1.2\\right)$，这会调节来自V基因 $i$ 的分子产生测序读段的概率。\n\n假设在大样本极限下，每个分子被独立观察到，并且观察到来自基因 $i$ 的分子的概率与乘积 $e_i f_i$ 成正比。在此抽样模型下：\n\n1. 根据第一性原理，用 $f$ 和 $e$ 推导出期望的观测频率分布 $p^{\\mathrm{obs}} = \\left(p^{\\mathrm{obs}}_1, p^{\\mathrm{obs}}_2, p^{\\mathrm{obs}}_3\\right)$。\n\n2. 使用你推导出的 $p^{\\mathrm{obs}}$，计算真实分布与观测分布之间的期望偏差，该偏差由Kullback–Leibler散度 $D_{\\mathrm{KL}}\\!\\left(f \\Vert p^{\\mathrm{obs}}\\right)$ 量化，其中散度使用自然对数定义。将最终数值答案四舍五入至四位有效数字。最终答案以纯数字形式表示，不带单位。\n\n3. 提出一种校正方法，使用带有适当归一化的逆效率加权，从观测频率估计真实频率。以 $p^{\\mathrm{obs}}$ 和 $e$ 的函数形式，符号化地提供你的估计量。\n\n最终答案仅要求提供第2项的数值。", "solution": "用户希望我解决一个关于免疫组库测序偏差的多部分问题。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 一个包含3个TCR V基因的最小系统，分别表示为$V1$、$V2$和$V3$。\n- 真实克隆型频率：$f = (f_1, f_2, f_3) = (0.5, 0.3, 0.2)$。\n- 真实频率之和：$\\sum_{i=1}^{3} f_i = 1$。\n- 各基因的相对扩增效率：$e = (e_1, e_2, e_3) = (1.0, 0.8, 1.2)$。\n- 抽样模型：观察到来自基因 $i$ 的分子的概率与乘积 $e_i f_i$ 成正比。\n- 任务1：推导期望的观测频率分布 $p^{\\mathrm{obs}} = (p^{\\mathrm{obs}}_1, p^{\\mathrm{obs}}_2, p^{\\mathrm{obs}}_3)$。\n- 任务2：计算Kullback–Leibler散度 $D_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}})$，使用自然对数定义，并将结果四舍五入至四位有效数字。\n- 任务3：以 $p^{\\mathrm{obs}}$ 和 $e$ 的函数形式，为真实频率 $\\hat{f}$ 提出一个校正估计量。\n\n**步骤2：使用提取的已知条件进行验证**\n根据验证标准评估问题。\n- **科学依据：** 问题陈述基于分子生物学和生物信息学的既定原理。PCR扩增偏差（不同序列以不同效率被扩增）的概念是下一代测序应用（如TCR组库分析）中一个众所周知且至关重要的问题。使用相对效率和比例模型是对此现象的标准且有效的简化。Kullback-Leibler散度是比较概率分布的标准信息论度量。该问题在科学上是合理的。\n- **适定性：** 该问题是适定的。它提供了所有必要的数据（$f$ 和 $e$）、清晰的建模假设（比例性），并定义了所有待计算的量。问题明确，能够得出唯一的、有意义的解。\n- **客观性：** 该问题以精确、定量和无偏见的语言陈述。它不含主观主张或意见。\n- **缺陷清单：** 该问题没有违反任何列出的无效标准。它在科学上是合理的、可形式化的、完整的，并且在一个简化模型的背景下是现实的。它不是不适定的、琐碎的或不可验证的。\n\n**步骤3：结论与行动**\n问题是**有效的**。将提供完整解答。\n\n**解答推导**\n\n**第1部分：观测频率分布 $p^{\\mathrm{obs}}$ 的推导**\n问题陈述，观察到来自V基因 $i$ 的读段的概率与其真实频率 $f_i$ 和其扩增效率 $e_i$ 的乘积成正比。我们可以将此比例关系写为：\n$$\n\\text{Prob(observe gene } i) \\propto e_i f_i\n$$\n令 $p^{\\mathrm{obs}}_i$ 为基因 $i$ 的期望观测频率。由于这些频率必须构成一个有效的概率分布，它们的总和必须等于1。\n$$\n\\sum_{i=1}^{3} p^{\\mathrm{obs}}_i = 1\n$$\n为满足此条件，我们必须对量 $e_i f_i$ 进行归一化。设 $Z$ 为归一化常数，即所有未归一化概率的总和：\n$$\nZ = \\sum_{j=1}^{3} e_j f_j\n$$\n那么基因 $i$ 的期望观测频率由下式给出：\n$$\np^{\\mathrm{obs}}_i = \\frac{e_i f_i}{Z} = \\frac{e_i f_i}{\\sum_{j=1}^{3} e_j f_j}\n$$\n这是观测频率分布 $p^{\\mathrm{obs}}$ 的一般表达式。\n\n**第2部分：Kullback–Leibler散度 $D_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}})$ 的计算**\n真实分布 $f$ 相对于观测分布 $p^{\\mathrm{obs}}$ 的Kullback–Leibler散度定义为：\n$$\nD_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}}) = \\sum_{i=1}^{3} f_i \\ln\\left(\\frac{f_i}{p^{\\mathrm{obs}}_i}\\right)\n$$\n我们可以将第1部分中 $p^{\\mathrm{obs}}_i$ 的表达式代入此公式。\n$$\n\\frac{f_i}{p^{\\mathrm{obs}}_i} = \\frac{f_i}{\\left(\\frac{e_i f_i}{\\sum_{j=1}^{3} e_j f_j}\\right)} = \\frac{\\sum_{j=1}^{3} e_j f_j}{e_i} = \\frac{Z}{e_i}\n$$\n将这个简化的比率代入 $D_{\\mathrm{KL}}$ 公式：\n$$\nD_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}}) = \\sum_{i=1}^{3} f_i \\ln\\left(\\frac{Z}{e_i}\\right)\n$$\n利用对数的性质，可以将其展开：\n$$\nD_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}}) = \\sum_{i=1}^{3} f_i (\\ln(Z) - \\ln(e_i)) = \\sum_{i=1}^{3} f_i \\ln(Z) - \\sum_{i=1}^{3} f_i \\ln(e_i)\n$$\n由于 $\\ln(Z)$ 相对于求和指数 $i$ 是一个常数，我们可以将其提出。又因为 $\\sum_{i=1}^{3} f_i = 1$：\n$$\nD_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}}) = \\ln(Z) \\sum_{i=1}^{3} f_i - \\sum_{i=1}^{3} f_i \\ln(e_i) = \\ln(Z) - \\sum_{i=1}^{3} f_i \\ln(e_i)\n$$\n这提供了一种更直接的计算散度的方法。现在，我们代入给定的数值：\n$f = (0.5, 0.3, 0.2)$ 和 $e = (1.0, 0.8, 1.2)$。\n\n首先，计算归一化常数 $Z$：\n$$\nZ = \\sum_{j=1}^{3} e_j f_j = e_1 f_1 + e_2 f_2 + e_3 f_3 = (1.0)(0.5) + (0.8)(0.3) + (1.2)(0.2) = 0.5 + 0.24 + 0.24 = 0.98\n$$\n接下来，计算项 $\\sum_{i=1}^{3} f_i \\ln(e_i)$：\n$$\n\\sum_{i=1}^{3} f_i \\ln(e_i) = f_1 \\ln(e_1) + f_2 \\ln(e_2) + f_3 \\ln(e_3) = (0.5)\\ln(1.0) + (0.3)\\ln(0.8) + (0.2)\\ln(1.2)\n$$\n由于 $\\ln(1.0) = 0$，第一项为零：\n$$\n\\sum_{i=1}^{3} f_i \\ln(e_i) = 0 + (0.3)\\ln(0.8) + (0.2)\\ln(1.2) \\approx (0.3)(-0.22314355) + (0.2)(0.18232156)\n$$\n$$\n\\approx -0.06694307 + 0.03646431 = -0.03047876\n$$\n最后，计算散度：\n$$\nD_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}}) = \\ln(0.98) - (-0.03047876) \\approx -0.02020271 + 0.03047876 = 0.01027605\n$$\n题目要求将答案四舍五入至四位有效数字。\n$$\nD_{\\mathrm{KL}}(f \\Vert p^{\\mathrm{obs}}) \\approx 0.01028\n$$\n\n**第3部分：校正估计量的推导**\n目标是使用观测频率 $p^{\\mathrm{obs}}$ 和已知效率 $e$ 为真实频率 $f$ 提出一个估计量 $\\hat{f}$。我们从第1部分推导出的关系式开始：\n$$\np^{\\mathrm{obs}}_i = \\frac{e_i f_i}{Z}\n$$\n我们可以重排此方程，用 $p^{\\mathrm{obs}}_i$ 来表示 $f_i$：\n$$\nf_i = \\frac{Z \\cdot p^{\\mathrm{obs}}_i}{e_i}\n$$\n这表明真实频率 $f_i$ 与观测频率除以效率 $p^{\\mathrm{obs}}_i / e_i$ 成正比。这就是问题中提到的“逆效率加权”。我们定义一个未归一化的估计值 $\\tilde{f}_i$：\n$$\n\\tilde{f}_i = \\frac{p^{\\mathrm{obs}}_i}{e_i}\n$$\n为了得到一个有效的频率分布，估计量 $\\hat{f}_i$ 的总和必须为1。因此，我们必须对 $\\tilde{f}_i$ 集合进行归一化：\n$$\n\\hat{f}_i = \\frac{\\tilde{f}_i}{\\sum_{j=1}^{3} \\tilde{f}_j}\n$$\n代入 $\\tilde{f}_i$ 的表达式，估计量的最终符号形式为：\n$$\n\\hat{f}_i = \\frac{p^{\\mathrm{obs}}_i / e_i}{\\sum_{j=1}^{3} (p^{\\mathrm{obs}}_j / e_j)}\n$$\n该估计量正确地使用了逆效率加权，并对结果进行归一化，以产生一组有效的估计真实频率。", "answer": "$$ \\boxed{0.01028} $$", "id": "5120814"}, {"introduction": "免疫组库测序本质上是一个抽样过程，无论测序深度多大，我们获得的都只是真实免疫组库的一个子集，许多低丰度的克隆型可能并未被观测到。本练习引入了经典的Good-Turing估计方法，这是一个强大的统计工具，用于解决“未见物种”问题。我们将从第一性原理出发，推导该估计量，并利用它根据样本中仅出现一次（单例）和两次（双例）的克隆型数量，来估算样本中未被观测到的克隆型数量，从而更准确地评估免疫组库的真实多样性。[@problem_id:5120859]", "problem": "T细胞受体（TCR）和B细胞受体（BCR）克隆型的高通量免疫组库测序通常被建模为从一个克隆型离散分布中进行抽样，其中每个克隆型都具有一个未知的抽样概率。考虑一个使用独特分子标识符（UMI）进行测序并经过错误校正的TCR组库，由此产生一个高可信度的丰度数据集。假设存在 $S_{\\text{true}}$ 个真实克隆型，其潜在的抽样概率为 $\\{p_{i}\\}_{i=1}^{S_{\\text{true}}}$，其中 $\\sum_{i=1}^{S_{\\text{true}}} p_{i} = 1$。通过从该分布中进行 $N$ 次独立抽样（多项式抽样），我们获得一个大小为 $N$ 的文库。定义 $R_{i}$ 为样本中克隆型 $i$ 的观测计数，$n_{r}$ 为被观测到恰好 $r$ 次的不同克隆型的数量，其中 $r \\in \\{0,1,2,\\dots\\}$。数量 $n_{0}$ 是未被观测到的，它对应于存在于组库中但在样本中未被看到的克隆型数量。\n\n仅使用多项式抽样和期望的基本定义，不借助快捷公式，推导用于估计未见克隆型总概率质量的Good–Turing估计量。然后，在一个连续性假设（即未见克隆型的平均检测概率与单例克隆型的Good–Turing平均检测概率相当）下，推导一个用 $n_{1}$ 和 $n_{2}$ 表示的缺失克隆型（即存在于组库但未在样本中观测到的克隆型）数量的估计量。\n\n将您的推导应用于以下从TCR $\\beta$链测序实验中获得的科学上合理的数据集：\n- UMI合并后的总读数：$N = 2.5 \\times 10^{6}$。\n- 观测到的单例克隆型数量：$n_{1} = 5.0 \\times 10^{5}$。\n- 观测到的双例克隆型数量：$n_{2} = 1.6 \\times 10^{5}$。\n\n计算由此得到的缺失克隆型数量的估计值。将最终数值答案四舍五入至四位有效数字。将最终值表示为一个纯数字（无单位）。", "solution": "问题陈述已经过验证，被认为是科学上合理、良定的，并包含足够的信息来推导出唯一解。我们继续进行推导和计算。\n\n该问题分为两个主要部分：首先，推导用于估计未见克隆型总概率质量的Good–Turing估计量；其次，在特定假设下使用该结果来估计未见克隆型的数量 $n_0$。\n\n设 $S_{\\text{true}}$ 为组库中克隆型的总数，其对应的抽样概率为 $\\{p_i\\}_{i=1}^{S_{\\text{true}}}$。抽取一个大小为 $N$ 的样本，其中 $R_i$ 是克隆型 $i$ 的观测计数的随机变量。由于抽样包含 $N$ 次独立抽取，因此 $R_i$ 服从二项分布，$R_i \\sim \\text{Binomial}(N, p_i)$。观测到克隆型 $i$ 恰好 $r$ 次的概率为：\n$$ P(R_i = r) = \\binom{N}{r} p_i^r (1-p_i)^{N-r} $$\n数量 $n_r$ 是被观测到恰好 $r$ 次的不同克隆型的数量。我们可以将 $n_r$ 表示为指示变量的和：$n_r = \\sum_{i=1}^{S_{\\text{true}}} I(R_i=r)$，其中 $I(\\cdot)$ 是指示函数。$n_r$ 的期望为：\n$$ E[n_r] = E\\left[\\sum_{i=1}^{S_{\\text{true}}} I(R_i=r)\\right] = \\sum_{i=1}^{S_{\\text{true}}} E[I(R_i=r)] = \\sum_{i=1}^{S_{\\text{true}}} P(R_i=r) $$\n代入二项概率，我们得到：\n$$ E[n_r] = \\sum_{i=1}^{S_{\\text{true}}} \\binom{N}{r} p_i^r (1-p_i)^{N-r} $$\n\n**第一部分：未见克隆型概率质量的Good–Turing估计量推导**\n\n未见克隆型的总概率质量，我们记为 $P_{\\text{unseen}}$，是所有在样本中未被观测到的克隆型（即那些 $R_i=0$ 的克隆型）的概率之和。\n$$ P_{\\text{unseen}} = \\sum_{i=1}^{S_{\\text{true}}} p_i I(R_i=0) $$\n这是一个随机变量。我们试图估计其期望 $E[P_{\\text{unseen}}]$：\n$$ E[P_{\\text{unseen}}] = E\\left[\\sum_{i=1}^{S_{\\text{true}}} p_i I(R_i=0)\\right] = \\sum_{i=1}^{S_{\\text{true}}} p_i E[I(R_i=0)] = \\sum_{i=1}^{S_{\\text{true}}} p_i P(R_i=0) $$\n使用 $r=0$ 时的二项公式：\n$$ E[P_{\\text{unseen}}] = \\sum_{i=1}^{S_{\\text{true}}} p_i (1-p_i)^N $$\n为了找到这个量的估计量，我们将其与单例克隆型数量 $n_1$ 的期望联系起来。\n$$ E[n_1] = \\sum_{i=1}^{S_{\\text{true}}} P(R_i=1) = \\sum_{i=1}^{S_{\\text{true}}} \\binom{N}{1} p_i^1 (1-p_i)^{N-1} = N \\sum_{i=1}^{S_{\\text{true}}} p_i (1-p_i)^{N-1} $$\n对于概率 $p_i$ 很小的克隆型（这些克隆型很可能未被看到或只被看到一次），项 $(1-p_i)$ 非常接近于 1。因此，我们可以做近似 $(1-p_i)^{N-1} \\approx (1-p_i)^N$，因为 $(1-p_i)^{-1} \\approx 1$。\n$$ E[n_1] \\approx N \\sum_{i=1}^{S_{\\text{true}}} p_i (1-p_i)^N = N \\cdot E[P_{\\text{unseen}}] $$\n这给了我们单例的期望数量与未见克隆型的期望总概率之间的关系。\n$$ E[P_{\\text{unseen}}] \\approx \\frac{E[n_1]}{N} $$\nGood–Turing估计量是通过使用观测计数 $n_1$ 作为其期望 $E[n_1]$ 的无偏估计量来推导的。因此，未见克隆型总概率质量的估计量，我们记为 $\\hat{P}_{\\text{unseen}}$，是：\n$$ \\hat{P}_{\\text{unseen}} = \\frac{n_1}{N} $$\n推导的第一部分到此结束。\n\n**第二部分：缺失克隆型数量 $n_0$ 的估计量推导**\n\n缺失克隆型的数量 $n_0$ 是满足 $R_i=0$ 的克隆型集合的大小。我们可以用未见克隆型的总概率 $P_{\\text{unseen}}$ 和未见克隆型的平均概率 $\\bar{p}_0$ 来表示 $n_0$：\n$$ n_0 = \\frac{P_{\\text{unseen}}}{\\bar{p}_0} $$\n为了构建一个估计量 $\\hat{n}_0$，我们需要分子和分母的估计量。从第一部分，我们有 $\\hat{P}_{\\text{unseen}} = n_1/N$。\n\n现在我们需要一个 $\\bar{p}_0$ 的估计量。问题陈述了一个“连续性假设”：未见克隆型的平均检测概率与单例克隆型中的Good–Turing平均检测概率相当。我们通过将 $\\bar{p}_0$ 的估计值设为与单例平均概率 $\\bar{p}_1$ 的估计值相等来形式化这个假设。\n让我们找一个 $\\bar{p}_1$ 的估计量。单例克隆型的平均概率定义为单例的总概率质量除以单例的数量。这个平均概率的估计量 $\\hat{\\bar{p}}_1$ 是：\n$$ \\hat{\\bar{p}}_1 = \\frac{\\text{单例的估计总概率质量}}{\\text{单例数量}} = \\frac{\\hat{P}_{\\text{singletons}}}{n_1} $$\n为了估计 $\\hat{P}_{\\text{singletons}}$，我们可以使用在第一部分中发展的相同的Good–Turing逻辑。我们考虑被看到 $r$ 次的克隆型的期望总概率质量 $E[P_r] = \\sum_{i=1}^{S_{\\text{true}}} p_i P(R_i=r)$ 与被看到 $r+1$ 次的克隆型的期望数量 $E[n_{r+1}]$ 之间的一般关系。\n$$ E[n_{r+1}] = \\sum_i \\binom{N}{r+1} p_i^{r+1} (1-p_i)^{N-r-1} = \\sum_i \\frac{N-r}{r+1} \\binom{N}{r} p_i^{r+1} (1-p_i)^{N-r-1} $$\n$$ E[P_r] = \\sum_i \\binom{N}{r} p_i^{r+1} (1-p_i)^{N-r} $$\n对于小的 $p_i$，$(1-p_i)^{-1} \\approx 1$。对于大的 $N$ 和小的 $r$，$N-r \\approx N$。\n$$ E[n_{r+1}] \\approx \\frac{N}{r+1} \\sum_i \\binom{N}{r} p_i^{r+1} (1-p_i)^{N-r} = \\frac{N}{r+1} E[P_r] $$\n这给出了一个一般关系 $E[P_r] \\approx \\frac{(r+1)E[n_{r+1}]}{N}$。使用观测计数作为其期望的估计，可以得到被看到 $r$ 次的克隆型总概率质量的估计量：\n$$ \\hat{P}_r = \\frac{(r+1)n_{r+1}}{N} $$\n对于单例（$r=1$），估计的总概率质量是：\n$$ \\hat{P}_{\\text{singletons}} = \\hat{P}_1 = \\frac{(1+1)n_{1+1}}{N} = \\frac{2n_2}{N} $$\n现在我们可以计算单例平均概率的估计量：\n$$ \\hat{\\bar{p}}_1 = \\frac{\\hat{P}_{\\text{singletons}}}{n_1} = \\frac{2n_2/N}{n_1} = \\frac{2n_2}{N n_1} $$\n应用连续性假设，我们设定 $\\hat{\\bar{p}}_0 = \\hat{\\bar{p}}_1$。现在我们可以组装 $n_0$ 的估计量：\n$$ \\hat{n}_0 = \\frac{\\hat{P}_{\\text{unseen}}}{\\hat{\\bar{p}}_0} = \\frac{n_1/N}{2n_2/(N n_1)} $$\n$$ \\hat{n}_0 = \\frac{n_1}{N} \\cdot \\frac{N n_1}{2n_2} = \\frac{n_1^2}{2n_2} $$\n这就是我们想要的用 $n_1$ 和 $n_2$ 表示的缺失克隆型数量的估计量。\n\n**第三部分：应用于给定数据集**\n\n我们从一次TCR $\\beta$链测序实验中得到以下数据：\n- UMI合并后的总读数：$N = 2.5 \\times 10^{6}$\n- 单例克隆型数量：$n_{1} = 5.0 \\times 10^{5}$\n- 双例克隆型数量：$n_{2} = 1.6 \\times 10^{5}$\n\n我们应用推导出的 $\\hat{n}_0$ 公式：\n$$ \\hat{n}_0 = \\frac{n_1^2}{2n_2} = \\frac{(5.0 \\times 10^{5})^2}{2 \\times (1.6 \\times 10^{5})} $$\n$$ \\hat{n}_0 = \\frac{25.0 \\times 10^{10}}{3.2 \\times 10^{5}} $$\n$$ \\hat{n}_0 = \\frac{25.0}{3.2} \\times 10^{10-5} = 7.8125 \\times 10^{5} $$\n$$ \\hat{n}_0 = 781250 $$\n问题要求将最终答案四舍五入至四位有效数字。\n$$ 7.8125 \\times 10^5 \\approx 7.813 \\times 10^5 = 781300 $$\n估计的缺失克隆型数量是 $781300$。", "answer": "$$\\boxed{781300}$$", "id": "5120859"}]}