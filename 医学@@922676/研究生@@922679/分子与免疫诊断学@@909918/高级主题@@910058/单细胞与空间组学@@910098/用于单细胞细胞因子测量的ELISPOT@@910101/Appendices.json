{"hands_on_practices": [{"introduction": "酶联免疫斑点（ELISpot）分析的基础是准确计数单个细胞产生的斑点。然而，选择合适的细胞铺板密度是一个关键的权衡：密度太低会导致统计功效不足，而密度太高则会导致斑点重叠，无法准确计数。本练习将引导您从几何概率的第一性原理出发，推导斑点重叠如何对细胞密度产生非线性依赖，从而理解为何优化细胞密度是 ELISpot 实验设计的核心步骤。[@problem_id:5112787]", "problem": "在用于单细胞细胞因子测量的酶联免疫斑点（ELISpot）分析法中，每个分泌细胞因子的细胞会在膜上沉积一种不溶性产物，形成一个以该细胞位置为中心的、半径近似均匀为 $r$ 的圆形斑点。要精确计数分泌细胞因子的细胞，需要各个斑点是可分辨且不重叠的。考虑一个面积为 $A$ 的单孔，其中接种了 $N$ 个存活的、分泌细胞因子的细胞，并假设它们在孔表面上是独立且均匀分布的。定义“碰撞”为任何一对在几何上重叠的斑点（即，它们中心之间的距离小于 $2r$）。假设 $r$ 相对于孔的特征长度尺度很小，因此边界效应可以忽略不计。\n\n仅使用几何概率的基本定义、均匀分布点的独立性以及期望的线性性，推导孔内碰撞期望数的解析表达式，该表达式是 $N$、$r$ 和 $A$ 的函数。根据你的推导，从第一性原理的角度简要论证为什么优化细胞密度（单位面积的细胞数）对于最小化斑点重叠至关重要。将你的最终结果表示为单个闭式解析表达式。无需进行数值计算，且最终表达式中不应包含任何单位。", "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，是良定的、客观的，并包含了使用指定的第一性原理方法推导解决方案所需的所有必要信息。\n\n问题要求推导在面积为 $A$ 的孔中独立均匀分布的 $N$ 个分泌细胞因子的细胞之间发生碰撞的期望数 $E[C]$。每个细胞产生一个半径为 $r$ 的斑点。碰撞被定义为两个斑点的几何重叠，当相应细胞中心之间的距离小于 $2r$ 时发生。推导将通过应用期望的线性性原理进行。\n\n设 $N$ 个细胞从 1 到 $N$ 编号。设 $C$ 为表示孔中碰撞总数的随机变量。一次碰撞涉及一对斑点。唯一的细胞对总数由二项式系数 $\\binom{N}{2}$ 给出。\n\n让我们为每一对不同的细胞 $(i, j)$（其中 $1 \\le i  j \\le N$）定义一个指示随机变量 $I_{ij}$。变量 $I_{ij}$ 定义如下：\n$$\nI_{ij} =\n\\begin{cases}\n1  \\text{如果斑点 } i \\text{ 和 } j \\text{ 碰撞} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n碰撞总数 $C$ 是这些指示随机变量在所有唯一对上的和：\n$$\nC = \\sum_{1 \\le i  j \\le N} I_{ij}\n$$\n碰撞的期望数 $E[C]$ 可以通过应用期望的线性性来找到，该性质指出，随机变量之和的期望等于它们各自期望之和：\n$$\nE[C] = E\\left[\\sum_{1 \\le i  j \\le N} I_{ij}\\right] = \\sum_{1 \\le i  j \\le N} E[I_{ij}]\n$$\n对于任何指示变量，其期望等于它所指示事件的概率。因此，$E[I_{ij}] = P(I_{ij} = 1)$，即斑点 $i$ 和 $j$ 发生碰撞的概率。我们用 $p_{\\text{coll}}$ 表示这个概率。\n$$\nE[I_{ij}] = p_{\\text{coll}}\n$$\n由于细胞是独立同分布的（在面积 $A$ 上均匀分布），所以任何一对细胞 $(i, j)$ 的碰撞概率 $p_{\\text{coll}}$ 都是相同的。\n\n求和中的总项数是从 $N$ 个细胞中选择 2 个细胞的方式数，即 $\\binom{N}{2} = \\frac{N(N-1)}{2}$。\n将此代入 $E[C]$ 的表达式中，我们得到：\n$$\nE[C] = \\sum_{1 \\le i  j \\le N} p_{\\text{coll}} = \\binom{N}{2} p_{\\text{coll}} = \\frac{N(N-1)}{2} p_{\\text{coll}}\n$$\n下一步是使用几何概率计算 $p_{\\text{coll}}$。设任意两个细胞 $i$ 和 $j$ 的中心位置为随机变量 $X_i$ 和 $X_j$，它们在面积 $A$ 上独立且均匀分布。如果它们中心之间的距离 $d(X_i, X_j)$ 小于 $2r$，则发生碰撞。\n\n为了计算这个概率，我们把细胞 $i$ 的位置固定在孔内的某一点 $x_i$。要发生碰撞，细胞 $j$ 的中心 $X_j$ 必须位于以 $x_i$ 为中心、半径为 $2r$ 的圆内。这个“碰撞区域”的面积是：\n$$\nA_{\\text{coll}} = \\pi (2r)^2 = 4\\pi r^2\n$$\n问题陈述指出边界效应可以忽略不计。这个关键假设意味着，对于细胞 $i$ 的任何位置 $x_i$，整个面积为 $A_{\\text{coll}}$ 的碰撞区域都被认为在孔区域 $A$ 之内。\n\n由于细胞 $j$ 在总面积 $A$ 上均匀分布，它落入此碰撞区域的概率是碰撞面积与总面积的比值：\n$$\np_{\\text{coll}} = P(d(X_i, X_j)  2r) = \\frac{A_{\\text{coll}}}{A} = \\frac{4\\pi r^2}{A}\n$$\n这个概率与细胞 $i$ 的具体位置无关，这证实了对于所有细胞对，$p_{\\text{coll}}$ 是一个常数。\n\n现在，我们将 $p_{\\text{coll}}$ 的这个表达式代回到我们关于总碰撞期望数的方程中：\n$$\nE[C] = \\frac{N(N-1)}{2} \\left(\\frac{4\\pi r^2}{A}\\right)\n$$\n简化此表达式可得到碰撞期望数的最终解析结果：\n$$\nE[C] = \\frac{2\\pi r^2 N(N-1)}{A}\n$$\n该表达式提供了重叠斑点的期望数，作为细胞数 $N$、斑点半径 $r$ 和孔面积 $A$ 的函数。\n\n为了论证为何优化细胞密度至关重要，我们考察 $E[C]$ 与细胞密度 $\\rho = N/A$ 之间的关系。推导出的表达式表明，$E[C]$ 与 $N(N-1)$ 成正比。对于大量的细胞（$N \\gg 1$），$N(N-1) \\approx N^2$。因此，碰撞的期望数大约与细胞数的平方成比例：\n$$\nE[C] \\propto \\frac{N^2}{A} = \\left(\\frac{N}{A}\\right) N = \\rho N\n$$\n由于 $N = \\rho A$，我们也可以将其写为 $E[C] \\propto \\rho (\\rho A) = A\\rho^2$。这种对细胞密度 $\\rho$ 的二次依赖关系是关键的见解。这意味着将细胞密度加倍会导致斑点重叠的期望数大约增加四倍。高的重叠率损害了ELISpot分析法的基本原则，即计数单个分泌细胞因子的细胞。如果斑点融合，计数就会变得不准确。相反，如果密度太低，观察到的斑点数量可能太少，无法进行统计上可靠的测量。因此，存在一个最佳的细胞密度范围，它在需要足够数量的斑点与需要将重叠保持在最低水平之间取得了平衡。碰撞次数随密度的强烈非线性增长使得这种优化成为实验设计中的关键步骤。", "answer": "$$\n\\boxed{\\frac{2\\pi r^2 N(N-1)}{A}}\n$$", "id": "5112787"}, {"introduction": "在获得 ELISpot 图像后，一个核心挑战是区分由细胞因子分泌产生的真实斑点和各种背景伪影（如灰尘、划痕）。本练习将介绍如何利用斑点的形态学特征（如面积、圆度）来构建一个统计分类器，以实现这一关键的质量控制步骤。您将学习如何设计一个考虑了不等错误代价和类别不平衡问题的分类器，这对于确保自动化分析结果的准确性至关重要。[@problem_id:5112779]", "problem": "在酶联免疫斑点（Enzyme-Linked ImmunoSpot, ELISpot）分析中，每个分泌细胞因子的细胞会产生一个显影斑点，其形态可以被量化，以区分真实的生物事件和伪影。考虑从分割图像中计算出的三个针对每个斑点的特征：面积 $A$（单位为 $\\mu\\mathrm{m}^2$）、圆度 $\\gamma$（无单位，对于完美圆形 $\\gamma \\approx 1$），以及边缘梯度大小 $g$（单位为强度/像素，概括了边界的陡峭程度）。假设真实的细胞因子斑点接近圆形，具有中等的 $A$ 和较高的 $g$，而伪影（例如灰尘、划痕、沉淀物）则形状不规则，具有较低的 $\\gamma$ 和通常较低的 $g$。\n\n一个经整理的训练集包含 $n_T = 200$ 个标记为真实的斑点和 $n_A = 800$ 个标记为伪影的斑点，类别先验概率为 $\\pi_T = n_T/(n_T+n_A)$ 和 $\\pi_A = n_A/(n_T+n_A)$。根据经验，真实斑点和伪影的特征向量 $\\mathbf{x} = (A,\\gamma,g)$ 近似服从协方差矩阵相等的多变量高斯分布。样本均值为\n$\\boldsymbol{\\mu}_T = (300,\\,0.85,\\,25)$ 和 $\\boldsymbol{\\mu}_A = (150,\\,0.55,\\,12)$，\n共享协方差矩阵为对角矩阵，\n$\\Sigma = \\mathrm{diag}(900,\\,0.0064,\\,16)$。\n在操作上，漏掉一个真实斑点的代价是接受一个伪影的 $\\!5$ 倍，因此 $c_{\\mathrm{FN}} = 5$ 且 $c_{\\mathrm{FP}} = 1$。\n\n假设基于从 $\\mathbf{x}$ 构建的标量判别式 $z$ 采用线性决策规则，并且性能必须在类别严重不平衡的情况下报告。在陈述的生成假设下，哪个选项最恰当地利用形态学来区分真实斑点和伪影，指定了具有正确成本敏感决策边界的、符合统计学原理的分类器，并为该 ELISpot 场景确定了合适的性能评估指标？\n\nA. 使用线性判别分析 (LDA)，判别式为 $z = \\mathbf{w}^\\top \\mathbf{x} + b$，其中 $\\mathbf{w} = \\Sigma^{-1}(\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A) = (0.1667,\\,46.8750,\\,0.8125)$ 且 $b = -\\tfrac{1}{2}\\left(\\boldsymbol{\\mu}_T^\\top \\Sigma^{-1} \\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\Sigma^{-1} \\boldsymbol{\\mu}_A\\right) - \\ln\\!\\left(\\frac{c_{\\mathrm{FP}} \\pi_A}{c_{\\mathrm{FN}} \\pi_T}\\right) \\approx -85.12$。如果 $z > 0$ 则判定为“真实斑点”，否则为“伪影”。使用 $k=5$ 的 $k$ 折交叉验证，并使用精确率-召回率 (PR) 曲线、精确率-召回率曲线下面积 (AUPRC) 和所选操作点上的 $F_1$ 分数进行评估，同时报告敏感性和特异性。\n\nB. 使用 $k$-均值 ($k = 2$) 对未经标准化的原始 $(A,\\gamma,g)$ 特征向量进行聚类；然后如果 $\\gamma > 0.70$ 则将斑点分类为“真实”，否则分类为“伪影”。选择操作点以最大化训练集上的总体准确率，并使用受试者工作特征 (ROC) 曲线和 ROC 曲线下面积 (AUROC) 进行评估。\n\nC. 在不考虑类别先验或成本的情况下，对原始 $(A,\\gamma,g)$ 拟合逻辑回归模型；使用默认的 $0.50$ 概率阈值进行分类。主要使用留出验证集上的总体准确率和 AUROC 进行评估。\n\nD. 使用 LDA，判别式为 $z = \\mathbf{w}^\\top \\mathbf{x} + b$，其中 $\\mathbf{w} = \\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A = (150,\\,0.30,\\,13)$ 且 $b = -\\tfrac{1}{2}\\left(\\boldsymbol{\\mu}_T^\\top \\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\boldsymbol{\\mu}_A\\right) + \\ln\\!\\left(\\frac{\\pi_T}{\\pi_A}\\right)$；如果 $z > 0$ 则判定为“真实”。调整阈值以最大化准确率，并且仅当准确率低于 $0.95$ 时报告 $F_1$；否则报告 AUROC。\n\n选择唯一的最佳选项。", "solution": "问题陈述已经过验证，并被确定为应用于免疫诊断学的统计模式识别领域中一个有效且适定的问题。\n\n该问题要求构建一个分类器，以基于特征向量 $\\mathbf{x} = (A, \\gamma, g)$ 区分真实细胞因子斑点（类别 $T$）和伪影（类别 $A$）。问题陈述指出，这些类别由具有共享协方差矩阵 $\\Sigma$ 的多变量高斯分布建模。这是线性判别分析 (LDA) 的典型设定。最优决策规则还必须考虑不相等的类别先验概率（$\\pi_T$, $\\pi_A$）和不相等的错分成本（$c_{\\mathrm{FN}}$, $c_{\\mathrm{FP}}$）。\n\n根据贝叶斯决策理论，最小化期望代价的规则是，如果将观测值 $\\mathbf{x}$ 分类为“真实斑点”（$T$）的期望代价小于将其分类为“伪影”（$A$）的期望代价，则将其分类为 $T$。期望代价为：\n$$R(T|\\mathbf{x}) = c_{\\mathrm{TP}} P(T|\\mathbf{x}) + c_{\\mathrm{FP}} P(A|\\mathbf{x})$$\n$$R(A|\\mathbf{x}) = c_{\\mathrm{FN}} P(T|\\mathbf{x}) + c_{\\mathrm{TN}} P(A|\\mathbf{x})$$\n鉴于正确分类的成本为零（$c_{\\mathrm{TP}} = c_{\\mathrm{TN}} = 0$），如果 $c_{\\mathrm{FP}} P(A|\\mathbf{x})  c_{\\mathrm{FN}} P(T|\\mathbf{x})$，我们判定为 $T$。使用贝叶斯定理，$P(k|\\mathbf{x}) \\propto p(\\mathbf{x}|k)\\pi_k$，该不等式变为：\n$$c_{\\mathrm{FP}} p(\\mathbf{x}|A)\\pi_A  c_{\\mathrm{FN}} p(\\mathbf{x}|T)\\pi_T$$\n整理并取自然对数，如果满足以下条件，我们判定为 $T$：\n$$\\ln\\left(\\frac{p(\\mathbf{x}|T)}{p(\\mathbf{x}|A)}\\right) > \\ln\\left(\\frac{c_{\\mathrm{FP}}\\pi_A}{c_{\\mathrm{FN}}\\pi_T}\\right)$$\n对于多变量高斯分布 $p(\\mathbf{x}|k) = \\mathcal{N}(\\mathbf{x}; \\boldsymbol{\\mu}_k, \\Sigma)$，对数似然比为：\n$$\\ln\\left(\\frac{p(\\mathbf{x}|T)}{p(\\mathbf{x}|A)}\\right) = \\mathbf{x}^\\top \\Sigma^{-1}(\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A) - \\frac{1}{2}(\\boldsymbol{\\mu}_T^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_A)$$\n因此，完整的决策规则是，如果满足以下条件，则分类为 $T$：\n$$\\mathbf{x}^\\top \\Sigma^{-1}(\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A) - \\frac{1}{2}(\\boldsymbol{\\mu}_T^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_A) - \\ln\\left(\\frac{c_{\\mathrm{FP}}\\pi_A}{c_{\\mathrm{FN}}\\pi_T}\\right)  0$$\n这定义了一个线性判别分数 $z = \\mathbf{w}^\\top \\mathbf{x} + b$，其中：\n$$\\mathbf{w} = \\Sigma^{-1}(\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A)$$\n$$b = -\\frac{1}{2}(\\boldsymbol{\\mu}_T^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_A) - \\ln\\left(\\frac{c_{\\mathrm{FP}}\\pi_A}{c_{\\mathrm{FN}}\\pi_T}\\right)$$\n决策是如果 $z0$，则为“真实斑点”。\n\n现在我们来计算数值。\n已知：\n$\\boldsymbol{\\mu}_T = (300,\\,0.85,\\,25)$, $\\boldsymbol{\\mu}_A = (150,\\,0.55,\\,12)$\n$\\Sigma = \\mathrm{diag}(900,\\,0.0064,\\,16)$\n$c_{\\mathrm{FN}} = 5$, $c_{\\mathrm{FP}} = 1$\n$\\pi_T = 200/(200+800) = 0.2$, $\\pi_A = 800/(200+800) = 0.8$\n\n逆协方差矩阵为 $\\Sigma^{-1} = \\mathrm{diag}(1/900,\\, 1/0.0064,\\, 1/16) = \\mathrm{diag}(1/900,\\, 156.25,\\, 0.0625)$。\n均值之差为 $\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A = (150,\\,0.30,\\,13)$。\n\n权重向量 $\\mathbf{w}$ 是：\n$\\mathbf{w} = \\Sigma^{-1}(\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A) = (150/900,\\, 0.30/0.0064,\\, 13/16) = (1/6,\\, 46.875,\\, 0.8125)$。\n$1/6 \\approx 0.1667$。所以，$\\mathbf{w} \\approx (0.1667, 46.875, 0.8125)$。\n\n偏置项 $b$ 有两个组成部分。首先，二次型部分：\n$\\boldsymbol{\\mu}_T^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_T = 300^2/900 + 0.85^2/0.0064 + 25^2/16 = 100 + 112.890625 + 39.0625 = 251.953125$。\n$\\boldsymbol{\\mu}_A^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_A = 150^2/900 + 0.55^2/0.0064 + 12^2/16 = 25 + 47.265625 + 9 = 81.265625$。\n所以，$-\\frac{1}{2}(\\boldsymbol{\\mu}_T^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\Sigma^{-1}\\boldsymbol{\\mu}_A) = -\\frac{1}{2}(251.953125 - 81.265625) = -\\frac{1}{2}(170.6875) = -85.34375$。\n\n其次，成本和先验项：\n$-\\ln\\left(\\frac{c_{\\mathrm{FP}}\\pi_A}{c_{\\mathrm{FN}}\\pi_T}\\right) = -\\ln\\left(\\frac{1 \\times 0.8}{5 \\times 0.2}\\right) = -\\ln\\left(\\frac{0.8}{1.0}\\right) = -\\ln(0.8) \\approx -(-0.22314) = 0.22314$。\n\n总偏置为 $b \\approx -85.34375 + 0.22314 = -85.12061$。\n\n最后，问题提到“类别严重不平衡”，这要求仔细选择评估指标。准确率是一个糟糕的选择。对不平衡数据具有鲁棒性的指标，如精确率-召回率曲线、P-R曲线下面积 (AUPRC) 和 $F_1$ 分数是合适的。敏感性和特异性也是理解各类别性能的基础。为确保泛化能力，应使用如 $k$ 折交叉验证之类的方法来估计性能。\n\n现在我们评估每个选项：\n\n**A. 使用线性判别分析 (LDA)，判别式为 $z = \\mathbf{w}^\\top \\mathbf{x} + b$，其中 $\\mathbf{w} = \\Sigma^{-1}(\\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A) = (0.1667,\\,46.8750,\\,0.8125)$ 且 $b = -\\tfrac{1}{2}\\left(\\boldsymbol{\\mu}_T^\\top \\Sigma^{-1} \\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\Sigma^{-1} \\boldsymbol{\\mu}_A\\right) - \\ln\\!\\left(\\frac{c_{\\mathrm{FP}} \\pi_A}{c_{\\mathrm{FN}} \\pi_T}\\right) \\approx -85.12$。如果 $z  0$ 则判定为“真实斑点”，否则为“伪影”。使用 $k=5$ 的 $k$ 折交叉验证，并使用精确率-召回率 (PR) 曲线、精确率-召回率曲线下面积 (AUPRC) 和所选操作点上的 $F_1$ 分数进行评估，同时报告敏感性和特异性。**\n该选项正确地将 LDA 识别为符合原理的分类器。权重向量 $\\mathbf{w}$ 和偏置项 $b$ 的公式是正确的，完全整合了协方差、先验概率和成本，以定义贝叶斯最优决策边界。$\\mathbf{w}$ 和 $b$ 的数值计算与我们的推导相符。所提出的评估方法，即使用 $k$ 折交叉验证以及PR曲线、AUPRC、$F_1$ 分数、敏感性和特异性等指标，是处理此类不平衡且成本敏感分类问题的最先进方法。\n结论：**正确**。\n\n**B. 使用 $k$-均值 ($k = 2$) 对未经标准化的原始 $(A,\\gamma,g)$ 特征向量进行聚类；然后如果 $\\gamma  0.70$ 则将斑点分类为“真实”，否则分类为“伪影”。选择操作点以最大化训练集上的总体准确率，并使用受试者工作特征 (ROC) 曲线和 ROC 曲线下面积 (AUROC) 进行评估。**\n这个选项存在根本性缺陷。首先，$k$-均值是一种无监督聚类算法，不适用于有可用标记数据的监督分类问题。其次，将其应用于尺度差异巨大的原始特征将导致幅度最大的特征（$A$）主导距离计算。第三，决策规则是一个对 $\\gamma$ 的任意单变量阈值，这丢弃了大部分信息并忽略了推导出的模型。第四，对于不平衡数据集，最大化准确率是一个糟糕的目标。\n结论：**不正确**。\n\n**C. 在不考虑类别先验或成本的情况下，对原始 $(A,\\gamma,g)$ 拟合逻辑回归模型；使用默认的 $0.50$ 概率阈值进行分类。主要使用留出验证集上的总体准确率和 AUROC 进行评估。**\n虽然逻辑回归是一种有效的分类算法，但该选项的方法是幼稚的。它未能考虑明确的成本（$c_{\\mathrm{FN}} = 5, c_{\\mathrm{FP}} = 1$），而这是一个关键要求。默认的 $0.50$ 概率阈值仅在成本相等和先验概率相等时才是最优的，而这两者在此都不成立。判定为 $T$ 的最优概率阈值是 $P(T|\\mathbf{x})  c_{\\mathrm{FP}}/(c_{\\mathrm{FP}}+c_{\\mathrm{FN}}) = 1/6 \\approx 0.167$。使用 $0.50$ 是次优的。此外，对于不平衡问题，主要使用准确率进行评估是不恰当的。\n结论：**不正确**。\n\n**D. 使用 LDA，判别式为 $z = \\mathbf{w}^\\top \\mathbf{x} + b$，其中 $\\mathbf{w} = \\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A = (150,\\,0.30,\\,13)$ 且 $b = -\\tfrac{1}{2}\\left(\\boldsymbol{\\mu}_T^\\top \\boldsymbol{\\mu}_T - \\boldsymbol{\\mu}_A^\\top \\boldsymbol{\\mu}_A\\right) + \\ln\\!\\left(\\frac{\\pi_T}{\\pi_A}\\right)$；如果 $z  0$ 则判定为“真实”。调整阈值以最大化准确率，并且仅当准确率低于 $0.95$ 时报告 $F_1$；否则报告 AUROC。**\n该选项提出了一个不正确的 LDA 公式。权重向量 $\\mathbf{w}$ 是错误的，因为它省略了 $\\Sigma^{-1}$ 项，实际上是假设协方差是单位矩阵，并忽略了特征相关性和尺度。偏置项 $b$ 也是错误的；它省略了 $\\Sigma^{-1}$，最重要的是，它忽略了指定的不对称成本。最大化准确率的目标是有缺陷的。最后，用于评估指标的条件性报告策略是武断的，且缺乏科学原理。\n结论：**不正确**。\n\n基于全面分析，选项A是唯一一个对该问题提出了在统计学上符合原理、在定量上正确、在方法论上健全的解决方案。", "answer": "$$\\boxed{A}$$", "id": "5112779"}, {"introduction": "ELISpot 分析的最终目标是估算样本中分泌特定细胞因子的细胞频率，这是一个核心的生物学参数。本练习旨在搭建从观察到的斑点数到这一潜在频率的桥梁。通过将最大似然估计原理应用于斑点形成的泊松模型，您将推导出该细胞频率的最优估计值，这是进行定量 ELISpot 分析和解读结果的基石。[@problem_id:5112724]", "problem": "一个研究团队使用酶联免疫斑点（ELISpot）技术来定量外周血单核细胞样本中细胞因子分泌细胞的频率。他们设置了 $m$ 个重复孔，每个孔中接种了恰好 $n$ 个输入细胞。在每个孔 $i \\in \\{1,2,\\dots,m\\}$ 中，他们观察到一个非负整数的斑点计数 $k_{i}$，并将其作为他们的数据。假设在极限稀释和斑点形成事件独立的条件下，孔 $i$ 中的总计数 $K_{i}$ 服从均值为 $\\lambda = np$ 的泊松分布，其中 $p$ 是单个细胞的分泌频率（即随机选择的单个输入细胞分泌并形成可检测斑点的概率）。假设各个孔之间是独立的，并且 $p \\in [0,1]$。\n\n从泊松概率质量函数的定义和最大似然原理出发，在给定观测数据 $\\{k_{i}\\}_{i=1}^{m}$ 和已知 $n$ 的情况下，推导出 $p$ 的最大似然估计，并满足约束条件 $0 \\leq p \\leq 1$。将您的最终答案表示为关于 $m$、$n$ 和观测数据 $\\{k_{i}\\}$ 的单个闭式解析表达式。无需进行数值取整，也无需报告单位。", "solution": "问题是在给定来自每个含 $n$ 个细胞的孔的 $m$ 个重复斑点计数测量值 $\\{k_i\\}_{i=1}^{m}$ 的情况下，求解单个细胞分泌频率 $p$ 的最大似然估计（MLE）。\n\n问题陈述提供了单个孔 $i \\in \\{1, 2, \\dots, m\\}$ 中斑点计数 $K_i$ 的模型。随机变量 $K_i$ 假定服从均值为 $\\lambda = np$ 的泊松分布，其中 $n$ 是每孔的细胞数，$p$ 是单个细胞分泌细胞因子并形成斑点的概率。参数 $p$ 被约束在区间 $[0, 1]$ 内。\n\n在孔 $i$ 中观测到 $k_i$ 个斑点的概率质量函数（PMF）由泊松分布给出：\n$$P(K_i = k_i | \\lambda) = \\frac{\\lambda^{k_i} \\exp(-\\lambda)}{k_i!}$$\n将 $\\lambda = np$ 代入，关于 $p$ 的PMF为：\n$$P(K_i = k_i | p, n) = \\frac{(np)^{k_i} \\exp(-np)}{k_i!}$$\n观测值 $\\{k_i\\}_{i=1}^{m}$ 来自 $m$ 个独立的孔。因此，似然函数 $L(p)$，即观测到这一特定数据集的联合概率，是每个孔的单个概率的乘积：\n$$L(p; \\{k_i\\}, n) = \\prod_{i=1}^{m} P(K_i = k_i | p, n) = \\prod_{i=1}^{m} \\frac{(np)^{k_i} \\exp(-np)}{k_i!}$$\n为了找到 $p$ 的 MLE，我们寻求在约束条件 $0 \\le p \\le 1$ 下使 $L(p)$ 最大化的 $p$ 值。处理似然函数的自然对数，即对数似然函数 $\\ell(p) = \\ln(L(p))$，会更为方便，因为最大化 $\\ell(p)$ 等价于最大化 $L(p)$，且对数变换能将乘积简化为求和。\n$$\\ell(p) = \\ln\\left( \\prod_{i=1}^{m} \\frac{(np)^{k_i} \\exp(-np)}{k_i!} \\right) = \\sum_{i=1}^{m} \\ln\\left( \\frac{(np)^{k_i} \\exp(-np)}{k_i!} \\right)$$\n利用对数的性质，我们可以展开此表达式：\n$$\\ell(p) = \\sum_{i=1}^{m} \\left[ \\ln((np)^{k_i}) - \\ln(\\exp(np)) - \\ln(k_i!) \\right]$$\n$$\\ell(p) = \\sum_{i=1}^{m} \\left[ k_i \\ln(np) - np - \\ln(k_i!) \\right]$$\n我们可以进一步分离出包含 $p$ 的项：\n$$\\ell(p) = \\sum_{i=1}^{m} \\left[ k_i (\\ln(n) + \\ln(p)) - np - \\ln(k_i!) \\right]$$\n$$\\ell(p) = \\left(\\sum_{i=1}^{m} k_i\\right) \\ln(n) + \\left(\\sum_{i=1}^{m} k_i\\right) \\ln(p) - mnp - \\sum_{i=1}^{m} \\ln(k_i!)$$\n为了找到使 $\\ell(p)$ 最大化的 $p$ 值，我们首先通过计算 $\\ell(p)$ 对 $p$ 的导数并将其设为零来找到临界点。不依赖于 $p$ 的项的导数将为零。\n$$\\frac{d\\ell}{dp} = \\frac{d}{dp} \\left[ \\left(\\sum_{i=1}^{m} k_i\\right) \\ln(p) - mnp + (\\text{constants}) \\right]$$\n$$\\frac{d\\ell}{dp} = \\frac{1}{p} \\left(\\sum_{i=1}^{m} k_i\\right) - mn$$\n将导数设为零，得到 $p$ 的无约束估计值，我们记为 $\\hat{p}_{\\text{unc}}$：\n$$\\frac{1}{\\hat{p}_{\\text{unc}}} \\left(\\sum_{i=1}^{m} k_i\\right) - mn = 0$$\n$$\\frac{1}{\\hat{p}_{\\text{unc}}} \\left(\\sum_{i=1}^{m} k_i\\right) = mn$$\n$$\\hat{p}_{\\text{unc}} = \\frac{\\sum_{i=1}^{m} k_i}{mn}$$\n为确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{dp^2} = -\\frac{1}{p^2} \\left(\\sum_{i=1}^{m} k_i\\right)$$\n由于对所有 $i$ 都有 $k_i \\ge 0$，总和 $\\sum k_i$ 是非负的。对于任何 $p  0$，$p^2$ 是正的。因此，如果 $\\sum k_i  0$，二阶导数为负，这证实了 $\\ell(p)$ 是 $p$ 的凹函数，且 $\\hat{p}_{\\text{unc}}$ 是一个最大值点。\n\n现在，我们必须施加约束条件 $p \\in [0, 1]$。最大似然估计值 $\\hat{p}_{\\text{MLE}}$ 必须落在此区间内。\n令 $S = \\sum_{i=1}^{m} k_i$。无约束估计值为 $\\hat{p}_{\\text{unc}} = S / (mn)$。\n\n情况1：$S=0$。这意味着所有观测到的计数值 $k_i$ 均为 $0$。对数似然函数变为 $\\ell(p) = -mnp - \\sum_{i=1}^{m} \\ln(0!) = -mnp$。其导数为 $\\frac{d\\ell}{dp} = -mn$，由于 $m$ 和 $n$ 是正整数，该导数严格为负。函数 $\\ell(p)$ 在 $p \\in [0, 1]$ 上是严格递减的。因此，最大值在下边界 $p=0$ 处取得。在这种情况下，$\\hat{p}_{\\text{MLE}} = 0$。\n\n情况2：$S0$。对数似然函数 $\\ell(p)$ 在 $p0$ 时是凹函数。\n- 如果 $0  \\hat{p}_{\\text{unc}}  1$，无约束最大值点位于有效参数空间的内部。因此，MLE 就是无约束估计值：$\\hat{p}_{\\text{MLE}} = \\hat{p}_{\\text{unc}} = \\frac{\\sum_{i=1}^{m} k_i}{mn}$。\n- 如果 $\\hat{p}_{\\text{unc}} \\ge 1$，无约束最大值点位于有效区间的外部或上边界。由于 $\\ell(p)$ 是凹函数，其导数 $\\frac{d\\ell}{dp} = \\frac{S}{p} - mn = mn(\\frac{\\hat{p}_{\\text{unc}}}{p} - 1)$ 对所有 $p \\in (0, 1]$ 都是非负的，因为 $\\frac{\\hat{p}_{\\text{unc}}}{p} \\ge 1$。这意味着 $\\ell(p)$ 在 $(0, 1]$ 上是非递减的。因此，在区间 $[0, 1]$ 上的最大值必须在上边界 $p=1$ 处取得。所以，$\\hat{p}_{\\text{MLE}} = 1$。\n- 在 $S0$ 的情况下，$\\hat{p}_{\\text{unc}} \\le 0$ 的情况是不可能的，因为 $m$、$n$ 和 $S$ 都是正数。\n\n我们可以将这些情况合并为一个单一的表达式。由于 $\\sum k_i \\ge 0$，$m  0$ 且 $n  0$，无约束估计值 $\\hat{p}_{\\text{unc}}$ 始终是非负的。如果 $\\hat{p}_{\\text{unc}}$ 小于或等于 1，则 MLE 的值就是 $\\hat{p}_{\\text{unc}}$；否则为 1。这可以用最小值函数紧凑地写成：\n$$\\hat{p}_{\\text{MLE}} = \\min\\left(1, \\hat{p}_{\\text{unc}}\\right) = \\min\\left(1, \\frac{\\sum_{i=1}^{m} k_i}{mn}\\right)$$\n当所有 $k_i=0$ 时，此表达式的值正确地为 $0$；当 $0  \\frac{\\sum k_i}{mn}  1$ 时，其值为 $\\frac{\\sum k_i}{mn}$；当 $\\frac{\\sum k_i}{mn} \\ge 1$ 时，其值为 $1$。这就是在给定约束条件下，$p$ 的最大似然估计的最终闭式表达式。", "answer": "$$\\boxed{\\min\\left(1, \\frac{\\sum_{i=1}^{m} k_i}{mn}\\right)}$$", "id": "5112724"}]}