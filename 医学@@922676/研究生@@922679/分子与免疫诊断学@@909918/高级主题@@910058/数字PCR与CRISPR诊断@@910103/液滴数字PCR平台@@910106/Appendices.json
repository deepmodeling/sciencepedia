{"hands_on_practices": [{"introduction": "在我们能够计数阳性与阴性微滴之前，首先必须定义何为“阳性”微滴。本练习将探讨设定荧光阈值的统计学基础，以区分这两个群体，并最大限度地减少错误分类的概率。这是处理原始 ddPCR 数据至关重要的一步，它为后续分析中使用的计数 $k$ 和 $n$ 提供了基础 [@problem_id:5110901]。", "problem": "一个进行微滴数字聚合酶链式反应 (ddPCR) 分析的实验室，根据测量的任意单位 (AU) 荧光振幅，将微滴分为两类：目标阳性微滴和目标阴性微滴。根据经验，目标阳性微滴的振幅分布可以很好地用均值为 $\\mu_{+} = 8000$ AU、标准差为 $\\sigma_{+} = 700$ AU 的高斯（正态）分布来近似；而目标阴性微滴的振幅分布可以很好地用均值为 $\\mu_{-} = 500$ AU、标准差为 $\\sigma_{-} = 150$ AU 的高斯分布来近似。假设类别先验概率相等且误分类成本相等。\n\n考虑一个由单一振幅阈值 $T$ 定义的单调阈值分类器：振幅 $x \\geq T$ 的微滴被分类为目标阳性，而振幅 $x  T$ 的微滴被分类为目标阴性。仅使用正态分布的基本定义、等先验概率下的最大后验概率分类概念以及标准正态分布累积分布函数的性质，确定使总误分类概率最小化的阈值 $T$。然后，计算该最优阈值所能达到的最小总误分类概率。\n\n将最终的总误分类概率表示为小数（不带百分号）。将您的答案四舍五入到四位有效数字。", "solution": "用户提供了一个需要验证的问题陈述。\n\n### 第1步：提取已知条件\n-   目标阳性微滴的荧光振幅 $x$ 服从均值为 $\\mu_{+} = 8000$ AU、标准差为 $\\sigma_{+} = 700$ AU 的高斯分布。其概率密度函数 (PDF) 为 $p(x|+)$。\n-   目标阴性微滴的荧光振幅 $x$ 服从均值为 $\\mu_{-} = 500$ AU、标准差为 $\\sigma_{-} = 150$ AU 的高斯分布。其 PDF 为 $p(x|-)$。\n-   类别先验概率相等：$P(+) = P(-)$。由于只有两个类别，这意味着 $P(+) = P(-) = 0.5$。\n-   误分类成本相等。\n-   分类器使用单一阈值 $T$。如果 $x \\geq T$，微滴被分类为阳性。如果 $x  T$，则分类为阴性。\n-   目标是找到使总误分类概率最小化的阈值 $T$，然后计算这个最小概率。\n-   解决方案必须使用基本定义、最大后验概率 (MAP) 分类以及标准正态累积分布函数 (CDF) 的性质。\n-   最终概率必须是四舍五入到四位有效数字的小数。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当且客观。它描述了一个使用贝叶斯决策理论的标准二元分类问题，这是统计信号处理和机器学习的基石。应用于ddPCR是一个现实且常见的场景。提供的数值在物理上是合理的。问题是自洽的，提供了推導唯一解所需的所有必要信息。没有矛盾、歧义或伪科学的主张。\n\n### 第3步：结论和行动\n问题有效。将提供详细的解决方案。\n\n### 求解推导\n\n目标是找到使总误分类概率 $P_e$ 最小化的决策阈值 $T$。问题指定了一个最大后验概率 (MAP) 分类器。MAP 分类器通过将测量值 $x$ 分配给具有最高后验概率 $P(C|x)$ 的类别 $C$ 来最小化 $P_e$。决策规则是，如果 $P(+|x) > P(-|x)$ 则选择阳性类别，如果 $P(-|x) > P(+|x)$ 则选择阴性类别。决策边界，在本例中即阈值 $T$，是后验概率相等的地方：\n$$P(+|T) = P(-|T)$$\n使用贝叶斯定理 $P(C|x) = \\frac{p(x|C)P(C)}{p(x)}$，我们可以将该条件重写为：\n$$\\frac{p(T|+)P(+)}{p(T)} = \\frac{p(T|-)P(-)}{p(T)}$$\n$p(T)$ 项可以消掉。鉴于类别先验概率相等，$P(+) = P(-)$，它们也可以消掉。因此，最优阈值 $T$ 可以通过令类条件概率密度函数（也称为似然函数）相等来找到：\n$$p(T|+) = p(T|-)$$\n概率密度函数是高斯分布，其通用形式为 $p(x; \\mu, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$。代入特定的分布：\n$$\\frac{1}{\\sqrt{2\\pi}\\sigma_{+}} \\exp\\left(-\\frac{(T-\\mu_{+})^2}{2\\sigma_{+}^2}\\right) = \\frac{1}{\\sqrt{2\\pi}\\sigma_{-}} \\exp\\left(-\\frac{(T-\\mu_{-})^2}{2\\sigma_{-}^2}\\right)$$\n为了求解 $T$，我们对两边取自然对数：\n$$-\\ln(\\sigma_{+}) - \\frac{(T-\\mu_{+})^2}{2\\sigma_{+}^2} = -\\ln(\\sigma_{-}) - \\frac{(T-\\mu_{-})^2}{2\\sigma_{-}^2}$$\n整理各项可得：\n$$2\\ln\\left(\\frac{\\sigma_{+}}{\\sigma_{-}}\\right) = \\frac{(T-\\mu_{-})^2}{\\sigma_{-}^2} - \\frac{(T-\\mu_{+})^2}{\\sigma_{+}^2}$$\n展开平方项并按 $T$ 的幂次合并同类项：\n$$2\\ln\\left(\\frac{\\sigma_{+}}{\\sigma_{-}}\\right) = \\left(\\frac{T^2 - 2T\\mu_{-} + \\mu_{-}^2}{\\sigma_{-}^2}\\right) - \\left(\\frac{T^2 - 2T\\mu_{+} + \\mu_{+}^2}{\\sigma_{+}^2}\\right)$$\n$$T^2\\left(\\frac{1}{\\sigma_{-}^2} - \\frac{1}{\\sigma_{+}^2}\\right) - 2T\\left(\\frac{\\mu_{-}}{\\sigma_{-}^2} - \\frac{\\mu_{+}}{\\sigma_{+}^2}\\right) + \\left(\\frac{\\mu_{-}^2}{\\sigma_{-}^2} - \\frac{\\mu_{+}^2}{\\sigma_{+}^2}\\right) - 2\\ln\\left(\\frac{\\sigma_{+}}{\\sigma_{-}}\\right) = 0$$\n这是一个 $AT^2 + BT + C = 0$ 形式的二次方程，其中：\n$A = \\frac{1}{\\sigma_{-}^2} - \\frac{1}{\\sigma_{+}^2}$\n$B = -2\\left(\\frac{\\mu_{-}}{\\sigma_{-}^2} - \\frac{\\mu_{+}}{\\sigma_{+}^2}\\right)$\n$C = \\frac{\\mu_{-}^2}{\\sigma_{-}^2} - \\frac{\\mu_{+}^2}{\\sigma_{+}^2} - 2\\ln\\left(\\frac{\\sigma_{+}}{\\sigma_{-}}\\right)$\n\n代入给定值：$\\mu_{+} = 8000$, $\\sigma_{+} = 700$, $\\mu_{-} = 500$, $\\sigma_{-} = 150$。\n$\\sigma_{+}^2 = 490000$, $\\sigma_{-}^2 = 22500$。\n$A = \\frac{1}{22500} - \\frac{1}{490000} \\approx 4.4444 \\times 10^{-5} - 2.0408 \\times 10^{-6} \\approx 4.2404 \\times 10^{-5}$\n$B = -2\\left(\\frac{500}{22500} - \\frac{8000}{490000}\\right) = -2\\left(0.02222... - 0.01632...\\right) \\approx -0.011791$\n$C = \\frac{500^2}{22500} - \\frac{8000^2}{490000} - 2\\ln\\left(\\frac{700}{150}\\right) \\approx 11.111... - 130.612... - 2\\ln(4.666...) \\approx -119.501 - 2(1.5404) \\approx -122.582$\n\n方程 $AT^2 + BT + C = 0$ 的解为 $T = \\frac{-B \\pm \\sqrt{B^2-4AC}}{2A}$。\n使用高精度值的系数：\n$A \\approx 4.2403628 \\times 10^{-5}$\n$B \\approx -0.011791383$\n$C \\approx -122.58209$\n判别式为 $D = B^2 - 4AC \\approx (-0.01179)^2 - 4(4.240 \\times 10^{-5})(-122.58) \\approx 1.390 \\times 10^{-4} + 0.020786 \\approx 0.020925$。\n$\\sqrt{D} \\approx 0.144655$。\n$T$ 的两个根是：\n$T_1 = \\frac{0.011791 + 0.144655}{2(4.2404 \\times 10^{-5})} \\approx \\frac{0.156446}{8.4808 \\times 10^{-5}} \\approx 1844.75$\n$T_2 = \\frac{0.011791 - 0.144655}{2(4.2404 \\times 10^{-5})} \\approx \\frac{-0.132864}{8.4808 \\times 10^{-5}} \\approx -1566.66$\n正确的阈值必须位于两个均值 $\\mu_{-} = 500$ 和 $\\mu_{+} = 8000$ 之间。因此，具有物理意义的解是 $T \\approx 1801.94$。我们来重新验证一下 $C$ 项。\n我上面的系数有一个符号错误。让我使用我推导的第一个方程：\n$T^2\\left(\\frac{1}{\\sigma_{+}^2} - \\frac{1}{\\sigma_{-}^2}\\right) + 2T\\left(\\frac{\\mu_{-}}{\\sigma_{-}^2} - \\frac{\\mu_{+}}{\\sigma_{+}^2}\\right) + \\left(\\frac{\\mu_{+}^2}{\\sigma_{+}^2} - \\frac{\\mu_{-}^2}{\\sigma_{-}^2} - 2\\ln\\frac{\\sigma_{+}}{\\sigma_{-}}\\right) = 0$。\n$A' = \\frac{1}{\\sigma_{+}^2} - \\frac{1}{\\sigma_{-}^2} \\approx -4.2404 \\times 10^{-5}$。\n$B' = 2\\left(\\frac{\\mu_{-}}{\\sigma_{-}^2} - \\frac{\\mu_{+}}{\\sigma_{+}^2}\\right) \\approx 0.011791$\n$C' = \\frac{\\mu_{+}^2}{\\sigma_{+}^2} - \\frac{\\mu_{-}^2}{\\sigma_{-}^2} - 2\\ln\\left(\\frac{\\sigma_{+}}{\\sigma_{-}}\\right) \\approx 130.612 - 11.111 - 2(1.5404) = 119.501 - 3.0808 \\approx 116.42$。\n$T = \\frac{-B' \\pm \\sqrt{B'^2-4A'C'}}{2A'}$。\n$B'^2 - 4A'C' \\approx (0.011791)^2 - 4(-4.2404\\times10^{-5})(116.42) \\approx 1.390\\times10^{-4} + 0.019749 \\approx 0.019888$。\n$\\sqrt{B'^2-4A'C'} \\approx 0.14102$。\n$T = \\frac{-0.011791 \\pm 0.14102}{2(-4.2404\\times10^{-5})} = \\frac{-0.011791 \\pm 0.14102}{-8.4808 \\times 10^{-5}}$。\n$T_1 = \\frac{0.12923}{-8.4808 \\times 10^{-5}} \\approx -1523.8$。\n$T_2 = \\frac{-0.15281}{-8.4808 \\times 10^{-5}} \\approx 1801.9$。\n正确的阈值是 $T \\approx 1801.9$。使用高精度值， $T = 1801.936$。\n\n接下来，我们计算最小总误分类概率 $P_e$。\n$P_e = P(\\text{错误}) = P(\\text{分类为 } - | +)P(+) + P(\\text{分类为 } + | -)P(-)$。\n$P_e = P(x  T | +)P(+) + P(x \\ge T | -)P(-)$。\n由于 $P(+) = P(-) = 0.5$，我们得到：\n$P_e = 0.5 \\left[ P(x  T | +) + P(x \\ge T | -) \\right]$。\n这些概率是通过对相应的高斯 PDF 进行积分来计算的。它们可以用标准正态分布的累积分布函数 (CDF) 表示，即 $\\Phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{z} \\exp(-u^2/2) du$。\n$P(x  T | +) = \\Phi\\left(\\frac{T-\\mu_{+}}{\\sigma_{+}}\\right)$\n$P(x \\ge T | -) = 1 - P(x  T | -) = 1 - \\Phi\\left(\\frac{T-\\mu_{-}}{\\sigma_{-}}\\right) = \\Phi\\left(-\\frac{T-\\mu_{-}}{\\sigma_{-}}\\right) = \\Phi\\left(\\frac{\\mu_{-}-T}{\\sigma_{-}}\\right)$。\n所以，$P_e = 0.5 \\left[ \\Phi\\left(\\frac{T-\\mu_{+}}{\\sigma_{+}}\\right) + \\Phi\\left(\\frac{\\mu_{-}-T}{\\sigma_{-}}\\right) \\right]$。\n使用 $T = 1801.936$：\n第一项的参数是 $z_{+} = \\frac{1801.936 - 8000}{700} \\approx -8.85438$。\n第二项的参数是 $z_{-} = \\frac{500 - 1801.936}{150} \\approx -8.67957$。\n$P_e = 0.5 \\left[ \\Phi(-8.85438) + \\Phi(-8.67957) \\right]$。\n使用标准正态CDF的标准数值计算：\n$\\Phi(-8.85438) \\approx 4.0973 \\times 10^{-19}$\n$\\Phi(-8.67957) \\approx 2.0463 \\times 10^{-18}$\n$P_e = 0.5 \\left[ (4.0973 \\times 10^{-19}) + (2.0463 \\times 10^{-18}) \\right]$\n$P_e = 0.5 \\left[ (0.40973 \\times 10^{-18}) + (2.0463 \\times 10^{-18}) \\right]$\n$P_e = 0.5 \\left[ 2.45603 \\times 10^{-18} \\right]$\n$P_e = 1.228015 \\times 10^{-18}$\n四舍五入到四位有效数字，最小总误分类概率为 $1.228 \\times 10^{-18}$。\n写成小数形式，即为 $0.000000000000000001228$。", "answer": "$$\\boxed{1.228 \\times 10^{-18}}$$", "id": "5110901"}, {"introduction": "一旦对微滴进行分类，下一步便是将原始计数转换为有意义的浓度值。本练习演示如何运用泊松（Poisson）分子分配模型来估计目标浓度，以及至关重要的是，如何通过构建置信区间来量化该估计的统计不确定性 [@problem_id:5110876]。", "problem": "使用微滴式数字聚合酶链反应 (ddPCR) 进行定量分析。将一个样本分割成 $n$ 个等体积的微滴，并对发出荧光的阳性微滴进行计数。假设采用标准分配模型：目标分子根据泊松过程分布在微滴中，每个微滴的平均占有数为 $\\lambda$ 个拷贝。在此模型下，一个微滴为阴性的概率是 $\\exp(-\\lambda)$，因此一个微滴为阳性的概率是 $p = 1 - \\exp(-\\lambda)$。浓度 $c$（单位体积内的拷贝数）与平均占有数的关系为 $\\lambda = c \\, v$，其中 $v$ 是微滴的体积。\n\n在一次实验中，分析了 $n = 20{,}000$ 个体积为 $v = 0.85$ 纳升的微滴，其中 $k = 150$ 个微滴被分类为阳性。将观察到的阳性微滴数视为参数为 $p$ 的二项分布样本，使用精确的 Clopper–Pearson 方法或 Wilson score 方法构建 $p$ 的 $95\\%$ 置信区间，然后通过单调变换 $\\lambda = -\\ln(1 - p)$ 和 $c = \\lambda / v$ 将该区间的端点映射为浓度 $c$ 的置信区间。将最终的 $c$ 的区间表示为“拷贝数/微升”。将区间的两个端点四舍五入到四位有效数字。", "solution": "该问题提供了进行ddPCR分析后得到的原始数据，并要求我们为目标分子的浓度$c$构建一个95%的置信区间。我们将遵循问题中建议的步骤：首先使用Wilson score方法计算阳性比例$p$的置信区间，然后通过给定的变换函数将其映射到浓度$c$的置信区间。\n\n### 步骤1：验证问题陈述\n-   已知量：微滴总数 $n = 20,000$；阳性微滴数 $k = 150$；微滴体积 $v = 0.85$ nL。\n-   模型：泊松分布 $\\lambda = c \\cdot v$；阳性概率 $p = 1 - e^{-\\lambda}$；二项式采样 $K \\sim \\text{Binomial}(n, p)$。\n-   任务：使用Wilson score方法计算浓度$c$的95%置信区间。\n-   问题陈述清晰、数据完整，并且所要求的方法（Wilson score区间和函数变换）是统计学中的标准实践。问题是有效的。\n\n### 步骤2：计算阳性比例 `p` 的置信区间\n\n首先，计算阳性比例的点估计值：\n$$ \\hat{p} = \\frac{k}{n} = \\frac{150}{20,000} = 0.0075 $$\n对于95%的置信水平，$\\alpha = 0.05$，对应的z-score为 $z_{\\alpha/2} = 1.96$。为了提高精度，我们使用更精确的值 $z_{0.025} \\approx 1.959964$。\n\nWilson score区间的端点 $(p_L, p_U)$ 由以下公式给出：\n$$ (p_L, p_U) = \\frac{1}{1 + z^2/n} \\left( \\hat{p} + \\frac{z^2}{2n} \\mp z \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n} + \\frac{z^2}{4n^2}} \\right) $$\n代入数值：\n-   $z^2 \\approx (1.959964)^2 \\approx 3.84146$\n-   $z^2/n \\approx 3.84146 / 20000 \\approx 0.000192073$\n-   $1 / (1 + z^2/n) \\approx 1 / 1.000192073 \\approx 0.99980795$\n-   $\\hat{p} + \\frac{z^2}{2n} \\approx 0.0075 + \\frac{3.84146}{40000} \\approx 0.0075 + 0.0000960365 = 0.0075960365$\n-   $\\frac{\\hat{p}(1-\\hat{p})}{n} = \\frac{0.0075 \\times 0.9925}{20000} \\approx 3.721875 \\times 10^{-7}$\n-   $\\frac{z^2}{4n^2} = \\frac{3.84146}{4 \\times (20000)^2} \\approx 2.4009 \\times 10^{-9}$\n-   平方根项：$\\sqrt{3.721875 \\times 10^{-7} + 2.4009 \\times 10^{-9}} \\approx \\sqrt{3.745884 \\times 10^{-7}} \\approx 0.000612036$\n-   $z$乘以平方根项：$1.959964 \\times 0.000612036 \\approx 0.00119956$\n\n现在计算区间的上下限：\n-   $p_L \\approx 0.99980795 \\times (0.0075960365 - 0.00119956) = 0.99980795 \\times 0.0063964765 \\approx 0.00639524$\n-   $p_U \\approx 0.99980795 \\times (0.0075960365 + 0.00119956) = 0.99980795 \\times 0.0087955965 \\approx 0.00879391$\n\n因此，$p$的95%置信区间约为 $[0.00639524, 0.00879391]$。\n\n### 步骤3：将置信区间转换为浓度 `c`\n\n浓度$c$与$p$的关系为 $c(p) = \\frac{\\lambda}{v} = \\frac{-\\ln(1-p)}{v}$。\n该函数在定义域 $p \\in [0, 1)$ 上是单调递增的。因此，我们可以通过将$p$区间的端点代入该函数来找到$c$的置信区间的端点。\n首先，转换体积单位：$v = 0.85 \\text{ nL} = 0.85 \\times 10^{-3} \\mu\\text{L}$。\n\n计算浓度区间的下限 $c_L$：\n$$ c_L = \\frac{-\\ln(1-p_L)}{v} \\approx \\frac{-\\ln(1 - 0.00639524)}{0.00085} = \\frac{-\\ln(0.99360476)}{0.00085} \\approx \\frac{0.0064159}{0.00085} \\approx 7.5481 \\text{ 拷贝数/\\mu L} $$\n计算浓度区间的上限 $c_U$：\n$$ c_U = \\frac{-\\ln(1-p_U)}{v} \\approx \\frac{-\\ln(1 - 0.00879391)}{0.00085} = \\frac{-\\ln(0.99120609)}{0.00085} \\approx \\frac{0.0088326}{0.00085} \\approx 10.3913 \\text{ 拷贝数/\\mu L} $$\n\n### 步骤4：最终答案\n将区间的两个端点四舍五入到四位有效数字，我们得到浓度$c$的95%置信区间为 $[7.548, 10.39]$ 拷贝数/微升。", "answer": "$$ \\boxed{\\begin{pmatrix} 7.548  10.39 \\end{pmatrix}} $$", "id": "5110876"}, {"introduction": "ddPCR 的一个主要优势在于其能够进行精确的相对定量，这对于拷贝数变异 (CNV) 等应用至关重要。本练习在绝对定量的基础上，指导您计算目标基因与参考基因的浓度比率，并评估该比率的统计误差，从而为真实的诊断应用提供一个完整的分析框架 [@problem_id:5110925]。", "problem": "一个临床实验室正在使用微滴数字聚合酶链式反应 (droplet digital Polymerase Chain Reaction, ddPCR) 来量化目标基因相对于参考基因的拷贝数变异 (copy number variation, CNV)。在相同条件下进行了两次平行的 ddPCR 反应，每次反应都将反应混合物分配到 $n = 20{,}000$ 个等体积的微滴中。对于目标基因检测，观察到的阳性微滴数为 $k_t = 8000$；对于参考基因检测，观察到的阳性微滴数为 $k_r = 10{,}000$。假设对于每次检测，模板分子根据泊松模型随机分配到各个微滴中，每个微滴的平均模板占有数为 $\\lambda$，并且如果一个微滴含有一个或多个模板分子，则该微滴被称为阳性。阳性微滴的观察结果遵循二项分布，成功概率为 $p = 1 - \\exp(-\\lambda)$，且各个微滴之间相互独立。同时，假设目标基因检测和参考基因检测相互独立，并且没有串扰或“雨点”（rain）现象。\n\n从 ddPCR 分配和阳性判定的这些基本定义出发，推导出每次检测中每个微滴平均占有数 $\\lambda$ 的最大似然估计量，然后构建 CNV 比率 $\\rho = \\lambda_t / \\lambda_r$ 的估计量。接下来，使用基于泰勒展开的一阶近似（delta 方法），并将两次检测视为独立的，推导出该比率估计量的渐近标准误差的解析表达式，并根据给定数据进行数值计算。将 CNV 比率及其标准误差以两个数字的形式报告。将两个数字都四舍五入到四位有效数字。CNV 比率是无量纲的，因此报告结果时无需单位。", "solution": "该问题要求从微滴数字 PCR (ddPCR) 数据中推导并计算拷贝数变异 (CNV) 比率及其标准误差。解决过程分几个步骤：首先，推导每个微滴平均模板占有数 ($\\lambda$) 的最大似然估计量 (MLE)；其次，构建比率 $\\rho = \\lambda_t / \\lambda_r$ 的估计量；第三，使用 delta 方法推导这些估计量的渐近方差；最后，根据给定数据计算数值。\n\n### 步骤 1：$\\lambda$ 的最大似然估计量\n\n对于单次 ddPCR 检测，微滴总数为 $n$，观察到的阳性微滴数为 $k$。假设模板分子的分配遵循泊松分布。一个给定微滴不含任何模板分子的概率为 $P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$，其中 $\\lambda$ 是每个微滴的平均分子数。如果一个微滴含有一个或多个分子，则为阳性。因此，一个微滴为阳性的概率 $p$ 是：\n$$p = P(X \\ge 1) = 1 - P(X=0) = 1 - \\exp(-\\lambda)$$\n在总共 $n$ 个独立微滴中，阳性微滴数 $k$ 遵循二项分布，$K \\sim \\text{Binomial}(n, p)$。观察到 $k$ 个阳性微滴的似然函数是：\n$$L(p|k) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n代入 $p = 1 - \\exp(-\\lambda)$ 和 $1-p = \\exp(-\\lambda)$，我们可以用 $\\lambda$ 来表示似然函数：\n$$L(\\lambda|k) = \\binom{n}{k} (1 - \\exp(-\\lambda))^k (\\exp(-\\lambda))^{n-k} = \\binom{n}{k} (1 - \\exp(-\\lambda))^k \\exp(-\\lambda(n-k))$$\n为了找到 $\\lambda$ 的最大似然估计量 (MLE)，我们最大化对数似然函数 $\\ell(\\lambda) = \\ln(L(\\lambda|k))$：\n$$\\ell(\\lambda) = \\ln\\binom{n}{k} + k \\ln(1 - \\exp(-\\lambda)) - \\lambda(n-k)$$\n我们将 $\\ell(\\lambda)$ 对 $\\lambda$ 求导，并令结果为零：\n$$\\frac{d\\ell}{d\\lambda} = k \\left(\\frac{\\exp(-\\lambda)}{1 - \\exp(-\\lambda)}\\right) - (n-k) = 0$$\n求解 $\\lambda$：\n$$k \\exp(-\\lambda) = (n-k)(1 - \\exp(-\\lambda))$$\n$$k \\exp(-\\lambda) = n - k - (n-k)\\exp(-\\lambda)$$\n$$(k + n - k)\\exp(-\\lambda) = n - k$$\n$$n \\exp(-\\lambda) = n - k$$\n$$\\exp(-\\lambda) = \\frac{n-k}{n} = 1 - \\frac{k}{n}$$\n$$\\hat{\\lambda}_{\\text{MLE}} = -\\ln\\left(1 - \\frac{k}{n}\\right)$$\n这就是每个微滴平均分子数的 MLE。\n\n### 步骤 2：CNV 比率 $\\rho$ 的估计量\n\nCNV 比率定义为 $\\rho = \\lambda_t / \\lambda_r$。根据最大似然估计量的不变性，参数函数的 MLE 就是这些参数的 MLE 的函数。因此，比率 $\\rho$ 的估计量是：\n$$\\hat{\\rho} = \\frac{\\hat{\\lambda}_t}{\\hat{\\lambda}_r} = \\frac{-\\ln\\left(1 - \\frac{k_t}{n}\\right)}{-\\ln\\left(1 - \\frac{k_r}{n}\\right)}$$\n其中 $k_t$ 和 $k_r$ 分别是目标基因和参考基因检测的阳性微滴计数。\n\n### 步骤 3：$\\hat{\\rho}$ 的渐近标准误差\n\n为了求出 $\\hat{\\rho}$ 的标准误差，我们使用 delta 方法进行不确定性传播。对于两个独立随机变量 $X$ 和 $Y$ 的比率 $R = X/Y$，其相对方差约等于 $X$ 和 $Y$ 的相对方差之和：\n$$\\frac{\\text{Var}(\\hat{\\rho})}{\\hat{\\rho}^2} \\approx \\frac{\\text{Var}(\\hat{\\lambda}_t)}{\\hat{\\lambda}_t^2} + \\frac{\\text{Var}(\\hat{\\lambda}_r)}{\\hat{\\lambda}_r^2}$$\n这需要我们首先求出估计量 $\\hat{\\lambda}$ 的方差。我们对 $\\hat{\\lambda} = f(k/n) = -\\ln(1-k/n)$ 应用 delta 方法。$\\hat{\\lambda}$ 的方差近似为：\n$$\\text{Var}(\\hat{\\lambda}) \\approx \\left( f'\\left(E\\left[\\frac{k}{n}\\right]\\right) \\right)^2 \\text{Var}\\left(\\frac{k}{n}\\right)$$\n这里，$E[k/n] = p$ 且 $\\text{Var}(k/n) = \\frac{1}{n^2}\\text{Var}(k) = \\frac{np(1-p)}{n^2} = \\frac{p(1-p)}{n}$。函数 $f(x) = -\\ln(1-x)$ 的导数是 $f'(x) = \\frac{1}{1-x}$。在 $x=p$ 处求值，得到 $\\frac{1}{1-p}$。\n将这些代入方差近似式中：\n$$\\text{Var}(\\hat{\\lambda}) \\approx \\left(\\frac{1}{1-p}\\right)^2 \\frac{p(1-p)}{n} = \\frac{p}{n(1-p)}$$\n为了得到该方差的一个实用估计量，我们用样本比例 $\\hat{p} = k/n$ 代替真实概率 $p$：\n$$\\widehat{\\text{Var}}(\\hat{\\lambda}) = \\frac{k/n}{n(1-k/n)} = \\frac{k}{n^2(n-k)/n} = \\frac{k}{n(n-k)}$$\n现在我们可以构建 $\\hat{\\rho}$ 方差的估计量：\n$$\\widehat{\\text{Var}}(\\hat{\\rho}) = \\hat{\\rho}^2 \\left( \\frac{\\widehat{\\text{Var}}(\\hat{\\lambda}_t)}{\\hat{\\lambda}_t^2} + \\frac{\\widehat{\\text{Var}}(\\hat{\\lambda}_r)}{\\hat{\\lambda}_r^2} \\right)$$\n$$\\widehat{\\text{Var}}(\\hat{\\rho}) = \\left( \\frac{\\hat{\\lambda}_t}{\\hat{\\lambda}_r} \\right)^2 \\left( \\frac{k_t}{n(n-k_t)\\hat{\\lambda}_t^2} + \\frac{k_r}{n(n-k_r)\\hat{\\lambda}_r^2} \\right)$$\n$\\hat{\\rho}$ 的标准误差，记作 $\\text{SE}(\\hat{\\rho})$，是此方差的平方根：\n$$\\text{SE}(\\hat{\\rho}) = \\sqrt{\\widehat{\\text{Var}}(\\hat{\\rho})} = |\\hat{\\rho}| \\sqrt{ \\frac{k_t}{n(n-k_t)\\hat{\\lambda}_t^2} + \\frac{k_r}{n(n-k_r)\\hat{\\lambda}_r^2} }$$\n\n### 步骤 4：数值计算\n\n给定的数据是：\n- 微滴总数: $n = 20000$\n- 目标基因阳性微滴数: $k_t = 8000$\n- 参考基因阳性微滴数: $k_r = 10000$\n\n首先，计算 $\\lambda_t$ 和 $\\lambda_r$ 的 MLE：\n$$\\hat{\\lambda}_t = -\\ln\\left(1 - \\frac{8000}{20000}\\right) = -\\ln(1 - 0.4) = -\\ln(0.6) \\approx 0.5108256$$\n$$\\hat{\\lambda}_r = -\\ln\\left(1 - \\frac{10000}{20000}\\right) = -\\ln(1 - 0.5) = -\\ln(0.5) \\approx 0.6931472$$\n\n接下来，计算估计的 CNV 比率 $\\hat{\\rho}$：\n$$\\hat{\\rho} = \\frac{\\hat{\\lambda}_t}{\\hat{\\lambda}_r} \\approx \\frac{0.5108256}{0.6931472} \\approx 0.7369656$$\n四舍五入到四位有效数字，$\\hat{\\rho} \\approx 0.7370$。\n\n现在，计算 $\\hat{\\lambda}_t$ 和 $\\hat{\\lambda}_r$ 的估计方差：\n$$\\widehat{\\text{Var}}(\\hat{\\lambda}_t) = \\frac{k_t}{n(n-k_t)} = \\frac{8000}{20000(20000 - 8000)} = \\frac{8000}{20000 \\cdot 12000} = \\frac{1}{30000}$$\n$$\\widehat{\\text{Var}}(\\hat{\\lambda}_r) = \\frac{k_r}{n(n-k_r)} = \\frac{10000}{20000(20000 - 10000)} = \\frac{10000}{20000 \\cdot 10000} = \\frac{1}{20000}$$\n\n最后，计算比率的标准误差 $\\text{SE}(\\hat{\\rho})$：\n$$\\text{SE}(\\hat{\\rho}) = |\\hat{\\rho}| \\sqrt{ \\frac{\\widehat{\\text{Var}}(\\hat{\\lambda}_t)}{\\hat{\\lambda}_t^2} + \\frac{\\widehat{\\text{Var}}(\\hat{\\lambda}_r)}{\\hat{\\lambda}_r^2} }$$\n$$\\text{SE}(\\hat{\\rho}) \\approx 0.7369656 \\sqrt{ \\frac{1/30000}{(0.5108256)^2} + \\frac{1/20000}{(0.6931472)^2} }$$\n$$\\text{SE}(\\hat{\\rho}) \\approx 0.7369656 \\sqrt{ \\frac{1}{30000 \\cdot 0.2609428} + \\frac{1}{20000 \\cdot 0.4804530} }$$\n$$\\text{SE}(\\hat{\\rho}) \\approx 0.7369656 \\sqrt{ 1.27741 \\times 10^{-4} + 1.04068 \\times 10^{-4} }$$\n$$\\text{SE}(\\hat{\\rho}) \\approx 0.7369656 \\sqrt{ 2.31809 \\times 10^{-4} }$$\n$$\\text{SE}(\\hat{\\rho}) \\approx 0.7369656 \\cdot 0.0152253$$\n$$\\text{SE}(\\hat{\\rho}) \\approx 0.0112205$$\n四舍五入到四位有效数字，$\\text{SE}(\\hat{\\rho}) \\approx 0.01122$。\n\nCNV 比率约为 $0.7370$，其标准误差约为 $0.01122$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7370  0.01122\n\\end{pmatrix}\n}\n$$", "id": "5110925"}]}