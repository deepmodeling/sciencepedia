{"hands_on_practices": [{"introduction": "本练习旨在阐明数字PCR定量分析的基石。我们将从分子随机分配到数千个独立反应单元这一遵循泊松统计的基本过程入手。通过掌握这一统计学基础，您将学习如何从阳性反应单元的比例中推导出每个分区平均分子数的最大似然估计值 $\\lambda$，并最终将其转化为样本的绝对浓度，这是所有dPCR数据分析中的一项核心技能。[@problem_id:5098729]", "problem": "一种基于芯片的数字聚合酶链式反应 (dPCR) 检测法被用于量化来自与分子和免疫诊断相关的临床样本中的单一基因靶标。该微流控芯片将反应分配到 $N=20{,}000$ 个纳米孔中，每个纳米孔的体积为 $v=1.2\\,\\mathrm{nL}$。经过终点扩增和荧光成像后，有 $k=3{,}000$ 个纳米孔被归类为阳性。假设靶分子在各个分区中随机且独立地分布，进入每个纳米孔的分子数量是一个均值为 $\\lambda$ 的泊松随机变量，并且如果一个纳米孔含有至少一个靶分子，则称其为阳性。\n\n从分子分配的泊松定律以及阳性是零计数事件的互补事件这一定义出发，推导出 $\\lambda$ 关于 $N$ 和 $k$ 的最大似然估计量。然后，利用平均占有率和体积浓度之间的关系，计算以 拷贝数/$\\mu\\mathrm{L}$ 为单位的估计靶标浓度 $c$。请仔细考虑 $\\mathrm{nL}$ 和 $\\mu\\mathrm{L}$ 之间的单位换算。将 $c$ 的最终数值答案四舍五入至四位有效数字，并以 拷贝数/$\\mu\\mathrm{L}$ 为单位表示。", "solution": "本题要求推导每个纳米孔中靶分子平均数 $\\lambda$ 的最大似然估计量，并随后计算以 拷贝数/微升 为单位的靶标浓度 $c$。\n\n设 $X_i$ 为第 $i$ 个纳米孔中的靶分子数量，其中 $i = 1, 2, \\dots, N$。题目指出 $X_i$ 服从均值为 $\\lambda$ 的泊松分布。其概率质量函数为：\n$$P(X_i = m) = \\frac{\\lambda^m \\exp(-\\lambda)}{m!}$$\n其中 $m$ 是一个代表分子数量的非负整数。\n\n如果一个纳米孔含有至少一个靶分子，即 $X_i \\ge 1$，则定义其为阳性。其互补事件是阴性纳米孔，即含有零个分子，$X_i = 0$。一个纳米孔为阴性的概率是：\n$$P(X_i = 0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n因此，一个纳米孔为阳性的概率 $p$ 是：\n$$p = P(X_i \\ge 1) = 1 - P(X_i = 0) = 1 - \\exp(-\\lambda)$$\n\n该实验包含观察 $N$ 个独立的纳米孔。这可以被建模为一系列 $N$ 次伯努利试验，其中成功事件为一个阳性纳米孔。阳性纳米孔的总数 $k$ 服从参数为 $N$ 和 $p$ 的二项分布：\n$$P(k | N, p) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n为了找到 $\\lambda$ 的最大似然估计量 (MLE)，我们首先通过代入 $p = 1 - \\exp(-\\lambda)$ 和 $(1-p) = \\exp(-\\lambda)$，将似然函数 $L$ 写成关于 $\\lambda$ 的表达式：\n$$L(\\lambda | k, N) = \\binom{N}{k} (1 - \\exp(-\\lambda))^k (\\exp(-\\lambda))^{N-k}$$\n在分析上，最大化对数似然函数 $\\ln L$ 更为方便：\n$$\\ln L(\\lambda | k, N) = \\ln\\left[\\binom{N}{k}\\right] + k \\ln(1 - \\exp(-\\lambda)) + (N-k) \\ln(\\exp(-\\lambda))$$\n$$\\ln L(\\lambda | k, N) = \\ln\\left[\\binom{N}{k}\\right] + k \\ln(1 - \\exp(-\\lambda)) - \\lambda(N-k)$$\n为了找到使该函数最大化的 $\\lambda$ 值，我们对 $\\lambda$ 求一阶导数并令其为零。项 $\\ln\\left[\\binom{N}{k}\\right]$ 相对于 $\\lambda$ 是一个常数。\n$$\\frac{d}{d\\lambda} \\ln L(\\lambda | k, N) = k \\cdot \\frac{1}{1 - \\exp(-\\lambda)} \\cdot (-\\exp(-\\lambda)) \\cdot (-1) - (N-k)$$\n$$\\frac{d}{d\\lambda} \\ln L(\\lambda | k, N) = \\frac{k \\exp(-\\lambda)}{1 - \\exp(-\\lambda)} - (N-k)$$\n将导数设为零以求得最大似然估计量，记为 $\\hat{\\lambda}$：\n$$\\frac{k \\exp(-\\hat{\\lambda})}{1 - \\exp(-\\hat{\\lambda})} = N-k$$\n$$k \\exp(-\\hat{\\lambda}) = (N-k)(1 - \\exp(-\\hat{\\lambda}))$$\n$$k \\exp(-\\hat{\\lambda}) = (N-k) - (N-k)\\exp(-\\hat{\\lambda})$$\n$$k \\exp(-\\hat{\\lambda}) + (N-k)\\exp(-\\hat{\\lambda}) = N-k$$\n$$N \\exp(-\\hat{\\lambda}) = N-k$$\n$$\\exp(-\\hat{\\lambda}) = \\frac{N-k}{N} = 1 - \\frac{k}{N}$$\n通过对两边取自然对数来求解 $\\hat{\\lambda}$：\n$$-\\hat{\\lambda} = \\ln\\left(1 - \\frac{k}{N}\\right)$$\n$$\\hat{\\lambda} = -\\ln\\left(1 - \\frac{k}{N}\\right)$$\n这就是 $\\lambda$ 关于 $N$ 和 $k$ 的最大似然估计量。\n\n现在，我们使用给定的数值来计算 $\\hat{\\lambda}$。\n已知：\n纳米孔总数，$N = 20000$。\n阳性纳米孔数量，$k = 3000$。\n$$\\hat{\\lambda} = -\\ln\\left(1 - \\frac{3000}{20000}\\right) = -\\ln\\left(1 - 0.15\\right) = -\\ln(0.85)$$\n$$\\hat{\\lambda} \\approx 0.1625189$$\n\n浓度 $c$ 是单位体积内的平均分子数。单个纳米孔中的平均分子数是 $\\lambda$，单个纳米孔的体积是 $v$。因此，估计浓度 $\\hat{c}$ 为：\n$$\\hat{c} = \\frac{\\hat{\\lambda}}{v}$$\n已知：\n每个纳米孔的体积，$v = 1.2\\,\\mathrm{nL}$。\n题目要求浓度以 拷贝数/$\\mu\\mathrm{L}$ 为单位。我们必须进行单位换算。\n$1\\,\\mu\\mathrm{L} = 1000\\,\\mathrm{nL}$，所以 $1\\,\\mathrm{nL} = 10^{-3}\\,\\mu\\mathrm{L}$。\n$$v = 1.2 \\times 10^{-3}\\,\\mu\\mathrm{L}$$\n现在我们可以计算估计浓度 $\\hat{c}$：\n$$\\hat{c} = \\frac{-\\ln(0.85)}{1.2 \\times 10^{-3}\\,\\mu\\mathrm{L}} \\approx \\frac{0.1625189}{1.2 \\times 10^{-3}} \\frac{\\text{copies}}{\\mu\\mathrm{L}}$$\n$$\\hat{c} \\approx 135.43244\\,\\frac{\\text{copies}}{\\mu\\mathrm{L}}$$\n将最终答案四舍五入至四位有效数字，我们得到：\n$$\\hat{c} \\approx 135.4\\,\\frac{\\text{copies}}{\\mu\\mathrm{L}}$$", "answer": "$$\\boxed{1.354 \\times 10^{2}}$$", "id": "5098729"}, {"introduction": "在绝对定量的基础上，本练习将探讨一种更复杂且在诊断中极为常见的应用：拷贝数变异（Copy Number Variation, CNV）分析。您将通过比较目标基因与单拷贝参考基因的信号，来估计目标基因的相对拷贝数。这不仅要求您计算二者的浓度比值，更重要的是，您需要运用“德尔塔方法”（delta method）来推导该比值的置信区间，从而对测量结果的不确定性进行评估。[@problem_id:5098724]", "problem": "在为分子和免疫诊断拷贝数变异定量而设计的基于芯片的数字聚合酶链式反应 (dPCR) 分析中，样本被分配到等体积的纳升孔中。设每个纳升孔中生物标志物基因（靶标，记为 $T$）和单拷贝参考基因（参考，记为 $R$）的目标分子占据数分别被建模为每个纳升孔中均值为 $\\lambda_T$ 和 $\\lambda_R$ 的独立泊松随机变量。当一个纳升孔含有至少一个可扩增的模板分子时，它被称为“阳性”。在泊松模型下，一个纳升孔为阳性的概率是其占据数为零的概率的补集。因此，在 $N$ 个纳升孔中观察到的阳性纳升孔数 $k$ 服从二项分布，其成功概率由潜在的泊松均值决定。从这些基础出发，分别根据 $T$ 和 $R$ 的观察阳性分数推导最大似然估计量 $\\hat{\\lambda}_T$ 和 $\\hat{\\lambda}_R$。然后推导相对拷贝数估计量 $\\widehat{\\mathrm{CN}}$，其定义为每个纳升孔泊松均值之比，即 $\\widehat{\\mathrm{CN}} = \\hat{\\lambda}_T / \\hat{\\lambda}_R$。当分配体积相等时，该值等于浓度比。使用一阶 delta 方法近似，并假设 $T$ 和 $R$ 的计数是独立的，推导 $\\widehat{\\mathrm{CN}}$ 的一个近似双侧 $95\\%$ 置信区间。\n\n给定 $N_T = N_R = 20{,}000$ 个纳升孔，$T$ 的阳性孔数为 $k_T = 8{,}000$，$R$ 的阳性孔数为 $k_R = 10{,}000$，计算 $\\hat{\\lambda}_T$、$\\hat{\\lambda}_R$、$\\widehat{\\mathrm{CN}}$ 的数值，以及 $\\widehat{\\mathrm{CN}}$ 的 $95\\%$ 置信区间的下限和上限。所有答案均以无量纲数表示，并将您的数值答案四舍五入到四位有效数字。", "solution": "解答分三部分展开：首先，推导泊松均值 $\\lambda$ 的最大似然估计量 (MLE)；其次，使用 delta 方法推导两个此类估计量之比的近似置信区间；第三，计算数值。\n\n设 $X$ 为代表单个纳升孔中分子数量的随机变量。根据问题陈述，$X$ 服从均值为 $\\lambda$ 的泊松分布，即 $X \\sim \\mathrm{Poisson}(\\lambda)$。其概率质量函数为 $P(X=x) = \\frac{e^{-\\lambda}\\lambda^x}{x!}$，对于 $x = 0, 1, 2, \\dots$。如果一个纳升孔含有至少一个分子，即 $X \\ge 1$，则为阳性。单个纳升孔为阳性的概率（记为 $p$）是其为空 ($X=0$) 的概率的补集：\n$$p = P(X \\ge 1) = 1 - P(X=0) = 1 - \\frac{e^{-\\lambda}\\lambda^0}{0!} = 1 - e^{-\\lambda}$$\n在总共 $N$ 个纳升孔中，观察到的阳性纳升孔数 $k$ 是 $N$ 次独立伯努利试验的总和，每次试验的成功概率为 $p$。因此，$k$ 服从二项分布，$k \\sim \\mathrm{Binomial}(N, p)$。给定观察值 $k$ 时，$p$ 的似然函数为：\n$$L(p; k, N) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n为了找到 $p$ 的最大似然估计，我们最大化该函数，或者更方便地，最大化其对数（对数似然）：\n$$\\ln L(p) = \\ln\\binom{N}{k} + k \\ln p + (N-k) \\ln(1-p)$$\n对 $p$ 求导并令其为零，得到最大似然估计 $\\hat{p}$：\n$$\\frac{d(\\ln L)}{dp} = \\frac{k}{p} - \\frac{N-k}{1-p} = 0$$\n$$\\frac{k}{\\hat{p}} = \\frac{N-k}{1-\\hat{p}} \\implies k(1-\\hat{p}) = (N-k)\\hat{p} \\implies k - k\\hat{p} = N\\hat{p} - k\\hat{p} \\implies k = N\\hat{p}$$\n$$\\hat{p} = \\frac{k}{N}$$\n根据最大似然估计量的不变性，$\\lambda$ 的最大似然估计量（记为 $\\hat{\\lambda}$）可以通过将 $\\hat{p}$ 代入关联 $p$ 和 $\\lambda$ 的方程中找到：\n$$\\hat{p} = 1 - e^{-\\hat{\\lambda}} \\implies \\frac{k}{N} = 1 - e^{-\\hat{\\lambda}}$$\n$$e^{-\\hat{\\lambda}} = 1 - \\frac{k}{N} = \\frac{N-k}{N}$$\n$$-\\hat{\\lambda} = \\ln\\left(\\frac{N-k}{N}\\right)$$\n$$\\hat{\\lambda} = -\\ln\\left(\\frac{N-k}{N}\\right) = \\ln\\left(\\left(\\frac{N-k}{N}\\right)^{-1}\\right) = \\ln\\left(\\frac{N}{N-k}\\right)$$\n将此通用公式应用于靶标 ($T$) 和参考 ($R$) 基因，我们得到它们各自的最大似然估计量：\n$$\\hat{\\lambda}_T = \\ln\\left(\\frac{N_T}{N_T-k_T}\\right) \\quad \\text{和} \\quad \\hat{\\lambda}_R = \\ln\\left(\\frac{N_R}{N_R-k_R}\\right)$$\n\n接下来，我们使用一阶 delta 方法推导相对拷贝数 $\\widehat{\\mathrm{CN}} = \\hat{\\lambda}_T / \\hat{\\lambda}_R$ 的近似 $95\\%$ 置信区间。两个不相关估计量的函数 $g(\\hat{\\theta}_1, \\hat{\\theta}_2)$ 的方差近似为：\n$$\\mathrm{Var}(g(\\hat{\\theta}_1, \\hat{\\theta}_2)) \\approx \\left(\\frac{\\partial g}{\\partial \\theta_1}\\right)^2 \\mathrm{Var}(\\hat{\\theta}_1) + \\left(\\frac{\\partial g}{\\partial \\theta_2}\\right)^2 \\mathrm{Var}(\\hat{\\theta}_2)$$\n在我们的情况下，$g(\\hat{\\lambda}_T, \\hat{\\lambda}_R) = \\hat{\\lambda}_T / \\hat{\\lambda}_R$。偏导数为：\n$$\\frac{\\partial g}{\\partial \\lambda_T} = \\frac{1}{\\lambda_R} \\quad \\text{和} \\quad \\frac{\\partial g}{\\partial \\lambda_R} = -\\frac{\\lambda_T}{\\lambda_R^2}$$\n因此，$\\widehat{\\mathrm{CN}}$ 的方差近似为：\n$$\\mathrm{Var}(\\widehat{\\mathrm{CN}}) \\approx \\left(\\frac{1}{\\hat{\\lambda}_R}\\right)^2 \\mathrm{Var}(\\hat{\\lambda}_T) + \\left(-\\frac{\\hat{\\lambda}_T}{\\hat{\\lambda}_R^2}\\right)^2 \\mathrm{Var}(\\hat{\\lambda}_R) = \\frac{\\mathrm{Var}(\\hat{\\lambda}_T)}{\\hat{\\lambda}_R^2} + \\frac{\\hat{\\lambda}_T^2 \\mathrm{Var}(\\hat{\\lambda}_R)}{\\hat{\\lambda}_R^4}$$\n$$\\mathrm{Var}(\\widehat{\\mathrm{CN}}) \\approx \\left(\\frac{\\hat{\\lambda}_T}{\\hat{\\lambda}_R}\\right)^2 \\left( \\frac{\\mathrm{Var}(\\hat{\\lambda}_T)}{\\hat{\\lambda}_T^2} + \\frac{\\mathrm{Var}(\\hat{\\lambda}_R)}{\\hat{\\lambda}_R^2} \\right) = (\\widehat{\\mathrm{CN}})^2 \\left( \\mathrm{RelVar}(\\hat{\\lambda}_T) + \\mathrm{RelVar}(\\hat{\\lambda}_R) \\right)$$\n为了找到 $\\mathrm{Var}(\\hat{\\lambda})$，我们再次对 $\\hat{\\lambda} = h(\\hat{p}) = -\\ln(1-\\hat{p})$ 使用 delta 方法。\n$$\\mathrm{Var}(\\hat{\\lambda}) \\approx \\left(h'(\\hat{p})\\right)^2 \\mathrm{Var}(\\hat{p})$$\n导数为 $h'(\\hat{p}) = \\frac{1}{1-\\hat{p}}$。二项比例估计量 $\\hat{p}=k/N$ 的方差是 $\\mathrm{Var}(\\hat{p}) = \\frac{p(1-p)}{N}$。我们通过代入 $\\hat{p}$ 来估计它，所以 $\\widehat{\\mathrm{Var}}(\\hat{p}) = \\frac{\\hat{p}(1-\\hat{p})}{N}$。\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}) \\approx \\left(\\frac{1}{1-\\hat{p}}\\right)^2 \\frac{\\hat{p}(1-\\hat{p})}{N} = \\frac{\\hat{p}}{N(1-\\hat{p})}$$\n代入 $\\hat{p} = k/N$：\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}) = \\frac{k/N}{N(1-k/N)} = \\frac{k/N}{N((N-k)/N)} = \\frac{k}{N(N-k)}$$\n将此应用于 $T$ 和 $R$：\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}_T) = \\frac{k_T}{N_T(N_T-k_T)} \\quad \\text{和} \\quad \\widehat{\\mathrm{Var}}(\\hat{\\lambda}_R) = \\frac{k_R}{N_R(N_R-k_R)}$$\n$\\widehat{\\mathrm{CN}}$ 的一个近似双侧 $95\\%$ 置信区间由 $\\widehat{\\mathrm{CN}} \\pm z_{1-0.05/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}})}$ 给出，其中 $z_{0.975} \\approx 1.96$。\n\n最后，我们使用所提供的数据计算数值：$N_T = 20,000$，$k_T = 8,000$，$N_R = 20,000$，$k_R = 10,000$。\n首先，我们计算 $\\lambda_T$ 和 $\\lambda_R$ 的最大似然估计量：\n$$\\hat{\\lambda}_T = \\ln\\left(\\frac{20000}{20000-8000}\\right) = \\ln\\left(\\frac{20000}{12000}\\right) = \\ln\\left(\\frac{5}{3}\\right) = -\\ln(0.6) \\approx 0.5108256$$\n$$\\hat{\\lambda}_R = \\ln\\left(\\frac{20000}{20000-10000}\\right) = \\ln\\left(\\frac{20000}{10000}\\right) = \\ln(2) \\approx 0.6931472$$\n四舍五入到四位有效数字，$\\hat{\\lambda}_T \\approx 0.5108$ 和 $\\hat{\\lambda}_R \\approx 0.6931$。\n\n接下来，我们计算拷贝数的估计量：\n$$\\widehat{\\mathrm{CN}} = \\frac{\\hat{\\lambda}_T}{\\hat{\\lambda}_R} = \\frac{0.5108256}{0.6931472} \\approx 0.7369656$$\n四舍五入到四位有效数字，$\\widehat{\\mathrm{CN}} \\approx 0.7370$。\n\n现在，我们计算 $\\hat{\\lambda}_T$ 和 $\\hat{\\lambda}_R$ 的估计方差：\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}_T) = \\frac{8000}{20000(20000-8000)} = \\frac{8000}{20000 \\times 12000} = \\frac{1}{30000}$$\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}_R) = \\frac{10000}{20000(20000-10000)} = \\frac{10000}{20000 \\times 10000} = \\frac{1}{20000}$$\n$\\widehat{\\mathrm{CN}}$ 的估计方差是：\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}}) \\approx (\\widehat{\\mathrm{CN}})^2 \\left( \\frac{\\widehat{\\mathrm{Var}}(\\hat{\\lambda}_T)}{\\hat{\\lambda}_T^2} + \\frac{\\widehat{\\mathrm{Var}}(\\hat{\\lambda}_R)}{\\hat{\\lambda}_R^2} \\right)$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}}) \\approx (0.7369656)^2 \\left( \\frac{1/30000}{(0.5108256)^2} + \\frac{1/20000}{(0.6931472)^2} \\right)$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}}) \\approx (0.543118) \\left( \\frac{3.333... \\times 10^{-5}}{0.260943} + \\frac{5 \\times 10^{-5}}{0.480453} \\right) \\approx (0.543118)(1.2774 \\times 10^{-4} + 1.0407 \\times 10^{-4})$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}}) \\approx (0.543118)(2.3181 \\times 10^{-4}) \\approx 1.2588 \\times 10^{-4}$$\n$\\widehat{\\mathrm{CN}}$ 的标准误是 $SE(\\widehat{\\mathrm{CN}}) = \\sqrt{1.2588 \\times 10^{-4}} \\approx 0.0112198$。\n$95\\%$ 置信区间的误差范围是 $ME = z_{0.975} \\times SE(\\widehat{\\mathrm{CN}}) \\approx 1.96 \\times 0.0112198 \\approx 0.0219908$。\n\n$95\\%$ 置信区间为 $\\widehat{\\mathrm{CN}} \\pm ME$：\n下限：$0.7369656 - 0.0219908 = 0.7149748$\n上限：$0.7369656 + 0.0219908 = 0.7589564$\n\n四舍五入到四位有效数字：\n下限 $\\approx 0.7150$\n上限 $\\approx 0.7590$\n所要求的五个数值是 $\\hat{\\lambda}_T = 0.5108$，$\\hat{\\lambda}_R = 0.6931$，$\\widehat{\\mathrm{CN}} = 0.7370$，置信区间下限 = $0.7150$，置信区间上限 = $0.7590$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5108  0.6931  0.7370  0.7150  0.7590\n\\end{pmatrix}\n}\n$$", "id": "5098724"}, {"introduction": "理想化的模型是理解复杂系统的有力工具，但真实世界的仪器总存在瑕疵。这项高级练习将引导您探索物理非理想因素——具体来说，是芯片上纳升级反应孔体积的微小差异——如何给浓度测量带来系统性偏差。您将运用泰勒级数展开这一数学工具来量化这种偏差，从而深刻理解在dPCR系统中，微加工制造精度与数据分析准确性之间密不可分的联系。[@problem_id:5098714]", "problem": "一个基于芯片的数字聚合酶链式反应（PCR）分析法将一个样本分配到 $N$ 个纳升级微孔中，每个微孔的体积为 $v_{i}$。在理想的数字PCR（dPCR）中，每个微孔中的目标分子数量通常被建模为一个泊松随机变量，其均值为 $c\\,v_{i}$，其中 $c$ 是真实的目标浓度。因此，一个微孔被判读为阳性的概率是 $c$ 和 $v_{i}$ 的函数。在实践中，制造出的芯片会表现出微孔间的体积差异。考虑一个芯片，其微孔体积 $v_{i}$ 是独立同分布的，平均值为 $\\bar{v} = 1.0\\,\\mathrm{nL}$，变异系数为 $\\mathrm{CV} = 5\\%$。在该芯片上进行的一次实验产生了 $k$ 个阳性微孔（总数为 $N$），观测到的阳性比例为 $k/N = 0.3$。\n\n从泊松占有模型和变异系数的定义出发，推导当体积被错误地视为均一时，浓度估计中分数偏差的渐近表达式（精确到体积差异的二阶）。设朴素估计量是通过将所有微孔的体积都视为 $\\bar{v}$，并在此假设下对观测到的阳性比例进行反算得到的。将分数偏差定义为 $(\\hat{c} - c)/c$，其中 $\\hat{c}$ 是朴素估计值，而 $c$ 是在实际体积差异下与观测到的阳性比例相符的真实浓度。使用关于微孔体积变异性的二阶泰勒展开来量化该偏差，然后对 $\\bar{v} = 1.0\\,\\mathrm{nL}$、$\\mathrm{CV} = 0.05$ 和 $k/N = 0.3$ 的情况进行数值计算。\n\n将最终的分数偏差表示为一个无量纲的小数，并将您的答案四舍五入到四位有效数字。", "solution": "### 分数偏差的推导\n\n设 $M_i$ 为第 $i$ 个体积为 $v_i$ 的微孔中的目标分子数。根据问题陈述，$M_i$ 服从均值为 $\\lambda_i = c\\,v_i$ 的泊松分布，其中 $c$ 是真实浓度。\n$$ P(M_i = m) = \\frac{(c\\,v_i)^m \\exp(-c\\,v_i)}{m!} $$\n如果一个微孔包含一个或多个分子（$M_i \\ge 1$），则该微孔被认为是“阳性”的。体积为 $v_i$ 的微孔为阳性的概率，记为 $p(v_i)$，是：\n$$ p(v_i) = 1 - P(M_i = 0) = 1 - \\exp(-c\\,v_i) $$\n实际上，微孔体积 $v_i$ 并非均一，而是从某个分布中抽取的独立同分布随机变量。设 $V$ 代表这个随机体积变量。任意随机选取的微孔为阳性的概率 $P_{true}$，是 $p(V)$ 在 $V$ 的分布上的期望值。\n$$ P_{true} = \\mathbb{E}[p(V)] = \\mathbb{E}[1 - \\exp(-c\\,V)] = 1 - \\mathbb{E}[\\exp(-c\\,V)] $$\n为了计算 $\\mathbb{E}[\\exp(-c\\,V)]$，我们对函数 $f(V) = \\exp(-c\\,V)$ 在平均体积 $\\bar{v} = \\mathbb{E}[V]$ 附近进行二阶泰勒展开。\n$$ f(V) \\approx f(\\bar{v}) + f'(\\bar{v})(V - \\bar{v}) + \\frac{f''(\\bar{v})}{2}(V - \\bar{v})^2 $$\n$f(V)$ 的导数是：\n$$ f'(V) = -c \\exp(-c\\,V) \\quad \\implies \\quad f'(\\bar{v}) = -c \\exp(-c\\,\\bar{v}) $$\n$$ f''(V) = c^2 \\exp(-c\\,V) \\quad \\implies \\quad f''(\\bar{v}) = c^2 \\exp(-c\\,\\bar{v}) $$\n对泰勒级数取期望：\n$$ \\mathbb{E}[f(V)] \\approx \\mathbb{E}\\left[ f(\\bar{v}) + f'(\\bar{v})(V - \\bar{v}) + \\frac{f''(\\bar{v})}{2}(V - \\bar{v})^2 \\right] $$\n利用期望的线性性质：\n$$ \\mathbb{E}[f(V)] \\approx f(\\bar{v}) + f'(\\bar{v})\\mathbb{E}[V - \\bar{v}] + \\frac{f''(\\bar{v})}{2}\\mathbb{E}[(V - \\bar{v})^2] $$\n我们知道 $\\mathbb{E}[V - \\bar{v}] = \\mathbb{E}[V] - \\bar{v} = 0$，并且根据定义，$\\mathbb{E}[(V - \\bar{v})^2] = \\mathrm{Var}(V)$。\n$$ \\mathbb{E}[\\exp(-c\\,V)] \\approx \\exp(-c\\,\\bar{v}) + \\frac{c^2 \\exp(-c\\,\\bar{v})}{2} \\mathrm{Var}(V) $$\n方差与变异系数 $(\\mathrm{CV})$ 的关系是 $\\mathrm{Var}(V) = (\\mathrm{CV} \\cdot \\bar{v})^2 = \\mathrm{CV}^2 \\bar{v}^2$。将其代入：\n$$ \\mathbb{E}[\\exp(-c\\,V)] \\approx \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} c^2 \\bar{v}^2 \\mathrm{CV}^2 \\right) $$\n因此，一个微孔为阳性的真实概率是：\n$$ P_{true} \\approx 1 - \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n观测到的阳性微孔比例 $k/N$ 是我们对 $P_{true}$ 的实验测量值。\n$$ \\frac{k}{N} \\approx 1 - \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n现在，考虑朴素估计量 $\\hat{c}$。它是通过错误地假设所有体积都在 $\\bar{v}$ 处均一而得到的，这意味着阳性微孔的概率为 $1 - \\exp(-\\hat{c}\\,\\bar{v})$。将此概率与观测到的比例等同起来：\n$$ \\frac{k}{N} = 1 - \\exp(-\\hat{c}\\,\\bar{v}) $$\n我们现在可以通过将 $k/N$ 的两个表达式等同起来，来关联朴素估计值 $\\hat{c}$ 和真实浓度 $c$。\n$$ 1 - \\exp(-\\hat{c}\\,\\bar{v}) \\approx 1 - \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n$$ \\exp(-\\hat{c}\\,\\bar{v}) \\approx \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n对两边取自然对数：\n$$ -\\hat{c}\\,\\bar{v} \\approx \\ln\\left[ \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) \\right] $$\n$$ -\\hat{c}\\,\\bar{v} \\approx -c\\,\\bar{v} + \\ln\\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n由于 $\\mathrm{CV}$ 很小（$0.05$），项 $\\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2$ 也很小。我们对小的 $x$ 使用一阶泰勒近似 $\\ln(1+x) \\approx x$：\n$$ -\\hat{c}\\,\\bar{v} \\approx -c\\,\\bar{v} + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 $$\n两边除以 $-\\bar{v}$：\n$$ \\hat{c} \\approx c - \\frac{1}{2} c^2 \\bar{v} \\mathrm{CV}^2 $$\n分数偏差定义为 $(\\hat{c} - c)/c$。\n$$ \\frac{\\hat{c} - c}{c} \\approx \\frac{(c - \\frac{1}{2} c^2 \\bar{v} \\mathrm{CV}^2) - c}{c} = \\frac{-\\frac{1}{2} c^2 \\bar{v} \\mathrm{CV}^2}{c} = -\\frac{1}{2} c\\,\\bar{v}\\,\\mathrm{CV}^2 $$\n这个表达式依赖于未知的真实浓度 $c$。为了得到一个实用的公式，我们用可测量的量来表示偏差。该项本身是 $\\mathrm{CV}^2$ 阶的，这是一个小的修正项。因此，我们可以在此项中用朴素估计值 $\\hat{c}$ 来近似 $c$，而不会影响表达式的整体二阶精度。\n$$ \\frac{\\hat{c} - c}{c} \\approx -\\frac{1}{2} \\hat{c}\\,\\bar{v}\\,\\mathrm{CV}^2 $$\n从朴素模型中，我们有 $\\hat{c}\\,\\bar{v}$ 的表达式：\n$$ \\exp(-\\hat{c}\\,\\bar{v}) = 1 - \\frac{k}{N} \\implies \\hat{c}\\,\\bar{v} = -\\ln\\left(1 - \\frac{k}{N}\\right) $$\n将此代入我们的分数偏差表达式中：\n$$ \\frac{\\hat{c} - c}{c} \\approx -\\frac{1}{2} \\left[ -\\ln\\left(1 - \\frac{k}{N}\\right) \\right] \\mathrm{CV}^2 = \\frac{1}{2} \\ln\\left(1 - \\frac{k}{N}\\right) \\mathrm{CV}^2 $$\n这就是所求的分数偏差的渐近表达式。它在体积离散参数 $\\mathrm{CV}$ 上是二阶的。由于 $k/N  1$，$\\ln(1-k/N)$ 是负数，这正确地预测了朴素浓度 $\\hat{c}$ 是真实浓度 $c$ 的一个低估值。\n\n### 数值计算\n\n我们有以下给定值：\n-   观测到的阳性微孔比例：$k/N = 0.3$。\n-   体积的变异系数：$\\mathrm{CV} = 0.05$。\n\n我们将这些值代入推导出的公式中：\n$$ \\frac{\\hat{c} - c}{c} \\approx \\frac{1}{2} \\ln(1 - 0.3) (0.05)^2 $$\n$$ \\frac{\\hat{c} - c}{c} \\approx \\frac{1}{2} \\ln(0.7) (0.0025) $$\n使用计算器计算自然对数：\n$$ \\ln(0.7) \\approx -0.3566749 $$\n$$ \\frac{\\hat{c} - c}{c} \\approx \\frac{1}{2} (-0.3566749) (0.0025) $$\n$$ \\frac{\\hat{c} - c}{c} \\approx (-0.17833745) (0.0025) $$\n$$ \\frac{\\hat{c} - c}{c} \\approx -0.0004458436 $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ \\frac{\\hat{c} - c}{c} \\approx -0.0004458 $$\n这就是由于微孔体积存在 $5\\%$ 的变异系数而导致的浓度测量的估计分数偏差。", "answer": "$$\\boxed{-0.0004458}$$", "id": "5098714"}]}