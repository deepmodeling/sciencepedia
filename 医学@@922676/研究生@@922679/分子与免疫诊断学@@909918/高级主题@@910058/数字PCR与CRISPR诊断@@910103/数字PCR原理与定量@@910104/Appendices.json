{"hands_on_practices": [{"introduction": "本练习旨在解决数字PCR中最核心的计算问题。我们将基于泊松统计（Poisson statistics）原理，推导如何将观察到的阳性微反应单元数量转化为绝对的分子拷贝数。通过该练习，您将巩固dPCR定量分析的核心概念，并理解为何该技术无需标准曲线即可实现绝对定量。[@problem_id:5106522]", "problem": "基于液滴的数字聚合酶链式反应 (dPCR) 检测将单个反应体系分配到 $N$ 个独立的液滴中，每个液滴的体积为 $v$，然后进行终点扩增，以确定哪些液滴含有至少一个可扩增的目标分子。在分子随机、独立地分配到液滴中的标准假设下，并且终点检测可以完美地将含有至少一个可扩增模板分子的液滴分类为阳性，否则为阴性的假设下，仅根据观察到的阳性液滴数量和分配体积，确定每个反应中的目标拷贝绝对数。\n\n对于单个反应，您将获得以下实验观察和仪器表征的量：\n- 分配（液滴）数：$N = 20{,}000$。\n- 观察到的阳性液滴数：$k = 5{,}400$。\n- 平均液滴体积：$v = 0.85\\,\\text{nL}$，假定其单分散性足够好，可在推导中视为常数。\n\n从独立分子随机占据离散体积的基础模型出发，推导出以阴性液滴分数为基础的每个液滴平均占据数的估计量，并用它计算每个反应的绝对拷贝数。基于同样的基础模型，解释为什么报告的拷贝数是绝对的，并且不需要外部校准品来校准聚合酶链式反应的效率或荧光响应。\n\n将每个反应的绝对拷贝数的最终数值答案四舍五入到四位有效数字。将最终量表示为纯计数（无单位）。", "solution": "**估计量和绝对拷贝数的推导**\n\n数字PCR的基础模型假设目标分子在 $N$ 个分配中是随机独立分布的。当分子总数和分配数都很大时，任何给定液滴中的分子数 $X$ 服从泊松分布。设 $\\lambda$ 为每个液滴的平均分子数（平均占据数）。液滴中恰好含有 $j$ 个分子的概率由泊松概率质量函数给出：\n$$P(X=j) = \\frac{\\lambda^j \\exp(-\\lambda)}{j!}$$\n其中 $j$ 是一个非负整数（$0, 1, 2, \\dots$）。\n\n根据问题陈述，一个液滴当且仅当它含有零个分子时被分类为“阴性”。一个随机选择的液滴为阴性的概率对应于 $j=0$ 的情况：\n$$P(\\text{negative}) = P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n反之，如果一个液滴含有一个或多个分子（$j \\ge 1$），则为“阳性”。一个液滴为阳性的概率是：\n$$P(\\text{positive}) = P(X \\ge 1) = 1 - P(X=0) = 1 - \\exp(-\\lambda)$$\n\n根据实验数据，我们总共有 $N$ 个液滴，其中观察到 $k$ 个为阳性。因此，阴性液滴的数量是 $N-k$。观察到的阴性液滴分数 $f_{neg}$ 作为理论概率 $P(\\text{negative})$ 的经验估计：\n$$f_{neg} = \\frac{\\text{阴性液滴数}}{\\text{总液滴数}} = \\frac{N-k}{N}$$\n通过将理论概率与这个经验分数等同，我们可以建立一个方程来求解 $\\lambda$：\n$$\\exp(-\\lambda) \\approx \\frac{N-k}{N}$$\n对两边取自然对数，得到：\n$$-\\lambda = \\ln\\left(\\frac{N-k}{N}\\right)$$\n这个方程可以解出 $\\lambda$，即每个液滴平均占据数的估计量：\n$$\\lambda = -\\ln\\left(\\frac{N-k}{N}\\right)$$\n这也可以表示为：\n$$\\lambda = \\ln\\left(\\left(\\frac{N-k}{N}\\right)^{-1}\\right) = \\ln\\left(\\frac{N}{N-k}\\right)$$\n这个公式提供了每个液滴中目标分子的平均数，它完全由液滴总数和观察到的阴性液滴数推导得出。\n\n每个反应的目标拷贝绝对数，我们记为 $M$，是在分配前原始样本体积中存在的分子总数。由于 $\\lambda$ 是每个液滴的*平均*分子数，分子总数就是这个平均数乘以液滴总数 $N$：\n$$M = \\lambda \\times N$$\n代入推导出的 $\\lambda$ 表达式：\n$$M = N \\left[-\\ln\\left(\\frac{N-k}{N}\\right)\\right]$$\n\n现在，我们使用所提供的数据计算数值：\n-   $N = 20{,}000$\n-   $k = 5{,}400$\n\n首先，计算阴性液滴的数量：\n$$N-k = 20{,}000 - 5{,}400 = 14{,}600$$\n接下来，计算阴性液滴的分数：\n$$\\frac{N-k}{N} = \\frac{14{,}600}{20{,}000} = 0.73$$\n现在，计算 $\\lambda$：\n$$\\lambda = -\\ln(0.73)$$\n最后，计算总拷贝数 $M$：\n$$M = 20{,}000 \\times [-\\ln(0.73)]$$\n使用自然对数的值：\n$$\\ln(0.73) \\approx -0.314710757$$\n因此：\n$$M \\approx 20{,}000 \\times [-(-0.314710757)] = 20{,}000 \\times 0.314710757 \\approx 6294.21514$$\n根据要求，将最终结果四舍五入到四位有效数字：\n$$M \\approx 6294$$\n\n**绝对定量的解释**\ndPCR提供的定量被认为是“绝对”的，因为它依赖于对分配单元的物理计数和一个基本的统计学原理，而不是依赖于必须校准的间接模拟信号。以下是原因的详细分析：\n\n1.  **数字信号**：PCR不用于测量扩增速率，而仅用于生成一个二元的“是/否”信号。每个液滴被分类为阳性（发生扩增）或阴性（未发生扩增）。这种终点检测只要求反应化学足以将单个分子扩增到可检测水平，从而将其与空液滴区分开来。\n\n2.  **不依赖反应效率**：与定量PCR (qPCR)不同，qPCR的定量是从扩增速率（例如，循环阈值 $C_t$）推断出来的，而dPCR对液滴之间的PCR效率变化不敏感，只要效率高于检测阈值即可。阳性液滴的最终荧光强度不用于计算，这消除了一个主要的变异来源和校准的需求。\n\n3.  **第一性原理计算**：$\\lambda$ 以及随后的 $M$ 的计算仅依赖于阴性分配单元与总分配单元的比率。这是一个计数练习。公式 $\\lambda = -\\ln(f_{neg})$ 是直接从随机分布的泊松模型推导出来的。它不包含任何与PCR动力学或热力学相关的参数，也不包含任何仪器特定的荧光参数。\n\n4.  **无需外部校准品**：因为测量是基于计数和统计模型，dPCR不需要使用已知浓度的样品生成标准曲线来解释目标物的结果。这使得测量是“绝对”的，因为它不是相对于为该特定检测单独制备的参考物质。\n\n液滴体积 $v = 0.85\\,\\text{nL}$ 已被提供，但未用于计算*每个反应*的绝对拷贝数 $M$。这进一步凸显了结果是一个绝对计数。然而，如果要计算原始样品中目标分子的浓度，则体积 $v$ 是必不可少的，浓度将为 $C = \\frac{M}{N \\times v}$。", "answer": "$$\\boxed{6294}$$", "id": "5106522"}, {"introduction": "在掌握了基本定量方法后，我们转向一个实际挑战：优化测量精度。本练习将探讨如何确定最佳的样本稀释倍数，以避免因信号饱和（即阳性比例$p$接近1）而导致的精度下降。理解阳性率与测量精度之间的关系，对于设计可靠的dPCR实验至关重要。[@problem_id:5106594]", "problem": "一个实验室正在计划进行一次数字聚合酶链式反应（dPCR）分析，该分析将一个样本分配到 $N=20{,}000$ 个独立的反应单元中。假设采用标准分配模型：分子根据泊松过程独立分布于各个反应单元中，如果一个反应单元含有至少一个目标分子，则该反应单元被记为阳性，且具有完美的分析特异性和灵敏度。令 $p$ 表示单个dPCR孔中阳性反应单元的期望分数，令 $\\lambda$ 表示每个反应单元中目标分子的平均数（平均占有率），该值与输入浓度成线性比例。实验室目前对其未稀释的样本观察到 $p=0.99$，并希望通过一个倍数稀释因子 $D$（定义为 $\\lambda \\mapsto \\lambda/D$）来改变分配前的浓度，以便在同一个 $N$ 值下，在单个孔中达到目标值 $p=0.50$。仅使用泊松占有率和独立反应单元计分的第一性原理，推导连接 $p$ 和 $\\lambda$ 的关系，用它来确定所需的 $D$，然后根据 $N$ 个反应单元的抽样分布和一个适当的变换论证，解释从 $p=0.99$ 变为 $p=0.50$ 如何影响对基础目标浓度的估计精密度。仅报告所需的倍数稀释因子 $D$ 作为最终数值答案，并将答案四舍五入到 $4$ 位有效数字。将 $D$ 表示为一个无单位的纯数。", "solution": "解答过程分为三部分：首先，推导阳性反应单元分数（$p$）与每个反应单元平均分子数（$\\lambda$）之间的关系；其次，计算所需的稀释因子（$D$）；第三，解释测量精密度的变化。\n\n**1. $p$ 与 $\\lambda$ 之间的关系**\n\n问题指出，目标分子在 $N$ 个反应单元中的分布遵循泊松过程。设 $K$ 为一个随机选择的反应单元中分子数量的随机变量。一个反应单元恰好包含 $k$ 个分子的概率由均值为 $\\lambda$ 的泊松概率质量函数给出：\n$$ P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!} $$\n当且仅当一个反应单元不含分子（$k=0$）时，它被记为阴性。一个反应单元为阴性的概率是：\n$$ P(\\text{negative}) = P(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda) $$\n如果一个反应单元含有至少一个分子（$k \\geq 1$），则它被记为阳性。一个反应单元为阳性的概率是其为阴性概率的补集：\n$$ P(\\text{positive}) = 1 - P(K=0) = 1 - \\exp(-\\lambda) $$\n问题将 $p$ 定义为阳性反应单元的期望分数。对于大量的反应单元 $N$，观察到的分数将收敛于此概率。因此，我们建立了核心关系：\n$$ p = 1 - \\exp(-\\lambda) $$\n这个方程可以被反转，以表达 $\\lambda$ 作为 $p$ 的函数：\n$$ \\exp(-\\lambda) = 1 - p $$\n$$ \\lambda = -\\ln(1 - p) $$\n\n**2. 倍数稀释因子 $D$ 的计算**\n\n设 $\\lambda_1$ 为对应于初始观察到的阳性反应单元分数 $p_1 = 0.99$ 的平均占有率。使用推导出的公式：\n$$ \\lambda_1 = -\\ln(1 - p_1) = -\\ln(1 - 0.99) = -\\ln(0.01) $$\n设 $\\lambda_2$ 为对应于期望的阳性反应单元分数 $p_2 = 0.50$ 的目标平均占有率：\n$$ \\lambda_2 = -\\ln(1 - p_2) = -\\ln(1 - 0.50) = -\\ln(0.50) $$\n倍数稀释因子 $D$ 的定义使得新浓度降低，导致新的平均占有率为 $\\lambda_2 = \\lambda_1 / D$。因此，$D$ 可以通过两个平均占有率的比值来计算：\n$$ D = \\frac{\\lambda_1}{\\lambda_2} $$\n代入 $\\lambda_1$ 和 $\\lambda_2$ 的表达式：\n$$ D = \\frac{-\\ln(0.01)}{-\\ln(0.50)} = \\frac{\\ln(100)}{\\ln(2)} $$\n我们现在可以计算其数值：\n$$ D \\approx \\frac{4.605170186}{0.6931471806} \\approx 6.643856190 $$\n按要求将结果四舍五入到 $4$ 位有效数字，得到：\n$$ D \\approx 6.644 $$\n\n**3. 精密度变化的解释**\n\ndPCR分析的精密度指的是浓度估计中的统计不确定性，该不确定性与 $\\lambda$ 成正比。$\\lambda$ 的估计值，记作 $\\hat{\\lambda}$，是从观察到的阳性反应单元分数 $\\hat{p}$ 推导出来的。\n\n在总共 $N$ 个反应单元中，阳性反应单元的数量 $k_{pos}$ 是一个二项分布的随机变量，$k_{pos} \\sim \\text{Binomial}(N, p)$。真实分数 $p$ 的估计量是 $\\hat{p} = k_{pos}/N$，其方差为 $\\text{Var}(\\hat{p}) = \\frac{p(1-p)}{N}$。\n\n浓度估计量通过变换 $\\hat{\\lambda} = -\\ln(1-\\hat{p})$ 获得。问题所要求的“变换论证”涉及使用误差传播（delta方法）从 $\\hat{p}$ 的方差来计算 $\\hat{\\lambda}$ 的方差。变换后变量 $g(\\hat{p})$ 的方差由 $\\text{Var}(g(\\hat{p})) \\approx (g'(p))^2 \\text{Var}(\\hat{p})$ 给出。这里，$g(p) = -\\ln(1-p)$，所以其导数为 $g'(p) = \\frac{1}{1-p}$。\n\n因此，我们估计量 $\\hat{\\lambda}$ 的方差为：\n$$ \\text{Var}(\\hat{\\lambda}) \\approx \\left(\\frac{1}{1-p}\\right)^2 \\text{Var}(\\hat{p}) = \\left(\\frac{1}{1-p}\\right)^2 \\frac{p(1-p)}{N} = \\frac{p}{N(1-p)} $$\n测量精密度与该方差成反比。为提高精密度，我们必须最小化 $\\text{Var}(\\hat{\\lambda})$。该方差关键地取决于因子 $\\frac{p}{1-p}$。\n\n- 在初始条件 $p_1 = 0.99$ 下：系统高度饱和。方差为 $\\text{Var}(\\hat{\\lambda}_1) \\approx \\frac{0.99}{N(1-0.99)} = \\frac{99}{N}$。在这种情况下，阴性反应单元的数量非常少。这个小计数的随机抽样误差被非线性变换 $\\hat{\\lambda} = -\\ln(1-\\hat{p})$ 放大，当 $\\hat{p} \\to 1$ 时，该变换变得极其陡峭。这导致了非常大的方差和较差的精密度。\n\n- 在目标条件 $p_2 = 0.50$ 下：方差为 $\\text{Var}(\\hat{\\lambda}_2) \\approx \\frac{0.50}{N(1-0.50)} = \\frac{1}{N}$。\n\n比较两者，我们看到 $\\text{Var}(\\hat{\\lambda}_1) = 99 \\times \\text{Var}(\\hat{\\lambda}_2)$。通过将样本从 $p=0.99$ 稀释到 $p=0.50$，浓度估计的方差减少了99倍。这种不确定性的急剧减少意味着测量精密度得到了显著提高。这一改变使实验从一个高方差的饱和区域进入到一个统计上稳定得多的区域，在该区域中，阳性和阴性反应单元的计数都很可观，从而能够对基础浓度进行更稳健的估计。", "answer": "$$\\boxed{6.644}$$", "id": "5106594"}, {"introduction": "最后一个练习关注的是检测范围的下限，即检测限（limit of detection）。当实验未检测到任何阳性微反应单元时，我们该如何解读结果？本练习将演示在这种情况下如何计算目标浓度的统计学置信上限，从而提供一种基于第一性原理来严谨报告检测结果的方法。[@problem_id:5106570]", "problem": "数字聚合酶链式反应（digital PCR, dPCR）检测将反应混合物分配到 $N$ 个独立的微观分区（液滴或孔）中。假设以下基本模型和条件成立：\n- 目标序列的分子根据泊松过程随机分布到各个分区中，因此每个分区的分子数量遵循均值为 $\\lambda$（拷贝数/分区）的泊松分布。\n- 当且仅当一个分区含有至少一个目标分子时，该分区被记为阳性。\n- 各分区之间相互独立，且不存在假阳性。\n\n在这些假设下，$N$ 个分区中的阳性分区数 $K$ 是一个随机变量，其分布由 $\\lambda$ 决定。在一次特定实验中，您观察到在 $N=20{,}000$ 个分区中，有 $K=0$ 个阳性分区。\n\n仅使用上述假设和第一性原理，通过对模型下观测结果的概率进行反演，推导平均占有率 $\\lambda$（拷贝数/分区）的精确单侧 $95\\%$ 置信上限。然后，在显著性水平 $\\alpha=0.05$ 下，使用零假设 $H_{0}: \\lambda=0$ 和备择假设 $H_{1}: \\lambda0$ 进行精确的单侧假设检验，并报告一个二进制检测状态，定义为：如果 $H_{0}$ 被拒绝，则 $D=1$，否则 $D=0$。\n\n请按 $(\\lambda_{\\text{upper}}, D)$ 的顺序以两个数字的形式提供您的最终答案。将 $\\lambda_{\\text{upper}}$ 以“拷贝数/分区”为单位表示，并四舍五入到四位有效数字。检测状态 $D$ 必须报告为 $0$ 或 $1$（无单位）。", "solution": "解题过程分为两部分：首先，计算 $\\lambda$ 的 $95\\%$ 置信上限；其次，确定检测状态 $D$。\n\n**第一部分：$\\lambda$ 的单侧 $95\\%$ 置信上限**\n\n假设任何给定分区中的分子数 $m$ 遵循均值为 $\\lambda$ 的泊松分布：\n$$ P(m) = \\frac{\\lambda^m \\exp(-\\lambda)}{m!} $$\n如果一个分区包含一个或多个分子（$m \\ge 1$），则该分区为阳性。一个分区为阴性（包含零个分子，$m=0$）的概率是：\n$$ P(m=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda) $$\n因此，单个分区为阳性的概率，我们记为 $p$，是：\n$$ p = P(m \\ge 1) = 1 - P(m=0) = 1 - \\exp(-\\lambda) $$\n在一组 $N$ 个独立分区中，阳性分区的总数 $K$ 是一个遵循参数为 $N$ 和 $p$ 的二项分布的随机变量：\n$$ K \\sim \\text{Binomial}(N, p) $$\n$K$ 的概率质量函数由下式给出：\n$$ P(K=k | N, p) = \\binom{N}{k} p^k (1-p)^{N-k} $$\n代入 $p$ 和 $1-p$ 的表达式：\n$$ P(K=k | N, \\lambda) = \\binom{N}{k} (1 - \\exp(-\\lambda))^k (\\exp(-\\lambda))^{N-k} $$\n我们需要求解 $\\lambda$ 的单侧 $95\\%$ 置信上限，记为 $\\lambda_{\\text{upper}}$。这等同于找到这样一个 $\\lambda$ 值，使得在零假设方向（即更小的 $\\lambda$）上，观察到与观测结果（$K=0$）一样极端或更极端结果的概率等于显著性水平 $\\alpha$。对于 $95\\%$ 的置信水平，$\\alpha = 1 - 0.95 = 0.05$。\n\n观测结果是 $K_{obs}=0$。一个更能支持较小 $\\lambda$ 的结果是 $K \\le K_{obs}$。因此，我们必须找到满足以下方程的 $\\lambda_{\\text{upper}}$：\n$$ P(K \\le 0 | \\lambda = \\lambda_{\\text{upper}}) = \\alpha $$\n由于阳性分区数 $K$ 不能为负，这可以简化为：\n$$ P(K = 0 | \\lambda = \\lambda_{\\text{upper}}) = \\alpha $$\n我们使用 $k=0$ 时的概率质量函数：\n$$ P(K=0) = \\binom{N}{0} (1 - \\exp(-\\lambda_{\\text{upper}}))^0 (\\exp(-\\lambda_{\\text{upper}}))^{N-0} = \\exp(-N\\lambda_{\\text{upper}}) $$\n令其等于 $\\alpha$：\n$$ \\exp(-N\\lambda_{\\text{upper}}) = \\alpha $$\n我们通过对两边取自然对数来求解 $\\lambda_{\\text{upper}}$：\n$$ -N\\lambda_{\\text{upper}} = \\ln(\\alpha) $$\n$$ \\lambda_{\\text{upper}} = -\\frac{\\ln(\\alpha)}{N} $$\n代入给定值 $N=20,000$ 和 $\\alpha=0.05$：\n$$ \\lambda_{\\text{upper}} = -\\frac{\\ln(0.05)}{20,000} \\approx -\\frac{-2.99573227}{20,000} \\approx 0.0001497866 $$\n按要求四舍五入到四位有效数字：\n$$ \\lambda_{\\text{upper}} \\approx 0.0001498 $$\n\n**第二部分：假设检验与检测状态 $D$**\n\n我们必须执行一个具有以下规格的假设检验：\n- 零假设 $H_0: \\lambda = 0$\n- 备择假设 $H_1: \\lambda  0$\n- 显著性水平 $\\alpha = 0.05$\n- 观测结果：在 $N=20,000$ 个分区中有 $K=0$ 个阳性分区。\n\n拒绝或不拒绝 $H_0$ 的决定基于p值。p值是在零假设为真的前提下，获得与观测到的检验统计量一样极端或更极端的检验统计量的概率。“极端性”的方向由备择假设 $H_1: \\lambda  0$ 决定。更大的 $\\lambda$ 会导致更大的预期阳性分区数，因此“更极端”对应于更大的 $K$ 值。\n\n因此，p值为：\n$$ \\text{p-value} = P(K \\ge K_{obs} | H_0 \\text{ is true}) = P(K \\ge 0 | \\lambda = 0) $$\n在零假设 $H_0: \\lambda=0$ 下，任何单个分区为阳性的概率是：\n$$ p = 1 - \\exp(-0) = 1 - 1 = 0 $$\n如果一个阳性分区的概率 $p$ 为 $0$，那么就不可能观察到任何阳性分区。阳性分区的数量 $K$ 必须为 $0$ 的概率为 $1$。\n$$ P(K=0 | \\lambda=0) = 1 $$\n$$ P(K0 | \\lambda=0) = 0 $$\np值计算如下：\n$$ \\text{p-value} = P(K \\ge 0 | \\lambda=0) = P(K=0 | \\lambda=0) + P(K  0 | \\lambda=0) = 1 + 0 = 1 $$\n如果p值小于或等于显著性水平 $\\alpha$，我们拒绝零假设。\n$$ \\text{p-value} = 1 $$\n$$ \\alpha = 0.05 $$\n由于 $1  0.05$，我们不拒绝零假设 $H_0$。\n\n检测状态 $D$ 定义为：如果 $H_0$ 被拒绝则为 $1$，否则为 $0$。由于我们未能拒绝 $H_0$，检测状态为：\n$$ D = 0 $$\n\n最终答案由序对 $(\\lambda_{\\text{upper}}, D)$ 组成。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0001498  0 \\end{pmatrix}}\n$$", "id": "5106570"}]}