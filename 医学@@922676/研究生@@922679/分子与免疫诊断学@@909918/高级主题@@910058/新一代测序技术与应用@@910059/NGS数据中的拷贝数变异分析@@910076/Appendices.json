{"hands_on_practices": [{"introduction": "本练习将探讨从下一代测序（NGS）数据中推断拷贝数变异（CNV）的核心定量原理。我们将学习如何将标准化的读段深度（read depth）与相对于二倍体基线的特定拷贝数状态（如杂合性缺失和单拷贝增益）联系起来。通过计算预期的对数比率（log-ratio），您可以掌握将原始测序信号转化为有生物学意义的拷贝数估计的基本技能 [@problem_id:5104032]。", "problem": "一家临床分子与免疫诊断实验室对免疫检查点基因的靶向下一代测序（NGS）数据实施一个基于读取深度的拷贝数变异分析流程。假设存在以下基本关系：\n- 在基于读取深度的拷贝数推断中，当文库制备和捕获效率在样本间均一时，每个区段（bin）的预期读取计数与该位点的真实拷贝数 $c$ 成正比。\n- 一个匹配的二倍体参考样本具有基线倍性 $p$，并经过同样的处理。在对文库大小和技术协变量进行归一化后，测试位点与二倍体基线之间的归一化覆盖度的预期倍数变化是比率 $c/p$。\n- 该流程报告以2为底的对数转换后的倍数变化，用以量化拷贝数的变化。\n\n在这些假设下，考虑一个基线倍性为 $p=2$ 的肿瘤样本的三种生物学上合理的拷贝数状态：半合子缺失（$c=1$）、单拷贝增益（$c=3$）和高水平局灶性扩增（$c=6$）。从读取计数与拷贝数的比例关系以及应用于倍数变化的以2为底的对数定义出发，推导每种状态的预期对数转换倍数变化。然后，在一个适用于NGS的计数模型（例如，泊松分布或过度离散的负二项分布）下，简要论证该对数转换倍数变化的预期方差如何随深度变化，并阐明所需的任何假设。\n\n将您的最终答案表示为对应于三种状态 $(c=1,\\,c=3,\\,c=6)$ 的无量纲的以2为底的对数比率（按此顺序），并四舍五入到四位有效数字。将这三个值以单行矩阵的形式给出。", "solution": "问题陈述经验证。\n\n**步骤1：提取已知条件**\n- 每个区段（bin）的预期读取计数与真实拷贝数 $c$ 成正比。\n- 匹配的二倍体参考样本具有基线倍性 $p$。\n- 归一化覆盖度的预期倍数变化是比率 $c/p$。\n- 该流程报告以2为底的对数转换后的倍数变化。\n- 肿瘤样本的基线倍性为 $p=2$。\n- 考虑了三种拷贝数状态：半合子缺失（$c=1$）、单拷贝增益（$c=3$）和高水平局灶性扩增（$c=6$）。\n- 任务是推导每种状态的预期对数转换倍数变化，并论证其方差随测序深度的变化关系。\n- 三个对数比率的最终答案必须四舍五入到四位有效数字，并以行矩阵形式呈现。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学上合理：** 该问题牢固地植根于基于下一代测序（NGS）数据进行拷贝数变异（CNV）分析的标准原则。其核心假设——即归一化的读取深度与潜在的拷贝数成正比——是所有此类生物信息学方法的根本基础。使用二倍体参考、倍数变化的log-2转换，以及使用泊松（Poisson）或负二项（Negative Binomial）分布对读取计数进行建模，都是计算基因组学中既定和标准的做法。指定的拷贝数状态（$c=1, 3, 6$）是在癌症基因组中观察到的生物学上合理的现象。\n- **结构良好：** 该问题定义清晰，并提供了计算所需值的所有必要信息。拷贝数（$c$）、倍性（$p$）和最终报告值（log-2倍数变化）之间的关系被明确陈述。关于方差缩放的问题需要基于已知的统计特性进行定性论证，这是该领域的标准练习。\n- **客观性：** 该问题以精确、客观的语言陈述，没有歧义或主观看法。\n\n**步骤3：结论与行动**\n该问题在科学上合理、结构良好、客观且完整。因此被判定为**有效**。现在开始推导解答。\n\n问题定义了拷贝数与报告的诊断值之间的定量关系。设 $L$ 表示对数转换后的倍数变化。根据已知条件，该值是倍数变化的以2为底的对数，其中倍数变化是测试样本的拷贝数 $c$ 与参考样本的基线倍性 $p$ 的比率。\n\n因此，公式为：\n$$L = \\log_2\\left(\\frac{c}{p}\\right)$$\n问题指明参考样本是二倍体样本，意味着它有两条相关染色体。因此参考样本的基线倍性是 $p=2$。问题还指出肿瘤样本的基线倍性也是 $p=2$，这与参考样本是匹配的正常样本是一致的。对数倍数变化的计算使用参考样本的倍性。\n\n我们需要计算在肿瘤样本中三种不同拷贝数状态下 $L$ 的期望值：\n1.  **半合子缺失：** 拷贝数为 $c=1$。\n2.  **单拷贝增益：** 拷贝数为 $c=3$。\n3.  **高水平局灶性扩增：** 拷贝数为 $c=6$。\n\n对于每种情况，我们将 $c$ 和 $p$ 的值代入公式。\n\n情况1：半合子缺失 ($c=1$)\n$$L_1 = \\log_2\\left(\\frac{1}{2}\\right) = \\log_2(2^{-1}) = -1$$\n保留四位有效数字，结果为 $-1.000$。\n\n情况2：单拷贝增益 ($c=3$)\n$$L_2 = \\log_2\\left(\\frac{3}{2}\\right) = \\log_2(1.5)$$\n使用对数的换底公式 $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$:\n$$L_2 = \\frac{\\ln(1.5)}{\\ln(2)} \\approx \\frac{0.405465}{0.693147} \\approx 0.5849625$$\n四舍五入到四位有效数字，得到 $0.5850$。\n\n情况3：高水平局灶性扩增 ($c=6$)\n$$L_3 = \\log_2\\left(\\frac{6}{2}\\right) = \\log_2(3)$$\n$$L_3 = \\frac{\\ln(3)}{\\ln(2)} \\approx \\frac{1.098612}{0.693147} \\approx 1.5849625$$\n四舍五入到四位有效数字，得到 $1.585$。\n\n接下来，我们论证对数转换倍数变化的方差如何随测序深度变化。设 $N_T$ 和 $N_R$ 分别是测试样本和参考样本在给定基因组区段内的归一化读取计数。它们是随机变量。对数比为 $L = \\log_2(N_T/N_R)$。$L$ 的方差可以使用不确定性传播公式（Delta方法）来近似。首先，为方便起见，我们转换为自然对数，因为 $\\log_2(x) = \\ln(x)/\\ln(2)$，因此 $\\text{Var}(\\log_2(x)) = \\frac{1}{(\\ln 2)^2}\\text{Var}(\\ln(x))$。\n\n对于函数 $f(N_T, N_R) = \\ln(N_T) - \\ln(N_R)$，假设 $N_T$ 和 $N_R$ 是独立的（对于独立测序的样本，这是一个标准假设），则方差为：\n$$\\text{Var}(L) \\approx \\frac{1}{(\\ln 2)^2} \\left[ \\left(\\frac{\\partial f}{\\partial N_T}\\right)^2 \\text{Var}(N_T) + \\left(\\frac{\\partial f}{\\partial N_R}\\right)^2 \\text{Var}(N_R) \\right]$$\n在均值 $\\mu_T = \\mathbb{E}[N_T]$ 和 $\\mu_R = \\mathbb{E}[N_R]$ 处计算的偏导数分别为 $\\frac{\\partial f}{\\partial N_T} = \\frac{1}{\\mu_T}$ 和 $\\frac{\\partial f}{\\partial N_R} = -\\frac{1}{\\mu_R}$。\n代入得到：\n$$\\text{Var}(L) \\approx \\frac{1}{(\\ln 2)^2} \\left[ \\frac{\\text{Var}(N_T)}{\\mu_T^2} + \\frac{\\text{Var}(N_R)}{\\mu_R^2} \\right]$$\n这表明对数比的方差取决于读取计数的变异系数（CV）的平方。平均读取计数 $\\mu$ 与测序深度 $D$ 成正比。让我们在建议的计数模型下分析 $\\text{Var}(N)/\\mu^2$ 这一项。\n\n假设1：**泊松模型**。对于NGS计数，一个简单的模型是泊松分布，其中 $\\text{Var}(N) = \\mu$。在这种情况下，变异系数的平方是：\n$$\\frac{\\text{Var}(N)}{\\mu^2} = \\frac{\\mu}{\\mu^2} = \\frac{1}{\\mu}$$\n由于 $\\mu$ 与测序深度 $D$ 成正比，我们有 $\\frac{1}{\\mu} \\propto \\frac{1}{D}$。因此，对于泊松模型，$\\text{Var}(L) \\propto \\frac{1}{D_T} + \\frac{1}{D_R}$。如果两个样本的深度 $D$ 相当，则 $\\text{Var}(L) \\propto \\frac{1}{D}$。方差与测序深度成反比。\n\n假设2：**负二项（NB）模型**。真实的NGS数据经常表现出过度离散，即方差大于均值。负二项模型通过一个离散参数 $\\alpha$ 来捕捉这一现象，使得 $\\text{Var}(N) = \\mu + \\alpha\\mu^2$。变异系数的平方是：\n$$\\frac{\\text{Var}(N)}{\\mu^2} = \\frac{\\mu + \\alpha\\mu^2}{\\mu^2} = \\frac{1}{\\mu} + \\alpha$$\n同样，由于 $\\mu \\propto D$，这一项与 $\\frac{1}{D} + \\alpha$ 成正比。因此对数比的方差表现为 $\\text{Var}(L) \\propto (\\frac{1}{D_T} + \\alpha_T) + (\\frac{1}{D_R} + \\alpha_R)$。随着深度 $D$ 的增加，$\\frac{1}{D}$ 项减小，但方差会趋近于一个由离散参数（$\\alpha_T + \\alpha_R$）决定的非零下限。\n\n在两种合理的模型中，对数转换倍数变化的方差都随着测序深度的增加而减小。更高的深度会带来更精确、更可靠的拷贝数估计。负二项模型更真实地预测了，即使在非常高的深度下，由于纯粹的计数（散粒）噪声之外的生物和技术因素，仍然会存在一些方差。基本的缩放关系是方差与深度成反比关系。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1.000 & 0.5850 & 1.585\n\\end{pmatrix}\n}\n$$", "id": "5104032"}, {"introduction": "在真实的临床样本（尤其是肿瘤样本）中，基因组的基线倍性可能不是标准的二倍体。本练习将引导您推导出一个更通用的数学模型，该模型关联了观测到的对数比率 $r$、绝对拷贝数 $c$ 和样本的基线倍性 $p$。掌握这个关系式及其逆运算，对于准确解析非整倍体癌症基因组的拷贝数谱至关重要 [@problem_id:5104093]。", "problem": "在利用新一代测序（NGS）读取深度数据进行拷贝数变异分析时，经过适当的偏差校正（例如，通过全基因组范围对鸟嘌呤-胞嘧啶含量和可作图性进行标准化）后，一个标准的假设是：某个位点的预期读取深度与该位点的绝对脱氧核糖核酸拷贝数成正比。设样本中某位点的绝对拷贝数为 $c$，肿瘤的基线倍性为 $p$。假设拷贝数为 $x$ 时的预期读取深度为 $d_{x}$，并且通过一个未知的、与实验相关的常数 $k$ 保持正比关系，即 $d_{x} = k x$。设观测片段的深度为 $d = d_{c}$，基线片段的深度为 $d_{p}$。将对数转换深度比 $r$ 定义为观测深度与基线深度之比以2为底的对数，即 $r = \\log_{2}\\!\\left(\\frac{d}{d_{p}}\\right)$。\n\n仅使用这些定义和正比前提 $d_{x} = k x$，完成以下任务：\n- 推导一个表达式，将对数转换深度比 $r$ 与绝对拷贝数 $c$ 和基线倍性 $p$ 联系起来。\n- 对该关系进行代数反演，将 $c$ 显式地表示为 $r$ 和 $p$ 的函数。\n- 对 $p = 3.2$ 和 $r = -0.321928094$ 计算此表达式的值，并将绝对拷贝数报告为一个纯数。将您的最终数值结果四舍五入至四位有效数字。请勿在答案中报告任何单位或使用百分号。", "solution": "该问题要求推导对数转换深度比 $r$、绝对拷贝数 $c$ 和基线倍性 $p$ 之间的关系，然后对该关系进行反演以求解 $c$，最后进行数值计算。\n\n首先，建立相关的定义和前提。\n拷贝数为 $x$ 的位点的预期读取深度 $d_x$ 通过一个常数 $k$ 与 $x$ 成正比：\n$$d_x = kx$$\n观测片段的深度 $d$ 对应于绝对拷贝数 $c$，所以：\n$$d = d_c = kc$$\n基线片段的深度 $d_p$ 对应于基线倍性 $p$，所以：\n$$d_p = kp$$\n对数转换深度比 $r$ 定义为：\n$$r = \\log_{2}\\!\\left(\\frac{d}{d_{p}}\\right)$$\n\n第一个任务是推导一个连接 $r$、$c$ 和 $p$ 的表达式。我们将 $d$ 和 $d_p$ 的表达式代入 $r$ 的定义中：\n$$r = \\log_{2}\\!\\left(\\frac{kc}{kp}\\right)$$\n未知的、与实验相关的常数 $k$ 同时出现在分子和分母中，并且由于要使读取深度有意义，$k$ 必须为非零值，因此可以将其消去：\n$$r = \\log_{2}\\!\\left(\\frac{c}{p}\\right)$$\n这就是推导出的将对数转换深度比 $r$ 与绝对拷贝数 $c$ 和基线倍性 $p$ 联系起来的表达式。它表明，读取深度的对数比等价于其背后拷贝数的对数比，这是此类分析中的一个基本关系。\n\n第二个任务是对该关系进行代数反演，将 $c$ 显式地表示为 $r$ 和 $p$ 的函数。我们从推导出的方程开始：\n$$r = \\log_{2}\\!\\left(\\frac{c}{p}\\right)$$\n为了分离出包含 $c$ 的项，我们对等式两边取以2为底的指数函数。这是以2为底的对数的逆运算。\n$$2^r = 2^{\\log_{2}(c/p)}$$\n根据对数的定义 $a^{\\log_a(x)} = x$，等式右边简化为：\n$$2^r = \\frac{c}{p}$$\n最后，为了解出 $c$，我们将两边同乘以 $p$：\n$$c = p \\cdot 2^r$$\n这个方程将绝对拷贝数 $c$ 表示为基线倍性 $p$ 和对数转换深度比 $r$ 的函数。\n\n第三个任务是使用给定的值 $p = 3.2$ 和 $r = -0.321928094$ 计算此表达式。\n我们将这些值代入 $c$ 的表达式中：\n$$c = 3.2 \\times 2^{-0.321928094}$$\n为了计算 $2^{-0.321928094}$ 这一项，我们可以认识到该指数是一个特定的对数值。让我们验证一下 $r$ 是否等于 $\\log_2(4/5)$。\n$$ \\log_{2}\\!\\left(\\frac{4}{5}\\right) = \\log_{2}(4) - \\log_{2}(5) = 2 - \\log_{2}(5) $$\n使用 $\\log_{2}(5) \\approx 2.321928094$ 的标准值，我们得到：\n$$ \\log_{2}\\!\\left(\\frac{4}{5}\\right) \\approx 2 - 2.321928094 = -0.321928094 $$\n指数的值精确地对应于 $\\log_2(4/5)$。因此，我们可以将其代回 $c$ 的计算中：\n$$c = 3.2 \\times 2^{\\log_{2}(4/5)}$$\n再次使用性质 $a^{\\log_a(x)} = x$，表达式简化为：\n$$c = 3.2 \\times \\frac{4}{5}$$\n将分数转换为小数，$\\frac{4}{5} = 0.8$：\n$$c = 3.2 \\times 0.8$$\n进行乘法运算：\n$$c = 2.56$$\n问题要求将最终数值结果四舍五入至四位有效数字。计算值 $2.56$ 可以通过添加一个末尾的零来表示为四位有效数字：$2.560$。", "answer": "$$\\boxed{2.560}$$", "id": "5104093"}, {"introduction": "肿瘤样本通常是异质的，由肿瘤细胞和正常细胞混合而成，这一现实极大地影响了拷贝数信号的强度。本练习将推导一个考虑肿瘤纯度 $\\pi$ 的模型，揭示观测到的对数比率信号是如何被正常细胞“稀释”的。理解这种信号衰减效应是准确解读CNV振幅、估算肿瘤纯度以及避免在临床诊断中做出错误判断的关键 [@problem_id:5104100]。", "problem": "在使用下一代测序（NGS）的靶向肿瘤学检测中，通过比较肿瘤样本与配对正常对照的标准化读取深度来执行拷贝数变异（CNV）的识别。假设遵循以下基本原则：（i）标准化读取深度与检测区域的绝对DNA拷贝数成正比，（ii）肿瘤样本由肿瘤细胞和非肿瘤（正常）细胞混合而成，其中肿瘤纯度 $\\pi$ 代表肿瘤细胞的比例，（iii）正常细胞具有基线倍性 $p$，以及（iv）对数比率信号定义为肿瘤覆盖度与正常覆盖度之比以2为底的对数。考虑一个基因组片段，其克隆性肿瘤拷贝状态为 $c_t$，基线倍性为 $p$。设 $r$ 表示在这些假设下该片段的预期对数比率信号。\n\n任务1（推导）：从读取深度与绝对拷贝数的正比关系以及肿瘤和正常细胞混合贡献的线性关系出发，推导 $r$ 关于 $\\pi$、$c_t$ 和 $p$ 的闭式表达式。\n\n任务2（应用以解释振幅）：在一个免疫肿瘤学基因组合（其中 $p=2$）中，通过正交的等位基因特异性分析观察到两个具有已知克隆性肿瘤状态的独立片段：片段A具有 $c_t=1$（单拷贝缺失），片段B具有 $c_t=3$（单拷贝增加）。它们观测到的对数比率振幅（由标准化读取深度计算得出）分别为 $r_A=-0.32193$ 和 $r_B=0.26303$。根据任务1的模型，计算一个与这两个片段都一致的单一肿瘤纯度 $\\pi$。\n\n报告 $\\pi$ 的最终值，四舍五入至三位有效数字，并以小数形式表示（无单位）。在最终答案中仅提供数值。", "solution": "问题陈述已经过严格审查，并被认为是有效的。它在科学上基于从批量下一代测序数据推断拷贝数变异的标准理论模型，问题设定良好，信息充分且一致，可得出唯一解，并以客观、正式的语言表述。没有发现与科学不健全、不完整或模糊性相关的可识别缺陷。\n\n解答按要求分为两部分进行。\n\n**任务1：对数比率信号表达式的推导**\n\n设 $D$ 表示标准化读取深度，$C$ 表示基因组片段的绝对DNA拷贝数。\n根据原则（i），读取深度与拷贝数成正比。我们可以用一个比例常数 $k$ 来表示这种关系：\n$$D = kC$$\n对于配对的正常对照样本，假定细胞是二倍体（或具有一个通用的基线倍性 $p$），因此绝对拷贝数为 $C_{normal} = p$。相应的标准化读取深度为：\n$$D_{normal} = kp$$\n对于肿瘤样本，它是一个细胞混合体，其总读取深度由整个细胞群体的平均绝对拷贝数决定。根据原则（ii），样本由比例为 $\\pi$ 的肿瘤细胞和比例为 $(1-\\pi)$ 的非肿瘤（正常）细胞组成。肿瘤细胞的克隆性拷贝状态为 $c_t$，正常细胞的拷贝数为 $p$。肿瘤样本中的平均绝对拷贝数 $C_{tumor\\_mix}$ 是组成细胞类型拷贝数的加权平均值：\n$$C_{tumor\\_mix} = \\pi \\cdot c_t + (1-\\pi) \\cdot p$$\n因此，肿瘤样本的预期标准化读取深度为：\n$$D_{tumor\\_mix} = k \\cdot C_{tumor\\_mix} = k(\\pi c_t + (1-\\pi)p)$$\n对数比率信号 $r$ 定义为肿瘤覆盖度与正常覆盖度之比以2为底的对数。代入 $D_{tumor\\_mix}$ 和 $D_{normal}$ 的表达式：\n$$r = \\log_2\\left(\\frac{D_{tumor\\_mix}}{D_{normal}}\\right) = \\log_2\\left(\\frac{k(\\pi c_t + (1-\\pi)p)}{kp}\\right)$$\n比例常数 $k$（其值取决于测序技术和文库制备）在比率中被抵消。这种抵消是基于对数比率的CNV分析稳健性的基础。$r$ 的最终闭式表达式为：\n$$r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)p}{p}\\right)$$\n可以对该式稍作整理，以突出与基线的偏离：\n$$r = \\log_2\\left(\\frac{\\pi c_t + p - \\pi p}{p}\\right) = \\log_2\\left(1 + \\frac{\\pi(c_t - p)}{p}\\right)$$\n\n**任务2：应用以计算肿瘤纯度**\n\n问题提供了来自一个基线倍性为 $p=2$ 的检测中两个片段的数据。我们被要求计算一个与这两个片段的数据都一致的单一肿瘤纯度 $\\pi$。\n\n推导出的表达式为 $r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)p}{p}\\right)$。当 $p=2$ 时，该式变为：\n$$r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)2}{2}\\right)$$\n\n对于片段A：$c_t = 1$（单拷贝缺失）且 $r_A = -0.32193$。\n将这些值代入表达式中：\n$$-0.32193 = \\log_2\\left(\\frac{\\pi(1) + (1-\\pi)2}{2}\\right)$$\n$$-0.32193 = \\log_2\\left(\\frac{\\pi + 2 - 2\\pi}{2}\\right)$$\n$$-0.32193 = \\log_2\\left(\\frac{2 - \\pi}{2}\\right)$$\n为了解出 $\\pi$，我们对两边取以2为底的指数：\n$$2^{-0.32193} = \\frac{2 - \\pi}{2}$$\n数值 $-0.32193$ 是 $\\log_2(0.8)$ 的一个高精度近似值。因此，$2^{-0.32193} \\approx 0.8$。\n$$0.8 = \\frac{2 - \\pi}{2}$$\n$$1.6 = 2 - \\pi$$\n$$\\pi = 2 - 1.6 = 0.4$$\n\n对于片段B：$c_t = 3$（单拷贝增加）且 $r_B = 0.26303$。\n我们进行类似的代入来验证 $\\pi$ 的一致性。\n$$0.26303 = \\log_2\\left(\\frac{\\pi(3) + (1-\\pi)2}{2}\\right)$$\n$$0.26303 = \\log_2\\left(\\frac{3\\pi + 2 - 2\\pi}{2}\\right)$$\n$$0.26303 = \\log_2\\left(\\frac{2 + \\pi}{2}\\right)$$\n对两边取指数：\n$$2^{0.26303} = \\frac{2 + \\pi}{2}$$\n数值 $0.26303$ 是 $\\log_2(1.2)$ 的一个高精度近似值。因此，$2^{0.26303} \\approx 1.2$。\n$$1.2 = \\frac{2 + \\pi}{2}$$\n$$2.4 = 2 + \\pi$$\n$$\\pi = 2.4 - 2 = 0.4$$\n两个片段独立地得出了 $\\pi = 0.4$ 的肿瘤纯度。这证实了在所推导的模型下，所提供数据的内部一致性。\n\n问题要求 $\\pi$ 的最终值四舍五入至三位有效数字。数值 $0.4$ 表示为三位有效数字是 $0.400$。", "answer": "$$\\boxed{0.400}$$", "id": "5104100"}]}