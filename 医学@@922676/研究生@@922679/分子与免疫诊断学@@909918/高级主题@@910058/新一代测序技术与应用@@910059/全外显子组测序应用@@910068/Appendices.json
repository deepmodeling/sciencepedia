{"hands_on_practices": [{"introduction": "本练习将深入探讨全外显子组测序的核心技术：杂交捕获。我们将构建一个定量模型，以理解实验参数（特别是洗涤温度）如何影响捕获目标DNA片段的效率和特异性。这项实践有助于洞悉在最大化靶向序列读数（on-target reads）和最小化非靶向序列噪音（off-target noise）之间的关键权衡，这是全外显子组测序实验设计中的一个根本性挑战 [@problem_id:5171455]。", "problem": "一个临床分子诊断实验室对人类基因组DNA进行全外显子组测序（WES）杂交捕获，用于免疫遗传学应用。设可作图的全基因组区域大小为 $G = 3.2 \\times 10^{9}$ 个碱基，外显子组目标区域大小为 $B = 5.0 \\times 10^{7}$ 个碱基。将基因组的目标区域分数定义为 $f_{b} = B/G$。在洗涤前的捕获过程中，预期有 $e_{\\mathrm{on},0}$ 比例的靶向分子与探针有效杂交，有 $e_{\\mathrm{off},0}$ 比例的非靶向分子发生交叉杂交。在温度 $T$ 下的洗涤步骤中，一个解链温度为 $T_{m}$ 的结合双链体被保留的概率为 $r(T,T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$，其中 $\\beta$ 是一个正常数，反映了双链体稳定性对高于 $T_{m}$ 的温度的指数敏感性。假设以下由实验支持的参数：$e_{\\mathrm{on},0} = 0.60$，$e_{\\mathrm{off},0} = 0.020$，$\\beta = 0.50$ (单位为摄氏度的倒数)，靶向双链体的 $T_{m,\\mathrm{on}} = 80$ 摄氏度，而主要的非靶向双链体的 $T_{m,\\mathrm{off}} = 66$ 摄氏度。\n\n假设聚合酶链式反应（PCR）和测序对于靶向与非靶向分子是无偏的，因此在温度 $T$ 下捕获和洗涤后，靶向读数的比例，记为 $f_{\\mathrm{on}}(T)$，等于被保留的捕获分子中靶向分子的比例。将在洗涤温度 $T$ 下的富集倍数定义为\n$$\n\\mathrm{FE}(T) = \\frac{f_{\\mathrm{on}}(T)}{f_{b}}.\n$$\n从 $f_{b}$、$e_{\\mathrm{on},0}$、$e_{\\mathrm{off},0}$ 和 $r(T,T_{m})$ 的定义出发，并利用分子在捕获和洗涤过程中的质量守恒，推导出 $\\mathrm{FE}(T)$ 的表达式，并用它来计算当洗涤温度从 $T = 72$ 摄氏度增加到 $T = 76$ 摄氏度时，富集倍数的倍数变化。即，计算\n$$\nR = \\frac{\\mathrm{FE}(76)}{\\mathrm{FE}(72)}.\n$$\n将答案四舍五入到四位有效数字。将最终结果表示为一个无量纲数。", "solution": "目标是根据捕获、保留和比例测序的第一性原理推导出 $\\mathrm{FE}(T)$，然后计算比率 $R = \\mathrm{FE}(76)/\\mathrm{FE}(72)$。\n\n基本定义和假设：\n1. 基因组的目标区域分数为 $f_{b} = B/G$。\n2. 在洗涤前，靶向分子被有效捕获的预期分数为 $e_{\\mathrm{on},0}$；对于非靶向分子，交叉杂交分数为 $e_{\\mathrm{off},0}$。\n3. 在洗涤温度 $T$ 下，解链温度为 $T_{m}$ 的双链体的保留概率为 $r(T,T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$，这是一个经过充分检验的经验关系，反映了在 $T_{m}$ 以上的指数级失稳。\n4. 洗涤和测序后的靶向读数比例 $f_{\\mathrm{on}}(T)$ 等于被保留的捕获分子中靶向分子的比例，假设下游步骤是无偏的。\n\n设输入分子的总数为 $N$。洗涤前捕获的靶向分子的预期数量为 $N \\cdot f_{b} \\cdot e_{\\mathrm{on},0}$，洗涤前捕获的非靶向分子的预期数量为 $N \\cdot (1 - f_{b}) \\cdot e_{\\mathrm{off},0}$。在温度 $T$ 下洗涤后，保留的数量变为\n$$\nC_{\\mathrm{on}}(T) = N \\cdot f_{b} \\cdot e_{\\mathrm{on},0} \\cdot r\\!\\big(T, T_{m,\\mathrm{on}}\\big),\n$$\n$$\nC_{\\mathrm{off}}(T) = N \\cdot (1 - f_{b}) \\cdot e_{\\mathrm{off},0} \\cdot r\\!\\big(T, T_{m,\\mathrm{off}}\\big).\n$$\n因此，被保留的捕获分子中靶向分子的比例为\n$$\nf_{\\mathrm{on}}(T) = \\frac{C_{\\mathrm{on}}(T)}{C_{\\mathrm{on}}(T) + C_{\\mathrm{off}}(T)} = \\frac{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(T, T_{m,\\mathrm{off}}\\big)}.\n$$\n根据定义，富集倍数 $\\mathrm{FE}(T) = \\frac{f_{\\mathrm{on}}(T)}{f_{b}}$。因此，我们要求的比率 $R$ 为：\n$$\nR = \\frac{\\mathrm{FE}(76)}{\\mathrm{FE}(72)} = \\frac{f_{\\mathrm{on}}(76) / f_{b}}{f_{\\mathrm{on}}(72) / f_{b}} = \\frac{f_{\\mathrm{on}}(76)}{f_{\\mathrm{on}}(72)}\n$$\n代入 $f_{\\mathrm{on}}(T)$ 的表达式，注意到 $f_b e_{\\mathrm{on},0}$ 是公共项，且 $r(T, T_{m,\\mathrm{on}})$ 在 $T=72$ 和 $T=76$ 时都等于1，我们可以得到：\n$$\nR = \\frac{\\frac{f_{b} \\, e_{\\mathrm{on},0}}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(76, T_{m,\\mathrm{off}})}}{\\frac{f_{b} \\, e_{\\mathrm{on},0}}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(72, T_{m,\\mathrm{off}})}} = \\frac{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(72, T_{m,\\mathrm{off}})}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(76, T_{m,\\mathrm{off}})}.\n$$\n我们现在用给定的参数计算。首先计算 $f_{b}$：\n$$\nf_{b} = \\frac{B}{G} = \\frac{5.0 \\times 10^{7}}{3.2 \\times 10^{9}} = \\frac{5.0}{320} = 0.015625.\n$$\n保留函数为 $r(T, T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$，其中 $\\beta = 0.50$。\n对于 $T_{m,\\mathrm{off}} = 66$ 的非靶向双链体，\n$$\nr\\!\\big(72, 66\\big) = \\exp\\!\\big(-0.50 \\cdot (72 - 66)\\big) = \\exp(-3),\n$$\n$$\nr\\!\\big(76, 66\\big) = \\exp\\!\\big(-0.50 \\cdot (76 - 66)\\big) = \\exp(-5).\n$$\n将这些代入 $R$ 的表达式中：\n$$\nR = \\frac{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, \\exp(-3)}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, \\exp(-5)}.\n$$\n现在代入数值 $f_{b} = 0.015625$、$e_{\\mathrm{on},0} = 0.60$、$e_{\\mathrm{off},0} = 0.020$：\n$$\nf_{b} \\, e_{\\mathrm{on},0} = 0.015625 \\times 0.60 = 0.009375,\n$$\n$$\n(1 - f_{b}) \\, e_{\\mathrm{off},0} = 0.984375 \\times 0.020 = 0.0196875.\n$$\n因此，\n$$\nR = \\frac{0.009375 + 0.0196875 \\, \\exp(-3)}{0.009375 + 0.0196875 \\, \\exp(-5)}.\n$$\n在最后一步之前，一直使用 $\\exp(-3)$ 和 $\\exp(-5)$ 的符号形式，然后进行数值计算，\n$$\n\\exp(-3) \\approx 0.049787068, \\quad \\exp(-5) \\approx 0.006737947,\n$$\n得到\n$$\nR \\approx \\frac{0.009375 + 0.0196875 \\times 0.049787068}{0.009375 + 0.0196875 \\times 0.006737947} \\approx \\frac{0.009375 + 0.00098038}{0.009375 + 0.00013271} \\approx \\frac{0.01035538}{0.00950771} \\approx 1.08915.\n$$\n四舍五入到四位有效数字得到\n$$\nR \\approx 1.089.\n$$\n这个无量纲值量化了在所述模型和参数下，当洗涤温度从 $72$ 摄氏度增加到 $76$ 摄氏度时，富集倍数的预测倍数增长。", "answer": "$$\\boxed{1.089}$$", "id": "5171455"}, {"introduction": "测序完成后，我们如何有信心地将一个真实的遗传变异与随机的测序错误区分开来？本练习使用二项分布模型，为变异识别（variant calling）奠定了统计学基础。您将推导观察到变异等位基因的概率，该推导同时考虑了位点的真实杂合性状以及测序技术固有的错误率，从而让您从第一性原理的层面理解生物信息学工具是如何做出判断的 [@problem_id:5171424]。", "problem": "在一个用于检测二倍体基因组中胚系单核苷酸变异的全外显子组测序（WES）分析中，考虑一个真正杂合的基因座。覆盖该基因座的测序读数存在独立的碱基识别错误，每碱基错误率为 $\\epsilon$，其中，一个错误意味着真实的核苷酸被报告为三个不正确的核苷酸之一，且每种的可能性相等。假设每个读数来自参考等位基因或备擇等位基因的概率相等，并且在 $D$ 个覆盖读数中的抽样是相互独立的。一个“备擇读数”被定义为在该基因座上，其观测到的碱基与真实的备擇等位基因相匹配的读数，而不仅仅是一个非参考碱基。使用基于读数独立性以及杂合性定义为真实等位基因频率为 $\\frac{1}{2}$ 的二项抽样模型，从第一性原理出发，推导在 $D$ 个总读数中观测到至少 $k$ 个备择读数的概率，并将其表示为 $D$、$k$ 和 $\\epsilon$ 的函数。将最终概率表示为关于 $D$、$k$ 和 $\\epsilon$ 的单个闭式解析表达式。无需进行数值计算。", "solution": "问题要求计算在 $D$ 个读数的样本中观测到至少 $k$ 个“备择读数”的概率。这些读数是独立的，每个读数成为“备擇读数”都有一定的概率。这是一个适用于二项分布的经典情景。设随机变量 $X$ 表示在 $D$ 个总读数中观测到的备擇读数的数量。那么 $X$ 服从二项分布，$X \\sim B(D, p)$，其中 $p$ 是单个随机选择的读数成为“备擇读数”的概率。我们的首要任务是推导出这个概率 $p$。\n\n一个读数可以源自参考等位基因，也可以源自备擇等位基因。由于该基因座在二倍体基因组中是杂合的，一个读数源自参考等位基因的概率是 $\\frac{1}{2}$，源自备擇等位基因的概率也是 $\\frac{1}{2}$。设 $R_{alt}$ 是读数来自备擇等位基因的事件，而 $R_{ref}$ 是读数来自参考等位基因的事件。我们有：\n$$P(R_{alt}) = \\frac{1}{2}$$\n$$P(R_{ref}) = \\frac{1}{2}$$\n\n设 $O_{alt}$ 为在读数中观测到的碱基是备擇等位基因的事件（即，它是一个“备擇读数”）。我们可以通过对读数的真实来源进行条件分析，使用全概率定律来计算 $O_{alt}$ 的总概率：\n$$p = P(O_{alt}) = P(O_{alt} | R_{alt}) P(R_{alt}) + P(O_{alt} | R_{ref}) P(R_{ref})$$\n\n现在我们必须确定这两个条件概率：\n1.  $P(O_{alt} | R_{alt})$：这是在读数确实来自备擇等位基因的情况下，观测到备擇等位基因的概率。这种情况发生在碱基被正确读取时，其概率为 $1 - \\epsilon$。\n    $$P(O_{alt} | R_{alt}) = 1 - \\epsilon$$\n\n2.  $P(O_{alt} | R_{ref})$：这是在读数确实来自参考等位基因的情况下，观测到备擇等位基因的概率。这只可能在发生测序错误时出现。发生错误的概率是 $\\epsilon$。问题陈述，当错误发生时，测序仪会以相等的概率报告三个不正确的核苷酸中的任意一个。由于真实的碱基是参考碱基，备擇碱基是这三个不正确选项之一。因此，一个错误具体导致备擇碱基的概率是 $\\frac{1}{3}$。组合概率是发生错误的概率与该错误产生备择碱基的概率的乘积。\n    $$P(O_{alt} | R_{ref}) = \\epsilon \\times \\frac{1}{3} = \\frac{\\epsilon}{3}$$\n\n将这些条件概率代回 $p$ 的方程中：\n$$p = (1 - \\epsilon) \\left(\\frac{1}{2}\\right) + \\left(\\frac{\\epsilon}{3}\\right) \\left(\\frac{1}{2}\\right)$$\n$$p = \\frac{1}{2} - \\frac{\\epsilon}{2} + \\frac{\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{3\\epsilon}{6} + \\frac{\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{2\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{\\epsilon}{3}$$\n\n其互补概率，即一个读数不是备擇读数的概率，是 $1-p$：\n$$1-p = 1 - \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right) = \\frac{1}{2} + \\frac{\\epsilon}{3}$$\n\n现在我们已经有了单次试验的概率 $p$，我们可以对 $D$ 次试验中备擇读数的总数 $X$ 进行建模。在 $D$ 次试验中观测到恰好 $i$ 个备擇读数的概率由二项概率质量函数给出：\n$$P(X=i) = \\binom{D}{i} p^i (1-p)^{D-i}$$\n\n问题要求的是观测到至少 $k$ 个备擇读数的概率，即 $P(X \\ge k)$。这是观测到 $k, k+1, \\dots, D$ 个备擇读数的概率之和：\n$$P(X \\ge k) = \\sum_{i=k}^{D} P(X=i)$$\n$$P(X \\ge k) = \\sum_{i=k}^{D} \\binom{D}{i} p^i (1-p)^{D-i}$$\n\n将 $p$ 和 $1-p$ 的表达式（用 $\\epsilon$ 表示）代入：\n$$P(X \\ge k) = \\sum_{i=k}^{D} \\binom{D}{i} \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right)^i \\left(\\frac{1}{2} + \\frac{\\epsilon}{3}\\right)^{D-i}$$\n\n该表达式代表最终答案。它是一个关于给定参数 $D$、$k$ 和 $\\epsilon$ 的、表示所求概率的单一闭式解析表达式。", "answer": "$$\\boxed{\\sum_{i=k}^{D} \\binom{D}{i} \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right)^{i} \\left(\\frac{1}{2} + \\frac{\\epsilon}{3}\\right)^{D-i}}$$", "id": "5171424"}, {"introduction": "全外显子组测序是精准肿瘤学的基石，而肿瘤突变负荷（Tumor Mutational Burden, TMB）是其衍生的关键生物标志物之一。这项实践模拟了一个真实的临床情景，您将根据原始的变异数据计算TMB。通过区分不同类型的突变并应用“可分析区域”（callable territory）的概念，您将学习到这个用于预测免疫治疗反应的重要指标是如何被严格定义和计算的 [@problem_id:4396805]。", "problem": "一个临床实验室对实体瘤及其配对的正常样本进行全外显子组测序 (WES)，以估计肿瘤突变负荷 (TMB)，此处 TMB 定义为每兆碱基可靠编码序列中非同义体细胞单核苷酸变异的数量。假设以下基本前提：分子生物学中心法则确立了 DNA 是可遗传的底物，蛋白质编码序列（外显子组）从中衍生而来；WES 靶向蛋白质编码区域（外显子）；单核苷酸变异 (SNV) 是单个碱基上的点突变；可靠区域是靶向碱基中满足预定质量标准（例如，覆盖深度阈值、比对质量和可比对性）的子集，确保能够可靠地检测到体细胞变异；并且，当如上定义时，TMB 是可靠编码兆碱基上非同义体细胞 SNV 的密度。\n\n对于单个肿瘤样本，通过与配对正常样本进行变异检出，在靶向编码区域中总共鉴定出 $N_{\\text{SNV}}^{\\text{total}}=512$ 个体细胞单核苷酸变异。质量控制和功能注释在靶向外显子组内得出以下划分：\n- 在可靠编码区域内，检测到 $N_{\\text{callable}}=438$ 个体细胞 SNV。\n- 在这些可靠的 SNV 中，有 $N_{\\text{nonsyn}}=346$ 个是非同义的，有 $N_{\\text{syn}}=92$ 个是同义的。\n- 在可靠区域之外（覆盖度低或可比对性差），检测到 $N_{\\text{noncallable}}=74$ 个体细胞 SNV；根据可靠区域的定义，这些变异被排除在 TMB 计算之外。\n\n在应用实验室的质量过滤器后，可靠编码区域的长度为 $L_{\\text{callable}}=28.7$ 兆碱基。\n\n从上述基本前提开始，推导在此定义下用于计算 TMB 的解析表达式，然后仅使用适当的计数和区域长度计算此样本的 TMB。以每兆碱基的突变数表示您的最终答案，并将数值结果四舍五入到四位有效数字。", "solution": "该问题要求根据特定定义推导肿瘤突变负荷 (TMB) 的解析表达式，并随后计算给定肿瘤样本的 TMB 值。该过程从对定义的正式陈述开始。\n\n问题将肿瘤突变负荷 (TMB) 定义为每兆碱基可靠编码序列中非同义体细胞单核苷酸变异的数量。让我们将此定义形式化为一个数学表达式。\n\n设 $TMB$ 代表肿瘤突变负荷。\n设 $N_{\\text{nonsyn}}$ 为在可靠区域内鉴定出的非同义体细胞单核苷酸变异的数量。\n设 $L_{\\text{callable}}$ 为可靠编码序列的长度，以兆碱基 (Mb) 为单位。\n\n根据“数量……每兆碱基”的定义，TMB 是一个密度，计算方法是相关变异数量与计数它们所在的基因组区域长度之比。因此，解析表达式为：\n$$\nTMB = \\frac{N_{\\text{nonsyn}}}{L_{\\text{callable}}}\n$$\n该数量的单位将是突变/兆碱基 (mut/Mb)。\n\n问题提供了从肿瘤样本分析中得出的以下数据：\n- 靶向编码区域中的总计体细胞 SNV：$N_{\\text{SNV}}^{\\text{total}} = 512$\n- 可靠编码区域内的体细胞 SNV：$N_{\\text{callable}} = 438$\n- 可靠区域内的非同义体细胞 SNV：$N_{\\text{nonsyn}} = 346$\n- 可靠区域内的同义体细胞 SNV：$N_{\\text{syn}} = 92$\n- 可靠区域外的体细胞 SNV：$N_{\\text{noncallable}} = 74$\n- 可靠编码区域长度：$L_{\\text{callable}} = 28.7$ Mb\n\n为了计算 TMB，我们必须根据推导出的公式从此列表中选择正确的值。定义明确要求*非同义* SNV 的数量。因此，我们必须使用 $N_{\\text{nonsyn}} = 346$。其他计数，如同义 SNV ($N_{\\text{syn}}$)、不可靠区域 SNV ($N_{\\text{noncallable}}$) 和总 SNV ($N_{\\text{SNV}}^{\\text{total}}$)，与本问题陈述中定义的 TMB 计算无关。分母明确是*可靠的*编码区域长度，给定为 $L_{\\text{callable}} = 28.7$ Mb。\n\n将适当的值代入 TMB 的表达式中：\n$$\nTMB = \\frac{346}{28.7}\n$$\n\n现在，我们进行除法运算以获得一个数值：\n$$\nTMB \\approx 12.0557491289... \\text{ mut/Mb}\n$$\n\n问题要求最终答案四舍五入到四位有效数字。结果的前四位有效数字是 $1$、$2$、$0$ 和 $5$。第五位有效数字是 $5$，这决定了我们将第四位有效数字向上取整。因此，$12.05$ 变为 $12.06$。\n\n此样本最终计算出的 TMB 为 $12.06$ mut/Mb。", "answer": "$$\\boxed{12.06}$$", "id": "4396805"}]}