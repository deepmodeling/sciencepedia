{"hands_on_practices": [{"introduction": "扩增子测序panel设计的成功始于高效且特异的PCR扩增，而这在根本上取决于引物的热力学行为。本练习将引导您从基本的热力学原理出发，推导并计算引物熔解温度（$T_m$），这是优化退火条件和确保扩增均一性的核心参数。通过这个实践，您将深刻理解DNA双链的稳定性如何由焓（$\\Delta H$）、熵（$\\Delta S$）和离子环境等因素共同决定 [@problem_id:5088962]。", "problem": "在分子与免疫诊断学中，基于扩增子的测序板设计必须选择引物以实现各靶标之间平衡的退火行为。考虑一条为与其完美互补链结合而设计的非自互补的 $20$ 个核苷酸的引物。其双链形成反应为 $A + B \\rightleftharpoons AB$，在 $[\\text{Na}^+] = 50$ 毫摩尔的条件下，通过最近邻模型汇总并经实验测定的双链标准热力学参数为：$\\Delta H = -98.2$ 千卡/摩尔，$\\Delta S = -270$ 卡/(开尔文·摩尔)。总链浓度（两条单链之和）为 $C = 0.25$ 微摩尔，且两条链以等摩尔混合。使用解链温度 $T_{m}$ 的定义，即总链中一半处于双链状态、一半保持单链状态时的温度，从第一性原理（热力学和质量作用平衡）推导出 $T_{m}$ 的表达式，并假设为理想溶液行为。\n\n计算在这些条件下 $T_{m}$ 的数值，并将最终温度以摄氏度表示。答案四舍五入至四位有效数字。然后，在您的推导中，从热力学和聚电解质的角度讨论，与单价钠离子 $Na^{+}$ 相比，二价镁离子 $Mg^{2+}$ 的存在将如何改变离子强度校正，以及 $T_{m}$ 将会增加还是减少，无需对 $Mg^{2+}$ 进行单独的数值计算。\n\n在推导中以符号形式使用摩尔气体常数 $R$，仅在最终数值计算时采用 $R = 1.987$ 卡/(开尔文·摩尔)。请明确说明您在将热力学量与指定离子条件下引物的退火行为联系起来时所做的任何假设。", "solution": "在尝试给出解答之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 反应：$A + B \\rightleftharpoons AB$，用于非自互补双链的形成。\n- 引物长度：$20$ 个核苷酸。\n- 标准焓变：$\\Delta H^\\circ = -98.2$ 千卡/摩尔。\n- 标准熵变：$\\Delta S^\\circ = -270$ 卡/(开尔文·摩尔)。\n- 离子条件：$[\\text{Na}^+] = 50$ 毫摩尔。\n- 总链浓度（两条单链之和）：$C = 0.25$ 微摩尔。\n- 化学计量：链 $A$ 和链 $B$ 的等摩尔混合物。\n- 解链温度（$T_m$）的定义：总链中一半形成双链，一半保持单链时的温度。\n- 气体常数：$R$ (符号)；在数值计算中使用 $R = 1.987$ 卡/(开尔文·摩尔)。\n- 最终答案格式：$T_m$ 的数值，以摄氏度为单位，保留四位有效数字。\n- 附加任务：讨论 $Mg^{2+}$ 与 $Na^{+}$ 对 $T_m$ 的影响。\n- 假设：理想溶液行为。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估该问题。\n- **科学性**：该问题基于化学热力学和生物物理化学的基本原理，特别是核酸杂交的最近邻模型。吉布斯自由能、平衡常数和温度之间的关系是物理化学的基石。所提供的热力学值和浓度对于分子生物学应用是切合实际的。所要求的关于离子强度对聚电解质（DNA）影响的讨论是生物化学中的一个标准课题。该问题在科学上是合理的。\n- **良构性**：所有必要的数据（$\\Delta H^\\circ$、$\\Delta S^\\circ$、$C$、$R$）都已提供，足以推导出 $T_m$ 的表达式并计算其值。$T_m$ 的定义是明确的，允许唯一的数学表述。问题是自洽且明确的。\n- **客观性**：问题以精确、定量和客观的语言陈述，不含任何主观或推测性内容。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个来自生物物理化学领域的、提法明确且科学合理的题目。现在将从第一性原理推导解答。\n\n### 解链温度（$T_m$）的推导\n\n由两条非自互补链 $A$ 和 $B$ 形成 DNA 双链的过程由以下平衡反应描述：\n$$A + B \\rightleftharpoons AB$$\n此反应的平衡常数 $K$ 由平衡时各物质的浓度之比给出：\n$$K = \\frac{[AB]}{[A][B]}$$\n标准吉布斯自由能变 $\\Delta G^\\circ$ 与平衡常数通过基本热力学方程相关联：\n$$\\Delta G^\\circ = -RT \\ln K$$\n其中 $R$ 是摩尔气体常数， $T$ 是绝对温度（开尔文）。标准吉布斯自由能变也与标准焓变 $\\Delta H^\\circ$ 和标准熵变 $\\Delta S^\\circ$ 相关：\n$$\\Delta G^\\circ = \\Delta H^\\circ - T \\Delta S^\\circ$$\n通过令这两个 $\\Delta G^\\circ$ 的表达式相等，我们得到：\n$$-RT \\ln K = \\Delta H^\\circ - T \\Delta S^\\circ$$\n解出 $\\ln K$ 可得：\n$$\\ln K = -\\frac{\\Delta H^\\circ}{RT} + \\frac{\\Delta S^\\circ}{R}$$\n该方程将平衡常数与给定温度 $T$ 下的热力学参数联系起来。\n\n现在，我们必须计算解链温度 $T_m$ 时的浓度。问题将 $T_m$ 定义为总链中一半形成双链时的温度。总链浓度 $C$ 被给出为在没有双链形成时两条单链的浓度之和。由于两条链是等摩尔混合的，链 $A$ 和链 $B$ 的初始总浓度相等，我们称之为 $[A]_{total}$ 和 $[B]_{total}$。\n$$[A]_{total} = [B]_{total} = \\frac{C}{2}$$\n体系中链的总浓度为 $[A] + [B] + 2[AB]$，它必须等于初始总链浓度 $C$。在 $T_m$ 时，这些链的一半处于双链中。结合到双链中的链的浓度为 $2[AB]$。因此，在 $T = T_m$ 时：\n$$2[AB] = \\frac{1}{2}C \\implies [AB] = \\frac{C}{4}$$\n剩下的一半链是单链，所以 $[A] + [B] = \\frac{1}{2}C$。因为两条链是等摩尔加入的，并且以 $1:1$ 的比例消耗以形成双链，所以它们在平衡时的游离浓度必须相等：$[A] = [B]$。\n因此，在 $T=T_m$ 时：\n$$[A] + [A] = \\frac{1}{2}C \\implies 2[A] = \\frac{C}{2} \\implies [A] = \\frac{C}{4}$$\n因此，$[B] = C/4$。\n\n我们现在可以将这些浓度代入 $T=T_m$ 时平衡常数的表达式中：\n$$K = \\frac{[AB]}{[A][B]} = \\frac{C/4}{(C/4)(C/4)} = \\frac{4}{C}$$\n将这个 $K$ 的表达式代入 $T = T_m$ 时的热力学关系式中：\n$$\\ln\\left(\\frac{4}{C}\\right) = -\\frac{\\Delta H^\\circ}{RT_m} + \\frac{\\Delta S^\\circ}{R}$$\n我们现在必须解出 $T_m$：\n$$\\frac{\\Delta H^\\circ}{RT_m} = \\frac{\\Delta S^\\circ}{R} - \\ln\\left(\\frac{4}{C}\\right)$$\n$$\\frac{\\Delta H^\\circ}{RT_m} = \\frac{\\Delta S^\\circ}{R} + \\ln\\left(\\frac{C}{4}\\right)$$\n$$\\frac{1}{T_m} = \\frac{R}{\\Delta H^\\circ} \\left( \\frac{\\Delta S^\\circ}{R} + \\ln\\left(\\frac{C}{4}\\right) \\right) = \\frac{\\Delta S^\\circ + R \\ln(C/4)}{\\Delta H^\\circ}$$\n最终，解链温度的表达式为：\n$$T_m = \\frac{\\Delta H^\\circ}{\\Delta S^\\circ + R \\ln(C/4)}$$\n这是从第一性原理推导出的 $T_m$ 表达式。\n\n在此推导中，除了理想溶液行为外，主要假设是标准焓（$\\Delta H^\\circ$）和熵（$\\Delta S^\\circ$）是常数，在所考虑的温度范围内不随温度变化。这在生物物理化学中是一个标准且合理的近似。问题指明，所提供的热力学参数在给定离子条件下有效，这构成了将其直接用于计算的基础。\n\n### $T_m$ 的数值计算\n\n我们已知以下数值：\n- $\\Delta H^\\circ = -98.2 \\text{ kcal/mol} = -98200 \\text{ cal/mol}$\n- $\\Delta S^\\circ = -270 \\text{ cal/(K·mol)}$\n- $C = 0.25 \\text{ µM} = 0.25 \\times 10^{-6} \\text{ M}$\n- $R = 1.987 \\text{ cal/(K·mol)}$\n\n首先，我们计算 $R \\ln(C/4)$ 项：\n$$\\frac{C}{4} = \\frac{0.25 \\times 10^{-6} \\text{ M}}{4} = 6.25 \\times 10^{-8} \\text{ M}$$\n$$R \\ln\\left(\\frac{C}{4}\\right) = (1.987 \\text{ cal/(K·mol)}) \\times \\ln(6.25 \\times 10^{-8})$$\n$$R \\ln\\left(\\frac{C}{4}\\right) \\approx (1.987) \\times (-16.5882) \\text{ cal/(K·mol)} \\approx -32.9624 \\text{ cal/(K·mol)}$$\n现在，我们计算 $T_m$ 表达式的分母：\n$$\\Delta S^\\circ + R \\ln(C/4) = -270 \\text{ cal/(K·mol)} - 32.9624 \\text{ cal/(K·mol)} = -302.9624 \\text{ cal/(K·mol)}$$\n现在，我们可以计算以开尔文为单位的 $T_m$：\n$$T_m = \\frac{-98200 \\text{ cal/mol}}{-302.9624 \\text{ cal/(K·mol)}} \\approx 324.134 \\text{ K}$$\n最后，我们将温度转换为摄氏度 ($T_{^\\circ C} = T_K - 273.15$):\n$$T_m(^{\\circ}\\text{C}) = 324.134 - 273.15 = 50.984\\,^{\\circ}\\text{C}$$\n四舍五入到四位有效数字，我们得到 $T_m = 50.98\\,^{\\circ}\\text{C}$。\n\n### 关于 $Mg^{2+}$ 影响的讨论\n\n从**聚电解质的角度**来看，DNA 双链是一种高度带电的大分子。每条链的糖-磷酸骨架带有一系列来自磷酸基团（$\\text{PO}_4^-$）的负电荷。当两条链结合形成双链时，这些负电荷被带到很近的距离，导致强烈的静电排斥。这种排斥是反对双链形成的主要去稳定力。\n\n溶液中的阳离子，如单价钠离子（$Na^+$），充当抗衡离子。它们在 DNA 骨架周围形成一个弥散的离子“云”，从而屏蔽了负电荷之间的相互作用。这种**抗衡离子屏蔽效应**减小了链间的静电排斥，从而稳定了双链。\n\n当用二价镁离子（$Mg^{2+}$）取代单价 $Na^+$ 时，稳定效应显著增强。这主要有两个原因：\n1.  **更高的电荷：** 单个 $Mg^{2+}$ 离子携带的电荷是 $Na^+$ 离子的两倍，这使其在抵消磷酸骨架的负电荷方面效率高得多。\n2.  **更高的电荷密度：** $Mg^{2+}$ 的有效离子半径通常比 $Na^+$ 小，导致其电荷密度更高。这使其能够与磷酸基团发生更强、更近的相互作用。已有研究表明，$Mg^{2+}$ 既可以与磷酸氧原子形成外层（水合）配位络合物，也可以形成内层（直接）配位络合物，从而实现极其高效的电荷中和。\n\n从**热力学的角度**来看，这种增强的稳定性意味着，与等摩尔浓度的 $Na^+$ 相比，在 $Mg^{2+}$ 存在下，双链形成的自由能 $\\Delta G^\\circ$ 变得更负（更有利）。由于 $\\Delta G^\\circ = \\Delta H^\\circ - T\\Delta S^\\circ$，更稳定的双链需要更多的热能来解离。解链温度 $T_m$ 是双链解离的点。因此，由于 $Mg^{2+}$ 提供了更优越的静电屏蔽，DNA 双链的 $T_m$ 将会**增加**。需要更高的温度来提供足够的动能，以克服氢键和现在被更有效屏蔽的静电相互作用共同维持双链的合力。", "answer": "$$\\boxed{50.98}$$", "id": "5088962"}, {"introduction": "在设计好单个引物后，下一步是将它们有效地组织起来，以完全覆盖我们感兴趣的目标区域（如外显子）。这个过程被称为“瓦片式”（tiling）设计，是一个将设计规范（如扩增子长度和重叠区域）转化为具体扩增策略的算法问题。本练习将让您亲手制定一个瓦片式扩增方案，学习如何通过系统性的计算来确定覆盖特定长度基因组区域所需的最少扩增子数量 [@problem_id:5088961]。", "problem": "您正在为临床分子和免疫诊断设计一个靶向扩增子测序panel，用于检测三个长度分别为$120$碱基对、$240$碱基对和$310$碱基对的外显子。每个靶区域（外显子）在进行二代测序（NGS）之前，必须被聚合酶链式反应（PCR）扩增子完全覆盖。设计要求如下：\n- 固定的扩增子长度为$175$碱基对。\n- 同一外显子内相邻扩增子之间至少需要有$25$碱基对的重叠，以确保冗余度和覆盖均匀性。\n- 因此，连续扩增子起始坐标之间的步长被限制为至多是扩增子长度减去最小重叠。为简化设计，采用左端锚定平铺规则：对于每个外显子，将第一个扩增子的起始位置置于外显子坐标$1$，然后通过以最大允许步长推进起始位置来放置后续扩增子，直至外显子被完全覆盖。最后一个扩增子可以延伸到外显子边界之外的侧翼内含子序列中；只要外显子被完全覆盖，这是可接受的。\n- 来自不同外显子的扩增子是独立设计的。\n\n仅从这些定义和基因组覆盖的核心概念（即扩增子区间的并集必须跨越整个外显子区间）出发，在满足上述约束条件下，推导出一个表达式，用于计算覆盖长度为$L$的外显子所需的最小扩增子数量。然后，应用您的推导为这三个外显子中的每一个计算具体的平铺方案（使用左端锚定规则，在外显子相对坐标系中的起始和终止坐标），并确定所有三个外显子所需的扩增子总数。\n\n将所有外显子所需扩增子的总数作为最终答案。不包含任何单位。无需四舍五入。最终答案必须是单个数字。", "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、良定、客观且自洽的。它提出了一个标准的生物信息学扩增子平铺问题，具有明确定义的约束和目标。在临床分子诊断的背景下，所提供的值是现实的。因此，有必要提供完整的解答。\n\n该问题要求推导一个通用表达式，用于计算覆盖给定长度外显子所需的最小扩增子数量，然后将此表达式应用于三个特定的外显子，以确定整个测序panel所需的扩增子总数。\n\n首先，我们将问题陈述中提供的变量和约束形式化。\n设$L$为外显子的长度，单位为碱基对（bp）。外显子由坐标的整数区间$[1, L]$表示。\n设$A$为每个PCR扩增子的固定长度，给定为$A = 175$ bp。\n设$O_{min}$为相邻扩增子之间的最小重叠要求，给定为$O_{min} = 25$ bp。\n问题指定了具有最大步长$S_{max}$的左端锚定平铺规则。步长是连续扩增子起始坐标之间的距离。最大允许步长由扩增子长度减去最小重叠给出：\n$$S_{max} = A - O_{min}$$\n代入给定值：\n$$S_{max} = 175 - 25 = 150 \\text{ bp}$$\n\n设$N$为覆盖长度为$L$的外显子所需的扩增子数量。第$i$个扩增子（$i = 1, 2, ..., N$）的起始坐标记为$s_i$。根据左端锚定平铺规则：\n第一个扩增子从坐标$1$开始：\n$$s_1 = 1$$\n后续扩增子的放置通过将起始坐标前移最大步长$S_{max}$来完成：\n$$s_i = s_{i-1} + S_{max} \\quad \\text{for } i > 1$$\n这给出了一个用于计算第$i$个扩增子起始坐标的通用表达式：\n$$s_i = 1 + (i-1)S_{max}$$\n一个从$s_i$开始、长度为$A$的扩增子覆盖基因组坐标区间$[s_i, s_i + A - 1]$。为了完全覆盖整个外显子，所有$N$个扩增子区间的并集必须包含整个外显子区间$[1, L]$。如果最后一个扩增子的终止坐标$e_N = s_N + A - 1$大于或等于外显子的终止坐标$L$，则此条件得到满足。\n$$s_N + A - 1 \\ge L$$\n代入$s_N$的表达式：\n$$[1 + (N-1)S_{max}] + A - 1 \\ge L$$\n$$(N-1)S_{max} + A \\ge L$$\n我们现在必须解这个关于$N$的不等式，$N$必须是正整数（$N \\ge 1$）。\n$$(N-1)S_{max} \\ge L - A$$\n如果$L \\le A$，一个扩增子就足够了。让我们用$N=1$来检验这个不等式。不等式变为$(1-1)S_{max} \\ge L-A$，化简为$0 \\ge L-A$，或$A \\ge L$。根据我们的假设，这是成立的，因此如果$L \\le A$，$N=1$是最小解。\n\n如果$L > A$，我们需要多于一个的扩增子。我们可以除以$S_{max}$（它是一个正数）：\n$$N-1 \\ge \\frac{L-A}{S_{max}}$$\n$$N \\ge 1 + \\frac{L-A}{S_{max}}$$\n由于$N$必须是一个整数，$N$的最小值是满足此条件的最小整数，这可以通过应用向上取整函数（ceiling function）找到：\n$$N = \\left\\lceil 1 + \\frac{L-A}{S_{max}} \\right\\rceil$$\n向上取整函数的性质$\\lceil k+x \\rceil = k + \\lceil x \\rceil$（对于任何整数$k$）允许我们将其写成：\n$$N = 1 + \\left\\lceil \\frac{L-A}{S_{max}} \\right\\rceil$$\n由于我们假设$L > A$，项$\\frac{L-A}{S_{max}}$是正的，并且其向上取整至少为$1$。因此，$N \\ge 2$，这与需要多于一个扩增子的情况是一致的。\n\n结合两种情况，覆盖长度为$L$的外显子所需的最小扩增子数$N$是：\n$$N(L) = \\begin{cases} 1  \\text{if } L \\le A \\\\ 1 + \\left\\lceil \\frac{L-A}{S_{max}} \\right\\rceil  \\text{if } L > A \\end{cases}$$\n这就是推导出的通用表达式。\n\n现在，我们将此表达式应用于问题中给出的三个外显子，其中$A=175$且$S_{max}=150$。\n\n外显子 1: $L_1 = 120$ bp\n由于$L_1 = 120 \\le A=175$，只需要一个扩增子。\n$N_1 = 1$\n外显子 1 的平铺方案：\n- 扩增子 1: $s_1 = 1$。该扩增子覆盖坐标$[1, 1+175-1] = [1, 175]$。这完全覆盖了外显子区间$[1, 120]$。\n\n外显子 2: $L_2 = 240$ bp\n由于$L_2 = 240 > A=175$，我们使用公式的第二种情况。\n$$N_2 = 1 + \\left\\lceil \\frac{L_2-A}{S_{max}} \\right\\rceil = 1 + \\left\\lceil \\frac{240-175}{150} \\right\\rceil = 1 + \\left\\lceil \\frac{65}{150} \\right\\rceil = 1 + \\lceil 0.433... \\rceil = 1+1=2$$\n所以，需要$N_2 = 2$个扩增子。\n外显子 2 的平铺方案：\n- 扩增子 1: $s_1 = 1$。覆盖$[1, 175]$。\n- 扩增子 2: $s_2 = 1 + (2-1) \\times 150 = 151$。覆盖$[151, 151+175-1] = [151, 325]$。\n覆盖的并集是$[1, 325]$，这完全覆盖了外显子区间$[1, 240]$。重叠部分是区间$[151, 175]$，长度为$25$ bp，满足最小重叠要求。\n\n外显子 3: $L_3 = 310$ bp\n由于$L_3 = 310 > A=175$，我们再次使用第二种情况。\n$$N_3 = 1 + \\left\\lceil \\frac{L_3-A}{S_{max}} \\right\\rceil = 1 + \\left\\lceil \\frac{310-175}{150} \\right\\rceil = 1 + \\left\\lceil \\frac{135}{150} \\right\\rceil = 1 + \\lceil 0.9 \\rceil = 1+1=2$$\n所以，需要$N_3 = 2$个扩增子。\n外显子 3 的平铺方案：\n- 扩增子 1: $s_1 = 1$。覆盖$[1, 175]$。\n- 扩增子 2: $s_2 = 1 + (2-1) \\times 150 = 151$。覆盖$[151, 151+175-1] = [151, 325]$。\n覆盖的并集是$[1, 325]$，这完全覆盖了外显子区间$[1, 310]$。重叠部分也是$25$ bp。\n\n最后，所有三个外显子所需的扩增子总数是每个外显子所需扩增子数量的总和。\n$$N_{total} = N_1 + N_2 + N_3 = 1 + 2 + 2 = 5$$\n该panel所需的扩增子总数为$5$。", "answer": "$$\\boxed{5}$$", "id": "5088961"}, {"introduction": "一个设计精良的panel不仅要能扩增出目标，更要能以足够的统计功效检测出目标变异，尤其是在诊断应用中。本练习聚焦于测序实验的统计设计，要求您建立一个随机模型来确定检测低频变异所需的最小测序深度。您将学会如何在灵敏度（真阳性率）和特异性（假阳性率）之间进行权衡，确保您的检测方案在临床上是可靠和有效的 [@problem_id:5088999]。", "problem": "正在设计一个用于分子和免疫诊断的基于扩增子的测序 panel，以检测异质样本中以 $0.005$ 的变异等位基因频率（VAF）存在的预先指定的单核苷酸变异。假设覆盖该位点的每条测序读数（read）都是独立的。如果至少有 $T$ 条读数支持替代碱基，则进行变异检出。每个碱基的替换错误率为 $e = 10^{-3}$，并假设测序错误在三种不正确的核苷酸之间均匀替换。变异检测阈值 $T$ 的选择必须使得在零假设（该位点没有真实变异）下，位点级别的假阳性率满足 $\\Pr(K \\geq T \\mid \\text{null})  10^{-4}$，其中 $K$ 是支持该位点替代碱基的读数计数。在备择假设（变异以 VAF $f = 0.005$ 存在）下，灵敏度必须至少为 $0.95$，即 $\\Pr(K \\geq T \\mid \\text{alternative}) \\geq 0.95$。\n\n使用读数计数的随机建模第一性原理，将 $K$ 建模为对 $n$ 条读数进行的独立伯努利试验的总和，并在零假设和备择假设下使用适当的单次读数成功概率。当 $n$ 很大且单次读数成功概率很小时，请论证在固定计数阈值 $T$ 下对尾部概率使用何种近似方法是合适的。然后，计算最小整数测序深度 $n$（以读数计），使得存在一个整数阈值 $T$ 的选择，能同时满足上述两个约束条件。将最终答案表示为单个整数（无单位）。如果使用任何数值近似，请确保最终的 $n$ 是精确满足约束条件的最小整数（无需按有效数字取整）。所有概率必须以小数或分数表示，而非百分比。", "solution": "该问题要求计算设计一个基于扩增子的测序 panel 所需的最小测序深度 $n$，该 panel 需能在特定性能约束下区分单核苷酸变异（SNV）的存在（备择假设）与否（零假设）。\n\n首先，我们必须验证问题陈述。\n\n### 步骤 1：提取给定信息\n- 备择假设下的变异等位基因频率（VAF）：$f = 0.005$。\n- 每个碱基的替换错误率：$e = 10^{-3}$。\n- 测序错误在三种不正确的核苷酸之间均匀替换。\n- 独立读数的总数（测序深度）：$n$。\n- 支持替代碱基的读数数量：$K$。\n- 检测阈值：如果 $K \\geq T$（其中 $T$ 为整数），则进行变异检出。\n- 约束 1（特异性/假阳性率）：$\\Pr(K \\geq T \\mid \\text{null})  10^{-4}$。零假设是真实变异不存在。\n- 约束 2（灵敏度/真阳性率）：$\\Pr(K \\geq T \\mid \\text{alternative}) \\geq 0.95$。备择假设是变异以 VAF $f$ 存在。\n\n### 步骤 2：使用提取的信息进行验证\n- **科学依据**：该问题是生物信息学和分子诊断领域中一个标准的、现实的场景，特别是在设计用于低频变异检测的下一代测序分析方法时。将读数计数建模为独立伯努利试验之和是该领域的基础。\n- **适定性**：该问题是适定的。它要求找到最小整数 $n$，使得存在一个整数阈值 $T$ 满足两个明确定义的不等式。预期会有一个唯一解。\n- **客观性**：该问题使用精确、客观和定量的语言陈述。所有参数和约束都得到了正式定义。\n\n该问题没有表现出任何科学上不健全、信息缺失或模棱两可的缺陷。\n\n### 步骤 3：结论与行动\n问题被判定为 **有效**。将提供完整解答。\n\n### 解题推导\n\n**1. 读数计数变量 $K$ 的建模**\n在总共 $n$ 条独立读数中，支持替代等位基因的读数数量 $K$ 可以用二项分布 $K \\sim \\text{Binomial}(n, p)$ 来建模，其中 $p$ 是单条读数支持替代等位基因的概率。这个概率 $p$ 在零假设和备择假设下是不同的。\n\n**在零假设下（无真实变异）：**\n读数支持替代碱基仅可能是由于测序错误。总错误率为 $e = 10^{-3}$。由于错误在三种可能的不正确碱基之间均匀分布，特定替换（例如，参考碱基替换为特定替代碱基）的概率是 $p_0 = \\frac{e}{3}$。\n$$p_0 = \\frac{10^{-3}}{3} = \\frac{1}{3000}$$\n因此，在零假设下，$K$ 的分布为：\n$$K_{\\text{null}} \\sim \\text{Binomial}\\left(n, p_0\\right)$$\n\n**在备择假设下（变异以 VAF $f=0.005$ 存在）：**\n一条读数可以通过两种互斥的方式支持替代等位基因：\n1.  该读数来自携带变异的 DNA 分子（概率 $f$），并且被正确测序（概率 $1-e$）。\n2.  该读数来自携带参考等位基因的 DNA 分子（概率 $1-f$），并且测序错误导致其被误读为替代碱基（概率 $\\frac{e}{3}$）。\n\n单条读数支持替代等位基因的总概率 $p_1$ 是这两个事件概率的总和：\n$$p_1 = f(1-e) + (1-f)\\frac{e}{3}$$\n代入给定值：\n$$p_1 = 0.005(1 - 10^{-3}) + (1 - 0.005)\\frac{10^{-3}}{3} = 0.005(0.999) + 0.995\\left(\\frac{0.001}{3}\\right)$$\n$$p_1 = 0.004995 + \\frac{0.000995}{3} \\approx 0.004995 + 0.00033167 = 0.00532667...$$\n为了精确计算：\n$$p_1 = \\frac{5}{1000}\\left(\\frac{999}{1000}\\right) + \\frac{995}{1000}\\left(\\frac{1}{3000}\\right) = \\frac{4995}{1000000} + \\frac{995}{3000000} = \\frac{3 \\times 4995 + 995}{3000000} = \\frac{14985 + 995}{3000000} = \\frac{15980}{3000000} = \\frac{799}{150000}$$\n因此，在备择假设下，$K$ 的分布为：\n$$K_{\\text{alt}} \\sim \\text{Binomial}\\left(n, p_1\\right)$$\n\n**2. 泊松近似**\n问题要求找到一个最小的大数 $n$。对于大的 $n$ 和小的概率 $p_0$ 和 $p_1$，二项分布可以被泊松分布精确近似。泊松分布的参数 $\\lambda$ 由二项分布的均值给出，即 $\\lambda = np$。\n- 在零假设下：$K_{\\text{null}} \\approx \\text{Poisson}(\\lambda_0)$，其中 $\\lambda_0 = np_0 = \\frac{n}{3000}$。\n- 在备择假设下：$K_{\\text{alt}} \\approx \\text{Poisson}(\\lambda_1)$，其中 $\\lambda_1 = np_1 = n \\frac{799}{150000}$。\n\n这种近似是合理的，因为 $n$ 预计会很大（数千级别），而 $p_0 \\approx 3.33 \\times 10^{-4}$ 和 $p_1 \\approx 5.33 \\times 10^{-3}$ 很小，这使得泊松近似的条件非常理想。\n\n**3. 构建约束条件**\n关于阈值 $T$ 的两个约束条件可以使用泊松近似来表示。设 $F(k; \\lambda)$ 为均值为 $\\lambda$ 的泊松分布的累积分布函数（CDF），即 $F(k; \\lambda) = \\sum_{i=0}^{k} \\frac{\\exp(-\\lambda)\\lambda^i}{i!}$。生存函数（SF）为 $\\Pr(K \\ge T) = 1 - F(T-1; \\lambda)$。\n\n-   **约束 1（特异性）：** $\\Pr(K \\geq T \\mid \\text{null})  10^{-4}$\n    $$1 - F(T-1; \\lambda_0)  10^{-4} \\implies F(T-1; \\lambda_0) > 0.9999$$\n-   **约束 2（灵敏度）：** $\\Pr(K \\geq T \\mid \\text{alternative}) \\geq 0.95$\n    $$1 - F(T-1; \\lambda_1) \\geq 0.95 \\implies F(T-1; \\lambda_1) \\leq 0.05$$\n\n对于给定的深度 $n$，我们必须找到是否存在一个整数 $T$ 同时满足这两个不等式。这意味着每个约束条件所允许的整数 $T$ 的集合必须有非空交集。\n设 $T_1$ 是满足约束 1 的最小整数阈值。\n设 $T_2$ 是满足约束 2 的最大整数阈值。\n当且仅当 $T_1 \\le T_2$ 时，才能选择一个整数阈值 $T$。我们的目标是找到满足此条件的最小整数 $n$。\n\n**4. 数值搜索最小 $n$**\n我们需要找到满足两个条件的整数 $T$ 存在的最小整数 $n$。我们可以系统地搜索这个最小 $n$。让我们测试 $n$ 的整数值。\n\n我们来分析 $n=1973$：\n- $\\lambda_0 = np_0 = 1973 \\times \\frac{1}{3000} \\approx 0.65767$\n- $\\lambda_1 = np_1 = 1973 \\times \\frac{799}{150000} \\approx 10.5073$\n\n对于约束 1：我们需要找到最小的整数 $T$，使得 $\\Pr(K \\ge T | \\lambda_0)  10^{-4}$。\n- 对于 $T=5$：$\\Pr(K \\ge 5 | \\lambda_0) \\approx 1.77 \\times 10^{-4}$，不小于 $10^{-4}$。\n- 对于 $T=6$：$\\Pr(K \\ge 6 | \\lambda_0) \\approx 2.14 \\times 10^{-5}$，小于 $10^{-4}$。\n因此，约束 1 允许的最小阈值是 $T_1 = 6$。\n\n对于约束 2：我们需要找到最大的整数 $T$，使得 $\\Pr(K \\ge T | \\lambda_1) \\ge 0.95$。\n- 对于 $T=5$：$\\Pr(K \\ge 5 | \\lambda_1) \\approx 0.9768 \\ge 0.95$。这是一个有效的选择。\n- 对于 $T=6$：$\\Pr(K \\ge 6 | \\lambda_1) \\approx 0.94998  0.95$。这不是一个有效的选择。\n因此，约束 2 允许的最大阈值是 $T_2 = 5$。\n\n对于 $n=1973$，我们要求一个阈值 $T$ 满足 $T \\ge T_1 = 6$ 和 $T \\le T_2 = 5$。这是不可能的。因此，$n=1973$ 是不够的。\n\n现在我们来分析 $n=1974$：\n- $\\lambda_0 = np_0 = 1974 \\times \\frac{1}{3000} = 0.658$\n- $\\lambda_1 = np_1 = 1974 \\times \\frac{799}{150000} \\approx 10.5126$\n\n对于约束 1：我们寻找最小的 $T$ 使得 $\\Pr(K \\ge T | \\lambda_0)  10^{-4}$。\n- 对于 $T=5$：$\\Pr(K \\ge 5 | \\lambda_0) \\approx 1.79 \\times 10^{-4} > 10^{-4}$。\n- 对于 $T=6$：$\\Pr(K \\ge 6 | \\lambda_0) \\approx 2.15 \\times 10^{-5}  10^{-4}$。\n允许的最小阈值是 $T_1 = 6$。\n\n对于约束 2：我们寻找最大的 $T$ 使得 $\\Pr(K \\ge T | \\lambda_1) \\ge 0.95$。\n- 对于 $T=6$：$\\Pr(K \\ge 6 | \\lambda_1) \\approx 0.9501 \\ge 0.95$。这是一个有效的选择。\n- 对于 $T=7$：$\\Pr(K \\ge 7 | \\lambda_1) \\approx 0.8996  0.95$。这不是一个有效的选择。\n允许的最大阈值是 $T_2 = 6$。\n\n对于 $n=1974$，我们要求一个阈值 $T$ 满足 $T \\ge T_1 = 6$ 和 $T \\le T_2 = 6$。存在一个有效的阈值，即 $T=6$。\n\n由于 $n=1973$ 不足而 $n=1974$ 足够，所需的最小整数测序深度为 $1974$。", "answer": "$$\\boxed{1974}$$", "id": "5088999"}]}