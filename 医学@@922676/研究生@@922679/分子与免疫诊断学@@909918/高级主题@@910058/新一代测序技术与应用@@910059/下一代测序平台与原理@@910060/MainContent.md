## 引言
高通量测序（Next-Generation Sequencing, NGS）技术以前所未有的通量和速度，彻底改变了生命科学研究和临床诊断的面貌。然而，这一强大工具的背后，是一系列复杂且快速演进的化学、物理及计算原理。对于研究生和青年学者而言，理解这些技术的内在机制、明辨不同平台的优劣，并将其恰当地应用于具体的科学问题，是充分利用NGS潜力的关键，也是一个巨大的知识挑战。本篇文章旨在系统性地解决这一知识鸿沟。

本文将引领读者进行一次从原理到应用的深度探索。在第一章“原则与机制”中，我们将解构NGS工作流程的每一个核心环节，从DNA文库的精巧构建，到克隆扩增的策略，再到不同平台如何将分子信号转化为数字数据。第二章“应用与跨学科连接”将展示这些基础原理如何在[临床基因组学](@entry_id:177648)、癌症研究、[转录组学](@entry_id:139549)和免疫学等前沿领域转化为强大的洞察力，并探讨如何设计实验和解读结果。最后，在“动手实践”部分，我们将通过具体的计算问题，巩固您对产量估算、[数据质量](@entry_id:185007)控制和实验设计的定量理解，将理论知识转化为实践能力。通过这趟旅程，您将构建起一个关于NGS技术的完整知识体系。

## 原则与机制

### DNA文库构建：从样本到可测序分子

高通量测序（Next-Generation Sequencing, NGS）流程的起点是将源自生物样本的[核酸](@entry_id:164998)（DNA或RNA）转化为一种特殊形式的分子集合，即“文库”。文库中的每个分子都经过精心设计，能够与特定测序平台的[表面化学](@entry_id:152233)物质相互作用，并启动测序反应。这个过程不仅是简单的分子改造，它还为后续的数据分析奠定了基础，例如样本识别和定量准确性的校正。

#### 文库制备的核心步骤

典型的测序文库制备流程，尤其是基于连接的策略，遵循一套标准化的酶促反应，旨在将原始的长链DNA（或cDNA）转化为长度均一、两端带有特定接头的短片段。

第一步通常是**[DNA片段化](@entry_id:170520)**。通过物理方法（如超声处理）或酶切方法（如使用[转座酶](@entry_id:273476)或[限制性内切酶](@entry_id:143408)），将基因组DNA或cDNA打断成数百个碱基对（bp）的片段。这个过程产生的DNA片段末端是异质的，可能包含$5'$或$3'$突出端，也可能缺乏后续连接反应所必需的$5'$磷酸基团。

为了使这些末端能够高效地连接上测序接头，必须进行**末端修复**（**end-repair**）。该步骤通常使用一个酶混合物来完成两项任务：(1) 利用具有$5' \to 3'$聚合[酶活性](@entry_id:143847)的酶补平凹陷的$3'$末端，并利用具有$3' \to 5'$外切酶活性的酶切除突出的$3'$末端，从而产生**平末端**（blunt ends）；(2) 利用激酶（如T4多核苷酸激酶）将磷酸基团添加到所有片段的$5'$末端，使其具备连接能力。

接下来是**A-加尾**（**A-tailing**）。在平末端修复之后，使用一种缺乏校对活性的[DNA聚合酶](@entry_id:147287)（如[Taq聚合酶](@entry_id:145833)的变体），在dNTPs中仅提供dATP的条件下，在每个DNA片段的$3'$末端添加一个单一的脱氧[腺苷](@entry_id:186491)（A）。这就在每个片段的两端都产生了一个$3'$-A突出端。这个看似微小的步骤极大地提高了后续接头连接的效率，因为它防止了DNA片段之间的自身连接，并为接头提供了一个特异性的“[粘性末端](@entry_id:265341)”。

最后一步是**接头连接**（**adapter ligation**）。测序接头是短的、人工合成的双链DNA分子，其设计与A-加尾的产物精确互补——即接头带有一个$3'$-[胸腺](@entry_id:183673)嘧啶（T）突出端。这种A-T互补的“粘性末端”使得接头能够高效地退火到DNA片段的末端，随后[DNA连接酶](@entry_id:139273)催化形成[磷酸二酯键](@entry_id:271137)，将接头永久性地共价连接到片段上。完成这一步后，原始的DNA分子就转化为了一个完整的测序文库分子，准备进行后续的扩增和测序 [@problem_id:5139998]。

#### 多重测序与样本身份识别

为了最大限度地利用NGS平台的高通量，通常会将来自不同样本的文库混合在一起（即**多重测序**，multiplexing），在同一次测序运行中进行分析。为了在测序后能够区分这些混合在一起的读长（reads）的来源，文库制备过程中引入了**样本索引**（**sample indexes**），也常被称为**条形码**（barcodes）。样本索引是一段短的、预先设计的已知序列，被整合到测序接头中。每个样本的文库都带有一套独特的索引序列。在测序过程中，除了读取DNA片段本身的序列外，仪器还会专门进行“索引读长”来测定每个片段所携带的索引序列。测序完成后，通过[生物信息学方法](@entry_id:172578)识别每个读长上的索引，即可将其准确地归类到原始样本，这个过程称为**样本拆分**（**demultiplexing**）。

然而，在许多应用中，尤其是在需要精确定量（如[免疫组库分析](@entry_id:196743)或肿瘤突变频率检测）的场景下，还存在另一个挑战：[聚合酶链式反应](@entry_id:142924)（PCR）扩增偏好。在文库制备的最后阶段，通常需要通过PCR来富集带有完整接头的文库分子，以达到测序所需的浓度。但PCR的扩增效率并非完全均一，某些片段可能被扩增数千次，而另一些可能只有数十次。如果不加以校正，原始样本中一个分子的丰度可能会被严重高估。

为了解决这个问题，引入了**[唯一分子标识符](@entry_id:192673)**（**Unique Molecular Identifiers, UMIs**）。UMI是一段短的（通常为6-12个核苷酸）随机序列，在任何扩增步骤发生之前，就被连接到每个原始DNA分子的末端。这样，源自同一个原始DNA分子的所有PCR扩增产物都会共享相同的UMI序列。测序后，我们可以将具有相同UMI且比对到基因组相同位置的多个读长视为来自同一个原始分子的扩增副本。通过将这些重复的读长“折叠”成一个单一的共识序列，就可以消除PCR扩增偏好，实现对原始分子数目的精确计数。这个过程被称为**去重复**（**deduplication**）。

因此，样本索引和UMI在功能上有着本质区别：索引用于区分**样本**，而UMI用于区分**分子**。相应地，样本拆分是根据索引将混合的读长池划分为各个样本的子集，而去重复则是根据UMI和比对坐标识别并合并PCR扩增的副本 [@problem_id:5139998]。

#### 指数跳跃：多重测序中的一个陷阱

在高度复用的测序实验中，一个被称为**指数跳跃**（**index hopping**）的现象可能会严重影响[数据质量](@entry_id:185007)，导致样本间的交叉污染。指数跳跃是一种分子生物学伪影，指一个文库分子的索引被错误地替换为来自同一池中另一个文库的索引。这种现象在采用**排他性扩增**（Exclusion Amplification, ExAmp）化学的**图案化流动槽**（patterned flow cells）的平台上尤其显著。在这些平台上，未被使用的测序接头或文库分子会以游离状态存在于流动槽中，在簇扩增过程中，一个正在扩增的文库分子有机会以这些游离接头作为模板，从而“跳跃”到一个新的索引上。

必须将指数跳跃与**伪指数分配**（**spurious index assignment**）区分开来。后者并非分子水平的错误，而是测序或数据处理过程中的错误。例如，索引序列的碱基读取出错、相邻簇之间的荧光[信号串扰](@entry_id:188529)，都可能导致一个正确的索引被错误地解读为另一个样本的索引。

为了有效抑制指数跳跃导致的样本误判，**唯一双末端索引**（**Unique Dual Indexing, UDI**）策略被广泛采用。在UDI策略中，每个样本的文库在两端（通常称为i7和i5）都带有一个独特的索引，形成一个独一无二的索引对（如 (i7_A, i5_A) 对应样本A）。关键在于，对于池中的任意两个不同样本A和B，它们的i7索引不同，i5索引也不同。在进行样本拆分时，软件只接受与预设的有效索引对完全匹配的读长。

这种设计的巧妙之处在于，它将一个高概率的单次错误事件转变为一个极低概率的两次独立错误事件的组合。例如，一个来自样本A的读长，如果其i7索引因为跳跃而变成了样本B的索引，其索引对就变为 (i7_B, i5_A)。由于这个组合在实验设计中是不存在的“无效对”，该读长将被直接丢弃，而不会被错误地归入样本B。只有当该读长的i7和i5索引**同时**（通过跳跃或测序错误）变成了样本B的索引对 (i7_B, i5_B) 时，才会发生误判。如果单次错误的概率为$p$，那么在UDI下发生误判的概率大致与$p^2$成正比，远低于单索引下的$p$。这使得UDI成为确保临床样本和高复用实验数据完整性的黄金标准 [@problem_id:5139942]。

### 克隆扩增与信号生成：从单个分子到可检测信号

测序文库制备完成后，每个片段都需要被单独扩增成一个克隆群体，其产生的信号强度才能被测序仪的光学系统有效检测。这个将单个分子放大为可检测信号的过程，是所有主流NGS技术的核心环节之一。实现这一目标的关键在于**物理区室化**（physical compartmentalization），即如何确保每个克隆群体都源自唯一的起始分子，避免不同分子混合。

#### 克隆扩增的必要性与策略

根据物理区室化方法的不同，克隆扩增主要有三种策略 [@problem_id:5140006]：

1.  **桥式扩增（Bridge Amplification）**：这是[Illumina](@entry_id:201471)平台的核心技术。在这种方法中，流动槽（flow cell）的表面共价连接着两种不同类型的寡核苷酸引物。测序文库分子通过其两端的接头序列与表面上的引物互补[退火](@entry_id:159359)。在热循环过程中，[DNA聚合酶](@entry_id:147287)以文库分子为模板进行延伸，产生一条共价连接在表面的新链。变性后，这条新链的另一端可以“弯曲”成一座“桥”，与邻近的第二种引物退火，并再次进行延伸，从而形成一条双链桥。经过多轮热循环，每个起始文_库分子都会在原位进行指数级扩增，形成一个包含数百万相同分子的**簇**（cluster）。在**图案化流动槽**上，这些反应被限制在预先制作好的**[纳米孔](@entry_id:191311)**（nanowells）中，进一步提高了簇的密度和均一性。克隆性的保证依赖于上样时对文库浓度的精确控制，即通过**极限稀释**（limiting dilution）使得大多数[纳米孔](@entry_id:191311)只捕获一个或零个文库分子。

2.  **乳液PCR（Emulsion PCR, ePCR）**：这是Ion Torrent和早期SOLiD平台采用的技术。该方法利用“油包水”乳液体系创建数百万个皮升（picoliter）级别的独立微反应器。每个水相微滴中包含PCR所需的所有试剂、一个涂有引物的微珠（bead）以及一个待测的文库分子。同样通过极限稀释，确保绝大多数含有文库分子的微滴中只有一个模板。随后，在微滴外部进行统一的热循环，每个微滴内的文库分子会在其对应的微珠表面进行指数级扩增，最终形成一个表面覆盖着相同DNA分子的克隆微珠。乳液滴本身构成了完美的物理区室。

3.  **滚环扩增（Rolling-Circle Amplification, RCA）**：这是BGI/MGI等平台采用的策略。与前两者不同，RCA在扩增阶段并不需要物理区室。首先，文库分子被处理成单链环状DNA。然后，在恒温条件下，一种具有强链置换活性的DNA聚合酶（如Phi29聚合酶）以环状DNA为模板进行连续滚动的复制，产生一条包含数百个模板重复拷贝的长[单链DNA](@entry_id:162691)。这条长链会自发地折叠压缩成一个致密的**DNA纳米球**（DNA Nanoball, DNB）。这种方法的克隆性是内在的：一个环状模板精确地产生一个DNB。扩增完成后，这些在溶液中预先制备好的DNB被加载到带有电荷吸附位点的图案化芯片上，每个吸附位点的大小和间距被设计为仅能捕获一个DNB，从而实现空间分离。与PCR的指数扩增（$2^n$）不同，RCA的扩增动力学在合成时间内近似线性。

#### 信号检测原理：不同平台的“眼睛”

克隆扩增完成后，测序仪通过不同的物理化学原理来“读取”每个克隆簇或DNB的序列。这些不同的检测原理是区分各大NGS平台的最根本特征 [@problem_id:5140018]。

*   **[Illumina](@entry_id:201471)：基于荧光的合成法测序（Fluorescence-based Sequencing-by-Synthesis）**
    该技术的核心是使用带有可逆终止基团和荧光标记的特殊dNTPs。在每个测序循环中，只允许一种dNTP被聚合酶添加到所有簇的DNA链上。该dNTP的$3'$端被化学基团封闭，因此每次只能添加一个碱基。随后，仪器激发荧光并进行成像，通过荧光颜色（对应A, C, G, T）来确定该循环中被添加的碱基。成像后，通过化学方法切除终止基团和荧光染料，恢复$3'$羟基，为下一个循环做好准备。其核心[物理可观测量](@entry_id:154692)是每个测序循环中从每个簇发出的**荧光光子**。

*   **Ion Torrent：半导体测序（Semiconductor Sequencing）**
    这种技术完全不依赖光学和荧光。其原理基于DNA聚合反应的化学副产物：每当一个dNTP被整合到DNA链上时，都会释放一个焦磷酸分子和一个氢离子（$H^+$）。$H^+$的释放会直接导致反应微环境的**pH值发生变化**。Ion Torrent的测序芯片在每个微孔下方都集成了一个**离子敏感场效应晶体管**（Ion-Sensitive Field-Effect Transistor, ISFET），它能够即时检测到这种微小的pH变化并将其转化为电压信号。通过依次冲入不同的dNTP，并检测哪个循环产生了电压信号，即可确定序列。其核心[物理可观测量](@entry_id:154692)是**[氢离子浓度](@entry_id:141886)的变化**。

*   **Pacific Biosciences ([PacBio](@entry_id:264261))：零模波导中的[单分子实时测序](@entry_id:183138)**
    [PacBio](@entry_id:264261) [SMRT测序](@entry_id:183138)是一种[单分子技术](@entry_id:189493)，无需克隆扩增。其测序芯片上分布着数百万个**零模波导**（**Zero-Mode Waveguides, ZMWs**），每个ZMW的底部都固定着一个DNA聚合酶。ZMW的孔径远小于光的波长，能将激光的照射体积限制在底部几十仄升（zeptoliter）的空间内，有效排除了背景荧光干扰。测序时，使用在末端磷酸基团上标记了荧光的dNTPs。当聚合酶捕获并准备整合一个dNTP时，[荧光基团](@entry_id:202467)会在ZMW底部短暂停留，发出**荧光脉冲**，随即在[磷酸二酯键](@entry_id:271137)形成时被切除并迅速离开检测区域。通过实时记录这些**单分子荧光脉冲**的颜色和持续时间，即可直接读出单条DNA分子的序列。

*   **Oxford Nanopore Technologies (ONT)：[纳米孔](@entry_id:191311)中的[离子电流](@entry_id:170309)调制**
    ONT是另一种[单分子技术](@entry_id:189493)，它将测序问题转化为电学测量。其核心是一个嵌在绝缘膜上的蛋白质**[纳米孔](@entry_id:191311)**（**nanopore**）。在膜的两侧施加电压，会驱动离子穿过纳米孔，形成稳定的基线电流。测序时，一条单链DNA在马达蛋白的牵引下穿过[纳米孔](@entry_id:191311)。当不同碱基（通常是以一个[k-mer](@entry_id:166084)，即k个[核苷](@entry_id:195320)酸的组合形式）占据[纳米孔](@entry_id:191311)的狭窄感应区时，会对离子流产生不同程度的阻断，导致**[离子电流](@entry_id:170309)**发生特征性的**调制**。通过实时记录这种电流信号随时间的变化，并与已知的[k-mer](@entry_id:166084)-电流信号模型进行匹配，即可解码出DNA的序列。

### 测序化学与数据质量：从理想走向现实

理论上完美的测序过程应该能够无差错地读取数百万甚至数十亿个碱基。然而在现实中，化学反应的不完美、光学系统的限制以及信号处理的复杂性都会引入错误。理解这些错误的来源和特征，是评估和解读NGS数据的关键。

#### 合成法测序(SBS)的核心化学原理

在广泛使用的基于荧光的合成法测序（SBS）技术中，其核心化学设计——**[可逆终止子](@entry_id:177254)**（reversible terminator）——是保证测序同步性和准确性的基石。[DNA聚合酶](@entry_id:147287)的天然功能是在存在自由$3'$羟基的情况下连续添加[核苷](@entry_id:195320)酸。如果在测序循环中不加以控制，聚合酶会在一个循环内添加多个碱基，导致测序失败。

因此，SBS技术使用的dNTPs在$3'$位置上带有一个**可逆的化学封闭基团**。当这样一个dNTP被整合到DNA链上后，由于$3'$端被封闭，聚合酶无法继续添加下一个碱基，反应就此终止。这确保了在每个测序循环中，每个簇中的每条DNA链最多只延伸一个碱基。仅仅通过降低核苷酸浓度或缩短反应时间来控制[反应速率](@entry_id:185114)，是无法“保证”单碱基掺入的，因为聚合[酶催化](@entry_id:146161)是一个[随机过程](@entry_id:268487)，总会有一定概率发生多次掺入 [@problem_id:5140022]。

在成像步骤之后，通过化学试剂切除这个$3'$封闭基团和荧光染料，重新暴露出$3'$羟基，为下一轮的碱基掺入做好准备。然而，这个“去封闭”的化学反应并非百分之百高效。如果在一个循环中，某个DNA分子的封闭基团未能被成功切除，它将在下一个循环中无法延伸，从而落后于主群体一个碱基，这种现象称为**[相位滞后](@entry_id:172443)**（**phasing**）。反之，如果封闭基团不稳定，在碱基掺入循环中提前脱落，或者有非特异性掺入，可能导致分子提前延伸，称为**[相位超前](@entry_id:269084)**（**prephasing**）。

这两种错误都会累积。假设每个循环的去封闭成功率为$q$，那么经过$N$个循环后，仍然保持与主群体[完全同步](@entry_id:267706)（in-phase）的分子比例仅为$q^N$。更普遍地，如果每个循环发生[相位滞后](@entry_id:172443)的概率为$\phi$，[相位超前](@entry_id:269084)的概率为$\psi$，则同步分子的比例会以$(1 - \phi - \psi)^N$的速度衰减 [@problem_id:5140022]。随着测序读长的增加（即循环数$N$的增加），簇内不同步的分子比例越来越高，导致荧光信号变得混杂，[信噪比](@entry_id:271196)下降，这正是测序读长末端碱基质量通常会下降的根本原因。

#### 理解和量化测序[数据质量](@entry_id:185007)

为了以标准化的方式报告测序数据的可信度，NGS领域广泛采用**Phred质量分**（**Phred quality score**），用$Q$表示。它通过一个对数关系将碱基识别的错误率$p_{\text{error}}$转化为一个更直观的分数：

$Q = -10 \log_{10}(p_{\text{error}})$

这个定义意味着，$Q=10$对应错误率为$0.1$（$1$ in $10$），$Q=20$对应错误率为$0.01$（$1$ in $100$），$Q=30$对应错误率为$0.001$（$1$ in $1000$）。$Q=30$通常被认为是高质量碱基的一个重要阈值。

在解读NGS数据时，必须区分两种截然不同的[质量分数](@entry_id:161575) [@problem_id:5139944]：

*   **碱基质量（Base Quality, $Q_b$）**：由测序仪直接生成，编码在[FASTQ](@entry_id:201775)文件的质量行中。它反映了仪器对**单个碱基**识别准确性的置信度。例如，$Q_b=30$意味着根据信号强度、纯度等信息判断，该碱基被错判的概率为$0.001$。它主要衡量的是测序化学和光学系统的性能。

*   **[比对质量](@entry_id:170584)（Mapping Quality, MQ）**：由比对软件（aligner）在将读长定位到参考基因组上时生成。它反映了**整个读长**被正确放置在当前基因组位置的置信度。如果一个读长的序列在基因组中存在多个相似的拷贝，即使它的每个碱基质量都很高，其[比对质量](@entry_id:170584)也可能很低。例如，$\mathrm{MQ}=20$意味着该读长被错误定位的概率为$0.01$。

这两种质量分数提供了互补的信息。例如，要评估一个单[核苷](@entry_id:195320)酸变异（SNV）的真实性，我们需要同时考虑这两个因素。假设一个位点的碱基质量为$Q_b = 30$（$p_{\text{base error}} = 0.001$），其所在读长的[比对质量](@entry_id:170584)为$\mathrm{MQ} = 20$（$p_{\text{mapping error}} = 0.01$）。如果碱基识别错误和读长定位错误是[独立事件](@entry_id:275822)，那么观察到的这个碱基是错误的（要么是测错了，要么是放错了地方）的总概率为：

$p_{\text{total}} = 1 - (1 - p_{\text{base error}})(1 - p_{\text{mapping error}}) = 1 - (1 - 0.001)(1 - 0.01) \approx 0.01099$

这个总错误率对应的组合Phred分约为$Q_{\text{total}} = -10 \log_{10}(0.01099) \approx 19.6$ [@problem_id:5139944]。

#### 测序运行的关键性能指标

除了单个碱基的质量，评估一次测序运行的整体性能还需要关注一系列宏观指标，这些指标直接反映了测序原理在实践中的表现 [@problem_id:5139990]：

*   **簇密度（Cluster Density）**：指流动槽单位面积上的簇或DNB的数量（例如，每平方毫米的簇数）。这是一个关键的优化参数。密度过低会导致测序通量浪费；密度过高，超出仪器光学系统的[分辨率极限](@entry_id:200378)，会导致相邻簇的荧光信号重叠和串扰，从而降低信号质量和数据准确性。
*   **簇过滤率（Passing Filter Rate, PF Rate）**：指在测序初期（通常是前25个循环）信号纯度、强度等指标符合预设质量标准的簇所占的百分比。密度过高是导致PF率下降的主要原因之一。只有通过过滤的簇产生的数据才会被用于后续分析。
*   **产量（Yield）**：指一次测序运行产生的总碱基数量，通常以千兆碱基（Gigabases, Gb）为单位。总产量等于通过过滤的簇数量、读长长度和末端数（单端为1，双端为2）的乘积。
*   **Q30比例（Q30 Fraction）**：指所有通过过滤的碱基中，Phred质量分大于或等于30的碱基所占的百分比。这是衡量测序运行整体准确性的最重要指标。它直接受到测序化学（如相位失步率）和簇密度（光学串扰）的影响。

### 从序列读长到生物学洞见：测序策略与数据分析

原始的测序读长本身只是一串碱基序列，需要通过精密的实验设计和复杂的生物信息学分析，才能转化为有价值的生物学信息。

#### 测序策略：单端与[双端测序](@entry_id:272784)

在设计测序实验时，一个基本的选择是采用**单端测序（Single-End, SE）**还是**[双端测序](@entry_id:272784)（Paired-End, PE）**。

*   **单端测序**只从DNA文库片段的一端读取序列。
*   **[双端测序](@entry_id:272784)**则从同一DNA片段的两端分别读取序列，产生一对（一对“mates”）在空间上相互关联的读长。

PE测序的威力在于它提供了额外但至关重要的物理信息：两个读长之间的**相对方向**（例如，在标准文库中是“头对头”的内向方向）和它们之间的**距离**，即**插入片段大小**（**insert size**）。这个插入片段的大小由文库制备时的片段筛选步骤决定，通常服从一个近似高斯分布的特定均值和标准差。

这个物理约束在读长比对中极其有用，尤其是在处理基因组中的重复序列时。例如，一个150 bp的读长可能能够完美地匹配到基因组的两个不同位置$L_1$和$L_2$。如果采用SE测序，这两个位置将无法区分。但在PE测序中，我们可以检查其配对读长的位置。假设文库的平均插入片段大小为$\mu=350$ bp，标准差为$\sigma=50$ bp。如果将该读长放在$L_1$时，计算出的插入片段大小为$360$ bp（与均值仅差$0.2\sigma$），而放在$L_2$时，计算出的插入片段大小为$1200$ bp（与均值相差$17\sigma$）。根据高斯分布，后者的可能性几乎为零。因此，比对软件可以极高置信地选择$L_1$作为唯一正确的比对位置 [@problem_id:5140005]。

PE测序的这一特性也使其成为检测**结构变异（Structural Variants, SVs）**的强大工具。通过寻找那些比对模式与预期不符的**[不一致对](@entry_id:166371)（discordant pairs）**，我们可以推断出基因组的结构变化：
*   **插入片段大于预期**：可能表明样本基因组相对于[参考基因组](@entry_id:269221)存在**缺失（deletion）**。
*   **插入片段小于预期**：可能表明存在**插入（insertion）**。
*   **读长对比对方向异常**（如变为同向或“背对背”）：可能表明存在**倒位（inversion）**。
*   **一对读长比对到不同染色体上**：强烈提示存在**易位（translocation）**。

此外，如果一个读长本身就跨越了一个SV的断点，它的一部分会比对到断点的一侧，另一部分则比对到另一侧，这种读长被称为**跨接读长（split reads）**。跨接读长能够为SV提供碱基级别的精确定位，是对[不一致对](@entry_id:166371)信息的完美补充 [@problem_id:5140005]。

#### 平台的错误特征及其影响

不同的测序平台由于其信号生成和检测原理的差异，会产生特征性的错误谱，这直接影响了它们在不同研究领域的适用性 [@problem_id:5140027]。

*   **短读长平台（如[Illumina](@entry_id:201471)）**：其主要优势是极低的错误率（通常在$0.1\% \sim 1\%$之间）和极高的通量。错误类型以**替换错误（substitution errors）**为主，这是由前述的相位失步和荧光[信号串扰](@entry_id:188529)等因素造成的。插入和缺失（indel）错误非常罕见。由于错误主要来自化学循环的累积效应，因此错误率随读长长度增加而上升。这种高保真度使其成为检测单核苷酸变异（SNVs）和小片段indel的金标准。

*   **长读长平台（如ONT和[PacBio](@entry_id:264261)）**：这类平台能够产生数千至数百万碱基的读长，但代价是相对较高的原始错误率（通常在$1\% \sim 15\%$）。与短读长平台不同，它们的错误类型以**插入缺失错误（indel errors）**为主。在ONT平台中，这主要源于DNA链穿过[纳米孔](@entry_id:191311)的速度不均，导致对**同聚物**（**homopolymers**，即连续的相同碱基，如AAAAAA）的长度判断不准。在[PacBio](@entry_id:264261)平台中，DNA聚合酶在复制过程中的“滑移”也是产生indel错误的主要原因。长读长在跨越重复区域和组装复杂基因组方面具有无与伦比的优势，也是检测大型结构变异的利器。

#### 序列比对的基本原理：快速定位海量读长

[NGS数据分析](@entry_id:168097)的第一步通常是将数亿甚至数十亿条短读长快速、准确地比对回一个长达几十亿碱基的参考基因组上。面对如此巨大的数据量，简单的逐一搜索（其计算复杂度为$O(nm)$，其中$n$为基因组长度，$m$为读长长度）是完全不可行的。

现代短读长比对算法的效率革命，得益于一种名为**FM-索引（FM-index）**的压缩数据结构，它基于**[Burrows-Wheeler变换](@entry_id:269666)（Burrows-Wheeler Transform, BWT）**。BWT是一种对字符串进行可逆重排的方法，其精妙之处在于它能将原始字符串中重复出现的模式聚集在一起，从而非常有利于压缩。

FM-索引在BWT的基础上，增加了辅助数据结构（如$C$表和$Rank$查询支持），共同实现了一种极其高效的[搜索算法](@entry_id:272182)，称为**反向搜索（backward search）**。该算法从待查模式（读长）的最后一个字符开始，向前逐个字符迭代。在每一步，它利用FM-索引的特性，仅通过几次常数时间的计算，就能精确更新在参考基因组中以当前部分模式为后缀的所有位置的区间。完成对整个模式的搜索后，即可得到其在基因组中的所有匹配位置。

反向搜索最惊人的特性是，其查找一个长度为$m$的模式所需的[时间复杂度](@entry_id:145062)约为$O(m)$，即只与读长自身的长度成正比，而与庞大的基因组长度$n$**无关**。正是这种亚线性时间的查找能力，使得在个人电脑上于数小时内完成人类全基因组测序数据的比对成为可能，为整个基因组学领域奠定了计算基础 [@problem_id:5139989]。