{"hands_on_practices": [{"introduction": "任何基因组学分析的可靠性都源于原始测序数据的质量。本练习将向您介绍Phred质量分数($Q$)，这是描述每个碱基检出置信度的行业标准。通过掌握该分数与错误概率之间的对数关系，您将能够评估数据质量，为后续的变异检出和注释打下坚实基础。[@problem_id:5170233]", "problem": "在分子与免疫诊断学中使用的高通量测序中，碱基检出结果会附带一个Phred质量分数，该分数编码了错误碱基检出的后验概率，这对于变异检出、注释和优先排序至关重要。请将Phred质量分数精确定义为碱基检出错误概率的对数变换，并从该定义出发，推导出从报告的碱基质量 $Q$ 到相应错误概率 $p$ 的显式映射关系。然后，计算当 $Q=30$ 和 $Q=20$ 时 $p$ 的值。将每个 $p$ 值表示为精确的十进制小数，无需四舍五入。", "solution": "该问题陈述具有科学依据，提法恰当，内容客观，并包含了求解所需的所有必要信息。它准确地反映了Phred质量分数在生物信息学和分子诊断学中的标准定义和应用。\n\nPhred质量分数（用 $Q$ 表示）为测序数据中碱基检出的质量提供了一个定量度量。它被定义为相应碱基检出是错误的后验概率 $p$ 的以10为底的负对数。其数学定义为：\n$$Q = -10 \\log_{10}(p)$$\n负号确保了较低的错误概率 $p$ 对应于较高的质量分数 $Q$。因子10将分数缩放到了一个方便的整数范围内。\n\n为了推导出从质量分数 $Q$ 到错误概率 $p$ 的显式映射关系，我们必须对定义方程进行代数求解以解出 $p$。\n从定义方程开始：\n$$Q = -10 \\log_{10}(p)$$\n首先，我们将方程两边同时除以 $-10$ 来分离对数项：\n$$-\\frac{Q}{10} = \\log_{10}(p)$$\n接下来，为了消去以10为底的对数，我们应用其反函数，即以10为底的指数函数。我们以10为底，对等式两边进行取幂运算：\n$$10^{\\left(-\\frac{Q}{10}\\right)} = 10^{\\log_{10}(p)}$$\n根据对数及其反函数的定义，$10^{\\log_{10}(p)} = p$。因此，我们得到了从 $Q$ 到 $p$ 的显式映射关系：\n$$p = 10^{-\\frac{Q}{10}}$$\n该方程允许我们根据给定的Phred质量分数 $Q$ 直接计算出碱基检出的错误概率 $p$。\n\n现在我们使用这个推导出的公式来计算指定 $Q$ 值对应的 $p$。\n\n对于Phred质量分数 $Q=30$：\n我们将 $Q=30$ 代入关于 $p$ 的方程中：\n$$p = 10^{-\\frac{30}{10}}$$\n$$p = 10^{-3}$$\n表示为精确的十进制小数，其值为：\n$$p = \\frac{1}{10^3} = \\frac{1}{1000} = 0.001$$\n这对应于每1000个碱基检出中有1个是错误的，或者说碱基检出准确率为 $99.9\\%$。\n\n对于Phred质量分数 $Q=20$：\n我们将 $Q=20$ 代入关于 $p$ 的方程中：\n$$p = 10^{-\\frac{20}{10}}$$\n$$p = 10^{-2}$$\n表示为精确的十进制小数，其值为：\n$$p = \\frac{1}{10^2} = \\frac{1}{100} = 0.01$$\n这对应于每100个碱基检出中有1个是错误的，或者说碱基检出准确率为 $99\\%$。\n\n对于 $Q=30$ 和 $Q=20$ 计算出的概率分别为 $0.001$ 和 $0.01$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.001  0.01 \\end{pmatrix}}$$", "id": "5170233"}, {"introduction": "在评估了单个碱基的质量后，下一步是推断特定位点的基因型。这并非简单的读取计数投票，而是一个严谨的统计推断过程。本练习将引导您使用二项分布模型计算基因型似然（genotype likelihoods, $P(D \\mid G)$），这是现代变异检出软件的核心逻辑，揭示了如何结合读取深度和错误率来评估不同基因型的可能性。[@problem_id:5170271]", "problem": "一个双等位基因单核苷酸变异在变异记录格式（VCF）中进行评估，其中等位基因深度（AD）字段报告了支持参考等位基因和备选等位基因的观测读取计数。设观测数据为 $D$，由 $AD=(28,2)$ 概括，表示在该位点有 $28$ 个读取支持参考等位基因，有 $2$ 个读取支持备选等位基因。假设所有读取的碱基识别错误率均为 $e=0.01$，且与读取位置和碱基身份无关，并且读取在给定真实二倍体基因型 $G \\in \\{AA, AB, BB\\}$ 的条件下是独立的。\n\n从基因型似然 $P(D \\mid G)$ 的定义（即在一个经过充分测试的测序错误模型下，给定基因型观测到数据的概率）出发，利用读取的独立性以及通过汇总具有相同单次读取发射概率的读取所隐含的二项分布，推导出 $P(D \\mid AA)$、$P(D \\mid AB)$ 和 $P(D \\mid BB)$ 的表达式。然后，描述 VCF PL 字段中使用的 Phred 标度编码，其中 $PL=-10\\log_{10}\\big(P(D \\mid G)\\big)$，并使用给定的 $AD$ 和 $e$ 计算三种基因型 $AA$、$AB$ 和 $BB$ 的 $PL$ 值。\n\n将最终答案表示为按 $AA$、$AB$、$BB$ 顺序排列的单行矩阵，并将每个值四舍五入到三位有效数字。无需单位。", "solution": "用户希望我解决这个问题。\n### 第 1 步：提取已知条件\n-   **等位基因深度数据 ($D$)**：$AD=(28, 2)$，表示有 $n_{ref}=28$ 个读取支持参考等位基因 ($A$)，$n_{alt}=2$ 个读取支持备选等位基因 ($B$)。\n-   **总读取数**：$N = n_{ref} + n_{alt} = 28 + 2 = 30$。\n-   **基因型 ($G$)**：二倍体基因型 $G$ 可能是三种可能性之一：$\\{AA, AB, BB\\}$。\n-   **碱基识别错误率 ($e$)**：$e=0.01$。这是错误读取一个碱基的概率。\n-   **假设**：\n    1.  读取在给定真实基因型的条件下是独立的。\n    2.  错误率在所有读取中是均一的。\n-   **模型**：基因型似然 $P(D \\mid G)$ 将使用二项分布推导。\n-   **Phred 标度定义**：Phred 标度的似然 ($PL$) 定义为 $PL = -10\\log_{10}(P(D \\mid G))$。\n-   **任务**：\n    1.  推导 $P(D \\mid AA)$、$P(D \\mid AB)$ 和 $P(D \\mid BB)$ 的表达式。\n    2.  描述指定的 Phred 标度编码。\n    3.  计算三种基因型的数值 $PL$ 值。\n-   **输出格式**：一个包含三个 $PL$ 值的单行矩阵，四舍五入到三位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据验证标准评估问题陈述。\n\n-   **科学性**：该问题是贝叶斯统计在生物信息学中的一个标准应用，特别是在遗传变异调用领域。在给定测序错误率的情况下，使用二项分布模型来处理读取计数是计算基因型似然的一种基础且被广泛接受的方法。等位基因深度、Phred 标度和基因型似然等概念是现代基因组学的核心，并在 GATK 等标准工具和 VCF 等标准格式中得到实现。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。它提供了所有必要的数值（$n_{ref}$, $n_{alt}$, $e$）和一个明确定义的统计模型（二项分布）。目标是明确的：推导表达式并计算 Phred 标度的似然。解的存在性和唯一性得到保证。\n-   **客观性**：问题以精确、客观和数学的语言陈述。它不包含任何主观或基于意见的断言。\n\n该问题没有表现出说明中列出的任何缺陷（例如，科学上不合理、不完整、矛盾等）。它代表了一个有效且可形式化的科学问题。\n\n### 第 3 步：结论和行动\n该问题是**有效的**。现在开始解题过程。\n\n### 基因型似然的推导\n\n在给定真实基因型 $G$ 的情况下，观测到数据 $D$（在总共 $N = n_{ref} + n_{alt}$ 个读取中，包含 $n_{ref}$ 个参考读取和 $n_{alt}$ 个备选读取）的似然，表示为 $P(D \\mid G)$。我们将备选读取的数量 $n_{alt}$ 建模为一个遵循二项分布的随机变量，$n_{alt} \\sim \\text{Binomial}(N, p)$，其中 $p$ 是在给定基因型 $G$ 的条件下，单次读取中观测到备选等位基因的概率。概率质量函数由下式给出：\n$$P(n_{alt}=k \\mid N, p) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n\n这里，$N=30$，$n_{alt}=2$，碱基识别错误率为 $e=0.01$。正确读取的概率为 $1-e=0.99$。\n\n1.  **基因型 $G=AA$（纯合参考型）**：\n    真实基因型由两个参考等位基因组成。只有在发生测序错误时才能观测到备选等位基因 ($B$)。因此，单次读取被观测为备选等位基因的概率是 $p_{AA} = e$。观测数据的似然为：\n    $$P(D \\mid AA) = \\binom{N}{n_{alt}} (p_{AA})^{n_{alt}} (1-p_{AA})^{N-n_{alt}} = \\binom{30}{2} e^{2} (1-e)^{28}$$\n\n2.  **基因型 $G=AB$（杂合型）**：\n    真实基因型由一个参考等位基因 ($A$) 和一个备选等位基因 ($B$) 组成。我们假设从任一亲本染色体上抽样读取的概率相等（$0.5$）。\n    观测到备选读取的概率是两个不相交事件的概率之和：\n    - 读取 $A$ 染色体并发生错误：$P(\\text{读取 A}) \\times P(\\text{观测到 B} | \\text{读取 A}) = 0.5 \\times e$。\n    - 读取 $B$ 染色体并正确读取：$P(\\text{读取 B}) \\times P(\\text{观测到 B} | \\text{读取 B}) = 0.5 \\times (1-e)$。\n    总概率为 $p_{AB} = 0.5e + 0.5(1-e) = 0.5e + 0.5 - 0.5e = 0.5$。\n    观测数据的似然为：\n    $$P(D \\mid AB) = \\binom{N}{n_{alt}} (p_{AB})^{n_{alt}} (1-p_{AB})^{N-n_{alt}} = \\binom{30}{2} (0.5)^{2} (0.5)^{28} = \\binom{30}{2} (0.5)^{30}$$\n\n3.  **基因型 $G=BB$（纯合备选型）**：\n    真实基因型由两个备选等位基因组成。如果测序正确，则会观测到备选读取。因此，观测到备选读取的概率是 $p_{BB} = 1-e$。数据的似然为：\n    $$P(D \\mid BB) = \\binom{N}{n_{alt}} (p_{BB})^{n_{alt}} (1-p_{BB})^{N-n_{alt}} = \\binom{30}{2} (1-e)^{2} (e)^{28}$$\n    注意 $(1-p_{BB}) = 1-(1-e) = e$，这是观测到参考等位基因读取的概率。\n\n### Phred 标度编码\n\nPhred 标度是一种对数标度，用于表示概率，特别是在基因组学和其他领域中的小概率。它由变换 $Q = -10 \\log_{10}(P)$ 定义，其中 $P$ 是一个事件的概率（在这里是错误或似然）。越高的 Phred 分数对应越小的概率，因此置信度也越高。\n\n问题将 $PL$ 字段定义为未归一化的 Phred 标度基因型似然：\n$$PL(G) = -10\\log_{10}(P(D \\mid G))$$\n较低的 $PL$ 值表示给定基因型的似然较高。值得注意的是，VCF 规范通过报告相对于最可能基因型的值来标准化 $PL$ 字段，从而确保最小的 $PL$ 值始终为 $0$。然而，本解答将根据问题的明确定义计算未归一化的值。\n\n### PL 值的计算\n\n给定 $n_{ref}=28$，$n_{alt}=2$，$N=30$ 和 $e=0.01$。\n首先，我们计算二项式系数：\n$$\\binom{30}{2} = \\frac{30 \\times 29}{2 \\times 1} = 435$$\n\n-   **$AA$ 的 PL 值**：\n    $P(D \\mid AA) = 435 \\times (0.01)^{2} \\times (0.99)^{28}$\n    $P(D \\mid AA) \\approx 435 \\times 10^{-4} \\times 0.75511 = 0.032847285$\n    $PL_{AA} = -10 \\log_{10}(0.032847285) \\approx -10 \\times (-1.48350) = 14.8350$\n    四舍五入到三位有效数字，$PL_{AA} = 14.8$。\n\n-   **$AB$ 的 PL 值**：\n    $P(D \\mid AB) = 435 \\times (0.5)^{30}$\n    $P(D \\mid AB) = 435 \\times (2^{-30}) \\approx 435 \\times (9.3132 \\times 10^{-10}) \\approx 4.051 \\times 10^{-7}$\n    $PL_{AB} = -10 \\log_{10}(4.051 \\times 10^{-7}) \\approx -10 \\times (-6.3924) = 63.924$\n    四舍五入到三位有效数字，$PL_{AB} = 63.9$。\n\n-   **$BB$ 的 PL 值**：\n    $P(D \\mid BB) = 435 \\times (0.99)^{2} \\times (0.01)^{28}$\n    $P(D \\mid BB) \\approx 435 \\times 0.9801 \\times 10^{-56} \\approx 4.2634 \\times 10^{-54}$\n    $PL_{BB} = -10 \\log_{10}(4.2634 \\times 10^{-54}) \\approx -10 \\times (-53.3702) = 533.702$\n    四舍五入到三位有效数字，$PL_{BB} = 534$。\n\n计算出的基因型 $AA$、$AB$ 和 $BB$ 的 Phred 标度似然分别约为 $14.8$、$63.9$ 和 $534$。最低的 $PL$ 值对应于 $AA$ 基因型，这正确地将其识别为在给定观测读取计数（$28$ 个参考，$2$ 个备选）和低错误率的情况下最可能的基因型。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n14.8  63.9  534\n\\end{pmatrix}\n}\n$$", "id": "5170271"}, {"introduction": "诊断流程的最后一步是判断一个基因变异的临床意义，这需要整合多维度的证据。本练习将演示如何运用贝叶斯框架，将来自人群频率、功能实验和计算预测等不同来源的证据进行量化整合。通过这种方法，我们可以将一个先验概率更新为更可靠的致病性后验概率，这正是临床遗传学中证据分级和变异解读的核心思想。[@problem_id:5170293]", "problem": "一个与原发性免疫缺陷相关的细胞因子受体基因中的罕见错义变异，正在通过分子和免疫诊断证据评估其致病性。从历史数据整理中，可以获得一个基因和变异类别特异性的致病性基线先验概率：先验概率为 $P_{0} = 0.02$。已经收集了多条独立的证据链，并将其校准为定量似然比，每个似然比定义为 $LR = \\frac{P(\\text{evidence} \\mid \\text{pathogenic})}{P(\\text{evidence} \\mid \\text{benign})}$。可用的证据及其校准后的似然比如下：\n- 跨越三代的家族共分离分析得出的分离贝叶斯因子为 $BF_{\\text{seg}} = 5.0$，可被视为一个似然比 $LR_{\\text{seg}} = 5.0$。\n- 在受影响队列与对照组中的病例-对照富集分析得出 $LR_{\\text{case}} = 8.5$。\n- 基于细胞的功能性分析显示，信号活性降低至野生型的 $15\\%$，该分析的校准将此结果映射为 $LR_{\\text{func}} = 12.0$。\n- 群体约束分析表明，该变异的观察等位基因频率略高于完全外显疾病的预期值；这映射为一个支持良性结论的似然比 $LR_{\\text{pop}} = 0.2$。\n- 一个针对金标准变异集进行校准的集成计算预测得出 $LR_{\\text{comp}} = 3.2$。\n\n假设在真实的致病性状态条件下，这些证据成分在优势比框架下是独立的且可乘的。仅从贝叶斯定理和优势比的定义出发，推导致病性后验概率 $P_{1} = P(\\text{pathogenic} \\mid \\text{all evidence})$ 关于 $P_{0}$ 和所提供似然比的解析表达式，然后根据给定数据计算其数值。将先验概率 $P_{0}$ 和后验概率 $P_{1}$ 均以小数形式报告，每个数值四舍五入至四位有效数字。百分比必须表示为小数。", "solution": "该问题经过验证，被确定为应用于医学遗传学的贝叶斯统计学中一个有效且适定的问题。所有数据均已提供，假设陈述清晰，问题具有科学依据且在数学上是可解的。\n\n该问题要求在给定先验概率 $P_0$ 和几条量化为似然比（$LR$）的独立证据链的情况下，推导并计算致病性的后验概率 $P_1$。\n\n设 $H_P$ 为变异是致病性的假设，$H_B$ 为变异是良性的假设。问题提供了致病性的先验概率：\n$$P(H_P) = P_0 = 0.02$$\n因此，变异为良性的先验概率是：\n$$P(H_B) = 1 - P(H_P) = 1 - P_0 = 1 - 0.02 = 0.98$$\n\n概率与优势比之间的关系由 $O = \\frac{P}{1-P}$ 给出。致病性的先验优势比为：\n$$O_{\\text{prior}} = \\frac{P(H_P)}{P(H_B)} = \\frac{P_0}{1-P_0}$$\n\n贝叶斯定理可以用优势比和似然比来表示。对于单条证据 $E$，后验优势比是先验优势比与该证据的似然比的乘积：\n$$\\text{后验优势比} = \\text{先验优势比} \\times \\text{似然比}$$\n$$O_{\\text{posterior}} = O_{\\text{prior}} \\times LR$$\n其中似然比定义为 $LR = \\frac{P(E \\mid H_P)}{P(E \\mid H_B)}$。\n\n问题指出存在多条独立的证据链，统称为 $\\mathcal{E} = \\{E_{\\text{seg}}, E_{\\text{case}}, E_{\\text{func}}, E_{\\text{pop}}, E_{\\text{comp}}\\}$。在给定真实致病性状态下的独立性条件意味着联合似然是各个似然的乘积：\n$$P(\\mathcal{E} \\mid H_P) = \\prod_{i} P(E_i \\mid H_P)$$\n$$P(\\mathcal{E} \\mid H_B) = \\prod_{i} P(E_i \\mid H_B)$$\n因此，所有证据合并后的总似然比 $LR_{\\text{total}}$ 是各个似然比的乘积：\n$$LR_{\\text{total}} = \\frac{P(\\mathcal{E} \\mid H_P)}{P(\\mathcal{E} \\mid H_B)} = \\frac{\\prod_{i} P(E_i \\mid H_P)}{\\prod_{i} P(E_i \\mid H_B)} = \\prod_{i} \\frac{P(E_i \\mid H_P)}{P(E_i \\mid H_B)} = \\prod_{i} LR_i$$\n具体而言：\n$$LR_{\\text{total}} = LR_{\\text{seg}} \\times LR_{\\text{case}} \\times LR_{\\text{func}} \\times LR_{\\text{pop}} \\times LR_{\\text{comp}}$$\n\n给定所有证据，致病性的后验优势比为：\n$$O_{\\text{posterior}} = O_{\\text{prior}} \\times LR_{\\text{total}} = \\frac{P_0}{1-P_0} \\times \\prod_{i} LR_i$$\n\n后验概率 $P_1 = P(H_P \\mid \\mathcal{E})$ 可以通过公式 $P_1 = \\frac{O_{\\text{posterior}}}{1 + O_{\\text{posterior}}}$ 从后验优势比中恢复。将 $O_{\\text{posterior}}$ 的表达式代入，得到 $P_1$ 关于 $P_0$ 和似然比的所需解析表达式：\n$$P_1 = \\frac{\\left(\\frac{P_0}{1-P_0}\\right) \\prod_{i} LR_i}{1 + \\left(\\frac{P_0}{1-P_0}\\right) \\prod_{i} LR_i}$$\n为简化，分子和分母同乘以 $(1-P_0)$：\n$$P_1 = \\frac{P_0 \\prod_{i} LR_i}{(1-P_0) + P_0 \\prod_{i} LR_i}$$\n\n现在，我们计算数值。给定的似然比如下：\n- $LR_{\\text{seg}} = 5.0$\n- $LR_{\\text{case}} = 8.5$\n- $LR_{\\text{func}} = 12.0$\n- $LR_{\\text{pop}} = 0.2$\n- $LR_{\\text{comp}} = 3.2$\n\n首先，计算总似然比 $LR_{\\text{total}}$：\n$$LR_{\\text{total}} = 5.0 \\times 8.5 \\times 12.0 \\times 0.2 \\times 3.2$$\n$$LR_{\\text{total}} = 326.4$$\n\n接下来，我们使用推导出的 $P_1$ 公式。令 $X = P_0 \\times LR_{\\text{total}}$。\n$$X = 0.02 \\times 326.4 = 6.528$$\n现在将 $X$ 代入 $P_1$ 的公式中：\n$$P_1 = \\frac{X}{(1-P_0) + X} = \\frac{6.528}{(1-0.02) + 6.528} = \\frac{6.528}{0.98 + 6.528} = \\frac{6.528}{7.508}$$\n$$P_1 \\approx 0.8694725625998934$$\n\n问题要求将 $P_0$ 和 $P_1$ 均四舍五入至四位有效数字后报告。\n先验概率 $P_0 = 0.02$。精确到四位有效数字是 $0.02000$。\n后验概率 $P_1 \\approx 0.86947256...$。四舍五入到四位有效数字得到 $0.8695$。\n\n因此，致病性的先验概率为 $P_0 = 0.02000$，考虑所有证据后的后验概率为 $P_1 = 0.8695$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.02000  0.8695 \\end{pmatrix}}$$", "id": "5170293"}]}