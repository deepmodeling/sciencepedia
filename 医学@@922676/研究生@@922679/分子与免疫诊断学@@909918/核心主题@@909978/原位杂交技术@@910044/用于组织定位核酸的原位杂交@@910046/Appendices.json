{"hands_on_practices": [{"introduction": "任何原位杂交 (ISH) 实验的成功都取决于探针特异性结合其预定靶序列并避免脱靶结合的能力。这种特异性由核酸杂交的热力学原理决定。这项练习深入探讨了利用最近邻热力学模型定量预测双链稳定性的方法。通过计算错配对解链温度 ($T_m$) 的影响，你将学会如何合理设计洗涤严谨性条件，这是开发高特异性和高可靠性 ISH 检测的一项关键技能 [@problem_id:5125537]。", "problem": "您正在设计一种原位杂交 (ISH) 检测方法，使用一个由 $25$ 个核苷酸组成的脱氧核糖核酸 (DNA) 探针来检测组织定位的信使核糖核酸 (mRNA)。您将通过计算完全匹配的探针-靶标双链体与两种不完全匹配双链体（单个内部摆动错配和两个不相邻的摆动错配）之间的解链温度差异 $\\Delta T_{m}$ 来确定洗涤严谨性阈值，然后将这些差异映射到实际的洗涤温度和标准柠檬酸盐缓冲液 (SSC) 稀释度上。\n\n使用以下科学依据：\n- 用于 DNA/DNA 双链体的 SantaLucia 最近邻框架下的双态双链体热力学：\n  \n$$\n  T_{m}=\\frac{\\Delta H^{\\circ}}{\\Delta S^{\\circ}+R\\ln\\!\\left(\\frac{C_{T}}{4}\\right)}-273.15+16.6\\,\\log_{10}\\!\\left([M^{+}]\\right),\n  $$\n\n  该公式对非自互补序列有效，其中 $\\Delta H^{\\circ}$ 的单位是 $\\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}$ 的单位是 $\\mathrm{cal\\ mol^{-1}\\ K^{-1}}$，$R=1.987\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$，$C_{T}$ 是以 $\\mathrm{M}$ 为单位的总链浓度，$[M^{+}]$ 是以 $\\mathrm{M}$ 为单位的有效单价阳离子浓度。\n- $1\\times$ SSC 的有效单价阳离子浓度为：$[M^{+}]_{1\\times} = 0.195\\ \\mathrm{M}$。假设对于一个 SSC 稀释因子 $f$（无量纲），有 $[M^{+}]=f\\,[M^{+}]_{1\\times}$，其中 $f=1$ 表示 $1\\times$ SSC，$f=0.5$ 表示 $0.5\\times$ SSC，依此类推。\n\n序列特异性最近邻加和（已完成）给出了在 $pH\\approx 7$ 时该 25 聚体的以下标准态参数：\n- 完全匹配：$\\Delta H^{\\circ}_{\\mathrm{PM}}=-2.23\\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{\\mathrm{PM}}=-605\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n- 在位置 13 的单个内部摆动错配 (G–T)：$\\Delta H^{\\circ}_{1\\mathrm{mm}}=-2.13\\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{1\\mathrm{mm}}=-585\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n- 在位置 9 和 17 的两个不相邻内部摆动错配 (G–T)：$\\Delta H^{\\circ}_{2\\mathrm{mm}}=-2.04\\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{2\\mathrm{mm}}=-565\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n\n假设探针工作浓度为 $C_{T}=1.0\\times 10^{-8}\\ \\mathrm{M}$。盐浓度校正项在 $0.01\\ \\mathrm{M}\\le [M^{+}] \\le 1.0\\ \\mathrm{M}$ 的范围内有效。\n\n任务：\n1) 使用上述热力学定义，计算在 $1\\times$ SSC 条件下的 $T_{m,\\mathrm{PM}}$、$T_{m,1\\mathrm{mm}}$ 和 $T_{m,2\\mathrm{mm}}$。然后计算错配温差 $\\Delta T_{m,1} = T_{m,\\mathrm{PM}}-T_{m,1\\mathrm{mm}}$ 和 $\\Delta T_{m,2} = T_{m,\\mathrm{PM}}-T_{m,2\\mathrm{mm}}$。将这些温度以摄氏度表示。\n\n2) 将用于区分的洗涤温度阈值定义为完全匹配双链体和错配双链体解链温度的中点：\n\n$$\nT_{\\mathrm{mid}}([M^{+}])=\\frac{T_{m,\\mathrm{PM}}([M^{+}])+T_{m,\\mathrm{mm}}([M^{+}])}{2}.\n$$\n\n对于单错配区分，设定实际洗涤温度目标为 $T_{\\mathrm{wash,1}}=58.0$ 摄氏度；对于双错配区分，设定目标为 $T_{\\mathrm{wash,2}}=56.0$ 摄氏度。对于每种情况，解析求解 SSC 稀释因子 $f$，使得 $T_{\\mathrm{mid}}(f\\,[M^{+}]_{1\\times}) = T_{\\mathrm{wash}}$。将您的最终答案报告为分别对应于单错配和双错配目标的两个值 $f_{1}$ 和 $f_{2}$。\n\n答案规格：\n- 将您的最终 SSC 稀释因子 $f_{1}$ 和 $f_{2}$ 四舍五入至三位有效数字。\n- 将最终答案表示为行矩阵 $\\begin{pmatrix} f_{1}  f_{2} \\end{pmatrix}$。\n- 最终方框内的答案不包含单位，但将 $f$ 解释为 $1\\times$ SSC 的倍数。", "solution": "### 问题验证\n#### 第 1 步：提取已知条件\n问题提供了以下数据、定义和条件：\n- **检测类型**：用于组织定位的信使核糖核酸 (mRNA) 的原位杂交 (ISH)。\n- **探针类型**：一个 25 个核苷酸的脱氧核糖核酸 (DNA) 探针。\n- **热力学模型**：双态双链体热力学与 SantaLucia 最近邻框架。\n- **解链温度 ($T_m$) 公式**：\n$$T_{m}=\\frac{\\Delta H^{\\circ}}{\\Delta S^{\\circ}+R\\ln\\!\\left(\\frac{C_{T}}{4}\\right)}-273.15+16.6\\,\\log_{10}\\!\\left([M^{+}]\\right)$$\n- **常量和变量**：\n  - 双链体形成的焓：$\\Delta H^{\\circ}$，单位为 $\\mathrm{cal\\ mol^{-1}}$。\n  - 双链体形成的熵：$\\Delta S^{\\circ}$，单位为 $\\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n  - 理想气体常数：$R=1.987\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n  - 总链浓度：$C_{T}=1.0\\times 10^{-8}\\ \\mathrm{M}$。\n  - 单价阳离子浓度：$[M^{+}]$，单位为 $\\mathrm{M}$。\n- **盐浓度模型**：\n  - $1\\times$ SSC 的有效单价阳离子浓度：$[M^{+}]_{1\\times} = 0.195\\ \\mathrm{M}$。\n  - SSC 稀释因子 $f$ 的关系式：$[M^{+}]=f\\,[M^{+}]_{1\\times}$。\n  - 盐浓度校正有效范围：$0.01\\ \\mathrm{M}\\le [M^{+}] \\le 1.0\\ \\mathrm{M}$。\n- **序列特异性热力学参数**：\n  - 完全匹配 (PM)：$\\Delta H^{\\circ}_{\\mathrm{PM}}=-2.23\\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{\\mathrm{PM}}=-605\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n  - 单个内部摆动错配 (1mm)：$\\Delta H^{\\circ}_{1\\mathrm{mm}}=-2.13\\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{1\\mathrm{mm}}=-585\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n  - 两个不相邻的内部摆动错配 (2mm)：$\\Delta H^{\\circ}_{2\\mathrm{mm}}=-2.04\\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{2\\mathrm{mm}}=-565\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n- **任务定义**：\n  - **任务 1**：计算在 $1\\times$ SSC 条件下的 $T_{m,\\mathrm{PM}}$、$T_{m,1\\mathrm{mm}}$ 和 $T_{m,2\\mathrm{mm}}$。计算错配温差 $\\Delta T_{m,1} = T_{m,\\mathrm{PM}}-T_{m,1\\mathrm{mm}}$ 和 $\\Delta T_{m,2} = T_{m,\\mathrm{PM}}-T_{m,2\\mathrm{mm}}$。\n  - **任务 2**：定义洗涤温度阈值 $T_{\\mathrm{mid}}([M^{+}])=\\frac{T_{m,\\mathrm{PM}}([M^{+}])+T_{m,\\mathrm{mm}}([M^{+}])}{2}$。\n  - 求解 SSC 稀释因子 $f_1$ 和 $f_2$，使得：\n    - $T_{\\mathrm{mid},1}(f_1[M^{+}]_{1\\times}) = T_{\\mathrm{wash,1}} = 58.0$ 摄氏度。\n    - $T_{\\mathrm{mid},2}(f_2[M^{+}]_{1\\times}) = T_{\\mathrm{wash,2}} = 56.0$ 摄氏度。\n- **答案规格**：\n  - 将 $f_1$ 和 $f_2$ 四舍五入至三位有效数字。\n  - 最终答案为行矩阵 $\\begin{pmatrix} f_{1}  f_{2} \\end{pmatrix}$。\n\n#### 第 2 步：使用提取的已知条件进行验证\n1.  **科学性**：该问题基于广泛接受的用于核酸热力学的 SantaLucia 最近邻模型，该模型是分子生物学和诊断学中预测双链体稳定性的基石。所有参数和常数在科学上都是现实的。\n2.  **适定性**：该问题是适定的。它提供了一个清晰的公式、所有必要的参数和一系列明确的计算任务。这些任务导向一个唯一的数值解。\n3.  **客观性**：语言精确且定量。没有主观或模糊的陈述。\n4.  **自洽性与一致性**：提供了所有必要信息。没有内部矛盾。ISH 的背景与所要求的计算是相符的。\n5.  **现实性**：25 聚体 DNA 探针及其错配的参数在典型范围内，目标洗涤温度在实验室环境中是可行的。SSC 浓度是标准的。\n\n#### 第 3 步：结论与行动\n该问题在科学上是合理的、适定的、客观的和自洽的。这是一个有效的问题。我将继续进行求解。\n\n### 求解\n该问题分为两部分。首先，我们计算在标准盐浓度条件下，一个完全匹配双链体和两个错配双链体的解链温度 ($T_m$)。其次，我们确定为达到区分这些双链体的特定中点洗涤温度所需的盐浓度。\n\n首先，我们计算 $T_m$ 方程中熵分量的浓度依赖项。给定 $R = 1.987\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$ 和 $C_T = 1.0 \\times 10^{-8}\\ \\mathrm{M}$：\n$$R\\ln\\left(\\frac{C_T}{4}\\right) = (1.987)\\ln\\left(\\frac{1.0 \\times 10^{-8}}{4}\\right) = (1.987)\\ln(2.5 \\times 10^{-9}) \\approx -39.357\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$$\n为方便起见，我们定义一个修正的熵项：$\\Delta S^{\\circ}_{c} = \\Delta S^{\\circ} + R\\ln(C_T/4)$。\n\n$T_m$ 方程可以表示为：\n$$T_{m} = \\frac{\\Delta H^{\\circ}}{\\Delta S^{\\circ}_{c}} - 273.15 + 16.6\\,\\log_{10}([M^{+}]) \\quad (\\text{单位：摄氏度})$$\n\n#### 第 1 部分：在 $1\\times$ SSC 条件下的解链温度和温差\n对于 $1\\times$ SSC，单价阳离子浓度为 $[M^{+}] = [M^{+}]_{1\\times} = 0.195\\ \\mathrm{M}$。盐浓度校正项为：\n$$16.6\\,\\log_{10}(0.195) \\approx 16.6 \\times (-0.70996) \\approx -11.785\\ ^{\\circ}\\mathrm{C}$$\n\n现在，我们计算三种情况下的 $T_m$：\n\n1.  **完全匹配 (PM)**：\n    $\\Delta H^{\\circ}_{\\mathrm{PM}} = -2.23 \\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{\\mathrm{PM}} = -605\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n    $\\Delta S^{\\circ}_{\\mathrm{PM},c} = -605 - 39.357 = -644.357\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n    $$T_{m,\\mathrm{PM}} = \\frac{-2.23 \\times 10^{5}}{-644.357} - 273.15 - 11.785 \\approx 346.061 - 273.15 - 11.785 \\approx 61.13\\ ^{\\circ}\\mathrm{C}$$\n\n2.  **单错配 (1mm)**：\n    $\\Delta H^{\\circ}_{1\\mathrm{mm}} = -2.13 \\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\circ}_{1\\mathrm{mm}} = -585\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n    $\\Delta S^{\\circ}_{1\\mathrm{mm},c} = -585 - 39.357 = -624.357\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n    $$T_{m,1\\mathrm{mm}} = \\frac{-2.13 \\times 10^{5}}{-624.357} - 273.15 - 11.785 \\approx 341.155 - 273.15 - 11.785 \\approx 56.22\\ ^{\\circ}\\mathrm{C}$$\n\n3.  **双错配 (2mm)**：\n    $\\Delta H^{\\circ}_{2\\mathrm{mm}} = -2.04 \\times 10^{5}\\ \\mathrm{cal\\ mol^{-1}}$，$\\Delta S^{\\o}_{2\\mathrm{mm}} = -565\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n    $\\Delta S^{\\circ}_{2\\mathrm{mm},c} = -565 - 39.357 = -604.357\\ \\mathrm{cal\\ mol^{-1}\\ K^{-1}}$。\n    $$T_{m,2\\mathrm{mm}} = \\frac{-2.04 \\times 10^{5}}{-604.357} - 273.15 - 11.785 \\approx 337.555 - 273.15 - 11.785 \\approx 52.62\\ ^{\\circ}\\mathrm{C}$$\n\n错配温差为：\n$\\Delta T_{m,1} = T_{m,\\mathrm{PM}} - T_{m,1\\mathrm{mm}} \\approx 61.13 - 56.22 = 4.91\\ ^{\\circ}\\mathrm{C}$。\n$\\Delta T_{m,2} = T_{m,\\mathrm{PM}} - T_{m,2\\mathrm{mm}} \\approx 61.13 - 52.62 = 8.51\\ ^{\\circ}\\mathrm{C}$。\n\n#### 第 2 部分：SSC 稀释因子的计算\n洗涤温度设定为中点温度 $T_{\\mathrm{mid}}$。我们需要找到对应两个目标洗涤温度的 SSC 稀释因子 $f$。$T_m$ 方程可以写成关于 $f$ 的函数：\n$$T_{m}(f) = K + 16.6\\,\\log_{10}(f \\cdot [M^{+}]_{1\\times}) = K + 16.6\\,\\log_{10}(f) + 16.6\\,\\log_{10}([M^{+}]_{1\\times})$$\n其中 $K = \\frac{\\Delta H^{\\circ}}{\\Delta S^{\\circ}_{c}} - 273.15$。\n\n中点温度为：\n$$T_{\\mathrm{mid}}(f) = \\frac{T_{m,\\mathrm{PM}}(f) + T_{m,\\mathrm{mm}}(f)}{2} = \\frac{K_{\\mathrm{PM}} + K_{\\mathrm{mm}}}{2} + 16.6\\,\\log_{10}(f) + 16.6\\,\\log_{10}([M^{+}]_{1\\times})$$\n我们令 $T_{\\mathrm{mid}}(f) = T_{\\mathrm{wash}}$ 并求解 $\\log_{10}(f)$：\n$$\\log_{10}(f) = \\frac{1}{16.6} \\left( T_{\\mathrm{wash}} - \\frac{K_{\\mathrm{PM}} + K_{\\mathrm{mm}}}{2} \\right) - \\log_{10}([M^{+}]_{1\\times})$$\n最后，$f = 10^{\\log_{10}(f)}$。\n\n从第 1 部分，我们得到 $K$ 值：\n$K_{\\mathrm{PM}} \\approx 346.061 - 273.15 = 72.911\\ ^{\\circ}\\mathrm{C}$\n$K_{1\\mathrm{mm}} \\approx 341.155 - 273.15 = 68.005\\ ^{\\circ}\\mathrm{C}$\n$K_{2\\mathrm{mm}} \\approx 337.555 - 273.15 = 64.405\\ ^{\\circ}\\mathrm{C}$\n并且 $\\log_{10}([M^{+}]_{1\\times}) = \\log_{10}(0.195) \\approx -0.70996$。\n\n1.  **单错配区分 ($f_1$)**：\n    $T_{\\mathrm{wash,1}} = 58.0\\ ^{\\circ}\\mathrm{C}$。相关的错配是单错配 (1mm)。\n    $\\frac{K_{\\mathrm{PM}} + K_{1\\mathrm{mm}}}{2} \\approx \\frac{72.911 + 68.005}{2} = 70.458\\ ^{\\circ}\\mathrm{C}$。\n    $$\\log_{10}(f_1) \\approx \\frac{1}{16.6} (58.0 - 70.458) - (-0.70996)$$\n    $$\\log_{10}(f_1) \\approx \\frac{-12.458}{16.6} + 0.70996 \\approx -0.75048 + 0.70996 = -0.04052$$\n    $$f_1 = 10^{-0.04052} \\approx 0.91096$$\n    四舍五入到三位有效数字，得到 $f_1 = 0.911$。这对应的盐浓度为 $f_1[M^{+}]_{1\\times} \\approx 0.911 \\times 0.195 \\approx 0.178\\ \\mathrm{M}$，在模型的有效范围（$0.01\\ \\mathrm{M}$ 到 $1.0\\ \\mathrm{M}$）内。\n\n2.  **双错配区分 ($f_2$)**：\n    $T_{\\mathrm{wash,2}} = 56.0\\ ^{\\circ}\\mathrm{C}$。相关的错配是双错配 (2mm)。\n    $\\frac{K_{\\mathrm{PM}} + K_{2\\mathrm{mm}}}{2} \\approx \\frac{72.911 + 64.405}{2} = 68.658\\ ^{\\circ}\\mathrm{C}$。\n    $$\\log_{10}(f_2) \\approx \\frac{1}{16.6} (56.0 - 68.658) - (-0.70996)$$\n    $$\\log_{10}(f_2) \\approx \\frac{-12.658}{16.6} + 0.70996 \\approx -0.76253 + 0.70996 = -0.05257$$\n    $$f_2 = 10^{-0.05257} \\approx 0.88596$$\n    四舍五入到三位有效数字，得到 $f_2 = 0.886$。这对应的盐浓度为 $f_2[M^{+}]_{1\\times} \\approx 0.886 \\times 0.195 \\approx 0.173\\ \\mathrm{M}$，也在模型的有效范围内。\n\n最终答案是稀释因子对 $(f_1, f_2)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.911  0.886\n\\end{pmatrix}\n}\n$$", "id": "5125537"}, {"introduction": "除了特异性，一个成功的 ISH 检测还必须产生能够与背景噪声清晰区分的强信号。探针浓度是影响特异性信号和非特异性背景的关键参数。本练习使用成熟的物理模型来模拟这种权衡：用朗缪尔等温线描述特异性结合，用线性模型描述非特异性相互作用。通过推导并找到使信噪比 (SNR) 最大化的探针浓度，你将练习一项至关重要的优化技能，并理解为何目标不应总是追求最大信号，而是优化以获得最清晰的信号，这对于可靠检测至关重要 [@problem_id:5125503]。", "problem": "在一项对福尔马林固定、石蜡包埋的组织进行的诊断性原位杂交(ISH)检测中，使用单链DNA探针来检测细胞内定位的特定信使核糖核酸(mRNA)靶标。假设以下基本原则适用：(i) 中心法则确定了mRNA靶标的存在；(ii) 质量作用定律控制杂交过程；(iii) 在平衡状态下，被探针占据的靶位点的分数由朗缪尔等温线描述。设特异性靶标的解离常数为$K_{d}$，总最大特异性信号（对于完全占据的靶位点和完成的检测化学反应）为$S_{\\max}$，以任意荧光单位(a.u.)计量。在这些条件下，特异性信号强度作为探针浓度$c$的函数，其模型为$S(c) = S_{\\max}\\,\\frac{c}{c + K_{d}}$。同时，非特异性结合和背景噪声构成了一个检测和仪器特有的基线$N_{0}$ (a.u.)，外加一个因整个组织中低亲和力脱靶相互作用而随$c$近似线性增加的项，其模型为$N(c) = N_{0} + \\beta\\,c$，其中$\\beta$是一个系数，单位为a.u./nM。\n\n对于此检测，假设$K_{d} = 10$ nM, $S_{\\max} = 200$ a.u., $N_{0} = 0.50$ a.u., 且$\\beta = 0.125$ a.u./nM。在检测置信度相关的信噪比(SNR)由比率$S(c)/N(c)$决定的情况下，请使用上述假设，从第一性原理推导出使$\\mathrm{SNR}(c) = \\frac{S(c)}{N(c)}$最大化的探针浓度$c^{\\ast}$。然后，使用所提供的参数值对$c^{\\ast}$进行数值计算。将最终数值答案四舍五入至三位有效数字，并以nM为单位表示浓度。", "solution": "该问题要求找到使信噪比$\\mathrm{SNR}(c)$最大化的探针浓度，记为$c^{\\ast}$。分析过程将首先验证问题陈述的有效性，如果有效，则使用微分学从提供的模型中推导出最佳浓度。\n\n### 步骤1：提取已知条件\n- 特异性信号强度作为探针浓度$c$的函数：$S(c) = S_{\\max}\\,\\frac{c}{c + K_{d}}$\n- 噪声作为探针浓度$c$的函数：$N(c) = N_{0} + \\beta\\,c$\n- 信噪比(SNR)定义：$\\mathrm{SNR}(c) = \\frac{S(c)}{N(c)}$\n- 解离常数：$K_{d} = 10$ nM\n- 最大特异性信号：$S_{\\max} = 200$ a.u.\n- 基线噪声：$N_{0} = 0.50$ a.u.\n- 非特异性结合系数：$\\beta = 0.125$ a.u./nM\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，它依赖于质量作用定律、用于结合动力学的朗缪尔等温线以及用于非特异性相互作用的线性模型，这些都是分子生物学和生物物理学中标准且恰当的近似。该问题是适定的；它是一个标准的优化任务，即在物理上有意义的域($c \\ge 0$)上寻找一个连续可微函数的最大值。所有必需的参数和函数形式均已提供，使得问题自成体系且完整。没有矛盾、歧义或不科学的前提。参数值对于ISH检测来说在物理上是合理的。因此，该问题被认定为有效。\n\n### 步骤3：结论与行动\n问题有效。将提供一个有理有据的解答。\n\n目标是找到使函数$\\mathrm{SNR}(c)$最大化的浓度$c = c^{\\ast}$。首先，我们通过代入给定的$S(c)$和$N(c)$表达式来表示$\\mathrm{SNR}(c)$：\n$$\n\\mathrm{SNR}(c) = \\frac{S(c)}{N(c)} = \\frac{S_{\\max}\\,\\frac{c}{c + K_{d}}}{N_{0} + \\beta\\,c}\n$$\n这可以重写为：\n$$\n\\mathrm{SNR}(c) = \\frac{S_{\\max}c}{(c + K_{d})(N_{0} + \\beta c)}\n$$\n为了找到该函数关于$c$的最大值，我们必须计算其导数$\\frac{d}{dc}\\mathrm{SNR}(c)$，将导数设为零，然后求解$c$。浓度$c$必须为非负数，即$c \\ge 0$。\n\n我们展开分母：\n$$\n(c + K_{d})(N_0 + \\beta c) = N_0 c + \\beta c^2 + N_0 K_d + \\beta K_d c = \\beta c^2 + (N_0 + \\beta K_d)c + N_0 K_d\n$$\n因此，要求导的函数是：\n$$\n\\mathrm{SNR}(c) = \\frac{S_{\\max}c}{\\beta c^2 + (N_0 + \\beta K_d)c + N_0 K_d}\n$$\n我们应用微分的商法则，$\\left(\\frac{u}{v}\\right)' = \\frac{u'v - uv'}{v^2}$，其中$u(c) = S_{\\max}c$且$v(c) = \\beta c^2 + (N_0 + \\beta K_d)c + N_0 K_d$。\n导数是：\n$$\nu'(c) = \\frac{d}{dc}(S_{\\max}c) = S_{\\max}\n$$\n$$\nv'(c) = \\frac{d}{dc}(\\beta c^2 + (N_0 + \\beta K_d)c + N_0 K_d) = 2\\beta c + N_0 + \\beta K_d\n$$\n那么$\\mathrm{SNR}(c)$的导数是：\n$$\n\\frac{d}{dc}\\mathrm{SNR}(c) = \\frac{S_{\\max}(\\beta c^2 + (N_0 + \\beta K_d)c + N_0 K_d) - (S_{\\max}c)(2\\beta c + N_0 + \\beta K_d)}{[\\beta c^2 + (N_0 + \\beta K_d)c + N_0 K_d]^2}\n$$\n为了找到最大值，我们将分子设为零。由于$S_{\\max}$是一个非零常数，我们可以将其提出并简化：\n$$\n(\\beta c^2 + (N_0 + \\beta K_d)c + N_0 K_d) - c(2\\beta c + N_0 + \\beta K_d) = 0\n$$\n展开第二项：\n$$\n\\beta c^2 + N_0 c + \\beta K_d c + N_0 K_d - 2\\beta c^2 - N_0 c - \\beta K_d c = 0\n$$\n合并同类项，我们观察到关于$c$的线性项相互抵消：\n$$\n(\\beta - 2\\beta)c^2 + (N_0 - N_0)c + (\\beta K_d - \\beta K_d)c + N_0 K_d = 0\n$$\n$$\n-\\beta c^2 + N_0 K_d = 0\n$$\n求解$c^2$：\n$$\n\\beta c^2 = N_0 K_d\n$$\n$$\nc^2 = \\frac{N_0 K_d}{\\beta}\n$$\n由于浓度$c$必须是正实数，我们取正平方根：\n$$\nc^{\\ast} = \\sqrt{\\frac{N_0 K_d}{\\beta}}\n$$\n这就是使信噪比最大化的探针浓度。为了确认这是一个最大值，我们可以检查导数分子$f(c) = -\\beta c^2 + N_0 K_d$的符号。由于$\\beta  0$，这是一个开口向下的抛物线，其根在$c = c^{\\ast}$处。对于$0  c  c^{\\ast}$，$f(c)  0$且$\\mathrm{SNR}(c)$是递增的。对于$c  c^{\\ast}$，$f(c)  0$且$\\mathrm{SNR}(c)$是递减的。因此，$c^{\\ast}$对应于$c  0$时的全局最大值。\n\n现在，我们代入给定的数值来求具体浓度：\n$K_{d} = 10$ nM, $N_{0} = 0.50$ a.u., 且$\\beta = 0.125$ a.u./nM。\n$$\nc^{\\ast} = \\sqrt{\\frac{(0.50)(10)}{0.125}}\n$$\n$$\nc^{\\ast} = \\sqrt{\\frac{5}{0.125}}\n$$\n注意到$0.125 = \\frac{1}{8}$，表达式简化为：\n$$\nc^{\\ast} = \\sqrt{5 \\times 8} = \\sqrt{40}\n$$\n计算数值：\n$$\nc^{\\ast} = \\sqrt{40} \\approx 6.324555... \\text{ nM}\n$$\n问题要求将结果四舍五入到三位有效数字。\n$$\nc^{\\ast} \\approx 6.32 \\text{ nM}\n$$\n这就是最佳探针浓度。", "answer": "$$\n\\boxed{6.32}\n$$", "id": "5125503"}, {"introduction": "现代分子诊断通常需要在单个样本中同时检测多个靶标（多重检测）。在多重荧光原位杂交 (FISH) 中，这带来了一个挑战：不同荧光团的发射光谱会发生重叠，导致在一个通道中检测到的信号是来自多个探针的混合物。这项练习引入了用于“光谱分离”的强大线性代数框架来解决这个问题。你将学习如何用混合矩阵为光谱串扰建模，并推导出最小二乘解，从而在计算上分离出每个荧光团的真实贡献，为定量、多重成像这一现代细胞生物学和诊断学的核心技术提供实践基础 [@problem_id:5125533]。", "problem": "一个多重荧光原位杂交（FISH）实验在一个三通道落射荧光系统上进行成像。在线性探测器响应和独立荧光团发射的叠加原理下，测得的通道信号被建模为基础荧光团贡献的线性混合。设测得的信号向量为 $S \\in \\mathbb{R}^{m}$，荧光团贡献向量为 $F \\in \\mathbb{R}^{n}$，光谱混合矩阵为 $A \\in \\mathbb{R}^{m \\times n}$。正向模型为 $S = A F$，其中 $A_{ij}$ 表示从荧光团 $j$ 发射并在通道 $i$ 中记录到的部分。假设 $A$ 是已知的固定矩阵，通过在相同采集设置下的单荧光团对照获得，并且 $S$ 是为单个像素测量的。\n\n从线性模型 $S = A F$、最小二乘法原理以及奇异值分解（SVD）的定义出发，推导在一般情况下从 $S$ 恢复 $F$ 的线性解混方程。将解与摩尔-彭若斯伪逆明确联系起来，并根据奇异值定义2-范数条件数，解释其与稳定性的相关性。在推导中不假设 $A$ 具有任何特殊结构。\n\n然后，对于一个三荧光团实验中的特定像素，测得的信号向量和混合矩阵为：\n$$\nS = \\begin{pmatrix} 0.80 \\\\ 0.60 \\\\ 0.20 \\end{pmatrix}, \\quad\nA = \\begin{pmatrix}\n0.75  0.15  0.00 \\\\\n0.15  0.75  0.00 \\\\\n0.00  0.00  0.50\n\\end{pmatrix}.\n$$\n使用你推导的方程，计算解混后的荧光团贡献 $F$ 和2-范数条件数 $\\kappa_{2}(A)$。将最终的强度表示为无单位数。将所有要求的数值四舍五入到四位有效数字。将你的最终答案表示为一个单行矩阵，包含 $F$ 的三个分量，后跟 $\\kappa_{2}(A)$。", "solution": "问题陈述被评估为有效。它在科学上基于光谱成像中使用的标准线性混合模型，问题设定良好，信息充分且一致，可得到唯一解，并以客观的数学语言表述。\n\n任务是首先推导线性系统 $S = AF$ 的通用最小二乘解，然后将其应用于一个具体案例。\n\n**第一部分：线性解混方程的通用推导**\n\n正向模型由以下线性方程给出：\n$$S = A F$$\n其中 $S \\in \\mathbb{R}^{m}$ 是测得的信号向量，$F \\in \\mathbb{R}^{n}$ 是未知的荧光团贡献向量，$A \\in \\mathbb{R}^{m \\times n}$ 是已知的光谱混合矩阵。我们寻求在给定测量值 $S$ 和矩阵 $A$ 的情况下，找到 $F$ 的一个估计值，称之为 $\\hat{F}$。\n\n采用最小二乘法原理来寻找使残差向量 $r = S - A\\hat{F}$ 的平方欧几里得范数最小化的向量 $\\hat{F}$。目标是最小化成本函数 $J(\\hat{F})$：\n$$J(\\hat{F}) = \\|S - A\\hat{F}\\|_2^2 = (S - A\\hat{F})^T (S - A\\hat{F})$$\n展开 $J(\\hat{F})$ 的表达式得到：\n$$J(\\hat{F}) = S^T S - S^T A \\hat{F} - (A\\hat{F})^T S + (A\\hat{F})^T (A\\hat{F})$$\n$$J(\\hat{F}) = S^T S - S^T A \\hat{F} - \\hat{F}^T A^T S + \\hat{F}^T A^T A \\hat{F}$$\n由于 $\\hat{F}^T A^T S$ 是一个标量，它等于其转置，即 $(S^T A \\hat{F})^T = \\hat{F}^T A^T S$。因此，我们可以合并中间两项：\n$$J(\\hat{F}) = S^T S - 2 S^T A \\hat{F} + \\hat{F}^T A^T A \\hat{F}$$\n为了找到这个二次函数的最小值，我们对 $\\hat{F}$ 求梯度并令其为零。\n$$\\nabla_{\\hat{F}} J(\\hat{F}) = -2 A^T S + 2 A^T A \\hat{F}$$\n令梯度为零，$\\nabla_{\\hat{F}} J(\\hat{F}) = 0$，得到**正规方程**：\n$$A^T A \\hat{F} = A^T S$$\n如果矩阵 $A^T A$ 可逆（当 $A$ 的列线性无关，即满秩时成立），我们可以解出 $\\hat{F}$：\n$$\\hat{F} = (A^T A)^{-1} A^T S$$\n矩阵 $(A^T A)^{-1} A^T$ 是 $A$ 的**摩尔-彭若斯伪逆**的定义，记作 $A^+$。因此，通用的最小二乘解是：\n$$\\hat{F} = A^+ S$$\n这个解在最小二乘意义上为 $F$ 提供了最佳估计，即使对于非方阵 $A$ 也适用。\n\n为了将此与奇异值分解（SVD）联系起来，我们将 $A$ 表示为 $A = U \\Sigma V^T$，其中 $U$ 是一个 $m \\times m$ 的正交矩阵，$V$ 是一个 $n \\times n$ 的正交矩阵，$\\Sigma$ 是一个 $m \\times n$ 的矩形对角矩阵，包含 $A$ 的非负奇异值 $\\sigma_i$。伪逆 $A^+$ 可以通过 SVD 分解计算得到，$A^+ = V \\Sigma^+ U^T$，其中 $\\Sigma^+$ 是通过对 $\\Sigma$ 中每个非零奇异值取倒数，然后转置所得矩阵得到的。\n\n将伪逆的 SVD 形式代入解中，得到：\n$$\\hat{F} = (V \\Sigma^+ U^T) S$$\n这个方程提供了一种数值上稳定的计算最小二乘解的方法，特别是当 $A$ 是病态的或非满秩时。\n\n该解的稳定性由矩阵 $A$ 的**条件数**来表征。2-范数条件数 $\\kappa_2(A)$ 定义为 $A$ 的2-范数与其伪逆的2-范数的乘积：\n$$\\kappa_2(A) = \\|A\\|_2 \\|A^+\\|_2$$\n用奇异值来表示，$A$ 的2-范数是其最大的奇异值 $\\sigma_{\\max}$，$A^+$ 的2-范数是其最小非零奇异值的倒数 $1/\\sigma_{\\min}$。因此，条件数是比率：\n$$\\kappa_2(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}$$\n条件数衡量了解向量 $F$ 对测量向量 $S$ 中扰动的敏感度。大的条件数（$\\kappa_2(A) \\gg 1$）表示一个病态问题。在这种情况下，测量信号 $S$ 中的小误差或噪声会被显著放大，导致计算出的荧光团贡献 $F$ 出现大误差。这使得解混过程不稳定。\n\n**第二部分：具体计算**\n\n对于给定的像素，测得的信号向量 $S$ 和混合矩阵 $A$ 为：\n$$\nS = \\begin{pmatrix} 0.80 \\\\ 0.60 \\\\ 0.20 \\end{pmatrix}, \\quad\nA = \\begin{pmatrix}\n0.75  0.15  0.00 \\\\\n0.15  0.75  0.00 \\\\\n0.00  0.00  0.50\n\\end{pmatrix}\n$$\n这里，$A$ 是一个方形（$3 \\times 3$）对称矩阵。其行列式为 $\\det(A) = 0.50 \\times (0.75^2 - 0.15^2) = 0.50 \\times (0.5625 - 0.0225) = 0.50 \\times 0.54 = 0.27$，非零。因此，$A$ 是可逆的，最小二乘解 $\\hat{F}$ 就是精确解 $F = A^{-1}S$。我们可以求解方程组 $AF = S$：\n$$0.75 F_1 + 0.15 F_2 = 0.80$$\n$$0.15 F_1 + 0.75 F_2 = 0.60$$\n$$0.50 F_3 = 0.20$$\n从第三个方程，我们立即得到 $F_3$：\n$$F_3 = \\frac{0.20}{0.50} = 0.40$$\n为了解前两个方程，我们可以使用任何标准方法。对左上角的 $2 \\times 2$ 子矩阵使用克莱姆法则或矩阵求逆：\n$$\n\\begin{pmatrix} F_1 \\\\ F_2 \\end{pmatrix}\n= \\begin{pmatrix} 0.75  0.15 \\\\ 0.15  0.75 \\end{pmatrix}^{-1} \\begin{pmatrix} 0.80 \\\\ 0.60 \\end{pmatrix}\n= \\frac{1}{0.54} \\begin{pmatrix} 0.75  -0.15 \\\\ -0.15  0.75 \\end{pmatrix} \\begin{pmatrix} 0.80 \\\\ 0.60 \\end{pmatrix}\n$$\n$$F_1 = \\frac{1}{0.54} (0.75 \\times 0.80 - 0.15 \\times 0.60) = \\frac{1}{0.54} (0.60 - 0.09) = \\frac{0.51}{0.54} = \\frac{17}{18} \\approx 0.94444...$$\n$$F_2 = \\frac{1}{0.54} (-0.15 \\times 0.80 + 0.75 \\times 0.60) = \\frac{1}{0.54} (-0.12 + 0.45) = \\frac{0.33}{0.54} = \\frac{11}{18} \\approx 0.61111...$$\n四舍五入到四位有效数字，荧光团贡献向量为 $F \\approx \\begin{pmatrix} 0.9444 \\\\ 0.6111 \\\\ 0.4000 \\end{pmatrix}$。\n\n接下来，我们计算条件数 $\\kappa_2(A)$。由于 $A$ 是对称的，其奇异值是其特征值的绝对值。我们通过求解 $\\det(A-\\lambda I) = 0$ 来找到特征值 $\\lambda$：\n$$\n\\det\\begin{pmatrix} 0.75-\\lambda  0.15  0 \\\\ 0.15  0.75-\\lambda  0 \\\\ 0  0  0.50-\\lambda \\end{pmatrix} = (0.50-\\lambda) \\left[ (0.75-\\lambda)^2 - 0.15^2 \\right] = 0\n$$\n一个特征值立即得出为 $\\lambda_3 = 0.50$。另外两个由以下方程得出：\n$$(0.75-\\lambda)^2 = 0.15^2 \\implies 0.75-\\lambda = \\pm 0.15$$\n$$\\lambda = 0.75 \\mp 0.15$$\n这给出 $\\lambda_1 = 0.75 + 0.15 = 0.90$ 和 $\\lambda_2 = 0.75 - 0.15 = 0.60$。\n特征值为 $\\{0.90, 0.60, 0.50\\}$。由于它们都是正数，奇异值等于特征值。\n最大奇异值为 $\\sigma_{\\max} = 0.90$。\n最小奇异值为 $\\sigma_{\\min} = 0.50$。\n条件数为：\n$$\\kappa_2(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{0.90}{0.50} = 1.8$$\n将要求的数值四舍五入到四位有效数字，得到：\n$F_1 = 0.9444$\n$F_2 = 0.6111$\n$F_3 = 0.4000$\n$\\kappa_2(A) = 1.800$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9444  0.6111  0.4000  1.800\n\\end{pmatrix}\n}\n$$", "id": "5125533"}]}