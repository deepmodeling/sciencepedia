{"hands_on_practices": [{"introduction": "Sanger测序工作流程的基石是对每个碱基测序质量的精确量化。本节的第一个实践将引导您从基本原理出发，推导Phred质量分数的数学形式，这是现代测序技术中无处不在的质量度量标准。通过这个练习[@problem_id:5159650]，您将深入理解为何碱基检出错误率的乘性降低会转化为质量分数的加性增加，以及$Q \\ge 20$等常用质量阈值的概率意义。", "problem": "在用于分子诊断与免疫诊断的桑格测序碱基检出流程中，每个检出的核苷酸都被赋予一个估计的错误概率 $p \\in (0,1)$，表示该检出结果不正确。一个实验室希望从第一性原理出发，定义一个标量质量分数 $Q(p)$ 来量化检出结果的置信度，以便在不同批次和仪器之间可以统一地做出下游决策（例如接受或拒绝检出结果）。他们要求 $Q(p)$ 满足以下由置信度的可解释性和可组合性驱动的条件：(i) $Q(p)$ 关于 $p$ 是连续且严格递减的，并将最差情况 $p=1$ 映射到参考分数 $Q(1)=0$；(ii) 错误概率的乘法性降低应转化为质量的固定加法性提高，具体而言，存在一个正常数 $A$，使得对于所有 $p \\in (0,1)$，将 $p$ 减小 10 倍会使质量增加 $A$，即 $Q(p/10)-Q(p)=A$；(iii) 为了根据常见的测序实践来确定尺度，常规的高置信度参考点满足 $Q(10^{-2})=20$。仅使用这些要求和对数的标准性质，推导与(i)–(iii)一致的 $Q(p)$ 的唯一函数形式。然后，对该函数求逆得到 $p(Q)$，并确定对应于决策阈值 $Q \\ge 20$ 的错误概率。将你的最终答案表示为一个行矩阵，按顺序包含 $p(Q)$ 的解析表达式和阈值处的错误概率。无需近似计算。", "solution": "对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n- 变量 $p$ 代表检出的核苷酸的估计错误概率，其中 $p \\in (0,1)$。\n- 标量质量分数 $Q(p)$ 是 $p$ 的函数。\n- 条件 (i): $Q(p)$ 关于 $p$ 是连续且严格递减的。它满足边界条件 $Q(1)=0$。\n- 条件 (ii): 错误概率的乘法性降低导致质量的加法性增加。具体而言，存在一个正常数 $A$，使得对于所有 $p \\in (0,1)$，函数方程 $Q(p/10) - Q(p) = A$ 成立。\n- 条件 (iii): 给定一个参考点 $Q(10^{-2}) = 20$。\n- 任务是：\n    1. 推导 $Q(p)$ 的唯一函数形式。\n    2. 对该函数求逆以获得 $p(Q)$。\n    3. 确定决策阈值 $Q \\ge 20$ 的错误概率。\n    4. 将最终答案表示为一个行矩阵，其中包含 $p(Q)$ 和阈值处的错误概率。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了 Phred 质量分数的概念基础，这是 DNA 测序和生物信息学中一个基础且广泛使用的度量标准。这些条件是对此类分数性质的形式化。该问题在科学上是合理的，并且与分子诊断领域相关。\n- **适定性：** 该问题提供了一组函数约束和边界条件来唯一地确定一个函数。这是数学建模中的一个经典适定问题。这些条件是充分的且不矛盾。例如，将条件 (ii) 应用两次得到 $Q(p/100) - Q(p) = 2A$。当 $p=1$ 时，并使用条件 (i) $Q(1)=0$，我们得到 $Q(10^{-2}) = 2A$。条件 (iii) 指出 $Q(10^{-2})=20$，这意味着 $2A=20$ 或 $A=10$。这表明这些条件是相互一致的。\n- **客观性：** 该问题以精确的数学语言陈述，没有歧义或主观性。\n\n### 第 3 步：结论与行动\n该问题是有效的，因为它具有科学依据、适定性、客观性且内部一致。可以进行求解。\n\n### 求解推导\n问题要求找到一个满足给定属性集的函数 $Q(p)$。我们从条件 (ii) 的函数方程开始：\n$$Q\\left(\\frac{p}{10}\\right) - Q(p) = A$$\n其中 $A$ 是一个正常数。该方程将函数自变量的缩放与函数值的加性平移联系起来，这是对数函数的特征。\n\n让我们对一个正整数 $n$ 迭代应用此方程。\n$$Q\\left(\\frac{p}{10}\\right) - Q(p) = A$$\n$$Q\\left(\\frac{p}{10^2}\\right) - Q\\left(\\frac{p}{10}\\right) = A$$\n$$\\vdots$$\n$$Q\\left(\\frac{p}{10^n}\\right) - Q\\left(\\frac{p}{10^{n-1}}\\right) = A$$\n将这 $n$ 个方程相加，左边形成一个伸缩级数：\n$$\\left(Q\\left(\\frac{p}{10^n}\\right) - Q\\left(\\frac{p}{10^{n-1}}\\right)\\right) + \\dots + \\left(Q\\left(\\frac{p}{10}\\right) - Q(p)\\right) = nA$$\n$$Q\\left(\\frac{p}{10^n}\\right) - Q(p) = nA$$\n为了确定常数 $A$，我们可以使用其他条件。让我们在上述关系式中设 $p=1$。根据条件 (i)，我们知道 $Q(1)=0$。\n$$Q\\left(\\frac{1}{10^n}\\right) - Q(1) = nA$$\n$$Q(10^{-n}) = nA$$\n现在，我们应用条件 (iii)，即 $Q(10^{-2}) = 20$。使用我们对 $n=2$ 推导出的关系，我们有 $Q(10^{-2}) = 2A$。\n令两者相等可得：\n$$2A = 20$$\n$$A = 10$$\n所以，常数 $A$ 是 $10$。\n\n满足 $Q(p/10) - Q(p) = 10$ 的函数的一般形式是对数函数。我们假设其形式为 $Q(p) = C_1 \\log_{10}(p) + C_2$，并确定常数 $C_1$ 和 $C_2$。\n将此形式代入函数方程：\n$$\\left(C_1 \\log_{10}\\left(\\frac{p}{10}\\right) + C_2\\right) - (C_1 \\log_{10}(p) + C_2) = 10$$\n$$C_1 \\left(\\log_{10}(p) - \\log_{10}(10)\\right) - C_1 \\log_{10}(p) = 10$$\n$$C_1 \\log_{10}(p) - C_1(1) - C_1 \\log_{10}(p) = 10$$\n$$-C_1 = 10 \\implies C_1 = -10$$\n这给出了函数形式 $Q(p) = -10 \\log_{10}(p) + C_2$。\n为了找到常数 $C_2$，我们使用 (i) 中的边界条件 $Q(1)=0$：\n$$Q(1) = -10 \\log_{10}(1) + C_2 = 0$$\n由于 $\\log_{10}(1)=0$，这可以简化为 $0 + C_2 = 0$，从而得到 $C_2=0$。\n因此，满足所有三个条件的唯一函数是：\n$$Q(p) = -10 \\log_{10}(p)$$\n我们可以验证该函数在 $p \\in (0,1)$ 上是连续且严格递减的，因为 $\\log_{10}(p)$ 是严格递增的。\n\n第二个任务是求反函数 $p(Q)$。我们求解方程以得到 $p$：\n$$Q = -10 \\log_{10}(p)$$\n$$-\\frac{Q}{10} = \\log_{10}(p)$$\n根据以 10 为底的对数的定义，将等式两边作为 10 的指数，得到：\n$$p(Q) = 10^{-Q/10}$$\n\n最后一个任务是找到对应于决策阈值 $Q \\ge 20$ 的错误概率 $p$。由于 $Q(p)$ 是关于 $p$ 的严格递减函数，不等式 $Q \\ge 20$ 等价于 $p \\le p(20)$。该阈值边界处的错误概率可以通过将 $Q=20$ 代入 $p(Q)$ 的表达式来求得：\n$$p(20) = 10^{-20/10} = 10^{-2}$$\n这个值等于 $0.01$。\n\n最终答案要求一个行矩阵，其中包含 $p(Q)$ 的解析表达式和在阈值 $Q=20$ 处的错误概率。它们分别是 $10^{-Q/10}$ 和 $10^{-2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10^{-Q/10}  10^{-2}\n\\end{pmatrix}\n}\n$$", "id": "5159650"}, {"introduction": "在理论上理解了Phred质量分数后，下一个关键步骤是将其应用于真实的实验室质量控制（QC）场景。在临床和诊断环境中，必须严格遵守标准操作程序（SOP）以确保结果的可靠性。这个实践[@problem_id:5159597]模拟了一个典型的QC任务，您需要根据给定的SOP标准，评估一批Sanger测序读段的质量数据，以判断整个测序运行是否达标。", "problem": "一个进行染料终止子桑格测序的临床分子诊断实验室根据标准操作程序（SOP）验证运行质量。碱基判读质量由Phred质量值（QV）量化，每个碱基的Phred质量值由关系式 $Q = -10 \\log_{10}(P_{e})$ 定义，其中 $P_{e}$ 是碱基判读错误的概率。在该实验室中，如果一个碱基的 $Q \\ge 30$，则被分类为“高质量”，这对应于最多 $10^{-3}$ 的碱基判读错误概率。SOP设定了两个阈值：(i) 读段水平标准，要求在一条读段的前 $500$ 个碱基中，至少有 $0.95$ 的比例必须是高质量碱基；以及 (ii) 运行水平标准，要求一次运行中至少有 $0.90$ 比例的读段必须满足读段水平标准。\n\n对于一次包含 $40$ 条读段的测序运行，实验室已为每条读段预先计算了前 $500$ 个碱基中 $Q \\ge 30$ 的位置数量。这些计数（每条读段一个，按顺序排列）如下：\n$500, 499, 498, 497, 496, 495, 494, 493, 492, 491, 490, 489, 488, 487, 486, 485, 484, 483, 482, 481, 480, 479, 478, 477, 476, 475, 500, 500, 499, 498, 497, 495, 490, 480, 475, 476, 492, 472, 468, 451$。\n\n从Phred质量值的定义和SOP标准出发，确定在前 $500$ 个碱基中满足读段水平标准的读段所占的运行水平比例（以小数形式表示），并评估该次运行是否符合SOP。仅报告计算出的比例作为最终答案，四舍五入到四位有效数字。不要包含任何单位。", "solution": "问题要求我们确定满足指定质量标准的测序读段的比例，并评估整个测序运行是否符合更高层级的标准操作程序（SOP）。解决方案需要将给定的标准系统地应用于所提供的数据集。\n\n首先，我们将问题陈述中定义的标准形式化。碱基判读质量由Phred质量值 $Q$ 给出，定义为 $Q = -10 \\log_{10}(P_{e})$，其中 $P_{e}$ 是碱基判读错误的概率。该问题是自洽的，因此我们不需要直接使用此公式，但它为质量分数提供了科学背景。\n\n如果一个碱基的Phred分数为 $Q \\ge 30$，则被定义为“高质量”。分析仅限于每条读段的前 $N_{bases} = 500$ 个碱基。\n\n读段水平标准是，在这 $500$ 个碱基中，至少有 $f_{read} = 0.95$ 的比例必须是高质量的。设 $C_{HQ}$ 为给定读段的高质量碱基数。要使一条读段通过此标准，必须满足以下不等式：\n$$ \\frac{C_{HQ}}{N_{bases}} \\ge f_{read} $$\n代入给定值，我们可以求出一条读段通过所需的最小高质量碱基数 $C_{HQ,min}$：\n$$ \\frac{C_{HQ}}{500} \\ge 0.95 $$\n$$ C_{HQ} \\ge 500 \\times 0.95 $$\n$$ C_{HQ} \\ge 475 $$\n因此，如果一条读段在其前 $500$ 个碱基中至少有 $475$ 个碱基的 $Q \\ge 30$，则认为该读段已通过读段水平的质量检查。\n\n接下来，我们得到一个包含 $N_{reads} = 40$ 条读段的测序运行数据集。数据包含为这 $40$ 条读段中每一条预先计算的高质量碱基数 $C_{HQ}$。我们现在必须计算这些读段中有多少条满足条件 $C_{HQ} \\ge 475$。所提供的计数列表为：\n$500, 499, 498, 497, 496, 495, 494, 493, 492, 491, 490, 489, 488, 487, 486, 485, 484, 483, 482, 481, 480, 479, 478, 477, 476, 475, 500, 500, 499, 498, 497, 495, 490, 480, 475, 476, 492, 472, 468, 451$。\n\n为了找出符合标准的读段数量，计算不符合标准的读段数量会更高效。如果一条读段的高质量碱基数小于 $475$，则该读段不合格。我们检查列表，找出值 $C_{HQ}  475$ 的项。不合格的计数是：\n- $472$\n- $468$\n- $451$\n\n有 $N_{fail} = 3$ 条读段不满足读段水平标准。该次运行中的总读段数为 $N_{reads} = 40$。因此，通过标准的读段数 $N_{pass}$ 为：\n$$ N_{pass} = N_{reads} - N_{fail} = 40 - 3 = 37 $$\n\n问题要求的是满足读段水平标准的读段在运行水平上所占的比例。设此比例为 $P_{pass}$。其计算方法如下：\n$$ P_{pass} = \\frac{N_{pass}}{N_{reads}} = \\frac{37}{40} $$\n将此分数转换为小数：\n$$ P_{pass} = 0.925 $$\n\n问题还要求评估该次运行是否符合SOP。运行水平标准规定，至少有 $f_{run} = 0.90$ 比例的读段必须满足读段水平标准。为检查是否符合要求，我们将计算出的比例 $P_{pass}$ 与要求的比例 $f_{run}$ 进行比较：\n$$ P_{pass} \\ge f_{run} $$\n$$ 0.925 \\ge 0.90 $$\n此不等式成立，意味着该测序运行确实符合SOP。\n\n最后，问题要求一个单一的数值答案：计算出的比例，四舍五入到四位有效数字。计算出的比例是 $0.925$。为了用四位有效数字表示，我们在末尾加一个零：$0.9250$。", "answer": "$$\\boxed{0.9250}$$", "id": "5159597"}, {"introduction": "高水平的测序数据分析不仅需要评估碱基质量，还需要能够区分真实的生物信号与实验过程产生的伪影。这个高级实践[@problem_id:5159577]探讨了一个常见挑战：如何区分由模板DNA部分降解引起的信号衰减与真正的杂合变异。通过建立一个定量的数学模型，您将计算并比较这两种情况下预期的峰高比率模式，从而磨练您在解读复杂测序图谱时的诊断推理能力。", "problem": "在脱氧核糖核酸（DNA）的链终止法 Sanger 测序中，在某一检出碱基处测得的峰高，与在该位置以相应双脱氧核苷三磷酸（ddNTP）结束的链终止延伸产物的丰度成正比。考虑一个具有单核苷酸变异（SNV）的位点，其中一个等位基因是野生型，另一个是变异型。假设聚合酶链式反应（PCR）从两个等位基因都产生延伸产物，并且在 SNV 位置，与该 SNV 相关的两种核苷酸的终止概率和下游电泳信号标度是相同的。在对临床样本（如福尔马林固定石蜡包埋的组织）进行下游处理时，模板片段化可被建模为沿模板长度的泊松断裂过程：如果每核苷酸断裂率为 $\\lambda$，那么一个模板在长度为 $L$ 的连续区域内保持完整的概率由关于 $L$ 的指数生存函数给出。\n\n要求您基于这些基础，推导出在两种场景下，变异型与野生型峰高比随读长变化的预期模式：\n\n- 场景 A（部分模板降解）：变异型等位基因模板以每核苷酸 $\\lambda_{V} = 1.5 \\times 10^{-3}$ 的速率发生随机断裂，而野生型等位基因模板在整个扩增子上实际上是完整的（$\\lambda_{W} = 0$）。降解前，两种等位基因的可扩增模板的初始摩尔浓度相等。计算距离引物 $L \\in \\{120, 360, 720\\}$ 个核苷酸位置处的预期变异型与野生型峰高比。\n\n- 场景 B（无差异性降解的真正杂合）：两种等位基因在整个扩增子上同样完整，因此任何与长度相关的存活率或信号标度在等位基因之间是相同的。计算在相同位置 $L \\in \\{120, 360, 720\\}$ 处的预期变异型与野生型峰高比。\n\n将这六个比率（首先按 $L$ 升序排列场景 A 的值，然后按 $L$ 升序排列场景 B 的值）表示为小数，并将您的答案四舍五入到四位有效数字。最终答案必须以单个行向量的形式提供。", "solution": "该问题要求在两种模板降解场景下，推导 Sanger 测序中预期的变异型与野生型峰高比。推导过程遵循问题陈述中阐明的第一性原理。\n\n基本前提是，在给定核苷酸位置，特定等位基因的测量峰高 $H$ 与在该位置终止的 Sanger 延伸产物的丰度成正比。而该丰度又取决于在该位置之前结构上保持完整的初始模板分子的数量，这些模板分子允许聚合酶合成延伸产物。\n\n设 $N_{W,0}$ 和 $N_{V,0}$ 分别表示可扩增的野生型（W）和变异型（V）模板的初始摩尔浓度。问题陈述表明它们是相等的，因此我们可以将此初始浓度表示为 $N_0$。\n$N_{W,0} = N_{V,0} = N_0$。\n\n模板片段化被建模为具有每核苷酸断裂率 $\\lambda$ 的泊松断裂过程。一个模板分子从测序引物开始，在长度为 $L$（单位为核苷酸）的连续区域内保持完整的概率 $S(L)$ 由一个指数生存函数给出：\n$$S(L) = \\exp(-\\lambda L)$$\n对于给定的等位基因（W 或 V），能够成功延伸到长度 $L$ 的可用模板数量是初始模板数量与直到该长度的生存概率的乘积。\n$$N_W(L) = N_0 S_W(L) = N_0 \\exp(-\\lambda_W L)$$\n$$N_V(L) = N_0 S_V(L) = N_0 \\exp(-\\lambda_V L)$$\n其中 $\\lambda_W$ 和 $\\lambda_V$ 分别是野生型和变异型等位基因的每核苷酸断裂率。\n\n峰高 $H$ 与可用模板的数量成正比。设比例常数为 $k$。该常数包括 PCR 效率、终止概率和信号标度等因素。问题指明“与该 SNV 相关的两种核苷酸的终止概率和下游电泳信号标度是相同的”。这意味着在目标位置，常数 $k$ 对两个等位基因是相同的。\n$$H_W(L) = k N_W(L)$$\n$$H_V(L) = k N_V(L)$$\n因此，距离引物 $L$ 个核苷酸位置处的预期变异型与野生型峰高比 $R(L)$ 为：\n$$R(L) = \\frac{H_V(L)}{H_W(L)} = \\frac{k N_V(L)}{k N_W(L)} = \\frac{N_0 \\exp(-\\lambda_V L)}{N_0 \\exp(-\\lambda_W L)}$$\n常数 $k$ 和 $N_0$ 相消，得到峰高比的通用公式：\n$$R(L) = \\frac{\\exp(-\\lambda_V L)}{\\exp(-\\lambda_W L)} = \\exp(-(\\lambda_V - \\lambda_W)L)$$\n现在可以将此通用表达式应用于指定的两种场景。\n\n**场景 A：部分模板降解**\n在此场景中，变异型等位基因模板会发生降解，而野生型等位基因模板则不会。\n给定的参数是：\n$\\lambda_V = 1.5 \\times 10^{-3}$\n$\\lambda_W = 0$\n\n将这些值代入比率的通用公式 $R_A(L)$ 中：\n$$R_A(L) = \\exp(-(1.5 \\times 10^{-3} - 0)L) = \\exp(-1.5 \\times 10^{-3} L)$$\n我们需要计算当 $L \\in \\{120, 360, 720\\}$ 时该比率的值。\n\n对于 $L = 120$：\n$$R_A(120) = \\exp(-1.5 \\times 10^{-3} \\times 120) = \\exp(-0.18) \\approx 0.8352702$$\n四舍五入到四位有效数字，结果为 $0.8353$。\n\n对于 $L = 360$：\n$$R_A(360) = \\exp(-1.5 \\times 10^{-3} \\times 360) = \\exp(-0.54) \\approx 0.5827482$$\n四舍五入到四位有效数字，结果为 $0.5827$。\n\n对于 $L = 720$：\n$$R_A(720) = \\exp(-1.5 \\times 10^{-3} \\times 720) = \\exp(-1.08) \\approx 0.3395955$$\n四舍五入到四位有效数字，结果为 $0.3396$。\n\n场景 A 的结果显示，随着读长的增加，变异型等位基因信号相对于野生型信号发生衰减，这与差异性降解模型一致。\n\n**场景 B：无差异性降解的真正杂合**\n在此场景中，两种等位基因“同样完整”，意味着它们经历的降解（如果有的话）是相同的。这表示它们的每核苷酸断裂率相等。\n$$\\lambda_V = \\lambda_W$$\n让我们将这个共同的速率称为 $\\lambda_{\\text{common}}$。\n将此条件代入比率的通用公式 $R_B(L)$：\n$$R_B(L) = \\exp(-(\\lambda_V - \\lambda_W)L) = \\exp(-(\\lambda_{\\text{common}} - \\lambda_{\\text{common}})L) = \\exp(0 \\times L) = \\exp(0) = 1$$\n无论读长 $L$ 为何，该比率都恰好为 $1$。对于一个真正的杂合位点，在没有差异性模板降解或测量偏倚等混杂因素的情况下，这是预期的结果。\n因此，对于 $L \\in \\{120, 360, 720\\}$，比率始终为 $1$。表示为四位有效数字，该比率为 $1.000$。\n\n对于 $L = 120$：$R_B(120) = 1.000$\n对于 $L = 360$：$R_B(360) = 1.000$\n对于 $L = 720$：$R_B(720) = 1.000$\n\n最终答案是包含六个计算比率的行向量，按要求排序：首先是场景 A 在 $L \\in \\{120, 360, 720\\}$ 时的值，然后是场景 B 在 $L \\in \\{120, 360, 720\\}$ 时的值。\n这些值为 $\\{0.8353, 0.5827, 0.3396, 1.000, 1.000, 1.000\\}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8353  0.5827  0.3396  1.000  1.000  1.000\n\\end{pmatrix}\n}\n$$", "id": "5159577"}]}