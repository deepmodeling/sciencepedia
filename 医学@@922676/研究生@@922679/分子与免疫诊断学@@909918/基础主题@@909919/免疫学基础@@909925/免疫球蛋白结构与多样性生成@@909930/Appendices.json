{"hands_on_practices": [{"introduction": "免疫系统识别海量抗原的能力源于免疫球蛋白基因片段的遗传重排。本练习将带你探索这一过程的第一个层面：组合多样性 (combinatorial diversity)，即通过从有限的$V$、$D$和$J$种系基因库中进行选择，可以产生多少种独特的抗体 ([@problem_id:5123138])。通过这个基本计算，你将直观地感受到，在考虑其他多样性机制之前，我们的基因组是如何为庞大的抗体库奠定基础的。", "problem": "在免疫球蛋白(Ig)基因组装过程中，B淋巴细胞通过对种系基因片段进行体细胞重组来产生抗原受体的多样性。对于重链基因座，可变区($V$)、多样性区($D$)和连接区($J$)基因片段重组形成一个重链可变区；对于每个轻链基因座，只有可变区($V$)和连接区($J$)片段重组形成一个轻链可变区。考虑以下基本事实：\n\n- 体细胞重组由重组激活基因(RAG)蛋白介导，并遵循重组信号序列，在DNA水平上产生不同的片段选择组合。\n- 在此背景下，组合多样性指的是可以由可用的功能性基因片段形成的不同片段选择元组的总数，而不考虑连接多样化（例如，核苷酸的添加或删除）或任何形式的选择。\n- 一个表达的Ig由一条重组的重链与一条重组的轻链配对形成，其中轻链可以是kappa($\\kappa$)链或lambda($\\lambda$)链。假设重链-轻链的配对与特定的$V$、$D$和$J$选择无关，并且片段选择不限制后续的配对。\n\n现提供某物种功能性基因片段的数量，其种系构型如下：\n\n- 重链基因座：$V_{H} = 44$，$D_{H} = 23$，$J_{H} = 6$。\n- Kappa轻链基因座：$V_{\\kappa} = 34$，$J_{\\kappa} = 5$。\n- Lambda轻链基因座：$V_{\\lambda} = 30$，$J_{\\lambda} = 7$。\n\n在上述假设下，并将组合多样性严格定义为仅由片段选择决定的不同重链-轻链配对的数量，计算该系统中可以形成的所有可能的Ig特异性总数。请提供一个没有单位的精确整数作为最终答案。", "solution": "问题陈述已经过严格审查并被确定为有效。它在科学上基于分子免疫学的原理，特别是通过V(D)J重组产生免疫球蛋白多样性的机制。该问题设定良好，提供了计算唯一、有意义解所需的所有数据和明确定义的约束条件。它是客观的，没有任何不合理或含糊不清的前提。\n\n组合多样性的计算依赖于独立事件的基本计数原理（乘法法则）和互斥事件的加法法则。可能的免疫球蛋白特异性总数，记为$N_{\\text{Ig}}$，是不同重链数量($N_{H}$)与不同轻链总数($N_{L}$)的乘积。\n\n$N_{\\text{Ig}} = N_{H} \\times N_{L}$\n\n首先，我们计算可能的重链数量，$N_{H}$。重链可变区是由一个可变区($V_{H}$)、一个多样性区($D_{H}$)和一个连接区($J_{H}$)基因片段重组而成。每个片段的选择是独立的。可用的功能性基因片段数量如下：\n- $V_{H} = 44$\n- $D_{H} = 23$\n- $J_{H} = 6$\n\n使用乘法法则，不同重链的总数为：\n$$N_{H} = V_{H} \\times D_{H} \\times J_{H}$$\n$$N_{H} = 44 \\times 23 \\times 6$$\n$$N_{H} = 1012 \\times 6 = 6072$$\n因此，有$6072$种可能的重链组合。\n\n接下来，我们计算可能的轻链总数，$N_{L}$。一个免疫球蛋白可以有一条kappa($\\kappa$)轻链或一条lambda($\\lambda$)轻链。这些是互斥的可能性，因此我们分别计算每个基因座的组合数，然后将它们相加。\n\n对于kappa($\\kappa$)轻链基因座，可变区由一个$V_{\\kappa}$和一个$J_{\\kappa}$片段形成。可用的片段数量为：\n- $V_{\\kappa} = 34$\n- $J_{\\kappa} = 5$\n\n不同kappa轻链的数量，$N_{\\kappa}$，为：\n$$N_{\\kappa} = V_{\\kappa} \\times J_{\\kappa}$$\n$$N_{\\kappa} = 34 \\times 5 = 170$$\n\n对于lambda($\\lambda$)轻链基因座，可变区由一个$V_{\\lambda}$和一个$J_{\\lambda}$片段形成。可用的片段数量为：\n- $V_{\\lambda} = 30$\n- $J_{\\lambda} = 7$\n\n不同lambda轻链的数量，$N_{\\lambda}$，为：\n$$N_{\\lambda} = V_{\\lambda} \\times J_{\\lambda}$$\n$$N_{\\lambda} = 30 \\times 7 = 210$$\n\n可能的轻链总数，$N_{L}$，是kappa和lambda基因座可能性之和：\n$$N_{L} = N_{\\kappa} + N_{\\lambda}$$\n$$N_{L} = 170 + 210 = 380$$\n因此，有$380$种可能的轻链组合。\n\n最后，我们通过将可能的重链数量与可能的轻链数量相乘来计算可能的免疫球蛋白特异性总数，$N_{\\text{Ig}}$。这由问题陈述中重链-轻链配对与所选特定片段无关的假设来证明是合理的。\n$$N_{\\text{Ig}} = N_{H} \\times N_{L}$$\n$$N_{\\text{Ig}} = 6072 \\times 380$$\n$$N_{\\text{Ig}} = 2307360$$\n\n这个最终数字代表了仅由种系基因片段的不同组合产生的组合多样性，正如问题所规定的。", "answer": "$$\\boxed{2307360}$$", "id": "5123138"}, {"introduction": "组合多样性描绘了一个巨大的潜在抗体库，但$V(D)J$重组的连接过程并非精确无误，常伴随着随机的核苷酸插入或缺失。本练习将引导你思考这些连接区多样性 (junctional diversity) 对蛋白质翻译读码框的影响 ([@problem_id:5123069])。通过一个简化的概率模型，你将理解为何只有约三分之一的重链基因重排能够成功产生功能性蛋白，这揭示了 B 细胞发育中的一个关键筛选关卡。", "problem": "在免疫球蛋白重链 (IGH) 基因座中，可变区编码序列通过$V(D)J$重组进行组装，其中可变 (V)、多样性 (D) 和连接 (J) 基因片段连接形成一个 V-D-J 外显子。翻译起始于 V 片段内保守的起始密码子，从而建立一个以三联体为单位的密码子阅读框。在重组过程中，通过核酸外切酶修剪以及 Terminal deoxynucleotidyl transferase (TdT) 在 V-D 和 D-J 连接处进行的非模板核苷酸添加，会改变每个连接处的核苷酸数量。这些连接处的加工事件可能会导致翻译阅读框发生移位。假设以下条件成立：\n- 每个连接处的核苷酸净变化（插入数减去缺失数）模 $3$ 的余数为 $0$、$1$ 或 $2$ 的概率相等。\n- V-D 和 D-J 连接处模 $3$ 的余数是相互独立的。\n- V 和 J 编码片段内部是同框的，且翻译在 V 处同框起始；D 片段除了保证跨连接处的阅读框连续性外，不施加额外的约束。\n- 一个组装好的 V-D-J 外显子能够产生同框编码序列，当且仅当两个连接处引入的总阅读框移位模 $3$ 同余于 $0$。\n\n在这些假设下，计算一个随机生成的 IGH $V-D-J$重组事件是同框的（即，从 V 经过 D 到 J 保持阅读框）概率。请将您的答案表示为一个精确分数。无需四舍五入，也无需单位。", "solution": "问题陈述已经过严格验证，被认为是有效的。它以分子免疫学原理，特别是 V(D)J 重组为科学基础，提出了一个在概率论中适定、客观且可解的问题。所提供的假设清晰、一致，足以推导出唯一解。\n\n问题要求在给定一系列关于连接处修饰随机性的假设下，计算 V-D-J 重组事件产生同框编码序列的概率。一个同框序列要求在 V-D 和 D-J 两个连接处增加或删除的核苷酸总数是 $3$ 的倍数。\n\n令 $S_{VD}$ 表示在 V-D 连接处改变的核苷酸净数量（插入数减去缺失数）。\n令 $S_{DJ}$ 表示在 D-J 连接处改变的核苷酸净数量。\n\n从 V 片段经过 D 片段到 J 片段的翻译阅读框得以保持，当且仅当总核苷酸变化量 $S_{VD} + S_{DJ}$ 可被 $3$ 整除。这可以用模运算来表示。令 $R_{VD}$ 和 $R_{DJ}$ 分别是 $S_{VD}$ 和 $S_{DJ}$ 除以 $3$ 的余数。\n$$R_{VD} = S_{VD} \\pmod 3$$\n$$R_{DJ} = S_{DJ} \\pmod 3$$\n这些变量 $R_{VD}$ 和 $R_{DJ}$ 代表在每个连接处引入的阅读框移位。它们可以在集合 $\\{0, 1, 2\\}$ 中取值。值为 $0$ 对应于没有阅读框移位，而值 $1$ 和 $2$ 分别对应于 $+1$ 和 $+2$ 个核苷酸的移位。\n\n最终的 V-D-J 外显子是同框的条件是，各个阅读框移位之和模 $3$ 同余于 $0$：\n$$(R_{VD} + R_{DJ}) \\equiv 0 \\pmod 3$$\n\n问题提供了几个关键假设来对此过程进行概率建模：\n1.  每个连接处的核苷酸净变化，在模 $3$ 的意义下，取值为 $0$、$1$ 或 $2$ 的概率相等。这意味着 $R_{VD}$ 和 $R_{DJ}$ 是在集合 $\\{0, 1, 2\\}$ 上服从均匀概率分布的离散随机变量。\n    $$P(R_{VD} = k) = \\frac{1}{3} \\quad \\text{for } k \\in \\{0, 1, 2\\}$$\n    $$P(R_{DJ} = k) = \\frac{1}{3} \\quad \\text{for } k \\in \\{0, 1, 2\\}$$\n\n2.  V-D 和 D-J 连接处的阅读框移位是独立事件。因此，对于 $(R_{VD}, R_{DJ})$ 的任何一对结果 $(i, j)$，其联合概率是它们各自概率的乘积：\n    $$P(R_{VD}=i, R_{DJ}=j) = P(R_{VD}=i) \\times P(R_{DJ}=j)$$\n    对于任何一对 $(i, j)$，其中 $i, j \\in \\{0, 1, 2\\}$，这个概率是：\n    $$P(R_{VD}=i, R_{DJ}=j) = \\frac{1}{3} \\times \\frac{1}{3} = \\frac{1}{9}$$\n    样本空间由 $3 \\times 3 = 9$ 个等可能的结果组成，对应于阅读框移位对 $(R_{VD}, R_{DJ})$。\n\n我们需要找到所有满足同框条件 $(i + j) \\equiv 0 \\pmod 3$ 的结果 $(i, j)$ 的总概率。我们可以枚举这些有利结果：\n- 如果 $R_{VD} = 0$，那么为了使和是 $3$ 的倍数，我们必须有 $R_{DJ} = 0$。这给出了对 $(0, 0)$。\n- 如果 $R_{VD} = 1$，那么为了使和是 $3$ 的倍数，我们必须有 $R_{DJ} = 2$，因为 $1 + 2 = 3 \\equiv 0 \\pmod 3$。这给出了对 $(1, 2)$。\n- 如果 $R_{VD} = 2$，那么为了使和是 $3$ 的倍数，我们必须有 $R_{DJ} = 1$，因为 $2 + 1 = 3 \\equiv 0 \\pmod 3$。这给出了对 $(2, 1)$。\n\n这三对阅读框移位是唯一能产生有功能的、同框的 V-D-J 外显子的组合。“同框”事件是与这三对组合相对应的事件的不相交并集：\n$$ \\text{同框} = \\{ (R_{VD}, R_{DJ}) = (0,0) \\} \\cup \\{ (R_{VD}, R_{DJ}) = (1,2) \\} \\cup \\{ (R_{VD}, R_{DJ}) = (2,1) \\} $$\n\n同框重组的总概率是这些互斥结果的概率之和：\n$$ P(\\text{同框}) = P(R_{VD}=0, R_{DJ}=0) + P(R_{VD}=1, R_{DJ}=2) + P(R_{VD}=2, R_{DJ}=1) $$\n代入每对的概率：\n$$ P(\\text{同框}) = \\frac{1}{9} + \\frac{1}{9} + \\frac{1}{9} = \\frac{3}{9} $$\n化简该分数得到最终概率：\n$$ P(\\text{同框}) = \\frac{1}{3} $$\n因此，在给定假设下，预计在免疫球蛋白重链基因座的所有 V(D)J 重组事件中，有三分之一在保持翻译阅读框方面是有功能的。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "5123069"}, {"introduction": "成功的基因重排产生了功能性抗体链后，它们会组装成完整的免疫球蛋白分子，其结构，特别是像五聚体 IgM 这样的大分子，直接影响其抗原结合能力。本练习将区分理论价 (theoretical valency)，即总结合位点数，与功能价 (functional valency)，即实际可用结合位点数这两个重要概念 ([@problem_id:5123114])。通过为一个五聚体 IgM 分子建立概率模型，你将量化分子结构如何对生物学功能施加物理限制，从而连接起分子遗传学与免疫应答的生物物理现实。", "problem": "一种由一条连接链（J链）稳定的五聚体免疫球蛋白M（IgM）分子由 $5$ 个相同的单体亚基组成，每个亚基具有 $2$ 个抗原结合片段（$Fab$）臂。在没有几何或构象限制的理想条件下，理论抗原结合价定义为可用于结合的独立$Fab$互补位（paratopes）的总数。在与分子和免疫诊断相关的实际条件下，空间位阻和构象限制会阻止某些$Fab$被同时占据。\n\n考虑以下针对具有一条J链的单个五聚体IgM的结构驱动的概率模型：\n\n- 总共有 $5$ 个单体，共计 $10$ 个$Fab$。\n- J链共价连接在一个界面上，其局部结构影响与另外三个单体相比，降低了与J链相邻的两个单体的$Fab$可及性，并增加了它们的构象限制。\n- 对于不与J链相邻的三个单体中的每一个，每个$Fab$以独立概率 $p = 0.92$ 具有空间可及性。在给定单体的两个$Fab$均可及的条件下，一个构象限制会以概率 $h = 0.35$ 阻止两个$Fab$被同时占据；如果此限制不适用（概率为 $1 - h$），则两个可及的$Fab$都可以被占据。\n- 对于与J链相邻的两个单体中的每一个，每个$Fab$以独立概率 $p_{J} = 0.78$ 具有空间可及性。在给定J链相邻单体的两个$Fab$均可及的条件下，一个构象限制会以概率 $h_{J} = 0.65$ 阻止两个$Fab$被同时占据；如果此限制不适用（概率为 $1 - h_{J}$），则两个可及的$Fab$都可以被占据。\n- 不同$Fab$之间的可及性事件是独立的，除了由 $h$ 或 $h_{J}$ 捕捉的单体内耦合（仅当两个$Fab$均可及才起作用），并且限制事件与可及性无关。\n\n假设一种小分子单价抗原处于饱和浓度，其尺寸足够小，以至于与一个$Fab$的结合不会在上述限制之外机械地阻碍非相邻的$Fab$。将功能价 $V_{f}$ 定义为在这些约束条件下同时被占据的$Fab$的期望数量。\n\n从免疫球蛋白结构和价的核心定义出发，计算理论价 $V_{t}$，并根据上述模型推导出 $V_{f}$ 的封闭形式表达式。使用给定参数对 $V_{f}$ 进行数值评估。将最终报告的 $V_{f}$ 值四舍五入到四位有效数字。将价表示为无量纲量。", "solution": "该问题要求计算与五聚体免疫球蛋白M（IgM）分子的抗原结合能力相关的两个量：理论价 $V_{t}$ 和功能价 $V_{f}$。\n\n首先，我们对问题陈述进行验证。\n该问题基于已确立的五聚体IgM的结构，该结构由通过J链连接的 $5$ 个单体亚基组成。每个单体拥有 $2$ 个抗原结合片段（$Fab$s）。该模型引入了空间和构象限制，从而降低了结合能力，这个概念被称为空间位阻，是生物化学和免疫学中的一个基本原理。该问题被表述为一个期望值的概率计算，提供了所有必要的参数和清晰的定义。概率值（$p = 0.92$, $p_J = 0.78$, $h = 0.35$, $h_J = 0.65$）都在有效范围 $[0, 1]$ 内。该问题具有科学依据，提法恰当且客观。它不违反任何基本原理，并且可以直接形式化和求解。因此，该问题被认为是有效的。\n\n第1部分：理论价 ($V_{t}$)\n\n理论价 $V_{t}$ 定义为在理想条件下（即没有几何或构象限制）可用于结合的独立$Fab$互补位（paratopes）的总数。五聚体IgM分子由 $5$ 个单体亚基组成，每个亚基有 $2$ 个$Fab$臂。\n因此，$Fab$臂的总数是单体数量与每个单体$Fab$数量的乘积。\n$$V_{t} = (\\text{单体数量}) \\times (\\text{每个单体的Fab数量})$$\n$$V_{t} = 5 \\times 2 = 10$$\n所以，理论价为 $10$。\n\n第2部分：功能价 ($V_{f}$)\n\n功能价 $V_{f}$ 定义为在指定的概率约束下同时被占据的$Fab$的期望数量。我们可以利用期望的线性性质来计算它。被占据$Fab$的总期望数是 $5$ 个单体中每一个被占据$Fab$的期望数之和。\n根据与J链的邻近性，单体被分为两个不同的组：\n1. 一组 $N_{std} = 3$ 个标准单体，不与J链相邻。\n2. 一组 $N_{J} = 2$ 个与J链相邻的单体。\n\n设 $E_{std}$ 为单个标准单体上被占据$Fab$的期望数量，设 $E_{J}$ 为单个J链相邻单体上被占据$Fab$的期望数量。那么总功能价 $V_f$ 由下式给出：\n$$V_{f} = N_{std} \\cdot E_{std} + N_{J} \\cdot E_{J} = 3 \\cdot E_{std} + 2 \\cdot E_{J}$$\n\n$E_{std}$ 的计算：\n对于单个标准单体，有 $2$ 个$Fab$。单个$Fab$可及的概率为 $p = 0.92$。一个单体上两个$Fab$的可及性事件是独立的。让我们根据可及$Fab$的数量来分析被占据$Fab$的数量。\n设 $N_{A, std}$ 为标准单体上可及$Fab$的数量。\n- 情况1：$N_{A, std} = 0$。两个$Fab$都不可及。其概率为 $(1-p)(1-p) = (1-p)^2$。被占据$Fab$的数量为 $0$。\n- 情况2：$N_{A, std} = 1$。一个$Fab$可及，另一个不可及。其概率为 $p(1-p) + (1-p)p = 2p(1-p)$。由于抗原处于饱和浓度，这个唯一可及的$Fab$将被占据。被占据$Fab$的数量为 $1$。\n- 情况3：$N_{A, std} = 2$。两个$Fab$都可及。其概率为 $p \\cdot p = p^2$。在这种情况下，可能会有构象限制。\n    - 以概率 $h = 0.35$，该限制适用，“阻止两个$Fab$被同时占据”。在饱和抗原的背景下，这被解释为两个可及$Fab$中恰好有一个被占据。\n    - 以概率 $1-h$，该限制不适用，两个$Fab$都可以被占据。被占据$Fab$的数量为 $2$。\n在两个$Fab$均可及的条件下，被占据$Fab$的期望数量是 $1 \\cdot h + 2 \\cdot (1-h) = h + 2 - 2h = 2-h$。\n\n标准单体上被占据$Fab$的期望数量 $E_{std}$ 是每种情况下被占据$Fab$数量与该情况发生概率的乘积之和：\n$$E_{std} = 0 \\cdot (1-p)^2 + 1 \\cdot [2p(1-p)] + (2-h) \\cdot p^2$$\n$$E_{std} = 2p - 2p^2 + 2p^2 - hp^2$$\n$$E_{std} = 2p - hp^2 = p(2 - hp)$$\n\n$E_{J}$ 的计算：\n对于J链相邻单体的逻辑是相同的，但参数为 $p_J = 0.78$ 和 $h_J = 0.65$。\n$$E_{J} = p_J(2 - h_J p_J)$$\n\n组合求 $V_{f}$：\n功能价 $V_f$ 的封闭形式表达式为：\n$$V_{f} = 3 \\cdot E_{std} + 2 \\cdot E_{J} = 3p(2 - hp) + 2p_J(2 - h_J p_J)$$\n\n$V_{f}$ 的数值评估：\n我们代入给定值：$p = 0.92$，$h = 0.35$，$p_J = 0.78$ 和 $h_J = 0.65$。\n\n首先，我们计算 $E_{std}$：\n$$E_{std} = 0.92 \\times (2 - 0.35 \\times 0.92)$$\n$$E_{std} = 0.92 \\times (2 - 0.322) = 0.92 \\times 1.678 = 1.54376$$\n\n接下来，我们计算 $E_{J}$：\n$$E_{J} = 0.78 \\times (2 - 0.65 \\times 0.78)$$\n$$E_{J} = 0.78 \\times (2 - 0.507) = 0.78 \\times 1.493 = 1.16454$$\n\n最后，我们计算 $V_{f}$：\n$$V_{f} = 3 \\times E_{std} + 2 \\times E_{J}$$\n$$V_{f} = 3 \\times 1.54376 + 2 \\times 1.16454$$\n$$V_{f} = 4.63128 + 2.32908 = 6.96036$$\n\n问题要求将 $V_f$ 的最终值四舍五入到四位有效数字。\n$$V_{f} \\approx 6.960$$\n\n总之，理论价 $V_t$ 为 $10$。从概率模型推导出的功能价 $V_f$ 的封闭形式表达式为 $V_f = 3p(2-hp) + 2p_J(2-h_J p_J)$，其计算值约为 $6.960$。", "answer": "$$\n\\boxed{6.960}\n$$", "id": "5123114"}]}