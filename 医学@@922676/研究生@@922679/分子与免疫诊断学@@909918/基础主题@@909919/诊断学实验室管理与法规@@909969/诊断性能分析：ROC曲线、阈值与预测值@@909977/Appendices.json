{"hands_on_practices": [{"introduction": "理论与实践的结合始于对基本原理的深刻理解。本练习将引导您从贝叶斯定理等第一性原理出发，推导并计算阳性预测值（$PPV$）和阴性预测值（$NPV$）。通过分析一个在低患病率人群中应用的分子诊断检测，您将亲自验证并解释一个关键概念：在筛查应用中，提高特异性为何通常比提高同等幅度的灵敏度能更有效地提升阳性预测值[@problem_id:5105285]。", "problem": "一种传染病的定量聚合酶链反应 (qPCR) 检测方法被用于监测环境，其检验前概率（解释为受检人群中的患病率）很小。该检测方法在其受试者工作特征 (ROC) 曲线上的工作点由一个循环阈值控制，该阈值用于权衡灵敏度与特异度。\n\n一个实验室报告了该 qPCR 检测方法应用于疾病先验概率为 $\\,\\pi = 0.02\\,$ 的人群队列时的基线工作特性：灵敏度 $\\,\\mathrm{Se} = 0.95\\,$，特异度 $\\,\\mathrm{Sp} = 0.97\\,$。考虑了两种备选的阈值调整方案：\n- 提升灵敏度的调整，得到 $\\,\\mathrm{Se}_{1} = 0.97\\,$，而 $\\,\\mathrm{Sp}\\,$ 保持不变。\n- 提升特异度的调整，得到 $\\,\\mathrm{Sp}_{1} = 0.99\\,$，而 $\\,\\mathrm{Se}\\,$ 保持不变。\n\n仅从灵敏度 $\\,\\mathrm{Se} = \\mathbb{P}(\\text{检验阳性}\\mid \\text{患病})\\,$、特异度 $\\,\\mathrm{Sp} = \\mathbb{P}(\\text{检验阴性}\\mid \\text{未患病})\\,$、先验概率 $\\,\\pi = \\mathbb{P}(\\text{患病})\\,$ 的基本定义，以及全概率定律和贝叶斯定理出发，完成以下任务：\n\n1. 推导阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式，其中 $\\,\\mathrm{PPV} = \\mathbb{P}(\\text{患病}\\mid \\text{检验阳性})\\,$ 且 $\\,\\mathrm{NPV} = \\mathbb{P}(\\text{未患病}\\mid \\text{检验阴性})\\,$，用 $\\,\\pi\\,$, $\\,\\mathrm{Se}\\,$ 和 $\\,\\mathrm{Sp}\\,$ 表示。然后，根据给定的 $\\,\\pi\\,$, $\\,\\mathrm{Se}\\,$ 和 $\\,\\mathrm{Sp}\\,$ 计算基线 $\\,\\mathrm{PPV}\\,$ 和 $\\,\\mathrm{NPV}\\,$。\n2. 计算提升灵敏度调整后和提升特异度调整后的 $\\,\\mathrm{PPV}\\,$。利用这些结果确定每种调整方案下 $\\,\\mathrm{PPV}\\,$ 相对于基线的变化量。\n3. 在基线工作点进行第一性原理灵敏度分析，从解析上证明为什么在 $\\,\\pi\\,$ 很小的情况下，提高特异度比提高灵敏度对 $\\,\\mathrm{PPV}\\,$ 的影响更大。\n4. 设 $\\,\\Delta_{\\text{sens}}\\,$ 表示提升灵敏度调整下 $\\,\\mathrm{PPV}\\,$ 的变化量，$\\,\\Delta_{\\text{spec}}\\,$ 表示提升特异度调整下 $\\,\\mathrm{PPV}\\,$ 的变化量。计算单一量 $\\,\\Delta_{\\text{spec}} - \\Delta_{\\text{sens}}\\,$.\n\n将最终量 $\\,\\Delta_{\\text{spec}} - \\Delta_{\\text{sens}}\\,$ 表示为四舍五入到四位有效数字的小数。在你的工作中不要使用百分号。", "solution": "所述问题具有科学依据，提法恰当，内部一致且客观。它提出了一个基于概率论基本原理的诊断测试评估标准问题。所有需要的数据和定义均已提供。该问题是有效的。\n\n设 $D$ 为受试者患病的事件，$D^c$ 为受试者未患病的事件。设 $T+$ 为检验结果为阳性的事件，$T-$ 为检验结果为阴性的事件。\n给定的条件可以正式表示为：\n- 疾病的先验概率（患病率）：$\\pi = \\mathbb{P}(D) = 0.02$\n- 基线灵敏度：$\\mathrm{Se} = \\mathbb{P}(T+ \\mid D) = 0.95$\n- 基线特异度：$\\mathrm{Sp} = \\mathbb{P}(T- \\mid D^c) = 0.97$\n由此，我们可以得出互补概率：\n- $\\mathbb{P}(D^c) = 1 - \\pi = 1 - 0.02 = 0.98$\n- 假阴性率：$\\mathbb{P}(T- \\mid D) = 1 - \\mathrm{Se} = 1 - 0.95 = 0.05$\n- 假阳性率：$\\mathbb{P}(T+ \\mid D^c) = 1 - \\mathrm{Sp} = 1 - 0.97 = 0.03$\n\n**1. 基线预测值的推导与计算**\n\n阳性预测值 ($\\mathrm{PPV}$) 是在检验结果为阳性的条件下患有该疾病的概率，即 $\\mathbb{P}(D \\mid T+)$.\n使用贝叶斯定理：\n$$ \\mathrm{PPV} = \\mathbb{P}(D \\mid T+) = \\frac{\\mathbb{P}(T+ \\mid D)\\mathbb{P}(D)}{\\mathbb{P}(T+)} $$\n分母 $\\mathbb{P}(T+)$ 是检验结果为阳性的总概率，可使用全概率定律求得：\n$$ \\mathbb{P}(T+) = \\mathbb{P}(T+ \\mid D)\\mathbb{P}(D) + \\mathbb{P}(T+ \\mid D^c)\\mathbb{P}(D^c) $$\n代入 $\\pi$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 的定义：\n$$ \\mathbb{P}(T+) = (\\mathrm{Se})(\\pi) + (1 - \\mathrm{Sp})(1 - \\pi) $$\n因此，$\\mathrm{PPV}$ 的通用表达式为：\n$$ \\mathrm{PPV} = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})(1 - \\pi)} $$\n阴性预测值 ($\\mathrm{NPV}$) 是在检验结果为阴性的条件下未患该疾病的概率，即 $\\mathbb{P}(D^c \\mid T-)$.\n使用贝叶斯定理：\n$$ \\mathrm{NPV} = \\mathbb{P}(D^c \\mid T-) = \\frac{\\mathbb{P}(T- \\mid D^c)\\mathbb{P}(D^c)}{\\mathbb{P}(T-)} $$\n分母 $\\mathbb{P}(T-)$ 是检验结果为阴性的总概率，同样由全概率定律得出：\n$$ \\mathbb{P}(T-) = \\mathbb{P}(T- \\mid D^c)\\mathbb{P}(D^c) + \\mathbb{P}(T- \\mid D)\\mathbb{P}(D) = (\\mathrm{Sp})(1 - \\pi) + (1 - \\mathrm{Se})(\\pi) $$\n因此，$\\mathrm{NPV}$ 的通用表达式为：\n$$ \\mathrm{NPV} = \\frac{\\mathrm{Sp} \\cdot (1 - \\pi)}{\\mathrm{Sp} \\cdot (1 - \\pi) + (1 - \\mathrm{Se})\\pi} $$\n现在，我们使用 $\\pi = 0.02$、$\\mathrm{Se} = 0.95$ 和 $\\mathrm{Sp} = 0.97$ 计算基线值 ($\\mathrm{PPV}_{\\text{base}}$, $\\mathrm{NPV}_{\\text{base}}$)：\n$$ \\mathrm{PPV}_{\\text{base}} = \\frac{0.95 \\cdot 0.02}{0.95 \\cdot 0.02 + (1 - 0.97)(1 - 0.02)} = \\frac{0.019}{0.019 + (0.03)(0.98)} = \\frac{0.019}{0.019 + 0.0294} = \\frac{0.019}{0.0484} = \\frac{95}{242} \\approx 0.39256 $$\n$$ \\mathrm{NPV}_{\\text{base}} = \\frac{0.97 \\cdot (1-0.02)}{0.97 \\cdot (1-0.02) + (1 - 0.95) \\cdot 0.02} = \\frac{0.97 \\cdot 0.98}{0.97 \\cdot 0.98 + 0.05 \\cdot 0.02} = \\frac{0.9506}{0.9506 + 0.001} = \\frac{0.9506}{0.9516} = \\frac{4753}{4758} \\approx 0.99895 $$\n\n**2. 调整后 PPV 的计算**\n\n提升灵敏度的调整：$\\mathrm{Se}_{1} = 0.97$，$\\mathrm{Sp}$ 保持 $0.97$ 不变。\n$$ \\mathrm{PPV}_{\\text{sens}} = \\frac{0.97 \\cdot 0.02}{0.97 \\cdot 0.02 + (1 - 0.97)(1 - 0.02)} = \\frac{0.0194}{0.0194 + (0.03)(0.98)} = \\frac{0.0194}{0.0194 + 0.0294} = \\frac{0.0194}{0.0488} = \\frac{97}{244} \\approx 0.39754 $$\n$\\mathrm{PPV}$ 的变化量为 $\\Delta_{\\text{sens}}$：\n$$ \\Delta_{\\text{sens}} = \\mathrm{PPV}_{\\text{sens}} - \\mathrm{PPV}_{\\text{base}} = \\frac{97}{244} - \\frac{95}{242} \\approx 0.39754 - 0.39256 = 0.00498 $$\n提升特异度的调整：$\\mathrm{Sp}_{1} = 0.99$，$\\mathrm{Se}$ 保持 $0.95$ 不变。\n$$ \\mathrm{PPV}_{\\text{spec}} = \\frac{0.95 \\cdot 0.02}{0.95 \\cdot 0.02 + (1 - 0.99)(1 - 0.02)} = \\frac{0.019}{0.019 + (0.01)(0.98)} = \\frac{0.019}{0.019 + 0.0098} = \\frac{0.019}{0.0288} = \\frac{95}{144} \\approx 0.65972 $$\n$\\mathrm{PPV}$ 的变化量为 $\\Delta_{\\text{spec}}$：\n$$ \\Delta_{\\text{spec}} = \\mathrm{PPV}_{\\text{spec}} - \\mathrm{PPV}_{\\text{base}} = \\frac{95}{144} - \\frac{95}{242} \\approx 0.65972 - 0.39256 = 0.26716 $$\n\n**3. PPV 灵敏度的解析证明**\n\n为了理解灵敏度和特异度的变化对 $\\mathrm{PPV}$ 的相对影响，我们分析 $\\mathrm{PPV}$ 函数关于 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 的偏导数。\n$$ \\mathrm{PPV}(\\mathrm{Se}, \\mathrm{Sp}, \\pi) = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})(1 - \\pi)} $$\n关于 $\\mathrm{Se}$ 的偏导数为：\n$$ \\frac{\\partial \\mathrm{PPV}}{\\partial \\mathrm{Se}} = \\frac{\\pi (\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})(1 - \\pi)) - (\\mathrm{Se} \\cdot \\pi)(\\pi)}{(\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})(1 - \\pi))^2} = \\frac{\\pi(1 - \\mathrm{Sp})(1 - \\pi)}{(\\text{分母})^2} $$\n关于 $\\mathrm{Sp}$ 的偏导数为：\n$$ \\frac{\\partial \\mathrm{PPV}}{\\partial \\mathrm{Sp}} = \\frac{0 - (\\mathrm{Se} \\cdot \\pi)(-(1 - \\pi))}{(\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})(1 - \\pi))^2} = \\frac{\\mathrm{Se} \\cdot \\pi(1 - \\pi)}{(\\text{分母})^2} $$\n两个导数都为正，这符合预期。为了比较它们的大小，我们取其比值：\n$$ \\frac{\\partial \\mathrm{PPV} / \\partial \\mathrm{Sp}}{\\partial \\mathrm{PPV} / \\partial \\mathrm{Se}} = \\frac{\\mathrm{Se} \\cdot \\pi(1 - \\pi)}{\\pi(1 - \\mathrm{Sp})(1 - \\pi)} = \\frac{\\mathrm{Se}}{1 - \\mathrm{Sp}} $$\n该比值表示 $\\mathrm{PPV}$ 对 $\\mathrm{Sp}$ 变化的敏感度是其对相同大小的 $\\mathrm{Se}$ 变化敏感度的多少倍。在基线工作点（$\\mathrm{Se}=0.95$, $\\mathrm{Sp}=0.97$），该比值为：\n$$ \\frac{0.95}{1 - 0.97} = \\frac{0.95}{0.03} \\approx 31.67 $$\n这个很大的值表明 $\\mathrm{PPV}$ 对特异度的变化的敏感度远超对灵敏度的变化的敏感度。特异度影响更大的条件是 $\\mathrm{Se} / (1-\\mathrm{Sp})  1$，可简化为 $\\mathrm{Se} + \\mathrm{Sp}  1$。此条件，即 Youden 指数为正，对任何有诊断价值的检验都成立。此外，在低患病率 ($\\pi \\ll 1$) 的情况下，$\\mathrm{PPV}$ 的公式可以近似为：\n$$ \\mathrm{PPV} \\approx \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})} $$\n当 $\\pi \\to 0$ 时，分母中的 $\\mathrm{Se} \\cdot \\pi$ 项与假阳性率项 $(1-\\mathrm{Sp})$ 相比变得可以忽略不计。$\\mathrm{PPV}$ 变得主要由真阳性与假阳性的比率决定。本已很小的 $(1-\\mathrm{Sp})$ 项的微小变化会在分母中产生较大的相对变化，从而导致 $\\mathrm{PPV}$ 的巨大变化。提议的改变量 $\\Delta \\mathrm{Se} = 0.02$ 和 $\\Delta \\mathrm{Sp} = 0.02$ 是相同的，但对 $\\mathrm{Sp}$ 的高得多的敏感度保证了提升特异度的调整将对 $\\mathrm{PPV}$ 产生更大的影响。\n\n**4. $\\Delta_{\\text{spec}} - \\Delta_{\\text{sens}}$ 的计算**\n\n我们需要计算 $\\Delta_{\\text{spec}} - \\Delta_{\\text{sens}}$。使用第 2 部分的结果，可以将其简化：\n$$ \\Delta_{\\text{spec}} - \\Delta_{\\text{sens}} = (\\mathrm{PPV}_{\\text{spec}} - \\mathrm{PPV}_{\\text{base}}) - (\\mathrm{PPV}_{\\text{sens}} - \\mathrm{PPV}_{\\text{base}}) = \\mathrm{PPV}_{\\text{spec}} - \\mathrm{PPV}_{\\text{sens}} $$\n使用前面计算的精确分数形式：\n$$ \\Delta_{\\text{spec}} - \\Delta_{\\text{sens}} = \\frac{95}{144} - \\frac{97}{244} $$\n为了进行分数减法，我们找到一个公分母。$144 = 2^4 \\cdot 3^2$ 和 $244 = 2^2 \\cdot 61$ 的最小公倍数是 $\\mathrm{LCM}(144, 244) = 2^4 \\cdot 3^2 \\cdot 61 = 8784$。\n$$ \\frac{95}{144} - \\frac{97}{244} = \\frac{95 \\cdot (8784/144)}{8784} - \\frac{97 \\cdot (8784/244)}{8784} = \\frac{95 \\cdot 61}{8784} - \\frac{97 \\cdot 36}{8784} $$\n$$ = \\frac{5795 - 3492}{8784} = \\frac{2303}{8784} $$\n现在，我们将这个精确分数转换为小数，并四舍五入到四位有效数字：\n$$ \\frac{2303}{8784} \\approx 0.262181238... $$\n前四位有效数字是 $2$、$6$、$2$ 和 $1$。第五位数字是 $8$，所以我们将第四位数字向上取整。\n$$ 0.2622 $$", "answer": "$$\\boxed{0.2622}$$", "id": "5105285"}, {"introduction": "在真实的诊断场景中，检测结果并非总是非黑即白。本练习将带您直面“不确定”或“灰区”结果这一常见挑战，这是一个在已发表的诊断研究中普遍存在但处理方法各异的问题。通过处理一个包含不确定结果的实际数据集，您将量化比较两种不同分析策略——将不确定结果视为阴性或直接排除——对$PPV$和$NPV$的影响，并深入理解这些选择如何引入偏倚[@problem_id:5105209]。这项实践对于批判性地评估和解读诊断文献至关重要。", "problem": "一个高通量免疫诊断实验室用于病原体检测的分子扩增分析采用了一种基于循环阈值比值的接收者操作特征（ROC）曲线分析的灰区策略：结果高于选定的决策阈值则报告为阳性，低于一个下限则报告为阴性，介于两个界限之间则为不确定。所有参与者都有可用的参考标准，并且疾病状态已得到完全验证。\n\n在一个包含$1{,}500$名连续检测个体的队列中，分析结果与参考标准的联合分布如下：在参考标准为疾病阳性（$D^{+}$）的个体中，$240$人检测为阳性，$120$人检测为阴性，$60$人为不确定；在参考标准为疾病阴性（$D^{-}$）的个体中，$90$人检测为阳性，$960$人检测为阴性，$30$人为不确定。\n\n要求您从条件概率的基本定义出发，评估两种处理不确定类别的方法对阳性预测值（PPV）和阴性预测值（NPV）的影响。考虑以下两种分析方法：\n- 方法$\\mathrm{A}$（将不确定结果视为阴性）：在计算预测值之前，将所有不确定结果归类为阴性。\n- 方法$\\mathrm{B}$（排除不确定结果）：在计算预测值之前，从分析中排除所有不确定结果。\n\n使用第一性原理计算：\n1. 方法$\\mathrm{A}$下的$PPV$和$NPV$。\n2. 方法$\\mathrm{B}$下的$PPV$和$NPV$。\n3. $PPV$和$NPV$的变化量，定义为 $\\Delta PPV = PPV_{\\mathrm{A}} - PPV_{\\mathrm{B}}$ 和 $\\Delta NPV = NPV_{\\mathrm{A}} - NPV_{\\mathrm{B}}$。\n\n将您的最终答案以精确分数的形式表示为一个行向量 $\\left(PPV_{\\mathrm{A}},\\,NPV_{\\mathrm{A}},\\,PPV_{\\mathrm{B}},\\,NPV_{\\mathrm{B}},\\,\\Delta PPV,\\,\\Delta NPV\\right)$。不要使用百分号；以分数或小数表示数值。无需四舍五入。最后，解释将不确定结果视为阴性相对于排除它们所引入的偏倚方向，说明$PPV$和$NPV$如何受到影响及其原因，并将您的解释建立在$PPV$和$NPV$固有的条件化基础上。", "solution": "首先验证问题，确保其科学合理、信息自洽且提问明确。\n\n### 步骤 1：提取已知信息\n- 队列总人数：$N = 1,500$\n- 疾病阳性（$D^{+}$）个体数据：\n  - 检测阳性（$T^{+}$）：$240$\n  - 检测阴性（$T^{-}$）：$120$\n  - 检测不确定（$T^{ind}$）：$60$\n- 疾病阴性（$D^{-}$）个体数据：\n  - 检测阳性（$T^{+}$）：$90$\n  - 检测阴性（$T^{-}$）：$960$\n  - 检测不确定（$T^{ind}$）：$30$\n- 方法$\\mathrm{A}$：将不确定结果归类为阴性。\n- 方法$\\mathrm{B}$：从分析中排除不确定结果。\n- 需要计算：$PPV_{\\mathrm{A}}$、$NPV_{\\mathrm{A}}$、$PPV_{\\mathrm{B}}$、$NPV_{\\mathrm{B}}$、$\\Delta PPV = PPV_{\\mathrm{A}} - PPV_{\\mathrm{B}}$、$\\Delta NPV = NPV_{\\mathrm{A}} - NPV_{\\mathrm{B}}$。\n\n### 步骤 2：使用提取的信息进行验证\n该问题在科学上基于诊断测试评估领域，这是免疫诊断学的核心课题。所有术语如PPV、NPV和ROC分析都是标准术语。问题是客观的，并提供了精确的数值数据。为检查完整性和一致性，我们验证总数。\n- 疾病阳性个体总数（$N_{D^{+}}$）= $240 + 120 + 60 = 420$。\n- 疾病阴性个体总数（$N_{D^{-}}$）= $90 + 960 + 30 = 1,080$。\n- 队列总人数 = $N_{D^{+}} + N_{D^{-}} = 420 + 1,080 = 1,500$。\n这与给定的总数相符，因此数据是一致的。问题是提问明确的，因为它提供了足够的信息来计算唯一的解。\n\n### 步骤 3：结论与操作\n问题有效。将提供完整解答。\n\n### 解题过程\n所需的基本概念是阳性预测值（$PPV$）和阴性预测值（$NPV$）。根据条件概率的第一性原理，它们的定义如下：\n- $PPV = P(D^{+} | T^{+})$：在检测结果为阳性的条件下，一个人患有该疾病的概率。\n- $NPV = P(D^{-} | T^{-})$：在检测结果为阴性的条件下，一个人未患该疾病的概率。\n\n这些概率使用真阳性（$TP$）、假阳性（$FP$）、真阴性（$TN$）和假阴性（$FN$）的计数来计算。\n- $PPV = \\frac{TP}{TP + FP}$\n- $NPV = \\frac{TN}{TN + FN}$\n\n首先，我们根据给定数据构建一个3x2列联表，其中行代表检测结果，列代表根据参考标准的真实疾病状态。\n\n| 检测结果         | 疾病阳性 ($D^{+}$) | 疾病阴性 ($D^{-}$) | 行合计 |\n|---------------------|---------------------------|---------------------------|-----------|\n| 阳性 ($T^{+}$)   | $TP_{base} = 240$         | $FP_{base} = 90$          | $330$     |\n| 不确定 ($T^{ind}$) | $60$                      | $30$                      | $90$      |\n| 阴性 ($T^{-}$)    | $FN_{base} = 120$         | $TN_{base} = 960$         | $1080$    |\n| **列合计**    | **$420$**                 | **$1080$**                | **$1500$**|\n\n现在，我们分析这两种方法。\n\n**方法 $\\mathrm{A}$：将不确定结果视为阴性**\n在这种方法中，不确定结果被重新分类。来自$D^{+}$个体的$60$个不确定结果变为假阴性，来自$D^{-}$个体的$30$个不确定结果变为真阴性。这修改了阴性检测类别的计数，而阳性检测类别保持不变。\n\n方法$\\mathrm{A}$的有效计数为：\n- $TP_{\\mathrm{A}} = 240$\n- $FP_{\\mathrm{A}} = 90$\n- $FN_{\\mathrm{A}} = FN_{base} + (\\text{不确定 } D^{+}) = 120 + 60 = 180$\n- $TN_{\\mathrm{A}} = TN_{base} + (\\text{不确定 } D^{-}) = 960 + 30 = 990$\n\n检测结果为阳性的受试者总数为 $TP_{\\mathrm{A}} + FP_{\\mathrm{A}} = 240 + 90 = 330$。\n检测结果为阴性的受试者总数为 $TN_{\\mathrm{A}} + FN_{\\mathrm{A}} = 990 + 180 = 1170$。\n总样本量保持为 $N=1500$。\n\n方法$\\mathrm{A}$的预测值为：\n$$PPV_{\\mathrm{A}} = \\frac{TP_{\\mathrm{A}}}{TP_{\\mathrm{A}} + FP_{\\mathrm{A}}} = \\frac{240}{240 + 90} = \\frac{240}{330} = \\frac{24}{33} = \\frac{8}{11}$$\n$$NPV_{\\mathrm{A}} = \\frac{TN_{\\mathrm{A}}}{TN_{\\mathrm{A}} + FN_{\\mathrm{A}}} = \\frac{990}{990 + 180} = \\frac{990}{1170} = \\frac{99}{117} = \\frac{11}{13}$$\n\n**方法 $\\mathrm{B}$：排除不确定结果**\n在这种方法中，所有$90$个不确定结果都从分析中移除。新的总样本量为 $N_{\\mathrm{B}} = 1500 - 90 = 1410$。\n计数仅基于初始的阳性和阴性结果。\n\n方法$\\mathrm{B}$的有效计数为：\n- $TP_{\\mathrm{B}} = 240$\n- $FP_{\\mathrm{B}} = 90$\n- $FN_{\\mathrm{B}} = 120$\n- $TN_{\\mathrm{B}} = 960$\n\n检测结果为阳性的受试者总数为 $TP_{\\mathrm{B}} + FP_{\\mathrm{B}} = 240 + 90 = 330$。\n检测结果为阴性的受试者总数为 $TN_{\\mathrm{B}} + FN_{\\mathrm{B}} = 960 + 120 = 1080$。\n总样本量为 $330 + 1080 = 1410$。\n\n方法$\\mathrm{B}$的预测值为：\n$$PPV_{\\mathrm{B}} = \\frac{TP_{\\mathrm{B}}}{TP_{\\mathrm{B}} + FP_{\\mathrm{B}}} = \\frac{240}{240 + 90} = \\frac{240}{330} = \\frac{24}{33} = \\frac{8}{11}$$\n$$NPV_{\\mathrm{B}} = \\frac{TN_{\\mathrm{B}}}{TN_{\\mathrm{B}} + FN_{\\mathrm{B}}} = \\frac{960}{960 + 120} = \\frac{960}{1080} = \\frac{96}{108} = \\frac{8}{9}$$\n\n**计算预测值的变化**\n变化量定义为 $\\Delta = \\text{方法 A} - \\text{方法 B}$。\n$$\\Delta PPV = PPV_{\\mathrm{A}} - PPV_{\\mathrm{B}} = \\frac{8}{11} - \\frac{8}{11} = 0$$\n$$\\Delta NPV = NPV_{\\mathrm{A}} - NPV_{\\mathrm{B}} = \\frac{11}{13} - \\frac{8}{9} = \\frac{11 \\times 9}{13 \\times 9} - \\frac{8 \\times 13}{9 \\times 13} = \\frac{99 - 104}{117} = -\\frac{5}{117}$$\n\n**偏倚的解释**\n- **PPV**：PPV的变化为零（$\\Delta PPV = 0$）。这是因为PPV是以阳性检测结果为条件的（$P(D^+|T^+)$）。在方法$\\mathrm{A}$中，不确定结果被重新归类为阴性。此操作不改变检测为阳性的个体组的构成。在方法$\\mathrm{A}$和方法$\\mathrm{B}$中，集合$\\{T^+\\}$都包含相同的$TP=240$和$FP=90$个病例。由于两种方法中PPV计算的分子（$TP$）和分母（$TP+FP$）都相同，因此得到的PPV不变。相对于排除不确定结果，将其视为阴性不会对PPV的估计引入偏倚。\n\n- **NPV**：NPV的变化为负（$\\Delta NPV  0$），意味着$NPV_{\\mathrm{A}}  NPV_{\\mathrm{B}}$。这表明将不确定结果视为阴性会给NPV带来悲观偏倚（低估）。NPV是以阴性检测结果为条件的（$P(D^-|T^-)$）。在方法$\\mathrm{A}$中，通过纳入$90$个不确定病例，检测阴性个体的群体扩大了。我们比较原始阴性组中非患病个体的比例与新加入的不确定组中该比例。\n    - 原始阴性组（在方法$\\mathrm{B}$中使用）的“纯度”为 $NPV_{\\mathrm{B}} = P(D^{-}|T^{-}) = \\frac{960}{1080} = \\frac{8}{9} \\approx 0.889$。\n    - 不确定组中非患病个体的比例为 $P(D^{-}|T^{ind}) = \\frac{30}{30+60} = \\frac{30}{90} = \\frac{1}{3} \\approx 0.333$。\n    - 由于不确定组中非患病受试者的比例（$\\frac{1}{3}$）远低于原始阴性组（$\\frac{8}{9}$），将不确定组加入阴性池实际上是用更高比例的患病个体（假阴性）“污染”了它。这种将低纯度组与高纯度组混合的做法，导致最终混合物的整体纯度降低。因此，$NPV_{\\mathrm{A}}$低于$NPV_{\\mathrm{B}}$。阴性结果真正表示没有疾病的概率降低了。\n\n最终答案向量：\n$(PPV_{\\mathrm{A}},\\,NPV_{\\mathrm{A}},\\,PPV_{\\mathrm{B}},\\,NPV_{\\mathrm{B}},\\,\\Delta PPV,\\,\\Delta NPV) = \\left(\\frac{8}{11}, \\frac{11}{13}, \\frac{8}{11}, \\frac{8}{9}, 0, -\\frac{5}{117}\\right)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{8}{11}  \\frac{11}{13}  \\frac{8}{11}  \\frac{8}{9}  0  -\\frac{5}{117}\n\\end{pmatrix}\n}\n$$", "id": "5105209"}, {"introduction": "虽然预测值在评估检测于特定人群中的表现时非常有用，但它们会随患病率变化，这限制了其普适性。本练习将向您介绍一个更为灵活且独立于患病率的工具：似然比（Likelihood Ratios）。您将为一个血清学检测计算阳性似然比（$\\text{LR}^+$）和阴性似然比（$\\text{LR}^-$），并学习如何运用它们将临床医生对疾病的先验怀疑（验前比数）更新为获得检测结果后的后验结论（验后比数）[@problem_id:5105251]。掌握这一方法是实现个体化、循证诊断决策的关键一步。", "problem": "一种用于检测 Mycobacterium tuberculosis 抗体的重组抗原酶联免疫吸附试验（ELISA）正在一家转诊诊所进行评估，以用于有症状的成年人。基于受试者工作特征（ROC）分析，已在该检测的连续输出上选定了单一决策阈值。在此阈值下，相对于活动性肺结核的微生物学参考标准，真阳性率（TPR）和假阳性率（FPR）分别为 $18/25$ 和 $3/25$。一位临床医生估计，在被评估人群中，活动性肺结核的验前概率为 $3/20$。\n\n从 $ \\text{TPR} = \\mathbb{P}(\\text{test } + \\mid D) $ 和 $ \\text{FPR} = \\mathbb{P}(\\text{test } + \\mid \\neg D) $ 的核心定义以及 Bayes 定理的比值形式出发，推导阳性似然比 $ \\text{LR}^{+} $ 和阴性似然比 $ \\text{LR}^{-} $，并用它们计算阳性结果后和阴性结果后的验后患病比值。将验前比值 $O_{\\text{pre}}$ 表示为 $ \\mathbb{P}(D)/\\mathbb{P}(\\neg D) $，验后比值表示为 $ O_{\\text{post}}^{+} = O_{\\text{pre}} \\times \\text{LR}^{+} $ 和 $ O_{\\text{post}}^{-} = O_{\\text{pre}} \\times \\text{LR}^{-} $。\n\n以精确的有理数形式报告你的最终答案，不要四舍五入，并按 $ (\\text{LR}^{+}, \\text{LR}^{-}, O_{\\text{post}}^{+}, O_{\\text{post}}^{-}) $ 的顺序排列。无需单位。", "solution": "该问题被认为是有效的，因为它科学地基于诊断测试评估的原则，问题设定良好，信息充分且一致，并以客观、正式的语言表达。问题不存在违反科学原理、逻辑不一致或含糊不清之处。\n\n设 $D$ 表示患者患有活动性肺结核（疾病）的事件，$\\neg D$ 表示患者未患该病的事件。设 $\\text{test +}$ 表示阳性检测结果，$\\text{test -}$ 表示阴性检测结果。\n\n问题提供了以下数据：\n真阳性率（TPR），即在患病情况下检测结果为阳性的概率：\n$$ \\text{TPR} = \\mathbb{P}(\\text{test } + \\mid D) = \\frac{18}{25} $$\n假阳性率（FPR），即在未患病情况下检测结果为阳性的概率：\n$$ \\text{FPR} = \\mathbb{P}(\\text{test } + \\mid \\neg D) = \\frac{3}{25} $$\n验前患病概率，或患病率：\n$$ \\mathbb{P}(D) = \\frac{3}{20} $$\n\n任务是推导并计算阳性似然比（$\\text{LR}^{+}$）、阴性似然比（$\\text{LR}^{-}$）、阳性结果后的验后比值（$O_{\\text{post}}^{+}$）以及阴性结果后的验后比值（$O_{\\text{post}}^{-}$）。\n\n首先，我们推导似然比的表达式。\n\n阳性似然比 $\\text{LR}^{+}$ 定义为患病个体中检测结果为阳性的概率与非患病个体中检测结果为阳性的概率之比。\n$$ \\text{LR}^{+} = \\frac{\\mathbb{P}(\\text{test } + \\mid D)}{\\mathbb{P}(\\text{test } + \\mid \\neg D)} $$\n使用所提供的定义：\n$$ \\text{LR}^{+} = \\frac{\\text{TPR}}{\\text{FPR}} $$\n代入给定值：\n$$ \\text{LR}^{+} = \\frac{18/25}{3/25} = \\frac{18}{3} = 6 $$\n\n阴性似然比 $\\text{LR}^{-}$ 定义为患病个体中检测结果为阴性的概率与非患病个体中检测结果为阴性的概率之比。\n$$ \\text{LR}^{-} = \\frac{\\mathbb{P}(\\text{test } - \\mid D)}{\\mathbb{P}(\\text{test } - \\mid \\neg D)} $$\n分子是假阴性率（FNR），即 $\\mathbb{P}(\\text{test } - \\mid D) = 1 - \\mathbb{P}(\\text{test } + \\mid D) = 1 - \\text{TPR}$。\n分母是真阴性率（TNR），即 $\\mathbb{P}(\\text{test } - \\mid \\neg D) = 1 - \\mathbb{P}(\\text{test } + \\mid \\neg D) = 1 - \\text{FPR}$。\n因此，$\\text{LR}^{-}$ 的表达式为：\n$$ \\text{LR}^{-} = \\frac{1 - \\text{TPR}}{1 - \\text{FPR}} $$\n首先，我们计算 FNR 和 TNR：\n$$ \\text{FNR} = 1 - \\frac{18}{25} = \\frac{7}{25} $$\n$$ \\text{TNR} = 1 - \\frac{3}{25} = \\frac{22}{25} $$\n将这些值代入 $\\text{LR}^{-}$ 的表达式中：\n$$ \\text{LR}^{-} = \\frac{7/25}{22/25} = \\frac{7}{22} $$\n\n接下来，我们使用 Bayes 定理的比值形式来计算验后比值。其一般形式为 $O_{\\text{post}} = O_{\\text{pre}} \\times \\text{LR}$。\n首先，我们必须计算验前比值 $O_{\\text{pre}}$。\n未患病的概率为：\n$$ \\mathbb{P}(\\neg D) = 1 - \\mathbb{P}(D) = 1 - \\frac{3}{20} = \\frac{17}{20} $$\n验前比值定义为患病概率与未患病概率之比：\n$$ O_{\\text{pre}} = \\frac{\\mathbb{P}(D)}{\\mathbb{P}(\\neg D)} = \\frac{3/20}{17/20} = \\frac{3}{17} $$\n\n现在我们可以计算阳性和阴性检测结果的验后比值。\n对于阳性结果，验后比值为：\n$$ O_{\\text{post}}^{+} = O_{\\text{pre}} \\times \\text{LR}^{+} $$\n$$ O_{\\text{post}}^{+} = \\frac{3}{17} \\times 6 = \\frac{18}{17} $$\n\n对于阴性结果，验后比值为：\n$$ O_{\\text{post}}^{-} = O_{\\text{pre}} \\times \\text{LR}^{-} $$\n$$ O_{\\text{post}}^{-} = \\frac{3}{17} \\times \\frac{7}{22} = \\frac{21}{374} $$\n\n按指定顺序 $(\\text{LR}^{+}, \\text{LR}^{-}, O_{\\text{post}}^{+}, O_{\\text{post}}^{-})$ 的最终答案是 $(6, \\frac{7}{22}, \\frac{18}{17}, \\frac{21}{374})$。所有值均按要求表示为精确的有理数。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6  \\frac{7}{22}  \\frac{18}{17}  \\frac{21}{374} \\end{pmatrix}}\n$$", "id": "5105251"}]}