{"hands_on_practices": [{"introduction": "所有结合现象的核心是质量作用定律，它决定了系统的最终平衡状态。虽然在特定条件下（例如，一种反应物远过量）可以使用简化近似，但严谨的分析需要求解精确的结合方程。本练习 [@problem_id:5092704] 将指导您从第一性原理出发，为1:1结合系统推导并求解二次方程，从而精确预测抗原-抗体复合物在平衡时的浓度。", "problem": "在恒温的均相免疫诊断结合测定中，考虑一种抗体和一种抗原之间遵循质量作用定律的单位点可逆相互作用。设抗体用 $A$ 表示，抗原用 $G$ 表示，1:1 复合物用 $AG$ 表示。解离常数定义为 $K_d=\\frac{[A][G]}{[AG]}$，其中 $[\\,\\cdot\\,]$ 表示平衡时的摩尔浓度。总浓度是守恒的：$A_t=[A]+[AG]$ 和 $G_t=[G]+[AG]$。假设没有协同性、没有多价性、没有自缔合，并且系统是封闭的，除了结合之外没有其他消耗或产生。\n\n从这些基本定义和守恒关系出发，推导出复合物浓度 $[AG]$ 的精确平衡表达式，不引入任何近似。然后用它计算结合抗原的平衡分数，定义为 $f=\\frac{[AG]}{G_t}$，参数值为：$A_t=10\\,\\mathrm{nM}$，$G_t=20\\,\\mathrm{nM}$，以及 $K_d=2\\,\\mathrm{nM}$。将 $f$ 的数值结果四舍五入到四位有效数字，并表示为一个无单位的小数。此外，根据推导出的表达式，使用第一性原理进行推理，简要解释在这些条件下，结合结果主要是受化学计量限制还是受亲和力限制。你最终报告的答案必须只是四舍五入到四位有效数字的 $f$ 的数值。", "solution": "该系统是一个可逆的双分子结合反应 $A+G \\rightleftharpoons AG$，其特征是解离常数 $K_d=\\frac{[A][G]}{[AG]}$。其基本依据是质量作用定律和物种总浓度守恒。设 $x=[AG]$ 表示平衡时的复合物浓度。那么根据守恒关系有\n$$\n[A]=A_t-x,\\quad [G]=G_t-x.\n$$\n代入解离常数的定义中：\n$$\nK_d=\\frac{(A_t-x)(G_t-x)}{x}.\n$$\n两边同乘以 $x$ 得到一个关于 $x$ 的多项式方程：\n$$\nK_d\\,x=(A_t-x)(G_t-x)=A_tG_t-x(A_t+G_t)+x^2.\n$$\n整理各项得到一个二次方程：\n$$\nx^2 - x\\left(A_t+G_t+K_d\\right) + A_tG_t = 0.\n$$\n这个关于 $x$ 的二次方程有两个根，由二次方程求根公式给出。物理上相关的根必须满足 $0\\leq x \\leq \\min\\{A_t,G_t\\}$ 并且是非负的。两个解是\n$$\nx=\\frac{\\left(A_t+G_t+K_d\\right)\\pm\\sqrt{\\left(A_t+G_t+K_d\\right)^2-4A_tG_t}}{2}.\n$$\n较大的根超过了 $\\min\\{A_t,G_t\\}$，因此在物理上是不允许的。因此，允许的平衡复合物浓度是\n$$\nx=\\frac{\\left(A_t+G_t+K_d\\right)-\\sqrt{\\left(A_t+G_t+K_d\\right)^2-4A_tG_t}}{2}.\n$$\n结合抗原的平衡分数是\n$$\nf=\\frac{x}{G_t}=\\frac{1}{G_t}\\cdot\\frac{\\left(A_t+G_t+K_d\\right)-\\sqrt{\\left(A_t+G_t+K_d\\right)^2-4A_tG_t}}{2}.\n$$\n\n现在我们将给定的数值 $A_t=10\\,\\mathrm{nM}$，$G_t=20\\,\\mathrm{nM}$ 和 $K_d=2\\,\\mathrm{nM}$ 代入 $x$ 的表达式中。首先计算和\n$$\nS=A_t+G_t+K_d=10\\,\\mathrm{nM}+20\\,\\mathrm{nM}+2\\,\\mathrm{nM}=32\\,\\mathrm{nM}.\n$$\n接着计算判别式\n$$\n\\Delta=S^2-4A_tG_t=(32\\,\\mathrm{nM})^2-4\\cdot(10\\,\\mathrm{nM})\\cdot(20\\,\\mathrm{nM})=1024\\,\\mathrm{nM}^2-800\\,\\mathrm{nM}^2=224\\,\\mathrm{nM}^2.\n$$\n那么\n$$\n\\sqrt{\\Delta}=\\sqrt{224}\\,\\mathrm{nM}=4\\sqrt{14}\\,\\mathrm{nM}.\n$$\n因此\n$$\nx=\\frac{32\\,\\mathrm{nM}-\\sqrt{224}\\,\\mathrm{nM}}{2}=\\frac{32-\\sqrt{224}}{2}\\,\\mathrm{nM}.\n$$\n数值上，$\\sqrt{224}\\approx 14.966629547$，得到\n$$\nx\\approx \\frac{32-14.966629547}{2}\\,\\mathrm{nM}\\approx \\frac{17.033370453}{2}\\,\\mathrm{nM}\\approx 8.516685226\\,\\mathrm{nM}.\n$$\n因此，\n$$\nf=\\frac{x}{G_t}\\approx \\frac{8.516685226\\,\\mathrm{nM}}{20\\,\\mathrm{nM}}\\approx 0.4258342613.\n$$\n四舍五入到四位有效数字，结合抗原的平衡分数是\n$$\nf\\approx 0.4258.\n$$\n\n从第一性原理对饱和状态的解释：$x$ 的化学计量上限是 $\\min\\{A_t,G_t\\}=A_t=10\\,\\mathrm{nM}$，在无限强结合（即 $K_d\\to 0$）的极限情况下，这对应于 $f_{\\max}=\\frac{A_t}{G_t}=\\frac{10}{20}=0.5$。在此， $K_d=2\\,\\mathrm{nM}$ 小于 $A_t$ 和 $G_t$，因此系统处于高亲和力状态，其中结合接近化学计量极限。观测到的 $f\\approx 0.4258$ 接近但低于 $0.5$，表明结合主要受限于可用抗体的量（化学计量），并因有限的亲和力而有适度降低。因此，该系统接近化学计量饱和状态，而不是受亲和力限制。", "answer": "$$\\boxed{0.4258}$$", "id": "5092704"}, {"introduction": "理解了平衡状态后，下一个自然而然的问题是：达到平衡需要多长时间？本练习 [@problem_id:5092682] 探讨了分子结合速率的物理极限，即由扩散控制的速率。通过应用Smoluchowski模型，您将计算扩散限制的结合速率常数（$k_{\\text{on}}$），这为解释实验动力学数据提供了一个至关重要的理论基准。", "problem": "一项免疫诊断测定在均相含水缓冲液中进行，其中单克隆抗体及其单价抗原自由扩散，并在进入短程接触距离后无能量壁垒地结合。将抗体和抗原均视为在三维空间中进行独立布朗运动的硬球。抗体的平移扩散系数为 $D_{\\mathrm{Ab}}=60\\,\\mathrm{\\mu m^2/s}$，抗原的平移扩散系数为 $D_{\\mathrm{Ag}}=100\\,\\mathrm{\\mu m^2/s}$，接触半径为 $R=4\\,\\mathrm{nm}$。阿伏伽德罗常数为 $N_A=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$。\n\n从到完全吸收球面边界的稳态扩散和菲克定律的通量定义出发，推导抗原-抗体反应的扩散限制双分子结合速率常数 $k_{\\mathrm{on,DL}}$，并通过从给定的微观单位转换，将结果明确表示为摩尔单位 $\\mathrm{M^{-1}s^{-1}}$。明确阐明对两种扩散反应物使用相对扩散系数的理由。使用所提供的参数计算 $k_{\\mathrm{on,DL}}$ 的数值。将最终答案四舍五入至三位有效数字，并以 $\\mathrm{M^{-1}s^{-1}}$ 表示。", "solution": "### 推导与求解\n\n问题要求推导扩散限制的双分子结合速率常数 $k_{\\mathrm{on,DL}}$，该常数描述了两种扩散物质——抗体(Ab)和抗原(Ag)——相遇并结合的速率。\n\n首先，我们将双体扩散问题简化为单体问题。两个独立扩散粒子的相遇在数学上等同于一个具有相对扩散系数 $D_{\\mathrm{rel}}$ 的单个粒子向一个静止靶标的扩散。抗体和抗原的位置分别为 $\\vec{r}_{\\mathrm{Ab}}(t)$ 和 $\\vec{r}_{\\mathrm{Ag}}(t)$。它们的相对位置是 $\\vec{r}_{\\mathrm{rel}}(t) = \\vec{r}_{\\mathrm{Ag}}(t) - \\vec{r}_{\\mathrm{Ab}}(t)$。由于它们的布朗运动不相关，相对位置的均方位移是相加的：$\\langle |\\Delta\\vec{r}_{\\mathrm{rel}}|^2 \\rangle = \\langle |\\Delta\\vec{r}_{\\mathrm{Ag}}|^2 \\rangle + \\langle |\\Delta\\vec{r}_{\\mathrm{Ab}}|^2 \\rangle$。在三维空间中，均方位移通过 $\\langle |\\Delta\\vec{r}|^2 \\rangle = 6 D \\Delta t$ 与扩散系数相关。因此，$6 D_{\\mathrm{rel}} \\Delta t = 6 D_{\\mathrm{Ag}} \\Delta t + 6 D_{\\mathrm{Ab}} \\Delta t$，简化后得到：\n$$D_{\\mathrm{rel}} = D_{\\mathrm{Ab}} + D_{\\mathrm{Ag}}$$\n这就证明了使用一个模型的合理性，在该模型中，具有扩散系数 $D_{\\mathrm{rel}}$ 的抗原粒子向一个静止的抗体靶标扩散。假设在达到接触距离 $R$ 时结合是瞬时的，这使得靶标成为一个半径为 $R$ 的“完全吸收球体”。\n\n我们寻求抗原分子到这个球形靶标上的稳态通量。抗原浓度 $C(r)$ 作为离抗体中心距离 $r$ 的函数，由菲克定律决定。在稳态下，通量密度 $\\vec{J}$ 的散度为零：$\\nabla \\cdot \\vec{J} = 0$。使用菲克第一定律 $\\vec{J} = -D_{\\mathrm{rel}} \\nabla C$，这变成了浓度的拉普拉斯方程：\n$$\\nabla^2 C(r) = 0$$\n由于问题的球对称性，我们使用球坐标系下的拉普拉斯算子，并假设浓度仅随半径 $r$ 变化：\n$$\\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dC}{dr} \\right) = 0$$\n对该方程对 $r$ 积分两次，得到通解：\n$$C(r) = A_1 - \\frac{A_2}{r}$$\n其中 $A_1$ 和 $A_2$ 是由边界条件决定的积分常数。\n边界条件是：\n1.  远离靶标（$r \\to \\infty$），浓度为本体抗原浓度 $C_0$：$C(r \\to \\infty) = C_0$。\n2.  在吸收球表面（$r=R$），由于瞬时结合，浓度为零：$C(R) = 0$。\n\n应用第一个边界条件：$C_0 = A_1 - \\frac{A_2}{\\infty}$，得到 $A_1 = C_0$。\n应用第二个边界条件：$0 = C_0 - \\frac{A_2}{R}$，得到 $A_2 = C_0 R$。\n将常数代回，稳态浓度分布为：\n$$C(r) = C_0 \\left( 1 - \\frac{R}{r} \\right)$$\n对于单个抗体分子的总通量或反应速率 $\\Phi$，是通量密度矢量在半径为 $R$ 的球体表面上的积分。在半径 $r$ 处的通量密度大小为 $J(r) = |\\vec{J}(r)| = |-D_{\\mathrm{rel}} \\frac{dC}{dr}|$。\n梯度为 $\\frac{dC}{dr} = \\frac{C_0 R}{r^2}$。\n在表面 $r=R$ 处，梯度为 $\\left. \\frac{dC}{dr} \\right|_{r=R} = \\frac{C_0}{R}$。\n在表面的通量大小为 $J(R) = D_{\\mathrm{rel}} \\frac{C_0}{R}$。\n进入球体的总通量（每秒粒子数）是此大小乘以球体表面积 $A_{sphere} = 4\\pi R^2$：\n$$\\Phi = J(R) \\times A_{sphere} = \\left( D_{\\mathrm{rel}} \\frac{C_0}{R} \\right) (4\\pi R^2) = 4\\pi D_{\\mathrm{rel}} R C_0$$\n此通量 $\\Phi$ 表示单个抗体分子的反应速率，可以表示为 $\\Phi = k_{\\text{micro}} C_0$，其中 $k_{\\text{micro}}$ 是微观二级速率常数。通过比较，我们发现：\n$$k_{\\text{micro}} = 4\\pi D_{\\mathrm{rel}} R$$\n该常数的单位是体积/时间（例如，$\\mathrm{m^3/s}$），表示扩散粒子每单位时间扫过的体积。为了以标准单位 $\\mathrm{M^{-1}s^{-1}}$（等同于 $\\mathrm{L \\cdot mol^{-1} \\cdot s^{-1}}$）获得摩尔结合速率常数 $k_{\\mathrm{on,DL}}$，我们必须从基于粒子的微观尺度转换到摩尔宏观尺度。摩尔速率常数 $k_{\\mathrm{on,DL}}$ 与微观速率常数 $k_{\\text{micro}}$ 的关系如下：\n$$k_{\\mathrm{on,DL}} = k_{\\text{micro}} \\times N_A \\times (\\text{conversion factor from m}^3 \\text{ to L})$$\n由于 $1 \\, \\mathrm{m^3} = 1000 \\, \\mathrm{L}$，转换因子是 $1000$。\n因此，扩散限制结合速率常数的最终表达式是：\n$$k_{\\mathrm{on,DL}} = 4\\pi D_{\\mathrm{rel}} R N_A \\times 1000$$\n为了使该公式得到 $\\mathrm{M^{-1}s^{-1}}$ 的单位，输入值必须使用国际单位制（SI）基本单位：$D_{\\mathrm{rel}}$ 以 $\\mathrm{m^2/s}$ 为单位，$R$ 以 $\\mathrm{m}$ 为单位。\n\n现在，我们计算数值。\n首先，将给定参数转换为国际单位制单位。\n$D_{\\mathrm{Ab}} = 60\\,\\mathrm{\\mu m^2/s} = 60 \\times (10^{-6}\\,\\mathrm{m})^2/\\mathrm{s} = 60 \\times 10^{-12}\\,\\mathrm{m^2/s}$。\n$D_{\\mathrm{Ag}} = 100\\,\\mathrm{\\mu m^2/s} = 100 \\times 10^{-12}\\,\\mathrm{m^2/s}$。\n$R = 4\\,\\mathrm{nm} = 4 \\times 10^{-9}\\,\\mathrm{m}$。\n\n计算相对扩散系数：\n$$D_{\\mathrm{rel}} = D_{\\mathrm{Ab}} + D_{\\mathrm{Ag}} = (60 \\times 10^{-12} + 100 \\times 10^{-12})\\,\\mathrm{m^2/s} = 160 \\times 10^{-12}\\,\\mathrm{m^2/s} = 1.6 \\times 10^{-10}\\,\\mathrm{m^2/s}$$\n将数值代入推导出的 $k_{\\mathrm{on,DL}}$ 方程中：\n$$k_{\\mathrm{on,DL}} = 4\\pi (1.6 \\times 10^{-10}\\,\\mathrm{m^2/s}) (4 \\times 10^{-9}\\,\\mathrm{m}) (6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}) (1000\\,\\mathrm{L/m^3})$$\n$$k_{\\mathrm{on,DL}} = 4\\pi (1.6)(4)(6.02214076) \\times 10^{-10} \\times 10^{-9} \\times 10^{23} \\times 10^3 \\, \\mathrm{L \\cdot mol^{-1} \\cdot s^{-1}}$$\n$$k_{\\mathrm{on,DL}} = 25.6\\pi (6.02214076) \\times 10^{(-10-9+23+3)} \\, \\mathrm{M^{-1}s^{-1}}$$\n$$k_{\\mathrm{on,DL}} = 25.6\\pi (6.02214076) \\times 10^{7} \\, \\mathrm{M^{-1}s^{-1}}$$\n$$k_{\\mathrm{on,DL}} \\approx (80.42477) (6.02214076) \\times 10^{7} \\, \\mathrm{M^{-1}s^{-1}}$$\n$$k_{\\mathrm{on,DL}} \\approx 484.349 \\times 10^{7} \\, \\mathrm{M^{-1}s^{-1}}$$\n$$k_{\\mathrm{on,DL}} \\approx 4.84349 \\times 10^{9} \\, \\mathrm{M^{-1}s^{-1}}$$\n按要求将结果四舍五入至三位有效数字：\n$$k_{\\mathrm{on,DL}} = 4.84 \\times 10^9 \\, \\mathrm{M^{-1}s^{-1}}$$", "answer": "$$\\boxed{4.84 \\times 10^9}$$", "id": "5092682"}, {"introduction": "最后的这项练习将平衡与热力学概念融会贯通，构建一个完整的实验模拟。您将对等温滴定量热法（ITC）实验进行建模 [@problem_id:5092675]，这是测量结合热力学（如 $K_d$ 和 $\\Delta H$）的黄金标准技术。此练习要求您结合质量平衡、平衡计算和焓变来生成模拟的滴定曲线，从而弥合理论模型与真实实验数据分析之间的鸿沟。", "problem": "您需要使用平衡热力学和质量平衡的第一性原理，为单一位点抗原-抗体结合相互作用实现一个等温滴定微量热法 (ITC) 的模拟。结合反应被建模为抗原和抗体之间的可逆结合，$A + B \\rightleftharpoons AB$，其特征是平衡解离常数 $K_d$，根据质量作用定律定义为 $K_d = \\dfrac{[A][B]}{[AB]}$。每次注射释放或吸收的积分热由复合物形成时的每摩尔焓变 $\\Delta H$ 以及样品池中复合物摩尔数的变化量决定。\n\n假设每次注射都遵循以下物理上真实且可测试的情景：\n- 样品池体积恒定，等于 $V_0$。\n- 注射器注入体积为 $v_i$、浓度为 $C_s$ 的抗原。\n- 样品池最初含有浓度为 $C_M$ 的抗体，不含抗原。\n- 每次注射时，为了保持体积恒定，样品池中体积分数为 $f_i = \\dfrac{v_i}{V_0}$ 的内容物被置换出来；被置换出的流体具有注射前混合物的组分。\n- 混合并达到平衡后，结合遵循质量作用定律和质量守恒。\n\n设 $M^{(i)}$ 和 $L^{(i)}$ 分别表示第 $i$ 次注射后样品池中抗体和抗原的总摩尔数，初始条件为 $M^{(0)} = C_M V_0$ 和 $L^{(0)} = 0$。第 $i$ 次注射的质量平衡更新如下：\n- $M^{(i)} = (1 - f_i) M^{(i-1)}$，\n- $L^{(i)} = (1 - f_i) L^{(i-1)} + v_i C_s$。\n\n将第 $i$ 次注射后的总浓度定义为 $T_M^{(i)} = \\dfrac{M^{(i)}}{V_0}$ 和 $T_L^{(i)} = \\dfrac{L^{(i)}}{V_0}$。设 $x^{(i)}$ 为第 $i$ 次注射后复合物 $[AB]$ 的平衡浓度。在平衡时，$[A] = T_M^{(i)} - x^{(i)}$ 和 $[B] = T_L^{(i)} - x^{(i)}$ 必须满足质量作用定律 $K_d = \\dfrac{[A][B]}{x^{(i)}}$。第 $i$ 次注射的积分热是每摩尔焓变乘以在注射和平衡步骤中样品池内复合物摩尔数的净变化，由 $q_i = \\Delta H \\, V_0 \\left( x^{(i)} - (1 - f_i) x^{(i-1)} \\right)$ 给出，其中 $x^{(0)} = 0$。\n\n您的任务是：\n- 实现一个程序，对于每次注射，通过守恒定律更新 $M^{(i)}$ 和 $L^{(i)}$，计算 $T_M^{(i)}$ 和 $T_L^{(i)}$，根据质量作用定律和质量平衡求解 $x^{(i)}$（不使用问题陈述中给出的任何快捷公式），并使用以 $\\text{J} \\cdot \\text{mol}^{-1}$ 表示的焓 $\\Delta H$ 计算 $q_i$（单位为焦耳）。\n- 将滴定曲线模拟为指定注射的一系列 $q_i$ 值列表。\n\n将所有积分热 $q_i$ 以 $\\text{J}$ 为单位表示，并四舍五入到六位小数。\n\n测试套件：\n为以下四组参数计算滴定曲线。在每种情况下，使用指定的 $V_0$（单位 $\\text{L}$）、$C_M$（单位 $\\text{mol} \\cdot \\text{L}^{-1}$）、$C_s$（单位 $\\text{mol} \\cdot \\text{L}^{-1}$）、$K_d$（单位 $\\text{mol} \\cdot \\text{L}^{-1}$）、$\\Delta H$（单位 $\\text{J} \\cdot \\text{mol}^{-1}$）和注射体积 $v_i$（单位 $\\text{L}$）：\n\n- 情况 1（一般情况）：\n  - $V_0 = 1.4 \\times 10^{-3}$,\n  - $C_M = 1.2 \\times 10^{-5}$,\n  - $C_s = 2.5 \\times 10^{-4}$,\n  - $K_d = 5.0 \\times 10^{-7}$,\n  - $\\Delta H = -3.5 \\times 10^{4}$,\n  - $10$ 次注射，每次 $v_i = 2.0 \\times 10^{-6}$。\n\n- 情况 2（紧密结合边缘情况）：\n  - $V_0 = 1.5 \\times 10^{-3}$,\n  - $C_M = 1.0 \\times 10^{-5}$,\n  - $C_s = 1.0 \\times 10^{-4}$,\n  - $K_d = 1.0 \\times 10^{-9}$,\n  - $\\Delta H = -5.0 \\times 10^{4}$,\n  - $10$ 次注射，每次 $v_i = 2.0 \\times 10^{-6}$。\n\n- 情况 3（弱结合边缘情况）：\n  - $V_0 = 1.4 \\times 10^{-3}$,\n  - $C_M = 1.0 \\times 10^{-5}$,\n  - $C_s = 2.0 \\times 10^{-4}$,\n  - $K_d = 1.0 \\times 10^{-4}$,\n  - $\\Delta H = -2.0 \\times 10^{4}$,\n  - $10$ 次注射，每次 $v_i = 3.0 \\times 10^{-6}$。\n\n- 情况 4（零焓边界和可变注射量）：\n  - $V_0 = 1.4 \\times 10^{-3}$,\n  - $C_M = 8.0 \\times 10^{-6}$,\n  - $C_s = 1.5 \\times 10^{-4}$,\n  - $K_d = 1.0 \\times 10^{-6}$,\n  - $\\Delta H = 0$,\n  - $10$ 次注射，其 $v_i$ 序列为 $\\left[0, 2.0 \\times 10^{-6}, 2.0 \\times 10^{-6}, 2.0 \\times 10^{-6}, 3.0 \\times 10^{-6}, 3.0 \\times 10^{-6}, 4.0 \\times 10^{-6}, 4.0 \\times 10^{-6}, 5.0 \\times 10^{-6}, 5.0 \\times 10^{-6}\\right]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。此顶层列表的每个条目都必须是对应一种情况的滴定曲线，表示为一个以 $\\text{J}$ 为单位、四舍五入到六位小数的浮点数列表，并按情况 1、情况 2、情况 3、情况 4 的顺序排列。例如，它必须具有带数字条目的列表的列表的语法形式，并且必须只打印在一行上。", "solution": "该问题要求为单一位点结合模型实现一个基于第一性原理的等温滴定微量热法 (ITC) 实验模拟。该模拟必须计算一系列注射中每次注射所释放或吸收的热量 ($q_i$)。该问题在科学上是合理的、定义明确的，并提供了构建唯一、可验证的解决方案所需的所有信息和参数。\n\n模拟过程是迭代进行的，每一步对应于从注射器向样品池中的一次注射。对于每次注射 $i$，我们必须更新池中抗体和抗原的总量，求解新的平衡态，然后计算相关的热量变化。\n\n**1. 系统定义与质量平衡**\n\n该系统由一个恒定体积 $V_0$ 的样品池和一个注射器组成。初始时，在步骤 $i=0$，样品池中含有浓度为 $C_M$ 的抗体，不含抗原。抗体（大分子，物种 A）的初始摩尔数为 $M^{(0)} = C_M V_0$，抗原（配体，物种 B）的初始摩尔数为 $L^{(0)} = 0$。抗原-抗体复合物的初始浓度 $x^{(0)}$ 也为 0。\n\n对于随后的每次注射 $i$，将体积为 $v_i$、浓度为 $C_s$ 的抗原溶液加入样品池。为保持恒定体积 $V_0$，等体积 $v_i$ 的样品池内容物被置换出来。被置换出的样品池体积分数为 $f_i = v_i / V_0$。被置换的流体具有上一步 $(i-1)$ 结束时样品池混合物的组分。\n\n根据质量守恒原理，在第 $i$ 次注射和置换后，样品池中的抗体总摩尔数 $M^{(i)}$ 和抗原总摩尔数 $L^{(i)}$ 更新如下：\n- 抗体的摩尔数因被置换部分而减少：\n$$M^{(i)} = M^{(i-1)} (1 - f_i)$$\n- 抗原的摩尔数因被置换部分而减少，并因注射的量而增加：\n$$L^{(i)} = L^{(i-1)} (1 - f_i) + v_i C_s$$\n\n注射和混合后，在样品池体积 $V_0$ 中抗体和抗原的总浓度 $T_M^{(i)}$ 和 $T_L^{(i)}$ 分别为：\n$$T_M^{(i)} = \\frac{M^{(i)}}{V_0}$$\n$$T_L^{(i)} = \\frac{L^{(i)}}{V_0}$$\n\n**2. 化学平衡**\n\n结合反应是可逆的缔合反应 $A + B \\rightleftharpoons AB$。在平衡状态下，游离抗体 $[A]$、游离抗原 $[B]$ 和复合物 $[AB]$ 的浓度通过解离常数 $K_d$ 相关联：\n$$K_d = \\frac{[A] [B]}{[AB]}$$\n\n设 $x^{(i)}$ 为第 $i$ 次注射后复合物 $[AB]$ 的平衡浓度。根据样品池体积 $V_0$ 内每个物种的质量守恒，游离物种的平衡浓度为：\n$$[A] = T_M^{(i)} - x^{(i)}$$\n$$[B] = T_L^{(i)} - x^{(i)}$$\n\n将这些代入 $K_d$ 的表达式中，得到：\n$$K_d = \\frac{(T_M^{(i)} - x^{(i)})(T_L^{(i)} - x^{(i)})}{x^{(i)}}$$\n\n为了求出复合物的平衡浓度 $x^{(i)}$，我们必须解这个方程。将其重新排列成标准二次方程形式 $a(x^{(i)})^2 + b(x^{(i)}) + c = 0$：\n$$K_d x^{(i)} = T_M^{(i)} T_L^{(i)} - T_M^{(i)} x^{(i)} - T_L^{(i)} x^{(i)} + (x^{(i)})^2$$\n$$(x^{(i)})^2 - (T_M^{(i)} + T_L^{(i)} + K_d) x^{(i)} + T_M^{(i)} T_L^{(i)} = 0$$\n\n关于 $x^{(i)}$ 的二次方程的系数为：\n- $a = 1$\n- $b = -(T_M^{(i)} + T_L^{(i)} + K_d)$\n- $c = T_M^{(i)} T_L^{(i)}$\n\n解由二次公式给出，$x^{(i)} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$。\n$$x^{(i)} = \\frac{(T_M^{(i)} + T_L^{(i)} + K_d) \\pm \\sqrt{(T_M^{(i)} + T_L^{(i)} + K_d)^2 - 4 T_M^{(i)} T_L^{(i)}}}{2}$$\n\n对于浓度而言，一个物理上有意义的解必须是正实数。判别式 $(T_M^{(i)} + T_L^{(i)} + K_d)^2 - 4 T_M^{(i)} T_L^{(i)}$ 总是正的，保证了根是实数。此外，复合物的浓度 $x^{(i)}$ 不能超过任一反应物的总浓度，即 $0 \\le x^{(i)} \\le \\min(T_M^{(i)}, T_L^{(i)})$。带有加号的根会得出一个大于 $T_M^{(i)} + T_L^{(i)}$ 的 $x^{(i)}$ 值，这在物理上是不可能的。因此，正确的物理根是带有减号的那个：\n$$x^{(i)} = \\frac{(T_M^{(i)} + T_L^{(i)} + K_d) - \\sqrt{(T_M^{(i)} + T_L^{(i)} + K_d)^2 - 4 T_M^{(i)} T_L^{(i)}}}{2}$$\n\n**3. 热量计算**\n\n与第 $i$ 次注射相关的积分热 $q_i$ 是结合的摩尔焓 $\\Delta H$ 与样品池内复合物摩尔数的总变化量 $\\Delta N_{AB}^{(i)}$ 的乘积。\n在步骤 $i$ 结束时复合物的摩尔数是 $N_{AB}^{(i)} = x^{(i)} V_0$。在步骤 $i$ 开始时（即步骤 $i-1$ 结束时）复合物的摩尔数是 $N_{AB}^{(i-1)} = x^{(i-1)} V_0$。在第 $i$ 次注射的置换阶段，体积为 $v_i$、浓度为 $x^{(i-1)}$ 的复合物被移除。在重新平衡之前，样品池中剩余的复合物摩尔数为 $x^{(i-1)} V_0 - x^{(i-1)} v_i = x^{(i-1)} V_0 (1 - v_i/V_0) = x^{(i-1)} V_0 (1-f_i)$。在步骤 $i$ 期间样品池中复合物摩尔数的净变化是最终量减去此剩余量：\n$$\\Delta N_{AB}^{(i)} = x^{(i)} V_0 - x^{(i-1)} V_0 (1 - f_i) = V_0 \\left( x^{(i)} - (1 - f_i) x^{(i-1)} \\right)$$\n\n因此，第 $i$ 次注射的热量为：\n$$q_i = \\Delta H \\cdot \\Delta N_{AB}^{(i)} = \\Delta H V_0 \\left( x^{(i)} - (1 - f_i) x^{(i-1)} \\right)$$\n\n**4. 模拟算法**\n\n通过对每次注射迭代应用上述步骤来模拟滴定曲线。\n\n- **初始化 ($i = 0$):**\n  - $v_0 = 0$\n  - $M^{(0)} = C_M V_0$\n  - $L^{(0)} = 0$\n  - $x^{(0)} = 0$\n  - 初始化一个空列表 `q_list` 用于存储热量值。\n\n- **迭代 (对于 $i=1, 2, ..., N_{injections}$):**\n  1. 获取注射体积 $v_i$。\n  2. 计算置换分数：$f_i = v_i / V_0$。\n  3. 更新抗体和抗原的总摩尔数：\n     $M^{(i)} = M^{(i-1)} (1 - f_i)$\n     $L^{(i)} = L^{(i-1)} (1 - f_i) + v_i C_s$\n  4. 更新总浓度：\n     $T_M^{(i)} = M^{(i)} / V_0$\n     $T_L^{(i)} = L^{(i)} / V_0$\n  5. 通过解二次方程计算新的平衡复合物浓度 $x^{(i)}$。\n  6. 计算当前注射的热量：$q_i = \\Delta H V_0 \\left( x^{(i)} - (1 - f_i) x^{(i-1)} \\right)$。\n  7. 将 $q_i$ 追加到 `q_list`。\n  8. 为下一次迭代更新状态：$M^{(i)}$ 成为新的 $M^{(i-1)}$，$L^{(i)}$ 成为新的 $L^{(i-1)}$，以及 $x^{(i)}$ 成为新的 $x^{(i-1)}$。\n\n对每个指定测试用例中的所有注射重复此过程，以生成所需的滴定曲线。", "answer": "[[-1.748616, -1.746973, -1.745129, -1.743048, -1.74068, -1.73796, -1.734808, -1.73112, -1.726757, -1.721535], [-0.999333, -0.998666, -0.998, -0.997332, -0.996664, -0.995995, -0.995325, -0.994655, -0.993984, -0.993312], [-0.007621, -0.010143, -0.012586, -0.014925, -0.017135, -0.019196, -0.021087, -0.022797, -0.024317, -0.025642], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]", "id": "5092675"}]}