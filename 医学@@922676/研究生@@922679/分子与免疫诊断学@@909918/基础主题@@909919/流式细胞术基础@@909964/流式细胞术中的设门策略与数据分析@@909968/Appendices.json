{"hands_on_practices": [{"introduction": "在多色流式细胞术中，一个核心挑战是荧光探针的光谱会泄漏到相邻的检测通道中，这种现象称为“光谱重叠”。本练习将引导你手动执行荧光补偿计算，通过求解一个线性混合模型来恢复真实的荧光信号。这个过程能帮助你深入理解补偿的数学原理，而不是仅仅将其视为软件中的一个“黑箱”操作。[@problem_id:5118188]", "problem": "一个单细胞事件已通过前向和侧向散射进行预设门分析，以排除碎片、双联体和死细胞。该事件是$3$色免疫分型panel的一部分，其中通道之间的光谱溢出已使用单染对照进行了表征。设测量的、经背景校正的荧光强度（单位为任意荧光单位(AFU)）为列向量 $y \\in \\mathbb{R}^3$，并设溢出矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$ 通过线性混合模型 $y = S x$ 将真实的荧光团信号 $x \\in \\mathbb{R}^3$ 映射到测量值。给定\n$$\nS=\\begin{bmatrix}\n1  & 0.15 & 0.03\\\\\n0.05 & 1 & 0.10\\\\\n0.02 & 0.04 & 1\n\\end{bmatrix},\\qquad\ny=\\begin{pmatrix}\n10^4\\\\\n5\\times 10^3\\\\\n2\\times 10^3\n\\end{pmatrix}.\n$$\n从基本的线性混合定义和标准线性代数出发，确定此事件的补偿后荧光向量 $x \\in \\mathbb{R}^3$。然后，通过说明每个通道是高于还是低于其阈值，定性地解释补偿后的值与固定的阳性门 $t=(t_1,t_2,t_3)$ 的关系，其中 $t_1=8.0\\times 10^3$ AFU, $t_2=3.0\\times 10^3$ AFU, 以及 $t_3=1.0\\times 10^3$ AFU。报告数值向量 $x$，其每个元素四舍五入到四位有效数字。以AFU为单位表示补偿后的值。", "solution": "问题陈述经评估有效。它提出了一个流式细胞术数据分析中的标准、定义明确的问题，特别是荧光补偿。该问题在科学上基于光谱溢出的线性混合模型，提供了一套完整的数值数据，并且是适定的，因为给定的溢出矩阵是可逆的，这保证了唯一且有意义的解的存在。\n\n问题的核心在于测量的荧光强度 $y \\in \\mathbb{R}^3$ 与真实的（补偿后的）荧光团信号 $x \\in \\mathbb{R}^3$ 之间的线性关系。这种关系由矩阵方程描述：\n$$ y = S x $$\n这里，$S \\in \\mathbb{R}^{3 \\times 3}$ 是溢出矩阵，它量化了每个荧光团的荧光泄漏到其他检测器中的程度。给定的值为：\n$$ S=\\begin{bmatrix} 1  & 0.15 & 0.03\\\\ 0.05 & 1 & 0.10\\\\ 0.02 & 0.04 & 1 \\end{bmatrix},\\qquad y=\\begin{pmatrix} 1 \\times 10^4\\\\ 5 \\times 10^3\\\\ 2 \\times 10^3 \\end{pmatrix} $$\n为了找到补偿后的荧光向量 $x$，我们必须求解这个关于 $x$ 的线性方程组。这可以通过在方程两边左乘溢出矩阵的逆矩阵 $S^{-1}$ 来实现：\n$$ S^{-1}y = S^{-1}(S x) $$\n$$ S^{-1}y = (S^{-1}S) x $$\n$$ S^{-1}y = I x $$\n$$ x = S^{-1} y $$\n其中 $I$ 是 $3 \\times 3$ 的单位矩阵。第一步是计算 $S$ 的逆矩阵。矩阵 $S$ 的逆由公式 $S^{-1} = \\frac{1}{\\det(S)}\\text{adj}(S)$ 给出，其中 $\\det(S)$ 是 $S$ 的行列式，$\\text{adj}(S)$ 是 $S$ 的伴随矩阵。\n\n首先，我们计算 $S$ 的行列式：\n$$ \\det(S) = 1(1 \\cdot 1 - 0.10 \\cdot 0.04) - 0.15(0.05 \\cdot 1 - 0.10 \\cdot 0.02) + 0.03(0.05 \\cdot 0.04 - 1 \\cdot 0.02) $$\n$$ \\det(S) = 1(1 - 0.004) - 0.15(0.05 - 0.002) + 0.03(0.002 - 0.02) $$\n$$ \\det(S) = 1(0.996) - 0.15(0.048) + 0.03(-0.018) $$\n$$ \\det(S) = 0.996 - 0.0072 - 0.00054 = 0.98826 $$\n由于 $\\det(S) \\neq 0$，该矩阵是可逆的。\n\n接下来，我们求 $S$ 的伴随矩阵，它是其代数余子式矩阵的转置。代数余子式矩阵 $C$ 是：\n$$ C = \\begin{pmatrix} +\\begin{vmatrix} 1  & 0.10 \\\\ 0.04 & 1 \\end{vmatrix}  & -\\begin{vmatrix} 0.05 & 0.10 \\\\ 0.02 & 1 \\end{vmatrix}  & +\\begin{vmatrix} 0.05 & 1 \\\\ 0.02 & 0.04 \\end{vmatrix} \\\\ -\\begin{vmatrix} 0.15 & 0.03 \\\\ 0.04 & 1 \\end{vmatrix}  & +\\begin{vmatrix} 1 & 0.03 \\\\ 0.02 & 1 \\end{vmatrix}  & -\\begin{vmatrix} 1 & 0.15 \\\\ 0.02 & 0.04 \\end{vmatrix} \\\\ +\\begin{vmatrix} 0.15 & 0.03 \\\\ 1 & 0.10 \\end{vmatrix}  & -\\begin{vmatrix} 1 & 0.03 \\\\ 0.05 & 0.10 \\end{vmatrix}  & +\\begin{vmatrix} 1 & 0.15 \\\\ 0.05 & 1 \\end{vmatrix} \\end{pmatrix} $$\n$$ C = \\begin{pmatrix} 0.996  & -0.048 & -0.018 \\\\ -0.1488 & 0.9994 & -0.037 \\\\ -0.015 & -0.0985 & 0.9925 \\end{pmatrix} $$\n伴随矩阵是 $\\text{adj}(S) = C^T$：\n$$ \\text{adj}(S) = \\begin{pmatrix} 0.996  & -0.1488 & -0.015 \\\\ -0.048 & 0.9994 & -0.0985 \\\\ -0.018 & -0.037 & 0.9925 \\end{pmatrix} $$\n现在我们可以通过计算 $x = \\frac{1}{\\det(S)}\\text{adj}(S)y$ 来求出 $x$：\n$$ x = \\frac{1}{0.98826} \\begin{pmatrix} 0.996  & -0.1488 & -0.015 \\\\ -0.048 & 0.9994 & -0.0985 \\\\ -0.018 & -0.037 & 0.9925 \\end{pmatrix} \\begin{pmatrix} 10000 \\\\ 5000 \\\\ 2000 \\end{pmatrix} $$\n首先，我们执行矩阵-向量乘法：\n$$ \\text{adj}(S)y = \\begin{pmatrix} 0.996(10000) - 0.1488(5000) - 0.015(2000) \\\\ -0.048(10000) + 0.9994(5000) - 0.0985(2000) \\\\ -0.018(10000) - 0.037(5000) + 0.9925(2000) \\end{pmatrix} = \\begin{pmatrix} 9960 - 744 - 30 \\\\ -480 + 4997 - 197 \\\\ -180 - 185 + 1985 \\end{pmatrix} = \\begin{pmatrix} 9186 \\\\ 4320 \\\\ 1620 \\end{pmatrix} $$\n最后，我们乘以标量 $\\frac{1}{0.98826}$：\n$$ x = \\begin{pmatrix} 9186 / 0.98826 \\\\ 4320 / 0.98826 \\\\ 1620 / 0.98826 \\end{pmatrix} \\approx \\begin{pmatrix} 9295.346... \\\\ 4371.416... \\\\ 1639.244... \\end{pmatrix} $$\n按照要求将每个元素四舍五入到四位有效数字，我们得到补偿后的荧光向量 $x$：\n$$ x \\approx \\begin{pmatrix} 9295 \\\\ 4371 \\\\ 1639 \\end{pmatrix} \\text{ AFU} $$\n最后一步是根据给定的阳性门 $t = (t_1, t_2, t_3)$ 来解释这些补偿值，其中 $t_1=8.0 \\times 10^3 = 8000$ AFU，$t_2=3.0 \\times 10^3 = 3000$ AFU，以及 $t_3=1.0 \\times 10^3 = 1000$ AFU。我们将 $x$ 的每个分量与其对应的阈值 $t_i$ 进行比较：\n\\begin{itemize}\n    \\item 对于通道1：$x_1 \\approx 9295$ AFU，大于 $t_1 = 8000$ AFU。因此该通道**高于**其阈值。\n    \\item 对于通道2：$x_2 \\approx 4371$ AFU，大于 $t_2 = 3000$ AFU。因此该通道**高于**其阈值。\n    \\item 对于通道3：$x_3 \\approx 1639$ AFU，大于 $t_3 = 1000$ AFU。因此该通道**高于**其阈值。\n\\end{itemize}\n定性地，此单细胞事件被认为对所有三种标记物均为阳性，可分类为三阳性事件。", "answer": "$$\n\\boxed{\\begin{pmatrix} 9.295 \\times 10^3 \\\\ 4.371 \\times 10^3 \\\\ 1.639 \\times 10^3 \\end{pmatrix}}\n$$", "id": "5118188"}, {"introduction": "确定一个细胞群体是否为某个标记的“阳性”是流式数据分析的关键步骤。本练习将向你展示如何利用“荧光减一”(FMO)对照组，通过统计学方法来设定一个客观的阳性阈值。你将学习如何将设门问题转化为一个控制假阳性率的统计假设检验问题，从而建立起可重复且有统计学依据的分析流程。[@problem_id:5118162]", "problem": "正在开发一种流式细胞术检测方法，用于定量外周血单个核细胞上的一种低丰度表面标志物。为了控制非特异性信号，您为感兴趣的标志物收集了一个FMO（Fluorescence Minus One）对照。根据经验，在FMO条件下，测得的荧光强度$I$（单位为任意荧光单位，AFU）的对数，记为 $Y = \\ln(I)$，可以很好地用高斯分布来近似，具体为 $Y \\sim \\mathcal{N}(\\mu, \\sigma^{2})$。您使用最大似然估计从 $n = 10{,}000$ 个事件中拟合得到了参数 $ \\mu = 2.3 $ 和 $ \\sigma = 0.5 $。\n\n定义一个阳性门，如果一个事件的强度 $I$ 超过阈值 $T$，则该事件被判定为“阳性”。您希望选择 $T$ 以在FMO条件下达到一个目标假阳性率 (FPR)，记为 $ \\alpha $。取 $ \\alpha = 0.01 $。\n\n仅使用累积分布函数和分位数的基本定义，以及假设检验中I类错误的定义，推导出当 $Y = \\ln(I)$ 在FMO对照下呈高斯分布时，$T$ 关于 $\\mu$、$\\sigma$ 和 $\\alpha$ 的解析表达式。然后，使用给定的参数 $ \\mu = 2.3 $、$ \\sigma = 0.5 $ 和 $ \\alpha = 0.01 $ 计算 $T$ 的数值。将您的最终数值答案四舍五入到四位有效数字。以任意荧光单位 (AFU) 表示该门控阈值。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 第1步：提取已知条件\n题目陈述中明确给出的数据和条件如下：\n- 测得的荧光强度的对数为 $Y = \\ln(I)$，其中 $I$ 是以任意荧光单位 (AFU) 表示的强度。\n- 在FMO（Fluorescence Minus One）条件下，$Y$ 服从高斯（正态）分布：$Y \\sim \\mathcal{N}(\\mu, \\sigma^{2})$。\n- 拟合参数为 $\\mu = 2.3$ 和 $\\sigma = 0.5$。\n- 这些参数是从 $n = 10,000$ 个事件中估计得出的。\n- 阳性门的定义条件是：如果一个事件的强度 $I$ 超过阈值 $T$，即 $I > T$，则该事件为“阳性”。\n- 目标假阳性率 (FPR) 为 $\\alpha = 0.01$。\n- 任务是推导 $T$ 关于 $\\mu$、$\\sigma$ 和 $\\alpha$ 的解析表达式。\n- 任务还包括计算给定参数下 $T$ 的数值。\n- 最终数值答案必须四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地建立在生物统计学和流式细胞术数据分析的原则之上。FMO对照是多色流式细胞术中设定门控的标准且必要的工具。将对数转换后的荧光强度建模为高斯分布是一种常见且经过经验验证的近似方法。使用假阳性率来定义门控阈值是应用于该领域的统计假设检验中的一个基本概念。该问题在科学上是合理的。\n- **适定性：** 该问题提供了一个明确的目标（求 $T$）、所有必需的参数（$\\mu$、$\\sigma$、$\\alpha$）、相关变量（$Y$）的分布形式，以及测量强度（$I$）与建模变量（$Y$）之间的关系。该问题是自洽的，并且可以推导出一个唯一、稳定且有意义的解。\n- **客观性：** 语言精确且定量。所有术语在统计学和流式细胞术的背景下都有明确的定义。没有主观或模棱两可的陈述。\n- **其他缺陷：** 该问题没有表现出任何不完整、矛盾、不切实际或其他无效的迹象。所提供的数值对于这类实验是合理的。\n\n### 第3步：结论与行动\n该问题被认为是**有效的**。将提供完整解答。\n\n### 解题推导\n\n假阳性率 (FPR)，记为 $\\alpha$，定义为来自阴性对照群体（在本例中为FMO对照）的事件被错误地分类为“阳性”的概率。在假设检验的背景下，这是一个I类错误，其中原假设是事件属于FMO群体。\n\n如果一个事件的强度 $I$ 超过阈值 $T$，它就被分类为阳性。因此，FPR在数学上表示为：\n$$\n\\alpha = P(I > T | \\text{event is from FMO population})\n$$\n\n问题陈述，对于FMO群体，对数转换后的强度 $Y = \\ln(I)$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布：\n$$\nY \\sim \\mathcal{N}(\\mu, \\sigma^2)\n$$\n\n我们必须将关于强度 $I$ 的条件转换为关于对数转换变量 $Y$ 的条件。由于自然对数函数 $\\ln(x)$ 对于 $x > 0$ 是一个严格单调递增的函数（且强度 $I$ 必须为正），不等式 $I > T$ 等价于 $\\ln(I) > \\ln(T)$。\n$$\nI > T \\iff \\ln(I) > \\ln(T) \\iff Y > \\ln(T)\n$$\n\n将此代入 $\\alpha$ 的表达式，我们得到：\n$$\n\\alpha = P(Y > \\ln(T))\n$$\n\n为了计算这个概率，我们对正态随机变量 $Y$ 进行标准化。设 $Z$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。$Y$ 的标准化由下式给出：\n$$\nZ = \\frac{Y - \\mu}{\\sigma}\n$$\n\n我们可以用 $Z$ 来表示不等式 $Y > \\ln(T)$：\n$$\nY > \\ln(T) \\implies \\frac{Y - \\mu}{\\sigma} > \\frac{\\ln(T) - \\mu}{\\sigma} \\implies Z > \\frac{\\ln(T) - \\mu}{\\sigma}\n$$\n\n所以，$\\alpha$ 的表达式变为：\n$$\n\\alpha = P\\left(Z > \\frac{\\ln(T) - \\mu}{\\sigma}\\right)\n$$\n\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数 (CDF)，定义为 $\\Phi(z) = P(Z \\le z)$。$Z$ 超过某一值的概率由CDF的补给出：$P(Z > z) = 1 - P(Z \\le z) = 1 - \\Phi(z)$。\n\n将此应用于我们关于 $\\alpha$ 的表达式：\n$$\n\\alpha = 1 - \\Phi\\left(\\frac{\\ln(T) - \\mu}{\\sigma}\\right)\n$$\n\n我们现在求解阈值 $T$。首先，我们分离出CDF项：\n$$\n\\Phi\\left(\\frac{\\ln(T) - \\mu}{\\sigma}\\right) = 1 - \\alpha\n$$\n\n为了解出 $\\Phi$ 的自变量，我们应用反CDF，也称为分位数函数，记为 $\\Phi^{-1}$。值 $\\Phi^{-1}(p)$ 是分位数 $z_p$，使得 $P(Z \\le z_p) = p$。\n$$\n\\frac{\\ln(T) - \\mu}{\\sigma} = \\Phi^{-1}(1 - \\alpha)\n$$\n\n现在，我们用代数方法解出 $T$：\n$$\n\\ln(T) - \\mu = \\sigma \\Phi^{-1}(1 - \\alpha)\n$$\n$$\n\\ln(T) = \\mu + \\sigma \\Phi^{-1}(1 - \\alpha)\n$$\n对两边取以 $e$ 为底的指数，得到 $T$ 的最终解析表达式：\n$$\nT = \\exp\\left(\\mu + \\sigma \\Phi^{-1}(1 - \\alpha)\\right)\n$$\n这就是门控阈值 $T$ 关于 $\\mu$、$\\sigma$ 和 $\\alpha$ 的解析表达式。\n\n### 数值计算\n\n我们已知以下参数值：\n- $\\mu = 2.3$\n- $\\sigma = 0.5$\n- $\\alpha = 0.01$\n\n我们需要计算 $T$。首先，我们计算分位数项 $\\Phi^{-1}(1 - \\alpha)$。\n$$\n1 - \\alpha = 1 - 0.01 = 0.99\n$$\n我们需要找到值 $z$ 使得 $\\Phi(z) = 0.99$。这是标准正态分布的第$99$百分位数。从标准统计表或计算软件中，可以查到这个值大约是：\n$$\n\\Phi^{-1}(0.99) \\approx 2.326348\n$$\n\n现在我们将这个值和给定的参数代入我们推导出的 $T$ 的公式中：\n$$\nT = \\exp(2.3 + 0.5 \\times \\Phi^{-1}(0.99))\n$$\n$$\nT \\approx \\exp(2.3 + 0.5 \\times 2.326348)\n$$\n$$\nT \\approx \\exp(2.3 + 1.163174)\n$$\n$$\nT \\approx \\exp(3.463174)\n$$\n$$\nT \\approx 31.91696\n$$\n\n题目要求将最终数值答案四舍五入到四位有效数字。\n$31.91696...$ 的前四位有效数字是 $3$、$1$、$9$ 和 $1$。第五位数字是 $6$，大于或等于 $5$，所以我们将第四位数字向上舍入。\n$$\nT \\approx 31.92\n$$\n阈值 $T$ 的单位与强度 $I$ 的单位相同，即任意荧光单位 (AFU)。", "answer": "$$\n\\boxed{31.92}\n$$", "id": "5118162"}, {"introduction": "当我们在高维流式实验（如无监督聚类分析）中同时检验成百上千个假设时，传统的$p$值阈值会导致大量的假阳性发现。本练习将引导你推导并应用Benjamini-Hochberg程序，这是一种控制伪发现率（FDR）的强大统计方法。通过这个实践，你将掌握在高通量数据分析中保持统计严谨性的关键技能，避免得出错误的生物学结论。[@problem_id:5118169]", "problem": "一项高参数流式细胞术 (FC) 实验被用于量化疾病队列与匹配的健康对照组之间外周血单个核细胞的表型变化。实验采用了标准的圈门策略：首先通过前向散射面积 ($\\text{FSC-A}$) 与侧向散射面积 ($\\text{SSC-A}$) 对细胞进行圈门，以选择单细胞并排除细胞碎片；接着使用前向散射高度 ($\\text{FSC-H}$) 与前向散射宽度 ($\\text{FSC-W}$) 移除双联体细胞；最后使用活性染料排除死细胞。在活单细胞门内，谱系标记定义了大的细胞群体，并对剩余的异质性应用无监督聚类算法，产生了 $m = 16$ 个非重叠的聚类。对于每个聚类，使用双样本 Wilcoxon 秩和检验比较疾病组和对照组之间的相对丰度，产生 $m$ 个独立的 $p$-值。\n\n从错误发现率 (FDR) 的定义（即所有拒绝中错误拒绝的期望比例）以及在原假设为真时 $p$-值随机劣于 [0,1] 上的均匀分布这一性质出发，推导出一个在 $p$-值独立的情况下，将 FDR 控制在用户指定水平 $q$ 的升阶多重检验拒绝法则。然后，在 $q = 0.1$ 的条件下，将此法则应用于以下这组 $p$-值（每个 $p$-值对应一个聚类比较，按任意顺序列出）：\n$0.036$, $0.41$, $0.003$, $0.11$, $0.0008$, $0.055$, $0.078$, $0.019$, $0.61$, $0.88$, $0.32$, $0.042$, $0.0075$, $0.012$, $0.21$, $0.068$。\n\n报告在将 FDR 控制在水平 $q = 0.1$ 后，仍然显著的聚类差异的数量。最终答案必须是单个实数值。不要包含任何单位。无需四舍五入。", "solution": "该问题首先要求推导一个控制错误发现率 (FDR) 的多重检验校正程序，其次要求将该程序应用于一组来自流式细胞术实验的给定p值。该问题在科学上是合理的、自洽的且提法恰当的。\n\n首先，我们推导 Benjamini-Hochberg (BH) 升阶程序。\n假设有 $m$ 个原假设 $H_1, H_2, \\ldots, H_m$，以及对应的p值 $p_1, p_2, \\ldots, p_m$。我们假设这些p值是独立的。\n设 $m_0$ 是为真的原假设的数量，该值未知。剩下的 $m_1 = m - m_0$ 个假设是错误的（即备择假设为真）。\n设 $R$ 是被拒绝的假设总数（发现数）。设 $V$ 是被错误拒绝的为真的原假设的数量（错误发现数）。\n错误发现比例 (FDP) 定义为，当 $R>0$ 时 $Q = V/R$，当 $R=0$ 时 $Q=0$。\n错误发现率 (FDR) 是 FDP 的期望值：$FDR = E[Q]$。\n目标是设计一个程序，保证对于用户指定的水平 $q \\in (0,1)$，有 $FDR \\le q$。\n\nBenjamini-Hochberg (BH) 程序如下：\n1.  将 $m$ 个p值从小到大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。\n2.  找到从 $1$ 到 $m$ 的最大整数 $k$，使得 $p_{(k)} \\le \\frac{k}{m}q$。\n3.  如果存在这样的 $k$，则拒绝所有原假设 $H_{(i)}$，其中 $i=1, \\dots, k$。\n4.  如果不存在这样的 $k$，则不拒绝任何原假设。\n\n现在我们来推导为什么这个程序能将 FDR 控制在期望的水平 $q$。证明将表明，在p值相互独立的假设下，$FDR \\le \\frac{m_0}{m}q$，由于 $m_0 \\le m$，其上界为 $q$。\n\n设 $I_0$ 是对应于 $m_0$ 个为真的原假设的索引集合。对于任何 $i \\in I_0$，对应的p值 $p_i$ 随机劣于 [0,1] 上的均匀分布，这意味着对于任何 $\\alpha \\in [0,1]$，都有 $P(p_i \\le \\alpha) \\le \\alpha$。对于连续的检验统计量，这成为一个等式，$P(p_i \\le \\alpha) = \\alpha$。为简单起见，我们将使用等式，并注意到最终结果在不等式的情况下仍然成立。\n\n设 $k$ 是由 BH 程序决定的被拒绝假设数量的随机变量。拒绝的总数是 $R=k$。\n错误发现的数量是 $V = \\sum_{i \\in I_0} \\mathbb{I}(H_i \\text{ is rejected})$，其中 $\\mathbb{I}(\\cdot)$ 是指示函数。如果一个假设 $H_i$ 的 p值 $p_i$ 小于或等于由第 $k$ 个有序p值 $p_{(k)}$ 设定的阈值，则该假设被拒绝。因此，$V = \\sum_{i \\in I_0} \\mathbb{I}(p_i \\le p_{(k)})$。\n\n根据程序的定义，我们有 $p_{(k)} \\le \\frac{k}{m}q$。这意味着 $k \\ge \\frac{m}{q}p_{(k)}$。\n我们可以写出 FDP，$Q = V/R = V/k$。\n$$Q = \\frac{V}{k} = \\frac{\\sum_{i \\in I_0} \\mathbb{I}(p_i \\le p_{(k)})}{k} \\le \\frac{\\sum_{i \\in I_0} \\mathbb{I}(p_i \\le \\frac{kq}{m})}{k}$$\n不等式成立，因为与一个较大的阈值 ($kq/m$) 相比，一个较小的阈值 ($p_{(k)}$) 只可能导致计数事件的数量相等或更少。\n\n现在，我们取期望。我们可以使用全期望定律，以 $k$ 的值为条件。\n$$FDR = E[Q] = E\\left[ E[Q | k] \\right] \\le E\\left[ E\\left[ \\frac{\\sum_{i \\in I_0} \\mathbb{I}(p_i \\le kq/m)}{k} \\Big| k \\right] \\right]$$\n根据期望的线性性，\n$$E\\left[ \\frac{\\sum_{i \\in I_0} \\mathbb{I}(p_i \\le kq/m)}{k} \\Big| k \\right] = \\frac{1}{k} \\sum_{i \\in I_0} E[\\mathbb{I}(p_i \\le kq/m) | k]$$\n这是一个关键步骤。事件 $\\{k=j\\}$ 是由所有 $m$ 个p值的值决定的。然而，在p值独立的假设下，对 $k$ 的条件化不会改变来自为真的原假设的p值 $p_i$ 的边缘分布。因此，对于 $i \\in I_0$：\n$$E[\\mathbb{I}(p_i \\le kq/m) | k] = P(p_i \\le kq/m) = \\frac{kq}{m}$$\n对 $m_0$ 个为真的原假设求和，得到：\n$$\\sum_{i \\in I_0} E[\\mathbb{I}(p_i \\le kq/m) | k] = m_0 \\frac{kq}{m}$$\n将此代回，$Q$ 的一个上界的条件期望是：\n$$E\\left[ \\frac{\\sum_{i \\in I_0} \\mathbb{I}(p_i \\le kq/m)}{k} \\Big| k \\right] = \\frac{1}{k} \\left( m_0 \\frac{kq}{m} \\right) = \\frac{m_0 q}{m}$$\n这个上界是一个不依赖于 $k$ 值的常数。\n取最终期望，我们得到：\n$$FDR = E[Q] \\le E\\left[\\frac{m_0 q}{m}\\right] = \\frac{m_0 q}{m}$$\n由于为真的原假设数量 $m_0$ 不能超过检验总数 $m$，我们有 $\\frac{m_0}{m} \\le 1$。因此，我们成功地证明了该程序控制了错误发现率：\n$$FDR \\le q$$\n推导到此完成。\n\n接下来，我们将此程序应用于所提供的数据。\n检验的数量是 $m=16$。\n期望的 FDR 水平是 $q=0.1$。\n$m=16$ 个p值的集合是：\n$\\{0.036, 0.41, 0.003, 0.11, 0.0008, 0.055, 0.078, 0.019, 0.61, 0.88, 0.32, 0.042, 0.0075, 0.012, 0.21, 0.068\\}$。\n\n步骤 1：对p值 $p_{(i)}$进行排序。\n$p_{(1)}=0.0008$\n$p_{(2)}=0.003$\n$p_{(3)}=0.0075$\n$p_{(4)}=0.012$\n$p_{(5)}=0.019$\n$p_{(6)}=0.036$\n$p_{(7)}=0.042$\n$p_{(8)}=0.055$\n$p_{(9)}=0.068$\n$p_{(10)}=0.078$\n$p_{(11)}=0.11$\n$p_{(12)}=0.21$\n$p_{(13)}=0.32$\n$p_{(14)}=0.41$\n$p_{(15)}=0.61$\n$p_{(16)}=0.88$\n\n步骤 2：找到满足 $p_{(k)} \\le \\frac{k}{m}q$ 的最大秩 $k$。\n秩 $i$ 的阈值是 $\\frac{i}{16} \\times 0.1$。\n\n对于 $i=1$：$p_{(1)} = 0.0008$。阈值：$\\frac{1}{16} \\times 0.1 = 0.00625$。条件 $0.0008 \\le 0.00625$ 满足。\n对于 $i=2$：$p_{(2)} = 0.003$。阈值：$\\frac{2}{16} \\times 0.1 = 0.0125$。条件 $0.003 \\le 0.0125$ 满足。\n对于 $i=3$：$p_{(3)} = 0.0075$。阈值：$\\frac{3}{16} \\times 0.1 = 0.01875$。条件 $0.0075 \\le 0.01875$ 满足。\n对于 $i=4$：$p_{(4)} = 0.012$。阈值：$\\frac{4}{16} \\times 0.1 = 0.025$。条件 $0.012 \\le 0.025$ 满足。\n对于 $i=5$：$p_{(5)} = 0.019$。阈值：$\\frac{5}{16} \\times 0.1 = 0.03125$。条件 $0.019 \\le 0.03125$ 满足。\n对于 $i=6$：$p_{(6)} = 0.036$。阈值：$\\frac{6}{16} \\times 0.1 = 0.0375$。条件 $0.036 \\le 0.0375$ 满足。\n对于 $i=7$：$p_{(7)} = 0.042$。阈值：$\\frac{7}{16} \\times 0.1 = 0.04375$。条件 $0.042 \\le 0.04375$ 满足。\n对于 $i=8$：$p_{(8)} = 0.055$。阈值：$\\frac{8}{16} \\times 0.1 = 0.05$。条件 $0.055 \\le 0.05$ 不满足。\n\n满足该条件的最大 $i$ 值为 $k=7$。\n根据 BH 程序，我们拒绝原假设 $H_{(1)}, H_{(2)}, \\ldots, H_{(7)}$。\n因此，在将 FDR 控制在水平 $q=0.1$ 后，仍然显著的聚类差异数量为 $7$。", "answer": "$$\\boxed{7}$$", "id": "5118169"}]}