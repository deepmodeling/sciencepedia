{"hands_on_practices": [{"introduction": "理解遗传病在人群中的患病率是公共卫生和遗传筛查策略的基石。Hardy-Weinberg平衡定律提供了一个数学模型，用于在特定条件下根据等位基因频率估算基因型频率。本练习将从第一性原理出发，巩固群体遗传学的基本逻辑，使您能够计算给定人群中常染色体隐性遗传病的基线风险。[@problem_id:4456426]", "problem": "一家母胎医学诊所正计划对一种影响妇科健康的常染色体隐性遗传病进行基于人群的携带者筛查。考虑一个具有两个等位基因的常染色体基因座：一个正常等位基因和一个致病等位基因。设致病等位基因的种群频率为 $q$，并假设该常染色体隐性表型为完全外显。仅使用等位基因频率的基本定义和二倍体物种中配子随机结合的原理，推导从该人群中随机选择的一名育龄女性患有该疾病的概率。将最终答案表示为关于 $q$ 的闭式解析表达式，无需四舍五入。此外，在不使用任何快捷公式的情况下，为该推导在 Hardy-Weinberg 平衡 (HWE) 下的妇产科背景中有效的所需假设提供严谨的论证。", "solution": "问题要求在已知致病等位基因的种群频率的情况下，推导一名随机选择的女性患有某种常染色体隐性遗传病的概率。推导必须基于第一性原理，并且模型背后的假设必须在指定的临床背景下得到严谨的论证。\n\n设该常染色体基因座有两个等位基因。我们将正常等位基因记为 $A$，致病等位基因记为 $a$。问题指出，致病等位基因 $a$ 的种群频率为 $q$。由于该基因座只有这两个等位基因，它们的频率之和必须等于 $1$。设正常等位基因 $A$ 的频率为 $p$。因此，我们有以下关系：\n$$p + q = 1$$\n由此，正常等位基因的频率可以用 $q$ 表示为 $p = 1 - q$。\n\n推导过程通过考虑种群基因库中配子（精子和卵细胞）随机结合形成二倍体个体的过程来进行。这一原理是 Hardy-Weinberg 平衡 (HWE) 模型的基石。我们假设等位基因频率 $p$ 和 $q$ 在雄性配子库和雌性配子库中是相同的。\n\n个体的基因型是由一个来自父方配子的等位基因和一个来自母方配子的等位基因结合而成的。一个配子携带特定等位基因的概率等于该等位基因在种群中的频率。\n- 抽取一个携带等位基因 $A$ 的配子的概率是 $p$。\n- 抽取一个携带等位基因 $a$ 的配子的概率是 $q$。\n\n假设父方和母方配子的选择是独立事件，我们可以计算下一代合子中三种可能基因型（$AA$、$Aa$ 和 $aa$）的概率，这些概率对应于它们的期望频率：\n\n1.  **纯合正常基因型 ($AA$)：** 该基因型由一个携带等位基因 $A$ 的精子和一个携带等位基因 $A$ 的卵细胞融合产生。此事件的概率是各个独立概率的乘积：\n    $$P(AA) = P(\\text{父方等位基因为 } A) \\times P(\\text{母方等位基因为 } A) = p \\times p = p^2$$\n\n2.  **杂合基因型 ($Aa$)：** 该基因型可以通过两种互斥的方式形成：\n    a) 带有等位基因 $A$ 的精子使带有等位基因 $a$ 的卵细胞受精。概率为 $p \\times q$。\n    b) 带有等位基因 $a$ 的精子使带有等位基因 $A$ 的卵细胞受精。概率为 $q \\times p$。\n    形成杂合个体的总概率是这两个事件的概率之和：\n    $$P(Aa) = (p \\times q) + (q \\times p) = 2pq$$\n\n3.  **纯合致病基因型 ($aa$)：** 该基因型由一个携带等位基因 $a$ 的精子和一个携带等位基因 $a$ 的卵细胞融合产生。其概率为：\n    $$P(aa) = P(\\text{父方等位基因为 } a) \\times P(\\text{母方等位基因为 } a) = q \\times q = q^2$$\n\n这些基因型频率之和必须为 $1$：$p^2 + 2pq + q^2 = (p+q)^2 = 1^2 = 1$。\n\n问题指出该疾病是常染色体隐性遗传且完全外显。\n- **常染色体隐性**意味着个体必须拥有两个致病等位基因（基因型为 $aa$）才会表现出该表型。基因型为 $AA$ 或 $Aa$ 的个体在表型上不受影响。\n- **完全外显**意味着 $100\\%$ 具有易感基因型（$aa$）的个体都会表现出该疾病。\n\n因此，从该人群中随机选择一个个体患有该疾病的概率等于 $aa$ 基因型的频率。\n$$P(\\text{患病}) = P(aa) = q^2$$\n该推导得出的是受孕时患病合子的频率。问题要求的是“育龄女性”的概率。这需要假设从受孕到育龄期间，不存在针对 $aa$ 基因型的选择压力，这一点将在下文讨论。\n\n上述推导依赖于 Hardy-Weinberg 平衡的假设。在妇产科进行人群筛查的背景下，对这些假设的严谨论证如下：\n\n1.  **随机交配 (Panmixia)：** 该模型假设个体在选择配偶时不考虑其在该特定基因座上的基因型。对于一种携带者（$Aa$）表型正常的隐性遗传病，未来的父母通常不知道彼此的携带者状态。因此，相对于该基因座的交配实际上是随机的。除非存在显著的选择性交配（例如，由于分层种群中的共同祖先或患者优先与其他患者交配）或近亲结婚，否则此假设成立。选择性交配或近亲结婚会使隐性遗传病的发病率高于基线 $q^2$。对于一个大型、普遍的人群筛查项目，随机交配是一个合理的起始假设。\n\n2.  **无自然选择：** 该假设假定所有基因型（$AA$、$Aa$、$aa$）具有相同的生存率和繁殖率。对于一种“影响妇科健康”的疾病，必须仔细评估这一假设。如果该疾病在育龄前导致死亡，那么该年龄段患病女性的频率将低于受孕频率 $q^2$。然而，影响妇科健康的疾病（例如，导致原发性闭经、解剖学异常或不孕不育）不一定影响存活至育龄。在这种情况下，育龄女性中患病个体的频率可以由 $q^2$ 精确近似。选择压力会作用于患病女性的*生殖适应度*，这会影响后续几代的等位基因频率，但不会影响在观察年龄时的患病率。因此，为了计算当前这一代成年人的患病率，假设没有生存差异通常是一种有效的简化。\n\n3.  **无突变：** 该模型假设等位基因频率 $p$ 和 $q$ 是稳定的，不会因新突变（例如，$A \\to a$ 或 $a \\to A$）而改变。自发突变率通常非常低，约为每基因座每代 $10^{-6}$ 到 $10^{-5}$ 的量级。如此低的速率对代际间的等位基因频率影响可以忽略不计，因此在临床风险计算中忽略突变是一种标准且有效的做法。\n\n4.  **大种群：** 假设种群足够大，以防止因随机抽样效应（一种称为遗传漂变的现象）导致的等位基因频率的随机变化。基于人群的筛查项目，顾名思义，适用于大种群（数万至数百万人）。在这样的大样本中，随机事件对整体等位基因频率的影响极小，使得这一假设非常稳健。\n\n5.  **无基因流（迁移）：** 此假设假定种群是封闭的，没有从其他可能具有不同等位基因频率的种群中引入等位基因。现代人类种群很少是完全隔离的。然而，对于 HWE 计算，“种群”通常是一个已定义的人口统计学或祖源群体，其等位基因频率 $q$ 已通过经验测量得出。如果筛查项目针对的是一个相对同质的种群，或者迁移率较低，或者迁入群体的等位基因频率相似，那么这个假设可以作为一个合理的近似。在高度混合的种群中，可能需要按血统对风险计算进行分层，以解释对该假设的违反。\n\n总而言之，通过假设在一个满足 Hardy-Weinberg 平衡条件的人群中配子随机结合，个体具有 $aa$ 基因型的概率为 $q^2$。鉴于常染色体隐性遗传和完全外显，这也是患病的概率。", "answer": "$$\\boxed{q^2}$$", "id": "4456426"}, {"introduction": "针对由*BRCA1*突变等引起的遗传性癌症综合征进行遗传咨询，是现代妇科肿瘤学的核心组成部分。此实践涉及应用孟德尔分离定律，并结合不完全外显和性别特异性外显率的概念。通过推导后代的终生癌症风险，您将练习整合多种遗传学原理，以提供精细化的个性风险评估，这是孕前和产前咨询中的一项关键技能。[@problem_id:4456383]", "problem": "一对夫妇前来寻求孕前遗传咨询。父母一方是乳腺癌1号基因（*BRCA1*）这一常染色体基因上一个已知致病性变异的杂合子。另一方经证实为非携带者。假设该变异的常染色体传递遵循孟德尔分离定律，无选择、母胎效应或新发突变。设 $p$ 表示携带者中临床相关的*BRCA1*相关癌症的基线终生外显率，定义为在没有环境和多基因修饰因子的情况下，携带者因该变异在一生中发展出聚合癌症表型的概率。由于已知*BRCA1*相关的外显率因性别而异，将性别特异性外显率建模为相对于 $p$ 的乘法修饰因子：对于出生时指定为女性的个体为 $\\lambda_{\\mathrm{female}}$，对于出生时指定为男性的个体为 $\\lambda_{\\mathrm{male}}$，因此携带者的性别特异性外显率分别为 $\\lambda_{\\mathrm{female}} p$ 或 $\\lambda_{\\mathrm{male}} p$。假设性别决定与等位基因传递相互独立，并且在给定性别的情况下，外显率与传递相互独立。\n\n设 $s$ 表示孩子出生时被指定为女性的概率（$1 - s$ 为被指定为男性的概率）。利用常染色体遗传原理和外显率的定义，从第一性原理推导出孩子在出生时（在知晓孩子性别之前）患上*BRCA1*相关癌症的预期终生风险的解析表达式。您的表达式必须仅用 $p$、$\\lambda_{\\mathrm{female}}$、$\\lambda_{\\mathrm{male}}$ 和 $s$ 来表示。提供最终表达式。如果您引入任何中间事件或概率，请明确定义它们。无需进行数值计算；提供一个闭式表达式。最终答案必须是单一的解析表达式。不要包含任何单位。", "solution": "该问题要求根据父母的遗传状况和外显率模型，推导孩子患上*BRCA1*相关癌症的预期终生风险的解析表达式。该问题具有科学依据，提法恰当且客观，因此被认为是有效的。\n\n我们首先定义与计算相关的事件。设 $A$ 为孩子在一生中患上*BRCA1*相关癌症的事件。设 $C$ 为孩子遗传了致病性*BRCA1*变异的事件，而 $NC$ 为孩子是非携带者的事件。设 $F$ 为孩子出生时被指定为女性的事件，而 $M$ 为孩子出生时被指定为男性的事件。\n\n问题陈述父母一方是致病性变异的杂合子，另一方是非携带者。该基因为常染色体基因。根据孟德尔分离定律，孩子从杂合子父母那里遗传到致病性等位基因的概率是 $\\frac{1}{2}$。因此，孩子成为携带者的概率是：\n$$ P(C) = \\frac{1}{2} $$\n孩子成为非携带者的概率是：\n$$ P(NC) = 1 - P(C) = \\frac{1}{2} $$\n\n问题给出孩子出生时被指定为女性的概率为变量 $s$。因此：\n$$ P(F) = s $$\n被指定为男性的概率是其补集：\n$$ P(M) = 1 - s $$\n\n问题陈述等位基因传递和性别决定是独立事件。因此，我们可以计算联合事件的概率：\n$$ P(C \\cap F) = P(C) P(F) = \\frac{1}{2} s $$\n$$ P(C \\cap M) = P(C) P(M) = \\frac{1}{2} (1 - s) $$\n$$ P(NC \\cap F) = P(NC) P(F) = \\frac{1}{2} s $$\n$$ P(NC \\cap M) = P(NC) P(M) = \\frac{1}{2} (1 - s) $$\n\n问题将外显率定义为携带者发展出癌症表型的概率。外显率是性别特异性的。基线外显率为 $p$，由因子 $\\lambda_{\\mathrm{female}}$ 和 $\\lambda_{\\mathrm{male}}$ 修饰。这些可以表示为条件概率：\n- 在孩子是女性携带者的条件下，患癌的概率是 $P(A | C \\cap F) = \\lambda_{\\mathrm{female}} p$。\n- 在孩子是男性携带者的条件下，患癌的概率是 $P(A | C \\cap M) = \\lambda_{\\mathrm{male}} p$。\n\n该问题涉及*BRCA1*相关癌症，在此问题背景下，这些癌症是由该致病性变异引起的。因此，非携带者患上这种特定的*BRCA1*相关癌症的概率为 $0$。\n$$ P(A | NC) = 0 $$\n这意味着 $P(A | NC \\cap F) = 0$ 且 $P(A | NC \\cap M) = 0$。\n\n为了求出孩子患癌的总概率 $P(A)$，我们使用全概率定律。我们将样本空间划分为四个互斥且穷尽的事件：$C \\cap F$、$C \\cap M$、$NC \\cap F$ 和 $NC \\cap M$。\n$$ P(A) = P(A | C \\cap F)P(C \\cap F) + P(A | C \\cap M)P(C \\cap M) + P(A | NC \\cap F)P(NC \\cap F) + P(A | NC \\cap M)P(NC \\cap M) $$\n\n将上面推导出的概率代入此方程：\n$$ P(A) = (\\lambda_{\\mathrm{female}} p) \\left( \\frac{1}{2} s \\right) + (\\lambda_{\\mathrm{male}} p) \\left( \\frac{1}{2} (1 - s) \\right) + (0) \\left( \\frac{1}{2} s \\right) + (0) \\left( \\frac{1}{2} (1 - s) \\right) $$\n\n现在，我们简化该表达式：\n$$ P(A) = \\frac{1}{2} s p \\lambda_{\\mathrm{female}} + \\frac{1}{2} (1 - s) p \\lambda_{\\mathrm{male}} $$\n\n提取公因子 $\\frac{1}{2}$ 和 $p$，得到孩子预期终生风险的最终解析表达式：\n$$ P(A) = \\frac{1}{2} p (s \\lambda_{\\mathrm{female}} + (1 - s) \\lambda_{\\mathrm{male}}) $$\n\n该表达式代表了孩子在出生时、性别未知情况下的先验风险。它正确地对性别特异性外显率进行了加权平均（权重为成为各种性别的概率），并乘以遗传致病性变异的概率。该表达式仅用给定的参数 $p$、$\\lambda_{\\mathrm{female}}$、$\\lambda_{\\mathrm{male}}$ 和 $s$ 表示。", "answer": "$$\\boxed{\\frac{1}{2} p (s \\lambda_{\\mathrm{female}} + (1 - s) \\lambda_{\\mathrm{male}})}$$", "id": "4456383"}, {"introduction": "产前筛查测试不提供最终诊断，而是修正患者的先验风险。贝叶斯定理是核心的数学工具，临床医生利用它，结合测试的性能特征（灵敏度和特异性），将检验前的概率（先验概率）更新为检验后的概率（后验概率）。本练习演示了如何计算筛查测试的阳性预测值，这是准确解读结果和就阳性筛查后的实际风险为患者提供咨询的关键一步。[@problem_id:4456355]", "problem": "一位孕妇根据母体年龄和血清标志物接受了旨在筛查21三体综合征的孕早期非整倍体筛查。所关注的病症是21三体综合征，它通常由减数分裂不分离引起，并与妇产科的生殖遗传学相关。令$D$表示胎儿患有21三体综合征的事件，令$\\bar{D}$表示胎儿未患有21三体综合征的事件。21三体综合征的测试前风险（先验概率）为$R$，因此$R = P(D)$且$1 - R = P(\\bar{D})$。该筛查测试报告阳性结果$+$或阴性结果$-$，其灵敏度$Se$和特异度$Sp$定义为$Se = P(+ \\mid D)$和$Sp = P(- \\mid \\bar{D})$。在观察到阳性测试结果后，请从概率、灵敏度和特异度的基本定义出发，推导后验概率$P(D \\mid +)$的一个以$R$、$Se$和$Sp$表示的精确闭式表达式。请将您的答案表示为仅含$R$、$Se$和$Sp$的单一解析表达式，不含其他参数。无需进行数值近似或舍入。", "solution": "在尝试任何解答之前，该问题都经过了验证。\n\n### 步骤 1：提取已知条件\n已知条件逐字从问题陈述中提取：\n- $D$：胎儿患有21三体综合征的事件。\n- $\\bar{D}$：胎儿未患有21三体综合征的事件。\n- $R = P(D)$：21三体综合征的测试前风险（先验概率）。\n- $1 - R = P(\\bar{D})$。\n- $+$：阳性测试结果。\n- $-$：阴性测试结果。\n- $Se = P(+ \\mid D)$：筛查测试的灵敏度。\n- $Sp = P(- \\mid \\bar{D})$：筛查测试的特异度。\n- 目标是推导后验概率$P(D \\mid +)$的一个以$R$、$Se$和$Sp$表示的精确闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行有效性评估：\n- **科学依据：** 问题使用了概率论（特别是贝叶斯推断）中应用于医学诊断的标准、公认概念。术语灵敏度（$Se$）、特异度（$Sp$）、先验概率（$R$）和后验概率（$P(D \\mid +)$）是该领域的基础。在妇产科中进行21三体综合征非整倍体筛查的背景在科学上是准确和适当的。\n- **良态问题：** 问题提供了推导目标量$P(D \\mid +)$所需的全套变量（$R$、$Se$、$Sp$）和定义。推导过程会得出一个唯一且有意义的解析表达式，这是贝叶斯定理的一种特定形式。\n- **客观性：** 问题以精确、无歧义的数学和医学语言陈述，不含任何主观论断或意见。\n\n该问题未违反任何无效性标准。它在科学上是合理的，结构严谨，内容完整，逻辑一致，并提出了一个基于概率论基本原理的可验证问题。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将推导其解法。\n\n目标是求在测试结果为阳性的条件下，胎儿患有21三体综合征的后验概率，记作$P(D \\mid +)$。\n\n根据条件概率的定义，我们可以写出：\n$$\nP(D \\mid +) = \\frac{P(D \\cap +)}{P(+)}\n$$\n其中$P(D \\cap +)$是胎儿患有21三体综合征且测试结果为阳性的联合概率，而$P(+)$是测试结果为阳性的全概率。\n\n首先，我们将分子$P(D \\cap +)$用给定的参数表示。灵敏度$Se$被定义为在患病条件下测试结果为阳性的条件概率：\n$$\nSe = P(+ \\mid D)\n$$\n根据条件概率的定义，$P(+ \\mid D) = \\frac{P(+ \\cap D)}{P(D)}$。通过整理这个方程，我们可以将联合概率表示为：\n$$\nP(D \\cap +) = P(+ \\mid D) P(D)\n$$\n用给定的符号$Se$替换$P(+ \\mid D)$，$R$替换$P(D)$，我们得到：\n$$\nP(D \\cap +) = Se \\cdot R\n$$\n\n接下来，我们将分母$P(+)$用给定的参数表示。阳性测试结果可能在两种互斥的情形下发生：真阳性（胎儿患有21三体综合征且测试结果为阳性）或假阳性（胎儿未患有21三体综合征但测试结果为阳性）。使用全概率公式，我们可以将$P(+)$表示为这两种情形的概率之和：\n$$\nP(+) = P(+ \\cap D) + P(+ \\cap \\bar{D})\n$$\n我们已经确定了第一项：$P(+ \\cap D) = Se \\cdot R$。\n\n为了求第二项$P(+ \\cap \\bar{D})$，我们再次使用条件概率的定义：\n$$\nP(+ \\cap \\bar{D}) = P(+ \\mid \\bar{D}) P(\\bar{D})\n$$\n我们已知$P(\\bar{D}) = 1 - R$。项$P(+ \\mid \\bar{D})$是在胎儿未患有21三体综合征的条件下测试结果为阳性的概率。这就是假阳性率。我们已知特异度$Sp$，即在未患病条件下测试结果为阴性的概率：$Sp = P(- \\mid \\bar{D})$。由于对于未患病的个体，测试结果只能是阳性或阴性，其概率之和必须为1：\n$$\nP(+ \\mid \\bar{D}) + P(- \\mid \\bar{D}) = 1\n$$\n因此，假阳性率可以用特异度来表示：\n$$\nP(+ \\mid \\bar{D}) = 1 - P(- \\mid \\bar{D}) = 1 - Sp\n$$\n现在，我们可以计算$P(+ \\cap \\bar{D})$：\n$$\nP(+ \\cap \\bar{D}) = (1 - Sp) (1 - R)\n$$\n将两项的表达式代回$P(+)$的方程中：\n$$\nP(+) = Se \\cdot R + (1 - Sp)(1 - R)\n$$\n\n最后，我们将分子$P(D \\cap +)$和分母$P(+)$的表达式代回$P(D \\mid +)$的原始方程中：\n$$\nP(D \\mid +) = \\frac{Se \\cdot R}{Se \\cdot R + (1 - Sp)(1 - R)}\n$$\n这就是用给定参数$R$、$Se$和$Sp$表示的后验概率的最终闭式表达式。", "answer": "$$\n\\boxed{\\frac{Se \\cdot R}{Se \\cdot R + (1 - Sp)(1 - R)}}\n$$", "id": "4456355"}]}