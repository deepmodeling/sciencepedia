{"hands_on_practices": [{"introduction": "在进行任何基因检测之前，理解基线风险至关重要。对于植入前非整倍体基因检测（PGT-A）而言，母体年龄是预测非整倍体风险最重要的单一因素。本练习将演示如何使用逻辑回归模型——生物统计学中的一个基本工具——来量化年龄与胚胎非整倍体概率之间的关系。掌握这项技能使您能够计算并向患者传达与年龄相关的风险，为就是否进行PGT-A做出知情决策奠定基础 [@problem_id:4497118]。", "problem": "一家进行植入前非整倍体基因检测 (PGT-A) 的生育实验室，使用逻辑斯蒂连接函数将胚胎层面的染色体非整倍性概率建模为取卵年龄的函数。设母亲年龄（以年为单位）为 $a$。该模型将非整倍性的条件概率指定为\n$$\nP(\\text{aneuploidy}\\mid a) \\;=\\; \\frac{1}{1+\\exp\\!\\big(-( -6 + 0.15\\,a)\\big)} \\;=\\; \\frac{1}{1+\\exp\\!\\big(6 - 0.15\\,a\\big)}.\n$$\n在此设定下，根据伯努利结果的期望定义，年龄为 $a$ 时每个胚胎的预期非整倍性率等于 $P(\\text{aneuploidy}\\mid a)$。使用此模型以及逻辑斯蒂函数将任何实值线性预测变量映射到区间 $\\left[0,1\\right]$ 内的概率这一基本性质，计算以下各项：\n- 当 $a=32$、$a=38$ 和 $a=42$ 时的预期非整倍性率（以概率形式表示）。\n- 年龄 $a=42$ 相对于 $a=32$ 时的非整倍性相对风险（风险比），定义为 $RR \\equiv \\dfrac{P(\\text{aneuploidy}\\mid 42)}{P(\\text{aneuploidy}\\mid 32)}$。\n\n将所有概率表示为小数（而非百分比）。将所有要求的数值结果四舍五入至四位有效数字。以行矩阵的形式，按 $P(32)$、$P(38)$、$P(42)$、$RR$ 的顺序报告您的最终答案。", "solution": "我们关心的结果，即胚胎非整倍性，可以建模为一个伯努利随机变量，其成功概率为 $P(\\text{aneuploidy}\\mid a)$。对于一个概率为 $p$ 的伯努利变量，其期望值为 $p$。所提供的逻辑斯蒂模型规定概率为\n$$\nP(\\text{aneuploidy}\\mid a) \\;=\\; \\frac{1}{1+\\exp\\!\\big(6 - 0.15\\,a\\big)}.\n$$\n这种函数形式确保了对于所有实数 $a$，$0 \\leq P(\\text{aneuploidy}\\mid a) \\leq 1$。\n\n我们在所要求的年龄下进行计算。\n\n1. 当 $a=32$ 时，\n$$\nP(32) \\;=\\; \\frac{1}{1+\\exp\\!\\big(6 - 0.15\\cdot 32\\big)} \\;=\\; \\frac{1}{1+\\exp(1.2)}.\n$$\n使用 $\\exp(1.2)\\approx 3.320116923$，我们得到\n$$\nP(32) \\;\\approx\\; \\frac{1}{1+3.320116923} \\;=\\; \\frac{1}{4.320116923} \\;\\approx\\; 0.2314752165.\n$$\n四舍五入至四位有效数字：$0.2315$。\n\n2. 当 $a=38$ 时，\n$$\nP(38) \\;=\\; \\frac{1}{1+\\exp\\!\\big(6 - 0.15\\cdot 38\\big)} \\;=\\; \\frac{1}{1+\\exp(0.3)}.\n$$\n使用 $\\exp(0.3)\\approx 1.349858808$，我们得到\n$$\nP(38) \\;\\approx\\; \\frac{1}{1+1.349858808} \\;=\\; \\frac{1}{2.349858808} \\;\\approx\\; 0.4255574830.\n$$\n四舍五入至四位有效数字：$0.4256$。\n\n3. 当 $a=42$ 时，\n$$\nP(42) \\;=\\; \\frac{1}{1+\\exp\\!\\big(6 - 0.15\\cdot 42\\big)} \\;=\\; \\frac{1}{1+\\exp(-0.3)}.\n$$\n使用 $\\exp(-0.3)\\approx 0.740818221$，我们得到\n$$\nP(42) \\;\\approx\\; \\frac{1}{1+0.740818221} \\;=\\; \\frac{1}{1.740818221} \\;\\approx\\; 0.5744425160.\n$$\n四舍五入至四位有效数字：$0.5744$。\n\n接下来，计算年龄 $a=42$ 相对于 $a=32$ 的相对风险：\n$$\nRR \\;\\equiv\\; \\frac{P(42)}{P(32)} \\;=\\; \\frac{\\dfrac{1}{1+\\exp(6-0.15\\cdot 42)}}{\\dfrac{1}{1+\\exp(6-0.15\\cdot 32)}} \\;=\\; \\frac{1+\\exp(6-0.15\\cdot 32)}{1+\\exp(6-0.15\\cdot 42)}.\n$$\n代入计算出的指数值，\n$$\nRR \\;\\approx\\; \\frac{1+\\exp(1.2)}{1+\\exp(-0.3)} \\;=\\; \\frac{1+3.320116923}{1+0.740818221} \\;=\\; \\frac{4.320116923}{1.740818221} \\;\\approx\\; 2.481689070.\n$$\n四舍五入至四位有效数字：$2.482$。\n\n因此，按照要求的顺序 $P(32)$、$P(38)$、$P(42)$、$RR$，四舍五入后的结果分别为 $0.2315$、$0.4256$、$0.5744$ 和 $2.482$。", "answer": "$$\\boxed{\\begin{pmatrix}0.2315  0.4256  0.5744  2.482\\end{pmatrix}}$$", "id": "4497118"}, {"introduction": "PGT-A的结果并非最终诊断，而是一种强大的筛查工具，因此理解其局限性是正确临床应用的关键。本练习应用贝叶斯定理，利用已知的检测灵敏度和特异性，计算即使在胚胎被报告为“整倍体”后，其仍然存在非整倍体的残留风险。这项计算对于准确的患者咨询至关重要，因为它揭示了检测前风险如何影响检测后发生错误的概率，并有助于管理对PGT-A所提供确定性的期望 [@problem_id:4497095]。", "problem": "一对正在进行体外受精的夫妇选择使用滋养外胚层活检和新一代测序技术进行植入前非整倍体基因检测 (PGT-A)。该检测返回一个二元结果：“整倍体”或“非整倍体”。考虑一个胚胎，根据母亲年龄和既往生育史，其非整倍性的先验概率为 $0.4$。他们实验室经验证的检测性能为灵敏度 $0.95$ 和特异性 $0.98$。仅使用灵敏度和特异性作为条件概率的核心定义以及条件概率公理，推导在检测结果为“整倍体”的情况下胚胎实际上是非整倍体的后验概率，并计算其值。然后，在相同的检测性能参数下，对另一个非整倍性先验概率为 $0.2$ 的胚胎重复此计算。将两个后验概率均表示为小数，并各自四舍五入到四位有效数字。在最终答案中，将这两个数字以单行矩阵的形式给出。", "solution": "经评估，此问题是有效的。它在科学上基于医学诊断学和概率论的原理，提法得当，信息充分且一致，并且陈述客观。\n\n我们需要计算在胚胎检测结果为“整倍体”的情况下，它实际上是非整倍体的后验概率，这需要针对两种不同的非整倍性先验概率进行计算。这是一个条件概率问题。\n\n让我们定义以下事件：\n$A$：胚胎确实是非整倍体事件。\n$E$：胚胎确实是整倍体事件。\n$T_A$：检测返回“非整倍体”结果的事件。\n$T_E$：检测返回“整倍体”结果的事件。\n\n事件 $A$ 和 $E$ 构成样本空间的一个划分，意味着一个胚胎要么是非整倍体，要么是整倍体。因此，$E = A^c$ 且 $P(E) = 1 - P(A)$。类似地，检测结果 $T_A$ 和 $T_E$ 是互斥的结果。\n\n问题提供了以下信息：\n检测的灵敏度是指在状况存在（胚胎为非整倍体）的情况下，测试结果为阳性（非整倍体）的概率。\n$$ \\text{Sensitivity} = P(T_A | A) = 0.95 $$\n检测的特异性是指在状况不存在（胚胎为整倍体）的情况下，测试结果为阴性（整倍体）的概率。\n$$ \\text{Specificity} = P(T_E | E) = 0.98 $$\n\n我们的任务是求后验概率 $P(A | T_E)$，即在检测结果为“整倍体”的情况下，胚胎为非整倍体的概率。\n\n根据条件概率的核心定义，\n$$ P(A | T_E) = \\frac{P(A \\cap T_E)}{P(T_E)} $$\n\n我们必须利用给定信息推导分子 $P(A \\cap T_E)$ 和分母 $P(T_E)$ 的表达式。\n\n对于分子，我们可以再次使用条件概率的定义：\n$$ P(T_E | A) = \\frac{P(T_E \\cap A)}{P(A)} $$\n重新整理可得：\n$$ P(A \\cap T_E) = P(T_E | A) P(A) $$\n项 $P(T_E | A)$ 是非整倍体胚胎得到“整倍体”检测结果的概率。这是假阴性率。由于检测结果只能是“非整倍体”或“整倍体”，我们有 $P(T_A | A) + P(T_E | A) = 1$。\n因此，\n$$ P(T_E | A) = 1 - P(T_A | A) = 1 - \\text{Sensitivity} = 1 - 0.95 = 0.05 $$\n所以，分子是 $P(A \\cap T_E) = (0.05) P(A)$。\n\n对于分母 $P(T_E)$，我们使用全概率定律。事件 $T_E$ 可以根据胚胎的真实状态（非整倍体 $A$ 或整倍体 $E$）进行划分。\n$$ P(T_E) = P(T_E \\cap A) + P(T_E \\cap E) $$\n对每一项使用条件概率的定义：\n$$ P(T_E) = P(T_E | A) P(A) + P(T_E | E) P(E) $$\n我们拥有此表达式所需的所有组成部分：\n$P(T_E | A) = 1 - \\text{Sensitivity} = 0.05$\n$P(A)$ 是非整倍性的先验概率。\n$P(T_E | E) = \\text{Specificity} = 0.98$\n$P(E) = 1 - P(A)$\n\n将这些代入 $P(T_E)$ 的表达式中：\n$$ P(T_E) = (0.05) P(A) + (0.98) (1 - P(A)) $$\n\n现在我们可以组合出我们所求的后验概率 $P(A | T_E)$ 的最终表达式：\n$$ P(A | T_E) = \\frac{P(T_E | A) P(A)}{P(T_E | A) P(A) + P(T_E | E) (1 - P(A))} $$\n$$ P(A | T_E) = \\frac{(0.05) P(A)}{(0.05) P(A) + (0.98) (1 - P(A))} $$\n\n现在我们可以计算这两种情况下的值。\n\n情况1：非整倍性的先验概率为 $P_1(A) = 0.4$。\n相应的整倍性先验概率为 $P_1(E) = 1 - 0.4 = 0.6$。\n将 $P_1(A) = 0.4$ 代入推导出的公式：\n$$ P_1(A | T_E) = \\frac{(0.05)(0.4)}{(0.05)(0.4) + (0.98)(1 - 0.4)} $$\n$$ P_1(A | T_E) = \\frac{0.02}{0.02 + (0.98)(0.6)} $$\n$$ P_1(A | T_E) = \\frac{0.02}{0.02 + 0.588} $$\n$$ P_1(A | T_E) = \\frac{0.02}{0.608} $$\n$$ P_1(A | T_E) \\approx 0.032894753... $$\n四舍五入到四位有效数字，我们得到 $0.03289$。\n\n情况2：非整倍性的先验概率为 $P_2(A) = 0.2$。\n相应的整倍性先验概率为 $P_2(E) = 1 - 0.2 = 0.8$。\n将 $P_2(A) = 0.2$ 代入推导出的公式：\n$$ P_2(A | T_E) = \\frac{(0.05)(0.2)}{(0.05)(0.2) + (0.98)(1 - 0.2)} $$\n$$ P_2(A | T_E) = \\frac{0.01}{0.01 + (0.98)(0.8)} $$\n$$ P_2(A | T_E) = \\frac{0.01}{0.01 + 0.784} $$\n$$ P_2(A | T_E) = \\frac{0.01}{0.794} $$\n$$ P_2(A | T_E) \\approx 0.012594458... $$\n四舍五入到四位有效数字，我们得到 $0.01259$。\n\n这两个后验概率约等于 $0.03289$ 和 $0.01259$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.03289  0.01259\n\\end{pmatrix}\n}\n$$", "id": "4497095"}, {"introduction": "在PGT之后，临床医生常常面临多个质量和遗传状态各异的胚胎，而首先移植哪个胚胎的决定对整体成功率有重大影响。本练习通过对序贯移植过程进行建模，以确定一个能最大化累积活产率的最优策略，其中不仅考虑了每个胚胎的个体成功率，也考虑了患者在周期之间可能中断治疗的现实情况。通过解决这个问题，您将学会如何将序贯决策分析的原理应用于体外受精（IVF）中的核心临床挑战，将评估从单个胚胎提升到整体性的战略治疗规划层面 [@problem_id:4497150]。", "problem": "在采用胚胎植入前非整倍体基因检测（PGT-A）和胚胎植入前染色体结构重排基因检测（PGT-SR）的体外受精中，每次移植的活产概率取决于胚胎的倍性状态和形态学。考虑一位患者有三个冷冻保存的囊胚，每个囊胚都将在可用时进行新的单次移植尝试，一旦首次活产成功，移植将立即停止。这三个胚胎是：\n- 胚胎 $1$：PGT-A 整倍体，形态学等级BB；每次移植的活产概率为 $p_{1} = 0.55$。\n- 胚胎 $2$：PGT-A 7号染色体嵌合型单体，嵌合比例为 $0.20$，形态学等级AA；每次移植的活产概率为 $p_{2} = 0.45$。\n- 胚胎 $3$：PGT-SR 检测到长度为 $5$ 兆碱基的节段性重复，呈嵌合状态，嵌合比例为 $0.40$，形态学等级AB；每次移植的活产概率为 $p_{3} = 0.35$。\n\n假设以下基于标准临床模型的基本条件：\n- 每个胚胎移植后的活产结果是一个伯努利随机变量，成功概率为 $p_{i}$，且各胚胎之间相互独立。\n- 每次尝试只移植一个胚胎。\n- 如果一次移植失败，夫妻有 $d = 0.25$ 的概率在尝试下一次移植前终止治疗；有 $1-d$ 的概率他们会继续。\n- 是否继续治疗的决策在概率上独立于胚胎的结果，并且每次尝试都相同。\n- 首次活产后停止移植。\n\n仅使用条件概率和伯努利试验独立性的规则，推导至少一次活产的累积概率表达式，该表达式是关于胚胎移植有序序列 $\\sigma = (i_{1}, i_{2}, i_{3})$ 和参数 $\\{p_{1}, p_{2}, p_{3}, d\\}$ 的函数。然后，根据给定的 $p_{1}$、$p_{2}$、$p_{3}$ 和 $d$ 的数值，确定使该累积概率最大化的移植顺序 $\\sigma^{\\star}$。将最优顺序表示为一个索引的行矩阵 $\\begin{pmatrix}i_{1}  i_{2}  i_{3}\\end{pmatrix}$，其中 $i_{j} \\in \\{1,2,3\\}$ 表示在第 $j$ 个位置的胚胎编号。不包含任何单位。最终答案必须仅以该行矩阵的形式给出。", "solution": "问题陈述经分析确定有效。其科学依据为生殖医学和概率论原理，问题设定良好，目标明确，信息充分，并以客观、正式的语言表述。我们可以开始求解。\n\n设胚胎移植的有序序列为 $\\sigma = (i_1, i_2, i_3)$，其中 $\\{i_1, i_2, i_3\\}$ 是胚胎索引 $\\{1, 2, 3\\}$ 的一个排列。序列中第 $j$ 个位置胚胎的成功概率为 $p_{i_j}$。一对夫妇在移植失败后终止治疗的概率为 $d$，继续治疗的概率为 $c = 1-d$。\n\n至少有一次活产的累积概率（记为 $P(\\sigma)$）是在每次移植尝试中实现首次活产的这些互斥事件的概率之和。\n设 $E_j$ 为首次活产发生在第 $j$ 次移植的事件。\n\n1.  第一次移植就活产的概率是序列中第一个胚胎的成功概率，$p_{i_1}$。\n    $$P(E_1) = p_{i_1}$$\n\n2.  首次活产发生在第二次移植，必须满足第一次移植失败（概率为 $1-p_{i_1}$），夫妇继续治疗（概率为 $c=1-d$），并且第二次移植成功（概率为 $p_{i_2}$）。\n    $$P(E_2) = (1-p_{i_1}) c p_{i_2}$$\n\n3.  首次活产发生在第三次移植，必须满足前两次移植都失败，夫妇在每次失败后都继续治疗，并且第三次移植成功。\n    $$P(E_3) = (1-p_{i_1}) c (1-p_{i_2}) c p_{i_3} = c^2 (1-p_{i_1})(1-p_{i_2})p_{i_3}$$\n\n至少有一次活产的总累积概率是 $P(E_1) + P(E_2) + P(E_3)$ 的和。\n$$P(\\sigma) = p_{i_1} + c(1-p_{i_1})p_{i_2} + c^2(1-p_{i_1})(1-p_{i_2})p_{i_3}$$\n代入 $c=1-d$，我们得到所求的表达式：\n$$P(\\sigma) = p_{i_1} + (1-d)(1-p_{i_1})p_{i_2} + (1-d)^2(1-p_{i_1})(1-p_{i_2})p_{i_3}$$\n\n下一步是确定使 $P(\\sigma)$ 最大化的移植顺序 $\\sigma^{\\star}$。我们可以通过一个一般性原则来确定最优排序，而无需计算所有 $3! = 6$ 种排列。考虑任何包含一个未按成功概率降序排列的相邻胚胎对 $(i_k, i_{k+1})$ 的序列 $\\sigma'$，即 $p_{i_k}  p_{i_{k+1}}$。我们通过交换这对胚胎得到一个新序列 $\\sigma$，其顺序为 $(i_{k+1}, i_k)$。所有其他胚胎保持其原始位置。\n\n总概率 $P(\\sigma)$ 可以写成前 $k-1$ 次移植的贡献、第 $k$ 和 $k+1$ 次移植的贡献以及第 $k+1$ 次之后移植的贡献之和。对于 $\\sigma$ 和 $\\sigma'$，序列的初始部分和最终部分是相同的。代表截至第 $k$ 次移植前均失败并继续治疗的概率因子（我们称之为 $F_{k-1}$）对于两个序列也是相同的。因此，要确定哪个序列产生更高的总概率，我们只需比较在达到第 $k$ 步的条件下，在第 $k$ 步和第 $k+1$ 步成功概率的总和。\n\n对于顺序 $(\\dots, i_k, i_{k+1}, \\dots)$，这两步的贡献是 $p_{i_k} + c(1-p_{i_k})p_{i_{k+1}}$。\n对于顺序 $(\\dots, i_{k+1}, i_k, \\dots)$，贡献是 $p_{i_{k+1}} + c(1-p_{i_{k+1}})p_{i_k}$。\n\n让我们比较这两个量。设 $\\Delta$ 为它们的差：\n$$\\Delta = \\left[ p_{i_{k+1}} + c(1-p_{i_{k+1}})p_{i_k} \\right] - \\left[ p_{i_k} + c(1-p_{i_k})p_{i_{k+1}} \\right]$$\n$$\\Delta = p_{i_{k+1}} + c p_{i_k} - c p_{i_k} p_{i_{k+1}} - p_{i_k} - c p_{i_{k+1}} + c p_{i_k} p_{i_{k+1}}$$\n$$\\Delta = (p_{i_{k+1}} - p_{i_k}) - c(p_{i_{k+1}} - p_{i_k})$$\n$$\\Delta = (1-c)(p_{i_{k+1}} - p_{i_k})$$\n给定 $d=0.25$，我们有 $c = 1-d = 0.75$。因此，$1-c = 0.25$，这是一个正常数。所以 $\\Delta$ 的符号与 $(p_{i_{k+1}} - p_{i_k})$ 的符号相同。\n\n如果 $p_{i_{k+1}}  p_{i_k}$，则 $\\Delta  0$。这意味着将胚胎对 $(i_k, i_{k+1})$ 交换为 $(i_{k+1}, i_k)$ 会增加总的活产累积概率。这个逻辑适用于序列中的任何相邻对。任何未按成功概率降序排列的序列都可以通过交换一个顺序错误的相邻对来改进。唯一无法改进的序列是所有胚胎都按成功概率从高到低排列的序列。因此，这种贪心策略是最优的。\n\n给定的概率是：\n- 胚胎 $1$：$p_1 = 0.55$\n- 胚胎 $2$：$p_2 = 0.45$\n- 胚胎 $3$：$p_3 = 0.35$\n\n将这些概率按降序排列得到 $p_1  p_2  p_3$。\n因此，最优移植顺序 $\\sigma^{\\star}$ 是先移植胚胎 $1$，如果第一次尝试失败则移植胚胎 $2$，如果前两次尝试都失败则最后移植胚胎 $3$。索引序列为 $(1, 2, 3)$。\n\n问题要求将此最优顺序表示为索引的行矩阵。\n$$\\sigma^{\\star} = \\begin{pmatrix} 1  2  3 \\end{pmatrix}$$", "answer": "$$\\boxed{\\begin{pmatrix} 1  2  3 \\end{pmatrix}}$$", "id": "4497150"}]}