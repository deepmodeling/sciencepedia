{"hands_on_practices": [{"introduction": "子宫肌细胞尺寸的减小是子宫复旧过程中的一个基本细胞事件。本练习要求您使用两种不同的动力学假设——线性衰减和指数衰减——来为这一过程建模，以理解潜在的生物学驱动因素如何用数学方式表达，并计算每种模型的关键速率参数 [@problem_id:4494771]。这项练习将提升您将生物学假说转化为定量框架的能力。", "problem": "产后子宫复旧的一个核心形态学特征是，通过持续性收缩张力、蛋白水解、细胞凋亡和自噬的共同作用，子宫平滑肌细胞（肌细胞）的横截面积减小。考虑一个队列，其中平均肌细胞横截面积从分娩时的初始值 $A_{0}$ 下降到产后 $t=21$ 天时的 $0.6A_{0}$。\n\n基于基础动力学的两个机理假设，对平均横截面积 $A(t)$ 的时程进行建模：\n\n- 线性模型：持续的分解代谢驱动和组织张力产生恒定的面积损失绝对速率，因此 $dA/dt$ 不随时间变化。\n- 指数（一级）模型：降解过程与当前面积成正比，因此 $dA/dt$ 与 $A(t)$ 成正比。\n\n对于线性模型，将每日线性相对减少率 $r_{L}$ 定义为 $r_{L} := \\frac{1}{A_{0}}\\left(-\\frac{dA}{dt}\\right)$（因此 $r_{L}$ 是常数）；对于指数模型，将指数衰减常数 $k$ 定义为 $dA/dt = -k A(t)$（因此 $k$ 是常数）。\n\n使用边界条件 $A(21) = 0.6A_{0}$，推导 $r_{L}$ 和 $k$ 的精确值。将两个速率都以 $\\text{day}^{-1}$ 为单位表示。不要四舍五入；提供精确表达式。将您的最终答案以包含 $r_{L}$ 和 $k$ 的行矩阵形式给出。", "solution": "题目要求推导两个速率参数 $r_{L}$ 和 $k$，这两个参数根据两种不同的动力学模型（线性模型和指数模型）来表征平均肌细胞横截面积 $A(t)$ 的减小过程。给定的条件是初始面积为 $A(0) = A_{0}$，在 $t=21$ 天时的面积为 $A(21) = 0.6A_{0}$。\n\n首先，我们分析线性模型。\n线性模型的假设是面积损失的速率是恒定的。这由以下微分方程表示：\n$$ \\frac{dA}{dt} = C $$\n其中 $C$ 是一个常数。我们可以通过对时间 $t$ 直接积分来解此方程：\n$$ \\int_{A(0)}^{A(t)} dA' = \\int_{0}^{t} C dt' $$\n得到：\n$$ A(t) - A(0) = C(t - 0) $$\n使用初始条件 $A(0) = A_{0}$，我们得到 $A(t)$ 的表达式：\n$$ A(t) = A_{0} + Ct $$\n为了确定常数 $C$，我们应用 $t=21$ 天时的边界条件 $A(21) = 0.6A_{0}$：\n$$ A(21) = A_{0} + C(21) = 0.6A_{0} $$\n求解 $C$：\n$$ 21C = 0.6A_{0} - A_{0} = -0.4A_{0} $$\n$$ C = -\\frac{0.4A_{0}}{21} $$\n题目将每日线性相对减少率 $r_{L}$ 定义为 $r_{L} := \\frac{1}{A_{0}}\\left(-\\frac{dA}{dt}\\right)$。由于 $\\frac{dA}{dt} = C$，我们可以代入我们求得的 $C$ 值：\n$$ r_{L} = \\frac{1}{A_{0}}(-C) = \\frac{1}{A_{0}}\\left(-\\left(-\\frac{0.4A_{0}}{21}\\right)\\right) = \\frac{0.4A_{0}}{21A_{0}} = \\frac{0.4}{21} $$\n为提供精确表达式，我们将小数 $0.4$ 表示为分数 $\\frac{4}{10} = \\frac{2}{5}$：\n$$ r_{L} = \\frac{2/5}{21} = \\frac{2}{5 \\times 21} = \\frac{2}{105} $$\n$r_{L}$ 的单位是 $\\text{day}^{-1}$。\n\n接下来，我们分析指数（一级）模型。\n该模型的假设是面积损失的速率与当前面积成正比，这由以下微分方程描述：\n$$ \\frac{dA}{dt} = -k A(t) $$\n其中 $k$ 是指数衰减常数。这是一个可分离的一阶常微分方程。我们重新整理它以分离变量 $A$ 和 $t$：\n$$ \\frac{1}{A} dA = -k dt $$\n我们对两边从初始状态 $(t=0, A=A_{0})$ 积分到一般状态 $(t, A(t))$：\n$$ \\int_{A_{0}}^{A(t)} \\frac{1}{A'} dA' = \\int_{0}^{t} -k dt' $$\n$$ [\\ln(A')]_{A_{0}}^{A(t)} = [-kt']_{0}^{t} $$\n由于面积 $A(t)$ 必须为正，我们可以计算对数积分：\n$$ \\ln(A(t)) - \\ln(A_{0}) = -kt $$\n$$ \\ln\\left(\\frac{A(t)}{A_{0}}\\right) = -kt $$\n通过对两边取指数，我们求得 $A(t)$ 的解：\n$$ A(t) = A_{0}\\exp(-kt) $$\n现在，我们应用边界条件 $A(21) = 0.6A_{0}$：\n$$ A(21) = A_{0}\\exp(-k \\times 21) = 0.6A_{0} $$\n两边同除以 $A_{0}$（非零）得到：\n$$ \\exp(-21k) = 0.6 $$\n为了求 $k$，我们对两边取自然对数：\n$$ \\ln(\\exp(-21k)) = \\ln(0.6) $$\n$$ -21k = \\ln(0.6) $$\n$$ k = -\\frac{\\ln(0.6)}{21} $$\n为了得到精确表达式，我们使用对数性质 $\\ln(x) = -\\ln(1/x)$。因此，$\\ln(0.6) = \\ln(6/10) = \\ln(3/5) = -\\ln(5/3)$。\n$$ k = -\\frac{-\\ln(5/3)}{21} = \\frac{\\ln(5/3)}{21} $$\n$k$ 的单位是 $\\text{day}^{-1}$。\n\n推导出的两个参数是 $r_{L} = \\frac{2}{105}$ 和 $k = \\frac{\\ln(5/3)}{21}$。题目要求以行矩阵形式给出答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{105}  \\frac{\\ln(\\frac{5}{3})}{21}\n\\end{pmatrix}\n}\n$$", "id": "4494771"}, {"introduction": "有效的产后护理有赖于准确解读一系列临床体征组合，以评估子宫复旧情况。在这个基于案例的练习中，您将扮演临床医生的角色，将预定义的定量和定性阈值应用于一位患者关于宫底高度、恶露和子宫体积的纵向数据 [@problem_id:4494721]。这项练习通过整合多个数据流来区分正常生理过程与子宫复旧不全，从而培养关键的诊断技能。", "problem": "一位产后患者接受了系列测量随访，包括子宫底到脐部的距离、恶露特征以及超声测量的子宫体积。定义 $D(t)$ 为产后第 $t$ 天仰卧位测量的子宫底到脐部的距离，单位为厘米（正值表示子宫底位于脐部下方）。定义 $V(t)$ 为产后第 $t$ 天通过三维经阴道超声获得的子宫体积，单位为毫升。临床分类需要应用以下预定义的阈值，这些阈值反映了广泛观察到的产后生理现象：\n- 宫底下降阈值：在第 $t=2$ 天到第 $t=10$ 天的时间段内，平均每日下降速度 $$\\bar{r}=\\frac{D(10)-D(2)}{10-2}$$ 如果满足 $\\bar{r}\\ge 0.8$ 厘米/天，则认为是正常的。\n- 恶露进展阈值：红色恶露不应持续超过第5天；浆液性恶露应在第6-10天出现；白色恶露应从第10天及以后出现。\n- 子宫体积阈值：到第7天，子宫体积应下降至 $V(7)/V(2)\\le 0.55$，到第14天下降至 $V(14)/V(2)\\le 0.35$。\n\n患者数据如下：\n- 宫底位置：$D(2)=1$ 厘米， $D(7)=7$ 厘米， $D(10)=9$ 厘米， $D(14)=12$ 厘米。\n- 恶露：红色恶露从第1天持续到第9天（中等量，偶有小血块），在第10-12天转为浆液性恶露，第14天出现白色恶露。\n- 子宫体积：$V(2)=950$ 毫升， $V(7)=500$ 毫升， $V(10)=350$ 毫升， $V(14)=300$ 毫升。\n\n严格根据上述阈值和产后子宫复旧的生理学原理（由催产素介导的子宫肌层收缩、子宫肌纤维的自溶以及反映在恶露转变中的子宫内膜的逐步再上皮化），哪个选项最能对总体轨迹进行分类？\n\nA. 正常复旧；宫底下降、恶露进展和子宫体积缩减的所有阈值均得到满足。\n\nB. 子宫复旧不全；主要问题是尽管宫底下降和子宫体积缩减足够，但红色恶露持续超过第5天。\n\nC. 子宫复旧不全；主要问题是到第7天时子宫体积缩减不足（即 $V(7)/V(2)0.55$）。\n\nD. 子宫复旧不全；主要问题是前10天平均宫底下降不足（即 $\\bar{r}  0.8$ 厘米/天）。", "solution": "首先评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **定义**：\n    - $D(t)$: 产后第 $t$ 天子宫底到脐部的距离，单位为厘米。正值表示子宫底位于脐部下方。\n    - $V(t)$: 产后第 $t$ 天的子宫体积，单位为毫升。\n- **正常复旧的阈值**：\n    1.  **宫底下降**：从第 $t=2$ 天到第 $t=10$ 天的区间内，平均每日下降速度 $\\bar{r}=\\frac{D(10)-D(2)}{10-2}$ 必须满足 $\\bar{r}\\ge 0.8$ 厘米/天。\n    2.  **恶露进展**：\n        - 红色恶露不应持续超过第5天。\n        - 浆液性恶露应在第6-10天出现。\n        - 白色恶露应从第10天及以后出现。\n    3.  **子宫体积缩减**：\n        - 到第7天，体积比必须满足 $V(7)/V(2)\\le 0.55$。\n        - 到第14天，体积比必须满足 $V(14)/V(2)\\le 0.35$。\n- **患者数据**：\n    - **宫底位置**：$D(2)=1$ 厘米， $D(7)=7$ 厘米， $D(10)=9$ 厘米， $D(14)=12$ 厘米。\n    - **恶露**：红色恶露从第1天持续到第9天；在第10-12天转为浆液性恶露；第14天出现白色恶露。\n    - **子宫体积**：$V(2)=950$ 毫升， $V(7)=500$ 毫升， $V(10)=350$ 毫升， $V(14)=300$ 毫升。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于产科学和妇科学这一成熟的医学领域，特别是关于产后子宫复旧。所测量的参数（宫底高度、恶露、子宫体积）和提及的生理过程（子宫肌层收缩、自溶、再上皮化）都是标准概念。数据和阈值的数值对于临床病例而言在生理上是合理的。\n- **适定性**：该问题是适定的。它提供了一套完整的数据和一套清晰、确定性的规则（阈值）来应用于这些数据。通过将数据与每个规则进行检验，可以逻辑上得出一个唯一的结论。\n- **客观性**：问题以客观的临床语言陈述。分类标准是定量的，没有主观解释的余地。\n- **完整性和一致性**：问题陈述是自洽的。它提供了进行所需分析的所有必要数据和定义。没有内部矛盾。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是一个基于科学原理的、定义明确的分析任务。解题过程将通过系统地根据给定的阈值评估患者数据来进行。\n\n### 解题推导\n\n通过根据三个指定的阈值集评估患者数据，对总体复旧轨迹进行分类。\n\n1.  **宫底下降分析**：\n    阈值要求从第 $t=2$ 天到第 $t=10$ 天的平均每日下降速度 $\\bar{r}$ 至少为 $0.8$ 厘米/天。\n    使用所提供的数据，$D(2)=1$ 厘米 和 $D(10)=9$ 厘米：\n    $$ \\bar{r} = \\frac{D(10)-D(2)}{10-2} = \\frac{9-1}{8} = \\frac{8}{8} = 1.0 \\text{ 厘米/天} $$\n    将计算值与阈值进行比较：\n    $$ 1.0 \\text{ 厘米/天} \\ge 0.8 \\text{ 厘米/天} $$\n    此条件得到满足。宫底下降速度是正常的。\n\n2.  **恶露进展分析**：\n    恶露的阈值被依次评估。\n    - **阈值1**：“红色恶露不应持续超过第5天。” 患者数据显示红色恶露从第1天持续到第9天。由于 $9  5$，该阈值**未被满足**。\n    - **阈值2**：“浆液性恶露应在第6-10天出现。” 数据显示浆液性恶露在第10-12天出现。由于其在第10天开始出现，这在指定的时间窗内，因此该阈值被满足。\n    - **阈值3**：“白色恶露应从第10天及以后出现。” 数据显示浆液性恶露在第10、11和12天出现，而白色恶露直到第14天才出现。这意味着白色恶露并*不是*从第10天及以后出现，这也违反了此条件。\n    最显著和明确的违规是红色恶露的持续。恶露进展是异常的。\n\n3.  **子宫体积缩减分析**：\n    阈值基于后期子宫体积与第 $t=2$ 天体积的比率。基线体积为 $V(2) = 950$ 毫升。\n    - **第7天阈值**：条件是 $V(7)/V(2) \\le 0.55$。患者的数据是 $V(7)=500$ 毫升。\n      比率为：\n      $$ \\frac{V(7)}{V(2)} = \\frac{500}{950} = \\frac{50}{95} = \\frac{10}{19} \\approx 0.5263 $$\n      将其与阈值进行比较：\n      $$ 0.5263 \\le 0.55 $$\n      此条件得到满足。\n    - **第14天阈值**：条件是 $V(14)/V(2) \\le 0.35$。患者的数据是 $V(14)=300$ 毫升。\n      比率为：\n      $$ \\frac{V(14)}{V(2)} = \\frac{300}{950} = \\frac{30}{95} = \\frac{6}{19} \\approx 0.3158 $$\n      将其与阈值进行比较：\n      $$ 0.3158 \\le 0.35 $$\n      此条件也得到满足。\n    两个子宫体积缩减阈值均得到满足。根据此指标，该过程是正常的。\n\n**结论**：\n- 宫底下降：正常。\n- 恶露进展：异常（复旧不全）。\n- 子宫体积缩减：正常。\n由于正常复旧的三个主要标准之一未得到满足，整个过程被分类为子宫复旧不全。具体问题是异常的恶露进展，其特征是红色恶露时间延长。\n\n### 逐项分析\n\n**A. 正常复旧；宫底下降、恶露进展和子宫体积缩减的所有阈值均得到满足。**\n该选项声称所有阈值都得到满足。我们的分析表明，恶露进展的阈值（红色恶露的持续）未被满足。因此，关于正常复旧的陈述是错误的。\n**结论：不正确。**\n\n**B. 子宫复旧不全；主要问题是尽管宫底下降和子宫体积缩减足够，但红色恶露持续超过第5天。**\n该选项正确地将总体状况确定为子宫复旧不全，因为并非所有正常标准都得到满足。它正确地指出了“主要问题”是持续的红色恶露，这违反了红色恶露不应持续超过第5天的规则。它还正确地指出，其他两项指标——宫底下降和子宫体积缩减——是足够的，这与我们的计算结果一致。\n**结论：正确。**\n\n**C. 子宫复旧不全；主要问题是到第7天时子宫体积缩减不足（即 $V(7)/V(2)0.55$）。**\n该选项声称到第7天时子宫体积缩减不足。我们的计算显示 $V(7)/V(2) \\approx 0.526$，即 $\\le 0.55$。体积缩减是足够的。因此，该选项指出了错误的主要问题。\n**结论：不正确。**\n\n**D. 子宫复旧不全；主要问题是前10天平均宫底下降不足（即 $\\bar{r}  0.8$ 厘米/天）。**\n该选项声称平均宫底下降不足。我们的计算显示 $\\bar{r}=1.0$ 厘米/天，即 $\\ge 0.8$ 厘米/天。宫底下降是足够的。因此，该选项指出了错误的主要问题。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "4494721"}, {"introduction": "现代医学正越来越多地利用计算模型来监测患者健康状况并及早发现异常。本练习将指导您将一个用于描述子宫体积和子宫内膜厚度的一阶松弛模型付诸实践，并用它来自动筛查患者数据中的显著偏差 [@problem_id:4494713]。通过实施该模型，您将在定量生理监测和自动化临床数据分析的原理方面获得实践经验。", "problem": "您将执行一项建模任务，该任务基于产后子宫复旧。产后子宫复旧是指分娩后子宫和子宫内膜恢复到其非孕期基线水平的生理过程。您的目标是实施一个第一性原理模型，并将其应用于一组给定的连续超声测量测试集，以识别超出两个标准差（SD）的偏差。\n\n基本原理与建模假设：\n- 对于状态变量 $Y(t)$（子宫体积或子宫内膜厚度），产后复旧过程由朝向基线（渐近线）$Y_{\\infty}$ 的一阶松弛驱动，其模型为常微分方程 $dY/dt = -k\\,(Y - Y_{\\infty})$，其中 $k  0$ 是一个由半衰期决定的衰减率常数。\n- 半衰期 $t_{1/2}$ 定义为与渐近线的偏差减半所需的时间，即 $Y(t_{1/2}) - Y_{\\infty} = \\tfrac{1}{2}\\,(Y(0) - Y_{\\infty})$，由此可得 $k = \\ln(2)/t_{1/2}$。\n- 在初始条件 $Y(0) = Y_0$ 下，该微分方程的解为 $Y(t) = Y_{\\infty} + \\left(Y_0 - Y_{\\infty}\\right)\\,\\exp\\!\\left(-kt\\right)$。\n\n操作性定义：\n- 对于子宫体积 $V(t)$，单位为立方厘米 $(\\mathrm{cm}^3)$：$V_{\\infty}$ 是非孕期参考体积，$V_0$ 是产后即刻（$t = 0$ 天）的体积。\n- 对于子宫内膜厚度 $E(t)$，单位为毫米 $(\\mathrm{mm})$：$E_{\\infty}$ 是产后晚期的基线水平，$E_0$ 是产后即刻（$t = 0$ 天）的值。\n- 在时间点 $t_i$，对于观测值 $Y_{\\mathrm{obs}}(t_i)$，其标准化残差为 $z_i = \\dfrac{Y_{\\mathrm{obs}}(t_i) - Y_{\\mathrm{exp}}(t_i)}{\\sigma_Y}$，其中 $Y_{\\mathrm{exp}}(t_i)$ 是模型期望值，$\\sigma_Y$ 是包含测量和生物学变异性的标准差。如果 $\\lvert z_i \\rvert  2$，则该时间点被标记。\n\n所有测试用例使用的参数值：\n- 子宫体积模型参数：$V_0 = 1000.0\\ \\mathrm{cm}^3$，$V_{\\infty} = 90.0\\ \\mathrm{cm}^3$，$t_{1/2,V} = 7.0\\ \\mathrm{天}$，$\\sigma_V = 70.0\\ \\mathrm{cm}^3$。\n- 子宫内膜厚度模型参数：$E_0 = 20.0\\ \\mathrm{mm}$，$E_{\\infty} = 3.0\\ \\mathrm{mm}$，$t_{1/2,E} = 4.0\\ \\mathrm{天}$，$\\sigma_E = 1.5\\ \\mathrm{mm}$。\n- 时间单位为天，子宫体积单位为 $\\mathrm{cm}^3$，子宫内膜厚度单位为 $\\mathrm{mm}$。\n\n计算要求：\n- 计算 $k_V = \\ln(2)/t_{1/2,V}$ 和 $k_E = \\ln(2)/t_{1/2,E}$。\n- 对于每个时间点 $t_i$，计算 $V_{\\mathrm{exp}}(t_i) = V_{\\infty} + (V_0 - V_{\\infty})\\,\\exp(-k_V t_i)$ 和 $E_{\\mathrm{exp}}(t_i) = E_{\\infty} + (E_0 - E_{\\infty})\\,\\exp(-k_E t_i)$。\n- 计算标准化残差 $z_{V,i} = \\dfrac{V_{\\mathrm{obs}}(t_i) - V_{\\mathrm{exp}}(t_i)}{\\sigma_V}$ 和 $z_{E,i} = \\dfrac{E_{\\mathrm{obs}}(t_i) - E_{\\mathrm{exp}}(t_i)}{\\sigma_E}$。\n- 如果体积偏差的 $\\lvert z_{V,i} \\rvert  2$ 以及厚度偏差的 $\\lvert z_{E,i} \\rvert  2$，则时间点 $t_i$ 的偏差被标记。\n- 对于每个测试用例，返回一个包含两个整数的列表 $[n_V, n_E]$，其中 $n_V$ 是被标记的体积偏差的数量，$n_E$ 是被标记的子宫内膜厚度偏差的数量。\n\n测试集：\n使用以下四个案例。每个案例使用与上述相同的参数集，以及一个包含观测到的子宫体积和子宫内膜厚度的共享时间网格。所有时间单位为天，子宫体积单位为 $\\mathrm{cm}^3$，子宫内膜厚度单位为 $\\mathrm{mm}$。\n\n- 案例 1（典型过程，所有值均接近期望值）：\n  - $t = [\\,3.0,\\,7.0,\\,14.0,\\,28.0\\,]$\n  - $V_{\\mathrm{obs}} = [\\,780.0,\\,530.0,\\,330.0,\\,160.0\\,]$\n  - $E_{\\mathrm{obs}} = [\\,13.5,\\,8.2,\\,4.3,\\,3.0\\,]$\n\n- 案例 2（子宫体积值处于临界状态，恰好为 2 个标准差，无一超出）：\n  - $t = [\\,7.0,\\,14.0,\\,21.0,\\,35.0\\,]$\n  - $V_{\\mathrm{obs}} = [\\,685.0,\\,177.5,\\,343.75,\\,198.4375\\,]$\n  - $E_{\\mathrm{obs}} = [\\,10.5,\\,4.0,\\,3.2,\\,6.0\\,]$\n\n- 案例 3（持续性复旧不良模式，始终高于期望值）：\n  - $t = [\\,3.0,\\,7.0,\\,14.0,\\,28.0\\,]$\n  - $V_{\\mathrm{obs}} = [\\,976.41,\\,755.0,\\,527.5,\\,356.875\\,]$\n  - $E_{\\mathrm{obs}} = [\\,17.62,\\,12.544,\\,9.009,\\,7.632\\,]$\n\n- 案例 4（混合偏差，不规则采样，存在一些大的异常值）：\n  - $t = [\\,5.0,\\,6.0,\\,10.0,\\,42.0\\,]$\n  - $V_{\\mathrm{obs}} = [\\,470.0,\\,718.0,\\,428.0,\\,314.21875\\,]$\n  - $E_{\\mathrm{obs}} = [\\,6.9,\\,9.75,\\,8.9,\\,3.012\\,]$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个案例的结果，形式为逗号分隔的列表的列表，每个内部列表为该案例的 $[n_V, n_E]$。例如，输出格式必须严格为 $[[n_{V,1},n_{E,1}],[n_{V,2},n_{E,2}],[n_{V,3},n_{E,3}],[n_{V,4},n_{E,4}]]$ 的形式，不得包含多余的空格或文本。", "solution": "问题陈述为产后子宫复旧提出了一个定量模型，并要求通过算法实现来检测一组给定的纵向测量数据中与该模型的显著偏差。该问题具有科学依据，是适定的，并包含了获得唯一解所需的所有信息。因此，它被认为是有效的。\n\n该模型的其本原理是，一个生理状态变量 $Y(t)$（代表子宫体积或子宫内膜厚度）从分娩后的初始状态 $Y_0$ 松弛到一个稳定的基线值 $Y_{\\infty}$。这个过程由一个一阶线性常微分方程描述：\n$$\n\\frac{dY}{dt} = -k (Y(t) - Y_{\\infty})\n$$\n其中 $k$ 是一个正常数，代表复旧的速度。该微分方程在初始条件 $Y(0) = Y_0$ 下的解，描述了状态变量随时间 $t$ 变化的期望轨迹：\n$$\nY_{\\mathrm{exp}}(t) = Y_{\\infty} + (Y_0 - Y_{\\infty}) e^{-kt}\n$$\n这种指数衰减函数是生物系统中普遍存在的松弛现象的标准且稳健的模型。\n\n速率常数 $k$ 由半衰期 $t_{1/2}$ 参数化，半衰期是与基线的偏差 $(Y(t) - Y_{\\infty})$ 减少一半所需的时间。该关系从模型方程导出：\n$$\nY(t_{1/2}) - Y_{\\infty} = (Y_0 - Y_{\\infty}) e^{-kt_{1/2}} = \\frac{1}{2} (Y_0 - Y_{\\infty})\n$$\n$$\ne^{-kt_{1/2}} = \\frac{1}{2} \\implies -kt_{1/2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n因此，速率常数 $k$ 被确定为：\n$$\nk = \\frac{\\ln(2)}{t_{1/2}}\n$$\n\n问题指定了两个这样的模型，一个用于子宫体积 $V(t)$（单位 $\\mathrm{cm}^3$），另一个用于子宫内膜厚度 $E(t)$（单位 $\\mathrm{mm}$）。\n\n模型参数提供如下：\n对于子宫体积 ($V$)：\n- 初始体积，$V_0 = 1000.0 \\ \\mathrm{cm}^3$\n- 基线体积，$V_{\\infty} = 90.0 \\ \\mathrm{cm}^3$\n- 半衰期，$t_{1/2,V} = 7.0 \\ \\mathrm{天}$\n- 标准差，$\\sigma_V = 70.0 \\ \\mathrm{cm}^3$\n\n对于子宫内膜厚度 ($E$)：\n- 初始厚度，$E_0 = 20.0 \\ \\mathrm{mm}$\n- 基线厚度，$E_{\\infty} = 3.0 \\ \\mathrm{mm}$\n- 半衰期，$t_{1/2,E} = 4.0 \\ \\mathrm{天}$\n- 标准差，$\\sigma_E = 1.5 \\ \\mathrm{mm}$\n\n首先，我们计算速率常数 $k_V$ 和 $k_E$：\n$$\nk_V = \\frac{\\ln(2)}{t_{1/2,V}} = \\frac{\\ln(2)}{7.0 \\ \\mathrm{天}} \\approx 0.099021 \\ \\mathrm{天}^{-1}\n$$\n$$\nk_E = \\frac{\\ln(2)}{t_{1/2,E}} = \\frac{\\ln(2)}{4.0 \\ \\mathrm{天}} \\approx 0.173287 \\ \\mathrm{天}^{-1}\n$$\n\n现在可以计算任意时间 $t_i$ 的期望值：\n$$\nV_{\\mathrm{exp}}(t_i) = 90.0 + (1000.0 - 90.0) e^{-k_V t_i} = 90.0 + 910.0 \\, e^{-k_V t_i}\n$$\n$$\nE_{\\mathrm{exp}}(t_i) = 3.0 + (20.0 - 3.0) e^{-k_E t_i} = 3.0 + 17.0 \\, e^{-k_E t_i}\n$$\n\n为识别显著偏差，我们为每个观测值 $Y_{\\mathrm{obs}}(t_i)$ 计算标准化残差 $z_i$。该指标以标准差为单位量化了观测值与期望值之间的差异，从而对测量的内在变异性 ($\\sigma_Y$) 进行了归一化。\n$$\nz_i = \\frac{Y_{\\mathrm{obs}}(t_i) - Y_{\\mathrm{exp}}(t_i)}{\\sigma_Y}\n$$\n如果一个观测值的标准化残差的绝对值超过 2，即 $\\lvert z_i \\rvert  2$，则该观测值被标记为显著偏差。这一阈值对应于将位于正态分布 95% 置信区间之外的数据点识别为异常值的常规做法。\n\n任务是处理四个测试用例，每个用例包含一系列时间点 $t_i$ 以及相应的观测值 $V_{\\mathrm{obs}}(t_i)$ 和 $E_{\\mathrm{obs}}(t_i)$。对于每个用例，我们必须计算体积 ($n_V$) 和子宫内膜厚度 ($n_E$) 的标记偏差数量。\n\n单个观测值 $(t_i, V_{\\mathrm{obs}}(t_i), E_{\\mathrm{obs}}(t_i))$ 的算法流程如下：\n1. 使用上述方程计算 $V_{\\mathrm{exp}}(t_i)$ 和 $E_{\\mathrm{exp}}(t_i)$。\n2. 计算残差 $z_{V,i} = (V_{\\mathrm{obs}}(t_i) - V_{\\mathrm{exp}}(t_i)) / \\sigma_V$ 和 $z_{E,i} = (E_{\\mathrm{obs}}(t_i) - E_{\\mathrm{exp}}(t_i)) / \\sigma_E$。\n3. 如果 $\\lvert z_{V,i} \\rvert  2$，则计数器 $n_V$ 加一。\n4. 如果 $\\lvert z_{E,i} \\rvert  2$，则计数器 $n_E$ 加一。\n\n此过程应用于每个用例中的所有数据点。每个用例的最终结果是计数对 $[n_V, n_E]$。\n\n案例 1：$t = [3.0, 7.0, 14.0, 28.0]$。所有观测值都完全落在期望值的 2 个标准差范围内。例如，在 $t_1 = 7.0$ 天时，$V_{\\exp}(7.0) = 545.0 \\ \\mathrm{cm}^3$。观测值为 $V_{\\mathrm{obs}}(7.0) = 530.0 \\ \\mathrm{cm}^3$。残差为 $z_{V,1} = (530.0 - 545.0) / 70.0 = -0.214$。由于 $\\lvert z_{V,1} \\rvert \\le 2$，因此不被标记。处理所有点后，计数为 $n_V = 0$ 和 $n_E = 0$。\n结果：$[0, 0]$\n\n案例 2：$t = [7.0, 14.0, 21.0, 35.0]$。体积的测试数据被构造成使得前三个点的标准化残差恰好为 $\\pm 2.0$。例如，在 $t_1 = 7.0$ 天时，$V_{\\mathrm{obs}}(7.0) = 685.0 \\ \\mathrm{cm}^3$ 且 $V_{\\exp}(7.0) = 545.0 \\ \\mathrm{cm}^3$，导致 $z_{V,1} = (685.0 - 545.0) / 70.0 = 2.0$。由于标记的条件是严格不等式 $\\lvert z \\rvert  2$，这些点均不被标记。所有子宫内膜厚度的值也导致残差的绝对值小于或等于 2。计数为 $n_V = 0$ 和 $n_E = 0$。\n结果：$[0, 0]$\n\n案例 3：$t = [3.0, 7.0, 14.0, 28.0]$。此案例显示了复旧不良的模式，其中体积和厚度都持续且显著地大于预期值。对于所有四个时间点，计算出的 $V$ 和 $E$ 的绝对标准化残差都大于 2.0（实际上，它们都约等于 3.0）。例如，在 $t_2 = 7.0$ 天时，$V_{\\mathrm{obs}}(7.0) = 755.0 \\ \\mathrm{cm}^3$，导致 $z_{V,2} = (755.0 - 545.0) / 70.0 = 3.0$。这被标记。所有 4 个体积点和所有 4 个厚度点都被标记。计数为 $n_V = 4$ 和 $n_E = 4$。\n结果：$[4, 4]$\n\n案例 4：$t = [5.0, 6.0, 10.0, 42.0]$。此案例呈现出混合模式。\n- 在 $t_1 = 5.0$ 天时：$z_{V,1} \\approx -2.49$ 且 $z_{E,1} \\approx -2.16$。两者均被标记。\n- 在 $t_2 = 6.0$ 天时：$z_{V,2} \\approx 1.79$ 且 $z_{E,2} \\approx 0.49$。两者均未被标记。\n- 在 $t_3 = 10.0$ 天时：$z_{V,3} \\approx -0.0008$ 且 $z_{E,3} \\approx 1.93$。两者均未被标记。\n- 在 $t_4 = 42.0$ 天时：$z_{V,4} = 3.0$ 且 $z_{E,4} \\approx 0.0002$。体积被标记，但厚度未被标记。\n总共有 2 个标记的体积偏差和 1 个标记的子宫内膜厚度偏差。计数为 $n_V = 2$ 和 $n_E = 1$。\n结果：$[2, 1]$\n\n四个案例的最终汇总结果是 $[[0, 0], [0, 0], [4, 4], [2, 1]]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Applies a first-order relaxation model to postpartum uterine involution data\n    to identify deviations beyond two standard deviations.\n    \"\"\"\n    \n    # Model parameters for uterine volume (V)\n    V0 = 1000.0  # Initial volume in cm^3\n    V_inf = 90.0   # Baseline volume in cm^3\n    t_half_V = 7.0 # Half-life in days\n    sigma_V = 70.0 # Standard deviation in cm^3\n\n    # Model parameters for endometrial thickness (E)\n    E0 = 20.0    # Initial thickness in mm\n    E_inf = 3.0    # Baseline thickness in mm\n    t_half_E = 4.0 # Half-life in days\n    sigma_E = 1.5  # Standard deviation in mm\n    \n    # Calculate decay rate constants k = ln(2) / t_1/2\n    k_V = np.log(2) / t_half_V\n    k_E = np.log(2) / t_half_E\n    \n    # Define the test suite\n    # Each case is a tuple: (time_array, v_obs_array, e_obs_array)\n    test_cases = [\n        # Case 1\n        (\n            np.array([3.0, 7.0, 14.0, 28.0]),\n            np.array([780.0, 530.0, 330.0, 160.0]),\n            np.array([13.5, 8.2, 4.3, 3.0])\n        ),\n        # Case 2\n        (\n            np.array([7.0, 14.0, 21.0, 35.0]),\n            np.array([685.0, 177.5, 343.75, 198.4375]),\n            np.array([10.5, 4.0, 3.2, 6.0])\n        ),\n        # Case 3\n        (\n            np.array([3.0, 7.0, 14.0, 28.0]),\n            np.array([976.41, 755.0, 527.5, 356.875]),\n            np.array([17.62, 12.544, 9.009, 7.632])\n        ),\n        # Case 4\n        (\n            np.array([5.0, 6.0, 10.0, 42.0]),\n            np.array([470.0, 718.0, 428.0, 314.21875]),\n            np.array([6.9, 9.75, 8.9, 3.012])\n        )\n    ]\n    \n    results = []\n    \n    for t_obs, V_obs, E_obs in test_cases:\n        # Calculate expected values using the model equation:\n        # Y_exp(t) = Y_inf + (Y0 - Y_inf) * exp(-k*t)\n        V_exp = V_inf + (V0 - V_inf) * np.exp(-k_V * t_obs)\n        E_exp = E_inf + (E0 - E_inf) * np.exp(-k_E * t_obs)\n        \n        # Calculate standardized residuals: z = (Y_obs - Y_exp) / sigma_Y\n        z_V = (V_obs - V_exp) / sigma_V\n        z_E = (E_obs - E_exp) / sigma_E\n        \n        # Count number of deviations where |z|  2\n        n_V = np.sum(np.abs(z_V)  2)\n        n_E = np.sum(np.abs(z_E)  2)\n        \n        # Store the result for the current case\n        # Convert from numpy.int64 to standard python int for clean printing\n        results.append([int(n_V), int(n_E)])\n\n    # Format the output string to be exactly [[a,b],[c,d],...] with no spaces.\n    # str() of a list includes spaces, so they are removed.\n    output_str = str(results).replace(' ', '')\n    print(output_str)\n\nsolve()\n```", "id": "4494713"}]}