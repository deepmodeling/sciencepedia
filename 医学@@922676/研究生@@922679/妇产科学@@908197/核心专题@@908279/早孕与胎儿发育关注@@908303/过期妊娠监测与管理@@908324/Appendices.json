{"hands_on_practices": [{"introduction": "像无应激试验（NST）这样的胎儿监护测试是处理过期妊娠的基础，但其结果需要仔细解读。一个测试的诊断能力不仅仅在于其敏感度 $S_e$ 和特异度 $S_p$，还在于其在特定人群中的预测价值。本练习 [@problem_id:4492246] 将指导您计算阳性预测值（PPV）和阴性预测值（NPV），这是一项关键技能，用于利用贝叶斯定理将测试结果转化为有意义的临床概率。", "problem": "一个三级产科中心正在对晚期和过期妊娠进行胎儿监护。考虑一个孕周为 $41$ 周的患者队列，她们正在接受无应激试验（NST），这是过期妊娠管理中一项重要的监护工具。定义事件 $D$ 为胎儿在未来 $7$ 天内出现临床显著的损害（例如，出生时酸血症、因胎儿指征进行的紧急手术分娩或死产的复合结局），并定义 $\\overline{D}$ 为没有此类损害。设 $T^{+}$ 表示阳性（无保证的）NST 结果， $T^{-}$ 表示阴性（有保证的）NST 结果。已知在该人群中，NST 预测 $D$ 事件的敏感性为 $0.85$ ，特异性为 $0.90$ ，且 $D$ 的患病率为 $0.03$ 。\n\n以敏感性、特异性和患病率的定义为基础，结合贝叶斯定理和全概率定律，推导阳性预测值 $\\mathbb{P}(D \\mid T^{+})$ 和阴性预测值 $\\mathbb{P}(\\overline{D} \\mid T^{-})$ 关于敏感性、特异性和患病率的一般表达式。然后，使用敏感性 $0.85$ 、特异性 $0.90$ 和患病率 $0.03$ 的数值计算这些表达式。\n\n将阳性预测值和阴性预测值以小数形式（非百分比）报告，并四舍五入至四位有效数字。以有序对 $\\left(\\text{PPV}, \\text{NPV}\\right)$ 的形式提供您的最终数值结果。", "solution": "首先将根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **背景**：晚期和过期妊娠的胎儿监护（孕周 $41$ 周）。\n-   **事件**：\n    -   $D$：胎儿在未来 $7$ 天内出现临床显著的损害。\n    -   $\\overline{D}$：没有此类损害。\n-   **测试结果**：\n    -   $T^{+}$：阳性（无保证的）无应激试验（NST）。\n    -   $T^{-}$：阴性（有保证的）NST。\n-   **概率**：\n    -   NST 预测 $D$ 的敏感性： $\\mathbb{P}(T^{+} \\mid D) = 0.85$ 。\n    -   NST 预测 $D$ 的特异性： $\\mathbb{P}(T^{-} \\mid \\overline{D}) = 0.90$ 。\n    -   $D$ 的患病率： $\\mathbb{P}(D) = 0.03$ 。\n-   **任务要求**：\n    1.  推导阳性预测值 $\\mathbb{P}(D \\mid T^{+})$ 和阴性预测值 $\\mathbb{P}(\\overline{D} \\mid T^{-})$ 关于敏感性、特异性和患病率的一般表达式。\n    2.  使用给定数值计算这些表达式。\n    3.  将数值结果以小数形式报告，四舍五入至四位有效数字，并表示为有序对。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题设置在真实的临床背景（产科）中，并使用标准的流行病学和统计学概念（敏感性、特异性、患病率、预测值）。贝叶斯定理的应用是解决此类问题的正确数学框架。所提供的值对于此类诊断测试是合理的。\n-   **良构性**：该问题是良构的。它提供了推导所需表达式和计算数值所需的所有必要信息。问题明确，并能导向唯一的解。\n-   **客观性**：语言客观、精确，没有主观论断或偏见。\n\n该问题没有任何缺陷。它在科学上是合理的，结构上是形式化的，内容上是完整的，并且是可验证的。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。将提供完整解答。\n\n### 解答\n\n目标是推导阳性预测值（PPV）和阴性预测值（NPV）的表达式，然后计算它们的数值。\n\n设 $S_e$ 表示测试的敏感性， $S_p$ 表示特异性， $P_v$ 表示患病率。\n根据已知条件，我们有：\n-   敏感性： $S_e = \\mathbb{P}(T^{+} \\mid D) = 0.85$\n-   特异性： $S_p = \\mathbb{P}(T^{-} \\mid \\overline{D}) = 0.90$\n-   患病率： $P_v = \\mathbb{P}(D) = 0.03$\n\n从这些定义中，我们可以推导出其他必要的概率：\n-   假阴性概率为 $1 - S_e = \\mathbb{P}(T^{-} \\mid D) = 1 - 0.85 = 0.15$ 。\n-   无病概率为 $\\mathbb{P}(\\overline{D}) = 1 - P_v = 1 - 0.03 = 0.97$ 。\n-   假阳性概率为 $1 - S_p = \\mathbb{P}(T^{+} \\mid \\overline{D}) = 1 - 0.90 = 0.10$ 。\n\n**1. 阳性预测值（PPV）的推导**\n\n阳性预测值是在测试结果为阳性的情况下患有该病的概率，即 $\\mathbb{P}(D \\mid T^{+})$ 。使用贝叶斯定理：\n$$ \\mathbb{P}(D \\mid T^{+}) = \\frac{\\mathbb{P}(T^{+} \\mid D) \\mathbb{P}(D)}{\\mathbb{P}(T^{+})} $$\n分母 $\\mathbb{P}(T^{+})$ 是测试结果为阳性的总概率。可以使用全概率定律将其展开：\n$$ \\mathbb{P}(T^{+}) = \\mathbb{P}(T^{+} \\mid D) \\mathbb{P}(D) + \\mathbb{P}(T^{+} \\mid \\overline{D}) \\mathbb{P}(\\overline{D}) $$\n代入敏感性、特异性和患病率的术语：\n$$ \\mathbb{P}(T^{+}) = (S_e)(P_v) + (1 - S_p)(1 - P_v) $$\n因此，PPV 的一般表达式为：\n$$ \\text{PPV} = \\mathbb{P}(D \\mid T^{+}) = \\frac{(S_e)(P_v)}{(S_e)(P_v) + (1 - S_p)(1 - P_v)} $$\n\n**2. 阴性预测值（NPV）的推导**\n\n阴性预测值是在测试结果为阴性的情况下不患有该病的概率，即 $\\mathbb{P}(\\overline{D} \\mid T^{-})$ 。使用贝叶斯定理：\n$$ \\mathbb{P}(\\overline{D} \\mid T^{-}) = \\frac{\\mathbb{P}(T^{-} \\mid \\overline{D}) \\mathbb{P}(\\overline{D})}{\\mathbb{P}(T^{-})} $$\n分母 $\\mathbb{P}(T^{-})$ 是测试结果为阴性的总概率。可以使用全概率定律将其展开：\n$$ \\mathbb{P}(T^{-}) = \\mathbb{P}(T^{-} \\mid \\overline{D}) \\mathbb{P}(\\overline{D}) + \\mathbb{P}(T^{-} \\mid D) \\mathbb{P}(D) $$\n代入敏感性、特异性和患病率的术语：\n$$ \\mathbb{P}(T^{-}) = (S_p)(1 - P_v) + (1 - S_e)(P_v) $$\n因此，NPV 的一般表达式为：\n$$ \\text{NPV} = \\mathbb{P}(\\overline{D} \\mid T^{-}) = \\frac{(S_p)(1 - P_v)}{(S_p)(1 - P_v) + (1 - S_e)(P_v)} $$\n\n**3. 数值计算**\n\n现在，我们将给定的数值代入推导出的表达式中。\n-   $S_e = 0.85$\n-   $S_p = 0.90$\n-   $P_v = 0.03$\n\n**计算 PPV：**\n$$ \\text{PPV} = \\frac{(0.85)(0.03)}{(0.85)(0.03) + (1 - 0.90)(1 - 0.03)} $$\n$$ \\text{PPV} = \\frac{0.0255}{0.0255 + (0.10)(0.97)} $$\n$$ \\text{PPV} = \\frac{0.0255}{0.0255 + 0.097} $$\n$$ \\text{PPV} = \\frac{0.0255}{0.1225} \\approx 0.208163265... $$\n四舍五入至四位有效数字，我们得到 $\\text{PPV} = 0.2082$ 。\n\n**计算 NPV：**\n$$ \\text{NPV} = \\frac{(0.90)(1 - 0.03)}{(0.90)(1 - 0.03) + (1 - 0.85)(0.03)} $$\n$$ \\text{NPV} = \\frac{(0.90)(0.97)}{(0.90)(0.97) + (0.15)(0.03)} $$\n$$ \\text{NPV} = \\frac{0.873}{0.873 + 0.0045} $$\n$$ \\text{NPV} = \\frac{0.873}{0.8775} \\approx 0.994871794... $$\n四舍五入至四位有效数字，我们得到 $\\text{NPV} = 0.9949$ 。\n\n最终答案是有序对 $(\\text{PPV}, \\text{NPV})$ 。", "answer": "$$\\boxed{(0.2082, 0.9949)}$$", "id": "4492246"}, {"introduction": "临床决策通常是一个动态地收集和整合新信息的过程。在初次测试结果不理想后，临床医生很少会在没有进一步精确风险评估的情况下直接采取重大干预措施。本练习 [@problem_id:4492284] 模拟了这一真实场景，展示了后续的更具特异性的测试（生物物理评分，BPP）如何在初次可疑结果后，量化地更新胎儿窘迫的概率，从而阐明序贯测试在避免不必要干预中的作用。", "problem": "一位孕$2$产$1$、孕$41^{+3}$周的过期单胎妊娠孕妇正在接受常规胎儿监护。临床问题是胎儿当前是否存在宫内窘迫（操作化定义为可能需要在$24$小时内分娩的临床显著性缺氧或酸血症）。在本单元中，请考虑以下情景和参数：\n\n- 在这个过期妊娠监护人群中，胎儿宫内窘迫的检验前概率为 $p_{0} = 0.12$。\n- 第一个检验是无应激试验（NST），其中无反应结果被认为是胎儿宫内窘迫的阳性检验。在这种情况下，NST的敏感性为 $Se_{\\mathrm{NST}} = 0.70$，特异性为 $Sp_{\\mathrm{NST}} = 0.80$。\n- 第二个检验是生物物理评分（BPP），其中正常的BPP（评分 $\\geq 8$ 且不因无反应而扣分）被认为是胎儿宫内窘迫的阴性检验。在这种情况下，异常BPP的敏感性为 $Se_{\\mathrm{BPP}} = 0.95$，特异性为 $Sp_{\\mathrm{BPP}} = 0.90$。\n- 假设在给定真实胎儿状态（宫内窘迫与非宫内窘迫）的情况下，NST和BPP是条件独立的。\n\n该孕妇的结果序列是无反应的NST，随后是正常的BPP。\n\n仅使用上述信息和基于临床检验特征的概率推断基本原理，计算经过这一系列检验后当前胎儿宫内窘迫的后验概率。以小数形式表示最终概率，并将答案四舍五入到四位有效数字。不要使用百分号。\n\n然后，基于此监护方案中分娩的行动阈值 $\\tau = 0.10$，从概念上解释（除了您计算的后验概率外，不需要额外计算）与仅根据无反应的NST采取行动相比，无反应的NST后接着进行正常的BPP这一组合如何减少了不必要的分娩。", "solution": "该问题是有效的，因为它在科学上基于概率推断，信息充分且一致，表述客观。\n\n这个问题需要使用贝叶斯定理依次计算后验概率。让我们根据提供的信息定义相关事件和概率。\n\n设 $C$ 为胎儿宫内窘迫事件。其补集 $C^c$ 为胎儿未发生宫内窘迫事件。\n宫内窘迫的检验前概率为 $P(C) = p_{0} = 0.12$。\n因此，无宫内窘迫的概率为 $P(C^c) = 1 - P(C) = 1 - 0.12 = 0.88$。\n\n设 $T_1^+$ 表示阳性无应激试验（NST），即无反应结果。\n设 $T_2^-$ 表示阴性生物物理评分（BPP），即正常结果（评分 $\\geq 8$）。\n该孕妇的检验结果序列为 $(T_1^+, T_2^-)$。\n\n提供的检验特征如下：\n对于NST：\n- 敏感性：$Se_{\\mathrm{NST}} = P(T_1^+ | C) = 0.70$。\n- 特异性：$Sp_{\\mathrm{NST}} = P(T_1^- | C^c) = 0.80$，其中 $T_1^-$ 是阴性（有反应）NST。\n从特异性我们可以推导出NST的假阳性率：$P(T_1^+ | C^c) = 1 - Sp_{\\mathrm{NST}} = 1 - 0.80 = 0.20$。\n\n对于BPP：\n- 敏感性：$Se_{\\mathrm{BPP}} = P(T_2^+ | C) = 0.95$，其中 $T_2^+$ 是阳性（异常）BPP。\n- 特异性：$Sp_{\\mathrm{BPP}} = P(T_2^- | C^c) = 0.90$。\n从敏感性我们可以推导出BPP的假阴性率：$P(T_2^- | C) = 1 - Se_{\\mathrm{BPP}} = 1 - 0.95 = 0.05$。\n\n我们需要计算在NST阳性和BPP阴性的情况下胎儿宫内窘迫的后验概率，即 $P(C | T_1^+, T_2^-)$。\n我们将使用贝叶斯定理。问题陈述中说明，在给定真实胎儿状态的情况下，这些检验是条件独立的。这意味着 $P(T_1^+, T_2^- | C) = P(T_1^+ | C) P(T_2^- | C)$ 并且 $P(T_1^+, T_2^- | C^c) = P(T_1^+ | C^c) P(T_2^- | C^c)$。\n\n后验概率的公式为：\n$$ P(C | T_1^+, T_2^-) = \\frac{P(T_1^+, T_2^- | C) P(C)}{P(T_1^+, T_2^-)} $$\n分母 $P(T_1^+, T_2^-)$ 可以使用全概率定律展开：\n$$ P(T_1^+, T_2^-) = P(T_1^+, T_2^- | C) P(C) + P(T_1^+, T_2^- | C^c) P(C^c) $$\n将条件独立性假设代入贝叶斯定理的完整公式中：\n$$ P(C | T_1^+, T_2^-) = \\frac{P(T_1^+ | C) P(T_2^- | C) P(C)}{P(T_1^+ | C) P(T_2^- | C) P(C) + P(T_1^+ | C^c) P(T_2^- | C^c) P(C^c)} $$\n\n现在，我们将给定的数值代入此表达式中。公式的组成部分如下：\n- $P(C) = 0.12$\n- $P(C^c) = 0.88$\n- $P(T_1^+ | C) = 0.70$\n- $P(T_2^- | C) = 0.05$\n- $P(T_1^+ | C^c) = 0.20$\n- $P(T_2^- | C^c) = 0.90$\n\n分子是患病且得到这种特定检验结果组合的概率：\n$$ \\text{Numerator} = P(T_1^+ | C) P(T_2^- | C) P(C) = (0.70) \\times (0.05) \\times (0.12) = 0.0042 $$\n\n分母是得到这种检验结果组合的总概率，包括宫内窘迫和非宫内窘迫的胎儿。它由两项组成：\n第一项与分子相同：\n$$ P(T_1^+ | C) P(T_2^- | C) P(C) = 0.0042 $$\n第二项是未患病且得到这种特定检验结果组合的概率：\n$$ P(T_1^+ | C^c) P(T_2^- | C^c) P(C^c) = (0.20) \\times (0.90) \\times (0.88) = 0.1584 $$\n总分母是这两项的和：\n$$ \\text{Denominator} = 0.0042 + 0.1584 = 0.1626 $$\n\n最后，后验概率是分子与分母的比值：\n$$ P(C | T_1^+, T_2^-) = \\frac{0.0042}{0.1626} \\approx 0.025830258... $$\n四舍五入到四位有效数字，我们得到 $0.02583$。\n\n对于问题的第二部分，我们需要在给定行动阈值 $\\tau = 0.10$ 的情况下，从概念上解释这种序贯检验如何减少不必要的分娩。\n首先，考虑仅根据NST结果采取行动的情况。该孕妇的NST结果为无反应，这是一个阳性检验 ($T_1^+$)。仅经过这一个检验后，胎儿宫内窘迫的后验概率 $P(C|T_1^+)$ 将是：\n$$ P(C|T_1^+) = \\frac{P(T_1^+|C)P(C)}{P(T_1^+|C)P(C) + P(T_1^+|C^c)P(C^c)} = \\frac{(0.70)(0.12)}{(0.70)(0.12) + (0.20)(0.88)} = \\frac{0.084}{0.084 + 0.176} = \\frac{0.084}{0.260} \\approx 0.323 $$\n由于这个概率（约 $0.323$）大于行动阈值 $\\tau = 0.10$，因此仅根据无反应的NST就会做出分娩的决定。\n\n然而，监护方案中包含了随后的BPP。该孕妇的正常BPP结果 ($T_2^-$) 提供了强有力的反对胎儿宫内窘迫的证据，因为BPP具有高特异性 ($Sp_{\\mathrm{BPP}}=0.90$) 且其假阴性率很低 ($1 - Se_{\\mathrm{BPP}}=0.05$)。这一新信息将宫内窘迫的概率从 $P(C|T_1^+) \\approx 0.323$ 显著向下修正为我们计算出的最终后验概率 $P(C|T_1^+, T_2^-) \\approx 0.02583$。\n\n这个约 $2.6\\%$ 的最终概率远低于 $0.10$ 的行动阈值 $\\tau$。因此，根据综合检验结果，决定是继续监护，而不是进行分娩。\n\n总之，在无反应的NST之后序贯使用BPP可以澄清胎儿的状态。无反应的NST具有相对较高的假阳性率（在本例中为 $P(T_1^+|C^c)=0.20$），这意味着许多非宫内窘迫的胎儿会出现此结果。后续的BPP是一种诊断准确性更高的检验，能有效地筛除这些假阳性。通过重新评估风险并发现其较低，联合检验策略避免了因仅根据初始、特异性较低的检验结果而触发的不必要的医源性分娩。这提高了监护策略的整体特异性，并避免了与并非真正有指征的干预相关的母体和胎儿风险。", "answer": "$$\n\\boxed{0.02583}\n$$", "id": "4492284"}, {"introduction": "除了管理单个患者，临床医生还必须理解不同管理策略（如常规引产与期待疗法）在人群层面的证据。绝对风险降低（ARR）告诉我们效应的大小，但需治数（NNT）为临床实践提供了一个更直观的指标。本练习 [@problem_id:4492237] 专注于计算 NNT，这有助于回答一个关键问题：“我们必须用一种策略治疗多少名患者才能预防一例不良结局？”", "problem": "一项在其他方面为低风险的单胎妊娠中，对满$41$周时常规引产与期待处理至$42$周进行的随机比较报告称，围产期死亡的绝对风险差异为每$1{,}000$例分娩中有$0.9$例，此差异有利于引产，其定义为期待处理组的风险减去引产组的风险。在围产期流行病学中，一个事件的绝对风险是在指定时间窗口内该事件发生的个体水平概率，而绝对风险降低 (ARR) 是对照组和干预组之间绝对风险的差异。需治数 (NNT) 定义为，在同一时间窗口内，与对照策略（期待处理至$42$周）相比，为预防一例额外事件（此处指一例围产期死亡）而必须接受干预（此处指在$41$周时常规引产）的个体数量。\n\n从这些定义和针对个体间独立结果的标准概率推理出发，推导$NNT$对绝对风险降低的函数依赖关系，然后根据报告的每$1{,}000$例分娩中有$0.9$例的绝对风险差异计算$NNT$。将最终答案表示为妊娠个体的人数。将最终答案四舍五入至四位有效数字。在您的计算过程或最终答案中不要使用百分号。", "solution": "设 $p_{\\text{exp}}$ 表示在期待处理至$42$周的情况下围产期死亡的绝对风险（概率），设 $p_{\\text{ind}}$ 表示在$41$周时常规引产的情况下的绝对风险。根据定义，绝对风险降低 (ARR) 为\n$$\n\\text{ARR} \\equiv p_{\\text{exp}} - p_{\\text{ind}}.\n$$\n我们已知，观察到的有利于引产的绝对风险差异为每$1{,}000$例分娩中有$0.9$例，这意味着\n$$\n\\text{ARR} = \\frac{0.9}{1{,}000}.\n$$\n\n为了将 ARR 与需治数 (NNT) 联系起来，考虑一个由 $N$ 个个体组成的队列，他们都接受干预（在$41$周时引产）而不是对照（期待处理至$42$周）。在给定策略下个体结果独立同分布的标准假设下，将这 $N$ 个个体从对照策略转换为干预策略所预防的事件的期望数量等于个体期望减少量的总和，即\n$$\n\\mathbb{E}[\\text{events prevented in } N] = N \\times \\text{ARR}.\n$$\n需治数被定义为使得预防的事件的期望数量等于 $1$（即预防了一个额外的事件）时的队列大小 $N$：\n$$\nN \\times \\text{ARR} = 1.\n$$\n对 $N$ 求解，得到基本关系式\n$$\nNNT = \\frac{1}{\\text{ARR}}.\n$$\n\n代入给定的 ARR 值：\n$$\n\\text{ARR} = \\frac{0.9}{1{,}000} = 0.0009.\n$$\n因此，\n$$\nNNT = \\frac{1}{0.0009} = \\frac{1}{9 \\times 10^{-4}} = \\frac{10^{4}}{9} \\approx 1111.111\\ldots\n$$\n四舍五入到四位有效数字得到\n$$\nNNT \\approx 1111.\n$$\n这应报告为妊娠个体的数量。", "answer": "$$\\boxed{1111}$$", "id": "4492237"}]}