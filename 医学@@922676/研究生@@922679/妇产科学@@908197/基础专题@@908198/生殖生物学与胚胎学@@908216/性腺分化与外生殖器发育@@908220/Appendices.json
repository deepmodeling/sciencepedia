{"hands_on_practices": [{"introduction": "本练习为性发育异常 (differences of sex development, DSDs) 的临床诊断提供了一个基础框架。通过系统地应用性腺决定、激素合成和雄激素作用的原理，您将学习根据潜在的病理生理学和预期的表型来区分 DSD 的主要类别 [@problem_id:4447216]。这项实践对于培养准确诊断和患者咨询所需的机理推理能力至关重要。", "problem": "一位临床医生正在评估患有性发育异常的新生儿和青少年，旨在利用性别决定和分化的第一性原理框架从机制上对他们进行分类。从以下基础知识开始：在染色体男性 ($46,XY$) 中，一个功能性的Y染色体性别决定区 (SRY) 会上调未分化性腺嵴中的SOX9，从而指定Sertoli细胞分化。Sertoli细胞分泌抗苗勒管激素 (AMH)，使副中肾管 (Müllerian管) 退化。胎儿Leydig细胞在黄体生成素 (LH)/人绒毛膜促性腺激素 (hCG) 的刺激下产生睾酮，睾酮稳定中肾管 (Wolffian管) 并使其男性化。睾酮在泌尿生殖靶组织中通过II型5α-还原酶外周转化为双氢睾酮 (DHT)，这是外生殖器和泌尿生殖窦男性化所必需的。功能性雄激素受体 (AR) 信号传导是产生对睾酮和DHT的转录反应所必需的。在性腺决定层面（例如，睾丸发育失败）、雄激素合成层面（例如，类固醇生成酶缺陷）或雄激素作用层面（例如，AR缺陷）的障碍会产生独特的内部和外部表型。\n\n下列哪个陈述正确地应用了此框架来区分完全性和部分性性腺发育不全与雄激素合成障碍和雄激素作用障碍，并引用了典型的遗传原因和预期的外生殖器表型？选择所有适用项。\n\nA. 在$46,XY$完全性性腺发育不全 (Swyer综合征) 中，SRY的功能丧失或MAP3K1的功能获得会阻止睾丸决定，产生条索状性腺，其产生的AMH和睾酮可忽略不计；Müllerian结构保留，外生殖器通常为女性。\n\nB. 在部分性性腺发育不全中，NR5A1 (类固醇生成因子$1$) 或WT1的致病性变异可导致发育不良的睾丸，其会分泌一些AMH和睾酮；Müllerian结构可能不同程度地存在，外生殖器通常模糊不清。\n\nC. 在由AR突变引起的$46,XY$完全性雄激素不敏感综合征 (CAIS) 中，Sertoli细胞功能和AMH分泌是完整的，因此Müllerian结构退化；然而，由于靶器官雄激素抵抗，外生殖器为女性，阴毛/腋毛稀少至缺如。\n\nD. 在$46,XY$ II型5α-还原酶缺乏症 (SRD5A2) 中，睾酮生物合成全局性减少，Müllerian结构持续存在，导致内部女性解剖结构和男性化不足的外生殖器。\n\nE. 在$46,XY$ $3$型$17\\beta$-羟基类固醇脱氢酶 (HSD17B3) 缺乏症中，雄烯二酮向睾酮的转化受损导致出生时外生殖器模糊不清或呈女性外观，且无Müllerian结构，青春期可能由于雄激素产生增加和外周转化而出现男性化。\n\n选择最佳的正确陈述组合。", "solution": "问题陈述为哺乳动物的性别决定和分化提供了一个科学上准确且内部一致的框架。该问题提法得当、客观，不包含任何使其无效的缺陷。任务是应用此框架来评估关于各种性发育异常 (DSD) 的五个陈述的正确性。此问题有效，我将对每个选项进行系统性分析。\n\n该基础框架可以通过以下针对染色体男性 ($46,XY$) 的因果链进行总结：\n$1$. **性腺决定**：一个功能性的SRY基因启动一个级联反应（涉及SOX9），将未分化性腺分化为睾丸。\n$2$. **内部导管分化**：睾丸包含Sertoli细胞和Leydig细胞。\n    a. Sertoli细胞产生抗苗勒管激素 (AMH)，导致Müllerian管 (副中肾管) 退化。没有AMH，这些导管会发育成子宫、输卵管和阴道上段。\n    b. Leydig细胞产生睾酮，支持Wolffian管 (中肾管) 发育为附睾、输精管和精囊。没有睾酮，这些导管会退化。\n$3$. **外生殖器分化**：睾酮在外生殖器组织中被$2$型$5\\alpha$-还原酶转化为更有效的雄激素——双氢睾酮 (DHT)。DHT驱动泌尿生殖窦和外生殖器的男性化。在没有雄激素的情况下，外生殖器会沿着女性途径发育。\n$4$. **雄激素作用**：睾酮和DHT都需要靶细胞中功能性的雄激素受体 (AR) 来发挥其作用。\n\n障碍可能发生在性腺决定、雄激素合成或雄激素作用的层面。\n\n**选项A分析**\n\n该陈述描述了$46,XY$完全性性腺发育不全 (CGD)，也称为Swyer综合征。\n- **障碍层面**：该陈述正确地将其识别为睾丸决定失败，这是**性腺决定层面**的障碍。\n- **遗传原因**：它正确地引用了SRY的功能丧失性突变或MAP3K1的功能获得性突变作为潜在原因。这些突变阻止了未分化性腺分化为睾丸。\n- **性腺表型**：没有睾丸决定信号，性腺保持未分化状态或形成无功能的“条索状性腺”。“产生条索状性腺”的说法是正确的。\n- **激素状况**：条索状性腺缺乏功能性的Sertoli和Leydig细胞。因此，它们既不产生AMH也不产生睾酮。“产生可忽略不计的AMH和睾酮”的说法是正确的。\n- **内部/外部表型**：\n    - 缺少AMH使得Müllerian管得以保留和发育。“Müllerian结构保留”的说法是正确的。\n    - 缺少睾酮导致Wolffian管退化，并阻止了外生殖器的男性化，外生殖器沿着默认的女性途径发育。“外生殖器通常为女性”的说法是正确的。\n- **结论**：该陈述对$46,XY$ CGD的病理生理学和表型提供了完整而准确的描述，与所提供的框架一致。\n- **判定**：**正确**。\n\n**选项B分析**\n\n该陈述描述了部分性性腺发育不全。\n- **障碍层面**：这也是一种**性腺决定**障碍，但障碍是不完全的。\n- **遗传原因**：它正确地引用了对性腺发育至关重要的基因（如NR5A1（编码类固醇生成因子$1$）或WT1）中的致病性变异作为原因。\n- **性腺表型**：这些基因变异导致形成“发育不良的睾丸”，这些睾丸有一些睾丸组织，但在结构和功能上受损。\n- **激素状况**：因为存在一些功能性的Sertoli和Leydig细胞组织，所以会产生一些AMH和一些睾酮，但通常处于次优水平。“分泌一些AMH和睾酮”的说法是正确的。\n- **内部/外部表型**：\n    - 部分AMH的产生可能导致Müllerian管不完全退化。“Müllerian结构可能不同程度地存在”的说法是正确的。\n    - 部分睾酮的产生导致Wolffian管的不完全稳定，更重要的是，对于外部表型而言，DHT的产生不足以实现完全的男性化。这导致了模糊不清的生殖器。“外生殖器通常模糊不清”的说法是正确的。\n- **结论**：该陈述准确地描绘了由功能部分丧失的发育不良睾丸导致的部分性性腺发育不全的多变性。\n- **判定**：**正确**。\n\n**选项C分析**\n\n该陈述描述了$46,XY$完全性雄激素不敏感综合征 (CAIS)。\n- **障碍层面**：该陈述正确地将其识别为由雄激素受体 (AR) 基因突变引起的**雄激素作用**障碍。\n- **性腺决定与功能**：在$46,XY$个体中，SRY功能正常，因此睾丸正常发育。Sertoli细胞功能正常并产生AMH。Leydig细胞功能正常并产生睾酮（由于缺乏负反馈，水平通常升高）。“Sertoli细胞功能和AMH分泌是完整的”的说法是正确的。\n- **内部/外部表型**：\n    - 正常的AMH产生导致Müllerian管完全退化。“Müllerian结构退化”的说法是正确的。\n    - 尽管产生了睾酮，但无功能的AR阻止了Wolffian管的稳定，因此它们会退化。\n    - 尽管睾酮和DHT存在，但靶组织无法对其作出反应，这意味着外生殖器沿着默认的女性途径发育。“外生殖器为女性”的说法是正确的。\n    - 补充细节指出，雄激素依赖性第二性征，如阴毛和腋毛，“稀少至缺如”，这也是CAIS的一个经典且正确的特征。\n- **结论**：该陈述准确地将框架应用于一种雄激素作用障碍，正确描述了激素环境及其导致的表型。\n- **判定**：**正确**。\n\n**选项D分析**\n\n该陈述描述了$46,XY$ $2$型$5\\alpha$-还原酶缺乏症 (SRD5A2)。\n- **障碍层面**：这是一种雄激素代谢障碍，特指睾酮向DHT的转化过程。\n- **陈述分析**：\n    - “睾酮生物合成全局性减少”：这是**不正确**的。缺陷不在于睾酮的合成，而在于其转化。睾酮水平通常是正常或升高的。\n    - “Müllerian结构持续存在”：这是**不正确**的。在患有SRD5A2缺乏症的$46,XY$个体中，睾丸正常形成并产生AMH。因此，Müllerian结构退化。\n    - “导致内部女性解剖结构和男性化不足的外生殖器”：内部解剖结构是男性的（睾丸，Wolffian结构），而非女性。“男性化不足的外生殖器”的说法是正确的，但它建立在关于睾酮和内部解剖结构的错误陈述之上。\n- **结论**：该陈述包含关于此病症病理生理学的多个基本错误。\n- **判定**：**不正确**。\n\n**选项E分析**\n\n该陈述描述了$46,XY$ $3$型$17\\beta$-羟基类固醇脱氢酶 (HSD17B3) 缺乏症。\n- **障碍层面**：这是一种**雄激素合成**障碍。HSD17B3酶是睾丸中睾酮合成的最后一步所必需的。\n- **陈述分析**：\n    - “雄烯二酮向睾酮的转化受损”：这是对酶缺陷的精确和正确描述。\n    - “无Müllerian结构”：这是正确的。睾丸在子宫内正常形成并产生AMH，导致Müllerian管退化。\n    - “出生时外生殖器模糊不清或呈女性外观”：这是正确的。胎儿睾酮（以及由此产生的DHT）的严重缺乏导致外生殖器缺乏男性化。\n    - “青春期可能由于雄激素产生增加和外周转化而出现男性化”：这也是正确的，是该病症的一个决定性特征。在青春期，大量的前体雄烯二酮被分泌，并通过外周组织中的其他$17\\beta$-HSD同工酶转化为睾酮，导致男性化。\n- **结论**：该陈述对HSD17B3缺乏症的病因、出生时表现和青春期过程提供了医学上准确的描述，完全符合所提供的框架。\n- **判定**：**正确**。", "answer": "$$\\boxed{ABCE}$$", "id": "4447216"}, {"introduction": "外生殖器的男性化关键取决于局部组织将睾酮转化为效力更强的二氢睾酮 ($DHT$)。这项实践让您能够将米氏-孟顿 (Michaelis–Menten) 酶动力学原理应用于一个真实的生物学场景 [@problem_id:4447235]。通过计算胎儿生殖器组织中 $DHT$ 的生成速率，您将对酶的功能如何直接控制关键的形态发生过程获得定量的理解。", "problem": "胎儿外生殖器发育的一个关键步骤是在生殖器皮肤中，由类固醇5α-还原酶2型（SRD5A2）催化睾酮转化为双氢睾酮（DHT）。考虑一份来自妊娠中期胎儿的生殖器皮肤活检样本，其中SRD5A2介导的睾酮向DHT的转化在称为Michaelis–Menten动力学的单底物、准稳态酶动力学机制下进行，烟酰胺腺嘌呤二核苷酸磷酸（NADPH）辅因子充足，且产物抑制可忽略不计。该组织的生物化学特征如下：睾酮的Michaelis常数$K_{m}$测量值为$0.35\\,\\mu\\text{M}$，每毫克SRD5A2蛋白的SRD5A2最大速度$V_{\\max}$为$260\\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{mg}^{-1}$，局部间质睾酮浓度为$1.2\\,\\mu\\text{M}$，测得的SRD5A2蛋白含量为每克湿组织$0.60\\,\\text{mg}$ SRD5A2。假设在所考虑的时间尺度上，底物和酶在取样组织内空间分布均匀，且反应是有效不可逆的。\n\n从构成Michaelis–Menten动力学基础的酶-底物复合物形成和分解的基本假设出发，确定在这些条件下每克组织的DHT稳态生成速率。以$\\text{nmol}\\,\\text{h}^{-1}\\,\\text{g}^{-1}$为单位表示您的最终答案，并将答案四舍五入至四位有效数字。", "solution": "首先对问题进行验证，以确保其科学上合理、提法恰当且客观。\n\n**步骤1：提取已知条件**\n-   动力学模型：Michaelis–Menten动力学（单底物，准稳态）。\n-   酶：类固醇5α-还原酶2型 (SRD5A2)。\n-   底物 ($S$)：睾酮。\n-   产物 ($P$)：双氢睾酮 (DHT)。\n-   睾酮的Michaelis常数：$K_m = 0.35\\,\\mu\\text{M}$。\n-   比最大速度：$V_{\\max, \\text{specific}} = 260\\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{mg}^{-1}$ SRD5A2蛋白。\n-   底物浓度：$[S] = 1.2\\,\\mu\\text{M}$。\n-   组织中的酶含量：每克湿组织含$0.60\\,\\text{mg}$ SRD5A2。\n-   假设：NADPH辅因子充足，产物抑制可忽略，空间均匀，反应不可逆。\n-   要求输出：每克组织的DHT稳态生成速率，以$\\text{nmol}\\,\\text{h}^{-1}\\,\\text{g}^{-1}$为单位表示，并四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题描述了一个基于已完善建立的Michaelis-Menten模型的标准酶动力学情景。其生物学背景（SRD5A2催化睾酮转化为DHT）是内分泌学和发育生物学中的一个基本过程。所提供的动力学参数（$K_m$）和浓度在该生物学系统的生理学合理范围内。问题是自洽的，提供了计算所需的所有数据。语言客观，问题提法恰当，寻求一个唯一的数值解。不存在违反科学原理之处、矛盾或歧义。因此，该问题被视为**有效的**。\n\n**步骤3：开始求解**\n问题要求计算DHT的稳态生成速率，这对应于给定条件下的反应速度$v$。如问题所述，采用Michaelis-Menten框架是合适的。\n\nMichaelis-Menten动力学的基础模型涉及酶（$E$）和底物（$S$）形成酶-底物复合物（$ES$），该复合物随后分解，释放产物（$P$）并再生游离酶。\n$$ E + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\xrightarrow{k_2} E + P $$\n准稳态假设要求中间复合物$[ES]$的浓度保持恒定，即$\\frac{d[ES]}{dt} \\approx 0$。这导出了Michaelis-Menten方程，该方程将初始反应速度（$v$）与底物浓度（$[S]$）联系起来：\n$$ v = \\frac{V_{\\max} [S]}{K_m + [S]} $$\n此处，$v$表示产物生成速率，$V_{\\max}$是在饱和底物浓度下的最大可能反应速率，$K_m$是Michaelis常数，即反应速率为$V_{\\max}$一半时的底物浓度。\n\n首先，我们必须确定$1\\,\\text{g}$组织的总最大速度$V_{\\max, \\text{tissue}}$。问题提供了酶的比活力及其在组织中的浓度。\n比最大速度给定为：\n$$ V_{\\max, \\text{specific}} = 260\\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{mg}^{-1} $$\n酶含量为：\n$$ \\text{Enzyme Content} = 0.60\\,\\frac{\\text{mg SRD5A2}}{\\text{g tissue}} $$\n每克组织的最大速度是这两个值的乘积：\n$$ V_{\\max, \\text{tissue}} = V_{\\max, \\text{specific}} \\times \\text{Enzyme Content} $$\n$$ V_{\\max, \\text{tissue}} = \\left(260\\,\\frac{\\text{pmol}}{\\text{min} \\cdot \\text{mg}}\\right) \\times \\left(0.60\\,\\frac{\\text{mg}}{\\text{g}}\\right) $$\n$$ V_{\\max, \\text{tissue}} = 156\\,\\frac{\\text{pmol}}{\\text{min} \\cdot \\text{g}} $$\n这个值代表了在睾酮浓度无限高的情况下，每克组织的最大DHT生成速率。\n\n接下来，我们使用Michaelis-Menten方程来计算在给定睾酮浓度下的实际反应速率$v_{\\text{tissue}}$。给定值为：\n-   $V_{\\max, \\text{tissue}} = 156\\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{g}^{-1}$\n-   $[S] = 1.2\\,\\mu\\text{M}$\n-   $K_m = 0.35\\,\\mu\\text{M}$\n\n$$ v_{\\text{tissue}} = \\frac{V_{\\max, \\text{tissue}} [S]}{K_m + [S]} $$\n$[S]$ 和 $K_m$ 的单位相同（$\\mu\\text{M}$），因此它们在分数项中会抵消。\n$$ v_{\\text{tissue}} = \\frac{\\left(156\\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{g}^{-1}\\right) \\times (1.2\\,\\mu\\text{M})}{0.35\\,\\mu\\text{M} + 1.2\\,\\mu\\text{M}} $$\n$$ v_{\\text{tissue}} = \\left(156\\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{g}^{-1}\\right) \\times \\frac{1.2}{1.55} $$\n$$ v_{\\text{tissue}} = 156 \\times 0.7741935... \\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{g}^{-1} $$\n$$ v_{\\text{tissue}} = 120.7741935...\\,\\text{pmol}\\,\\text{min}^{-1}\\,\\text{g}^{-1} $$\n\n最后一步是将计算出的速率单位从$\\text{pmol}\\,\\text{min}^{-1}\\,\\text{g}^{-1}$转换为要求的$\\text{nmol}\\,\\text{h}^{-1}\\,\\text{g}^{-1}$。\n我们使用以下转换因子：\n-   $1\\,\\text{nmol} = 1000\\,\\text{pmol}$，或 $1\\,\\text{pmol} = 10^{-3}\\,\\text{nmol}$。\n-   $1\\,\\text{h} = 60\\,\\text{min}$，或 $1\\,\\text{min}^{-1} = 60\\,\\text{h}^{-1}$。\n\n应用这些转换：\n$$ v_{\\text{tissue}} = 120.7741935... \\frac{\\text{pmol}}{\\text{min} \\cdot \\text{g}} \\times \\frac{10^{-3}\\,\\text{nmol}}{1\\,\\text{pmol}} \\times \\frac{60\\,\\text{min}}{1\\,\\text{h}} $$\n$$ v_{\\text{tissue}} = 120.7741935... \\times 10^{-3} \\times 60 \\,\\frac{\\text{nmol}}{\\text{h} \\cdot \\text{g}} $$\n$$ v_{\\text{tissue}} = 120.7741935... \\times 0.060 \\,\\frac{\\text{nmol}}{\\text{h} \\cdot \\text{g}} $$\n$$ v_{\\text{tissue}} = 7.24645161...\\,\\frac{\\text{nmol}}{\\text{h} \\cdot \\text{g}} $$\n\n最后，我们按照要求将结果四舍五入到四位有效数字。第五位有效数字是4，因此我们向下舍入。\n$$ v_{\\text{tissue}} \\approx 7.246\\,\\text{nmol}\\,\\text{h}^{-1}\\,\\text{g}^{-1} $$\n这就是在指定条件下每克组织的DHT稳态生成速率。", "answer": "$$\\boxed{7.246}$$", "id": "4447235"}, {"introduction": "形态发生不仅取决于激素的存在，还取决于它们的空间分布。这项高级实践介绍了一种计算方法，用于模拟睾酮梯度如何在发育中的生殖器结节内形成和维持 [@problem_id:4447253]。通过实施一个扩散-反应模型，您将探索物理原理和生化参数如何相互作用以创建雄激素受体激活的空间模式，从而为我们理解协调组织发育的机制提供深刻的见解。", "problem": "要求您实现一个确定性模拟器，该模拟器使用扩散-反应模型来计算代表生殖结节间充质的一维空间域上的稳态睾酮浓度场，并从中推导出雄激素受体（AR; androgen receptor）激活的空间区域，以及基于两个数学陈述的标准得出的关于尿道闭合能力的最终布尔决策。所有计算都必须在一个无用户输入的程序中完成，并且输出必须按末尾指定的方式汇总为单行。\n\n建模假设必须从以下基本基础出发：菲克第二定律描述的扩散和一阶降解控制形态发生素的运输，而配体-受体平衡控制受体占有率。具体来说，令 $x \\in [0,L]$ 表示沿着生殖结节间充质从近端到远端轴线上的位置，其中 $x=0$ 是血管基部，$x=L$ 是远端尖端。令 $T(x)$ 表示稳态睾酮浓度。稳态一维扩散-反应方程为\n$$\n0 \\;=\\; D \\,\\frac{d^2 T}{d x^2} \\;-\\; k \\,T \\;+\\; S(x),\n$$\n其中 $D$ 是扩散系数，$k$ 是一阶降解率，$S(x)$ 是体积源项。在本题中，您必须取 $S(x)=0$，因此方程简化为\n$$\n0 \\;=\\; D \\,\\frac{d^2 T}{d x^2} \\;-\\; k \\,T.\n$$\n边界条件编码了基部的血管供应和远端尖端的无通量条件：\n$$\nT(0)=T_0, \\qquad \\left.\\frac{dT}{dx}\\right|_{x=L}=0,\n$$\n其中 $T_0$ 是基底浓度。\n\nAR激活由平衡状态下的受体占有率量化\n$$\nO(x) \\;=\\; \\frac{T(x)}{T(x)+K_d},\n$$\n其中 $K_d$ 是解离常数。定义一个激活阈值 $\\theta \\in (0,1)$，并且当且仅当 $O(x) \\ge \\theta$ 时，声明一个点 $x$ 为“AR激活”。\n\n将尿道闭合能力定义为一个布尔输出，通过将以下两个标准应用于稳态场来计算：\n- 标准A（足够的空间范围）：存在至少一个AR激活的连续空间区间，其长度大于或等于所需的最小长度 $L_{\\min}$。\n- 标准B（远端包含）：至少有一个AR激活区间与远端区段 $[\\,L-\\delta,\\,L\\,]$ 相交，其中 $\\delta$ 是一个指定的远端包含长度。\n\n当且仅当至少有一个连续的AR激活区间同时满足标准A和标准B时，最终决策为真。\n\n您必须使用有限差分法离散化来数值求解该边值问题，在 $[0,L]$ 上使用恰好 $N=1001$ 个均匀间隔的节点，网格间距为 $\\Delta x = L/(N-1)$。在所有内部节点上使用中心差分法离散化稳态方程的二阶导数，在 $x=0$ 处强制施加狄利克雷边界条件，并在 $x=L$ 处通过单边有限差分 $\\left(T_{N-1}-T_{N-2}\\right)/\\Delta x = 0$ 强制施加诺伊曼无通量边界条件。精确求解（达到浮点精度）所得到的线性系统，以获得节点值 $T_i \\approx T(x_i)$，其中 $x_i = i\\,\\Delta x$，$i=0,1,\\dots,N-1$。在每个节点上计算 $O_i = T_i/(T_i+K_d)$，以 $\\theta$ 为阈值获得整个网格上的布尔激活数组，提取连续的激活区段，并应用标准A和B。当计算从索引 $i_{\\mathrm{start}}$ 到 $i_{\\mathrm{end}}$（含）的连续激活节点区段的物理长度时，使用长度公式 $(i_{\\mathrm{end}}-i_{\\mathrm{start}})\\,\\Delta x$。当且仅当 $x_{i_{\\mathrm{end}}} \\ge L-\\delta$ 时，一个区段与远端区域相交。\n\n所有物理参数都应使用以下单位进行解释：$D$ 的单位是 $\\mu\\mathrm{m}^2/\\mathrm{s}$，$k$ 的单位是 $\\mathrm{s}^{-1}$，$L$ 的单位是 $\\mu\\mathrm{m}$，$T_0$ 和 $K_d$ 的单位是 $\\mathrm{nM}$，$\\delta$ 和 $L_{\\min}$ 的单位是 $\\mu\\mathrm{m}$。布尔输出没有单位。\n\n测试套件。您的程序必须按顺序为以下每组参数计算并报告能力决策：\n\n- 案例1（理想情况）：$D=300\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k=0.002\\,\\mathrm{s}^{-1}$，$L=600\\,\\mu\\mathrm{m}$，$T_0=20\\,\\mathrm{nM}$，$K_d=1.0\\,\\mathrm{nM}$，$\\theta=0.5$，$L_{\\min}=200\\,\\mu\\mathrm{m}$，$\\delta=50\\,\\mu\\mathrm{m}$。\n- 案例2（强损耗，低供应）：$D=150\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k=0.01\\,\\mathrm{s}^{-1}$，$L=600\\,\\mu\\mathrm{m}$，$T_0=5\\,\\mathrm{nM}$，$K_d=2.0\\,\\mathrm{nM}$，$\\theta=0.7$，$L_{\\min}=150\\,\\mu\\mathrm{m}$，$\\delta=60\\,\\mu\\mathrm{m}$。\n- 案例3（长域，远端覆盖不足）：$D=100\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k=0.005\\,\\mathrm{s}^{-1}$，$L=1000\\,\\mu\\mathrm{m}$，$T_0=50\\,\\mathrm{nM}$，$K_d=1.0\\,\\mathrm{nM}$，$\\theta=0.5$，$L_{\\min}=300\\,\\mu\\mathrm{m}$，$\\delta=80\\,\\mu\\mathrm{m}$。\n- 案例4（高扩散，轻度损耗，中等阈值）：$D=500\\,\\mu\\mathrm{m}^2/\\mathrm{s}$，$k=0.001\\,\\mathrm{s}^{-1}$，$L=500\\,\\mu\\mathrm{m}$，$T_0=30\\,\\mathrm{nM}$，$K_d=2.0\\,\\mathrm{nM}$，$\\theta=0.6$，$L_{\\min}=450\\,\\mu\\mathrm{m}$，$\\delta=40\\,\\mu\\mathrm{m}$。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4]$），每个条目是对应案例的布尔值 true 或 false，使用编程语言的原生布尔字面量格式打印。", "solution": "该问题要求对一维空间域上的稳态睾酮浓度分布 $T(x)$ 进行数值模拟，然后分析雄激素受体（AR）的激活情况，以根据指定标准确定一个布尔值的“尿道闭合能力”状态。\n\n在域 $x \\in [0, L]$ 上，稳态睾酮浓度 $T(x)$ 的控制方程是一维反应扩散方程：\n$$\nD \\frac{d^2 T}{dx^2} - k T = 0\n$$\n其中 $D$ 是扩散系数，$k$ 是一阶降解速率常数。边界条件为血管基部的固定浓度和远端尖端的无通量条件：\n$$\nT(0) = T_0, \\qquad \\left. \\frac{dT}{dx} \\right|_{x=L} = 0\n$$\n\n这是一个线性的、二阶的、具有常系数的齐次常微分方程，构成了一个适定的边值问题。为完整起见，并作为验证模型物理行为的一种手段，我们首先陈述其解析解。定义特征长度尺度 $\\lambda^{-1} = \\sqrt{D/k}$，方程变为 $T''(x) - \\lambda^2 T(x) = 0$。其通解为 $T(x) = C_1 \\cosh(\\lambda x) + C_2 \\sinh(\\lambda x)$。应用边界条件可得到特解：\n$$\nT(x) = T_0 \\frac{\\cosh(\\lambda(L-x))}{\\cosh(\\lambda L)}\n$$\n该解描述了一个指数衰减的浓度分布，这在物理上是符合预期的。\n\n问题要求使用有限差分法进行数值求解。域 $[0, L]$ 被离散化为 $N=1001$ 个均匀间隔的节点，索引为 $i=0, 1, \\dots, N-1$。空间坐标为 $x_i = i \\Delta x$，其中网格间距为 $\\Delta x = L/(N-1)$。令 $T_i$ 表示 $T(x_i)$ 的数值近似值。\n\n内部节点（$i=1, \\dots, N-2$）处的二阶导数使用二阶中心差分格式进行近似：\n$$\n\\left. \\frac{d^2 T}{dx^2} \\right|_{x_i} \\approx \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2}\n$$\n将此代入控制方程，得到一个代数方程组：\n$$\nD \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2} - k T_i = 0\n$$\n整理各项，我们得到每个内部节点 $i=1, \\dots, N-2$ 的递推关系：\n$$\n\\alpha T_{i-1} - (2\\alpha + k) T_i + \\alpha T_{i+1} = 0\n$$\n其中 $\\alpha = D/(\\Delta x)^2$ 是一个常数参数组合。\n\n边界条件的实现如下：\n1.  在 $i=0$ 处的狄利克雷条件：$T_0$ 作为固定值给定。\n2.  在 $i=N-1$ 处的诺伊曼条件：根据问题陈述，这使用单边（后向）差分进行离散化：$\\frac{T_{N-1} - T_{N-2}}{\\Delta x} = 0$，简化为 $T_{N-1} = T_{N-2}$。\n\n为了找到未知的节点值 $T_1, T_2, \\dots, T_{N-1}$，我们建立一个线性方程组。一个更直接的方法是为未知数 $T_1, \\dots, T_{N-2}$ 建立一个系统，然后设置 $T_{N-1} = T_{N-2}$。这将产生一个针对未知向量 $\\mathbf{u} = [T_1, T_2, \\ldots, T_{N-2}]^T$ 的 $(N-2) \\times (N-2)$ 线性系统 $A\\mathbf{u}=\\mathbf{b}$。\n\n-   对于 $i=1$：方程涉及已知的 $T_0$。\n    $\\alpha T_0 - (2\\alpha + k) T_1 + \\alpha T_2 = 0 \\implies -(2\\alpha + k) T_1 + \\alpha T_2 = -\\alpha T_0$。\n-   对于 $i=2, \\dots, N-3$：标准的递推关系成立。\n    $\\alpha T_{i-1} - (2\\alpha + k) T_i + \\alpha T_{i+1} = 0$。\n-   对于 $i=N-2$：方程涉及 $T_{N-1}$。代入 $T_{N-1}=T_{N-2}$：\n    $\\alpha T_{N-3} - (2\\alpha + k) T_{N-2} + \\alpha T_{N-1} = 0 \\implies \\alpha T_{N-3} - (\\alpha + k) T_{N-2} = 0$。\n\n这定义了一个三对角系统矩阵 $A$（其最后一个对角元素有修改）和一个只有一个非零项的右侧向量 $\\mathbf{b}$。这个系统可以被高效地求解，以获得值 $T_1, \\dots, T_{N-2}$。然后将长度为 $N$ 的完整浓度分布向量 $\\mathbf{T}$ 组装为 $[T_0, T_1, \\ldots, T_{N-2}, T_{N-2}]$。\n\n计算出浓度分布 $T_i$ 后，我们评估 AR 激活状态。每个节点上的受体占有率为：\n$$\nO_i = \\frac{T_i}{T_i + K_d}\n$$\n其中 $K_d$ 是解离常数。如果 $O_i \\ge \\theta$，其中 $\\theta$ 是激活阈值，则节点 $i$ 被认为是“AR激活的”。这将产生一个表示整个空间域激活情况的布尔数组。\n\n最后，我们通过搜索连续的激活节点区段并应用两个标准来确定尿道闭合能力：\n-   **标准A（足够的空间范围）**：对于从索引 $i_{\\text{start}}$ 到 $i_{\\text{end}}$ 的一段激活节点，其物理长度，计算为 $(i_{\\text{end}} - i_{\\text{start}}) \\Delta x$，必须大于或等于最小长度 $L_{\\min}$。\n-   **标准B（远端包含）**：同一区段必须与远端区域 $[L-\\delta, L]$ 相交。如果该区段的最终节点位置 $x_{i_{\\text{end}}} = i_{\\text{end}} \\Delta x$ 大于或等于 $L-\\delta$，则满足此条件。\n\n当且仅当存在至少一个连续的AR激活区段同时满足标准A和标准B时，能力的最终布尔决策为 `true`。\n\n每个测试案例的计算过程如下：\n1.  初始化参数：$D, k, L, T_0, K_d, \\theta, L_{\\min}, \\delta$。\n2.  设置数值网格：$N=1001$，$\\Delta x = L/(N-1)$。\n3.  构建 $(N-2) \\times (N-2)$ 矩阵 $A$ 和向量 $\\mathbf{b}$。\n4.  求解线性系统 $A\\mathbf{u}=\\mathbf{b}$ 以得到 $\\mathbf{u} = [T_1, \\ldots, T_{N-2}]^T$。\n5.  组装完整的浓度向量 $\\mathbf{T}$。\n6.  计算占有率向量 $\\mathbf{O}$ 和布尔激活数组。\n7.  遍历激活数组以识别连续的激活区段。\n8.  对每个区段，检查其是否同时满足标准A和标准B。如果找到这样的区段，则能力为 `true`，并且该测试案例的搜索可以终止。\n9.  如果检查完所有区段后，没有一个区段同时满足两个标准，则能力为 `false`。\n此过程将应用于测试套件中提供的每一组参数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path)\n        {'D': 300.0, 'k': 0.002, 'L': 600.0, 'T0': 20.0, 'Kd': 1.0, 'theta': 0.5, 'L_min': 200.0, 'delta': 50.0},\n        # Case 2 (strong loss, low supply)\n        {'D': 150.0, 'k': 0.01, 'L': 600.0, 'T0': 5.0, 'Kd': 2.0, 'theta': 0.7, 'L_min': 150.0, 'delta': 60.0},\n        # Case 3 (long domain, insufficient distal reach)\n        {'D': 100.0, 'k': 0.005, 'L': 1000.0, 'T0': 50.0, 'Kd': 1.0, 'theta': 0.5, 'L_min': 300.0, 'delta': 80.0},\n        # Case 4 (high diffusion, mild loss, moderate threshold)\n        {'D': 500.0, 'k': 0.001, 'L': 500.0, 'T0': 30.0, 'Kd': 2.0, 'theta': 0.6, 'L_min': 450.0, 'delta': 40.0}\n    ]\n\n    results = []\n    for params in test_cases:\n        competence = check_competence(**params)\n        results.append(competence)\n    \n    # Format the final output as a lowercase boolean list string\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\ndef check_competence(D, k, L, T0, Kd, theta, L_min, delta):\n    \"\"\"\n    Performs the simulation and competence check for a single set of parameters.\n    \n    Args:\n        D (float): Diffusion coefficient (micrometers^2/s)\n        k (float): Degradation rate (1/s)\n        L (float): Domain length (micrometers)\n        T0 (float): Basal testosterone concentration (nM)\n        Kd (float): Dissociation constant (nM)\n        theta (float): Activation threshold (dimensionless)\n        L_min (float): Minimum required length for activated segment (micrometers)\n        delta (float): Distal inclusion length (micrometers)\n        \n    Returns:\n        bool: True if competence criteria are met, False otherwise.\n    \"\"\"\n    \n    # 1. Numerical setup\n    N = 1001\n    dx = L / (N - 1)\n    \n    # 2. Build the linear system A*u = b for unknowns T_1, ..., T_{N-2}\n    # System size is (N-2) x (N-2)\n    sys_size = N - 2\n    A = np.zeros((sys_size, sys_size))\n    b = np.zeros(sys_size)\n    \n    alpha = D / (dx**2)\n    \n    # Fill the matrix A and vector b\n    # First row (for T_1)\n    if sys_size > 0:\n        A[0, 0] = -(2 * alpha + k)\n        if sys_size > 1:\n            A[0, 1] = alpha\n        b[0] = -alpha * T0\n\n    # Interior rows (for T_2 to T_{N-3})\n    for i in range(1, sys_size - 1):\n        A[i, i-1] = alpha\n        A[i, i] = -(2 * alpha + k)\n        A[i, i+1] = alpha\n    \n    # Last row (for T_{N-2})\n    if sys_size > 1:\n        A[sys_size - 1, sys_size - 2] = alpha\n        A[sys_size - 1, sys_size - 1] = -(alpha + k)\n\n    # 3. Solve for T_1, ..., T_{N-2}\n    if sys_size > 0:\n        T_interior = np.linalg.solve(A, b)\n    else:\n        T_interior = np.array([])\n    \n    # 4. Assemble the full concentration profile T_0, ..., T_{N-1}\n    T_full = np.zeros(N)\n    T_full[0] = T0\n    T_full[1:N-1] = T_interior\n    if N > 1 :\n      T_full[N-1] = T_full[N-2]\n    \n    # 5. Compute receptor occupancy and check for activation\n    O = T_full / (T_full + Kd)\n    activated = O >= theta\n    \n    # 6. Find contiguous activated segments and check criteria\n    in_segment = False\n    segment_start_idx = -1\n    for i in range(N):\n        if activated[i] and not in_segment:\n            in_segment = True\n            segment_start_idx = i\n        elif not activated[i] and in_segment:\n            in_segment = False\n            segment_end_idx = i - 1\n            \n            # Check criteria for the found segment\n            if check_segment_criteria(segment_start_idx, segment_end_idx, dx, L, L_min, delta):\n                return True\n    \n    # Handle case where the last segment extends to the end of the domain\n    if in_segment:\n        segment_end_idx = N - 1\n        if check_segment_criteria(segment_start_idx, segment_end_idx, dx, L, L_min, delta):\n            return True\n            \n    # If no segment met both criteria\n    return False\n\ndef check_segment_criteria(i_start, i_end, dx, L, L_min, delta):\n    \"\"\"\n    Checks if a given segment meets both Criteria A and B.\n    \"\"\"\n    # Criterion A: Sufficient spatial extent\n    segment_length = (i_end - i_start) * dx\n    criterion_A_met = segment_length >= L_min\n    \n    # Criterion B: Distal inclusion\n    x_end = i_end * dx\n    criterion_B_met = x_end >= (L - delta)\n    \n    return criterion_A_met and criterion_B_met\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "4447253"}]}