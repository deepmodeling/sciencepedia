{"hands_on_practices": [{"introduction": "风险比（RR）、优势比（OR）和率比（IRR）等点估计本身并不能完全反映关联的强度，我们还需要量化其统计不确定性。本练习将带你运用Delta方法这一核心统计工具，从第一性原理出发推导对数转换后的风险比、优势比和率比的抽样方差。掌握这一推导过程对于理解如何构建置信区间和进行假设检验至关重要，它揭示了这些基本流行病学度量在大样本理论下的统计特性。[@problem_id:4972058]", "problem": "一项前瞻性队列研究比较了一个暴露组和一个非暴露组的二元健康结局，并在一个平行的监测系统中，基于人时比较了两组的发病率。令 $a$ 表示暴露组中出现结局事件的数量，$b$ 表示暴露组中未出现结局事件的数量，因此暴露组的大小为 $n_{1} = a + b$。令 $c$ 表示非暴露组中出现结局事件的数量，$d$ 表示非暴露组中未出现结局事件的数量，因此非暴露组的大小为 $n_{0} = c + d$。定义经验风险比 (RR)、比值比 (OR) 和发病率比 (IRR) 如下：\n$$\\widehat{\\text{RR}} = \\frac{a / n_{1}}{c / n_{0}}, \\quad \\widehat{\\text{OR}} = \\frac{a / b}{c / d} = \\frac{a d}{b c}, \\quad \\widehat{\\text{IRR}} = \\frac{X_{1} / T_{1}}{X_{0} / T_{0}},$$\n其中，$X_{1}$ 和 $X_{0}$ 分别表示暴露组和非暴露组中的独立泊松事件计数，$T_{1}$ 和 $T_{0}$ 表示相应的固定人时总数。\n\n假设以下数据生成机制：\n- 在队列研究部分，$a \\sim \\text{Binomial}(n_{1}, p_{1})$ 和 $c \\sim \\text{Binomial}(n_{0}, p_{0})$ 相互独立，其中 $p_{1}$ 和 $p_{0}$ 是暴露组和非暴露组的真实风险。\n- 在发病率部分，$X_{1} \\sim \\text{Poisson}(\\lambda_{1} T_{1})$ 和 $X_{0} \\sim \\text{Poisson}(\\lambda_{0} T_{0})$ 相互独立，其中 $\\lambda_{1}$ 和 $\\lambda_{0}$ 是真实的发病率。\n\n仅使用二项模型和泊松模型的大样本理论的第一性原理以及 delta 方法，推导 $\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{RR}}\\right)\\right]$、$\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{OR}}\\right)\\right]$ 和 $\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{IRR}}\\right)\\right]$ 的一阶大样本估计量，并纯粹用 $a, b, c, d, X_{1}, X_{0}, T_{1}, T_{0}$ 表示。\n\n你的最终答案必须是一个单一的闭式解析表达式，以行矩阵的形式呈现，其中三个条目按 $\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{RR}}\\right)\\right]$、$\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{OR}}\\right)\\right]$、$\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{IRR}}\\right)\\right]$ 的顺序排列。使用自然对数 $\\ln$。不需要进行数值计算、四舍五入或添加单位。", "solution": "该问题要求推导风险比（$\\widehat{\\text{RR}}$）、比值比（$\\widehat{\\text{OR}}$）和发病率比（$\\widehat{\\text{IRR}}$）的自然对数的方差的大样本估计量。此推导的核心理论工具是 delta 方法。\n\nDelta 方法为单个或多个随机变量的函数的方差提供了一阶泰勒级数近似。对于单个随机变量 $Y$ 和可微函数 $g$，$g(Y)$ 的方差近似为：\n$$ \\operatorname{Var}[g(Y)] \\approx \\left( g'(E[Y]) \\right)^2 \\operatorname{Var}[Y] $$\n对于两个独立随机变量 $Y_1$ 和 $Y_2$ 的函数，$g(Y_1, Y_2)$ 的方差近似为：\n$$ \\operatorname{Var}[g(Y_1, Y_2)] \\approx \\left( \\frac{\\partial g}{\\partial y_1} \\right)^2 \\operatorname{Var}[Y_1] + \\left( \\frac{\\partial g}{\\partial y_2} \\right)^2 \\operatorname{Var}[Y_2] $$\n其中偏导数在 $Y_1$ 和 $Y_2$ 的期望值处求值。该方差的大样本估计量（表示为 $\\widehat{\\operatorname{Var}}$）是通过将总体参数（包括期望值和方差）替换为其基于样本的估计值来获得的。\n\n所要求的三个方差估计量分别推导如下。\n\n1.  **$\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{RR}}\\right)\\right]$ 的推导**\n\n经验风险比定义为 $\\widehat{\\text{RR}} = \\frac{\\hat{p}_{1}}{\\hat{p}_{0}}$，其中 $\\hat{p}_{1} = a/n_{1}$ 和 $\\hat{p}_{0} = c/n_{0}$ 分别是暴露组和非暴露组的估计风险。其自然对数为 $\\ln(\\widehat{\\text{RR}}) = \\ln(\\hat{p}_{1}) - \\ln(\\hat{p}_{0})$。\n随机变量 $a \\sim \\text{Binomial}(n_{1}, p_{1})$ 和 $c \\sim \\text{Binomial}(n_{0}, p_{0})$ 相互独立。因此，估计量 $\\hat{p}_{1} = a/n_{1}$ 和 $\\hat{p}_{0} = c/n_{0}$ 也相互独立。\n由于独立性，差的方差等于方差之和：\n$$ \\operatorname{Var}[\\ln(\\widehat{\\text{RR}})] = \\operatorname{Var}[\\ln(\\hat{p}_{1})] + \\operatorname{Var}[\\ln(\\hat{p}_{0})] $$\n我们对每一项应用 delta 方法。令 $g(p) = \\ln(p)$，则 $g'(p) = 1/p$。\n$\\hat{p}_{1}$ 的方差为 $\\operatorname{Var}[\\hat{p}_{1}] = \\operatorname{Var}[a/n_{1}] = \\frac{1}{n_{1}^2}\\operatorname{Var}[a] = \\frac{n_{1} p_{1}(1-p_{1})}{n_{1}^2} = \\frac{p_{1}(1-p_{1})}{n_{1}}$。\n对 $\\ln(\\hat{p}_{1})$ 应用 delta 方法：\n$$ \\operatorname{Var}[\\ln(\\hat{p}_{1})] \\approx \\left( g'(p_1) \\right)^2 \\operatorname{Var}[\\hat{p}_{1}] = \\left(\\frac{1}{p_{1}}\\right)^2 \\frac{p_{1}(1-p_{1})}{n_{1}} = \\frac{1-p_{1}}{n_{1} p_{1}} $$\n类似地，对于非暴露组：\n$$ \\operatorname{Var}[\\ln(\\hat{p}_{0})] \\approx \\frac{1-p_{0}}{n_{0} p_{0}} $$\n将这些结合起来，得到 $\\ln(\\widehat{\\text{RR}})$ 的近似方差：\n$$ \\operatorname{Var}[\\ln(\\widehat{\\text{RR}})] \\approx \\frac{1-p_{1}}{n_{1} p_{1}} + \\frac{1-p_{0}}{n_{0} p_{0}} $$\n为了获得估计量 $\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{RR}}\\right)\\right]$，我们将真实概率 $p_{1}$ 和 $p_{0}$ 替换为它们的样本估计值 $\\hat{p}_{1} = a/n_{1}$ 和 $\\hat{p}_{0} = c/n_{0}$。\n$$ \\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{RR}}\\right)\\right] = \\frac{1-\\hat{p}_{1}}{n_{1}\\hat{p}_{1}} + \\frac{1-\\hat{p}_{0}}{n_{0}\\hat{p}_{0}} = \\frac{1 - a/n_{1}}{n_{1}(a/n_{1})} + \\frac{1 - c/n_{0}}{n_{0}(c/n_{0})} $$\n$$ = \\frac{(n_{1}-a)/n_{1}}{a} + \\frac{(n_{0}-c)/n_{0}}{c} = \\frac{b/n_{1}}{a} + \\frac{d/n_{0}}{c} = \\frac{b}{an_{1}} + \\frac{d}{cn_{0}} $$\n由于 $n_{1} = a+b$ 和 $n_{0} = c+d$，这可以写成：\n$$ \\frac{b}{a(a+b)} + \\frac{d}{c(c+d)} = \\left(\\frac{1}{a} - \\frac{1}{a+b}\\right) + \\left(\\frac{1}{c} - \\frac{1}{c+d}\\right) $$\n因此，最终的估计量是 $\\frac{1}{a} - \\frac{1}{a+b} + \\frac{1}{c} - \\frac{1}{c+d}$。\n\n2.  **$\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{OR}}\\right)\\right]$ 的推导**\n\n经验比值比是 $\\widehat{\\text{OR}} = \\frac{a/b}{c/d}$。用比例表示更为方便：$\\widehat{\\text{OR}} = \\frac{\\hat{p}_{1}/(1-\\hat{p}_{1})}{\\hat{p}_{0}/(1-\\hat{p}_{0})}$。\n比值比的自然对数，即对数比值比，为：\n$$ \\ln(\\widehat{\\text{OR}}) = \\ln\\left(\\frac{\\hat{p}_{1}}{1-\\hat{p}_{1}}\\right) - \\ln\\left(\\frac{\\hat{p}_{0}}{1-\\hat{p}_{0}}\\right) = \\text{logit}(\\hat{p}_{1}) - \\text{logit}(\\hat{p}_{0}) $$\n和之前一样，$\\hat{p}_{1}$ 和 $\\hat{p}_{0}$ 是独立的。我们对 logit 函数 $g(p) = \\text{logit}(p) = \\ln(p) - \\ln(1-p)$ 应用 delta 方法。\n其导数为 $g'(p) = \\frac{1}{p} + \\frac{1}{1-p} = \\frac{1}{p(1-p)}$。\n$\\text{logit}(\\hat{p}_{1})$ 的方差是：\n$$ \\operatorname{Var}[\\text{logit}(\\hat{p}_{1})] \\approx \\left( g'(p_1) \\right)^2 \\operatorname{Var}[\\hat{p}_{1}] = \\left(\\frac{1}{p_{1}(1-p_{1})}\\right)^2 \\frac{p_{1}(1-p_{1})}{n_{1}} = \\frac{1}{n_{1}p_{1}(1-p_{1})} $$\n根据独立性，$\\ln(\\widehat{\\text{OR}})$ 的方差是：\n$$ \\operatorname{Var}[\\ln(\\widehat{\\text{OR}})] \\approx \\frac{1}{n_{1}p_{1}(1-p_{1})} + \\frac{1}{n_{0}p_{0}(1-p_{0})} $$\n通过用样本估计值替换参数来找到估计量：\n$$ \\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{OR}}\\right)\\right] = \\frac{1}{n_{1}\\hat{p}_{1}(1-\\hat{p}_{1})} + \\frac{1}{n_{0}\\hat{p}_{0}(1-\\hat{p}_{0})} $$\n现在，代入 $\\hat{p}_{1} = a/n_{1}$，$1-\\hat{p}_{1} = b/n_{1}$，$\\hat{p}_{0} = c/n_{0}$ 和 $1-\\hat{p}_{0} = d/n_{0}$：\n$$ \\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{OR}}\\right)\\right] = \\frac{1}{n_{1}\\frac{a}{n_{1}}\\frac{b}{n_{1}}} + \\frac{1}{n_{0}\\frac{c}{n_{0}}\\frac{d}{n_{0}}} = \\frac{n_{1}}{ab} + \\frac{n_{0}}{cd} $$\n代入 $n_{1} = a+b$ 和 $n_{0} = c+d$：\n$$ \\frac{a+b}{ab} + \\frac{c+d}{cd} = \\left(\\frac{a}{ab} + \\frac{b}{ab}\\right) + \\left(\\frac{c}{cd} + \\frac{d}{cd}\\right) = \\frac{1}{b} + \\frac{1}{a} + \\frac{1}{d} + \\frac{1}{c} $$\n因此，最终的估计量是 $\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}$。\n\n3.  **$\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{IRR}}\\right)\\right]$ 的推导**\n\n经验发病率比是 $\\widehat{\\text{IRR}} = \\frac{X_{1}/T_{1}}{X_{0}/T_{0}}$。其自然对数是：\n$$ \\ln(\\widehat{\\text{IRR}}) = \\ln(X_{1}) - \\ln(X_{0}) - \\ln(T_{1}) + \\ln(T_{0}) $$\n随机变量是事件计数 $X_{1} \\sim \\text{Poisson}(\\lambda_{1} T_{1})$ 和 $X_{0} \\sim \\text{Poisson}(\\lambda_{0} T_{0})$，它们是独立的。人时总数 $T_{1}$ 和 $T_{0}$ 是固定常数。\n和的方差是方差之和（常数的方差为零）：\n$$ \\operatorname{Var}[\\ln(\\widehat{\\text{IRR}})] = \\operatorname{Var}[\\ln(X_{1})] + \\operatorname{Var}[\\ln(X_{0})] $$\n我们对 $g(X) = \\ln(X)$ 应用 delta 方法，其导数为 $g'(X) = 1/X$。对于泊松分布，方差等于均值，所以 $\\operatorname{Var}[X_{1}] = E[X_{1}] = \\lambda_{1} T_{1}$。\n对 $\\ln(X_{1})$ 应用 delta 方法：\n$$ \\operatorname{Var}[\\ln(X_{1})] \\approx \\left( g'(E[X_{1}]) \\right)^2 \\operatorname{Var}[X_{1}] = \\left(\\frac{1}{E[X_{1}]}\\right)^2 \\operatorname{Var}[X_{1}] = \\frac{\\operatorname{Var}[X_{1}]}{(E[X_{1}])^2} = \\frac{\\lambda_{1} T_{1}}{(\\lambda_{1} T_{1})^2} = \\frac{1}{\\lambda_{1} T_{1}} $$\n类似地，对于非暴露组，$\\operatorname{Var}[\\ln(X_{0})] \\approx \\frac{1}{\\lambda_{0} T_{0}}$。\n$\\ln(\\widehat{\\text{IRR}})$ 的近似方差为：\n$$ \\operatorname{Var}[\\ln(\\widehat{\\text{IRR}})] \\approx \\frac{1}{\\lambda_{1} T_{1}} + \\frac{1}{\\lambda_{0} T_{0}} $$\n为了构建估计量 $\\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{IRR}}\\right)\\right]$，我们必须估计参数 $\\mu_{1}=\\lambda_{1}T_{1}$ 和 $\\mu_{0}=\\lambda_{0}T_{0}$。对于泊松分布，均值参数 $\\mu$ 的最大似然估计是观测到的计数。因此，我们将 $\\lambda_{1}T_{1}$ 替换为 $X_{1}$，将 $\\lambda_{0}T_{0}$ 替换为 $X_{0}$。\n$$ \\widehat{\\operatorname{Var}}\\!\\left[\\ln\\!\\left(\\widehat{\\text{IRR}}\\right)\\right] = \\frac{1}{X_{1}} + \\frac{1}{X_{0}} $$\n这就是对数发病率比的方差的最终估计量。\n\n按要求将三个推导的大样本估计量组合成一个行矩阵。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{a} - \\frac{1}{a+b} + \\frac{1}{c} - \\frac{1}{c+d}  \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}  \\frac{1}{X_{1}} + \\frac{1}{X_{0}} \\end{pmatrix} } $$", "id": "4972058"}, {"introduction": "虽然我们可以直接从列联表中计算关联度量，但将它们置于广义线性模型的框架内（如逻辑回归）能提供更大的灵活性和更强的分析能力。本练习将引导你深入逻辑回归模型的核心，推导与对数优势比（log-odds ratio）对应的模型参数 $\\beta$ 的分数函数（Score Function）和Fisher信息（Fisher Information）。通过亲手执行一次Fisher评分法的迭代更新，你将能体会到最大似然估计（MLE）的数值计算过程，从而理解统计软件在幕后所做的工作。[@problem_id:4972016]", "problem": "一项随机临床研究旨在调查预防性治疗是否能降低术后感染的比值。设 $Y_{i} \\in \\{0,1\\}$ 表示个体 $i$ 的感染指标，设 $A_{i} \\in \\{0,1\\}$ 表示治疗指标（$A_{i}=1$ 为治疗组，$A_{i}=0$ 为对照组）。假设条件独立性并使用逻辑斯蒂回归模型\n$$\n\\Pr(Y_{i}=1 \\mid A_{i}) \\;=\\; \\frac{\\exp(\\alpha + \\beta A_{i})}{1 + \\exp(\\alpha + \\beta A_{i})},\n$$\n其中 $\\alpha \\in \\mathbb{R}$ 是截距，$\\beta \\in \\mathbb{R}$ 是比较治疗组与对照组的对数比值比。似然函数基于独立观测的伯努利模型，我们感兴趣的参数是 $\\beta$。\n\n任务：\n- 仅使用伯努利似然和逻辑斯蒂连接的定义，从第一性原理推导上述模型下 $\\beta$ 的得分函数和期望 Fisher 信息。你的推导应明确说明线性预测器 $\\eta_{i}=\\alpha+\\beta A_{i}$ 如何进入似然函数，以及微分如何产生得分和曲率。\n- 陈述 $\\beta$ 的最大似然估计（MLE）存在且有限的精确条件，并强调完全分离和准完全分离在协变量-结果空间中的作用。\n- 现在考虑以下汇总数据：在对照组（$A=0$）中，有 $n_{c}=180$ 名参与者，其中有 $y_{c}=36$ 例感染；在治疗组（$A=1$）中，有 $n_{t}=220$ 名参与者，其中有 $y_{t}=22$ 例感染。将 $\\alpha$ 固定为 $\\alpha_{0}=\\ln\\!\\big((y_{c}/n_{c})/(1-y_{c}/n_{c})\\big)$，并使用你推导出的得分和期望 Fisher 信息，从 $\\beta_{0}=0$ 开始对 $\\beta$ 执行一次 Fisher 评分（Newton–Raphson）更新。将更新后的 $\\beta$ 值作为你的最终答案报告。将你的答案四舍五入至四位有效数字。", "solution": "该问题被评估为有效。这是一个统计建模中的适定且自洽的问题，其理论基础是广义线性模型的最大似然估计理论。该问题没有任何科学或事实上的不健全之处。\n\n### 第 1 部分：$\\beta$ 的得分和 Fisher 信息的推导\n\n设 $Y_i \\in \\{0,1\\}$ 为个体 $i$ 的二元结果， $A_i \\in \\{0,1\\}$ 为治疗指标。观测是独立的。假设在给定 $A_i$ 的条件下，结果 $Y_i$ 服从伯努利分布，即 $Y_i \\mid A_i \\sim \\text{Bernoulli}(p_i)$。阳性结果（$Y_i=1$）的概率通过逻辑斯蒂连接函数建模：\n$$p_i = \\Pr(Y_i=1 \\mid A_i) = \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)}$$\n其中 $\\eta_i = \\alpha + \\beta A_i$ 是线性预测器。\n\n单个观测 $Y_i=y_i$ 的概率质量函数由下式给出：\n$$f(y_i \\mid A_i; \\alpha, \\beta) = p_i^{y_i} (1-p_i)^{1-y_i}$$\n观测值 $i$ 的对数似然为：\n$$\\ell_i(\\alpha, \\beta) = \\log f(y_i \\mid A_i; \\alpha, \\beta) = y_i \\log(p_i) + (1-y_i) \\log(1-p_i)$$\n我们可以用线性预测器 $\\eta_i$ 来表示 $\\log(p_i)$ 和 $\\log(1-p_i)$：\n$$\\log(p_i) = \\log\\left(\\frac{\\exp(\\eta_i)}{1+\\exp(\\eta_i)}\\right) = \\log(\\exp(\\eta_i)) - \\log(1+\\exp(\\eta_i)) = \\eta_i - \\log(1+\\exp(\\eta_i))$$\n$$\\log(1-p_i) = \\log\\left(1 - \\frac{\\exp(\\eta_i)}{1+\\exp(\\eta_i)}\\right) = \\log\\left(\\frac{1}{1+\\exp(\\eta_i)}\\right) = -\\log(1+\\exp(\\eta_i))$$\n将这些代入 $\\ell_i$ 的表达式中：\n$$\\ell_i(\\alpha, \\beta) = y_i(\\eta_i - \\log(1+\\exp(\\eta_i))) + (1-y_i)(-\\log(1+\\exp(\\eta_i)))$$\n$$\\ell_i(\\alpha, \\beta) = y_i \\eta_i - y_i \\log(1+\\exp(\\eta_i)) - \\log(1+\\exp(\\eta_i)) + y_i \\log(1+\\exp(\\eta_i))$$\n这可以简化为具有正则连接的广义线性模型中常见的紧凑形式：\n$$\\ell_i(\\alpha, \\beta) = y_i \\eta_i - \\log(1+\\exp(\\eta_i))$$\n$n$ 个独立观测的总对数似然是 $L(\\alpha, \\beta) = \\sum_{i=1}^n \\ell_i(\\alpha, \\beta)$。\n\n**$\\beta$ 的得分函数**：\n$\\beta$ 的得分函数，记作 $S_\\beta(\\alpha, \\beta)$，是总对数似然关于 $\\beta$ 的偏导数。我们首先使用链式法则求出 $\\ell_i$ 关于 $\\beta$ 的导数：\n$$\\frac{\\partial \\ell_i}{\\partial \\beta} = \\frac{\\partial \\ell_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta}$$\n导数是：\n$$\\frac{\\partial \\ell_i}{\\partial \\eta_i} = \\frac{\\partial}{\\partial \\eta_i} (y_i \\eta_i - \\log(1+\\exp(\\eta_i))) = y_i - \\frac{\\exp(\\eta_i)}{1+\\exp(\\eta_i)} = y_i - p_i$$\n$$\\frac{\\partial \\eta_i}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} (\\alpha + \\beta A_i) = A_i$$\n结合这些，得到观测值 $i$ 对 $\\beta$ 得分函数的贡献：\n$$\\frac{\\partial \\ell_i}{\\partial \\beta} = (y_i - p_i) A_i$$\n$\\beta$ 的总得分是所有观测值的总和：\n$$S_\\beta(\\alpha, \\beta) = \\frac{\\partial L}{\\partial \\beta} = \\sum_{i=1}^{n} (y_i - p_i) A_i$$\n\n**$\\beta$ 的期望 Fisher 信息**：\n$\\beta$ 的期望 Fisher 信息，记作 $I(\\beta)$，是对数似然关于 $\\beta$ 的二阶偏导数的期望的负值。这个量是 Fisher 信息矩阵的 $(\\beta,\\beta)$ 元素。我们首先计算 $\\ell_i$ 的二阶导数：\n$$\\frac{\\partial^2 \\ell_i}{\\partial \\beta^2} = \\frac{\\partial}{\\partial \\beta} \\left( (y_i - p_i) A_i \\right) = -A_i \\frac{\\partial p_i}{\\partial \\beta}$$\n同样，我们对 $\\frac{\\partial p_i}{\\partial \\beta}$ 使用链式法则：\n$$\\frac{\\partial p_i}{\\partial \\beta} = \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta}$$\n逻辑斯蒂函数 $p_i$ 关于 $\\eta_i$ 的导数是：\n$$\\frac{\\partial p_i}{\\partial \\eta_i} = \\frac{\\partial}{\\partial \\eta_i}\\left(\\frac{\\exp(\\eta_i)}{1+\\exp(\\eta_i)}\\right) = \\frac{\\exp(\\eta_i)(1+\\exp(\\eta_i)) - \\exp(\\eta_i)\\exp(\\eta_i)}{(1+\\exp(\\eta_i))^2} = \\frac{\\exp(\\eta_i)}{(1+\\exp(\\eta_i))^2} = p_i(1-p_i)$$\n和之前一样，$\\frac{\\partial \\eta_i}{\\partial \\beta} = A_i$。因此：\n$$\\frac{\\partial p_i}{\\partial \\beta} = p_i(1-p_i) A_i$$\n将此代入二阶导数表达式：\n$$\\frac{\\partial^2 \\ell_i}{\\partial \\beta^2} = -A_i (p_i(1-p_i)A_i) = -A_i^2 p_i(1-p_i)$$\n总对数似然的二阶导数是 $H_{\\beta\\beta} = \\frac{\\partial^2 L}{\\partial \\beta^2} = \\sum_{i=1}^n -A_i^2 p_i(1-p_i)$。\n$\\beta$ 的期望 Fisher 信息是 $I(\\beta) = -E[H_{\\beta\\beta}]$。期望是关于 $Y_i$ 的分布计算的。由于在此期望中，$A_i$ 和 $p_i$（依赖于 $\\alpha, \\beta, A_i$）被视为固定量，我们有 $E[H_{\\beta\\beta}] = H_{\\beta\\beta}$。\n$$I(\\beta) = - \\left( \\sum_{i=1}^n -A_i^2 p_i(1-p_i) \\right) = \\sum_{i=1}^n A_i^2 p_i(1-p_i)$$\n这是 Fisher 信息矩阵中对应于 $\\beta$ 的分量。对于逻辑斯蒂回归，观测 Fisher 信息和期望 Fisher 信息是相同的。\n\n### 第 2 部分：MLE 存在且有限的条件\n\n逻辑斯蒂回归模型中参数 $(\\alpha, \\beta)$ 的最大似然估计（MLE）存在且有限的充要条件是数据不表现出完全分离或准完全分离。\n\n在这个问题中，协变量空间是一维且二元的，由 $A_i \\in \\{0, 1\\}$ 组成。分离问题可以通过检查治疗变量 $A$ 与结果变量 $Y$ 的 $2 \\times 2$ 列联表来理解：\n\n| | $Y=1$ (感染) | $Y=0$ (未感染) |\n|---|---|---|\n| $A=1$ (治疗组) | $y_t$ | $n_t - y_t$ |\n| $A=0$ (对照组) | $y_c$ | $n_c - y_c$ |\n\n$1$. **完全分离**：当协变量能完美预测结果时发生。对于本问题，这意味着一个组只有感染病例，而另一个组没有。例如，所有治疗组的受试者都感染了（$y_t=n_t$），而所有对照组的受试者都未感染（$y_c=0$）。在这种情况下，似然函数在 $\\beta \\to \\infty$（或 $\\beta \\to -\\infty$，取决于分离的方向）时达到最大值，不存在有限的 MLE。\n\n$2$. **准完全分离**：当协变量能为一个值分离结果但不能为另一个值分离时发生，导致列联表中至少有一个单元格的计数为零。例如，如果没有治疗组的受试者发生感染（$y_t=0$），但对照组既有感染病例也有非感染病例（$y_c  0$ 且 $n_c-y_c  0$）。在这种情况下，$\\beta$ 的似然函数仍然没有有限的最大值。\n\n因此，**$\\beta$ 的 MLE 存在且有限的精确条件**是协变量的两个水平的结果分布都存在重叠。这意味着每个组都必须表现出两种结果。用列联表来说，所有四个单元格的计数都必须非零：\n$$y_c  0, \\quad n_c - y_c  0, \\quad y_t  0, \\quad \\text{and} \\quad n_t - y_t  0$$\n如果这些计数中有任何一个为零，$\\beta$ 的 MLE 将不是有限的。\n\n### 第 3 部分：Fisher 评分更新\n\n参数的 Fisher 评分更新是一个迭代过程。在优化 $\\beta$ 的同时将 $\\alpha$ 固定在值 $\\alpha_0$ 上，第 $k+1$ 步的更新规则是：\n$$\\beta_{k+1} = \\beta_k + [I(\\beta_k)]^{-1} S_\\beta(\\beta_k)$$\n其中得分 $S_\\beta$ 和信息 $I(\\beta)$ 在 $(\\alpha_0, \\beta_k)$ 处求值。\n\n**给定数据**：\n- 对照组 ($A=0$)：$n_c=180$，感染数 $y_c=36$。\n- 治疗组 ($A=1$)：$n_t=220$，感染数 $y_t=22$。\n\n**固定的 $\\alpha$ 和起始的 $\\beta$**：\n参数 $\\alpha$ 固定在 $\\alpha_0 = \\ln\\left(\\frac{y_c/n_c}{1 - y_c/n_c}\\right)$。\n对照组的样本感染比例为 $\\hat{p}_c = y_c/n_c = 36/180 = 0.2$。\n$$\\alpha_0 = \\ln\\left(\\frac{0.2}{1-0.2}\\right) = \\ln\\left(\\frac{0.2}{0.8}\\right) = \\ln(0.25) = -\\ln(4)$$\n$\\beta$ 的起始值为 $\\beta_0=0$。我们执行一次更新以求得 $\\beta_1$。\n\n**在 $(\\alpha_0, \\beta_0)$ 处求值**：\n我们需要在 $(\\alpha, \\beta) = (-\\ln(4), 0)$ 处计算得分和信息。\n概率 $p_i$ 取决于分组：\n- 对于对照组 ($A_i=0$)：$\\eta_i = \\alpha_0 + \\beta_0(0) = -\\ln(4)$。\n  $p_c = \\frac{\\exp(-\\ln(4))}{1+\\exp(-\\ln(4))} = \\frac{0.25}{1+0.25} = \\frac{0.25}{1.25} = 0.2$。\n- 对于治疗组 ($A_i=1$)：$\\eta_i = \\alpha_0 + \\beta_0(1) = -\\ln(4)$。\n  $p_t = \\frac{\\exp(-\\ln(4))}{1+\\exp(-\\ln(4))} = 0.2$。\n正如预期的那样，当 $\\beta_0=0$ 时，模型为两组预测了相同的概率。\n\n**计算得分 $S_\\beta(\\beta_0)$**：\n$$S_\\beta(-\\ln(4), 0) = \\sum_{i=1}^n (y_i - p_i) A_i$$\n对照组（$A_i=0$）的各项为零。我们只对治疗组（$A_i=1$）求和：\n$$S_\\beta(\\beta_0) = \\sum_{i \\in \\text{treated}} (y_i - p_t) A_i = \\sum_{i \\in \\text{treated}} (y_i - 0.2) \\cdot 1$$\n这个和可以写成 $(\\sum_{i \\in \\text{treated}} y_i) - n_t \\cdot 0.2$。\n$$S_\\beta(\\beta_0) = y_t - n_t p_t = 22 - 220 \\times 0.2 = 22 - 44 = -22$$\n\n**计算 Fisher 信息 $I(\\beta_0)$**：\n$$I(\\beta_0) = \\sum_{i=1}^n A_i^2 p_i(1-p_i)$$\n同样，对照组（$A_i=0$）的各项为零。我们对治疗组（$A_i=1$）求和：\n$$I(\\beta_0) = \\sum_{i \\in \\text{treated}} 1^2 \\cdot p_t(1-p_t) = n_t \\cdot p_t(1-p_t)$$\n$$I(\\beta_0) = 220 \\times 0.2 \\times (1-0.2) = 220 \\times 0.2 \\times 0.8 = 220 \\times 0.16 = 35.2$$\n\n**执行更新**：\n现在我们计算 $\\beta_1$：\n$$\\beta_1 = \\beta_0 + [I(\\beta_0)]^{-1} S_\\beta(\\beta_0) = 0 + (35.2)^{-1} \\times (-22) = \\frac{-22}{35.2}$$\n$$\\beta_1 = -0.625$$\n题目要求将答案四舍五入到四位有效数字。精确值为 $-0.625$。用四位有效数字表示，即为 $-0.6250$。", "answer": "$$\\boxed{-0.6250}$$", "id": "4972016"}, {"introduction": "理论公式在应用于真实世界数据时，常常会遇到意想不到的挑战。本练习通过一个包含“零单元格”的案例，探讨了标准最大似然估计在估计优势比时可能遇到的“分离”问题，此时点估计值会发散至无穷大。这个问题促使我们批判性地思考标准方法的局限性，并探索在数据稀疏时更为稳健的替代方案，如基于Fisher精确检验的条件推断方法。[@problem_id:4972025]", "problem": "一项关于医院系统中罕见不良事件的病例对照研究记录了以下暴露交叉表：在病例中，有 $12$ 人暴露，$3$ 人未暴露；在对照中，有 $0$ 人暴露，$25$ 人未暴露。令 $Y \\in \\{0,1\\}$ 表示病例状态（$Y=1$ 为病例，$Y=0$ 为对照），并令 $X \\in \\{0,1\\}$ 表示暴露。我们感兴趣的关联度量是比值比 $\\theta$，其定义为病例中暴露的比值与对照中暴露的比值之比，其中比值由层内暴露概率 $p$ 定义为 $p/(1-p)$。假设在各层内进行独立的伯努利抽样，并考虑两种似然：一种是无条件似然，其中 $p_1=\\mathbb{P}(X=1\\mid Y=1)$ 和 $p_0=\\mathbb{P}(X=1\\mid Y=0)$ 直接从数据中估计；另一种是通过对 $2\\times 2$ 表的固定边际进行条件化得到的条件似然。\n\n仅使用比值和比值比的核心定义，以及在一个同质层中伯努利概率的最大似然估计等于观测比例这一事实，推断在这个零单元格表中 $\\theta$ 的最大似然估计的行为。然后，考虑基于给定边际的暴露病例数的条件分布对 $\\theta$ 进行精确条件推断，以及通过在名义水平 $1-\\alpha$（其中 $\\alpha=0.05$）下对双侧 Fisher 精确检验进行反演来构建置信区间。\n\n在此情境下，哪个选项最准确地描述了为什么 $\\theta$ 的最大似然估计是无界的，通过 Fisher 反演得到的精确条件置信集的形状是什么，以及小样本调整是否能产生有限的端点？\n\nA. 在此表中，$\\theta$ 的无条件最大似然估计是无穷大，因为对照组中估计的暴露概率为 $0$，使得对照组的比值为 $0$，从而导致比值比趋向 $+\\infty$。在固定边际下，当 $\\theta\\to\\infty$ 时，条件似然将所有概率质量置于上边界 $a=\\min(n_1, m_1)$，因此条件最大似然估计也发散。通过反演 Fisher 检验得到的精确双侧 $95\\%$ 置信集的形式为 $[L,\\infty)$ 且 $L1$，这反映了观测到的暴露病例数位于其支持集的上边界；向每个单元格添加 Haldane–Anscombe $+1/2$ 伪计数可以产生一个有限但有偏的区间。\n\nB. Fisher 的精确条件 $95\\%$ 置信区间在出现零单元格时也总是有限的，因为超几何似然在 $\\theta$ 上是对称衰减的，所以两个界限都不可能是无限的。\n\nC. Firth 的惩罚似然（Jeffreys 先验惩罚）总是与通过 Fisher 精确条件反演得到的区间相匹配，因此惩罚不会改变端点，也无法解决由零单元格引起的发散问题。\n\nD. 在固定边际下，任何零单元格表中的条件最大似然估计为 $\\theta=1$，因此在条件分析中不存在发散；任何无穷大的估计都仅源于不恰当的无条件模型。\n\nE. 在基于泊松计数的队列分析中，任何一组中出现零事件都会产生未定义的点估计，但无论是否存在零单元格，精确泊松方法总能为率比产生有限的 $95\\%$ 置信区间。", "solution": "用户提供了一个生物统计学问题，涉及从一个含有零单元格计数的病例对照研究中估计比值比。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n\n该问题提供了以下数据和定义：\n-   **研究设计**：病例对照研究。\n-   **数据**：暴露状态 ($X$) 与病例状态 ($Y$) 的 $2 \\times 2$ 交叉表。\n    -   病例 ($Y=1$)：$12$ 人暴露 ($X=1$)，$3$ 人未暴露 ($X=0$)。\n    -   对照 ($Y=0$)：$0$ 人暴露 ($X=1$)，$25$ 人未暴露 ($X=0$)。\n-   **符号**：\n    -   $Y \\in \\{0,1\\}$：$Y=1$ 为病例，$Y=0$ 为对照。\n    -   $X \\in \\{0,1\\}$：暴露状态。\n    -   $p_1 = \\mathbb{P}(X=1 \\mid Y=1)$：病例中的暴露概率。\n    -   $p_0 = \\mathbb{P}(X=1 \\mid Y=0)$：对照中的暴露概率。\n-   **感兴趣的参数**：比值比 $\\theta$。\n-   **定义**：\n    -   比值：$p/(1-p)$，其中 $p$ 是一个事件的概率。\n    -   比值比：$\\theta = \\frac{\\text{病例中的暴露比值}}{\\text{对照中的暴露比值}} = \\frac{p_1/(1-p_1)}{p_0/(1-p_0)}$。\n-   **需要考虑的假设和方法**：\n    -   在层内（病例和对照）进行独立的伯努利抽样。\n    -   伯努利概率的最大似然估计 (MLE) 是观测比例。\n    -   基于估计 $p_1$ 和 $p_0$ 的无条件似然。\n    -   基于 $2 \\times 2$ 表的固定边际的条件似然。\n    -   基于暴露病例数条件分布的对 $\\theta$ 的精确条件推断。\n    -   通过对双侧 Fisher 精确检验进行反演来构建 $95\\%$ 置信区间 ($\\alpha=0.05$)。\n    -   小样本调整（例如，伪计数）。\n\n**步骤 2：使用提取的信息进行验证**\n\n根据指定标准对问题进行验证。\n-   **科学上成立**：是的。该问题完全属于分类数据分析的标准理论范畴，特别是关于病例对照研究中 $2 \\times 2$ 表的分析。比值比、最大似然估计（包括条件和无条件）以及 Fisher 精确检验等概念是生物统计学和流行病学的基础。零单元格计数的情景是一个常见且重要的实际问题。\n-   **问题定义良好**：是的。问题陈述清晰，提供了所有必要的数据和定义。问题具体，要求在明确定义的稀疏数据场景下分析点估计量和区间估计量的行为。基于已建立的统计学原理进行独特且有意义的分析是可能的。\n-   **客观性**：是的。语言正式，使用了统计学中标准的、无歧义的术语。它不包含主观或基于意见的内容。\n\n该问题没有表现出任何列出的缺陷... 数据代表了一种“分离”或“单调似然”的情景，这是一个被充分研究的现象，而不是问题陈述本身的缺陷。\n\n**步骤 3：结论和行动**\n\n问题陈述是**有效**的。将进行全面分析。\n\n### 解题推导\n\n首先，我们将提供的数据构造成一个标准的 $2 \\times 2$ 表格形式，单元格用 $a, b, c, d$ 表示。\n-   $a$：暴露病例数 = $12$\n-   $b$：暴露对照数 = $0$\n-   $c$：未暴露病例数 = $3$\n-   $d$：未暴露对照数 = $25$\n\n该表为：\n$$\n\\begin{array}{c|cc|c}\n  \\text{病例 ($Y=1$)}  \\text{对照 ($Y=0$)}  \\text{合计} \\\\\n\\hline\n\\text{暴露 ($X=1$)}  a=12  b=0  m_1=12 \\\\\n\\text{未暴露 ($X=0$)}  c=3  d=25  m_0=28 \\\\\n\\hline\n\\text{合计}  n_1=15  n_0=25  N=40\n\\end{array}\n$$\n\n**1. $\\theta$ 的无条件最大似然估计**\n\n问题要求估计 $\\theta = \\frac{p_1/(1-p_1)}{p_0/(1-p_0)}$。\n根据伯努利概率的 MLE 是样本比例的原理：\n-   $p_1 = \\mathbb{P}(X=1 \\mid Y=1)$ 的 MLE 是 $\\hat{p}_1 = \\frac{a}{a+c} = \\frac{12}{12+3} = \\frac{12}{15} = 0.8$。\n-   $p_0 = \\mathbb{P}(X=1 \\mid Y=0)$ 的 MLE 是 $\\hat{p}_0 = \\frac{b}{b+d} = \\frac{0}{0+25} = 0$。\n\n现在，我们计算每组比值的 MLE：\n-   病例中暴露比值的 MLE：$\\frac{\\hat{p}_1}{1-\\hat{p}_1} = \\frac{0.8}{1-0.8} = \\frac{0.8}{0.2} = 4$。这也等于 $\\frac{a}{c} = \\frac{12}{3} = 4$。\n-   对照中暴露比值的 MLE：$\\frac{\\hat{p}_0}{1-\\hat{p}_0} = \\frac{0}{1-0} = 0$。这也等于 $\\frac{b}{d} = \\frac{0}{25} = 0$。\n\n比值比的无条件 MLE，即 $\\hat{\\theta}_{MLE}$，是这些估计比值的比率：\n$$ \\hat{\\theta}_{MLE} = \\frac{a/c}{b/d} = \\frac{ad}{bc} = \\frac{12 \\times 25}{0 \\times 3} = \\frac{300}{0} $$\n该表达式涉及除以零，故无定义。当分母从正向趋近于零时，极限为 $+\\infty$。因此，$\\theta$ 的无条件 MLE 是无界的（无穷大）。这是因为对照组中估计的暴露概率为 $0$，导致该组的估计比值为 $0$。\n\n**2. $\\theta$ 的条件最大似然估计**\n\n在条件分析中，我们以表格的边际总数为条件：$n_1=15$，$n_0=25$，$m_1=12$，$m_0=28$。计数 $a$（暴露病例数）的分布遵循非中心超几何分布，其概率质量函数仅依赖于 $\\theta$：\n$$ P(A=k \\mid n_1, m_1, N; \\theta) = \\frac{\\binom{n_1}{k}\\binom{N-n_1}{m_1-k}\\theta^k}{\\sum_{j} \\binom{n_1}{j}\\binom{N-n_1}{m_1-j}\\theta^j} $$\n$A$ 的可能值范围是 $k \\in [\\max(0, n_1+m_1-N), \\min(n_1, m_1)]$。\n对于我们的数据，支持集是 $k \\in [\\max(0, 15+12-40), \\min(15, 12)] = [\\max(0, -13), 12] = [0, 12]$。\n观测值为 $a=12$，这是支持集中的最大可能值。\n\n条件对数似然函数是 $l(\\theta; a) = a \\log(\\theta) + \\text{const} - \\log\\left(\\sum_{j} \\binom{n_1}{j}\\binom{N-n_1}{m_1-j}\\theta^j\\right)$。它关于 $\\log(\\theta)$ 的导数是 $a - E[A; \\theta]$。条件 MLE 通过求解 $E[A; \\theta] = a_{obs}$ 找到。\n期望值 $E[A; \\theta]$ 是 $\\theta$ 的一个严格递增函数，其值受限于 $A$ 的支持集，即 $0 \\le E[A; \\theta] \\le 12$。由于我们的观测值 $a_{obs}=12$ 是支持集的上边界，方程 $E[A; \\theta] = 12$ 只能在 $\\theta \\to \\infty$ 的极限情况下成立。这种情况被称为单调似然或分离，它意味着 $\\theta$ 的条件 MLE 也发散至 $+\\infty$。\n\n**3. 通过 Fisher 反演得到的精确条件置信集**\n\n$\\theta$ 的一个 $100(1-\\alpha)\\%$ 置信集是所有 $\\theta_0$ 值的集合，对于这些值，在 $\\alpha$ 水平上，对 $H_0: \\theta = \\theta_0$ 的双侧检验不会被拒绝。对于 $\\alpha=0.05$，我们为每个尾部使用 $\\alpha/2 = 0.025$。\n区间是 $[L, U]$，其中：\n-   $L$ 是使上尾概率等于 $\\alpha/2$ 的 $\\theta$ 值。\n    $ P(A \\ge a_{obs} \\mid \\theta=L) = \\alpha/2 $。\n    在我们的例子中，$a_{obs}=12$。由于 $12$ 是最大值，这可以简化为 $P(A=12 \\mid \\theta=L) = 0.025$。\n    概率 $P(A=12 \\mid \\theta)$ 是 $\\theta$ 的一个严格递增函数。在 $\\theta=0$ 时，此概率为 $0$。当 $\\theta \\to \\infty$ 时，它趋近于 $1$。因此，必定存在一个唯一的、有限的、正的 $L$ 值来解这个方程。当 $\\theta=1$ 时，$P(A=12) = \\frac{\\binom{15}{12}\\binom{25}{0}}{\\binom{40}{12}}$，这是一个极小的值（约 $8 \\times 10^{-8}$）。要使这个概率为 $0.025$，我们必须有 $L  1$。\n\n-   $U$ 是使下尾概率等于 $\\alpha/2$ 的 $\\theta$ 值。\n    $ P(A \\le a_{obs} \\mid \\theta=U) = \\alpha/2 $。\n    在我们的例子中，$a_{obs}=12$。由于 $A$ 的支持集是 $[0, 12]$，事件 $A \\le 12$ 包含了整个样本空间。\n    因此，对于任何 $\\theta$ 值，$P(A \\le 12 \\mid \\theta) = 1$。\n    求解 $U$ 的方程变为 $1 = 0.025$，这是不可能的。这意味着无论 $\\theta$ 值多大，都不能根据此标准将其从置信集中排除。上界是无穷大。\n\n最终得到的 $95\\%$ 置信集是一个形如 $[L, \\infty)$ 的单侧区间，其中 $L1$。\n\n**4. 小样本调整**\n\nHaldane-Anscombe 调整通过向每个单元格添加 $0.5$ 的伪计数来缓解零计数问题。\n调整后的表格为：$a'=12.5$，$b'=0.5$，$c'=3.5$，$d'=25.5$。\n调整后的比值比估计为：\n$$ \\hat{\\theta}_{adj} = \\frac{a'd'}{b'c'} = \\frac{12.5 \\times 25.5}{0.5 \\times 3.5} = \\frac{318.75}{1.75} \\approx 182.14 $$\n这个估计是有限的。基于这个调整后表格的置信区间（例如，Woolf 的 logit 区间）也将具有有限的端点。这种调整引入了一个已知的偏差，以换取获得有限的估计和区间。\n\n### 逐项分析\n\n**A. 在此表中，$\\theta$ 的无条件最大似然估计是无穷大，因为对照组中估计的暴露概率为 $0$，使得对照组的比值为 $0$，从而导致比值比趋向 $+\\infty$。在固定边际下，当 $\\theta\\to\\infty$ 时，条件似然将所有概率质量置于上边界 $a=\\min(n_1, m_1)$，因此条件最大似然估计也发散。通过反演 Fisher 检验得到的精确双侧 $95\\%$ 置信集的形式为 $[L,\\infty)$ 且 $L1$，这反映了观测到的暴露病例数位于其支持集的上边界；向每个单元格添加 Haldane–Anscombe $+1/2$ 伪计数可以产生一个有限但有偏的区间。**\n\n-   关于无条件 MLE 无穷大的推理是正确的，如上文推导。\n-   关于条件 MLE 发散的推理也是正确的。观测计数位于其最大可能值（$a=12$，这里恰好是 $m_1$，但更一般地是 $\\min(n_1, m_1)$）。当 $\\theta \\to \\infty$ 时，条件似然将所有质量置于此边界的说法是 MLE 发散的正确直觉。在选项中，上边界被写为 $a=n_1$，但在我们的例子中，$a = \\min(n_1, m_1) = \\min(15, 12)=12$。这稍微不精确，但核心思想是正确的。\n-   将精确置信集描述为 $[L, \\infty)$ 且 $L1$ 是正确的，并且给出的理由（观测值在支持集边界）是准确的。\n-   Haldane-Anscombe ($+1/2$) 伪计数调整产生一个有限但有偏的区间的说法也是正确的。\n-   **结论：正确。**\n\n**B. Fisher 的精确条件 $95\\%$ 置信区间在出现零单元格时也总是有限的，因为超几何似然在 $\\theta$ 上是对称衰减的，所以两个界限都不可能是无限的。**\n\n-   这个说法是错误的。如上文推导，当观测值位于其支持集的边界时（如果存在像 $b=0$ 这样的零单元格，而 $a, c, d  0$ 时，这必然发生），精确区间是单侧的，因此不是有限的。\n-   其理由也是错误的。似然是基于非中心超几何分布的，该分布相对于 $\\theta$ 并非对称。\n-   **结论：错误。**\n\n**C. Firth 的惩罚似然（Jeffreys 先验惩罚）总是与通过 Fisher 精确条件反演得到的区间相匹配，因此惩罚不会改变端点，也无法解决由零单元格引起的发散问题。**\n\n-   这是错误的。Firth 型惩罚是一种专门设计用来解决分离/单调似然问题并产生有限点估计和置信区间的方法。其产生的区间通常与精确条件区间不同，并且在这种情况下，在性质上是不同的（即有限与无限）。\n-   **结论：错误。**\n\n**D. 在固定边际下，任何零单元格表中的条件最大似然估计为 $\\theta=1$，因此在条件分析中不存在发散；任何无穷大的估计都仅源于不恰当的无条件模型。**\n\n-   这是错误的。如推导所示，在这种情况下，条件 MLE 也发散到 $+\\infty$。只有当观测计数 $a$ 等于其在原假设 $\\theta=1$ 下的期望值时，MLE 才会是 $\\theta=1$，而该期望值为 $E[A \\mid \\theta=1] = n_1 m_1 / N = (15 \\times 12) / 40 = 4.5$。观测计数是 $12$，不是 $4.5$。\n-   **结论：错误。**\n\n**E. 在基于泊松计数的队列分析中，任何一组中出现零事件都会产生未定义的点估计，但无论是否存在零单元格，精确泊松方法总能为率比产生有限的 $95\\%$ 置信区间。**\n\n-   这个选项讨论了一个不同但类似的统计问题。其断言是有缺陷的。虽然如果参照组有零事件，率比的 MLE 是未定义的，但率比的精确置信区间并*不*总是有限的。如果参照组有零事件而指标组有一个或多个事件，率比的精确条件（基于二项分布）置信区间将是单侧的，形式为 $[L, \\infty)$，与比值比的情况完全类似。\n-   **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "4972025"}]}