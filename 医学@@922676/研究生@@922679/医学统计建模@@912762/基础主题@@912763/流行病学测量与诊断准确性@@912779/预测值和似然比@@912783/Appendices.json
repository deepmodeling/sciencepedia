{"hands_on_practices": [{"introduction": "本练习将带领我们完成一次基础但至关重要的计算，即如何利用似然比（Likelihood Ratio）来更新我们对某个事件的先验信念。通过将概率（probability）转换为比值（odds）进行计算，我们可以清晰地看到贝叶斯定理在实践中是如何运作的，这个技巧在临床决策和流行病学研究中被广泛使用。这项练习旨在巩固您对先验概率、后验概率以及它们之间通过似然比建立联系的核心理解 [@problem_id:4557324]。", "problem": "一家社区预防医学诊所正在试行一项针对某种潜伏性传染病的基于风险的筛查项目。对于高风险分层中的个体，患有该病的先验概率为 $p=0.10$。筛查检测返回单个阳性结果，且验证研究表明阳性测试的似然比 ($LR^{+}$) 为 $8$。请仅使用概率、优势、似然比和贝叶斯定理的核心定义，将先验概率 $p$ 转换为先验优势 $\\frac{p}{1-p}$，使用 $LR^{+}$ 更新以获得后验优势，然后将此单次阳性测试后的结果转换回后验概率。请明确展示每个转换步骤。将最终的后验概率表示为小数，并四舍五入至四位有效数字。", "solution": "在尝试解答之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 患病的先验概率：$p=0.10$。\n- 筛查检测结果：单个阳性结果。\n- 阳性测试的似然比：$LR^{+} = 8$。\n- 任务是计算阳性测试后的后验概率，方法是首先将先验概率转换为先验优势，然后使用似然比更新为后验优势，最后将后验优势转换回后验概率。最终答案必须是四舍五入到四位有效数字的小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行评估：\n- **科学依据**：该问题利用了流行病学和生物统计学中的核心、已验证的概念，即先验概率、优势、似然比和贝叶斯更新。这些是解读临床和预防医学中诊断测试结果的标准工具。给定值（$p=0.10$, $LR^{+}=8$）对于应用于高风险人群的中等良好测试是现实的。该问题具有科学合理性。\n- **适定性**：所有必要信息均已提供。概率、优势和似然比之间的关系定义明确。指令清晰，可导向唯一、稳定的解。该问题是适定的。\n- **客观性**：语言精确且量化，没有任何主观或模棱两可的术语。\n\n### 步骤 3：结论与行动\n问题有效。这是贝叶斯原理在医学背景下的直接应用。将提供完整解答。\n\n解答过程遵循问题陈述中概述的步骤。设 $D$ 为个体患病的事件，设 $T^{+}$ 为测试结果为阳性的事件。\n\n患病的先验概率为 $P(D) = p = 0.10$。\n\n**步骤 1：将先验概率转换为先验优势。**\n\n概率 $P$ 和优势 $O$ 之间的关系定义为 $O = \\frac{P}{1-P}$。\n患病的先验优势 $O_{\\text{prior}}$ 是根据先验概率 $p$ 计算的：\n$$\nO_{\\text{prior}} = \\frac{p}{1-p}\n$$\n代入给定值 $p=0.10$：\n$$\nO_{\\text{prior}} = \\frac{0.10}{1 - 0.10} = \\frac{0.10}{0.90} = \\frac{1}{9}\n$$\n\n**步骤 2：使用 $LR^{+}$ 更新以获得后验优势。**\n\n贝叶斯定理可以用优势和似然比来表示。后验优势是先验优势与相关似然比的乘积。对于阳性测试结果 ($T^{+}$)，我们使用阳性似然比 $LR^{+}$。\n$$\n\\text{后验优势} = \\text{先验优势} \\times \\text{似然比}\n$$\n在我们的符号表示中，这是：\n$$\nO_{\\text{post}} = O_{\\text{prior}} \\times LR^{+}\n$$\n在这里，$O_{\\text{post}}$ 表示在给定阳性测试结果下患病的优势，$O(D|T^{+})$。\n代入 $O_{\\text{prior}}$ 和 $LR^{+}$ 的值：\n$$\nO_{\\text{post}} = \\frac{1}{9} \\times 8 = \\frac{8}{9}\n$$\n\n**步骤 3：将后验优势转换回后验概率。**\n\n将优势 $O$ 转换回概率 $P$ 的关系是 $P = \\frac{O}{1+O}$。\n后验概率 $P_{\\text{post}}$ 是在给定阳性测试结果下患病的概率，$P(D|T^{+})$。它是根据后验优势 $O_{\\text{post}}$ 计算的：\n$$\nP_{\\text{post}} = \\frac{O_{\\text{post}}}{1 + O_{\\text{post}}}\n$$\n代入 $O_{\\text{post}}$ 的值：\n$$\nP_{\\text{post}} = \\frac{\\frac{8}{9}}{1 + \\frac{8}{9}} = \\frac{\\frac{8}{9}}{\\frac{9}{9} + \\frac{8}{9}} = \\frac{\\frac{8}{9}}{\\frac{17}{9}} = \\frac{8}{17}\n$$\n\n**最终计算和四舍五入**\n\n问题要求最终答案表示为四舍五入到四位有效数字的小数。\n$$\nP_{\\text{post}} = \\frac{8}{17} \\approx 0.470588235...\n$$\n四舍五入到四位有效数字得出：\n$$\nP_{\\text{post}} \\approx 0.4706\n$$\n该值表示个体在收到单个阳性测试结果后患有该潜伏性疾病的更新概率。", "answer": "$$\n\\boxed{0.4706}\n$$", "id": "4557324"}, {"introduction": "一个诊断测试即使具有极高的灵敏度（sensitivity）和特异性（specificity），其阳性预测值（Positive Predictive Value）为何仍可能出人意料地低？这个问题在低患病率（prevalence）人群中进行筛查时尤为突出，被称为“基础率谬误”（base rate fallacy）。本练习通过一个实际的公共卫生场景，引导您从基本定义出发推导阳性预测值，并通过计算预期人数来直观地揭示为何在罕见病筛查中，绝大多数阳性结果可能是假阳性 [@problem_id:4557306]。", "problem": "一个预防性筛查项目考虑为一种罕见病症引入一项新的实验室检测。该检测的灵敏度（sensitivity，即在患病情况下检测结果为阳性的概率）为 $Se=0.99$，特异度（specificity，即在未患病情况下检测结果为阴性的概率）为 $Sp=0.99$。筛查人群中的疾病患病率（prevalence）为 $p=0.001$。请仅从灵敏度、特异度、患病率的核心定义以及全概率定律出发，推导在检测结果为阳性的条件下个体患有该疾病的概率，并将其表示为阳性预测值（positive predictive value, PPV）。然后，为了在公共卫生背景下解释该值，假设在一次筛查活动中对 $N=10^{6}$ 名个体进行筛查，并使用相同的参数计算真阳性（true positives）和假阳性（false positives）的期望数量，以解释为何尽管检测准确度极高，许多阳性结果却是假阳性。\n\n你最终报告的答案必须是阳性预测值 $PPV$ 的单一数值，以小数形式表示。将你的答案四舍五入到四位有效数字。", "solution": "该问题被认定为有效，因为它在科学上基于生物统计学和流行病学的原理，在数学上是适定且自洽的，并使用了客观、明确的语言。\n\n让我们定义以下事件：\n$D$：个体患有该疾病的事件。\n$D^c$：个体未患该疾病的事件。\n$T^+$：检测结果为阳性的事件。\n$T^-$：检测结果为阴性的事件。\n\n问题根据患病率、灵敏度和特异度的定义提供了以下概率：\n疾病的患病率为 $p = P(D) = 0.001$。\n因此，未患病的概率为 $P(D^c) = 1 - P(D) = 1 - p = 1 - 0.001 = 0.999$。\n检测的灵敏度为 $Se = P(T^+|D) = 0.99$。这是指个体患病条件下检测结果为阳性的概率。\n检测的特异度为 $Sp = P(T^-|D^c) = 0.99$。这是指个体未患病条件下检测结果为阴性的概率。\n\n根据特异度的定义，我们可以确定假阳性率，即个体未患病条件下检测结果为阳性的概率：\n$$P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - Sp = 1 - 0.99 = 0.01$$\n\n主要目标是推导阳性预测值（PPV），即在检测结果为阳性的条件下个体患有该疾病的概率，记为 $P(D|T^+)$。我们从条件概率的定义开始，这也是贝叶斯定理的一种表述形式：\n$$PPV = P(D|T^+) = \\frac{P(D \\cap T^+)}{P(T^+)}$$\n分子 $P(D \\cap T^+)$ 是同时患病且检测呈阳性的联合概率。它可以用灵敏度的定义来表示：\n$$P(T^+|D) = \\frac{P(D \\cap T^+)}{P(D)} \\implies P(D \\cap T^+) = P(T^+|D) \\cdot P(D) = Se \\cdot p$$\n分母 $P(T^+)$ 是获得阳性检测结果的总概率。我们可以使用全概率定律，通过将人群划分为患病者 ($D$) 和非患病者 ($D^c$) 两部分，并对这两部分中出现阳性检测的概率求和来得到这个值：\n$$P(T^+) = P(T^+|D)P(D) + P(T^+|D^c)P(D^c)$$\n代入已知项：\n$$P(T^+) = (Se \\cdot p) + ((1 - Sp) \\cdot (1 - p))$$\n现在，我们可以组合出 PPV 的完整表达式：\n$$PPV = P(D|T^+) = \\frac{Se \\cdot p}{Se \\cdot p + (1 - Sp)(1 - p)}$$\n该表达式完全由所提供的定义和全概率定律推导得出。\n\n现在我们代入给定的数值：$Se=0.99$，$Sp=0.99$，$p=0.001$。\n$$PPV = \\frac{0.99 \\times 0.001}{0.99 \\times 0.001 + (1 - 0.99) \\times (1 - 0.001)}$$\n$$PPV = \\frac{0.00099}{0.00099 + (0.01) \\times (0.999)}$$\n$$PPV = \\frac{0.00099}{0.00099 + 0.00999}$$\n$$PPV = \\frac{0.00099}{0.01098} \\approx 0.09016393...$$\n\n为了在公共卫生背景下解释这一结果，我们考虑对一个 $N=10^6$ 人的群体进行筛查。\n患病个体的期望数量为：\n$$E[\\text{Diseased}] = N \\times p = 10^6 \\times 0.001 = 1000$$\n未患病个体的期望数量为：\n$$E[\\text{Not Diseased}] = N \\times (1 - p) = 10^6 \\times 0.999 = 999000$$\n真阳性（TP）的期望数量，即检测呈阳性的患病个体数量，为：\n$$E[TP] = E[\\text{Diseased}] \\times Se = 1000 \\times 0.99 = 990$$\n假阳性（FP）的期望数量，即检测呈阳性的无病个体数量，为：\n$$E[FP] = E[\\text{Not Diseased}] \\times (1 - Sp) = 999000 \\times 0.01 = 9990$$\n阳性检测总数的期望值是真阳性和假阳性之和：\n$$E[\\text{Total Positives}] = E[TP] + E[FP] = 990 + 9990 = 10980$$\nPPV 可以通过真阳性与总阳性数的比率来独立验证：\n$$PPV = \\frac{E[TP]}{E[\\text{Total Positives}]} = \\frac{990}{10980} \\approx 0.09016$$\n这证实了我们的计算。现在的解释就很清楚了：尽管该检测具有很高的准确度（99%的灵敏度和99%的特异度），但假阳性的数量（9990）是真阳性数量（990）的十倍以上。这是因为该疾病非常罕见（$p=0.001$），所以即使很小的假阳性率（1%）作用于一个极其庞大的健康人群，也会产生大量的假警报。相比之下，高灵敏度作用于一个非常小的患病人群。因此，对于任何一个收到阳性检测结果的个体来说，他们实际患病的概率仅为约9%。\n\n问题要求将PPV的数值四舍五入到四位有效数字。\n$PPV \\approx 0.09016$", "answer": "$$\\boxed{0.09016}$$", "id": "4557306"}, {"introduction": "在实际应用中，我们有时可能无法直接获得诊断测试的灵敏度（sensitivity）和特异性（specificity），但可以通过大规模筛查获得其阳性预测值（PPV）和阴性预测值（NPV）的经验估计。这个练习提出了一个“逆向问题”：如何利用已知的患病率 $\\pi$、PPV和NPV来反向推算出测试内在的性能指标，即灵敏度和特异性。解决这个问题需要您熟练地操纵相关公式，从而加深对这些关键性能指标之间相互依赖关系的理解 [@problem_id:4940463]。", "problem": "一项针对呼吸道病原体的快速诊断检测被用于社区筛查项目。设 $\\pi$ 表示疾病患病率，$\\text{Se}$ 表示灵敏度，$\\text{Sp}$ 表示特异度。阳性预测值 (PPV) 定义为条件概率 $P(\\text{Disease} \\mid \\text{Test} +)$，阴性预测值 (NPV) 定义为 $P(\\text{No Disease} \\mid \\text{Test} -)$。假设 $\\pi = 0.1$，并且该项目根据经验估计出 $PPV = 0.4$ 和 $NPV = 0.95$。\n\n从条件概率的定义出发，结合贝叶斯定理和全概率定律，推导连接 $PPV$、$NPV$、$\\pi$、$\\text{Se}$ 和 $\\text{Sp}$ 的代数关系式。使用这些关系式求解与给定的 $\\pi$、$PPV$ 和 $NPV$ 一致的有序对 $(\\text{Se}, \\text{Sp})$。然后，通过验证所得的 $\\text{Se}$ 和 $\\text{Sp}$ 位于区间 $[0,1]$ 内，并将其代入定义关系式中能重现给定的 $PPV$ 和 $NPV$，来评估可行性约束。\n\n请以精确分数形式表示 $(\\text{Se}, \\text{Sp})$ 的最终答案。无需四舍五入。", "solution": "该问题提法明确，并以生物统计学和概率论的原理为科学依据。它提供了足够的信息来确定该诊断检测的灵敏度和特异度的唯一解。\n\n设 $D$ 为个体患病的事件，设 $H$ 为个体健康的事件（无疾病）。设 $T+$ 表示阳性检测结果，$T-$ 表示阴性检测结果。给定的量如下：\n- 疾病患病率: $\\pi = P(D) = 0.1$。因此，健康的概率为 $P(H) = 1 - \\pi = 1 - 0.1 = 0.9$。\n- 灵敏度: $\\text{Se} = P(T+ \\mid D)$。\n- 特异度: $\\text{Sp} = P(T- \\mid H)$。\n- 阳性预测值 (PPV): $PPV = P(D \\mid T+) = 0.4$。\n- 阴性预测值 (NPV): $NPV = P(H \\mid T-) = 0.95$。\n\n根据这些定义，我们还有：\n- 假阴性率: $P(T- \\mid D) = 1 - P(T+ \\mid D) = 1 - \\text{Se}$。\n- 假阳性率: $P(T+ \\mid H) = 1 - P(T- \\mid H) = 1 - \\text{Sp}$。\n\n我们的首要任务是推导连接这些量的代数关系。我们使用贝叶斯定理和全概率定律。\n\n阳性预测值 (PPV) 由下式给出：\n$$PPV = P(D \\mid T+) = \\frac{P(T+ \\mid D) P(D)}{P(T+)}$$\n分母 $P(T+)$ 是检测结果为阳性的总概率，可以展开为：\n$$P(T+) = P(T+ \\mid D) P(D) + P(T+ \\mid H) P(H)$$\n代入 $\\pi$、$\\text{Se}$ 和 $\\text{Sp}$ 的定义：\n$$P(T+) = (\\text{Se})(\\pi) + (1 - \\text{Sp})(1 - \\pi)$$\n因此，PPV 为：\n$$PPV = \\frac{\\text{Se} \\cdot \\pi}{\\text{Se} \\cdot \\pi + (1 - \\text{Sp})(1 - \\pi)}$$\n\n类似地，阴性预测值 (NPV) 由下式给出：\n$$NPV = P(H \\mid T-) = \\frac{P(T- \\mid H) P(H)}{P(T-)}$$\n分母 $P(T-)$ 是检测结果为阴性的总概率，可以展开为：\n$$P(T-) = P(T- \\mid H) P(H) + P(T- \\mid D) P(D)$$\n代入定义：\n$$P(T-) = (\\text{Sp})(1 - \\pi) + (1 - \\text{Se})(\\pi)$$\n因此，NPV 为：\n$$NPV = \\frac{\\text{Sp} \\cdot (1 - \\pi)}{\\text{Sp} \\cdot (1 - \\pi) + (1 - \\text{Se})\\pi}$$\n以上就是所需的两个基本代数关系式。\n\n现在，我们使用给定的值 $\\pi = 0.1$，$PPV = 0.4$ 和 $NPV = 0.95$ 来求解有序对 $(\\text{Se}, \\text{Sp})$。为了便于精确计算，我们使用分数：$\\pi = \\frac{1}{10}$，$1-\\pi = \\frac{9}{10}$，$PPV = \\frac{4}{10} = \\frac{2}{5}$，以及 $NPV = \\frac{95}{100} = \\frac{19}{20}$。\n\n根据 PPV 方程：\n$$\\frac{2}{5} = \\frac{\\text{Se} \\cdot \\frac{1}{10}}{\\text{Se} \\cdot \\frac{1}{10} + (1 - \\text{Sp}) \\cdot \\frac{9}{10}}$$\n将右侧的分子和分母同乘以 $10$：\n$$\\frac{2}{5} = \\frac{\\text{Se}}{\\text{Se} + 9(1 - \\text{Sp})}$$\n交叉相乘得到：\n$$2(\\text{Se} + 9(1 - \\text{Sp})) = 5\\text{Se}$$\n$$2\\text{Se} + 18(1 - \\text{Sp}) = 5\\text{Se}$$\n$$18 - 18\\text{Sp} = 3\\text{Se}$$\n两边同除以 $3$，我们得到第一个关联 $\\text{Se}$ 和 $\\text{Sp}$ 的线性方程：\n$$\\text{Se} = 6 - 6\\text{Sp} \\quad (1)$$\n\n根据 NPV 方程：\n$$\\frac{19}{20} = \\frac{\\text{Sp} \\cdot \\frac{9}{10}}{\\text{Sp} \\cdot \\frac{9}{10} + (1 - \\text{Se}) \\cdot \\frac{1}{10}}$$\n将右侧的分子和分母同乘以 $10$：\n$$\\frac{19}{20} = \\frac{9\\text{Sp}}{9\\text{Sp} + (1 - \\text{Se})}$$\n交叉相乘得到：\n$$19(9\\text{Sp} + 1 - \\text{Se}) = 20(9\\text{Sp})$$\n$$171\\text{Sp} + 19 - 19\\text{Se} = 180\\text{Sp}$$\n$$19 - 19\\text{Se} = 9\\text{Sp} \\quad (2)$$\n\n现在我们有一个由两个线性方程组成的方程组。将方程 $(1)$ 代入方程 $(2)$：\n$$19 - 19(6 - 6\\text{Sp}) = 9\\text{Sp}$$\n$$19 - 114 + 114\\text{Sp} = 9\\text{Sp}$$\n$$-95 = 9\\text{Sp} - 114\\text{Sp}$$\n$$-95 = -105\\text{Sp}$$\n$$\\text{Sp} = \\frac{95}{105} = \\frac{19 \\times 5}{21 \\times 5} = \\frac{19}{21}$$\n\n现在，将 $\\text{Sp}$ 的值代回方程 $(1)$ 中求 $\\text{Se}$：\n$$\\text{Se} = 6 - 6\\left(\\frac{19}{21}\\right) = 6 - \\frac{6 \\cdot 19}{21} = 6 - \\frac{2 \\cdot 19}{7}$$\n$$\\text{Se} = \\frac{6 \\cdot 7}{7} - \\frac{38}{7} = \\frac{42 - 38}{7} = \\frac{4}{7}$$\n解为有序对 $(\\text{Se}, \\text{Sp}) = (\\frac{4}{7}, \\frac{19}{21})$。\n\n最后，我们评估可行性约束。\n1.  $\\text{Se}$ 和 $\\text{Sp}$ 都必须位于区间 $[0, 1]$ 内。\n    $\\text{Se} = \\frac{4}{7} \\approx 0.5714$，在 $[0, 1]$ 区间内。\n    $\\text{Sp} = \\frac{19}{21} \\approx 0.9048$，在 $[0, 1]$ 区间内。\n    此条件满足。\n\n2.  这些值必须能重现给定的 $PPV$ 和 $NPV$。\n    - 检验 $PPV$：\n    $$PPV = \\frac{\\frac{4}{7} \\cdot \\frac{1}{10}}{\\frac{4}{7} \\cdot \\frac{1}{10} + (1 - \\frac{19}{21}) \\cdot \\frac{9}{10}} = \\frac{\\frac{4}{70}}{\\frac{4}{70} + (\\frac{2}{21}) \\cdot \\frac{9}{10}} = \\frac{\\frac{4}{70}}{\\frac{4}{70} + \\frac{18}{210}}$$\n    为了将分母中的分数相加，我们使用公分母 $210$：$\\frac{4}{70} = \\frac{12}{210}$。\n    $$PPV = \\frac{\\frac{12}{210}}{\\frac{12}{210} + \\frac{18}{210}} = \\frac{\\frac{12}{210}}{\\frac{30}{210}} = \\frac{12}{30} = \\frac{2}{5} = 0.4$$\n    $PPV$ 被正确地重现了。\n\n    - 检验 $NPV$：\n    $$NPV = \\frac{\\frac{19}{21} \\cdot \\frac{9}{10}}{\\frac{19}{21} \\cdot \\frac{9}{10} + (1 - \\frac{4}{7}) \\cdot \\frac{1}{10}} = \\frac{\\frac{171}{210}}{\\frac{171}{210} + (\\frac{3}{7}) \\cdot \\frac{1}{10}} = \\frac{\\frac{171}{210}}{\\frac{171}{210} + \\frac{3}{70}}$$\n    为了将分母中的分数相加，我们使用公分母 $210$：$\\frac{3}{70} = \\frac{9}{210}$。\n    $$NPV = \\frac{\\frac{171}{210}}{\\frac{171}{210} + \\frac{9}{210}} = \\frac{\\frac{171}{210}}{\\frac{180}{210}} = \\frac{171}{180} = \\frac{19 \\times 9}{20 \\times 9} = \\frac{19}{20} = 0.95$$\n    $NPV$ 也被正确地重现了。\n\n推导出的灵敏度和特异度值与所有给定的信息和约束条件一致。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{4}{7}  \\frac{19}{21} \\end{pmatrix}}$$", "id": "4940463"}]}