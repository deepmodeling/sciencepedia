## 引言
量化疾病在人群中的分布和动态是流行病学、生物统计学和公共卫生实践的基石。在所有衡量指标中，**发病率 (incidence)** 和 **患病率 (prevalence)** 无疑是两个最核心的概念，它们分别从“新发”和“现存”两个维度描绘了疾病的图景。然而，对这些指标的理解若仅停留在表面定义，研究者在设计研究、解读数据和评估干预措施时极易陷入误区。真正的挑战在于深刻把握它们的内在联系、计算方法的微妙差异、在不同研究场景下的正确选择，以及处理现实世界数据中（如[竞争风险](@entry_id:173277)和混杂因素）的复杂性。

本文旨在为医学统计领域的研究生提供一份关于发病率和患病率的全面指南。我们将分三个章节系统地展开：第一章“**原理与机制**”将深入探讨发病率和患病率的定义、计算方法、两者间的动态关系以及如[风险函数](@entry_id:166593)和竞争风险等高级理论。第二章“**应用与跨学科联系**”将通过流行病学研究设计、干预评估和公共卫生监测等实例，展示这些指标在解决实际问题中的强大作用。最后，第三章“**动手实践**”将提供具体的计算问题，帮助读者将理论知识转化为实践技能。

通过本次学习，您将能够自信地选择、计算和解释这些关键的疾病频率度量，为进行严谨的医学研究奠定坚实的基础。让我们首先从这些指标的核心原理与机制开始。

## 原理与机制

在医学研究中，量化疾病在人群中的发生频率是流行病学和生物统计学的核心任务。本章旨在深入阐述衡量疾病频率的两个基本指标——**患病率 (prevalence)** 和 **发病率 (incidence)** 的核心原理与机制。我们将从基本定义出发，探讨它们的计算方法、适用场景、内在联系，并进一步延伸至更高级的概念，如风险集、人时、生存分析以及[竞争风险分析](@entry_id:634319)。

### 疾病频率的核心度量

从概念上讲，疾病频率的度量可分为两类：存量（stock）和流量（flow）。**患病率**是衡量特定时间点人群中疾病存量的指标，而**发病率**则是衡量一定时期内新发病例流量的指标。

#### 患病率：疾病负担的快照

**时点患病率 (point prevalence)**，通常简称为患病率，指的是在某一特定时间点，人群中患有某种疾病的个体所占的比例。它提供了一个关于疾病在人群中当前负担的“快照”。其计算公式为：

$$ P(t) = \frac{Y(t)}{N(t)} $$

其中，$Y(t)$ 是在时间点 $t$ 存在的病例数（包括新发和旧有病例），$N(t)$ 是在同一时间点的总人口数。作为一个比例，患病率是无单位的，其取值范围在 $0$ 到 $1$ 之间，常以百分比或每千人/万人的形式呈现。

例如，在一个社区队列研究中，如果在研究中期（$t=1$ 年）进行一次普查，发现 $980$ 名居民中有 $88$ 人患有某慢性病，那么该时点的患病率就是 $P(1) = \frac{88}{980} \approx 0.090$ 或 $9.0\%$ [@problem_id:4909270]。这里的分子 $Y(1)$ 包括了研究开始前就已患病并存活至今的个体，以及在研究开始后到 $t=1$ 年之间新发病的个体。

在分析患病率时，精确定义分子（病例）和分母（总人口）至关重要。例如，在使用电子健康记录（EHR）数据进行研究时，必须确保病例的诊断时间和普查时间点对齐。在 $t_0$ 时刻计算患病率，分子应为在 $t_0$ 或之前被确诊且在 $t_0$ 时仍然存活的病例数，而分母则为 $t_0$ 时刻登记在册的总人口数。任何在 $t_0$ 之后发生的诊断事件都不能计入 $t_0$ 时点的患病率分子中 [@problem_id:4972275]。

#### 发病率：新发病例的度量

与患病率不同，**发病率**关注的是从“无病”到“有病”这一转变过程，衡量新病例产生的速度或风险。发病率主要有两种表现形式：累积发病率和发病密度。

##### 累积发病率（风险）

**累积发病率 (cumulative incidence)**，也常被称为**风险 (risk)**，是指在一个特定时间段内，一群最初无该特定疾病的风险人群中新发病例所占的比例。它直接估计了该人群中一个个体在指定时期内患病的平均概率。其计算公式为：

$$ CI_{[t_0, t_1]} = \frac{\text{在 }[t_0, t_1]\text{ 时期内的新发病例数}}{\text{在 }t_0\text{ 时刻处于风险中的人口数}} $$

累积发病率是一个无单位的比例，其值介于 $0$ 和 $1$ 之间。至关重要的一点是，任何一个累积发病率的值都必须附带其所对应的时间区间才有意义。例如，“终生患癌风险为 $0.40$”与“未来五年内患癌风险为 $0.05$”传达了截然不同的信息。因此，报告累积发病率时必须明确指出时间跨度，如“5年累积发病率” [@problem_id:4546945]。

在一个对 $970$ 名基线无病个体进行为期 $2$ 年的随访研究中，如果观察到 $60$ 例新发病例，那么这 $2$ 年的累积发病率为 $CI_{[0, 2]} = \frac{60}{970} \approx 0.062$ [@problem_id:4909270]。

##### 发病率（发病密度）

**发病率 (incidence rate)**，也称为**发病密度 (incidence density)**，衡量的是新发病例在总风险人群时间单位内的发生速率。它适用于动态变化的群体，因为这些群体中个体的随访时间可能长短不一。其计算公式为：

$$ IR = \frac{\text{新发病例总数}}{\text{总风险人时 (total person-time at risk)}} $$

**人时 (person-time)** 是该队列中所有个体处于风险状态（即无病且被观察）的[时间总和](@entry_id:148146)。发病率的单位是时间的倒数（例如，每人年、每$1000$人月），它代表了一种事件发生的瞬时“强度”或“危险”，其取值可以从 $0$ 到无穷大，并不像概率那样被 $1$ 所限制。

在上述 $2$ 年的队列研究中，如果 $970$ 名个体总共贡献了 $1650$ 人年的风险时间，并且发生了 $60$ 例新发病例，那么发病率将是 $IR = \frac{60}{1650} \approx 0.036$ 每人年 [@problem_id:4909270]。这可以解释为，平均而言，每增加一年风险暴露时间，就有 $0.036$ 的概率发生新病例。

### 选择正确的度量：人[群结构](@entry_id:146855)与分母逻辑

选择使用累积发病率还是发病率，关键在于研究人群的结构以及我们如何定义分母。

#### 封闭队列与开放人群

**封闭队列 (closed cohort)** 指的是在一个特定时间点确定成员，之后没有新成员加入的队列。成员的退出仅因为发生研究终点事件、失访或研究结束。与此相对，**开放人群 (open population)** 或动态人群，其成员是持续变化的，不断有新成员加入，也有成员因各种原因退出 [@problem_id:4972258]。

对于在一个明确时间点建立、所有成员都无病且理论上将被完整随访一个固定时长的理想封闭队列，**累积发病率**是衡量风险的自然选择。其分母是研究开始时的风险人口总数。即使在随访过程中出现失访或因其他原因死亡（即删失），累积发病率定义中的分母仍然是基线风险人口数。处理这种不完整随访数据的正确方法是使用生存分析技术（如Kaplan-Meier方法），而不是随意更改分母的定义 [@problem_id:4972258]。

对于开放人群，或成员随访时间差异很大的封闭队列，**发病率**是更合适的度量。因为个体进入和退出的时间不同，简单地使用基线人口数作为分母会产生误导。此时，分母必须是**总风险人时**，它精确地加总了每个个体在研究期间实际贡献的风险暴露时间 [@problem_id:4972258]。

#### 人时风险的计算

精确计算人时是估计发病率的基础。每个个体的风险时间从其进入研究（并处于风险状态）开始计算，直到发生以下任一事件为止：
1.  **发生目标疾病**：风险时间在疾病发生的那一刻终止。
2.  **删失 (censoring)**：因失访、因竞争性风险（如其他原因死亡）退出或研究管理性结束而停止观察。风险时间在最后一次观察到的时刻终止。
3.  **延迟进入 (delayed entry / left truncation)**：对于在研究开始后才加入队列的个体，其风险时间从他们实际进入研究的时刻开始计算，而不是从研究的零点时刻开始。

例如，在一个为期 $24$ 个月的动态队列研究中，个体风险时间的计算方式如下 [@problem_id:4546927]：
-   个体1：$t=0$ 进入，在 $t=10$ 个月时发病。贡献人时 = $10 - 0 = 10$ 人月。
-   个体3：在 $t=6$ 个月时延迟进入，在 $t=22$ 个月时发病。贡献人时 = $22 - 6 = 16$ 人月。
-   个体4：$t=0$ 进入，随访至研究结束（$t=24$）仍无病。贡献人时 = $24 - 0 = 24$ 人月。
-   个体6：$t=0$ 进入，在 $t=5$ 个月时因无关原因死亡（竞争风险删失）。贡献人时 = $5 - 0 = 5$ 人月。

将所有个体贡献的人时相加，得到总人时，即可作为发病率计算的分母。

### 发病率、患病率与病程的相互作用

发病率和患病率并非孤立的概念，它们通过疾病的**病程 (duration)** 紧密联系在一起。这种动态关系可以通过一个经典的“浴缸模型”来直观理解 [@problem_id:4546941]。

#### 浴缸模型与[稳态](@entry_id:139253)关系

在这个模型中，浴缸里的水代表了人群中的**患病人数**（存量）。打开的水龙头代表**新发病例**（流入量），而浴缸的排水口则代表因**痊愈或死亡**而脱离患病状态的个体（流出量）。

当人群和疾病过程处于一个相对稳定的**[稳态](@entry_id:139253) (steady state)** 时，即流入速率（发病）约等于流出速率（痊愈/死亡），浴缸的水位（患病人数）将保持稳定。在这种理想条件下，患病率（$P$）、发病率（$I$）和平均病程（$D$）之间存在一个简洁的数学关系：

$$ P \approx I \times D $$

这个公式的成立需要几个关键假设 [@problem_id:4546941]：
1.  **[稳态](@entry_id:139253)**：发病率和病程在一段时期内大致恒定。
2.  **罕见病假设**：患病率较低（例如，小于 $0.10$）。这样，风险人群（总人口 - 患病人数）约等于总人口，使得以总人口为分母的发病率近似于以风险人群为分母的发病率。
3.  **人口稳定**：人群规模相对固定，没有大量的迁入或迁出，或者迁入/迁出的病例和非病例比例与本地人群相似。

#### 动态关系的应用与解读

这个公式揭示了患病率不仅取决于新病例的产生速度，还取决于病例在人群中“停留”的时间。这有助于我们理解一些看似矛盾的流行病学现象 [@problem_id:4546903]：

-   **低发病率，高患病率**：对于许多慢性病（如高血压、糖尿病），虽然每年新发病人数占总人口比例不高（低$I$），但由于病程极长，甚至终身（长$D$），患者会在人群中不断累积，导致在任何一个时间点上，患有该病的人数比例都相当高（高$P$）。例如，一种疾病的发病率为每$1000$人年$2$例，但一种新疗法将其平均生存期从$10$年延长至$15$年。在发病率不变的情况下，其患病率将从约 $2\%$ ($0.002 \times 10$) 上升至约 $3\%$ ($0.002 \times 15$)。

-   **高发病率，低患病率**：对于一些急性、自限性疾病（如普通感冒），或者通过筛查发现并能迅速治愈的疾病，虽然在一年内可能有很多人患病（高$I$），但由于病程极短（短$D$），每个患者很快就痊愈，因此在任何一个时间点随机抽查，人群中正在患病的人数比例会很低（低$P$）。例如，一个筛查项目使某疾病的检出率（发病率）高达每$1000$人年$30$例，但其平均治愈时间仅为$1$个月（$\frac{1}{12}$年），那么其时点患病率仅约为每$1000$人$2.5$例（$0.03 \times \frac{1}{12} = 0.0025$）。

因此，要全面评估疾病负担及其动态变化，必须同时考虑发病率和患病率，并理解病程在其中扮演的关键角色。仅有发病数据，无论是何种形式的风险度量，都不足以推断患病率 [@problem_id:4972250]。

### 发病率的数学形式化：[风险函数](@entry_id:166593)

为了在数学上更严谨地处理发病过程，尤其是在连续时间模型中，我们引入**[风险函数](@entry_id:166593) (hazard function)** 的概念。

风险函数 $h(t)$，或称瞬时发病率，定义为在时间点 $t$ 仍然无病的个体，在接下来一个极小时间瞬间内发病的瞬时速率。其数学定义为一个极限：

$$ h(t) \equiv \lim_{\Delta t \to 0} \frac{\Pr(t \le T  t+\Delta t \mid T \ge t)}{\Delta t} $$

其中，$T$是发病时间的随机变量。这个定义直观地解释了，对于一个足够小的时间间隔 $\Delta t$，在 $t$ 时刻仍然健康的个体在 $[t, t+\Delta t)$ 区间内发病的概率约等于 $h(t)\Delta t$ [@problem_id:4972263]。因此，如果在 $t$ 时刻有 $A(t)$ 个体处于风险中，那么在接下来的 $\Delta t$ 时间内，预期发生的新病例数约为 $A(t) \cdot h(t) \cdot \Delta t$。

风险函数是生存分析理论的基石。它与**生存函数 (survival function)** $S(t) = \Pr(T  t)$（即存活到时间 $t$ 之后的概率）密切相关。它们之间的关键关系是：

$$ h(t) = -\frac{S'(t)}{S(t)} = -\frac{d}{dt} \ln S(t) $$

这个公式表明，风险函数是负的对数生存函数的导数。它将事件发生的[瞬时速率](@entry_id:182981)与随时间变化的累积生存概率联系起来，为构建复杂的[统计模型](@entry_id:755400)（如[Cox比例风险模型](@entry_id:174252)）提供了理论基础 [@problem_id:4972263]。

### 高级主题：[竞争风险](@entry_id:173277)

在许多医学研究中，个体可能面临多种互斥的终点事件。例如，在研究心血管疾病死亡时，患者可能先因癌症死亡。癌症死亡就是一个**[竞争风险](@entry_id:173277) (competing risk)**，因为它排除了心血管死亡发生的可能性。

#### 标准方法的局限性

在存在[竞争风险](@entry_id:173277)的情况下，一种常见的错误做法是将竞争风险事件当作标准的**删失 (censoring)** 来处理，然后使用传统的Kaplan-Meier (KM) 方法来估计目标事件的累积发病率（通过 $1 - S_{KM}(t)$ 计算）。这种做法是错误的，因为它违反了KM方法的一个核心假设：删失必须是**非信息性的 (non-informative)**，即被删失的个体在删失之后的风险与未被删失的个体相同。

然而，一个因[竞争风险](@entry_id:173277)而退出的个体，其发生目标事件的未来风险为零，这显然与那些因失访或研究结束而被删失的个体不同。因此，竞争风险是一种**信息性删失**。错误地将其视为非信息性删失，会使得 $1 - \text{KM}$ 估计量系统性地**高估**目标事件的真实累积发病率，因为它错误地将本已不可能发生目标事件的个体保留在了风险计算的想象空间中 [@problem_id:4546910, @problem_id:4972250]。

#### 正确的方法：因果特定风险与累积发病函数

为了正确处理[竞争风险](@entry_id:173277)，我们需要区分两种不同的风险度量：

1.  **因果特定风险 (Cause-Specific Hazard, CSH)**：$\lambda_k(t)$ 是在 $t$ 时刻仍然未发生任何事件的个体，发生第 $k$ 类事件的瞬时速率。它衡量了特定病因的纯粹“生物学”或“病因学”上的作用力，是回答“病因是什么”这类问题的理想度量 [@problem_id:4972250]。

2.  **累积发病函数 (Cumulative Incidence Function, CIF)**：$F_k(t)$ 是在存在所有其他[竞争风险](@entry_id:173277)的情况下，到时间 $t$ 为止，发生第 $k$ 类事件的实际累积概率。这是回答“在现实世界中，发生某事件的概率有多大”这类预测性问题的[正确度](@entry_id:197374)量。

CIF与CSH之间的关系为：

$$ F_k(t) = \int_{0}^{t} \lambda_k(u) S(u) du $$

其中，$S(u)$ 是**总生存函数**，即到时间 $u$ 为止未发生任何类型事件的概率。这个公式清楚地表明，CIF不仅取决于目标事件的因果特定风险 $\lambda_k(u)$，还取决于由所有事件（包括竞争风险）共同决定的总生存概率 $S(u)$。这意味着，即使两个暴露组对目标疾病的因果特定风险完全相同，但如果他们发生竞争风险的风险不同，那么他们目标疾病的累积发病率（CIF）也会不同 [@problem_id:4546910, @problem_id:4972250]。

#### 建模策略：因果特定风险模型与子分布风险模型

在统计建模中，这两种度量对应着不同的模型策略：
-   **因果特定风险模型**：通常使用Cox比例风险模型分别对每种事件的CSH进行建模。这种方法非常适合探索特定暴露因素对疾病发生机制的直接影响。

-   **子分布风险模型 (Subdistribution Hazard Model)**：以Fine-Gray模型为代表，直接对CIF进行建模。它定义了一个名为**子分布风险 (subdistribution hazard)** 的量 $\gamma_k(t)$，其风险集非常特殊，包括了尚未发生任何事件的个体以及已经发生了[竞争风险](@entry_id:173277)的个体。这种模型的优势在于，其回归系数可以直接解释为协变量对CIF的影响，这在进行风险预测和制定公共卫生政策时尤为有用 [@problem_id:4972250]。

总之，理解患病率和发病率的原理与机制是进行严谨医学研究所必需的。从基本定义到人时计算，再到竞争风险的复杂性，每一个概念都要求研究者仔细思考其背后的假设和适用范围，以确保研究结果的准确性和有效性。