{"hands_on_practices": [{"introduction": "发病率是衡量疾病发生风险的核心指标。本练习将通过一个具体的前瞻性队列研究案例，让您亲手实践如何从原始的随访数据中计算发病率。更重要的是，您将学习如何使用泊松（Poisson）模型来量化点估计值的不确定性，即计算其精确置信区间，这是事件率分析中的一项基本功 [@problem_id:4547023]。", "problem": "一项预防医学的前瞻性队列研究招募了四名参与者，以基于风险人时量化作为发生率的疾病发生情况。每位参与者从进入队列开始接受随访，直至其首次事件发生或被删失为止，得到的随访时间分别为 $1.2$、$0.8$、$2.0$ 和 $0.5$ 年。在这些随访期间，共观察到 $3$ 例首次事件。假设首次事件的发生是一个与罕见事件的泊松模型相符的计数过程，并且发生率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发生率的点估计值，单位为“事件/人年”。\n- 计算 $95\\%$ 泊松精确置信区间（首次事件率，单位为“事件/人年”），该区间通过对观察人时内总事件数的泊松计数模型进行反演得到。\n\n报告您的最终数值结果，单位为“事件/人年”，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数字按 $(\\text{点估计值}, \\text{下限}, \\text{上限})$ 的顺序表示为单个行向量。最终答案中不应使用百分号；所有量均以小数表示。", "solution": "用户希望我解决以下问题：\n一项预防医学的前瞻性队列研究招募了四名参与者，以基于风险人时量化作为发生率的疾病发生情况。每位参与者从进入队列开始接受随访，直至其首次事件发生或被删失为止，得到的随访时间分别为 $1.2$、$0.8$、$2.0$ 和 $0.5$ 年。在这些随访期间，共观察到 $3$ 例首次事件。假设首次事件的发生是一个与罕见事件的泊松模型相符的计数过程，并且发生率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发生率的点估计值，单位为“事件/人年”。\n- 计算 $95\\%$ 泊松精确置信区间（首次事件率，单位为“事件/人年”），该区间通过对观察人时内总事件数的泊松计数模型进行反演得到。\n\n报告您的最终数值结果，单位为“事件/人年”，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数字按 $(\\text{点估计值}, \\text{下限}, \\text{上限})$ 的顺序表示为单个行向量。最终答案中不应使用百分号；所有量均以小数表示。\n\n### 步骤 1: 提取已知条件\n- 参与者数量：$4$\n- 个体随访时间：$1.2$ 年、$0.8$ 年、$2.0$ 年、$0.5$ 年。\n- 观察到的首次事件总数 $d$：$3$。\n- 统计模型：泊松过程。\n- 置信区间的置信水平：$95\\%$。\n- 要求舍入：四位有效数字。\n- 要求输出格式：一个行向量，包含（点估计值，下限，上限）。\n\n### 步骤 2: 使用提取的已知条件进行验证\n这个问题具有科学依据，提法恰当且客观。它描述了根据队列研究数据计算发生率及其置信区间的标准流行病学方法。在这种情况下，使用人时和泊松模型是标准做法。所有必要数据均已提供，且没有矛盾之处。该问题不违反任何无效性标准。\n\n### 步骤 3: 结论与操作\n该问题有效。将提供完整解答。\n\n### 解答\n\n该问题要求计算发生率的点估计值和一个 $95\\%$ 的精确置信区间。\n\n#### 第 1 部分: 发生率的点估计\n\n发生率，记为 $\\lambda$，定义为每单位风险人时内的新发事件数。点估计值 $\\hat{\\lambda}$ 的计算方法是：将观察到的事件总数 $d$ 除以总风险人时 $PT$。\n\n首先，我们通过对所有参与者的随访时间求和来计算总风险人时：\n$$\nPT = 1.2 \\text{ 年} + 0.8 \\text{ 年} + 2.0 \\text{ 年} + 0.5 \\text{ 年}\n$$\n$$\nPT = 4.5 \\text{ 人年}\n$$\n\n观察到的事件数给定为 $d = 3$。\n\n那么，发生率的点估计值为：\n$$\n\\hat{\\lambda} = \\frac{d}{PT} = \\frac{3}{4.5} = \\frac{2}{3} \\text{ 事件/人年}\n$$\n将其转换为小数，我们得到：\n$$\n\\hat{\\lambda} \\approx 0.666666... \\text{ 事件/人年}\n$$\n\n#### 第 2 部分: 发生率的 95% 精确置信区间\n\n问题指明事件数服从泊松分布。事件总数 $d=3$ 是来自均值为 $\\mu$ 的泊松分布的单个观测值。均值 $\\mu$ 通过方程 $\\mu = \\lambda \\times PT$ 与发生率 $\\lambda$ 和总人时 $PT$ 相关联。\n\n为了求出率 $\\lambda$ 的置信区间，我们首先计算均值计数 $\\mu$ 的置信区间，然后将其上下限除以 $PT$。\n\n给定观测计数 $d$，泊松均值 $\\mu$ 的精确置信区间基于泊松分布和卡方 ($\\chi^2$) 分布之间的关系。对于一个 $(1-\\alpha) \\times 100\\%$ 的置信区间，均值 $\\mu$ 的下限 $\\mu_L$ 和上限 $\\mu_U$ 由以下公式给出：\n$$\n\\mu_L = \\frac{1}{2} \\chi^2_{\\alpha/2, 2d}\n$$\n$$\n\\mu_U = \\frac{1}{2} \\chi^2_{1-\\alpha/2, 2(d+1)}\n$$\n其中 $\\chi^2_{p, \\nu}$ 是自由度为 $\\nu$、累积概率为 $p$ 的卡方分布的分位数。\n\n对于 $95\\%$ 的置信区间，$1-\\alpha = 0.95$，所以 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。\n观察到的事件数是 $d=3$。\n\n下限的自由度是 $2d = 2 \\times 3 = 6$。\n上限的自由度是 $2(d+1) = 2 \\times (3+1) = 8$。\n\n我们需要以下卡方分位数：\n- 对于下限：$\\chi^2_{\\alpha/2, 2d} = \\chi^2_{0.025, 6}$\n- 对于上限：$\\chi^2_{1-\\alpha/2, 2(d+1)} = \\chi^2_{0.975, 8}$\n\n使用统计表或软件，我们找到这些值：\n$$\n\\chi^2_{0.025, 6} \\approx 1.237344\n$$\n$$\n\\chi^2_{0.975, 8} \\approx 17.534546\n$$\n\n现在，我们可以计算均值计数 $\\mu$ 的置信限：\n$$\n\\mu_L = \\frac{1}{2} \\times 1.237344 = 0.618672\n$$\n$$\n\\mu_U = \\frac{1}{2} \\times 17.534546 = 8.767273\n$$\n这些是在 $4.5$ 人年内期望事件数的下限和上限。\n\n为了求出发生率 $\\lambda$ 的置信区间，我们将这些限值除以总人时 $PT = 4.5$ 人年。\n$$\n\\lambda_L = \\frac{\\mu_L}{PT} = \\frac{0.618672}{4.5} \\approx 0.1374827 \\text{ 事件/人年}\n$$\n$$\n\\lambda_U = \\frac{\\mu_U}{PT} = \\frac{8.767273}{4.5} \\approx 1.9482829 \\text{ 事件/人年}\n$$\n\n#### 第 3 部分: 最终结果与舍入\n\n问题要求将点估计值、下限和上限四舍五入至四位有效数字。\n\n- 点估计值： $\\hat{\\lambda} \\approx 0.666666... \\to 0.6667$\n- 置信下限： $\\lambda_L \\approx 0.1374827... \\to 0.1375$\n- 置信上限： $\\lambda_U \\approx 1.9482829... \\to 1.948$\n\n最终结果是有序三元组 $(\\hat{\\lambda}, \\lambda_L, \\lambda_U)$。\n这三个值为 $(0.6667, 0.1375, 1.948)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6667  0.1375  1.948\n\\end{pmatrix}\n}\n$$", "id": "4547023"}, {"introduction": "理解发病率和患病率之间的关系是流行病学研究的基石。本练习将引导您运用经典的稳态（steady-state）模型，从一阶原理出发，推导并计算在给定发病率和平均病程的情况下预期的患病率。通过这个理想化的情景，您将深刻理解患病率为何同时取决于新发病例的速率（发病率）和疾病持续的时间，这对于解读横断面数据和纵向数据至关重要 [@problem_id:4546920]。", "problem": "一个规模为 $N$ 的封闭稳定群体正在经历一种疾病，该疾病使个体在两种互斥状态之间转移：非病例和病例。在非病例中，新发病例按照恒定的发病率（发病密度）$\\lambda = 0.02$ 每人年发生，而病例状态的退出以恒定速率发生，使得在病例状态的平均停留时间为 $D = 5$ 年。假设处于稳态条件下，即群体规模和所有转移率随时间保持恒定，并且流入和流出病例状态的量平均达到平衡。仅使用发病率、患病率和平均病程的核心定义，结合两种状态之间的稳态流量平衡，从基本原理推导出在这些假设下预期时点患病率 $P$ 的表达式，然后进行数值计算。将最终的数值患病率表示为一个无单位的小数，并将您的答案四舍五入至四位有效数字。此外，请简要解释（无需计算），在此框架下，将退出过程解释为缓解与死亡，如何改变平均病程参数的含义，即使 $D$ 的数值相同。请仅提供计算出的患病率数值作为最终答案。", "solution": "该问题被评估为有效，因为它在科学上基于已确立的流行病学原理，问题设定良好、客观且内部一致。它代表了一个经典的稳态房室模型，对此存在一个唯一且有意义的解。\n\n设 $N$ 为封闭稳定群体的总规模。该群体分为两种互斥状态：病例，其群体规模为 $C$；以及非病例，其群体规模为 $S$。因此，在任何时候，我们都有以下关系：\n$$S + C = N$$\n时点患病率，记为 $P$，定义为在特定时间点人群中为病例的比例。在稳态条件的假设下，患病率是恒定的，并由下式给出：\n$$P = \\frac{C}{N}$$\n问题提供了发病率（也称为发病密度）$\\lambda$，即非病例成为新病例的速率。其值为 $\\lambda = 0.02$ 每人年。流入病例状态的总速率是这个人均速率与风险人群（非病例，$S$）数量的乘积：\n$$ \\text{Inflow rate} = \\lambda S $$\n问题还提供了在病例状态的平均停留时间，即疾病的平均病程，$D = 5$ 年。从病例状态退出的速率，我们记为 $\\gamma$，是平均病程的倒数：\n$$ \\gamma = \\frac{1}{D} $$\n从病例状态流出的总速率是这个人均退出速率与病例人数 $C$ 的乘积：\n$$ \\text{Outflow rate} = \\gamma C = \\frac{1}{D} C $$\n问题的核心假设是系统处于稳态，这意味着流入病例状态的量与流出该状态的量完全平衡：\n$$ \\text{Inflow rate} = \\text{Outflow rate} $$\n$$ \\lambda S = \\frac{C}{D} $$\n为了推导患病率 $P$ 的表达式，我们必须将此方程中的变量与 $N$ 联系起来。我们可以将非病例数 $S$ 表示为 $S = N - C$。将其代入稳态方程得到：\n$$ \\lambda (N - C) = \\frac{C}{D} $$\n目标是求出 $P = C/N$。我们可以重新整理方程以求解该比率。首先，我们将 $\\lambda$ 分配到左侧：\n$$ \\lambda N - \\lambda C = \\frac{C}{D} $$\n接下来，我们将所有包含 $C$ 的项聚集到方程的一侧：\n$$ \\lambda N = \\lambda C + \\frac{C}{D} $$\n从右侧提取因子 $C$ 得到：\n$$ \\lambda N = C \\left( \\lambda + \\frac{1}{D} \\right) $$\n为了得到患病率 $P = C/N$，我们将等式两边同时除以 $N$：\n$$ \\lambda = \\frac{C}{N} \\left( \\lambda + \\frac{1}{D} \\right) $$\n$$ \\lambda = P \\left( \\lambda + \\frac{1}{D} \\right) $$\n求解 $P$，我们得到：\n$$ P = \\frac{\\lambda}{\\lambda + \\frac{1}{D}} $$\n为了简化此表达式，我们可以将分子和分母同时乘以 $D$：\n$$ P = \\frac{\\lambda D}{D \\left( \\lambda + \\frac{1}{D} \\right)} = \\frac{\\lambda D}{\\lambda D + 1} $$\n这就是在稳态条件下从基本原理推导出的时点患病率的表达式。\n\n现在，我们将给定的数值 $\\lambda = 0.02 \\, \\text{year}^{-1}$ 和 $D = 5 \\, \\text{years}$ 代入此表达式。首先，我们计算无量纲的乘积 $\\lambda D$：\n$$ \\lambda D = 0.02 \\times 5 = 0.1 $$\n使用这个值，我们计算患病率 $P$：\n$$ P = \\frac{0.1}{1 + 0.1} = \\frac{0.1}{1.1} = \\frac{1}{11} $$\n问题要求答案为四舍五入至四位有效数字的小数。\n$$ P = \\frac{1}{11} \\approx 0.09090909... $$\n四舍五入至四位有效数字，我们得到 $P \\approx 0.09091$。\n\n关于平均病程参数 $D$ 的解释，其含义取决于从病例状态退出的性质。\n如果退出过程是缓解，离开病例状态的个体会返回到非病例（易感）状态。在这种情况下，$D$ 代表单次疾病发作在康复前的平均持续时间。\n如果退出过程是因病死亡，离开病例状态的个体会从群体中被永久移除。在这种情况下，$D$ 代表成为病例后的平均生存时间。它是衡量疾病致死性的一个指标。虽然基于流量平衡的患病率数值计算保持不变，但将 $D$ 解释为“病程”与“生存时间”的临床意义是根本不同的。", "answer": "$$\\boxed{0.09091}$$", "id": "4546920"}, {"introduction": "在真实的医学研究中，情况往往更为复杂，例如，研究对象可能因其他原因退出研究，从而无法观测到我们感兴趣的结局事件。本练习将带您进入竞争风险（competing risks）的世界，这是一种在生存分析中极为常见且重要的情况。您将学习如何正确计算特定原因的累积发病函数（CIF），并理解它为何不同于忽略竞争风险时的朴素估计，从而避免在风险评估中犯下常见而严重的错误 [@problem_id:4546988]。", "problem": "一个封闭的个体队列从基线开始被观察$3$年，以评估在存在竞争性失败类型（事件$2$）的情况下，某一特定疾病事件（称为事件$1$）的发生情况。假设特定原因风险函数（定义为在仍未发生任何事件的个体中，特定事件类型的瞬时发生率）随时间恒定：事件$1$的风险函数为$h_1(t)=0.04$每年，事件$2$的风险函数为$h_2(t)=0.02$每年。假设竞争风险框架适用，所有个体在基线时均未发生事件，不存在信息性删失，并且风险在整个$3$年期间保持不变。\n\n从以下基本定义出发：(i) 生存函数$S(t)$反映了直到时间$t$仍未发生任何事件的概率，以及(ii) 事件$1$在时间$t$的累积发生函数（CIF）是在存在竞争风险的情况下，到时间$t$为止因事件$1$而失败的累积概率，请仅使用这些定义和所述假设，推导出事件$1$的$3$年CIF的表达式。然后，计算其数值，并将其与$1-\\exp(-0.04\\times 3)$这一数值进行比较，后者是将事件$1$视为唯一失败类型（忽略竞争风险）时得到的结果。\n\n请以小数形式给出事件$1$的$3$年CIF与$1-\\exp(-0.04\\times 3)$之间的绝对差值。将最终答案四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题经评估有效。其科学基础在于生存分析和竞争风险的原理，问题阐述清晰，信息充分且一致，陈述客观。\n\n问题要求使用基本定义，在存在竞争风险（事件$2$）的情况下，推导事件$1$的$3$年累积发生函数（CIF）。我们已知事件$1$和事件$2$的特定原因风险函数是恒定的。\n\n设$h_1(t)$为事件$1$的特定原因风险，$h_2(t)$为事件$2$的特定原因风险。已知它们不随时间变化：\n$h_1(t) = h_1 = 0.04$ 每年\n$h_2(t) = h_2 = 0.02$ 每年\n\n观察期为 $T = 3$ 年。\n\n首先，我们处理总生存函数$S(t)$，它被定义为到时间$t$为止未发生*任何*事件的概率。在竞争风险框架中，发生任何事件的总风险$h_{total}(t)$是各特定原因风险之和，假设事件是相互排斥的。\n$$h_{total}(t) = h_1(t) + h_2(t)$$\n由于$h_1$和$h_2$是常数，$h_{total}$也是常数：\n$$h_{total} = h_1 + h_2 = 0.04 + 0.02 = 0.06 \\text{ 每年}$$\n生存函数$S(t)$与累积总风险$H_{total}(t) = \\int_0^t h_{total}(u) du$相关，其关系式为$S(t) = \\exp(-H_{total}(t))$。\n对于恒定的总风险，累积风险为$H_{total}(t) = h_{total} \\cdot t$。\n因此，生存函数为：\n$$S(t) = \\exp(-h_{total} \\cdot t) = \\exp(-(h_1+h_2)t)$$\n\n接下来，我们推导事件$1$的累积发生函数，记作$CIF_1(t)$。问题将其定义为在存在竞争风险的情况下，到时间$t$为止因事件$1$而失败的累积概率。这可以形式化为在时间区间$[0, t]$上对特定事件概率密度函数的积分。在特定时间$u$因事件$1$而失败的概率密度，是事件$1$在该时间$u$的特定原因风险$h_1(u)$与存活至该时间且未发生任何事件的概率$S(u)$的乘积。\n因此，CIF由以下积分给出：\n$$CIF_1(t) = \\int_0^t h_1(u) S(u) du$$\n代入$h_1(u)$（即常数$h_1$）和$S(u)$的表达式：\n$$CIF_1(t) = \\int_0^t h_1 \\exp(-(h_1+h_2)u) du$$\n由于$h_1$是常数，可以将其移到积分符号外：\n$$CIF_1(t) = h_1 \\int_0^t \\exp(-(h_1+h_2)u) du$$\n我们进行积分计算：\n$$CIF_1(t) = h_1 \\left[ -\\frac{1}{h_1+h_2} \\exp(-(h_1+h_2)u) \\right]_0^t$$\n计算积分在上下限处的值：\n$$CIF_1(t) = h_1 \\left( \\left( -\\frac{1}{h_1+h_2} \\exp(-(h_1+h_2)t) \\right) - \\left( -\\frac{1}{h_1+h_2} \\exp(0) \\right) \\right)$$\n$$CIF_1(t) = h_1 \\left( \\frac{1}{h_1+h_2} - \\frac{1}{h_1+h_2} \\exp(-(h_1+h_2)t) \\right)$$\n提取公因式，得到恒定特定原因风险下CIF的通用公式：\n$$CIF_1(t) = \\frac{h_1}{h_1+h_2} \\left( 1 - \\exp(-(h_1+h_2)t) \\right)$$\n现在，我们通过令$t=T=3$年，计算事件$1$的$3$年CIF的数值：\n$$CIF_1(3) = \\frac{0.04}{0.04+0.02} \\left( 1 - \\exp(-(0.04+0.02) \\times 3) \\right)$$\n$$CIF_1(3) = \\frac{0.04}{0.06} \\left( 1 - \\exp(-0.06 \\times 3) \\right)$$\n$$CIF_1(3) = \\frac{2}{3} \\left( 1 - \\exp(-0.18) \\right)$$\n数值上，$\\exp(-0.18) \\approx 0.83527021$。\n$$CIF_1(3) \\approx \\frac{2}{3} (1 - 0.83527021) = \\frac{2}{3} (0.16472979) \\approx 0.10981986$$\n\n问题要求将此值与忽略竞争风险时计算出的量$Q = 1 - \\exp(-0.04 \\times 3)$进行比较。这相当于计算当事件$1$是唯一可能发生的事件时的累积发生率。\n$$Q = 1 - \\exp(-h_1 T) = 1 - \\exp(-0.12)$$\n数值上，$\\exp(-0.12) \\approx 0.88692044$。\n$$Q \\approx 1 - 0.88692044 = 0.11307956$$\n\n最后，我们计算真实的$CIF_1(3)$与朴素估计值$Q$之间的绝对差值：\n$$\\text{差值} = |CIF_1(3) - Q|$$\n$$\\text{差值} = |0.10981986 - 0.11307956| = |-0.00325970| = 0.00325970$$\n问题要求将答案四舍五入到四位有效数字。第一位有效数字是$3$。四位有效数字是$3$、$2$、$5$、$9$。$9$后面的数字是$7$，即$\\ge 5$，所以我们向上进位。将$9$向上进位得到$0$并产生一个进位，所以$3259$变为$3260$。\n四舍五入后的差值为$0.003260$。尾随的零是有效数字。\n数量$Q$高估了真实风险，因为它未能考虑到因竞争事件（事件$2$）而从风险池中移除的个体，这些个体因此不再有资格经历事件$1$。", "answer": "$$\\boxed{0.003260}$$", "id": "4546988"}]}