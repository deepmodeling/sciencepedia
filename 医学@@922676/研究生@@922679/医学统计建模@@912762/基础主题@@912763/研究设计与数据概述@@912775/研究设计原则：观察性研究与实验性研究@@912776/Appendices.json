{"hands_on_practices": [{"introduction": "转向观察性研究，队列研究是评估暴露与疾病关系的重要工具，尤其是在处理随时间变化的事件时。在此类研究中，发病率比（Incidence Rate Ratio, $IRR$）是一个关键的效应量度，它通过比较不同暴露组的单位人时发病率来量化风险。这项实践[@problem_id:4980097]将指导你如何从人时数据中计算和解释这一基本的流行病学指标。", "problem": "一项心血管流行病学的前瞻性队列研究随访了两组成年人，以比较在常规临床护理下突发事件的发生率。暴露组由基线时有高炎症生物标志物记录的患者组成，而非暴露组则由没有该生物标志物的患者组成。在随访期间，暴露组贡献了 $3{,}000$ 人年，发生了 $90$ 例新发事件；非暴露组贡献了 $5{,}000$ 人年，发生了 $100$ 例新发事件。假设在每个暴露组内，事件的生成机制可以被建模为一个在观察随访期内具有恒定强度（率）的计数过程，并且事件计数可以通过泊松分布（其均值等于基础率与累积人时之积）得到很好的近似。\n\n从组内发生率的基本定义（即每单位人时的预期新发事件数）出发，并将发生率比（IRR）定义为暴露组发生率与非暴露组发生率之比，推导出基于各组观察到的事件计数和人时的IRR估计量。然后，使用上述研究数据，计算IRR的值，并在所述假设下，从业已发生的相对瞬时事件的角度简要解释其临床意义。\n\n提供IRR的最终数值，为一个无单位的单一数字。提供精确值，不要四舍五入。", "solution": "该问题要求从第一性原理出发，推导发生率比（IRR）的估计量，并使用所提供的研究数据进行计算。\n\n首先，必须对问题进行验证。\n\n**步骤1：提取已知条件**\n- 暴露组的随访人年（$T_1$）：$3,000$ 人年\n- 暴露组的新发事件（$E_1$）：$90$\n- 非暴露组的随访人年（$T_0$）：$5,000$ 人年\n- 非暴露组的新发事件（$E_0$）：$100$\n- 建模假设：在每个组内，事件生成是一个具有恒定强度（率）的计数过程。\n- 分布假设：事件计数（$E_i$）近似服从泊松分布，其均值等于率（$\\lambda_i$）与人时（$T_i$）的乘积。因此，$E_i \\sim \\text{Poisson}(\\lambda_i T_i)$。\n- 发生率（$\\lambda$）的定义：每单位人时的预期新发事件数。\n- 发生率比（IRR）的定义：暴露组发生率与非暴露组发生率之比，$IRR = \\frac{\\lambda_1}{\\lambda_0}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及流行病学和生物统计学中的标准概念，如队列研究、发生率、人时以及用于计数数据的泊松模型。在特定条件下，恒定率和泊松分布的假设对于为此类事件建模是常见且适当的。该问题提法明确，为获得唯一解提供了所有必要的定义和数据。语言客观、精确。因此，该问题被认为是有效的。\n\n**IRR估计量的推导**\n设 $\\lambda_1$ 为暴露组中真实的、未知的恒定发生率，$\\lambda_0$ 为非暴露组中真实的、未知的恒定发生率。这些率的单位是事件/人年。\n\n根据问题的定义，发生率是每单位人时的预期事件数。对于暴露组（组 $1$），即为：\n$$ \\lambda_1 = \\frac{\\mathbb{E}[E_1]}{T_1} $$\n同样地，对于非暴露组（组 $0$）：\n$$ \\lambda_0 = \\frac{\\mathbb{E}[E_0]}{T_0} $$\n问题指出，每组的事件数服从泊松分布。设 $E_1$ 为暴露组在 $T_1$ 人年内的观察事件数，$E_0$ 为非暴露组在 $T_0$ 人年内的观察事件数。事件计数的模型为：\n$$ E_1 \\sim \\text{Poisson}(\\mu_1) \\quad \\text{其中} \\quad \\mu_1 = \\lambda_1 T_1 $$\n$$ E_0 \\sim \\text{Poisson}(\\mu_0) \\quad \\text{其中} \\quad \\mu_0 = \\lambda_0 T_0 $$\n服从泊松分布的随机变量的期望值是其率参数，所以 $\\mathbb{E}[E_1] = \\mu_1 = \\lambda_1 T_1$ 且 $\\mathbb{E}[E_0] = \\mu_0 = \\lambda_0 T_0$，这与发生率的初始定义是一致的。\n\n为了估计真实率 $\\lambda_1$ 和 $\\lambda_0$，我们使用观察数据。泊松分布率参数的最大似然估计量（也是矩估计量）是观察到的计数。因此，$\\mu_1$ 的估计量是 $\\hat{\\mu}_1 = E_1$。由于 $\\mu_1 = \\lambda_1 T_1$，我们可以推导出率 $\\lambda_1$ 的估计量，记为 $\\hat{\\lambda}_1$：\n$$ \\hat{\\lambda}_1 = \\frac{E_1}{T_1} $$\n这个经验率是真实基础率 $\\lambda_1$ 的最佳估计量。同样，对于非暴露组：\n$$ \\hat{\\lambda}_0 = \\frac{E_0}{T_0} $$\n发生率比（IRR）定义为真实率之比：\n$$ IRR = \\frac{\\lambda_1}{\\lambda_0} $$\n为了估计IRR，我们使用替换原则（也称为置入原则），用估计量替换真实参数。因此，IRR的估计量，记为 $\\widehat{IRR}$，是估计率之比：\n$$ \\widehat{IRR} = \\frac{\\hat{\\lambda}_1}{\\hat{\\lambda}_0} = \\frac{E_1 / T_1}{E_0 / T_0} $$\n这就是所要求的推导出的估计量。\n\n**IRR的计算与解释**\n使用问题陈述中提供的数据：\n- $E_1 = 90$ 个事件\n- $T_1 = 3,000$ 人年\n- $E_0 = 100$ 个事件\n- $T_0 = 5,000$ 人年\n\n首先，我们计算每个组的估计发生率：\n$$ \\hat{\\lambda}_1 = \\frac{90}{3,000} = 0.03 \\text{ 事件/人年} $$\n$$ \\hat{\\lambda}_0 = \\frac{100}{5,000} = 0.02 \\text{ 事件/人年} $$\n现在，我们使用推导出的公式计算估计的IRR：\n$$ \\widehat{IRR} = \\frac{\\hat{\\lambda}_1}{\\hat{\\lambda}_0} = \\frac{0.03}{0.02} = \\frac{3/100}{2/100} = \\frac{3}{2} = 1.5 $$\n或者，使用直接公式：\n$$ \\widehat{IRR} = \\frac{E_1 / T_1}{E_0 / T_0} = \\frac{90 / 3,000}{100 / 5,000} = \\frac{90}{3,000} \\cdot \\frac{5,000}{100} = \\frac{9}{300} \\cdot \\frac{50}{1} = \\frac{450}{300} = 1.5 $$\n\n**临床解释**\n计算出的发生率比是 $1.5$。这个值代表暴露组与非暴露组的发生率之比。数值 $1.5$ 表明，有高炎症生物标志物组的突发事件发生率是没有该生物标志物组的 $1.5$ 倍。在恒定率的假设下，这意味着在随访期间的任何时间点，具有高炎症生物标志物的个体经历该事件的瞬时风险（风险率）比没有该生物标志物的个体高 $50\\%$。这表明该生物标志物与事件风险之间存在具有临床意义的关联。", "answer": "$$\\boxed{1.5}$$", "id": "4980097"}, {"introduction": "病例对照研究，特别是匹配设计，为研究罕见病和控制混杂因素提供了一种高效的方法。这种设计的分析是独特的，它依赖于一种条件逻辑斯蒂回归方法，通过关注不一致对（discordant pairs）来估计比值比（Odds Ratio, $OR$）。这项练习[@problem_id:4980052]让你亲身体验这种强大的分析技术，并理解为何只有不一致对才对效应估计有贡献。", "problem": "一项基于医院的研究采用 $1{:}1$ 配对病例对照设计，研究了二元暴露 $X \\in \\{0,1\\}$（例如，近期使用某种特定药物的指标）与一种罕见疾病 $Y \\in \\{0,1\\}$ 之间的关联。为了控制混杂因素，配对根据年龄、性别和医院单位进行，每个配对层（对）中恰好包含一个病例（$Y=1$）和一个对照（$Y=0$）。假设有 $M$ 个配对，索引为 $j=1,\\dots,M$。在每对 $j$ 中，分别用 $X_{j1}$ 和 $X_{j0}$ 表示病例和对照的暴露指标。\n\n假设配对采用标准的条件逻辑斯谛回归模型，该模型具有特定于配对的截距，即\n$$\n\\Pr(Y_{ji}=1 \\mid X_{ji}, \\alpha_j) = \\frac{\\exp(\\alpha_j + \\beta X_{ji})}{1 + \\exp(\\alpha_j + \\beta X_{ji})}\n$$\n对于 $i \\in \\{0,1\\}$，其中 $\\alpha_j$ 捕捉了特定于配对的基线风险，$\\beta$ 是暴露 $X$ 对疾病 $Y$ 影响的对数优势比参数。在此设定下，并以观察到的配对结构（每对中恰好一个病例和一个对照）为条件，一个配对对条件似然的贡献仅取决于其暴露情况是否为不一致（$X_{j1} \\neq X_{j0}$）或一致（$X_{j1} = X_{j0}$）。\n\n一项配对病例对照研究共纳入了 $M=200$ 对。其中，$60$ 对为不一致对，其暴露情况为 $(X_{j1}=1, X_{j0}=0)$；$40$ 对为不一致对，其暴露情况为 $(X_{j1}=0, X_{j0}=1)$。其余配对的暴露情况均为一致。基于上述模型所蕴含的条件似然以及优势和优势比的基本定义，推导出优势比 $\\exp(\\beta)$ 的条件最大似然估计量（用不一致对的数量表示），然后使用所提供的数据计算其值。请将最终答案表示为单个实数，无需四舍五入。", "solution": "用户希望解决一个基于配对病例对照研究的问题。解决方案必须遵循指定的格式规则。\n\n### 问题验证\n\n**第 1 步：提取已知信息**\n-   **研究设计：** $1{:}1$ 配对病例对照研究。\n-   **配对数量：** $M = 200$。\n-   **配对结构：** 每对 $j$ 有一个病例（$Y=1$）和一个对照（$Y=0$）。\n-   **暴露：** 二元变量 $X \\in \\{0, 1\\}$。\n-   **符号：** 对于配对 $j$，$X_{j1}$ 是病例的暴露情况，$X_{j0}$ 是对照的暴露情况。\n-   **模型：** 配对 $j$ 中个体 $i$ 成为病例的概率由条件逻辑斯谛回归模型给出：\n    $$ \\Pr(Y_{ji}=1 \\mid X_{ji}, \\alpha_j) = \\frac{\\exp(\\alpha_j + \\beta X_{ji})}{1 + \\exp(\\alpha_j + \\beta X_{ji})} $$\n    其中 $\\alpha_j$ 是特定于配对的截距，$\\beta$ 是对数优势比。\n-   **数据：**\n    -   病例暴露而对照未暴露的不一致配对数量（$X_{j1}=1, X_{j0}=0$）为 $60$。记此数为 $n_{10}$。\n    -   病例未暴露而对照暴露的不一致配对数量（$X_{j1}=0, X_{j0}=1$）为 $40$。记此数为 $n_{01}$。\n    -   剩下的 $200 - 60 - 40 = 100$ 对是一致对（$X_{j1} = X_{j0}$）。\n\n**第 2 步：使用提取的已知信息进行验证**\n-   **科学依据：** 该问题描述了使用条件逻辑斯谛回归对配对病例对照研究进行的标准分析。这是流行病学和生物统计学中一个基本且被广泛接受的方法。模型以及通过条件似然消除滋扰参数（$\\alpha_j$）的方法都是教科书中的概念。该问题在科学和数学上是合理的。\n-   **良定性：** 该问题是良定的。它要求推导一个特定的估计量（优势比的条件最大似然估计量）并根据所提供的数据进行数值计算。存在唯一、稳定且有意义的解。\n-   **客观性：** 该问题使用精确、客观、形式化的数学语言陈述。\n-   **完整性与一致性：** 提供了所有必要的信息（模型、数据、感兴趣的参数）。数据内部一致。\n-   **现实性：** 该情景是对医学研究的真实再现。\n\n**第 3 步：结论与行动**\n-   **结论：** 问题是**有效的**。\n-   **行动：** 进入解决阶段。\n\n### 解决方案\n\n该问题要求推导在 $1{:}1$ 配对病例对照研究中优势比 $\\exp(\\beta)$ 的条件最大似然估计量（MLE），并进行后续计算。\n\n首先，我们确认 $\\beta$ 是对数优势比。在给定暴露 $X$ 和层 $j$ 的情况下，患病的优势为：\n$$ \\text{Odds}(Y=1 \\mid X, \\alpha_j) = \\frac{\\Pr(Y=1 \\mid X, \\alpha_j)}{1 - \\Pr(Y=1 \\mid X, \\alpha_j)} = \\exp(\\alpha_j + \\beta X) $$\n在同一层内，比较暴露者（$X=1$）与非暴露者（$X=0$）的优势比（OR）为：\n$$ OR = \\frac{\\text{Odds}(Y=1 \\mid X=1, \\alpha_j)}{\\text{Odds}(Y=1 \\mid X=0, \\alpha_j)} = \\frac{\\exp(\\alpha_j + \\beta \\cdot 1)}{\\exp(\\alpha_j + \\beta \\cdot 0)} = \\frac{\\exp(\\alpha_j)\\exp(\\beta)}{\\exp(\\alpha_j)} = \\exp(\\beta) $$\n因此，$\\beta = \\ln(OR)$ 是对数优势比。\n\n分析配对数据的关键是构建一个能消除特定于层的滋扰参数 $\\alpha_j$ 的条件似然。对于每对 $j$，我们以该配对中恰好有一个病例和一个对照，以及观察到该配对中两个个体的暴露情况为条件。设一对中的两个个体泛称为 $A$ 和 $B$，其暴露情况分别为 $X_A$ 和 $X_B$。个体 $A$ 是病例而 $B$ 是对照的概率与 $\\exp(\\alpha_j + \\beta X_A)$ 成正比。$B$ 是病例而 $A$ 是对照的概率与 $\\exp(\\alpha_j + \\beta X_B)$ 成正比。\n\n在给定一对中一个是病例、一个是对照，且他们的暴露情况为 $X_A$ 和 $X_B$ 的条件下，暴露情况为 $X_A$ 的个体是病例的条件概率为：\n$$ \\Pr(\\text{暴露为 } X_A \\text{ 的个体是病例} \\mid \\text{配对 } j \\text{ 的数据}) = \\frac{\\exp(\\alpha_j + \\beta X_A)}{\\exp(\\alpha_j + \\beta X_A) + \\exp(\\alpha_j + \\beta X_B)} $$\n通过提取因子 $\\exp(\\alpha_j)$，滋扰参数被消除了：\n$$ \\frac{\\exp(\\alpha_j) \\exp(\\beta X_A)}{\\exp(\\alpha_j) (\\exp(\\beta X_A) + \\exp(\\beta X_B))} = \\frac{\\exp(\\beta X_A)}{\\exp(\\beta X_A) + \\exp(\\beta X_B)} $$\n在问题的符号体系中，对于每对 $j$，我们观察到暴露情况为 $X_{j1}$ 的个体是病例，暴露情况为 $X_{j0}$ 的个体是对照。因此，配对 $j$ 对条件似然的贡献是：\n$$ L_j(\\beta) = \\frac{\\exp(\\beta X_{j1})}{\\exp(\\beta X_{j1}) + \\exp(\\beta X_{j0})} $$\n总条件似然 $L(\\beta)$ 是所有 $M$ 对贡献的乘积：\n$$ L(\\beta) = \\prod_{j=1}^{M} L_j(\\beta) = \\prod_{j=1}^{M} \\frac{\\exp(\\beta X_{j1})}{\\exp(\\beta X_{j1}) + \\exp(\\beta X_{j0})} $$\n我们根据配对内暴露情况的一致性或不一致性来分析这些贡献。\n\n1.  **一致对：** 指病例和对照具有相同暴露状态的配对，即 $X_{j1} = X_{j0}$。\n    -   如果 $X_{j1} = X_{j0} = 1$：$L_j(\\beta) = \\frac{\\exp(\\beta \\cdot 1)}{\\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 1)} = \\frac{\\exp(\\beta)}{2\\exp(\\beta)} = \\frac{1}{2}$。\n    -   如果 $X_{j1} = X_{j0} = 0$：$L_j(\\beta) = \\frac{\\exp(\\beta \\cdot 0)}{\\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 0)} = \\frac{1}{1+1} = \\frac{1}{2}$。\n    在这两种情况下，似然贡献都是常数 $\\frac{1}{2}$，不包含 $\\beta$。因此，一致对不提供用于估计 $\\beta$ 的信息。\n\n2.  **不一致对：** 指病例和对照具有不同暴露状态的配对，即 $X_{j1} \\neq X_{j0}$。\n    -   病例暴露，对照未暴露（$X_{j1}=1, X_{j0}=0$）：假设有 $n_{10}$ 个这样的配对。每个此类配对的贡献是：\n        $$ L_j(\\beta) = \\frac{\\exp(\\beta \\cdot 1)}{\\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 0)} = \\frac{\\exp(\\beta)}{1 + \\exp(\\beta)} $$\n    -   病例未暴露，对照暴露（$X_{j1}=0, X_{j0}=1$）：假设有 $n_{01}$ 个这样的配对。每个此类配对的贡献是：\n        $$ L_j(\\beta) = \\frac{\\exp(\\beta \\cdot 0)}{\\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 1)} = \\frac{1}{1 + \\exp(\\beta)} $$\n\n忽略来自一致对的常数项，总条件似然函数仅为不一致对贡献的乘积：\n$$ L(\\beta) = \\left( \\frac{\\exp(\\beta)}{1 + \\exp(\\beta)} \\right)^{n_{10}} \\left( \\frac{1}{1 + \\exp(\\beta)} \\right)^{n_{01}} $$\n为求 MLE，我们处理对数似然 $\\ell(\\beta) = \\ln(L(\\beta))$：\n$$ \\ell(\\beta) = n_{10} \\ln\\left(\\frac{\\exp(\\beta)}{1 + \\exp(\\beta)}\\right) + n_{01} \\ln\\left(\\frac{1}{1 + \\exp(\\beta)}\\right) $$\n$$ \\ell(\\beta) = n_{10} (\\ln(\\exp(\\beta)) - \\ln(1 + \\exp(\\beta))) - n_{01} \\ln(1 + \\exp(\\beta)) $$\n$$ \\ell(\\beta) = n_{10}\\beta - (n_{10} + n_{01}) \\ln(1 + \\exp(\\beta)) $$\n现在，我们将 $\\ell(\\beta)$ 对 $\\beta$ 求导，并令导数为零以找到 MLE $\\hat{\\beta}$。\n$$ \\frac{d\\ell}{d\\beta} = n_{10} - (n_{10} + n_{01}) \\frac{\\exp(\\beta)}{1 + \\exp(\\beta)} $$\n令导数为零：\n$$ n_{10} - (n_{10} + n_{01}) \\frac{\\exp(\\hat{\\beta})}{1 + \\exp(\\hat{\\beta})} = 0 $$\n$$ n_{10} = (n_{10} + n_{01}) \\frac{\\exp(\\hat{\\beta})}{1 + \\exp(\\hat{\\beta})} $$\n$$ n_{10} (1 + \\exp(\\hat{\\beta})) = (n_{10} + n_{01}) \\exp(\\hat{\\beta}) $$\n$$ n_{10} + n_{10} \\exp(\\hat{\\beta}) = n_{10} \\exp(\\hat{\\beta}) + n_{01} \\exp(\\hat{\\beta}) $$\n$$ n_{10} = n_{01} \\exp(\\hat{\\beta}) $$\n求解 $\\exp(\\hat{\\beta})$，即优势比（OR）的 MLE，我们得到：\n$$ \\exp(\\hat{\\beta}) = \\frac{n_{10}}{n_{01}} $$\n这是推导出的优势比的条件最大似然估计量。它是病例暴露的不一致对数量与对照暴露的不一致对数量之比。\n\n问题提供的数据如下：\n-   病例暴露而对照未暴露的配对数量：$n_{10} = 60$。\n-   病例未暴露而对照暴露的配对数量：$n_{01} = 40$。\n总配对数 $M=200$ 和一致对的数量对于此估计不是必需的。\n\n将给定值代入估计量：\n$$ \\widehat{OR} = \\exp(\\hat{\\beta}) = \\frac{60}{40} = \\frac{3}{2} = 1.5 $$\n优势比的条件最大似然估计为 $1.5$。", "answer": "$$\\boxed{1.5}$$", "id": "4980052"}]}