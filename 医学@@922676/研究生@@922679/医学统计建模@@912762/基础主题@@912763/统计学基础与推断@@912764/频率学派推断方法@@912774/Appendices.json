{"hands_on_practices": [{"introduction": "在频率派推断中，点估计是为未知参数寻找最佳单一猜测值的第一步。最大似然估计（Maximum Likelihood Estimation, MLE）是实现这一目标的核心原则。此练习 [@problem_id:4988042] 不仅仅是应用一个公式，它将引导您从似然函数出发，从头推导出估计量，并进一步通过计算费雪信息（Fisher information）和渐近方差，将估计量与其不确定性联系起来，这是构建置信区间和进行假设检验的关键一步。", "problem": "一项单臂药物警戒研究监测了 $n$ 名接受新疗法的独立患者中某一特定不良事件的发生情况。设 $X$ 表示经历该事件的患者数量，将 $X$ 建模为二项式随机变量 $X \\sim \\mathrm{Bin}(n,p)$，其中 $p$ 是单位患者的事件概率。您观测到计数 $x \\in \\{0,1,\\dots,n\\}$。在频率学派的推断方法下，从二项式概率质量函数和最大似然估计量（MLE）的定义出发，执行以下操作：\n\n1. 推导 $p$ 的最大似然估计量（MLE）$\\hat{p}$。\n2. 从基于观测计数 $x$ 的 $p$ 的对数似然函数出发，计算 $p$ 的观测费雪信息。利用它来获得在 $\\hat{p}$ 处评估的 $\\hat{p}$ 的渐近方差的闭合形式表达式，该表达式仅用 $x$ 和 $n$ 表示。\n\n请用 $x$ 和 $n$ 的单个解析表达式给出最终答案。无需四舍五入。最终表达式中不要包含任何单位。", "solution": "所述问题是有效的。这是一个在频率学派统计推断中定义明确的问题，其基础是二项式模型的最大似然估计和费雪信息的基本原理，这是医学统计学中的一个标准应用。所有必要信息均已提供，问题本身是自洽且科学合理的。\n\n$n$ 名患者中不良事件数 $X$ 的模型是二项分布，$X \\sim \\mathrm{Bin}(n, p)$，其中 $p$ 是未知的单位患者事件概率。我们得到一个观测计数 $x$。\n\n$X=x$ 的概率质量函数（PMF）为：\n$$\nP(X=x | n, p) = \\binom{n}{x} p^x (1-p)^{n-x}\n$$\n当将此函数视为固定观测值 $x$ 下参数 $p$ 的函数时，它就是似然函数 $L(p|x)$。\n\n**第1部分：$p$ 的最大似然估计量（MLE）的推导**\n\n为了找到最大似然估计量，我们首先定义对数似然函数 $\\ell(p|x)$，即似然函数的自然对数。最大化对数似然函数等同于最大化似然函数。\n$$\n\\ell(p|x) = \\ln[L(p|x)] = \\ln\\left[\\binom{n}{x} p^x (1-p)^{n-x}\\right]\n$$\n利用对数的性质，我们可以写出：\n$$\n\\ell(p|x) = \\ln\\binom{n}{x} + x\\ln(p) + (n-x)\\ln(1-p)\n$$\n为了找到使该函数最大化的 $p$ 值，我们对 $p$ 求一阶导数（得分函数）并令其为零。\n$$\n\\frac{d\\ell}{dp} = \\frac{d}{dp}\\left[ \\ln\\binom{n}{x} + x\\ln(p) + (n-x)\\ln(1-p) \\right] = \\frac{x}{p} - \\frac{n-x}{1-p}\n$$\n将导数设为零可得方程：\n$$\n\\frac{x}{p} = \\frac{n-x}{1-p}\n$$\n求解 $p$：\n$$\nx(1-p) = p(n-x)\n$$\n$$\nx - xp = np - xp\n$$\n$$\nx = np\n$$\n$p$ 的解即为最大似然估计量，记作 $\\hat{p}$：\n$$\n\\hat{p} = \\frac{x}{n}\n$$\n为了确认该点是一个最大值点，我们可以检查对数似然函数的二阶导数：\n$$\n\\frac{d^2\\ell}{dp^2} = -\\frac{x}{p^2} - \\frac{n-x}{(1-p)^2}\n$$\n对于 $p \\in (0, 1)$ 和观测到的 $x \\in \\{1, \\dots, n-1\\}$，该二阶导数始终为负，这证实了 $\\hat{p}$ 确实是一个最大值。该公式对于边界情况 $x=0$ 和 $x=n$ 也成立。\n\n**第2部分：$\\hat{p}$ 的渐近方差**\n\n问题要求计算观测费雪信息，其定义为对数似然函数二阶导数的负值：\n$$\nI_O(p) = -\\frac{d^2\\ell}{dp^2} = -\\left(-\\frac{x}{p^2} - \\frac{n-x}{(1-p)^2}\\right) = \\frac{x}{p^2} + \\frac{n-x}{(1-p)^2}\n$$\n最大似然估计量的渐近方差可以通过在最大似然估计量 $\\hat{p}$ 处评估的观测费雪信息的倒数来估计。因此，我们将 $p = \\hat{p} = \\frac{x}{n}$ 代入 $I_O(p)$ 的表达式中。此步骤严格适用于 $x \\in \\{1, \\dots, n-1\\}$，以避免除以零。\n$$\nI_O(\\hat{p}) = \\frac{x}{(\\frac{x}{n})^2} + \\frac{n-x}{(1-\\frac{x}{n})^2}\n$$\n简化表达式：\n$$\nI_O(\\hat{p}) = \\frac{x}{x^2/n^2} + \\frac{n-x}{((n-x)/n)^2} = \\frac{xn^2}{x^2} + \\frac{(n-x)n^2}{(n-x)^2}\n$$\n$$\nI_O(\\hat{p}) = \\frac{n^2}{x} + \\frac{n^2}{n-x}\n$$\n为了合并这些项，我们找到一个公分母：\n$$\nI_O(\\hat{p}) = n^2 \\left( \\frac{1}{x} + \\frac{1}{n-x} \\right) = n^2 \\left( \\frac{n-x+x}{x(n-x)} \\right) = \\frac{n^3}{x(n-x)}\n$$\n$\\hat{p}$ 的估计渐近方差，记为 $\\widehat{\\mathrm{Var}(\\hat{p})}$，是在 $\\hat{p}$ 处评估的观测费雪信息的倒数：\n$$\n\\widehat{\\mathrm{Var}(\\hat{p})} = [I_O(\\hat{p})]^{-1} = \\left( \\frac{n^3}{x(n-x)} \\right)^{-1}\n$$\n$$\n\\widehat{\\mathrm{Var}(\\hat{p})} = \\frac{x(n-x)}{n^3}\n$$\n这就是在 $\\hat{p}$ 处评估的 $\\hat{p}$ 的渐近方差所要求的闭合形式表达式，用 $x$ 和 $n$ 表示。尽管推导的中间步骤要求 $x$ 严格介于 $0$ 和 $n$ 之间，但这个最终表达式对于 $x=0$ 和 $x=n$ 也是良定义的，此时它正确地评估为 $0$。", "answer": "$$\n\\boxed{\\frac{x(n-x)}{n^3}}\n$$", "id": "4988042"}, {"introduction": "在获得点估计后，下一步自然是量化其不确定性，而置信区间（Confidence Interval, CI）为此提供了一个参数的合理取值范围。在实际研究中，总体方差通常是未知的。此练习 [@problem_id:4988052] 专注于如何在这种更贴近现实的场景下，通过构建一个基于 $t$ 分布的关键变量（pivotal quantity），来推导出一个精确的置信区间。掌握这一推导过程，将使您深刻理解统计学中最广泛应用的工具之一背后的逻辑。", "problem": "一个临床药理学团队正在评估一个开始接受高强度他汀类药物治疗的患者队列中，低密度脂蛋白胆固醇的平均变化。为了建立一个简单而科学上现实的模型，假设患者层面的低密度脂蛋白胆固醇变化（治疗后减去治疗前），记为 $X_{i}$，是独立同分布的正态随机变量，其均值 $\\mu$ 和方差 $\\sigma^{2}$ 未知。样本量为 $n$，样本均值为 $\\bar{X}$，无偏样本方差为 $S^{2} = \\frac{1}{n-1}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}$。使用频率学派范式，将 $\\mu$ 和 $\\sigma^{2}$ 视为固定但未知的参数，并构建一个在所述模型下具有精确覆盖率的区间估计量。\n\n仅从基本定义和正态模型经过充分检验的分布事实（例如，已知方差下标准化均值的标准正态分布、缩放的无偏样本方差的卡方分布，以及正态性下样本均值和样本方差的独立性）出发，完成以下任务：\n\n1. 定义当 $\\sigma^{2}$ 未知时 $\\mu$ 的一个枢轴量，并证明其分布不依赖于任何未知参数。\n2. 使用该枢轴量推导 $\\mu$ 的双侧 $(1-\\alpha)$ 置信区间(CI)，并用 $\\bar{X}$、$S$、$n$ 以及一个完全指定的参考分布的相应分位数明确表示。\n3. 在一项对 $n=23$ 名患者进行的前瞻性研究中，观察到的汇总统计量为 $\\bar{X}=-32.5$ 和 $S=12.0$，其中低密度脂蛋白胆固醇变化的单位为 $\\mathrm{mg/dL}$。使用你在第2部分中得到的精确置信区间，并取 $\\alpha=0.05$，计算数值端点。将你的两个端点四舍五入到四位有效数字。两个端点均以 $\\mathrm{mg/dL}$ 为单位表示。", "solution": "该问题要求推导并在后续应用一个频率学派置信区间，用于估计当总体方差 $\\sigma^{2}$ 未知时正态分布的总体均值 $\\mu$。解决方案将通过以下步骤构建：首先确定一个合适的枢轴量，然后推导置信区间的一般形式，最后根据给定数据计算数值区间。\n\n1.  枢轴量的定义与证明\n\n构建此置信区间的基础是一个枢轴量，它是样本数据和未知参数的函数，其概率分布不依赖于任何未知参数。\n\n我们已知患者层面的变化 $X_{i}$ 是独立同分布的正态随机变量，$X_{i} \\sim N(\\mu, \\sigma^{2})$。基于此，我们使用以下基本分布事实：\n- 样本均值 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_{i}$ 服从均值为 $\\mu$、方差为 $\\frac{\\sigma^{2}}{n}$ 的正态分布。将 $\\bar{X}$ 标准化可得到一个标准正态随机变量，$Z = \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}} \\sim N(0, 1)$。\n- 缩放的无偏样本方差，其中 $S^{2} = \\frac{1}{n-1}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}$，服从卡方分布：$\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi_{n-1}^{2}$。\n- 对于从正态分布中抽取的样本，样本均值 $\\bar{X}$ 和样本方差 $S^{2}$ 是统计独立的。\n\n标准化均值 $Z$ 不是一个枢轴量，因为它的公式包含未知参数 $\\sigma$。为了创建一个枢轴量，我们必须用一个估计量来代替 $\\sigma$。$\\sigma$ 的自然估计量是样本标准差 $S$。\n\n我们将一个服从学生t分布的随机变量定义为一个标准正态随机变量与一个独立的、除以其自由度的卡方随机变量的平方根之比。设 $Z \\sim N(0, 1)$，$V \\sim \\chi_{k}^{2}$，且 $Z$ 和 $V$ 相互独立。那么随机变量 $T = \\frac{Z}{\\sqrt{V/k}}$ 服从自由度为 $k$ 的学生t分布，记为 $t_{k}$。\n\n在我们的情况下，我们设置：\n- $Z = \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}$\n- $V = \\frac{(n-1)S^{2}}{\\sigma^{2}}$\n- $k = n-1$\n\n由于 $\\bar{X}$ 和 $S^{2}$ 的独立性，$Z$ 和 $V$ 是独立的。我们现在可以构建枢轴量 $T$：\n$$T = \\frac{Z}{\\sqrt{V/k}} = \\frac{\\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}}{\\sqrt{\\frac{(n-1)S^{2}/\\sigma^{2}}{n-1}}}$$\n简化分母得：\n$$\\sqrt{\\frac{S^{2}}{\\sigma^{2}}} = \\frac{S}{\\sigma} \\quad (\\text{因为 } S  0)$$\n将此代回 $T$ 的表达式中：\n$$T = \\frac{\\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}}{\\frac{S}{\\sigma}} = \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}} \\cdot \\frac{\\sigma}{S} = \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}}$$\n这个量 $T$ 服从自由度为 $n-1$ 的学生t分布，$T \\sim t_{n-1}$。它的分布仅依赖于已知的样本量 $n$，而不依赖于未知参数 $\\mu$ 或 $\\sigma^{2}$。因此，$T = \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}}$ 是 $\\mu$ 的一个枢轴量。\n\n2.  $\\mu$ 的 $(1-\\alpha)$ 置信区间的推导\n\n利用枢轴量 $T \\sim t_{n-1}$，我们可以构建一个概率陈述，作为置信区间的基础。对于双侧置信水平 $1-\\alpha$，我们寻找界定 $t_{n-1}$ 分布中心 $1-\\alpha$ 部分的数值。设 $t_{n-1, \\alpha/2}$ 表示来自 $t_{n-1}$ 分布的临界值，使得上尾面积为 $\\alpha/2$；即 $P(T  t_{n-1, \\alpha/2}) = \\alpha/2$。由于t分布关于 $0$ 对称，我们也有 $P(T  -t_{n-1, \\alpha/2}) = \\alpha/2$。\n\n因此，中心概率为：\n$$P(-t_{n-1, \\alpha/2} \\le T \\le t_{n-1, \\alpha/2}) = 1 - \\alpha$$\n代入枢轴量 $T$ 的表达式：\n$$P\\left(-t_{n-1, \\alpha/2} \\le \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}} \\le t_{n-1, \\alpha/2}\\right) = 1 - \\alpha$$\n为了推导 $\\mu$ 的置信区间，我们在不等式中心代数地分离出 $\\mu$：\n$$-t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}} \\le \\bar{X} - \\mu \\le t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}}$$\n从所有部分减去 $\\bar{X}$：\n$$-\\bar{X} -t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}} \\le - \\mu \\le -\\bar{X} + t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}}$$\n将所有部分乘以 $-1$ 并反转不等式的方向：\n$$\\bar{X} + t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}} \\ge \\mu \\ge \\bar{X} - t_{n-1, \\alpha/2} \\cdot \\frac{S}{\\sqrt{n}}$$\n这就得到了 $\\mu$ 的双侧 $(1-\\alpha)$ 置信区间：\n$$\\left[ \\bar{X} - t_{n-1, \\alpha/2} \\frac{S}{\\sqrt{n}}, \\quad \\bar{X} + t_{n-1, \\alpha/2} \\frac{S}{\\sqrt{n}} \\right]$$\n\n3.  数值计算\n\n问题提供了以下汇总统计量和参数：\n- 样本量: $n=23$\n- 样本均值: $\\bar{X}=-32.5$\n- 样本标准差: $S=12.0$\n- 显著性水平: $\\alpha=0.05$\n\nt分布的自由度为 $df = n-1 = 23-1 = 22$。\n所需的置信水平为 $1-\\alpha = 1-0.05 = 0.95$。\n我们需要临界值 $t_{df, \\alpha/2} = t_{22, 0.025}$。从标准统计表或计算软件中，可以查得该值约等于 $2.0739$。\n\n均值的标准误(SE)为：\n$$SE = \\frac{S}{\\sqrt{n}} = \\frac{12.0}{\\sqrt{23}}$$\n误差范围(ME)是临界值与标准误的乘积：\n$$ME = t_{22, 0.025} \\cdot SE = 2.0739 \\cdot \\frac{12.0}{\\sqrt{23}} \\approx 2.0739 \\cdot \\frac{12.0}{4.79583} \\approx 2.0739 \\cdot 2.50216 \\approx 5.1893$$\n置信区间计算为 $\\bar{X} \\pm ME$：\n- 下端点: $L = \\bar{X} - ME = -32.5 - 5.1893 = -37.6893$\n- 上端点: $U = \\bar{X} + ME = -32.5 + 5.1893 = -27.3107$\n\n问题要求将端点四舍五入到四位有效数字。\n- 四舍五入后的下端点: $-37.69$\n- 四舍五入后的上端点: $-27.31$\n\n低密度脂蛋白胆固醇平均变化的 $95\\%$ 置信区间约为 $(-37.69, -27.31) \\ \\mathrm{mg/dL}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -37.69  -27.31 \\end{pmatrix}\n}\n$$", "id": "4988052"}, {"introduction": "前面的练习依赖于特定的分布假设，例如正态性。然而，当这些假设不成立时我们该怎么办？自助法（Bootstrap）是一种功能强大的计算密集型方法，它对底层数据分布的假设较少。这个动手编程练习 [@problem_id:4988031] 将频率派理论带入现代计算时代，通过实现百分位置信区间，您将获得评估复杂或非标准情况下不确定性的实用技能，这对于任何现代医学统计学家都是至关重要的能力。", "problem": "考虑一项医学研究，其中测量了以纳克/毫升 (ng/mL) 为单位的连续生物标志物浓度。在频率派框架中，参数被定义为真实数据生成分布的一个泛函。设 $X$ 表示生物标志物的测量值，设 $F$ 表示目标临床人群中 $X$ 的未知分布，设待估量为总体均值 $\\theta = \\mathbb{E}_F[X]$。你观察到来自 $F$ 的 $n$ 个独立同分布 (IID) 的实现 $\\{x_1,\\dots,x_n\\}$，并使用样本均值 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^n x_i$ 作为 $\\theta$ 的估计量。由于 $F$ 未知，$\\bar{X}$ 的抽样分布也是未知的。\n\n定义非参数自助法：用经验分布 $\\hat{F}_n$ 替代 $F$，该经验分布在每个观测值 $x_i$ 处赋予 $1/n$ 的概率质量，并通过从 $\\{x_1,\\dots,x_n\\}$ 中进行有放回的重复抽样并在每个重抽样样本上重新计算估计量，来近似估计量的抽样分布。描述如何利用 $\\bar{X}$ 的自助法抽样分布的经验分位数来获得 $\\theta$ 的百分位数置信区间。\n\n你的任务是实现一个程序，在给定观测的生物标志物数据、自助法重复次数 $B$ 和置信水平 $(1-\\alpha)$（其中 $\\alpha$ 以小数形式指定）的情况下，通过对观测数据进行有放回的重抽样，计算生物标志物平均水平 $\\theta$ 的非参数自助法百分位数置信区间。对于下方的每个测试用例，通过从观测值中有放回地抽样来生成 $B$ 个大小为 $n$ 的自助样本，为每个重抽样样本计算自助样本均值，并返回分别由 $\\alpha/2$ 和 $1 - \\alpha/2$ 水平上的经验分位数给出的下限和上限。所有生物标志物浓度和置信区间端点均以 ng/mL 表示，四舍五入到三位小数。使用提供的随机种子以确保可复现性。\n\n测试套件（每个测试用例是一个 $(\\text{data}, B, \\alpha, \\text{seed})$ 的元组）：\n- 用例 $1$：数据 $[2.1, 3.4, 3.0, 2.7, 4.2, 5.1, 3.8, 2.9, 3.2, 4.0]$，$B = 5000$，$\\alpha = 0.05$，种子 $= 11$。\n- 用例 $2$：数据 $[2.4, 2.5, 2.6, 2.7, 2.8]$，$B = 10000$，$\\alpha = 0.10$，种子 $= 123$。\n- 用例 $3$：数据 $[3.0, 3.0, 3.0, 3.0, 3.0]$，$B = 3000$，$\\alpha = 0.05$，种子 $= 7$。\n- 用例 $4$：数据 $[2.0, 2.1, 2.2, 2.3, 10.0, 2.4, 2.5]$，$B = 15000$，$\\alpha = 0.05$，种子 $= 2023$。\n\n覆盖率设计原理：\n- 用例 $1$ 测试一个具有中等变异性的典型中等样本。\n- 用例 $2$ 改变 $\\alpha$ 以测试不同的置信水平，并使用小样本量。\n- 用例 $3$ 是一个所有观测值都相同的退化情况，用于测试自助法分布为点质量的边界条件。\n- 用例 $4$ 包含一个显著的异常值，以评估百分位数区间在偏度和重尾分布下的稳健性。\n\n最终输出格式规范：\n你的程序应生成单行输出，其中包含所有测试用例的置信区间列表，格式为一个由逗号分隔的双元素列表（每个区间为 $[\\text{lower}, \\text{upper}]$）组成的列表，并用方括号括起来。例如，输出应类似于 $[[l_1,u_1],[l_2,u_2],[l_3,u_3],[l_4,u_4]]$，所有数值条目均四舍五入到三位小数。输出中不要打印单位；将所有数值解释为 ng/mL。", "solution": "问题陈述经评估有效。它在科学上基于非参数自助法这一既定理论，这是频率派统计学中的一项基本技术。问题提法恰当，提供了所有必要的输入——数据、参数和随机种子——以确保结果的唯一性和可复现性。问题是客观的，使用了精确且无歧义的统计术语。\n\n目标是计算连续生物标志物总体均值 $\\theta = \\mathbb{E}_F[X]$ 的 $(1-\\alpha)$ 非参数自助法百分位数置信区间。我们给定一个来自未知真实分布 $F$ 的 $n$ 个独立同分布 (IID) 观测值集合 $\\{x_1, \\dots, x_n\\}$。\n\n自助法的核心原理是通过从观测数据中重抽样来近似估计量的抽样分布。真实分布 $F$ 是未知的，因此我们使用其最佳可用估计，即经验分布函数 $\\hat{F}_n$。分布 $\\hat{F}_n$ 是一个离散分布，它为每个观测数据点 $x_i, i = 1, \\dots, n$ 分配 $1/n$ 的概率质量。\n\n构建自助法百分位数置信区间的步骤如下：\n\n1.  **自助法重抽样 (Bootstrap Resampling)**：我们生成大量（$B$ 个）“自助样本”。每个自助样本，表示为 $\\{x_1^*, \\dots, x_n^*\\}$，是通过从原始数据集 $\\{x_1, \\dots, x_n\\}$ 中有放回地抽取 $n$ 个观测值来创建的。这个过程等价于从经验分布 $\\hat{F}_n$ 中抽取一个大小为 $n$ 的独立同分布样本。\n\n2.  **估计量的自助法复制 (Bootstrap Replicates of the Estimator)**：对于 $B$ 个自助样本中的每一个，我们都计算感兴趣的统计量。在本例中，该统计量是样本均值。设第 $b$ 个自助样本为 $\\{x_{b,1}^*, \\dots, x_{b,n}^*\\}$，其中 $b=1, \\dots, B$。对应的样本均值的自助法复制为：\n    $$\n    \\bar{X}_b^* = \\frac{1}{n} \\sum_{i=1}^n x_{b,i}^*\n    $$\n    这个过程产生了一个包含 $B$ 个自助均值的集合 $\\{\\bar{X}_1^*, \\bar{X}_2^*, \\dots, \\bar{X}_B^*\\}$。这个集合可作为样本均值估计量 $\\bar{X}$ 的抽样分布的一个经验近似。\n\n3.  **百分位数置信区间构建 (Percentile Confidence Interval Construction)**：百分位数法直接利用自助法复制的经验分布的分位数来构建置信区间。对于 $(1-\\alpha)$ 的置信水平，置信区间由已排序的自助均值的 $\\alpha/2$ 和 $1 - \\alpha/2$ 分位数定义。设 $\\bar{X}_{(j)}^*$ 表示自助均值集合中第 $j$ 个有序值。$\\theta$ 的 $(1-\\alpha)$ 百分位数置信区间由下式给出：\n    $$\n    \\left[ \\text{Quantile}_{\\bar{X}^*}\\left(\\frac{\\alpha}{2}\\right), \\text{Quantile}_{\\bar{X}^*}\\left(1 - \\frac{\\alpha}{2}\\right) \\right]\n    $$\n    在实践中，为了从 $B$ 个已排序的复制中找到这些分位数，我们找到与所需概率对应的秩次上的值。例如，下限是大约在秩次 $(\\alpha/2) \\times B$ 上的值，而上限是大约在秩次 $(1 - \\alpha/2) \\times B$ 上的值。标准的统计软件使用插值方法为有限的 $B$ 提供更准确的分位数估计。\n\n实现将对每个测试用例遵循此算法。每个用例都将使用指定的种子初始化一个单独的随机数生成器，以确保可复现性。为提高效率，计算将进行向量化处理。对于每个用例，我们将从数据中生成 $B \\times n$ 个随机选择，以形成 $B$ 个大小为 $n$ 的样本。然后我们计算这 $B$ 个样本中每个样本的均值。最后，我们确定这个均值分布的下分位数和上分位数，以形成置信区间，并按要求将端点四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nonparametric bootstrap percentile confidence intervals for the mean\n    for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (data, B, alpha, seed).\n    test_cases = [\n        ([2.1, 3.4, 3.0, 2.7, 4.2, 5.1, 3.8, 2.9, 3.2, 4.0], 5000, 0.05, 11),\n        ([2.4, 2.5, 2.6, 2.7, 2.8], 10000, 0.10, 123),\n        ([3.0, 3.0, 3.0, 3.0, 3.0], 3000, 0.05, 7),\n        ([2.0, 2.1, 2.2, 2.3, 10.0, 2.4, 2.5], 15000, 0.05, 2023)\n    ]\n\n    results = []\n    for data, B, alpha, seed in test_cases:\n        # Convert data to a numpy array for efficient computation.\n        data_array = np.array(data)\n        n = len(data_array)\n\n        # Initialize a random number generator with the specified seed for reproducibility.\n        rng = np.random.default_rng(seed)\n\n        # Generate B bootstrap samples of size n.\n        # This creates a (B, n) array where each row is a bootstrap sample.\n        bootstrap_samples = rng.choice(data_array, size=(B, n), replace=True)\n\n        # Compute the mean for each of the B bootstrap samples along the appropriate axis.\n        bootstrap_means = np.mean(bootstrap_samples, axis=1)\n\n        # Determine the quantile levels for the confidence interval.\n        q_lower = alpha / 2\n        q_upper = 1 - alpha / 2\n\n        # Calculate the lower and upper bounds of the confidence interval\n        # using the empirical quantiles of the bootstrap means.\n        ci_lower = np.quantile(bootstrap_means, q_lower)\n        ci_upper = np.quantile(bootstrap_means, q_upper)\n\n        # Round the endpoints to three decimal places as required.\n        interval = [round(ci_lower, 3), round(ci_upper, 3)]\n        results.append(interval)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is converted to a string\n    # and spaces are removed to match the specified output format '[[l1,u1],[l2,u2],...]'.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```", "id": "4988031"}]}