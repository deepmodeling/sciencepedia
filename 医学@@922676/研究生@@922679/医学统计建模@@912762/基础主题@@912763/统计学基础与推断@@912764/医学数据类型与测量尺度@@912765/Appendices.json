{"hands_on_practices": [{"introduction": "在医学研究中，许多结局指标（如疼痛或满意度）都是通过定序标尺（例如利克特量表）来测量的。虽然计算平均分可能很诱人，但这种做法在统计学上是不可靠的。本练习将通过探索变换不变性的概念，亲手证明为什么中位数是定序数据的恰当汇总统计量，而平均数则不然。[@problem_id:4993155]", "problem": "一项临床试验收集了患者报告结局（PRO）的疼痛评分，该评分采用一个5级有序利克特量表，其类别由整数 $1, 2, 3, 4, 5$ 标记。假设观测到的各类别计数为$n_{1}=22$，$n_{2}=19$，$n_{3}=40$，$n_{4}=13$，$n_{5}=6$。在医学数据的统计建模中，对于定序测量尺度，容许的统计量必须在类别标签的严格递增变换下保持不变，因为在此类尺度上只有相对顺序是有意义的。从定序尺度的这个基本定义以及样本均值和中位数的标准定义出发，完成以下任务：\n\n1. 从基本原理出发，解释为什么严格递增变换会保持观测值的顺序，因此必须使任何基于顺序的统计量（如中位数）在类别选择上保持不变。\n\n2. 设$f(k)=k^2$是定义在$\\{1,2,3,4,5\\}$上的一个严格递增变换。计算原始编码数据的样本均值和变换后数据的样本均值。使用这些计算结果，在不引用预先陈述的结论的情况下，证明均值在严格递增变换下不是不变的，因此对于定序数据是不可容许的。\n\n3. 确定应用变换$f$前后的中位数类别，并证明中位数类别在$f$变换下为何保持不变。\n\n作为最终答案，报告由变换$f$引起的均值变化的数值，以精确分数形式表示。不要包含单位，也不要进行四舍五入。", "solution": "该问题陈述是基础统计理论中的一个有效练习，特别是关于测量理论在医学数据中的应用。它具有科学依据，提法明确且客观。我们将提供一个完整的解答。\n\n临床试验中的患者总数是每个类别计数之和：\n$$N = n_{1} + n_{2} + n_{3} + n_{4} + n_{5} = 22 + 19 + 40 + 13 + 6 = 100$$\n\n**1. 基于顺序的统计量（如中位数）的不变性**\n\n定序尺度意味着数据可以被排序或定序，但类别之间差异的大小没有意义。整数标签$\\{1, 2, 3, 4, 5\\}$代表一种顺序，即报告“2”的患者比报告“1”的患者疼痛程度更高，比报告“3”的患者疼痛程度更低，但我们不能声称“1”和“2”之间的疼痛差异与“2”和“3”之间的疼痛差异相同。\n\n对定序数据而言，一个容许的变换是任何严格递增函数$f$。根据定义，如果对于其定义域中的任意两个值$a$和$b$，$a  b$蕴含$f(a)  f(b)$，则函数$f$是严格递增的。\n\n设$N$个观测值的完整集合表示为$\\{x_1, x_2, \\dots, x_N\\}$，其中每个$x_i$是一个类别标签。我们将这些观测值排序以得到有序集合$x_{(1)} \\le x_{(2)} \\le \\dots \\le x_{(N)}$。\n现在，我们对每个观测值应用一个严格递增变换$f$，创建一个新的变换后观测值集合$\\{f(x_1), f(x_2), \\dots, f(x_N)\\}$。\n如果我们从排序列表中考虑任意两个原始观测值$x_{(i)}$和$x_{(j)}$，使得$i  j$，那么必有$x_{(i)} \\le x_{(j)}$。\n如果$x_{(i)}  x_{(j)}$，严格递增函数$f$的性质保证了$f(x_{(i)})  f(x_{(j)})$。\n如果$x_{(i)} = x_{(j)}$，那么$f(x_{(i)}) = f(x_{(j)})$。\n综合来看，$x_{(i)} \\le x_{(j)}$蕴含$f(x_{(i)}) \\le f(x_{(j)})$。这意味着变换$f$保持了整个数据集的秩次排序。变换后观测值的排序列表就是$f(x_{(1)}) \\le f(x_{(2)}) \\le \\dots \\le f(x_{(N)})$。\n\n基于顺序的统计量是任何仅依赖于数据秩次排序的统计量。中位数是其典型例子。一个大小为$N$的数据集的中位数由排序列表中间位置上的观测值所决定。由于变换$f$不会改变排序列表中任何观测值的位置，位于中位数位置的观测值保持不变。虽然其数值从$x_{(\\text{median-pos})}$变换为$f(x_{(\\text{median-pos})})$，但观测值本身，以及其原始类别，是不变的。因此，中位数*类别*是定序数据的一个容许统计量。\n\n**2. 均值的非不变性**\n\n原始数据的样本均值，记为$\\bar{x}$，计算方法为所有观测值之和除以观测总数。使用给定的计数：\n$$\\bar{x} = \\frac{1}{N} \\sum_{k=1}^{5} n_{k} \\cdot k = \\frac{1}{100} (n_{1} \\cdot 1 + n_{2} \\cdot 2 + n_{3} \\cdot 3 + n_{4} \\cdot 4 + n_{5} \\cdot 5)$$\n$$\\bar{x} = \\frac{1}{100} (22 \\cdot 1 + 19 \\cdot 2 + 40 \\cdot 3 + 13 \\cdot 4 + 6 \\cdot 5)$$\n$$\\bar{x} = \\frac{1}{100} (22 + 38 + 120 + 52 + 30) = \\frac{262}{100} = 2.62$$\n问题定义了一个在定义域$\\{1, 2, 3, 4, 5\\}$上的严格递增变换$f(k) = k^{2}$。新的类别标签为$f(1)=1$，$f(2)=4$，$f(3)=9$，$f(4)=16$和$f(5)=25$。\n变换后数据的样本均值，记为$\\bar{y}$，为：\n$$\\bar{y} = \\frac{1}{N} \\sum_{k=1}^{5} n_{k} \\cdot f(k) = \\frac{1}{100} \\sum_{k=1}^{5} n_{k} \\cdot k^{2}$$\n$$\\bar{y} = \\frac{1}{100} (22 \\cdot 1^{2} + 19 \\cdot 2^{2} + 40 \\cdot 3^{2} + 13 \\cdot 4^{2} + 6 \\cdot 5^{2})$$\n$$\\bar{y} = \\frac{1}{100} (22 \\cdot 1 + 19 \\cdot 4 + 40 \\cdot 9 + 13 \\cdot 16 + 6 \\cdot 25)$$\n$$\\bar{y} = \\frac{1}{100} (22 + 76 + 360 + 208 + 150) = \\frac{816}{100} = 8.16$$\n我们观察到$\\bar{y} \\ne \\bar{x}$。此外，将该变换应用于原始均值将得到$f(\\bar{x}) = f(2.62) = (2.62)^{2} = 6.8644$，这不等于$\\bar{y}$。在此严格递增变换下，均值不是不变的。这是因为均值的计算将类别标签当作是在等距尺度上，即数值之间的距离是有意义的。变换$f(k)=k^2$是非线性的，并且不成比例地改变了这些距离，从而改变了均值。这证明了均值不是定序数据的容许统计量。\n\n**3. 中位数类别的不变性**\n\n观测总数为$N=100$，是一个偶数。中位数位于排序后数据集中的第50个和第51个观测值之间。我们通过检查累积计数来找到这些位置所属的类别：\n- 类别1：包括第1至第22个观测值。\n- 类别2：包括第23至第$22+19=41$个观测值。\n- 类别3：包括第42至第$41+40=81$个观测值。\n- 类别4：包括第82至第$81+13=94$个观测值。\n- 类别5：包括第95至第$94+6=100$个观测值。\n\n第50个和第51个观测值都落在类别3的范围内。因此，原始数据的中位数类别是$3$。\n\n现在考虑应用变换$f(k)=k^2$后的数据。正如在第1部分所确立的，严格递增变换保持所有观测值的秩次排序。前22个观测值现在标记为$1$，接下来的19个标记为$4$，再接下来的40个标记为$9$，以此类推。在原始排序列表中排第50位的观测值，在变换后的排序列表中仍然排在第50位。排第51位的观测值也仍然排在第51位。累积计数在结构上保持相同。位于第50和第51位置的观测值仍然属于第三组观测值。该组的原始类别是$3$。因此，变换后数据的中位数类别也对应于原始类别$3$。中位数的数值现在是$f(3) = 3^2 = 9$。然而，*中位数类别*（有序序列中的第三个类别）保持不变，这证明了其不变性。\n\n由变换$f$引起的均值变化是新均值与原始均值之差：\n$$\\Delta \\bar{x} = \\bar{y} - \\bar{x} = \\frac{816}{100} - \\frac{262}{100} = \\frac{554}{100}$$\n化简为一个精确分数：\n$$\\frac{554 \\div 2}{100 \\div 2} = \\frac{277}{50}$$\n分子$277$是一个质数，所以这是最简形式。", "answer": "$$\\boxed{\\frac{277}{50}}$$", "id": "4993155"}, {"introduction": "在理解了定序标尺的基本属性后，本练习将探讨当一个或两个变量不是定距标尺时，如何衡量它们之间的关联。我们将看到，当处理定序数据或非线性关系时，基于排序的相关性（如Spearman的 $\\rho$ 和Kendall的 $\\tau$）对于非线性单调变换具有稳健性，这与Pearson相关性相比是一个关键优势。此练习在双变量分析的背景下，展示了标尺不变性原理。[@problem_id:4993177]", "problem": "一个临床研究团队为 $n=6$ 名患者的疾病严重程度进行编码，使用的是一个有序量表 $X \\in \\{1,2,3,4,5,6\\}$，其中较大的 $X$ 值表示严格更差的严重程度。一种实验室生物标志物 $Y$ 在一个比率量表上（浓度，单位任意）进行测量，已知在该队列中，$Y$ 随严重程度单调增加，其规律是 $X$ 每增加一个单位，$Y$ 的值就翻倍。具体来说，观测到的数据是 $i \\in \\{1,2,3,4,5,6\\}$ 的数据对 $(x_i,y_i)$，如下所示：\n$$\n(x_1,y_1)=(1,1),\\quad (x_2,y_2)=(2,2),\\quad (x_3,y_3)=(3,4),\\quad (x_4,y_4)=(4,8),\\quad (x_5,y_5)=(5,16),\\quad (x_6,y_6)=(6,32).\n$$\n考虑一个严格递增的变换 $T:\\mathbb{R}_{+}\\to\\mathbb{R}$，定义为 $T(y)=\\ln(y)$，该变换将生物标志物转换为对数尺度，以适用于某些建模任务。\n\n从医学统计建模中使用的测量量表和相关性度量的核心定义出发：\n- 有序量表在严格单调变换下仅保留顺序。\n- 斯皮尔曼等级相关系数 $\\rho$ 定义为应用于变量秩次的皮尔逊相关系数。\n- 肯德尔 $\\tau$ 相关系数衡量的是一致对和不一致对数量之间的标准化差异，并且仅依赖于顺序。\n- 皮尔逊相关系数 $r$ 是根据中心化协方差和标准差定义的，并且对测量单位和非线性重新定标敏感。\n\n执行以下操作：\n1. 将 $X$ 和 $Y$ 视为上述给定值。分别从秩次和一致性的第一性原理出发，计算斯皮尔曼等级相关系数 $\\rho(X,Y)$ 和肯德尔 $\\tau$ 相关系数 $\\tau(X,Y)$。\n2. 应用变换 $Y' = T(Y) = \\ln(Y)$，并使用相同的原理计算 $\\rho(X,Y')$ 和 $\\tau(X,Y')$。简要论证为什么这些值必须等于第1部分中的对应值。\n3. 使用定义 $r(X,Y) = S_{XY}/\\sqrt{S_{XX}S_{YY}}$（其中 $S_{XY}=\\sum_{i=1}^{n}(x_i-\\bar{x})(y_i-\\bar{y})$， $S_{XX}$ 和 $S_{YY}$ 的定义类似）计算皮尔逊相关系数 $r(X,Y)$。然后计算 $r(X,Y')$，并结合测量量表属性解释相对于 $r(X,Y)$ 的变化。\n\n将任何非整数数值答案四舍五入到四位有效数字。将您的最终答案表示为单行矩阵（使用顺序：$\\rho(X,Y)$, $\\rho(X,Y')$, $\\tau(X,Y)$, $\\tau(X,Y')$, $r(X,Y)$, $r(X,Y')$）。", "solution": "问题陈述经评估有效。其科学依据扎根于统计测量的原理，问题提法恰当，包含了所有必要的数据和定义，并以客观的语言表达。它提出了一个清晰、可解的生物统计学问题，没有任何事实错误、歧义或矛盾。\n\n解答按要求分三部分进行。\n\n**第1部分：$\\rho(X,Y)$ 和 $\\tau(X,Y)$ 的计算**\n\n斯皮尔曼等级相关系数 $\\rho(X,Y)$ 是应用于变量 $X$ 和 $Y$ 秩次的皮尔逊相关系数。\n变量 $X$ 由序列 $X = \\{1, 2, 3, 4, 5, 6\\}$ 给出。由于这些值已经是排序好的并且是唯一的，它们的秩次（记为 $R_X$）与这些值本身相同：$R_X = \\{1, 2, 3, 4, 5, 6\\}$。\n变量 $Y$ 由序列 $Y = \\{1, 2, 4, 8, 16, 32\\}$ 给出。这个序列是严格递增的。因此，$Y$ 的秩次（记为 $R_Y$）是 $R_Y = \\{1, 2, 3, 4, 5, 6\\}$。\n由于秩次相同，$R_X = R_Y$，秩次之间的关系是具有正斜率的完美线性关系。一个变量与自身之间的皮尔逊相关性为 $1$。因此，\n$$\n\\rho(X,Y) = r(R_X, R_Y) = 1\n$$\n\n肯德尔等级相关系数 $\\tau(X,Y)$ 定义为 $\\tau = (N_c - N_d) / (N_c + N_d)$，其中 $N_c$ 是一致对的数量，$N_d$ 是不一致对的数量。观测值唯一配对的总数为 $\\binom{n}{2} = \\binom{6}{2} = \\frac{6 \\times 5}{2} = 15$。\n如果 $(x_i - x_j)$ 和 $(y_i - y_j)$ 的符号相同，则一对观测值 $(x_i, y_i)$ 和 $(x_j, y_j)$ 是一致的。\n$X$ 的数据为 $\\{1, 2, 3, 4, 5, 6\\}$，这是一个严格递增序列。\n$Y$ 的数据为 $\\{1, 2, 4, 8, 16, 32\\}$，这也是一个严格递增序列。\n对于任意两个索引 $i > j$，我们总是有 $x_i > x_j$ 和 $y_i > y_j$。这意味着 $(x_i - x_j) > 0$ 和 $(y_i - y_j) > 0$，所以它们的符号相同。因此，所有15个可能的观测对都是一致的。\n因此，$N_c = 15$ 且 $N_d = 0$。\n肯德尔 $\\tau$ 的值是：\n$$\n\\tau(X,Y) = \\frac{15 - 0}{15 + 0} = 1\n$$\n\n**第2部分：$\\rho(X,Y')$ 和 $\\tau(X,Y')$ 的计算**\n\n变换为 $Y' = T(Y) = \\ln(Y)$。$Y$ 的原始值为 $\\{1, 2, 4, 8, 16, 32\\}$。\n变换后的值为 $Y' = \\{\\ln(1), \\ln(2), \\ln(4), \\ln(8), \\ln(16), \\ln(32)\\} = \\{0, \\ln(2), 2\\ln(2), 3\\ln(2), 4\\ln(2), 5\\ln(2)\\}$。\n函数 $T(y) = \\ln(y)$ 在其定义域 $y \\in \\mathbb{R}_{+}$ 上是一个严格单调递增函数。\n斯皮尔曼 $\\rho$ 和肯德尔 $\\tau$ 都是基于秩次的相关性度量。应用于变量的严格单调变换不会改变其值的排序。因此，$Y$ 和 $Y'$ 的秩次是相同的。$Y'$ 的秩次集合为 $R_{Y'} = \\{1, 2, 3, 4, 5, 6\\}$，与 $R_Y$ 相同。\n由于秩次没有改变，$\\rho(X,Y')$ 的计算与 $\\rho(X,Y)$ 的计算相同。\n$$\n\\rho(X,Y') = \\rho(X,Y) = 1\n$$\n类似地，由于 $Y$ 值的顺序被保留，每对观测值的一致性或不一致性保持不变。$(X, Y')$ 的一致对数量仍然是 $N_c = 15$，不一致对的数量是 $N_d = 0$。\n$$\n\\tau(X,Y') = \\tau(X,Y) = 1\n$$\n这种不变性属性是基于秩次的相关系数的一个基本特征，使它们适用于分析有序或变换后的比率/区间量表上的单调关系。\n\n**第3部分：$r(X,Y)$ 和 $r(X,Y')$ 的计算**\n\n皮尔逊相关系数 $r(X,Y)$ 由 $r(X,Y) = S_{XY}/\\sqrt{S_{XX}S_{YY}}$ 给出。首先，我们计算 $n=6$ 时 $X$ 和 $Y$ 的必要汇总统计量。\n均值为：\n$\\bar{x} = \\frac{1+2+3+4+5+6}{6} = \\frac{21}{6} = 3.5$\n$\\bar{y} = \\frac{1+2+4+8+16+32}{6} = \\frac{63}{6} = 10.5$\n\n离差平方和为：\n$S_{XX} = \\sum_{i=1}^n (x_i - \\bar{x})^2 = (1-3.5)^2 + (2-3.5)^2 + \\dots + (6-3.5)^2 = (-2.5)^2 + (-1.5)^2 + (-0.5)^2 + (0.5)^2 + (1.5)^2 + (2.5)^2 = 6.25 + 2.25 + 0.25 + 0.25 + 2.25 + 6.25 = 17.5$。\n$S_{YY} = \\sum_{i=1}^n (y_i - \\bar{y})^2 = (1-10.5)^2 + (2-10.5)^2 + \\dots + (32-10.5)^2 = (-9.5)^2 + (-8.5)^2 + (-6.5)^2 + (-2.5)^2 + (5.5)^2 + (21.5)^2 = 90.25 + 72.25 + 42.25 + 6.25 + 30.25 + 462.25 = 703.5$。\n\n离差交叉乘积和为：\n$S_{XY} = \\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y}) = (-2.5)(-9.5) + (-1.5)(-8.5) + (-0.5)(-6.5) + (0.5)(-2.5) + (1.5)(5.5) + (2.5)(21.5) = 23.75 + 12.75 + 3.25 - 1.25 + 8.25 + 53.75 = 100.5$。\n\n现在，我们计算 $r(X,Y)$：\n$$\nr(X,Y) = \\frac{100.5}{\\sqrt{17.5 \\times 703.5}} = \\frac{100.5}{\\sqrt{12311.25}} \\approx \\frac{100.5}{110.95607} \\approx 0.90576\n$$\n四舍五入到四位有效数字，$r(X,Y) \\approx 0.9058$。\n\n接下来，我们计算 $r(X,Y')$。$X$ 和 $Y$ 之间的关系由 $y_i = 2^{x_i-1}$ 给出。应用变换 $Y'=\\ln(Y)$，我们发现 $X$ 和 $Y'$ 之间的关系是：\n$$\ny'_i = \\ln(y_i) = \\ln(2^{x_i-1}) = (x_i-1)\\ln(2) = (\\ln 2)x_i - \\ln 2\n$$\n这个方程表明 $Y'$ 是 $X$ 的一个完美线性函数，形式为 $Y' = aX+b$，其中斜率为 $a = \\ln(2)  0$，截距为 $b = -\\ln(2)$。\n皮尔逊相关系数衡量的是线性关系的强度。当两个变量具有带正斜率的完美线性关系时，它们的皮尔逊相关系数恰好为 $1$。因此，\n$$\nr(X,Y') = 1\n$$\n\n皮尔逊相关系数从 $r(X,Y) \\approx 0.9058$ 变为 $r(X,Y') = 1$ 是由于该度量的性质。皮尔逊 $r$ 对非线性变换敏感。$X$ 和 $Y$ 之间的关系是指数关系，它是单调的但非线性的。这种关系的皮尔逊 $r$ 值很高但不等于 $1$，反映了与完美线性的偏离。对数变换将这种指数关系线性化，从而导致 $X$ 和 $Y'$ 之间存在完美的线性关联。这表明，皮尔逊 $r$ 在线性变换下是不变的，但在非线性变换下则不是，这一点与基于秩次的相关系数 $\\rho$ 和 $\\tau$ 不同。$r$ 值的变化正确地反映了关系几何形式从指数到线性的变化。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  1  1  1  0.9058  1 \\end{pmatrix}}\n$$", "id": "4993177"}, {"introduction": "我们将注意力转向定类（分类）数据，解决一个常见的现实世界问题：测量误差。在医学研究中，诊断或结局可能会被错误分类。本练习提供了一个严谨的框架，以理解和量化这种对二元结局的非差异性错分如何系统地将效应的关键度量——比值比（Odds Ratio）——偏向无效值。[@problem_id:4993205]", "problem": "一项临床队列研究记录了二元暴露 $E \\in \\{0,1\\}$ 和二元疾病结局 $Y \\in \\{0,1\\}$，两者均在名义尺度上测量。假设暴露的测量没有误差。结局的测量存在非差异性错分：在真实结局 $Y$ 的条件下，观察到阳性结局 $Y^{\\ast}=1$ 的概率不依赖于 $E$。设结局测量的灵敏度 $\\mathrm{Se}$ 和特异度 $\\mathrm{Sp}$ 满足 $0  \\mathrm{Se}  1$ 和 $0  \\mathrm{Sp}  1$，且\n$$\n\\Pr(Y^{\\ast}=1 \\mid Y=1, E=e) = \\mathrm{Se}, \\quad \\Pr(Y^{\\ast}=0 \\mid Y=0, E=e) = \\mathrm{Sp} \\quad \\text{for all } e \\in \\{0,1\\}.\n$$\n令 $p_{e} = \\Pr(Y=1 \\mid E=e)$ 表示暴露组 $e$ 中的真实结局概率。将暴露的真实比值比（odds ratio, OR）定义为\n$$\n\\theta = \\frac{\\frac{p_{1}}{1-p_{1}}}{\\frac{p_{0}}{1-p_{0}}}.\n$$\n令 $q_{e} = \\Pr(Y^{\\ast}=1 \\mid E=e)$ 表示错分下的观察结局概率，并令观察比值比为\n$$\n\\theta^{\\ast} = \\frac{\\frac{q_{1}}{1-q_{1}}}{\\frac{q_{0}}{1-q_{0}}}.\n$$\n从灵敏度、特异度、比值（odds）和比值比的核心定义出发，推导 $\\theta^{\\ast}$ 作为 $\\theta$、非暴露组中的基线真实比值 $o_{0} = \\frac{p_{0}}{1-p_{0}}$ 以及错分参数 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 的函数的封闭式表达式。在对称性假设 $\\mathrm{Se} = \\mathrm{Sp}$ 和 $\\mathrm{Se}  \\frac{1}{2}$ 下，使用微积分论证为什么 $\\theta^{\\ast}$ 在比值比尺度上偏向于零值；也就是说，如果 $\\theta  1$，则 $0  \\ln(\\theta^{\\ast})  \\ln(\\theta)$，如果 $\\theta  1$，则 $\\ln(\\theta)  \\ln(\\theta^{\\ast})  0$。\n\n报告 $\\theta^{\\ast}$ 以 $\\theta$、$o_{0}$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 表示的单一封闭式解析表达式作为您的最终答案。无需进行数值评估。", "solution": "在尝试求解之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取已知条件\n-   二元暴露：$E \\in \\{0,1\\}$\n-   二元真实结局：$Y \\in \\{0,1\\}$\n-   二元观察结局：$Y^{\\ast} \\in \\{0,1\\}$\n-   错分模型：相对于暴露 $E$ 是非差异性的。\n-   结局测量的灵敏度：$\\mathrm{Se} = \\Pr(Y^{\\ast}=1 \\mid Y=1, E=e)$，对于 $e \\in \\{0,1\\}$，且 $0  \\mathrm{Se}  1$。\n-   结局测量的特异度：$\\mathrm{Sp} = \\Pr(Y^{\\ast}=0 \\mid Y=0, E=e)$，对于 $e \\in \\{0,1\\}$，且 $0  \\mathrm{Sp}  1$。\n-   真实结局概率：$p_{e} = \\Pr(Y=1 \\mid E=e)$。\n-   暴露组 $e$ 中的真实比值：$o_{e} = \\frac{p_{e}}{1-p_{e}}$。\n-   基线真实比值（非暴露组）：$o_{0} = \\frac{p_{0}}{1-p_{0}}$。\n-   真实比值比：$\\theta = \\frac{o_1}{o_0} = \\frac{p_{1}/(1-p_{1})}{p_{0}/(1-p_{0})}$。\n-   观察结局概率：$q_{e} = \\Pr(Y^{\\ast}=1 \\mid E=e)$。\n-   暴露组 $e$ 中的观察比值：$o_{e}^{\\ast} = \\frac{q_{e}}{1-q_{e}}$。\n-   观察比值比：$\\theta^{\\ast} = \\frac{o_1^{\\ast}}{o_0^{\\ast}} = \\frac{q_{1}/(1-q_{1})}{q_{0}/(1-q_{0})}$。\n-   任务 1：推导 $\\theta^{\\ast}$ 作为 $\\theta$、$o_{0}$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 的函数的表达式。\n-   任务 2：在假设 $\\mathrm{Se} = \\mathrm{Sp}  1/2$ 下，证明 $\\theta^{\\ast}$ 在比值比尺度上偏向于零值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。这是流行病学方法中关于测量误差的一个标准问题。灵敏度、特异度、非差异性错分和比值比的定义是标准的，并且陈述正确。所有变量和参数都已明确定义，任务是推导一个特定的解析关系，然后在指定条件下证明一个性质。该问题是自洽的，没有矛盾或歧义。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### $\\theta^{\\ast}$ 的推导\n\n我们的第一个目标是根据真实结局概率 $p_{e} = \\Pr(Y=1 \\mid E=e)$，推导观察结局概率 $q_{e} = \\Pr(Y^{\\ast}=1 \\mid E=e)$ 的表达式。我们使用全概率公式，以真实结局状态 $Y$ 为条件。\n$$\nq_{e} = \\Pr(Y^{\\ast}=1 \\mid E=e) = \\sum_{y=0}^{1} \\Pr(Y^{\\ast}=1 \\mid Y=y, E=e) \\Pr(Y=y \\mid E=e)\n$$\n代入所给的定义：\n-   $\\Pr(Y=1 \\mid E=e) = p_{e}$\n-   $\\Pr(Y=0 \\mid E=e) = 1-p_{e}$\n-   $\\Pr(Y^{\\ast}=1 \\mid Y=1, E=e) = \\mathrm{Se}$\n-   $\\Pr(Y^{\\ast}=1 \\mid Y=0, E=e) = 1 - \\Pr(Y^{\\ast}=0 \\mid Y=0, E=e) = 1 - \\mathrm{Sp}$\n\n$q_e$ 的表达式变为：\n$$\nq_{e} = (\\mathrm{Se})(p_{e}) + (1-\\mathrm{Sp})(1-p_{e})\n$$\n这个基本关系将观察概率与真实概率以及错分参数联系起来。\n\n接下来，我们将观察比值 $o_{e}^{\\ast} = \\frac{q_{e}}{1-q_{e}}$ 用真实比值 $o_{e} = \\frac{p_{e}}{1-p_{e}}$ 来表示。为此，我们首先求出 $1-q_{e}$ 的表达式：\n$$\n1-q_e = 1 - [\\mathrm{Se} \\cdot p_e + (1-\\mathrm{Sp})(1-p_e)] = (1-\\mathrm{Se})p_e + \\mathrm{Sp}(1-p_e)\n$$\n现在我们构建观察比值的比率：\n$$\no_{e}^{\\ast} = \\frac{q_e}{1-q_e} = \\frac{\\mathrm{Se} \\cdot p_e + (1-\\mathrm{Sp})(1-p_e)}{(1-\\mathrm{Se})p_e + \\mathrm{Sp}(1-p_e)}\n$$\n为了用真实比值 $o_e$ 来表示，我们将分子和分母同时除以 $1-p_e$：\n$$\no_{e}^{\\ast} = \\frac{\\mathrm{Se} \\left(\\frac{p_e}{1-p_e}\\right) + (1-\\mathrm{Sp})}{(1-\\mathrm{Se})\\left(\\frac{p_e}{1-p_e}\\right) + \\mathrm{Sp}} = \\frac{\\mathrm{Se} \\cdot o_e + 1-\\mathrm{Sp}}{(1-\\mathrm{Se})o_e + \\mathrm{Sp}}\n$$\n这个方程关联了任意暴露组 $e$ 中的观察比值和真实比值。\n\n观察比值比 $\\theta^{\\ast}$ 是暴露组（$e=1$）的观察比值与非暴露组（$e=0$）的观察比值的比率：\n$$\n\\theta^{\\ast} = \\frac{o_1^{\\ast}}{o_0^{\\ast}}\n$$\n使用我们刚刚推导出的 $o_e^{\\ast}$ 的关系式：\n$$\no_1^{\\ast} = \\frac{\\mathrm{Se} \\cdot o_1 + 1-\\mathrm{Sp}}{(1-\\mathrm{Se})o_1 + \\mathrm{Sp}} \\quad \\text{and} \\quad o_0^{\\ast} = \\frac{\\mathrm{Se} \\cdot o_0 + 1-\\mathrm{Sp}}{(1-\\mathrm{Se})o_0 + \\mathrm{Sp}}\n$$\n真实比值比是 $\\theta = o_1/o_0$，这意味着 $o_1 = \\theta \\cdot o_0$。将此代入 $o_1^{\\ast}$ 的表达式中：\n$$\no_1^{\\ast} = \\frac{\\mathrm{Se} \\cdot (\\theta o_0) + 1-\\mathrm{Sp}}{(1-\\mathrm{Se})(\\theta o_0) + \\mathrm{Sp}}\n$$\n现在我们可以构建观察比值比 $\\theta^{\\ast}$：\n$$\n\\theta^{\\ast} = \\frac{o_1^{\\ast}}{o_0^{\\ast}} = \\frac{\\frac{\\mathrm{Se} \\cdot \\theta o_0 + 1-\\mathrm{Sp}}{(1-\\mathrm{Se})\\theta o_0 + \\mathrm{Sp}}}{\\frac{\\mathrm{Se} \\cdot o_0 + 1-\\mathrm{Sp}}{(1-\\mathrm{Se})o_0 + \\mathrm{Sp}}}\n$$\n整理各项，得到 $\\theta^{\\ast}$ 的最终封闭式表达式：\n$$\n\\theta^{\\ast} = \\left( \\frac{\\mathrm{Se} \\cdot \\theta \\cdot o_0 + 1 - \\mathrm{Sp}}{(1-\\mathrm{Se})\\theta \\cdot o_0 + \\mathrm{Sp}} \\right) \\left( \\frac{(1-\\mathrm{Se})o_0 + \\mathrm{Sp}}{\\mathrm{Se} \\cdot o_0 + 1 - \\mathrm{Sp}} \\right)\n$$\n\n### 偏向零值的证明\n\n我们现在考虑 $\\mathrm{Se} = \\mathrm{Sp} = S$ 的特殊情况，并有约束条件 $S  1/2$。观察比值与真实比值之间的关系得以简化。令 $f(o_e) = o_e^{\\ast}$。\n$$\nf(o_e) = \\frac{S \\cdot o_e + 1-S}{(1-S)o_e + S}\n$$\n观察比值比为 $\\theta^{\\ast} = f(o_1)/f(o_0) = f(\\theta o_0)/f(o_0)$。\n为了证明偏向零值，我们必须表明，如果 $\\theta  1$，则 $1  \\theta^{\\ast}  \\theta$；如果 $0  \\theta  1$，则 $\\theta  \\theta^{\\ast}  1$。\n\n首先，我们分析函数 $f(o)$。它关于 $o$ 的一阶导数是：\n$$\nf'(o) = \\frac{S((1-S)o+S) - (1-S)(S \\cdot o + 1-S)}{((1-S)o+S)^2} = \\frac{S^2 - (1-S)^2}{((1-S)o+S)^2} = \\frac{2S-1}{((1-S)o+S)^2}\n$$\n已知 $S  1/2$，则 $2S-1  0$。分母是一个平方项，恒为正。因此，$f'(o)  0$，这意味着 $f(o)$ 是一个严格递增函数。这确保了关联的方向得以保持：如果 $\\theta  1$（即 $o_1  o_0$），则 $f(o_1)  f(o_0)$ 且 $\\theta^{\\ast}  1$。如果 $\\theta  1$，则 $\\theta^{\\ast}  1$。\n\n为了显示幅度的衰减（偏向零值），我们分析函数 $k(o) = f(o)/o$。我们想要比较 $\\theta^{\\ast}/\\theta$ 与 $1$。\n$$\n\\frac{\\theta^{\\ast}}{\\theta} = \\frac{f(\\theta o_0)/f(o_0)}{\\theta} = \\frac{f(\\theta o_0)/(\\theta o_0)}{f(o_0)/o_0} = \\frac{k(\\theta o_0)}{k(o_0)}\n$$\n我们来求 $k(o)$ 的导数：\n$$\nk'(o) = \\frac{f'(o) \\cdot o - f(o)}{o^2}\n$$\n$k'(o)$ 的符号由其分子 $j(o) = f'(o) \\cdot o - f(o)$ 决定。\n我们来求 $j(o)$ 的导数：\n$$\nj'(o) = f''(o) \\cdot o + f'(o) - f'(o) = o \\cdot f''(o)\n$$\n我们需要 $f(o)$ 的二阶导数：\n$$\nf''(o) = \\frac{d}{do}\\left[ (2S-1) ((1-S)o+S)^{-2} \\right] = (2S-1)(-2)((1-S)o+S)^{-3}(1-S) = -2(2S-1)(1-S) \\frac{1}{((1-S)o+S)^3}\n$$\n由于 $S \\in (1/2, 1)$，我们有 $2S-1  0$ 和 $1-S  0$。对于任何有效的比值 $o \\ge 0$，分母也为正。因此，$f''(o)  0$，这意味着 $f(o)$ 是一个严格凹函数。\n由于 $f''(o)  0$ 且 $o  0$，我们有 $j'(o) = o \\cdot f''(o)  0$。这意味着对于 $o0$，$j(o)$ 是一个严格递减函数。\n我们来计算 $j(o)$ 在 $o=0$ 处的值：\n$$\nj(0) = f'(0) \\cdot 0 - f(o) = -f(0) = -\\frac{1-S}{S}\n$$\n由于 $S \\in (1/2, 1)$，$1-S  0$ 且 $S0$，所以 $j(0)  0$。\n因为对于 $o0$，$j(o)$ 是严格递减的，并且 $j(0)  0$，所以对于所有 $o \\ge 0$，$j(o)  0$。\n这意味着对于所有 $o0$，$k'(o)  0$，也就是说 $k(o)=f(o)/o$ 是一个严格递减函数。\n\n现在我们可以证明这种偏倚：\n情况 1：$\\theta  1$。\n这意味着 $\\theta o_0  o_0$。由于 $k(o)$ 是严格递减的，所以 $k(\\theta o_0)  k(o_0)$。\n$$\n\\frac{k(\\theta o_0)}{k(o_0)}  1 \\implies \\frac{\\theta^{\\ast}}{\\theta}  1 \\implies \\theta^{\\ast}  \\theta\n$$\n结合 $\\theta^{\\ast}  1$，我们得到 $1  \\theta^{\\ast}  \\theta$。取自然对数，我们得到 $0  \\ln(\\theta^{\\ast})  \\ln(\\theta)$。\n\n情况 2：$0  \\theta  1$。\n这意味着 $\\theta o_0  o_0$。由于 $k(o)$ 是严格递减的，所以 $k(\\theta o_0)  k(o_0)$。\n$$\n\\frac{k(\\theta o_0)}{k(o_0)}  1 \\implies \\frac{\\theta^{\\ast}}{\\theta}  1 \\implies \\theta^{\\ast}  \\theta\n$$\n结合 $\\theta^{\\ast}  1$，我们得到 $\\theta  \\theta^{\\ast}  1$。取自然对数，我们得到 $\\ln(\\theta)  \\ln(\\theta^{\\ast})  0$。\n\n因此，在对称条件 $\\mathrm{Se} = \\mathrm{Sp}  1/2$ 下，二元结局的非差异性错分总是使比值比偏向于零值 1。", "answer": "$$\n\\boxed{\\left( \\frac{\\mathrm{Se} \\cdot \\theta \\cdot o_0 + 1 - \\mathrm{Sp}}{(1-\\mathrm{Se})\\theta \\cdot o_0 + \\mathrm{Sp}} \\right) \\left( \\frac{(1-\\mathrm{Se})o_0 + \\mathrm{Sp}}{\\mathrm{Se} \\cdot o_0 + 1 - \\mathrm{Sp}} \\right)}\n$$", "id": "4993205"}]}