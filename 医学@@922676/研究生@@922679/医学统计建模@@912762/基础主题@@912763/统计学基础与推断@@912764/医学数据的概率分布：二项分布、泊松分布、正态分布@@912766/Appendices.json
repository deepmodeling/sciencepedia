{"hands_on_practices": [{"introduction": "这项练习回归到基本原理，推导研究设计中的一个关键公式 [@problem_id:4980500]。你将从二项分布出发，应用中心极限定理，推导出估算总体比例所需的样本量公式，从而巩固这项日常统计工作的理论基础。", "problem": "一个医院系统正在计划进行一项横断面血清阳性率研究，以估计目标人群中针对一种新型病原体的抗体真实流行率 $p$。设 $X$ 表示在一个大小为 $n$ 的简单随机样本中的血清阳性个体数，并将流行率的估计量定义为 $\\hat{p} = X/n$。假设 $X$ 的数据生成机制服从二项分布，并且研究团队将使用正态近似方法，基于 $\\hat{p}$ 为 $p$ 构建一个双侧 $(1-\\alpha)$ 置信区间(CI)。该团队为置信区间规定了一个要求的误差范围 $m$，其定义为区间的半宽。\n\n请仅使用二项分布的基本性质、误差范围的定义以及基于中心极限定理(CLT)的有效大样本近似，推导并给出一个为达到在置信水平 $1-\\alpha$ 下指定的误差范围 $m$ 所需的最小样本量 $n$ 的闭式表达式（作为实值函数），该表达式仅用 $p$、$m$ 和 $\\alpha$ 表示。你的最终答案必须是关于 $n$ 的单个解析表达式。无需进行四舍五入。", "solution": "在尝试求解之前，将首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n- 抗体的真实流行率: $p$\n- 血清阳性个体数: $X$\n- 样本量: $n$\n- 流行率的估计量: $\\hat{p} = X/n$\n- $X$ 的数据生成机制: 二项分布, 即 $X \\sim \\text{Binomial}(n,p)$\n- 置信区间构建方法: 正态近似\n- 置信水平: $1-\\alpha$\n- 误差范围 (CI的半宽): $m$\n- 目标: 推导最小样本量 $n$ 作为 $p$, $m$ 和 $\\alpha$ 的实值函数的闭式表达式。\n\n#### 步骤2：使用提取的已知条件进行验证\n基于所提供的已知条件评估问题的有效性。\n\n- **科学上合理 (关键)**: 该问题在根本上是合理的。它描述了生物统计学和流行病学中用于规划研究的一个标准且广泛使用的程序。使用二项分布来模拟固定数量独立试验中的阳性结果数对于简单随机样本是合适的。应用中心极限定理(CLT)来证明样本比例的抽样分布可以采用正态近似，这是大样本统计推断的基石。\n- **定义明确 (Well-Posed)**: 该问题是定义明确的。它提供了一个明确的目标（推导 $n$ 的表达式）以及实现该目标所需的所有必要组成部分（$p, m, \\alpha$ 和统计框架）。该推导过程会得出一个唯一的解析解。\n- **客观性 (关键)**: 该问题以精确、客观和正式的科学语言陈述，没有任何主观性或模糊性。\n\n该问题没有说明中列出的任何缺陷（例如，科学上不合理、信息缺失、条件不切实际、含糊不清）。它是统计理论中一个经典的、可形式化的问题。\n\n#### 步骤3：结论与行动\n问题被判定为**有效**。现在将提供一个完整的、有理有据的解答。\n\n### 样本量公式的推导\n\n目标是推导出一个表达式，用于计算在指定的误差范围 $m$ 和置信水平 $1-\\alpha$ 下，估计一个总体流行率 $p$ 所需的最小样本量 $n$。\n\n1.  **估计量的性质**：\n    随机变量 $X$ 代表在一个大小为 $n$ 的样本中的血清阳性个体数，根据题意服从二项分布，即 $X \\sim \\text{Binomial}(n, p)$。流行率的估计量为 $\\hat{p} = X/n$。\n\n    估计量 $\\hat{p}$ 的期望值（均值）为：\n    $$E[\\hat{p}] = E\\left[\\frac{X}{n}\\right] = \\frac{1}{n}E[X]$$\n    鉴于二项随机变量的均值为 $np$，我们有：\n    $$E[\\hat{p}] = \\frac{1}{n}(np) = p$$\n    这表明 $\\hat{p}$ 是 $p$ 的一个无偏估计量。\n\n    估计量 $\\hat{p}$ 的方差为：\n    $$\\text{Var}(\\hat{p}) = \\text{Var}\\left(\\frac{X}{n}\\right) = \\frac{1}{n^2}\\text{Var}(X)$$\n    鉴于二项随机变量的方差为 $np(1-p)$，我们有：\n    $$\\text{Var}(\\hat{p}) = \\frac{1}{n^2}(np(1-p)) = \\frac{p(1-p)}{n}$$\n    估计量的标准差，即标准误(SE)，是方差的平方根：\n    $$\\text{SE}(\\hat{p}) = \\sqrt{\\frac{p(1-p)}{n}}$$\n\n2.  **正态近似与置信区间构建**：\n    问题指定使用正态近似，这对于大样本量 $n$ 是由中心极限定理所保证的。$\\hat{p}$ 的抽样分布可以近似为一个正态分布：\n    $$\\hat{p} \\approx \\mathcal{N}\\left(p, \\frac{p(1-p)}{n}\\right)$$\n    真实流行率 $p$ 的一个置信水平为 $1-\\alpha$ 的双侧置信区间的构建方式如下：\n    $$\\text{置信区间} = \\text{估计量} \\pm (\\text{临界值}) \\times (\\text{标准误})$$\n    对于正态近似，临界值从标准正态分布 $Z \\sim \\mathcal{N}(0,1)$ 中获得。设 $z_{1-\\alpha/2}$ 是临界值，使得标准正态曲线下 $-z_{1-\\alpha/2}$ 和 $z_{1-\\alpha/2}$ 之间的面积为 $1-\\alpha$。那么置信区间由下式给出：\n    $$\\text{CI} = \\hat{p} \\pm z_{1-\\alpha/2} \\cdot \\text{SE}(\\hat{p})$$\n    代入真实标准误的表达式（这在规划阶段是合适的，因为此时 $p$ 是假定的）：\n    $$\\text{CI} = \\hat{p} \\pm z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}}$$\n\n3.  **误差范围与样本量计算**：\n    误差范围 $m$ 定义为置信区间的半宽。根据置信区间的结构，我们可以确定误差范围为：\n    $$m = z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}}$$\n    我们的目标是解这个关于 $n$ 的方程。我们进行代数操作。首先，将方程两边平方：\n    $$m^2 = \\left(z_{1-\\alpha/2}\\right)^2 \\left(\\sqrt{\\frac{p(1-p)}{n}}\\right)^2$$\n    $$m^2 = (z_{1-\\alpha/2})^2 \\frac{p(1-p)}{n}$$\n    接下来，我们分离出 $n$。将两边同乘以 $n$：\n    $$n \\cdot m^2 = (z_{1-\\alpha/2})^2 p(1-p)$$\n    最后，将两边同除以 $m^2$ 以得到 $n$ 的表达式：\n    $$n = \\frac{(z_{1-\\alpha/2})^2 p(1-p)}{m^2}$$\n    这就是所要求的最小样本量 $n$ 作为一个实值函数的闭式表达式，它仅用真实流行率 $p$、期望的误差范围 $m$ 和置信水平 $1-\\alpha$（它决定了临界值 $z_{1-\\alpha/2}$）来表示。", "answer": "$$\\boxed{\\frac{(z_{1-\\alpha/2})^{2} p(1-p)}{m^{2}}}$$", "id": "4980500"}, {"introduction": "医疗计数数据常常表现出超出泊松分布预测的变异性，这一现象被称为“过度离散”。这项练习 [@problem_id:4980516] 将引导你通过推导泊松-伽马混合模型得到负二项分布，以此来探索这个概念，并为你提供一个分析此类数据的基本工具。然后，你将应用矩估计法来估算模型的分散参数，将理论与实际估计技术联系起来。", "problem": "一家医院监测一个大病区连续 $n$ 周内住院患者的每周跌倒事件计数。由于患者构成和人员配备水平的波动，每周的事件发生率在各周之间是异质的。一位流行病学家提出了以下生成模型：在给定一个潜在率 $\\Lambda$ 的条件下，每周的计数 $Y$ 服从均值为 $\\Lambda$ 的泊松分布；而在各周之间，潜在率 $\\Lambda$ 根据一个形状参数为 $k$、尺度参数为 $\\theta$ 的伽玛分布变化，其均值为 $\\mu = k \\theta$。假设各周是独立的。\n\n从这些假设以及泊松分布和伽玛分布的基本定义出发，推导 $Y$ 的边际概率质量函数，并用参数化 $(k,\\mu)$ 表示它。然后，写出独立观测值 $y_1,\\dots,y_n$ 的对数似然 $\\ell(k,\\mu \\mid y_1,\\dots,y_n)$，使其仅为 $k$ 和 $\\mu$ 的函数。\n\n医院提供了以下在 $n=12$ 周内观测到的每周计数：\n$$\n4,\\ 9,\\ 7,\\ 12,\\ 3,\\ 11,\\ 0,\\ 8,\\ 14,\\ 5,\\ 6,\\ 10.\n$$\n使用矩估计法（MoM）原理，将推导出的边际分布的理论均值和方差与经验均值和经验总体方差 $s^{2} = \\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\bar{y})^{2}$ 相等，从而得到离散参数 $k$ 的矩估计量。根据所提供的数据计算其数值。将最终的数值估计四舍五入到四位有效数字。最终答案无需单位。", "solution": "该问题经评估为有效。它在科学上基于标准的统计理论（泊松-伽玛混合模型），问题陈述清晰，目标明确，信息充分，并且以客观的语言表达，没有任何事实上的不健全或含糊之处。因此，我们可以着手解决。\n\n该问题要求基于一个用于每周跌倒事件计数 $Y$ 的分层模型进行几项推导。该模型假设，在给定一个潜在率 $\\Lambda$ 的条件下，计数 $Y$ 服从泊松分布，而率 $\\Lambda$ 本身服从伽玛分布。\n\n1.  **$Y$ 的边际概率质量函数 (PMF) 的推导**\n\n在给定率 $\\Lambda = \\lambda$ 的条件下，计数 $Y$ 的条件分布是泊松分布：\n$$P(Y=y \\mid \\Lambda=\\lambda) = \\frac{\\lambda^y \\exp(-\\lambda)}{y!}, \\quad \\text{对于 } y \\in \\{0, 1, 2, \\dots\\}$$\n假设率 $\\Lambda$ 服从形状参数为 $k$、尺度参数为 $\\theta$ 的伽玛分布，记为 $\\Lambda \\sim \\text{Gamma}(k, \\theta)$。$\\Lambda$ 的概率密度函数 (PDF) 是：\n$$f_{\\Lambda}(\\lambda) = \\frac{1}{\\Gamma(k)\\theta^k} \\lambda^{k-1} \\exp(-\\lambda/\\theta), \\quad \\text{对于 } \\lambda > 0$$\n$Y$ 的边际 PMF 是通过将 $Y$ 的条件 PMF 与 $\\Lambda$ 的 PDF 的乘积对 $\\lambda$ 的所有可能值进行积分得到的：\n$$P(Y=y) = \\int_{0}^{\\infty} P(Y=y \\mid \\Lambda=\\lambda) f_{\\Lambda}(\\lambda) \\,d\\lambda$$\n代入泊松 PMF 和伽玛 PDF 的表达式：\n$$P(Y=y) = \\int_{0}^{\\infty} \\frac{\\lambda^y \\exp(-\\lambda)}{y!} \\cdot \\frac{1}{\\Gamma(k)\\theta^k} \\lambda^{k-1} \\exp(-\\lambda/\\theta) \\,d\\lambda$$\n我们可以重新整理各项，以分离出关于 $\\lambda$ 的积分：\n$$P(Y=y) = \\frac{1}{y! \\Gamma(k) \\theta^k} \\int_{0}^{\\infty} \\lambda^{y+k-1} \\exp\\left(-\\lambda\\left(1 + \\frac{1}{\\theta}\\right)\\right) \\,d\\lambda$$\n$$P(Y=y) = \\frac{1}{y! \\Gamma(k) \\theta^k} \\int_{0}^{\\infty} \\lambda^{(y+k)-1} \\exp\\left(-\\frac{\\lambda}{\\frac{\\theta}{1+\\theta}}\\right) \\,d\\lambda$$\n该积分是伽玛分布的核。已知这个积分的值为 $\\Gamma(y+k) \\left(\\frac{\\theta}{1+\\theta}\\right)^{y+k}$。\n将其代回，我们得到：\n$$P(Y=y) = \\frac{1}{y! \\Gamma(k) \\theta^k} \\cdot \\Gamma(y+k) \\left(\\frac{\\theta}{1+\\theta}\\right)^{y+k}$$\n这个表达式可以被简化：\n$$P(Y=y) = \\frac{\\Gamma(y+k)}{y! \\Gamma(k)} \\frac{\\theta^{y+k}}{\\theta^k (1+\\theta)^{y+k}} = \\frac{\\Gamma(y+k)}{y! \\Gamma(k)} \\left(\\frac{\\theta}{1+\\theta}\\right)^y \\left(\\frac{1}{1+\\theta}\\right)^k$$\n这是负二项分布的 PMF，通常使用广义二项式系数 $\\binom{n}{k} = \\frac{\\Gamma(n+1)}{k!\\Gamma(n-k+1)}$ 来表示。具体来说，因为 $\\binom{y+k-1}{y} = \\frac{\\Gamma(y+k)}{y!\\Gamma(k)}$，我们有：\n$$P(Y=y) = \\binom{y+k-1}{y} \\left(\\frac{1}{1+\\theta}\\right)^k \\left(\\frac{\\theta}{1+\\theta}\\right)^y$$\n\n2.  **重新参数化和对数似然**\n\n问题要求用参数 $(k, \\mu)$ 来表示 PMF，其中 $\\mu = k\\theta$ 是伽玛分布的均值。我们将 $\\theta = \\mu/k$ 代入 PMF：\n$$1+\\theta = 1 + \\frac{\\mu}{k} = \\frac{k+\\mu}{k} \\implies \\frac{1}{1+\\theta} = \\frac{k}{k+\\mu}$$\n$$\\frac{\\theta}{1+\\theta} = \\frac{\\mu/k}{(k+\\mu)/k} = \\frac{\\mu}{k+\\mu}$$\n将这些代入 PMF，得到：\n$$P(Y=y; k, \\mu) = \\frac{\\Gamma(y+k)}{y! \\Gamma(k)} \\left(\\frac{k}{k+\\mu}\\right)^k \\left(\\frac{\\mu}{k+\\mu}\\right)^y$$\n对于独立观测值 $y_1, y_2, \\dots, y_n$，似然函数是各个概率的乘积：\n$$L(k, \\mu \\mid y_1, \\dots, y_n) = \\prod_{i=1}^{n} P(Y=y_i; k, \\mu) = \\prod_{i=1}^{n} \\left[ \\frac{\\Gamma(y_i+k)}{y_i! \\Gamma(k)} \\left(\\frac{k}{k+\\mu}\\right)^k \\left(\\frac{\\mu}{k+\\mu}\\right)^{y_i} \\right]$$\n对数似然 $\\ell(k, \\mu \\mid y_1, \\dots, y_n) = \\ln(L)$ 是各个概率的对数之和：\n$$\\ell(k, \\mu \\mid y_1, \\dots, y_n) = \\sum_{i=1}^{n} \\left[ \\ln(\\Gamma(y_i+k)) - \\ln(y_i!) - \\ln(\\Gamma(k)) + k\\ln\\left(\\frac{k}{k+\\mu}\\right) + y_i\\ln\\left(\\frac{\\mu}{k+\\mu}\\right) \\right]$$\n这可以写成：\n$$\\ell(k, \\mu \\mid y_1, \\dots, y_n) = \\sum_{i=1}^{n} \\ln(\\Gamma(y_i+k)) - \\sum_{i=1}^{n} \\ln(y_i!) - n\\ln(\\Gamma(k)) + nk\\ln(k) - nk\\ln(k+\\mu) + \\left(\\sum_{i=1}^{n} y_i\\right) (\\ln(\\mu) - \\ln(k+\\mu))$$\n这就是作为 $k$ 和 $\\mu$ 的函数的对数似然。\n\n3.  **矩估计法 (MoM) 估计**\n\n为了找到 $k$ 的 MoM 估计量，我们首先需要 $Y$ 的边际分布的理论均值和方差。我们使用全期望定律和全方差定律。\n$Y$ 的均值是：\n$$E[Y] = E[E[Y \\mid \\Lambda]] = E[\\Lambda]$$\n因为 $\\Lambda \\sim \\text{Gamma}(k, \\theta)$，均值为 $\\mu = k\\theta$，所以我们有 $E[Y] = \\mu$。\n$Y$ 的方差是：\n$$Var(Y) = E[Var(Y \\mid \\Lambda)] + Var(E[Y \\mid \\Lambda])$$\n对于泊松分布，$Var(Y \\mid \\Lambda) = \\Lambda$ 且 $E[Y \\mid \\Lambda] = \\Lambda$。因此：\n$$Var(Y) = E[\\Lambda] + Var(\\Lambda)$$\n一个 $\\text{Gamma}(k, \\theta)$ 分布的方差是 $k\\theta^2$。所以：\n$$Var(Y) = k\\theta + k\\theta^2$$\n我们通过代入 $\\theta = \\mu/k$ 将其表示为 $\\mu$ 和 $k$ 的函数：\n$$Var(Y) = k\\left(\\frac{\\mu}{k}\\right) + k\\left(\\frac{\\mu}{k}\\right)^2 = \\mu + k\\frac{\\mu^2}{k^2} = \\mu + \\frac{\\mu^2}{k}$$\n矩估计法将这些理论矩与相应的经验矩相等同。经验均值是 $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i$，经验总体方差是 $s^2 = \\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\bar{y})^2$。\nMoM 方程是：\n1.  $\\hat{\\mu}_{MoM} = \\bar{y}$\n2.  $\\hat{\\sigma}^2_{MoM} = s^2 = \\hat{\\mu}_{MoM} + \\frac{\\hat{\\mu}_{MoM}^2}{\\hat{k}_{MoM}}$\n\n从第二个方程中，我们求解 $k$ 的 MoM 估计量，记为 $\\hat{k}_{MoM}$：\n$$s^2 = \\bar{y} + \\frac{\\bar{y}^2}{\\hat{k}_{MoM}} \\implies s^2 - \\bar{y} = \\frac{\\bar{y}^2}{\\hat{k}_{MoM}}$$\n$$\\hat{k}_{MoM} = \\frac{\\bar{y}^2}{s^2 - \\bar{y}}$$\n注意，要使这个估计量为正，样本方差 $s^2$ 必须大于样本均值 $\\bar{y}$，这个条件被称为过度离势（相对于方差等于均值的泊松模型）。\n\n4.  **数值计算**\n\n提供的数据是 $n=12$ 周的每周计数：\n$$y = (4, 9, 7, 12, 3, 11, 0, 8, 14, 5, 6, 10)$$\n首先，我们计算样本均值 $\\bar{y}$：\n$$\\sum_{i=1}^{12} y_i = 4+9+7+12+3+11+0+8+14+5+6+10 = 89$$\n$$\\bar{y} = \\frac{89}{12}$$\n接下来，我们计算样本总体方差 $s^2$。我们首先找到平方和：\n$$\\sum_{i=1}^{12} y_i^2 = 16+81+49+144+9+121+0+64+196+25+36+100 = 841$$\n$$s^2 = \\frac{1}{n} \\sum_{i=1}^{n} y_i^2 - \\bar{y}^2 = \\frac{841}{12} - \\left(\\frac{89}{12}\\right)^2 = \\frac{841 \\times 12 - 89^2}{144} = \\frac{10092 - 7921}{144} = \\frac{2171}{144}$$\n样本方差 $s^2 \\approx 15.076$ 确实大于样本均值 $\\bar{y} \\approx 7.417$，所以数据是过度离势的。\n现在我们可以计算 $k$ 的 MoM 估计：\n$$\\hat{k}_{MoM} = \\frac{\\bar{y}^2}{s^2 - \\bar{y}} = \\frac{\\left(\\frac{89}{12}\\right)^2}{\\frac{2171}{144} - \\frac{89}{12}} = \\frac{\\frac{7921}{144}}{\\frac{2171 - (89 \\times 12)}{144}} = \\frac{7921}{2171 - 1068} = \\frac{7921}{1103}$$\n$$\\hat{k}_{MoM} \\approx 7.18132366...$$\n四舍五入到四位有效数字，离散参数 $k$ 的 MoM 估计是 $7.181$。", "answer": "$$\\boxed{7.181}$$", "id": "4980516"}, {"introduction": "尽管大样本正态近似非常强大，但在处理罕见事件或稀疏计数时，它们可能并不可靠，而这在医疗安全监测中是很常见的情况。这个问题 [@problem_id:4980553] 挑战你识别二项和泊松数据中这些近似方法的失效模式，并选择适当的“精确”统计方法。掌握这种区分对于在渐近假设不成立时进行严谨分析至关重要。", "problem": "一家医院的质量监控项目评估罕见的术后并发症。在一个队列中，据信每位患者发生败血症的概率极小。在固定的时间段内，研究人员收集了以下数据：在接受新预防方案的 $n_1=400$ 名患者中，有 $x_1=2$ 人出现败血症；在同期接受标准护理的 $n_0=400$ 名患者的对照组队列中，有 $x_0=6$ 人出现败血症。在另一项输液安全审计中，一个肿瘤中心在 $T=2500$ 次独立输液中观察到 $k=1$ 例过敏性休克，并用泊松过程对输液计数进行建模。\n\n一位分析师建议使用正态近似来执行假设检验，并为二项式比例和泊松率构建置信区间（confidence interval (CI)）。您必须评估这些正态近似在何种情况下以及为何会因极端概率或稀疏计数而失效，并且必须使用精确方法提出有科学依据的补救措施。\n\n您的推理应基于以下基本且广为接受的定义和事实：\n- 如果 $X \\sim \\mathrm{Binomial}(n,p)$，则其概率质量函数为 $P(X=x)=\\binom{n}{x}p^{x}(1-p)^{n-x}$，其中 $x\\in\\{0,1,\\dots,n\\}$，并且 $E[X]=np$，$\\mathrm{Var}(X)=np(1-p)$。\n- 如果 $Y \\sim \\mathrm{Poisson}(\\lambda)$，则其概率质量函数为 $P(Y=y)=e^{-\\lambda}\\lambda^{y}/y!$，其中 $y\\in\\{0,1,2,\\dots\\}$，并且 $E[Y]=\\lambda$，$\\mathrm{Var}(Y)=\\lambda$。\n- 中心极限定理（CLT）指出，只要满足某些正则性条件，随着项数的增加，经过适当标准化的独立同分布随机变量之和在分布上会收敛于正态定律。\n\n以下哪些陈述正确地指出了在上述情境中正态近似的失效模式，并提出了适当的精确方法补救措施？选择所有适用项。\n\nA. 对于 $p$ 接近 $0$ 或 $1$ 的 $X\\sim \\mathrm{Binomial}(n,p)$，当 $n\\hat{p}(1-\\hat{p})$ 很小时（例如在 $\\hat{p}=x_1/n_1=2/400$ 的情况下），样本比例的抽样分布的正态近似会失效；此时应使用精确二项检验和通过反转二项累积分布函数获得的精确二项置信区间（例如，Clopper–Pearson 区间）。\n\nB. 只要 $n\\hat{p}\\ge 5$ 或 $n(1-\\hat{p})\\ge 5$，单独使用连续性校正就能使正态近似变得可接受；因此，对于 $\\hat{p}=6/400$ 的对照组队列，正态近似是可接受的。\n\nC. 对于具有稀疏计数的 $Y\\sim \\mathrm{Poisson}(\\lambda)$，例如观察到 $k=1$ 个事件且期望计数 $\\lambda$ 接近 $0$ 时，均值为 $\\lambda$、方差为 $\\lambda$ 的正态近似是不可靠的；应通过反转泊松累积分布函数来获得精确的单样本泊松检验和置信区间。\n\nD. 当使用基于正态分布的二项置信区间时，将 $\\hat{p}$ 替换为调整后的估计量 $\\tilde{p}=\\dfrac{\\hat{p}+2/n}{1+4/n}$ 能确保对所有 $n$ 和 $p$ 都具有精确的覆盖率。\n\nE. 在一个具有稀有事件和固定边际的 $2\\times 2$ 表格中，Fisher 精确检验提供了一种检验比例相等性的精确方法，而无需依赖渐近正态近似；它适用于比较 $n_1=400$ 中的 $x_1=2$ 与 $n_0=400$ 中的 $x_0=6$。\n\nF. 当在二项样本中观察到 $x=0$ 个事件时，正态近似会失效，因为 $\\hat{p}(1-\\hat{p})=0$，但切换到对数几率（logit）尺度上的正态近似，即 $\\mathrm{logit}(\\hat{p})$，总是能为真实的 $p$ 产生精确的覆盖率。", "solution": "### 问题验证\n\n#### 步骤 1：提取已知条件\n\n-   败血症数据（预防方案队列）：$n_1=400$ 名患者，$x_1=2$ 例败血症病例。\n-   败血症数据（对照组队列）：$n_0=400$ 名患者，$x_0=6$ 例败血症病例。\n-   输液安全数据：在 $T=2500$ 次独立输液中发生 $k=1$ 例过敏性休克事件。输液计数的模型是一个泊松过程。\n-   二项分布定义：对于 $X \\sim \\mathrm{Binomial}(n,p)$，$P(X=x)=\\binom{n}{x}p^{x}(1-p)^{n-x}$，$E[X]=np$，$\\mathrm{Var}(X)=np(1-p)$。\n-   泊松分布定义：对于 $Y \\sim \\mathrm{Poisson}(\\lambda)$，$P(Y=y)=e^{-\\lambda}\\lambda^{y}/y!$，$E[Y]=\\lambda$，$\\mathrm{Var}(Y)=\\lambda$。\n-   中心极限定理（CLT）被陈述为正态近似的基础。\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n1.  **科学性**：该问题基于计数数据和比例分析的标准统计理论，这是生物统计学和流行病学的基本组成部分。所描述的情景（术后并发症、输液安全）是现实的医疗监视背景。二项分布和泊松分布的定义是正确的。引用中心极限定理作为正态近似的理论基础是恰当的。\n2.  **良构性**：该问题要求评估关于正态近似有效性和精确方法效用的陈述。所提供的数据足以评估这些统计概念。问题的结构旨在测试对统计原理的理解，并且可以确定一组明确的正确/错误陈述。\n3.  **客观性**：语言精确客观。它呈现了数据和标准统计定义，没有偏见或主观论断。任务是基于这些客观事实来评估陈述。\n4.  **未检测到其他缺陷**：该问题并非不完整、矛盾、不切实际、病态、琐碎或超出科学可验证性的范围。数据值，如低事件计数（$2$, $6$, $1$），是特意选择的，用以探究渐近统计方法的已知局限性，这是一个标准的教学目标。\n\n#### 步骤 3：结论与行动\n\n问题陈述是**有效的**。这是一个在应用统计学中表述良好的问题。我现在将通过评估每个选项来给出解答。\n\n### 解答推导\n\n问题的核心是评估当事件概率极低（或极高）或观测计数稀疏时，离散分布（二项分布、泊松分布）的正态近似的失效情况。在这些情况下，分布高度偏斜，违反了正态分布所假设的对称性。\n\n**A. 对于 $p$ 接近 $0$ 或 $1$ 的 $X\\sim \\mathrm{Binomial}(n,p)$，当 $n\\hat{p}(1-\\hat{p})$ 很小时（例如在 $\\hat{p}=x_1/n_1=2/400$ 的情况下），样本比例的抽样分布的正态近似会失效；此时应使用精确二项检验和通过反转二项累积分布函数获得的精确二项置信区间（例如，Clopper–Pearson 区间）。**\n\n-   **分析**：二项分布的正态近似由 De Moivre-Laplace 定理（中心极限定理的一个特例）证明。一个常见的关于此近似是否充分的经验法则是，期望的成功次数 $np$ 和期望的失败次数 $n(1-p)$ 都应足够大（例如，$\\geq 5$ 或 $\\geq 10$）。当 $p$ 接近 $0$ 或 $1$ 时，除非 $n$ 非常大，否则二项分布是高度偏斜的。在给定案例中，$\\hat{p}_1 = x_1/n_1 = 2/400 = 0.005$。观测到的成功次数是 $x_1=2$。估计的期望成功次数是 $n_1\\hat{p}_1 = 2$，低于通常的阈值 $5$。量 $n\\hat{p}(1-\\hat{p})$ 是计数 $X$ 的估计方差，即 $400(0.005)(0.995) = 1.99$。这个小值表明抽样分布高度偏斜，对称的正态近似对其效果不佳。建议的补救措施是使用“精确”方法。Clopper-Pearson 区间是通过找到 $p_L$ 和 $p_U$ 构建的，使得 $P(X \\ge x | p_U) = \\alpha/2$ 和 $P(X \\le x | p_L) = \\alpha/2$，这涉及到反转二项累积分布函数（CDF）。这种方法被称为“精确”方法，因为它直接使用二项分布，并保证对所有 $p$ 值，其覆盖概率至少为 $1-\\alpha$。该陈述准确地描述了失效模式和标准的、正确的补救措施。\n-   **结论**：**正确**。\n\n**B. 只要 $n\\hat{p}\\ge 5$ 或 $n(1-\\hat{p})\\ge 5$，单独使用连续性校正就能使正态近似变得可接受；因此，对于 $\\hat{p}=6/400$ 的对照组队列，正态近似是可接受的。**\n\n-   **分析**：该陈述有两个主要缺陷。首先，正态近似的经验法则是 $n\\hat{p}$ **和** $n(1-\\hat{p})$ 都必须足够大，而不是“$n\\hat{p} \\ge 5$ **或** $n(1-\\hat{p}) \\ge 5$”。使用“或”是错误的。举一个反例，如果 $x=0$，那么 $\\hat{p}=0$，所以 $n\\hat{p}=0$。然而，$n(1-\\hat{p})=n$，对于大的 $n$ 会满足“或”条件，但当 $x=0$ 时，正态近似非常不准确。其次，对于对照组队列，$n_0=400$ 且 $x_0=6$。因此 $\\hat{p}_0 = 6/400 = 0.015$。成功次数是 $n_0\\hat{p}_0 = 6$，失败次数是 $n_0(1-\\hat{p}_0) = 394$。虽然 $6$ 达到了阈值 $5$，但它仍然是一个小数目，并且比例的潜在分布是偏斜的。连续性校正是一种改进，但它并不能完全解决偏度问题，声称近似变得“可接受”是夸大其词。更精确的方法（例如，Wilson score、Agresti-Coull 或精确方法）更可取。然而，主要错误在于标准中的“或”字。\n-   **结论**：**不正确**。\n\n**C. 对于具有稀疏计数的 $Y\\sim \\mathrm{Poisson}(\\lambda)$，例如观察到 $k=1$ 个事件且期望计数 $\\lambda$ 接近 $0$ 时，均值为 $\\lambda$、方差为 $\\lambda$ 的正态近似是不可靠的；应通过反转泊松累积分布函数来获得精确的单样本泊松检验和置信区间。**\n\n-   **分析**：泊松分布的正态近似 $Y \\sim \\mathrm{N}(\\lambda, \\lambda)$ 在 $\\lambda$ 较大时有效。对于输液安全审计，我们观察到 $k=1$ 个事件。参数 $\\lambda$（该时期内的期望事件数）的最大似然估计是 $\\hat{\\lambda}=1$。一个 $\\lambda=1$ 的泊松分布是高度偏斜的：$P(Y=0) \\approx 0.368$，$P(Y=1) \\approx 0.368$，$P(Y=2) \\approx 0.184$。这与对称的钟形正态曲线相去甚远。因此，正态近似确实是不可靠的。建议的补救措施是“精确”方法，与二项情况类似，它涉及反转泊松 CDF 以找到置信限 $\\lambda_L$ 和 $\\lambda_U$。具体来说，对于观测值 $k$ 和置信水平 $1-\\alpha$，区间由方程 $P(Y \\ge k | \\lambda=\\lambda_L) = \\alpha/2$ 和 $P(Y \\le k | \\lambda=\\lambda_U) = \\alpha/2$ 导出。这是在计数较小时为泊松参数获取置信区间的标准、理论上合理的过程。\n-   **结论**：**正确**。\n\n**D. 当使用基于正态分布的二项置信区间时，将 $\\hat{p}$ 替换为调整后的估计量 $\\tilde{p}=\\dfrac{\\hat{p}+2/n}{1+4/n}$ 能确保对所有 $n$ 和 $p$ 都具有精确的覆盖率。**\n\n-   **分析**：该估计量 $\\tilde{p}=\\dfrac{\\hat{p}+2/n}{1+4/n} = \\dfrac{x/n+2/n}{1+4/n} = \\dfrac{x+2}{n+4}$。使用此估计量的基于正态分布的区间是 Agresti-Coull 区间。尽管该区间已被证明具有优异的性能，其平均覆盖概率非常接近名义水平，但它不提供“精确”的覆盖率。“精确覆盖率”一词意味着对于任何给定的真实 $p$，覆盖概率恰好是 $1-\\alpha$。任何基于连续近似（正态）来处理离散分布（二项）的区间都无法实现这一点。任何此类区间的覆盖概率都随 $p$ 的函数而波动。即使是 Clopper-Pearson 的“精确”区间也没有精确的覆盖率；它是保守的，意味着其覆盖率保证为 $\\ge 1-\\alpha$，但并非恰好是 $1-\\alpha$。声称 Agresti-Coull 区间为“所有 $n$ 和 $p$”提供“精确覆盖率”是错误的。\n-   **结论**：**不正确**。\n\n**E. 在一个具有稀有事件和固定边际的 $2\\times 2$ 表格中，Fisher 精确检验提供了一种检验比例相等性的精确方法，而无需依赖渐近正态近似；它适用于比较 $n_1=400$ 中的 $x_1=2$ 与 $n_0=400$ 中的 $x_0=6$。**\n\n-   **分析**：两个队列之间的比较可以用一个 $2\\times 2$ 列联表来表示，表中包含败血症/无败血症与方案/对照的计数。计数分别为 $(x_1, n_1-x_1)$ 和 $(x_0, n_0-x_0)$，即 $(2, 398)$ 和 $(6, 394)$。Fisher 精确检验就是为此类表格设计的。它计算在边际总计（行总计 $400, 400$；列总计 $8, 792$）固定的条件下，观察到给定表格以及所有其他更极端表格的概率。该概率使用超几何分布计算。该方法是“精确的”，因为它不依赖任何大样本近似，例如卡方分布，而卡方分布本身是基于正态近似的。它是 $2\\times 2$ 表格中假设检验的黄金标准，尤其是在事件计数很小的情况下（如此处的 $2$ 和 $6$），这使得卡方近似不太可靠。因此，该陈述正确地指出了针对此特定比较的适当精确方法。\n-   **结论**：**正确**。\n\n**F. 当在二项样本中观察到 $x=0$ 个事件时，正态近似会失效，因为 $\\hat{p}(1-\\hat{p})=0$，但切换到对数几率（logit）尺度上的正态近似，即 $\\mathrm{logit}(\\hat{p})$，总是能为真实的 $p$ 产生精确的覆盖率。**\n\n-   **分析**：陈述的第一部分是正确的。当 $x=0$ 时，$\\hat{p}=0$，标准 Wald 区间 $\\hat{p} \\pm z_{\\alpha/2}\\sqrt{\\hat{p}(1-\\hat{p})/n}$ 会坍缩为点 $[0,0]$，这是毫无意义的。正态近似会灾难性地失败。第二部分提出了一个补救措施：对 $\\mathrm{logit}(\\hat{p})$ 使用正态近似。然而，$\\mathrm{logit}(\\hat{p}) = \\log(\\hat{p}/(1-\\hat{p}))$。如果 $\\hat{p}=0$，则 $\\mathrm{logit}(0)$ 是未定义的（$\\mathrm{logit}(\\hat{p})$ 的方差估计量也同样未定义）。因此，所述方法甚至无法应用。虽然有一些变通方法（例如，向 $x$ 和 $n-x$ 添加一个小的常数如 $0.5$），但得到的区间仍然是一个近似。声称它“总是能产生精确的覆盖率”是错误的，原因与选项 D 中相同：对于离散参数，没有基于连续近似的区间能对所有参数值都具有精确的覆盖率。\n-   **结论**：**不正确**。\n\n### 正确选项总结\n陈述 A、C 和 E 在稀疏数据的背景下正确地指出了正态近似的失效，并提出了适当的、理论上合理的“精确”补救措施。", "answer": "$$\\boxed{ACE}$$", "id": "4980553"}]}