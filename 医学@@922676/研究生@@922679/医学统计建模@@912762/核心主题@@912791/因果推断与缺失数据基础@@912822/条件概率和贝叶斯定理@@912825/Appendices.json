{"hands_on_practices": [{"introduction": "在医学研究中，混杂偏倚是一个常见的问题，即第三个变量会扭曲治疗与结局之间的关系。本练习通过一个关于脓毒症治疗的真实场景，展示了辛普森悖论。通过解决这个问题 [@problem_id:4956904]，你将亲身体会到为什么在观察性研究中，对混杂因素进行条件控制（分层分析）对于得出有效结论至关重要。", "problem": "一家医院对疑似脓毒症患者进行了一项观察性队列研究，使用序贯性器官功能衰竭评估（SOFA）评分对基线严重程度进行分层。设 $H$ 表示事件“高基线严重程度”，$L$ 表示事件“低基线严重程度”，由预先设定的 SOFA 阈值确定。设 $T$ 表示事件“患者接受了新的辅助治疗”，$C$ 表示事件“患者未接受辅助治疗”。设 $S$ 表示事件“患者存活至 $30$ 天”。该队列包含以下计数，这些计数是前瞻性记录的，并使用标准定义进行裁定：\n\n- 在 $H$ 层（高严重程度层）：$900$ 名接受治疗的患者（$T$），其中 $270$ 人存活（$S$），$630$ 人未存活（$\\neg S$）；以及 $100$ 名未接受治疗的患者（$C$），其中 $20$ 人存活，$80$ 人未存活。\n- 在 $L$ 层（低严重程度层）：$100$ 名接受治疗的患者（$T$），其中 $90$ 人存活，$10$ 人未存活；以及 $900$ 名未接受治疗的患者（$C$），其中 $720$ 人存活，$180$ 人未存活。\n\n根据条件概率和全概率定律的基本定义，严谨地阐述在观测性医疗数据中，辛普森悖论在对协变量进行条件化方面的含义，并解释为什么按严重程度的混杂会导致在跨层汇总时出现方向逆转。使用记录的计数为每个分层和汇总后的队列构建 $2 \\times 2$ 表格，并证明该疗法在每个分层内都是有益的（在 $T$ 条件下的存活率高于在 $C$ 条件下的存活率），但在分层汇总后却显得有害。\n\n然后，仅使用概率公理和核心定义，不使用任何快捷公式，推导出后验概率 $P(H \\mid S, T)$，并根据所提供的数据计算其数值。将所有概率表示为小数。将最终数值答案四舍五入到四位有效数字。", "solution": "该问题要求使用提供的观测数据阐述和演示辛普森悖论，并推导和计算一个特定的后验概率。分析分两部分进行。\n\n首先，我们讨论辛普森悖论现象。辛普森悖论指的是，在数据的各个子组中观察到的关联或趋势，在子组合并后方向发生逆转。在医学统计学中，这通常是由一个混杂变量引起的，该变量与暴露（例如，治疗）和结局（例如，存活）都相关。如果不加以考虑，该混杂变量会在汇总（粗略）数据中产生虚假的关联。\n\n在这个问题中，暴露是辅助治疗（事件 $T$ 代表治疗组，$C$ 代表对照组），结局是存活（事件 $S$），潜在的混杂变量是疾病的基线严重程度，分为高严重程度（$H$）和低严重程度（$L$）。如果一个变量是暴露和结局的共同原因，或者由于其他原因与两者都相关，并且不在它们之间的因果路径上，那么它就是一个混杂变量。我们必须验证严重程度是否充当了混杂变量。\n\n1.  **严重程度与治疗（暴露）之间的关联**：我们检查病情较重的患者接受该疗法的可能性是更高还是更低。给定高严重程度下接受治疗的概率是 $P(T \\mid H)$，给定低严重程度下是 $P(T \\mid L)$。\n    根据数据，高严重程度患者的总数是 $N(H) = N(H, T) + N(H, C) = 900 + 100 = 1000$。接受治疗的高严重程度患者人数是 $N(H, T) = 900$。\n    因此，$P(T \\mid H) = \\frac{N(H, T)}{N(H)} = \\frac{900}{1000} = 0.9$。\n    低严重程度患者的总数是 $N(L) = N(L, T) + N(L, C) = 100 + 900 = 1000$。接受治疗的低严重程度患者人数是 $N(L, T) = 100$。\n    因此，$P(T \\mid L) = \\frac{N(L, T)}{N(L)} = \\frac{100}{1000} = 0.1$。\n    由于 $P(T \\mid H) = 0.9$ 与 $P(T \\mid L) = 0.1$ 有显著差异，严重程度与治疗分配之间存在强关联。高严重程度的患者更有可能接受新疗法。这是“指征混杂”的一个典型例子。\n\n2.  **严重程度与存活（结局）之间的关联**：我们检查严重程度是否独立地与存活结局相关。我们可以通过比较两个分层中的总体存活率 $P(S \\mid H)$ 和 $P(S \\mid L)$ 来评估这一点。\n    高严重程度分层中的存活者人数是 $N(S, H) = N(S, H, T) + N(S, H, C) = 270 + 20 = 290$。\n    因此，$P(S \\mid H) = \\frac{N(S, H)}{N(H)} = \\frac{290}{1000} = 0.29$。\n    低严重程度分层中的存活者人数是 $N(S, L) = N(S, L, T) + N(S, L, C) = 90 + 720 = 810$。\n    因此，$P(S \\mid L) = \\frac{N(S, L)}{N(L)} = \\frac{810}{1000} = 0.81$。\n    由于 $P(S \\mid H) = 0.29$ 远低于 $P(S \\mid L) = 0.81$，基线严重程度是存活的一个强有力的预测因素。\n\n因为严重程度与治疗选择和存活都相关，所以它是一个混杂变量。按严重程度的混杂可能导致方向逆转，因为对治疗组与未治疗组的汇总比较并非公平的比较。治疗组中不成比例地由预后较差的高严重程度患者组成（$1000$ 名治疗患者中有 $900$ 名是高严重程度），而未治疗组中不成比例地由预后较好的低严重程度患者组成（$1000$ 名未治疗患者中有 $900$ 名是低严重程度）。这种构成上的不平衡使粗略分析产生偏倚，可能掩盖了真实的治疗效益，甚至使其表面上的方向发生逆转。\n\n为了证明这一点，我们计算分层特异性和汇总后的效应。\n\n**分层分析：**\n\n对于高严重程度（$H$）分层，其 $2 \\times 2$ 表格如下：\n\\begin{center}\n\\begin{tabular}{|l|c|c|c|}\n\\hline\n\\textbf{高严重程度}  存活 ($S$)  未存活 ($\\neg S$)  总计 \\\\\n\\hline\n治疗组 ($T$)  $270$  $630$  $900$ \\\\\n对照组 ($C$)  $20$  $80$  $100$ \\\\\n\\hline\n总计  $290$  $710$  $1000$ \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n在该分层中，给定接受治疗条件下的存活概率为 $P(S \\mid H, T) = \\frac{N(S, H, T)}{N(H, T)} = \\frac{270}{900} = 0.3$。\n给定未接受治疗（对照组）条件下的存活概率为 $P(S \\mid H, C) = \\frac{N(S, H, C)}{N(H, C)} = \\frac{20}{100} = 0.2$。\n由于 $P(S \\mid H, T) > P(S \\mid H, C)$（$0.3 > 0.2$），该疗法对于高严重程度患者似乎是有益的。\n\n对于低严重程度（$L$）分层，其 $2 \\times 2$ 表格如下：\n\\begin{center}\n\\begin{tabular}{|l|c|c|c|}\n\\hline\n\\textbf{低严重程度}  存活 ($S$)  未存活 ($\\neg S$)  总计 \\\\\n\\hline\n治疗组 ($T$)  $90$  $10$  $100$ \\\\\n对照组 ($C$)  $720$  $180$  $900$ \\\\\n\\hline\n总计  $810$  $190$  $1000$ \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n在该分层中，给定接受治疗条件下的存活概率为 $P(S \\mid L, T) = \\frac{N(S, L, T)}{N(L, T)} = \\frac{90}{100} = 0.9$。\n给定未接受治疗（对照组）条件下的存活概率为 $P(S \\mid L, C) = \\frac{N(S, L, C)}{N(L, C)} = \\frac{720}{900} = 0.8$。\n由于 $P(S \\mid L, T) > P(S \\mid L, C)$（$0.9 > 0.8$），该疗法对于低严重程度患者似乎也是有益的。\n\n**汇总（粗略）分析：**\n\n我们合并两个分层的计数，得到汇总的 $2 \\times 2$ 表格：\n总治疗患者数：$N(T) = 900+100=1000$。总治疗存活者数：$N(S, T) = 270+90=360$。\n总对照患者数：$N(C) = 100+900=1000$。总对照存活者数：$N(S, C) = 20+720=740$。\n汇总表格如下：\n\\begin{center}\n\\begin{tabular}{|l|c|c|c|}\n\\hline\n\\textbf{汇总数据}  存活 ($S$)  未存活 ($\\neg S$)  总计 \\\\\n\\hline\n治疗组 ($T$)  $360$  $640$  $1000$ \\\\\n对照组 ($C$)  $740$  $260$  $1000$ \\\\\n\\hline\n总计  $1100$  $900$  $2000$ \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n给定接受治疗的总体存活概率为 $P(S \\mid T) = \\frac{N(S, T)}{N(T)} = \\frac{360}{1000} = 0.36$。\n给定未接受治疗的总体存活概率为 $P(S \\mid C) = \\frac{N(S, C)}{N(C)} = \\frac{740}{1000} = 0.74$。\n在汇总数据中，$P(S \\mid T)  P(S \\mid C)$（$0.36  0.74$），这表明该疗法是有害的。这种与分层分析（$0.3 > 0.2$ 和 $0.9 > 0.8$）结论的逆转正是辛普森悖论。控制了混杂变量的分层分析，提供了对该疗法效果的正确评估。\n\n现在，我们进行问题的第二部分：推导并计算后验概率 $P(H \\mid S, T)$。这是在已知患者存活并接受了治疗的情况下，该患者具有高基线严重程度的概率。\n\n我们从条件概率的核心定义开始，该定义指出，对于任意两个事件 $A$ 和 $B$，当 $P(B)>0$ 时，$P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$。\n设我们感兴趣的事件为 $A=H$，我们的条件事件为 $B=(S \\cap T)$。我们要求解 $P(H \\mid S \\cap T)$。\n应用该定义：\n$$ P(H \\mid S, T) = \\frac{P(H \\cap S \\cap T)}{P(S \\cap T)} $$\n这些概率可以从提供的计数中估计，其中 $P(\\text{事件}) = \\frac{N(\\text{事件})}{N(\\text{总数})}$。设 $N_{total}$ 为队列中的患者总数，$N_{total}=2000$。\n分子是 $P(H \\cap S \\cap T) = \\frac{N(H, S, T)}{N_{total}}$。\n分母 $P(S \\cap T)$ 是患者存活且接受治疗这一联合事件的概率。该事件可以被互斥且完备的严重程度分层 $\\{H, L\\}$ 所划分。使用全概率定律：\n$$ P(S \\cap T) = P((S \\cap T) \\cap H) + P((S \\cap T) \\cap L) = P(H \\cap S \\cap T) + P(L \\cap S \\cap T) $$\n这可以用计数来表示：\n$$ P(S \\cap T) = \\frac{N(H, S, T)}{N_{total}} + \\frac{N(L, S, T)}{N_{total}} = \\frac{N(H, S, T) + N(L, S, T)}{N_{total}} $$\n将这些表达式代回 $P(H \\mid S, T)$ 的公式中：\n$$ P(H \\mid S, T) = \\frac{\\frac{N(H, S, T)}{N_{total}}}{\\frac{N(H, S, T) + N(L, S, T)}{N_{total}}} $$\n$N_{total}$ 项相互抵消，得到一个直接用计数表示的公式：\n$$ P(H \\mid S, T) = \\frac{N(H, S, T)}{N(H, S, T) + N(L, S, T)} $$\n如此推导，仅使用了条件概率的定义和全概率定律，符合题目要求。\n\n现在，我们使用提供的计数来计算其数值：\n根据问题陈述中关于 $H$ 层的数据：$N(H, S, T) = 270$。\n根据问题陈述中关于 $L$ 层的数据：$N(L, S, T) = 90$。\n代入这些值：\n$$ P(H \\mid S, T) = \\frac{270}{270 + 90} = \\frac{270}{360} $$\n简化分数：\n$$ P(H \\mid S, T) = \\frac{27}{36} = \\frac{3 \\times 9}{4 \\times 9} = \\frac{3}{4} $$\n换算成小数为 $0.75$。问题要求答案表示为四位有效数字。", "answer": "$$\\boxed{0.7500}$$", "id": "4956904"}, {"introduction": "在偏倚这一主题的基础上，本练习将引入一个更微妙的挑战：选择偏倚。这个假设性练习揭示了伯克森悖论，在这种情况下，对一个共同效应（如入院）进行条件限制，可能会在两个独立的因素之间产生虚假的关联。这个问题 [@problem_id:4956993] 将提高你识别研究设计和数据收集过程如何引入误导性相关的能力，这对于解读基于医院的研究至关重要。", "problem": "一项基于医院的研究正在调查城市人口中二元风险因素 $R \\in \\{0,1\\}$ 与二元疾病 $D \\in \\{0,1\\}$ 之间的关联，同时认识到可用数据集仅包含住院患者。设 $A \\in \\{0,1\\}$ 表示是否入院。假设在源人群中以下情况为真：\n- 疾病患病率为 $P(D=1)=0.10$，风险因素暴露率为 $P(R=1)=0.30$。\n- 在人群中，风险因素与疾病是独立的，即 $P(R=1,D=1)=P(R=1)P(D=1)$。\n- 入院同时受 $R$ 和 $D$ 的影响，其机制如下：\n  - $P(A=1 \\mid R=1,D=1)=0.50$，\n  - $P(A=1 \\mid R=1,D=0)=0.10$，\n  - $P(A=1 \\mid R=0,D=1)=0.20$，\n  - $P(A=1 \\mid R=0,D=0)=0.01$。\n\n仅使用条件概率、贝叶斯定理以及优势和优势比的定义，并且不使用任何非由这些定义推导出的现成公式，完成以下任务：\n1. 计算在不考虑入院情况时，比较 $R=1$ 与 $R=0$ 的人群疾病优势比。\n2. 计算在入院（$A=1$）的条件下，比较 $R=1$ 与 $R=0$ 的疾病优势比。\n\n按照（人群优势比，住院患者优势比）的顺序报告你的两个数值答案，保留四位有效数字。", "solution": "首先验证问题以确保其是自洽的、一致的且有科学依据的。\n\n### 第1步：提取已知条件\n-   二元风险因素 $R \\in \\{0,1\\}$。\n-   二元疾病 $D \\in \\{0,1\\}$。\n-   二元入院状态 $A \\in \\{0,1\\}$。\n-   人群疾病患病率：$P(D=1) = 0.10$。\n-   人群风险因素暴露率：$P(R=1) = 0.30$。\n-   人群中风险因素和疾病的独立性：$P(R=1, D=1) = P(R=1)P(D=1)$。\n-   入院的条件概率：\n    -   $P(A=1 \\mid R=1, D=1) = 0.50$\n    -   $P(A=1 \\mid R=1, D=0) = 0.10$\n    -   $P(A=1 \\mid R=0, D=1) = 0.20$\n    -   $P(A=1 \\mid R=0, D=0) = 0.01$\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了流行病学中的一个经典场景，称为选择偏倚或对撞因子分层偏倚（具体来说，是 Berkson's paradox 的一种形式）。该框架使用了标准概率论和医学统计学中的定义。该问题在科学上是合理的。\n-   **适定性**：该问题提供了所有必要的概率和一个清晰的独立性假设来定义人群中 $R$ 和 $D$ 的联合分布。问题是具体的，并且有唯一的、可计算的答案。该问题是适定的。\n-   **客观性**：该问题使用精确的、定量的语言陈述，没有主观或模糊的术语。\n-   **一致性和完备性**：所提供的概率是一致的（都在 $0$ 和 $1$ 之间）。信息足以进行所需的计算。例如，$P(D=0) = 1 - P(D=1) = 1 - 0.10 = 0.90$ 且 $P(R=0) = 1 - P(R=1) = 1 - 0.30 = 0.70$。给定的入院条件概率集合覆盖了 $(R,D)$ 的所有四种可能状态。该问题是完备和一致的。\n\n### 第3步：结论与行动\n该问题被判定为有效。将提供完整的解法。\n\n### 解题过程\n\n解题过程按要求分为两部分。首先，我们计算人群优势比，其次，我们计算在入院条件下的优势比。\n\n事件 $E$ 的优势定义为 $\\text{Odds}(E) = \\frac{P(E)}{1-P(E)} = \\frac{P(E)}{P(E^c)}$。\n比较暴露组（$R=1$）与非暴露组（$R=0$）的疾病 $D$ 的优势比（$OR$）定义为：\n$$OR = \\frac{\\text{Odds}(D=1 \\mid R=1)}{\\text{Odds}(D=1 \\mid R=0)} = \\frac{P(D=1 \\mid R=1) / P(D=0 \\mid R=1)}{P(D=1 \\mid R=0) / P(D=0 \\mid R=0)}$$\n\n**第1部分：人群优势比 ($OR_{\\text{pop}}$)**\n\n在总人群中，风险因素 $R$ 和疾病 $D$ 被陈述为独立的。独立性的一个直接推论是，给定 $R$ 的条件下 $D$ 的条件概率等于 $D$ 的边际概率。\n$$P(D=1 \\mid R=1) = P(D=1) = 0.10$$\n$$P(D=1 \\mid R=0) = P(D=1) = 0.10$$\n由此，我们可以计算出各组不患病的概率：\n$$P(D=0 \\mid R=1) = 1 - P(D=1 \\mid R=1) = 1 - 0.10 = 0.90$$\n$$P(D=0 \\mid R=0) = 1 - P(D=1 \\mid R=0) = 1 - 0.10 = 0.90$$\n现在我们计算各组的优势：\n$$\\text{Odds}(D=1 \\mid R=1) = \\frac{P(D=1 \\mid R=1)}{P(D=0 \\mid R=1)} = \\frac{0.10}{0.90} = \\frac{1}{9}$$\n$$\\text{Odds}(D=1 \\mid R=0) = \\frac{P(D=1 \\mid R=0)}{P(D=0 \\mid R=0)} = \\frac{0.10}{0.90} = \\frac{1}{9}$$\n人群优势比是这两个优势的比值：\n$$OR_{\\text{pop}} = \\frac{1/9}{1/9} = 1$$\n优势比为 $1$ 证实了在总人群中风险因素和疾病之间没有关联，这是在独立性假设下的预期结果。\n\n**第2部分：住院患者优势比 ($OR_{A=1}$)**\n\n我们现在计算在入院（$A=1$）条件下的优势比。优势比的公式现在以 $A=1$ 为条件：\n$$OR_{A=1} = \\frac{\\text{Odds}(D=1 \\mid R=1, A=1)}{\\text{Odds}(D=1 \\mid R=0, A=1)} = \\frac{P(D=1 \\mid R=1, A=1) / P(D=0 \\mid R=1, A=1)}{P(D=1 \\mid R=0, A=1) / P(D=0 \\mid R=0, A=1)}$$\n为了计算所需的条件概率，我们首先需要确定人群中 $R$、$D$ 和 $A$ 的联合概率。\n\n首先，我们利用 $R$ 和 $D$ 的独立性，计算人群中对 $r$ 和 $d$ 的所有组合的联合概率 $P(R=r, D=d)$。\n-   $P(R=1, D=1) = P(R=1)P(D=1) = 0.30 \\times 0.10 = 0.03$\n-   $P(R=1, D=0) = P(R=1)P(D=0) = 0.30 \\times (1-0.10) = 0.30 \\times 0.90 = 0.27$\n-   $P(R=0, D=1) = P(R=0)P(D=1) = (1-0.30) \\times 0.10 = 0.70 \\times 0.10 = 0.07$\n-   $P(R=0, D=0) = P(R=0)P(D=0) = (1-0.30) \\times (1-0.10) = 0.70 \\times 0.90 = 0.63$\n\n接下来，我们使用公式 $P(A=1, R=r, D=d) = P(A=1 \\mid R=r, D=d) P(R=r, D=d)$ 计算联合概率 $P(A=1, R=r, D=d)$。\n-   $P(A=1, R=1, D=1) = P(A=1 \\mid R=1, D=1) P(R=1, D=1) = 0.50 \\times 0.03 = 0.0150$\n-   $P(A=1, R=1, D=0) = P(A=1 \\mid R=1, D=0) P(R=1, D=0) = 0.10 \\times 0.27 = 0.0270$\n-   $P(A=1, R=0, D=1) = P(A=1 \\mid R=0, D=1) P(R=0, D=1) = 0.20 \\times 0.07 = 0.0140$\n-   $P(A=1, R=0, D=0) = P(A=1 \\mid R=0, D=0) P(R=0, D=0) = 0.01 \\times 0.63 = 0.0063$\n\n现在我们就可以计算优势比的各项了。优势可以直接从这些联合概率中计算出来。注意对于第一组优势：\n$$\\text{Odds}(D=1 \\mid R=1, A=1) = \\frac{P(D=1 \\mid R=1, A=1)}{P(D=0 \\mid R=1, A=1)} = \\frac{P(D=1, R=1, A=1) / P(R=1, A=1)}{P(D=0, R=1, A=1) / P(R=1, A=1)} = \\frac{P(A=1, R=1, D=1)}{P(A=1, R=1, D=0)}$$\n类似地，对于第二组优势：\n$$\\text{Odds}(D=1 \\mid R=0, A=1) = \\frac{P(A=1, R=0, D=1)}{P(A=1, R=0, D=0)}$$\n代入我们计算出的数值：\n$$\\text{Odds}(D=1 \\mid R=1, A=1) = \\frac{0.0150}{0.0270} = \\frac{15}{27} = \\frac{5}{9}$$\n$$\\text{Odds}(D=1 \\mid R=0, A=1) = \\frac{0.0140}{0.0063} = \\frac{140}{63} = \\frac{20 \\times 7}{9 \\times 7} = \\frac{20}{9}$$\n最后，我们通过计算这两个优势的比值，得到住院患者的优势比：\n$$OR_{A=1} = \\frac{\\text{Odds}(D=1 \\mid R=1, A=1)}{\\text{Odds}(D=1 \\mid R=0, A=1)} = \\frac{5/9}{20/9} = \\frac{5}{20} = \\frac{1}{4} = 0.25$$\n这个结果显示，在住院患者人群中，风险因素与疾病之间存在强烈的负相关，尽管它们在总人群中是独立的。这种关联的反转是选择偏倚的一个经典例子。\n\n这两个数值答案，即人群优势比和住院患者优势比，保留四位有效数字后分别为 $1.000$ 和 $0.2500$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.000  0.2500 \\end{pmatrix}}\n$$", "id": "4956993"}, {"introduction": "在探讨了条件化如何带来陷阱之后，我们现在转向利用贝叶斯定理发挥其建设性力量。本练习展示了贝叶斯推断的核心：根据新证据更新我们对参数的信念。你将为一个人工智能模型的感染标记概率计算后验分布 [@problem_id:5220970]，从而阐明如何将先验知识与观测数据相结合，以获得更精确、基于证据的理解。", "problem": "一家医院部署了一个人工智能（AI）临床决策支持模型，用于从可穿戴设备的体温数据流中标记早期术后感染。在一个针对 $n=157$ 名患者的新手术队列的24小时监测窗口中，该系统标记了 $x=41$ 个病例，这些病例后来通过微生物学金标准测试被确认为真实感染。为了更新该感染标记模型的参数 $\\theta$（即该队列中每位受监测患者的真实感染概率），一位贝叶斯实践者指定了一个反映可信历史数据的贝塔先验：$\\theta \\sim \\text{Beta}(\\alpha,\\beta)$，其中 $\\alpha=2.3$ 且 $\\beta=5.7$。该实践者将队列数据建模为 $X \\mid \\theta \\sim \\text{Binomial}(n,\\theta)$。\n\n从概率公理和条件概率的定义出发，通过应用贝叶斯定理，使用二项分布模型的标准概率质量函数和贝塔先验的标准概率密度函数，推导出后验分布 $p(\\theta \\mid x)$ 的闭合形式。然后，推导出后验均值 $\\mathbb{E}[\\theta \\mid x]$ 的闭合形式解析表达式，并根据给定参数计算其数值。\n\n将最终数值答案表示为小数，并四舍五入到四位有效数字。不需要单位。", "solution": "该问题要求推导一个贝叶斯推断问题中的后验分布 $p(\\theta \\mid x)$ 和后验均值 $\\mathbb{E}[\\theta \\mid x]$，并计算后验均值的数值。\n\n首先，我们验证问题陈述的有效性。\n给定条件如下：\n-   患者数量（试验次数）为 $n=157$。\n-   观察到的感染数量（成功次数）为 $x=41$。\n-   数据 $X$ 在给定参数 $\\theta$ 的条件下被建模为二项分布，记作 $X \\mid \\theta \\sim \\text{Binomial}(n,\\theta)$。\n-   真实感染概率 $\\theta$ 的先验分布是贝塔分布，$\\theta \\sim \\text{Beta}(\\alpha,\\beta)$。\n-   先验分布的参数为 $\\alpha=2.3$ 和 $\\beta=5.7$。\n\n该问题具有科学依据，提法恰当且客观。它描述了使用共轭先验进行贝叶斯推断的一个标准应用，这是统计学和数据科学中的一项基本技术。所有必要信息均已提供，没有矛盾或含糊之处。该问题是有效的。\n\n我们首先陈述针对连续参数 $\\theta$ 和离散数据 $x$ 的贝叶斯定理。该定理源于条件概率的定义，$P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$。对于连续和离散随机变量，此关系以概率密度函数（PDF）和概率质量函数（PMF）的形式表示为：\n$$p(\\theta \\mid x) = \\frac{p(x \\mid \\theta) p(\\theta)}{p(x)}$$\n这里，$p(\\theta \\mid x)$ 是给定数据 $x$ 时 $\\theta$ 的后验概率密度函数，$p(x \\mid \\theta)$ 是给定参数 $\\theta$ 时观测到数据 $x$ 的似然，$p(\\theta)$ 是 $\\theta$ 的先验概率密度函数，而 $p(x)$ 是数据的边际似然（也称为证据），它充当归一化常数。边际似然由积分 $p(x) = \\int p(x \\mid \\theta) p(\\theta) \\, d\\theta$ 给出。\n\n我们也可以用比例关系来表示贝叶斯定理，因为 $p(x)$ 相对于 $\\theta$ 是一个常数：\n$$p(\\theta \\mid x) \\propto p(x \\mid \\theta) p(\\theta)$$\n\n问题指定了似然函数和先验分布。\n似然函数 $p(x \\mid \\theta)$ 由二项分布 $\\text{Binomial}(n, \\theta)$ 的概率质量函数（PMF）给出：\n$$p(x \\mid \\theta) = \\binom{n}{x} \\theta^x (1-\\theta)^{n-x}$$\n对于 $x \\in \\{0, 1, \\dots, n\\}$。\n\n先验分布 $p(\\theta)$ 由贝塔分布 $\\text{Beta}(\\alpha, \\beta)$ 的概率密度函数（PDF）给出：\n$$p(\\theta) = \\frac{\\theta^{\\alpha-1} (1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)}$$\n对于 $\\theta \\in [0, 1]$。这里，$B(\\alpha, \\beta)$ 是贝塔函数，作为先验的归一化常数，定义为 $B(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$。\n\n现在我们将似然函数和先验分布结合起来，以求得后验分布：\n$$p(\\theta \\mid x) \\propto p(x \\mid \\theta) p(\\theta)$$\n$$p(\\theta \\mid x) \\propto \\left[ \\binom{n}{x} \\theta^x (1-\\theta)^{n-x} \\right] \\left[ \\frac{\\theta^{\\alpha-1} (1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)} \\right]$$\n\n由于我们正在寻找后验分布关于 $\\theta$ 的函数形式，我们可以省略所有相对于 $\\theta$ 为常数的项。这些项包括 $\\binom{n}{x}$ 和 $B(\\alpha, \\beta)$。\n$$p(\\theta \\mid x) \\propto \\theta^x (1-\\theta)^{n-x} \\cdot \\theta^{\\alpha-1} (1-\\theta)^{\\beta-1}$$\n合并 $\\theta$ 和 $(1-\\theta)$ 的幂：\n$$p(\\theta \\mid x) \\propto \\theta^{x+\\alpha-1} (1-\\theta)^{n-x+\\beta-1}$$\n\n这种函数形式是贝塔分布的核。我们可以识别出这是一个具有更新参数的贝塔概率密度函数。设后验参数为 $\\alpha' = \\alpha+x$ 和 $\\beta' = \\beta+n-x$。因此，后验分布为：\n$$\\theta \\mid x \\sim \\text{Beta}(\\alpha+x, \\beta+n-x)$$\n后验概率密度函数的闭合形式表达式为：\n$$p(\\theta \\mid x) = \\frac{\\theta^{(\\alpha+x)-1} (1-\\theta)^{(\\beta+n-x)-1}}{B(\\alpha+x, \\beta+n-x)}$$\n这证明了贝塔先验和二项似然之间的共轭性。\n\n接下来，我们必须推导后验均值 $\\mathbb{E}[\\theta \\mid x]$。服从贝塔分布 $\\text{Beta}(a, b)$ 的随机变量 $Y$ 的期望值由公式 $\\mathbb{E}[Y] = \\frac{a}{a+b}$ 给出。\n将此公式应用于我们的后验分布 $\\theta \\mid x \\sim \\text{Beta}(\\alpha', \\beta')$，我们得到：\n$$\\mathbb{E}[\\theta \\mid x] = \\frac{\\alpha'}{\\alpha'+\\beta'}$$\n代入 $\\alpha'$ 和 $\\beta'$ 的表达式：\n$$\\mathbb{E}[\\theta \\mid x] = \\frac{\\alpha+x}{(\\alpha+x) + (\\beta+n-x)}$$\n化简分母，我们得到后验均值的闭合形式解析表达式：\n$$\\mathbb{E}[\\theta \\mid x] = \\frac{\\alpha+x}{\\alpha+\\beta+n}$$\n\n最后，我们计算给定参数的数值：$n=157$，$x=41$，$\\alpha=2.3$，以及 $\\beta=5.7$。\n将这些值代入后验均值的表达式中：\n$$\\mathbb{E}[\\theta \\mid x] = \\frac{2.3+41}{2.3+5.7+157}$$\n$$\\mathbb{E}[\\theta \\mid x] = \\frac{43.3}{8.0+157}$$\n$$\\mathbb{E}[\\theta \\mid x] = \\frac{43.3}{165.0}$$\n$$ \\mathbb{E}[\\theta \\mid x] \\approx 0.26242424... $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $2$、$6$、$2$ 和 $4$。第五位数字是 $2$，小于 $5$，所以我们向下取整（即不改变第四位数字）。\n数值为 $0.2624$。", "answer": "$$\\boxed{0.2624}$$", "id": "5220970"}]}