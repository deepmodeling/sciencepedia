{"hands_on_practices": [{"introduction": "在观测研究中，混杂是区分关联与因果的主要障碍。当一个变量（混杂因素）同时影响处理分配和结果时，它会产生处理与结果之间的虚假关联。后门准则提供了一种基于图的系统方法，用于识别和选择需要调整的混杂因素，从而估计出真正的因果效应。本练习将引导你从基本原理出发，为一个典型的混杂结构（$X \\leftarrow Z \\rightarrow Y$）推导出后门调整公式，并计算干预效应，从而巩固对混杂调整核心思想的理解。", "problem": "一家医院使用观测数据评估启动抗凝治疗对三十天内中风结局的影响。设 $X \\in \\{0,1\\}$ 表示在第1天是否启动抗凝治疗（$X=1$ 表示是，$X=0$ 表示否）。设 $Y \\in \\{0,1\\}$ 表示到第30天为止是否发生中风的指标，设 $Z \\in \\{0,1\\}$ 表示一个基线合并症指标（$Z=1$ 表示合并症负担高，$Z=0$ 表示合并症负担低），该指标通过一个经过验证的指数测量。研究人员判断合并症 $Z$ 既影响治疗选择 $X$ 又影响结局 $Y$，并且除了由 $Z$ 引起的任何伪关联外，$X$ 对 $Y$ 没有直接影响。在这些假设下，因果结构是一个有向无环图（DAG），其边为 $Z \\rightarrow X$ 和 $Z \\rightarrow Y$，即 $X \\leftarrow Z \\rightarrow Y$。\n\n从以下基本原则出发：\n- 概率法则（全概率公式和条件概率），\n- 与有向无环图（DAG）一致的分布的马尔可夫分解，\n- 来自结构因果模型（SCM）的 $\\mathrm{do}$-算子的干预语义，\n\n代数推导出一个调整表达式，该表达式实现了后门准则，用以在 DAG $X \\leftarrow Z \\rightarrow Y$ 中识别 $P(Y \\mid \\mathrm{do}(X=x))$。然后，考虑以下与该 DAG 和所述假设一致的、科学上合理的数据生成机制：\n- $Z \\sim \\mathrm{Bernoulli}(\\pi)$，其中 $\\pi = \\frac{3}{10}$，\n- $X \\mid Z=z \\sim \\mathrm{Bernoulli}(\\alpha_{z})$，其中 $\\alpha_{1} = \\frac{4}{5}$ 且 $\\alpha_{0} = \\frac{1}{5}$，\n- $Y \\mid Z=z \\sim \\mathrm{Bernoulli}(\\beta_{z})$，其中 $\\beta_{1} = \\frac{2}{5}$ 且 $\\beta_{0} = \\frac{1}{10}$，\n\n并假设除了通过 $Z$ 的路径外，不存在从 $X$到 $Y$ 的任何直接因果箭头。使用您推导出的调整表达式，精确计算干预量 $P(Y=1 \\mid \\mathrm{do}(X=1))$。将您的最终数值答案表示为一个有理数（分数）。无需四舍五入。", "solution": "### 第1步：提取已知信息\n\n-   **变量**：\n    -   $X \\in \\{0,1\\}$：启动抗凝治疗（$X=1$）或未启动（$X=0$）。\n    -   $Y \\in \\{0,1\\}$：到第30天为止发生中风（$Y=1$）或未发生（$Y=0$）。\n    -   $Z \\in \\{0,1\\}$：高合并症负担（$Z=1$）或低合并症负担（$Z=0$）。\n-   **因果结构**：一个有向无环图（DAG），其边为 $Z \\rightarrow X$ 和 $Z \\rightarrow Y$，形式上表示为 $X \\leftarrow Z \\rightarrow Y$。\n-   **假设**：\n    -   $Z$ 影响 $X$ 和 $Y$。\n    -   除了由 $Z$ 引起的伪关联外，$X$ 对 $Y$ 没有直接影响。这在 DAG 中通过缺少箭头 $X \\rightarrow Y$ 来表示。\n-   **推导的基本原则**：\n    1.  概率法则（全概率公式，条件概率）。\n    2.  与 DAG 一致的分布的马尔可夫分解。\n    3.  $\\mathrm{do}$-算子的干预语义。\n-   **任务1**：推导实现后门准则的调整表达式，以识别 $P(Y \\mid \\mathrm{do}(X=x))$。\n-   **数据生成机制**：\n    -   $Z \\sim \\mathrm{Bernoulli}(\\pi)$，其中 $\\pi = \\frac{3}{10}$。\n    -   $X \\mid Z=z \\sim \\mathrm{Bernoulli}(\\alpha_{z})$，其中 $\\alpha_{1} = P(X=1 \\mid Z=1) = \\frac{4}{5}$ 且 $\\alpha_{0} = P(X=1 \\mid Z=0) = \\frac{1}{5}$。\n    -   $Y \\mid Z=z \\sim \\mathrm{Bernoulli}(\\beta_{z})$，其中 $\\beta_{1} = P(Y=1 \\mid Z=1) = \\frac{2}{5}$ 且 $\\beta_{0} = P(Y=1 \\mid Z=0) = \\frac{1}{10}$。\n-   **任务2**：计算 $P(Y=1 \\mid \\mathrm{do}(X=1))$ 的精确值，结果表示为有理数。\n\n### 第2步：使用提取的已知信息进行验证\n\n根据验证标准评估该问题：\n-   **科学基础**：该问题设置在因果推断的背景下，这是统计学和流行病学中一个成熟的学科。它使用标准工具，如`do`-演算、有向无环图（DAG）和后门准则。该医学情景是混杂效应的一个经典例子。所有方面都与既定的科学和数学原理一致。\n-   **良态问题**：问题定义清晰。它要求进行特定的代数推导，然后根据提供的参数进行数值计算。给定的 DAG 和数据生成过程是完整且充分的，足以找到唯一解。\n-   **客观性**：语言精确、技术性强，没有主观或含糊不清的术语。\n-   **完整性和一致性**：问题提供了一套完整的已知信息：变量、因果图、联合概率分布的完整参数化以及待计算的量。没有矛盾之处。“无直接效应”的假设由给定的 DAG $X \\leftarrow Z \\rightarrow Y$ 一致地表示。\n\n### 第3步：结论与行动\n\n问题陈述是有效的。这是一个因果推断中的良态标准问题。因此，我将继续进行解答。\n\n### 调整表达式的推导\n\n目标是根据观测分布 $P(X, Y, Z)$ 找到干预概率 $P(Y=y \\mid \\mathrm{do}(X=x))$ 的表达式。变量 $Z$ 是一个混杂因子，通过路径 $X \\leftarrow Z \\rightarrow Y$ 在 $X$ 和 $Y$ 之间产生了一个非因果的统计关联。后门准则提供了一种调整此类混杂效应的方法。\n\n变量集 $\\{Z\\}$ 相对于有序对 $(X,Y)$ 满足后门准则，因为：\n1.  在 DAG 中，$\\{Z\\}$ 中没有节点是 $X$ 的后代。\n2.  $\\{Z\\}$ 阻断了 $X$ 和 $Y$ 之间每一条包含指向 $X$ 的箭头的路径（即路径 $X \\leftarrow Z \\rightarrow Y$）。\n\n我们将使用指定的基本原则来推导后门调整公式。\n\n设干预前的联合概率分布为 $P(x,y,z)$。根据指定的 DAG $X \\leftarrow Z \\rightarrow Y$，我们可以使用马尔可夫分解法则将联合分布写为每个节点给定其父节点的条件概率的乘积：\n$$P(x,y,z) = P(x|\\mathrm{pa}(X)) P(y|\\mathrm{pa}(Y)) P(z|\\mathrm{pa}(Z))$$\n在这个 DAG 中，父节点分别是 $\\mathrm{pa}(X) = \\{Z\\}$，$\\mathrm{pa}(Y) = \\{Z\\}$ 和 $\\mathrm{pa}(Z) = \\emptyset$。因此，分解为：\n$$P(x,y,z) = P(x|z) P(y|z) P(z)$$\n\n我们感兴趣的量是 $P(Y=y \\mid \\mathrm{do}(X=x))$。根据 `do`-算子的语义，这对应于在一个修改后的系统中 $Y=y$ 的概率，在该系统中，$X$ 的机制被简单地设置为 $X=x$ 所取代。干预后分布，记为 $P(y,z | \\mathrm{do}(X=x))$，可以从干预前的联合分布使用截断分解公式（也称为 G-计算公式或操纵定理）推导得出。这涉及到从联合分布的乘积中删除与被干预变量相对应的因子 $P(x|z)$：\n$$P(y,z \\mid \\mathrm{do}(X=x)) = P(y|z) P(z)$$\n为了找到干预下 $Y$ 的边际概率，我们对 $z$ 的所有可能值求和：\n$$P(Y=y \\mid \\mathrm{do}(X=x)) = \\sum_{z \\in \\{0,1\\}} P(y,z \\mid \\mathrm{do}(X=x)) = \\sum_{z \\in \\{0,1\\}} P(y|z) P(z)$$\n现在，我们必须证明这个结果是后门调整公式的一个实例。对于一组去混杂变量 $S$，后门调整公式为 $P(Y=y \\mid \\mathrm{do}(X=x)) = \\sum_s P(Y=y \\mid X=x, S=s) P(S=s)$。对于我们的问题，当 $S=\\{Z\\}$ 时，该公式为：\n$$P(Y=y \\mid \\mathrm{do}(X=x)) = \\sum_{z \\in \\{0,1\\}} P(Y=y \\mid X=x, Z=z) P(Z=z)$$\n为了将我们推导出的表达式与此公式协调起来，我们检查给定 DAG $X \\leftarrow Z \\rightarrow Y$ 的条件独立性。根据 d-分离规则，以 $Z$ 为条件会阻断 $X$ 和 $Y$ 之间的唯一路径。因此，在给定 $Z$ 的条件下，$Y$ 与 $X$ 条件独立，记为 $(Y \\perp X \\mid Z)$。这种条件独立性意味着：\n$$P(Y=y \\mid X=x, Z=z) = P(Y=y \\mid Z=z)$$\n将此等式代入通用的后门调整公式中，得到：\n$$P(Y=y \\mid \\mathrm{do}(X=x)) = \\sum_{z \\in \\{0,1\\}} P(Y=y \\mid Z=z) P(Z=z)$$\n这个表达式就是推导出的调整公式，它正确地实现了给定 DAG 的后门准则。\n\n这个结果的一个重要推论是，等式右边就是通过全概率公式计算出的边际概率 $P(Y=y)$。这意味着 $P(Y=y \\mid \\mathrm{do}(X=x))$ 不是 $x$ 的函数。这是符合预期的，因为 DAG $X \\leftarrow Z \\rightarrow Y$ 不包含从 $X$到 $Y$ 的有向路径，这表明 $X$ 对 $Y$ 没有因果效应。\n\n### 干预量的计算\n\n我们需要计算 $P(Y=1 \\mid \\mathrm{do}(X=1))$。使用上面推导的公式：\n$$P(Y=1 \\mid \\mathrm{do}(X=1)) = \\sum_{z \\in \\{0,1\\}} P(Y=1 \\mid Z=z) P(Z=z)$$\n这可以展开为：\n$$P(Y=1 \\mid \\mathrm{do}(X=1)) = P(Y=1 \\mid Z=1)P(Z=1) + P(Y=1 \\mid Z=0)P(Z=0)$$\n我们已知数据生成机制的以下参数：\n-   $P(Z=1) = \\pi = \\frac{3}{10}$。\n-   $P(Z=0) = 1 - \\pi = 1 - \\frac{3}{10} = \\frac{7}{10}$。\n-   $P(Y=1 \\mid Z=1) = \\beta_1 = \\frac{2}{5}$。\n-   $P(Y=1 \\mid Z=0) = \\beta_0 = \\frac{1}{10}$。\n\n将这些值代入表达式中：\n$$P(Y=1 \\mid \\mathrm{do}(X=1)) = \\left(\\frac{2}{5}\\right) \\left(\\frac{3}{10}\\right) + \\left(\\frac{1}{10}\\right) \\left(\\frac{7}{10}\\right)$$\n我们进行计算：\n$$P(Y=1 \\mid \\mathrm{do}(X=1)) = \\frac{6}{50} + \\frac{7}{100}$$\n为了将这两个分数相加，我们找到一个公分母，即 $100$。\n$$P(Y=1 \\mid \\mathrm{do}(X=1)) = \\frac{6 \\times 2}{50 \\times 2} + \\frac{7}{100} = \\frac{12}{100} + \\frac{7}{100}$$\n$$P(Y=1 \\mid \\mathrm{do}(X=1)) = \\frac{19}{100}$$\n干预概率 $P(Y=1 \\mid \\mathrm{do}(X=1))$ 精确等于 $\\frac{19}{100}$。这是在不考虑人群合并症状态的情况下，对整个人群普遍施用抗凝治疗时发生中风的概率。", "answer": "$$\\boxed{\\frac{19}{100}}$$", "id": "4961103"}, {"introduction": "当混杂因素无法被测量时，后门调整将不再适用。在这种情况下，工具变量（Instrumental Variable, IV）方法提供了一种强有力的替代方案。本练习模拟了一个带有不依从性（non-compliance）的临床试验场景，你将学习如何利用一个有效的工具变量（随机分配的鼓励措施）来识别并计算“依从者”这一特定亚群的平均因果效应（Complier Average Causal Effect, CACE）。这个过程揭示了即使在存在未观测混杂的情况下，我们如何利用外生变异来分离出因果关系。", "problem": "一家医院进行了一项随机对照试验 (RCT)，以评估启用一种新的降压药对六个月内收缩压降低的效果。参与者被随机分配接受一项激励干预，该干预降低了开始用药的成本障碍：分配指标为 $Z \\in \\{0,1\\}$，其中 $Z=1$ 表示受到激励，$Z=0$ 表示未受激励。由于真实世界的行为，并非所有受激励的患者都开始治疗，而一些未受激励的患者会自行开始治疗。令 $X \\in \\{0,1\\}$ 表示参与者是否在一个月内开始用药 ($X=1$) 或未开始用药 ($X=0$)。结果变量 $Y$ 是六个月后测得的收缩压降低值，单位为毫米汞柱，其定义为数值越大表示降低幅度越大。\n\n在整个试验中，观察到以下各组的平均值：\n- 激励组的平均结果：$E[Y \\mid Z=1] = 7.2$。\n- 非激励组的平均结果：$E[Y \\mid Z=0] = 4.5$。\n- 激励组的平均用药率：$E[X \\mid Z=1] = 0.60$。\n- 非激励组的平均用药率：$E[X \\mid Z=0] = 0.20$。\n\n使用潜在结果框架，并作出以下假设：\n- 随机分配（独立性）：$Z \\perp \\left(Y(1), Y(0), X(1), X(0)\\right)$。\n- 排他性限制：$Y$ 仅通过 $X$ 依赖于 $Z$，即 $Y = Y(X)$。\n- 单调性（无反抗者）：对所有参与者，$X(1) \\geq X(0)$。\n\n请从第一性原理出发，推导依从者平均因果效应 (CACE) 的识别，其定义为 $E\\left[Y(1)-Y(0) \\mid X(1)=1, X(0)=0\\right]$，然后使用给定的各组平均值计算其在本试验中的数值。将最终数值答案四舍五入至三位有效数字，并以毫米汞柱 (mmHg) 为单位表示该效应。", "solution": "该问题要求在潜在结果框架内，使用工具变量法推导并计算依从者平均因果效应 (CACE)。\n\n首先，我们验证问题陈述的有效性。\n\n**步骤1：提取已知信息**\n- 随机化指标（工具变量）：$Z \\in \\{0, 1\\}$，其中 $Z=1$ 表示激励。\n- 治疗启动（内生变量）：$X \\in \\{0, 1\\}$，其中 $X=1$ 表示服药。\n- 结果：$Y$，收缩压的降低值 (mmHg)。\n- 观测到的条件期望：\n  - $E[Y \\mid Z=1] = 7.2$\n  - $E[Y \\mid Z=0] = 4.5$\n  - $E[X \\mid Z=1] = 0.60$\n  - $E[X \\mid Z=0] = 0.20$\n- 潜在结果表示法：$X(z)$ 是在分配为 $Z=z$ 时的潜在治疗状态。$Y(x)$ 是在治疗设置为 $X=x$ 时的潜在结果。\n- 假设：\n  1.  **随机分配（独立性）：** $Z \\perp \\left(Y(1), Y(0), X(1), X(0)\\right)$。激励分配独立于所有潜在结果和潜在治疗决策。\n  2.  **排他性限制：** $Y = Y(X)$。工具变量 $Z$ 仅通过治疗 $X$ 影响结果 $Y$。这意味着在激励 $z$ 下的潜在结果是 $Y(z) = Y(X(z))$。\n  3.  **单调性（无反抗者）：** 对于所有个体，$X(1) \\geq X(0)$。没有人会在未受激励时服药 ($X(0)=1$) 而在受激励时拒绝服药 ($X(1)=0$)。\n- 目标量 (CACE)：$E\\left[Y(1)-Y(0) \\mid X(1)=1, X(0)=0\\right]$。这是“依从者”子群体的平均治疗效应。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题具有科学依据、提法明确且客观。它展示了工具变量在具有不依从性的医学试验中进行因果推断的典型应用。所提供的数据和假设正是识别 CACE 的标准要求。该问题内部一致，不违反任何科学原理。这是一个有效且可解的问题。\n\n**步骤3：结论与行动**\n问题有效。我们开始求解。\n\n**CACE 识别公式的推导**\n\nCACE 是指在因激励而接受治疗的个体子群体上的平均治疗效应。我们可以通过分析对结果的意向治疗 (ITT) 效应与对治疗接受率的 ITT 效应之比来推导其公式。\n\n1.  **分析分母：$E[X \\mid Z=1] - E[X \\mid Z=0]$**\n\n该表达式表示激励 ($Z$) 对治疗启动 ($X$) 的 ITT 效应。根据迭代期望定律和一致性假设（个体的观测治疗 $X$ 是其在被分配的激励 $z$ 下的潜在治疗 $X(z)$），我们有：\n$E[X \\mid Z=1] = E[X(1) \\mid Z=1]$\n$E[X \\mid Z=0] = E[X(0) \\mid Z=0]$\n\n由于随机分配假设，$Z$ 独立于潜在结果 $X(1)$ 和 $X(0)$。因此，以 $Z$ 为条件是多余的：\n$E[X(1) \\mid Z=1] = E[X(1)]$\n$E[X(0) \\mid Z=0] = E[X(0)]$\n\n因此，分母为 $E[X(1)] - E[X(0)]$。\n\n单调性假设允许我们根据个体的潜在治疗选择将总体划分为三个潜在组（第四组，即反抗者，其规模为零）：\n-   **依从者 (C):** 对其而言 $X(1)=1$ 且 $X(0)=0$ 的个体。\n-   **始终接受者 (AT):** 对其而言 $X(1)=1$ 且 $X(0)=1$ 的个体。\n-   **从不接受者 (NT):** 对其而言 $X(1)=0$ 且 $X(0)=0$ 的个体。\n\n令 $\\pi_C$、$\\pi_{AT}$ 和 $\\pi_{NT}$ 分别为这些群体在总体中的比例。\n我们可以用这些比例来表示 $E[X(1)]$ 和 $E[X(0)]$：\n$E[X(1)] = 1 \\cdot P(X(1)=1) + 0 \\cdot P(X(1)=0) = P(X(1)=1) = \\pi_C + \\pi_{AT}$\n$E[X(0)] = 1 \\cdot P(X(0)=1) + 0 \\cdot P(X(0)=0) = P(X(0)=1) = \\pi_{AT}$\n\n那么，差值为：\n$E[X(1)] - E[X(0)] = (\\pi_C + \\pi_{AT}) - \\pi_{AT} = \\pi_C$\n\n所以，对治疗接受率的 ITT 效应识别出总体中依从者的比例：\n$E[X \\mid Z=1] - E[X \\mid Z=0] = P(\\text{依从者})$\n\n2.  **分析分子：$E[Y \\mid Z=1] - E[Y \\mid Z=0]$**\n\n这是激励对结果 $Y$ 的 ITT 效应。使用一致性、独立性和排他性限制 ($Y(z) = Y(X(z))$)：\n$E[Y \\mid Z=1] = E[Y(X(1)) \\mid Z=1] = E[Y(X(1))]$\n$E[Y \\mid Z=0] = E[Y(X(0)) \\mid Z=0] = E[Y(X(0))]$\n\n分子是 $E[Y(X(1))] - E[Y(X(0))]$。我们通过以潜在依从组为条件来展开此式：\n$E[Y(X(1))] = E[Y(X(1)) \\mid \\text{C}]\\pi_C + E[Y(X(1)) \\mid \\text{AT}]\\pi_{AT} + E[Y(X(1)) \\mid \\text{NT}]\\pi_{NT}$\n对于依从者，$X(1)=1 \\Rightarrow Y(X(1)) = Y(1)$。\n对于始终接受者，$X(1)=1 \\Rightarrow Y(X(1)) = Y(1)$。\n对于从不接受者，$X(1)=0 \\Rightarrow Y(X(1)) = Y(0)$。\n所以，$E[Y(X(1))] = E[Y(1) \\mid \\text{C}]\\pi_C + E[Y(1) \\mid \\text{AT}]\\pi_{AT} + E[Y(0) \\mid \\text{NT}]\\pi_{NT}$。\n\n类似地，对于 $E[Y(X(0))]$：\n对于依从者，$X(0)=0 \\Rightarrow Y(X(0)) = Y(0)$。\n对于始终接受者，$X(0)=1 \\Rightarrow Y(X(0)) = Y(1)$。\n对于从不接受者，$X(0)=0 \\Rightarrow Y(X(0)) = Y(0)$。\n所以，$E[Y(X(0))] = E[Y(0) \\mid \\text{C}]\\pi_C + E[Y(1) \\mid \\text{AT}]\\pi_{AT} + E[Y(0) \\mid \\text{NT}]\\pi_{NT}$。\n\n将两个表达式相减，始终接受者和从不接受者的项会相互抵消：\n$$\n\\begin{align*}\nE[Y(X(1))] - E[Y(X(0))] = (E[Y(1) \\mid \\text{C}]\\pi_C + E[Y(1) \\mid \\text{AT}]\\pi_{AT} + E[Y(0) \\mid \\text{NT}]\\pi_{NT}) \\\\\n\\quad - (E[Y(0) \\mid \\text{C}]\\pi_C + E[Y(1) \\mid \\text{AT}]\\pi_{AT} + E[Y(0) \\mid \\text{NT}]\\pi_{NT}) \\\\\n= E[Y(1) \\mid \\text{C}]\\pi_C - E[Y(0) \\mid \\text{C}]\\pi_C \\\\\n= (E[Y(1) \\mid \\text{C}] - E[Y(0) \\mid \\text{C}]) \\pi_C \\\\\n= E[Y(1) - Y(0) \\mid \\text{依从者}] \\cdot P(\\text{依从者})\n\\end{align*}\n$$\n\n3.  **合并结果**\n\n我们已经确定：\n- 分子：$E[Y \\mid Z=1] - E[Y \\mid Z=0] = \\text{CACE} \\cdot P(\\text{依从者})$\n- 分母：$E[X \\mid Z=1] - E[X \\mid Z=0] = P(\\text{依从者})$\n\n用第一个方程除以第二个方程，即可识别出 CACE：\n$$\n\\text{CACE} = E\\left[Y(1)-Y(0) \\mid X(1)=1, X(0)=0\\right] = \\frac{E[Y \\mid Z=1] - E[Y \\mid Z=0]}{E[X \\mid Z=1] - E[X \\mid Z=0]}\n$$\n这是著名的用于 CACE 的工具变量估计量公式，也称为沃尔德估计量。\n\n**CACE 的计算**\n\n使用所提供的数据：\n- 分子（对结果的 ITT 效应）：$E[Y \\mid Z=1] - E[Y \\mid Z=0] = 7.2 - 4.5 = 2.7$\n- 分母（依从者的比例）：$E[X \\mid Z=1] - E[X \\mid Z=0] = 0.60 - 0.20 = 0.40$\n\n现在，我们计算 CACE：\n$$\n\\text{CACE} = \\frac{2.7}{0.40} = \\frac{27}{4} = 6.75\n$$\n依从者平均因果效应是收缩压降低 $6.75$ mmHg。问题要求答案保留三位有效数字，而 $6.75$ 本身就是三位有效数字。\n从不接受者的比例是 $P(X(1)=0) = 1-P(X(1)=1) = 1 - 0.60 = 0.40$。\n始终接受者的比例是 $P(X(0)=1) = 0.20$。\n依从者的比例是 $1 - 0.40 - 0.20 = 0.40$，这与我们分母的计算结果相符。\n$6.75$ mmHg 的 CACE 是指在因激励计划而开始治疗的 $40\\%$ 的试验人群中，该药物的平均效应。该效应大于 $2.7$ mmHg 的简单 ITT 效应，因为 ITT 效应被 $60\\%$ 的人群（始终接受者和从不接受者）所稀释，这些人的治疗状态不受激励的影响。", "answer": "$$\n\\boxed{6.75}\n$$", "id": "4961021"}, {"introduction": "调整变量是消除混杂偏倚的常用方法，但错误地调整变量反而会引入偏倚。本练习探讨M-偏倚（M-bias）这一反直觉的现象，它是一种典型的对撞机分层偏倚（collider-stratification bias）。通过构建一个描述该场景的因果图，你将理解为什么对一个处理前变量（对撞机）进行控制，会意外地打开一条非因果路径，从而在处理和结果之间产生虚假关联。这个练习强调了在进行统计调整之前，基于领域知识进行严谨的因果推理是至关重要的。", "problem": "一项预防心脏病学的观察性队列研究评估了指南推荐的降脂治疗 $X$（在基线时启动）对一年内主要不良心血管事件 $Y$（心肌梗死和卒中的复合终点）的因果效应。治疗前，临床医生收集了一个基线治疗前行为指标 $Z$，定义为一个标准化的健康寻求指数，该指数根据上一年度参加筛查、疫苗接种依从性和预防性生活方式就诊的情况汇总而成。研究假设了两个潜变量：$U_X$ 捕捉患者接受药物治疗并遵守医生建议的内在倾向，以及 $U_Y$ 捕捉患者潜在的心血管易损性（例如，亚临床动脉粥样硬化负荷和衰弱）。研究者假设了以下在临床实践中均属合理的定性机制：$U_X$ 使患者倾向于启动治疗 $X$，也倾向于有更高的健康寻求指数 $Z$；$U_Y$ 使患者倾向于发生不良事件 $Y$，也倾向于有更高的健康寻求指数 $Z$（因为易损患者会寻求更多的预防性护理）。研究者认为 $U_X$ 和 $U_Y$ 在目标人群中是独立的，因为它们的病因起源不同（行为特征与生物易损性）。在考虑了 $U_X$ 和 $U_Y$ 之后，没有理由怀疑 $Z$ 直接导致 $X$ 或 $Y$，也没有理由怀疑 $X$ 直接导致 $Z$，因为 $Z$ 是在启动 $X$ 之前完全测量的。\n\n使用因果有向无环图框架，并从以下基本定义出发：(i) 有向无环图通过箭头 $A \\to B$ 编码因果关系，(ii) d-分离表征了图所蕴含的条件独立性，(iii) 路径上的对撞节点是具有两个箭头指向它的节点（例如，$A \\to C \\leftarrow B$），以及 (iv) 后门准则指出，如果一组变量阻断了从 $X$到 $Y$ 的所有后门路径，且不以对撞节点为条件，那么这组变量足以调整混杂。请回答以下问题。\n\n下列哪个陈述正确地指明了此临床情境中典型的M-偏倚结构的有向无环图，并正确解释了为什么调整观察到的治疗前变量 $Z$ 会反常地在估计 $X$ 对 $Y$ 的因果效应时引入偏倚？选择所有适用的选项。\n\nA. M-偏倚图由独立的潜变量 $U_X$ 和 $U_Y$ 构成，箭头为 $U_X \\to X$，$U_Y \\to Y$，以及 $U_X \\to Z$ 和 $U_Y \\to Z$；因此 $Z$ 是路径 $X \\leftarrow U_X \\to Z \\leftarrow U_Y \\to Y$ 上的一个对撞节点。以 $Z$ 为条件会打开这条非因果路径，并在 $X$ 和 $Y$ 之间引入关联，即使 $X$ 对 $Y$ 没有因果效应。\n\nB. 正确的图有箭头 $Z \\to X$ 和 $Z \\to Y$，$Z$ 是一个治疗前混杂因素；因此，调整 $Z$ 会阻断后门路径，不会引入偏倚。\n\nC. 正确的图具有中介结构，箭头为 $X \\to Z \\to Y$；因此，调整 $Z$ 仅阻断了 $X$ 对 $Y$ 的间接效应，并不会产生伪关联。\n\nD. 如果 $U_X$ 和 $U_Y$ 独立且 $Z$ 是它们的共同效应，那么以 $Z$ 为条件会保持 $U_X$ 和 $U_Y$ 之间的独立性；因此，调整 $Z$ 不会打开后门路径。\n\nE. 这个悖论的产生是因为，当 $U_X \\perp U_Y$ 且 $U_X \\to Z$ 和 $U_Y \\to Z$ 同时存在时，$Z$ 是一个对撞节点。根据d-分离规则，以对撞节点为条件会引入依赖关系 $U_X \\not\\perp U_Y \\mid Z$，并打开先前被阻断的路径 $X \\leftarrow U_X \\to Z \\leftarrow U_Y \\to Y$，从而在调整 $Z$ 来估计 $X$ 对 $Y$ 的因果效应时产生偏倚。\n\n答案选择必须同时反映对M-偏倚有向无环图的正确构建，以及对调整 $Z$ 对估计 $X$ 对 $Y$ 效应的影响的正确因果识别论证。", "solution": "在进行解答之前，将首先验证问题陈述的科学合理性、内部一致性和清晰度。\n\n### 第1步：提取已知条件\n\n从问题陈述中逐字提取的已知条件如下：\n-   **变量**:\n    -   $X$: 指南推荐的降脂治疗，在基线时启动。\n    -   $Y$: 一年内主要不良心血管事件。\n    -   $Z$: 基线治疗前行为指标（健康寻求指数）。\n    -   $U_X$: 患者接受药物治疗倾向的潜变量。\n    -   $U_Y$: 患者潜在心血管易损性的潜变量。\n-   **假设的因果机制**:\n    -   $U_X$ 使患者倾向于启动治疗 $X$。\n    -   $U_X$ 使患者倾向于有更高的健康寻求指数 $Z$。\n    -   $U_Y$ 使患者倾向于发生不良事件 $Y$。\n    -   $U_Y$ 使患者倾向于有更高的健康寻求指数 $Z$。\n-   **假设和约束**:\n    -   $U_X$ 和 $U_Y$ 在目标人群中是独立的。\n    -   在考虑了 $U_X$ 和 $U_Y$ 之后，$Z$ 不直接导致 $X$ 或 $Y$。\n    -   $X$ 不直接导致 $Z$，因为 $Z$ 是在治疗前测量的。\n-   **框架和定义**:\n    -   因果有向无环图（DAG）框架。\n    -   $A \\to B$ 表示因果关系。\n    -   d-分离表征条件独立性。\n    -   对撞节点是具有两个箭头指向它的节点，例如 $A \\to C \\leftarrow B$。\n    -   后门准则：如果一组变量阻断了从 $X$ 到 $Y$ 的所有后门路径，且不以对撞节点为条件，则该组变量是充分的调整集。\n-   **问题**: 确定哪些陈述正确地指明了M-偏倚结构的DAG，并解释了为什么调整 $Z$ 会在估计 $X$ 对 $Y$ 的因果效应时引入偏倚。\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学上合理**: 该问题描述了药物流行病学和医学统计学中一个经典且现实的场景。M-偏倚（对撞节点分层偏倚的一种形式）是因果推断领域一个公认的概念。使用DAG、d-分离和后门准则代表了解决此类问题的标准现代框架。临床背景是合理的。该问题在科学上和事实上是合理的。\n-   **定义明确**: 问题提供了一套完整的关系和假设，足以构建一个唯一的DAG。问题精确，要求基于已建立的因果原则进行解释。可以推导出一个唯一且有意义的解决方案。\n-   **客观**: 问题以精确、客观、技术性的语言陈述，没有歧义或主观论断。\n\n### 第3步：结论和行动\n\n问题陈述是**有效的**。这是一个在统计建模和因果推断领域内定义明确、科学上合理且客观的问题。我将继续推导解决方案。\n\n### 推导\n\n根据所提供的信息，我们构建一个有向无环图（DAG）来表示变量之间的因果关系。\n\n1.  **将已知条件转化为DAG箭头**:\n    -   “$U_X$ 使患者倾向于启动治疗 $X$”：这意味着存在一个有向箭头 $U_X \\to X$。\n    -   “$U_X$ 使患者倾向于有更高的健康寻求指数 $Z$”：这意味着存在一个有向箭头 $U_X \\to Z$。\n    -   “$U_Y$ 使患者倾向于发生不良事件 $Y$”：这意味着存在一个有向箭头 $U_Y \\to Y$。\n    -   “$U_Y$ 使患者倾向于有更高的健康寻求指数 $Z$”：这意味着存在一个有向箭头 $U_Y \\to Z$。\n    -   “$U_X$ 和 $U_Y$ 是独立的”：这意味着没有 $U_X$ 和 $U_Y$ 的共同原因，且它们之间没有因果关系。它们是图中的外生节点。\n    -   “没有理由怀疑 $Z$ 直接导致 $X$ 或 $Y$”：这意味着我们不画箭头 $Z \\to X$ 或 $Z \\to Y$。\n    -   “$X$ 不直接导致 $Z$，因为 $Z$ 是在启动 $X$ 之前完全测量的”：这种时间顺序禁止了箭头 $X \\to Z$。\n    -   我们感兴趣的因果效应是 $X$ 对 $Y$ 的效应，由潜在的箭头 $X \\to Y$ 表示。\n\n2.  **构建DAG**:\n    上述关系构成了以下DAG结构：\n    $$ X \\leftarrow U_X \\to Z \\leftarrow U_Y \\to Y $$\n    我们感兴趣的因果路径是 $X \\to Y$。为了获得该效应的无偏估计，我们必须识别并阻断所有从 $X$到 $Y$ 的非因果“后门”路径。后门路径是一条从 $X$ 到 $Y$ 的路径，其始于一个指向 $X$ 的箭头。\n\n3.  **分析后门路径和Z的角色**:\n    -   在此图中，从 $X$ 到 $Y$ 的唯一后门路径是 $X \\leftarrow U_X \\to Z \\leftarrow U_Y \\to Y$。\n    -   在这条路径中，变量 $Z$ 是一个**对撞节点**，因为有两个箭头指向它（$U_X \\to Z$ 和 $U_Y \\to Z$）。\n    -   根据d-分离的规则，包含对撞节点的路径被该对撞节点**阻断**，前提是我们不对该对撞节点或其任何后代进行条件化。\n    -   由于唯一的后门路径被对撞节点 $Z$ 阻断，因此 $X \\to Y$ 的关系不存在混杂。$X$ 和 $Y$ 之间的粗略（未调整）关联是对因果效应的无偏估计。\n\n4.  **分析调整Z的影响**:\n    -   “调整 $Z$”（例如，在回归模型中或通过分层）意味着我们正在对 $Z$ 进行**条件化**。\n    -   d-分离的一个基本规则是，对一个对撞节点进行条件化会**打开**它之前阻断的路径。\n    -   通过以 $Z$ 为条件，我们打开了非因果路径 $X \\leftarrow U_X \\to Z \\leftarrow U_Y \\to Y$。\n    -   这在 $X$ 和 $Y$ 之间引入了一种虚假的、非因果的关联。这种现象被称为对撞节点分层偏倚，或者在这种特定结构下，称为M-偏倚。\n    -   其逻辑机制如下：$Z$ 的原因，$U_X$ 和 $U_Y$，是边际独立的（$U_X \\perp U_Y$）。然而，当以它们的共同效应 $Z$ 为条件时，它们变得条件依赖（$U_X \\not\\perp U_Y \\mid Z$）。这种在 $U_X$ 和 $U_Y$ 之间引入的关联使得统计信息可以通过路径 $X \\leftarrow U_X \\dots U_Y \\to Y$ 从 $X$ 流向 $Y$，从而产生偏倚。\n\n### 逐项分析\n\n**A. M-偏倚图由独立的潜变量 $U_X$ 和 $U_Y$ 构成，箭头为 $U_X \\to X$，$U_Y \\to Y$，以及 $U_X \\to Z$ 和 $U_Y \\to Z$；因此 $Z$ 是路径 $X \\leftarrow U_X \\to Z \\leftarrow U_Y \\to Y$ 上的一个对撞节点。以 $Z$ 为条件会打开这条非因果路径，并在 $X$ 和 $Y$ 之间引入关联，即使 $X$ 对 $Y$ 没有因果效应。**\n-   对图的描述与我们的推导一致，是准确的。\n-   将 $Z$ 识别为指定路径上的对撞节点是正确的。\n-   结论认为以 $Z$ 为条件会打开这条路径并引入虚假关联是正确的。\n-   **结论：正确。**\n\n**B. 正确的图有箭头 $Z \\to X$ 和 $Z \\to Y$，$Z$ 是一个治疗前混杂因素；因此，调整 $Z$ 会阻断后门路径，不会引入偏倚。**\n-   该陈述提出了一个不同的图结构，其中 $Z$ 是 $X$ 和 $Y$ 的共同原因。这与问题描述相矛盾，问题明确指出 $Z$ 不直接导致 $X$ 或 $Y$。在该选项提出的结构中，$Z$ 将是一个标准的混杂因素，调整它对于*消除*偏倚是必要的，这与M-偏倚悖论相反。\n-   **结论：错误。**\n\n**C. 正确的图具有中介结构，箭头为 $X \\to Z \\to Y$；因此，调整 $Z$ 仅阻断了 $X$ 对 $Y$ 的间接效应，并不会产生伪关联。**\n-   这提出了一个中介结构。根据问题陈述，这是事实错误的，因为问题指明 $Z$ 是在 $X$ 之前的*治疗前*变量。在时间上，$X$ 不能导致 $Z$，所以箭头 $X \\to Z$ 是不可能的。\n-   **结论：错误。**\n\n**D. 如果 $U_X$ 和 $U_Y$ 独立且 $Z$ 是它们的共同效应，那么以 $Z$ 为条件会保持 $U_X$ 和 $U_Y$ 之间的独立性；因此，调整 $Z$ 不会打开后门路径。**\n-   该陈述的前提是根本错误的。条件独立性和d-分离的一个核心原则是，以共同效应（一个对撞节点）为条件会*引入*其先前独立的原因之间的依赖性。也就是说，如果 $U_X \\perp U_Y$，那么通常情况下 $U_X \\not\\perp U_Y \\mid Z$。该陈述声称的恰恰相反。\n-   **结论：错误。**\n\n**E. 这个悖论的产生是因为，当 $U_X \\perp U_Y$ 且 $U_X \\to Z$ 和 $U_Y \\to Z$ 同时存在时，$Z$ 是一个对撞节点。根据d-分离规则，以对撞节点为条件会引入依赖关系 $U_X \\not\\perp U_Y \\mid Z$，并打开先前被阻断的路径 $X \\leftarrow U_X \\to Z \\leftarrow U_Y \\to Y$，从而在调整 $Z$ 来估计 $X$ 对 $Y$ 的因果效应时产生偏倚。**\n-   该陈述在给定 $U_X$ 和 $U_Y$ 独立以及指向 $Z$ 的箭头的情况下，正确地将 $Z$ 识别为对撞节点。\n-   它正确而形式化地陈述了以对撞节点为条件的后果：它引入了条件依赖性（$U_X \\not\\perp U_Y \\mid Z$）。\n-   它正确地将这种引入的依赖性与特定后门路径的打开联系起来，从而产生偏倚。这是对M-偏倚机制的精确而详细的解释。\n-   **结论：正确。**\n\n选项A和E都正确地描述了DAG以及因调整 $Z$ 而产生的偏倚。选项E对潜在机制（$U_X \\not\\perp U_Y \\mid Z$）提供了更形式化的解释，而选项A则更直接地陈述了结果。基于问题陈述和因果推断的原则，两者都是完全正确的。", "answer": "$$\\boxed{AE}$$", "id": "4961093"}]}