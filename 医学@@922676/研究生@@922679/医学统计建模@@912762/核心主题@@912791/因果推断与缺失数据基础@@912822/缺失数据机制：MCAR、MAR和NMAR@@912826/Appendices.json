{"hands_on_practices": [{"introduction": "理论的价值在于指导实践，而理解缺失数据机制的第一步是量化其影响。即便在最简单的“完全随机缺失”（MCAR）假设下，仅使用完整观测数据（即“完整案例分析”）也会导致信息损失。本练习将引导你通过推导，精确计算出这种分析方法导致的统计效率损失，从而让你对缺失数据所带来的代价建立起一个定量的、直观的认识。[@problem_id:4973778]", "problem": "在一项关于连续生物标志物的纵向观察性研究中，设 $\\{Y_{i}\\}_{i=1}^{n}$ 独立同分布，其均值为 $\\mu=\\mathbb{E}[Y]$，方差为 $\\sigma^{2}=\\operatorname{Var}(Y)$。设 $\\{R_{i}\\}_{i=1}^{n}$ 为独立同分布的缺失指示变量，其中 $R_{i}\\in\\{0,1\\}$ 表示 $Y_{i}$ 是否被观测到。定义 $\\pi=\\mathbb{E}[R]\\in(0,1)$ 为观测比例。假设数据满足完全随机缺失（MCAR）机制，这意味着 $R_{i}$ 与 $Y_{i}$ 及任何协变量都独立。作为背景知识，随机缺失（MAR）允许缺失性依赖于观测到的协变量，但不依赖于缺失值本身；而非随机缺失（NMAR）则允许缺失性依赖于未观测到的结果。\n\n考虑完整案例估计量\n$$\n\\hat{\\mu}_{\\text{cc}}=\\frac{\\sum_{i=1}^{n}R_{i}Y_{i}}{\\sum_{i=1}^{n}R_{i}}.\n$$\n从基本定义和标准极限定理出发，推导在MCAR条件下 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差，然后通过计算方差膨胀因子来量化其相对于完整数据样本均值 $\\bar{Y}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$ 的效率损失。方差膨胀因子定义为 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差与 $\\bar{Y}_{n}$ 的大样本方差之比。请将最终答案表示为关于 $\\pi$ 的闭式解析表达式。无需进行数值近似或四舍五入，且不涉及物理单位。", "solution": "所述问题是有效的。这是一个统计理论中的适定问题，其基础是处理缺失数据的既定原则。所有术语都经过了形式化定义，且前提条件是自洽的，足以推导出唯一的解。\n\n目标是推导完整案例估计量 $\\hat{\\mu}_{\\text{cc}}$ 相对于完整数据样本均值 $\\bar{Y}_{n}$ 的方差膨胀因子。该因子定义为两者大样本方差的比率。\n\n首先，我们确定完整数据样本均值 $\\bar{Y}_{n}$ 的大样本方差。\n完整数据估计量定义为：\n$$\n\\bar{Y}_{n} = \\frac{1}{n} \\sum_{i=1}^{n} Y_{i}\n$$\n变量 $\\{Y_i\\}_{i=1}^n$ 是独立同分布（i.i.d.）的，方差为 $\\operatorname{Var}(Y) = \\sigma^2$。因此，样本均值的方差为：\n$$\n\\operatorname{Var}(\\bar{Y}_{n}) = \\operatorname{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} Y_{i}\\right) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\operatorname{Var}(Y_{i}) = \\frac{1}{n^2} (n \\sigma^2) = \\frac{\\sigma^2}{n}\n$$\n这个精确方差即为 $\\bar{Y}_{n}$ 的大样本方差。\n\n接下来，我们推导完整案例估计量 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差。\n该估计量定义为以下比率：\n$$\n\\hat{\\mu}_{\\text{cc}} = \\frac{\\sum_{i=1}^{n} R_{i} Y_{i}}{\\sum_{i=1}^{n} R_{i}} = \\frac{\\frac{1}{n} \\sum_{i=1}^{n} R_{i} Y_{i}}{\\frac{1}{n} \\sum_{i=1}^{n} R_{i}}\n$$\n这是一个两个样本均值的比率。我们可以使用多元中心极限定理（CLT）和Delta方法来求出 $\\hat{\\mu}_{\\text{cc}}$ 的渐近分布。\n让我们定义一个随机变量向量 $W_i = \\begin{pmatrix} R_i Y_i \\\\ R_i \\end{pmatrix}$。因为 $\\{Y_i\\}_{i=1}^n$ 和 $\\{R_i\\}_{i=1}^n$ 是独立同分布序列，并且彼此独立（由于MCAR），所以向量序列 $\\{W_i\\}_{i=1}^n$ 也是独立同分布的。\n\n我们首先计算 $W_i$ 的期望。\n$\\mathbb{E}[R_i] = \\pi$。\n在完全随机缺失（MCAR）假设下，$R_i$ 与 $Y_i$ 独立。因此：\n$\\mathbb{E}[R_i Y_i] = \\mathbb{E}[R_i] \\mathbb{E}[Y_i] = \\pi \\mu$。\n期望向量为：\n$$\n\\mathbb{E}[W_i] = \\begin{pmatrix} \\mathbb{E}[R_i Y_i] \\\\ \\mathbb{E}[R_i] \\end{pmatrix} = \\begin{pmatrix} \\pi \\mu \\\\ \\pi \\end{pmatrix}\n$$\n接下来，我们计算 $W_i$ 的协方差矩阵，记为 $\\Sigma_W = \\operatorname{Cov}(W_i)$。\n$$\n\\Sigma_W = \\begin{pmatrix} \\operatorname{Var}(R_i Y_i) & \\operatorname{Cov}(R_i Y_i, R_i) \\\\ \\operatorname{Cov}(R_i Y_i, R_i) & \\operatorname{Var}(R_i) \\end{pmatrix}\n$$\n各个分量的计算如下：\n1.  $\\operatorname{Var}(R_i)$: 由于 $R_i$ 是参数为 $\\pi$ 的伯努利随机变量，其方差为 $\\operatorname{Var}(R_i) = \\pi(1-\\pi)$。\n2.  $\\operatorname{Var}(R_i Y_i) = \\mathbb{E}[(R_i Y_i)^2] - (\\mathbb{E}[R_i Y_i])^2$。\n    由于 $R_i \\in \\{0, 1\\}$，我们有 $R_i^2 = R_i$。\n    $\\mathbb{E}[(R_i Y_i)^2] = \\mathbb{E}[R_i^2 Y_i^2] = \\mathbb{E}[R_i Y_i^2]$。根据 MCAR，这等于 $\\mathbb{E}[R_i]\\mathbb{E}[Y_i^2]$。\n    我们知道 $\\mathbb{E}[Y_i^2] = \\operatorname{Var}(Y_i) + (\\mathbb{E}[Y_i])^2 = \\sigma^2 + \\mu^2$。\n    所以，$\\mathbb{E}[R_i Y_i^2] = \\pi (\\sigma^2 + \\mu^2)$。\n    因此，$\\operatorname{Var}(R_i Y_i) = \\pi(\\sigma^2 + \\mu^2) - (\\pi \\mu)^2 = \\pi \\sigma^2 + \\pi \\mu^2 - \\pi^2 \\mu^2 = \\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi)$。\n3.  $\\operatorname{Cov}(R_i Y_i, R_i) = \\mathbb{E}[(R_i Y_i)R_i] - \\mathbb{E}[R_i Y_i]\\mathbb{E}[R_i]$。\n    $\\mathbb{E}[(R_i Y_i)R_i] = \\mathbb{E}[R_i^2 Y_i] = \\mathbb{E}[R_i Y_i] = \\pi \\mu$。\n    所以，$\\operatorname{Cov}(R_i Y_i, R_i) = \\pi \\mu - (\\pi \\mu)\\pi = \\pi \\mu (1-\\pi)$。\n\n协方差矩阵为：\n$$\n\\Sigma_W = \\begin{pmatrix} \\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi) & \\mu \\pi(1-\\pi) \\\\ \\mu \\pi(1-\\pi) & \\pi(1-\\pi) \\end{pmatrix}\n$$\n估计量 $\\hat{\\mu}_{\\text{cc}}$ 是 $W_i$ 样本均值的函数 $g$，其中 $g(a,b) = a/b$。设 $\\bar{W}_n = \\frac{1}{n} \\sum_{i=1}^n W_i$。根据多元中心极限定理，$\\sqrt{n}(\\bar{W}_n - \\mathbb{E}[W_i])$ 依分布收敛于一个均值为 $0$、协方差矩阵为 $\\Sigma_W$ 的多元正态分布。\n为求 $\\hat{\\mu}_{\\text{cc}} = g(\\bar{W}_n)$ 的渐近方差，我们使用 Delta 方法。$\\sqrt{n}(\\hat{\\mu}_{\\text{cc}} - \\mu)$ 的渐近方差由 $\\nabla g^T \\Sigma_W \\nabla g$ 给出，其中梯度 $\\nabla g$ 在 $\\mathbb{E}[W_i]$ 处求值。\n函数 $g(a,b)$ 的梯度为 $\\nabla g(a,b) = \\begin{pmatrix} 1/b \\\\ -a/b^2 \\end{pmatrix}$。\n在 $\\mathbb{E}[W_i] = (\\pi\\mu, \\pi)^T$ 处求值：\n$$\n\\nabla g(\\pi\\mu, \\pi) = \\begin{pmatrix} 1/\\pi \\\\ -\\pi\\mu/\\pi^2 \\end{pmatrix} = \\begin{pmatrix} 1/\\pi \\\\ -\\mu/\\pi \\end{pmatrix}\n$$\n现在我们计算二次型 $\\nabla g^T \\Sigma_W \\nabla g$：\n$$\n\\begin{pmatrix} \\frac{1}{\\pi} & -\\frac{\\mu}{\\pi} \\end{pmatrix} \\begin{pmatrix} \\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi) & \\mu \\pi(1-\\pi) \\\\ \\mu \\pi(1-\\pi) & \\pi(1-\\pi) \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\pi} \\\\ -\\frac{\\mu}{\\pi} \\end{pmatrix}\n$$\n首先，将行向量乘以矩阵：\n$$\n\\begin{pmatrix} \\frac{1}{\\pi}(\\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi)) - \\frac{\\mu}{\\pi}(\\mu \\pi(1-\\pi)) & \\frac{1}{\\pi}(\\mu \\pi(1-\\pi)) - \\frac{\\mu}{\\pi}(\\pi(1-\\pi)) \\end{pmatrix}\n$$\n第一个分量化简为：\n$$\n(\\sigma^2 + \\mu^2(1-\\pi)) - \\mu^2(1-\\pi) = \\sigma^2\n$$\n第二个分量化简为：\n$$\n\\mu(1-\\pi) - \\mu(1-\\pi) = 0\n$$\n所以中间结果是行向量 $\\begin{pmatrix} \\sigma^2 & 0 \\end{pmatrix}$。\n最后，我们将其乘以列向量：\n$$\n\\begin{pmatrix} \\sigma^2 & 0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\pi} \\\\ -\\frac{\\mu}{\\pi} \\end{pmatrix} = \\sigma^2 \\cdot \\frac{1}{\\pi} + 0 \\cdot \\left(-\\frac{\\mu}{\\pi}\\right) = \\frac{\\sigma^2}{\\pi}\n$$\n这就是 $\\sqrt{n}(\\hat{\\mu}_{\\text{cc}} - \\mu)$ 极限分布的方差。估计量 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差是此数量除以 $n$：\n$$\n\\text{Large-Sample Var}(\\hat{\\mu}_{\\text{cc}}) = \\frac{\\sigma^2}{n\\pi}\n$$\n最后，我们计算方差膨胀因子（VIF），即 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差与 $\\bar{Y}_{n}$ 的大样本方差之比：\n$$\n\\text{VIF} = \\frac{\\text{Large-Sample Var}(\\hat{\\mu}_{\\text{cc}})}{\\text{Large-Sample Var}(\\bar{Y}_{n})} = \\frac{\\frac{\\sigma^2}{n\\pi}}{\\frac{\\sigma^2}{n}}\n$$\n项 $\\sigma^2$ 和 $n$相互抵消，得到：\n$$\n\\text{VIF} = \\frac{1}{\\pi}\n$$\n这个结果是直观的：完整案例估计量的方差膨胀了一个因子，该因子等于观测概率的倒数。如果所有数据都被观测到（$\\pi=1$），方差膨胀因子为1，符合预期。如果只有一半数据被观测到（$\\pi=0.5$），方差则加倍。", "answer": "$$\n\\boxed{\\frac{1}{\\pi}}\n$$", "id": "4973778"}, {"introduction": "在认识到简单方法的局限性后，我们转向处理更普遍的“随机缺失”（MAR）情形。期望最大化（EM）算法是处理MAR数据时，基于似然推断的基石方法之一，但其内部机理常常被视为一个“黑箱”。本练习将揭开EM算法的神秘面纱，让你亲手完成一次完整的迭代计算，从而具体地理解算法是如何利用观测数据和模型假设来“填补”缺失信息的。[@problem_id:4973852]", "problem": "一项临床研究测量了每位患者的一对连续结果：血液生物标志物 $X$ 和生理指标 $Y$。假设 $(X,Y)$ 的联合分布为二元正态分布，其均值向量为 $\\mu = (\\mu_{x}, \\mu_{y})^{\\top}$，协方差矩阵为 $\\Sigma = \\begin{pmatrix} \\sigma_{xx} & \\sigma_{xy} \\\\ \\sigma_{xy} & \\sigma_{yy} \\end{pmatrix}$。对于某些患者，$X$ 值是缺失的，其缺失机制为随机缺失 (MAR)，这意味着在以 $Y$ 为条件的情况下，$X$ 缺失的概率可能依赖于 $Y$，但不依赖于 $X$。在参数独立的随机缺失（MAR）条件下，该缺失机制对于基于似然的推断是可忽略的。\n\n给定 $N=4$ 个独立观测值，其中 $Y$ 完全观测到，而 $X$ 可能缺失：$(x_{1}, y_{1}) = (-1, 0)$，$(x_{2} \\text{ 缺失}, y_{2} = 2)$，$(x_{3}, y_{3}) = (1,4)$，$(x_{4} \\text{ 缺失}, y_{4} = 6)$。假设期望最大化 (EM) 算法的当前参数迭代值为\n$$\n\\mu^{(0)} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\qquad \n\\Sigma^{(0)} = \\begin{pmatrix} 9 & 2 \\\\ 2 & 4 \\end{pmatrix}.\n$$\n\n从适用于此背景的第一性原理出发，即：(i) 随机缺失 (MAR) 机制的定义和参数独立下的可忽略性，(ii) 多元正态分布族的联合和条件分布性质，以及 (iii) 通过最大化期望完全数据对数似然来定义期望最大化 (EM) 算法，执行一次完整的 EM 迭代。在 E 步（期望步）中，在给定观测数据和当前参数 $\\mu^{(0)}$ 及 $\\Sigma^{(0)}$ 的条件下，计算完全数据对数似然的充分统计量的条件期望。在 M 步（最大化步）中，最大化期望完全数据对数似然，以在最大似然参数化下获得更新后的均值向量 $\\mu^{(1)}$ 和协方差矩阵 $\\Sigma^{(1)}$，其中协方差使用因子 $1/N$（而不是无偏因子）。\n\n提供 $\\mu_{x}^{(1)}$、$\\mu_{y}^{(1)}$、$\\sigma_{xx}^{(1)}$、$\\sigma_{xy}^{(1)}$ 和 $\\sigma_{yy}^{(1)}$ 的明确数值。不要四舍五入。将最终答案按 $\\mu_{x}^{(1)}$、$\\mu_{y}^{(1)}$、$\\sigma_{xx}^{(1)}$、$\\sigma_{xy}^{(1)}$、$\\sigma_{yy}^{(1)}$ 的顺序表示为单行矩阵。", "solution": "该问题是有效的，因为它在统计理论上有科学依据，提法明确，客观，并且包含了执行所要求计算的所有必要信息。\n\n期望最大化 (EM) 算法是一种迭代方法，用于在统计模型中寻找参数的最大似然估计，其中模型依赖于未观测到的潜变量。在本例中，未观测到的变量是血液生物标志物 $X$ 的缺失值。该算法在两个步骤之间交替进行：期望 (E) 步和最大化 (M) 步。\n\n设完全数据为 $Z = (X, Y)$，其中 $Z_i = (X_i, Y_i)^\\top$，对于 $i=1, \\dots, N$。假设数据来自一个二元正态分布 $\\mathcal{N}(\\mu, \\Sigma)$。我们有 $N=4$ 个观测值。观测数据包括 $Z_{obs} = \\{(x_1, y_1), y_2, (x_3, y_3), y_4\\}$，缺失数据为 $Z_{mis} = \\{x_2, x_4\\}$。在第 $t=0$ 次迭代时的初始参数估计为：\n$$\n\\mu^{(0)} = \\begin{pmatrix} \\mu_{x}^{(0)} \\\\ \\mu_{y}^{(0)} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\qquad \n\\Sigma^{(0)} = \\begin{pmatrix} \\sigma_{xx}^{(0)} & \\sigma_{xy}^{(0)} \\\\ \\sigma_{xy}^{(0)} & \\sigma_{yy}^{(0)} \\end{pmatrix} = \\begin{pmatrix} 9 & 2 \\\\ 2 & 4 \\end{pmatrix}.\n$$\n\n对于来自二元正态分布的 $N$ 个观测值，其完全数据对数似然在相差一个常数的情况下，与下式成正比：\n$$\nl(\\mu, \\Sigma; Z) \\propto - \\frac{N}{2} \\ln \\det(\\Sigma) - \\frac{1}{2} \\sum_{i=1}^{N} (Z_i - \\mu)^\\top \\Sigma^{-1} (Z_i - \\mu)\n$$\n该似然是正态分布的充分统计量的函数，即 $\\sum_{i=1}^N Z_i$ 和 $\\sum_{i=1}^N Z_i Z_i^\\top$。以分量形式表示，充分统计量为 $\\sum X_i$、$\\sum Y_i$、$\\sum X_i^2$、$\\sum Y_i^2$ 和 $\\sum X_i Y_i$。\n\n**E 步：计算充分统计量的条件期望**\n\n在 E 步中，我们计算在给定观测数据 $Z_{obs}$ 和当前参数估计 $\\theta^{(0)} = (\\mu^{(0)}, \\Sigma^{(0)})$ 的条件下，完全数据对数似然的期望。这等价于计算充分统计量的条件期望。\n对于 $X_i$ 和 $Y_i$ 都被观测到的观测值（即 $i=1, 3$），其统计量就是它们的观测值。\n对于 $X_i$ 缺失的观测值（即 $i=2, 4$），我们需要在给定 $Y_i=y_i$ 和 $\\theta^{(0)}$ 的条件下，计算 $X_i$ 及其函数的条件期望。\n\n对于一个二元正态分布，在给定 $Y=y$ 时 $X$ 的条件分布是一个一元正态分布 $X | Y=y \\sim \\mathcal{N}(\\mu_{x|y}, \\sigma^2_{x|y})$，其均值和方差为：\n$$\n\\mu_{x|y} = \\mu_x + \\frac{\\sigma_{xy}}{\\sigma_{yy}}(y - \\mu_y)\n$$\n$$\n\\sigma^2_{x|y} = \\sigma_{xx} - \\frac{\\sigma_{xy}^2}{\\sigma_{yy}}\n$$\n使用当前参数 $\\theta^{(0)}$：\n$$\n\\sigma^{2, (0)}_{x|y} = \\sigma_{xx}^{(0)} - \\frac{(\\sigma_{xy}^{(0)})^2}{\\sigma_{yy}^{(0)}} = 9 - \\frac{2^2}{4} = 9 - 1 = 8\n$$\n对于观测值 $i$ 的条件均值为：\n$$\n\\mu_{x|y_i}^{(0)} = \\mu_x^{(0)} + \\frac{\\sigma_{xy}^{(0)}}{\\sigma_{yy}^{(0)}}(y_i - \\mu_y^{(0)}) = 1 + \\frac{2}{4}(y_i - 2) = 1 + 0.5(y_i - 2)\n$$\n我们需要计算 $i=2, 4$ 时的条件期望 $E[X_i | y_i, \\theta^{(0)}]$ 和 $E[X_i^2 | y_i, \\theta^{(0)}]$。对于一个正态变量 $W \\sim \\mathcal{N}(\\mu_W, \\sigma_W^2)$，我们有 $E[W] = \\mu_W$ 和 $E[W^2] = \\text{Var}(W) + (E[W])^2 = \\sigma_W^2 + \\mu_W^2$。\n\n对于观测值 $i=2$，$y_2=2$：\n$$\nE[X_2 | y_2=2, \\theta^{(0)}] = 1 + 0.5(2-2) = 1\n$$\n$$\nE[X_2^2 | y_2=2, \\theta^{(0)}] = \\sigma^{2, (0)}_{x|y} + (E[X_2 | y_2=2, \\theta^{(0)}])^2 = 8 + 1^2 = 9\n$$\n$$\nE[X_2 Y_2 | y_2=2, \\theta^{(0)}] = y_2 E[X_2 | y_2=2, \\theta^{(0)}] = 2 \\times 1 = 2\n$$\n\n对于观测值 $i=4$，$y_4=6$：\n$$\nE[X_4 | y_4=6, \\theta^{(0)}] = 1 + 0.5(6-2) = 1 + 0.5(4) = 3\n$$\n$$\nE[X_4^2 | y_4=6, \\theta^{(0)}] = \\sigma^{2, (0)}_{x|y} + (E[X_4 | y_4=6, \\theta^{(0)}])^2 = 8 + 3^2 = 8 + 9 = 17\n$$\n$$\nE[X_4 Y_4 | y_4=6, \\theta^{(0)}] = y_4 E[X_4 | y_4=6, \\theta^{(0)}] = 6 \\times 3 = 18\n$$\n\n现在我们计算所有 $N=4$ 个观测值的总期望充分统计量。我们将 $E^{(0)}[\\cdot]$ 记为 $E[\\cdot | Z_{obs}, \\theta^{(0)}]$。\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 X_i\\right] = x_1 + E[X_2 | \\dots] + x_3 + E[X_4 | \\dots] = -1 + 1 + 1 + 3 = 4\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 Y_i\\right] = \\sum_{i=1}^4 y_i = 0 + 2 + 4 + 6 = 12 \\quad (\\text{因为 } Y \\text{ 是完全观测的})\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 X_i^2\\right] = x_1^2 + E[X_2^2 | \\dots] + x_3^2 + E[X_4^2 | \\dots] = (-1)^2 + 9 + 1^2 + 17 = 1 + 9 + 1 + 17 = 28\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 Y_i^2\\right] = \\sum_{i=1}^4 y_i^2 = 0^2 + 2^2 + 4^2 + 6^2 = 0 + 4 + 16 + 36 = 56\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 X_i Y_i\\right] = x_1 y_1 + E[X_2 Y_2 | \\dots] + x_3 y_3 + E[X_4 Y_4 | \\dots] = (-1)(0) + 2 + (1)(4) + 18 = 0 + 2 + 4 + 18 = 24\n$$\n\n**M 步：最大化期望对数似然**\n\n在 M 步中，我们找到使期望完全数据对数似然最大化的参数 $\\theta^{(1)}=(\\mu^{(1)}, \\Sigma^{(1)})$。这是通过使用二元正态分布的标准最大似然估计量完成的，其中充分统计量被替换为在 E 步中计算出的它们的条件期望。\n\n更新后的均值向量 $\\mu^{(1)}$ 为：\n$$\n\\mu_x^{(1)} = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^4 X_i\\right] = \\frac{4}{4} = 1\n$$\n$$\n\\mu_y^{(1)} = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^4 Y_i\\right] = \\frac{12}{4} = 3\n$$\n所以，$\\mu^{(1)} = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$。\n\n更新后的协方差矩阵 $\\Sigma^{(1)}$ (对最大似然估计使用因子 $1/N$) 为：\n$$\n\\Sigma^{(1)} = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^N (Z_i - \\mu^{(1)})(Z_i - \\mu^{(1)})^\\top\\right] = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^N Z_i Z_i^\\top\\right] - \\mu^{(1)}(\\mu^{(1)})^\\top\n$$\n首先，我们计算期望二阶矩矩阵：\n$$\n\\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^N Z_i Z_i^\\top\\right] = \\frac{1}{4} \\begin{pmatrix} E^{(0)}[\\sum X_i^2] & E^{(0)}[\\sum X_i Y_i] \\\\ E^{(0)}[\\sum X_i Y_i] & E^{(0)}[\\sum Y_i^2] \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 28 & 24 \\\\ 24 & 56 \\end{pmatrix} = \\begin{pmatrix} 7 & 6 \\\\ 6 & 14 \\end{pmatrix}\n$$\n接着，我们计算新均值的外积：\n$$\n\\mu^{(1)}(\\mu^{(1)})^\\top = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} \\begin{pmatrix} 1 & 3 \\end{pmatrix} = \\begin{pmatrix} 1 & 3 \\\\ 3 & 9 \\end{pmatrix}\n$$\n最后，我们计算 $\\Sigma^{(1)}$：\n$$\n\\Sigma^{(1)} = \\begin{pmatrix} 7 & 6 \\\\ 6 & 14 \\end{pmatrix} - \\begin{pmatrix} 1 & 3 \\\\ 3 & 9 \\end{pmatrix} = \\begin{pmatrix} 7-1 & 6-3 \\\\ 6-3 & 14-9 \\end{pmatrix} = \\begin{pmatrix} 6 & 3 \\\\ 3 & 5 \\end{pmatrix}\n$$\n更新后的协方差矩阵的元素是 $\\sigma_{xx}^{(1)} = 6$，$\\sigma_{xy}^{(1)} = 3$ 和 $\\sigma_{yy}^{(1)} = 5$。\n\n一次完整 EM 迭代的结果是更新后的参数：\n$\\mu_{x}^{(1)} = 1$\n$\\mu_{y}^{(1)} = 3$\n$\\sigma_{xx}^{(1)} = 6$\n$\\sigma_{xy}^{(1)} = 3$\n$\\sigma_{yy}^{(1)} = 5$\n这些是所要求的数值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 1 & 3 & 6 & 3 & 5 \\end{pmatrix}\n}\n$$", "id": "4973852"}, {"introduction": "EM算法等高级方法虽然强大，但它们的有效性通常建立在难以直接验证的MAR假设之上。那么，在实际研究中，我们如何评估MAR假设的合理性呢？本练习将我们的注意力从理论计算转向应用统计的艺术，指导你如何利用观测到的数据和协变量，设计一套图形化的诊断方法来探索缺失模式。这是成为一名优秀应用统计学家所必需的批判性思维和实践技能。[@problem_id:4973812]", "problem": "一个国家心血管临床登记系统记录了入院时的连续生物标志物 $Y$ 以及高质量的协变量信息 $X$（包括年龄、性别、地点、日历时间、疾病严重程度评分、血压和合并症计数）。生物标志物 $Y$ 存在项目无应答：定义缺失指示变量 $R$，$Y$ 被观测到时 $R=1$，$Y$ 缺失时 $R=0$。设观测数据为 $O=(R, RY, X)$。考虑通过 $R$ 在给定 $(Y, X)$ 下的条件分布定义的标准缺失机制：\n- 完全随机缺失 (Missing Completely At Random, MCAR): $P(R \\mid Y, X)=P(R)$。\n- 随机缺失 (Missing At Random, MAR): $P(R \\mid Y, X)=P(R \\mid X)$。\n- 非随机缺失 (Not Missing At Random, NMAR): $P(R \\mid Y, X)$ 即使在以 $X$ 为条件后，仍然依赖于 $Y$。\n\n您的任务是，仅使用该登记系统中的观测数据模式和协变量，在不为 $Y$ 施加结果模型且不依赖于关于未观测到的 $Y$ 的分布的不可验证假设的情况下，评估 $Y$ 缺失为随机缺失 (MAR) 的合理性。\n\n下列哪几组图形诊断方法构成了在此情境下评估 MAR 合理性的连贯且科学上可辩护的方法？选择所有适用项。\n\nA. 为响应倾向 $P(R=0 \\mid X)$ 拟合一个灵活的模型（例如，使用 $X$ 的逻辑回归或广义可加模型），然后构建：\n- 响应倾向分层图，通过将观测值按预测的 $P(R=0 \\mid X)$ 分为 $k$ 个分位数组（例如，$k=10$），并将每个分位数内的观测缺失比例与模型预测值叠加（校准图），\n- 协变量平衡图，在倾向分位数内比较 $R=1$ 与 $R=0$ 之间 $X$ 关键组成部分的分布，以评估缺失是否能被观测到的 $X$ 充分解释，\n- 拟合的 $P(R=0 \\mid X)$ 相对于 $X$ 中单个协变量的部分依赖图，以可视化缺失对 $X$ 的依赖的函数形式。\n\nB. 创建观测到的 $Y$ 与 $Y$ 对 $X$ 的回归残差的散点图，适用于 $R=1$ 和 $R=0$ 两种情况，并检查两组的残差是否都以 0 为中心；如果是，则断定 MAR 成立。\n\nC. 将注意力限制在 $R=1$ 的情况，并为响应者中的结果模型 $Y \\sim X$ 制作分位数-分位数图和残差诊断图；如果这些图看起来表现良好，则声明缺失机制为 MAR。\n\nD. 构建面向登记系统流程的缺失可视化图，包括：\n- 在“地点-日历时间”单元格之间绘制缺失率 $\\hat{P}(R=0)$ 的双向热图，以检测缺失的操作性驱动因素，\n- 针对 $X$ 中分类协变量（如性别、地点）的马赛克图，其阴影与局部缺失率成比例，以及 $R$ 相对于连续协变量（如年龄、疾病严重程度评分）的平滑曲线图，\n- 在对 $Y$ 有强预测性的 $X$ 的分层内（例如，疾病严重程度评分的十分位数），比较一个与 $Y$ 有临床关联的辅助变量 $Z$（例如，$Y$ 的先前测量值或一个密切相关的实验室检查值）在 $R=1$ 和 $R=0$ 之间的分布；评估在以 $X$ 为条件后，$Z$ 在不同 $R$ 值间的差异是否减弱或消失。\n\nE. 使用观测数据 $O$ 应用 Little 检验来测试 MCAR；如果 MCAR 被拒绝，则推断该机制为非随机缺失 (NMAR)。为了可视化，绘制 $R=1$ 时的 $Y$ 的直方图，并将其与总体直方图进行比较；如果它们不同，则断定为 NMAR。", "solution": "基本依据是缺失机制的正式定义，即缺失指示变量 $R$ 在给定完整数据 $(Y, X)$ 下的条件分布。在完全随机缺失 (MCAR) 情况下，$P(R \\mid Y, X)=P(R)$，因此缺失不依赖于任何数据。在随机缺失 (MAR) 情况下，$P(R \\mid Y, X)=P(R \\mid X)$，因此缺失可能依赖于观测到的协变量 $X$，但在给定 $X$ 的条件下，不依赖于未观测到的 $Y$ 值。在非随机缺失 (NMAR) 情况下，即使在以 $X$ 为条件后，缺失仍然依赖于 $Y$，即 $P(R \\mid Y, X)$ 仍然保留对 $Y$ 的依赖性。\n\n观测数据是 $O=(R, RY, X)$，因此对于 $R=0$ 的情况，我们观测不到 $Y$。因此，任何关于 $P(R \\mid Y, X)$ 是否依赖于 $Y$ 的评估都无法直接从 $O$ 中验证，因为在 $R=0$ 的子集中，$R$ 与未观测到的 $Y$ 的联合变异是不可获取的。因此，从基本原理上讲，没有任何图形诊断可以证明 MAR 或 NMAR。相反，评估 MAR 的合理性需要通过以下方式：\n- 对 $P(R=0 \\mid X)$ 进行建模，并检查观测到的协变量 $X$ 是否能完全解释缺失模式，\n- 验证 $X$ 中捕获的操作和设计特征是否与观测到的缺失结构一致，\n- 使用对 $Y$ 有预测性的辅助变量 $Z$（包含在 $X$ 中或额外观测到的）来检查 $R=1$ 和 $R=0$ 之间的差异是否能被 $X$ 解释。\n\n如果缺失能被 $X$ 很好地解释，并且没有残留的模式能可信地表明在 $X$ 之外还存在对未观测到的 $Y$ 的依赖，那么 MAR 就变得合理。如果缺失看起来与 $X$ 无关，这与 MCAR 相容。如果存在强烈的、无法解释的模式，这些模式即使在以 $X$ 为条件后，仍需要依赖于未观测到的 $Y$，那么 NMAR 就变得更合理，但仅凭 $O$ 无法识别。\n\n逐项分析：\n\nA. 该选项直接对 $P(R=0 \\mid X)$ 进行建模和可视化，这是表征 MAR 的对象。校准图通过比较倾向分位数内的观测缺失率与预测值，检查了 $P(R=0 \\mid X)$ 模型在 $X$ 方面是否设定良好。倾向分层内的协变量平衡图评估了在以观测到的 $X$ 为条件下，$R=1$ 和 $R=0$ 之间的剩余差异是否很小，这支持了缺失是由 $X$ 驱动的观点（与 MAR 一致）。部分依赖图可视化了缺失如何随 $X$ 中的单个协变量变化，有助于检测非线性或交互作用。所有这些都只使用 $O$ 并针对 $P(R=0 \\mid X)$，这正是与 MAR 相关的对象。这是一套用于评估 MAR 合理性的连贯且科学上可辩护的图形诊断方法。结论：正确。\n\nB. 该选项提议为 $R=1$ 和 $R=0$ 两种情况绘制观测到的 $Y$ 与残差的散点图。对于 $R=0$，$Y$ 是未观测到的，因此，若无插补假设，无法构建此类图。此外，残差以 0 为中心并不能提供关于 $P(R \\mid Y, X)$ 的信息；它关系到的是响应者中的结果模型 $E(Y \\mid X)$。这违反了仅使用观测数据来评估缺失机制的约束，并且将结果模型的充分性与缺失机制的验证混为一谈。结论：错误。\n\nC. 将注意力限制在 $R=1$ 并评估响应者中 $Y \\sim X$ 的结果模型诊断，并不能检验缺失机制 $P(R \\mid Y, X)$，且在响应者中良好的模型拟合不能证明 MAR 是合理的。表现良好的残差的出现并没有说明 $R$ 是否依赖于未观测到的 $Y$。该选项既没有在诊断中使用缺失指示变量 $R$，也没有针对 $P(R=0 \\mid X)$。结论：错误。\n\nD. 该选项侧重于使用热图、马赛克图和平滑曲线图，来可视化缺失在操作性协变量（地点、日历时间）和临床协变量（年龄、严重程度）之间的变化。这类可视化描绘了 $\\hat{P}(R=0)$ 在 $X$ 上的分布，这直接提供了关于 $P(R=0 \\mid X)$ 的信息。引入一个与 $Y$ 相关的辅助变量 $Z$，并在 $X$ 的分层内检查 $Z$ 在不同 $R$ 值间的差异，是一种有原则的方法，用以探究观测到的协变量是否合理地捕捉到了缺失的驱动因素；在以 $X$ 为条件后，$Z$ 差异的减弱支持了缺失是由 $X$ 解释的这一观点，这与 MAR 一致。所有元素都只依赖于 $O$，并且在科学上是连贯的。结论：正确。\n\nE. Little 检验是用于检验 MCAR 的一种正式方法。拒绝 MCAR 并不意味着是 NMAR；当 MCAR 被拒绝时，MAR 是一个常见的替代选项。提议的图形化步骤——比较 $R=1$ 时的 $Y$ 的直方图与总体直方图——在没有建模或插补的情况下是无法对总体分布执行的，并且仅凭响应者中 $Y$ 的差异无法诊断缺失机制。从拒绝 MCAR 到断定 NMAR 的推断跳跃，在存在 MAR 的情况下在逻辑上是无效的。结论：错误。\n\n因此，在给定的选项中，用于评估 MAR 合理性的连贯且科学上可辩护的图形诊断方法是 A 和 D。", "answer": "$$\\boxed{AD}$$", "id": "4973812"}]}