{"hands_on_practices": [{"introduction": "本练习从基本原理出发构建了多重共线性的概念。通过构造一个假设场景，其中一个预测变量是另一个预测变量的含噪版本，我们可以解析地推导出协方差结构如何导致统计不稳定性。该练习将预测变量冗余的直观概念与预测变量协方差矩阵中接近零的特征值这一形式化的数学概念联系起来，从而提供了对多重共线性根本原因的深刻理解 [@problem_id:4952375]。", "problem": "收集了一个临床数据集，用于使用两个连续预测变量来为一个连续结果 $y$ 建模。这两个预测变量代表两种实验室检测，它们以不同的噪声特性测量同一个潜在的生物标志物。对于每个受试者 $i \\in \\{1,\\dots,n\\}$，假设预测变量按如下方式生成：$x_{1i} \\sim \\mathcal{N}(0,\\sigma_{x}^{2})$，$\\epsilon_{i} \\sim \\mathcal{N}(0,\\tau^{2})$，其中 $x_{1i}$ 和 $\\epsilon_{i}$ 独立，并定义 $x_{2i} = x_{1i} + \\epsilon_{i}$。假设 $\\{(x_{1i},x_{2i})\\}_{i=1}^{n}$ 在 $i$ 上是独立同分布的，并且预测变量与线性模型 $y_{i} = \\beta_{0} + \\beta_{1} x_{1i} + \\beta_{2} x_{2i} + u_{i}$ 中的回归误差无关。考虑预测变量的 $2 \\times 2$ 总体协方差矩阵，\n$$\n\\Sigma = \\mathbb{E}\\left[\\begin{pmatrix} x_{1i} \\\\ x_{2i} \\end{pmatrix} \\begin{pmatrix} x_{1i}  x_{2i} \\end{pmatrix}\\right].\n$$\n从方差、协方差和特征值的定义出发，推导出 $\\Sigma$ 的最小特征值的精确闭式表达式，该表达式是 $\\sigma_{x}^{2}$ 和 $\\tau^{2}$ 的函数，并解释极限 $\\tau \\to 0$ 如何通过预测变量矩阵 $X$ 的秩将近似多重共线性与完全多重共线性联系起来。你最终报告的答案必须是 $\\Sigma$ 的最小特征值的精确解析表达式。不需要数值近似。", "solution": "该问题陈述被评估为有效。它在科学上基于统计学和线性代数的原理，提法恰当，为得到唯一解提供了所有必要信息，并且其表述是客观的。该问题提出了一个用于研究多重共线性的标准、可形式化的情景。\n\n主要目标是推导预测变量 $x_{1i}$ 和 $x_{2i}$ 的总体协方差矩阵 $\\Sigma$ 的最小特征值。首先，我们必须构建矩阵 $\\Sigma$。预测变量定义为 $x_{1i} \\sim \\mathcal{N}(0, \\sigma_{x}^{2})$，$\\epsilon_{i} \\sim \\mathcal{N}(0, \\tau^{2})$，其中 $x_{1i}$ 和 $\\epsilon_{i}$ 独立，且 $x_{2i} = x_{1i} + \\epsilon_{i}$。\n\n总体协方差矩阵由以下公式给出：\n$$\n\\Sigma = \\begin{pmatrix} \\text{Var}(x_{1i})  \\text{Cov}(x_{1i}, x_{2i}) \\\\ \\text{Cov}(x_{2i}, x_{1i})  \\text{Var}(x_{2i}) \\end{pmatrix}\n$$\n由于问题陈述生成正态分布的均值为 $0$，我们有 $\\mathbb{E}[x_{1i}] = 0$ 和 $\\mathbb{E}[x_{2i}] = \\mathbb{E}[x_{1i} + \\epsilon_{i}] = \\mathbb{E}[x_{1i}] + \\mathbb{E}[\\epsilon_{i}] = 0 + 0 = 0$。\n\n让我们计算 $\\Sigma$ 的各个分量：\n1.  $x_{1i}$ 的方差由其定义直接给出：\n    $$\n    \\text{Var}(x_{1i}) = \\sigma_{x}^{2}\n    $$\n2.  $x_{2i}$ 的方差是利用独立随机变量和的方差性质计算的。由于 $x_{1i}$ 和 $\\epsilon_i$ 独立：\n    $$\n    \\text{Var}(x_{2i}) = \\text{Var}(x_{1i} + \\epsilon_{i}) = \\text{Var}(x_{1i}) + \\text{Var}(\\epsilon_{i}) = \\sigma_{x}^{2} + \\tau^{2}\n    $$\n3.  $x_{1i}$ 和 $x_{2i}$ 之间的协方差计算如下：\n    $$\n    \\text{Cov}(x_{1i}, x_{2i}) = \\text{Cov}(x_{1i}, x_{1i} + \\epsilon_{i})\n    $$\n    利用协方差的双线性性质：\n    $$\n    \\text{Cov}(x_{1i}, x_{1i} + \\epsilon_{i}) = \\text{Cov}(x_{1i}, x_{1i}) + \\text{Cov}(x_{1i}, \\epsilon_{i})\n    $$\n    一个变量与自身的协方差是其方差，所以 $\\text{Cov}(x_{1i}, x_{1i}) = \\text{Var}(x_{1i}) = \\sigma_{x}^{2}$。由于 $x_{1i}$ 和 $\\epsilon_{i}$ 独立且均值为零，它们的协方差为零：$\\text{Cov}(x_{1i}, \\epsilon_{i}) = \\mathbb{E}[x_{1i} \\epsilon_{i}] - \\mathbb{E}[x_{1i}]\\mathbb{E}[\\epsilon_{i}] = 0 - 0 \\cdot 0 = 0$。\n    因此：\n    $$\n    \\text{Cov}(x_{1i}, x_{2i}) = \\sigma_{x}^{2}\n    $$\n\n组合这些分量，总体协方差矩阵为：\n$$\n\\Sigma = \\begin{pmatrix} \\sigma_{x}^{2}  \\sigma_{x}^{2} \\\\ \\sigma_{x}^{2}  \\sigma_{x}^{2} + \\tau^{2} \\end{pmatrix}\n$$\n\n接下来，我们通过求解特征方程 $\\det(\\Sigma - \\lambda I) = 0$ 来找到 $\\Sigma$ 的特征值 $\\lambda$，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det\\left( \\begin{pmatrix} \\sigma_{x}^{2} - \\lambda  \\sigma_{x}^{2} \\\\ \\sigma_{x}^{2}  \\sigma_{x}^{2} + \\tau^{2} - \\lambda \\end{pmatrix} \\right) = 0\n$$\n$$\n(\\sigma_{x}^{2} - \\lambda)(\\sigma_{x}^{2} + \\tau^{2} - \\lambda) - (\\sigma_{x}^{2})^{2} = 0\n$$\n这导出了关于 $\\lambda$ 的二次方程：\n$$\n\\lambda^{2} - (\\text{tr}(\\Sigma))\\lambda + \\det(\\Sigma) = 0\n$$\n$\\Sigma$ 的迹是 $\\text{tr}(\\Sigma) = \\sigma_{x}^{2} + (\\sigma_{x}^{2} + \\tau^{2}) = 2\\sigma_{x}^{2} + \\tau^{2}$。\n$\\Sigma$ 的行列式是 $\\det(\\Sigma) = \\sigma_{x}^{2}(\\sigma_{x}^{2} + \\tau^{2}) - (\\sigma_{x}^{2})^{2} = \\sigma_{x}^{4} + \\sigma_{x}^{2}\\tau^{2} - \\sigma_{x}^{4} = \\sigma_{x}^{2}\\tau^{2}$。\n特征方程是：\n$$\n\\lambda^{2} - (2\\sigma_{x}^{2} + \\tau^{2})\\lambda + \\sigma_{x}^{2}\\tau^{2} = 0\n$$\n我们使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $\\lambda$：\n$$\n\\lambda = \\frac{(2\\sigma_{x}^{2} + \\tau^{2}) \\pm \\sqrt{(-(2\\sigma_{x}^{2} + \\tau^{2}))^{2} - 4(1)(\\sigma_{x}^{2}\\tau^{2})}}{2}\n$$\n$$\n\\lambda = \\frac{1}{2}\\left( 2\\sigma_{x}^{2} + \\tau^{2} \\pm \\sqrt{(2\\sigma_{x}^{2} + \\tau^{2})^{2} - 4\\sigma_{x}^{2}\\tau^{2}} \\right)\n$$\n让我们简化判别式：\n$$\n(2\\sigma_{x}^{2} + \\tau^{2})^{2} - 4\\sigma_{x}^{2}\\tau^{2} = (4\\sigma_{x}^{4} + 4\\sigma_{x}^{2}\\tau^{2} + \\tau^{4}) - 4\\sigma_{x}^{2}\\tau^{2} = 4\\sigma_{x}^{4} + \\tau^{4}\n$$\n将此代回 $\\lambda$ 的解中：\n$$\n\\lambda = \\frac{1}{2}\\left( 2\\sigma_{x}^{2} + \\tau^{2} \\pm \\sqrt{4\\sigma_{x}^{4} + \\tau^{4}} \\right)\n$$\n两个特征值为：\n$$\n\\lambda_{1} = \\frac{1}{2}\\left( 2\\sigma_{x}^{2} + \\tau^{2} + \\sqrt{4\\sigma_{x}^{4} + \\tau^{4}} \\right) \\quad \\text{和} \\quad \\lambda_{2} = \\frac{1}{2}\\left( 2\\sigma_{x}^{2} + \\tau^{2} - \\sqrt{4\\sigma_{x}^{4} + \\tau^{4}} \\right)\n$$\n由于 $\\sigma_{x}^{2}$ 和 $\\tau^{2}$ 是方差，它们是非负的。对于任何预测有意义的非平凡情况，$\\sigma_{x}^{2}  0$。因此，项 $\\sqrt{4\\sigma_{x}^{4} + \\tau^{4}}$ 是实数且为正。最小的特征值是 $\\lambda_{2}$，我们记作 $\\lambda_{\\text{min}}$。\n\n最小特征值的精确闭式表达式为：\n$$\n\\lambda_{\\text{min}} = \\frac{1}{2}\\left( 2\\sigma_{x}^{2} + \\tau^{2} - \\sqrt{4\\sigma_{x}^{4} + \\tau^{4}} \\right)\n$$\n\n问题的第二部分要求使用极限 $\\tau \\to 0$ 来解释近似多重共线性与完全多重共线性之间的联系。多重共线性通过预测变量协方差矩阵的小特征值来诊断。\n当 $\\tau^{2}  0$ 时，预测变量 $x_{1i}$ 和 $x_{2i}$ 并非完全线性相关。相关系数为 $\\rho = \\frac{\\sigma_{x}^{2}}{\\sqrt{\\sigma_{x}^{2}(\\sigma_{x}^{2}+\\tau^{2})}} = \\frac{\\sigma_{x}}{\\sqrt{\\sigma_{x}^{2}+\\tau^{2}}}  1$。因为对于 $\\sigma_x^20, \\tau^20$，有 $\\sqrt{4\\sigma_{x}^{4} + \\tau^{4}}  \\sqrt{(2\\sigma_{x}^{2} + \\tau^{2})^{2}} = 2\\sigma_{x}^{2} + \\tau^{2}$，所以最小特征值 $\\lambda_{\\text{min}}$ 严格为正。一个小的正值 $\\lambda_{\\text{min}}$（当 $\\tau^{2}$ 相对于 $\\sigma_{x}^{2}$ 很小时出现）表示近似多重共线性。在这种状态下，$n \\times 2$ 的预测变量矩阵 $X$ 具有线性无关的列，并且是满秩的，即 $\\text{rank}(X)=2$。\n\n现在，考虑噪声方差 $\\tau^{2}$ 趋近于零的极限。\n$$\n\\lim_{\\tau \\to 0} \\lambda_{\\text{min}} = \\lim_{\\tau \\to 0} \\frac{1}{2}\\left( 2\\sigma_{x}^{2} + \\tau^{2} - \\sqrt{4\\sigma_{x}^{4} + \\tau^{4}} \\right)\n$$\n$$\n= \\frac{1}{2}\\left( 2\\sigma_{x}^{2} + 0 - \\sqrt{4\\sigma_{x}^{4} + 0} \\right) = \\frac{1}{2}\\left( 2\\sigma_{x}^{2} - \\sqrt{4\\sigma_{x}^{4}} \\right) = \\frac{1}{2}\\left( 2\\sigma_{x}^{2} - 2\\sigma_{x}^{2} \\right) = 0\n$$\n特征值为零表示协方差矩阵 $\\Sigma$ 是奇异的。在此极限下，$\\Sigma$ 变为：\n$$\n\\lim_{\\tau \\to 0} \\Sigma = \\begin{pmatrix} \\sigma_{x}^{2}  \\sigma_{x}^{2} \\\\ \\sigma_{x}^{2}  \\sigma_{x}^{2} \\end{pmatrix}\n$$\n该矩阵的列是相同的，这是线性相关的明确标志。这对应于总体中的完全多重共线性，因为 $x_{2i} \\to x_{1i}$。\n这种总体层面的奇异性反映在样本数据矩阵 $X$ 中。当 $\\tau \\to 0$ 时，$X$ 的第二个列向量，即 $(x_{11}+\\epsilon_{1}, \\dots, x_{1n}+\\epsilon_{n})^T$，收敛于第一个列向量 $(x_{11}, \\dots, x_{1n})^T$。这两列变得相同，意味着它们是完全线性相关的。因此，矩阵 $X$ 的秩从 $2$ 降到 $1$。秩亏的预测变量矩阵是完全多重共线性的定义。因此，极限 $\\tau \\to 0$ 展示了从近似多重共线性（$\\lambda_{\\text{min}}  0$，$\\text{rank}(X)=2$）到完全多重共线性（$\\lambda_{\\text{min}} = 0$，$\\text{rank}(X)=1$）的连续过渡。", "answer": "$$\n\\boxed{\\frac{1}{2}\\left(2\\sigma_{x}^{2} + \\tau^{2} - \\sqrt{4\\sigma_{x}^{4} + \\tau^{4}}\\right)}\n$$", "id": "4952375"}, {"introduction": "在掌握了多重共线性的理论基础后，下一步是在实践中对其进行度量。本练习介绍了方差膨胀因子（VIF），这是诊断多重共线性最广泛使用的工具。你将根据给定的预测变量相关矩阵，亲手计算VIF值，从而巩固你对VIF如何精确量化因与其他预测变量相关而导致的回归系数方差增大的理解 [@problem_id:4952398]。", "problem": "一个生物医学研究团队正在建立一个多元线性回归模型，以研究一个慢性肾脏病患者队列中的连续肾脏风险评分 $Y$。模型包含三个临床相关的预测变量：血清肌酐 $X_{1}$、估算肾小球滤过率 $X_{2}$ 和年龄 $X_{3}$。每个预测变量都已标准化为零均值和单位方差，得到的设计矩阵其列为 $(Z_{1}, Z_{2}, Z_{3})$。$(Z_{1}, Z_{2}, Z_{3})$ 的样本相关系数矩阵是\n$$\n\\mathbf{R} \\;=\\;\n\\begin{pmatrix}\n1  -0.82  0.45 \\\\\n-0.82  1  -0.60 \\\\\n0.45  -0.60  1\n\\end{pmatrix}.\n$$\n从普通最小二乘（OLS）估计量和方差膨胀因子（VIF）的定义出发，从第一性原理推导每个系数的方差膨胀是如何由预测变量相关性结构的逆矩阵产生的。然后，显式地对矩阵 $\\mathbf{R}$ 求逆，并计算 $j \\in \\{1,2,3\\}$ 时的 $\\operatorname{VIF}_{j}$。最后，基于将 $Z_{j}$ 对其余预测变量进行回归时的决定系数 $R^{2}_{j}$，从预测变量 $Z_{j}$ 相对于其他两个预测变量的冗余性角度解释每个值。\n\n将 $(\\operatorname{VIF}_{1}, \\operatorname{VIF}_{2}, \\operatorname{VIF}_{3})$ 的最终数值答案四舍五入到四位有效数字。将最终的VIF向量表示为行矩阵。", "solution": "该问题要求从第一性原理推导方差膨胀因子（VIF），然后对一组给定的标准化预测变量进行计算和解释。\n\n### 第1部分：从第一性原理推导VIF\n\n标准多元线性回归模型用矩阵形式表示为：\n$$ \\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon} $$\n其中 $\\mathbf{y}$ 是响应变量观测值的 $n \\times 1$ 向量，$\\mathbf{X}$ 是一个 $n \\times (p+1)$ 的设计矩阵（包含一个截距列），$\\boldsymbol{\\beta}$ 是一个 $(p+1) \\times 1$ 的系数向量，$\\boldsymbol{\\epsilon}$ 是一个 $n \\times 1$ 的误差向量，满足 $\\mathbb{E}[\\boldsymbol{\\epsilon}] = \\mathbf{0}$ 和 $\\text{Var}(\\boldsymbol{\\epsilon}) = \\sigma^2 \\mathbf{I}_n$。\n\n$\\boldsymbol{\\beta}$ 的普通最小二乘（OLS）估计量是：\n$$ \\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y} $$\n该估计量的协方差矩阵是：\n$$ \\text{Var}(\\hat{\\boldsymbol{\\beta}}) = \\text{Var}((\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}) = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T \\text{Var}(\\mathbf{y}) \\mathbf{X}(\\mathbf{X}^T\\mathbf{X})^{-1} $$\n由于 $\\text{Var}(\\mathbf{y}) = \\text{Var}(\\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}) = \\text{Var}(\\boldsymbol{\\epsilon}) = \\sigma^2 \\mathbf{I}_n$，这可以简化为：\n$$ \\text{Var}(\\hat{\\boldsymbol{\\beta}}) = \\sigma^2 (\\mathbf{X}^T\\mathbf{X})^{-1} $$\n单个系数估计量 $\\hat{\\beta}_j$ 的方差是该矩阵的第 $j$ 个对角元素：\n$$ \\text{Var}(\\hat{\\beta}_j) = \\sigma^2 [(\\mathbf{X}^T\\mathbf{X})^{-1}]_{jj} $$\n问题陈述预测变量已被标准化为零均值和单位方差。设这些标准化预测变量的 $n \\times p$ 矩阵为 $\\mathbf{Z} = [Z_1, Z_2, \\dots, Z_p]$。由于预测变量是中心化的，截距项与它们正交。因此，我们可以专注于预测变量的系数，相关的矩阵是 $\\mathbf{Z}^T\\mathbf{Z}$。\n\n$\\mathbf{Z}^T\\mathbf{Z}$ 矩阵的第 $(i,j)$ 个元素是 $\\sum_{k=1}^{n} Z_{ki}Z_{kj}$。根据中心化变量的样本相关系数定义，$Z_i$ 和 $Z_j$ 之间的相关系数是 $r_{ij} = \\frac{\\sum_k Z_{ki}Z_{kj}}{\\sqrt{\\sum_k Z_{ki}^2 \\sum_k Z_{kj}^2}}$。由于变量是标准化的，它们的方差为1，并且 $\\sum_k Z_{ki}^2 = \\sum_k Z_{kj}^2 = n-1$。因此，$r_{ij} = \\frac{\\sum_k Z_{ki}Z_{kj}}{n-1}$。\n这意味着预测变量相关系数矩阵 $\\mathbf{R}$ 与 $\\mathbf{Z}^T\\mathbf{Z}$ 的关系如下：\n$$ \\mathbf{Z}^T\\mathbf{Z} = (n-1)\\mathbf{R} $$\n将此代入标准化模型的系数 $\\hat{\\boldsymbol{\\beta}}_\\text{std}$ 的方差公式中：\n$$ \\text{Var}(\\hat{\\boldsymbol{\\beta}}_\\text{std}) = \\sigma^2 (\\mathbf{Z}^T\\mathbf{Z})^{-1} = \\sigma^2 ((n-1)\\mathbf{R})^{-1} = \\frac{\\sigma^2}{n-1}\\mathbf{R}^{-1} $$\n第 $j$ 个系数估计量的方差是第 $j$ 个对角元素：\n$$ \\text{Var}(\\hat{\\beta}_j) = \\frac{\\sigma^2}{n-1} [\\mathbf{R}^{-1}]_{jj} $$\n方差膨胀因子（$\\text{VIF}_j$）被定义为由于共线性导致 $\\text{Var}(\\hat{\\beta}_j)$ 增大的因子，与预测变量 $Z_j$ 与所有其他预测变量正交的基准情景相比。在这种正交情况下，相关系数矩阵 $\\mathbf{R}$ 将是单位矩阵 $\\mathbf{I}$，其逆矩阵 $\\mathbf{R}^{-1}$ 也将是 $\\mathbf{I}$。第 $j$ 个对角元素将是 $[\\mathbf{I}]_{jj}=1$。在这种理想情况下的方差将是：\n$$ \\text{Var}(\\hat{\\beta}_j)_{\\text{ortho}} = \\frac{\\sigma^2}{n-1}(1) $$\nVIF是实际方差与此正交情况下方差的比率：\n$$ \\operatorname{VIF}_j = \\frac{\\text{Var}(\\hat{\\beta}_j)}{\\text{Var}(\\hat{\\beta}_j)_{\\text{ortho}}} = \\frac{\\frac{\\sigma^2}{n-1} [\\mathbf{R}^{-1}]_{jj}}{\\frac{\\sigma^2}{n-1}} = [\\mathbf{R}^{-1}]_{jj} $$\n此推导表明，第 $j$ 个预测变量的VIF精确地是预测变量相关系数矩阵 $\\mathbf{R}$ 的逆矩阵的第 $j$ 个对角元素。\n\n此外，相关系数矩阵逆的一个已知性质是，其对角元素与通过将第 $j$ 个预测变量 $Z_j$ 对剩余的 $p-1$ 个预测变量进行回归而获得的决定系数 $R^2_j$ 相关。关系式为：\n$$ \\operatorname{VIF}_j = [\\mathbf{R}^{-1}]_{jj} = \\frac{1}{1 - R^2_j} $$\n\n### 第2部分：VIF的计算\n\n给定的相关系数矩阵是：\n$$ \\mathbf{R} = \\begin{pmatrix} 1  -0.82  0.45 \\\\ -0.82  1  -0.60 \\\\ 0.45  -0.60  1 \\end{pmatrix} $$\n为了找到VIF，我们必须计算 $\\mathbf{R}^{-1}$。我们首先计算 $\\mathbf{R}$ 的行列式：\n$$ \\det(\\mathbf{R}) = 1(1 \\cdot 1 - (-0.60)^2) - (-0.82)((-0.82) \\cdot 1 - (-0.60) \\cdot 0.45) + 0.45((-0.82)(-0.60) - 1 \\cdot 0.45) $$\n$$ \\det(\\mathbf{R}) = 1(1 - 0.36) + 0.82(-0.82 + 0.27) + 0.45(0.492 - 0.45) $$\n$$ \\det(\\mathbf{R}) = 0.64 + 0.82(-0.55) + 0.45(0.042) $$\n$$ \\det(\\mathbf{R}) = 0.64 - 0.451 + 0.0189 = 0.2079 $$\n接下来，我们找到 $\\mathbf{R}$ 的伴随矩阵，它是其代数余子式矩阵 $\\mathbf{C}$ 的转置。\n$$ C_{11} = 1 - (-0.60)^2 = 1 - 0.36 = 0.64 $$\n$$ C_{22} = 1 - (0.45)^2 = 1 - 0.2025 = 0.7975 $$\n$$ C_{33} = 1 - (-0.82)^2 = 1 - 0.6724 = 0.3276 $$\n由于 $\\mathbf{R}$ 是对称矩阵，其代数余子式矩阵也是对称的，我们只需要对角线元素来计算VIF。\n逆矩阵为 $\\mathbf{R}^{-1} = \\frac{1}{\\det(\\mathbf{R})} \\text{adj}(\\mathbf{R})$。对角线元素为：\n$$ [\\mathbf{R}^{-1}]_{11} = \\frac{C_{11}}{\\det(\\mathbf{R})} = \\frac{0.64}{0.2079} $$\n$$ [\\mathbf{R}^{-1}]_{22} = \\frac{C_{22}}{\\det(\\mathbf{R})} = \\frac{0.7975}{0.2079} $$\n$$ [\\mathbf{R}^{-1}]_{33} = \\frac{C_{33}}{\\det(\\mathbf{R})} = \\frac{0.3276}{0.2079} $$\n现在我们计算VIF：\n$$ \\operatorname{VIF}_1 = [\\mathbf{R}^{-1}]_{11} \\approx 3.07840307... $$\n$$ \\operatorname{VIF}_2 = [\\mathbf{R}^{-1}]_{22} \\approx 3.83645983... $$\n$$ \\operatorname{VIF}_3 = [\\mathbf{R}^{-1}]_{33} \\approx 1.57575757... $$\n四舍五入到四位有效数字，我们得到：\n$$ \\operatorname{VIF}_1 \\approx 3.078 $$\n$$ \\operatorname{VIF}_2 \\approx 3.836 $$\n$$ \\operatorname{VIF}_3 \\approx 1.576 $$\n\n### 第3部分：解释\n\n我们使用关系式 $\\operatorname{VIF}_j = 1/(1 - R^2_j)$ 来解释这些值，这意味着 $R^2_j = 1 - 1/\\operatorname{VIF}_j$。\n\n对于预测变量 $Z_1$（血清肌酐）：\n- $\\operatorname{VIF}_1 = 3.078$。这意味着血清肌酐系数的方差是其在与eGFR和年龄不相关情况下的3.078倍。\n- $R^2_1 = 1 - 1/3.0784... = 1 - 0.3248... = 0.6751...$。这表明标准化血清肌酐（$Z_1$）中约67.5%的方差可以由标准化eGFR（$Z_2$）和年龄（$Z_3$）的线性组合来解释。这种共线性程度是中等的。\n\n对于预测变量 $Z_2$（eGFR）：\n- $\\operatorname{VIF}_2 = 3.836$。eGFR系数的方差是在没有共线性情况下的3.836倍。\n- $R^2_2 = 1 - 1/3.8364... = 1 - 0.2606... = 0.7393...$。这表明标准化eGFR（$Z_2$）中约73.9%的方差可以由标准化血清肌酐（$Z_1$）和年龄（$Z_3$）来解释。这表示中到高水平的冗余，这在临床上是预料之中的，因为eGFR通常是根据血清肌酐计算出来的。\n\n对于预测变量 $Z_3$（年龄）：\n- $\\operatorname{VIF}_3 = 1.576$。年龄系数的方差是在没有共线性情况下的1.576倍。\n- $R^2_3 = 1 - 1/1.5757... = 1 - 0.6346... = 0.3653...$。这表明标准化年龄（$Z_3$）中约36.5%的方差可以由标准化血清肌酐（$Z_1$）和eGFR（$Z_2$）来解释。这是低水平的共线性，表明与另外两个预测变量相比，年龄提供了相对独特的信息。\n\n总之，VIF值量化了多重共线性的程度。$Z_1$ 特别是 $Z_2$ 显示出中等程度的共线性，其中 $Z_2$（eGFR）是冗余性最强的预测变量，主要因为它与 $Z_1$（血清肌酐）在功能上相关。$Z_3$（年龄）的冗余性最低。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.078  3.836  1.576\n\\end{pmatrix}\n}\n$$", "id": "4952398"}, {"introduction": "虽然VIF对于评估单个预测变量的共线性很有用，但在多个预测变量组之间可能存在更复杂的依赖关系。本练习介绍了一个更强大的诊断工具：条件数，它源自预测变量矩阵的特征值。通过解决这个问题，你将学会如何计算和解释这些指数，从而不仅能诊断共线性问题的存在，还能评估其严重程度和结构，而这些可能是简单的诊断方法所忽略的 [@problem_id:4952344]。", "problem": "一位临床研究员使用来自高血压患者登记数据库的 $p=6$ 个预测变量拟合了一个多元线性回归模型，以对一年住院费用的对数进行建模。这些预测变量包括：年龄、身体质量指数、收缩压、舒张压、估计的肾小球滤过率以及抗高血压药物负荷评分。在构建设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 之前，每个预测变量都被中心化至均值为零并缩放至单位方差。令 $X^{\\top}X$ 表示 $p \\times p$ 的格拉姆矩阵。假设对 $X^{\\top}X$ 进行特征分解，得到（从大到小排列的）特征值\n$$\n\\{\\lambda_{1},\\lambda_{2},\\lambda_{3},\\lambda_{4},\\lambda_{5},\\lambda_{6}\\}=\\{220,95,25,3.2,0.50,0.020\\}。\n$$\n注意，$X^{\\top}X$ 是否除以 $n$ 并不影响下面使用的任何无量纲比率。\n\n仅从实对称正定矩阵的谱分解性质和 $X$ 的奇异值定义出发，完成以下任务：\n- 推导一个由 $\\{\\lambda_{i}\\}$ 计算得出的无量纲诊断指标，用以评估 $X^{\\top}X$ 在特定方向上接近奇异的程度，并解释该诊断指标为何与普通最小二乘（OLS）估计的稳定性相关。\n- 对上述每个 $\\lambda_{i}$ 计算该诊断指标。\n- 陈述你采用的用于标识中度和重度多重共线性的明确数值阈值，并基于 $X^{\\top}X$ 的近奇异性如何扩大 OLS 协方差分量来证明这些阈值的合理性。\n- 在你设定的阈值下，指出计算出的诊断指标中哪些表明存在有问题的多重共线性。\n\n最后，报告对于给定特征值，此诊断指标的最大值。将最终报告的数值四舍五入到四位有效数字。", "solution": "所述问题具有科学依据、提法明确且客观。它提出了一个基于线性代数和回归理论可靠原理的统计诊断标准任务。因此，我将提供一个完整的解答。\n\n主要任务是使用格拉姆矩阵 $X^{\\top}X$ 的特征值来推导并应用一个多重共线性的诊断指标。多重共线性指回归模型中预测变量之间存在的近似线性相关关系。它的存在会严重损害普通最小二乘（OLS）系数估计的稳定性和可解释性。\n\n系数向量 $\\beta$ 的 OLS 估计量由下式给出：\n$$\n\\hat{\\beta} = (X^{\\top}X)^{-1}X^{\\top}y\n$$\n其中 $y$ 是结果向量。$\\hat{\\beta}$ 的稳定性直接关系到矩阵 $(X^{\\top}X)^{-1}$ 的性质。OLS 估计量的协方差矩阵为：\n$$\n\\text{Cov}(\\hat{\\beta}) = \\sigma^2 (X^{\\top}X)^{-1}\n$$\n其中 $\\sigma^2$ 是模型误差的方差。各个系数估计的方差 $\\text{Var}(\\hat{\\beta}_j)$ 是该矩阵的对角线元素。高方差意味着估计值不精确且不稳定。\n\n格拉姆矩阵 $X^{\\top}X$ 是一个实对称半正定矩阵。假设 $X$ 的列是线性无关的，那么 $X^{\\top}X$ 是正定的。它可以进行谱分解：\n$$\nX^{\\top}X = V \\Lambda V^{\\top}\n$$\n其中 $V$ 是一个 $p \\times p$ 的正交矩阵，其列 $v_k$ 是 $X^{\\top}X$ 的特征向量，$\\Lambda$ 是一个包含相应特征值 $\\lambda_k$ 的对角矩阵，使得 $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\dots, \\lambda_p)$。那么其逆矩阵为：\n$$\n(X^{\\top}X)^{-1} = (V \\Lambda V^{\\top})^{-1} = V \\Lambda^{-1} V^{\\top}\n$$\n其中 $\\Lambda^{-1} = \\text{diag}(1/\\lambda_1, 1/\\lambda_2, \\dots, 1/\\lambda_p)$。\n\n系数估计的总方差是协方差矩阵的迹：\n$$\n\\sum_{j=1}^{p} \\text{Var}(\\hat{\\beta}_j) = \\text{tr}(\\text{Cov}(\\hat{\\beta})) = \\text{tr}(\\sigma^2 V \\Lambda^{-1} V^{\\top}) = \\sigma^2 \\text{tr}(\\Lambda^{-1} V^{\\top}V) = \\sigma^2 \\text{tr}(\\Lambda^{-1}) = \\sigma^2 \\sum_{k=1}^{p} \\frac{1}{\\lambda_k}\n$$\n这个方程揭示了，如果任何一个特征值 $\\lambda_k$ 接近于零，其倒数 $1/\\lambda_k$ 就会变得非常大，从而增大了系数估计的总方差。这表明 OLS 解是不稳定的。一个小的特征值 $\\lambda_k$ 意味着数据在相应特征向量 $v_k$ 的方向上表现出非常小的方差，这暗示了预测变量之间存在近似线性关系。\n\n为了形式化一个无量纲诊断指标，我们从设计矩阵 $X$ 的奇异值开始，奇异值被定义为 $X^{\\top}X$ 特征值的平方根。令奇异值为 $\\mu_k = \\sqrt{\\lambda_k}$。衡量一个矩阵的条件和接近奇异性的标准度量是其条件数。对于设计矩阵 $X$，条件数是其最大奇异值与最小奇异值的比值，即 $\\kappa(X) = \\mu_{\\text{max}} / \\mu_{\\text{min}}$。\n\n一个更详细的、评估特定方向上近奇异性的诊断指标是**条件指数**集。第 $k$ 个条件指数，记作 $\\eta_k$，定义为最大奇异值与第 $k$ 个奇异值的比率：\n$$\n\\eta_k = \\frac{\\mu_{\\text{max}}}{\\mu_k} = \\frac{\\sqrt{\\lambda_{\\text{max}}}}{\\sqrt{\\lambda_k}}\n$$\n按照惯例，特征值从大到小排列，所以 $\\lambda_{\\text{max}} = \\lambda_1$。因此，该诊断指标为：\n$$\n\\eta_k = \\sqrt{\\frac{\\lambda_1}{\\lambda_k}} \\quad \\text{for } k = 1, 2, \\dots, p\n$$\n这是一个无量纲的诊断指标。一个大的 $\\eta_k$ 值（$k  1$）表明 $\\lambda_k$ 远小于 $\\lambda_1$，这预示着与预测变量空间的第 $k$ 个主成分相关的潜在共线性问题。这就是问题所要求的诊断指标。\n\n现在，我们为给定的特征值计算这个诊断指标。排好序的特征值集合为：\n$$\n\\{\\lambda_{1},\\lambda_{2},\\lambda_{3},\\lambda_{4},\\lambda_{5},\\lambda_{6}\\}=\\{220,95,25,3.2,0.50,0.020\\}\n$$\n最大特征值为 $\\lambda_1 = 220$。条件指数计算如下：\n$$\n\\eta_1 = \\sqrt{\\frac{220}{220}} = \\sqrt{1} = 1\n$$\n$$\n\\eta_2 = \\sqrt{\\frac{220}{95}} \\approx \\sqrt{2.315789} \\approx 1.52177\n$$\n$$\n\\eta_3 = \\sqrt{\\frac{220}{25}} = \\sqrt{8.8} \\approx 2.96648\n$$\n$$\n\\eta_4 = \\sqrt{\\frac{220}{3.2}} = \\sqrt{68.75} \\approx 8.29156\n$$\n$$\n\\eta_5 = \\sqrt{\\frac{220}{0.50}} = \\sqrt{440} \\approx 20.97618\n$$\n$$\n\\eta_6 = \\sqrt{\\frac{220}{0.020}} = \\sqrt{11000} \\approx 104.88088\n$$\n\n接下来，我们建立并证明用于识别有问题的多重共线性的阈值是合理的。以下经验法则基于 Belsley、Kuh 和 Welsch 的工作，在实践中被广泛采用：\n- **中度多重共线性**：条件指数 $\\eta_k$ 在 $[10, 30)$ 范围内被认为表示中度到强度的线性相关性。\n- **重度多重共线性**：条件指数 $\\eta_k \\ge 30$ 被认为表示严重的线性相关性，它会严重降低回归估计的质量。\n\n这些阈值的合理性与线性系统的数值稳定性有关。一个条件指数 $\\eta_k = 10$ 意味着 $\\lambda_1/\\lambda_k = 100$，而 $\\eta_k = 30$ 意味着 $\\lambda_1/\\lambda_k = 900$。一个比最大特征值小两到三个数量级的特征值代表了预测变量空间中一个近乎退化的维度（即，数据云在该方向上几乎是平的）。这种近乎退化的情况会产生不稳定性，因为输入数据的微小变化可能导致与该维度相关的系数估计发生巨大波动。当由小特征值引起的方差膨胀成为统计推断的一个问题时，这些阈值可作为实际的标记。\n\n最后，我们使用这些阈值来确定计算出的诊断指标中哪些表明存在有问题的多重共线性：\n- $\\eta_1, \\eta_2, \\eta_3, \\eta_4$：这些都小于 $10$，不表示存在问题。\n- $\\eta_5 \\approx 20.98$：该值在 $10$ 和 $30$ 之间，表示**中度多重共线性**。\n- $\\eta_6 \\approx 104.88$：该值大于 $30$，表示**重度多重共线性**。\n\n两个最小的特征值，$\\lambda_5 = 0.50$ 以及特别是 $\\lambda_6 = 0.020$，是此数据集中多重共线性的来源。此诊断指标的最大值是 $\\eta_6$。\n\n问题要求报告此诊断指标的最大值，并四舍五入到四位有效数字：\n$$\n\\eta_6 = \\sqrt{11000} \\approx 104.88088...\n$$\n四舍五入到四位有效数字得到 $104.9$。", "answer": "$$\n\\boxed{104.9}\n$$", "id": "4952344"}]}