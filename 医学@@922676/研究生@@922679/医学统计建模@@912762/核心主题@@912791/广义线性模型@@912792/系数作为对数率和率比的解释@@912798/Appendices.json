{"hands_on_practices": [{"introduction": "这个练习旨在建立泊松回归模型中系数与发生率比（Incidence Rate Ratio, IRR）之间的基本联系。通过从第一性原理出发进行推导，你将清楚地理解为何对系数取指数即可得到预测变量每增加一个单位时发生率的倍数变化。这项基础实践是后续更复杂模型解释的基石[@problem_id:4967689]。", "problem": "一个医院感染控制小组对在固定监测期内，每个重症监护室观察到的中心静脉导管相关血流感染数量进行建模。对于单元 $i$，观察到的计数为 $Y_i$，暴露量为总患者天数 $E_i$。该小组假设数据生成过程为 Poisson 分布，并使用一个带有对数连接函数和暴露偏移量的广义线性模型 (GLM)：\n$$\n\\log(\\mu_i) \\;=\\; \\log(E_i) \\;+\\; \\beta_0 \\;+\\; 0.5\\, X_i,\n$$\n其中 $\\mu_i$ 是单元 $i$ 的期望计数，$X_i$ 是一个连续的、单位化的侵入性操作风险指数，其构建方式使得 $X_i$ 变化 $1$ 个单位具有临床意义。模型中没有其他协变量。单元 $i$ 的发病率定义为 $\\lambda_i \\equiv \\mu_i / E_i$。\n\n仅使用带暴露量的计数数据的 Poisson 率的核心定义以及带有对数连接函数和暴露偏移量的 GLM 结构，推导出发病率 $\\lambda_i$ 作为 $X_i$ 的函数表达式，然后计算当 $X_i$ 增加一个单位时（保持其他所有条件不变）的发病率比 (IRR)。请以精确的解析表达式形式提供 IRR 的最终答案（不要进行数值近似）。最终答案不需要单位。", "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 单元 $i$ 的观察计数为 $Y_i$。\n- 单元 $i$ 的暴露量为总患者天数 $E_i$。\n- 数据生成过程假设为 Poisson 分布。\n- 带有对数连接函数和暴露偏移量的广义线性模型 (GLM) 为：\n$$\n\\log(\\mu_i) \\;=\\; \\log(E_i) \\;+\\; \\beta_0 \\;+\\; 0.5\\, X_i\n$$\n- $\\mu_i$ 是单元 $i$ 的期望计数。\n- $X_i$ 是一个连续的、单位化的风险指数。\n- 单元 $i$ 的发病率定义为 $\\lambda_i \\equiv \\mu_i / E_i$。\n- 目标是推导出发病率 $\\lambda_i$ 的表达式，并计算当 $X_i$ 增加一个单位时的发病率比 (IRR)。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题在科学上和统计学上是合理的。它描述了一个标准的 Poisson 回归模型，这是生物统计学和流行病学中分析带有相应暴露变量的计数数据的基本工具。使用对数连接函数和暴露偏移项是建模率的典型方法。\n- **适定性**：该问题是适定的。它提供了一个特定的模型方程和清晰的定义，通过直接的数学推导可以得出所需的量（$\\lambda_i$ 和 IRR）。在统计建模的背景下，解是唯一的且有意义的。\n- **客观性**：该问题以统计学和流行病学中常见的精确、客观的语言陈述。诸如“Poisson 数据生成过程”、“对数连接”和“发病率比”等术语具有标准的、无歧义的定义。\n- **不完整或矛盾的设置**：该问题是自洽且一致的。所有进行推导所需的信息都已提供。模型结构是标准的且内部一致。\n- **不切实际或不可行**：该场景是此统计模型的一个经典且现实的应用。所有量都以符号形式或带有合理的系数给出，因此不存在数据真实性的问题。\n- **不适定或结构不良**：该问题结构清晰，没有歧义。\n- **结论**：该问题是有效的。\n\n### 步骤 3：结论与行动\n该问题是有效的，将提供解答。\n\n### 解题推导\n该问题要求基于所提供的模型结构进行两项推导。\n\n首先，我们推导出发病率 $\\lambda_i$ 作为风险指数 $X_i$ 的函数表达式。我们从给定的模型方程开始：\n$$\n\\log(\\mu_i) = \\log(E_i) + \\beta_0 + 0.5\\, X_i\n$$\n为了找到与发病率 $\\lambda_i \\equiv \\mu_i / E_i$ 相关的表达式，我们可以通过从等式两边减去偏移项 $\\log(E_i)$ 来重新整理方程：\n$$\n\\log(\\mu_i) - \\log(E_i) = \\beta_0 + 0.5\\, X_i\n$$\n使用对数性质 $\\log(a) - \\log(b) = \\log(a/b)$，等式左侧可以重写为：\n$$\n\\log\\left(\\frac{\\mu_i}{E_i}\\right) = \\beta_0 + 0.5\\, X_i\n$$\n根据所给的发病率定义 $\\lambda_i = \\mu_i / E_i$。将此代入方程中得到：\n$$\n\\log(\\lambda_i) = \\beta_0 + 0.5\\, X_i\n$$\n这个方程表明该模型是关于发病率 $\\lambda_i$ 的对数线性模型。为了求解 $\\lambda_i$，我们对等式两边取自然指数：\n$$\n\\exp(\\log(\\lambda_i)) = \\exp(\\beta_0 + 0.5\\, X_i)\n$$\n由于指数函数是自然对数的反函数，这可以简化为：\n$$\n\\lambda_i = \\exp(\\beta_0 + 0.5\\, X_i)\n$$\n这就是发病率 $\\lambda_i$ 作为 $X_i$ 的函数表达式。\n\n其次，我们计算当 $X_i$ 增加一个单位时的发病率比 (IRR)。IRR 是指预测变量在某个水平下的发病率与基线水平下发病率的比值。在这里，我们关心的是将 $X_i$ 增加 1 个单位所产生的影响。\n\n设 $\\lambda_i$ 是对应于风险指数 $X_i$ 的率，如上所推导：\n$$\n\\lambda_i = \\exp(\\beta_0 + 0.5\\, X_i)\n$$\n设 $\\lambda_i'$ 是对应于风险指数 $X_i + 1$ 的新率：\n$$\n\\lambda_i' = \\exp\\left(\\beta_0 + 0.5\\, (X_i + 1)\\right)\n$$\nIRR 是比率 $\\lambda_i' / \\lambda_i$：\n$$\n\\text{IRR} = \\frac{\\lambda_i'}{\\lambda_i} = \\frac{\\exp\\left(\\beta_0 + 0.5\\, (X_i + 1)\\right)}{\\exp(\\beta_0 + 0.5\\, X_i)}\n$$\n使用指数性质 $a^m / a^n = a^{m-n}$，此表达式可简化为：\n$$\n\\text{IRR} = \\exp\\left( (\\beta_0 + 0.5\\, (X_i + 1)) - (\\beta_0 + 0.5\\, X_i) \\right)\n$$\n我们简化指数中的表达式：\n$$\n(\\beta_0 + 0.5\\, X_i + 0.5) - \\beta_0 - 0.5\\, X_i = 0.5\n$$\n因此，发病率比为：\n$$\n\\text{IRR} = \\exp(0.5)\n$$\n这个结果展示了对数线性模型的一个通用性质：对于系数为 $\\beta$ 的预测变量 $X$，当 $X$ 变化一个单位时，率比为 $\\exp(\\beta)$。在本例中，$X_i$ 的系数明确给出为 $0.5$。最终答案即为此值的精确解析表达式。", "answer": "$$\n\\boxed{\\exp(0.5)}\n$$", "id": "4967689"}, {"introduction": "在掌握了核心概念之后，这个实践将带你处理一个至关重要的现实世界细节：暴露时间的单位。你将学习模型的截距如何与基线率相关联，以及如何正确地将此率换算为具有临床意义的时间单位（例如，从每月发生率换算为每年发生率）。正确处理单位对于得出准确且可解释的结论至关重要[@problem_id:4967660]。", "problem": "我们对一组慢性阻塞性肺疾病患者进行了一项队列研究，以对每位患者在随访期间经历的急性加重住院次数进行建模。对于患者 $i$，设 $Y_i$ 表示急性加重住院次数，设 $E_i$ 表示以月为单位测量的随访时间。我们将一个具有泊松分布和对数连接函数的广义线性模型拟合到数据上，并为暴露时间设置了偏移量，具体如下：\n$$\n\\ln\\!\\big(\\mathbb{E}[Y_i]\\big) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i),\n$$\n其中 $X_{1i}$ 是当前吸烟状态的指示变量（如果当前吸烟，则 $X_{1i}=1$，否则 $X_{1i}=0$），而 $X_{2i}$ 是基线肺功能的标准化连续协变量。拟合的系数为\n$$\n\\hat{\\alpha} \\;=\\; -3.2,\\quad \\hat{\\beta}_1 \\;=\\; 0.4055,\\quad \\hat{\\beta}_2 \\;=\\; -0.2231.\n$$\n\n请使用泊松均值结构、对数连接和暴露偏移量的基本定义，并仔细考虑偏移量 $E_i$ 的时间单位是月，通过将截距适当地转换为以年为单位的时间，计算参考基线（$X_{1i}=0$ 且 $X_{2i}=0$）的基线期望事件率（以人年为单位）。请用“事件数/人年”表示您的答案，并将答案四舍五入到 $4$ 位有效数字。不要提供任何中间率；仅报告以年为单位的基线率作为您的最终数值。", "solution": "所给问题是统计建模原理的一个有效应用，且问题是适定的。得到唯一解所需的所有数据和条件均已提供，且问题陈述在科学上是合理的，其依据是广义线性模型的既定理论。\n\n该问题指定了一个泊松回归模型，用于描述患者 $i$ 在 $E_i$ 个月的随访期内的住院次数 $Y_i$。该模型由下式给出：\n$$\n\\ln\\!\\big(\\mathbb{E}[Y_i]\\big) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i)\n$$\n此处，$\\mathbb{E}[Y_i]$ 是患者 $i$ 在其特定随访时间 $E_i$ 内的期望事件数。事件率，我们记为 $\\lambda_i$，是单位时间内的期望事件数。由于暴露时间 $E_i$ 以月为单位，$\\lambda_i$ 代表每人月的事件率。期望事件数、事件率和暴露时间之间的关系是：\n$$\n\\mathbb{E}[Y_i] \\;=\\; \\lambda_i \\times E_i\n$$\n我们可以将这个定义代入模型方程中：\n$$\n\\ln(\\lambda_i \\times E_i) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i)\n$$\n利用对数性质 $\\ln(ab) = \\ln(a) + \\ln(b)$，方程的左边变为：\n$$\n\\ln(\\lambda_i) + \\ln(E_i) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i)\n$$\n方程两边都出现了 $\\ln(E_i)$ 项，可以消去。这揭示了事件率本身的基本模型：\n$$\n\\ln(\\lambda_i) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i}\n$$\n该方程表明，协变量的线性组合模拟了每月事件率的自然对数。\n\n问题要求计算基线期望事件率。基线（或参考）画像对应于所有协变量均设置为其参考水平的患者。在本例中，这是一个不吸烟者（$X_{1i}=0$），且具有平均基线肺功能（$X_{2i}=0$，因为它是一个标准化协变量）。\n\n设 $\\lambda_{\\text{base, month}}$ 为每人月的基线事件率。我们可以通过将 $X_{1i}=0$ 和 $X_{2i}=0$ 代入对数率模型来求其值：\n$$\n\\ln(\\lambda_{\\text{base, month}}) \\;=\\; \\alpha \\;+\\; \\beta_1 (0) \\;+\\; \\beta_2 (0) \\;=\\; \\alpha\n$$\n为了求出率本身，我们对两边取指数：\n$$\n\\lambda_{\\text{base, month}} \\;=\\; \\exp(\\alpha)\n$$\n使用提供的截距估计值 $\\hat{\\alpha} = -3.2$，估计的每月基线率为：\n$$\n\\hat{\\lambda}_{\\text{base, month}} \\;=\\; \\exp(-3.2)\n$$\n问题要求基线率以每人年事件数表示，而不是每人月事件数。设 $\\hat{\\lambda}_{\\text{base, year}}$ 为估计的每年基线率。由于一年有 $12$ 个月，我们必须将月率乘以 $12$：\n$$\n\\hat{\\lambda}_{\\text{base, year}} \\;=\\; \\hat{\\lambda}_{\\text{base, month}} \\times 12 \\;=\\; 12 \\times \\exp(-3.2)\n$$\n现在，我们计算其数值：\n$$\n\\hat{\\lambda}_{\\text{base, year}} \\;=\\; 12 \\times \\exp(-3.2) \\approx 12 \\times 0.0407622... \\approx 0.4891464...\n$$\n问题要求最终答案四舍五入到 $4$ 位有效数字。$0.4891464...$ 的前四位有效数字是 $4$、$8$、$9$ 和 $1$。第五位有效数字是 $4$，小于 $5$，所以我们向下舍入。\n$$\n\\hat{\\lambda}_{\\text{base, year}} \\approx 0.4891\n$$\n因此，基线期望事件率为每人年 $0.4891$ 次急性加重住院。", "answer": "$$\\boxed{0.4891}$$", "id": "4967660"}, {"introduction": "现实世界中的效应通常不是简单相加的。最后的这个练习引入了交互作用项，即一个预测变量的效应依赖于另一个预测变量的水平。你将推导并计算一个条件发生率比（conditional IRR），从而学习如何在更复杂的非加性模型中解释系数[@problem_id:4967750]。", "problem": "一项关于医院获得性感染的多中心队列研究使用带对数连接和暴露偏移量的泊松广义线性模型 (GLM) 来模拟患者层面的事件计数。对于协变量为 $X$ 和 $Z$、观察人时为 $T$ 的患者，该模型指定为\n$$\n\\ln\\!\\big(\\mathbb{E}[Y \\mid X,Z,T]\\big) \\;=\\; \\ln(T) \\;+\\; \\beta_{0} \\;+\\; \\beta_{X}\\,X \\;+\\; \\beta_{Z}\\,Z \\;+\\; \\beta_{XZ}\\,X Z,\n$$\n其中 $Y$ 是在人时 $T$ 期间观察到的事件计数。假设在为同一患者比较不同的 $X$ 值时，人时 $T$ 保持不变。\n\n仅使用泊松均值（暴露时间乘以发生率）和发生率比 (IRR) 的定义（其中发生率比 (IRR) 定义为两种暴露条件下发生率的比值），推导在 $Z$ 值固定的情况下，$X$ 增加一个单位时的条件发生率比。然后，当 $Z=4$ 且系数值为 $\\beta_{X}=0.1$ 和 $\\beta_{XZ}=0.05$ 时，计算该条件 IRR 的数值。将您的答案四舍五入到四位有效数字。以纯数字形式表示最终答案，不带单位。", "solution": "题目提供了一个泊松广义线性模型，用于在给定协变量 $X$、$Z$ 和暴露时间 $T$ 的情况下，计算预期事件计数 $\\mathbb{E}[Y]$。该模型由以下方程指定：\n$$\n\\ln(\\mathbb{E}[Y \\mid X,Z,T]) = \\ln(T) + \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\beta_{XZ}XZ\n$$\n题目还定义了预期事件计数（泊松均值）为发生率（我们将其表示为 $\\lambda$）与暴露时间 $T$ 的乘积。\n$$\n\\mathbb{E}[Y \\mid X,Z,T] = \\lambda \\cdot T\n$$\n将此定义代入模型方程，我们可以得到发生率 $\\lambda$ 的表达式。\n$$\n\\ln(\\lambda \\cdot T) = \\ln(T) + \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\beta_{XZ}XZ\n$$\n使用对数性质 $\\ln(a \\cdot b) = \\ln(a) + \\ln(b)$，我们可以展开方程的左侧：\n$$\n\\ln(\\lambda) + \\ln(T) = \\ln(T) + \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\beta_{XZ}XZ\n$$\n在 GLM 框架中，$\\ln(T)$ 项是一个偏移量。它出现在方程的两边，可以消去，从而分离出对数发生率 $\\ln(\\lambda)$：\n$$\n\\ln(\\lambda) = \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\beta_{XZ}XZ\n$$\n该方程表明，模型在发生率 $\\lambda$ 上是对数线性的。发生率本身取决于协变量 $X$ 和 $Z$。让我们将发生率表示为协变量的函数 $\\lambda(X, Z)$。\n$$\n\\lambda(X, Z) = \\exp(\\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\beta_{XZ}XZ)\n$$\n题目要求计算在 $Z$ 值固定的情况下，$X$ 增加一个单位时的条件发生率比 (IRR)。IRR 定义为两种不同条件下发生率的比值。设第一个条件对应于协变量值为 $X=x$，第二个条件对应于 $X=x+1$，而 $Z$ 保持在常数值 $z$。\n\n设 $\\lambda_1$ 是在 $(X, Z) = (x, z)$ 时的发生率，$\\lambda_2$ 是在 $(X, Z) = (x+1, z)$ 时的发生率。\n相应的对数发生率是：\n$$\n\\ln(\\lambda_1) = \\ln(\\lambda(x, z)) = \\beta_{0} + \\beta_{X}x + \\beta_{Z}z + \\beta_{XZ}xz\n$$\n$$\n\\ln(\\lambda_2) = \\ln(\\lambda(x+1, z)) = \\beta_{0} + \\beta_{X}(x+1) + \\beta_{Z}z + \\beta_{XZ}(x+1)z\n$$\nIRR 是比值 $\\frac{\\lambda_2}{\\lambda_1}$。通常，在计算上更简单的方法是先求出 IRR 的对数，即对数发生率之差：\n$$\n\\ln(\\text{IRR}) = \\ln\\left(\\frac{\\lambda_2}{\\lambda_1}\\right) = \\ln(\\lambda_2) - \\ln(\\lambda_1)\n$$\n代入对数发生率的表达式：\n$$\n\\ln(\\text{IRR}) = \\big(\\beta_{0} + \\beta_{X}(x+1) + \\beta_{Z}z + \\beta_{XZ}(x+1)z\\big) - \\big(\\beta_{0} + \\beta_{X}x + \\beta_{Z}z + \\beta_{XZ}xz\\big)\n$$\n展开各项：\n$$\n\\ln(\\text{IRR}) = (\\beta_{0} + \\beta_{X}x + \\beta_{X} + \\beta_{Z}z + \\beta_{XZ}xz + \\beta_{XZ}z) - (\\beta_{0} + \\beta_{X}x + \\beta_{Z}z + \\beta_{XZ}xz)\n$$\n许多项相互抵消，剩下：\n$$\n\\ln(\\text{IRR}) = \\beta_{X} + \\beta_{XZ}z\n$$\n这是发生率比的对数。为了求出 IRR 本身，我们对这个结果取指数：\n$$\n\\text{IRR} = \\exp(\\beta_{X} + \\beta_{XZ}z)\n$$\n这是在固定水平 $Z=z$ 时，$X$ 每增加一个单位的 IRR 的通用表达式。请注意，由于存在交互项，IRR 取决于 $Z$ 的值。\n\n问题的第二部分要求计算在特定情况 $Z=4$，$\\beta_{X}=0.1$ 和 $\\beta_{XZ}=0.05$ 下该 IRR 的数值。\n我们将这些值代入推导出的公式中：\n$$\n\\text{IRR} = \\exp(0.1 + (0.05)(4))\n$$\n首先，我们计算指数的值：\n$$\n0.1 + (0.05)(4) = 0.1 + 0.2 = 0.3\n$$\n因此，IRR 为：\n$$\n\\text{IRR} = \\exp(0.3)\n$$\n使用计算器评估此表达式：\n$$\n\\text{IRR} \\approx 1.3498588...\n$$\n题目要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $1$、$3$、$4$ 和 $9$。第五位有效数字是 $8$，大于或等于 $5$，因此我们将第四位有效数字向上取整。这使得 $1.349$ 变为 $1.350$。\n$$\n\\text{IRR} \\approx 1.350\n$$", "answer": "$$\\boxed{1.350}$$", "id": "4967750"}]}