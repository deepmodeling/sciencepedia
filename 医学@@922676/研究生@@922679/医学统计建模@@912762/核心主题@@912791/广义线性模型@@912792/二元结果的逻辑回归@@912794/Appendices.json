{"hands_on_practices": [{"introduction": "在我们深入研究包含多个预测变量的复杂模型之前，让我们先从最简单的情况入手：仅含截距项的模型。这个练习将引导你从第一性原理出发，为单个群体推导最大似然估计（MLE）及其置信区间。通过这个过程，你将牢固掌握对数几率、伯努利似然以及在统计推断中扮演核心角色的费雪信息等基本概念 [@problem_id:4807790]。", "problem": "一项肿瘤学领域的 II 期单臂初步研究评估了一种研究性药物，其二元结果是在六周内的临床响应，记录为参与者 $i$ 的 $Y_{i} \\in \\{0,1\\}$。研究者希望报告响应的基线对数优势比，假设采用仅含截距项的逻辑回归模型，该模型在不包含协变量且所有参与者的响应概率恒定时是合适的。抽样模型假设独立的伯努利试验，具有共同的响应概率 $p$，且链接函数满足 $\\operatorname{logit}(p)=\\beta_{0}$，其中 $\\beta_{0}$ 是截距项。\n\n研究中，共招募了 $n=10$ 名参与者，观察到 $k=3$ 例响应。在逻辑回归中最大似然估计的标准正则性条件下，利用伯努利似然和关于 $\\beta_{0}$ 的费雪信息，从第一性原理推导最大似然估计值（MLE） $\\hat{\\beta}_{0}$ 及其在对数优势比尺度上的大样本 Wald 95% 置信区间（CI）。使用适用于 95% CI 的标准正态双侧临界值。\n\n报告三个数值：点估计值 $\\hat{\\beta}_{0}$，以及 Wald 95% CI 的下限和上限，所有数值均在对数优势比尺度上。将每个报告值四舍五入至四位有效数字。", "solution": "问题陈述经评估是有效的。它在科学上基于统计推断的原理，特别是针对逻辑回归模型的最大似然估计。问题设定良好，提供了所有必要的数据（$n=10$，$k=3$）和一个明确的目标：为对数优势比参数 $\\beta_0$ 推导最大似然估计和 Wald 置信区间。语言客观且无歧义。对于相对较小的样本量（$n=10$）使用大样本近似是教科书中为教授方法学而设计的标准特征，并不会使问题无效。\n\n推导从第一性原理开始，过程如下。\n\n设参与者 $i$ 的二元结果为 $Y_i \\in \\{0, 1\\}$，其中 $Y_i=1$ 表示临床响应。结果被建模为独立同分布的伯努利随机变量，$Y_i \\sim \\text{Bernoulli}(p)$，其中 $p$ 是共同的响应概率。样本量为 $n=10$，观察到的总响应数为 $k=3$。\n\n对于观察到的数据，包括 $k$ 个响应和 $n-k$ 个无响应，其似然函数由各个伯努利概率的乘积给出：\n$$L(p) = \\prod_{i=1}^{n} p^{y_i} (1-p)^{1-y_i} = p^{\\sum y_i} (1-p)^{n-\\sum y_i} = p^k (1-p)^{n-k}$$\n\n问题指定了一个仅含截距项的逻辑回归模型，其中响应的对数优势比通过 logit 链接函数与截距 $\\beta_0$ 相关联：\n$$\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right) = \\beta_0$$\n根据这个关系，我们可以将概率 $p$ 表示为 $\\beta_0$ 的函数：\n$$p(\\beta_0) = \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = (1 + \\exp(-\\beta_0))^{-1}$$\n因此，$1-p$ 可以表示为：\n$$1-p(\\beta_0) = 1 - \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = \\frac{1}{1+\\exp(\\beta_0)}$$\n\n将这些表达式代入似然函数，得到以 $\\beta_0$ 表示的似然函数：\n$$L(\\beta_0) = \\left(\\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)}\\right)^k \\left(\\frac{1}{1+\\exp(\\beta_0)}\\right)^{n-k} = \\frac{\\exp(k\\beta_0)}{(1+\\exp(\\beta_0))^n}$$\n\n为了找到 $\\beta_0$ 的最大似然估计（MLE），我们处理对数似然函数 $\\ell(\\beta_0) = \\ln(L(\\beta_0))$：\n$$\\ell(\\beta_0) = k\\beta_0 - n\\ln(1+\\exp(\\beta_0))$$\n\n我们通过对 $\\ell(\\beta_0)$ 关于 $\\beta_0$ 求导并将结果（得分函数，$U(\\beta_0)$）设为零来找到最大值：\n$$\\frac{d\\ell}{d\\beta_0} = U(\\beta_0) = k - n \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = k - np$$\n令 $U(\\hat{\\beta}_0)=0$ 以求得 MLE，这意味着 $k - n\\hat{p} = 0$，从而得到 $p$ 的 MLE 为 $\\hat{p} = \\frac{k}{n}$。根据 MLE 的不变性，$\\beta_0$ 的 MLE 为：\n$$\\hat{\\beta}_0 = \\operatorname{logit}(\\hat{p}) = \\ln\\left(\\frac{\\hat{p}}{1-\\hat{p}}\\right) = \\ln\\left(\\frac{k/n}{1-k/n}\\right) = \\ln\\left(\\frac{k}{n-k}\\right)$$\n代入给定值 $n=10$ 和 $k=3$：\n$$\\hat{\\beta}_0 = \\ln\\left(\\frac{3}{10-3}\\right) = \\ln\\left(\\frac{3}{7}\\right) \\approx -0.84729786$$\n\n接下来，我们使用费雪信息推导 $\\hat{\\beta}_0$ 的标准误。费雪信息 $I(\\beta_0)$ 是对数似然函数二阶导数的期望值的负数。\n二阶导数是：\n$$\\frac{d^2\\ell}{d\\beta_0^2} = \\frac{d}{d\\beta_0}(k - np) = -n\\frac{dp}{d\\beta_0}$$\n由于 $p = (1+\\exp(-\\beta_0))^{-1}$，其导数为 $\\frac{dp}{d\\beta_0} = -(1+\\exp(-\\beta_0))^{-2} \\cdot (-\\exp(-\\beta_0)) = \\frac{\\exp(-\\beta_0)}{(1+\\exp(-\\beta_0))^2} = \\frac{1}{1+\\exp(\\beta_0)} \\cdot \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = p(1-p)$。\n因此，对数似然的二阶导数为：\n$$\\frac{d^2\\ell}{d\\beta_0^2} = -np(1-p)$$\n由于该表达式不依赖于数据 $y_i$（仅通过 $p$ 依赖于参数 $\\beta_0$），其期望就是该表达式本身。对于 $n$ 个观测值，费雪信息是：\n$$I(\\beta_0) = -E\\left[\\frac{d^2\\ell}{d\\beta_0^2}\\right] = -(-np(1-p)) = np(1-p)$$\n$\\hat{\\beta}_0$ 的渐近方差是费雪信息的倒数，在真实参数值处求值。我们通过代入 MLE $\\hat{p}$ 来估计此方差：\n$$\\widehat{\\operatorname{Var}}(\\hat{\\beta}_0) = [I(\\hat{\\beta}_0)]^{-1} = \\frac{1}{n\\hat{p}(1-\\hat{p})}$$\n标准误（SE）是这个估计方差的平方根：\n$$\\operatorname{SE}(\\hat{\\beta}_0) = \\sqrt{\\frac{1}{n\\hat{p}(1-\\hat{p})}} = \\sqrt{\\frac{1}{n\\frac{k}{n}(1-\\frac{k}{n})}} = \\sqrt{\\frac{n}{k(n-k)}}$$\n代入给定值：\n$$\\operatorname{SE}(\\hat{\\beta}_0) = \\sqrt{\\frac{10}{3(10-3)}} = \\sqrt{\\frac{10}{21}} \\approx 0.69006556$$\n\n$\\beta_0$ 的大样本 Wald 95% 置信区间（CI）由下式给出：\n$$\\hat{\\beta}_0 \\pm z_{1-\\alpha/2} \\operatorname{SE}(\\hat{\\beta}_0)$$\n对于 95% CI，$\\alpha=0.05$，因此我们需要标准正态分布的临界值 $z_{1-0.05/2} = z_{0.975}$。标准值为 $z_{0.975} \\approx 1.96$。\n误差范围（ME）是：\n$$\\text{ME} = 1.96 \\times \\operatorname{SE}(\\hat{\\beta}_0) \\approx 1.96 \\times 0.69006556 \\approx 1.35252849$$\nCI 的下限（LB）是：\n$$\\text{LB} = \\hat{\\beta}_0 - \\text{ME} \\approx -0.84729786 - 1.35252849 = -2.19982635$$\nCI 的上限（UB）是：\n$$\\text{UB} = \\hat{\\beta}_0 + \\text{ME} \\approx -0.84729786 + 1.35252849 = 0.50523063$$\n\n最后，我们将所需的三个值四舍五入到四位有效数字：\n点估计值 $\\hat{\\beta}_0$：$-0.8473$\n下限：$-2.200$\n上限：$0.5052$", "answer": "$$\\boxed{\\begin{pmatrix} -0.8473  -2.200  0.5052 \\end{pmatrix}}$$", "id": "4807790"}, {"introduction": "逻辑斯蒂回归系数通常无法通过一个简单的封闭公式求得，而是需要借助迭代算法。迭代重加权最小二乘法（IRLS）是拟合广义线性模型的标准数值方法。通过手动执行一步IRLS迭代 [@problem_id:4970685]，你将揭开统计软件“黑箱”的神秘面纱，直观地理解模型是如何通过更新权重和“工作响应”来逐步逼近最佳参数估计的。", "problem": "考虑一个用于短期围手术期研究的二元结果模型，其中每位患者 $i \\in \\{1,2,3\\}$ 贡献一个伯努利试验 $y_{i} \\in \\{0,1\\}$，该试验指示是否发生急性术后并发症。设协变量向量为 $x_{i} \\in \\mathbb{R}^{2}$，包含一个截距和一个标准化的手术复杂度评分，参数向量记为 $\\beta \\in \\mathbb{R}^{2}$。该广义线性模型使用逻辑斯蒂连接，因此条件均值为 $p_{i} = \\mathbb{E}(y_{i} \\mid x_{i}, \\beta)$，满足 $\\operatorname{logit}(p_{i}) = x_{i}^{\\top} \\beta$。数据由设计矩阵 $X = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix}$ 和结果向量 $y = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 给出。从初始参数 $\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，执行一次迭代重加权最小二乘法 (IRLS) 迭代（首先根据带有逻辑斯蒂连接的伯努利对数似然定义得分函数和观测信息，然后从这些第一性原理推导出 IRLS 的各个量），并计算初始迭代时的以下对象：模型预测的概率向量 $p^{(0)}$、对角权重矩阵 $W^{(0)}$、工作响应 $z^{(0)}$ 以及更新后的参数向量 $\\beta^{(1)}$。将所有计算量精确地表示为有理数或整数；无需四舍五入。以包含所有四个结果的单个复合表达式形式提供你的最终答案，顺序为 $\\left(p^{(0)}, W^{(0)}, z^{(0)}, \\beta^{(1)}\\right)$。", "solution": "用户希望找到在对逻辑斯蒂回归模型进行一次迭代重加权最小二乘法 (IRLS) 算法迭代后，得到的预测概率 $p^{(0)}$、权重矩阵 $W^{(0)}$、工作响应 $z^{(0)}$ 和更新后的参数向量 $\\beta^{(1)}$。\n\n### 步骤 1：问题验证\n\n该问题是广义线性模型 (GLM) 计算统计学中一个标准的、定义明确的练习。\n\n*   **提取的已知条件**：\n    *   模型：针对二元结果 $y_i \\in \\{0, 1\\}$ 的逻辑斯蒂回归。\n    *   观测数量：$N=3$。\n    *   连接函数：$\\operatorname{logit}(p_i) = \\ln\\left(\\frac{p_i}{1-p_i}\\right) = x_i^\\top \\beta$。\n    *   设计矩阵：$X = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix}$。\n    *   结果向量：$y = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n    *   初始参数向量：$\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n    *   任务：从 $\\beta^{(0)}$ 开始执行一次 IRLS 迭代，并计算 $p^{(0)}$、$W^{(0)}$、$z^{(0)}$ 和 $\\beta^{(1)}$。\n\n*   **验证结论**：\n    *   该问题在 GLM 理论上**有科学依据**。\n    *   它是**适定的**，为 IRLS 算法的单次、唯一迭代提供了所有必要信息。\n    *   语言是**客观**且数学上精确的。\n    *   该问题是**有效的**。\n\n### 步骤 2：从第一性原理推导 IRLS 算法\n\nGLM 的 IRLS 算法可以作为最大化对数似然的牛顿-拉弗森法来推导。对于二元结果 $y_i \\sim \\text{Bernoulli}(p_i)$，单个观测 $i$ 的对数似然是：\n$$\n\\ell_i(\\beta) = y_i \\ln(p_i) + (1-y_i) \\ln(1-p_i)\n$$\n总对数似然是 $\\ell(\\beta) = \\sum_{i=1}^{N} \\ell_i(\\beta)$。连接函数将概率 $p_i$ 与线性预测器 $\\eta_i = x_i^\\top \\beta$ 联系起来：\n$$\n\\eta_i = \\ln\\left(\\frac{p_i}{1-p_i}\\right) \\implies p_i = \\frac{\\exp(\\eta_i)}{1+\\exp(\\eta_i)} = \\frac{1}{1+\\exp(-\\eta_i)}\n$$\n这是逻辑斯蒂 S 型函数，$\\sigma(\\eta_i)$。其导数是 $\\frac{d p_i}{d \\eta_i} = p_i(1-p_i)$。\n\n**1. 得分函数（对数似然的梯度）**\n我们求 $\\ell(\\beta)$ 相对于参数向量 $\\beta$ 的梯度。对单个观测的贡献使用链式法则：\n$$\n\\frac{\\partial \\ell_i}{\\partial \\beta_j} = \\frac{\\partial \\ell_i}{\\partial p_i} \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta_j}\n$$\n各分量为：\n$$\n\\frac{\\partial \\ell_i}{\\partial p_i} = \\frac{y_i}{p_i} - \\frac{1-y_i}{1-p_i} = \\frac{y_i - p_i}{p_i(1-p_i)}\n$$\n$$\n\\frac{\\partial p_i}{\\partial \\eta_i} = p_i(1-p_i)\n$$\n$$\n\\frac{\\partial \\eta_i}{\\partial \\beta_j} = \\frac{\\partial (x_i^\\top \\beta)}{\\partial \\beta_j} = x_{ij}\n$$\n将这些组合起来得到：\n$$\n\\frac{\\partial \\ell_i}{\\partial \\beta_j} = \\frac{y_i - p_i}{p_i(1-p_i)} \\cdot p_i(1-p_i) \\cdot x_{ij} = (y_i - p_i) x_{ij}\n$$\n整个数据集的得分向量是所有观测值的总和，可以写成矩阵形式：\n$$\nS(\\beta) = \\nabla_\\beta \\ell(\\beta) = \\sum_{i=1}^{N} (y_i - p_i) x_i = X^\\top (y - p)\n$$\n\n**2. 观测信息矩阵（负海森矩阵）**\n接下来，我们计算海森矩阵 $\\mathcal{H}(\\beta) = \\frac{\\partial^2 \\ell(\\beta)}{\\partial \\beta \\partial \\beta^\\top}$。元素 $(\\mathcal{H})_{jk}$ 是：\n$$\n\\frac{\\partial^2 \\ell}{\\partial \\beta_k \\partial \\beta_j} = \\sum_{i=1}^{N} \\frac{\\partial}{\\partial \\beta_k} \\left[ (y_i - p_i) x_{ij} \\right] = \\sum_{i=1}^{N} - \\frac{\\partial p_i}{\\partial \\beta_k} x_{ij}\n$$\n再次使用链式法则，$\\frac{\\partial p_i}{\\partial \\beta_k} = \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta_k} = p_i(1-p_i) x_{ik}$。代入可得：\n$$\n\\frac{\\partial^2 \\ell}{\\partial \\beta_k \\partial \\beta_j} = \\sum_{i=1}^{N} -p_i(1-p_i) x_{ik} x_{ij}\n$$\n在矩阵形式中，海森矩阵是 $\\mathcal{H}(\\beta) = -X^\\top W X$，其中 $W$ 是一个对角矩阵，其对角线元素为 $W_{ii} = p_i(1-p_i)$。观测信息矩阵是 $J(\\beta) = -\\mathcal{H}(\\beta) = X^\\top W X$。\n\n**3. IRLS 更新步骤**\n用于找到 $\\ell(\\beta)$ 最大值的牛顿-拉弗森更新步骤是：\n$$\n\\beta^{(t+1)} = \\beta^{(t)} - [\\mathcal{H}(\\beta^{(t)})]^{-1} S(\\beta^{(t)})\n$$\n代入我们对得分 $S$ 和海森矩阵 $\\mathcal{H}$ 的表达式：\n$$\n\\beta^{(t+1)} = \\beta^{(t)} - [-X^\\top W^{(t)} X]^{-1} [X^\\top (y - p^{(t)})] = \\beta^{(t)} + (X^\\top W^{(t)} X)^{-1} X^\\top (y - p^{(t)})\n$$\n为了将其视为一个加权最小二乘问题，我们重新整理这些项：\n$$\n(X^\\top W^{(t)} X) \\beta^{(t+1)} = (X^\\top W^{(t)} X) \\beta^{(t)} + X^\\top (y - p^{(t)})\n$$\n让我们定义一个“工作响应”向量 $z^{(t)}$，使得更新是加权正规方程的解：$\\beta^{(t+1)} = (X^\\top W^{(t)} X)^{-1} X^\\top W^{(t)} z^{(t)}$。这意味着 $X^\\top W^{(t)} z^{(t)} = (X^\\top W^{(t)} X) \\beta^{(t)} + X^\\top (y - p^{(t)})$。我们可以解出 $z^{(t)}$：\n$$\nW^{(t)} z^{(t)} = W^{(t)} X \\beta^{(t)} + (y - p^{(t)}) \\implies z^{(t)} = X \\beta^{(t)} + (W^{(t)})^{-1} (y - p^{(t)})\n$$\n回想一下 $\\eta^{(t)} = X \\beta^{(t)}$，工作响应是：\n$$\nz^{(t)} = \\eta^{(t)} + (W^{(t)})^{-1} (y - p^{(t)})\n$$\n\n### 步骤 3：第一次迭代的计算\n\n给定初始参数向量 $\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n**1. 计算概率 $p^{(0)}$**\n首先，计算线性预测器 $\\eta^{(0)} = X \\beta^{(0)}$：\n$$\n\\eta^{(0)} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n现在，使用逆连接函数 $p_i = \\sigma(\\eta_i)$ 计算概率 $p_i^{(0)}$：\n$$\np_i^{(0)} = \\frac{1}{1+\\exp(-\\eta_i^{(0)})} = \\frac{1}{1+\\exp(0)} = \\frac{1}{1+1} = \\frac{1}{2} \\quad \\text{对于 } i=1,2,3\n$$\n因此，概率向量是：\n$$\np^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}\n$$\n\n**2. 计算权重矩阵 $W^{(0)}$**\n对角线权重是 $W_{ii}^{(0)} = p_i^{(0)}(1 - p_i^{(0)})$：\n$$\nW_{ii}^{(0)} = \\frac{1}{2} \\left(1 - \\frac{1}{2}\\right) = \\frac{1}{4} \\quad \\text{对于 } i=1,2,3\n$$\n权重矩阵是：\n$$\nW^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix}\n$$\n\n**3. 计算工作响应 $z^{(0)}$**\n工作响应是 $z^{(0)} = \\eta^{(0)} + (W^{(0)})^{-1} (y - p^{(0)})$：\n$$\ny - p^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}\n$$\n权重矩阵的逆是 $(W^{(0)})^{-1} = \\text{diag}(4, 4, 4)$。\n$$\nz^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 4  0  0 \\\\ 0  4  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix}\n$$\n\n**4. 计算更新后的参数 $\\beta^{(1)}$**\n更新公式为 $\\beta^{(1)} = (X^\\top W^{(0)} X)^{-1} X^\\top W^{(0)} z^{(0)}$。\n首先，计算 $X^\\top W^{(0)} X$：\n$$\nX^\\top W^{(0)} X = \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3  3 \\\\ 3  5 \\end{pmatrix}\n$$\n接下来，求这个矩阵的逆：\n$$\n(X^\\top W^{(0)} X)^{-1} = \\left(\\frac{1}{4} \\begin{pmatrix} 3  3 \\\\ 3  5 \\end{pmatrix}\\right)^{-1} = 4 \\cdot \\frac{1}{3(5)-3(3)} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix} = \\frac{4}{6} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix}\n$$\n现在，计算 $X^\\top W^{(0)} z^{(0)}$：\n$$\nX^\\top W^{(0)} z^{(0)} = \\frac{1}{4} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} -2+2+2 \\\\ 0+2+4 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n最后，计算 $\\beta^{(1)}$：\n$$\n\\beta^{(1)} = \\left(\\frac{2}{3} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix}\\right) \\begin{pmatrix} 1/2 \\\\ 3/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5(1/2) - 3(3/2) \\\\ -3(1/2) + 3(3/2) \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5/2 - 9/2 \\\\ -3/2 + 9/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} -4/2 \\\\ 6/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} -2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}\n$$\n\n在初始迭代中，要求的四个量是：\n$p^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}$，$W^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix}$，$z^{(0)} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix}$，以及 $\\beta^{(1)} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{aligned}\np^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} \\\\\nW^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix} \\\\\nz^{(0)} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} \\\\\n\\beta^{(1)} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}\n\\end{aligned}\n}\n$$", "id": "4970685"}, {"introduction": "估计出的回归系数（$\\beta$值）表示了协变量每改变一个单位，结果的对数几率（log-odds）的变化量。然而，在临床实践中，我们更关心这对发生概率的实际影响。这个练习将教你如何将在对数几率尺度上的系数转化为在概率尺度上的边际效应 [@problem_id:4970705]，这是准确解释和沟通模型结果的一项关键技能。", "problem": "一项临床研究使用逻辑回归来模拟术后急性肾损伤作为二元结果的概率。设 $Y \\in \\{0,1\\}$ 表示是否发生急性肾损伤（$Y=1$ 表示发生，$Y=0$ 表示未发生）。对于一个协变量向量为 $\\boldsymbol{x}$ 的患者，该模型通过对数优势比（logit）链接函数指定了条件概率 $p(\\boldsymbol{x}) = \\mathbb{P}(Y=1 \\mid \\boldsymbol{x})$：对数优势比是协变量的线性函数，其线性预测器为 $\\eta(\\boldsymbol{x}) = \\beta_{0} + \\sum_{k} \\beta_{k} x_{k}$，而概率 $p(\\boldsymbol{x})$ 是通过逻辑斯蒂函数将 $\\eta(\\boldsymbol{x})$ 映射到单位区间得到的。考虑一个特定的连续协变量 $x_{j}$，它代表一个标准化的术前生物标志物。对于某个特定患者的协变量值，该模型得出的预测概率为 $p(\\boldsymbol{x}) = p = 0.3$，协变量 $x_{j}$ 的估计系数为 $\\beta_{j} = 1.2$。从逻辑回归模型和逻辑斯蒂函数的定义出发，推导 $x_{j}$ 对概率的边际效应 $\\frac{\\partial p}{\\partial x_{j}}$（在该患者的协变量值处进行评估），并计算其数值。将最终答案表示为一个纯数字。无需四舍五入。", "solution": "该问题提法明确，有科学依据，并提供了足够的信息来推导和计算所要求的量。这是微分学在逻辑回归模型函数形式上的一个标准应用。因此，该问题是有效的。\n\n逻辑回归模型将给定协变量向量 $\\boldsymbol{x}$ 下二元结果 $Y=1$ 的概率定义为线性预测器 $\\eta(\\boldsymbol{x})$ 的函数。该关系由逻辑斯蒂函数（通常表示为 $\\sigma(\\cdot)$）给出：\n$$p(\\boldsymbol{x}) = \\sigma(\\eta(\\boldsymbol{x})) = \\frac{1}{1 + \\exp(-\\eta(\\boldsymbol{x}))}$$\n线性预测器 $\\eta(\\boldsymbol{x})$ 是协变量的线性组合：\n$$\\eta(\\boldsymbol{x}) = \\beta_{0} + \\sum_{k} \\beta_{k} x_{k}$$\n其中 $\\beta_0$ 是截距项，$\\beta_k$ 是协变量 $x_k$ 的系数。\n\n我们需要求解特定连续协变量 $x_j$ 对概率 $p(\\boldsymbol{x})$ 的边际效应。这个边际效应定义为偏导数 $\\frac{\\partial p}{\\partial x_{j}}$。为了求这个导数，我们应用微分链式法则：\n$$\\frac{\\partial p}{\\partial x_{j}} = \\frac{d p}{d \\eta} \\cdot \\frac{\\partial \\eta}{\\partial x_{j}}$$\n\n首先，我们计算线性预测器 $\\eta(\\boldsymbol{x})$ 对 $x_j$ 的导数：\n$$\\frac{\\partial \\eta}{\\partial x_{j}} = \\frac{\\partial}{\\partial x_{j}} \\left( \\beta_{0} + \\sum_{k} \\beta_{k} x_{k} \\right)$$\n假设协变量是不同的变量，则 $x_k$ 对 $x_j$ 的导数在 $k=j$ 时为 $1$，否则为 $0$。因此，只有包含 $\\beta_j x_j$ 的项对导数有贡献。\n$$\\frac{\\partial \\eta}{\\partial x_{j}} = \\beta_{j}$$\n\n接下来，我们计算逻辑斯蒂函数 $p(\\eta)$ 对其自变量 $\\eta$ 的导数：\n$$p(\\eta) = (1 + \\exp(-\\eta))^{-1}$$\n使用幂法则和链式法则：\n$$\\frac{d p}{d \\eta} = -1 \\cdot (1 + \\exp(-\\eta))^{-2} \\cdot \\frac{d}{d\\eta}(\\exp(-\\eta))$$\n$$\\frac{d p}{d \\eta} = -1 \\cdot (1 + \\exp(-\\eta))^{-2} \\cdot (-\\exp(-\\eta))$$\n$$\\frac{d p}{d \\eta} = \\frac{\\exp(-\\eta)}{(1 + \\exp(-\\eta))^{2}}$$\n这个表达式可以方便地用 $p$ 本身来重写。我们认识到：\n$$p = \\frac{1}{1 + \\exp(-\\eta)}$$\n我们可以将 $1-p$ 写成：\n$$1 - p = 1 - \\frac{1}{1 + \\exp(-\\eta)} = \\frac{(1 + \\exp(-\\eta)) - 1}{1 + \\exp(-\\eta)} = \\frac{\\exp(-\\eta)}{1 + \\exp(-\\eta)}$$\n因此，导数 $\\frac{dp}{d\\eta}$ 是这两项的乘积：\n$$\\frac{d p}{d \\eta} = \\left( \\frac{1}{1 + \\exp(-\\eta)} \\right) \\cdot \\left( \\frac{\\exp(-\\eta)}{1 + \\exp(-\\eta)} \\right) = p \\cdot (1 - p)$$\n这是逻辑斯蒂函数的一个基本性质。\n\n现在，我们将链式法则的两个部分结合起来，得到边际效应的最终表达式：\n$$\\frac{\\partial p}{\\partial x_{j}} = \\frac{d p}{d \\eta} \\cdot \\frac{\\partial \\eta}{\\partial x_{j}} = p(\\boldsymbol{x}) \\cdot (1 - p(\\boldsymbol{x})) \\cdot \\beta_{j}$$\n\n问题提供了针对特定患者评估的必要值：\n预测概率为 $p(\\boldsymbol{x}) = p = 0.3$。\n协变量 $x_j$ 的估计系数为 $\\beta_j = 1.2$。\n\n我们将这些数值代入我们推导出的边际效应公式中：\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.3 \\cdot (1 - 0.3) \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.3 \\cdot 0.7 \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.21 \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.252$$\n因此，在该患者的协变量值下，标准化的生物标志物 $x_j$ 每增加一个单位，发生急性肾损伤的概率大约增加 $0.252$。", "answer": "$$\n\\boxed{0.252}\n$$", "id": "4970705"}]}