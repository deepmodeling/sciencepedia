{"hands_on_practices": [{"introduction": "过分散（overdispersion）并非仅仅是一个统计现象，它常常反映了潜在的生物学或社会学过程。一个常见的原因是“零膨胀”（zero-inflation），即总体中有一个子集根本没有经历事件的风险，从而导致零计数的数量过多。这项练习 [@problem_id:4950089] 将引导您完成一项基础推导，通过从第一性原理出发，推导零膨胀泊松（Zero-Inflated Poisson, ZIP）模型的均值和方差，您将清晰地看到两个子总体（一个“有风险”群体和一个“无风险”群体）的混合在数学上是如何导致方差超过均值的。", "problem": "在一项针对慢性阻塞性肺疾病患者的纵向研究中，临床医生记录了每位患者在固定的$1$年期间内经历的急性加重次数。为了处理因患者无加重风险（例如，由于稳定的表型或持续坚持预防性治疗）而产生的结构性零，使用零膨胀泊松 (ZIP) 模型对计数 $Y$ 进行建模。设结构性零指示变量 $Z$ 是一个潜变量，满足 $Z \\sim \\text{Bernoulli}(\\pi)$，其中 $Z=1$ 表示结构性零，$Z=0$ 表示易于发生事件。在给定 $Z$ 的条件下，定义：\n- $Y \\mid Z=1 = 0$ 几乎必然成立，以及\n- $Y \\mid Z=0 \\sim \\text{Poisson}(\\lambda)$,\n其中 $Z$ 与泊松分量无关。此处，$\\pi \\in [0,1)$ 是结构性零的概率，$\\lambda0$ 是易感患者中的泊松率。\n\n仅从基本概率定律以及泊松分布的均值等于其率、方差也等于其率的核心性质出发，推导 $Y$ 的无条件均值 $\\mathbb{E}[Y]$ 和方差 $\\operatorname{Var}(Y)$ 作为 $\\pi$ 和 $\\lambda$ 函数的闭式表达式。然后，解释相对于与 $Y$ 具有相同均值的非膨胀泊松模型，结构性零的存在如何导致离散度的增加。\n\n请将您的最终答案以一个单行矩阵的形式给出，该矩阵包含均值和方差。不需要进行数值计算。", "solution": "该问题陈述是基础概率论和统计建模中一个良定且有科学依据的练习。所有组成部分都得到了明确定义，且前提与零膨胀泊松 (ZIP) 模型的既定公式一致。因此，该问题是有效的。我们继续进行推导。\n\n随机变量 $Y$ 代表急性加重的次数。其分布是由一个潜伯努利变量 $Z$ 决定的混合分布。所给出的性质如下：\n- $Z \\sim \\text{Bernoulli}(\\pi)$，使得 $P(Z=1) = \\pi$ 且 $P(Z=0) = 1-\\pi$。\n- 给定 $Z$ 时 $Y$ 的条件分布为：\n  - $Y \\mid Z=1 = 0$ (在 $0$ 处的点质量)。\n  - $Y \\mid Z=0 \\sim \\text{Poisson}(\\lambda)$。\n- 泊松($\\mu$)分布的核心性质是 $\\mathbb{E}[\\text{Poisson}(\\mu)] = \\mu$ 和 $\\operatorname{Var}(\\text{Poisson}(\\mu)) = \\mu$。\n\n我们的目标是求出无条件均值 $\\mathbb{E}[Y]$ 和无条件方差 $\\operatorname{Var}(Y)$。\n\n**1. 推导均值 $\\mathbb{E}[Y]$**\n\n我们使用全期望定律，该定律指出 $\\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{E}[Y \\mid Z]]$。\n首先，我们计算对于 $Z$ 的每个可能值，条件期望 $\\mathbb{E}[Y \\mid Z]$。\n- 如果 $Z=1$，计数 $Y$ 固定为 $0$。因此，其期望为 $\\mathbb{E}[Y \\mid Z=1] = 0$。\n- 如果 $Z=0$，计数 $Y$ 服从率是 $\\lambda$ 的泊松分布。因此，其期望为 $\\mathbb{E}[Y \\mid Z=0] = \\lambda$。\n\n表达式 $\\mathbb{E}[Y \\mid Z]$ 本身是一个随机变量，它以概率 $P(Z=1) = \\pi$ 取值 $0$，以概率 $P(Z=0) = 1-\\pi$ 取值 $\\lambda$。\n现在，我们对这个随机变量关于 $Z$ 的分布求期望：\n$$ \\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{E}[Y \\mid Z]] = \\mathbb{E}[Y \\mid Z=0] \\cdot P(Z=0) + \\mathbb{E}[Y \\mid Z=1] \\cdot P(Z=1) $$\n代入我们求得的值：\n$$ \\mathbb{E}[Y] = \\lambda \\cdot (1-\\pi) + 0 \\cdot \\pi = \\lambda(1-\\pi) $$\n这是服从 ZIP 分布的随机变量 $Y$ 的无条件均值。\n\n**2. 推导方差 $\\operatorname{Var}(Y)$**\n\n我们使用全方差定律，该定律指出：\n$$ \\operatorname{Var}(Y) = \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] + \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) $$\n我们将分别计算这两个项。\n\n**第 1 项：$\\mathbb{E}[\\operatorname{Var}(Y \\mid Z)]$ (条件方差的期望)**\n\n首先，我们求出对于 $Z$ 的每个值，条件方差 $\\operatorname{Var}(Y \\mid Z)$。\n- 如果 $Z=1$，计数 $Y$ 固定为常数值 $0$。常数的方差为 $0$，所以 $\\operatorname{Var}(Y \\mid Z=1) = 0$。\n- 如果 $Z=0$，计数 $Y$ 服从率是 $\\lambda$ 的泊松分布。泊松($\\lambda$)分布的方差等于其率，所以 $\\operatorname{Var}(Y \\mid Z=0) = \\lambda$。\n\n表达式 $\\operatorname{Var}(Y \\mid Z)$ 是一个随机变量，以概率 $\\pi$ 取值 $0$，以概率 $1-\\pi$ 取值 $\\lambda$。我们计算它的期望：\n$$ \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] = \\operatorname{Var}(Y \\mid Z=0) \\cdot P(Z=0) + \\operatorname{Var}(Y \\mid Z=1) \\cdot P(Z=1) $$\n$$ \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] = \\lambda \\cdot (1-\\pi) + 0 \\cdot \\pi = \\lambda(1-\\pi) $$\n\n**第 2 项：$\\operatorname{Var}(\\mathbb{E}[Y \\mid Z])$ (条件期望的方差)**\n\n如前所述，$\\mathbb{E}[Y \\mid Z]$ 是一个随机变量，以概率 $1-\\pi$ 取值 $\\lambda$，以概率 $\\pi$ 取值 $0$。我们称这个类伯努利随机变量为 $W$。我们需要求出它的方差 $\\operatorname{Var}(W)$。\n方差由 $\\operatorname{Var}(W) = \\mathbb{E}[W^2] - (\\mathbb{E}[W])^2$ 给出。\n我们已经知道 $W$ 的均值：$\\mathbb{E}[W] = \\mathbb{E}[\\mathbb{E}[Y \\mid Z]] = \\mathbb{E}[Y] = \\lambda(1-\\pi)$。\n接下来，我们计算二阶矩 $\\mathbb{E}[W^2]$：\n$$ \\mathbb{E}[W^2] = (\\lambda)^2 \\cdot P(Z=0) + (0)^2 \\cdot P(Z=1) = \\lambda^2(1-\\pi) + 0 = \\lambda^2(1-\\pi) $$\n现在我们可以计算 $W$ 的方差：\n$$ \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) = \\operatorname{Var}(W) = \\mathbb{E}[W^2] - (\\mathbb{E}[W])^2 $$\n$$ \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) = \\lambda^2(1-\\pi) - (\\lambda(1-\\pi))^2 $$\n$$ \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) = \\lambda^2(1-\\pi) - \\lambda^2(1-\\pi)^2 = \\lambda^2(1-\\pi) [1 - (1-\\pi)] = \\lambda^2\\pi(1-\\pi) $$\n\n**合并各项：**\n\n最后，我们将这两项相加得到 $Y$ 的无条件方差：\n$$ \\operatorname{Var}(Y) = \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] + \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) $$\n$$ \\operatorname{Var}(Y) = \\lambda(1-\\pi) + \\lambda^2\\pi(1-\\pi) $$\n我们可以对这个表达式进行因式分解，以获得更紧凑的形式：\n$$ \\operatorname{Var}(Y) = \\lambda(1-\\pi) (1 + \\lambda\\pi) $$\n\n**3. 离散度的解释**\n\n设 $\\mu_Y = \\mathbb{E}[Y] = \\lambda(1-\\pi)$ 为服从 ZIP 分布的变量 $Y$ 的均值。\n一个具有相同均值的标准（非膨胀）泊松模型的率参数将等于 $\\mu_Y$。对于这样一个泊松模型，比如说随机变量 $Y_P \\sim \\text{Poisson}(\\mu_Y)$，其方差等于均值：\n$$ \\operatorname{Var}(Y_P) = \\mu_Y = \\lambda(1-\\pi) $$\n现在，我们将其与我们的 ZIP 模型的方差 $\\operatorname{Var}(Y)$ 进行比较：\n$$ \\operatorname{Var}(Y) = \\lambda(1-\\pi) + \\lambda^2\\pi(1-\\pi) = \\mu_Y + \\lambda^2\\pi(1-\\pi) $$\n项 $\\lambda^2\\pi(1-\\pi)$ 代表了由零膨胀部分对方差的贡献。\n给定约束条件 $\\lambda  0$ 和 $\\pi \\in [0,1)$，该项是非负的。\n- 如果 $\\pi = 0$，则没有零膨胀。ZIP 模型退化为标准的泊松($\\lambda$)模型，并且 $\\operatorname{Var}(Y) = \\mu_Y$。\n- 如果 $\\pi \\in (0,1)$，则项 $\\lambda^2\\pi(1-\\pi)$ 是严格为正的。因此，$\\operatorname{Var}(Y)  \\mu_Y$。\n\n这种方差超过均值的情况被称为**过度离散**。结构性零 ($\\pi  0$) 的存在为总体引入了额外的变异源。该总体是两组的异质混合：一个“从不发生事件”组和一个“有风险”组。这种异质性使得总方差膨胀，超出了具有相同平均事件率的齐次泊松过程所预期的方差。量 $\\lambda^2\\pi(1-\\pi)$ 精确地量化了由潜在混合结构引起的这种额外方差。\n\n最终推导出的均值和方差表达式为：\n均值: $\\mathbb{E}[Y] = \\lambda(1-\\pi)$\n方差: $\\operatorname{Var}(Y) = \\lambda(1-\\pi)(1 + \\lambda\\pi)$", "answer": "$$\\boxed{\\begin{pmatrix} \\lambda(1-\\pi)  \\lambda(1-\\pi)(1+\\lambda\\pi) \\end{pmatrix}}$$", "id": "4950089"}, {"introduction": "在怀疑数据存在过分散之后，严谨的模型构建者需要进行正式的检验来确认。得分检验（score test）提供了一种简洁的方法，它无需拟合更复杂的备择模型即可完成检验。这项实践 [@problem_id:4950109] 要求您构建一个得分检验，用于在负二项分布（Negative Binomial）的备择假设下检测是否存在过分散。通过推导检验统计量并将其应用于一个假设的数据集，您将巩固对如何运用统计假设检验来指导模型选择的理解。", "problem": "在一个以医院为基础的慢性病患者队列中，每位患者在固定随访期内的急诊就诊次数通过一个泊松广义线性模型 (GLM) 进行建模，该模型使用对数连接函数和人时偏移量。原假设下的基线模型假定为泊松变异：对于患者 $i$，计数 $Y_i$ 的均值为 $E(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$，方差为 $\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。考虑一个备择假设，其中计数服从负二项 (NB) 分布，其均值相同，但方差为 $\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i + \\alpha \\mu_i^2$，其中 $\\alpha \\ge 0$ 是一个过度离散参数。您需要构建一个基于 NB 备择假设的、用于检验额外泊松变异的得分检验，该检验在 $\\alpha = 0$ 处进行，并且 $\\mu_i$ 中的讨厌参数在原假设下通过泊松 GLM 进行估计。\n\n从泊松似然和由 $(\\mu_i, \\alpha)$ 参数化的负二项似然的基本定义出发，完成以下任务：\n\n1) 推导在 $\\alpha = 0$ 处（保持 $\\mu_i$ 固定）关于 $\\alpha$ 的得分，并说明如何在原假设模型下获得其方差。利用这些结果，以 $\\{Y_i, \\mu_i\\}_{i=1}^n$ 的形式构造得分检验统计量的闭合形式。清晰地指明该检验统计量的原假设分布。\n\n2) 对于以下 $n = 10$ 位患者，已经在原假设下拟合了一个泊松 GLM，得到了拟合均值 $\\hat{\\mu}_i$ 以及观测计数 $y_i$。使用您推导出的表达式，通过将 $\\hat{\\mu}_i$ 代入 $\\mu_i$ 来计算得分检验统计量 $S$ 的数值：\n- 患者 $1$：$y_1 = 0$，$\\hat{\\mu}_1 = 0.4$。\n- 患者 $2$：$y_2 = 1$，$\\hat{\\mu}_2 = 0.6$。\n- 患者 $3$：$y_3 = 0$，$\\hat{\\mu}_3 = 0.5$。\n- 患者 $4$：$y_4 = 2$，$\\hat{\\mu}_4 = 1.1$。\n- 患者 $5$：$y_5 = 3$，$\\hat{\\mu}_5 = 1.5$。\n- 患者 $6$：$y_6 = 0$，$\\hat{\\mu}_6 = 0.7$。\n- 患者 $7$：$y_7 = 4$，$\\hat{\\mu}_7 = 2.1$。\n- 患者 $8$：$y_8 = 1$，$\\hat{\\mu}_8 = 0.9$。\n- 患者 $9$：$y_9 = 2$，$\\hat{\\mu}_9 = 1.2$。\n- 患者 $10$：$y_{10} = 5$，$\\hat{\\mu}_{10} = 3.0$。\n\n计算 $S$ 并报告其值。将您的答案四舍五入到四位有效数字。\n\n注意：对于第 (1) 部分，请从似然定义开始，而不是从任何预先记下的检验公式开始。对于第 (2) 部分，请使用您从第 (1) 部分得到的结果和提供的 $\\hat{\\mu}_i$ 值。最终报告的答案必须是按要求指定的 $S$ 的单个数值。", "solution": "### 第1步：提取已知条件\n- **原假设 ($H_0$)下的模型**：对于患者 $i$，计数 $Y_i$ 服从泊松分布。\n  - 均值：$E(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。\n  - 方差：$\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。\n  - 均值通过一个带对数连接的泊松GLM建模：$\\ln(\\mu_i) = \\boldsymbol{x}_i^T \\boldsymbol{\\beta}$。\n- **备择假设 ($H_A$)下的模型**：计数 $Y_i$ 服从负二项 (NB) 分布。\n  - 均值：$E(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。\n  - 方差：$\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i + \\alpha \\mu_i^2$，其中 $\\alpha \\ge 0$ 是过度离散参数。\n- **假设检验**：针对 $H_0: \\alpha=0$ 与 $H_A: \\alpha  0$ 的得分检验。\n- **讨厌参数**：定义 $\\mu_i$ 的参数（即 $\\boldsymbol{\\beta}$）在 $H_0$ 下使用泊松GLM进行估计。\n- **第2部分的数据**：一个包含 $n=10$ 位患者的样本，包括观测计数 $y_i$ 和从零泊松模型得到的拟合均值 $\\hat{\\mu}_i$。\n  - 患者 $1$：$y_1=0$，$\\hat{\\mu}_1 = 0.4$。\n  - 患者 $2$：$y_2=1$，$\\hat{\\mu}_2 = 0.6$。\n  - 患者 $3$：$y_3=0$，$\\hat{\\mu}_3 = 0.5$。\n  - 患者 $4$：$y_4=2$，$\\hat{\\mu}_4 = 1.1$。\n  - 患者 $5$：$y_5=3$，$\\hat{\\mu}_5 = 1.5$。\n  - 患者 $6$：$y_6=0$，$\\hat{\\mu}_6 = 0.7$。\n  - 患者 $7$：$y_7=4$，$\\hat{\\mu}_7 = 2.1$。\n  - 患者 $8$：$y_8=1$，$\\hat{\\mu}_8 = 0.9$。\n  - 患者 $9$：$y_9=2$，$\\hat{\\mu}_9 = 1.2$。\n  - 患者 $10$：$y_{10}=5$，$\\hat{\\mu}_{10} = 3.0$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，是生物统计学和广义线性模型中的一个标准课题。指定的负二项方差形式 $\\mu + \\alpha\\mu^2$ 是一系列标准参数化（NB2族）之一。推导得分检验是一个明确定义的统计过程。该问题是自洽的，提供了所有必要的理论背景和数值数据。语言精确客观。没有矛盾、歧义或不切实际的假设。该问题提法恰当且可解。\n\n### 第3步：结论与行动\n问题是**有效的**。将提供完整的解答。\n\n***\n\n### 第1部分：得分检验的推导\n\n得分检验由备择模型的对数似然函数的梯度构建，并在原假设下进行评估。\n\n均值为 $\\mu$、方差为 $\\mu + \\alpha \\mu^2$ 的负二项 (NB) 分布的概率质量函数 (PMF) 为：\n$$ P(Y=y; \\mu, \\alpha) = \\frac{\\Gamma(y + \\alpha^{-1})}{\\Gamma(\\alpha^{-1}) y!} \\left(\\frac{\\alpha\\mu}{1+\\alpha\\mu}\\right)^y \\left(\\frac{1}{1+\\alpha\\mu}\\right)^{\\alpha^{-1}} $$\n对于 $y = 0, 1, 2, ...$。当 $\\alpha \\to 0$ 时，此分布趋近于均值为 $\\mu$ 的泊松分布。\n\n单个观测值 $Y_i$ 的对数似然函数为：\n$$ \\ell_i(\\mu_i, \\alpha) = \\ln \\Gamma(y_i + \\alpha^{-1}) - \\ln \\Gamma(\\alpha^{-1}) - \\ln(y_i!) + y_i \\ln(\\alpha\\mu_i) - (y_i + \\alpha^{-1}) \\ln(1+\\alpha\\mu_i) $$\n$n$ 个独立观测值的总对数似然函数为 $\\ell(\\boldsymbol{\\mu}, \\alpha) = \\sum_{i=1}^n \\ell_i(\\mu_i, \\alpha)$。\n\n由于 $\\alpha^{-1}$ 项的存在，直接对 $\\alpha$ 求导很麻烦。一个更易于处理的方法是找到 $\\ell_i$ 在 $\\alpha=0$ 附近的泰勒级数展开。可以证明，对数似然函数可以近似为：\n$$ \\ell_i(\\mu_i, \\alpha) \\approx \\ell_{Poisson}(\\mu_i; y_i) + \\frac{\\alpha}{2} \\left[ (y_i - \\mu_i)^2 - y_i \\right] + O(\\alpha^2) $$\n其中 $\\ell_{Poisson}(\\mu_i; y_i) = y_i \\ln(\\mu_i) - \\mu_i - \\ln(y_i!)$ 是泊松分布的对数似然函数。\n\n关于 $\\alpha$ 的得分是总对数似然函数关于 $\\alpha$ 的偏导数。对于单个观测值，得分分量为：\n$$ U_i(\\alpha) = \\frac{\\partial \\ell_i}{\\partial \\alpha} $$\n在 $\\alpha=0$ 处求值，我们得到：\n$$ U_i(0) = \\left. \\frac{\\partial \\ell_i}{\\partial \\alpha} \\right|_{\\alpha=0} = \\frac{1}{2} \\left[ (y_i - \\mu_i)^2 - y_i \\right] $$\n在 $\\alpha=0$ 处求值的总得分 $U(\\alpha)$ 是所有观测值的总和：\n$$ U(0) = \\sum_{i=1}^n U_i(0) = \\frac{1}{2} \\sum_{i=1}^n \\left[ (Y_i - \\mu_i)^2 - Y_i \\right] $$\n得分检验要求将讨厌参数（$\\mu_i$ 中的 $\\boldsymbol{\\beta}$）替换为其在 $H_0$ 下的最大似然估计。设 $\\hat{\\mu}_i$ 为泊松GLM的拟合值。则得分统计量基于：\n$$ U(0)|_{\\mu=\\hat{\\mu}} = \\frac{1}{2} \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] $$\n\n接下来，我们需要在 $H_0: \\alpha=0$ 下得分的方差，即费雪信息 $I_{\\alpha\\alpha}(0)$。在 $H_0$ 下，$Y_i \\sim \\text{Poisson}(\\mu_i)$。\n首先，我们验证在 $H_0$ 下得分的期望为零：\n$$ E[U_i(0)] = E\\left[ \\frac{1}{2} \\left( (Y_i - \\mu_i)^2 - Y_i \\right) \\right] = \\frac{1}{2} \\left( E[(Y_i - \\mu_i)^2] - E[Y_i] \\right) $$\n对于泊松分布，$E[Y_i] = \\mu_i$ 且方差 $E[(Y_i - \\mu_i)^2] = \\mu_i$。因此，\n$$ E[U_i(0)] = \\frac{1}{2} (\\mu_i - \\mu_i) = 0 $$\n观测值 $i$ 的得分方差为 $\\operatorname{Var}(U_i(0)) = E[U_i(0)^2] - (E[U_i(0)])^2 = E[U_i(0)^2]$。\n$$ \\operatorname{Var}(U_i(0)) = E\\left[ \\left( \\frac{1}{2} \\left[ (Y_i - \\mu_i)^2 - Y_i \\right] \\right)^2 \\right] = \\frac{1}{4} E\\left[ \\left( (Y_i - \\mu_i)^2 - Y_i \\right)^2 \\right] $$\n$$ = \\frac{1}{4} E\\left[ (Y_i - \\mu_i)^4 - 2Y_i(Y_i - \\mu_i)^2 + Y_i^2 \\right] $$\n我们使用泊松分布的矩：\n- $E[(Y_i - \\mu_i)^2] = \\mu_i$\n- $E[(Y_i - \\mu_i)^3] = \\mu_i$\n- $E[(Y_i - \\mu_i)^4] = 3\\mu_i^2 + \\mu_i$\n我们还需要另外两个期望：\n- $E[Y_i^2] = \\operatorname{Var}(Y_i) + (E[Y_i])^2 = \\mu_i + \\mu_i^2$\n- $E[Y_i(Y_i-\\mu_i)^2] = E[(\\mu_i + (Y_i-\\mu_i))(Y_i-\\mu_i)^2] = E[\\mu_i(Y_i-\\mu_i)^2 + (Y_i-\\mu_i)^3] = \\mu_i E[(Y_i-\\mu_i)^2] + E[(Y_i-\\mu_i)^3] = \\mu_i(\\mu_i) + \\mu_i = \\mu_i^2 + \\mu_i$\n将这些代入方差表达式：\n$$ \\operatorname{Var}(U_i(0)) = \\frac{1}{4} \\left[ (3\\mu_i^2 + \\mu_i) - 2(\\mu_i^2 + \\mu_i) + (\\mu_i^2 + \\mu_i) \\right] $$\n$$ = \\frac{1}{4} [ (3-2+1)\\mu_i^2 + (1-2+1)\\mu_i ] = \\frac{1}{4} [2\\mu_i^2] = \\frac{\\mu_i^2}{2} $$\n由于观测值是独立的，总信息量是单个方差的总和：\n$$ I_{\\alpha\\alpha}(0) = \\operatorname{Var}(U(0)) = \\sum_{i=1}^n \\operatorname{Var}(U_i(0)) = \\sum_{i=1}^n \\frac{\\mu_i^2}{2} = \\frac{1}{2} \\sum_{i=1}^n \\mu_i^2 $$\n得分检验统计量 $S$ 构建为 $S = \\frac{U(0)^2}{I_{\\alpha\\alpha}(0)}$，其中 $\\mu_i$ 被替换为 $\\hat{\\mu}_i$：\n$$ S = \\frac{\\left( \\frac{1}{2} \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] \\right)^2}{\\frac{1}{2} \\sum_{i=1}^n \\hat{\\mu}_i^2} $$\n$$ S = \\frac{\\frac{1}{4} \\left( \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] \\right)^2}{\\frac{1}{2} \\sum_{i=1}^n \\hat{\\mu}_i^2} = \\frac{\\left( \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] \\right)^2}{2 \\sum_{i=1}^n \\hat{\\mu}_i^2} $$\n这是得分检验统计量的闭合形式表达式。在原假设 $H_0: \\alpha=0$ 下，该统计量渐近服从自由度为1的卡方分布，$S \\sim \\chi_1^2$。\n\n### 第2部分：检验统计量的计算\n\n我们使用推导出的 $S$ 公式和给定数据，用 $\\hat{\\mu}_i$ 替换 $\\mu_i$，用 $y_i$ 替换 $Y_i$。\n$S$ 的分子是 $\\left( \\sum_{i=1}^{10} \\left[ (y_i - \\hat{\\mu}_i)^2 - y_i \\right] \\right)^2$。\n我们为每个患者计算项 $d_i = (y_i - \\hat{\\mu}_i)^2 - y_i$：\n- $d_1 = (0 - 0.4)^2 - 0 = 0.16$\n- $d_2 = (1 - 0.6)^2 - 1 = 0.16 - 1 = -0.84$\n- $d_3 = (0 - 0.5)^2 - 0 = 0.25$\n- $d_4 = (2 - 1.1)^2 - 2 = 0.81 - 2 = -1.19$\n- $d_5 = (3 - 1.5)^2 - 3 = 2.25 - 3 = -0.75$\n- $d_6 = (0 - 0.7)^2 - 0 = 0.49$\n- $d_7 = (4 - 2.1)^2 - 4 = 3.61 - 4 = -0.39$\n- $d_8 = (1 - 0.9)^2 - 1 = 0.01 - 1 = -0.99$\n- $d_9 = (2 - 1.2)^2 - 2 = 0.64 - 2 = -1.36$\n- $d_{10} = (5 - 3.0)^2 - 5 = 4.0 - 5 = -1.00$\n\n总和为：\n$$ \\sum_{i=1}^{10} d_i = 0.16 - 0.84 + 0.25 - 1.19 - 0.75 + 0.49 - 0.39 - 0.99 - 1.36 - 1.00 = -5.62 $$\n分子是 $(-5.62)^2 = 31.5844$。\n\n$S$ 的分母是 $2 \\sum_{i=1}^{10} \\hat{\\mu}_i^2$。\n我们为每个患者计算 $\\hat{\\mu}_i^2$：\n- $\\hat{\\mu}_1^2 = 0.4^2 = 0.16$\n- $\\hat{\\mu}_2^2 = 0.6^2 = 0.36$\n- $\\hat{\\mu}_3^2 = 0.5^2 = 0.25$\n- $\\hat{\\mu}_4^2 = 1.1^2 = 1.21$\n- $\\hat{\\mu}_5^2 = 1.5^2 = 2.25$\n- $\\hat{\\mu}_6^2 = 0.7^2 = 0.49$\n- $\\hat{\\mu}_7^2 = 2.1^2 = 4.41$\n- $\\hat{\\mu}_8^2 = 0.9^2 = 0.81$\n- $\\hat{\\mu}_9^2 = 1.2^2 = 1.44$\n- $\\hat{\\mu}_{10}^2 = 3.0^2 = 9.00$\n\n总和为：\n$$ \\sum_{i=1}^{10} \\hat{\\mu}_i^2 = 0.16 + 0.36 + 0.25 + 1.21 + 2.25 + 0.49 + 4.41 + 0.81 + 1.44 + 9.00 = 20.38 $$\n分母是 $2 \\times 20.38 = 40.76$。\n\n最后，得分检验统计量 $S$ 为：\n$$ S = \\frac{31.5844}{40.76} \\approx 0.77493621197 $$\n四舍五入到四位有效数字，我们得到 $S = 0.7749$。", "answer": "$$\n\\boxed{0.7749}\n$$", "id": "4950109"}, {"introduction": "真实世界的数据分析很少是直截了当的。数据往往同时表现出普遍的过分散和潜在的零计数过量，这使得模型选择成为一项需要细致权衡的任务。这个案例研究 [@problem_id:4950087] 将您置于一位数据分析师的角色，面对一个真实的医学数据集。您必须综合各种证据——从简单的描述性统计到正式的模型比较检验——来正确诊断过分散的性质，并选择最合适的模型。这项练习旨在磨练您在进行稳健和有原则的统计建模时所必需的批判性思维能力。", "problem": "一项针对慢性阻塞性肺疾病患者的多中心观察性研究记录了每位患者在整整$1$年随访期内的急性加重次数。设$Y_i$表示患者$i$的年度计数，并假设各患者之间相互独立。研究人员怀疑数据中同时存在过多的零值和普遍的过度离散现象。对$n=800$个计数的汇总显示，经验均值为$\\bar{y}=\\mu_{\\text{obs}}=1.20$，方差为$s^2=3.60$，零值比例为$\\hat{p}_0=0.55$。考虑分析团队已执行的以下建模步骤：\n- 拟合了一个仅含截距项的泊松回归模型，得到$\\hat{\\lambda}=1.20$。\n- 拟合了一个仅含截距项的负二项 (NB) 回归模型，使用了均值为$\\mu$和规模参数为$k$的经典参数化方法（因此$E[Y]=\\mu$且$Var(Y)=\\mu\\left(1+\\frac{\\mu}{k}\\right)$），得到$\\hat{\\mu}=1.20$和$\\hat{k}=0.80$。\n- 在NB拟合下的随机分位数残差 (RQR) 显示，在观测到的零值处存在大量负残差聚集，并且在悬挂根图中，对于较小的计数值$y\\in\\{1,2\\}$存在轻微的右尾偏差。\n- 针对嵌套在NB计数模型中的零膨胀进行的得分检验报告称，对于不存在额外零成分的原假设，其$p$-值为$0.030$。\n- 比较NB与零膨胀负二项 (ZINB) 模型的Vuong非嵌套检验得出的检验统计量为$z=1.75$，对应的标准正态$p$-值为$0.080$。同一比较的参数自助法版本（使用NB作为原假设生成模型）返回的$p$-值为$0.042$。\n从基本的分布定义出发，可以计算不同计数模型下零值的期望频率，并使用诊断工具来定位拟合不足之处。基于此情景，哪个选项描述了一个有原则的工作流程，该流程利用零值频率、残差诊断和针对性检验来区分普遍的过度离散和真实的零膨胀？\n\nA. 仅因为$\\hat{p}_0=0.55$超过了$\\hat{\\lambda}=1.20$时的泊松期望值，就断定存在零膨胀，并直接使用零膨胀泊松 (ZIP) 模型，无需进一步检查；残差诊断和考虑其他过度离散的计数模型是不必要的。\n\nB. 使用NB模型作为基线来处理普遍的过度离散，并从基本原理计算其隐含的零概率；如果观测到的$\\hat{p}_0$显著超过NB模型期望的零值数量，则应用一个正式的零膨胀得分检验，通过Vuong检验和参数自助法比较NB与零膨胀负二项 (ZINB) 模型，并审查RQR和根图以确认拟合不足集中在$y=0$和较小的计数值上；在零成分中纳入临床上合理的协变量以表示结构性零值，并根据综合证据而非仅仅是方差均值比来决定选择NB还是ZINB模型。\n\nC. 拟合一个带离散参数$\\phi$的类泊松模型，如果$\\hat{\\phi}1$，则断定过度离散和零膨胀都存在；一个单一的离散参数足以诊断和解释过多的零值，无需进一步检验。\n\nD. 立即拟合一个门槛模型，并仅通过赤池信息准则 (AIC) 来选择最终模型，忽略残差诊断和用于检验是否存在明确额外零成分的测试；高比例的零值自动证明了使用门槛模型是合理的，而无需考虑NB模型的零概率。", "solution": "### 步骤1：提取已知信息\n\n问题为一项关于慢性阻塞性肺疾病急性加重的研究提供了以下数据和建模结果：\n-   样本量：$n=800$ 名患者。\n-   随访期：整整 $1$ 年。\n-   结果变量：$Y_i$，患者 $i$ 的年度急性加重次数。\n-   计数的经验均值：$\\bar{y} = \\mu_{\\text{obs}} = 1.20$。\n-   计数的经验方差：$s^2 = 3.60$。\n-   零值的经验比例：$\\hat{p}_0 = 0.55$。\n-   仅含截距项的泊松模型拟合：$\\hat{\\lambda}=1.20$。\n-   仅含截距项的负二项 (NB) 模型拟合，其均值为 $\\mu$，规模参数为 $k$：$\\hat{\\mu}=1.20$ 且 $\\hat{k}=0.80$。此参数化下的方差为 $Var(Y)=\\mu\\left(1+\\frac{\\mu}{k}\\right)$。\n-   来自NB拟合的随机分位数残差 (RQR) 显示，在 $Y_i=0$ 的观测值处存在大量负残差聚集，并且对于较小的正计数值 ($y\\in\\{1,2\\}$) 存在偏差。\n-   针对NB模型的零膨胀得分检验得出的 $p$-值为 $0.030$。\n-   比较NB与零膨胀负二项 (ZINB) 模型的Vuong检验得出的统计量为 $z=1.75$，标准正态 $p$-值为 $0.080$。\n-   Vuong检验的参数自助法版本得出的 $p$-值为 $0.042$。\n\n### 步骤2：使用提取的已知信息进行验证\n\n问题陈述在科学上和统计上都是合理的。\n-   **科学基础**：该问题情景是在一项医学研究中对计数数据（疾病加重次数）进行建模，这是统计方法的标准应用。所讨论的模型（泊松、NB、ZINB、门槛模型）和诊断工具（RQR、得分检验、Vuong检验）都是成熟且适用于此情景的。\n-   **问题定义明确**：该问题定义清晰。它提供了一个具有一致性量化信息的现实情景，并要求根据这些证据确定一个有原则的工作流程。通过应用统计学原理可以辨别出唯一答案。\n-   **客观性**：语言精确客观，提供了统计分析的数值结果，没有主观解释。\n-   **一致性检查**：\n    - 样本方差 $s^2=3.60$ 大于样本均值 $\\bar{y}=1.20$，表明相对于方差等于均值的泊松分布存在过度离散。方差均值比为 $3.60/1.20 = 3$。这证明了考虑简单泊松模型之外的其他模型是合理的。\n    - 对于仅含截距项的泊松模型拟合，率参数 $\\lambda$ 的最大似然估计 (MLE) 是样本均值，因此 $\\hat{\\lambda}=\\bar{y}=1.20$ 是正确的。\n    - 对于仅含截距项的NB模型拟合，均值参数 $\\mu$ 的最大似然估计也是样本均值，因此 $\\hat{\\mu}=\\bar{y}=1.20$ 是正确的。\n    - 拟合的NB模型所隐含的方差为 $Var(Y) = \\hat{\\mu}(1+\\hat{\\mu}/\\hat{k}) = 1.20(1+1.20/0.80) = 1.20(1+1.5) = 1.20(2.5) = 3.00$。该值接近样本方差 $s^2=3.60$，表明NB模型捕捉了相当一部分的过度离散。\n    - 所有提供的信息内部一致，反映了一个标准的、现实的数据分析情景。\n\n### 步骤3：判断与行动\n\n问题是有效的。解决方案将通过评估每个选项来展开。\n\n### 推导与选项分析\n\n问题的核心是区分两种都会导致过度离散（方差大于均值）的现象：(1) 各受试者事件发生率的普遍异质性，这可以由负二项模型捕捉；(2) 一种“真实的”或“结构性的”零膨胀过程，即一部分受试者群体根本没有经历该事件的风险，这可以通过零膨胀模型或门槛模型来建模。一个有原则的工作流程必须系统地厘清这些可能性。\n\n首先，我们计算两个初始模型下零值的期望比例。\n1.  **泊松模型**：零计数的概率为 $P(Y=0|\\lambda) = e^{-\\lambda}$。当 $\\hat{\\lambda}=1.20$ 时，期望的零值比例为 $P(Y=0) = e^{-1.20} \\approx 0.301$。\n2.  **负二项模型**：均值为 $\\mu$、规模参数为 $k$ 的NB分布的概率质量函数为 $P(Y=y) = \\frac{\\Gamma(y+k)}{\\Gamma(k)y!} \\left(\\frac{k}{k+\\mu}\\right)^k \\left(\\frac{\\mu}{k+\\mu}\\right)^y$。当 $y=0$ 时，该式简化为 $P(Y=0|\\mu,k) = \\left(\\frac{k}{k+\\mu}\\right)^k$。当 $\\hat{\\mu}=1.20$ 且 $\\hat{k}=0.80$ 时，期望的零值比例为 $P(Y=0) = \\left(\\frac{0.80}{0.80+1.20}\\right)^{0.80} = (0.4)^{0.8} \\approx 0.478$。\n\n观测到的零值比例为 $\\hat{p}_0 = 0.55$。\n-   泊松模型严重低估了零值的数量（$0.301$ 对比 $0.55$）。\n-   NB模型的表现要好得多，但仍然低估了零值的数量（$0.478$ 对比 $0.55$），这表明可能存在NB模型的异质性参数也无法完全解释的剩余零膨胀。\n\n现在，我们评估每个选项。\n\n**A. 仅因为 $\\hat{p}_0=0.55$ 超过了 $\\hat{\\lambda}=1.20$ 时的泊松期望值，就断定存在零膨胀，并直接使用零膨胀泊松 (ZIP) 模型，无需进一步检查；残差诊断和考虑其他过度离散的计数模型是不必要的。**\n\n该选项描述了一个有缺陷且肤浅的工作流程。虽然 $\\hat{p}_0$ 与泊松期望值之间的差异正确地指出了泊松模型存在问题，但这并不能唯一地诊断出零膨胀。由NB模型捕捉到的一般过度离散也会导致相对于泊松模型的过多零值。直接跳到ZIP模型忽略了简单的NB模型可能就足够，或者ZINB模型可能是必要的可能性（因为即使不考虑零值，数据也存在过度离散）。“不做进一步检查”这种对诊断的忽视与所有健全的统计实践背道而驰。\n**结论：不正确。**\n\n**B. 使用NB模型作为基线来处理普遍的过度离散，并从基本原理计算其隐含的零概率；如果观测到的 $\\hat{p}_0$ 显著超过NB模型期望的零值数量，则应用一个正式的零膨胀得分检验，通过Vuong检验和参数自助法比较NB与零膨胀负二项 (ZINB) 模型，并审查RQR和根图以确认拟合不足集中在 $y=0$ 和较小的计数值上；在零成分中纳入临床上合理的协变量以表示结构性零值，并根据综合证据而非仅仅是方差均值比来决定选择NB还是ZINB模型。**\n\n该选项概述了一个全面而严谨的工作流程，与现代计数数据分析的统计实践完全吻合。\n1.  它正确地将NB模型确立为处理普遍过度离散的恰当基线，这是在声称存在特定零膨胀之前必须采取的第一步。\n2.  它使用观测到的零值（$\\hat{p}_0=0.55$）与NB预测的零值（$P(Y=0)\\approx 0.478$）之间的差异作为初步证据。\n3.  它接着进行正式的假设检验：得分检验（$p=0.030$）和更可靠的参数自助法Vuong检验（$p=0.042$）都为支持ZINB模型优于NB模型提供了统计证据。\n4.  它结合了图形诊断（RQR，根图）来确认NB模型中的拟合不足集中在零计数处，这是零膨胀的特征。“在观测零值处存在大量负残差”正确地解释了在这种情况下RQR的输出。\n5.  它包括了通过考虑零膨胀成分的协变量来改进模型的关键步骤，这增强了可解释性。\n6.  它正确地得出结论，即最终模型的选择应基于所有可用证据（检验、诊断、拟合统计量、科学合理性）的综合，而不仅仅是单一指标。\n整个过程是解决复杂建模问题的教科书式范例。\n**结论：正确。**\n\n**C. 拟合一个带离散参数 $\\phi$ 的类泊松模型，如果 $\\hat{\\phi}1$，则断定过度离散和零膨胀都存在；一个单一的离散参数足以诊断和解释过多的零值，无需进一步检验。**\n\n该选项基于对类泊松模型的基本误解。类泊松模型假设方差为 $Var(Y) = \\phi E[Y]$。$\\hat{\\phi}  1$ 的估计值（此处，$\\hat{\\phi} \\approx s^2/\\bar{y} = 3.60/1.20 = 3.00$）证实了过度离散，但没有提供关于其来源的任何信息。它无法区分普遍异质性和特定的零膨胀过程。离散参数 $\\phi$ 只是一个对标准误进行事后校正的因子；它不会改变模型的拟合值或其基于底层泊松结构预测的零概率。因此，它不能以一种机制性的方式“诊断”或“解释”过多的零值。需要进一步的检验和更结构化的模型（如NB或ZI模型）来探究过度离散的性质。\n**结论：不正确。**\n\n**D. 立即拟合一个门槛模型，并仅通过赤池信息准则 (AIC) 来选择最终模型，忽略残差诊断和用于检验是否存在明确额外零成分的测试；高比例的零值自动证明了使用门槛模型是合理的，而无需考虑NB模型的零概率。**\n\n这个工作流程是草率的，在方法论上是薄弱的。虽然门槛模型是ZI模型的一个有效替代方案，但根据高零值计数就“立即”和“自动”地拟合它是没有原则的。应首先评估像NB这样更简单的模型是否足够。“不管NB模型的零概率如何”的说法是一个关键错误；将观测到的零值计数与NB的期望值进行比较是一个至关重要的步骤。此外，“仅仅”依靠AIC进行模型选择是不好的做法。AIC是比较非嵌套模型的宝贵工具，但它不会揭示模型拟合不佳的*原因*或*位置*。忽略残差诊断和正式的假设检验意味着盲目操作，并可能选择一个总体AIC得分不错但未能捕捉数据重要特征的模型。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "4950087"}]}