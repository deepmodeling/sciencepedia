{"hands_on_practices": [{"introduction": "这项练习是一项基础实践 [@problem_id:4985824]。它要求您从一个同时包含左截断和右删失的数据集中计算生存函数，这两种情况在真实世界的医学研究中都很常见。通过解决这个问题，您将掌握识别风险集和应用乘积极限公式的逐步过程，这是非参数生存分析的基石。", "problem": "一项前瞻性医疗登记研究从一个定义的时间起点开始随访患者，直至发生不良事件（例如，首次住院）或管理性删失。由于延迟入组（左截断），患者可能会在时间起点之后进入风险集。假设右删失和左截断是独立的，并且在任何事件和删失同时发生的时间点，为了风险集核算，事件在删失之前被记录。$12$名患者的数据以三元组 $\\big(L_i, T_i, \\delta_i\\big)$ 的形式给出，其中 $L_i$ 是左截断（入组）时间（单位：月），$T_i$ 是观测时间（单位：月，事件时间或删失时间），$\\delta_i \\in \\{0,1\\}$ 是指示删失（$0$）或事件（$1$）的指示符：\n- $i=1$: $\\big(0, 3, 1\\big)$\n- $i=2$: $\\big(0, 5, 0\\big)$\n- $i=3$: $\\big(0, 5, 1\\big)$\n- $i=4$: $\\big(2, 6, 1\\big)$\n- $i=5$: $\\big(1, 9, 0\\big)$\n- $i=6$: $\\big(0, 9, 1\\big)$\n- $i=7$: $\\big(4, 10, 1\\big)$\n- $i=8$: $\\big(0, 12, 0\\big)$\n- $i=9$: $\\big(7, 12, 1\\big)$\n- $i=10$: $\\big(5, 14, 1\\big)$\n- $i=11$: $\\big(8, 14, 0\\big)$\n- $i=12$: $\\big(0, 15, 0\\big)$\n\n从生存函数 $S(t)=\\Pr(Tt)$ 的定义以及右删失、左截断数据的似然函数出发，通过识别每个不同事件时间点的风险集并构建适当的条件生存概率，推导出生存函数的非参数最大似然估计（NPMLE）$\\hat S(t)$。在你的推导中，明确解释为什么 $\\hat S(t)$ 在事件时间点出现阶梯式下降，而在只有删失的时间段内保持平坦。\n\n为该数据集计算 $\\hat S(t)$，并根据生存函数的标准右连续约定，报告 $\\hat S(14)$ 的值。将最终答案表示为精确的既约分数。不要包含单位，也不要使用百分号。", "solution": "该问题要求在给定左截断和右删失数据的情况下，推导并计算生存函数 $S(t)$ 的非参数最大似然估计（NPMLE）。这个估计量是 Kaplan-Meier 估计量的一个扩展，有时被称为乘积限估计量。\n\n对于左截断和右删失数据，生存函数的NPMLE $\\hat{S}(t)$ 是一个乘积限公式：\n$$\\hat{S}(t) = \\prod_{j: t_{(j)} \\le t} \\left(1 - \\frac{d_j}{n_j}\\right)$$\n在此，各组成部分定义如下：\n-   $t_{(j)}$：数据中观测到的第 $j$ 个不同的事件时间。\n-   $d_j$：在时间 $t_{(j)}$ 发生事件的个体数量。\n-   $n_j$：在时间 $t_{(j)}$ 处于风险集中的个体数量。风险集 $R(t_{(j)})$ 包括所有正在被观察且尚未发生事件或被删失的个体。对于左截断数据，这遵循本文“原理和机制”一章中定义的计数过程约定：一个个体 $i$ 在时间 $t_{(j)}$ 处于风险中，当且仅当其入组时间 $L_i$ 严格早于 $t_{(j)}$，并且其退出时间 $T_i$ 大于或等于 $t_{(j)}$。因此，$n_j = |\\{i : L_i  t_{(j)} \\text{ and } T_i \\ge t_{(j)}\\}|$。\n\n$\\hat{S}(t)$ 的形式解释了其行为。生存函数的初始值定义为 $\\hat{S}(0)=1$。随着时间 $t$ 的增加，$\\hat{S}(t)$ 的值在事件时间点之间保持不变。在每个不同的事件时间 $t_{(j)}$，一个新的乘法因子 $(1 - d_j/n_j)$ 被引入，导致 $\\hat{S}(t)$ 在每个事件时间点经历一个离散的向下的阶跃。在一个只有删失发生的时间，没有新的事件时间被跨越，所以没有新的因子被乘入，$\\hat{S}(t)$ 保持不变。删失只影响后续事件时间的风险集大小 $n_j$。\n\n我们现在为所提供的数据集计算 $\\hat{S}(t)$。首先，我们从数据中识别出 $\\delta_i=1$ 的不同事件时间：$3, 5, 6, 9, 10, 12, 14$。\n\n-   **事件时间 $t_{(1)} = 3$**：\n    -   事件数 $d_1 = 1$（患者 $1$）。\n    -   风险集 $R(3) = \\{i: L_i  3 \\text{ and } T_i \\ge 3\\}$。成员为患者 $1, 2, 3, 4, 5, 6, 8, 12$。\n    -   风险人数 $n_1 = 8$。\n    -   $\\hat{S}(3) = 1 - \\frac{1}{8} = \\frac{7}{8}$。\n\n-   **事件时间 $t_{(2)} = 5$**：\n    -   事件数 $d_2 = 1$（患者 $3$）。\n    -   风险集 $R(5) = \\{i: L_i  5 \\text{ and } T_i \\ge 5\\}$。成员为患者 $2, 3, 4, 5, 6, 7, 8, 12$（患者 $7$ 的 $L_7=4  5$；患者 $10$ 的 $L_{10}=5$ 不满足 $L_{10}5$）。\n    -   风险人数 $n_2 = 8$。\n    -   $\\hat{S}(5) = \\hat{S}(3) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = \\frac{7}{8} \\times \\left(1 - \\frac{1}{8}\\right) = \\frac{49}{64}$。\n\n-   **事件时间 $t_{(3)} = 6$**：\n    -   事件数 $d_3 = 1$（患者 $4$）。\n    -   风险集 $R(6) = \\{i: L_i  6 \\text{ and } T_i \\ge 6\\}$。成员为患者 $4, 5, 6, 7, 8, 10, 12$（患者 $10$ 的 $L_{10}=5  6$）。\n    -   风险人数 $n_3 = 7$。\n    -   $\\hat{S}(6) = \\hat{S}(5) \\times \\left(1 - \\frac{d_3}{n_3}\\right) = \\frac{49}{64} \\times \\left(1 - \\frac{1}{7}\\right) = \\frac{49}{64} \\times \\frac{6}{7} = \\frac{42}{64} = \\frac{21}{32}$。\n\n-   **事件时间 $t_{(4)} = 9$**：\n    -   事件数 $d_4 = 1$（患者 $6$）。\n    -   风险集 $R(9) = \\{i: L_i  9 \\text{ and } T_i \\ge 9\\}$。成员为患者 $5, 6, 7, 8, 9, 10, 11, 12$（患者 $9$ 的 $L_9=7  9$；患者 $11$ 的 $L_{11}=8  9$）。\n    -   风险人数 $n_4 = 8$。\n    -   $\\hat{S}(9) = \\hat{S}(6) \\times \\left(1 - \\frac{d_4}{n_4}\\right) = \\frac{21}{32} \\times \\left(1 - \\frac{1}{8}\\right) = \\frac{21}{32} \\times \\frac{7}{8} = \\frac{147}{256}$。\n\n-   **事件时间 $t_{(5)} = 10$**：\n    -   事件数 $d_5 = 1$（患者 $7$）。\n    -   风险集 $R(10) = \\{i: L_i  10 \\text{ and } T_i \\ge 10\\}$。成员为患者 $7, 8, 9, 10, 11, 12$。\n    -   风险人数 $n_5 = 6$。\n    -   $\\hat{S}(10) = \\hat{S}(9) \\times \\left(1 - \\frac{d_5}{n_5}\\right) = \\frac{147}{256} \\times \\left(1 - \\frac{1}{6}\\right) = \\frac{147}{256} \\times \\frac{5}{6} = \\frac{735}{1536} = \\frac{245}{512}$。\n\n-   **事件时间 $t_{(6)} = 12$**：\n    -   事件数 $d_6 = 1$（患者 $9$）。\n    -   风险集 $R(12) = \\{i: L_i  12 \\text{ and } T_i \\ge 12\\}$。成员为患者 $8, 9, 10, 11, 12$。\n    -   风险人数 $n_6 = 5$。\n    -   $\\hat{S}(12) = \\hat{S}(10) \\times \\left(1 - \\frac{d_6}{n_6}\\right) = \\frac{245}{512} \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{245}{512} \\times \\frac{4}{5} = \\frac{980}{2560} = \\frac{49}{128}$。\n\n-   **事件时间 $t_{(7)} = 14$**：\n    -   事件数 $d_7 = 1$（患者 $10$）。\n    -   风险集 $R(14) = \\{i: L_i  14 \\text{ and } T_i \\ge 14\\}$。成员为患者 $10, 11, 12$。\n    -   风险人数 $n_7 = 3$。\n    -   $\\hat{S}(14) = \\hat{S}(12) \\times \\left(1 - \\frac{d_7}{n_7}\\right) = \\frac{49}{128} \\times \\left(1 - \\frac{1}{3}\\right) = \\frac{49}{128} \\times \\frac{2}{3} = \\frac{98}{384} = \\frac{49}{192}$。\n\n问题要求计算 $\\hat{S}(14)$ 的值。根据右连续约定，$\\hat{S}(14)$ 是生存函数在 $t=14$ 处发生跳跃后的值。我们的计算得出了这个值。\n最终值为 $\\hat{S}(14) = \\frac{49}{192}$。", "answer": "$$\\boxed{\\frac{49}{192}}$$", "id": "4985824"}, {"introduction": "如果没有对其不确定性进行度量，生存函数的点估计是不完整的。这个问题 [@problem_id:4985817] 将引导您完成构建置信区间的关键任务，并说明为什么朴素的方法在参数空间边界（0 或 1）附近会失效。您将应用基于变换的方法，例如 logit 和 log-log 变换，来生成在统计上更稳健、并能遵守概率自然约束的区间。", "problem": "一项基于医院的队列研究跟踪了 $n$ 名患者，以评估事件发生时间结局，并在右删失情况下分析预定时间点的生存率。假设非信息性独立删失成立。令 $\\{\\tau_j: j=1,\\dots,6\\}$ 表示六个不同的有序事件时间点，每个 $\\tau_j$ 处的风险集大小为 $n_j$，事件数为 $d_j$。Kaplan–Meier 估计量 $\\hat S(t)$ 及其 Greenwood 方差 $\\widehat{\\mathrm{Var}}(\\hat S(t))$ 是生存分析中经过充分检验的标准工具。考虑在六个不同事件时间点凭经验观察到的风险集和事件计数摘要如下：\n- 在 $\\tau_1$ 时：$n_1=50$， $d_1=1$。\n- 在 $\\tau_2$ 时：$n_2=49$， $d_2=1$。\n- 在 $\\tau_3$ 时：$n_3=48$， $d_3=10$。\n- 在 $\\tau_4$ 时：$n_4=38$， $d_4=10$。\n- 在 $\\tau_5$ 时：$n_5=28$， $d_5=20$。\n- 在 $\\tau_6$ 时：$n_6=8$， $d_6=6$。\n\n使用这些数据，针对 $t=\\tau_2$（生存率较高的早期时间点）和 $t=\\tau_6$（生存率较低的晚期时间点）的生存概率，在显著性水平 $\\alpha=0.05$ 下完成以下任务：\n1. 从第一性原理出发，通过生存步骤的乘积构建在 $t=\\tau_2$ 和 $t=\\tau_6$ 时的 Kaplan–Meier 估计量 $\\hat S(t)$，并计算每个时间点的 Greenwood 方差估计 $\\widehat{\\mathrm{Var}}(\\hat S(t))$。使用这些结果构建生存率尺度上的朴素 $95\\%$ Wald 区间：$\\hat S(t) \\pm z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat S(t))}$。说明每个区间是否违反了参数空间 $[0,1]$。\n2. 应用 delta 方法构建尊重参数空间的基于变换的 $95\\%$ 区间：\n   - Logit 变换：$g(S)=\\log\\!\\left(\\dfrac{S}{1-S}\\right)$。计算 $g'(\\hat S)$，获得 $g(S)$ 的近似 Wald 区间，并反变换回生存率尺度。\n   - 对数-负对数变换：$g(S)=\\log(-\\log S)$，这映射到累积风险尺度 $H(t)=-\\log S(t)$。计算 $g'(\\hat S)$，获得 $g(S)$ 的近似 Wald 区间，并使用 $S=\\exp(-\\exp(g))$ 进行反变换。\n   对于每个时间点，报告所得区间并验证它们是否包含在 $[0,1]$ 内。\n3. 根据您的计算和推理，选择正确的选项：\n\nA. 为 $\\hat S(t)$ 构建的朴素 Wald 置信区间 $\\hat S(t) \\pm z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat S(t))}$ 在 $\\hat S(t)$ 接近 $0$ 或 $1$ 时可能会超出 $[0,1]$；而通过 logit 或对数-负对数变换、使用 delta 方法和反变换得到的基于变换的区间则会包含在 $[0,1]$ 内。\n\nB. 对数-负对数变换在反变换回原始生存率尺度后，产生的区间围绕 $\\hat S(t)$ 对称，从而确保了等宽的界限。\n\nC. 在独立删失下，Greenwood 公式对于 $\\widehat{\\mathrm{Var}}(\\hat S(t))$ 是合适的；将其与用于单调变换的 delta 方法相结合，是构建尊重参数空间 $[0,1]$ 的近似置信区间的原则性方法。\n\nD. 反正弦平方根变换 $g(S)=\\arcsin(\\sqrt{S})$ 为右删失生存数据提供了精确的置信区间，且无需方差估计，因此基于变换的 Wald 区间是不必要的。\n\nE. 当 $\\hat S(t)$ 接近边界时，将朴素 Wald 区间截断至 $[0,1]$ 可以保持其名义覆盖率，因此不需要变换。\n\n选择所有正确的选项。", "solution": "用户要求对一个生存数据问题进行详细分析，包括计算置信区间和评估理论陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n问题为一项生存研究提供了以下信息：\n- 六个不同的有序事件时间：$\\{\\tau_j: j=1,\\dots,6\\}$。\n- 每个事件时间 $\\tau_j$ 处的风险人数 ($n_j$) 和事件数 ($d_j$)：\n  - 在 $\\tau_1$ 时：$n_1=50$，$d_1=1$。\n  - 在 $\\tau_2$ 时：$n_2=49$，$d_2=1$。\n  - 在 $\\tau_3$ 时：$n_3=48$，$d_3=10$。\n  - 在 $\\tau_4$ 时：$n_4=38$，$d_4=10$。\n  - 在 $\\tau_5$ 时：$n_5=28$，$d_5=20$。\n  - 在 $\\tau_6$ 时：$n_6=8$，$d_6=6$。\n- 假设：非信息性独立右删失。\n- 工具：Kaplan–Meier (KM) 估计量 $\\hat S(t)$ 和 Greenwood 方差公式 $\\widehat{\\mathrm{Var}}(\\hat S(t))$。\n- 显著性水平：$\\alpha=0.05$，对应于标准正态分位数 $z_{1-\\alpha/2} = z_{0.975} \\approx 1.96$。\n- 任务：\n  1. 计算 $t=\\tau_2$ 和 $t=\\tau_6$ 时的 $\\hat S(t)$、$\\widehat{\\mathrm{Var}}(\\hat S(t))$ 和朴素 $95\\%$ Wald 区间。\n  2. 使用 logit 和对数-负对数变换计算 $t=\\tau_2$ 和 $t=\\tau_6$ 时的 $95\\%$ 区间。\n  3. 评估五个陈述 (A-E) 的正确性。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上植根于生存分析的标准理论。Kaplan-Meier 估计量、Greenwood 公式以及基于变换的置信区间都是公认的统计方法。\n\n让我们检查所提供数据的一致性。下一个事件时间点的风险人数 $n_{j+1}$ 与当前事件时间点的风险人数 $n_j$ 相关，关系为 $n_{j+1} = n_j - d_j - c_j$，其中 $c_j$ 是在区间 $[\\tau_j, \\tau_{j+1})$ 内被删失的个体数量。\n- $n_2 = n_1 - d_1 - c_1 \\implies 49 = 50 - 1 - c_1 \\implies c_1 = 0$。\n- $n_3 = n_2 - d_2 - c_2 \\implies 48 = 49 - 1 - c_2 \\implies c_2 = 0$。\n- $n_4 = n_3 - d_3 - c_3 \\implies 38 = 48 - 10 - c_3 \\implies c_3 = 0$。\n- $n_5 = n_4 - d_4 - c_4 \\implies 28 = 38 - 10 - c_4 \\implies c_4 = 0$。\n- $n_6 = n_5 - d_5 - c_5 \\implies 8 = 28 - 20 - c_5 \\implies c_5 = 0$。\n\n数据表明在事件时间 $\\tau_1$ 和 $\\tau_6$ 之间没有删失观测值。这是右删失一般模型下的一个特定但有效的情景（即，删失可能发生，但在这些区间内没有发生）。问题假设非信息性独立删失，这是这些方法有效性的标准假设。问题陈述清晰、客观且完整。未检测到任何缺陷。\n\n**步骤 3：结论和行动**\n问题陈述有效。我将继续进行解答。\n\n### 推导与计算\n\n生存函数 $S(t)$ 的 Kaplan-Meier 估计量由下式给出：\n$$ \\hat S(t) = \\prod_{j: \\tau_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right) $$\n估计量的 Greenwood 方差公式为：\n$$ \\widehat{\\mathrm{Var}}(\\hat S(t)) = [\\hat S(t)]^2 \\sum_{j: \\tau_j \\le t} \\frac{d_j}{n_j(n_j - d_j)} $$\n在事件时间点之间无删失的特殊情况下，我们有 $n_{j+1} = n_j - d_j$。这使得计算得以简化。KM 估计量变为：\n$$ \\hat S(\\tau_k) = \\prod_{j=1}^k \\frac{n_j - d_j}{n_j} = \\prod_{j=1}^k \\frac{n_{j+1}}{n_j} = \\frac{n_2}{n_1}\\frac{n_3}{n_2}\\dots\\frac{n_{k+1}}{n_k} = \\frac{n_{k+1}}{n_1} $$\n这可以进一步简化为 $\\frac{\\text{在 } \\tau_k^+ \\text{ 时的存活人数}}{\\text{初始样本量}}$。方差求和项变成一个裂项级数：\n$$ \\sum_{j=1}^k \\frac{d_j}{n_j(n_j-d_j)} = \\sum_{j=1}^k \\frac{n_j - n_{j+1}}{n_j n_{j+1}} = \\sum_{j=1}^k \\left(\\frac{1}{n_{j+1}} - \\frac{1}{n_j}\\right) = \\frac{1}{n_{k+1}} - \\frac{1}{n_1} $$\n这使得问题等同于分析一个二项比例，其中 $\\hat S(\\tau_k) = \\hat p = N_{surv}/N_{total}$，其方差为 $\\frac{\\hat p(1-\\hat p)}{N_{total}}$。在无删失的情况下，Greenwood 公式正确地简化为此形式。\n\n**1. 对 $t=\\tau_2$ 的计算**\n- **KM 估计**：$\\hat S(\\tau_2) = \\left(1 - \\frac{d_1}{n_1}\\right) \\left(1 - \\frac{d_2}{n_2}\\right) = \\left(1 - \\frac{1}{50}\\right) \\left(1 - \\frac{1}{49}\\right) = \\frac{49}{50} \\times \\frac{48}{49} = \\frac{48}{50} = 0.96$。\n- **方差**：\n$$ \\widehat{\\mathrm{Var}}(\\hat S(\\tau_2)) = [\\hat S(\\tau_2)]^2 \\left( \\frac{d_1}{n_1(n_1 - d_1)} + \\frac{d_2}{n_2(n_2 - d_2)} \\right) \\\\ = (0.96)^2 \\left( \\frac{1}{50(49)} + \\frac{1}{49(48)} \\right) = (0.9216) \\left( \\frac{1}{2450} + \\frac{1}{2352} \\right) = (0.9216)(0.0008333...) = 0.000768 $$\n- **标准误 (SE)**：$\\sqrt{0.000768} \\approx 0.02771$。\n- **朴素 $95\\%$ Wald 区间**：$\\hat S(\\tau_2) \\pm z_{0.975} \\times \\mathrm{SE}(\\hat S(\\tau_2)) = 0.96 \\pm 1.96 \\times 0.02771 = 0.96 \\pm 0.05431$。\n  这给出的区间是 $[0.90569, 1.01431]$。上界大于 $1$，因此该区间**违反了参数空间 $[0,1]$**。\n\n**2. 对 $t=\\tau_6$ 的计算**\n- **KM 估计**：\n$$ \\hat S(\\tau_6) = \\prod_{j=1}^6 \\left(1 - \\frac{d_j}{n_j}\\right) = \\frac{49}{50}\\frac{48}{49}\\frac{38}{48}\\frac{28}{38}\\frac{8}{28}\\frac{2}{8} = \\frac{2}{50} = 0.04 $$\n正如裂项乘积所确立的，$\\hat S(\\tau_6) = \\frac{n_6-d_6}{n_1} = \\frac{8-6}{50} = \\frac{2}{50} = 0.04$。\n- **方差**：\n$$ \\widehat{\\mathrm{Var}}(\\hat S(\\tau_6)) = [\\hat S(\\tau_6)]^2 \\sum_{j=1}^6 \\frac{d_j}{n_j(n_j-d_j)} $$\n求和项为 $\\frac{1}{n_6-d_6} - \\frac{1}{n_1} = \\frac{1}{2} - \\frac{1}{50} = 0.5 - 0.02 = 0.48$。\n$$ \\widehat{\\mathrm{Var}}(\\hat S(\\tau_6)) = (0.04)^2 \\times 0.48 = 0.0016 \\times 0.48 = 0.000768 $$\n- **标准误 (SE)**：$\\sqrt{0.000768} \\approx 0.02771$。\n- **朴素 $95\\%$ Wald 区间**：$\\hat S(\\tau_6) \\pm z_{0.975} \\times \\mathrm{SE}(\\hat S(\\tau_6)) = 0.04 \\pm 1.96 \\times 0.02771 = 0.04 \\pm 0.05431$。\n  这给出的区间是 $[-0.01431, 0.09431]$。下界小于 $0$，因此该区间**违反了参数空间 $[0,1]$**。\n\n**3. 基于变换的区间**\n一般方法包括用函数 $g$ 变换 $\\hat S(t)$，在变换后的尺度上构建 Wald 区间，然后将区间端点反变换回来。\n$$ \\widehat{\\mathrm{Var}}(g(\\hat S)) \\approx [g'(\\hat S)]^2 \\widehat{\\mathrm{Var}}(\\hat S) $$\n\n**Logit 变换**：$g(S) = \\log\\left(\\frac{S}{1-S}\\right)$，$g'(S) = \\frac{1}{S(1-S)}$。反变换：$S = \\frac{e^g}{1+e^g}$。\n- 对于 $t=\\tau_2$（$\\hat S = 0.96$）：\n  $g(0.96) = \\log(24) \\approx 3.178$。\n  $\\widehat{\\mathrm{Var}}(g(\\hat S)) \\approx \\left(\\frac{1}{0.96(0.04)}\\right)^2 (0.000768) \\approx 0.52083$。标准误 $\\approx 0.7217$。\n  $g(S)$ 的 $95\\%$ 置信区间：$3.178 \\pm 1.96(0.7217) = 3.178 \\pm 1.4145 = [1.7635, 4.5925]$。\n  $S(\\tau_2)$ 的反变换置信区间：$[\\frac{e^{1.7635}}{1+e^{1.7635}}, \\frac{e^{4.5925}}{1+e^{4.5925}}] \\approx [0.8536, 0.9899]$。该区间在 $[0,1]$ 内。\n- 对于 $t=\\tau_6$（$\\hat S = 0.04$）：\n  $g(0.04) = \\log(1/24) \\approx -3.178$。\n  $\\widehat{\\mathrm{Var}}(g(\\hat S)) \\approx \\left(\\frac{1}{0.04(0.96)}\\right)^2 (0.000768) \\approx 0.52083$。标准误 $\\approx 0.7217$。\n  $g(S)$ 的 $95\\%$ 置信区间：$-3.178 \\pm 1.4145 = [-4.5925, -1.7635]$。\n  $S(\\tau_6)$ 的反变换置信区间：$[\\frac{e^{-4.5925}}{1+e^{-4.5925}}, \\frac{e^{-1.7635}}{1+e^{-1.7635}}] \\approx [0.0100, 0.1463]$。该区间在 $[0,1]$ 内。\n\n**对数-负对数变换**：$g(S) = \\log(-\\log S)$，$g'(S) = \\frac{1}{S \\log S}$。反变换：$S = \\exp(-\\exp(g))$。\n- 对于 $t=\\tau_2$（$\\hat S = 0.96$）：\n  $g(0.96) = \\log(-\\log 0.96) \\approx -3.1986$。\n  $\\widehat{\\mathrm{Var}}(g(\\hat S)) \\approx \\left(\\frac{1}{0.96 \\log 0.96}\\right)^2 (0.000768) \\approx 0.5$。标准误 $\\approx 0.7071$。\n  $g(S)$ 的 $95\\%$ 置信区间：$-3.1986 \\pm 1.96(0.7071) = -3.1986 \\pm 1.386 = [-4.5846, -1.8126]$。\n  $S(\\tau_2)$ 的反变换置信区间：$[\\exp(-\\exp(-1.8126)), \\exp(-\\exp(-4.5846))] \\approx [0.8494, 0.9898]$。该区间在 $[0,1]$ 内。\n- 对于 $t=\\tau_6$（$\\hat S = 0.04$）：\n  $g(0.04) = \\log(-\\log 0.04) \\approx 1.169$。\n  $\\widehat{\\mathrm{Var}}(g(\\hat S)) \\approx \\left(\\frac{1}{0.04 \\log 0.04}\\right)^2 (0.000768) \\approx 0.04632$。标准误 $\\approx 0.2152$。\n  $g(S)$ 的 $95\\%$ 置信区间：$1.169 \\pm 1.96(0.2152) = 1.169 \\pm 0.4218 = [0.7472, 1.5908]$。\n  $S(\\tau_6)$ 的反变换置信区间：$[\\exp(-\\exp(1.5908)), \\exp(-\\exp(0.7472))] \\approx [0.0074, 0.1211]$。该区间在 $[0,1]$ 内。\n\n### 逐项分析\n\n**A. 为 $\\hat S(t)$ 构建的朴素 Wald 置信区间 $\\hat S(t) \\pm z_{1-\\alpha/2}\\sqrt{\\widehat{\\mathrm{Var}}(\\hat S(t))}$ 在 $\\hat S(t)$ 接近 $0$ 或 $1$ 时可能会超出 $[0,1]$；而通过 logit 或对数-负对数变换、使用 delta 方法和反变换得到的基于变换的区间则会包含在 $[0,1]$ 内。**\n我们的计算证实了这一说法。对于 $\\hat S(\\tau_2)=0.96$ 的朴素 Wald 区间超过了 $1$，而对于 $\\hat S(\\tau_6)=0.04$ 的区间则低于 $0$。Logit 和对数-负对数变换都将参数空间 $(0,1)$ 映射到 $(-\\infty, \\infty)$。在变换后的尺度上构建的任何有限置信区间，在反变换后都将被限制在 $(0,1)$ 内，从而尊重了参数空间。这是使用此类变换的一个基本动机。\n**结论：正确。**\n\n**B. 对数-负对数变换在反变换回原始生存率尺度后，产生的区间围绕 $\\hat S(t)$ 对称，从而确保了等宽的界限。**\n在变换尺度上构建的置信区间在该尺度上是对称的。反变换 $S = \\exp(-\\exp(g))$ 是高度非线性的。因此，在原始生存率尺度 $S$ 上得到的区间将不会围绕点估计 $\\hat S(t)$ 对称。例如，对于 $t=\\tau_6$，我们有 $\\hat S(\\tau_6)=0.04$，区间为 $[0.0074, 0.1211]$。到下界的距离是 $0.04 - 0.0074 = 0.0326$，而到上界的距离是 $0.1211 - 0.04 = 0.0811$。这两者不相等。这种不对称性实际上是一个理想的特性，可以防止违反边界。\n**结论：错误。**\n\n**C. 在独立删失下，Greenwood 公式对于 $\\widehat{\\mathrm{Var}}(\\hat S(t))$ 是合适的；将其与用于单调变换的 delta 方法相结合，是构建尊重参数空间 $[0,1]$ 的近似置信区间的原则性方法。**\n该陈述准确地描述了标准的统计实践。在非信息性独立删失下，Greenwood 公式是 $\\hat S(t)$ 的标准大样本方差估计量。Delta 方法是推导变换后估计量方差的基本工具。使用像 logit 或对数-负对数这样的单调变换，将 $(0,1)$ 映射到 $(-\\infty, \\infty)$，是一种确保所得置信区间位于有效参数空间内的原则性技术。整个陈述是对统计理论的合理总结。\n**结论：正确。**\n\n**D. 反正弦平方根变换 $g(S)=\\arcsin(\\sqrt{S})$ 为右删失生存数据提供了精确的置信区间，且无需方差估计，因此基于变换的 Wald 区间是不必要的。**\n这个陈述在多个方面都是不正确的。首先，没有简单的变换能为 Kaplan-Meier 估计提供“精确”的置信区间；所有区间都基于大样本近似。其次，虽然反正弦平方根变换被用作一种方差稳定变换，但用它构建置信区间仍然需要 delta 方法，而这又需要一个 $\\widehat{\\mathrm{Var}}(\\hat S(t))$ 的估计（如 Greenwood 公式）来计算变换尺度上的方差。声称它“无需方差估计”是错误的。\n**结论：错误。**\n\n**E. 当 $\\hat S(t)$ 接近边界时，将朴素 Wald 区间截断至 $[0,1]$ 可以保持其名义覆盖率，因此不需要变换。**\n截断一个朴素的 Wald 区间（例如，将 $[-0.014, 0.094]$ 改为 $[0, 0.094]$）是一种临时的修复方法，其统计特性很差。朴素区间失效的原因是，当真实的 $S(t)$ 接近边界时，对 $\\hat S(t)$ 使用对称的正态近似是不合适的。简单地砍掉区间超出范围的部分并不能纠正潜在的分布设定错误。众所周知，这种程序会导致置信区间的实际覆盖概率远低于名义水平（例如，低于 $95\\%$）。因此，声称它“保持其名义覆盖率”是错误的。\n**结论：错误。**", "answer": "$$\\boxed{AC}$$", "id": "4985817"}, {"introduction": "Kaplan-Meier 估计量的有效性取决于独立删失的假设。这个思想实验 [@problem_id:4985911] 旨在让您对违反此假设时会发生什么有一个深刻、直观的理解。通过分析一个删失与预后相关的假设情景，您将量化由此产生的偏差，并体会到在任何生存分析中评估这一核心假设的至关重要性。", "problem": "考虑一项医学领域的生存研究，其中存在一个潜在的严重性类别 $S \\in \\{L,H\\}$，$L$ 代表较低严重性，$H$ 代表较高严重性。类别 $S$ 未被观测到。设群体比例为 $\\mathbb{P}(S=L)=0.7$ 和 $\\mathbb{P}(S=H)=0.3$。定义事件时间为 $T$，删失时间为 $C$。观测时间为 $Y=\\min\\{T,C\\}$，事件指示符为 $\\delta=\\mathbf{1}\\{T \\leq C\\}$。\n\n假设存在以下科学上合理的数据生成机制，该机制导致了相依删失：\n- 对于较低严重性组（$S=L$），事件时间满足 $\\mathbb{P}(T6 \\text{ months} \\mid S=L)=1$，且在 6 个月前没有删失发生，即 $\\mathbb{P}(C6 \\text{ months} \\mid S=L)=1$。\n- 对于较高严重性组（$S=H$），事件时间是连续的，且支撑区间为 $[5 \\text{ months}, 6 \\text{ months}]$（例如，一个集中在该窗口的单峰密度函数），因此 $\\mathbb{P}(T6 \\text{ months} \\mid S=H)=0$。删失时间是确定性的，发生在 $C=5 \\text{ months}$，因此 $\\mathbb{P}(C=5 \\text{ months} \\mid S=H)=1$。\n\n这种构造确保了对于较高严重性的受试者，$C", "solution": "该问题陈述是生存分析领域一个有效且适定的理论问题。它描述了一个相依删失的场景，并要求量化 Kaplan-Meier 估计量由此产生的偏差。所有必要信息都已提供，并且该设定虽然是为教学目的而构建的，但在科学上和数学上都是合理的。\n\n目标是计算 Kaplan-Meier (KM) 估计量在 $t=6$ 个月时的偏差，其定义为：\n$$\n\\text{Bias}(6) = \\widehat{S}_{\\text{KM}}(6) - S(6)\n$$\n其中 $\\widehat{S}_{\\text{KM}}(6)$ 是 KM 估计量的大样本极限，$S(6)$ 是在 $t=6$ 个月时的真实边际生存概率。我们将分别计算这两个量。\n\n首先，我们计算真实的边际生存概率 $S(6) = \\mathbb{P}(T > 6)$。我们使用全概率定律，以未观测到的严重性类别 $S$ 为条件：\n$$\nS(6) = \\mathbb{P}(T > 6) = \\mathbb{P}(T > 6 \\mid S=L)\\mathbb{P}(S=L) + \\mathbb{P}(T > 6 \\mid S=H)\\mathbb{P}(S=H)\n$$\n问题提供了以下数值：\n- 群体比例：$\\mathbb{P}(S=L) = 0.7$ 和 $\\mathbb{P}(S=H) = 0.3$。\n- 较低严重性类别的条件生存率：$\\mathbb{P}(T > 6 \\text{ months} \\mid S=L) = 1$。\n- 较高严重性类别的条件生存率：$\\mathbbP(T > 6 \\text{ months} \\mid S=H) = 0$，因为他们的事件时间位于区间 $[5, 6]$。\n\n将这些值代入公式：\n$$\nS(6) = (1)(0.7) + (0)(0.3) = 0.7 + 0 = 0.7\n$$\n因此，生存超过 6 个月的真实群体比例为 $70\\%$。\n\n接下来，我们确定 Kaplan-Meier 估计量的大样本极限 $\\widehat{S}_{\\text{KM}}(6)$。生存函数 $S(t)$ 的 Kaplan-Meier 估计量由乘积-极限公式给出：\n$$\n\\widehat{S}_{\\text{KM}}(t) = \\prod_{j: t_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right)\n$$\n其中 $t_j$ 是观测到的不同事件时间，$d_j$ 是在时间 $t_j$ 发生的事件数，$n_j$ 是在时间 $t_j$ 之前处于风险中的个体数量。该估计量是一个阶梯函数，仅在观测到事件时下降。\n\n为了找到大样本极限，我们分析每个严重性类别的观测数据 $(Y, \\delta)$ 的性质。\n- 对于较低严重性类别（$S=L$）：事件发生在 $T > 6$，删失发生在 $C > 6$。因此，这些受试者的观测时间为 $Y = \\min\\{T,C\\} > 6$。在 $t=6$ 或之前，该组没有观测到事件或删失。在一个大小为 $N$ 的大样本中，$0.7N$ 的受试者属于该组，并在整个区间 $[0, 6]$ 内保持在风险集中。\n\n- 对于较高严重性类别（$S=H$）：事件发生在 $T \\in [5, 6]$。删失是确定性的，发生在 $C = 5$。观测时间为 $Y = \\min\\{T, 5\\}$。由于 $T$ 是一个支撑区间为 $[5, 6]$ 的连续分布，我们有 $\\mathbb{P}(T > 5) = 1$。由此可知，对于整个组，几乎必然有 $C  T$。观测数据为：\n- 观测时间：$Y = \\min\\{T, 5\\} = 5$。\n- 事件指示符：$\\delta = \\mathbf{1}\\{T \\le C\\} = \\mathbf{1}\\{T \\le 5\\} = 0$。\n因此，所有较高严重性组的受试者（占群体的 $0.3$）都被观测到在 $t=5$ 个月时被删失。该组没有记录到任何事件。\n\n综合整个群体的观测结果，我们看到在任何时间 $t \\le 6$ 都没有事件发生（即 $\\delta=1$ 的观测）。区间 $[0, 6]$ 内的不同事件时间集合 $\\{t_j\\}$ 是空的。\nKaplan-Meier 估计量是关于观测到的事件时间的乘积。由于没有事件时间 $t_j \\le 6$，该乘积是基于一个空集的。根据惯例，空乘积等于乘法单位元，即 $1$。\n因此，对于任何时间 $t \\le 6$，估计量为：\n$$\n\\widehat{S}_{\\text{KM}}(t) = \\prod_{j: t_j \\le t, \\text{ an empty set}} \\left(1 - \\frac{d_j}{n_j}\\right) = 1\n$$\n这对任何样本大小都成立，因此大样本极限为 $\\widehat{S}_{\\text{KM}}(6) = 1$。\n\n真实生存率与 KM 估计值之间的差异源于相依删失。Kaplan-Meier 估计量仅在独立删失的假设下才是一致的（即其大样本极限等于真实值）。该假设意味着，在任何给定时间，被删失的个体与仍在风险集中的个体具有相同的未来失败风险。在本问题中，此假设被违反。在 $t=5$ 个月时，被删失的个体恰好是高风险组（$S=H$）中的个体。$t=5$ 个月后仍在风险集中的个体完全来自低风险组（$S=L$），对他们而言，近期失败的概率为零。KM 估计量忽略了这种相依性，在 $t=5$ 个月后没有观测到任何失败事件，因此错误地得出结论，认为生存概率为 $100\\%$。\n\n最后，我们计算在 $t=6$ 个月时的偏差：\n$$\n\\text{Bias}(6) = \\widehat{S}_{\\text{KM}}(6) - S(6) = 1 - 0.7 = 0.3\n$$\n偏差为正，表明由于高风险受试者的信息性删失，KM 估计量高估了真实的生存概率。", "answer": "$$\n\\boxed{0.3}\n$$", "id": "4985911"}]}