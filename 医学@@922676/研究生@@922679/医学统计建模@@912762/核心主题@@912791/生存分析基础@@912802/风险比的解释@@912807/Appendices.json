{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是动手实践。本章节将通过一系列精心设计的练习，帮助你从计算走向解读，真正掌握风险比（Hazard Ratio, $HR$）的内涵。第一个练习将带你完成最核心的一步：从Cox比例风险模型的结果中计算风险比，并准确阐述其作为瞬时风险乘数效应的临床意义。这是将统计模型输出转化为临床洞察力的基础。[@problem_id:4968285]", "problem": "一项随机对照试验（RCT）评估了一种新型抗心律失常药物与标准治疗相比在预防室性快速性心律失常方面的效果。设$T$表示从随机化到首次经裁定的室性快速性心律失常事件发生的时间。研究人员拟合了一个Cox比例风险模型，其风险函数为$h(t \\mid \\mathbf{X}) = h_{0}(t) \\exp\\!\\big(\\mathbf{X}^{\\top}\\boldsymbol{\\beta}\\big)$，其中$\\mathbf{X}$包含一个二元治疗指示变量$X_{\\text{trt}}$（取值为$0$（对照组）或$1$（药物组））以及年龄和性别。估计的治疗系数为$\\hat{\\beta}_{\\text{trt}} = 0.7$。从风险函数的定义（即在时间$t$尚无事件发生的情况下，事件发生的瞬时条件速率）出发，并利用所拟合模型的乘法结构，推导在相同年龄和性别条件下比较$X_{\\text{trt}}=1$与$X_{\\text{trt}}=0$的风险比的表达式。然后，使用$\\hat{\\beta}_{\\text{trt}}$计算其数值，并在比例风险假设下，将其作为一个瞬时乘法效应从临床角度进行解释。将您的数值答案四舍五入到$4$位有效数字。最终的风险比应表示为一个无单位的纯数。", "solution": "该问题要求从Cox比例风险模型中推导风险比（HR）的表达式，进行数值计算，并给出其临床解释。\n\n首先，我们建立理论基础。风险函数$h(t \\mid \\mathbf{X})$表示对于一个具有协变量向量$\\mathbf{X}$的个体，在直到时间$t$都未经历事件的条件下，在时间$t$发生事件的瞬时速率。Cox比例风险模型将此函数定义为：\n$$h(t \\mid \\mathbf{X}) = h_{0}(t) \\exp(\\mathbf{X}^{\\top}\\boldsymbol{\\beta})$$\n在此模型中，$h_{0}(t)$是基线风险函数，它是一个关于时间的非负函数，而$\\boldsymbol{\\beta}$是回归系数的向量。项$\\exp(\\mathbf{X}^{\\top}\\boldsymbol{\\beta})$作为基线风险的一个乘法标量。\n\n问题指出，协变量向量$\\mathbf{X}$包括一个二元治疗指示变量$X_{\\text{trt}}$（其中$X_{\\text{trt}} = 1$代表新药，$X_{\\text{trt}} = 0$代表标准治疗），以及年龄和性别的协变量。我们用$\\mathbf{Z}$表示年龄和性别的协变量子向量，其对应的系数为$\\boldsymbol{\\beta}_{\\mathbf{Z}}$。线性预测项$\\mathbf{X}^{\\top}\\boldsymbol{\\beta}$可以展开为：\n$$\\mathbf{X}^{\\top}\\boldsymbol{\\beta} = X_{\\text{trt}}\\beta_{\\text{trt}} + \\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}}$$\n其中$\\beta_{\\text{trt}}$是与治疗指示变量相关的系数。\n\n为了推导治疗组与对照组的风险比，我们必须计算它们各自风险函数的比值，同时保持所有其他协变量（由$\\mathbf{Z}$代表的年龄和性别）恒定。\n\n对于治疗组中（$X_{\\text{trt}}=1$）具有协变量$\\mathbf{Z}$的个体，其风险函数为：\n$$h(t \\mid X_{\\text{trt}}=1, \\mathbf{Z}) = h_{0}(t) \\exp(1 \\cdot \\beta_{\\text{trt}} + \\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}})$$\n对于对照组中（$X_{\\text{trt}}=0$）具有相同协变量$\\mathbf{Z}$的可比个体，其风险函数为：\n$$h(t \\mid X_{\\text{trt}}=0, \\mathbf{Z}) = h_{0}(t) \\exp(0 \\cdot \\beta_{\\text{trt}} + \\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}}) = h_{0}(t) \\exp(\\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}})$$\n\n风险比（$HR$）是这两个风险函数的比值：\n$$HR = \\frac{h(t \\mid X_{\\text{trt}}=1, \\mathbf{Z})}{h(t \\mid X_{\\text{trt}}=0, \\mathbf{Z})} = \\frac{h_{0}(t) \\exp(\\beta_{\\text{trt}} + \\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}})}{h_{0}(t) \\exp(\\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}})}$$\n利用恒等式$\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以重写分子：\n$$HR = \\frac{h_{0}(t) \\exp(\\beta_{\\text{trt}}) \\exp(\\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}})}{h_{0}(t) \\exp(\\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}})}$$\n基线风险项$h_{0}(t)$和协变量项$\\exp(\\mathbf{Z}^{\\top}\\boldsymbol{\\beta}_{\\mathbf{Z}})$相互抵消，得到风险比的推导表达式：\n$$HR = \\exp(\\beta_{\\text{trt}})$$\n这个结果展示了Cox模型的一个关键特征：风险比随时间恒定（即“比例风险”假设），并且不依赖于其他协变量的值，只要在比较中这些协变量保持不变。\n\n接下来，我们计算HR的数值。问题给出了治疗效应的估计系数$\\hat{\\beta}_{\\text{trt}} = 0.7$。将此值代入我们推导的表达式，得到估计的风险比$\\widehat{HR}$：\n$$\\widehat{HR} = \\exp(\\hat{\\beta}_{\\text{trt}}) = \\exp(0.7)$$\n计算该值：\n$$\\exp(0.7) \\approx 2.0137527$$\n按要求四舍五入到$4$位有效数字，我们得到：\n$$\\widehat{HR} = 2.014$$\n\n最后，我们提供临床解释。风险比为$2.014$，大于$1$，这表明与$X_{\\text{trt}}=0$的组（对照组）相比，$X_{\\text{trt}}=1$的组（药物组）的风险增加。具体来说，在比例风险假设下，在任何给定的时间点，一名接受新型抗心律失常药物治疗且尚未发生室性快速性心律失常的患者，其发生此事件的瞬时风险是接受标准治疗的患者瞬时风险的$2.014$倍，前提是这两名患者的年龄和性别相同。这意味着新药与有害效应相关，与标准治疗相比，它使心律失常的风险增加了约$101.4\\%$。在整个随访期间，这种乘法效应是恒定的。", "answer": "$$\\boxed{2.014}$$", "id": "4968285"}, {"introduction": "在计算出风险比的点估计值后，我们必须考虑其不确定性。任何研究的估计值都只是真实效应的一个快照，而非绝对真理。这个练习将引导你使用估计的对数风险比及其标准误来构建风险比的置信区间。通过学习如何计算和解读置信区间的上下限，你将能更严谨地评估一项治疗是否具有统计学意义和临床价值。[@problem_id:4968211]", "problem": "在一项比较新型抗高血压疗法与标准治疗的随机临床试验中，使用Cox比例风险模型对达到复合心血管终点事件的时间进行建模。设以二元治疗指标 $X$ 为条件的风险函数为 $h(t \\mid X) = h_{0}(t)\\exp(\\beta X)$，其中 $X=1$ 表示分配至新疗法组，$X=0$ 表示标准治疗组。对数风险系数的最大偏似然估计值为 $\\hat{\\beta}=-0.5$，其估计标准误为 $0.2$。\n\n从模型定义以及估计量在正则性条件下的大样本性质出发，构建一个用于比较 $X=1$ 与 $X=0$ 的风险比的 $95\\%$ 置信区间。然后，用临床术语解释该区间的下限和上限，明确说明在比例风险假设下，它们对瞬时事件发生率意味着什么。将区间的两个界限四舍五入至三位有效数字。最终的数值区间仅用两个数字表示。", "solution": "该问题有效。这是一个生物统计学中标准的、适定的问题，基于已建立的Cox比例风险模型以及最大偏似然估计量的大样本性质。所有必要的数据（$\\hat{\\beta}$、其标准误以及所需的置信水平）均已提供，且该问题具有科学依据且客观。\n\n所提供的Cox比例风险模型为 $h(t \\mid X) = h_{0}(t)\\exp(\\beta X)$，其中 $h(t \\mid X)$ 是具有治疗指标 $X$ 的个体在时间 $t$ 的风险函数，$h_{0}(t)$ 是基准风险函数，而 $\\beta$ 是对数风险比系数。这里，$X=1$ 对应新疗法，$X=0$ 对应标准治疗。\n\n用于比较两组的主要关注参数是风险比（HR）。风险比定义为治疗组（$X=1$）的风险与对照组（$X=0$）的风险之比。\n$$\n\\text{HR} = \\frac{h(t \\mid X=1)}{h(t \\mid X=0)} = \\frac{h_{0}(t)\\exp(\\beta \\cdot 1)}{h_{0}(t)\\exp(\\beta \\cdot 0)} = \\frac{h_{0}(t)\\exp(\\beta)}{h_{0}(t) \\cdot 1} = \\exp(\\beta)\n$$\n比例风险假设意味着这个比值 $\\exp(\\beta)$ 不随时间 $t$ 变化。我们已知对数风险比的最大偏似然估计值为 $\\hat{\\beta}=-0.5$，其标准误为 $SE(\\hat{\\beta})=0.2$。\n\n该问题要求基于估计量的大样本性质构建一个置信区间。在标准的正则性条件下，最大偏似然估计量 $\\hat{\\beta}$ 在真实参数 $\\beta$ 周围呈渐近正态分布，其方差可以用标准误的平方来估计。\n$$\n\\hat{\\beta} \\sim \\mathcal{N}\\left(\\beta, [SE(\\hat{\\beta})]^2\\right)\n$$\n这使我们能够为 $\\beta$ 构建一个置信区间。对数风险比 $\\beta$ 的 $95\\%$ 置信区间由下式给出：\n$$\n\\text{CI}_{95\\%}(\\beta) = \\hat{\\beta} \\pm z_{1-\\alpha/2} \\cdot SE(\\hat{\\beta})\n$$\n对于 $95\\%$ 的置信水平，显著性水平为 $\\alpha=0.05$，因此 $1-\\alpha/2 = 0.975$。来自标准正态分布的临界值为 $z_{0.975} \\approx 1.96$。\n\n代入给定值：\n$$\n\\text{CI}_{95\\%}(\\beta) = -0.5 \\pm 1.96 \\cdot (0.2)\n$$\n$$\n\\text{CI}_{95\\%}(\\beta) = -0.5 \\pm 0.392\n$$\n$\\beta$ 的下限是 $-0.5 - 0.392 = -0.892$。\n$\\beta$ 的上限是 $-0.5 + 0.392 = -0.108$。\n因此，对数风险比的 $95\\%$ 置信区间是 $[-0.892, -0.108]$。\n\n为了找到风险比 $\\text{HR} = \\exp(\\beta)$ 的置信区间，我们对 $\\beta$ 的置信区间的界限取指数。这种变换是有效的，因为指数函数是严格单调递增的。\n$$\n\\text{CI}_{95\\%}(\\text{HR}) = \\left[ \\exp(-0.892), \\exp(-0.108) \\right]\n$$\n现在，我们计算这些界限的数值。\n风险比的下限：$\\exp(-0.892) \\approx 0.409852$\n风险比的上限：$\\exp(-0.108) \\approx 0.897623$\n\n按照要求将这些界限四舍五入到三位有效数字：\n下限 $\\approx 0.410$\n上限 $\\approx 0.898$\n\n风险比的 $95\\%$ 置信区间是 $[0.410, 0.898]$。\n\n在比例风险假设下，这些界限的临床术语解释如下：\n\n下限 ($0.410$)：我们有 $95\\%$ 的把握认为，真实的风险比至少为 $0.410$。该值代表了置信区间内最乐观的可能疗效。它意味着在随访期间的任何时刻，接受新疗法的患者的瞬时事件发生率（风险）可能低至接受标准治疗患者的 $41.0\\%$。这对应的风险降低率高达 $100\\% \\times (1 - 0.410) = 59.0\\%$。\n\n上限 ($0.898$)：我们有 $95\\%$ 的把握认为，真实的风险比不超过 $0.898$。该值代表了置信区间内最不乐观（但仍显示有益）的可能疗效。它意味着在任何时刻，接受新疗法的患者的瞬时事件发生率至多是接受标准治疗患者的 $89.8\\%$。这对应的最小可能风险降低率为 $100\\% \\times (1 - 0.898) = 10.2\\%$。\n\n由于整个 $95\\%$ 置信区间 $[0.410, 0.898]$ 均位于 $1.0$ 以下，因此在 $\\alpha=0.05$ 的水平上，该结果具有统计学显著性，为新疗法在降低复合心血管终点事件风险方面优于标准治疗提供了证据。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.410  0.898 \\end{pmatrix}}\n$$", "id": "4968211"}, {"introduction": "风险比是一个相对指标，这在临床解读中是一个至关重要的概念，也是一个常见的误区来源。最后一个练习将揭示一个关键的细微差别：即使风险比恒定，其在不同基线风险人群中对应的绝对风险降低（Absolute Risk Reduction, $ARR$）也可能大相径庭。通过计算两种不同基线风险情景下的$ARR$，本练习将帮助你理解为什么在评估治疗效果时，必须同时考虑相对效应（如$HR$）和绝对效应（如$ARR$）。[@problem_id:4968251]", "problem": "考虑一项评估某种慢性病预防性疗法的随机临床试验，该试验在比例风险框架下进行分析。设风险比（HR）是作用于基线风险上的一个恒定乘法因子 $\\theta$，因此对于所有 $t \\geq 0$，治疗组的风险为 $\\theta h_{0}(t)$。假设不存在竞争风险；事件时间是连续的，且生存通过累积风险和生存之间的标准关系与风险相关联。\n\n使用以下两个科学上合理且不同的基线风险函数，在 $T = 24$ 个月的固定随访期内进行分析，通过计算证明相同的风险比可以产生显著不同的绝对风险降低值：\n\n- 情景 A（指数基线）：$h_{0A}(t) = \\lambda_{A}$，其中 $\\lambda_{A} = 0.005$ 月$^{-1}$，适用于 $0 \\leq t \\leq T$。\n- 情景 B（形状参数为 $k=2$ 的威布尔基线）：$h_{0B}(t) = 2 \\lambda_{B} t$，适用于 $0 \\leq t \\leq T$，其中 $\\lambda_{B} = \\dfrac{1.6}{T^{2}}$，选择该值是为了在对照组中，到时间 $T$ 时产生 $1.6$ 的累积风险。\n\n设风险比为 $\\theta = 0.6$（治疗组与对照组）。仅使用风险、累积风险和生存函数的核心定义，推导在每种情景下，对照组和治疗组在时间 $T$ 时的绝对风险，然后分别计算情景 A 和情景 B 的绝对风险降低值 $\\text{ARR} = F_{\\text{control}}(T) - F_{\\text{treatment}}(T)$。最后，计算差值 $\\Delta = \\text{ARR}_{B} - \\text{ARR}_{A}$。\n\n将最终的 $\\Delta$ 表示为小数形式，并将答案四舍五入到四位有效数字。", "solution": "该问题具有科学依据，提法明确，并包含得出唯一解所需的所有信息。我们首先建立生存分析中的基本关系。\n\n生存函数 $S(t)$ 是指存活超过时间 t 的概率，它通过累积风险函数 $H(t)$ 与风险函数 $h(t)$ 相关联。累积风险是风险函数从时间 0 到 t 的积分：\n$$H(t) = \\int_{0}^{t} h(u) \\, du$$\n生存函数则由下式给出：\n$$S(t) = \\exp(-H(t))$$\n绝对风险，也称为累积发生率函数 $F(t)$，是指到时间 t 时发生事件的概率。它是生存函数的补集：\n$$F(t) = 1 - S(t) = 1 - \\exp(-H(t))$$\n该问题在比例风险模型下进行操作，其中治疗组的风险函数 $h_{\\text{treatment}}(t)$ 是对照组基线风险函数 $h_{0}(t)$ 的一个恒定倍数 $\\theta$：\n$$h_{\\text{treatment}}(t) = \\theta h_{0}(t)$$\n这种比例关系同样适用于累积风险函数：\n$$H_{\\text{treatment}}(t) = \\int_{0}^{t} \\theta h_{0}(u) \\, du = \\theta \\int_{0}^{t} h_{0}(u) \\, du = \\theta H_{0}(t)$$\n在特定时间 $T$ 的绝对风险降低值（ARR）是对照组中的绝对风险与治疗组中的绝对风险之差：\n$$\\text{ARR}(T) = F_{\\text{control}}(T) - F_{\\text{treatment}}(T)$$\n代入风险的表达式，我们得到：\n$$\\text{ARR}(T) = [1 - S_{\\text{control}}(T)] - [1 - S_{\\text{treatment}}(T)] = S_{\\text{treatment}}(T) - S_{\\text{control}}(T)$$\n使用以累积风险表示的生存函数定义：\n$$\\text{ARR}(T) = \\exp(-H_{\\text{treatment}}(T)) - \\exp(-H_{\\text{control}}(T))$$\n最后，利用比例风险关系 $H_{\\text{treatment}}(T) = \\theta H_{0}(T)$，我们得出了 ARR 的通用公式：\n$$\\text{ARR}(T) = \\exp(-\\theta H_{0}(T)) - \\exp(-H_{0}(T))$$\n现在，我们将此框架应用于随访期为 $T=24$ 个月、风险比为 $\\theta = 0.6$ 的两个指定情景。\n\n情景 A：指数基线风险\n基线风险函数是恒定的：$h_{0A}(t) = \\lambda_{A}$，其中 $\\lambda_{A} = 0.005$ 月$^{-1}$。\n首先，我们计算在时间 $T$ 时的累积基线风险：\n$$H_{0A}(T) = \\int_{0}^{T} \\lambda_{A} \\, dt = \\lambda_{A} T$$\n代入给定值：\n$$H_{0A}(24) = (0.005) \\times 24 = 0.12$$\n情景 A 的绝对风险降低值 $\\text{ARR}_{A}$ 为：\n$$\\text{ARR}_{A} = \\exp(-\\theta H_{0A}(T)) - \\exp(-H_{0A}(T)) = \\exp(-(0.6)(0.12)) - \\exp(-0.12)$$\n$$\\text{ARR}_{A} = \\exp(-0.072) - \\exp(-0.12)$$\n数值上，$\\exp(-0.072) \\approx 0.9305333$ 且 $\\exp(-0.12) \\approx 0.8869204$。\n$$\\text{ARR}_{A} \\approx 0.9305333 - 0.8869204 = 0.0436129$$\n\n情景 B：威布尔基线风险\n基线风险函数由 $h_{0B}(t) = 2 \\lambda_{B} t$ 给出，形状参数为 $k=2$。率参数为 $\\lambda_{B} = \\frac{1.6}{T^{2}}$。\n首先，我们计算在时间 $T$ 时的累积基线风险：\n$$H_{0B}(T) = \\int_{0}^{T} 2 \\lambda_{B} t \\, dt = 2 \\lambda_{B} \\left[\\frac{t^2}{2}\\right]_{0}^{T} = \\lambda_{B} T^2$$\n代入 $\\lambda_{B}$ 的定义：\n$$H_{0B}(T) = \\left(\\frac{1.6}{T^{2}}\\right) T^2 = 1.6$$\n这证实了问题陈述中的设定。\n情景 B 的绝对风险降低值 $\\text{ARR}_{B}$ 为：\n$$\\text{ARR}_{B} = \\exp(-\\theta H_{0B}(T)) - \\exp(-H_{0B}(T)) = \\exp(-(0.6)(1.6)) - \\exp(-1.6)$$\n$$\\text{ARR}_{B} = \\exp(-0.96) - \\exp(-1.6)$$\n数值上，$\\exp(-0.96) \\approx 0.3828929$ 且 $\\exp(-1.6) \\approx 0.2018965$。\n$$\\text{ARR}_{B} \\approx 0.3828929 - 0.2018965 = 0.1809964$$\n\n最终计算：绝对风险降低值的差异\n问题要求计算差值 $\\Delta = \\text{ARR}_{B} - \\text{ARR}_{A}$。\n$$\\Delta = (0.1809964) - (0.0436129) = 0.1373835$$\n将结果四舍五入到四位有效数字得到 $0.1374$。此计算表明，当基线风险较高时（情景 B，对照组风险 $F_{0B}(T) = 1-\\exp(-1.6) \\approx 79.8\\%$），与基线风险较低时（情景 A，对照组风险 $F_{0A}(T) = 1-\\exp(-0.12) \\approx 11.3\\%$）相比，一个恒定的风险比（$\\theta=0.6$）会产生大得多的绝对风险降低值。", "answer": "$$\\boxed{0.1374}$$", "id": "4968251"}]}