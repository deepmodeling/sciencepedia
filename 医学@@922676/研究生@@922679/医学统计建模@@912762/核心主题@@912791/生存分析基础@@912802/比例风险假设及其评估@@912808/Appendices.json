{"hands_on_practices": [{"introduction": "我们将从一项评估比例风险（PH）假设的基本图形化方法入手。本练习将指导你如何利用原始数据，通过Nelson-Aalen估计量来计算特定分组的累积风险函数。通过绘制这些函数的变换形式，我们可以直观地检查数据是否偏离了比例性假设，这是生存数据分析中的一项基本技能。", "problem": "一项随机临床研究跟踪了两组（索引为 $g \\in \\{1,2\\}$），以比较发生心血管事件的时间。对于第 $g$ 组中的受试者 $i$，令 $T_{gi}$ 为事件发生或删失的时间，$\\Delta_{gi} \\in \\{0,1\\}$ 为事件指示符。风险函数为 $h_g(t)$，累积风险函数为 $H_g(t) = \\int_0^t h_g(u)\\,du$。生存函数为 $S_g(t) = \\exp\\{-H_g(t)\\}$。在比例风险假设（PH）下，存在一个恒定的风险比 $\\theta > 0$，使得对所有 $t \\ge 0$ 都有 $h_2(t) = \\theta \\, h_1(t)$。您的任务是使用 $H_g(t)$ 的组特定纳尔逊-阿伦估计量，通过检查各组累积风险函数的对数之差在 $t$ 上是否近似恒定，来评估 PH 假设。\n数据：第 1 组有 $n_1 = 4$ 名受试者，观测到的 $(T_{1i}, \\Delta_{1i})$ 为 $(1,1)$、$(3,1)$、$(5,0)$、$(7,1)$。第 2 组有 $n_2 = 4$ 名受试者，观测到的 $(T_{2i}, \\Delta_{2i})$ 为 $(2,1)$、$(4,1)$、$(6,1)$、$(8,0)$。假设无左截断以及独立、非信息性右删失。考虑两组中所有不同事件时间的合并集合。\n从 $h_g(t)$ 和 $H_g(t)$ 的核心定义出发，并使用在每组内计算的、经过充分检验的纳尔逊-阿伦估计量来估计 $H_g(t)$，在概念上和计算上完成以下任务：\n- 对于每组 $g \\in \\{1,2\\}$，定义在该组每个不同事件时间 $t_j$ 之前的组特定风险集大小 $r_g(t_j)$ 和在 $t_j$ 时的事件数 $d_g(t_j)$。使用这些来计算组特定的纳尔逊-阿伦估计量 $\\widehat H_g(t)$，作为一个在合并事件时间上直至观测到的最大事件时间的右连续阶梯函数。\n- 使用有定义的 $\\log \\widehat H_g(t)$，检查 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 在 $t$ 上是否近似恒定，并说明 PH 假设在这些数据中是否得到支持。\n- 明确说明计算对数所需的任何约束条件以及任何对结（tie）的处理。\n下列陈述中哪些是正确的？选择所有适用项。\n\nA. 对每组 $g$，纳尔逊-阿伦估计量仅使用组内风险集计算：$\\widehat H_g(t) = \\sum_{t_{gj} \\le t} d_g(t_{gj}) / r_g(t_{gj})$，其中 $r_g(t_{gj})$ 计算在 $t_{gj}$ 之前在组 $g$ 中处于风险状态的受试者数量，$d_g(t_{gj})$ 计算在 $t_{gj}$ 时在组 $g$ 中的事件数量。为评估比例风险，在两组的 $\\widehat H_g(t) > 0$ 的合并事件时间 $t$ 上评估 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$，并检查其在 $t$ 上是否近似恒定。\n\nB. 一个更简单且等价的 PH 诊断方法是为每组计算 Kaplan-Meier 估计量 $\\widehat S_g(t)$，并检查 $\\widehat S_1(t) - \\widehat S_2(t)$ 在 $t$ 上是否近似恒定；如果是，则 PH 成立。\n\nC. 为了稳定估计，每组的纳尔逊-阿伦增量的分母应该是两组的合并风险计数，即来自所有受试者的 $r(t_j)$，而不是组内的 $r_g(t_j)$。\n\nD. 因为在比例风险下，对于某个常数 $\\theta$，有 $H_2(t) = \\theta H_1(t)$，所以一个与对数差检查等价的诊断方法是，在分母均为正的时间段内，检查 $\\widehat H_2(t) / \\widehat H_1(t)$ 在 $t$ 上是否近似恒定。\n\nE. 如果在给定时间 $t$，组 $g$ 中有 $d_g(t) \\ge 2$ 个结事件，则在 $t$ 时的纳尔逊-阿伦增量是 $d_g(t) / r_g(t)$，使用 $t$ 之前的组特定风险集大小；这种结处理方式是纳尔逊-阿伦估计量的标准做法。\n\nF. 根据所提供的数据，在两者都有定义的时间上计算的 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 值随 $t$ 变化很大，因此该样本不支持 PH 假设。\n\nG. 当 $\\widehat H_g(t) = 0$ 在早期时间点出现时，可以接受定义 $\\log \\widehat H_g(t) = 0$，以便所有合并的事件时间都可以在对数差图中使用而不受限制。", "solution": "### 问题验证\n\n#### 第 1 步：提取已知条件\n- **研究设置**：一项随机临床研究，有两个组，索引为 $g \\in \\{1,2\\}$。\n- **每位受试者的数据**：对于第 $g$ 组中的受试者 $i$，观测数据为 $(T_{gi}, \\Delta_{gi})$，其中 $T_{gi}$ 是事件发生或删失的时间，$\\Delta_{gi} \\in \\{0,1\\}$ 是事件指示符（$\\Delta_{gi}=1$ 表示事件，$\\Delta_{gi}=0$ 表示删失）。\n- **风险函数**：$h_g(t)$ 是第 $g$ 组的风险函数。\n- **累积风险函数**：$H_g(t) = \\int_0^t h_g(u)\\,du$。\n- **生存函数**：$S_g(t) = \\exp\\{-H_g(t)\\}$。\n- **比例风险（PH）假设**：存在一个恒定的风险比 $\\theta > 0$，使得对所有 $t \\ge 0$ 都有 $h_2(t) = \\theta \\, h_1(t)$。\n- **任务**：通过检查组特定纳尔逊-阿伦估计量的对数之差 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 是否随时间 $t$ 近似恒定，来评估 PH 假设。\n- **第 1 组数据**：$n_1 = 4$ 名受试者，其 $(T_{1i}, \\Delta_{1i})$ 对为：$(1,1)$, $(3,1)$, $(5,0)$, $(7,1)$。\n- **第 2 组数据**：$n_2 = 4$ 名受试者，其 $(T_{2i}, \\Delta_{2i})$ 对为：$(2,1)$, $(4,1)$, $(6,1)$, $(8,0)$。\n- **假设**：无左截断，独立且非信息性右删失。\n- **计算说明**：使用组特定的纳尔逊-阿伦估计量 $\\widehat H_g(t) = \\sum_{t_{gj} \\le t} d_g(t_{gj}) / r_g(t_{gj})$，其中 $r_g(t_j)$ 是在时间 $t_j$ 之前在第 $g$ 组中处于风险状态的受试者数量，而 $d_g(t_j)$ 是在时间 $t_j$ 时在第 $g$ 组中发生的事件数量。评估应在所有不同事件时间的合并集合上进行。\n\n#### 第 2 步：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行评估：\n- **有科学依据**：该问题设置在生存分析的标准框架内，这是生物统计学和医学统计学的核心课题。所有定义——风险函数、累积风险函数、生存函数、比例风险假设以及纳尔逊-阿伦估计量——都是标准的、符合教科书的。所提出的评估 PH 假设的方法是一种有效且广泛使用的图形技术。没有科学或事实错误。\n- **提法明确**：问题结构清晰。它提供了具体的数据、一个明确定义的统计模型（PH 模型）、一个标准的非参数估计量（纳尔逊-阿伦）和一个精确的任务（计算估计量和一个诊断量，然后评估具体的陈述）。数据完整且足以执行所需的计算。计算存在唯一解。\n- **客观**：语言精确、量化，没有主观性或歧义。像“风险集”、“事件指示符”和“纳尔逊-阿伦估计量”等术语在该领域有明确的定义。\n\n该问题没有违反任何无效性标准。这是一个标准的、形式化的应用统计学练习。\n\n#### 第 3 步：结论与行动\n该问题是有效的。将开始解题过程。\n\n### 解题推导\n\n比例风险（PH）假设指出，对于一个常数 $\\theta > 0$，有 $h_2(t) = \\theta h_1(t)$。将两边从 $0$ 到 $t$ 积分，得到累积风险函数的关系：\n$$ H_2(t) = \\int_0^t h_2(u)\\,du = \\int_0^t \\theta h_1(u)\\,du = \\theta \\int_0^t h_1(u)\\,du = \\theta H_1(t) $$\n对两边取自然对数（对于使得 $H_1(t) > 0$ 和 $H_2(t) > 0$ 的 $t$），我们得到：\n$$ \\log H_2(t) = \\log(\\theta H_1(t)) = \\log \\theta + \\log H_1(t) $$\n整理得：\n$$ \\log H_2(t) - \\log H_1(t) = \\log \\theta $$\n这表明，在 PH 假设下，两组的对数累积风险之差是一个常数 $\\log \\theta$。问题要求检查 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 是否恒定，这等价于检查 $\\log \\widehat H_2(t) - \\log \\widehat H_1(t)$ 是否恒定（其常数将是另一个的负值）。我们可以通过用其纳尔逊-阿伦估计量 $\\widehat H_g(t)$ 替换理论函数 $H_g(t)$ 来评估这一点。\n\n第 $g$ 组的累积风险的纳尔逊-阿伦估计量由下式给出：\n$$ \\widehat H_g(t) = \\sum_{t_{gj} \\le t} \\frac{d_g(t_{gj})}{r_g(t_{gj})} $$\n其中 $t_{gj}$ 是第 $g$ 组中的不同事件时间，$d_g(t_{gj})$ 是在时间 $t_{gj}$ 时第 $g$ 组的事件数，而 $r_g(t_{gj})$ 是在时间 $t_{gj}$ 之前第 $g$ 组中处于风险状态的受试者数。\n\n**1. 第 1 组的计算：**\n数据：$(1,1), (3,1), (5,0), (7,1)$。初始风险集大小 $n_1=4$。\n不同事件时间为 $t=1, 3, 7$。\n- 在 $t=1$ 时：$d_1(1)=1$, $r_1(1)=4$。增量为 $1/4$。对于 $1 \\le t  < 3$，$\\widehat H_1(t) = 1/4$。\n- 在 $t=3$ 时：一名受试者已发生事件。$r_1(3)=3$。$d_1(3)=1$。增量为 $1/3$。对于 $3 \\le t  < 5$，$\\widehat H_1(t) = 1/4 + 1/3 = 7/12$。\n- 在 $t=5$ 时：一名受试者被删失。对于之后的时间，风险集大小从 $2$ 减小到 $1$。$\\widehat H_1(t)$ 没有增量。对于 $5 \\le t  < 7$，$\\widehat H_1(t)$ 保持为 $7/12$。\n- 在 $t=7$ 时：在 $t=1$ 和 $t=3$ 时各有一名受试者发生事件，在 $t=5$ 时有一名被删失。在 $t=7$ 之前的风险集为 $r_1(7)=1$。$d_1(7)=1$。增量为 $1/1 = 1$。对于 $t \\ge 7$，$\\widehat H_1(t) = 7/12 + 1 = 19/12$。\n\n**2. 第 2 组的计算：**\n数据：$(2,1), (4,1), (6,1), (8,0)$。初始风险集大小 $n_2=4$。\n不同事件时间为 $t=2, 4, 6$。\n- 在 $t=2$ 时：$d_2(2)=1$, $r_2(2)=4$。增量为 $1/4$。对于 $2 \\le t  < 4$，$\\widehat H_2(t) = 1/4$。\n- 在 $t=4$ 时：一名受试者已发生事件。$r_2(4)=3$。$d_2(4)=1$。增量为 $1/3$。对于 $4 \\le t  < 6$，$\\widehat H_2(t) = 1/4 + 1/3 = 7/12$。\n- 在 $t=6$ 时：两名受试者已发生事件。$r_2(6)=2$。$d_2(6)=1$。增量为 $1/2$。对于 $t \\ge 6$，$\\widehat H_2(t) = 7/12 + 1/2 = 13/12$。\n- 在 $t=8$ 时：一名受试者被删失。\n\n**3. 评估 PH 假设：**\n我们在合并的不同事件时间 $t \\in \\{1, 2, 3, 4, 6, 7\\}$ 上评估 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$，限制在 $\\widehat H_1(t)>0$ 和 $\\widehat H_2(t)>0$ 的时间点。\n\n| 时间 $t$ | $\\widehat H_1(t)$ | $\\widehat H_2(t)$ | $\\log \\widehat H_1(t)$ | $\\log \\widehat H_2(t)$ | $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ |\n| :------: | :--------------: | :--------------: | :-------------------: | :-------------------: | :---------------------------------------------: |\n| 1 | $1/4$ | $0$ | $\\approx -1.386$ | 未定义 | 未定义 |\n| 2 | $1/4$ | $1/4$ | $\\approx -1.386$ | $\\approx -1.386$ | $0$ |\n| 3 | $7/12$ | $1/4$ | $\\approx -0.539$ | $\\approx -1.386$ | $\\approx 0.847$ |\n| 4 | $7/12$ | $7/12$ | $\\approx -0.539$ | $\\approx -0.539$ | $0$ |\n| 6 | $7/12$ | $13/12$ | $\\approx -0.539$ | $\\approx 0.080$ | $\\approx -0.619$ |\n| 7 | $19/12$ | $13/12$ | $\\approx 0.459$ | $\\approx 0.080$ | $\\approx 0.379$ |\n\n差值序列 $\\{0, 0.847, 0, -0.619, 0.379\\}$ 波动显著，看起来不是恒定的。这表明这些数据不支持比例风险假设。\n\n### 逐项分析\n\n**A. 对每组 $g$，纳尔逊-阿伦估计量仅使用组内风险集计算：$\\widehat H_g(t) = \\sum_{t_{gj} \\le t} d_g(t_{gj}) / r_g(t_{gj})$，其中 $r_g(t_{gj})$ 计算在 $t_{gj}$ 之前在组 $g$ 中处于风险状态的受试者数量，$d_g(t_{gj})$ 计算在 $t_{gj}$ 时在组 $g$ 中的事件数量。为评估比例风险，在两组的 $\\widehat H_g(t) > 0$ 的合并事件时间 $t$ 上评估 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$，并检查其在 $t$ 上是否近似恒定。**\n该陈述准确描述了标准程序。为了估计特定组的累积风险，必须使用特定组的风险集和事件计数。诊断检验涉及比较这些估计函数，特别是寻找对数尺度上的恒定差异，这对应于原始尺度上的恒定比率。对估计值为正的时间进行限制对于对数函数在数学上是必要的。\n**结论：正确**\n\n**B. 一个更简单且等价的 PH 诊断方法是为每组计算 Kaplan-Meier 估计量 $\\widehat S_g(t)$，并检查 $\\widehat S_1(t) - \\widehat S_2(t)$ 在 $t$ 上是否近似恒定；如果是，则 PH 成立。**\n这是不正确的。在 PH 假设下，$S_2(t) = [S_1(t)]^\\theta$。这是一个幂关系，而不是加法关系。差值 $S_1(t) - S_2(t)$ 不会是恒定的。使用生存函数的一个正确诊断方法是绘制 $\\log(-\\log \\widehat S_2(t))$ 对 $\\log(-\\log \\widehat S_1(t))$ 的图，该图应产生一条斜率为 $\\theta$ 的直线。或者，绘制 $\\log(-\\log \\widehat S_2(t)) - \\log(-\\log \\widehat S_1(t))$ 对 $\\log(t)$ 的图，应为一条高度为 $\\log \\theta$ 的水平线。\n**结论：错误**\n\n**C. 为了稳定估计，每组的纳尔逊-阿伦增量的分母应该是两组的合并风险计数，即来自所有受试者的 $r(t_j)$，而不是组内的 $r_g(t_j)$。**\n为了制作 PH 诊断图，这是不正确的。使用合并风险集是估计一个*共同*累积风险函数的方法，这是构建用于检验零假设 $H_0: \\theta=1$ 的对数秩检验统计量的关键组成部分。这里的目标不同：分别估计 $\\widehat H_1(t)$ 和 $\\widehat H_2(t)$，以观察它们的关系是否与任何 $\\theta$ 的比例性一致。这需要特定组的估计量。\n**结论：错误**\n\n**D. 因为在比例风险下，对于某个常数 $\\theta$，有 $H_2(t) = \\theta H_1(t)$，所以一个与对数差检查等价的诊断方法是，在分母均为正的时间段内，检查 $\\widehat H_2(t) / \\widehat H_1(t)$ 在 $t$ 上是否近似恒定。**\n这是正确的。关系 $H_2(t) = \\theta H_1(t)$ 直接意味着比率 $H_2(t) / H_1(t) = \\theta$ 对于所有 $H_1(t) > 0$ 的 $t$ 都成立。因此，检查估计量比率 $\\widehat H_2(t) / \\widehat H_1(t)$ 的恒定性是评估 PH 假设的一种直接且数学上等价的方法。取对数将这种关系线性化，这通常在视觉检查中更受欢迎，因为它可以使偏离恒定性的情况更容易被发现并稳定方差，但比率图也是一个有效的诊断方法。\n**结论：正确**\n\n**E. 如果在给定时间 $t$，组 $g$ 中有 $d_g(t) \\ge 2$ 个结事件，则在 $t$ 时的纳尔逊-阿伦增量是 $d_g(t) / r_g(t)$，使用 $t$ 之前的组特定风险集大小；这种结处理方式是纳尔逊-阿伦估计量的标准做法。**\n这个陈述是正确的。纳尔逊-阿伦框架自然地处理了事件时间结。在时间 $t$ 的风险增量被估计为该时间的总事件数除以刚好在此之前的风险集人数。这是纳尔逊-阿伦估计量的标准定义和结处理方法。虽然所提供的数据没有结，但所描述的原则是准确的。\n**结论：正确**\n\n**F. 根据所提供的数据，在两者都有定义的时间上计算的 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 值随 $t$ 变化很大，因此该样本不支持 PH 假设。**\n如上述计算所示，计算出的差值 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 在相关时间点上取值为 $\\{0, \\approx 0.847, 0, \\approx-0.619, \\approx 0.379\\}$。这个序列显然不是恒定的。相对于值本身，变化是相当大的。因此，对这些数据的视觉检查会让人质疑 PH 假设的有效性。\n**结论：正确**\n\n**G. 当 $\\widehat H_g(t) = 0$ 在早期时间点出现时，可以接受定义 $\\log \\widehat H_g(t) = 0$，以便所有合并的事件时间都可以在对数差图中使用而不受限制。**\n这在数学上是不正确的。$0$ 的自然对数是未定义的（它趋向于 $-\\infty$）。赋给一个任意的有限值如 $0$ 是对对数函数数学性质的伪造，会严重扭曲诊断图。正确的程序是将图的定义域限制在 $\\widehat H_1(t)$ 和 $\\widehat H_2(t)$ 均严格为正的时间 $t$ 上。\n**结论：错误**", "answer": "$$\\boxed{ADEF}$$", "id": "4991166"}, {"introduction": "发现违反PH假设只是第一步，接下来是寻找一个更合适的模型。本练习提供了一个真实场景，其中正式的诊断方法（例如在练习 @problem_id:4991166 中探讨的方法）已揭示了非比例风险的存在。你将学习一个原则性的工作流程，用于比较标准的Cox模型与加速失效时间（AFT）模型等替代方案，并运用残差分析和信息准则来做出数据驱动的选择。", "problem": "考虑一项随机临床试验，其结局为右删失的事件时间数据，其中事件为疾病进展时间。令 $T$ 表示非负生存时间，$\\delta \\in \\{0,1\\}$ 表示事件指示符（如果观测到进展，则 $\\delta=1$，如果删失，则 $\\delta=0$）。令 $\\mathbf{x}$ 表示一个协变量向量，包括一个二元治疗指示符 $Z \\in \\{0,1\\}$、以年为单位的基线年龄 $A$ 以及作为有序评分的疾病分期 $S$。风险函数为 $h(t \\mid \\mathbf{x})$，生存函数为 $S(t \\mid \\mathbf{x})$，密度函数为 $f(t \\mid \\mathbf{x})$。现要求您评估比例风险 (PH) 假定，如果该假定被违背，则使用加速失效时间 (AFT) 框架来论证一个科学上合理的非 PH 备选模型，并展示一个使用残差诊断和信息准则在 PH 和 AFT 模型之间进行选择的有原则的流程。\n\n使用的基本定义如下：\n- Cox 比例风险 (PH) 模型：$h(t \\mid \\mathbf{x}) = h_0(t) \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$，其中 $h_0(t)$ 是一个未指定的基线风险，$\\boldsymbol{\\beta}$ 是回归参数。在 PH 假定下，对于固定的 $\\mathbf{x}_1$ 和 $\\mathbf{x}_2$，风险比 $\\mathrm{HR}(t; \\mathbf{x}_1,\\mathbf{x}_2) = h(t \\mid \\mathbf{x}_1)/h(t \\mid \\mathbf{x}_2)$ 关于 $t$ 是恒定的。\n- 加速失效时间 (AFT) 模型：$\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$，其中 $W$ 服从一个指定的基线误差分布，其累积分布函数为 $F_W(\\cdot)$，密度函数为 $f_W(\\cdot)$，并且 $\\sigma>0$ 是一个尺度参数。等价地，$S(t \\mid \\mathbf{x}) = S_0\\!\\left(t \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})\\right)$，其中 $S_0(\\cdot)$ 是由 $W$ 导出的基线生存函数。\n\n假设您在一个样本量为 $n=800$、右删失率为 $30\\%$ 的数据集上拟合了一个包含协变量 $(Z,A,S)$ 的 Cox PH 模型。您为每个协变量计算了标度化的 Schoenfeld 残差，并应用 Grambsch and Therneau (GT) 检验来检验斜率是否为零（相对于 $\\log(t)$）：\n- 对于 $Z$，相对于 $\\log(t)$ 的估计斜率为 $0.35$，双边 $p$ 值为 $p=0.0003$；对于 $A$ 和 $S$，斜率接近于 $0$，$p>0.20$。\n一张对数-负对数图，即按 $Z$ 分层的 $\\log\\{-\\log \\widehat{S}(t \\mid Z)\\}$ 对 $\\log(t)$ 的曲线图，显示出明显的非平行和交叉。\n接着，您使用 $(Z,A,S)$ 拟合了三个参数化的 AFT 备选模型：对数正态、对数逻辑斯蒂和 Weibull 模型。对于对数正态 AFT 拟合，未删失个案的标准化误差残差 $\\widehat{\\epsilon}_i = \\{\\log(t_i) - \\mathbf{x}_i^\\top \\widehat{\\boldsymbol{\\beta}}\\}/\\widehat{\\sigma}$ 在正态分位数-分位数图上排列紧密（相关系数为 $0.995$），而对数逻辑斯蒂模型在逻辑斯蒂分位数-分位数图上产生的吻合度较差（相关系数为 $0.972$）。Weibull AFT 模型在相应的分位数图上显示出明显的尾部偏差。\n您还为拟合的模型计算了信息准则：\n- 使用偏似然的 Cox PH 模型：$\\mathrm{AIC}_{\\mathrm{Cox}} = 1420$。\n- 对数正态 AFT（全似然）：$\\mathrm{AIC}_{\\mathrm{LN}} = 1388$。\n- 对数逻辑斯蒂 AFT（全似然）：$\\mathrm{AIC}_{\\mathrm{LL}} = 1401$。\n- Weibull PH 参数化（使用 PH 连接的全似然）：$\\mathrm{AIC}_{\\mathrm{WPH}} = 1416$。\n\n仅使用上述基本定义和报告的诊断结果，选择一个选项，该选项最正确地解释了加速失效时间模型如何作为一种非 PH 备选模型，并为该数据集展示了一个通过残差诊断和信息准则在 PH 和 AFT 模型之间进行选择的有效的分步流程，最终得出一个有理有据的模型选择。\n\nA. AFT 模型通过 $T^* = T \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$ 对时间进行重新标度，这通常会导出一个时间依赖的风险比，除非基线风险 $h_0(t)$ 具有特殊的幂律形式（例如 Weibull）。一个有原则的选择流程是：首先，通过将标度化的 Schoenfeld 残差对时间函数进行回归并执行 Grambsch and Therneau 检验来评估 PH 假定；$Z$ 的非零斜率（$p=0.0003$）意味着 $Z$ 违背了 PH 假定，这一点由非平行的对数-负对数曲线所证实。接下来，拟合备选的 AFT 模型族并评估特定于模型的残差（例如，通过分位数-分位数图将标准化的 AFT 误差与假定的 $W$ 进行比较，或将 Cox-Snell 残差与指数参照进行比较）；对数正态 AFT 残差与正态分布的高度吻合（相关系数为 $0.995$）表明其模型是合适的。最后，比较 Cox PH（偏似然）和参数化 AFT 拟合的赤池信息准则；最低的 $\\mathrm{AIC}$（此处 $\\mathrm{AIC}_{\\mathrm{LN}}=1388$，而 $\\mathrm{AIC}_{\\mathrm{Cox}}=1420$ 和 $\\mathrm{AIC}_{\\mathrm{LL}}=1401$）支持对数正态 AFT 模型作为针对 $Z$ 的首选非 PH 备选模型，同时保留 $A$ 和 $S$ 作为具有时间不变效应的协变量。\n\nB. AFT 模型加速风险，因此如果对数秩检验显著，则应接受 PH 假定并选择具有最高一致性指数的模型；残差和信息准则是次要的。由于对数秩检验通常很敏感，应继续使用 Cox PH 模型并忽略 Schoenfeld 残差的趋势；基于偏似然和全似然计算的信息准则是不可比较的。\n\nC. 如果基线分布是对数正态的，则 AFT 模型等价于 PH 模型。为了进行选择，应绘制鞅残差对时间的图来评估 PH 假定，然后选择从 Cox 偏似然和 AFT 全似然直接计算出的具有最低贝叶斯信息准则的模型。鉴于报告的 $Z$ 的 $p=0.0003$，选择 Weibull PH 模型，因为它的风险随时间是恒定的。\n\nD. AFT 模型通过加性平移来改变基线风险，因此如果 Grambsch and Therneau 检验显示任何显著性，应重新拟合一个包含 $Z \\times \\log(t)$ 交互作用的时间依赖 Cox PH 模型，并选择具有最小偏差残差之和的模型；忽略跨半参数和参数模型的信息准则比较，因为它们使用不同的似然。考虑到残差模式，应偏好 Cox PH 模型，因为它比参数化 AFT 模型更稳健。", "solution": "用户要求对一个关于生存分析中比例风险 (PH) 模型和加速失效时间 (AFT) 模型比较的问题陈述进行严格验证，并随后提供详细的解法和选项评估。\n\n### 步骤 1：提取已知信息\n- **问题领域**：随机临床试验，右删失事件时间数据（疾病进展时间）。\n- **变量**：$T$（生存时间），$\\delta$（事件指示符），$\\mathbf{x}$（协变量向量），$Z$（二元治疗指示符），$A$（基线年龄），$S$（有序疾病分期）。\n- **模型定义**：\n    - **Cox PH 模型**：$h(t \\mid \\mathbf{x}) = h_0(t) \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$，其中风险比随时间恒定。\n    - **AFT 模型**：$\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$，或等价地，$S(t \\mid \\mathbf{x}) = S_0\\!\\left(t \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})\\right)$。\n- **数据集和 Cox 模型诊断**：\n    - 样本量 $n=800$，删失率 $30\\%$。协变量为 $(Z,A,S)$。\n    - 对标度化的 Schoenfeld 残差与 $\\log(t)$ 进行的 Grambsch and Therneau (GT) 检验：\n        - 对于 $Z$：估计斜率 $= 0.35$，$p$ 值 $= 0.0003$。\n        - 对于 $A, S$：斜率接近 $0$，$p$ 值 $> 0.20$。\n    - $\\log\\{-\\log \\widehat{S}(t \\mid Z)\\}$ 对 $\\log(t)$ 的图显示出“明显的非平行和交叉”。\n- **AFT 模型诊断**：\n    - 拟合了三个 AFT 模型：对数正态、对数逻辑斯蒂、Weibull。\n    - 通过 Q-Q 图检查标准化误差残差 $\\widehat{\\epsilon}_i = \\{\\log(t_i) - \\mathbf{x}_i^\\top \\widehat{\\boldsymbol{\\beta}}\\}/\\widehat{\\sigma}$：\n        - 对数正态 AFT：正态 Q-Q 图相关系数为 $0.995$。\n        - 对数逻辑斯蒂 AFT：逻辑斯蒂 Q-Q 图相关系数为 $0.972$。\n        - Weibull AFT：在其相应的 Q-Q 图上呈现“明显的尾部偏差”。\n- **信息准则**：\n    - $\\mathrm{AIC}_{\\mathrm{Cox}} = 1420$（偏似然）。\n    - $\\mathrm{AIC}_{\\mathrm{LN}} = 1388$（对数正态 AFT，全似然）。\n    - $\\mathrm{AIC}_{\\mathrm{LL}} = 1401$（对数逻辑斯蒂 AFT，全似然）。\n    - $\\mathrm{AIC}_{\\mathrm{WPH}} = 1416$（Weibull PH，全似然）。\n\n### 步骤 2：使用提取的已知信息进行验证\n1.  **科学依据**：该问题基于生物统计学中生存分析的标准、公认原则。Cox PH 模型、AFT 模型、Schoenfeld 残差、Grambsch-Therneau 检验、对数-负对数图、参数模型的特定残差以及赤池信息准则 (AIC) 都是该领域的基本概念和工具。定义是正确的。该问题在科学上和数学上都是合理的。\n2.  **定义明确**：该问题提供了一个清晰的场景、来自诊断检验和模型拟合的特定数值结果，并要求基于这些证据做出合理的选择。信息是充分的，足以执行所需的推理，并在选项中得出一个唯一的最佳答案。\n3.  **客观性**：该问题使用精确的技术语言陈述。数据和诊断结果是定量的和客观的。任务是将既定的统计原则应用于这些证据，这是一个客观的过程。\n\n问题陈述没有表现出说明中列出的任何缺陷（例如，科学不合理、不完整、模糊不清）。将来自偏似然（Cox 模型）的 AIC 与来自全似然（参数模型）的 AIC 进行比较是一种公认的做法，尽管其中存在细微差别。为问题之目的，将这些值作为已知信息呈现是一种有效的简化。\n\n### 步骤 3：结论和行动\n问题陈述是**有效的**。将推导出一个完整的解法。\n\n### 推导与选项分析\n\n任务是根据所提供的证据，确定在 PH 和 AFT 模型之间进行选择的最正确的解释和流程。一个有原则的方法涉及三个主要阶段：(1) 评估初始模型（Cox PH）的假定，(2) 如果假定被违背，则拟合合理的备选模型，以及 (3) 比较竞争模型以选择最佳模型。\n\n**1. 比例风险假定的评估**\n\nPH 假定指出，任何两个个体的风险比随时间是恒定的。对于拟合的 Cox 模型，该问题提供了关于此假定的两个关键证据。\n\n-   **Grambsch and Therneau (GT) 检验**：这是一个检验 PH 假定的正式方法。它通过对标度化的 Schoenfeld 残差与时间函数（通常是 $t$ 或 $\\log(t)$）进行回归，来检查是否存在非零斜率。一个显著的 p 值表明相应协变量的效应随时间变化，从而违背了 PH 假定。\n    -   对于治疗指示符 $Z$，该检验得出了一个高度显著的 p 值，$p=0.0003$。这是反对治疗效应满足 PH 假定的强有力统计证据。正斜率（$0.35$）表明治疗的风险比随着时间的推移而增加。\n    -   对于年龄（$A$）和分期（$S$），p 值很大（$p>0.20$），这表明对于这些协变量，PH 假定是合适的。\n\n-   **对数-负对数图**：如果某个协变量满足 PH 假定，那么对该协变量的不同分层绘制 $\\log(-\\log(\\widehat{S}(t)))$ 对 $\\log(t)$ 的图，应该会产生平行的曲线。\n    -   问题陈述指出，按 $Z$ 分层的这些曲线显示出“明显的非平行和交叉”。这是非比例风险的一个经典视觉表示。交叉的曲线意味着风险比不仅是时间依赖的，而且在某个时间点会反转方向（例如，从 $<1$ 变为 $>1$）。\n\n**关于 PH 假定的结论**：来自正式统计检验和图形诊断的有力证据表明，对于治疗协变量 $Z$，比例风险假定被违背了。因此，标准的 Cox PH 模型对于此数据集是设定错误的，应考虑备选模型。\n\n**2. 作为非 PH 备选方案的 AFT 模型**\n\nAFT 模型为协变量效应提供了另一种机制性解释。协变量的作用不是乘以风险，而是加速或减速事件发生的时间。该模型为 $\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$，等价于 $T = T_0 \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$，其中 $T_0 = \\exp(\\sigma W)$ 是一个时间的基线随机变量。\n\nAFT 模型的风险函数是 $h(t \\mid \\mathbf{x}) = h_0(t \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})) \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})$。具有协变量 $\\mathbf{x}_1$ 和 $\\mathbf{x}_2$ 的两个个体的风险比为：\n$$\n\\mathrm{HR}(t) = \\frac{h(t \\mid \\mathbf{x}_1)}{h(t \\mid \\mathbf{x}_2)} = \\frac{h_0(t \\exp(-\\mathbf{x}_1^\\top \\boldsymbol{\\beta}))}{h_0(t \\exp(-\\mathbf{x}_2^\\top \\boldsymbol{\\beta}))} \\exp((\\mathbf{x}_2 - \\mathbf{x}_1)^\\top \\boldsymbol{\\beta})\n$$\n这个比率通常是时间 $t$ 的函数，这意味着 AFT 模型本质上是一个非 PH 模型。唯一的例外是当基线风险 $h_0(t)$ 服从时间的幂律，即 $h_0(t) \\propto t^{\\alpha-1}$，这对应于 Weibull 分布。在这种特殊情况下，AFT 模型也是一个 PH 模型。对于其他常见的 AFT 分布，如对数正态或对数逻辑斯蒂分布，PH 属性不成立。因此，AFT 模型代表了一大类具有机制可解释性的非 PH 模型。\n\n**3. 在备选模型中进行选择**\n\n鉴于 PH 假定被违背，下一步是找到一个拟合得更好的模型。该问题探讨了三种参数化的 AFT 模型。它们之间的选择取决于两个标准：分布假定的充分性以及与其他备选模型相比的整体模型拟合度。\n\n-   **AFT 模型的残差诊断**：对于一个参数化的 AFT 模型，必须检查 $\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$ 中误差项 $W$ 的假定分布。标准化误差残差是 $W$ 的估计值，通过 Q-Q 图将其与假定分布的理论分位数进行比较。\n    -   **对数正态 AFT** 在正态 Q-Q 图上显示出近乎完美的拟合（相关系数 $0.995$），有力地支持了其分布假定。\n    -   **对数逻辑斯蒂 AFT** 显示出较差的拟合（相关系数 $0.972$）。\n    -   **Weibull AFT** 显示出“明显的尾部偏差”，表明拟合不佳。\n    -   基于残差，对数正态 AFT 显然是最佳选择。\n\n-   **用于模型比较的信息准则**：赤池信息准则 (AIC) 提供了一个相对的模型质量度量，它对参数数量进行惩罚以防止过拟合。较低的 AIC 表示更好的模型。\n    -   $\\mathrm{AIC}_{\\mathrm{Cox}} = 1420$\n    -   $\\mathrm{AIC}_{\\mathrm{LN}} = 1388$\n    -   $\\mathrm{AIC}_{\\mathrm{LL}} = 1401$\n    -   $\\mathrm{AIC}_{\\mathrm{WPH}} = 1416$\n    -   比较这些值，对数正态 AFT 模型的 AIC 最低（$1388$），且优势明显。差异 $\\Delta \\mathrm{AIC} = \\mathrm{AIC}_{\\mathrm{Cox}} - \\mathrm{AIC}_{\\mathrm{LN}} = 32$ 为对数正态 AFT 模型优于 Cox PH 模型提供了非常强的支持。\n\n**总体结论**：系统性分析得出以下流程和结论：\n1.  使用 GT 检验和图形方法检查 PH 假定。此处，对于 $Z$ 而言，该假定被明显违背。\n2.  提出并拟合科学上合理的备选模型，例如参数化的 AFT 模型。\n3.  使用适当的残差诊断（例如，标准化误差残差的 Q-Q 图）评估每个 AFT 备选模型的拟合情况。发现对数正态 AFT 拟合最好。\n4.  使用诸如 AIC 之类的全局拟合准则比较所有备选模型（包括初始的 Cox 模型）。对数正态 AFT 模型被强烈推荐。\n最终的选择是对数正态 AFT 模型。\n\n### 逐项选项分析\n\n**A. AFT 模型通过 $T^* = T \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$ 对时间进行重新标度，这通常会导出一个时间依赖的风险比，除非基线风险 $h_0(t)$ 具有特殊的幂律形式（例如 Weibull）。一个有原则的选择流程是：首先，通过将标度化的 Schoenfeld 残差对时间函数进行回归并执行 Grambsch and Therneau 检验来评估 PH 假定；$Z$ 的非零斜率（$p=0.0003$）意味着 $Z$ 违背了 PH 假定，这一点由非平行的对数-负对数曲线所证实。接下来，拟合备选的 AFT 模型族并评估特定于模型的残差（例如，通过分位数-分位数图将标准化的 AFT 误差与假定的 $W$ 进行比较，或将 Cox-Snell 残差与指数参照进行比较）；对数正态 AFT 残差与正态分布的高度吻合（相关系数为 $0.995$）表明其模型是合适的。最后，比较 Cox PH（偏似然）和参数化 AFT 拟合的赤池信息准则；最低的 $\\mathrm{AIC}$（此处 $\\mathrm{AIC}_{\\mathrm{LN}}=1388$，而 $\\mathrm{AIC}_{\\mathrm{Cox}}=1420$ 和 $\\mathrm{AIC}_{\\mathrm{LL}}=1401$）支持对数正态 AFT 模型作为针对 $Z$ 的首选非 PH 备选模型，同时保留 $A$ 和 $S$ 作为具有时间不变效应的协变量。**\n\n此选项准确地描述了 AFT 模型与 PH 模型的关系，为模型选择制定了一个逻辑上合理且标准的分步流程，正确解释了问题陈述中提供的所有诊断和比较证据，并得出了正确的结论。关于“保留 $A$ 和 $S$ 作为具有时间不变效应的协变量”的陈述，是可接受的简写，表示在所选模型中包含它们，并且其系数是恒定的。**正确**。\n\n**B. AFT 模型加速风险，因此如果对数秩检验显著，则应接受 PH 假定并选择具有最高一致性指数的模型；残差和信息准则是次要的。由于对数秩检验通常很敏感，应继续使用 Cox PH 模型并忽略 Schoenfeld 残差的趋势；基于偏似然和全似然计算的信息准则是不可比较的。**\n\n此选项存在根本性错误。(1) AFT 模型加速的是*时间*，而不是风险。(2) 显著的对数秩检验并不能验证 PH 假定。(3) 忽略模型假定的正式检验（Schoenfeld 残差）是不良的统计实践。(4) 一致性指数是区分度的度量，而不是校准度或假定有效性的度量。(5) 信息准则对于模型比较至关重要。**不正确**。\n\n**C. 如果基线分布是对数正态的，则 AFT 模型等价于 PH 模型。为了进行选择，应绘制鞅残差对时间的图来评估 PH 假定，然后选择从 Cox 偏似然和 AFT 全似然直接计算出的具有最低贝叶斯信息准则的模型。鉴于报告的 $Z$ 的 $p=0.0003$，选择 Weibull PH 模型，因为它的风险随时间是恒定的。**\n\n此选项包含多个错误。(1) AFT 模型等价于 PH 模型是在基线分布为 **Weibull** 分布时，而不是对数正态分布。(2) 虽然鞅残差很有用，但标度化的 Schoenfeld 残差是评估特定协变量是否满足 PH 假定的最直接工具。(3) 问题给出的是 AIC，而不是 BIC。(4) Weibull 模型的风险函数通常不随时间恒定，只有其特例——指数分布——才是如此。在有强有力证据反对 PH 假定的情况下选择一个 PH 模型是不合逻辑的。**不正确**。\n\n**D. AFT 模型通过加性平移来改变基线风险，因此如果 Grambsch and Therneau 检验显示任何显著性，应重新拟合一个包含 $Z \\times \\log(t)$ 交互作用的时间依赖 Cox PH 模型，并选择具有最小偏差残差之和的模型；忽略跨半参数和参数模型的信息准则比较，因为它们使用不同的似然。考虑到残差模式，应偏好 Cox PH 模型，因为它比参数化 AFT 模型更稳健。**\n\n此选项不正确。(1) AFT 模型在时间尺度上是乘性的，而不是在风险尺度上是加性的（那是加性风险模型）。(2) 偏差残差之和不是一个标准的模型选择准则。(3) 忽略 AIC 是没有根据的。(4) 最终建议偏好 Cox PH 模型，这直接与显示其主要假定被违背的诊断证据（“残差模式”）相矛盾。一个模型对于其自身核心假定的违背并不“稳健”。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "4991128"}, {"introduction": "真实的临床试验常常带来复杂的挑战，例如交叉的风险曲线，这使得简单的模型变得不适用。最后的这个练习将超越模型选择，进入分析策略规划的层面，要求你在临床可解释性、统计效率和对模型错误设定的稳健性之间进行权衡。你将学习如何为一个主要终点指标的选择提供正当理由，例如限制性平均生存时间（RMST）的差异，该指标对PH假设的违反具有稳健性，并能对治疗效果提供有临床意义的解释。", "problem": "一项随机、多中心的肿瘤学试验，旨在比较一种研究性疗法与对照组在总生存期方面的效果。在各中心内，患者按 $1:1$ 的比例进行随机分组，共计 $J=20$ 个中心的 $n=800$ 名参与者。管理性删失时间点为 $T_{\\max}=24$ 个月；观测到的事件数约为 $E \\approx 480$。各中心在基线死亡率方面存在显著差异，经验观察表明，不同中心的特异性基线风险相差可达 $3$ 倍，但没有临床依据支持存在治疗与中心的交互作用。\n\n设 $T$ 表示生存时间，$X$ 为包括治疗 $A \\in \\{0,1\\}$ 在内的基线协变量向量，$Z$ 为中心的分类指示变量。风险函数为 $h(t \\mid X)$。比例风险假设假定 $h(t \\mid X)=h_{0}(t)\\exp\\{\\beta^{\\top}X\\}$，其中 $h_{0}(t)$ 为某一基线风险函数，$\\beta$ 为常数回归系数。在按 $Z$ 分层的 Cox 模型中，基线风险被允许在各分层间变化，而回归系数被约束为在各分层间是共同的。\n\n探索性诊断显示，有强有力的证据表明治疗效果不满足比例风险假设：对于变量 $A$，其缩放后的 Schoenfeld 残差随时间呈现单调趋势，且对 $A$ 的比例风险假设的全局检验得出 $p0.001$。对估计的风险比函数（使用灵活的非参数平滑方法处理时变效应）进行目视检查，结果表明早期风险比大于 $1$，在 $t \\approx 6$ 个月左右交叉到 $1$ 以下，此后差距逐渐增大，这与延迟的治疗效果一致。使用晚期事件权重的加权对数秩检验比标准对数秩检验显示出更高的敏感性，进一步证实了延迟获益的现象。临床受众要求提供一个稳健且易于沟通的单一汇总度量，以用于指南制定，但他们也重视对时变效应的忠实描述。研究者希望对中心进行调整，以处理基线风险的异质性，同时避免估计高维度的讨厌参数并保持统计效率。\n\n您必须选择一个决策框架，该框架能够处理已检测到的非比例风险问题，并在临床可解释性、模型设定错误下的偏倚控制以及统计效率之间取得平衡。在当前情境下，以下哪个选项最能实现这样的框架？\n\nA. 宣布采用按中心分层的 Cox 模型，并使用 $\\log t$ 的惩罚样条为治疗效应设置一个灵活的时变系数，以此作为唯一分析。报告时变风险比曲线及其逐点置信区间，并以随时间变化的加权平均风险比作为总结。\n\nB. 预先指定在 $\\tau=24$ 个月时的限制性平均生存时间作为主要待估量，并报告治疗组间经调整的限制性平均生存时间差异，使用包含中心以提高效率的协变量调整方法（例如，基于伪观察值的回归）。同时，辅以按中心分层的 Cox 模型，并为治疗效应设置一个灵活的时变系数，以展示和检验时变效应。在揭盲前，需承诺时间范围 $\\tau$ 和平滑自由度。\n\nC. 拟合一个未分层的 Cox 比例风险模型，其中只包含治疗作为协变量，并使用稳健（三明治）方差估计量来保护推断；将系数解释为平均因果风险比。不因中心进行调整，以避免过度参数化导致的效率损失。\n\nD. 为避免非比例风险带来的偏倚，按治疗进行分层，并呈现各组的 Kaplan-Meier 曲线，如果两组的中位生存期均可估计，则报告其差异。依赖目视比较进行临床解释。\n\nE. 使用对数正态加速失效时间模型替换 Cox 模型，并包含中心的随机截距以捕捉异质性。报告加速因子作为主要待估量（这是一个单一的汇总数值），并使用基于似然的推断以保证效率，即使风险曲线存在交叉。", "solution": "用户希望一位严谨细致的STEM领域（数学、物理、化学、生物、工程及相关学科）教授，在尝试解答之前，对问题陈述（不包括选项）进行批判性验证。在确认陈述有效的基础上，我将推导出正确答案并评估每个提供的选项。\n\n### 问题验证\n\n**第1步：提取已知信息**\n\n*   **试验设计：** 随机、多中心肿瘤学试验。\n*   **比较：** 研究性疗法与对照组。\n*   **终点：** 总生存期。\n*   **随机化：** 在中心内进行 $1:1$ 随机化。\n*   **样本量：** $n=800$ 名参与者。\n*   **中心数量：** $J=20$。\n*   **删失：** 在 $T_{\\max}=24$ 个月时进行管理性删失。\n*   **事件数：** 观测到的事件数 $E \\approx 480$。\n*   **中心异质性：** 中心特异性基线风险相差可达 $3$ 倍。\n*   **交互作用假设：** 没有临床理由支持治疗与中心的交互作用。\n*   **变量定义：**\n    *   $T$: 生存时间。\n    *   $X$: 基线协变量向量，包括治疗 $A \\in \\{0,1\\}$。\n    *   $Z$: 中心的分类指示变量。\n*   **模型定义：**\n    *   风险函数：$h(t \\mid X)$。\n    *   比例风险 (PH) 模型：$h(t \\mid X)=h_{0}(t)\\exp\\{\\beta^{\\top}X\\}$。\n    *   按 $Z$ 分层的 Cox 模型：基线风险 $h_{0j}(t)$ 按分层 $j$ 变化，而系数 $\\beta$ 保持共同。\n*   **诊断结果（治疗A违反PH假设）：**\n    *   缩放后的 Schoenfeld 残差随时间呈单调趋势。\n    *   对 $A$ 的 PH 假设的全局检验得出 $p0.001$。\n    *   估计的风险比 (HR) 函数是时变的：早期 $t$ 时 HR $1$，在 $t \\approx 6$ 个月时交叉至 $1$ 以下，然后下降，表明存在延迟的治疗效果（风险交叉）。\n    *   使用晚期事件权重的加权对数秩检验比标准对数秩检验更敏感。\n*   **分析目标：**\n    1.  为临床指南提供单一、稳健且易于沟通的汇总度量。\n    2.  忠实地描述时变效应。\n    3.  调整中心以解决基线风险异质性。\n    4.  避免为中心估计高维度的讨厌参数。\n    5.  保持统计效率。\n\n**第2步：使用提取的已知信息进行验证**\n\n*   **科学依据：** 该问题描述了肿瘤学领域一个标准的临床试验情景。所有统计概念（随机化、删失、Cox模型、比例风险、Schoenfeld残差、分层分析、对数秩检验、限制性平均生存时间、加速失效时间模型）都是生物统计学中的既定原则。非比例、风险交叉现象是现代肿瘤学试验中一个有据可查且至关重要的问题，尤其是在免疫治疗中。该问题牢固地植根于科学和统计实践。\n*   **问题的适定性：** 任务是从一组选项中选择最佳的统计分析框架，以在面对特定数据挑战（风险交叉）时，平衡多个明确陈述且现实的目标（稳健的总结、准确的效果描述、效率等）。这是应用统计学领域内一个适定性良好的决策理论问题。\n*   **客观性：** 问题陈述使用了精确、客观和技术性的语言。相关方的要求被列为解决方案的约束条件，而非主观意见。\n*   **完整性与一致性：** 问题是自洽的，并提供了足够的细节来评估所提出的统计策略。各种要求虽然代表了相互竞争的优先事项（例如，简单性与完整性），但在逻辑上并不矛盾，而是反映了统计分析中固有的现实世界权衡。\n*   **现实性：** 参数（$n=800$, $J=20$, $E \\approx 480$, $T_{\\max}=24$ 个月）对于一项III期肿瘤学试验来说完全是现实的。所描述的发现是合理的，并提出了一个常见但并非微不足道的挑战。\n\n**第3步：结论与行动**\n问题陈述有效。这是一个在应用生物统计学领域中表述良好、现实且科学合理的问题。我将继续进行解决方案的推导和对各选项的评估。\n\n### 解决方案推导\n\n核心挑战是治疗效果明确违反了比例风险（PH）假设，其特征是风险曲线交叉。这意味着风险比 $\\text{HR}(t)$ 不是恒定的。具体来说，该疗法在初期似乎有害（或效果不如对照组，$\\text{HR}(t)1$），而在后期变得有益（$\\text{HR}(t)1$）。在这种情况下，来自标准 Cox PH 模型的单一风险比是一个很差的汇总；它代表了 $\\log(\\text{HR}(t))$ 的加权平均值，该值可能接近于 $0$（意味着 HR 接近 $1$），从而掩盖了早期伤害和晚期获益的真实动态。\n\n因此，分析框架必须满足问题陈述中得出的几个关键标准：\n1.  **对非比例风险的稳健性：** 主要的汇总度量必须具有可解释性，并且不受非比例性的偏倚影响。\n2.  **可解释性：** 汇总度量必须是一个单一数字，易于临床医生理解并用于指南制定（例如，“获得了多少生存时间？”）。\n3.  **完整性：** 该框架还应按要求可视化或描述效应的时变性质。\n4.  **中心调整：** 必须有效地解释 $J=20$ 个中心之间基线风险的显著异质性。分层分析是实现这一目标的理想方法，因为它允许每个中心拥有自己的基线风险函数 $h_{0j}(t)$，而无需估计 $J-1$ 个额外参数，从而保持了统计功效。\n\n现在我们将根据这些标准评估每个选项。\n\n**选项 A：宣布采用按中心分层的 Cox 模型，并使用 $\\log t$ 的惩罚样条为治疗效应设置一个灵活的时变系数，以此作为唯一分析。报告时变风险比曲线及其逐点置信区间，并以随时间变化的加权平均风险比作为总结。**\n\n*   该方法正确地使用按中心分层来有效处理基线风险异质性。它还通过时变系数 $\\beta(t)$ 直接对非比例风险进行建模，满足了描述效应随时间变化的需求。\n*   然而，其提议的汇总指标——加权平均风险比——是有问题的。当 $\\text{HR}(t)$ 交叉 $1$ 时，任何平均值都可能具有高度误导性。例如，平均 HR 可能为 $1.0$，表明没有效果，但却隐藏了显著的早期伤害和晚期获益。权重的选择也是任意的，并且会影响结果。这未能满足稳健且易于沟通的汇总指标的标准。\n*   **结论：不正确。** 虽然它正确地模拟了时变效应并按中心进行了分层，但提议的汇总指标在风险交叉情景下不稳健且难以解释。\n\n**选项 B：预先指定在 $\\tau=24$ 个月时的限制性平均生存时间作为主要待估量，并报告治疗组间经调整的限制性平均生存时间差异，使用包含中心以提高效率的协变量调整方法（例如，基于伪观察值的回归）。同时，辅以按中心分层的 Cox 模型，并为治疗效应设置一个灵活的时变系数，以展示和检验时变效应。在揭盲前，需承诺时间范围 $\\tau$ 和平滑自由度。**\n\n*   该选项提议将限制性平均生存时间（RMST）的差异作为主要汇总指标。直到时间范围 $\\tau$ 的 RMST 是生存曲线 $S(t)$ 从 $0$ 到 $\\tau$ 下的面积，即 $\\text{RMST}(\\tau) = \\int_0^\\tau S(t) dt$。治疗组间的 RMST 差异 $\\Delta(\\tau)$ 具有直接且非常直观的临床解释：在时间 $\\tau$ 之前，因治疗平均获得（或损失）的生存时间。该待估量不依赖于 PH 假设，并且对风险交叉具有稳健性。\n*   将时间范围 $\\tau=24$ 个月设置为与最大管理随访时间 $T_{\\max}$ 一致是合适的，这确保了所有观测数据都对估计有贡献。\n*   它通过在调整后的 RMST 分析中将中心作为协变量来处理中心异质性，这种方法已知可以提高统计效率。\n*   至关重要的是，它还通过补充主要的 RMST 分析，使用一个灵活的、时变系数的 Cox 模型（按中心分层）来可视化 HR 曲线，从而满足了利益相关者的第二个要求，即忠实地描述延迟效应。\n*   这种双重方法完美地平衡了对单一稳健汇总度量的需求与对效应随时间详细刻画的需求。提及预先指定是严谨分析计划的标志。\n*   **结论：正确。** 该框架是全面的、稳健的，并直接解决了问题中所有指定的要求和约束。\n\n**选项 C：拟合一个未分层的 Cox 比例风险模型，其中只包含治疗作为协变量，并使用稳健（三明治）方差估计量来保护推断；将系数解释为平均因果风险比。不因中心进行调整，以避免过度参数化导致的效率损失。**\n\n*   这种方法存在根本性缺陷。它明知故犯地将一个设定错误的模型（PH模型）应用于有强烈非比例风险证据的数据。如对选项A的讨论，由此产生的单一 HR 是一个具有误导性的平均值。稳健方差估计量可以校正模型设定错误下的标准误，但不能修复系数估计本身的偏倚或可解释性差的问题。\n*   它明确建议不对中心进行调整。这与问题陈述中显著的中心异质性以及研究者希望进行调整的愿望相矛盾。试验采用了分层随机化，在分析中不考虑分层变量会导致效率和统计功效的损失。其理由（“避免过度参数化导致的效率损失”）是不正确的；按中心分层通过不估计中心特异性系数来*避免*过度参数化。\n*   **结论：不正确。** 该选项忽略了主要的数据现象（非比例风险），未能满足一个关键的分析目标（调整中心），并为其选择提供了错误的理由。\n\n**选项 D：为避免非比例风险带来的偏倚，按治疗进行分层，并呈现各组的 Kaplan-Meier 曲线，如果两组的中位生存期均可估计，则报告其差异。依赖目视比较进行临床解释。**\n\n*   呈现 Kaplan-Meier (K-M) 曲线是一个很好的探索性步骤，但作为最终分析则是不完整的。“按治疗进行分层”是“为每个治疗组生成K-M曲线”的不精确表述。\n*   提议的汇总度量是中位生存时间的差异。在事件率约为 $E/n \\approx 480/800 = 60\\%$ 的情况下，对照组的中位生存期（$50\\%$ 分位数）可能可以估计，但如果治疗组存在显著的晚期获益，其 中位生存期可能在 $T_{\\max}=24$ 个月内无法达到。在这种情况下，中位数无法估计，也就无法报告汇总度量。RMST（选项B）避免了这个问题，因为它对于给定的 $\\tau$ 总是可估计的。\n*   该选项未能调整中心效应，从而忽略了一个主要的异质性来源，并放弃了提高统计功效和精度的机会，而这正是一个既定目标。\n*   **结论：不正确。** 这种方法是不充分的。它未能提供一个有保证的汇总度量，并且没有执行所要求的、必要的中心调整。\n\n**选项 E：使用对数正态加速失效时间模型替换 Cox 模型，并包含中心的随机截距以捕捉异质性。报告加速因子作为主要待估量，这是一个单一的汇总数值，并使用基于似然的推断以保证效率，即使风险曲线存在交叉。**\n\n*   加速失效时间（AFT）模型是 PH 模型的一个有效替代方案。它将协变量的影响建模为时间尺度上的一个乘法因子。对数正态 AFT 模型是一个特定的参数选择。使用中心的随机截距是处理聚类的一种有效方法，类似于 Cox 模型中的分层。\n*   主要问题在于，这种方法用另一个强假设（特定的参数化 AFT 关系）取代了另一个强假设（比例风险）。问题陈述中没有证据表明 AFT 假设比 PH 假设更合适；事实上，复杂的风险交叉模式也可能违反 AFT 假设。虽然某些 AFT 模型可以产生风险交叉，但这并非其典型行为，并且单一的“加速因子”总结仍然无法捕捉治疗效果随时间发生的质变。\n*   此选项未能提供“对时变效应的忠实描述”；相反，它基于一个强烈的、未经验证的建模假设，用一个单一数字来总结效应。选项B中的 RMST 方法更优，因为它基本上是无假设的。\n*   **结论：不正确。** 该选项是一个合理但次于选项B的替代方案。它施加了一个可能被违反的强参数假设，并且未能满足描述效应时变性质的要求。\n\n**总结：**\n\n选项B提供了统计上最可靠和最完整的框架。它使用 RMST 差异作为主要待估量，该指标稳健、可解释，并且非常适合具有风险交叉的非比例风险情景。它通过灵活的图形分析来补充这个稳健的总结，以满足临床上理解治疗效果时机的需求。最后，它正确且有效地处理了数据的多中心结构。", "answer": "$$\\boxed{B}$$", "id": "4991174"}]}