## 应用与跨学科关联

### 引言

在前面的章节中，我们已经深入探讨了等[比例风险](@entry_id:166780) (Proportional Hazards, PH) 假设的定义、其在 Cox 模型中的核心地位，以及用于评估该假设的原理和机制。我们学习了如何从理论上理解风险比（Hazard Ratio）的[时间不变性](@entry_id:198838)，并掌握了以 Schoenfeld 残差为代表的一系列诊断工具。现在，我们将从“是什么”和“如何做”转向“为什么”和“在哪里用”。

本章旨在展示 PH 假设及其评估在理论之外的广泛应用和深刻的跨学科关联。我们将看到，检验 PH 假设远非一个机械的统计流程，而是通往更深入的科学洞见、更稳健的推断和更精细化模型构建的关键一步。通过一系列源于真实世界研究背景的问题，我们将探索 PH 假设的评估如何在临床医学、流行病学、因果推断和临床试验设计等多个领域发挥关键作用，揭示其在将数据转化为知识过程中的强大效用。我们的目标不是重复核心原理，而是阐明这些原理在解决复杂科学问题时的实用价值和延伸。

### 临床与流行病学研究中的核心诊断应用

在临床和流行病学研究中，Cox 等[比例风险模型](@entry_id:171806)是分析时间-事件数据的基石。因此，评估 PH 假设是确保模型有效性和结论可靠性的标准工作流程。这个过程不仅是技术性的验证，更是对效应模式的探索。

一个典型的应用场景是在回顾性队列研究中，例如，评估不同抗生素方案对结直肠手术后手术部位感染风险的影响。研究者会构建一个多变量 Cox 模型，将抗生素方案作为主要暴露，同时调整年龄、性别和合并症等混杂因素。在此模型中，PH 假设意味着某一方案相对于另一方案的瞬时感染风险（即风险比）在术后30天内的任何时间点都是恒定的。评估这一假设是得出有效结论的前提。如果 PH 假设成立，研究者便可以报告一个单一的、在整个随访期间都适用的风险比，例如，报告扩展谱抗生素使感染风险降低了28%（$HR=0.72$），从而为临床实践提供明确的指导 [@problem_id:4631691]。

评估 PH 假设最核心的工具是基于 Schoenfeld 残差的诊断。Schoenfeld 残差是在每个事件发生时间点，针对模型中的每一个协变量计算出来的。其核心思想是比较实际发生事件的个体的协变量值与在同一时间点所有处于风险集中的个体的协变量[期望值](@entry_id:150961)。如果 PH 假设成立，那么 Schoenfeld 残差序列的期望应为零，并且不随时间表现出任何系统性趋势。

实践中，最直观的诊断方法是绘制经过标度的 Schoenfeld 残差与时间（或时间的某个单调变换，如[对数时间](@entry_id:636778)或事件时间排序）的散点图，并叠加一条非参数平滑曲线（如 LOESS 或样条曲线）[@problem_id:4991130]。对这些图的解读是理解协变量效应模式的关键：
*   **平坦的趋势**：如果平滑曲线在零线附近随机波动，没有明显的上升或下降趋势，这表明数据与该协变量的 PH 假设相符。例如，在一个评估[新陈代谢疗法](@entry_id:200490)对心血管事件影响的研究中，若某生物标志物的[残差图](@entry_id:169585)呈现这种模式，则可以认为该标志物对风险的影响是随时间保持稳定的 [@problem_id:4987377]。
*   **单调的趋势**：如果平滑曲线呈现出持续上升或下降的模式，则强烈提示 PH 假设被违背。例如，在上述心血管研究中，若治疗组的[残差图](@entry_id:169585)显示出平滑曲线随时间单调递增，这表明治疗的保护效应（如果风险比小于1）可能正在减弱，或者危害效应（如果风险比大于1）正在增强。具体来说，一个随时间递增的残差趋势意味着对数风险比（log-hazard ratio）随时间增加 [@problem_id:4987377]。
*   **非单调的趋势**：平滑曲线也可能呈现出更复杂的模式，如 U 型或倒 U 型。这同样指示了非等比例风险，但效应的动态变化更为复杂。例如，一个 U 型的残差曲线可能意味着某个因素的风险在早期和晚期较高，但在中期较低 [@problem_id:4987377]。

除了图形诊断，研究者通常还会进行正式的统计检验，如 Grambsch-Therneau 检验。该检验通过[回归残差](@entry_id:163301)与时间的函数，检验其斜率是否显著不为零。一个小的 $p$ 值提供了反对 PH 假设的统计证据 [@problem_id:4631691]。在构建预后模型时，例如根据儿童急性髓系[白血病](@entry_id:152725)（AML）的[细胞遗传学](@entry_id:154940)风险分层来预测复发风险，确认 PH 假设的成立是至关重要的。只有在该假设下，我们才能放心地使用单一的风险比来量化不同风险组别（如有利、中等、不利）的相对复发风险，并基于此计算特定时间点（如2年）的无复发生存率 [@problem_id:5095557]。

### 处理非等[比例风险](@entry_id:166780)与建构时变效应模型

当诊断检验（如图形法或 Grambsch-Therneau 检验）明确指出 PH 假设被违背时，我们不应视其为分析的终点，而应将其视为一个机遇，一个深入理解协变量效应如何随时间演变的机会。此时，模型需要从标准的 Cox PH 模型扩展，以捕捉这种动态变化。

一个极具启发性的例子来自肿瘤学中微小残留病（Minimal Residual Disease, MRD）的预后价值研究。MRD 是指治疗后体内残留的极少量肿瘤细胞。在急性淋巴细胞白血病（ALL）中，快速清除 MRD 通常预示着更好的结局。然而，“快速”的效应是恒定的吗？研究发现，通过比较早期（如4周内）与晚期达到 MRD 阴性的患者的 [Kaplan-Meier](@entry_id:169317) 生存曲线，曲线可能在中[后期](@entry_id:165003)发生交叉。[曲线交叉](@entry_id:189391)是 PH 假设被违背的经典直观证据，它意味着两组的相对风险发生了逆转，这与任何单一的、恒定的风险比都不相符 [@problem_id:5133639]。

在这种情况下，有两种主要策略来处理非等[比例风险](@entry_id:166780)：

1.  **分层 Cox 模型**：如果某个分类协变量（如[细胞遗传学](@entry_id:154940)风险组）不满足 PH 假设，我们可以在该协变量的每个水平内部分别估计一个基线[风险函数](@entry_id:166593)，即对其进行“分层”。这样，模型不再假定不同层之间的风险是成比例的，但仍假定层内部其他协变量满足 PH 假设。

2.  **扩展 Cox 模型与时变系数**：一个更灵活且信息更丰富的方法是构建一个允许协变量系数随时间变化的扩展 Cox 模型。这可以通过在模型中引入协变量与时间函数的交互项来实现。[线性预测](@entry_id:180569)部分从 $\eta = \beta x$ 变为 $\eta(t) = \beta(t) x$。$\beta(t)$ 的函数形式可以预先指定，例如，$\beta(t) = \beta_1 + \beta_2 t$ 或 $\beta(t) = \beta_1 + \beta_2 \log(t)$。一种特别实用且易于解释的方法是使用分段[常数函数](@entry_id:152060)，即在预先设定的时间点 $c$ 前后，系数具有不同的值：$\beta(t) = \beta + \gamma \mathbf{1}\{t>c\}$。在这种模型下，检验 $H_0: \gamma=0$ 就等同于一个针对特定形式非等比例风险的检验 [@problem_id:4776354]。

回到 MRD 的例子，研究者可以建立一个包含时变系数 $\beta(t)$ 的模型来描述达到 MRD 阴性状态的效应。实证研究结果可能显示，达到 MRD 阴性状态的风险比 $e^{\beta(t)}$ 在早期（如第12周）非常小（例如，约0.35），意味着一个强大的保护效应；但随着时间推移，该风险比逐渐向1.0靠近（例如，在第52周时约为0.90）。这种模式的解读极具临床意义：早期清除 MRD 带来的生存优势主要体现在随访的早期，而随着时间的推移，这种优势会逐渐减弱。这种对效应动态的精确刻画，远比一个被平均化的、可能具有误导性的单一风险比更有价值 [@problem_id:5133639]。此外，为了避免在分析中引入“永生时间偏倚”（immortal time bias），即错误地将被观察到的事件（如达到 MRD 阴性）发生前必须存活的时间归因于该事件的保护效应，可以使用时变协变量或地标分析（landmark analysis）等方法进行妥善处理 [@problem_id:5133639]。

### 前沿应用与跨学科领域

PH 假设的评估不仅在标准生存分析中至关重要，其理念和方法也延伸到更为复杂和前沿的[统计模型](@entry_id:755400)中，连接了生物统计学、流行病学和因果推断等多个领域。

#### [竞争风险分析](@entry_id:634319)

在许多医学研究中，患者可能经历多种不同类型的终点事件，这些事件相互排斥，一个事件的发生会阻止其他事件的发生。这被称为“竞争风险”情境。例如，在慢性肾病患者的队列中，我们可能关心发生“开始透析”、“心血管死亡”或“非心血管死亡”的风险 [@problem_id:4991144]。

在这种情况下，有两种主流的建模策略，而 PH 假设在每种策略中都有着不同但均至关重要的意义：

1.  **原因别风险 (Cause-Specific Hazard, CSH) 模型**：这是分析竞争风险数据最直接的方法。对于每一种失败原因 $k$，我们定义一个原因别风险函数 $h_k(t \mid X)$，它表示在时间 $t$ 之前未发生任何事件的条件下，在 $t$ 时刻发生原因 $k$ 事件的[瞬时速率](@entry_id:182981)。我们可以为每一种原因分别拟合一个独立的 Cox 模型。在拟合原因 $k$ 的模型时，所有其他原因的事件以及删失都被视为删失事件。然后，我们可以像在标准 Cox 模型中一样，为每个原因别模型单独评估其 PH 假设。例如，我们可以使用 Schoenfeld 残差检验来评估某个治疗对心血管死亡风险的影响是否随时间恒定，同时独立地评估其对非心血管死亡风险的影响是否恒定 [@problem_id:4991131] [@problem_id:4991144]。

2.  **子分布风险 (Subdistribution Hazard, SDH) 模型 (Fine-Gray 模型)**：这种模型的目标是直接对累积发生率函数 (Cumulative Incidence Function, CIF) 建模，即到时间 $t$ 为止因特定原因 $k$ 而失败的概率。Fine-Gray 模型定义了一个不同的风险集：对于原因 $k$ 的分析，已发生竞争事件的个体仍然保留在风险集中。因此，SDH 模型也有其自身的 PH 假设，即子分布风险比随时间恒定。

一个至关重要的概念性区别是：**在一个原因别风险模型中满足 PH 假设，并不意味着在子分布风险模型中也满足 PH 假设，反之亦然** [@problem_id:4991154]。这是因为子分布风险不仅依赖于目标原因的风险，还依赖于所有竞争原因的风险。一个协变量对不同原因的影响模式的复杂交互，可能导致即使所有原因别风险比都恒定，子分布风险比却是时变的。因此，研究者必须根据其研究问题（是关于事件的病因学机制，还是关于事件的绝对发生概率）选择合适的模型，并针对所选模型评估其特定的 PH 假设。例如，可以采用为 Fine-Gray 模型定制的 Schoenfeld 型残差或时变交互项来检验子分布风险的等比例性 [@problem_id:4579849]。

#### 聚[类数](@entry_id:156164)据与[未观测异质性](@entry_id:142880)

在许多研究中，数据天然地呈现聚类结构，例如，来自多个医疗中心的临床试验数据，或来自不同家庭的遗传学研究数据。同一聚类内的个体可能因为共享某些未被测量的环境或遗传因素而具有相似的风险，这种现象称为“[未观测异质性](@entry_id:142880)”。

这种异质性对 PH 假设的评估带来了深刻的挑战。一个关键的洞见是，**即使在给定未观测因素（称为“脆弱性”，frailty）的条件下，每个个体的风险是成比例的，但在忽略这些因素、直接分析整个群体的边际模型时，观察到的风险比也可能表现出非等比例性** [@problem_id:4991160]。这是一种“伪”非等比例性，它源于[群体选择](@entry_id:175784)效应：随着时间推移，那些天生具有高脆弱性的个体更早地发生事件并从风险集中移除，导致剩下的人群主要是低脆弱性个体，从而改变了群体的平均风险，使得边际风险比随时间变化。

处理这个问题同样有两种主要途径：
1.  **脆弱性模型 (Frailty Models)**：这是一种条件方法，通过在 Cox 模型中加入一个代表聚类特异性随机效应的“脆弱性”项来明确地对[未观测异质性](@entry_id:142880)建模。模型变为 $h(t \mid x, u_c) = h_0(t) \exp(x^\top\beta + u_c)$，其中 $u_c$ 是第 $c$ 个聚类的随机效应。
2.  **边际模型与[稳健标准误](@entry_id:146925)**：这是一种群体平均方法，它拟合一个标准的 Cox 模型，但在进行[统计推断](@entry_id:172747)时，使用聚类稳健的“三明治”方差估计量来修正[标准误](@entry_id:635378)，以解释聚类内部的相关性。当采用这种方法时，对 PH 假设的诊断也必须进行相应调整。具体来说，Grambsch-Therneau 检验本质上是一个回归分析，由于其“因变量”（Schoenfeld 残差）在聚类内部是相关的，因此必须使用聚类稳健的标准误来检验斜率的显著性，以获得有效的 $p$ 值并控制 I 型错误 [@problem_id:4991138]。

#### 时变协变量与因果推断

协变量本身也可能随时间变化，这为 PH 模型的应用和解释带来了新的维度。我们需要严格区分两种类型的时变协变量（Time-Dependent Covariates, TDCs）：

*   **外部 (External) TDCs**：这类协变量的路径不受研究个体健康状况或事件发生的影响。一个典型的例子是环境暴露，如每日的空气污染指数。这类协变量可以相对直接地纳入 Cox 模型，而对其他基线协变量的 PH 假设的评估仍然有效 [@problem_id:4991183]。

*   **内部 (Internal) TDCs**：这类协变量的测量值或测量过程本身就受到个体内部健康状态演变的影响。例如，根据患者病情严重程度而安排的生物标志物检测。天真地将这类内部 TDCs 纳入 Cox 模型（如使用“末次观测值结转”法）会引入严重的偏倚，因为协变量的值与事件风险之间存在复杂的反馈循环。妥善处理内部 TDCs 将 PH 假设的议题与更广阔的因果推断领域联系起来，通常需要联合模型（joint models）或边际结构模型（marginal structural models）等更高级的方法 [@problem_id:4991183]。

### 验证性临床试验背景下的等比例风险

在为新药或新疗法寻求监管批准的验证性（III期）临床试验中，对统计分析的所有方面进行严格的预先规定是控制 I 型错误（即错误地宣称无效药有效）和确保试验完整性的最高原则。这就给如何处理潜在的非等比例风险带来了巨大的挑战。

一个常见的、但有严重缺陷的做法是“见机行事”：首先对数据进行 PH 检验，如果检验不显著，就使用标准 Cox 模型；如果显著，则切换到另一个模型（如[分层模型](@entry_id:274952)或包含时变效应的模型）。这种数据驱动的[模型选择](@entry_id:155601)过程会破坏预先设定的 I 型错误率，因为最终的检验统计量及其[零分布](@entry_id:195412)依赖于模型选择的结果，而这并未在计算 $p$ 值时得到恰当的考虑。

因此，一个健全的、符合监管要求的统计分析计划（Statistical Analysis Plan, SAP）必须采用更为稳健的策略。目前业界推崇的最佳实践是**将主要疗效[假设检验](@entry_id:142556)与效应模式的估计分离开来**。

一个优秀的方案会预先指定一个对 PH 假设不敏感的、稳健的**主要检验**。例如，可以采用所谓的“最大组合检验”（MaxCombo test），它同时考虑多个加权对数秩检验（weighted log-rank tests），包括对早期差异敏感的、对晚期差异敏感的以及标准[对数秩检验](@entry_id:168043)。通过计算这些检验统计量的最大值，并根据其联合[零分布](@entry_id:195412)确定一个临界值，该组合检验在保持 I 型错误率的同时，对各种可能的风险比模式（包括等比例和非等比例）都具有良好的统计功效 [@problem_id:4991178]。

在这个框架下，PH 诊断（如 Schoenfeld [残差图](@entry_id:169585)和检验）的角色发生了变化。它们不再是决定主要分析方法的“守门员”，而是被预先规定为**描述性和支持性分析**。其目的是为了更好地理解和解释治疗效应的性质。分析计划可以这样预设：
*   主要疗效结论完全基于预先设定的稳健检验（如 MaxCombo 检验）的结果。
*   在估计治疗效果时，如果 PH 诊断检验不显著（例如，$p > 0.10$），则报告来自标准 Cox 模型的单一风险比及其[置信区间](@entry_id:138194)。
*   如果 PH 诊断检验显著，则报告一个预先规定好的时变效应模型的结果，例如，在基于临床里程碑（而非数据驱动）固定的时间区间内，报告分段的风险比。

这种方法将[假设检验](@entry_id:142556)的严谨性与效应估计的灵活性和科学合理性完美结合，确保了验证性试验的统计学诚信 [@problem_id:4991178]。

### 结论

本章的旅程从临床研究的核心应用开始，逐步深入到竞争风险、聚[类数](@entry_id:156164)据和验证性临床试验等复杂和前沿的领域。我们看到，对等[比例风险假设](@entry_id:163597)的评估远不止是一项技术性的模型检查。它是一个强大的科学探索工具。当 PH 假设成立时，它为我们提供了简洁、有力的效应总结；当它被违背时，它又为我们揭示了效应随时间动态变化的宝贵信息，促使我们建立更精细、更符合现实的模型。

从流行病学中的预后模型构建，到[竞争风险](@entry_id:173277)框架下对不同[模型选择](@entry_id:155601)的深刻理解，再到处理聚类数据和时变协变量时的统计挑战，乃至在药物研发的最终阶段确保科学结论的严谨性，PH 假设的评估始终处于核心地位。掌握其应用与跨学科关联，意味着我们不仅能够正确地使用[统计模型](@entry_id:755400)，更能利用它们来讲述关于生命过程、疾病进展和干预效果的更完整、更动态的科学故事。