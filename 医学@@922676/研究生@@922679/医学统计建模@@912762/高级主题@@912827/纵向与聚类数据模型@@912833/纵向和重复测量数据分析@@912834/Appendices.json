{"hands_on_practices": [{"introduction": "在深入研究复杂的纵向模型之前，理解统计效率的基本原理至关重要。本练习通过对比协方差分析（ANCOVA）和差值分析这两种基础方法，揭示了为何在临床试验中调整基线测量值通常能在统计上获得更优的效能。通过推导其相对效率[@problem_id:4951173]，您将掌握评估和选择重复测量数据分析策略的核心考量。", "problem": "考虑一项随机平行分组临床试验，该试验有 $2$ 个组，每组样本量为 $n$，对每位受试者在基线（$Y_{0}$）和单次治疗后随访（$Y_{1}$）时测量一个连续生物标志物。假设如下：\n\n- 受试者是独立同分布且随机化的，因此治疗指示变量 $X \\in \\{0,1\\}$ 与所有基线协变量（包括 $Y_{0}$）无关。\n- 对 $(Y_{0}, Y_{1})$ 服从二元正态分布，其边际方差 $\\operatorname{Var}(Y_{0}) = \\sigma_{0}^{2}$、$\\operatorname{Var}(Y_{1}) = \\sigma_{1}^{2}$ 和相关系数 $\\rho = \\operatorname{Corr}(Y_{0}, Y_{1})$ 在组间不变。治疗对 $Y_{1}$ 具有加性效应，且不改变这些方差或 $\\rho$。\n- 组内满足同方差性，并且除了因治疗导致的 $Y_{1}$ 均值外，所有量在两个组之间都是相同的。\n\n考虑使用两种分析策略来估计对 $Y_{1}$ 的平均治疗效应：\n\n$1.$ 差值分析法：为每位受试者计算 $D = Y_{1} - Y_{0}$，并将 $D$ 的组均值之差作为治疗效应的估计。\n\n$2.$ 协方差分析 (ANCOVA)：将 $Y_{1}$ 对治疗指示变量 $X$ 和基线 $Y_{0}$ 进行回归，并使用 $X$ 的系数作为治疗效应的估计量。\n\n将 ANCOVA 相对于差值分析法的效率增益定义为差值分析估计量的大样本方差与 ANCOVA 估计量的大样本方差之比。在上述假设下，推导这个效率增益，结果应为一个用 $\\sigma_{0}^{2}$、$\\sigma_{1}^{2}$ 和 $\\rho$ 表示的闭式解析表达式。将最终答案表示为单个解析表达式。不需要数值近似或四舍五入，最终答案中不应包含单位。", "solution": "用户希望推导在随机临床试验中，用于估计治疗效应的协方差分析（ANCOVA）模型相对于差值分析法的效率增益。效率增益被定义为差值分析估计量的大样本方差与 ANCOVA 估计量的大样本方差之比。\n\n首先验证该问题，以确保其具有科学依据、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n- 一项随机平行分组临床试验，有 $2$ 个组，每组样本量为 $n$。\n- 在基线（$Y_{0}$）和一次治疗后随访（$Y_{1}$）时测量一个连续生物标志物。\n- 治疗指示变量为 $X \\in \\{0,1\\}$。随机化意味着 $X$ 与 $Y_{0}$ 无关。\n- 对 $(Y_{0}, Y_{1})$ 服从二元正态分布。\n- 边际方差在组间不变：$\\operatorname{Var}(Y_{0}) = \\sigma_{0}^{2}$ 和 $\\operatorname{Var}(Y_{1}) = \\sigma_{1}^{2}$。\n- 相关系数在组间不变：$\\rho = \\operatorname{Corr}(Y_{0}, Y_{1})$。\n- 治疗对 $Y_{1}$ 具有加性效应，且不改变方差或相关系数。\n- 策略 1：对 $D = Y_{1} - Y_{0}$ 进行差值分析。估计量是 $D$ 的组均值之差。\n- 策略 2：ANCOVA，将 $Y_{1}$ 对 $X$ 和 $Y_{0}$ 进行回归。估计量是 $X$ 的系数。\n- 目标：推导效率增益，定义为 $\\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) / \\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是临床试验统计分析中的一个标准经典问题。诸如二元正态性、同方差性和加性治疗效应等假设，是用于比较不同估计量统计特性的常见理想化假设。问题是自洽的，提供了推导所需表达式的所有必要信息。语言精确客观，没有科学或逻辑上的缺陷、矛盾或歧义。\n\n### 步骤 3：结论与行动\n该问题是**有效**的。将提供一个完整且论证充分的解答。\n\n### 效率增益的推导\n\n推导过程分为三个部分：首先，我们求出差值分析估计量的大样本方差；其次，我们求出 ANCOVA 估计量的大样本方差；第三，我们计算它们的比率。\n\n**1. 差值分析估计量（$\\hat{\\tau}_{\\text{CS}}$）的方差**\n\n每位受试者 $i$ 的差值定义为 $D_i = Y_{1i} - Y_{0i}$。治疗效应通过治疗组（$X=1$）和对照组（$X=0$）之间平均差值的差异来估计：\n$$ \\hat{\\tau}_{\\text{CS}} = \\bar{D}_1 - \\bar{D}_0 = \\frac{1}{n} \\sum_{i:X_i=1} D_i - \\frac{1}{n} \\sum_{i:X_i=0} D_i $$\n由于随机化，两组是独立的，因此估计量的方差是两个样本均值方差之和：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\operatorname{Var}(\\bar{D}_1) + \\operatorname{Var}(\\bar{D}_0) $$\n鉴于每组大小为 $n$ 的受试者是独立同分布的，我们有：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\frac{\\operatorname{Var}(D | X=1)}{n} + \\frac{\\operatorname{Var}(D | X=0)}{n} $$\n问题陈述方差在组间是不变的。这意味着差值 $D$ 的方差在两组中是相同的：$\\operatorname{Var}(D | X=1) = \\operatorname{Var}(D | X=0) = \\operatorname{Var}(D)$。因此：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\frac{2}{n} \\operatorname{Var}(D) $$\n差值 $D$ 的方差为：\n$$ \\operatorname{Var}(D) = \\operatorname{Var}(Y_1 - Y_0) = \\operatorname{Var}(Y_1) + \\operatorname{Var}(Y_0) - 2 \\operatorname{Cov}(Y_1, Y_0) $$\n使用给定的参数 $\\operatorname{Var}(Y_0) = \\sigma_0^2$、$\\operatorname{Var}(Y_1) = \\sigma_1^2$ 以及相关系数的定义 $\\operatorname{Cov}(Y_1, Y_0) = \\rho \\sqrt{\\operatorname{Var}(Y_0)\\operatorname{Var}(Y_1)} = \\rho \\sigma_0 \\sigma_1$，我们得到：\n$$ \\operatorname{Var}(D) = \\sigma_1^2 + \\sigma_0^2 - 2 \\rho \\sigma_0 \\sigma_1 $$\n将此代回，差值分析估计量的大样本方差为：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\frac{2}{n} (\\sigma_0^2 + \\sigma_1^2 - 2 \\rho \\sigma_0 \\sigma_1) $$\n\n**2. ANCOVA 估计量（$\\hat{\\tau}_{\\text{ANCOVA}}$）的方差**\n\nANCOVA 模型是一个多元线性回归模型：\n$$ Y_{1i} = \\beta_0 + \\tau_{\\text{ANCOVA}} X_i + \\beta_1 Y_{0i} + \\epsilon_i $$\n估计量 $\\hat{\\tau}_{\\text{ANCOVA}}$ 是治疗指示变量 $X_i$ 系数的普通最小二乘（OLS）估计。回归系数的大样本方差可以使用 Frisch-Waugh-Lovell 定理求得。$\\hat{\\tau}_{\\text{ANCOVA}}$ 的方差由下式给出：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}}) = \\frac{\\sigma_\\epsilon^2}{\\sum_{i=1}^{2n} \\tilde{X}_i^2} $$\n其中 $\\sigma_\\epsilon^2 = \\operatorname{Var}(\\epsilon_i) = \\operatorname{Var}(Y_1 | X, Y_0)$ 是残差方差，$\\tilde{X}_i$ 是将 $X_i$ 对模型中其他协变量（在此情况下是截距项和 $Y_{0i}$）进行回归所得的残差。\n\n首先，我们确定分母 $\\sum \\tilde{X}_i^2$。由于受试者被随机分配到治疗组，因此 $X_i$ 与基线测量值 $Y_{0i}$ 无关。因此，当 $n$ 很大时，$X_i$ 对 $Y_{0i}$ 的回归得到的斜率趋于零。残差可简化为 $\\tilde{X}_i \\approx X_i - \\bar{X}$。\n总样本量为 $2n$，每组有 $n$ 名受试者。治疗指示变量的均值为 $\\bar{X} = \\frac{n \\cdot 1 + n \\cdot 0}{2n} = \\frac{1}{2}$。残差平方和为：\n$$ \\sum_{i=1}^{2n} \\tilde{X}_i^2 \\approx \\sum_{i=1}^{2n} (X_i - \\bar{X})^2 = n \\left(1 - \\frac{1}{2}\\right)^2 + n \\left(0 - \\frac{1}{2}\\right)^2 = n \\left(\\frac{1}{4}\\right) + n \\left(\\frac{1}{4}\\right) = \\frac{n}{2} $$\n接下来，我们确定分子 $\\sigma_\\epsilon^2$。这是在给定 $X$ 和 $Y_0$ 条件下 $Y_1$ 的方差。由于治疗效应是纯粹加性的，对 $X$ 取条件不会比仅对 $Y_0$ 取条件进一步减小方差。因此，$\\sigma_\\epsilon^2 = \\operatorname{Var}(Y_1 | Y_0)$。对于二元正态分布，条件方差由下式给出：\n$$ \\operatorname{Var}(Y_1 | Y_0) = \\operatorname{Var}(Y_1) (1 - \\operatorname{Corr}(Y_0, Y_1)^2) $$\n代入给定的参数 $\\operatorname{Var}(Y_1) = \\sigma_1^2$ 和 $\\operatorname{Corr}(Y_0, Y_1) = \\rho$：\n$$ \\sigma_\\epsilon^2 = \\sigma_1^2 (1 - \\rho^2) $$\n结合分子和分母，ANCOVA 估计量的大样本方差为：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}}) = \\frac{\\sigma_1^2 (1 - \\rho^2)}{n/2} = \\frac{2 \\sigma_1^2 (1 - \\rho^2)}{n} $$\n\n**3. 效率增益**\n\nANCOVA 相对于差值分析法的效率增益是它们方差的比率：\n$$ \\text{Efficiency Gain} = \\frac{\\operatorname{Var}(\\hat{\\tau}_{\\text{CS}})}{\\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}})} $$\n代入上面推导出的表达式：\n$$ \\text{Efficiency Gain} = \\frac{\\frac{2}{n} (\\sigma_0^2 + \\sigma_1^2 - 2 \\rho \\sigma_0 \\sigma_1)}{\\frac{2}{n} \\sigma_1^2 (1 - \\rho^2)} $$\n消去公因子 $\\frac{2}{n}$ 得到最终表达式：\n$$ \\text{Efficiency Gain} = \\frac{\\sigma_0^2 + \\sigma_1^2 - 2 \\rho \\sigma_0 \\sigma_1}{\\sigma_1^2 (1 - \\rho^2)} $$\n该表达式表示，在指定假设下，与差值分析法相比，使用 ANCOVA 时治疗效应估计量方差减小的倍数。", "answer": "$$\n\\boxed{\\frac{\\sigma_{0}^{2} + \\sigma_{1}^{2} - 2 \\rho \\sigma_{0} \\sigma_{1}}{\\sigma_{1}^{2} (1 - \\rho^{2})}}\n$$", "id": "4951173"}, {"introduction": "在拟合了像线性混合模型（LMM）这样的纵向模型后，研究者需要检验关于随时间变化的具体假设。本练习提供了构建和计算沃尔德（Wald）检验统计量的实践经验，用于检验关于固定效应的联合假设[@problem_id:4951162]。掌握这项技能对于从模型输出中提取有意义的科学结论至关重要。", "problem": "考虑一项针对原发性高血压成年人的纵向研究，其中在四次门诊随访中测量收缩压：基线 ($t_{0}$)、4周 ($t_{1}$)、12周 ($t_{2}$) 和 24周 ($t_{3}$)。将一个带有受试者特定随机截距和访视特定固定效应的线性混合模型 (LMM) 拟合到重复测量数据中。设访视特定固定效应均值的向量为 $\\beta = (\\mu_{0}, \\mu_{1}, \\mu_{2}, \\mu_{3})^{T}$，表示每次访视的群体平均收缩压。在LMM中最大似然估计的标准正则性条件下，广义最小二乘 (GLS) 估计量 $\\hat{\\beta}$ 近似服从多元正态分布，其均值为 $\\beta$，协方差矩阵为 $\\widehat{\\text{Var}}(\\hat{\\beta})$。\n\n假设拟合模型得到的固定效应估计值为\n$$\n\\hat{\\beta} = \\begin{pmatrix} 132.0 \\\\ 128.5 \\\\ 127.0 \\\\ 125.5 \\end{pmatrix},\n$$\n以及 $\\hat{\\beta}$ 的一个估计协方差矩阵，该矩阵具有合理的复合对称结构，\n$$\n\\widehat{\\text{Var}}(\\hat{\\beta}) = \\begin{pmatrix}\n0.49  0.22  0.22  0.22 \\\\\n0.22  0.49  0.22  0.22 \\\\\n0.22  0.22  0.49  0.22 \\\\\n0.22  0.22  0.22  0.49\n\\end{pmatrix}.\n$$\n\n您有兴趣同时检验从基线开始的早期变化是否为零，以及从12周到24周的晚期变化是否为零，即联合原假设 $H_{0}: \\mu_{1} - \\mu_{0} = 0$ 且 $\\mu_{3} - \\mu_{2} = 0$。\n\n仅使用 $\\hat{\\beta}$ 近似服从多元正态分布以及多元正态向量的线性函数也服从多元正态分布这两个基本事实，执行以下操作：\n\n- 构建将 $\\beta$ 映射到两个差值 $(\\mu_{1} - \\mu_{0}, \\mu_{3} - \\mu_{2})^{T}$ 的对比矩阵 $C$。\n- 从第一性原理出发，推导针对一般线性假设 $H_{0}$ 的相应 Wald 检验统计量。\n- 使用所提供的 $\\hat{\\beta}$ 和 $\\widehat{\\text{Var}}(\\hat{\\beta})$ 计算此 Wald 检验统计量的数值。\n\n将您的最终数值答案四舍五入到四位有效数字。答案中不要报告任何单位。", "solution": "该问题被评估为具有科学依据、提法明确、客观，并包含唯一解所需的所有必要信息。因此，该问题被认定为有效。\n\n该问题要求构建一个对比矩阵，推导一个 Wald 检验统计量，并针对线性混合模型 (LMM) 的固定效应的联合原假设进行计算。\n\n固定效应参数估计的向量为 $\\hat{\\beta}$，它近似服从多元正态分布，均值为 $\\beta$，估计协方差矩阵为 $\\widehat{\\text{Var}}(\\hat{\\beta}) = \\hat{V}$。\n$$\n\\hat{\\beta} \\sim \\mathcal{N}(\\beta, \\hat{V})\n$$\n其中\n$$\n\\hat{\\beta} = \\begin{pmatrix} 132.0 \\\\ 128.5 \\\\ 127.0 \\\\ 125.5 \\end{pmatrix}, \\quad \\hat{V} = \\widehat{\\text{Var}}(\\hat{\\beta}) = \\begin{pmatrix}\n0.49  0.22  0.22  0.22 \\\\\n0.22  0.49  0.22  0.22 \\\\\n0.22  0.22  0.49  0.22 \\\\\n0.22  0.22  0.22  0.49\n\\end{pmatrix}\n$$\n参数向量为 $\\beta = (\\mu_0, \\mu_1, \\mu_2, \\mu_3)^T$。感兴趣的联合原假设为：\n$$\nH_0: \\mu_1 - \\mu_0 = 0 \\quad \\text{and} \\quad \\mu_3 - \\mu_2 = 0\n$$\n\n这是一个形如 $H_0: C\\beta = \\mathbf{0}$ 的一般线性假设，其中 $C$ 是一个对比矩阵，$\\mathbf{0}$ 是一个零向量。\n\n**1. 构建对比矩阵 $C$**\n\n目标是定义一个矩阵 $C$，它将参数向量 $\\beta$ 转换为由两个指定的差值组成的向量。\n$$\nC\\beta = \\begin{pmatrix} \\mu_1 - \\mu_0 \\\\ \\mu_3 - \\mu_2 \\end{pmatrix}\n$$\n我们可以明确地写出这个变换：\n$$\n\\begin{pmatrix} \\mu_1 - \\mu_0 \\\\ \\mu_3 - \\mu_2 \\end{pmatrix} = \\begin{pmatrix} (-1)\\mu_0 + (1)\\mu_1 + (0)\\mu_2 + (0)\\mu_3 \\\\ (0)\\mu_0 + (0)\\mu_1 + (-1)\\mu_2 + (1)\\mu_3 \\end{pmatrix}\n$$\n这直接给出了对比矩阵 $C$ 的行。第一行对应于第一个对比的 $(\\mu_0, \\mu_1, \\mu_2, \\mu_3)$ 的系数，第二行对应于第二个对比的系数。\n$$\nC = \\begin{pmatrix}\n-1  1  0  0 \\\\\n0  0  -1  1\n\\end{pmatrix}\n$$\n这是一个 $2 \\times 4$ 矩阵，它正确地将 $4 \\times 1$ 的向量 $\\beta$ 映射到一个 $2 \\times 1$ 的对比向量。\n\n**2. 推导 Wald 检验统计量**\n\n推导过程基于一个基本事实：多元正态随机向量的线性变换仍然是多元正态随机向量。\n我们从估计量 $\\hat{\\beta}$ 的近似分布开始：\n$$\n\\hat{\\beta} \\sim \\mathcal{N}(\\beta, V)\n$$\n其中 $V = \\text{Var}(\\hat{\\beta})$。\n感兴趣的线性变换由对比矩阵 $C$ 定义。让我们考虑随机向量 $C\\hat{\\beta}$ 的分布。\n$C\\hat{\\beta}$ 的期望是：\n$$\nE[C\\hat{\\beta}] = C E[\\hat{\\beta}] = C\\beta\n$$\n$C\\hat{\\beta}$ 的协方差矩阵由三明治公式给出：\n$$\n\\text{Var}(C\\hat{\\beta}) = C \\text{Var}(\\hat{\\beta}) C^T = CVC^T\n$$\n因此，估计的对比的分布是：\n$$\nC\\hat{\\beta} \\sim \\mathcal{N}(C\\beta, CVC^T)\n$$\n在原假设 $H_0: C\\beta = \\mathbf{0}$ 下，分布简化为：\n$$\nC\\hat{\\beta} \\sim \\mathcal{N}(\\mathbf{0}, CVC^T)\n$$\n对于一个 $q$ 维随机向量 $X \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma)$，其二次型 $X^T \\Sigma^{-1} X$ 服从自由度为 $q$ 的卡方分布，即 $X^T \\Sigma^{-1} X \\sim \\chi^2_q$。\n将此定理应用于我们的情况，我们设 $X = C\\hat{\\beta}$ 和 $\\Sigma = CVC^T$。维度 $q$ 是对比的数量（$C$ 的行数），即 $q=2$。\n因此，Wald 检验统计量 $W$ 是二次型：\n$$\nW = (C\\hat{\\beta})^T (CVC^T)^{-1} (C\\hat{\\beta})\n$$\n在实践中，真实的协方差矩阵 $V$ 是未知的，并由其一致估计量 $\\hat{V} = \\widehat{\\text{Var}}(\\hat{\\beta})$ 代替。得到的检验统计量是：\n$$\nW = (C\\hat{\\beta})^T (C\\hat{V}C^T)^{-1} (C\\hat{\\beta}) \\sim \\chi^2_q\n$$\n这就是针对线性假设 $H_0: C\\beta = \\mathbf{0}$ 的 Wald 统计量的一般公式。\n\n**3. 计算 Wald 检验统计量的数值**\n\n我们现在使用所提供的数据计算 $W$ 的值。\n\n首先，计算估计的对比向量 $C\\hat{\\beta}$：\n$$\nC\\hat{\\beta} = \\begin{pmatrix} -1  1  0  0 \\\\ 0  0  -1  1 \\end{pmatrix} \\begin{pmatrix} 132.0 \\\\ 128.5 \\\\ 127.0 \\\\ 125.5 \\end{pmatrix} = \\begin{pmatrix} 128.5 - 132.0 \\\\ 125.5 - 127.0 \\end{pmatrix} = \\begin{pmatrix} -3.5 \\\\ -1.5 \\end{pmatrix}\n$$\n\n接下来，计算估计的对比的协方差矩阵 $\\Sigma_C = C\\hat{V}C^T$：\n$$\n\\Sigma_C = \\begin{pmatrix} -1  1  0  0 \\\\ 0  0  -1  1 \\end{pmatrix} \\begin{pmatrix}\n0.49  0.22  0.22  0.22 \\\\\n0.22  0.49  0.22  0.22 \\\\\n0.22  0.22  0.49  0.22 \\\\\n0.22  0.22  0.22  0.49\n\\end{pmatrix} \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 0  -1 \\\\ 0  1 \\end{pmatrix}\n$$\n第一个对比 $(\\mu_1 - \\mu_0)$ 的方差是 $\\Sigma_C$ 的 $(1,1)$ 元素：\n$$\n\\text{Var}(\\hat{\\mu}_1 - \\hat{\\mu}_0) = \\text{Var}(\\hat{\\mu}_1) + \\text{Var}(\\hat{\\mu}_0) - 2\\text{Cov}(\\hat{\\mu}_1, \\hat{\\mu}_0) = 0.49 + 0.49 - 2(0.22) = 0.98 - 0.44 = 0.54\n$$\n第二个对比 $(\\mu_3 - \\mu_2)$ 的方差是 $\\Sigma_C$ 的 $(2,2)$ 元素：\n$$\n\\text{Var}(\\hat{\\mu}_3 - \\hat{\\mu}_2) = \\text{Var}(\\hat{\\mu}_3) + \\text{Var}(\\hat{\\mu}_2) - 2\\text{Cov}(\\hat{\\mu}_3, \\hat{\\mu}_2) = 0.49 + 0.49 - 2(0.22) = 0.98 - 0.44 = 0.54\n$$\n两个对比之间的协方差是 $\\Sigma_C$ 的 (1,2) 和 (2,1) 元素：\n$$\n\\text{Cov}(\\hat{\\mu}_1 - \\hat{\\mu}_0, \\hat{\\mu}_3 - \\hat{\\mu}_2) = \\text{Cov}(\\hat{\\mu}_1, \\hat{\\mu}_3) - \\text{Cov}(\\hat{\\mu}_1, \\hat{\\mu}_2) - \\text{Cov}(\\hat{\\mu}_0, \\hat{\\mu}_3) + \\text{Cov}(\\hat{\\mu}_0, \\hat{\\mu}_2)\n$$\n从矩阵 $\\hat{V}$ 中可知，所有这些协方差项都等于 $0.22$。\n$$\n\\text{Cov}(\\dots) = 0.22 - 0.22 - 0.22 + 0.22 = 0\n$$\n所以，对比的协方差矩阵是：\n$$\n\\Sigma_C = \\begin{pmatrix} 0.54  0 \\\\ 0  0.54 \\end{pmatrix}\n$$\n现在，计算 $\\Sigma_C$ 的逆矩阵：\n$$\n\\Sigma_C^{-1} = \\begin{pmatrix} 0.54  0 \\\\ 0  0.54 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{0.54}  0 \\\\ 0  \\frac{1}{0.54} \\end{pmatrix}\n$$\n最后，计算 Wald 统计量 $W$：\n$$\nW = (C\\hat{\\beta})^T \\Sigma_C^{-1} (C\\hat{\\beta}) = \\begin{pmatrix} -3.5  -1.5 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{0.54}  0 \\\\ 0  \\frac{1}{0.54} \\end{pmatrix} \\begin{pmatrix} -3.5 \\\\ -1.5 \\end{pmatrix}\n$$\n$$\nW = \\frac{(-3.5)^2}{0.54} + \\frac{(-1.5)^2}{0.54} = \\frac{12.25 + 2.25}{0.54} = \\frac{14.5}{0.54}\n$$\n计算数值：\n$$\nW = \\frac{14.5}{0.54} \\approx 26.85185...\n$$\n四舍五入到四位有效数字，Wald 检验统计量的值为 $26.85$。\n这个值将与自由度为 $q=2$ 的卡方分布进行比较，以获得联合假设检验的 p 值。例如，当 $\\alpha=0.05$ 时，临界值为 $\\chi^2_{2, 0.95} \\approx 5.99$。由于 $26.85 > 5.99$，因此在该显著性水平下，原假设将被拒绝。", "answer": "$$\n\\boxed{26.85}\n$$", "id": "4951162"}, {"introduction": "许多医学研究涉及非高斯分布的纵向结果，例如二元数据，这需要使用广义线性混合模型（GLMM）。由于GLMM的估计过程非常复杂，本练习旨在揭开惩罚性拟似然（PQL）方法的神秘面纱，通过推导其核心迭代步骤中拟合的“工作线性混合模型”[@problem_id:4951148]。这项实践不仅能阐明PQL的机制，还能让您深入了解该近似方法在处理小簇径二元数据时可能产生的偏差来源。", "problem": "一项针对新型抗高血压疗法的多中心纵向研究记录了患者 $i$ 在第 $j$ 次访视时血压是否受控的二元指标，记为 $Y_{ij} \\in \\{0,1\\}$，由于存在未观测到的异质性，数据在患者层面存在聚类。考虑一个广义线性混合模型 (GLMM)，其连接函数为 logit，并包含一个患者特异性随机截距。其中，条件分布满足 $Y_{ij} \\mid b_i \\sim \\text{Bernoulli}(\\mu_{ij})$，连接函数为 $g(\\mu_{ij}) = \\ln\\!\\big(\\mu_{ij}/(1-\\mu_{ij})\\big)$，线性预测变量为 $\\eta_{ij} = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i$。假设随机截距 $b_i$ 服从均值为 $0$、方差为 $\\sigma_b^{2}$ 的正态分布。伯努利结果的方差函数为 $V(\\mu_{ij}) = \\mu_{ij}(1-\\mu_{ij})$，均值关于线性预测变量的导数为 $\\frac{d\\mu_{ij}}{d\\eta_{ij}}$。\n\n任务：\n1. 从 GLMM 的基本定义、用于广义线性模型的迭代重加权最小二乘法框架，以及连接函数在当前估计值附近的一阶泰勒展开出发，解释用于 GLMM 估计的惩罚性拟似然 (PQL) 方法，并推导出 PQL 在每次迭代中拟合的工作线性混合模型。你的推导必须在 logit 连接和伯努利方差函数的条件下，用 $\\mu_{ij}$、$\\eta_{ij}$、$V(\\mu_{ij})$ 和 $\\frac{d\\mu_{ij}}{d\\eta_{ij}}$ 识别出工作响应变量和工作权重。\n\n2. 在第一次 PQL 迭代中，对于一个特定的患者-访视对 $(i,j)$，假设线性预测变量的当前迭代值等于 $\\eta_{ij}^{(0)} = \\ln(2/3)$，相应的条件均值等于 $\\mu_{ij}^{(0)} = 0.4$，观测结果等于 $Y_{ij} = 1$。使用标准的 logit 连接和伯努利方差函数，计算此观测值在第一次迭代时 PQL 的工作响应变量。答案保留四位有效数字，无需单位。\n\n此外，讨论将 PQL 应用于小簇群规模的二元数据时产生的科学上合理的偏差来源，并将其与该方法固有的近似以及伯努利分布的性质联系起来。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **模型类型**：广义线性混合模型 (GLMM)。\n- **数据结构**：纵向研究，患者层面聚类。\n- **响应变量**：$Y_{ij} \\in \\{0,1\\}$，患者 $i$ 在第 $j$ 次访视时的二元指标。\n- **条件分布**：$Y_{ij} \\mid b_i \\sim \\text{Bernoulli}(\\mu_{ij})$。\n- **连接函数**：$g(\\mu_{ij}) = \\ln\\!\\big(\\mu_{ij}/(1-\\mu_{ij})\\big)$ (logit 连接)。\n- **线性预测变量**：$\\eta_{ij} = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i$。\n- **随机效应分布**：$b_i \\sim N(0, \\sigma_b^{2})$。\n- **方差函数**：$V(\\mu_{ij}) = \\mu_{ij}(1-\\mu_{ij})$。\n- **任务2的具体信息**：\n    - 线性预测变量的当前迭代值：$\\eta_{ij}^{(0)} = \\ln(2/3)$。\n    - 条件均值的当前迭代值：$\\mu_{ij}^{(0)} = 0.4$。\n    - 观测结果：$Y_{ij} = 1$。\n- **任务**：\n    1. 解释惩罚性拟似然 (PQL) 并推导工作线性混合模型，识别工作响应变量和工作权重。\n    2. 计算指定观测值的工作响应变量，保留四位有效数字。\n    3. 讨论 PQL 在处理小簇群规模的二元数据时的偏差来源。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，描述了一个经典的统计模型（用于二元纵向数据的 GLMM）和一种广为人知的估计程序 (PQL)。参数和模型组件是生物统计学中的标准配置。问题陈述清晰；第1部分的推导是标准的教科书练习，第2部分的计算基于提供的一致数值（因为 $\\ln(2/3) = \\ln(0.4/(1-0.4))$），第3部分的讨论涉及一个有充分文献记载的统计研究领域。问题是客观、完整的，不含任何矛盾或不切实际的假设。这是一个统计方法论中的实质性问题。\n\n### 第3步：结论与行动\n该问题有效。将提供完整解答。\n\n### 第1部分：PQL 工作线性混合模型的推导\n\n惩罚性拟似然 (PQL) 是一种用于估计广义线性混合模型 (GLMM) 的方法。它避免了直接最大化边际似然，因为对随机效应的积分通常导致边际似然没有解析解。对于固定效应 $\\boldsymbol{\\beta}$ 和方差分量 $\\sigma_b^2$ 的边际对数似然由下式给出：\n$$ \\ell(\\boldsymbol{\\beta}, \\sigma_b^2; \\mathbf{y}) = \\sum_i \\ln \\int \\left( \\prod_j f(y_{ij} | b_i; \\boldsymbol{\\beta}) \\right) f(b_i; \\sigma_b^2) db_i $$\n其中 $f(\\cdot)$ 表示各自的概率密度或质量函数。PQL 通过将 GLMM 转化为一系列更易求解的线性混合模型 (LMM) 来近似这个棘手的积分。这是通过泰勒级数展开实现的。\n\n该方法的核心类似于标准广义线性模型 (GLM) 中使用的迭代重加权最小二乘法 (IRLS) 算法。我们通过线性化响应变量与线性预测变量之间的关系来构造一个“工作”或“伪”响应变量。\n\n设参数的当前估计值为 $\\boldsymbol{\\beta}^{(k)}$，随机效应为 $\\mathbf{b}^{(k)}$。由此得到线性预测变量的当前估计值 $\\eta_{ij}^{(k)} = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta}^{(k)} + b_i^{(k)}$ 和条件均值 $\\mu_{ij}^{(k)} = g^{-1}(\\eta_{ij}^{(k)})$。\n\n我们在当前估计的均值 $\\mu_{ij}^{(k)}$ 附近对连接函数 $g(Y_{ij})$ 进行一阶泰勒展开。这是一种启发式方法；更形式化的推导是展开似然的被积函数。展开式为：\n$$ g(Y_{ij}) \\approx g(\\mu_{ij}^{(k)}) + (Y_{ij} - \\mu_{ij}^{(k)}) g'(\\mu_{ij}^{(k)}) $$\n其中 $g'(\\mu_{ij}) = \\frac{d g(\\mu_{ij})}{d \\mu_{ij}}$。我们知道，根据定义，$g(\\mu_{ij}^{(k)}) = \\eta_{ij}^{(k)}$。连接函数的导数也可以用逆连接函数导数的形式表示：$g'(\\mu_{ij}) = 1 / \\frac{d\\mu_{ij}}{d\\eta_{ij}}$。\n\n将这些代入展开式，我们定义一个工作响应变量 $Z_{ij}^{(k)}$ 作为线性化后的值：\n$$ Z_{ij}^{(k)} = g(\\mu_{ij}^{(k)}) + (Y_{ij} - \\mu_{ij}^{(k)}) g'(\\mu_{ij}^{(k)}) = \\eta_{ij}^{(k)} + (Y_{ij} - \\mu_{ij}^{(k)}) \\frac{d g}{d \\mu_{ij}} \\bigg|_{\\mu_{ij}^{(k)}} $$\n这个 $Z_{ij}^{(k)}$ 被构造成近似等于线性预测变量 $\\eta_{ij} = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i$。因此，我们可以假设工作线性混合模型为：\n$$ Z_{ij}^{(k)} = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i + \\epsilon_{ij} $$\n为了完成模型设定，我们需要误差项 $\\epsilon_{ij}$ 的方差。在随机效应 $b_i$ 的条件下，工作响应变量的方差近似为：\n$$ \\text{Var}(Z_{ij}^{(k)} \\mid b_i) \\approx \\text{Var}\\left( (Y_{ij} - \\mu_{ij}^{(k)}) g'(\\mu_{ij}^{(k)}) \\mid b_i \\right) = [g'(\\mu_{ij}^{(k)})]^2 \\text{Var}(Y_{ij} \\mid b_i) $$\n在 GLM 框架下，$\\text{Var}(Y_{ij} \\mid b_i)$ 由方差函数 $V(\\mu_{ij})$ 给出，并由一个离散参数（对于伯努利分布为1）进行缩放。因此，工作方差为：\n$$ \\text{Var}(Z_{ij}^{(k)} \\mid b_i) \\approx [g'(\\mu_{ij}^{(k)})]^2 V(\\mu_{ij}^{(k)}) $$\n在 IRLS 框架中，我们使用方差的倒数作为权重。因此，工作权重 $W_{ij}^{(k)}$ 为：\n$$ W_{ij}^{(k)} = \\frac{1}{[g'(\\mu_{ij}^{(k)})]^2 V(\\mu_{ij}^{(k)})} = \\frac{(d\\mu_{ij}/d\\eta_{ij})^2 |_{\\eta_{ij}^{(k)}}}{V(\\mu_{ij}^{(k)})} $$\n在每次迭代 $k+1$ 时，PQL 拟合由 $Z_{ij}^{(k)} = \\mathbf{x}_{ij}^{\\top}\\boldsymbol{\\beta} + b_i + \\epsilon_{ij}$ 定义的工作 LMM，其中 $\\epsilon_{ij}$ 是均值为 $0$、方差为 $1/W_{ij}^{(k)}$ 的独立误差，且 $b_i \\sim N(0, \\sigma_b^2)$。然后求解此 LMM 以获得 $\\boldsymbol{\\beta}$ 和 $\\sigma_b^2$ 的更新估计值，并迭代此过程直至收敛。\n\n对于 logit 连接 $g(\\mu) = \\ln(\\mu/(1-\\mu))$ 的特定情况，其导数为 $g'(\\mu) = \\frac{1}{\\mu(1-\\mu)} = \\frac{1}{V(\\mu)}$。这是正则连接的一个性质。\n因此，工作响应变量简化为：\n$$ Z_{ij} = \\eta_{ij} + \\frac{Y_{ij} - \\mu_{ij}}{\\mu_{ij}(1-\\mu_{ij})} $$\n工作权重简化为：\n$$ W_{ij} = \\frac{1}{[g'(\\mu_{ij})]^2 V(\\mu_{ij})} = \\frac{1}{[1/V(\\mu_{ij})]^2 V(\\mu_{ij})} = V(\\mu_{ij}) = \\mu_{ij}(1-\\mu_{ij}) $$\n\n### 第2部分：工作响应变量的计算\n\n我们被要求在第一次 PQL 迭代中，根据以下给定值计算单个观测值的工作响应变量 $Z_{ij}^{(0)}$：\n- 观测结果：$Y_{ij} = 1$\n- 线性预测变量的当前迭代值：$\\eta_{ij}^{(0)} = \\ln(2/3)$\n- 条件均值的当前迭代值：$\\mu_{ij}^{(0)} = 0.4$\n\n如第1部分推导，工作响应变量的公式为：\n$$ Z_{ij}^{(0)} = \\eta_{ij}^{(0)} + (Y_{ij} - \\mu_{ij}^{(0)}) g'(\\mu_{ij}^{(0)}) $$\n对于 logit 连接，其导数为 $g'(\\mu) = \\frac{1}{\\mu(1-\\mu)}$。我们在 $\\mu_{ij}^{(0)} = 0.4$ 处计算该值：\n$$ g'(\\mu_{ij}^{(0)}) = \\frac{1}{0.4 \\times (1 - 0.4)} = \\frac{1}{0.4 \\times 0.6} = \\frac{1}{0.24} $$\n现在我们将所有给定值代入工作响应变量的公式中：\n$$ Z_{ij}^{(0)} = \\ln\\left(\\frac{2}{3}\\right) + (1 - 0.4) \\times \\frac{1}{0.24} $$\n$$ Z_{ij}^{(0)} = \\ln\\left(\\frac{2}{3}\\right) + \\frac{0.6}{0.24} $$\n$$ Z_{ij}^{(0)} = \\ln\\left(\\frac{2}{3}\\right) + 2.5 $$\n数值上，$\\ln(2/3)$ 约等于 $-0.405465$。\n$$ Z_{ij}^{(0)} \\approx -0.405465 + 2.5 = 2.094535 $$\n将结果保留四位有效数字，得到 $2.095$。\n\n### 第3部分：PQL 偏差的讨论\n\nPQL 估计方法以产生有偏估计而闻名，尤其是在处理二元数据和簇群规模较小的场景中。这种偏差的主要来源是其所使用的近似方法中固有的。\n\n1.  **泰勒近似的不准确性**：PQL 基于一阶泰勒级数展开，该展开将非线性模型线性化。这种近似的有效性取决于被展开函数的局部线性程度。对于通过 logit 连接建模的二元数据，其响应分布是离散的伯努利分布，这从根本上是非正态的。当条件均值 $\\mu_{ij}$ 接近 0 或 1 的边界时，连接函数的曲率最大，此时线性化效果尤其差。用基于高斯分布的工作模型来近似伯努利似然的这种不良近似是偏差的主要来源。\n\n2.  **方差分量 ($\\sigma_b^2$) 的低估**：PQL 是拉普拉斯近似的一个实例，其展开中心是随机效应后验分布的估计众数。这样做，它实际上将估计的随机效应视为真实的固定量，从而未能解释其估计中的不确定性。这导致对模型总方差的系统性低估。因此，随机效应方差分量 $\\sigma_b^2$ 会被向下偏置，通常偏置程度很大。\n\n3.  **小簇群规模的影响**：当簇群规模（即每个患者 $i$ 的重复测量次数 $j$）较小时，每个簇群内部用于可靠估计相应随机效应 $b_i$ 的信息有限。$b_i$ 的估计变得不稳定，并高度依赖于少数可用的数据点。对单个 $b_i$ 值的不良估计会进一步降低拉普拉斯近似的质量，从而加剧对 $\\sigma_b^2$ 估计的偏差。\n\n4.  **固定效应 ($\\boldsymbol{\\beta}$) 的偏差**：$\\hat{\\sigma}_b^2$ 的向下偏差对固定效应 $\\boldsymbol{\\beta}$ 的估计有直接影响。低估簇内相关性的程度（由 $\\sigma_b^2$ 控制）意味着模型高估了数据中独立信息的数量。这导致固定效应估计的标准误过小，从而导致I类错误率膨胀和过于激进的推断（即置信区间过窄）。$\\boldsymbol{\\beta}$ 的估计本身也存在偏差，通常会向零衰减（即偏向于无随机效应的 GLM 估计）。\n\n总之，PQL 用于二元数据时，科学上合理的偏差来源是：用高斯近似来处理离散的伯努利结果效果不佳，以及未能解释估计随机效应时的不确定性。当簇群规模较小时，这些问题最为严重，导致方差分量的显著向下偏差和固定效应的衰减偏差。因此，对于具有二元结果的 GLMM，通常首选高阶拉普拉斯近似或基于数值积分的方法（如自适应高斯求积法），尤其是在簇群规模不大时。", "answer": "$$\\boxed{2.095}$$", "id": "4951148"}]}