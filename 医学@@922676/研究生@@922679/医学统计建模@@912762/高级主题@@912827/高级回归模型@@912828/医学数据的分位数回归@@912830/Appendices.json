{"hands_on_practices": [{"introduction": "分位数回归的核心在于其独特的损失函数，即“弹球损失”（pinball loss）。通过直接计算这个损失函数，您可以具体地理解参数 $\\tau$ 是如何不对称地惩罚正负残差的，这正是对条件分布不同部分进行建模的关键。这项练习为掌握分位数回归的内在机制奠定了基础，让您亲身体验该方法如何根据所选分位数 $\\tau$ 来权衡高估和低估的成本。[@problem_id:4981835]", "problem": "给定应用于成年患者空腹血糖测量的多个分位数回归 (QR) 模型的拟合残差。分位数回归 (QR) 通过最小化一个非对称绝对偏差准则来估计条件分位数，该准则根据所选的分位数水平对上尾误差和下尾误差进行不同地惩罚。设患者 $i$ 的残差为 $e_i = y_i - \\hat{y}_i$，其中 $y_i$ 是观测到的血糖浓度（单位为 $\\mathrm{mg/dL}$），$\\hat{y}_i$ 是模型预测值。上尾误差对应于残差 $e_i > 0$（观测值超过预测值），下尾误差对应于 $e_i  0$（观测值低于预测值）。\n\n从核心定义出发，即对于 $\\tau \\in (0,1)$，条件 $\\tau$-分位数是通过最小化一个非对称绝对偏差风险来获得的，该风险根据残差的符号对其贡献进行差异化加权。请为每个测试用例计算：\n- 对于指定的 $\\tau$，通过聚合所有残差的非对称绝对偏差贡献，计算以 $\\mathrm{mg/dL}$ 为单位的总弹球损失 (pinball loss)。\n- 以 $\\mathrm{mg/dL}$ 为单位的上尾损失分量，定义为在相同的非对称绝对偏差原则下，总弹球损失中归因于残差 $e_i > 0$ 的部分。\n- 由上尾误差贡献的总弹球损失的比例，以小数表示。如果总弹球损失为零，则将此比例定义为 $0.0$。\n- 一个布尔值，指示上尾误差是否在总弹球损失中占主导地位，定义为该比例严格大于 $0.5$。\n\n所有损失量必须以 $\\mathrm{mg/dL}$ 表示，所有比例必须是小数。对于每个测试用例，返回一个包含 $[\\text{total\\_loss}, \\text{upper\\_tail\\_loss}, \\text{fraction\\_upper\\_tail}, \\text{dominates}]$ 的列表。\n\n使用以下分位数水平和残差集的测试套件（所有残差单位均为 $\\mathrm{mg/dL}$）：\n- 测试用例 $1$：$\\tau = 0.5$，残差 $\\{ -10, 5, -3, 8, 0 \\}$。\n- 测试用例 $2$：$\\tau = 0.9$，残差 $\\{ 2, 15, 40, -5, -1 \\}$。\n- 测试用例 $3$：$\\tau = 0.1$，残差 $\\{ -20, -10, -5, 0, 3 \\}$。\n- 测试用例 $4$：$\\tau = 0.7$，残差 $\\{ 0, 0, 0 \\}$。\n- 测试用例 $5$：$\\tau = 0.8$，残差 $\\{ 5, 10, 0.5 \\}$。\n- 测试用例 $6$：$\\tau = 0.8$，残差 $\\{ -7, -3, -0.5 \\}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果按上述顺序格式化为列表。例如，输出应类似于 $[ [\\dots], [\\dots], \\dots ]$，不含额外文本。确保所有数值量中，损失以 $\\mathrm{mg/dL}$ 表示，比例以小数表示。", "solution": "该问题要求计算与弹球损失函数 (pinball loss function) 相关的几个量，该函数是分位数回归的核心。验证过程确认了该问题具有科学依据、提法明确，并包含得出唯一解所需的所有信息。\n\n基本概念是弹球损失函数，对于给定的分位数水平 $\\tau \\in (0,1)$ 和单个残差 $u$，记为 $\\rho_\\tau(u)$。问题将其描述为“非对称绝对偏差风险”。其数学定义如下：\n$$\n\\rho_\\tau(u) = \\begin{cases} \\tau u  \\text{if } u \\ge 0 \\\\ (\\tau - 1) u  \\text{if } u  0 \\end{cases}\n$$\n该函数对正残差（预测不足, $u > 0$）和负残差（预测过度, $u  0$）进行非对称惩罚。正残差的权重是 $\\tau$，负残差绝对值的权重是 $1-\\tau$，因为对于 $u0$，有 $(\\tau-1)u = -(1-\\tau)u = (1-\\tau)|u|$。\n\n对于给定的残差集 $\\{e_1, e_2, \\dots, e_n\\}$，我们可以如下定义所需的量：\n\n1.  **总弹球损失 ($L_{\\text{total}}$)**: 这是所有残差的总损失。通过对每个单独残差 $e_i$ 的弹球损失求和来计算。\n    $$\n    L_{\\text{total}} = \\sum_{i=1}^{n} \\rho_\\tau(e_i) = \\sum_{i: e_i \\ge 0} \\tau e_i + \\sum_{i: e_i  0} (\\tau - 1) e_i\n    $$\n    所有量的单位均为 $\\mathrm{mg/dL}$，与残差单位一致。\n\n2.  **上尾损失分量 ($L_{\\text{upper}}$)**: 这是总损失中仅由正残差 ($e_i > 0$) 贡献的部分。根据 $\\rho_\\tau(u)$ 的定义，该分量为：\n    $$\n    L_{\\text{upper}} = \\sum_{i: e_i > 0} \\tau e_i\n    $$\n    根据问题规范“残差 $e_i > 0$”，$e_i=0$ 的残差对总损失的贡献为 $0$，不包含在此求和中。\n\n3.  **上尾损失比例 ($F_{\\text{upper}}$)**: 这是上尾损失与总损失的比率。对于总损失为零的情况，提供了一个特殊条件。\n    $$\n    F_{\\text{upper}} = \\begin{cases} \\frac{L_{\\text{upper}}}{L_{\\text{total}}}  \\text{if } L_{\\text{total}} > 0 \\\\ 0.0  \\text{if } L_{\\text{total}} = 0 \\end{cases}\n    $$\n\n4.  **主导地位布尔值 ($D_{\\text{upper}}$)**: 这是一个布尔值，指示上尾损失是否严格构成总损失的一半以上。\n    $$\n    D_{\\text{upper}} = (F_{\\text{upper}} > 0.5)\n    $$\n\n我们现在将这些定义应用于每个测试用例。\n\n**测试用例 1:** $\\tau = 0.5$，残差 $\\{ -10, 5, -3, 8, 0 \\}$。\n正残差为 $\\{5, 8\\}$，负残差为 $\\{-10, -3\\}$。\n$L_{\\text{upper}} = 0.5 \\times (5 + 8) = 0.5 \\times 13 = 6.5$。\n来自负残差的损失为 $(0.5 - 1) \\times (-10 - 3) = -0.5 \\times (-13) = 6.5$。\n$L_{\\text{total}} = 6.5 + 6.5 = 13.0$。\n$F_{\\text{upper}} = 6.5 / 13.0 = 0.5$。\n$D_{\\text{upper}} = (0.5 > 0.5)$ 为 False。\n结果: $[13.0, 6.5, 0.5, \\text{False}]$\n\n**测试用例 2:** $\\tau = 0.9$，残差 $\\{ 2, 15, 40, -5, -1 \\}$。\n正残差为 $\\{2, 15, 40\\}$，负残差为 $\\{-5, -1\\}$。\n$L_{\\text{upper}} = 0.9 \\times (2 + 15 + 40) = 0.9 \\times 57 = 51.3$。\n来自负残差的损失为 $(0.9 - 1) \\times (-5 - 1) = -0.1 \\times (-6) = 0.6$。\n$L_{\\text{total}} = 51.3 + 0.6 = 51.9$。\n$F_{\\text{upper}} = 51.3 / 51.9 \\approx 0.988439$。\n$D_{\\text{upper}} = (0.988439 > 0.5)$ 为 True。\n结果: $[51.9, 51.3, 0.988439..., \\text{True}]$\n\n**测试用例 3:** $\\tau = 0.1$，残差 $\\{ -20, -10, -5, 0, 3 \\}$。\n正残差为 $\\{3\\}$，负残差为 $\\{-20, -10, -5\\}$。\n$L_{\\text{upper}} = 0.1 \\times 3 = 0.3$。\n来自负残差的损失为 $(0.1 - 1) \\times (-20 - 10 - 5) = -0.9 \\times (-35) = 31.5$。\n$L_{\\text{total}} = 0.3 + 31.5 = 31.8$。\n$F_{\\text{upper}} = 0.3 / 31.8 \\approx 0.009434$。\n$D_{\\text{upper}} = (0.009434 > 0.5)$ 为 False。\n结果: $[31.8, 0.3, 0.009434..., \\text{False}]$\n\n**测试用例 4:** $\\tau = 0.7$，残差 $\\{ 0, 0, 0 \\}$。\n没有正或负残差。所有残差均为 $0$。\n$L_{\\text{upper}} = 0.7 \\times 0 = 0.0$。\n来自负残差的损失为 $0.0$。\n$L_{\\text{total}} = 0.0$。\n根据问题定义，由于 $L_{\\text{total}} = 0$，所以 $F_{\\text{upper}} = 0.0$。\n$D_{\\text{upper}} = (0.0 > 0.5)$ 为 False。\n结果: $[0.0, 0.0, 0.0, \\text{False}]$\n\n**测试用例 5:** $\\tau = 0.8$，残差 $\\{ 5, 10, 0.5 \\}$。\n所有残差均为正。\n$L_{\\text{upper}} = 0.8 \\times (5 + 10 + 0.5) = 0.8 \\times 15.5 = 12.4$。\n来自负残差的损失为 $0.0$。\n$L_{\\text{total}} = 12.4 + 0.0 = 12.4$。\n$F_{\\text{upper}} = 12.4 / 12.4 = 1.0$。\n$D_{\\text{upper}} = (1.0 > 0.5)$ 为 True。\n结果: $[12.4, 12.4, 1.0, \\text{True}]$\n\n**测试用例 6:** $\\tau = 0.8$，残差 $\\{ -7, -3, -0.5 \\}$。\n所有残差均为负。\n$L_{\\text{upper}} = 0.8 \\times 0 = 0.0$。\n来自负残差的损失为 $(0.8 - 1) \\times (-7 - 3 - 0.5) = -0.2 \\times (-10.5) = 2.1$。\n$L_{\\text{total}} = 0.0 + 2.1 = 2.1$。\n$F_{\\text{upper}} = 0.0 / 2.1 = 0.0$。\n$D_{\\text{upper}} = (0.0 > 0.5)$ 为 False。\n结果: $[2.1, 0.0, 0.0, \\text{False}]$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quantile regression loss metrics for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (quantile_level, list_of_residuals).\n    test_cases = [\n        (0.5, [-10, 5, -3, 8, 0]),\n        (0.9, [2, 15, 40, -5, -1]),\n        (0.1, [-20, -10, -5, 0, 3]),\n        (0.7, [0, 0, 0]),\n        (0.8, [5, 10, 0.5]),\n        (0.8, [-7, -3, -0.5]),\n    ]\n\n    results = []\n    for tau, residuals_list in test_cases:\n        # Convert list of residuals to a numpy array for efficient computation.\n        residuals = np.array(residuals_list, dtype=np.float64)\n        \n        # Isolate positive and negative residuals.\n        # Per the problem, upper-tail corresponds to e_i  0.\n        pos_residuals = residuals[residuals  0]\n        neg_residuals = residuals[residuals  0]\n        \n        # 1. Calculate the total pinball loss.\n        # The loss is the sum of two components: one for positive/zero residuals\n        # and one for negative residuals. The pinball loss function rho_tau(u) is\n        # tau * u for u = 0 and (tau - 1) * u for u  0.\n        \n        # Calculate the upper-tail loss component from positive residuals.\n        upper_tail_loss = tau * np.sum(pos_residuals)\n        \n        # Calculate the lower-tail loss component from negative residuals.\n        lower_tail_loss = (tau - 1) * np.sum(neg_residuals)\n        \n        # The total loss is the sum of the two components.\n        total_loss = upper_tail_loss + lower_tail_loss\n        \n        # 2. The upper_tail_loss is already calculated.\n        # It is the portion of the total pinball loss attributable to e_i  0.\n        \n        # 3. Calculate the fraction of total loss from upper-tail errors.\n        # Handle the case where total loss is zero.\n        if total_loss  0:\n            fraction_upper_tail = upper_tail_loss / total_loss\n        else:\n            fraction_upper_tail = 0.0\n            \n        # 4. Determine if upper-tail errors dominate (fraction  0.5).\n        dominates = fraction_upper_tail  0.5\n        \n        # Append the results for the current test case.\n        results.append([\n            total_loss, \n            upper_tail_loss, \n            fraction_upper_tail, \n            dominates\n        ])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is used.\n    # We replace spaces to generate a more compact, but still valid, format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "4981835"}, {"introduction": "拟合回归模型的一个主要用途是进行预测。本练习将提供直接的实践机会，应用一个包含多项式和交互项的复杂分位数回归模型，来预测一个新个体的特定条件分位数。它演示了如何将模型系数转化为具有临床意义的估计值，例如高血压的高风险阈值，这是将统计模型应用于临床决策的关键一步。[@problem_id:4981834]", "problem": "一项关于心血管老化的队列研究使用分位数回归，对给定年龄和性别条件下的收缩压 (SBP) 的条件分位数进行了建模。其基本定义是，条件 $\\tau$-分位数函数 $Q_{Y}(\\tau \\mid X=x)$ 满足 $\\mathbb{P}(Y \\leq Q_{Y}(\\tau \\mid X=x) \\mid X=x) = \\tau$。分位数回归估计量 $\\hat{\\beta}(\\tau)$ 是通过在训练样本上最小化检验（弹球）损失 $\\rho_{\\tau}(u) = u\\left(\\tau - \\mathbf{1}\\{u  0\\}\\right)$ 的经验和来获得的，其中 $\\mathbf{1}\\{\\cdot\\}$ 表示指示函数。在这项研究中，当 $\\tau = 0.9$ 时，SBP 条件分位数的工作模型使用了标准化年龄的多项式基以及与性别的交互作用：\n$$\nQ_{\\mathrm{SBP}}(0.9 \\mid a, S) = \\beta_{0}(0.9) + \\beta_{S}(0.9)\\,S + \\beta_{1}(0.9)\\,z + \\beta_{2}(0.9)\\,z^{2} + \\beta_{3}(0.9)\\,z^{3} + \\gamma_{1}(0.9)\\,S z + \\gamma_{2}(0.9)\\,S z^{2} + \\gamma_{3}(0.9)\\,S z^{3},\n$$\n其中 $a$ 是年龄（单位：岁），$S$ 是性别指示变量，男性编码为 $S=1$，女性编码为 $S=0$，而 $z$ 是标准化年龄，定义为 $z = (a - 55)/10$。在 $\\tau = 0.9$ 时的拟合系数估计值为：\n$$\n\\hat{\\beta}_{0}(0.9) = 130,\\quad \\hat{\\beta}_{S}(0.9) = 7,\\quad \\hat{\\beta}_{1}(0.9) = 9,\\quad \\hat{\\beta}_{2}(0.9) = 1.2,\\quad \\hat{\\beta}_{3}(0.9) = -0.5,\n$$\n$$\n\\hat{\\gamma}_{1}(0.9) = 2.5,\\quad \\hat{\\gamma}_{2}(0.9) = 0.4,\\quad \\hat{\\gamma}_{3}(0.9) = -0.2.\n$$\n对于一名年龄为 $a = 72$ 岁的男性患者（因此 $S = 1$），请使用提供的 $\\hat{\\beta}(0.9)$ 值计算 SBP 的预测 0.9-分位数。请以毫米汞柱 (mmHg) 为单位表示您的最终答案，并四舍五入到四位有效数字。", "solution": "对问题陈述进行有效性评估。\n\n### 步骤 1：提取已知条件\n- **条件分位数定义**：$\\mathbb{P}(Y \\leq Q_{Y}(\\tau \\mid X=x) \\mid X=x) = \\tau$。\n- **分位数回归估计量定义**：$\\hat{\\beta}(\\tau)$ 最小化检验损失函数 $\\rho_{\\tau}(u) = u\\left(\\tau - \\mathbf{1}\\{u  0\\}\\right)$ 的和。\n- **SBP 的条件 $\\tau=0.9$ 分位数模型**：\n$$\nQ_{\\mathrm{SBP}}(0.9 \\mid a, S) = \\beta_{0}(0.9) + \\beta_{S}(0.9)\\,S + \\beta_{1}(0.9)\\,z + \\beta_{2}(0.9)\\,z^{2} + \\beta_{3}(0.9)\\,z^{3} + \\gamma_{1}(0.9)\\,S z + \\gamma_{2}(0.9)\\,S z^{2} + \\gamma_{3}(0.9)\\,S z^{3}\n$$\n- **变量定义**：\n  - $a$：年龄（单位：岁）。\n  - $S$：性别指示变量，$S=1$ 表示男性，$S=0$ 表示女性。\n  - $z$：标准化年龄，$z = (a - 55)/10$。\n- **$\\tau=0.9$ 时的拟合系数估计值**：\n  - $\\hat{\\beta}_{0}(0.9) = 130$\n  - $\\hat{\\beta}_{S}(0.9) = 7$\n  - $\\hat{\\beta}_{1}(0.9) = 9$\n  - $\\hat{\\beta}_{2}(0.9) = 1.2$\n  - $\\hat{\\beta}_{3}(0.9) = -0.5$\n  - $\\hat{\\gamma}_{1}(0.9) = 2.5$\n  - $\\hat{\\gamma}_{2}(0.9) = 0.4$\n  - $\\hat{\\gamma}_{3}(0.9) = -0.2$\n- **任务数据**：\n  - 患者为男性，因此 $S=1$。\n  - 患者年龄为 $a = 72$ 岁。\n- **要求的输出格式**：\n  - 计算 SBP 的预测 0.9-分位数。\n  - 以 mmHg 为单位表示答案。\n  - 四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题定义明确且科学上合理。\n- **科学依据**：该问题描述了分位数回归（一种成熟的统计方法）在为生理变量（收缩压）建模方面的标准应用。带交互项的多项式模型是生物统计学中的常见做法。所呈现的概念和数值是现实的。\n- **良态性**：所有必要组成部分都已提供：明确的模型方程、全套拟合系数以及用于预测的协变量的具体值。该任务是直接计算，保证了唯一解。\n- **客观性**：该问题使用精确、形式化的数学和统计语言陈述，没有歧义或主观论断。\n\n### 步骤 3：结论与行动\n该问题有效。将推导出解决方案。\n\n任务是为一名 72 岁的男性患者计算收缩压 (SBP) 的预测 0.9-分位数。该预测值记作 $\\hat{Q}_{\\mathrm{SBP}}(0.9 \\mid a, S)$，使用提供的拟合模型和系数进行计算。\n\n预测的 $\\tau=0.9$ 分位数的模型方程为：\n$$\n\\hat{Q}_{\\mathrm{SBP}}(0.9 \\mid a, S) = \\hat{\\beta}_{0}(0.9) + \\hat{\\beta}_{S}(0.9)\\,S + \\hat{\\beta}_{1}(0.9)\\,z + \\hat{\\beta}_{2}(0.9)\\,z^{2} + \\hat{\\beta}_{3}(0.9)\\,z^{3} + \\hat{\\gamma}_{1}(0.9)\\,S z + \\hat{\\gamma}_{2}(0.9)\\,S z^{2} + \\hat{\\gamma}_{3}(0.9)\\,S z^{3}\n$$\n患者为男性，因此性别指示变量 $S=1$。患者年龄为 $a=72$。\n\n首先，我们计算标准化年龄 $z$：\n$$\nz = \\frac{a - 55}{10} = \\frac{72 - 55}{10} = \\frac{17}{10} = 1.7\n$$\n接下来，我们计算 $z$ 的所需幂次：\n$$\nz^{2} = (1.7)^{2} = 2.89\n$$\n$$\nz^{3} = (1.7)^{3} = 4.913\n$$\n现在，将 $S=1$ 以及 $z$、$z^2$ 和 $z^3$ 的值连同给定的系数估计值一起代入模型方程。为清晰起见，我们代入 $\\tau=0.9$ 并省略系数符号中的参数。\n$$\n\\hat{Q}_{\\mathrm{SBP}} = \\hat{\\beta}_{0} + \\hat{\\beta}_{S}S + \\hat{\\beta}_{1}z + \\hat{\\beta}_{2}z^{2} + \\hat{\\beta}_{3}z^{3} + \\hat{\\gamma}_{1}Sz + \\hat{\\gamma}_{2}Sz^{2} + \\hat{\\gamma}_{3}Sz^{3}\n$$\n代入数值：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 130 + (7)(1) + (9)(1.7) + (1.2)(2.89) + (-0.5)(4.913) + (2.5)(1)(1.7) + (0.4)(1)(2.89) + (-0.2)(1)(4.913)\n$$\n由于 $S=1$，我们可以根据 $z$ 的幂次重新组合各项：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = (\\hat{\\beta}_{0} + \\hat{\\beta}_{S}) + (\\hat{\\beta}_{1} + \\hat{\\gamma}_{1})z + (\\hat{\\beta}_{2} + \\hat{\\gamma}_{2})z^{2} + (\\hat{\\beta}_{3} + \\hat{\\gamma}_{3})z^{3}\n$$\n计算组合系数：\n- 截距项：$\\hat{\\beta}_{0} + \\hat{\\beta}_{S} = 130 + 7 = 137$\n- $z$ 的系数：$\\hat{\\beta}_{1} + \\hat{\\gamma}_{1} = 9 + 2.5 = 11.5$\n- $z^2$ 的系数：$\\hat{\\beta}_{2} + \\hat{\\gamma}_{2} = 1.2 + 0.4 = 1.6$\n- $z^3$ 的系数：$\\hat{\\beta}_{3} + \\hat{\\gamma}_{3} = -0.5 + (-0.2) = -0.7$\n\n现在将这些组合系数和 $z$ 的幂次代入简化表达式中：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 137 + (11.5)(1.7) + (1.6)(2.89) + (-0.7)(4.913)\n$$\n进行乘法运算：\n- $(11.5)(1.7) = 19.55$\n- $(1.6)(2.89) = 4.624$\n- $(-0.7)(4.913) = -3.4391$\n\n最后，将各项相加：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 137 + 19.55 + 4.624 - 3.4391\n$$\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 156.55 + 4.624 - 3.4391\n$$\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 161.174 - 3.4391\n$$\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 157.7349\n$$\n题目要求答案四舍五入到四位有效数字。计算结果为 $157.7349$。前四位有效数字是 $1$、$5$、$7$ 和 $7$。第五位有效数字是 $3$，小于 $5$，所以我们向下舍入（截断）。\n四舍五入后的值为 $157.7$。", "answer": "$$\\boxed{157.7}$$", "id": "4981834"}, {"introduction": "医学研究的目标往往超越单一预测，致力于比较不同组别（例如，男性与女性）之间的结果差异。这项高级练习不仅演示了如何预测和比较条件分位数，还展示了如何通过为差异构建置信区间来进行统计推断。本练习将预测与一项关键技能相结合：即利用模型的协方差矩阵来量化我们估计值的不确定性，这对于得出严谨的科学结论至关重要。[@problem_id:4981851]", "problem": "一项医院研究分析了成年人收缩压（单位为毫米汞柱，mmHg）的条件上尾部，将其建模为年龄和性别的函数。设 $Y$ 表示收缩压，$A$ 表示年龄（单位：年），$M$ 表示男性二元指标（$M=1$ 为男性，$M=0$ 为女性）。假设在 $\\tau=0.75$ 处的条件$\\tau$-分位数函数是协变量的线性函数，其形式为\n$$\nQ_{Y \\mid A,M}(0.75 \\mid a,m) = \\beta_0 + \\beta_A\\,a + \\beta_M\\,m + \\beta_{AM}\\,a\\,m.\n$$\n通过分位数回归估计出在 $\\tau=0.75$ 处的回归系数为 $\\hat{\\beta}_{0.75} = (\\hat{\\beta}_0,\\hat{\\beta}_A,\\hat{\\beta}_M,\\hat{\\beta}_{AM})^{\\top}$，其值为\n$$\n\\hat{\\beta}_0 = 94.0,\\quad \\hat{\\beta}_A = 0.70,\\quad \\hat{\\beta}_M = 6.00,\\quad \\hat{\\beta}_{AM} = 0.03.\n$$\n$\\hat{\\beta}_{0.75}$ 的估计渐近协方差矩阵如下：\n$$\n\\hat{V}_{0.75} =\n\\begin{pmatrix}\n6.25  -0.02  0.30  -0.015 \\\\\n-0.02  0.05  -0.005  0.0001 \\\\\n0.30  -0.005  2.89  -0.002 \\\\\n-0.015  0.0001  -0.002  0.02\n\\end{pmatrix}.\n$$\n使用这些估计值，对60岁的患者执行以下操作：\n1. 计算一位60岁女性（$M=0$）的收缩压预测0.75分位数。\n2. 计算一位60岁男性（$M=1$）的收缩压预测0.75分位数。\n3. 计算60岁时男性和女性预测0.75分位数之间的估计差异。\n4. 使用基于 $\\hat{V}_{0.75}$ 的渐近正态近似，为第3项中的差异构建一个双边 $95\\%$ 置信区间（CI）。\n\n将您的数值答案四舍五入到四位有效数字。所有数值答案均以毫米汞柱（mmHg）为单位表示。按以下顺序提供您的最终数值结果：60岁女性的预测分位数、60岁男性的预测分位数、估计差异、置信区间下限、置信区间上限。", "solution": "在固定的分位数水平 $\\tau$ 下，分位数回归由经验目标函数 $\\sum_{i=1}^{n} \\rho_{\\tau}\\!\\left(Y_i - X_i^{\\top}\\beta\\right)$ 的最小化器 $\\hat{\\beta}_{\\tau}$ 定义，其中检查损失函数为 $\\rho_{\\tau}(u) = u\\left(\\tau - \\mathbf{1}\\{u  0\\}\\right)$，$X_i$ 是协变量向量。在标准的正则性条件下（独立同分布（i.i.d.）抽样，$Y$ 在目标分位数处的条件密度严格为正，以及适当的矩和设计条件），$\\hat{\\beta}_{\\tau}$ 是一个一致估计量，并服从渐近正态近似，\n$$\n\\sqrt{n}\\left(\\hat{\\beta}_{\\tau} - \\beta_{\\tau}\\right) \\overset{d}{\\to} \\mathcal{N}\\!\\left(0, V_{\\tau}\\right),\n$$\n其中 $V_{\\tau}$ 可以通过一个稳健的三明治协方差估计量（记为 $\\hat{V}_{\\tau}$）进行一致估计。对于任何固定的协变量向量 $x$，预测的条件 $\\tau$-分位数为 $x^{\\top}\\hat{\\beta}_{\\tau}$，对于任何线性对比 $l^{\\top}\\beta_{\\tau}$，其渐近方差为 $l^{\\top}\\hat{V}_{\\tau} l$。\n\n我们给出了线性设定\n$$\nQ_{Y \\mid A,M}(0.75 \\mid a,m) = \\beta_0 + \\beta_A\\,a + \\beta_M\\,m + \\beta_{AM}\\,a\\,m,\n$$\n以及在 $\\tau=0.75$ 处的估计值，\n$$\n\\hat{\\beta}_0 = 94.0,\\quad \\hat{\\beta}_A = 0.70,\\quad \\hat{\\beta}_M = 6.00,\\quad \\hat{\\beta}_{AM} = 0.03,\n$$\n其协方差矩阵为\n$$\n\\hat{V}_{0.75} =\n\\begin{pmatrix}\n6.25  -0.02  0.30  -0.015 \\\\\n-0.02  0.05  -0.005  0.0001 \\\\\n0.30  -0.005  2.89  -0.002 \\\\\n-0.015  0.0001  -0.002  0.02\n\\end{pmatrix}.\n$$\n\n步骤1（女性，$A=60$, $M=0$）。一位60岁女性的协变量向量是 $x_f = (1, 60, 0, 0)^{\\top}$。预测的0.75分位数为\n$$\nx_f^{\\top}\\hat{\\beta}_{0.75} = \\hat{\\beta}_0 + \\hat{\\beta}_A \\cdot 60 + \\hat{\\beta}_M \\cdot 0 + \\hat{\\beta}_{AM} \\cdot 60 \\cdot 0 = 94.0 + 0.70 \\cdot 60 = 136.0.\n$$\n\n步骤2（男性，$A=60$, $M=1$）。一位60岁男性的协变量向量是 $x_m = (1, 60, 1, 60)^{\\top}$。预测的0.75分位数为\n$$\nx_m^{\\top}\\hat{\\beta}_{0.75} = \\hat{\\beta}_0 + \\hat{\\beta}_A \\cdot 60 + \\hat{\\beta}_M \\cdot 1 + \\hat{\\beta}_{AM} \\cdot 60 \\cdot 1 = 94.0 + 0.70 \\cdot 60 + 6.00 + 0.03 \\cdot 60 = 143.8.\n$$\n\n步骤3（差异，男性减女性）。在 $A=60$ 时预测分位数的差异为\n$$\n\\widehat{\\Delta} = x_m^{\\top}\\hat{\\beta}_{0.75} - x_f^{\\top}\\hat{\\beta}_{0.75} = \\hat{\\beta}_M + 60\\,\\hat{\\beta}_{AM} = 6.00 + 60 \\cdot 0.03 = 7.80.\n$$\n\n步骤4（差异的双边95%置信区间）。该差异是一个线性对比，其中 $l = (0, 0, 1, 60)^{\\top}$，因此其渐近方差为\n$$\n\\operatorname{Var}(\\widehat{\\Delta}) = l^{\\top}\\hat{V}_{0.75}\\,l\n= \\hat{V}_{33} + 60^2 \\hat{V}_{44} + 2 \\cdot 60\\, \\hat{V}_{34}.\n$$\n使用 $\\hat{V}_{0.75}$ 中的条目，\n$$\n\\operatorname{Var}(\\widehat{\\Delta}) = 2.89 + 60^2 \\cdot 0.02 + 2 \\cdot 60 \\cdot (-0.002)\n= 2.89 + 3600 \\cdot 0.02 - 0.24 = 2.89 + 72 - 0.24 = 74.65.\n$$\n标准误为\n$$\n\\operatorname{SE}(\\widehat{\\Delta}) = \\sqrt{74.65} \\approx 8.640.\n$$\n根据渐近正态近似，一个双边95%置信区间由下式给出\n$$\n\\widehat{\\Delta} \\pm z_{0.975} \\cdot \\operatorname{SE}(\\widehat{\\Delta}),\n$$\n其中 $z_{0.975} \\approx 1.96$。因此，\n$$\n\\text{CI}_{95\\%} = 7.80 \\pm 1.96 \\cdot 8.640 = 7.80 \\pm 16.9344,\n$$\n其端点为\n$$\n\\text{Lower} = 7.80 - 16.9344 = -9.1344,\\qquad \\text{Upper} = 7.80 + 16.9344 = 24.7344.\n$$\n\n将所有要求解的量四舍五入到四位有效数字，并以毫米汞柱（mmHg）为单位表示：\n- 60岁女性的预测0.75分位数：$136.0$。\n- 60岁男性的预测0.75分位数：$143.8$。\n- 估计差异（男性减女性）：$7.800$。\n- 95%置信区间下限：$-9.134$。\n- 95%置信区间上限：$24.73$。\n\n这五个数值结果，按指定顺序，是最终输出。", "answer": "$$\\boxed{\\begin{pmatrix}136.0  143.8  7.800  -9.134  24.73\\end{pmatrix}}$$", "id": "4981851"}]}