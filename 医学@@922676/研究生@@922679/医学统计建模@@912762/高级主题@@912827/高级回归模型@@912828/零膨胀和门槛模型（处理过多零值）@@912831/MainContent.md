## 引言
在医学、公共卫生和生物学研究中，计数数据（如疾病发作次数、就诊次数或基因表达读数）是评估结果和检验假设的核心。传统上，泊松回归和负二项回归是分析此[类数](@entry_id:156164)据的标准工具。然而，这些模型在面对一个普遍存在却极具挑战性的问题——观测到的零值数量远超模型预期时，往往会得出有偏的结论。这种“零值过多”（excess zeros）现象揭示了标准模型的内在局限性，即它们无法区分不同来源的零值，从而促使研究者寻求更精细、更符合现实机制的统计方法。

本文旨在系统性地介绍两种为解决“零值过多”问题而设计的强大模型：[零膨胀模型](@entry_id:756817)（Zero-Inflated Models）和跨栏模型（Hurdle Models）。通过深入学习，您将不仅掌握这些模型的统计原理，还能理解如何将它们应用于解决真实的科学问题。

*   在**“原理与机制”**一章中，我们将深入剖析这两种模型背后的统计学“故事”，理解它们如何从概念上将零值的产生过程[解耦](@entry_id:160890)，并探讨其数学结构、参数估计与[模型诊断](@entry_id:136895)方法。
*   接下来，在**“应用与跨学科连接”**一章中，我们将通过临床试验、基因组学（scRNA-seq）和公共卫生等领域的丰富案例，展示如何根据学科理论选择和设定模型，并解释其参数以获得深刻的机制性洞见。
*   最后，在**“动手实践”**部分，您将有机会通过解决具体问题，将理论知识转化为实际的分析技能，从而巩固对[模型诊断](@entry_id:136895)和解释的理解。

让我们首先进入第一章，探索[零膨胀模型](@entry_id:756817)和跨栏模型的基本原理与内在机制。

## 原理与机制

在分析诸如特定时间窗内疾病发作次数、急诊就诊次数或医疗服务使用次数等医学计数数据时，[统计模型](@entry_id:755400)是不可或缺的工具。然而，标准计数模型（如泊松模型和负[二项模型](@entry_id:275034)）在面对一类常见现象——“零值过多”（excess zeros）——时，往往会表现不佳。本章将深入探讨这一现象的本质，并系统阐述两种为解决该问题而设计的先进模型：[零膨胀模型](@entry_id:756817)（Zero-Inflated Models）和跨栏模型（Hurdle Models）。我们将从基本原理出发，剖析它们的统计结构、参数解释、估计方法及其在临床研究中的应用场景。

### “零值过多”现象：标准计数模型的局限性

标准的计数分布，如泊松分布和[负二项分布](@entry_id:262151)，其内在结构对数据的均值、方差和零点概率施加了严格的约束。在泊松分布中，均值与方差相等（$\lambda$），零点概率完全由均值决定：$P(Y=0) = \exp(-\lambda)$。负二项分布通过引入一个额外的离散参数，允许方差大于均值（即“过度离散”），在一定程度上增加了模型的灵活性。其零点概率 $P(Y=0)$ 是均值 $\mu$ 和离散参数 $\alpha$ 的函数：$P(Y=0) = (1 + \alpha\mu)^{-1/\alpha}$。

然而，在许多医学和公共卫生应用中，观测到的零计数比例常常远高于这些标准模型根据样本均值和方差所能预测的水平。这种现象被称为**“零值过多”**或**“零膨胀”**（zero-inflation）。

考虑一个模拟某慢性[呼吸系统](@entry_id:163483)疾病患者年度计划外急诊就诊次数的研究场景 [@problem_id:4993571]。假设我们从一个大型队列中收集到以下经验性摘要统计量：样本均值 $\hat{\mu} = 0.35$，样本方差 $\hat{v} = 0.50$，以及观测到的零值比例 $\hat{p}_{0} = 0.88$。

如果我们尝试用泊松模型来拟合这些数据，根据[矩估计法](@entry_id:270941)，我们会将模型均值 $\lambda$ 设定为样本均值 $0.35$。该模型立即暴露出两个问题：首先，它预测的方差也应为 $0.35$，这与观测到的方差 $0.50$ 不符，显示出数据存在过度离散。其次，更关键的是，该模型预测的零值概率为 $P(Y=0) = \exp(-0.35) \approx 0.7047$。这个预测值（约 $70\%$）远低于实际观测到的零值比例（$88\%$）。

接下来，我们尝试更灵活的负[二项模型](@entry_id:275034)。通过匹配样本均值（$\hat{\mu} = 0.35$）和样本方差（$\hat{v} = 0.50$），我们可以估计出离散参数 $\hat{\alpha} = (\hat{v} - \hat{\mu})/\hat{\mu}^2 \approx 1.2245$。虽然该模型能够准确地捕捉到数据的过度离散特性，但其预测的零值概率为 $P(Y=0) = (1 + \hat{\alpha}\hat{\mu})^{-1/\hat{\alpha}} \approx 0.778$。这个结果（约 $78\%$）虽然比泊松模型更接近真实情况，但仍显著低于观测到的 $88\%$。

这个例子清晰地表明，标准计数模型的局限性在于其零点概率是其低阶矩（均值和方差）的确定性函数 [@problem_id:4993571]。一旦模型的均值和（对于负[二项模型](@entry_id:275034)）方差被数据确定，其预测零值的“能力”也就被锁定了。当数据中存在一个额外的、由不同机制产生的零值来源时，这些单峰分布模型便[无能](@entry_id:201612)为力。为了克服这一挑战，我们需要能够将零值的产生过程与正值的产生过程[解耦](@entry_id:160890)的模型框架。

### 两种应对“零值过多”的 conceptual Framework

[零膨胀模型](@entry_id:756817)和跨栏模型正是为实现这种[解耦](@entry_id:160890)而设计的。它们并非简单地对标准模型进行数学上的修补，而是源于对数据生成过程的两种不同但都极具临床意义的“故事”或**生成机制**（generative mechanisms）的深刻理解。

#### [零膨胀模型](@entry_id:756817)：群体异质性的故事

零膨胀（Zero-Inflated, ZI）模型假设观测群体本质上是**异质**的，由两个无法直接观测的**潜在亚群**（latent subgroups）混合而成 [@problem_id:4993542] [@problem_id:4993532]。

1.  **“非易感”亚群（Non-susceptible Subgroup）**：这个亚群的个体由于某种内在特性或外部保护因素，在观测期内**不可能**经历我们所研究的事件。因此，他们的计数值必然为零。这种零被称为**结构性零**（structural zeros）。

2.  **“易感”亚群（Susceptible Subgroup）**：这个亚群的个体则有风险经历事件。他们的计数值遵循一个标准的[计数过程](@entry_id:260664)（如泊松或[负二项分布](@entry_id:262151)）。然而，即使是易感个体，也可能因为事件发生率较低或纯粹出于偶然，在观测期内未发生任何事件，从而产生零值。这种零被称为**随机性零**（sampling zeros）。

一个典型的临床情景是儿童哮喘急性发作的计数研究 [@problem_id:4993585]。一个被记录为零发作的儿童，可能确实属于“非易感”亚群（例如，该儿童根本没有哮喘诊断或其气道高反应性为阴性），因此其零发作是必然的（结构性零）。另一个儿童可能确实患有哮喘（属于“易感”亚群），但由于药物依从性好或环境触发物暴露少，在研究期间碰巧没有急性发作，其零发作则是偶然的（随机性零）。另一个经典的例子是寄生虫学研究，其中粪便样本中的虫卵计数。许多患者的计数为零是因为他们**确实未被感染**（结构性零），而另一些被感染的患者，由于感染程度轻或样本取样变异，也可能碰巧未检测到虫卵（随机性零）[@problem_id:4993542]。

#### 跨栏模型：两阶段过程的故事

跨栏（Hurdle）模型，又称两部分模型（Two-part Model），则讲述了一个**两阶段过程**的故事。它不假设存在稳定的潜在亚群，而是认为所有个体都面临一个共同的决策或触发过程 [@problem_id:4993542] [@problem_id:4993512]。

1.  **第一阶段（跨栏）**：一个二元过程决定了个体的计数值是零还是正值。这可以被理解为是否“越过一个门槛”或“启动一个过程”。如果未能越过门槛，计数值即为零。

2.  **第二阶段（计数）**：**只有当**个体成功越过门槛后，第二个过程才被激活，用于决定正计数的具体数值。这个过程遵循一个**零点截断**（zero-truncated）的计数分布，即该分布的取值范围被限定为正整数 $\{1, 2, 3, ...\}$。

一个贴切的临床例子是针对[慢性疼痛](@entry_id:163163)患者的阿片类药物处方配药次数研究 [@problem_id:4993542]。所有患者都有潜在的用药需求，但他们必须首先做出“开始使用阿片类药物”的决定（或由医生开出第一个处方）。这个“启动”决策就是“跨栏”。未启动的患者，其配药次数必然为零。而对于那些启动了治疗的患者，其后续的配药次数则由疾病严重程度、医生处方习惯和患者依从性等因素决定。另一个例子是记录慢性病患者每日症状发作次数 [@problem_id:4993512]。任何症状发作都必须先从“无症状”状态转变为“有症状”状态（跨栏），然后才能计数具体的发作次数。

### [零膨胀模型](@entry_id:756817)的深度剖析

#### 形式化定义与结构

[零膨胀模型](@entry_id:756817)是一个混合模型。对于第 $i$ 个观测个体，我们引入一个潜在的伯努利随机变量 $U_i$，其中 $U_i=1$ 表示该个体属于结构性零亚群，概率为 $\pi_i$；$U_i=0$ 表示属于易感亚群，概率为 $1-\pi_i$ [@problem_id:4993577]。计数值 $Y_i$ 的生成过程可以写为：
- 如果 $U_i=1$，则 $Y_i = 0$。
- 如果 $U_i=0$，则 $Y_i$ 服从某个参数为 $\theta_i$ 的标准计数分布，如泊松分布 $Y_i \sim \text{Poisson}(\lambda_i)$。

根据[全概率定律](@entry_id:268479)，我们可以导出零膨胀泊松（ZIP）模型的概率质量函数（PMF）。观测到零值 $Y_i=0$ 的总概率是两条路径的概率之和：
$$ P(Y_i=0) = P(U_i=1) + P(U_i=0) \cdot P(Y_i=0 | U_i=0) $$
$$ P(Y_i=0) = \pi_i + (1-\pi_i) \exp(-\lambda_i) $$
这个公式清晰地展示了零值的两个来源：结构性零（概率 $\pi_i$）和随机性零（概率 $(1-\pi_i)\exp(-\lambda_i)$）。

对于正计数值 $k > 0$，它只能来源于易感亚群：
$$ P(Y_i=k) = P(U_i=0) \cdot P(Y_i=k | U_i=0) = (1-\pi_i) \frac{\exp(-\lambda_i) \lambda_i^k}{k!} $$

#### [参数估计](@entry_id:139349)与解释

我们可以利用这些模型的数学结构来估计其参数。例如，在一个关于医院导管相关尿路感染的研究中 [@problem_id:4993535]，假设我们从一个独立的子研究中得知，在确认有风险的日子里，感染事件的泊松率为 $\lambda=0.15$。在主监测的 $500$ 个导管日中，有 $455$ 天观测到零事件，即观测到的零值比例为 $\hat{p}_0 = 455/500 = 0.91$。我们可以通过[矩估计法](@entry_id:270941)，令理论零值概率等于观测比例来估计结构性零的概率 $\pi$（在问题中用 $p$ 表示）：
$$ 0.91 = \pi + (1-\pi) \exp(-0.15) $$
解这个关于 $\pi$ 的方程，我们得到：
$$ \pi = \frac{0.91 - \exp(-0.15)}{1 - \exp(-0.15)} \approx \frac{0.91 - 0.8607}{1 - 0.8607} \approx 0.3539 $$
这个结果表明，估计约有 $35.4\%$ 的日子属于“结构性零”日，即由于导管提前移除等原因，患者在这些天里根本没有感染风险。

在更复杂的回归设定中，$\pi_i$ 和 $\lambda_i$ 都可以作为协变量的函数。通常，我们使用 **logit 链接** 来建模膨胀概率 $\pi_i$，使用 **log 链接** 来建模泊松均值 $\lambda_i$：
$$ \operatorname{logit}(\pi_i) = \ln\left(\frac{\pi_i}{1-\pi_i}\right) = \boldsymbol{z}_i^\top \boldsymbol{\gamma} $$
$$ \ln(\lambda_i) = \boldsymbol{x}_i^\top \boldsymbol{\beta} $$
这里的 $\boldsymbol{z}_i$ 和 $\boldsymbol{x}_i$ 是协变量向量（可以相同或不同），$\boldsymbol{\gamma}$ 和 $\boldsymbol{\beta}$ 是相应的回归系数。

对这些系数的解释至关重要。例如，在一个呼吸道感染的研究中 [@problem_id:4993577]，如果疫苗接种状态（$V_i=1$ 表示接种）在 $\boldsymbol{z}_i$ 中对应的系数 $\hat{\gamma}_V$ 为正值（如 $1.5$），这意味着接种疫苗**增加**了个体成为“非易感者”（即结构性零成员）的对数几率。这在临床上是合理的，因为疫苗旨在提供免疫力，从而使一部分人完全不发生感染。系数 $\boldsymbol{\beta}$ 则描述了协变量对**易感人群中**事件发生率的影响。一个关键点是，由于模型的混合结构，模型的边际均值为 $\mathbb{E}[Y_i] = (1-\pi_i)\lambda_i$，它同时受到 $\boldsymbol{\gamma}$ 和 $\boldsymbol{\beta}$ 的影响。

#### [似然函数](@entry_id:141927)

为了通过最大似然法估计参数 $\boldsymbol{\gamma}$ 和 $\boldsymbol{\beta}$，我们需要构建[似然函数](@entry_id:141927)。对于一组独立的观测值 $\{y_i\}_{i=1}^n$，总[似然函数](@entry_id:141927)是每个观测值概率的乘积。利用[指示函数](@entry_id:186820) $I(y_i=0)$ 和 $I(y_i > 0)$，第 $i$ 个观测值的概率可以统一写作：
$$ P(y_i) = [\pi_i + (1-\pi_i)\exp(-\lambda_i)]^{I(y_i=0)} \left[ (1-\pi_i)\frac{\exp(-\lambda_i)\lambda_i^{y_i}}{y_i!} \right]^{I(y_i>0)} $$
将上述的 logit 和 log 链接函数形式代入，就可以得到关于 $\boldsymbol{\gamma}$ 和 $\boldsymbol{\beta}$ 的完整似然函数 [@problem_id:4993570]。值得注意的是，对于一个零值观测 $y_i=0$，其似然贡献为 $\pi_i + (1-\pi_i)\exp(-\lambda_i)$，它同时包含了 $\boldsymbol{\gamma}$ 和 $\boldsymbol{\beta}$ 的信息。这驳斥了一个常见的误解，即认为零值观测只对估计零膨胀部分（$\pi_i$）有贡献 [@problem_id:4993577]。实际上，模型通过所有数据（包括零值和正值）来共同区分结构性零和随机性零。

### 跨栏模型的深度剖析

#### 形式化定义与结构

跨栏模型将数据生成过程分解为两个独立的部分。
1.  **二元部分（跨栏决策）**：决定计数值是否为正。令 $\pi_i = P(Y_i > 0)$ 是第 $i$ 个个体“跨过栏”的概率。那么 $P(Y_i=0) = 1 - \pi_i$。这个概率通常通过 logistic [回归建模](@entry_id:170726)：
    $$ \operatorname{logit}(\pi_i) = \boldsymbol{x}_i^\top \boldsymbol{\alpha} $$
2.  **计数部分（正值强度）**：当且仅当 $Y_i > 0$ 时，此部分被激活。它描述了正计数的分布，其形式为一个**零点截断**的计数分布。例如，一个零点截断泊松分布的 PMF 为：
    $$ P(Y_i=k | Y_i>0) = \frac{\exp(-\mu_i)\mu_i^k / k!}{1 - \exp(-\mu_i)}, \quad k = 1, 2, 3, ... $$
    这里的参数 $\mu_i$ 通常也通过 log 链接与协变量 $\boldsymbol{z}_i$ 关联：$\ln(\mu_i) = \boldsymbol{z}_i^\top \boldsymbol{\beta}$。

这种结构清晰地将“是否发生”的倾向（由 $\pi_i$ 和 $\boldsymbol{\alpha}$ 描述）与“一旦发生，发生多少”的强度（由 $\mu_i$ 和 $\boldsymbol{\beta}$ 描述）分离开来 [@problem_id:4993512]。

#### 参数解释与[似然函数](@entry_id:141927)

在跨栏模型中，参数的解释是直接的。$\boldsymbol{\alpha}$ 中的系数描述了协变量对**任何事件发生概率**（即跨栏概率）的影响。$\boldsymbol{\beta}$ 中的系数则描述了协变量对**正计数条件下**事件强度的影响。

根据[全期望定律](@entry_id:265946)，跨栏模型的边际均值是：
$$ \mathbb{E}[Y_i] = P(Y_i>0) \cdot \mathbb{E}[Y_i | Y_i>0] = \pi_i \cdot \mathbb{E}[Y_i | Y_i>0] $$
这个公式完美地体现了模型的两部分结构 [@problem_id:4993512]。

跨栏模型的似然函数有一个非常重要的特性：它可以**分解**为两个独立部分的乘积。总[对数似然](@entry_id:273783) $l(\boldsymbol{\alpha}, \boldsymbol{\beta})$ 可以写成：
$$ l(\boldsymbol{\alpha}, \boldsymbol{\beta}) = l_1(\boldsymbol{\alpha}) + l_2(\boldsymbol{\beta}) $$
其中，$l_1(\boldsymbol{\alpha})$ 是对所有观测值的[二元结果](@entry_id:173636)（$Y_i>0$ 或 $Y_i=0$）进行 logistic 回归的[对数似然](@entry_id:273783)。$l_2(\boldsymbol{\beta})$ 是仅对 $Y_i>0$ 的那部分数据进行零点截断计数回归的[对数似然](@entry_id:273783) [@problem_id:4993541] [@problem_id:4993547]。

#### 可识别性与估计稳定性

似然函数的这种分解结构是跨栏[模型可识别性](@entry_id:186414)（identifiability）的关键。只要每个部分都满足其标准的可识别性条件，整个模型的参数 $(\boldsymbol{\alpha}, \boldsymbol{\beta})$ 就是可识别的，即使两部分使用了完全相同的协变量 [@problem_id:4993541]。具体来说：
- **$\boldsymbol{\alpha}$ 的可识别性**：需要用于拟合 logistic 回归的数据不存在“完全分离”（complete separation）问题，即至少有一个 $Y_i=0$ 和一个 $Y_i>0$ 的观测值。如果所有观测值都大于零，$\boldsymbol{\alpha}$ 的最大似然估计将趋于无穷大，导致无法识别。
- **$\boldsymbol{\beta}$ 的可识别性**：需要至少有一个正计数的观测值（$Y_i>0$）。如果所有观测值都为零，那么就没有数据来估计正值计数的分布，$\boldsymbol{\beta}$ 也将无法识别。

在实际应用中，即使理论上可识别，当协变量存在高度共线性，或在某些协变量组合的子集中出现数据分离（例如，某个治疗组的患者全部为零计数）时，最大似然估计可能会变得非常不稳定（[系数估计](@entry_id:175952)值极大且[标准误](@entry_id:635378)巨大）。在这种情况下，可以采用**惩罚似然**（penalized likelihood）方法，如岭回归（L2 惩罚）或Lasso（L1 惩罚），来稳定估计。例如，在目标函数中加入惩罚项 $\lambda_{\alpha} \|\boldsymbol{\alpha}\|_2^2 + \lambda_{\beta} \|\boldsymbol{\beta}\|_2^2$，可以在牺牲少量偏倚的情况下大幅降低估计的方差 [@problem_id:4993541]。

### [模型诊断](@entry_id:136895)与比较

#### 如何判断需要使用这些模型？

在选择复杂的零膨胀或跨栏模型之前，进行[模型诊断](@entry_id:136895)以确认是否存在“零值过多”现象是至关重要的一步。一个形式化的方法是进行**“零值优势”**（zero preponderance）检验 [@problem_id:4993537]。其基本思想是：
1.  首先拟合一个基线模型（如泊松或负二项回归模型）。
2.  利用拟合好的基线模型，为每个观测 $i$ 计算出其预测的零值概率 $p_i = P(Y_i=0 | \text{模型, 协变量}_i)$。
3.  计算出整个样本预期的零值总数 $m = \sum_{i=1}^n p_i$。
4.  将预期零值总数 $m$ 与实际观测到的零值总数 $Z = \sum_{i=1}^n I(y_i=0)$ 进行比较。

如果观测零值总数 $Z$ 显著大于预期值 $m$，则表明存在“零值过多”现象。我们可以构建一个基于[正态近似](@entry_id:261668)的[单侧检验](@entry_id:170263)来判断其统计显著性。

#### [零膨胀模型](@entry_id:756817)与跨栏模型的对比

选择[零膨胀模型](@entry_id:756817)还是跨栏模型，应主要基于对数据生成过程的**概念性理解**。前者适用于存在真正“免疫”或“非风险”亚群的情景，而后者更适合描述需要跨越某个“启动门槛”才能发生事件的过程。

尽管概念上不同，这两种模型在数学上也有着有趣的关系。一个重要的理论结果是，**在给定计数值为正的条件下，[零膨胀模型](@entry_id:756817)和跨栏模型所蕴含的正值计数分布是完全相同的** [@problem_id:4993542]。它们的根本区别在于对零值概率 $P(Y=0)$ 的构建方式不同 [@problem_id:4993554]。
- 跨栏模型：$P_H(Y=0 | \mathbf{x}) = 1 - \pi(\mathbf{x})$。这个概率只由二元部分的参数决定，与计数部分的参数无关。
- [零膨胀模型](@entry_id:756817)：$P_{ZI}(Y=0 | \mathbf{x}) = \pi(\mathbf{x}) + (1-\pi(\mathbf{x}))f(0 | \mu(\mathbf{x}), \kappa)$。这个概率同时依赖于膨胀部分（通过 $\pi(\mathbf{x})$）和计数部分（通过 $f(0 | ...)$，它依赖于 $\mu(\mathbf{x})$）。

这种结构差异导致了不同的行为。例如，在[零膨胀模型](@entry_id:756817)中，改变计数部分均值 $\mu(\mathbf{x})$ 的协变量会同时影响到模型的零值概率和边际均值；而在跨栏模型中，改变计数部分均值 $\mu(\mathbf{x})$ 的协变量只会影响边际均值，而不会影响零值概率 [@problem_id:4993532]。

有趣的是，在某些极限条件下，这两种模型会趋于一致。当计数部分的均值 $\mu(\mathbf{x})$ 变得非常大时（$\mu(\mathbf{x}) \to \infty$），随机性零的概率 $f(0 | \mu(\mathbf{x}))$ 将趋近于0。此时，[零膨胀模型](@entry_id:756817)的零值概率 $P_{ZI}(Y=0 | \mathbf{x})$ 将近似等于 $\pi(\mathbf{x})$。在这种情况下，如果我们将跨栏模型的跨栏概率设置为 $P(Y>0) = 1 - \pi(\mathbf{x})$，那么两个模型的零值概率就会非常接近 [@problem_id:4993554]。这为理解两种模型在特定数据情景下的相似性提供了深刻的洞见。