{"hands_on_practices": [{"introduction": "即使在完美随机化的试验中，我们也无法强制所有受试者都遵循其指定的治疗方案。这项练习 [@problem_id:4987082] 介绍了主分层（principal stratification）框架来处理这种不依从性问题，使我们能够专门为“依从者”（即那些仅在被提供治疗时才会接受治疗的受试者）估计治疗效果。这就是局部平均治疗效果（LATE），它是现实世界临床试验分析中的一个基石概念。", "problem": "一项随机住院研究评估了启动预防性抗病毒治疗是否能降低在第 $30$ 天前发生经聚合酶链反应确诊的呼吸道感染的概率。令 $Z \\in \\{0,1\\}$ 表示随机分配，其中 $Z=1$ 表示提供立即启动治疗，$Z=0$ 表示常规护理。令 $D(z) \\in \\{0,1\\}$ 表示在分配为 $z$ 的情况下的潜在治疗接受指标，其中 $D(z)=1$ 意味着患者在分配为 $z$ 时会启动抗病毒治疗。令 $Y(d) \\in \\{0,1\\}$ 表示如果患者的治疗接受状态为 $d$，在第 $30$ 天前是否感染的潜在结果。观测到的治疗接受情况为 $D= D(Z)$，观测到的结果为 $Y = Y(D)$。\n\n假设以下基本条件：\n- 稳定单位治疗价值假设 (SUTVA)：单位之间无干扰，且治疗定义明确，因此观测变量等于在实现的分配和治疗接受情况下的相应潜在结果，并且治疗接受 $d$ 只有一个版本。\n- 随机化：$Z$ 与所有潜在变量独立，因此 $Z \\perp \\{D(1), D(0), Y(1), Y(0)\\}$。\n- 排他性限制：分配 $Z$ 仅通过治疗接受 $D$ 影响 $Y$，因此对任何单位而言，如果 $D(1)=D(0)$，那么 $Y(1)=Y(0)$，等价地，对于 $z \\in \\{0,1\\}$，$Y(z)=Y(D(z))$。\n- 单调性：不存在“反抗者”，因此 $D(1) \\ge D(0)$ 几乎必然成立。\n- 正值性与工具变量相关性：$\\mathbb{P}(Z=1)0$，$\\mathbb{P}(Z=0)0$，且 $\\mathbb{P}(D=1 \\mid Z=1) \\ne \\mathbb{P}(D=1 \\mid Z=0)$。\n\n定义主分层 $G=(D(1),D(0))$，并令“依从者”分层为那些满足 $D(1)=1$ 和 $D(0)=0$ 的个体。考虑“依从者平均因果效应”，也称为“局部平均处理效应”(LATE)，定义为 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right] = \\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)=1, D(0)=0 \\right]$。\n\n在上述假设下，以下哪个陈述是正确的？\n\nA. 比率 $\\dfrac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[D \\mid Z=1] - \\mathbb{E}[D \\mid Z=0]}$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。\n\nB. 差值 $\\mathbb{E}[Y \\mid D=1] - \\mathbb{E}[Y \\mid D=0]$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。\n\nC. 差值 $\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。\n\nD. 比率 $\\dfrac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[D \\mid Z=1] - \\mathbb{E}[D \\mid Z=0]}$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)=1, D(0)=1 \\right]$。\n\nE. 仅在单调性假设下，无排他性限制时，差值 $\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]$ 等于 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。", "solution": "问题陈述描述了一个存在不完全依从性的随机对照试验，这种情景适用于工具变量 (IV) 方法。任务是在一组特定假设下，找出关于因果效应估计的正确陈述。\n\n### 步骤 1：提取已知条件\n\n问题提供了以下定义和假设：\n-   **随机分配（工具变量）：** $Z \\in \\{0,1\\}$，其中 $Z=1$ 表示提供治疗，$Z=0$ 表示常规护理。\n-   **潜在治疗接受：** $D(z) \\in \\{0,1\\}$，如果被分配到组 $z$ 时的治疗接受决策。\n-   **潜在结果：** $Y(d) \\in \\{0,1\\}$，如果治疗接受状态为 $d$ 时的结果。\n-   **观测变量：** $D = D(Z)$ 是观测到的治疗接受情况，$Y = Y(D)$ 是观测到的结果。\n-   **稳定单位治疗价值假设 (SUTVA)：** 单位之间无干扰，且潜在结果定义明确。这意味着 $D = D(Z)$ 和 $Y = Y(D(Z))$。\n-   **随机化：** $Z \\perp \\{D(1), D(0), Y(1), Y(0)\\}$。分配 $Z$ 与所有潜在结果和潜在治疗接受情况在统计上独立。\n-   **排他性限制：** 分配 $Z$ 仅通过治疗接受 $D$ 影响结果 $Y$。形式上，对任何单位而言，如果 $D(1)=D(0)$，那么 $Y(1)=Y(0)$。一个等价的表述是 $Y(z) = Y(D(z))$，对于 $z \\in \\{0,1\\}$，其中 $Y(z)$ 是分配为 $z$ 时的潜在结果。\n-   **单调性：** 对所有单位，$D(1) \\ge D(0)$。这排除了“反抗者”的存在，即那些 $D(1)=0$ 且 $D(0)=1$ 的单位。\n-   **正值性与工具变量相关性：** $\\mathbb{P}(Z=1)0$，$\\mathbb{P}(Z=0)0$，且 $\\mathbb{P}(D=1 \\mid Z=1) \\ne \\mathbb{P}(D=1 \\mid Z=0)$。\n-   **主分层：** 由一对潜在治疗接受情况 $G=(D(1),D(0))$ 定义。\n-   **依从者分层：** 个体子群体，对他们而言 $(D(1),D(0)) = (1,0)$，在单调性和二元治疗接受假设下，这等价于 $D(1)D(0)$。\n-   **感兴趣的因果估计量：** 依从者平均因果效应 (CACE) 或局部平均处理效应 (LATE)，定义为 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n该问题陈述是在潜在结果框架（也称为 Rubin 因果模型）内，由 Imbens 和 Angrist 发展的工具变量分析的标准、经典表述。\n\n-   **科学依据：** 整个问题植根于成熟的因果推断统计学和计量经济学理论。其设定和假设是识别 LATE 所需的标准条件。\n-   **适定性：** 问题陈述清晰，提供了推导唯一答案所需的所有必要定义和假设。问题要求识别一个特定的因果估计量，这是一个定义明确的数学问题。\n-   **客观性：** 问题使用精确、形式化的数学符号和术语来表述，没有歧义或主观内容。\n\n所有关于无效性的辅助检查都已通过。该问题并非不健全、不完整、矛盾、不现实、不适定或琐碎。这是一个形式化因果推断的有效练习。\n\n### 步骤 3：推导与选项评估\n\n我们被要求确定哪个表达式能正确识别局部平均处理效应 (LATE)，即 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。我们将分析选项 A 中的表达式，该表达式通常被称为 IV 估计量或 Wald 估计量，然后评估其他选项。\n\n表达式为 $\\dfrac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[D \\mid Z=1] - \\mathbb{E}[D \\mid Z=0]}$。\n\n**分析分子：$\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]$**\n\n这是对结果 $Y$ 的意向治疗 (ITT) 效应。\n-   根据 SUTVA，观测结果为 $Y=Y(D(Z))$。\n-   所以，$\\mathbb{E}[Y \\mid Z=1] = \\mathbb{E}[Y(D(1)) \\mid Z=1]$。根据随机化假设，$Z$ 与潜在结果独立，所以 $\\mathbb{E}[Y(D(1)) \\mid Z=1] = \\mathbb{E}[Y(D(1))]$。\n-   类似地，$\\mathbb{E}[Y \\mid Z=0] = \\mathbb{E}[Y(D(0)) \\mid Z=0] = \\mathbb{E}[Y(D(0))]$。\n-   因此，分子是 $\\mathbb{E}[Y(D(1))] - \\mathbb{E}[Y(D(0))]$。\n\n我们根据主分层 $G=(D(1),D(0))$ 对总体进行划分。由于单调性假设 ($D(1) \\ge D(0)$)，唯一可能的分层是：\n-   **始终接受者 (AT)：** $(D(1),D(0))=(1,1)$。令其在总体中的比例为 $\\pi_{AT}$。\n-   **依从者 (CO)：** $(D(1),D(0))=(1,0)$。令其在总体中的比例为 $\\pi_{CO}$。\n-   **从不接受者 (NT)：** $(D(1),D(0))=(0,0)$。令其在总体中的比例为 $\\pi_{NT}$。\n\n使用全期望定律，我们可以展开分子。排他性限制，形式为 $Y(z)=Y(D(z))$，现在至关重要。\n$$ \\mathbb{E}[Y(D(1))] = \\mathbb{E}[Y(D(1)) \\mid AT]\\pi_{AT} + \\mathbb{E}[Y(D(1)) \\mid CO]\\pi_{CO} + \\mathbb{E}[Y(D(1)) \\mid NT]\\pi_{NT} $$\n对始终接受者而言，$D(1)=1$，所以 $\\mathbb{E}[Y(D(1)) \\mid AT] = \\mathbb{E}[Y(1) \\mid AT]$。\n对依从者而言，$D(1)=1$，所以 $\\mathbb{E}[Y(D(1)) \\mid CO] = \\mathbb{E}[Y(1) \\mid CO]$。\n对从不接受者而言，$D(1)=0$，所以 $\\mathbb{E}[Y(D(1)) \\mid NT] = \\mathbb{E}[Y(0) \\mid NT]$。\n$$ \\Rightarrow \\mathbb{E}[Y(D(1))] = \\mathbb{E}[Y(1) \\mid AT]\\pi_{AT} + \\mathbb{E}[Y(1) \\mid CO]\\pi_{CO} + \\mathbb{E}[Y(0) \\mid NT]\\pi_{NT} $$\n类似地，对于 $\\mathbb{E}[Y(D(0))]$：\n$$ \\mathbb{E}[Y(D(0))] = \\mathbb{E}[Y(D(0)) \\mid AT]\\pi_{AT} + \\mathbb{E}[Y(D(0)) \\mid CO]\\pi_{CO} + \\mathbb{E}[Y(D(0)) \\mid NT]\\pi_{NT} $$\n对始终接受者而言，$D(0)=1$，所以 $\\mathbb{E}[Y(D(0)) \\mid AT] = \\mathbb{E}[Y(1) \\mid AT]$。\n对依从者而言，$D(0)=0$，所以 $\\mathbb{E}[Y(D(0)) \\mid CO] = \\mathbb{E}[Y(0) \\mid CO]$。\n对从不接受者而言，$D(0)=0$，所以 $\\mathbb{E}[Y(D(0)) \\mid NT] = \\mathbb{E}[Y(0) \\mid NT]$。\n$$ \\Rightarrow \\mathbb{E}[Y(D(0))] = \\mathbb{E}[Y(1) \\mid AT]\\pi_{AT} + \\mathbb{E}[Y(0) \\mid CO]\\pi_{CO} + \\mathbb{E}[Y(0) \\mid NT]\\pi_{NT} $$\n将两个表达式相减，AT 和 NT 的项相互抵消：\n$$ \\mathbb{E}[Y(D(1))] - \\mathbb{E}[Y(D(0))] = (\\mathbb{E}[Y(1) \\mid CO] - \\mathbb{E}[Y(0) \\mid CO])\\pi_{CO} $$\n这恰好是 $\\mathbb{E}[Y(1)-Y(0) \\mid D(1)D(0)] \\cdot \\mathbb{P}(D(1)D(0))$，即 $LATE \\cdot \\pi_{CO}$。\n\n**分析分母：$\\mathbb{E}[D \\mid Z=1] - \\mathbb{E}[D \\mid Z=0]$**\n\n这是对治疗接受 $D$ 的 ITT 效应。\n-   根据 SUTVA，$D=D(Z)$。\n-   $\\mathbb{E}[D \\mid Z=1] = \\mathbb{E}[D(1) \\mid Z=1] = \\mathbb{E}[D(1)]$，根据随机化。由于 $D$ 是二元的，这等于 $\\mathbb{P}(D(1)=1)$。\n-   $\\mathbb{E}[D \\mid Z=0] = \\mathbb{E}[D(0) \\mid Z=0] = \\mathbb{E}[D(0)]$，根据随机化。这等于 $\\mathbb{P}(D(0)=1)$。\n-   分母是 $\\mathbb{P}(D(1)=1) - \\mathbb{P}(D(0)=1)$。\n\n在各分层上展开：\n-   $\\mathbb{P}(D(1)=1) = \\mathbb{P}(D(1)=1 \\text{ and } G=AT) + \\mathbb{P}(D(1)=1 \\text{ and } G=CO) + \\mathbb{P}(D(1)=1 \\text{ and } G=NT) = \\pi_{AT} + \\pi_{CO}$。\n-   $\\mathbb{P}(D(0)=1) = \\mathbb{P}(D(0)=1 \\text{ and } G=AT) + \\mathbb{P}(D(0)=1 \\text{ and } G=CO) + \\mathbb{P}(D(0)=1 \\text{ and } G=NT) = \\pi_{AT}$。\n-   分母是 $(\\pi_{AT} + \\pi_{CO}) - \\pi_{AT} = \\pi_{CO}$，即依从者的比例，$\\mathbb{P}(D(1)D(0))$。工具变量相关性假设确保了 $\\pi_{CO} \\ne 0$。\n\n**结合分子和分母**\n\n$$ \\frac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[D \\mid Z=1] - \\mathbb{E}[D \\mid Z=0]} = \\frac{LATE \\cdot \\pi_{CO}}{\\pi_{CO}} = LATE $$\n该比率正确地识别了局部平均处理效应。\n\n**逐项分析**\n\n**A. 比率 $\\dfrac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[D \\mid Z=1] - \\mathbb{E}[D \\mid Z=0]}$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。**\n-   上述推导证实了这一说法。这是 LATE 框架的核心结果。\n-   **结论：正确。**\n\n**B. 差值 $\\mathbb{E}[Y \\mid D=1] - \\mathbb{E}[Y \\mid D=0]$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。**\n-   这是“按治疗”或“按方案”估计量。它比较了所有接受治疗者的平均结果，$\\mathbb{E}[Y(1) \\mid D=1]$，与所有未接受治疗者的平均结果，$\\mathbb{E}[Y(0) \\mid D=0]$。$\\{D=1\\}$ 和 $\\{D=0\\}$ 这两组不是随机的；它们是通过自我选择形成的，因此很可能在治疗之外的其他方面存在差异，从而导致混淆。例如，$D=1$ 的组是依从者和始终接受者的混合体，而 $D=0$ 的组是依从者和从不接受者的混合体。这些组不具有直接可比性。该估计量对于 LATE 是有偏的。\n-   **结论：不正确。**\n\n**C. 差值 $\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。**\n-   这是意向治疗 (ITT) 效应。如我们对分子的推导所示，$\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0] = LATE \\cdot \\pi_{CO}$。仅当 $\\pi_{CO}=1$ 时，即整个群体都由依从者组成（完全依从）时，它才等于 LATE。这在一般情况下是不成立的。\n-   **结论：不正确。**\n\n**D. 比率 $\\dfrac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[D \\mid Z=1] - \\mathbb{E}[D \\mid Z=0]}$ 识别了 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)=1, D(0)=1 \\right]$。**\n-   该比率识别的是 LATE，即依从者的平均处理效应，即 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)=1, D(0)=0 \\right]$。右边的表达式是始终接受者的平均处理效应。IV 估计量不能识别始终接受者的效应。\n-   **结论：不正确。**\n\n**E. 仅在单调性假设下，无排他性限制时，差值 $\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]$ 等于 $\\mathbb{E}\\!\\left[ Y(1)-Y(0) \\mid D(1)D(0) \\right]$。**\n-   这个陈述不正确，原因有二。首先，如选项 C 的分析所示，ITT 差异等于 $LATE \\cdot \\pi_{CO}$，而不是 LATE。其次，排他性限制是得出此结果的必要条件。没有它，ITT 效应将是 LATE 与工具变量 $Z$ 对始终接受者和从不接受者结果的直接效应的混合，这些效应不会相互抵消。\n-   **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "4987082"}, {"introduction": "在数据分析中，一种常见的做法是“控制”那些似乎位于治疗和结果之间因果路径上的变量。然而，这种做法可能会引入一种被称为“对撞机分层偏倚”（collider-stratification bias）的有害偏倚。本练习 [@problem_id:4987084] 使用一个结构模型，从数学上证明为何对治疗后变量进行调整会扭曲真实的因果效应，从而教授一个关于对撞机变量进行条件化处理的危险性的关键教训。", "problem": "一项重症监护医学领域的随机试验评估了一种新型抗炎疗法对第$7$天C反应蛋白的影响。令 $A \\in \\{0,1\\}$ 表示治疗分配，其中 $A=1$ 表示接受该疗法。随机化是均衡的，因此 $\\Pr(A=1)=\\Pr(A=0)=0.5$。令 $M$ 为随机化后$24$小时测量的一个治疗后早期生物标志物，令 $Y$ 为第$7$天的对数C反应蛋白结局。考虑潜在结局框架，其中 $Y^{a}$ 表示在治疗水平 $a \\in \\{0,1\\}$ 下将观察到的结局，而 $M^{a}$ 表示在 $a$ 下的治疗后生物标志物。假设稳定单位治疗价值假设（SUTVA）成立，并且随机化意味着 $A$ 对潜在结局没有未测量的混杂因素。\n\n假设数据生成机制与以下具有独立分量的线性结构模型一致：\n- 一个未测量的患者脆弱性 $U$，其中 $U \\sim \\mathcal{N}(0,1)$。\n- 一个治疗后生物标志物方程 $M = \\alpha A + \\beta U + \\varepsilon_{M}$，其中 $\\varepsilon_{M} \\sim \\mathcal{N}(0,\\sigma_{M}^{2})$ 且与 $(A,U)$ 独立。\n- 一个结局方程 $Y = \\tau A + \\theta M + \\delta U + \\varepsilon_{Y}$，其中 $\\varepsilon_{Y} \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})$ 且与 $(A,U,\\varepsilon_{M})$ 独立。\n\n该模型所隐含的有向无环图（DAG）具有箭头 $A \\to M \\to Y$、$A \\to Y$ 以及 $U \\to M$、$U \\to Y$。因为 $M$ 同时受到 $A$ 和 $U$ 的影响，所以 $M$ 是路径 $A \\to M \\leftarrow U \\to Y$ 上的一个对撞因子。\n\n一种常见但有缺陷的分析实践是将 $Y$ 对 $A$ 和 $M$ 进行回归，并将 $A$ 的系数解释为治疗的因果效应。令 $\\beta_{A}$ 表示在线性回归模型 $\\mathbb{E}[Y \\mid A, M] = \\beta_{0} + \\beta_{A} A + \\beta_{M} M$（该模型拟合于由上述模型生成的数据）中 $A$ 的普通最小二乘法（OLS）系数的概率极限（大样本极限）。\n\n从反事实定义和结构模型出发，以 $(\\alpha, \\beta, \\tau, \\theta, \\delta, \\sigma_{M}^{2})$ 的函数形式推导出 $\\beta_{A}$ 的封闭形式。您的最终答案必须是单一的封闭形式解析表达式。无需四舍五入，也无需单位。", "solution": "首先验证问题，以确保其是自洽的、一致的且科学上合理的。\n\n### 步骤1：提取已知条件\n- 治疗分配：$A \\in \\{0,1\\}$，随机化后 $\\Pr(A=1)=\\Pr(A=0)=0.5$。\n- 未测量的患者脆弱性：$U \\sim \\mathcal{N}(0,1)$。\n- 治疗后生物标志物：$M = \\alpha A + \\beta U + \\varepsilon_{M}$，其中 $\\varepsilon_{M} \\sim \\mathcal{N}(0,\\sigma_{M}^{2})$ 且与 $(A,U)$ 独立。\n- 结局：$Y = \\tau A + \\theta M + \\delta U + \\varepsilon_{Y}$，其中 $\\varepsilon_{Y} \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})$ 且与 $(A,U,\\varepsilon_{M})$ 独立。\n- 假设：稳定单位治疗价值假设（SUTVA）成立。随机化意味着 $A$ 与 $U$ 以及所有潜在结局（及其误差项）独立。\n- 目标量：在线性回归模型 $\\mathbb{E}[Y \\mid A, M] = \\beta_{0} + \\beta_{A} A + \\beta_{M} M$ 中，$A$ 的普通最小二乘法（OLS）系数的概率极限 $\\beta_A$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是因果推断中的一个标准理论练习，使用线性结构模型和潜在结局来说明对撞因子分层偏倚。这是统计学、计量经济学和流行病学中的一个核心课题。其设置在科学上和数学上都是合理的。\n- **提法恰当：** 该问题提供了推导目标量 $\\beta_A$ 所需的所有必要定义、结构方程和分布假设。可以确定一个唯一的解析解。\n- **客观性：** 问题以精确的数学和统计语言陈述，没有歧义或主观论断。\n\n该问题未表现出任何列出的无效性缺陷。所描述的DAG结构与结构方程一致。问题要求在一个程式化但一致的模型下，推导一个定义明确的统计量。\n\n### 步骤3：结论与行动\n问题是有效的。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n目标量 $\\beta_A$ 是在 $Y$ 对 $A$ 和 $M$ 的多元线性回归中，$A$ 的系数的OLS估计量的概率极限。在一个有两个预测变量的回归中，该系数的公式由OLS估计量的总体模拟给出：\n$$ \\beta_{A} = \\frac{\\text{Cov}(A, Y) \\text{Var}(M) - \\text{Cov}(M, Y) \\text{Cov}(A, M)}{\\text{Var}(A) \\text{Var}(M) - (\\text{Cov}(A, M))^2} $$\n我们必须使用所提供的结构模型和随机变量的性质来计算每个方差和协方差项。\n\n1.  **治疗分配变量 $A$ 的性质：**\n    由于 $A$ 是一个伯努利随机变量，且 $\\Pr(A=1)=0.5$：\n    -   $\\mathbb{E}[A] = 1 \\cdot \\Pr(A=1) + 0 \\cdot \\Pr(A=0) = 0.5$。\n    -   $\\text{Var}(A) = \\mathbb{E}[A^2] - (\\mathbb{E}[A])^2 = (1^2 \\cdot 0.5 + 0^2 \\cdot 0.5) - (0.5)^2 = 0.5 - 0.25 = 0.25$。\n\n2.  **用外生变量表示 $Y$：**\n    为简化协方差计算，我们将 $M$ 的表达式代入 $Y$ 的方程中：\n    $$ Y = \\tau A + \\theta (\\alpha A + \\beta U + \\varepsilon_{M}) + \\delta U + \\varepsilon_{Y} $$\n    $$ Y = (\\tau + \\theta\\alpha) A + (\\theta\\beta + \\delta) U + \\theta\\varepsilon_{M} + \\varepsilon_{Y} $$\n\n3.  **计算协方差和方差：**\n    我们使用 $A$、$U$、$\\varepsilon_{M}$ 和 $\\varepsilon_{Y}$ 相互独立的性质。我们还知道 $\\mathbb{E}[U]=0$，$\\mathbb{E}[\\varepsilon_M]=0$，$\\mathbb{E}[\\varepsilon_Y]=0$，$\\text{Var}(U)=1$，$\\text{Var}(\\varepsilon_M)=\\sigma_M^2$，以及 $\\text{Var}(\\varepsilon_Y)=\\sigma_Y^2$。\n\n    -   **$\\text{Cov}(A, M)$**：\n        $$ \\text{Cov}(A, M) = \\text{Cov}(A, \\alpha A + \\beta U + \\varepsilon_{M}) = \\alpha \\text{Cov}(A, A) + \\beta \\text{Cov}(A, U) + \\text{Cov}(A, \\varepsilon_{M}) $$\n        由于 $A$ 与 $U$ 和 $\\varepsilon_M$ 独立，$\\text{Cov}(A, U)=0$ 且 $\\text{Cov}(A, \\varepsilon_M)=0$。\n        $$ \\text{Cov}(A, M) = \\alpha \\text{Var}(A) = 0.25\\alpha $$\n\n    -   **$\\text{Var}(M)$**：\n        $$ \\text{Var}(M) = \\text{Var}(\\alpha A + \\beta U + \\varepsilon_{M}) $$\n        由于 $A$、$U$ 和 $\\varepsilon_M$ 的独立性：\n        $$ \\text{Var}(M) = \\alpha^2 \\text{Var}(A) + \\beta^2 \\text{Var}(U) + \\text{Var}(\\varepsilon_{M}) = 0.25\\alpha^2 + \\beta^2 \\cdot 1 + \\sigma_{M}^{2} $$\n        $$ \\text{Var}(M) = 0.25\\alpha^2 + \\beta^2 + \\sigma_{M}^{2} $$\n\n    -   **$\\text{Cov}(A, Y)$**：\n        使用 $Y$ 的展开式：\n        $$ \\text{Cov}(A, Y) = \\text{Cov}(A, (\\tau + \\theta\\alpha) A + (\\theta\\beta + \\delta) U + \\theta\\varepsilon_{M} + \\varepsilon_{Y}) $$\n        由于 $A$ 与 $U, \\varepsilon_M, \\varepsilon_Y$ 独立：\n        $$ \\text{Cov}(A, Y) = (\\tau + \\theta\\alpha) \\text{Var}(A) = 0.25(\\tau + \\theta\\alpha) $$\n\n    -   **$\\text{Cov}(M, Y)$**：\n        使用 $M$ 的定义和 $Y$ 的展开式：\n        $$ \\text{Cov}(M, Y) = \\text{Cov}(\\alpha A + \\beta U + \\varepsilon_{M}, (\\tau + \\theta\\alpha) A + (\\theta\\beta + \\delta) U + \\theta\\varepsilon_{M} + \\varepsilon_{Y}) $$\n        利用协方差的双线性以及 $A, U, \\varepsilon_M, \\varepsilon_Y$ 的相互独立性展开：\n        $$ \\text{Cov}(M, Y) = \\text{Cov}(\\alpha A, (\\tau + \\theta\\alpha) A) + \\text{Cov}(\\beta U, (\\theta\\beta + \\delta) U) + \\text{Cov}(\\varepsilon_{M}, \\theta\\varepsilon_{M}) $$\n        所有交叉项的协方差均为零。\n        $$ \\text{Cov}(M, Y) = \\alpha(\\tau + \\theta\\alpha)\\text{Var}(A) + \\beta(\\theta\\beta + \\delta)\\text{Var}(U) + \\theta\\text{Var}(\\varepsilon_{M}) $$\n        $$ \\text{Cov}(M, Y) = \\alpha(\\tau + \\theta\\alpha)(0.25) + \\beta(\\theta\\beta + \\delta)(1) + \\theta\\sigma_{M}^{2} $$\n        $$ \\text{Cov}(M, Y) = 0.25\\alpha\\tau + 0.25\\theta\\alpha^2 + \\theta\\beta^2 + \\beta\\delta + \\theta\\sigma_{M}^{2} $$\n\n4.  **组合 $\\beta_A$ 的表达式：**\n    首先，我们计算 $\\beta_A$ 主公式的分母：\n    $$ D = \\text{Var}(A) \\text{Var}(M) - (\\text{Cov}(A, M))^2 $$\n    $$ D = (0.25)(0.25\\alpha^2 + \\beta^2 + \\sigma_{M}^{2}) - (0.25\\alpha)^2 $$\n    $$ D = 0.0625\\alpha^2 + 0.25\\beta^2 + 0.25\\sigma_{M}^{2} - 0.0625\\alpha^2 $$\n    $$ D = 0.25(\\beta^2 + \\sigma_{M}^{2}) $$\n\n    接下来，我们计算分子：\n    $$ N = \\text{Cov}(A, Y) \\text{Var}(M) - \\text{Cov}(M, Y) \\text{Cov}(A, M) $$\n    $$ N = [0.25(\\tau + \\theta\\alpha)][0.25\\alpha^2 + \\beta^2 + \\sigma_{M}^{2}] - [0.25\\alpha\\tau + 0.25\\theta\\alpha^2 + \\theta\\beta^2 + \\beta\\delta + \\theta\\sigma_{M}^{2}][0.25\\alpha] $$\n    我们可以从整个表达式中提取因子 $0.25$：\n    $$ N = 0.25 \\left( (\\tau + \\theta\\alpha)(0.25\\alpha^2 + \\beta^2 + \\sigma_{M}^{2}) - \\alpha(0.25\\alpha\\tau + 0.25\\theta\\alpha^2 + \\theta\\beta^2 + \\beta\\delta + \\theta\\sigma_{M}^{2}) \\right) $$\n    展开括号内的项：\n    $$ (\\tau + \\theta\\alpha)(\\dots) = 0.25\\alpha^2\\tau + \\beta^2\\tau + \\sigma_M^2\\tau + 0.25\\alpha^3\\theta + \\alpha\\beta^2\\theta + \\alpha\\sigma_M^2\\theta $$\n    $$ -\\alpha(\\dots) = -0.25\\alpha^2\\tau - 0.25\\alpha^3\\theta - \\alpha\\beta^2\\theta - \\alpha\\beta\\delta - \\alpha\\sigma_M^2\\theta $$\n    将这两个展开式相加，有几个项会消去：\n    - $0.25\\alpha^2\\tau$ 与 $-0.25\\alpha^2\\tau$ 消去。\n    - $0.25\\alpha^3\\theta$ 与 $-0.25\\alpha^3\\theta$ 消去。\n    - $\\alpha\\beta^2\\theta$ 与 $-\\alpha\\beta^2\\theta$ 消去。\n    - $\\alpha\\sigma_M^2\\theta$ 与 $-\\alpha\\sigma_M^2\\theta$ 消去。\n    剩余的项是 $\\beta^2\\tau + \\sigma_M^2\\tau - \\alpha\\beta\\delta = \\tau(\\beta^2 + \\sigma_M^2) - \\alpha\\beta\\delta$。\n    所以，分子是：\n    $$ N = 0.25(\\tau(\\beta^2 + \\sigma_{M}^{2}) - \\alpha\\beta\\delta) $$\n\n    最后，我们计算比率 $\\beta_A = N/D$：\n    $$ \\beta_A = \\frac{0.25(\\tau(\\beta^2 + \\sigma_{M}^{2}) - \\alpha\\beta\\delta)}{0.25(\\beta^2 + \\sigma_{M}^{2})} $$\n    $$ \\beta_A = \\frac{\\tau(\\beta^2 + \\sigma_{M}^{2}) - \\alpha\\beta\\delta}{\\beta^2 + \\sigma_{M}^{2}} $$\n    这可以简化为：\n    $$ \\beta_A = \\tau - \\frac{\\alpha\\beta\\delta}{\\beta^2 + \\sigma_{M}^{2}} $$\n    这个表达式揭示了OLS系数 $\\beta_A$ 是 $A$ 对 $Y$ 的直接因果效应 ($\\tau$) 和一个偏倚项的和。这个偏倚项 $-\\frac{\\alpha\\beta\\delta}{\\beta^2 + \\sigma_{M}^{2}}$ 的产生原因在于，以生物标志物 $M$ 为条件的回归通过未测量的混杂因子 $U$ 打开了治疗 $A$ 和结局 $Y$ 之间的一条伪路径。这种现象被称为对撞因子分层偏倚。", "answer": "$$\\boxed{\\tau - \\frac{\\alpha\\beta\\delta}{\\beta^2 + \\sigma_{M}^{2}}}$$", "id": "4987084"}, {"introduction": "标准的反事实框架通常假设一个人的治疗不会影响另一个人的结果（即SUTVA假设中的“无干扰”部分）。在许多医学和公共卫生情境中，如疫苗接种或预防性用药研究，这一假设是不现实的。本练习 [@problem_id:4987059] 将挑战您调整因果推断的核心原则，特别是逆概率加权（IPW），以适应存在此类溢出效应的网络环境。", "problem": "考虑一项基于网络的医院预防研究，其中患者是已知无向接触网络 $G$ 中的节点，其邻接集为 $N_i$，度为 $d_i = |N_i|$。每位患者 $i$ 接受二元预防措施 $A_i \\in \\{0,1\\}$，该措施根据参数为 $p \\in (0,1)$ 的伯努利设计在患者间独立分配。结果 $Y_i \\in \\{0,1\\}$ 是随访期间是否感染的指标。假设稳定单元处理值假设 (SUTVA) 因干扰而被违反，但干扰完全由一个暴露映射捕获：患者 $i$ 的潜在结果取决于 $A_i$ 和被治疗的邻居数量 $S_i(\\mathbf{A}) = \\sum_{j \\in N_i} A_j$，因此潜在结果可以写成 $Y_i(\\mathbf{a}) = Y_i(a_i, s_i(\\mathbf{a}))$，其中 $s_i(\\mathbf{a}) = \\sum_{j \\in N_i} a_j$。假设一致性：如果 $A_i = a$ 且 $S_i = s$，则观察到的结果等于 $Y_i(a,s)$；并假设随机化下的可交换性：处理分配独立于所有潜在结果。进一步假设正定性：对于所有 $i$ 以及任何 $a \\in \\{0,1\\}$ 和任何 $s \\in \\{0,1,\\ldots,d_i\\}$，在该设计下 $(A_i=a, S_i=s)$ 的概率严格为正（对于 $p \\in (0,1)$ 和可行的 $s \\le d_i$ 成立）。\n\n定义待估量 $\\mu_{a,s} = \\mathbb{E}\\left[ Y_i(a,s) \\right]$，即如果对一个随机选择的患者，其自身预防措施被设置为 $a$ 且恰好有 $s$ 个邻居接受了预防措施时的平均感染风险，期望是基于网络位置的经验分布和随机化机制计算的。\n\n在上述假设下，以下哪个基于 Horvitz–Thompson 加权的逆概率加权 (IPW) 估计量对于 $\\mu_{a,s}$ 是无偏的？每个选项提出了一个形式为\n$$\n\\hat{\\mu}_{a,s} = \\frac{1}{n} \\sum_{i=1}^n W_i(a,s)\\, \\mathbb{I}\\{A_i=a,\\, S_i=s\\}\\, Y_i,\n$$\n的估计量，并给出了具体的权重 $W_i(a,s)$ 选择。\n\nA.\n$$\nW_i(a,s) = \\left[ p^a (1-p)^{1-a} \\binom{d_i}{s} p^s (1-p)^{d_i - s} \\right]^{-1}.\n$$\n\nB.\n$$\nW_i(a,s) = \\left[ p^{a+s} (1-p)^{1-a + d_i - s} \\right]^{-1}.\n$$\n\nC.\n$$\nW_i(a,s) = \\left[ p^a (1-p)^{1-a} \\right]^{-1}.\n$$\n\nD.\n$$\nW_i(a,s) = \\left[ p^a (1-p)^{1-a} \\binom{n-1}{s} p^s (1-p)^{(n-1) - s} \\right]^{-1}.\n$$\n\n选择唯一的正确选项。", "solution": "用户希望我在网络设定下，为一个已定义的因果待估量确定正确的逆概率加权 (IPW) 估计量。\n\n### 步骤 1：验证问题陈述\n\n我首先根据指定标准验证问题陈述。\n\n**1. 提取已知条件：**\n-   一个已知的无向接触网络 $G$，包含 $n$ 个患者（节点）。\n-   患者 $i$ 的邻接集：$N_i$。\n-   节点 $i$ 的度：$d_i = |N_i|$。\n-   患者 $i$ 的处理：$A_i \\in \\{0,1\\}$，一种二元预防措施。\n-   处理分配机制：对于 $i=1, \\dots, n$，$A_i$ 从参数为 $p \\in (0,1)$ 的伯努利分布中独立分配。\n-   患者 $i$ 的结果：$Y_i \\in \\{0,1\\}$，一个感染指标。\n-   干扰：稳定单元处理值假设 (SUTVA) 被违反。\n-   暴露映射：患者 $i$ 的潜在结果取决于其自身的处理 $A_i$ 和被治疗的邻居数量 $S_i(\\mathbf{A}) = \\sum_{j \\in N_i} A_j$。潜在结果记为 $Y_i(a_i, s_i(\\mathbf{a}))$。\n-   假设：\n    -   一致性：若 $A_i = a$ 且 $S_i=s$，则观察到的结果 $Y_i = Y_i(a,s)$。\n    -   可交换性：处理分配向量 $\\mathbf{A}$ 与所有潜在结果 $\\{Y_i(a,s)\\}$ 独立。\n    -   正定性：对于所有 $i$，$a \\in \\{0,1\\}$，$s \\in \\{0, \\dots, d_i\\}$，概率 $\\mathbb{P}(A_i=a, S_i=s)  0$。\n-   感兴趣的待估量：$\\mu_{a,s} = \\mathbb{E}\\left[ Y_i(a,s) \\right]$，在暴露为 $(a,s)$ 下随机选择患者的平均感染风险。考虑到所提议的估计量结构是对样本中 $n$ 个患者的平均，该待估量最好被解释为有限总体平均潜在结果：$\\mu_{a,s} = \\frac{1}{n} \\sum_{i=1}^n Y_i(a,s)$。\n-   提议的估计量形式：$\\hat{\\mu}_{a,s} = \\frac{1}{n} \\sum_{i=1}^n W_i(a,s)\\, \\mathbb{I}\\{A_i=a,\\, S_i=s\\}\\, Y_i$。\n-   问题：哪个权重 $W_i(a,s)$ 能使 $\\hat{\\mu}_{a,s}$ 成为 $\\mu_{a,s}$ 的无偏估计量？\n\n**2. 验证：**\n该问题在网络因果推断领域中定义明确。这是一个研究溢出效应的标准设置。在存在干扰的情况下，为识别因果效应，一致性、可交换性和正定性等假设在指定的暴露映射下是常见且必要的。处理分配机制（独立伯努利试验）被清晰地指定。问题要求推导一个无偏的 Horvitz-Thompson 型估计量，这是一个标准且定义明确的统计问题。语言精确、客观。没有科学或逻辑上的缺陷。\n\n**3. 结论：**\n问题陈述是**有效**的。我将继续推导解决方案。\n\n### 步骤 2：推导正确权重\n\n目标是找到权重 $W_i(a,s)$，使得估计量 $\\hat{\\mu}_{a,s}$ 对待估量 $\\mu_{a,s}$ 是无偏的。无偏性的条件是估计量的期望等于待估量的真值。期望是针对随机处理分配 $\\mathbf{A}$ 的分布计算的。\n\n待估量为 $\\mu_{a,s} = \\frac{1}{n} \\sum_{i=1}^n Y_i(a,s)$。\n估计量为 $\\hat{\\mu}_{a,s} = \\frac{1}{n} \\sum_{i=1}^n W_i(a,s)\\, \\mathbb{I}\\{A_i=a,\\, S_i=s\\}\\, Y_i$。\n\n让我们计算估计量的期望：\n$$ \\mathbb{E}[\\hat{\\mu}_{a,s}] = \\mathbb{E}\\left[ \\frac{1}{n} \\sum_{i=1}^n W_i(a,s) \\, \\mathbb{I}\\{A_i=a, S_i=s\\} \\, Y_i \\right] $$\n\n根据期望的线性性质，我们可以将期望移到求和内部：\n$$ \\mathbb{E}[\\hat{\\mu}_{a,s}] = \\frac{1}{n} \\sum_{i=1}^n \\mathbb{E}\\left[ W_i(a,s) \\, \\mathbb{I}\\{A_i=a, S_i=s\\} \\, Y_i \\right] $$\n\n根据一致性假设，对于观察到暴露 $(A_i, S_i) = (a,s)$ 的个体，其观察到的结果 $Y_i$ 等于潜在结果 $Y_i(a,s)$。因此，我们可以重写求和内的项：\n$$ \\mathbb{I}\\{A_i=a, S_i=s\\} \\, Y_i = \\mathbb{I}\\{A_i=a, S_i=s\\} \\, Y_i(a,s) $$\n所以期望的表达式变为：\n$$ \\mathbb{E}[\\hat{\\mu}_{a,s}] = \\frac{1}{n} \\sum_{i=1}^n \\mathbb{E}\\left[ W_i(a,s) \\, \\mathbb{I}\\{A_i=a, S_i=s\\} \\, Y_i(a,s) \\right] $$\n\n潜在结果 $Y_i(a,s)$ 对每个个体而言是固定的量，权重 $W_i(a,s)$ 是关于 $i$、$a$ 和 $s$ 的非随机函数。根据可交换性假设，潜在结果独立于处理分配向量 $\\mathbf{A}$。因此，我们可以将 $Y_i(a,s)$ 和 $W_i(a,s)$ 从期望中提出来，该期望是针对 $\\mathbf{A}$ 计算的：\n$$ \\mathbb{E}[\\hat{\\mu}_{a,s}] = \\frac{1}{n} \\sum_{i=1}^n W_i(a,s) \\, Y_i(a,s) \\, \\mathbb{E}\\left[ \\mathbb{I}\\{A_i=a, S_i=s\\} \\right] $$\n\n指示函数的期望是其所指示事件的概率：\n$$ \\mathbb{E}\\left[ \\mathbb{I}\\{A_i=a, S_i=s\\} \\right] = \\mathbb{P}(A_i=a, S_i=s) $$\n\n所以，我们有：\n$$ \\mathbb{E}[\\hat{\\mu}_{a,s}] = \\frac{1}{n} \\sum_{i=1}^n W_i(a,s) \\, Y_i(a,s) \\, \\mathbb{P}(A_i=a, S_i=s) $$\n\n为了使 $\\hat{\\mu}_{a,s}$ 对 $\\mu_{a,s} = \\frac{1}{n} \\sum_{i=1}^n Y_i(a,s)$ 无偏，我们必须有：\n$$ \\frac{1}{n} \\sum_{i=1}^n W_i(a,s) \\, Y_i(a,s) \\, \\mathbb{P}(A_i=a, S_i=s) = \\frac{1}{n} \\sum_{i=1}^n Y_i(a,s) $$\n这个等式必须对任何一组潜在结果 $\\{Y_i(a,s)\\}$ 都成立。这意味着对于求和中的每一项 $i$，我们必须有：\n$$ W_i(a,s) \\, \\mathbb{P}(A_i=a, S_i=s) = 1 $$\n这给出了 Horvitz-Thompson 权重的公式：\n$$ W_i(a,s) = \\frac{1}{\\mathbb{P}(A_i=a, S_i=s)} $$\n\n下一步是计算概率 $\\mathbb{P}(A_i=a, S_i=s)$。事件 $\\{A_i=a\\}$ 涉及患者 $i$ 的处理。事件 $\\{S_i=s\\}$ 涉及 $i$ 的邻居 $\\{A_j\\}_{j \\in N_i}$ 的处理。由于网络是无向的且我们假设没有自环，患者 $i$ 不在自己的邻居集 $N_i$ 中。问题陈述处理 $A_k$ 对所有 $k=1, \\dots, n$ 都是独立分配的。因此，随机变量 $A_i$ 与随机变量集合 $\\{A_j\\}_{j \\in N_i}$ 独立。这种独立性允许我们分解联合概率：\n$$ \\mathbb{P}(A_i=a, S_i=s) = \\mathbb{P}(A_i=a) \\times \\mathbb{P}(S_i=s) $$\n\n现在我们计算每个因子：\n1.  $\\mathbb{P}(A_i=a)$：患者 $i$ 的处理 $A_i$ 从参数为 $p$ 的伯努利分布中抽取。\n    -   如果 $a=1$，$\\mathbb{P}(A_i=1) = p$。\n    -   如果 $a=0$，$\\mathbb{P}(A_i=0) = 1-p$。\n    这可以紧凑地写成 $\\mathbb{P}(A_i=a) = p^a (1-p)^{1-a}$。\n\n2.  $\\mathbb{P}(S_i=s)$：邻里暴露为 $S_i = \\sum_{j \\in N_i} A_j$。这是 $d_i = |N_i|$ 个独立同分布的伯努利随机变量之和，每个随机变量的参数都为 $p$。独立同分布的伯努利试验之和服从二项分布。因此，$S_i \\sim \\text{Binomial}(d_i, p)$。其概率质量函数为：\n    $$ \\mathbb{P}(S_i=s) = \\binom{d_i}{s} p^s (1-p)^{d_i-s} $$\n    这对于 $s \\in \\{0, 1, \\dots, d_i\\}$ 是有定义的。\n\n结合这两个因子，我们得到暴露的联合概率：\n$$ \\mathbb{P}(A_i=a, S_i=s) = p^a (1-p)^{1-a} \\binom{d_i}{s} p^s (1-p)^{d_i - s} $$\n\n正确的权重是这个概率的倒数：\n$$ W_i(a,s) = \\frac{1}{p^a (1-p)^{1-a} \\binom{d_i}{s} p^s (1-p)^{d_i - s}} = \\left[ p^a (1-p)^{1-a} \\binom{d_i}{s} p^s (1-p)^{d_i - s} \\right]^{-1} $$\n\n### 步骤 3：评估选项\n\n我现在将根据推导出的权重评估每个给定选项。\n\n**A.** $W_i(a,s) = \\left[ p^a (1-p)^{1-a} \\binom{d_i}{s} p^s (1-p)^{d_i - s} \\right]^{-1}.$\n这个表达式与上面推导的权重完全匹配。它正确地表示了观察到患者 $i$ 暴露为 $(a,s)$ 的联合概率的倒数，该概率是患者 $i$ 自身处理概率与他的 $d_i$ 个邻居中有 $s$ 个被处理的概率的乘积。\n**结论：** 正确。\n\n**B.** $W_i(a,s) = \\left[ p^{a+s} (1-p)^{1-a + d_i - s} \\right]^{-1}.$\n该选项正确地组合了完整概率表达式中 $p$ 和 $1-p$ 的幂。然而，它省略了二项式系数 $\\binom{d_i}{s}$。这个系数至关重要，因为它计算了从 $d_i$ 个邻居中选择哪 $s$ 个被处理的方式数量。省略这一项计算的是邻居处理的某个特定配置的概率，而不是总共有 $s$ 个邻居被处理这一聚合事件的概率。\n**结论：** 错误。\n\n**C.** $W_i(a,s) = \\left[ p^a (1-p)^{1-a} \\right]^{-1}.$\n这个权重仅仅是 $\\mathbb{P}(A_i=a)$ 的倒数。它忽略了概率的邻里暴露部分 $\\mathbb{P}(S_i=s)$。要做到无偏，估计量必须按完整观察暴露 $(a,s)$ 的概率的倒数进行加权，而不仅仅是 $a$。在 SUTVA（无干预）假设下，这个权重对于估计效应是正确的，而该假设在这里被明确违反了。\n**结论：** 错误。\n\n**D.** $W_i(a,s) = \\left[ p^a (1-p)^{1-a} \\binom{n-1}{s} p^s (1-p)^{(n-1) - s} \\right]^{-1}.$\n该选项错误地建模了邻里暴露的概率。它在二项概率中使用了 $\\binom{n-1}{s}$ 和总共 $n-1$ 次试验，其中 $n$ 是研究中患者的总数。邻里暴露 $S_i$ 仅由 $i$ 的直接邻居的处理之和定义，其数量为 $d_i$。概率计算必须使用节点 $i$ 的度 $d_i$，而不是 $n-1$（除非网络是一个完全图，且对所有 $i$ 都有 $d_i = n-1$，但这并未给出，并且通常不成立）。\n**结论：** 错误。\n\n基于推导和评估，只有选项 A 提供了确保估计量无偏的正确权重。", "answer": "$$\\boxed{A}$$", "id": "4987059"}]}