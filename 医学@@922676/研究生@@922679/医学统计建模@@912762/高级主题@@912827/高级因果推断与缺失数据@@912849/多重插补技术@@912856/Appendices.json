{"hands_on_practices": [{"introduction": "在我们深入研究多重插补的复杂性之前，至关重要的是要理解为什么像单次插补这样看似简单的方法是不充分的。这个练习将直接对比“不当”的单次插补和“适当”的多重插补策略，旨在量化将插补数据视为真实数据所导致的方差低估问题。通过这个计算，您将亲身体会到多重插补的核心优势——它能够正确地将由缺失数据引起的不确定性反映在最终的统计推断中。[@problem_id:4976456]", "problem": "一项针对高血压患者的临床试验测量了从基线到$3$个月的收缩压（SBP）变化，对于$i=1,\\dots,n$，记为$Y_{i}$。假设结果模型为 $Y_{i} \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，根据先前的外部验证，已知残差方差为 $\\sigma^{2} = 100$ $\\mathrm{mmHg}^{2}$。部分结果完全随机缺失（MCAR），且与 $Y_{i}$ 无关。总样本量为 $n = 200$，其中观测到 $n_{\\mathrm{obs}} = 120$ 个结果，缺失 $n_{\\mathrm{miss}} = 80$ 个结果。\n\n考虑两种用于估计总体均值 $\\mu$ 的填补与分析策略：\n1. 不当单次填补：通过从 $\\mathcal{N}(\\bar{Y}_{\\mathrm{obs}}, \\sigma^{2})$ 中独立抽取每个缺失的 $Y_{i}$ 来执行单次填补，其中 $\\bar{Y}_{\\mathrm{obs}}$ 是观测结果的样本均值。将填补完成的数据当作完全观测数据进行分析，使用样本均值的完整数据方差公式，在已知残差方差的假设下，该公式为 $\\sigma^{2}/n$。\n2. 适当多重填补（MI）：执行 $m = 20$ 次填补。对于每次填补 $j$，从给定观测数据的后验分布中抽取 $\\mu^{(j)}$，然后从 $\\mathcal{N}(\\mu^{(j)}, \\sigma^{2})$ 中独立抽取每个缺失的 $Y_{i}$。以正确汇总填补内不确定性和填补间不确定性的方式，合并 $m$ 个完整数据集的点估计和方差。多重填补（MI）指的是重复进行填补，并适当组合估计值以反映所有不确定性来源。\n\n使用基本概率定律和 MCAR 假设，推导在适当 MI 策略下 $\\mu$ 的估计量的期望总方差，以及在不当单次填补策略下的期望方差。将不当策略相对于适当 MI 策略的偏差定义为 $\\mathrm{Bias} = \\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] - \\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}]$。为指定的 $n$、$n_{\\mathrm{obs}}$、$n_{\\mathrm{miss}}$、$\\sigma^{2}$ 和 $m$ 计算该偏差的数值。\n\n以 $\\mathrm{mmHg}^{2}$ 为单位表示最终偏差，并将答案四舍五入到四位有效数字。", "solution": "问题要求推导和计算不当单次填补方差估计量相对于适当多重填补（MI）方差估计量对总体均值 $\\mu$ 的偏差。偏差定义为 $\\mathrm{Bias} = \\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] - \\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}]$。\n\n首先，我们分析不当单次填补策略（策略1）。\n问题陈述，在单次填补后，将完整数据视为完全观测数据进行分析，样本均值的方差采用已知残差方差下的完整数据方差公式，即 $\\sigma^{2}/n$。因此，此策略下的方差估计量是由给定参数决定的一个常数值：\n$$\n\\widehat{V}_{\\mathrm{improper}} = \\frac{\\sigma^{2}}{n}\n$$\n常数的期望就是其本身。因此，不当策略下的期望方差为：\n$$\n\\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] = \\frac{\\sigma^{2}}{n}\n$$\n\n接下来，我们分析适当多重填补策略（策略2）。\n$\\mu$ 的 MI 估计量的总方差使用鲁宾法则（Rubin's rules）进行估计。总方差 $\\widehat{V}_{\\mathrm{proper}}$ 的公式是填补内方差 $W$ 与填补间方差 $B$ 的和，并根据有限的填补次数 $m$ 进行调整：\n$$\n\\widehat{V}_{\\mathrm{proper}} = W + \\left(1 + \\frac{1}{m}\\right)B\n$$\n我们需要求出该估计量的期望，$\\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}] = \\mathbb{E}[W] + \\left(1 + \\frac{1}{m}\\right)\\mathbb{E}[B]$。\n\n填补内方差 $W$ 是来自 $m$ 个完整数据集的方差估计值的平均值。对于每个完整数据集 $j$，均值 $\\hat{\\mu}^{(j)}$ 的方差估计值为 $\\widehat{V}^{(j)}$。由于数据被认为是完整的，并且残差方差 $\\sigma^2$ 已知，所以该方差为 $\\widehat{V}^{(j)} = \\sigma^2/n$。对于所有 $j=1, \\dots, m$，这个值是相同的。\n$$\nW = \\frac{1}{m}\\sum_{j=1}^{m} \\widehat{V}^{(j)} = \\frac{1}{m}\\sum_{j=1}^{m} \\frac{\\sigma^{2}}{n} = \\frac{\\sigma^{2}}{n}\n$$\n由于 $W$ 是一个常数，其期望为 $\\mathbb{E}[W] = \\sigma^2/n$。\n\n填补间方差 $B$ 是 $m$ 次填补中 $\\mu$ 的点估计值的样本方差：\n$$\nB = \\frac{1}{m-1}\\sum_{j=1}^{m} (\\hat{\\mu}^{(j)} - \\bar{\\mu}_{\\mathrm{MI}})^{2}\n$$\n其中 $\\hat{\\mu}^{(j)}$ 是第 $j$ 个填补数据集的样本均值，$\\bar{\\mu}_{\\mathrm{MI}} = \\frac{1}{m}\\sum_{j=1}^{m} \\hat{\\mu}^{(j)}$。\n$B$ 是真实的填补间方差的无偏估计量，该方差的产生是因为缺失数据是从一个反映真实参数不确定性的分布中填补的。设这个真实方差为 $B_{\\mathrm{true}}$。因此，$\\mathbb{E}[B] = B_{\\mathrm{true}}$。\n在 MI 底层的贝叶斯框架中，给定观测数据 $Y_{\\mathrm{obs}}$，参数 $\\mu$ 的总方差为 $T = \\text{Var}(\\mu|Y_{\\mathrm{obs}})$。这个总方差可以分解为完整数据方差 $U = \\text{Var}(\\mu|Y_{\\mathrm{obs}}, Y_{\\mathrm{miss}})$ 和由缺失数据引起的方差 $B_{\\mathrm{true}}$。也就是说，$T = U + B_{\\mathrm{true}}$。在 $\\mu$ 的无信息先验和已知 $\\sigma^2$ 的假设下：\n完整数据后验方差（即我们拥有大小为 $n$ 的完整数据集时的方差）是 $U = \\sigma^2/n$。\n仅基于观测数据（大小为 $n_{\\mathrm{obs}}$）的后验方差是 $T = \\sigma^2/n_{\\mathrm{obs}}$。\n因此，真实的填补间方差为：\n$$\nB_{\\mathrm{true}} = T - U = \\frac{\\sigma^{2}}{n_{\\mathrm{obs}}} - \\frac{\\sigma^{2}}{n} = \\sigma^{2}\\left(\\frac{1}{n_{\\mathrm{obs}}} - \\frac{1}{n}\\right) = \\sigma^{2}\\frac{n - n_{\\mathrm{obs}}}{n \\cdot n_{\\mathrm{obs}}} = \\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n因为 $\\mathbb{E}[B] = B_{\\mathrm{true}}$，我们有：\n$$\n\\mathbb{E}[B] = \\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n现在我们可以计算适当 MI 策略的期望总方差：\n$$\n\\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}] = \\mathbb{E}[W] + \\left(1 + \\frac{1}{m}\\right)\\mathbb{E}[B] = \\frac{\\sigma^{2}}{n} + \\left(1 + \\frac{1}{m}\\right)\\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n\n有了两种策略的期望方差，我们就可以计算偏差：\n$$\n\\mathrm{Bias} = \\mathbb{E}[\\widehat{V}_{\\mathrm{improper}}] - \\mathbb{E}[\\widehat{V}_{\\mathrm{proper}}]\n$$\n$$\n\\mathrm{Bias} = \\frac{\\sigma^{2}}{n} - \\left[\\frac{\\sigma^{2}}{n} + \\left(1 + \\frac{1}{m}\\right)\\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\\right]\n$$\n$$\n\\mathrm{Bias} = -\\left(1 + \\frac{1}{m}\\right)\\sigma^{2}\\frac{n_{\\mathrm{miss}}}{n \\cdot n_{\\mathrm{obs}}}\n$$\n负号表示不当单次填补策略系统性地低估了方差。\n\n现在，我们代入给定的数值：$n = 200$，$n_{\\mathrm{obs}} = 120$，$n_{\\mathrm{miss}} = 80$，$\\sigma^{2} = 100$，以及 $m=20$。\n$$\n\\mathrm{Bias} = -\\left(1 + \\frac{1}{20}\\right) \\times 100 \\times \\frac{80}{200 \\times 120}\n$$\n$$\n\\mathrm{Bias} = -\\left(\\frac{21}{20}\\right) \\times 100 \\times \\frac{80}{24000}\n$$\n$$\n\\mathrm{Bias} = -1.05 \\times 100 \\times \\frac{1}{300}\n$$\n$$\n\\mathrm{Bias} = -1.05 \\times \\frac{100}{300} = -1.05 \\times \\frac{1}{3}\n$$\n$$\n\\mathrm{Bias} = -0.35\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\mathrm{Bias} = -0.3500 \\, \\mathrm{mmHg}^{2}\n$$", "answer": "$$\\boxed{-0.3500}$$", "id": "4976456"}, {"introduction": "一旦我们认识到需要使用多重插补来处理不确定性，下一个挑战就是构建一个正确的插补模型。本练习将探讨一个更微妙但同样关键的问题：插补模型的设定。通过一个临床试验中的常见假设情景，本题旨在阐明“协调性”（congeniality）原则，即插补模型应至少与分析模型一样复杂，并展示一个设定不当的插补模型（例如，遗漏了关键的预测变量）会如何导致最终估计结果产生严重偏倚。[@problem_id:4976459]", "problem": "一项心血管医学领域的随机对照试验研究了某种降压治疗对收缩压的影响。令 $T \\in \\{0,1\\}$ 表示治疗分配，其中 $\\Pr(T=1)=1/2$。令 $X \\in \\mathbb{R}$ 表示一个基线协变量（例如，基线风险评分），其分布为 $X \\sim \\mathcal{N}(0,\\sigma_{X}^{2})$，且独立于 $T$。该连续性结局由一个线性高斯数据生成过程建模：\n$$\nY \\;=\\; \\alpha \\;+\\; \\tau\\, T \\;+\\; \\beta\\, X \\;+\\; \\varepsilon,\\qquad \\varepsilon \\sim \\mathcal{N}(0,\\sigma^{2}),\\quad \\varepsilon \\perp (X,T).\n$$\n结局存在缺失，由 $R \\in \\{0,1\\}$ 指示，其中 $R=1$ 表示 $Y$ 被观测到。缺失机制为随机缺失（Missing At Random, MAR），满足\n$$\n\\Pr(R=1 \\mid X,T,Y) \\;=\\; s(X),\n$$\n其中 $s$ 为某个可测函数，满足 $0  s(X)  1$，并且在给定 $X$ 的条件下，$s(X)$ 不依赖于 $T$ 或 $Y$。由于随机化以及MAR机制仅依赖于 $X$，两个治疗组的边际缺失率是相同的；令\n$$\nr \\;=\\; \\Pr(R=0 \\mid T=1) \\;=\\; \\Pr(R=0 \\mid T=0) \\;=\\; 1 - \\mathbb{E}\\big[s(X)\\big].\n$$\n一位分析师执行了多重插补（MI），但使用了一个设定错误的插补模型，该模型忽略了治疗指示变量。具体来说，对于每次插补，分析师仅使用观测案例（$R=1$），合并两个治疗组的数据，对 $Y$ 和 $X$ 进行线性回归拟合，并从一个均值为 $a + b X$、方差由观测数据估计得出的正态分布中抽取数值来插补缺失的 $Y$ 值（用于插补的具体方差是任意的，但为有限正值）。在创建多个插补数据集并补全数据后，分析师通过计算补全数据后各组均值的未经调整的差异来估计治疗效应，并对所有插补的点估计值取平均。\n\n仅使用随机缺失（Missing At Random）的基本定义、全期望定律以及多重插补点估计量作为补全数据估计量平均值的定义，推导治疗效应的MI点估计量的大样本极限，并计算其相对于真实值 $\\tau$ 的渐近偏差。将你的最终答案表示为关于 $\\tau$ 和 $r$ 的单个闭式解析表达式。不要提供方差分量的推导。不要代入具体数值。最终答案必须是单个无单位的表达式。", "solution": "用户希望在插补模型设定错误的情况下，求出治疗效应的多重插补（MI）估计量的渐近偏差。\n\n### 1. 预备知识和定义\n\n真实的数据生成过程由以下线性模型给出：\n$$\nY \\;=\\; \\alpha \\;+\\; \\tau\\, T \\;+\\; \\beta\\, X \\;+\\; \\varepsilon\n$$\n其中 $T \\in \\{0,1\\}$ 且 $\\Pr(T=1) = 1/2$，$X \\sim \\mathcal{N}(0, \\sigma_X^2)$，以及 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。给定 $X \\perp T$ 且 $\\varepsilon \\perp (X,T)$。\n\n真实的平均治疗效应 $\\tau$ 是治疗组和对照组下期望结局的差值：\n$$\n\\text{ATE} \\;=\\; \\mathbb{E}[Y \\mid T=1] - \\mathbb{E}[Y \\mid T=0]\n$$\n利用期望的线性性质以及 $\\mathbb{E}[X \\mid T=t] = \\mathbb{E}[X] = 0$（由于 $X \\perp T$）这一事实：\n$$\n\\mathbb{E}[Y \\mid T=t] \\;=\\; \\mathbb{E}[\\alpha + \\tau t + \\beta X + \\varepsilon \\mid T=t] \\;=\\; \\alpha + \\tau t + \\beta \\mathbb{E}[X] \\;=\\; \\alpha + \\tau t\n$$\n因此，真实的治疗效应为：\n$$\n\\tau \\;=\\; (\\alpha + \\tau) - \\alpha \\;=\\; \\tau\n$$\n\n治疗效应的 MI 点估计量 $\\hat{\\tau}_{MI}$ 是补全数据估计量的平均值。在大样本极限下（当受试者数量和插补次数趋于无穷大时），它收敛于：\n$$\n\\hat{\\tau}_{MI}^{\\infty} \\;=\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=1] - \\mathbb{E}[Y_{\\text{comp}} \\mid T=0]\n$$\n其中 $Y_{\\text{comp}}$ 是一个随机变量，代表补全数据集中的一个值。\n\n根据定义，如果结局被观测到（$R=1$），则 $Y_{\\text{comp}} = Y$；如果结局缺失（$R=0$），则 $Y_{\\text{comp}} = Y_{\\text{imp}}$，其中 $Y_{\\text{imp}}$ 是插补值。\n\n### 2. 补全数据的大样本期望\n\n我们可以使用全期望定律，以缺失指示变量 $R$ 为条件，来表示每个治疗组中补全数据的期望值：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=t, R=1]\\Pr(R=1 \\mid T=t) \\;+\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=t, R=0]\\Pr(R=0 \\mid T=t)\n$$\n给定边际缺失概率为 $r = \\Pr(R=0 \\mid T=t)$，因此 $\\Pr(R=1 \\mid T=t) = 1-r$。\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; (1-r)\\mathbb{E}[Y \\mid T=t, R=1] \\;+\\; r\\mathbb{E}[Y_{\\text{imp}} \\mid T=t, R=0]\n$$\n\n### 3. 刻画插补模型\n\n分析师通过仅使用两个治疗组合并后的观测案例（$R=1$）对 $Y$ 和 $X$ 进行回归，从而使用了一个设定错误的插补模型。插补值从一个分布中抽取，其均值由该回归模型给出。在大样本极限下，该回归的系数收敛于条件期望 $\\mathbb{E}[Y \\mid X, R=1]$ 的总体参数。\n\n缺失机制是形式为 $\\Pr(R=1 \\mid X,T,Y) = s(X)$ 的随机缺失（MAR），这意味着以 $X$ 为条件，缺失与 $Y$ 和 $T$ 相互独立。这表明：\n$$\n\\mathbb{E}[Y \\mid X, R=1] \\;=\\; \\mathbb{E}[Y \\mid X]\n$$\n我们通过对治疗分配 $T$ 取平均来计算 $\\mathbb{E}[Y \\mid X]$：\n$$\n\\mathbb{E}[Y \\mid X] \\;=\\; \\mathbb{E}[\\alpha + \\tau T + \\beta X + \\varepsilon \\mid X] \\;=\\; \\alpha + \\tau \\mathbb{E}[T \\mid X] + \\beta X + \\mathbb{E}[\\varepsilon \\mid X]\n$$\n由于 $T \\perp X$ 和 $\\varepsilon \\perp X$，且 $\\mathbb{E}[T] = 1/2$，上式简化为：\n$$\n\\mathbb{E}[Y \\mid X] \\;=\\; \\alpha + \\frac{\\tau}{2} + \\beta X\n$$\n这就是分析师的插补模型的大样本极限。因此，一个插补结局的期望值，以 $X$ 为条件，是：\n$$\n\\mathbb{E}[Y_{\\text{imp}} \\mid X] \\;=\\; \\alpha + \\frac{\\tau}{2} + \\beta X\n$$\n这个期望值不依赖于治疗分配 $T$，因为 $T$ 在插补模型中被忽略了。\n\n### 4. 计算补全数据各组的均值\n\n现在我们可以计算表达式 $\\mathbb{E}[Y_{\\text{comp}} \\mid T=t]$ 中的各项。\n\n对于观测部分：\n$$\n\\mathbb{E}[Y \\mid T=t, R=1] \\;=\\; \\mathbb{E}[\\alpha + \\tau T + \\beta X + \\varepsilon \\mid T=t, R=1] \\;=\\; \\alpha + \\tau t + \\beta \\mathbb{E}[X \\mid T=t, R=1]\n$$\n对于插补部分：\n$$\n\\mathbb{E}[Y_{\\text{imp}} \\mid T=t, R=0] \\;=\\; \\mathbb{E}[\\mathbb{E}[Y_{\\text{imp}} \\mid X] \\mid T=t, R=0] \\;=\\; \\mathbb{E}\\left[\\alpha + \\frac{\\tau}{2} + \\beta X \\mid T=t, R=0\\right]\n$$\n$$\n\\;=\\; \\alpha + \\frac{\\tau}{2} + \\beta \\mathbb{E}[X \\mid T=t, R=0]\n$$\n将这些代回 $\\mathbb{E}[Y_{\\text{comp}} \\mid T=t]$ 的表达式中：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; (1-r)(\\alpha + \\tau t + \\beta \\mathbb{E}[X \\mid T=t, R=1]) \\;+\\; r\\left(\\alpha + \\frac{\\tau}{2} + \\beta \\mathbb{E}[X \\mid T=t, R=0]\\right)\n$$\n合并同类项：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; (1-r)\\alpha + r\\alpha \\;+\\; (1-r)\\tau t + r\\frac{\\tau}{2} \\;+\\; \\beta \\left( (1-r)\\mathbb{E}[X \\mid T=t, R=1] + r\\mathbb{E}[X \\mid T=t, R=0] \\right)\n$$\n乘以 $\\beta$ 的括号中的项是全期望定律在 $\\mathbb{E}[X \\mid T=t]$ 上的应用：\n$$\n(1-r)\\mathbb{E}[X \\mid T=t, R=1] + r\\mathbb{E}[X \\mid T=t, R=0] \\;=\\; \\mathbb{E}[X \\mid T=t]\n$$\n由于 $X \\perp T$，我们有 $\\mathbb{E}[X \\mid T=t]=\\mathbb{E}[X]=0$。因此，包含 $\\beta$ 的整个项为零。\n补全数据均值的表达式简化为：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=t] \\;=\\; \\alpha + (1-r)\\tau t + \\frac{r\\tau}{2}\n$$\n\n现在，我们针对治疗组（$t=1$）和对照组（$t=0$）来计算该值：\n当 $T=1$ 时：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=1] \\;=\\; \\alpha + (1-r)\\tau + \\frac{r\\tau}{2} \\;=\\; \\alpha + \\tau - r\\tau + \\frac{r\\tau}{2} \\;=\\; \\alpha + \\tau\\left(1-\\frac{r}{2}\\right)\n$$\n当 $T=0$ 时：\n$$\n\\mathbb{E}[Y_{\\text{comp}} \\mid T=0] \\;=\\; \\alpha + (1-r)\\tau(0) + \\frac{r\\tau}{2} \\;=\\; \\alpha + \\frac{r\\tau}{2}\n$$\n\n### 5. 计算偏差\n\nMI 估计量的大样本极限是这两个期望的差值：\n$$\n\\hat{\\tau}_{MI}^{\\infty} \\;=\\; \\mathbb{E}[Y_{\\text{comp}} \\mid T=1] - \\mathbb{E}[Y_{\\text{comp}} \\mid T=0]\n$$\n$$\n\\hat{\\tau}_{MI}^{\\infty} \\;=\\; \\left[ \\alpha + \\tau\\left(1-\\frac{r}{2}\\right) \\right] - \\left[ \\alpha + \\frac{r\\tau}{2} \\right] \\;=\\; \\tau - \\frac{r\\tau}{2} - \\frac{r\\tau}{2} \\;=\\; \\tau - r\\tau \\;=\\; \\tau(1-r)\n$$\n渐近偏差是估计量的大样本极限与真实参数 $\\tau$ 之间的差值：\n$$\n\\text{Bias} \\;=\\; \\hat{\\tau}_{MI}^{\\infty} - \\tau \\;=\\; \\tau(1-r) - \\tau \\;=\\; -\\tau r\n$$\n这个结果表明，在插补模型中忽略一个既是结局的预测因子又与治疗相关的变量（在本例中是治疗指示变量 $T$ 本身），会导致一个与真实效应大小 $\\tau$ 和缺失数据比例 $r$ 成正比的偏差。偏差是趋向于零的，因为插补过程将两个组的均值拉向了总均值。", "answer": "$$\\boxed{-r\\tau}$$", "id": "4976459"}, {"introduction": "在掌握了为何需要多重插补以及如何构建一个好的插补模型之后，一个关键的实践问题是：我们应该执行多少次插补？本练习将探讨选择插补次数 $m$ 时的权衡。您将推导出一个关键公式，它将 $m$、缺失信息比例和统计效率联系起来，并计算所需的最小 $m$ 值，同时思考在实际研究中为何通常需要选择一个远大于该最小值的 $m$ 以确保结果的稳定性和可重复性。[@problem_id:4976514]", "problem": "一项心脏病学的多中心队列研究旨在估计一种新的抗高血压治疗引起的收缩压平均差异。由于基线协变量和一些随访测量值存在间歇性缺失，研究者们计划使用多重插补。设通过多重插补生成了 $m$ 个完整的数据集，标量估计量为 $Q$（治疗效应）。对于第 $j$ 个插补数据集（$j \\in \\{1,\\dots,m\\}$），将其点估计记为 $Q_{j}$，其完全数据方差估计记为 $U_{j}$。定义平均插补内方差为 $\\bar{W} = m^{-1} \\sum_{j=1}^{m} U_{j}$，插补间方差为 $B = (m-1)^{-1} \\sum_{j=1}^{m} (Q_{j} - \\bar{Q})^{2}$，其中 $\\bar{Q} = m^{-1} \\sum_{j=1}^{m} Q_{j}$。根据标准的多重插补合并规则，在 $m$ 次插补下的总方差为 $T_{m} = \\bar{W} + (1 + m^{-1}) B$，其在 $m \\to \\infty$ 时的极限为 $T_{\\infty} = \\bar{W} + B$。缺失信息分数定义为 $\\lambda = B / T_{\\infty}$。\n\n从这些定义和规则出发，推导使用 $m$ 次插补相对于使用无限次插补的相对效率 $\\text{RE}(m)$ 的表达式，用 $\\lambda$ 和 $m$ 表示，然后在估计的缺失信息分数为 $\\lambda = 0.3$ 时，求解确保 $\\text{RE}(m) \\ge 0.99$ 所需的最小 $m$。报告满足该要求的最小整数 $m$。\n\n最后，简要评论在医学研究中，出于建模或推断的考虑，选择一个远大于此最小值的 $m$ 是合理的科学情景。最终的数值答案必须是一个整数。无需四舍五入说明。", "solution": "首先评估问题的有效性。\n\n步骤 1：提取给定条件\n- 插补数据集数量：$m$\n- 标量估计量：$Q$\n- 第 $j$ 个插补数据集的点估计：$Q_{j}$\n- 第 $j$ 个插补数据集的完全数据方差估计：$U_{j}$\n- 平均插补内方差：$\\bar{W} = m^{-1} \\sum_{j=1}^{m} U_{j}$\n- 平均点估计：$\\bar{Q} = m^{-1} \\sum_{j=1}^{m} Q_{j}$\n- 插补间方差：$B = (m-1)^{-1} \\sum_{j=1}^{m} (Q_{j} - \\bar{Q})^{2}$\n- $m$ 次插补下的总方差：$T_{m} = \\bar{W} + (1 + m^{-1}) B$\n- $m \\to \\infty$ 时的总方差：$T_{\\infty} = \\bar{W} + B$\n- 缺失信息分数：$\\lambda = B / T_{\\infty}$\n- 相对效率：$\\text{RE}(m)$，即使用 $m$ 次插补与使用无限次插补的比较。\n- 目标 1：用 $\\lambda$ 和 $m$ 推导 $\\text{RE}(m)$ 的表达式。\n- 目标 2：当 $\\lambda = 0.3$ 时，求满足 $\\text{RE}(m) \\ge 0.99$ 的最小整数 $m$。\n- 目标 3：评论需要更大 $m$ 的情景。\n\n步骤 2：使用提取的给定条件进行验证\n该问题具有科学依据，提法明确且客观。\n- **科学性和事实性：** 该问题基于由 Donald B. Rubin 开创的、标准且成熟的多重插补统计理论。所有定义，包括 $\\bar{W}$、 $B$、 $T_m$、 $T_{\\infty}$ 和 $\\lambda$ 的定义，都是该领域的经典定义。具有缺失数据的医学研究背景是这些技术的主要应用领域。该问题没有违反任何科学或数学原理。\n- **提法的明确性和完整性：** 该问题是自洽的，提法明确。它提供了执行所需推导和计算的所有必要定义和关系。目标陈述清晰，可以得出一个唯一且有意义的解。\n- **客观性和清晰度：** 语言正式、精确且无歧义。没有主观论断或模糊术语。\n\n步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n问题的第一部分是推导使用有限次插补 $m$ 相对于使用无限次插补的相对效率 $\\text{RE}(m)$ 的表达式。效率与方差成反比。最终估计的方差由总方差 $T$ 给出。因此，相对效率是无限次插补的总方差 $T_{\\infty}$ 与 $m$ 次插补的总方差 $T_{m}$ 的比值。\n\n$$\n\\text{RE}(m) = \\frac{T_{\\infty}}{T_{m}}\n$$\n\n我们已知 $T_{m}$ 和 $T_{\\infty}$ 的表达式：\n$T_{m} = \\bar{W} + (1 + m^{-1}) B$\n$T_{\\infty} = \\bar{W} + B$\n\n将这些代入 $\\text{RE}(m)$ 的表达式中：\n$$\n\\text{RE}(m) = \\frac{\\bar{W} + B}{\\bar{W} + (1 + m^{-1}) B} = \\frac{\\bar{W} + B}{\\bar{W} + B + \\frac{B}{m}}\n$$\n\n为了用 $\\lambda$ 和 $m$ 表示该式，我们可以将分子和分母同时除以 $T_{\\infty} = \\bar{W} + B$：\n$$\n\\text{RE}(m) = \\frac{\\frac{\\bar{W} + B}{\\bar{W} + B}}{\\frac{\\bar{W} + B}{\\bar{W} + B} + \\frac{B/m}{\\bar{W} + B}} = \\frac{1}{1 + \\frac{1}{m} \\left( \\frac{B}{\\bar{W} + B} \\right)}\n$$\n\n我们已知缺失信息分数的定义 $\\lambda = B / T_{\\infty} = B / (\\bar{W} + B)$。将其代入 $\\text{RE}(m)$ 的方程中，得到所需的表达式：\n$$\n\\text{RE}(m) = \\frac{1}{1 + \\frac{\\lambda}{m}} = \\left(1 + \\frac{\\lambda}{m}\\right)^{-1}\n$$\n\n问题的第二部分要求在缺失信息分数为 $\\lambda = 0.3$ 时，求出能确保相对效率至少为 $0.99$ 的最小整数 $m$。条件是 $\\text{RE}(m) \\ge 0.99$。\n\n代入推导出的 $\\text{RE}(m)$ 表达式和给定的 $\\lambda$ 值：\n$$\n\\left(1 + \\frac{0.3}{m}\\right)^{-1} \\ge 0.99\n$$\n\n由于 $m$ 是正整数，$(1 + 0.3/m)$ 项大于 $1$。我们可以对两边取倒数，这会反转不等号：\n$$\n1 + \\frac{0.3}{m} \\le \\frac{1}{0.99}\n$$\n\n现在，我们求解 $m$：\n$$\n\\frac{0.3}{m} \\le \\frac{1}{0.99} - 1\n$$\n$$\n\\frac{0.3}{m} \\le \\frac{1 - 0.99}{0.99}\n$$\n$$\n\\frac{0.3}{m} \\le \\frac{0.01}{0.99}\n$$\n\n两边同时乘以 $m$（为正数）和 $0.99$ 得：\n$$\n0.3 \\times 0.99 \\le 0.01 \\times m\n$$\n$$\n0.297 \\le 0.01 \\times m\n$$\n除以 $0.01$：\n$$\nm \\ge \\frac{0.297}{0.01}\n$$\n$$\nm \\ge 29.7\n$$\n由于 $m$ 必须是整数，满足此条件的最小 $m$ 值为 $30$。\n\n最后，我们评论在哪些情景下，选择一个远大于此最小值的 $m$ 是合理的。相对效率的计算只涉及单个标量估计量 $Q$ 的点估计方差。然而，统计分析不仅限于点估计。为了保证统计推断（如置信区间和p值）的稳定性和有效性，通常需要一个更大的 $m$。\n首先，基于t分布的标准 $Q$ 置信区间使用的自由度估计值依赖于 $m$ 和 $\\lambda$。当 $m$ 较小时，自由度可能会很低，导致置信区间过宽且可能不可靠。\n其次，更重要的是，当 $m$ 较小时，插补间方差的估计值 $B$ 本身就具有很高的抽样变异性。这会将蒙特卡罗误差引入到p值等推断统计量中。如果 $m$ 很小，一个接近临界阈值（例如 $0.05$）的p值在同一次插补程序的不同运行中可能会落在阈值的任意一侧，导致研究结果不可复现。增加 $m$（例如，增加到 $100$ 或更多）可以减少这种蒙特卡罗误差，确保分析结果的稳定性和可复现性。\n第三，一项研究通常涉及多个估计量，而不仅仅是一个。对于其他感兴趣的参数（例如，交互项、亚组效应），缺失信息分数 $\\lambda$ 可能会更大。$m$ 的选择应足够保守，以适应所有计划分析中可能出现的最高 $\\lambda$。基于这些原因，尽管 $m$ 为 $30$ 对于点估计的效率可能已经足够，但现代指南通常建议使用一个大得多的 $m$，以确保最终科学结论的稳健性和可复现性。", "answer": "$$\n\\boxed{30}\n$$", "id": "4976514"}]}