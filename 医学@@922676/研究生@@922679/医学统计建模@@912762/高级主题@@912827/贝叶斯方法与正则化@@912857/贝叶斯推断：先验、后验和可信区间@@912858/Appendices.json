{"hands_on_practices": [{"introduction": "我们从贝叶斯分析的一个基石开始：在方差已知的情况下估计正态分布的均值。这个练习展示了共轭先验的优美机制，其中后验分布与先验分布属于同一族。您将看到贝叶斯推断如何自然地将先验知识与观测数据相结合，以更新我们的信念。掌握这个正态-正态模型为理解医学统计中更复杂的层次模型提供了基本构建模块。[@problem_id:4953844]", "problem": "一项心血管结局试验旨在估计接受标准治疗的门诊患者队列的平均收缩压 (SBP)。令 $\\theta$ 表示真实的队列平均收缩压，单位为毫米汞柱 (mmHg)。该研究从不同患者身上收集了 $n$ 个独立的 SBP 测量值 $y_{1},\\dots,y_{n}$，在给定 $\\theta$ 的条件下，这些测量值被建模为条件独立同分布，服从具有已知方差的正态似然。具体来说，假设数据生成模型为 $y_{i}\\mid \\theta \\sim \\mathcal{N}(\\theta,\\sigma^{2})$，其中 $\\sigma^{2}$ 已知，其合理性由大量的设备校准和历史变异性评估所支持。来自先前群体研究的先验知识被编码为正态先验 $\\theta \\sim \\mathcal{N}(\\mu_{0},\\tau_{0}^{2})$。\n\n在此队列中，假设抽取了 $n=40$ 名患者，观测到的样本均值为 $\\bar{y}=125\\,\\text{mmHg}$，已知的测量/生物学变异性为 $\\sigma=15\\,\\text{mmHg}$，先验参数为 $\\mu_{0}=130\\,\\text{mmHg}$ 和 $\\tau_{0}=20\\,\\text{mmHg}$。\n\n使用 Bayes 定理，从正态似然和正态先验密度定义出发，推导后验分布 $p(\\theta\\mid y_{1},\\dots,y_{n})$，并通过显式代数运算确定其均值 $m$ 和方差 $s^{2}$。然后，在推导出的后验分布下，为 $\\theta$ 构建等尾 $95\\%$ 贝叶斯可信区间，并结合队列平均 SBP 的背景，对该区间提供一个具有临床意义的解释。\n\n将两个区间端点分别四舍五入至四位有效数字。以 mmHg 为单位表示最终区间。你的最终数值答案应只包含两个四舍五入后的端点。", "solution": "基本依据是 Bayes 定理和正态密度函数。数据模型为 $y_{i}\\mid \\theta \\sim \\mathcal{N}(\\theta,\\sigma^{2})$，其中 $\\sigma^{2}$ 已知，对于 $i=1,\\dots,n$ 独立，且先验为 $\\theta \\sim \\mathcal{N}(\\mu_{0},\\tau_{0}^{2})$。\n\n根据 Bayes 定理，\n$$\np(\\theta\\mid y_{1},\\dots,y_{n}) \\propto p(y_{1},\\dots,y_{n}\\mid \\theta)\\,p(\\theta)\n= \\left[\\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}}\\exp\\!\\left\\{-\\frac{1}{2\\sigma^{2}}(y_{i}-\\theta)^{2}\\right\\}\\right]\\cdot \\frac{1}{\\sqrt{2\\pi\\tau_{0}^{2}}}\\exp\\!\\left\\{-\\frac{1}{2\\tau_{0}^{2}}(\\theta-\\mu_{0})^{2}\\right\\}.\n$$\n忽略与 $\\theta$ 无关的归一化常数，关于 $\\theta$ 的核为\n$$\n\\exp\\!\\left\\{-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(y_{i}-\\theta)^{2} - \\frac{1}{2\\tau_{0}^{2}}(\\theta-\\mu_{0})^{2}\\right\\}.\n$$\n展开 $\\sum_{i=1}^{n}(y_{i}-\\theta)^{2}=\\sum_{i=1}^{n}(y_{i}^{2}-2y_{i}\\theta+\\theta^{2})=\\sum_{i=1}^{n}y_{i}^{2}-2\\theta\\sum_{i=1}^{n}y_{i}+n\\theta^{2}$。不含 $\\theta$ 的项可以并入归一化常数，并在核中省略。指数项（不计加法常数）变为\n$$\n-\\frac{1}{2}\\left[\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}\\right)\\theta^{2} - 2\\left(\\frac{\\sum_{i=1}^{n}y_{i}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\tau_{0}^{2}}\\right)\\theta\\right].\n$$\n对 $\\theta$ 配方：\n$$\n-\\frac{1}{2}\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}\\right)\\left[\\theta^{2} - 2\\frac{\\frac{\\sum_{i=1}^{n}y_{i}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\tau_{0}^{2}}}{\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}}\\theta\\right]\n= -\\frac{1}{2}\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}\\right)\\left[\\theta - \\frac{\\frac{\\sum_{i=1}^{n}y_{i}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\tau_{0}^{2}}}{\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}}\\right]^{2} + \\text{constant}.\n$$\n因此，后验分布是正态分布，\n$$\n\\theta\\mid y_{1},\\dots,y_{n} \\sim \\mathcal{N}(m,s^{2}),\n$$\n其中\n$$\ns^{2}=\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}\\right)^{-1},\\qquad\nm=s^{2}\\left(\\frac{\\sum_{i=1}^{n}y_{i}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\tau_{0}^{2}}\\right).\n$$\n使用 $\\bar{y}=\\frac{1}{n}\\sum_{i=1}^{n}y_{i}$，这可以写成\n$$\ns^{2}=\\left(\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}\\right)^{-1},\\qquad\nm=s^{2}\\left(\\frac{n\\bar{y}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\tau_{0}^{2}}\\right).\n$$\n\n代入给定值 $n=40$, $\\bar{y}=125$, $\\sigma=15$, $\\mu_{0}=130$, $\\tau_{0}=20$（单位均为 mmHg）。首先计算后验精度和方差：\n$$\n\\frac{n}{\\sigma^{2}}=\\frac{40}{15^{2}}=\\frac{40}{225}=\\frac{8}{45},\\qquad \\frac{1}{\\tau_{0}^{2}}=\\frac{1}{20^{2}}=\\frac{1}{400}.\n$$\n因此，\n$$\n\\frac{n}{\\sigma^{2}}+\\frac{1}{\\tau_{0}^{2}}=\\frac{8}{45}+\\frac{1}{400}=\\frac{640}{3600}+\\frac{9}{3600}=\\frac{649}{3600},\n$$\n所以\n$$\ns^{2}=\\left(\\frac{649}{3600}\\right)^{-1}=\\frac{3600}{649}.\n$$\n接着计算后验均值：\n$$\n\\frac{n\\bar{y}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\tau_{0}^{2}}=\\frac{40\\cdot 125}{225}+\\frac{130}{400}=\\frac{5000}{225}+\\frac{13}{40}=\\frac{200}{9}+\\frac{13}{40}=\\frac{8000}{360}+\\frac{117}{360}=\\frac{8117}{360}.\n$$\n于是，\n$$\nm=s^{2}\\left(\\frac{n\\bar{y}}{\\sigma^{2}}+\\frac{\\mu_{0}}{\\tau_{0}^{2}}\\right)=\\frac{3600}{649}\\cdot \\frac{8117}{360}=\\frac{10\\cdot 8117}{649}=\\frac{81170}{649}.\n$$\n\n对于正态后验分布下的等尾 $95\\%$ 可信区间，使用标准正态分位数 $z_{0.975}$，它满足对于 $Z\\sim \\mathcal{N}(0,1)$ 有 $\\Pr(|Z|\\le z_{0.975})=0.95$，其值为 $z_{0.975}\\approx 1.96$。该区间为\n$$\n\\left[m- z_{0.975}\\, s,\\; m+ z_{0.975}\\, s\\right]=\\left[m-1.96\\, s,\\; m+1.96\\, s\\right].\n$$\n计算 $s=\\sqrt{s^{2}}=\\sqrt{\\frac{3600}{649}}=\\frac{60}{\\sqrt{649}}$。因此，区间端点为\n$$\nm\\pm 1.96\\, s = \\frac{81170}{649} \\pm 1.96\\cdot \\frac{60}{\\sqrt{649}}.\n$$\n数值上，$m\\approx 125.06934$ 且 $s\\approx 2.355206$，所以 $1.96\\, s\\approx 4.616204$。因此，端点近似为\n$$\n125.06934 - 4.616204 \\approx 120.45314,\\qquad 125.06934 + 4.616204 \\approx 129.68554.\n$$\n四舍五入到四位有效数字并以毫米汞柱 (mmHg) 表示，队列平均 SBP 的等尾 $95\\%$ 贝叶斯可信区间大约为 $120.5$ mmHg 到 $129.7$ mmHg。\n\n解释：在指定的具有已知方差的正态先验和正态似然模型下，队列平均 SBP 的后验分布将 $0.95$ 的概率赋予均值位于 $120.5$ mmHg 和 $129.7$ mmHg 之间的事件。这是一个在给定观测数据和先验信息的条件下，关于 $\\theta$ 的直接概率陈述，它与频率学派的置信区间不同，后者关心的是在重复抽样下的长期覆盖性质。", "answer": "$$\\boxed{\\begin{pmatrix}120.5  129.7\\end{pmatrix}}$$", "id": "4953844"}, {"introduction": "从连续数据转向比例数据，我们现在来处理一个常见场景：为临床试验中的患者响应等二元结果建模。这个实践介绍了Beta-二项共轭模型以及贝叶斯方法的一个关键优势：通过后验预测分布生成预测的能力。您不仅将学会更新对未知比例的信念，还将学会量化未来队列中结果的不确定性，这是医疗决策中的一项关键任务。[@problem_id:4953902]", "problem": "一项II期肿瘤学研究评估一个二元临床终点，其中每位入组患者要么响应 ($1$)，要么不响应 ($0$)。设 $Y$ 表示研究中 $n$ 名患者的总响应人数。单个患者的响应概率被建模为一个随机参数 $\\theta \\in (0,1)$，以反映患者间和研究间的异质性。您需要对 $\\theta$ 进行贝叶斯推断，并使用适合医学决策的原则，对未来一个队列中的响应者数量进行预测。\n\n假设以下具有科学依据的建模部分：\n- 观测数据的似然为 $Y \\mid \\theta \\sim \\text{Binomial}(n,\\theta)$，反映了队列内独立同分布的伯努利响应。\n- 响应概率的先验为 $\\theta \\sim \\text{Beta}(\\alpha,\\beta)$，捕捉了先验的临床知识和不确定性，其中超参数 $\\alpha > 0$ 且 $\\beta > 0$。\n\n任务：\n1. 从贝叶斯定理和给定的似然-先验设定出发，推导后验分布 $p(\\theta \\mid y)$，其中 $y$ 是观测到的响应者计数。\n2. 使用未来队列大小为 $n_{\\text{new}}$ 的后验预测分布 (Posterior Predictive Distribution, PPD) 的定义\n$$\np(X_{\\text{new}} = k \\mid y) \\;=\\; \\int_{0}^{1} p(X_{\\text{new}} = k \\mid \\theta)\\, p(\\theta \\mid y)\\, d\\theta,\n$$\n其中 $X_{\\text{new}} \\mid \\theta \\sim \\text{Binomial}(n_{\\text{new}},\\theta)$，求出 $p(X_{\\text{new}} = k \\mid y)$ 的一个以标准特殊函数和组合量表示的闭式表达式。确定此PPD的参数族。\n3. 现在考虑一个来自免疫治疗队列的特定数据集：Beta先验的参数为 $\\alpha = 2$ 和 $\\beta = 2$，观测数据为 $n = 10$ 名患者中有 $y = 3$ 名响应者。计划一个新的队列，其大小为 $n_{\\text{new}} = 6$。使用您推导出的PPD，计算新队列中响应者数量 $X_{\\text{new}}$ 的一个95%最高后验密度 (HPD) 预测区间。通过按 $p(X_{\\text{new}} = k \\mid y)$ 的降序包含 $k$ 的值，直到覆盖阈值达到，构建HPD区间，该区间为 $\\{0,1,\\dots,n_{\\text{new}}\\}$ 上后验预测质量至少为0.95的最短连续整数区间，如有必要，则修剪成一个连续整数区间。\n\n以整数形式提供预测区间的两个端点。最终端点无需四舍五入。最终答案必须是一个计算结果，表示为对应于下端点和上端点的有序整数对。", "solution": "该问题经验证具有科学依据、良定且客观。这是一个应用于临床试验背景的贝叶斯推断的标准问题。所有必要信息均已提供，任务定义明确。\n\n### 第1部分：后验分布的推导\n\n目标是推导给定观测数据 $y$ 的响应概率 $\\theta$ 的后验分布。根据贝叶斯定理，后验概率密度函数 (PDF) $p(\\theta \\mid y)$ 正比于似然函数 $p(y \\mid \\theta)$ 和先验PDF $p(\\theta)$ 的乘积。\n\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) p(\\theta)\n$$\n\n给定条件如下：\n- 似然函数，即二项分布的概率质量函数 (PMF)：\n$$\np(y \\mid \\theta) = \\binom{n}{y} \\theta^{y} (1-\\theta)^{n-y} \\quad \\text{for } y \\in \\{0, 1, \\dots, n\\}\n$$\n- $\\theta$ 的先验分布，即贝塔分布：\n$$\np(\\theta) = \\frac{\\theta^{\\alpha-1} (1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)} \\quad \\text{for } \\theta \\in (0,1)\n$$\n其中 $B(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$ 是贝塔函数。\n\n我们结合似然和先验：\n$$\np(\\theta \\mid y) \\propto \\left[ \\binom{n}{y} \\theta^{y} (1-\\theta)^{n-y} \\right] \\left[ \\frac{\\theta^{\\alpha-1} (1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)} \\right]\n$$\n\n由于我们处理的是比例关系，可以舍去任何不依赖于 $\\theta$ 的项。这些项是二项式系数 $\\binom{n}{y}$ 和先验的归一化常数 $B(\\alpha, \\beta)$。\n\n$$\np(\\theta \\mid y) \\propto \\theta^{y} (1-\\theta)^{n-y} \\cdot \\theta^{\\alpha-1} (1-\\theta)^{\\beta-1}\n$$\n\n合并 $\\theta$ 和 $(1-\\theta)$ 的幂：\n$$\np(\\theta \\mid y) \\propto \\theta^{y+\\alpha-1} (1-\\theta)^{n-y+\\beta-1}\n$$\n\n此表达式是贝塔分布的核。我们可以通过观察来确定这个后验贝塔分布的参数。如果一个随机变量 $X$ 服从参数为 $a$ 和 $b$ 的贝塔分布，其PDF正比于 $x^{a-1}(1-x)^{b-1}$。\n通过将 $p(\\theta \\mid y)$ 与此形式进行比较，我们发现 $\\theta$ 的后验分布是具有更新参数 $\\alpha' = \\alpha+y$ 和 $\\beta' = \\beta+n-y$ 的贝塔分布。\n\n因此，$\\theta \\mid y \\sim \\text{Beta}(\\alpha+y, \\beta+n-y)$。完整的后验PDF为：\n$$\np(\\theta \\mid y) = \\frac{\\theta^{\\alpha+y-1} (1-\\theta)^{\\beta+n-y-1}}{B(\\alpha+y, \\beta+n-y)}\n$$\n\n### 第2部分：后验预测分布 (PPD) 的推导\n\n对于未来大小为 $n_{\\text{new}}$ 的队列中响应者数量 $X_{\\text{new}}$ 的后验预测分布 (PPD) 定义为：\n$$\np(X_{\\text{new}} = k \\mid y) = \\int_{0}^{1} p(X_{\\text{new}} = k \\mid \\theta) \\, p(\\theta \\mid y) \\, d\\theta\n$$\n我们有以下组成部分：\n- 新数据的似然为 $X_{\\text{new}} \\mid \\theta \\sim \\text{Binomial}(n_{\\text{new}}, \\theta)$，所以 $p(X_{\\text{new}}=k \\mid \\theta) = \\binom{n_{\\text{new}}}{k} \\theta^k (1-\\theta)^{n_{\\text{new}}-k}$。\n- 第1部分推导出的 $\\theta$ 的后验分布为 $p(\\theta \\mid y) = \\frac{\\theta^{\\alpha+y-1} (1-\\theta)^{\\beta+n-y-1}}{B(\\alpha+y, \\beta+n-y)}$。\n\n设 $\\alpha' = \\alpha+y$ 和 $\\beta' = \\beta+n-y$。后验分布为 $p(\\theta \\mid y) = \\frac{\\theta^{\\alpha'-1}(1-\\theta)^{\\beta'-1}}{B(\\alpha', \\beta')}$。\n将这些代入积分：\n$$\np(X_{\\text{new}} = k \\mid y) = \\int_{0}^{1} \\left[ \\binom{n_{\\text{new}}}{k} \\theta^k (1-\\theta)^{n_{\\text{new}}-k} \\right] \\left[ \\frac{\\theta^{\\alpha'-1}(1-\\theta)^{\\beta'-1}}{B(\\alpha', \\beta')} \\right] d\\theta\n$$\n我们可以将不依赖于 $\\theta$ 的项从积分中提出：\n$$\np(X_{\\text{new}} = k \\mid y) = \\frac{\\binom{n_{\\text{new}}}{k}}{B(\\alpha', \\beta')} \\int_{0}^{1} \\theta^k (1-\\theta)^{n_{\\text{new}}-k} \\theta^{\\alpha'-1}(1-\\theta)^{\\beta'-1} d\\theta\n$$\n合并积分内 $\\theta$ 和 $(1-\\theta)$ 的幂：\n$$\np(X_{\\text{new}} = k \\mid y) = \\frac{\\binom{n_{\\text{new}}}{k}}{B(\\alpha', \\beta')} \\int_{0}^{1} \\theta^{k+\\alpha'-1} (1-\\theta)^{n_{\\text{new}}-k+\\beta'-1} d\\theta\n$$\n该积分是参数为 $k+\\alpha'$ 和 $n_{\\text{new}}-k+\\beta'$ 的贝塔分布的核。根据定义，这个积分的值是贝塔函数 $B(k+\\alpha', n_{\\text{new}}-k+\\beta')$。\n$$\np(X_{\\text{new}} = k \\mid y) = \\binom{n_{\\text{new}}}{k} \\frac{B(k+\\alpha', n_{\\text{new}}-k+\\beta')}{B(\\alpha', \\beta')}\n$$\n将 $\\alpha' = \\alpha+y$ 和 $\\beta' = \\beta+n-y$ 代回：\n$$\np(X_{\\text{new}} = k \\mid y) = \\binom{n_{\\text{new}}}{k} \\frac{B(k+\\alpha+y, n_{\\text{new}}-k+\\beta+n-y)}{B(\\alpha+y, \\beta+n-y)}\n$$\n这是**贝塔-二项分布**的概率质量函数。因此，PPD的参数族是贝塔-二项分布，其参数为 $n_{\\text{new}}$、$\\alpha' = \\alpha+y$ 和 $\\beta' = \\beta+n-y$。\n\n### 第3部分：95% HPD 预测区间的计算\n\n我们给定以下具体值：\n- 先验超参数：$\\alpha=2$, $\\beta=2$。\n- 观测数据：$n=10$ 名患者中有 $y=3$ 名响应者。\n- 未来队列大小：$n_{\\text{new}}=6$。\n\n首先，我们确定 $\\theta$ 的后验分布的参数：\n- $\\alpha' = \\alpha+y = 2+3 = 5$。\n- $\\beta' = \\beta+n-y = 2+10-3 = 9$。\n因此，后验分布为 $\\theta \\mid y \\sim \\text{Beta}(5, 9)$。\n\n$X_{\\text{new}}$ 的PPD是一个贝塔-二项分布，参数为 $n_{\\text{new}}=6$、$\\alpha'=5$ 和 $\\beta'=9$。对于 $k \\in \\{0, 1, \\dots, 6\\}$，其PMF为：\n$$\np(X_{\\text{new}} = k \\mid y) = \\binom{6}{k} \\frac{B(k+5, 6-k+9)}{B(5, 9)} = \\binom{6}{k} \\frac{B(k+5, 15-k)}{B(5, 9)}\n$$\n\n我们计算每个 $k$ 值的概率 $p_k = p(X_{\\text{new}} = k \\mid y)$：\n- $p_0 = \\binom{6}{0} \\frac{B(5,15)}{B(5,9)} = \\frac{\\Gamma(5)\\Gamma(15)}{\\Gamma(20)} \\frac{\\Gamma(14)}{\\Gamma(5)\\Gamma(9)} = \\frac{14!\\cdot 13!}{19!\\cdot 8!} = \\frac{13 \\cdot 12 \\cdot 11 \\cdot 10 \\cdot 9}{19 \\cdot 18 \\cdot 17 \\cdot 16 \\cdot 15} = \\frac{154440}{1395360} \\approx 0.11068$\n- $p_1 = \\binom{6}{1} \\frac{B(6,14)}{B(5,9)} = 6 \\cdot \\frac{5}{14} p_0 = \\frac{15}{7} p_0 \\approx 0.23717$\n- $p_2 = \\binom{6}{2} \\frac{B(7,13)}{B(5,9)} = 15 \\cdot \\frac{B(7,13)}{B(5,9)}$。我们可以使用递归关系 $p_k = p_{k-1} \\frac{n_{\\text{new}}-k+1}{k} \\frac{\\alpha'+k-1}{\\beta'+n_{\\text{new}}-k}$。\n- $p_2 = p_1 \\frac{6-2+1}{2} \\frac{5+2-1}{9+6-2} = p_1 \\frac{5}{2} \\frac{6}{13} = p_1 \\frac{15}{13} \\approx 0.27367$\n- $p_3 = p_2 \\frac{6-3+1}{3} \\frac{5+3-1}{9+6-3} = p_2 \\frac{4}{3} \\frac{7}{12} = p_2 \\frac{7}{9} \\approx 0.21285$\n- $p_4 = p_3 \\frac{6-4+1}{4} \\frac{5+4-1}{9+6-4} = p_3 \\frac{3}{4} \\frac{8}{11} = p_3 \\frac{6}{11} \\approx 0.11610$\n- $p_5 = p_4 \\frac{6-5+1}{5} \\frac{5+5-1}{9+6-5} = p_4 \\frac{2}{5} \\frac{9}{10} = p_4 \\frac{9}{25} \\approx 0.04180$\n- $p_6 = p_5 \\frac{6-6+1}{6} \\frac{5+6-1}{9+6-6} = p_5 \\frac{1}{6} \\frac{10}{9} = p_5 \\frac{5}{27} \\approx 0.00774$\n\n概率之和约为 $\\approx 1.00001$，证实了计算的正确性。\n\n为了构建95% HPD区间，我们按概率的降序对 $k$ 值进行排序，并累积概率，直到其至少为0.95。\n各概率值为：\n$p_2 \\approx 0.27367$\n$p_1 \\approx 0.23717$\n$p_3 \\approx 0.21285$\n$p_4 \\approx 0.11610$\n$p_0 \\approx 0.11068$\n$p_5 \\approx 0.04180$\n$p_6 \\approx 0.00774$\n\n$k$ 值的有序集合为 $\\{2, 1, 3, 4, 0, 5, 6\\}$。让我们计算累积和：\n1. 包含 $k=2$：累积概率 = $p_2 \\approx 0.2737$\n2. 包含 $k=1$：累积概率 = $p_2+p_1 \\approx 0.5108$\n3. 包含 $k=3$：累积概率 = $p_2+p_1+p_3 \\approx 0.7237$\n4. 包含 $k=4$：累积概率 = $p_2+p_1+p_3+p_4 \\approx 0.8398$\n5. 包含 $k=0$：累积概率 = $p_2+p_1+p_3+p_4+p_0 \\approx 0.9505$\n\n在包含 $k=0$ 后，累积概率首次超过0.95。具有最高后验预测密度的值集合是 $\\{0, 1, 2, 3, 4\\}$。这个整数集合已经是一个连续区间，因此不需要修剪。该区间覆盖的总概率约为 $95.05\\%$。\n该区间为 $[0, 4]$。下端点是 $0$，上端点是 $4$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  4 \\end{pmatrix}}\n$$", "id": "4953902"}, {"introduction": "在练习了两个标准模型之后，我们现在转向贝叶斯建模中一个更微妙但至关重要的方面：先验分布的选择。这个练习要求您比较两种常见的“无信息”先验——Jeffreys先验和均匀先验——所带来的影响，尤其是在数据稀疏或极端的情况下。通过分析由此产生的后验摘要的差异，您将更深刻地体会到先验假设如何影响科学结论，以及进行敏感性分析的重要性。[@problem_id:5011004]", "problem": "一位研究者从一个大型、随机交配的人类群体中抽取了 $N$ 个无亲缘关系的二倍体个体样本，并对一个双等位基因座进行了基因分型，在 $2N$ 条染色体中计数得到 $X$ 个参考等位基因的拷贝。令 $p$ 表示参考等位基因的种群频率。假设 $X$ 来自一个具有 $2N$ 次试验和成功概率为 $p$ 的二项分布模型，并对 $p$ 设置一个Beta先验。考虑两种广泛使用的先验：Jeffreys先验 $\\mathrm{Beta}(0.5,\\,0.5)$ 和均匀先验 $\\mathrm{Beta}(1,\\,1)$。关注边界计数情况 $X\\in\\{0,\\,2N\\}$，并比较两种后验分布的后验均值、后验方差，以及在 $95\\%$ 名义水平下等尾置信区间和最高后验密度 (HPD) 置信区间的行为。\n\n下列哪个陈述是正确的？\n\nA. 对于 $X=0$，在Jeffreys先验下的后验均值小于在均匀先验下的后验均值；对于 $X=2N$，在Jeffreys先验下的后验均值大于在均匀先验下的后验均值。\n\nB. 对于 $X\\in\\{0,\\,2N\\}$，在Jeffreys先验下的后验方差超过在均匀先验下的后验方差。\n\nC. 对于 $X\\in\\{0,\\,2N\\}$，两种先验下的 $95\\%$ 等尾贝叶斯置信区间都严格位于 $(0,\\,1)$ 内，并且在这些边界情况下，Jeffreys等尾区间比均匀等尾区间更短。\n\nD. 对于 $X=0$，两种先验下的最高后验密度 (HPD) $95\\%$ 置信区间都包含边界点 $0$；对于 $X=2N$，它包含边界点 $1$。\n\nE. 对于 $X=0$，两种先验产生相同的后验均值和相同的后验方差。", "solution": "用户需要对问题陈述进行严格验证，然后通过详细的解答推导出正确答案并评估所有选项。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 样本量：$N$ 个无亲缘关系的二倍体个体。\n- 群体：大型、随机交配的人类群体。\n- 基因座：双等位基因。\n- 数据：在 $2N$ 条染色体中有 $X$ 个参考等位基因的拷贝。\n- 参数：$p$，参考等位基因的种群频率。\n- 似然模型：$X \\sim \\mathrm{Binomial}(2N, p)$。\n- 先验模型：$p \\sim \\mathrm{Beta}(\\alpha, \\beta)$。\n- 待比较的具体先验：\n    1. Jeffreys先验：$p \\sim \\mathrm{Beta}(0.5, 0.5)$。\n    2. 均匀先验：$p \\sim \\mathrm{Beta}(1, 1)$。\n- 关注的情况：边界计数，$X \\in \\{0, 2N\\}$。\n- 待比较的量：后验均值、后验方差、$95\\%$ 等尾置信区间，以及 $95\\%$ 最高后验密度 (HPD) 置信区间。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是贝叶斯推断在群体遗传学中的一个标准应用。对等位基因计数使用二项分布似然，并对等位基因频率使用Beta共轭先验，是统计遗传学的基石。Jeffreys先验和均匀先验是常见的无信息或弱信息选择。该设定在科学上是合理的。\n- **适定性**：该问题在数学上是适定的。给定似然和先验，后验分布是唯一确定的。需要计算的量（后验均值、方差、置信区间）是该后验分布的标准统计属性。问题是可解的，并且有唯一解。\n- **客观性**：语言精确、定量，没有任何主观性或模糊性。\n\n问题陈述是有效的。它在科学上合理、数学上适定且客观。根据验证清单，没有任何缺陷。\n\n### 推导与选项分析\n\n**1. 一般后验分布**\n给定 $p$ 时 $X$ 的似然函数是 $L(p|X) = \\binom{2N}{X} p^X (1-p)^{2N-X}$。\n$p$ 的先验分布为 $\\pi(p) \\propto p^{\\alpha-1} (1-p)^{\\beta-1}$。\n后验分布 $\\pi(p|X)$ 正比于似然函数与先验的乘积：\n$$ \\pi(p|X) \\propto p^X (1-p)^{2N-X} \\cdot p^{\\alpha-1} (1-p)^{\\beta-1} = p^{X+\\alpha-1} (1-p)^{2N-X+\\beta-1} $$\n这是Beta分布的核。因此，$p$ 的后验分布为：\n$$ p|X \\sim \\mathrm{Beta}(X+\\alpha, 2N-X+\\beta) $$\n对于一个 $\\mathrm{Beta}(a, b)$ 分布，后验均值和方差分别为 $E[p] = a/(a+b)$ 和 $\\mathrm{Var}(p) = ab/((a+b)^2(a+b+1))$。\n\n对我们的问题，后验参数为：\n- 后验均值：$E[p|X] = \\frac{X+\\alpha}{2N+\\alpha+\\beta}$\n- 后验方差：$\\mathrm{Var}(p|X) = \\frac{(X+\\alpha)(2N-X+\\beta)}{(2N+\\alpha+\\beta)^2 (2N+\\alpha+\\beta+1)}$\n\n**2. 先验和边界情况 ($X=0$ 和 $X=2N$)**\n\n*   **Jeffreys先验**：$\\alpha = 0.5$, $\\beta = 0.5$。\n    *   后验分布：$p|X \\sim \\mathrm{Beta}(X+0.5, 2N-X+0.5)$。\n    *   均值：$E_J[p|X] = \\frac{X+0.5}{2N+1}$。\n    *   方差：$\\mathrm{Var}_J(p|X) = \\frac{(X+0.5)(2N-X+0.5)}{(2N+1)^2(2N+2)}$。\n\n*   **均匀先验**：$\\alpha = 1$, $\\beta = 1$。\n    *   后验分布：$p|X \\sim \\mathrm{Beta}(X+1, 2N-X+1)$。\n    *   均值：$E_U[p|X] = \\frac{X+1}{2N+2}$。\n    *   方差：$\\mathrm{Var}_U(p|X) = \\frac{(X+1)(2N-X+1)}{(2N+2)^2(2N+3)}$。\n\n我们现在评估边界情况下的各个选项。\n\n**A. 对于 $X=0$，在Jeffreys先验下的后验均值小于在均匀先验下的后验均值；对于 $X=2N$，在Jeffreys先验下的后验均值大于在均匀先验下的后验均值。**\n\n*   **情况 $X=0$**：\n    *   $E_J[p|X=0] = \\frac{0.5}{2N+1}$。\n    *   $E_U[p|X=0] = \\frac{1}{2N+2}$。\n    *   我们比较 $\\frac{0.5}{2N+1}$ 和 $\\frac{1}{2N+2}$。不等式 $\\frac{0.5}{2N+1}  \\frac{1}{2N+2}$ 等价于 $0.5(2N+2)  2N+1$，化简为 $N+1  2N+1$，即 $N>0$。因为 $N$ 是个体数，所以 $N \\ge 1$。因此，对于 $X=0$，该陈述是正确的。\n\n*   **情况 $X=2N$**：\n    *   $E_J[p|X=2N] = \\frac{2N+0.5}{2N+1}$。\n    *   $E_U[p|X=2N] = \\frac{2N+1}{2N+2}$。\n    *   我们比较 $\\frac{2N+0.5}{2N+1}$ 和 $\\frac{2N+1}{2N+2}$。不等式 $\\frac{2N+0.5}{2N+1} > \\frac{2N+1}{2N+2}$ 等价于 $(2N+0.5)(2N+2) > (2N+1)^2$。\n    *   左边：$4N^2+4N+N+1 = 4N^2+5N+1$。\n    *   右边：$4N^2+4N+1$。\n    *   不等式 $4N^2+5N+1 > 4N^2+4N+1$ 化简为 $N>0$。这对 $N \\ge 1$ 成立。因此，对于 $X=2N$，该陈述是正确的。\n\n该陈述的两个部分都正确。Jeffreys先验的后验均值总是比均匀先验的后验均值更强烈地被拉向观测到的边界。\n**结论：正确。**\n\n**B. 对于 $X\\in\\{0,\\,2N\\}$，在Jeffreys先验下的后验方差超过在均匀先验下的后验方差。**\n\n让我们比较 $X=0$ 时的方差（根据对称性，结果对于 $X=2N$ 是相同的）。\n*   $\\mathrm{Var}_J(p|X=0) = \\frac{(0.5)(2N+0.5)}{(2N+1)^2(2N+2)}$。\n*   $\\mathrm{Var}_U(p|X=0) = \\frac{(1)(2N+1)}{(2N+2)^2(2N+3)}$。\n为了检查是否 $\\mathrm{Var}_J > \\mathrm{Var}_U$，我们计算比值 $\\frac{\\mathrm{Var}_J}{\\mathrm{Var}_U}$：\n$$ \\frac{\\mathrm{Var}_J}{\\mathrm{Var}_U} = \\frac{(0.5)(2N+0.5)}{(2N+1)^2(2N+2)} \\cdot \\frac{(2N+2)^2(2N+3)}{(1)(2N+1)} = \\frac{(N+0.25)(2N+2)(2N+3)}{(2N+1)^3} $$\n$$ = \\frac{(N+0.25)(4N^2+10N+6)}{8N^3+12N^2+6N+1} = \\frac{4N^3+11N^2+8.5N+1.5}{8N^3+12N^2+6N+1} $$\n对于任何 $N \\ge 1$，分母 $8N^3+...$ 明显大于分子 $4N^3+...$。例如，当 $N=1$ 时，比值为 $(4+11+8.5+1.5)/(8+12+6+1) = 25/27  1$。当 $N \\to \\infty$ 时，该比值趋近于 $4N^3/8N^3 = 1/2$。因此，对于所有 $N \\ge 1$，$\\mathrm{Var}_J  \\mathrm{Var}_U$。该陈述是错误的。\n**结论：错误。**\n\n**C. 对于 $X\\in\\{0,\\,2N\\}$，两种先验下的 $95\\%$ 等尾贝叶斯置信区间都严格位于 $(0,\\,1)$ 内，并且在这些边界情况下，Jeffreys等尾区间比均匀等尾区间更短。**\n\n*   **第1部分：“严格位于 $(0,\\,1)$ 内”**：对于两种先验，后验分布都是具有正参数的Beta分布。Beta分布是支撑集在区间 $(0,1)$ 上的连续分布。等尾区间由分位数定义，例如 $[q_{0.025}, q_{0.975}]$。由于累积分布函数 (CDF) $F(p)$ 从 $F(0)=0$ 到 $F(1)=1$ 是严格递增的，因此必然有 $0  q_{0.025}  q_{0.975}  1$。因此，该区间严格位于 $(0,1)$ 内。这部分是正确的。\n\n*   **第2部分：“Jeffreys等尾区间更短”**：在选项B的分析中，我们证明了对于所有相关的 $N$，都有 $\\mathrm{Var}_J  \\mathrm{Var}_U$。较小的方差表明概率质量更集中在均值周围。由于两个后验分布都是单峰的（对于 $X=0$ 是J形的）并且偏斜方向相同，较小的方差强烈暗示着更短的置信区间。数值检验（例如，对于 $N=1$）和渐近分析（当 $N\\to\\infty$ 时，区间宽度的比值趋近于 $\\sqrt{\\mathrm{Var}_J/\\mathrm{Var}_U} = \\sqrt{1/2}  1$）都支持这一点。Jeffreys先验在边界处赋予了更多的权重，所以当数据证实了一个边界值时，其后验分布会比源于平坦均匀先验的后验分布在边界处更尖锐。这导致了更集中的分布和更短的置信区间。这部分是正确的。\n\n该陈述的两个部分都正确。\n**结论：正确。**\n\n**D. 对于 $X=0$，两种先验下的最高后验密度 (HPD) $95\\%$ 置信区间都包含边界点 $0$；对于 $X=2N$，它包含边界点 $1$。**\n\nHPD区间是在给定概率含量（例如，$95\\%$）下，包含具有最高后验概率密度的参数值的区间。\n*   **情况 $X=0$**：\n    *   Jeffreys后验分布：$\\mathrm{Beta}(0.5, 2N+0.5)$。其概率密度函数 (PDF) 正比于 $p^{-0.5}(1-p)^{2N-0.5}$。对于 $p \\in (0,1)$，该函数是严格递减的，在 $p=0$ 处有一个极点。\n    *   均匀后验分布：$\\mathrm{Beta}(1, 2N+1)$。其PDF正比于 $p^0(1-p)^{2N}$，对于 $p \\in (0,1)$ 也是严格递减的。\n    *   对于在 $[0,1]$ 上的严格递减密度，最高密度区域从 $p=0$ 开始。因此，HPD区间必须是 $[0, k]$ 的形式，其中某个 $k  1$。该区间包含边界点 $p=0$。\n\n*   **情况 $X=2N$**：根据对称性，后验分布为 $\\mathrm{Beta}(2N+0.5, 0.5)$ 和 $\\mathrm{Beta}(2N+1, 1)$。两者在 $(0,1)$ 上都有严格递增的PDF，在 $p=1$ 处达到最大值。HPD区间必须是 $[k, 1]$ 的形式，它包含边界点 $p=1$。\n\n该陈述是在边界处后验分布形状的直接推论。\n**结论：正确。**\n\n**E. 对于 $X=0$，两种先验产生相同的后验均值和相同的后验方差。**\n\n从选项A和B的分析可知：\n*   $E_J[p|X=0] = \\frac{0.5}{2N+1}$ 和 $E_U[p|X=0] = \\frac{1}{2N+2}$。对于任何 $N \\ge 1$，它们都不相等。\n*   $\\mathrm{Var}_J(p|X=0)$ 和 $\\mathrm{Var}_U(p|X=0)$ 也被证明是不相等的。\n**结论：错误。**\n\n结论总结：陈述A、C和D是正确的。", "answer": "$$\\boxed{ACD}$$", "id": "5011004"}]}