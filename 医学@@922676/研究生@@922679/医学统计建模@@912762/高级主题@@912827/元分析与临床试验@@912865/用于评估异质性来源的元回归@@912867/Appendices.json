{"hands_on_practices": [{"introduction": "在尝试使用元回归解释异质性之前，我们首先需要量化其程度。$I^2$ 统计量是评估元分析中研究间异质性大小的黄金标准，它表示由研究间真实差异（而非偶然性）引起的总变异的百分比。这个练习将通过一个实际的计算，帮助你掌握异质性的基本评估方法，这是进行任何元回归分析的必要前提([@problem_id:4973210])。", "problem": "一项心血管医学领域的联合荟萃分析（consortium meta-analysis）汇总了来自 $k=12$ 项随机对照试验的证据，这些试验旨在评估一种新型抗炎疗法与主要不良心血管事件发生率之间的关联。每项研究均报告了对数风险比（log risk ratio），其逆方差权重由所报告的标准误确定。固定效应同质性检验产生的Cochran’s $Q$统计量为 $Q=28.4$。在用于评估异质性来源的荟萃回归（meta-regression）框架内，可归因于研究间异质性的总变异比例由指数 $I^2$ 量化，该指数基于从Cochran’s $Q$和自由度 $k-1$ 导出的常规异质性指数。从用于检验 $k$ 项研究同质性的Cochran’s $Q$的成熟定义出发，并根据同质性假设下观测离散度与期望离散度之比来解释异质性，推导在常规的零点截断规则下，$I^2$ 关于 $Q$ 和 $k$ 的闭式表达式。然后，计算给定荟萃分析的 $I^2$ 的数值。将最终数值四舍五入至四位有效数字，并以小数形式表示（而非百分比）。", "solution": "用户要求我解决一个与联合荟萃分析相关的问题。\n\n### 步骤1：提取已知条件\n-   随机对照试验（研究）数量：$k=12$\n-   Cochran’s Q 统计量：$Q=28.4$\n-   任务1：推导异质性指数 $I^2$ 关于 $Q$ 和 $k$ 的闭式表达式。\n-   任务2：计算给定荟萃分析的 $I^2$ 数值。\n-   约束：推导必须遵循 $I^2$ 的常规零点截断规则。\n-   约束：最终数值必须四舍五入至四位有效数字，并以小数形式表示。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述具有科学依据，提法严谨且客观。它基于统计学中荟萃分析的标准、公认原则。Cochran's $Q$ 统计量和 $I^2$ 指数是量化异质性的基本概念。给定值 $k=12$ 和 $Q=28.4$ 对于真实的荟萃分析是合理的。该问题是自洽的，提供了推导公式和计算数值所需的所有信息。在统计建模的背景下，术语精确且无歧义。没有违反验证标准的情况。\n\n### 步骤3：结论与行动\n问题有效。我将继续进行解答。\n\n### 推导与计算\n本题要求推导 $I^2$ 指数并进行后续计算。\n\n在荟萃分析中，Cochran's $Q$ 统计量用于检验多个研究结果之间是否存在异质性。它的计算方法是单个研究效应与合并效应估计值之间差异的加权平方和。在同质性的零假设下（即所有研究共享一个共同的效应量，且研究间方差 $\\tau^2$ 为零），$Q$ 统计量服从自由度（$df$）为 $k-1$ 的卡方（$\\chi^2$）分布，其中 $k$ 是研究的数量。\n\n一个服从 $\\chi^2$ 分布的随机变量的期望值等于其自由度。因此，在同质性零假设下，$Q$ 的期望值为：\n$$E[Q | H_0] = k-1$$\n\n当研究间存在真实异质性时（$\\tau^2 > 0$），观测到的 $Q$ 值预计会大于 $k-1$。观测到的 $Q$ 与其在同质性假设下的期望值之差 $Q - (k-1)$，可以解释为“额外”变异的估计值，即归因于研究间异质性的变异。\n\n$I^2$ 统计量定义为效应估计值总变异中由异质性而非抽样误差（机遇）引起的部分所占的比例。它量化了异质性对荟萃分析的影响。总观测离散度由 $Q$ 表示，而机遇所致的期望离散度由其自由度 $df = k-1$ 表示。\n\n因此，额外变异相对于总观测变异的比例由以下比率给出：\n$$I^2 = \\frac{\\text{额外变异}}{\\text{总变异}} = \\frac{Q - (k-1)}{Q}$$\n\n该公式在 $Q \\ge k-1$ 时有效。然而，由于机遇，观测到的 $Q$ 值可能小于 $k-1$。在这种情况下，该公式会得出 $I^2$ 的负值，这对于方差比例来说是没有意义的。为了解决这个问题，应用了“零点截断规则”，即如果 $Q  k-1$，则定义 $I^2$ 为 $0$。这反映了没有证据表明存在研究间异质性的事实。\n\n结合这两个条件，得到 $I^2$ 的完整闭式表达式：\n$$I^2 = \\max\\left(0, \\frac{Q - (k-1)}{Q}\\right)$$\n\n这就是所要求的 $I^2$ 关于 $Q$ 和 $k$ 的闭式表达式。\n\n现在，我们为给定的荟萃分析计算 $I^2$ 的数值。\n给定的数据是：\n-   研究数量：$k=12$\n-   Cochran's Q 统计量：$Q=28.4$\n\n首先，我们计算自由度（$df$）：\n$$df = k-1 = 12 - 1 = 11$$\n\n接下来，我们检查 $Q$ 是否大于其自由度：\n$$28.4 > 11$$\n由于 $Q > df$， $I^2$ 的值将为正，我们不需要在零点截断。我们使用公式 $I^2 = \\frac{Q - (k-1)}{Q}$。\n\n将给定值代入公式：\n$$I^2 = \\frac{28.4 - (12-1)}{28.4} = \\frac{28.4 - 11}{28.4}$$\n$$I^2 = \\frac{17.4}{28.4}$$\n\n现在，我们计算小数值：\n$$I^2 \\approx 0.6126760563...$$\n\n题目要求将最终数值四舍五入至四位有效数字。前四位有效数字是 $6, 1, 2, 6$。第五位数字是 $7$，大于或等于 $5$，因此我们将第四位有效数字向上取整。\n$$I^2 \\approx 0.6127$$\n这个以小数表示的值表明，效应估计值总变异中约有 $61.27\\%$ 可归因于研究间异质性，而非机遇。", "answer": "$$\\boxed{0.6127}$$", "id": "4973210"}, {"introduction": "一旦确定存在显著的异质性，下一步就是进行元回归，以探究研究水平的协变量是否可以解释这种异质性。本练习将引导你完成元回归模型的核心计算过程：使用加权最小二乘法（WLS）估计回归系数。通过这个动手实践，你将深入理解模型如何利用研究内部和研究之间的方差信息，来精确估计协变量对效应大小的影响([@problem_id:4973194])。", "problem": "一位临床科学家正在进行一项随机效应元回归，以评估在各项随机临床试验中，基线平均年龄是否会调节死亡结局的对数风险比。对于每项研究 $i \\in \\{1,2,3,4\\}$，令 $y_i$ 表示观测到的对数风险比，$v_i$ 表示 $y_i$ 的已知研究内方差，以及 $x_i$ 表示一个单一的研究水平调节变量（以50岁为中心的基线平均年龄，单位为十年，因此 $x_i = 0$ 对应50岁，$x_i = 1$ 对应60岁，依此类推）。该元回归包含一个截距和这个单一的调节变量。\n\n假设一个随机效应元回归模型，其中真实的研究效应根据一个具有研究间方差 $\\tau^2$ 的可加随机成分而变化。研究间方差的估计值为 $\\hat{\\tau}^2 = 0.0100$，该值通过限制性最大似然法（REML）获得。\n\n观测数据如下：\n- 研究 $1$：$y_1 = 0.10$，$v_1 = 0.0100$，$x_1 = 0$。\n- 研究 $2$：$y_2 = 0.30$，$v_2 = 0.0225$，$x_2 = 1$。\n- 研究 $3$：$y_3 = 0.20$，$v_3 = 0.0160$，$x_3 = 2$。\n- 研究 $4$：$y_4 = 0.50$，$v_4 = 0.0400$，$x_4 = 3$。\n\n使用逆方差加异质性权重 $w_i^{*} = 1/\\left(v_i + \\hat{\\tau}^2\\right)$ 以及包含截距和调节变量 $x_i$ 的标准随机效应元回归，计算加权最小二乘估计 $\\hat{\\boldsymbol{\\beta}} = \\begin{pmatrix} \\hat{\\beta}_0 \\\\ \\hat{\\beta}_1 \\end{pmatrix}$。\n\n将最终答案表示为行矩阵 $\\begin{pmatrix} \\hat{\\beta}_0  \\hat{\\beta}_1 \\end{pmatrix}$，并将每个系数四舍五入到四位有效数字。", "solution": "此问题有效。这是一个在统计建模领域中提法恰当、有科学依据且客观的问题。所有必要的数据和定义都已提供，没有矛盾或含糊之处。\n\n所指定的随机效应元回归模型是一个线性模型，它将观测到的效应量 $y_i$ 与研究水平的调节变量 $x_i$ 联系起来。研究 $i$ 的模型是：\n$$y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$$\n其中 $\\beta_0$ 是截距，$\\beta_1$ 是调节变量 $x_i$ 的系数，$\\epsilon_i$ 是研究 $i$ 的误差项。在随机效应模型中，误差项 $\\epsilon_i$ 包含研究内抽样误差和研究间异质性。$y_i$ 的总方差是研究内方差 $v_i$ 和研究间方差 $\\tau^2$ 的和。\n$$\\text{Var}(y_i) = v_i + \\tau^2$$\n参数 $\\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\end{pmatrix}$ 使用加权最小二乘法（WLS）进行估计。标准的WLS估计量的矩阵形式为：\n$$\\hat{\\boldsymbol{\\beta}} = (\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X})^{-1} \\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{y}$$\n其中 $\\boldsymbol{y}$ 是观测效应的向量，$\\boldsymbol{X}$ 是设计矩阵，$\\boldsymbol{W}$ 是权重的对角矩阵。权重是每项研究总方差的倒数。由于 $\\tau^2$ 未知，我们使用其估计值 $\\hat{\\tau}^2$ 来计算权重 $w_i^*$。\n$$w_i^* = \\frac{1}{v_i + \\hat{\\tau}^2}$$\n矩阵 $\\boldsymbol{W}$ 则为 $\\boldsymbol{W} = \\text{diag}(w_1^*, w_2^*, w_3^*, w_4^*)$。\n\n给定的数据如下：\n- $\\hat{\\tau}^2 = 0.0100$\n- 研究 $1$：$y_1 = 0.10$，$v_1 = 0.0100$，$x_1 = 0$\n- 研究 $2$：$y_2 = 0.30$，$v_2 = 0.0225$，$x_2 = 1$\n- 研究 $3$：$y_3 = 0.20$，$v_3 = 0.0160$，$x_3 = 2$\n- 研究 $4$：$y_4 = 0.50$，$v_4 = 0.0400$，$x_4 = 3$\n\n首先，我们计算权重 $w_i^*$：\n$$w_1^* = \\frac{1}{0.0100 + 0.0100} = \\frac{1}{0.0200} = 50$$\n$$w_2^* = \\frac{1}{0.0225 + 0.0100} = \\frac{1}{0.0325} = \\frac{400}{13}$$\n$$w_3^* = \\frac{1}{0.0160 + 0.0100} = \\frac{1}{0.0260} = \\frac{1000}{26} = \\frac{500}{13}$$\n$$w_4^* = \\frac{1}{0.0400 + 0.0100} = \\frac{1}{0.0500} = 20$$\n\n向量和矩阵如下：\n$$\\boldsymbol{y} = \\begin{pmatrix} 0.10 \\\\ 0.30 \\\\ 0.20 \\\\ 0.50 \\end{pmatrix}, \\quad \\boldsymbol{X} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\\\ 1  3 \\end{pmatrix}, \\quad \\boldsymbol{W} = \\begin{pmatrix} 50  0  0  0 \\\\ 0  \\frac{400}{13}  0  0 \\\\ 0  0  \\frac{500}{13}  0 \\\\ 0  0  0  20 \\end{pmatrix}$$\n\n接下来，我们计算 $\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X}$：\n其一般形式为 $\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X} = \\begin{pmatrix} \\sum w_i^*  \\sum w_i^* x_i \\\\ \\sum w_i^* x_i  \\sum w_i^* x_i^2 \\end{pmatrix}$。\n$$\\sum w_i^* = 50 + \\frac{400}{13} + \\frac{500}{13} + 20 = 70 + \\frac{900}{13} = \\frac{910+900}{13} = \\frac{1810}{13}$$\n$$\\sum w_i^* x_i = (50)(0) + \\left(\\frac{400}{13}\\right)(1) + \\left(\\frac{500}{13}\\right)(2) + (20)(3) = \\frac{400}{13} + \\frac{1000}{13} + 60 = \\frac{1400+780}{13} = \\frac{2180}{13}$$\n$$\\sum w_i^* x_i^2 = (50)(0^2) + \\left(\\frac{400}{13}\\right)(1^2) + \\left(\\frac{500}{13}\\right)(2^2) + (20)(3^2) = \\frac{400}{13} + \\frac{2000}{13} + 180 = \\frac{2400+2340}{13} = \\frac{4740}{13}$$\n所以，$\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X} = \\begin{pmatrix} \\frac{1810}{13}  \\frac{2180}{13} \\\\ \\frac{2180}{13}  \\frac{4740}{13} \\end{pmatrix}$。\n\n接下来，我们计算 $\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{y}$：\n其一般形式为 $\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{y} = \\begin{pmatrix} \\sum w_i^* y_i \\\\ \\sum w_i^* x_i y_i \\end{pmatrix}$。\n$$\\sum w_i^* y_i = (50)(0.10) + \\left(\\frac{400}{13}\\right)(0.30) + \\left(\\frac{500}{13}\\right)(0.20) + (20)(0.50) = 5 + \\frac{120}{13} + \\frac{100}{13} + 10 = 15 + \\frac{220}{13} = \\frac{195+220}{13} = \\frac{415}{13}$$\n$$\\sum w_i^* x_i y_i = (50)(0)(0.10) + \\left(\\frac{400}{13}\\right)(1)(0.30) + \\left(\\frac{500}{13}\\right)(2)(0.20) + (20)(3)(0.50) = 0 + \\frac{120}{13} + \\frac{200}{13} + 30 = \\frac{320+390}{13} = \\frac{710}{13}$$\n所以，$\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{y} = \\begin{pmatrix} \\frac{415}{13} \\\\ \\frac{710}{13} \\end{pmatrix}$。\n\n现在，我们求 $\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X}$ 的逆矩阵。行列式为：\n$$\\det(\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X}) = \\left(\\frac{1810}{13}\\right)\\left(\\frac{4740}{13}\\right) - \\left(\\frac{2180}{13}\\right)^2 = \\frac{(1810)(4740) - (2180)^2}{169} = \\frac{8579400 - 4752400}{169} = \\frac{3827000}{169}$$\n逆矩阵为：\n$$(\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X})^{-1} = \\frac{1}{\\det(\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X})} \\begin{pmatrix} \\frac{4740}{13}  -\\frac{2180}{13} \\\\ -\\frac{2180}{13}  \\frac{1810}{13} \\end{pmatrix} = \\frac{169}{3827000} \\begin{pmatrix} \\frac{4740}{13}  -\\frac{2180}{13} \\\\ -\\frac{2180}{13}  \\frac{1810}{13} \\end{pmatrix} = \\frac{13}{3827000} \\begin{pmatrix} 4740  -2180 \\\\ -2180  1810 \\end{pmatrix}$$\n\n最后，我们计算 $\\hat{\\boldsymbol{\\beta}}$：\n$$\\hat{\\boldsymbol{\\beta}} = (\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{X})^{-1} (\\boldsymbol{X}^T \\boldsymbol{W} \\boldsymbol{y}) = \\frac{13}{3827000} \\begin{pmatrix} 4740  -2180 \\\\ -2180  1810 \\end{pmatrix} \\begin{pmatrix} \\frac{415}{13} \\\\ \\frac{710}{13} \\end{pmatrix}$$\n$$\\hat{\\boldsymbol{\\beta}} = \\frac{1}{3827000} \\begin{pmatrix} 4740  -2180 \\\\ -2180  1810 \\end{pmatrix} \\begin{pmatrix} 415 \\\\ 710 \\end{pmatrix}$$\n$$\\hat{\\boldsymbol{\\beta}} = \\frac{1}{3827000} \\begin{pmatrix} (4740)(415) - (2180)(710) \\\\ (-2180)(415) + (1810)(710) \\end{pmatrix}$$\n$$\\hat{\\boldsymbol{\\beta}} = \\frac{1}{3827000} \\begin{pmatrix} 1967100 - 1547800 \\\\ -904700 + 1285100 \\end{pmatrix} = \\frac{1}{3827000} \\begin{pmatrix} 419300 \\\\ 380400 \\end{pmatrix}$$\n$$\\hat{\\boldsymbol{\\beta}} = \\begin{pmatrix} \\frac{419300}{3827000} \\\\ \\frac{380400}{3827000} \\end{pmatrix} = \\begin{pmatrix} \\frac{4193}{38270} \\\\ \\frac{3804}{38270} \\end{pmatrix} \\approx \\begin{pmatrix} 0.10956388... \\\\ 0.09939926... \\end{pmatrix}$$\n系数的估计值为 $\\hat{\\beta}_0 \\approx 0.10956388...$ 和 $\\hat{\\beta}_1 \\approx 0.09939926...$。\n\n将每个系数四舍五入到四位有效数字：\n$\\hat{\\beta}_0 \\approx 0.1096$\n$\\hat{\\beta}_1 \\approx 0.09940$（末尾的零是有效数字）\n\n最终答案要求以行矩阵 $\\begin{pmatrix} \\hat{\\beta}_0  \\hat{\\beta}_1 \\end{pmatrix}$ 的形式给出。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1096  0.09940 \\end{pmatrix}}\n$$", "id": "4973194"}, {"introduction": "在估计出元回归模型的系数后，我们必须评估其统计不确定性，以便做出可靠的推断。由于医学领域的元分析通常涉及的研究数量有限，标准的置信区间可能不够准确。本练习将介绍并应用Knapp-Hartung小样本调整方法来构建置信区间，这是一种在实践中至关重要的稳健推断技术，可以为调节变量效应的显著性提供更可靠的证据([@problem_id:4973172])。", "problem": "在医学背景下，进行了一项随机效应元回归，以评估研究水平的调节变量是否能解释各研究间对数风险比的异质性。设 $k$ 表示研究数量，$p$ 表示元回归中的拟合参数数量（包括截距）。考虑我们感兴趣的单个调节变量的系数 $\\beta_{j}$。加权最小二乘 (WLS) 估计量 $\\hat{\\beta}_{j}$ 是通过使用包含估计的研究间方差的逆方差权重获得的。采用 Knapp–Hartung 小样本校正，以便通过自由度为 $k-p$ 的学生t分布来反映方差估计中的不确定性，并且用于 $\\hat{\\beta}_{j}$ 的方差元素是校正后协方差矩阵的第 $j$ 个对角元素，记为 $\\hat{V}_{jj}$。\n\n已知 $\\hat{\\beta}_{j}=0.25$，$\\hat{V}_{jj}=0.04$，$k=15$，$p=2$。请构建 $\\beta_{j}$ 的95% Knapp–Hartung 双侧置信区间，并仅报告其上限，结果为一个纯数字。将你的答案四舍五入到四位有效数字。", "solution": "该问题要求为元回归系数 $\\beta_{j}$ 构建一个95% Knapp-Hartung 双侧置信区间，并报告其上限。\n\n首先，我们验证问题陈述的有效性。\n给定的条件是：\n- 系数的估计量：$\\hat{\\beta}_{j} = 0.25$。\n- 估计量的估计方差：$\\hat{V}_{jj} = 0.04$。\n- 研究数量：$k = 15$。\n- 拟合参数的数量：$p = 2$。\n- 置信水平指定为95%。\n- 统计框架是使用Knapp–Hartung小样本校正的随机效应元回归。\n\n该问题具有科学依据，因为它描述了元回归技术的一个标准应用，特别是Knapp-Hartung方法，该方法在医学研究的统计实践中已广为接受。该问题提法恰当，提供了计算该区间所需的所有数据。所有术语的定义都清晰明确。因此，该问题是有效的，我们可以继续求解。\n\n参数估计的双侧置信区间的一般形式为：\n$$ \\text{估计值} \\pm (\\text{临界值}) \\times (\\text{标准误}) $$\n\n在元回归的Knapp–Hartung校正背景下，系数 $\\beta_{j}$ 的置信区间构建如下：\n$$ \\hat{\\beta}_{j} \\pm t_{1-\\alpha/2, df} \\sqrt{\\hat{V}_{jj}} $$\n其中：\n- $\\hat{\\beta}_{j}$ 是系数的点估计。\n- $\\hat{V}_{jj}$ 是从校正后协方差矩阵中得到的 $\\hat{\\beta}_{j}$ 的估计方差。因此，标准误（SE）为 $\\sqrt{\\hat{V}_{jj}}$。\n- $t_{1-\\alpha/2, df}$ 是来自学生t分布的临界值。\n- $\\alpha$ 是显著性水平，对应于 $100 \\times (1-\\alpha)\\%$ 的置信区间。\n- $df$ 代表自由度。\n\n问题指定了95%的置信区间，因此显著性水平 $\\alpha$ 为 $1 - 0.95 = 0.05$。对于双侧区间，我们使用 $\\alpha/2 = 0.025$。临界值是t分布的分位数，其累积概率为 $1 - \\alpha/2 = 0.975$。\n\nKnapp-Hartung校正的自由度 $df$ 由 $k - p$ 给出。使用所提供的值：\n$$ df = k - p = 15 - 2 = 13 $$\n\n我们需要找到临界值 $t_{0.975, 13}$。通过查阅学生t分布的标准表格或使用统计软件，我们发现：\n$$ t_{0.975, 13} \\approx 2.160369 $$\n\n点估计为 $\\hat{\\beta}_{j} = 0.25$。\n估计方差为 $\\hat{V}_{jj} = 0.04$。\n估计的标准误是方差的平方根：\n$$ SE(\\hat{\\beta}_{j}) = \\sqrt{\\hat{V}_{jj}} = \\sqrt{0.04} = 0.2 $$\n\n现在我们可以构建置信区间。题目只要求上限。\n上限的公式为：\n$$ \\text{上限} = \\hat{\\beta}_{j} + t_{0.975, df} \\times SE(\\hat{\\beta}_{j}) $$\n\n代入数值：\n$$ \\text{上限} = 0.25 + (2.160369) \\times (0.2) $$\n$$ \\text{上限} = 0.25 + 0.4320738 $$\n$$ \\text{上限} = 0.6820738 $$\n\n问题要求最终答案四舍五入到四位有效数字。前四位有效数字是 $6$、$8$、$2$ 和 $0$。第五位有效数字是 $7$，大于或等于 $5$，所以我们将第四位数字向上舍入。\n$$ \\text{上限} \\approx 0.6821 $$", "answer": "$$\\boxed{0.6821}$$", "id": "4973172"}]}