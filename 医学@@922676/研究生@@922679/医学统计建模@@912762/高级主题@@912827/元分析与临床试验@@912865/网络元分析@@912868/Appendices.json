{"hands_on_practices": [{"introduction": "网络荟萃分析（NMA）的核心威力在于它能够比较从未在单个试验中直接对比过的干预措施。本练习将引导您完成一个基础但至关重要的推导，即如何基于一致性假设，通过一个共同的比较者将证据链连接起来，从而计算出间接处理效应及其方差。掌握这一过程是理解和应用NMA的基石。[@problem_id:4977502]", "problem": "考虑一组随机对照试验（RCT），它们构成一个最低限度连接的三治疗网络，其中治疗 $A$ 与治疗 $B$ 进行了比较，治疗 $B$ 与治疗 $C$ 进行了比较，但治疗 $A$ 和治疗 $C$ 之间没有直接比较。假设效应量是在可加尺度上（例如，均数差或比率尺度效应的对数，使得在转换后的尺度上可加性成立）。设每个治疗 $t \\in \\{A,B,C\\}$ 都与一个研究水平的参数 $\\theta_{t}$ 相关联，该参数表示其在可加尺度上的预期结局。将治疗 $X$ 相对于治疗 $Y$ 的相对效应定义为 $d_{XY} = \\theta_{X} - \\theta_{Y}$。\n\n假设从 $A$ 对比 $B$ 的比较和 $B$ 对比 $C$ 的比较中获得的成对meta分析合并估计量分别为 $\\hat{d}_{AB}$ 和 $\\hat{d}_{BC}$，在标准的meta分析正则性条件下，它们分别是 $d_{AB}$ 和 $d_{BC}$ 的无偏估计。设其抽样方差为 $v_{AB} = \\operatorname{Var}(\\hat{d}_{AB})$ 和 $v_{BC} = \\operatorname{Var}(\\hat{d}_{BC})$。假设 $A$ 对比 $B$ 的证据和 $B$ 对比 $C$ 的证据来自不相交的试验集，并且没有同时连接 $A$、$B$ 和 $C$ 的多臂试验，因此 $\\hat{d}_{AB}$ 和 $\\hat{d}_{BC}$ 是独立的。\n\n从上述核心定义和网络meta分析（NMA）的一致性假设（即特定于治疗的参数 $\\theta_{t}$ 在整个网络中是一致的）出发，推导 $A$ 对比 $C$ 相对效应的间接估计量 $\\hat{d}_{AC}$，并在所述独立性条件下确定其抽样方差。用 $\\hat{d}_{AB}$、$\\hat{d}_{BC}$、$v_{AB}$ 和 $v_{BC}$ 将你的最终答案表示为一个闭式解析表达式。不需要进行数值计算，也不需要四舍五入。将你的最终答案以一个包含间接估计量及其方差的双元素行矩阵的形式给出。", "solution": "该问题提出了网络meta分析领域中一个有效且定义明确的问题。它提供了一套完整且一致的已知条件，遵循既定的科学原则，并以精确、客观的语言表述。任务是推导间接比较的估计量及其对应的方差，这是该统计学领域中的一个基本过程。\n\n该问题描述了一个涉及治疗 $A$、$B$ 和 $C$ 的三治疗网络。现有证据包括 $A$ 和 $B$ 之间的直接比较，以及 $B$ 和 $C$ 之间的直接比较。没有比较 $A$ 和 $C$ 的直接证据。目标是利用现有信息估计 $A$ 相对于 $C$ 的相对效应，记为 $d_{AC}$。\n\n设 $\\theta_A$、$\\theta_B$ 和 $\\theta_C$ 分别表示治疗 $A$、$B$ 和 $C$ 在可加尺度上的真实平均效应。任意两种治疗 $X$ 和 $Y$ 之间的相对治疗效应定义为 $d_{XY} = \\theta_X - \\theta_Y$。\n\n能够在网络中综合证据的核心原则是一致性假设。该假设断定，所有治疗效应都是一致的，并且可以映射到由特定于治疗的参数 $\\theta_t$ 定义的单一底层框架上。对于我们的三治疗链 $A-B-C$，一致性方程将直接效应和间接效应关联如下：\n$$\nd_{AC} = d_{AB} + d_{BC}\n$$\n这可以通过将相对效应的定义代入绝对效应来证明：\n$$\nd_{AB} + d_{BC} = (\\theta_A - \\theta_B) + (\\theta_B - \\theta_C) = \\theta_A - \\theta_C = d_{AC}\n$$\n一致性方程为间接估计 $d_{AC}$ 提供了理论基础。\n\n我们已知两个用于直接比较的独立、无偏的估计量：\n1. $\\hat{d}_{AB}$，是 $d_{AB}$ 的一个估计量，其方差为 $v_{AB} = \\operatorname{Var}(\\hat{d}_{AB})$。\n2. $\\hat{d}_{BC}$，是 $d_{BC}$ 的一个估计量，其方差为 $v_{BC} = \\operatorname{Var}(\\hat{d}_{BC})$。\n\n无偏性意味着 $E[\\hat{d}_{AB}] = d_{AB}$ 和 $E[\\hat{d}_{BC}] = d_{BC}$。独立性意味着它们的协方差为零：$\\operatorname{Cov}(\\hat{d}_{AB}, \\hat{d}_{BC}) = 0$。\n\n为了推导 $d_{AC}$ 的间接估计量（我们将其表示为 $\\hat{d}_{AC}$），我们使用基于一致性方程的“代入”原则。我们将真实效应的估计量代入该方程：\n$$\n\\hat{d}_{AC} = \\hat{d}_{AB} + \\hat{d}_{BC}\n$$\n这个表达式给出了 $A$ 相对于 $C$ 的间接比较的点估计。我们可以验证这个估计量对于 $d_{AC}$ 是无偏的。利用期望算子的线性性质：\n$$\nE[\\hat{d}_{AC}] = E[\\hat{d}_{AB} + \\hat{d}_{BC}] = E[\\hat{d}_{AB}] + E[\\hat{d}_{BC}]\n$$\n代入已知的期望值：\n$$\nE[\\hat{d}_{AC}] = d_{AB} + d_{BC}\n$$\n根据一致性方程，$d_{AB} + d_{BC} = d_{AC}$，所以我们有：\n$$\nE[\\hat{d}_{AC}] = d_{AC}\n$$\n因此，间接估计量 $\\hat{d}_{AC}$ 是真实相对效应 $d_{AC}$ 的一个无偏估计量。\n\n接下来，我们推导这个间接估计量的抽样方差，$\\operatorname{Var}(\\hat{d}_{AC})$。两个随机变量之和的方差由以下公式给出：\n$$\n\\operatorname{Var}(X+Y) = \\operatorname{Var}(X) + \\operatorname{Var}(Y) + 2\\operatorname{Cov}(X,Y)\n$$\n将此应用于我们的估计量 $\\hat{d}_{AC}$：\n$$\n\\operatorname{Var}(\\hat{d}_{AC}) = \\operatorname{Var}(\\hat{d}_{AB} + \\hat{d}_{BC}) = \\operatorname{Var}(\\hat{d}_{AB}) + \\operatorname{Var}(\\hat{d}_{BC}) + 2\\operatorname{Cov}(\\hat{d}_{AB}, \\hat{d}_{BC})\n$$\n问题陈述指明，关于 $A$ 对比 $B$ 和 $B$ 对比 $C$ 的证据来自不相交的试验集，这确保了估计量 $\\hat{d}_{AB}$ 和 $\\hat{d}_{BC}$ 是统计独立的。对于独立的随机变量，协方差为零。\n$$\n\\operatorname{Cov}(\\hat{d}_{AB}, \\hat{d}_{BC}) = 0\n$$\n将此代入方差方程，可简化为：\n$$\n\\operatorname{Var}(\\hat{d}_{AC}) = \\operatorname{Var}(\\hat{d}_{AB}) + \\operatorname{Var}(\\hat{d}_{BC})\n$$\n最后，使用所提供的方差符号 $v_{AB} = \\operatorname{Var}(\\hat{d}_{AB})$ 和 $v_{BC} = \\operatorname{Var}(\\hat{d}_{BC})$，我们得到间接估计量方差的最终表达式：\n$$\n\\operatorname{Var}(\\hat{d}_{AC}) = v_{AB} + v_{BC}\n$$\n这表明，对于间接比较，在独立性假设下，其点估计是构成它的直接估计量之和，其方差是它们方差之和。\n\n因此，所要求的两个量是间接估计量 $\\hat{d}_{AC} = \\hat{d}_{AB} + \\hat{d}_{BC}$ 及其抽样方差 $\\operatorname{Var}(\\hat{d}_{AC}) = v_{AB} + v_{BC}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\hat{d}_{AB} + \\hat{d}_{BC}  v_{AB} + v_{BC} \\end{pmatrix}}\n$$", "id": "4977502"}, {"introduction": "NMA的一个关键假设是网络内的一致性，即直接证据和间接证据对于同一个处理比较应该得出相似的结论。本练习提供了一种在简单的三角网络中检验此假设的实用方法，您将学习如何计算一个不一致性统计量（Cochran’s $Q$ 型统计量），这是验证任何NMA结果有效性的关键质控步骤。通过这个计算，您可以量化并评估不同证据来源之间的潜在冲突。[@problem_id:4977517]", "problem": "考虑一个网络Meta分析（NMA）中的封闭三角治疗网络，该分析比较了三种标记为 $A$、$B$ 和 $C$ 的抗高血压药物的随机对照试验（RCTs）。假设来自三个不重叠的RCTs组的、针对一个共同二元终点的对数风险比的比较内Meta分析合并直接估计值是可用的，并且这三条边上的直接估计值具有近似正态性和独立性。具体而言，观测到的直接效应及其标准误如下：\n- $A$ 对比 $B$：估计值 $d_{AB} = -0.20$，标准误 $s_{AB} = 0.12$，\n- $B$ 对比 $C$：估计值 $d_{BC} = -0.10$，标准误 $s_{BC} = 0.15$，\n- $A$ 对比 $C$：估计值 $d_{AC} = -0.35$，标准误 $s_{AC} = 0.14$。\n\n假设在一致性条件下，对数尺度上的经典一致性关系成立，即真实效应满足 $d_{AC} = d_{AB} + d_{BC}$，并且三个直接估计值是独立的，分别近似服从方差为 $s_{AB}^{2}$、$s_{BC}^{2}$ 和 $s_{AC}^{2}$ 的高斯分布。在此模型基础上，构建此三角形中用于检验不一致性的单自由度Cochran’s $Q$型统计量，作为从第一性原理推导出的环路一致性约束的Wald型检验。然后，在一致性零假设下，计算相关的尾部面积 $p$ 值。\n\n将 $p$ 值报告为纯小数，四舍五入到四位有效数字。无需单位。", "solution": "该问题要求计算一个三角治疗网络中统计不一致性检验的 $p$ 值。这是网络Meta分析（NMA）中的一个标准程序。该问题的有效性得到确认，因为它在统计理论上具有科学依据，所有必要数据均已提供，提法严谨，并且其表述是客观的。\n\n令比较的未观测到的真实对数风险比用 $\\delta_{AB}$、$\\delta_{BC}$ 和 $\\delta_{AC}$ 表示。在一个封闭的三角网络 $A-B-C$ 中，一致性（coherence，或称consistency）假说假定任意两种治疗之间的直接效应等于通过第三种治疗推导出的间接效应。在对数风险比尺度上，这表示为以下线性关系：\n$$ \\delta_{AC} = \\delta_{AB} + \\delta_{BC} $$\n这可以改写为 $\\delta_{AB} + \\delta_{BC} - \\delta_{AC} = 0$。一致性检验的零假设是 $H_0: \\delta_{AB} + \\delta_{BC} - \\delta_{AC} = 0$。\n\n我们已知这些效应的直接估计值，用 $d_{AB}$、$d_{BC}$ 和 $d_{AC}$ 表示，它们被假定为独立的、服从正态分布的随机变量，其均值等于真实效应，方差已知。\n$$ d_{AB} \\sim N(\\delta_{AB}, s_{AB}^2) $$\n$$ d_{BC} \\sim N(\\delta_{BC}, s_{BC}^2) $$\n$$ d_{AC} \\sim N(\\delta_{AC}, s_{AC}^2) $$\n其中 $s_{AB}$、$s_{BC}$ 和 $s_{AC}$ 分别是相应估计值的标准误。\n\n为了检验一致性假说，我们定义一个随机变量，通常称为“不一致性因子”或“环路不一致性”，它捕捉了闭环中的差异。令其为 $\\omega$：\n$$ \\omega = d_{AB} + d_{BC} - d_{AC} $$\n这个变量表示 $A$ 对比 $C$ 效应的间接估计值（$d_{AB} + d_{BC}$）与直接估计值（$d_{AC}$）之间的差异。\n\n在零假设 $H_0$ 下，$\\omega$ 的期望值为：\n$$ E[\\omega | H_0] = E[d_{AB}] + E[d_{BC}] - E[d_{AC}] = \\delta_{AB} + \\delta_{BC} - \\delta_{AC} = 0 $$\n因为假定直接估计值 $d_{AB}$、$d_{BC}$ 和 $d_{AC}$ 是独立的，所以 $\\omega$ 的方差是它们各自方差的总和：\n$$ V_\\omega = \\text{Var}(\\omega) = \\text{Var}(d_{AB}) + \\text{Var}(d_{BC}) + \\text{Var}(d_{AC}) = s_{AB}^2 + s_{BC}^2 + s_{AC}^2 $$\n\n由于 $\\omega$ 是正态分布随机变量的线性组合，它本身也服从正态分布：\n$$ \\omega \\sim N(E[\\omega], V_\\omega) $$\n在 $H_0$ 下，这变为 $\\omega \\sim N(0, V_\\omega)$。\n\n问题指定要构建一个Cochran’s $Q$型统计量，这是一种Wald型检验统计量。对于一个参数估计值 $\\hat{\\theta}$，其零假设下的值为 $\\theta_0$，方差为 $\\text{Var}(\\hat{\\theta})$，Wald统计量为 $(\\hat{\\theta} - \\theta_0)^2 / \\text{Var}(\\hat{\\theta})$。在我们的案例中，参数估计值是观测到的不一致性因子 $\\omega$，其零假设下的值为 $0$。因此，检验统计量 $Q$ 是：\n$$ Q = \\frac{(\\omega - 0)^2}{V_\\omega} = \\frac{\\omega^2}{V_\\omega} $$\n在 $H_0$ 下，标准化变量 $Z = \\omega / \\sqrt{V_\\omega}$ 服从标准正态分布 $Z \\sim N(0,1)$。因此，统计量 $Q = Z^2$ 服从自由度为1的卡方分布，$Q \\sim \\chi^2_1$。\n\n现在，我们代入给定的数值：\n- $d_{AB} = -0.20$，标准误 $s_{AB} = 0.12$，所以 $s_{AB}^2 = (0.12)^2 = 0.0144$。\n- $d_{BC} = -0.10$，标准误 $s_{BC} = 0.15$，所以 $s_{BC}^2 = (0.15)^2 = 0.0225$。\n- $d_{AC} = -0.35$，标准误 $s_{AC} = 0.14$，所以 $s_{AC}^2 = (0.14)^2 = 0.0196$。\n\n首先，我们计算不一致性因子 $\\omega$ 的观测值：\n$$ \\omega = (-0.20) + (-0.10) - (-0.35) = -0.30 + 0.35 = 0.05 $$\n接下来，我们计算 $\\omega$ 的方差 $V_\\omega$：\n$$ V_\\omega = s_{AB}^2 + s_{BC}^2 + s_{AC}^2 = 0.0144 + 0.0225 + 0.0196 = 0.0565 $$\n现在我们可以计算 $Q$ 统计量的值：\n$$ Q = \\frac{\\omega^2}{V_\\omega} = \\frac{(0.05)^2}{0.0565} = \\frac{0.0025}{0.0565} \\approx 0.0442477876 $$\n\n$p$ 值是在假定零假设为真的情况下，获得一个至少与观测值一样极端的检验统计量的概率。对于卡方检验，这是上尾概率：\n$$ p = P(\\chi^2_1 \\ge Q) = P(\\chi^2_1 \\ge 0.0442477876) $$\n使用 $\\chi^2_1$ 分布的累积分布函数（CDF），记为 $F_{\\chi^2_1}(x)$，$p$ 值为 $1 - F_{\\chi^2_1}(Q)$。\n$$ p \\approx 1 - F_{\\chi^2_1}(0.0442477876) \\approx 0.833444 $$\n问题要求将 $p$ 值四舍五入到四位有效数字。\n$$ p \\approx 0.8334 $$\n这个高 $p$ 值表明，在该治疗环路中，没有统计上显著的不一致性证据。观测数据与一致性假设高度相容。", "answer": "$$\\boxed{0.8334}$$", "id": "4977517"}, {"introduction": "在实际的NMA应用中，研究者常常需要在多个备选统计模型之间做出选择，以最好地解释数据中的异质性。本练习将您带入NMA的贝叶斯框架，通过计算和比较偏差信息准则（DIC），来评估一个基础模型与一个更复杂的元回归模型。这个过程将具体展示如何在模型的拟合优度与复杂性之间进行权衡，这是高级统计建模中的一项核心技能。[@problem_id:4551832]", "problem": "一个预防医学研究团队对 $18$ 项随机对照试验中的四种流感预防策略进行了一致性贝叶斯随机效应网络荟萃分析（NMA）。研究中考虑了两种竞争模型：模型 $\\mathcal{M}_{0}$ 是不含元回归的基础NMA；模型 $\\mathcal{M}_{1}$ 在 $\\mathcal{M}_{0}$ 的基础上增加了一项关于基线感染对数优势比的研究水平元回归。两种模型均使用马尔可夫链蒙特卡洛（MCMC）方法进行拟合，并获得了以下后验摘要统计量：\n\n- 对于模型 $\\mathcal{M}_{0}$：后验平均偏差 $\\bar{D}_{0} = 532.88$，有效参数个数 $p_{D,0} = 13.76$。\n- 对于模型 $\\mathcal{M}_{1}$：后验平均偏差 $\\bar{D}_{1} = 522.11$，有效参数个数 $p_{D,1} = 14.79$。\n\n请使用分层贝叶斯模型评估的信息论框架以及偏差信息准则（DIC）的标准定义，计算每个模型的 DIC，并报告其差值\n$$\n\\Delta \\mathrm{DIC} = \\mathrm{DIC}(\\mathcal{M}_{0}) - \\mathrm{DIC}(\\mathcal{M}_{1}).\n$$\n将您最终报告的 $\\Delta \\mathrm{DIC}$ 值四舍五入到四位有效数字。然后，根据拟合优度与复杂性之间的权衡，论证应选择哪个模型。", "solution": "该问题是有效的，因为它在科学上基于贝叶斯统计理论，问题阐述清晰，提供了足够的信息以获得唯一解，并且以客观、明确的语言呈现。\n\n偏差信息准则（DIC）是赤池信息准则（AIC）在分层建模中的推广。它作为贝叶斯模型比较的一种度量，用以平衡模型的拟合优度与复杂性。DIC的标准定义由后验平均偏差 $\\bar{D}$ 和有效参数个数 $p_D$ 之和给出。后验平均偏差 $\\bar{D} = E_{\\boldsymbol{\\theta}|\\mathbf{y}}[D(\\boldsymbol{\\theta})]$，衡量了在参数 $\\boldsymbol{\\theta}$ 的后验分布上，模型对数据的平均拟合优度。有效参数个数 $p_D = \\bar{D} - D(\\bar{\\boldsymbol{\\theta}})$，其中 $\\bar{\\boldsymbol{\\theta}}$ 是 $\\boldsymbol{\\theta}$ 的后验均值，它作为对模型复杂性的惩罚项。\n\nDIC 的计算公式为：\n$$\n\\mathrm{DIC} = \\bar{D} + p_D\n$$\n较低的 DIC 值表示一个更简约的模型，它在拟合优度与复杂性之间达到了更好的权衡。\n\n我们已知两个竞争模型 $\\mathcal{M}_{0}$ 和 $\\mathcal{M}_{1}$ 所需的后验摘要统计量。\n\n对于模型 $\\mathcal{M}_{0}$：\n后验平均偏差为 $\\bar{D}_{0} = 532.88$。\n有效参数个数为 $p_{D,0} = 13.76$。\n模型 $\\mathcal{M}_{0}$ 的 DIC 计算如下：\n$$\n\\mathrm{DIC}(\\mathcal{M}_{0}) = \\bar{D}_{0} + p_{D,0} = 532.88 + 13.76 = 546.64\n$$\n\n对于模型 $\\mathcal{M}_{1}$：\n后验平均偏差为 $\\bar{D}_{1} = 522.11$。\n有效参数个数为 $p_{D,1} = 14.79$。\n模型 $\\mathcal{M}_{1}$ 的 DIC 计算如下：\n$$\n\\mathrm{DIC}(\\mathcal{M}_{1}) = \\bar{D}_{1} + p_{D,1} = 522.11 + 14.79 = 536.90\n$$\n\n问题要求计算差值 $\\Delta \\mathrm{DIC} = \\mathrm{DIC}(\\mathcal{M}_{0}) - \\mathrm{DIC}(\\mathcal{M}_{1})$。\n$$\n\\Delta \\mathrm{DIC} = 546.64 - 536.90 = 9.74\n$$\n问题规定该值必须四舍五入到四位有效数字。计算出的值 $9.74$ 有三位有效数字。为了用四位有效数字表示，我们在后面补一个零。\n$$\n\\Delta \\mathrm{DIC} \\approx 9.740\n$$\n\n为了论证应选择哪个模型，我们比较它们的 DIC 值。模型 $\\mathcal{M}_{1}$ 的 DIC 为 $536.90$，低于模型 $\\mathcal{M}_{0}$ 的 DIC ($546.64$)。正的差值 $\\Delta \\mathrm{DIC} \\approx 9.740$ 表明模型 $\\mathcal{M}_{1}$ 优于模型 $\\mathcal{M}_{0}$。\n\n用于解释 $\\Delta \\mathrm{DIC}$ 大小的一个常用经验法则是，差值大于 $5$ 为 DIC 较低的模型提供了坚实的支持，差值大于 $10$ 则提供了非常强的支持。$9.740$ 这个值表明有坚实的证据支持模型 $\\mathcal{M}_{1}$。\n\n让我们来分析这种权衡。模型 $\\mathcal{M}_{1}$ 对数据显示出更好的拟合优度，其较低的后验平均偏差 ($\\bar{D}_{1} = 522.11$，而 $\\bar{D}_{0} = 532.88$) 表明了这一点。拟合优度的提升为 $\\bar{D}_{0} - \\bar{D}_{1} = 10.77$。这种拟合优度的提升是以增加模型复杂性为代价的，因为模型 $\\mathcal{M}_{1}$ 具有更多的有效参数个数 ($p_{D,1} = 14.79$，而 $p_{D,0} = 13.76$)。复杂性的增加量为 $p_{D,1} - p_{D,0} = 1.03$。DIC 的显著降低表明，模型拟合优度的显著提升 ($10.77$) 远超其模型复杂性的适度增加 ($1.03$) 所带来的影响。因此，模型 $\\mathcal{M}_{1}$，即包含了关于基线感染对数优势比的研究水平元回归的模型，是更优选的模型。", "answer": "$$\n\\boxed{9.740}\n$$", "id": "4551832"}]}