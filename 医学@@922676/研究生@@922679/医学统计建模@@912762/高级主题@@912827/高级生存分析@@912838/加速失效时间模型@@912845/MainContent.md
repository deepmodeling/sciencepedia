## 引言
在生存分析领域，用于评估协变量对事件发生时间影响的[统计模型](@entry_id:755400)至关重要。尽管比例风险（PH）模型因其广泛应用而占据主导地位，但其核心的“风险比”概念在某些情境下可能不够直观。加速失效时间（AFT）模型为此提供了一个强大且解释性更强的替代方案。AFT模型不关注瞬时风险，而是直接对事件时间本身进行建模，假设协变量的作用是“加速”或“减速”整个事件发生的时间尺度。这引出了“时间比”这一极具吸[引力](@entry_id:189550)的概念，能够直接回答“一项干预能将生存时间延长多少倍？”这类临床问题，从而填补了PH模型在解释上的一个空白。本文将系统地引导读者全面掌握AFT模型。在“原理与机制”一章中，我们将深入剖析其数学构造、参数解释，并将其与PH模型进行严格对比。接着，“应用与交叉学科联系”一章将通过在医学、工程学、因果推断等多个领域的实例，展示AFT模型的灵活性与实际价值。最后，“动手实践”部分将提供具体的练习，帮助读者将理论知识转化为解决实际问题的能力。

## 原理与机制

在生存分析领域，加速失效时间（Accelerated Failure Time, AFT）模型提供了一个强大且直观的框架，用于理解协变量如何影响事件发生时间。与关注瞬时风险（风险率）的[比例风险](@entry_id:166780)（Proportional Hazards, PH）模型不同，AFT模型直接对事件时间本身进行建模，假设协变量通过一个乘法因子来“加速”或“减速”事件发生的过程。本章将深入探讨AFT模型的数学原理、核心机制及其与PH模型的区别与联系。

### AFT模型的核心结构与解释

AFT模型的核心思想是，一个体的事件时间 $T$ 与一个基准事件时间 $T_0$ 之间存在一个简单的尺度关系，这个尺度关系由协变量向量 $\mathbf{x}$ 决定。该关系最常通过对数[线性模型](@entry_id:178302)来表达。具体而言，事件时间的自然对数被建模为协变量的线性函数加上一个误差项：

$$
\log(T) = \mathbf{x}^\top\beta + \sigma W
$$

其中，$\mathbf{x}$ 是一个 $p$ 维的协变量向量，$\beta$ 是相应的[回归系数](@entry_id:634860)向量，$\sigma > 0$ 是一个[尺度参数](@entry_id:268705)，而 $W$ 是一个与协变量 $\mathbf{x}$ 无关的、具有特定概率分布的[随机误差](@entry_id:144890)项。为了方便解释，我们经常包含一个截距项，此时模型写作 $\log(T) = \mu + \mathbf{x}^\top\gamma + \sigma W$。

为了揭示该模型的内在机制，我们可以对上式进行指数化处理：

$$
T = \exp(\mathbf{x}^\top\beta + \sigma W) = \exp(\mathbf{x}^\top\beta) \exp(\sigma W)
$$

现在，我们定义一个基准事件时间 $T_0$，它对应于协变量向量 $\mathbf{x} = \mathbf{0}$ 的情况。此时，$T_0 = \exp(\sigma W)$。因此，对于任意给定的协变量 $\mathbf{x}$，事件时间 $T$ 与基准事件时间 $T_0$ 的关系可以被优美地表示为：

$$
T(\mathbf{x}) = \exp(\mathbf{x}^\top\beta) T_0
$$

这里的乘数 $\psi(\mathbf{x}) = \exp(\mathbf{x}^\top\beta)$ 被称为**加速因子**（acceleration factor）。这个因子量化了协变量对事件时间尺度的直接影响。如果 $\psi(\mathbf{x}) > 1$，则事件时间被“拉伸”，意味着事件发生得更晚（生存期延长）；如果 $0  \psi(\mathbf{x})  1$，则事件时间被“压缩”，意味着事件发生得更早（生存期缩短）。

这种直接的[时间尺度变换](@entry_id:190118)是AFT模型最具吸[引力](@entry_id:189550)的特性之一，因为它提供了对回归系数 $\beta$ 的直观解释。考虑一个单一协变量 $x_j$ 增加一个单位，而其他协变量保持不变。新的事件时间 $T'$ 与原事件时间 $T$ 的关系为：

$$
\frac{T'}{T} = \frac{\exp((x_j+1)\beta_j + \sum_{k \neq j} x_k \beta_k) T_0}{\exp(x_j\beta_j + \sum_{k \neq j} x_k \beta_k) T_0} = \exp(\beta_j)
$$

这个结果 $\exp(\beta_j)$ 是一个**时间比**（time ratio）。它表明，协变量 $x_j$ 每增加一个单位，事件时间（包括[中位生存时间](@entry_id:634182)和其他所有分位数）将被乘以一个固定的因子 $\exp(\beta_j)$ [@4772649]。例如，在一个临床试验中，如果治疗组的指标变量 $x_j=1$（[对照组](@entry_id:188599)为0），且估计的 $\exp(\beta_j) = 1.5$，这意味着接受治疗的患者，其[中位生存时间](@entry_id:634182)（以及任何其他分位数的生存时间）预计是[对照组](@entry_id:188599)的1.5倍，即生存时间延长了50%。这种解释对于临床医生和患者来说，通常比风险率的变化更为直观和易于理解 [@4949797]。

### 对生存函数、[风险函数](@entry_id:166593)和[分位数函数](@entry_id:271351)的影响

AFT模型的[时间尺度变换](@entry_id:190118)特性对其相关的生存分析函数（[分位数函数](@entry_id:271351)、生存函数和[风险函数](@entry_id:166593)）产生了系统的影响 [@5228296]。

#### [分位数函数](@entry_id:271351)

[分位数函数](@entry_id:271351) $Q_x(p)$ 定义为满足 $\mathbb{P}(T(\mathbf{x}) \le Q_x(p)) = p$ 的时间点，其中 $p \in (0,1)$。利用 $T(\mathbf{x}) = \psi(\mathbf{x}) T_0$ 的关系，我们可以得到：

$$
\mathbb{P}(\psi(\mathbf{x}) T_0 \le Q_x(p)) = \mathbb{P}\left(T_0 \le \frac{Q_x(p)}{\psi(\mathbf{x})}\right) = p
$$

根据基准[分位数函数](@entry_id:271351) $Q_0(p)$ 的定义，$\mathbb{P}(T_0 \le Q_0(p)) = p$，我们必然得出：

$$
Q_x(p) = \psi(\mathbf{x}) Q_0(p) = \exp(\mathbf{x}^\top\beta) Q_0(p)
$$

这再次证实了AFT模型的核心解释：协变量通过一个恒定的加速因子 $\psi(\mathbf{x})$ 来缩放整个事件时间分布的所有分位数。

#### 生存函数

生存函数 $S(t|\mathbf{x}) = \mathbb{P}(T(\mathbf{x}) > t)$ 也直接受到[时间尺度变换](@entry_id:190118)的影响。

$$
S(t|\mathbf{x}) = \mathbb{P}(\psi(\mathbf{x}) T_0 > t) = \mathbb{P}\left(T_0 > \frac{t}{\psi(\mathbf{x})}\right) = S_0\left(\frac{t}{\psi(\mathbf{x})}\right)
$$

其中 $S_0(t)$ 是基准生存函数。这个关系式表明，协变量 $\mathbf{x}$ 的效应是**水平地**拉伸或压缩生存曲线，而不是垂直地移动它。

#### 风险函数

风险函数 $h(t|\mathbf{x}) = f(t|\mathbf{x}) / S(t|\mathbf{x})$ 的变换则更为复杂。首先，我们导出密度函数 $f(t|\mathbf{x})$：

$$
f(t|\mathbf{x}) = -\frac{d}{dt}S(t|\mathbf{x}) = -\frac{d}{dt}S_0\left(\frac{t}{\psi(\mathbf{x})}\right) = f_0\left(\frac{t}{\psi(\mathbf{x})}\right) \cdot \frac{1}{\psi(\mathbf{x})}
$$

其中 $f_0(t)$ 是基准密度函数。因此，[风险函数](@entry_id:166593)为：

$$
h(t|\mathbf{x}) = \frac{f_0\left(t/\psi(\mathbf{x})\right) \cdot (1/\psi(\mathbf{x}))}{S_0\left(t/\psi(\mathbf{x})\right)} = \frac{1}{\psi(\mathbf{x})} h_0\left(\frac{t}{\psi(\mathbf{x})}\right)
$$

其中 $h_0(t)$ 是基准[风险函数](@entry_id:166593)。这个表达式至关重要，因为它揭示了AFT模型和PH模型之间的根本区别。在AFT模型中，协变量不仅将[风险函数](@entry_id:166593)的值乘以一个因子（$1/\psi(\mathbf{x})$），还同时对时间轴进行了缩放（$t/\psi(\mathbf{x})$）。除非在非常特殊的情况下，否则这不会导致风险比（hazard ratio）恒定 [@4949786]。

### 常见的[参数化](@entry_id:265163)AFT模型

AFT模型是一个半[参数化](@entry_id:265163)框架，但通过为误差项 $W$ 指定一个特定的参数分布，我们可以得到全[参数化](@entry_id:265163)的模型。不同的误差分布选择对应于不同的生存时间分布。以下是三种最常见的[参数化](@entry_id:265163)AFT模型 [@4949771]。

1.  **对数-正态 (Log-normal) AFT 模型**:
    当误差项 $W$ 服从标准正态分布 $N(0,1)$ 时，$\log(T) = \mathbf{x}^\top\beta + \sigma W$ 服从均值为 $\mu(\mathbf{x}) = \mathbf{x}^\top\beta$、标准差为 $\sigma$ 的正态分布。因此，事件时间 $T$ 服从对数-正态分布。其参数为：
    -   对数均值: $\mu(\mathbf{x}) = \mathbf{x}^\top\beta$
    -   对数标准差: $\sigma$ (常数)
    其密度函数为 $f(t|\mathbf{x}) = \frac{1}{t\sigma\sqrt{2\pi}} \exp\left\{-\frac{(\ln t - \mu(\mathbf{x}))^2}{2\sigma^2}\right\}$。

2.  **威布尔 (Weibull) AFT 模型**:
    当误差项 $W$ 服从标准最小[极值分布](@entry_id:174061)（[Gumbel分布](@entry_id:268317)）时，事件时间 $T$ 服从[威布尔分布](@entry_id:270143)。[威布尔分布](@entry_id:270143)的常规参数（形状 $p$ 和尺度 $\lambda$）与AFT模型的参数关系如下：
    -   [形状参数](@entry_id:270600): $p = 1/\sigma$ (常数)
    -   [尺度参数](@entry_id:268705): $\lambda(\mathbf{x}) = \exp(\mathbf{x}^\top\beta)$
    其生存函数为 $S(t|\mathbf{x}) = \exp\left\{-\left(\frac{t}{\lambda(\mathbf{x})}\right)^p\right\}$，[风险函数](@entry_id:166593)为 $h(t|\mathbf{x}) = \frac{p}{\lambda(\mathbf{x})} \left(\frac{t}{\lambda(\mathbf{x})}\right)^{p-1}$。

3.  **对数-逻辑 (Log-logistic) AFT 模型**:
    当误差项 $W$ 服从[标准逻辑](@entry_id:178384)分布时，事件时间 $T$ 服从对数-逻辑分布。其参数映射为：
    -   [形状参数](@entry_id:270600): $p = 1/\sigma$ (常数)
    -   [尺度参数](@entry_id:268705): $\lambda(\mathbf{x}) = \exp(\mathbf{x}^\top\beta)$
    其生存函数为 $S(t|\mathbf{x}) = \left[1 + \left(\frac{t}{\lambda(\mathbf{x})}\right)^p\right]^{-1}$，[风险函数](@entry_id:166593)为 $h(t|\mathbf{x}) = \frac{(p/\lambda(\mathbf{x}))(t/\lambda(\mathbf{x}))^{p-1}}{1+(t/\lambda(\mathbf{x}))^p}$。

### AFT模型与[比例风险模型](@entry_id:171806)的比较分析

AFT模型和PH模型是生存分析中最重要的两类回归模型。理解它们的异同对于[模型选择](@entry_id:155601)和结果解释至关重要。

#### 解释性的差异

如前所述，两种模型回答了不同的临床问题 [@4949797]。
-   **AFT模型**的系数 $\exp(\beta_{\text{AFT}})$ 是一个**时间比**。它回答：“与[对照组](@entry_id:188599)相比，治疗将事件发生时间（如[中位生存时间](@entry_id:634182)）延长或缩短了多少倍？” 例如，$\exp(\beta_{\text{AFT}}) = 1.30$ 意味着治疗使事件时间延长了30%。
-   **PH模型**的系数 $\exp(\beta_{\text{PH}})$ 是一个**风险比**。它回答：“在任何给定的时间点，治疗组发生事件的瞬时风险是[对照组](@entry_id:188599)的多少倍？” 例如，$\exp(\beta_{\text{PH}}) = 0.75$ 意味着在任何时刻，治疗组的事件风险都比[对照组](@entry_id:188599)低25%。

风险比不直接等于时间比的倒数。这两者衡量的是效应的不同方面，为临床决策提供了互补的信息。

#### 结构关系：重叠与[分歧](@entry_id:193119)

尽管AFT和PH模型在概念上不同，但它们的模型类别存在交集，也存在各自独特的领域。

-   **重叠：[威布尔分布](@entry_id:270143)**
    [威布尔分布](@entry_id:270143)是一个特例，它同时满足AFT和PH模型的假设。一个威布尔AFT模型等价于一个威布尔PH模型。然而，两模型中的系数有不同的解释，并且它们之间存在一个确定的关系。具体来说，如果威布尔AFT模型的风险函数为 $h(t|\mathbf{x}) = p \lambda(\mathbf{x})^{-p} t^{p-1}$，其中 $p=1/\sigma$ 且 $\lambda(\mathbf{x}) = \exp(\mathbf{x}^\top\beta_{AFT})$，那么风险比为：
    $$
    \frac{h(t|\mathbf{x})}{h_0(t)} = \frac{p \exp(-\mathbf{x}^\top\beta_{AFT})^{-p} t^{p-1}}{p (1)^{-p} t^{p-1}} = \exp(-p \cdot \mathbf{x}^\top\beta_{AFT})
    $$
    这表明风险比是恒定的，因此满足PH假设，其对数风险比为 $\beta_{PH} = -p \cdot \beta_{AFT} = -(1/\sigma) \beta_{AFT}$ [@5228296]。

-   **[分歧](@entry_id:193119)：AFT模型通常意味着非[比例风险](@entry_id:166780)**
    除了[威布尔分布](@entry_id:270143)，大多数AFT模型都意味着非[比例风险](@entry_id:166780)。例如，在一个对数-逻辑AFT模型中，协变量$x_A$和$x_B$之间的风险比$HR(t)$是一个关于时间的函数，这意味着风险比随时间变化，从而违反了PH假设 [@4949786]。另一个例子是当基线分布为Gompertz分布的AFT模型，其风险比也是时间的函数，甚至可能出现**风险交叉**（crossing hazards）的现象，即一个组在早期风险更高，而在晚期风险更低 [@4949732]。

-   **分歧：PH模型通常意味着非加速失效时间**
    反之，一个满足PH假设的模型通常不满足AFT假设。诊断AFT假设是否成立的一个关键指标是时间比函数 $R(p) = t_1(p)/t_0(p)$ 是否为常数，其中 $t_g(p)$ 是组 $g$ 的第 $p$ 个生存分位数。可以构建一个严格满足PH假设的例子（例如，基线累积风险为 $H_0(t) = t+t^2$），但推导出的时间比函数 $R(p)$ 却明显依赖于 $p$，这证明了AFT假设在该情况下不成立 [@4949764]。

### 估计原理

[参数化](@entry_id:265163)AFT模型的参数（如 $\beta$ 和 $\sigma$）通常通过最大似然法进行估计。构建[似然函数](@entry_id:141927)需要处理生存数据中常见的删失（censoring）和截断（truncation）问题。

#### 独立非信息性删失假设

在构建[似然函数](@entry_id:141927)之前，我们必须依赖一个核心假设：**独立非信息性删失**（independent non-informative censoring）。这个假设包含两个部分 [@4949809]：
1.  **[条件独立性](@entry_id:262650)**：给定协变量 $\mathbf{x}$，真实事件时间 $T$ 与删失时间 $C$ 是相互独立的，即 $T \perp C \mid \mathbf{x}$。
2.  **参数无关性**：控制事件时间分布的参数（$\beta, \sigma$ 等）与控制删失时间分布的参数是相互独立且没有共同参数的。

这个假设至关重要，因为它允许我们将观测数据的[联合似然](@entry_id:750952)[函数分解](@entry_id:197881)为事件时间部分和删失时间部分。由于我们只关心事件时间的参数，删失时间部分的似然可以在最大化过程中被忽略，从而得到一致的[参数估计](@entry_id:139349)。值得注意的是，这个核心假设**无法仅从观测数据 $(Y, \Delta, \mathbf{x})$ 中得到经验性检验**，因为我们永远无法同时观测到同一个体的真实事件时间 $T$ 和删失时间 $C$。因此，该假设的合理性必须基于对研究设计和数据收集过程的理解。

#### 删失与[截断数据](@entry_id:163004)的似然函数

在独立非信息性删失的假设下，我们可以为不同类型的观测数据写出似然贡献 [@4949750]：
-   **精确事件**：在时间 $t$ 观测到事件。其似然贡献是该时间点的概率密度函数 $f(t|\mathbf{x})$。
-   **右删失**：在时间 $c$ 之后失去随访，只知道事件发生在 $c$ 之后 ($T > c$)。其似然贡献是生存到时间 $c$ 之后的概率，即生存函数 $S(c|\mathbf{x})$ [@4949766]。
-   **[左删失](@entry_id:169731)**：只知道事件在时间 $c$ 之前发生 ($T \le c$)。其似然贡献是累积分布函数 $F(c|\mathbf{x})$。
-   **[区间删失](@entry_id:636589)**：只知道事件发生在区间 $(\ell, r]$ 内。其似然贡献是 $\mathbb{P}(\ell  T \le r) = F(r|\mathbf{x}) - F(\ell|\mathbf{x})$。

对于一个包含 $n$ 个独立个体的样本，总的[对数似然函数](@entry_id:168593)是所有个体[对数似然](@entry_id:273783)贡献的总和。对于最常见的右删失数据，[对数似然函数](@entry_id:168593)具有以下经典形式：
$$
\ell(\beta, \sigma) = \sum_{i=1}^n \left[ \Delta_i \ln(f(Y_i|\mathbf{x}_i; \beta, \sigma)) + (1-\Delta_i) \ln(S(Y_i|\mathbf{x}_i; \beta, \sigma)) \right]
$$
其中 $Y_i$ 是观测时间，$\Delta_i$ 是事件指示符（1=事件，0=删失）。

**截断**（Truncation）是另一种数据复杂性，它源于样本[选择偏差](@entry_id:172119)。例如，**左截断**（或延迟进入）发生在个体只有在存活超过某个时间点 $a$ 后才能被纳入研究。这要求所有似然贡献都以事件 $T > a$ 为条件。根据条件概率法则，这意味着每个个体的原始似然贡献都需要除以 $S(a|\mathbf{x})$。例如，一个在 $t > a$ 的精确事件，其似然贡献变为 $f(t|\mathbf{x}) / S(a|\mathbf{x})$。类似地，**右截断**发生在只有事件在某个时间点 $b$ 之前发生的个体才被观测到，此时所有似然贡献都需要除以 $F(b|\mathbf{x})$ [@4949750]。

通过最大化根据具体[数据结构](@entry_id:262134)（删失、截断）构建的[对数似然函数](@entry_id:168593)，我们便可以获得AFT模型参数的[最大似然估计值](@entry_id:165819)。