{"hands_on_practices": [{"introduction": "汇集化的CRISPR筛选是无偏见靶点发现的强大引擎，能够系统性地探究数千个基因的功能。然而，这类复杂实验的成功与否，关键在于精心的实验设计。此练习将挑战你像实验科学家一样思考，权衡两个关键参数——感染复数（MOI）和文库覆盖度，以确保在最小化偏倚的同时，获得足够的统计功效来识别真正的靶点基因[@problem_id:5066651]。", "problem": "一项混合CRISPR（Clustered Regularly Interspaced Short Palindromic Repeats，成簇的规律间隔的短回文重复序列）功能缺失性筛选旨在鉴定一个肿瘤细胞系中的必需基因。一个慢病毒单向导RNA (sgRNA) 文库包含 $L = 10^5$ 个不同的sgRNA，靶向推定的必需基因和非必需基因。细胞被感染，然后经过抗生素筛选、传代和活性读数检测。假设以下基本前提：(i) 病毒进入细胞的事件是独立发生的，并可以建模为泊松过程；(ii) 抗生素筛选会去除没有发生功能性整合的细胞；(iii) 筛选过程中最窄的群体瓶颈决定了有多少个独特的sgRNA能有效地为下游的下一代测序 (NGS) 计数贡献信号。将感染复数 (MOI) 定义为感染过程的一个特性，并将文库覆盖度定义为文库在细胞群体中代表性的一个特性。\n\n设计目标是在最小化来自多向导细胞的偏倚和代表性丢失的同时，最大化检测靶向必需基因的sgRNA耗尽的统计功效。一个团队考虑以MOI $m = 0.3$进行感染，并估计筛选后瓶颈（例如，药物筛选、传代、取样）的综合效应会将存活的、可分析的细胞数量减少到初始铺板群体数量的一小部分，比例为 $f = 0.5$。他们要求在最窄的瓶颈处，每个sgRNA的最终最小覆盖度为 $C_{\\min} = 500$ 个细胞。\n\n哪个单一选项正确地定义了混合CRISPR筛选中的MOI和文库覆盖度，正确地推断了MOI和覆盖度对鉴定必需靶点的统计功效和偏倚的影响，并正确地计算了上述假设所隐含的关键量？\n\nA. MOI是在泊松感染模型下每个细胞的平均病毒整合数，文库覆盖度是在最窄瓶颈处仍然对表型有贡献的每个sgRNA对应的平均细胞数。在MOI $m = 0.3$ 时，所有细胞中恰好有一次整合的细胞比例约为 $m e^{-m} \\approx 0.22$，而在受感染的细胞中，有多次整合的细胞比例约为 $\\dfrac{1 - e^{-m}(1+m)}{1 - e^{-m}} \\approx 0.14$。降低MOI会减少多sgRNA偏倚，但会增加未感染细胞的比例，这必须通过使用更高的初始细胞数来抵消，以维持覆盖度。为确保在 $L = 10^5$ 和 $f = 0.5$ 的条件下达到 $C_{\\min} = 500$，最小初始群体数量为 $N_0 \\ge \\dfrac{L \\, C_{\\min}}{(1 - e^{-m}) \\, f} \\approx 3.9 \\times 10^8$ 个细胞。更高的覆盖度会降低取样方差，并提高检测sgRNA耗尽的统计功效。\n\nB. MOI是受感染细胞的比例，文库覆盖度是每个sgRNA的NGS读数数量。在MOI $m = 0.3$ 时，恰好有 $30\\%$ 的细胞被感染，因此多次感染可以忽略不计。更高的MOI总是能提高统计功效，而不会引入偏倚，因为有更多的细胞携带sgRNA。达到 $C_{\\min} = 500$ 所需的最小初始细胞数为 $N_0 \\ge L \\, C_{\\min} \\, f \\approx 2.5 \\times 10^7$ 个细胞。\n\nC. MOI是每个细胞的平均病毒整合数，覆盖度是筛选后每个sgRNA对应的受感染细胞数。在MOI $m = 0.3$ 时，受感染细胞中具有多次整合的细胞比例约为 $1 - e^{-m}(1+m) \\approx 0.037$，这个数值小到可以忽略。为达到 $C_{\\min} = 500$，我们需要 $N_0 \\ge \\dfrac{L \\, C_{\\min}}{f} \\approx 1.0 \\times 10^8$ 个细胞，因为只有筛选后的瓶颈对覆盖度有影响。增加覆盖度会降低检测强效应的统计功效，因为更多的细胞会稀释表型。\n\nD. MOI是每个细胞加入的病毒颗粒数，覆盖度是文库克隆过程中每个sgRNA的质粒菌落数。MOI $m = 2$ 可确保几乎每个细胞都至少获得一个sgRNA，从而最小化偏倚。多次感染可以建模为概率为 $p = m/(1+m)$ 的二项过程，因此多次感染率为 $p^2$。对于 $L = 10^5$ 和 $C_{\\min} = 500$，所需的初始细胞数为 $N_0 \\ge L \\, C_{\\min} = 5 \\times 10^7$，这与筛选损失无关，因为筛选只去除未感染的细胞。", "solution": "用户希望我验证并解决一个关于混合CRISPR筛选实验设计的问题。\n\n### 第1步：提取已知条件\n- 实验类型：混合成簇的规律间隔的短回文重复序列 (CRISPR) 功能缺失性筛选。\n- 目标：在一个肿瘤细胞系中鉴定必需基因。\n- 文库大小：$L = 10^5$ 个不同的单向导RNA (sgRNA)。\n- 过程模型：\n    - (i) 病毒进入是一个泊松过程。\n    - (ii) 抗生素筛选去除功能性整合数为零的细胞。\n    - (iii) 最窄的群体瓶颈决定了有效的sgRNA代表性。\n- 待定义术语：感染复数 (MOI) 和文库覆盖度。\n- 设计参数：\n    - 建议的MOI：$m = 0.3$。\n    - 筛选后存活比例：$f = 0.5$ (相对于初始铺板群体)。\n    - 要求的最终最小覆盖度：每个sgRNA $C_{\\min} = 500$ 个细胞。\n\n### 第2步：使用提取的已知条件进行验证\n题目陈述描述了功能基因组学中的一个标准场景。\n- 科学依据：整个前提基于执行和分析混合CRISPR筛选的既定标准程序。慢病毒文库的使用、MOI的概念、感染的泊松模型、抗生素筛选、群体瓶颈，以及多次感染偏倚与筛选覆盖度之间的权衡，都是该领域基本且正确的原则。数值（$L = 10^5$, $m = 0.3$, $C_{\\min} = 500$）对于现代筛选而言非常现实。该问题属于*转化医学*领域内*使用遗传学和功能基因组学方法进行靶点鉴定*的指定主题。\n- 问题适定：该问题提供了定义术语、执行计算和评估选项中逻辑陈述所需的所有数据和假设。问题是明确的。\n- 客观性：语言是技术性的，没有主观或基于意见的声明。\n\n### 第3步：结论与行动\n问题有效。它在科学上是合理的，问题适定且客观。我将继续推导解决方案并评估各个选项。\n\n### 原理和计算的推导\n\n**1. 定义和泊松模型**\n- **感染复数 (MOI)：**在建模为泊松过程的混合病毒文库感染的背景下，MOI（用 $m$ 表示）是该分布的均值。它代表每个细胞的平均功能性病毒整合数。它是控制sgRNA在细胞中分布的关键参数。\n- **文库覆盖度：**在此背景下，文库覆盖度指的是包含特定sgRNA并存活至实验最窄群体瓶颈的平均细胞数。这个瓶颈决定了筛选的统计功效，因为它设定了每个sgRNA的取样深度。\n- **泊松分布：**一个给定细胞接收到恰好 $k$ 次功能性病毒整合的概率 $P(k)$ 由泊松公式给出：\n$$P(k) = \\frac{e^{-m} m^k}{k!}$$\n给定 $m = 0.3$：\n- 未感染细胞的比例 ($k=0$)：$P(0) = \\frac{e^{-0.3} (0.3)^0}{0!} = e^{-0.3} \\approx 0.7408$。这些细胞会被抗生素筛选去除。\n- 单次整合细胞的比例 ($k=1$)：$P(1) = \\frac{e^{-0.3} (0.3)^1}{1!} = 0.3 e^{-0.3} \\approx 0.3 \\times 0.7408 \\approx 0.2222$。这是实现明确的表型-基因型关联所期望的群体。\n- 多次整合细胞的比例 ($k \\ge 2$)：$P(k \\ge 2) = 1 - P(0) - P(1) = 1 - e^{-0.3} - 0.3 e^{-0.3} = 1 - e^{-0.3}(1+0.3) \\approx 1 - 0.7408 \\times 1.3 \\approx 1 - 0.96304 = 0.03696$。\n\n**2. 偏倚、统计功效和MOI的权衡**\n- **偏倚：**多向导细胞（即 $k \\ge 2$ 次整合的细胞）是偏倚的一个来源。如果一个含有两个sgRNA的细胞死亡，无法确定是哪个sgRNA导致了致死表型。选择低的MOI是为了最小化这类细胞的比例。\n- **受感染细胞中的多次感染率：**在*所有*细胞中被感染的比例是 $P(k \\ge 1) = 1 - P(0) = 1 - e^{-m}$。在*受感染*的细胞中，含有多个向导RNA的比例是一个条件概率：\n$$P(k \\ge 2 | k \\ge 1) = \\frac{P(k \\ge 2 \\cap k \\ge 1)}{P(k \\ge 1)} = \\frac{P(k \\ge 2)}{P(k \\ge 1)} = \\frac{1 - e^{-m}(1+m)}{1 - e^{-m}}$$\n对于 $m=0.3$:\n$$P(k \\ge 2 | k \\ge 1) \\approx \\frac{0.03696}{1 - 0.7408} = \\frac{0.03696}{0.2592} \\approx 0.1426$$\n因此，大约有 $14.3\\%$ 在抗生素筛选中存活下来的细胞会含有多个sgRNA。\n- **统计功效：**检测基因必需性（相应sgRNA的耗尽）的统计功效取决于从取样噪声中区分出真实信号的能力。更高的文库覆盖度 ($C$) 会降低sgRNA计数的方差，从而提高统计功效。降低MOI需要以更多的初始细胞开始，以获得相同数量的*受感染*细胞，从而维持覆盖度。\n\n**3. 初始细胞数 ($N_0$) 的计算**\n- 独特的sgRNA总数为 $L = 10^5$。\n- 瓶颈处的最小覆盖度要求为每个sgRNA $C_{\\min} = 500$ 个细胞。\n- 最窄瓶颈处所需的总细胞数为 $N_{\\text{bottleneck}} = L \\times C_{\\min} = 10^5 \\times 500 = 5 \\times 10^7$ 个细胞。\n- 这个瓶颈群体是从初始群体 $N_0$ 开始经历一系列损失事件的结果。\n- 首先，一部分比例为 $(1 - e^{-m})$ 的细胞被成功感染并在抗生素筛选中存活。群体数量变为 $N_0 (1 - e^{-m})$。\n- 其次，其他过程（传代等）导致进一步的细胞损失，由存活比例 $f = 0.5$ 表示。选项A的题目陈述提出了一个序贯损失模型，这是最严谨的解释：瓶颈处的群体数量为 $N_0 \\times (1-e^{-m}) \\times f$。\n- 我们必须满足条件：$N_{\\text{bottleneck}} \\le N_0 (1-e^{-m}) f$。\n- 为了找到最小初始群体数量，我们将其设为等式并解出 $N_0$：\n$$N_0 = \\frac{N_{\\text{bottleneck}}}{(1-e^{-m})f} = \\frac{L C_{\\min}}{(1-e^{-m})f}$$\n- 代入数值：\n$$N_0 = \\frac{5 \\times 10^7}{(1 - e^{-0.3}) \\times 0.5} \\approx \\frac{5 \\times 10^7}{0.2592 \\times 0.5} = \\frac{5 \\times 10^7}{0.1296} \\approx 3.858 \\times 10^8$$\n这大约是 $3.9 \\times 10^8$ 个细胞。\n\n### 逐项分析\n\n**A. MOI是在泊松感染模型下每个细胞的平均病毒整合数，文库覆盖度是在最窄瓶颈处仍然对表型有贡献的每个sgRNA对应的平均细胞数。在MOI $m = 0.3$ 时，所有细胞中恰好有一次整合的细胞比例约为 $m e^{-m} \\approx 0.22$，而在受感染的细胞中，有多次整合的细胞比例约为 $\\dfrac{1 - e^{-m}(1+m)}{1 - e^{-m}} \\approx 0.14$。降低MOI会减少多sgRNA偏倚，但会增加未感染细胞的比例，这必须通过使用更高的初始细胞数来抵消，以维持覆盖度。为确保在 $L = 10^5$ 和 $f = 0.5$ 的条件下达到 $C_{\\min} = 500$，最小初始群体数量为 $N_0 \\ge \\dfrac{L \\, C_{\\min}}{(1 - e^{-m}) \\, f} \\approx 3.9 \\times 10^8$ 个细胞。更高的覆盖度会降低取样方差，并提高检测sgRNA耗尽的统计功效。**\n- MOI和覆盖度的定义正确且精确。\n- 单次整合细胞比例的计算 ($P(1) = 0.3e^{-0.3} \\approx 0.22$) 是正确的。\n- *受感染*细胞中多次整合比例的计算 ($P(k \\ge 2 | k \\ge 1) \\approx 0.14$) 是正确的。\n- 关于MOI权衡（偏倚 vs. 细胞数）的推理是正确的。\n- 初始细胞数 $N_0$ 的公式基于一个合理的序贯损失模型，是正确的，并且计算得出的值（$\\approx 3.9 \\times 10^8$）是正确的。\n- 关于覆盖度、取样方差和统计功效的最终陈述是正确的。\n- **结论：正确。**\n\n**B. MOI是受感染细胞的比例，文库覆盖度是每个sgRNA的NGS读数数量。在MOI $m = 0.3$ 时，恰好有 $30\\%$ 的细胞被感染，因此多次感染可以忽略不计。更高的MOI总是能提高统计功效，而不会引入偏倚，因为有更多的细胞携带sgRNA。达到 $C_{\\min} = 500$ 所需的最小初始细胞数为 $N_0 \\ge L \\, C_{\\min} \\, f \\approx 2.5 \\times 10^7$ 个细胞。**\n- MOI的定义不正确。受感染细胞的比例是 $1 - e^{-m}$。\n- 覆盖度的定义不精确；覆盖度指的是细胞，而不是读数，尽管它们相关。\n- 声称在 $m=0.3$ 时有 $30\\%$ 的细胞被感染是不正确的。实际比例是 $1 - e^{-0.3} \\approx 26\\%$。\n- 关于更高MOI不引入偏倚的说法是根本错误的；它是偏倚的一个主要来源。\n- $N_0$ 的计算基于一个错误的公式，该公式忽略了未感染细胞的比例。\n- **结论：不正确。**\n\n**C. MOI是每个细胞的平均病毒整合数，覆盖度是筛选后每个sgRNA对应的受感染细胞数。在MOI $m = 0.3$ 时，受感染细胞中具有多次整合的细胞比例约为 $1 - e^{-m}(1+m) \\approx 0.037$，这个数值小到可以忽略。为达到 $C_{\\min} = 500$，我们需要 $N_0 \\ge \\dfrac{L \\, C_{\\min}}{f} \\approx 1.0 \\times 10^8$ 个细胞，因为只有筛选后的瓶颈对覆盖度有影响。增加覆盖度会降低检测强效应的统计功效，因为更多的细胞会稀释表型。**\n- MOI的定义是正确的。覆盖度的定义可以接受，但不如选项A中的精确。\n- 对多次整合比例的描述不正确。公式 $1 - e^{-m}(1+m)$ 给出的是相对于*所有*细胞的比例，而不是*受感染*细胞。值 $0.037$ 是占所有细胞的比例，而在受感染细胞中的比例要高得多（$\\approx 0.14$）。\n- 关于增加覆盖度会*降低*统计功效的说法是根本错误的。事实恰恰相反。\n- $N_0$ 的公式不正确，因为它没有考虑因未感染而损失的细胞（$1 - e^{-m}$ 因子）。\n- **结论：不正确。**\n\n**D. MOI是每个细胞加入的病毒颗粒数，覆盖度是文库克隆过程中每个sgRNA的质粒菌落数。MOI $m = 2$ 可确保几乎每个细胞都至少获得一个sgRNA，从而最小化偏倚。多次感染可以建模为概率为 $p = m/(1+m)$ 的二项过程，因此多次感染率为 $p^2$。对于 $L = 10^5$ 和 $C_{\\min} = 500$，所需的初始细胞数为 $N_0 \\ge L \\, C_{\\min} = 5 \\times 10^7$，这与筛选损失无关，因为筛选只去除未感染的细胞。**\n- MOI的定义不精确（加入的颗粒数 vs. 功能性整合数）。\n- 覆盖度的定义完全错误，将筛选覆盖度与克隆质量控制混淆。\n- 声称像 $m=2$ 这样的高MOI会*最小化偏倚*与事实恰恰相反；它会最大化多次感染偏倚。\n- 将过程建模为二项过程的建议是不正确的；问题明确指定了泊松过程。\n- $N_0$ 的计算是错误的；它计算的是瓶颈处的细胞数（$N_{\\text{bottleneck}}$），而不是所需的初始数量，并且忽略了所有损失因子。\n- **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "5066651"}, {"introduction": "疾病的发生往往不是由单个基因的异常引起，而是源于复杂生物网络的功能失调。本练习将介绍一种强大的计算生物学方法——网络扩散算法[@problem_id:5066670]，它通过模拟信息在蛋白质相互作用网络（PPI）中的传播，系统性地识别出与已知疾病基因紧密相连的潜在新靶点。通过这个实践，你将学习如何将零散的遗传学线索整合成一张有序的靶点优先级列表，从而桥接从基因发现到靶点确证的关键一步。", "problem": "给定一个加权无向蛋白质-蛋白质相互作用网络，表示为图 $G = (V, E)$，其中包含 $|V| = n$ 个蛋白质（节点）。设加权邻接矩阵为 $A \\in \\mathbb{R}^{n \\times n}$，其中 $A_{ij} \\ge 0$ 表示蛋白质 $i$ 和蛋白质 $j$ 之间的相互作用强度，且对于所有 $i, j$，$A_{ij} = A_{ji}$。定义对角度矩阵 $D \\in \\mathbb{R}^{n \\times n}$，其元素为 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$。通过下式定义行归一化转移矩阵 $W \\in \\mathbb{R}^{n \\times n}$\n$$\nW = D^{-1} A,\n$$\n并约定如果 $D_{ii} = 0$，则 $W$ 的第 $i$ 行为零行。\n\n假设你有一个非负种子向量 $s \\in \\mathbb{R}^n$，代表与疾病相关的蛋白质的全基因组关联研究（GWAS）证据，其中对于GWAS所涉及的蛋白质，$s_i > 0$，否则 $s_i = 0$。考虑通过带重启参数 $\\lambda \\in (0, 1]$ 的随机游走进行的扩散，其由以下不动点方程定义\n$$\nf = \\lambda s + (1 - \\lambda) W f,\n$$\n其中 $f \\in \\mathbb{R}^n$ 是扩散得分向量。在给定的 $W$ 构建方式下，保证该方程对于 $\\lambda \\in (0,1]$ 有唯一解。\n\n你的任务是编写一个程序，对每个测试用例执行以下操作：\n1. 从 $A$ 和 $D$ 计算 $W$。\n2. 使用上述不动点方程求解扩散得分向量 $f$。\n3. 将满足 $s_i = 0$ 且 $f_i > \\epsilon$ 的节点 $i$ 识别为候选目标，其中 $\\epsilon$ 是一个设为 $10^{-12}$ 的微小数值容差。\n4. 按 $f_i$ 的降序对候选目标进行排序，若出现平局则按节点索引的升序排序。\n5. 返回排名前 $k$ 的候选目标（节点索引）。如果严格为正的扩散得分的候选者少于 $k$ 个，则返回所有此类候选者。如果种子向量 $s$ 完全为零，则返回空列表。\n\n假设所有量均为无量纲，不适用任何物理单位。\n\n缩写定义：全基因组关联研究（Genome-Wide Association Study, GWAS），蛋白质-蛋白质相互作用（Protein–Protein Interaction, PPI）。\n\n使用以下测试套件，每个测试用例由其邻接矩阵 $A$、种子向量 $s$、重启参数 $\\lambda$ 和整数 $k$ 定义。\n\n测试用例 1 (正常路径，中等连通度网络):\n$$\nA^{(1)} =\n\\begin{bmatrix}\n0  & 0.5  & 0  & 0  & 0  & 0  & 0.1 \\\\\n0.5  & 0  & 0.4  & 0  & 0.1  & 0  & 0 \\\\\n0  & 0.4  & 0  & 0.3  & 0  & 0.2  & 0 \\\\\n0  & 0  & 0.3  & 0  & 0.7  & 0  & 0 \\\\\n0  & 0.1  & 0  & 0.7  & 0  & 0.2  & 0 \\\\\n0  & 0  & 0.2  & 0  & 0.2  & 0  & 0.6 \\\\\n0.1  & 0  & 0  & 0  & 0  & 0.6  & 0 \\\\\n\\end{bmatrix}, \\quad\ns^{(1)} =\n\\begin{bmatrix}\n0 \\\\\n1.2 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n0.8 \\\\\n0 \\\\\n\\end{bmatrix}, \\quad\n\\lambda^{(1)} = 0.65, \\quad k^{(1)} = 3.\n$$\n\n测试用例 2 (边界情况，含孤立的种子节点):\n$$\nA^{(2)} =\n\\begin{bmatrix}\n0  & 1.0  & 0.3  & 0  & 0 \\\\\n1.0  & 0  & 0.5  & 0  & 0.2 \\\\\n0.3  & 0.5  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 0  & 0 \\\\\n0  & 0.2  & 0  & 0  & 0 \\\\\n\\end{bmatrix}, \\quad\ns^{(2)} =\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n1.0 \\\\\n0 \\\\\n\\end{bmatrix}, \\quad\n\\lambda^{(2)} = 0.85, \\quad k^{(2)} = 2.\n$$\n\n测试用例 3 (不连通分量，种子位于不同分量中):\n$$\nA^{(3)} =\n\\begin{bmatrix}\n0  & 0.9  & 0.4  & 0  & 0  & 0  & 0  & 0 \\\\\n0.9  & 0  & 0.9  & 0  & 0  & 0  & 0  & 0 \\\\\n0.4  & 0.9  & 0  & 0.9  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & 0.9  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 0  & 0  & 0.8  & 0.3  & 0 \\\\\n0  & 0  & 0  & 0  & 0.8  & 0  & 0.8  & 0 \\\\\n0  & 0  & 0  & 0  & 0.3  & 0.8  & 0  & 0.8 \\\\\n0  & 0  & 0  & 0  & 0  & 0  & 0.8  & 0 \\\\\n\\end{bmatrix}, \\quad\ns^{(3)} =\n\\begin{bmatrix}\n0 \\\\\n1.0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n1.1 \\\\\n0 \\\\\n\\end{bmatrix}, \\quad\n\\lambda^{(3)} = 0.7, \\quad k^{(3)} = 3.\n$$\n\n测试用例 4 (边缘情况，无种子):\n$$\nA^{(4)} =\n\\begin{bmatrix}\n0  & 0.5  & 0  & 0.5 \\\\\n0.5  & 0  & 0.5  & 0 \\\\\n0  & 0.5  & 0  & 0.5 \\\\\n0.5  & 0  & 0.5  & 0 \\\\\n\\end{bmatrix}, \\quad\ns^{(4)} =\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n\\end{bmatrix}, \\quad\n\\lambda^{(4)} = 0.9, \\quad k^{(4)} = 2.\n$$\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个元素是该测试用例所选节点索引的列表；例如，形如 $[ [i_1, i_2, \\dots], [\\dots], [\\dots], [\\dots] ]$ 的输出，但不含空格，即使用确切格式：\n\"[list_case1,list_case2,list_case3,list_case4]\"。", "solution": "用户提供的问题陈述已经过仔细验证，并被确定为有效。它在科学上基于已建立的基于网络的基因优先级排序原则，在数学上是适定的，并且其所有术语和目标都得到了足够精确的定义。该问题要求实现带重启的随机游走（RWR）算法，以根据一组已知的疾病相关蛋白质（种子）在网络中的邻近性来识别和排序新的蛋白质靶点。\n\n解决方案分两个阶段进行：首先，对底层数学框架进行原则性阐述；其次，设计一个计算算法来解决给定测试用例的问题。\n\n### 网络扩散与带重启随机游走的原理\n\n这个问题的核心在于对一组种子蛋白质在蛋白质-蛋白质相互作用（PPI）网络中的“影响”进行建模。这是通过一个网络扩散过程，具体而言是带重启的随机游走（RWR）算法来实现的。从概念上讲，RWR 模拟了一个在图上游走的随机游走者。从任何给定节点出发，游走者可以以由相互作用强度决定的概率移动到相邻节点，或者通过传送回初始种子节点之一来“重启”。\n\n每种蛋白质的最终得分由向量 $f$ 表示，对应于在该蛋白质相应节点上找到该游走者的稳态概率。对于一个非种子蛋白质 $i$ 而言，其较高的得分 $f_i$ 意味着它通过网络中的各种路径与种子蛋白质良好连接，使其成为一个很强的候选者，可能在功能上与种子所定义的疾病或生物过程相关。\n\n### 数学公式与求解\n\n该问题定义在一个加权无向图 $G = (V, E)$ 上，其中 $V$ 是 $n$ 种蛋白质的集合，$E$ 是相互作用的集合。相互作用强度由加权邻接矩阵 $A$ 给出。\n\n1.  **转移矩阵的构建**：第一步是定义在节点之间移动的概率。节点 $i$ 的度 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$ 代表蛋白质 $i$ 的总相互作用强度。构建行归一化转移矩阵 $W = D^{-1} A$，其中 $W_{ij} = A_{ij} / D_{ii}$ 是在不重启的条件下从节点 $i$ 转移到节点 $j$ 的概率。对于度为 $D_{ii}=0$ 的孤立节点 $i$，其在 $W$ 中对应的行被定义为零向量，表示游走者无法离开此节点。\n\n2.  **不动点方程**：稳态扩散得分由向量 $f \\in \\mathbb{R}^n$ 捕获，该向量满足不动点方程：\n    $$\n    f = \\lambda s + (1 - \\lambda) W f\n    $$\n    这里，$s$ 是归一化的种子向量，$\\lambda \\in (0, 1]$ 是重启参数。项 $\\lambda s$ 表示重启到种子节点的概率，而 $(1 - \\lambda) W f$ 表示从相邻节点流入的概率。\n\n3.  **求解线性系统**：为了找到 $f$ 的唯一解，我们将方程重排成一个标准的线性方程组。\n    $$\n    f - (1 - \\lambda) W f = \\lambda s\n    $$\n    将 $f$ 提出可得：\n    $$\n    (I - (1 - \\lambda) W) f = \\lambda s\n    $$\n    其中 $I$ 是 $n \\times n$ 的单位矩阵。这是一个形如 $M x = b$ 的线性系统，其中矩阵 $M = I - (1 - \\lambda) W$，未知向量是 $x = f$，右侧向量是 $b = \\lambda s$。\n    对于 $\\lambda \\in (0, 1]$，$(1-\\lambda)W$ 的谱半径严格小于 1，这保证了矩阵 $M$ 是可逆的。因此，$f$ 存在唯一解，可以通过求解这个线性系统得到。在计算上，这是通过使用数值线性代数求解器来高效稳定地实现的，而不是通过显式计算矩阵的逆 $M^{-1}$。\n\n### 算法流程\n\n为解决每个测试用例的问题，我们实现了以下分步算法。\n\n1.  **输入**：接收邻接矩阵 $A$、种子向量 $s$、重启参数 $\\lambda$ 和整数 $k$。\n\n2.  **处理零种子情况**：如果种子向量 $s$ 只包含零，系统变为 $(I - (1 - \\lambda) W) f = 0$。由于矩阵是可逆的，唯一的解是平凡解 $f=0$。在这种情况下，没有候选者的得分会超过阈值 $\\epsilon$，因此我们根据问题规范返回一个空列表。\n\n3.  **计算度矩阵和转移矩阵**：\n    a. 通过对 $A$ 的行求和来计算每个节点的度：$D_{ii} = \\sum_{j} A_{ij}$。\n    b. 构建转移矩阵 $W = D^{-1} A$。必须注意处理度为 0 的节点。对于任何 $D_{ii} = 0$ 的行 $i$，其对应的行 $W_{i, \\cdot}$ 被设为全零。\n\n4.  **求解线性系统**：\n    a. 构建大小为 $n \\times n$ 的单位矩阵 $I$。\n    b. 形成矩阵 $M = I - (1 - \\lambda) W$。\n    c. 形成向量 $b = \\lambda s$。\n    d. 求解系统 $M f = b$ 以得到扩散得分向量 $f$。\n\n5.  **识别和排序候选者**：\n    a. 将初始种子得分为零的节点定义为候选节点集：$\\{i \\mid s_i = 0\\}$。\n    b. 筛选这些候选者，只保留最终扩散得分严格为正的节点，即 $f_i > \\epsilon$，其中 $\\epsilon = 10^{-12}$。\n    c. 为每个有效的候选节点 $i$ 创建一个包含对 $(f_i, i)$ 的列表。\n    d. 对该候选者列表进行排序。主要排序标准是扩散得分 $f_i$（降序）。次要的平局决胜标准是节点索引 $i$（升序）。\n\n6.  **生成输出**：\n    a. 从排序后的列表中提取节点索引。\n    b. 从此列表中返回排名前 $k$ 的索引。如果候选者数量少于 $k$，则返回所有候选者索引。\n\n此流程将应用于提供的四个测试用例中的每一个。然后将结果格式化为指定的单行字符串输出。", "answer": "```python\nimport numpy as np\n\ndef solve_diffusion(A, s, lam, k, epsilon=1e-12):\n    \"\"\"\n    Computes and ranks candidate targets using Random Walk with Restart.\n\n    Args:\n        A (np.ndarray): The weighted adjacency matrix of the network.\n        s (np.ndarray): The seed vector.\n        lam (float): The restart parameter lambda.\n        k (int): The number of top candidates to return.\n        epsilon (float): A small numerical tolerance for score comparison.\n\n    Returns:\n        list: A list of the top-k ranked candidate node indices.\n    \"\"\"\n    n = A.shape[0]\n\n    # Handle the special case where the seed vector is all zeros.\n    if np.all(s == 0):\n        return []\n\n    # 1. Compute the degree matrix D and the transition matrix W.\n    degrees = np.sum(A, axis=1)\n    \n    # Create an inverse degree vector, handling zero-degree nodes.\n    inv_degrees = np.zeros_like(degrees)\n    non_zero_mask = degrees != 0\n    inv_degrees[non_zero_mask] = 1.0 / degrees[non_zero_mask]\n    \n    # Construct W by element-wise multiplication with the inverse degrees.\n    # This is equivalent to D_inv @ A but safer for zero-degree nodes.\n    W = inv_degrees[:, np.newaxis] * A\n    \n    # 2. Solve the fixed-point equation (I - (1-lam)W)f = lam*s\n    I = np.identity(n)\n    M = I - (1 - lam) * W\n    b = lam * s\n    \n    try:\n        f = np.linalg.solve(M, b)\n    except np.linalg.LinAlgError:\n        # This case should not be reached given the problem's guarantee\n        # of a unique solution, but is included for robustness.\n        return []\n\n    # 3. Identify candidate targets.\n    # Candidates are non-seed nodes (s_i = 0) with a score > epsilon.\n    non_seed_indices = np.where(s == 0)[0]\n    \n    candidates = []\n    for i in non_seed_indices:\n        if f[i] > epsilon:\n            candidates.append({'score': f[i], 'index': i})\n            \n    # 4. Rank candidates: descending score, ascending index for ties.\n    # The sort key (-score, index) achieves this.\n    candidates.sort(key=lambda c: (-c['score'], c['index']))\n    \n    # 5. Return the top-k candidate indices.\n    ranked_indices = [c['index'] for c in candidates]\n    \n    return ranked_indices[:k]\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the network diffusion problem.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"A\": np.array([\n                [0, 0.5, 0, 0, 0, 0, 0.1],\n                [0.5, 0, 0.4, 0, 0.1, 0, 0],\n                [0, 0.4, 0, 0.3, 0, 0.2, 0],\n                [0, 0, 0.3, 0, 0.7, 0, 0],\n                [0, 0.1, 0, 0.7, 0, 0.2, 0],\n                [0, 0, 0.2, 0, 0.2, 0, 0.6],\n                [0.1, 0, 0, 0, 0, 0.6, 0]\n            ]),\n            \"s\": np.array([0, 1.2, 0, 0, 0, 0.8, 0]),\n            \"lam\": 0.65,\n            \"k\": 3\n        },\n        {\n            \"A\": np.array([\n                [0, 1.0, 0.3, 0, 0],\n                [1.0, 0, 0.5, 0, 0.2],\n                [0.3, 0.5, 0, 0, 0],\n                [0, 0, 0, 0, 0],\n                [0, 0.2, 0, 0, 0]\n            ]),\n            \"s\": np.array([0, 0, 0, 1.0, 0]),\n            \"lam\": 0.85,\n            \"k\": 2\n        },\n        {\n            \"A\": np.array([\n                [0, 0.9, 0.4, 0, 0, 0, 0, 0],\n                [0.9, 0, 0.9, 0, 0, 0, 0, 0],\n                [0.4, 0.9, 0, 0.9, 0, 0, 0, 0],\n                [0, 0, 0.9, 0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 0, 0.8, 0.3, 0],\n                [0, 0, 0, 0, 0.8, 0, 0.8, 0],\n                [0, 0, 0, 0, 0.3, 0.8, 0, 0.8],\n                [0, 0, 0, 0, 0, 0, 0.8, 0]\n            ]),\n            \"s\": np.array([0, 1.0, 0, 0, 0, 0, 1.1, 0]),\n            \"lam\": 0.7,\n            \"k\": 3\n        },\n        {\n            \"A\": np.array([\n                [0, 0.5, 0, 0.5],\n                [0.5, 0, 0.5, 0],\n                [0, 0.5, 0, 0.5],\n                [0.5, 0, 0.5, 0]\n            ]),\n            \"s\": np.array([0, 0, 0, 0]),\n            \"lam\": 0.9,\n            \"k\": 2\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_diffusion(case[\"A\"], case[\"s\"], case[\"lam\"], case[\"k\"])\n        results.append(result)\n\n    # Format the output string precisely as required: \"[list1,list2,...]\"\n    # str() adds spaces, so they must be removed.\n    formatted_results = [str(r).replace(' ', '') for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "5066670"}, {"introduction": "一个潜在药物靶点的发现之旅，并不会在生物学验证后就此结束，最终它必须面对商业和临床应用的严苛评估。这个最终练习模拟了转化医学中至关重要且风险极高的决策过程，即如何将科学证据转化为对临床潜力的量化评估。你将学习构建一个综合性的“获益-风险指数”[@problem_id:5066778]，该指数整合了来自遗传学、功能基因组学的预期疗效证据以及已知的毒理学风险，从而为一个靶点项目做出理性的“继续/终止”（go/no-go）决策。", "problem": "一个转化医学团队正在通过整合遗传学证据、功能基因组学与通路毒性评估，来为一个炎症性疾病的治疗靶点确定优先次序。其总体生物学基础是分子生物学中心法则（DNA到RNA到蛋白质），它将一个经过遗传学验证的靶蛋白与疾病表型联系起来；同时结合了决策论中的预期效用原则，即最优选择是使预期获益减去预期损害的差值最大化。该团队以质量调整生命年 (QALYs) 为单位，对每位患者的预期临床获益和损害进行建模。\n\n靶点与疾病基因座的遗传共定位得出的因果概率为 $w_{g} = 0.65$。在一个疾病相关的细胞系中进行的成簇规律间隔短回文重复序列 (CRISPR) 功能丧失筛选显示，当靶点被扰动时，$\\log_{2}$ 细胞活力下降幅度为 $s = 1.2$，功能性命中置信度量化为 $w_{f} = 0.75$。假设遗传学证据和功能性证据相互独立，并使用标准的并集概率模型来获得靶点调节将具有临床疗效的总概率。临床获益的预期幅度通过一个饱和药效动力学效应函数进行建模，该函数的最大可及获益为 $E_{\\max} = 0.5$ QALY，灵敏度参数为 $\\alpha = 0.4$。此函数基于经过充分检验的剂量-反应推理，将功能基因组学效应大小 $s$ 映射为临床获益幅度 $M$，作为一个单调饱和变换。从靶点的机制网络中已知的通路毒性包括三种潜在损害：心脏毒性（概率 $p_{1} = 0.12$，严重程度 $w_{1} = 0.25$ QALY 损失，暴露权重 $e_{1} = 0.9$）、肝脏毒性（$p_{2} = 0.08$，$w_{2} = 0.15$，$e_{2} = 0.8$）和血液学毒性（$p_{3} = 0.05$，$w_{3} = 0.20$，$e_{3} = 0.7$）。假设对损害进行风险中性加权。\n\n从预期效用原则和基本概率法则出发，推导出获益-风险指数 $I$（即预期净 QALY），并根据上述输入值进行计算。此外，通过将最小临床重要差异 $\\delta = 0.05$ QALY 和开发机会成本等价值 $D = 0.03$ QALY 相加，推导出一个合理的“继续/终止”决策阈值 $\\theta$，并解释计算出的 $I$ 相对于 $\\theta$ 的意义。\n\n计算 $I$ 并报告其值。将最终的 $I$ 值四舍五入至四位有效数字，并以 QALYs 为单位表示。", "solution": "用户希望我按照以下步骤解决问题：\n1.  验证问题陈述。\n2.  如果问题有效，提供完整且有理有据的解答。\n3.  使用 LaTeX 格式化所有数学实体。\n4.  按指定格式提供最终答案。\n\n### 第1步：问题验证\n\n#### 提取已知条件\n-   遗传学因果概率：$w_g = 0.65$\n-   功能基因组学效应大小（$\\log_{2}$ 细胞活力下降）：$s = 1.2$\n-   功能性命中置信度：$w_f = 0.75$\n-   假设：遗传学证据与功能性证据相互独立。\n-   总体有效性概率模型：标准并集概率模型。\n-   最大可及临床获益：$E_{\\max} = 0.5$ QALY。\n-   获益函数的灵敏度参数：$\\alpha = 0.4$。\n-   临床获益幅度 $M$ 的模型：$s$ 的单调饱和变换。\n-   心脏毒性参数：概率 $p_1 = 0.12$，严重程度 $w_1 = 0.25$ QALY，暴露权重 $e_1 = 0.9$。\n-   肝脏毒性参数：概率 $p_2 = 0.08$，严重程度 $w_2 = 0.15$ QALY，暴露权重 $e_2 = 0.8$。\n-   血液学毒性参数：概率 $p_3 = 0.05$，严重程度 $w_3 = 0.20$ QALY，暴露权重 $e_3 = 0.7$。\n-   假设：对损害进行风险中性加权。\n-   最小临床重要差异：$\\delta = 0.05$ QALY。\n-   开发机会成本：$D = 0.03$ QALY。\n-   任务：推导并计算获益-风险指数 $I$（预期净 QALY）。\n-   任务：推导“继续/终止”决策阈值 $\\theta$。\n-   任务：解释计算出的 $I$ 相对于 $\\theta$ 的意义。\n-   要求：将最终的 $I$ 值四舍五入至四位有效数字。\n\n#### 使用提取的已知条件进行验证\n该问题具有科学依据，借鉴了分子生物学（中心法则）、遗传学（CRISPR、共定位）、药理学（剂量-反应）和决策论（预期效用、QALYs）的既定原则。该场景为转化医学中的决策过程提供了一个合理（尽管简化）的定量模型。\n\n该问题是良态的。它提供了必要的定量输入，并指定了要使用的模型（例如，“并集概率模型”、“风险中性加权”）。虽然未给出临床获益的“单调饱和变换”的确切代数形式，但其属性（$E_{\\max}$、灵敏度 $\\alpha$）的描述足以支持使用一个标准的、常见的函数形式，例如 $M(s) = E_{\\max}(1 - \\exp(-\\alpha s))$，这与剂量-反应模型一致。术语“暴露权重”在药理学背景下也可以被合理解释为调节损害概率的一个因素。该问题是自洽的、客观的，并且不包含矛盾信息或不科学的前提。\n\n#### 结论与行动\n该问题被认定为有效。将推导完整的解答。\n\n### 第2步：解答推导\n\n该问题要求计算获益-风险指数 $I$，定义为预期净质量调整生命年 (QALYs)。这基于预期效用原则，即该指数是预期获益与预期损害之间的差值。\n$$I = E[\\text{获益}] - E[\\text{损害}]$$\n\n#### 预期获益计算\n预期获益 $E[\\text{获益}]$ 是疗法有效的概率 $P_{eff}$ 与其有效情况下的临床获益幅度 $M$ 的乘积。\n$$E[\\text{获益}] = P_{eff} \\times M$$\n\n首先，我们计算 $P_{eff}$。问题指出，对于独立的遗传学证据 ($w_g$) 和功能性证据 ($w_f$)，应使用“标准并集概率模型”。设 $G$ 为基于遗传学证据靶点具有因果关系的事件，设 $F$ 为基于功能性证据靶点具有因果关系的事件。有效性概率是这两个事件的并集概率。\n$$P_{eff} = P(G \\cup F)$$\n考虑到证据来源是独立的，我们有：\n$$P_{eff} = P(G) + P(F) - P(G)P(F) = w_g + w_f - w_g w_f$$\n代入给定值：\n$$P_{eff} = 0.65 + 0.75 - (0.65)(0.75) = 1.40 - 0.4875 = 0.9125$$\n\n接下来，我们计算临床获益的幅度 $M$。问题将 $M$ 描述为功能基因组学效应大小 $s$ 的“单调饱和变换”，其最大获益为 $E_{\\max}$，灵敏度为 $\\alpha$。基于剂量-反应原理，这种关系的一个标准函数形式是指数饱和模型。我们将采用此形式：\n$$M = E_{\\max} \\left(1 - \\exp(-\\alpha s)\\right)$$\n代入给定值：\n$$M = 0.5 \\left(1 - \\exp(-0.4 \\times 1.2)\\right) = 0.5 \\left(1 - \\exp(-0.48)\\right)$$\n\n现在，我们可以计算预期获益：\n$$E[\\text{获益}] = P_{eff} \\times M = 0.9125 \\times 0.5 \\left(1 - \\exp(-0.48)\\right)$$\n$$E[\\text{获益}] \\approx 0.9125 \\times 0.5 \\times (1 - 0.6187795) = 0.9125 \\times 0.5 \\times 0.3812205 \\approx 0.1739226 \\text{ QALYs}$$\n\n#### 预期损害计算\n预期损害 $E[\\text{损害}]$ 是在风险中性假设下，三种潜在毒性各自预期损害的总和。单个毒性事件 $i$ 的预期损害是其发生概率乘以其严重性。问题提供了概率 $p_i$、严重性 $w_i$ 和“暴露权重” $e_i$。一个合理的解释是，经历该毒性的有效概率是内在通路概率 $p_i$ 受暴露权重 $e_i$ 调节后的结果。\n$$E[\\text{损害}_i] = (p_i e_i) \\times w_i$$\n总预期损害 $H_{exp}$ 是三种毒性之和：\n$$H_{exp} = \\sum_{i=1}^{3} p_i e_i w_i = (p_1 e_1 w_1) + (p_2 e_2 w_2) + (p_3 e_3 w_3)$$\n代入给定值：\n-   心脏毒性: $E[\\text{损害}_1] = 0.12 \\times 0.9 \\times 0.25 = 0.027$\n-   肝脏毒性: $E[\\text{损害}_2] = 0.08 \\times 0.8 \\times 0.15 = 0.0096$\n-   血液学毒性: $E[\\text{损害}_3] = 0.05 \\times 0.7 \\times 0.20 = 0.007$\n\n总预期损害为：\n$$H_{exp} = 0.027 + 0.0096 + 0.007 = 0.0436 \\text{ QALYs}$$\n\n#### 获益-风险指数与阈值计算\n现在计算获益-风险指数 $I$：\n$$I = E[\\text{获益}] - H_{exp} \\approx 0.1739226 - 0.0436 = 0.1303226$$\n按要求四舍五入至四位有效数字：\n$$I \\approx 0.1303 \\text{ QALYs}$$\n\n“继续/终止”决策阈值 $\\theta$ 定义为最小临床重要差异 $\\delta$ 与开发机会成本 $D$ 的和：\n$$\\theta = \\delta + D$$\n代入给定值：\n$$\\theta = 0.05 + 0.03 = 0.08 \\text{ QALYs}$$\n\n#### 解释\n最后一步是解释计算出的指数 $I$ 相对于阈值 $\\theta$ 的意义。\n-   计算的获益-风险指数：$I \\approx 0.1303$ QALYs。\n-   计算的“继续/终止”决策阈值：$\\theta = 0.08$ QALYs。\n\n由于 $I > \\theta$ ($0.1303 > 0.08$)，开发此治疗靶点的预期净获益超过了考量临床意义和机会成本后所要求的阈值。因此，根据此模型，决策应为“继续”——即推进此靶点的开发。", "answer": "$$\n\\boxed{0.1303}\n$$", "id": "5066778"}]}