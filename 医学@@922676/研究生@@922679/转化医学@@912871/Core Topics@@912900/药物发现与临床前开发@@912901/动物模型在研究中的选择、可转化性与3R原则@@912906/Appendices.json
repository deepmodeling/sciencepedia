{"hands_on_practices": [{"introduction": "本练习旨在连接临床前动物毒理学与临床试验，这是转化医学中的关键一步。您将通过整合两种关键方法来计算一种新抗体的首次人体（FIH）给药剂量：传统的基于“未观察到有害作用的剂量水平”（$NOAEL$）的方法，以及现代的、基于机理的“最低预期生物效应水平”（$MABEL$）方法。这项练习 [@problem_id:4990298] 将磨练您在药代动力学标度换算和风险评估方面的技能，并演示如何通过选择更保守的估计值来确定安全的起始剂量。", "problem": "一家生物技术公司计划为一种靶向与自身免疫性疾病相关的细胞表面受体的新型单克隆抗体进行首次人体研究。临床前研究已在 Cynomolgus 猴中作为主要药理学和毒理学物种进行。该研究方案必须整合动物模型对人类的可转化性以及符合 3R 原则（替代、减少、优化）的先进风险缓解措施，方法是将基于未观察到有害作用水平 (NOAEL) 的暴露匹配与基于最小预期生物效应水平 (MABEL) 的受体占有率方法相结合。通过计算 NOAEL 推导的最大推荐起始剂量和 MABEL 推导的剂量，然后选择更保守（更小）的值，从第一性原理推导出人体每周静脉快速推注方案的推荐起始剂量。\n\n使用以下科学上合理且内部一致的信息：\n- Cynomolgus 猴的 NOAEL 为每周静脉快速推注 $1.0\\,\\text{mg/kg}$，持续 $4$ 周，具有线性药代动力学特征，且静脉给药的生物利用度完全。\n- 猴体重 $BW_{m} = 3.5$ $\\text{kg}$。\n- 人体参考体重 $BW_{h} = 70$ $\\text{kg}$。\n- 猴（物种平均）每公斤清除率 $CL_{m,\\text{kg}} = 0.15$ $\\text{L}/\\text{day}/\\text{kg}$。\n- 猴（物种平均）每公斤分布容积 $V_{d,\\text{kg}} = 0.05$ $\\text{L}/\\text{kg}$。\n- 静脉快速推注的生物利用度 $F = 1$。\n- 总清除率的异速生长标度遵循 $CL \\propto BW^{0.75}$（哺乳动物中公认的代谢标度）。\n- 该抗体对人类靶点的体外平衡解离常数为 $K_{D} = 0.2$ $\\text{nM}$。\n- 预期产生生物效应的保守最小受体占有率为 $RO^{*} = 0.10$（分数占有率）。\n- 抗体分子量为 $M = 150{,}000$ $\\text{g}/\\text{mol}$。\n- 一个复合不确定性因子 $U = 10$ 被应用于经 NOAEL 暴露匹配的人体剂量，以考虑种间差异和残余不确定性。\n\n为进行暴露匹配和估算人体每周静脉快速推注的初始峰值浓度，假设为单室线性药代动力学。将 NOAEL 定义为未观察到生物学或统计学上显著不良反应的最高测试剂量。将 MABEL 定义为根据机理原理和与人体相关的效力预测的、能够安全地达到刚好可辨别的生物效应的最小剂量。\n\n任务：\n1. 使用经过充分检验的静脉给药药代动力学知识，通过将平均浓度等同于给药速率与清除率之比，计算在 NOAEL 方案下一个给药间隔内猴的平均血浆浓度。\n2. 使用给定的清除率异速生长定律，对猴的清除率进行标度以预测人体的总清除率，并计算能够重现猴 NOAEL 平均浓度的人体给药速率。将此速率转换为人体每周剂量，然后应用不确定性因子 $U$ 以获得 NOAEL 推导的最大推荐起始剂量。\n3. 使用受体结合的质量作用定律，推导对于具有 $K_{D}$ 的靶点达到 $RO^{*}$ 所需的最小血浆游离药物浓度，使用分子量 $M$ 将该浓度转换为 $\\text{mg}/\\text{L}$，然后使用静脉快速推注的初始峰值浓度关系计算产生该峰值浓度的人体每周剂量，其中 $V_{d}$ 按给定方式随 $BW$ 标度。\n4. 从任务 2 和 3 中选择两个人体每周剂量中较低的一个，以符合 3R 原则中的优化和减少原则，并将其作为推荐的首次人体每周静脉起始剂量报告。\n\n以 $\\text{mg}$ 为单位表示最终推荐的首次人体每周剂量，并将您的答案四舍五入至三位有效数字。", "solution": "用户希望我解决一个药理学问题。我将首先验证该问题，如果有效，则继续提供解决方案。\n\n### 第 1 步：提取给定信息\n- **Cynomolgus 猴的 NOAEL**：每周静脉快速推注 $1.0$ $\\text{mg}/\\text{kg}$，持续 $4$ 周。\n- **猴体重**：$BW_{m} = 3.5$ $\\text{kg}$。\n- **人体参考体重**：$BW_{h} = 70$ $\\text{kg}$。\n- **猴每公斤清除率**：$CL_{m,\\text{kg}} = 0.15$ $\\text{L}/\\text{day}/\\text{kg}$。\n- **猴每公斤分布容积**：$V_{d,\\text{kg}} = 0.05$ $\\text{L}/\\text{kg}$。\n- **静脉快速推注的生物利用度**：$F = 1$。\n- **清除率的异速生长标度**：$CL \\propto BW^{0.75}$。\n- **平衡解离常数**：$K_{D} = 0.2$ $\\text{nM}$。\n- **最小受体占有率**：$RO^{*} = 0.10$。\n- **抗体分子量**：$M = 150{,}000$ $\\text{g}/\\text{mol}$。\n- **不确定性因子**：$U = 10$。\n- **给药方案**：每周静脉快速推注。\n- **药代动力学模型**：单室，线性。\n- **分布容积的标度**：$V_{d}$ 随 $BW$ 标度（线性，即 $V_d \\propto BW^{1.0}$）。\n\n### 第 2 步：使用提取的给定信息进行验证\n根据验证标准对问题进行评估。\n\n- **科学依据**：该问题在药理学和毒理学原理方面有充分的依据。它利用了标准且广为接受的首次人体剂量选择方法，包括基于 NOAEL 的异速生长标度和基于 MABEL 的机理方法。使用指数为 $0.75$ 的异速生长标度来计算清除率、单室 PK 模型以及受体结合的质量作用定律都是该领域的基本概念。所提供的数值（体重、清除率、$K_D$、分子量）对于单克隆抗体和标准测试物种是现实的。所描述的过程是高风险分子的标准行业实践。\n- **结构良好**：问题清晰地分为四个任务，引导推导出最终答案。提供了所有必要的数据和常数。目标是计算一个单一的数值，并且解决方案的路径是明确的。\n- **客观性**：问题以精确、定量和客观的语言陈述，没有偏见或主观解释。提供了 NOAEL 和 MABEL 的定义，没有留下任何模糊空间。\n\n该问题没有任何缺陷。它在科学上是合理的，规定是完整的，并且是客观的。\n\n### 第 3 步：结论和行动\n问题有效。将提供详细的解决方案。\n\n任务是通过计算基于未观察到有害作用水平 (NOAEL) 的剂量和基于最小预期生物效应水平 (MABEL) 的剂量，然后选择两者中更保守（更低）的值，来确定推荐的首次人体 (FIH) 起始剂量。\n\n**第 1 部分：NOAEL 推导的人体剂量的计算**\n\n首先，我们计算在 NOAEL 剂量下猴的稳态平均血浆浓度 ($C_{avg, m}$)。对于每周给药方案，给药间隔为 $\\tau = 7$ 天。平均浓度是在该间隔内施用的总剂量除以同一间隔内的总清除率，这可以简化为给药速率与清除率之比。\n\n猴的每公斤给药速率为：\n$$ \\text{Rate}_{m,\\text{kg}} = \\frac{\\text{Dose}_{m,\\text{kg}}}{\\tau} = \\frac{1.0 \\text{ mg/kg}}{7 \\text{ days}} $$\n\n猴的平均浓度 $C_{avg, m}$ 则为：\n$$ C_{avg, m} = \\frac{\\text{Rate}_{m,\\text{kg}}}{CL_{m,\\text{kg}}} = \\frac{(1.0/7) \\text{ mg/kg/day}}{0.15 \\text{ L/day/kg}} = \\frac{1.0}{7 \\times 0.15} \\frac{\\text{mg}}{\\text{L}} = \\frac{1.0}{1.05} \\frac{\\text{mg}}{\\text{L}} \\approx 0.9524 \\frac{\\text{mg}}{\\text{L}} $$\n该值代表了需要在人体中匹配的目标暴露量。\n\n接下来，我们使用给定的异速生长标度定律 $CL \\propto BW^{0.75}$，对猴的清除率 ($CL_m$) 进行标度以预测人体的清除率 ($CL_h$)。\n首先，我们计算一只代表性猴的总清除率：\n$$ CL_m = CL_{m,\\text{kg}} \\times BW_m = (0.15 \\text{ L/day/kg}) \\times (3.5 \\text{ kg}) = 0.525 \\text{ L/day} $$\n现在，我们将其标度到人体：\n$$ CL_h = CL_m \\left(\\frac{BW_h}{BW_m}\\right)^{0.75} = (0.525 \\text{ L/day}) \\left(\\frac{70 \\text{ kg}}{3.5 \\text{ kg}}\\right)^{0.75} = 0.525 \\times (20)^{0.75} \\text{ L/day} $$\n$$ CL_h \\approx 0.525 \\times 9.4574 \\text{ L/day} \\approx 4.965 \\text{ L/day} $$\n\n为了在人体中达到相同的平均浓度 ($C_{avg, h} = C_{avg, m}$)，我们计算所需的人体给药速率 ($\\text{Rate}_h$)：\n$$ \\text{Rate}_h = C_{avg, h} \\times CL_h = C_{avg, m} \\times CL_h = \\left(\\frac{1.0}{1.05} \\frac{\\text{mg}}{\\text{L}}\\right) \\times (4.965 \\text{ L/day}) \\approx 4.7287 \\text{ mg/day} $$\n人体的每周总剂量 $D_{h,raw}$ 是该速率乘以给药间隔 $\\tau = 7$ 天：\n$$ D_{h,raw} = \\text{Rate}_h \\times \\tau \\approx (4.7287 \\text{ mg/day}) \\times (7 \\text{ days}) \\approx 33.10 \\text{ mg} $$\n最后，我们应用不确定性因子 $U=10$ 来获得 NOAEL 推导的最大推荐起始剂量 $D_{h,NOAEL}$：\n$$ D_{h,NOAEL} = \\frac{D_{h,raw}}{U} = \\frac{33.10 \\text{ mg}}{10} = 3.310 \\text{ mg} $$\n\n**第 2 部分：MABEL 推导的人体剂量的计算**\n\nMABEL 方法旨在找到能够达到最小但可观察到的生物效应的剂量。这是基于达到目标受体占有率 ($RO^*$) 计算的。游离药物浓度 $[C]$、解离常数 $K_D$ 和受体占有率 $RO$ 之间的关系由质量作用定律给出：\n$$ RO = \\frac{[C]}{[C] + K_D} $$\n我们需要找到达到目标占有率 $RO^* = 0.10$ 所需的浓度 $[C]^*$。\n$$ RO^* = \\frac{[C]^*}{[C]^* + K_D} \\implies [C]^* = K_D \\frac{RO^*}{1 - RO^*} $$\n代入给定值 $K_D = 0.2 \\text{ nM} = 0.2 \\times 10^{-9} \\text{ mol/L}$ 和 $RO^* = 0.10$：\n$$ [C]^* = (0.2 \\times 10^{-9} \\text{ M}) \\times \\frac{0.10}{1 - 0.10} = (0.2 \\times 10^{-9} \\text{ M}) \\times \\frac{0.10}{0.90} = \\frac{0.2}{9} \\times 10^{-9} \\text{ mol/L} $$\n\n接下来，我们使用分子量 $M = 150{,}000 \\text{ g/mol}$ 将此摩尔浓度转换为质量浓度 ($C^*_{mg/L}$)：\n$$ C^*_{mg/L} = [C]^* (\\text{mol/L}) \\times M (\\text{g/mol}) \\times 1000 (\\text{mg/g}) $$\n$$ C^*_{mg/L} = \\left(\\frac{0.2}{9} \\times 10^{-9}\\right) \\times (150{,}000) \\times (1000) = \\frac{0.2 \\times 1.5 \\times 10^5 \\times 10^3}{9} \\times 10^{-9} \\frac{\\text{mg}}{\\text{L}} $$\n$$ C^*_{mg/L} = \\frac{0.3 \\times 10^8}{9} \\times 10^{-9} = \\frac{1}{30} \\times 10^{-1} = \\frac{1}{300} \\frac{\\text{mg}}{\\text{L}} \\approx 0.00333 \\frac{\\text{mg}}{\\text{L}} $$\n该浓度是静脉快速推注后立即达到的初始血浆峰值浓度 ($C_{0,h}$) 的目标。\n\n达到该峰值浓度所需的剂量是使用关系式 $C_0 = \\text{剂量} / V_d$ 计算的，其中 $V_d$ 是分布容积。首先，我们确定人体的分布容积 $V_{dh}$。问题指出 $V_d$ 随 $BW$ 标度，并提供了 $V_{d,\\text{kg}}$，这意味着线性标度。\n$$ V_{dh} = V_{d,\\text{kg}} \\times BW_h = (0.05 \\text{ L/kg}) \\times (70 \\text{ kg}) = 3.5 \\text{ L} $$\nMABEL 推导的剂量 $D_{h,MABEL}$ 则为：\n$$ D_{h,MABEL} = C_{0,h} \\times V_{dh} = \\left(\\frac{1}{300} \\frac{\\text{mg}}{\\text{L}}\\right) \\times (3.5 \\text{ L}) = \\frac{3.5}{300} \\text{ mg} = \\frac{7}{600} \\text{ mg} $$\n$$ D_{h,MABEL} \\approx 0.011667 \\text{ mg} $$\n\n**第 3 部分：最终剂量选择**\n\n最后一步是比较两个计算出的剂量，并选择更保守（更低）的值作为推荐的起始剂量。这符合风险缓解的原则。\n$$ D_{h,NOAEL} \\approx 3.310 \\text{ mg} $$\n$$ D_{h,MABEL} \\approx 0.011667 \\text{ mg} $$\n比较这两个值，$D_{h,MABEL}$ 远低于 $D_{h,NOAEL}$。\n$$ 0.011667 \\text{ mg}  3.310 \\text{ mg} $$\n因此，MABEL 推导的剂量是更保守的选择，并被选为推荐的 FIH 起始剂量。\n\n问题要求将最终答案四舍五入到三位有效数字。\n$$ D_{recommended} = 0.0117 \\text{ mg} $$", "answer": "$$\n\\boxed{0.0117}\n$$", "id": "4990298"}, {"introduction": "伦理考量在动物研究中至关重要，“3R”原则中的“减少”（Reduction）原则要求我们最大限度地减少所用动物的数量。本练习探讨了统计设计如何直接影响动物的使用。通过比较完全随机设计与随机区组设计 [@problem_id:4990302]，您将推导出区组设计所带来的量化效率增益，为“深思熟虑的实验设计是合乎伦理且有效研究的基石”这一观点提供清晰的数学论证。", "problem": "一项转化性研究旨在博来霉素诱导的小鼠肺纤维化模型中，比较一种新型抗纤维化疗法与载体对照的效果，同时遵循替代、减少和优化 (Replacement, Reduction, and Refinement, 3Rs) 的伦理原则。研究团队重点关注“减少”原则，考虑了两种在治疗组和对照组之间进行均等分配的平衡设计：完全随机设计和随机区组（配对）设计，其中每窝（litter）构成一个区组，每个区组正好提供一只接受治疗的动物和一只作为对照的动物。\n\n假设在两种设计下，对一个连续终点（例如，羟脯氨酸含量）采用标准的加性随机效应模型。令 $Y_{ij}$ 表示区组 $i$ 中动物 $j \\in \\{\\mathrm{T}, \\mathrm{C}\\}$ 的终点，并假设\n$$\nY_{ij} \\;=\\; \\mu \\;+\\; \\tau_{j} \\;+\\; b_{i} \\;+\\; \\varepsilon_{ij},\n$$\n其中 $b_{i} \\sim \\mathcal{N}(0,\\sigma_{b}^{2})$ 是独立的区组效应，$\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma_{w}^{2})$ 是独立的区组内误差，且所有随机项相互独立。科学问题是在两种设计下，以显著性水平 $\\alpha$ 进行双侧假设检验，以相同的统计功效检测出真实的治疗效应 $\\Delta = \\tau_{\\mathrm{T}} - \\tau_{\\mathrm{C}} \\neq 0$。假设大样本服从正态分布，且方差分量已知。\n\n令 $N_{\\mathrm{CRD}}$ 表示在完全随机设计下，为检测到相同的 $\\Delta$，在显著性水平 $\\alpha$ 下达到目标功效所需的最小动物总数；令 $N_{\\mathrm{RBD}}$ 表示在每个区组包含一只治疗动物和一只对照动物的随机区组设计下，对应的最小动物总数。\n\n从正态均值假设检验和上述模型下方差传播的第一性原理出发，推导比率\n$$\n\\kappa \\;=\\; \\frac{N_{\\mathrm{RBD}}}{N_{\\mathrm{CRD}}}\n$$\n的解析表达式，该表达式仅用 $\\sigma_{b}^{2}$ 和 $\\sigma_{w}^{2}$ 表示。然后，当 $\\sigma_{b}^{2} = 9$ 和 $\\sigma_{w}^{2} = 16$ 时，对此表达式进行数值计算。将您最终的 $\\kappa$ 数值答案四舍五入至四位有效数字。报告 $\\kappa$ 时，应为一个无单位的纯数。", "solution": "用户要求对两种实验设计的样本量比率 $\\kappa = N_{\\mathrm{RBD}} / N_{\\mathrm{CRD}}$ 进行分步推导，然后进行数值计算。\n\n该问题被判定为**有效**。这是一个在生物统计学和实验设计领域中提法恰当、具有科学依据的问题。其前提清晰、一致，并足以推导出唯一且有意义的解。\n\n以下是分步推导过程：\n\n目标是求出比率 $\\kappa = \\frac{N_{\\mathrm{RBD}}}{N_{\\mathrm{CRD}}}$，其中 $N_{\\mathrm{CRD}}$ 和 $N_{\\mathrm{RBD}}$ 是在显著性水平为 $\\alpha$ 的双侧假设检验中，检测出治疗效应 $\\Delta = \\tau_{\\mathrm{T}} - \\tau_{\\mathrm{C}}$ 时，达到相同统计功效（$1-\\beta$）所需的动物总数。假设方差分量 $\\sigma_{b}^{2}$ 和 $\\sigma_{w}^{2}$ 已知，并且样本量足够大，可以使用正态近似（Z检验）。\n\n对于均值或均值差的双侧Z检验，所需的样本量取决于效应估计量 $\\hat{\\Delta}$ 的方差。令 $\\mathrm{SE}(\\hat{\\Delta})$ 为估计量的标准误。对于给定的 $\\Delta$、$\\alpha$ 和 $\\beta$，对 $\\mathrm{SE}(\\hat{\\Delta})$ 的条件是固定的：\n$$\n\\frac{|\\Delta|}{\\mathrm{SE}(\\hat{\\Delta})} \\ge z_{1-\\alpha/2} + z_{1-\\beta}\n$$\n这意味着估计量所需的方差为\n$$\n\\mathrm{Var}(\\hat{\\Delta}) \\le \\frac{\\Delta^2}{(z_{1-\\alpha/2} + z_{1-\\beta})^2}\n$$\n为得到最小样本量，我们取等号。由于 $\\Delta$、$\\alpha$ 和功效对于两种设计都是相同的，因此量 $C = \\frac{(z_{1-\\alpha/2} + z_{1-\\beta})^2}{\\Delta^2}$ 是一个常数。我们必须找出在每种情况下，总样本量 $N$ 与 $\\mathrm{Var}(\\hat{\\Delta})$ 的关系。\n\n**1. 完全随机设计 (CRD)**\n\n在完全随机设计 (CRD) 中，区组结构（窝）被忽略，动物被随机分配到两个组：治疗组 (T) 和对照组 (C)。由于是平衡设计，总样本量为 $N_{\\mathrm{CRD}}$，每组有 $n_{\\mathrm{T}} = n_{\\mathrm{C}} = N_{\\mathrm{CRD}}/2$ 只动物。\n\n治疗组 $j$ 中观测值 $k$ 的模型是 $Y_{k} = \\mu + \\tau_{j} + \\text{随机误差}$。任何一只动物的随机误差项是其窝效应 $b_i$ 和个体误差 $\\varepsilon_{ij}$ 的和。由于动物是随机分配的，不考虑窝别，因此单个观测值的总方差是各随机分量方差之和：\n$$\n\\mathrm{Var}(Y) = \\mathrm{Var}(b_i + \\varepsilon_{ij}) = \\mathrm{Var}(b_i) + \\mathrm{Var}(\\varepsilon_{ij}) = \\sigma_{b}^{2} + \\sigma_{w}^{2}\n$$\n治疗效应的估计量是样本均值之差，$\\hat{\\Delta}_{\\mathrm{CRD}} = \\bar{Y}_{\\mathrm{T}} - \\bar{Y}_{\\mathrm{C}}$。由于在CRD中各观测值是独立的，该估计量的方差为：\n$$\n\\mathrm{Var}(\\hat{\\Delta}_{\\mathrm{CRD}}) = \\mathrm{Var}(\\bar{Y}_{\\mathrm{T}}) + \\mathrm{Var}(\\bar{Y}_{\\mathrm{C}}) = \\frac{\\sigma_{b}^{2} + \\sigma_{w}^{2}}{n_{\\mathrm{T}}} + \\frac{\\sigma_{b}^{2} + \\sigma_{w}^{2}}{n_{\\mathrm{C}}}\n$$\n代入 $n_{\\mathrm{T}} = n_{\\mathrm{C}} = N_{\\mathrm{CRD}}/2$：\n$$\n\\mathrm{Var}(\\hat{\\Delta}_{\\mathrm{CRD}}) = \\frac{\\sigma_{b}^{2} + \\sigma_{w}^{2}}{N_{\\mathrm{CRD}}/2} + \\frac{\\sigma_{b}^{2} + \\sigma_{w}^{2}}{N_{\\mathrm{CRD}}/2} = \\frac{4(\\sigma_{b}^{2} + \\sigma_{w}^{2})}{N_{\\mathrm{CRD}}}\n$$\n为了达到目标功效，我们令 $\\mathrm{Var}(\\hat{\\Delta}_{\\mathrm{CRD}}) = 1/C$，得到：\n$$\nN_{\\mathrm{CRD}} = 4C(\\sigma_{b}^{2} + \\sigma_{w}^{2})\n$$\n\n**2. 随机区组设计 (RBD)**\n\n在采用配对观测的随机区组设计 (RBD) 中，每个区组（窝）$i$ 包含一只分配到治疗组的动物和一只分配到对照组的动物。假设有 $n_b$ 个这样的区组。动物总数为 $N_{\\mathrm{RBD}} = 2n_b$。\n\n区组 $i$ 中两只动物的观测值是：\n$$\nY_{i\\mathrm{T}} = \\mu + \\tau_{\\mathrm{T}} + b_{i} + \\varepsilon_{i\\mathrm{T}} \\\\\nY_{i\\mathrm{C}} = \\mu + \\tau_{\\mathrm{C}} + b_{i} + \\varepsilon_{i\\mathrm{C}}\n$$\n分析过程是通过计算每个区组的差值 $D_i$ 来进行：\n$$\nD_i = Y_{i\\mathrm{T}} - Y_{i\\mathrm{C}} = (\\mu + \\tau_{\\mathrm{T}} + b_{i} + \\varepsilon_{i\\mathrm{T}}) - (\\mu + \\tau_{\\mathrm{C}} + b_{i} + \\varepsilon_{i\\mathrm{C}}) = (\\tau_{\\mathrm{T}} - \\tau_{\\mathrm{C}}) + (\\varepsilon_{i\\mathrm{T}} - \\varepsilon_{i\\mathrm{C}})\n$$\n$D_i = \\Delta + \\varepsilon_{i\\mathrm{T}} - \\varepsilon_{i\\mathrm{C}}$。值得注意的是，随机区组效应 $b_i$ 被消除了。差值的期望值为 $E[D_i] = \\Delta$。由于区组内误差 $\\varepsilon_{i\\mathrm{T}}$ 和 $\\varepsilon_{i\\mathrm{C}}$ 是独立的，因此 $D_i$ 的方差是：\n$$\n\\mathrm{Var}(D_i) = \\mathrm{Var}(\\varepsilon_{i\\mathrm{T}} - \\varepsilon_{i\\mathrm{C}}) = \\mathrm{Var}(\\varepsilon_{i\\mathrm{T}}) + \\mathrm{Var}(\\varepsilon_{i\\mathrm{C}}) = \\sigma_{w}^{2} + \\sigma_{w}^{2} = 2\\sigma_{w}^{2}\n$$\n$\\Delta$ 的估计量是这些差值的平均值，$\\hat{\\Delta}_{\\mathrm{RBD}} = \\bar{D} = \\frac{1}{n_b} \\sum_{i=1}^{n_b} D_i$。差值 $D_i$ 在不同区组之间是独立的。该估计量的方差是：\n$$\n\\mathrm{Var}(\\hat{\\Delta}_{\\mathrm{RBD}}) = \\mathrm{Var}(\\bar{D}) = \\frac{\\mathrm{Var}(D_i)}{n_b} = \\frac{2\\sigma_{w}^{2}}{n_b}\n$$\n代入 $n_b = N_{\\mathrm{RBD}}/2$：\n$$\n\\mathrm{Var}(\\hat{\\Delta}_{\\mathrm{RBD}}) = \\frac{2\\sigma_{w}^{2}}{N_{\\mathrm{RBD}}/2} = \\frac{4\\sigma_{w}^{2}}{N_{\\mathrm{RBD}}}\n$$\n为达到目标功效，我们需要：\n$$\nN_{\\mathrm{RBD}} = 4C\\sigma_{w}^{2}\n$$\n\n**3. 比率 $\\kappa$ 的推导**\n\n现在我们得到了用常数 $C$ 和方差分量表示的 $N_{\\mathrm{CRD}}$ 和 $N_{\\mathrm{RBD}}$ 的表达式。我们可以计算它们的比率：\n$$\n\\kappa = \\frac{N_{\\mathrm{RBD}}}{N_{\\mathrm{CRD}}} = \\frac{4C\\sigma_{w}^{2}}{4C(\\sigma_{b}^{2} + \\sigma_{w}^{2})}\n$$\n项 $4C$ 被约去，得到仅用方差分量表示的比率的解析表达式：\n$$\n\\kappa = \\frac{\\sigma_{w}^{2}}{\\sigma_{b}^{2} + \\sigma_{w}^{2}}\n$$\n\n**4. 数值计算**\n\n问题提供了数值 $\\sigma_{b}^{2} = 9$ 和 $\\sigma_{w}^{2} = 16$。将这些值代入 $\\kappa$ 的表达式中：\n$$\n\\kappa = \\frac{16}{9 + 16} = \\frac{16}{25}\n$$\n将此分数转换为小数，得到：\n$$\n\\kappa = 0.64\n$$\n问题要求答案四舍五入到四位有效数字。因此，我们将结果表示为：\n$$\n\\kappa = 0.6400\n$$\n该结果表明，要达到相同的统计功效，随机区组设计所需的动物总数仅为完全随机设计的 $64\\%$，这证明了当存在非零的区组间方差时，通过区组设计可以提高效率。", "answer": "$$\\boxed{0.6400}$$", "id": "4990302"}, {"introduction": "伤害-效益分析是动物研究伦理监督的一项基本要求，但通常是定性的。这项高级练习将挑战您使用基于决策理论的定量框架来形式化这一过程。通过构建一个融合了“3R”原则、转化成功概率和伦理权重的模型 [@problem_id:4990304]，您将学习如何构建和评估批准动物研究所固有的复杂权衡，从直观判断转向更明确、更具辩护性的分析。", "problem": "您需要使用基于决策理论和替代（Replacement）、减少（Reduction）、优化（Refinement）三大原则（3Rs）的明确定义的数学结构，为转化医学中的动物研究形式化一个伦理风险-效益分析。请从以下基本原则开始：(i) 期望效用理论，其中期望净值等于期望效益减去期望成本；(ii) 独立事件的概率乘法；以及 (iii) 动物的离散计数。构建一个程序，根据以下严格指定的定义，为每个提供的测试用例计算净伦理评分和最终的可接受性决策，除这些基本原则外，不使用任何领域特定的捷径。\n\n定义（所有符号和数字必须被视为数学实体）：\n- 替代、减少、优化 (3Rs)：这些原则按如下方式修改伤害输入。\n- 设每只动物的基线严重程度为 $s \\in [0,1]$。\n- 设优化分数为 $r \\in [0,1]$，并定义优化后的严重程度为 $s' = s \\cdot (1 - r)$。\n- 设初始动物数量为 $n \\in \\mathbb{N}$，减少分数为 $q \\in [0,1)$。\n- 设可被非动物替代方案替代的终点比例为 $a \\in [0,1]$；这会进一步减少使用的动物数量。\n- 定义调整后的动物数量为整数 $n' = \\left\\lceil n \\cdot (1 - q) \\cdot (1 - a) \\right\\rceil$，其中 $\\lceil \\cdot \\rceil$ 是向上取整函数。\n- 设归一化持续时间因子为 $d \\in (0,1]$，伤害-持续时间非线性指数为 $\\alpha \\ge 1$。总伤害为 $H = n' \\cdot s' \\cdot d^{\\alpha}$。\n- 设成功转化的期望效用量级为 $U  0$（以任意的、无单位的效用单位计）。\n- 设 $p_i \\in [0,1]$ 表示内部有效性（例如，可重复性）的概率，$p_e \\in [0,1]$ 表示外部有效性（对人类的相关性）的概率，$p_b \\in [0,1]$ 表示生物学合理性的先验概率。假设独立，则转化成功概率为 $p_t = p_i \\cdot p_e \\cdot p_b$。\n- 期望效益为 $B = U \\cdot p_t$。\n- 设 $\\lambda  0$ 为伤害规避权重，用于衡量伤害相对于效益的比例，净伦理评分为 $E = B - \\lambda \\cdot H$。\n- 伦理可接受性受三个约束条件制约：(1) 对于给定的阈值 $\\tau \\ge 0$，要求 $E \\ge \\tau$；(2) 对于最低转化可信度阈值 $t_{\\min} \\in [0,1]$，要求 $p_t \\ge t_{\\min}$；(3) 优化后的严重程度有上限，即对于给定的 $s_{\\cap} \\in (0,1]$，要求 $s' \\le s_{\\cap}$。\n- 替代执行规则：如果对于给定的 $\\rho \\in [0,1]$ 有 $a \\ge \\rho$ 且 $n'  0$，则无论其他数值如何，该研究都将被拒绝；如果 $n' = 0$，此替代规则不会导致拒绝。\n\n您的程序必须为每个测试用例计算：\n- 净伦理评分 $E$（浮点数）。\n- 一个布尔值决策，如果所有可接受性条件都满足则为 $\\text{True}$，否则为 $\\text{False}$。\n\n将每个 $E$ 四舍五入到3位小数。不涉及物理单位；所有量均为无量纲。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素本身是一个双元素列表 $[E, \\text{decision}]$。例如，您的输出格式必须与 $[[E_1,\\text{decision}_1],[E_2,\\text{decision}_2],\\ldots]$ 完全一样，且在同一行上。\n\n测试套件：\n使用以下5个测试用例，每个用例以有序参数元组 $(n, s, d, r, q, a, U, p_i, p_e, p_b, \\alpha, \\lambda, \\tau, t_{\\min}, s_{\\cap}, \\rho)$ 的形式提供。\n\n- 案例1（一般情况，预期可接受）：\n  $(60, 0.4, 0.5, 0.25, 0.2, 0.1, 100.0, 0.7, 0.5, 0.6, 1.2, 2.0, 5.0, 0.15, 0.6, 0.5)$\n- 案例2（低转化概率边界）：\n  $(30, 0.3, 0.4, 0.2, 0.1, 0.0, 120.0, 0.3, 0.2, 0.2, 1.0, 1.5, 5.0, 0.15, 0.6, 0.5)$\n- 案例3（违反严重程度上限）：\n  $(20, 0.9, 0.3, 0.1, 0.25, 0.0, 80.0, 0.6, 0.5, 0.5, 1.1, 1.0, 5.0, 0.15, 0.6, 0.5)$\n- 案例4（替代规则强制执行且 $n'  0$）：\n  $(50, 0.5, 0.6, 0.3, 0.2, 0.7, 200.0, 0.8, 0.6, 0.5, 1.0, 2.0, 5.0, 0.15, 0.6, 0.5)$\n- 案例5（完全替代和完全优化）：\n  $(10, 0.8, 0.7, 1.0, 0.5, 1.0, 30.0, 0.9, 0.7, 0.6, 1.3, 2.0, 5.0, 0.15, 0.6, 0.5)$\n\n您的程序必须精确执行这些定义，并生成一个单行列表 $[[E_1,\\text{decision}_1],[E_2,\\text{decision}_2],[E_3,\\text{decision}_3],[E_4,\\text{decision}_4],[E_5,\\text{decision}_5]]$，其中每个 $E_k$ 四舍五入到3位小数，每个 $\\text{decision}_k$ 是一个布尔值。", "solution": "该问题提出了一个用于在转化医学中对动物研究进行风险-效益分析的形式化框架。该框架基于决策理论的首要原则（特别是期望效用）构建，并结合了替代（Replacement）、减少（Reduction）和优化（Refinement）（即3R）的伦理原则。任务是实现这个框架作为一个计算模型，以评估一组假设的研究提案。\n\n该模型计算一个净伦理评分 $E$，并根据一系列预定义约束来确定一项研究的伦理可接受性。其逻辑首先是量化总伤害和期望效益，然后将它们组合成净评分，最后应用决策规则。\n\n计算结构如下：\n\n**伤害计算**\n总伤害 $H$ 是一个综合度量，反映了所用动物的数量、每只动物所受程序的严重程度以及研究的持续时间。\n\n1.  **优化后的严重程度 ($s'$)**：每只动物的基线严重程度 $s \\in [0,1]$ 通过优化措施得到缓解。优化分数 $r \\in [0,1]$ 量化了严重程度的比例减少。由此产生的优化后严重程度 $s'$ 由下式给出：\n    $$s' = s \\cdot (1 - r)$$\n\n2.  **调整后的动物数量 ($n'$)**：初始队列大小 $n \\in \\mathbb{N}$ 受两个因素影响而减少。减少分数 $q \\in [0,1)$ 代表通过改进实验设计直接减少动物数量。替代分数 $a \\in [0,1]$ 代表可以使用非动物方法评估的终点比例，从而进一步减少所需动物数量。最终调整后的动物数量 $n'$ 是不小于减少后数值的最小整数：\n    $$n' = \\left\\lceil n \\cdot (1 - q) \\cdot (1 - a) \\right\\rceil$$\n    其中 $\\lceil \\cdot \\rceil$ 表示向上取整函数。\n\n3.  **总伤害 ($H$)**：总伤害是通过将优化后的严重程度在调整后的动物数量上进行累加，并受研究持续时间调控而计算得出。归一化持续时间因子为 $d \\in (0,1]$，其对伤害的影响通过指数 $\\alpha \\ge 1$ 变为非线性。因此，总伤害 $H$ 为：\n    $$H = n' \\cdot s' \\cdot d^{\\alpha}$$\n\n**效益计算**\n期望效益 $B$ 是成功研究成果的潜在效用，并按其成功概率进行折算。\n\n1.  **转化成功概率 ($p_t$)**：一项研究产生可转化、有益成果的概率被建模为三个独立概率的乘积：内部有效性概率 $p_i \\in [0,1]$；外部有效性（与人类的相关性）概率 $p_e \\in [0,1]$；以及生物学合理性的先验概率 $p_b \\in [0,1]$。因此，转化成功概率 $p_t$ 为：\n    $$p_t = p_i \\cdot p_e \\cdot p_b$$\n\n2.  **期望效益 ($B$)**：期望效益是成功转化的效用量级 $U  0$ 与该成功概率 $p_t$ 的乘积。\n    $$B = U \\cdot p_t$$\n\n**净伦理评分与决策框架**\n最终的可接受性决策取决于一个净伦理评分和一系列绝对约束。\n\n1.  **净伦理评分 ($E$)**：该评分使用期望效用框架计算。它是期望效益 $B$ 减去总伤害 $H$，其中伤害被一个伤害规避权重 $\\lambda  0$ 加权。该权重代表了相对于获得效益而言，在伦理上对避免伤害的重视程度。\n    $$E = B - \\lambda \\cdot H$$\n\n2.  **伦理可接受性条件**：一项研究只有在同时满足以下所有四个条件时才被视为可接受：\n    - **替代执行规则**：如果研究的很大一部分是可替代的（对于给定的阈值 $\\rho \\in [0,1]$，$a \\ge \\rho$），但仍在使用动物（$n'  0$），则该研究被直接拒绝。如果 $n' = 0$，则不触发此条件。\n    - **严重程度上限**：优化后的每只动物的严重程度不得超过预定上限 $s_{\\cap} \\in (0,1]$。这为动物的痛苦设定了一个绝对限制，无论潜在效益如何。条件是 $s' \\le s_{\\cap}$。\n    - **转化可信度阈值**：转化成功的概率 $p_t$ 必须达到一个最低阈值 $t_{\\min} \\in [0,1]$。这可以防止成功机会极低的研究。条件是 $p_t \\ge t_{\\min}$。\n    - **净评分阈值**：净伦理评分 $E$ 必须为非负或超过一个指定的阈值 $\\tau \\ge 0$。这确保了期望效益能够证明加权后的伤害是合理的。条件是 $E \\ge \\tau$。\n\n每个案例的最终输出是计算出的评分 $E$（四舍五入到3位小数）和一个布尔值决策，指示是否满足所有可接受性条件。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a net ethical score and acceptability decision for animal studies\n    based on a formal harm-benefit analysis framework.\n    \"\"\"\n    # Test cases as tuples of parameters:\n    # (n, s, d, r, q, a, U, p_i, p_e, p_b, alpha, lambda, tau, t_min, s_cap, rho)\n    test_cases = [\n        (60, 0.4, 0.5, 0.25, 0.2, 0.1, 100.0, 0.7, 0.5, 0.6, 1.2, 2.0, 5.0, 0.15, 0.6, 0.5),\n        (30, 0.3, 0.4, 0.2, 0.1, 0.0, 120.0, 0.3, 0.2, 0.2, 1.0, 1.5, 5.0, 0.15, 0.6, 0.5),\n        (20, 0.9, 0.3, 0.1, 0.25, 0.0, 80.0, 0.6, 0.5, 0.5, 1.1, 1.0, 5.0, 0.15, 0.6, 0.5),\n        (50, 0.5, 0.6, 0.3, 0.2, 0.7, 200.0, 0.8, 0.6, 0.5, 1.0, 2.0, 5.0, 0.15, 0.6, 0.5),\n        (10, 0.8, 0.7, 1.0, 0.5, 1.0, 30.0, 0.9, 0.7, 0.6, 1.3, 2.0, 5.0, 0.15, 0.6, 0.5)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters with descriptive names\n        (n, s, d, r, q, a, U, p_i, p_e, p_b, alpha, \n         lambda_harm, tau, t_min, s_cap, rho) = case\n        \n        # --- Harm Calculation ---\n        # 1. Refined Severity (s')\n        s_refined = s * (1 - r)\n        \n        # 2. Adjusted Number of Animals (n')\n        n_adj = np.ceil(n * (1 - q) * (1 - a))\n        \n        # 3. Total Harm (H)\n        H = n_adj * s_refined * (d ** alpha)\n        \n        # --- Benefit Calculation ---\n        # 1. Translational Success Probability (p_t)\n        p_t = p_i * p_e * p_b\n        \n        # 2. Expected Benefit (B)\n        B = U * p_t\n\n        # --- Net Ethical Score ---\n        E = B - lambda_harm * H\n        \n        # --- Ethical Acceptability Conditions ---\n        # Condition 1: Replacement Enforcement Rule\n        # Rejection if a >= rho AND n' > 0. So, acceptance needs NOT(this).\n        cond1_replacement = not (a >= rho and n_adj > 0)\n        \n        # Condition 2: Severity Cap\n        cond2_severity = s_refined = s_cap\n        \n        # Condition 3: Translational Credibility Threshold\n        cond3_probability = p_t >= t_min\n        \n        # Condition 4: Net Score Threshold\n        cond4_score = E >= tau\n\n        # Final Decision: All conditions must be met.\n        is_acceptable = cond1_replacement and cond2_severity and cond3_probability and cond4_score\n        \n        # Round the score to 3 decimal places\n        E_rounded = round(E, 3)\n        \n        # Append the result pair to the list\n        results.append([E_rounded, is_acceptable])\n\n    # Format the final output string exactly as required\n    # Based on the re-calculated values:\n    # [[9.514, True], [-2.448, False], [8.744, False], [42.96, False], [11.34, True]]\n    # Python's default str() for lists and booleans matches the required format.\n    output_str = f\"[{','.join(str(res) for res in results)}]\"\n    \n    # This print statement is for demonstration; the content will be placed in the XML.\n    # print(output_str)\n    # The actual output string from running this corrected code:\n    # [[9.514, True], [-2.448, False], [8.744, False], [42.96, False], [11.34, True]]\n\n# This function is not called directly in the final XML, but its logic is what's being presented.\n# The `answer` tag contains the code itself.\nsolve()\n```", "id": "4990304"}]}