{"hands_on_practices": [{"introduction": "替代终点与真实临床终点之间存在密切的生物学关联，但这并不能保证它对于评估新疗法有效性是一个可靠的指标。本练习将通过一个量化实例，阐明一种疗法为何可能在改善替代终点的同时，通过脱靶效应（off-target effect）对临床结局造成实际伤害[@problem_id:5074986]。这个例子突显了对替代终点进行严格的正式验证至关重要。", "problem": "考虑一项转化研究，旨在评估一种旨在降低低密度脂蛋白胆固醇 (LDL-C) 的新疗法 $A$。LDL-C 是一种被提议作为预防心肌梗死的替代终点 (SE) $S$ 的生物标志物。真实临床终点 (TCE) $T$ 是一年内发生主要不良心脏事件 (MACE) 的概率。假设TCE服从一个线性概率模型（该模型在早期转化研究中常用于中介效应的直观理解），并假设替代终点在治疗下服从一个简单的移位模型：\n$$\n\\Pr(T=1 \\mid A,S) \\;=\\; p_0 \\;+\\; \\beta_{A} A \\;+\\; \\beta_{\\text{tox}} A \\;+\\; \\beta_{S}\\,\\big(S - \\mu_0\\big),\n$$\n$$\nS \\;=\\; \\mu_0 \\;+\\; \\gamma_{A} A \\;+\\; \\varepsilon,\n$$\n其中 $\\mathbb{E}[\\varepsilon]=0$，且 $A \\in \\{0,1\\}$ 表示对照组 ($A=0$) 或治疗组 ($A=1$) 。在此，$p_0$ 是对照组的基线风险，$\\mu_0$ 是对照组的平均LDL-C水平，$\\beta_{S}$ 捕捉了LDL-C与MACE风险在风险差尺度上的关联，$\\beta_{A}$ 是 $A$ 对 $T$ 的任何非经由 $S$ 介导的残余靶向效应，而 $\\beta_{\\text{tox}}$ 捕捉了 $A$ 对 $T$ 的独立于 $S$ 的脱靶毒性效应（例如，致心律失常倾向）。\n\n假设在晚期“生物标志物到结局”的转化研究中观察到以下科学上合理的参数值：\n- 基线事件风险: $p_0 = 0.15$。\n- 对照组平均LDL-C: $\\mu_0 = 130$ $\\text{mg}\\cdot\\text{dL}^{-1}$。\n- 治疗使LDL-C下降: $\\gamma_{A} = -30$ $\\text{mg}\\cdot\\text{dL}^{-1}$。\n- 对LDL-C的风险敏感性: $\\beta_{S} = 0.003$ 每 $\\text{mg}\\cdot\\text{dL}^{-1}$ (在风险尺度上作加性解释)。\n- 非经由LDL-C的残余靶向效应: $\\beta_{A} = 0$。\n- 对MACE风险的脱靶毒性: $\\beta_{\\text{tox}} = 0.19$。\n\n从这些定义和模型出发，推导对真实临床终点的边际平均治疗效应，即 $A=1$ 和 $A=0$ 之间 $T$ 的风险差，\n$$\n\\Delta_T \\;=\\; \\mathbb{E}\\big[\\Pr(T=1 \\mid A=1,S)\\big] \\;-\\; \\mathbb{E}\\big[\\Pr(T=1 \\mid A=0,S)\\big],\n$$\n并计算其数值。将您的答案四舍五入到四位有效数字，并以小数形式表示风险差。您的推导过程应清楚地说明，为何尽管替代终点 $S$ 有显著改善，且大部分治疗效应可由 $S$ 解释，但由于脱靶项 $\\beta_{\\text{tox}}$ 的存在，对 $T$ 的净临床效应仍可能是有害的。", "solution": "用户提供了一个有效且定义明确的问题，该问题基于生物统计学和转化医学的原理。所有必要的模型、参数和定义均已提供，不存在内部矛盾或科学缺陷。因此，我将给出一个完整的解答。\n\n目标是推导并计算对真实临床终点 (TCE) 的边际平均治疗效应，记为 $\\Delta_T$。该量定义为治疗组 ($A=1$) 与对照组 ($A=0$) 之间发生主要不良心脏事件 (MACE) 的期望概率之差。数学上，这表示为：\n$$\n\\Delta_T = \\mathbb{E}\\big[\\Pr(T=1 \\mid A=1,S)\\big] - \\mathbb{E}\\big[\\Pr(T=1 \\mid A=0,S)\\big]\n$$\n期望 $\\mathbb{E}[\\cdot]$ 是在给定治疗指标 $A$ 的值下，对替代终点 (SE) $S$ 的分布求得的。\n\n问题提供了以下模型和参数值：\nTCE $T$ 的条件概率：\n$$\n\\Pr(T=1 \\mid A,S) = p_0 + \\beta_{A} A + \\beta_{\\text{tox}} A + \\beta_{S}\\,(S - \\mu_0)\n$$\nSE $S$ 的模型：\n$$\nS = \\mu_0 + \\gamma_{A} A + \\varepsilon, \\quad \\text{with } \\mathbb{E}[\\varepsilon]=0\n$$\n参数值为：\n$p_0 = 0.15$，$\\mu_0 = 130$，$\\gamma_{A} = -30$，$\\beta_{S} = 0.003$，$\\beta_{A} = 0$ 以及 $\\beta_{\\text{tox}} = 0.19$。\n\n首先，我们计算 $\\Delta_T$ 的第一项，即治疗组 ($A=1$) 中的期望风险。这包括将 $A=1$ 代入 $\\Pr(T=1 \\mid A,S)$ 的模型，然后对当 $A=1$ 时 $S$ 的分布求期望。\n对于 $A=1$，条件概率为：\n$$\n\\Pr(T=1 \\mid A=1, S) = p_0 + \\beta_{A}(1) + \\beta_{\\text{tox}}(1) + \\beta_{S}\\,(S - \\mu_0) = p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\,(S - \\mu_0)\n$$\n现在，我们对这个量求期望。根据期望的线性性质，我们有：\n$$\n\\mathbb{E}\\big[\\Pr(T=1 \\mid A=1,S)\\big] = \\mathbb{E}\\big[p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\,(S - \\mu_0) \\mid A=1\\big]\n$$\n$$\n= p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\,\\mathbb{E}[S - \\mu_0 \\mid A=1]\n$$\n$$\n= p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\,(\\mathbb{E}[S \\mid A=1] - \\mu_0)\n$$\n为了求 $\\mathbb{E}[S \\mid A=1]$，我们使用 $S$ 的模型：\n$$\n\\mathbb{E}[S \\mid A=1] = \\mathbb{E}[\\mu_0 + \\gamma_{A}(1) + \\varepsilon] = \\mu_0 + \\gamma_{A} + \\mathbb{E}[\\varepsilon]\n$$\n因为 $\\mathbb{E}[\\varepsilon]=0$，所以我们有 $\\mathbb{E}[S \\mid A=1] = \\mu_0 + \\gamma_{A}$。将此代回期望风险的表达式中：\n$$\n\\mathbb{E}\\big[\\Pr(T=1 \\mid A=1,S)\\big] = p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\,((\\mu_0 + \\gamma_{A}) - \\mu_0)\n$$\n$$\n\\mathbb{E}\\big[\\Pr(T=1 \\mid A=1,S)\\big] = p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\gamma_{A}\n$$\n\n接下来，我们计算 $\\Delta_T$ 的第二项，即对照组 ($A=0$) 中的期望风险。我们将 $A=0$ 代入 $\\Pr(T=1 \\mid A,S)$ 的模型，并对当 $A=0$ 时 $S$ 的分布求期望。\n对于 $A=0$，条件概率为：\n$$\n\\Pr(T=1 \\mid A=0, S) = p_0 + \\beta_{A}(0) + \\beta_{\\text{tox}}(0) + \\beta_{S}\\,(S - \\mu_0) = p_0 + \\beta_{S}\\,(S - \\mu_0)\n$$\n求期望：\n$$\n\\mathbb{E}\\big[\\Pr(T=1 \\mid A=0,S)\\big] = \\mathbb{E}\\big[p_0 + \\beta_{S}\\,(S - \\mu_0) \\mid A=0\\big] = p_0 + \\beta_{S}\\,(\\mathbb{E}[S \\mid A=0] - \\mu_0)\n$$\n为了求 $\\mathbb{E}[S \\mid A=0]$，我们使用 $S$ 的模型：\n$$\n\\mathbb{E}[S \\mid A=0] = \\mathbb{E}[\\mu_0 + \\gamma_{A}(0) + \\varepsilon] = \\mu_0 + \\mathbb{E}[\\varepsilon] = \\mu_0\n$$\n将此代回：\n$$\n\\mathbb{E}\\big[\\Pr(T=1 \\mid A=0,S)\\big] = p_0 + \\beta_{S}\\,(\\mu_0 - \\mu_0) = p_0\n$$\n\n最后，我们通过从治疗组的期望风险中减去对照组的期望风险来计算 $\\Delta_T$：\n$$\n\\Delta_T = (p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\gamma_{A}) - p_0\n$$\n$$\n\\Delta_T = \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\gamma_{A}\n$$\n该表达式将总平均治疗效应分解为其组成部分。项 $\\beta_{S}\\gamma_{A}$ 代表通过替代终点 $S$ 介导的那部分效应。项 $\\beta_A$ 和 $\\beta_{\\text{tox}}$ 代表治疗对真实终点 $T$ 的非经由 $S$ 介导的直接效应。\n\n按照要求，我们可以使用这个公式来理解为什么替代终点的改善不一定保证净临床获益。项 $\\beta_{S}\\gamma_{A}$ 代表通过降低LDL-C介导的有益效应。当 $\\beta_S > 0$ (较高的LDL-C是不好的) 且 $\\gamma_A  0$ (治疗降低了LDL-C) 时，该乘积为负，表示风险降低。然而，项 $\\beta_{\\text{tox}}$ 代表一个独立的、有害的脱靶效应。如果这个正值项的绝对值大于有益的中介效应，净效应 $\\Delta_T$ 将为正，表示风险总体增加，治疗是有害的。\n\n现在，我们将给定的数值代入推导出的公式中：\n$\\beta_{A} = 0$，$\\beta_{\\text{tox}} = 0.19$，$\\beta_{S} = 0.003$ 以及 $\\gamma_{A} = -30$。\n$$\n\\Delta_T = 0 + 0.19 + (0.003) \\times (-30)\n$$\n$$\n\\Delta_T = 0.19 - 0.09\n$$\n$$\n\\Delta_T = 0.10\n$$\n$\\Delta_T$ 的正值表示该疗法平均而言增加了MACE的风险。通过替代终点介导的有益效应（风险降低0.09）被有害的脱靶毒性（风险增加0.19）所抵消并超过，导致净效应为有害。\n\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta_T = 0.1000\n$$", "answer": "$$\n\\boxed{0.1000}\n$$", "id": "5074986"}, {"introduction": "认识到替代终点的潜在陷阱后，我们自然会问：如何正式地验证其有效性？本练习介绍了一种核心的统计验证方法，重点关注试验水平的决定系数 $R^2_{\\text{trial}}$ [@problem_id:5074943]。这一来自多项试验荟萃分析的关键指标，量化了治疗对替代终点的效应在多大程度上能够预测其对真实临床终点的效应。通过亲手计算，您还将学习如何估计该验证指标的不确定性，这是解读其可靠性的关键一步。", "problem": "在一组评估候选替代终点 $S$ 和真实临床终点 $T$ 的 $n$ 个独立随机对照试验中，令 $y_{Si}$ 和 $y_{Ti}$ 表示在对数风险比尺度上观测到的试验 $i$ 的治疗效应，每个效应的测量都带有试验内的抽样变异性。假设一个跨试验验证模型设定了未观测到的真实试验水平效应之间的如下关系：\n$$\nT_i \\;=\\; \\alpha \\;+\\; \\beta\\, S_i \\;+\\; u_i,\\quad u_i \\sim \\mathcal{N}(0,\\tau^2),\\quad i=1,\\dots,n,\n$$\n其中 $u_i$ 与 $S_i$ 独立。试验水平决定系数定义为\n$$\nR^2_{\\text{trial}} \\;=\\; \\frac{\\beta^2\\,\\operatorname{Var}(S_i)}{\\beta^2\\,\\operatorname{Var}(S_i) + \\tau^2},\n$$\n其中 $\\operatorname{Var}(S_i)$ 表示真实替代效应的试验间方差。假设对 $\\{(y_{Si},y_{Ti})\\}_{i=1}^n$ 的双变量荟萃分析综合（考虑了试验内抽样方差）已分别为 $\\beta$、$\\tau^2$ 和 $\\operatorname{Var}(S_i)$ 生成了相合估计 $\\widehat{\\beta}$、$\\widehat{\\tau}^2$ 和 $\\widehat{\\sigma}_S^2$，以及 $(\\widehat{\\beta},\\widehat{\\tau}^2,\\widehat{\\sigma}_S^2)^{\\top}$ 的估计渐近方差-协方差矩阵。\n\n对于一个特定应用，估计的参数及其大样本不确定性为：\n- $\\widehat{\\beta} = 0.9$，\n- $\\widehat{\\tau}^2 = 0.01$，\n- $\\widehat{\\sigma}_S^2 = 0.04$，\n且估计的渐近方差-协方差矩阵（在此分析中假设为对角矩阵）为\n$$ \\widehat{\\mathbf{V}} = \\begin{pmatrix} 0.0225  0  0 \\\\[4pt] 0  0.0001  0 \\\\[4pt] 0  0  0.0004 \\end{pmatrix}. $$\n\n使用上述模型定义和 delta 方法的基本原理，计算点估计 $\\widehat{R}^2_{\\text{trial}}$，并推导 $\\widehat{R}^2_{\\text{trial}}$ 的渐近方差的一阶 delta 方法表达式，该表达式是 $(\\widehat{\\beta},\\widehat{\\tau}^2,\\widehat{\\sigma}_S^2)$ 和 $\\widehat{\\mathbf{V}}$ 的函数。然后，使用给定的数值评估此方差。仅报告 $\\widehat{R}^2_{\\text{trial}}$ 的数值，四舍五入到四位有效数字，以小数形式表示（不带百分号）。", "solution": "该问题被评估为有效。这是一个适定的、有科学依据的生物统计学问题，提供了所有必要信息并使用了清晰、客观的语言。任务是使用一种标准的统计方法（delta 方法）计算一个点估计，并推导和评估其渐近方差。\n\n### 步骤1：计算点估计 $\\widehat{R}^2_{\\text{trial}}$\n\n问题将试验水平决定系数定义为：\n$$\nR^2_{\\text{trial}} \\;=\\; \\frac{\\beta^2\\,\\operatorname{Var}(S_i)}{\\beta^2\\,\\operatorname{Var}(S_i) + \\tau^2}\n$$\n为了求点估计 $\\widehat{R}^2_{\\text{trial}}$，我们将提供的估计值 $\\widehat{\\beta}$、$\\widehat{\\tau}^2$ 和 $\\widehat{\\sigma}_S^2$（即 $\\operatorname{Var}(S_i)$ 的估计值）代入此公式。\n\n给定的估计值为：\n- $\\widehat{\\beta} = 0.9$\n- $\\widehat{\\tau}^2 = 0.01$\n- $\\widehat{\\sigma}_S^2 = 0.04$\n\n代入这些值：\n$$\n\\widehat{R}^2_{\\text{trial}} \\;=\\; \\frac{\\widehat{\\beta}^2 \\widehat{\\sigma}_S^2}{\\widehat{\\beta}^2 \\widehat{\\sigma}_S^2 + \\widehat{\\tau}^2} \\;=\\; \\frac{(0.9)^2 (0.04)}{(0.9)^2 (0.04) + 0.01}\n$$\n首先，我们计算分子和分母中的各项：\n$$\n\\widehat{\\beta}^2 \\widehat{\\sigma}_S^2 \\;=\\; (0.81)(0.04) \\;=\\; 0.0324\n$$\n因此，表达式变为：\n$$\n\\widehat{R}^2_{\\text{trial}} \\;=\\; \\frac{0.0324}{0.0324 + 0.01} \\;=\\; \\frac{0.0324}{0.0424}\n$$\n计算最终值：\n$$\n\\widehat{R}^2_{\\text{trial}} \\approx 0.764150943...\n$$\n问题要求将此值四舍五入到四位有效数字。\n$$\n\\widehat{R}^2_{\\text{trial}} \\approx 0.7642\n$$\n\n### 步骤2：推导和评估 $\\widehat{R}^2_{\\text{trial}}$ 的渐近方差\n\n我们使用多元 delta 方法来求 $\\widehat{R}^2_{\\text{trial}}$ 的渐近方差。令参数向量为 $\\boldsymbol{\\theta} = (\\beta, \\tau^2, \\sigma_S^2)^{\\top}$。估计量为 $\\widehat{\\boldsymbol{\\theta}} = (\\widehat{\\beta}, \\widehat{\\tau}^2, \\widehat{\\sigma}_S^2)^{\\top}$。目标函数是 $g(\\boldsymbol{\\theta}) = R^2_{\\text{trial}}$。\n\n$g(\\widehat{\\boldsymbol{\\theta}})$ 的渐近方差由下式给出：\n$$\n\\operatorname{Var}(g(\\widehat{\\boldsymbol{\\theta}})) \\approx [\\nabla g(\\boldsymbol{\\theta})]^{\\top} \\mathbf{V} [\\nabla g(\\boldsymbol{\\theta})]\n$$\n其中 $\\nabla g(\\boldsymbol{\\theta})$ 是 $g$ 关于 $\\boldsymbol{\\theta}$ 的梯度，$\\mathbf{V}$ 是 $\\widehat{\\boldsymbol{\\theta}}$ 的方差-协方差矩阵。我们在估计值处评估此表达式，因此我们使用 $\\nabla g(\\widehat{\\boldsymbol{\\theta}})$ 和 $\\widehat{\\mathbf{V}}$。\n\n首先，我们必须计算梯度向量 $\\nabla g = \\left( \\frac{\\partial g}{\\partial \\beta}, \\frac{\\partial g}{\\partial \\tau^2}, \\frac{\\partial g}{\\partial \\sigma_S^2} \\right)^{\\top}$。\n令 $D = \\beta^2 \\sigma_S^2 + \\tau^2$。函数为 $g = \\frac{\\beta^2 \\sigma_S^2}{D}$。\n\n偏导数是：\n1.  关于 $\\beta$：\n    $$\n    \\frac{\\partial g}{\\partial \\beta} = \\frac{(2\\beta\\sigma_S^2)D - (\\beta^2\\sigma_S^2)(2\\beta\\sigma_S^2)}{D^2} = \\frac{2\\beta\\sigma_S^2(D - \\beta^2\\sigma_S^2)}{D^2} = \\frac{2\\beta\\sigma_S^2\\tau^2}{D^2}\n    $$\n2.  关于 $\\tau^2$：\n    $$\n    \\frac{\\partial g}{\\partial \\tau^2} = \\frac{0 \\cdot D - (\\beta^2\\sigma_S^2)(1)}{D^2} = \\frac{-\\beta^2\\sigma_S^2}{D^2}\n    $$\n3.  关于 $\\sigma_S^2$：\n    $$\n    \\frac{\\partial g}{\\partial \\sigma_S^2} = \\frac{(\\beta^2)D - (\\beta^2\\sigma_S^2)(\\beta^2)}{D^2} = \\frac{\\beta^2(D - \\beta^2\\sigma_S^2)}{D^2} = \\frac{\\beta^2\\tau^2}{D^2}\n    $$\n问题指出，估计的方差-协方差矩阵 $\\widehat{\\mathbf{V}}$ 是对角矩阵：\n$$\n\\widehat{\\mathbf{V}} \\;=\\; \\begin{pmatrix}\n\\operatorname{Var}(\\widehat{\\beta})   0  0 \\\\\n0  \\operatorname{Var}(\\widehat{\\tau}^2)  0 \\\\\n0  0  \\operatorname{Var}(\\widehat{\\sigma}_S^2)\n\\end{pmatrix}\n$$\n因此，方差公式简化为和的形式：\n$$\n\\operatorname{Var}(\\widehat{R}^2_{\\text{trial}}) \\approx \\left(\\frac{\\partial g}{\\partial \\beta}\\right)^2 \\operatorname{Var}(\\widehat{\\beta}) + \\left(\\frac{\\partial g}{\\partial \\tau^2}\\right)^2 \\operatorname{Var}(\\widehat{\\tau}^2) + \\left(\\frac{\\partial g}{\\partial \\sigma_S^2}\\right)^2 \\operatorname{Var}(\\widehat{\\sigma}_S^2)\n$$\n现在，我们使用给定的数值来评估此表达式。所有偏导数都在参数估计值处进行评估。\n分母项是 $D_{est} = \\widehat{\\beta}^2\\widehat{\\sigma}_S^2 + \\widehat{\\tau}^2 = 0.0424$。其平方是 $D_{est}^2 \\approx 0.00179776$。\n方差为 $\\operatorname{Var}(\\widehat{\\beta}) = 0.0225$，$\\operatorname{Var}(\\widehat{\\tau}^2) = 0.0001$ 和 $\\operatorname{Var}(\\widehat{\\sigma}_S^2) = 0.0004$。\n\n让我们在估计值处计算每个偏导数的值：\n- $\\frac{\\partial g}{\\partial \\beta}|_{est} = \\frac{2(0.9)(0.04)(0.01)}{(0.0424)^2} = \\frac{0.00072}{0.00179776} \\approx 400.498$\n- $\\frac{\\partial g}{\\partial \\tau^2}|_{est} = \\frac{-(0.9)^2(0.04)}{(0.0424)^2} = \\frac{-0.0324}{0.00179776} \\approx -18022.4$\n- $\\frac{\\partial g}{\\partial \\sigma_S^2}|_{est} = \\frac{(0.9)^2(0.01)}{(0.0424)^2} = \\frac{0.0081}{0.00179776} \\approx 4505.6$\n\n将这些代入方差公式：\n$\\operatorname{Var}(\\widehat{R}^2_{\\text{trial}}) \\approx (400.498)^2(0.0225) + (-18022.4)^2(0.0001) + (4505.6)^2(0.0004)$\n为了避免中间的舍入误差，我们更精确地进行计算。\n$\\operatorname{Var}(\\widehat{R}^2_{\\text{trial}}) \\approx \\frac{1}{(D_{est})^4} \\left[ (2\\widehat{\\beta}\\widehat{\\sigma}_S^2\\widehat{\\tau}^2)^2 \\operatorname{Var}(\\widehat{\\beta}) + (-\\widehat{\\beta}^2\\widehat{\\sigma}_S^2)^2 \\operatorname{Var}(\\widehat{\\tau}^2) + (\\widehat{\\beta}^2\\widehat{\\tau}^2)^2 \\operatorname{Var}(\\widehat{\\sigma}_S^2) \\right]$\n$D_{est}^4 \\approx (0.00179776)^2 \\approx 3.2319456 \\times 10^{-6}$。\n\n分子项：\n- $(2(0.9)(0.04)(0.01))^2 (0.0225) = (0.00072)^2 (0.0225) = (5.184 \\times 10^{-7})(0.0225) = 1.1664 \\times 10^{-8}$\n- $(-(0.9)^2(0.04))^2 (0.0001) = (-0.0324)^2 (0.0001) = (0.00104976)(0.0001) = 1.04976 \\times 10^{-7}$\n- $((0.9)^2(0.01))^2 (0.0004) = (0.0081)^2 (0.0004) = (0.00006561)(0.0004) = 2.6244 \\times 10^{-8}$\n\n分子项之和：\n$1.1664 \\times 10^{-8} + 1.04976 \\times 10^{-7} + 2.6244 \\times 10^{-8} = 1.42884 \\times 10^{-7}$\n\n最后，方差是：\n$$\n\\operatorname{Var}(\\widehat{R}^2_{\\text{trial}}) \\approx \\frac{1.42884 \\times 10^{-7}}{3.2319456 \\times 10^{-6}} \\approx 0.044209\n$$\n这给出的渐近标准误为 $\\sqrt{0.044209} \\approx 0.210$。这个值是合理的，尽管 $\\widehat{R}^2_{\\text{trial}}$ 对应的置信区间会很宽，并且会超出理论最大值 $1$，这表明对于给定的样本量和参数不确定性，正态近似可能不精确。\n\n问题要求只报告 $\\widehat{R}^2_{\\text{trial}}$ 的数值。", "answer": "$$\n\\boxed{0.7642}\n$$", "id": "5074943"}, {"introduction": "一旦替代终点的关系得到验证和量化，下一步就是将其应用于实际的研发决策中。最后的这个练习将向您展示如何利用荟萃分析模型来定义“替代终点阈值效应”（Surrogate Threshold Effect, STE）[@problem_id:5075034]。计算STE能帮助我们将观测到的替代终点效应值，转化为一个预测有意义临床获益的具体基准，为药物开发中的“继续/终止”决策提供了一个强有力的量化工具。", "problem": "一项转化研究评估了一个连续生物标志物替代终点 $S$ 对于一个以患者为中心的连续真实终点 $T$ 的替代效果，其中对于 $S$ 和 $T$ 而言，较大的正值均表示更大的临床获益。在试验层面，跨随机试验的 $T$ 上的治疗效果被建模为基于 $S$ 上的治疗效果的线性随机效应荟萃回归：\n$$\n\\Delta_T \\;=\\; \\alpha \\;+\\; \\beta\\,\\Delta_S \\;+\\; \\varepsilon,\n$$\n其中 $\\varepsilon \\sim \\mathcal{N}(0,\\tau^{2})$ 代表试验间的异质性。参数是从 $K$ 个独立试验中估计得到的，得到具有大样本联合正态性的 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$，以及以下估计量：\n- $\\hat{\\alpha} = 0.05$，\n- $\\hat{\\beta} = 0.80$，\n- $\\operatorname{Var}(\\hat{\\alpha}) = 0.0025$，\n- $\\operatorname{Var}(\\hat{\\beta}) = 0.04$，\n- $\\operatorname{Cov}(\\hat{\\alpha},\\hat{\\beta}) = -0.005$，\n- $\\hat{\\tau}^{2} = 0.04$。\n\n假设自由度为 $\\nu = 18$ 的 Student $t$ 分布可近似一个新试验的预测不确定性，并使用双侧 $0.95$ 临界值 $t_{0.975,18} = 2.101$。将替代阈值效应 (Surrogate Threshold Effect, STE) 定义为替代效应 $\\Delta_S$ 的最小值 $s^{\\star}$，使得当 $\\Delta_S = s^{\\star}$ 时，新试验真实效果 $\\Delta_T$ 的 $0.95$ 预测区间的下界严格大于 $0$。\n\n一种新疗法显示出观测到的替代效应为 $s_{\\text{obs}} = 0.55$（以标准差为单位）。在上述模型和假设下，计算 STE $s^{\\star}$。用标准差单位表示您的答案。将答案四舍五入至四位有效数字。", "solution": "首先根据指定标准对问题进行验证。\n\n### 第一步：提取已知条件\n- 将真实终点效应 $\\Delta_T$ 与替代终点效应 $\\Delta_S$ 关联的模型是一个线性随机效应荟萃回归：$\\Delta_T = \\alpha + \\beta\\,\\Delta_S + \\varepsilon$。\n- 试验间异质性项 $\\varepsilon$ 服从正态分布：$\\varepsilon \\sim \\mathcal{N}(0,\\tau^{2})$。\n- 从 $K$ 个独立试验中估计的参数为：\n  - $\\hat{\\alpha} = 0.05$\n  - $\\hat{\\beta} = 0.80$\n- 估计量的大样本方差-协方差矩阵由下式给出：\n  - $\\operatorname{Var}(\\hat{\\alpha}) = 0.0025$\n  - $\\operatorname{Var}(\\hat{\\beta}) = 0.04$\n  - $\\operatorname{Cov}(\\hat{\\alpha},\\hat{\\beta}) = -0.005$\n- 估计的试验间异质性方差为 $\\hat{\\tau}^{2} = 0.04$。\n- 预测不确定性由自由度为 $\\nu = 18$ 的 Student $t$ 分布近似。\n- 双侧 $0.95$ 临界值为 $t_{0.975,18} = 2.101$。\n- 替代阈值效应 (STE)，记为 $s^{\\star}$，被定义为替代效应 $\\Delta_S$ 的最小值，使得新试验真实效应 $\\Delta_T$ 的 $0.95$ 预测区间的下界严格大于 $0$。\n- 一种新疗法的观测替代效应为 $s_{\\text{obs}} = 0.55$。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题使用了在临床试验和转化医学中用于替代终点统计验证的标准荟萃回归模型。使用预测区间量化新试验的不确定性以及替代阈值效应的定义是该领域已确立的方法。所有组成部分在科学和统计上都是合理的。\n- **适定性**：该问题提供了所有必需的数值，并对待计算量（$s^{\\star}$）给出了清晰、无歧义的定义。该定义导出一个可解的数学方程。包含 $s_{\\text{obs}}$ 是额外信息，但不会产生矛盾；它与计算 $s^{\\star}$ 无关。\n- **客观性**：该问题使用精确的、定量的语言陈述，没有主观性或模糊性。\n\n### 第三步：结论与行动\n该问题是有效的。它具有科学依据、适定性且客观。将提供完整的解答。\n\n### 解题过程推导\n目标是计算替代阈值效应 $s^{\\star}$。这是替代效应 $\\Delta_S$ 的一个值，在该值上，真实效应 $\\Delta_T$ 的 $0.95$ 预测区间的下限等于 $0$。\n\n对于一个给定替代效应 $\\Delta_S$ 的新试验，预测的真实效应由拟合的回归线给出：\n$$\n\\hat{\\Delta}_T(\\Delta_S) = \\hat{\\alpha} + \\hat{\\beta}\\Delta_S\n$$\n这个新试验中真实效应 $\\Delta_{T, \\text{new}}$ 的一个 $0.95$ 预测区间由下式给出：\n$$\n\\hat{\\Delta}_T(\\Delta_S) \\pm t_{0.975, \\nu} \\times \\text{SE}(\\text{prediction})\n$$\n其中 $\\text{SE}(\\text{prediction})$ 是预测的标准误。该标准误考虑了两个不确定性来源：\n1. 估计的回归参数（$\\hat{\\alpha}$ 和 $\\hat{\\beta}$）的不确定性。\n2. 由 $\\tau^2$ 代表的固有的试验间变异性。\n\n预测误差 $\\hat{\\Delta}_T - \\Delta_{T, \\text{new}}$ 的方差是拟合值方差与试验间方差之和：\n$$\n\\text{Var}(\\text{prediction}) = \\text{Var}(\\hat{\\alpha} + \\hat{\\beta}\\Delta_S) + \\tau^2\n$$\n线性组合 $\\hat{\\alpha} + \\hat{\\beta}\\Delta_S$ 的方差是：\n$$\n\\text{Var}(\\hat{\\alpha} + \\hat{\\beta}\\Delta_S) = \\text{Var}(\\hat{\\alpha}) + (\\Delta_S)^2 \\text{Var}(\\hat{\\beta}) + 2\\Delta_S \\text{Cov}(\\hat{\\alpha}, \\hat{\\beta})\n$$\n将这些结合起来并使用估计值，预测标准误的平方是：\n$$\n\\left(\\text{SE}(\\text{prediction})\\right)^2 = \\operatorname{Var}(\\hat{\\alpha}) + (\\Delta_S)^2 \\operatorname{Var}(\\hat{\\beta}) + 2\\Delta_S \\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}) + \\hat{\\tau}^2\n$$\n$0.95$ 预测区间的下界是：\n$$\nL(\\Delta_S) = (\\hat{\\alpha} + \\hat{\\beta}\\Delta_S) - t_{0.975, \\nu} \\sqrt{\\operatorname{Var}(\\hat{\\alpha}) + (\\Delta_S)^2 \\operatorname{Var}(\\hat{\\beta}) + 2\\Delta_S \\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}) + \\hat{\\tau}^2}\n$$\nSTE $s^{\\star}$ 是通过将此下界设为 $0$ 来找到的：\n$$\n\\hat{\\alpha} + \\hat{\\beta}s^{\\star} = t_{0.975, \\nu} \\sqrt{\\operatorname{Var}(\\hat{\\alpha}) + (s^{\\star})^2 \\operatorname{Var}(\\hat{\\beta}) + 2s^{\\star} \\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}) + \\hat{\\tau}^2}\n$$\n为了解出 $s^{\\star}$，我们将两边平方。只要 $\\hat{\\alpha} + \\hat{\\beta}s^{\\star} > 0$，这一操作就是有效的，这对于一个效应变为正值的有意义的阈值来说是符合预期的。\n$$\n(\\hat{\\alpha} + \\hat{\\beta}s^{\\star})^2 = (t_{0.975, \\nu})^2 \\left( \\operatorname{Var}(\\hat{\\alpha}) + (s^{\\star})^2 \\operatorname{Var}(\\hat{\\beta}) + 2s^{\\star} \\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}) + \\hat{\\tau}^2 \\right)\n$$\n展开并按 $s^{\\star}$ 的幂次合并项，得到一个形如 $A(s^{\\star})^2 + B s^{\\star} + C = 0$ 的二次方程。\n设 $t = t_{0.975, 18}$。\n$$\n\\hat{\\alpha}^2 + 2\\hat{\\alpha}\\hat{\\beta}s^{\\star} + \\hat{\\beta}^2(s^{\\star})^2 = t^2\\operatorname{Var}(\\hat{\\alpha}) + t^2\\operatorname{Var}(\\hat{\\beta})(s^{\\star})^2 + 2t^2\\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta})s^{\\star} + t^2\\hat{\\tau}^2\n$$\n整理得：\n$$\n\\left(\\hat{\\beta}^2 - t^2\\operatorname{Var}(\\hat{\\beta})\\right)(s^{\\star})^2 + \\left(2\\hat{\\alpha}\\hat{\\beta} - 2t^2\\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta})\\right)s^{\\star} + \\left(\\hat{\\alpha}^2 - t^2(\\operatorname{Var}(\\hat{\\alpha}) + \\hat{\\tau}^2)\\right) = 0\n$$\n系数为：\n$$\nA = \\hat{\\beta}^2 - t^2\\operatorname{Var}(\\hat{\\beta})\n$$\n$$\nB = 2(\\hat{\\alpha}\\hat{\\beta} - t^2\\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}))\n$$\n$$\nC = \\hat{\\alpha}^2 - t^2(\\operatorname{Var}(\\hat{\\alpha}) + \\hat{\\tau}^2)\n$$\n我们代入给定值：\n- $\\hat{\\alpha} = 0.05$\n- $\\hat{\\beta} = 0.80$\n- $\\operatorname{Var}(\\hat{\\alpha}) = 0.0025$\n- $\\operatorname{Var}(\\hat{\\beta}) = 0.04$\n- $\\operatorname{Cov}(\\hat{\\alpha},\\hat{\\beta}) = -0.005$\n- $\\hat{\\tau}^{2} = 0.04$\n- $t = 2.101 \\implies t^2 = (2.101)^2 \\approx 4.414201$\n\n现在，我们计算系数 $A$、$B$ 和 $C$：\n$$\nA = (0.80)^2 - (4.414201)(0.04) = 0.64 - 0.17656804 = 0.46343196\n$$\n$$\nB = 2((0.05)(0.80) - (4.414201)(-0.005)) = 2(0.04 + 0.022071005) = 2(0.062071005) = 0.12414201\n$$\n$$\nC = (0.05)^2 - 4.414201(0.0025 + 0.04) = 0.0025 - 4.414201(0.0425) = 0.0025 - 0.1876035425 = -0.1851035425\n$$\n我们使用二次方程求根公式 $s^{\\star} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 来解二次方程 $A(s^{\\star})^2 + Bs^{\\star} + C = 0$。\n首先，我们计算判别式 $D = B^2 - 4AC$：\n$$\nD = (0.12414201)^2 - 4(0.46343196)(-0.1851035425) \\approx 0.015411258 - (-0.343133306) = 0.358544564\n$$\n$$\n\\sqrt{D} \\approx \\sqrt{0.358544564} \\approx 0.598785909\n$$\n$s^{\\star}$ 的两个可能的解是：\n$$\ns^{\\star}_{1} = \\frac{-0.12414201 + 0.598785909}{2(0.46343196)} = \\frac{0.474643899}{0.92686392} \\approx 0.5120835\n$$\n$$\ns^{\\star}_{2} = \\frac{-0.12414201 - 0.598785909}{2(0.46343196)} = \\frac{-0.722927919}{0.92686392} \\approx -0.7800004\n$$\n为了选择正确的根，我们回顾初始条件 $\\hat{\\alpha} + \\hat{\\beta}s^{\\star} > 0$。\n对于 $s^{\\star}_{1} \\approx 0.512$：$\\hat{\\alpha} + \\hat{\\beta}s^{\\star}_{1} = 0.05 + 0.80(0.5120835) \\approx 0.05 + 0.4096668 \\approx 0.4596668 > 0$。这个根是有效的。\n对于 $s^{\\star}_{2} \\approx -0.780$：$\\hat{\\alpha} + \\hat{\\beta}s^{\\star}_{2} = 0.05 + 0.80(-0.7800004) \\approx 0.05 - 0.62400032 \\approx -0.57400032  0$。这个根对应的是预测区间的上界为零的情况，而不是下界。\n因此，正确的解是 $s^{\\star} = s^{\\star}_{1}$。\n\nSTE 的定义是使下界严格大于 $0$ 的 $\\Delta_S$ 的最小值。我们找到了使下界恰好为 $0$ 的值 $s^{\\star}$。由于可以证明下界函数 $L(\\Delta_S)$ 在 $s^{\\star}$ 处是递增的，任何大于 $s^{\\star}$ 的 $\\Delta_S$ 值都会导致下界大于 $0$。因此，$s^{\\star}$ 就是这个阈值。\n\n题目要求答案四舍五入到四位有效数字。\n$$\ns^{\\star} \\approx 0.5120835\n$$\n四舍五入到四位有效数字，我们得到 $0.5121$。\n给定的值 $s_{\\text{obs}} = 0.55$ 用于评估一种新疗法（因为 $0.55 > 0.5121$，根据 STE 标准，这种新疗法将被认为是有效的），但在计算 STE 本身时并不需要它。", "answer": "$$\\boxed{0.5121}$$", "id": "5075034"}]}