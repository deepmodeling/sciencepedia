{"hands_on_practices": [{"introduction": "本实践练习聚焦于方案制定过程中的关键环节：可行性评估。通过对包含多项入选标准（eligibility criteria）的患者筛选过程进行建模，您将学习如何计算筛选失败率并预测招募目标所需的患者总数。这些是设计一项后勤上可行的临床试验所必需的基本技能。[@problem_id:4998783]", "problem": "一项多中心转化研究计划在晚期实体瘤中开展一项II期生物标志物富集试验。预知情同意筛选步骤对转诊患者采用四项客观入组标准：生物标志物阳性、东部协作肿瘤学组（ECOG）体能状态评分 $0$–$1$、足够的器官功能以及无未经治疗的脑转移。基于登记数据和一项可行性预试验，研究方案采用了以下设计输入参数：\n\n- 转诊患者中生物标志物阳性的概率为 $P(B)=0.30$。\n- ECOG评分为 $0$–$1$ 的概率为 $P(E)=0.75$。\n- 足够的器官功能 $A$ 与ECOG相关：$P(A\\mid E)=0.93$ 和 $P(A\\mid E^{c})=0.60$。\n- 无未经治疗的脑转移 $M$ 的概率为 $P(M)=0.85$。\n- 为方案规划所作的独立性假设：事件对 $(B,M)$ 与事件对 $(E,A)$ 相互独立，且 $B$ 与 $M$ 相互独立。$E$ 与 $A$ 之间的相关性如上所述，是各项标准之间唯一的依赖关系。\n\n一名转诊患者筛选合格，当且仅当 $B \\cap E \\cap A \\cap M$ 事件成立。筛选合格的患者将被征求同意；在被征求同意的患者中，$0.90$ 的患者会提供知情同意。在已同意的患者中，$0.95$ 的患者会通过资格的中心确认，且无额外的不合格情况。随机化在中心确认后立即进行。\n\n该试验的目标是纳入 $N=120$ 名随机化患者。为进行可行性监查，在完成首批 $m=60$ 例预知情同意筛选后，如果观测到的筛选失败次数相对于上述输入参数所隐含的筛选失败概率下的方案计划值“过高”，申办方将启动一次可行性审查。具体而言，对于前 $m$ 次筛选中的失败次数，假设其服从一个二项模型，其失败概率等于计划值，将单侧上监查阈值 $k^{\\ast}$ 定义为使二项分布的右尾概率至多为 $\\alpha=0.10$ 的最小整数。如果需要，您可以使用带连续性校正的正态近似来确定 $k^{\\ast}$。\n\n任务：\n1) 从联合概率和条件概率的定义以及给定的独立性结构出发，推导计划的预知情同意筛选失败概率 $p_{\\mathrm{fail}}$。\n2) 使用伯努利过程的基本原理，推导为实现 $N$ 例随机化所需的转诊患者的期望数量，并根据提供的输入参数进行数值计算。\n3) 确定当 $m=60$ 和 $\\alpha=0.10$ 时，如上文所定义的可行性审查阈值 $k^{\\ast}$。\n\n提供所有推理过程和中间推导。最终答案只报告整数 $k^{\\ast}$。除了确定正确的整数阈值外，最终答案无需其他舍入说明。", "solution": "问题陈述已经过评估并被确定为有效。它在概率论及其在临床试验设计中的应用方面具有科学依据，问题提法得当，给定的条件完整且一致，并以客观、正式的语言表述。解题过程如下。\n\n问题要求进行三部分计算：\n1) 预知情同意筛选失败概率 $p_{\\mathrm{fail}}$ 的推导。\n2) 为实现 $N=120$ 例随机化所需转诊患者期望数量的推导和计算。\n3) 可行性监查阈值 $k^{\\ast}$ 的确定。\n\n**第1部分：预知情同意筛选失败概率 ($p_{\\mathrm{fail}}$)**\n\n一名转诊患者筛选合格，前提是其同时满足所有四项标准。设 $S_{succ}$ 表示预知情同意筛选成功的事件。该事件是四个独立标准事件的交集：生物标志物阳性 ($B$)、ECOG体能状态评分为 $0$–$1$ ($E$)、足够的器官功能 ($A$) 以及无未经治疗的脑转移 ($M$)。\n$$S_{succ} = B \\cap E \\cap A \\cap M$$\n该事件的概率 $p_{succ} = P(S_{succ})$，即患者筛选合格的概率。问题陈述指出，事件对 $(B,M)$ 与事件对 $(E,A)$ 相互独立。因此，联合概率可以分解为：\n$$p_{succ} = P(B \\cap M \\cap E \\cap A) = P(B \\cap M) P(E \\cap A)$$\n问题进一步指出，$B$ 和 $M$ 是独立事件。因此，它们的联合概率是它们各自概率的乘积：\n$$P(B \\cap M) = P(B) P(M)$$\n问题通过条件概率 $P(A \\mid E)$ 指明了 $E$ 和 $A$ 之间的依赖关系。$E$ 和 $A$ 的联合概率由条件概率的定义给出：\n$$P(E \\cap A) = P(A \\mid E) P(E)$$\n注意，患者要想合格，必须满足标准 $E$。因此，计算成功概率不需要关于 $P(A \\mid E^c)$ 的信息，因为任何处于 $E^c$ 状态的患者都已筛选失败。\n\n结合这些表达式，筛选成功的概率为：\n$$p_{succ} = P(B) P(M) P(A \\mid E) P(E)$$\n代入给定值：\n$P(B) = 0.30$\n$P(M) = 0.85$\n$P(E) = 0.75$\n$P(A \\mid E) = 0.93$\n$$p_{succ} = (0.30) \\times (0.85) \\times (0.93) \\times (0.75)$$\n$$p_{succ} = (0.255) \\times (0.6975) = 0.1778625$$\n预知情同意筛选失败的概率 $p_{\\mathrm{fail}}$ 是成功概率的补集：\n$$p_{\\mathrm{fail}} = 1 - p_{succ} = 1 - 0.1778625 = 0.8221375$$\n\n**第2部分：所需转诊患者的期望数量**\n\n设 $p_{\\mathrm{rand}}$ 为单个转诊患者最终被随机化的总概率。一名患者必须通过三个连续的关卡：预知情同意筛选（合格性）、知情同意和中心确认。\n通过预知情同意筛选的概率是 $p_{succ} = 0.1778625$。\n筛选合格的患者提供同意的概率是 $P(\\text{Consent} \\mid S_{succ}) = 0.90$。\n已同意的患者通过中心确认的概率是 $P(\\text{Confirm} \\mid \\text{Consent}) = 0.95$。\n\n一个转诊患者被随机化的概率是这些概率的乘积：\n$$p_{\\mathrm{rand}} = P(S_{succ}) \\times P(\\text{Consent} \\mid S_{succ}) \\times P(\\text{Confirm} \\mid \\text{Consent})$$\n$$p_{\\mathrm{rand}} = 0.1778625 \\times 0.90 \\times 0.95$$\n$$p_{\\mathrm{rand}} = 0.1778625 \\times 0.855 = 0.1520724375$$\n寻找随机化患者的过程可以建模为一系列独立的伯努利试验，其中成功（即一名患者被随机化）的概率为 $p_{\\mathrm{rand}}$。为获得固定数量的成功（$N$），所需的试验次数（即转诊患者数）$K$ 服从负二项分布。$K$ 的期望值由下式给出：\n$$E[K] = \\frac{N}{p_{\\mathrm{rand}}}$$\n目标是 $N=120$ 名随机化患者：\n$$E[K] = \\frac{120}{0.1520724375} \\approx 789.1118$$\n因此，为将120名患者随机化，必须转诊到该研究的患者期望数量约为 $789.11$。\n\n**第3部分：可行性审查阈值 ($k^{\\ast}$)**\n\n可行性审查基于前 $m=60$ 次筛选中的失败次数 $X$。该过程被建模为一个二项试验，即 $X \\sim \\text{Binomial}(m, p_{\\mathrm{fail}})$，其中试验次数为 $m=60$，每次试验的失败概率为 $p_{\\mathrm{fail}} = 0.8221375$。\n\n我们需要找到最小的整数阈值 $k^{\\ast}$，使得观测到 $k^{\\ast}$ 次或更多次失败的概率至多为 $\\alpha=0.10$。\n$$P(X \\ge k^{\\ast}) \\le 0.10$$\n问题允许使用带连续性校正的正态近似来处理二项分布。首先，我们计算二项分布的均值 ($\\mu$) 和标准差 ($\\sigma$)：\n$$\\mu = m \\cdot p_{\\mathrm{fail}} = 60 \\times 0.8221375 = 49.32825$$\n$$\\sigma^2 = m \\cdot p_{\\mathrm{fail}} (1 - p_{\\mathrm{fail}}) = 60 \\times 0.8221375 \\times (1 - 0.8221375) = 49.32825 \\times 0.1778625 \\approx 8.77353$$\n$$\\sigma = \\sqrt{\\sigma^2} \\approx 2.9619806$$\n条件 $m \\cdot p_{\\mathrm{fail}} \\approx 49.3 > 5$ 和 $m(1-p_{\\mathrm{fail}}) \\approx 10.7 > 5$ 证实了使用正态近似是合适的。\n\n应用连续性校正后，概率 $P(X \\ge k^{\\ast})$ 可近似为 $P(Y \\ge k^{\\ast} - 0.5)$，其中 $Y \\sim N(\\mu, \\sigma^2)$。我们将其标准化为一个标准正态变量 $Z \\sim N(0, 1)$:\n$$P\\left(Z \\ge \\frac{(k^{\\ast} - 0.5) - \\mu}{\\sigma}\\right) \\le 0.10$$\n来自标准正态分布的临界值 $z_{0.10}$，满足 $P(Z \\ge z_{0.10}) = 0.10$，约为 $z_{0.10} \\approx 1.28155$。\n因此，我们必须有：\n$$\\frac{(k^{\\ast} - 0.5) - \\mu}{\\sigma} \\ge z_{0.10}$$\n求解 $k^{\\ast}$:\n$$k^{\\ast} - 0.5 \\ge \\mu + z_{0.10} \\sigma$$\n$$k^{\\ast} \\ge \\mu + 0.5 + z_{0.10} \\sigma$$\n代入计算出的值：\n$$k^{\\ast} \\ge 49.32825 + 0.5 + (1.28155)(2.9619806)$$\n$$k^{\\ast} \\ge 49.82825 + 3.79580$$\n$$k^{\\ast} \\ge 53.62405$$\n由于 $k^{\\ast}$ 必须是整数，满足此不等式的最小整数是 $k^{\\ast}=54$。\n\n为了验证，我们可以检查 $k=53$ 和 $k=54$ 时的近似概率：\n对于 $k^{\\ast}=54$，我们检验 $P(X \\ge 54) \\approx P(Y \\ge 53.5)$:\n$$z = \\frac{53.5 - 49.32825}{2.9619806} = \\frac{4.17175}{2.9619806} \\approx 1.4084$$\n$P(Z \\ge 1.4084) \\approx 0.0795$，该值小于 $0.10$。\n\n对于 $k=53$，我们检验 $P(X \\ge 53) \\approx P(Y \\ge 52.5)$:\n$$z = \\frac{52.5 - 49.32825}{2.9619806} = \\frac{3.17175}{2.9619806} \\approx 1.0708$$\n$P(Z \\ge 1.0708) \\approx 0.1421$，该值大于 $0.10$。\n\n因此，会触发审查的最小整数失败次数是 $54$。", "answer": "$$\\boxed{54}$$", "id": "4998783"}, {"introduction": "现代临床试验方案通常包含期中分析，以便根据累积数据进行适应性调整。本练习将介绍“条件把握度”（conditional power）这一核心概念，它是在已知期中分析结果的条件下，预测试验最终成功概率的关键指标，从而为试验是否因无效而中止或调整样本量等决策提供数据支持。[@problem_id:4998728]", "problem": "一项转化医学领域的随机对照试验（RCT）正在评估一种生物标志物指导的疗法对一个连续型主要终点的影响，该终点被假定为近似正态分布，且各组间方差相同。验证性分析是在I类错误率 $\\alpha = 0.05$ 水平下的双侧优效性检验，当效应为正向时宣布优效。采用等比例分配。计划的最大样本量为每组 $N_{\\text{final}} = 200$。在每组样本量达到 $N_{1} = 80$ 后，计划进行一次期中分析。期中分析得到的合并样本方差估计值为 $s^{2} = 225$，并假定在规划阶段该值保持稳定。观察到的期中均值差（治疗组减去对照组）为 $\\hat{d}_{1} = 3.0$（以终点的原始单位计）。\n\n假设均值差满足大样本正态近似，且Fisher信息量具有可加性。在进行预测性评估时，将观察到的期中效应作为工作备择假设；也就是说，假设真实均值差 $\\delta$ 等于观察到的期中估计值 $\\hat{d}_{1}$。仅使用这些假设，从第一性原理推导在给定其中数据的情况下最终 $Z$ 统计量的条件分布，并由此推导出在计划的最终分析中拒绝原假设的条件效力。最终的界值使用双侧正态理论的临界值 $z_{1-\\alpha/2}$。计算该条件效力的数值。\n\n独立数据监察委员会（IDMC）将应用以下阈值进行适应性调整：如果条件效力小于0.2，考虑进行非约束性的无效中止；如果条件效力在$[0.2, 0.8)$区间内，考虑重新估计样本量以达到0.9的目标条件效力；如果条件效力至少为0.8，则按原计划继续试验。然而，对于本问题，仅需报告条件效力的值。\n\n将条件效力表示为小数（而非百分比），并四舍五入到四位有效数字。不要报告任何决策；仅报告计算出的条件效力。", "solution": "该问题被评估为有效，因为它在科学上基于临床试验的标准统计理论，问题陈述清晰且信息充分一致，并且表述客观。\n\n我们的任务是推导在给定中期结果的情况下最终检验统计量的条件分布，然后计算拒绝原假设的条件效力。\n\n设 $\\delta$ 为治疗组和对照组之间的真实均值差。终点是一个连续变量，假定在两组中均服从正态分布，且具有共同方差 $\\sigma^2$。问题提供了一个合并样本方差估计值 $s^2 = 225$，我们将在规划中将其用作真实的总体方差 $\\sigma^2$，因此 $\\sigma^2 = 225$。\n\n设 $N_1$ 为期中分析时每组的样本量，$N_{\\text{final}}$ 为计划的总样本量。给定 $N_1 = 80$ 和 $N_{\\text{final}} = 200$。\n\n期中分析时均值差的估计量为 $\\hat{d}_1$。根据大样本近似，$\\hat{d}_1$ 服从正态分布：\n$$ \\hat{d}_1 \\sim N\\left(\\delta, \\frac{2\\sigma^2}{N_1}\\right) $$\n期中分析时相应的 $Z$ 统计量 $Z_1$ 由下式给出：\n$$ Z_1 = \\frac{\\hat{d}_1}{\\sqrt{2\\sigma^2 / N_1}} \\sim N\\left(\\frac{\\delta}{\\sqrt{2\\sigma^2 / N_1}}, 1\\right) $$\n基于每组 $N_{\\text{final}}$ 名受试者的最终均值差估计量 $\\hat{d}_{\\text{final}}$ 也服从正态分布：\n$$ \\hat{d}_{\\text{final}} \\sim N\\left(\\delta, \\frac{2\\sigma^2}{N_{\\text{final}}}\\right) $$\n最终的 $Z$ 统计量 $Z_{\\text{final}}$ 为：\n$$ Z_{\\text{final}} = \\frac{\\hat{d}_{\\text{final}}}{\\sqrt{2\\sigma^2 / N_{\\text{final}}}} \\sim N\\left(\\frac{\\delta}{\\sqrt{2\\sigma^2 / N_{\\text{final}}}}, 1\\right) $$\n由于数据收集的序贯性，最终分析的数据包含了期中分析的数据，因此统计量 $Z_1$ 和 $Z_{\\text{final}}$ 不是独立的。它们的联合分布近似为二元正态分布。它们之间的协方差为：\n$$ \\text{Cov}(Z_1, Z_{\\text{final}}) = \\text{Cov}\\left(\\frac{\\hat{d}_1}{\\sqrt{2\\sigma^2/N_1}}, \\frac{\\hat{d}_{\\text{final}}}{\\sqrt{2\\sigma^2/N_{\\text{final}}}}\\right) $$\n由于 $\\hat{d}_{\\text{final}}$ 是所有 $N_{\\text{final}}$ 名受试者的平均差，而 $\\hat{d}_1$ 是前 $N_1$ 名受试者的平均差，我们可以写出 $\\hat{d}_{\\text{final}} = \\frac{N_1 \\hat{d}_1 + (N_{\\text{final}}-N_1)\\hat{d}_2}{N_{\\text{final}}}$，其中 $\\hat{d}_2$ 是期中分析后新入组受试者的估计量。由于 $\\hat{d}_1$ 和 $\\hat{d}_2$ 是独立的，所以 $\\text{Cov}(\\hat{d}_1, \\hat{d}_{\\text{final}}) = \\text{Var}(\\hat{d}_1)\\frac{N_1}{N_{\\text{final}}} = \\frac{2\\sigma^2}{N_1}\\frac{N_1}{N_{\\text{final}}} = \\frac{2\\sigma^2}{N_{\\text{final}}}$。\n将此代入 $Z$ 统计量的协方差公式中：\n$$ \\text{Cov}(Z_1, Z_{\\text{final}}) = \\frac{1}{\\sqrt{2\\sigma^2/N_1}\\sqrt{2\\sigma^2/N_{\\text{final}}}}\\text{Cov}(\\hat{d}_1, \\hat{d}_{\\text{final}}) = \\frac{\\sqrt{N_1 N_{\\text{final}}}}{2\\sigma^2} \\frac{2\\sigma^2}{N_{\\text{final}}} = \\sqrt{\\frac{N_1}{N_{\\text{final}}}} $$\n由于方差均为1，这也是它们的相关系数，$\\rho = \\sqrt{N_1/N_{\\text{final}}}$。\n因此，$(Z_1, Z_{\\text{final}})$ 服从二元正态分布：\n$$ \\begin{pmatrix} Z_1 \\\\ Z_{\\text{final}} \\end{pmatrix} \\sim N\\left( \\begin{pmatrix} \\delta\\sqrt{\\frac{N_1}{2\\sigma^2}} \\\\ \\delta\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}} \\end{pmatrix}, \\begin{pmatrix} 1 & \\sqrt{\\frac{N_1}{N_{\\text{final}}}} \\\\ \\sqrt{\\frac{N_1}{N_{\\text{final}}}} & 1 \\end{pmatrix} \\right) $$\n根据二元正态分布的性质，在给定观测值 $Z_1 = z_1$ 的条件下，$Z_{\\text{final}}$ 的条件分布也是正态分布。该条件分布的参数为：\n条件均值：$E[Z_{\\text{final}}|Z_1=z_1] = E[Z_{\\text{final}}] + \\rho(z_1 - E[Z_1])$\n$$ E[Z_{\\text{final}}|Z_1=z_1] = \\delta\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}} + \\sqrt{\\frac{N_1}{N_{\\text{final}}}}\\left(z_1 - \\delta\\sqrt{\\frac{N_1}{2\\sigma^2}}\\right) $$\n条件方差：$\\text{Var}(Z_{\\text{final}}|Z_1=z_1) = \\text{Var}(Z_{\\text{final}})(1 - \\rho^2)$\n$$ \\text{Var}(Z_{\\text{final}}|Z_1=z_1) = 1 \\cdot \\left(1 - \\frac{N_1}{N_{\\text{final}}}\\right) = \\frac{N_{\\text{final}}-N_1}{N_{\\text{final}}} $$\n这完成了推导的第一部分。\n\n问题指出，为了进行预测性评估，我们必须假设真实均值差 $\\delta$ 等于观察到的期中估计值 $\\hat{d}_1$。给定 $\\hat{d}_1 = 3.0$，我们设定 $\\delta = 3.0$。\n在此假设下，$Z_1$ 的期望值 $E[Z_1]$ 在数值上等于观测值 $z_1$：\n$$ E[Z_1] = \\delta\\sqrt{\\frac{N_1}{2\\sigma^2}} = \\hat{d}_1\\sqrt{\\frac{N_1}{2\\sigma^2}} = \\frac{\\hat{d}_1}{\\sqrt{2\\sigma^2/N_1}} = z_1 $$\n将此结果（$E[Z_1] = z_1$）代入条件均值公式，可以大大简化该公式：\n$$ E[Z_{\\text{final}}|Z_1=z_1, \\delta=\\hat{d}_1] = \\delta\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}} + \\sqrt{\\frac{N_1}{N_{\\text{final}}}}(z_1 - z_1) = \\delta\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}} = \\hat{d}_1\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}} $$\n因此，在给定中期数据和假设 $\\delta = \\hat{d}_1$ 的情况下，$Z_{\\text{final}}$ 的条件分布为：\n$$ Z_{\\text{final}} | (\\text{data at interim}) \\sim N\\left(\\hat{d}_1\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}}, \\frac{N_{\\text{final}}-N_1}{N_{\\text{final}}}\\right) $$\n条件效力（CP）是在给定此条件分布的情况下，在最终分析中拒绝原假设 $H_0: \\delta=0$ 的概率。对于显著性水平 $\\alpha=0.05$ 的双侧检验，当 $|Z_{\\text{final}}| > z_{1-\\alpha/2}$ 时拒绝原假设。由于观察到的效应是正的（$\\hat{d}_1 = 3.0$），我们关心的是在正向拒绝的概率，即 $Z_{\\text{final}} > z_{1-\\alpha/2}$。\n$$ \\text{CP} = P(Z_{\\text{final}} > z_{1-\\alpha/2} | \\text{interim data}, \\delta=\\hat{d}_1) $$\n设 $\\Phi(\\cdot)$ 为标准正态分布的累积分布函数。那么：\n$$ \\text{CP} = 1 - \\Phi\\left(\\frac{z_{1-\\alpha/2} - E[Z_{\\text{final}}|Z_1=z_1, \\delta=\\hat{d}_1]}{\\sqrt{\\text{Var}(Z_{\\text{final}}|Z_1=z_1, \\delta=\\hat{d}_1)}}\\right) $$\n$$ \\text{CP} = 1 - \\Phi\\left(\\frac{z_{1-\\alpha/2} - \\hat{d}_1\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}}}{\\sqrt{\\frac{N_{\\text{final}}-N_1}{N_{\\text{final}}}}}\\right) $$\n现在，我们代入数值：\n$\\alpha = 0.05 \\implies z_{1-\\alpha/2} = z_{0.975} \\approx 1.959964$\n$\\hat{d}_1 = 3.0$\n$\\sigma^2 = 225$\n$N_1 = 80$\n$N_{\\text{final}} = 200$\n\n计算条件均值：\n$$ \\mu_{\\text{cond}} = \\hat{d}_1\\sqrt{\\frac{N_{\\text{final}}}{2\\sigma^2}} = 3.0 \\times \\sqrt{\\frac{200}{2 \\times 225}} = 3.0 \\times \\sqrt{\\frac{200}{450}} = 3.0 \\times \\sqrt{\\frac{4}{9}} = 3.0 \\times \\frac{2}{3} = 2.0 $$\n计算条件方差：\n$$ \\sigma^2_{\\text{cond}} = \\frac{N_{\\text{final}}-N_1}{N_{\\text{final}}} = \\frac{200-80}{200} = \\frac{120}{200} = 0.6 $$\n$\\Phi$ 的参数为：\n$$ \\frac{z_{0.975} - \\mu_{\\text{cond}}}{\\sqrt{\\sigma^2_{\\text{cond}}}} = \\frac{1.959964 - 2.0}{\\sqrt{0.6}} = \\frac{-0.040036}{\\sqrt{0.6}} \\approx -0.051686 $$\n条件效力是：\n$$ \\text{CP} = 1 - \\Phi(-0.051686) = \\Phi(0.051686) $$\n使用标准正态分布计算器，我们得到：\n$$ \\text{CP} \\approx 0.520603 $$\n按照要求四舍五入到四位有效数字，条件效力为 $0.5206$。", "answer": "$$\\boxed{0.5206}$$", "id": "4998728"}, {"introduction": "现代“估计目标”（estimand）框架（ICH E9 R1）要求临床试验方案精确定义其科学问题，尤其是在存在“中途事件”（intercurrent events）如更换治疗方案时。本练习将通过一个具体案例揭示不当的分析选择会如何引入显著偏倚，从而强调分析计划必须与“意向性治疗”（intention-to-treat, ITT）原则保持一致，以确保试验结论的完整性和有效性。[@problem_id:4998718]", "problem": "计划进行一项转移性肿瘤学的双臂随机时间-事件试验，以总生存期为主要终点。该科学问题根据国际人用药品注册技术协调会 (ICH) E9 附录 (R1) 的术语，采用意向性治疗 (ITT) 治疗策略 estimand (目标量) 进行阐述：即由随机化定义的分组之间，在固定时间范围内的限制性平均生存时间 (RMST) 差异，而不考虑如治疗转换等伴随事件。设时间范围为 $H=12$ 个月。\n\n假设生存时间可以通过各指定臂组的恒定风险率指数模型得到很好的近似。具体而言，随机分配到试验性治疗组的参与者的风险率为 $\\lambda_{E}=0.05$ 月$^{-1}$，随机分配到对照组的参与者的风险率为 $\\lambda_{C}=0.10$ 月$^{-1}$，直至在 $H$ 时发生行政删失。在对照组中，在日历时间 $s=6$ 个月时会发生研究方案允许的治疗转换：在 $t=s$ 时存活且在观察中的参与者中，通过概率为 $p=0.40$ 的独立伯努利抽取，将参与者分配为永久转换到试验性治疗。转换后，转换者的风险率在 $t\\ge s$ 时瞬时变为 $\\lambda_{E}$；非转换者的风险率在所有时间 $t$ 内保持为 $\\lambda_{C}$。假设在 $t=s$ 时存活且在随机臂组的条件下，转换概率 $p$ 与潜在失败时间过程无关。\n\n一位分析师错误地认为，在发生转换时进行删失与 ITT estimand 是相容的，因此如果对照组参与者发生转换，他就在转换时间 $s$ 对其进行删失，然后使用独立删失模型下的 Kaplan-Meier 估计量计算对照组的 RMST。试验组没有治疗转换，除在 $H$ 时的行政删失外，分析中没有其他删失。\n\n仅使用生存函数、风险率和限制性平均生存时间 $ \\mathrm{RMST}(H) = \\int_{0}^{H} S(t)\\, dt$ 的基本定义，其中 $S(t)$ 是目标 estimand 下的生存函数，请从第一性原理推导出：\n\n1. 在给定转换机制的情况下，在 $[0,H]$ 范围内的正确 ITT (治疗策略) 对照组生存函数 $S_{C}^{\\mathrm{true}}(t)$，及其相应的 $\\mathrm{RMST}_{C}^{\\mathrm{true}}(H)$。\n2. 分析师在转换时进行删失所隐含的朴素对照组生存函数 $S_{C}^{\\mathrm{naive}}(t)$，及其相应的 $\\mathrm{RMST}_{C}^{\\mathrm{naive}}(H)$。\n3. 由分析师的方法引入的对 ITT estimand 估计的数值偏差，定义为\n$$\n\\text{Bias} = \\Big(\\mathrm{RMST}_{E}(H) - \\mathrm{RMST}_{C}^{\\mathrm{naive}}(H)\\Big) - \\Big(\\mathrm{RMST}_{E}(H) - \\mathrm{RMST}_{C}^{\\mathrm{true}}(H)\\Big) = \\mathrm{RMST}_{C}^{\\mathrm{true}}(H) - \\mathrm{RMST}_{C}^{\\mathrm{naive}}(H).\n$$\n\n此外，提出一个与 estimand 原则一致的分析策略：简要说明如果 estimand 是“无转换”的假设性策略，那么使用哪种稳定的删失概率逆权重 (IPCW; 逆概率加权) 是合适的，并在公式层面指出这些权重如何进入加权 Kaplan-Meier 估计量以针对该假设性 estimand。同时，说明在此情景下针对 ITT 治疗策略 estimand 的正确分析方法。\n\n计算上述定义的偏差的数值，单位为月。将您的答案四舍五入到四位有效数字。以月为单位表示最终数值答案。", "solution": "恒定风险率 $\\lambda$ 与生存函数 $S(t)$ 之间的一般关系由 $S(t) = \\exp(-\\lambda t)$ 给出。直至时间范围 $H$ 的限制性平均生存时间 (RMST) 是从 $t=0$ 到 $t=H$ 的生存曲线下的面积，定义为 $\\mathrm{RMST}(H) = \\int_0^H S(t) \\, dt$。\n\n**1. 正确的 ITT 对照组生存函数和 RMST**\n\n意向性治疗 (ITT) 原则，在治疗策略 estimand 的背景下，要求参与者的结局归因于其随机分配的臂组，无论是否发生如治疗转换之类的伴随事件。转换事件是对照组治疗策略的一部分。\n\n对照组的生存函数 $S_{C}^{\\mathrm{true}}(t)$ 必须分段推导。\n- 对于时间区间 $t \\in [0, s)$，对照组中的所有参与者都承受风险率 $\\lambda_{C}$。因此，生存函数为：\n    $$S_{C}^{\\mathrm{true}}(t) = \\exp(-\\lambda_{C} t), \\quad \\text{对于 } 0 \\le t < s$$\n- 在时间 $t=s=6$ 个月时，对于存活至今的患者队列（其概率为 $S_{C}^{\\mathrm{true}}(s) = \\exp(-\\lambda_{C} s)$），一部分比例为 $p$ 的患者转换为试验性治疗（风险率 $\\lambda_{E}$），而比例为 $1-p$ 的患者则继续接受对照治疗（风险率 $\\lambda_{C}$）。\n- 对于时间区间 $t \\in [s, H]$，生存概率 $S_{C}^{\\mathrm{true}}(t)$ 是存活到 $s$ 的概率乘以从 $s$ 存活到 $t$ 的条件概率。后者是两个子组（转换者和非转换者）生存概率的混合。\n    $$P(\\text{生存时间} > t | \\text{生存时间} > s) = p \\cdot \\exp(-\\lambda_{E}(t-s)) + (1-p) \\cdot \\exp(-\\lambda_{C}(t-s))$$\n    因此，对于 $t \\ge s$：\n    $$S_{C}^{\\mathrm{true}}(t) = S_{C}^{\\mathrm{true}}(s) \\cdot \\left[ p \\cdot \\exp(-\\lambda_{E}(t-s)) + (1-p) \\cdot \\exp(-\\lambda_{C}(t-s)) \\right]$$\n    $$S_{C}^{\\mathrm{true}}(t) = \\exp(-\\lambda_{C} s) \\left[ p \\exp(-\\lambda_{E}(t-s)) + (1-p)\\exp(-\\lambda_{C}(t-s)) \\right], \\quad \\text{对于 } t \\ge s$$\n相应的正确 RMST，$\\mathrm{RMST}_{C}^{\\mathrm{true}}(H)$，是这个分段函数从 $0$ 到 $H$ 的积分：\n$$\\mathrm{RMST}_{C}^{\\mathrm{true}}(H) = \\int_0^s \\exp(-\\lambda_C t) dt + \\int_s^H \\exp(-\\lambda_{C} s) \\left[ p \\exp(-\\lambda_{E}(t-s)) + (1-p)\\exp(-\\lambda_{C}(t-s)) \\right] dt$$\n第一个积分是 $\\frac{1}{\\lambda_C}[1 - \\exp(-\\lambda_C s)]$。\n第二个积分是：\n$$\\exp(-\\lambda_{C} s) \\left[ p \\int_s^H \\exp(-\\lambda_{E}(t-s)) dt + (1-p) \\int_s^H \\exp(-\\lambda_{C}(t-s)) dt \\right]$$\n$$= \\exp(-\\lambda_{C} s) \\left[ \\frac{p}{\\lambda_E} [1 - \\exp(-\\lambda_E(H-s))] + \\frac{1-p}{\\lambda_C} [1 - \\exp(-\\lambda_C(H-s))] \\right]$$\n因此，\n$$\\mathrm{RMST}_{C}^{\\mathrm{true}}(H) = \\frac{1 - \\exp(-\\lambda_C s)}{\\lambda_C} + \\exp(-\\lambda_{C} s) \\left( \\frac{p}{\\lambda_E} [1 - \\exp(-\\lambda_E(H-s))] + \\frac{1-p}{\\lambda_C} [1 - \\exp(-\\lambda_C(H-s))] \\right)$$\n\n**2. 分析师的朴素对照组生存函数和 RMST**\n\n分析师的错误是在时间 $s$ 删失转换者，并在独立删失的假设下进行 Kaplan-Meier 分析。在这个参数模型中，此程序隐含地以一个假设群体的生存函数为目标，该群体*始终*承受风险率 $\\lambda_{C}$，就好像从未有人转换过一样。删失的依赖性（转换改变了风险率，因此与未来的失败时间过程相关）被忽略了。通过这种朴素方法估计的生存函数是：\n$$S_{C}^{\\mathrm{naive}}(t) = \\exp(-\\lambda_{C} t), \\quad \\text{对于 } 0 \\le t \\le H$$\n相应的朴素 RMST 是此函数的积分：\n$$\\mathrm{RMST}_{C}^{\\mathrm{naive}}(H) = \\int_0^H \\exp(-\\lambda_C t) dt = \\frac{1}{\\lambda_C} [1 - \\exp(-\\lambda_C H)]$$\n\n**3. 偏差计算**\n\n偏差定义为 $\\mathrm{RMST}_{C}^{\\mathrm{true}}(H) - \\mathrm{RMST}_{C}^{\\mathrm{naive}}(H)$。我们可以通过计算积分的差值来得到这个值。从 $t=0$ 到 $t=s$ 的积分对于真实计算和朴素计算都是相同的，因此它们相互抵消。偏差完全来自于区间 $[s, H]$ 上生存函数的差异。\n$$\\text{Bias} = \\int_s^H \\left( S_{C}^{\\mathrm{true}}(t) - S_{C}^{\\mathrm{naive}}(t) \\right) dt$$\n积分内的差值为：\n$$S_{C}^{\\mathrm{true}}(t) - S_{C}^{\\mathrm{naive}}(t) = \\exp(-\\lambda_{C} s) \\left[ p \\exp(-\\lambda_{E}(t-s)) + (1-p)\\exp(-\\lambda_{C}(t-s)) \\right] - \\exp(-\\lambda_C t)$$\n$$= \\exp(-\\lambda_{C} s) \\left[ p \\exp(-\\lambda_{E}(t-s)) + (1-p)\\exp(-\\lambda_{C}(t-s)) - \\exp(-\\lambda_{C}(t-s)) \\right]$$\n$$= \\exp(-\\lambda_{C} s) \\left[ p \\exp(-\\lambda_{E}(t-s)) - p\\exp(-\\lambda_{C}(t-s)) \\right]$$\n$$= p \\exp(-\\lambda_{C} s) \\left[ \\exp(-\\lambda_{E}(t-s)) - \\exp(-\\lambda_{C}(t-s)) \\right]$$\n现在，我们将这个差值从 $s$ 积分到 $H$：\n$$\\text{Bias} = \\int_s^H p \\exp(-\\lambda_{C} s) \\left[ \\exp(-\\lambda_{E}(t-s)) - \\exp(-\\lambda_{C}(t-s)) \\right] dt$$\n令 $u=t-s$，则 $du=dt$。积分限从 $[s, H]$ 变为 $[0, H-s]$。\n$$\\text{Bias} = p \\exp(-\\lambda_{C} s) \\int_0^{H-s} \\left[ \\exp(-\\lambda_{E}u) - \\exp(-\\lambda_{C}u) \\right] du$$\n$$\\text{Bias} = p \\exp(-\\lambda_{C} s) \\left( \\left[ -\\frac{1}{\\lambda_E}\\exp(-\\lambda_{E}u) \\right]_0^{H-s} - \\left[ -\\frac{1}{\\lambda_C}\\exp(-\\lambda_{C}u) \\right]_0^{H-s} \\right)$$\n$$\\text{Bias} = p \\exp(-\\lambda_{C} s) \\left( \\frac{1}{\\lambda_E}[1 - \\exp(-\\lambda_E(H-s))] - \\frac{1}{\\lambda_C}[1 - \\exp(-\\lambda_C(H-s))] \\right)$$\n这个公式代表了在转换时间处于风险中的概率 ($S_C(s)$)，乘以转换的概率 ($p$)，再乘以在剩余随访期 ($[s, H]$) 内，风险率为 $\\lambda_E$ 的患者和风险率为 $\\lambda_C$ 的患者之间 RMST 的差异。\n\n现在，我们代入数值：$H=12$, $s=6$, $p=0.40$, $\\lambda_E=0.05$, $\\lambda_C=0.10$。\n$$\\lambda_C s = (0.10)(6) = 0.6$$\n$$\\lambda_E(H-s) = (0.05)(12-6) = 0.3$$\n$$\\lambda_C(H-s) = (0.10)(12-6) = 0.6$$\n$$\\text{Bias} = 0.40 \\cdot \\exp(-0.6) \\left( \\frac{1 - \\exp(-0.3)}{0.05} - \\frac{1 - \\exp(-0.6)}{0.10} \\right)$$\n$$\\text{Bias} = 0.40 \\cdot \\exp(-0.6) \\left( 20 [1 - \\exp(-0.3)] - 10 [1 - \\exp(-0.6)] \\right)$$\n$$\\text{Bias} \\approx 0.40 \\cdot (0.548812) \\left( 20 [1 - 0.740818] - 10 [1 - 0.548812] \\right)$$\n$$\\text{Bias} \\approx 0.219525 \\left( 20 [0.259182] - 10 [0.451188] \\right)$$\n$$\\text{Bias} \\approx 0.219525 \\left( 5.18364 - 4.51188 \\right)$$\n$$\\text{Bias} \\approx 0.219525 \\times 0.67176 \\approx 0.147468$$\n四舍五入到四位有效数字，偏差为 $0.1475$ 个月。\n\n**分析策略建议**\n\n**假设性 Estimand (“无转换”)：** 为了在没有对照组患者转换治疗的假设情景下估计治疗效果，必须考虑由转换引入的依赖性删失。一种合适的方法是删失概率逆权重 (IPCW)。对于在时间 $s$ 没有转换（因此未被删失）的对照组患者 $i$，其在 $t \\ge s$ 的数据将被上调权重，以弥补因转换而被“删失”的风险集中比例为 $p=0.40$ 的部分。对于非转换者，其稳定权重 $W_i(t)$ 将是：\n$$W_i(t) = \\begin{cases} 1 & \\text{若 } t < s \\\\ \\frac{1}{1-p} & \\text{若 } t \\ge s \\end{cases}$$\n在伴随事件发生前，权重为 $1$，对于在 $s$ 之后仍留在对照组的患者，权重变为 $1/(1-0.40) = 1.667$。然后将这些权重用于加权 Kaplan-Meier 估计量或加权 Cox 模型。由于模型中没有协变量需要稳定，因此稳定权重的分子是 $1$。\n\n**针对 ITT 治疗策略 Estimand 的正确分析：** 为了针对指定的 ITT 治疗策略 estimand 正确分析该研究，不需要像 IPCW 这样的特殊方法。治疗转换的伴随事件是被定义的对照组治疗策略的一部分。正确的分析方法是，对所有随机化的患者进行随访，直到发生感兴趣的事件（死亡）或在 $H=12$ 个月时发生行政删失，**而不在治疗转换时进行删失**。由此产生的对照组生存数据将反映混合的经历（一些人转换，一些人没有），对此数据应用标准的非加权 Kaplan-Meier 估计量将提供 $S_C^{\\mathrm{true}}(t)$ 的一致估计。从每个臂组的标准、非加权 Kaplan-Meier 曲线计算出的 RMST 差异，可以得到 ITT 治疗效果的有效估计。", "answer": "$$\\boxed{0.1475}$$", "id": "4998718"}]}