{"hands_on_practices": [{"introduction": "交叉设计的一个主要吸引力在于其统计效率，因为它利用每个受试者作为自身的对照，从而消除了受试者间的变异。这个练习将带你实践一个核心技能：为一个$2 \\times 2$交叉试验计算所需的样本量。通过这个计算[@problem_id:5038503]，你将具体地理解与平行组设计相比，交叉设计如何能够用更少的受试者来达到相同的统计功效。", "problem": "一个转化医学团队正在计划一项平衡双周期、双治疗交叉研究（序列组 $A \\rightarrow B$ 和 $B \\rightarrow A$），以比较作用于某一药效学生物标志物的两种生物制剂配方。主要终点是为每位受试者在每个周期测量一次的连续生物标志物，治疗效应定义为均值差异 $A - B$，记为 $\\Delta$。在一项预试验中，每个周期的受试者内残差方差估计为 $\\sigma_{w}^{2}$，并且发现延滞效应可以忽略不计。为进行规划，假设无延滞效应，周期和序列效应可忽略，且每个周期的残差是方差为 $\\sigma_{w}^{2}$ 的独立同分布。\n\n使用中心极限定理 (CLT) 和大样本正态近似，对 $H_{0}:\\Delta=0$ 与 $H_{1}:\\Delta \\neq 0$ 的双侧检验，计算该交叉研究所需的受试者总数 $N$（连续值），以便在受试者内方差 $\\sigma_{w}^{2} = 1.0$、I 型错误率 $\\alpha = 0.05$（双侧）和把握度 $0.9$ 的条件下检测到 $\\Delta = 0.5$。将 $N$ 视为一个实值规划量（不要四舍五入到整数）。将您的最终数值答案四舍五入到四位有效数字。$N$ 没有相关的物理单位。", "solution": "用户希望计算一项平衡双周期、双治疗交叉研究所需的受试者总数 $N$。\n\n### 步骤 1：问题验证\n\n**1. 提取已知条件**\n- 研究设计：平衡双周期、双治疗（$A, B$）交叉研究。\n- 序列组：序列 1（$A \\rightarrow B$）和序列 2（$B \\rightarrow A$）。\n- 受试者总数：$N$，每个序列组有 $n = N/2$ 名受试者。\n- 终点：连续生物标志物。\n- 关注的治疗效应：$\\Delta = E[Y_A] - E[Y_B]$。\n- 假设：无延滞效应，周期和序列效应可忽略。\n- 统计模型：每个周期的残差独立同分布，方差为 $\\sigma_{w}^{2}$。\n- 假设检验：$H_{0}: \\Delta = 0$ 与 $H_{1}: \\Delta \\neq 0$ 的双侧检验。\n- 方法：中心极限定理 (CLT) 和大样本正态近似。\n- 计算参数：\n    - 待检测的目标效应量：$\\Delta = 0.5$。\n    - 受试者内方差：$\\sigma_{w}^{2} = 1.0$。\n    - I 型错误率：$\\alpha = 0.05$（双侧）。\n    - 把握度：$1 - \\beta = 0.9$。\n- 输出要求：计算 $N$ 的连续值，并四舍五入到四位有效数字。\n\n**2. 使用提取的已知条件进行验证**\n- **科学依据**：该问题在临床试验设计的统计理论中有充分依据。所有概念（交叉设计、把握度、样本量、I 型错误、方差分量）在生物统计学和转化医学中都是标准的。\n- **适定性**：该问题是适定的。它要求基于一套完整的指定参数和一个明确定义的统计模型来计算单个量（$N$）。存在唯一解。\n- **客观性**：问题以客观、定量的术语陈述，没有任何主观性或歧义。\n- **完整性和一致性**：所有必要的数据（$\\Delta, \\sigma_w^2, \\alpha, 1-\\beta$）都已提供。假设（例如，无延滞效应）被明确说明是为了规划目的，这是一种标准的实践简化。没有矛盾之处。\n- **可行性**：参数值对于生物医学研究是现实的。计算是标准的。\n- 其他无效性检查也已通过。该问题是生物统计学中一个标准的、不平凡的教科书练习题。\n\n**3. 结论与行动**\n- 问题有效。将继续进行求解。\n\n### 步骤 2：样本量公式推导\n\n设 $Y_{ijk}$ 为序列组 $j$ ($j=1, 2$) 中受试者 $i$ ($i = 1, \\dots, n$) 在周期 $k$ ($k=1, 2$) 的观测值。受试者总数为 $N = 2n$。\n- 序列 1 ($j=1$)：周期 1 接受治疗 $A$，周期 2 接受治疗 $B$。\n- 序列 2 ($j=2$)：周期 1 接受治疗 $B$，周期 2 接受治疗 $A$。\n\n假设无序列效应，观测值的统计模型为：\n$Y_{ijk} = \\mu + S_{ij} + P_k + T_{t(j,k)} + \\epsilon_{ijk}$\n其中 $\\mu$ 是总均值，$S_{ij}$ 是序列 $j$ 中受试者 $i$ 的随机效应，$P_k$ 是周期 $k$ 的固定效应，$T_{t(j,k)}$ 是在序列 $j$ 和周期 $k$ 中施用的治疗的固定效应，而 $\\epsilon_{ijk}$ 是受试者内随机误差。给定误差是独立同分布的，且 $E[\\epsilon_{ijk}]=0$ 和 $\\text{Var}(\\epsilon_{ijk}) = \\sigma_{w}^{2}$。\n\n交叉试验的主要分析利用受试者内差异来消除受试者间变异 $S_{ij}$。\n对于序列 1 ($A \\rightarrow B$) 中的受试者 $i$，受试者内差异为：\n$D_{i1} = Y_{i12} - Y_{i11} = (P_2 - P_1) + (T_B - T_A) + (\\epsilon_{i12} - \\epsilon_{i11})$\n对于序列 2 ($B \\rightarrow A$) 中的受试者 $i$，差异为：\n$D_{i2} = Y_{i22} - Y_{i21} = (P_2 - P_1) + (T_A - T_B) + (\\epsilon_{i22} - \\epsilon_{i21})$\n\n问题陈述假设周期效应可忽略，因此 $P_1 = P_2$。治疗效应为 $\\Delta = T_A - T_B$。\n差异的期望值为：\n$E[D_{i1}] = T_B - T_A = -\\Delta$\n$E[D_{i2}] = T_A - T_B = \\Delta$\n\n每个受试者内差异的方差为：\n$\\text{Var}(D_{ij}) = \\text{Var}(\\epsilon_{ij2} - \\epsilon_{ij1}) = \\text{Var}(\\epsilon_{ij2}) + \\text{Var}(\\epsilon_{ij1}) = \\sigma_{w}^{2} + \\sigma_{w}^{2} = 2\\sigma_{w}^{2}$\n因为误差是独立的。\n\n设 $\\bar{D}_1$ 和 $\\bar{D}_2$ 分别是序列 1 和序列 2 的平均差异。治疗效应 $\\Delta$ 的一个无偏估计量是：\n$\\hat{\\Delta} = \\frac{1}{2}(\\bar{D}_2 - \\bar{D}_1)$\n该估计量的期望值证实了它是无偏的：\n$E[\\hat{\\Delta}] = \\frac{1}{2}(E[\\bar{D}_2] - E[\\bar{D}_1]) = \\frac{1}{2}(\\Delta - (-\\Delta)) = \\Delta$\n\n估计量 $\\hat{\\Delta}$ 的方差为：\n$\\text{Var}(\\hat{\\Delta}) = \\text{Var}\\left(\\frac{1}{2}\\bar{D}_2 - \\frac{1}{2}\\bar{D}_1\\right) = \\frac{1}{4}\\text{Var}(\\bar{D}_2) + \\frac{1}{4}\\text{Var}(\\bar{D}_1)$（因为序列组是独立的）。\n由于 $\\bar{D}_j = \\frac{1}{n}\\sum_{i=1}^{n}D_{ij}$，我们有 $\\text{Var}(\\bar{D}_j) = \\frac{\\text{Var}(D_{ij})}{n} = \\frac{2\\sigma_{w}^{2}}{n}$。\n$\\text{Var}(\\hat{\\Delta}) = \\frac{1}{4}\\left(\\frac{2\\sigma_{w}^{2}}{n} + \\frac{2\\sigma_{w}^{2}}{n}\\right) = \\frac{1}{4}\\left(\\frac{4\\sigma_{w}^{2}}{n}\\right) = \\frac{\\sigma_{w}^{2}}{n}$\n代入 $n = N/2$，其中 $N$ 是受试者总数：\n$\\text{Var}(\\hat{\\Delta}) = \\frac{\\sigma_{w}^{2}}{N/2} = \\frac{2\\sigma_{w}^{2}}{N}$\n\n对于大样本量，根据中心极限定理，估计量 $\\hat{\\Delta}$ 近似服从正态分布：$\\hat{\\Delta} \\sim N(\\Delta, \\frac{2\\sigma_{w}^{2}}{N})$。\n用于检验 $H_{0}: \\Delta = 0$ 的检验统计量是 $Z = \\frac{\\hat{\\Delta}}{\\text{SE}(\\hat{\\Delta})} = \\frac{\\hat{\\Delta}}{\\sqrt{2\\sigma_{w}^{2}/N}}$。在 $H_0$ 下，$Z \\sim N(0,1)$。\n\n如果 $|Z| > z_{1-\\alpha/2}$，我们拒绝 $H_0$，其中 $z_{q}$ 是标准正态分布的第 $q$ 分位数。\n检验的把握度是在真实效应为 $\\Delta \\neq 0$ 时拒绝 $H_0$ 的概率：\n把握度 = $1 - \\beta = P\\left(\\left|\\frac{\\hat{\\Delta}}{\\sqrt{2\\sigma_{w}^{2}/N}}\\right| > z_{1-\\alpha/2} \\mid \\text{真实效应为 } \\Delta\\right)$\n对于 $\\Delta > 0$，这主要由上尾决定：\n$1 - \\beta \\approx P\\left(\\frac{\\hat{\\Delta}}{\\sqrt{2\\sigma_{w}^{2}/N}} > z_{1-\\alpha/2} \\mid \\text{真实效应为 } \\Delta\\right)$\n为计算此概率，我们在备择假设下对检验统计量进行标准化：\n$P\\left(\\frac{\\hat{\\Delta} - \\Delta}{\\sqrt{2\\sigma_{w}^{2}/N}} > z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma_{w}^{2}/N}}\\right)$\n左侧的项是一个标准正态变量。所以：\n$1 - \\beta = 1 - \\Phi\\left(z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma_{w}^{2}/N}}\\right)$\n其中 $\\Phi$ 是标准正态累积分布函数。\n取正态累积分布函数的反函数，$z_{1-\\beta} = \\Phi^{-1}(1-\\beta)$:\n$z_{1-\\beta} = z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma_{w}^{2}/N}}$\n注意，根据对称性，$z_{\\beta} = -z_{1-\\beta}$。典型的把握度公式写作：\n$-z_{\\beta} = z_{1-\\alpha/2} - \\frac{|\\Delta|}{\\sqrt{2\\sigma_{w}^{2}/N}}$\n$z_{1-\\beta} = \\frac{|\\Delta|}{\\sqrt{2\\sigma_{w}^{2}/N}} - z_{1-\\alpha/2}$\n这略有不同。标准的推导过程如下：我们希望 $H_1$ 下的临界值与 $H_0$ 下的临界值有足够远的距离。设临界值为 $C$。如果 $\\hat{\\Delta} > C$ 则拒绝。\nI 型错误：$P(\\hat{\\Delta} > C | \\Delta=0) = \\alpha/2 \\implies C = z_{1-\\alpha/2} \\sqrt{2\\sigma_w^2/N}$。\n把握度：$P(\\hat{\\Delta} > C | \\Delta) = 1-\\beta \\implies P(\\frac{\\hat{\\Delta}-\\Delta}{\\sqrt{2\\sigma_w^2/N}} > \\frac{C-\\Delta}{\\sqrt{2\\sigma_w^2/N}}) = 1-\\beta$。\n概率的参数是一个标准正态变量，所以 $\\frac{C-\\Delta}{\\sqrt{2\\sigma_w^2/N}} = z_{\\beta} = -z_{1-\\beta}$。\n代入 $C$：$\\frac{z_{1-\\alpha/2} \\sqrt{2\\sigma_w^2/N} - \\Delta}{\\sqrt{2\\sigma_w^2/N}} = -z_{1-\\beta}$。\n$z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma_w^2/N}} = -z_{1-\\beta}$。\n$\\frac{\\Delta}{\\sqrt{2\\sigma_w^2/N}} = z_{1-\\alpha/2} + z_{1-\\beta}$。\n解出 $N$：\n$\\sqrt{N} = \\frac{\\sqrt{2\\sigma_{w}^{2}}(z_{1-\\alpha/2} + z_{1-\\beta})}{\\Delta}$\n$N = \\frac{2\\sigma_{w}^{2}(z_{1-\\alpha/2} + z_{1-\\beta})^2}{\\Delta^2}$\n\n### 步骤 3：计算\n\n给定的参数是：\n- $\\Delta = 0.5$\n- $\\sigma_{w}^{2} = 1.0$\n- $\\alpha = 0.05$ (双侧)\n- $1 - \\beta = 0.9 \\implies \\beta = 0.1$\n\n我们需要从标准正态分布中找到相应的分位数 (z-score)：\n- 对于 I 型错误率：$z_{1-\\alpha/2} = z_{1-0.05/2} = z_{0.975}$。该值约为 $1.95996$。\n- 对于把握度：$z_{1-\\beta} = z_{1-0.1} = z_{0.9}$。该值约为 $1.28155$。\n\n现在，我们将这些值代入样本量公式：\n$N = \\frac{2(1.0)(1.95996 + 1.28155)^2}{(0.5)^2}$\n$N = \\frac{2(3.24151)^2}{0.25}$\n$N = 8 \\times (3.24151)^2$\n$N = 8 \\times 10.50738$\n$N \\approx 84.05904$\n\n问题要求将最终数值答案四舍五入到四位有效数字。\n$N \\approx 84.06$", "answer": "$$\\boxed{84.06}$$", "id": "5038503"}, {"introduction": "交叉设计的有效性严重依赖于一个关键假设：前一个治疗周期的效应不会“遗留”到下一个周期。这个练习将药代动力学原理与临床试验设计直接联系起来，要求你计算确保充分“洗脱”所需的最小时间[@problem_id:5038383]。掌握这项技能对于防止交叉研究中潜在的偏倚至关重要，并确保我们对治疗效果的估计是有效和可靠的。", "problem": "在一项转化医学的早期研究中，提出了一种两周期、两序列的受试者自身交叉设计，以比较一种新型抗炎药与安慰剂的效果。为了减轻周期之间的延滞效应，必须选择合适的清洗期间隔，以使得第二个周期开始时的残留药物浓度，相对于第一个周期单次口服给药后的峰浓度而言，实际上可以忽略不计。假设药物遵循一级消除药代动力学，每个周期给予单次剂量，且终端半衰期为 $t_{1/2} = 12$ 小时。确定所需的最小清洗期持续时间，使得第二个周期开始时的残留药物浓度低于第一个周期给药后观察到的峰浓度的 $0.01$。请用小时表示您的答案，并四舍五入至四位有效数字。", "solution": "用户提供了一个问题，要求计算一个两周期交叉临床试验中的最小清洗期持续时间。首先，将评估问题陈述的有效性。\n\n### 第一步：提取已知条件\n- **研究设计**：两周期、两序列受试者自身交叉设计。\n- **药代动力学模型**：一级消除。\n- **给药方案**：每个周期单次口服剂量。\n- **终端半衰期**：$t_{1/2} = 12$ 小时。\n- **清洗标准**：第二个周期开始时的残留药物浓度必须低于第一个周期观察到的峰浓度 ($C_{peak}$) 的 $f = 0.01$。\n- **要求输出**：最小清洗期持续时间 ($t_w$)，以小时为单位，并四舍五入至四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题很好地基于药代动力学原理，特别是一级消除，这是药物清除的标准模型。使用清洗期来最小化延滞效应的概念是临床药理学和转化医学中交叉研究设计的基础。\n- **适定性**：该问题是适定的。它提供了所有必要的参数（$t_{1/2}$，目标残留分数）和一个明确的目标（计算最小 $t_w$），从而可以得出一个唯一的、有意义的解。\n- **客观性**：该问题使用精确、客观的科学术语进行陈述。\n- **完整性与一致性**：信息充分且内部一致。在达到峰浓度后，使用具有一级消除的单室模型是此类计算的标准且适当的简化方法。\n- **现实性**：半衰期的值（$t_{1/2} = 12$ 小时）对于许多药物化合物是现实的。将浓度降低到峰浓度的 $1\\%$ 的要求是确保充分清洗的常见且严格的标准。\n\n### 第三步：结论与行动\n该问题在科学上是有效的、适定的，并包含足够的信息以获得唯一解。可以开始求解过程。\n\n### 求解推导\n经历一级消除的药物浓度 $C(t)$ 会根据指数衰减模型随时间降低。我们从达到峰浓度 $C_{peak}$ 的时间点开始测量时间 $t$。在随后的任何时间 $t$，浓度由下式给出：\n$$C(t) = C_{peak} \\exp(-k_e t)$$\n其中 $k_e$ 是一级消除速率常数。\n\n消除速率常数 $k_e$ 与药物的终端半衰期 $t_{1/2}$ 相关。根据定义，半衰期是浓度降低到其初始值 $50\\%$ 所需的时间。因此，在 $t = t_{1/2}$ 时：\n$$C(t_{1/2}) = \\frac{1}{2} C_{peak}$$\n将此代入衰减方程：\n$$\\frac{1}{2} C_{peak} = C_{peak} \\exp(-k_e t_{1/2})$$\n两边除以 $C_{peak}$（非零）得到：\n$$\\frac{1}{2} = \\exp(-k_e t_{1/2})$$\n对两边取自然对数：\n$$\\ln\\left(\\frac{1}{2}\\right) = -k_e t_{1/2}$$\n使用对数性质 $\\ln(1/x) = -\\ln(x)$：\n$$-\\ln(2) = -k_e t_{1/2}$$\n求解 $k_e$ 得：\n$$k_e = \\frac{\\ln(2)}{t_{1/2}}$$\n\n问题要求找到最小清洗期持续时间 $t_w$，使得第二个周期开始时的残留浓度 $C(t_w)$ 低于第一个周期峰浓度的 $f = 0.01$。这可以表示为不等式：\n$$C(t_w) \\le f \\cdot C_{peak}$$\n代入 $C(t_w)$ 的表达式：\n$$C_{peak} \\exp(-k_e t_w) \\le f \\cdot C_{peak}$$\n由于 $C_{peak}$ 是正浓度，我们可以两边都除以它：\n$$\\exp(-k_e t_w) \\le f$$\n为了求解 $t_w$，我们对两边取自然对数。由于自然对数是严格递增函数，不等号方向保持不变：\n$$\\ln(\\exp(-k_e t_w)) \\le \\ln(f)$$\n$$-k_e t_w \\le \\ln(f)$$\n两边乘以 $-1$ 会使不等号反向：\n$$k_e t_w \\ge -\\ln(f)$$\n使用对数性质 $-\\ln(f) = \\ln(1/f)$：\n$$k_e t_w \\ge \\ln\\left(\\frac{1}{f}\\right)$$\n分离出 $t_w$：\n$$t_w \\ge \\frac{\\ln(1/f)}{k_e}$$\n这个表达式给出了所需的最小清洗期持续时间。现在，我们代入 $k_e$ 的表达式：\n$$t_w \\ge \\frac{\\ln(1/f)}{\\frac{\\ln(2)}{t_{1/2}}}$$\n$$t_w \\ge t_{1/2} \\cdot \\frac{\\ln(1/f)}{\\ln(2)}$$\n最小清洗期持续时间 $t_{w,min}$ 是该不等式的下界。\n\n我们已知数值 $t_{1/2} = 12$ 小时和 $f = 0.01$。将这些值代入最小清洗期持续时间的表达式中：\n$$t_{w,min} = 12 \\text{ h} \\cdot \\frac{\\ln(1/0.01)}{\\ln(2)}$$\n$$t_{w,min} = 12 \\cdot \\frac{\\ln(100)}{\\ln(2)}$$\n现在，我们计算数值：\n$$t_{w,min} = 12 \\cdot \\frac{4.60517018598...}{0.69314718056...}$$\n$$t_{w,min} = 12 \\cdot 6.64385618977...$$\n$$t_{w,min} \\approx 79.726274277... \\text{ h}$$\n问题要求答案四舍五入至四位有效数字。\n$$t_{w,min} \\approx 79.73 \\text{ h}$$", "answer": "$$\n\\boxed{79.73}\n$$", "id": "5038383"}, {"introduction": "在理想情况下，我们通过足够长的洗脱期来消除遗留效应，但如果这一假设不成立会发生什么？这个练习将带你从计算转向理论推导，以量化当存在未被考虑的遗留效应时，对治疗效果的朴素估计会产生多大的偏倚[@problem_id:5038507]。通过这个推导，你将深刻理解为何遗留效应是交叉设计中的一个根本性威胁，以及为何在分析中对其进行恰当处理是至关重要的。", "problem": "在一项转化医学的平衡 $2 \\times 2$ 交叉研究中，研究人员比较了一种新型小分子抑制剂（治疗 $A$）和安慰剂（治疗 $B$）的药效学生物标志物。受试者被等量随机分配到序列 $AB$ 或 $BA$ 组，并在时期 $1$ 和时期 $2$ 对每位受试者进行观测。令 $Y_{i,s,p}$ 表示序列 $s \\in \\{AB, BA\\}$ 中受试者 $i$ 在时期 $p \\in \\{1,2\\}$ 的结局。假设采用带受试者特异性随机截距的标准线性可加模型：\n$$\nY_{i,s,p} \\;=\\; \\mu \\;+\\; b_i \\;+\\; \\pi_p \\;+\\; \\tau_{T(s,p)} \\;+\\; \\kappa_{s,p} \\;+\\; \\varepsilon_{i,s,p},\n$$\n其中 $\\mu$ 是总均值，$b_i$ 是受试者效应且 $\\mathbb{E}[b_i]=0$，$\\pi_p$ 是时期效应，$\\tau_{T(s,p)}$ 是在该序列和时期内实际施用的治疗的直接治疗效应，$\\kappa_{s,p}$ 是仅影响时期 $2$ 的滞留效应项，$\\varepsilon_{i,s,p}$ 是独立的均值为零、方差恒定且独立于所有设计因素的误差。将具有科学意义的真实直接治疗对比定义为 $\\delta = \\tau_A - \\tau_B$。\n\n假设存在仅限于时期 $2$ 的一阶微分滞留效应，即如果某受试者在时期 $1$ 接受了治疗 $T \\in \\{A,B\\}$，则该受试者在时期 $2$ 的滞留效应为 $\\kappa_{s,2} = c_T$，而在时期 $1$ 的滞留效应为 $\\kappa_{s,1}=0$。将微分滞留效应的大小定义为 $c = c_A - c_B$。\n\n研究人员进行了一项忽略滞留效应和时期效应的朴素分析，通过所有时期的边际均值之差来估计治疗对比：\n$$\n\\hat{\\delta} \\;=\\; \\bar{Y}_A \\;-\\; \\bar{Y}_B,\n$$\n其中 $\\bar{Y}_A$ 是在治疗 $A$ 下观测到的所有结局（跨序列和时期合并）的样本均值，而 $\\bar{Y}_B$ 对于治疗 $B$ 的定义与此类似。在上述假设和对序列进行平衡分配的条件下，推导 $\\hat{\\delta}$ 对 $\\delta$ 的偏差，并将其表示为 $c$ 的函数。用 $c$ 将你的最终答案表示为单个闭式解析表达式。无需进行数值四舍五入。", "solution": "该问题要求推导在一个 $2 \\times 2$ 交叉研究中，治疗对比的朴素估计量的偏差。参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的偏差定义为 $\\mathbb{E}[\\hat{\\theta}] - \\theta$。在本问题中，估计量是 $\\hat{\\delta}$，感兴趣的参数是 $\\delta$。因此，我们需要计算 $\\mathbb{E}[\\hat{\\delta}] - \\delta$。\n\n朴素估计量由 $\\hat{\\delta} = \\bar{Y}_A - \\bar{Y}_B$ 给出，其中 $\\bar{Y}_A$ 和 $\\bar{Y}_B$ 分别是在治疗 $A$ 和 $B$ 下观测到的所有结局的样本均值。根据期望的线性性，该估计量的期望值为 $\\mathbb{E}[\\hat{\\delta}] = \\mathbb{E}[\\bar{Y}_A] - \\mathbb{E}[\\bar{Y}_B]$。\n\n设 $N$ 为研究中的总受试者人数。该设计是平衡的，因此有 $N/2$ 名受试者被随机分配到序列 $AB$ 组，有 $N/2$ 名受试者被随机分配到序列 $BA$ 组。设 $S_{AB}$ 表示序列 $AB$ 组中的受试者集合，$S_{BA}$ 表示序列 $BA$ 组中的受试者集合。我们有 $|S_{AB}| = |S_{BA}| = N/2$。\n\n在治疗 $A$ 下的总观测数为 $N$。这些观测值来自时期 $1$ 期间序列 $AB$ 组的受试者和时期 $2$ 期间序列 $BA$ 组的受试者。因此，样本均值 $\\bar{Y}_A$ 为：\n$$\n\\bar{Y}_A = \\frac{1}{N} \\left( \\sum_{i \\in S_{AB}} Y_{i,AB,1} + \\sum_{i \\in S_{BA}} Y_{i,BA,2} \\right)\n$$\n类似地，在治疗 $B$ 下的总观测数也为 $N$。这些观测值来自时期 $1$ 期间序列 $BA$ 组的受试者和时期 $2$ 期间序列 $AB$ 组的受试者。样本均值 $\\bar{Y}_B$ 为：\n$$\n\\bar{Y}_B = \\frac{1}{N} \\left( \\sum_{i \\in S_{BA}} Y_{i,BA,1} + \\sum_{i \\in S_{AB}} Y_{i,AB,2} \\right)\n$$\n接下来，我们使用给定的线性模型来求单个观测值 $Y_{i,s,p}$ 的期望值：\n$$\nY_{i,s,p} = \\mu + b_i + \\pi_p + \\tau_{T(s,p)} + \\kappa_{s,p} + \\varepsilon_{i,s,p}\n$$\n取期望并使用假设 $\\mathbb{E}[b_i]=0$ 和 $\\mathbb{E}[\\varepsilon_{i,s,p}]=0$，我们得到：\n$$\n\\mathbb{E}[Y_{i,s,p}] = \\mu + \\pi_p + \\tau_{T(s,p)} + \\kappa_{s,p}\n$$\n我们将此公式应用于研究中的四种特定情况：\n$1$. 对于序列 $AB$ 组（$s=AB$）、时期 $1$（$p=1$）的受试者：治疗为 $A$，因此 $T(AB,1)=A$。滞留效应项为 $\\kappa_{AB,1}=0$。\n$$ \\mathbb{E}[Y_{i,AB,1}] = \\mu + \\pi_1 + \\tau_A $$\n$2$. 对于序列 $AB$ 组（$s=AB$）、时期 $2$（$p=2$）的受试者：治疗为 $B$，因此 $T(AB,2)=B$。滞留效应来自时期 $1$ 的治疗 $A$，因此 $\\kappa_{AB,2}=c_A$。\n$$ \\mathbb{E}[Y_{i,AB,2}] = \\mu + \\pi_2 + \\tau_B + c_A $$\n$3$. 对于序列 $BA$ 组（$s=BA$）、时期 $1$（$p=1$）的受试者：治疗为 $B$，因此 $T(BA,1)=B$。滞留效应项为 $\\kappa_{BA,1}=0$。\n$$ \\mathbb{E}[Y_{i,BA,1}] = \\mu + \\pi_1 + \\tau_B $$\n$4$. 对于序列 $BA$ 组（$s=BA$）、时期 $2$（$p=2$）的受试者：治疗为 $A$，因此 $T(BA,2)=A$。滞留效应来自时期 $1$ 的治疗 $B$，因此 $\\kappa_{BA,2}=c_B$。\n$$ \\mathbb{E}[Y_{i,BA,2}] = \\mu + \\pi_2 + \\tau_A + c_B $$\n现在我们可以计算样本均值 $\\bar{Y}_A$ 和 $\\bar{Y}_B$ 的期望值。\n$$\n\\mathbb{E}[\\bar{Y}_A] = \\frac{1}{N} \\left( \\sum_{i \\in S_{AB}} \\mathbb{E}[Y_{i,AB,1}] + \\sum_{i \\in S_{BA}} \\mathbb{E}[Y_{i,BA,2}] \\right)\n$$\n由于在给定序列和时期内，所有受试者的期望值是相同的，我们有：\n$$\n\\mathbb{E}[\\bar{Y}_A] = \\frac{1}{N} \\left( |S_{AB}| \\cdot \\mathbb{E}[Y_{i,AB,1}] + |S_{BA}| \\cdot \\mathbb{E}[Y_{i,BA,2}] \\right)\n$$\n代入 $|S_{AB}| = |S_{BA}| = N/2$ 和期望值的表达式：\n$$\n\\mathbb{E}[\\bar{Y}_A] = \\frac{1}{N} \\left( \\frac{N}{2}(\\mu + \\pi_1 + \\tau_A) + \\frac{N}{2}(\\mu + \\pi_2 + \\tau_A + c_B) \\right)\n$$\n$$\n\\mathbb{E}[\\bar{Y}_A] = \\frac{1}{2}(\\mu + \\pi_1 + \\tau_A) + \\frac{1}{2}(\\mu + \\pi_2 + \\tau_A + c_B) = \\mu + \\tau_A + \\frac{\\pi_1 + \\pi_2}{2} + \\frac{c_B}{2}\n$$\n类似地，对于 $\\bar{Y}_B$：\n$$\n\\mathbb{E}[\\bar{Y}_B] = \\frac{1}{N} \\left( \\sum_{i \\in S_{BA}} \\mathbb{E}[Y_{i,BA,1}] + \\sum_{i \\in S_{AB}} \\mathbb{E}[Y_{i,AB,2}] \\right)\n$$\n$$\n\\mathbb{E}[\\bar{Y}_B] = \\frac{1}{N} \\left( |S_{BA}| \\cdot \\mathbb{E}[Y_{i,BA,1}] + |S_{AB}| \\cdot \\mathbb{E}[Y_{i,AB,2}] \\right)\n$$\n$$\n\\mathbb{E}[\\bar{Y}_B] = \\frac{1}{N} \\left( \\frac{N}{2}(\\mu + \\pi_1 + \\tau_B) + \\frac{N}{2}(\\mu + \\pi_2 + \\tau_B + c_A) \\right)\n$$\n$$\n\\mathbb{E}[\\bar{Y}_B] = \\frac{1}{2}(\\mu + \\pi_1 + \\tau_B) + \\frac{1}{2}(\\mu + \\pi_2 + \\tau_B + c_A) = \\mu + \\tau_B + \\frac{\\pi_1 + \\pi_2}{2} + \\frac{c_A}{2}\n$$\n现在我们求估计量 $\\hat{\\delta}$ 的期望：\n$$\n\\mathbb{E}[\\hat{\\delta}] = \\mathbb{E}[\\bar{Y}_A] - \\mathbb{E}[\\bar{Y}_B]\n$$\n$$\n\\mathbb{E}[\\hat{\\delta}] = \\left( \\mu + \\tau_A + \\frac{\\pi_1 + \\pi_2}{2} + \\frac{c_B}{2} \\right) - \\left( \\mu + \\tau_B + \\frac{\\pi_1 + \\pi_2}{2} + \\frac{c_A}{2} \\right)\n$$\n项 $\\mu$ 和 $\\frac{\\pi_1 + \\pi_2}{2}$ 被消去：\n$$\n\\mathbb{E}[\\hat{\\delta}] = (\\tau_A - \\tau_B) + (\\frac{c_B}{2} - \\frac{c_A}{2}) = (\\tau_A - \\tau_B) - \\frac{1}{2}(c_A - c_B)\n$$\n使用所提供的定义，$\\delta = \\tau_A - \\tau_B$ 和 $c = c_A - c_B$。我们可以写成：\n$$\n\\mathbb{E}[\\hat{\\delta}] = \\delta - \\frac{c}{2}\n$$\n最后，$\\hat{\\delta}$ 的偏差为：\n$$\n\\text{Bias}(\\hat{\\delta}) = \\mathbb{E}[\\hat{\\delta}] - \\delta = \\left(\\delta - \\frac{c}{2}\\right) - \\delta = -\\frac{c}{2}\n$$\n朴素估计量的偏差是微分滞留效应大小的 $-\\frac{1}{2}$ 倍。", "answer": "$$\n\\boxed{-\\frac{c}{2}}\n$$", "id": "5038507"}]}