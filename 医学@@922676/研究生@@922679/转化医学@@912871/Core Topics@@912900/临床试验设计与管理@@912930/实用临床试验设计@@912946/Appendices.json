{"hands_on_practices": [{"introduction": "实用性试验通常不是逐个随机分配患者，而是将个体分组或“整群”（如诊所或医院）进行随机化。这种做法导致同一群组内参与者之间存在统计学上的相关性，在计算样本量时必须考虑到这一点。本练习将引导您从第一性原理出发，推导“设计效应”（$DE$），这是在整群随机设计中为保持统计功效而对样本量进行调整的关键因子 [@problem_id:5047061]。", "problem": "一项转化医学领域的实用性整群随机试验将评估一个在诊所层面实施的策略，并在随访中测量个体患者的结局。假设以下设计特征和模型假设成立：\n\n- 共有 $k$ 个群组（诊所），每个群组正好招募 $m$ 名患者，因此分析的总患者数为 $n=k\\,m$。\n- 在任何一个诊所内，患者结局的分布相同，其边际方差为 $\\sigma^{2}$，组内相关系数 (ICC) $\\rho$ 为一个常数，定义为同一诊所内任意两个不同患者结局之间的相关性。\n- 来自不同诊所的结局是相互独立的。\n- 作为基准的个体随机化设计（简单随机抽样，SRS）使用相同的结局和分析模型，其独立性假设下患者层面样本均值的方差是效率比较的标准基线。\n\n从方差、协方差和组内相关系数的核心定义出发，并且不使用任何预先推导的整群设计公式，完成以下任务：\n\n1. 在所述的等规模整群结构下，推导总体患者层面样本均值的方差的解析表达式，用 $k$、$m$、$\\sigma^{2}$ 和 $\\rho$ 表示。\n2. 将设计效应定义为该整群方差与分析总患者数相同时的简单随机抽样方差之比，并将设计效应简化为仅含 $m$ 和 $\\rho$ 的闭式表达式。\n3. 给定 $m=31$ 和 $\\rho=0.02$，使用设计效应计算整群随机化设计需要多少总患者数，才能达到与需要 $n_{\\mathrm{SRS}}=700$ 名患者的个体随机化设计相同的精度。\n\n将第3部分的单一数值答案作为整群随机化设计所需的总患者数给出。如果该值为整数，则无需四舍五入。如果需要四舍五入，请将答案保留三位有效数字。最终答案以患者计数形式表示（无需百分比或物理单位）。", "solution": "该问题要求计算整群抽样下样本均值的方差、相应的设计效应，然后使用给定值进行数值计算。我们从基本定义开始。\n\n设 $Y_{cj}$ 表示诊所 $c$ 中患者 $j$ 的结局，其中 $c\\in\\{1,\\dots,k\\}$ 且 $j\\in\\{1,\\dots,m\\}$。总体患者层面的样本均值为\n$$\n\\bar{Y}=\\frac{1}{k\\,m}\\sum_{c=1}^{k}\\sum_{j=1}^{m}Y_{cj}.\n$$\n根据方差的性质，$\\bar{Y}$ 的方差为\n$$\n\\operatorname{Var}(\\bar{Y})=\\operatorname{Var}\\!\\left(\\frac{1}{k\\,m}\\sum_{c=1}^{k}\\sum_{j=1}^{m}Y_{cj}\\right)=\\frac{1}{(k\\,m)^{2}}\\operatorname{Var}\\!\\left(\\sum_{c=1}^{k}\\sum_{j=1}^{m}Y_{cj}\\right).\n$$\n我们使用方差-协方差恒等式来分解总和的方差，\n$$\n\\operatorname{Var}\\!\\left(\\sum_{c=1}^{k}\\sum_{j=1}^{m}Y_{cj}\\right)=\\sum_{c=1}^{k}\\sum_{j=1}^{m}\\operatorname{Var}(Y_{cj})+\\sum_{c=1}^{k}\\sum_{j\\neq \\ell}\\operatorname{Cov}(Y_{cj},Y_{c\\ell})+\\sum_{c\\neq d}\\sum_{j=1}^{m}\\sum_{\\ell=1}^{m}\\operatorname{Cov}(Y_{cj},Y_{d\\ell}).\n$$\n由于诊所之间相互独立，跨诊所的协方差项为零：\n$$\n\\operatorname{Cov}(Y_{cj},Y_{d\\ell})=0\\quad\\text{for}\\quad c\\neq d.\n$$\n在同一个诊所内，我们有相同的边际方差 $\\operatorname{Var}(Y_{cj})=\\sigma^{2}$，并且根据组内相关系数 (ICC) $\\rho$ 的定义，对于同一诊所内不同的患者 $j\\neq \\ell$，\n$$\n\\operatorname{Cov}(Y_{cj},Y_{c\\ell})=\\rho\\,\\sigma^{2}.\n$$\n因此，\n$$\n\\operatorname{Var}\\!\\left(\\sum_{c=1}^{k}\\sum_{j=1}^{m}Y_{cj}\\right)=\\underbrace{k\\,m\\,\\sigma^{2}}_{\\text{sum of variances}}+\\underbrace{k\\cdot m(m-1)\\cdot \\rho\\,\\sigma^{2}}_{\\text{sum of within-clinic covariances}}.\n$$\n除以 $(k\\,m)^{2}$ 得到 $\\operatorname{Var}(\\bar{Y})$：\n$$\n\\operatorname{Var}(\\bar{Y})=\\frac{1}{(k\\,m)^{2}}\\left[k\\,m\\,\\sigma^{2}+k\\,m(m-1)\\,\\rho\\,\\sigma^{2}\\right]=\\frac{\\sigma^{2}}{k\\,m}\\left[1+(m-1)\\rho\\right].\n$$\n这便完成了第1部分。\n\n对于第2部分，设计效应定义为整群方差与 $n=k\\,m$ 个独立观测值的简单随机抽样 (SRS) 下的方差之比。在简单随机抽样（独立结局）下，样本均值的方差为\n$$\n\\operatorname{Var}_{\\mathrm{SRS}}(\\bar{Y})=\\frac{\\sigma^{2}}{k\\,m}.\n$$\n因此，设计效应 $\\mathrm{DE}$ 为\n$$\n\\mathrm{DE}=\\frac{\\operatorname{Var}(\\bar{Y})}{\\operatorname{Var}_{\\mathrm{SRS}}(\\bar{Y})}=\\frac{\\frac{\\sigma^{2}}{k\\,m}\\left[1+(m-1)\\rho\\right]}{\\frac{\\sigma^{2}}{k\\,m}}=1+(m-1)\\rho.\n$$\n这就得到了仅含 $m$ 和 $\\rho$ 的闭式表达式。\n\n对于第3部分，设计效应给出了为达到与个体随机化基准相同的精度所需的总患者数的乘法膨胀因子。如果个体随机化设计需要 $n_{\\mathrm{SRS}}=700$ 名患者，且每个群组有 $m=31$ 名患者，$\\rho=0.02$，那么\n$$\n\\mathrm{DE}=1+(m-1)\\rho=1+\\left(31-1\\right)\\cdot 0.02=1+30\\cdot 0.02=1+0.6=1.6.\n$$\n在整群随机化设计下所需的总患者数为\n$$\nn_{\\mathrm{cluster}}=n_{\\mathrm{SRS}}\\times \\mathrm{DE}=700\\times 1.6=1120.\n$$\n由于 $1120$ 是整数，因此无需四舍五入。", "answer": "$$\\boxed{1120}$$", "id": "5047061"}, {"introduction": "实用性试验的一个决定性特征是在真实世界条件下评估干预措施，而在这种条件下，患者的依从性很少是完美的。主要的“意向治疗”（ITT）分析提供了干预措施效果的无偏估计，但这种效应通常会因不依从性和交叉污染而被稀释。本实践问题演示了如何对这种稀释效应进行建模，将理想的“按方案”（per-protocol）效应与您在现实中预期观察到的 ITT 效应联系起来 [@problem_id:5047017]。", "problem": "在转化医学背景下，进行了一项双臂实用性随机对照试验 (RCT)，以评估新的诊疗路径与常规护理的效果，其主要临床终点为在 $90$ 天时测量的二元变量。该试验采用意向性治疗 (ITT) 估计量，定义为分配到干预组的单位与分配到对照组的单位之间预期终点的差异，无论后续的依从性如何。随机化在操作上被实施，以确保分组指标 $Z \\in \\{0,1\\}$ 独立于所有随机化前的特征和潜在结局。定义 $D \\in \\{0,1\\}$ 为实际接受干预（至少达到最低有效暴露水平）的指标，并认识到由于真实世界的实施（交叉和不依从），两组都可能存在不完全依从性。\n\n假设以下简单的依从性模型，该模型与实用性试验条件和转化实施相一致：\n- 在干预组中，达到最低有效暴露水平的概率为 $P(D=1 \\mid Z=1) = a_{T}$。\n- 在对照组中，达到最低有效暴露水平的交叉污染概率为 $P(D=1 \\mid Z=0) = a_{C}$。\n\n假设一个关于风险差的结构均值模型，该模型捕捉了接受治疗对终点期望值的恒定平均因果效应，$E[Y \\mid D] = \\alpha + \\delta D$，其中 $Y \\in \\{0,1\\}$ 表示终点，$\\delta$ 表示接受 ($D=1$) 和未接受 ($D=0$) 干预之间的符合方案集风险差。该模型应在稳定单位治疗价值假设 (SUTVA)、无干扰和加性因果均值结构的条件下，在边际总体水平上进行解释。\n\n从意向性治疗 (ITT) 估计量 ($E[Y \\mid Z=1] - E[Y \\mid Z=0]$) 的核心定义、随机化以及上述依从性和结构均值假设出发，使用期望定律推导出预期的 ITT 估计量，使其成为 $a_{T}$、$a_{C}$ 和 $\\delta$ 的函数。然后，在一个科学上合理的实用性场景中，给定 $a_{T} = 0.78$、$a_{C} = 0.17$ 以及符合方案集风险差 $\\delta = -0.132$（将负值解释为接受干预带来的有益风险降低），计算由此产生的预期 ITT 风险差。\n\n将您的最终答案表示为小数（而非百分比），并四舍五入到四位有效数字。", "solution": "问题要求完成两项任务：首先，在一个实用性随机对照试验 (RCT) 中，推导预期意向性治疗 (ITT) 估计量的表达式，使其成为依从性概率、交叉污染概率和符合方案集效应的函数；其次，使用提供的数据计算该估计量的数值。\n\n首先，我们来验证问题的有效性。问题陈述是自洽的，并在科学上基于临床试验方法学和因果推断的原理。ITT 估计量、依从性 ($D$)、分组 ($Z$)、结构均值模型以及依从性概率 ($a_T$, $a_C$) 的定义在该领域是标准的。参数值对于一个真实世界的实用性试验是合理的。该问题提法恰当、客观且可形式化。因此，该问题被认为是有效的，可以推导出解决方案。\n\nITT 估计量定义为分配到干预组和分配到对照组的单位之间预期结局的差异。设 $Y$ 为二元终点，$Z \\in \\{0, 1\\}$ 为随机分组指标，其中 $Z=1$ 代表干预组，$Z=0$ 代表对照组。ITT 估计量，我们记为 $\\Delta_{\\text{ITT}}$，是：\n$$\n\\Delta_{\\text{ITT}} = E[Y \\mid Z=1] - E[Y \\mid Z=0]\n$$\n为继续推导，我们使用全期望定律，根据实际接受干预的指标 $D \\in \\{0, 1\\}$，分解每组的条件期望。对于任意组别 $z \\in \\{0,1\\}$，我们有：\n$$\nE[Y \\mid Z=z] = E[E[Y \\mid D, Z=z] \\mid Z=z]\n$$\n问题陈述了一个结局的结构均值模型：$E[Y \\mid D] = \\alpha + \\delta D$。该模型意味着预期结局仅取决于所接受的治疗 ($D$)，而不取决于被分配的治疗 ($Z$)。这是一个关键假设，称为排除限制：分配到某个治疗组仅通过接受该治疗本身来影响结局。在此假设下，$E[Y \\mid D, Z=z] = E[Y \\mid D]$。因此，我们可以将结构模型代入我们的表达式中：\n$$\nE[Y \\mid Z=z] = E[\\alpha + \\delta D \\mid Z=z]\n$$\n根据期望的线性性质，这变为：\n$$\nE[Y \\mid Z=z] = E[\\alpha \\mid Z=z] + E[\\delta D \\mid Z=z] = \\alpha + \\delta E[D \\mid Z=z]\n$$\n一个指示变量的期望是它所指示事件的概率。因此，$E[D \\mid Z=z] = P(D=1 \\mid Z=z)$。\n\n现在，我们将这个通用公式应用于试验的每个组。\n\n对于干预组 ($Z=1$)：\n接受干预的概率给出为 $P(D=1 \\mid Z=1) = a_T$。\n因此，干预组的预期结局是：\n$$\nE[Y \\mid Z=1] = \\alpha + \\delta P(D=1 \\mid Z=1) = \\alpha + \\delta a_T\n$$\n\n对于对照组 ($Z=0$)：\n接受干预的概率（由于交叉污染）给出为 $P(D=1 \\mid Z=0) = a_C$。\n因此，对照组的预期结局是：\n$$\nE[Y \\mid Z=0] = \\alpha + \\delta P(D=1 \\mid Z=0) = \\alpha + \\delta a_C\n$$\n\n现在我们可以将这些表达式代回 ITT 估计量的定义中：\n$$\n\\Delta_{\\text{ITT}} = (\\alpha + \\delta a_T) - (\\alpha + \\delta a_C)\n$$\n代表未接受治疗时基线预期结局的项 $\\alpha$ 被消掉了：\n$$\n\\Delta_{\\text{ITT}} = \\delta a_T - \\delta a_C = \\delta (a_T - a_C)\n$$\n这个推导出的表达式表明，ITT 效应是符合方案集效应 ($\\delta$) 乘以两个随机组之间接受治疗概率的差值。\n\n任务的第二部分是根据给定的具体参数计算 $\\Delta_{\\text{ITT}}$ 的数值：\n- 干预组的依从性：$a_T = 0.78$\n- 对照组的交叉污染：$a_C = 0.17$\n- 符合方案集风险差：$\\delta = -0.132$\n\n将这些值代入我们推导出的公式中：\n$$\n\\Delta_{\\text{ITT}} = -0.132 \\times (0.78 - 0.17)\n$$\n首先，我们计算概率差：\n$$\na_T - a_C = 0.78 - 0.17 = 0.61\n$$\n现在，我们将这个差值乘以符合方案集效应 $\\delta$：\n$$\n\\Delta_{\\text{ITT}} = -0.132 \\times 0.61\n$$\n执行乘法运算：\n$$\n\\Delta_{\\text{ITT}} = -0.08052\n$$\n问题要求最终答案是保留四位有效数字的小数。计算出的值为 $-0.08052$。第一个非零的起始数字是 $8$，这是第一位有效数字。随后的数字是 $0$、$5$ 和 $2$。因此，数字 $-0.08052$ 恰好有四位有效数字。无需四舍五入。预期的 ITT 风险差为 $-0.08052$。", "answer": "$$\\boxed{-0.08052}$$", "id": "5047017"}, {"introduction": "虽然意向治疗分析至关重要，但研究人员通常对遵守治疗方案的参与者中的“按方案”效应感兴趣。然而，这种分析破坏了最初的随机化，使其容易受到混杂因素的影响。本练习介绍了 E 值（E-value），这是一种现代的敏感性分析工具，它量化了一个未测量的混杂因素需要多强才能完全解释观察到的关联，从而为解释此类非随机化比较提供了更严谨的方法 [@problem_id:5046955]。", "problem": "一个转化医学团队正在进行一项实用性随机试验，比较在真实世界医疗中两种旨在提高一种新批准的抗高血压药物使用率的策略。由于依从性差异很大，主要分析是仅限于达到了预先指定依从性阈值的参与者的符合方案（Per-Protocol, PP）分析。尽管进行了随机化，但PP分析可能会受到未测量的混杂因素的影响，因为依从性可能受到同样会影响结局的患者特征的影响。观察到的PP关联性显示，新策略相对于常规护理的90天中风风险的风险比（Risk Ratio, $RR$）为$1.91$。\n\n使用风险比标度，并在以下科学标准的构想下进行分析：\n- 由单个二元未测量混杂因素引起的混杂偏倚受其与结局和暴露在$RR$标度上的关联函数的限制。\n- 证据值（E-value）被定义为：在已测协变量的条件下，假设没有其他偏倚，一个未测量混杂因素需要与暴露和结局同时具有的最小关联强度（在$RR$标度上），才能完全解释掉观察到的关联（即将观察到的$RR$降至$1$）。\n\n仅从风险比的核心定义以及混杂关联与$RR$标度上偏倚之间的边界关系出发，推导当观察到的关联表明有害时（即$RR>1$），E值关于观察到的$RR$的闭式表达式。然后，在$RR=1.91$处计算您的表达式的值。将最终数值答案四舍五入至四位有效数字。以纯数字形式提供答案，不带任何单位。", "solution": "问题陈述已被评估并被认为是有效的。它在科学上基于流行病学和因果推断的原理，特别是关于未测量混杂因素的敏感性分析。该问题提法恰当、客观，并包含推导所需表达式和计算数值所需的所有必要信息和定义。\n\n设$RR_{obs}$为观察到的风险比。问题陈述$RR_{obs} = 1.91$。设$RR_{true}$为真实的、无混杂的风险比。设$U$为单个二元未测量混杂因素。设$RR_{EU}$为关联混杂因素$U$与暴露$E$的风险比，设$RR_{UD}$为在暴露条件下，关联混杂因素$U$与结局$D$的风险比。\n\n问题陈述混杂偏倚受这些关联的函数限制。观察到的风险比与真实风险比之间的关系可以表示为$RR_{obs} = RR_{true} \\times B$，其中$B$是偏倚因子。对于单个混杂因素，偏倚因子$B$受以下表达式限制：\n$$ B \\le \\frac{RR_{EU} \\cdot RR_{UD}}{RR_{EU} + RR_{UD} - 1} $$\nE值被定义为未测量混杂因素需要与暴露和结局同时具有的最小关联强度，以完全“解释掉”观察到的关联。解释掉关联意味着真实风险比为空值，即$RR_{true}=1$。\n\n在$RR_{true}=1$的条件下，观察到的风险比完全归因于偏倚因子，因此$RR_{obs} = B$。将此代入不等式得到：\n$$ RR_{obs} \\le \\frac{RR_{EU} \\cdot RR_{UD}}{RR_{EU} + RR_{UD} - 1} $$\nE值的定义规定，这个最小关联强度（我们称之为$E_v$）对于暴露和结局是相同的。因此，我们设$RR_{EU} = RR_{UD} = E_v$。不等式变为：\n$$ RR_{obs} \\le \\frac{E_v \\cdot E_v}{E_v + E_v - 1} = \\frac{E_v^2}{2E_v - 1} $$\n为了找到满足此条件的$E_v$的最小值，我们解这个等式，因为函数$f(x) = \\frac{x^2}{2x-1}$在$x>1$时是单调递增的。\n$$ RR_{obs} = \\frac{E_v^2}{2E_v - 1} $$\n重新整理这个方程以求解$E_v$：\n$$ RR_{obs} (2E_v - 1) = E_v^2 $$\n$$ 2 \\cdot RR_{obs} \\cdot E_v - RR_{obs} = E_v^2 $$\n这可以写成标准二次方程$ax^2+bx+c=0$的形式，其中$x = E_v$：\n$$ E_v^2 - (2 \\cdot RR_{obs}) E_v + RR_{obs} = 0 $$\n我们使用二次公式$E_v = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$求解$E_v$，其中$a=1$，$b=-2 \\cdot RR_{obs}$，且$c=RR_{obs}$。\n$$ E_v = \\frac{-(-2 \\cdot RR_{obs}) \\pm \\sqrt{(-2 \\cdot RR_{obs})^2 - 4(1)(RR_{obs})}}{2(1)} $$\n$$ E_v = \\frac{2 \\cdot RR_{obs} \\pm \\sqrt{4 \\cdot RR_{obs}^2 - 4 \\cdot RR_{obs}}}{2} $$\n$$ E_v = \\frac{2 \\cdot RR_{obs} \\pm \\sqrt{4(RR_{obs}^2 - RR_{obs})}}{2} $$\n$$ E_v = \\frac{2 \\cdot RR_{obs} \\pm 2\\sqrt{RR_{obs}^2 - RR_{obs}}}{2} $$\n$$ E_v = RR_{obs} \\pm \\sqrt{RR_{obs}^2 - RR_{obs}} $$\n问题是关于表明有害的观察关联，所以$RR_{obs} > 1$。E值本身是一个风险比，也必须大于或等于$1$。函数$f(E_v) = \\frac{E_v^2}{2E_v-1}$在$E_v>1$时是递增的。它的反函数，即给出$E_v$作为$RR_{obs}$的函数的表达式，也必须是一个递增函数。根$RR_{obs} - \\sqrt{RR_{obs}^2 - RR_{obs}}$对于$RR_{obs}>1$是一个递减函数，其值小于$1$。根$RR_{obs} + \\sqrt{RR_{obs}^2 - RR_{obs}}$对于$RR_{obs}>1$是一个递增函数，并且总是大于$1$。因此，我们必须选择正根。\n\n推导出的E值的闭式表达式为：\n$$ E_v = RR_{obs} + \\sqrt{RR_{obs}^2 - RR_{obs}} $$\n现在，我们对给定值$RR_{obs} = 1.91$计算此表达式。\n$$ E_v = 1.91 + \\sqrt{1.91^2 - 1.91} $$\n$$ E_v = 1.91 + \\sqrt{3.6481 - 1.91} $$\n$$ E_v = 1.91 + \\sqrt{1.7381} $$\n$$ E_v \\approx 1.91 + 1.31837018 $$\n$$ E_v \\approx 3.22837018 $$\n将最终数值答案四舍五入至四位有效数字，我们得到$3.228$。\n\n这个结果意味着，要完全解释掉观察到的$1.91$的风险比，一个未测量的混杂因素需要在已测协变量的条件下，与新策略（暴露）和中风风险（结局）的关联风险比均至少为$3.228$。", "answer": "$$\\boxed{3.228}$$", "id": "5046955"}]}