{"hands_on_practices": [{"introduction": "在剂量探索研究中，一个核心假设是毒性概率会随着剂量的增加而增加或保持不变。然而，由于临床试验中样本量通常较小，随机变异性常常导致观测到的经验毒性率违反这一单调性假设。本练习介绍汇集邻近违规者算法（PAVA），这是一种重要的非参数方法，用于校正此类违规，从而生成一组与数据最吻合的单调递增的毒性概率估计值，这是进行后续剂量决策的关键一步。[@problem_id:5029471]", "problem": "一项肿瘤学的I期剂量递增研究旨在确定最大耐受剂量 (MTD)，此处定义为：其剂量限制性毒性 (DLT) 的估计概率不超过预定目标毒性率 $\\theta$ 的最高剂量。假设转化医学中剂量-毒性关系的经典单调性假设成立：DLT概率 $p(d)$ 随剂量 $d$ 非递减。三个递增的剂量水平 $d_{1}  d_{2}  d_{3}$ 分别在大小为 $n_{i} = 6$ 的队列中进行了测试，得到的观测DLT计数分别为 $x_{1} = 1$、$x_{2} = 0$ 和 $x_{3} = 2$。\n\n使用以下基本设定：\n- 在剂量 $d_{i}$ 下，DLT计数 $x_{i}$ 服从概率为 $p(d_{i})$ 的二项模型，即 $x_{i} \\sim \\mathrm{Binomial}(n_{i}, p(d_{i}))$。\n- 非递减顺序限制 $p(d_{1}) \\leq p(d_{2}) \\leq p(d_{3})$ 体现了剂量-毒性的单调性假设。\n- 在此单调性约束下，有序概率的非参数最大似然估计可通过合并相邻违规者算法 (PAVA) 获得，该算法通过合并并按队列大小加权来替换任何违反顺序约束的相邻项。\n\n设目标毒性率为 $\\theta = 0.25$。将MTD确定为保序估计值 $\\hat{p}(d_{i})$ 小于或等于 $\\theta$ 的最高剂量 $d_{i}$。\n\n任务：\n1. 对经验DLT率应用合并相邻违规者算法，以生成单调保序估计值 $\\hat{p}(d_{1})$、$\\hat{p}(d_{2})$ 和 $\\hat{p}(d_{3})$。\n2. 使用 $\\theta = 0.25$，根据上述规则确定MTD。\n\n将所有估计概率四舍五入到四位有效数字。将最终答案表示为一个单行矩阵，按顺序包含 $\\hat{p}(d_{1})$、$\\hat{p}(d_{2})$、$\\hat{p}(d_{3})$ 和MTD剂量指数（作为整数）。概率无需物理单位。", "solution": "用户希望我根据以下给定的信息和任务来解决一个问题。\n\n### 第1步：提取给定信息\n- **剂量水平**：三个递增的剂量水平 $d_1  d_2  d_3$。\n- **队列大小**：$n_1 = 6$，$n_2 = 6$，$n_3 = 6$。\n- **DLT计数**：$x_1 = 1$，$x_2 = 0$，$x_3 = 2$。\n- **统计模型**：在剂量 $d_i$ 下，剂量限制性毒性 (DLT) 的数量（记为 $x_i$）服从二项分布：$x_i \\sim \\mathrm{Binomial}(n_i, p(d_i))$。\n- **单调性约束**：真实的DLT概率 $p(d_i)$ 随剂量非递减：$p(d_1) \\leq p(d_2) \\leq p(d_3)$。\n- **估计方法**：概率的保序估计值（记为 $\\hat{p}(d_i)$）将使用合并相邻违规者算法 (PAVA) 求得。\n- **目标毒性率**：$\\theta = 0.25$。\n- **MTD定义**：最大耐受剂量 (MTD) 是估计的DLT概率 $\\hat{p}(d_i)$ 不超过 $\\theta$ 的最高剂量水平 $d_i$，即 $\\hat{p}(d_i) \\leq \\theta$。\n- **任务**：1. 计算保序估计值 $\\hat{p}(d_1)$、$\\hat{p}(d_2)$ 和 $\\hat{p}(d_3)$。2. 确定MTD剂量指数。\n- **格式要求**：将概率四舍五入到四位有效数字。\n\n### 第2步：使用提取的信息进行验证\n- **科学依据**：该问题在I期肿瘤试验所使用的统计方法方面有充分的依据。用于二元结果的二项模型、剂量-毒性的单调性假设以及保序回归（特别是PAVA）的使用是该领域的标准且成熟的做法。\n- **良构性**：问题陈述清晰，提供了计算所需量的所有必要数据（$x_i, n_i$）、参数（$\\theta$）和特定算法（PAVA）。目标明确，可以得出唯一解。\n- **客观性**：该问题使用了生物统计学和临床试验设计中的精确术语，没有任何主观或模棱两可的语言。\n\n### 第3步：结论与行动\n该问题是有效的，因为它科学合理、良构且客观。我现在将着手解决。\n\n该问题要求我们首先在非递减顺序约束下，估计三个剂量水平的剂量限制性毒性 (DLT) 概率，然后基于这些估计值确定最大耐受剂量 (MTD)。\n\nDLT概率 $p(d_i)$ 的初始无约束最大似然估计是每个剂量水平观测到的DLT的经验比例。我们将这些经验率记为 $p'_{i} = x_{i}/n_{i}$。\n\n对于剂量水平 $d_1$：\n$$ p'_{1} = \\frac{x_{1}}{n_{1}} = \\frac{1}{6} $$\n\n对于剂量水平 $d_2$：\n$$ p'_{2} = \\frac{x_{2}}{n_{2}} = \\frac{0}{6} = 0 $$\n\n对于剂量水平 $d_3$：\n$$ p'_{3} = \\frac{x_{3}}{n_{3}} = \\frac{2}{6} = \\frac{1}{3} $$\n\n这些经验率的序列是 $(p'_{1}, p'_{2}, p'_{3}) = (\\frac{1}{6}, 0, \\frac{1}{3})$。单调性假设要求估计的概率是非递减的，即 $\\hat{p}(d_1) \\leq \\hat{p}(d_2) \\leq \\hat{p}(d_3)$。我们检查经验率是否满足此条件。\n\n比较 $p'_{1}$ 和 $p'_{2}$：\n$$ p'_{1} = \\frac{1}{6} \\approx 0.1667 \\quad \\text{和} \\quad p'_{2} = 0 $$\n由于 $p'_{1}  p'_{2}$，违反了单调性约束。\n\n合并相邻违规者算法 (PAVA) 用于纠正此违规并生成保序估计值 $\\hat{p}(d_i)$。PAVA 识别违反顺序的相邻对，并用它们的加权平均值替换它们，直到不再有违规为止。权重是队列大小 $n_i$。\n\n违规发生在剂量水平 $d_1$ 和 $d_2$ 之间。我们必须合并这两个水平的数据，并为这个块计算一个单一的新估计值。合并后的估计值是该块中DLT的总数除以该块中患者的总数。\n\n块 $\\{d_1, d_2\\}$ 的合并估计值：\n$$ \\hat{p}_{\\{1,2\\}} = \\frac{x_1 + x_2}{n_1 + n_2} = \\frac{1 + 0}{6 + 6} = \\frac{1}{12} $$\n\n这个合并值替换了 $d_1$ 和 $d_2$ 的单个估计值。工作估计序列变为 $(\\frac{1}{12}, \\frac{1}{12}, \\frac{1}{3})$。\n\n我们现在检查这个新序列的单调性：\n$$ \\frac{1}{12} \\leq \\frac{1}{12} \\leq \\frac{1}{3} $$\n数值上，这大约是 $0.0833 \\leq 0.0833 \\leq 0.3333$，这是成立的。由于没有更多的违规，算法终止。\n\nDLT概率的最终保序估计值为：\n$$ \\hat{p}(d_1) = \\frac{1}{12} $$\n$$ \\hat{p}(d_2) = \\frac{1}{12} $$\n$$ \\hat{p}(d_3) = \\frac{1}{3} $$\n\n问题要求将这些概率四舍五入到四位有效数字。\n$$ \\hat{p}(d_1) = \\frac{1}{12} \\approx 0.083333... \\rightarrow 0.08333 $$\n$$ \\hat{p}(d_2) = \\frac{1}{12} \\approx 0.083333... \\rightarrow 0.08333 $$\n$$ \\hat{p}(d_3) = \\frac{1}{3} \\approx 0.333333... \\rightarrow 0.3333 $$\n\n接下来，我们确定MTD。MTD被定义为估计的DLT概率 $\\hat{p}(d_i)$ 小于或等于目标毒性率 $\\theta = 0.25$ 的最高剂量 $d_i$。\n\n我们对每个剂量水平检查此条件：\n- 对于 $d_1$：$\\hat{p}(d_1) = 0.08333$。由于 $0.08333 \\leq 0.25$，剂量 $d_1$ 被认为是可接受的。\n- 对于 $d_2$：$\\hat{p}(d_2) = 0.08333$。由于 $0.08333 \\leq 0.25$，剂量 $d_2$ 也被认为是可接受的。\n- 对于 $d_3$：$\\hat{p}(d_3) = 0.3333$。由于 $0.3333  0.25$，剂量 $d_3$ 被认为毒性过高，不可接受。\n\n可接受的剂量集合是 $\\{d_1, d_2\\}$。MTD是这个集合中的最高剂量，即 $d_2$。问题要求的是MTD剂量指数，即 $2$。\n\n最终答案要求一个包含三个估计概率和MTD指数的行矩阵。\n这些值是 $\\hat{p}(d_1) = 0.08333$，$\\hat{p}(d_2) = 0.08333$，$\\hat{p}(d_3) = 0.3333$，MTD指数为 $2$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.08333  0.08333  0.3333  2\n\\end{pmatrix}\n}\n$$", "id": "5029471"}, {"introduction": "在CRM方法的基础上，本练习将探索贝叶斯逻辑回归模型（BLRM），这是一种在现代临床试验中应用更广泛、更灵活的方法。本练习演示了如何使用BLRM框架，并结合“控制过量风险的递增”（EWOC）准则，来做出既科学又稳健的剂量决策。这不仅有助于精确地找到目标剂量，还能有效控制给予患者过高毒性剂量的风险，体现了高级剂量探索设计的精髓。[@problem_id:5029436]", "problem": "一项转化医学中的I期剂量爬坡研究旨在根据剂量限制性毒性（DLT），使用带有过量控制的剂量递增（EWOC）的贝叶斯逻辑回归模型（BLRM）来确定最大耐受剂量（MTD）。该研究在每组 $n_d$ 名患者中评估剂量 $d \\in \\{5, 10, 20\\}$ mg，观察到的DLT计数为 $y_d$。BLRM由以下逻辑联系函数定义：\n$$\n\\text{logit}\\big(p(d)\\big) \\equiv \\ln\\left(\\frac{p(d)}{1 - p(d)}\\right) = \\alpha + \\beta \\ln\\left(\\frac{d}{d^{\\ast}}\\right),\n$$\n其中 $p(d)$ 是在剂量 $d$ 下发生DLT的概率，$\\alpha$ 和 $\\beta$ 是模型参数，$d^{\\ast}$ 是一个固定的参考剂量。DLT计数被建模为独立的二项分布结果：\n$$\ny_d \\sim \\text{Binomial}\\big(n_d, p(d)\\big).\n$$\n给定以下数据和模型组件：\n- 参考剂量 $d^{\\ast} = 10$ mg。\n- 观察值：在 $5$ mg剂量下，$n_{5} = 6$ 名患者中有 $y_{5} = 0$ 例DLT；在 $10$ mg剂量下，$n_{10} = 6$ 名患者中有 $y_{10} = 1$ 例DLT；在 $20$ mg剂量下，$n_{20} = 6$ 名患者中有 $y_{20} = 2$ 例DLT。\n- $(\\alpha, \\beta)$ 的先验分布：一个弱信息的二元正态分布，其均值向量为 $\\boldsymbol{m}_{0} = (-2.0, 0.8)$，协方差矩阵为\n$$\n\\boldsymbol{S}_{0} = \\begin{pmatrix}\n0.5  0 \\\\\n0  0.5\n\\end{pmatrix}.\n$$\n- 观察数据后，通过Laplace近似（后验众数和曲率）得到 $(\\alpha, \\beta)$ 的近似后验分布为一个二元正态分布，其均值向量为 $\\boldsymbol{m} = (-1.8, 1.0)$，协方差矩阵为\n$$\n\\boldsymbol{S} = \\begin{pmatrix}\n0.16  -0.02 \\\\\n-0.02  0.05\n\\end{pmatrix}.\n$$\n\n从第一性原理出发，使用贝叶斯定理和逻辑变换，对每个剂量 $d \\in \\{5, 10, 20\\}$ mg，推导由 $(\\alpha, \\beta)$ 的正态近似所隐含的 $p(d)$ 的后验分布。然后，使用带有 $\\omega = 0.25$ 和目标毒性区间 $[0.16, 0.33]$ 的带过量控制的剂量递增（EWOC）准则，执行以下操作：\n1. 对于每个剂量 $d$，计算 $p(d)$ 位于目标区间 $[0.16, 0.33]$ 内的后验概率。\n2. 对于每个剂量 $d$，计算 $p(d)  0.33$ 的后验概率。\n3. 确定满足EWOC准则的剂量集合，即满足 $\\mathbb{P}\\big(p(d)  0.33 \\mid \\text{data}\\big) \\le \\omega$ 的剂量。\n4. 在满足EWOC的剂量中，选择使 $p(d)$ 位于 $[0.16, 0.33]$ 内的后验概率最大化的剂量作为推荐的MTD。\n\n以毫克为单位，将推荐的MTD剂量报告为单个数字。如果报告任何中间数值概率，则将其四舍五入至四位有效数字。以mg为单位表示最终推荐剂量（在最终的方框答案中不要包含单位）。", "solution": "该问题要求从一组剂量水平 $d \\in \\{5, 10, 20\\}$ mg 中，基于贝叶斯逻辑回归模型（BLRM）和带过量控制的剂量递增（EWOC）准则，确定最大耐受剂量（MTD）。该分析利用模型参数 $(\\alpha, \\beta)$ 的一个近似二元正态后验分布。\n\nBLRM由以下方程定义：\n$$\n\\text{logit}\\big(p(d)\\big) = \\ln\\left(\\frac{p(d)}{1 - p(d)}\\right) = \\alpha + \\beta \\ln\\left(\\frac{d}{d^{\\ast}}\\right)\n$$\n其中 $p(d)$ 是在剂量 $d$ 下发生剂量限制性毒性（DLT）的概率，$d^{\\ast}$ 是参考剂量。让我们将剂量 $d$ 下DLT概率的logit值定义为 $L(d) = \\text{logit}\\big(p(d)\\big)$。该模型可以写为 $L(d) = \\alpha + \\beta x_d$，其中 $x_d = \\ln(d/d^{\\ast})$。\n\n参数 $(\\alpha, \\beta)$ 的后验分布被给出为一个二元正态分布的近似，即 $(\\alpha, \\beta)^T \\sim N(\\boldsymbol{m}, \\boldsymbol{S})$，其均值向量和协方差矩阵为：\n$$\n\\boldsymbol{m} = \\begin{pmatrix} m_\\alpha \\\\ m_\\beta \\end{pmatrix} = \\begin{pmatrix} -1.8 \\\\ 1.0 \\end{pmatrix}, \\quad \\boldsymbol{S} = \\begin{pmatrix} S_{\\alpha\\alpha}  S_{\\alpha\\beta} \\\\ S_{\\beta\\alpha}  S_{\\beta\\beta} \\end{pmatrix} = \\begin{pmatrix} 0.16  -0.02 \\\\ -0.02  0.05 \\end{pmatrix}\n$$\n由于 $L(d)$ 是正态分布向量 $(\\alpha, \\beta)^T$ 的线性变换，其后验分布也是正态的。具体来说，$L(d) = \\boldsymbol{c}_d^T (\\alpha, \\beta)^T$，其中 $\\boldsymbol{c}_d^T = (1, x_d)$。$L(d)$ 的后验分布为 $L(d) \\sim N(\\mu_{L(d)}, \\sigma_{L(d)}^2)$，其均值和方差由以下公式给出：\n$$\n\\mu_{L(d)} = \\boldsymbol{c}_d^T \\boldsymbol{m} = m_\\alpha + m_\\beta x_d\n$$\n$$\n\\sigma_{L(d)}^2 = \\boldsymbol{c}_d^T \\boldsymbol{S} \\boldsymbol{c}_d = S_{\\alpha\\alpha} + 2S_{\\alpha\\beta}x_d + S_{\\beta\\beta}x_d^2\n$$\n\n我们首先使用给定的参考剂量 $d^{\\ast} = 10$ mg，为每个剂量水平计算 $L(d)$ 后验分布的参数。\n\n对于 $d = 5$ mg：\n项 $x_5 = \\ln(5/10) = \\ln(0.5) = -\\ln(2)$。\n$\\mu_{L(5)} = -1.8 + 1.0 \\times (-\\ln(2)) \\approx -1.8 - 0.6931 = -2.4931$。\n$\\sigma_{L(5)}^2 = 0.16 + 2(-0.02)(-\\ln(2)) + 0.05(-\\ln(2))^2 \\approx 0.16 + 0.04(0.6931) + 0.05(0.4805) \\approx 0.16 + 0.02772 + 0.02402 = 0.2117$。\n标准差为 $\\sigma_{L(5)} = \\sqrt{0.2117} \\approx 0.4601$。\n\n对于 $d = 10$ mg：\n项 $x_{10} = \\ln(10/10) = \\ln(1) = 0$。\n$\\mu_{L(10)} = -1.8 + 1.0 \\times 0 = -1.8$。\n$\\sigma_{L(10)}^2 = 0.16 + 2(-0.02)(0) + 0.05(0)^2 = 0.16$。\n标准差为 $\\sigma_{L(10)} = \\sqrt{0.16} = 0.4$。\n\n对于 $d = 20$ mg：\n项 $x_{20} = \\ln(20/10) = \\ln(2)$。\n$\\mu_{L(20)} = -1.8 + 1.0 \\times \\ln(2) \\approx -1.8 + 0.6931 = -1.1069$。\n$\\sigma_{L(20)}^2 = 0.16 + 2(-0.02)(\\ln(2)) + 0.05(\\ln(2))^2 \\approx 0.16 - 0.02772 + 0.02402 = 0.1563$。\n标准差为 $\\sigma_{L(20)} = \\sqrt{0.1563} \\approx 0.3953$。\n\n接下来，我们必须将感兴趣的概率空间区间转换为logit空间。目标毒性区间是 $[0.16, 0.33]$。\nlogit空间中的下界是 $L_{lower} = \\text{logit}(0.16) = \\ln\\left(\\frac{0.16}{1 - 0.16}\\right) = \\ln\\left(\\frac{0.16}{0.84}\\right) \\approx -1.6582$。\n上界是 $L_{upper} = \\text{logit}(0.33) = \\ln\\left(\\frac{0.33}{1 - 0.33}\\right) = \\ln\\left(\\frac{0.33}{0.67}\\right) \\approx -0.7082$。\n过量阈值是 $p(d)  0.33$，这对应于 $L(d)  -0.7082$。\n\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数（CDF）。我们现在为每个剂量计算所需的概率。\n\n对于 $d = 5$ mg，其中 $L(5) \\sim N(-2.4931, 0.4601^2)$：\n1. 目标区间内的概率：\n$\\mathbb{P}\\big(p(5) \\in [0.16, 0.33]\\big) = \\mathbb{P}\\big(-1.6582 \\le L(5) \\le -0.7082\\big)$\n$= \\Phi\\left(\\frac{-0.7082 - (-2.4931)}{0.4601}\\right) - \\Phi\\left(\\frac{-1.6582 - (-2.4931)}{0.4601}\\right)$\n$= \\Phi(3.879) - \\Phi(1.815) \\approx 0.999948 - 0.96523 = 0.03472$。四舍五入到四位有效数字，结果是 $0.03472$。\n2. 过量概率：\n$\\mathbb{P}\\big(p(5)  0.33\\big) = \\mathbb{P}\\big(L(5)  -0.7082\\big) = 1 - \\Phi\\left(\\frac{-0.7082 - (-2.4931)}{0.4601}\\right)$\n$= 1 - \\Phi(3.879) \\approx 1 - 0.999948 = 0.000052$。四舍五入到四位有效数字，结果是 $0.00005200$。\n\n对于 $d = 10$ mg，其中 $L(10) \\sim N(-1.8, 0.4^2)$：\n1. 目标区间内的概率：\n$\\mathbb{P}\\big(p(10) \\in [0.16, 0.33]\\big) = \\mathbb{P}\\big(-1.6582 \\le L(10) \\le -0.7082\\big)$\n$= \\Phi\\left(\\frac{-0.7082 - (-1.8)}{0.4}\\right) - \\Phi\\left(\\frac{-1.6582 - (-1.8)}{0.4}\\right)$\n$= \\Phi(2.7295) - \\Phi(0.3545) \\approx 0.99682 - 0.63854 = 0.35828$。四舍五入到四位有效数字，结果是 $0.3583$。\n2. 过量概率：\n$\\mathbb{P}\\big(p(10)  0.33\\big) = \\mathbb{P}\\big(L(10)  -0.7082\\big) = 1 - \\Phi\\left(\\frac{-0.7082 - (-1.8)}{0.4}\\right)$\n$= 1 - \\Phi(2.7295) \\approx 1 - 0.99682 = 0.00318$。四舍五入到四位有效数字，结果是 $0.003180$。\n\n对于 $d = 20$ mg，其中 $L(20) \\sim N(-1.1069, 0.3953^2)$：\n1. 目标区间内的概率：\n$\\mathbb{P}\\big(p(20) \\in [0.16, 0.33]\\big) = \\mathbb{P}\\big(-1.6582 \\le L(20) \\le -0.7082\\big)$\n$= \\Phi\\left(\\frac{-0.7082 - (-1.1069)}{0.3953}\\right) - \\Phi\\left(\\frac{-1.6582 - (-1.1069)}{0.3953}\\right)$\n$= \\Phi(1.0086) - \\Phi(-1.3949) = \\Phi(1.0086) - (1 - \\Phi(1.3949))$\n$\\approx 0.84347 - (1 - 0.91845) = 0.84347 - 0.08155 = 0.76192$。四舍五入到四位有效数字，结果是 $0.7619$。\n2. 过量概率：\n$\\mathbb{P}\\big(p(20)  0.33\\big) = \\mathbb{P}\\big(L(20)  -0.7082\\big) = 1 - \\Phi\\left(\\frac{-0.7082 - (-1.1069)}{0.3953}\\right)$\n$= 1 - \\Phi(1.0086) \\approx 1 - 0.84347 = 0.15653$。四舍五入到四位有效数字，结果是 $0.1565$。\n\n现在我们应用决策准则。\n首先，使用EWOC准则确定可接受剂量的集合：$\\mathbb{P}\\big(p(d) > 0.33 \\mid \\text{data}\\big) \\le \\omega$，其中 $\\omega = 0.25$。\n- 对于 $d=5$ mg：$\\mathbb{P}\\big(p(5) > 0.33\\big) \\approx 0.00005200 \\le 0.25$。该剂量是可接受的。\n- 对于 $d=10$ mg：$\\mathbb{P}\\big(p(10) > 0.33\\big) \\approx 0.003180 \\le 0.25$。该剂量是可接受的。\n- 对于 $d=20$ mg：$\\mathbb{P}\\big(p(20) > 0.33\\big) \\approx 0.1565 \\le 0.25$。该剂量是可接受的。\n所有三个剂量 $\\{5, 10, 20\\}$ mg 都在可接受剂量集合中。\n\n其次，在可接受的剂量中，选择使 $p(d)$ 位于目标区间 $[0.16, 0.33]$ 内的后验概率最大化的剂量作为MTD。\n- $\\mathbb{P}\\big(p(5) \\in [0.16, 0.33]\\big) \\approx 0.03472$\n- $\\mathbb{P}\\big(p(10) \\in [0.16, 0.33]\\big) \\approx 0.3583$\n- $\\mathbb{P}\\big(p(20) \\in [0.16, 0.33]\\big) \\approx 0.7619$\n\n比较这些概率，最大值是 $0.7619$，这对应于剂量 $d = 20$ mg。\n\n因此，推荐的MTD是 $20$ mg。", "answer": "$$\\boxed{20}$$", "id": "5029436"}]}