{"hands_on_practices": [{"introduction": "第一个实践为评估任何诊断或预后测试奠定了基础。我们将从验证研究最直接的产出——混淆矩阵入手，计算灵敏度、特异性等基本性能指标，并探讨如何根据特定的使用场景（Context of Use, COU）来选择最重要的评估指标。掌握这项技能是将原始实验数据转化为有意义的临床性能指标的第一步。[@problem_id:4999473]", "problem": "一种基于血液的预后生物标志物正在进行临床验证，其使用情境 (Context of Use, COU) 为筛查，定义为早期识别潜伏性疾病患者，其中漏诊病例将带来高昂的临床代价。在一个包含 $300$ 名参与者的前瞻性队列研究中，测试后的金标准裁决得出以下计数：真阳性 (TP) $=68$，假阳性 (FP) $=12$，假阴性 (FN) $=22$，真阴性 (TN) $=198$。使用基于频率计数法的条件概率和分类性能的基本定义，计算该生物标志物在此验证队列中的以下性能特征：灵敏度、特异性、阳性预测值 (PPV)、阴性预测值 (NPV) 和准确率。然后，确定哪个单一性能指标与所述的筛查使用情境 (COU) 最为一致，在该情境中，假阴性的临床后果在决策中占主导地位。对于输出编码，请使用以下数字代码表示与 COU 一致的指标：$1$ 代表灵敏度，$2$ 代表特异性，$3$ 代表 PPV，$4$ 代表 NPV，$5$ 代表准确率。将所有五个指标值报告为小数（而非百分比），并将每个值四舍五入至四位有效数字。请将您的最终输出以单行矩阵的形式提供，顺序为：灵敏度、特异性、PPV、NPV、准确率，后跟 COU 指标代码。", "solution": "该临床验证任务依赖于分类和条件概率的核心定义。设 $D$ 表示患病，$\\overline{D}$ 表示未患病，设 $T^{+}$ 和 $T^{-}$ 分别表示阳性和阴性测试结果。混淆矩阵的计数通过相对频率映射到经验概率。\n\n灵敏度是条件概率 $P(T^{+} \\mid D)$，解释为在患病条件下测试结果为阳性的概率。根据频率学派的条件概率定义，\n$$\nP(T^{+} \\mid D) = \\frac{\\text{测试呈阳性的患病人数}}{\\text{患病总人数}} = \\frac{\\text{TP}}{\\text{TP} + \\text{FN}}。\n$$\n根据给定的计数，$\\text{TP} = 68$ 且 $\\text{FN} = 22$，所以\n$$\n\\text{灵敏度} = \\frac{68}{68 + 22} = \\frac{68}{90}。\n$$\n该值等于 $0.755\\overline{5}$，四舍五入到四位有效数字为 $0.7556$。\n\n特异性是条件概率 $P(T^{-} \\mid \\overline{D})$，即在未患病条件下测试结果为阴性的概率。根据相同原理，\n$$\nP(T^{-} \\mid \\overline{D}) = \\frac{\\text{测试呈阴性的未患病人数}}{\\text{未患病总人数}} = \\frac{\\text{TN}}{\\text{TN} + \\text{FP}}。\n$$\n当 $\\text{TN} = 198$ 且 $\\text{FP} = 12$ 时，\n$$\n\\text{特异性} = \\frac{198}{198 + 12} = \\frac{198}{210} = 0.942857\\ldots,\n$$\n四舍五入到四位有效数字为 $0.9429$。\n\n阳性预测值 (PPV) 是条件概率 $P(D \\mid T^{+})$，即在测试结果为阳性的条件下患病的概率。在具有固定计数的队列中，这等于阳性测试中真阳性所占的比例：\n$$\n\\text{PPV} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}}。\n$$\n当 $\\text{TP} = 68$ 且 $\\text{FP} = 12$ 时，\n$$\n\\text{PPV} = \\frac{68}{68 + 12} = \\frac{68}{80} = 0.85。\n$$\n保留四位有效数字，结果为 $0.8500$。\n\n阴性预测值 (NPV) 是条件概率 $P(\\overline{D} \\mid T^{-})$，即在测试结果为阴性的条件下未患病的概率。类似地，\n$$\n\\text{NPV} = \\frac{\\text{TN}}{\\text{TN} + \\text{FN}}。\n$$\n当 $\\text{TN} = 198$ 且 $\\text{FN} = 22$ 时，\n$$\n\\text{NPV} = \\frac{198}{198 + 22} = \\frac{198}{220} = 0.9,\n$$\n保留四位有效数字，结果为 $0.9000$。\n\n准确率是所有被测个体中正确分类的总体比例。设 $N$ 表示个体总数。那么\n$$\n\\text{准确率} = \\frac{\\text{TP} + \\text{TN}}{N}。\n$$\n这里，$N = \\text{TP} + \\text{FP} + \\text{FN} + \\text{TN} = 68 + 12 + 22 + 198 = 300$，且 $\\text{TP} + \\text{TN} = 68 + 198 = 266$，所以\n$$\n\\text{准确率} = \\frac{266}{300} = 0.886666\\ldots,\n$$\n四舍五入到四位有效数字为 $0.8867$。\n\n对于 COU 的决策，在假阴性的临床后果占主导地位的筛查中，重点应放在优先识别尽可能多的真阳性病例，这由灵敏度 $P(T^{+} \\mid D)$ 来量化。虽然阴性预测值在低患病率环境中对于让阴性结果者放心也可能很重要，但对最小化假阴性的明确强调使灵敏度成为与 COU 一致的主要指标。使用提供的编码，灵敏度对应代码 $1$。\n\n按顺序（灵敏度、特异性、PPV、NPV、准确率、COU 指标代码）组合所要求的输出，并将每个指标四舍五入到四位有效数字，得到：\n$$\n\\left(0.7556,\\ 0.9429,\\ 0.8500,\\ 0.9000,\\ 0.8867,\\ 1\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.7556  0.9429  0.8500  0.9000  0.8867  1\\end{pmatrix}}$$", "id": "4999473"}, {"introduction": "灵敏度和特异性是检测方法的内在属性，但其在真实世界中的预测价值并非一成不变。本实践将探讨一个关键概念：检测的阳性预测值（$PPV$）和阴性预测值（$NPV$）如何深受目标人群中疾病患病率的影响。理解这种动态关系对于将生物标志物从高风险队列研究过渡到更广泛的筛查应用时，正确解读其效用至关重要。[@problem_id:4999450]", "problem": "在一项生物标志物驱动的转化研究中，正在对一种二元诊断检测方法进行临床验证，以对患者进行分层，用于靶向治疗。设疾病状态由 $D \\in \\{1,0\\}$ 表示（存在、不存在），检测结果由 $T \\in \\{+, -\\}$ 表示。该检测的灵敏度为 $S_{e} = \\mathbb{P}(T=+ \\mid D=1)$，特异性为 $S_{p} = \\mathbb{P}(T=- \\mid D=0)$。在预期使用人群中，该疾病的患病率为 $p = \\mathbb{P}(D=1)$。阳性预测值 (PPV) 定义为 $\\mathbb{P}(D=1 \\mid T=+)$，阴性预测值 (NPV) 定义为 $\\mathbb{P}(D=0 \\mid T=-)$。\n\n仅使用概率公理和贝叶斯定理作为基本原则，推导表达式，说明 $PPV$ 和 $NPV$ 如何依赖于 $p$、$S_{e}$ 和 $S_{p}$。根据推导出的公式，解释为什么当 $S_{e}$ 和 $S_{p}$ 固定时，$PPV$ 和 $NPV$ 必然随 $p$ 的变化而变化。然后，对于一个灵敏度 $S_{e} = 0.90$、特异性 $S_{p} = 0.95$ 的检测，计算当患病率从 $p=0.05$ 增加到 $p=0.20$ 时 $PPV$ 的绝对变化。将最终数值结果表示为精确分数。不要近似计算。", "solution": "阳性预测值（$PPV$）和阴性预测值（$NPV$）的推导始于它们的定义和贝叶斯定理的应用。\n\n首先，对于 $PPV = \\mathbb{P}(D=1 \\mid T=+)$, 贝叶斯定理表明：\n$$PPV = \\frac{\\mathbb{P}(T=+ \\mid D=1) \\mathbb{P}(D=1)}{\\mathbb{P}(T=+)}$$\n分子中的各项是直接给出的：$\\mathbb{P}(T=+ \\mid D=1) = S_e$ 和 $\\mathbb{P}(D=1) = p$。\n分母 $\\mathbb{P}(T=+)$ 是检测结果为阳性的总概率。它可以根据全概率定律，在两种可能的疾病状态 $D=1$ 和 $D=0$ 上展开：\n$$\\mathbb{P}(T=+) = \\mathbb{P}(T=+ \\mid D=1) \\mathbb{P}(D=1) + \\mathbb{P}(T=+ \\mid D=0) \\mathbb{P}(D=0)$$\n我们已知 $\\mathbb{P}(D=1)=p$，所以 $\\mathbb{P}(D=0) = 1 - \\mathbb{P}(D=1) = 1-p$。\n项 $\\mathbb{P}(T=+ \\mid D=0)$ 是假阳性率，与特异性相关。根据定义，$S_p = \\mathbb{P}(T=- \\mid D=0)$。由于只有两种检测结果，$\\mathbb{P}(T=+ \\mid D=0) = 1 - \\mathbb{P}(T=- \\mid D=0) = 1 - S_p$。\n将这些分量代入 $\\mathbb{P}(T=+)$ 的表达式中：\n$$\\mathbb{P}(T=+) = (S_e)(p) + (1-S_p)(1-p)$$\n最后，将此代回 $PPV$ 的公式中：\n$$PPV = \\frac{S_e p}{S_e p + (1-S_p)(1-p)}$$\n\n接下来，对于 $NPV = \\mathbb{P}(D=0 \\mid T=-)$, 贝叶斯定理表明：\n$$NPV = \\frac{\\mathbb{P}(T=- \\mid D=0) \\mathbb{P}(D=0)}{\\mathbb{P}(T=-)}$$\n分子中的各项是已知的或可以直接推导得出：$\\mathbb{P}(T=- \\mid D=0) = S_p$ 和 $\\mathbb{P}(D=0) = 1-p$。\n分母 $\\mathbb{P}(T=-)$ 使用全概率定律展开：\n$$\\mathbb{P}(T=-) = \\mathbb{P}(T=- \\mid D=0) \\mathbb{P}(D=0) + \\mathbb{P}(T=- \\mid D=1) \\mathbb{P}(D=1)$$\n项 $\\mathbb{P}(T=- \\mid D=1)$ 是假阴性率，与灵敏度相关。根据定义，$S_e = \\mathbb{P}(T=+ \\mid D=1)$。因此，$\\mathbb{P}(T=- \\mid D=1) = 1 - \\mathbb{P}(T=+ \\mid D=1) = 1 - S_e$。\n将这些分量代入 $\\mathbb{P}(T=-)$ 的表达式中：\n$$\\mathbb{P}(T=-) = (S_p)(1-p) + (1-S_e)(p)$$\n最后，将此代回 $NPV$ 的公式中：\n$$NPV = \\frac{S_p(1-p)}{S_p(1-p) + (1-S_e)p}$$\n\n推导出的 $PPV$ 和 $NPV$ 公式明确显示了它们对患病率 $p$ 的依赖性。对于固定的检测特性（$S_e$ 和 $S_p$），$PPV$ 和 $NPV$ 都是 $p$ 的函数。\n对于 $PPV$，由于 $p$ 同时出现在分子和分母中，$PPV$ 不是一个关于 $p$ 的常数函数。具体来说，对于非完美检测（$S_e  1$，$S_p  1$），可以证明 $PPV$ 对 $p$ 的导数为正，这意味着 $PPV$ 随患病率的增加而增加。较高的检测前概率（$p$）与阳性检测结果相结合，会导致较高的检测后概率（$PPV$）。\n类似地，对于 $NPV$，$p$ 在分子和分母中的存在证明了其依赖性。$NPV$ 对 $p$ 的导数为负，这意味着 $NPV$ 随患病率的增加而减小。在疾病更常见的群体中，阴性检测结果的可靠性较低（即，无病的概率较低）。\n\n现在，我们计算给定值的 $PPV$ 的绝对变化。\n已知：$S_e = 0.90 = \\frac{9}{10}$ 且 $S_p = 0.95 = \\frac{19}{20}$。\n初始患病率为 $p_1 = 0.05 = \\frac{5}{100} = \\frac{1}{20}$。\n最终患病率为 $p_2 = 0.20 = \\frac{20}{100} = \\frac{1}{5}$。\n\n首先，计算当 $p_1 = \\frac{1}{20}$ 时的 $PPV_1$：\n我们还需要 $1-S_p = 1 - \\frac{19}{20} = \\frac{1}{20}$ 和 $1-p_1 = 1 - \\frac{1}{20} = \\frac{19}{20}$。\n$$PPV_1 = \\frac{S_e p_1}{S_e p_1 + (1-S_p)(1-p_1)} = \\frac{(\\frac{9}{10})(\\frac{1}{20})}{(\\frac{9}{10})(\\frac{1}{20}) + (\\frac{1}{20})(\\frac{19}{20})}$$\n$$PPV_1 = \\frac{\\frac{9}{200}}{\\frac{9}{200} + \\frac{19}{400}} = \\frac{\\frac{18}{400}}{\\frac{18}{400} + \\frac{19}{400}} = \\frac{\\frac{18}{400}}{\\frac{37}{400}} = \\frac{18}{37}$$\n\n接下来，计算当 $p_2 = \\frac{1}{5}$ 时的 $PPV_2$：\n我们需要 $1-p_2 = 1 - \\frac{1}{5} = \\frac{4}{5}$。\n$$PPV_2 = \\frac{S_e p_2}{S_e p_2 + (1-S_p)(1-p_2)} = \\frac{(\\frac{9}{10})(\\frac{1}{5})}{(\\frac{9}{10})(\\frac{1}{5}) + (\\frac{1}{20})(\\frac{4}{5})}$$\n$$PPV_2 = \\frac{\\frac{9}{50}}{\\frac{9}{50} + \\frac{4}{100}} = \\frac{\\frac{18}{100}}{\\frac{18}{100} + \\frac{4}{100}} = \\frac{\\frac{18}{100}}{\\frac{22}{100}} = \\frac{18}{22} = \\frac{9}{11}$$\n\n$PPV$ 的绝对变化是 $|\\Delta PPV| = |PPV_2 - PPV_1|$。\n因为 $PPV$ 随 $p$ 增加，所以这个值是 $PPV_2 - PPV_1$。\n$$|\\Delta PPV| = \\frac{9}{11} - \\frac{18}{37}$$\n为了进行分数减法，我们找到一个公分母，即 $11 \\times 37 = 407$。\n$$|\\Delta PPV| = \\frac{9 \\times 37}{11 \\times 37} - \\frac{18 \\times 11}{37 \\times 11} = \\frac{333}{407} - \\frac{198}{407} = \\frac{333 - 198}{407} = \\frac{135}{407}$$\n分子是 $135 = 3^3 \\times 5$。分母是 $407 = 11 \\times 37$。没有公质因子，所以这个分数是最简形式。", "answer": "$$\\boxed{\\frac{135}{407}}$$", "id": "4999450"}, {"introduction": "一个好的生物标志物不仅应准确，更应具有临床实用性，即能够改善患者结局。本实践介绍了一种强大的框架——决策曲线分析（Decision Curve Analysis, DCA），它通过权衡正确决策的益处与错误决策的危害来量化生物标志物的临床效用。通过计算净获益（Net Benefit, $NB$），你将学会评估采用一种新的、由生物标志物指导的策略是否能在临床决策中带来净改善。[@problem_id:4999460]", "problem": "一个转化医学团队正在评估一种候选的血液生物标志物是否具有临床实用性，用以指导对异质性患者群体的侵入性治疗。该团队计划使用决策曲线分析（DCA）来量化不同风险阈值下的临床实用性。在此框架下，决策规则对预测疾病风险至少达到选定阈值概率的患者进行治疗。假设DCA具有以下基本决策理论基础：对于疾病概率为 $p$ 的个体，接受治疗的期望效用为 $p\\,B - (1-p)\\,H$，其中 $B$ 是对真正患病的患者进行治疗时获得的临床获益，而 $H$ 是对未患病患者进行不必要治疗时造成的临床伤害。按照惯例，不采取任何行动的效用为零。阈值概率 $p_t$ 被定义为使得治疗的期望效用等于不治疗的期望效用的最小概率 $p$。人群水平的性能总结基于真阳性和假阳性的计数，其净临床价值以每位患者的获益当量为单位表示。\n\n从这些定义出发，且仅使用这些定义，推导出一个基于模型的决策规则（当且仅当 $p \\ge p_t$ 时进行治疗）的净获益表达式，该表达式应仅用人群规模 $N$、真阳性数 $TP$、假阳性数 $FP$ 和阈值概率 $p_t$ 来表示。然后，在一个规模为 $N = 1000$ 的验证队列中，假设在 $p_t = 0.15$ 处评估模型时，得到 $TP = 80$ 和 $FP = 50$。计算该模型在此阈值下的净获益。将最终答案表示为每位患者的净获益（即每位患者的真阳性数），并四舍五入到 $4$ 位有效数字。", "solution": "任务是推导基于模型的决策规则的净获益表达式。我们从提供的基本定义开始。\n\n首先，我们建立获益（$B$）、伤害（$H$）和阈值概率（$p_t$）之间的关系。阈值概率 $p_t$ 被定义为决策者在治疗与不治疗之间无差异时的概率 $p$。这种情况发生在治疗的期望效用等于不治疗的期望效用时。\n\n使用给定的效用函数：\n$$ U_{treat}(p_t) = U_{not\\_treat} $$\n$$ p_t B - (1 - p_t)H = 0 $$\n\n这个方程可以重新整理，以表示在所选阈值下伤害与获益之间的权衡关系：\n$$ p_t B = (1 - p_t)H $$\n$$ \\frac{H}{B} = \\frac{p_t}{1 - p_t} $$\n这个比率，常被称为“交换率”，量化了为了避免一个单位的伤害而愿意放弃的获益单位数。它完全由阈值概率 $p_t$ 决定。\n\n接下来，我们考虑在应用决策规则时，对于规模为 $N$ 的人群的总净效用。该规则是，如果患者的预测风险大于或等于 $p_t$，则对其进行治疗。将此规则应用于该人群，会导致一定数量的患者接受治疗。\n- 被正确治疗的患病患者数量即为真阳性数 $TP$。\n- 被错误治疗的非患病患者数量即为假阳性数 $FP$。\n\n总效用是人群中所有个体的效用之和。未接受治疗的患者对总效用的贡献为 $0$。因此，总效用仅来源于接受治疗的群体。\n- $TP$ 名患者中的每一位都患病并接受治疗，产生 $B$ 的获益。该群体的总获益为 $TP \\times B$。\n- $FP$ 名患者中的每一位都未患病但接受了治疗，产生 $H$ 的伤害。该群体的总伤害为 $FP \\times H$。\n\n整个群体的总净效用是所有获益之和减去所有伤害之和：\n$$ \\text{Total Net Utility} = (TP \\times B) - (FP \\times H) $$\n\n问题将净临床价值，或净获益（$NB$），定义为“以每位患者的获益当量为单位表示”。\n为了以获益（$B$）为单位表示总效用，我们将其除以 $B$：\n$$ \\text{Total Net Benefit (in B units)} = \\frac{(TP \\times B) - (FP \\times H)}{B} = TP - FP \\left(\\frac{H}{B}\\right) $$\n\n现在，我们代入之前推导出的比率 $\\frac{H}{B}$ 的表达式：\n$$ \\text{Total Net Benefit} = TP - FP \\left(\\frac{p_t}{1 - p_t}\\right) $$\n\n这是整个规模为 $N$ 的人群的总净获益。为了找到*每位患者*的净获益，我们将这个总数除以 $N$：\n$$ NB = \\frac{\\text{Total Net Benefit}}{N} = \\frac{1}{N} \\left[ TP - FP \\left(\\frac{p_t}{1 - p_t}\\right) \\right] $$\n该表达式可以重写为：\n$$ NB = \\frac{TP}{N} - \\frac{FP}{N} \\left(\\frac{p_t}{1 - p_t}\\right) $$\n这就是所求的每位患者净获益的表达式，仅用 $N$, $TP$, $FP$ 和 $p_t$ 表示。它代表了在考虑了由所选风险阈值加权的假阳性伤害后，每位患者的真阳性净增益。\n\n### 净获益的计算\n\n给定一个验证队列的以下数据：\n- 人群规模：$N = 1000$\n- 真阳性数：$TP = 80$\n- 假阳性数：$FP = 50$\n- 阈值概率：$p_t = 0.15$\n\n我们将这些值代入推导出的每位患者净获益（$NB$）公式中：\n$$ NB = \\frac{80}{1000} - \\frac{50}{1000} \\left(\\frac{0.15}{1 - 0.15}\\right) $$\n\n首先，简化初始项和括号内的分数：\n$$ NB = 0.08 - 0.05 \\left(\\frac{0.15}{0.85}\\right) $$\n\n该分数可以简化为：\n$$ \\frac{0.15}{0.85} = \\frac{15}{85} = \\frac{3 \\times 5}{17 \\times 5} = \\frac{3}{17} $$\n\n现在，将这个简化的分数代回方程中：\n$$ NB = 0.08 - 0.05 \\left(\\frac{3}{17}\\right) $$\n$$ NB = 0.08 - \\frac{0.15}{17} $$\n\n现在我们进行除法运算：\n$$ \\frac{0.15}{17} \\approx 0.0088235294... $$\n\n最后，我们计算净获益：\n$$ NB \\approx 0.08 - 0.0088235294... $$\n$$ NB \\approx 0.0711764706... $$\n\n题目要求答案四舍五入到 $4$ 位有效数字。第一位有效数字是 $7$。第四位有效数字是第二个 $1$。其后的数字是 $7$，大于或等于 $5$，所以我们向上取整。\n$$ NB \\approx 0.07118 $$\n\n在 $p_t = 0.15$ 阈值下，该模型的净获益约为 $0.07118$。这个值意味着，使用该模型指导治疗，相当于一种策略，能在每 $100$ 名患者中额外正确识别出 $7.118$ 个真阳性，而不会产生任何假阳性的伤害。", "answer": "$$\\boxed{0.07118}$$", "id": "4999460"}]}