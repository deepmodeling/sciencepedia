{"hands_on_practices": [{"introduction": "在癌症基因组学中，一个核心任务是解读来自大量肿瘤组织测序的变异等位基因频率（VAF）。本练习将引导您从第一性原理出发，推导连接VAF、肿瘤纯度、拷贝数和癌症细胞分数（CCF）的数学模型。通过这个实践，您将理解我们如何从原始测序数据中蕴含的定量信号，推断出关于肿瘤内部异质性（例如，一个突变是克隆性的还是亚克隆性的）的关键生物学信息 [@problem_id:4994339]。", "problem": "一个转化肿瘤学实验室正在评估一种通过第二代测序 (NGS) 检测到的单核苷酸变异 (SNV)，以确定其作为潜在预测性生物标志物的可能性。整体肿瘤样本由癌细胞和正常细胞混合而成。设肿瘤纯度为样本中癌细胞的比例，记为 $p$。假设整体测序的读数计数与每个组分（癌症与正常）贡献的染色体拷贝数成正比，并且该基因座上的正常细胞是二倍体。将变异等位基因频率 (VAF) 定义为整体样本中携带变异的测序读数的预期比例。\n\n在一个肿瘤总拷贝数为 $C_{\\text{tumor}}$ 的基因座上，假设 SNV 存在于比例为 $f$ 的癌细胞中，其中 $f$ 是癌细胞分数 (CCF)。在每个携带突变的癌细胞中，SNV 仅存在于一个染色体拷贝上（即，突变丰度为 $m=1$，这与杂合性单拷贝事件一致），并且所有正常细胞中均无此突变。此基因座上的正常拷贝数为 $C_{\\text{normal}}=2$。\n\n对于一个肿瘤纯度 $p=0.6$、基因座处肿瘤总拷贝数 $C_{\\text{tumor}}=3$、观测到的 VAF 为 $0.12$ 的患者样本（假设进行了高深度测序，因此观测到的 VAF 等于其在混合模型下的期望值），请从第一性原理推导出以 $p$、$f$、$m$、$C_{\\text{tumor}}$ 和 $C_{\\text{normal}}$ 表示的预期 VAF 的表达式，然后计算癌细胞分数 $f$ 的隐含值。将最终答案表示为小数。不要使用百分号。如果选择四舍五入，请根据给定值提供精确的小数表示，而不是基于百分比的四舍五入。", "solution": "首先，我们推导预期VAF的通用表达式。VAF定义为支持变异的测序读段数与总测序读段数的比率。根据假设，读段数与DNA拷贝数成正比。\n\n**1. 计算支持变异的DNA拷贝总数：**\n- 正常细胞不含变异，其贡献为0。\n- 在肿瘤细胞中，有比例为 $f$ 的细胞携带变异。\n- 每个携带变异的肿瘤细胞有 $m$ 个变异等位基因拷贝。\n- 因此，在一个代表性的混合样本中，来自肿瘤细胞的变异拷贝贡献与 $p \\cdot f \\cdot m$ 成正比。\n\n**2. 计算总DNA拷贝数：**\n- 来自正常细胞的拷贝贡献与 $(1-p) \\cdot C_{\\text{normal}}$ 成正比。\n- 来自肿瘤细胞的拷贝贡献与 $p \\cdot C_{\\text{tumor}}$ 成正比。\n- 因此，总拷贝数与 $(p \\cdot C_{\\text{tumor}}) + ((1-p) \\cdot C_{\\text{normal}})$ 成正比。\n\n**3. 组合得到VAF表达式：**\n将支持变异的拷贝数除以总拷贝数，我们得到预期的VAF表达式：\n$$ \\text{VAF} = \\frac{p \\cdot f \\cdot m}{p \\cdot C_{\\text{tumor}} + (1-p) \\cdot C_{\\text{normal}} $$\n这就是从第一性原理推导出的通用表达式。\n\n**4. 计算癌细胞分数 (CCF) $f$：**\n现在，我们使用给定的数值来求解 $f$。\n- 肿瘤纯度 $p = 0.6$\n- 肿瘤总拷贝数 $C_{\\text{tumor}} = 3$\n- 正常细胞拷贝数 $C_{\\text{normal}} = 2$\n- 突变丰度 $m = 1$\n- 观测到的 VAF = $0.12$\n\n将这些值代入我们推导的公式中：\n$$ 0.12 = \\frac{0.6 \\cdot f \\cdot 1}{0.6 \\cdot 3 + (1-0.6) \\cdot 2} $$\n\n首先计算分母：\n$$ 0.6 \\cdot 3 + 0.4 \\cdot 2 = 1.8 + 0.8 = 2.6 $$\n\n现在方程变为：\n$$ 0.12 = \\frac{0.6 \\cdot f}{2.6} $$\n\n接下来，我们求解 $f$：\n$$ f = \\frac{0.12 \\times 2.6}{0.6} $$\n$$ f = \\frac{0.312}{0.6} $$\n$$ f = 0.52 $$\n\n因此，隐含的癌细胞分数（CCF）为 $0.52$。这意味着在肿瘤细胞群体中，有 $52\\%$ 的细胞携带该SNV。", "answer": "$$\\boxed{0.52}$$", "id": "4994339"}, {"introduction": "在理解了单个变异的特性后，我们转向一个复合型生物标志物——肿瘤突变负荷（TMB）。本练习演示了TMB这一免疫治疗关键预测指标的计算方法，并着重强调了通过测序区域（panel size）大小进行标准化的重要性。这个实践揭示了生物标志物开发中的一个关键挑战：确保不同检测方法得到的结果具有可比性，并理解检测设计对统计稳定性的影响 [@problem_id:4994359]。", "problem": "一项转化肿瘤学研究使用新一代测序（NGS）技术和一个靶向癌症基因面板，其可调用编码足迹为 $1.2\\ \\text{Mb}$。在一项肿瘤-正常组织分析中，经过严格的质量控制、胚系变异减除和伪影过滤后，研究报告在该基因面板足迹内有 $15$ 个高置信度的体细胞非同义单核苷酸变异（SNV）。使用肿瘤突变负荷（TMB）的定义，即在所探查的可调用编码序列中体细胞非同义突变的密度，计算该样本每兆碱基的 TMB。然后，讨论为了使具有不同足迹的检测方法之间的 TMB 具有可比性而进行基因面板大小标准化的理由，包括对统计变异性的影响。将您的数值结果四舍五入至四位有效数字，并以每兆碱基的突变数（mutations per megabase）为单位表示。", "solution": "在尝试解答之前，对问题进行验证。\n\n**步骤1：提取已知条件**\n- 新一代测序（NGS）基因面板的可调用编码足迹：$1.2\\ \\text{Mb}$\n- 高置信度体细胞非同义单核苷酸变异（SNV）的数量：$15$\n- 肿瘤突变负荷（TMB）的定义：在所探查的可调用编码序列中体细胞非同义突变的密度。\n- 要求计算：计算每兆碱基的 TMB。\n- 要求讨论：为实现不同检测方法间的可比性而进行基因面板大小标准化的理由，以及对统计变异性的影响。\n- 要求格式：将数值结果四舍五入至四位有效数字，并以每兆碱基的突变数为单位表示。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在科学上是合理的。它使用了分子肿瘤学和生物信息学中的标准术语和概念，包括 NGS、体细胞突变、可调用足迹、SNV 和肿瘤突变负荷（TMB）。所提供的值（$1.2\\ \\text{Mb}$ 的基因面板大小，$15$ 个突变）对于靶向测序实验是现实的。\n- **问题的适定性**：该问题是适定的。它提供了进行计算所需的所有必要数据，并清晰定义了待计算的量。关于标准化的讨论要求是具体且相关的。存在一个唯一的、有意义的解。\n- **客观性**：问题以客观、技术性的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n**解答推导**\n该问题要求计算肿瘤突变负荷（TMB）并讨论其标准化。\n\n**第一部分：TMB 的计算**\n问题将 TMB 定义为在所探查的可调用编码序列中体细胞非同义突变的密度。这在数学上表示为突变数量与所测序基因组区域大小的比率。\n\n设 $N_{\\text{mut}}$ 为符合条件的体细胞突变数量。\n设 $S_{\\text{panel}}$ 为基因面板的可调用编码足迹的大小。\n\n根据问题陈述，我们已知：\n- $N_{\\text{mut}} = 15$\n- $S_{\\text{panel}} = 1.2\\ \\text{Mb}$\n\n因此，TMB 的计算公式为：\n$$ \\text{TMB} = \\frac{N_{\\text{mut}}}{S_{\\text{panel}}} $$\n\n将已知值代入方程：\n$$ \\text{TMB} = \\frac{15}{1.2\\ \\text{Mb}} $$\n\n进行除法运算得出：\n$$ \\text{TMB} = 12.5\\ \\frac{\\text{mutations}}{\\text{Mb}} $$\n\n问题要求结果保留四位有效数字。数值 $12.5$ 当前有三位有效数字。为了表示为四位有效数字，我们添加一个末尾的零。\n$$ \\text{TMB} = 12.50\\ \\frac{\\text{mutations}}{\\text{Mb}} $$\n\n**第二部分：标准化的理由及统计学意义**\n上述计算是一种标准化的行为。其理由和意义对于将 TMB 正确解读为临床生物标志物至关重要。\n\n**1. 基因面板大小标准化的理由与可比性：**\n体细胞突变的原始计数（$N_{\\text{mut}}$）本质上取决于所测序的基因组区域的大小。对于同一个肿瘤，假设突变率均匀分布，一个测序区域更大的检测方法，如全外显子组测序（WES，典型足迹约为 $\\approx 30-40\\ \\text{Mb}$），预计会比一个靶向基因面板（例如本问题中的 $1.2\\ \\text{Mb}$ 面板）检测到更多的突变。\n\n因此，原始突变计数在不同的 NGS 检测方法之间不具有直接可比性。为了创建一个标准化的度量指标，原始计数需要通过可调用足迹的大小进行归一化，从而得到突变密度，即 TMB，单位是每兆碱基的突变数（mut/Mb）。这种标准化原则上允许比较来自不同基因面板的 TMB 值。例如，从一个 $1.2\\ \\text{Mb}$ 基因面板得出的 $12.50\\ \\text{mut/Mb}$ 的 TMB，在临床上应等同于从 WES 分析中计算出的 $12.50\\ \\text{mut/Mb}$ 的 TMB。这种可比性对于建立和应用通用的临床阈值以进行基于 TMB 的治疗决策至关重要，例如预测对免疫检查点抑制剂的反应。\n\n**2. 对统计变异性的影响：**\n尽管标准化使得 TMB 点估计值的比较成为可能，但基因面板的大小对该估计值的统计可靠性和方差有着深远的影响。从基因面板计算出的 TMB 是对肿瘤整个外显子组“真实”TMB 的估计。该估计的精度是样本大小的函数，这里的“样本”是指被测序的基因组区域。\n\n- **小基因面板与抽样误差**：较小的基因面板代表了外显子组的一个较小样本。因此，TMB 估计值会受到更大的抽样误差影响。仅几个突变的检测（或未检测）就可能导致计算出的 TMB 值发生巨大波动。对于一个可调用足迹为 $S_{\\text{panel}}$ 的基因面板，检测到一个额外的突变会使 TMB 改变 $\\Delta(\\text{TMB}) = \\frac{1}{S_{\\text{panel}}}$。对于一个小基因面板（例如 $S_{\\text{panel}} = 0.5\\ \\text{Mb}$），一个额外的突变会使 TMB 改变 $2.0\\ \\text{mut/Mb}$，这是一个显著的跳跃。\n\n- **大基因面板与稳健性**：一个更大的基因面板，例如用于 WES 的面板，对外显子组的采样比例要大得多。根据大数定律，更大的样本能够提供对潜在参数更稳定和准确的估计。由于分母（$S_{\\text{panel}}$）很大，多发现或少发现一个突变所带来的随机变异影响会减小。对于 $S_{\\text{panel}} = 30\\ \\text{Mb}$ 的 WES，一个额外的突变只会使 TMB 改变约 $\\approx 0.033\\ \\text{mut/Mb}$。\n\n- **置信区间**：因此，对于小基因面板，TMB 点估计值周围的置信区间要比大基因面板宽得多。两个不同的基因面板可能得出相同的 $12.5\\ \\text{mut/Mb}$ 点估计值，但来自较小面板的 TMB 可能的“真实”值范围会更广。这种变异性使得对临床阈值附近的肿瘤进行分类变得复杂，因为来自小基因面板的 TMB 值的置信区间可能同时跨越“TMB-低”和“TMB-高”两个类别，从而引入诊断不确定性。这是推动当前协调不同临床检测方法中 TMB 测量工作的主要原因之一。", "answer": "$$ \\boxed{12.50} $$", "id": "4994359"}, {"introduction": "生物标志物的价值最终体现在其临床应用中，而这需要严谨的统计评估。本练习将我们的视角从标志物测量转向临床性能评估，探讨为何一个具有高灵敏度和特异性的检测在特定人群中可能表现不佳。通过应用贝叶斯定理计算阳性预测值（PPV），这个实践有力地说明了疾病患病率如何显著影响生物标志物的实际效用，这是连接实验室指标与临床现实的基本概念 [@problem_id:4994331]。", "problem": "一个转化医学团队开发了一种基于下一代测序技术 (NGS) 的RNA测序 (RNA-seq) 基因表达分类器，旨在检测因不明原因呼吸困难而转诊至专科诊所的患者中的亚临床炎症性心肌病。该分类器根据一个学习到的多基因特征输出一个二元判别结果。在一个能反映目标使用人群的独立锁定验证集上，该分类器的灵敏度为 $0.90$，特异度为 $0.90$。该诊所人群的流行病学数据表明，真实的疾病患病率为 $0.05$。\n\n请仅从灵敏度、特异度、患病率和贝叶斯定理的定义出发，推导出一个用灵敏度、特异度和患病率表示阳性预测值 (PPV) 的表达式，并根据给定的操作特性和患病率计算PPV。\n\n如果有帮助，你可以实例化一个大小为 $N = 10,000$ 的假设筛查队列来说明计数，但你的最终结果必须是PPV这一个数值。\n\n将你的最终答案表示为精确分数或小数（比例）。不要使用百分号。无需四舍五入。", "solution": "本题要求在给定诊断测试的灵敏度、特异度以及目标人群中疾病患病率的情况下，推导并计算阳性预测值 (PPV)。我将首先从基本原理推导PPV的通用公式，然后使用所提供的具体参数计算其值。\n\n让我们定义以下事件：\n-   $D$：患者患有该疾病（炎症性心肌病）的事件。\n-   $D^c$：患者未患该疾病的事件。\n-   $T^+$：分类器测试结果为阳性的事件。\n-   $T^-$：分类器测试结果为阴性的事件。\n\n题目提供了以下参数，它们被定义为条件概率：\n-   患病率 ($p$)：患有该疾病的先验概率，即 $P(D)$。\n-   灵敏度 ($Se$)：在患者患有该疾病的情况下，测试结果为阳性的概率，即 $P(T^+ | D)$。\n-   特异度 ($Sp$)：在患者未患该疾病的情况下，测试结果为阴性的概率，即 $P(T^- | D^c)$。\n\n所提供的值为：\n-   $p = P(D) = 0.05$\n-   $Se = P(T^+ | D) = 0.90$\n-   $Sp = P(T^- | D^c) = 0.90$\n\n我们的任务是求阳性预测值 (PPV)，其定义为在测试结果为阳性的条件下，患者确实患有该疾病的概率。用概率术语表示，即 $P(D | T^+)$。\n\n根据贝叶斯定理，后验概率 $P(D | T^+)$ 可以表示为：\n$$\nP(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}\n$$\n\n分母 $P(T^+)$ 是获得阳性测试结果的总概率。它可以通过使用全概率定律，对疾病状态（患病 $D$ 或未患病 $D^c$）进行边缘化来计算：\n$$\nP(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)\n$$\n使用条件概率的定义 $P(A \\cap B) = P(A|B)P(B)$，上式变为：\n$$\nP(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)\n$$\n\n我们可以用给定的参数来表示这个方程中的各项：\n-   $P(T^+ | D) = Se$\n-   $P(D) = p$\n-   $P(D^c) = 1 - P(D) = 1 - p$\n-   $P(T^+ | D^c)$ 是未患病个体测试结果为阳性的概率，即假阳性率。它与特异度的关系为 $P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp$。\n\n将这些代入 $P(T^+)$ 的表达式中：\n$$\nP(T^+) = (Se)(p) + (1 - Sp)(1 - p)\n$$\n\n现在，将这个分母代回到PPV的贝叶斯定理表达式中，我们得到用灵敏度、特异度和患病率表示的PPV通用公式：\n$$\n\\text{PPV} = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)} = \\frac{Se \\cdot p}{Se \\cdot p + (1 - Sp) \\cdot (1 - p)}\n$$\n这就是所要求推导的表达式。\n\n为了说明这些抽象的概率，我们可以从指定的诊所人群中实例化一个大小为 $N = 10,000$ 的假设队列。\n-   患病人数：$N \\times p = 10,000 \\times 0.05 = 500$ 人。\n-   未患病人数：$N \\times (1 - p) = 10,000 \\times 0.95 = 9,500$ 人。\n\n在 $500$ 名患病者中：\n-   真阳性 (TP)：测试结果为阳性的人数。即 $500 \\times Se = 500 \\times 0.90 = 450$ 人。\n-   假阴性 (FN)：测试结果为阴性的人数。即 $500 \\times (1 - Se) = 500 \\times 0.10 = 50$ 人。\n\n在 $9,500$ 名未患病者中：\n-   假阳性 (FP)：测试结果为阳性的人数。即 $9,500 \\times (1 - Sp) = 9,500 \\times 0.10 = 950$ 人。\n-   真阴性 (TN)：测试结果为阴性的人数。即 $9,500 \\times Sp = 9,500 \\times 0.90 = 8,550$ 人。\n\n测试结果为阳性的总人数是真阳性和假阳性的总和：\n阳性总数 = $TP + FP = 450 + 950 = 1,400$ 人。\n\nPPV 是测试结果为阳性的人中真正患病的比例：\n$$\n\\text{PPV} = \\frac{TP}{TP + FP} = \\frac{450}{1,400}\n$$\n\n现在，我们使用推导出的公式和给定的参数来计算最终值：$Se = 0.90$, $Sp = 0.90$, $p = 0.05$。\n$$\n\\text{PPV} = \\frac{(0.90)(0.05)}{(0.90)(0.05) + (1 - 0.90)(1 - 0.05)}\n$$\n$$\n\\text{PPV} = \\frac{0.045}{0.045 + (0.10)(0.95)}\n$$\n$$\n\\text{PPV} = \\frac{0.045}{0.045 + 0.095}\n$$\n$$\n\\text{PPV} = \\frac{0.045}{0.140}\n$$\n为了将其表示为精确分数，我们可以写成：\n$$\n\\text{PPV} = \\frac{45}{140} = \\frac{5 \\times 9}{5 \\times 28} = \\frac{9}{28}\n$$\n这个结果与使用队列计数得到的结果（$\\frac{450}{1,400} = \\frac{45}{140} = \\frac{9}{28}$）相同，从而验证了计算的正确性。尽管灵敏度和特异度都很高，但PPV值较低，这突显了疾病患病率在临床环境中对测试预测值的深远影响。", "answer": "$$\n\\boxed{\\frac{9}{28}}\n$$", "id": "4994331"}]}