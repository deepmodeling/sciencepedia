{"hands_on_practices": [{"introduction": "这项实践将探讨受体-配体结合的基本原理，这是细胞通讯的基石。我们将计算巨噬细胞上模式识别受体（PRRs）的结合比例，将配体浓度和结合亲和力与细胞激活阈值联系起来。这项练习为理解先天免疫细胞如何感知病原体或危险信号提供了定量基础。[@problem_id:5016569]", "problem": "一个处于微流控灌流室中的巨噬细胞在其表面以均匀密度表达单一类型的模式识别受体（PRR；Pattern Recognition Receptor）。配体被持续供应，维持恒定的本体浓度。在平衡状态下，受体-配体结合遵循质量作用定律。受体-配体对的解离常数（$K_D$；Dissociation Constant）定义为平衡时游离受体和游离配体浓度与受体-配体复合物浓度的比值。总受体库是守恒的，等于游离受体和结合受体之和。\n\n给定以下参数：\n- 每个细胞的总PRR密度：$3.2 \\times 10^{4}$ 个受体。\n- 配体本体浓度：$18$ nM。\n- 解离常数：$30$ nM。\n- 下游信号传导的激活阈值：每个细胞至少有 $1.0 \\times 10^{4}$ 个结合的受体。\n\n从$K_D$的基本平衡定义和总受体守恒出发，推导出平衡时结合（被占据）的PRR的分数。然后，使用所提供的值对该分数进行数值计算，并用它来推断在这些条件下是否会达到激活阈值。仅报告结合的PRR的分数。将您的数值答案四舍五入到四位有效数字。该分数为无量纲。", "solution": "首先将对问题陈述的科学性和逻辑完整性进行验证。\n\n### 步骤 1：提取已知条件\n以下是逐字提供的参数和定义：\n- 每个细胞的总PRR密度：$3.2 \\times 10^{4}$ 个受体。\n- 配体本体浓度：$18$ nM。\n- 解离常数（$K_D$）：$30$ nM。\n- 下游信号传导的激活阈值：每个细胞至少有 $1.0 \\times 10^{4}$ 个结合的受体。\n- 解离常数（$K_D$）定义为平衡时游离受体和游离配体浓度与受体-配体复合物浓度的比值。\n- 总受体库是守恒的，等于游离受体和结合受体之和。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估。\n- **科学依据**：该问题基于质量作用定律，这是化学动力学的一个基本原则，及其在受体-配体结合中的应用，而后者是药理学、免疫学和细胞生物学的基石。解离常数（$K_D$）的定义是标准的。受体密度、配体浓度和$K_D$的数值在生物学上是合理的。\n- **适定性**：问题表述清晰。它提供了所有必要的信息——总受体数、配体浓度和解离常数——以确定结合受体的分数。存在唯一解。\n- **客观性**：问题使用精确、定量和客观的语言陈述，没有任何主观性或模糊性。\n- **完整性和一致性**：问题是自洽的。参数足以进行推导，且没有矛盾之处。单位（nM用于浓度）是一致的。\n- **现实性**：在具有恒定灌流的微流控室中的巨噬细胞这一情境是细胞生物学和免疫学研究中的标准实验设置，使得该场景是现实的。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。这是一个植根于基本生化原理的标准平衡结合问题。现在将继续解题过程。\n\n目标是推导并计算在平衡状态下结合（被配体占据）的模式识别受体（PRR）的分数。\n\n设 $[R]$ 代表游离受体的浓度，$[L]$ 代表游离配体的浓度，$[RL]$ 代表受体-配体复合物（结合的受体）的浓度。总受体浓度 $[R_T]$ 是恒定的。\n\n受体守恒表示为：\n$$ [R_T] = [R] + [RL] $$\n\n解离常数 $K_D$ 由反应 $RL \\rightleftharpoons R + L$ 的平衡定义：\n$$ K_D = \\frac{[R][L]}{[RL]} $$\n\n结合受体的分数，我们记为 $\\theta$，是结合受体浓度与总受体浓度的比值：\n$$ \\theta = \\frac{[RL]}{[R_T]} $$\n\n为了找到用 $[L]$ 和 $K_D$ 表示 $\\theta$ 的表达式，我们首先重新整理 $K_D$ 的定义以求解 $[R]$：\n$$ [R] = \\frac{K_D [RL]}{[L]} $$\n\n接下来，我们将 $[R]$ 的这个表达式代入受体守恒方程：\n$$ [R_T] = \\frac{K_D [RL]}{[L]} + [RL] $$\n$$ [R_T] = [RL] \\left( \\frac{K_D}{[L]} + 1 \\right) $$\n\n现在，我们可以重新整理这个方程来表达分数 $\\theta = \\frac{[RL]}{[R_T]}$：\n$$ \\theta = \\frac{[RL]}{[R_T]} = \\frac{1}{\\frac{K_D}{[L]} + 1} $$\n将分子和分母同乘以 $[L]$，得到更常见的形式，通常称为朗缪尔等温线或希尔-朗缪尔方程（对于希尔系数为 $1$ 的情况）：\n$$ \\theta = \\frac{[L]}{K_D + [L]} $$\n\n问题陈述，配体是持续供应的，维持恒定的本体浓度。这意味着配体与细胞表面受体的结合不会显著消耗配体的本体浓度。因此，平衡时的游离配体浓度 $[L]$ 可以取为给定的配体本体浓度。\n\n给定的数值是：\n- 配体本体浓度，$[L] = 18 \\text{ nM}$。\n- 解离常数， $K_D = 30 \\text{ nM}$。\n\n将这些值代入推导出的 $\\theta$ 表达式中：\n$$ \\theta = \\frac{18 \\text{ nM}}{30 \\text{ nM} + 18 \\text{ nM}} = \\frac{18}{48} $$\n\n简化该分数：\n$$ \\theta = \\frac{18}{48} = \\frac{3 \\times 6}{8 \\times 6} = \\frac{3}{8} $$\n\n将该分数转换为小数得到：\n$$ \\theta = 0.375 $$\n\n问题要求将数值答案四舍五入到四位有效数字。因此：\n$$ \\theta = 0.3750 $$\n\n作为内部检验，我们可以确定是否达到了激活阈值。每个细胞的总受体数是 $R_{total} = 3.2 \\times 10^{4}$。结合的受体数量 $N_{engaged}$ 是：\n$$ N_{engaged} = \\theta \\times R_{total} = 0.3750 \\times (3.2 \\times 10^{4}) = \\frac{3}{8} \\times 32000 = 3 \\times 4000 = 12000 $$\n结合的受体数量是 $1.2 \\times 10^{4}$。激活阈值是 $1.0 \\times 10^{4}$ 个结合的受体。由于 $1.2 \\times 10^{4} > 1.0 \\times 10^{4}$，在这些条件下，下游信号传导的激活阈值将会被满足。这证实了问题的逻辑一致性，但问题要求只报告结合的PRR的分数。", "answer": "$$\n\\boxed{0.3750}\n$$", "id": "5016569"}, {"introduction": "基于平衡结合的原理，这项实践深入研究了抗体-抗原相互作用的动力学，这是治疗性单克隆抗体设计的关键环节。通过从动力学速率常数计算平衡解离常数（$K_D$）并预测抗原占有率，您将深入了解抗体亲和力如何决定其在生理环境中的中和效力。这项技能对于在转化医学中评估和优化生物制剂至关重要。[@problem_id:5016628]", "problem": "一种人源化单克隆免疫球蛋白G (IgG) 被开发用于中和一种与系统性自身免疫中适应性免疫的病理激活有关的可溶性自身抗原。在 $37^{\\circ}\\mathrm{C}$ 的缓冲生理条件下，通过表面等离子共振 (SPR) 测量得到了抗体-抗原相互作用的结合速率常数 $k_{\\text{on}}$ 和解离速率常数 $k_{\\text{off}}$。假设每个抗原有一个单一的非协同结合位点（单价表位），没有亲合力或再结合效应，并且由于血浆中抗体相对于抗原处于大的摩尔过量状态，游离抗体浓度近似于总抗体浓度。\n\n给定 $k_{\\text{on}} = 1.2 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$ 和 $k_{\\text{off}} = 8.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$，以及在患者体内达到的稳态游离抗体浓度为 $[{\\mathrm{Ab}}] = 20\\ \\mathrm{nM}$，请使用质量作用定律和平衡定义推导平衡解离常数 $K_{D}$ 和平衡时抗体对抗原的占据分数的表达式。然后根据所提供的参数计算这两个量。\n\n将平衡解离常数四舍五入到三位有效数字，并以纳摩尔为单位表示；将抗原占据分数四舍五入到四位有效数字，并以无单位小数表示。", "solution": "首先将根据指定协议对问题陈述进行验证。\n\n### 步骤1：提取给定条件\n- 人源化单克隆免疫球蛋白G (IgG) 可中和一种可溶性自身抗原。\n- 在温度 $T = 37^{\\circ}\\mathrm{C}$ 下通过表面等离子共振 (SPR) 测量相互作用。\n- 结合速率常数: $k_{\\text{on}} = 1.2 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$。\n- 解离速率常数: $k_{\\text{off}} = 8.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$。\n- 结合是非协同的，每个抗原有一个结合位点（单价）。\n- 不考虑亲合力或再结合效应。\n- 游离抗体浓度近似于总抗体浓度。\n- 患者体内的稳态游离抗体浓度: $[{\\mathrm{Ab}}] = 20\\ \\mathrm{nM}$。\n- 任务是推导并计算平衡解离常数 ($K_{D}$) 和平衡时的抗原占据分数 ($\\theta$) 的表达式。\n- $K_D$ 的舍入要求：三位有效数字，以纳摩尔 ($\\mathrm{nM}$) 表示。\n- $\\theta$ 的舍入要求：四位有效数字，以无单位小数表示。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据**：该问题基于质量作用定律，这是化学动力学的基本原理，并将其应用于免疫学和药理学中的一个标准情景——单克隆抗体与其抗原的结合。结合/解离速率常数、平衡解离常数和分数占据率等概念是受体理论和抗体-抗原相互作用的基石。给定的 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 值对于高亲和力IgG抗体是符合实际的。\n- **问题适定**：问题定义清晰。它提供了推导和计算所需量的所有必要数据 ($k_{\\text{on}}$, $k_{\\text{off}}$, $[{\\mathrm{Ab}}]$) 和简化假设（单价相互作用，抗体过量）。存在唯一且稳定的解。\n- **客观性**：问题以精确、客观和定量的语言陈述。它不包含任何主观或基于意见的主张。\n\n该问题没有表现出任何列出的缺陷（科学上不合理、非形式化、设置不完整、不切实际、不适定、伪深刻或超出科学可验证性）。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供完整的解决方案。\n\n### 求解推导与计算\n抗体 (${\\mathrm{Ab}}$) 和抗原 (${\\mathrm{Ag}}$) 之间的相互作用是一个可逆的结合反应，可以表示为：\n$$ {\\mathrm{Ab}} + {\\mathrm{Ag}} \\underset{k_{\\text{off}}}{\\stackrel{k_{\\text{on}}}{\\rightleftharpoons}} {\\mathrm{AbAg}} $$\n其中 ${\\mathrm{AbAg}}$ 是抗体-抗原复合物。\n\n根据质量作用定律，结合速率 ($v_{\\text{on}}$) 与游离反应物的浓度成正比：\n$$ v_{\\text{on}} = k_{\\text{on}} [{\\mathrm{Ab}}] [{\\mathrm{Ag}}] $$\n解离速率 ($v_{\\text{off}}$) 与复合物的浓度成正比：\n$$ v_{\\text{off}} = k_{\\text{off}} [{\\mathrm{AbAg}}] $$\n在平衡状态下，结合速率等于解离速率：\n$$ v_{\\text{on}} = v_{\\text{off}} $$\n$$ k_{\\text{on}} [{\\mathrm{Ab}}] [{\\mathrm{Ag}}] = k_{\\text{off}} [{\\mathrm{AbAg}}] $$\n\n平衡解离常数 $K_{D}$ 定义为平衡时解离物质的浓度与复合物浓度的比值。它可以从平衡条件推导出来：\n$$ K_{D} = \\frac{[{\\mathrm{Ab}}] [{\\mathrm{Ag}}]}{[{\\mathrm{AbAg}}]} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} $$\n这是 $K_{D}$ 所需的表达式。\n\n接下来，我们使用给定的速率常数计算 $K_{D}$ 的值：\n$$ k_{\\text{on}} = 1.2 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1} $$\n$$ k_{\\text{off}} = 8.0 \\times 10^{-4}\\ \\mathrm{s}^{-1} $$\n$$ K_{D} = \\frac{8.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}}{1.2 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}} = \\frac{8.0}{1.2} \\times 10^{-10}\\ \\mathrm{M} \\approx 6.666... \\times 10^{-10}\\ \\mathrm{M} $$\n问题要求答案以纳摩尔 ($\\mathrm{nM}$) 为单位。我们使用换算关系 $1\\ \\mathrm{nM} = 10^{-9}\\ \\mathrm{M}$，或 $1\\ \\mathrm{M} = 10^{9}\\ \\mathrm{nM}$：\n$$ K_{D} = (6.666... \\times 10^{-10}\\ \\mathrm{M}) \\times (10^{9}\\ \\mathrm{nM}/\\mathrm{M}) = 0.6666...\\ \\mathrm{nM} $$\n四舍五入到三位有效数字，得到：\n$$ K_{D} \\approx 0.667\\ \\mathrm{nM} $$\n\n抗原占据分数，此处用 $\\theta$ 表示，是指在平衡状态下，被抗体结合的抗原占总抗原群体的比例。\n$$ \\theta = \\frac{\\text{结合抗原的浓度}}{\\text{总抗原的浓度}} = \\frac{[{\\mathrm{AbAg}}]}{[{\\mathrm{Ag}}] + [{\\mathrm{AbAg}}]} $$\n为了用 $[{\\mathrm{Ab}}]$ 和 $K_{D}$ 来表示 $\\theta$，我们重新整理 $K_{D}$ 的定义：\n$$ [{\\mathrm{AbAg}}] = \\frac{[{\\mathrm{Ab}}] [{\\mathrm{Ag}}]}{K_{D}} $$\n将此代入 $\\theta$ 的表达式：\n$$ \\theta = \\frac{\\frac{[{\\mathrm{Ab}}] [{\\mathrm{Ag}}]}{K_{D}}}{[{\\mathrm{Ag}}] + \\frac{[{\\mathrm{Ab}}] [{\\mathrm{Ag}}]}{K_{D}}} $$\n我们可以从分子和分母中消去游离抗原浓度 $[{\\mathrm{Ag}}]$（假设 $[{\\mathrm{Ag}}] \\neq 0$）：\n$$ \\theta = \\frac{\\frac{[{\\mathrm{Ab}}]}{K_{D}}}{1 + \\frac{[{\\mathrm{Ab}}]}{K_{D}}} $$\n将分子和分母同时乘以 $K_{D}$，得到抗原占据分数的简化表达式：\n$$ \\theta = \\frac{[{\\mathrm{Ab}}]}{K_{D} + [{\\mathrm{Ab}}]} $$\n这是 $\\theta$ 所需的表达式。\n\n现在，我们使用给定的稳态游离抗体浓度 $[{\\mathrm{Ab}}] = 20\\ \\mathrm{nM}$ 和先前计算出的 $K_{D}$ 值来计算 $\\theta$ 的值。为确保精度，应使用未舍入的 $K_{D}$ 值。\n$$ [{\\mathrm{Ab}}] = 20\\ \\mathrm{nM} $$\n$$ K_{D} = 0.6666...\\ \\mathrm{nM} = \\frac{2}{3}\\ \\mathrm{nM} $$\n$$ \\theta = \\frac{20\\ \\mathrm{nM}}{\\frac{2}{3}\\ \\mathrm{nM} + 20\\ \\mathrm{nM}} = \\frac{20}{\\frac{2}{3} + \\frac{60}{3}} = \\frac{20}{\\frac{62}{3}} = \\frac{20 \\times 3}{62} = \\frac{60}{62} = \\frac{30}{31} $$\n将此分数转换为小数：\n$$ \\theta = \\frac{30}{31} \\approx 0.9677419... $$\n四舍五入到四位有效数字，得到：\n$$ \\theta \\approx 0.9677 $$\n问题中关于游离抗体浓度近似于总抗体浓度的假设是合理的，因为高占据率 ($\\theta \\approx 97\\%$) 意味着结合抗体的浓度 ($[{\\mathrm{AbAg}}]$) 几乎等于总抗原浓度。只要总抗原浓度远小于总抗体浓度，游离抗体浓度就会保持接近其总值。", "answer": "$$\\boxed{\\begin{pmatrix} 0.667  0.9677 \\end{pmatrix}}$$", "id": "5016628"}, {"introduction": "最后的这项实践从分子相互作用转向群体水平的动态学，这是系统免疫学中的一个关键方法。您将使用一个微分方程系统来模拟自身反应性T细胞群体的命运，以量化外周耐受机制的结果。这项练习展示了如何运用数学模型来预测自身免疫与免疫调节之间的动态平衡，为转化研究提供了强大的工具。[@problem_id:5016553]", "problem": "一个自身反应性T细胞群体在非炎症环境中遇到恒定水平的自身抗原，此时外周耐受机制占主导地位。在这种情况下，自身反应性常规T细胞可以经历克隆清除（细胞死亡）或转化为诱导性调节性T细胞（调节性T细胞 (Treg)）。假设一个充分混合的区室，并使用具有线性单细胞速率的质量作用定律来模拟细胞群体动力学。令 $S(t)$ 表示在时间 $t$ 存活的自身反应性常规T细胞的数量，令 $R(t)$ 表示在时间 $t$ 诱导性调节性T细胞 (Treg) 的数量。假设单细胞清除速率为 $\\delta$（单位为 $\\mathrm{day}^{-1}$），转化为调节性T细胞 (Treg) 的单细胞速率为 $\\alpha$（单位为 $\\mathrm{day}^{-1}$），诱导性调节性T细胞 (Treg) 的单细胞损失速率为 $\\mu$（单位为 $\\mathrm{day}^{-1}$）。控制系统为：\n- $ \\dfrac{dS}{dt} = -(\\delta + \\alpha) \\, S(t) $,\n- $ \\dfrac{dR}{dt} = \\alpha \\, S(t) - \\mu \\, R(t) $,\n初始条件为 $S(0) = S_0$ 和 $R(0) = R_0$。定义到时间 $T$ 为止的累积清除事件数为 $D(T) = \\int_{0}^{T} \\delta \\, S(\\tau) \\, d\\tau$，以及到时间 $T$ 为止的累积转化事件数为 $C(T) = \\int_{0}^{T} \\alpha \\, S(\\tau) \\, d\\tau$。\n\n您的任务是为每个参数集计算四元组 $[S(T), R(T), D(T), C(T)]$。所有报告的量都代表预期的细胞计数，并且必须以“细胞”为单位进行解释。时间以“天”为单位，所有速率均以 $\\mathrm{day}^{-1}$ 为单位。不涉及角度单位。所有结果均以实数表示。\n\n使用以下测试套件（每个元组为 $(S_0, R_0, \\delta, \\alpha, \\mu, T)$）：\n- A例（一般非退化情况）： $(100000, 0, 0.2, 0.1, 0.05, 14)$，\n- B例（无转化）： $(20000, 1000, 0.3, 0, 0.1, 10)$，\n- C例（无清除）： $(50000, 0, 0, 0.2, 0.1, 7)$，\n- D例（无调节性T细胞 (Treg) 损失）： $(1000, 0, 0.05, 0.15, 0, 30)$，\n- E例（损失速率与总退出速率匹配）： $(10000, 100, 0.2, 0.3, 0.5, 5)$，\n- F例（初始时间边界）： $(12345, 67, 0.1, 0.2, 0.3, 0)$。\n\n您的程序应生成单行输出，其中包含按A到F的顺序汇总的所有案例的结果，形式为一个无空格的、用方括号括起来的逗号分隔列表，通过按案例顺序连接四元组得到。因此，输出格式为 $[S_A(T),R_A(T),D_A(T),C_A(T),S_B(T),R_B(T),D_B(T),C_B(T),\\dots,S_F(T),R_F(T),D_F(T),C_F(T)]$。所有值都应报告为表示细胞计数的实数。", "solution": "所提出的问题是一个适定的线性常微分方程 (ODE) 系统，用于描述T细胞的群体动力学，这是数学免疫学中的一种标准方法。在简化模型的背景下，其前提在科学上是合理的，并且所有参数和初始条件都已提供。因此，我们可以着手推导解析解。\n\n该系统定义如下：\n$$ \\dfrac{dS}{dt} = -(\\delta + \\alpha) S(t) $$\n$$ \\dfrac{dR}{dt} = \\alpha S(t) - \\mu R(t) $$\n初始条件为 $S(0) = S_0$ 和 $R(0) = R_0$。\n\n首先，我们求解自身反应性常规T细胞的群体 $S(t)$。关于 $S(t)$ 的方程是一个一阶线性齐次常系数常微分方程。\n令 $\\lambda = \\delta + \\alpha$ 为从常规T细胞区室的总退出速率。方程变为 $\\dfrac{dS}{dt} = -\\lambda S(t)$。\n这个方程可以通过分离变量法或使用特征方程来求解。其通解为 $S(t) = C e^{-\\lambda t}$，其中 $C$ 是某个常数。\n使用初始条件 $S(0) = S_0$，我们得到 $S_0 = C e^0 = C$。\n因此，$S(t)$ 的解是：\n$$ S(t) = S_0 e^{-(\\delta + \\alpha)t} $$\n\n接下来，我们求解诱导性调节性T细胞的群体 $R(t)$。我们将 $S(t)$ 的解代入第二个常微分方程：\n$$ \\dfrac{dR}{dt} = \\alpha (S_0 e^{-(\\delta + \\alpha)t}) - \\mu R(t) $$\n将其重排为一阶线性非齐次常微分方程的标准形式：\n$$ \\dfrac{dR}{dt} + \\mu R(t) = \\alpha S_0 e^{-(\\delta + \\alpha)t} $$\n我们使用积分因子法求解此方程。积分因子为 $I(t) = e^{\\int \\mu dt} = e^{\\mu t}$。用 $I(t)$ 乘以方程得到：\n$$ e^{\\mu t} \\dfrac{dR}{dt} + \\mu e^{\\mu t} R(t) = \\alpha S_0 e^{\\mu t} e^{-(\\delta + \\alpha)t} $$\n左边是一个乘积的导数：\n$$ \\dfrac{d}{dt} \\left( R(t) e^{\\mu t} \\right) = \\alpha S_0 e^{(\\mu - \\delta - \\alpha)t} $$\n对两边关于 $t$ 积分：\n$$ R(t) e^{\\mu t} = \\int \\alpha S_0 e^{(\\mu - \\delta - \\alpha)t} dt $$\n解取决于被积函数中的指数是否为零。令 $\\lambda = \\delta + \\alpha$。\n\n情况1：$\\mu \\neq \\lambda$。\n$$ R(t) e^{\\mu t} = \\frac{\\alpha S_0}{\\mu - \\lambda} e^{(\\mu - \\lambda)t} + C' $$\n其中 $C'$ 是积分常数。求解 $R(t)$：\n$$ R(t) = \\frac{\\alpha S_0}{\\mu - \\lambda} e^{-\\lambda t} + C' e^{-\\mu t} $$\n使用初始条件 $R(0) = R_0$：\n$$ R_0 = \\frac{\\alpha S_0}{\\mu - \\lambda} + C' \\implies C' = R_0 - \\frac{\\alpha S_0}{\\mu - \\lambda} $$\n将 $C'$ 代回，得到 $R(t)$ 的解：\n$$ R(t) = \\frac{\\alpha S_0}{\\mu - \\lambda} e^{-\\lambda t} + \\left( R_0 - \\frac{\\alpha S_0}{\\mu - \\lambda} \\right) e^{-\\mu t} = R_0 e^{-\\mu t} + \\frac{\\alpha S_0}{\\mu - (\\delta + \\alpha)} \\left( e^{-(\\delta + \\alpha)t} - e^{-\\mu t} \\right) $$\n\n情况2：$\\mu = \\lambda = \\delta + \\alpha$。\n在这种情况下，积分中的指数为零，所以 $e^{(\\mu - \\lambda)t} = 1$。积分变为：\n$$ \\dfrac{d}{dt} \\left( R(t) e^{\\mu t} \\right) = \\alpha S_0 $$\n$$ R(t) e^{\\mu t} = \\alpha S_0 t + C'' $$\n求解 $R(t)$：\n$$ R(t) = (\\alpha S_0 t + C'') e^{-\\mu t} $$\n使用初始条件 $R(0) = R_0$：\n$$ R_0 = (\\alpha S_0 \\cdot 0 + C'') e^0 \\implies C'' = R_0 $$\n在这种特殊情况下，$R(t)$ 的解是：\n$$ R(t) = (R_0 + \\alpha S_0 t) e^{-\\mu t} $$\n\n最后，我们计算累积清除事件数 $D(T)$ 和累积转化事件数 $C(T)$。它们由积分定义：\n$$ D(T) = \\int_{0}^{T} \\delta \\, S(\\tau) \\, d\\tau $$\n$$ C(T) = \\int_{0}^{T} \\alpha \\, S(\\tau) \\, d\\tau $$\n我们首先计算 $S(\\tau)$ 的积分：\n$$ \\int_{0}^{T} S(\\tau) d\\tau = \\int_{0}^{T} S_0 e^{-(\\delta + \\alpha)\\tau} d\\tau $$\n令 $\\lambda = \\delta + \\alpha$。如果 $\\lambda \\neq 0$：\n$$ \\int_{0}^{T} S_0 e^{-\\lambda \\tau} d\\tau = S_0 \\left[ -\\frac{1}{\\lambda} e^{-\\lambda \\tau} \\right]_{0}^{T} = -\\frac{S_0}{\\lambda} (e^{-\\lambda T} - 1) = \\frac{S_0}{\\lambda} (1 - e^{-\\lambda T}) $$\n如果 $\\lambda = 0$（由于速率是非负的，这意味着 $\\delta=0$ 且 $\\alpha=0$），那么 $S(\\tau)=S_0$，积分为 $S_0 T$。\n\n对于 $\\lambda = \\delta + \\alpha \\neq 0$：\n$$ D(T) = \\delta \\left( \\frac{S_0}{\\delta + \\alpha} (1 - e^{-(\\delta + \\alpha)T}) \\right) = \\frac{\\delta S_0}{\\delta + \\alpha} (1 - e^{-(\\delta + \\alpha)T}) $$\n$$ C(T) = \\alpha \\left( \\frac{S_0}{\\delta + \\alpha} (1 - e^{-(\\delta + \\alpha)T}) \\right) = \\frac{\\alpha S_0}{\\delta + \\alpha} (1 - e^{-(\\delta + \\alpha)T}) $$\n如果 $\\lambda = \\delta + \\alpha = 0$，那么 $\\delta=0$ 且 $\\alpha=0$，这意味着 $D(T)=0$ 且 $C(T)=0$。这些结果与当 $\\lambda \\to 0$ 时通式表达式的极限是一致的。\n一个有用的一致性检验是源自 $S$ 区室的细胞守恒：初始群体 $S_0$ 必须等于剩余的细胞 $S(T)$、被清除的细胞 $D(T)$ 和被转化的细胞 $C(T)$ 的总和。\n$$ S_0 = S(T) + D(T) + C(T) $$\n$$ S_0 = S_0 e^{-(\\delta+\\alpha)T} + \\frac{\\delta S_0}{\\delta + \\alpha} (1 - e^{-(\\delta + \\alpha)T}) + \\frac{\\alpha S_0}{\\delta + \\alpha} (1 - e^{-(\\delta + \\alpha)T}) $$\n$$ S_0 = S_0 e^{-(\\delta+\\alpha)T} + \\frac{(\\delta + \\alpha) S_0}{\\delta + \\alpha} (1 - e^{-(\\delta + \\alpha)T}) $$\n$$ S_0 = S_0 e^{-(\\delta+\\alpha)T} + S_0 (1 - e^{-(\\delta + \\alpha)T}) = S_0 $$\n该恒等式成立。\n\n总结一下，对于给定的参数集 $(S_0, R_0, \\delta, \\alpha, \\mu, T)$，四元组 $[S(T), R(T), D(T), C(T)]$ 的计算方法如下：\n令 $\\lambda = \\delta + \\alpha$。\n1.  $S(T) = S_0 e^{-\\lambda T}$\n2.  如果对于一个小的容差 $\\epsilon$（例如 $10^{-9}$）有 $|\\mu - \\lambda|  \\epsilon$，则使用 $R(T)$ 的退化情况公式：\n    $R(T) = (R_0 + \\alpha S_0 T) e^{-\\mu T}$\n    否则，使用通用公式：\n    $R(T) = R_0 e^{-\\mu T} + \\frac{\\alpha S_0}{\\mu - \\lambda} (e^{-\\lambda T} - e^{-\\mu T})$\n3.  如果 $\\lambda  \\epsilon$，则 $D(T) = 0$ 且 $C(T) = 0$。\n    否则：\n    $D(T) = \\frac{\\delta S_0}{\\lambda} (1 - e^{-\\lambda T})$\n    $C(T) = \\frac{\\alpha S_0}{\\lambda} (1 - e^{-\\lambda T})$\n\n我们现在将实现这些公式来解决所提供的测试案例。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the system of ODEs for T cell population dynamics for a suite of test cases.\n    \"\"\"\n\n    # Each tuple is (S0, R0, delta, alpha, mu, T)\n    test_cases = [\n        # Case A (general non-degenerate)\n        (100000, 0, 0.2, 0.1, 0.05, 14),\n        # Case B (no conversion)\n        (20000, 1000, 0.3, 0, 0.1, 10),\n        # Case C (no deletion)\n        (50000, 0, 0, 0.2, 0.1, 7),\n        # Case D (no Treg loss)\n        (1000, 0, 0.05, 0.15, 0, 30),\n        # Case E (matched loss and total exit rates)\n        (10000, 100, 0.2, 0.3, 0.5, 5),\n        # Case F (initial-time boundary)\n        (12345, 67, 0.1, 0.2, 0.3, 0)\n    ]\n\n    all_results = []\n    \n    # Small tolerance for floating point comparisons\n    TOLERANCE = 1e-9\n\n    for case in test_cases:\n        s0, r0, delta, alpha, mu, T = case\n        \n        # Total exit rate for conventional T cells\n        lambda_rate = delta + alpha\n\n        # Calculate S(T)\n        # S(t) = S0 * exp(-(delta + alpha) * t)\n        s_T = s0 * np.exp(-lambda_rate * T)\n\n        # Calculate R(T)\n        # Handle the special case where mu == lambda_rate\n        if abs(mu - lambda_rate)  TOLERANCE:\n            # R(t) = (R0 + alpha * S0 * t) * exp(-mu * t)\n            r_T = (r0 + alpha * s0 * T) * np.exp(-mu * T)\n        else:\n            # R(t) = R0*exp(-mu*t) + (alpha*S0)/(mu - lambda)*(exp(-lambda*t) - exp(-mu*t))\n            term1 = r0 * np.exp(-mu * T)\n            term2 = (alpha * s0) / (mu - lambda_rate) * (np.exp(-lambda_rate * T) - np.exp(-mu * T))\n            r_T = term1 + term2\n\n        # Calculate D(T) and C(T)\n        # Handle the case where lambda_rate is zero\n        if abs(lambda_rate)  TOLERANCE:\n            # If delta + alpha = 0, then S(t)=S0, but delta=0 and alpha=0, so D(T)=0, C(T)=0\n            d_T = 0.0\n            c_T = 0.0\n        else:\n            common_term = s0 / lambda_rate * (1 - np.exp(-lambda_rate * T))\n            # D(T) = delta * integral(S(t) dt)\n            d_T = delta * common_term\n            # C(T) = alpha * integral(S(t) dt)\n            c_T = alpha * common_term\n\n        # Append the quadruple of results for this case\n        all_results.extend([s_T, r_T, d_T, c_T])\n\n    # Format the final output string as specified\n    # print(f\"[{','.join(map(str, all_results))}]\")\n    return all_results\n\n# Execute and store the result\nfinal_output = solve()\n```", "answer": "```\n[1652.9888822158655,13333.310636838382,65564.67407856276,32782.33703928138,995.3439401777263,49.82987113110593,19004.656059822273,0.0,13533.52832366127,24935.53232007425,0.0,36466.47167633873,0.01831563888873418,999.9816843611112,499.99084218055565,1499.9725265416668,67.3678794411762,6044.881477793822,13326.90137412239,19990.352061183584,12345.0,67.0,0.0,0.0]\n```", "id": "5016553"}]}