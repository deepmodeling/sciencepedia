{"hands_on_practices": [{"introduction": "本章的第一个实践将建立累积发病率的基本概念，这是衡量特定时间内人群风险的最直接指标。通过在一个理想化的封闭队列中进行计算，我们将巩固其作为比例和概率的理解。这项练习是掌握后续更复杂分析的基础 [@problem_id:4992911]。", "problem": "我们建立了一个转化队列研究，旨在为一项关于生物标志物靶向预防策略的早期临床决策提供信息。一个由$200$名个体组成的封闭队列，所有成员在基线时均确认无病，被随访了$6$个月。随访是完整的，没有竞争风险或失访。在这$6$个月的期间内，有$8$名个体患上了目标疾病。请仅使用累积发病率的基本定义，计算该队列的$6$个月累积发病率(CI)，并将其解释为：在该研究条件下，从该基线无病队列中随机选择一名成员，在$6$个月内患病的概率。请将您的$CI$数值答案表示为小数，并四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题的根本基础是在完整随访的封闭队列中累积发病率的定义。在固定时间间隔内的累积发病率是指，在该时间间隔内，初始无病个体中成为新发病例的比例。形式上，对于一个在时间间隔内没有删失或竞争风险的封闭队列，累积发病率为\n$$\nCI(t) \\equiv \\Pr(T \\le t) = \\frac{\\text{number of incident cases in }[0,t]}{\\text{number at risk at }t=0}.\n$$\n此处，队列是封闭的，所有$200$名个体在基线时均无病，随访完整持续$6$个月，在$t = 6$个月内有$8$例新发病例。因此，\n$$\nCI(6\\ \\text{months}) = \\frac{8}{200}.\n$$\n计算该比率：\n$$\n\\frac{8}{200} = 0.04.\n$$\n四舍五入到四位有效数字，得到$0.04000$。\n\n作为概率的解释：在这些条件下（封闭队列、完整随访、无竞争风险），$6$个月的累积发病率$CI(6\\ \\text{months}) = 0.04000$是对此基线无病队列中随机选择的一名成员在$6$个月内患病的概率的估计。这对应于频率学派的解释，即在队列具有可交换性和同质性的前提下，如果我们在此类相同条件下重复抽样这样的队列，到$6$个月时患病的比例将收敛于这个概率。对于封闭队列中的这个比例，不需要假设风险恒定；在给定完整随访的情况下，对于这个队列在指定时间间隔内的估计是精确的。", "answer": "$$\\boxed{0.04000}$$", "id": "4992911"}, {"introduction": "现实世界中的队列研究很少能实现完全的随访；患者常常会因各种原因失访，其数据被视为“右删失”（right-censoring）。本练习将介绍 Kaplan-Meier 方法，这是一种重要的生存分析技术，通过恰当处理删失数据来正确估计累积发病率。通过与忽略删失的朴素计算方法进行对比，本练习突显了由此产生的偏倚 [@problem_id:4992924]。", "problem": "一项转化医学队列研究在基线时招募了一组单臂患者，以评估直至复合临床恶化终点事件发生的时间。所有患者在时间 $0$ 年时开始随访。假设右删失是独立的、非信息性的，不存在竞争风险，并且事件时间与删失时间之间没有重复值。观测到的事件时间（单位：年）为 $0.6$、$0.9$、$1.3$、$1.7$、$2.1$、$2.3$、$2.8$、$3.2$ 和 $3.6$。观测到的右删失时间（单位：年）为 $1.0$、$1.5$、$2.0$、$2.5$、$2.7$、$3.0$、$3.4$、$3.8$ 和 $4.0$。因此，在 $N=18$ 名患者中，有 $9$ 例事件和 $9$ 例删失。\n\n仅使用生存函数 $S(t)=\\Pr(T>t)$ 的基本定义和在存在右删失情况下估计 $S(t)$ 的乘积极限法（Kaplan–Meier），通过正确处理删失来计算 $3$ 年累积发生率 $1-\\widehat{S}(3)$。另外，计算忽略删失的朴素累积发生率，其定义为到 $3$ 年时发生事件的患者占总患者 $N$ 的比例。\n\n最后，以小数形式报告这两个估计值之间的差值 $\\Delta$，其定义为\n$\\Delta = \\left(1-\\widehat{S}(3)\\right) - \\left(\\text{3年时的朴素累积发生率}\\right)$。\n将最终报告的 $\\Delta$ 值四舍五入至四位有效数字。不要使用百分号。", "solution": "该问题表述清晰且科学合理，基于生物统计学中生存分析的既定原则。所有必要的数据和定义均已提供。\n\n主要目标是计算并比较临床终点事件的 $3$ 年累积发生率的两种估计。第一种估计使用 Kaplan-Meier 乘积极限法正确处理了右删失。第二种是忽略删失的朴素估计。\n\n首先，我们计算生存函数的 Kaplan-Meier 估计值 $\\widehat{S}(t)$。生存函数 $S(t)$ 是指事件发生时间 $T$ 大于某个时间 $t$ 的概率，即 $S(t) = \\Pr(T>t)$。$S(t)$ 的 Kaplan-Meier 估计量由乘积极限公式给出：\n$$\n\\widehat{S}(t) = \\prod_{i: t_i \\le t} \\left(1 - \\frac{d_i}{n_i}\\right)\n$$\n其中 $t_i$ 是不同的事件时间，$d_i$ 是在时间 $t_i$ 发生的事件数，而 $n_i$ 是在时间 $t_i$ 之前处于风险中的个体数（即存活且尚未被删失的个体数）。\n\n研究开始时的总患者数为 $N=18$。我们必须构建一个事件和删失的时间轴，以确定每个事件时间点的风险人数 $n_i$。观测到的事件时间（年）为 {$0.6, 0.9, 1.3, 1.7, 2.1, 2.3, 2.8, 3.2, 3.6$}。观测到的删失时间为 {$1.0, 1.5, 2.0, 2.5, 2.7, 3.0, 3.4, 3.8, 4.0$}。由于没有重复值，每个事件时间的事件数 $d_i=1$。\n\n我们需要计算 $\\widehat{S}(3)$，即存活超过 $3$ 年的估计概率。Kaplan-Meier 估计是一个阶梯函数，其值仅在事件发生时改变。因此，我们需要考虑在时间 $t=3$ 或之前发生的所有事件。这些事件时间是 $0.6, 0.9, 1.3, 1.7, 2.1, 2.3,$ 和 $2.8$。\n\n让我们确定每个事件时间的风险人数 $n_i$：\n- 在 $t=0$ 时，风险人数为 $n_0 = 18$。\n- 在事件时间 $t_1=0.6$：风险人数为 $n_1=18$。发生一个事件 ($d_1=1$)。剩余人数为 $17$。\n- 在事件时间 $t_2=0.9$：风险人数为 $n_2=17$。发生一个事件 ($d_2=1$)。剩余人数为 $16$。\n- 在删失时间 $t=1.0$：一名患者被删失。风险人数变为 $15$。\n- 在事件时间 $t_3=1.3$：风险人数为 $n_3=15$。发生一个事件 ($d_3=1$)。剩余人数为 $14$。\n- 在删失时间 $t=1.5$：一名患者被删失。风险人数变为 $13$。\n- 在事件时间 $t_4=1.7$：风险人数为 $n_4=13$。发生一个事件 ($d_4=1$)。剩余人数为 $12$。\n- 在删失时间 $t=2.0$：一名患者被删失。风险人数变为 $11$。\n- 在事件时间 $t_5=2.1$：风险人数为 $n_5=11$。发生一个事件 ($d_5=1$)。剩余人数为 $10$。\n- 在事件时间 $t_6=2.3$：风险人数为 $n_6=10$。发生一个事件 ($d_6=1$)。剩余人数为 $9$。\n- 在删失时间 $t=2.5$：一名患者被删失。风险人数变为 $8$。\n- 在删失时间 $t=2.7$：一名患者被删失。风险人数变为 $7$。\n- 在事件时间 $t_7=2.8$：风险人数为 $n_7=7$。发生一个事件 ($d_7=1$)。剩余人数为 $6$。\n- 在删失时间 $t=3.0$：一名患者被删失。风险人数变为 $5$。\n\nKaplan-Meier 估计值 $\\widehat{S}(3)$ 是在 $t=3$ 或之前发生的最后一个事件（即 $t=2.8$）之后的生存函数值。\n$$\n\\widehat{S}(3) = \\widehat{S}(2.8) = \\prod_{i=1}^{7} \\left(1 - \\frac{d_i}{n_i}\\right)\n$$\n由于所有 $i$ 的 $d_i=1$：\n$$\n\\widehat{S}(3) = \\left(1 - \\frac{1}{18}\\right) \\left(1 - \\frac{1}{17}\\right) \\left(1 - \\frac{1}{15}\\right) \\left(1 - \\frac{1}{13}\\right) \\left(1 - \\frac{1}{11}\\right) \\left(1 - \\frac{1}{10}\\right) \\left(1 - \\frac{1}{7}\\right)\n$$\n$$\n\\widehat{S}(3) = \\frac{17}{18} \\times \\frac{16}{17} \\times \\frac{14}{15} \\times \\frac{12}{13} \\times \\frac{10}{11} \\times \\frac{9}{10} \\times \\frac{6}{7}\n$$\n许多项可以消掉：\n$$\n\\widehat{S}(3) = \\frac{\\cancel{17}}{18} \\times \\frac{16}{\\cancel{17}} \\times \\frac{14}{15} \\times \\frac{12}{13} \\times \\frac{\\cancel{10}}{11} \\times \\frac{9}{\\cancel{10}} \\times \\frac{6}{7} = \\frac{16 \\times 14 \\times 12 \\times 9 \\times 6}{18 \\times 15 \\times 13 \\times 11 \\times 7}\n$$\n我们通过因式分解来简化：\n$$\n\\widehat{S}(3) = \\frac{16 \\times (2 \\times 7) \\times 12 \\times 9 \\times 6}{(2 \\times 9) \\times 15 \\times 13 \\times 11 \\times 7} = \\frac{16 \\times 12 \\times 6}{15 \\times 13 \\times 11}\n$$\n$$\n\\widehat{S}(3) = \\frac{16 \\times (3 \\times 4) \\times (2 \\times 3)}{(3 \\times 5) \\times 13 \\times 11} = \\frac{16 \\times 4 \\times 2 \\times 3}{5 \\times 13 \\times 11} = \\frac{384}{715}\n$$\n正确估计的 $3$ 年累积发生率为 $1 - \\widehat{S}(3)$：\n$$\n1 - \\widehat{S}(3) = 1 - \\frac{384}{715} = \\frac{715 - 384}{715} = \\frac{331}{715}\n$$\n转换成小数，这大约是 $0.462937$。\n\n接下来，我们计算忽略删失的朴素累积发生率。这被定义为在时间 $t=3$ 之前发生事件的患者占总样本 $N=18$ 的比例。事件时间为 {$0.6, 0.9, 1.3, 1.7, 2.1, 2.3, 2.8, 3.2, 3.6$}。在 $t=3$ 或之前发生的事件数量为 $7$。\n因此，朴素累积发生率为：\n$$\n\\text{朴素累积发生率} = \\frac{7}{18}\n$$\n转换成小数，这大约是 $0.388889$。这种方法错误地将被删失的个体视为完成了 $3$ 年随访且未发生事件，从而低估了真实的发生率。\n\n最后，我们计算差值 $\\Delta$：\n$$\n\\Delta = \\left(1 - \\widehat{S}(3)\\right) - \\left(\\text{朴素累积发生率}\\right)\n$$\n$$\n\\Delta = \\frac{331}{715} - \\frac{7}{18}\n$$\n为了进行分数相减，我们找到一个公分母，即 $715 \\times 18 = 12870$。\n$$\n\\Delta = \\frac{331 \\times 18}{12870} - \\frac{7 \\times 715}{12870} = \\frac{5958 - 5005}{12870} = \\frac{953}{12870}\n$$\n现在，我们将这个分数转换为小数：\n$$\n\\Delta \\approx 0.074048174...\n$$\n题目要求将此值四舍五入到四位有效数字。第一位有效数字是 $7$，第二位是 $4$，第三位是 $0$，第四位是 $4$。第五位有效数字是 $8$，大于等于 $5$，所以我们将第四位有效数字向上取整。\n$$\n\\Delta \\approx 0.07405\n$$\n$\\Delta$ 的正值证实了朴素方法通过忽略被删失受试者减少的随访时间，与更合适的 Kaplan-Meier 方法相比，低估了累积发生率。", "answer": "$$\\boxed{0.07405}$$", "id": "4992924"}, {"introduction": "比较不同人群的疾病率是流行病学的核心任务，但年龄等人口结构的差异可能会产生误导性的结论，这种现象被称为“混杂”。这个实践将演示直接标准化法，这是一种通过对混杂变量（如年龄）进行校正，从而在人群之间进行公平比较的关键方法。这项练习展示了如何从原始数据中获得更准确的见解 [@problem_id:4992983]。", "problem": "一个转化医学团队正在比较两个卫生系统（人群 $A$ 和人群 $B$）中一种成年发病疾病的负担，这两个人群的年龄构成有显著差异。对于四个成年人年龄分层：$20$–$39$岁、$40$–$59$岁、$60$–$79$岁和$\\geq 80$岁，年龄别发病率以每$100{,}000$人年为单位进行测量。人群 $A$ 的年龄别发病率如下：$20$–$39$岁：$8$，$40$–$59$岁：$42$，$60$–$79$岁：$180$，$\\geq 80$岁：$420$。人群 $B$ 的年龄别发病率如下：$20$–$39$岁：$14$，$40$–$59$岁：$50$，$60$–$79$岁：$160$，$\\geq 80$岁：$350$。\n\n为了消除年龄造成的混杂并进行公平比较，请使用以下世界卫生组织（WHO）成年人标准年龄分布（各项比例总和为$1$）进行直接标准化：$20$–$39$岁：$0.52$，$40$–$59$岁：$0.28$，$60$–$79$岁：$0.16$，$\\geq 80$岁：$0.04$。\n\n此外，观察到的成年人年龄分布如下：人群 $A$ 的比例：$20$–$39$岁：$0.40$，$40$–$59$岁：$0.28$，$60$–$79$岁：$0.22$，$\\geq 80$岁：$0.10$；人群 $B$ 的比例：$20$–$39$岁：$0.58$，$40$–$59$岁：$0.26$，$60$–$79$岁：$0.12$，$\\geq 80$岁：$0.04$。\n\n使用提供的WHO标准年龄分布，计算人群 $A$ 和人群 $B$ 的直接标准化发病率。将两个最终率以每$100{,}000$人年为单位表示。将你的答案四舍五入至四位有效数字。然后，根据你的计算，解释年龄结构差异对人群 $A$ 和人群 $B$ 之间粗略比较的影响。", "solution": "目标是计算人群 $A$ 和人群 $B$ 的直接标准化发病率，通过消除年龄的混杂效应来进行公平比较。直接标准化通过计算每个研究人群在具有相同、共同的年龄结构（此处提供的是WHO标准人群）时所观察到的总发病率来实现这一目标。\n\n直接标准化率（DSR）的公式是研究人群的年龄别发病率 ($r_i$)与标准人群在每个年龄分层 $i$ 中的比例 ($w_i^{std}$) 的乘积之和：\n$$\nDSR = \\sum_{i} r_i \\cdot w_i^{std}\n$$\n\n让我们计算人群 $A$ 的DSR，记为 $DSR_A$。年龄分层从 $i=1$ 到 $4$ 进行索引。人群 $A$ 的年龄别发病率为 $r_{A,i} = \\{8, 42, 180, 420\\}$，标准人群权重为 $w_i^{std} = \\{0.52, 0.28, 0.16, 0.04\\}$。\n$$\nDSR_A = \\sum_{i=1}^{4} r_{A,i} \\cdot w_i^{std}\n$$\n$$\nDSR_A = (8 \\times 0.52) + (42 \\times 0.28) + (180 \\times 0.16) + (420 \\times 0.04)\n$$\n$$\nDSR_A = 4.16 + 11.76 + 28.8 + 16.8\n$$\n$$\nDSR_A = 61.52\n$$\n人群 $A$ 的直接标准化率为每$100{,}000$人年$61.52$。\n\n接下来，我们计算人群 $B$ 的DSR，记为 $DSR_B$。人群 $B$ 的年龄别发病率为 $r_{B,i} = \\{14, 50, 160, 350\\}$，标准人群权重相同。\n$$\nDSR_B = \\sum_{i=1}^{4} r_{B,i} \\cdot w_i^{std}\n$$\n$$\nDSR_B = (14 \\times 0.52) + (50 \\times 0.28) + (160 \\times 0.16) + (350 \\times 0.04)\n$$\n$$\nDSR_B = 7.28 + 14.0 + 25.6 + 14.0\n$$\n$$\nDSR_B = 60.88\n$$\n人群 $B$ 的直接标准化率为每$100{,}000$人年$60.88$。\n\n问题要求将结果四舍五入至四位有效数字。$61.52$ 和 $60.88$ 都已经是以四位有效数字呈现的。\n\n为了解释年龄结构的影响，我们必须首先比较粗发病率。粗率是使用各个人群观察到的年龄分布计算得出的。\n人群 $A$ 的粗率 ($CR_A$) 为：\n$$\nCR_A = \\sum_{i=1}^{4} r_{A,i} \\cdot w_{A,i}^{obs} = (8 \\times 0.40) + (42 \\times 0.28) + (180 \\times 0.22) + (420 \\times 0.10)\n$$\n$$\nCR_A = 3.2 + 11.76 + 39.6 + 42.0 = 96.56\n$$\n人群 $B$ 的粗率 ($CR_B$) 为：\n$$\nCR_B = \\sum_{i=1}^{4} r_{B,i} \\cdot w_{B,i}^{obs} = (14 \\times 0.58) + (50 \\times 0.26) + (160 \\times 0.12) + (350 \\times 0.04)\n$$\n$$\nCR_B = 8.12 + 13.0 + 19.2 + 14.0 = 54.32\n$$\n人群 $A$ 的粗发病率（每$100{,}000$人年$96.56$）显著高于人群 $B$（每$100{,}000$人年$54.32$）。这种简单的比较表明，人群 $A$ 中该疾病的风险要大得多。\n\n然而，这两个人群的年龄结构不同。人群 $A$ 比人群 $B$ 年龄更大。在人群 $A$ 中，$60$岁及以上人口的比例为 $0.22 + 0.10 = 0.32$（即$32\\%$），而在人群 $B$ 中，这一比例仅为 $0.12 + 0.04 = 0.16$（即$16\\%$）。由于该疾病的发病率随年龄急剧上升（例如，在人群 $A$ 的最高年龄层中为$180$和$420$），人群 $A$ 较老的年龄结构抬高了其粗率。这种现象被称为年龄混杂。\n\n直接标准化率校正了这种混杂。标准化率 $DSR_A = 61.52$ 和 $DSR_B = 60.88$（每$100{,}000$人年）几乎相同。这表明，如果两个人群具有相同的年龄结构，它们的总发病率将会非常相似。\n\n因此，解释是，在粗率中观察到的巨大差异是由年龄混杂造成的一种假象。人群 $A$ 中老年人（风险最高的群体）的比例更高，这人为地抬高了其粗率。在对年龄分布的这种差异进行调整后，两个人群发生该疾病的潜在风险几乎相同。粗略的比较具有误导性，而标准化比较则更准确地反映了人群层面的风险。", "answer": "$$\n\\boxed{\\begin{pmatrix} 61.52  60.88 \\end{pmatrix}}\n$$", "id": "4992983"}]}