{"hands_on_practices": [{"introduction": "数据完整性是所有GxP法规（GLP、GCP、GMP）的基石，确保了药品全生命周期中数据的可靠性。本练习 [@problem_id:5018786] 将您置于一个真实的GMP场景中，即发现并需要处理一个关键文件记录的遗漏。您需要运用ALCOA+的基本原则（可追溯、清晰、同步、原始、准确），学习合规地纠正批记录的方法，从而掌握维护数据完整性和进行可追溯、有理有据的文件记录的核心技能。", "problem": "一家遵循良好生产规范 (GMP) 的制药商在日期 $2025$-$04$-$14$ 时间 $t_2$ 进行质量保证 (QA) 批准前审核时发现，原料药 (API) 批号 $\\mathrm{X}$ 的批生产记录 (BPR) 中存在两处遗漏，这些遗漏源于日期 $2025$-$04$-$12$ 时间 $t_1$ 的一次操作：步骤 $S_3$（添加原料 $\\mathrm{B}$）的重量条目为空，且该步骤的操作员签名/时间字段也为空。该工厂使用一台带审计追踪功能、经过校准的受控电子天平；仪器日志显示，在时间 $t_1$ 有一次对原料 $\\mathrm{B}$（批号 $\\mathrm{B123}$）的称重事件，读数为 $502.3\\,\\mathrm{g}$，操作员ID为 $\\mathrm{OP17}$，仪器ID为 $\\mathrm{BAL\\text{-}07}$，并且有一份安全打印件存储在受控档案中。主批记录规定 $\\mathrm{B}$ 的标称添加量为 $500.0\\,\\mathrm{g}$，允许公差为 $\\pm 1.0\\%$。BPR中其他地方记录的最终批次收率为 $998.0\\,\\mathrm{g}$，这在历史工艺能力限度之内。\n\n在转化医学中，连接临床前和临床应用要求生产数据在整个流程中都可信，并且符合数据完整性和良好文件规范 (GDP)。与文件相关的基本原则包括可归属、清晰、同步、原始、准确 (ALCOA) 标准（以及ALCOA+的扩展，如完整和一致），以及GMP中的首要要求，即更正必须保留原始记录不得涂抹，必须可追溯，并且必须有正当理由。良好实验室规范 (GLP) 和良好临床规范 (GCP) 也要求源数据的完整性和可追溯性，但当前情景涉及的是GMP执行记录。任何条目都不得追溯日期。\n\n下面哪个选项代表了针对BPR中遗漏条目的最合规的纠正性文件策略，该策略在不追溯日期的情况下保持数据完整性，同时能够对批次做出可辩护的处置，并采取预防措施以减少再次发生？\n\nA. 在时间 $t_2$ 时，在原始BPR中对步骤 $S_3$ 的重量和操作员字段进行一次同步的“延迟录入”，使用受控的天平打印件和审计追踪作为来源，并附上清晰的注释，说明“延迟录入”、遗漏原因、当前日期和时间以及签名缩写；交叉引用并附上仪器的受控打印件副本；开启一份偏差报告和一份纠正和预防措施 (CAPA) 以解决根本原因；确保原始空白处不被涂抹；包含一份影响评估，引用主批记录公差 $\\pm 1.0\\%$ 以及与记录的 $998.0\\,\\mathrm{g}$ 收率的一致性。\n\nB. 在原始BPR中填入遗漏的重量和操作员字段，但将条目日期追溯至 $t_1$ 以保持时间顺序，添加主管复签，并注明该值与主批记录规定的标称值 $500.0\\,\\mathrm{g}$ 相符。\n\nC. 将整个受影响的BPR页面抄录到一份新生成的受控副本中，替换批记录文件中的原始页面，并丢弃原始页面；使用 $502.3\\,\\mathrm{g}$ 的值填入遗漏的重量和操作员字段，并在原始行上签名。\n\nD. 根据记录的 $998.0\\,\\mathrm{g}$ 最终收率和配方化学计量来估算遗漏的重量，将估算值填入BPR，标记为“估算值”，并将条目日期追溯至 $t_1$ 以与过程执行时间保持一致；在文件中添加一份备忘录来解释估算过程。\n\nE. 用铅笔将遗漏的重量填入原始BPR，之后用墨水描摹；省略当前日期和时间以避免混淆，但附上一份描述天平读数和操作员身份的执行后非受控备忘录。\n\n选择唯一的最佳选项。", "solution": "该问题要求根据良好生产规范 (GMP)、良好文件规范 (GDP) 和数据完整性的第一性原理进行推理，特别是可归属、清晰、同步、原始、准确 (ALCOA) 标准及其扩展。根据GMP，批记录是生产的主要证据，必须完整、同步和可追溯。当在执行后发现遗漏时，纠正性文件必须保留原始记录（原始性），可归因于特定人员（可归属性），清晰可读（清晰性），记录更正的实际日期和时间（与更正同步，而非虚假地与原始执行同步），并且准确，由原始源数据支持（准确性），同时保持完整性和一致性（完整性、一致性）。禁止追溯日期源于“同步性”标准、对真实时间戳的要求，以及对可追溯性/审计追踪完整性的要求。\n\n我们考虑以下基本依据：\n\n- 良好生产规范 (GMP) 要求生产记录完整，并且更正时必须保留原始信息，不得遮盖，并且可追溯到更正的人员和时间。这包括在适用时使用单线划掉、注明更改原因的注释以及当前的日期/时间和签名缩写。\n\n- ALCOA原则：可归属性意味着条目可追溯到个人；清晰性意味着可读且永久；同步性意味着在活动发生时记录，当更正延迟录入时，应在进行更正时记录，而不是追溯日期；原始性意味着保留原始数据和来源；准确性意味着条目反映真实值，并由受控的源文件支持。\n\n- 良好文件规范包括不涂抹原始信息、使用不易擦除的墨水、禁止使用铅笔，以及链接到受控的源文件而非非受控的备忘录。\n\n鉴于此情景，在时间 $t_1$ 有一份关于原料 $\\mathrm{B}$（批号 $\\mathrm{B123}$）的受控仪器打印件，显示重量为 $502.3\\,\\mathrm{g}$，操作员ID为 $\\mathrm{OP17}$。主批记录的标称值为 $500.0\\,\\mathrm{g}$，公差为 $\\pm 1.0\\%$，因此可接受的范围是：\n$$500.0\\,\\mathrm{g} \\times (1 \\pm 0.01) = [495.0\\,\\mathrm{g},\\,505.0\\,\\mathrm{g}]$$\n仪器读数 $502.3\\,\\mathrm{g}$ 位于 $[495.0\\,\\mathrm{g},\\,505.0\\,\\mathrm{g}]$ 范围内，因此，从GMP的角度来看，该值在技术上是可接受的。最终收率 $998.0\\,\\mathrm{g}$ 被注意到在历史工艺能力范围内，这支持了观察到的重量并不表示工艺失败的观点。然而，主要问题是文件完整性，而不是收率计算。\n\n现在我们分析每个选项：\n\n选项A：该选项建议在时间 $t_2$ 于原始BPR中进行一次同步的“延迟录入”，清楚地注释为“延迟录入”，并说明遗漏原因、当前日期和时间以及签名缩写（满足可归属性和同步性），并使用受控的天平打印件和审计追踪作为来源（满足原始性和准确性）。它包括交叉引用并附上受控的打印件（保持对原始数据的可追溯性），开启一份偏差报告和一份纠正和预防措施 (CAPA)（符合GMP调查根本原因和防止再次发生的期望），保留原始空白（不涂抹），并提供一份影响评估，该评估引用主批记录公差 $\\pm 1.0\\%$ 和与 $998.0\\,\\mathrm{g}$ 收率的一致性（为批次处置理由提供支持）。这与ALCOA(+)、GDP和GMP一致。没有发生追溯日期；更正是完全透明且有正当理由的。结论 — 正确。\n\n选项B：该选项建议将条目日期追溯至 $t_1$ 以保持时间顺序，并添加主管复签。追溯日期违反了“同步性”标准和数据完整性，因为它错误地陈述了记录的实际时间。主管复签无法纠正根本性的错误时间归属。它还暗示使用标称值 $500.0\\,\\mathrm{g}$ 而不是受控的来源读数 $502.3\\,\\mathrm{g}$，如果仪器记录不支持，这将与“准确性”和“原始性”相矛盾。结论 — 错误。\n\n选项C：该选项要求将整个页面抄录到一份新的受控副本中，替换并丢弃原始页面。这违反了“原始性”标准，因为它移除了原始记录，削弱了可追溯性和可审计性；GMP更正必须保留原始记录。即使新页面包含 $502.3\\,\\mathrm{g}$，根据GDP，替换和丢弃原始页面是不可接受的，因为GDP禁止涂抹或移除已执行的记录。结论 — 错误。\n\n选项D：该选项建议根据最终收率和配方化学计量来估算遗漏的重量，标记为“估算值”，并追溯日期至 $t_1$。当存在受控的仪器记录时，估算不受控的源数据支持；这违反了“准确性”和“原始性”。追溯日期违反了“同步性”。因此，即使有解释性备忘录，这也未能遵循ALCOA和GDP。结论 — 错误。\n\n选项E：该选项使用铅笔，之后用墨水描摹，省略当前日期/时间，并附上一份非受控的备忘录。根据GDP，铅笔是禁止使用的，因为它不是永久性的且可以被更改；省略当前日期/时间违反了“同步性”和“可归属性”；非受控的备忘录不提供受控的来源追溯。这未能遵循ALCOA和GMP。结论 — 错误。\n\n因此，唯一遵守GMP、ALCOA(+)和GDP，并明确避免追溯日期，同时保留原始记录并提供可辩护的理由和预防措施的选项是选项A。", "answer": "$$\\boxed{A}$$", "id": "5018786"}, {"introduction": "从数据原则转向实际应用，有效的过程控制是GMP的核心要求。本练习 [@problem_id:5018835] 深入探讨了物料平衡核算，这是监控生产效率和识别潜在工艺问题的基本工具。您不仅需要计算收率和损失等关键绩效指标，还将学习如何整合测量不确定度，以建立一个科学上稳健的统计标准，用于决定何时需要对工艺损失展开调查。", "problem": "某个申办方的一项无菌注射剂灌装与完成工序遵循了药品生产质量管理规范 (GMP)、药物非临床研究质量管理规范 (GLP) 和药物临床试验质量管理规范 (GCP) 的基本原则。在当前审查的工步中，必须根据质量守恒定律和有文件记录的计量学对批次物料平衡进行衡算，并且任何收率损失都必须根据一个考虑了测量不确定度的合理决策标准进行评估。\n\n现提供在经过校准和验证的测量系统下收集的以下数据，每个系统都有记录在案的标准不确定度（假设其代表一个标准差）。所有测量都是独立的。\n\n- 进入灌装机的总进料质量：$M_{\\mathrm{in}} = 52{,}600$ g，标准不确定度 $u_{\\mathrm{in}} = 25$ g。\n- 合格、放行产品的总质量：$M_{\\mathrm{good}} = 49{,}800$ g，标准不确定度 $u_{\\mathrm{good}} = 20$ g。\n- 可衡算的废料质量由三个独立测量的部分组成：\n  1. 生产线预冲洗和过滤器截留量：$M_{1} = 1{,}100$ g，标准不确定度 $u_{1} = 15$ g。\n  2. 剔除品（汇总）：$M_{2} = 1{,}020$ g，标准不确定度 $u_{2} = 12$ g。\n  3. 收集的溢出物和擦拭物：$M_{3} = 430$ g，标准不确定度 $u_{3} = 10$ g。\n\n以质量守恒定律和独立量的标准不确定度传播为基本依据，完成以下任务：\n\n1. 计算工步收率，以小数形式表示，其定义为 $y = M_{\\mathrm{good}} / M_{\\mathrm{in}}$。将 $y$ 表示为小数（不要使用百分号）。\n2. 计算可衡算的总废料质量 $M_{\\mathrm{scrap}}$ 和由 $M_{\\mathrm{in}} = M_{\\mathrm{good}} + M_{\\mathrm{scrap}} + U$ 定义的不可衡算损失 $U$。\n3. 计算与 $U$ 相关的合成标准不确定度 $u_{c}$。\n4. 假设测量误差近似服从正态分布且相互独立，定义一个基于 0.95 双侧置信水平的决策标准以调查收率损失。然后，计算标准化决策分数 $S = U / u_{c}$。\n\n将最终报告的 $S$ 值四舍五入到四位有效数字。最终答案应表示为单个无量纲值。不应将其他任何输出作为最终答案报告。", "solution": "分析始于质量守恒定律和不确定度的计量学处理。质量守恒定律规定，总输入等于所有输出和损失之和：\n$$\nM_{\\mathrm{in}} = M_{\\mathrm{good}} + M_{\\mathrm{scrap}} + U,\n$$\n其中 $U$ 是从输入中减去测得的合格产出和可衡算的废料后剩余的不可衡算损失（或增益）。\n\n步骤1：计算工步收率，以小数形式表示。\n根据定义，\n$$\ny = \\frac{M_{\\mathrm{good}}}{M_{\\mathrm{in}}}.\n$$\n代入所提供的值，\n$$\ny = \\frac{49{,}800}{52{,}600} = \\frac{249}{263} \\approx 0.94677.\n$$\n这就是以小数形式表示的工步收率。\n\n步骤2：计算可衡算的总废料质量和不可衡算的损失。\n可衡算的废料质量是各独立测量部分的总和：\n$$\nM_{\\mathrm{scrap}} = M_{1} + M_{2} + M_{3} = 1{,}100 + 1{,}020 + 430 = 2{,}550 \\text{ g}.\n$$\n因此，不可衡算的损失为\n$$\nU = M_{\\mathrm{in}} - M_{\\mathrm{good}} - M_{\\mathrm{scrap}} = 52{,}600 - 49{,}800 - 2{,}550 = 250 \\text{ g}.\n$$\n\n步骤3：计算与 $U$ 相关的合成标准不确定度。\n对于独立量，和或差的标准不确定度由各个标准不确定度的方和根给出。首先，计算可衡算废料的标准不确定度：\n$$\nu_{\\mathrm{scrap}} = \\sqrt{u_{1}^{2} + u_{2}^{2} + u_{3}^{2}} = \\sqrt{15^{2} + 12^{2} + 10^{2}} = \\sqrt{469}.\n$$\n然后，由于 $U = M_{\\mathrm{in}} - M_{\\mathrm{good}} - M_{\\mathrm{scrap}}$ 并且所有输入项都是独立的，\n$$\nu_{c} = \\sqrt{u_{\\mathrm{in}}^{2} + u_{\\mathrm{good}}^{2} + u_{\\mathrm{scrap}}^{2}} = \\sqrt{25^{2} + 20^{2} + \\left(\\sqrt{469}\\right)^{2}} = \\sqrt{625 + 400 + 469} = \\sqrt{1{,}494}.\n$$\n\n步骤4：定义决策标准并计算标准化决策分数。\n在测量误差近似服从正态分布且相互独立的假设下，0.95 的双侧置信水平对应于满足以下条件的临界值 $k$：\n$$\nP\\left(|Z| \\leq k\\right) = 0.95,\n$$\n其中 $Z$ 服从标准正态分布。对应的 $k$ 是标准正态分布的 0.975 分位数，即\n$$\nk \\approx 1.96.\n$$\n因此，一个合理的 GMP 决策标准是在以下情况启动调查：\n$$\n|U| > k \\, u_{c},\n$$\n等价于当标准化决策分数\n$$\nS = \\frac{U}{u_{c}}\n$$\n满足 $|S| > k$ 时。\n\n对 $S$ 进行数值计算：\n$$\nS = \\frac{250}{\\sqrt{1{,}494}}.\n$$\n计算分母：\n$$\n\\sqrt{1{,}494} \\approx 38.6497,\n$$\n因此\n$$\nS \\approx \\frac{250}{38.6497} \\approx 6.4677.\n$$\n四舍五入到四位有效数字，最终报告值为\n$$\nS \\approx 6.468.\n$$\n该分数远超 $k \\approx 1.96$，因此根据所定义的标准，收率损失需要进行调查。然而，根据说明，仅报告 $S$ 的单个无量纲值作为最终答案。", "answer": "$$\\boxed{6.468}$$", "id": "5018835"}, {"introduction": "药物从实验室到患者的转化之旅在临床试验中达到高潮，而临床试验由GCP规范，以确保患者安全和伦理合规。本练习 [@problem_id:5018825] 介绍经典的“3+3”剂量递增设计，这是早期肿瘤学试验的基石，旨在为后续研究确定安全剂量。通过解决这个问题，您将运用概率论原理来理解该设计的运行特性，并体会如何利用数学建模将安全性与风险管理直接融入临床方案中。", "problem": "一个转化医学项目正在计划一项首次人体肿瘤学研究，该研究遵循临床试验管理规范 (GCP)，利用根据药品非临床研究质量管理规范 (GLP) 进行的临床前毒理学研究，以及根据药品生产质量管理规范 (GMP) 进行的研究性产品放行。为满足患者安全的伦理和监管要求，该团队提出了一个标准的“3+3”剂量递增方案，包含四个预先设定的剂量水平，用 $j \\in \\{1,2,3,4\\}$ 索引。试验按如下方式进行，剂量限制性毒性 (DLT) 根据方案前瞻性定义：从剂量水平 $j=1$ 开始，在当前水平招募 $3$ 名患者，并在可能递增到 $j+1$ 之前应用以下规则：\n- 如果在给定剂量水平的前 $3$ 名患者中出现 $0$ 例 DLT，则递增至下一水平。\n- 如果在前 $3$ 名患者中恰好出现 $1$ 例 DLT，则将该水平的队列扩大至 $6$ 名患者；在总共观察 $6$ 名患者后：\n  - 如果这 $6$ 名患者中的 DLT 总数为 $1$，则递增至下一水平。\n  - 如果这 $6$ 名患者中的 DLT 总数至少为 $2$，则停止试验，并宣布前一水平为最大耐受剂量 (MTD)。\n- 如果在前 $3$ 名患者中出现至少 $2$ 例 DLT，则立即停止试验，并宣布前一水平为最大耐受剂量 (MTD)。\n- 在最高水平 $j=4$ 时，在该水平进行基于规则的评估后，无论结果如何，试验都将停止，因为无法再进行剂量递增。\n\n假设：\n- 每位患者独立地发生 DLT，其真实概率为 $p$，且在所有剂量水平上保持不变，这反映了一种保守的计划情景。\n- 队列按顺序招募，并严格按照上述规则做出决策。\n- 所有患者的结局都是参数为 $p$ 的独立同分布的伯努利随机变量。\n\n从独立伯努利试验和二项分布的概率第一性原理出发，推导试验在每个特定剂量水平 $j=1,2,3,4$ 停止的概率的解析表达式，该表达式是 $p$ 的函数。将最终答案表示为一个单行向量，其条目按 $\\{P(\\text{stop at }1), P(\\text{stop at }2), P(\\text{stop at }3), P(\\text{stop at }4)\\}$ 顺序排列，并以 $p$ 的封闭形式写出。不需要进行数值代入或四舍五入，概率必须表示为精确的解析表达式（小数或分数形式），不带百分号。", "solution": "问题要求推导“3+3”剂量递增试验在四个预先设定的剂量水平（用 $j \\in \\{1, 2, 3, 4\\}$ 索引）中的每一个水平停止的概率。问题的核心在于计算在任意给定剂量水平 $j  4$ 时发生的两类事件的概率：递增至水平 $j+1$ 或停止试验。这些概率取决于剂量限制性毒性 (DLT) 的真实恒定概率，记为 $p$。\n\n首先，我们定义在任意剂量水平 $j \\in \\{1, 2, 3\\}$（假设试验已达到此水平）时的事件及其概率。患者的结局是独立的伯努利试验，成功（发生 DLT）的概率为 $p$。在一个 $n$ 名患者的队列中，DLT 的数量 $D_n$ 服从二项分布，$D_n \\sim \\text{Binomial}(n, p)$，其概率质量函数为 $P(D_n=k) = \\binom{n}{k}p^k (1-p)^{n-k}$。\n\n我们将从水平 $j$ 递增到 $j+1$ 的事件表示为 $E$，在水平 $j$ 停止的事件表示为 $S$。递增和停止的规则如下：\n1.  如果在前 $3$ 名患者中观察到 $0$ 例 DLT，则递增。\n2.  如果在前 $3$ 名患者中观察到 $1$ 例 DLT，然后在额外的 $3$ 名患者中观察到 $0$ 例 DLT（即 $6$ 名患者中总共有 $1$ 例 DLT），则递增。\n3.  如果在前 $3$ 名患者中观察到 $\\ge 2$ 例 DLT，则停止。\n4.  如果在前 $3$ 名患者中观察到 $1$ 例 DLT，然后在额外的 $3$ 名患者中观察到 $\\ge 1$ 例 DLT（即 $6$ 名患者中总共有 $\\ge 2$ 例 DLT），则停止。\n\n递增的概率 $P_E$ 是两个互斥的递增情景的概率之和。\n设 $D_3$ 为第一个 $3$ 人队列中的 DLT 数量，$D'_3$ 为扩展的 $3$ 人队列中的 DLT 数量。\n\n情景1的概率（3名患者中0例DLT）：\n$$P(\\text{escalate via rule 1}) = P(D_3=0) = \\binom{3}{0}p^0(1-p)^{3-0} = (1-p)^3$$\n\n情景2的概率（前3名患者中1例DLT，接着后3名患者中0例DLT）：\n这是一个复合事件，由于独立性，我们将概率相乘。\n$$P(\\text{escalate via rule 2}) = P(D_3=1 \\text{ and } D'_3=0) = P(D_3=1) \\times P(D'_3=0)$$\n$$P(D_3=1) = \\binom{3}{1}p^1(1-p)^{3-1} = 3p(1-p)^2$$\n$$P(D'_3=0) = \\binom{3}{0}p^0(1-p)^{3-0} = (1-p)^3$$\n所以，概率是：\n$$P(\\text{escalate via rule 2}) = 3p(1-p)^2 \\cdot (1-p)^3 = 3p(1-p)^5$$\n\n从任意水平 $j4$ 递增的总概率 $P_E$ 是以下各项之和：\n$$P_E = P(D_3=0) + P(D_3=1 \\text{ and } D'_3=0) = (1-p)^3 + 3p(1-p)^5$$\n\n在水平 $j$ 停止的事件 $S$ 是从水平 $j$ 递增的互补事件。因此，其概率 $P_S$ 为：\n$$P_S = 1 - P_E = 1 - \\left( (1-p)^3 + 3p(1-p)^5 \\right)$$\n\n现在我们可以确定在每个特定水平停止的概率。设 $P(\\text{stop at } j)$ 为试验在剂量水平 $j$ 满足停止条件的概率。\n\n- **在水平 $j=1$ 停止的概率**：\n试验从水平 $j=1$ 开始。如果满足停止标准，试验将在此水平停止。这以概率 $P_S$ 发生。\n$$P(\\text{stop at } 1) = P_S = 1 - (1-p)^3 - 3p(1-p)^5$$\n\n- **在水平 $j=2$ 停止的概率**：\n要在水平 $j=2$ 停止，试验必须首先从水平 $j=1$ 递增，然后在水平 $j=2$ 停止。由于每个水平的结果是独立的（给定恒定的 $p$），我们将它们的概率相乘。\n$$P(\\text{stop at } 2) = P(\\text{escalate from } 1) \\times P(\\text{stop at } 2 | \\text{reached } 2) = P_E \\cdot P_S$$\n$$P(\\text{stop at } 2) = \\left((1-p)^3 + 3p(1-p)^5\\right) \\left(1 - (1-p)^3 - 3p(1-p)^5\\right)$$\n\n- **在水平 $j=3$ 停止的概率**：\n要在水平 $j=3$ 停止，试验必须从水平 $j=1$ 递增，再从水平 $j=2$ 递增，然后在水平 $j=3$ 停止。\n$$P(\\text{stop at } 3) = P_E \\times P_E \\times P_S = (P_E)^2 \\cdot P_S$$\n$$P(\\text{stop at } 3) = \\left((1-p)^3 + 3p(1-p)^5\\right)^2 \\left(1 - (1-p)^3 - 3p(1-p)^5\\right)$$\n\n- **在水平 $j=4$ 停止的概率**：\n问题指出，在水平 $j=4$ 时，无论结果如何，试验都会停止。这意味着“在水平4停止”的事件等同于“达到水平4”的事件。要达到水平 $j=4$，试验必须从水平 $j=1、2$ 和 $3$ 递增。\n$$P(\\text{stop at } 4) = P(\\text{reach } 4) = P_E \\times P_E \\times P_E = (P_E)^3$$\n$$P(\\text{stop at } 4) = \\left((1-p)^3 + 3p(1-p)^5\\right)^3$$\n\n这四个事件是互斥且穷尽的，因此它们的概率之和必须为 $1$。\n$$P_S + P_E P_S + (P_E)^2 P_S + (P_E)^3 = P_S (1 + P_E + (P_E)^2) + (P_E)^3$$\n使用 $P_S = 1 - P_E$：\n$$(1-P_E) \\frac{1-(P_E)^3}{1-P_E} + (P_E)^3 = (1-(P_E)^3) + (P_E)^3 = 1$$\n推导是一致的。\n\n我们定义 $E(p) = (1-p)^3 + 3p(1-p)^5$ 和 $S(p) = 1 - E(p)$。则概率为：\n$P(\\text{stop at } 1) = S(p)$\n$P(\\text{stop at } 2) = E(p)S(p)$\n$P(\\text{stop at } 3) = (E(p))^2 S(p)$\n$P(\\text{stop at } 4) = (E(p))^3$\n\n最终答案是这四个表达式组成的行向量。", "answer": "$$\\boxed{\\begin{pmatrix} 1 - (1-p)^{3} - 3p(1-p)^{5} & \\left( (1-p)^{3} + 3p(1-p)^{5} \\right) \\left( 1 - (1-p)^{3} - 3p(1-p)^{5} \\right) & \\left( (1-p)^{3} + 3p(1-p)^{5} \\right)^{2} \\left( 1 - (1-p)^{3} - 3p(1-p)^{5} \\right) & \\left( (1-p)^{3} + 3p(1-p)^{5} \\right)^{3} \\end{pmatrix}}$$", "id": "5018825"}]}