{"hands_on_practices": [{"introduction": "将一个有前景的生物标志物从实验室转化为临床应用，需要对其性能进行严格的评估。虽然灵敏度（sensitivity）和特异性（specificity）描述了一项检测的内在准确性，但其真正的临床效用取决于其预测价值。本练习将指导您计算阳性预测值（$PPV$）和阴性预测值（$NPV$），并展示它们如何关键地依赖于目标人群中疾病的患病率（prevalence）。[@problem_id:5069432]", "problem": "一个转化研究团队正在验证一种基于血液的生物标志物检测方法，该方法旨在用于早期检测肿瘤患者的治疗限制性毒性。在目标临床使用人群中，筛查时真实毒性的患病率估计为 $0.05$。先前的一项多中心分析验证表明，在预定使用场景下，该检测方法的临床灵敏度为 $0.9$，临床特异度为 $0.95$。该团队的工作假设是，该检测方法在这一人群中将具有临床上可操作的确诊（rule-in）和排除（rule-out）性能；为了在科学方法的框架内检验这一假设，他们必须量化预测值如何依赖于目标人群中的疾病频率。\n\n仅使用条件概率的基本法则，为二元疾病状态 $D \\in \\{\\text{存在}, \\text{不存在}\\}$ 和二元检测结果 $T \\in \\{T^{+}, T^{-}\\}$，用数学术语定义以下量：\n- 灵敏度，\n- 特异度，\n- 阳性预测值 (PPV)，\n- 阴性预测值 (NPV)。\n\n然后，用灵敏度、特异度和疾病患病率推导 PPV 和 NPV 的表达式。最后，计算当灵敏度为 $0.9$、特异度为 $0.95$、患病率为 $0.05$ 时的 PPV 和 NPV。将 PPV 和 NPV 均表示为小数（而非百分比），四舍五入到四位有效数字，并以 $\\text{PPV}, \\text{NPV}$ 的顺序，将最终数值答案报告为单个行向量。", "solution": "所陈述的问题具有科学依据、提法得当且客观。它展示了条件概率和贝叶斯定理在评估诊断测试性能特征方面的标准应用，这是生物统计学和转化医学中的一项基本任务。所有必要的数据（患病率、灵敏度、特异度）均已提供，问题明确无误。因此，该问题是有效的，我们可以着手解答。\n\n设 $D^{+}$ 为患者具有真实毒性（疾病存在）的事件， $D^{-}$ 为患者不具有毒性（疾病不存在）的事件。设 $T^{+}$ 为检测结果为阳性的事件， $T^{-}$ 为检测结果为阴性的事件。疾病的患病率，记为 $p$，是患者具有毒性的先验概率，因此 $p = P(D^{+})$。根据问题陈述，给定 $p = 0.05$。因此，患者不具有毒性的概率为 $P(D^{-}) = 1 - p = 1 - 0.05 = 0.95$。\n\n首先，我们将用条件概率正式定义所需的量。\n\n1.  **灵敏度 (Sens)**：在疾病存在的情况下，检测结果为阳性的概率。这是真阳性率。\n    $$ \\text{Sens} = P(T^{+} | D^{+}) $$\n    给定灵敏度为 $0.9$。\n\n2.  **特异度 (Spec)**：在疾病不存在的情况下，检测结果为阴性的概率。这是真阴性率。\n    $$ \\text{Spec} = P(T^{-} | D^{-}) $$\n    给定特异度为 $0.95$。\n\n3.  **阳性预测值 (PPV)**：在检测结果为阳性的情况下，疾病存在的概率。这是一个验后概率。\n    $$ \\text{PPV} = P(D^{+} | T^{+}) $$\n\n4.  **阴性预测值 (NPV)**：在检测结果为阴性的情况下，疾病不存在的概率。这也是一个验后概率。\n    $$ \\text{NPV} = P(D^{-} | T^{-}) $$\n\n接下来，我们使用条件概率的基本法则，特别是贝叶斯定理，来推导 $\\text{PPV}$ 和 $\\text{NPV}$ 的表达式。贝叶斯定理指出，对于两个事件 $A$ 和 $B$，$P(A|B) = \\frac{P(B|A)P(A)}{P(B)}$。\n\n为了推导 $\\text{PPV} = P(D^{+} | T^{+})$ 的表达式，我们应用贝叶斯定理：\n$$ \\text{PPV} = P(D^{+} | T^{+}) = \\frac{P(T^{+} | D^{+}) P(D^{+})}{P(T^{+})} $$\n分子中的项 $P(T^{+} | D^{+})$ 是灵敏度 ($\\text{Sens}$)，而 $P(D^{+})$ 是患病率 ($p$)。\n分母 $P(T^{+})$ 是检测结果为阳性的总概率。我们可以使用全概率公式将其展开：\n$$ P(T^{+}) = P(T^{+} | D^{+}) P(D^{+}) + P(T^{+} | D^{-}) P(D^{-}) $$\n我们知道 $P(T^{+} | D^{+}) = \\text{Sens}$ 且 $P(D^{+}) = p$。我们还知道 $P(D^{-}) = 1-p$。项 $P(T^{+} | D^{-})$ 是在疾病不存在的情况下检测结果为阳性的概率，即假阳性率。它与特异度的关系为 $P(T^{+} | D^{-}) = 1 - P(T^{-} | D^{-}) = 1 - \\text{Spec}$。\n将这些代入 $P(T^{+})$ 的表达式，得到：\n$$ P(T^{+}) = (\\text{Sens})(p) + (1 - \\text{Spec})(1 - p) $$\n因此，$\\text{PPV}$ 的完整表达式为：\n$$ \\text{PPV} = \\frac{(\\text{Sens})(p)}{(\\text{Sens})(p) + (1 - \\text{Spec})(1 - p)} $$\n\n类似地，为了推导 $\\text{NPV} = P(D^{-} | T^{-})$ 的表达式，我们应用贝叶斯定理：\n$$ \\text{NPV} = P(D^{-} | T^{-}) = \\frac{P(T^{-} | D^{-}) P(D^{-})}{P(T^{-})} $$\n分子中的项 $P(T^{-} | D^{-})$ 是特异度 ($\\text{Spec}$)，而 $P(D^{-})$ 是 $1-p$。\n分母 $P(T^{-})$ 是检测结果为阴性的总概率。根据全概率公式：\n$$ P(T^{-}) = P(T^{-} | D^{-}) P(D^{-}) + P(T^{-} | D^{+}) P(D^{+}) $$\n我们知道 $P(T^{-} | D^{-}) = \\text{Spec}$ 且 $P(D^{-}) = 1-p$。项 $P(T^{-} | D^{+})$ 是在疾病存在的情况下检测结果为阴性的概率，即假阴性率。它与灵敏度的关系为 $P(T^{-} | D^{+}) = 1 - P(T^{+} | D^{+}) = 1 - \\text{Sens}$。\n将这些代入 $P(T^{-})$ 的表达式，得到：\n$$ P(T^{-}) = (\\text{Spec})(1 - p) + (1 - \\text{Sens})(p) $$\n因此，$\\text{NPV}$ 的完整表达式为：\n$$ \\text{NPV} = \\frac{(\\text{Spec})(1 - p)}{(\\text{Spec})(1 - p) + (1 - \\text{Sens})(p)} $$\n\n最后，我们使用给定数据计算 $\\text{PPV}$ 和 $\\text{NPV}$ 的数值：\n- 患病率, $p = 0.05$\n- 灵敏度, $\\text{Sens} = 0.9$\n- 特异度, $\\text{Spec} = 0.95$\n\n对于 $\\text{PPV}$：\n$$ \\text{PPV} = \\frac{(0.9)(0.05)}{(0.9)(0.05) + (1 - 0.95)(1 - 0.05)} $$\n$$ \\text{PPV} = \\frac{0.045}{0.045 + (0.05)(0.95)} $$\n$$ \\text{PPV} = \\frac{0.045}{0.045 + 0.0475} = \\frac{0.045}{0.0925} \\approx 0.486486... $$\n四舍五入到四位有效数字，$\\text{PPV} = 0.4865$。\n\n对于 $\\text{NPV}$：\n$$ \\text{NPV} = \\frac{(0.95)(1 - 0.05)}{(0.95)(1 - 0.05) + (1 - 0.9)(0.05)} $$\n$$ \\text{NPV} = \\frac{(0.95)(0.95)}{(0.95)(0.95) + (0.1)(0.05)} $$\n$$ \\text{NPV} = \\frac{0.9025}{0.9025 + 0.005} = \\frac{0.9025}{0.9075} \\approx 0.994490... $$\n四舍五入到四位有效数字，$\\text{NPV} = 0.9945$。\n\n计算出的值表明，虽然该检测方法具有出色的排除性能（高 $\\text{NPV}$ 为 $0.9945$），但其确诊性能平平（$\\text{PPV}$ 为 $0.4865$），因为在这种低患病率的情况下，不到一半的阳性结果会对应于真实的毒性病例。\n\n最终答案按 ($\\text{PPV}$, $\\text{NPV}$) 的顺序报告。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4865  0.9945 \\end{pmatrix}}\n$$", "id": "5069432"}, {"introduction": "在转化研究中，假设检验常常依赖于观察性数据，而未测量的混杂因素（confounding）是其有效性的主要威胁。在断定观察到的关联是因果关系之前，评估其稳健性至关重要。本练习介绍了 E-值（E-value），一种敏感性分析工具，它量化了一个未测量的混杂因素需要多强的关联才能完全解释观察到的关联，从而为我们的因果推断提供了关键的检验。[@problem_id:5069437]", "problem": "一个转化药物流行病学团队正在评估一种已被引入常规医疗的新型小分子抗纤维化疗法的安全性信号。主要假设是，与标准治疗相比，接受该疗法会增加3-4级肝毒性的短期风险。在一项前瞻性登记研究中，2000名连续接受治疗的成年人接受了该疗法，另有2500名匹配的成年人在相同的三级医疗中心接受了标准治疗。在6个月内，72名接受治疗的患者和50名接受标准治疗的患者出现了3-4级肝毒性。\n\n您的任务是量化观测到的关联对于单个未测量的混杂因素的稳健性。使用风险比的核心定义和在风险比尺度上构建的关于未测量混杂的界限论证，推导一个解析表达式，该表达式表示在最小假设下，单个未测量的混杂因素需要同时与暴露和结局具有的最小关联强度（在风险比尺度上），才能将观测到的暴露-结局风险比推至零值$1$。这个量被称为证据值（E-value）。\n\n然后，计算观测数据的证据值。将最终证据值报告至四位有效数字。将最终量表示为一个纯数（无单位）。最后，根据转化医学中假设驱动的研究和实验设计原则，就对未测量混杂的稳健性提供一个简要解释。", "solution": "我们从风险和风险比的基本定义开始。设$R_{1}$表示暴露组的结局风险，$R_{0}$表示非暴露组的风险。观测到的风险比定义为\n$$\nRR_{\\text{obs}} = \\frac{R_{1}}{R_{0}}.\n$$\n根据提供的数据，暴露组的风险为 $R_{1} = \\frac{72}{2000}$，非暴露组的风险为 $R_{0} = \\frac{50}{2500}$。因此，\n$$\nR_{1} = \\frac{72}{2000} = 0.036, \\quad R_{0} = \\frac{50}{2500} = 0.020,\n$$\n从而\n$$\nRR_{\\text{obs}} = \\frac{0.036}{0.020} = 1.8.\n$$\n\n为在假设驱动的因果框架内评估对未测量混杂的稳健性，我们考虑一个单一的未测量混杂因素$U$及其在风险比尺度上与暴露$A$和结局$Y$的关联。一个经过充分检验的、针对风险比尺度上未测量混杂的偏倚界限结果（可从Cornfield型不等式和偏倚因子的单调性推导）指出，由单个二元混杂因素（其与结局Y在暴露A各分层内的风险比关联为$RR_{UY}$，与暴露A的风险比关联为$RR_{UA}$）所导致的最大向上偏倚受以下公式限制：\n$$\nB \\leq \\frac{RR_{UY} \\cdot RR_{UA}}{RR_{UY} + RR_{UA} - 1},\n$$\n条件是 $RR_{UY} \\geq 1$ 且 $RR_{UA} \\geq 1$。这个界限是一个被广泛接受的流行病学事实，用于描述未测量混杂的潜在影响。\n\n证据值（E-value）被定义为这样的最小强度$x$：在该界限下，$RR_{UY} = RR_{UA} = x$的条件足以将观测到的关联削弱至无效。形式上，要将观测到的$RR_{\\text{obs}}$移至1，要求是偏倚因子$B$等于或超过$RR_{\\text{obs}}$。设 $RR_{UY} = RR_{UA} = x$并使该界限等于观测到的风险比，可得：\n$$\n\\frac{x^{2}}{2x - 1} = RR_{\\text{obs}}.\n$$\n对$x$求解，得到一个一元二次方程：\n$$\nx^{2} = RR_{\\text{obs}}(2x - 1) \\quad \\Rightarrow \\quad x^{2} - 2 RR_{\\text{obs}} x + RR_{\\text{obs}} = 0.\n$$\n应用二次公式，我们得到：\n$$\nx = RR_{\\text{obs}} \\pm \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}} - 1)}.\n$$\n因为 $x \\geq 1$ 且 $RR_{\\text{obs}} > 1$，所以最小的可行$x$是较大的根，\n$$\nx^{\\star} = RR_{\\text{obs}} + \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}} - 1)}.\n$$\n这个$x^{\\star}$就是当$RR_{\\text{obs}} \\geq 1$时的证据值。\n\n代入$RR_{\\text{obs}} = 1.8$可得：\n$$\n\\text{E-value} = 1.8 + \\sqrt{1.8(1.8 - 1)} = 1.8 + \\sqrt{1.8 \\times 0.8} = 1.8 + \\sqrt{1.44} = 1.8 + 1.2 = 3.0.\n$$\n四舍五入到四位有效数字，结果为$3.000$。\n\n解释：在校正了已测量的协变量之后，并在此偏倚界限下，一个未测量的混杂因素需要同时与暴露和结局均存在至少为$3.000$的风险比关联，才能完全解释掉观测到的$RR_{\\text{obs}} = 1.8$。在假设驱动的转化医学背景下，如果根据领域知识和研究设计（例如，仔细的患者选择、关键协变量的严格测量），一个可能的未测量因素与暴露和结局之间同时存在如此强度的关联是不太可能的，那么观测到的安全性信号对于未测量的混杂因素就显得相对稳健。相反地，如果这样强的双重关联是合理的，那么该信号可能更容易受到混杂的影响，并且有必要进行进一步的实验或准实验评估。", "answer": "$$\\boxed{3.000}$$", "id": "5069437"}, {"introduction": "转化研究的最终目标是为临床实践和政策提供信息，这需要以易于理解的方式综合关于益处和风险的证据。本练习超越了简单的风险差异，计算了需治疗人数（$NNT$）和需伤害人数（$NNH$），这是两个非常直观的指标。然后，您将把它们整合到一个净临床获益（Net Clinical Benefit）框架中，展示如何权衡疗效与安全性，以对一种新疗法的价值做出整体判断。[@problem_id:5069453]", "problem": "一项转化性III期随机对照试验(RCT)评估了一种新型抗凝剂$X$与标准疗法相比，在具有高血栓栓塞风险的成年心房颤动患者中的效果。该试验采用假设驱动的设计进行了预注册：主要临床获益终点是1年内缺血性中风的减少，主要安全性终点是1年内大出血的增加。每个终点的零假设是治疗组和对照组具有相等的风险。患者顾问委员会的意见以偏好权重的形式纳入净临床获益框架，认识到预防缺血性中风的感知重要性可能与大出血危害不同。\n\n1年内观察到的风险如下：\n- 对照组缺血性中风风险 $R_{C,\\text{stroke}} = 0.18$，治疗组缺血性中风风险 $R_{T,\\text{stroke}} = 0.135$。\n- 对照组大出血风险 $R_{C,\\text{bleed}} = 0.03$，治疗组大出血风险 $R_{T,\\text{bleed}} = 0.047$。\n\n患者偏好权重为：\n- 预防缺血性中风的权重 $w_{\\text{stroke}} = 1.0$。\n- 经历一次大出血事件的权重 $w_{\\text{bleed}} = 0.5$。\n\n仅从风险作为事件概率、绝对风险差作为组间事件概率之差以及预期计数作为风险与队列规模之积的基本定义出发，完成以下任务：\n- 定义为预防一次缺血性中风所需的治疗人数(NNT)和导致一次大出血事件所需的伤害人数(NNH)，并将每个定义与其终点的绝对风险差明确联系起来。\n- 使用观察到的风险计算NNT和NNH。\n- 推导每治療$N$名患者的净临床获益表达式，其定义为预防的加权预期获益事件数减去造成的加权预期伤害事件数，并计算当$N = 1000$时的值。\n\n以每治疗1000名患者的加权事件数表示最终净临床获益。如果选择对任何中间量进行四舍五入，则保留四位有效数字；然而，如果最终净临床获益值可以无需四舍五入计算得出，则必须精确报告。", "solution": "问题陈述已经过验证，被认为是科学合理的、定义明确且客观的。它展示了转化医学中临床试验分析的标准情景，提供了所有必要的数据和清晰、可形式化的目标。\n\n解决方案按要求分为三个部分：首先，定义需治人数($NNT$)和需伤人数($NNH$)；其次，计算这些值；第三，推导并计算净临床获益($NCB$)。\n\n**第1部分：NNT和NNH的定义**\n\n我们从风险的基本定义开始，即在特定人群中于规定时间内发生事件的概率。设$R_{T}$为治疗组的风险，$R_{C}$为对照组的风险。\n\n绝对风险差($ARD$)是两组事件率之间的算术差。\n$$ARD = R_{C} - R_{T}$$\n$ARD$的符号取决于事件是获益（不良结局被预防）还是伤害（不良结局被导致）。\n\n对于有益结局，如预防缺血性中风，治疗组的风险预计低于对照组($R_{T,\\text{stroke}}  R_{C,\\text{stroke}}$)。这个差值称为绝对风险降低($ARR$)。\n$$ARR = R_{C,\\text{stroke}} - R_{T,\\text{stroke}}$$\n$ARR$代表了因接受治疗而非对照而免于不良结局（中风）的人群比例。例如，$ARR$为$0.05$意味着每治疗100名患者，就有额外的5名患者将免于中风。\n\n需治人数($NNT$)是指为预防一个额外的不良结局而需要接受干预的平均患者人数。它是$ARR$的乘法逆元。\n$$NNT = \\frac{1}{ARR} = \\frac{1}{R_{C,\\text{stroke}} - R_{T,\\text{stroke}}}$$\n推导很简单：如果治疗1名患者能降低$ARR$的风险，那么为了达到总风险降低1（即预防一个完整事件）而必须治疗的患者数($NNT$)满足 $NNT \\times ARR = 1$，重新整理即可得到上述定义。\n\n对于有害结局，如大出血事件，治疗组的风险通常高于对照组($R_{T,\\text{bleed}} > R_{C,\\text{bleed}}$)。这个差值称为绝对风险增加($ARI$)。为保持该指标为正值，其定义为：\n$$ARI = R_{T,\\text{bleed}} - R_{C,\\text{bleed}}$$\n$ARI$代表了因接受治疗而经历额外不良结局（出血）的人群比例。\n\n需伤人数($NNH$)是指为导致一个额外的有害结局发生而需要治疗的平均患者人数。它是$ARI$的乘法逆元。\n$$NNH = \\frac{1}{ARI} = \\frac{1}{R_{T,\\text{bleed}} - R_{C,\\text{bleed}}}$$\n其逻辑与$NNT$类似。\n\n**第2部分：NNT和NNH的计算**\n\n使用提供的风险数据：\n- 对照组缺血性中风风险: $R_{C,\\text{stroke}} = 0.18$\n- 治疗组缺血性中风风险: $R_{T,\\text{stroke}} = 0.135$\n- 对照组大出血风险: $R_{C,\\text{bleed}} = 0.03$\n- 治疗组大出血风险: $R_{T,\\text{bleed}} = 0.047$\n\n首先，我们计算缺血性中风的绝对风险降低：\n$$ARR_{\\text{stroke}} = R_{C,\\text{stroke}} - R_{T,\\text{stroke}} = 0.18 - 0.135 = 0.045$$\n现在，我们计算预防一次中风的$NNT$：\n$$NNT = \\frac{1}{ARR_{\\text{stroke}}} = \\frac{1}{0.045} = \\frac{1}{45/1000} = \\frac{1000}{45} = \\frac{200}{9} \\approx 22.22$$\n按照惯例，$NNT$会向上取整到最近的整数，意味着需要治疗23名患者才能预防一次中风。然而，为了计算目的，我们保留精确值。\n\n接下来，我们计算大出血的绝对风险增加：\n$$ARI_{\\text{bleed}} = R_{T,\\text{bleed}} - R_{C,\\text{bleed}} = 0.047 - 0.03 = 0.017$$\n现在，我们计算导致一次大出血的$NNH$：\n$$NNH = \\frac{1}{ARI_{\\text{bleed}}} = \\frac{1}{0.017} = \\frac{1}{17/1000} = \\frac{1000}{17} \\approx 58.82$$\n按照惯例，$NNH$会向下取整到最近的整数，意味着每治疗58名患者，预计会额外发生一次大出血。我们同样保留精确值。\n\n**第3部分：净临床获益(NCB)的推导与计算**\n\n我们被要求推导每治疗$N$名患者的净临床获益表达式。在一个大小为$N$的队列中，事件的预期计数是风险与队列大小的乘积，$E = N \\times R$。\n\n通过治疗$N$名患者所预防的中风预期数量，是大小为$N$的对照队列和大小为$N$的治疗队列之间预期事件数的差值。\n$$\\Delta E_{\\text{prevented\\_stroke}} = E_{C,\\text{stroke}} - E_{T,\\text{stroke}} = N \\times R_{C,\\text{stroke}} - N \\times R_{T,\\text{stroke}} = N \\times (R_{C,\\text{stroke}} - R_{T,\\text{stroke}}) = N \\times ARR_{\\text{stroke}}$$\n通过治疗$N$名患者所导致的额外出血事件的预期数量是预期事件数的差值。\n$$\\Delta E_{\\text{caused\\_bleed}} = E_{T,\\text{bleed}} - E_{C,\\text{bleed}} = N \\times R_{T,\\text{bleed}} - N \\times R_{C,\\text{bleed}} = N \\times (R_{T,\\text{bleed}} - R_{C,\\text{bleed}}) = N \\times ARI_{\\text{bleed}}$$\n净临床获益$NCB_N$定义为预防的加权预期获益事件数减去造成的加权预期伤害事件数。给定的权重为$w_{\\text{stroke}} = 1.0$和$w_{\\text{bleed}} = 0.5$。\n$$NCB_N = (w_{\\text{stroke}} \\times \\Delta E_{\\text{prevented\\_stroke}}) - (w_{\\text{bleed}} \\times \\Delta E_{\\text{caused\\_bleed}})$$\n代入预期事件变化的表达式：\n$$NCB_N = (w_{\\text{stroke}} \\times N \\times ARR_{\\text{stroke}}) - (w_{\\text{bleed}} \\times N \\times ARI_{\\text{bleed}})$$\n这可以因式分解为：\n$$NCB_N = N \\times (w_{\\text{stroke}} \\times ARR_{\\text{stroke}} - w_{\\text{bleed}} \\times ARI_{\\text{bleed}})$$\n这是大小为$N$的队列的净临床获益的通用表达式。\n\n我们被要求计算当$N = 1000$时的值。我们代入已知数值：\n- $N = 1000$\n- $w_{\\text{stroke}} = 1.0$\n- $w_{\\text{bleed}} = 0.5$\n- $ARR_{\\text{stroke}} = 0.045$\n- $ARI_{\\text{bleed}} = 0.017$\n\n$$NCB_{1000} = 1000 \\times ((1.0 \\times 0.045) - (0.5 \\times 0.017))$$\n首先，我们计算括号内的项：\n$$(1.0 \\times 0.045) = 0.045$$\n$$(0.5 \\times 0.017) = 0.0085$$\n差值为：\n$$0.045 - 0.0085 = 0.0365$$\n最后，我们乘以$N=1000$：\n$$NCB_{1000} = 1000 \\times 0.0365 = 36.5$$\n这个值代表每1000名接受抗凝剂X治疗而非标准疗法的患者，可获得36.5个加权事件的净获益。由于该值为正，根据此框架，该治疗提供了净临床获益。这个最终值是精确的，不需要四舍五入。", "answer": "$$\\boxed{36.5}$$", "id": "5069453"}]}