{"hands_on_practices": [{"introduction": "基因编辑，特别是基于CRISPR的技术，其临床转化的一个主要障碍是脱靶效应。评估这些罕见的脱靶事件需要高灵敏度的测量技术（如新一代测序NGS）和稳健的统计模型，以从测量噪声中区分出真实的生物信号。本练习旨在挑战您推导出一个统计估计量，以准确测量真实的脱靶频率，并利用它来量化比较*离体 (ex vivo)* 与*在体 (in vivo)* 基因编辑策略的安全性。[@problem_id:5014792]", "problem": "一个临床转化医学项目正在评估两种成簇规律间隔短回文重复序列 (Clustered Regularly Interspaced Short Palindromic Repeats, CRISPR)-Cas9基因编辑策略：离体编辑造血干细胞后回输，以及在体编辑肝细胞。通过具有已知检测特性的下一代测序（NGS）在特定基因组位点评估脱靶活性。将分析建立在分子生物学中心法则（脱氧核糖核酸到核糖核酸到蛋白质）和测序读数的伯努利抽样统计模型的基础上。\n\n将该位点的真实脱靶编辑比例定义为 $f \\in [0,1]$。每个NGS读数独立地报告一个编辑检出，其概率为 $p(f)$，由检测的灵敏度和假阳性率决定：一个真正被编辑的等位基因被检出为编辑的概率为 $\\eta$，一个真正未被编辑的等位基因被检出为编辑的概率为 $\\phi$，因此，单次读数的编辑检出概率为 $p(f) = \\eta f + \\phi (1 - f)$。假设在来自在体编辑组织的 $N$ 个独立读数中观察到 $r$ 个编辑检出。使用独立伯努利试验的统计模型，从第一性原理出发，基于观察到 $r$ 个编辑检出的似然性，推导出 $f$ 的一个估计量 $\\hat{f}$。\n\n已知 $\\eta = 0.90$，$\\phi = 1.0 \\times 10^{-4}$，$N = 10{,}000$，$r = 12$，使用你推导出的估计量计算 $\\hat{f}$。\n\n对于在体策略，假设有 $M = 1.2 \\times 10^{8}$ 个肝细胞暴露于编辑过程，因此，在该位点带有脱靶编辑的肝细胞的期望数量为 $M \\hat{f}$。对于离体策略，假设由于受控的暴露条件，相对于在体环境，脱靶比例降低了因子 $\\rho = 0.35$，并且在回输前，一个筛选检测移除了比例为 $\\sigma = 0.92$ 的脱靶编辑细胞。离体产物包含 $N_{\\mathrm{trans}} = 5.0 \\times 10^{6}$ 个细胞。在这些假设下，回输时带有脱靶编辑的细胞的期望数量为 $N_{\\mathrm{trans}} (1 - \\sigma) \\rho \\hat{f}$。\n\n计算脱靶编辑细胞的期望减少量 $D$，定义为\n$$D = M \\hat{f} - N_{\\mathrm{trans}} (1 - \\sigma) \\rho \\hat{f}.$$\n将你的最终答案表示为细胞计数，并将结果四舍五入到四位有效数字。", "solution": "问题要求估计真实脱靶编辑比例 $f$，并用它来比较两种基因编辑策略。其背景是基因编辑，一种修改生物体脱氧核糖核酸（DNA）的技术。脱靶效应的分析依赖于下一代测序（NGS）来读取潜在脱靶位点的DNA序列。这一过程由中心法则框定，因为对DNA的修改可以改变核糖核酸（RNA）转录本和随后的蛋白质合成，从而导致细胞层面的后果。\n\n首先，我们推导真实脱靶编辑比例 $f$ 的估计量。问题指明，在一组 $N$ 个独立的NGS读数中观察到的编辑检出数 $r$ 服从二项分布。每个读数都是一次独立的伯努利试验，其中“成功”是指检出一次编辑。成功概率 $p(f)$ 是真实编辑等位基因比例 $f$、检测灵敏度（真阳性率）$\\eta$ 和假阳性率 $\\phi$ 的函数。\n\n在单个读数上检出编辑的概率是两个不相交事件的概率之和：在一个真正被编辑的等位基因上检出编辑，以及在一个真正未被编辑的等位基因上检出编辑。\n$$p(f) = P(\\text{检出编辑} | \\text{真实编辑})P(\\text{真实编辑}) + P(\\text{检出编辑} | \\text{真实未编辑})P(\\text{真实未编辑})$$\n根据定义，这等于：\n$$p(f) = \\eta f + \\phi (1 - f)$$\n这可以重排为 $p(f) = (\\eta - \\phi)f + \\phi$。\n\n在 $N$ 个读数中观察到 $r$ 个编辑检出的似然性由二项概率质量函数给出：\n$$L(f; N, r) = \\binom{N}{r} [p(f)]^r [1 - p(f)]^{N-r}$$\n为了找到 $f$ 的最大似然估计量（MLE），我们对 $f$ 最大化该函数。在计算上，最大化对数似然函数 $\\ln L(f)$ 更简单：\n$$\\ln L(f) = \\ln\\binom{N}{r} + r \\ln(p(f)) + (N-r)\\ln(1 - p(f))$$\n我们通过对 $f$ 求导并令其为零来找到最大值。\n$$\\frac{d}{df} \\ln L(f) = \\frac{r}{p(f)} \\frac{dp}{df} + \\frac{N-r}{1-p(f)} \\left(-\\frac{dp}{df}\\right) = 0$$\n$p(f)$ 对 $f$ 的导数是：\n$$\\frac{dp}{df} = \\frac{d}{df} [(\\eta - \\phi)f + \\phi] = \\eta - \\phi$$\n将此代入方程并假设 $\\eta \\neq \\phi$：\n$$\\left( \\frac{r}{p(f)} - \\frac{N-r}{1-p(f)} \\right)(\\eta - \\phi) = 0$$\n$$\\frac{r}{p(f)} = \\frac{N-r}{1-p(f)}$$\n$$r(1 - p(f)) = (N-r)p(f)$$\n$$r - r \\cdot p(f) = N \\cdot p(f) - r \\cdot p(f)$$\n$$r = N \\cdot p(f)$$\n这得到了概率 $p(f)$ 的最大似然估计量，记为 $\\hat{p}$：\n$$\\hat{p} = \\frac{r}{N}$$\n现在，我们将此估计值代回到 $p(f)$ 的方程中，以求解 $f$ 的估计量，记为 $\\hat{f}$：\n$$\\frac{r}{N} = (\\eta - \\phi)\\hat{f} + \\phi$$\n$$\\frac{r}{N} - \\phi = (\\eta - \\phi)\\hat{f}$$\n因此，真实脱靶编辑比例的估计量是：\n$$\\hat{f} = \\frac{\\frac{r}{N} - \\phi}{\\eta - \\phi}$$\n\n接下来，我们使用所提供的数据计算 $\\hat{f}$ 的数值：$\\eta = 0.90$，$\\phi = 1.0 \\times 10^{-4}$，$N = 10,000$，$r = 12$。\n观察到的编辑检出频率为：\n$$\\hat{p} = \\frac{r}{N} = \\frac{12}{10,000} = 0.0012$$\n将这些值代入 $f$ 的估计量：\n$$\\hat{f} = \\frac{0.0012 - 1.0 \\times 10^{-4}}{0.90 - 1.0 \\times 10^{-4}} = \\frac{0.0012 - 0.0001}{0.90 - 0.0001} = \\frac{0.0011}{0.8999}$$\n为了避免过早的舍入误差，我们将在后续计算中保留这个精确的分数形式。\n\n问题要求计算脱靶编辑细胞的期望减少量 $D$，定义为：\n$$D = M \\hat{f} - N_{\\mathrm{trans}} (1 - \\sigma) \\rho \\hat{f}$$\n我们可以提出因子 $\\hat{f}$：\n$$D = \\left[ M - N_{\\mathrm{trans}} (1 - \\sigma) \\rho \\right] \\hat{f}$$\n我们已知以下数值：\n$M = 1.2 \\times 10^{8}$\n$N_{\\mathrm{trans}} = 5.0 \\times 10^{6}$\n$\\sigma = 0.92$\n$\\rho = 0.35$\n\n首先，我们计算 $\\hat{f}$ 的系数：\n$$1 - \\sigma = 1 - 0.92 = 0.08$$\n$$N_{\\mathrm{trans}} (1 - \\sigma) \\rho = (5.0 \\times 10^{6}) \\times (0.08) \\times (0.35) = 140,000 = 1.4 \\times 10^{5}$$\n$$M - N_{\\mathrm{trans}} (1 - \\sigma) \\rho = 1.2 \\times 10^{8} - 1.4 \\times 10^{5} = 120,000,000 - 140,000 = 119,860,000$$\n现在，我们可以计算 $D$：\n$$D = (119,860,000) \\times \\hat{f} = (119,860,000) \\times \\frac{0.0011}{0.8999}$$\n$$D = \\frac{131,846}{0.8999} \\approx 146511.834648$$\n问题要求将最终答案四舍五入到四位有效数字。结果的前四位有效数字是 $1$、$4$、$6$、$5$。第五位有效数字是 $1$，因此我们向下舍入。\n$$D \\approx 146,500$$\n用标准科学记数法表示以明确指出四位有效数字，结果是 $1.465 \\times 10^5$。\n在给定的模型参数下，这个数值代表了通过使用离体策略而非在体策略所避免的脱靶编辑细胞的期望数量。", "answer": "$$\\boxed{1.465 \\times 10^{5}}$$", "id": "5014792"}, {"introduction": "除了脱靶切割，基因治疗的另一个关键安全考量是基因毒性，特别是某些递送载体可能引起的插入突变。本练习将探讨如何使用概率论，特别是泊松分布，来为这一风险建立数学模型，并比较两种策略的患者层面风险。通过此练习，您将量化评估*离体 (ex vivo)* 制造流程中的质量控制步骤（即在细胞回输前筛除危险细胞）所带来的显著安全优势。[@problem_id:5014781]", "problem": "一个转化医学项目正在评估两种基因编辑策略因插入突变导致的遗传毒性的相对患者层面风险：带有放行质量控制的离体策略与无此类筛选的在体递送策略。假设以下基本且广泛使用的前提：每个细胞的整合事件可以很好地用独立的泊松过程来建模，且整合位点在单倍体基因组上呈均匀随机分布。如果至少有一次整合发生在某个高风险原癌基因周围的启动子邻近窗口内，并且插入背景是激活性的，那么该细胞就具有遗传毒性风险。具体来说，假设有 $G$ 个高风险原癌基因，每个基因都有一个宽度为 $2w$ 的双向启动子邻近窗口，并且在落在该窗口内的条件下，激活的概率为 $\\beta$。单倍体基因组的长度为 $L$。因此，每次整合的有效致险概率为 $p_{\\mathrm{int}} = \\beta \\cdot \\frac{2 G w}{L}$。\n\n考虑以下参数化设置：\n- 基因组与风险参数：$G = 50$，$w = 1.0 \\times 10^{3}$ 碱基对，$L = 3.0 \\times 10^{9}$ 碱基对，以及 $\\beta = 3.0 \\times 10^{-4}$。\n- 离体策略：每个细胞的平均整合数为 $\\mu_{\\mathrm{ex}} = 0.8$，输注的制备细胞数量为 $N_{\\mathrm{ex}} = 2.0 \\times 10^{8}$，放行质量控制以灵敏度 $s = 0.95$ 移除具有遗传毒性风险的细胞（假设特异性完美且每个风险细胞的移除是独立的）。\n- 在体策略：每个转导细胞的平均整合数为 $\\mu_{\\mathrm{in}} = 0.01$，靶组织中的转导细胞数量为 $N_{\\mathrm{in}} = 1.0 \\times 10^{9}$。\n\n假设细胞间和整合事件间相互独立。将每种策略的患者层面遗传毒性风险定义为：策略实施后，患者体内存在至少一个具有遗传毒性风险细胞的概率。设 $P_{\\mathrm{ex}}$ 表示离体策略的此概率，$P_{\\mathrm{in}}$ 表示在体策略的此概率。计算比率 $R = \\frac{P_{\\mathrm{ex}}}{P_{\\mathrm{in}}}$。将最终答案四舍五入至三位有效数字。结果表示为无单位的无量纲数。", "solution": "主要目标是计算比率 $R = \\frac{P_{\\mathrm{ex}}}{P_{\\mathrm{in}}}$，其中 $P_{\\mathrm{ex}}$ 和 $P_{\\mathrm{in}}$ 分别是*离体*和*在体*策略的患者层面遗传毒性风险。\n\n首先，我们计算单次整合事件是致险的有效概率 $p_{\\mathrm{int}}$。问题提供了公式：\n$$ p_{\\mathrm{int}} = \\beta \\cdot \\frac{2 G w}{L} $$\n代入给定值：$G = 50$，$w = 1.0 \\times 10^{3}$ 碱基对，$L = 3.0 \\times 10^{9}$ 碱基对，以及 $\\beta = 3.0 \\times 10^{-4}$。\n$$ p_{\\mathrm{int}} = (3.0 \\times 10^{-4}) \\cdot \\frac{2 \\times 50 \\times (1.0 \\times 10^{3})}{3.0 \\times 10^{9}} = (3.0 \\times 10^{-4}) \\cdot \\frac{1.0 \\times 10^{5}}{3.0 \\times 10^{9}} = 1.0 \\times 10^{-8} $$\n这个概率极小，符合预期。\n\n接下来，我们推导单个细胞变为致险细胞的概率的通用表达式。每个细胞的整合次数 $K$ 服从均值为 $\\mu$ 的泊松分布，即 $P(K=k) = \\frac{e^{-\\mu} \\mu^k}{k!}$。如果至少有一次整合是致险的，则该细胞是致险的。假设每次整合事件独立，一个具有 $k$ 次整合的细胞*非*致险的概率是 $(1 - p_{\\mathrm{int}})^k$。一个细胞非致险的总概率 $p_{\\text{safe-cell}}$，可以通过对所有可能的整合次数 $k$ 进行边缘化求得：\n$$ p_{\\text{safe-cell}} = \\sum_{k=0}^{\\infty} P(\\text{safe} | K=k) P(K=k) = \\sum_{k=0}^{\\infty} (1 - p_{\\mathrm{int}})^k \\frac{e^{-\\mu} \\mu^k}{k!} $$\n这是泊松分布的一个已知性质：\n$$ p_{\\text{safe-cell}} = e^{-\\mu} \\sum_{k=0}^{\\infty} \\frac{(\\mu(1 - p_{\\mathrm{int}}))^k}{k!} = e^{-\\mu} \\exp(\\mu(1 - p_{\\mathrm{int}})) = e^{-\\mu + \\mu - \\mu p_{\\mathrm{int}}} = \\exp(-\\mu p_{\\mathrm{int}}) $$\n因此，一个细胞是致险的概率 $p_{\\text{cell}}$ 为：\n$$ p_{\\text{cell}}(\\mu) = 1 - p_{\\text{safe-cell}} = 1 - \\exp(-\\mu p_{\\mathrm{int}}) $$\n\n现在，我们计算*在体*策略的患者层面风险 $P_{\\mathrm{in}}$。这是 $N_{\\mathrm{in}}$ 个转导细胞中至少有一个是致险的概率。假设细胞间相互独立，所有 $N_{\\mathrm{in}}$ 个细胞都是安全的概率是 $(p_{\\text{safe-cell}})^{N_{\\mathrm{in}}}$。\n$$ P_{\\mathrm{in}} = 1 - (p_{\\text{safe-cell}})^{N_{\\mathrm{in}}} = 1 - (\\exp(-\\mu_{\\mathrm{in}} p_{\\mathrm{int}}))^{N_{\\mathrm{in}}} = 1 - \\exp(-N_{\\mathrm{in}} \\mu_{\\mathrm{in}} p_{\\mathrm{int}}) $$\n指数项 $\\lambda_{\\mathrm{in}} = N_{\\mathrm{in}} \\mu_{\\mathrm{in}} p_{\\mathrm{int}}$ 代表患者体内致险整合的总期望数。\n代入*在体*策略的数值：$N_{\\mathrm{in}} = 1.0 \\times 10^{9}$，$\\mu_{\\mathrm{in}} = 0.01$。\n$$ \\lambda_{\\mathrm{in}} = (1.0 \\times 10^{9}) \\times (0.01) \\times (1.0 \\times 10^{-8}) = 0.1 $$\n因此，*在体*风险为：\n$$ P_{\\mathrm{in}} = 1 - \\exp(-0.1) $$\n\n对于*离体*策略，我们必须考虑质量控制筛选。筛选前一个细胞是致险的概率为：\n$$ p_{\\text{cell, ex\\_pre}} = 1 - \\exp(-\\mu_{\\mathrm{ex}} p_{\\mathrm{int}}) $$\n筛选过程以灵敏度 $s = 0.95$ 移除致险细胞。因此，一个在筛选前是致险的细胞，将有 $1-s$ 的概率存活下来并在最终产品中保持致险状态。初始群体中任意一个细胞最终成为产品中的致险细胞的概率是：\n$$ p_{\\text{cell, ex\\_post}} = p_{\\text{cell, ex\\_pre}} \\times (1-s) = (1 - \\exp(-\\mu_{\\mathrm{ex}} p_{\\mathrm{int}}))(1-s) $$\n患者层面风险 $P_{\\mathrm{ex}}$ 是 $N_{\\mathrm{ex}}$ 个输注细胞中至少有一个是致险的概率。\n$$ P_{\\mathrm{ex}} = 1 - (1 - p_{\\text{cell, ex\\_post}})^{N_{\\mathrm{ex}}} = 1 - \\left(1 - (1 - \\exp(-\\mu_{\\mathrm{ex}} p_{\\mathrm{int}}))(1-s)\\right)^{N_{\\mathrm{ex}}} $$\n$p_{\\text{cell, ex\\_post}}$ 项非常小。指数中的参数为 $\\mu_{\\mathrm{ex}} p_{\\mathrm{int}} = 0.8 \\times (1.0 \\times 10^{-8}) = 8.0 \\times 10^{-9}$。由于这个值极小，我们可以使用近似 $1-\\exp(-x) \\approx x$。\n$$ p_{\\text{cell, ex\\_post}} \\approx (\\mu_{\\mathrm{ex}} p_{\\mathrm{int}})(1-s) $$\n此外，对于大的 $N$ 和小的 $p$，有 $(1-p)^N \\approx \\exp(-Np)$。应用此近似，我们得到：\n$$ P_{\\mathrm{ex}} \\approx 1 - \\exp(-N_{\\mathrm{ex}} p_{\\text{cell, ex\\_post}}) \\approx 1 - \\exp(-N_{\\mathrm{ex}} (\\mu_{\\mathrm{ex}} p_{\\mathrm{int}}) (1-s)) $$\n指数项 $\\lambda_{\\mathrm{ex}} = N_{\\mathrm{ex}} \\mu_{\\mathrm{ex}} p_{\\mathrm{int}} (1-s)$ 是输注产品中致险细胞的期望数量。\n代入*离体*策略的数值：$N_{\\mathrm{ex}} = 2.0 \\times 10^{8}$，$\\mu_{\\mathrm{ex}} = 0.8$，$s = 0.95$。\n$$ \\lambda_{\\mathrm{ex}} \\approx (2.0 \\times 10^{8}) \\times (0.8) \\times (1.0 \\times 10^{-8}) \\times (1 - 0.95) $$\n$$ \\lambda_{\\mathrm{ex}} \\approx (2.0 \\times 10^{8}) \\times (0.8) \\times (1.0 \\times 10^{-8}) \\times (0.05) = (1.6 \\times 10^8) \\times (1.0 \\times 10^{-8}) \\times (0.05) = 1.6 \\times 0.05 = 0.08 $$\n考虑到参数的尺度，用于获得 $\\lambda_{\\mathrm{ex}}$ 的近似的准确性非常高。因此，*离体*风险为：\n$$ P_{\\mathrm{ex}} \\approx 1 - \\exp(-0.08) $$\n\n最后，我们计算比率 $R = \\frac{P_{\\mathrm{ex}}}{P_{\\mathrm{in}}}$：\n$$ R = \\frac{1 - \\exp(-0.08)}{1 - \\exp(-0.1)} $$\n使用计算器：\n$$ P_{\\mathrm{ex}} \\approx 1 - 0.923116346... = 0.076883653... $$\n$$ P_{\\mathrm{in}} = 1 - 0.904837418... = 0.095162581... $$\n$$ R \\approx \\frac{0.076883653}{0.095162581} \\approx 0.807913... $$\n将结果四舍五入至三位有效数字，我们得到 $0.808$。", "answer": "$$\\boxed{0.808}$$", "id": "5014781"}]}