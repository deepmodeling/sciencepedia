{"hands_on_practices": [{"introduction": "在应对任何一种罕见病时，首要步骤是准确估计其患病率。然而，由于人口结构的异质性，例如不同亚群中不同的等位基因频率和近亲繁殖率，这项任务变得异常复杂。本练习将指导您完成一个实际情景的计算，通过整合群体遗传学原理与人口统计学数据，来估算预期患者数量，这对于公共卫生规划和资源分配至关重要。[@problem_id:5072569]", "problem": "考虑一种单基因罕见病 RD-X，该病遵循常染色体隐性（AR）遗传方式，且外显不完全。假设人群被划分为三个以 $i \\in \\{1,2,3\\}$ 为索引的人口分层，每个分层具有特定的 AR 风险等位基因频率 $q_i$、近交系数 $F_i$ 和人口权重 $w_i$，且满足 $\\sum_{i=1}^{3} w_i = 1$。在考虑近交的哈迪-温伯格平衡（HWE）条件下，分层 $i$ 中个体为 AR 纯合子（$aa$）的概率是 $q_i^{2} + F_i q_i (1 - q_i)$。设临床外显率为 $\\pi \\in (0,1)$，因此分层 $i$ 中的个体临床患病的概率为 $\\pi \\left(q_i^{2} + F_i q_i (1 - q_i)\\right)$。总人口规模为 $N$，各分层的人口规模为 $N_i = w_i N$。\n\n给定以下针对一个具有遗传多样性和不同近亲结婚习俗的国家的科学上合理的参数：\n- 总人口规模 $N = 68{,}000{,}000$。\n- 外显率 $\\pi = 0.8$。\n- 分层 1：$w_1 = 0.60$，$q_1 = 0.004$，$F_1 = 0$。\n- 分层 2：$w_2 = 0.35$，$q_2 = 0.002$，$F_2 = 0.01$。\n- 分层 3：$w_3 = 0.05$，$q_3 = 0.03$，$F_3 = 0.02$。\n\n从期望的线性性和患病率作为疾病风险的概率定义这些第一性原理出发，通过对各分层进行汇总，推导出该国 RD-X 患者的期望数量。提供以“人”为单位的最终期望数量，并将您的答案四舍五入到四位有效数字。此外，简要说明人口异质性（$w_i$、$q_i$ 和 $F_i$ 的差异）如何影响汇总估计值，且论证过程不应超出所述基础进行任何简化。", "solution": "该问题被评估为具有科学依据、提法明确且客观。所有必要数据均已提供，其前提与群体遗传学的既定原则一致。该问题有效。\n\n目标是推导在一个按人口统计学分层的人群中，患有罕见病 RD-X 的个体总数的期望值。我们按照要求从第一性原理开始。\n\n设 $X$ 为该国临床患病个体总数的随机变量。该国人口被划分为 3 个不相交的分层，因此我们可以定义 $X_i$ 为分层 $i$ 中的患病个体数量，其中 $i \\in \\{1, 2, 3\\}$。患病个体总数是各分层患病个体数量之和：\n$$X = X_1 + X_2 + X_3 = \\sum_{i=1}^{3} X_i$$\n根据期望的线性性，患病个体总数的期望值是各分层期望值之和：\n$$E[X] = E\\left[\\sum_{i=1}^{3} X_i\\right] = \\sum_{i=1}^{3} E[X_i]$$\n现在，我们必须求出每个分层 $i$ 内的患病个体期望数量 $E[X_i]$。分层 $i$ 的人口规模为 $N_i = w_i N$，其中 $N$ 是总人口规模，$w_i$ 是该分层的人口权重。对于从分层 $i$ 中随机选择的任何个体，其临床患病的概率定义为该分层的疾病患病率，我们称之为 $P_{\\text{aff},i}$。根据问题陈述，该概率由以下公式给出：\n$$P_{\\text{aff},i} = \\pi \\left(q_i^{2} + F_i q_i (1 - q_i)\\right)$$\n其中 $\\pi$ 是临床外显率，$q_i$ 是风险等位基因频率，$F_i$ 是分层 $i$ 的近交系数。\n\n分层 $i$ 中的患病个体数量 $X_i$ 可以建模为指示随机变量之和。设如果分层 $i$ 中的第 $j$ 个个体患病，则 $A_{ij} = 1$，否则 $A_{ij} = 0$，其中 $j \\in \\{1, \\dots, N_i\\}$。那么 $X_i = \\sum_{j=1}^{N_i} A_{ij}$。每个指示变量的期望为 $E[A_{ij}] = P(A_{ij}=1) = P_{\\text{aff},i}$。对 $X_i$ 使用期望的线性性：\n$$E[X_i] = E\\left[\\sum_{j=1}^{N_i} A_{ij}\\right] = \\sum_{j=1}^{N_i} E[A_{ij}] = N_i \\cdot P_{\\text{aff},i}$$\n代入 $N_i = w_i N$ 和 $P_{\\text{aff},i}$ 的表达式：\n$$E[X_i] = (w_i N) \\cdot \\pi \\left(q_i^{2} + F_i q_i (1 - q_i)\\right)$$\n最后，该国患病个体的总期望数量是所有分层的总和：\n$$E[X] = \\sum_{i=1}^{3} E[X_i] = \\sum_{i=1}^{3} w_i N \\pi \\left(q_i^{2} + F_i q_i (1 - q_i)\\right)$$\n将常数 $N$ 和 $\\pi$ 提取出来，我们得到用于计算的最终表达式：\n$$E[X] = N \\pi \\sum_{i=1}^{3} w_i \\left(q_i^{2} + F_i q_i (1 - q_i)\\right)$$\n现在我们代入给定的数值：\n- $N = 68,000,000$\n- $\\pi = 0.8$\n- 分层 1：$w_1 = 0.60$，$q_1 = 0.004$，$F_1 = 0$\n- 分层 2：$w_2 = 0.35$，$q_2 = 0.002$，$F_2 = 0.01$\n- 分层 3：$w_3 = 0.05$，$q_3 = 0.03$，$F_3 = 0.02$\n\n我们计算每个分层在求和号内的项：\n对于分层 1：\n$$w_1 \\left(q_1^{2} + F_1 q_1 (1 - q_1)\\right) = 0.60 \\left( (0.004)^{2} + 0 \\cdot (0.004)(1-0.004) \\right) = 0.60 \\cdot (0.000016) = 0.0000096$$\n对于分层 2：\n$$w_2 \\left(q_2^{2} + F_2 q_2 (1 - q_2)\\right) = 0.35 \\left( (0.002)^{2} + (0.01)(0.002)(1-0.002) \\right)$$\n$$= 0.35 \\left( 0.000004 + 0.00002 \\cdot 0.998 \\right) = 0.35 \\left( 0.000004 + 0.00001996 \\right) = 0.35 \\cdot (0.00002396) \\approx 0.000008386$$\n对于分层 3：\n$$w_3 \\left(q_3^{2} + F_3 q_3 (1 - q_3)\\right) = 0.05 \\left( (0.03)^{2} + (0.02)(0.03)(1-0.03) \\right)$$\n$$= 0.05 \\left( 0.0009 + 0.0006 \\cdot 0.97 \\right) = 0.05 \\left( 0.0009 + 0.000582 \\right) = 0.05 \\cdot (0.001482) = 0.0000741$$\n这些项的总和是：\n$$\\sum_{i=1}^{3} (\\dots) = 0.0000096 + 0.000008386 + 0.0000741 = 0.000092086$$\n这个总和代表了在各分层间平均的 AR 纯合子基因型的总体人群频率。现在，我们计算患病个体的总期望数量：\n$$E[X] = N \\pi \\cdot (0.000092086) = 68,000,000 \\cdot 0.8 \\cdot 0.000092086$$\n$$E[X] = 54,400,000 \\cdot 0.000092086 = 5009.4784$$\n将最终答案四舍五入到四位有效数字，得到 $5009$。\n\n关于人口异质性的影响：汇总估计值是通过将每个分层的预期病例数相加得出的。这种方法是必要的，因为疾病的患病率是其底层遗传参数（特别是等位基因频率 $q_i$ 和近交系数 $F_i$）的非线性函数。总预期病例数与各分层特定患病率的加权平均值 $\\sum w_i P_{\\text{aff},i}$ 成正比。一个朴素的方法可能是首先对各分层的参数进行平均（例如 $\\bar{q} = \\sum w_i q_i$，$\\bar{F} = \\sum w_i F_i$），然后为整个人群计算一个单一的患病率估计值。这将是错误的，并且会产生不同的结果，因为对于一个非线性函数 $f$，通常有 $\\sum w_i f(q_i, F_i) \\neq f(\\sum w_i q_i, \\sum w_i F_i)$。\n主要的非线性项是 $q_i^2$。由于函数 $x \\mapsto x^2$ 的凸性，根据詹森不等式，平方的加权平均值大于或等于加权平均值的平方：$\\sum w_i q_i^2 \\ge (\\sum w_i q_i)^2$。这意味着忽略分层并使用平均等位基因频率通常会低估纯合子的数量（这被称为瓦伦德效应）。在这个问题中，分层3的等位基因频率（$q_3=0.03$）和近交系数（$F_3=0.02$）远高于其他分层。虽然它只占总人口的 $5\\%$，但它对总体基因型频率的贡献（$0.0000741$）远大于其他两个分层的总和（$0.0000096 + 0.000008386 = 0.000017986$）。因此，异质性使得规模小的高风险亚群能够对总疾病负担做出不成比例的贡献，而这种效应只有通过正确地逐个分层汇总才能捕捉到。", "answer": "$$\\boxed{5009}$$", "id": "5072569"}, {"introduction": "从确定患者群体规模，我们转向开发治疗方法。本练习聚焦于基因治疗中的一个核心挑战：确定正确的治疗剂量。通过对病毒载体如何将基因递送至细胞，以及这如何转化为治疗性蛋白表达的过程进行建模，您将计算出达到疗效所需的最小有效剂量，这是将一个有前景的疗法从临床前模型成功转化到人体试验的关键一步。[@problem_id:5072512]", "problem": "一种罕见的单基因肝脏代谢疾病需要恢复最低比例的正常肝酶活性才能获得临床效益。考虑一种腺相关病毒 (AAV) 基因添加疗法，该疗法以剂量 $D$（单位为病毒载体基因组/千克，写作 vg/kg）向患者递送病毒载体基因组。假设遵循以下基本原则和事实：\n\n- 分子生物学的中心法则指出，在肝细胞中实现转录和翻译的基因递送会产生酶，一旦平均组织酶活性达到正常值的一个阈值分数，就会发生表型校正。\n- 对于 AAV 载体对肝细胞的转导，每个肝细胞递送的病毒载体基因组数量 $K$，可以用均值为 $\\lambda$ 的泊松随机变量很好地建模。平均递送复数与剂量成线性关系，因此 $\\lambda = \\alpha_{\\text{human}} D$，其中 $\\alpha_{\\text{human}}$ 是人类中每个剂量的转导参数。\n- 接收到至少一个功能性病毒载体基因组的肝细胞所表达的治疗性酶，其活性接近一个由启动子决定的平台期水平，等于 $\\gamma E_{\\text{norm}}$，其中 $E_{\\text{norm}}$ 是每个肝细胞的正常（健康）平均酶活性，$0  \\gamma \\le 1$。额外的病毒载体基因组不会使酶表达超过这个平台期水平。未被转导的肝细胞产生的治疗性酶为 0。\n- 从非人灵长类动物到人类的转化效率会因一个缩放因子 $s \\in (0,1)$ 而降低，因此 $\\alpha_{\\text{human}} = s \\alpha_{\\text{NHP}}$，其中 $\\alpha_{\\text{NHP}}$ 是非人灵长类动物的校准常数。\n\n给出以下从临床前校准和启动子表征中得出的科学上合理的参数值：\n- $\\alpha_{\\text{NHP}} = 3.5 \\times 10^{-14}$，\n- $s = 0.63$，\n- $\\gamma = 0.65$，\n- 临床效益的治疗阈值为 $\\theta = 0.35$，意味着平均肝脏活性必须至少为 $\\theta E_{\\text{norm}}$。\n\n使用这些假设和参数值，从第一性原理推导平均肝酶活性作为剂量 $D$ 的函数的表达式，并确定使得平均活性达到阈值 $\\theta E_{\\text{norm}}$ 的最小剂量 $D$（单位 vg/kg）。将最终数值结果四舍五入至三位有效数字。剂量以病毒载体基因组/千克 (vg/kg) 表示。", "solution": "题目要求推导平均肝酶活性作为剂量 $D$ 的函数的表达式，并求出达到治疗阈值所需的最小剂量 $D$。第一步是验证问题陈述的有效性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 基因疗法的剂量：$D$，单位为病毒载体基因组/千克 (vg/kg)。\n- 每个肝细胞递送的病毒载体基因组数量：$K$。\n- $K$ 是一个均值为 $\\lambda$ 的泊松随机变量。\n- 平均递送复数：$\\lambda = \\alpha_{\\text{human}} D$。\n- 含有 $K \\geq 1$ 个基因组的肝细胞中的酶表达：$\\gamma E_{\\text{norm}}$。\n- 含有 $K = 0$ 个基因组的肝细胞中的酶表达：$0$。\n- $E_{\\text{norm}}$ 是每个肝细胞的正常平均酶活性。\n- $0  \\gamma \\le 1$ 是一个由启动子决定的平台期因子。\n- 转化效率缩放：$\\alpha_{\\text{human}} = s \\alpha_{\\text{NHP}}$，其中 $s \\in (0,1)$。\n- 平均肝活性的治疗阈值：$\\theta E_{\\text{norm}}$。\n- 参数值：\n  - $\\alpha_{\\text{NHP}} = 3.5 \\times 10^{-14}$\n  - $s = 0.63$\n  - $\\gamma = 0.65$\n  - $\\theta = 0.35$\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，借鉴了分子生物学（中心法则）、病毒学（AAV 转导）和概率论（泊松分布）的原理。使用泊松模型来模拟病毒颗粒递送至细胞等随机、独立事件，是基因治疗建模领域中一个标准且广为接受的假设。将非人灵长类动物 (NHP) 模型的功效外推至人类的概念是转化医学中一个关键且现实的方面。该问题提法得当，提供了所有必要的参数和明确的目标。语言精确、客观。没有矛盾之处，不依赖伪科学，并且所提供的参数被声明为科学上是合理的。该问题是可形式化的，并且需要实质性的推理。\n\n**步骤 3：结论与行动**\n该问题有效。将推导一个完整的解。\n\n### 解题推导\n\n设 $K$ 为表示递送到单个肝细胞的病毒载体基因组数量的随机变量。题目指出 $K$ 服从均值为 $\\lambda$ 的泊松分布。其概率质量函数由下式给出：\n$$\nP(K=k) = \\frac{\\lambda^k e^{-\\lambda}}{k!} \\quad \\text{for } k=0, 1, 2, \\dots\n$$\n单个肝细胞中的酶活性（我们可表示为 $E$）是 $K$ 的函数。根据题目描述：\n- 如果 $K=0$（细胞未被转导），则活性为 $E=0$。\n- 如果 $K \\geq 1$（细胞被转导），则活性为 $E = \\gamma E_{\\text{norm}}$。\n\n平均肝酶活性 $\\langle E \\rangle$ 是 $E$ 在整个肝细胞群体中的期望值。我们可以使用全期望定律来计算：\n$$\n\\langle E \\rangle = E[E] = (0) \\cdot P(K=0) + (\\gamma E_{\\text{norm}}) \\cdot P(K \\geq 1)\n$$\n一个肝细胞接收到零个病毒载体基因组（$K=0$）的概率可从泊松分布中求得：\n$$\nP(K=0) = \\frac{\\lambda^0 e^{-\\lambda}}{0!} = e^{-\\lambda}\n$$\n一个肝细胞接收到至少一个病毒载体基因组的概率是接收到零个基因组概率的补集：\n$$\nP(K \\geq 1) = 1 - P(K=0) = 1 - e^{-\\lambda}\n$$\n这一项 $1 - e^{-\\lambda}$ 代表成功被转导的肝细胞的比例。\n\n将此代入平均活性 $\\langle E \\rangle$ 的表达式中：\n$$\n\\langle E \\rangle = (\\gamma E_{\\text{norm}}) (1 - e^{-\\lambda})\n$$\n题目指出平均复数 $\\lambda$ 是剂量 $D$ 的函数。具体来说，$\\lambda = \\alpha_{\\text{human}} D$，而人类特异性参数 $\\alpha_{\\text{human}}$ 通过缩放因子 $s$ 与 NHP 参数 $\\alpha_{\\text{NHP}}$ 相关联：$\\alpha_{\\text{human}} = s \\alpha_{\\text{NHP}}$。因此，我们可以用 $D$ 和给定的临床前参数来表示 $\\lambda$：\n$$\n\\lambda = s \\alpha_{\\text{NHP}} D\n$$\n将此代入我们的平均活性方程，得到所需的平均肝酶活性作为剂量 $D$ 的函数的表达式：\n$$\n\\langle E \\rangle(D) = \\gamma E_{\\text{norm}} \\left(1 - \\exp(-s \\alpha_{\\text{NHP}} D)\\right)\n$$\n这是所需推导的第一部分。\n\n接下来，我们必须找到最小剂量 $D$，使得平均活性达到或超过治疗阈值 $\\theta E_{\\text{norm}}$。我们将平均活性设为等于阈值：\n$$\n\\langle E \\rangle(D) = \\theta E_{\\text{norm}}\n$$\n$$\n\\gamma E_{\\text{norm}} \\left(1 - \\exp(-s \\alpha_{\\text{NHP}} D)\\right) = \\theta E_{\\text{norm}}\n$$\n$E_{\\text{norm}}$ 项出现在等式两边，并且由于它非零，可以消掉：\n$$\n\\gamma \\left(1 - \\exp(-s \\alpha_{\\text{NHP}} D)\\right) = \\theta\n$$\n现在我们求解这个关于 $D$ 的方程：\n$$\n1 - \\exp(-s \\alpha_{\\text{NHP}} D) = \\frac{\\theta}{\\gamma}\n$$\n$$\n\\exp(-s \\alpha_{\\text{NHP}} D) = 1 - \\frac{\\theta}{\\gamma}\n$$\n对两边取自然对数：\n$$\n-s \\alpha_{\\text{NHP}} D = \\ln\\left(1 - \\frac{\\theta}{\\gamma}\\right)\n$$\n最后，分离出 $D$：\n$$\nD = -\\frac{1}{s \\alpha_{\\text{NHP}}} \\ln\\left(1 - \\frac{\\theta}{\\gamma}\\right)\n$$\n这就是所需最小剂量的符号表达式。\n\n现在，我们代入给定的数值：\n- $\\alpha_{\\text{NHP}} = 3.5 \\times 10^{-14}$\n- $s = 0.63$\n- $\\gamma = 0.65$\n- $\\theta = 0.35$\n\n首先，计算分母中的乘积：\n$$\ns \\alpha_{\\text{NHP}} = (0.63) \\cdot (3.5 \\times 10^{-14}) = 2.205 \\times 10^{-14}\n$$\n接下来，计算对数内的项：\n$$\n1 - \\frac{\\theta}{\\gamma} = 1 - \\frac{0.35}{0.65} = 1 - \\frac{35}{65} = 1 - \\frac{7}{13} = \\frac{6}{13}\n$$\n现在，将这些值代入 $D$ 的表达式中：\n$$\nD = -\\frac{1}{2.205 \\times 10^{-14}} \\ln\\left(\\frac{6}{13}\\right)\n$$\n计算对数的值：\n$$\n\\ln\\left(\\frac{6}{13}\\right) \\approx -0.77318041\n$$\n代入这个数值：\n$$\nD \\approx -\\frac{1}{2.205 \\times 10^{-14}} (-0.77318041)\n$$\n$$\nD \\approx \\frac{0.77318041}{2.205 \\times 10^{-14}} \\approx 3.506487 \\times 10^{13}\n$$\n题目要求将最终结果四舍五入到三位有效数字。\n$$\nD \\approx 3.51 \\times 10^{13}\n$$\n剂量 $D$ 的单位是病毒载体基因组/千克 (vg/kg)。", "answer": "$$\\boxed{3.51 \\times 10^{13}}$$", "id": "5072512"}, {"introduction": "设计出一种疗法后，我们必须在临床试验中对其进行评估。本练习旨在解决在患者人数极少的情况下评估治疗效果的难题。它将向您介绍贝叶斯框架，这是一个强大的统计工具，能够将先验知识与新的试验数据相结合，以做出明智的“继续/终止”决策，这对于罕见病领域高效且合乎伦理的药物开发至关重要。[@problem_id:5072530]", "problem": "一项针对某种罕见病的单臂、早期研究评估了一种靶向治疗的客观缓解率 $\\theta$，其中患者招募因人群规模小而受到限制。先验信息从机制相似的基因型中汇总而来，得出了一个关于 $\\theta$ 的先验分布，该分布被建模为 $\\operatorname{Beta}(\\alpha,\\beta)$ 分布，反映了来自具有转化相关性的历史证据中的 $\\alpha-1$ 个伪缓解者和 $\\beta-1$ 个伪无缓解者。在当前试验中，招募了 $n$ 名患者，观察到 $k$ 例客观缓解。假设每位患者的响应服从伯努利模型，患者之间相互独立，响应概率为 $\\theta$，并且在给定 $\\theta$ 的条件下，$k$ 的抽样模型为二项分布。\n\n采用了一个决策框架，其中预先指定了具有临床意义的阈值 $\\theta^{\\star}$（例如，支持进入后期开发的最低缓解率），“继续/终止”规则基于后验概率 $\\theta \\ge \\theta^{\\star}$。为了支持与监管机构和利益相关者的沟通，计算了 $\\theta$ 的水平为 $1-\\gamma$ 的等尾可信区间。\n\n仅从贝叶斯定理、二项似然和 $\\operatorname{Beta}$ 分布的定义出发，推导在给定数据 $k,n$ 和先验 $\\operatorname{Beta}(\\alpha,\\beta)$ 的情况下 $\\theta$ 的后验分布。然后，推导等尾 $1-\\gamma$ 可信区间的端点 $L$ 和 $U$ 的精确表达式，以及后验尾部概率 $\\Pr(\\theta \\ge \\theta^{\\star} \\mid k,n,\\alpha,\\beta)$ 的精确表达式。如果需要，您可以使用正则化不完全贝塔函数及其反函数来表示您的答案。将最终答案以单行矩阵的形式给出这三个量 $L$, $U$ 和 $\\Pr(\\theta \\ge \\theta^{\\star} \\mid k,n,\\alpha,\\beta)$。不需要进行数值计算，也不需要四舍五入。请以闭合形式精确表达您的最终答案。", "solution": "该问题要求推导未知响应率 $\\theta$ 的后验分布，然后推导其等尾可信区间和后验尾部概率。该问题是有效的，因为它基于标准的贝叶斯统计理论，具有充分的信息且问题表述适定，并使用了客观、正式的语言。唯一解所需的所有组成部分都已提供。\n\n贝叶斯框架包括参数 $\\theta$ 的先验分布、观测数据的似然函数，以及应用贝叶斯定理来获得后验分布。\n\n首先，我们按照指定定义各个组成部分。\n感兴趣的参数是客观缓解率 $\\theta$，其中 $\\theta \\in [0, 1]$。\n$\\theta$ 的先验分布给定为贝塔分布，$\\theta \\sim \\operatorname{Beta}(\\alpha, \\beta)$。其概率密度函数 (PDF) 为：\n$$\np(\\theta | \\alpha, \\beta) = \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)}\n$$\n其中 $B(\\alpha, \\beta) = \\int_0^1 u^{\\alpha-1}(1-u)^{\\beta-1} du$ 是贝塔函数，它作为归一化常数。\n\n数据包括在 $n$ 名入组患者中观察到的 $k$ 例响应。问题指定了每个患者服从伯努利响应模型，这导致总响应数 $k$ 服从二项抽样模型。似然函数是在给定 $n$ 名患者和响应率 $\\theta$ 的情况下观察到 $k$ 例响应的概率：\n$$\nL(\\theta | k, n) = P(k | n, \\theta) = \\binom{n}{k} \\theta^k (1-\\theta)^{n-k}\n$$\n\n根据贝叶斯定理，给定数据 $(k, n)$ 和先验参数 $(\\alpha, \\beta)$ 时，$\\theta$ 的后验分布与似然函数和先验分布的乘积成正比：\n$$\np(\\theta | k, n, \\alpha, \\beta) \\propto L(\\theta | k, n) \\times p(\\theta | \\alpha, \\beta)\n$$\n代入似然函数和先验分布的表达式：\n$$\np(\\theta | k, n, \\alpha, \\beta) \\propto \\left[ \\binom{n}{k} \\theta^k (1-\\theta)^{n-k} \\right] \\times \\left[ \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)} \\right]\n$$\n在这个比例关系中，我们可以忽略任何不依赖于 $\\theta$ 的项，因为它们是后验分布归一化常数的一部分。因此，我们可以写成：\n$$\np(\\theta | k, n, \\alpha, \\beta) \\propto \\theta^k (1-\\theta)^{n-k} \\times \\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}\n$$\n合并同底数的项：\n$$\np(\\theta | k, n, \\alpha, \\beta) \\propto \\theta^{k+\\alpha-1} (1-\\theta)^{n-k+\\beta-1}\n$$\n这个表达式是贝塔分布的核（PDF中依赖于变量的部分）。我们可以通过观察来识别这个后验贝塔分布的参数。设后验参数为 $\\alpha_{\\text{post}}$ 和 $\\beta_{\\text{post}}$。与贝塔分布PDF的一般形式 $p(\\theta) \\propto \\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}$ 相比，我们发现：\n$$\n\\alpha_{\\text{post}} = \\alpha + k\n$$\n$$\n\\beta_{\\text{post}} = \\beta + n - k\n$$\n因此，$\\theta$ 的后验分布是一个贝塔分布：\n$$\n\\theta | k, n, \\alpha, \\beta \\sim \\operatorname{Beta}(\\alpha+k, \\beta+n-k)\n$$\n完整的后验概率密度函数是：\n$$\np(\\theta | k, n, \\alpha, \\beta) = \\frac{\\theta^{\\alpha+k-1}(1-\\theta)^{\\beta+n-k-1}}{B(\\alpha+k, \\beta+n-k)}\n$$\n这种后验分布与先验分布属于同一分布族的性质称为共轭性。贝塔分布是二项似然的共轭先验。\n\n接下来，我们推导等尾 $1-\\gamma$ 可信区间的端点 $L$ 和 $U$ 的表达式。可信区间是根据后验分布，一个未观测到的参数值以特定概率落入的范围。对于等尾区间，我们在每个尾部放置 $\\gamma/2$ 的后验概率质量。端点 $L$ 和 $U$ 定义为：\n$$\n\\Pr(\\theta \\le L \\mid k,n,\\alpha,\\beta) = \\frac{\\gamma}{2}\n$$\n$$\n\\Pr(\\theta \\ge U \\mid k,n,\\alpha,\\beta) = \\frac{\\gamma}{2} \\quad \\text{即} \\quad \\Pr(\\theta \\le U \\mid k,n,\\alpha,\\beta) = 1 - \\frac{\\gamma}{2}\n$$\n$\\operatorname{Beta}(a,b)$ 分布的累积分布函数 (CDF) 由正则化不完全贝塔函数给出，$I_x(a,b) = \\frac{B(x;a,b)}{B(a,b)}$，其中 $B(x;a,b)$ 是不完全贝塔函数。因此，对于我们的后验分布 $\\operatorname{Beta}(\\alpha+k, \\beta+n-k)$，其CDF为 $F(\\theta_0) = I_{\\theta_0}(\\alpha+k, \\beta+n-k)$。\n使用CDF，$L$ 和 $U$ 的条件变为：\n$$\nI_L(\\alpha+k, \\beta+n-k) = \\frac{\\gamma}{2}\n$$\n$$\nI_U(\\alpha+k, \\beta+n-k) = 1 - \\frac{\\gamma}{2}\n$$\n为了找到 $L$ 和 $U$，我们必须使用正则化不完全贝塔函数关于其第一个参数的反函数，也就是贝塔分布的分位数函数。我们用 $I^{-1}(p, a, b)$ 来表示这个反函数，它给出的值 $x$ 满足 $I_x(a,b)=p$。应用这个反函数，我们得到 $L$ 和 $U$ 的表达式：\n$$\nL = I^{-1}\\left(\\frac{\\gamma}{2}, \\alpha+k, \\beta+n-k\\right)\n$$\n$$\nU = I^{-1}\\left(1-\\frac{\\gamma}{2}, \\alpha+k, \\beta+n-k\\right)\n$$\n\n最后，我们推导后验尾部概率 $\\Pr(\\theta \\ge \\theta^{\\star} \\mid k,n,\\alpha,\\beta)$ 的精确表达式。这个概率用于“继续/终止”决策。\n这个概率可以计算为 1 减去截至 $\\theta^{\\star}$ 的累积概率：\n$$\n\\Pr(\\theta \\ge \\theta^{\\star} \\mid k,n,\\alpha,\\beta) = 1 - \\Pr(\\theta  \\theta^{\\star} \\mid k,n,\\alpha,\\beta)\n$$\n由于 $\\theta$ 的后验分布是连续的，$\\Pr(\\theta  \\theta^{\\star}) = \\Pr(\\theta \\le \\theta^{\\star})$。后者就是后验CDF在 $\\theta^{\\star}$ 处的值：\n$$\n\\Pr(\\theta \\le \\theta^{\\star} \\mid k,n,\\alpha,\\beta) = I_{\\theta^{\\star}}(\\alpha+k, \\beta+n-k)\n$$\n因此，后验尾部概率为：\n$$\n\\Pr(\\theta \\ge \\theta^{\\star} \\mid k,n,\\alpha,\\beta) = 1 - I_{\\theta^{\\star}}(\\alpha+k, \\beta+n-k)\n$$\n\n所需的三个量是 $L$、$U$ 和 $\\Pr(\\theta \\ge \\theta^{\\star} \\mid k,n,\\alpha,\\beta)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} I^{-1}\\left(\\frac{\\gamma}{2}, \\alpha+k, \\beta+n-k\\right)  I^{-1}\\left(1-\\frac{\\gamma}{2}, \\alpha+k, \\beta+n-k\\right)  1 - I_{\\theta^{\\star}}(\\alpha+k, \\beta+n-k) \\end{pmatrix}}\n$$", "id": "5072530"}]}