{"hands_on_practices": [{"introduction": "评估任何传播工作的首要步骤是衡量其覆盖范围。本练习 [@problem_id:5010777] 介绍了源自广泛使用的 RE-AIM 框架中的“传播覆盖率”概念。通过聚焦于一个精确的操作性定义，你将练习计算这一基本指标，并学习在评估场景中区分相关数据与无关信息的关键技能。", "problem": "一个转化医学团队正在评估一项针对特定临床医生网络的定制临床实践公告的传播策略。遵循标准项目评估原则，例如在“覆盖面、有效性、采纳度、实施和维持”（RE-AIM）框架中编码的原则，将传播覆盖面定义为在预设的观察窗口内至少接触过一次信息的预期受众比例。接触被操作化定义为至少打开一次公告，由消息系统日志中记录的独立打开事件为准；完全阅读公告（以完整滚动或页面停留时间阈值衡量）是接触的一个子集。设预期受众规模为 $N$，接触过的临床医生集合为 $E \\subseteq \\{1,\\dots,N\\}$，传播覆盖面为 $r = \\frac{|E|}{N}$。\n\n在一个为期两周的观察窗口中，该团队的目标受众是 $N = 10{,}000$ 名临床医生。系统日志报告了 $3{,}200$ 次独立的公告打开事件，其中 $2{,}400$ 次被记录为完全阅读了公告。所有计数在整个观察窗口内均在临床医生层面进行了去重处理。\n\n仅使用上述传播覆盖面的定义，不引入任何其他操作化定义，计算传播覆盖面 $r$。将您的答案表示为小数，并四舍五入到四位有效数字。", "solution": "用户提供了一个需要遵循严格验证和格式化协议来解决的问题。\n\n### 第1步：提取已知条件\n问题陈述中逐字给出的已知条件是：\n- 传播覆盖面定义为“在预设的观察窗口内至少接触过一次信息的预期受众比例”。\n- “接触被操作化定义为至少打开一次公告，由消息系统日志中记录的独立打开事件为准”。\n- “完全阅读公告……是接触的一个子集。”\n- 预期受众规模为 $N$。\n- 接触过的临床医生集合为 $E \\subseteq \\{1,\\dots,N\\}$。\n- 传播覆盖面为 $r = \\frac{|E|}{N}$。\n- 预期受众规模为 $N = 10{,}000$ 名临床医生。\n- 系统日志报告了 $3{,}200$ 次独立的公告打开事件。\n- 在这些独立的打开事件中，有 $2{,}400$ 次被记录为完全阅读了公告。\n- 约束条件是“仅使用上述传播覆盖面的定义，不引入任何其他操作化定义，计算传播覆盖面 $r$”。\n- 最终答案必须表示为“小数，并四舍五入到四位有效数字”。\n\n### 第2步：使用提取的已知条件进行验证\n根据所需标准对问题进行验证。\n- **科学依据**：该问题基于项目评估和转化科学的原则，特别是使用了RE-AIM框架中的概念。术语和定量方法在该领域是标准的。它在科学上是合理的。\n- **适定性**：该问题提供了清晰的定义、精确的公式以及计算唯一解所需的所有数据。\n- **客观性**：语言清晰、精确，没有主观论断。\n\n该问题没有表现出任何列出的缺陷：\n1.  **科学或事实不健全**：该问题在逻辑上是一致的，并遵循了比例的基本数学原理。\n2.  **不可形式化或不相关**：该问题是一个可形式化的计算，直接涉及传播策略的主题。\n3.  **不完整或矛盾的设置**：该问题是自洽的。它提供了所有必要的数据（$N$ 和 $|E|$ 的计数）。它也提供了无关数据（完全阅读公告的临床医生数量），但这并不构成矛盾。相反，它旨在测试解题者严格遵守给定的“覆盖面”操作化定义的能力，该定义基于“接触”（打开次数），而非“完全阅读”。问题明确指示用户仅使用所提供的定义，从而强调了这一点。\n4.  **不切实际或不可行**：在大规模健康传播活动的背景下，这些数字是合理的。\n5.  **不适定或结构不良**：定义是明确的。“独立打开事件”直接对应于接触过的临床医生集合的大小，即 $|E|$。\n6.  **伪深刻、琐碎或同义反复**：该问题简单明了，但需要仔细阅读以正确识别相关数据，这是对理解能力的有效测试。\n7.  **无法进行科学验证**：该计算可直接验证。\n\n### 第3步：结论与行动\n该问题是**有效的**。将提供解答。\n\n### 解答\n问题要求计算传播覆盖面，用 $r$ 表示。问题陈述提供了精确的操作化定义和相应的公式。\n\n传播覆盖面的计算公式如下：\n$$r = \\frac{|E|}{N}$$\n其中：\n- $N$ 是预期受众的总规模。\n- $E$ 是接触到信息的临床医生集合。\n- $|E|$ 是集合 $E$ 中独立临床医生的数量。\n\n根据问题陈述，预期受众规模为 $N = 10{,}000$。\n\n“接触”的定义被操作化为“至少打开一次公告，由独立打开事件记录”。问题陈述指出，公告有 $3{,}200$ 次独立的打开事件。由于这些数据在临床医生层面进行了去重处理，这个数字直接对应于接触到信息的独立临床医生的数量。因此，接触过的临床医生集合的大小为 $|E| = 3{,}200$。\n\n关于 $2{,}400$ 名临床医生“完全阅读了公告”的信息被明确指出是接触的一个子集。问题的约束条件是“仅使用上述传播覆盖面的定义”，该定义基于接触（打开次数），而非完全阅读。因此，$2{,}400$ 这个数字与覆盖面的计算无关，必须忽略。\n\n将正确的值代入覆盖面公式：\n$$r = \\frac{3{,}200}{10{,}000}$$\n计算此分数值可得：\n$$r = 0.32$$\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。计算出的值 $0.32$ 有两位有效数字（“3”和“2”）。要用四位有效数字表示，我们必须在后面添加零。\n$$r = 0.3200$$", "answer": "$$\n\\boxed{0.3200}\n$$", "id": "5010777"}, {"introduction": "传播侧重于信息的扩散，而实施则关注信息的采纳和使用。本练习 [@problem_id:5010830] 深入探讨了两个关键但截然不同的实施结果：服务提供者层面的“采纳”与患者层面的“渗透”。你将学习如何运用容斥原理处理多中心数据汇总的复杂性，这是进行稳健、真实的 D 评估的一项至关重要的技能。", "problem": "一个区域性综合医疗服务网络在其推广的第二季度，于三家医院实施了一项基于证据的过渡期心力衰竭护理包（Transitional Heart Failure Care Bundle）。传播与实施（Dissemination and Implementation, DI）计划明确区分了提供者层面的采纳（adoption）与患者层面的渗透（penetration）。为进行此项评估，我们采用以下源自实施结果框架的基本定义：采纳是指在此期间至少一次开始使用该干预措施的合格提供者的比例，而渗透是指在此期间实际接受了该干预措施的合格患者的比例。在提供者层面，合格标准要求完成培训，并拥有一组符合预定标准的心力衰竭患者活跃名单；在患者层面，合格标准要求是心力衰竭患者出院回家，无禁忌症，且风险评分高于某一阈值。\n\n标记为 $A$、$B$ 和 $C$ 的三家医院提供了第二季度的数据。由于提供者可能在多家医院工作，患者也可能被转院，因此必须使用针对各家医院的容斥原理来剔除重复计数。以下所有计数均指每家医院指定集合中的独立个体数量。\n\n提供者合格计数：\n- 医院 $A$：$|E_{A}| = 40$\n- 医院 $B$：$|E_{B}| = 35$\n- 医院 $C$：$|E_{C}| = 25$\n- 两两重叠部分：$|E_{A} \\cap E_{B}| = 10$，$|E_{B} \\cap E_{C}| = 5$，$|E_{A} \\cap E_{C}| = 2$\n- 三重重叠部分：$|E_{A} \\cap E_{B} \\cap E_{C}| = 1$\n\n在合格提供者中，启动计数（第二季度在指定医院至少使用一次）：\n- $|I_{A}| = 22$，$|I_{B}| = 18$，$|I_{C}| = 15$\n- 启动者两两交集：$|I_{A} \\cap I_{B}| = 8$，$|I_{B} \\cap I_{C}| = 4$，$|I_{A} \\cap I_{C}| = 1$\n- 启动者三重交集：$|I_{A} \\cap I_{B} \\cap I_{C}| = 1$\n\n患者合格计数：\n- 医院 $A$：$|P_{A}| = 520$\n- 医院 $B$：$|P_{B}| = 430$\n- 医院 $C$：$|P_{C}| = 280$\n- 两两重叠部分：$|P_{A} \\cap P_{B}| = 60$，$|P_{B} \\cap P_{C}| = 45$，$|P_{A} \\cap P_{C}| = 25$\n- 三重重叠部分：$|P_{A} \\cap P_{B} \\cap P_{C}| = 12$\n\n在合格患者中，接受计数（第二季度在指定医院接受了护理包）：\n- $|R_{A}| = 310$，$|R_{B}| = 250$，$|R_{C}| = 160$\n- 接受者两两交集：$|R_{A} \\cap R_{B}| = 40$，$|R_{B} \\cap R_{C}| = 30$，$|R_{A} \\cap R_{C}| = 20$\n- 接受者三重交集：$|R_{A} \\cap R_{B} \\cap R_{C}| = 10$\n\n假设根据第二季度的定义，所有启动者都是合格提供者，所有接受者都是合格患者。请计算系统层面的采纳率和渗透率，以小数比例表示，其分子和分母分别使用各医院的并集。使用容斥原理来获取唯一计数。将采纳率和渗透率均表示为小数，四舍五入到四位有效数字，不加百分号或任何物理单位。", "solution": "所述问题是有效的。它在实施科学领域有科学依据，提出了一个基于集合论的适定数学任务，并提供了所有必要数据且无内部矛盾。所有数据都是一致的；例如，任何集合交集的基数都不大于该交集所涉及的任何单个集合的基数。采纳和渗透的定义已经给出，并且在相关文献中是标准定义。任务是使用提供的数据和容斥原理来计算系统层面的采纳率和渗透率这两个指标。\n\n系统层面指标的定义如下：\n采纳率是整个系统中启动干预措施的唯一合格提供者的比例。\n$$ \\text{Adoption} = \\frac{|\\text{Total unique initiators}|}{|\\text{Total unique eligible providers}|} $$\n渗透率是整个系统中接受干预措施的唯一合格患者的比例。\n$$ \\text{Penetration} = \\frac{|\\text{Total unique recipients}|}{|\\text{Total unique eligible patients}|} $$\n\n为了找出每个类别（合格提供者、启动者、合格患者、接受者）中的唯一独立个体总数，我们必须计算与三家医院（标记为 $A$、$B$ 和 $C$）相对应的集合的并集的基数。三个集合 $S_A$、$S_B$ 和 $S_C$ 的容斥原理表述如下：\n$$ |S_A \\cup S_B \\cup S_C| = |S_A| + |S_B| + |S_C| - (|S_A \\cap S_B| + |S_B \\cap S_C| + |S_A \\cap S_C|) + |S_A \\cap S_B \\cap S_C| $$\n\n我们将把这个原理应用于四个组中的每一个。\n\n首先，我们计算唯一合格提供者的总数，记为 $|E_{\\text{total}}|$。这些集合是 $E_A$、$E_B$ 和 $E_C$。\n给定数据为：\n$|E_{A}| = 40$\n$|E_{B}| = 35$\n$|E_{C}| = 25$\n$|E_{A} \\cap E_{B}| = 10$\n$|E_{B} \\cap E_{C}| = 5$\n$|E_{A} \\cap E_{C}| = 2$\n$|E_{A} \\cap E_{B} \\cap E_{C}| = 1$\n\n应用容斥原理：\n$$ |E_{\\text{total}}| = |E_A \\cup E_B \\cup E_C| = |E_A| + |E_B| + |E_C| - (|E_A \\cap E_B| + |E_B \\cap E_C| + |E_A \\cap E_C|) + |E_A \\cap E_B \\cap E_C| $$\n$$ |E_{\\text{total}}| = 40 + 35 + 25 - (10 + 5 + 2) + 1 $$\n$$ |E_{\\text{total}}| = 100 - 17 + 1 = 84 $$\n因此，系统中有 $84$ 名唯一合格提供者。\n\n其次，我们计算启动干预措施的唯一提供者总数，记为 $|I_{\\text{total}}|$。这些集合是 $I_A$、$I_B$ 和 $I_C$。\n给定数据为：\n$|I_{A}| = 22$\n$|I_{B}| = 18$\n$|I_{C}| = 15$\n$|I_{A} \\cap I_{B}| = 8$\n$|I_{B} \\cap I_{C}| = 4$\n$|I_{A} \\cap I_{C}| = 1$\n$|I_{A} \\cap I_{B} \\cap I_{C}| = 1$\n\n应用容斥原理：\n$$ |I_{\\text{total}}| = |I_A \\cup I_B \\cup I_C| = |I_A| + |I_B| + |I_C| - (|I_A \\cap I_B| + |I_B \\cap I_C| + |I_A \\cap I_C|) + |I_A \\cap I_B \\cap I_C| $$\n$$ |I_{\\text{total}}| = 22 + 18 + 15 - (8 + 4 + 1) + 1 $$\n$$ |I_{\\text{total}}| = 55 - 13 + 1 = 43 $$\n因此，有 $43$ 名唯一提供者启动了干预措施。\n\n系统层面的采纳率是 $|I_{\\text{total}}|$ 与 $|E_{\\text{total}}|$ 的比率：\n$$ \\text{Adoption} = \\frac{|I_{\\text{total}}|}{|E_{\\text{total}}|} = \\frac{43}{84} \\approx 0.51190476... $$\n四舍五入到四位有效数字，采纳率为 $0.5119$。\n\n第三，我们计算唯一合格患者的总数，记为 $|P_{\\text{total}}|$。这些集合是 $P_A$、$P_B$ 和 $P_C$。\n给定数据为：\n$|P_{A}| = 520$\n$|P_{B}| = 430$\n$|P_{C}| = 280$\n$|P_{A} \\cap P_{B}| = 60$\n$|P_{B} \\cap P_{C}| = 45$\n$|P_{A} \\cap P_{C}| = 25$\n$|P_{A} \\cap P_{B} \\cap P_{C}| = 12$\n\n应用容斥原理：\n$$ |P_{\\text{total}}| = |P_A \\cup P_B \\cup P_C| = |P_A| + |P_B| + |P_C| - (|P_A \\cap P_B| + |P_B \\cap P_C| + |P_A \\cap P_C|) + |P_A \\cap P_B \\cap P_C| $$\n$$ |P_{\\text{total}}| = 520 + 430 + 280 - (60 + 45 + 25) + 12 $$\n$$ |P_{\\text{total}}| = 1230 - 130 + 12 = 1112 $$\n因此，系统中有 $1112$ 名唯一合格患者。\n\n第四，我们计算接受干预措施的唯一患者总数，记为 $|R_{\\text{total}}|$。这些集合是 $R_A$、$R_B$ 和 $R_C$。\n给定数据为：\n$|R_{A}| = 310$\n$|R_{B}| = 250$\n$|R_{C}| = 160$\n$|R_{A} \\cap R_{B}| = 40$\n$|R_{B} \\cap R_{C}| = 30$\n$|R_{A} \\cap R_{C}| = 20$\n$|R_{A} \\cap R_{B} \\cap R_{C}| = 10$\n\n应用容斥原理：\n$$ |R_{\\text{total}}| = |R_A \\cup R_B \\cup R_C| = |R_A| + |R_B| + |R_C| - (|R_A \\cap R_B| + |R_B \\cap R_C| + |R_A \\cap R_C|) + |R_A \\cap R_B \\cap R_C| $$\n$$ |R_{\\text{total}}| = 310 + 250 + 160 - (40 + 30 + 20) + 10 $$\n$$ |R_{\\text{total}}| = 720 - 90 + 10 = 640 $$\n因此，有 $640$ 名唯一患者接受了干预措施。\n\n系统层面的渗透率是 $|R_{\\text{total}}|$ 与 $|P_{\\text{total}}|$ 的比率：\n$$ \\text{Penetration} = \\frac{|R_{\\text{total}}|}{|P_{\\text{total}}|} = \\frac{640}{1112} \\approx 0.57553956... $$\n四舍五入到四位有效数字，渗透率为 $0.5755$。\n\n最终结果是采纳率为 $0.5119$，渗透率为 $0.5755$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5119  0.5755 \\end{pmatrix}}\n$$", "id": "5010830"}, {"introduction": "高效的转化医学不仅需要衡量结果，还需要在有限的资源下做出战略选择以最大化影响力。这最后一个练习 [@problem_id:5010866] 让你扮演项目经理的角色，将策略选择构建为一个约束优化问题。通过应用 $0/1$ 背包模型，你将学习如何在给定预算内构建一个能最大化患者获益的最佳实施策略组合。", "problem": "您正在设计一个转化医学中的实施策略组合，其目标是将循证实践整合到常规临床护理中。为清晰起见，请区分传播策略（侧重于信息传播）和实施策略（侧重于改变临床系统以将证据采纳到实践中）。理性资源分配的基础是：独立、不重叠的策略的预期效果可以相加，成本呈线性相加。现有 $n$ 个候选策略，索引为 $i \\in \\{0,1,\\dots,n-1\\}$，每个策略都有一个估计效果 $e_i$（单位：人，解释为实现目标结果的预期额外患者人数）和一个成本 $c_i$（单位：美元 (USD)）。每个策略都由一个类型指示符 $d_i \\in \\{0,1\\}$ 标记，其中 $d_i=1$ 表示实施策略， $d_i=0$ 表示传播策略。您必须只选择实施策略。定义二进制决策变量 $x_i \\in \\{0,1\\}$，表示是否选择策略 $i$。预算约束为 $B=\\$500{,}000$。\n\n在可加性和独立性的基本假设下，您必须选择一个实施策略的子集，以在预算约束下最大化预期总效果。形式上，该优化问题为：\n$$\n\\max_{x_i \\in \\{0,1\\}} \\;\\; \\sum_{i=0}^{n-1} e_i x_i\n$$\n约束条件为\n$$\n\\sum_{i=0}^{n-1} c_i x_i \\le B,\\quad x_i \\le d_i \\;\\; \\text{for all } i.\n$$\n必须应用打破平局规则以确保得到唯一、可复现的解：在达到相同最大目标值的解中，选择总成本最小的解；如果仍然存在平局，选择其排序后的选中索引列表在字典序上最小的解。\n\n计算要求：将成本 $c_i$ 和预算 $B$ 视为 $\\$1{,}000$ 的整数倍。在内部，通过除以 $1{,}000$ 来缩放成本和预算，以便容量以 $\\$1{,}000$ 为单位进行度量。所有效果 $e_i$ 均为整数，预期总效果必须作为整数人数返回。\n\n实现一个程序，对于每个给定的测试用例，返回在上述约束和打破平局规则下的唯一最优实施策略选择。每个测试用例由以下内容指定：\n- 固定预算 $B=\\$500{,}000$。\n- 一个以美元计的 $c_i$ 列表，每个都是 $\\$1{,}000$ 的倍数。\n- 一个以人数计的 $e_i$ 列表（整数）。\n- 一个 $d_i \\in \\{0,1\\}$ 列表，指示策略类型（如果为 $1$ 则是实施策略，如果为 $0$ 则是传播策略）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个双元素列表 $[\\text{sorted\\_indices}, \\text{total\\_effect}]$。第一个元素 $\\text{sorted\\_indices}$ 是排序后的选中策略索引列表，第二个元素 $\\text{total\\_effect}$ 是整数和 $\\sum_i e_i x_i$。例如，三个用例的有效单行输出可能如下所示：$[[[0,1],350],[[2],220],[[1,3,4],780]]$。\n\n使用以下测试套件。在所有情况下，$B=\\$500{,}000$。\n\n测试用例 1 (混合类型的正常路径):\n- $c = [\\$120{,}000,\\; \\$80{,}000,\\; \\$60{,}000,\\; \\$200{,}000,\\; \\$150{,}000,\\; \\$90{,}000,\\; \\$110{,}000,\\; \\$140{,}000]$\n- $e = [240,\\; 150,\\; 90,\\; 430,\\; 300,\\; 200,\\; 220,\\; 260]$\n- $d = [1,\\; 1,\\; 0,\\; 1,\\; 0,\\; 1,\\; 1,\\; 1]$\n\n测试用例 2 (总实施成本等于预算的边界情况):\n- $c = [\\$125{,}000,\\; \\$75{,}000,\\; \\$150{,}000,\\; \\$150{,}000]$\n- $e = [200,\\; 120,\\; 190,\\; 230]$\n- $d = [1,\\; 1,\\; 1,\\; 1]$\n\n测试用例 3 (权衡：一个极高成本高效果的选项与几个中等选项的对比):\n- $c = [\\$500{,}000,\\; \\$120{,}000,\\; \\$120{,}000,\\; \\$120{,}000,\\; \\$120{,}000,\\; \\$50{,}000]$\n- $e = [900,\\; 260,\\; 255,\\; 250,\\; 200,\\; 80]$\n- $d = [1,\\; 1,\\; 1,\\; 1,\\; 1,\\; 1]$\n\n测试用例 4 (包含零成本实施策略的边缘情况):\n- $c = [\\$0,\\; \\$100{,}000,\\; \\$200{,}000,\\; \\$180{,}000,\\; \\$50{,}000]$\n- $e = [40,\\; 300,\\; 450,\\; 390,\\; 120]$\n- $d = [1,\\; 1,\\; 1,\\; 1,\\; 1]$\n\n测试用例 5 (用于检验字典序规则的平局情况):\n- $c = [\\$250{,}000,\\; \\$250{,}000,\\; \\$200{,}000,\\; \\$200{,}000,\\; \\$100{,}000,\\; \\$50{,}000]$\n- $e = [500,\\; 500,\\; 400,\\; 400,\\; 200,\\; 50]$\n- $d = [1,\\; 1,\\; 1,\\; 1,\\; 1,\\; 1]$\n\n您的程序应生成单行输出，其中包含五个测试用例的结果，格式为用方括号括起来的逗号分隔列表，每个结果的格式为 $[\\text{sorted\\_indices}, \\text{total\\_effect}]$，顺序与上文指定相同。例如，最终输出应类似于 $[[[i\\_case1],E\\_case1],[[i\\_case2],E\\_case2],[[i\\_case3],E\\_case3],[[i\\_case4],E\\_case4],[[i\\_case5],E\\_case5]]$，其中占位符被实际整数替换，且不含额外的空格或文本。", "solution": "所呈现的问题是一个约束优化任务，在形式上等同于 0/1 背包问题，设置在转化医学资源分配的背景下。我们被要求在固定预算下选择一个实施策略的子集，以最大化总预期效果（达到目标结果的患者数量），并使用特定的打破平局规则来确保解的唯一性。\n\n首先，我们必须验证问题陈述。\n\n**步骤 1：提取已知条件**\n- 策略数量：$n$。\n- 策略索引：$i \\in \\{0, 1, \\dots, n-1\\}$。\n- 策略效果：$e_i$（整数，人）。\n- 策略成本：$c_i$（美元，是 $\\$1,000$ 的倍数）。\n- 策略类型指示符：$d_i \\in \\{0, 1\\}$，其中 $d_i=1$ 为实施策略。\n- 决策变量：$x_i \\in \\{0, 1\\}$，其中 $x_i=1$ 表示选择策略 $i$。\n- 总预算：$B = \\$500,000$。\n- 优化问题：\n  $$\n  \\max_{x_i \\in \\{0,1\\}} \\;\\; \\sum_{i=0}^{n-1} e_i x_i\n  $$\n  约束条件：\n  $$\n  \\sum_{i=0}^{n-1} c_i x_i \\le B\n  $$\n  $$\n  x_i \\le d_i \\;\\; \\forall i \\in \\{0, 1, \\dots, n-1\\}\n  $$\n- 计算缩放：成本 $c_i$ 和预算 $B$ 将通过除以 $1,000$ 进行缩放。\n- 确保唯一性的打破平局规则：\n  1.  最大化总效果 $\\sum e_i x_i$。\n  2.  在效果最大的解中，最小化总成本 $\\sum c_i x_i$。\n  3.  如果仍然平局，选择其排序后的选中策略索引列表在字典序上最小的解。\n- 测试用例：提供了五个不同的测试用例，包含 $c$, $e$, 和 $d$ 的列表。\n- 输出格式：单行的、逗号分隔的结果列表，每个结果是一个包含排序后的选中索引列表和总效果的双元素列表：`[[sorted_indices], total_effect]`。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是一个成熟的整数线性规划模型（0/1 背包问题），应用于项目组合优化的现实场景。效果可加和成本线性的假设是此类模型中的标准简化。该问题在科学上和数学上都是合理的。\n- **适定性**：该问题定义清晰，有明确的目标函数、显式约束和每个测试用例的完整数据集。三层打破平局规则确保任何给定输入都存在唯一解，从而使问题具有适定性。\n- **客观性**：问题以精确、形式化的数学语言陈述，没有主观性或模糊性。\n\n**步骤 3：结论与行动**\n该问题是有效的。这是一个适定的、有科学依据的优化任务。我们可以着手制定解决方案。\n\n**基于原则的解决方案设计**\n\n问题的核心是选择一个项目（实施策略）子集，在权重约束（预算）下最大化总价值（效果）。这就是 0/1 背包问题。由于增加了复杂的打破平局规则，标准的背包算法必须进行增强。动态规划 (DP) 方法非常适合解决此问题。\n\n**1. 预处理**\n首先，我们筛选策略，只考虑实施策略，即那些 $d_i=1$ 的策略。我们还按要求缩放成本和预算。设可用实施策略的集合为 $S$，其中每个元素是一个元组 `(scaled_cost, effect, original_index)`。为了让我们的算法能正确处理字典序打破平局规则，按原始索引顺序 $i=0, 1, 2, \\dots$ 处理这些策略至关重要。假设有 $m$ 个这样的策略。缩放后的预算为 $B' = B / 1000 = 500$。\n\n**2. 动态规划公式**\n我们将使用一个二维 DP 表 $dp[k][w]$ 来寻找最优解。状态 $dp[k][w]$ 将表示使用从索引 $k$ 到 $m-1$ 的策略子集，在最大预算为 $w$ 的情况下可达成的最佳结果。为了处理前两个打破平局规则（最大化效果，然后最小化成本），我们的 DP 表中的每个单元格将存储一个元组：$(\\text{effect}, \\text{cost})$。\n\n设实施策略集合的索引从 $k=0$ 到 $m-1$。DP 表的维度将是 $(m+1) \\times (B' + 1)$。我们从后向前填充此表，即从 $k=m$ 到 $k=0$。\n\n基本情况是 $k=m$，对应于不使用任何策略。\n$$dp[m][w] = (0, 0) \\quad \\text{for all } w \\in \\{0, 1, \\dots, B'\\}$$\n\n对于递归步骤，我们计算 $dp[k][w]$，其中 $k \\in \\{m-1, \\dots, 0\\}$ 且 $w \\in \\{0, \\dots, B'\\}$。对于每个具有属性 $(c_k, e_k, i_k)$ 的策略 $k$，我们有两种选择：\n-  **不包括策略 $k$**：解是通过策略 $k+1, \\dots, m-1$ 和预算 $w$ 可达成的最佳方案。这由 $dp[k+1][w]$ 给出。\n-  **包括策略 $k$**：这仅在其成本 $c_k \\le w$ 时才可能。如果可能，所产生的效果和成本是策略 $k$ 的贡献与用剩余预算解决剩余策略的最佳解之和。即 $(e_k + dp[k+1][w-c_k].\\text{effect}, c_k + dp[k+1][w-c_k].\\text{cost})$。\n\n我们比较这两个选项。设 $S_1 = (e_1, c_1)$ 和 $S_2 = (e_2, c_2)$。如果 ($e_1  e_2$) 或 ($e_1=e_2$ 且 $c_1  c_2$)，则 $S_1$ 优于 $S_2$。\n$$\ndp[k][w] = \\text{better_of}(\\text{solution_without_k}, \\text{solution_with_k})\n$$\n\n**3. 寻找最优结果**\n填满整个 DP 表后，最优解不一定是 $dp[0][B']$，因为最佳组合可能不会用尽全部预算。我们必须通过检查表的第一行中所有可能的预算使用情况来找到全局最优解。我们搜索所有 $w \\in \\{0, \\dots, B'\\}$ 的 $dp[0][w]$，根据我们的比较标准找到全局最优元组 $(E^*, C^*)$。\n\n**4. 为字典序打破平局进行重构**\n这是最关键的一步。在找到目标最优值 $(E^*, C^*)$ 后，我们必须重构达成此结果并满足字典序打破平局规则的具体策略集。\n\n我们从 $k=0$ 到 $m-1$ 遍历策略（即按其原始索引的递增顺序）。在每一步 $k$，我们决定是否将策略 $k$ 包含在我们的最终解中。\n设我们当前的目标是 $(E_{rem}, C_{rem})$，剩余预算为 $w_{rem}$。最初，这些值是 $(E^*, C^*, B')$。对于具有属性 $(c_k, e_k, i_k)$ 的策略 $k$：\n我们检查包含策略 $k$ 是否能得到我们的目标解。如果包含它，并结合用剩余预算 ($w_{rem}-c_k$) 解决其余项目（$k+1, \\dots, m-1$）的最优解，能够产生我们从表中追踪的当前最优解，即 $dp[k][w_{rem}]$，则该条件为真。\n\n形式上，我们检查是否 $w_{rem} \\ge c_k$ 并且选择项目 $k$ 得到的解 $(e_k + dp[k+1][w_{rem}-c_k].\\text{effect}, c_k + dp[k+1][w_{rem}-c_k].\\text{cost})$ 与 $dp[k][w_{rem}]$ 相同。\n\n如果此条件成立，则意味着存在一条包含策略 $k$ 的最优路径。因为我们是按原始索引的递增顺序（$i_0  i_1  \\dots$）遍历策略，所以这种包含当前策略 $k$ 的贪婪选择保证了我们正在构建字典序最小的索引集。在决定包含策略 $k$ 后，我们将其原始索引 $i_k$ 添加到我们的结果集中，并更新我们的追踪变量：\n- $w_{rem} \\leftarrow w_{rem} - c_k$\n- $E_{rem} \\leftarrow E_{rem} - e_k$\n- $C_{rem} \\leftarrow C_{rem} - c_k$\n\n如果条件不成立，说明我们一定没有包含策略 $k$，因此我们以不变的追踪变量继续处理下一个策略 $k+1$。重复此过程，直到所有策略都被考虑完毕，从而得出唯一的最优索引集。总效果就是 $E^*$。", "answer": "[[[0,3,5,6],1090],[[0,1,3],550],[[1,2,3,5],845],[[0,1,2,4],910],[[0,2,4],1100]]", "id": "5010866"}]}