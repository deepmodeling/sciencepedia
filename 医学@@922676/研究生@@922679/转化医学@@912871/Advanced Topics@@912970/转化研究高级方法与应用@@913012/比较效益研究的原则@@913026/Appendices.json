{"hands_on_practices": [{"introduction": "量化新疗法与标准护理相比的效果，是比较效果研究的基石。本练习旨在介绍用于此目的的基础衡量指标：风险差（risk difference）、风险比（risk ratio）和优势比（odds ratio）。通过一个假设的临床试验场景 [@problem_id:5050291]，您将学习计算这些不同的指标，更重要的是，理解它们各自如何为政策制定和人群健康影响提供独特的视角。", "problem": "一项在比较效果研究（CER；Comparative Effectiveness Research）中的实用性随机研究，评估了在转化医学背景下、于一个特定的随访期内预防一种具有临床重要性的不良事件的两种策略：一种新的以实施为重点的治疗方法和当前的标准护理（对照组）。在目标人群中，观察到的事件风险在治疗下为$0.20$，在对照下为$0.25$。一个一体化医疗服务体系计划向$12{,}345$名符合条件的患者推广该治疗方法，但这取决于对效应指标和人群影响的政策评估。\n\n从概率论的基本定义（风险即事件发生的概率，比值即事件发生概率与其互补概率之比）出发，请从第一性原理推导风险差、风险比和比值比。简要阐明在比较效果研究中，当大规模分配有限资源时，这些指标如何结合基线风险的作用和对人群层面决策的可解释性，为政策提供不同方面的信息。\n\n然后，使用期望计数的第一性原理，计算如果在同一时间范围内，所有$12{,}345$名符合条件的患者都接受治疗而不是对照处理，将会被预防的不良事件的期望数量。将您的最终数值答案四舍五入至四位有效数字，并以事件数量的形式表示（在最终答案框中，无百分号，无其他单位）。", "solution": "该问题是有效的，因为它的科学基础在于流行病学和比较效果研究的原则，提问清晰明确并提供了所有必要的数据，并且使用客观、正式的语言表述。我们可以开始解答。\n\n设$E$为不良事件。我们已知两个组的风险，即该事件发生的概率：一个治疗组（$T$）和一个对照组（$C$）。\n治疗组的风险为 $p_T = P(E|T) = 0.20$。\n对照组的风险，也称为基线风险，为 $p_C = P(E|C) = 0.25$。\n目标人群中符合条件的患者总数为 $N = 12,345$。\n\n首先，我们推导三个关键的效应指标：风险差、风险比和比值比。\n\n风险的基本定义是事件的概率。事件的比值（odds）定义为事件发生的概率与事件不发生的概率之比。\n对于治疗组，事件的比值为：\n$$O_T = \\frac{P(E|T)}{P(\\neg E|T)} = \\frac{p_T}{1 - p_T}$$\n对于对照组，事件的比值为：\n$$O_C = \\frac{P(E|C)}{P(\\neg E|C)} = \\frac{p_C}{1 - p_C}$$\n\n1.  **风险差 (Risk Difference, RD)**\n    风险差，当治疗降低风险时也称为绝对风险降低（Absolute Risk Reduction, ARR），是对照组和治疗组之间风险的算术差值。它衡量由治疗引起的风险绝对变化。\n    $$RD = p_C - p_T$$\n    使用给定值：\n    $$RD = 0.25 - 0.20 = 0.05$$\n\n2.  **风险比 (Risk Ratio, RR)**\n    风险比，也称为相对风险（Relative Risk），是治疗组风险与对照组风险之比。它衡量风险的乘法变化。\n    $$RR = \\frac{p_T}{p_C}$$\n    使用给定值：\n    $$RR = \\frac{0.20}{0.25} = 0.80$$\n\n3.  **比值比 (Odds Ratio, OR)**\n    比值比是治疗组中事件比值与对照组中事件比值之比。\n    $$OR = \\frac{O_T}{O_C} = \\frac{p_T / (1 - p_T)}{p_C / (1 - p_C)}$$\n    使用给定值：\n    $$p_T = 0.20 \\implies 1-p_T = 0.80$$\n    $$p_C = 0.25 \\implies 1-p_C = 0.75$$\n    将这些值代入OR的公式：\n    $$OR = \\frac{0.20 / 0.80}{0.25 / 0.75} = \\frac{0.25}{1/3} = 0.25 \\times 3 = 0.75$$\n\n接下来，我们阐明这些指标在比较效果研究中如何为政策提供不同方面的信息。\n在比较效果研究的背景下，目标是指导现实世界中的医疗决策，包括政策和大规模资源分配。\n**风险差（RD）**，或绝对风险降低，通常是用于政策制定的最有用指标。在本例中，$RD = 0.05$。这意味着每100个接受治疗而非对照处理的人中，可以预防5个不良事件。其倒数 $1/RD = 1/0.05 = 20$，即需治数（Number Needed to Treat, NNT），表示必须治疗20名患者才能额外预防一个不良事件。RD可以直接转化为人群层面的影响，这使其在卫生经济学评估和资源规划中极具价值。然而，RD高度依赖于基线风险（$p_C$）；如果基线风险非常低，一个有效的治疗方法产生的RD也会很小。\n**风险比（RR）**为$0.80$，表明治疗组的事件风险是对照组风险的$80\\%$，这对应于相对风险降低了 $1 - RR = 1 - 0.80 = 0.20$，即$20\\%$。在基线风险不同的人群中，RR通常比RD更稳定。这使得它在推广干预措施的相对效力方面很有用。然而，对于政策决策而言，如果绝对风险很小，一个大的RR可能会产生误导。当基线风险为$25\\%$时，$20\\%$的风险降低比基线风险为$0.1\\%$时更具影响力。\n**比值比（OR）**为$0.75$，意味着治疗组发生不良事件的比值比对照组低$25\\%$。OR是许多统计模型（如逻辑斯蒂回归）中的一个基本参数，并具有理想的数学性质。然而，它的解释不如RR或RD直观，这使其在与决策者或公众沟通时成为一个较弱的工具。当事件不罕见时（如本例中$p_C = 0.25$），OR会夸大效应（相比于RR，$OR = 0.75  RR = 0.80$）。对于政策而言，其主要价值是间接的，体现在其在生成证据的统计分析中所扮演的角色。\n总之，在推广一项干预措施时，RD提供了对公共卫生影响最直接的估计，RR帮助评估效应的相对大小，而OR主要用作一个统计指标。\n\n最后，我们计算在$N=12,345$名患者的目标人群中，将会被预防的不良事件的期望数量。\n期望事件数是个体数量与其事件风险的乘积。\n如果所有患者都接受对照处理，期望事件数：\n$$E_C = N \\times p_C = 12,345 \\times 0.25$$\n如果所有患者都接受治疗，期望事件数：\n$$E_T = N \\times p_T = 12,345 \\times 0.20$$\n被预防的期望事件数 $\\Delta E$ 是这两个期望计数之差：\n$$\\Delta E = E_C - E_T = (N \\times p_C) - (N \\times p_T) = N \\times (p_C - p_T)$$\n这等同于将人群规模乘以风险差（RD）：\n$$\\Delta E = N \\times RD$$\n代入给定值：\n$$\\Delta E = 12,345 \\times (0.25 - 0.20) = 12,345 \\times 0.05 = 617.25$$\n题目要求将最终数值答案四舍五入至四位有效数字。数字$617.25$四舍五入至四位有效数字是$617.3$。\n因此，向全体符合条件的患者推广该治疗方法，预计可预防约$617.3$个不良事件。", "answer": "$$\\boxed{617.3}$$", "id": "5050291"}, {"introduction": "虽然随机对照试验提供了最清晰的证据，但许多比较效果研究依赖于对真实世界观察性数据的分析。本实践将介绍双重差分（difference-in-differences, DiD）法，这是一种强大的准实验技术，适用于当干预组和对照组都具有干预前后数据时估算因果效应。此练习 [@problem_id:5050300] 将引导您理解如何利用对照组来排除潜在的时间趋势影响，从而分离出干预措施的真实效果。", "problem": "一个医院系统正在评估一种新的临床决策支持工具，该工具旨在降低住院期间严重药物不良事件的绝对风险。该工具在一部分医院（处理组）中推广使用，而其他医院在同一时期没有采用该工具（对照组）。在转化医学中的比较效果研究（CER）背景下，请考虑以下经过充分检验且被广泛接受的基础理论：用于因果推断的潜在结果框架、稳定单位处理价值假设（SUTVA），以及平行趋势假设——即处理组和对照组在未接受处理时的结果随时间变化的趋势是相同的，仅相差一个常数。将结果 $Y$ 定义为患者在住院期间经历药物不良事件的个体水平指标（因此其均值即为绝对风险）。令 $t \\in \\{0,1\\}$ 分别表示工具采用前和采用后的时期，令 $D \\in \\{0,1\\}$ 表示医院是否采用该工具。\n\n给定以下按组别和时间划分的样本平均风险：处理组采用前 $0.25$，处理组采用后 $0.18$，对照组采用前 $0.20$，对照组采用后 $0.19$。请使用基于潜在结果框架和平行趋势假设的双重差分（difference-in-differences）逻辑，计算在采用后时期，处理组所受影响的因果效应的样本模拟值（在绝对风险尺度上）。将最终效应表示为小数（不要使用百分号）。无需四舍五入。", "solution": "该问题要求使用基于潜在结果框架的双重差分（DiD）方法来计算因果效应。我们已获得进行此计算所必需的假设和数据。\n\n令 $Y$ 为患者层面的二元结果，其中如果患者经历了严重药物不良事件，则 $Y=1$，否则 $Y=0$。在任何组内，$Y$ 的均值代表该组的绝对风险。\n令 $D \\in \\{0,1\\}$ 为不随时间变化的指示变量，用于区分处理组，其中 $D=1$ 表示采用新工具的医院（处理组），$D=0$ 表示未采用的医院（对照组）。\n令 $t \\in \\{0,1\\}$ 为时期指示变量，其中 $t=0$ 是工具采用前的时期，$t=1$ 是工具采用后的时期。\n\n问题提供了以下样本平均风险，它们是条件期望值 $E[Y|D, t]$ 的经验估计：\n- 处理组在采用前时期的平均风险：$\\bar{Y}_{D=1, t=0} = 0.25$\n- 处理组在采用后时期的平均风险：$\\bar{Y}_{D=1, t=1} = 0.18$\n- 对照组在采用前时期的平均风险：$\\bar{Y}_{D=0, t=0} = 0.20$\n- 对照组在采用后时期的平均风险：$\\bar{Y}_{D=0, t=1} = 0.19$\n\n我们感兴趣的因果参数是处理组在采用后时期的平均处理效应（Average Treatment Effect on the Treated, ATT）。在潜在结果框架中，我们将 $Y_1(1)$ 定义为处理组医院（$D=1$）的患者在接受处理（在时期 $t=1$）时的潜在结果，而将 $Y_0(1)$ 定义为同一患者在同一医院和同一时期假如未接受处理时的潜在结果。ATT 是处理组这两个潜在结果的期望差值：\n$$\n\\text{ATT} = E[Y_1(1) - Y_0(1) | D=1]\n$$\n根据期望的线性性质，这等于：\n$$\n\\text{ATT} = E[Y_1(1) | D=1] - E[Y_0(1) | D=1]\n$$\n第一项，$E[Y_1(1) | D=1]$，是处理组在接受处理后的期望结果。这在采用后时期的数据中可以实际观测到。其样本模拟值为 $\\bar{Y}_{D=1, t=1} = 0.18$。\n\n第二项，$E[Y_0(1) | D=1]$，是反事实的期望结果：即如果处理组医院在采用后时期*没有*采用该工具，其风险会是多少。这个量是无法观测到的。\n\nDiD 方法的关键是使用“平行趋势”假设来估计这个反事实结果。该假设表明，在没有处理的情况下，处理组结果的平均变化会与对照组结果的平均变化相同。用数学公式表示为：\n$$\nE[Y_0(1) | D=1] - E[Y_0(0) | D=1] = E[Y_0(1) | D=0] - E[Y_0(0) | D=0]\n$$\n在采用前时期（$t=0$），两个组都没有接受处理，因此未接受处理的潜在结果 $Y_0(0)$ 与观测结果 $Y(0)$ 相同。此外，对照组始终未接受处理，因此对他们来说 $Y_0(1) = Y(1)$。所以，我们可以用可观测的量重写该假设：\n$$\nE[Y_0(1) | D=1] - E[Y | D=1, t=0] = E[Y | D=0, t=1] - E[Y | D=0, t=0]\n$$\n求解未被观测到的反事实量 $E[Y_0(1) | D=1]$：\n$$\nE[Y_0(1) | D=1] = E[Y | D=1, t=0] + (E[Y | D=0, t=1] - E[Y | D=0, t=0])\n$$\n这个表达式说明，处理组的反事实风险等于其基线风险加上对照组在同一时期内经历的变化。\n\n现在我们将这个反事实的表达式代回到 ATT 的方程中：\n$$\n\\text{ATT} = E[Y | D=1, t=1] - \\left( E[Y | D=1, t=0] + E[Y | D=0, t=1] - E[Y | D=0, t=0] \\right)\n$$\n整理各项，得到标准的 DiD 公式：\n$$\n\\text{ATT} = (E[Y | D=1, t=1] - E[Y | D=1, t=0]) - (E[Y | D=0, t=1] - E[Y | D=0, t=0])\n$$\nDiD 估计量 $\\hat{\\delta}_{DiD}$ 是该表达式的样本模拟值。我们代入已知的样本均值：\n$$\n\\hat{\\delta}_{DiD} = (\\bar{Y}_{D=1, t=1} - \\bar{Y}_{D=1, t=0}) - (\\bar{Y}_{D=0, t=1} - \\bar{Y}_{D=0, t=0})\n$$\n代入给定的数值：\n$$\n\\hat{\\delta}_{DiD} = (0.18 - 0.25) - (0.19 - 0.20)\n$$\n首先，计算处理组的风险变化：\n$$\n\\Delta_{\\text{treated}} = 0.18 - 0.25 = -0.07\n$$\n接下来，计算对照组的风险变化。这代表了与干预无关的风险的长期趋势。\n$$\n\\Delta_{\\text{control}} = 0.19 - 0.20 = -0.01\n$$\nDiD 估计值是这两个变化之差：\n$$\n\\hat{\\delta}_{DiD} = \\Delta_{\\text{treated}} - \\Delta_{\\text{control}} = -0.07 - (-0.01)\n$$\n$$\n\\hat{\\delta}_{DiD} = -0.07 + 0.01 = -0.06\n$$\n这个结果 $-0.06$ 就是该临床决策支持工具的估计因果效应。它表明，在考虑了对照组医院中观察到的风险背景趋势后，该工具使处理组医院患者发生药物不良事件的绝对风险降低了 $6$ 个百分点。问题要求将此值表示为小数。", "answer": "$$\\boxed{-0.06}$$", "id": "5050300"}, {"introduction": "对于任何观察性研究，一个关键问题是：“我的研究结果是否可能由某个我未能测量的因素所解释？” E值（E-value）为这个问题提供了一个定量的答案，是一种至关重要的敏感性分析工具。本练习 [@problem_id:5050212] 将演示如何计算和解释E值，它评估了一个未测量的混杂因素需要与干预和结局有多强的关联，才能将观察到的效应完全归于无效，从而衡量研究结果的稳健性。", "problem": "在比较效果研究（CER）中，一个核心问题是所估计的因果效应对于未测量混杂因素的稳健性。考虑一项转化医学中的观察性CER研究，该研究比较了治疗方法$A$与对照方法$B$对1年时二元临床终点$Y$的影响。在对已测量的混杂因素进行调整后，比较$A$与$B$的估计风险比（RR）为$RR_{\\text{obs}} = 0.75$，这表明存在保护性关联。\n\n请定义点估计在风险比尺度上的证据值（E-value），即在给定已测量协变量的条件下，一个未测量的混杂因素$U$需要与治疗方法$A$和结局$Y$同时具有的最小关联强度（为便于处理，假定两者相等），该关联强度能够通过未测量的混杂将观察到的关联完全解释为零效应值$RR=1$。从风险比的基本定义以及在正定性和一致性假设下单个二元未测量混杂因素的标准偏倚因子界限出发，推导E-value作为任意观测风险比$RR_{\\text{obs}}$的解析表达式，然后计算当$RR_{\\text{obs}} = 0.75$时的E-value值。将你的最终数值答案表示为一个实数。除了精确算术外，不需要进行四舍五入。", "solution": "该问题陈述已经过严格验证，被认为是科学上合理、定义明确且客观的。它提出了因果推断和流行病学领域的一个标准任务：为给定的观测风险比计算E-value。\n\n该问题要求推导证据值（E-value）的解析表达式，并针对观测风险比$RR_{\\text{obs}}$为$0.75$的情况进行计算。E-value量化了一个未测量的混杂因素需要与治疗方法和结局同时具有的关联强度，以便完全解释掉观察到的关联。\n\n令$A$表示治疗变量（$A=1$代表治疗方法$A$，$A=0$代表对照方法$B$），令$Y$为二元临床结局（$Y=1$代表发生事件）。调整了已测量协变量后的观测风险比为$RR_{\\text{obs}} = 0.75$。这是治疗组中结局发生概率与对照组中结局发生概率的比值：\n$$ RR_{\\text{obs}} = \\frac{P(Y=1|A=1, C=c)}{P(Y=1|A=0, C=c)} $$\n其中$C$代表已测量的协变量集合。为简化表示，我们将省略$C$，因为所有的关联都是以其为条件定义的。\n\n观测风险比（$RR_{\\text{obs}}$）、真实因果风险比（$RR_{\\text{true}}$）和由未测量混杂引起的偏倚因子（$B$）之间的关系由$RR_{\\text{obs}} = RR_{\\text{true}} \\times B$给出。要“完全解释掉”观察到的关联，意味着真实的因果效应为空，即$RR_{\\text{true}} = 1$。在这种情况下，观察到的关联完全是混杂造成的人为现象，即$RR_{\\text{obs}} = B$。\n\n给定的风险比是$RR_{\\text{obs}} = 0.75$，小于$1$。E-value框架通常应用于大于$1$的风险比。对于保护性关联（$RR  1$），我们考虑其倒数，它代表相同强度的关联但方向相反。我们定义$RR'_{\\text{obs}} = 1 / RR_{\\text{obs}}$。\n$$ RR'_{\\text{obs}} = \\frac{1}{0.75} = \\frac{1}{3/4} = \\frac{4}{3} $$\n我们现在的任务是找到能够解释掉观测风险比$RR'_{\\text{obs}} = 4/3$的E-value。这需要一个偏倚因子$B = 4/3$。\n\nE-value的定义基于偏倚因子的一个标准界限。对于一个未测量的混杂因素$U$（不失一般性地，假设其为结局的一个风险因素），令$RR_{AU}$为治疗$A$与混杂因素$U$之间关联的风险比，令$RR_{UY}$为混杂因素$U$与结局$Y$之间关联的风险比。要使偏倚因子$B$大于$1$，$RR_{AU}$和$RR_{UY}$都必须大于$1$。偏倚因子受以下表达式的限制：\n$$ B \\le \\frac{RR_{AU} \\cdot RR_{UY}}{RR_{AU} + RR_{UY} - 1} $$\nE-value被定义为混杂因素必须与治疗和结局同时具有的最小关联强度$E$。问题指定为便于处理，假定该强度相等，因此我们设$RR_{AU} = RR_{UY} = E$。将此代入不等式，得到给定强度$E$时可能的最大偏倚：\n$$ B \\le \\frac{E \\cdot E}{E + E - 1} = \\frac{E^2}{2E - 1} $$\n要解释掉观察到的效应$RR'_{\\text{obs}}$，偏倚因子$B$必须至少为$RR'_{\\text{obs}}$。这要求混杂因素的参数足够强以满足：\n$$ RR'_{\\text{obs}} \\le \\frac{E^2}{2E - 1} $$\nE-value是使此不等式成立的$E$的最小值。为求此最小值，我们求解等式成立的边界情况：\n$$ RR'_{\\text{obs}} = \\frac{E^2}{2E - 1} $$\n这个方程可以重新整理成一个关于$E$的二次方程：\n$$ RR'_{\\text{obs}}(2E - 1) = E^2 $$\n$$ 2E \\cdot RR'_{\\text{obs}} - RR'_{\\text{obs}} = E^2 $$\n$$ E^2 - 2E \\cdot RR'_{\\text{obs}} + RR'_{\\text{obs}} = 0 $$\n我们使用二次公式$E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$来解这个关于$E$的二次方程，其中$a=1$，$b=-2 \\cdot RR'_{\\text{obs}}$，且$c=RR'_{\\text{obs}}$：\n$$ E = \\frac{2 \\cdot RR'_{\\text{obs}} \\pm \\sqrt{(-2 \\cdot RR'_{\\text{obs}})^2 - 4(1)(RR'_{\\text{obs}})}}{2} $$\n$$ E = \\frac{2 \\cdot RR'_{\\text{obs}} \\pm \\sqrt{4 (RR'_{\\text{obs}})^2 - 4 RR'_{\\text{obs}}}}{2} $$\n$$ E = \\frac{2 \\cdot RR'_{\\text{obs}} \\pm 2 \\sqrt{(RR'_{\\text{obs}})^2 - RR'_{\\text{obs}}}}{2} $$\n$$ E = RR'_{\\text{obs}} \\pm \\sqrt{RR'_{\\text{obs}}(RR'_{\\text{obs}} - 1)} $$\n这得出了$E$的两个潜在解。然而，所使用的偏倚因子界限对于同时作为暴露和结局的风险因素的混杂因素是有效的，这意味着$E = RR_{AU} = RR_{UY} > 1$。我们必须确定两个根中哪一个满足这个条件。对于任何$RR'_{\\text{obs}} > 1$，可以证明较小的根$E_{-} = RR'_{\\text{obs}} - \\sqrt{RR'_{\\text{obs}}(RR'_{\\text{obs}} - 1)}$总是小于$1$。因此，它在这种情况下不是一个有效的解。较大的根$E_{+} = RR'_{\\text{obs}} + \\sqrt{RR'_{\\text{obs}}(RR'_{\\text{obs}} - 1)}$总是大于$RR'_{\\text{obs}}$，因此大于$1$。这个较大的根是对于任意观测风险比$RR > 1$的E-value的正确解析表达式：\n$$ E\\text{-value} = RR + \\sqrt{RR(RR-1)} $$\n对于$RR_{\\text{obs}}=0.75$的特定情况，我们使用$RR'_{\\text{obs}} = 4/3$。我们现在可以计算E-value的数值：\n$$ E = \\frac{4}{3} + \\sqrt{\\frac{4}{3} \\left(\\frac{4}{3} - 1\\right)} $$\n$$ E = \\frac{4}{3} + \\sqrt{\\frac{4}{3} \\left(\\frac{1}{3}\\right)} $$\n$$ E = \\frac{4}{3} + \\sqrt{\\frac{4}{9}} $$\n$$ E = \\frac{4}{3} + \\frac{2}{3} $$\n$$ E = \\frac{6}{3} = 2 $$\nE-value为$2$。这意味着，要完全解释掉$RR_{\\text{obs}} = 0.75$的观测保护效应，一个未测量的混杂因素必须在已测量协变量的条件下，与治疗方法和结局均具有至少为$2$的风险比关联。", "answer": "$$\\boxed{2}$$", "id": "5050212"}]}