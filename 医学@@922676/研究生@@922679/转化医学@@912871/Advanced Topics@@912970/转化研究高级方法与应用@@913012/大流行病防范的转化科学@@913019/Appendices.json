{"hands_on_practices": [{"introduction": "在大流行初期，当病原体流行率较低时，检测能力往往是宝贵的稀缺资源。本练习将探讨如何通过“混合样本检测”（也称为Dorfman pooling）来优化检测策略，以提高效率。你将从概率论的第一性原理出发，推导出期望检测数量的表达式，并找到能最大限度节省资源的最优分组大小，这直接关系到实验室的运行效率和资源配置。[@problem_id:5073896]", "problem": "一家公共卫生实验室正在设计一种两阶段混合检测方案（Dorfman pooling），以在流行病早期阶段扩大用于呼吸道病毒监测的逆转录定量聚合酶链反应（RT-qPCR）能力。假设有一个大小为 $N$ 的大型筛查队列，其中每个个体具有独立的感染概率 $p$，并且分析验证已证实，对于所考虑的分组大小，混合检测相对于单独检测不会降低灵敏度或特异性。在第一阶段，实验室检测混合样本，这些样本是通过将 $N$ 个个体划分为大小相等的 $g \\in \\mathbb{N}$ 个分组而形成的；每个分组进行一次混合检测。在第二阶段，任何在第一阶段检测呈阳性的分组中的每个个体都将接受单独检测。设 $E[T](g,p)$ 表示在此两阶段方案下每个个体的预期检测次数。\n\n从独立伯努利试验的概率第一性原理和期望的定义出发，推导 $E[T](g,p)$ 的闭式表达式，然后，对于 $p=0.01$，确定使 $E[T](g,p)$ 最小化的最优整数分组大小 $g$。最后，量化最优混合策略相对于单独检测的效率增益，该增益定义为单独检测下的预期检测次数与最优 $g$ 下混合策略的预期检测次数之比。报告最优 $g$ 和效率增益。将效率增益四舍五入到四位有效数字。将效率增益表示为无量纲数（无单位）。", "solution": "问题陈述经评估有效。它在科学上基于概率论原理及其在公共卫生后勤（特别是 Dorfman pooled testing）中的应用。该问题是适定的、客观的，并包含推导唯一且有意义的解所需的所有信息。\n\n推导过程如下。\n\n首先，我们推导每个个体预期检测次数 $E[T](g,p)$ 的闭式表达式。\n筛查方案包括两个阶段。我们考虑一个由 $N$ 个个体组成的队列，划分为 $\\frac{N}{g}$ 个大小为 $g$ 的分组。每个个体的感染状态是一个独立的伯努利试验，感染概率为 $p$。\n\n随机选择一个个体未被感染的概率是 $1-p$。\n一个大小为 $g$ 的分组在第一阶段检测为阴性，当且仅当该组中所有 $g$ 个个体都未被感染。由于独立性假设，一个分组检测为阴性的概率是 $(1-p)^g$。\n\n如果至少有一个个体被感染，则一个分组在第一阶段检测为阳性。这个事件的概率，我们记为 $P_{pos}$，是分组检测为阴性的补集：\n$$P_{pos} = 1 - (1-p)^g$$\n\n总检测次数 $T_{total}$ 是第一阶段和第二阶段检测次数的总和。\n在第一阶段，对 $\\frac{N}{g}$ 个分组中的每一个都进行一次检测。因此，第一阶段的检测次数确定为 $\\frac{N}{g}$。\n在第二阶段，对第一阶段检测呈阳性的每个分组中的所有 $g$ 个成员进行单独检测。设 $K$ 是阳性分组数量的随机变量。第二阶段的检测次数是 $gK$。\n\n总检测次数为 $T_{total} = \\frac{N}{g} + gK$。\n我们需要总检测次数的期望值 $E[T_{total}]$。根据期望的线性性质：\n$$E[T_{total}] = E\\left[\\frac{N}{g} + gK\\right] = \\frac{N}{g} + gE[K]$$\n阳性分组的数量 $K$ 服从二项分布 $K \\sim \\text{Binomial}\\left(n=\\frac{N}{g}, q=P_{pos}\\right)$，因为 $\\frac{N}{g}$ 个分组中的每一个都代表一次独立的试验。二项分布的期望值是 $nq$。因此，阳性分组的预期数量是：\n$$E[K] = \\frac{N}{g} \\times P_{pos} = \\frac{N}{g}\\left(1 - (1-p)^g\\right)$$\n将此代入 $E[T_{total}]$ 的表达式中：\n$$E[T_{total}] = \\frac{N}{g} + g\\left[\\frac{N}{g}\\left(1 - (1-p)^g\\right)\\right] = \\frac{N}{g} + N\\left(1 - (1-p)^g\\right)$$\n问题要求的是每个个体的预期检测次数 $E[T](g,p)$，即 $E[T_{total}]$ 除以总个体数 $N$：\n$$E[T](g,p) = \\frac{E[T_{total}]}{N} = \\frac{1}{N}\\left(\\frac{N}{g} + N\\left(1 - (1-p)^g\\right)\\right)$$\n化简此表达式得到所需的闭式形式：\n$$E[T](g,p) = \\frac{1}{g} + 1 - (1-p)^g$$\n\n其次，我们确定当 $p=0.01$ 时，使 $E[T](g,p)$ 最小化的最优整数分组大小 $g$。\n需要最小化的函数是：\n$$f(g) = E[T](g, 0.01) = \\frac{1}{g} + 1 - (0.99)^g$$\n其中 $g$ 是一个整数且 $g \\ge 2$。为了找到最小值的近似位置，我们可以将 $g$ 视为一个连续变量，并找到其导数为零的位置。\n$$f'(g) = -\\frac{1}{g^2} - (0.99)^g \\ln(0.99) = 0$$\n这导出了方程 $g^2 (0.99)^g = -1/\\ln(0.99)$。对于小的 $p$，一个常见的近似是 $g_{opt} \\approx \\frac{1}{\\sqrt{p}}$。对于 $p=0.01$，这给出 $g_{opt} \\approx \\frac{1}{\\sqrt{0.01}} = \\frac{1}{0.1} = 10$。这表明真正的整数最小值接近 $10$。我们测试此附近的整数 $g$ 值。\n当 $g=10$ 时：\n$$E[T](10, 0.01) = \\frac{1}{10} + 1 - (0.99)^{10} \\approx 0.1 + 1 - 0.904382075 \\approx 0.195617925$$\n当 $g=11$ 时：\n$$E[T](11, 0.01) = \\frac{1}{11} + 1 - (0.99)^{11} \\approx 0.090909091 + 1 - 0.895338254 \\approx 0.195570837$$\n当 $g=12$ 时：\n$$E[T](12, 0.01) = \\frac{1}{12} + 1 - (0.99)^{12} \\approx 0.083333333 + 1 - 0.886384871 \\approx 0.196948462$$\n比较这些值，$E[T](g, 0.01)$ 在 $g=11$ 时最小。因此，最优整数分组大小为 $g_{opt} = 11$。\n\n最后，我们量化效率增益。这是单独检测的预期检测次数与最优混合策略的预期检测次数之比。\n单独检测时每个个体的预期检测次数是 $1$。\n最优混合策略中每个个体的预期检测次数是 $E[T](11, 0.01) \\approx 0.195570837$。\n效率增益 $\\eta$ 为：\n$$\\eta = \\frac{1}{E[T](11, 0.01)} = \\frac{1}{\\frac{1}{11} + 1 - (0.99)^{11}} \\approx \\frac{1}{0.195570837} \\approx 5.113238$$\n按要求四舍五入到四位有效数字，效率增益为 $5.113$。\n\n所要求的两个结果是：最优分组大小 $11$，以及效率增益 $5.113$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 11  5.113 \\end{pmatrix}}\n$$", "id": "5073896"}, {"introduction": "“群体免疫”是大规模疫苗接种计划的核心目标，它指的是通过为大部分人口接种疫苗来间接保护未接种疫苗的个体。实现群体免疫所需的疫苗覆盖率取决于病毒的传播能力（以基本再生数$R_0$衡量）和疫苗的有效性。本练习要求你基于一个“渗漏型”疫苗（即疫苗仅部分降低感染风险）的模型，从基本原理推导出阻止疫情增长所需的最低疫苗接种覆盖率。[@problem_id:5073913]", "problem": "一个国家级应急管理团队正在为一个新出现的呼吸道病原体规划流行前阶段的疫苗分配。现场调查和早期聚集性病例分析估计，在没有干预措施的情况下，基本再生数（$R_0$）为 $R_0 = 3$。一项大规模疫苗接种活动将部署一种单剂次产品，该产品被明确定义为“渗漏型”疫苗：它以一个恒定的比例降低接种者对感染的易感性，疫苗有效率（VE）= $0.8$，并且在发生突破性感染时，不会改变感染者的传染性或传染期持续时间。假设人群是均匀混合的，在病原体引入前瞬间完成疫苗接种，在相关时间范围内免疫力不会减弱，且种群是封闭的。\n\n仅使用基本再生数（$R_0$）的基础定义，即一个典型传染性个体被引入一个完全易感的群体中所产生的预期继发病例数，以及流行病早期增长的条件是有效再生数（$R_{\\mathrm{eff}}$）超过1，请从第一性原理出发，在上述渗漏型疫苗的假设下，推导出防止流行病增长（即实现群体免疫）所需的最低疫苗接种覆盖率 $p^{\\ast}$（占总人口的比例）。然后，计算当 $R_0 = 3$ 和 $\\mathrm{VE} = 0.8$ 时的 $p^{\\ast}$ 值。\n\n将最终的最低疫苗接种覆盖率表示为单个小数或单个精确分数（不带百分号）。如果选择小数，请将答案四舍五入到四位有效数字。", "solution": "用户提供了一个数学流行病学问题。我将首先根据指定标准验证问题陈述。\n\n### 步骤1：提取已知条件\n- 基本再生数：$R_0 = 3$。\n- 疫苗类型：单剂次“渗漏型”疫苗。\n- 疫苗有效率（VE）：$\\mathrm{VE} = 0.8$。这被定义为对感染易感性的恒定比例降低。\n- 疫苗特性：在发生突破性感染时，不改变传染性或传染期持续时间。\n- 模型假设：\n    - 封闭种群中的均匀混合。\n    - 在病原体引入前瞬间完成疫苗接种。\n    - 在相关时间范围内免疫力不减弱。\n- 基本定义：\n    - $R_0$ 是一个典型传染性个体在完全易感人群中产生的预期继发病例数。\n    - 流行病增长的条件是 $R_{\\mathrm{eff}} > 1$，其中 $R_{\\mathrm{eff}}$ 是有效再生数。\n- 目标：推导防止流行病增长（$R_{\\mathrm{eff}} \\le 1$）所需的最低疫苗接种覆盖率 $p^{\\ast}$，然后用给定参数计算其值。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题很好地基于传染病流行病学的基本原理。$R_0$、$R_{\\mathrm{eff}}$、群体免疫和渗漏型疫苗等概念是该领域的标准概念。\n- **问题适定性**：该问题是适定的。它提供了所有必要的参数（$R_0$，$\\mathrm{VE}$）和一个明确的目标（推导 $p^{\\ast}$ 使得 $R_{\\mathrm{eff}} \\le 1$）。这些假设虽然是理想化的，但创建了一个具有唯一解的可解数学模型。\n- **目标性**：问题以精确、客观和定量的术语陈述。\n- **结论**：该问题有效。它是理论流行病学中一个标准的、定义明确的问题，植根于既定的科学概念。它不违反任何无效标准。\n\n### 步骤3：判定与行动\n该问题有效。我现在将进行推导和求解。\n\n防止流行病增长的核心原则是确保有效再生数 $R_{\\mathrm{eff}}$ 小于或等于1。$R_{\\mathrm{eff}}$ 表示在具有一定预存免疫力的人群中，单个传染性个体引起的平均继发感染数。它被定义为基本再生数 $R_0$ 与人群中易感者比例 $s$ 的乘积。\n$$R_{\\mathrm{eff}} = R_0 \\cdot s$$\n预防流行病的临界阈值是 $R_{\\mathrm{eff}} \\le 1$。最低疫苗接种覆盖率 $p^{\\ast}$ 将是实现 $R_{\\mathrm{eff}} = 1$ 的覆盖率。\n\n我们必须在渗漏型疫苗模型下，推导出人群中有效易感者比例 $s$ 的表达式。设 $p$ 为已接种疫苗的人群比例。因此，比例为 $(1-p)$ 的人群未接种疫苗。\n\n未接种疫苗的个体对病原体完全易感。他们的相对易感性为 $1$。\n\n已接种疫苗的个体受到部分保护。问题指出疫苗的有效率（VE）能以一个恒定的比例降低易感性。因此，已接种疫苗个体的剩余易感性为 $(1 - \\mathrm{VE})$。\n\n人群的总有效易感比例 $s$ 是未接种疫苗和已接种疫苗亚群易感性的加权和：\n$$s = (1-p) \\cdot 1 + p \\cdot (1 - \\mathrm{VE})$$\n展开并简化此表达式：\n$$s = 1 - p + p - p \\cdot \\mathrm{VE}$$\n$$s = 1 - p \\cdot \\mathrm{VE}$$\n现在，我们可以将这个 $s$ 的表达式代入群体免疫阈值条件 $R_{\\mathrm{eff}} = 1$ 中，并令 $p = p^{\\ast}$ 来表示临界疫苗接种覆盖率。\n$$R_0 \\cdot s = 1$$\n$$R_0 (1 - p^{\\ast} \\cdot \\mathrm{VE}) = 1$$\n我们现在求解这个关于 $p^{\\ast}$ 的方程，以按要求从第一性原理推导出通用公式。\n$$1 - p^{\\ast} \\cdot \\mathrm{VE} = \\frac{1}{R_0}$$\n$$p^{\\ast} \\cdot \\mathrm{VE} = 1 - \\frac{1}{R_0}$$\n$$p^{\\ast} = \\frac{1 - \\frac{1}{R_0}}{\\mathrm{VE}}$$\n这个公式给出了使用渗漏型疫苗实现群体免疫所需的最低疫苗接种覆盖率。\n\n最后一步是使用给定的数值计算这个表达式：$R_0 = 3$ 和 $\\mathrm{VE} = 0.8$。\n$$p^{\\ast} = \\frac{1 - \\frac{1}{3}}{0.8}$$\n首先，计算分子：\n$$1 - \\frac{1}{3} = \\frac{2}{3}$$\n接下来，将分母表示为分数：\n$$\\mathrm{VE} = 0.8 = \\frac{8}{10} = \\frac{4}{5}$$\n现在，将这些分数代回 $p^{\\ast}$ 的方程中：\n$$p^{\\ast} = \\frac{\\frac{2}{3}}{\\frac{4}{5}}$$\n用一个分数除，等于乘以它的倒数：\n$$p^{\\ast} = \\frac{2}{3} \\cdot \\frac{5}{4} = \\frac{10}{12}$$\n化简分数得到最终答案：\n$$p^{\\ast} = \\frac{5}{6}$$\n作为小数，它是 $0.8333...$。问题要求一个精确分数或一个四舍五入到四位有效数字的小数。精确分数 $\\frac{5}{6}$ 是最精确的形式。", "answer": "$$\n\\boxed{\\frac{5}{6}}\n$$", "id": "5073913"}, {"introduction": "应对大流行不仅是短期的应急响应，更是一场持久战，其中一个关键挑战是疫苗诱导的免疫力会随时间衰减。本练习模拟了一个用于指导加强针接种计划的转化医学决策过程。你将使用一个定量模型，该模型将可测量的免疫学指标（中和抗体滴度）与疫苗有效性（$VE$）联系起来，并根据抗体滴度的衰减速率来计算维持特定保护水平所需的最佳加强针接种间隔。[@problem_id:5073910]", "problem": "一个转化医学团队正在构建一个政策模型，通过采用免疫相关指标指导的加强针接种计划，来维持对严重急性呼吸综合征冠状病毒2（SARS-CoV-2）的群体水平保护力。假设中和抗体滴度是主要的保护相关指标，并且保护力遵循由冠状病毒疫苗研究中的meta分析证据支持的logit-线性中和-有效性关系。具体而言，设距离最近一次接种后 $t$ 个月时的疫苗有效性（VE）$VE(t)$，通过一个逻辑斯谛链接函数与同期的对数转换（以10为底，相对于恢复期参考血清的比值）后的中和抗体滴度比值 $T(t)$ 相关联：\n$$\n\\text{logit}(VE(t)) \\equiv \\ln\\!\\left(\\frac{VE(t)}{1-VE(t)}\\right) = \\alpha + \\beta \\, T(t),\n$$\n并设接种一剂后，对数转换后的中和抗体滴度随时间近似线性衰减，\n$$\nT(t) = T_{0} - \\delta \\, t,\n$$\n其中 $T_{0}$ 是接种后即刻的对数转换后的中和抗体滴度比值，$\\delta$ 是在 $\\log_{10}$ 尺度上的月度衰减率。假设每一剂加强针都能瞬间将对数转换后的中和抗体滴度比值恢复至 $T_{0}$，并且两次接种之间适用相同的衰减率。\n\n给定 $T_{0} = 3.0$，$\\delta = 0.1$ 每月，$\\alpha = -1.2$ 和 $\\beta = 0.7$，计算疫苗有效性 $VE(t)$ 首次达到阈值 $0.6$ 的时间 $t^{\\star}$。然后，提出一个最小的固定加强针接种间隔 $I^{\\star}$（以月为单位），通过在每次恰好达到此阈值时接种加强针，从而在重复的相同周期内维持 $VE(t) \\geq 0.6$。将您报告的数值四舍五入至三位有效数字，并以月为单位表示。仅报告加强针接种间隔 $I^{\\star}$。", "solution": "该问题要求计算以月为单位的最小固定加强针接种间隔，记为`$I^{\\star}$`，该间隔是为将疫苗有效性`$VE(t)$`维持在`$0.6$`或以上阈值所必需的。此间隔等同于在接种一剂加强针后，`$VE(t)$`首次下降至此阈值的时间`$t^{\\star}$`。\n\n该模型由两个核心方程定义。首先，`$VE(t)$`与对数转换后的中和抗体滴度比值`$T(t)$`之间的关系由一个逻辑斯谛链接函数给出：\n$$\n\\text{logit}(VE(t)) \\equiv \\ln\\left(\\frac{VE(t)}{1-VE(t)}\\right) = \\alpha + \\beta \\, T(t)\n$$\n其次，对数转换后的滴度随时间`$t$`（以月为单位）线性衰减：\n$$\nT(t) = T_{0} - \\delta \\, t\n$$\n给定的参数为：`$\\alpha = -1.2$`，`$\\beta = 0.7$`，加强针接种后的对数滴度`$T_{0} = 3.0$`，以及月度衰减率`$\\delta = 0.1$`。\n\n我们的第一步是确定在阈值有效性`$VE(t^{\\star}) = 0.6$`时logit函数的值：\n$$\n\\text{logit}(0.6) = \\ln\\left(\\frac{0.6}{1-0.6}\\right) = \\ln\\left(\\frac{0.6}{0.4}\\right) = \\ln(1.5)\n$$\n接下来，我们利用此值，通过重排逻辑斯谛链接方程来求得相应的对数转换滴度`$T(t^{\\star})$`：\n$$\n\\alpha + \\beta \\, T(t^{\\star}) = \\ln(1.5)\n$$\n$$\nT(t^{\\star}) = \\frac{\\ln(1.5) - \\alpha}{\\beta}\n$$\n现在，我们可以确定达到此滴度值的时间`$t^{\\star}$`。我们重排`$T(t)$`的线性衰减模型来求解`$t^{\\star}$`：\n$$\nT(t^{\\star}) = T_{0} - \\delta \\, t^{\\star}\n$$\n$$\n\\delta \\, t^{\\star} = T_{0} - T(t^{\\star})\n$$\n$$\nt^{\\star} = \\frac{T_{0} - T(t^{\\star})}{\\delta}\n$$\n通过将从逻辑斯谛模型中导出的`$T(t^{\\star})$`表达式代入，我们得到了`$t^{\\star}$`的完整表达式：\n$$\nt^{\\star} = \\frac{T_{0} - \\frac{\\ln(1.5) - \\alpha}{\\beta}}{\\delta}\n$$\n现在我们代入给定的参数数值：`$T_{0} = 3.0$`，`$\\delta = 0.1$`，`$\\alpha = -1.2$`和`$\\beta = 0.7$`。\n$$\nt^{\\star} = \\frac{3.0 - \\frac{\\ln(1.5) - (-1.2)}{0.7}}{0.1} = \\frac{3.0 - \\frac{\\ln(1.5) + 1.2}{0.7}}{0.1}\n$$\n为了计算数值结果，我们使用`$\\ln(1.5) \\approx 0.405465$`：\n$$\nt^{\\star} \\approx \\frac{3.0 - \\frac{0.405465 + 1.2}{0.7}}{0.1} = \\frac{3.0 - \\frac{1.605465}{0.7}}{0.1}\n$$\n$$\nt^{\\star} \\approx \\frac{3.0 - 2.293521}{0.1} = \\frac{0.706479}{0.1} = 7.06479\n$$\n最小固定加强针接种间隔`$I^{\\star}$`就是这个时间`$t^{\\star}$`，因为在这个精确时刻接种加强针会重置抗体滴度，并确保`$VE(t)$`不会降到`$0.6$`的阈值以下。因此，`$I^{\\star} = t^{\\star} \\approx 7.06479$`个月。\n\n问题要求最终答案四舍五入到三位有效数字。将`$7.06479$`四舍五入得到`$7.06$`。", "answer": "$$\\boxed{7.06}$$", "id": "5073910"}]}