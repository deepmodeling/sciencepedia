{"hands_on_practices": [{"introduction": "在健康差异研究中，一个核心问题是：一项干预措施对不同人群的效果是否相同？为了严谨地回答这个问题，我们需要量化“效果异质性”(Heterogeneity of Treatment Effect, HTE)。这项练习将引导你通过一个随机对照试验的理想化场景，从第一性原理出发，推导出在线性模型中，交互项是如何精确地捕捉和估计不同社会风险群体之间干预效果差异的 [@problem_id:4987570]。", "problem": "一项在转化医学领域进行的多中心实用性随机对照试验 (RCT) 旨在评估一个旨在减少高血压控制方面差异的社区健康导航员项目。令 $A \\in \\{0,1\\}$ 表示分配到导航员项目 ($A=1$) 或常规护理 ($A=0$) 。令 $X \\in \\{0,1\\}$ 为一个基线指标，表示居住在高地区剥夺指数 (ADI) 社区 ($X=1$) 还是低 ADI 社区 ($X=0$) ，这代表了一个与健康差异相关的社会风险因素。令 $Y$ 为 6 个月内收缩压的变化（单位为 $\\mathrm{mmHg}$），其定义为数值越高表示血压降低得越多。\n\n采用潜在结果框架，并遵循稳定单位处理值假设 (SUTVA)、一致性假设和正定性假设。由于随机化，假设在给定 $X$ 的条件下，不存在未测量的混杂因素，即 $\\{Y(1),Y(0)\\} \\perp A \\mid X$。假设在给定处理和差异指标的条件下，观测结果的条件期望对于这些二元变量所允许的所有一阶项是线性的。\n\n仅从这些假设和定义出发，不借助任何额外的建模捷径，完成以下任务：\n- 推导 $\\mathbb{E}[Y \\mid A, X]$ 的最一般线性形式，该形式包含所有主效应以及 $A$ 和 $X$ 之间的一阶交互作用。\n- 使用这个推导出的形式，结合所述假设所蕴含的可识别性结果，来表达对于 $x \\in \\{0,1\\}$ 的条件平均处理效应 $\\tau(x) \\equiv \\mathbb{E}[Y(1)-Y(0) \\mid X=x]$。\n- 计算异质性对比 $\\Delta_{\\mathrm{HTE}} \\equiv \\tau(1)-\\tau(0)$，将其表示为您推导的线性形式的系数的封闭形式解析表达式。\n\n您的最终答案必须是 $\\Delta_{\\mathrm{HTE}}$ 的单一解析表达式。不包含单位。无需四舍五入。", "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   $A \\in \\{0,1\\}$：分配至导航员项目 ($A=1$) vs. 常规护理 ($A=0$)。\n-   $X \\in \\{0,1\\}$：高地区剥夺指数 (ADI) 社区 ($X=1$) vs. 低 ADI 社区 ($X=0$) 的指标。\n-   $Y$：6 个月内收缩压的变化（单位为 $\\mathrm{mmHg}$），数值越高越好。\n-   潜在结果框架：假设对于 $a \\in \\{0,1\\}$ 存在潜在结果 $Y(a)$。\n-   稳定单位处理值假设 (SUTVA)：已陈述此假设。\n-   一致性：已陈述此假设，意味着如果个体接受了处理 $A$，则 $Y = Y(A)$。\n-   正定性：已陈述此假设，意味着对于所有的 $a, x$，都有 $0  P(A=a|X=x)  1$。\n-   条件独立性（无混杂性）：$\\{Y(1),Y(0)\\} \\perp A \\mid X$。这是随机化的一个结果。\n-   函数形式约束：条件期望 $\\mathbb{E}[Y \\mid A, X]$ 对二元变量 $A$ 和 $X$ 所允许的所有一阶项（包括交互作用）是线性的。\n-   条件平均处理效应 (CATE) 的定义：对于 $x \\in \\{0,1\\}$，$\\tau(x) \\equiv \\mathbb{E}[Y(1)-Y(0) \\mid X=x]$。\n-   异质性对比的定义：$\\Delta_{\\mathrm{HTE}} \\equiv \\tau(1)-\\tau(0)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **具有科学依据：** 该问题使用了因果推断和生物统计学中标准的、成熟的概念，特别是潜在结果框架（Rubin 因果模型），该框架是分析随机试验和观察性研究的基础。效应修正（处理效应异质性）、条件独立性和线性建模等概念是该领域的基础。该设定模拟了转化健康公平研究中的一个现实场景。\n-   **适定性：** 该问题提供了一套清晰的假设和定义，并要求根据一个其形式也待推导的模型的参数，来推导一个特定的量（$\\Delta_{\\mathrm{HTE}}$）。该问题是自洽的，其结构旨在导出一个唯一的解析解。\n-   **客观性：** 该问题使用精确、正式且客观的数学和统计语言进行陈述。其中不包含任何主观或基于观点的内容。\n\n该问题是应用因果推断原理来量化处理效应异质性的一个标准练习。它具有科学性、适定性和客观性。未发现任何缺陷。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答推导\n\n解答过程按题目要求分为三个部分。\n\n**第一部分：推导 $\\mathbb{E}[Y \\mid A, X]$ 的线性形式**\n\n题目指出，给定处理分配 $A$ 和协变量 $X$ 时，结果 $Y$ 的条件期望对这些变量所允许的所有一阶项都是线性的。由于 $A$ 和 $X$ 都是取值为 $\\{0, 1\\}$ 的二元变量，因此 $\\mathbb{E}[Y \\mid A, X]$ 的一般线性模型包括一个截距项、$A$ 和 $X$ 的主效应，以及一个一阶交互项 $A \\cdot X$。设这些项的系数分别为 $\\beta_0, \\beta_1, \\beta_2,$ 和 $\\beta_3$。因此，最一般的形式是：\n$$\n\\mathbb{E}[Y \\mid A, X] = \\beta_0 + \\beta_1 A + \\beta_2 X + \\beta_3 (A \\cdot X)\n$$\n这个模型是饱和的，意味着它可以完美地表示 $(A, X)$ 的四种可能组合中每一种的 $Y$ 均值。\n\n**第二部分：条件平均处理效应 $\\tau(x)$ 的表达式**\n\n对于给定水平的协变量 $X=x$，条件平均处理效应 (CATE) 定义为 $\\tau(x) \\equiv \\mathbb{E}[Y(1)-Y(0) \\mid X=x]$。根据期望的线性性质，这可以写成：\n$$\n\\tau(x) = \\mathbb{E}[Y(1) \\mid X=x] - \\mathbb{E}[Y(0) \\mid X=x]\n$$\n问题陈述了条件无混杂性假设，即 $\\{Y(1),Y(0)\\} \\perp A \\mid X$。这个假设使我们能够从观测结果的条件均值中识别出潜在结果的条件均值。具体来说，对于任何处理水平 $a \\in \\{0, 1\\}$ 和协变量水平 $x \\in \\{0, 1\\}$：\n$$\n\\mathbb{E}[Y(a) \\mid X=x] = \\mathbb{E}[Y(a) \\mid A=a, X=x]\n$$\n根据一致性假设 ($Y=Y(A)$)，我们有 $\\mathbb{E}[Y(a) \\mid A=a, X=x] = \\mathbb{E}[Y \\mid A=a, X=x]$。结合这些结果，我们得到关键的可识别性公式：\n$$\n\\mathbb{E}[Y(a) \\mid X=x] = \\mathbb{E}[Y \\mid A=a, X=x]\n$$\n现在我们可以使用我们为观测数据建立的线性模型来表达 $\\tau(x)$：\n$$\n\\tau(x) = \\mathbb{E}[Y \\mid A=1, X=x] - \\mathbb{E}[Y \\mid A=0, X=x]\n$$\n我们对每个 $x$ 的水平进行计算：\n\n对于 $x=0$ (低 ADI 社区)：\n$$\n\\tau(0) = \\mathbb{E}[Y \\mid A=1, X=0] - \\mathbb{E}[Y \\mid A=0, X=0]\n$$\n使用我们的线性模型：\n$$\n\\mathbb{E}[Y \\mid A=1, X=0] = \\beta_0 + \\beta_1(1) + \\beta_2(0) + \\beta_3(1 \\cdot 0) = \\beta_0 + \\beta_1\n$$\n$$\n\\mathbb{E}[Y \\mid A=0, X=0] = \\beta_0 + \\beta_1(0) + \\beta_2(0) + \\beta_3(0 \\cdot 0) = \\beta_0\n$$\n因此，$x=0$ 组的 CATE 是：\n$$\n\\tau(0) = (\\beta_0 + \\beta_1) - \\beta_0 = \\beta_1\n$$\n\n对于 $x=1$ (高 ADI 社区)：\n$$\n\\tau(1) = \\mathbb{E}[Y \\mid A=1, X=1] - \\mathbb{E}[Y \\mid A=0, X=1]\n$$\n使用我们的线性模型：\n$$\n\\mathbb{E}[Y \\mid A=1, X=1] = \\beta_0 + \\beta_1(1) + \\beta_2(1) + \\beta_3(1 \\cdot 1) = \\beta_0 + \\beta_1 + \\beta_2 + \\beta_3\n$$\n$$\n\\mathbb{E}[Y \\mid A=0, X=1] = \\beta_0 + \\beta_1(0) + \\beta_2(1) + \\beta_3(0 \\cdot 1) = \\beta_0 + \\beta_2\n$$\n因此，$x=1$ 组的 CATE 是：\n$$\n\\tau(1) = (\\beta_0 + \\beta_1 + \\beta_2 + \\beta_3) - (\\beta_0 + \\beta_2) = \\beta_1 + \\beta_3\n$$\n系数 $\\beta_1$ 代表参照组 ($X=0$) 中的平均处理效应，而 $\\beta_3$ 代表与 $X=0$ 组相比，$X=1$ 组中处理的额外效应。\n\n**第三部分：计算异质性对比 $\\Delta_{\\mathrm{HTE}}$**\n\n异质性对比 $\\Delta_{\\mathrm{HTE}}$ 定义为 $X$ 的两个层中条件平均处理效应之间的差异：\n$$\n\\Delta_{\\mathrm{HTE}} \\equiv \\tau(1) - \\tau(0)\n$$\n代入第二部分推导出的 $\\tau(1)$ 和 $\\tau(0)$ 的表达式：\n$$\n\\Delta_{\\mathrm{HTE}} = (\\beta_1 + \\beta_3) - (\\beta_1)\n$$\n$$\n\\Delta_{\\mathrm{HTE}} = \\beta_3\n$$\n这个结果表明，衡量处理效应如何因 ADI 状态而异的异质性对比，恰好由线性模型中的交互作用系数 $\\beta_3$ 所捕捉。", "answer": "$$\\boxed{\\beta_3}$$", "id": "4987570"}, {"introduction": "在理想化的试验之外，真实世界的数据充满了挑战，其中之一便是测量误差。当测量的准确性因人群而异时，即存在“差异性测量误差”(differential measurement error)，它可能严重扭曲我们对健康差异的认知。本练习通过一个队列研究的假设场景，让你亲手推导并计算这种误差如何导致对真实交互作用的估计产生偏倚，从而揭示看似微小的测量不准可能带来的巨大影响 [@problem_id:4987560]。", "problem": "在一项转化医学队列研究中，为评估一种不良临床结局 $Y$（二元变量，$Y \\in \\{0,1\\}$），研究人员探究了一种二元暴露 $A$（例如，及时的出院后随访）的效应是否在一个二元分组 $G$（例如，边缘化人群状态，其中 $G \\in \\{0,1\\}$）之间存在差异，这种差异可能导致健康不平等。暴露被不完美地测量为 $\\tilde{A}$，其错分在 $G$ 组间是差异性的。假设在给定真实暴露 $A$ 和 $G$ 的条件下，对于结局 $Y$ 是非差异性的，即 $Y \\perp \\tilde{A} \\mid (A,G)$。\n\n定义层特异性风险 $R_{ag} = P(Y=1 \\mid A=a, G=g)$，其中 $a \\in \\{0,1\\}$ 且 $g \\in \\{0,1\\}$。定义加性尺度交互作用对比 (IC) 为 $\\mathrm{IC}_{A,G} = R_{11} - R_{10} - R_{01} + R_{00}$。令 $p_g = P(A=1 \\mid G=g)$ 表示组 $g$ 中的暴露率。\n\n$A$ 到 $\\tilde{A}$ 的错分由条件期望 $E[\\tilde{A} \\mid A, G=g]$ 总结如下：\n- 组 $g$ 中的灵敏度：$s_g = E[\\tilde{A} \\mid A=1, G=g] = P(\\tilde{A}=1 \\mid A=1, G=g)$，\n- 组 $g$ 中的假阳性概率：$f_g = E[\\tilde{A} \\mid A=0, G=g] = P(\\tilde{A}=1 \\mid A=0, G=g)$，\n- 组 $g$ 中的特异度：$c_g = 1 - f_g = P(\\tilde{A}=0 \\mid A=0, G=g)$。\n\n仅从全概率定律和贝叶斯定理出发，推导 $P(Y=1 \\mid \\tilde{A}=a, G=g)$ 的表达式，并由此推导观测到的加性交互作用 $\\mathrm{IC}_{\\tilde{A},G} = P(Y=1 \\mid \\tilde{A}=1, G=1) - P(Y=1 \\mid \\tilde{A}=1, G=0) - P(Y=1 \\mid \\tilde{A}=0, G=1) + P(Y=1 \\mid \\tilde{A}=0, G=0)$ 关于 $R_{ag}$，$p_g$，$s_g$ 和 $c_g$（或 $f_g$）的表达式。然后，使用下面的参数值，计算偏差 $\\mathrm{Bias} = \\mathrm{IC}_{\\tilde{A},G} - \\mathrm{IC}_{A,G}$，结果以小数形式表示。\n\n使用以下科学上合理的数值：\n- 风险：$R_{11} = 0.20$，$R_{10} = 0.12$，$R_{01} = 0.08$，$R_{00} = 0.05$，\n- 暴露率：$p_{1} = 0.50$，$p_{0} = 0.40$，\n- 错分期望：$E[\\tilde{A} \\mid A=1, G=1] = 0.60$，$E[\\tilde{A} \\mid A=0, G=1] = 0.15$，$E[\\tilde{A} \\mid A=1, G=0] = 0.80$，$E[\\tilde{A} \\mid A=0, G=0] = 0.05$。\n\n将偏差的最终数值答案四舍五入到四位有效数字。将答案表示为无单位的小数。", "solution": "用户提供的问题陈述已经过验证，被认为是科学上合理、表述清晰、客观且完整的。因此，我将进行完整的推导和求解。\n\n主要目标是推导观测到的加性交互作用对比 $\\mathrm{IC}_{\\tilde{A},G}$ 的表达式，该表达式用真实层特异性风险（$R_{ag}$）、暴露率（$p_g$）和错分参数（$s_g$、$c_g$ 或 $f_g$）表示。这需要为由测量暴露 $\\tilde{A}$ 和组 $G$ 定义的每个层中的观测风险 $P(Y=1 \\mid \\tilde{A}=a, G=g)$ 推导一个表达式。\n\n我们首先推导 $P(Y=1 \\mid \\tilde{A}=a, G=g)$ 的通用表达式。我们固定组状态为 $G=g$ 和观测暴露为 $\\tilde{A}=a$。我们将使用全概率定律，对真实暴露状态 $A \\in \\{0, 1\\}$ 进行边缘化。\n$$ P(Y=1 \\mid \\tilde{A}=a, G=g) = \\sum_{k=0}^{1} P(Y=1, A=k \\mid \\tilde{A}=a, G=g) $$\n使用条件概率的定义，$P(X,Z|W) = P(X|Z,W)P(Z|W)$：\n$$ P(Y=1 \\mid \\tilde{A}=a, G=g) = \\sum_{k=0}^{1} P(Y=1 \\mid A=k, \\tilde{A}=a, G=g) P(A=k \\mid \\tilde{A}=a, G=g) $$\n问题陈述指出，在给定真实暴露 $A$ 和组 $G$ 的条件下，结局 $Y$ 独立于测量暴露 $\\tilde{A}$。这是关于结局的非差异性错分假设，形式上为 $Y \\perp \\tilde{A} \\mid (A,G)$。这使得我们可以简化求和中的第一项：\n$$ P(Y=1 \\mid A=k, \\tilde{A}=a, G=g) = P(Y=1 \\mid A=k, G=g) = R_{kg} $$\n将其代回，观测风险的表达式变为：\n$$ P(Y=1 \\mid \\tilde{A}=a, G=g) = R_{1g} P(A=1 \\mid \\tilde{A}=a, G=g) + R_{0g} P(A=0 \\mid \\tilde{A}=a, G=g) $$\n剩下的项 $P(A=k \\mid \\tilde{A}=a, G=g)$ 是测量暴露 $\\tilde{A}$ 对真实暴露 $A$ 的预测值。我们可以使用贝叶斯定理和所提供的参数推导这些表达式。所有后续的概率都隐含地以 $G=g$ 为条件。\n\n使用贝叶斯定理：\n$$ P(A=k \\mid \\tilde{A}=a, G=g) = \\frac{P(\\tilde{A}=a \\mid A=k, G=g) P(A=k \\mid G=g)}{P(\\tilde{A}=a \\mid G=g)} $$\n分母 $P(\\tilde{A}=a \\mid G=g)$ 是组 $g$ 中测量暴露状态 $\\tilde{A}=a$ 的比例。我们使用全概率定律展开它：\n$$ P(\\tilde{A}=a \\mid G=g) = P(\\tilde{A}=a \\mid A=1, G=g) P(A=1 \\mid G=g) + P(\\tilde{A}=a \\mid A=0, G=g) P(A=0 \\mid G=g) $$\n我们已知：\n- $p_g = P(A=1 \\mid G=g)$，所以 $P(A=0 \\mid G=g) = 1-p_g$。\n- $s_g = P(\\tilde{A}=1 \\mid A=1, G=g)$，所以 $P(\\tilde{A}=0 \\mid A=1, G=g) = 1-s_g$。\n- $f_g = P(\\tilde{A}=1 \\mid A=0, G=g)$，所以 $P(\\tilde{A}=0 \\mid A=0, G=g) = 1-f_g = c_g$。\n\n让我们推导 $\\tilde{A}$ 两种情况的表达式。\n\n情况1：$\\tilde{A}=1$（观测到暴露存在）\n观测暴露的比例为：\n$$ P(\\tilde{A}=1 \\mid G=g) = s_g p_g + f_g (1-p_g) $$\n阳性预测值（$PPV_g$）为：\n$$ PPV_g = P(A=1 \\mid \\tilde{A}=1, G=g) = \\frac{s_g p_g}{s_g p_g + f_g (1-p_g)} $$\n并且 $P(A=0 \\mid \\tilde{A}=1, G=g) = 1 - PPV_g = \\frac{f_g(1-p_g)}{s_g p_g + f_g (1-p_g)}$。\n因此，暴露人群中的观测风险为：\n$$ P(Y=1 \\mid \\tilde{A}=1, G=g) = R_{1g} \\cdot PPV_g + R_{0g} \\cdot (1-PPV_g) = \\frac{R_{1g} s_g p_g + R_{0g} f_g (1-p_g)}{s_g p_g + f_g (1-p_g)} $$\n\n情况2：$\\tilde{A}=0$（观测到暴露不存在）\n观测到未暴露的比例为：\n$$ P(\\tilde{A}=0 \\mid G=g) = (1-s_g)p_g + (1-f_g)(1-p_g) $$\n阴性预测值（$NPV_g$）为：\n$$ NPV_g = P(A=0 \\mid \\tilde{A}=0, G=g) = \\frac{(1-f_g)(1-p_g)}{(1-s_g)p_g + (1-f_g)(1-p_g)} $$\n并且 $P(A=1 \\mid \\tilde{A}=0, G=g) = 1 - NPV_g = \\frac{(1-s_g)p_g}{(1-s_g)p_g + (1-f_g)(1-p_g)}$。\n因此，未暴露人群中的观测风险为：\n$$ P(Y=1 \\mid \\tilde{A}=0, G=g) = R_{1g} \\cdot (1-NPV_g) + R_{0g} \\cdot NPV_g = \\frac{R_{1g}(1-s_g)p_g + R_{0g}(1-f_g)(1-p_g)}{(1-s_g)p_g + (1-f_g)(1-p_g)} $$\n\n有了这些通用形式，我们可以写出观测到的交互作用对比 $\\mathrm{IC}_{\\tilde{A},G}$。令 $\\tilde{R}_{ag} = P(Y=1 \\mid \\tilde{A}=a, G=g)$。\n$$ \\mathrm{IC}_{\\tilde{A},G} = \\tilde{R}_{11} - \\tilde{R}_{10} - \\tilde{R}_{01} + \\tilde{R}_{00} $$\n这个表达式，代入为每个 $\\tilde{R}_{ag}$ 推导出的公式，就是完整的解析解。现在，我们继续计算偏差的数值。\n\n首先，计算真实的交互作用对比 $\\mathrm{IC}_{A,G}$。\n$$ \\mathrm{IC}_{A,G} = R_{11} - R_{10} - R_{01} + R_{00} $$\n$$ \\mathrm{IC}_{A,G} = 0.20 - 0.12 - 0.08 + 0.05 = 0.05 $$\n\n接下来，整理给定的参数：\n- 组 $g=1$：$R_{11} = 0.20$，$R_{01} = 0.08$，$p_1 = 0.50$，$s_1 = 0.60$，$f_1 = 0.15$。\n- 组 $g=0$：$R_{10} = 0.12$，$R_{00} = 0.05$，$p_0 = 0.40$，$s_0 = 0.80$，$f_0 = 0.05$。\n\n现在，计算四个观测风险：\n1.  $\\tilde{R}_{11} = P(Y=1 \\mid \\tilde{A}=1, G=1)$:\n    分母：$s_1 p_1 + f_1(1-p_1) = (0.60)(0.50) + (0.15)(0.50) = 0.30 + 0.075 = 0.375$。\n    分子：$R_{11} s_1 p_1 + R_{01} f_1 (1-p_1) = (0.20)(0.60)(0.50) + (0.08)(0.15)(0.50) = 0.06 + 0.006 = 0.066$。\n    $\\tilde{R}_{11} = \\frac{0.066}{0.375} = 0.176$。\n\n2.  $\\tilde{R}_{10} = P(Y=1 \\mid \\tilde{A}=1, G=0)$:\n    分母：$s_0 p_0 + f_0(1-p_0) = (0.80)(0.40) + (0.05)(0.60) = 0.32 + 0.03 = 0.35$。\n    分子：$R_{10} s_0 p_0 + R_{00} f_0(1-p_0) = (0.12)(0.80)(0.40) + (0.05)(0.05)(0.60) = 0.0384 + 0.0015 = 0.0399$。\n    $\\tilde{R}_{10} = \\frac{0.0399}{0.35} = 0.114$。\n\n3.  $\\tilde{R}_{01} = P(Y=1 \\mid \\tilde{A}=0, G=1)$:\n    分母：$(1-s_1)p_1 + (1-f_1)(1-p_1) = (0.40)(0.50) + (0.85)(0.50) = 0.20 + 0.425 = 0.625$。\n    分子：$R_{11}(1-s_1)p_1 + R_{01}(1-f_1)(1-p_1) = (0.20)(0.40)(0.50) + (0.08)(0.85)(0.50) = 0.04 + 0.034 = 0.074$。\n    $\\tilde{R}_{01} = \\frac{0.074}{0.625} = 0.1184$。\n\n4.  $\\tilde{R}_{00} = P(Y=1 \\mid \\tilde{A}=0, G=0)$:\n    分母：$(1-s_0)p_0 + (1-f_0)(1-p_0) = (0.20)(0.40) + (0.95)(0.60) = 0.08 + 0.57 = 0.65$。\n    分子：$R_{10}(1-s_0)p_0 + R_{00}(1-f_0)(1-p_0) = (0.12)(0.20)(0.40) + (0.05)(0.95)(0.60) = 0.0096 + 0.0285 = 0.0381$。\n    $\\tilde{R}_{00} = \\frac{0.0381}{0.65} \\approx 0.05861538$。\n\n现在，计算观测到的交互作用对比 $\\mathrm{IC}_{\\tilde{A},G}$。\n$$ \\mathrm{IC}_{\\tilde{A},G} = \\tilde{R}_{11} - \\tilde{R}_{10} - \\tilde{R}_{01} + \\tilde{R}_{00} $$\n$$ \\mathrm{IC}_{\\tilde{A},G} = 0.176 - 0.114 - 0.1184 + 0.05861538 \\dots = 0.00221538 \\dots $$\n\n最后，计算偏差，即观测到的与真实的交互作用对比之间的差异。\n$$ \\mathrm{Bias} = \\mathrm{IC}_{\\tilde{A},G} - \\mathrm{IC}_{A,G} $$\n$$ \\mathrm{Bias} = 0.00221538 \\dots - 0.05 = -0.04778461 \\dots $$\n四舍五入到四位有效数字，偏差为 $-0.04778$。", "answer": "$$\n\\boxed{-0.04778}\n$$", "id": "4987560"}, {"introduction": "除了测量误差，研究参与者的选择过程本身也可能成为偏倚的来源，这被称为“选择偏倚”(selection bias)。例如，在专科诊所进行的病例对照研究可能会因不同族裔的转诊模式差异而无法代表整个目标人群。这项练习不仅阐明了这种偏倚如何扭曲因果关联的估计，更重要的是，它将指导你应用“逆选择概率加权”(Inverse Probability of Selection Weighting, IPSW)这一强大技术，从有偏倚的样本数据中重建一个无偏的伪人群，并据此估算出校正后的因果风险比 [@problem_id:4987625]。", "problem": "一个转化医学团队正在评估，在一个从专科诊所抽取的病例-对照研究中，按种族划分的不平等转诊模式如何影响对生物标志物阳性对某种疾病的因果效应的估计。令 $E \\in \\{0,1\\}$ 表示暴露（生物标志物阴性或阳性），$D \\in \\{0,1\\}$ 表示疾病状态（无疾病或有疾病），$R \\in \\{\\text{African American}, \\text{White}\\}$ 表示种族，以及 $S \\in \\{0,1\\}$ 表示是否被选择进入诊所的病例-对照样本。目标因果参数是源人群中的因果风险比 $\\mathrm{RR} = \\Pr(D=1 \\mid \\operatorname{do}(E=1)) / \\Pr(D=1 \\mid \\operatorname{do}(E=0))$。\n\n以下信息可用且有科学依据：\n- 根据卫生系统数据估计的诊所转诊（选择）概率满足 $S \\perp E \\mid (D,R)$，具体如下：\n  $\\Pr(S=1 \\mid D=1, R=\\text{African American}) = 0.12$，$\\Pr(S=1 \\mid D=1, R=\\text{White}) = 0.20$，$\\Pr(S=1 \\mid D=0, R=\\text{African American}) = 0.06$，$\\Pr(S=1 \\mid D=0, R=\\text{White}) = 0.10$。\n- 诊所样本中观察到的病例-对照计数如下：\n  在病例中 ($D=1$)：$E=1$ 且 $R=\\text{African American}$: $80$；$E=1$ 且 $R=\\text{White}$: $120$；$E=0$ 且 $R=\\text{African American}$: $40$；$E=0$ 且 $R=\\text{White}$: $60$。\n  在对照组中 ($D=0$)：$E=1$ 且 $R=\\text{African American}$: $50$；$E=1$ 且 $R=\\text{White}$: $100$；$E=0$ 且 $R=\\text{African American}$: $130$；$E=0$ 且 $R=\\text{White}$: $180$。\n\n从风险、比值和选择的核心定义出发，并假设在种族条件下满足可交换性（对于 $e \\in \\{0,1\\}$，$D(e) \\perp E \\mid R$）、一致性和正值性，推导在何种条件下，被选个体中的比值比 $\\mathrm{OR}_{S=1}$ 是对人群因果风险比的有偏估计。然后，提出并应用一种选择概率倒数加权策略来纠正该偏倚，并从所选数据中恢复对因果风险比的估计。\n\n使用权重 $w(d,r) = 1/\\Pr(S=1 \\mid D=d, R=r)$ 对提供的计数进行加权，计算选择概率倒数加权的风险比，并将权重视为已知。将最终答案表示为单个实数。将答案四舍五入至四位有效数字。", "solution": "用户提供的问题已经过评估，并被确定为有效。该问题科学地基于因果推断和流行病学的原理，问题设定良好，数据充分且一致，表述客观。因此，我们可以进行正式求解。\n\n该问题要求我们首先理解在何种条件下，所选样本中观察到的比值比会成为源人群中因果风险比的有偏估计量，然后应用一种校正方法以获得无偏估计。\n\n首先，我们定义感兴趣的因果参数，即因果风险比 ($RR$)：\n$$\n\\mathrm{RR} = \\frac{\\Pr(D=1 \\mid \\operatorname{do}(E=1))}{\\Pr(D=1 \\mid \\operatorname{do}(E=0))}\n$$\n此处，$D(e)$ 表示个体在暴露水平（可能与事实相反）为 $E=e$ 时的潜在疾病状态结果。表达式 $\\Pr(D=1 \\mid \\operatorname{do}(E=e))$ 是 $\\Pr(D(e)=1)$ 的简写。\n\n问题给出了在种族（$R$）条件下的关键假设：可交换性 $D(e) \\perp E \\mid R$。连同一致性（$D=D(E)$）和正值性，该假设允许我们将因果风险与源人群中的条件概率等同起来，并根据种族分布进行标准化：\n$$\n\\Pr(D(e)=1) = \\sum_{r \\in \\{\\text{AA}, \\text{W}\\}} \\Pr(D(e)=1 \\mid R=r) \\Pr(R=r)\n$$\n根据可交换性，$\\Pr(D(e)=1 \\mid R=r) = \\Pr(D(e)=1 \\mid E=e, R=r)$，再根据一致性，这等于 $\\Pr(D=1 \\mid E=e, R=r)$。因此，因果风险比等价于源人群中的标准化风险比：\n$$\n\\mathrm{RR} = \\frac{\\sum_{r} \\Pr(D=1 \\mid E=1, R=r) \\Pr(R=r)}{\\sum_{r} \\Pr(D=1 \\mid E=0, R=r) \\Pr(R=r)}\n$$\n然而，数据来自从专科诊所抽取的病例-对照样本（$S=1$）。在此类研究中，通常计算比值比。所选样本中的比值比 $\\mathrm{OR}_{S=1}$ 由下式给出：\n$$\n\\mathrm{OR}_{S=1} = \\frac{\\Pr(E=1|D=1,S=1)/\\Pr(E=0|D=1,S=1)}{\\Pr(E=1|D=0,S=1)/\\Pr(E=0|D=0,S=1)}\n$$\n由于选择偏倚，该度量是目标因果风险比（甚至是人群比值比）的有偏估计。偏倚的产生是因为样本入选（$S=1$）同时依赖于疾病状态（$D$）和种族（$R$）。所提供的条件独立性陈述 $S \\perp E \\mid (D,R)$ 表明，在疾病和种族的分层内，暴露状态不影响选择。然而，选择概率 $\\Pr(S=1 \\mid D=d, R=r)$ 在这些分层中并非均一。具体来说，$\\Pr(S=1 \\mid D,R)$ 因 $D$ 和 $R$ 的不同而异。如果在人群中，种族 $R$ 也与暴露 $E$ 相关（这是健康差异研究中的常见情况，其中 $R$ 可能是暴露模式和疾病风险的共同原因），那么以选择 $S$ 为条件会引发 $E$ 和 $D$ 之间的伪关联。这是一种对撞因子分层偏倚，其中 $S$ 是 $E$ 和 $D$ 之间非因果路径上的一个对撞因子（或对撞因子的后代）。产生偏倚的条件正是这种基于 $D$ 和 $E$ 与 $D$ 的共同原因（如 $R$）的联合值的差异化选择。\n\n为纠正此偏倚，我们使用选择概率倒数加权（IPSW）策略。所选样本中的每个观测值都按其被选择概率的倒数进行加权。疾病状态为 $d$、种族为 $r$ 的个体的权重为：\n$$\nw(d,r) = \\frac{1}{\\Pr(S=1 \\mid D=d, R=r)}\n$$\n将这些权重应用于来自样本（$S=1$）的观察计数 $N_{edr}$，使我们能够重建一个伪人群，其构成在期望上与原始源人群的构成成比例。每个分层的加权计数为 $N^*_{edr} = N_{edr} \\times w(d,r)$。然后我们可以直接从这个伪人群中计算风险比。\n\n给定的选择概率及其对应的权重如下：\n令 $r_1$ 表示 African American，$r_2$ 表示 White。\n-   $\\Pr(S=1 \\mid D=1, R=r_1) = 0.12 \\implies w(1, r_1) = 1/0.12$\n-   $\\Pr(S=1 \\mid D=1, R=r_2) = 0.20 \\implies w(1, r_2) = 1/0.20 = 5$\n-   $\\Pr(S=1 \\mid D=0, R=r_1) = 0.06 \\implies w(0, r_1) = 1/0.06$\n-   $\\Pr(S=1 \\mid D=0, R=r_2) = 0.10 \\implies w(0, r_2) = 1/0.10 = 10$\n\n诊所样本（$S=1$）中观察到的计数（$N_{edr}$）如下：\n-   $N_{11r_1} = 80$ ($E=1, D=1, R=r_1$)\n-   $N_{11r_2} = 120$ ($E=1, D=1, R=r_2$)\n-   $N_{01r_1} = 40$ ($E=0, D=1, R=r_1$)\n-   $N_{01r_2} = 60$ ($E=0, D=1, R=r_2$)\n-   $N_{10r_1} = 50$ ($E=1, D=0, R=r_1$)\n-   $N_{10r_2} = 100$ ($E=1, D=0, R=r_2$)\n-   $N_{00r_1} = 130$ ($E=0, D=0, R=r_1$)\n-   $N_{00r_2} = 180$ ($E=0, D=0, R=r_2$)\n\n现在我们计算伪人群的加权计数（$N^*_{edr}$）：\n-   $N^*_{11r_1} = 80 \\times (1/0.12) = 8000/12 = 2000/3$\n-   $N^*_{11r_2} = 120 \\times 5 = 600$\n-   $N^*_{01r_1} = 40 \\times (1/0.12) = 4000/12 = 1000/3$\n-   $N^*_{01r_2} = 60 \\times 5 = 300$\n-   $N^*_{10r_1} = 50 \\times (1/0.06) = 5000/6 = 2500/3$\n-   $N^*_{10r_2} = 100 \\times 10 = 1000$\n-   $N^*_{00r_1} = 130 \\times (1/0.06) = 13000/6 = 6500/3$\n-   $N^*_{00r_2} = 180 \\times 10 = 1800$\n\n接下来，我们汇总这些加权计数，以估计源人群中每个暴露水平下的病例总数和非病例总数。\n暴露 $E=1$ 的总加权病例数：\n$$N^*_{11} = N^*_{11r_1} + N^*_{11r_2} = \\frac{2000}{3} + 600 = \\frac{2000+1800}{3} = \\frac{3800}{3}$$\n暴露 $E=1$ 的总加权非病例数（对照组）：\n$$N^*_{10} = N^*_{10r_1} + N^*_{10r_2} = \\frac{2500}{3} + 1000 = \\frac{2500+3000}{3} = \\frac{5500}{3}$$\n暴露 $E=0$ 的总加权病例数：\n$$N^*_{01} = N^*_{01r_1} + N^*_{01r_2} = \\frac{1000}{3} + 300 = \\frac{1000+900}{3} = \\frac{1900}{3}$$\n暴露 $E=0$ 的总加权非病例数（对照组）：\n$$N^*_{00} = N^*_{00r_1} + N^*_{00r_2} = \\frac{6500}{3} + 1800 = \\frac{6500+5400}{3} = \\frac{11900}{3}$$\n\n现在，我们根据伪人群计数计算每个暴露组的估计风险。\n$E=1$ 的总加权个体数：\n$$N^*_{1 \\cdot} = N^*_{11} + N^*_{10} = \\frac{3800}{3} + \\frac{5500}{3} = \\frac{9300}{3} = 3100$$\n$E=0$ 的总加权个体数：\n$$N^*_{0 \\cdot} = N^*_{01} + N^*_{00} = \\frac{1900}{3} + \\frac{11900}{3} = \\frac{13800}{3} = 4600$$\n\n暴露组的估计风险为：\n$$\\hat{\\Pr}(D=1 \\mid E=1) = \\frac{N^*_{11}}{N^*_{1 \\cdot}} = \\frac{3800/3}{3100} = \\frac{3800}{3 \\times 3100} = \\frac{38}{93}$$\n未暴露组的估计风险为：\n$$\\hat{\\Pr}(D=1 \\mid E=0) = \\frac{N^*_{01}}{N^*_{0 \\cdot}} = \\frac{1900/3}{4600} = \\frac{1900}{3 \\times 4600} = \\frac{19}{138}$$\n最后，经过 IPSW 校正的因果风险比估计值是这两个风险的比率：\n$$\\widehat{\\mathrm{RR}}_{\\mathrm{IPSW}} = \\frac{\\hat{\\Pr}(D=1 \\mid E=1)}{\\hat{\\Pr}(D=1 \\mid E=0)} = \\frac{38/93}{19/138} = \\frac{38}{93} \\times \\frac{138}{19} = \\frac{2 \\times 19}{3 \\times 31} \\times \\frac{3 \\times 46}{19} = \\frac{2 \\times 46}{31} = \\frac{92}{31}$$\n为获得最终数值答案，我们计算该分数值并四舍五入到四位有效数字：\n$$\\frac{92}{31} \\approx 2.9677419...$$\n四舍五入到四位有效数字得到 $2.968$。", "answer": "$$\n\\boxed{2.968}\n$$", "id": "4987625"}]}