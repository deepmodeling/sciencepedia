{"hands_on_practices": [{"introduction": "卫生技术评估（HTA）的核心在于量化评估一项新技术相对于现有标准治疗在成本和效果上的增量差异。增量成本效果比（ICER）是这一评估过程中的基础性指标，它概括了每获得一个单位健康收益（如一个质量调整生命年，QALY）所需付出的额外成本。本练习旨在通过一个基础计算，帮助您掌握ICER的正式定义和计算方法，并学会如何根据既定的支付意愿阈值（$ \\lambda $）来做出成本效果决策，这是所有HTA分析的起点[@problem_id:5019035]。", "problem": "一项寻求在联合王国内由英国国家卫生与临床优化研究所（NICE）进行评估的转化再生疗法，必须通过正式的卫生技术评估（HTA）流程进行评价。考虑一个比较该疗法与当前标准治疗的基础案例增量分析。现给出该疗法经试验综合得出的增量结果：增量成本 $\\Delta C = 50000$ 英镑（GBP），增量健康获益 $\\Delta E = 1.5$ 质量调整生命年（QALYs）。成本效益决策由支付意愿阈值 $\\lambda = 30000$ 英镑/QALY 指导。\n\n请从卫生技术评估（HTA）的基本定义和决策规则出发，并且不使用任何非由这些基础推导出的简化表达式，计算增量成本效果比（ICER），并确定在基础案例下，该疗法在给定阈值时是否被视为具有成本效益。在计算ICER时，将 $\\Delta E$ 视为严格为正。您必须：\n\n- 使用ICER关于增量成本和增量效果的正式定义。\n- 应用源自净效益框架的决策规则，该规则将阈值 $\\lambda$ 与增量成本和效果联系起来。\n\n将ICER作为您的最终数值答案，四舍五入至四位有效数字。以英镑/QALY为单位表示ICER。在您的推理中，明确使用基于阈值的规则来证明成本效益决策的合理性。最终方框答案中不要包含单位；单位只应在问题陈述中说明。", "solution": "首先对问题进行验证。\n\n**步骤1：提取已知条件**\n- 增量成本：$\\Delta C = 50000$ GBP\n- 增量健康获益：$\\Delta E = 1.5$ QALYs\n- 支付意愿阈值：$\\lambda = 30000$ GBP/QALY\n- 约束1：将 $\\Delta E$ 视为严格为正（$\\Delta E > 0$）。\n- 约束2：解答必须从卫生技术评估（HTA）的基本定义出发。\n- 约束3：决策规则必须从净效益框架推导得出。\n- 约束4：最终ICER值必须四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于卫生经济学和卫生技术评估（HTA）的既定原则。增量成本效果比（ICER）、质量调整生命年（QALYs）和支付意愿阈值等概念是该领域中标准的、定义明确的度量指标。问题提法明确，为获得唯一解提供了所有必要数据（$\\Delta C$、$\\Delta E$、$\\lambda$）。语言客观而精确。所提供的值在评估一种新的再生疗法的背景下是合理的。不存在科学或逻辑上的缺陷。\n\n**步骤3：结论与行动**\n问题被视为有效。将构建完整的解答。\n\n解答过程首先定义并计算增量成本效果比（ICER），然后基于净效益框架推导并应用相应的决策规则。\n\nICER的正式定义是，一项新干预措施与其标准治疗相比的增量成本，与其增量健康效果之比。设新疗法为干预措施A，标准治疗为干预措施B。增量成本为 $\\Delta C = C_A - C_B$，增量效果为 $\\Delta E = E_A - E_B$。因此，ICER定义为：\n$$\n\\text{ICER} = \\frac{\\Delta C}{\\Delta E}\n$$\n问题规定 $\\Delta E$ 被视为严格为正，这确保了ICER有明确定义并避免了除以零的情况。\n\n使用所提供的值，我们可以计算ICER：\n$$\n\\Delta C = 50000\n$$\n$$\n\\Delta E = 1.5\n$$\n将这些值代入定义中：\n$$\n\\text{ICER} = \\frac{50000}{1.5} = 33333.\\overline{3}\n$$\n问题要求将此值四舍五入至四位有效数字。前四位有效数字是 $3$、$3$、$3$ 和 $3$。第五位数字是 $3$，小于 $5$，因此我们向下取整。这意味着第四位有效数字后面的数字被零替换。\n$$\n\\text{ICER} \\approx 33330\n$$\n\n接下来，我们必须通过应用从净效益框架推导出的决策规则来确定该疗法是否具有成本效益。一项干预措施的净货币效益（NMB）定义为 $NMB = (\\lambda \\times E) - C$，其中 $\\lambda$ 是对单位健康效果 $E$ 的支付意愿阈值。如果一项新干预措施的增量净货币效益（INMB）为正，则认为其优于标准治疗。\n$$\n\\text{INMB} = NMB_A - NMB_B = ((\\lambda \\times E_A) - C_A) - ((\\lambda \\times E_B) - C_B)\n$$\n整理各项得：\n$$\n\\text{INMB} = \\lambda(E_A - E_B) - (C_A - C_B) = (\\lambda \\times \\Delta E) - \\Delta C\n$$\n成本效益的决策规则是 $INMB > 0$。因此，如果满足以下条件，该疗法被视为具有成本效益：\n$$\n(\\lambda \\times \\Delta E) - \\Delta C > 0\n$$\n这可以重新整理为：\n$$\n\\lambda \\times \\Delta E > \\Delta C\n$$\n因为给定 $\\Delta E > 0$，我们可以在不等式两边同时除以 $\\Delta E$ 而不改变其方向：\n$$\n\\lambda > \\frac{\\Delta C}{\\Delta E}\n$$\n这就建立了决策规则：如果支付意愿阈值 $\\lambda$ 大于ICER，则疗法具有成本效益。\n\n现在，我们使用给定的阈值和计算出的ICER来应用此规则。\n- 支付意愿阈值为 $\\lambda = 30000$。\n- 计算出的ICER约为 $33330$。\n\n我们必须检查条件 $\\lambda > \\text{ICER}$ 是否满足。\n$$\n30000 > 33330\n$$\n此不等式不成立。由于支付意愿阈值小于增量成本效果比（$\\lambda  \\text{ICER}$），因此在指定的基础案例条件和阈值下，该疗法不会被视为具有成本效益。\n\n问题要求将ICER作为最终数值答案，并四舍五入至四位有效数字。", "answer": "$$\\boxed{33330}$$", "id": "5019035"}, {"introduction": "HTA模型的结论往往依赖于一系列参数假设，而这些参数本身具有不确定性。因此，在得出基础案例结论后，进行敏感性分析是至关重要的一步，它能帮助我们理解结论对关键参数变化的稳健性。本练习[@problem_id:5019080]将指导您设计并执行一个单向敏感性分析，通过探索模型中一个关键参数（进展期疾病状态的效用值）的变化如何影响最终的ICER，您将学会确定导致决策反转的“临界点”，从而识别出对模型结果影响最大的不确定性来源。", "problem": "一种肿瘤疗法由一个卫生技术评估 (HTA) 机构使用一个状态转换模型进行评估，该模型包含两个生存健康状态：无进展 (PF) 和疾病进展 (PD)，之后是死亡。新疗法相对于对照疗法，在每个生存状态下的预期贴现增量时间如下：无进展时间增加 $\\Delta t_{\\mathrm{PF}} = 0.30$ 年，疾病进展时间增加 $\\Delta t_{\\mathrm{PD}} = 0.25$ 年。基准案例的效用权重为：无进展状态 $u_{\\mathrm{PF}} = 0.82$，疾病进展状态的基准效用为 $u_{\\mathrm{PD},0} = 0.58$。基准案例的增量成本效果比 ($ICER$) 为 $40000$（货币单位/质量调整生命年）。\n\n根据 HTA 机构使用的定义，质量调整生命年 (QALYs) 是在每个健康状态下的时间由其效用加权得到，而增量成本效果比是增量成本除以增量 QALYs。假设增量成本和状态时间估计值不受疾病进展状态效用变化的影响，并且在单向敏感性分析中只改变疾病进展状态的效用。\n\n请设计一个单向敏感性分析计划，在该计划中，将疾病进展状态效用 $u_{\\mathrm{PD}}$ 在其基准值 $u_{\\mathrm{PD},0}$ 的基础上上下浮动 $20\\%$，同时保持所有其他输入参数固定。然后，确定阈值 $u_{\\mathrm{PD}}^{\\ast}$，在该阈值下 $ICER$ 将等于 $50000$（货币单位/质量调整生命年），这是 HTA 机构在特定情况下有时会参考的一个决策标准。将最终的效用阈值表示为一个无单位的数字，并将您的答案四舍五入到三位有效数字。", "solution": "该问题是有效的。它在科学上基于卫生经济学和卫生技术评估 (HTA) 的原则，问题陈述清晰，提供了足够的信息以获得唯一解，并且其表述客观、明确。\n\n该问题要求我们首先设计一个单向敏感性分析计划，然后确定模型参数的一个特定阈值。让我们首先根据所提供的信息来定义核心概念和方程式。\n\n增量质量调整生命年（记为 $\\Delta Q$）的计算方法为：将每个健康状态下的增量时间与其各自的效用值相乘，然后求和。对于无进展 (PF) 和疾病进展 (PD) 这两个生存状态，其方程为：\n$$\n\\Delta Q = u_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}} + u_{\\mathrm{PD}} \\Delta t_{\\mathrm{PD}}\n$$\n其中 $u_{\\mathrm{PF}}$ 和 $u_{\\mathrm{PD}}$ 分别是无进展和疾病进展状态的效用权重，而 $\\Delta t_{\\mathrm{PF}}$ 和 $\\Delta t_{\\mathrm{PD}}$ 是新疗法相对于对照疗法在这些状态下的增量时间。\n\n增量成本效果比 ($ICER$) 定义为增量成本 ($\\Delta C$) 与增量 QALYs ($\\Delta Q$) 的比率：\n$$\nICER = \\frac{\\Delta C}{\\Delta Q}\n$$\n问题指明了以下基准案例值：\n- 无进展状态的增量时间：$\\Delta t_{\\mathrm{PF}} = 0.30$ 年\n- 疾病进展状态的增量时间：$\\Delta t_{\\mathrm{PD}} = 0.25$ 年\n- 无进展状态的效用：$u_{\\mathrm{PF}} = 0.82$\n- 疾病进展状态的基准效用：$u_{\\mathrm{PD},0} = 0.58$\n- 基准 $ICER_0 = 40000$（货币单位/QALY）\n\n根据要求，单向敏感性分析计划设计如下：\n1.  **关注参数**：疾病进展状态的效用，$u_{\\mathrm{PD}}$。\n2.  **变动范围**：参数 $u_{\\mathrm{PD}}$ 将在其基准值 $u_{\\mathrm{PD},0} = 0.58$ 的基础上变动 $\\pm 20\\%$。这对应于范围 $[0.58 \\times (1 - 0.20), 0.58 \\times (1 + 0.20)]$，即 $[0.464, 0.696]$。\n3.  **输出指标**：该分析将检验改变 $u_{\\mathrm{PD}}$ 对 $ICER$ 的影响。\n4.  **其他条件不变原则**：所有其他模型输入，特别是增量成本 $\\Delta C$、状态时间估计值 $\\Delta t_{\\mathrm{PF}}$ 和 $\\Delta t_{\\mathrm{PD}}$，以及效用 $u_{\\mathrm{PF}}$，都保持其基准值不变。\n5.  **阈值分析**：此分析的一个特定部分是确定 $u_{\\mathrm{PD}}$ 的阈值，记为 $u_{\\mathrm{PD}}^{\\ast}$，在该阈值下，$ICER$ 等于一个特定的支付意愿阈值，即 $50000$ 货币单位/QALY。\n\n为了进行阈值分析，我们必须首先确定增量成本 $\\Delta C$。该值在整个分析中被假定为恒定的。我们可以从基准案例场景中计算出它。\n\n首先，我们计算基准案例的增量 QALYs，$\\Delta Q_0$：\n$$\n\\Delta Q_0 = u_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}} + u_{\\mathrm{PD},0} \\Delta t_{\\mathrm{PD}}\n$$\n代入给定值：\n$$\n\\Delta Q_0 = (0.82)(0.30) + (0.58)(0.25) = 0.246 + 0.145 = 0.391 \\text{ QALYs}\n$$\n接下来，使用基准 $ICER_0 = 40000$，我们求出增量成本 $\\Delta C$：\n$$\n\\Delta C = ICER_0 \\times \\Delta Q_0 = 40000 \\times 0.391 = 15640 \\text{ 货币单位}\n$$\n现在，我们可以为新的 $ICER$ 场景建立方程。我们正在寻找能使 $ICER$ 达到 $50000$ 的值 $u_{\\mathrm{PD}}^{\\ast}$。设这个目标 $ICER$ 为 $ICER_{target} = 50000$。相应的增量 QALYs，$\\Delta Q_{new}$，将是：\n$$\n\\Delta Q_{new} = u_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}} + u_{\\mathrm{PD}}^{\\ast} \\Delta t_{\\mathrm{PD}}\n$$\n目标 $ICER$ 的方程是：\n$$\nICER_{target} = \\frac{\\Delta C}{\\Delta Q_{new}} = \\frac{\\Delta C}{u_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}} + u_{\\mathrm{PD}}^{\\ast} \\Delta t_{\\mathrm{PD}}}\n$$\n我们需要求解 $u_{\\mathrm{PD}}^{\\ast}$。整理方程可得：\n$$\nu_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}} + u_{\\mathrm{PD}}^{\\ast} \\Delta t_{\\mathrm{PD}} = \\frac{\\Delta C}{ICER_{target}}\n$$\n$$\nu_{\\mathrm{PD}}^{\\ast} \\Delta t_{\\mathrm{PD}} = \\frac{\\Delta C}{ICER_{target}} - u_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}}\n$$\n$$\nu_{\\mathrm{PD}}^{\\ast} = \\frac{1}{\\Delta t_{\\mathrm{PD}}} \\left( \\frac{\\Delta C}{ICER_{target}} - u_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}} \\right)\n$$\n现在我们将已知值代入此表达式：\n- $\\Delta C = 15640$\n- $ICER_{target} = 50000$\n- $\\Delta t_{\\mathrm{PD}} = 0.25$\n- $u_{\\mathrm{PF}} = 0.82$\n- $\\Delta t_{\\mathrm{PF}} = 0.30$\n\n项 $u_{\\mathrm{PF}} \\Delta t_{\\mathrm{PF}}$ 为 $0.82 \\times 0.30 = 0.246$。\n项 $\\frac{\\Delta C}{ICER_{target}}$ 为 $\\frac{15640}{50000} = 0.3128$。\n\n将这些代入 $u_{\\mathrm{PD}}^{\\ast}$ 的方程中：\n$$\nu_{\\mathrm{PD}}^{\\ast} = \\frac{1}{0.25} (0.3128 - 0.246)\n$$\n$$\nu_{\\mathrm{PD}}^{\\ast} = 4 \\times (0.0668)\n$$\n$$\nu_{\\mathrm{PD}}^{\\ast} = 0.2672\n$$\n问题要求将最终答案四舍五入到三位有效数字。\n$$\nu_{\\mathrm{PD}}^{\\ast} \\approx 0.267\n$$\n这就是在所有其他参数保持不变的情况下，使得 ICER 正好等于 $50000$ 货币单位/QALY 的疾病进展状态效用的阈值。", "answer": "$$\n\\boxed{0.267}\n$$", "id": "5019080"}, {"introduction": "为了更全面地评估不确定性，现代HTA实践已从单向敏感性分析发展到概率敏感性分析（PSA），后者能够同时考虑模型中所有参数的联合不确定性。PSA的结果通常通过成本效果可接受性曲线（CEAC）来呈现，该曲线显示了在不同支付意愿阈值下，一项技术具有成本效果的概率。本练习[@problem_id:5019037]要求您通过编程实践，亲手构建CEAC，这是一个将数千次模拟结果转化为直观决策支持工具的高级技能，能让您深刻理解HTA如何量化并向决策者传达决策的不确定性。", "problem": "卫生技术评估 (HTA) 的决策过程通常会解读概率敏感性分析 (PSA) 的结果，以针对新干预措施相对于标准护理提出建议。该决策规则基于净获益框架：对于每个质量调整生命年 (QALY) 的给定支付意愿阈值（用 $\\lambda$ 表示，单位为货币单位/QALY），净货币效益 (NMB) 定义为 $NMB(\\lambda) = \\lambda \\times \\Delta E - \\Delta C$，其中 $\\Delta C$ 是新干预措施相对于比较对象的增量成本，$\\Delta E$ 是以 QALY 为单位的增量效果。如果 $NMB(\\lambda) \\ge 0$，则新干预措施为优选方案。在阈值 $\\lambda$ 下的成本效果可接受性曲线 (CEAC) 是在所有 PSA 迭代中 $NMB(\\lambda) \\ge 0$ 的概率。更一般地，通过在一系列 $\\lambda$ 值上评估此概率来构建 CEAC。在特定阈值下的成本效果概率即为在该 $\\lambda$ 值下评估的 CEAC。\n\n你的任务是编写一个程序，给定由成对的增量成本和效果组成的 $1000$ 次 PSA 迭代，构建在指定阈值网格上的 CEAC，并计算在 $\\lambda = 30000$（货币单位/QALY）时的成本效果概率。请使用以下在 HTA 实践中广泛接受的基本定义和规则：\n- 净货币效益 (NMB) 定义：$NMB(\\lambda) = \\lambda \\times \\Delta E - \\Delta C$。\n- 成本效果决策标准：如果 $NMB(\\lambda) \\ge 0$，则选择新干预措施。\n- 概率的 Monte Carlo 近似：如果 $\\{(\\Delta C_i, \\Delta E_i)\\}_{i=1}^N$ 是 PSA 抽样，那么在 $\\lambda$ 下的估计成本效果概率为 $\\hat{p}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^N \\mathbf{1}\\{\\lambda \\Delta E_i - \\Delta C_i \\ge 0\\}$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数，且 $N = 1000$。\n\n实现程序以计算：\n- 每个测试用例在 $\\lambda = 30000$ 时的成本效果概率，四舍五入到 $4$ 位小数。\n- CEAC，定义为在阈值网格 $\\lambda \\in \\{0, 10000, 20000, 30000, 40000, 50000\\}$ 上为每个测试用例计算的概率列表 $\\hat{p}(\\lambda)$，每个概率四舍五入到 $4$ 位小数。\n\n使用以下参数化的 PSA 数据集测试套件，以确保覆盖典型场景和边缘场景。在所有情况下，$N = 1000$ 次迭代。在指定随机生成的情况下，请使用按指定方式播种的独立伪随机数生成器，以确保结果是确定性的。\n\n测试用例 $1$（混合效益场景）：\n- 种子：$314159$。\n- 增量成本抽样：$\\Delta C_i \\sim \\mathcal{N}(500, 2000^2)$。\n- 增量效果抽样：$\\Delta E_i \\sim \\mathcal{N}(0.05, 0.1^2)$。\n- $\\Delta C_i$ 和 $\\Delta E_i$ 之间相互独立。\n\n测试用例 $2$（零点对称）：\n- 种子：$271828$。\n- 增量成本抽样：$\\Delta C_i \\sim \\mathcal{N}(0, 1000^2)$。\n- 增量效果抽样：$\\Delta E_i \\sim \\mathcal{N}(0, 0.05^2)$。\n- $\\Delta C_i$ 和 $\\Delta E_i$ 之间相互独立。\n\n测试用例 $3$（劣势场景，退化）：\n- 确定性数组：对于所有 $i \\in \\{1, \\dots, 1000\\}$，$\\Delta C_i = 2000$；对于所有 $i \\in \\{1, \\dots, 1000\\}$，$\\Delta E_i = 0$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。对于每个测试用例，输出一个双元素列表，其中第一个元素是在 $\\lambda = 30000$ 时的成本效果概率，第二个元素是在 $\\lambda \\in \\{0, 10000, 20000, 30000, 40000, 50000\\}$ 上评估的 CEAC 向量。具体来说，最终输出必须是以下形式\n$[[p_{30000}^{(1)}, [p_{0}^{(1)}, p_{10000}^{(1)}, p_{20000}^{(1)}, p_{30000}^{(1)}, p_{40000}^{(1)}, p_{50000}^{(1)}]], [p_{30000}^{(2)}, [\\dots]], [p_{30000}^{(3)}, [\\dots]]]$，\n其中每个 $p_{\\lambda}^{(k)}$ 对于测试用例 $k \\in \\{1,2,3\\}$ 都四舍五入到 $4$ 位小数。", "solution": "该问题是有效的。它提出了一个定义明确的计算任务，该任务基于卫生技术评估 (HTA) 和决策分析的标准原则。所提供的净货币效益 (NMB) 和成本效果可接受性曲线 (CEAC) 的定义在该领域是标准的。使用带有指定分布和种子的 Monte Carlo 模拟进行概率敏感性分析 (PSA) 是一个标准的、可形式化的程序。该问题是自洽的、科学上合理的且计算上可行的。\n\n在此，我们提供一个有原则的解决方案。目标是计算在一系列场景中，新卫生干预措施相对于比较对象具有成本效果的概率。这通过从模拟数据构建 CEAC 来实现。\n\n分析的核心在于净货币效益框架。对于一个给定的支付意愿阈值 $\\lambda$，它代表社会为一个质量调整生命年 (QALY) 所赋予的货币价值，NMB 定义如下：\n$$NMB(\\lambda) = \\lambda \\times \\Delta E - \\Delta C$$\n其中 $\\Delta C$ 表示新干预措施与标准护理相比的增量成本，$\\Delta E$ 表示增量效果（以 QALY 为单位）。如果一项新干预措施的 NMB 为非负，即 $NMB(\\lambda) \\ge 0$，则该干预措施被认为是具有成本效果的。\n\n由于 $\\Delta C$ 和 $\\Delta E$ 估计值的不确定性，我们从 PSA 中获得了 $N=1000$ 对抽样值 $\\{(\\Delta C_i, \\Delta E_i)\\}_{i=1}^N$。在给定阈值 $\\lambda$ 下的成本效果概率（表示为 $\\hat{p}(\\lambda)$）使用 Monte Carlo 方法进行估计。这涉及到计算满足成本效果标准的模拟所占的比例：\n$$ \\hat{p}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^N \\mathbf{1}\\{\\lambda \\Delta E_i - \\Delta C_i \\ge 0\\} $$\n此处，$\\mathbf{1}\\{\\cdot\\}$ 是指示函数，如果内部条件为真，则其值为 $1$，否则为 $0$。CEAC 是 $\\hat{p}(\\lambda)$ 相对于一系列 $\\lambda$ 值的绘图。\n\n解决此问题的算法方法对每个测试用例如下：\n\n1.  **数据生成**：第一步是生成 $N=1000$ 对 $(\\Delta C_i, \\Delta E_i)$。\n    *   对于测试用例 $1$ 和 $2$，这些是从指定的正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 中抽取的随机变量。为确保可复现性，每个用例都使用指定的种子初始化伪随机数生成器。我们生成两个长度为 $N=1000$ 的向量，一个用于 $\\Delta C$，一个用于 $\\Delta E$。\n    *   对于测试用例 $3$，这些值是确定性的。我们构建两个长度为 $N=1000$ 的常数向量，其中所有 $\\Delta C_i$ 均为 $2000$，所有 $\\Delta E_i$ 均为 $0$。\n\n2.  **CEAC 计算**：我们在指定的阈值网格 $\\lambda \\in \\{0, 10000, 20000, 30000, 40000, 50000\\}$ 上计算 CEAC。\n    *   对于网格中的每个 $\\lambda$ 值，我们为所有 $N=1000$ 次模拟计算 NMB。这通过向量化操作高效执行：标量 $\\lambda$ 乘以 $\\Delta E$ 值向量，然后减去 $\\Delta C$ 值向量。这将产生一个包含 $N=1000$ 个 NMB 值的向量。\n    *   接下来，我们将条件 $NMB \\ge 0$ 应用于此向量，得到一个长度为 $N=1000$ 的布尔向量。\n    *   此布尔向量的总和（其中 `True` 隐式视为 $1$，`False` 视为 $0$）给出了干预措施具有成本效果的模拟次数。\n    *   将此计数除以总模拟次数 $N=1000$，得到概率 $\\hat{p}(\\lambda)$。\n    *   按要求将计算出的概率四舍五入到 $4$ 位小数。\n    *   对网格中的每个 $\\lambda$ 重复此过程，并将得到的概率存储在一个列表中，该列表即构成 CEAC。\n\n3.  **结果聚合**：最后一步是将结果组合成指定格式。\n    *   对于每个测试用例，提取在 $\\lambda = 30000$ 时的成本效果概率。该值将是计算出的 CEAC 列表的第四个元素（索引为 $3$），对应于阈值网格中的第四个值。\n    *   每个用例的最终输出是一个包含此特定概率和完整 CEAC 列表的双元素列表。然后将这些结果聚合为所有测试用例的单个列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the probability of cost-effectiveness and the CEAC for three test cases\n    based on the Net Monetary Benefit framework and Probabilistic Sensitivity Analysis results.\n    \"\"\"\n    \n    # Define global parameters\n    N = 1000\n    LAMBDA_GRID = [0, 10000, 20000, 30000, 40000, 50000]\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"type\": \"random\",\n            \"params\": {\n                \"seed\": 314159,\n                \"cost_mean\": 500,\n                \"cost_std\": 2000,\n                \"effect_mean\": 0.05,\n                \"effect_std\": 0.1,\n            }\n        },\n        {\n            \"type\": \"random\",\n            \"params\": {\n                \"seed\": 271828,\n                \"cost_mean\": 0,\n                \"cost_std\": 1000,\n                \"effect_mean\": 0,\n                \"effect_std\": 0.05,\n            }\n        },\n        {\n            \"type\": \"deterministic\",\n            \"params\": {\n                \"cost_val\": 2000,\n                \"effect_val\": 0,\n            }\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        delta_c = None\n        delta_e = None\n\n        # Step 1: Generate or define the PSA data\n        if case[\"type\"] == \"random\":\n            p = case[\"params\"]\n            rng = np.random.default_rng(p[\"seed\"])\n            delta_c = rng.normal(loc=p[\"cost_mean\"], scale=p[\"cost_std\"], size=N)\n            delta_e = rng.normal(loc=p[\"effect_mean\"], scale=p[\"effect_std\"], size=N)\n        elif case[\"type\"] == \"deterministic\":\n            p = case[\"params\"]\n            delta_c = np.full(N, p[\"cost_val\"])\n            delta_e = np.full(N, p[\"effect_val\"])\n\n        # Step 2: Compute the CEAC\n        ceac = []\n        for lambda_val in LAMBDA_GRID:\n            # Calculate Net Monetary Benefit for all N simulations\n            nmb = lambda_val * delta_e - delta_c\n            \n            # Count simulations where NMB = 0\n            count_cost_effective = np.sum(nmb = 0)\n            \n            # Calculate the probability and round to 4 decimal places\n            prob_cost_effective = round(count_cost_effective / N, 4)\n            ceac.append(prob_cost_effective)\n            \n        # Step 3: Extract the probability at lambda = 30000\n        # The index for lambda=30000 in LAMBDA_GRID is 3\n        p_30000 = ceac[3]\n        \n        # Step 4: Format the result for this case\n        case_result = [p_30000, ceac]\n        all_results.append(case_result)\n\n    # Format the final output string to match the exact requirement (no spaces)\n    final_output_str = str(all_results).replace(\" \", \"\")\n    \n    # Final print statement in the exact required format\n    print(final_output_str)\n\nsolve()\n```", "id": "5019037"}]}