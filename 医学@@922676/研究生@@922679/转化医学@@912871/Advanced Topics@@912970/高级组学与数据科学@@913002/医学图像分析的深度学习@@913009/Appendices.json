{"hands_on_practices": [{"introduction": "原始的医学影像数据，如CT扫描，通常具有很宽的动态范围，不经处理直接输入神经网络可能会影响模型的学习效率和性能。本练习将引导您实践一个关键的两步预处理流程：首先，通过“窗位”（windowing）技术分离出感兴趣的组织；然后，进行标准化（normalization），为网络提供稳定的输入。通过这个计算 [@problem_id:5004651]，您将清晰地理解这两种重要的预处理技术在将原始亨氏单位（Hounsfield Units, HU）值转换为最终网络输入值时各自扮演的角色。", "problem": "计算机断层扫描 (CT) 为每个体素赋予一个以亨斯菲尔德单位 (HU) 表示的强度值，该值由线性变换 $HU = 1000 \\cdot \\frac{\\mu - \\mu_{\\text{water}}}{\\mu_{\\text{water}}}$ 定义，其中 $\\mu$ 是物质的线性衰减系数，$\\mu_{\\text{water}}$ 是水的线性衰减系数。在用于转化医学的临床影像到学习流程中，会使用窗位窗宽技术来限制和重新缩放HU值的动态范围，以突出感兴趣的组织，然后才将其输入到卷积神经网络 (CNN) 中。窗位中心为 $c$、窗宽为 $w$ 的窗位窗宽技术定义了一个下界 $L = c - \\frac{w}{2}$ 和一个上界 $U = c + \\frac{w}{2}$，将HU值裁剪到区间 $[L, U]$ 内，并将裁剪后的强度线性重新缩放至 $[0, 1]$ 上的无量纲值。另外，归一化是一种统计变换（例如，$z$-分数归一化），它使用数据集级别的矩来标准化输入到CNN的重新缩放后的值。\n\n考虑一个以窗位中心 $c = -600$ 和窗宽 $w = 1500$ 为特征的肺窗。设训练数据集中在 $[0, 1]$ 上经过窗位窗宽调整和重新缩放后的强度的经验均值为 $\\mu = 0.42$，标准差为 $\\sigma = 0.18$。单个体素的原始强度为 $HU = -750$。请仅使用上述定义以及仿射映射和统计标准化的第一性原理，计算在应用肺窗和随后的$z$-分数归一化之后，进入CNN第一层的单个标量值。\n\n将您的最终数值答案四舍五入到四位有效数字。将答案表示为无量纲的小数。", "solution": "用户希望我解决以下问题：\n计算机断层扫描 (CT) 为每个体素赋予一个以亨斯菲尔德单位 (HU) 表示的强度值，该值由线性变换 $HU = 1000 \\cdot \\frac{\\mu - \\mu_{\\text{water}}}{\\mu_{\\text{water}}}$ 定义，其中 $\\mu$ 是物质的线性衰减系数，$\\mu_{\\text{water}}$ 是水的线性衰减系数。在用于转化医学的临床影像到学习流程中，会使用窗位窗宽技术来限制和重新缩放HU值的动态范围，以突出感兴趣的组织，然后才将其输入到卷积神经网络 (CNN) 中。窗位中心为 $c$、窗宽为 $w$ 的窗位窗宽技术定义了一个下界 $L = c - \\frac{w}{2}$ 和一个上界 $U = c + \\frac{w}{2}$，将HU值裁剪到区间 $[L, U]$ 内，并将裁剪后的强度线性重新缩放至 $[0, 1]$ 上的无量纲值。另外，归一化是一种统计变换（例如，$z$-分数归一化），它使用数据集级别的矩来标准化输入到CNN的重新缩放后的值。\n\n考虑一个以窗位中心 $c = -600$ 和窗宽 $w = 1500$ 为特征的肺窗。设训练数据集中在 $[0, 1]$ 上经过窗位窗宽调整和重新缩放后的强度的经验均值为 $\\mu = 0.42$，标准差为 $\\sigma = 0.18$。单个体素的原始强度为 $HU = -750$。请仅使用上述定义以及仿射映射和统计标准化的第一性原理，计算在应用肺窗和随后的$z$-分数归一化之后，进入CNN第一层的单个标量值。\n\n将您的最终数值答案四舍五入到四位有效数字。将答案表示为无量纲的小数。\n\n### 步骤1：提取已知条件\n\n-   亨斯菲尔德单位 (HU) 定义：$HU = 1000 \\cdot \\frac{\\mu_{material} - \\mu_{\\text{water}}}{\\mu_{\\text{water}}}$\n-   窗位下界：$L = c - \\frac{w}{2}$\n-   窗位上界：$U = c + \\frac{w}{2}$\n-   窗位窗宽调整过程：\n    1.  将 $HU$ 裁剪到区间 $[L, U]$。\n    2.  将裁剪后的强度线性重新缩放至 $[0, 1]$。\n-   归一化过程：使用数据集级别的矩进行$z$-分数归一化。\n-   肺窗中心：$c = -600$\n-   肺窗宽度：$w = 1500$\n-   经过窗位窗宽调整和重新缩放后的强度的数​​据集均值：$\\mu_{dataset} = 0.42$\n-   经过窗位窗宽调整和重新缩放后的强度的数​​据集标准差：$\\sigma_{dataset} = 0.18$\n-   原始体素强度：$HU_{raw} = -750$\n-   要求输出：经过窗位窗宽调整和$z$-分数归一化后的最终标量值，四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n\n对问题进行验证。\n\n-   **科学依据：** 该问题具有科学依据。亨斯菲尔德单位、CT窗位窗宽技术和z-分数归一化的定义都是标准的且陈述正确。肺窗的数值（$c=-600$, $w=1500$）、原始肺部HU值（-750 HU是肺实质的典型值）以及数据集统计数据（$\\mu=0.42$, $\\sigma=0.18$）在医学图像分析和深度学习的背景下都是现实且合理的。\n-   **适定性：** 该问题是适定的。它提供了执行计算序列所需的所有必要数据和定义。步骤清晰明确，可以导出一个唯一解。\n-   **客观性：** 该问题以精确、客观的语言陈述，没有主观或模棱两可的术语。\n\n该问题不存在科学上不健全、不完整、矛盾或不可行性等任何缺陷。这是一个可形式化和可解决的问题，与医学图像分析的深度学习领域直接相关。\n\n### 步骤3：结论与行动\n\n该问题被判定为**有效**。将提供解决方案。\n\n计算按问题中定义的两个阶段进行：首先是窗位窗宽调整操作，其次是$z$-分数归一化。\n\n**阶段1：窗位窗宽调整与重新缩放**\n\n首先，我们确定指定肺窗的亨斯菲尔德单位区间 $[L, U]$。该窗由窗位中心 $c = -600$ 和窗宽 $w = 1500$ 定义。\n\n下界 $L$ 计算如下：\n$$L = c - \\frac{w}{2} = -600 - \\frac{1500}{2} = -600 - 750 = -1350$$\n\n上界 $U$ 计算如下：\n$$U = c + \\frac{w}{2} = -600 + \\frac{1500}{2} = -600 + 750 = 150$$\n\n因此，窗位区间为 $[-1350, 150]$ HU。\n\n接下来，必须将原始体素强度 $HU_{raw} = -750$ 裁剪到此区间内。我们检查该值是否在边界内：\n$$-1350 \\leq -750 \\leq 150$$\n条件满足。因此，裁剪后的强度 $HU_{clipped}$ 等于原始强度：\n$$HU_{clipped} = -750$$\n\n此阶段的最后一步是将裁剪后的值从区间 $[L, U]$ 线性重新缩放到无量纲区间 $[0, 1]$。设 $I$ 为重新缩放后的强度。此线性映射的公式为：\n$$I = \\frac{HU_{clipped} - L}{U - L}$$\n\n代入已知值：\n$$I = \\frac{-750 - (-1350)}{150 - (-1350)} = \\frac{-750 + 1350}{150 + 1350} = \\frac{600}{1500}$$\n\n简化分数可得：\n$$I = \\frac{6}{15} = \\frac{2}{5} = 0.4$$\n这是中间的、经过窗位窗宽调整和重新缩放后的值。\n\n**阶段2：Z-分数归一化**\n\n第二阶段是对重新缩放后的强度 $I$ 应用$z$-分数归一化。问题陈述此归一化使用整个训练数据集中经过窗位窗宽调整和重新缩放后的值的经验均值 $\\mu_{dataset} = 0.42$ 和标准差 $\\sigma_{dataset} = 0.18$。\n\n我们记为 $z_{val}$ 的$z$-分数公式为：\n$$z_{val} = \\frac{x - \\mu}{\\sigma}$$\n在我们的情境中，数据点 $x$ 是重新缩放后的强度 $I = 0.4$，均值 $\\mu$ 是 $\\mu_{dataset} = 0.42$，标准差 $\\sigma$ 是 $\\sigma_{dataset} = 0.18$。\n\n将这些值代入$z$-分数公式：\n$$z_{val} = \\frac{0.4 - 0.42}{0.18} = \\frac{-0.02}{0.18}$$\n\n简化后得到：\n$$z_{val} = -\\frac{2}{18} = -\\frac{1}{9}$$\n\n问题要求最终答案是四舍五入到四位有效数字的小数。我们将分数转换为其小数表示形式：\n$$z_{val} = -\\frac{1}{9} = -0.111111...$$\n\n将此值四舍五入到四位有效数字，我们保留前四个非零数字。第一位有效数字是十分位上的 $1$。接下来的三位数字也是 $1$。第五位有效数字是 $1$，小于 $5$，所以我们不进行进位。\n\n最终值为 $-0.1111$。这是进入CNN第一层的无量纲标量值。", "answer": "$$ \\boxed{-0.1111} $$", "id": "5004651"}, {"introduction": "在例如肿瘤分割等医学图像分析任务中，简单地计算像素级分类准确率往往不足以评估模型性能，衡量预测区域与真实区域的“重叠程度”更为关键。本练习将向您展示如何将一个广泛使用的评估指标——Sørensen-Dice系数——转化为一个可用于模型训练的可微损失函数。通过亲手推导其梯度 [@problem_id:5004648]，您将深入理解分割网络是如何通过反向传播学习以最大化预测与真实标签之间的空间重叠。", "problem": "在肿瘤磁共振成像分割的转化医学工作流程中，考虑概率分割的设置，其中每个像素被赋予一个预测为肿瘤阳性的概率。从 Sørensen–Dice 系数的定义出发，对于预测概率的非负向量 $p = (p_{1}, \\dots, p_{n})$ 和二元基准真相标签 $y = (y_{1}, \\dots, y_{n})$，其基本表达式定义为\n$$\n\\mathrm{Dice}(p,y) = \\frac{2 \\sum_{i=1}^{n} p_{i} y_{i}}{\\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i}}.\n$$\n使用这个核心定义以及经验风险最小化原则（该原则要求一个可微的目标函数，该函数随系数增加而减小，并且界于 $0$ 和 $1$ 之间），推导一个合适的 Dice 损失函数 $L(p,y)$，然后推导其对于一般索引 $k$ 的 $p_{k}$ 的梯度。最后，对于一个简单的双像素掩码，其基准真相为 $y = (1, 1)$，预测概率为 $p = (0.3, 0.7)$，评估该梯度。将最终的梯度表示为一个行矩阵，使用精确值，不要四舍五入。不需要物理单位。", "solution": "问题陈述具有科学依据，提法恰当，并包含了唯一解所需的所有必要信息。所提供的定义和原则在医学图像分析的深度学习领域是标准的。因此，我们可以直接进行推导。\n\n问题要求推导一个合适的损失函数、其梯度以及一个具体评估。我们按顺序解决这些问题。\n\n首先，我们基于所提供的 Sørensen–Dice 系数 $\\mathrm{Dice}(p,y)$，定义一个合适的 Dice 损失函数 $L(p,y)$。问题陈述，损失函数必须是可微的，界于 $0$ 和 $1$ 之间，并且必须随着 Dice 系数的增加而减小。对于非负预测值 $p_i$ 和二元标签 $y_i$，Dice 系数本身界于 $0$（无重叠）和 $1$（完美重叠）之间。一个满足所有陈述标准的简单且标准的选择是将损失定义为 1 减去 Dice 系数：\n$$\nL(p,y) = 1 - \\mathrm{Dice}(p,y)\n$$\n代入给定的 Dice 系数定义，我们得到：\n$$\nL(p,y) = 1 - \\frac{2 \\sum_{i=1}^{n} p_{i} y_{i}}{\\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i}}\n$$\n当 Dice 系数为 $1$（最优）时，该损失函数为 $0$；当 Dice 系数为 $0$（最差情况）时，该损失函数为 $1$。这对于一个待最小化的损失函数来说是期望的行为。只要分母不为零，它对于 $p_i$ 就是可微的。在实践中，通常通过添加一个小的平滑常数来确保这一条件，但此处未指定，因此在本次形式化推导中将省略。\n\n其次，我们推导损失函数 $L(p,y)$ 相对于预测向量 $p$ 的一个分量 $p_k$ 的梯度。损失的梯度是 Dice 系数梯度的负数：\n$$\n\\frac{\\partial L(p,y)}{\\partial p_k} = - \\frac{\\partial}{\\partial p_k} \\left( \\frac{2 \\sum_{i=1}^{n} p_{i} y_{i}}{\\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i}} \\right)\n$$\n为应用除法求导法则，我们定义分子为 $N = 2 \\sum_{i=1}^{n} p_{i} y_{i}$，分母为 $D = \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i}$。除法求导法则表明 $\\frac{\\partial}{\\partial x} (\\frac{N}{D}) = \\frac{D \\frac{\\partial N}{\\partial x} - N \\frac{\\partial D}{\\partial x}}{D^2}$。\n\n我们计算 $N$ 和 $D$ 关于 $p_k$ 的偏导数：\n和 $\\sum_{i=1}^{n} p_{i} y_{i}$ 关于 $p_k$ 的导数是 $y_k$，因为当 $i \\neq k$ 时，$p_i$ 与 $p_k$ 无关。因此：\n$$\n\\frac{\\partial N}{\\partial p_k} = \\frac{\\partial}{\\partial p_k} \\left( 2 \\sum_{i=1}^{n} p_{i} y_{i} \\right) = 2 y_k\n$$\n类似地，和 $\\sum_{i=1}^{n} p_i$ 关于 $p_k$ 的导数是 $1$。和 $\\sum_{i=1}^{n} y_i$ 关于 $p_k$ 是常数。因此：\n$$\n\\frac{\\partial D}{\\partial p_k} = \\frac{\\partial}{\\partial p_k} \\left( \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i} \\right) = 1\n$$\n将这些代入除法求导法则：\n$$\n\\frac{\\partial \\mathrm{Dice}(p,y)}{\\partial p_k} = \\frac{D \\frac{\\partial N}{\\partial p_k} - N \\frac{\\partial D}{\\partial p_k}}{D^2} = \\frac{\\left( \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i} \\right) (2 y_k) - \\left( 2 \\sum_{i=1}^{n} p_{i} y_{i} \\right) (1)}{\\left( \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i} \\right)^2}\n$$\n损失函数的梯度是这个表达式的负数：\n$$\n\\frac{\\partial L(p,y)}{\\partial p_k} = - \\frac{2 y_k \\left( \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i} \\right) - 2 \\sum_{i=1}^{n} p_{i} y_{i}}{\\left( \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i} \\right)^2} = \\frac{2 \\sum_{i=1}^{n} p_{i} y_{i} - 2 y_k \\left( \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i} \\right)}{\\left( \\sum_{i=1}^{n} p_{i} + \\sum_{i=1}^{n} y_{i} \\right)^2}\n$$\n这是 Dice 损失关于单个预测概率 $p_k$ 的梯度的通用表达式。\n\n第三，我们针对提供的具体案例评估此梯度：一个双像素掩码（$n=2$），其基准真相为 $y = (1, 1)$，预测概率为 $p = (0.3, 0.7)$。\n\n我们计算所需的和：\n预测概率之和：\n$$\n\\sum_{i=1}^{2} p_i = p_1 + p_2 = 0.3 + 0.7 = 1.0\n$$\n基准真相标签之和：\n$$\n\\sum_{i=1}^{2} y_i = y_1 + y_2 = 1 + 1 = 2.0\n$$\n概率与标签乘积之和：\n$$\n\\sum_{i=1}^{2} p_i y_i = p_1 y_1 + p_2 y_2 = (0.3)(1) + (0.7)(1) = 0.3 + 0.7 = 1.0\n$$\n现在我们可以计算 $k=1$ 和 $k=2$ 时的偏导数。\n\n对于 $k=1$，我们有 $p_k = p_1 = 0.3$ 和 $y_k = y_1 = 1$。\n$$\n\\frac{\\partial L}{\\partial p_1} = \\frac{2 (1.0) - 2 (1) (1.0 + 2.0)}{(1.0 + 2.0)^2} = \\frac{2 - 2(3)}{3^2} = \\frac{2 - 6}{9} = -\\frac{4}{9}\n$$\n对于 $k=2$，我们有 $p_k = p_2 = 0.7$ 和 $y_k = y_2 = 1$。由于 $y_1 = y_2 = 1$，计算过程是相同的。\n$$\n\\frac{\\partial L}{\\partial p_2} = \\frac{2 (1.0) - 2 (1) (1.0 + 2.0)}{(1.0 + 2.0)^2} = \\frac{2 - 2(3)}{3^2} = \\frac{2 - 6}{9} = -\\frac{4}{9}\n$$\n因此，损失函数 $L(p,y)$ 关于向量 $p$ 的梯度是 $\\nabla_p L = \\left( \\frac{\\partial L}{\\partial p_1}, \\frac{\\partial L}{\\partial p_2} \\right) = \\left(-\\frac{4}{9}, -\\frac{4}{9}\\right)$。问题要求将其表示为一个行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{4}{9}  -\\frac{4}{9} \\end{pmatrix}}\n$$", "id": "5004648"}, {"introduction": "深度学习模型的原始输出（如风险评分）本身并不是一个最终的临床决策，如何解释这些评分并设定一个有效的决策边界至关重要。本练习探讨了如何设置一个决策阈值以平衡模型的敏感性（sensitivity）和特异性（specificity）。您将通过计算发现，针对不同患者亚群（如绝经前和绝经后女性）采用不同的阈值 [@problem_id:5004693]，可以实现更公平、更有效的诊断辅助，这直接关系到临床资源的合理分配和医疗公平性。", "problem": "一个卷积神经网络（CNN）被部署在一个转化医学流程中，用于对筛查性乳腺X光摄影图像中的疑似恶性病变进行初步筛查。该CNN为每次检查输出一个校准后的风险评分 $s \\in [0,1]$。在两个临床相关的亚组，$\\mathcal{A}$（绝经前）和 $\\mathcal{B}$（绝经后）中，回顾性分析表明，在给定真实疾病状态 $Y \\in \\{0,1\\}$ 的条件下，评分 $s$ 可以很好地由一个高斯分布来近似，该分布具有亚组特定的均值和共享的（亚组内）方差。具体来说，对于每个亚组 $\\mathcal{S} \\in \\{\\mathcal{A},\\mathcal{B}\\}$，假设 $s \\mid (Y=1,\\mathcal{S}) \\sim \\mathcal{N}(\\mu_{p,\\mathcal{S}}, \\sigma_{\\mathcal{S}}^{2})$ 且 $s \\mid (Y=0,\\mathcal{S}) \\sim \\mathcal{N}(\\mu_{n,\\mathcal{S}}, \\sigma_{\\mathcal{S}}^{2})$，并且由于分布集中在远离边界的区域，截断到 $[0,1]$ 的影响可以忽略不计。您可以认为以下经验估计参数是给定的：\n- 对于亚组 $\\mathcal{A}$：$\\mu_{p,\\mathcal{A}} = 0.78$, $\\mu_{n,\\mathcal{A}} = 0.42$, $\\sigma_{\\mathcal{A}} = 0.08$。\n- 对于亚组 $\\mathcal{B}$：$\\mu_{p,\\mathcal{B}} = 0.70$, $\\mu_{n,\\mathcal{B}} = 0.30$, $\\sigma_{\\mathcal{B}} = 0.10$。\n\n将阈值为 $t$ 时的灵敏度定义为 $\\mathrm{Se}(t) = \\mathbb{P}(s \\ge t \\mid Y=1)$，特异度定义为 $\\mathrm{Sp}(t) = \\mathbb{P}(s  t \\mid Y=0)$。在所述模型假设下，仅使用这些核心定义和高斯分布的性质，推导出能够平衡灵敏度和特异度（即 $\\mathrm{Se}(t_{\\mathcal{S}}) = \\mathrm{Sp}(t_{\\mathcal{S}})$）的亚组特定阈值 $t_{\\mathcal{S}}$。然后根据所提供的参数计算 $t_{\\mathcal{A}}$ 和 $t_{\\mathcal{B}}$ 的数值。\n\n最后，论证在转化医学工作流程中采用此类亚组特定阈值的临床意义，重点关注在每个亚组内平衡灵敏度和特异度如何影响下游医疗路径、亚群间的公平性和资源分配，并且除了给定的定义和经过充分检验的高斯分布性质外，不使用任何捷径公式。\n\n将 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的两个阈值表示为小数，并将您的答案四舍五入到四位有效数字。阈值不需要单位。", "solution": "问题要求推导出一个能为亚组 $\\mathcal{S}$ 平衡灵敏度和特异度的阈值 $t_{\\mathcal{S}}$，计算两个特定亚组 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的该阈值，并论证其临床意义。\n\n**第一部分：平衡阈值 $t_{\\mathcal{S}}$ 的推导**\n\n令 $\\mathcal{S}$ 表示一个特定亚组，$\\mathcal{A}$ 或 $\\mathcal{B}$。问题提供了以下关于风险评分 $s$ 在给定真实疾病状态 $Y$ 下的模型：\n- 对于患病案例（$Y=1$）：$s \\mid (Y=1, \\mathcal{S}) \\sim \\mathcal{N}(\\mu_{p,\\mathcal{S}}, \\sigma_{\\mathcal{S}}^{2})$\n- 对于未患病案例（$Y=0$）：$s \\mid (Y=0, \\mathcal{S}) \\sim \\mathcal{N}(\\mu_{n,\\mathcal{S}}, \\sigma_{\\mathcal{S}}^{2})$\n\n在给定阈值 $t$ 下，灵敏度和特异度的定义为：\n- 灵敏度：$\\mathrm{Se}(t) = \\mathbb{P}(s \\ge t \\mid Y=1)$\n- 特异度：$\\mathrm{Sp}(t) = \\mathbb{P}(s  t \\mid Y=0)$\n\n问题要求找到灵敏度等于特异度的阈值 $t_{\\mathcal{S}}$：\n$$\n\\mathrm{Se}(t_{\\mathcal{S}}) = \\mathrm{Sp}(t_{\\mathcal{S}})\n$$\n\n我们用高斯分布的性质来表示这些概率。令 $\\Phi(z)$ 为标准正态分布 $\\mathcal{N}(0,1)$ 的累积分布函数（CDF）。对于一个随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，概率 $\\mathbb{P}(X  x)$ 由 $\\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right)$ 给出。\n\n使用此性质，亚组 $\\mathcal{S}$ 在阈值 $t_{\\mathcal{S}}$ 处的特异度为：\n$$\n\\mathrm{Sp}(t_{\\mathcal{S}}) = \\mathbb{P}(s  t_{\\mathcal{S}} \\mid Y=0, \\mathcal{S}) = \\Phi\\left(\\frac{t_{\\mathcal{S}} - \\mu_{n,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\\right)\n$$\n\n灵敏度是其互补概率：\n$$\n\\mathrm{Se}(t_{\\mathcal{S}}) = \\mathbb{P}(s \\ge t_{\\mathcal{S}} \\mid Y=1, \\mathcal{S}) = 1 - \\mathbb{P}(s  t_{\\mathcal{S}} \\mid Y=1, \\mathcal{S})\n$$\n$$\n\\mathrm{Se}(t_{\\mathcal{S}}) = 1 - \\Phi\\left(\\frac{t_{\\mathcal{S}} - \\mu_{p,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\\right)\n$$\n\n现在，我们设 $\\mathrm{Se}(t_{\\mathcal{S}}) = \\mathrm{Sp}(t_{\\mathcal{S}})$：\n$$\n1 - \\Phi\\left(\\frac{t_{\\mathcal{S}} - \\mu_{p,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\\right) = \\Phi\\left(\\frac{t_{\\mathcal{S}} - \\mu_{n,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\\right)\n$$\n\n我们使用标准正态分布CDF的对称性质，即 $1 - \\Phi(z) = \\Phi(-z)$。将此应用于方程的左侧，得到：\n$$\n\\Phi\\left(-\\left(\\frac{t_{\\mathcal{S}} - \\mu_{p,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\\right)\\right) = \\Phi\\left(\\frac{t_{\\mathcal{S}} - \\mu_{n,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\\right)\n$$\n\n由于CDF $\\Phi(z)$ 是一个严格递增的函数，如果 $\\Phi(a) = \\Phi(b)$，那么必然有 $a=b$。因此，我们可以令 $\\Phi$ 的参数相等：\n$$\n-\\left(\\frac{t_{\\mathcal{S}} - \\mu_{p,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\\right) = \\frac{t_{\\mathcal{S}} - \\mu_{n,\\mathcal{S}}}{\\sigma_{\\mathcal{S}}}\n$$\n\n由于 $\\sigma_{\\mathcal{S}} > 0$，我们可以将两边同乘以 $\\sigma_{\\mathcal{S}}$ 来简化：\n$$\n-(t_{\\mathcal{S}} - \\mu_{p,\\mathcal{S}}) = t_{\\mathcal{S}} - \\mu_{n,\\mathcal{S}}\n$$\n$$\n-t_{\\mathcal{S}} + \\mu_{p,\\mathcal{S}} = t_{\\mathcal{S}} - \\mu_{n,\\mathcal{S}}\n$$\n\n现在，我们求解 $t_{\\mathcal{S}}$：\n$$\n\\mu_{p,\\mathcal{S}} + \\mu_{n,\\mathcal{S}} = 2t_{\\mathcal{S}}\n$$\n$$\nt_{\\mathcal{S}} = \\frac{\\mu_{p,\\mathcal{S}} + \\mu_{n,\\mathcal{S}}}{2}\n$$\n这个推导出的表达式表明，对于具有共享方差的高斯分布，平衡灵敏度和特异度的阈值就是阳性分布和阴性分布均值的算术平均值。\n\n**第二部分：亚组 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的数值计算**\n\n现在我们将此公式应用于每个亚组的给定参数。\n\n对于亚组 $\\mathcal{A}$（绝经前）：\n- $\\mu_{p,\\mathcal{A}} = 0.78$\n- $\\mu_{n,\\mathcal{A}} = 0.42$\n- $\\sigma_{\\mathcal{A}} = 0.08$\n阈值 $t_{\\mathcal{A}}$ 为：\n$$\nt_{\\mathcal{A}} = \\frac{0.78 + 0.42}{2} = \\frac{1.20}{2} = 0.60\n$$\n四舍五入到四位有效数字， $t_{\\mathcal{A}} = 0.6000$。\n\n对于亚组 $\\mathcal{B}$（绝经后）：\n- $\\mu_{p,\\mathcal{B}} = 0.70$\n- $\\mu_{n,\\mathcal{B}} = 0.30$\n- $\\sigma_{\\mathcal{B}} = 0.10$\n阈值 $t_{\\mathcal{B}}$ 为：\n$$\nt_{\\mathcal{B}} = \\frac{0.70 + 0.30}{2} = \\frac{1.00}{2} = 0.50\n$$\n四舍五入到四位有效数字， $t_{\\mathcal{B}} = 0.5000$。\n\n**第三部分：临床意义的论证**\n\n分析表明，对于绝经前组（$t_{\\mathcal{A}}=0.6000$）和绝经后组（$t_{\\mathcal{B}}=0.5000$），平衡灵敏度和特异度的最佳阈值是不同的。在转化医学的背景下，采用这些针对亚组的特定阈值具有重要的临床意义。\n\n1.  **亚群间的公平性**：如果对所有患者应用单一、统一的阈值，将导致诊断性能的不公平。例如，使用一个综合阈值，如平均值 $t_{avg} = 0.55$，对两个组来说都是次优的。\n    - 对于亚组 $\\mathcal{A}$（绝经前），这个 $0.55$ 的阈值低于她们的平衡点 $0.60$。较低的阈值会提高灵敏度但降低特异度。这将导致更高的假阳性率，使更多健康的绝经前女性承受不必要的焦虑、费用以及与进一步诊断程序（如活检）相关的风险。\n    - 对于亚组 $\\mathcal{B}$（绝经后），这个 $0.55$ 的阈值高于她们的平衡点 $0.50$。较高的阈值会降低灵敏度但提高特异度。这将导致更高的假阴性率，意味着在该组中会有更多的癌症被漏诊。鉴于癌症发病率随年龄增长而增加，这是一个尤其糟糕的结果。\n    通过使用亚组特定的阈值，我们确保了在每个特定人群组内，检测疾病与避免不必要检查之间的权衡得到公平的平衡，从而解决了一个潜在的算法偏见来源。\n\n2.  **下游医疗路径和资源分配**：使用量身定制的阈值可以更合理、更高效地管理下游医疗。\n    - 通过在每个组内平衡灵敏度和特异度，转诊进行后续检查的比率会根据模型对该人群的特定性能特征进行校准。这可以防止某个亚组因选择了不当阈值导致过多的假阳性，从而不成比例地消耗诊断资源（例如，病理学和放射学服务）。\n    - 它还减轻了与漏诊（假阴性）相关的长期临床和经济负担，因为漏诊可能导致疾病晚期才被发现，预后更差，治疗也更密集、更昂贵。\n    - 本质上，将“不同亚组的评分分布存在差异”这一统计发现，转化为“应用亚组特定阈值”的临床行动，是转化医学的一个典型例子。它将一个数据驱动的见解从“实验室”（算法性能分析）带到“临床”（临床决策过程），从而优化整个患者群体的患者护理和资源利用。这与精准医疗的原则相一致，即临床决策应根据个体或亚组的特征量身定制。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6000  0.5000 \\end{pmatrix}}$$", "id": "5004693"}]}