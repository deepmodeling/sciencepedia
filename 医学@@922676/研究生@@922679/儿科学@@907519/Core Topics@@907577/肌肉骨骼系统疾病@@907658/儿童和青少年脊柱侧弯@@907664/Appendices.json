{"hands_on_practices": [{"introduction": "青少年特发性脊柱侧凸 (AIS) 管理的核心在于预测哪些侧凸会进展。此练习要求您基于基本生物力学原理和患者的剩余生长潜力，从第一性原理构建一个定性的进展风险模型，而非依赖经验公式。通过这种方式，您将超越对风险因素的死记硬背，从而深化对驱动脊柱侧凸进展的“恶性循环”机制的理解 ([@problem_id:5201845])。", "problem": "一位临床医生寻求一个关于青少年特发性脊柱侧凸 (AIS) 进展风险的定性、第一性原理模型，该模型能捕捉进展对侧弯角度和骨骼成熟度的依赖关系，而不依赖任何经验性校准的方程。设具有临床意义的进展风险（例如，在骨骼成熟前 Cobb 角增加至少 $5^\\circ$）由函数 $R(\\theta,m)$ 表示，其中 $\\theta$ 是初始 Cobb 角（单位为度），$m$ 是一个随成熟度增加而增加的标量骨骼成熟度指数（例如，从 $0$ 到 $5$ 的 Risser 征或从 $1$ 到 $8$ 的 Sanders 骨龄分期）。假设以下基本原理：(i) Hueter–Volkmann 原理（增加的机械压力会减缓骨骺生长，减少的压力会加速其生长，从而导致生长调节），(ii) 非对称负荷下的椎体生长不对称性驱动了侧弯的进展，以及 (iii) 剩余的生长是发生显著结构性进展所必需的，生长速度在青春期前及青春期左右达到峰值，此后逐渐减小。\n\n基于这些原理且不引入任何经验性简化公式，请选择下面最能合理解释未经治疗的 AIS 中 $R$、$ \\theta$ 和 $m$ 之间单调关系的定性模型，并且该模型与使用 Risser 征和 Sanders 分期的临床观察结果一致。特别是，考虑一阶偏导数 $\\frac{\\partial R}{\\partial \\theta}$ 和 $\\frac{\\partial R}{\\partial m}$ 的符号，以及 $R$ 对 $\\theta$ 的敏感性是否本身应依赖于 $m$。\n\nA. 对于所有的 $\\theta$，$R(\\theta,m)$ 对 $\\theta$ 严格递增（即 $\\frac{\\partial R}{\\partial \\theta}>0$），对于所有的 $m$，$R(\\theta,m)$ 对 $m$ 严格递减（即 $\\frac{\\partial R}{\\partial m}0$），并且 $\\theta$ 对 $R$ 的影响随着成熟度的增加而减弱（即 $\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}0$，因为剩余生长量的减少降低了侧弯角度对进展的影响）。\n\nB. $R(\\theta,m)$ 对 $\\theta$ 和 $m$ 均递增（即 $\\frac{\\partial R}{\\partial \\theta}>0$ 且 $\\frac{\\partial R}{\\partial m}>0$），理由是骨骼成熟会使脊柱变硬，而一旦侧弯角度较大，更高的刚度会导致更严重的进展。\n\nC. $R(\\theta,m)$ 对 $\\theta$ 是非单调的：在低于某个阈值（例如 $30^\\circ$）时随 $\\theta$ 减小，在高于该阈值时随 $\\theta$ 增大，同时对 $m$ 递减；其理由是假设中度侧弯会受到更多关注，因此即使不考虑治疗，进展也较少。\n\nD. $R(\\theta,m)$ 仅依赖于 $\\theta$（即 $\\frac{\\partial R}{\\partial \\theta}>0$ 且 $\\frac{\\partial R}{\\partial m}=0$），因为机械不对称性是主导驱动因素，而成熟度对进展风险的贡献可以忽略不计。\n\nE. $R(\\theta,m)$ 对 $\\theta$ 和 $m$ 均递减（即 $\\frac{\\partial R}{\\partial \\theta}0$ 且 $\\frac{\\partial R}{\\partial m}0$），其前提是较大的侧弯会减少活动度，从而限制进一步的进展，而骨骼成熟则减少了由生长驱动的进展。\n\n选择唯一的最佳选项。", "solution": "用户希望我验证问题，如果问题有效，则推导出解决方案并评估各个选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **要建模的函数：** 具有临床意义的进展风险，$R(\\theta,m)$。\n- **进展的定义：** 在骨骼成熟前 Cobb 角增加至少 $5^\\circ$。\n- **自变量 $\\theta$**：初始 Cobb 角，单位为度。\n- **自变量 $m$**：一个随成熟度增加的标量骨骼成熟度指数。例如从 $0$ 到 $5$ 的 Risser 征或从 $1$ 到 $8$ 的 Sanders 骨龄分期。\n- **基本原理（第一性原理）：**\n    - (i) Hueter–Volkmann 原理：增加的机械压力减缓骨骺生长，减少的压力加速骨骺生长，导致生长调节。\n    - (ii) 非对称负荷下的椎体生长不对称性是侧弯进展的驱动因素。\n    - (iii) 剩余生长是发生显著结构性进展所必需的，生长速度在青春期前及青春期左右达到峰值，此后逐渐减小。\n- **任务：** 选择一个表示 $R$、$ \\theta$ 和 $m$ 之间单调关系的定性模型。这涉及确定偏导数 $\\frac{\\partial R}{\\partial \\theta}$ 和 $\\frac{\\partial R}{\\partial m}$ 的符号，以及混合偏导数 $\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}$ 的符号。该模型必须在没有经验公式的情况下推导得出，并且与使用 Risser 征和 Sanders 分期的临床观察结果一致。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地植根于小儿骨科既定的生物力学和生理学原理。Hueter-Volkmann 原理、脊柱侧凸进展的“恶性循环”理论（结合了非对称负荷和生长），以及骨骼成熟度的关键作用，都是现代对青少年特发性脊柱侧凸（AIS）理解的基石。该问题与其陈述的主题和领域直接相关。\n- **适定性：** 该问题提供了一套清晰的第一性原理，并要求基于这些原理推断出函数的定性行为。这些关系可以用偏导数来形式化，并且这些原理足以确定这些导数的符号，从而得出一个独特概念解。\n- **客观性：** 该问题以精确、客观、科学的语言表述。它明确指示用户避免经验性或主观性推理，而应完全专注于所提供的第一性原理。\n\n**缺陷评估：**\n1.  **科学或事实不健全：** 无。前提在科学上是健全的。\n2.  **不可形式化或不相关：** 无。问题是可形式化的且高度相关。\n3.  **不完整或矛盾的设置：** 无。三个原理构成了连贯且充分的推理基础。\n4.  **不切实际或不可行：** 无。该场景是 AIS 临床管理中的一个核心问题。\n5.  **不适定或结构不良：** 无。问题清晰，可以导出一个确定的答案。\n6.  **伪深刻、琐碎或同义反复：** 无。该问题需要对多个原理进行非平凡的综合才能得出正确的模型。\n7.  **超出科学可验证性范围：** 无。所描述的关系是广泛的临床和生物力学研究的主题。\n\n**步骤 3：结论和行动**\n问题陈述是**有效的**。它在科学上是健全的、适定的和客观的。我现在将继续推导解决方案。\n\n### 解题推导\n\n任务是根据给定的三个原理，通过分析其偏导数来确定风险函数 $R(\\theta,m)$ 的定性行为。\n\n1.  **$\\frac{\\partial R}{\\partial \\theta}$ 的分析（初始侧弯角度的影响）：**\n    - 较大的初始 Cobb 角 $\\theta$ 意味着更明显的脊柱畸形。\n    - 这种更严重的畸形导致椎体及其生长板（骨骺）承受更大的非对称机械负荷。具体来说，侧弯的凹侧受到增加的压力，而凸侧则经历减小的压力甚至张力。\n    - 根据 Hueter–Volkmann 原理 (i)，这种非对称负荷导致非对称生长：受压的凹侧生长减缓，而压力较小的凸侧生长加速。\n    - 如原理 (ii) 所述，这种差异性生长是侧弯进展的明确机制。\n    - 因此，较大的初始侧弯角度 $\\theta$ 会产生一个更强大的非对称负荷和非对称生长的“恶性循环”，导致进一步进展的概率更高。\n    - 因此，进展风险 $R$ 必须是初始 Cobb 角 $\\theta$ 的严格递增函数。\n    - 在数学上，这意味着 $\\frac{\\partial R}{\\partial \\theta} > 0$。\n\n2.  **$\\frac{\\partial R}{\\partial m}$ 的分析（骨骼成熟度的影响）：**\n    - 变量 $m$ 是一个骨骼成熟度指数，随着孩子年龄增长并接近生长终点而增加。较高的 $m$ 表示剩余的骨骼生长较少。\n    - 原理 (iii) 指出，剩余生长是发生显著结构性进展的必要条件。脊柱侧凸的进展从根本上说是一种与生长相关的现象。\n    - 随着骨骼成熟度 $m$ 的增加，剩余的生长潜力减少。生长板开始融合，总生长速度减至零。\n    - 由于恶性循环的“燃料”（即剩余生长）减少，侧弯恶化的可能性显著降低。对于处于或接近骨骼成熟（高 $m$）的患者，无论侧弯角度多大，其进展风险都非常低。\n    - 因此，进展风险 $R$ 必须是骨骼成熟度指数 $m$ 的严格递减函数。\n    - 在数学上，这意味着 $\\frac{\\partial R}{\\partial m}  0$。\n\n3.  **$\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}$ 的分析（侧弯角度与成熟度之间的相互作用）：**\n    - 混合偏导数 $\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}$ 描述了风险对 Cobb 角的敏感性（即 $\\frac{\\partial R}{\\partial \\theta}$）如何随着骨骼成熟度 $m$ 的变化而变化。\n    - 我们已经确定，$\\theta$ 和 $R$ 之间的正相关关系（即 $\\frac{\\partial R}{\\partial \\theta} > 0$）是由基于生长的恶性循环驱动的。\n    - 这个恶性循环的效力取决于是否有生长潜力（原理 iii）。\n    - 随着成熟度 $m$ 的增加，剩余的生长潜力减小。\n    - 在一个剩余生长很少（高 $m$）的患者中，即使是大的侧弯 $\\theta$（它会产生大的非对称负荷）也无法产生显著的非对称生长。进展机制实际上被禁用了。因此，$\\theta$ 对风险 $R$ 的影响很弱。\n    - 相反，在一个骨骼不成熟（低 $m$）的患者中，有充足的生长潜力，因此来自给定侧弯 $\\theta$ 的相同非对称负荷可以驱动显著的进展。$\\theta$ 对 $R$ 的影响很强。\n    - 这意味着 $R$ 对 $\\theta$ 曲线的斜率，即 $\\frac{\\partial R}{\\partial \\theta}$，随着成熟度 $m$ 的增加而减小。初始角度的影响随着成熟度的增加而被削弱。\n    - 因此，$\\frac{\\partial R}{\\partial \\theta}$ 关于 $m$ 的变化率是负的。\n    - 在数学上，这意味着 $\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}  0$。\n\n**推导模型的总结：**\n- $\\frac{\\partial R}{\\partial \\theta} > 0$\n- $\\frac{\\partial R}{\\partial m}  0$\n- $\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}  0$\n\n### 逐项分析选项\n\n**A. 对于所有的 $\\theta$，$R(\\theta,m)$ 对 $\\theta$ 严格递增（即 $\\frac{\\partial R}{\\partial \\theta}>0$），对于所有的 $m$，$R(\\theta,m)$ 对 $m$ 严格递减（即 $\\frac{\\partial R}{\\partial m}0$），并且 $\\theta$ 对 $R$ 的影响随着成熟度的增加而减弱（即 $\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}0$，因为剩余生长量的减少降低了侧弯角度对进展的影响）。**\n- 该选项指出 $\\frac{\\partial R}{\\partial \\theta} > 0$、$\\frac{\\partial R}{\\partial m}  0$ 和 $\\frac{\\partial^2 R}{\\partial \\theta \\,\\partial m}  0$。所提供的理由也是正确的。这与从第一性原理推导出的模型完全匹配。\n- **结论：正确**\n\n**B. $R(\\theta,m)$ 对 $\\theta$ 和 $m$ 均递增（即 $\\frac{\\partial R}{\\partial \\theta}>0$ 且 $\\frac{\\partial R}{\\partial m}>0$），理由是骨骼成熟会使脊柱变硬，而一旦侧弯角度较大，更高的刚度会导致更严重的进展。**\n- 该选项正确地指出 $\\frac{\\partial R}{\\partial \\theta} > 0$，但错误地指出 $\\frac{\\partial R}{\\partial m} > 0$。这与原理 (iii) 相矛盾，因为增加的成熟度会减少剩余生长，从而降低进展风险。给出的理由是不成立的；虽然刚度可能会增加，但在降低进展风险方面，生长停止起主导作用。\n- **结论：错误**\n\n**C. $R(\\theta,m)$ 对 $\\theta$ 是非单调的：在低于某个阈值（例如 $30^\\circ$）时随 $\\theta$ 减小，在高于该阈值时随 $\\theta$ 增大，同时对 $m$ 递减；其理由是假设中度侧弯会受到更多关注，因此即使不考虑治疗，进展也较少。**\n- 该选项声称对 $\\theta$ 非单调，这与恶性循环原理相矛盾，该原理意味着对于任何 $\\theta > 0$，风险都应随着非对称负荷的增加而增加。此外，其理由引入了一个行为因素（“关注”），这明确超出了一个被要求“不考虑治疗”的第一性原理模型的范围。\n- **结论：错误**\n\n**D. $R(\\theta,m)$ 仅依赖于 $\\theta$（即 $\\frac{\\partial R}{\\partial \\theta}>0$ 且 $\\frac{\\partial R}{\\partial m}=0$），因为机械不对称性是主导驱动因素，而成熟度对进展风险的贡献可以忽略不计。**\n- 该选项声称 $\\frac{\\partial R}{\\partial m} = 0$，这直接且严重地违背了原理 (iii) 和大量的临床证据。骨骼成熟度是进展风险最关键的预测因素之一；其贡献远非可以忽略不计。\n- **结论：错误**\n\n**E. $R(\\theta,m)$ 对 $\\theta$ 和 $m$ 均递减（即 $\\frac{\\partial R}{\\partial \\theta}0$ 且 $\\frac{\\partial R}{\\partial m}0$），其前提是较大的侧弯会减少活动度，从而限制进一步的进展，而骨骼成熟则减少了由生长驱动的进展。**\n- 该选项错误地声称 $\\frac{\\partial R}{\\partial \\theta}  0$。给出的前提（减少的活动度）是似是而非的；进展是由静态负荷下的非对称生长驱动的，而不是由动态运动驱动的。Hueter-Volkmann 原理强有力地支持 $\\frac{\\partial R}{\\partial \\theta} > 0$。尽管关于 $m$ 的陈述是正确的，但关于 $\\theta$ 的陈述是根本错误的。\n- **结论：错误**", "answer": "$$\\boxed{A}$$", "id": "5201845"}, {"introduction": "在建立了对进展风险的定性理解后 ([@problem_id:5201845])，临床实践需要一种方法，能在获得新数据时对风险进行动态更新。此计算练习将指导您设计一个贝叶斯更新方案，它能够结合先验信念与新的 Cobb 角测量数据来得出修正后的后验概率。掌握这种明确处理不确定性的定量方法，是向个性化、数据驱动的临床决策迈出的重要一步 ([@problem_id:5201827])。", "problem": "需要构建一个儿童脊柱侧弯风险模型，该模型是一个二元潜在状态，反映了在观察窗口期内侧弯是否处于进展状态。设 $H_1$ 表示侧弯是进展性的假设， $H_0$ 表示其为非进展性的假设。基线Cobb角为 $y_0$ （单位：度），并在自基线起的多个时间点 $\\{t_i\\}$ （单位：月）获得一系列Cobb测量值 $\\{y_i\\}$ （单位：度）。进展的先验风险为 $p_0 \\in (0,1)$，以小数形式表示。观察期内的生长速度为 $GV$ （单位：厘米/年）。测量不精确性被建模为标准差为 $\\sigma_{\\text{meas}}$ （单位：度）的高斯噪声。围绕确定性轨迹的短期生物变异性被建模为标准差为 $\\sigma_{\\text{bio}}$ （单位：度）的独立高斯噪声。组合观测噪声的标准差为 $\\sigma = \\sqrt{\\sigma_{\\text{meas}}^2 + \\sigma_{\\text{bio}}^2}$。\n\n在进展性假设 $H_1$ 下，确定性平均Cobb角轨迹被建模为 $m_1(t) = y_0 + \\kappa \\cdot GV \\cdot \\frac{t}{12}$，其中 $\\kappa$ （单位：度/厘米）是连接生长与Cobb角随时间变化的比例常数。在非进展性假设 $H_0$ 下，确定性均值为 $m_0(t) = y_0$。每个在时间 $t_i$ 的观测值 $y_i$ 都被假定为从一个均值为 $m_s(t_i)$、方差为 $\\sigma^2$ 的正态分布中的独立抽样，其中 $s \\in \\{0,1\\}$ 是假设 $H_s$ 的索引。\n\n从贝叶斯法则和上述生成性假设出发，设计一个序贯更新方案，该方案接收先验风险 $p_0$，并在观察整个序列 $\\{(t_i, y_i)\\}$ 后返回后验风险 $p_{\\text{post}}$。您的推导必须明确使用贝叶斯法则、正态似然和观测独立性。您必须提供一个原则性论证，说明增加 $\\sigma_{\\text{meas}}$ 和 $\\sigma_{\\text{bio}}$ 如何改变后验概率，以及 $GV$ 如何通过确定性均值 $m_1(t)$ 进入后验概率。\n\n角度单位规范：所有Cobb角及与角度相关的量都必须以度为单位处理。时间单位规范：所有时间都必须以月为单位处理。生长单位规范：$GV$ 必须以厘米/年为单位处理。您的程序必须以后验风险的小数形式输出，并四舍五入到六位小数。\n\n在一个程序中实现所推导的更新方案，该程序为以下每个测试用例返回后验风险。每个用例指定为一个元组 $(p_0, y_0, \\{t_i\\}, \\{y_i\\}, GV, \\sigma_{\\text{meas}}, \\sigma_{\\text{bio}}, \\kappa)$：\n\n- 用例 A: $(p_0 = 0.3, y_0 = 20, \\{t_i\\} = [6, 12], \\{y_i\\} = [23, 25], GV = 8, \\sigma_{\\text{meas}} = 3, \\sigma_{\\text{bio}} = 1, \\kappa = 0.6)$。\n- 用例 B: $(p_0 = 0.5, y_0 = 15, \\{t_i\\} = [6, 12], \\{y_i\\} = [15, 16], GV = 2, \\sigma_{\\text{meas}} = 3, \\sigma_{\\text{bio}} = 1, \\kappa = 0.6)$。\n- 用例 C: $(p_0 = 0.6, y_0 = 30, \\{t_i\\} = [6, 12], \\{y_i\\} = [31, 29], GV = 9, \\sigma_{\\text{meas}} = 6, \\sigma_{\\text{bio}} = 2, \\kappa = 0.6)$。\n- 用例 D: $(p_0 = 0.4, y_0 = 25, \\{t_i\\} = [6, 12], \\{y_i\\} = [30, 35], GV = 10, \\sigma_{\\text{meas}} = 2, \\sigma_{\\text{bio}} = 1, \\kappa = 0.7)$。\n- 用例 E: $(p_0 = 0.7, y_0 = 35, \\{t_i\\} = [6, 12], \\{y_i\\} = [34, 33], GV = 9, \\sigma_{\\text{meas}} = 2.5, \\sigma_{\\text{bio}} = 1.5, \\kappa = 0.6)$。\n- 用例 F: $(p_0 = 0.05, y_0 = 18, \\{t_i\\} = [4, 8, 12], \\{y_i\\} = [19, 22, 26], GV = 9, \\sigma_{\\text{meas}} = 2, \\sigma_{\\text{bio}} = 1, \\kappa = 0.6)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个后验风险四舍五入到六位小数（例如，$[0.123456,0.654321]$）。", "solution": "该问题要求设计并实现一个序贯贝叶斯更新方案，以计算脊柱侧弯进展的后验概率。我们有两个相互竞争的假设：$H_1$，即侧弯是进展性的；$H_0$，即侧弯是非进展性的。我们从进展的先验概率 $p_0 = P(H_1)$ 和一组系列Cobb角测量值 $D = \\{(t_i, y_i)\\}_{i=1}^N$ 开始。我们的目标是计算后验概率 $p_{\\text{post}} = P(H_1|D)$。\n\n我们方法的基础是贝叶斯法则（Bayes' rule），它将后验概率与先验概率以及在每个假设下观测数据的似然联系起来。以赔率形式表示，贝叶斯法则为：\n$$\n\\frac{P(H_1|D)}{P(H_0|D)} = \\frac{P(H_1)}{P(H_0)} \\cdot \\frac{P(D|H_1)}{P(D|H_0)}\n$$\n此方程表明，后验赔率是先验赔率与贝叶斯因子（Bayes Factor） $BF_{10} = P(D|H_1) / P(D|H_0)$ 的乘积。\n\n问题陈述，给定假设 $H_s$，观测值 $\\{y_i\\}$ 是条件独立的。这个关键假设使我们能够将总似然 $P(D|H_s)$ 表示为每个测量值的单个似然的乘积：\n$$\nP(D|H_s) = \\prod_{i=1}^{N} P(y_i | H_s, t_i)\n$$\n因此，总贝叶斯因子是每个独立观测值的贝叶斯因子的乘积：\n$$\nBF_{10} = \\prod_{i=1}^{N} \\frac{P(y_i|H_1, t_i)}{P(y_i|H_0, t_i)}\n$$\n为了数值稳定性和分析便利性，最好使用赔率的自然对数（对数赔率或logit）。设 $\\lambda = \\log(\\text{odds})$。在对数赔率空间中，乘法关系变为加法关系：\n$$\n\\lambda_{\\text{post}} = \\lambda_{\\text{prior}} + \\sum_{i=1}^{N} \\log\\left(\\frac{P(y_i|H_1, t_i)}{P(y_i|H_0, t_i)}\\right)\n$$\n这构成了我们序贯更新方案的基础。从初始对数赔率 $\\lambda_0 = \\log(p_0 / (1-p_0))$ 开始，我们在每次观测 $(t_i, y_i)$ 后，通过加上该观测的对数贝叶斯因子来更新它。设 $\\lambda_{i-1}$ 是 $i-1$ 次观测后的对数赔率。第 $i$ 次观测后的更新对数赔率为：\n$$\n\\lambda_i = \\lambda_{i-1} + \\log(BF_i)\n$$\n其中 $BF_i$ 是第 $i$ 次观测的贝叶斯因子。\n\n在假设 $H_s$（$s \\in \\{0,1\\}$）下，单个观测值 $y_i$ 在时间 $t_i$ 的似然由高斯概率密度函数给出：\n$$\nP(y_i | H_s, t_i) = \\mathcal{N}(y_i; m_s(t_i), \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - m_s(t_i))^2}{2\\sigma^2}\\right)\n$$\n参数定义如下：\n-   组合观测噪声方差：$\\sigma^2 = \\sigma_{\\text{meas}}^2 + \\sigma_{\\text{bio}}^2$。\n-   $H_0$（非进展性）下的平均轨迹：$m_0(t_i) = y_0$。\n-   $H_1$（进展性）下的平均轨迹：$m_1(t_i) = y_0 + \\kappa \\cdot GV \\cdot \\frac{t_i}{12}$。\n\n因此，第 $i$ 次观测的对数贝叶斯因子为：\n$$\n\\log(BF_i) = \\log\\left(\\frac{\\mathcal{N}(y_i; m_1(t_i), \\sigma^2)}{\\mathcal{N}(y_i; m_0(t_i), \\sigma^2)}\\right) = \\log\\left(\\frac{\\exp\\left(-\\frac{(y_i - m_1(t_i))^2}{2\\sigma^2}\\right)}{\\exp\\left(-\\frac{(y_i - m_0(t_i))^2}{2\\sigma^2}\\right)}\\right)\n$$\n$$\n\\log(BF_i) = -\\frac{(y_i - m_1(t_i))^2}{2\\sigma^2} + \\frac{(y_i - m_0(t_i))^2}{2\\sigma^2} = \\frac{1}{2\\sigma^2} \\left[ (y_i - m_0(t_i))^2 - (y_i - m_1(t_i))^2 \\right]\n$$\n这个量代表了第 $i$ 次观测所提供的证据权重。正值会增加对数赔率，支持 $H_1$；而负值会减少对数赔率，支持 $H_0$。\n\n处理完所有 $N$ 次观测后，我们得到最终的对数赔率 $\\lambda_N$。使用logistic（或逆logit）函数将其转换回后验概率 $p_{\\text{post}}$：\n$$\np_{\\text{post}} = \\frac{\\exp(\\lambda_N)}{1 + \\exp(\\lambda_N)} = \\frac{1}{1 + \\exp(-\\lambda_N)}\n$$\n至此，序贯更新方案的推导完成。\n\n接下来，我们为模型的行为提供所要求的论证。\n\n增加 $\\sigma_{\\text{meas}}$ 和 $\\sigma_{\\text{bio}}$ 的影响：\n这些参数控制总观测噪声方差 $\\sigma^2 = \\sigma_{\\text{meas}}^2 + \\sigma_{\\text{bio}}^2$。增加其中任何一个都会增加 $\\sigma^2$。一次观测的对数贝叶斯因子按比例项 $1/(2\\sigma^2)$ 缩放。随着 $\\sigma^2$ 的增加，这个比例因子减小，意味着对于任何给定的观测，对数赔率更新的幅度会变小。这在科学上是直观的：更高的噪声使得每次观测的可靠性降低。因此，数据提供的用于区分假设 $H_0$ 和 $H_1$ 的信息就更少。因此，后验概率相比先验概率的变化会更小；我们的信念受噪声数据的影响更小。在无限噪声的极限情况下（$\\sigma^2 \\to \\infty$），对数贝叶斯因子趋近于0，后验概率将保持与先验概率相等，$p_{\\text{post}} = p_0$，因为数据没有提供任何证据。\n\n生长速度 $GV$ 的作用：\n参数 $GV$ 仅在进展性假设下是确定性平均轨迹 $m_1(t) = y_0 + \\kappa \\cdot GV \\cdot (t/12)$ 的一个组成部分。它线性地缩放了Cobb角随时间增加的预期速率。较高的 $GV$ 意味着如果侧弯确实是进展性的，则预期会有更快的进展。对数贝叶斯因子比较了观测值 $y_i$ 相对于非进展性均值 $m_0(t_i)$ 和进展性均值 $m_1(t_i)$ 的平方误差。$GV$ 的值直接为进展模型设定了目标均值 $m_1(t_i)$。如果观测到的测量值 $\\{y_i\\}$ 显示出的变化速率与高 $GV$ 预测的速率一致（即，$y_i$ 接近 $m_1(t_i)$），则项 $(y_i - m_1(t_i))^2$ 将会很小，从而导致一个大的正对数贝叶斯因子，并显著增加进展的后验风险。相反，如果尽管 $GV$ 很高但侧弯仍保持稳定，那么数据将更符合 $H_0$，导致负的对数贝叶斯因子，并降低后验风险。因此，对于特定患者，$GV$ 提供了“进展”在数量上的含义背景。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the posterior risk of scoliosis progression for a series of test cases.\n    \"\"\"\n    \n    # Each case is specified as a tuple:\n    # (p0, y0, {ti}, {yi}, GV, sigma_meas, sigma_bio, kappa)\n    test_cases = [\n        # Case A\n        (0.3, 20.0, [6.0, 12.0], [23.0, 25.0], 8.0, 3.0, 1.0, 0.6),\n        # Case B\n        (0.5, 15.0, [6.0, 12.0], [15.0, 16.0], 2.0, 3.0, 1.0, 0.6),\n        # Case C\n        (0.6, 30.0, [6.0, 12.0], [31.0, 29.0], 9.0, 6.0, 2.0, 0.6),\n        # Case D\n        (0.4, 25.0, [6.0, 12.0], [30.0, 35.0], 10.0, 2.0, 1.0, 0.7),\n        # Case E\n        (0.7, 35.0, [6.0, 12.0], [34.0, 33.0], 9.0, 2.5, 1.5, 0.6),\n        # Case F\n        (0.05, 18.0, [4.0, 8.0, 12.0], [19.0, 22.0, 26.0], 9.0, 2.0, 1.0, 0.6),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        p0, y0, ts, ys, gv, sigma_meas, sigma_bio, kappa = case\n\n        # Calculate the combined observational noise variance\n        sigma_sq = sigma_meas**2 + sigma_bio**2\n\n        # Start with the initial log-odds (logit of the prior probability)\n        # log_odds = log(p / (1-p))\n        log_odds = np.log(p0 / (1.0 - p0))\n\n        # Iteratively update the log-odds for each observation\n        for t, y in zip(ts, ys):\n            # Mean under non-progressive hypothesis H0\n            m0 = y0\n            \n            # Mean under progressive hypothesis H1\n            # t is in months, GV in cm/year, so t must be converted to years\n            m1 = y0 + kappa * gv * (t / 12.0)\n            \n            # Calculate the log Bayes Factor for the current observation\n            # log(BF) = (1 / (2*sigma^2)) * [ (y - m0)^2 - (y - m1)^2 ]\n            log_bf = (1.0 / (2.0 * sigma_sq)) * ((y - m0)**2 - (y - m1)**2)\n            \n            # Update the log-odds sequentially\n            log_odds += log_bf\n\n        # Convert the final log-odds back to a probability\n        # p_post = 1 / (1 + exp(-log_odds))\n        p_post = 1.0 / (1.0 + np.exp(-log_odds))\n        \n        results.append(round(p_post, 6))\n\n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "5201827"}, {"introduction": "当非手术治疗不足以控制侧凸进展而需要进行手术时，量化矫正程度并理解其临床意义至关重要。此练习要求您计算一个标准的手术矫正率，并解释为何冠状面的显著矫正未必能带来同等的美容外观改善。通过这个练习，您将理解评估三维畸形时二维测量的局限性，并认识到残余的旋转畸形对最终外观的关键影响 ([@problem_id:5201829])。", "problem": "一名患有青少年特发性脊柱侧凸（AIS）的$13$岁患者接受了后路脊柱内固定融合术。在标准的站立位后前位X光片上，测得术前主胸弯的Cobb角为$A_{0} = 60^{\\circ}$，术后即刻的Cobb角为$A_{1} = 20^{\\circ}$，单位均为度。Cobb角的定义是沿侧凸曲度的上、下端椎终板所画直线之间的夹角，它可作为冠状面畸形程度的标量测量值。\n\n根据测量和归一化的基本原理，无量纲分数矫正率可以定义为测量量变化的大小与其初始大小之比。使用此框架和上述测量的角度，计算冠状面畸形的分数矫正率，并以不带百分号的小数形式报告。将您的最终数值结果四舍五入至四位有效数字。\n\n此外，请提供一个机理上的解释，说明尽管冠状面得到了显著矫正，但残余的椎体轴向旋转和胸廓耦合如何限制外观的改善（例如，肋骨隆起和躯干不对称）。您的解释应包含在您的演算过程中，但您最终报告的答案必须仅为所要求的数字。情景中的角度单位为度；所要求的分数矫正率是无量纲的。", "solution": "该问题要求计算脊柱侧凸的分数矫正率，并为手术矫正后外观改善的局限性提供机理上的解释。该问题被认为是有效的，因为它科学地基于骨科生物力学的既定原则，问题提法得当，数据充分且一致，并且表述客观。\n\n首先，我们计算分数矫正率，记为$C_f$。问题将其定义为测量量变化的大小与其初始大小之比。测量的量是Cobb角，$A$。\n\n初始（术前）Cobb角为$A_{0} = 60^{\\circ}$。\n最终（术后即刻）Cobb角为$A_{1} = 20^{\\circ}$。\n\nCobb角的变化为 $\\Delta A = A_{1} - A_{0}$。\n$\\Delta A = 20^{\\circ} - 60^{\\circ} = -40^{\\circ}$。\n\n变化的大小是此差值的绝对值，$|\\Delta A|$。\n$|\\Delta A| = |-40^{\\circ}| = 40^{\\circ}$。\n\n初始大小是初始Cobb角，$A_{0} = 60^{\\circ}$。\n\n根据所给定义，分数矫正率$C_f$为：\n$$C_f = \\frac{|\\Delta A|}{A_{0}} = \\frac{|A_{1} - A_{0}|}{A_{0}}$$\n代入给定值：\n$$C_f = \\frac{40}{60} = \\frac{2}{3}$$\n问题要求将此结果以小数形式报告，并四舍五入至四位有效数字。\n$$C_f = 0.666666... \\approx 0.6667$$\n\n其次，我们提供机理上的解释，说明为什么由Cobb角测量的冠状面显著矫正，可能不对应于外观（如肋骨隆起）的同等改善。\n\n青少年特发性脊柱侧凸（AIS）是一种三维（3D）脊柱畸形。尽管最常用Cobb角在冠状面上对其进行表征和量化，但这种测量忽略了畸形的另外两个关键组成部分：矢状面（脊柱后凸和前凸），以及在此背景下最重要的轴向（横向）平面。\n\nAIS的基本病理机制涉及侧向偏斜（冠状面）和轴向旋转之间的生物力学耦合。在一个典型的胸椎侧凸中，位于曲度顶点的椎体在轴向平面上发生显著旋转。这种旋转的方向是椎体朝向冠状面曲线的凸侧转动。\n\n胸廓在解剖学上通过肋椎关节和肋横突关节与胸椎相连接。因此，胸椎的任何旋转都会直接传递到其附着的一对肋骨上。这种椎体旋转导致曲线凸侧的肋骨向后移位，而凹侧的肋骨则向前移位。凸侧肋骨的后向移位造成了临床上观察到的“肋骨隆起”或“剃刀背”，这是患者外观方面的主要担忧来源。\n\n后路脊柱内固定融合术，即所描述的外科手术，在矫正冠状面畸形方面非常有效。外科医生将椎弓根螺钉或其他内植物置入椎体，并用棒连接它们。通过这个结构施加矫正力，外科医生可以显著减小Cobb角，从后前位视角看，使脊柱变直。\n\n然而，标准的后路内固定在矫正轴向平面旋转畸形方面的效果有限。尽管诸如直接椎体去旋转（DVR）等现代技术可以对椎体施加去旋转力矩，但要实现轴向旋转的完全矫正通常是不可能的，尤其是在更僵硬、更慢性的侧凸中。即使在实现了出色的冠状面矫正后，也常常会残留显著程度的椎体旋转。\n\n这种残余轴向旋转的持续存在意味着胸廓仍然与旋转不良的脊柱耦合。因此，作为这种旋转的直接后果的肋骨隆起仅得到部分矫正。因此，在二维的X光片Cobb角上的显著改善与三维外观（即残余的肋骨隆起和躯干不对称）的较小改善之间的差异，可以通过脊柱侧凸畸形的轴向椎体旋转分量未被完全矫正来解释。冠状面矫正主要解决了“侧凸”问题，但残余的轴向畸形限制了“隆起”的外观改善。", "answer": "$$\\boxed{0.6667}$$", "id": "5201829"}]}