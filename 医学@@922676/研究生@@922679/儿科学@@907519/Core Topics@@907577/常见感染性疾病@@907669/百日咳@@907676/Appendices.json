{"hands_on_practices": [{"introduction": "准确的药物剂量计算是儿科医疗的基石。在治疗百日咳时，阿奇霉素等抗生素的疗效和安全性取决于根据儿童体重设定的正确治疗窗口。本练习将通过一个典型的临床场景，巩固基于体重的剂量计算原则，并将处方剂量转化为实际可行的给药体积。[@problem_id:5195147] 掌握这项技能对于防止因剂量不足导致的治疗失败和因剂量过大引起的不良反应至关重要。", "problem": "一名年龄为 $24$ 个月的儿童疑似感染百日咳博德特氏菌，处方给予阿奇霉素，治疗方案为每日一次，每次 $10$ 毫克/千克，持续 $5$ 天。该方案符合基于体重的儿科给药惯例，旨在考虑到阿奇霉素较长的细胞内半衰期和抗生素后效应，在不同体重的个体间达到相当的药物暴露量。该儿童体重为 $12$ 千克，无法吞咽片剂。药房可将阿奇霉素口服混悬液配制成两种浓度：每 $5$ 毫升含 $100$ 毫克或每 $5$ 毫升含 $200$ 毫克。为确保用药依从性并减少胃肠道不耐受，首选使用单次给药体积最小的制剂。根据基于体重的儿科给药基本原理和浓度-体积等效性，确定为满足该儿童的处方方案，每日一次应给予的体积，同时认识到 $5$ 天的疗程长度不影响单次剂量的计算。最终答案以毫升 (mL) 表示。", "solution": "在进行求解之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   儿童年龄：$24$ 个月\n-   儿童体重：$12$ 千克\n-   处方药物：阿奇霉素\n-   给药方案：每日一次，每次 $10$ 毫克/千克，持续 $5$ 天\n-   条件：儿童无法吞咽片剂。\n-   可用的口服混悬液浓度：\n    1.  $C_1 = 100$ 毫克 / $5$ 毫升\n    2.  $C_2 = 200$ 毫克 / $5$ 毫升\n-   优化标准：最小化单次给药体积。\n-   目标：确定每日一次的给药体积，单位为毫升 (mL)。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n-   **科学依据**：该问题基于既定的儿科药理学原理。对于幼儿百日咳，指定的阿奇霉素剂量（$10$ 毫克/千克/天）是标准的、临床上接受的治疗方案。可用的药物浓度（$100$ 毫克/$5$ 毫升和 $200$ 毫克/$5$ 毫升）是标准的药物制剂。基于体重的给药原理以及为提高依从性和耐受性而最小化给药体积的临床目标都是合理的原则。\n-   **适定性**：该问题是适定的。它提供了所有必要的数据——基于质量的处方剂量、患者的体重以及可用的浓度——以确定唯一的解。最小化体积的约束明确地指导了在两种浓度之间的选择。\n-   **客观性**：问题以精确、客观和定量的语言陈述。\n\n该问题没有科学上的不合理性、模糊性或内部矛盾。这是一个基于真实临床数据的可形式化的计算。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将基于基本原理构建解决方案。\n\n求解过程首先计算单次剂量所需的阿奇霉素质量，然后根据最小化标准选择合适的浓度，最后计算所需的体积。\n\n令 $m_{child}$ 为儿童的体重，给定值为 $12$ kg。\n令 $D_{rate}$ 为处方剂量率，为每天 $10$ mg/kg。\n\n每日单次剂量所需的阿奇霉素总质量 $M_{dose}$，通过将儿童体重乘以剂量率计算得出：\n$$M_{dose} = m_{child} \\times D_{rate}$$\n代入给定值：\n$$M_{dose} = 12 \\text{ kg} \\times 10 \\text{ mg/kg} = 120 \\text{ mg}$$\n该儿童每日需要一次 $120$ mg 的阿奇霉素剂量。疗程的持续时间（$5$ 天）与计算单次剂量体积无关，正如问题陈述中正确指出的那样。\n\n接下来，我们必须选择合适的口服混悬液。有两种浓度可供选择：\n1.  浓度 $C_1$：$100$ 毫克 / $5$ 毫升\n2.  浓度 $C_2$：$200$ 毫克 / $5$ 毫升\n\n为便于比较和计算，将这些浓度转换为 mg/mL 单位：\n$$C_1 = \\frac{100 \\text{ mg}}{5 \\text{ mL}} = 20 \\text{ mg/mL}$$\n$$C_2 = \\frac{200 \\text{ mg}}{5 \\text{ mL}} = 40 \\text{ mg/mL}$$\n\n问题指明首选使单次给药体积最小化的制剂。剂量质量（$M_{dose}$）、浓度（$C$）和体积（$V$）之间的关系是：\n$$V = \\frac{M_{dose}}{C}$$\n为了在剂量质量 $M_{dose}$ 恒定时最小化体积 $V$，浓度 $C$ 必须最大化。比较两种可用浓度，$C_2 > C_1$ 因为 $40 \\text{ mg/mL} > 20 \\text{ mg/mL}$。因此，必须使用浓度为 $200$ 毫克 / $5$ 毫升（或 $40$ 毫克/毫升）的混悬液。\n\n现在，我们可以使用所需的剂量质量（$M_{dose} = 120$ mg）和选定的浓度（$C_2 = 40$ mg/mL）计算最终需要给予的体积 $V_{administer}$：\n$$V_{administer} = \\frac{M_{dose}}{C_2}$$\n$$V_{administer} = \\frac{120 \\text{ mg}}{40 \\text{ mg/mL}}$$\n$$V_{administer} = 3 \\text{ mL}$$\n\n因此，应给该儿童每日一次服用 $3$ mL 浓度为 $200$ 毫克 / $5$ 毫升的阿奇霉素口服混悬液。该体积满足了医生的处方，同时遵循了最小化给药体积的原则。", "answer": "$$\n\\boxed{3}\n$$", "id": "5195147"}, {"introduction": "在临床实践中，实验室结果并非总是清晰明了。处理百日咳时一个常见的挑战是解读不一致的结果，例如细菌培养阴性但聚合酶链式反应(PCR)检测阳性，尤其是在抗生素治疗开始之后。本练习旨在探讨这种差异背后的生物学机制——即可培养的活菌与残留的细菌DNA之间的区别，这需要整合药理学、分子诊断学和感染病程的知识。[@problem_id:5195116] 这种思维训练能够帮助临床医生在复杂情况下对治疗效果和患者传染性做出合理判断，避免常见的误读。", "problem": "一名$6$岁儿童，阵发性咳嗽$12$天，因家庭接触过经培养确诊的Bordetella pertussis而就诊。该儿童于病程第$4$天开始服用阿奇霉素。病程第$12$天采集的鼻咽拭子标本培养结果为阴性，但聚合酶链反应(PCR)检测结果为阳性，循环阈值(Ct)为$38$。假设以下机理和流行病学基础：\n\n- 大环内酯类药物通过与$50$S核糖体亚基结合来抑制细菌蛋白质合成，从而减少活菌数量并中止毒素产生。\n- 细菌培养需要能够在选择性培养基上进行二分裂的活菌落形成单位(CFU)；检测通常要求标本中含有$\\geq 10^2$个活CFU。\n- PCR扩增目标脱氧核糖核酸(DNA)，无论其是否具有活性；较高的Ct值反映了较低的模板浓度。\n- 在有效的大环内酯类药物治疗于时间$t=0$开始后，活菌负荷大致呈指数级下降，公式为$N(t)=N_0 e^{-k t}$，其中$N_0$是初始活菌负荷，$k>0$是由药物暴露量和细菌敏感性决定的杀菌速率常数。\n- 细菌死亡后，由于核酸酶活性和黏膜纤毛清除作用，呼吸道分泌物中的胞外和胞内细菌DNA会发生降解，这可以近似为一个半衰期为$h$的一级过程，残留的DNA拷贝数由公式$D(t)=D_0 \\cdot 2^{-t/h}$给出，其中$D_0$是$t=0$时可供PCR检测的初始模板丰度。\n- 对于病程晚期（咳嗽发作后$\\geq 14$天），PCR的敏感性下降，而抗百日咳毒素免疫球蛋白G (IgG)的血清学检测变得具有参考价值。\n- 诊断测试的贝叶斯解释使用敏感性($Se$)和特异性($Sp$)来更新先验概率。设疾病的先验概率为$P(D)$。对于阳性测试结果，后验概率（阳性预测值）为$PPV = \\dfrac{Se \\cdot P(D)}{Se \\cdot P(D) + (1-Sp)\\cdot (1-P(D))}$。\n\n您可以假设典型的儿科参数：阿奇霉素治疗开始时$N_0=10^6$ CFU，$k=1.5$ 天$^{-1}$，培养检测阈值为$10^2$ CFU；$D_0=10^6$ 基因组拷贝数，$h=1.5$ 天，PCR检测阈值为$10^2$ 基因组拷贝数。对于有家庭接触史且咳嗽症状相符的儿童，假设先验概率$P(D)=0.4$，病程晚期PCR敏感性$Se=0.6$，特异性$Sp=0.98$。家属询问阳性的PCR结果是否意味着持续的传染性或治疗失败。\n\n以下哪种解释和管理框架最适合本病例？\n\nA. 最简约的解释是来自无活性的Bordetella pertussis的残留DNA，这与有效的大环内酯类药物治疗将活菌抑制到培养阈值以下的情况相符；隔离无需超过$5$天适当治疗的期限，也无需重复大环内酯类药物疗程。\n\nB. 大环内酯类药物治疗后PCR阳性意味着持续的传染性；应重复一个为期$14$天的完整大环内酯类药物疗程，并持续隔离直至PCR转为阴性，因为PCR阳性等同于传染性。\n\nC. 结合高Ct值($38$)和病程时间线，推断模板负荷低，与残留DNA的情况相符；对于超过$14$天的病程，考虑进行抗百日咳毒素IgG的血清学检测以支持近期感染状态，并根据化学预防建议管理接触者，而不延长患者的治疗。\n\nD. 培养阴性排除了百日咳；因此，阳性的PCR结果很可能是污染，因为大环内酯类药物能在$24$小时内迅速清除所有细菌DNA。\n\nE. 应用贝叶斯推理：在$P(D)=0.4$，$Se=0.6$和$Sp=0.98$的情况下，阳性的PCR结果表明近期感染的后验概率很高，尽管患者在治疗$5$天后很可能已不具传染性；应强调公共卫生通报和完成标准隔离期，而不是为了使PCR转阴而重复使用抗生素。\n\n选择所有适用选项。", "solution": "问题陈述提供了一个临床情景、诊断结果以及一套用于解释疑似百日咳患儿病例的机理和流行病学模型。该陈述具有科学依据、提法严谨、内部一致且客观。它呈现了一个结合了微生物学、药理学、分子诊断学和流行病学知识的现实临床挑战。其中的数学模型是适用于此情景的适当简化。因此，该问题是有效的。\n\n核心任务是在患者临床史和治疗背景下，解释培养阴性而PCR阳性这一不一致的结果，并确定适当的管理方案。\n\n首先，我将使用提供的定量模型分析患者的状况。患者于病程第$4$天开始服用阿奇霉素，并于第$12$天进行检测。检测时的治疗持续时间为 $t = 12 - 4 = 8$ 天。\n\n1.  **活菌负荷（培养结果）**\n    活菌数量$N(t)$由模型$N(t) = N_0 e^{-kt}$描述。\n    给定参数：\n    - 初始活菌负荷，$N_0 = 10^6$ CFU\n    - 杀菌速率常数，$k = 1.5$ 天$^{-1}$\n    - 培养检测阈值，$10^2$ CFU\n\n    在$t = 8$天时，预测的活菌负荷为：\n    $$ N(8) = 10^6 \\cdot e^{-1.5 \\cdot 8} = 10^6 \\cdot e^{-12} $$\n    使用近似值$e \\approx 2.718$，我们有$e^{12} \\approx 1.627 \\times 10^5$。\n    $$ N(8) \\approx \\frac{10^6}{1.627 \\times 10^5} \\approx 6.14 \\text{ CFU} $$\n    由于$N(8) \\approx 6.14$ CFU小于培养检测阈值$10^2$ CFU，该模型预测培养结果为阴性。这与患者的实验室检查结果一致，并表明阿奇霉素治疗在减少活菌数量方面是有效的。\n\n2.  **残留DNA（PCR结果）**\n    残留DNA拷贝数$D(t)$由模型$D(t) = D_0 \\cdot 2^{-t/h}$描述。\n    给定参数：\n    - 初始DNA拷贝数，$D_0 = 10^6$ 拷贝\n    - DNA降解半衰期，$h = 1.5$ 天\n    - PCR检测阈值，$10^2$ 基因组拷贝数\n\n    在$t = 8$天时，预测的DNA拷贝数为：\n    $$ D(8) = 10^6 \\cdot 2^{-8/1.5} = 10^6 \\cdot 2^{-5.33\\overline{3}} $$\n    $$ D(8) = 10^6 \\cdot \\frac{1}{2^{16/3}} = 10^6 \\cdot \\frac{1}{\\sqrt[3]{2^{16}}} = 10^6 \\cdot \\frac{1}{\\sqrt[3]{65536}} \\approx \\frac{10^6}{40.3} \\approx 24800 \\text{ 拷贝} $$\n    由于$D(8) \\approx 24800$ 拷贝数大于PCR检测阈值$10^2$ 拷贝数，该模型预测PCR结果为阳性。这一发现也与患者的实验室结果一致。$38$的高循环阈值(Ct)表明目标DNA浓度较低，这与治疗开始多日后模板载量呈指数衰减的情况在性质上是一致的。\n\n3.  **贝叶斯解释（诊断确定性）**\n    问题提供了计算在PCR检测阳性的情况下疾病后验概率（阳性预测值，PPV）所需的参数。\n    给定参数：\n    - 疾病先验概率，$P(D) = 0.4$\n    - PCR敏感性，$Se = 0.6$\n    - PCR特异性，$Sp = 0.98$\n\n    后验概率使用提供的公式计算：\n    $$ PPV = \\frac{Se \\cdot P(D)}{Se \\cdot P(D) + (1-Sp) \\cdot (1-P(D))} $$\n    $$ PPV = \\frac{0.6 \\cdot 0.4}{0.6 \\cdot 0.4 + (1-0.98) \\cdot (1-0.4)} $$\n    $$ PPV = \\frac{0.24}{0.24 + (0.02 \\cdot 0.6)} $$\n    $$ PPV = \\frac{0.24}{0.24 + 0.012} = \\frac{0.24}{0.252} = \\frac{240}{252} = \\frac{20}{21} \\approx 0.9524 $$\n    约$95.2\\%$的后验概率非常高，证实了尽管培养结果为阴性，患者极有可能近期感染了百日咳。\n\n现在我将基于这一全面分析来评估每个选项。\n\nA. 上述分析表明，活菌数量低于培养检测限而无活性的细菌DNA仍可被PCR检测到是完全符合逻辑的。这是治疗后对此类不一致结果的经典解释。标准的百日咳公共卫生指南指出，在完成$5$天有效抗生素治疗后，个体即被视为不具传染性。该儿童正处于治疗的第$8$天，因此没有必要延长隔离期。由于证据指向治疗有效（培养阴性）而非治疗失败，因此无需重复抗生素疗程。**结论：正确。**\n\nB. 这一陈述基于对分子诊断学的根本误解。PCR检测的是特定的核酸序列，无法区分来自活体传染性生物的DNA和来自死亡生物的DNA。传染性取决于是否存在活菌。所提议的管理措施（重复抗生素治疗，隔离至PCR转阴）是不适当的，会导致不必要的用药和社会限制。在感染不再具有传染性后，残留DNA仍可能在数周内被检测到。**结论：不正确。**\n\nC. 高Ct值($38$)正确地暗示了DNA模板浓度低，这支持了“残留DNA”的假说。问题陈述指明，对于病程$\\ge 14$天的疾病，血清学检测变得有参考价值。由于该儿童处于病程第$12$天，将血清学检测作为一种确证工具是综合诊断策略的适当组成部分，尤其是在需要进一步确认近期感染时。对接触者进行化学预防管理是确诊百日咳病例的标准公共卫生措施。不延长患者治疗是正确的，因为治疗似乎是有效的。**结论：正确。**\n\nD. 这一陈述包含两个重大错误。首先，对*B. pertussis*的培养敏感性有限，尤其是在开始使用抗生素后。培养阴性并不能排除诊断。其次，“大环内酯类药物在$24$小时内清除所有DNA”的说法在生物学上是不正确的。问题本身提供的模型（DNA半衰期为$h=1.5$天）明确反驳了这一点。DNA清除是一个需要数天到数周的过程。考虑到强烈的流行病学关联和相符的症状，污染的可能性远低于真阳性。**结论：不正确。**\n\nE. 我的计算证实，即使PCR敏感性中等，但在高先验概率和高特异性的情况下，阳性的PCR检测结果仍将感染的后验概率显著提高至约$95.2\\%$。这量化了诊断的确定性。其管理建议完全正确：患者在治疗$5$天后不再具有传染性，公共卫生通报至关重要，标准隔离是足够的，而用更多抗生素“追逐PCR转阴”是不适当的。**结论：正确。**\n\n选项A、C和E为解释临床和实验室数据以及制定适当的管理方案提供了互补且正确的框架。它们正确地综合了生物学原理、定量模型和公共卫生指南。", "answer": "$$\\boxed{ACE}$$", "id": "5195116"}, {"introduction": "除了个体患者的诊疗，儿科专家的一个关键角色是理解和评估群体层面的预防策略。孕期母亲接种Tdap疫苗是保护易感婴儿在完成其初级疫苗系列前免受百日咳侵害的一项关键公共卫生干预措施。[@problem_id:5195081] 这项高级练习将挑战您从临床直觉转向定量评估，通过构建一个流行病学模型来模拟母传抗体和婴儿疫苗接种如何随时间相互作用以降低疾病发病率。发展定量建模的技能有助于更深入地理解疫苗效果，并为审慎评估和推动公共卫生政策提供工具。", "problem": "考虑一个出生队列模型，以量化在两种策略下生命早期的百日咳发病率：（i）仅婴儿接种白喉、破伤风、非细胞性百日咳（DTaP）疫苗，以及（ii）孕期接种破伤风、白喉、非细胞性百日咳（Tdap）疫苗外加婴儿接种DTaP疫苗。根据以下基本事实和定义，从第一性原理构建该模型。\n\n- 经胎盘免疫球蛋白G（IgG）浓度以半衰期呈指数衰减：如果$A(0)$表示出生时的抗体浓度，则\n$$\nA(t) = A(0)\\,\\exp\\!\\left(-\\ln(2)\\,\\frac{t}{T_{1/2}}\\right),\n$$\n其中$t$是以天为单位的时间，$T_{1/2}$是以天为单位的半衰期。\n\n- 瞬时感染力在婴儿早期被建模为常数：$\\lambda$ 每天。\n\n- 假设来自母体抗体的感染保护是抗体浓度的饱和函数：\n$$\nP_{\\mathrm{mat}}(t) = \\frac{A(t)}{A(t) + A_{50}},\n$$\n其中$A_{50}$是提供半最大保护的浓度。由母体抗体引起的残余易感性为 $S_{\\mathrm{mat}}(t) = 1 - P_{\\mathrm{mat}}(t)$。\n\n- 婴儿在时间$t$由疫苗获得的保护按剂次数呈分段常数，每剂接种后有$\\delta$天的免疫成熟延迟。设预定接种日为$d_1$、$d_2$和$d_3$，每剂次效力为$E_1$、$E_2$和$E_3$。定义\n$$\nP_{\\mathrm{vac}}(t) =\n\\begin{cases}\n0, & t < d_1+\\delta,\\\\\nE_1, & d_1+\\delta \\le t < d_2+\\delta,\\\\\nE_2, & d_2+\\delta \\le t < d_3+\\delta,\\\\\nE_3, & t \\ge d_3+\\delta,\n\\end{cases}\n$$\n以及由疫苗接种引起的残余易感性为 $S_{\\mathrm{vac}}(t) = 1 - P_{\\mathrm{vac}}(t)$。\n\n- 假设保护机制相互独立，总残余易感性为\n$$\nS(t) = S_{\\mathrm{mat}}(t)\\,S_{\\mathrm{vac}}(t).\n$$\n\n- 随时间变化的感染风险为$h(t) = \\lambda\\,S(t)$。在非齐次泊松过程中，时间范围$[0,T]$内的累积风险为\n$$\nH = \\int_0^T h(t)\\,dt,\n$$\n单个婴儿的感染概率为\n$$\np = 1 - \\exp(-H).\n$$\n\n- 在$[0,T]$天内，每$100000$名婴儿的预期病例数为$C = 100000 \\cdot p$。以天为单位表示$T$，并以“每$100000$名婴儿的病例数”报告$C$。报告降低率时，请使用小数表示，而不是百分号。\n\n您的任务是编写一个完整、可运行的程序，实现以下功能：\n1. 实现上述模型，以计算两种情景下在$[0,T]$时间范围内的生命早期发病率：\n   - 情景A（仅婴儿接种DTaP）：设置$A(0) = A_{\\mathrm{0,nm}}$。\n   - 情景B（孕产妇Tdap加婴儿DTaP）：设置$A(0) = A_{\\mathrm{0,m}}$。\n   两种情景共享相同的$T_{1/2}$、$\\lambda$、$A_{50}$、$\\delta$、$\\{d_i\\}$和$\\{E_i\\}$。\n2. 计算由孕产妇Tdap带来的发病率相对降低率$\\rho$，定义为\n$$\n\\rho = \n\\begin{cases}\n\\frac{C_{\\mathrm{A}} - C_{\\mathrm{B}}}{C_{\\mathrm{A}}}, & C_{\\mathrm{A}} > 0,\\\\\n0, & C_{\\mathrm{A}} = 0,\n\\end{cases}\n$$\n其中$C_{\\mathrm{A}}$和$C_{\\mathrm{B}}$分别是在$[0,T]$天内，情景A和情景B中每$100000$名婴儿的病例数。\n\n使用每日时间步长$\\Delta t = 1$天，将积分近似为黎曼和。\n\n实现您的程序以运行以下测试套件。对于每个案例，计算并返回$\\rho$作为单个浮点数。\n\n- 测试用例1（通用“正常路径”）：$T = 180$，$\\lambda = 1\\times 10^{-4}$ 每天，$T_{1/2} = 35$天，$A_{50} = 20$，$A_{\\mathrm{0,nm}} = 10$，$A_{\\mathrm{0,m}} = 60$，$\\delta = 14$天，$(d_1,d_2,d_3) = (60,120,180)$天，$(E_1,E_2,E_3) = (0.6,0.8,0.85)$。\n- 测试用例2（零传播边界）：与用例1相同，但$\\lambda = 0$ 每天。\n- 测试用例3（抗体快速衰减）：与用例1相同，但$T_{1/2} = 20$天。\n- 测试用例4（延迟婴儿接种剂量）：$T = 180$，$\\lambda = 1\\times 10^{-4}$ 每天，$T_{1/2} = 35$天，$A_{50} = 20$，$A_{\\mathrm{0,nm}} = 10$，$A_{\\mathrm{0,m}} = 60$，$\\delta = 14$天，$(d_1,d_2,d_3) = (90,150,210)$天，$(E_1,E_2,E_3) = (0.6,0.8,0.85)$。\n- 测试用例5（高传播强度）：与用例1相同，但$\\lambda = 5\\times 10^{-4}$ 每天。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3]”）。每个结果是相应测试用例的发病率相对降低率$\\rho$，以小数表示。", "solution": "该问题陈述已经过严格验证，并被确定为有效。它具有科学依据，问题设定良好、客观且自成体系，提出了一个标准的流行病学建模任务，并提供了所有必要的参数和定义。\n\n目标是量化在标准婴儿DTaP疫苗接种计划中补充孕期Tdap疫苗接种后，百日咳发病率的相对降低率$\\rho$。这是通过在两种不同情景下构建和分析一个出生队列模型来实现的。\n\n该模型基于生存分析和传染病流行病学的第一性原理。它模拟了一个新生儿队列在$T$天的时间范围内的感染风险。模型的核心是随时间变化的感染风险$h(t)$，通过对其积分得到累积风险$H$，并随后得到总感染概率$p$。\n\n在非齐次泊松过程中，直到时间$T$保持未感染的概率的基本方程是$\\exp(-H)$，其中$H$是累积风险：\n$$\nH = \\int_0^T h(t)\\,dt\n$$\n因此，在区间$[0, T]$内的感染概率是$p = 1 - \\exp(-H)$。每100,000名婴儿的预期病例数是$C = 100000 \\cdot p$。\n\n问题指定使用每日时间步长$\\Delta t = 1$天的黎曼和来近似$H$的积分。将时间离散化为天数$t=0, 1, 2, \\dots, T-1$，累积风险近似为：\n$$\nH \\approx \\sum_{t=0}^{T-1} h(t)\\,\\Delta t = \\sum_{t=0}^{T-1} h(t)\n$$\n\n在时间$t$的瞬时风险定义为$h(t) = \\lambda\\,S(t)$，其中$\\lambda$是恒定的感染力，$S(t)$是婴儿在年龄$t$时的总残余易感性。\n\n总易感性$S(t)$是母体抗体保护和婴儿疫苗接种保护后剩余易感性的乘积，假设这些机制是独立的：\n$$\nS(t) = S_{\\mathrm{mat}}(t)\\,S_{\\mathrm{vac}}(t)\n$$\n\n由于母体抗体减弱而产生的易感性$S_{\\mathrm{mat}}(t)$，源自保护函数$P_{\\mathrm{mat}}(t)$：\n$$\nS_{\\mathrm{mat}}(t) = 1 - P_{\\mathrm{mat}}(t) = 1 - \\frac{A(t)}{A(t) + A_{50}} = \\frac{A_{50}}{A(t) + A_{50}}\n$$\n此处，$A_{50}$是提供半最大保护的抗体浓度。时间$t$的抗体浓度$A(t)$，从其出生时的值$A(0)$开始，以给定的半衰期$T_{1/2}$呈指数衰减：\n$$\nA(t) = A(0)\\,\\exp\\!\\left(-\\frac{\\ln(2)}{T_{1/2}} t\\right)\n$$\n情景A（仅婴儿疫苗）和情景B（孕产妇+婴儿疫苗）通过不同的初始抗体浓度$A(0) = A_{\\mathrm{0,nm}}$和$A(0) = A_{\\mathrm{0,m}}$来区分。\n\n婴儿疫苗接种后剩余的易感性$S_{\\mathrm{vac}}(t)$，源自分段常数保护函数$P_{\\mathrm{vac}}(t)$：\n$$\nS_{\\mathrm{vac}}(t) = 1 - P_{\\mathrm{vac}}(t)\n$$\n其中$P_{\\mathrm{vac}}(t)$根据疫苗接种计划$\\{d_1, d_2, d_3\\}$、每剂次效力$\\{E_1, E_2, E_3\\}$和免疫成熟延迟$\\delta$来定义：\n$$\nP_{\\mathrm{vac}}(t) =\n\\begin{cases}\n0,  & t  d_1+\\delta,\\\\\nE_1,  d_1+\\delta \\le t  d_2+\\delta,\\\\\nE_2,  d_2+\\delta \\le t  d_3+\\delta,\\\\\nE_3,  t \\ge d_3+\\delta,\n\\end{cases}\n$$\n\n对于给定的测试用例，计算步骤如下：\n1.  建立一个从$t=0$到$t=T-1$的离散时间向量。\n2.  对于情景A，设置$A(0) = A_{\\mathrm{0,nm}}$。\n    a.  计算所有$t$的母体抗体浓度向量$A(t)$。\n    b.  计算母体易感性向量$S_{\\mathrm{mat}}(t)$。\n    c.  根据DTaP计划计算疫苗易感性向量$S_{\\mathrm{vac}}(t)$。\n    d.  计算总易感性向量$S(t) = S_{\\mathrm{mat}}(t) \\odot S_{\\mathrm{vac}}(t)$（逐元素乘积）。\n    e.  计算每日风险向量$h(t) = \\lambda S(t)$。\n    f.  对风险向量求和以获得累积风险$H_A$。\n    g.  计算总病例数$C_A = 100000 \\cdot (1 - \\exp(-H_A))$。\n3.  对情景B重复步骤2，设置$A(0) = A_{\\mathrm{0,m}}$，以找到$C_B$。\n4.  使用以下公式计算发病率相对降低率$\\rho$：\n    $$\n    \\rho = \n    \\begin{cases}\n    \\frac{C_{\\mathrm{A}} - C_{\\mathrm{B}}}{C_{\\mathrm{A}}},   C_{\\mathrm{A}}  0,\\\\\n    0,   C_{\\mathrm{A}} = 0,\n    \\end{cases}\n    $$\n该过程对问题陈述中提供的每个测试用例实施。使用`numpy`库提供的向量化操作，可以高效地实现这种离散时间模拟。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_cases(T, lambda_val, T_half_life, A50, A0, delta, d, E):\n    \"\"\"\n    Calculates the expected number of pertussis cases per 100,000 infants\n    over a time horizon T based on the provided epidemiological model.\n\n    Args:\n        T (int): Time horizon in days.\n        lambda_val (float): Force of infection per day.\n        T_half_life (float): Half-life of maternal antibodies in days.\n        A50 (float): Antibody concentration for half-maximal protection.\n        A0 (float): Antibody concentration at birth.\n        delta (int): Immune maturation delay after vaccination in days.\n        d (tuple): Scheduled days for vaccine doses (d1, d2, d3).\n        E (tuple): Per-dose vaccine efficacies (E1, E2, E3).\n\n    Returns:\n        float: Expected cases per 100,000 infants.\n    \"\"\"\n    # If there is no transmission, there are no cases.\n    if lambda_val == 0:\n        return 0.0\n\n    # Time vector from t=0 to T-1, representing daily steps.\n    t = np.arange(T)\n\n    # 1. Maternal antibody dynamics and susceptibility\n    # Exponential decay of maternal antibodies\n    decay_rate = np.log(2) / T_half_life\n    A_t = A0 * np.exp(-decay_rate * t)\n\n    # Residual susceptibility from maternal antibodies\n    S_mat_t = A50 / (A_t + A50)\n\n    # 2. Infant vaccination dynamics and susceptibility\n    d1, d2, d3 = d\n    E1, E2, E3 = E\n    \n    # Initialize susceptibility from vaccination as 1 (no protection).\n    S_vac_t = np.ones_like(t, dtype=float)\n    \n    # Apply vaccine efficacies based on the schedule, including the maturation delay.\n    # The conditions define the time windows where each dose's protection is active.\n    cond1 = (t >= d1 + delta)  (t  d2 + delta)\n    S_vac_t[cond1] = 1.0 - E1\n    \n    cond2 = (t >= d2 + delta)  (t  d3 + delta)\n    S_vac_t[cond2] = 1.0 - E2\n    \n    cond3 = (t >= d3 + delta)\n    S_vac_t[cond3] = 1.0 - E3\n\n    # 3. Total susceptibility and hazard\n    # Total residual susceptibility, assuming independence\n    S_t = S_mat_t * S_vac_t\n\n    # Time-varying hazard of infection\n    h_t = lambda_val * S_t\n\n    # 4. Cumulative hazard and total cases\n    # Cumulative hazard (approximated by Riemann sum with dt=1)\n    H = np.sum(h_t)\n\n    # Probability of infection for a single infant\n    p = 1.0 - np.exp(-H)\n    \n    # Expected cases per 100,000 infants\n    C = 100000.0 * p\n    \n    return C\n\ndef solve():\n    \"\"\"\n    Runs the test suite for the pertussis incidence model and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # T, lambda, T_1/2, A50, A0_nm, A0_m, delta, (d1,d2,d3), (E1,E2,E3)\n        {'T': 180, 'lambda_val': 1e-4, 'T_half_life': 35, 'A50': 20, 'A0_nm': 10, 'A0_m': 60, 'delta': 14, 'd': (60, 120, 180), 'E': (0.6, 0.8, 0.85)},\n        {'T': 180, 'lambda_val': 0, 'T_half_life': 35, 'A50': 20, 'A0_nm': 10, 'A0_m': 60, 'delta': 14, 'd': (60, 120, 180), 'E': (0.6, 0.8, 0.85)},\n        {'T': 180, 'lambda_val': 1e-4, 'T_half_life': 20, 'A50': 20, 'A0_nm': 10, 'A0_m': 60, 'delta': 14, 'd': (60, 120, 180), 'E': (0.6, 0.8, 0.85)},\n        {'T': 180, 'lambda_val': 1e-4, 'T_half_life': 35, 'A50': 20, 'A0_nm': 10, 'A0_m': 60, 'delta': 14, 'd': (90, 150, 210), 'E': (0.6, 0.8, 0.85)},\n        {'T': 180, 'lambda_val': 5e-4, 'T_half_life': 35, 'A50': 20, 'A0_nm': 10, 'A0_m': 60, 'delta': 14, 'd': (60, 120, 180), 'E': (0.6, 0.8, 0.85)},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack common parameters\n        params = {k: v for k, v in case.items() if k not in ['A0_nm', 'A0_m']}\n        \n        # Calculate cases for Scenario A (infant DTaP only)\n        C_A = calculate_cases(A0=case['A0_nm'], **params)\n        \n        # Calculate cases for Scenario B (maternal Tdap + infant DTaP)\n        C_B = calculate_cases(A0=case['A0_m'], **params)\n        \n        # Calculate fractional incidence reduction, rho\n        if C_A > 0:\n            rho = (C_A - C_B) / C_A\n        else:\n            rho = 0.0\n            \n        results.append(rho)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "5195081"}]}