{"hands_on_practices": [{"introduction": "这项实践将聚焦于儿科肿瘤学中的一项核心技能：基于体表面积（BSA）的化疗药物剂量计算。我们将通过计算长春新碱的剂量，并考虑为减轻毒性而设定的剂量上限，来理解标准化疗方案如何针对个体患者进行调整。该练习突出了在实现治疗效果与确保患者安全之间取得平衡的重要性 [@problem_id:5218814]。", "problem": "一名患有维尔姆斯肿瘤（肾母细胞瘤）的儿童计划接受长春新碱治疗，作为标准儿科肿瘤治疗方案的一部分。在儿科肿瘤学中，许多细胞毒性药物的给药剂量是根据体表面积（BSA）进行调整的，以近似不同患者间的全身暴露量相似性，因为在儿童中，分布和清除的生理决定因素（例如，肝脏和肾脏血流量）与体表面积的相关性比与体重的相关性更密切。考虑一个给药方案，该方案规定长春新碱的给药强度为 $1.5\\ \\mathrm{mg/m^2}$，并设定了方案规定的单次最大剂量上限 $2\\ \\mathrm{mg}$，以减轻剂量依赖性神经毒性。该患儿通过标准方法计算出的体表面积为 $1.4\\ \\mathrm{m^2}$。从基本原理出发，即当药物按体表面积给药时，总剂量应与体表面积成线性比例，以保持不同患者间的暴露量一致。请构建一个既包含线性BSA缩放又包含单次最大剂量上限的给药剂量表达式。然后，计算该患儿长春新碱的给药剂量数值。将最终答案四舍五入至三位有效数字，并以毫克（mg）为单位表示最终剂量。", "solution": "儿科肿瘤学中细胞毒性药物的基本药理学原理是，全身暴露量（以及由此产生的毒性和疗效）与体表面积（BSA）的相关性比与体重的相关性更密切。因此，为了在不同体型的患者间实现近似相等的暴露量，总给药剂量与BSA成线性比例关系。如果给药强度为 $I$（单位 $\\mathrm{mg/m^2}$），患者的体表面积为 $A$（单位 $\\mathrm{m^2}$），根据量纲分析，线性缩放的剂量为 $I \\times A$（单位 $\\mathrm{mg}$），因为\n$$\n[I] = \\mathrm{mg/m^2},\\quad [A] = \\mathrm{m^2}\\ \\Rightarrow\\ [I \\times A] = \\mathrm{mg}.\n$$\n对于长春新碱，为了限制剂量依赖性神经毒性，临床方案规定了单次最大剂量上限。设 $C$ 表示以 $\\mathrm{mg}$ 为单位的剂量上限。同时遵守线性BSA缩放和剂量上限的给药剂量 $D$ 是线性缩放剂量与剂量上限中的较小者，可写作\n$$\nD = \\min\\{I \\times A,\\ C\\}.\n$$\n我们现在确定给定的量：$I = 1.5\\ \\mathrm{mg/m^2}$，$A = 1.4\\ \\mathrm{m^2}$，以及 $C = 2\\ \\mathrm{mg}$。计算线性缩放剂量：\n$$\nI \\times A = \\left(1.5\\ \\mathrm{mg/m^2}\\right)\\left(1.4\\ \\mathrm{m^2}\\right) = 2.1\\ \\mathrm{mg}.\n$$\n将此值与剂量上限 $C = 2\\ \\mathrm{mg}$ 进行比较。由于 $2.1\\ \\mathrm{mg} > 2\\ \\mathrm{mg}$，给药剂量受到剂量上限的限制：\n$$\nD = \\min\\{2.1\\ \\mathrm{mg},\\ 2\\ \\mathrm{mg}\\} = 2\\ \\mathrm{mg}.\n$$\n将结果四舍五入至三位有效数字，并以毫克为单位表示，得到 $2.00\\ \\mathrm{mg}$。", "answer": "$$\\boxed{2.00}$$", "id": "5218814"}, {"introduction": "超越标准化治疗，现代肿瘤学利用分子标志物来精确评估预后。本练习将演示如何通过将特定的遗传学改变，如杂合性丢失（LOH）和拷贝数变异，整合到生物统计学模型中来量化复发风险。你将应用比例风险模型，理解肿瘤生物学特性如何转化为具体的预后评估 [@problem_id:5218763]。", "problem": "在儿童维尔姆斯瘤（肾母细胞瘤）中，特定的细胞遗传学改变与较高的复发风险具有可重复的关联。考虑一个参照队列，其中的儿童患有良好组织学类型的维尔姆斯瘤，且在染色体臂 $1$p 和 $16$q 上没有杂合性丢失 (LOH)，也没有染色体臂 $1$q 增益。假设在诊断后的前 $5$ 年内，复发时间遵循指数分布，其基线风险恒定为 $\\lambda_0$，使得 $5$ 年累积复发率为 $p_0 = 0.10$。假设细胞遗传学改变通过 Cox 比例风险 (Cox PH) 框架中的比例风险起作用，对风险具有独立的乘法效应：$1$p 上的 LOH 使风险乘以 $\\text{HR}_{1p} = 1.45$，$16$q 上的 LOH 使风险乘以 $\\text{HR}_{16q} = 1.60$，而 $1$q 增益使风险乘以 $\\text{HR}_{1q} = 1.90$。对于一个肿瘤同时带有 $1$p LOH、$16$q LOH 和 $1$q 增益的儿童，计算这些假设所隐含的综合 $5$ 年累积复发率。将最终风险表示为小数，并四舍五入到四位有效数字。此外，请解释在此建模框架内，每种改变是如何修正复发风险的，要求从基本定义出发，不引用任何未经证实的假设。", "solution": "该解决方案通过多步法，将生存分析的基本原理应用于计算受遗传标志物影响的复发风险。\n\n**第一步：解释模型的基本框架**\n该问题使用 Cox 比例风险（Cox PH）模型，其中时间 $t$ 的风险函数 $h(t)$ 是基线风险函数 $h_0(t)$ 与协变量效应的指数函数的乘积。在此简化案例中，效应直接由风险比（HR）给出，因此对于具有一组协变量的患者，其风险率为 $h(t) = h_0(t) \\times \\text{HR}_{\\text{total}}$。\n问题还规定，复发时间遵循指数分布，这意味着基线风险率是一个常数，即 $h_0(t) = \\lambda_0$。因此，任何具有一组协变量的患者的风险率 $h(t) = \\lambda$ 也是一个常数。\n\n**第二步：关联累积复发率与恒定风险率**\n对于恒定风险率 $\\lambda$，到时间 $\\tau$ 的累积复发率 $p(\\tau)$ 与生存函数 $S(\\tau)$ 的关系如下：\n$$p(\\tau) = 1 - S(\\tau) = 1 - e^{-\\lambda \\tau}$$\n对于参照队列，我们有 $p_0(5) = 0.10$，$\\lambda = \\lambda_0$，$\\tau=5$年。因此：\n$$0.10 = 1 - e^{-5\\lambda_0}$$\n这给出了 $e^{-5\\lambda_0} = 1 - 0.10 = 0.90$。这个方程包含了关于基线风险的所有必要信息。\n\n**第三步：计算目标患者的总风险比**\nCox PH模型的一个关键假设是，当协变量（即遗传改变）相互独立时，它们的风险比是可乘的。目标患者同时具有三种不良遗传改变，因此其总风险比 $\\text{HR}_{\\text{total}}$ 是个体风险比的乘积：\n$$\\text{HR}_{\\text{total}} = \\text{HR}_{1p} \\times \\text{HR}_{16q} \\times \\text{HR}_{1q} = 1.45 \\times 1.60 \\times 1.90 = 4.408$$\n这解释了每种改变如何修正风险：基线瞬时复发风险 $\\lambda_0$ 被所有存在的改变的风险比因子共同乘法放大。\n\n**第四步：计算目标患者的累积复发率**\n目标患者的风险率 $\\lambda_{\\text{patient}}$ 也是一个常数，且与基线风险率的关系为：\n$$\\lambda_{\\text{patient}} = \\lambda_0 \\times \\text{HR}_{\\text{total}}$$\n因此，该患者在5年内的累积复发率 $p_{\\text{patient}}$ 为：\n$$p_{\\text{patient}} = 1 - e^{-5\\lambda_{\\text{patient}}} = 1 - e^{-5(\\lambda_0 \\times \\text{HR}_{\\text{total}})}$$\n我们可以利用指数的性质重新整理该表达式：\n$$p_{\\text{patient}} = 1 - (e^{-5\\lambda_0})^{\\text{HR}_{\\text{total}}}$$\n从第二步我们知道 $e^{-5\\lambda_0} = 0.90$。代入此值：\n$$p_{\\text{patient}} = 1 - (0.90)^{\\text{HR}_{\\text{total}}}$$\n现在代入 $\\text{HR}_{\\text{total}}$ 的数值：\n$$p_{\\text{patient}} = 1 - (0.90)^{4.408}$$\n$$p_{\\text{patient}} \\approx 1 - 0.6285098 \\approx 0.3714902$$\n根据要求，将结果四舍五入到四位有效数字，我们得到 $0.3715$。", "answer": "$$ \\boxed{0.3715} $$", "id": "5218763"}, {"introduction": "有效的临床决策依赖于对不同来源数据的系统性整合。在这项实践中，你将构建一个贝叶斯模型来精确诊断小儿肾脏肿块。从一个基于年龄的先验概率开始，你将利用来自多项临床发现的似然比来更新这一信念，最终计算出维尔姆斯瘤的精确后验概率 [@problem_id:5218770]。", "problem": "要求您构建一个定量的贝叶斯推断程序，用以在给定影像学和实验室检查结果的情况下，估计一名患有单侧肾脏肿块的儿科患者患有肾母细胞瘤（Wilms tumor）的后验概率。其基础必须从条件概率和贝叶斯法则的定义开始。队列背景被限定为经超声检查发现患有单侧肾脏肿块的儿童。该模型必须以基于年龄的先验概率为起点，并使用从影像学和实验室证据中导出的似然比进行更新，其假设是各个证据在给定疾病状态下是条件独立的。\n\n使用的基本原理：\n- 条件概率的定义：对于事件 $A$ 和 $B$，$P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$。\n- 贝叶斯法则：对于假设 $H$ 和数据 $D$，$P(H \\mid D) = \\frac{P(D \\mid H) P(H)}{P(D)}$。\n- 使用似然比的贝叶斯法则赔率形式：如果 $O(H)$ 表示赔率 $O(H) = \\frac{P(H)}{1 - P(H)}$，而 $\\operatorname{LR}$ 表示似然比，那么当证据 $D$ 被建模为条件独立的组成部分时，后验赔率满足 $O(H \\mid D) = O(H) \\times \\operatorname{LR}(D)$，每个组成部分通过其自身的似然比以乘法方式贡献。\n\n在该队列（经超声检查发现患有单侧肾脏肿块的儿童）中，肾母细胞瘤 $H$ 的基于年龄的先验概率 $P(H)$ 被指定为关于年龄 $a$（单位：年）的分段函数：\n- 如果 $0 \\le a  1$，那么 $P(H) = 0.65$。\n- 如果 $1 \\le a  2$，那么 $P(H) = 0.75$。\n- 如果 $2 \\le a  6$，那么 $P(H) = 0.85$。\n- 如果 $6 \\le a  10$，那么 $P(H) = 0.55$。\n- 如果 $a \\ge 10$，那么 $P(H) = 0.20$。\n\n需要整合的影像学和实验室检查结果：\n- 影像学上肾内起源（爪征）的存在贡献一个似然比：\n  - 如果存在，$\\operatorname{LR} = 3.5$。\n  - 如果不存在，$\\operatorname{LR} = 0.3$。\n- 影像学上的粗大钙化：\n  - 如果存在，$\\operatorname{LR} = 0.4$。\n  - 如果不存在，$\\operatorname{LR} = 1.8$。\n- 肾静脉或下腔静脉血栓：\n  - 如果存在，$\\operatorname{LR} = 4.0$。\n  - 如果不存在，$\\operatorname{LR} = 0.8$。\n- 血尿（尿中带血）：\n  - 如果存在，$\\operatorname{LR} = 2.2$。\n  - 如果不存在，$\\operatorname{LR} = 0.9$。\n- 儿茶酚胺代谢物（香草扁桃酸/高香草酸；VMA/HVA）：\n  - 如果升高，$\\operatorname{LR} = 0.1$。\n  - 如果正常，$\\operatorname{LR} = 1.5$。\n- 血清乳酸脱氢酶（LDH），单位为U/L，使用肾母细胞瘤与该队列中其他诊断下的正态分布，建模为连续证据。LDH值 $x$ 的似然比为：\n  $$\\operatorname{LR}_{\\mathrm{LDH}}(x) = \\frac{f_{\\mathrm{W}}(x)}{f_{\\neg \\mathrm{W}}(x)},$$\n  其中\n  $$f_{\\mathrm{W}}(x) = \\frac{1}{\\sigma_{\\mathrm{W}} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\mu_{\\mathrm{W}})^2}{2\\sigma_{\\mathrm{W}}^2}\\right), \\quad \\mu_{\\mathrm{W}} = 420, \\ \\sigma_{\\mathrm{W}} = 60,$$\n  $$f_{\\neg \\mathrm{W}}(x) = \\frac{1}{\\sigma_{\\neg \\mathrm{W}} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\mu_{\\neg \\mathrm{W}})^2}{2\\sigma_{\\neg \\mathrm{W}}^2}\\right), \\quad \\mu_{\\neg \\mathrm{W}} = 360, \\ \\sigma_{\\neg \\mathrm{W}} = 70.$$\n\n计算任务：\n1. 实现从基于年龄的先验概率和所提供证据的似然比之积计算后验赔率，假设在给定疾病状态下证据是条件独立的。\n2. 通过以下公式将后验赔率 $O(H \\mid D)$ 转换为后验概率 $P(H \\mid D)$：\n   $$P(H \\mid D) = \\frac{O(H \\mid D)}{1 + O(H \\mid D)}.$$\n3. 将每个测试用例的最终后验概率表示为小数，四舍五入到六位小数。\n\n程序将使用的测试套件（无需用户输入，按序排列的病例）：\n- 病例 $1$：$a = 3.5$ 岁，肾内起源存在，钙化不存在，血栓存在，血尿存在，儿茶酚胺正常，$\\mathrm{LDH} = 480$ U/L。\n- 病例 $2$：$a = 0.8$ 岁，肾内起源不存在，钙化存在，血栓不存在，血尿不存在，儿茶酚胺升高，$\\mathrm{LDH} = 330$ U/L。\n- 病例 $3$：$a = 7.0$ 岁，肾内起源存在，钙化不存在，血栓不存在，血尿存在，儿茶酚胺正常，$\\mathrm{LDH} = 410$ U/L。\n- 病例 $4$：$a = 11.0$ 岁，肾内起源存在，钙化不存在，血栓存在，血尿不存在，儿茶酚胺正常，$\\mathrm{LDH} = 450$ U/L。\n- 病例 $5$：$a = 2.5$ 岁，肾内起源不存在，钙化存在，血栓不存在，血尿不存在，儿茶酚胺升高，$\\mathrm{LDH} = 420$ U/L。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含测试套件的后验概率，形式为用方括号括起来的逗号分隔列表，每个值四舍五入到六位小数（例如，$[0.123456,0.654321,0.500000]$）。", "solution": "该问题要求构建一个贝叶斯推断模型，用以估计一名儿科患者患有肾母细胞瘤（以假设 $H$ 表示）的后验概率，该估计基于一组临床和实验室证据（以数据 $D$ 表示）。分析基于条件概率和贝叶斯法则的原理，并按顺序应用。\n\n基本原理是贝叶斯法则，它关联了两个事件的条件概率。对于一个假设 $H$ 和证据 $D$，其表述为：\n$$P(H \\mid D) = \\frac{P(D \\mid H) P(H)}{P(D)}$$\n其中 $P(H)$ 是假设的先验概率，$P(D \\mid H)$ 是在假设为真的情况下观察到证据的似然，而 $P(H \\mid D)$ 是在观察到证据后假设的后验概率。$P(D)$ 项是证据的边缘概率，作为归一化常数。\n\n在诊断推理中，使用赔率和似然比通常更为方便。事件 $A$ 的赔率定义为 $O(A) = \\frac{P(A)}{1 - P(A)}$。贝叶斯法则可以改写为赔率形式：\n$$O(H \\mid D) = \\frac{P(H \\mid D)}{1 - P(H \\mid D)} = \\frac{P(D \\mid H)}{P(D \\mid \\neg H)} \\times \\frac{P(H)}{1 - P(H)}$$\n这可以简化为：\n$$O(H \\mid D) = \\operatorname{LR}(D) \\times O(H)$$\n其中 $O(H)$ 代表先验赔率，而 $\\operatorname{LR}(D) = \\frac{P(D \\mid H)}{P(D \\mid \\neg H)}$ 是证据 $D$ 的似然比。\n\n该问题指出，各个证据 $D_1, D_2, \\ldots, D_n$ 在给定疾病状态（存在或不存在肾母细胞瘤）下是条件独立的。这一关键假设使得总似然比可以分解为每个证据的单独似然比的乘积：\n$$\\operatorname{LR}_{\\text{total}} = \\operatorname{LR}(D_1) \\times \\operatorname{LR}(D_2) \\times \\cdots \\times \\operatorname{LR}(D_n)$$\n因此，后验赔率通过用这个复合似然比更新先验赔率来计算：\n$$O(H \\mid D_1, \\ldots, D_n) = O(H) \\times \\prod_{i=1}^{n} \\operatorname{LR}(D_i)$$\n\n为每个患者病例计算后验概率的步骤如下：\n\n**1. 确定先验赔率, $O(H)$**\n先验概率 $P(H)$ 是患者年龄 $a$（单位：年）的函数。问题为 $P(H)$ 定义了一个分段函数：\n- 如果 $0 \\le a  1$，则 $P(H) = 0.65$。\n- 如果 $1 \\le a  2$，则 $P(H) = 0.75$。\n- 如果 $2 \\le a  6$，则 $P(H) = 0.85$。\n- 如果 $6 \\le a  10$，则 $P(H) = 0.55$。\n- 如果 $a \\ge 10$，则 $P(H) = 0.20$。\n根据 $P(H)$，先验赔率计算为 $O(H) = \\frac{P(H)}{1 - P(H)}$。\n\n**2. 计算总似然比, $\\operatorname{LR}_{\\text{total}}$**\n总似然比是六个不同证据的似然比的乘积：肾内起源、粗大钙化、血栓、血尿、儿茶酚胺和血清LDH。\n$$\\operatorname{LR}_{\\text{total}} = \\operatorname{LR}_{\\text{origin}} \\times \\operatorname{LR}_{\\text{calc}} \\times \\operatorname{LR}_{\\text{thrombus}} \\times \\operatorname{LR}_{\\text{hematuria}} \\times \\operatorname{LR}_{\\text{cat}} \\times \\operatorname{LR}_{\\text{LDH}}$$\n\n五个二元/分类检查结果的似然比是直接给出的：\n- 肾内起源：$\\operatorname{LR} = 3.5$ (存在) 或 $0.3$ (不存在)。\n- 粗大钙化：$\\operatorname{LR} = 0.4$ (存在) 或 $1.8$ (不存在)。\n- 肾静脉/下腔静脉血栓：$\\operatorname{LR} = 4.0$ (存在) 或 $0.8$ (不存在)。\n- 血尿：$\\operatorname{LR} = 2.2$ (存在) 或 $0.9$ (不存在)。\n- 儿茶酚胺代谢物：$\\operatorname{LR} = 0.1$ (升高) 或 $1.5$ (正常)。\n\n对于连续变量血清LDH水平 $x$，其似然比是在肾母细胞瘤假设（$H$）与备择假设（$\\neg H$）下LDH的概率密度函数（PDF）之比。这些被建模为正态分布：\n$$\\operatorname{LR}_{\\mathrm{LDH}}(x) = \\frac{f_{\\mathrm{W}}(x)}{f_{\\neg \\mathrm{W}}(x)}$$\n其中\n$$f_{\\mathrm{W}}(x) = \\frac{1}{\\sigma_{\\mathrm{W}} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\mu_{\\mathrm{W}})^2}{2\\sigma_{\\mathrm{W}}^2}\\right)$$\n参数为 $\\mu_{\\mathrm{W}} = 420$ U/L 和 $\\sigma_{\\mathrm{W}} = 60$ U/L。\n以及\n$$f_{\\neg \\mathrm{W}}(x) = \\frac{1}{\\sigma_{\\neg \\mathrm{W}} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\mu_{\\neg \\mathrm{W}})^2}{2\\sigma_{\\neg \\mathrm{W}}^2}\\right)$$\n参数为 $\\mu_{\\neg \\mathrm{W}} = 360$ U/L 和 $\\sigma_{\\neg \\mathrm{W}} = 70$ U/L。\n\n**3. 计算后验赔率, $O(H \\mid D)$**\n通过将先验赔率乘以总似然比，可以得到后验赔率：\n$$O(H \\mid D) = O(H) \\times \\operatorname{LR}_{\\text{total}}$$\n\n**4. 将后验赔率转换为后验概率, $P(H \\mid D)$**\n最后，使用以下关系将后验赔率转换回概率：\n$$P(H \\mid D) = \\frac{O(H \\mid D)}{1 + O(H \\mid D)}$$\n然后将所得概率四舍五入到六位小数，以符合要求。\n\n此程序将系统地应用于所提供的五个测试用例中的每一个。例如，对于病例1（$a=3.5$ 等），步骤将是：\n- $a=3.5 \\implies P(H) = 0.85 \\implies O(H) = \\frac{0.85}{1-0.85} = \\frac{17}{3}$。\n- $\\operatorname{LR}_{\\text{total}} = 3.5 \\times 1.8 \\times 4.0 \\times 2.2 \\times 1.5 \\times \\operatorname{LR}_{\\text{LDH}}(480)$。\n- 计算 $\\operatorname{LR}_{\\text{LDH}}(480) = \\frac{f_{\\mathrm{W}}(480)}{f_{\\neg \\mathrm{W}}(480)}$。\n- 将这些组合起来得到 $O(H|D)$，然后得到 $P(H|D)$。\n实现过程将把此逻辑形式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\n#\n# Execution Environment:\n# language: Python\n# version: 3.12\n# libraries:\n#     - name: numpy, version: 1.23.5\n#     - name: scipy, version: 1.11.4\n#\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian inference problem for estimating Wilms tumor probability.\n    \"\"\"\n\n    # Define the likelihood ratios for categorical evidence from the problem statement.\n    LR_MAP = {\n        'origin': {'present': 3.5, 'absent': 0.3},\n        'calcifications': {'present': 0.4, 'absent': 1.8},\n        'thrombus': {'present': 4.0, 'absent': 0.8},\n        'hematuria': {'present': 2.2, 'absent': 0.9},\n        'catecholamines': {'elevated': 0.1, 'normal': 1.5}\n    }\n\n    # Define the parameters for the normal distributions of LDH levels.\n    LDH_PARAMS = {\n        'W': {'mu': 420.0, 'sigma': 60.0},\n        'not_W': {'mu': 360.0, 'sigma': 70.0}\n    }\n\n    def get_prior_prob(age: float) - float:\n        \"\"\"\n        Calculates the age-based prior probability of Wilms tumor.\n        \"\"\"\n        if 0.0 = age  1.0:\n            return 0.65\n        elif 1.0 = age  2.0:\n            return 0.75\n        elif 2.0 = age  6.0:\n            return 0.85\n        elif 6.0 = age  10.0:\n            return 0.55\n        else:  # age = 10.0\n            return 0.20\n\n    def calculate_ldh_lr(ldh_value: float) - float:\n        \"\"\"\n        Calculates the likelihood ratio for a given LDH value.\n        \"\"\"\n        mu_W, sigma_W = LDH_PARAMS['W']['mu'], LDH_PARAMS['W']['sigma']\n        mu_not_W, sigma_not_W = LDH_PARAMS['not_W']['mu'], LDH_PARAMS['not_W']['sigma']\n        \n        pdf_W = norm.pdf(ldh_value, loc=mu_W, scale=sigma_W)\n        pdf_not_W = norm.pdf(ldh_value, loc=mu_not_W, scale=sigma_not_W)\n        \n        # In the unlikely event pdf_not_W is zero (or underflows),\n        # evidence for W is overwhelming. Return a very large number.\n        if pdf_not_W == 0.0:\n            return 1e12 \n            \n        return pdf_W / pdf_not_W\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'age': 3.5, 'origin': 'present', 'calc': 'absent', 'thrombus': 'present', 'hematuria': 'present', 'cat': 'normal', 'ldh': 480.0},\n        {'age': 0.8, 'origin': 'absent', 'calc': 'present', 'thrombus': 'absent', 'hematuria': 'absent', 'cat': 'elevated', 'ldh': 330.0},\n        {'age': 7.0, 'origin': 'present', 'calc': 'absent', 'thrombus': 'absent', 'hematuria': 'present', 'cat': 'normal', 'ldh': 410.0},\n        {'age': 11.0, 'origin': 'present', 'calc': 'absent', 'thrombus': 'present', 'hematuria': 'absent', 'cat': 'normal', 'ldh': 450.0},\n        {'age': 2.5, 'origin': 'absent', 'calc': 'present', 'thrombus': 'absent', 'hematuria': 'absent', 'cat': 'elevated', 'ldh': 420.0}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Step 1: Calculate prior odds from age-based prior probability\n        prior_prob = get_prior_prob(case['age'])\n        # Handle the edge case where prior_prob could be 1, though not in this problem's data\n        if prior_prob == 1.0:\n            prior_odds = np.inf\n        else:\n            prior_odds = prior_prob / (1.0 - prior_prob)\n\n        # Step 2: Calculate the total likelihood ratio\n        lr_origin = LR_MAP['origin'][case['origin']]\n        lr_calc = LR_MAP['calcifications'][case['calc']]\n        lr_thrombus = LR_MAP['thrombus'][case['thrombus']]\n        lr_hematuria = LR_MAP['hematuria'][case['hematuria']]\n        lr_cat = LR_MAP['catecholamines'][case['cat']]\n        lr_ldh = calculate_ldh_lr(case['ldh'])\n        \n        total_lr = lr_origin * lr_calc * lr_thrombus * lr_hematuria * lr_cat * lr_ldh\n        \n        # Step 3: Compute posterior odds\n        posterior_odds = prior_odds * total_lr\n        \n        # Step 4: Convert posterior odds to posterior probability\n        posterior_prob = posterior_odds / (1.0 + posterior_odds)\n        \n        results.append(f\"{posterior_prob:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "5218770"}]}