{"hands_on_practices": [{"introduction": "在实施任何大规模筛查计划之前，我们必须从根本上理解其在真实世界人群中的表现。本练习将指导您从第一性原理出发，仅使用灵敏度、特异性和疾病患病率等核心概念，来推导阳性预测值（$PPV$）和阴性预测值（$NPV$）。这项实践不仅能加深您对贝叶斯定理在临床诊断中应用的理解，还能训练您估算后续诊断资源（如结肠镜检查）需求的关键技能 ([@problem_id:5100250])。", "problem": "一个卫生系统计划使用粪便免疫化学检测（FIT）开展一项基于人群的结直肠癌筛查项目。请使用概率定律，从第一性原理出发定义事件并推导相关量。假设一名接受筛查的个体或者患有筛查相关的结直肠癌（疾病），或者没有。令 $D$ 表示事件“个体患有疾病”，$T^{+}$ 表示事件“FIT检测结果为阳性”。该筛查测试的特征由灵敏度 $Se = \\mathbb{P}(T^{+} \\mid D)$、特异度 $Sp = \\mathbb{P}(T^{-} \\mid D^{c})$ 以及筛查人群中的基线疾病患病率 $p = \\mathbb{P}(D)$ 描述。请仅使用灵敏度、特异度和患病率的形式化定义，并结合贝叶斯定理，推导阳性预测值（PPV）$= \\mathbb{P}(D \\mid T^{+})$ 和阴性预测值（NPV）$= \\mathbb{P}(D^{c} \\mid T^{-})$ 关于 $Se$、$Sp$ 和 $p$ 的解析表达式。该项目将所有FIT检测结果为阳性者转诊进行诊断性结肠镜检查。假设所有被转诊的个体都接受结肠镜检查，请确定对于规模为 $N$ 的筛查人群，预期的结肠镜检查量，并将其表示为 $Se$、$Sp$、$p$ 和 $N$ 的解析函数。\n\n然后，使用以下科学上合理的参数计算这些表达式的值：$Se = 0.74$，$Sp = 0.95$，$p = 0.004$，$N = 200000$。将 $PPV$ 和 $NPV$ 的值四舍五入到四位有效数字。将预期的结肠镜检查量报告为精确整数。概率以小数形式表示，而非百分比。", "solution": "该问题要求推导与结直肠癌筛查项目相关的三个量：阳性预测值（$PPV$）、阴性预测值（$NPV$）和预期的结肠镜检查量。这些量将用测试的灵敏度（$Se$）、特异度（$Sp$）和疾病患病率（$p$）来表示。\n\n令 $D$ 为被筛查个体患有该疾病的事件，令 $D^c$ 为其互补事件，即该个体未患病。令 $T^{+}$ 为测试结果为阳性的事件， $T^{-}$ 为测试结果为阴性的事件。\n\n给定的参数被定义为条件概率：\n灵敏度: $Se = \\mathbb{P}(T^{+} \\mid D)$\n特异度: $Sp = \\mathbb{P}(T^{-} \\mid D^{c})$\n患病率: $p = \\mathbb{P}(D)$\n\n根据患病率的定义，未患病的概率为 $\\mathbb{P}(D^{c}) = 1 - \\mathbb{P}(D) = 1 - p$。\n\n此外，根据灵敏度和特异度的定义，我们可以推导出每种疾病状态下互补测试结果的概率：\n假阴性率为 $\\mathbb{P}(T^{-} \\mid D) = 1 - \\mathbb{P}(T^{+} \\mid D) = 1 - Se$。\n假阳性率为 $\\mathbb{P}(T^{+} \\mid D^{c}) = 1 - \\mathbb{P}(T^{-} \\mid D^{c}) = 1 - Sp$。\n\n**1. 阳性预测值（$PPV$）的推导**\n\n$PPV$ 定义为测试结果为阳性的个体确实患有该疾病的概率，即 $PPV = \\mathbb{P}(D \\mid T^{+})$。我们使用贝叶斯定理来表示这个量：\n\n$$ PPV = \\mathbb{P}(D \\mid T^{+}) = \\frac{\\mathbb{P}(T^{+} \\mid D) \\mathbb{P}(D)}{\\mathbb{P}(T^{+})} $$\n\n分子包含给定的量：$\\mathbb{P}(T^{+} \\mid D) = Se$ 和 $\\mathbb{P}(D) = p$。\n分母 $\\mathbb{P}(T^{+})$ 是测试结果为阳性的总概率。我们可以使用全概率定律，基于划分 $\\{D, D^c\\}$ 将其展开：\n\n$$ \\mathbb{P}(T^{+}) = \\mathbb{P}(T^{+} \\mid D)\\mathbb{P}(D) + \\mathbb{P}(T^{+} \\mid D^{c})\\mathbb{P}(D^{c}) $$\n\n代入已知项：\n- $\\mathbb{P}(T^{+} \\mid D) = Se$\n- $\\mathbb{P}(D) = p$\n- $\\mathbb{P}(T^{+} \\mid D^{c}) = 1 - Sp$\n- $\\mathbb{P}(D^{c}) = 1 - p$\n\n$\\mathbb{P}(T^{+})$ 的表达式变为：\n\n$$ \\mathbb{P}(T^{+}) = (Se)(p) + (1 - Sp)(1 - p) $$\n\n将此代回 $PPV$ 的贝叶斯定理公式：\n\n$$ PPV = \\frac{Se \\cdot p}{Se \\cdot p + (1 - Sp)(1 - p)} $$\n\n这就是 $PPV$ 的解析表达式。\n\n**2. 阴性预测值（$NPV$）的推导**\n\n$NPV$ 定义为测试结果为阴性的个体确实无病的概率，即 $NPV = \\mathbb{P}(D^{c} \\mid T^{-})$。我们再次使用贝叶斯定理：\n\n$$ NPV = \\mathbb{P}(D^{c} \\mid T^{-}) = \\frac{\\mathbb{P}(T^{-} \\mid D^{c}) \\mathbb{P}(D^{c})}{\\mathbb{P}(T^{-})} $$\n\n分子项为：$\\mathbb{P}(T^{-} \\mid D^{c}) = Sp$ 和 $\\mathbb{P}(D^{c}) = 1 - p$。\n分母 $\\mathbb{P}(T^{-})$ 是测试结果为阴性的总概率。使用全概率定律：\n\n$$ \\mathbb{P}(T^{-}) = \\mathbb{P}(T^{-} \\mid D)\\mathbb{P}(D) + \\mathbb{P}(T^{-} \\mid D^{c})\\mathbb{P}(D^{c}) $$\n\n代入已知项：\n- $\\mathbb{P}(T^{-} \\mid D) = 1 - Se$\n- $\\mathbb{P}(D) = p$\n- $\\mathbb{P}(T^{-} \\mid D^{c}) = Sp$\n- $\\mathbb{P}(D^{c}) = 1 - p$\n\n$\\mathbb{P}(T^{-})$ 的表达式变为：\n\n$$ \\mathbb{P}(T^{-}) = (1 - Se)(p) + (Sp)(1 - p) $$\n\n将此代回 $NPV$ 的贝叶斯定理公式：\n\n$$ NPV = \\frac{Sp \\cdot (1 - p)}{(1 - Se) \\cdot p + Sp \\cdot (1 - p)} $$\n\n这就是 $NPV$ 的解析表达式。\n\n**3. 预期结肠镜检查量的推导**\n\n问题陈述，所有粪便免疫化学检测（$T^{+}$）结果为阳性的个体都会被转诊进行诊断性结肠镜检查。对于一个规模为 $N$ 的人群，预期测试结果为阳性的个体数量是总人口规模乘以单个个体测试结果为阳性的概率 $\\mathbb{P}(T^{+})$。\n\n令 $V_c$ 表示预期的结肠镜检查量。那么：\n\n$$ V_c = N \\cdot \\mathbb{P}(T^{+}) $$\n\n我们在推导 $PPV$ 的过程中已经得出了 $\\mathbb{P}(T^{+})$ 的表达式。将其代入可得到预期检查量的解析函数：\n\n$$ V_c = N \\left[ Se \\cdot p + (1 - Sp)(1 - p) \\right] $$\n\n**4. 数值计算**\n\n现在我们使用给定的参数计算这些表达式的值：$Se = 0.74$，$Sp = 0.95$，$p = 0.004$，$N = 200000$。\n\n计算 $PPV$：\n$$ PPV = \\frac{0.74 \\cdot 0.004}{0.74 \\cdot 0.004 + (1 - 0.95)(1 - 0.004)} $$\n$$ PPV = \\frac{0.00296}{0.00296 + (0.05)(0.996)} $$\n$$ PPV = \\frac{0.00296}{0.00296 + 0.0498} $$\n$$ PPV = \\frac{0.00296}{0.05276} \\approx 0.056103108... $$\n四舍五入到四位有效数字，$PPV \\approx 0.05610$。\n\n计算 $NPV$：\n$$ NPV = \\frac{0.95 \\cdot (1 - 0.004)}{(1 - 0.74) \\cdot 0.004 + 0.95 \\cdot (1 - 0.004)} $$\n$$ NPV = \\frac{0.95 \\cdot 0.996}{0.26 \\cdot 0.004 + 0.95 \\cdot 0.996} $$\n$$ NPV = \\frac{0.9462}{0.00104 + 0.9462} $$\n$$ NPV = \\frac{0.9462}{0.94724} \\approx 0.99890205... $$\n四舍五入到四位有效数字，$NPV \\approx 0.9989$。\n\n计算预期结肠镜检查量（$V_c$）：\n$$ V_c = 200000 \\left[ 0.74 \\cdot 0.004 + (1 - 0.95)(1 - 0.004) \\right] $$\n$$ V_c = 200000 \\left[ 0.05276 \\right] $$\n$$ V_c = 10552 $$\n预期的结肠镜检查量恰好是 $10552$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.05610 & 0.9989 & 10552 \\end{pmatrix}}$$", "id": "5100250"}, {"introduction": "除了评估测试的预测准确性，衡量一项公共卫生干预措施效率的关键指标是“需筛查人数”（Number Needed to Screen, $NNS$）。这项实践将引导您通过一个简明但有效的模型，计算通过结肠镜筛查预防一例结直肠癌所需的筛查人数。通过整合癌前病变患病率、进展风险、筛查灵敏度和治疗效果等参数，您将学会如何量化筛查项目的整体效益，从而为卫生政策的制定提供有力的数据支持 ([@problem_id:5100206])。", "problem": "在一个正在为结直肠癌（CRC）设计基于人群的结肠镜筛查项目的卫生系统中，决策者希望估算在十年期间内，为预防一例CRC病例所需的筛查人数（NNS）。请使用以下建模框架，该框架从诊断测试性能的核心定义和用于事件预防的期望值推理出发。\n\n假设与定义：\n- 需筛查人数（NNS）定义为在指定时间范围内，每名被筛查者CRC发病率绝对风险降低值的倒数。\n- 敏感性（Se）是结肠镜正确识别出已存在的晚期腺瘤（AA）的概率。\n- 特异性（Sp）是在没有晚期腺瘤的情况下，结肠镜检查结果为阴性的概率。\n- 晚期腺瘤（AA）是一种具有晚期特征的腺瘤性息肉；它是腺瘤-癌变序列中的一个关键前体。\n- 在十年期间内，如果存在AA且未被切除，其进展为CRC的风险为 $r_{AA}$。\n- 如果在结肠镜检查（息肉切除术）期间检测到并切除了AA，息肉切除术预防该病变进展为CRC的效力为 $E$，建模为应用于 $r_{AA}$ 的一个比例风险降低。\n- 由非AA途径产生的背景CRC风险不受筛查-息肉切除过程的影响，因此对归因于AA检测和切除的绝对风险降低没有贡献。\n\n适用于年龄在50-75岁之间的平均风险筛查人群的参数值：\n- 基线时晚期腺瘤的患病率：$p_{AA} = 0.06$。\n- 未治疗的晚期腺瘤在十年内进展为CRC的风险：$r_{AA} = 0.08$。\n- 结肠镜对晚期腺瘤的敏感性：$Se = 0.95$。\n- 结肠镜对晚期腺瘤的特异性：$Sp = 0.86$。\n- 息肉切除术预防已检出晚期腺瘤进展的效力：$E = 0.90$。\n\n仅使用上述原则，计算在十年内为预防一例CRC病例所需进行的结肠镜筛查人数。将最终答案表示为纯数字（无单位）。将答案四舍五入到三位有效数字。", "solution": "该问题要求基于一组给定的定义和参数，计算在十年期间内为预防一例结直肠癌（CRC）所需的筛查人数（NNS）。\n\n需筛查人数（NNS）定义为绝对风险降低（ARR）的倒数：\n$$\nNNS = \\frac{1}{ARR}\n$$\nARR是在指定的十年期间内，未筛查个体患CRC的风险（$R_{unscreened}$）与筛查个体患CRC的风险（$R_{screened}$）之间的差值。问题明确指出，只有归因于AA途径的风险才对ARR有贡献。\n$$\nARR = R_{unscreened} - R_{screened}\n$$\n我们现在来推导 $R_{unscreened}$ 和 $R_{screened}$ 的表达式。\n\n首先，我们计算未筛查人群中个体的风险，$R_{unscreened}$。一个未筛查的个体仅在他们患有AA且其进展为CRC时，才会从AA途径发展为CRC。这一系列事件的概率是AA患病率 $p_{AA}$ 与进展的条件概率 $r_{AA}$ 的乘积。\n$$\nR_{unscreened} = p_{AA} \\times r_{AA}\n$$\n接下来，我们计算筛查人群中个体的风险，$R_{screened}$。我们考虑一个患有AA的个体，其发生的概率为 $p_{AA}$。该个体接受结肠镜检查。关于AA，可能出现两种互斥的结果：\n1.  AA被检测到（真阳性事件）。这发生的概率等于敏感性 $Se$。检测到的AA随后通过息肉切除术被切除，其效力为 $E$。效力是一个比例风险降低，因此该被切除病变进展为CRC的残余风险是 $r_{AA} \\times (1 - E)$。一个个体患有AA、被检测到且仍然进展为CRC的总概率是 $p_{AA} \\times Se \\times r_{AA} \\times (1 - E)$。\n2.  AA被结肠镜漏诊（假阴性事件）。这发生的概率为 $1 - Se$。由于AA未被检测或切除，它带有完全的进展风险 $r_{AA}$。一个个体患有AA、被漏诊，然后进展为CRC的总概率是 $p_{AA} \\times (1 - Se) \\times r_{AA}$。\n\n筛查个体的总风险 $R_{screened}$ 是这两条导致CRC的途径的概率之和。\n$$\nR_{screened} = \\left( p_{AA} \\times Se \\times r_{AA} \\times (1 - E) \\right) + \\left( p_{AA} \\times (1 - Se) \\times r_{AA} \\right)\n$$\n我们可以提取公因式 $p_{AA}$ 和 $r_{AA}$：\n$$\nR_{screened} = p_{AA} \\times r_{AA} \\times [Se \\times (1 - E) + (1 - Se)]\n$$\n简化括号内的表达式：\n$$\nR_{screened} = p_{AA} \\times r_{AA} \\times [Se - Se \\cdot E + 1 - Se]\n$$\n$$\nR_{screened} = p_{AA} \\times r_{AA} \\times (1 - Se \\cdot E)\n$$\n现在我们可以计算绝对风险降低（ARR）：\n$$\nARR = R_{unscreened} - R_{screened}\n$$\n$$\nARR = (p_{AA} \\times r_{AA}) - (p_{AA} \\times r_{AA} \\times (1 - Se \\cdot E))\n$$\n提取公因式 $p_{AA} \\times r_{AA}$：\n$$\nARR = p_{AA} \\times r_{AA} \\times [1 - (1 - Se \\cdot E)]\n$$\n$$\nARR = p_{AA} \\times r_{AA} \\times [1 - 1 + Se \\cdot E]\n$$\n$$\nARR = p_{AA} \\times r_{AA} \\times Se \\times E\n$$\n这个结果很直观：总风险降低是因果链中每个必要步骤概率的乘积：存在前体（$p_{AA}$）、其注定会进展（$r_{AA}$）、检测到它（$Se$）以及通过治疗成功阻止其进展（$E$）。\n\n现在我们可以写出NNS的表达式：\n$$\nNNS = \\frac{1}{ARR} = \\frac{1}{p_{AA} \\times r_{AA} \\times Se \\times E}\n$$\n我们将给定的数值代入此表达式：\n-   $p_{AA} = 0.06$\n-   $r_{AA} = 0.08$\n-   $Se = 0.95$\n-   $E = 0.90$\n\n$$\nNNS = \\frac{1}{0.06 \\times 0.08 \\times 0.95 \\times 0.90}\n$$\n首先，我们计算分母（即ARR）：\n$$\nARR = 0.06 \\times 0.08 \\times 0.95 \\times 0.90\n$$\n$$\nARR = 0.0048 \\times 0.855\n$$\n$$\nARR = 0.004104\n$$\n现在，我们计算NNS：\n$$\nNNS = \\frac{1}{0.004104} \\approx 243.664717\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nNNS \\approx 244\n$$\n因此，根据此模型，在十年期间内，大约需要对 $244$ 人进行结肠镜筛查才能预防一例结直肠癌。", "answer": "$$\\boxed{244}$$", "id": "5100206"}, {"introduction": "标准化的筛查方案无法满足所有个体的需求，个体化策略是现代医学的发展方向。本练习将带领您进入风险分层监测的领域，运用生存分析中的核心工具——比例风险模型，来量化为何高风险个体需要更短的筛查间隔。通过推导一个旨在均衡不同风险群体间累积患病风险的监测周期，您将深刻理解风险适应性筛查指南背后的数学原理 ([@problem_id:5100186])。", "problem": "一个外科肿瘤科正在设计一种结直肠癌（CRC）监测方案，旨在使高风险和平均风险成年人在两次结肠镜检查之间发生晚期结直肠肿瘤的累积概率相等。考虑以下假设，这些假设在事件时间分析和筛查策略建模中被广泛用作基础：\n\n1) 在高质量清除性结肠镜检查后，在时间 $t$ 发生晚期结直肠肿瘤的风险函数 $h(t)$ 是指在之前未发生事件的条件下，瞬时事件率。\n\n2) 生存函数为 $S(t) = \\exp\\!\\big(-H(t)\\big)$，其中 $H(t) = \\int_{0}^{t} h(s)\\,ds$ 是累积风险。\n\n3) 在比例风险框架下，如果某项暴露使基线风险乘以一个恒定的风险比（HR），那么暴露后的风险为 $h_{\\text{exp}}(t) = \\text{HR} \\cdot h_{0}(t)$，其中 $h_{0}(t)$ 是平均风险成年人的基线风险，且 $\\text{HR} > 1$ 表示风险增加。\n\n4) 在单个结肠镜检查间隔内，将基线风险近似为常数是合理的，即 $h_{0}(t) \\approx \\lambda_{0}$，这反映了在两次完全清除性检查之间，风险局部稳定。清除肿瘤的结肠镜检查会在术后立即将过程重置为基线水平。\n\n假设目前的指南建议平均风险成年人在一次阴性的高质量结肠镜检查后，采用 $T_{0} = 10$ 年的结肠镜检查间隔。观察性队列数据显示，在比例风险框架下，有一位在 60 岁前被诊断患有 CRC 的一级亲属（FDR），会使发生晚期肿瘤的风险比恒定为 $\\text{HR} = 2.6$。\n\n仅使用上述假设以及风险和生存函数的基本原理，推导该一级亲属阳性个体的结肠镜检查间隔 $T^{\\ast}$，使得其在下一次检查前发生晚期结直肠肿瘤的累积概率，与每 $T_{0} = 10$ 年筛查一次的平均风险成年人相等。请将最终答案表示为一个以年为单位的数字，并四舍五入到三位有效数字。", "solution": "我们的目标是找到高风险个体（即有一位在 60 岁前被诊断患有结直肠癌的一级亲属）的检查间隔 $T^{\\ast}$，使得其在下一次检查前发生晚期结直肠肿瘤的累积概率，与使用 $T_{0} = 10$ 年间隔的平均风险成年人相等。\n\n从基本定义开始。生存函数为 $S(t) = \\exp\\!\\big(-H(t)\\big)$，其中累积风险为 $H(t) = \\int_{0}^{t} h(s)\\,ds$。到时间 $t$ 为止的累积发生率为 $F(t) = 1 - S(t) = 1 - \\exp\\!\\big(-H(t)\\big)$。\n\n对于平均风险个体，用 $h_{0}(t)$ 表示基线风险，用 $H_{0}(t) = \\int_{0}^{t} h_{0}(s)\\,ds$ 表示在时间 $t$ 内的相应累积风险。根据所述的基线风险在结肠镜检查之间近似恒定的假设，我们写作 $h_{0}(t) \\approx \\lambda_{0}$，因此\n\n$$\nH_{0}(t) \\approx \\int_{0}^{t} \\lambda_{0}\\,ds = \\lambda_{0} t.\n$$\n\n因此，平均风险个体在 $T_{0}$ 年内的生存率为\n\n$$\nS_{0}(T_{0}) = \\exp\\!\\big(-H_{0}(T_{0})\\big) = \\exp\\!\\big(-\\lambda_{0} T_{0}\\big),\n$$\n\n而相应的累积发生率为\n\n$$\nF_{0}(T_{0}) = 1 - S_{0}(T_{0}) = 1 - \\exp\\!\\big(-\\lambda_{0} T_{0}\\big).\n$$\n\n\n对于有一位在 60 岁前被诊断患病的一级亲属的高风险个体，我们使用比例风险结构，其恒定风险比为 $\\text{HR} = 2.6$。其风险变为 $h_{1}(t) = \\text{HR} \\cdot h_{0}(t) \\approx \\text{HR} \\cdot \\lambda_{0}$，在时间 $t$ 内的累积风险为\n\n$$\nH_{1}(t) = \\int_{0}^{t} h_{1}(s)\\,ds \\approx \\int_{0}^{t} \\text{HR} \\cdot \\lambda_{0}\\,ds = \\text{HR} \\cdot \\lambda_{0} t.\n$$\n\n因此，在时间 $t$ 的生存函数是\n\n$$\nS_{1}(t) = \\exp\\!\\big(-H_{1}(t)\\big) = \\exp\\!\\big(-\\text{HR} \\cdot \\lambda_{0} t\\big),\n$$\n\n到时间 $t$ 为止的累积发生率是\n\n$$\nF_{1}(t) = 1 - S_{1}(t) = 1 - \\exp\\!\\big(-\\text{HR} \\cdot \\lambda_{0} t\\big).\n$$\n\n\n我们要找到 $T^{\\ast}$，使得高风险个体到 $T^{\\ast}$ 为止的累积发生率等于平均风险个体到 $T_{0}$ 为止的累积发生率：\n\n$$\nF_{1}(T^{\\ast}) = F_{0}(T_{0}).\n$$\n\n代入上面推导出的表达式：\n\n$$\n1 - \\exp\\!\\big(-\\text{HR} \\cdot \\lambda_{0} T^{\\ast}\\big) = 1 - \\exp\\!\\big(-\\lambda_{0} T_{0}\\big).\n$$\n\n消去两边的 $1$ 并使指数相等：\n\n$$\n\\exp\\!\\big(-\\text{HR} \\cdot \\lambda_{0} T^{\\ast}\\big) = \\exp\\!\\big(-\\lambda_{0} T_{0}\\big).\n$$\n\n对两边取自然对数：\n\n$$\n-\\text{HR} \\cdot \\lambda_{0} T^{\\ast} = -\\lambda_{0} T_{0}.\n$$\n\n假设 $\\lambda_{0} > 0$，两边同时除以 $\\lambda_{0}$：\n\n$$\n-\\text{HR} \\cdot T^{\\ast} = -T_{0}.\n$$\n\n两边乘以 $-1$：\n\n$$\n\\text{HR} \\cdot T^{\\ast} = T_{0}.\n$$\n\n解出 $T^{\\ast}$：\n\n$$\nT^{\\ast} = \\frac{T_{0}}{\\text{HR}}.\n$$\n\n\n代入给定值 $T_{0} = 10$ 和 $\\text{HR} = 2.6$：\n\n$$\nT^{\\ast} = \\frac{10}{2.6} \\approx 3.846153846\\ldots\n$$\n\n\n按要求四舍五入到三位有效数字：\n\n$$\nT^{\\ast} \\approx 3.85.\n$$\n\n\n因此，在所述假设下，大约 $3.85$ 年的结肠镜检查间隔，可以使发生晚期结直肠肿瘤的累积概率与每 10 年接受一次结肠镜检查的平均风险成年人相等。", "answer": "$$\\boxed{3.85}$$", "id": "5100186"}]}