{"hands_on_practices": [{"introduction": "在急性期，快速而准确的风险评估至关重要。本练习将演示如何运用贝叶斯定理（循证诊断的基石）来正式更新您的临床判断。通过将CT扫描发现的似然比应用于检验前概率，您将练习量化如穿孔等关键事件的检验后概率，这直接为急诊手术决策提供信息 [@problem_id:5134425]。", "problem": "一名患者因左下腹痛和白细胞增多就诊，临床怀疑患有结肠憩室炎。在进行影像学检查之前，一项多学科风险分层（结合了临床严重程度、血流动力学和实验室指标）估计，需要手术治疗的穿孔的检验前概率为 $0.15$（以小数表示）。随后进行了计算机断层扫描 (CT)，结果显示存在腹腔内游离气体。对于“需要手术的穿孔”这一假设，该CT发现的诊断性能的特点是其阳性似然比 ($LR_{+}$) 为 $8$。\n\n从贝叶斯定理的基本定义、概率与优势比之间的关系出发，并使用以条件概率表示的阳性似然比的定义，推导在观察到CT上的游离气体后，“需要手术的穿孔”的检验后概率的解析表达式。然后，使用给定的 $LR_{+}$ 和检验前概率 $0.15$ 来计算该表达式的值。\n\n将最终概率表示为小数，并将您的答案四舍五入到 $4$ 位有效数字。不要使用百分号。", "solution": "该问题是有效的，因为它在科学上基于概率论和医学诊断学，问题陈述清晰且信息充分，足以得出一个唯一解，并且陈述客观。\n\n令 $H$ 表示患者“需要手术的穿孔”的假设，令 $E$ 表示证据，即“在CT上观察到腹腔内游离气体”。\n\n已知条件如下：\n- 假设的检验前概率，$P(H)$，为 $0.15$。\n- 与证据 $E$ 相关的假设 $H$ 的阳性似然比，$LR_{+}$，为 $8$。\n\n目标是推导检验后概率 $P(H|E)$ 的解析表达式，然后计算其数值。推导过程将如题目要求，从基本定义开始。\n\n概率 $p$ 和优势比 $O$ 之间的关系由下式给出：\n$$ O = \\frac{p}{1-p} $$\n反之，概率可以用优势比表示：\n$$ p = \\frac{O}{1+O} $$\n\n检验前优势比 $O_{pre}$，是在观察到证据 $E$ 之前假设 $H$ 为真的优势比。\n$$ O_{pre} = \\frac{P(H)}{P(\\neg H)} = \\frac{P(H)}{1-P(H)} $$\n其中 $P(\\neg H)$ 是假设 $H$ 为假的概率。\n\n检验后优势比 $O_{post}$，是在观察到证据 $E$ 之后假设 $H$ 为真的优势比。\n$$ O_{post} = \\frac{P(H|E)}{P(\\neg H|E)} $$\n\n根据贝叶斯定理，$H$ 和 $\\neg H$ 的检验后概率为：\n$$ P(H|E) = \\frac{P(E|H) P(H)}{P(E)} $$\n$$ P(\\neg H|E) = \\frac{P(E|\\neg H) P(\\neg H)}{P(E)} $$\n通过计算这两个表达式的比值，我们可以表示出检验后优势比：\n$$ O_{post} = \\frac{P(H|E)}{P(\\neg H|E)} = \\frac{P(E|H) P(H) / P(E)}{P(E|\\neg H) P(\\neg H) / P(E)} = \\left(\\frac{P(E|H)}{P(E|\\neg H)}\\right) \\left(\\frac{P(H)}{P(\\neg H)}\\right) $$\n该乘积中的第一项是阳性似然比 $LR_{+}$ 的定义。第二项是检验前优势比 $O_{pre}$。\n$$ LR_{+} = \\frac{P(E|H)}{P(E|\\neg H)} $$\n因此，我们得到了基本关系式：\n$$ O_{post} = LR_{+} \\times O_{pre} $$\n\n为了求得检验后概率 $P(H|E)$，我们首先用检验前概率 $p_{pre} = P(H)$ 和给定的 $LR_{+}$ 来表示检验后优势比。\n$$ O_{post} = LR_{+} \\times \\frac{p_{pre}}{1-p_{pre}} $$\n接下来，我们将检验后优势比转换回概率，记为 $p_{post} = P(H|E)$。\n$$ p_{post} = \\frac{O_{post}}{1+O_{post}} $$\n代入 $O_{post}$ 的表达式，我们得到所要求的检验后概率的解析表达式：\n$$ p_{post} = \\frac{LR_{+} \\times \\frac{p_{pre}}{1-p_{pre}}}{1 + LR_{+} \\times \\frac{p_{pre}}{1-p_{pre}}} $$\n这是在给定阳性发现及其相关的似然比后，更新概率的通用公式。\n\n现在，我们使用给定的值 $p_{pre} = 0.15$ 和 $LR_{+} = 8$ 来计算这个表达式。\n\n首先，我们计算检验前优势比：\n$$ O_{pre} = \\frac{0.15}{1 - 0.15} = \\frac{0.15}{0.85} = \\frac{15}{85} = \\frac{3}{17} $$\n\n接下来，我们使用似然比计算检验后优势比：\n$$ O_{post} = LR_{+} \\times O_{pre} = 8 \\times \\frac{3}{17} = \\frac{24}{17} $$\n\n最后，我们将检验后优势比转换回概率：\n$$ p_{post} = P(H|E) = \\frac{O_{post}}{1+O_{post}} = \\frac{\\frac{24}{17}}{1 + \\frac{24}{17}} = \\frac{\\frac{24}{17}}{\\frac{17}{17} + \\frac{24}{17}} = \\frac{\\frac{24}{17}}{\\frac{41}{17}} = \\frac{24}{41} $$\n\n为了得到最终的数值答案，我们计算这个分数的值，并将其四舍五入到 $4$ 位有效数字。\n$$ \\frac{24}{41} \\approx 0.58536585... $$\n四舍五入到 $4$ 位有效数字得到 $0.5854$。\n在CT上观察到游离气体后，“需要手术的穿孔”的检验后概率约为 $0.5854$。", "answer": "$$\\boxed{0.5854}$$", "id": "5134425"}, {"introduction": "复杂性憩室炎的决策通常涉及综合多个风险因素。这个实践问题引入了一个量化模型，该模型根据脓肿大小和患者合并症来预测非手术治疗的成功率。您将学习如何使用此类模型来计算群体层面的预期结局以及针对特定患者的手术干预风险阈值 [@problem_id:5134455]。", "problem": "一个外科团队采用初期非手术治疗（静脉注射抗生素联合或不联合经皮引流）来管理患有 Hinchey Ib–II 型憩室脓肿的成年患者，而早期手术干预则保留给那些治疗失败风险高的患者。假设以下与乘性风险聚合一致的经验模型：对于一名脓肿最大直径为 $s$（单位：$\\mathrm{cm}$）、整数合并症计数为 $c$（代表加权合并症条件的数量，近似于 Charlson 合并症指数结构）的患者，其非手术治疗成功的概率为\n$$\nP_{\\mathrm{succ}}(s,c)=\\exp\\!\\left(-\\lambda_{s}\\,s-\\lambda_{c}\\,c\\right),\n$$\n其中 $\\lambda_{s}0$ 和 $\\lambda_{c}0$ 分别捕捉了脓肿大小和合并症负担对非手术治疗成功率的边际负面影响。在一个当代队列中，假设脓肿大小 $S$ 与合并症计数 $C$ 相互独立，其中 $S\\sim \\mathrm{Exponential}(k_{s})$（率参数为 $k_{s}$，单位：$\\mathrm{cm}^{-1}$），且 $C\\sim \\mathrm{Poisson}(\\mu_{c})$（均值为 $\\mu_{c}$）。为了决策，将预测失败概率定义为 $P_{\\mathrm{fail}}(s,c)=1-P_{\\mathrm{succ}}(s,c)$。该医疗服务部门采纳一项策略，即当预测的失败概率超过一个预定义的决策阈值 $T$ 时，便进行早期手术干预。该阈值 $T$ 的选择是为了反映基于当前证据的可接受风险。\n\n使用参数值 $k_{s}=0.25$, $\\mu_{c}=2$, $\\lambda_{s}=0.09$, $\\lambda_{c}=0.27$ 和 $T=0.70$：\n- 计算队列水平的预期非手术治疗成功概率 $\\mathbb{E}[P_{\\mathrm{succ}}(S,C)]$。\n- 对于一个合并症计数固定为 $c^{\\star}=3$ 的患者，确定最小的脓肿直径阈值 $s^{\\star}$（单位：$\\mathrm{cm}$），使得 $P_{\\mathrm{fail}}(s,c^{\\star})\\geq T$。\n\n将您的最终答案表示为一个行向量，其中按顺序包含 $\\big(\\mathbb{E}[P_{\\mathrm{succ}}(S,C)],\\,s^{\\star}\\big)$ 这两个量。将两个条目都四舍五入到4位有效数字。在您的计算过程中，以 $\\mathrm{cm}$ 为单位表示大小阈值 $s^{\\star}$，但在最终的方框答案中不要包含单位。", "solution": "用户提供了一个在临床背景下的应用概率和统计建模领域中定义明确的问题。所有必要的参数和分布都已定义，且该问题具有科学依据并内部一致。因此，它被认为是一个有效的问题。解决方案需要计算两个量：一个队列的期望值和一个特定案例的决策阈值。\n\n第一个任务是计算队列水平的预期非手术成功概率 $\\mathbb{E}[P_{\\mathrm{succ}}(S,C)]$。对于给定的脓肿大小 $s$ 和合并症计数 $c$，成功概率为 $P_{\\mathrm{succ}}(s,c)=\\exp(-\\lambda_{s} s - \\lambda_{c} c)$。这可以分解为 $P_{\\mathrm{succ}}(s,c) = \\exp(-\\lambda_{s} s) \\exp(-\\lambda_{c} c)$。\n脓肿大小的随机变量 $S$ 和合并症计数的随机变量 $C$ 被设定为相互独立。因此，它们的乘积函数的期望是它们各自期望的乘积：\n$$\n\\mathbb{E}[P_{\\mathrm{succ}}(S,C)] = \\mathbb{E}[\\exp(-\\lambda_{s} S) \\exp(-\\lambda_{c} C)] = \\mathbb{E}[\\exp(-\\lambda_{s} S)] \\, \\mathbb{E}[\\exp(-\\lambda_{c} C)]\n$$\n我们分别计算每个期望项。\n\n第一项 $\\mathbb{E}[\\exp(-\\lambda_{s} S)]$ 涉及随机变量 $S \\sim \\mathrm{Exponential}(k_{s})$。这个期望是指数分布的矩生成函数（MGF）的一个应用。随机变量 $X$ 的 MGF 是 $M_X(t) = \\mathbb{E}[\\exp(tX)]$。对于 $S \\sim \\mathrm{Exponential}(k_{s})$，其 MGF 为 $M_S(t) = \\frac{k_{s}}{k_{s}-t}$，定义域为 $t  k_{s}$。我们需要计算它在 $t = -\\lambda_s$ 处的值。因为 $\\lambda_s > 0$ 且 $k_s > 0$，所以条件 $-\\lambda_s  k_s$ 成立。\n$$\n\\mathbb{E}[\\exp(-\\lambda_{s} S)] = M_S(-\\lambda_{s}) = \\frac{k_{s}}{k_{s}-(-\\lambda_{s})} = \\frac{k_{s}}{k_{s}+\\lambda_{s}}\n$$\n\n第二项 $\\mathbb{E}[\\exp(-\\lambda_{c} C)]$ 涉及随机变量 $C \\sim \\mathrm{Poisson}(\\mu_{c})$。这可以使用泊松分布的 MGF 来计算，其 MGF 为 $M_C(t) = \\exp(\\mu_c(\\exp(t)-1))$。我们计算它在 $t = -\\lambda_c$ 处的值。\n$$\n\\mathbb{E}[\\exp(-\\lambda_{c} C)] = M_C(-\\lambda_{c}) = \\exp(\\mu_c(\\exp(-\\lambda_c)-1))\n$$\n\n结合这两个结果，总的预期成功概率为：\n$$\n\\mathbb{E}[P_{\\mathrm{succ}}(S,C)] = \\left(\\frac{k_{s}}{k_{s}+\\lambda_{s}}\\right) \\exp\\left(\\mu_c(\\exp(-\\lambda_c)-1)\\right)\n$$\n代入给定的参数值 $k_{s}=0.25$, $\\mu_{c}=2$, $\\lambda_{s}=0.09$ 和 $\\lambda_{c}=0.27$：\n$$\n\\mathbb{E}[P_{\\mathrm{succ}}(S,C)] = \\left(\\frac{0.25}{0.25+0.09}\\right) \\exp\\left(2(\\exp(-0.27)-1)\\right) = \\frac{0.25}{0.34} \\exp\\left(2(\\exp(-0.27)-1)\\right)\n$$\n对此表达式进行数值计算：\n$$\n\\mathbb{E}[P_{\\mathrm{succ}}(S,C)] \\approx (0.735294\\dots) \\exp(2(0.763379\\dots - 1)) = (0.735294\\dots) \\exp(-0.473241\\dots) \\approx 0.4580816\\dots\n$$\n四舍五入到4位有效数字，我们得到 $\\mathbb{E}[P_{\\mathrm{succ}}(S,C)] \\approx 0.4581$。\n\n第二个任务是，对于固定的合并症计数 $c^{\\star}=3$ 和决策阈值 $T=0.70$，找到最小的脓肿直径阈值 $s^{\\star}$，使得 $P_{\\mathrm{fail}}(s, c^{\\star}) \\geq T$。\n失败概率为 $P_{\\mathrm{fail}}(s,c)=1-P_{\\mathrm{succ}}(s,c)=1-\\exp(-\\lambda_{s}s-\\lambda_{c}c)$。条件是：\n$$\n1-\\exp(-\\lambda_{s}s - \\lambda_{c}c^{\\star}) \\geq T\n$$\n函数 $P_{\\mathrm{fail}}(s, c^{\\star})$ 是关于 $s$ 的单调递增函数，因为其导数 $\\frac{\\partial P_{\\mathrm{fail}}}{\\partial s} = \\lambda_s \\exp(-\\lambda_s s - \\lambda_c c^{\\star})$ 是严格为正的（因为 $\\lambda_s > 0$）。因此，满足该不等式的最小值 $s^{\\star}$ 就是满足等式 $P_{\\mathrm{fail}}(s^{\\star}, c^{\\star}) = T$ 的值。我们求解 $s^{\\star}$：\n$$\n1-\\exp(-\\lambda_{s}s^{\\star} - \\lambda_{c}c^{\\star}) = T\n$$\n$$\n\\exp(-\\lambda_{s}s^{\\star} - \\lambda_{c}c^{\\star}) = 1 - T\n$$\n对两边取自然对数（因为 $T=0.70  1$，所以这是有效的）：\n$$\n-\\lambda_{s}s^{\\star} - \\lambda_{c}c^{\\star} = \\ln(1-T)\n$$\n求解 $s^{\\star}$：\n$$\n\\lambda_{s}s^{\\star} = -\\lambda_{c}c^{\\star} - \\ln(1-T)\n$$\n$$\ns^{\\star} = \\frac{-\\lambda_{c}c^{\\star} - \\ln(1-T)}{\\lambda_{s}}\n$$\n代入给定的值 $c^{\\star}=3$, $T=0.70$, $\\lambda_s=0.09$ 和 $\\lambda_c=0.27$：\n$$\ns^{\\star} = \\frac{-(0.27)(3) - \\ln(1-0.70)}{0.09} = \\frac{-0.81 - \\ln(0.3)}{0.09}\n$$\n对此表达式进行数值计算：\n$$\ns^{\\star} \\approx \\frac{-0.81 - (-1.2039728\\dots)}{0.09} = \\frac{0.3939728\\dots}{0.09} \\approx 4.3774756\\dots\n$$\n$s^{\\star}$ 的单位是 $\\mathrm{cm}$。四舍五入到4位有效数字，我们得到 $s^{\\star} \\approx 4.377$。\n\n最终答案要求将两个量 $\\mathbb{E}[P_{\\mathrm{succ}}(S,C)]$ 和 $s^{\\star}$ 表示为一个行向量，并四舍五入到4位有效数字。\n该向量为 $(0.4581, 4.377)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.4581  4.377 \\end{pmatrix}}$$", "id": "5134455"}, {"introduction": "评估择期手术的益处，需要在预防未来事件与手术本身风险之间取得平衡。需治数（Number Needed to Treat, NNT）是此项评估的关键指标。在本练习中，您将计算择期切除术在预防憩室炎复发方面的NNT，从而将年度风险概率转化为一个具体的治疗效率衡量标准 [@problem_id:5134442]。", "problem": "一个外科团队正在为一名复发性憩室病患者评估择期乙状结肠切除术的适应证。假设采用以下基于离散时间事件标准概率的建模框架：对于在该年开始前一直未复发的患者，其在每一年内至少发生一次憩室炎复发的概率是恒定的，并且各年之间相互独立。设 $p$ 表示年复发概率，并假设任何一年内的复发都计为终点事件，因此三年累积风险是在 $3$ 年内至少发生一次复发的概率。\n\n假设基线（非手术）年复发概率为 $p_{0} = 0.30$。在三年的随访期内，择期切除术使得每年的年复发概率恒定比例降低 $80\\%$。在这些假设下，计算需治数 (NNT)。NNT 定义为，在比较择期切除术与非手术治疗时，为预防一名患者在 $3$ 年内经历至少一次复发，其计算方法为三年绝对风险降低值的倒数。\n\n将最终答案四舍五入至四位有效数字。最终答案以无量纲数表示。", "solution": "该问题被评估为有效，因为它在科学上基于概率论和临床流行病学，问题提法严谨，给出的条件完整且一致，并且其表述是客观的。所有用以计算唯一且有意义解的必要数据、定义和条件均已提供。\n\n问题要求计算需治数 (NNT)，其定义为绝对风险降低值 (ARR) 的倒数。而 ARR 是在一个指定时期内，对照组与治疗组之间事件累积风险的差异。在本案例中，事件是憩室炎复发，对照组是非手术治疗，治疗组是择期切除术，时期为 $3$ 年。\n\n设 $p$ 代表每年至少发生一次憩室炎复发的概率，假设患者在该年开始前一直未复发。问题陈述该概率是恒定的，并且各年之间相互独立。\n因此，在单一年份内不复发的概率是 $1-p$。\n由于各年事件的独立性，连续 $3$ 年不复发的概率是 $(1-p)^3$。\n三年累积风险 $R_3(p)$ 是在 $3$ 年内至少经历一次复发的概率。这是“在 $3$ 年内没有复发”这一事件的补集。\n$$R_3(p) = 1 - (1-p)^3$$\n\n我们已知基线（非手术）年复发概率为 $p_0 = 0.30$。非手术治疗组的三年累积风险 $R_0$ 为：\n$$R_0 = R_3(p_0) = 1 - (1 - 0.30)^3$$\n$$R_0 = 1 - (0.70)^3$$\n$$R_0 = 1 - 0.343$$\n$$R_0 = 0.657$$\n\n对于择期切除术组，年复发概率 $p_s$ 从基线概率 $p_0$ 降低了 $80\\%$。\n$$p_s = p_0 \\times (1 - 0.80) = p_0 \\times 0.20$$\n$$p_s = 0.30 \\times 0.20 = 0.06$$\n择期切除术组的三年累积风险 $R_s$ 为：\n$$R_s = R_3(p_s) = 1 - (1 - 0.06)^3$$\n$$R_s = 1 - (0.94)^3$$\n$$R_s = 1 - 0.830584$$\n$$R_s = 0.169416$$\n\n三年绝对风险降低值 (ARR) 是非手术组与切除术组之间的风险差异。\n$$ARR = R_0 - R_s$$\n$$ARR = 0.657 - 0.169416$$\n$$ARR = 0.487584$$\n\n需治数 (NNT) 定义为 ARR 的倒数。\n$$NNT = \\frac{1}{ARR}$$\n$$NNT = \\frac{1}{0.487584}$$\n$$NNT \\approx 2.0509270$$\n\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $2$、$0$、$5$ 和 $0$。第五位有效数字是 $9$，大于或等于 $5$，因此我们将第四位有效数字向上取整。\n$$NNT \\approx 2.051$$\n与非手术治疗相比，该值表示为预防一名患者在 $3$ 年内经历复发，需要接受择期切除术的患者人数。", "answer": "$$\\boxed{2.051}$$", "id": "5134442"}]}