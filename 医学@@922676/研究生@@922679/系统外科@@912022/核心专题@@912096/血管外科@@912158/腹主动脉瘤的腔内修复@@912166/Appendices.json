{"hands_on_practices": [{"introduction": "理解腹主动脉瘤壁所承受的机械应力，对于评估其破裂风险和指导临床决策至关重要。本练习将引导你应用拉普拉斯定律这一生物力学基本原理，来估算瘤壁的环向应力，并促使你批判性地思考该简化模型的局限性[@problem_id:5114552]。通过这个计算，你将更深刻地理解驱动血管腔内修复术（EVAR）的根本力学原因。", "problem": "一名患有腹主动脉瘤（Abdominal Aortic Aneurysm, AAA）的患者正被考虑接受血管内动脉瘤修复术（Endovascular Aneurysm Repair, EVAR）。假设动脉瘤段可局部近似为一个在静态内压作用下的薄壁圆柱形血管。从圆柱形血管段的力学平衡和柯西应力（Cauchy stress）的定义出发，推导周向（环向）壁应力的表达式，该表达式应以内压、内半径和壁厚表示。然后，使用测得的最大动脉瘤直径 $5.5$ 厘米，估计的均匀壁厚 $2$ 毫米，以及平均动脉压（Mean Arterial Pressure, MAP） $100$ 毫米汞柱，计算最大直径处的周向壁应力。单位换算请使用 $1$ 毫米汞柱 $=133.322$ 帕斯卡。将最终应力以兆帕（MPa）为单位表示，并将答案四舍五入至四位有效数字。最后，简要讨论（定性分析，无需数值答案）将薄壁假设应用于异质性 AAA 壁（特别是在存在腔内血栓（Intraluminal Thrombus, ILT）和各向异性壁层成分的情况下）时，至少两个重要的局限性。", "solution": "该问题陈述经评估具有科学依据、提法恰当、客观且完整。它基于应用于标准生物力学近似的连续介质力学基本原理。所提供的数据在临床上是现实的，并且足以得到唯一解。因此，该问题被认为是有效的。\n\n解答过程分为三部分：首先，推导环向应力公式；其次，根据给定参数进行应力的数值计算；第三，对模型的局限性进行定性讨论。\n\n**第一部分：周向（环向）应力的推导**\n\n我们将动脉瘤建模为一个内半径为 $R$、壁厚为 $h$、长度为 $L$ 的薄壁圆柱形压力容器。该血管承受均匀的内部表压 $P$。为了求得周向应力，也称为环向应力（$\\sigma_{\\theta}$），我们分析血管半圆柱段的力学平衡。\n\n考虑沿中心轴纵向切开所得到的半个圆柱体的受力分析图。内压 $P$ 垂直作用于内表面。由此压力产生的合力 $F_P$ 将圆柱体的两半推开。这个力是通过将压力在内表面于切割平面上的投影面积上积分来计算的。投影面积是一个宽度为 $2R$、长度为 $L$ 的矩形。\n\n由压力产生的力由下式给出：\n$$\nF_P = P \\times (\\text{Projected Area}) = P \\times (2R \\times L)\n$$\n\n这个向外的作用力必须与血管壁在切割处的内部张力相平衡。沿圆周方向作用的应力是环向应力 $\\sigma_{\\theta}$。该应力是柯西应力张量的一个分量。假设应力在壁厚上均匀分布（这是薄壁假设的一个关键方面），则总恢复力 $F_{wall}$ 是环向应力与被切割的壁材料横截面积的乘积。切口暴露了两个矩形壁截面，每个截面的面积为 $h \\times L$。\n\n抵抗的壁材料的总面积为：\n$$\nA_{wall} = 2 \\times (h \\times L)\n$$\n\n因此，由壁张力产生的总恢复力为：\n$$\nF_{wall} = \\sigma_{\\theta} \\times A_{wall} = \\sigma_{\\theta} \\times (2hL)\n$$\n\n为使血管段处于静力平衡状态，压力产生的力必须等于壁中的恢复力：\n$$\nF_P = F_{wall}\n$$\n$$\nP \\times (2RL) = \\sigma_{\\theta} \\times (2hL)\n$$\n\n我们可以消去方程两边的项 $2$ 和 $L$：\n$$\nPR = \\sigma_{\\theta}h\n$$\n\n求解环向应力 $\\sigma_{\\theta}$，我们得到所需的表达式，这是拉普拉斯定律（Law of Laplace）在圆柱形薄膜上的一种形式：\n$$\n\\sigma_{\\theta} = \\frac{PR}{h}\n$$\n\n**第二部分：壁应力的数值计算**\n\n给定以下参数：\n最大动脉瘤直径，$D = 5.5$ 厘米。\n壁厚，$h = 2$ 毫米。\n平均动脉压（MAP），$P_{MAP} = 100$ 毫米汞柱。\n换算系数：$1$ 毫米汞柱 $= 133.322$ 帕斯卡。\n\n首先，我们必须将所有给定值转换为一致的国际单位制单位（米，帕斯卡）。\n\n内半径 $R$ 是直径的一半：\n$$\nR = \\frac{D}{2} = \\frac{5.5 \\text{ cm}}{2} = 2.75 \\text{ cm} = 0.0275 \\text{ m}\n$$\n\n壁厚 $h$：\n$$\nh = 2 \\text{ mm} = 0.002 \\text{ m}\n$$\n\n内压 $P$（单位：帕斯卡，Pa），其中 $1$ Pa $= 1$ N/m$^2$：\n$$\nP = 100 \\text{ mmHg} \\times \\frac{133.322 \\text{ Pa}}{1 \\text{ mmHg}} = 13332.2 \\text{ Pa}\n$$\n\n薄壁假设通常在 $R/h > 10$ 时被认为是有效的。在本例中，$R/h = 0.0275 / 0.002 = 13.75$，大于 $10$，因此使用推导出的公式在算术上与问题的前提一致。\n\n现在，我们将这些值代入环向应力公式：\n$$\n\\sigma_{\\theta} = \\frac{P R}{h} = \\frac{(13332.2 \\text{ Pa}) \\times (0.0275 \\text{ m})}{0.002 \\text{ m}}\n$$\n$$\n\\sigma_{\\theta} = \\frac{366.6355 \\text{ Pa} \\cdot \\text{m}}{0.002 \\text{ m}} = 183317.75 \\text{ Pa}\n$$\n\n问题要求最终答案以兆帕（MPa）为单位，其中 $1$ MPa $= 10^6$ Pa。\n$$\n\\sigma_{\\theta} = 183317.75 \\text{ Pa} \\times \\frac{1 \\text{ MPa}}{10^6 \\text{ Pa}} = 0.18331775 \\text{ MPa}\n$$\n\n按要求将结果四舍五入至四位有效数字：\n$$\n\\sigma_{\\theta} \\approx 0.1833 \\text{ MPa}\n$$\n\n**第三部分：模型局限性的讨论**\n\n薄壁假设虽然对于一阶近似很有用，但在应用于病变的腹主动脉瘤（AAA）壁的复杂现实时，具有显著的局限性。\n\n1.  **异质结构与腔内血栓（ILT）：** 该模型假设材料单一、同质且厚度均匀。真实的 AAA 是一个异质结构。至关重要的是，大多数大型 AAA 内部含有一种腔内血栓（ILT），这是一种在内壁上积聚的、由纤维蛋白和血细胞组成的分层多孔生物材料。ILT 的力学性能与主动脉壁本身截然不同。它通常更弱且柔顺性更高。通过占据动脉瘤腔的很大一部分，ILT 改变了其几何形状，更重要的是，改变了应力分布。它可以起到缓冲作用，减少传递到下方血管壁的应力。忽略 ILT 并将结构建模为简单的薄壁会导致对力学环境的错误描述，如果使用相同的内半径，通常会导致峰值壁应力被高估。此外，ILT 本身可以对血管壁产生生物力学和生物化学效应，影响其退化。\n\n2.  **各向异性与非线性材料特性：** 推导过程隐含地假设壁材料是各向同性的（在所有方向上具有相同的力学性能）和线弹性的。主动脉壁是一种生物复合材料，主要由排列成特定方向的弹性蛋白和胶原纤维组成，这使其具有高度的各向异性。它在周向上的刚度显著高于纵向，以承受环向应力。应力-应变关系也是高度非线性的；随着胶原纤维被动员，壁在较高应变下变得更加坚硬。简单的薄壁公式（$\\sigma_\\theta = PR/h$）没有考虑这种各向异性或非线性，导致不准确的应力和应变预测。AAA 的病理过程还涉及弹性蛋白和胶原蛋白的酶促降解，这不仅削弱了血管壁，还以空间不均匀的方式改变了其各向异性特征。这种局部的、异质性的降解会产生应力集中的薄弱点，而这是均匀模型无法捕捉的。精确的应力分析需要先进的本构模型（例如，超弹性各向异性模型）和计算方法，如在患者特定几何模型上进行的有限元分析（Finite Element Analysis, FEA）。", "answer": "$$\n\\boxed{0.1833}\n$$", "id": "5114552"}, {"introduction": "一旦决定实施EVAR，手术的长期成功便取决于支架-移植物能否被牢固地固定在原位。本练习深入探讨了近端锚定区的核心生物力学机制，运用库仑摩擦定律来计算抵抗血流冲击等轴向位移力所需的最小锚定长度[@problem_id:5114518]。这个实践将帮助你掌握确保EVAR稳定性的关键工程设计原则。", "problem": "腹主动脉瘤 (AAA) 的腔内动脉瘤修复 (EVAR) 依赖于支架-移植物与肾下主动脉颈之间的近端密封，以抵抗轴向移位。考虑一个长度为 $L$、周长为 $C$ 的圆柱形密封区，其中支架-移植物对主动脉壁施加均匀的径向接触压力 $p_{r}$。该界面表现出库仑摩擦，其特征在于摩擦系数为 $\\mu$，并且密封必须在设计安全系数 $S$ 下抵抗峰值轴向移位力 $F$。\n\n从库仑摩擦的定义以及接触压力与表面正向力之间的关系出发，根据第一性原理推导出一个表达式，用于计算在安全系数标准下确保轴向机械阻力的最小密封长度 $L_{\\min}$。然后，使用推导出的表达式，计算直径 $D = 24 \\ \\mathrm{mm}$、均匀径向接触压力 $p_{r} = 25 \\ \\mathrm{kPa}$、摩擦系数 $\\mu = 0.25$、峰值轴向力 $F = 4.0 \\ \\mathrm{N}$ 和安全系数 $S = 2.0$ 的肾下主动脉颈的 $L_{\\min}$。以毫米为单位表示最终长度，并将答案四舍五入至三位有效数字。", "solution": "该问题是有效的。它提出了一个有科学依据、定义明确的生物力学问题，可以使用力学的基本原理来解决。所有必要的数据都已提供，目标也已明确定义。\n\n任务是首先推导最小密封长度 $L_{\\min}$ 的表达式，然后根据给定参数计算其值。推导从第一性原理出发。\n\n模型是一个长度为 $L$、直径为 $D$ 的圆柱形密封区。支架-移植物在该区域对主动脉壁施加均匀的径向接触压力 $p_r$。作用在界面上的总正向力 $N$ 是均匀压力 $p_r$ 与接触面積 $A$ 的乘积。\n\n圆柱形表面的接触面积 $A$ 是其周长 $C$ 和长度 $L$ 的乘积。周长由 $C = \\pi D$ 给出。\n$$A = C L = \\pi D L$$\n因此，总正向力 $N$ 为：\n$$N = p_r A = p_r (\\pi D L)$$\n根据库仑摩擦模型，界面可以产生的最大静摩擦力 $F_{fric, max}$ 与总正向力 $N$ 成正比。比例常数是静摩擦系数 $\\mu$。\n$$F_{fric, max} = \\mu N$$\n代入 $N$ 的表达式，我们得到作为密封长度 $L$ 函数的最大阻力：\n$$F_{fric, max} = \\mu (p_r \\pi D L)$$\n问题指定了设计安全系数 $S$。这要求由摩擦提供的机械阻力必须至少是峰值轴向移位力 $F$ 的 $S$ 倍。为了找到最小密封长度 $L_{\\min}$，我们建立一个等式，使得最大摩擦力恰好等于所需的安全移位力。\n$$F_{fric, max} = S F$$\n将 $L = L_{\\min}$ 代入我们的 $F_{fric, max}$ 表达式，我们得到：\n$$\\mu p_r \\pi D L_{\\min} = S F$$\n求解最小密封长度 $L_{\\min}$，我们得到所需的解析表达式：\n$$L_{\\min} = \\frac{S F}{\\mu p_r \\pi D}$$\n这个表达式是根据要求从接触压力和库仑摩擦的第一性原理推导出来的。\n\n接下来，我们使用提供的数据计算 $L_{\\min}$ 的数值。给定的值为：\n直径, $D = 24 \\ \\mathrm{mm}$\n径向接触压力, $p_r = 25 \\ \\mathrm{kPa}$\n摩擦系数, $\\mu = 0.25$\n峰值轴向力, $F = 4.0 \\ \\mathrm{N}$\n安全系数, $S = 2.0$\n\n为确保量纲一致性，所有数值必须转换为一致的单位制，例如 SI 单位制（米、牛顿、帕斯卡）。\n$D = 24 \\ \\mathrm{mm} = 24 \\times 10^{-3} \\ \\mathrm{m}$\n$p_r = 25 \\ \\mathrm{kPa} = 25 \\times 10^3 \\ \\mathrm{Pa} = 25 \\times 10^3 \\ \\mathrm{N/m^2}$\n$F = 4.0 \\ \\mathrm{N}$\n$\\mu = 0.25$\n$S = 2.0$\n\n将这些值代入推导出的 $L_{\\min}$ 表达式中：\n$$L_{\\min} = \\frac{(2.0) (4.0 \\ \\mathrm{N})}{(0.25) (25 \\times 10^3 \\ \\mathrm{N/m^2}) \\pi (24 \\times 10^{-3} \\ \\mathrm{m})}$$\n我们可以通过计算分母中的乘积来简化表达式：\n$$L_{\\min} = \\frac{8.0}{(0.25 \\times 25 \\times 24) \\times \\pi \\times 10^3 \\times 10^{-3}} \\ \\mathrm{m}$$\n$$L_{\\min} = \\frac{8.0}{150 \\pi} \\ \\mathrm{m}$$\n$$L_{\\min} = \\frac{4}{75 \\pi} \\ \\mathrm{m}$$\n现在，我们计算数值：\n$$L_{\\min} \\approx \\frac{4}{75 \\times 3.14159...} \\ \\mathrm{m} \\approx \\frac{4}{235.619...} \\ \\mathrm{m}$$\n$$L_{\\min} \\approx 0.0169765... \\ \\mathrm{m}$$\n问题要求最终长度以毫米表示。要将米转换为毫米，我们乘以 $10^3$：\n$$L_{\\min} \\approx 0.0169765... \\times 1000 \\ \\mathrm{mm} = 16.9765... \\ \\mathrm{mm}$$\n最后，按要求将答案四舍五入至三位有效数字：\n$$L_{\\min} \\approx 17.0 \\ \\mathrm{mm}$$", "answer": "$$\\boxed{17.0}$$", "id": "5114518"}, {"introduction": "真实的血管解剖结构往往比理想的圆柱体更为复杂，例如存在锥度的瘤颈。这项高级练习超越了均一压力的简化假设，旨在模拟锚定区内接触压力的实际分布，而这正是摩擦固定的基础[@problem_id:5114519]。通过编写一个计算模型，你将学习到支架过尺寸（oversizing）和瘤颈锥度（conicity）等因素如何相互作用，共同决定锚定密封的质量和可靠性。", "problem": "在动脉瘤腔内修复术（EVAR）中使用的覆膜支架部署在腹主动脉瘤的近端瘤頸内。为确保密封和固定，覆膜支架对瘤頸施加向外的径向接触压力。将覆膜支架建模为一个轴对称薄壁弹性圆柱壳，其自由（无载荷）半径为 $R_{\\mathrm{s}0}$，厚度为 $t_{\\mathrm{s}}$，材料的杨氏模量为 $E_{\\mathrm{s}}$。将主动脉瘤颈建模为一个锥形的、轴对称的、无摩擦的、径向柔顺的壁，表示为刚度为 $k_{\\mathrm{v}}$（单位径向位移上的压力）的 Winkler 地基。瘤颈的初始半径随轴向位置 $z$ 线性变化，关系为 $R_{\\mathrm{n}}(z) = R_{\\mathrm{ref}} - s z$，其中 $R_{\\mathrm{ref}}$ 是 $z=0$ 处的参考半径，$s \\ge 0$ 是瘤颈锥度（斜率，单位为 $\\mathrm{m}/\\mathrm{m}$），$z \\in [0, L]$ 是沿密封长度 $L$ 的轴向坐标。\n\n使用以下基本关系和定义作为出发点：\n- 均匀外部压力下薄壁圆柱的环向应力：$\\sigma_{\\theta} = - \\dfrac{p r}{t_{\\mathrm{s}}}$，其中 $p$ 是法向接触压力，$r$ 是当前半径，负号表示压缩。\n- 线性弹性环向本构定律：$\\sigma_{\\theta} = E_{\\mathrm{s}} \\epsilon_{\\theta}$，其中环向应变为 $\\epsilon_{\\theta} = \\dfrac{r - R_{\\mathrm{s}0}}{R_{\\mathrm{s}0}}$。\n- 血管的 Winkler 地基关系：$p = k_{\\mathrm{v}} u_{\\mathrm{v}}$，其中 $u_{\\mathrm{v}} = r - R_{\\mathrm{n}}(z)$ 是血管的径向位移。\n- 过扩张率（小数）：$o$ 定义为 $R_{\\mathrm{s}0} = (1 + o) R_{\\mathrm{ref}}$。过扩张率 $o$ 可以为负，表示尺寸不足。\n\n适用于有限元分析（FEA）的轴对称部署的边界与接触条件如下：\n- 无摩擦法向接触：间隙 $g(z) = r(z) - R_{\\mathrm{n}}(z) - u_{\\mathrm{v}}(z)$ 在每个 $z$ 处满足 $g(z) \\ge 0$、$p(z) \\ge 0$ 和 $p(z)\\, g(z) = 0$（互补性），且 $u_{\\mathrm{v}}(z) \\ge 0$。\n- 接触中的运动学相容性：在任何 $p(z) > 0$ 的地方，覆膜支架的半径等于变形后的瘤颈半径，即 $r(z) = R_{\\mathrm{n}}(z) + u_{\\mathrm{v}}(z)$，且覆膜支架的环向应变为 $\\epsilon_{\\theta}(z) = \\dfrac{r(z) - R_{\\mathrm{s}0}}{R_{\\mathrm{s}0}}$。\n- 自由轴向滑动和轴对称性：无切向牵引力和剪切；仅法向接触压力作用；通过固定单个轴向参考点来防止刚体运动，但径向平衡由上述关系决定。\n\n任务：\n1. 从上面列出的基本定律出发，针对每个轴向位置 $z$，在无摩擦轴对称假设和互补性条件下，推导径向接触压力 $p(z)$ 关于 $R_{\\mathrm{ref}}$、$L$、$s$、$E_{\\mathrm{s}}$、$t_{\\mathrm{s}}$、$k_{\\mathrm{v}}$ 和 $o$ 的闭式表达式。清晰地陈述 $p(z)=0$ 的条件。\n2. 实现一个程序，给定以下参数，计算在 $N+1$ 个均匀分布的节点 $z_i = i \\dfrac{L}{N}$（$i=0,1,\\dots,N$）上沿 $z \\in [0,L]$ 的径向接触压力分布 $p(z)$。所有压力以千帕（kPa）为单位表示，并四舍五入到三位小数。\n\n除非明确改变，否则所有测试用例均使用以下参数集：\n- 参考半径: $R_{\\mathrm{ref}} = 0.012\\,\\mathrm{m}$。\n- 覆膜支架厚度: $t_{\\mathrm{s}} = 0.0005\\,\\mathrm{m}$。\n- 覆膜支架杨氏模量: $E_{\\mathrm{s}} = 40 \\times 10^{9}\\,\\mathrm{Pa}$。\n- 血管 Winkler 刚度: $k_{\\mathrm{v}} = 5 \\times 10^{6}\\,\\mathrm{Pa}/\\mathrm{m}$。\n- 密封长度: $L = 0.03\\,\\mathrm{m}$。\n- 离散化: $N = 10$ (即 $11$ 个节点)。\n\n测试套件：\n- 案例1 (理想情况): 过扩张率 $o = 0.10$, 锥度 $s = 0.05\\,\\mathrm{m}/\\mathrm{m}$。\n- 案例2 (边界接触起始): 过扩张率 $o = 0.00$, 锥度 $s = 0.05\\,\\mathrm{m}/\\mathrm{m}$。\n- 案例3 (零锥度): 过扩张率 $o = 0.02$, 锥度 $s = 0.00\\,\\mathrm{m}/\\mathrm{m}$。\n- 案例4 (尺寸不足，无接触): 过扩张率 $o = -0.01$, 锥度 $s = 0.00\\,\\mathrm{m}/\\mathrm{m}$。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。此列表的每个元素对应一个测试用例，并且本身必须是一个包含 $N+1$ 个浮点数的列表，代表以千帕（kPa）为单位、四舍五入到三位小数的压力值 $p(z_i)$。例如：$[[p_{0},p_{1},\\dots,p_{N}],[\\dots],\\dots]$。", "solution": "用户希望我解决一个关于覆膜支架对主动脉瘤颈施加的接触压力的生物力学问题。\n\n### 步骤1：问题推导\n\n目标是推导径向接触压力 $p(z)$ 作为轴向位置 $z$ 的函数的闭式表达式。该模型是轴对称和局部的，这意味着我们可以独立求解每个位置 $z$ 处的压力。\n\n我们首先在一个特定的轴向位置 $z$ 建立控制方程，假设发生接触，即接触压力 $p(z) > 0$。\n\n1.  **覆膜支架力学：** 覆膜支架中的环向应力 $\\sigma_{\\theta}(z)$ 与其材料属性和变形有关。\n    -   弹性材料的本构定律（胡克定律）为 $\\sigma_{\\theta}(z) = E_{\\mathrm{s}} \\epsilon_{\\theta}(z)$，其中 $E_{\\mathrm{s}}$ 是杨氏模量，$\\epsilon_{\\theta}(z)$ 是环向应变。\n    -   环向应变由半径从其自由（无载荷）状态 $R_{\\mathrm{s}0}$ 到其当前（有载荷）状态 $r(z)$ 的变化定义：$\\epsilon_{\\theta}(z) = \\dfrac{r(z) - R_{\\mathrm{s}0}}{R_{\\mathrm{s}0}}$。\n    -   将这些结合起来，得到用半径表示的应力：\n        $$\n        \\sigma_{\\theta}(z) = E_{\\mathrm{s}} \\left( \\frac{r(z) - R_{\\mathrm{s}0}}{R_{\\mathrm{s}0}} \\right) \\quad (1)\n        $$\n\n2.  **薄壁圆柱应力：** 厚度为 $t_{\\mathrm{s}}$、当前半径为 $r(z)$ 的薄壁圆柱在外部压力 $p(z)$ 作用下的环向应力为：\n    $$\n    \\sigma_{\\theta}(z) = - \\frac{p(z) r(z)}{t_{\\mathrm{s}}} \\quad (2)\n    $$\n    负号表示外部压力引起压缩环向应力。\n\n3.  **主动脉瘤颈柔度：** 主动脉瘤颈被建模为 Winkler 地基，其中接触压力 $p(z)$与血管壁的径向位移 $u_{\\mathrm{v}}(z)$ 成正比。\n    -   Winkler 关系为 $p(z) = k_{\\mathrm{v}} u_{\\mathrm{v}}(z)$，其中 $k_{\\mathrm{v}}$ 是血管的 Winkler 刚度。\n    -   假设接触，覆膜支架贴附于血管壁。血管的径向位移是最终加载半径 $r(z)$ 与初始瘤颈半径 $R_{\\mathrm{n}}(z)$ 之差：$u_{\\mathrm{v}}(z) = r(z) - R_{\\mathrm{n}}(z)$。\n    -   将此代入 Winkler 关系可得：\n        $$\n        p(z) = k_{\\mathrm{v}} (r(z) - R_{\\mathrm{n}}(z)) \\quad (3)\n        $$\n\n4.  **方程组：** 我们现在有一个关联两个未知数 $p(z)$ 和 $r(z)$ 的方程组。通过令来自 (1) 和 (2) 的 $\\sigma_{\\theta}(z)$ 的两个表达式相等，我们得到：\n    $$\n    E_{\\mathrm{s}} \\left( \\frac{r(z) - R_{\\mathrm{s}0}}{R_{\\mathrm{s}0}} \\right) = - \\frac{p(z) r(z)}{t_{\\mathrm{s}}} \\quad (4)\n    $$\n    从方程 (3)，我们可以用压力 $p(z)$ 表示当前半径 $r(z)$：\n    $$\n    r(z) = R_{\\mathrm{n}}(z) + \\frac{p(z)}{k_{\\mathrm{v}}} \\quad (5)\n    $$\n\n5.  **压力方程的推导：** 将方程 (5) 代入方程 (4) 消去 $r(z)$，得到一个关于 $p(z)$ 的单一方程：\n    $$\n    E_{\\mathrm{s}} \\left( \\frac{\\left(R_{\\mathrm{n}}(z) + \\frac{p(z)}{k_{\\mathrm{v}}}\\right) - R_{\\mathrm{s}0}}{R_{\\mathrm{s}0}} \\right) = - \\frac{p(z)}{t_{\\mathrm{s}}} \\left( R_{\\mathrm{n}}(z) + \\frac{p(z)}{k_{\\mathrm{v}}} \\right)\n    $$\n    为简化，我们展开两边：\n    $$\n    \\frac{E_{\\mathrm{s}}}{R_{\\mathrm{s}0}} (R_{\\mathrm{n}}(z) - R_{\\mathrm{s}0}) + \\frac{E_{\\mathrm{s}}}{R_{\\mathrm{s}0} k_{\\mathrm{v}}} p(z) = - \\frac{R_{\\mathrm{n}}(z)}{t_{\\mathrm{s}}} p(z) - \\frac{1}{t_{\\mathrm{s}} k_{\\mathrm{v}}} p(z)^2\n    $$\n    将其重新排列成关于 $p(z)$ 的标准二次型 $a p^2 + b p + c = 0$：\n    $$\n    \\left(\\frac{1}{t_{\\mathrm{s}} k_{\\mathrm{v}}}\\right) p(z)^2 + \\left(\\frac{E_{\\mathrm{s}}}{R_{\\mathrm{s}0} k_{\\mathrm{v}}} + \\frac{R_{\\mathrm{n}}(z)}{t_{\\mathrm{s}}}\\right) p(z) + \\frac{E_{\\mathrm{s}}}{R_{\\mathrm{s}0}} (R_{\\mathrm{n}}(z) - R_{\\mathrm{s}0}) = 0\n    $$\n    乘以 $t_{\\mathrm{s}} k_{\\mathrm{v}} R_{\\mathrm{s}0}$ 以消去分母，得到一个更方便的形式：\n    $$\n    R_{\\mathrm{s}0} p(z)^2 + (E_{\\mathrm{s}} t_{\\mathrm{s}} + R_{\\mathrm{n}}(z) k_{\\mathrm{v}} R_{\\mathrm{s}0}) p(z) + E_{\\mathrm{s}} t_{\\mathrm{s}} k_{\\mathrm{v}} (R_{\\mathrm{n}}(z) - R_{\\mathrm{s}0}) = 0\n    $$\n    这是一个关于 $p(z)$ 的二次方程，其系数为：\n    -   $a = R_{\\mathrm{s}0}$\n    -   $b = E_{\\mathrm{s}} t_{\\mathrm{s}} + R_{\\mathrm{n}}(z) k_{\\mathrm{v}} R_{\\mathrm{s}0}$\n    -   $c = E_{\\mathrm{s}} t_{\\mathrm{s}} k_{\\mathrm{v}} (R_{\\mathrm{n}}(z) - R_{\\mathrm{s}0})$\n\n6.  **求解压力并应用接触条件：** 二次方程的解为 $p(z) = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$。由于 $p(z)$ 必须为非负，且系数 $a$ 和 $b$ 严格为正，我们必须选择“+”号以获得物理上有意义的（非负）压力。\n    $$\n    p(z) = \\frac{-b + \\sqrt{b^2 - 4ac}}{2a}\n    $$\n    该解在接触假设 $p(z) > 0$ 下有效。对二次方程的分析表明，只有当常数项 $c$ 为负时，才存在正实数解，即 $E_{\\mathrm{s}} t_{\\mathrm{s}} k_{\\mathrm{v}} (R_{\\mathrm{n}}(z) - R_{\\mathrm{s}0})  0$。由于 $E_{\\mathrm{s}}$、$t_{\\mathrm{s}}$ 和 $k_{\\mathrm{v}}$ 均为正值，此条件简化为 $R_{\\mathrm{n}}(z)  R_{\\mathrm{s}0}$。\n\n    这对应于接触的物理条件：覆膜支架的自由半径必须大于主动脉瘤颈的初始半径。如果 $R_{\\mathrm{s}0} \\le R_{\\mathrm{n}}(z)$，支架可置于瘤颈内而不施加力，导致接触压力为零。这与互补条件 $p(z) \\ge 0$ 一致。\n\n    因此，接触压力的最终闭式表达式为：\n    $$\n    p(z) =\n    \\begin{cases}\n      \\frac{-(E_{\\mathrm{s}} t_{\\mathrm{s}} + k_{\\mathrm{v}} R_{\\mathrm{n}}(z) R_{\\mathrm{s}0}) + \\sqrt{(E_{\\mathrm{s}} t_{\\mathrm{s}} + k_{\\mathrm{v}} R_{\\mathrm{n}}(z) R_{\\mathrm{s}0})^2 - 4 R_{\\mathrm{s}0} [E_{\\mathrm{s}} t_{\\mathrm{s}} k_{\\mathrm{v}} (R_{\\mathrm{n}}(z) - R_{\\mathrm{s}0})]} }{2 R_{\\mathrm{s}0}}  \\text{if } R_{\\mathrm{s}0} > R_{\\mathrm{n}}(z) \\\\\n      0  \\text{if } R_{\\mathrm{s}0} \\le R_{\\mathrm{n}}(z)\n    \\end{cases}\n    $$\n    其中 $R_{\\mathrm{n}}(z) = R_{\\mathrm{ref}} - s z$ 且 $R_{\\mathrm{s}0} = (1 + o) R_{\\mathrm{ref}}$。$p(z)=0$ 的条件明确为 $R_{\\mathrm{s}0} \\le R_{\\mathrm{n}}(z)$。\n\n### 步骤2：实现\n\n推导出的公式将在一个 Python 程序中实现。对于每个测试用例，程序将计算密封长度 $L$ 上 $N+1$ 个离散点的压力。所有计算均以 SI 基本单位（米、帕斯卡等）进行，最终压力值将转换为千帕（kPa）并按要求四舍五入到三位小数。", "answer": "```python\nimport numpy as np\n\ndef compute_pressure_distribution(R_ref, L, s, E_s, t_s, k_v, o, N):\n    \"\"\"\n    Computes the radial contact pressure distribution p(z) along the sealing length.\n\n    Args:\n        R_ref (float): Reference radius at z=0 (m).\n        L (float): Sealing length (m).\n        s (float): Neck conicity (slope, m/m).\n        E_s (float): Stent-graft Young's modulus (Pa).\n        t_s (float): Stent-graft thickness (m).\n        k_v (float): Vessel Winkler stiffness (Pa/m).\n        o (float): Oversizing fraction (decimal).\n        N (int): Number of intervals for discretization.\n\n    Returns:\n        list: A list of N+1 pressure values (kPa), rounded to three decimals.\n    \"\"\"\n    # Calculate the stent-graft's free (unloaded) radius\n    R_s0 = (1 + o) * R_ref\n\n    # Create an array of axial positions z\n    z_nodes = np.linspace(0, L, N + 1)\n    \n    pressures_pa = []\n\n    # Loop through each axial position to calculate pressure\n    for z in z_nodes:\n        # Calculate the initial radius of the aortic neck at position z\n        R_n_z = R_ref - s * z\n\n        # Check the contact condition based on the complementarity principle.\n        # Pressure is non-zero only if the stent's free radius is larger\n        # than the neck's initial radius.\n        if R_s0 > R_n_z:\n            # Coefficients of the quadratic equation a*p^2 + b*p + c = 0\n            a = R_s0\n            b = E_s * t_s + k_v * R_n_z * R_s0\n            c = E_s * t_s * k_v * (R_n_z - R_s0)\n\n            # Calculate the discriminant\n            discriminant = b**2 - 4 * a * c\n            \n            # When contact occurs, the discriminant is guaranteed to be positive.\n            # This check is a safeguard against potential floating-point inaccuracies.\n            if discriminant  0:\n                discriminant = 0\n\n            # Solve for pressure p(z), choosing the positive root for physical pressure\n            p_z = (-b + np.sqrt(discriminant)) / (2 * a)\n            pressures_pa.append(p_z)\n        else:\n            # If there is no interference, the contact pressure is zero\n            pressures_pa.append(0.0)\n\n    # Convert pressures from Pascals to kiloPascals and round to three decimal places\n    pressures_kpa = [round(p / 1000.0, 3) for p in pressures_pa]\n    \n    return pressures_kpa\n\ndef solve():\n    \"\"\"\n    Defines test cases and computes the pressure distributions for each,\n    then prints the results in the specified format.\n    \"\"\"\n    # Common parameters for all test cases\n    common_params = {\n        'R_ref': 0.012,    # m\n        't_s': 0.0005,     # m\n        'E_s': 40e9,       # Pa\n        'k_v': 5e6,        # Pa/m\n        'L': 0.03,         # m\n        'N': 10\n    }\n\n    # Test suite with varying parameters\n    test_cases = [\n        {'o': 0.10, 's': 0.05},    # Case 1: happy path\n        {'o': 0.00, 's': 0.05},    # Case 2: boundary contact onset\n        {'o': 0.02, 's': 0.00},    # Case 3: zero conicity\n        {'o': -0.01, 's': 0.00},   # Case 4: undersized, no contact\n    ]\n\n    results = []\n    for case in test_cases:\n        # Combine common and case-specific parameters\n        params = {**common_params, **case}\n        # Compute the pressure distribution for the current case\n        pressure_dist = compute_pressure_distribution(**params)\n        results.append(pressure_dist)\n\n    # Format the final output as a comma-separated list of lists\n    # str() on a list produces the required format like [p0, p1, ...]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "5114519"}]}