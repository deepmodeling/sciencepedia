{"hands_on_practices": [{"introduction": "在胸腺瘤的外科决策中，第一步是准确评估诊断的可能性。影像学检查（如CT）并非绝对准确，其结果必须结合临床先验概率进行解读。本练习将应用贝叶斯定理，这是一个在医学诊断中更新我们对疾病可能性的信念的基础工具，通过它我们可以计算出在获得阳性CT扫描结果后，患者患有胸腺瘤的后验概率 [@problem_id:5194835]。", "problem": "一名泛发型重症肌无力患者正在外科门诊接受评估，以确定是直接进行肿瘤性胸腺切除术，还是在手术前进行额外的分期检查。该决策取决于胸部计算机断层扫描（CT）结果为阳性后，胸腺瘤的后验（检验后）概率。在这种诊疗环境下，综合临床表型和血清学标志物，胸腺瘤的检验前概率被评估为 $0.15$。近期的一项荟萃分析报告称，对于需要进行肿瘤切除术的胸腺瘤，CT检测的敏感性为 $0.92$，特异性为 $0.85$。该CT扫描结果被解读为阳性，发现一个与胸腺瘤特征相符的胸腺肿块。\n\n请仅从敏感性和特异性作为条件概率的核心定义，以及关联先验概率、似然和后验概率的贝叶斯定理出发，推导在CT扫描结果为阳性的情况下，胸腺瘤的检验后概率的表达式，然后根据上述参数计算其值。请用小数表示最终答案，并四舍五入到四位有效数字。", "solution": "**解题推导**\n\n设 $T$ 为患者患有胸腺瘤的事件。\n设 $T^c$ 为患者没有患胸腺瘤的事件。\n设 $C^+$ 为计算机断层扫描（CT）结果为阳性的事件。\n设 $C^-$ 为CT扫描结果为阴性的事件。\n\n所提供的信息可以用条件概率的语言表示：\n1.  检验前胸腺瘤概率即先验概率 $P(T)$。\n    $$P(T) = 0.15$$\n    由此，没有患胸腺瘤的先验概率为：\n    $$P(T^c) = 1 - P(T) = 1 - 0.15 = 0.85$$\n2.  敏感性是在患有该疾病的情况下，检测结果为阳性的概率。这是条件概率 $P(C^+|T)$。\n    $$P(C^+|T) = 0.92$$\n3.  特异性是在未患该疾病的情况下，检测结果为阴性的概率。这是条件概率 $P(C^-|T^c)$。\n    $$P(C^-|T^c) = 0.85$$\n\n目标是求在CT扫描结果为阳性的情况下，患有胸腺瘤的检验后概率，即后验概率 $P(T|C^+)$。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$P(T|C^+) = \\frac{P(C^+|T) P(T)}{P(C^+)}$$\n\n分母中的项 $P(C^+)$ 是检测结果为阳性的总概率。它可以使用全概率公式计算，该公式对是否存在胸腺瘤进行边缘化：\n$$P(C^+) = P(C^+ \\cap T) + P(C^+ \\cap T^c)$$\n使用条件概率的定义 $P(A \\cap B) = P(A|B)P(B)$，我们可以写出：\n$$P(C^+) = P(C^+|T)P(T) + P(C^+|T^c)P(T^c)$$\n\n我们已知 $P(C^+|T)$ 和 $P(T)$，但必须推导出 $P(C^+|T^c)$。该项表示没有胸腺瘤的患者检测结果为阳性的概率（假阳性率）。它与特异性有关。对于任何给定的条件（在此情况下为没有胸腺瘤，$T^c$），检测结果必须是阳性或阴性。因此，它们的概率之和为 $1$：\n$$P(C^+|T^c) + P(C^-|T^c) = 1$$\n求解假阳性率：\n$$P(C^+|T^c) = 1 - P(C^-|T^c) = 1 - 0.85 = 0.15$$\n\n现在我们可以将所有已知值代入总概率 $P(C^+)$ 的表达式中：\n$$P(C^+) = (0.92)(0.15) + (0.15)(0.85)$$\n$$P(C^+) = 0.138 + 0.1275 = 0.2655$$\n\n最后，我们将 $P(C^+|T)$、$P(T)$ 和 $P(C^+)$ 的值代回贝叶斯定理，以求得所需的后验概率 $P(T|C^+)$。完整的推导表达式为：\n$$P(T|C^+) = \\frac{P(C^+|T)P(T)}{P(C^+|T)P(T) + P(C^+|T^c)P(T^c)}$$\n$$P(T|C^+) = \\frac{P(C^+|T)P(T)}{P(C^+|T)P(T) + (1 - P(C^-|T^c))(1-P(T))}$$\n\n计算数值：\n$$P(T|C^+) = \\frac{(0.92)(0.15)}{0.2655} = \\frac{0.138}{0.2655}$$\n$$P(T|C^+) \\approx 0.51977399...$$\n\n将结果四舍五入到四位有效数字，我们得到 $0.5198$。", "answer": "$$\\boxed{0.5198}$$", "id": "5194835"}, {"introduction": "在确定手术适应症后，下一步是进行个体化的围手术期风险评估，这是现代循证医学外科实践的核心。临床预测模型能够量化特定患者发生术后并发症（如需要呼吸机支持）的风险，从而指导术前准备和医患沟通。本练习将运用一个基于逻辑回归的预测模型，该模型整合了包括重症肌无力分级和肺功能在内的多个风险因素 [@problem_id:5194878]。", "problem": "一个接受了胸骨正中扩大切口胸腺切除术的胸腺瘤和重症肌无力成年患者队列被用于建立一个预测术后即刻需要有创机械通气的预测模型。该模型基于逻辑斯谛函数和优势比的公认特性，拟合为一个带有逻辑斯谛链接的广义线性模型，并使用三个协变量：美国重症肌无力基金会（Myasthenia Gravis Foundation of America, MGFA）分级、病程和以预测百分比值表示的术前用力肺活量（Forced Vital Capacity, FVC）。协变量编码如下：MGFA分级 $c$ 被视为一个有序整数，其中 $c \\in \\{1,2,3,4\\}$ 对应于I–IV级；病程 $d$ 以年为单位；术前FVC $f$ 是预测百分比值。\n\n拟合模型的线性预测变量由以下表达式给出\n$$\n\\eta = \\beta_{0} + \\beta_{1} c + \\beta_{2} d + \\beta_{3} f + \\beta_{4} c f,\n$$\n系数为\n$$\n\\beta_{0} = -2.80,\\quad \\beta_{1} = 0.50,\\quad \\beta_{2} = 0.08,\\quad \\beta_{3} = -0.03,\\quad \\beta_{4} = 0.004.\n$$\n使用逻辑斯谛函数的标准定义（即概率作为对数优势比的变换），计算一个MGFA分级为 $c=3$、病程为 $d=4$ 年、术前FVC为 $f=65$（预测百分比值）的患者在术后24小时内需要有创机械通气的预测概率。\n\n将最终答案表示为小数，并四舍五入到四位有效数字。", "solution": "问题要求基于逻辑斯谛回归模型计算一个二元结果的预测概率 $p$。该模型首先计算一个线性预测变量 $\\eta$，它代表结果的对数优势比。\n线性预测变量的公式如下：\n$$\n\\eta = \\beta_{0} + \\beta_{1} c + \\beta_{2} d + \\beta_{3} f + \\beta_{4} c f\n$$\n系数和患者特定协变量的值已提供：\n-   $\\beta_{0} = -2.80$\n-   $\\beta_{1} = 0.50$\n-   $\\beta_{2} = 0.08$\n-   $\\beta_{3} = -0.03$\n-   $\\beta_{4} = 0.004$\n-   $c = 3$\n-   $d = 4$\n-   $f = 65$\n\n我们将这些值代入 $\\eta$ 的方程中：\n$$\n\\eta = -2.80 + (0.50)(3) + (0.08)(4) + (-0.03)(65) + (0.004)(3)(65)\n$$\n首先，我们计算每一项：\n-   截距是 $\\beta_{0} = -2.80$。\n-   MGFA分级的项是 $\\beta_{1} c = 0.50 \\times 3 = 1.50$。\n-   病程的项是 $\\beta_{2} d = 0.08 \\times 4 = 0.32$。\n-   FVC的项是 $\\beta_{3} f = -0.03 \\times 65 = -1.95$。\n-   交互项是 $\\beta_{4} c f = 0.004 \\times 3 \\times 65 = 0.012 \\times 65 = 0.78$。\n\n现在，我们将这些项相加来求 $\\eta$ 的值：\n$$\n\\eta = -2.80 + 1.50 + 0.32 - 1.95 + 0.78\n$$\n$$\n\\eta = (-2.80 - 1.95) + (1.50 + 0.32 + 0.78)\n$$\n$$\n\\eta = -4.75 + 2.60\n$$\n$$\n\\eta = -2.15\n$$\n线性预测变量，或称对数优势比，是 $\\eta = -2.15$。\n\n下一步是将对数优势比 $\\eta$ 转换为概率 $p$。这通过使用标准的逻辑斯谛函数来完成，该函数是logit链接函数的反函数：\n$$\np = \\frac{1}{1 + \\exp(-\\eta)}\n$$\n代入计算出的 $\\eta = -2.15$ 的值：\n$$\np = \\frac{1}{1 + \\exp(-(-2.15))} = \\frac{1}{1 + \\exp(2.15)}\n$$\n我们现在计算数值。$\\exp(2.15)$ 的值约为 $8.58455$。\n$$\np \\approx \\frac{1}{1 + 8.58455} = \\frac{1}{9.58455}\n$$\n$$\np \\approx 0.1043343\n$$\n问题要求将答案四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$4$ 和 $3$。第五位有效数字是 $3$，小于 $5$，所以我们向下舍入。\n$$\np \\approx 0.1043\n$$\n因此，该患者需要有创机械通气的预测概率约为 $0.1043$。", "answer": "$$\n\\boxed{0.1043}\n$$", "id": "5194878"}, {"introduction": "对于经评估为高风险的重症肌无力患者，术前优化是降低并发症、确保手术安全的关键环节。血浆置换（TPE）是快速改善神经肌肉传递功能的有效手段，但其方案设计需要精确的药代动力学计算。本练习将通过构建一个双室模型，来推导并计算达到目标抗体滴度所需的血浆置换次数和具体时间安排，这充分体现了将基础科学原理应用于临床决策的过程 [@problem_id:5194850]。", "problem": "一名患有胸腺瘤和重症肌无力 (MG) 的患者计划在 $T_{s} = 192$ 小时后进行扩大胸腺切除术。为优化神经肌肉传递，您计划进行术前治疗性血浆置换（TPE；血浆分离置换法），以降低在血管内室测得的血清抗乙酰胆碱受体 (AChR) 抗体滴度。假设采用一个双室免疫球蛋白分布模型，其中血管内分数为 $\\beta$，血管外分数为 $1 - \\beta$。TPE 可快速清除血管内物质，且在两次置换之间，室间再平衡遵循一级动力学。以下经过充分验证的事实和参数适用：\n\n- 每次TPE置换瞬间移除血管内抗AChR抗体质量的一部分，比例为 $\\eta = 0.60$。\n- 在稳态下，血管内分数为全身总抗体质量的 $\\beta = 0.40$。\n- 室间再平衡（抗体从血管外空间向血管内空间移动）遵循一级动力学，其速率常数 $k$ 与分布半衰期 $t_{1/2}$ 的关系为 $k = (\\ln 2)/t_{1/2}$，其中 $t_{1/2} = 24 \\ \\mathrm{h}$。\n- 在术前窗口期内，抗体的合成和分解代谢可忽略不计。\n- 在每次置换前，如果距上一次置换已过去至少 $24 \\ \\mathrm{h}$，则假设血管内分数已重新平衡至 $Q_{v} = \\beta Q$，其中 $Q$ 是当前的总抗体质量。\n- 最后一次置换在手术切口前 $\\Delta t_{N} = 6 \\ \\mathrm{h}$ 结束。\n\n设基线稳态血清滴度（与血管内抗体质量 $Q_{v}(0)$ 成正比）为 $C_{0}$，目标术前滴度为基线滴度的 $r_{\\mathrm{target}} = 0.10$ 或更低，即 $C(T_{s})/C_{0} \\leq r_{\\mathrm{target}}$。\n\n从质量平衡和一级再平衡出发，推导手术切口时血清滴度分数作为置换次数 $N$ 和最终间隔 $\\Delta t_{N}$ 的函数表达式；在上述假设下，确定能使 $C(T_{s})/C_{0} \\leq 0.10$ 成立的最小整数 $N$；并通过列出 $N$ 次置换的结束时间（以术前小时数表示），指定一个有效的时间表。这些置换间隔 $24 \\ \\mathrm{h}$，且最后一次置换在手术前 $\\Delta t_{N} = 6 \\ \\mathrm{h}$ 结束。\n\n将所有时间值四舍五入至四位有效数字，并以小时为单位表示。以单行矩阵的形式提供最终答案，其第一个元素为 $N$，后面是按时间顺序（从最早到最晚）排列的置换结束时间列表。", "solution": "解答过程分三个阶段：首先，推导经过一系列治疗性血浆置换（TPE）后血清滴度的通用表达式；其次，确定达到治疗目标所需的最少置换次数 $N$；第三，确定这些置换的具体时间表。\n\n设 $Q_{v}(t)$ 和 $Q_{e}(t)$ 分别为时间 $t$ 时的血管内和血管外抗AChR抗体质量。总抗体质量为 $Q(t) = Q_{v}(t) + Q_{e}(t)$。血清滴度 $C(t)$ 与血管内质量 $Q_{v}(t)$ 成正比。因此，相对于基线的滴度分数为 $C(t)/C_{0} = Q_{v}(t)/Q_{v}(0)$。\n\n在基线时（$t=0$），系统处于稳态。初始总质量为 $Q_{0}$。血管内和血管外质量由下式给出：\n$Q_{v}(0) = \\beta Q_{0}$\n$Q_{e}(0) = (1-\\beta) Q_{0}$\n其中 $\\beta = 0.40$ 是稳态血管内分数。\n\n该过程包括 $N$ 个TPE循环，每个循环后都有再平衡过程。问题陈述，对于至少 $24 \\ \\mathrm{h}$ 的间隔，我们假设抗体分布恢复到稳态，即 $Q_{v} = \\beta Q$，其中 $Q$ 是当前的抗体总质量。计划的置换间隔为 $24 \\ \\mathrm{h}$。\n\n让我们对单个TPE循环的效果进行建模。设 $Q_{i-1}$ 为第 $i$ 次置换前的总抗体质量。根据再平衡假设，置换前的血管内质量为 $Q_{v,i}^{-} = \\beta Q_{i-1}$。\nTPE过程瞬间移除了血管内质量的一部分，比例为 $\\eta = 0.60$。置换后瞬间的质量 $Q_{v,i}^{+}$ 为：\n$Q_{v,i}^{+} = (1-\\eta) Q_{v,i}^{-} = (1-\\eta) \\beta Q_{i-1}$\n血管外质量不受置换影响：$Q_{e,i}^{+} = Q_{e,i}^{-} = (1-\\beta) Q_{i-1}$。\n第 $i$ 次置换后的新全身总抗体质量 $Q_{i}$ 是置换后质量之和：\n$Q_{i} = Q_{v,i}^{+} + Q_{e,i}^{+} = (1-\\eta) \\beta Q_{i-1} + (1-\\beta) Q_{i-1} = (1 - \\eta\\beta) Q_{i-1}$\n\n这就建立了总抗体质量的递推关系。从 $Q_{0}$ 开始，经过 $i$ 次置换后的总质量为 $Q_{i} = (1-\\eta\\beta)^{i} Q_{0}$。\n因此，经过 $N-1$ 次置换及随后的再平衡后，在第 $N$ 次置换前的总质量为 $Q_{N-1} = (1-\\eta\\beta)^{N-1} Q_{0}$。\n\n现在我们考虑第 $N$ 次置换和最终的置换后间隔。\n就在第 $N$ 次置换前，血管内质量为 $Q_{v,N}^{-} = \\beta Q_{N-1} = \\beta (1-\\eta\\beta)^{N-1} Q_{0}$。\n第 $N$ 次置换后瞬间，血管内质量为：\n$Q_{v,N}^{+} = (1-\\eta) Q_{v,N}^{-} = (1-\\eta) \\beta (1-\\eta\\beta)^{N-1} Q_{0}$。\n第 $N$ 次置换后的总质量为 $Q_{N} = (1-\\eta\\beta) Q_{N-1} = (1-\\eta\\beta)^{N} Q_{0}$。\n\n在最后一次置换之后，有一个持续时间为 $\\Delta t_{N} = 6 \\ \\mathrm{h}$ 的再平衡期。在这个较短的间隔内，我们不能假设完全再平衡。我们必须使用室间转移的一级动力学方程：\n$\\frac{dQ_{v}}{dt} = k (\\beta Q - Q_{v})$\n其中 $k = (\\ln 2)/t_{1/2}$ 且 $Q$ 是此时间间隔内的恒定总质量，$Q = Q_{N}$。\n对于时间间隔 $\\Delta t$，从初始值 $Q_{v,\\text{start}}$ 开始，关于 $Q_{v}(t)$ 的这个线性常微分方程的解为：\n$Q_{v}(t_0 + \\Delta t) = (Q_{v,\\text{start}} - \\beta Q) \\exp(-k \\Delta t) + \\beta Q$。\n\n对于最后的时间间隔， $t_0$ 是第 $N$ 次置换结束的时间，$\\Delta t = \\Delta t_{N}$，$Q_{v,\\text{start}} = Q_{v,N}^{+}$，且 $Q = Q_{N}$。手术时间 $T_{s}$ 时的血管内质量为：\n$Q_{v}(T_{s}) = (Q_{v,N}^{+} - \\beta Q_{N}) \\exp(-k \\Delta t_{N}) + \\beta Q_{N}$。\n\n代入 $Q_{v,N}^{+}$ 和 $Q_{N}$ 的表达式：\n$Q_{v}(T_{s}) = \\left[ (1-\\eta) \\beta (1-\\eta\\beta)^{N-1} Q_{0} - \\beta (1-\\eta\\beta)^{N} Q_{0} \\right] \\exp(-k \\Delta t_{N}) + \\beta (1-\\eta\\beta)^{N} Q_{0}$。\n从括号项中提取因子 $\\beta Q_{0} (1-\\eta\\beta)^{N-1}$：\n$Q_{v}(T_{s}) = \\beta Q_{0} (1-\\eta\\beta)^{N-1} \\left[ (1-\\eta) - (1-\\eta\\beta) \\right] \\exp(-k \\Delta t_{N}) + \\beta (1-\\eta\\beta)^{N} Q_{0}$。\n新括号中的项简化为：$(1-\\eta) - (1-\\eta\\beta) = -\\eta + \\eta\\beta = -\\eta(1-\\beta)$。\n$Q_{v}(T_{s}) = -\\eta(1-\\beta) \\beta Q_{0} (1-\\eta\\beta)^{N-1} \\exp(-k \\Delta t_{N}) + \\beta (1-\\eta\\beta)^{N} Q_{0}$。\n\n所求量为滴度分数 $C(T_{s})/C_{0} = Q_{v}(T_{s})/Q_{v}(0) = Q_{v}(T_{s})/(\\beta Q_{0})$。\n$\\frac{C(T_{s})}{C_{0}} = \\frac{1}{\\beta Q_{0}} \\left[ -\\eta(1-\\beta) \\beta Q_{0} (1-\\eta\\beta)^{N-1} \\exp(-k \\Delta t_{N}) + \\beta (1-\\eta\\beta)^{N} Q_{0} \\right]$\n$\\frac{C(T_{s})}{C_{0}} = - \\eta(1-\\beta) (1-\\eta\\beta)^{N-1} \\exp(-k \\Delta t_{N}) + (1-\\eta\\beta)^{N}$。\n提取因子 $(1-\\eta\\beta)^{N-1}$，我们得到推导出的表达式：\n$\\frac{C(T_{s})}{C_{0}} = (1-\\eta\\beta)^{N-1} \\left[ (1-\\eta\\beta) - \\eta(1-\\beta) \\exp(-k \\Delta t_{N}) \\right]$。\n\n接下来，我们求出能使 $C(T_{s})/C_{0} \\leq r_{\\mathrm{target}} = 0.10$ 成立的最小整数 $N$。\n我们代入给定值：$\\eta=0.60$, $\\beta=0.40$, $t_{1/2}=24 \\ \\mathrm{h}$, $\\Delta t_{N}=6 \\ \\mathrm{h}$。\n$1-\\eta\\beta = 1 - (0.60)(0.40) = 1 - 0.24 = 0.76$。\n$k = \\frac{\\ln 2}{24} \\ \\mathrm{h}^{-1}$。\n$k \\Delta t_{N} = \\frac{\\ln 2}{24} \\times 6 = \\frac{\\ln 2}{4}$。\n$\\exp(-k \\Delta t_{N}) = \\exp(-\\frac{\\ln 2}{4}) = (2^{-1})^{1/4} = 2^{-1/4}$。\n$\\eta(1-\\beta) = 0.60(1-0.40) = 0.60(0.60) = 0.36$。\n\n不等式变为：\n$(0.76)^{N-1} \\left[ 0.76 - 0.36 \\times 2^{-1/4} \\right] \\leq 0.10$。\n括号中的项约为 $0.76 - 0.36 \\times 0.8409 = 0.76 - 0.3027 = 0.4573$。\n$(0.76)^{N-1} (0.457277...) \\leq 0.10$。\n$(0.76)^{N-1} \\leq \\frac{0.10}{0.457277...} \\approx 0.218686$。\n对两边取自然对数：\n$(N-1)\\ln(0.76) \\leq \\ln(0.218686)$。\n由于 $\\ln(0.76)$ 为负，除法后我们反转不等号：\n$N-1 \\geq \\frac{\\ln(0.218686)}{\\ln(0.76)} \\approx \\frac{-1.5200}{-0.2744} \\approx 5.539$。\n$N \\geq 6.539$。\n最小整数置换次数为 $N=7$。\n\n最后，我们确定时间表。最后一次（第7次）置换在手术切口前 $\\Delta t_{N} = 6 \\ \\mathrm{h}$ 结束。各次置换间隔 $24 \\ \\mathrm{h}$。要求的时间是以手术前的小时数表示，并按事件从最早到最晚的顺序排列。\n设 $t_{i}$ 为第 $i$ 次置换的结束时间，以手术前的小时数表示。\n$t_7 = 6.000 \\ \\mathrm{h}$。\n第 $i-1$ 次置换结束与第 $i$ 次置换结束之间的时间为 $24 \\ \\mathrm{h}$，所以 $t_{i-1} = t_i + 24$。\n$t_6 = t_7 + 24 = 6 + 24 = 30.00 \\ \\mathrm{h}$。\n$t_5 = t_6 + 24 = 30 + 24 = 54.00 \\ \\mathrm{h}$。\n$t_4 = t_5 + 24 = 54 + 24 = 78.00 \\ \\mathrm{h}$。\n$t_3 = t_4 + 24 = 78 + 24 = 102.0 \\ \\mathrm{h}$。\n$t_2 = t_3 + 24 = 102 + 24 = 126.0 \\ \\mathrm{h}$。\n$t_1 = t_2 + 24 = 126 + 24 = 150.0 \\ \\mathrm{h}$。\n从最早到最晚的完整置换结束时间表（以术前小时数计）为 $(150.0, 126.0, 102.0, 78.00, 54.00, 30.00, 6.000)$ 小时。从第一次置换到手术的总持续时间为 $150.0 \\ \\mathrm{h}$，这在可用的术前窗口期 $T_s = 192 \\ \\mathrm{h}$ 之内。\n\n最终答案包括 $N=7$ 和计划的时间列表，以单行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n7  & 150.0  & 126.0  & 102.0  & 78.00  & 54.00  & 30.00  & 6.000\n\\end{pmatrix}\n}\n$$", "id": "5194850"}]}