{"hands_on_practices": [{"introduction": "鼓膜 (Tympanic Membrane, TM) 是听觉通路中第一个关键的力学部件，它将空气中的声波振动高效地传递给中耳听骨链。理解其振动特性，特别是其共振频率，对于揭示声音传递的物理机制至关重要。本练习 [@problem_id:5007416] 将经典物理学中的膜振动理论应用于鼓膜这一生物结构，通过建立一个理想化的物理模型来计算其基频。通过将模型预测值与真实测量值进行比较，我们不仅能深入理解决定鼓膜力学行为的关键参数，也能体会到简化模型在生物物理研究中的价值与局限性。", "problem": "一个理想化的人类鼓膜（TM）模型将其视为一个薄的、各向同性的、圆形的、边缘固定的、具有均匀面内张力的膜。设半径为 $a$ 的区域上的横向位移为 $u(r,\\theta,t)$，单位长度上的均匀张力为 $T$，均匀表面质量密度（单位面积的质量）为 $\\rho$。从应用于无穷小膜元的牛顿第二定律和拉伸膜上波速的定义出发，推导其控制性的二维波动方程，并由此获得圆形固定膜的基频（最低）共振频率的表达式，该表达式应以第一类零阶贝塞尔函数的第一个零点表示。使用此表达式，计算在参数 $T = 20 \\ \\text{N/m}$，$\\rho = 0.10 \\ \\text{kg/m}^{2}$ 和 $a = 4.0 \\ \\text{mm}$ 下模型预测的鼓膜基频共振频率，并将其与测量的人类平均基频 $f_{\\text{meas}} = 1.20 \\ \\text{kHz}$ 进行比较。将分数偏差 $\\delta = \\dfrac{f_{\\text{model}} - f_{\\text{meas}}}{f_{\\text{meas}}}$ 报告为纯小数（无量纲）。使用 $J_{0}$ 的第一个零点的已知数值，即 $\\alpha_{01} \\approx 2.404825558$。将最终报告的 $\\delta$ 四舍五入到四位有效数字。如果需要，可以用 $\\text{Hz}$ 表示中间频率，但最终要求报告的量 $\\delta$ 是无量纲的。", "solution": "### 1. 波动方程与共振频率的推导\n\n一个理想圆形膜的横向位移 $u(r,\\theta,t)$ 由二维波动方程描述。在极坐标下，该方程为：\n$$ \\frac{\\partial^2 u}{\\partial r^2} + \\frac{1}{r}\\frac{\\partial u}{\\partial r} + \\frac{1}{r^2}\\frac{\\partial^2 u}{\\partial \\theta^2} = \\frac{1}{c^2}\\frac{\\partial^2 u}{\\partial t^2} $$\n其中，波在膜上传播的速度 $c$ 由张力 $T$（单位长度上的力）和面密度 $\\rho$（单位面积的质量）决定：$c = \\sqrt{T/\\rho}$。\n\n我们采用分离变量法求解，设解的形式为 $u(r, \\theta, t) = R(r)\\Theta(\\theta)T(t)$。\n- 基频振动是轴对称的，因此位移与 $\\theta$ 无关，$\\Theta(\\theta)$ 为常数。\n- 时间部分是谐波振荡，$T(t) \\propto \\cos(\\omega t)$，其中 $\\omega = 2\\pi f$ 是角频率。\n\n将此形式代入波动方程，得到关于径向部分 $R(r)$ 的贝塞尔微分方程：\n$$ r^2 \\frac{d^2 R}{d r^2} + r \\frac{d R}{d r} + (k^2 r^2)R = 0 $$\n其中 $k = \\omega/c$。该方程的通解为 $R(r) = A J_0(kr) + B Y_0(kr)$，其中 $J_0$ 和 $Y_0$ 分别是零阶的第一类和第二类贝塞尔函数。由于位移在中心 $r=0$ 处必须是有限的，而 $Y_0(r)$ 在 $r \\to 0$ 时发散，因此系数 $B$ 必须为零。解简化为 $R(r) = A J_0(kr)$。\n\n边界条件是膜的边缘在 $r=a$ 处固定，即 $u(a,t)=0$，这意味着 $R(a)=0$。\n$$ J_0(ka) = 0 $$\n此条件意味着宗量 $ka$ 必须是 $J_0$ 函数的一个零点。基频（最低共振频率）对应于 $J_0$ 的第一个非零零点，记为 $\\alpha_{01}$。\n$$ ka = \\alpha_{01} $$\n将 $k = \\omega/c = 2\\pi f/c$ 代入：\n$$ \\frac{2\\pi f a}{c} = \\alpha_{01} $$\n求解频率 $f$，并代入 $c=\\sqrt{T/\\rho}$，得到基频共振频率的表达式：\n$$ f = \\frac{\\alpha_{01} c}{2\\pi a} = \\frac{\\alpha_{01}}{2\\pi a}\\sqrt{\\frac{T}{\\rho}} $$\n\n### 2. 数值计算\n\n给定参数：\n- 张力 $T = 20 \\ \\text{N/m}$\n- 面密度 $\\rho = 0.10 \\ \\text{kg/m}^2$\n- 半径 $a = 4.0 \\ \\text{mm} = 0.004 \\ \\text{m}$\n- $J_0$ 的第一个零点 $\\alpha_{01} \\approx 2.404825558$\n\n计算模型预测的频率 $f_{\\text{model}}$：\n$$ f_{\\text{model}} = \\frac{2.404825558}{2\\pi (0.004 \\ \\text{m})} \\sqrt{\\frac{20 \\ \\text{N/m}}{0.10 \\ \\text{kg/m}^2}} = \\frac{2.404825558}{0.008\\pi} \\sqrt{200} \\ \\text{Hz} $$\n$$ f_{\\text{model}} \\approx 95.693 \\times 14.1421356 \\ \\text{Hz} \\approx 1353.24 \\ \\text{Hz} \\approx 1.353 \\ \\text{kHz} $$\n\n### 3. 计算分数偏差\n\n测量的基频为 $f_{\\text{meas}} = 1.20 \\ \\text{kHz}$。\n分数偏差 $\\delta$ 定义为：\n$$ \\delta = \\frac{f_{\\text{model}} - f_{\\text{meas}}}{f_{\\text{meas}}} = \\frac{1353.24 \\ \\text{Hz} - 1200 \\ \\text{Hz}}{1200 \\ \\text{Hz}} = \\frac{153.24}{1200} \\approx 0.12770 $$\n四舍五入到四位有效数字，得到 $\\delta = 0.1277$。", "answer": "$$\\boxed{0.1277}$$", "id": "5007416"}, {"introduction": "声音能量经由中耳传递至耳蜗后，基底膜 (Basilar Membrane, BM) 如同一个精密的频率分析仪，将不同频率的声音成分映射到其上的特定位置，这一过程被称为频率局域调谐 (tonotopy)。本练习 [@problem_id:5007420] 旨在将这一生物学功能转化为可量化的物理参数。我们将通过分析一组模拟的基底膜振动实验数据，学习如何估算频率调谐曲线的品质因数 ($Q$ 值)，它是衡量滤波器选择性或调谐锐度的关键指标。这个实践将帮助你掌握从实验数据中提取核心系统参数的方法，并加深对耳蜗频率选择性机制的理解。", "problem": "一项激光多普勒振动测量实验测量了耳蜗底部某个位置基底膜 (BM) 的频率依赖性峰值位移振幅，该位置的最佳（中心）频率接近 $f_c = 8.0\\,\\mathrm{kHz}$。刺激是在固定驱动水平下施加的连续正弦波，并且假设中耳在感兴趣的窄带内传递恒定的镫骨速度振幅，因此测得的作为频率函数的 BM 位移与局部线性传递函数的大小成正比。以下数据列出了该位置的频率 $f$ 和 BM 峰值位移振幅 $A(f)$：\n- $(f, A)$ 单位为 $(\\mathrm{kHz}, \\mathrm{nm})$：$(6.3, 10.0)$, $(7.1, 15.0)$, $(8.0, 20.0)$, $(9.0, 15.5)$, $(10.0, 12.0)$，以及额外的离峰点 $(5.6, 7.5)$, $(11.2, 9.0)$, $(12.5, 7.0)$，这些点证实了两侧的单调衰减。\n\n假设以下方法学模型和近似：\n- 在最大值附近的窄范围内，特定位置的 BM 响应可以建模为一个轻阻尼、近似二阶的线性时不变 (LTI) 谐振器，该谐振器在角频率 $\\omega = 2\\pi f$ 下驱动，其自然角频率为 $\\omega_0 = 2\\pi f_c$，品质因数为 $Q$。\n- 半功率点由频率 $f_1$ 和 $f_2$ 定义，在这些频率点，振幅满足 $A(f_{1,2}) = A_{\\max}/\\sqrt{2}$，其中 $A_{\\max} = \\max_f A(f)$。\n- 在相邻的测量频率之间，$A$ 与 $\\ln f$ 近似线性变化（对数频率插值），这反映了轻阻尼谐振器在峰值附近的对数频率调谐曲线的斜率近似恒定。\n\n任务：\n1) 从标准二阶谐振器在共振附近的幅值和半功率定义出发，推导出品质因数 $Q$ 关于中心频率 $f_c$ 和半功率带宽 $\\mathrm{BW} = f_2 - f_1$ 的表达式。您的推导必须从轻阻尼二阶 LTI 系统的基本定义和半功率准则开始，并推导出一个将 $Q$ 与 $f_c$ 和 $\\mathrm{BW}$ 相关联的表达式，而不是先验地假设该关系。\n\n2) 使用提供的 BM 位移数据和对数频率插值假设，估计 $f_1$ 和 $f_2$，计算 $\\mathrm{BW}$，然后使用您推导出的表达式计算此位置的 $Q$。将 $f_c$ 视为 $A(f)$ 在测量数据集中达到其最大值时的频率。将最终的 $Q$ 数值四舍五入到 4 位有效数字。将最终答案表示为一个纯数（无量纲）。", "solution": "我们分两部分进行：首先，对于轻阻尼二阶线性时不变 (LTI) 谐振器，推导出品质因数与中心频率和半功率带宽相关的表达式；然后，使用指定的插值方法，从基底膜 (BM) 位移数据中估计半功率带宽。\n\n第 $1$ 部分：推导 $Q$ 关于 $f_c$ 和 $\\mathrm{BW}$ 的表达式。\n\n- 基本模型：在单个共振点附近，特定位置的 BM 响应幅值可以近似为一个二阶 LTI 谐振器。设角频率为 $\\omega = 2\\pi f$，共振角频率为 $\\omega_0 = 2\\pi f_c$，品质因数为 $Q$。一个轻阻尼二阶系统的标准无量纲化幅值平方响应为\n$$\n|H(\\mathrm{j}\\omega)|^2 \\propto \\frac{1}{\\left(1 - \\left(\\frac{\\omega}{\\omega_0}\\right)^2\\right)^2 + \\left(\\frac{\\omega}{Q\\,\\omega_0}\\right)^2}.\n$$\n- 对于轻阻尼系统，最大幅值出现在 $\\omega \\approx \\omega_0$ 附近。定义无量纲频率比 $r = \\omega/\\omega_0$，并通过令 $r = 1 + \\delta$（其中 $|\\delta| \\ll 1$）来考虑峰值附近的小偏差。那么在 $r \\approx 1$ 附近，分母可以展开到主导阶：\n$$\n1 - r^2 = 1 - (1 + \\delta)^2 = -2\\delta - \\delta^2 \\approx -2\\delta,\n$$\n并且在阻尼项中 $r \\approx 1$。因此，在共振点附近，\n$$\n\\left(1 - r^2\\right)^2 + \\left(\\frac{r}{Q}\\right)^2 \\approx (2\\delta)^2 + \\frac{1}{Q^2} = 4\\delta^2 + \\frac{1}{Q^2}.\n$$\n- 最大幅值出现在 $\\delta = 0$ 处，此时分母近似为 $\\frac{1}{Q^2}$。半功率准则指出，半功率点处的幅值平方等于峰值幅值平方的一半。由于幅值平方与分母成反比，半功率条件使得分母相对于其在峰值处的值增加一倍。因此，在半功率点处，\n$$\n4\\delta^2 + \\frac{1}{Q^2} = \\frac{2}{Q^2} \\quad \\Rightarrow \\quad 4\\delta^2 = \\frac{1}{Q^2} \\quad \\Rightarrow \\quad \\delta = \\pm \\frac{1}{2Q}.\n$$\n- 在小阻尼下的一阶近似中，对应的半功率角频率为 $\\omega_{1,2} = \\omega_0(1 \\pm \\frac{1}{2Q})$。因此，角频率上的半功率带宽为\n$$\n\\Delta \\omega \\equiv \\omega_2 - \\omega_1 \\approx \\omega_0\\left(1 + \\frac{1}{2Q}\\right) - \\omega_0\\left(1 - \\frac{1}{2Q}\\right) = \\frac{\\omega_0}{Q}.\n$$\n- 使用 $\\omega = 2\\pi f$ 转换为普通频率，得到 $\\Delta \\omega = 2\\pi \\Delta f$ 和 $\\omega_0 = 2\\pi f_c$，因此\n$$\n2\\pi\\,\\mathrm{BW} = \\frac{2\\pi f_c}{Q} \\quad \\Rightarrow \\quad Q = \\frac{f_c}{\\mathrm{BW}},\n$$\n其中 $\\mathrm{BW} = f_2 - f_1$ 是半功率带宽。这就是在轻阻尼、近共振近似下的所需关系。\n\n第 $2$ 部分：从 BM 位移数据估计 $\\mathrm{BW}$ 并计算 $Q$。\n\n- 确定最大振幅。根据数据，报告的最大 BM 位移振幅在 $f = 8.0\\,\\mathrm{kHz}$ 时为 $A = 20.0\\,\\mathrm{nm}$。因此 $f_c = 8.0\\,\\mathrm{kHz}$ 并且\n$$\nA_{\\max} = 20.0\\,\\mathrm{nm}, \\qquad A_{\\text{half}} = \\frac{A_{\\max}}{\\sqrt{2}} = \\frac{20.0}{\\sqrt{2}}\\,\\mathrm{nm} = 14.14213562\\,\\mathrm{nm}.\n$$\n- 通过 $A(f_{1,2}) = A_{\\text{half}}$ 定义半功率频率 $f_1$（较低）和 $f_2$（较高），并应用假设，即在相邻测量点之间，$A$ 随 $\\ln f$ 线性变化。\n\n较低的半功率频率 $f_1$：\n- 在峰值的较低一侧，振幅在 $(f, A) = (6.3\\,\\mathrm{kHz}, 10.0\\,\\mathrm{nm})$ 和 $(7.1\\,\\mathrm{kHz}, 15.0\\,\\mathrm{nm})$ 之间包围了 $A_{\\text{half}}$。令 $x = \\ln f$。在 $x$ 上进行线性插值：\n$$\nx_1 = \\ln(6.3), \\quad x_2 = \\ln(7.1), \\quad A_1 = 10.0, \\quad A_2 = 15.0.\n$$\n令 $t_{\\mathrm{L}} = \\dfrac{A_{\\text{half}} - A_1}{A_2 - A_1} = \\dfrac{14.14213562 - 10.0}{5.0} = 0.828427124.$ 则\n$$\nx_{\\mathrm{L}} = x_1 + t_{\\mathrm{L}}(x_2 - x_1) = \\ln(6.3) + 0.828427124\\left[\\ln(7.1) - \\ln(6.3)\\right].\n$$\n从数值上看，\n$$\n\\ln(6.3) = 1.840549633,\\quad \\ln(7.1) = 1.960094784,\\quad x_{\\mathrm{L}} = 1.840549633 + 0.828427124\\cdot 0.119545151 = 1.939583904,\n$$\n所以\n$$\nf_1 = \\exp(x_{\\mathrm{L}}) = \\exp(1.939583904) = 6.95581\\,\\mathrm{kHz}.\n$$\n\n较高的半功率频率 $f_2$：\n- 在较高的一侧，振幅在 $(f, A) = (9.0\\,\\mathrm{kHz}, 15.5\\,\\mathrm{nm})$ 和 $(10.0\\,\\mathrm{kHz}, 12.0\\,\\mathrm{nm})$ 之间包围了 $A_{\\text{half}}$。当 $x = \\ln f$ 时，\n$$\nx_1' = \\ln(9.0), \\quad x_2' = \\ln(10.0), \\quad A_1' = 15.5, \\quad A_2' = 12.0.\n$$\n令 $t_{\\mathrm{U}} = \\dfrac{A_{\\text{half}} - A_1'}{A_2' - A_1'} = \\dfrac{14.14213562 - 15.5}{12.0 - 15.5} = 0.38796125.$ 则\n$$\nx_{\\mathrm{U}} = x_1' + t_{\\mathrm{U}}(x_2' - x_1') = \\ln(9.0) + 0.38796125\\left[\\ln(10.0) - \\ln(9.0)\\right].\n$$\n从数值上看，\n$$\n\\ln(9.0) = 2.197224577,\\quad \\ln(10.0) = 2.302585093,\\quad x_{\\mathrm{U}} = 2.197224577 + 0.38796125\\cdot 0.105360516 = 2.238100375,\n$$\n所以\n$$\nf_2 = \\exp(x_{\\mathrm{U}}) = \\exp(2.238100375) = 9.37544\\,\\mathrm{kHz}.\n$$\n\n- 计算半功率带宽和 $Q$：\n$$\n\\mathrm{BW} = f_2 - f_1 = 9.37544\\,\\mathrm{kHz} - 6.95581\\,\\mathrm{kHz} = 2.41963\\,\\mathrm{kHz}.\n$$\n使用推导出的关系 $Q = \\dfrac{f_c}{\\mathrm{BW}}$，其中 $f_c = 8.0\\,\\mathrm{kHz}$，\n$$\nQ = \\frac{8.0\\,\\mathrm{kHz}}{2.41963\\,\\mathrm{kHz}} = 3.3063\\ldots\n$$\n四舍五入到 $4$ 位有效数字得到\n$$\nQ = 3.306.\n$$\n\n使用的假设及其理由：\n- 在测试的驱动水平下，BM 在近线性区域工作，因此测得的位移振幅与局部传递函数的大小成正比。\n- 近峰值响应可以很好地用一个轻阻尼二阶 LTI 谐振器来近似，通过半功率定义可以得出关系 $Q = f_c/\\mathrm{BW}$。\n- 在采样点之间对 $\\ln f$ 进行插值，近似了在最佳频率附近的耳蜗调谐中观察到的对数频率上局部平滑、近似对称的响应。\n- 半功率准则使用 $A_{\\text{half}} = A_{\\max}/\\sqrt{2}$，因为功率与正弦振幅的平方成正比，半功率点对应于振幅 $-3\\,\\mathrm{dB}$ 的变化。", "answer": "$$\\boxed{3.306}$$", "id": "5007420"}, {"introduction": "现代听觉生理学最重要的发现之一是，耳蜗并非一个被动的滤波器，而是一个主动的、非线性的放大器，它能够将微弱的声音信号放大。这个被称为“耳蜗放大器”的机制赋予了我们听觉系统极高的灵敏度和宽广的动态范围。本高级练习 [@problem_id:5007423] 将带你深入这一核心机制，运用非线性动力学中的一个强大工具——霍普夫分岔 (Hopf bifurcation) 范式——来为耳蜗放大器的关键特性（增益和压缩性非线性）建立模型。这个练习不仅是一个理论推导，更要求你通过编程实现数值求解，从而亲身体验如何用抽象的数学模型捕捉并量化复杂的生理功能。", "problem": "构建一个独立的通用程序，该程序使用分岔点附近的超临界霍普夫振子的规范型来模拟由正弦激励驱动的主动耳蜗放大器。目标是从第一性原理推导稳态输入-输出振幅关系，并在中等输入强度下数值上证明压缩非线性。\n\n从与听觉生理学和力学相关的基本原理出发：\n- 线性声学：作用于鼓膜的正弦声压通过中耳力学传递，可以表示为作用于单个耳蜗位置的等效正弦力。将此等效驱动振幅视为一个标量输入大小，记为 $F \\ge 0$（无量纲）。\n- 牛顿力学和动力系统：在主动生物系统（例如外毛细胞(OHC)-基底膜(BM)微域）中，振荡起始附近的运动可以通过中心流形方法简化为一个具有三次非线性的复振幅方程。用 $z(t) \\in \\mathbb{C}$ 表示耳蜗位置的复响应振幅。\n- 作为失谐的频率拓扑：位置依赖的固有频率将耳蜗位置映射到特征频率。在单位置简化模型中，固有频率与激励频率之间的失谐体现为一个实数参数 $\\Delta$。\n\n模型假设：\n- 使用复振幅 $z(t)$ 的受迫霍普夫规范型：系统处于一个由实数参数 $\\mu$（无量纲）控制的霍普夫分岔点附近，并受到角频率为 $\\omega$、复振幅为 $F e^{i \\omega t}$ 的正弦外部驱动。令 $\\omega_0$ 表示耳蜗位置的固有角频率，并将失谐定义为 $\\Delta = \\omega_0 - \\omega$（在此公式中通过适当的标度变换已为无量纲）。\n- 假设在锁定状态下，系统在驱动频率处存在时间谐波稳态同步。定义稳态输出振幅为 $r = |a|$，其中 $z(t) = a e^{i \\omega t}$ 是锁定于激励的复响应。\n\n任务：\n1. 从受迫霍普夫规范型和稳态锁定拟设出发，推导一个联系稳态输出振幅 $r$、输入力大小 $F$、分岔参数 $\\mu$ 和失谐 $\\Delta$ 的标量代数方程。不要使用任何快捷公式；从动力学方程开始，系统地简化为标量振幅方程。\n2. 解析地证明，在近临界操作和共振时（$\\mu \\approx 0$, $\\Delta \\approx 0$），输入-输出关系在中等振幅下表现出压缩性增长，其特征是输入指数小于1。\n3. 实现一个数值求解器，给定 $(\\mu, \\Delta)$ 和一个输入振幅列表 $F$，通过求解推导出的标量方程来计算物理相关的稳态 $r$。解的选择必须在不同 $F$ 值之间保持一致（即在 $F$ 上的延拓），并且必须返回非负实数 $r$。\n4. 对下面的每个测试用例，计算三个指定输入大小下的振幅，以及两个中等输入之间的对数-对数斜率，该斜率定义为 $s = \\dfrac{\\ln r_2 - \\ln r_1}{\\ln F_2 - \\ln F_1}$，其中 $(F_1, F_2)$ 是中等输入。所有量均为无量纲。\n\n测试套件（无量纲参数）：\n- 用例1：近临界，共振。$\\mu = 0$, $\\Delta = 0$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$；计算并报告 $F = 10^{-6}$, $10^{-4}$, $10^{-2}$ 时的 $r$，以及 $F_1 = 10^{-4}$ 和 $F_2 = 10^{-2}$ 之间的斜率 $s$。\n- 用例2：近临界，轻微失谐。$\\mu = 0$, $\\Delta = 0.3$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$；输出相同。\n- 用例3：亚临界（分岔点以下），共振。$\\mu = -0.05$, $\\Delta = 0$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$；输出相同。\n- 用例4：超临界（分岔点以上），共振。$\\mu = 0.05$, $\\Delta = 0$, $F \\in \\{10^{-6}, 10^{-4}, 10^{-2}, 10^{-1}\\}$；输出相同。\n\n答案规格：\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例产生一个包含四个无量纲浮点数的列表，顺序为 $[r(F{=}10^{-6}), r(F{=}10^{-4}), r(F{=}10^{-2}), s]$。对于上述四个用例，最终输出必须是形如 $[[\\dots],[\\dots],[\\dots],[\\dots]]$ 的单行，且不含空格。", "solution": "### 1. 输入-输出振幅方程的推导\n\n起点是受迫超临界霍普夫振子的规范型，它描述了特定耳蜗位置处复响应振幅 $z(t)$ 的动力学：\n$$\n\\frac{dz}{dt} = (\\mu + i\\omega_0)z - |z|^2 z + F e^{i\\omega t}\n$$\n此处，$z(t) \\in \\mathbb{C}$ 是响应的复振幅。参数 $\\mu$ 是实数分岔参数，控制系统离振荡阈值（霍普夫分岔）的接近程度。当 $\\mu  0$ 时，系统是一个阻尼振子；当 $\\mu > 0$ 时，它是一个具有稳定极限环的主动振子。参数 $\\omega_0$ 是特定耳蜗位置处振子的固有角频率。项 $-|z|^2 z$ 是确保超临界分岔的最低阶非线性饱和项。系统由一个大小为 $F$、角频率为 $\\omega$ 的外部正弦力驱动。\n\n我们寻找一个与驱动力锁相的稳态解。这种解的形式是在驱动频率 $\\omega$ 处的时间谐波响应：\n$$\nz(t) = a e^{i\\omega t}\n$$\n其中 $a \\in \\mathbb{C}$ 是一个表示稳态复振幅的常数复数。响应的大小为 $r = |a|$。\n\n为了找到关于 $a$ 的方程，我们将拟设代入动力学方程。拟设的时间导数是：\n$$\n\\frac{dz}{dt} = \\frac{d}{dt}(a e^{i\\omega t}) = i\\omega a e^{i\\omega t}\n$$\n将此式和 $z(t)$ 代入主方程可得：\n$$\ni\\omega a e^{i\\omega t} = (\\mu + i\\omega_0)(a e^{i\\omega t}) - |a e^{i\\omega t}|^2 (a e^{i\\omega t}) + F e^{i\\omega t}\n$$\n项 $|a e^{i\\omega t}|^2$ 简化为 $|a|^2 |e^{i\\omega t}|^2 = |a|^2 \\cdot 1 = r^2$。所有项中的公因子 $e^{i\\omega t}$ 可以消去，留下一个关于 $a$ 的代数方程：\n$$\ni\\omega a = (\\mu + i\\omega_0)a - r^2 a + F\n$$\n重新整理各项以求解 $F$：\n$$\nF = a (i\\omega - (\\mu + i\\omega_0) + r^2)\n$$\n$$\nF = a (-\\mu + r^2 + i(\\omega - \\omega_0))\n$$\n使用失谐参数的定义 $\\Delta = \\omega_0 - \\omega$，我们有 $\\omega - \\omega_0 = -\\Delta$。方程变为：\n$$\nF = a (-\\mu + r^2 - i\\Delta)\n$$\n为了得到关于实振幅 $r = |a|$ 的标量方程，我们取两边的模：\n$$\n|F| = |a| |-\\mu + r^2 - i\\Delta|\n$$\n由于 $F$ 是一个非负实数量值，$|F| = F$。右侧复数的模为 $\\sqrt{(r^2 - \\mu)^2 + (-\\Delta)^2}$。这得到：\n$$\nF = r \\sqrt{(r^2 - \\mu)^2 + \\Delta^2}\n$$\n两边平方以消去平方根，我们得到联系输出振幅 $r$、输入大小 $F$ 及系统参数 $\\mu$ 和 $\\Delta$ 的最终标量代数方程：\n$$\nF^2 = r^2 [ (r^2 - \\mu)^2 + \\Delta^2 ]\n$$\n这个方程是关于 $x = r^2$ 的三次多项式：\n$$\nx [ (x - \\mu)^2 + \\Delta^2 ] = F^2\n$$\n$$\nx [ x^2 - 2\\mu x + \\mu^2 + \\Delta^2 ] = F^2\n$$\n$$\nx^3 - 2\\mu x^2 + (\\mu^2 + \\Delta^2)x - F^2 = 0\n$$\n这就完成了第一项任务。\n\n### 2. 压缩非线性的解析证明\n\n为证明压缩性增长，我们分析在近临界（$\\mu \\approx 0$）和共振（$\\Delta \\approx 0$）条件下的输入-输出关系 $r(F)$。在推导出的振幅方程中令 $\\mu = 0$ 和 $\\Delta = 0$：\n$$\nF^2 = r^2 [ (r^2 - 0)^2 + 0^2 ]\n$$\n$$\nF^2 = r^2 (r^4) = r^6\n$$\n由于 $F$ 和 $r$ 是非负实数振幅，我们可以取此方程的正实根：\n$$\nr = (F^2)^{1/6} = F^{1/3}\n$$\n这建立了一个指数为 $\\alpha = 1/3$ 的幂律关系 $r \\propto F^\\alpha$。由于指数 $\\alpha  1$，输出振幅 $r$ 的增长慢于输入振幅 $F$。这就是压缩非线性的定义。线性系统的指数为 $\\alpha = 1$。\n\n输入-输出函数的对数-对数斜率定义为 $s = d(\\ln r)/d(\\ln F)$，它量化了压缩的程度。对于这个理想情况：\n$$\ns = \\frac{d(\\ln(F^{1/3}))}{d(\\ln F)} = \\frac{d(\\frac{1}{3}\\ln F)}{d(\\ln F)} = \\frac{1}{3}\n$$\n这个 $1/3$ 的恒定斜率是霍普夫放大器恰好在其临界点工作的标志。对于小的非零 $\\mu$ 和 $\\Delta$，系统在极低输入水平下表现出线性行为（$r \\propto F$, $s=1$），并在中到高输入水平下过渡到这种压缩行为（$r \\propto F^{1/3}$, $s \\approx 1/3$）。这就完成了第二项任务。\n\n### 3. 数值解法与实现\n\n第三和第四项任务要求为给定的参数 $(\\mu, \\Delta, F)$ 实现一个关于 $x = r^2$ 的三次方程的数值求解器，并为测试套件计算指定的量。\n\n数值计算步骤如下：\n1.  对于一组给定的参数 $(\\mu, \\Delta, F)$，构造三次多项式 $P(x) = x^3 - 2\\mu x^2 + (\\mu^2 + \\Delta^2)x - F^2$ 的系数。这些系数是 $[1, -2\\mu, \\mu^2 + \\Delta^2, -F^2]$。\n2.  使用标准的数值求根算法（例如 `numpy.roots` 提供的算法）求解方程 $P(x)=0$ 的三个根。\n3.  $x$ 的根可能是复数。由于 $x = r^2$ 且 $r$ 是一个实的非负振幅，我们必须筛选这些根，只选择那些实的非负根。使用一个小的数值容差来识别实根（即虚部接近零的根）。\n4.  在某些参数区域（特别是在 $\\mu > 0$ 和小 $F$ 的情况下），系统可能是双稳态的，导致 $x$ 有多个正实根。问题要求一个一致的选择规则。我们采纳选择最大正实根的标准惯例。这对应于稳定的高振幅响应分支，通常是主动放大器所关注的状态。\n5.  利用选定的根 $x_{sol}$，最终振幅计算为 $r = \\sqrt{x_{sol}}$。\n6.  对每个所需的输入振幅 $F$ 重复此过程。然后根据其定义 $s = (\\ln r_2 - \\ln r_1) / (\\ln F_2 - \\ln F_1)$，使用在指定的中等输入下计算出的振幅来计算对数-对数斜率 $s$。\n\n下面的程序实现了这一逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_hopf_amplitude(mu, delta, F):\n    \"\"\"\n    Solves for the steady-state amplitude r of a forced Hopf oscillator.\n    \n    The relationship between input F and output r is given by:\n    r^2 * [ (r^2 - mu)^2 + delta^2 ] = F^2\n\n    This is equivalent to a cubic equation in x = r^2:\n    x^3 - 2*mu*x^2 + (mu^2 + delta^2)*x - F^2 = 0\n    \n    Args:\n        mu (float): The bifurcation parameter.\n        delta (float): The detuning parameter.\n        F (float): The input force magnitude.\n\n    Returns:\n        float: The steady-state output amplitude r.\n    \"\"\"\n    F_sq = F**2\n    coeffs = [1.0, -2.0 * mu, mu**2 + delta**2, -F_sq]\n    \n    roots = np.roots(coeffs)\n    \n    # Filter for real, non-negative roots for x = r^2.\n    # A small tolerance is used for floating point comparisons.\n    real_non_negative_roots_x = []\n    for root in roots:\n        if abs(np.imag(root))  1e-12 and np.real(root) >= -1e-12:\n            real_non_negative_roots_x.append(np.real(root))\n    \n    if not real_non_negative_roots_x:\n        # This case is physically unexpected but handled for robustness.\n        return np.nan\n\n    # Select the physically relevant root. For a forced active oscillator, \n    # the largest real root corresponds to the stable, high-amplitude response branch.\n    # This provides a consistent selection rule as required.\n    x_sol = np.max(real_non_negative_roots_x)\n    \n    r = np.sqrt(x_sol)\n    return r\n\ndef calculate_log_log_slope(F1, r1, F2, r2):\n    \"\"\"Calculates the log-log slope s.\"\"\"\n    if r1 = 0 or r2 = 0 or F1 = 0 or F2 = 0:\n        return np.nan\n    s = (np.log(r2) - np.log(r1)) / (np.log(F2) - np.log(F1))\n    return s\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and format the output.\n    \"\"\"\n    test_cases = [\n        # (mu, delta)\n        (0.0, 0.0),    # Case 1: near-critical, on-resonance\n        (0.0, 0.3),    # Case 2: near-critical, slight detuning\n        (-0.05, 0.0),  # Case 3: subcritical, on-resonance\n        (0.05, 0.0)    # Case 4: supercritical, on-resonance\n    ]\n\n    F_report = [1e-6, 1e-4, 1e-2]\n    F1_slope, F2_slope = 1e-4, 1e-2\n\n    all_results = []\n    for mu, delta in test_cases:\n        # Calculate r for all required F values efficiently using a dictionary\n        F_values_needed = sorted(list(set(F_report + [F1_slope, F2_slope])))\n        r_values = {F: solve_hopf_amplitude(mu, delta, F) for F in F_values_needed}\n\n        # Extract values for the slope calculation\n        r1_slope = r_values[F1_slope]\n        r2_slope = r_values[F2_slope]\n        \n        # Calculate the slope\n        s = calculate_log_log_slope(F1_slope, r1_slope, F2_slope, r2_slope)\n        \n        # Assemble the list of results for the current case in the specified order\n        case_result = [r_values[F_report[0]], r_values[F_report[1]], r_values[F_report[2]], s]\n        all_results.append(case_result)\n\n    # Format the final output string according to the specification:\n    # A list of lists, with no spaces, e.g., [[r1,r2,s1],[r3,r4,s2]]\n    case_strs = []\n    for res_list in all_results:\n        # Use repr() for full precision floating point representation\n        inner_list_str = \",\".join(map(repr, res_list))\n        case_strs.append(f\"[{inner_list_str}]\")\n    \n    final_output = f\"[{','.join(case_strs)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "5007423"}]}