{"hands_on_practices": [{"introduction": "床旁头脉冲试验是区分中枢性和外周性眩晕的有力工具，但其精确解读有赖于对前庭-眼动反射（VOR）神经回路的深刻理解。本练习旨在通过预测和解释脑干病变（核间性眼肌麻痹）与外周迷路病变在头脉冲试验中的不同表现，来强化对中枢通路精细解剖的掌握，从而提升临床诊断的精确性。[@problem_id:5011350]", "problem": "一位检查者在水平半规管平面上对两名不同的患者进行床边甩头试验，同时分别记录每只眼睛的运动。患者X因内侧纵束病变，临床和放射学上确诊为右侧核间性眼肌麻痹（INO）。患者Y患有急性、孤立性右侧单侧外周前庭功能减退，与前庭神经炎一致。假设甩头是围绕垂直轴的小振幅、高加速度、不可预测的旋转，且患者注视远处目标以最小化视轴辐辏需求。检查者施加了相等次数的向右和向左的甩头。\n\n从以下基本原理出发：(i) 半规管传入神经编码头部角速度，(ii) 水平前庭-眼动反射（VOR）旨在通过产生与头部角速度大小近似相等、方向相反的眼球角速度来最小化视网膜滑移，(iii) 外展神经核包含支配同侧外直肌的运动神经元，以及通过内侧纵束（MLF）投射到对侧动眼神经核以激活内直肌的核间神经元，通过分析中枢前庭回路，推断患者X和患者Y的VOR增益和追赶扫视模式将有何不同。\n\n在本问题中，将每只眼睛的瞬时VOR增益定义为 $g = \\omega_{\\mathrm{eye}} / \\omega_{\\mathrm{head}}$，其中常规符号被省略，因此理想补偿对应于 $g \\approx 1$，而功能缺陷对应于 $g  1$。在甩头动作完成后发生的追赶扫视称为显性扫视；在甩头过程中发生的称为隐性扫视。检查者的主要观察点是双眼的功能缺陷是联动的还是分离的，以及它是否取决于特定眼睛所需的内收与外展运动。\n\n哪个选项最能预测患者X和患者Y的预期模式，并提供正确的机制？\n\nA. 患者X（右侧INO）：向右甩头时（需要眼球向左旋转），右眼（内收眼）的增益 $g  1$ 并伴有显性/隐性追赶扫视，而左眼（外展眼）的增益 $g \\approx 1$；向左甩头时，双眼增益均为 $g \\approx 1$。患者Y（右侧外周性功能减退）：向右甩头时，双眼增益均降低至 $g  1$ 并伴有显性/隐性追赶扫视；向左甩头时，双眼增益均为 $g \\approx 1$。机制：INO选择性地破坏了MLF中通向对侧内直肌的核间通路，但保留了外展神经的运动输出；外周性病变减少了右侧水平半规管的传入驱动，降低了向病变侧甩头时的双侧VOR输出，但保持了联动性。\n\nB. 患者X（右侧INO）：由于中枢性病变，向右和向左甩头时双侧均出现对称性的增益 $g$ 降低并伴有显性追赶扫视；患者Y（右侧外周性功能减退）：向右甩头时出现分离性VOR，右眼选择性受损，因为迷路仅驱动同侧眼睛。机制：中枢性病变导致普遍的VOR衰竭，而外周输入是针对特定眼睛的。\n\nC. 患者X（右侧INO）：所有甩头脉冲的水平VOR均正常，因为VOR是一种绕过中枢通路的反射；患者Y（右侧外周性功能减退）：由于前庭核中的双侧连合抑制，双向增益 $g$ 均降低。机制：水平VOR反应不需要MLF，但单侧外周性病变会全面抑制VOR。\n\nD. 患者X（右侧INO）：向右甩头时，由于耳石-眼动耦合，主要出现垂直矫正扫视，水平增益正常；患者Y（右侧外周性功能减退）：由于中枢代偿，水平增益正常，但出现朝向病变侧的扭转性追赶扫视。机制：INO主要影响垂直凝视耦合；外周性功能减退在高加速度下不影响水平增益。", "solution": "该问题陈述经评估为有效。它科学地基于神经耳科学的既定原则，问题设置良好，具有明确定义的条件和患者病理，并以客观、正式的语言表达。所提供的基本原则是准确的，足以推导出唯一的解决方案。\n\n问题要求根据前庭-眼动反射（VOR）的基本原理，预测两名患者在水平甩头试验（hHIT）中的结果。\n\n**基本原理和通路**\n\n水平VOR的三神经元弧是需要考虑的主要通路。\n1.  **传入神经元：** 来自水平半规管的初级传入神经元从前庭（Scarpa's）神经节投射到脑干中同侧的前庭核。其放电频率编码头部角速度 $\\omega_{\\mathrm{head}}$。当头部向同侧旋转时，该神经元兴奋。\n2.  **核间神经元：** 前庭核中的兴奋性神经元穿过中线，投射到对侧的外展神经核。\n3.  **运动神经元：** 外展神经核包含两个关键的神经元群：\n    *   **运动神经元**，通过外展神经（第六对脑神经）投射，支配同侧的外直肌，引起眼球外展。\n    *   **核间神经元**，通过对侧的内侧纵束（MLF）投射到动眼神经核（第三对脑神经）的内直肌亚核。这会激活对侧的内直肌，引起眼球内收。\n\nVOR的目标是产生一个眼球角速度 $\\omega_{\\mathrm{eye}}$，其大小与头部角速度 $\\omega_{\\mathrm{head}}$ 相等，方向相反。增益 $g = \\omega_{\\mathrm{eye}} / \\omega_{\\mathrm{head}}$（符号约定已省略）应约为 $1$。增益小于 $1$（$g  1$）表示VOR功能缺陷，导致视网膜图像滑移，并需要一次矫正性的“追赶”扫视来重新将目标置于中央凹。\n\n**患者X分析：右侧核间性眼肌麻痹（INO）**\n\n患者X的病变位于**右侧MLF**。该病变特异性地中断了从**左侧外展神经核间神经元**到**右侧动眼神经核**的通路。该通路对于激活**右侧内直肌**以进行内收至关重要。\n\n*   **情况1：向右甩头**\n    *   **头部运动：** 头部向右旋转。\n    *   **VOR目标：** 双眼必须向左旋转以保持注视。这需要**左外直肌（LLR）**和**右内直肌（RMR）**的收缩。\n    *   **神经通路：**\n        1.  右侧水平半规管兴奋。\n        2.  右侧前庭核兴奋性地投射到对侧（左侧）的外展神经核。\n        3.  左侧外展神经核：\n            *   激活其运动神经元，使LLR收缩（左眼外展）。此通路完好无损。\n            *   激活其核间神经元，这些神经元通过**右侧MLF**向上发送信号到右侧动眼神经核以激活RMR。\n    *   **病变影响：** 右侧MLF受损。到右内直肌的信号被阻断或严重减弱。\n    *   **预测结果：**\n        *   **左眼（外展眼）：** 到LLR的通路是完好的。左眼将以正常增益（$g \\approx 1$）外展。\n        *   **右眼（内收眼）：** 到RMR的通路被中断。右眼将无法内收或内收非常缓慢。其增益将显著小于 $1$（$g  1$）。需要右眼的追赶扫视（显性或隐性）才能将视线移至目标。\n        *   **总结：** 分离性VOR缺陷，表现为内收的右眼特定功能衰竭。\n\n*   **情况2：向左甩头**\n    *   **头部运动：** 头部向左旋转。\n    *   **VOR目标：** 双眼必须向右旋转。这需要**右外直肌（RLR）**和**左内直肌（LMR）**的收缩。\n    *   **神经通路：**\n        1.  左侧水平半规管兴奋。\n        2.  左侧前庭核投射到对侧（右侧）的外展神经核。\n        3.  右侧外展神经核：\n            *   激活其运动神经元，使RLR收缩（右眼外展）。\n            *   激活其核间神经元，这些神经元通过**左侧MLF**向上发送信号到左侧动眼神经核以激活LMR。\n    *   **病变影响：** 病变位于右侧MLF。该通路使用右侧外展神经核和左侧MLF，两者均完好无损。\n    *   **预测结果：** 两条通路功能正常。双眼将以正常增益（$g \\approx 1$）联动地向右旋转。预计不会出现追赶扫视。\n\n**患者Y分析：急性右侧单侧外周前庭功能减退**\n\n患者Y来自右侧前庭迷路的传入信号有缺陷。假定中枢通路完好。hHIT是一种高加速度测试，VOR反应主要由对侧迷路的兴奋驱动（Ewald第二定律）。\n\n*   **情况1：向右甩头（朝向病变侧）**\n    *   **头部运动：** 头部向右旋转。\n    *   **VOR目标：** 眼球向左旋转。\n    *   **神经通路：** 这个运动应该兴奋右侧水平半规管。\n    *   **病变影响：** 右侧迷路功能减退。用于此运动的兴奋性传入信号微弱或缺失。整个VOR回路的驱动严重减少。\n    *   **预测结果：**\n        *   来自右侧前庭核的微弱信号被传输到左侧外展神经核，后者接着驱动左外直肌和（通过MLF）右内直肌。\n        *   由于初始驱动不足，对*双侧*肌肉的指令都不充分。\n        *   双眼转动将滞后于头部转动。VOR增益将双侧、联动地降低（双眼 $g  1$）。\n        *   这将需要联动的、向左的追赶扫视（显性或隐性）来重新注视目标。\n\n*   **情况2：向左甩头（远离病变侧）**\n    *   **头部运动：** 头部向左旋转。\n    *   **VOR目标：** 眼球向右旋转。\n    *   **神经通路：** 这个运动会兴奋健康的**左侧水平半规管**。它也会抑制右侧半规管，但由于右侧半规管已经功能失常，与来自左侧的强烈兴奋性驱动相比，抑制的丧失可以忽略不计。\n    *   **病变影响：** 这个VOR的主要驱动信号来自完好的左侧迷路。\n    *   **预测结果：**\n        *   来自左侧前庭核的强烈信号为右侧外展神经核提供了足够的驱动，后者进而正确地驱动右外直肌和左内直肌。\n        *   VOR反应将是稳健和有效的。\n        *   双眼增益将接近正常（$g \\approx 1$）。预计不会出现追赶扫视。\n\n**选项评估**\n\n*   **A. 患者X（右侧INO）：向右甩头时（需要眼球向左旋转），右眼（内收眼）的增益 $g  1$ 并伴有显性/隐性追赶扫视，而左眼（外展眼）的增益 $g \\approx 1$；向左甩头时，双眼增益均为 $g \\approx 1$。患者Y（右侧外周性功能减退）：向右甩头时，双眼增益均降低至 $g  1$ 并伴有显性/隐性追赶扫视；向左甩头时，双眼增益均为 $g \\approx 1$。机制：INO选择性地破坏了MLF中通向对侧内直肌的核间通路，但保留了外展神经的运动输出；外周性病变减少了右侧水平半规管的传入驱动，降低了向病变侧甩头时的双侧VOR输出，但保持了联动性。**\n    *   此选项与上述对患者X和患者Y的详细推断完全吻合。所述机制正是正确的神经生理学解释。\n    *   **结论：正确。**\n\n*   **B. 患者X（右侧INO）：由于中枢性病变，向右和向左甩头时双侧均出现对称性的增益 $g$ 降低并伴有显性追赶扫视；患者Y（右侧外周性功能减退）：向右甩头时出现分离性VOR，右眼选择性受损，因为迷路仅驱动同侧眼睛。**\n    *   对患者X的预测不正确。INO中的VOR缺陷是分离性的且具有方向特异性，而非双侧对称的。对患者Y的预测也不正确。外周前庭功能丧失导致联动性缺陷，并且迷路输入分布于双眼的肌肉，而不仅仅是同侧眼。机制有缺陷。\n    *   **结论：不正确。**\n\n*   **C. 患者X（右侧INO）：所有甩头脉冲的水平VOR均正常，因为VOR是一种绕过中枢通路的反射；患者Y（右侧外周性功能减退）：由于前庭核中的双侧连合抑制，双向增益 $g$ 均降低。**\n    *   VOR绕过像MLF这样的中枢通路这一前提根本上是错误的。MLF对于协同双眼运动至关重要。对患者Y的预测也是错误的；对于高频甩头，缺陷的特征是单向性的。\n    *   **结论：不正确。**\n\n*   **D. 患者X（右侧INO）：向右甩头时，由于耳石-眼动耦合，主要出现垂直矫正扫视，水平增益正常；患者Y（右侧外周性功能减退）：由于中枢代偿，水平增益正常，但出现朝向病变侧的扭转性追赶扫视。**\n    *   对患者X的预测不正确。hHIT会引发水平内收缺陷和水平追赶扫视。对于内收眼，水平增益正常的说法是错误的。对患者Y的预测不正确。在急性期，中枢代偿尚未发生，而甩头试验正是为了揭示这种低增益。缺陷发生在水平半规管平面，因此扫视应该是水平的。\n    *   **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "5011350"}, {"introduction": "中枢通路不仅是信号的中继站，更是信号处理器。本练习将耳石-脊髓反射建模为一个包含多个处理阶段和特定增益的定量系统。通过从给定的感觉输入（耳石信号）计算最终的运动输出（肌肉激活），学习者将亲身体会中枢神经系统如何转换前庭信号以实现姿势控制。[@problem_id:5011366]", "problem": "一个受试者相对于重力方向静态向右滚转倾斜 $10$度。考虑从椭圆囊耳石传入神经，经由前庭外侧核，到前庭外侧束 (LVST)，再到同侧伸肌运动神经元的通路。对于中小编幅的静态滚转倾斜，请使用以下基于实验的建模假设：\n1. 耳石器官转导沿椭圆囊毛细胞极化轴的重力加速度分量，椭圆囊传入神经放电频率的变化与该分量成正比。对于围绕鼻枕轴的纯滚转倾斜，当参考重力向量时，相关分量与滚转角的正弦值成比例。\n2. 在此工作点附近，椭圆囊传入神经群体的有效静态敏感度为 $S_{\\text{ot}} = 60\\,\\text{Hz}/g$，其中 $g$ 是重力加速度的大小。\n3. 投射到LVST的前庭外侧核中的二级神经元以群体增益 $G_{\\text{v}} = 0.4$（每单位传入放电频率变化的输出放电频率变化）来中继椭圆囊的输入。\n4. 在小输入下，同侧伸肌运动神经元的激活（归一化为无量纲的基线分数）随LVST放电频率线性增加，增益为 $G_{\\text{m}} = 0.03\\,\\text{activation}/\\text{Hz}$。\n5. 倾斜幅度足够小，可以忽略正弦依赖性之外的饱和与非线性效应，并且椭圆囊敏感轴的排列使得滚转倾斜与椭圆囊分量最大程度地耦合。\n\n仅使用关于重力投影的第一性原理和上述参数，推导在向右滚转倾斜 $10$度的情况下，由LVST介导的同侧伸肌激活的预期增量。在进行任何三角函数计算时，将角度转换为弧度。最终答案以基线激活的无量纲小数值表示，并四舍五入到四位有效数字。", "solution": "该问题陈述经评估有效。它在科学上基于前庭神经生理学的原理，问题设定良好（well-posed），具有完整且一致的参数集，并且客观呈现。它描述了一个典型的耳石-脊髓反射模型，可以通过直接应用所提供的线性系统模型来解决。\n\n目标是计算由静态向右滚转倾斜引起的同侧伸肌激活的预期增量，记为 $\\Delta A_{\\text{m}}$。该问题可以建模为一个包含三个主要阶段的信号处理级联：椭圆囊耳石的感觉转导、前庭外侧核的中枢中继以及到伸肌的运动输出。\n\n给定的参数是：\n-   滚转倾斜角: $\\theta = 10^{\\circ}$\n-   椭圆囊传入敏感度: $S_{\\text{ot}} = 60\\,\\text{Hz}/g$\n-   前庭核增益: $G_{\\text{v}} = 0.4$\n-   运动神经元增益: $G_{\\text{m}} = 0.03\\,\\text{activation}/\\text{Hz}$\n\n推导过程沿着反射通路分步进行。\n\n**步骤1：椭圆囊耳石的感觉转导**\n\n椭圆囊耳石器官感知线性加速度。对于静态头部倾斜，相关刺激是重力加速度向量 $\\vec{g}$ 在椭圆囊毛细胞敏感轴上的投影。问题陈述指出，对于一个角度为 $\\theta$ 的纯滚转倾斜，刺激椭圆囊的加速度分量由 $a_{\\text{stim}} = g \\sin(\\theta)$ 给出，其中 $g = |\\vec{g}|$ 是重力加速度的大小。\n\n传入敏感度 $S_{\\text{ot}}$ 定义为每单位加速度（其中单位是 $g$ 本身）的放电频率变化。为了计算传入放电频率的变化 $\\Delta f_{\\text{ot}}$，我们必须首先用 $g$ 的单位来表示刺激加速度。\n$$\na_g = \\frac{a_{\\text{stim}}}{g} = \\frac{g \\sin(\\theta)}{g} = \\sin(\\theta)\n$$\n这个量 $a_g$ 是刺激加速度的一个无量纲度量。椭圆囊传入放电频率的变化即为敏感度与这个无量纲刺激大小的乘积。\n$$\n\\Delta f_{\\text{ot}} = S_{\\text{ot}} \\cdot a_g = S_{\\text{ot}} \\sin(\\theta)\n$$\n\n**步骤2：前庭外侧核 (LVN) 的中枢中继**\n\n来自椭圆囊传入神经的放电频率变化 $\\Delta f_{\\text{ot}}$ 被传递到LVN中的二级神经元。这些构成前庭外侧束 (LVST) 的神经元以指定的群体增益 $G_{\\text{v}}$ 来中继该信号。因此，LVST神经元放电频率的变化 $\\Delta f_{\\text{LVST}}$ 为：\n$$\n\\Delta f_{\\text{LVST}} = G_{\\text{v}} \\cdot \\Delta f_{\\text{ot}}\n$$\n代入步骤1中 $\\Delta f_{\\text{ot}}$ 的表达式：\n$$\n\\Delta f_{\\text{LVST}} = G_{\\text{v}} S_{\\text{ot}} \\sin(\\theta)\n$$\n\n**步骤3：同侧伸肌运动神经元的激活**\n\nLVST投射并兴奋同侧伸肌运动神经元。这些运动神经元归一化激活的增量 $\\Delta A_{\\text{m}}$ 与LVST放电频率的变化成线性比例，增益为 $G_{\\text{m}}$。\n$$\n\\Delta A_{\\text{m}} = G_{\\text{m}} \\cdot \\Delta f_{\\text{LVST}}\n$$\n代入步骤2中 $\\Delta f_{\\text{LVST}}$ 的表达式，得到肌肉激活变化量关于初始倾斜角和系统增益的完整表达式：\n$$\n\\Delta A_{\\text{m}} = G_{\\text{m}} (G_{\\text{v}} S_{\\text{ot}} \\sin(\\theta)) = G_{\\text{m}} G_{\\text{v}} S_{\\text{ot}} \\sin(\\theta)\n$$\n这个最终的符号表达式代表了静态滚转倾斜的反射通路的总增益。\n\n**数值计算**\n\n我们给定的数值是：\n-   $G_{\\text{m}} = 0.03\\,\\text{activation}/\\text{Hz}$\n-   $G_{\\text{v}} = 0.4$\n-   $S_{\\text{ot}} = 60\\,\\text{Hz}/g$\n-   $\\theta = 10^{\\circ}$\n\n问题要求在进行三角函数计算时将角度转换为弧度，这是标准做法。$\\sin(10^{\\circ})$ 等价于 $\\sin(\\frac{10\\pi}{180}) = \\sin(\\frac{\\pi}{18})$。\n\n将数值代入推导出的方程：\n$$\n\\Delta A_{\\text{m}} = (0.03) \\cdot (0.4) \\cdot (60) \\cdot \\sin(10^{\\circ})\n$$\n首先，计算增益的乘积：\n$$\nG_{\\text{m}} \\cdot G_{\\text{v}} \\cdot S_{\\text{ot}} = 0.03 \\cdot 0.4 \\cdot 60 = 0.012 \\cdot 60 = 0.72\n$$\n这个组合增益的单位是 $(\\text{activation}/\\text{Hz}) \\cdot (\\text{无量纲}) \\cdot (\\text{Hz}/g) = \\text{activation}/g$。由于刺激是以 $g$ 的无量纲分数（即 $\\sin(\\theta)$）表示的，因此最终的激活值也是无量纲的，符合要求。\n\n现在，我们完成计算：\n$$\n\\Delta A_{\\text{m}} = 0.72 \\cdot \\sin(10^{\\circ})\n$$\n$\\sin(10^{\\circ})$ 的值约等于 $0.17364817766$。\n$$\n\\Delta A_{\\text{m}} \\approx 0.72 \\cdot 0.17364817766 \\approx 0.1250266879\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$2$、$5$ 和 $0$。第五位数字是 $2$，所以我们不进位。\n$$\n\\Delta A_{\\text{m}} \\approx 0.1250\n$$\n这是预期的同侧伸肌激活的增量，表示为基线的无量纲分数。", "answer": "$$\n\\boxed{0.1250}\n$$", "id": "5011366"}, {"introduction": "现代神经科学越来越依赖计算方法来关联大脑结构与功能。本练习模拟了一个真实的研究场景，要求学习者利用神经影像数据（病变掩模）来量化关键通路（内侧纵束）的解剖损伤，并据此预测临床症状。这项实践将抽象的神经解剖知识与数据驱动的临床科学应用联系起来。[@problem_id:5011376]", "problem": "给定代表一个病灶和一个内侧纵束 (MLF) 的二进制三维掩模，它们位于一个标准磁共振成像 (MRI) 空间中的公共体素网格上。在中枢前庭通路的背景下，MLF 在脑干中整合前庭和眼动信号；涉及 MLF 的病灶通常与核间性眼肌麻痹相关。您必须编写一个程序，对于每个测试用例，计算被病灶重叠的 MLF 体素的比例，然后使用一个简单的逻辑斯蒂模型来预测核间性眼肌麻痹的概率。所有计算都必须以小数形式表示，而不是百分比。\n\n基本原理和定义：\n- 二进制掩模是在一个公共有限体素网格上的函数 $M: \\mathbb{Z}^3 \\to \\{0,1\\}$。对于本问题，一个掩模由其形状 $\\left(s_x, s_y, s_z\\right)$（其中 $s_x, s_y, s_z \\in \\mathbb{Z}_{0}$）以及其值为 $1$ 的索引集合完全指定。\n- 设 $V_{\\mathrm{MLF}} = \\{ \\mathbf{v} \\in \\mathbb{Z}^3 \\mid M_{\\mathrm{MLF}}(\\mathbf{v}) = 1 \\}$ 为 MLF 中的体素集合， $V_{\\mathrm{lesion}} = \\{ \\mathbf{v} \\in \\mathbb{Z}^3 \\mid M_{\\mathrm{lesion}}(\\mathbf{v}) = 1 \\}$ 为病灶中的体素集合。\n- 重叠分数定义为\n$$\nx \\equiv \\frac{\\left| V_{\\mathrm{MLF}} \\cap V_{\\mathrm{lesion}} \\right|}{\\left| V_{\\mathrm{MLF}} \\right|},\n$$\n并且必须报告为一个在 $[0,1]$ 区间内、四舍五入到 $6$ 位小数的十进制数。\n- 逻辑斯蒂模型通过逻辑斯蒂 (S型) 函数将线性预测器映射到概率。给定系数 $\\beta_0$ 和 $\\beta_1$，预测概率为\n$$\np \\equiv \\frac{1}{1 + \\exp\\!\\left(-\\left(\\beta_0 + \\beta_1 \\, x \\right)\\right)}.\n$$\n使用 $\\beta_0 = -3$ 和 $\\beta_1 = 6$。将 $p$ 报告为一个在 $[0,1]$ 区间内、四舍五入到 $6$ 位小数的十进制数。\n\n约束和假设：\n- 所有掩模都在同一网格上，并使用从零开始的整数坐标索引。\n- 所有体素体积相等；不需要物理单位。\n- 不涉及角度。\n- 不会发生除以零的情况，因为在所有提供的测试用例中 $\\left| V_{\\mathrm{MLF}} \\right| \\ge 1$。\n\n测试套件：\n对于每个测试用例，会给出形状 $\\left(s_x,s_y,s_z\\right)$ 和两组激活体素索引：一组用于病灶掩模，另一组用于 MLF 掩模。每个索引都是一个三元组 $(i,j,k)$，其中 $0 \\le i  s_x$, $0 \\le j  s_y$, $0 \\le k  s_z$。\n\n- 测试用例 1：\n  - 形状：$(2,2,2)$。\n  - 病灶体素：$\\{(0,0,0),(0,1,1)\\}$。\n  - MLF 体素：$\\{(0,0,0),(1,1,1)\\}$。\n\n- 测试用例 2：\n  - 形状：$(2,2,2)$。\n  - 病灶体素：$\\{(1,1,1)\\}$。\n  - MLF 体素：$\\{(0,0,0)\\}$。\n\n- 测试用例 3：\n  - 形状：$(2,2,2)$。\n  - 病灶体素：$\\{(0,0,0),(0,1,0),(1,1,1),(1,0,1)\\}$。\n  - MLF 体素：$\\{(0,0,0),(0,1,0),(1,1,1)\\}$。\n\n- 测试用例 4：\n  - 形状：$(3,3,1)$。\n  - 病灶体素：$\\{(0,1,0),(1,2,0),(0,0,0)\\}$。\n  - MLF 体素：$\\{(0,1,0),(1,1,0),(1,2,0),(2,2,0)\\}$。\n\n- 测试用例 5：\n  - 形状：$(2,3,2)$。\n  - 病灶体素：$\\{(0,1,0),(1,1,1),(0,2,0)\\}$。\n  - MLF 体素：$\\{(0,0,0),(0,1,0),(0,2,1),(1,0,1),(1,2,0)\\}$。\n\n您的程序必须为每个测试用例计算：\n- 如上所述的重叠分数 $x$，四舍五入到 $6$ 位小数；以及\n- 来自逻辑斯蒂模型的概率 $p$（其中 $\\beta_0=-3$ 和 $\\beta_1=6$），四舍五入到 $6$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果。结果是一个用方括号括起来的逗号分隔列表，其中每个测试用例的结果本身是一个形式为 $[x,p]$ 的双元素列表。每个数字都必须四舍五入到 $6$ 位小数，并以小数点后恰好 $6$ 位数字打印。输出中任何地方都不能有空格。\n- 例如，一个包含两个假设结果的有效输出为：$[[0.500000,0.500000],[0.000000,0.047426]]$。", "solution": "本问题陈述已经过严格验证。\n\n### 步骤1：提取给定信息\n- **体素集**：问题提供了病灶 $V_{\\mathrm{lesion}}$ 和内侧纵束 $V_{\\mathrm{MLF}}$ 的体素坐标集。这些是 $\\mathbb{Z}^3$ 的子集。\n- **重叠分数 ($x$)**：重叠分数定义为 MLF 和病灶共有的体素数量与 MLF 中总的体素数量之比。\n$$ x = \\frac{\\left| V_{\\mathrm{MLF}} \\cap V_{\\mathrm{lesion}} \\right|}{\\left| V_{\\mathrm{MLF}} \\right|} $$\n该值必须四舍五入到 $6$ 位小数。\n- **核间性眼肌麻痹的概率 ($p$)**：该概率使用逻辑斯蒂模型计算，指定系数为 $\\beta_0 = -3$ 和 $\\beta_1 = 6$。\n$$ p = \\frac{1}{1 + \\exp\\!\\left(-\\left(\\beta_0 + \\beta_1 \\, x \\right)\\right)} $$\n该值也必须四舍五入到 $6$ 位小数。\n- **约束**：保证 MLF 体素的数量至少为一个，即 $\\left| V_{\\mathrm{MLF}} \\right| \\ge 1$，从而避免了除以零的情况。\n- **测试数据**：提供了五个测试用例，每个用例都有特定的形状以及病灶和 MLF 体素的整型坐标集。\n\n### 步骤2：使用提取的信息进行验证\n根据既定标准对问题进行评估：\n- **科学性**：该问题植根于神经解剖学、神经病学和医学图像分析中的有效概念。使用二进制掩模、体积重叠和逻辑斯蒂回归来建模病灶-症状关系是标准的、科学上合理的方法。\n- **良构性**：问题定义明确。它提供了计算每个测试用例唯一解所需的所有必要数据（体素集）、数学公式、常数（$\\beta_0$, $\\beta_1$）和约束。\n- **客观性**：问题以精确、正式的语言陈述，没有主观性或模糊性。\n\n该问题不存在科学上不健全、不完整、矛盾或不可行等任何缺陷。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将根据提供的规范来开发解决方案。\n\n### 基于原则的设计与解决方案\n任务是为每个测试用例计算两个量：病灶-MLF 重叠分数 $x$ 和来自逻辑斯蒂模型的相应概率 $p$。该解决方案是集合论和函数求值的直接应用。\n\n**1. 重叠分数 ($x$) 的计算**\n输入提供了 MLF 体素集 $V_{\\mathrm{MLF}}$ 和病灶体素集 $V_{\\mathrm{lesion}}$。计算分三步进行：\n- 首先，通过计算集合中元素的数量来确定 MLF 体素集的大小 $\\left| V_{\\mathrm{MLF}} \\right|$。\n- 其次，计算两个集合的交集 $V_{\\mathrm{MLF}} \\cap V_{\\mathrm{lesion}}$。结果集只包含同时存在于 MLF 和病灶中的体素。\n- 第三，确定该交集的大小 $\\left| V_{\\mathrm{MLF}} \\cap V_{\\mathrm{lesion}} \\right|$。\n- 最后，通过将交集的大小除以 MLF 集的大小来计算重叠分数 $x$。\n$$\nx = \\frac{\\left| V_{\\mathrm{MLF}} \\cap V_{\\mathrm{lesion}} \\right|}{\\left| V_{\\mathrm{MLF}} \\right|}\n$$\n问题保证 $\\left| V_{\\mathrm{MLF}} \\right| \\ge 1$，因此该除法总是有定义的。\n\n**2. 概率 ($p$) 的计算**\n概率 $p$ 由逻辑斯蒂 (S型) 函数确定。首先使用先前计算的重叠分数 $x$ 和给定的系数 $\\beta_0 = -3$ 和 $\\beta_1 = 6$ 来计算线性预测器 $z = \\beta_0 + \\beta_1 x$。\n$$\nz = -3 + 6x\n$$\n然后将该值代入逻辑斯蒂函数：\n$$\np(z) = \\frac{1}{1 + e^{-z}} = \\frac{1}{1 + \\exp(-(-3 + 6x))}\n$$\n指数函数 $e^y$ 表示为 $\\exp(y)$。\n\n**3. 实现与示例计算**\n让我们用测试用例 1 进行演示：\n- $V_{\\mathrm{lesion}} = \\{(0,0,0), (0,1,1)\\}$\n- $V_{\\mathrm{MLF}} = \\{(0,0,0), (1,1,1)\\}$\n\n首先，我们计算重叠分数 $x$：\n- MLF 集的大小为 $\\left| V_{\\mathrm{MLF}} \\right| = 2$。\n- 交集为 $V_{\\mathrm{MLF}} \\cap V_{\\mathrm{lesion}} = \\{(0,0,0)\\}$。\n- 交集的大小为 $\\left| V_{\\mathrm{MLF}} \\cap V_{\\mathrm{lesion}} \\right| = 1$。\n- 重叠分数为 $x = \\frac{1}{2} = 0.5$。\n\n接下来，我们计算概率 $p$：\n- 线性预测器为 $z = -3 + 6 \\times 0.5 = -3 + 3 = 0$。\n- 概率为 $p = \\frac{1}{1 + \\exp(-0)} = \\frac{1}{1+1} = 0.5$。\n\n然后，根据要求将结果 $x$ 和 $p$ 都格式化为 $6$ 位小数，分别得到 $0.500000$ 和 $0.500000$。对所有测试用例重复此过程。在实现中，体素坐标将存储在 Python `set` 对象中，以利用其高效的交集操作。将使用 `numpy` 库来进行指数函数计算，该库为数值计算进行了优化。最终的数值结果将格式化为字符串，以确保小数点后恰好有六位数字。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the MLF-lesion overlap fraction and predicts the probability\n    of internuclear ophthalmoplegia for a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing two sets of voxel coordinates:\n    # (lesion_voxels, mlf_voxels)\n    test_cases = [\n        (   # Test Case 1\n            {(0, 0, 0), (0, 1, 1)},\n            {(0, 0, 0), (1, 1, 1)},\n        ),\n        (   # Test Case 2\n            {(1, 1, 1)},\n            {(0, 0, 0)},\n        ),\n        (   # Test Case 3\n            {(0, 0, 0), (0, 1, 0), (1, 1, 1), (1, 0, 1)},\n            {(0, 0, 0), (0, 1, 0), (1, 1, 1)},\n        ),\n        (   # Test Case 4\n            {(0, 1, 0), (1, 2, 0), (0, 0, 0)},\n            {(0, 1, 0), (1, 1, 0), (1, 2, 0), (2, 2, 0)},\n        ),\n        (   # Test Case 5\n            {(0, 1, 0), (1, 1, 1), (0, 2, 0)},\n            {(0, 0, 0), (0, 1, 0), (0, 2, 1), (1, 0, 1), (1, 2, 0)},\n        ),\n    ]\n\n    # Parameters for the logistic model\n    beta0 = -3.0\n    beta1 = 6.0\n\n    formatted_results = []\n    \n    for lesion_voxels, mlf_voxels in test_cases:\n        # Calculate the number of voxels in the MLF.\n        # The problem guarantees this is = 1.\n        num_mlf_voxels = len(mlf_voxels)\n        \n        # Calculate the number of overlapping voxels.\n        # Set intersection is used for efficiency.\n        num_overlap_voxels = len(mlf_voxels.intersection(lesion_voxels))\n        \n        # Calculate the overlap fraction, x.\n        x = num_overlap_voxels / num_mlf_voxels\n        \n        # Calculate the probability, p, using the logistic model.\n        linear_predictor = beta0 + beta1 * x\n        p = 1.0 / (1.0 + np.exp(-linear_predictor))\n        \n        # Format the results as a string \"[x,p]\" with 6 decimal places.\n        result_pair_str = f\"[{x:.6f},{p:.6f}]\"\n        formatted_results.append(result_pair_str)\n\n    # Final print statement in the exact required format.\n    # The output is a single string representing a list of lists, with no spaces.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "5011376"}]}