{"hands_on_practices": [{"introduction": "滑动气管成形术的一个直接几何结果是狭窄节段的缩短。本练习旨在分离并量化这一个因素的影响，从而建立对基础物理原理的理解。通过将手术操作与一个清晰的物理结果——气流阻力的成比例降低——联系起来，此练习运用哈根-泊肃叶定律（Hagen-Poiseuille law），阐明了在不考虑管径变化的情况下，气管长度的减少是如何直接转化为呼吸功的降低的[@problem_id:5071528]。", "problem": "一名患有长段性先天性气管狭窄的儿科患者接受了滑动气管成形术。术前，狭窄段的长度为 $L_{s} = 40~\\mathrm{mm}$。术后，修复段的长度为 $L_{r} = 20~\\mathrm{mm}$（这反映了将气管的一半滑到另一半上所带来的特有的节段性缩短）。为了单独分析长度变化对流动阻力的力学影响，我们假设气流为稳态、层流、不可压缩的牛顿流体，其动力黏度 $\\mu$ 恒定，管段为半径固定的刚性圆形管腔 $r$，且入口和出口损失可忽略不计。在层流条件下（低雷诺数(Re)），通过圆柱形管段的气道阻力与长度成线性关系，与半径的四次方成反比。\n\n从这些基本的流体力学事实出发，推导节段性阻力与节段长度之间的关系，并计算：\n1) 气管节段长度的相对缩短率，定义为 $\\frac{L_{s} - L_{r}}{L_{s}}$，以及\n2) 完全由该长度变化引起的节段性流动阻力的相对降低率，定义为 $\\frac{R_{s} - R_{r}}{R_{s}}$，其中 $R$ 表示在上述假设下的节段性阻力。\n\n将这两个量表示为无单位的小数或精确分数。无需四舍五入。将最终答案表示为一个双元素行矩阵，第一个元素为相对缩短率，第二个元素为阻力相对降低率。", "solution": "首先验证问题的科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n- 术前狭窄段长度：$L_{s} = 40~\\mathrm{mm}$。\n- 术后修复段长度：$L_{r} = 20~\\mathrm{mm}$。\n- 流体（空气）假设为动力黏度 $\\mu$ 恒定的牛顿流体。\n- 流动假设为稳态、层流且不可压缩。\n- 气管段被建模为半径固定的刚性圆形管腔 $r$。\n- 入口和出口损失被视为可忽略不计。\n- 阻力缩放定律：气道阻力 $R$ 与管段长度 $L$ 成线性关系，与半径 $r$ 的四次方成反比。\n- 长度相对缩短率的定义：$\\frac{L_{s} - L_{r}}{L_{s}}$。\n- 阻力相对降低率的定义：$\\frac{R_{s} - R_{r}}{R_{s}}$。\n\n### 步骤 2：使用已知条件进行验证\n该问题科学上基于流体动力学原理，特别是关于层流通过圆柱形管道的哈根-泊肃叶定律。关于滑动气管成形术导致节段性缩短的描述在临床上是准确的。该问题提法严谨，为待计算的量提供了所有必要数据和明确定义。所做的假设（如半径 $r$ 固定）被明确说明，旨在分离出长度变化的影响，这是物理建模中的一种标准且有效的方法。该问题是客观的，没有歧义，并且不违反任何基本原理。\n\n### 步骤 3：结论与行动\n该问题被认定为有效。将提供解答。\n\n### 解题推导\n问题指出，对于通过刚性圆柱形管的稳态、层流、不可压缩流动，流动阻力 $R$ 与管段长度 $L$ 成线性关系，与其半径 $r$ 的四次方成反比。这可以表示为比例关系：\n$$\nR \\propto \\frac{L}{r^4}\n$$\n这个关系是管道流动的哈根-泊肃叶方程的基石，其中阻力 $R$（定义为压降 $\\Delta P$ 与体积流量 $Q$ 的比值）由下式给出：\n$$\nR = \\frac{\\Delta P}{Q} = \\frac{8 \\mu L}{\\pi r^4}\n$$\n我们可以引入一个比例常数 $k = \\frac{8\\mu}{\\pi}$，它包含了流体性质（$\\mu$）和几何横截面因子（$\\pi$）。因此，阻力可以写成：\n$$\nR = k \\frac{L}{r^4}\n$$\n问题要求我们评估*仅*长度变化的影响。这需要我们保持所有其他变量不变。具体来说，为了本次分析的目的，假设半径 $r$ 在手术前后是固定的。\n\n与狭窄段长度 $L_s$ 对应的术前节段性阻力 $R_s$ 为：\n$$\nR_s = k \\frac{L_s}{r^4}\n$$\n与修复段长度 $L_r$ 对应的术后节段性阻力 $R_r$ 为：\n$$\nR_r = k \\frac{L_r}{r^4}\n$$\n\n我们需要计算两个量。\n\n**1) 气管节段长度的相对缩短率：**\n其定义为 $\\frac{L_{s} - L_{r}}{L_{s}}$。代入给定值 $L_s = 40~\\mathrm{mm}$ 和 $L_r = 20~\\mathrm{mm}$：\n$$\n\\text{Fractional shortening} = \\frac{40 - 20}{40} = \\frac{20}{40} = \\frac{1}{2} = 0.5\n$$\n这是一个无量纲的量。\n\n**2) 节段性流动阻力的相对降低率：**\n其定义为 $\\frac{R_{s} - R_{r}}{R_{s}}$。为了推导该量与几何参数之间的关系，我们代入 $R_s$ 和 $R_r$ 的表达式：\n$$\n\\text{Fractional resistance reduction} = \\frac{R_{s} - R_{r}}{R_{s}} = \\frac{k \\frac{L_s}{r^4} - k \\frac{L_r}{r^4}}{k \\frac{L_s}{r^4}}\n$$\n常数项 $k \\frac{1}{r^4}$ 可以从分子和分母中提出：\n$$\n\\frac{k \\frac{1}{r^4} (L_s - L_r)}{k \\frac{1}{r^4} L_s}\n$$\n消去公因子 $k \\frac{1}{r^4}$ 后得到：\n$$\n\\text{Fractional resistance reduction} = \\frac{L_s - L_r}{L_s}\n$$\n该推导表明，在特定假设（层流、半径恒定）下，阻力的相对降低率与长度的相对缩短率是相同的。这是阻力 $R$ 与长度 $L$ 之间线性关系的直接结果。\n\n现在，我们计算数值：\n$$\n\\text{Fractional resistance reduction} = \\frac{40 - 20}{40} = \\frac{20}{40} = \\frac{1}{2} = 0.5\n$$\n两个量都等于 $0.5$。最终答案应以一个双元素行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5  0.5\n\\end{pmatrix}\n}\n$$", "id": "5071528"}, {"introduction": "在前一个练习的基础上，本练习引入了降低阻力的第二个也是更强大的机制：管腔扩大。它要求学习者同时考虑长度缩短和半径增加的综合效应，并强调由于阻力与半径的四次方（$R \\propto 1/r^4$）成反比，半径的变化起着主导作用[@problem_id:5071558]。此外，该练习通过区分“面积加倍”与“直径加倍”这两种常见的模糊表述，澄清了一个重要的概念，这对于精确评估手术效果至关重要。", "problem": "一名患有先天性长段气管狭窄的新生儿计划进行滑动气管成形术。假设气流为稳定层流，并将狭窄段建模为长度为 $L_0$、半径为 $r_0$ 的刚性圆柱管。流阻由 Hagen–Poiseuille 关系定义，因此 $R \\propto L/r^4$。滑动气管成形术既能缩短狭窄段，又能扩大管腔。考虑在外科描述中常常被混淆的两种几何结果：(i) 简单的面积加倍，意味着横截面积增加到原来的2倍（因此 $A_1=2A_0$）；以及 (ii) 直径加倍，意味着直径增加到原来的2倍（因此 $d_1=2d_0$）。在这两种情况下，假设通过滑动操作，有效狭窄长度减少到 $L_1=L_0/2$。仅使用第一性原理（Hagen–Poiseuille 和 $A=\\pi r^2$, $d=2r$），判断哪个陈述正确地区分了这两种几何变化，并量化了由此产生的阻力比 $R_1/R_0$。\n\nA. 在 $L_1=L_0/2$ 的情况下，面积加倍得到 $R_1/R_0=1/8$，直径加倍得到 $R_1/R_0=1/32$；这种区别的产生是因为 $A\\propto r^2$ 且 $R\\propto L/r^4$，所以面积加倍意味着 $r_1=\\sqrt{2}\\,r_0$，而直径加倍意味着 $r_1=2r_0$。\n\nB. 在 $L_1=L_0/2$ 的情况下，面积加倍得到 $R_1/R_0=1/4$，直径加倍得到 $R_1/R_0=1/8$，因为阻力与 $r^2$ 成反比，而不是 $r^4$。\n\nC. 在 $L_1=L_0/2$ 的情况下，面积加倍和直径加倍都产生 $R_1/R_0=1/16$，因为当流动是层流时，阻力仅取决于横截面积，而不取决于长度。\n\nD. 在 $L_1=L_0/2$ 的情况下，增加半径的好处被长度的缩短所抵消，因此面积加倍和直径加倍都将阻力减小到相同的比率 $R_1/R_0=1/2$。\n\nE. 在 $L_1=L_0/2$ 的情况下，面积加倍产生 $R_1/R_0=1/8$，但直径加倍会引发湍流，在临床气流条件下，这会抵消任何超过 $R_1/R_0=1/8$ 的额外阻力降低。", "solution": "首先对问题陈述的科学合理性、一致性和完整性进行验证。\n\n### 步骤1：提取已知条件\n- 流动条件：稳定层流。\n- 初始狭窄段模型：刚性圆柱管。\n- 初始长度：$L_0$。\n- 初始半径：$r_0$。\n- 初始横截面积：$A_0 = \\pi r_0^2$。\n- 初始直径：$d_0 = 2r_0$。\n- 流阻关系：$R \\propto L/r^4$（源自 Hagen–Poiseuille）。\n- 术后长度：$L_1 = L_0/2$。\n- 情况 (i) - 面积加倍：$A_1 = 2A_0$。\n- 情况 (ii) - 直径加倍：$d_1 = 2d_0$。\n- 基本几何关系：$A = \\pi r^2$, $d = 2r$。\n- 目标：计算两种情况下的阻力比 $R_1/R_0$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。它将流体力学的一个基本原理——Hagen–Poiseuille 定律——应用于一个生物医学情景。刚性管和稳定层流的假设是为创建一个可处理的第一性原理问题而做的标准简化。该问题是适定的，提供了计算唯一解所需的所有信息。其陈述客观，并使用了精确的数学定义。没有内部矛盾或事实错误。面积加倍和直径加倍之间的区别是一个关键的概念点，在尺度分析中是有效且重要的。\n\n### 步骤3：结论与行动\n问题陈述有效。将推导解答。\n\n### 推导\n流阻 $R$ 由 Hagen–Poiseuille 关系给出，表述为比例关系：\n$$ R \\propto \\frac{L}{r^4} $$\n这可以用一个比例常数 $k$ 来表示：\n$$ R = k \\frac{L}{r^4} $$\n狭窄段的初始阻力 $R_0$ 为：\n$$ R_0 = k \\frac{L_0}{r_0^4} $$\n滑动气管成形术后的最终阻力 $R_1$ 为：\n$$ R_1 = k \\frac{L_1}{r_1^4} $$\n因此，最终阻力与初始阻力之比 $R_1/R_0$ 为：\n$$ \\frac{R_1}{R_0} = \\frac{k L_1 / r_1^4}{k L_0 / r_0^4} = \\left(\\frac{L_1}{L_0}\\right) \\left(\\frac{r_0}{r_1}\\right)^4 $$\n问题陈述长度减半，所以 $L_1 = L_0/2$，或 $L_1/L_0 = 1/2$。将此代入比例方程，得到：\n$$ \\frac{R_1}{R_0} = \\frac{1}{2} \\left(\\frac{r_0}{r_1}\\right)^4 $$\n我们现在分析两种指定的几何结果。\n\n**情况 (i): 面积加倍**\n在这种情况下，最终横截面积 $A_1$ 是初始面积 $A_0$ 的两倍。\n$$ A_1 = 2 A_0 $$\n使用圆面积公式 $A=\\pi r^2$：\n$$ \\pi r_1^2 = 2 (\\pi r_0^2) $$\n$$ r_1^2 = 2 r_0^2 $$\n$$ r_1 = \\sqrt{2} \\, r_0 $$\n现在，我们将 $r_1$ 的这个关系式代入阻力比方程：\n$$ \\frac{R_1}{R_0} = \\frac{1}{2} \\left(\\frac{r_0}{\\sqrt{2} \\, r_0}\\right)^4 = \\frac{1}{2} \\left(\\frac{1}{\\sqrt{2}}\\right)^4 $$\n$$ \\left(\\frac{1}{\\sqrt{2}}\\right)^4 = \\frac{1}{(\\sqrt{2})^4} = \\frac{1}{(2^{1/2})^4} = \\frac{1}{2^2} = \\frac{1}{4} $$\n因此，对于面积加倍的情况：\n$$ \\frac{R_1}{R_0} = \\frac{1}{2} \\times \\frac{1}{4} = \\frac{1}{8} $$\n\n**情况 (ii): 直径加倍**\n在这种情况下，最终直径 $d_1$ 是初始直径 $d_0$ 的两倍。\n$$ d_1 = 2 d_0 $$\n使用直径和半径之间的关系 $d=2r$：\n$$ 2 r_1 = 2 (2 r_0) $$\n$$ r_1 = 2 r_0 $$\n我们将 $r_1$ 的这个新关系式代入阻力比方程：\n$$ \\frac{R_1}{R_0} = \\frac{1}{2} \\left(\\frac{r_0}{2 r_0}\\right)^4 = \\frac{1}{2} \\left(\\frac{1}{2}\\right)^4 $$\n$$ \\left(\\frac{1}{2}\\right)^4 = \\frac{1}{16} $$\n因此，对于直径加倍的情况：\n$$ \\frac{R_1}{R_0} = \\frac{1}{2} \\times \\frac{1}{16} = \\frac{1}{32} $$\n\n分析证实，由于阻力对半径的强依赖性（$R \\propto r^{-4}$），这两种情况产生的阻力降低效果大不相同。\n\n### 逐项分析选项\n\n**A. 在 $L_1=L_0/2$ 的情况下，面积加倍得到 $R_1/R_0=1/8$，直径加倍得到 $R_1/R_0=1/32$；这种区别的产生是因为 $A\\propto r^2$ 且 $R\\propto L/r^4$，所以面积加倍意味着 $r_1=\\sqrt{2}\\,r_0$，而直径加倍意味着 $r_1=2r_0$。**\n该陈述计算出的阻力比 $R_1/R_0 = 1/8$（面积加倍）和 $R_1/R_0 = 1/32$（直径加倍）与我们的推导完全匹配。其提供的理由也是正确的：这种区别根植于面积（$A \\propto r^2$）和阻力（$R \\propto r^{-4}$）之间的非线性关系。它正确地指出了面积加倍意味着半径增加为原来的 $\\sqrt{2}$ 倍，而直径加倍意味着半径增加为原来的 $2$ 倍。\n**结论：正确。**\n\n**B. 在 $L_1=L_0/2$ 的情况下，面积加倍得到 $R_1/R_0=1/4$，直径加倍得到 $R_1/R_0=1/8$，因为阻力与 $r^2$ 成反比，而不是 $r^4$。**\n这里计算的阻力比是错误的。其提供的理由，$R \\propto r^{-2}$，明确地与问题陈述中给出的 Hagen–Poiseuille 关系（$R \\propto r^{-4}$）相矛盾。\n**结论：错误。**\n\n**C. 在 $L_1=L_0/2$ 的情况下，面积加倍和直径加倍都产生 $R_1/R_0=1/16$，因为当流动是层流时，阻力仅取决于横截面积，而不取决于长度。**\n该陈述提出了两个不正确的论点。首先，如推导所示，这两种情况产生不同的阻力比（$1/8$ 和 $1/32$）。其次，阻力与长度无关的理由与 Hagen–Poiseuille 关系（其中 $R \\propto L$）相矛盾。\n**结论：错误。**\n\n**D. 在 $L_1=L_0/2$ 的情况下，增加半径的好处被长度的缩短所抵消，因此面积加倍和直径加倍都将阻力减小到相同的比率 $R_1/R_0=1/2$。**\n该陈述是错误的。仅将长度缩短到 $L_1 = L_0/2$ 所带来的阻力降低就会导致 $R_1/R_0=1/2$。半径的任何增加都会进一步降低阻力。这些效应是相乘的，而不是相互抵消的。计算出的比率 $1/2$ 忽略了管腔扩大的显著好处，并且声称两种情况导致相同比率的说法是错误的。\n**结论：错误。**\n\n**E. 在 $L_1=L_0/2$ 的情况下，面积加倍产生 $R_1/R_0=1/8$，但直径加倍会引发湍流，在临床气流条件下，这会抵消任何超过 $R_1/R_0=1/8$ 的额外阻力降低。**\n虽然该陈述的第一部分（面积加倍得到 $R_1/R_0 = 1/8$）是正确的，但第二部分引入了一个物理现象——湍流，而问题的基本假设“假设稳定层流”已明确排除了这种情况。本题的任务是*仅*基于所提供的第一性原理和假设进行计算。该选项通过引入一个外部的、未说明的复杂性，违反了这一约束。因此，在问题的框架内，该陈述是无效的。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "5071558"}, {"introduction": "最后的这项练习代表了将前述原理综合应用于一个现代计算框架的实践。它超越了简单的代数计算，进入了一个模拟真实世界虚拟手术规划的复杂优化问题[@problem_id:5071515]。通过构建一个对不理想几何特征（如阶跃不连续性和不均匀性）进行惩罚的成本函数，本练习展示了流体动力学的基础物理原理如何能够指导临床背景下的复杂决策，从而将理论知识转化为解决实际问题的能力。", "problem": "您需要为滑片气管成形术构建一个虚拟手术规划优化器，该优化器由一个简化的、基于物理原理的气管内腔模型表示。该模型使用作为轴向坐标函数的术前半径轮廓，以及由切口长度和滑动向量引起的滑动和重叠的简化表示。您的程序必须搜索一个离散的参数网格，并选择能使一个成本泛函最小化的参数集，该泛函源于第一性原理以及经过充分验证的粘性流和几何连续性公式。所有距离必须以毫米表示，角度必须以度表示。最终输出必须是单行，其中包含每个测试用例的最优参数四元组列表，每个四元组以毫米和度为单位，其值为整数，格式为用方括号括起来的逗号分隔列表。\n\n模型与目标定义：\n- 设气管段的轴向坐标为 $z \\in [0,L]$，总长度 $L$ 以毫米为单位。\n- 设术前内腔半径由中段周围的平滑狭窄模型表示：\n$$\nr_0(z) \\;=\\; r_{\\mathrm{norm}} \\;-\\; \\left(r_{\\mathrm{norm}} - r_{\\min}\\right)\\exp\\!\\left(-\\dfrac{(z - L/2)^2}{2\\sigma^2}\\right),\n$$\n其中 $r_{\\mathrm{norm}}$ 是正常半径（毫米），$r_{\\min}$ 是中心处的最小半径（毫米），$\\sigma$ 是扩散参数（毫米）。函数 $r_0(z)$ 必须在 $[0,L]$ 上的一个包含 $N$ 个点的均匀网格上进行评估。\n- 手术操作由两个长度分别为 $l_p$（近端）和 $l_d$（远端）的纵向切口（以毫米为单位）以及一个轴向滑动幅度 $s$（以毫米为单位）来表示。近端切口跨越区间 $[0,l_p]$，远端切口跨越 $[L - l_d, L]$。将近端段滑动 $s$ 后，重叠区间 $[a,b]$ 作为以下两个区间的交集而产生：\n$$\n[a,b] \\;=\\; \\left([s,\\; s+l_p] \\cap [L-l_d,\\; L]\\right),\n$$\n重叠长度为 $l_o \\;=\\; \\max(0,\\; b-a)$。\n- 周向错位由一个旋转角度 $\\phi$（以度为单位）表示。定义重叠区域的面积增益因子为 $k(\\phi) \\;=\\; 1 + \\cos(\\phi^\\ast)$，其中 $\\phi^\\ast$ 是 $\\phi$ 转换为弧度的值，并且 $\\phi$ 被限制在 $[0^\\circ,90^\\circ]$ 范围内，因此 $k(\\phi)\\in[1,2]$。重叠区域的半径乘法因子为 $m(\\phi) \\;=\\; \\sqrt{k(\\phi)} \\in [1,\\sqrt{2}]$。\n- 术后半径轮廓 $r(z)$ 由分段函数定义如下：\n$$\nr(z) \\;=\\;\n\\begin{cases}\nm(\\phi)\\, r_0(z), & z \\in [a,b] \\text{ 且 } l_o > 0, \\\\\nr_0(z), & \\text{其他情况。}\n\\end{cases}\n$$\n- 成本泛函 $J$ 结合了：(i) 一个惩罚重叠边界处不连续性的阶跃项，(ii) 一个惩罚半径方差的均匀性项，以及 (iii) 一个惩罚最小半径不足的目标半径项。每个项都通过 $r_{\\mathrm{norm}}^2$ 进行无量纲化：\n    - 如果 $l_o \\le 0$，则设阶跃项 $S = 0$。否则，计算边界点 $a$ 和 $b$，并令\n    $$\n    \\Delta_1 \\;=\\; |m(\\phi)\\, r_0(a) - r_0(a)| \\;=\\; |(m(\\phi)-1)\\, r_0(a)|,\\quad\n    \\Delta_2 \\;=\\; |m(\\phi)\\, r_0(b) - r_0(b)| \\;=\\; |(m(\\phi)-1)\\, r_0(b)|,\n    $$\n    并定义\n    $$\n    S \\;=\\; \\dfrac{\\Delta_1^2 + \\Delta_2^2}{r_{\\mathrm{norm}}^2}.\n    $$\n    - 设 $U$ 为 $r(z)$ 在 $N$ 点网格上的总体方差：\n    $$\n    U \\;=\\; \\dfrac{\\mathrm{Var}(r(z))}{r_{\\mathrm{norm}}^2},\n    $$\n    其中 $\\mathrm{Var}$ 表示网格上与均值的离差平方的均值。\n    - 设 $r_{\\mathrm{min,post}} \\;=\\; \\min_{z} r(z)$。设目标半径惩罚为\n    $$\n    T \\;=\\; \\dfrac{\\max\\!\\left(0,\\; r_{\\mathrm{target}} - r_{\\mathrm{min,post}}\\right)^2}{r_{\\mathrm{norm}}^2}.\n    $$\n- 总成本为\n$$\nJ \\;=\\; w_S\\, S \\;+\\; w_U\\, U \\;+\\; w_T\\, T,\n$$\n其中 $w_S$、$w_U$ 和 $w_T$ 是非负权重。\n\n科学依据：\n- 根据关于圆柱管内层流不可压缩流动的 Hagen–Poiseuille 定律，压降与半径的四次方成反比，因此更大且更均匀的半径可以减少阻力。突然的扩张和收缩会产生局部损失，这些损失可以很好地通过面积比和不连续性幅度的函数来近似，这为对半径跳跃（阶跃）和空间方差施加惩罚提供了理由。因此，上述 $J$ 是一个有原则的替代指标，它鼓励平滑、均匀扩大的内腔轮廓，同时控制几何不连续性。\n\n优化与约束：\n- 在每个测试用例中给出的 $(l_p, l_d, s, \\phi)$ 的离散候选集中进行搜索。所有距离必须以毫米为单位，角度以度为单位。\n- 对于每个候选参数，计算定义的 $J$。选择具有最小 $J$ 的候选参数。当成本相同时，必须按以下顺序确定性地打破平局：\n    $1)$ 最小化 $l_p + l_d$， $2)$ 最小化 $s$， $3)$ 最小化 $\\phi$。\n- 为每个测试用例计算出的最优 $(l_p, l_d, s, \\phi)$ 必须作为整数以毫米和度为单位返回。\n\n测试套件：\n对于每个测试用例，在 $[0,L]$ 上使用一个包含 $N$ 个点的均匀网格来评估 $r_0(z)$ 和 $r(z)$。\n\n- 测试用例 1：\n    - $L \\!=\\! 30$, $r_{\\mathrm{norm}} \\!=\\! 4$, $r_{\\min} \\!=\\! 2$, $\\sigma \\!=\\! 5$, $r_{\\mathrm{target}} \\!=\\! 3$, $N \\!=\\! 301$.\n    - 权重: $w_S \\!=\\! 1.0$, $w_U \\!=\\! 0.2$, $w_T \\!=\\! 2.0$.\n    - 候选集:\n        - $l_p \\in \\{10,12,14\\}$,\n        - $l_d \\in \\{10,12,14\\}$,\n        - $s \\in \\{12,14,16\\}$,\n        - $\\phi \\in \\{0,30,60,90\\}$.\n\n- 测试用例 2：\n    - $L \\!=\\! 16$, $r_{\\mathrm{norm}} \\!=\\! 3.5$, $r_{\\min} \\!=\\! 1.5$, $\\sigma \\!=\\! 3.0$, $r_{\\mathrm{target}} \\!=\\! 2.5$, $N \\!=\\! 161$.\n    - 权重: $w_S \\!=\\! 0.5$, $w_U \\!=\\! 0.5$, $w_T \\!=\\! 1.0$.\n    - 候选集:\n        - $l_p \\in \\{6,8\\}$,\n        - $l_d \\in \\{6,8\\}$,\n        - $s \\in \\{6,8,10\\}$,\n        - $\\phi \\in \\{0,45,90\\}$.\n\n- 测试用例 3：\n    - $L \\!=\\! 24$, $r_{\\mathrm{norm}} \\!=\\! 4.5$, $r_{\\min} \\!=\\! 2.2$, $\\sigma \\!=\\! 4.0$, $r_{\\mathrm{target}} \\!=\\! 3.2$, $N \\!=\\! 241$.\n    - 权重: $w_S \\!=\\! 1.5$, $w_U \\!=\\! 0.1$, $w_T \\!=\\! 1.5$.\n    - 候选集:\n        - $l_p \\in \\{8,12\\}$,\n        - $l_d \\in \\{8,12,16\\}$,\n        - $s \\in \\{8,12\\}$,\n        - $\\phi \\in \\{0,30,60,90\\}$.\n\n- 测试用例 4：\n    - $L \\!=\\! 20$, $r_{\\mathrm{norm}} \\!=\\! 4.0$, $r_{\\min} \\!=\\! 3.0$, $\\sigma \\!=\\! 2.0$, $r_{\\mathrm{target}} \\!=\\! 3.5$, $N \\!=\\! 201$.\n    - 权重: $w_S \\!=\\! 2.0$, $w_U \\!=\\! 1.0$, $w_T \\!=\\! 0.5$.\n    - 候选集:\n        - $l_p \\in \\{6,10\\}$,\n        - $l_d \\in \\{6,10\\}$,\n        - $s \\in \\{4,8,12\\}$,\n        - $\\phi \\in \\{0,30,60,90\\}$.\n\n程序输出规范：\n- 您的程序必须使用成本 $J$ 为四个测试用例中的每一个计算出最优的 $(l_p, l_d, s, \\phi)$。角度单位是度，并且必须以度为单位返回。距离必须以毫米为单位。所有返回的值必须是整数。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个结果本身都是 $[l_p, l_d, s, \\phi]$ 形式的列表。例如：$[[10,12,14,0],[\\dots],[\\dots],[\\dots]]$。", "solution": "该问题已经过验证，被认为是合理的。它提出了一个基于简化的、但有物理原理的滑片气管成形术模型的适定优化任务。所有的定义、参数和约束都是自洽且数学上一致的。目标是找到最优的手术参数集，以最小化一个成本泛函，该泛函是术后呼吸功能的有原则的替代指标。\n\n解决方案是通过对每个测试用例提供的离散参数空间进行系统性的网格搜索来找到的。对于每个候选的手术参数集 $(l_p, l_d, s, \\phi)$，都会计算一个总成本 $J$。产生最小成本的参数集被选为最优解，并在成本相等的情况下应用特定的决胜规则。\n\n为单个候选参数 $(l_p, l_d, s, \\phi)$ 计算成本 $J$ 的过程如下：\n\n**1. 术前模型定义**\n首先，建立几何和物理背景。气管段沿轴向坐标 $z \\in [0,L]$ 定义。在此区间上生成一个包含 $N$ 个点的均匀网格。术前半径 $r_0(z)$ 是一个描述狭窄（收缩）区域的函数：\n$$\nr_0(z) \\;=\\; r_{\\mathrm{norm}} \\;-\\; \\left(r_{\\mathrm{norm}} - r_{\\min}\\right)\\exp\\!\\left(-\\dfrac{(z - L/2)^2}{2\\sigma^2}\\right)\n$$\n该函数在 $N$ 点网格上进行评估，以获得离散表示 $r_0[i]$，并且也被视为一个连续函数，用于评估非网格点。\n\n**2. 手术变换建模**\n手术过程通过其对气管几何形状的影响进行建模。\n- 重叠区间 $[a,b]$ 是滑动后的近端段的新位置与静态远端段的交集：\n$$\n[a,b] \\;=\\; \\left([s,\\; s+l_p] \\cap [L-l_d,\\; L]\\right)\n$$\n边界计算为 $a = \\max(s, L-l_d)$ 和 $b = \\min(s+l_p, L)$。重叠长度为 $l_o = \\max(0, b-a)$。\n- 周向错位 $\\phi$（以度为单位）决定了重叠区域内腔半径的增加量。这由半径乘法因子 $m(\\phi)$ 来量化：\n$$\nm(\\phi) \\;=\\; \\sqrt{1 + \\cos(\\phi^\\ast)}\n$$\n其中 $\\phi^\\ast$ 是角度 $\\phi$ 转换为弧度的值。\n\n**3. 术后半径轮廓**\n术后半径轮廓 $r(z)$ 是通过基于手术参数修改术前轮廓 $r_0(z)$ 来构建的。在重叠区域，半径通过因子 $m(\\phi)$ 增加：\n$$\nr(z) \\;=\\;\n\\begin{cases}\nm(\\phi)\\, r_0(z),  & z \\in [a,b] \\text{ 且 } l_o > 0 \\\\\nr_0(z),  & \\text{其他情况}\n\\end{cases}\n$$\n此计算在半径轮廓的离散网格表示上执行。\n\n**4. 成本泛函评估**\n总成本 $J$ 是三个项的加权和，$J = w_S S + w_U U + w_T T$，每一项都惩罚术后几何形状的一个不良特征。\n\n- **阶跃项 ($S$):** 此项惩罚重叠区域边界 $a$ 和 $b$ 处的不连续性。如果没有重叠（$l_o \\le 0$），则 $S=0$。否则：\n$$\n\\Delta_1^2 = \\left((m(\\phi)-1)\\, r_0(a)\\right)^2, \\quad \\Delta_2^2 = \\left((m(\\phi)-1)\\, r_0(b)\\right)^2\n$$\n$$\nS \\;=\\; \\dfrac{\\Delta_1^2 + \\Delta_2^2}{r_{\\mathrm{norm}}^2}\n$$\n使用 $r_0(z)$ 的连续函数来评估在精确位置 $a$ 和 $b$ 处的半径。\n\n- **均匀性项 ($U$):** 此项惩罚术后半径的非均匀性，鼓励更平滑的内腔。它是离散半径轮廓 $r[i]$ 的总体方差，并由 $r_{\\mathrm{norm}}^2$ 进行归一化：\n$$\nU \\;=\\; \\dfrac{\\mathrm{Var}(r[i])}{r_{\\mathrm{norm}}^2}\n$$\n\n- **目标半径项 ($T$):** 如果最小术后半径 $r_{\\mathrm{min,post}} = \\min_{i} r[i]$ 低于指定的目标半径 $r_{\\mathrm{target}}$，则此项施加惩罚。\n$$\nT \\;=\\; \\dfrac{\\max\\!\\left(0,\\; r_{\\mathrm{target}} - r_{\\mathrm{min,post}}\\right)^2}{r_{\\mathrm{norm}}^2}\n$$\n\n**5. 优化与决胜**\n算法遍历指定候选集中的每一个 $(l_p, l_d, s, \\phi)$ 组合。对于每个组合，计算总成本 $J$。导致最低成本的组合被选为最优解。为确保解的唯一性，成本 $J$ 的平局使用基于以下有序标准的字典序比较来解决：\n1.  最小化切口长度之和 $l_p + l_d$。\n2.  最小化滑动距离 $s$。\n3.  最小化旋转角度 $\\phi$。\n\n这是通过在所有候选参数中找到元组 $(J, l_p + l_d, s, \\phi)$ 的最小值来实现的。该实现过程遍历四个测试用例，为每个用例确定最优参数集。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Computes the optimal surgical parameters for slide tracheoplasty for a suite of test cases\n    by minimizing a cost functional over a discrete grid of candidate parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"params\": {\"L\": 30, \"r_norm\": 4, \"r_min\": 2, \"sigma\": 5, \"r_target\": 3, \"N\": 301},\n            \"weights\": {\"w_S\": 1.0, \"w_U\": 0.2, \"w_T\": 2.0},\n            \"candidates\": {\n                \"lp\": [10, 12, 14],\n                \"ld\": [10, 12, 14],\n                \"s\": [12, 14, 16],\n                \"phi\": [0, 30, 60, 90]\n            }\n        },\n        {\n            \"params\": {\"L\": 16, \"r_norm\": 3.5, \"r_min\": 1.5, \"sigma\": 3.0, \"r_target\": 2.5, \"N\": 161},\n            \"weights\": {\"w_S\": 0.5, \"w_U\": 0.5, \"w_T\": 1.0},\n            \"candidates\": {\n                \"lp\": [6, 8],\n                \"ld\": [6, 8],\n                \"s\": [6, 8, 10],\n                \"phi\": [0, 45, 90]\n            }\n        },\n        {\n            \"params\": {\"L\": 24, \"r_norm\": 4.5, \"r_min\": 2.2, \"sigma\": 4.0, \"r_target\": 3.2, \"N\": 241},\n            \"weights\": {\"w_S\": 1.5, \"w_U\": 0.1, \"w_T\": 1.5},\n            \"candidates\": {\n                \"lp\": [8, 12],\n                \"ld\": [8, 12, 16],\n                \"s\": [8, 12],\n                \"phi\": [0, 30, 60, 90]\n            }\n        },\n        {\n            \"params\": {\"L\": 20, \"r_norm\": 4.0, \"r_min\": 3.0, \"sigma\": 2.0, \"r_target\": 3.5, \"N\": 201},\n            \"weights\": {\"w_S\": 2.0, \"w_U\": 1.0, \"w_T\": 0.5},\n            \"candidates\": {\n                \"lp\": [6, 10],\n                \"ld\": [6, 10],\n                \"s\": [4, 8, 12],\n                \"phi\": [0, 30, 60, 90]\n            }\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        p = case[\"params\"]\n        w = case[\"weights\"]\n        c = case[\"candidates\"]\n\n        L, r_norm, r_min, sigma, r_target, N = p[\"L\"], p[\"r_norm\"], p[\"r_min\"], p[\"sigma\"], p[\"r_target\"], p[\"N\"]\n        w_S, w_U, w_T = w[\"w_S\"], w[\"w_U\"], w[\"w_T\"]\n\n        z_grid = np.linspace(0, L, N)\n        \n        def r0_func(z_val):\n            return r_norm - (r_norm - r_min) * np.exp(-(z_val - L / 2)**2 / (2 * sigma**2))\n\n        r0_grid = r0_func(z_grid)\n\n        best_key = (float('inf'), float('inf'), float('inf'), float('inf'))\n        best_params = None\n\n        candidate_params = list(itertools.product(c[\"lp\"], c[\"ld\"], c[\"s\"], c[\"phi\"]))\n\n        for lp, ld, s, phi in candidate_params:\n            # 1. Define overlap interval based on surgical parameters.\n            a = max(s, L - ld)\n            b = min(s + lp, L)\n            lo = max(0, b - a)\n\n            # 2. Calculate radius multiplicative factor from rotation angle.\n            phi_rad = np.deg2rad(phi)\n            m_phi = np.sqrt(1 + np.cos(phi_rad))\n\n            # 3. Construct the postoperative radius profile.\n            r_grid = np.copy(r0_grid)\n            if lo > 0:\n                mask = (z_grid >= a) & (z_grid = b)\n                r_grid[mask] *= m_phi\n\n            # 4. Calculate components of the cost functional.\n            # Step-off term S\n            if lo = 0:\n                S = 0.0\n            else:\n                r0_a = r0_func(a)\n                r0_b = r0_func(b)\n                delta1_sq = ((m_phi - 1) * r0_a)**2\n                delta2_sq = ((m_phi - 1) * r0_b)**2\n                S = (delta1_sq + delta2_sq) / r_norm**2\n            \n            # Uniformity term U (normalized variance)\n            U = np.var(r_grid) / r_norm**2\n            \n            # Target-radius term T (penalty for insufficient minimum radius)\n            r_min_post = np.min(r_grid)\n            T = (max(0, r_target - r_min_post)**2) / r_norm**2\n            \n            # 5. Compute the total cost J.\n            J = w_S * S + w_U * U + w_T * T\n            \n            # 6. Apply optimization criterion and tie-breaking rules.\n            current_key = (J, lp + ld, s, phi)\n            if current_key  best_key:\n                best_key = current_key\n                best_params = [int(lp), int(ld), int(s), int(phi)]\n        \n        all_results.append(best_params)\n\n    # Final print statement in the exact required format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "5071515"}]}