{"hands_on_practices": [{"introduction": "在文化精神医学领域，一项核心任务是区分文化上一致的信念与精神病性症状（如妄想）。本练习将帮助您运用一个结构化框架，通过特异性、坚信度和功能损害这几个关键维度进行鉴别。掌握这项技能对于避免误诊和提供具有文化胜任力的医疗服务至关重要。[@problem_id:4704040]", "problem": "文化精神病学的一项核心任务是区分文化一致的解释模型与精神病性妄想。请使用以下基本原则来推导出答案：《精神疾病诊断与统计手册》第五版修订本（DSM-5-TR）将妄想定义为一种固定的信念，即使面对相反的证据也不易改变，且通常不被当事人所在文化的其他成员所接受。《国际疾病分类》第十一版（ICD-11）同样将妄想视为与当事人的社会文化背景不符的、错误的、不可动摇的信念。在各个诊断系统中，临床显著性指的是在社交、职业或其他重要功能领域造成痛苦或损害。文化评估，包括文化形成访谈（CFI），通过确定一种信念是否在当事人的参照群体中被广泛共享、认可且在实践中起作用，来评估其文化一致性。根据这些原则，可以从三个轴向来区分文化共享的巫术信仰与精神病性妄想：特异性（文化共享度与个人独特性的对比）、固着性（对反证的抵抗程度）和功能损害（临床显著功能失调的程度）。\n你正在评估四位将近期不幸归因于巫术的患者。对于每位患者，假设一项合格的文化评估表明，在他们的参照社群中，巫术是一种被广泛共享和认可的解释模型。根据特异性、固着性和功能损害这三个轴向，哪个案例最有力地支持该信念是精神病性妄想，而非文化共享的信念？\n\n- A. 一名 $29$ 岁的 Yoruba 族女性，她认同一种与她家人对疾病的解释相似的巫术信念。她说：“我认为这可能是精神上的，也可能是医学上的；我既想要祈祷，也想要检查。”在讨论后，她能灵活地考虑其他可能的原因。她继续从事她的照护和市集工作，没有出现显著困难；主管报告其表现正常。\n\n- B. 一名 $40$ 岁的海地男子坚称，他的一位特定同事使用巫术在他左耳后植入了一个追踪设备，该设备将他的思想传输到互联网上。他所在 Vodou 社群的长者和同伴表示，他们的实践中没有这种具体的说法，并对他进行了劝告。他拒绝接受影像学检查或体格检查，声称“证据永远不会改变我的想法”，他大部分时间都在网上搜索“信号”，并因旷工和与人冲突而被解雇；他现在社交退缩，经济上依赖他人。\n\n- C. 一名 $35$ 岁的刚果女性，在一位兄弟姐妹去世后，担心家庭不和可能招致了巫术。在会谈中，她承认自己的悲伤，考虑将人际压力作为一个因素，接受了教会和诊所的支持，并保住了她的教职，只是偶尔迟到；她报告说，经过 $2$ 周的简短咨询后，睡眠有所改善。\n\n- D. 一名来自 Candomblé 社群的 $50$ 岁巴西男子坚称，邻居的嫉妒通过精神手段导致了他的背痛，这一观点得到了他的 terreiro（仪式社群）的认可。他对这一看法很坚定，拒绝使用抗炎药物，但继续从事建筑工作；他报告说，偶尔会与同事就治疗方法发生争论，导致轻微的日程冲突，但没有失业或发生安全事故。\n\n选择唯一最佳选项。", "solution": "从基本原则出发。根据 DSM-5-TR 和 ICD-11，妄想是一种固定的信念，即使面对相反的证据也不易改变，且通常不被当事人所在文化群体所接受。文化一致性通过文化评估（如文化形成访谈）来评定，确定该信念是否被个人参照社群所共享和认可。临床显著性要求存在痛苦或功能损害。使用指定的轴向来区分文化共享的巫术信仰和精神病性妄想：\n- 特异性：妄想通常是特异的，不具有文化共享性；而文化认可的信念是普遍的、有模式的，并且在社会上是可以理解的。\n- 固着性：妄想表现出高度的确信和对反证的抵抗；而文化持有的模型可能很坚定，但通常表现出务实的灵活性，与生物医学模型共存，或允许有条件的修正。\n- 功能损害：精神病性妄想通常会导致显著的损害；而文化共享的信念，即使被强烈认同，通常在文化背景下也不会导致显著的功能失调。虽然妄想作为一种症状在逻辑上不必然要求功能损害，但临床显著损害的存在增加了精神病性障碍的可能性，并加强了其与规范性信念的区分。\n\n将这些轴向应用于每个选项。\n\n选项 A：该信念不具特异性（它与家庭和社群的模型一致），固着性低（她明确支持多元解释，并对生物医学测试持开放态度），且没有功能损害（继续从事照护和市集工作，表现处于基线水平）。这符合文化共享的解释模型，而非妄想。结论 — 错误。\n\n选项 B：该信念相对于参照群体而言是特异的（社群成员明确拒绝关于通过巫术植入思想传输设备的具体机械论说法），固着性极高（声称“证据永远不会改变我的想法”，拒绝检查，持续专注此事），功能损害显著（因旷工和冲突而失业，社交退缩，经济依赖）。在特异性、固着性和功能损害这所有三个轴向上，这种模式都强烈表明其为精神病性妄想，而非文化共享的信念。结论 — 正确。\n\n选项 C：该信念在特定情境下是文化上典型的（丧亲后归因于巫术是共享的），固着性低（她考虑了人际压力，并接受了牧师和临床护理），功能损害极小或无（保住了工作，短暂的睡眠问题在 $2$ 周内改善）。这表明是一种文化一致的痛苦表达方式或解释模型，而非妄想。结论 — 错误。\n\n选项 D：该信念是文化共享的，并得到其 terreiro 的认可，因此不具特异性。固着性为中到高度（拒绝药物治疗），但功能损害轻微且与情境相关（偶尔的争论、日程冲突，但无安全问题或失业）。一个文化共享、即使是坚定持有的信念，如果只带来轻微的实际后果，并不符合因文化不一致性而定义的妄想标准；仅有功能损害本身并不能将一个被认可的信念转变为妄想。其他可能的解释包括一个对健康行为影响有限的文化一致的健康信念，或潜在的健康风险决策，但不是精神病性妄想。结论 — 错误。\n\n因此，只有选项 B 在特异性、固着性和临床显著功能损害这三个方面都满足了指示精神病性妄想而非文化共享信念的条件。", "answer": "$$\\boxed{B}$$", "id": "4704040"}, {"introduction": "确立了诊断标准后，我们常常会使用筛查工具。然而，一个工具的有效性在不同的文化背景下可能会发生变化。本练习将通过计算展示，即使一个筛查工具的敏感性和特异性保持不变，其阳性预测值 ($PPV$) 仍然高度依赖于疾病在特定人群中的患病率 ($\\pi$)。这项量化实践突显了在不考虑当地流行病学数据的情况下，跨文化使用诊断工具的一个关键局限性，这是全球精神卫生领域的一个基本概念。[@problem_id:4704074]", "problem": "一个跨文化研究团队正在评估一种针对特定文化综合征（例如，ataque de nervios）的简易筛查工具从其原生文化环境到移民环境中的可移植性。假设测量不变性成立，因此该工具的操作特性在不同文化中是稳定的。具体来说，设敏感度为$\\text{sens} = 0.86$，特异度为$\\text{spec} = 0.91$，其中敏感度定义为在真实存在综合征的情况下筛查结果为阳性的条件概率，特异度定义为在真实不存在综合征的情况下筛查结果为阴性的条件概率。设该综合征的真实基础率（患病率）在原生文化环境中为$\\pi_{\\mathrm{H}} = 0.18$，在移民环境中为$\\pi_{\\mathrm{M}} = 0.035$。\n\n仅使用敏感度、特异度和患病率的定义，结合贝叶斯定理和全概率定律，首先推导出阳性预测值作为患病率的函数的一般表达式，$PPV(\\pi) = \\mathbb{P}(\\text{综合征} \\mid \\text{筛查阳性})$。然后，通过计算以下比率来评估不同基础率在两种文化环境中的影响：\n$$\nR = \\frac{PPV(\\pi_{\\mathrm{H}})}{PPV(\\pi_{\\mathrm{M}})}\n$$\n报告$R$的值，四舍五入到四位有效数字。最终答案以无单位的纯数字表示。", "solution": "该问题陈述经评估有效。它在科学上基于生物统计学的原理，问题设置合理，数据充分且一致，并且表述客观。因此，有必要给出解答。\n\n设$S$表示某一个体患有该真实综合征的事件，设$T^+$表示筛查工具得出阳性结果的事件。互补事件为$S^c$（无综合征）和$T^-$（筛查阴性）。\n\n问题提供了以下量值：\n-   敏感度, $\\text{sens} = \\mathbb{P}(T^+ | S) = 0.86$。\n-   特异度, $\\text{spec} = \\mathbb{P}(T^- | S^c) = 0.91$。\n-   原生文化环境中的患病率, $\\pi_{\\mathrm{H}} = \\mathbb{P}_{\\mathrm{H}}(S) = 0.18$。\n-   移民环境中的患病率, $\\pi_{\\mathrm{M}} = \\mathbb{P}_{\\mathrm{M}}(S) = 0.035$。\n\n第一个任务是推导阳性预测值（Positive Predictive Value, $PPV(\\pi)$）的通用表达式，它被定义为在筛查结果为阳性的条件下，患有该综合征的条件概率，即$\\mathbb{P}(S | T^+)$。患病率$\\pi$是患有该综合征的先验概率，即$\\mathbb{P}(S)$。\n\n根据贝叶斯定理，后验概率$\\mathbb{P}(S | T^+)$由下式给出：\n$$\nPPV(\\pi) = \\mathbb{P}(S | T^+) = \\frac{\\mathbb{P}(T^+ | S) \\mathbb{P}(S)}{\\mathbb{P}(T^+)}\n$$\n分母$\\mathbb{P}(T^+)$是筛查阳性的总概率。这可以通过使用全概率定律，以是否患有综合征为条件来计算：\n$$\n\\mathbb{P}(T^+) = \\mathbb{P}(T^+ | S)\\mathbb{P}(S) + \\mathbb{P}(T^+ | S^c)\\mathbb{P}(S^c)\n$$\n我们可以使用给定的定义来表示此方程中的各项：\n-   $\\mathbb{P}(S) = \\pi$\n-   $\\mathbb{P}(S^c) = 1 - \\mathbb{P}(S) = 1 - \\pi$\n-   $\\mathbb{P}(T^+ | S) = \\text{sens}$\n-   $\\mathbb{P}(T^+ | S^c)$是假阳性概率。它是特异度的补集：$\\mathbb{P}(T^+ | S^c) = 1 - \\mathbb{P}(T^- | S^c) = 1 - \\text{spec}$。\n\n将这些代入$\\mathbb{P}(T^+)$的表达式中：\n$$\n\\mathbb{P}(T^+) = (\\text{sens})(\\pi) + (1 - \\text{spec})(1 - \\pi)\n$$\n最后，将此代回$PPV(\\pi)$的表达式中：\n$$\nPPV(\\pi) = \\frac{(\\text{sens})(\\pi)}{(\\text{sens})(\\pi) + (1 - \\text{spec})(1 - \\pi)}\n$$\n这就是阳性预测值作为患病率、敏感度和特异度函数的通用表达式。\n\n第二个任务是计算比率$R = \\frac{PPV(\\pi_{\\mathrm{H}})}{PPV(\\pi_{\\mathrm{M}})}$。我们有以下数值：\n$\\text{sens} = 0.86$\n$\\text{spec} = 0.91 \\implies 1 - \\text{spec} = 1 - 0.91 = 0.09$\n$\\pi_{\\mathrm{H}} = 0.18$\n$\\pi_{\\mathrm{M}} = 0.035$\n\n首先，我们计算$PPV(\\pi_{\\mathrm{H}})$：\n$$\nPPV(\\pi_{\\mathrm{H}}) = \\frac{(0.86)(0.18)}{(0.86)(0.18) + (0.09)(1 - 0.18)} = \\frac{0.1548}{0.1548 + (0.09)(0.82)} = \\frac{0.1548}{0.1548 + 0.0738} = \\frac{0.1548}{0.2286}\n$$\n\n接着，我们计算$PPV(\\pi_{\\mathrm{M}})$：\n$$\nPPV(\\pi_{\\mathrm{M}}) = \\frac{(0.86)(0.035)}{(0.86)(0.035) + (0.09)(1 - 0.035)} = \\frac{0.0301}{0.0301 + (0.09)(0.965)} = \\frac{0.0301}{0.0301 + 0.08685} = \\frac{0.0301}{0.11695}\n$$\n\n现在，我们计算比率$R$：\n$$\nR = \\frac{PPV(\\pi_{\\mathrm{H}})}{PPV(\\pi_{\\mathrm{M}})} = \\frac{\\frac{0.1548}{0.2286}}{\\frac{0.0301}{0.11695}}\n$$\n计算数值：\n$$\nPPV(\\pi_{\\mathrm{H}}) \\approx 0.67716535\n$$\n$$\nPPV(\\pi_{\\mathrm{M}}) \\approx 0.25737495\n$$\n$$\nR \\approx \\frac{0.67716535}{0.25737495} \\approx 2.6310508\n$$\n将$R$的结果四舍五入到四位有效数字，得到$2.631$。", "answer": "$$\\boxed{2.631}$$", "id": "4704074"}, {"introduction": "评估干预措施（特别是像治疗仪式这样具有文化特异性的措施）的有效性，需要严谨的科学方法。本练习将介绍如何使用多元线性回归来评估干预效果，同时控制基线症状严重程度等混杂变量。通过分析假设数据，您将获得应用一种强大统计技术的实践经验，以确定一种文化实践是否与可衡量的临床改善相关，这是循证文化精神医学研究的一项关键技能。[@problem_id:4704021]", "problem": "给定代表文化结合征（culture-bound syndrome）在文化认可的治疗仪式前后测量的症状严重程度分数的数值数组，以及一个表示每个个体是否参加了该仪式的二元指标。目标是以数学上严谨的方式，在调整基线严重程度后，确定仪式暴露是否能预测病情改善。将改善形式化为在控制基线严重程度时，对干预后症状严重程度的负面效应。假设如下：(i) 个体层面的结果在给定协变量的条件下是独立同分布的，(ii) 干预后分数的条件期望与协变量呈线性关系，(iii) 误差的均值为零且方差恒定。在这些假设下，推导一种方法来检验在预测干预后分数时，仪式暴露效应在调整基线严重程度后是否为负且在统计上显著。\n\n定义每个个体 $i$ 的线性模型：\n$$\ny_i = \\beta_0 + \\beta_1 x_i + \\beta_2 r_i + \\varepsilon_i,\n$$\n其中 $y_i$ 是干预后的症状严重程度，$x_i$ 是基线（干预前）的严重程度，$r_i \\in \\{0,1\\}$ 表示是否暴露于仪式，$\\varepsilon_i$ 是模型误差。将“仪式暴露预测改善”解释为 $\\beta_2  0$ 且在双边显著性水平 $\\alpha = 0.05$ 下具有统计显著性。\n\n您的任务是实现一个程序，对于每个提供的测试用例，计算系数 $\\beta_2$ 的普通最小二乘法 (OLS) 估计值，其基于学生t分布的双边 $p$ 值，以及一个布尔值，该值指示证据是否支持仪式暴露带来的改善，定义为 $(\\hat{\\beta}_2  0)$ 且 $(p\\text{-值}  0.05)$。\n\n使用以下测试套件。每个测试用例由三个数组定义：干预前严重程度 $x$、干预后严重程度 $y$ 和仪式暴露指标 $r$。\n\n测试用例1（具有中等负面暴露效应的一般情况）：\n- $x = [28,22,19,31,25,18,27,30,24,26,20,29,21,23,17,32,28,25,19,27]$\n- $r = [1,0,1,1,0,0,1,0,1,0,0,1,0,1,0,1,1,0,0,1]$\n- $y = [15.0,14.0,9.5,17.5,16.5,14.0,11.5,18.0,12.0,18.0,14.0,15.5,14.0,11.0,13.0,16.0,13.0,17.0,12.5,14.0]$\n\n测试用例2（无真实暴露效应）：\n- $x = [20,22,25,18,30,15,28,24,19,27,21,23,26,17,29,16]$\n- $r = [1,0,1,0,1,0,1,0,0,1,0,1,0,0,1,1]$\n- $y = [15.0,14.0,17.0,12.5,19.0,12.0,17.5,16.0,14.0,16.5,14.0,16.5,17.0,13.0,18.0,12.0]$\n\n测试用例3（具有强负面暴露效应的小样本）：\n- $x = [26,23,22,30,19,27,21,24]$\n- $r = [1,1,0,0,1,0,0,1]$\n- $y = [9.0,8.0,11.0,15.0,6.0,13.5,11.5,7.0]$\n\n测试用例4（具有高基线聚类和中等负面暴露效应的边缘情况）：\n- $x = [25,26,24,25,25,26,24,25,25,26,24,25,25,26]$\n- $r = [0,1,0,1,0,1,0,1,0,1,0,1,0,1]$\n- $y = [19.05,15.9,18.4,15.85,18.55,16.3,18.5,15.65,18.95,16.3,17.9,15.85,18.75,16.1]$\n\n您的程序必须为每个测试用例计算：\n1. 在 $y$ 对截距、$x$ 和 $r$ 的模型中，仪式暴露系数的 OLS 估计值 $\\hat{\\beta}_2$。\n2. 使用学生t统计量和适当的自由度，对 $H_0: \\beta_2 = 0$ 与 $H_1: \\beta_2 \\neq 0$ 进行检验的双边 $p$ 值。\n3. 一个布尔值，指示“仪式暴露预测改善”是否成立，其定义为 $(\\hat{\\beta}_2  0)$ 且 $(p\\text{-值}  0.05)$。\n\n最终输出格式：\n- 生成一行包含每个测试用例结果的列表，其中每个结果都是列表 $[\\hat{\\beta}_2, p\\text{-值}, \\text{布尔值}]$。\n- 浮点数必须四舍五入到 $6$ 位小数。\n- 布尔值必须格式化为 True 或 False。\n- 整个输出必须以 Python 列表表示法打印为一行，例如：$[[\\hat{\\beta}_2^{(1)}, p^{(1)}, \\text{True}], [\\hat{\\beta}_2^{(2)}, p^{(2)}, \\text{False}], \\dots]$。\n\n不涉及物理单位。不涉及角度。不要使用百分号表示任何数量；任何比例都必须是小数。\n\n您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，\"[[b2_1,p_1,True],[b2_2,p_2,False],[b2_3,p_3,True],[b2_4,p_4,True]]\"）。", "solution": "该问题要求使用多元线性回归模型分析仪式暴露对症状严重程度分数的影响。此问题的有效性已得到确认，因为它在科学上基于标准统计理论，问题设定良好，有足够的数据和明确的目标，并且是客观地表述的。我们将进行完整的推导和实现。\n\n对于个体 $i$ 的干预后症状严重程度 $y_i$，指定的线性模型是：\n$$\ny_i = \\beta_0 + \\beta_1 x_i + \\beta_2 r_i + \\varepsilon_i\n$$\n这里，$x_i$ 是干预前的严重程度，$r_i$ 是仪式暴露的二元指标（$r_i=1$ 表示暴露，$r_i=0$ 表示未暴露），$\\beta_0, \\beta_1, \\beta_2$ 是模型系数，$\\varepsilon_i$ 是误差项。系数 $\\beta_2$ 量化了在保持基线严重程度 $x_i$ 不变的情况下，与 $r_i$ 单位变化（即参加仪式与不参加仪式）相关的干预后严重程度 $y_i$ 的平均变化。$\\beta_2$ 的负值将表明仪式暴露与症状严重程度的降低相关，这被定义为“改善”。\n\n目标是估计 $\\beta_2$ 并检验假设 $H_0: \\beta_2 = 0$ 对 $H_1: \\beta_2 \\neq 0$。问题要求我们，如果估计值 $\\hat{\\beta}_2$ 为负且在 $\\alpha = 0.05$ 的显著性水平上拒绝了原假设，则断定有改善的证据。这将通过普通最小二乘法 (OLS) 来实现。\n\n对于一组 $n$ 个个体，该模型可以用矩阵形式表示为：\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\n$$\n其中：\n- $\\mathbf{y}$ 是一个 $n \\times 1$ 的干预后分数向量：$\\mathbf{y} = [y_1, y_2, \\dots, y_n]^T$。\n- $\\mathbf{X}$ 是 $n \\times p$ 的设计矩阵，其中 $p=3$ 是参数的数量。每行对应一个个体，列对应于预测变量。第一列是用于截距项 $\\beta_0$ 的全1向量。\n$$\n\\mathbf{X} = \\begin{pmatrix}\n1  x_1  r_1 \\\\\n1  x_2  r_2 \\\\\n\\vdots  \\vdots  \\vdots \\\\\n1  x_n  r_n\n\\end{pmatrix}\n$$\n- $\\boldsymbol{\\beta}$ 是 $p \\times 1$ 的系数向量：$\\boldsymbol{\\beta} = [\\beta_0, \\beta_1, \\beta_2]^T$。\n- $\\boldsymbol{\\varepsilon}$ 是一个 $n \\times 1$ 的未观测误差项向量。\n\nOLS 估计量 $\\hat{\\boldsymbol{\\beta}}$ 是通过最小化残差平方和 $SSR = \\sum_{i=1}^n (y_i - (\\beta_0 + \\beta_1 x_i + \\beta_2 r_i))^2$ 找到的。在矩阵形式中，这是 $SSR = (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})^T (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})$。最小化该量的解是正规方程 $\\mathbf{X}^T\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{X}^T\\mathbf{y}$ 的解。假设矩阵 $\\mathbf{X}^T\\mathbf{X}$ 是可逆的（即预测变量之间不存在完全多重共线性），OLS 估计量由下式给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}\n$$\n值 $\\hat{\\beta}_2$ 是向量 $\\hat{\\boldsymbol{\\beta}}$ 的第三个元素。\n\n为了进行假设检验，我们需要 $\\hat{\\beta}_2$ 的抽样分布。在标准的 OLS 假设（线性、随机抽样、无完全多重共线性、误差的零条件均值和同方差性）下，估计量 $\\hat{\\boldsymbol{\\beta}}$ 是无偏的，其方差-协方差矩阵由下式给出：\n$$\n\\text{Var}(\\hat{\\boldsymbol{\\beta}}) = \\sigma^2(\\mathbf{X}^T\\mathbf{X})^{-1}\n$$\n其中 $\\sigma^2$ 是误差项 $\\varepsilon_i$ 的未知方差。我们必须从数据中估计 $\\sigma^2$。$\\sigma^2$ 的无偏估计量是均方误差 $s^2$：\n$$\ns^2 = \\frac{\\mathbf{e}^T\\mathbf{e}}{n-p} = \\frac{\\sum_{i=1}^n e_i^2}{n-p}\n$$\n其中 $\\mathbf{e} = \\mathbf{y} - \\mathbf{X}\\hat{\\boldsymbol{\\beta}}$ 是残差向量，$n-p$ 是残差的自由度。在我们的案例中，$p=3$。\n\n$\\hat{\\boldsymbol{\\beta}}$ 的估计方差-协方差矩阵则为：\n$$\n\\widehat{\\text{Var}}(\\hat{\\boldsymbol{\\beta}}) = s^2(\\mathbf{X}^T\\mathbf{X})^{-1}\n$$\n系数估计值 $\\hat{\\beta}_2$ 的标准误，记作 $SE(\\hat{\\beta}_2)$，是该矩阵第三个对角元素的平方根。如果我们令 $\\mathbf{C} = (\\mathbf{X}^T\\mathbf{X})^{-1}$，那么：\n$$\nSE(\\hat{\\beta}_2) = \\sqrt{s^2 C_{33}} = s \\sqrt{C_{33}}\n$$\n其中 $C_{33}$ 是 $\\mathbf{C}$ 中第三行第三列的元素。\n\n在原假设 $H_0: \\beta_2 = 0$ 下，检验统计量：\n$$\nt = \\frac{\\hat{\\beta}_2 - 0}{SE(\\hat{\\beta}_2)}\n$$\n服从具有 $n-p$ 个自由度的学生t分布。\n\n此检验的双边 $p$ 值是假设原假设为真时，观测到至少与计算出的检验统计量一样极端的概率。这由下式给出：\n$$\np\\text{-值} = P(|T| \\ge |t|) = 2 \\cdot P(T \\ge |t|)\n$$\n其中 $T$ 是一个服从具有 $n-p$ 个自由度的t分布的随机变量。\n\n最后，对于每个测试用例，我们将计算 $\\hat{\\beta}_2$ 及其相关的 $p$ 值。“仪式暴露预测改善”的条件在 $\\hat{\\beta}_2  0$ 和 $p\\text{-值}  0.05$ 同时满足时成立。\n\n实现将对每个测试用例遵循以下步骤：\n1.  根据输入向量 $\\mathbf{x}$ 和 $\\mathbf{r}$ 以及一列全为1的截距项，构建设计矩阵 $\\mathbf{X}$。令 $n$ 为数据点数。\n2.  计算 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$。提取 $\\hat{\\beta}_2$。\n3.  计算残差 $\\mathbf{e} = \\mathbf{y} - \\mathbf{X}\\hat{\\boldsymbol{\\beta}}$。\n4.  估计误差方差 $s^2 = \\frac{\\mathbf{e}^T\\mathbf{e}}{n-3}$。\n5.  计算标准误 $SE(\\hat{\\beta}_2) = \\sqrt{s^2 [(\\mathbf{X}^T\\mathbf{X})^{-1}]_{33}}$。\n6.  计算 $t$ 统计量 $t = \\hat{\\beta}_2 / SE(\\hat{\\beta}_2)$。\n7.  使用具有 $n-3$ 个自由度的学生t分布的生存函数计算双边 $p$ 值。\n8.  根据条件 $\\hat{\\beta}_2  0$ 和 $p\\text{-值}  0.05$ 确定布尔结果。\n9.  按要求格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats as sp_stats\n\ndef solve():\n    \"\"\"\n    Solves the given statistical problem for multiple test cases.\n    For each case, it performs an Ordinary Least Squares (OLS) regression\n    to estimate the effect of a ritual exposure on symptom severity,\n    controlling for baseline severity. It then calculates the coefficient\n    for ritual exposure, its p-value, and a boolean indicating if\n    the effect is negative and statistically significant.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"x\": np.array([28, 22, 19, 31, 25, 18, 27, 30, 24, 26, 20, 29, 21, 23, 17, 32, 28, 25, 19, 27]),\n            \"r\": np.array([1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1]),\n            \"y\": np.array([15.0, 14.0, 9.5, 17.5, 16.5, 14.0, 11.5, 18.0, 12.0, 18.0, 14.0, 15.5, 14.0, 11.0, 13.0, 16.0, 13.0, 17.0, 12.5, 14.0])\n        },\n        {\n            \"x\": np.array([20, 22, 25, 18, 30, 15, 28, 24, 19, 27, 21, 23, 26, 17, 29, 16]),\n            \"r\": np.array([1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1]),\n            \"y\": np.array([15.0, 14.0, 17.0, 12.5, 19.0, 12.0, 17.5, 16.0, 14.0, 16.5, 14.0, 16.5, 17.0, 13.0, 18.0, 12.0])\n        },\n        {\n            \"x\": np.array([26, 23, 22, 30, 19, 27, 21, 24]),\n            \"r\": np.array([1, 1, 0, 0, 1, 0, 0, 1]),\n            \"y\": np.array([9.0, 8.0, 11.0, 15.0, 6.0, 13.5, 11.5, 7.0])\n        },\n        {\n            \"x\": np.array([25, 26, 24, 25, 25, 26, 24, 25, 25, 26, 24, 25, 25, 26]),\n            \"r\": np.array([0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1]),\n            \"y\": np.array([19.05, 15.9, 18.4, 15.85, 18.55, 16.3, 18.5, 15.65, 18.95, 16.3, 17.9, 15.85, 18.75, 16.1])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        x_vec, r_vec, y_vec = case[\"x\"], case[\"r\"], case[\"y\"]\n        \n        n = len(y_vec)  # Number of observations\n        p = 3           # Number of parameters (beta_0, beta_1, beta_2)\n        \n        # 1. Construct the design matrix X\n        X = np.c_[np.ones(n), x_vec, r_vec]\n        \n        # 2. Compute OLS estimator beta_hat\n        try:\n            XTX_inv = np.linalg.inv(X.T @ X)\n        except np.linalg.LinAlgError:\n            # Handle cases of perfect multicollinearity, though not expected here.\n            results.append([float('nan'), float('nan'), False])\n            continue\n            \n        beta_hat = XTX_inv @ (X.T @ y_vec)\n        beta2_hat = beta_hat[2]\n        \n        # 3. Calculate residuals\n        y_hat = X @ beta_hat\n        residuals = y_vec - y_hat\n        \n        # 4. Estimate error variance (s^2)\n        df_residuals = n - p\n        s2 = (residuals.T @ residuals) / df_residuals\n        \n        # 5. Calculate standard error of beta2_hat\n        # The variance of beta2_hat is the 3rd diagonal element of s^2 * (X^T*X)^-1\n        var_beta2 = s2 * XTX_inv[2, 2]\n        se_beta2 = np.sqrt(var_beta2)\n        \n        # 6. Compute the t-statistic\n        t_statistic = beta2_hat / se_beta2\n        \n        # 7. Compute the two-sided p-value\n        # Using the survival function (1 - cdf) of the t-distribution\n        p_value = 2 * sp_stats.t.sf(np.abs(t_statistic), df=df_residuals)\n        \n        # 8. Determine if improvement is predicted\n        # Condition: beta_2  0 and p-value  0.05\n        predicts_improvement = (beta2_hat  0) and (p_value  0.05)\n        \n        results.append([beta2_hat, p_value, predicts_improvement])\n\n    # Format the final output string as specified\n    formatted_results = []\n    for b2, p_val, improve in results:\n        formatted_b2 = f\"{b2:.6f}\"\n        formatted_p_val = f\"{p_val:.6f}\"\n        formatted_bool = str(improve)\n        formatted_results.append(f\"[{formatted_b2},{formatted_p_val},{formatted_bool}]\")\n        \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4704021"}]}