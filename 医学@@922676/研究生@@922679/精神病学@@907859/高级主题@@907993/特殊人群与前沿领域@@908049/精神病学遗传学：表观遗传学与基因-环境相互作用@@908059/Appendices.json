{"hands_on_practices": [{"introduction": "遗传关联研究中的一个主要挑战是人群分层造成的混淆，即不同亚群之间的等位基因频率差异可能导致虚假的关联。基于家庭的设计，如传递不平衡检验（TDT），通过分析杂合父母向患病后代传递等位基因的情况，有效地控制了祖源背景，为这一问题提供了稳健的解决方案。这项练习 [@problem_id:4747189] 将引导您从基本原理推导出TDT检验统计量并加以应用，从而巩固您对如何在遗传多样性样本中获得可靠关联结果的理解。", "problem": "一位精神科医生研究了一个具有等位基因 $A$ 和 $a$ 的双等位基因座与患病后代的神经发育性精神障碍之间的关联。该研究使用核心家庭三联体，并侧重于族内检验，以确保对祖先分层的稳健性。基本假设是：(i) 减数分裂中的孟德尔分离定律意味着，在没有印记效应的情况下，杂合子亲本以 $1/2$ 的概率将每个等位基因传递给任何一个后代；(ii) 分子生物学的中心法则确立了遗传传递不依赖于环境暴露，除非存在违反孟德尔对称性的因果生物学机制，而本研究假设该基因座不存在这种情况；(iii) 以亲本基因型为条件可以消除由群体等位基因频率差异引起的混杂，因为传递概率是在家庭内部定义的。\n\n样本中存在两个祖先分层 $S_{1}$ 和 $S_{2}$，其等位基因 $A$ 的背景频率差异显著（在 $S_{1}$ 中为 $0.70$，在 $S_{2}$ 中为 $0.30$）。记录了一项产前暴露 $E$（二元变量：暴露与未暴露），其在 $S_{1}$ 中的暴露流行率为 $0.50$，在 $S_{2}$ 中为 $0.10$。对于每个三联体，将杂合子亲本向患病后代的传递情况按祖先分层和暴露状态进行分层统计。观察到的杂合子亲本传递等位基因 $A$ 与等位基因 $a$ 的计数如下：\n\n- 在分层 $S_{1}$ 中：在 $E$ 暴露的家庭中，等位基因 $A$ 传递了 $30$ 次，等位基因 $a$ 传递了 $32$ 次；在未暴露的家庭中，等位基因 $A$ 传递了 $25$ 次，等位基因 $a$ 传递了 $23$ 次。\n\n- 在分层 $S_{2}$ 中：在 $E$ 暴露的家庭中，等位基因 $A$ 传递了 $18$ 次，等位基因 $a$ 传递了 $17$ 次；在未暴露的家庭中，等位基因 $A$ 传递了 $28$ 次，等位基因 $a$ 传递了 $27$ 次。\n\n从传递计数的二项似然定义出发，其中参数 $p$ 表示杂合子亲本将等位基因 $A$ 传递给患病后代的概率，并给定原假设 $H_{0}: p = 1/2$，请推导用于检验 $H_{0}$ 的分数检验统计量，该检验使用跨越所有分层和暴露类别的汇总族内传递数据。然后，根据所提供的数据计算该统计量的值并报告。\n\n将最终答案表示为一个无单位数，并四舍五入到四位有效数字。", "solution": "本问题要求推导并计算一个分数检验统计量，用于检验基于家庭的遗传关联数据中一个等位基因传递概率的假设。分析将基于跨不同祖先分层和暴露组的汇总数据进行。\n\n首先，我们对统计模型进行形式化。数据由杂合子亲本向其患病后代的传递组成。对于每次这样的传递，基因型为 $Aa$ 的亲本可以传递等位基因 $A$ 或等位基因 $a$。设 $p$ 为杂合子亲本将等位基因 $A$ 传递给患病后代的概率。杂合子亲本的总传递次数为 $N$。设 $T_A$ 为等位基因 $A$ 被传递的次数，$T_a$ 为等位基因 $a$ 被传递的次数，因此 $N = T_A + T_a$。在独立传递的假设下，随机变量 $T_A$ 服从参数为 $N$ 和 $p$ 的二项分布，记为 $T_A \\sim \\text{Binomial}(N, p)$。\n\n根据孟德尔分离定律，在没有遗传连锁和关联的情况下，原假设 $H_0$ 为两个等位基因以相等的概率传递。因此，$H_0: p = 1/2$。备择假设 $H_1$ 是存在传递扭曲，即 $p \\neq 1/2$。\n\n为推导分数检验统计量，我们从参数 $p$ 的对数似然函数开始。似然函数由二项概率质量函数给出：\n$$L(p; T_A, N) = \\binom{N}{T_A} p^{T_A} (1-p)^{N-T_A}$$\n对数似然函数 $\\ell(p)$ 是似然函数的自然对数：\n$$\\ell(p) = \\ln(L(p)) = \\ln\\binom{N}{T_A} + T_A \\ln(p) + (N - T_A) \\ln(1-p)$$\n\n分数函数 $U(p)$ 是对数似然函数关于参数 $p$ 的一阶导数：\n$$U(p) = \\frac{d\\ell}{dp} = \\frac{T_A}{p} - \\frac{N - T_A}{1-p}$$\n分数函数衡量对数似然函数的梯度。在原假设下，我们期望似然函数的最大值接近于原假设值 $p_0$，因此在 $p_0$ 处的斜率（分数）应接近于零。\n\n费雪信息 $I(p)$ 量化了数据中包含的关于参数 $p$ 的信息量。它被定义为对数似然函数二阶导数期望值的负数：\n$$I(p) = -E\\left[\\frac{d^2\\ell}{dp^2}\\right]$$\n对数似然函数的二阶导数是：\n$$\\frac{d^2\\ell}{dp^2} = \\frac{d}{dp}\\left(\\frac{T_A}{p} - \\frac{N - T_A}{1-p}\\right) = -\\frac{T_A}{p^2} - \\frac{N-T_A}{(1-p)^2}$$\n为求费雪信息，我们取该量的负值的期望。$T_A$ 的期望是 $E[T_A] = Np$。\n$$I(p) = -E\\left[-\\frac{T_A}{p^2} - \\frac{N-T_A}{(1-p)^2}\\right] = \\frac{E[T_A]}{p^2} + \\frac{N - E[T_A]}{(1-p)^2} = \\frac{Np}{p^2} + \\frac{N-Np}{(1-p)^2}$$\n$$I(p) = \\frac{N}{p} + \\frac{N(1-p)}{(1-p)^2} = \\frac{N}{p} + \\frac{N}{1-p} = \\frac{N(1-p) + Np}{p(1-p)} = \\frac{N}{p(1-p)}$$\n\n分数检验统计量 $S$ 的构造方法是，将在原假设值 $p_0$ 处计算的分数函数值的平方，除以同样在 $p_0$ 处计算的费雪信息。该统计量渐近服从自由度为1的卡方分布。\n$$S = \\frac{[U(p_0)]^2}{I(p_0)}$$\n\n对于我们的具体问题，原假设是 $H_0: p = 1/2$，所以 $p_0 = 1/2$。我们在此值处计算分数函数和费雪信息。\n$$U(p_0 = 1/2) = \\frac{T_A}{1/2} - \\frac{N - T_A}{1 - 1/2} = 2T_A - 2(N - T_A) = 4T_A - 2N$$\n由于 $N = T_A + T_a$，我们也可以将其写作 $U(1/2) = 2T_A - 2T_a$。\n\n在 $p_0 = 1/2$ 处的费雪信息是：\n$$I(p_0 = 1/2) = \\frac{N}{\\frac{1}{2}(1 - \\frac{1}{2})} = \\frac{N}{1/4} = 4N$$\n\n现在，我们构造分数检验统计量 $S$：\n$$S = \\frac{(2T_A - 2T_a)^2}{4N} = \\frac{4(T_A - T_a)^2}{4N} = \\frac{(T_A - T_a)^2}{N}$$\n回顾 $N = T_A + T_a$，统计量的最终形式是：\n$$S = \\frac{(T_A - T_a)^2}{T_A + T_a}$$\n该统计量可被识别为未校正的McNemar检验统计量，这是传递不平衡检验（TDT）统计量的标准形式。\n\n问题要求使用跨越所有分层（$S_1, S_2$）和暴露类别（$E$暴露，未暴露）的汇总传递数据。我们对提供的计数进行求和：\n等位基因 $A$ 的总传递次数：\n$T_A = (\\text{transmissions in } S_1, E) + (\\text{transmissions in } S_1, \\text{no } E) + (\\text{transmissions in } S_2, E) + (\\text{transmissions in } S_2, \\text{no } E)$\n$$T_A = 30 + 25 + 18 + 28 = 101$$\n\n等位基因 $a$ 的总传递次数：\n$T_a = (\\text{transmissions in } S_1, E) + (\\text{transmissions in } S_1, \\text{no } E) + (\\text{transmissions in } S_2, E) + (\\text{transmissions in } S_2, \\text{no } E)$\n$$T_a = 32 + 23 + 17 + 27 = 99$$\n\n信息传递的总次数为 $N = T_A + T_a$：\n$$N = 101 + 99 = 200$$\n\n现在我们可以计算分数检验统计量 $S$ 的值：\n$$S = \\frac{(101 - 99)^2}{200} = \\frac{2^2}{200} = \\frac{4}{200} = \\frac{1}{50} = 0.02$$\n\n问题要求将答案四舍五入到四位有效数字。\n$$S = 0.02000$$\n该统计量的值非常小，表明对于汇总数据，没有统计上显著的证据支持存在偏离孟德尔遗传预测的传递扭曲。观察到的计数 $101$ 和 $99$ 非常接近原假设下预期的计数 $100$ 和 $100$。", "answer": "$$\\boxed{0.02000}$$", "id": "4747189"}, {"introduction": "识别基因-环境（$G \\times E$）相互作用是精神遗传学的一个关键目标，但解释这些相互作用需要仔细考虑其统计尺度。虽然许多模型在乘性尺度上估计相互作用（例如，逻辑回归产生比值比），但公共卫生和生物学解释通常依赖于加性尺度，后者衡量的是超出个体效应之和的超额风险。这项练习 [@problem_id:4747213] 将指导您从乘性模型的参数中推导出交互作用所致相对超额风险（RERI）这一加性度量，从而磨练您将统计发现转化为有意义见解的能力。", "problem": "一项精神遗传流行病学研究调查了重度抑郁发作的$12$个月风险，该风险是应激反应位点上某个风险等位基因的二元基因型指标 $G \\in \\{0,1\\}$ 和指示严重童年不幸经历的二元环境暴露 $E \\in \\{0,1\\}$ 的函数。该分析使用带有对数连接函数的二项广义线性模型 (GLM)，这与在相对风险尺度上进行估计是一致的。令 $Y \\in \\{0,1\\}$ 表示在未来$12$个月内是否发生重度抑郁发作，并令 $p_{ge} = \\Pr(Y=1 \\mid G=g, E=e)$ 表示基因型为 $G=g$ 且环境暴露为 $E=e$ 的分层的风险。GLM模型为\n$$\n\\ln\\big(p_{ge}\\big) \\;=\\; \\beta_{0} + \\beta_{G}\\, g + \\beta_{E}\\, e + \\beta_{GE}\\, g e.\n$$\n假设拟合系数为\n$$\n\\hat{\\beta}_{0} \\;=\\; \\ln(0.02),\\quad \\hat{\\beta}_{G} \\;=\\; \\ln(1.7),\\quad \\hat{\\beta}_{E} \\;=\\; \\ln(2.3),\\quad \\hat{\\beta}_{GE} \\;=\\; \\ln(1.5).\n$$\n仅使用广义线性模型、对数连接函数以及在风险差尺度上交互作用作为与可加性偏离的概念，首先推导以交互作用导致的相对超额风险 (RERI) 量化的交互作用对比的表达式，该表达式用相对风险 $RR_{ge} = p_{ge}/p_{00}$ 表示，然后计算上述拟合模型所隐含的其数值。将最终数值答案四舍五入到四位有效数字。", "solution": "问题要求推导交互作用导致的相对超额风险 (RERI) 的表达式，并随后基于一个拟合的广义线性模型 (GLM) 进行计算。整个过程必须基于所提供的定义。\n\n### 第1部分：RERI 表达式的推导\n\nRERI 是在可加尺度上衡量交互作用的一个指标，具体来说，是衡量与风险差可加性的偏离程度。令 $p_{ge} = \\Pr(Y=1 \\mid G=g, E=e)$ 为基因型为 $g \\in \\{0,1\\}$ 且环境暴露为 $e \\in \\{0,1\\}$ 的个体发生重度抑郁发作的风险。四个风险分层为：\n\\begin{itemize}\n    \\item $p_{00}$：$G=0$ 且 $E=0$ 的个体的风险（基线/未暴露组）。\n    \\item $p_{10}$：$G=1$ 且 $E=0$ 的个体的风险（仅暴露于基因型）。\n    \\item $p_{01}$：$G=0$ 且 $E=1$ 的个体的风险（仅暴露于环境）。\n    \\item $p_{11}$：$G=1$ 且 $E=1$ 的个体的风险（两者均暴露）。\n\\end{itemize}\n\n与每次暴露相关的风险差（$RD$），与基线相比，为：\n$$\nRD_{G} = p_{10} - p_{00}\n$$\n$$\nRD_{E} = p_{01} - p_{00}\n$$\n如果两种暴露在风险尺度上的作用是纯粹相加的，那么同时暴露于两者的个体的总风险差将是单个风险差之和：$RD_{G} + RD_{E}$。在此可加模型下，期望风险（记为 $p_{11}^{\\text{add}}$）将是基线风险加上这个合并的风险差：\n$$\np_{11}^{\\text{add}} = p_{00} + RD_{G} + RD_{E} = p_{00} + (p_{10} - p_{00}) + (p_{01} - p_{00}) = p_{10} + p_{01} - p_{00}\n$$\n可加尺度上的交互作用被定义为双重暴露组的观测风险 $p_{11}$ 与此期望的可加风险之间的偏离。这个偏离就是交互作用对比（$IC$）：\n$$\nIC = p_{11} - p_{11}^{\\text{add}} = p_{11} - (p_{10} + p_{01} - p_{00}) = p_{11} - p_{10} - p_{01} + p_{00}\n$$\nRERI 被定义为该交互作用对比经基线风险 $p_{00}$ 标准化（即除以基线风险）：\n$$\nRERI = \\frac{IC}{p_{00}} = \\frac{p_{11} - p_{10} - p_{01} + p_{00}}{p_{00}}\n$$\n为了用相对风险（$RR_{ge} = p_{ge} / p_{00}$）表示 RERI，我们将分子中的每一项都除以 $p_{00}$：\n$$\nRERI = \\frac{p_{11}}{p_{00}} - \\frac{p_{10}}{p_{00}} - \\frac{p_{01}}{p_{00}} + \\frac{p_{00}}{p_{00}}\n$$\n代入相对风险的定义（$RR_{11} = p_{11}/p_{00}$，$RR_{10} = p_{10}/p_{00}$，$RR_{01} = p_{01}/p_{00}$），我们得到所需的表达式：\n$$\nRERI = RR_{11} - RR_{10} - RR_{01} + 1\n$$\n这就完成了问题的第一部分。\n\n### 第2部分：RERI 值的计算\n\n问题提供了一个带有对数连接函数的拟合二项 GLM：\n$$\n\\ln(p_{ge}) = \\beta_{0} + \\beta_{G}\\, g + \\beta_{E}\\, e + \\beta_{GE}\\, g e\n$$\n对该方程取指数，我们可以用模型系数来表示风险 $p_{ge}$：\n$$\np_{ge} = \\exp(\\beta_{0} + \\beta_{G}\\, g + \\beta_{E}\\, e + \\beta_{GE}\\, g e)\n$$\n基线风险，即 $g=0$ 和 $e=0$ 时，为 $p_{00} = \\exp(\\beta_{0})$。相对风险 $RR_{ge}$ 是给定分层 $(g,e)$ 的风险与基线风险 $p_{00}$ 的比值：\n$$\nRR_{ge} = \\frac{p_{ge}}{p_{00}} = \\frac{\\exp(\\beta_{0} + \\beta_{G}\\, g + \\beta_{E}\\, e + \\beta_{GE}\\, g e)}{\\exp(\\beta_{0})} = \\exp(\\beta_{G}\\, g + \\beta_{E}\\, e + \\beta_{GE}\\, g e)\n$$\n使用这个通用公式，我们可以找到计算 RERI 所需的特定相对风险：\n\\begin{itemize}\n    \\item 对于 $(g=1, e=0)$：$RR_{10} = \\exp(\\beta_{G}(1) + \\beta_{E}(0) + \\beta_{GE}(1)(0)) = \\exp(\\beta_{G})$\n    \\item 对于 $(g=0, e=1)$：$RR_{01} = \\exp(\\beta_{G}(0) + \\beta_{E}(1) + \\beta_{GE}(0)(1)) = \\exp(\\beta_{E})$\n    \\item 对于 $(g=1, e=1)$：$RR_{11} = \\exp(\\beta_{G}(1) + \\beta_{E}(1) + \\beta_{GE}(1)(1)) = \\exp(\\beta_{G} + \\beta_{E} + \\beta_{GE})$\n\\end{itemize}\n问题提供了以下估计系数：\n$$\n\\hat{\\beta}_{G} = \\ln(1.7), \\quad \\hat{\\beta}_{E} = \\ln(2.3), \\quad \\hat{\\beta}_{GE} = \\ln(1.5)\n$$\n现在我们可以计算估计的相对风险：\n$$\n\\hat{RR}_{10} = \\exp(\\hat{\\beta}_{G}) = \\exp(\\ln(1.7)) = 1.7\n$$\n$$\n\\hat{RR}_{01} = \\exp(\\hat{\\beta}_{E}) = \\exp(\\ln(2.3)) = 2.3\n$$\n$$\n\\hat{RR}_{11} = \\exp(\\hat{\\beta}_{G} + \\hat{\\beta}_{E} + \\hat{\\beta}_{GE}) = \\exp(\\hat{\\beta}_{G})\\exp(\\hat{\\beta}_{E})\\exp(\\hat{\\beta}_{GE}) = \\exp(\\ln(1.7))\\exp(\\ln(2.3))\\exp(\\ln(1.5))\n$$\n$$\n\\hat{RR}_{11} = 1.7 \\times 2.3 \\times 1.5 = 3.91 \\times 1.5 = 5.865\n$$\n最后，我们将这些估计的相对风险代入推导出的 RERI 公式中：\n$$\n\\text{RERI} = \\hat{RR}_{11} - \\hat{RR}_{10} - \\hat{RR}_{01} + 1\n$$\n$$\n\\text{RERI} = 5.865 - 1.7 - 2.3 + 1\n$$\n$$\n\\text{RERI} = 5.865 - 4.0 + 1 = 1.865 + 1 = 2.865\n$$\n计算值为 $2.865$。问题要求答案四舍五入到四位有效数字。数值 $2.865$ 已经有四位有效数字，因此不需要进一步四舍五入。", "answer": "$$\n\\boxed{2.865}\n$$", "id": "4747213"}, {"introduction": "精神病学的现代“组学”研究，如表观基因组关联研究（EWAS），会同时检验数百万个假设，从而产生巨大的多重检验问题。如果不对此进行校正，可能会导致不可接受的大量假阳性发现，从而削弱结果的可信度。错误发现率（FDR）是一种被广泛采用的标准，用于控制所有被拒绝的假设中错误发现的比例。在这项练习 [@problem_id:4747256] 中，您将应用 Benjamini-Hochberg 程序来控制FDR并估计真实原假设的比例，为您提供严谨分析大规模数据所必需的实践技能。", "problem": "在一项精神遗传学领域的表观基因组关联分析中，您检验了早期生活压力暴露与下丘脑-垂体-肾上腺轴基因中候选的胞嘧啶-磷酸-鸟嘌呤（CpG）位点的DNA甲基化之间，对于一个连续的抑郁严重程度结局的交互作用。您执行了 $m=20$ 次独立的假设检验，每次检验在标准正则性条件下产生一个双边 $p$ 值，这意味着在真实的原假设下，$p$ 值在 $[0,1]$ 上均匀分布。观测到的 $p$ 值（未排序）如下：\n$0.12, 0.006, 0.2, 0.041, 0.028, 0.002, 0.061, 0.073, 0.72, 0.0008, 0.012, 0.018, 0.035, 0.6, 0.081, 0.021, 0.052, 0.004, 0.88, 0.009$。\n假设采用标准的两组混合框架，其中比例为 $\\pi_{0}$ 的假设是真实的原假设，并且各位点间的检验统计量是独立的。\n\n任务：\n1) 使用 Storey 的原假设比例估计量，并设置调整参数 $\\lambda=0.5$，求得估计值 $\\widehat{\\pi}_{0}$。\n2) 在独立性假设下，使用 Benjamini–Hochberg 升阶程序将错误发现率（FDR）控制在目标水平 $q=0.1$，并确定数据依赖的拒绝阈值 $t_{\\mathrm{BH}}$ 和被拒绝的假设数量 $R$。\n3) 使用在 Benjamini–Hochberg 阈值处的标准 FDR 置入估计，其中用第 (1) 部分得到的估计值 $\\widehat{\\pi}_{0}$ 替换未知的 $\\pi_{0}$，计算在第 (2) 部分中被拒绝的发现中的估计 FDR。\n\n将第 (3) 部分的最终数值以小数形式报告（而非百分比），并四舍五入到四位有效数字。无需单位。", "solution": "用户提供了一个涉及多重假设检验的统计遗传学问题。我将首先验证问题陈述，然后提供一个分步解答。\n\n### 第 1 步：提取已知条件\n- 独立假设检验的数量：$m = 20$。\n- 观测到的（未排序）$p$ 值：$0.12, 0.006, 0.2, 0.041, 0.028, 0.002, 0.061, 0.073, 0.72, 0.0008, 0.012, 0.018, 0.035, 0.6, 0.081, 0.021, 0.052, 0.004, 0.88, 0.009$。\n- 在原假设下，$p$ 值在 $[0,1]$ 上均匀分布。\n- 比例为 $\\pi_{0}$ 的假设是真实的原假设。\n- 任务 1：使用 Storey 估计量，调整参数 $\\lambda=0.5$，求出 $\\widehat{\\pi}_{0}$。\n- 任务 2：使用 Benjamini–Hochberg (BH) 程序，在目标 FDR 水平 $q=0.1$ 下，求出被拒绝的假设数量 $R$ 和拒绝阈值 $t_{\\mathrm{BH}}$。\n- 任务 3：使用第 (1) 部分得到的 $\\widehat{\\pi}_{0}$，计算在第 (2) 部分中找到的拒绝项的估计 FDR。\n- 最终答案应为第 (3) 部分的数值，四舍五入到四位有效数字。\n\n### 第 2 步：使用已知条件进行验证\n该问题具有科学依据。其背景是标准的表观基因组关联研究（EWAS），所描述的方法——多重检验、错误发现率（FDR）控制、Benjamini-Hochberg 程序以及用于原假设比例的 Storey 估计量——都是该领域使用的经典统计技术。该问题提法得当，提供了所有必要的数据和清晰、客观的指令，以得出一个唯一的解。数据是一致的，设置对于此类问题是现实的。该问题不违反任何无效标准。\n\n### 第 3 步：结论和行动\n该问题有效。将提供完整的解答。\n\n### 解答\n该问题需要一个三部分的计算，涉及多重假设检验的标准程序。\n\n**第 1 部分：使用 Storey 估计量估计原假设比例 $\\pi_{0}$。**\nStorey 估计量用于估计真实原假设的比例 $\\pi_{0}$，其公式为：\n$$ \\widehat{\\pi}_{0}(\\lambda) = \\frac{W(\\lambda)}{m(1-\\lambda)} $$\n其中 $m$ 是检验总数，$\\lambda$ 是一个调整参数，$W(\\lambda)$ 是大于 $\\lambda$ 的 $p$ 值的数量。\n给定 $m=20$ 和 $\\lambda=0.5$。我们必须计算观测到的 $p$ 值中大于 $0.5$ 的数量。提供的 $p$ 值为：\n$0.12, 0.006, 0.2, 0.041, 0.028, 0.002, 0.061, 0.073, 0.72, 0.0008, 0.012, 0.018, 0.035, 0.6, 0.081, 0.021, 0.052, 0.004, 0.88, 0.009$。\n大于 $0.5$ 的 $p$ 值是 $0.72$、$0.6$ 和 $0.88$。因此，计数为 $W(0.5) = 3$。\n将这些值代入估计量公式：\n$$ \\widehat{\\pi}_{0}(0.5) = \\frac{3}{20(1-0.5)} = \\frac{3}{20(0.5)} = \\frac{3}{10} = 0.3 $$\n\n**第 2 部分：应用 Benjamini–Hochberg (BH) 程序。**\nBH 程序将 FDR 控制在水平 $q$。首先，我们将 $m$ 个 $p$ 值从小到大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。然后，我们找到满足以下条件的最大整数 $k$：\n$$ p_{(k)} \\le \\frac{k}{m}q $$\n被拒绝的假设数量为 $R=k$，所有 $p$ 值满足 $p_i \\le p_{(k)}$ 的假设都被拒绝。因此，数据依赖的拒绝阈值为 $t_{\\mathrm{BH}} = p_{(k)}$。\n给定 $m=20$ 和 $q=0.1$，条件为 $p_{(i)} \\le \\frac{i}{20}(0.1) = 0.005 \\times i$。\n让我们对 $p$ 值进行排序，并对每个 $i=1, \\dots, 20$ 检查条件。排序后的 $p$ 值 $p_{(i)}$ 如下：\n1. $p_{(1)} = 0.0008$。BH 临界值：$0.005 \\times 1 = 0.005$。$0.0008 \\le 0.005$。（真）\n2. $p_{(2)} = 0.002$。BH 临界值：$0.005 \\times 2 = 0.010$。$0.002 \\le 0.010$。（真）\n3. $p_{(3)} = 0.004$。BH 临界值：$0.005 \\times 3 = 0.015$。$0.004 \\le 0.015$。（真）\n4. $p_{(4)} = 0.006$。BH 临界值：$0.005 \\times 4 = 0.020$。$0.006 \\le 0.020$。（真）\n5. $p_{(5)} = 0.009$。BH 临界值：$0.005 \\times 5 = 0.025$。$0.009 \\le 0.025$。（真）\n6. $p_{(6)} = 0.012$。BH 临界值：$0.005 \\times 6 = 0.030$。$0.012 \\le 0.030$。（真）\n7. $p_{(7)} = 0.018$。BH 临界值：$0.005 \\times 7 = 0.035$。$0.018 \\le 0.035$。（真）\n8. $p_{(8)} = 0.021$。BH 临界值：$0.005 \\times 8 = 0.040$。$0.021 \\le 0.040$。（真）\n9. $p_{(9)} = 0.028$。BH 临界值：$0.005 \\times 9 = 0.045$。$0.028 \\le 0.045$。（真）\n10. $p_{(10)} = 0.035$。BH 临界值：$0.005 \\times 10 = 0.050$。$0.035 \\le 0.050$。（真）\n11. $p_{(11)} = 0.041$。BH 临界值：$0.005 \\times 11 = 0.055$。$0.041 \\le 0.055$。（真）\n12. $p_{(12)} = 0.052$。BH 临界值：$0.005 \\times 12 = 0.060$。$0.052 \\le 0.060$。（真）\n13. $p_{(13)} = 0.061$。BH 临界值：$0.005 \\times 13 = 0.065$。$0.061 \\le 0.065$。（真）\n14. $p_{(14)} = 0.073$。BH 临界值：$0.005 \\times 14 = 0.070$。$0.073 > 0.070$。（假）\n\n满足该条件的最大 $k$ 为 $k=13$。\n因此，被拒绝的假设数量为 $R=13$。\n相应的拒绝阈值为 $t_{\\mathrm{BH}} = p_{(13)} = 0.061$。\n\n**第 3 部分：计算估计的 FDR。**\n对于给定的拒绝阈值 $t$，估计的 FDR 由置入公式给出：\n$$ \\widehat{\\mathrm{FDR}}(t) = \\frac{\\widehat{\\pi}_{0} m t}{R(t)} $$\n其中 $R(t)$ 是小于或等于 $t$ 的 $p$ 值的数量。\n我们使用由 BH 程序确定的阈值，$t = t_{\\mathrm{BH}} = 0.061$。\n从第 2 部分可知，在该阈值下的拒绝数量为 $R(t_{\\mathrm{BH}}) = 13$。\n从第 1 部分可知，原假设比例的估计值为 $\\widehat{\\pi}_{0} = 0.3$。\n我们还已知 $m=20$。\n将这些值代入公式：\n$$ \\widehat{\\mathrm{FDR}}(t_{\\mathrm{BH}}) = \\frac{(0.3)(20)(0.061)}{13} = \\frac{6 \\times 0.061}{13} = \\frac{0.366}{13} $$\n现在，我们进行除法运算：\n$$ \\frac{0.366}{13} \\approx 0.028153846... $$\n问题要求将结果四舍五入到四位有效数字。前四位有效数字是 $2, 8, 1, 5$。第五位有效数字是 $3$，小于 $5$，所以我们向下舍入。\n最终估计的 FDR 是 $0.02815$。", "answer": "$$\n\\boxed{0.02815}\n$$", "id": "4747256"}]}