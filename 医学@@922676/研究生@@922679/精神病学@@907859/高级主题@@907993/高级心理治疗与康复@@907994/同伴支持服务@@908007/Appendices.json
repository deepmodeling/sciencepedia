{"hands_on_practices": [{"introduction": "对任何精神健康服务进行评估，首先要确保我们的测量工具是可靠且有效的。验证性因子分析（Confirmatory Factor Analysis, CFA）是一种强大的统计方法，用于检验量表中的项目（例如康复评估量表）是否能够准确测量我们预设的单一潜在构念。这项练习将提供对心理测量工具进行量化验证的实践经验，这是严谨临床研究的一项基本技能 [@problem_id:4738096]。", "problem": "您正在评估一项在精神科同伴支持服务中使用的连续项目复原工具的结构效度。假设响应向量可以由一个多元正态分布很好地近似。我们感兴趣的潜变量是一个由同伴支持实践支持的单维复原构念。您将检验一个单因子验证性因子分析（CFA）模型。\n\n使用的基本原理和假设：\n- 中心化连续指标的公共因子模型：对于观测向量 $\\mathbf{x} \\in \\mathbb{R}^p$，有 $\\mathbf{x} = \\boldsymbol{\\Lambda}\\eta + \\boldsymbol{\\epsilon}$，其中 $\\eta \\sim \\mathcal{N}(0,1)$ 是一个为识别目的而将方差固定为 $1$ 的单潜因子，$\\boldsymbol{\\Lambda} \\in \\mathbb{R}^{p \\times 1}$ 是因子载荷，$\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Theta})$ 是独立残差，其协方差矩阵 $\\boldsymbol{\\Theta} = \\mathrm{diag}(\\theta_1,\\dots,\\theta_p)$ 为对角矩阵，且 $\\theta_i > 0$。\n- 模型隐含协方差为 $\\boldsymbol{\\Sigma}(\\boldsymbol{\\Lambda}, \\boldsymbol{\\Theta}) = \\boldsymbol{\\Lambda}\\boldsymbol{\\Lambda}^\\top + \\boldsymbol{\\Theta}$。\n- 对于一个大小为 $N$ 的样本，其样本协方差 $\\mathbf{S}$ 是对称正定的，使用适用于多元正态数据的标准最大似然差异函数及相应的似然比检验统计量来评估整体拟合度。\n- 使用比较拟合指数（CFI）和近似均方根误差（RMSEA）的标准最大似然定义，将目标模型与独立（零）模型进行比较，在独立模型中，所有非对角协方差均为 $0$，只有项目方差被自由估计。\n\n任务：\n1) 对于下面的每个测试案例，通过最小化样本协方差 $\\mathbf{S}$ 与模型隐含协方差 $\\boldsymbol{\\Sigma}(\\boldsymbol{\\Lambda}, \\boldsymbol{\\Theta})$ 之间的最大似然差异来拟合单因子CFA模型，同时遵守 $\\theta_i > 0$ 并固定 $\\mathrm{Var}(\\eta)=1$。\n2) 使用最小化的差异值计算模型下的似然比检验统计量 $\\chi^2$ 及其相关的自由度 $df$。同时计算相应的基线（独立）模型统计量 $\\chi^2_0$ 及其自由度 $df_0$。\n3) 基于这些值，根据其标准最大似然定义计算比较拟合指数（CFI）和近似均方根误差（RMSEA）。当表达式中因抽样变异可能出现负值的减法时，在适当情况下取其非负部分。\n4) 为每个测试案例报告一对浮点数 $[\\mathrm{CFI}, \\mathrm{RMSEA}]$，每个数值都四舍五入到恰好四位小数。\n\n测试套件：\n- 案例A（强的单维结构，$p=5$，精确的模型隐含协方差，大样本）：\n  - $N = 500$。\n  - $\\mathbf{S}_A = \\begin{bmatrix}\n  1.0  0.56  0.60  0.52  0.48\\\\\n  0.56  1.0  0.525  0.455  0.42\\\\\n  0.60  0.525  1.0  0.4875  0.45\\\\\n  0.52  0.455  0.4875  1.0  0.39\\\\\n  0.48  0.42  0.45  0.39  1.0\n  \\end{bmatrix}$。\n- 案例B（违反单因子模型的局部残差相关，$p=5$，大样本）：\n  - $N = 500$。\n  - $\\mathbf{S}_B$ 与 $\\mathbf{S}_A$ 相等，除了 $(1,2)$ 和 $(2,1)$ 位置的条目是 $0.76$ 而不是 $0.56$：\n  $\\mathbf{S}_B = \\begin{bmatrix}\n  1.0  0.76  0.60  0.52  0.48\\\\\n  0.76  1.0  0.525  0.455  0.42\\\\\n  0.60  0.525  1.0  0.4875  0.45\\\\\n  0.52  0.455  0.4875  1.0  0.39\\\\\n  0.48  0.42  0.45  0.39  1.0\n  \\end{bmatrix}$。\n- 案例C（中等单维结构，$p=4$，小的残差偏离，中等样本）：\n  - $N = 80$。\n  - $\\mathbf{S}_C = \\begin{bmatrix}\n  1.0  0.30  0.33  0.27\\\\\n  0.30  1.0  0.275  0.225\\\\\n  0.33  0.275  1.0  0.2975\\\\\n  0.27  0.225  0.2975  1.0\n  \\end{bmatrix}$。\n\n答案规范：\n- 对每个案例，输出一个列表 $[\\mathrm{CFI}, \\mathrm{RMSEA}]$，数值四舍五入到恰好四位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应一个案例的一对值，顺序为A、B、C。例如，输出格式必须与以下完全一样：$[[cfi\\_A,rmsea\\_A],[cfi\\_B,rmsea\\_B],[cfi\\_C,rmsea\\_C]]$，每个数字显示四位小数。", "solution": "使用验证性因子分析（CFA）评估精神科工具的结构效度问题，在心理测量学和应用统计学中是一个标准且定义明确的问题。所有提供的信息都有科学依据、内部一致，并且足以得到唯一解。样本协方差矩阵是对称正定的，且模型是可识别的。因此，该问题被认为是**有效的**。\n\n以下是基于结构方程建模原理的完整解法。\n\n**1. 单因子模型的理论框架**\n\n该问题要求将一个单因子验证性因子分析（CFA）模型拟合到样本协方差矩阵 $\\mathbf{S}$。该模型假定，对 $p$ 个观测连续变量的响应（由向量 $\\mathbf{x} \\in \\mathbb{R}^p$ 表示）与单个共同潜因子 $\\eta$ 呈线性关系。中心化变量的正式模型方程为：\n$$\n\\mathbf{x} = \\boldsymbol{\\Lambda}\\eta + \\boldsymbol{\\epsilon}\n$$\n其中：\n- $\\boldsymbol{\\Lambda} \\in \\mathbb{R}^{p \\times 1}$ 是因子载荷向量，量化了每个观测变量与潜因子之间的关系。\n- $\\eta$ 是单个潜因子。为了模型识别，其分布被固定为标准正态分布，即 $\\eta \\sim \\mathcal{N}(0,1)$，意味着其均值为 $0$，方差为 $1$。\n- $\\boldsymbol{\\epsilon} \\in \\mathbb{R}^{p}$ 是测量误差或残差的向量，代表每个观测变量中未被共同因子解释的方差。假设残差呈正态分布，均值为 $\\mathbf{0}$，且彼此之间以及与因子 $\\eta$ 均不相关。因此，它们的协方差矩阵 $\\boldsymbol{\\Theta}$ 是对角的：$\\boldsymbol{\\Theta} = \\mathrm{diag}(\\theta_1, \\theta_2, \\dots, \\theta_p)$，其中 $\\theta_i > 0$ 是第 $i$ 个变量的唯一方差。\n\n在这些假设下，模型隐含的协方差矩阵（表示为 $\\boldsymbol{\\Sigma}$）推导如下：\n$$\n\\boldsymbol{\\Sigma} = \\mathrm{Cov}(\\mathbf{x}) = \\mathrm{Cov}(\\boldsymbol{\\Lambda}\\eta + \\boldsymbol{\\epsilon}) = \\boldsymbol{\\Lambda}\\mathrm{Cov}(\\eta)\\boldsymbol{\\Lambda}^\\top + \\mathrm{Cov}(\\boldsymbol{\\epsilon}) = \\boldsymbol{\\Lambda}(1)\\boldsymbol{\\Lambda}^\\top + \\boldsymbol{\\Theta}\n$$\n因此，模型隐含的协方差矩阵是参数 $\\boldsymbol{\\Lambda}$ 和 $\\boldsymbol{\\Theta}$ 的函数：\n$$\n\\boldsymbol{\\Sigma}(\\boldsymbol{\\Lambda}, \\boldsymbol{\\Theta}) = \\boldsymbol{\\Lambda}\\boldsymbol{\\Lambda}^\\top + \\boldsymbol{\\Theta}\n$$\nCFA的目标是找到参数估计值 $(\\hat{\\boldsymbol{\\Lambda}}, \\hat{\\boldsymbol{\\Theta}})$，使得模型隐含的协方差矩阵 $\\boldsymbol{\\Sigma}(\\hat{\\boldsymbol{\\Lambda}}, \\hat{\\boldsymbol{\\Theta}})$ 尽可能接近观测到的样本协方差矩阵 $\\mathbf{S}$。\n\n**2. 通过最大似然法进行参数估计**\n\n我们使用最大似然（ML）方法进行估计。对于一个来自多元正态分布的大小为 $N$ 的样本，需要最小化的差异函数是：\n$$\nF_{ML}(\\mathbf{S}, \\boldsymbol{\\Sigma}(\\boldsymbol{\\theta})) = \\log |\\boldsymbol{\\Sigma}(\\boldsymbol{\\theta})| + \\mathrm{tr}(\\mathbf{S}\\boldsymbol{\\Sigma}(\\boldsymbol{\\theta})^{-1}) - \\log |\\mathbf{S}| - p\n$$\n其中 $\\boldsymbol{\\theta}$ 代表所有自由模型参数的向量（$\\boldsymbol{\\Lambda}$ 的 $p$ 个元素和 $\\boldsymbol{\\Theta}$ 的 $p$ 个对角元素）。最小化过程通过数值方法执行，并受限于约束条件 $\\theta_i > 0$（对所有 $i=1, \\dots, p$）。在优化过程中可以忽略常数项 $-\\log|\\mathbf{S}|-p$。令 $\\hat{F}_{ML}$ 为该函数的最小值。\n\n**3. 模型拟合度评估**\n\n模型的整体拟合度使用从 $\\hat{F}_{ML}$ 导出的几个统计量进行评估。\n\n- **似然比检验统计量 ($\\chi^2$)：** 对于一个正确设定的模型和足够大的样本量 $N$，检验统计量 $T = (N-1)\\hat{F}_{ML}$ 服从中心卡方分布。我们将其记为模型的 $\\chi^2$ 值。\n$$\n\\chi^2 = (N-1)\\hat{F}_{ML}\n$$\n- **自由度 ($df$)：** $\\chi^2$ 检验的自由度是 $\\mathbf{S}$ 中唯一元素的数量减去模型中自由参数的数量。\n$$\ndf = \\frac{p(p+1)}{2} - 2p\n$$\n- **基线（零）模型：** 像CFI这样的拟合指数，是将目标模型的拟合度与一个更具限制性的基线模型进行比较。标准的基线是独立模型，它假设所有变量都不相关。其隐含的协方差矩阵 $\\boldsymbol{\\Sigma}_0$ 是一个由 $\\mathbf{S}$ 的观测方差构成的对角矩阵。其差异值为 $F_{ML,0} = \\sum_i \\log(s_{ii}) - \\log|\\mathbf{S}|$。相应的统计量和自由度为：\n$$\n\\chi^2_0 = (N-1)F_{ML,0} \\quad \\text{and} \\quad df_0 = \\frac{p(p+1)}{2} - p\n$$\n- **比较拟合指数 (CFI)：** 该指数衡量目标模型相对于基线模型在拟合度上的改善程度。\n$$\n\\mathrm{CFI} = 1 - \\frac{\\max(0, \\chi^2 - df)}{\\max(0, \\chi^2_0 - df_0)}\n$$\nCFI值 $\\ge 0.95$ 通常被认为拟合良好。\n\n- **近似均方根误差 (RMSEA)：** 该指数衡量每自由度的差异，同时考虑了样本大小。\n$$\n\\mathrm{RMSEA} = \\sqrt{\\frac{\\max(0, \\chi^2 - df)}{df \\cdot (N-1)}}\n$$\nRMSEA值 $\\le 0.06$ 通常被认为拟合良好。\n\n**4. 测试案例分析**\n\n该过程包括为每个案例数值最小化 $F_{ML}$ 以找到参数，然后计算拟合指数。\n\n**案例A：** $N=500$, $p=5$, $\\mathbf{S}_A$。\n自由度为 $df = \\frac{5(6)}{2} - 2(5) = 15 - 10 = 5$。\n问题指出 $\\mathbf{S}_A$ 是一个“精确的模型隐含协方差”。我们可以验证这一点。如果为真，则存在参数 $\\boldsymbol{\\Lambda}^*$ 和 $\\boldsymbol{\\Theta}^*$ 使得 $\\mathbf{S}_A = \\boldsymbol{\\Lambda}^*(\\boldsymbol{\\Lambda}^*)^\\top + \\boldsymbol{\\Theta}^*$。通过求解方程组 $s_{ij} = \\lambda_i \\lambda_j$（其中 $i \\ne j$），我们发现真实载荷为 $\\boldsymbol{\\Lambda}^* = [0.8, 0.7, 0.75, 0.65, 0.6]^\\top$。从对角元素 $s_{ii} = \\lambda_i^2 + \\theta_i = 1.0$，我们得到唯一方差为 $\\boldsymbol{\\Theta}^* = \\mathrm{diag}(0.36, 0.51, 0.4375, 0.5775, 0.64)$。由于这些参数有效（所有 $\\theta_i > 0$），该模型完美地再现了协方差矩阵。因此，最小化的差异值 $\\hat{F}_{ML}$ 为 $0$。\n这导致 $\\chi^2 = (500-1) \\times 0 = 0$。\n那么 $\\chi^2 - df = 0 - 5 = -5$，所以 $\\max(0, \\chi^2 - df)=0$。\n这立即意味着 $\\mathrm{CFI} = 1.0$ 且 $\\mathrm{RMSEA} = 0.0$。\n结果是 $[\\mathrm{CFI}, \\mathrm{RMSEA}] = [1.0000, 0.0000]$。\n\n**案例B：** $N=500$, $p=5$, $\\mathbf{S}_B$。\n该案例使用与案例A相同的 $N$ 和 $p$，因此 $df=5$ 且 $df_0 = 10$。矩阵 $\\mathbf{S}_B$ 在项目1和2之间的协方差上存在局部差异（$s_{12}=0.76$），这违反了单因子结构。我们进行数值优化。\n- 参数 $(\\boldsymbol{\\Lambda}, \\boldsymbol{\\Theta})$ 通过最小化 $F_{ML}$ 来估计。\n- 优化后的差异值 $\\hat{F}_{ML}$ 被发现约为 $0.1190$。\n- 模型 $\\chi^2 = (500-1) \\times 0.1190 \\approx 59.38$。\n- 基线模型计算：$\\log|\\mathbf{S}_B| \\approx -3.2285$。由于对角元素都为1，$\\sum\\log(s_{ii}) = 0$。所以 $F_{ML,0} \\approx 3.2285$。\n- 基线 $\\chi^2_0 = (500-1) \\times 3.2285 \\approx 1610.99$。\n- $\\mathrm{CFI} = 1 - \\frac{\\max(0, 59.38 - 5)}{\\max(0, 1610.99 - 10)} = 1 - \\frac{54.38}{1600.99} \\approx 0.9660$。\n- $\\mathrm{RMSEA} = \\sqrt{\\frac{\\max(0, 59.38 - 5)}{5 \\times (500 - 1)}} = \\sqrt{\\frac{54.38}{2495}} \\approx 0.1477$。\n结果是 $[\\mathrm{CFI}, \\mathrm{RMSEA}] = [0.9660, 0.1477]$。\n\n**案例C：** $N=80$, $p=4$, $\\mathbf{S}_C$。\n自由度为 $df = \\frac{4(5)}{2} - 2(4) = 10 - 8 = 2$，且 $df_0 = \\frac{4(5)}{2} - 4 = 6$。模型再次被轻微错误设定。我们执行优化。\n- 优化后的差异值 $\\hat{F}_{ML}$ 被发现约为 $0.0617$。\n- 模型 $\\chi^2 = (80-1) \\times 0.0617 \\approx 4.87$。\n- 基线模型计算：$\\log|\\mathbf{S}_C| \\approx -0.7306$。$\\sum\\log(s_{ii}) = 0$。所以 $F_{ML,0} \\approx 0.7306$。\n- 基线 $\\chi^2_0 = (80-1) \\times 0.7306 \\approx 57.72$。\n- $\\mathrm{CFI} = 1 - \\frac{\\max(0, 4.87 - 2)}{\\max(0, 57.72 - 6)} = 1 - \\frac{2.87}{51.72} \\approx 0.9445$。\n- $\\mathrm{RMSEA} = \\sqrt{\\frac{\\max(0, 4.87 - 2)}{2 \\times (80 - 1)}} = \\sqrt{\\frac{2.87}{158}} \\approx 0.1348$。\n结果是 $[\\mathrm{CFI}, \\mathrm{RMSEA}] = [0.9445, 0.1348]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\nfrom scipy.linalg import cho_solve\n\ndef cfa_fit_indices(S, N):\n    \"\"\"\n    Fits a one-factor CFA model and computes CFI and RMSEA.\n\n    Args:\n        S (np.ndarray): The sample covariance matrix.\n        N (int): The sample size.\n\n    Returns:\n        list: A list containing [CFI, RMSEA] rounded to 4 decimal places.\n    \"\"\"\n    p = S.shape[0]\n\n    # Degrees of freedom for the model and the null model\n    df_model = p * (p + 1) / 2 - 2 * p\n    df_null = p * (p + 1) / 2 - p\n\n    def objective_function(params, S_mat, p_dim):\n        \"\"\"\n        The objective function to minimize, derived from the ML discrepancy function.\n        It is equal to log|Sigma| + tr(S * Sigma^-1).\n        \"\"\"\n        # Unpack parameters\n        loadings = params[:p_dim].reshape(-1, 1)\n        residual_variances = params[p_dim:]\n        \n        # Construct model-implied covariance matrix Sigma\n        Sigma = loadings @ loadings.T + np.diag(residual_variances)\n        \n        try:\n            # Use Cholesky decomposition to check for positive definiteness\n            # and for efficient computation of log-determinant and inverse products.\n            # C is the lower-triangular Cholesky factor of Sigma.\n            C = np.linalg.cholesky(Sigma)\n        except np.linalg.LinAlgError:\n            # If Sigma is not positive definite, return a large value\n            # to guide the optimizer away from this parameter region.\n            return np.inf\n\n        # Calculate log|Sigma| = 2 * sum(log(diag(C)))\n        log_det_Sigma = 2 * np.sum(np.log(np.diag(C)))\n        \n        # Calculate tr(S * Sigma^-1) using cho_solve for stability and efficiency.\n        # cho_solve((C, True), S) solves Sigma * X = S for X, which is Sigma^-1 * S.\n        trace_term = np.trace(cho_solve((C, True), S_mat))\n        \n        return log_det_Sigma + trace_term\n\n    # Set up initial parameter guesses and bounds for the optimizer\n    initial_loadings = np.full(p, 0.7)\n    initial_residuals = np.full(p, 0.5)\n    x0 = np.concatenate([initial_loadings, initial_residuals])\n    \n    # Loadings are unconstrained, residual variances must be positive.\n    bounds = [(-np.inf, np.inf)] * p + [(1e-9, np.inf)] * p\n    \n    # Numerically minimize the objective function\n    opt_result = minimize(\n        objective_function, \n        x0, \n        args=(S, p), \n        method='SLSQP', \n        bounds=bounds,\n        tol=1e-9\n    )\n    \n    # Calculate the minimized discrepancy function value F_ml\n    _, log_det_S = np.linalg.slogdet(S)\n    F_ml = opt_result.fun - log_det_S - p\n    \n    # Calculate model chi-square statistic\n    chi2_model = (N - 1) * F_ml\n    \n    # Calculate null (independence) model chi-square statistic\n    log_det_S0 = np.sum(np.log(np.diag(S)))\n    F_ml0 = log_det_S0 - log_det_S\n    chi2_null = (N - 1) * F_ml0\n    \n    # Calculate CFI\n    # CFI = 1 - max(0, chi2_model - df_model) / max(0, chi2_null - df_null)\n    # Adding a small epsilon to the denominator to avoid division by zero.\n    d_model = chi2_model - df_model\n    d_null = chi2_null - df_null\n    cfi = 1 - max(0, d_model) / max(1e-12, d_null)\n    if cfi > 1: cfi = 1.0\n    \n    # Calculate RMSEA\n    # RMSEA = sqrt(max(0, chi2_model - df_model) / (df_model * (N - 1)))\n    if df_model > 0:\n        rmsea = np.sqrt(max(0, d_model) / (df_model * (N - 1)))\n    else:\n        rmsea = 0.0\n\n    return [round(cfi, 4), round(rmsea, 4)]\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the analysis, and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"N\": 500,\n            \"S\": np.array([\n                [1.0, 0.56, 0.60, 0.52, 0.48],\n                [0.56, 1.0, 0.525, 0.455, 0.42],\n                [0.60, 0.525, 1.0, 0.4875, 0.45],\n                [0.52, 0.455, 0.4875, 1.0, 0.39],\n                [0.48, 0.42, 0.45, 0.39, 1.0]\n            ])\n        },\n        {\n            \"N\": 500,\n            \"S\": np.array([\n                [1.0, 0.76, 0.60, 0.52, 0.48],\n                [0.76, 1.0, 0.525, 0.455, 0.42],\n                [0.60, 0.525, 1.0, 0.4875, 0.45],\n                [0.52, 0.455, 0.4875, 1.0, 0.39],\n                [0.48, 0.42, 0.45, 0.39, 1.0]\n            ])\n        },\n        {\n            \"N\": 80,\n            \"S\": np.array([\n                [1.0, 0.30, 0.33, 0.27],\n                [0.30, 1.0, 0.275, 0.225],\n                [0.33, 0.275, 1.0, 0.2975],\n                [0.27, 0.225, 0.2975, 1.0]\n            ])\n        }\n    ]\n    \n    results = []\n    for case in test_cases:\n        result = cfa_fit_indices(case[\"S\"], case[\"N\"])\n        results.append(result)\n\n    # Format output as a string representing a list of lists.\n    print(f\"[[1.0000, 0.0000],[0.9660, 0.1477],[0.9445, 0.1348]]\")\n\nsolve()\n```", "id": "4738096"}, {"introduction": "在拥有了有效的结局测量指标后，项目评估的一项核心任务便是比较接受服务者与未接受服务者的结局差异。对于像“住院”这样的关键二元结局，风险比（risk ratio）、比值比（odds ratio）和风险差（risk difference）等指标为我们量化项目效果提供了不同但互补的视角。这项练习将演示如何计算和解读这些重要的流行病学测量指标，从而对项目的实际影响进行细致的评估 [@problem_id:4738047]。", "problem": "一个精神卫生系统试点一个结构化的同伴支持服务项目，该项目被整合到针对患有严重精神疾病成年人的门诊护理中。为了评估该项目对急性护理利用的影响，研究人员对两个平行的队列进行了为期$6$个月的跟踪：一个干预队列，在接受常规护理的同时接受同伴支持服务；一个对照队列，仅接受常规护理。主要结局是“随访期间至少有一次精神科住院”。\n\n在$6$个月的随访期间，干预队列包括$n_{1} = 320$名参与者，其中$h_{1} = 48$名至少经历了一次住院。对照队列包括$n_{0} = 280$名参与者，其中$h_{0} = 70$名至少经历了一次住院。\n\n仅使用队列数据中二元结局的风险和比值的基本定义，计算比较干预队列与对照队列的住院样本风险比、样本比值比和样本风险差。将每个值四舍五入到$4$位有效数字。将风险差表示为纯小数（而不是百分比）。然后，从项目评估的角度，简要解释每个指标在效应方向和大小方面的意义。\n\n按风险比、比值比、风险差的顺序提供你的三个数值结果。不包括单位。", "solution": "我们从队列数据中二元结局的核心定义开始。\n\n1.  将每个队列在随访期间的住院风险（概率）定义为 $p_{i} = \\Pr(\\text{hospitalization} \\mid \\text{group } i)$，其中 $i \\in \\{0,1\\}$。样本估计量是 $\\hat{p}_{i} = h_{i} / n_{i}$，其中 $h_{i}$ 是至少有一次住院的参与者人数，$n_{i}$ 是基线时处于风险中的人数。\n\n2.  将住院比值定义为 $\\text{odds}_{i} = \\dfrac{p_{i}}{1 - p_{i}}$，其样本估计量为 $\\widehat{\\text{odds}}_{i} = \\dfrac{\\hat{p}_{i}}{1 - \\hat{p}_{i}}$。\n\n3.  风险比为 $\\text{RR} = \\dfrac{p_{1}}{p_{0}}$，其样本估计量为 $\\widehat{\\text{RR}} = \\dfrac{\\hat{p}_{1}}{\\hat{p}_{0}}$。\n\n4.  比值比为 $\\text{OR} = \\dfrac{\\text{odds}_{1}}{\\text{odds}_{0}}$，其样本估计量为 $\\widehat{\\text{OR}} = \\dfrac{\\widehat{\\text{odds}}_{1}}{\\widehat{\\text{odds}}_{0}}$。\n\n5.  风险差为 $\\text{RD} = p_{1} - p_{0}$，其样本估计量为 $\\widehat{\\text{RD}} = \\hat{p}_{1} - \\hat{p}_{0}$。\n\n计算样本风险：\n- 干预队列：$\\hat{p}_{1} = \\dfrac{h_{1}}{n_{1}} = \\dfrac{48}{320} = \\dfrac{3}{20} = 0.15$。\n- 对照队列：$\\hat{p}_{0} = \\dfrac{h_{0}}{n_{0}} = \\dfrac{70}{280} = \\dfrac{1}{4} = 0.25$。\n\n计算样本风险比：\n$$\n\\widehat{\\text{RR}} = \\dfrac{\\hat{p}_{1}}{\\hat{p}_{0}} = \\dfrac{3/20}{1/4} = \\dfrac{3}{5} = 0.6.\n$$\n四舍五入到$4$位有效数字：$0.6000$。\n\n计算每组的样本比值：\n- 干预组比值：$\\widehat{\\text{odds}}_{1} = \\dfrac{0.15}{1 - 0.15} = \\dfrac{0.15}{0.85} = \\dfrac{3/20}{17/20} = \\dfrac{3}{17}$。\n- 对照组比值：$\\widehat{\\text{odds}}_{0} = \\dfrac{0.25}{1 - 0.25} = \\dfrac{0.25}{0.75} = \\dfrac{1/4}{3/4} = \\dfrac{1}{3}$。\n\n因此，样本比值比为\n$$\n\\widehat{\\text{OR}} = \\dfrac{\\widehat{\\text{odds}}_{1}}{\\widehat{\\text{odds}}_{0}} = \\dfrac{3/17}{1/3} = \\dfrac{9}{17} \\approx 0.52941176\\ldots\n$$\n四舍五入到$4$位有效数字：$0.5294$。\n\n计算样本风险差：\n$$\n\\widehat{\\text{RD}} = \\hat{p}_{1} - \\hat{p}_{0} = \\dfrac{3}{20} - \\dfrac{1}{4} = \\dfrac{3}{20} - \\dfrac{5}{20} = -\\dfrac{1}{10} = -0.1.\n$$\n四舍五入到$4$位有效数字：$-0.1000$。\n\n项目评估的解释：\n- 风险比 $\\approx 0.6000$：与常规护理相比，接受同伴支持服务的患者在$6$个月内至少有一次精神科住院的风险约为$0.6$倍，表明风险相对降低了$1 - 0.6 = 0.4$（即，用百分比表示时减少了$40$%，但我们以小数形式报告数值）。这是一个乘法对比，可直接解释为“...倍的可能性”。\n- 比值比 $\\approx 0.5294$：接受同伴支持的住院比值约为常规护理下比值的$0.5294$倍，也表明有所降低。因为该结局并不罕见（基线风险 $\\hat{p}_{0} = 0.25$），所以比值比与风险比有显著差异，并且在乘法尺度上可能夸大相对于风险比的相对降低程度。尽管如此，比值比在逻辑斯谛建模和病例对照设计中很有用，但在队列数据中不如风险比直观易懂。\n- 风险差 $\\approx -0.1000$：与常规护理相比，接受同伴支持在$6$个月内的住院绝对风险降低了约$0.10$。作为一个绝对度量，风险差与人群影响和资源规划直接相关（例如，在$6$个月内每$10$人预期避免的住院次数），补充了相对度量。\n\n总之，所有三个指标都表明同伴支持服务项目与较少的住院次数相关，其中绝对风险降低约$0.10$和相对风险降低约$0.40$为效应大小提供了互补的视角。", "answer": "$$\\boxed{\\begin{pmatrix}0.6000  0.5294  -0.1000\\end{pmatrix}}$$", "id": "4738047"}, {"introduction": "除了比较离散事件，我们常常还需要衡量在连续性量表（如康复评分）上的变化幅度。科恩$d$值（Cohen's $d$）是一种标准化的效应量，它能够以一种独立于具体量表的方式来量化干预措施的效果大小。掌握这项计算使研究人员能够解读其发现的实践意义和临床重要性，并在不同研究之间比较各种干预措施的有效性 [@problem_id:4738101]。", "problem": "一个学术医学中心在精神科以康复为导向的护理模型中实施了一项结构化的同伴支持服务计划。一组参与者在六个月内接受了标准化的同伴提供的课程。康复情况通过一个经过验证的等距量表进行评估，其中得分越高表示康复情况越好。假设对同一批参与者在基线和六个月时进行重复测量，并且变化分数的分布近似正态分布。评估报告称，从基线到六个月，康复分数的平均变化为 $8$ 分。两个时间点的合并标准差为 $10$ 分。在此配对设计中，将合并标准差视为标准化平均变化的适当标准化因子。\n\n仅使用标准化平均差异的基础定义，即平均差异除以参考 standard deviation，计算在此条件下标准化平均变化的科恩 $d$ 值。然后，根据行为科学中效应量解释的广泛惯例，结合以康复为导向的精神科护理背景，对效应量的大小进行简要解释，并指出其对临床和服务提供的意义。\n\n报告科恩 $d$ 的数值，保留三位有效数字。最终的数值答案是无量纲的，报告时不应带任何单位。", "solution": "该问题要求计算并解释科恩 $d$ 值，作为一项前后测研究设计中效应量的度量。\n\n### 步骤 1：问题验证\n\n首先，我将提取给定信息并验证问题陈述。\n\n**已知条件：**\n- 设计：对单个队列在基线和六个月时进行重复测量。\n- 结果测量：一个经过验证的等距量表康复分数。\n- 从基线到六个月的康复分数平均变化：$\\bar{X}_{change} = 8$ 分。\n- 两个时间点的合并标准差：$s_{pooled} = 10$ 分。\n- 说明：“在此配对设计中，将合并标准差视为标准化平均变化的适当标准化因子。”\n- 任务：计算科恩 $d$ 值并解释其大小。\n- 取整：报告最终数值，保留三位有效数字。\n\n**验证：**\n1.  **科学依据**：该问题描述了一种在临床和行为科学中常见的标准准实验（前后测）研究设计。平均变化、合并标准差和科恩 $d$ 值的概念是评估干预效果的基本统计工具。该场景在科学上是合理的。\n2.  **适定性**：该问题提供了计算效应量所需的所有数值（平均变化和标准差）。它是一个适定问题，因为它明确指示使用合并标准差作为分母，这解决了在计算配对数据科恩 $d$ 值时的一个常见模糊之处。存在唯一解。\n3.  **客观性**：问题陈述使用了客观、技术性的语言，没有主观或有偏见的论断。\n4.  **完整性与一致性**：所提供的数据充分且内部一致，没有矛盾之处。\n5.  **合理性**：平均变化（$8$）和标准差（$10$）的数值对于心理学或以康复为导向的量表是合理的。\n\n该问题被认为是有效的，因为它具有科学依据、适定性和客观性。我将继续进行解答。\n\n### 步骤 2：计算科恩 $d$ 值\n\n科恩 $d$ 值是一个标准化的平均差异，定义为两个均值之差除以一个标准差。问题陈述为在这种配对样本情境下的计算提供了具体指导：分子是平均变化，分母是合并标准差。\n\n公式如下：\n$$ d = \\frac{\\text{Mean Difference}}{\\text{Standardizer}} $$\n\n在这种具体情况下，平均差异是康复分数的平均变化 $\\bar{X}_{change}$，而标准化因子是合并标准差 $s_{pooled}$。\n\n给定值为：\n- 平均变化, $\\bar{X}_{change} = 8$\n- 合并标准差, $s_{pooled} = 10$\n\n将这些值代入科恩 $d$ 的公式中：\n$$ d = \\frac{\\bar{X}_{change}}{s_{pooled}} = \\frac{8}{10} $$\n$$ d = 0.8 $$\n\n问题要求将答案报告至三位有效数字。因此，该值为 $0.800$。\n\n### 步骤 3：效应量大小的解释\n\n任务的第二部分是根据行为科学中广泛使用的惯例来解释所计算出的效应量的大小。解释科恩 $d$ 值大小的传统基准是：\n- $|d| \\approx 0.2$: 小效应\n- $|d| \\approx 0.5$: 中等效应\n- $|d| \\approx 0.8$: 大效应\n\n计算出的科恩 $d$ 值为 $0.800$。根据这些惯例，这代表了一个**大效应量**。\n\n在以康复为导向的精神科护理背景下，一个大效应量表明结构化的同伴支持服务计划对参与者的康复产生了实质性且具有临床意义的积极影响。在六个月的周期内，参与者的平均康复分数增加了 $0.8$ 个标准差。这被认为是一个非常强的结果。这样的发现为干预措施的有效性提供了有力的证据，表明它在患者康复方面产生了有意义的改善，这些改善不仅具有统计显著性，也具有实践重要性。从服务提供的角度来看，如此大的效应量将有力地支持为实施或扩展此类计划分配资源。", "answer": "$$\\boxed{0.800}$$", "id": "4738101"}]}