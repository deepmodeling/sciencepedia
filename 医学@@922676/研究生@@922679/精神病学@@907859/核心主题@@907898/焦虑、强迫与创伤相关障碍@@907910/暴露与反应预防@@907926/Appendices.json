{"hands_on_practices": [{"introduction": "在将暴露与反应干预（ERP）等循证疗法付诸实践之前，临床医生和研究人员必须首先掌握其有效性的宏观证据。本练习的核心是计算和解释一个关键的流行病学指标——需治数（Number Needed to Treat, NNT）。通过分析一项模拟的随机对照试验（RCT）数据，您将学习如何将抽象的试验结果（如缓解率）转化为一个直观的、具有临床意义的效力衡量标准。这项技能对于批判性地评估治疗文献和做出明智的临床决策至关重要。[@problem_id:4710972]", "problem": "一项随机对照试验(RCT)旨在比较暴露与反应阻止(ERP)疗法与等待列表对照组对成年强迫症(OCD)患者的疗效。在12周时的缓解是根据标准的临床医生评定标准先验定义的。该试验采用意向性治疗(ITT)原则，将所有随机化的参与者都计算在内，并将脱落者归类为未缓解者。ERP组随机分配了$n_{\\text{ERP}} = 120$名参与者，其中46人达到缓解标准，14人脱落。等待列表组随机分配了$n_{\\text{WL}} = 120$名参与者，其中10人达到缓解标准，8人脱落。使用ITT原则以及风险、绝对风险降低和需治疗人数的标准定义，计算ERP相对于等待列表对照组的需治疗人数(NNT)，并将缓解视为有益结局。然后，就缓解而言，对该NNT的大小提供一个简明的临床解释。将NNT表示为一个无单位的纯数，并将最终答案四舍五入到四位有效数字。", "solution": "首先将验证问题的科学合理性、清晰性和完整性。\n\n### 步骤1：提取已知条件\n问题陈述中提供的明确数据和条件如下：\n- **研究设计：** 随机对照试验 (RCT)。\n- **干预组：** 暴露与反应阻止疗法 (ERP)。\n- **对照组：** 等待列表对照组 (WL)。\n- **人群：** 患有强迫症(OCD)的成年人。\n- **结局：** 12周时的缓解，先验定义。\n- **分析原则：** 意向性治疗 (ITT)。\n- **针对脱落者的ITT规则：** 脱落者被归类为未缓解者。\n- **ERP组样本量：** 随机分配了$n_{\\text{ERP}} = 120$名参与者。\n- **ERP组结局：** 46名参与者达到缓解标准；14名参与者脱落。\n- **等待列表组样本量：** 随机分配了$n_{\\text{WL}} = 120$名参与者。\n- **等待列表组结局：** 10名参与者达到缓解标准；8名参与者脱落。\n- **任务：** 计算需治疗人数 (NNT)。\n- **四舍五入：** NNT的最终数值答案必须四舍五入到四位有效数字。\n- **解释：** 对NNT提供一个简明的临床解释。\n\n### 步骤2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估：\n- **科学依据：** 该问题牢固地植根于临床流行病学和生物统计学。RCT、针对OCD的ERP、意向性治疗分析、绝对风险降低(ARR)和需治疗人数(NNT)等概念都是标准的、定义明确的，并且是循证医学的核心。\n- **提法恰当：** 该问题提法恰当。它提供了计算唯一NNT值所需的所有必要数据（$n_{\\text{ERP}}$、$n_{\\text{WL}}$、每组的缓解人数）和清晰的分析原则定义（ITT，并将脱落者视为未缓解者）。\n- **客观性：** 语言精确客观，描述了一个标准的定量分析任务，不含主观或基于意见的元素。\n- **完整性和一致性：** 数据完整且一致。根据ITT原则，比率计算的分母是随机化的参与者总数。事件（缓解）的数量已给出。关于脱落者的信息明确指出，他们被计入分母并被视为非事件（未缓解者），这是ITT原则的一种常见且保守的应用。问题设置内部一致，没有歧义。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**，因为它科学合理、提法恰当、客观且自洽。将继续进行求解。\n\n### 解题过程\n目标是基于12周时的缓解率，计算ERP与等待列表对照组相比的需治疗人数(NNT)。NNT是衡量医疗干预措施有效性的指标。\n\nNNT被定义为绝对风险降低(ARR)的倒数：\n$$ NNT = \\frac{1}{ARR} $$\nARR是试验组和对照组之间事件发生率的绝对差值。对于像缓解这样的有益结局，ARR的计算公式为：\n$$ ARR = EER - CER $$\n其中，$EER$是试验组事件率（ERP组的缓解率），$CER$是对照组事件率（等待列表组的缓解率）。\n\n分析必须遵循意向性治疗(ITT)原则。该原则规定，所有被随机分配的参与者都应被纳入统计分析，并在其最初被分配的组中进行分析，无论他们是否遵守了入组标准、实际接受了何种治疗或是否退出了研究。问题明确指出，脱落者被计为未缓解者。\n\n首先，我们计算ERP组的试验组事件率($EER$)。随机分配到ERP组的参与者总数为$n_{\\text{ERP}} = 120$。达到缓解（“事件”）的参与者人数为46。\n$$ EER = \\frac{\\text{ERP组的缓解人数}}{\\text{随机分配到ERP组的总参与者人数}} = \\frac{46}{120} $$\n\n接下来，我们计算等待列表组的对照组事件率($CER$)。随机分配到等待列表组的参与者总数为$n_{\\text{WL}} = 120$。达到缓解的参与者人数为10。\n$$ CER = \\frac{\\text{等待列表组的缓解人数}}{\\text{随机分配到等待列表组的总参与者人数}} = \\frac{10}{120} $$\n\n现在，我们计算绝对风险降低(ARR)：\n$$ ARR = EER - CER = \\frac{46}{120} - \\frac{10}{120} = \\frac{46 - 10}{120} = \\frac{36}{120} $$\nARR可以简化为：\n$$ ARR = \\frac{36}{120} = \\frac{3 \\times 12}{10 \\times 12} = \\frac{3}{10} = 0.3 $$\n\n最后，我们计算需治疗人数(NNT)，即ARR的倒数。在临床实践中，为了决策，NNT值通常会向上取整到下一个整数，但在这里我们遵循指令，四舍五入到四位有效数字。\n$$ NNT = \\frac{1}{ARR} = \\frac{1}{0.3} = \\frac{1}{3/10} = \\frac{10}{3} $$\n作为小数，这是$3.3333...$。四舍五入到四位有效数字得到：\n$$ NNT \\approx 3.333 $$\n\n此NNT值的临床解释如下：NNT为$3.333$意味着，平均而言，每$3.333$名接受ERP治疗12周的OCD患者中，就有一名额外的患者会实现缓解，而如果他们在等待列表对照组中，这名患者是不会实现缓解的。这表明该治疗非常有效，因为较低的NNT对应较高的治疗效力。在实践中，用ERP治疗大约$3$到$4$名患者，就会比在等待列表条件下预期的自发缓解或非特异性因素所带来的效果多产生一个成功的结局（缓解）。", "answer": "$$\n\\boxed{3.333}\n$$", "id": "4710972"}, {"introduction": "在确定了ERP的总体有效性之后，我们的焦点便从群体转向个体患者。成功的治疗不仅需要有效的干预，还需要明确、可衡量的目标。本练习将使用强迫症评估的“金标准”——耶鲁-布朗强迫症量表（Y-BOCS），来演示临床医生如何将“有临床意义的”改善这一概念操作化。您将通过计算，把基于百分比的缓解标准转化为一个具体的、可操作的分数下降阈值，从而精确定义治疗成功。[@problem_id:4710919]", "problem": "一名强迫症（OCD）患者正开始接受暴露与反应阻止疗法（ERP）。这是一种基于经典条件反射和操作性条件反射原理的行为干预方法，通过将患者暴露于其恐惧的刺激，同时阻止其强迫性反应，来消除由焦虑驱动的强化。耶鲁-布朗强迫症量表（Y-BOCS）被用于量化ERP治疗前后的症状严重程度。Y-BOCS是一个由临床医生评定的工具，包含10个项目，每个项目评分从0到4分，因此总分范围为0到40分。该量表有两个子量表：强迫观念子量表（项目1–5；得分范围0–20）和强迫行为子量表（项目6–10；得分范围0–20）。总分是两个子量表得分之和。\n\n一位临床医生希望定义一个具有临床意义的变化阈值。该阈值被定义为Y-BOCS总分的最小整数下降值，且该下降值需同时满足以下两个标准。这两个标准均基于临床心理测量学中常见的基线比例下降标准：(i) Y-BOCS总分至少下降 $35\\%$，以及 (ii) 每个子量表得分至少下降 $10\\%$。基线分数为：强迫观念子量表 $O_{0} = 13$，强迫行为子量表 $C_{0} = 17$，总分 $T_{0} = O_{0} + C_{0} = 30$。\n\n请仅使用基本测量原理（离散项目计分、总分等于子量表之和、以及相对于基线定义的比例下降），从第一性原理推导出总分下降的最小整数阈值，该阈值要能确保通过在两个子量表上进行某种下降值分配，可以同时满足上述两个标准。请用一个整数分数表示您的最终答案。由于项目得分和子量表总分都是整数，因此除了要求阈值为整数分数外，不需要其他取整说明。", "solution": "经评估，此问题有效。它在临床心理测量学实践中有科学依据，提法明确，具有清晰的量化标准和充分的数据，并且其表述是客观的。我们可以着手进行正式的解答。\n\n设强迫观念子量表、强迫行为子量表和Y-BOCS总分的基线得分分别用 $O_{0}$、$C_{0}$ 和 $T_{0}$ 表示。设治疗后得分分别为 $O_{1}$、$C_{1}$ 和 $T_{1}$。得分下降值定义为 $\\Delta O = O_{0} - O_{1}$、$\\Delta C = C_{0} - C_{1}$ 和 $\\Delta T = T_{0} - T_{1}$。\n问题说明总分是子量表得分之和，所以有 $T_0 = O_0 + C_0$ 和 $T_1 = O_1 + C_1$。这意味着总下降值是各子量表下降值之和：\n$$\n\\Delta T = (O_{0} - O_{1}) + (C_{0} - C_{1}) = \\Delta O + \\Delta C\n$$\nY-BOCS的得分是整数值，因此下降值 $\\Delta O$、$\\Delta C$ 和 $\\Delta T$ 也必须是整数。\n\n给定的基线分数为：\n$O_{0} = 13$\n$C_{0} = 17$\n$T_{0} = O_{0} + C_{0} = 13 + 17 = 30$\n\n我们的任务是找到总分下降的最小整数值 $\\Delta T$，使其能同时满足两个标准。让我们将这些标准形式化为数学不等式。\n\n标准(i)：Y-BOCS总分至少下降 $35\\%$。\n这可以写成：\n$$\n\\frac{\\Delta T}{T_{0}} \\ge 0.35\n$$\n代入 $T_{0} = 30$：\n$$\n\\frac{\\Delta T}{30} \\ge 0.35\n$$\n$$\n\\Delta T \\ge 0.35 \\times 30\n$$\n$$\n\\Delta T \\ge 10.5\n$$\n由于 $\\Delta T$ 必须是整数，满足此标准的最小整数值 $\\Delta T$ 是 $11$。因此，根据标准(i)，我们必须有：\n$$\n\\Delta T \\ge 11\n$$\n\n标准(ii)：每个子量表得分至少下降 $10\\%$。\n该标准包含两个独立的条件。\n\n对于强迫观念子量表：\n$$\n\\frac{\\Delta O}{O_{0}} \\ge 0.10\n$$\n代入 $O_{0} = 13$：\n$$\n\\frac{\\Delta O}{13} \\ge 0.10\n$$\n$$\n\\Delta O \\ge 1.3\n$$\n由于 $\\Delta O$ 必须是整数，满足此条件的最小整数值 $\\Delta O$ 是 $2$。\n$$\n\\Delta O \\ge 2\n$$\n\n对于强迫行为子量表：\n$$\n\\frac{\\Delta C}{C_{0}} \\ge 0.10\n$$\n代入 $C_{0} = 17$：\n$$\n\\frac{\\Delta C}{17} \\ge 0.10\n$$\n$$\n\\Delta C \\ge 1.7\n$$\n由于 $\\Delta C$ 必须是整数，满足此条件的最小整数值 $\\Delta C$ 是 $2$。\n$$\n\\Delta C \\ge 2\n$$\n\n问题要求的是总分下降的最小整数阈值 $\\Delta T$，使得能够找到一种在子量表（$\\Delta O$ 和 $\\Delta C$）上的下降值分配方案，以满足所有标准。这意味着我们要寻找 $\\Delta T$ 的最小整数值，使得存在整数 $\\Delta O$ 和 $\\Delta C$ 满足以下条件系统：\n1. $\\Delta T \\ge 11$\n2. $\\Delta O \\ge 2$\n3. $\\Delta C \\ge 2$\n4. $\\Delta T = \\Delta O + \\Delta C$\n\n根据条件(1)，$\\Delta T$ 的最小可能整数值为 $11$。我们现在必须验证，当总下降值 $\\Delta T = 11$ 时，是否能同时满足条件(2)、(3)和(4)。\n我们设 $\\Delta T = 11$。我们需要检查是否存在整数 $\\Delta O$ 和 $\\Delta C$，使得：\n$$\n\\Delta O + \\Delta C = 11 \\quad \\text{with} \\quad \\Delta O \\ge 2 \\quad \\text{and} \\quad \\Delta C \\ge 2\n$$\n我们可以通过为其中一个子量表的下降值选择一个数值，然后求解另一个，来检验这一点。我们选择 $\\Delta O$ 的最小可能值，即 $\\Delta O = 2$。这将要求 $\\Delta C = 11 - 2 = 9$。这对下降值 $(\\Delta O, \\Delta C) = (2, 9)$ 满足条件：两者都是整数，$\\Delta O = 2 \\ge 2$，并且 $\\Delta C = 9 \\ge 2$。\n\n此外，这些下降值必须在临床上是可能的。得分的下降值不能超过其基线得分本身。\n对于 $\\Delta O = 2$，我们必须有 $O_1 = O_0 - \\Delta O = 13 - 2 = 11 \\ge 0$，这是有效的。\n对于 $\\Delta C = 9$，我们必须有 $C_1 = C_0 - \\Delta C = 17 - 9 = 8 \\ge 0$，这也是有效的。\n\n既然我们找到了一个有效的下降值分配方案 $(\\Delta O = 2, \\Delta C = 9)$，其总和为一个总下降值 $\\Delta T = 11$，同时满足所有标准，那么总分下降11分是可行的。\n任何小于11的 $\\Delta T$ 整数值，例如 $\\Delta T = 10$，都将违反标准(i)（$\\Delta T \\ge 10.5$）。\n因此，确保所有标准都能被满足的总分下降最小整数阈值是 $11$。", "answer": "$$\n\\boxed{11}\n$$", "id": "4710919"}, {"introduction": "最后，我们将深入探索ERP的核心机制：在单次暴露过程中对焦虑的习得性消退（habituation）。主观痛苦单位量表（Subjective Units of Distress Scale, SUDS）为我们提供了一个实时观察这一过程的窗口。在此实践中，您将对一次暴露试验中记录的SUDS评分随时间的变化进行建模。通过拟合一个指数衰减函数，您将学习如何量化治疗过程中的核心动态，从而将患者的主观体验与一个简洁的数学模型联系起来。[@problem_id:4710967]", "problem": "您正在使用主观痛苦单位量表 (Subjective Units of Distress Scale, SUDS) 对暴露与反应阻止疗法 (Exposure and Response Prevention, ERP) 疗程中的痛苦减轻情况进行建模。SUDS 定义为患者在有界数值量表上报告的评分。\n\n假设在单次 ERP 暴露试验中，痛苦程度随时间呈指数衰减函数变化。令 $S_t$ 表示在时间 $t$ 观测到的 SUDS 评分，并假设其潜在轨迹遵循指数衰减定律 $S_t = S_0 e^{-\\beta t}$，其中 $S_0$ 是初始 SUDS 水平，$\\beta$ 是衰减率。时间 $t$ 以分钟为单位；报告任何估计的衰减率时，单位应为 $1/\\text{分钟}$。您的目标是根据带有时间戳的评分，在考虑了真实的测量噪声和可能的地板效应（例如，在试验接近结束时报告 $S_t = 0$）的情况下，估计 $\\beta$。\n\n您的方法必须基于第一性原理，从以下两点出发：(i) 指数函数的定义及其代数性质，以及 (ii) 最小二乘法原理，该原理通过最小化模型预测值与观测值之间的残差平方和来估计参数。您必须基于这些原理进行推理，构建一个算法，以便在给定带时间戳的 SUDS 数据时，能够对 $\\beta$ 产生一个稳定的估计。请确保您的方法在某些 $S_t$ 观测值为零以及早期测量值（包括 $t=0$ 时的测量值）缺失的情况下仍然是良定义的。除了可以由这些原理论证的以外，不要假设任何特定的分布捷径。如果您使用任何变换，请明确地基于代数和最小二乘法原理来证明其合理性。\n\n此问题的输入直接嵌入在程序中，无需用户输入。请使用以下带有时间戳的 SUDS 观测值测试集，每个测试用例是一个由数对 $(t_i, s_i)$ 组成的列表，其中 $t_i$ 的单位是分钟，$s_i$ 是范围在 $[0, 100]$ 内的整数：\n\n- 案例 A (中度噪声下的典型衰减): $[(0, 80), (2, 65), (4, 51), (6, 40), (8, 33), (10, 25), (12, 19), (15, 13)]$。\n- 案例 B (痛苦程度近似恒定；接近 $\\beta = 0$ 的边界情况): $[(0, 60), (3, 61), (6, 59), (9, 60), (12, 58), (15, 60)]$。\n- 案例 C (伴有地板效应（包括零值）的强衰减): $[(0, 40), (2, 22), (4, 12), (6, 7), (8, 3), (10, 0), (12, 0)]$。\n- 案例 D ($t=0$ 时无测量值，中度衰减): $[(5, 61), (10, 39), (15, 28), (20, 18), (25, 12), (30, 8)]$.\n- 案例 E (轻度噪声下的缓慢衰减): $[(0, 70), (5, 65), (10, 59), (15, 53), (20, 47), (25, 43), (30, 39)]$。\n\n您的程序必须对每个案例，仅使用上述信息来估计衰减率 $\\beta$ (单位 $1/\\text{分钟}$)。当应用于所提供的数据时，您的算法必须是确定性的。将每个最终估计表示为四舍五入到四位小数的浮点数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果顺序与测试用例 A 到 E 的顺序相同（例如，$[b_A,b_B,b_C,b_D,b_E]$）。输出必须只有一行。\n\n注意事项和约束条件：\n- 不涉及角度；无需角度单位。\n- 所有答案均为实值浮点数；不得报告百分比。\n- 科学真实性：请勿违反 SUDS 评分的有界性，并确保您的估计方法在某些观测值为 $S_t = 0$ 时仍然有意义。当所有 $S_t > 0$ 时，您的方法应简化为标准的最小二乘估计量。", "solution": "该问题要求从一组带时间戳的主观痛苦单位 (SUDS) 评分 $(t_i, s_i)$ 中估计指数衰减率 $\\beta$。时间 $t$ 时痛苦水平 $S_t$ 的基本模型由 $S_t = S_0 e^{-\\beta t}$ 给出，其中 $S_0$ 是初始痛苦水平，$\\beta$ 是衰减率，单位为 $1/\\text{分钟}$。估计算法必须从第一性原理推导得出，即指数函数的代数性质和最小二乘法原理。该方法还必须对测量噪声、地板效应（即观测值 $s_i=0$ 的情况）以及 $t=0$ 时数据缺失的情况具有鲁棒性。\n\n控制方程 $S_t = S_0 e^{-\\beta t}$ 是一个关于参数 $\\beta$ 和 $S_0$ 的非线性函数。直接应用最小二乘法原理将涉及最小化残差平方和 $SSE = \\sum_i (s_i - S_0 e^{-\\beta t_i})^2$，这需要使用非线性优化方法。然而，问题陈述指导我们利用指数函数的代数性质来简化估计过程。\n\n我们可以通过对等式两边取自然对数来线性化模型。根据性质 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(e^x) = x$，我们得到：\n$$ \\ln(S_t) = \\ln(S_0 e^{-\\beta t}) = \\ln(S_0) + \\ln(e^{-\\beta t}) = \\ln(S_0) - \\beta t $$\n该方程是直线形式 $y = c + mx$，其中：\n- 因变量是 $y = \\ln(S_t)$。\n- 自变量是 $x = t$。\n- 截距是 $c = \\ln(S_0)$。\n- 斜率是 $m = -\\beta$。\n\n这种变换使我们能够使用线性最小二乘法，这是一种更简单、更直接的方法。将最小二乘法原理应用于此线性化模型，旨在找到参数 $m$ 和 $c$，以最小化变换后的观测数据与线性模型预测值之间的平方差之和。需要最小化的目标函数是：\n$$ SSE_{\\text{log}} = \\sum_i (\\ln(s_i) - (c + m t_i))^2 $$\n\n这种方法必须处理所提到的特定数据特征。\n首先，如果观测到的 SUDS 评分 $s_i$ 为零，则对数变换 $\\ln(s_i)$ 是未定义的。物理模型 $S_t = S_0 e^{-\\beta t}$（对于 $S_0 > 0$）意味着在任何有限时间 $t$ 内，真实的痛苦水平总是正数，$S_t > 0$。因此，观测到 $s_i=0$ 最好被理解为一种“地板效应”，即由于测量量表的限制，一个微小但非零的痛苦水平被报告为零。由于这些点位于对数变换模型的定义域之外，因此原则性的做法是从回归分析中排除任何 $s_i \\le 0$ 的数据点 $(t_i, s_i)$。因此，误差平方和是在 $s_i > 0$ 的数据子集上计算的。\n\n其次，在 $t=0$ 时没有测量值的情况对该方法不构成问题。线性回归的标准公式适用于一组 $(x_i, y_i)$ 对，并不要求其中一个 $x_i$ 值为零。回归将为可用数据计算出最佳拟合直线，所得的截距参数 $c$ 仍然是模型对 $t=0$ 时 $\\ln(S_t)$ 的估计值。\n\n在模型线性化和数据处理规则建立之后，我们可以找到最小化 $SSE_{\\text{log}}$ 的斜率 $m$。对于一组包含 $N$ 个有效数据点、已变换为 $(x_i, y_i) = (t_i, \\ln(s_i))$ 的数据集，普通最小二乘回归线的斜率由从正规方程导出的著名公式给出：\n$$ m = \\frac{N \\sum_{i=1}^{N} (x_i y_i) - (\\sum_{i=1}^{N} x_i) (\\sum_{i=1}^{N} y_i)}{N \\sum_{i=1}^{N} (x_i^2) - (\\sum_{i=1}^{N} x_i)^2} $$\n根据我们的线性模型定义，我们有关系式 $m = -\\beta$。因此，衰减率 $\\beta$ 的估计量 $\\hat{\\beta}$ 为：\n$$ \\hat{\\beta} = -m = -\\frac{N \\sum (t_i \\ln(s_i)) - (\\sum t_i)(\\sum \\ln(s_i))}{N \\sum (t_i^2) - (\\sum t_i)^2} $$\n其中求和是对所有满足 $s_i > 0$ 的 $i$ 进行的。\n\n要实现的算法如下：\n1.  对于每个测试用例，接收数据对 $(t_i, s_i)$ 的列表。\n2.  筛选此列表，创建一个新的数据集，其中只包含 SUDS 评分 $s_i$ 严格为正的数据对。\n3.  从这个筛选后的集合中，构建两个向量：一个用于时间值 $t$，另一个用于 SUDS 评分的自然对数 $y = \\ln(s)$。\n4.  如果有效数据点少于两个，则无法拟合唯一的直线；否则，继续。所有提供的测试用例都有足够的数据。\n5.  将普通最小二乘公式应用于 $(t, y)$ 数据以计算斜率 $m$。使用成熟的数值库来完成此操作最为鲁棒。\n6.  计算衰减率估计值 $\\hat{\\beta} = -m$。\n7.  按要求将得到的 $\\hat{\\beta}$ 四舍五入到四位小数。\n8.  对所有测试用例重复此过程，并将输出格式化为单个列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating exponential decay rates from SUDS data.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = {\n        'A': [(0, 80), (2, 65), (4, 51), (6, 40), (8, 33), (10, 25), (12, 19), (15, 13)],\n        'B': [(0, 60), (3, 61), (6, 59), (9, 60), (12, 58), (15, 60)],\n        'C': [(0, 40), (2, 22), (4, 12), (6, 7), (8, 3), (10, 0), (12, 0)],\n        'D': [(5, 61), (10, 39), (15, 28), (20, 18), (25, 12), (30, 8)],\n        'E': [(0, 70), (5, 65), (10, 59), (15, 53), (20, 47), (25, 43), (30, 39)],\n    }\n\n    def estimate_beta(data):\n        \"\"\"\n        Estimates the decay rate beta by linearizing the exponential model\n        and performing a least-squares regression.\n\n        The model is S_t = S_0 * exp(-beta * t).\n        Taking the natural log gives: ln(S_t) = ln(S_0) - beta * t.\n        This is a linear equation y = c + m*x, where:\n        y = ln(S_t)\n        x = t\n        m = -beta (slope)\n        c = ln(S_0) (intercept)\n\n        Args:\n            data (list of tuples): A list of (time, suds) observations.\n\n        Returns:\n            float: The estimated decay rate beta.\n        \"\"\"\n        # Filter out observations where SUDS rating is 0 or less,\n        # as ln(s) is undefined for s = 0.\n        # This handles floor effects where latent distress is small but reported as 0.\n        valid_data = [item for item in data if item[1] > 0]\n        \n        # We need at least two points to fit a line.\n        if len(valid_data)  2:\n            return np.nan # Or raise an error, but for this problem, data is sufficient.\n\n        # Unpack the valid data into separate arrays for time and SUDS.\n        t_values = np.array([item[0] for item in valid_data])\n        s_values = np.array([item[1] for item in valid_data])\n\n        # Apply the logarithmic transformation to linearize the model.\n        y_values = np.log(s_values)\n        \n        # Perform ordinary least squares linear regression to find the slope.\n        # scipy.stats.linregress returns (slope, intercept, r_value, p_value, std_err).\n        # The slope 'm' is equal to -beta.\n        slope, _, _, _, _ = stats.linregress(t_values, y_values)\n        \n        # The decay rate beta is the negative of the slope.\n        beta = -slope\n        \n        return beta\n\n    results = []\n    # Process each test case in the specified order (A-E).\n    for case_id in sorted(test_cases.keys()):\n        data = test_cases[case_id]\n        beta_estimate = estimate_beta(data)\n        # Format the result to four decimal places.\n        results.append(f\"{beta_estimate:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4710967"}]}