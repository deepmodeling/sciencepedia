{"hands_on_practices": [{"introduction": "将观察到的序列差异转化为真实的进化距离，是分子系统发育学中的一个核心挑战，这需要借助数学模型进行校正。本练习 [@problem_id:2407121] 将引导你从最基本的 Jukes-Cantor (JC69) 模型的瞬时速率矩阵出发，推导出其著名的距离校正公式。通过这个推导，你将掌握连接模型底层参数与宏观进化距离的关键数学技能，为理解更复杂的模型打下坚实基础。", "problem": "一个在核苷酸字母表 $\\{A, C, G, T\\}$ 上的连续时间马尔可夫链 (CTMC) 遵循 Jukes–Cantor (JC) 模型进行演化。JC 瞬时速率矩阵 $Q_{JC}$ 定义为：当 $i \\neq j$ 时，$Q_{ij} = \\alpha$；当 $i = j$ 时，$Q_{ii} = -3\\alpha$，其中 $\\alpha > 0$ 是一个常数，且 $i,j \\in \\{A, C, G, T\\}$。令 $P(t) = \\exp(Q_{JC} t)$ 表示在时间 $t \\ge 0$ 时的转移概率矩阵。假设该过程是平稳的，其平稳分布为均匀分布，即对所有 $i$ 都有 $\\pi_i = \\frac{1}{4}$。\n\n考虑两个同源 DNA 序列，它们在 JC 模型下从一个共同祖先演化而来，沿着一条总耗时为 $\\tau > 0$ 的路径（也就是说，分开这两个序列的分支时长之和为 $\\tau$）。令 $p$ 表示在此模型下，两个序列在同源位点上核苷酸差异的期望汉明分数。定义 Jukes–Cantor 演化距离 $d$ 为沿着连接这两个序列的路径上每位点的期望替换数。在 JC 模型下，平稳状态下每位点的平均瞬时替换率为 $\\mu = \\sum_{i} \\pi_i \\left(-Q_{ii}\\right)$，因此有 $d = \\mu \\,\\tau$。\n\n从上述定义和速率矩阵 $Q_{JC}$ 出发，推导出一个仅以 $p$ 为函数的 $d$ 的闭式表达式，消去 $\\alpha$ 和 $\\tau$。将你的最终结果表示为仅含 $p$ 的单一解析表达式。无需单位。", "solution": "我们的目标是推导出演化距离 $d$（每位点的期望替换数）与观测到的差异比例 $p$ 之间的关系。这需要建立这些量与 JC 模型的基础参数（即替换率参数 $\\alpha$ 和总时间 $\\tau$）之间的关系。\n\n首先，我们根据定义计算每位点的平均替换率 $\\mu$。在JC模型中，平稳分布是均匀的（$\\pi_i = 1/4$），离开任何状态 $i$ 的速率是 $-Q_{ii} = 3\\alpha$。因此：\n$$ \\mu = \\sum_{i \\in \\{A,C,G,T\\}} \\pi_i (-Q_{ii}) = 4 \\times \\frac{1}{4} (3\\alpha) = 3\\alpha $$\n演化距离 $d$ 定义为总路径上的期望替换数，路径总时长为 $\\tau$，所以 $d = \\mu \\tau = 3\\alpha\\tau$。\n\n接下来，我们推导观测差异比例 $p$。$p$ 是在总分支长度为 $\\tau$ 的两个序列之间，在任意位点观察到核苷酸不同的概率。对于一个时间可逆模型，这等于一个序列在时间 $\\tau$ 内从其初始状态 $i$ 变为任何其他状态 $j \\neq i$ 的概率，即 $p = 1 - P_{ii}(\\tau)$，其中 $P_{ii}(\\tau)$ 是在时间 $\\tau$ 后保持在同一状态的概率。\n\n为了求解 $P_{ii}(t)$，我们建立微分方程。一个位点处于状态 $i$ 的概率 $p_i(t)$ 的变化率为：\n$$ \\frac{dp_i(t)}{dt} = p_i(t) Q_{ii} + \\sum_{j \\neq i} p_j(t) Q_{ji} = p_i(t)(-3\\alpha) + \\sum_{j \\neq i} p_j(t) \\alpha $$\n利用总概率为1（$\\sum_j p_j(t) = 1 \\implies \\sum_{j \\neq i} p_j(t) = 1 - p_i(t)$），方程简化为：\n$$ \\frac{dp_i(t)}{dt} = -3\\alpha p_i(t) + \\alpha(1 - p_i(t)) = \\alpha - 4\\alpha p_i(t) $$\n这是一个一阶线性常微分方程，其初始条件为 $p_i(0) = 1$。该方程的解为：\n$$ P_{ii}(t) = p_i(t) = \\frac{1}{4} + \\frac{3}{4} e^{-4\\alpha t} $$\n因此，在总时间 $\\tau$ 后，观察到差异的概率 $p$ 为：\n$$ p = 1 - P_{ii}(\\tau) = 1 - \\left( \\frac{1}{4} + \\frac{3}{4} e^{-4\\alpha \\tau} \\right) = \\frac{3}{4} \\left( 1 - e^{-4\\alpha \\tau} \\right) $$\n\n现在我们有两个关系式：\n1. $d = 3\\alpha\\tau$\n2. $p = \\frac{3}{4} (1 - e^{-4\\alpha \\tau})$\n\n我们的目标是将 $d$ 表示为 $p$ 的函数。从方程(1)中，我们有 $\\alpha \\tau = d/3$。我们可以将其代入方程(2)：\n$$ p = \\frac{3}{4} \\left( 1 - e^{-4(d/3)} \\right) = \\frac{3}{4} \\left( 1 - e^{-4d/3} \\right) $$\n最后，我们反解出 $d$ 关于 $p$ 的表达式：\n$$ \\frac{4p}{3} = 1 - e^{-4d/3} $$\n$$ e^{-4d/3} = 1 - \\frac{4p}{3} $$\n对两边取自然对数：\n$$ -\\frac{4d}{3} = \\ln\\left(1 - \\frac{4p}{3}\\right) $$\n最终得到：\n$$ d = -\\frac{3}{4} \\ln\\left(1 - \\frac{4p}{3}\\right) $$\n此即Jukes-Cantor距离校正公式。该公式要求 $p  3/4$，这与模型预测的饱和差异比例为 $3/4$ 相符。", "answer": "$$\n\\boxed{-\\frac{3}{4} \\ln\\left(1 - \\frac{4p}{3}\\right)}\n$$", "id": "2407121"}, {"introduction": "在掌握了基础模型后，我们将转向一个更复杂也更贴近生物学现实的模型——Hasegawa-Kishino-Yano 1985 (HKY85) 模型。这项实践 [@problem_id:4585593] 不仅涉及理论，更要求你亲手将其转化为可执行的计算机程序，这是生物信息学家的核心能力之一。你将有机会利用谱分解这一优雅的数学工具来计算时间可逆模型的转移概率，并通过与数值方法的对比来验证其精确性。", "problem": "考虑一个时间同质的连续时间马尔可夫链 (CTMC)，其状态空间为四种脱氧核糖核酸 (DNA) 核苷酸：腺嘌呤 (Adenine)、胞嘧啶 (Cytosine)、鸟嘌呤 (Guanine)、胸腺嘧啶 (Thymine)，状态空间大小为 $4$，无穷小生成元（速率）矩阵为 $Q \\in \\mathbb{R}^{4 \\times 4}$。在 Hasegawa-Kishino-Yano $1985$ (HKY85) 核苷酸替换模型中，从状态 $i$ 到状态 $j$ 的瞬时替换速率由平衡碱基频率以及转换或颠换偏倚决定。设 $\\pi = (\\pi_A,\\pi_C,\\pi_G,\\pi_T)$ 表示平稳碱基频率，其中 $\\pi_i  0$ 且 $\\sum_{i} \\pi_i = 1$；设 $\\kappa  0$ 为转换颠换速率比。定义转换集为碱基对 $\\{A,G\\}$ 和 $\\{C,T\\}$；所有其他碱基对均为颠换。$Q$ 的非对角线元素满足 $Q_{ij} = s_{ij} \\pi_j$（对于 $i \\neq j$），其中如果 $(i,j)$ 是一个转换对，则 $s_{ij} = \\kappa$，否则 $s_{ij} = 1$。对角线元素由行和为零的要求确定，即 $Q_{ii} = -\\sum_{j \\neq i} Q_{ij}$。期望瞬时替换速率定义为 $\\mu = \\sum_{i} \\pi_i (-Q_{ii})$，矩阵 $Q$ 必须进行缩放以使 $\\mu = 1$。\n\n在时间 $t$ 的转移概率矩阵，记为 $P(t) \\in \\mathbb{R}^{4 \\times 4}$，由矩阵指数 $P(t) = \\exp(Q t)$ 定义。按上述方式构建的 HKY85 生成元关于 $\\pi$ 是可逆的，即它满足细致平衡条件 $\\pi_i Q_{ij} = \\pi_j Q_{ji}$。\n\n您的任务是实现一个程序，对下面提供的每个测试用例，执行以下基于第一性原理的步骤：\n\n- 使用给定的 $\\pi$ 和 $\\kappa$ 构建 HKY85 生成元矩阵 $Q$，强制执行行和为零的约束 $Q \\mathbf{1} = \\mathbf{0}$，并缩放 $Q$ 以使期望速率 $\\mu = 1$。\n- 通过两种独立的方法计算 $P(t)$：\n  1. 利用可逆性的谱分解路径：利用 $Q$ 通过相似变换 $H = S Q S^{-1}$ 与对称矩阵 $H$ 相似的事实，其中 $S = \\mathrm{diag}(\\sqrt{\\pi_A},\\sqrt{\\pi_C},\\sqrt{\\pi_G},\\sqrt{\\pi_T})$，然后使用 $H$ 的标准正交特征分解来获得 $P(t)$。\n  2. 使用稳定算法的直接数值路径，通过计算矩阵指数来获得 $P(t)$。\n- 对每个测试用例，量化并汇总以下四个诊断指标，除非另有说明，否则使用谱分解路径得到的 $P(t)$：\n  1. 谱分解和数值计算得到的 $P(t)$ 之间的弗罗贝尼乌斯范数差异，即 $\\lVert P_{\\mathrm{spec}}(t) - P_{\\mathrm{num}}(t) \\rVert_F$。\n  2. 行随机性的最大违背值，即 $\\max_{i} \\left| \\sum_{j} P_{ij}(t) - 1 \\right|$。\n  3. 在 $\\pi$ 左乘作用下平稳性的违背值，即 $\\lVert \\pi P(t) - \\pi \\rVert_2$，使用欧几里得范数计算。\n  4. 行与平稳分布的最大偏差，即 $\\max_{i} \\lVert P_{i\\cdot}(t) - \\pi \\rVert_2$，其中 $P_{i\\cdot}(t)$ 表示 $P(t)$ 的第 $i$ 行。\n\n在您的算法设计和后续解释中，从概念上说明碱基频率 $\\pi$ 如何决定对称化算子的特征结构和平稳特征向量。\n\n使用以下测试套件，碱基顺序固定为 $(A,C,G,T)$：\n\n- 测试用例 1（频率均衡，边界时间）：$\\pi = (0.25, 0.25, 0.25, 0.25)$，$\\kappa = 1.0$，$t = 0.0$。\n- 测试用例 2（频率均衡，中度偏倚）：$\\pi = (0.25, 0.25, 0.25, 0.25)$，$\\kappa = 2.0$，$t = 0.5$。\n- 测试用例 3（中度偏斜，较强偏倚，较长时间）：$\\pi = (0.35, 0.15, 0.35, 0.15)$，$\\kappa = 3.0$，$t = 2.0$。\n- 测试用例 4（强偏斜，极端偏倚，长时间）：$\\pi = (0.70, 0.10, 0.15, 0.05)$，$\\kappa = 10.0$，$t = 5.0$。\n- 测试用例 5（偏斜且时间极短）：$\\pi = (0.40, 0.10, 0.40, 0.10)$，$\\kappa = 20.0$，$t = 10^{-8}$。\n\n此问题中的所有量均为无量纲，不适用任何物理单位。\n\n您的程序应生成单行输出，其中包含五个测试用例的连接诊断指标，按顺序排列，每个测试用例贡献一个包含四个浮点数的列表，格式为 $[\\lVert P_{\\mathrm{spec}} - P_{\\mathrm{num}} \\rVert_F, \\max \\text{ 行和偏差}, \\lVert \\pi P - \\pi \\rVert_2, \\max \\text{ 行与 } \\pi \\text{ 的偏差}]$。将所有 5 个用例聚合到一个扁平列表中，以方括号括起来的逗号分隔序列形式打印，例如 $[d_{1,1},d_{1,2},d_{1,3},d_{1,4},d_{2,1},\\dots,d_{5,4}]$。输出必须是您的程序计算出的实数，且不得需要任何外部输入。", "solution": "### 算法设计及基本原理\n\n对于每个测试用例，解决方案分为四个主要阶段：构建 HKY85 生成元矩阵 $Q$，通过两种独立方法计算转移概率矩阵 $P(t)$，最后计算一组诊断指标。\n\n#### 1. 生成元矩阵 $Q$ 的构建与缩放\n\nHKY85 模型是一个在四种核苷酸 $\\{A, C, G, T\\}$（我们将其索引为 $\\{0, 1, 2, 3\\}$）状态空间上的连续时间马尔可夫链 (CTMC)。此过程的动态由无穷小生成元矩阵 $Q \\in \\mathbb{R}^{4 \\times 4}$ 控制。\n\n非对角线元素 $Q_{ij}$ (对于 $i \\neq j$) 表示从核苷酸 $i$ 到核苷酸 $j$ 的瞬时替换速率。在 HKY85 模型中，该速率定义为 $Q_{ij} = s_{ij} \\pi_j$。这里，$\\pi = (\\pi_A, \\pi_C, \\pi_G, \\pi_T)$ 是平稳（或平衡）碱基频率的向量，而 $s_{ij}$ 是一个速率乘数，取决于替换是转换还是颠换。\n\n- **转换 (transition)** 是指嘌呤之间 ($A \\leftrightarrow G$) 或嘧啶之间 ($C \\leftrightarrow T$) 的替换。对于这些碱基对，$s_{ij} = \\kappa$，其中 $\\kappa > 0$ 是转换颠换速率比。\n- **颠换 (transversion)** 是指嘌呤和嘧啶之间的替换。对于这些碱基对，$s_{ij} = 1$。\n\n$Q$ 的对角线元素由生成元矩阵每行之和必须为零的性质确定：$Q_{ii} = -\\sum_{j \\neq i} Q_{ij}$。这确保了概率守恒。\n\n让这个初始构建的矩阵为 $Q'$。问题要求对 $Q$进行缩放，使得每单位时间每个位点的期望替换数 $\\mu$ 等于 $1$。该期望速率定义为每个状态的离开率的平均值，由其平稳频率加权：$\\mu = -\\sum_{i} \\pi_i Q_{ii}$。我们首先为未缩放的矩阵计算此速率，$\\mu' = -\\sum_{i} \\pi_i Q'_{ii}$，然后定义最终的、缩放后的生成元为 $Q = Q' / \\mu'$。这种归一化使得分支长度 $t$ 可以解释为每个位点的期望替换数。\n\n#### 2. 转移概率矩阵 $P(t)$ 的计算\n\n矩阵 $P(t)$，其中 $P_{ij}(t)$ 是在时间 $0$ 时处于状态 $i$ 的条件下，在时间 $t$ 处于状态 $j$ 的概率，由矩阵指数给出：\n$$\nP(t) = \\exp(Q t)\n$$\n我们使用两种不同的方法计算此矩阵，以交叉验证结果。\n\n**方法 1：谱分解**\n\nHKY85 模型被设计为关于 $\\pi$ 是**时间可逆的**，满足细致平衡条件 $\\pi_i Q_{ij} = \\pi_j Q_{ji}$。此性质意味着 $Q$ 与一个对称矩阵相似，这允许进行稳定且优雅的特征分解。设 $S = \\mathrm{diag}(\\sqrt{\\pi_0}, \\sqrt{\\pi_1}, \\sqrt{\\pi_2}, \\sqrt{\\pi_3})$。相似变换由 $H = S Q S^{-1}$ 给出。此对称化矩阵 $H$ 的元素为：\n$$\nH_{ij} = \\sqrt{\\frac{\\pi_i}{\\pi_j}} Q_{ij} = \\sqrt{\\frac{\\pi_i}{\\pi_j}} (s_{ij} \\pi_j) = s_{ij} \\sqrt{\\pi_i \\pi_j}\n$$\n由于 $s_{ij} = s_{ji}$，很明显 $H_{ij} = H_{ji}$，因此 $H$ 是一个对称矩阵。\n\n对称矩阵有一组完备的标准正交特征向量和实特征值。因此，我们可以将其特征分解写为 $H = U \\Lambda U^T$，其中 $U$ 是一个正交矩阵，其列是 $H$ 的特征向量，$\\Lambda = \\mathrm{diag}(\\lambda_0, \\lambda_1, \\lambda_2, \\lambda_3)$ 是相应特征值的对角矩阵。\n\n从 $Q = S^{-1} H S$，我们推导出 $P(t)$ 的表达式：\n$$\nP(t) = \\exp(Q t) = \\exp((S^{-1} H S)t) = S^{-1} \\exp(H t) S = S^{-1} (U \\exp(\\Lambda t) U^T) S\n$$\n矩阵 $\\exp(\\Lambda t)$ 只是一个对角矩阵，其元素为 $e^{\\lambda_i t}$。这提供了一种数值上稳定且分析上强大的方法来计算 $P(t)$。\n\n这种谱方法阐明了平稳频率 $\\pi$ 的核心作用。首先，对称化算子 $H$ 的特征结构（特征值 $\\lambda_i$ 和 $U$ 中的特征向量）直接由其元素 $s_{ij}\\sqrt{\\pi_i \\pi_j}$ 决定，这些元素是 $\\pi$ 的函数。其次，可逆性意味着 $\\pi$ 是过程的平稳分布。这意味着 $\\pi$ 是对应于特征值 $\\lambda=0$ 的 $Q$ 的左特征向量，满足 $\\pi Q = \\mathbf{0}$。这种零特征值模式控制着系统的长期行为，确保当 $t \\to \\infty$ 时，$P(t)$ 的每一行都收敛到 $\\pi$。\n\n**方法 2：直接数值矩阵指数**\n\n作为独立的验证，我们使用鲁棒的数值算法直接计算 $P(t)$。我们使用 `scipy.linalg.expm` 函数，该函数实现了基于帕德近似 (Padé approximants) 的缩放平方法 (scaling and squaring algorithm)。此方法是计算一般方阵指数的标准且高度可靠的方法。\n$$\nP_{\\mathrm{num}}(t) = \\mathrm{expm}(Q t)\n$$\n\n#### 3. 诊断指标\n\n我们量化计算出的转移矩阵 $P(t) = P_{\\mathrm{spec}}(t)$ 的性质，并通过四个诊断指标将其与数值版本 $P_{\\mathrm{num}}(t)$ 进行比较：\n\n1.  **弗罗贝尼乌斯范数差异**：$\\lVert P_{\\mathrm{spec}}(t) - P_{\\mathrm{num}}(t) \\rVert_F$。这衡量了两种计算方法之间的整体数值差异。一个较小的值验证了两种实现的正确性。\n\n2.  **最大行和违背值**：$\\max_{i} \\left| \\sum_{j} P_{ij}(t) - 1 \\right|$。对于任何有效的转移概率矩阵，每一行之和必须为 $1$，因为过程必须转移到*某个*状态。该指标检查由于数值误差导致的对此随机性属性的违背情况。\n\n3.  **平稳性违背值**：$\\lVert \\pi P(t) - \\pi \\rVert_2$。由于 $\\pi$ 是平稳分布，它必须在 $P(t)$ 的作用下保持不变，即 $\\pi P(t) = \\pi$。该诊断指标计算差异的欧几里得范数，衡量与此基本性质的任何偏差。\n\n4.  **行与平稳性的最大偏差**：$\\max_{i} \\lVert P_{i\\cdot}(t) - \\pi \\rVert_2$。转移矩阵的每一行 $P_{i\\cdot}(t)$ 代表从状态 $i$ 开始，在时间 $t$ 的状态概率分布。当 $t \\to \\infty$ 时，所有行都应收敛到平稳分布 $\\pi$。该指标衡量任何此类行与 $\\pi$ 的最大欧几里得距离，表明系统离平衡有多近。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to run the HKY85 model simulations for all test cases.\n    \"\"\"\n    \n    # Test cases as specified in the problem statement.\n    # Each tuple contains (pi, kappa, t).\n    # pi is a tuple of (pi_A, pi_C, pi_G, pi_T).\n    test_cases = [\n        # Test case 1 (balanced frequencies, boundary time)\n        ((0.25, 0.25, 0.25, 0.25), 1.0, 0.0),\n        # Test case 2 (balanced frequencies, moderate bias)\n        ((0.25, 0.25, 0.25, 0.25), 2.0, 0.5),\n        # Test case 3 (moderate skew, stronger bias, longer time)\n        ((0.35, 0.15, 0.35, 0.15), 3.0, 2.0),\n        # Test case 4 (strong skew, extreme bias, long time)\n        ((0.70, 0.10, 0.15, 0.05), 10.0, 5.0),\n        # Test case 5 (skewed with very small time)\n        ((0.40, 0.10, 0.40, 0.10), 20.0, 1e-8),\n    ]\n\n    all_diagnostics = []\n\n    for pi_tuple, kappa, t in test_cases:\n        pi = np.array(pi_tuple)\n        \n        # 1. Construct the unscaled HKY85 generator matrix Q'\n        Q_prime = np.zeros((4, 4))\n        \n        # Define transitions {A,G} -> {0,2} and {C,T} -> {1,3}\n        purines = {0, 2}\n        pyrimidines = {1, 3}\n        \n        for i in range(4):\n            for j in range(4):\n                if i == j:\n                    continue\n                \n                # Determine if it's a transition or transversion\n                is_transition = (i in purines and j in purines) or (i in pyrimidines and j in pyrimidines)\n                s_ij = kappa if is_transition else 1.0\n                Q_prime[i, j] = s_ij * pi[j]\n        \n        # Set diagonal elements such that row sums are zero\n        for i in range(4):\n            Q_prime[i, i] = -np.sum(Q_prime[i, :])\n            \n        # 2. Scale Q so that the expected substitution rate mu is 1\n        mu_prime = -np.sum(pi * np.diag(Q_prime))\n\n        # Avoid division by zero if mu_prime is zero (e.g. if all rates are zero)\n        if np.isclose(mu_prime, 0.0):\n            Q = Q_prime # Or handle as an error, but here Q will be a zero matrix\n        else:\n            Q = Q_prime / mu_prime\n            \n        # 3. Compute P(t) via Spectral Decomposition\n        S = np.diag(np.sqrt(pi))\n        S_inv = np.diag(1.0 / np.sqrt(pi))\n        H = S @ Q @ S_inv\n        \n        # Eigendecomposition of the symmetric matrix H\n        # np.linalg.eigh is for hermitian/symmetric matrices and is more stable\n        eigenvalues, U = np.linalg.eigh(H)\n        \n        exp_lambda_t = np.diag(np.exp(eigenvalues * t))\n        \n        P_spec = S_inv @ U @ exp_lambda_t @ U.T @ S\n        \n        # 4. Compute P(t) via Direct Numerical Method\n        P_num = expm(Q * t)\n        \n        # 5. Calculate the four diagnostics\n        \n        # D1: Frobenius norm difference\n        d1 = np.linalg.norm(P_spec - P_num, 'fro')\n        \n        # D2: Maximal row-sum violation\n        row_sums = np.sum(P_spec, axis=1)\n        d2 = np.max(np.abs(row_sums - 1.0))\n\n        # D3: Stationarity violation\n        pi_P = pi @ P_spec\n        d3 = np.linalg.norm(pi_P - pi, 2)\n        \n        # D4: Maximal row deviation from stationarity\n        row_deviations = []\n        for i in range(4):\n            row_i = P_spec[i, :]\n            deviation = np.linalg.norm(row_i - pi, 2)\n            row_deviations.append(deviation)\n        d4 = np.max(row_deviations)\n        \n        all_diagnostics.extend([d1, d2, d3, d4])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{d:.12e}' for d in all_diagnostics)}]\")\n\nsolve()\n```", "id": "4585593"}, {"introduction": "学会了推导和实现核苷酸替代模型后，一个至关重要的问题是：我们如何选择合适的模型？这项练习 [@problem_id:2407130] 旨在培养你对模型选择的批判性思维。它探讨了当使用一个过于简单的模型（如 JC69）来分析由更复杂过程产生的数据时，会引入怎样的系统性误差（偏差），从而突显了在系统发育分析中进行模型选择的极端重要性。", "problem": "一组对齐的脱氧核糖核酸（DNA）序列在4态核苷酸字母表上，遵循一个连续时间马尔可夫链（CTMC）演化。在此类模型中，分支长度定义为每个位点的预期替换数，即，如果瞬时速率矩阵被缩放以使平均替换率为$1$，则持续时间为 $t$ 的分支其长度为 $t$。考虑在固定拓扑结构上，使用 Jukes–Cantor (JC$69$) 模型估计最大似然分支长度，该模型假设所有核苷酸对之间具有相等的碱基频率和相等的替换率。假设真实的数据生成过程更接近于一个广义时间可逆（GTR）模型，该模型具有不相等的平衡碱基频率和不相等的置换率，包括像 Kimura 双参数（K$80$）模型中那样的转换率相对于颠换率的升高。哪个陈述最能描述使用 JC$69$ 模型代替 GTR 类的过程会如何系统性地偏置估计的分支长度？\n\nA. 它们被系统性地低估，特别是对于较长的分支，因为当转换更频繁或碱基频率不相等时，等速率、等频率的假设对多次未观察到的替换校正不足。\n\nB. 它们在所有分支上都被系统性地高估，因为等速率的假设迫使模型将任何模式异质性解释为额外的变化。\n\nC. 它们在平均上是无偏的；模型设定错误只会增加估计的方差，而不会改变其期望值。\n\nD. 只要树的拓扑结构是固定的，它们就保持正确；使用 JC$69$ 只会偏置推断出的替换参数。\n\nE. 单个分支上的任何偏置都会相互抵消，因此即使单个分支有偏置，总树长（分支长度之和）也是无偏的。", "solution": "这个问题的核心在于理解模型设定错误（用简单模型拟合复杂数据）的后果。分支长度代表了每个位点的预期替换次数。为了从观测到的序列差异（$p_d$）估计分支长度，需要使用替换模型进行校正，以解释那些无法直接观测到的“多次命中”（multiple hits）事件，如 A → G → A。\n\n-   **JC69模型**：假设所有替换类型的速率相同，所有碱基频率相等。其距离校正公式 $t_{JC} = -\\frac{3}{4} \\ln\\left(1 - \\frac{4}{3} p_d\\right)$ 是基于这些均一性假设推导出来的。\n-   **真实过程（GTR类）**：碱基频率不相等，且替换速率也不同。特别是，转换（如 A ↔ G）通常比颠换（如 A ↔ T）更频繁。\n\n当某些替换路径（如转换）比其他路径更“热”时，“多次命中”的发生频率会远高于JC69模型的预期。例如，一个真实的 A → G → A 回复突变序列会更频繁地发生，但由于它不产生可观测的差异，JC69模型无法察觉到这两次替换事件。\n\n因此，当使用JC69模型来分析由GTR类过程产生的数据时，它会低估隐藏的替换事件数量。其校正公式对于“多次命中”的补偿是**不足**的。这必然导致对真实分支长度的系统性**低估**。这种低估效应在较长的分支上尤为严重，因为随着演化时间的增加，序列差异趋于饱和，“多次命中”的比例也随之增高。\n\n基于以上分析：\n-   **选项 A** 正确地指出了分支长度会被系统性地低估，尤其是在较长分支上，原因是JC69的简单假设对多次替换校正不足。\n-   **选项 B、C、D、E** 都是错误的。偏倚是低估而非高估；模型设定错误会引入系统性偏倚，而不仅仅是增加方差；分支长度本身就是被偏置的参数；由于偏倚是系统性的低估，它不会在总树长中相互抵消。", "answer": "$$\\boxed{A}$$", "id": "2407130"}]}