{"hands_on_practices": [{"introduction": "在了解了寻找最优比对的难度之后，我们需要一个一致的方法来评估由启发式算法产生的任何给定比对的质量。这项实践介绍了配对总和（Sum-of-Pairs, SP）目标函数，这是评估MSA最常用的方法。通过逐列细致地计算得分，您将对如何量化比对质量有一个基本的理解。[@problem_id:4587259]", "problem": "考虑一个多序列比对（MSA），该比对通过渐进比对方法构建，使用一个引导树，首先比对序列 $x_1$ 和 $x_2$，然后将得到的轮廓（profile）与 $x_3$ 进行比对。比对 $A$ 显示为 $x_1=\\mathrm{ACGT}$，$x_2=\\mathrm{AG\\mbox{-}T}$，$x_3=\\mathrm{A\\mbox{-}CT}$，其中 $\\mbox{-}$ 表示一个空位。在 MSA 的标准基于目标的评估中，配对总和（Sum-of-Pairs, SP）系列目标函数将比对列中的成对替换得分和空位得分进行汇总。设配对评分方案由以下经过充分检验的规则定义：相同的核苷酸符号（匹配）得分为 $s(\\text{match})=+1$，不同的核苷酸符号（错配）得分为 $s(\\text{mismatch})=-1$，一个空位与一个核苷酸符号比对（空位-符号对）得分为 $s(\\text{gap-symbol})=-2$，一个空位与一个空位比对（空位-空位对）得分为 $s(\\text{gap-gap})=0$。仅使用这些原则，通过评估每一列中所有成对的贡献并将其相加，计算所显示比对的 $S_{\\mathrm{SP}}(A)$ 的确切值。除了数值计算，还需通过说明每一比对列的三个成对贡献（对于配对 $(x_1,x_2)$、$(x_1,x_3)$ 和 $(x_2,x_3)$）以及每个贡献是如何根据评分规则产生的，来解释每一项。提供 $S_{\\mathrm{SP}}(A)$ 的最终值，该值应为精确整数，无需四舍五入。", "solution": "该问题是有效的。它在生物信息学领域有科学依据，问题陈述清晰，提供了所有必要信息，并且是客观陈述的。任务是计算给定多序列比对（MSA）的配对总和（SP）得分。\n\n一个包含 $N$ 个序列的多序列比对 $A$ 的配对总和得分，记为 $S_{\\mathrm{SP}}(A)$，定义为所有列上所有诱导的成对序列比对得分的总和。如果 $A$ 有 $L$ 列，则得分由以下公式给出：\n$$S_{\\mathrm{SP}}(A) = \\sum_{k=1}^{L} S_k = \\sum_{k=1}^{L} \\left( \\sum_{1 \\le i  j \\le N} s(A_{i,k}, A_{j,k}) \\right)$$\n其中 $A_{i,k}$ 是第 $i$ 个序列在第 $k$ 列的字符（核苷酸或空位），$s(a, b)$ 是比对字符 $a$ 和 $b$ 的得分。\n\n给定的比对 $A$ 包含 $N=3$ 个序列（$x_1, x_2, x_3$）并有 $L=4$ 列。比对中的序列是：\n$x_1: \\mathrm{A C G T}$\n$x_2: \\mathrm{A G - T}$\n$x_3: \\mathrm{A - C T}$\n\n配对评分方案定义如下：\n-   匹配得分，$s(\\text{match}) = +1$\n-   错配得分，$s(\\text{mismatch}) = -1$\n-   空位-符号对得分，$s(\\text{gap-symbol}) = -2$\n-   空位-空位对得分，$s(\\text{gap-gap}) = 0$\n\n我们将通过对三个成对贡献（$(x_1, x_2)$、$(x_1, x_3)$ 和 $(x_2, x_3)$）的得分求和来计算每一列的得分。\n\n**第 $1$ 列**：字符是 $(A, A, A)$。\n-   配对 $(x_1, x_2)$：字符是 $A$ 和 $A$。这是一个匹配。得分为 $s(\\text{match}) = +1$。\n-   配对 $(x_1, x_3)$：字符是 $A$ 和 $A$。这是一个匹配。得分为 $s(\\text{match}) = +1$。\n-   配对 $(x_2, x_3)$：字符是 $A$ 和 $A$。这是一个匹配。得分为 $s(\\text{match}) = +1$。\n第 $1$ 列的总分是 $S_1 = 1 + 1 + 1 = 3$。\n\n**第 $2$ 列**：字符是 $(C, G, \\mbox{-})$。\n-   配对 $(x_1, x_2)$：字符是 $C$ 和 $G$。这是一个错配。得分为 $s(\\text{mismatch}) = -1$。\n-   配对 $(x_1, x_3)$：字符是 $C$ 和 $\\mbox{-}$。这是一个空位-符号对。得分为 $s(\\text{gap-symbol}) = -2$。\n-   配对 $(x_2, x_3)$：字符是 $G$ 和 $\\mbox{-}$。这是一个空位-符号对。得分为 $s(\\text{gap-symbol}) = -2$。\n第 $2$ 列的总分是 $S_2 = (-1) + (-2) + (-2) = -5$。\n\n**第 $3$ 列**：字符是 $(G, \\mbox{-}, C)$。\n-   配对 $(x_1, x_2)$：字符是 $G$ 和 $\\mbox{-}$。这是一个空位-符号对。得分为 $s(\\text{gap-symbol}) = -2$。\n-   配对 $(x_1, x_3)$：字符是 $G$ 和 $C$。这是一个错配。得分为 $s(\\text{mismatch}) = -1$。\n-   配对 $(x_2, x_3)$：字符是 $\\mbox{-}$ 和 $C$。这是一个空位-符号对。得分为 $s(\\text{gap-symbol}) = -2$。\n第 $3$ 列的总分是 $S_3 = (-2) + (-1) + (-2) = -5$。\n\n**第 $4$ 列**：字符是 $(T, T, T)$。\n-   配对 $(x_1, x_2)$：字符是 $T$ 和 $T$。这是一个匹配。得分为 $s(\\text{match}) = +1$。\n-   配对 $(x_1, x_3)$：字符是 $T$ 和 $T$。这是一个匹配。得分为 $s(\\text{match}) = +1$。\n-   配对 $(x_2, x_3)$：字符是 $T$ 和 $T$。这是一个匹配。得分为 $s(\\text{match}) = +1$。\n第 $4$ 列的总分是 $S_4 = 1 + 1 + 1 = 3$。\n\n最后，总的配对总和得分 $S_{\\mathrm{SP}}(A)$ 是所有列得分的总和：\n$$S_{\\mathrm{SP}}(A) = S_1 + S_2 + S_3 + S_4 = 3 + (-5) + (-5) + 3 = -4$$\n有关渐进比对过程（引导树）的信息描述了比对 $A$ 是如何被构建的，但这并不改变对最终给定的比对计算 SP 得分的方法。该计算仅基于最终的比对矩阵和评分方案。", "answer": "$$\\boxed{-4}$$", "id": "4587259"}, {"introduction": "尽管渐进式比对是一种功能强大且广泛应用的启发式方法，但其“贪婪”的本质有时会导致次优的结果。这个思想实验展示了一个经典场景：即使使用正确的指导树，算法在早期做出的一个局部最优决策被固定下来，从而阻止了它达到一个更好的全局比对。这项练习强调了批判性地评估启发式算法输出的重要性。[@problem_id:2418815]", "problem": "给定四个脱氧核糖核酸 (DNA) 序列，一个与真实系统发育相等的引导树，以及一个标准渐进式多序列比对 (MSA) 流程规范。你的任务是确定最终结果，并解释为什么即使引导树是正确的，最终的 MSA 质量仍然可能很差。\n\n序列：\n- $S_1 = \\text{TAAAAAT}$ (两侧各有一个侧翼胸腺嘧啶和一个由五个腺嘌呤组成的同聚物)\n- $S_2 = \\text{TAAAAAAT}$ (与 $S_1$ 相同，但同聚物有六个腺嘌呤)\n- $S_3 = \\text{TAACAAAT}$ (长度为六的腺嘌呤同聚物，但从左数第三个腺嘌呤被胞嘧啶取代)\n- $S_4 = \\text{TAACAAAT}$ (与 $S_3$ 相同)\n\n真实系统发育（也是引导树）：$((S_1,S_2),(S_3,S_4))$。\n\n渐进式流程：\n- 两两比对使用 Needleman–Wunsch 算法和一个简单的线性计分方案计算：匹配 $= +1$，错配 $= -1$，空位（每个符号）$= -1$。不使用仿射项。\n- 当存在多个最优的两两比对时，该实现通过在同聚物区域内将空位符号尽可能地放在右边来打破平局，否则在分数相同时优先选择匹配而非空位。\n- 渐进式算法首先比对 $S_1$ 和 $S_2$ 以生成一个轮廓，然后比对 $S_3$ 和 $S_4$ 以生成第二个轮廓，最后比对这两个轮廓。在任何阶段都不执行迭代优化或重新比对。该算法考虑的最终目标是配对总和 (SP) 分数，但是，正如渐进式比对的标准做法一样，一旦确定，早期的两两比对决策就不会被重新审视。\n\n问题：尽管引导树是正确的，但以下哪项最能描述在这种情况下发生了什么以及原因？\n\nA. 因为引导树是真实的系统发育，所以渐进式流程保证能产生全局最优的配对总和 MSA，其中 $S_3$ 和 $S_4$ 中的两个胞嘧啶比对在同一列，并与 $S_1$ 和 $S_2$ 中的同源位置对齐，无论如何打破平局。\n\nB. $S_1$ 和 $S_2$ 的两两比对在腺嘌呤连续区内包含多个共优的位置来放置所需的单个空位；向右对齐的平局打破规则将该空位固定在连续区的右边缘。当合并 $(S_3,S_4)$ 轮廓时，算法保留了这个早期决策，并且无法移动它以适应信息丰富的胞嘧啶，从而即使引导树是正确的，也产生了一个生物学上质量差的 MSA（同源性错位）。\n\nC. 在最终的轮廓-轮廓比对期间，渐进式算法检测到早期的空位放置是次优的，并回溯以重新优化 $S_1$–$S_2$ 的比对，从而使 $S_3$ 和 $S_4$ 中的胞嘧啶落在它们的同源列中。\n\nD. 在渐进式比对中，只有当引导树不正确时才会出现质量差的 MSA；如果引导树等于真实的系统发育，贪婪效应不会降低 MSA 的质量。", "solution": "### 问题验证\n\n**步骤 1：提取已知条件**\n- **序列**：\n  - $S_1 = \\text{TAAAAAT}$ (长度为 7，包含一个 5 个腺嘌呤的同聚物)\n  - $S_2 = \\text{TAAAAAAT}$ (长度为 8，包含一个 6 个腺嘌呤的同聚物)\n  - $S_3 = \\text{TAACAAAT}$ (长度为 8，在位置 4 有一个 `C`)\n  - $S_4 = \\text{TAACAAAT}$ (与 $S_3$ 相同)\n- **引导树**：引导树被指定为与真实系统发育相等：$((S_1,S_2),(S_3,S_4))$。这决定了比对的顺序：首先是 $(S_1, S_2)$，然后是 $(S_3, S_4)$，最后是比对这两个生成的轮廓。\n- **渐进式比对流程**：\n  - **两两比对**：Needleman–Wunsch 算法。\n  - **计分方案**：线性空位罚分。匹配分数 $= +1$，错配分数 $= -1$，空位罚分 $= -1$（每个符号）。\n  - **平局打破规则**：对于共优的两两比对，空位被放置在同聚物区域内尽可能靠右的位置。\n  - **执行流程**：基于引导树的渐进式比对。不执行迭代优化或回溯；早期的比对决策是最终的。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学上合理**：该问题在根本上是合理的。它描述了一个标准的、尽管是简化的渐进式多序列比对 (MSA) 过程。所使用的概念——Needleman–Wunsch、引导树、线性计分以及渐进式比对的贪婪性质——都是生物信息学领域的核心。该问题是用于说明启发式 MSA 方法局限性的一个典型例子。\n- **定义明确**：该问题是定义明确的。它提供了所有必要的组成部分：输入序列、明确的操作顺序（引导树）、具体的算法、计分函数以及一个确定性的平局打破规则。这些组成部分足以计算出一个唯一的、无歧义的最终 MSA。\n- **客观性**：该问题使用计算生物学中常见的精确、客观和技术性语言进行陈述。它不含主观或模棱两可的术语。\n\n**步骤 3：结论与行动**\n问题陈述在科学上是合理的、定义明确的且客观的。它没有违反任何无效标准。因此，该问题是**有效的**。我将继续推导解决方案。\n\n### 解决方案推导\n\n根据引导树 $((S_1,S_2),(S_3,S_4))$，渐进式比对分三步进行。\n\n**步骤 1：$S_1$ 和 $S_2$ 的两两比对**\n- $S_1 = \\text{TAAAAAT}$ (长度 $L=7$)\n- $S_2 = \\text{TAAAAAAT}$ (长度 $L=8$)\n这些序列在同聚物连续区中相差一个腺嘌呤 ('A')。最优比对将对齐所有相同的字符，并在较短的序列 $S_1$ 中引入一个空位。比对的长度将为 8。一个最优比对将包含 7 个匹配和 1 个空位，总分得到 $7 \\times (+1) + 1 \\times (-1) = 6$。\n\n$S_1$ 中的空位可以放置在 $S_2$ 同聚物连续区中前 6 个 A 的任意一个对面，或者放在 $S_1$ 的末尾。例如：\n- `TA-AAAAAT` vs `TAAAAAAAT`\n- `TAA-AAAAT` vs `TAAAAAAAT`\n- ...\n- `TAAAAA-AT` vs `TAAAAAAAT`\n- `TAAAAAT-` vs `TAAAAAAT`\n\n这些都是分数为 6 的共优比对。问题陈述了一个平局打破规则：“在同聚物区域内将空位符号尽可能地放在右边”。这强制了一个特定的选择。同聚物区域是连续的 `A`。在这种情况下，空位的最右边位置是：\n$S_1$: `TAAAAA-T`\n$S_2$: `TAAAAAAT`\n\n这个比对将空位锁定在生成的轮廓 $P_{12}$ 的第 $7$ 列。这是一个贪婪决策，是在没有任何来自序列 $S_3$ 和 $S_4$ 的信息的情况下做出的。轮廓 $P_{12}$ 现在被固定下来：\n第 1 列：{T, T}，第 2 列：{A, A}，第 3 列：{A, A}，第 4 列：{A, A}，第 5 列：{A, A}，第 6 列：{A, A}，第 7 列：{-, A}，第 8 列：{T, T}。\n\n**步骤 2：$S_3$ 和 $S_4$ 的两两比对**\n- $S_3 = \\text{TAACAAAT}$\n- $S_4 = \\text{TAACAAAT}$\n这两个序列是相同的。比对是简单的，分数为 $8 \\times (+1) = 8$。这会生成轮廓 $P_{34}$：\n`TAACAAAT`\n`TAACAAAT`\n\n**步骤 3：$P_{12}$ 和 $P_{34}$ 的轮廓-轮廓比对**\n算法现在比对这两个固定的轮廓。由于两个轮廓的长度都为 8，得分最高的比对几乎肯定是不引入新空位的那个。让我们来分析它们各列的比对：\n- $P_{12}$: `TAAAAA-T` / `TAAAAAAT`\n- $P_{34}$: `TAACAAAT` / `TAACAAAT`\n\n最终的 MSA 是通过叠加这些比对来构建的：\n$S_1$: `T A A A A A - T`\n$S_2$: `T A A A A A A T`\n$S_3$: `T A A C A A A T`\n$S_4$: `T A A C A A A T`\n\n**最终 MSA 分析**\n这就是由指定流程生成的 MSA。我们现在必须评估其质量。一个“好”的 MSA 应该正确地表示位点之间的进化关系（同源性）。$S_3$ 和 $S_4$ 中位置 $4$ 的胞嘧啶 (`C`) 是信息丰富的“锚定”残基，因为它们打破了同聚物连续区的模糊性。在 $S_1$ 和 $S_2$ 中的同源位点是位置 $4$ 的腺嘌呤。\n- 在生成的 MSA 中，第 $4$ 列是 `(A, A, C, C)`。这正确地将 `C` 与它们的同源 `A` 对齐了。\n\n然而，插入缺失（indel）的比对是有问题的。$S_1$ 和 $S_2$ 之间的差异是一个 indel。$S_3, S_4$ 中锚定 `C` 的存在表明，一个信息更充分的 $S_1,S_2$ 比对可能会将空位放置在不同的位置。例如，像 `TA-AAAAAT` / `TAAAAAAAT` 这样的比对会导致一个不同的最终 MSA，其中 indel 和替换事件的位置更接近。然而，渐进式算法无法做到这一点。它仅基于来自 $S_1$ 和 $S_2$ 的信息，根据一个任意的平局打破规则来确定 $(S_1, S_2)$ 的空位放置。来自 $S_3$ 和 $S_4$ 中 `C` 的信息来得太晚，无法影响这个初始的关键决策。因此，indel 的位置被任意固定了。这是渐进式比对中贪婪策略弱点的一个经典例子。由此产生的 MSA 在“生物学上质量差”，不是因为其配对总和分数必然低，而是因为一个关键特征（indel 的位置）是由一个任意规则决定的，而不是通过对所有可用证据的完整分析来决定的。这是一种同源性错位。\n\n### 逐项选项分析\n\n**A. 因为引导树是真实的系统发育，所以渐进式流程保证能产生全局最优的配对总和 MSA，其中 $S_3$ 和 $S_4$ 中的两个胞嘧啶比对在同一列，并与 $S_1$ 和 $S_2$ 中的同源位置对齐，无论如何打破平局。**\n**不正确**。渐进式比对是一种启发式方法。即使提供了正确的引导树，它也不保证能找到全局最优的 MSA。做出并固定早期比对决策的贪婪性质可能导致次优的最终比对。关于保证的说法是错误的。\n\n**B. $S_1$ 和 $S_2$ 的两两比对在腺嘌呤连续区内包含多个共优的位置来放置所需的单个空位；向右对齐的平局打破规则将该空位固定在连续区的右边缘。当合并 $(S_3,S_4)$ 轮廓时，算法保留了这个早期决策，并且无法移动它以适应信息丰富的胞嘧啶，从而即使引导树是正确的，也产生了一个生物学上质量差的 MSA（同源性错位）。**\n**正确**。这个陈述准确地描述了核心问题。有多种共优的方式来比对 $S_1$ 和 $S_2$。算法使用一个任意的平局打破规则来做出选择。这个贪婪的选择被永久固定下来（“once a gap, always a gap”）。后来可用的信息（$S_3$ 和 $S_4$ 中“信息丰富的胞嘧啶”）无法用于修正这个早期的决策。这可能导致一个比在同时考虑所有信息的情况下构建的比对在生物学上更不合理的比对。因此，由于这个任意、过早的决策，indel 事件的同源性被“错位”了。\n\n**C. 在最终的轮廓-轮廓比对期间，渐进式算法检测到早期的空位放置是次优的，并回溯以重新优化 $S_1$–$S_2$ 的比对，从而使 $S_3$ 和 $S_4$ 中的胞嘧啶落在它们的同源列中。**\n**不正确**。问题明确指出，“在任何阶段都不执行迭代优化或重新比对。……一旦确定，早期的两两比对决策就不会被重新审视。”这个选项描述了一种回溯或迭代优化策略，而这被明确排除了。\n\n**D. 在渐进式比对中，只有当引导树不正确时才会出现质量差的 MSA；如果引导树等于真实的系统发育，贪婪效应不会降低 MSA 的质量。**\n**不正确**。这个陈述从根本上是错误的。渐进式比对中的主要误差来源是其贪婪性质，而不一定是错误的引导树。即使有完美的引导树，该算法也可能并且确实会产生次优比对，因为早期的局部最优选择可能不是全局最优的。这个问题就是这个原则的直接证明。", "answer": "$$\\boxed{B}$$", "id": "2418815"}]}