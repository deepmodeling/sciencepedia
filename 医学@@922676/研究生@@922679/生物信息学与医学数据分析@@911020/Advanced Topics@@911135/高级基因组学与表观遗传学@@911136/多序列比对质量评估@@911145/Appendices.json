{"hands_on_practices": [{"introduction": "本练习将带你掌握基于参考比对的评估基础。当有一个可信的“金标准”参考比对时，配对总和（Sum-of-Pairs, $SP$）分数和总列（Total Column, $TC$）分数是量化多序列比对准确性的两个最广泛使用的指标。通过亲手计算这些分数[@problem_id:4540449]，你将具体理解它们的工作原理，并体会评估单个同源残基对与评估整个比对列之间的区别。", "problem": "考虑一个生物信息学和医学数据分析中的多序列比对 (MSA) 质量评估场景。三个同源序列在 $5$ 列上进行比对。设这三个序列的残基索引如下：序列 $S_1$ 有残基 $a_1, a_2, a_3, a_4$，序列 $S_2$ 有残基 $b_1, b_2, b_3, b_4$，序列 $S_3$ 有残基 $c_1, c_2, c_3, c_4$。空位用 $-$ 表示，不被视作残基。候选比对 $A$ 按列指定如下：\n- 第 $1$ 列：$a_1$, $b_1$, $-$\n- 第 $2$ 列：$a_2$, $-$, $c_1$\n- 第 $3$ 列：$a_3$, $b_2$, $c_2$\n- 第 $4$ 列：$-$, $b_3$, $c_3$\n- 第 $5$ 列：$a_4$, $b_4$, $c_4$\n\n一个可信的结构参考通过参考比对 $R$ 定义了真实的共线性比对关系，其列如下：\n- 第 $1$ 列：$a_1$, $b_1$, $c_1$\n- 第 $2$ 列：$a_2$, $b_2$, $-$\n- 第 $3$ 列：$a_3$, $-$, $c_2$\n- 第 $4$ 列：$-$, $b_3$, $c_3$\n- 第 $5$ 列：$a_4$, $b_4$, $c_4$\n\n评估时，使用以下核心定义：\n- 配对和准确率 (SP) 定义为：在参考比对中共线性比对的残基对中，同时也在候选比对中共线性比对的残基对所占的比例。形式上，如果 $R$ 是参考比对中所有共线性比对的无序残基对集合（不包括任何空位），而 $P_A$ 是候选比对中所有共线性比对的无序残基对集合（不包括任何空位），则 SP 准确率为 $\\frac{|R \\cap P_A|}{|R|}$。\n- 总列得分 (TC) 定义为被候选比对精确复现的参考列所占的比例。如果一个候选列中的非空位残基集合与相应参考列中的非空位残基集合完全相同，则认为该列被精确复现。形式上，如果有 $n$ 个参考列，其中 $m$ 个被精确复现，则 $\\mathrm{TC} = \\frac{m}{n}$。\n\n计算候选比对 $A$ 相对于参考比对 $R$ 的 SP 准确率和 TC 得分。请用精确分数表示最终答案。无需四舍五入。最终答案必须以行矩阵的形式给出，其中依次包含 SP 准确率和 TC 得分。", "solution": "用户提供的问题已经过验证，被确认为一个有效、定义明确的生物信息学问题。我现在将提供完整的解题步骤。\n\n该问题要求计算用于多序列比对 (MSA) 质量的两个标准后验指标：配对和 (SP) 准确率和总列 (TC) 得分。这些指标将一个候选比对 $A$ 与一个可信的参考比对 $R$ 进行比较。\n\n设三个序列为 $S_1$、$S_2$ 和 $S_3$。\n候选比对 $A$ 如下：\n- 第 $1$ 列：$(a_1, b_1, -)$\n- 第 $2$ 列：$(a_2, -, c_1)$\n- 第 $3$ 列：$(a_3, b_2, c_2)$\n- 第 $4$ 列：$(-, b_3, c_3)$\n- 第 $5$ 列：$(a_4, b_4, c_4)$\n\n参考比对 $R$ 如下：\n- 第 $1$ 列：$(a_1, b_1, c_1)$\n- 第 $2$ 列：$(a_2, b_2, -)$\n- 第 $3$ 列：$(a_3, -, c_2)$\n- 第 $4$ 列：$(-, b_3, c_3)$\n- 第 $5$ 列：$(a_4, b_4, c_4)$\n\n### 计算配对和 (SP) 准确率\n\nSP 准确率定义为 $\\frac{|R \\cap P_A|}{|R|}$，其中 $R$ 是参考比对中共线性比对的无序残基对集合，而 $P_A$ 是候选比对中的此类配对集合。\n\n首先，我们必须列举出参考比对 $R$ 中的共线性比对残基对集合。如果一对残基出现在同一列中，则它们是共线性比对的。\n- 来自 $R$ 的第 $1$ 列 $(a_1, b_1, c_1)$：配对为 $\\{a_1, b_1\\}$, $\\{a_1, c_1\\}$ 和 $\\{b_1, c_1\\}$。\n- 来自 $R$ 的第 $2$ 列 $(a_2, b_2, -)$：配对为 $\\{a_2, b_2\\}$。\n- 来自 $R$ 的第 $3$ 列 $(a_3, -, c_2)$：配对为 $\\{a_3, c_2\\}$。\n- 来自 $R$ 的第 $4$ 列 $(-, b_3, c_3)$：配对为 $\\{b_3, c_3\\}$。\n- 来自 $R$ 的第 $5$ 列 $(a_4, b_4, c_4)$：配对为 $\\{a_4, b_4\\}$, $\\{a_4, c_4\\}$ 和 $\\{b_4, c_4\\}$。\n\n因此，集合 $R$ 是：\n$$R = \\{ \\{a_1, b_1\\}, \\{a_1, c_1\\}, \\{b_1, c_1\\}, \\{a_2, b_2\\}, \\{a_3, c_2\\}, \\{b_3, c_3\\}, \\{a_4, b_4\\}, \\{a_4, c_4\\}, \\{b_4, c_4\\} \\}$$\n参考比对中共线性比对的配对总数为 $|R| = 3 + 1 + 1 + 1 + 3 = 9$。\n\n接下来，我们列举出候选比对 $P_A$ 中的共线性比对残基对集合。\n- 来自 $A$ 的第 $1$ 列 $(a_1, b_1, -)$：配对为 $\\{a_1, b_1\\}$。\n- 来自 $A$ 的第 $2$ 列 $(a_2, -, c_1)$：配对为 $\\{a_2, c_1\\}$。\n- 来自 $A$ 的第 $3$ 列 $(a_3, b_2, c_2)$：配对为 $\\{a_3, b_2\\}$, $\\{a_3, c_2\\}$ 和 $\\{b_2, c_2\\}$。\n- 来自 $A$ 的第 $4$ 列 $(-, b_3, c_3)$：配对为 $\\{b_3, c_3\\}$。\n- 来自 $A$ 的第 $5$ 列 $(a_4, b_4, c_4)$：配对为 $\\{a_4, b_4\\}$, $\\{a_4, c_4\\}$ 和 $\\{b_4, c_4\\}$。\n\n集合 $P_A$ 是：\n$$P_A = \\{ \\{a_1, b_1\\}, \\{a_2, c_1\\}, \\{a_3, b_2\\}, \\{a_3, c_2\\}, \\{b_2, c_2\\}, \\{b_3, c_3\\}, \\{a_4, b_4\\}, \\{a_4, c_4\\}, \\{b_4, c_4\\} \\}$$\n\n现在，我们求这两个集合的交集 $R \\cap P_A$。我们检查 $P_A$ 中的哪些配对也存在于 $R$ 中。\n- $\\{a_1, b_1\\}$: 存在于 $R$ 中。\n- $\\{a_2, c_1\\}$: 不存在于 $R$ 中。\n- $\\{a_3, b_2\\}$: 不存在于 $R$ 中。\n- $\\{a_3, c_2\\}$: 存在于 $R$ 中。\n- $\\{b_2, c_2\\}$: 不存在于 $R$ 中。\n- $\\{b_3, c_3\\}$: 存在于 $R$ 中。\n- $\\{a_4, b_4\\}$: 存在于 $R$ 中。\n- $\\{a_4, c_4\\}$: 存在于 $R$ 中。\n- $\\{b_4, c_4\\}$: 存在于 $R$ 中。\n\n正确比对的配对集合是：\n$$R \\cap P_A = \\{ \\{a_1, b_1\\}, \\{a_3, c_2\\}, \\{b_3, c_3\\}, \\{a_4, b_4\\}, \\{a_4, c_4\\}, \\{b_4, c_4\\} \\}$$\n正确比对的配对数量为 $|R \\cap P_A| = 1 + 1 + 1 + 3 = 6$。\n\nSP 准确率为：\n$$ \\text{SP} = \\frac{|R \\cap P_A|}{|R|} = \\frac{6}{9} = \\frac{2}{3} $$\n\n### 计算总列 (TC) 得分\n\nTC 得分定义为 $\\frac{m}{n}$，其中 $n$ 是参考比对中的总列数， $m$ 是在候选比对中被精确复现的列数。如果一列的非空位残基集合与参考比对中相应列的非空位残基集合相同，则该列被视为精确复现。\n\n总列数为 $n=5$。我们比较 $A$ 和 $R$ 的每一列。设 $C_R(i)$ 为 $R$ 中第 $i$ 列的非空位残基集合， $C_A(i)$ 为 $A$ 中第 $i$ 列的集合。\n\n- **第 1 列：**\n  - $C_R(1) = \\{a_1, b_1, c_1\\}$\n  - $C_A(1) = \\{a_1, b_1\\}$\n  - $C_R(1) \\neq C_A(1)$。该列未被复现。\n\n- **第 2 列：**\n  - $C_R(2) = \\{a_2, b_2\\}$\n  - $C_A(2) = \\{a_2, c_1\\}$\n  - $C_R(2) \\neq C_A(2)$。该列未被复现。\n\n- **第 3 列：**\n  - $C_R(3) = \\{a_3, c_2\\}$\n  - $C_A(3) = \\{a_3, b_2, c_2\\}$\n  - $C_R(3) \\neq C_A(3)$。该列未被复现。\n\n- **第 4 列：**\n  - $C_R(4) = \\{b_3, c_3\\}$\n  - $C_A(4) = \\{b_3, c_3\\}$\n  - $C_R(4) = C_A(4)$。该列被复现。\n\n- **第 5 列：**\n  - $C_R(5) = \\{a_4, b_4, c_4\\}$\n  - $C_A(5) = \\{a_4, b_4, c_4\\}$\n  - $C_R(5) = C_A(5)$。该列被复现。\n\n精确复现的列数为 $m=2$。\n\nTC 得分为：\n$$ \\text{TC} = \\frac{m}{n} = \\frac{2}{5} $$\n\n因此，SP 准确率为 $\\frac{2}{3}$，TC 得分为 $\\frac{2}{5}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3}  \\frac{2}{5}\n\\end{pmatrix}\n}\n$$", "id": "4540449"}, {"introduction": "并非所有的比对评估都能依赖于一个完整的参考比对。本练习将介绍一种强大的替代方法：基于一致性的评估。在这种方法中，我们不再将一个多序列比对（MSA）与单一参考进行比较，而是评估其与一个外部证据“库”（library）的一致性，该库可源自各种成对比对或结构信息。这个练习[@problem_id:4540322]将指导你计算一个一致性分数，展示如何整合不同的生物学证据来评估比对质量。", "problem": "一个研究团队正在使用一种基于成对证据的简单一致性方法来评估多序列比对 (MSA) 的质量。该问题的基本依据是以下标准定义：MSA 在列中对齐序列间的同源残基；残基-残基库将同源性的外部证据编码为序列间残基索引之间的加权边；每列的一致性度量可以定义为该列中所有共同对齐的无序残基对的支持权重的经验平均值。缺失的边被视为零支持权重。总体指数是包含至少两个非间隙残基的列的列指数的平均值。\n\n考虑四个蛋白质序列及其 MSA 如下。对于每个序列，括号中的数字是该序列中残基的原始索引。连字符 (-) 表示一个间隙。\n- 序列 $\\mathrm{S1}$: $A(1)\\ C(2)\\ G(3)\\ T(4)$\n- 序列 $\\mathrm{S2}$: $A(1)\\ C(2)\\ -\\ T(3)$\n- 序列 $\\mathrm{S3}$: $A(1)\\ G(2)\\ G(3)\\ T(4)$\n- 序列 $\\mathrm{S4}$: $A(1)\\ C(2)\\ G(3)\\ -$\n\n因此，该 MSA 有 $4$ 列：\n- 第 $1$ 列：$\\mathrm{S1}:A(1)$, $\\mathrm{S2}:A(1)$, $\\mathrm{S3}:A(1)$, $\\mathrm{S4}:A(1)$\n- 第 $2$ 列：$\\mathrm{S1}:C(2)$, $\\mathrm{S2}:C(2)$, $\\mathrm{S3}:G(2)$, $\\mathrm{S4}:C(2)$\n- 第 $3$ 列：$\\mathrm{S1}:G(3)$, $\\mathrm{S2}:-$, $\\mathrm{S3}:G(3)$, $\\mathrm{S4}:G(3)$\n- 第 $4$ 列：$\\mathrm{S1}:T(4)$, $\\mathrm{S2}:T(3)$, $\\mathrm{S3}:T(4)$, $\\mathrm{S4}:-$\n\n一个残基-残基库提供了序列间残基之间的以下无向边，每条边都有一个在 $[0,1]$ 范围内的权重，该权重衡量了两个残基是同源且应被对齐的外部证据：\n- 对于索引为 $(\\mathrm{S1}:1,\\mathrm{S2}:1)$ 的残基，权重为 $1.0$；对于 $(\\mathrm{S1}:1,\\mathrm{S3}:1)$，权重为 $0.9$；对于 $(\\mathrm{S1}:1,\\mathrm{S4}:1)$，权重为 $1.0$；对于 $(\\mathrm{S2}:1,\\mathrm{S3}:1)$，权重为 $0.8$；对于 $(\\mathrm{S2}:1,\\mathrm{S4}:1)$，权重为 $0.95$；对于 $(\\mathrm{S3}:1,\\mathrm{S4}:1)$，权重为 $0.85$。\n- 对于索引为 $(\\mathrm{S1}:2,\\mathrm{S2}:2)$ 的残基，权重为 $0.9$；对于 $(\\mathrm{S1}:2,\\mathrm{S3}:2)$，权重为 $0.1$；对于 $(\\mathrm{S1}:2,\\mathrm{S4}:2)$，权重为 $0.9$；对于 $(\\mathrm{S2}:2,\\mathrm{S3}:2)$，权重为 $0.2$；对于 $(\\mathrm{S2}:2,\\mathrm{S4}:2)$，权重为 $0.85$；对于 $(\\mathrm{S3}:2,\\mathrm{S4}:2)$，权重为 $0.15$。\n- 对于索引为 $(\\mathrm{S1}:3,\\mathrm{S3}:3)$ 的残基，权重为 $0.7$；对于 $(\\mathrm{S1}:3,\\mathrm{S4}:3)$，权重为 $0.6$；对于 $(\\mathrm{S3}:3,\\mathrm{S4}:3)$，权重为 $0.65$。\n- 对于索引为 $(\\mathrm{S1}:4,\\mathrm{S2}:3)$ 的残基，权重为 $0.5$；对于 $(\\mathrm{S1}:4,\\mathrm{S3}:4)$，权重为 $0.8$；对于 $(\\mathrm{S2}:3,\\mathrm{S3}:4)$，权重为 $0.4$。\n任何未列出的库中的边均被视为权重为 $0$。\n\n仅使用这些定义，按以下步骤进行：\n- 对于每个至少包含两个非间隙残基的 MSA 列，从第一性原理推导出该列的简单一致性指数的显式表达式，该指数为该列中所有无序残基对的可用库支持权重的经验平均值。\n- 使用提供的库计算每列的指数。\n- 将 MSA 的总体简单一致性指数定义为至少包含两个非间隙残基的列的列指数的算术平均值，并计算它。\n\n此外，在你的推理中，指明哪一列得分最低，并根据库中的边解释是什么导致该区域的支持度较弱。你最终报告的答案必须是总体简单一致性指数。将你的答案四舍五入到四位有效数字。不要包含任何单位。", "solution": "问题陈述被认为是有效的。它在科学上基于生物信息学的原理，特别是多序列比对 (MSA) 的质量评估。其定义、数据和目标都是自洽、一致且良定的，从而能够得出一个唯一且可验证的解。\n\n任务是根据给定的 MSA 与外部残基-残基同源证据库的一致性，计算其总体质量指数。该方法的核心是每列的“简单一致性指数”，定义为所有已对齐残基对的库支持权重的经验平均值。\n\n设 MSA 的第 $j$ 列包含一个由 $N_j$ 个非间隙残基组成的集合，我们将其记作 $C_j = \\{\\rho_{1,j}, \\rho_{2,j}, \\dots, \\rho_{N_j,j}\\}$。此列中唯一的、无序的残基对的数量由二项式系数 $\\binom{N_j}{2}$ 给出。设 $w(\\rho_{a,j}, \\rho_{b,j})$ 表示所提供库中残基对 $(\\rho_{a,j}, \\rho_{b,j})$ 的支持权重。第 $j$ 列的简单一致性指数，记为 $I_j$，形式上表示为：\n$$ I_j = \\frac{\\sum_{\\{\\rho_{a,j}, \\rho_{b,j}\\} \\subseteq C_j, a \\neq b} w(\\rho_{a,j}, \\rho_{b,j})}{\\binom{N_j}{2}} $$\n问题规定，该指数应为所有包含至少两个非间隙残基的列计算。对于给定的 MSA，所有 $4$ 列都满足此标准。\n\n第 $1$ 列的计算：\n非间隙残基集合为 $\\{\\mathrm{S1:1}, \\mathrm{S2:1}, \\mathrm{S3:1}, \\mathrm{S4:1}\\}$。残基数量为 $N_1 = 4$，因此有 $\\binom{4}{2} = 6$ 个残基对。这些残基对的库权重的总和是：\n$$ S_1 = w(\\mathrm{S1:1}, \\mathrm{S2:1}) + w(\\mathrm{S1:1}, \\mathrm{S3:1}) + w(\\mathrm{S1:1}, \\mathrm{S4:1}) + w(\\mathrm{S2:1}, \\mathrm{S3:1}) + w(\\mathrm{S2:1}, \\mathrm{S4:1}) + w(\\mathrm{S3:1}, \\mathrm{S4:1}) $$\n$$ S_1 = 1.0 + 0.9 + 1.0 + 0.8 + 0.95 + 0.85 = 5.5 $$\n第 $1$ 列的指数是 $I_1 = \\frac{5.5}{6}$。\n\n第 $2$ 列的计算：\n非间隙残基集合为 $\\{\\mathrm{S1:2}, \\mathrm{S2:2}, \\mathrm{S3:2}, \\mathrm{S4:2}\\}$。残基数量为 $N_2 = 4$，因此有 $\\binom{4}{2} = 6$ 个残基对。库权重的总和是：\n$$ S_2 = w(\\mathrm{S1:2}, \\mathrm{S2:2}) + w(\\mathrm{S1:2}, \\mathrm{S3:2}) + w(\\mathrm{S1:2}, \\mathrm{S4:2}) + w(\\mathrm{S2:2}, \\mathrm{S3:2}) + w(\\mathrm{S2:2}, \\mathrm{S4:2}) + w(\\mathrm{S3:2}, \\mathrm{S4:2}) $$\n$$ S_2 = 0.9 + 0.1 + 0.9 + 0.2 + 0.85 + 0.15 = 3.1 $$\n第 $2$ 列的指数是 $I_2 = \\frac{3.1}{6}$。\n\n第 $3$ 列的计算：\n非间隙残基集合为 $\\{\\mathrm{S1:3}, \\mathrm{S3:3}, \\mathrm{S4:3}\\}$。残基数量为 $N_3 = 3$，因此有 $\\binom{3}{2} = 3$ 个残基对。库权重的总和是：\n$$ S_3 = w(\\mathrm{S1:3}, \\mathrm{S3:3}) + w(\\mathrm{S1:3}, \\mathrm{S4:3}) + w(\\mathrm{S3:3}, \\mathrm{S4:3}) $$\n$$ S_3 = 0.7 + 0.6 + 0.65 = 1.95 $$\n第 $3$ 列的指数是 $I_3 = \\frac{1.95}{3} = 0.65$。\n\n第 $4$ 列的计算：\n非间隙残基集合，由其原始序列索引标识，为 $\\{\\mathrm{S1:4}, \\mathrm{S2:3}, \\mathrm{S3:4}\\}$。残基数量为 $N_4 = 3$，因此有 $\\binom{3}{2} = 3$ 个残基对。库权重的总和是：\n$$ S_4 = w(\\mathrm{S1:4}, \\mathrm{S2:3}) + w(\\mathrm{S1:4}, \\mathrm{S3:4}) + w(\\mathrm{S2:3}, \\mathrm{S3:4}) $$\n$$ S_4 = 0.5 + 0.8 + 0.4 = 1.7 $$\n第 $4$ 列的指数是 $I_4 = \\frac{1.7}{3}$。\n\n各列的指数分别为：\n$I_1 = \\frac{5.5}{6} \\approx 0.9167$\n$I_2 = \\frac{3.1}{6} \\approx 0.5167$\n$I_3 = 0.65$\n$I_4 = \\frac{1.7}{3} \\approx 0.5667$\n\n比较这些值，第 $2$ 列是得分最低的列 ($I_2 \\approx 0.5167$)。该列比对的弱支持是由于来自序列 $\\mathrm{S3}$ 的残基是 $\\mathrm{G(2)}$，而其他序列是 $\\mathrm{C(2)}$。包含 $\\mathrm{S3:2}$ 的残基对的库权重一直很低 ($w(\\mathrm{S1:2}, \\mathrm{S3:2}) = 0.1$，$w(\\mathrm{S2:2}, \\mathrm{S3:2}) = 0.2$，$w(\\mathrm{S3:2}, \\mathrm{S4:2}) = 0.15$)，这表明外部证据不支持 $\\mathrm{S3:2}$ 与第 $2$ 列中其他残基的同源性。这使得该列的比对与库不一致。\n\nMSA 的总体简单一致性指数 $I_{MSA}$ 是所有符合条件的列的指数的算术平均值：\n$$ I_{MSA} = \\frac{I_1 + I_2 + I_3 + I_4}{4} = \\frac{1}{4} \\left( \\frac{5.5}{6} + \\frac{3.1}{6} + \\frac{1.95}{3} + \\frac{1.7}{3} \\right) $$\n使用公分母 $6$：\n$$ I_{MSA} = \\frac{1}{4} \\left( \\frac{5.5}{6} + \\frac{3.1}{6} + \\frac{2 \\times 1.95}{6} + \\frac{2 \\times 1.7}{6} \\right) = \\frac{1}{4} \\left( \\frac{5.5 + 3.1 + 3.9 + 3.4}{6} \\right) $$\n$$ I_{MSA} = \\frac{1}{4} \\left( \\frac{15.9}{6} \\right) = \\frac{15.9}{24} $$\n最终的数值是：\n$$ I_{MSA} = 0.6625 $$\n该值已经按要求表示为 $4$ 位有效数字。", "answer": "$$\n\\boxed{0.6625}\n$$", "id": "4540322"}, {"introduction": "质量分数不仅仅是报告中的数字，它们更是用于改进生物学分析的可操作工具。这最后一个练习将理论与应用联系起来，展示了如何利用逐列的置信度分数来做出关于信任比对哪些部分的关键决策。你将学习如何应用一个统计框架来过滤不可可靠的列，同时控制假发现率（False Discovery Rate, $FDR$）[@problem_id:4540435]，这是在系统发育推断或蛋白质家族分析等下游任务中提高信噪比的关键步骤。", "problem": "一个生物信息学流程生成了一个带有每列置信度的多重序列比对（MSA）。对于每个索引为 $i \\in \\{1,\\dots,n\\}$ 的比对列，该流程输出一个数字 $c_i \\in [0,1]$，该数字被解释为第 $i$ 列比对正确的后验概率，即 $c_i = \\Pr(\\text{第 $i$ 列正确} \\mid \\text{数据})$。将第 $i$ 列的后验错误概率（PEP）定义为 $q_i = 1 - c_i = \\Pr(\\text{第 $i$ 列不正确} \\mid \\text{数据})$。\n\n您的任务是屏蔽不可靠的列，以控制错误发现率（FDR）。请使用以下基本定义：\n- 错误发现率（FDR）是在所有选择中错误选择所占的期望比例。\n- 对于一个固定的选择集 $S \\subset \\{1,\\dots,n\\}$，错误选择的期望数量是其后验错误概率的总和。\n\n仅从这些定义出发，并且不通过名称调用任何专门的多重检验程序，推导出一个阈值规则。该规则在给定一个目标FDR水平 $\\alpha \\in (0,1)$ 的情况下，通过对PEP $q_i$ 设置阈值来指定保留哪些列，以使得（后验）期望FDR至多为 $\\alpha$，同时尽可能多地保留列。然后，将您的规则应用于以下具有 $n = 12$ 列的MSA，其每列的置信度为\n$$\n\\{c_i\\}_{i=1}^{12} = \\{0.55,\\ 0.97,\\ 0.90,\\ 0.40,\\ 0.99,\\ 0.85,\\ 0.70,\\ 0.95,\\ 0.50,\\ 0.60,\\ 0.92,\\ 0.80\\}。\n$$\n使用目标FDR $\\alpha = 0.10$。\n\n将保留的有效比对长度定义为\n$$\nL_{\\mathrm{eff}} = \\sum_{i \\in S} c_i,\n$$\n即保留集 $S$ 中正确比对列的后验期望数量。计算您的阈值规则对给定数据产生的 $L_{\\mathrm{eff}}$。将您的最终数值四舍五入到四位有效数字。将您的最终答案表示为一个不带单位的纯数字。", "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 一个多重序列比对（MSA）有 $n$ 列，索引为 $i \\in \\{1, \\dots, n\\}$。\n- 每列置信度：$c_i \\in [0,1]$。\n- 置信度的解释：$c_i = \\Pr(\\text{第 } i \\text{ 列正确} \\mid \\text{数据})$。\n- 后验错误概率（PEP）：$q_i = 1 - c_i = \\Pr(\\text{第 } i \\text{ 列不正确} \\mid \\text{数据})$。\n- 错误发现率（FDR）是在所有选择中错误选择所占的期望比例。\n- 对于一个固定的选择集 $S \\subset \\{1,\\dots,n\\}$，错误选择的期望数量是其后验错误概率的总和。\n- 目标FDR水平：$\\alpha \\in (0,1)$。\n- 任务：推导出一个阈值规则，通过对PEP $q_i$ 设置阈值来选择一个列集合 $S$，使得（后验）期望FDR至多为 $\\alpha$，同时尽可能多地保留列。\n- 给定数据：$n = 12$。\n- 给定置信度值：$\\{c_i\\}_{i=1}^{12} = \\{0.55,\\ 0.97,\\ 0.90,\\ 0.40,\\ 0.99,\\ 0.85,\\ 0.70,\\ 0.95,\\ 0.50,\\ 0.60,\\ 0.92,\\ 0.80\\}$。\n- 给定目标FDR：$\\alpha = 0.10$。\n- 保留的有效比对长度的定义：$L_{\\mathrm{eff}} = \\sum_{i \\in S} c_i$。\n- 最终目标：计算所选集合 $S$ 的 $L_{\\mathrm{eff}}$，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，在生物信息学中统计质量控制的标准框架内操作。后验错误概率和错误发现率的概念是分析包括MSA在内的高通量数据的基本工具。所提供的定义是自洽且标准的。该问题是适定的：它提供了一个明确的目标（最大化保留的列数），受一个明确的约束（FDR $\\le \\alpha$）限制，并提供了所有必要的数据和定义以获得唯一解。问题陈述是客观的，并使用了精确、无歧义的语言。它没有违反任何无效性标准。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供一个完整的解答。\n\n### 阈值规则的推导\n\n令 $S$ 为被保留（选中）的列的索引集。保留的列数为 $|S|$。令 $I_i$ 为一个指示变量，如果第 $i$ 列不正确，则 $I_i = 1$，如果正确，则 $I_i = 0$。给定的后验错误概率为 $q_i = \\Pr(I_i = 1 \\mid \\text{数据}) = E[I_i \\mid \\text{数据}]$。\n\n集合 $S$ 中不正确的列数为 $V(S) = \\sum_{i \\in S} I_i$。问题陈述指出，$S$ 中错误选择的期望数量是其后验错误概率的总和。利用期望的线性性质，可得：\n$$\nE[V(S) \\mid \\text{data}] = E\\left[\\sum_{i \\in S} I_i \\mid \\text{data}\\right] = \\sum_{i \\in S} E[I_i \\mid \\text{data}] = \\sum_{i \\in S} q_i\n$$\n这证实了问题所提供的定义。\n\n问题将FDR定义为“在所有选择中错误选择所占的期望比例”。对于一个固定的选择集 $S$，这可以表述为后验期望FDR（也称为局部FDR或集合的q值），即错误选择的期望数量除以总选择数量：\n$$\n\\text{FDR}(S) = \\frac{E[V(S) \\mid \\text{data}]}{|S|} = \\frac{\\sum_{i \\in S} q_i}{|S|}\n$$\n我们的任务是找到一个集合 $S$，在满足约束条件 $\\text{FDR}(S) \\le \\alpha$ 的前提下，最大化 $|S|$。\n\n为了在保持平均 $q_i$ 值较低的同时最大化 $S$ 的大小，我们应优先包含具有最小后验错误概率 $q_i$ 的列。这表明可以采用一种基于对PEP进行排序的程序。\n\n令排序后的PEP为 $q_{(1)} \\le q_{(2)} \\le \\dots \\le q_{(n)}$。令 $S_k$ 为具有最低PEP的 $k$ 列的集合。该集合的后验期望FDR为：\n$$\n\\text{FDR}(S_k) = \\frac{1}{k} \\sum_{j=1}^k q_{(j)}\n$$\n我们想找到最大的集合，这对应于找到满足FDR约束的最大的 $k$ 值。令此值为 $k_{\\max}$。\n$$\nk_{\\max} = \\max \\left\\{ k \\in \\{1,\\dots,n\\} \\mid \\frac{1}{k} \\sum_{j=1}^k q_{(j)} \\le \\alpha \\right\\}\n$$\n如果不存在这样的 $k$，则结果集为空。否则，最终保留的集合是 $S = S_{k_{\\max}}$，其中包含具有最低PEP的 $k_{\\max}$ 列。此程序保证了在给定的FDR约束下，我们保留了最大数量的列。\n\n### 应用于给定数据\n\n首先，我们计算 $n=12$ 列中每一列的后验错误概率 $q_i = 1 - c_i$。\n给定的置信度值为：\n$\\{c_i\\} = \\{0.55, 0.97, 0.90, 0.40, 0.99, 0.85, 0.70, 0.95, 0.50, 0.60, 0.92, 0.80\\}$。\n对应的PEP为：\n$\\{q_i\\} = \\{0.45, 0.03, 0.10, 0.60, 0.01, 0.15, 0.30, 0.05, 0.50, 0.40, 0.08, 0.20\\}$。\n\n接下来，我们将PEP按非递减顺序排序。我们记录原始索引、排序后的PEP $q_{(j)}$、排序后PEP的累积和 $\\sum_{l=1}^j q_{(l)}$，以及对应于前 $j$ 列集合的FDR，其中 $\\alpha = 0.10$。\n\n| 排名 $j$ | 原始索引 $i$ | 排序后的PEP $q_{(j)}$ | 累积PEP $\\sum_{l=1}^j q_{(l)}$ | FDR = $\\frac{1}{j}\\sum q_{(l)}$ | FDR $\\le 0.10$？ |\n|---|---|---|---|---|---|\n| $1$ | $5$ | $0.01$ | $0.01$ | $0.0100$         | 是 |\n| $2$ | $2$ | $0.03$ | $0.04$ | $0.0200$         | 是 |\n| $3$ | $8$ | $0.05$ | $0.09$ | $0.0300$         | 是 |\n| $4$ | $11$| $0.08$ | $0.17$ | $0.0425$         | 是 |\n| $5$ | $3$ | $0.10$ | $0.27$ | $0.0540$         | 是 |\n| $6$ | $6$ | $0.15$ | $0.42$ | $0.0700$         | 是 |\n| $7$ | $12$| $0.20$ | $0.62$ | $0.0886$ （约） | 是 |\n| $8$ | $7$ | $0.30$ | $0.92$ | $0.1150$         | 否  |\n| $9$ | $10$| $0.40$ | $1.32$ | $0.1467$ （约） | 否  |\n| $10$| $1$ | $0.45$ | $1.77$ | $0.1770$         | 否  |\n| $11$| $9$ | $0.50$ | $2.27$ | $0.2064$ （约） | 否  |\n| $12$| $4$ | $0.60$ | $2.87$ | $0.2392$ （约） | 否  |\n\n满足FDR条件的最大排名 $k$ 是 $k_{\\max} = 7$。\n因此，保留的集合 $S$ 由具有最低PEP的7列组成。这些列的原始索引是 $\\{5, 2, 8, 11, 3, 6, 12\\}$。\n\n### 保留的有效比对长度的计算\n\n保留的有效比对长度 $L_{\\mathrm{eff}}$ 是保留集 $S$ 中各列置信度值 $c_i$ 的总和。\n$S$ 中的列对应的原始索引为 $i \\in \\{2, 3, 5, 6, 8, 11, 12\\}$。\n相应的置信度值 $c_i$ 是：\n- $c_2 = 0.97$\n- $c_3 = 0.90$\n- $c_5 = 0.99$\n- $c_6 = 0.85$\n- $c_8 = 0.95$\n- $c_{11} = 0.92$\n- $c_{12} = 0.80$\n\n我们将这些值相加：\n$$\nL_{\\mathrm{eff}} = \\sum_{i \\in S} c_i = 0.97 + 0.90 + 0.99 + 0.85 + 0.95 + 0.92 + 0.80\n$$\n计算此和的另一种方法是使用PEP：\n$$\nL_{\\mathrm{eff}} = \\sum_{i \\in S} (1-q_i) = |S| - \\sum_{i \\in S} q_i\n$$\n从表中可知，$|S| = k_{\\max} = 7$，这些列的PEP之和是排名为7时的累积和，即 $0.62$。\n$$\nL_{\\mathrm{eff}} = 7 - 0.62 = 6.38\n$$\n问题要求将结果四舍五入到四位有效数字。值 $6.38$ 可以写成 $6.380$ 来表示这个精度。", "answer": "$$\\boxed{6.380}$$", "id": "4540435"}]}