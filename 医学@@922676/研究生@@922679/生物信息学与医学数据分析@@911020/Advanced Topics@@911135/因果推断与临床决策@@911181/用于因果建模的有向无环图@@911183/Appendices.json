{"hands_on_practices": [{"introduction": "在利用有向无环图（DAG）进行因果推断时，首要任务是理解变量间的关联路径。d-分离（d-separation）为我们提供了一套精确的图形规则，用以判断在给定某些变量作为条件时，任意两个节点之间是否存在统计关联。这项练习旨在通过一个基础的生物信息学场景，帮助你掌握d-分离的核心概念，特别是对“对撞节点”（collider）的处理，这是识别和避免“选择性偏倚”等问题的关键。[@problem_id:4557701]", "problem": "在针对医疗数据的一项因果分析中，考虑一个有向无环图 (DAG)，它代表了转化生物信息学中的一个简化路径，其中 $X$ 表示遗传变异，$Y$ 表示环境暴露，$Z$ 表示分子生物标志物，而 $W$ 表示下游临床结局。该 DAG 的节点集为 $\\{X, Y, Z, W\\}$，有向边为 $X \\to Z$、$Y \\to Z$、$Z \\to W$，且不存在其他边。请使用有向无环图中 $d$-分离的正式定义，按以下步骤进行：\n\n- 枚举 $X$ 和 $Y$ 之间的所有简单路径（不含重复节点的路径）。\n- 对于 $X$ 和 $Y$ 之间的每条简单路径 $p$，定义一个指示符 $I(p)$：如果路径在以 $Z$ 为条件进行 $d$-分离时被阻断，则 $I(p) = 1$，否则 $I(p) = 0$。\n- 定义量 $D$ 为\n$$\nD \\;=\\; \\prod_{p \\in \\mathcal{P}(X,Y)} I(p),\n$$\n其中 $\\mathcal{P}(X,Y)$ 是 $X$ 和 $Y$ 之间所有简单路径的集合。\n\n计算 $D$ 的值。最终答案必须以单个实数的形式报告。不需要四舍五入，也不应包含任何单位。", "solution": "该问题要求在一个指定的有向无环图 (DAG) 中，计算一个与 $d$-分离概念相关的量 $D$。我们必须首先验证问题陈述的有效性。\n\n问题给出了以下已知条件：\n- 一个节点集 $V = \\{X, Y, Z, W\\}$，分别代表遗传变异 ($X$)、环境暴露 ($Y$)、分子生物标志物 ($Z$) 和临床结局 ($W$)。\n- 一个有向边集 $E = \\{(X,Z), (Y,Z), (Z,W)\\}$，对应于图结构 $X \\to Z$、$Y \\to Z$ 和 $Z \\to W$。\n- 图中不存在其他边的约束。\n- 对于 $X$ 和 $Y$ 之间的任意简单路径 $p$，定义了一个指示函数 $I(p)$。如果路径 $p$ 在以 $Z$ 为条件时被阻断，则 $I(p)=1$，否则 $I(p)=0$。\n- 一个关于量 $D$ 的定义 $D = \\prod_{p \\in \\mathcal{P}(X,Y)} I(p)$，其中 $\\mathcal{P}(X,Y)$ 是 $X$ 和 $Y$ 之间所有简单路径的集合。\n\n该问题具有科学依据，因为它使用了图模型和因果推断理论中的标准、明确定义的概念，特别是 DAG 和 $d$-分离。其结构和变量是生物信息学中简化模型的典型代表。该问题是适定 (well-posed) 的，具有完全指定的图和明确的目标。它是客观、完整且不含矛盾的。因此，该问题被认为是有效的，我们可以继续求解。\n\n解决过程包括三个步骤：\n1.  识别 $X$ 和 $Y$ 之间的所有简单路径的集合，记为 $\\mathcal{P}(X,Y)$。\n2.  对于该集合中的每条路径，确定它是否在以 $Z$ 为条件时被阻断。\n3.  根据这些判定计算 $D$ 的值。\n\n步骤 1：枚举 $X$ 和 $Y$ 之间的简单路径。\n图中的路径是由边连接的节点序列，在路径遍历中不考虑边的方向。简单路径是指不包含重复节点的路径。\n图结构由边 $X \\to Z$、$Y \\to Z$ 和 $Z \\to W$ 给出。\n要找到一条从 $X$ 到 $Y$ 的路径，我们从 $X$ 开始。与 $X$ 相邻的唯一节点是 $Z$。从 $Z$ 出发，相邻的节点是 $X$、$Y$ 和 $W$。为了不重复节点地到达 $Y$，从 $Z$ 出发的唯一可能下一步是到 $Y$。\n因此，$X$ 和 $Y$ 之间只有一条简单路径：路径 $p_1 = (X, Z, Y)$。\n所有简单路径的集合是 $\\mathcal{P}(X,Y) = \\{p_1\\}$。\n\n步骤 2：将 $d$-分离的规则应用于路径 $p_1$。\n路径 $p_1 = (X, Z, Y)$ 由边 $X \\to Z$ 和 $Y \\to Z$ 组成。当看作路径的一部分时，其结构为 $X \\to Z \\leftarrow Y$。\n在 $d$-分离的术语中，节点 $Z$ 是这条路径上的一个**对撞节点** (collider)，因为有两个箭头在 $Z$ 处相遇。\n\n路径被一个条件集 $S$ 阻断的规则如下：\n如果一条路径包含一个节点 $N$ 满足以下条件之一，则该路径被阻断：\n(a) $N$ 是路径上的一个链节点 ($\\to N \\to$) 或分叉节点 ($\\leftarrow N \\to$)，且 $N \\in S$。\n(b) $N$ 是路径上的一个对撞节点 ($\\to N \\leftarrow$)，且 $N$ 及其任何后代节点都不在 $S$ 中。\n\n我们需要确定路径 $p_1$ 在以集合 $S = \\{Z\\}$ 为条件时是否被阻断。\n路径 $p_1$ 包含对撞节点 $Z$。我们应用规则 (b)。\n要使路径被对撞节点阻断，条件是该对撞节点本身 ($Z$) 及其任何后代节点都不能在条件集 $S$ 中。\n在本例中，条件集是 $S = \\{Z\\}$。对撞节点 $Z$ 本身就在条件集中。\n因此，路径被阻断的条件未被满足。一条未被阻断的路径被称为是开放的或未阻断的。\n以对撞节点（或其后代节点之一）为条件会打开关联路径。\n所以，路径 $p_1$ 在以 $Z$ 为条件时**未被阻断**。\n\n步骤 3：计算 $D$ 的值。\n指示函数 $I(p)$ 的定义为：如果路径 $p$ 被阻断，则 $I(p)=1$，否则 $I(p)=0$。\n对于我们的路径 $p_1$，因为它在以 $Z$ 为条件时未被阻断，所以指示符的值为 $I(p_1) = 0$。\n\n量 $D$ 是在 $X$ 和 $Y$ 之间所有简单路径上的这些指示符值的乘积。\n$$\nD = \\prod_{p \\in \\mathcal{P}(X,Y)} I(p)\n$$\n由于 $\\mathcal{P}(X,Y) = \\{p_1\\}$，该乘积简化为：\n$$\nD = I(p_1)\n$$\n代入我们找到的 $I(p_1)$ 的值：\n$$\nD = 0\n$$\n最终值为 $0$。", "answer": "$$\\boxed{0}$$", "id": "4557701"}, {"introduction": "理解了d-分离的规则后，下一步是量化不恰当的统计调整所带来的后果。在医学数据分析中，研究样本的选择过程本身可能受到基因和疾病状态的影响，从而引入一种称为“选择性偏倚”（selection bias）的系统性误差。这项练习将引导你通过一个结构因果模型，从第一性原理出发，推导出在线性回归分析中由对撞节点所引起的偏倚，从而清晰地揭示观察到的关联（association）与真实因果效应（causal effect）之间的差异。[@problem_id:4557806]", "problem": "在一项关注心血管风险的生物医学队列研究中，考虑一个有向无环图（DAG），该图编码了一个基因型变量 $X$（编码为连续的多基因评分）、一个临床结局 $Y$（编码为连续的严重性指数）和一个研究选择指示变量 $S$（编码为一个连续的潜在入组分数，若该分数高于某一阈值则被纳入研究）之间的因果关系。该DAG的结构为 $X \\to Y$、$X \\to S$ 和 $Y \\to S$，且不存在其他边。这种结构捕捉了医学数据分析中一种常见的选择过程，其中入组机制 $S$ 同时受到基线基因型 $X$ 和下游疾病严重性 $Y$ 的影响。\n\n假设一个与该DAG一致的线性高斯结构因果模型（SCM）：\n$$\nX \\;=\\; U_{x}, \\quad Y \\;=\\; \\alpha X + U_{y}, \\quad S \\;=\\; \\gamma_{x} X + \\gamma_{y} Y + U_{s},\n$$\n其中 $U_{x}$、$U_{y}$ 和 $U_{s}$ 是相互独立、均值为零的高斯扰动项，其方差分别为 $\\sigma_{x}^{2}$、$\\sigma_{y}^{2}$ 和 $\\sigma_{s}^{2}$。参数 $\\alpha$ 是 $X$ 对 $Y$ 的因果效应（即，在此SCM中设置 $X$ 对 $Y$ 的干预效应）。\n\n从有向无环图（DAG）、d-分离和线性高斯投影的基本定义出发，除了标准的二阶矩恒等式外，不假设任何简化的识别公式，推导在给定 $X$ 和 $S$ 的条件下 $Y$ 的最佳线性预测器中 $X$ 的系数的闭式解析表达式，即条件关联系数\n$$\n\\beta_{Y.X\\mid S},\n$$\n定义为在上述SCM所蕴含的观测联合分布下，$Y$ 对 $\\{X,S\\}$进行线性回归时 $X$ 的系数。然后，运用因果推理原则，判断 $\\beta_{Y.X\\mid S}$ 是否等于因果效应 $\\alpha$，并给出一个等式成立的必要充分条件（用 $\\alpha$、$\\gamma_{x}$、$\\gamma_{y}$、$\\sigma_{y}^{2}$ 和 $\\sigma_{s}^{2}$ 表示）。\n\n您最终报告的量必须是 $\\beta_{Y.X\\mid S}$ 作为 $(\\alpha, \\gamma_{x}, \\gamma_{y}, \\sigma_{y}^{2}, \\sigma_{s}^{2})$ 的函数的闭式解析表达式。不需要数值舍入，答案也不带任何物理单位。请以最简精确形式表达最终的解析表达式。", "solution": "该问题是有效的，因为它科学地基于因果推断的原理，定义和约束完备使其成为一个适定问题，并且使用标准的数学形式进行了客观的表述。它代表了生物统计学和流行病学中一个经典的对撞偏倚问题。\n\n目标是从 $Y$ 对 $X$ 和 $S$ 的多元线性回归中推导出系数 $\\beta_{Y.X \\mid S}$。该系数由多元变量环境下的普通最小二乘法标准公式定义。对于因变量 $Y$ 对两个预测变量 $X_1$ 和 $X_2$ 的回归， $X_1$ 的系数由以下公式给出：\n$$\n\\beta_{Y \\cdot X_1 \\mid X_2} = \\frac{\\text{Cov}(Y, X_1) \\text{Var}(X_2) - \\text{Cov}(Y, X_2) \\text{Cov}(X_1, X_2)}{\\text{Var}(X_1) \\text{Var}(X_2) - (\\text{Cov}(X_1, X_2))^2}\n$$\n在我们的案例中，$X_1=X$ 且 $X_2=S$。因此，我们需要根据给定的结构因果模型（SCM）计算变量 $X$、$Y$ 和 $S$ 的方差和协方差。\n\nSCM由以下公式给出：\n$$\nX = U_{x} \\\\\nY = \\alpha X + U_{y} \\\\\nS = \\gamma_{x} X + \\gamma_{y} Y + U_{s}\n$$\n扰动项 $U_x$、$U_y$ 和 $U_s$ 是相互独立、均值为零的高斯随机变量，其方差分别为 $\\sigma_{x}^{2}$、$\\sigma_{y}^{2}$ 和 $\\sigma_{s}^{2}$。由于扰动项的均值为零，所有可观测变量 $X$、$Y$ 和 $S$ 的均值也为零。这简化了协方差的计算，因为 $\\text{Cov}(A,B) = E[AB]$。\n\n首先，我们完全用外生扰动项来表示 $Y$ 和 $S$：\n$$\nY = \\alpha U_x + U_y\n$$\n$$\nS = \\gamma_x X + \\gamma_y (\\alpha X + U_y) + U_s = (\\gamma_x + \\alpha \\gamma_y)X + \\gamma_y U_y + U_s = (\\gamma_x + \\alpha \\gamma_y)U_x + \\gamma_y U_y + U_s\n$$\n现在，我们计算所需的二阶矩。\n1.  **$X$ 的方差**：\n    $$\n    \\text{Var}(X) = \\text{Var}(U_x) = \\sigma_x^2\n    $$\n2.  **$Y$ 和 $X$ 的协方差**：\n    $$\n    \\text{Cov}(Y, X) = E[YX] = E[(\\alpha X + U_y)X] = \\alpha E[X^2] + E[U_y X] = \\alpha \\text{Var}(X) + \\text{Cov}(U_y, U_x)\n    $$\n    因为 $U_y$ 和 $U_x$ 是独立的，所以 $\\text{Cov}(U_y, U_x) = 0$。\n    $$\n    \\text{Cov}(Y, X) = \\alpha \\sigma_x^2\n    $$\n3.  **$X$ 和 $S$ 的协方差**：\n    $$\n    \\text{Cov}(X, S) = E[XS] = E[U_x ((\\gamma_x + \\alpha \\gamma_y)U_x + \\gamma_y U_y + U_s)]\n    $$\n    $$\n    = (\\gamma_x + \\alpha \\gamma_y)E[U_x^2] + \\gamma_y E[U_x U_y] + E[U_x U_s]\n    $$\n    由于扰动项相互独立，$E[U_x U_y] = E[U_x U_s] = 0$。\n    $$\n    \\text{Cov}(X, S) = (\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2\n    $$\n4.  **$S$ 的方差**：\n    $$\n    \\text{Var}(S) = \\text{Var}((\\gamma_x + \\alpha \\gamma_y)U_x + \\gamma_y U_y + U_s)\n    $$\n    由于 $U_x, U_y, U_s$ 的独立性，和的方差等于方差的和：\n    $$\n    \\text{Var}(S) = (\\gamma_x + \\alpha \\gamma_y)^2 \\text{Var}(U_x) + \\gamma_y^2 \\text{Var}(U_y) + \\text{Var}(U_s)\n    $$\n    $$\n    = (\\gamma_x + \\alpha \\gamma_y)^2 \\sigma_x^2 + \\gamma_y^2 \\sigma_y^2 + \\sigma_s^2\n    $$\n5.  **$Y$ 和 $S$ 的协方差**：\n    $$\n    \\text{Cov}(Y, S) = E[YS] = E[(\\alpha U_x + U_y)((\\gamma_x + \\alpha \\gamma_y)U_x + \\gamma_y U_y + U_s)]\n    $$\n    展开并利用扰动项的独立性（只有包含扰动项平方的项才具有非零期望值）：\n    $$\n    \\text{Cov}(Y, S) = \\alpha(\\gamma_x + \\alpha \\gamma_y)E[U_x^2] + \\gamma_y E[U_y^2] = \\alpha(\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2 + \\gamma_y \\sigma_y^2\n    $$\n现在我们将这些结果代入 $\\beta_{Y.X\\mid S}$ 的公式中。\n分子是 $N = \\text{Cov}(Y, X) \\text{Var}(S) - \\text{Cov(Y, S)} \\text{Cov}(X, S)$：\n$$\nN = (\\alpha \\sigma_x^2) [(\\gamma_x + \\alpha \\gamma_y)^2 \\sigma_x^2 + \\gamma_y^2 \\sigma_y^2 + \\sigma_s^2] - [\\alpha(\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2 + \\gamma_y \\sigma_y^2] [(\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2]\n$$\n我们对各项进行分组。项 $(\\alpha \\sigma_x^2) (\\gamma_x + \\alpha \\gamma_y)^2 \\sigma_x^2$ 将与第二个大括号中的第一部分抵消：$\\alpha(\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2 \\times (\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2$。\n所以，我们剩下：\n$$\nN = \\alpha \\sigma_x^2 (\\gamma_y^2 \\sigma_y^2 + \\sigma_s^2) - (\\gamma_y \\sigma_y^2) [(\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2]\n$$\n$$\nN = \\alpha \\sigma_x^2 \\gamma_y^2 \\sigma_y^2 + \\alpha \\sigma_x^2 \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2 \\sigma_x^2 - \\alpha \\gamma_y^2 \\sigma_y^2 \\sigma_x^2\n$$\n第一项和第四项相互抵消，剩下：\n$$\nN = \\alpha \\sigma_x^2 \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2 \\sigma_x^2 = \\sigma_x^2 (\\alpha \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2)\n$$\n分母是 $D = \\text{Var}(X) \\text{Var}(S) - (\\text{Cov}(X, S))^2$：\n$$\nD = \\sigma_x^2 [(\\gamma_x + \\alpha \\gamma_y)^2 \\sigma_x^2 + \\gamma_y^2 \\sigma_y^2 + \\sigma_s^2] - [(\\gamma_x + \\alpha \\gamma_y)\\sigma_x^2]^2\n$$\n$$\nD = \\sigma_x^2 (\\gamma_x + \\alpha \\gamma_y)^2 \\sigma_x^2 + \\sigma_x^2(\\gamma_y^2 \\sigma_y^2 + \\sigma_s^2) - (\\gamma_x + \\alpha \\gamma_y)^2(\\sigma_x^2)^2\n$$\n第一项和第三项相互抵消，剩下：\n$$\nD = \\sigma_x^2 (\\gamma_y^2 \\sigma_y^2 + \\sigma_s^2)\n$$\n最后，我们计算比率 $\\beta_{Y.X\\mid S} = N/D$：\n$$\n\\beta_{Y.X\\mid S} = \\frac{\\sigma_x^2 (\\alpha \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2)}{\\sigma_x^2 (\\gamma_y^2 \\sigma_y^2 + \\sigma_s^2)}\n$$\n假设 $\\sigma_x^2 > 0$（否则 $X$ 是一个常数），我们可以消去此项：\n$$\n\\beta_{Y.X\\mid S} = \\frac{\\alpha \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2}{\\gamma_y^2 \\sigma_y^2 + \\sigma_s^2}\n$$\n这就是条件关联系数的闭式解析表达式。\n\n接下来，我们讨论 $\\beta_{Y.X\\mid S}$ 是否等于因果效应 $\\alpha$。从DAG结构 $X \\to Y$、$X \\to S$、$Y \\to S$ 中，我们看到 $S$ 是路径 $X \\to Y \\to S$ 上的一个对撞节点。根据d-分离的原理，对一个对撞节点（或其后代）进行条件化，会打开其父节点之间的一条非因果路径。在这里，对 $S$ 进行条件化会打开 $X$ 和 $Y$ 之间的一条虚假统计关联。因此，得到的关联 $\\beta_{Y.X\\mid S}$ 是来自路径 $X \\to Y$ 的真实因果效应与由打开的路径 $X \\to S \\leftarrow Y$ 所引入的偏倚的混合体。因此，一般情况下，$\\beta_{Y.X\\mid S} \\neq \\alpha$。这种现象被称为对撞偏倚或选择偏倚。\n\n为了找到等式成立的必要充分条件，我们令 $\\beta_{Y.X\\mid S} = \\alpha$：\n$$\n\\alpha = \\frac{\\alpha \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2}{\\gamma_y^2 \\sigma_y^2 + \\sigma_s^2}\n$$\n$$\n\\alpha (\\gamma_y^2 \\sigma_y^2 + \\sigma_s^2) = \\alpha \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2\n$$\n$$\n\\alpha \\gamma_y^2 \\sigma_y^2 + \\alpha \\sigma_s^2 = \\alpha \\sigma_s^2 - \\gamma_x \\gamma_y \\sigma_y^2\n$$\n$$\n\\alpha \\gamma_y^2 \\sigma_y^2 = - \\gamma_x \\gamma_y \\sigma_y^2\n$$\n$$\n\\alpha \\gamma_y^2 \\sigma_y^2 + \\gamma_x \\gamma_y \\sigma_y^2 = 0\n$$\n对表达式进行因式分解，得到必要充分条件：\n$$\n\\gamma_y \\sigma_y^2 (\\alpha \\gamma_y + \\gamma_x) = 0\n$$\n此条件成立当且仅当以下三个因子中至少有一个为零：\n1.  $\\gamma_y = 0$：路径 $Y \\to S$ 不存在。$S$ 不再是 $X$ 和 $Y$ 之间的对撞节点。对 $S$（$X$ 的一个子节点）进行条件化不会在 $X-Y$ 关系中引入偏倚。\n2.  $\\sigma_y^2 = 0$：扰动项 $U_y$ 的方差为零，这意味着 $Y = \\alpha X$ 是确定性的关系。独立于 $X$ 的 $Y$ 的变异来源被消除，从而移除了产生对撞偏倚的机制。\n3.  $\\alpha \\gamma_y + \\gamma_x = 0$：$X$ 对 $S$ 的效应由全导数 $\\frac{dS}{dX} = \\gamma_x + \\gamma_y \\frac{dY}{dX} = \\gamma_x + \\alpha \\gamma_y$ 给出。如果该值为零，则 $X$ 和 $S$ 不相关（$\\text{Cov}(X, S) = 0$）。对一个与 $X$ 不相关的变量 $S$ 进行条件化，不会对 $X$ 对 $Y$ 效应的估计引入偏倚。这对应于直接路径 $X \\to S$ 和间接路径 $X \\to Y \\to S$ 的效应发生了特定的抵消。", "answer": "$$\\boxed{\\frac{\\alpha \\sigma_{s}^{2} - \\gamma_{x} \\gamma_{y} \\sigma_{y}^{2}}{\\gamma_{y}^{2} \\sigma_{y}^{2} + \\sigma_{s}^{2}}}$$", "id": "4557806"}, {"introduction": "识别偏倚来源是因果推断的第一步，而我们的最终目标是准确估计因果效应。当存在“混杂偏倚”（confounding bias）时，我们不能直接从观测数据中得到因果结论，但可以利用有效的调整策略来纠正它。本练习将介绍一种核心的因果效应估计算法——g-computation（亦称标准化方法），它通过对一个有效的调整集（根据后门准则确定）进行加权平均，来模拟目标人群在接受特定干预后的结果。通过这个计算，你将掌握如何从观察性研究数据中估计干预措施的平均因果效应。[@problem_id:4557812]", "problem": "考虑一项关于激酶抑制剂的生物信息学和医学数据分析队列研究，其中治疗剂量由一个连续变量 $X$（对数剂量）表示，结果 $Y$ 是一个无量纲的标准化肿瘤生长指数，$Z$ 是一个基线合并症的二元指示变量（$Z=1$ 表示存在，$Z=0$ 表示不存在）。因果关系由一个有向无环图（DAG）描述：$Z \\rightarrow X$、$Z \\rightarrow Y$、$X \\rightarrow Y$ 以及 $X \\rightarrow M \\rightarrow Y$，其中 $M$ 是一个捕获由 $X$ 引起的下游信号通路的中介变量。假设根据后门准则，$Z$ 是 $X$ 对 $Y$ 因果效应的一个有效调整集，并且一致性、给定 $Z$ 下的条件可交换性和正值性这些标准识别条件均成立。\n\n以下统计摘要可从观测数据中合理获得：\n- $Z$ 的观测分布为 $\\mathbb{P}(Z=1)=\\frac{1}{3}$ 和 $\\mathbb{P}(Z=0)=\\frac{2}{3}$。\n- 条件期望结果模型（一个关于 $X$、$Z$ 及其交互作用的饱和线性模型，与 DAG 兼容且不以中介变量 $M$ 为条件）是\n$$\n\\mathbb{E}(Y\\mid X,Z)=\\theta_{0}+\\theta_{1}X+\\theta_{2}Z+\\theta_{3}XZ,\n$$\n参数值为 $\\theta_{0}=10$、$\\theta_{1}=2$、$\\theta_{2}=5$ 和 $\\theta_{3}=1$。\n\n从因果模型中 do 算子的核心定义和全期望定律出发，推导在干预 $X=x$ 下干预均值 $\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)$ 的 g-computation 估计量。然后，使用所提供的观测摘要，计算该估计量在 $x=2$ 时的值。将最终数值答案四舍五入到四位有效数字。从第一性原理出发，简要解释在无法进行随机实验的情况下，如何从观测数据中估计该估计量，并确保调整集中不包含任何中介变量，且识别条件得到满足。", "solution": "我们首先回顾在有向无环图（DAG）中识别因果效应所需的核心定义和假设。对于 $X$ 对 $Y$ 的因果效应，一个有效的调整集 $Z$ 满足后门准则，这意味着 $Z$ 阻断了所有从 $X$到 $Y$ 的后门路径，并且不包含 $X$ 的任何后代。在一致性、给定 $Z$ 下的条件可交换性和正值性这些识别条件下，$\\mathrm{do}(X=x)$ 下的干预分布可以通过 g-computation 公式进行识别，该公式基于 do 算子和全期望定律。具体来说，以 $Z$ 为条件足以消除混淆，从而得出干预均值：将给定 $X=x$ 时 $Y$ 的条件期望，对 $Z$ 的观测分布进行平均。\n\n形式上，在干预 $X=x$ 下，目标估计量（干预均值）推导如下。根据一致性，当 $X$ 被设为 $x$ 时，$Y^{x}$ 等于观测到的 $Y$。根据给定 $Z$ 下的条件可交换性，我们有 $Y^{x}\\perp\\!\\!\\!\\perp X\\mid Z$。正值性要求只要 $\\mathbb{P}(Z=z)>0$，就有 $\\mathbb{P}(X=x\\mid Z=z)>0$。将全期望定律应用于干预分布，我们得到\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)=\\int \\mathbb{E}\\big(Y\\mid X=x,Z=z\\big)\\, \\mathrm{d}F_{Z}(z),\n$$\n其中 $F_{Z}$ 表示 $Z$ 的观测分布。在 $Z$ 是离散变量的情况下，这简化为在 $Z$ 的支撑集上进行有限求和。\n\n给定所提供的模型，\n$$\n\\mathbb{E}(Y\\mid X,Z)=\\theta_{0}+\\theta_{1}X+\\theta_{2}Z+\\theta_{3}XZ,\n$$\n其中 $\\theta_{0}=10$、$\\theta_{1}=2$、$\\theta_{2}=5$ 和 $\\theta_{3}=1$，我们计算 g-computation 所需的条件期望：\n\n1. 对于 $Z=0$ 和 $X=x$，\n$$\n\\mathbb{E}(Y\\mid X=x,Z=0)=\\theta_{0}+\\theta_{1}x+\\theta_{2}\\cdot 0+\\theta_{3}\\cdot x\\cdot 0=10+2x.\n$$\n\n2. 对于 $Z=1$ 和 $X=x$，\n$$\n\\mathbb{E}(Y\\mid X=x,Z=1)=\\theta_{0}+\\theta_{1}x+\\theta_{2}\\cdot 1+\\theta_{3}\\cdot x\\cdot 1=10+2x+5+x=15+3x.\n$$\n\n$Z$ 的观测分布为 $\\mathbb{P}(Z=1)=\\frac{1}{3}$ 和 $\\mathbb{P}(Z=0)=\\frac{2}{3}$。因此，干预均值为\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)=\\mathbb{E}\\big(Y\\mid X=x,Z=0\\big)\\,\\mathbb{P}(Z=0)+\\mathbb{E}\\big(Y\\mid X=x,Z=1\\big)\\,\\mathbb{P}(Z=1).\n$$\n在 $x=2$ 处进行计算：\n- $\\mathbb{E}(Y\\mid X=2,Z=0)=10+2\\cdot 2=14$,\n- $\\mathbb{E}(Y\\mid X=2,Z=1)=15+3\\cdot 2=21$.\n\n因此，\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=2)\\big)=14\\cdot \\frac{2}{3}+21\\cdot \\frac{1}{3}=\\frac{28}{3}+\\frac{21}{3}=\\frac{49}{3}.\n$$\n保留四位有效数字，结果是\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=2)\\big)\\approx 16.33.\n$$\n\n我们现在解释如何从观测数据中估计该估计量。在以 $Z$ 为有效调整集的 DAG 下，并且识别假设得到满足，参数化 g-formula（g-computation）估计方法的过程是：首先从观测数据中对给定 $(X,Z)$ 时 $Y$ 的条件期望进行建模，然后在干预 $X=x$ 下，将模型预测的结果对 $Z$ 的经验分布进行标准化（即平均）。令 $\\hat{m}(x,z)$ 表示 $\\mathbb{E}(Y\\mid X=x,Z=z)$ 的一个估计，例如，可以通过使用指定模型进行线性回归得到，从而得出估计参数 $(\\hat{\\theta}_{0},\\hat{\\theta}_{1},\\hat{\\theta}_{2},\\hat{\\theta}_{3})$。给定一个独立同分布样本 $\\{(Y_{i},X_{i},Z_{i}):i=1,\\dots,n\\}$，干预均值的代入估计量为\n$$\n\\hat{\\psi}(x)=\\frac{1}{n}\\sum_{i=1}^{n}\\hat{m}(x,Z_{i}).\n$$\n该估计量是全期望定律应用于 $Z$ 的观测分布的样本模拟。关键是，我们不在调整集中以中介变量 $M$ 为条件，以避免因阻断部分因果路径而导致总效应产生偏倚。在 $\\mathbb{E}(Y\\mid X,Z)$ 的模型设定正确、一致性、给定 $Z$ 的条件可交换性和正值性成立的条件下，$\\hat{\\psi}(x)$ 是 $\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)$ 的一个相合估计量。在实践中，可以使用灵活的非参数模型或机器学习模型来估计 $\\hat{m}(x,z)$，并结合交叉拟合等技术，前提是遵守相同的识别条件，并使用 $Z$ 的经验分布进行标准化。最后，诊断分析应确认正值性，即对于观测到的 $Z=z$ 值，接近 $x$ 的处理水平在数据中有支撑，以确保外推有意义。", "answer": "$$\\boxed{16.33}$$", "id": "4557812"}]}