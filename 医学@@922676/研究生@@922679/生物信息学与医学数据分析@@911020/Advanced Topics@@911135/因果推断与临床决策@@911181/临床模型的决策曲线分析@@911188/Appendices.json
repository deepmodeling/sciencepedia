{"hands_on_practices": [{"introduction": "决策曲线分析的核心在于净获益（Net Benefit）这一指标。要真正理解一个模型在特定决策阈值下的临床价值，我们必须能够从基本原理出发，推导并计算其净获益。本练习将指导您完成这一过程，通过一个具体的临床场景，您将学会如何量化模型的价值，并将其与“治疗所有患者”和“不治疗任何患者”这两种基准策略进行比较，从而做出有据可依的判断。[@problem_id:4553187]", "problem": "一家医院正在评估是否使用风险预测模型对一种二元临床结局（例如，一年内发生严重不良事件）实施预防性治疗。该模型为每位患者生成校准后的概率，临床决策规则是，如果预测概率超过阈值概率 $p_t$，则对患者进行治疗。在决策曲线分析（Decision Curve Analysis, DCA）中，阈值概率 $p_t$ 被解释为治疗的预期临床获益等于治疗的预期临床危害时的概率，净获益以每位患者的真阳性等效值来量化。\n\n考虑一项包含 $N=1000$ 名患者的队列研究，其中 $P=300$ 名患者经金标准诊断确诊出现该结局。在阈值 $p_t=0.2$ 时，该模型将 $TP=220$ 名患者分类为真阳性，将 $FP=180$ 名患者分类为假阳性。假设基于以下决策理论基础：\n- 治疗一名真阳性患者的获益被归一化为 $1$ 个真阳性等效值。\n- 治疗一名假阳性患者的危害是一个常数 $w$ 个真阳性等效值。\n- 阈值概率 $p_t$ 由个体在边际上的预期获益与预期危害相等来定义：在 $p_t$ 处进行治疗的预期获益等于在 $p_t$ 处进行治疗的预期危害。\n\n从这些原则和定义出发，推导出一个在阈值 $p_t$ 处对预测为阳性的患者进行治疗的模型的净获益表达式，推导“全不治疗”和“全治疗”策略的净获益，并用它们来解释该模型在 $p_t=0.2$ 时对该队列是否增加了临床价值。然后，使用所提供的数据计算该模型在 $p_t=0.2$ 时的净获益。将模型的净获益的最终数值答案表示为小数，并四舍五入到四位有效数字。", "solution": "在进行解答之前，首先评估问题陈述的有效性。\n\n### 第1步：提取已知条件\n- 队列中患者总数，$N = 1000$。\n- 确诊出现该结局的患者数（患病数），$P = 300$。\n- 阈值概率，$p_t = 0.2$。\n- 在 $p_t$ 时的真阳性数，$TP = 220$。\n- 在 $p_t$ 时的假阳性数，$FP = 180$。\n- 治疗一名真阳性患者的获益为 $1$ 个真阳性等效值。\n- 治疗一名假阳性患者的危害为 $w$ 个真阳性等效值。\n- 阈值概率 $p_t$ 由个体在边际上的预期获益与预期危害相等来定义。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于决策曲线分析（DCA），这是一种在生物统计学和临床流行病学中用于评估和比较预测模型的成熟且标准的方法。所提供的关于净获益、阈值概率、真阳性和假阳性的定义与DCA的基础文献一致。\n2.  **问题定义明确**：该问题提供了推导所需表达式和计算最终数值所需的所有必要数据和定义。数据内部一致：$TP = 220 \\le P = 300$，且 $FP = 180 \\le (N-P) = 700$。存在唯一解。\n3.  **客观性**：问题以精确、定量且无偏见的语言陈述。\n\n### 第3步：结论与行动\n该问题科学合理、定义明确且客观。它不包含致命缺陷。因此，该问题是**有效的**。将推导解答。\n\n解答过程首先根据阈值概率 $p_t$ 的定义推导出危害权重 $w$。然后，推导净获益的一般表达式，以及参考策略“全治疗”和“全不治疗”的具体表达式。最后，使用这些表达式和所提供的数据来计算模型的净获益并解释其临床价值。\n\n1.  **危害权重 $w$ 的推导**：\n    问题陈述指出，在阈值概率 $p_t$ 处，治疗一个个体的预期获益等于治疗该个体的预期危害。对于一个结局的预测概率等于 $p_t$ 的个体患者，他们是真阳性（即，出现该结局）的概率是 $p_t$，他们是假阳性（即，不出现该结局）的概率是 $1 - p_t$。\n    - 预期获益 = (是真阳性的概率) $\\times$ (治疗真阳性的获益) = $p_t \\times 1$。\n    - 预期危害 = (是假阳性的概率) $\\times$ (治疗假阳性的危害) = $(1 - p_t) \\times w$。\n    令两者相等，得到关系式：\n    $$p_t = (1 - p_t)w$$\n    解出危害权重 $w$ 可得：\n    $$w = \\frac{p_t}{1 - p_t}$$\n\n2.  **净获益表达式的推导**：\n    净获益（Net benefit, NB）定义为总获益减去总危害，再对整个 $N$ 名患者的队列取平均值。\n    -   **对于预测模型**：一个建议对预测风险高于 $p_t$ 的患者进行治疗的模型，会识别出 $TP$ 个真阳性和 $FP$ 个假阳性。\n        -   总获益 = $TP \\times 1 = TP$。\n        -   总危害 = $FP \\times w$。\n        -   每位患者的净获益为：\n            $$NB_{\\text{model}} = \\frac{TP - FP \\cdot w}{N}$$\n            代入 $w$ 的表达式：\n            $$NB_{\\text{model}} = \\frac{TP}{N} - \\frac{FP}{N} \\left( \\frac{p_t}{1 - p_t} \\right)$$\n    -   **对于“全治疗”策略**：所有 $N$ 名患者都接受治疗。所有出现结局的 $P$ 名患者都是真阳性（$TP_{\\text{all}} = P$）。所有未出现结局的 $N-P$ 名患者都是假阳性（$FP_{\\text{all}} = N-P$）。\n        -   每位患者的净获益为：\n            $$NB_{\\text{all}} = \\frac{P - (N-P)w}{N} = \\frac{P}{N} - \\frac{N-P}{N}w$$\n            令 $\\pi = P/N$ 为队列中该结局的患病率。则：\n            $$NB_{\\text{all}} = \\pi - (1-\\pi)w = \\pi - (1-\\pi)\\left( \\frac{p_t}{1 - p_t} \\right)$$\n    -   **对于“全不治疗”策略**：没有患者接受治疗。因此，治疗带来的真阳性和假阳性均为零（$TP_{\\text{none}} = 0$, $FP_{\\text{none}} = 0$）。\n        -   净获益即为：\n            $$NB_{\\text{none}} = \\frac{0 - 0 \\cdot w}{N} = 0$$\n            该策略作为基线。一个模型只有当其净获益为正时才有用。\n\n3.  **临床价值的解释**：\n    如果一个预测模型在特定阈值 $p_t$ 下的净获益大于“全治疗”和“全不治疗”两种策略的净获益，则该模型具有临床价值。也就是说，模型更优的条件是：\n    $$NB_{\\text{model}}  NB_{\\text{all}} \\quad \\text{and} \\quad NB_{\\text{model}}  NB_{\\text{none}}$$\n\n4.  **针对给定队列的计算**：\n    首先，我们使用给定的阈值 $p_t = 0.2$ 计算危害权重 $w$ 的数值：\n    $$w = \\frac{0.2}{1 - 0.2} = \\frac{0.2}{0.8} = 0.25$$\n    现在，我们使用所提供的数据计算模型的净获益：$N = 1000$，$TP = 220$，以及 $FP = 180$。\n    $$NB_{\\text{model}} = \\frac{TP - FP \\cdot w}{N} = \\frac{220 - 180 \\times 0.25}{1000} = \\frac{220 - 45}{1000} = \\frac{175}{1000} = 0.175$$\n    接下来，我们计算“全治疗”策略的净获益。患病率为 $\\pi = P/N = 300/1000 = 0.3$。\n    $$NB_{\\text{all}} = \\pi - (1-\\pi)w = 0.3 - (1 - 0.3) \\times 0.25 = 0.3 - 0.7 \\times 0.25 = 0.3 - 0.175 = 0.125$$\n    “全不治疗”策略的净获益是 $NB_{\\text{none}} = 0$。\n    比较这些值：\n    $$NB_{\\text{model}} = 0.175$$\n    $$NB_{\\text{all}} = 0.125$$\n    $$NB_{\\text{none}} = 0$$\n    由于 $0.175 > 0.125$ 且 $0.175 > 0$，该模型的净获益大于两种参考策略的净获益。因此，在该队列中，模型在 $p_t = 0.2$ 的阈值下增加了临床价值。$0.175$ 的净获益可以解释为，相对于“全不治疗”的基线，该模型提供的获益相当于每1000名患者中识别出175名真阳性，而没有非选择性策略所带来的不必要治疗的危害。\n\n最后一个问题要求计算模型在 $p_t=0.2$ 时的净获益，并四舍五入到四位有效数字。\n计算值为 $0.175$。表示为四位有效数字，即为 $0.1750$。", "answer": "$$\\boxed{0.1750}$$", "id": "4553187"}, {"introduction": "在评估临床模型时，我们常常依赖受试者工作特征曲线下面积（AUC）等整体性指标。然而，一个更高的AUC值是否总能保证在特定临床情境下带来更大的净获益呢？本练习通过一个精心设计的思想实验，挑战了这一普遍认知。您将分析一个在低患病率人群中，AUC较低的模型反而可能具有更高临床实用性的案例，从而深刻理解为何决策曲线分析对于评估特定决策阈值下的模型效用是不可或缺的。[@problem_id:4553185]", "problem": "一个临床团队正在生物信息学和医疗数据分析领域，评估一个低患病率队列中用于二元结局的两个多变量风险模型。受试者工作特征（ROC）曲线下面积（AUC）量化了跨阈值的区分能力，而决策曲线分析则用于评估在特定阈值概率下的临床效用。假设一个队列的患病率 $\\pi = 0.05$，临床相关的阈值概率为 $p_t = 0.10$，在此阈值下，患者对于接受治疗和不接受治疗持无差别态度。在对应于 $p_t$ 的工作点上，模型 $M_1$ 的灵敏度为 $\\mathrm{Se}_1 = 0.70$，特异度为 $\\mathrm{Sp}_1 = 0.95$，受试者工作特征（ROC）曲线下面积（AUC）为 $\\text{AUC}_1 = 0.82$。模型 $M_2$ 在相同的 $p_t$ 下，灵敏度为 $\\mathrm{Se}_2 = 0.80$，特异度为 $\\mathrm{Sp}_2 = 0.90$，且 $\\text{AUC}_2 = 0.86$。设群体大小为 $N$，并假设在 $p_t$ 下的治疗或不治疗决策中，治疗对真阳性者产生固定的收益 $B$，对假阳性者产生固定的危害 $H$，而对真阴性者或假阴性者没有影响。\n\n从医疗决策中预期效用和阈值概率的基本定义出发，且不使用任何快捷公式，论述在 $p_t$ 下的净临床获益是如何确定的，以及它与 $\\pi$、$\\mathrm{Se}$、$\\mathrm{Sp}$ 和 $p_t$ 之间的关系。然后，根据所提供的情景，选择所有正确的陈述：\n\n- A. 对于任何患病率 $\\pi$ 和阈值概率 $p_t$，更高的受试者工作特征曲线下面积（AUC）意味着在 $p_t$ 下有更高的净获益。\n- B. 在低患病率 $\\pi$ 下， $p_t$ 处的特异度下降可能导致假阳性的影响占主导地位，因此灵敏度的增加不一定能增加净获益。\n- C. 决策曲线分析是针对特定阈值的；在 $p_t$ 下的净获益取决于所选工作点上的 $\\pi$、灵敏度、特异度和 $p_t$，因此仅凭 $\\text{AUC}$ 不足以保证净获益的增加。\n- D. 如果两个模型在 $p_t$ 下具有相同的灵敏度，但其中一个的特异度较低，则其净获益必然更高，因为它产生了更多的干预。\n\n选择正确的选项。", "solution": "在尝试解决问题之前，将首先验证问题陈述的科学合理性、自我一致性和清晰度。\n\n### 第1步：提取已知条件\n-   领域：生物信息学和医疗数据分析。\n-   主题：多变量风险模型的决策曲线分析（DCA）。\n-   结局：二元。\n-   队列：低患病率。\n-   病情患病率：$\\pi = 0.05$。\n-   临床相关阈值概率：$p_t = 0.10$。这是患者对接受治疗和不接受治疗持无差别态度的概率点。\n-   模型 $M_1$ 在对应于 $p_t$ 的工作点上的参数：\n    -   灵敏度：$\\mathrm{Se}_1 = 0.70$。\n    -   特异度：$\\mathrm{Sp}_1 = 0.95$。\n    -   ROC曲线下面积：$\\text{AUC}_1 = 0.82$。\n-   模型 $M_2$ 在对应于 $p_t$ 的工作点上的参数：\n    -   灵敏度：$\\mathrm{Se}_2 = 0.80$。\n    -   特异度：$\\mathrm{Sp}_2 = 0.90$。\n    -   ROC曲线下面积：$\\text{AUC}_2 = 0.86$。\n-   群体大小：$N$。\n-   治疗对真阳性者产生收益 $B$，对假阳性者产生危害 $H$。在决策背景下，对真阴性者或假阴性者没有效用影响。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题很好地基于医疗决策、风险预测建模和生物统计学的原理。患病率（$\\pi$）、灵敏度（$\\mathrm{Se}$）、特异度（$\\mathrm{Sp}$）、阈值概率（$p_t$）、AUC和净获益等概念是该领域的标准。决策曲线分析是由 Vickers 和 Elkin 引入的一种广泛接受的技术，用于评估预测模型的临床效用。$p_t$、收益（$B$）和危害（$H$）之间的关系是决策理论的基石。\n2.  **适定性**：该问题是适定的。它提供了足够的数据来计算每个模型的净获益，并对概念性陈述进行推理。问题清晰，要求从基本原理中得出结论，这是一个有效且结构化的任务。\n3.  **客观性**：该问题使用客观、技术性的语言陈述。参数是数值的，关系基于已建立的数学定义。\n4.  **未发现缺陷**：该问题没有违反任何基本原则，不是不完整或矛盾的，具有科学合理性，并且结构清晰。两个模型的数据呈现了一个灵敏度和特异度之间权衡的现实情景，这在模型比较中很常见。\n\n### 第3步：结论与行动\n问题陈述是**有效的**。将推导解答。\n\n### 净获益的推导与分析\n\n问题的核心是从第一性原理出发，理解和应用净获益的概念。\n\n**1. 基本定义**\n\n让我们考虑一个大小为 $N$ 的群体。\n患有该病症（疾病）的个体数量为 $N \\cdot \\pi$。\n未患该病症的个体数量为 $N \\cdot (1 - \\pi)$。\n\n一个模型建议对某些个体进行治疗。我们可以对结果进行分类：\n-   真阳性（TP）：被正确识别的患病个体。$\\text{TP}$ 的数量 = $(N \\cdot \\pi) \\cdot \\mathrm{Se}$。\n-   假阳性（FP）：被错误识别的未患病个体。$\\text{FP}$ 的数量 = $(N \\cdot (1 - \\pi)) \\cdot (1 - \\mathrm{Sp})$。\n\n问题陈述指出，治疗为每个TP带来收益 $B$，为每个FP带来危害 $H$。使用该模型的总效用是收益总和减去危害总和：\n$$ \\text{Total Utility}_{\\text{model}} = (\\text{Number of TP}) \\cdot B - (\\text{Number of FP}) \\cdot H $$\n\n净获益是将使用模型的效用与默认策略（“全部治疗”或“全部不治疗”）进行比较。\n-   全部治疗的效用：$(N \\cdot \\pi) \\cdot B - (N \\cdot (1 - \\pi)) \\cdot H$。\n-   全部不治疗的效用：$0$。\n\n阈值概率 $p_t$ 被定义为疾病的概率，在该概率下，治疗的预期收益等于预期危害，即无差别点。对于风险为 $p_t$ 的个体，治疗的预期效用为 $p_t \\cdot B - (1 - p_t) \\cdot H$。将其设为零（不治疗的效用）可得：\n$$ p_t \\cdot B = (1 - p_t) \\cdot H \\implies \\frac{H}{B} = \\frac{p_t}{1 - p_t} $$\n这个危害与收益的比率至关重要。\n\n如果“全部治疗”策略的效用为正，那么它就优于“全部不治疗”策略，这意味着 $\\pi \\cdot B  (1 - \\pi) \\cdot H$，或者 $\\frac{\\pi}{1-\\pi}  \\frac{H}{B}$。代入 $H/B$ 的表达式，这等价于 $\\frac{\\pi}{1-\\pi}  \\frac{p_t}{1 - p_t}$，简化后为 $\\pi  p_t$。\n\n在我们的情景中，$\\pi = 0.05$ 且 $p_t = 0.10$。由于 $\\pi  p_t$，“全部不治疗”的默认策略优于“全部治疗”。“全部不治疗”的效用为 $0$。因此，该模型的净效用是其相对于这个零基线的效用。\n\n净获益（NB）通常定义为每个人的净效用，通常通过收益单位 $B$ 进行缩放，使其独立于 $B$ 和 $H$ 的具体值，并以获得的真阳性单位来表示。\n$$ \\text{NB} = \\frac{\\text{Total Utility}_{\\text{model}}}{N \\cdot B} = \\frac{(N \\cdot \\pi \\cdot \\mathrm{Se}) \\cdot B - (N \\cdot (1 - \\pi) \\cdot (1 - \\mathrm{Sp})) \\cdot H}{N \\cdot B} $$\n$$ \\text{NB} = \\pi \\cdot \\mathrm{Se} - (1 - \\pi) \\cdot (1 - \\mathrm{Sp}) \\cdot \\frac{H}{B} $$\n代入危害-收益比的表达式：\n$$ \\text{NB} = \\pi \\cdot \\mathrm{Se} - (1 - \\pi) \\cdot (1 - \\mathrm{Sp}) \\cdot \\frac{p_t}{1 - p_t} $$\n这是在给定阈值 $p_t$ 下净获益的基本方程。它取决于患病率 $\\pi$、模型在由 $p_t$ 定义的工作点上的性能（$\\mathrm{Se}, \\mathrm{Sp}$）以及 $p_t$ 本身。\n\n**2. 针对特定情景的计算**\n\n已知：$\\pi = 0.05$, $p_t = 0.10$。\n危害-收益比值项为 $\\frac{p_t}{1 - p_t} = \\frac{0.10}{1 - 0.10} = \\frac{0.1}{0.9} = \\frac{1}{9}$。\n\n计算模型 $M_1$ 的净获益：\n$\\mathrm{Se}_1 = 0.70$, $\\mathrm{Sp}_1 = 0.95$.\n$$ \\text{NB}_1 = (0.05) \\cdot (0.70) - (1 - 0.05) \\cdot (1 - 0.95) \\cdot \\frac{1}{9} $$\n$$ \\text{NB}_1 = 0.035 - (0.95) \\cdot (0.05) \\cdot \\frac{1}{9} $$\n$$ \\text{NB}_1 = 0.035 - \\frac{0.0475}{9} \\approx 0.035 - 0.005278 = 0.029722 $$\n\n计算模型 $M_2$ 的净获益：\n$\\mathrm{Se}_2 = 0.80$, $\\mathrm{Sp}_2 = 0.90$.\n$$ \\text{NB}_2 = (0.05) \\cdot (0.80) - (1 - 0.05) \\cdot (1 - 0.90) \\cdot \\frac{1}{9} $$\n$$ \\text{NB}_2 = 0.040 - (0.95) \\cdot (0.10) \\cdot \\frac{1}{9} $$\n$$ \\text{NB}_2 = 0.040 - \\frac{0.095}{9} \\approx 0.040 - 0.010556 = 0.029444 $$\n\n我们的计算表明，尽管 $\\text{AUC}_1  \\text{AUC}_2$，但 $\\text{NB}_1  \\text{NB}_2$。\n\n### 逐项分析\n\n-   **A. 对于任何患病率 $\\pi$ 和阈值概率 $p_t$，更高的受试者工作特征曲线下面积（AUC）意味着在 $p_t$ 下有更高的净获益。**\n    这个陈述显然是错误的。我们对所提供情景的计算表明，模型 $M_2$ 具有更高的AUC（$\\text{AUC}_2 = 0.86  \\text{AUC}_1 = 0.82$），但在指定的阈值 $p_t = 0.10$ 下，其净获益却更低（$\\text{NB}_2 \\approx 0.0294  \\text{NB}_1 \\approx 0.0297$）。AUC 是衡量模型在所有可能阈值上平均区分能力的指标，而净获益是在单个特定阈值下衡量临床效用的指标。一个模型可能具有卓越的整体性能，但在某个具有临床意义的特定工作点上表现较差。\n    **结论：不正确。**\n\n-   **B. 在低患病率 $\\pi$ 下， $p_t$ 处的特异度下降可能导致假阳性的影响占主导地位，因此灵敏度的增加不一定能增加净获益。**\n    这个陈述在概念上是合理的，并由我们的数据所证实。从 $M_1$ 到 $M_2$，灵敏度增加（$\\mathrm{Se}_2  \\mathrm{Se}_1$），这增加了收益项 $\\pi \\cdot \\mathrm{Se}$。然而，特异度下降（$\\mathrm{Sp}_2  \\mathrm{Sp}_1$），这增加了假阳性率（$1-\\mathrm{Sp}$），从而增加了被减去的危害项 $(1 - \\pi) \\cdot (1 - \\mathrm{Sp}) \\cdot \\frac{p_t}{1 - p_t}$。在低患病率下，健康个体的数量（$N \\cdot (1-\\pi)$）远大于患病个体的数量（$N \\cdot \\pi$）。因此，危害项被一个大因子 $(1-\\pi)$ 缩放，使其对特异度的变化非常敏感。在我们的案例中，由更高灵敏度带来的收益增益被更低特异度造成的损失所抵消，导致 $M_2$ 的净获益较低。\n    **结论：正确。**\n\n-   **C. 决策曲线分析是针对特定阈值的；在 $p_t$ 下的净获益取决于所选工作点上的 $\\pi$、灵敏度、特异度和 $p_t$，因此仅凭 $\\text{AUC}$ 不足以保证净获益的增加。**\n    这个陈述准确地描述了决策曲线分析的目的和机制。正如所推导的，净获益的公式 $\\text{NB} = \\pi \\cdot \\mathrm{Se} - (1 - \\pi) \\cdot (1 - \\mathrm{Sp}) \\cdot \\frac{p_t}{1 - p_t}$ 是 $\\pi$、$\\mathrm{Se}$、$\\mathrm{Sp}$ 和 $p_t$ 的函数。它不是 AUC 的函数。AUC 总结了所有阈值的性能，而净获益则评估在特定、选定阈值下的效用。对于特定的临床应用，模型之间的选择取决于它们在临床相关阈值上的表现，而不仅仅是它们由 AUC 衡量的全局区分性能。我们对选项A的分析为这一原则提供了一个具体的例子。\n    **结论：正确。**\n\n-   **D. 如果两个模型在 $p_t$ 下具有相同的灵敏度，但其中一个的特异度较低，则其净获益必然更高，因为它产生了更多的干预。**\n    这个陈述的推理和结论都有缺陷。假设两个模型 $M_A$ 和 $M_B$ 具有相同的灵敏度 $\\mathrm{Se}_A = \\mathrm{Se}_B$。假设 $M_B$ 的特异度较低，即 $\\mathrm{Sp}_B  \\mathrm{Sp}_A$。净获益为 $\\text{NB} = \\pi \\cdot \\mathrm{Se} - (1 - \\pi) \\cdot (1 - \\mathrm{Sp}) \\cdot \\frac{p_t}{1 - p_t}$。由于 $\\mathrm{Se}$ 相同，第一项 $\\pi \\cdot \\mathrm{Se}$ 对两个模型来说是相同的。由于 $\\mathrm{Sp}_B  \\mathrm{Sp}_A$，因此 $(1 - \\mathrm{Sp}_B)  (1 - \\mathrm{Sp}_A)$。这使得模型 $M_B$ 的负向危害项更大。因此，$\\text{NB}_B  \\text{NB}_A$。特异度较低的模型确实会产生更多的干预（总阳性 = TP + FP），因为它错误地标记了更多的健康个体。然而，这些额外的干预都是假阳性，它们对净获益有负面贡献。因此，净获益更低，而不是更高。\n    **结论：不正确。**", "answer": "$$\\boxed{BC}$$", "id": "4553185"}, {"introduction": "任何基于有限样本数据计算出的统计量，都存在抽样不确定性，净获益也不例外。为了确保我们对模型临床效用的评估是稳健的，量化这种不确定性至关重要。本练习将引导您探索使用非参数自助法（nonparametric bootstrap）来估计净获益置信区间的过程。您将理解为何选择正确的重抽样单位——即保持患者预测概率与真实结局的配对——是保留数据内在依赖结构、从而获得可靠不确定性估计的关键。[@problem_id:4553170]", "problem": "您有一个临床风险预测模型，对于一个大小为 $n$ 的独立验证队列中的每位患者 $i \\in \\{1,\\dots,n\\}$，该模型会输出一个估计概率 $\\hat{p}_i \\in [0,1]$。设 $Y_i \\in \\{0,1\\}$ 表示观测结局，其中 $Y_i=1$ 表示事件发生，$Y_i=0$ 表示事件未发生。对于一个固定的阈值概率 $p_t \\in (0,1)$，决策规则是当且仅当 $\\hat{p}_i \\ge p_t$ 时进行治疗。决策曲线分析 (DCA) 通过净获益在 $p_t$ 处评估模型，净获益会奖励真阳性，并通过一个由 $p_t$ 隐含的权重来惩罚假阳性。设 $TP$ 和 $FP$ 分别表示在验证队列中，在该阈值规则下的真阳性和假阳性的计数。\n\n您的任务是选择一个选项，该选项正确描述了用于估计在固定阈值 $p_t$ 下净获益的抽样变异性（例如，置信区间）的非参数自助法程序，并正确解释了为什么这种重抽样方法能保持 $TP$ 和 $FP$ 之间的依赖结构。答案应基于基本原理：基于阈值的决策规则的定义，由该规则引出的样本计数 $TP$ 和 $FP$ 的定义，以及非参数自助法作为对观测单元进行有放回重抽样的定义。\n\n哪个选项是正确的？\n\nA. 对 n 个患者级别的数据对 $(Y_i,\\hat{p}_i)$ 进行有放回的重抽样，形成一个大小为 n 的自助样本，应用相同的阈值规则 $\\mathbb{1}(\\hat{p}_i \\ge p_t)$ 来计算 $TP^\\ast$ 和 $FP^\\ast$，然后计算在 $p_t$ 处的自助净获益。重复 B 次以获得自助分布并推导不确定性。这保持了 $TP$ 和 $FP$ 之间的依赖性，因为两者都是同一组重抽样观测单元的函数，因此它们的联合变异性源于 $(Y,\\hat{p})$ 的联合经验分布以及每个自助样本中共享的阈值规则。\n\nB. 首先一次性估计在 $p_t$ 处的灵敏度和假阳性率，然后独立地从 $TP^\\ast \\sim \\mathrm{Binomial}(n_1,\\widehat{\\mathrm{sens}})$ 和 $FP^\\ast \\sim \\mathrm{Binomial}(n_0,\\widehat{\\mathrm{fpr}})$ 中抽样，其中 $n_1$ 和 $n_0$ 是原始验证集中的病例和对照数量。使用这些值在 B 个模拟数据集中计算在 $p_t$ 处的净获益。这保持了依赖性，因为两次抽样都使用了相同的 $p_t$。\n\nC. 对结局 $\\{Y_i\\}$ 进行有放回重抽样得到 $\\{Y_i^\\ast\\}$，并独立地对预测概率 $\\{\\hat{p}_i\\}$ 进行有放回重抽样得到 $\\{\\hat{p}_i^\\ast\\}$，将它们随机配对成 n 个伪患者，然后在 B 个副本中计算在 $p_t$ 处的 $TP^\\ast$ 和 $FP^\\ast$。这保持了依赖性，因为任何观测到的 $\\hat{p}$ 与任何 $Y$ 配对的概率都相同。\n\nD. 从 $(0,1)$ 中均匀抽取 B 个阈值 $p_t^\\ast$，计算每个 $p_t^\\ast$ 处的净获益，然后将这些值的经验变异性作为原始固定 $p_t$ 处净获益的不确定性。依赖性得以保持，因为计数 $TP$ 和 $FP$ 都随 $p_t^\\ast$ 变化。\n\nE. 通过分别对 $n_1$ 个病例和 $n_0$ 个对照进行有放回抽样来执行分层自助法，以形成每个自助样本，保持 $n_1$ 和 $n_0$ 固定为其原始值，然后计算在 $p_t$ 处的净获益。这保持了 $TP$ 和 $FP$ 之间的依赖性，因为每个分层中的总数是固定的，因此更稳定。\n\n选择所有适用项。", "solution": "用户要求对问题陈述进行严格验证，然后从基本原理出发推导解决方案，并对所有提供的选项进行细致评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   一个临床风险预测模型为验证队列（大小为 $n$）中的每位患者 $i$ 生成一个估计概率 $\\hat{p}_i \\in [0,1]$。\n-   $Y_i \\in \\{0,1\\}$ 是患者 $i$ 的观测二元结局，其中 $Y_i=1$ 表示事件发生。\n-   一个固定的决策阈值为 $p_t \\in (0,1)$。\n-   决策规则是如果 $\\hat{p}_i \\ge p_t$ 则“治疗”。\n-   决策曲线分析 (DCA) 使用净获益指标在 $p_t$ 处评估模型。\n-   净获益奖励真阳性（$TP$）并根据 $p_t$ 决定的权重惩罚假阳性（$FP$）。$TP$ 和 $FP$ 是验证队列中的真阳性和假阳性计数。\n-   任务是选择一个选项，该选项正确描述了用于估计在 $p_t$ 处净获益抽样变异性的非参数自助法程序，并正确解释了如何保持 $TP$ 和 $FP$ 之间的依赖结构。\n-   推导必须基于决策规则、$TP$/$FP$ 计数以及非参数自助法（对观测单元进行有放回重抽样）的定义。\n\n**步骤2：使用已知条件进行验证**\n-   **科学基础：** 该问题牢固地植根于生物统计学和临床模型评估的既定原则。决策曲线分析和非参数自助法是标准且广泛使用的方法学。预测概率、结局、阈值、真阳性和假阳性的概念是分类模型评估的基础。该问题在科学上是合理的。\n-   **适定性：** 该问题是适定的。它要求对一个明确定义的统计量（固定阈值下的净获益）的特定统计程序（非参数自助法）给出正确描述，并对该程序的关键属性（保持依赖性）给出正确解释。必要的组成部分都已定义，并且可以从基本原理中推导出唯一、正确的程序。净获益的明确公式 $NB(p_t) = (TP/n) - (FP/n) \\cdot (p_t/(1-p_t))$ 并未给出，但评估重抽样*程序*本身并不需要它，而这正是问题的焦点。\n-   **客观性：** 问题陈述是客观的，使用了精确的技术语言，没有歧义或主观元素。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它在科学上合理、适定且客观。我将继续推导解决方案并评估各个选项。\n\n### 解题推导\n\n目标是估计在固定阈值 $p_t$ 下净获益（表示为 $NB(p_t)$）的抽样变异性。净获益是该阈值下真阳性 ($TP$) 和假阳性 ($FP$) 数量的函数。\n\n1.  **基本观测单元：** 验证队列中单个受试者的完整数据是数据对 $(Y_i, \\hat{p}_i)$，代表他们的真实结局和模型对该结局的预测概率。整个验证数据集是 $n$ 个此类数据对的样本，即 $\\{(Y_1, \\hat{p}_1), (Y_2, \\hat{p}_2), \\dots, (Y_n, \\hat{p}_n)\\}$。此样本代表从结果和预测的潜在真实总体分布中进行的一次抽样。\n\n2.  **目标统计量：** 对于给定的样本和固定的阈值 $p_t$，计数 $TP$ 和 $FP$ 计算如下：\n    $$TP = \\sum_{i=1}^n \\mathbb{1}(Y_i=1 \\text{ and } \\hat{p}_i \\ge p_t)$$\n    $$FP = \\sum_{i=1}^n \\mathbb{1}(Y_i=0 \\text{ and } \\hat{p}_i \\ge p_t)$$\n    净获益 $NB(p_t)$ 是这些计数的函数，即 $f(TP, FP)$。\n\n3.  **非参数自助法原理：** 非参数自助法通过模拟从真实总体中抽取样本的过程来近似统计量的抽样分布。它通过将观测样本视为总体分布的经验估计，并*从观测样本中*进行有放回抽样来实现这一点。这意味着我们重抽样的是基本的观测单元。\n\n4.  **应用于本问题：**\n    -   为了生成一个自助样本，我们从原始观测数据对集合 $\\{(Y_i, \\hat{p}_i)\\}_{i=1}^n$ 中有放回地抽取 $n$ 个数据对。将得到的自助样本表示为 $\\{(Y_j^\\ast, \\hat{p}_j^\\ast)\\}_{j=1}^n$。请注意，一些原始数据对可能会出现多次，而另一些则可能根本不出现。\n    -   对于这单个自助样本，我们重新计算目标统计量。我们将*相同的固定阈值* $p_t$ 应用于自助数据，以找到自助计数 $TP^\\ast$ 和 $FP^\\ast$：\n        $$TP^\\ast = \\sum_{j=1}^n \\mathbb{1}(Y_j^\\ast=1 \\text{ and } \\hat{p}_j^\\ast \\ge p_t)$$\n        $$FP^\\ast = \\sum_{j=1}^n \\mathbb{1}(Y_j^\\ast=0 \\text{ and } \\hat{p}_j^\\ast \\ge p_t)$$\n    -   然后计算自助净获益：$NB^\\ast(p_t) = f(TP^\\ast, FP^\\ast)$。\n    -   这个过程重复大量次数，例如 $B$ 次（例如 $B \\ge 1000$），以生成自助统计量的分布 $\\{NB_1^\\ast(p_t), \\dots, NB_B^\\ast(p_t)\\}$。该分布的离散程度（例如，其标准差或百分位数）提供了对原始统计量 $NB(p_t)$ 抽样变异性的估计。\n\n5.  **依赖结构的保持：** 计数 $TP$ 和 $FP$ 在统计上不是独立的。它们都源自同一组预测概率 $\\{\\hat{p}_i\\}$ 和相同的决策规则。任何影响 $\\hat{p}_i$ 值分布的患者抽样中的随机波动都会以相关的方式同时影响 $TP$ 和 $FP$。重抽样数据对 $(Y_i, \\hat{p}_i)$ 的自助法程序正确地保持了这种依赖性。在每次自助法重复中，数据对 $(Y_j^\\ast, \\hat{p}_j^\\ast)$ 保持完整，从而为每个观测单元保留了预测与结果之间的原始关联。由于 $TP^\\ast$ 和 $FP^\\ast$ 是从这个连贯重抽样的数据集计算得出的，它们的联合抽样行为得到了正确的传播。相关性之所以产生，是因为两个计数都是同一潜在随机自助样本的函数。\n\n### 逐项分析\n\n**A. 对 n 个患者级别的数据对 $(Y_i,\\hat{p}_i)$ 进行有放回的重抽样，形成一个大小为 n 的自助样本，应用相同的阈值规则 $\\mathbb{1}(\\hat{p}_i \\ge p_t)$ 来计算 $TP^\\ast$ 和 $FP^\\ast$，然后计算在 $p_t$ 处的自助净获益。重复 B 次以获得自助分布并推导不确定性。这保持了 $TP$ 和 $FP$ 之间的依赖性，因为两者都是同一组重抽样观测单元的函数，因此它们的联合变异性源于 $(Y,\\hat{p})$ 的联合经验分布以及每个自助样本中共享的阈值规则。**\n-   **评估：** 此选项完美地描述了从基本原理推导出的标准非参数自助法程序。它正确地将观测单元确定为 $(Y_i, \\hat{p}_i)$ 数据对，详细说明了重抽样过程，并指定了统计量的重新计算。关于保持依赖性的解释是精确和正确的：$TP^\\ast$ 和 $FP^\\ast$ 的联合变异性被自然地捕获，因为它们是在同一份连贯重抽样的数据上同时计算的。\n-   **结论：** **正确**。\n\n**B. 首先一次性估计在 $p_t$ 处的灵敏度和假阳性率，然后独立地从 $TP^\\ast \\sim \\mathrm{Binomial}(n_1,\\widehat{\\mathrm{sens}})$ 和 $FP^\\ast \\sim \\mathrm{Binomial}(n_0,\\widehat{\\mathrm{fpr}})$ 中抽样，其中 $n_1$ 和 $n_0$ 是原始验证集中的病例和对照数量。使用这些值在 B 个模拟数据集中计算在 $p_t$ 处的净获益。这保持了依赖性，因为两次抽样都使用了相同的 $p_t$。**\n-   **评估：** 这个程序是参数自助法的一种形式，而不是非参数的。关键在于，它涉及从**独立**的二项分布中抽取 $TP^\\ast$ 和 $FP^\\ast$。这个操作明确地切断了两者在现实中存在的抽样误差之间的相关性。声称使用相同的 $p_t$ 能保持依赖性的理由是错误的；使用 $p_t$ 定义了二项分布的参数，但并没有在两个独立的随机抽样之间引入相关性。\n-   **结论：** **不正确**。\n\n**C. 对结局 $\\{Y_i\\}$ 进行有放回重抽样得到 $\\{Y_i^\\ast\\}$，并独立地对预测概率 $\\{\\hat{p}_i\\}$ 进行有放回重抽样得到 $\\{\\hat{p}_i^\\ast\\}$，将它们随机配对成 n 个伪患者，然后在 B 个副本中计算在 $p_t$ 处的 $TP^\\ast$ 和 $FP^\\ast$。这保持了依赖性，因为任何观测到的 $\\hat{p}$ 与任何 $Y$ 配对的概率都相同。**\n-   **评估：** 该程序破坏了数据中的基本信息：患者预测风险与其真实结局之间的关联。通过独立地重抽样预测和结局，它创建了一个与模型无预测能力这一零假设相符的数据集。这是一个置换检验程序，而不是用于估计置信区间的自助法程序。在此背景下，所提供的解释是无稽之谈；随机配对主动消除了模型所依赖的依赖结构。\n-   **结论：** **不正确**。\n\n**D. 从 $(0,1)$ 中均匀抽取 B 个阈值 $p_t^\\ast$，计算每个 $p_t^\\ast$ 处的净获益，然后将这些值的经验变异性作为原始固定 $p_t$ 处净获益的不确定性。依赖性得以保持，因为计数 $TP$ 和 $FP$ 都随 $p_t^\\ast$ 变化。**\n-   **评估：** 该程序不估计抽样变异性。它分析的是模型在*单个、固定的原始样本*上，在一系列决策阈值下的性能。这是关于 $p_t$ 的敏感性分析，它产生的是决策曲线本身，而不是在*固定* $p_t$ 下净获益的置信区间。问题明确关注的是由有限样本量 n 引起的不确定性，而不是由阈值选择引起的变化。\n-   **结论：** **不正确**。\n\n**E. 通过分别对 $n_1$ 个病例和 $n_0$ 个对照进行有放回抽样来执行分层自助法，以形成每个自助样本，保持 $n_1$ 和 $n_0$ 固定为其原始值，然后计算在 $p_t$ 处的净获益。这保持了 $TP$ 和 $FP$ 之间的依赖性，因为每个分层中的总数是固定的，因此更稳定。**\n-   **评估：** 所描述的程序是非参数自助法的一个有效变体，称为分层自助法。它在保持每个分层（病例和对照）内 $(Y, \\hat{p})$ 关联的同时进行了适当的重抽样。然而，其关于为何能保持依赖性的解释是有缺陷的。依赖性之所以得以保持，是因为 $(Y, \\hat{p})$ 数据对保持关联，并且 $TP^\\ast$ 和 $FP^\\ast$ 是从单个连贯的自助样本中计算出来的。陈述“因为每个分层中的总数是固定的，因此更稳定”错误地归因了原因。固定的分层总数是分层法的一个特征，可以提高估计量的效率（减少方差），但这种稳定性并不是保持依赖结构的根本*原因*。原因与选项 A 相同：对患者级别数据的连贯重抽样。问题要求正确的描述和正确的解释。这里的解释既薄弱又具有误导性。\n-   **结论：** **不正确**。", "answer": "$$\\boxed{A}$$", "id": "4553170"}]}