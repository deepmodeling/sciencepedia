{"hands_on_practices": [{"introduction": "逆概率加权（IPW）是观察性研究中估计因果效应的基石方法之一。通过对样本进行加权，IPW旨在创建一个“伪人群”，在这个人群中，处理分配与测量的混杂因素无关，从而模拟随机对照试验的效果。通过推导IPW估计量的期望值[@problem_id:4545088]，我们可以从根本上理解，在满足所有核心假设（如倾向得分模型正确指定）的理想情况下，该方法为何能够无偏地估计平均处理效应（ATE），这为更复杂的应用奠定了理论基础。", "problem": "考虑一项生物信息学和医疗数据分析领域的观察性队列研究，该研究评估一个二元处理（表示为 $A \\in \\{0,1\\}$）对一个在处理后测量的连续生物标志物结局 $Y \\in \\mathbb{R}$ 的影响。每个受试者都有一组处理前的协变量 $X \\in \\mathbb{R}^{p}$，并且处理分配机制由真实倾向性得分 $e(X) = \\Pr(A=1 \\mid X)$ 描述。设潜在结局为 $Y(1)$ 和 $Y(0)$，并定义平均处理效应 (Average Treatment Effect, ATE) 为 $\\tau = \\mathbb{E}[Y(1) - Y(0)]$。假设以下标准可识别性条件成立：稳定单位处理值假设 (Stable Unit Treatment Value Assumption, SUTVA)、一致性 ($Y = A Y(1) + (1-A) Y(0)$)、条件可忽略性 ($(Y(1), Y(0)) \\perp A \\mid X$) 和正值性 ($0 < e(X) < 1$ 几乎必然成立)。您从该数据生成过程中观察到一个独立同分布的样本 $\\{(X_i, A_i, Y_i)\\}_{i=1}^{n}$。\n\n假设估计的倾向性得分 $\\hat{e}(X)$ 是正确设定的，因此 $\\hat{e}(X) = e(X)$ 几乎必然成立。将平均处理效应 (ATE) 的逆概率加权 (Inverse Probability Weighting, IPW) 估计量定义为\n$$\n\\hat{\\tau} \\;=\\; \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{A_i Y_i}{\\hat{e}(X_i)} \\;-\\; \\frac{(1 - A_i) Y_i}{1 - \\hat{e}(X_i)} \\right).\n$$\n在给定条件和 $\\hat{e}(X)$ 正确设定的情况下，推导其无条件期望 $\\mathbb{E}[\\hat{\\tau}]$。将您的最终答案表示为关于潜在结局的单个闭式解析表达式。无需四舍五入，也不涉及物理单位。", "solution": "首先根据所提供的信息评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **处理：**一个二元变量 $A \\in \\{0,1\\}$。\n- **结局：**一个连续生物标志物 $Y \\in \\mathbb{R}$。\n- **协变量：**一个处理前的协变量向量 $X \\in \\mathbb{R}^{p}$。\n- **真实倾向性得分：**$e(X) = \\Pr(A=1 \\mid X)$。\n- **潜在结局：**$Y(1)$ 和 $Y(0)$。\n- **平均处理效应 (ATE)：**$\\tau = \\mathbb{E}[Y(1) - Y(0)]$。\n- **可识别性假设：**\n    1.  稳定单位处理值假设 (SUTVA)。\n    2.  一致性：$Y = A Y(1) + (1-A) Y(0)$。\n    3.  条件可忽略性：$(Y(1), Y(0)) \\perp A \\mid X$。\n    4.  正值性：$0 < e(X) < 1$ 几乎必然成立。\n- **数据：**一个独立同分布 (i.i.d.) 样本 $\\{(X_i, A_i, Y_i)\\}_{i=1}^{n}$。\n- **估计量设定：**估计的倾向性得分是正确设定的，即 $\\hat{e}(X) = e(X)$ 几乎必然成立。\n- **估计量定义：**逆概率加权 (IPW) 估计量为 $\\hat{\\tau} = \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{A_i Y_i}{\\hat{e}(X_i)} - \\frac{(1 - A_i) Y_i}{1 - \\hat{e}(X_i)} \\right)$。\n- **目标：**推导无条件期望 $\\mathbb{E}[\\hat{\\tau}]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是因果推断领域的一个标准理论问题，而因果推断是生物统计学和生物信息学的核心领域。该问题是适定的，提供了所有必要的假设（SUTVA、一致性、可忽略性、正值性）以及一个正确设定的倾向性得分模型，这些是推导 IPW 估计量期望所需的充分条件。该问题是客观的，以精确的数学语言陈述。它没有违反任何基本原则，不是不完整或矛盾的，并且代表了该主题领域的一个基础性推导。条件 $\\hat{e}(X) = e(X)$ 是一个用于分析此类估计量偏差的标准简化假设，它代表了一个理想化但理论上重要的情景。\n\n### 步骤 3：结论与行动\n该问题有效。将提供一个完整的、有理有据的解答。\n\n### $\\mathbb{E}[\\hat{\\tau}]$ 的推导\n目标是计算 IPW 估计量的期望 $\\mathbb{E}[\\hat{\\tau}]$。\n该估计量由下式给出：\n$$\n\\hat{\\tau} = \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{A_i Y_i}{\\hat{e}(X_i)} - \\frac{(1 - A_i) Y_i}{1 - \\hat{e}(X_i)} \\right)\n$$\n根据倾向性得分模型被正确设定的假设，我们有 $\\hat{e}(X_i) = e(X_i)$。该估计量可以写成：\n$$\n\\hat{\\tau} = \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{A_i Y_i}{e(X_i)} - \\frac{(1 - A_i) Y_i}{1 - e(X_i)} \\right)\n$$\n根据期望的线性性质，我们有：\n$$\n\\mathbb{E}[\\hat{\\tau}] = \\mathbb{E}\\left[ \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\frac{A_i Y_i}{e(X_i)} - \\frac{(1 - A_i) Y_i}{1 - e(X_i)} \\right) \\right] = \\frac{1}{n} \\sum_{i=1}^{n} \\mathbb{E}\\left[ \\frac{A_i Y_i}{e(X_i)} - \\frac{(1 - A_i) Y_i}{1 - e(X_i)} \\right]\n$$\n由于观测值是独立同分布的，所以对所有的 $i$ 而言，其期望都是相同的。因此，我们可以去掉索引 $i$，分析单个观测值的期望：\n$$\n\\mathbb{E}[\\hat{\\tau}] = \\mathbb{E}\\left[ \\frac{A Y}{e(X)} - \\frac{(1 - A) Y}{1 - e(X)} \\right] = \\mathbb{E}\\left[ \\frac{A Y}{e(X)} \\right] - \\mathbb{E}\\left[ \\frac{(1 - A) Y}{1 - e(X)} \\right]\n$$\n我们将使用全期望定律 $\\mathbb{E}[Z] = \\mathbb{E}_X[\\mathbb{E}[Z \\mid X]]$ 分别计算这两项。\n\n对于第一项 $\\mathbb{E}\\left[ \\frac{A Y}{e(X)} \\right]$：\n$$\n\\mathbb{E}\\left[ \\frac{A Y}{e(X)} \\right] = \\mathbb{E}_X\\left[ \\mathbb{E}\\left[ \\frac{A Y}{e(X)} \\mid X \\right] \\right]\n$$\n在以 $X$ 为条件时，倾向性得分 $e(X)$ 是一个固定值。因此，\n$$\n\\mathbb{E}\\left[ \\frac{A Y}{e(X)} \\mid X \\right] = \\frac{1}{e(X)} \\mathbb{E}[A Y \\mid X]\n$$\n使用一致性假设 $Y = A Y(1) + (1-A) Y(0)$，我们可以写出 $AY = A(A Y(1) + (1-A) Y(0)) = A^2 Y(1) + A(1-A) Y(0)$。由于 $A$ 是二元的，$A^2 = A$ 且 $A(1-A) = 0$。因此可以简化为 $AY = AY(1)$。\n将此代入条件期望中：\n$$\n\\mathbb{E}[A Y \\mid X] = \\mathbb{E}[A Y(1) \\mid X]\n$$\n接下来，我们应用条件可忽略性假设 $(Y(1), Y(0)) \\perp A \\mid X$，这意味着在给定 $X$ 的条件下，$A$ 与 $Y(1)$ 独立。因此，我们可以分解期望：\n$$\n\\mathbb{E}[A Y(1) \\mid X] = \\mathbb{E}[A \\mid X] \\mathbb{E}[Y(1) \\mid X]\n$$\n根据定义，倾向性得分是 $e(X) = \\Pr(A=1 \\mid X) = \\mathbb{E}[A \\mid X]$。所以，\n$$\n\\mathbb{E}[A Y(1) \\mid X] = e(X) \\mathbb{E}[Y(1) \\mid X]\n$$\n将此结果代回第一项的条件期望表达式中：\n$$\n\\mathbb{E}\\left[ \\frac{A Y}{e(X)} \\mid X \\right] = \\frac{1}{e(X)} \\left( e(X) \\mathbb{E}[Y(1) \\mid X] \\right) = \\mathbb{E}[Y(1) \\mid X]\n$$\n对 $X$ 取外层期望：\n$$\n\\mathbb{E}_X\\left[ \\mathbb{E}[Y(1) \\mid X] \\right] = \\mathbb{E}[Y(1)]\n$$\n因此，第一项的结果为 $\\mathbb{E}[Y(1)]$。\n\n对于第二项 $-\\mathbb{E}\\left[ \\frac{(1 - A) Y}{1 - e(X)} \\right]$，过程是类似的：\n$$\n\\mathbb{E}\\left[ \\frac{(1 - A) Y}{1 - e(X)} \\right] = \\mathbb{E}_X\\left[ \\mathbb{E}\\left[ \\frac{(1 - A) Y}{1 - e(X)} \\mid X \\right] \\right] = \\mathbb{E}_X\\left[ \\frac{1}{1-e(X)} \\mathbb{E}[(1-A)Y \\mid X] \\right]\n$$\n使用一致性，$(1-A)Y = (1-A)(A Y(1) + (1-A) Y(0)) = (1-A)A Y(1) + (1-A)^2 Y(0)$。由于 $A$ 是二元的，此式简化为 $(1-A)Y = (1-A)Y(0)$。\n条件期望变为：\n$$\n\\mathbb{E}[(1-A)Y \\mid X] = \\mathbb{E}[(1-A)Y(0) \\mid X]\n$$\n使用条件可忽略性 $(Y(1), Y(0)) \\perp A \\mid X$，我们分解期望：\n$$\n\\mathbb{E}[(1-A)Y(0) \\mid X] = \\mathbb{E}[1-A \\mid X] \\mathbb{E}[Y(0) \\mid X]\n$$\n项 $\\mathbb{E}[1-A \\mid X] = 1 - \\mathbb{E}[A \\mid X] = 1 - e(X)$。所以，\n$$\n\\mathbb{E}[(1-A)Y(0) \\mid X] = (1 - e(X)) \\mathbb{E}[Y(0) \\mid X]\n$$\n将其代回：\n$$\n\\frac{1}{1-e(X)} \\mathbb{E}[(1-A)Y \\mid X] = \\frac{1}{1-e(X)} \\left( (1-e(X)) \\mathbb{E}[Y(0) \\mid X] \\right) = \\mathbb{E}[Y(0) \\mid X]\n$$\n对 $X$ 取外层期望：\n$$\n\\mathbb{E}_X\\left[ \\mathbb{E}[Y(0) \\mid X] \\right] = \\mathbb{E}[Y(0)]\n$$\n因此，第二项的结果为 $\\mathbb{E}[Y(0)]$。\n\n最后，合并两项的结果：\n$$\n\\mathbb{E}[\\hat{\\tau}] = \\mathbb{E}[Y(1)] - \\mathbb{E}[Y(0)]\n$$\n这个表达式就是平均处理效应 $\\tau$ 的定义。因此，在所述条件下，特别是当真实倾向性得分已知这个关键条件下，IPW 估计量是 ATE 的一个无偏估计量。\n\n最终答案是根据潜在结局推导出的估计量期望的表达式。", "answer": "$$\n\\boxed{\\mathbb{E}[Y(1)] - \\mathbb{E}[Y(0)]}\n$$", "id": "4545088"}, {"introduction": "在因果推断中，一个常见的误区是认为“控制的变量越多越好”。然而，调整不当的变量，特别是“对撞因子”（colliders），反而可能引入原本不存在的偏倚。这个问题[@problem_id:4145189]利用有向无环图（DAG）和功能性磁共振成像（fMRI）数据分析中的一个具体情景，生动地展示了这种被称为“M-偏倚”的现象，即对两个原因的共同结果进行条件化，会错误地在这两个原因之间产生统计关联。", "problem": "在一项关于静息态大脑活动的功能性磁共振成像 (fMRI) 研究中，考虑一个有向无环图 (DAG)，其中变量 $X$、$A$、$U$、$B$ 和 $Y$ 的排列方式为 $X \\to A \\leftarrow U \\to B \\to Y$。在这里，$X$ 表示根据帧间位移计算出的头部运动幅度，$U$ 表示未观测到的生理唤醒，$A$ 表示一个数据驱动的图像质量度量，它同时受到运动和唤醒的影响（例如，独立成分分析伪影成分），$B$ 表示受唤醒影响的全局信号回归量，$Y$ 表示在感兴趣的皮层区域内平均的血氧水平依赖 (BOLD) 信号。假设一个与该图一致的结构因果模型 (SCM)，其中每个节点都由一个线性结构方程生成，并带有相互独立的零均值高斯噪声：\n$$\nX = \\varepsilon_X,\\quad U = \\varepsilon_U,\\quad A = \\alpha_X X + \\alpha_U U + \\varepsilon_A,\\quad B = \\beta U + \\varepsilon_B,\\quad Y = \\gamma B + \\varepsilon_Y,\n$$\n其中所有噪声 $\\varepsilon_X,\\varepsilon_U,\\varepsilon_A,\\varepsilon_B,\\varepsilon_Y$ 都是相互独立的零均值高斯变量，且方差为有限正值。在 DAG 中，从 $X$到 $Y$ 没有直接的因果箭头。仅使用因果图模型的基本定义（例如，d-分离、对撞路径、后门准则）和线性高斯模型的成熟事实（例如，多变量正态分布中协方差和条件协方差的性质）来推断统计关联。\n\n在此设定下，以下哪些陈述是正确的？选择所有适用项。\n\nA. 在 $\\alpha_X=\\alpha_U=\\beta=\\gamma=1$ 且 $\\operatorname{Var}(\\varepsilon_X)=\\operatorname{Var}(\\varepsilon_U)=\\operatorname{Var}(\\varepsilon_A)=\\operatorname{Var}(\\varepsilon_B)=\\operatorname{Var}(\\varepsilon_Y)=1$ 的特殊情况下，$X$ 和 $Y$ 之间的边际协方差为 $0$，但在给定 $A$ 的条件下，$X$ 和 $Y$ 之间的协方差非零且为负。\n\nB. 以 $A$ 为条件会阻断 $X$ 和 $Y$ 之间的任何非因果路径，因此对 $A$ 进行调整会消除 $X$ 和 $Y$ 之间的伪关联。\n\nC. 以 $B$ 为条件（不以 $A$ 为条件）会打开一条 $X$ 和 $Y$ 之间的非因果路径，从而即使不存在直接效应，也会引入伪关联。\n\nD. 在 fMRI 伪影调整中，将 $A$ 作为无关回归量（nuisance regressor）纳入模型，可以通过一条经由 $U$ 和 $B$ 的被打开的路径，在运动回归量 $X$ 和神经结果 $Y$ 之间引入一种边际上不存在的关联。\n\nE. 要估计此 DAG 中 $X$ 对 $Y$ 的因果效应，一个有效的调整集是空集；对 $A$ 进行调整对偏倚有害，而对 $B$ 进行调整对于减少偏倚来说是不必要的。", "solution": "该问题陈述内部一致，其科学基础根植于 fMRI 数据分析和因果推断的原理，并且是适定的。所提供的有向无环图 (DAG) 和相应的线性结构因果模型 (SCM) 定义清晰，可以进行严格的数学和图形分析。因此，该问题是有效的。我们继续进行推导。\n\n问题的核心在于理解由给定因果图 $X \\to A \\leftarrow U \\to B \\to Y$ 所决定的头部运动 ($X$) 与局部 BOLD 信号 ($Y$) 之间的统计关联。$X$ 对 $Y$ 的真实因果效应为零，因为从 $X$到 $Y$ 没有有向路径。我们将在不同的条件设置下分析 $X$ 和 $Y$ 之间的统计关联（协方差）。\n\n首先，我们使用 d-分离的规则来分析 $X$ 和 $Y$ 之间的路径。$X$ 和 $Y$ 之间只有一条路径：$X \\to A \\leftarrow U \\to B \\to Y$。这是一条非因果路径。节点 $A$ 是这条路径上的一个对撞节点，因为它有两个指向它的箭头（$X \\to A$ 和 $U \\to A$）。\n根据 d-分离，如果一条路径包含一个不在条件集中的对撞节点，并且该对撞节点的任何后代也都不在条件集中，则该路径被阻断。\n\n我们再使用所提供的线性 SCM 进行数学分析：\n$$\nX = \\varepsilon_X,\\quad U = \\varepsilon_U,\\quad A = \\alpha_X X + \\alpha_U U + \\varepsilon_A,\\quad B = \\beta U + \\varepsilon_B,\\quad Y = \\gamma B + \\varepsilon_Y\n$$\n所有噪声项 $\\varepsilon_X, \\varepsilon_U, \\varepsilon_A, \\varepsilon_B, \\varepsilon_Y$ 都是相互独立的零均值高斯变量，具有有限的正方差，我们将其表示为 $\\sigma^2_V = \\operatorname{Var}(\\varepsilon_V)$，其中 $V \\in \\{X, U, A, B, Y\\}$。\n\n通过代入，我们可以用外生变量来表示 $Y$：\n$Y = \\gamma B + \\varepsilon_Y = \\gamma(\\beta U + \\varepsilon_B) + \\varepsilon_Y = \\gamma \\beta \\varepsilon_U + \\gamma \\varepsilon_B + \\varepsilon_Y$.\n注意 $X = \\varepsilon_X$ 且 $U = \\varepsilon_U$。\n\n**边际协方差, $\\operatorname{Cov}(X, Y)$**\n$X$ 和 $Y$ 之间的边际关联由它们的协方差给出。\n$$\n\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(\\varepsilon_X, \\gamma \\beta \\varepsilon_U + \\gamma \\varepsilon_B + \\varepsilon_Y)\n$$\n利用协方差的线性和所有噪声项的相互独立性：\n$$\n\\operatorname{Cov}(X, Y) = \\gamma \\beta \\operatorname{Cov}(\\varepsilon_X, \\varepsilon_U) + \\gamma \\operatorname{Cov}(\\varepsilon_X, \\varepsilon_B) + \\operatorname{Cov}(\\varepsilon_X, \\varepsilon_Y) = 0 + 0 + 0 = 0\n$$\n这与 d-分离一致：当我们不以任何变量为条件时，路径 $X \\to A \\leftarrow U \\to B \\to Y$ 被对撞节点 $A$ 阻断。因此，$X$ 和 $Y$ 是边际独立（且不相关）的。\n\n**条件协方差, $\\operatorname{Cov}(X, Y | A)$**\n以对撞节点 $A$ 为条件会打开 $X$ 和 $Y$ 之间的路径。在线性高斯模型中，条件协方差由 $\\operatorname{Cov}(X, Y | A) = \\operatorname{Cov}(X, Y) - \\frac{\\operatorname{Cov}(X, A)\\operatorname{Cov}(Y, A)}{\\operatorname{Var}(A)}$ 给出。由于 $\\operatorname{Cov}(X, Y)=0$，这可以简化为：\n$$\n\\operatorname{Cov}(X, Y | A) = - \\frac{\\operatorname{Cov}(X, A)\\operatorname{Cov}(Y, A)}{\\operatorname{Var}(A)}\n$$\n我们计算必要的项：\n- $\\operatorname{Cov}(X, A) = \\operatorname{Cov}(X, \\alpha_X X + \\alpha_U U + \\varepsilon_A) = \\alpha_X \\operatorname{Var}(X) = \\alpha_X \\sigma^2_X$.\n- $\\operatorname{Cov}(Y, A) = \\operatorname{Cov}(\\gamma\\beta U + \\gamma\\varepsilon_B + \\varepsilon_Y, \\alpha_X X + \\alpha_U U + \\varepsilon_A)$。由于噪声项的独立性，这简化为 $\\operatorname{Cov}(\\gamma\\beta U, \\alpha_U U) = \\gamma\\beta\\alpha_U \\operatorname{Var}(U) = \\gamma\\beta\\alpha_U \\sigma^2_U$。\n- $\\operatorname{Var}(A) = \\operatorname{Var}(\\alpha_X X + \\alpha_U U + \\varepsilon_A) = \\alpha_X^2 \\operatorname{Var}(X) + \\alpha_U^2 \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_A) = \\alpha_X^2 \\sigma^2_X + \\alpha_U^2 \\sigma^2_U + \\sigma^2_A$。\n\n将这些代入条件协方差的公式：\n$$\n\\operatorname{Cov}(X, Y | A) = - \\frac{(\\alpha_X \\sigma^2_X)(\\gamma\\beta\\alpha_U \\sigma^2_U)}{\\alpha_X^2 \\sigma^2_X + \\alpha_U^2 \\sigma^2_U + \\sigma^2_A} = - \\frac{\\alpha_X \\alpha_U \\beta \\gamma \\sigma^2_X \\sigma^2_U}{\\operatorname{Var}(A)}\n$$\n由于所有方差均为正，并且路径系数 $\\alpha_X, \\alpha_U, \\beta, \\gamma$ 隐含为非零（因为图中存在箭头），所以这个条件协方差是非零的。它的符号与路径系数的乘积 $\\alpha_X \\alpha_U \\beta \\gamma$ 的符号相反。\n\n**条件协方差, $\\operatorname{Cov}(X, Y | B)$**\n以 $B$ 为条件不会打开对撞路径，因为 $B$ 不是对撞节点 $A$，也不是 $A$ 的后代。从图上看，在给定 $B$ 的情况下，$X$ 和 $Y$ 被空集 d-分离。我们用计算来验证这一点：\n$$\n\\operatorname{Cov}(X, Y | B) = \\operatorname{Cov}(X, Y) - \\frac{\\operatorname{Cov}(X, B)\\operatorname{Cov}(Y, B)}{\\operatorname{Var}(B)}\n$$\n我们需要 $\\operatorname{Cov}(X, B)$：\n- $\\operatorname{Cov}(X, B) = \\operatorname{Cov}(X, \\beta U + \\varepsilon_B) = \\beta \\operatorname{Cov}(X, U) + \\operatorname{Cov}(X, \\varepsilon_B) = \\beta \\operatorname{Cov}(\\varepsilon_X, \\varepsilon_U) + \\operatorname{Cov}(\\varepsilon_X, \\varepsilon_B) = 0$。\n由于 $\\operatorname{Cov}(X, B)=0$ 且 $\\operatorname{Cov}(X, Y)=0$，整个表达式为零：\n$$\n\\operatorname{Cov}(X, Y | B) = 0 - \\frac{0 \\cdot \\operatorname{Cov}(Y, B)}{\\operatorname{Var}(B)} = 0\n$$\n以 $B$ 为条件不会引入 $X$ 和 $Y$ 之间的关联。\n\n现在我们评估每个陈述。\n\n**A. 在 $\\alpha_X=\\alpha_U=\\beta=\\gamma=1$ 且 $\\operatorname{Var}(\\varepsilon_X)=\\operatorname{Var}(\\varepsilon_U)=\\operatorname{Var}(\\varepsilon_A)=\\operatorname{Var}(\\varepsilon_B)=\\operatorname{Var}(\\varepsilon_Y)=1$ 的特殊情况下，$X$ 和 $Y$ 之间的边际协方差为 $0$，但在给定 $A$ 的条件下，$X$ 和 $Y$ 之间的协方差非零且为负。**\n- 如上文一般性推导，边际协方差 $\\operatorname{Cov}(X, Y)$ 确实为 $0$。\n- 让我们用给定的参数计算条件协方差 $\\operatorname{Cov}(X, Y | A)$：$\\alpha_X=1$, $\\alpha_U=1$, $\\beta=1$, $\\gamma=1$，且所有方差为 $1$。\n$$\n\\operatorname{Cov}(X, Y | A) = - \\frac{(1)(1)(1)(1)(1)(1)}{(1)^2(1) + (1)^2(1) + 1} = - \\frac{1}{1 + 1 + 1} = -\\frac{1}{3}\n$$\n这个值非零且为负。该陈述与我们的推导完全一致。\n**结论：正确。**\n\n**B. 以 $A$ 为条件会阻断 $X$ 和 $Y$ 之间的任何非因果路径，因此对 $A$ 进行调整会消除 $X$ 和 $Y$ 之间的伪关联。**\n这个陈述误解了对撞节点的规则。路径 $X \\to A \\leftarrow U \\to B \\to Y$ 是一条非因果路径。以对撞节点 $A$ 为条件会*打开*这条路径，而不是阻断它。这会在原本边际上不存在关联的地方引入伪关联。因此，对 $A$ 进行调整会*产生*伪关联，而不是消除伪关联。\n**结论：不正确。**\n\n**C. 以 $B$ 为条件（不以 $A$ 为条件）会打开一条 $X$ 和 $Y$ 之间的非因果路径，从而即使不存在直接效应，也会引入伪关联。**\n正如 d-分离逻辑和我们的协方差计算所显示的，以 $B$ 为条件不会打开对撞路径 $X \\to A \\leftarrow U \\to B \\to Y$。$B$ 不是对撞节点 $A$，也不是 $A$ 的后代。我们计算出 $\\operatorname{Cov}(X, Y | B) = 0$。因此，以 $B$ 为条件不会引入关联。\n**结论：不正确。**\n\n**D. 在 fMRI 伪影调整中，将 $A$ 作为无关回归量（nuisance regressor）纳入模型，可以通过一条经由 $U$ 和 $B$ 的被打开的路径，在运动回归量 $X$ 和神经结果 $Y$ 之间引入一种边际上不存在的关联。**\n这个陈述准确地描述了在指定情境下的对撞偏倚现象。\n- “将 $A$ 作为无关回归量纳入模型”意味着以 $A$ 为条件。\n- “引入一种...边际上不存在的关联”：我们证明了 $\\operatorname{Cov}(X, Y | A) \\neq 0$ 而 $\\operatorname{Cov}(X, Y) = 0$。这是正确的。\n- “通过一条经由 $U$ 和 $B$ 的被打开的路径”：以 $A$ 为条件所打开的路径正是 $X \\to A \\leftarrow U \\to B \\to Y$，它通过未观测到的唤醒 $U$ 和全局信号 $B$ 连接了 $X$ 和 $Y$。该陈述是对我们发现的正确定性描述。\n**结论：正确。**\n\n**E. 要估计此 DAG 中 $X$ 对 $Y$ 的因果效应，一个有效的调整集是空集；对 $A$ 进行调整对偏倚有害，而对 $B$ 进行调整对于减少偏倚来说是不必要的。**\n要估计 $X$ 对 $Y$ 的因果效应，我们必须阻断所有非因果的“后门”路径。后门路径是一条连接 $X$ 和 $Y$ 且以指向 $X$ 的箭头开始的路径。在此 DAG 中，$X$ 是一个外生变量（$X = \\varepsilon_X$），所以没有指向 $X$ 的箭头。因此，不存在后门路径。\n- “一个有效的调整集是空集”：后门准则要求阻断所有后门路径。由于不存在后门路径，空集 $\\emptyset$ 是一个有效的调整集。从边际关联（即 $Y$ 对 $X$ 的回归）来估计效应是无偏的。回归系数将与 $\\operatorname{Cov}(X,Y) = 0$ 成正比，正确地识别出零因果效应。\n- “对 $A$ 进行调整对偏倚有害”：如前所示，对对撞节点 $A$ 进行调整会引入一个非零关联 $\\operatorname{Cov}(X, Y | A) \\neq 0$。这会导致 $X$ 的回归系数非零，这是对真实零因果效应的有偏估计。因此，它是有害的。\n- “对 $B$ 进行调整对于减少偏倚来说是不必要的”：由于未经调整的估计已经是无偏的，因此不需要进行任何调整。对 $B$ 进行调整仍然会得到无偏估计，因为 $\\operatorname{Cov}(X, Y | B) = 0$，但这对减少偏倚来说不是必需的。该陈述是正确的。\n**结论：正确。**", "answer": "$$\\boxed{ADE}$$", "id": "4145189"}, {"introduction": "尽管我们可以通过调整来控制已测量的混杂因素，但未测量的混杂始终是观察性研究的Achilles之踵。在报告一个关联是否可能是因果关系时，我们必须回答一个关键问题：“一个未知的混杂因素需要多强才能完全‘解释掉’我们观察到的效应？” E值（E-value）[@problem_id:4545130]为此提供了一个标准化的敏感性分析工具，通过计算使观察到的关联归于无效（即真实因果风险比为1）所需的最小混杂强度，它帮助研究者和读者量化结果对潜在未知偏倚的稳健性。", "problem": "一项医学数据分析中的观察性队列研究检验了某个二元基因组暴露（用 $A \\in \\{0,1\\}$ 表示，代表来自全外显子组测序的高基线肿瘤突变负荷）是否影响发生严重免疫相关不良事件（用 $Y \\in \\{0,1\\}$ 表示）的1年风险。令 $C$ 表示一个已测量的基线协变量向量。假设感兴趣的因果估计量是因果风险比，根据潜在结局定义为在对 $A$ 进行假设性干预下的边际风险之比，即 $\\mathrm{RR}^{\\text{true}} = \\frac{\\Pr(Y^{1}=1)}{\\Pr(Y^{0}=1)}$，其中 $Y^{a}$ 表示在干预设定 $A=a$ 下的反事实结局。\n\n一位研究者在控制了 $C$ 后，报告了风险比的经协变量调整的观察性点估计值为 $\\mathrm{RR}^{\\text{obs}} = 1.8$。考虑存在一个未测量的基线混杂因素 $U \\in \\{0,1\\}$ 的可能性，该因素仅在 $(C,U)$ 条件下与 $A$ 独立，并且可能与 $A$ 和 $Y$ 都有关联。\n\n仅使用因果效应的基本定义和针对单一未测量二元混杂因素的风险比尺度上已建立的敏感性-偏倚界限框架，完成以下任务：\n\n- 精确定义通常称为风险比估计量的E值的量，其定义为：在与观察到的 $\\mathrm{RR}^{\\text{obs}}$ 一致的情况下，一个未测量的混杂因素 $U$ 与 $A$ 以及与 $Y$ (在 $A$ 和 $C$ 条件下) 的关联在风险比尺度上的最小共同强度，该强度足以将因果风险比 $\\mathrm{RR}^{\\text{true}}$ 降至 $1$。\n- 根据偏倚因子分解和风险比尺度上界定的基本原理，针对一个泛化的观察风险比 $\\mathrm{RR}^{\\text{obs}} \\ge 1$，推导此E值的闭式表达式。\n- 计算给定观察估计值 $\\mathrm{RR}^{\\text{obs}} = 1.8$ 的E值。\n\n将计算出的E值作为单个无单位的实数提供最终数值答案。如果需要四舍五入，将最终答案保留四位有效数字；如果有精确值，则报告精确值。", "solution": "所述问题具有科学依据，提法明确且客观，处于因果推断中已建立的潜在结局框架和为其发展的敏感性分析方法之内。因此，该问题是有效的，并允许进行严谨的求解。\n\n该问题要求分三部分作答：E值的精确定义、从基本原理出发的推导，以及针对给定数据的计算。\n\n### 1. E值的定义\n\n令 $A$ 为二元暴露，$Y$ 为二元结局，$C$ 为一组已测量的协变量。经 $C$ 调整的观察风险比记为 $\\mathrm{RR}^{\\text{obs}}$。真实的因果风险比为 $\\mathrm{RR}^{\\text{true}} = \\frac{\\Pr(Y^1=1)}{\\Pr(Y^0=1)}$。令 $U$ 为单一未测量的二元混杂因素。为便于推导，我们考虑 $C$ 的单个分层，并为简化符号，我们在表达式中省略 $C$，默认所有概率都是以 $C$ 为条件的。\n\n未测量混杂因素 $U$ 和暴露 $A$ 之间的关联强度由风险比 $\\mathrm{RR}_{AU}$ 参数化，其定义为在协变量 $C$ 的所有分层中 $\\frac{\\Pr(A=1|U=1)}{\\Pr(A=1|U=0)}$ 和 $\\frac{\\Pr(A=0|U=1)}{\\Pr(A=0|U=0)}$ 的最大值。不失一般性，令 $U$ 的编码方式使得该风险比 $\\ge 1$。\n\n在给定 $A$ 的条件下，未测量混杂因素 $U$ 和结局 $Y$ 之间的关联强度由风险比 $\\mathrm{RR}_{UY}$ 参数化。其定义为 $\\mathrm{RR}_{UY} = \\max_{a} \\frac{\\Pr(Y=1|A=a, U=1)}{\\Pr(Y=1|A=a, U=0)}$，其中最大值取自 $a \\in \\{0,1\\}$ 和 $C$ 的所有分层。\n\n未测量的混杂因素 $U$ 会引入偏倚，导致 $\\mathrm{RR}^{\\text{obs}}$ 与 $\\mathrm{RR}^{\\text{true}}$ 不同。E值被定义为混杂因素 $U$ 必须同时与暴露 $A$ 和结局 $Y$ 具有的最小共同关联强度 $E$（即 $\\mathrm{RR}_{AU} \\ge E$ 和 $\\mathrm{RR}_{UY} \\ge E$），才能潜在地“解释掉”观察到的关联。“解释掉”意味着观察到的关联 $\\mathrm{RR}^{\\text{obs}}$ 与真实因果风险比 $\\mathrm{RR}^{\\text{true}}$ 为 $1$ 的情况相符。\n\n形式上，对于一个观察风险比 $\\mathrm{RR}^{\\text{obs}} \\ge 1$，E值是这样一个值 $E$，如果 $\\mathrm{RR}_{AU} < E$ 或 $\\mathrm{RR}_{UY} < E$，那么仅凭 $U$ 不可能解释观察到的关联（即 $\\mathrm{RR}^{\\text{true}}$ 必须大于 $1$）。它是这样一个最小值 $E$，对于这个值，可能存在一个未测量的混杂因素 $U$，其 $\\mathrm{RR}_{AU} = E$ 且 $\\mathrm{RR}_{UY} = E$，能够将估计值移动到零效应或穿过零效应，从而使得 $\\mathrm{RR}^{\\text{true}}=1$ 成为可能。\n\n### 2. 从基本原理推导E值公式\n\n观察风险比和真实因果风险比之间的关系可以表示为 $\\mathrm{RR}^{\\text{obs}} = \\mathrm{RR}^{\\text{true}} \\times B$，其中 $B$ 是由未测量混杂因素 $U$ 引起的偏倚因子。要解释掉观察到的效应，即允许 $\\mathrm{RR}^{\\text{true}}=1$ 的可能性，偏倚因子必须至少与观察风险比一样大，即 $B \\ge \\mathrm{RR}^{\\text{obs}}$。我们的目标是对于给定的 $\\mathrm{RR}_{AU}$ 和 $\\mathrm{RR}_{UY}$ 值，找到可能的最大偏倚因子 $B_{\\max}$。\n\n假设在给定 $(C,U)$ 的条件下满足一致性和条件可交换性，我们可以通过对 $U$ 进行边缘化来写出暴露水平 $a$ 的观察结局概率：\n$$ \\Pr(Y=1|A=a) = \\Pr(Y=1|A=a, U=0)\\Pr(U=0|A=a) + \\Pr(Y=1|A=a, U=1)\\Pr(U=1|A=a) $$\n使用定义 $\\mathrm{RR}_{UY} = \\frac{\\Pr(Y=1|A=a, U=1)}{\\Pr(Y=1|A=a, U=0)}$（为简化推导，假设其在不同 $a$ 之间是恒定的），我们有：\n$$ \\Pr(Y=1|A=a) = \\Pr(Y=1|A=a, U=0) \\left[ \\Pr(U=0|A=a) + \\mathrm{RR}_{UY} \\Pr(U=1|A=a) \\right] $$\n观察风险比是这些概率在 $a=1$ 和 $a=0$ 时的比值：\n$$ \\mathrm{RR}^{\\text{obs}} = \\frac{\\Pr(Y=1|A=1)}{\\Pr(Y=1|A=0)} = \\frac{\\Pr(Y=1|A=1, U=0)}{\\Pr(Y=1|A=0, U=0)} \\times \\frac{\\Pr(U=0|A=1) + \\mathrm{RR}_{UY} \\Pr(U=1|A=1)}{\\Pr(U=0|A=0) + \\mathrm{RR}_{UY} \\Pr(U=1|A=0)} $$\n等式右边的第一项是在 $U=0$ 条件下的真实因果风险比，在假定 $U$ 不对风险比（RR）产生效应修饰的情况下，该项等于边际因果风险比 $\\mathrm{RR}^{\\text{true}}$。第二项是偏倚因子 $B$。\n$$ B = \\frac{1 - p_1 + \\mathrm{RR}_{UY} p_1}{1 - p_0 + \\mathrm{RR}_{UY} p_0} $$\n其中 $p_a = \\Pr(U=1|A=a)$。现在，我们用 $\\mathrm{RR}_{AU}$ 来重新参数化。一种能给出最紧界（sharpest bound）的常用参数化方法，将暴露-混杂因素关联定义为患病率比 $\\mathrm{RR}_{AU} = \\frac{\\Pr(U=1|A=1)}{\\Pr(U=1|A=0)} = \\frac{p_1}{p_0}$。这意味着 $p_1 = p_0 \\mathrm{RR}_{AU}$。$p_0$ 的值是未知的。为了找到最大偏倚，我们在 $p_0$ 的可能范围内最大化 $B$。约束条件 $p_1 \\le 1$ 意味着 $p_0 \\mathrm{RR}_{AU} \\le 1$，所以 $p_0 \\in [0, 1/\\mathrm{RR}_{AU}]$。\n$B$ 对 $p_0$ 的导数的分子与 $(\\mathrm{RR}_{AU}-1)(\\mathrm{RR}_{UY}-1)$ 成正比。由于 $\\mathrm{RR}_{AU} \\ge 1$ 且 $\\mathrm{RR}_{UY} \\ge 1$，该导数是非负的，所以 $B$ 是 $p_0$ 的一个非递减函数。$B$ 的最大值在 $p_0$ 的最大可能值处取得，即 $p_0 = 1/\\mathrm{RR}_{AU}$。此时，$p_1 = 1$。\n将 $p_0=1/\\mathrm{RR}_{AU}$ 和 $p_1=1$ 代入 $B$ 的表达式，得到最大偏倚因子：\n$$ B_{\\max} = \\frac{1 - 1 + \\mathrm{RR}_{UY} (1)}{1 - 1/\\mathrm{RR}_{AU} + \\mathrm{RR}_{UY} (1/\\mathrm{RR}_{AU})} = \\frac{\\mathrm{RR}_{UY}}{( \\mathrm{RR}_{AU} - 1 + \\mathrm{RR}_{UY} ) / \\mathrm{RR}_{AU}} = \\frac{\\mathrm{RR}_{AU} \\mathrm{RR}_{UY}}{\\mathrm{RR}_{AU} + \\mathrm{RR}_{UY} - 1} $$\n为了让一个未测量的混杂因素解释观察到的关联，这个最大偏倚必须等于或大于观察风险比，即 $B_{\\max} \\ge \\mathrm{RR}^{\\text{obs}}$。E值 $E$ 是通过设定 $\\mathrm{RR}_{AU} = \\mathrm{RR}_{UY} = E$ 并求解边界条件 $B_{\\max} = \\mathrm{RR}^{\\text{obs}}$ 得到的：\n$$ \\mathrm{RR}^{\\text{obs}} = \\frac{E \\cdot E}{E + E - 1} = \\frac{E^2}{2E - 1} $$\n这导出了一个关于 $E$ 的二次方程：\n$$ E^2 = \\mathrm{RR}^{\\text{obs}}(2E - 1) $$\n$$ E^2 - 2E(\\mathrm{RR}^{\\text{obs}}) + \\mathrm{RR}^{\\text{obs}} = 0 $$\n使用二次方程求根公式 $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a=1$, $b=-2\\mathrm{RR}^{\\text{obs}}$, $c=\\mathrm{RR}^{\\text{obs}}$：\n$$ E = \\frac{2\\mathrm{RR}^{\\text{obs}} \\pm \\sqrt{(-2\\mathrm{RR}^{\\text{obs}})^2 - 4(1)(\\mathrm{RR}^{\\text{obs}})}}{2} $$\n$$ E = \\frac{2\\mathrm{RR}^{\\text{obs}} \\pm \\sqrt{4(\\mathrm{RR}^{\\text{obs}})^2 - 4\\mathrm{RR}^{\\text{obs}}}}{2} $$\n$$ E = \\mathrm{RR}^{\\text{obs}} \\pm \\sqrt{(\\mathrm{RR}^{\\text{obs}})^2 - \\mathrm{RR}^{\\text{obs}}} $$\n根据定义，一个代表正向关联的风险比参数，例如E值，必须大于或等于 $1$。对于 $\\mathrm{RR}^{\\text{obs}} > 1$，较小的根 $\\mathrm{RR}^{\\text{obs}} - \\sqrt{(\\mathrm{RR}^{\\text{obs}})^2 - \\mathrm{RR}^{\\text{obs}}}$ 小于 $1$。因此，对于E值，唯一具有物理意义的解是较大的根。\nE值的最终闭式表达式为：\n$$ E = \\mathrm{RR}^{\\text{obs}} + \\sqrt{\\mathrm{RR}^{\\text{obs}} (\\mathrm{RR}^{\\text{obs}} - 1)} $$\n\n### 3. 对给定观察估计值的计算\n\n问题提供了观察风险比为 $\\mathrm{RR}^{\\text{obs}} = 1.8$。我们将此值代入推导出的公式中：\n$$ E = 1.8 + \\sqrt{1.8 \\times (1.8 - 1)} $$\n$$ E = 1.8 + \\sqrt{1.8 \\times 0.8} $$\n$$ E = 1.8 + \\sqrt{1.44} $$\n$1.44$ 的平方根是 $1.2$。\n$$ E = 1.8 + 1.2 = 3.0 $$\n计算出的E值恰好为 $3.0$。这意味着，一个未测量的混杂因素，如果它与基因组暴露以及与不良事件的关联强度（在已测量协变量 $C$ 的条件下）的风险比均为 $3.0$，就足以解释掉观察到的 $1.8$ 的风险比。反之，如果没有未测量的混杂因素与暴露和结局同时具有如此强的关联，那么真实的因果风险比很可能大于 $1$。", "answer": "$$\\boxed{3}$$", "id": "4545130"}]}