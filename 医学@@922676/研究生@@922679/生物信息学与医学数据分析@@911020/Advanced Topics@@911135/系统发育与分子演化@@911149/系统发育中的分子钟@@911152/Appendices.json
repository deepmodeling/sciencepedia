{"hands_on_practices": [{"introduction": "第一个实践练习将我们的理解建立在分子钟的基本原理之上。您将使用 Jukes-Cantor (JC69) 模型，从第一性原理出发推导分化时间，将两个序列之间可观察到的差异比例与严格分子钟假设下的时间联系起来。这项练习巩固了作为所有分子定年方法基础的核心数学关系。[@problem_id:4586166]", "problem": "在一项临床病毒基因组学研究中，对两个独立采样的甲型流感病毒血凝素编码序列进行了比对。比对区域足够长，因此观测差异中的抽样噪声可以忽略不计。两条比对序列之间观测到的核苷酸差异比例（未校正的汉明距离）为 $p = 0.015$。先前基于定年样本的分子钟分析表明，两个子代谱系合并计算的每个位点的成对替换累积速率为 $r = 2.4 \\times 10^{-3}$ 个替换/位点/年。\n\n假设核苷酸替换遵循 Jukes–Cantor 1969 (JC69) 模型，这是一个在字母表 $\\{A,C,G,T\\}$ 上的连续时间马尔可夫链 (CTMC)，具有相等的碱基频率和相等的非对角瞬时速率。设单个谱系的 CTMC 生成矩阵为 $Q$，其非对角线元素为 $Q_{ij} = \\alpha$ (当 $i \\neq j$ 时)，对角线元素为 $Q_{ii} = -3\\alpha$。并设单个谱系每个位点的替换速率为 $\\mu = 3\\alpha$。在严格分子钟的假设下，两个子代谱系独立演化了相同的分歧时间 $t$，并且成对速率满足 $r = 2\\mu$。\n\n基于这些基础，推导分歧时间 $t$ 作为可观测值 $p$ 和已知速率 $r$ 的函数表达式，然后使用给定的 $p$ 和 $r$ 对 $t$ 进行数值计算。将最终数值答案四舍五入至四位有效数字，并以年为单位表示时间。作为推导的一部分，请清晰地阐明该表达式有效性所需的假设，并说明为使基于模型的反演能得到有限实数值时间，$p$ 值必须满足的任何限制条件。", "solution": "该问题经核实具有科学依据，问题设定良好且客观。这是一个基于 Jukes-Cantor 基础模型的分子系统发育学中的标准问题。所有必需的参数均已提供，且没有内部矛盾。\n\n解答过程分四个阶段：\n1.  推导观测差异比例 $p$ 与分歧时间 $t$ 之间的关系。\n2.  对此关系进行反演，以求得 $t$ 作为 $p$ 和成对替换速率 $r$ 的函数表达式。\n3.  陈述所需的假设以及对 $p$ 值的数学限制。\n4.  使用所提供的数据对 $t$ 进行数值计算。\n\n让我们从 Jukes-Cantor 1969 (JC69) 模型开始。这是一个用于核苷酸替换的连续时间马尔可夫链 (CTMC)。对于单个谱系，瞬时速率矩阵 $Q$ 由下式给出\n$$\nQ = \\begin{pmatrix} -3\\alpha   \\alpha   \\alpha   \\alpha \\\\ \\alpha   -3\\alpha   \\alpha   \\alpha \\\\ \\alpha   \\alpha   -3\\alpha   \\alpha \\\\ \\alpha   \\alpha   \\alpha   -3\\alpha \\end{pmatrix}\n$$\n其中 $\\alpha$ 是从任意一种核苷酸替换为任意另一种特定核苷酸的速率。\n\n该问题考虑的是两条序列在 $t$ 年前从一个共同祖先分歧而来。在严格分子钟下，它们沿着两条等长为 $t$ 的谱系独立演化。我们希望找到在某个给定的同源位点上，两条序列中核苷酸不同的概率 $p$。我们将此概率记为 $p_{\\text{diff}}(t)$。在时间 $t=0$（共同祖先）时，序列是相同的，因此 $p_{\\text{diff}}(0) = 0$。\n\n让我们对这对位点的状态演化进行建模。一对位点可以处于两种状态之一：“相同”(S) 或“不同”(D)。\n如果一个谱系发生替换而另一个没有，则会发生从 S 到 D 的转变。任何核苷酸替换为其他三种中任意一种的速率是 $3\\alpha$。由于这可能发生在两个谱系中的任何一个，因此从 S 到 D 的转变速率是 $2 \\times 3\\alpha = 6\\alpha$。\n如果一个谱系中的核苷酸突变以匹配另一个谱系中的核苷酸，则可能发生从 D 到 S 的转变。例如，如果位点是 A 和 C，A 可以突变为 C（速率为 $\\alpha$），或者 C 可以突变为 A（速率为 $\\alpha$）。因此，从 D 到 S 的总转变速率是 $2\\alpha$。\n\n这定义了一个在 $\\{S, D\\}$ 上的双状态 CTMC，处于“不同”状态的概率 $p_{\\text{diff}}(t)$ 遵循以下微分方程：\n$$\n\\frac{dp_{\\text{diff}}(t)}{dt} = (\\text{rate S}\\to\\text{D}) \\cdot p_{\\text{same}}(t) - (\\text{rate D}\\to\\text{S}) \\cdot p_{\\text{diff}}(t)\n$$\n代入速率并利用 $p_{\\text{same}}(t) = 1 - p_{\\text{diff}}(t)$ 这一事实，我们得到：\n$$\n\\frac{dp_{\\text{diff}}(t)}{dt} = 6\\alpha (1 - p_{\\text{diff}}(t)) - 2\\alpha \\, p_{\\text{diff}}(t) = 6\\alpha - 8\\alpha \\, p_{\\text{diff}}(t)\n$$\n这是一个一阶线性常微分方程。其通解形式为 $p_{\\text{diff}}(t) = A \\exp(-8\\alpha t) + B$。通过将导数设为零来找到特解 $B$：$0 = 6\\alpha - 8\\alpha B$，这得出 $B = 6\\alpha / (8\\alpha) = 3/4$。因此，$p_{\\text{diff}}(t) = A \\exp(-8\\alpha t) + 3/4$。\n使用初始条件 $p_{\\text{diff}}(0) = 0$，我们求得 $A$：\n$0 = A \\exp(0) + 3/4 \\implies A = -3/4$。\n因此，不同位点的比例作为分歧时间 $t$ 的函数是：\n$$\np(t) = \\frac{3}{4} \\left(1 - \\exp(-8\\alpha t)\\right)\n$$\n问题提供了观测到的差异 $p=0.015$，这对应于 $p(t)$。\n\n接下来，我们用给定的成对速率 $r$ 来表示这个方程。单个谱系的替换速率 $\\mu$ 是单位时间内每个位点的预期替换数。对于 JC69 模型，它被给出为 $\\mu = 3\\alpha$。成对替换累积速率 $r$ 是两个谱系合并的速率。因此，$r = 2\\mu$。代入 $\\mu = 3\\alpha$，我们得到 $r = 2(3\\alpha) = 6\\alpha$。这使我们可以写出 $\\alpha = r/6$。\n将此代入我们关于 $p(t)$ 的表达式中：\n$$\np = \\frac{3}{4} \\left(1 - \\exp(-8(r/6) t)\\right) = \\frac{3}{4} \\left(1 - \\exp\\left(-\\frac{4}{3}rt\\right)\\right)\n$$\n现在，我们反演这个表达式来求解分歧时间 $t$：\n$$\n\\frac{4}{3} p = 1 - \\exp\\left(-\\frac{4}{3}rt\\right)\n$$\n$$\n\\exp\\left(-\\frac{4}{3}rt\\right) = 1 - \\frac{4}{3}p\n$$\n$$\n-\\frac{4}{3}rt = \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\n$$\nt = -\\frac{3}{4r} \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\n这就是我们想要的 $t$ 作为 $p$ 和 $r$ 的函数表达式。\n\n此推导有效的关键假设是：\n1.  Jukes-Cantor 核苷酸替换模型是对演化过程的准确描述。这包括相等的平衡碱基频率（$\\pi_A = \\pi_C = \\pi_G = \\pi_T = 1/4$）和所有类型替换的相等速率。\n2.  严格分子钟成立，意味着替换速率 $\\mu$ 在不同谱系间和随时间推移都是恒定的。\n3.  两个谱系从它们最近的共同祖先分歧后独立演化。\n4.  观测到的差异比例 $p$ 没有抽样误差，并准确反映了期望值 $p(t)$。\n\n为使表达式能得到一个有限、实数且为正的时间 $t$，自然对数的参数必须严格介于 $0$ 和 $1$ 之间：\n$$\n0  1 - \\frac{4}{3}p  1\n$$\n不等式的右侧，$1 - \\frac{4}{3}p  1$，意味着 $-\\frac{4}{3}p  0$，这对任何 $p > 0$ 都成立。$p=0$ 的情况得出 $t=0$。\n不等式的左侧，$0  1 - \\frac{4}{3}p$，意味着 $\\frac{4}{3}p  1$，即 $p  3/4$。\n因此，对可观测值 $p$ 的限制是 $0 \\le p  0.75$。如果 $p \\ge 0.75$，模型表明序列已经充满了替换（饱和），无法估算出有限的分歧时间。\n\n最后，我们使用给定的值 $p = 0.015$ 和 $r = 2.4 \\times 10^{-3}$ 个替换/位点/年 对 $t$ 进行数值计算。\n首先，我们检查 $p$ 是否在有效范围内：$0.015  0.75$，因此计算是有效的。\n将这些值代入推导出的公式中：\n$$\nt = -\\frac{3}{4 \\times (2.4 \\times 10^{-3})} \\ln\\left(1 - \\frac{4}{3} \\times 0.015\\right)\n$$\n首先，计算对数内的项：\n$$\n\\frac{4}{3} \\times 0.015 = 4 \\times 0.005 = 0.02\n$$\n$$\n1 - 0.02 = 0.98\n$$\n现在，将此代回 $t$ 的表达式中：\n$$\nt = -\\frac{3}{9.6 \\times 10^{-3}} \\ln(0.98)\n$$\n前置因子是：\n$$\n\\frac{3}{9.6 \\times 10^{-3}} = \\frac{3}{0.0096} = 312.5\n$$\n因此，表达式变为：\n$$\nt = -312.5 \\times \\ln(0.98)\n$$\n使用计算器计算自然对数：\n$$\n\\ln(0.98) \\approx -0.020202707\n$$\n$$\nt \\approx -312.5 \\times (-0.020202707) \\approx 6.3133459 \\text{ 年}\n$$\n将结果四舍五入至四位有效数字，我们得到 $t \\approx 6.313$ 年。", "answer": "$$\\boxed{6.313}$$", "id": "4586166"}, {"introduction": "虽然严格分子钟提供了一个简单的模型，但其假设必须用真实数据进行检验。本练习介绍了一种强大的诊断工具——根到末端回归（root-to-tip regression），用于评估数据集是否以符合时钟的方式演化。通过分析残差并使用赤池信息准则（Akaike Information Criterion, AIC），您将练习如何为从简单的全局时钟模型转换到更复杂的局部分子钟模型提供正当理由。[@problem_id:4586176]", "problem": "一项病毒学监测项目生成了一个RNA病毒的时间标度系统发育树，其中包含三个得到良好支持的单系进化支，分别表示为 $C_1$、$C_2$ 和 $C_3$。对于每个末端枝 $i$，从该定年树中提取了根到尖端的遗传距离 $R_i$（单位：每位点替换数）和采样时间 $T_i$（单位：年，在所有进化支中使用相同的绝对时间轴测量）。为了评估分子钟行为，使用线性模型 $R_i = a + r T_i + \\varepsilon_i$ 进行了全局根到尖端回归拟合，其中 $a$ 是共享截距，$r$ 是共享速率，$\\varepsilon_i$ 是独立误差。假设误差独立同分布于均值为 $0$、方差为 $\\sigma^2$ 的正态分布。\n\n基础原理：\n- 在严格分子钟假设下，分支特异性速率在整个系统发育树中是恒定的，这意味着累积的替换数与时间之间存在线性关系。根到尖端回归通过拟合线性模型并检查残差结构来评估这一点。\n- 对于具有独立同分布正态误差的线性模型，最大似然估计（MLE）与普通最小二乘法（OLS）得出相同的拟合结果。残差平方和（SSR）$S = \\sum_i \\varepsilon_i^2$ 是拟合优度的充分统计量，模型选择可以通过赤池信息准则（AIC）进行。对于具有 $p$ 个自由参数和 $n$ 个观测值的正态误差回归，AIC定义为 $\\mathrm{AIC} = 2p - 2 \\hat{\\ell}$，其中 $\\hat{\\ell}$ 是最大化的对数似然。当 $\\sigma^2$ 通过 $\\hat{\\sigma}^2 = S/n$ 估计时，可以得到标准形式 $\\mathrm{AIC} = 2p + n \\ln\\!\\big(S/n\\big) + \\text{常数}$，其中常数项在比较候选模型之间的差异时会抵消。\n\n全局拟合的经验总结：\n- 全局拟合使用了 $n = 90$ 个末端枝，得到的残差平方和（SSR）为 $S_0 = 820$。\n- 设 $\\mathbf{e}$ 表示全局拟合的残差向量。为了检验进化支特异性地偏离类时钟行为，考虑通过预测变量 $\\mathbf{x}_k = \\big(T_i \\,\\mathbb{1}(i \\in C_k)\\big)$，$k \\in \\{1,2,3\\}$，为进化支添加局部速率偏差参数，同时保留共享截距和共享全局速率。在将每个 $\\mathbf{x}_k$ 相对于全局截距和时间列进行适当的残差化（以确保有效的偏平方和）之后，添加单个进化支特异性速率偏差所带来的SSR减少量由 $\\Delta_k$ 给出，计算出的三个进化支的 $\\Delta_k$ 分别为：\n  - $\\Delta_1 = 140$，\n  - $\\Delta_2 = 70$，\n  - $\\Delta_3 = 40$。\n- 由于进化支特异性预测变量具有不相交的支持集，并且已经相对于基础列进行了残差化，因此添加任何进化支特异性偏差子集所带来的总SSR减少量等于相应 $\\Delta_k$ 的总和。\n\n模型选择：\n- 基准的全局时钟模型有 $p_0 = 2$ 个参数（$a$ 和 $r$）。\n- 每个增加的局部速率偏差参数会使参数数量增加1。\n\n问题：在正态误差模型下，使用最大似然估计（MLE）原理和赤池信息准则（AIC）进行模型选择，下列选项中哪种局部分子钟的分配方案能产生最佳模型（即AIC值最低）？\n\nA. 仅对 $C_1$ 和 $C_2$ 应用局部分子钟（保留共享截距和全局速率，外加两个进化支偏差）。\n\nB. 仅对 $C_1$ 应用局部分子钟（保留共享截距和全局速率，外加一个进化支偏差）。\n\nC. 对所有三个进化支 $C_1$、$C_2$ 和 $C_3$ 应用局部分子钟（保留共享截距和全局速率，外加三个进化支偏差）。\n\nD. 不应用任何局部分子钟；仅保留全局分子钟。\n\nE. 仅对 $C_2$ 和 $C_3$ 应用局部分子钟（保留共享截距和全局速率，外加两个进化支偏差）。", "solution": "首先将验证问题陈述的科学合理性、一致性和完整性。\n\n**步骤1：提取已知条件**\n- 分析涉及三个单系进化支：$C_1$、$C_2$ 和 $C_3$。\n- 对于每个末端枝 $i$，我们有根到尖端的遗传距离 $R_i$ 和采样时间 $T_i$。\n- 拟合了一个全局线性模型：$R_i = a + r T_i + \\varepsilon_i$。\n- 误差 $\\varepsilon_i$ 独立同分布（i.i.d.）于均值为 $0$、方差为 $\\sigma^2$ 的正态分布。\n- 末端枝总数（观测值数量）为 $n = 90$。\n- 全局拟合（基准模型）有 $p_0 = 2$ 个参数（$a$ 和 $r$），产生的残差平方和（SSR）为 $S_0 = 820$。\n- 赤池信息准则（AIC）由 $\\mathrm{AIC} = 2p + n \\ln(S/n)$ 给出（忽略一个可加常数），其中 $p$ 是自由参数的数量，$S$ 是给定模型的残差平方和。\n- 为一个进化支添加一个局部速率偏差参数会使参数数量 $p$ 增加1。\n- 添加单个进化支特异性速率偏差参数所带来的SSR减少量分别为：\n  - 对于 $C_1$：$\\Delta_1 = 140$。\n  - 对于 $C_2$：$\\Delta_2 = 70$。\n  - 对于 $C_3$：$\\Delta_3 = 40$。\n- 对于包含多个局部分子钟的模型，总的SSR减少量是所包含进化支的单个 $\\Delta_k$ 值之和。\n\n**步骤2：使用提取的已知条件进行验证**\n问题陈述描述了分子系统发育学中的一个标准统计流程：使用根到尖端回归来评估严格分子钟假说，并采用像AIC这样的模型选择准则来比较具有不同时钟假设（例如，全局时钟与局部分子钟）的模型。\n\n- **科学依据：** 分子钟、根到尖端回归、残差平方和以及赤池信息准则等概念是生物信息学和统计学中基本且广泛使用的原理。该设定是线性模型比较的一个典型例子。\n- **格式良好：** 问题是格式良好的。它提供了所有必要的数据（$n$、$S_0$ 和所有的 $\\Delta_k$）和一个明确的目标函数（最小化AIC），从而可以在给定选项中唯一地确定最佳模型。SSR减少量的可加性是指定模型结构（具有不相交支持集的残差化预测变量）的有效推论。\n- **客观性：** 该问题使用精确、客观的数学和统计语言陈述，没有歧义或主观看法。\n\n**步骤3：结论与行动**\n问题是有效的。它在科学上合理，格式良好且客观。可以进行求解过程。\n\n**解题推导**\n任务是确定哪个提议的时钟模型受数据支持最好，“最好”定义为具有最小的赤池信息准则（AIC）。用于比较的AIC公式为 $\\mathrm{AIC} = 2p + n \\ln(S/n)$，其中 $p$ 是参数数量，$n$ 是观测值数量，$S$ 是残差平方和（SSR）。已知 $n = 90$。\n\n我们必须计算选项中描述的每个模型的AIC。\n\n**模型D：仅全局时钟**\n这是基准模型。\n- 参数数量：$p_D = p_0 = 2$（一个截距 $a$，一个速率 $r$）。\n- 残差平方和：$S_D = S_0 = 820$。\n- AIC计算：\n$$ \\mathrm{AIC}_D = 2p_D + n \\ln(S_D/n) = 2(2) + 90 \\ln(820/90) = 4 + 90 \\ln(9.111...) \\approx 4 + 90(2.2095) \\approx 202.86 $$\n\n**模型B：仅对 $C_1$ 使用局部分子钟**\n该模型在全局模型基础上增加了一个局部速率参数。\n- 参数数量：$p_B = p_0 + 1 = 2 + 1 = 3$。\n- 残差平方和：SSR减少了 $\\Delta_1$。\n$$ S_B = S_0 - \\Delta_1 = 820 - 140 = 680 $$\n- AIC计算：\n$$ \\mathrm{AIC}_B = 2p_B + n \\ln(S_B/n) = 2(3) + 90 \\ln(680/90) = 6 + 90 \\ln(7.555...) \\approx 6 + 90(2.0223) \\approx 188.01 $$\n\n**模型A：仅对 $C_1$ 和 $C_2$ 使用局部分子钟**\n该模型增加了两个局部速率参数。\n- 参数数量：$p_A = p_0 + 2 = 2 + 2 = 4$。\n- 残差平方和：SSR减少了 $\\Delta_1 + \\Delta_2$。\n$$ S_A = S_0 - (\\Delta_1 + \\Delta_2) = 820 - (140 + 70) = 820 - 210 = 610 $$\n- AIC计算：\n$$ \\mathrm{AIC}_A = 2p_A + n \\ln(S_A/n) = 2(4) + 90 \\ln(610/90) = 8 + 90 \\ln(6.777...) \\approx 8 + 90(1.9137) \\approx 180.23 $$\n\n**模型E：仅对 $C_2$ 和 $C_3$ 使用局部分子钟**\n该模型增加了两个局部速率参数。\n- 参数数量：$p_E = p_0 + 2 = 2 + 2 = 4$。\n- 残差平方和：SSR减少了 $\\Delta_2 + \\Delta_3$。\n$$ S_E = S_0 - (\\Delta_2 + \\Delta_3) = 820 - (70 + 40) = 820 - 110 = 710 $$\n- AIC计算：\n$$ \\mathrm{AIC}_E = 2p_E + n \\ln(S_E/n) = 2(4) + 90 \\ln(710/90) = 8 + 90 \\ln(7.888...) \\approx 8 + 90(2.0654) \\approx 193.89 $$\n\n**模型C：对所有三个进化支 $C_1$、$C_2$ 和 $C_3$ 使用局部分子钟**\n该模型增加了三个局部速率参数。\n- 参数数量：$p_C = p_0 + 3 = 2 + 3 = 5$。\n- 残差平方和：SSR减少了 $\\Delta_1 + \\Delta_2 + \\Delta_3$。\n$$ S_C = S_0 - (\\Delta_1 + \\Delta_2 + \\Delta_3) = 820 - (140 + 70 + 40) = 820 - 250 = 570 $$\n- AIC计算：\n$$ \\mathrm{AIC}_C = 2p_C + n \\ln(S_C/n) = 2(5) + 90 \\ln(570/90) = 10 + 90 \\ln(6.333...) \\approx 10 + 90(1.8458) \\approx 176.12 $$\n\n**模型比较**\n计算出的AIC值如下：\n- $\\mathrm{AIC}_D \\approx 202.86$\n- $\\mathrm{AIC}_B \\approx 188.01$\n- $\\mathrm{AIC}_A \\approx 180.23$\n- $\\mathrm{AIC}_E \\approx 193.89$\n- $\\mathrm{AIC}_C \\approx 176.12$\n\n最佳模型是AIC值最低的模型。比较这些值：\n$$ 176.12  180.23  188.01  193.89  202.86 $$\n$$ \\mathrm{AIC}_C  \\mathrm{AIC}_A  \\mathrm{AIC}_B  \\mathrm{AIC}_E  \\mathrm{AIC}_D $$\n最小的AIC值对应于模型C。\n\n**逐项分析**\n- **A. 仅对 $C_1$ 和 $C_2$ 应用局部分子钟（...）：** 该模型得出的AIC值约为 $180.23$。这不是最低值。**错误。**\n- **B. 仅对 $C_1$ 应用局部分子钟（...）：** 该模型得出的AIC值约为 $188.01$。这不是最低值。**错误。**\n- **C. 对所有三个进化支 $C_1$、$C_2$ 和 $C_3$ 应用局部分子钟（...）：** 该模型得出的AIC值约为 $176.12$。这是所有候选模型中AIC值最低的。**正确。**\n- **D. 不应用任何局部分子钟；仅保留全局分子钟：** 该模型得出的AIC值约为 $202.86$。这是最高的值，表明在所有选项中拟合效果最差。**错误。**\n- **E. 仅对 $C_2$ 和 $C_3$ 应用局部分子钟（...）：** 该模型得出的AIC值约为 $193.89$。这不是最低值。**错误。**\n\n分析表明，根据赤池信息准则判断，包含所有三个进化支的局部分子钟的模型，在拟合优度（最低的SSR）和模型复杂性（参数数量）之间取得了最佳平衡。", "answer": "$$\\boxed{C}$$", "id": "4586176"}, {"introduction": "现代系统发育定年主要依赖于贝叶斯框架，其中推断是数据和先验知识的综合。本问题探讨了似然（源自序列数据）和先验（源自化石校准）在估计速率和时间时的关键相互作用。通过这个思想实验，您将对先验如何影响后验估计形成更深刻的直觉，特别是当速率和时间等参数无法仅从似然中独立辨识时。[@problem_id:4586180]", "problem": "在严格分子钟下，对两个姐妹分类单元进行贝叶斯分子钟分析，并对其最近的共同祖先使用单个化石校准。设序列长度为 $L=20{,}000$ 个位点，观察到的差异数量为 $K=2{,}400$。假设一个均一的泊松替换过程，其中沿一个分支的预期替换数是每个位点的替换速率 $r$ 和分支时长 $t$ 的乘积，而两个谱系之间观察到的差异反映了两个分支上累积的替换总和。分析人员对每位点每百万年的替换速率 $r$ 使用了一个宽泛的先验，该先验被建模为形状参数为 $a$、速率参数为 $b$ 的伽玛分布；并对节点年龄 $t$ 使用了一个化石校准先验，该先验被建模为具有最小界限 $t_{\\min}$ 的截断对数正态分布。\n\n最初，化石校准先验被错误地指定，其最小界限 $t_{\\min}=10$ 百万年（Myr）过于严格，且众数接近 $12$ Myr。经过审查，该先验被修正为一个限制较少的最小界限 $t_{\\min}=1$ Myr，众数接近 $3$ Myr，同时保持 $r$ 的伽玛先验以及序列数据 $K$ 和 $L$ 不变。假设严格分子钟在两个分支上具有相同的速率，并且给定 $r$、$t$ 和 $L$ 时 $K$ 的似然性源于上述指定的泊松模型。使用贝叶斯法则、分子钟关于预期替换数的定义，以及单个校准节点下 $(r,t)$ 的可识别性结构，来推断当校准先验被修正时，$(r,t)$ 的联合后验会如何移动。\n\n当用修正后的校准替换错误指定的校准时，以下哪个陈述最能描述 $r$ 和 $t$ 的后验分布移动的方向和结构性原因？\n\nA. 由于最小年龄过高，$t$ 的后验质量被推向更老的数值，而 $r$ 的后验相应地被推向更低的数值，以满足数据所隐含的对 $r$ 和 $t$ 乘积的约束。将最小年龄修正得不那么严格，会使后验沿着由观测差异决定的同一似然脊，向更年轻的 $t$ 和更高的 $r$ 移动。\n\nB. 高的最小年龄先验迫使后验速率 $r$ 升高以匹配观测到的差异，修正它会降低 $r$ 而使 $t$ 大致保持不变，因为似然性主要取决于 $r$。\n\nC. 在严格分子钟和单个校准下，$r$ 和 $t$ 的后验是独立于校准先验可识别的；因此，修正最小年龄不会改变 $r$ 或 $t$ 的后验均值。\n\nD. 修正一个过于严格的最小年龄必然会同时增加 $t$ 的后验均值和 $r$ 的后验均值，因为两个参数都有了更多的先验质量可用。", "solution": "用户要求对问题陈述进行批判性验证，然后对选项进行详细推导和评估。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n-   **分析：** 贝叶斯分子钟。\n-   **分类单元：** 两个姐妹分类单元。\n-   **分子钟模型：** 严格分子钟。\n-   **校准：** 对最近共同祖先（MRCA）进行单个化石校准。\n-   **序列数据：** 长度 $L=20{,}000$ 个位点，观察到的差异数 $K=2{,}400$。\n-   **替换模型：** 均一泊松过程。一个分支上的预期替换数是 $r \\times t$，其中 $r$ 是每位点替换速率，$t$ 是分支时长。两个谱系间观察到的差异反映了两个分支上替换数的总和。\n-   **速率 $r$ 的先验：** 伽玛分布，$P(r) = \\text{Gamma}(r | a, b)$。此先验不变。\n-   **年龄 $t$ 的初始先验：** 截断对数正态分布，最小界限为 $t_{\\min}=10$ 百万年（Myr），众数接近 $12$ Myr。\n-   **年龄 $t$ 的修正后先验：** 截断对数正态分布，最小界限为 $t_{\\min}=1$ Myr，众数接近 $3$ Myr。\n-   **不变量：** $r$ 的伽玛先验、序列数据 $K$ 和 $L$、严格分子钟模型以及泊松似然框架在两次分析中都保持不变。\n-   **问题：** 当 $t$ 的初始先验被修正后的先验替换时，描述 $(r, t)$ 联合后验分布的移动情况。\n\n**步骤 2：使用提取的给定信息进行验证**\n-   **科学依据：** 问题陈述描述了贝叶斯系统发育定年分析中一个标准且成熟的方法。严格分子钟、泊松替换过程、速率的伽玛先验以及节点年龄的对数正态先验的使用，都是 BEAST 或 MrBayes 等软件中的典型选择。该场景在科学上是合理且现实的。\n-   **定义明确：** 该问题对于定性分析来说是定义明确的。它提供了贝叶斯模型的所有必要组成部分（似然和先验），并询问更改其中一个先验的定性效应。该问题具有清晰的逻辑基础，并且可以从贝叶斯统计的原理中推导出唯一的概念性答案。\n-   **客观性：** 该问题使用统计学和生物信息学中精确、客观的术语进行陈述。它没有歧义和主观性论断。\n-   **验证结论：** 该问题没有任何缺陷。它在科学上是合理的，问题定义良好、客观、对于任务是完整的，并提出了一个非平凡的概念性问题。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。现在将进行求解过程。\n\n### 解答推导\n\n这个问题的核心在于贝叶斯框架内似然函数与先验分布之间的相互作用，特别是在参数可识别性的背景下。\n\n**1. 似然函数与参数可识别性**\n这两个谱系是在过去 $t$ 时刻从一个共同祖先分化出来的姐妹分类单元。在严格分子钟下，两个谱系的进化速率 $r$ 是相同的。分隔这两个序列的总时间是 $t + t = 2t$。\n\n问题陈述，替换数被建模为泊松过程。在总分化路径长度为 $2t$ 的情况下，每位点的预期替换数是进化距离 $d$。该距离由 $d = r \\times (2t)$ 给出。\n\n序列数据包括在 $L=20{,}000$ 个位点上的 $K=2{,}400$ 个差异。差异位点的比例是 $p = K/L = 2{,}400 / 20{,}000 = 0.12$。这个观察到的比例 $p$ 是对真实进化距离 $d$ 的一个估计，通常需要对同一位点的多次替换进行校正（例如，使用Jukes-Cantor校正，$d = -\\frac{3}{4}\\ln(1 - \\frac{4}{3}p)$）。无论具体的校正方法如何，观察到 $K$ 个差异的似然性是预期距离 $d$ 的函数。\n$$P(K | r, t, L) = \\text{Likelihood}(d) = \\text{Likelihood}(2rt)$$\n这意味着似然函数 $L(r, t | K)$ 由乘积 $rt$ 决定。任何产生相同乘积 $rt$ 的 $(r, t)$ 对都将具有相同的似然性。在 $(r, t)$ 的参数空间中，似然函数沿着双曲线 $rt = C$ 形成一个高概率的“脊”，其中 $C = d_{\\text{ML}}/2$ 是一个由距离的最大似然估计决定的常数。仅凭数据无法区分高速率 $r$ 和短时间 $t$，或低速率 $r$ 和长时间 $t$。这是一个经典的不可识别性问题。\n\n**2. 先验在贝叶斯分析中的作用**\n贝叶斯法则指出，联合后验分布正比于似然性与联合先验分布的乘积：\n$$P(r, t | K, L) \\propto P(K | r, t, L) \\cdot P(r, t)$$\n假设 $r$ 和 $t$ 的先验是独立的，$P(r, t) = P(r) \\cdot P(t)$。\n$$P(r, t | K, L) \\propto \\underbrace{L(r, t | K)}_{\\text{似然}} \\cdot \\underbrace{P(r)}_{\\text{速率先验}} \\cdot \\underbrace{P(t)}_{\\text{年龄先验}}$$\n后验分布将在右侧所有三个分量都较大的区域具有高密度。似然性将后验质量限制在脊 $rt \\approx C$ 上。然后，$r$ 和 $t$ 的先验决定了后验质量将沿着这条脊的*哪个位置*集中。\n\n**3. 后验移动分析**\n让我们分析 $t$ 的先验 $P(t)$ 的两种情景。\n\n*   **情景1：错误指定的、限制性强的先验。** 时间的先验是 $P_1(t)$，一个截断对数正态分布，其 $t_{\\min}=10$ Myr，众数接近 $12$ Myr。这个先验将显著的概率质量放在较大的 $t$ 值上（即 $t \\geq 10$ Myr），而在 $t  10$ Myr 上的概率为零。为了获得高的后验概率，解必须位于似然脊（$rt \\approx C$）上，并且也处于高先验概率的区域。由于 $P_1(t)$ 迫使 $t$ 变大，似然脊上对应的 $r$ 值必须变小（因为 $r \\approx C/t$）。因此，联合后验分布将集中在一个大 $t$ 和小 $r$ 的区域。\n\n*   **情景2：修正后的、限制较少的先验。** 先验被替换为 $P_2(t)$，一个截断对数正态分布，其 $t_{\\min}=1$ Myr，众数接近 $3$ Myr。这个先验现在将显著的概率质量放在小得多的 $t$ 值上。似然函数保持不变，因为数据（$K, L$）是相同的。$r$ 的先验 $P(r)$ 也保持不变。在计算新的后验时，模型将再次寻找似然和先验都较大的区域。新的先验 $P_2(t)$ 偏好较小的 $t$ 值。为了保持在同一似然脊上（$rt \\approx C$），较小的 $t$ 值需要较大的 $r$ 值。因此，联合后验分布会将其质量移动到一个较小 $t$ 和较大 $r$ 的区域。\n\n**结论：** 将化石先验从一个偏好老年龄的修正为一个偏好年轻年龄的，导致后验分布沿着似然脊从一个（高 $t$，低 $r$）的区域移动到一个（低 $t$，高 $r$）的区域。\n\n### 逐项分析选项\n\n**A. 由于最小年龄过高，$t$ 的后验质量被推向更老的数值，而 $r$ 的后验相应地被推向更低的数值，以满足数据所隐含的对 $r$ 和 $t$ 乘积的约束。将最小年龄修正得不那么严格，会使后验沿着由观测差异决定的同一似然脊，向更年轻的 $t$ 和更高的 $r$ 移动。**\n该陈述准确地描述了推导出的行为。$t$ 的初始先验具有限制性，迫使 $t$ 很高，这反过来又迫使 $r$ 很低，以匹配似然约束（$rt \\approx C$）。将先验修正为偏好更小的 $t$ 值，使得 $t$ 的后验能够移动到更年轻的年龄，这需要 $r$ 相应地向更高的速率移动，以保持在似然脊上。\n**结论：正确**\n\n**B. 高的最小年龄先验迫使后验速率 $r$ 升高以匹配观测到的差异，修正它会降低 $r$ 而使 $t$ 大致保持不变，因为似然性主要取决于 $r$。**\n该陈述在两点上是错误的。首先，高的年龄先验（$t$）迫使速率（$r$）*降低*而非升高，以维持乘积 $rt$。其次，似然性并非主要取决于 $r$；它取决于乘积 $rt$。时间 $t$ 将会显著改变，因为它的先验已被大幅修改。\n**结论：错误**\n\n**C. 在严格分子钟和单个校准下，$r$ 和 $t$ 的后验是独立于校准先验可识别的；因此，修正最小年龄不会改变 $r$ 或 $t$ 的后验均值。**\n该陈述从根本上误解了在此背景下的参数可识别性。仅通过单个校准，是*无法*单从似然性中识别出 $r$ 和 $t$ 的。数据只能识别它们的乘积。节点年龄 $t$ 的校准先验对于打破这种不可识别性、从而获得 $r$ 和 $t$ 各自的、定义明确的后验分布是绝对必要的。改变这个关键的先验必然会改变最终的后验。\n**结论：错误**\n\n**D. 修正一个过于严格的最小年龄必然会同时增加 $t$ 的后验均值和 $r$ 的后验均值，因为两个参数都有了更多的先验质量可用。**\n该陈述是错误的。将先验从一个众数接近 $12$ Myr 的修正为一个众数接近 $3$ Myr 的，将会*降低* $t$ 的后验均值。此外，由于 $r$ 和 $t$ 在后验中呈负相关（由于似然约束 $rt \\approx C$），$t$ 均值的下降将导致 $r$ 均值的*上升*。它们不可能同时增加。关于“更多的先验质量可用”的推理也具有误导性；关键的变化是 $t$ 的先验质量的位置，而不是其总积分。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "4586180"}]}