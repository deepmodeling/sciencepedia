{"hands_on_practices": [{"introduction": "生物网络，例如代谢网络，可以被抽象为图模型进行分析。本练习旨在通过构建一个小型代谢网络的邻接矩阵和关联矩阵，来巩固图的不同数学表示方法。通过这些矩阵运算，你将练习如何量化节点间的相互作用，例如计算两步路径的数量和确定每个节点的出入度，这是网络分析的基础技能。[@problem_id:4570479]", "problem": "在一个源自小型代谢子系统的有向代谢物相互作用网络中，代谢物被表示为节点 $M_1, M_2, M_3, M_4, M_5, M_6$，有向边表示由反应介导的转化。该网络由以下有向边指定（每条边都有一个相关的非负权重，代表标准化的通量容量）：\n\n- $e_1$：$M_1 \\to M_2$，权重为 $1.0$，\n- $e_2$：$M_2 \\to M_3$，权重为 $0.5$，\n- $e_3$：$M_3 \\to M_1$，权重为 $1.5$，\n- $e_4$：$M_3 \\to M_4$，权重为 $2.0$，\n- $e_5$：$M_4 \\to M_5$，权重为 $1.0$，\n- $e_6$：$M_5 \\to M_3$，权重为 $0.75$，\n- $e_7$：$M_2 \\to M_5$，权重为 $1.2$，\n- $e_8$：$M_5 \\to M_6$，权重为 $0.8$，\n- $e_9$：$M_6 \\to M_2$，权重为 $0.9$，\n- $e_{10}$：$M_1 \\to M_4$，权重为 $0.6$，\n- $e_{11}$：$M_1 \\to M_3$，权重为 $0.7$。\n\n在生物信息学中，使用有向图的标准图论定义：\n\n- 构建邻接矩阵 $A \\in \\mathbb{R}^{6 \\times 6}$，其中如果存在从 $M_i$ 到 $M_j$ 的有向边，则 $A_{ij} = 1$，否则 $A_{ij} = 0$。\n- 构建加权邻接矩阵 $W \\in \\mathbb{R}^{6 \\times 6}$，其中 $W_{ij}$ 等于从 $M_i$ 到 $M_j$ 的有向边的给定权重，如果不存在这样的边，则 $W_{ij} = 0$。\n- 构建有向节点-边关联矩阵 $B \\in \\mathbb{R}^{6 \\times 11}$，其中每一列对应于一条边 $e_1, \\dots, e_{11}$，如果边 $e$ 离开节点 $M_v$，则 $B_{v,e} = -1$；如果边 $e$ 进入节点 $M_v$，则 $B_{v,e} = +1$；否则 $B_{v,e} = 0$。\n\n根据这些构造：\n\n1. 显式计算 $A^2$。\n2. 使用 $B$，通过计算每一行中 $+1$ 的数量（入度）和 $-1$ 的数量（出度），确定每个节点 $M_1, \\dots, M_6$ 的入度和出度。\n3. 设 $S^{\\star}$ 为索引 $i \\in \\{1,2,3,4,5,6\\}$ 的集合，使得 $M_i$ 的出度严格大于其入度。计算标量\n$$\nS \\;=\\; \\sum_{i \\in S^{\\star}} \\left(A^2\\right)_{ii}.\n$$\n\n提供 $S$ 的最终值，结果为单个实数。无需四舍五入。", "solution": "首先验证问题，以确保其科学性、适定性、客观性和完整性。\n\n### 步骤1：提取已知条件\n- **节点**：代谢物 $M_1, M_2, M_3, M_4, M_5, M_6$。\n- **边和权重**：\n  - $e_1$：$M_1 \\to M_2$，权重 $1.0$\n  - $e_2$：$M_2 \\to M_3$，权重 $0.5$\n  - $e_3$：$M_3 \\to M_1$，权重 $1.5$\n  - $e_4$：$M_3 \\to M_4$，权重 $2.0$\n  - $e_5$：$M_4 \\to M_5$，权重 $1.0$\n  - $e_6$：$M_5 \\to M_3$，权重 $0.75$\n  - $e_7$：$M_2 \\to M_5$，权重 $1.2$\n  - $e_8$：$M_5 \\to M_6$，权重 $0.8$\n  - $e_9$：$M_6 \\to M_2$，权重 $0.9$\n  - $e_{10}$：$M_1 \\to M_4$，权重 $0.6$\n  - $e_{11}$：$M_1 \\to M_3$，权重 $0.7$\n- **矩阵定义**：\n  - 邻接矩阵 $A \\in \\mathbb{R}^{6 \\times 6}$：如果存在从 $M_i$ 到 $M_j$ 的边，则 $A_{ij} = 1$，否则 $A_{ij} = 0$。\n  - 加权邻接矩阵 $W \\in \\mathbb{R}^{6 \\times 6}$：$W_{ij}$ 是从 $M_i$ 到 $M_j$ 的边的权重，如果不存在这样的边，则 $W_{ij} = 0$。\n  - 有向节点-边关联矩阵 $B \\in \\mathbb{R}^{6 \\times 11}$：如果边 $e$ 离开节点 $M_v$，则 $B_{v,e} = -1$；如果边 $e$ 进入节点 $M_v$，则 $B_{v,e} = +1$；否则 $B_{v,e} = 0$。\n- **任务**：\n  1. 计算 $A^2$。\n  2. 使用 $B$ 确定每个节点的入度和出度。\n  3. 定义 $S^{\\star} = \\{i \\in \\{1,2,3,4,5,6\\} \\mid \\text{出度}(M_i) > \\text{入度}(M_i)\\}$。\n  4. 计算 $S = \\sum_{i \\in S^{\\star}} (A^2)_{ii}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学性**：问题使用了图论中的标准定义（邻接矩阵、关联矩阵、度），并将其应用于代谢网络，这是生物信息学中的一个主流应用。这些概念在数学上是严谨的。\n- **适定性**：图结构被明确定义。矩阵的定义和后续的计算是明确的，并导向唯一的解。\n- **客观性**：问题以精确的数学和图论术语陈述，不含主观语言。\n- **完整性和一致性**：提供了所有必要的信息（节点、边、权重、矩阵定义）。矩阵的维度（6个节点，11条边）与数据一致。没有矛盾之处。\n\n### 步骤3：结论和行动\n问题有效。现在将提供完整的解决方案。\n\n第一步是构建所要求的三个矩阵：邻接矩阵 $A$、加权邻接矩阵 $W$ 和有向节点-边关联矩阵 $B$。节点从1到6进行索引，分别对应于代谢物 $M_1$ 到 $M_6$。\n\n邻接矩阵 $A$ 的元素 $A_{ij}=1$（如果存在从 $M_i$ 到 $M_j$ 的有向边）。根据给定的边：\n- 从 $M_1$ 出发：到 $M_2, M_3, M_4$。第1行为 $(0, 1, 1, 1, 0, 0)$。\n- 从 $M_2$ 出发：到 $M_3, M_5$。第2行为 $(0, 0, 1, 0, 1, 0)$。\n- 从 $M_3$ 出发：到 $M_1, M_4$。第3行为 $(1, 0, 0, 1, 0, 0)$。\n- 从 $M_4$ 出发：到 $M_5$。第4行为 $(0, 0, 0, 0, 1, 0)$。\n- 从 $M_5$ 出发：到 $M_3, M_6$。第5行为 $(0, 0, 1, 0, 0, 1)$。\n- 从 $M_6$ 出发：到 $M_2$。第6行为 $(0, 1, 0, 0, 0, 0)$。\n因此，邻接矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  1  1  1  0  0 \\\\\n0  0  1  0  1  0 \\\\\n1  0  0  1  0  0 \\\\\n0  0  0  0  1  0 \\\\\n0  0  1  0  0  1 \\\\\n0  1  0  0  0  0\n\\end{pmatrix}\n$$\n加权邻接矩阵 $W$ 的元素等于边的权重：\n$$\nW = \\begin{pmatrix}\n0  1.0  0.7  0.6  0  0 \\\\\n0  0  0.5  0  1.2  0 \\\\\n1.5  0  0  2.0  0  0 \\\\\n0  0  0  0  1.0  0 \\\\\n0  0  0.75  0  0  0.8 \\\\\n0  0.9  0  0  0  0\n\\end{pmatrix}\n$$\n有向节点-边关联矩阵 $B$ 是一个 $6 \\times 11$ 的矩阵，其中列对应于边 $e_1, \\dots, e_{11}$，行对应于节点 $M_1, \\dots, M_6$：\n$$\nB = \\begin{pmatrix}\n-1  0  1  0  0  0  0  0  0  -1  -1 \\\\\n1  -1  0  0  0  0  -1  0  1  0  0 \\\\\n0  1  -1  -1  0  1  0  0  0  0  1 \\\\\n0  0  0  1  -1  0  0  0  0  1  0 \\\\\n0  0  0  0  1  -1  1  -1  0  0  0 \\\\\n0  0  0  0  0  0  0  1  -1  0  0\n\\end{pmatrix}\n$$\n接下来，我们计算 $A^2 = A \\times A$：\n$$\nA^2 = \\begin{pmatrix}\n0  1  1  1  0  0 \\\\\n0  0  1  0  1  0 \\\\\n1  0  0  1  0  0 \\\\\n0  0  0  0  1  0 \\\\\n0  0  1  0  0  1 \\\\\n0  1  0  0  0  0\n\\end{pmatrix}\n\\begin{pmatrix}\n0  1  1  1  0  0 \\\\\n0  0  1  0  1  0 \\\\\n1  0  0  1  0  0 \\\\\n0  0  0  0  1  0 \\\\\n0  0  1  0  0  1 \\\\\n0  1  0  0  0  0\n\\end{pmatrix}\n$$\n计算乘积：\n$$\nA^2 = \\begin{pmatrix}\n(0+0+1+0+0+0)  (0+0+0+0+0+0)  (0+1+0+0+0+0)  (0+0+1+0+0+0)  (0+1+0+1+0+0)  (0+0+0+0+0+0) \\\\\n(0+0+1+0+0+0)  (0+0+0+0+0+0)  (0+0+0+0+1+0)  (0+0+1+0+0+0)  (0+0+0+0+0+0)  (0+0+0+0+1+0) \\\\\n(0+0+0+0+0+0)  (1+0+0+0+0+0)  (1+0+0+0+0+0)  (1+0+0+0+0+0)  (0+0+0+1+0+0)  (0+0+0+0+0+0) \\\\\n(0+0+0+0+0+0)  (0+0+0+0+0+0)  (0+0+0+0+1+0)  (0+0+0+0+0+0)  (0+0+0+0+0+0)  (0+0+0+0+1+0) \\\\\n(0+0+1+0+0+0)  (0+0+0+0+0+1)  (0+0+0+0+0+0)  (0+0+1+0+0+0)  (0+0+0+0+0+0)  (0+0+0+0+0+0) \\\\\n(0+0+0+0+0+0)  (0+0+0+0+0+0)  (0+1+0+0+0+0)  (0+0+0+0+0+0)  (0+1+0+0+0+0)  (0+0+0+0+0+0)\n\\end{pmatrix}\n$$\n$$\nA^2 = \\begin{pmatrix}\n1  0  1  1  2  0 \\\\\n1  0  1  1  0  1 \\\\\n0  1  1  1  1  0 \\\\\n0  0  1  0  0  1 \\\\\n1  1  0  1  0  0 \\\\\n0  0  1  0  1  0\n\\end{pmatrix}\n$$\n对角线上的元素 $(A^2)_{ii}$ 是 $(A^2)_{11}=1$, $(A^2)_{22}=0$, $(A^2)_{33}=1$, $(A^2)_{44}=0$, $(A^2)_{55}=0$ 和 $(A^2)_{66}=0$。\n\n接下来，我们通过计算关联矩阵 $B$ 每行中 $+1$（入度）和 $-1$（出度）的数量来确定每个节点的入度和出度。\n- 对于 $M_1$（第1行）：$\\text{deg}_{\\text{in}}(M_1) = 1$（一个 $+1$）；$\\text{deg}_{\\text{out}}(M_1) = 3$（三个 $-1$）。\n- 对于 $M_2$（第2行）：$\\text{deg}_{\\text{in}}(M_2) = 2$（两个 $+1$）；$\\text{deg}_{\\text{out}}(M_2) = 2$（两个 $-1$）。\n- 对于 $M_3$（第3行）：$\\text{deg}_{\\text{in}}(M_3) = 3$（三个 $+1$）；$\\text{deg}_{\\text{out}}(M_3) = 2$（两个 $-1$）。\n- 对于 $M_4$（第4行）：$\\text{deg}_{\\text{in}}(M_4) = 2$（两个 $+1$）；$\\text{deg}_{\\text{out}}(M_4) = 1$（一个 $-1$）。\n- 对于 $M_5$（第5行）：$\\text{deg}_{\\text{in}}(M_5) = 2$（两个 $+1$）；$\\text{deg}_{\\text{out}}(M_5) = 2$（两个 $-1$）。\n- 对于 $M_6$（第6行）：$\\text{deg}_{\\text{in}}(M_6) = 1$（一个 $+1$）；$\\text{deg}_{\\text{out}}(M_6) = 1$（一个 $-1$）。\n\n集合 $S^{\\star}$ 包含出度严格大于入度的索引 $i$。\n- 对于 $i=1$：$\\text{deg}_{\\text{out}}(M_1) = 3 > \\text{deg}_{\\text{in}}(M_1) = 1$。所以，$1 \\in S^{\\star}$。\n- 对于所有其他索引 $i \\in \\{2, 3, 4, 5, 6\\}$，出度不严格大于入度。\n因此，$S^{\\star} = \\{1\\}$。\n\n最后，我们计算标量 $S = \\sum_{i \\in S^{\\star}} (A^2)_{ii}$。\n由于 $S^{\\star} = \\{1\\}$，该和只包含一项：\n$$\nS = (A^2)_{11}\n$$\n从计算出的矩阵 $A^2$ 中，位置 $(1,1)$ 的元素是 $(A^2)_{11} = 1$。这个值表示从节点 $M_1$ 回到自身的长度为2的路径数量，这对应于环路 $M_1 \\to M_3 \\to M_1$。\n\n因此，$S$ 的值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "4570479"}, {"introduction": "在生物网络中识别关键节点是一个常见目标，通常通过中心性度量来实现。然而，标准的中心性定义在应用于真实的、常常是非连通的网络时可能会产生误导性结果。此练习通过一个基因调控网络的实例，探讨了经典接近中心性的局限性，并引入了更为稳健的调和中心性，以更准确地评估节点的全局可达性。[@problem_id:4570485]", "problem": "在一个用于生物信息学和医疗数据分析的基因调控网络 (Gene Regulatory Network, GRN) 中，考虑一个无向、无权、简单图 $G=(V,E)$ 来模拟基因间的调控影响，其中 $V=\\{G_1,G_2,G_3,G_4,G_5,G_6,G_7\\}$ 且 $E=\\{\\{G_1,G_2\\},\\{G_2,G_3\\},\\{G_3,G_4\\},\\{G_4,G_5\\},\\{G_6,G_7\\}\\}$。因此，$G$ 有两个连通分量：一个包含 $5$ 个节点 $\\{G_1,G_2,G_3,G_4,G_5\\}$ 的路径，以及一个包含 $2$ 个节点 $\\{G_6,G_7\\}$ 的边。节点 $u$ 和 $v$ 之间的最短路径距离 $d(u,v)$ 定义为从 $u$ 到 $v$ 的任何路径上的最小边数，如果不存在路径，则 $d(u,v)=+\\infty$。\n\n在基于网络的生物标志物发现中，一个常见的流程通过反转到其他节点的总距离来计算节点 $u$ 的类紧密中心性分数，但为了避免 $+\\infty$，它将总和限制在包含 $u$ 的连通分量内（即，它忽略了从 $u$ 无法到达的节点）。在此设置中，考虑两个基因 $G_3$（5节点路径的中间节点）和 $G_6$（2节点分量的一个端点）。仅使用上述定义和图距离的基本原理，构建评估该流程的“分量限制”类紧密中心性量所需的距离，并论证为什么在优先选择全局可达基因方面，比较这些量可能会产生误导。\n\n然后，提出了一个有原则的替代方案，其思想是：每个目标节点 $v\\neq u$ 对节点 $u$ 的可达性分数的贡献应随着 $d(u,v)$ 的增加而减少，当 $v$ 不可达时（即当 $d(u,v)=+\\infty$ 时）应恰好为 $0$，并且该分数应进行归一化，以使值在大小为 $|V|=7$ 的整个图上具有可比性。使用此替代方案，计算 $G_3$ 和 $G_6$ 的归一化分数。\n\n哪个选项正确地指出了分量限制方法的缺陷，并为 $G_3$ 和 $G_6$ 提供了正确的替代定义和正确的归一化值？\n\nA. 分量限制方法因忽略其全局不可达性而高估了微小分量中的节点；一个有原则的修正是使用调和紧密中心性分数，该分数对所有 $v\\neq u$ 的 $\\frac{1}{d(u,v)}$ 求和（约定 $\\frac{1}{+\\infty}=0$），并通过除以 $|V|-1$ 进行归一化。这得到 $H(G_6)=\\frac{1}{6}$ 和 $H(G_3)=\\frac{1}{2}$。\n\nB. 分量限制方法仅仅因为 $+\\infty$ 难以汇总而产生误导；修正是排除不可达节点并按分量大小重新缩放，这得到 $H(G_6)=1$ 和 $H(G_3)=\\frac{2}{3}$。\n\nC. 分量限制方法失败是因为 $+\\infty$ 破坏了分母；修正是将分母中的 $+\\infty$ 距离替换为 $0$ 并继续计算，得到 $H(G_6)=0$ 和 $H(G_3)=\\frac{4}{6}$。\n\nD. 分量限制方法失败；修正是直接将距离平均为 $\\frac{1}{|V|-1}\\sum_{v\\neq u} d(u,v)$ 并偏好较小的平均值，得到 $H(G_6)=1$ 和 $H(G_3)=6$。", "solution": "用户希望一位严谨细致的STEM教授来验证一个关于生物信息学中图论术语的问题陈述，然后解决它。该问题涉及一个模拟基因调控网络的图 $G=(V,E)$。\n\n### 步骤 1: 提取已知条件\n- 图类型：无向、无权、简单图 $G=(V,E)$。\n- 顶点集：$V=\\{G_1, G_2, G_3, G_4, G_5, G_6, G_7\\}$，因此节点总数为 $|V|=7$。\n- 边集：$E=\\{\\{G_1,G_2\\}, \\{G_2,G_3\\}, \\{G_3,G_4\\}, \\{G_4,G_5\\}, \\{G_6,G_7\\}\\}$。\n- 图结构：图 $G$ 有两个连通分量。\n    - 分量 1 ($C_1$)：一个包含 5 个顶点的路径，$G_1-G_2-G_3-G_4-G_5$。其顶点集为 $V_1 = \\{G_1, G_2, G_3, G_4, G_5\\}$。\n    - 分量 2 ($C_2$)：一条边（一个包含 2 个顶点的路径），$G_6-G_7$。其顶点集为 $V_2 = \\{G_6, G_7\\}$。\n- 距离度量：最短路径距离 $d(u,v)$ 是从 $u$ 到 $v$ 的路径上的最小边数。\n- 不可达节点的距离约定：如果 $u$ 和 $v$ 之间不存在路径，则 $d(u,v) = +\\infty$。\n- 有缺陷的流程：一个节点的“分量限制”类紧密中心性分数 $u$ 是通过“反转到同一连通分量内其他节点的总距离”来计算的。\n- 提议的替代方案：一个有原则的可达性分数，其中每个节点 $v \\neq u$ 的贡献随着 $d(u,v)$ 的增加而减少，如果 $v$ 不可达（$d(u,v)=+\\infty$）则贡献为 $0$，并且该分数被归一化，以便在大小为 $|V|=7$ 的整个图上进行比较。\n- 任务：\n    1. 分析“分量限制”方法对节点 $G_3$ 和 $G_6$ 的缺陷。\n    2. 使用提议的替代定义计算 $G_3$ 和 $G_6$ 的分数。\n    3. 评估给出的选项。\n\n### 步骤 2: 使用提取的已知条件进行验证\n问题陈述在科学上是合理的、定义明确的且客观的。它基于图论（连通分量、最短路径距离、紧密中心性）和网络科学（调和中心性）中应用于生物信息学（基因调控网络）的标准、可验证的概念。图被明确定义，任务清晰明确。对“有缺陷的流程”的描述作为一个逻辑前提，引出了一个更稳健的方法，这是一种标准的教学和分析技术。替代方法的标准定义明确，并导出一个标准的、无歧义的度量。没有矛盾、缺失信息或伪科学声明。\n\n### 步骤 3: 结论和行动\n问题是有效的。将继续进行求解过程。\n\n### 推导与分析\n\n**第 1 部分：“分量限制”紧密中心性分数的分析**\n\n在连通图中，节点 $u$ 的经典紧密中心性定义为 $C(u) = \\frac{N-1}{\\sum_{v \\neq u} d(u,v)}$，其中 $N$ 是图中节点的数量。在不连通图中，此公式失效，因为 $\\sum d(u,v)$ 会变为无穷大。\n\n问题描述了一个“修正”方法：将计算限制在节点自身的连通分量内。设 $C_u$ 为包含节点 $u$ 的连通分量。分量限制的分数将是 $S_c(u) = \\frac{|C_u|-1}{\\sum_{v \\in C_u, v \\neq u} d(u,v)}$。\n\n让我们为 $G_3$ 和 $G_6$ 计算这个分数。\n\n对于节点 $G_3$：\n其分量为 $C_1 = \\{G_1, G_2, G_3, G_4, G_5\\}$，大小为 $|C_1|=5$。\n从 $G_3$ 到 $C_1$ 中其他节点的距离是：\n$d(G_3, G_2) = 1$\n$d(G_3, G_4) = 1$\n$d(G_3, G_1) = 2$\n$d(G_3, G_5) = 2$\n这些距离的总和是 $\\sum_{v \\in C_1, v \\neq G_3} d(G_3, v) = 1+1+2+2 = 6$。\n分量限制的分数是 $S_c(G_3) = \\frac{|C_1|-1}{6} = \\frac{5-1}{6} = \\frac{4}{6} = \\frac{2}{3}$。\n\n对于节点 $G_6$：\n其分量为 $C_2 = \\{G_6, G_7\\}$，大小为 $|C_2|=2$。\n从 $G_6$ 到 $C_2$ 中另一个节点的距离是：\n$d(G_6, G_7) = 1$\n这些距离的总和是 $\\sum_{v \\in C_2, v \\neq G_6} d(G_6, v) = 1$。\n分量限制的分数是 $S_c(G_6) = \\frac{|C_2|-1}{1} = \\frac{2-1}{1} = 1$。\n\n比较这些分数，$S_c(G_6) = 1 > S_c(G_3) = \\frac{2}{3}$。这个结果意味着 $G_6$ 比 $G_3$ “更中心”或“更可达”。\n\n现在，这种方法的缺陷就显而易见了：它极大地高估了小型、孤立分量中节点的重要性。$G_6$ 在其仅有两个节点的微小分量中是完全中心的，但它与网络中的其他 5 个节点完全断开连接。$G_3$ 虽然在它自己的分量中不是完全中心的，但它可以到达其他 4 个节点。通过忽略与图其余部分的可达性，分量限制的度量未能捕捉到*全局*可达性的概念，从而使得不同分量中节点之间的比较产生误导。\n\n**第 2 部分：有原则的替代方案（调和中心性）**\n\n问题提出了一个具有特定属性的替代分数：\n1.  目标节点 $v$ 对源节点 $u$ 的分数贡献随着 $d(u,v)$ 的增加而减少。\n2.  当 $d(u,v)=+\\infty$ 时，贡献恰好为 $0$。\n3.  该分数被归一化，以便在大小为 $|V|=7$ 的整个图上进行比较。\n\n如果我们采用约定 $\\frac{1}{+\\infty} = 0$，那么倒数距离之和 $\\sum_{v \\neq u} \\frac{1}{d(u,v)}$ 满足前两个属性。这个度量被称为调和中心性。\n\n问题指定了归一化以使值在整个图上具有可比性。一个标准的归一化方法是除以最大可能值，即 $|V|-1$（大小为 $|V|$ 的星形图中中心节点的分数）。因此，归一化的调和中心性为：\n$$H(u) = \\frac{1}{|V|-1} \\sum_{v \\in V, v \\neq u} \\frac{1}{d(u,v)}$$\n当 $|V|=7$ 时，归一化因子是 $\\frac{1}{7-1} = \\frac{1}{6}$。\n\n让我们为 $G_3$ 和 $G_6$ 计算这个分数。\n\n对于节点 $G_3$：\n我们需要从 $G_3$ 到 $V$ 中所有其他 $6$ 个节点的距离：\n$d(G_3, G_1)=2$, $d(G_3, G_2)=1$, $d(G_3, G_4)=1$, $d(G_3, G_5)=2$。\n$d(G_3, G_6)=+\\infty$, $d(G_3, G_7)=+\\infty$。\n倒数距离之和是：\n$\\sum_{v \\neq G_3} \\frac{1}{d(G_3,v)} = \\frac{1}{2} + \\frac{1}{1} + \\frac{1}{1} + \\frac{1}{2} + \\frac{1}{+\\infty} + \\frac{1}{+\\infty} = \\frac{1}{2} + 1 + 1 + \\frac{1}{2} + 0 + 0 = 3$。\n归一化后的分数是 $H(G_3) = \\frac{1}{6} \\times 3 = \\frac{3}{6} = \\frac{1}{2}$。\n\n对于节点 $G_6$：\n我们需要从 $G_6$ 到 $V$ 中所有其他 $6$ 个节点的距离：\n$d(G_6, G_7)=1$。\n$d(G_6, G_1)=+\\infty$, $d(G_6, G_2)=+\\infty$, $d(G_6, G_3)=+\\infty$, $d(G_6, G_4)=+\\infty$, $d(G_6, G_5)=+\\infty$。\n倒数距离之和是：\n$\\sum_{v \\neq G_6} \\frac{1}{d(G_6,v)} = \\frac{1}{1} + \\frac{1}{+\\infty} + \\frac{1}{+\\infty} + \\frac{1}{+\\infty} + \\frac{1}{+\\infty} + \\frac{1}{+\\infty} = 1 + 0 + 0 + 0 + 0 + 0 = 1$。\n归一化后的分数是 $H(G_6) = \\frac{1}{6} \\times 1 = \\frac{1}{6}$。\n\n使用调和中心性，我们发现 $H(G_3) = \\frac{1}{2} > H(G_6) = \\frac{1}{6}$。这个结果正确地反映出 $G_3$ 比孤立的 $G_6$ 更具全局可达性。\n\n### 逐项分析\n\n**A. 分量限制方法因忽略其全局不可达性而高估了微小分量中的节点；一个有原则的修正是使用调和紧密中心性分数，该分数对所有 $v\\neq u$ 的 $\\frac{1}{d(u,v)}$ 求和（约定 $\\frac{1}{+\\infty}=0$），并通过除以 $|V|-1$ 进行归一化。这得到 $H(G_6)=\\frac{1}{6}$ 和 $H(G_3)=\\frac{1}{2}$。**\n- 对缺陷的分析（“因忽略其全局不可达性而高估了微小分量中的节点”）是正确的。\n- 提议的修正方法（归一化的调和中心性）是对问题原则的正确解释。\n- 计算出的值（$H(G_3)=\\frac{1}{2}$ 和 $H(G_6)=\\frac{1}{6}$）是正确的。\n- **结论：正确**\n\n**B. 分量限制方法仅仅因为 $+\\infty$ 难以汇总而产生误导；修正是排除不可达节点并按分量大小重新缩放，这得到 $H(G_6)=1$ 和 $H(G_3)=\\frac{2}{3}$。**\n- 对缺陷的分析是肤浅的。核心问题是全局信息的丢失，而不仅仅是汇总的困难。\n- 所谓的“修正”方法正是对有缺陷的分量限制方法本身的描述。\n- 提供的值（$1$ 和 $\\frac{2}{3}$）是有缺陷方法的结果，该选项错误地将其呈现为解决方案。\n- **结论：不正确**\n\n**C. 分量限制方法失败是因为 $+\\infty$ 破坏了分母；修正是将分母中的 $+\\infty$ 距离替换为 $0$ 并继续计算，得到 $H(G_6)=0$ 和 $H(G_3)=\\frac{4}{6}$。**\n- 在紧密中心性的距离总和中用 0 替换 $d(u,v)=+\\infty$ 的提议是不合理的。大的距离应该对紧密性造成惩罚，而不是被忽略。这样做会人为地夸大紧密中心性分数。\n- 计算出的值不一致。对于 $G_3$，根据这个规则，距离总和将是 $6$，而在整个图上的紧密中心性将是 $\\frac{|V|-1}{6} = \\frac{6}{6} = 1$，而不是 $\\frac{4}{6}$。值 $H(G_6)=0$ 也是不正确的。\n- **结论：不正确**\n\n**D. 分量限制方法失败；修正是直接将距离平均为 $\\frac{1}{|V|-1}\\sum_{v\\neq u} d(u,v)$ 并偏好较小的平均值，得到 $H(G_6)=1$ 和 $H(G_3)=6$。**\n- 提议的修正方法，即在整个图上平均距离，并不能解决问题。由于存在不可达节点，总和 $\\sum d(u,v)$ 仍然是无穷大，使得平均值也为无穷大。\n- 提供的值（$1$ 和 $6$）不是平均值；它们对应于每个分量内部的距离总和，这与公式所描述的不符。该选项是语无伦次的。\n- **结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "4570485"}, {"introduction": "基因调控网络的功能通常由一些反复出现的、被称为“网络基序”的小型连接模式所决定。本练习聚焦于一个重要的基序——前馈环路（Feed-Forward Loop），并引导你辨析两种关键的计数方法：诱导匹配与非诱导匹配。通过亲手计算和比较，你将理解为何精确的图论定义对于正确评估基序的丰度及其生物学意义至关重要。[@problem_id:4570541]", "problem": "生物信息学和医学数据分析中的一个核心任务是识别和量化基因调控网络（GRN）中小的、重复出现的调控模式，通常称为网络基序。考虑以下代表一个小型GRN的有向图 $G=(V,E)$，其中 $V=\\{v_1,v_2,v_3,v_4\\}$ 是基因或转录因子，有向边表示调控影响：\n$$E=\\{v_1\\to v_2,\\; v_2\\to v_3,\\; v_1\\to v_3,\\; v_3\\to v_1,\\; v_2\\to v_4,\\; v_3\\to v_4,\\; v_2\\to v_4,\\; v_1\\to v_4\\}.$$\n关注前馈环基序（Feed-Forward Loop, FFL），它被定义为作用于三个不同节点 $\\{x,y,z\\}$ 的有向模式 $M$，其边集为 $\\{x\\to y,\\; y\\to z,\\; x\\to z\\}$。考虑两种计数方案：\n- 诱导匹配：如果由三个不同顶点组成的无序三元组 $\\{u,v,w\\}\\subseteq V$ 上的诱导子图与 $M$ 同构，即它恰好包含基序的三条边，并且在 $\\{u,v,w\\}$ 之间没有额外的边，则该三元组被计数。\n- 非诱导匹配（子图同构）：如果存在一个双射 $f:\\{x,y,z\\}\\to\\{u,v,w\\}$，使得 $f$ 作用下每条基序边的像都存在于 $E$ 中，则一个由三个不同顶点组成的无序三元组 $\\{u,v,w\\}\\subseteq V$ 被计数。在 $\\{u,v,w\\}$ 之间允许存在额外的边。\n\n从有向图、诱导子图和子图同构的核心定义出发，确定在诱导和非诱导两种方案下，$G$ 中 FFL 出现的次数，并论证在基序过表达分析中，选择一种方案而非另一种方案对生物学推断的影响。下列哪些陈述是正确的？\n\nA. 在 $G$ 中，非诱导 FFL 匹配的数量为 $4$，而诱导 FFL 匹配的数量为 $2$。\n\nB. 对于任何图和任何基序，诱导匹配产生的计数总是大于或等于非诱导匹配。\n\nC. 使用非诱导匹配可能会夸大基序计数，因为它会将在一个包含额外边的更大模式中一同出现的基序边也计算在内。\n\nD. 在 GRN 基序发现中，诱导和非诱导匹配的选择会影响过表达检验的零模型校准以及功能特异性的生物学解释。\n\nE. 在 $G$ 中，无序三元组 $\\{v_1,v_2,v_3\\}$ 构成一个诱导 FFL。", "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于图论及其在生物信息学中的应用，问题提出得很好，定义清晰，图也完全指定，表述客观。在 $E$ 的列表中出现重复的边 $v_2 \\to v_4$ 是一个形式上的冗余，但不会造成数学上的矛盾，因为集合不包含重复元素。因此，该问题是有效的，可以推导出解决方案。\n\n该问题要求我们分析给定的有向图 $G=(V,E)$，以在两种不同的计数方案下（诱导匹配和非诱导匹配）计算特定网络基序——前馈环（FFL）的出现次数。\n\n首先，让我们正式定义问题的组成部分。\n图为 $G=(V,E)$，其中：\n- 顶点集为 $V=\\{v_1,v_2,v_3,v_4\\}$。\n- 有向边集为 $E=\\{ (v_1,v_2), (v_2,v_3), (v_1,v_3), (v_3,v_1), (v_2,v_4), (v_3,v_4), (v_1,v_4) \\}$。\n\n我们感兴趣的基序是前馈环 $M$，定义在三个不同的节点 $\\{x,y,z\\}$ 上。该基序的边集为 $\\{x\\to y, y\\to z, x\\to z\\}$。在此结构中，$x$ 充当主调节器，通过中间节点 $y$ 直接和间接地影响目标 $z$。\n\n我们必须找到这个基序在 $G$ 中的所有出现。由于该基序涉及 $3$ 个节点，我们必须检查 $V$ 中所有可能的不同顶点的无序三元组。此类三元组的数量为 $\\binom{|V|}{3} = \\binom{4}{3} = 4$。这些三元组是：$\\{v_1,v_2,v_3\\}$、$\\{v_1,v_2,v_4\\}$、$\\{v_1,v_3,v_4\\}$ 和 $\\{v_2,v_3,v_4\\}$。\n\n对于每个三元组，我们将确定它是否在诱导和非诱导定义下构成 FFL 匹配。\n\n1.  **分析顶点三元组 $\\{v_1,v_2,v_3\\}$**\n    这些顶点上的诱导子图（我们称之为 $G'$）由顶点 $\\{v_1,v_2,v_3\\}$ 以及 $E$ 中连接这些顶点中任意两个的所有边组成。这些边是：$v_1\\to v_2$、$v_2\\to v_3$、$v_1\\to v_3$ 和 $v_3\\to v_1$。\n    -   **非诱导匹配：** 我们需要确定是否存在一个双射 $f:\\{x,y,z\\}\\to\\{v_1,v_2,v_3\\}$，使得 FFL 的边存在于 $G'$ 中。让我们测试映射 $x \\mapsto v_1$，$y \\mapsto v_2$，$z \\mapsto v_3$。\n        -   $x\\to y$ 需要 $v_1\\to v_2$，这在 $E$ 中。\n        -   $y\\to z$ 需要 $v_2\\to v_3$，这在 $E$ 中。\n        -   $x\\to z$ 需要 $v_1\\to v_3$，这在 $E$ 中。\n        由于所有三条所需的边都存在，这个三元组算作 **1** 个非诱导 FFL。\n    -   **诱导匹配：** 对于诱导匹配，诱导子图必须与 FFL 基序 $M$ 同构。在 $\\{v_1,v_2,v_3\\}$ 上的诱导子图的边集为 $\\{(v_1,v_2), (v_2,v_3), (v_1,v_3), (v_3,v_1)\\}$，共有 $4$ 条边。FFL 基序 $M$ 恰好有 $3$ 条边。由于边的数量不同，该诱导子图与 $M$ 不同构。额外的边 $v_3\\to v_1$ 使其不合格。因此，这个三元组**不是**一个诱导 FFL。\n\n2.  **分析顶点三元组 $\\{v_1,v_2,v_4\\}$**\n    这些顶点上的诱导子图的边集为：$v_1\\to v_2$、$v_1\\to v_4$ 和 $v_2\\to v_4$。注意，在 $E$ 中，这三个顶点的任何一对之间都没有其他边。\n    -   **非诱导匹配：** 我们测试映射 $x \\mapsto v_1$，$y \\mapsto v_2$，$z \\mapsto v_4$。\n        -   $x\\to y$ 需要 $v_1\\to v_2$，这在 $E$ 中。\n        -   $y\\to z$ 需要 $v_2\\to v_4$，这在 $E$ 中。\n        -   $x\\to z$ 需要 $v_1\\to v_4$，这在 $E$ 中。\n        所有所需的边都存在，所以这个三元组算作 **1** 个非诱导 FFL。\n    -   **诱导匹配：** 在 $\\{v_1,v_2,v_4\\}$ 上的诱导子图的边集为 $\\{(v_1,v_2), (v_2,v_4), (v_1,v_4)\\}$。这个集合恰好包含 $3$ 条边，并且在映射 $x \\mapsto v_1$，$y \\mapsto v_2$，$z \\mapsto v_4$ 下与 FFL 基序结构完美对应。因此，该诱导子图与 $M$ 同构。这个三元组算作 **1** 个诱导 FFL。\n\n3.  **分析顶点三元组 $\\{v_1,v_3,v_4\\}$**\n    这些顶点上的诱导子图的边集为：$v_1\\to v_3$、$v_3\\to v_1$、$v_1\\to v_4$ 和 $v_3\\to v_4$。\n    -   **非诱导匹配：** 我们测试映射 $x \\mapsto v_1$，$y \\mapsto v_3$，$z \\mapsto v_4$。\n        -   $x\\to y$ 需要 $v_1\\to v_3$，这在 $E$ 中。\n        -   $y\\to z$ 需要 $v_3\\to v_4$，这在 $E$ 中。\n        -   $x\\to z$ 需要 $v_1\\to v_4$，这在 $E$ 中。\n        所有所需的边都存在，所以这个三元组算作 **1** 个非诱导 FFL。\n    -   **诱导匹配：** 该诱导子图有 $4$ 条边：$\\{(v_1,v_3), (v_3,v_1), (v_1,v_4), (v_3,v_4)\\}$。由于额外的边 $v_3\\to v_1$，这与有 $3$ 条边的 FFL 基序不同构。因此，这个三元组**不是**一个诱导 FFL。\n\n4.  **分析顶点三元组 $\\{v_2,v_3,v_4\\}$**\n    这些顶点上的诱导子图的边集为：$v_2\\to v_3$、$v_2\\to v_4$ 和 $v_3\\to v_4$。\n    -   **非诱导匹配：** 我们测试映射 $x \\mapsto v_2$，$y \\mapsto v_3$，$z \\mapsto v_4$。\n        -   $x\\to y$ 需要 $v_2\\to v_3$，这在 $E$ 中。\n        -   $y\\to z$ 需要 $v_3\\to v_4$，这在 $E$ 中。\n        -   $x\\to z$ 需要 $v_2\\to v_4$，这在 $E$ 中。\n        所有所需的边都存在，所以这个三元组算作 **1** 个非诱导 FFL。\n    -   **诱导匹配：** 该诱导子图的边集为 $\\{(v_2,v_3), (v_3,v_4), (v_2,v_4)\\}$。这个集合恰好包含 $3$ 条边，并且在映射 $x \\mapsto v_2$，$y \\mapsto v_3$，$z \\mapsto v_4$ 下与 FFL 基序同构。这个三元组算作 **1** 个诱导 FFL。\n\n**计数总结：**\n-   非诱导 FFL 匹配的数量：$1+1+1+1 = 4$。\n-   诱导 FFL 匹配的数量：$0+1+0+1 = 2$。\n\n现在我们评估每个陈述。\n\n**A. 在 $G$ 中，非诱导 FFL 匹配的数量为 $4$，而诱导 FFL 匹配的数量为 $2$。**\n我们的推导表明，非诱导匹配的计数为 $4$，诱导匹配的计数为 $2$。该陈述是我们研究结果的精确总结。\n**结论：正确**\n\n**B. 对于任何图和任何基序，诱导匹配产生的计数总是大于或等于非诱导匹配。**\n令 $S_{ind}$ 为构成基序 $M$ 的诱导匹配的顶点子集集合。令 $S_{non-ind}$ 为构成非诱导匹配的顶点子集集合。根据定义，如果一个顶点子集 $\\{v_1, ..., v_k\\}$ 的诱导子图与 $M$ 同构，则它构成一个诱导匹配。这意味着边集与 $M$ 的边集*完全*相同。非诱导匹配只要求 $M$ 的边是诱导子图中边的*子集*。因此，如果一个子图是诱导匹配，它也必须是一个非诱导匹配。这意味着 $S_{ind} \\subseteq S_{non-ind}$，因此 $|S_{ind}| \\leq |S_{non-ind}|$。该陈述声称了相反的关系，即 $|S_{ind}| \\geq |S_{non-ind}|$，这从根本上是错误的。我们对这个问题的计算提供了一个反例：$2  4$。\n**结论：错误**\n\n**C. 使用非诱导匹配可能会夸大基序计数，因为它会将在一个包含额外边的更大模式中一同出现的基序边也计算在内。**\n这个陈述准确地描述了两种计数方案之间的区别。非诱导（或子图同构）计数包括其诱导子图包含基序模式的任何顶点集。这明确允许存在额外的边。“夸大”一词正确地描述了非诱导计数大于或等于诱导计数这一事实，其差异来自于那些包含基序但连接更紧密的子图。我们对三元组 $\\{v_1, v_2, v_3\\}$ 的分析就是这一原则的直接例子，由于额外的边 $v_3 \\to v_1$，它被计为非诱导匹配，但不是诱导匹配。\n**结论：正确**\n\n**D. 在 GRN 基序发现中，诱导和非诱导匹配的选择会影响过表达检验的零模型校准以及功能特异性的生物学解释。**\n这个陈述讨论了生物信息学中的实际影响。\n-   **零模型校准：** 过表达分析将真实网络中观察到的基序计数与随机化零模型中的预期计数进行比较。“基序”的定义（诱导与非诱导）决定了计数的内容。在随机图中，诱导基序的预期频率通常远低于非诱导基序，尤其是在稠密图中。因此，观察计数的统计显著性（例如 Z-score）关键取决于使用哪种定义来校准零模型。\n-   **生物学解释：** 诱导基序代表一个特定的、孤立的功能单元。其他边的缺失可能与所需边的存在同样具有生物学意义，这意味着高度的特异性。非诱导基序代表嵌入在更复杂的局部电路中的核心模式。这表明其功能可能受到其他相互作用的调节，指示了一种不同的、可能特异性较低或更复杂的生物学作用。\n因此，定义的选择对统计评估和得出的功能假设都有深远的影响。\n**结论：正确**\n\n**E. 在 $G$ 中，无序三元组 $\\{v_1,v_2,v_3\\}$ 构成一个诱导 FFL。**\n正如我们在对第一个三元组的分析中确定的，在 $\\{v_1,v_2,v_3\\}$ 上的诱导子图包含边 $\\{(v_1,v_2), (v_2,v_3), (v_1,v_3), (v_3,v_1)\\}$。这个有 $4$ 条边的子图与有 $3$ 条边的 FFL 基序 $M$ 不同构。因此，三元组 $\\{v_1,v_2,v_3\\}$ 不构成诱导 FFL。\n**结论：错误**\n\n最终正确选项总结：A、C 和 D。", "answer": "$$\\boxed{ACD}$$", "id": "4570541"}]}