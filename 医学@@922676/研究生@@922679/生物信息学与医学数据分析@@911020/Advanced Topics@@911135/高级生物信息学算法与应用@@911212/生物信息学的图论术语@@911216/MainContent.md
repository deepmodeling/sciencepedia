## 引言
在海量生物医学数据的时代，如何从复杂的相互作用中提取有意义的模式和知识，已成为生物信息学和医学数据分析的核心挑战。图论作为一门研究实体及其关系的数学分支，为此提供了一个强大而直观的计算框架。通过将基因、蛋白质、代谢物等生物分子抽象为“节点”，将其间的相互作用抽象为“边”，我们能够将错综复杂的生物系统转化为结构化的网络，从而利用成熟的算法进行分析、可视化和预测。

然而，图论的术语和模型纷繁多样，对于初学者或希望应用这些工具的研究者而言，常常存在一个知识鸿沟：如何选择合适的图模型来表述一个特定的生物学问题？各种中心性指标的生物学含义是什么？不同的[网络结构](@entry_id:265673)（如环路、社区）又对应着怎样的生物学功能？

本文旨在系统性地填补这一鸿沟。我们将带领读者开启一段从理论到应用的旅程，全面掌握生物信息学分析中不可或缺的图论知识。在“原理与机制”一章中，我们将奠定基础，详细阐述图的[基本类](@entry_id:158335)型、矩阵表示方法、关键的节点[中心性度量](@entry_id:144795)以及[网络拓扑结构](@entry_id:141407)。随后的“应用与跨学科连接”一章将展示这些理论的威力，通过基因组组装、系统生物学和图机器学习等前沿实例，揭示图论如何解决真实的生物医学问题。最后，通过“动手实践”部分，读者将有机会亲手应用所学知识，巩固对核心概念的理解。

## 原理与机制

在生物信息学和医学数据分析中，图论提供了一个强大而灵活的框架，用于对复杂的生物系统进行建模、分析和解释。从[基因调控](@entry_id:143507)到蛋白质相互作用，再到代谢途径，生物实体及其关系可以被抽象为节点和边，从而揭示隐藏在海量数据背后的结构和[功能原理](@entry_id:172891)。本章将系统地阐述在[生物网络分析](@entry_id:746818)中至关重要的图论术语、原理和机制，从基本定义出发，逐步深入到高级模型和分析方法。

### 生物信息学中的[基本图](@entry_id:160617)模型

图论模型的选择对生物学问题的表述和分析至关重要。一个图 $G$ 被形式化地定义为一个[有序对](@entry_id:269702) $G=(V, E)$，其中 $V$ 是一个**顶点**（vertices）或**节点**（nodes）的集合，代表生物实体（如基因、蛋白质）；$E$ 是一个**边**（edges）的集合，代表它们之间的关系。根据边的性质，可以区分几种基本的图模型 [@problem_id:4570504]。

- **简单图（Simple Graph）**：在[简单图](@entry_id:274882)中，任意两个顶点之间最多只能有一条边，且不存在连接顶点自身的边（即**自环**, self-loop）。形式上，[边集](@entry_id:267160) $E$ 是 $V$ 中所有两元素子集的集合的一个子集，即 $E \subseteq \{\{u,v\} \mid u,v \in V, u \neq v\}$。例如，在构建一个高层次的**蛋白质-蛋白质相互作用（Protein-Protein Interaction, PPI）网络**时，研究者可能会将来自多个数据库的相同相互作用证据合并为一条边，并忽略蛋白质与自身的相互作用（如同源二聚体），从而得到一个[简单图](@entry_id:274882)。这简化了网络，但牺牲了关于证据来源多样性的信息。

- **[多重图](@entry_id:261576)（Multigraph）**：与[简单图](@entry_id:274882)不同，[多重图](@entry_id:261576)允许任意两个顶点之间存在多条**平行边**（parallel edges）。这在生物学中非常有用，因为它可以保留不同来源的证据。例如，在一个综合性[PPI网络](@entry_id:271273)中，如果酵母双杂交实验和亲和纯化质谱实验都证实了蛋白质A和B之间的相互作用，那么我们可以在代表A和B的节点之间绘制两条平行的边。形式上，这可以通过将[边集](@entry_id:267160) $E$ 定义为一个多重集，或使用一个重数函数 $\mu: \{\{u,v\} \mid u,v \in V\} \to \mathbb{N}_0$ 来表示，其中 $\mu(\{u,v\})$ 表示 $u$ 和 $v$ 之间的平行边数量 [@problem_id:4570504]。

- **[无向图](@entry_id:270905)（Undirected Graph）** 与 **[有向图](@entry_id:272310)（Directed Graph）**：边的方向性是另一个关键特征。如果关系是对称的，如蛋白质之间的物理结合，通常使用**[无向图](@entry_id:270905)**，其中边 $\{u,v\}$ 表示 $u$ 和 $v$ 之间的相互关系，没有方向之分。相反，如果关系具有方向性，如**基因调控网络（Gene Regulatory Network, GRN）**中转录因子 $u$ 调控靶基因 $v$ 的表达，则应使用**有向图**。在[有向图](@entry_id:272310)中，边是顶点的[有序对](@entry_id:269702)，$(u,v) \in E$，表示一个从 $u$ 到 $v$ 的有向关系。[有向图](@entry_id:272310)也允许[自环](@entry_id:274670)，例如 $(u,u)$，这在GRN中可以表示一个基因对其自身表达的调控（即自调控）[@problem_id:4570504]。

- **[加权图](@entry_id:274716)（Weighted Graph）** 与 **标记图（Labeled Graph）**：为了捕捉关系的更多定量或定性信息，我们可以在图上添加属性。在**[加权图](@entry_id:274716)**中，每条边 $e$ 都被赋予一个数值权重 $w(e)$，通常来自一个权重函数 $w: E \to \mathbb{R}$。例如，在基于重叠-布局-一致性（overlap-layout-consensus）策略的基因组组装中，可以构建一个**序列重叠图**，其中顶点代表测序读长（reads），边连接有重叠的读长。边的权重可以是重叠的长度或比对得分，这对组装算法至关重要 [@problem_id:4570504]。在**标记图**中，顶点和/或边可以被赋予非数值的**标签**。一个典型的例子是用于基因组组装的**[de Bruijn图](@entry_id:263552)**。在这种图中，每个顶点被一个 $(k-1)$-mer（长度为 $k-1$ 的[核酸](@entry_id:164998)序列）标记，而每条有向边则对应一个 $k$-mer，该边的起点和终点分别由这个 $k$-mer 的前缀和后缀 $(k-1)$-mer 标记 [@problem_id:4570504]。

### [图的矩阵表示](@entry_id:265803)

为了进行计算分析，图需要用[数据结构](@entry_id:262134)来表示。矩阵是其中最基本和最强大的表示方法之一，它将图的拓扑结构转化为代数对象。

- **邻接矩阵（Adjacency Matrix）**：对于一个有 $n=|V|$ 个顶点的图，其邻接矩阵 $A$ 是一个 $n \times n$ 的方阵。对于一个简单的无向图，如果顶点 $i$ 和 $j$ 之间有边，则 $A_{ij} = A_{ji} = 1$，否则为 $0$。矩阵的对称性 ($A = A^T$) 反映了边的无向性。对于[有向图](@entry_id:272310)，如果存在从 $i$ 到 $j$ 的边，则 $A_{ij} = 1$，否则为 $0$；此时 $A$ 通常是非对称的。对于[多重图](@entry_id:261576)，[邻接矩阵](@entry_id:151010)的元素 $A_{ij}$ 可以被定义为连接 $i$ 和 $j$ 的平行边数量，此时[矩阵元](@entry_id:186505)素为非负整数 [@problem_id:4570538]。

- **加权邻接矩阵（Weighted Adjacency Matrix）**：这是邻接矩阵的自然推广，用于[加权图](@entry_id:274716)。[矩阵元](@entry_id:186505)素 $W_{ij}$ 直接存储连接顶点 $i$ 和 $j$ 的边的权重。在处理加权[多重图](@entry_id:261576)时，一种常见的策略是将所有平行边的权重进行聚合，例如求和。例如，在一个[基因调控网络](@entry_id:150976)中，如果有多条证据支持从基因 $i$ 到基因 $j$ 的调控，并且每条证据都有一个[置信度](@entry_id:267904)分数（权重），那么 $W_{ij}$ 可以是这些分数的总和 [@problem_id:4570538]。

- **关联矩阵（Incidence Matrix）**：[关联矩阵](@entry_id:263683) $B$ 描述了顶点和边之间的关系。对于一个有 $n$ 个顶点和 $m$ 条边的图， $B$ 是一个 $n \times m$ 的矩阵。对于[无向图](@entry_id:270905)，如果顶点 $i$ 是边 $e$ 的一个端点，则 $B_{ie} = 1$，否则为 $0$。对于[有向图](@entry_id:272310)，通常采用一种有向约定：如果边 $e=(i, j)$ 从顶点 $i$（尾部, tail）指向顶点 $j$（头部, head），则在 $e$ 对应的列中，$B_{ie} = -1$，$B_{je} = +1$，所有其他项为 $0$。这种表示法有几个重要特性：
    1.  它自然地处理了[多重图](@entry_id:261576)，因为每条边（即使是平行的）都有自己独立的列。
    2.  对于有向图，每列的和为 $0$。
    3.  第 $i$ 行的和等于顶点 $i$ 的**入度**（in-degree）减去其**[出度](@entry_id:263181)**（out-degree），从而在顶点层面编码了边的方向性 [@problem_id:4570549] [@problem_id:4570538]。

一个深刻的联系存在于[关联矩阵](@entry_id:263683)和**图拉普拉斯矩阵（Graph Laplacian）**之间。对于一个无自环的无向[多重图](@entry_id:261576)，如果我们任意地为每条边指定一个方向来构建[有向关联矩阵](@entry_id:274962) $B$，那么乘积 $L = B B^T$ 是一个与边的任意方向选择无关的矩阵。这个矩阵 $L$ 正是图的组合拉普拉斯矩阵。其对角线元素 $L_{ii}$ 是顶点 $i$ 的度数，非对角[线元](@entry_id:196833)素 $L_{ij}$ ($i \neq j$) 是连接 $i$ 和 $j$ 的平行边数量的负值。拉普拉斯矩阵在[谱图论](@entry_id:150398)和网络聚类等领域扮演着核心角色 [@problem_id:4570538]。

### 节点表征：度与中心性

量化网络中单个节点的重要性是[网络分析](@entry_id:139553)的基石。多种**中心性（centrality）**指标从不同角度捕捉节点的“重要性”。

#### 基于度的指标

最简单的中心性是**[度中心性](@entry_id:271299)（degree centrality）**，它只考虑节点的直接邻居。
- 在[无向图](@entry_id:270905)中，顶点 $i$ 的**度（degree）** $d_i$ 是与其相连的边的数量，可以通过[邻接矩阵](@entry_id:151010)计算：$d_i = \sum_{j=1}^{n} A_{ij}$。
- 在有向图中，我们区分**入度（in-degree）** $k_i^{\text{in}}$ 和**出度（out-degree）** $k_i^{\text{out}}$。入度是进入顶点 $i$ 的边的数量 ($k_i^{\text{in}} = \sum_{j=1}^{n} A_{ji}$)，[出度](@entry_id:263181)是离开顶点 $i$ 的边的数量 ($k_i^{\text{out}} = \sum_{j=1}^{n} A_{ij}$) [@problem_id:4570549]。在[PPI网络](@entry_id:271273)中，高度数的蛋白质被称为**集散节点（hubs）**，它们通常在[生物过程](@entry_id:164026)中扮演关键角色，且往往是必不可少的 [@problem_id:4570489]。

对于加权网络，度的概念可以推广为**强度（strength）**或**加权度（weighted degree）**。例如，一个节点的出强度可以定义为所有从该节点出发的边的权重之和。在处理有符号权重（如[基因调控](@entry_id:143507)中的激活和抑制）的网络时，区分两种强度非常重要：一种是权重的代数和，反映净调控效应；另一种是权重绝对值的和，反映总调控强度。

一个在生物信息学中必须正视的现实是[测量噪声](@entry_id:275238)。假设我们测量的权重 $\tilde{W}_{ij}$ 是真实权重 $W_{ij}$ 加上一个独立的、均值为零的噪声 $\varepsilon_{ij}$。在这种情况下：
1.  由于期望的线性性质，测量的**加权度**（权重的代数和）是真实加权度的无偏估计，即 $\mathbb{E}[\sum_j \tilde{W}_{ij}] = \sum_j W_{ij}$。
2.  然而，测量的**强度**（权重绝对值的和）却是一个有偏估计。根据琴生不等式（Jensen's inequality），由于[绝对值函数](@entry_id:160606) $|x|$ 是一个[凸函数](@entry_id:143075)，我们有 $\mathbb{E}[|\tilde{W}_{ij}|] = \mathbb{E}[|W_{ij} + \varepsilon_{ij}|] \ge |W_{ij}|$。只要噪声方差大于零，这个不等式通常是严格的。这意味着噪声会系统性地抬高测量的节点强度。
3.  此外，如果网络结构本身是通过对噪声测量值设置阈值 $\tau$（即当 $|\tilde{W}_{ij}| \ge \tau$ 时认为存在一条边）来推断的，那么测量的度（[入度和出度](@entry_id:273421)）会成为真实度的有偏估计。噪声可能导致原本不存在的边被错误地检测出来（**[假阳性](@entry_id:635878)**），或导致存在的边被遗漏（**假阴性**）。因此，[测量噪声](@entry_id:275238)不仅影响权重，还能改变推断出的[网络拓扑结构](@entry_id:141407) [@problem_id:4570549]。

#### 基于路径的中心性

这些指标考虑了节点在网络全局路径结构中的位置。

- **[介数中心性](@entry_id:267828)（Betweenness Centrality）**：一个节点 $v$ 的介数中心性 $C_B(v)$ 衡量的是网络中所有节点对之间的最短路径经过 $v$ 的比例。其计算公式为 $C_B(v) = \sum_{s \neq v \neq t} \frac{\sigma_{st}(v)}{\sigma_{st}}$，其中 $\sigma_{st}$ 是从节点 $s$ 到 $t$ 的最短路径总数，而 $\sigma_{st}(v)$ 是其中经过 $v$ 的路径数。[介数中心性](@entry_id:267828)高的节点是网络中的**瓶颈（bottlenecks）**，它们连接了不同的模块或社区。在PPI网络中，这样的蛋白质可能是信号通路的关键中继，或药物靶标的潜在候选者，因为扰乱它们可能会中断模块间的通信 [@problem_id:4570489] [@problem_id:4570537]。

- **[紧密中心性](@entry_id:272855)（Closeness Centrality）**：一个节点 $v$ 的[紧密中心性](@entry_id:272855) $C_C(v)$ 衡量的是它到网络中所有其他节点的平均距离的远近。其标准定义为 $C_C(v) = (n-1) / \sum_{u \neq v} d(v,u)$，其中 $d(v,u)$ 是从 $v$ 到 $u$ 的[最短路径距离](@entry_id:754797)。[紧密中心性](@entry_id:272855)高的节点位于网络的“中心”，能够高效地将信息传播到整个网络，或迅速地受到网络中任何地方扰动的影响 [@problem_id:4570489]。

#### 递归中心性

这类指标基于一个递归思想：一个节点的重要性取决于其邻居的重要性。

- **[特征向量中心性](@entry_id:155536)（Eigenvector Centrality）**：该中心性为每个节点赋予一个分数，这个分数正比于其邻居节点分数之和。形式上，中心性得分向量 $\mathbf{x}$ 是邻接矩阵 $A$ 的[主特征向量](@entry_id:264358)，满足方程 $A\mathbf{x} = \lambda \mathbf{x}$，其中 $\lambda$ 是最大的特征值。这个指标不仅奖励连接多的节点，更奖励那些连接到其他重要节点的节点。在PPI网络中，它能识别出与多个hub蛋白相互作用的蛋白质 [@problem_id:4570489]。

- **[PageRank](@entry_id:139603)**：作为[特征向量中心性](@entry_id:155536)的一个变种，[PageRank](@entry_id:139603) 最初为[网页排名](@entry_id:139603)而设计，但已广泛应用于有向[生物网络](@entry_id:267733)。它模拟了一个在网络上随机游走的粒子。这个粒子以概率 $\alpha$ 跟随有向边移动，并以概率 $1-\alpha$ “瞬移”到网络中的任何一个节点（通常根据一个预设的**个性化向量** $\mathbf{u}$）。[PageRank](@entry_id:139603)得分向量 $\mathbf{p}$ 是这个过程的[稳态分布](@entry_id:149079)，满足方程 $\mathbf{p} = \alpha P \mathbf{p} + (1-\alpha)\mathbf{u}$，其中 $P$ 是列随机化的[转移矩阵](@entry_id:145510)。在GRN中，高[PageRank](@entry_id:139603)得分的基因通常是那些被许多重要调控因子调控的下游靶标 [@problem_id:4570489]。

### 网络拓扑与结构

超越单个节点，我们可以研究更大范围的拓扑特征，这些特征往往与生物系统的功能和鲁棒性密切相关。

#### 连通性与组分

- **连通组分（Connected Component）**：在[无向图](@entry_id:270905)中，一个连通组分是一个极大的顶点子集，其中任意两个顶点之间都存在一条路径。例如，在一个PPI网络 $G_{\mathrm{PPI}}$ 中，如果从蛋白质 $u$ 到 $v$ 再到 $w$，依此类推形成一条路径 $u-v-w-x-y$，那么所有这些蛋白质都属于同一个连通组分 [@problem_id:4570537]。

- **强连通组分（Strongly Connected Component, SCC）**：在有向图中，一个强连通组分是一个极大的顶点子集，其中任意两个顶点 $u, v$ 之间都存在从 $u$ 到 $v$ 和从 $v$ 到 $u$ 的有向路径。SCC是理解有向网络中**反馈（feedback）**的关键。例如，在一个GRN $G_{\mathrm{GRN}}$ 中，如果基因 $a$ 调控 $b$， $b$ 调控 $c$， $c$ 又调控 $a$，那么 $\{a,b,c\}$ 就形成一个SCC。这样的结构代表一个反馈模块，能够维持或加强特定的细胞状态 [@problem_id:4570537]。

- **关节点（Articulation Point）** 与 **桥（Bridge）**：在一个连通的[无向图](@entry_id:270905)中，**关节点**（或称[割点](@entry_id:637448)）是指移除该顶点后会导致图的连通组分数量增加的顶点。**桥**（或称[割边](@entry_id:266750)）是指移除该边后会产生同样效果的边。在[路径图](@entry_id:274599) $u-v-w-x-y$ 中，顶点 $v, w, x$ 都是[关节点](@entry_id:637448)，而图中的每一条边都是桥。在PPI网络中，[关节点](@entry_id:637448)和桥代表了系统的**脆弱性**和**瓶颈**。它们的失效（如通过[基因敲除](@entry_id:145810)或药物抑制）可能会使一个大的[功能模块](@entry_id:275097)破碎成几个不连通的部分，从而破坏细胞功能 [@problem_id:4570537]。

#### 环路与反馈

**环路（cycle）**是网络中基本的反馈结构。
- 一个**简单环路**是一个起点和终点相同，但其他顶点不重复的闭合路径。在有向图中，如果路径上的每一步都遵循边的方向，则称之为**有向环路**。
- 在像GRN这样的**有符号图**中，每条边还带有一个符号（$+1$ 表示激活，$-1$ 表示抑制）。一个有向环路的**符号**是其上所有边符号的乘积。
    - **正反馈环路**（符号为 $+1$）：包含偶数个抑制性相互作用。例如，环路 $A \to B \to C \to A$ 中，如果 $\sigma(A,B)=+1, \sigma(B,C)=-1, \sigma(C,A)=-1$，其符号为 $(+1) \cdot (-1) \cdot (-1) = +1$。正反馈能够产生**[多稳态](@entry_id:180390)（multistability）**和**开关行为**，是细胞分化和决策的基础。
    - **负反馈环路**（符号为 $-1$）：包含奇数个抑制性相互作用。例如，[自抑制](@entry_id:169700)环路 $A \to A$ 且 $\sigma(A,A)=-1$。负反馈在维持系统**[稳态](@entry_id:139253)（homeostasis）**和产生**振荡（oscillations）**方面起着核心作用。
- 图的**围长（girth）**是图中**[最短环](@entry_id:276378)路的长度**。在调控网络中，它代表了最短的结构性反馈延迟 [@problem_id:4570548]。

#### 局部密度与模体

- **三角形（Triangle）**：由三个相互连接的顶点组成的 3-团（3-clique）是网络中最简单的非平凡模体（motif）。在[PPI网络](@entry_id:271273)中，三角形的密度异常高。这背后的机制是，如果蛋白质A和B都与蛋白质C在一个物理复合物中相互作用，那么A和B由于空间上的共定位和[协同结合](@entry_id:141623)效应，它们自身也极有可能发生相互作用。这种**[三元闭包](@entry_id:261795)（triadic closure）**的倾向使得三角形成为识别稳定**[蛋白质复合物](@entry_id:269238)**的有力指标 [@problem_id:4570493]。

- **[聚类系数](@entry_id:144483)（Clustering Coefficient）**：这个指[标量化](@entry_id:634761)了网络中的[三元闭包](@entry_id:261795)程度。
    - **[局部聚类系数](@entry_id:267257)（Local Clustering Coefficient）** $C_i$ 衡量了节点 $i$ 的邻居节点之间相互连接的紧密程度。它被定义为节点 $i$ 的邻居之间实际存在的边数，除以其邻居之间可能存在的最大边数。对于一个度为 $k_i$ 的节点，该值为 $C_i = \frac{|\{(j,l) \in E \mid j,l \in N(i)\}|}{\binom{k_i}{2}}$，其中 $N(i)$ 是 $i$ 的邻居集合 [@problem_id:4570493]。
    - **全局传递性（Global Transitivity）** 是全图范围内的一个度量，定义为网络中“闭合三元组”（即三角形）的比例。其计算公式为 $T(G) = \frac{3 \times (\text{三角形数量})}{(\text{连通三元组数量})}$，其中一个连通三元组是以某个节点为中心的长度为2的路径 [@problem_id:4570493]。

### 高阶结构：社区与复合物

[生物网络](@entry_id:267733)通常具有模块化的[组织结构](@entry_id:146183)，其中节点被组织成称为**社区（communities）**或**模块（modules）**的[密集连接](@entry_id:634435)的子图。

- **团（Clique）** 与 **社区（Community）**：一个**团**是一个顶点子集，其中每对顶点之间都有一条边。一个**极大团（maximal clique）**是指不能通过添加任何其他顶点来扩展的团。团是一个非常严格的定义。**社区**是一个更宽泛的概念，指内部连接比与网络其余部分的连接更密集的顶点子集。在[PPI网络](@entry_id:271273)中，蛋白质复合物通常表现为社区结构，但它们不一定是完美的团，因为并非所有复合物内的蛋白质都直接相互作用，或者某些相互作用可能在实验中未被检测到 [@problem_id:4570521]。

- **模块度（Modularity）**：模块度 $Q$ 是衡量网络分区质量的最常用指标之一。它比较了社区内部边的比例与在保持节点度数不变的**[零模型](@entry_id:181842)（null model）**中该比例的[期望值](@entry_id:150961)。一个好的社区划分会得到一个高的模块度值。$Q$ 的定义为 $Q = \sum_c \left[ \frac{L_c}{m} - \left(\frac{k_c}{2m}\right)^2 \right]$，其中 $L_c$ 是社区 $c$ 内部的边数， $k_c$ 是社区 $c$ 中所有顶点的度数之和， $m$ 是网络总边数 [@problem_id:4570521]。

- **模块度的[分辨率极限](@entry_id:200378)（Resolution Limit）**：尽管[模块度优化](@entry_id:752101)是一种强大的[社区发现](@entry_id:143791)方法，但它有一个著名的局限性，称为**[分辨率极限](@entry_id:200378)**。在大型网络中，[模块度优化](@entry_id:752101)算法可能无法分辨出那些相对于整个网络来说“太小”的社区。即使两个功能上不同的小型[蛋白质复合物](@entry_id:269238)（例如两个不同的极大团）之间只有一条边相连，[模块度最大化](@entry_id:752100)过程也可能将它们合并成一个更大的社区，因为这样做可能会给全局 $Q$ 值带来更大的提升。这提醒我们，算法发现的[社区结构](@entry_id:153673)并不总是与生物学上的功能单元完全对应 [@problem_id:4570521]。

### 生物系统的高级图模型

许多生物数据集的内在结构超出了[简单图](@entry_id:274882)的范畴。

#### [二分图](@entry_id:262451)

一个**二分图（bipartite graph）**是这样一种图，其顶点集可以被分解为两个不相交的子集 $U$ 和 $V$，使得图中的每一条边都连接一个来自 $U$ 的顶点和一个来自 $V$ 的顶点。在 $U$ 或 $V$ 内部不存在边。许多生物数据集天然就是二分的，例如：
- 药物-靶标网络（$U$=药物, $V$=蛋白质）
- 代谢物-反应网络（$U$=代谢物, $V$=化学反应）
- 配体-蛋白质网络（$U$=配体, $V$=蛋白质）

对于一个[二分图](@entry_id:262451)，我们可以通过**单模投影（one-mode projection）**来导出一个只包含其中一类顶点的普通图。例如，将一个配体-蛋白质[二分图](@entry_id:262451)投影到蛋白质空间，会得到一个蛋白质-蛋白质图。在这个投影图中，如果两个蛋白质 $p_i$ 和 $p_j$ 在原始[二分图](@entry_id:262451)中共享至少一个配体邻居，那么它们之间就有一条边。边的权重可以定义为它们共享的配体数量。这个过程可以通过[矩阵代数](@entry_id:153824)高效完成。如果 $B$ 是一个 $|U| \times |V|$ 的[关联矩阵](@entry_id:263683)（例如，行代表配体，列代表蛋白质），那么投影到 $V$ 上的加权邻接矩阵 $W_V$ 可以通过 $W_V = B^T B$ 计算得出（通常需要将对角[线元](@entry_id:196833)素置零）。类似地，投影到 $U$ 上的矩阵为 $W_U = B B^T$ [@problem_id:4570490]。

在代谢网络中，我们还可以使用带符号的**[化学计量矩阵](@entry_id:275342)（stoichiometric matrix）** $S$，其中 $S_{mr}$ 为负数表示代谢物 $m$ 是反应 $r$ 的底物，为正数表示 $m$ 是产物。使用 $S$ 或其绝对值 $|S|$ 进行投影会得到不同含义的反应-[反应网络](@entry_id:203526)。$|S|^T |S|$ 捕捉了反应间共享代谢物的总体程度，而 $S^T S$ 则会因为符号的正负抵消而区分反应是协同（同为底物或产物）还是拮抗（一个的底物是另一个的产物）[@problem_id:4570490]。

#### [超图](@entry_id:270943)

标准图只能表示成对关系。然而，许多[生物过程](@entry_id:164026)，如多底物的酶促反应（例如 $X_1 + 2X_2 \to X_3$），涉及多个实体同时参与。**[超图](@entry_id:270943)（hypergraph）**是对此的自然推广。在[超图](@entry_id:270943)中，一条**超边（hyperedge）**可以连接任意数量的顶点。

为了对生化反应进行精确建模，我们可以使用**有向[超图](@entry_id:270943)**。每个反应 $\rho_j$ 对应一条有向超边 $e_j = (T_j, H_j)$，其中 $T_j$ 是反应物的多重集（尾部），$H_j$ 是产物的多重集（头部）。这种表示法保留了反应的方向性和化学计量。例如，对于 $\rho_1: X_1 + 2X_2 \to X_3$，其超边为 $e_1 = (\{X_1, X_2, X_2\}, \{X_3\})$。[超图](@entry_id:270943)的[关联矩阵](@entry_id:263683) $\iota(x, e_j)$ 可以被定义为物种 $x$ 在反应 $e_j$ 中的净[化学计量](@entry_id:137450)变化，这与化学计量矩阵 $S$ 完[全等](@entry_id:194418)价 [@problem_id:4570486]。

[超图](@entry_id:270943)可以通过**二分图转换**（也称为[Petri网](@entry_id:269912)表示法）来可视化和分析。这个过程会创建一个包含两类顶点的二分图：物种节点和反应节点。对于每个反应 $\rho_j$，我们创建一个反应节点 $r_j$。然后，从每个反应物 $x \in T_j$ 向 $r_j$ 画一条有向边，权重为其[化学计量系数](@entry_id:204082)；再从 $r_j$ 向每个产物 $y \in H_j$ 画一条有向边，权重为其[化学计量系数](@entry_id:204082)。这样，一个复杂的[多体相互作用](@entry_id:751663)系统就被转换成了一个结构更简单、分析工具更成熟的[二分图](@entry_id:262451)，同时保留了所有原始信息 [@problem_id:4570486]。