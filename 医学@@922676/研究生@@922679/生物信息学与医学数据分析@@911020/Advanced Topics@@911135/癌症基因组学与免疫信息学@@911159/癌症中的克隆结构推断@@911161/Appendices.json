{"hands_on_practices": [{"introduction": "在癌症克隆结构推断中，最基本也是最关键的一步是建立原始测序数据与核心生物学量之间的联系。此练习将指导您从细胞混合模型的第一性原理出发，推导变异等位基因频率（VAF, Variant Allele Frequency）与癌症细胞分数（CCF, Cancer Cell Fraction）之间的数学关系[@problem_id:4549139]。通过这个过程，您将深刻理解肿瘤纯度（$p$）、拷贝数（$C$）和突变多重性（$m$）等因素如何共同影响我们观测到的VAF值。", "problem": "一份来自实体瘤的全基因组测序活检样本显示，一个体细胞单核苷酸变异的观测变异等位基因频率 (VAF) 等于 $0.18$。该样本包含癌细胞和正常细胞的混合物。癌细胞分数 (CCF)，记为 $f$，定义为携带该突变的癌细胞所占的比例。样本纯度，记为 $p$，是样本中癌细胞所占的比例。在癌细胞中，该位点的总拷贝数为 $C$，而突变拷贝数 $m$ 是携带该突变的癌细胞中带有该突变的等位基因拷贝的数量。\n\n假设如下：\n- 该位点上的正常细胞是二倍体，每个细胞贡献 $2$ 个总等位基因。\n- 该位点上的癌细胞总拷贝数为 $C$，在癌细胞中，有比例为 $f$ 的细胞携带该突变。\n- 每个突变的癌细胞在该位点上携带 $m$ 个突变的等位基因拷贝。\n- 测序是无偏的，并且在足够大的测序深度下，观测到的VAF等于混合DNA池中突变等位基因的预期比例。\n\n从基本原理出发，使用两室混合模型（正常细胞和癌细胞）中的等位基因计数法，推导出一个将预期VAF与 $p$、$C$、$m$ 和 $f$ 相关联的表达式，并求解 $f$。然后，在观测VAF为 $0.18$，$p=0.7$，$C=3$ 和 $m=1$ 的条件下，计算 $f$ 的值。将您的最终答案以最简分数的形式精确表示。", "solution": "本题要求基于肿瘤样本的两室模型，推导癌细胞分数 $f$ 的表达式，然后根据一组给定的参数计算其值。推导将从基本原理出发，通过考虑样本中正常细胞群和癌细胞群的等位基因贡献来进行。\n\n让我们考虑一个代表性的组织样本，其中包含总共 $N_{\\text{total}}$ 个细胞。样本纯度 $p$ 是癌细胞所占的比例。\n样本中的癌细胞数量为 $N_{\\text{cancer}} = p \\cdot N_{\\text{total}}$。\n样本中的正常细胞数量为 $N_{\\text{normal}} = (1-p) \\cdot N_{\\text{total}}$。\n\n预期的变异等位基因频率 $VAF_{\\text{exp}}$ 是整个样本中指定位点上突变等位基因的数量与总等位基因数量的比值。我们必须计算这两个量。\n\n首先，我们确定样本中的总等位基因数 $A_{\\text{total}}$。\n正常细胞是二倍体，因此每个正常细胞在该位点上贡献 $2$ 个等位基因。来自正常细胞的总贡献为 $N_{\\text{normal}} \\times 2 = (1-p) N_{\\text{total}} \\times 2$。\n癌细胞在该位点上的总拷贝数为 $C$。来自癌细胞的总贡献为 $N_{\\text{cancer}} \\times C = p N_{\\text{total}} \\times C$。\n样本中的总等位基因数是这些贡献的总和：\n$$\nA_{\\text{total}} = 2(1-p)N_{\\text{total}} + C p N_{\\text{total}} = N_{\\text{total}} [2(1-p) + C p]\n$$\n\n接下来，我们确定突变等位基因的总数 $A_{\\text{mutated}}$。\n假设正常细胞不携带该体细胞突变，因此它们对突变等位基因计数的贡献为 $0$。\n该突变仅存在于一部分比例为 $f$（癌细胞分数）的癌细胞中。\n携带该突变的癌细胞数量为 $N_{\\text{mutated\\_cancer}} = f \\cdot N_{\\text{cancer}} = f \\cdot p \\cdot N_{\\text{total}}$。\n在每个这样的突变癌细胞中，该突变存在于 $m$ 个等位基因拷贝上（突变拷贝数）。\n因此，样本中突变等位基因的总数为：\n$$\nA_{\\text{mutated}} = N_{\\text{mutated\\_cancer}} \\times m = (f \\cdot p \\cdot N_{\\text{total}}) \\cdot m = f p m N_{\\text{total}}\n$$\n\n预期的VAF是 $A_{\\text{mutated}}$ 与 $A_{\\text{total}}$ 的比值。\n$$\nVAF_{\\text{exp}} = \\frac{A_{\\text{mutated}}}{A_{\\text{total}}} = \\frac{f p m N_{\\text{total}}}{N_{\\text{total}} [2(1-p) + C p]}\n$$\n$N_{\\text{total}}$ 项被消去，得到将预期VAF与模型参数相关联的通用表达式：\n$$\nVAF_{\\text{exp}} = \\frac{f p m}{2(1-p) + C p}\n$$\n题目指出，观测到的VAF可以等同于预期的VAF。令 $VAF$ 表示 $VAF_{\\text{exp}}$。\n$$\nVAF = \\frac{f p m}{2(1-p) + C p}\n$$\n我们被要求解此方程以求出癌细胞分数 $f$。为此，我们重排方程：\n$$\nVAF \\cdot [2(1-p) + C p] = f p m\n$$\n$$\nf = \\frac{VAF \\cdot [2(1-p) + C p]}{p m}\n$$\n这就是推导出的 $f$ 的表达式。\n\n现在，我们使用所提供的数据计算 $f$ 的值：观测到的 $VAF = 0.18$，样本纯度 $p=0.7$，癌细胞总拷贝数 $C=3$，以及突变拷贝数 $m=1$。\n为保持精度，我们将使用分数形式表示小数值：\n$VAF = 0.18 = \\frac{18}{100} = \\frac{9}{50}$\n$p = 0.7 = \\frac{7}{10}$\n\n将这些值代入 $f$ 的表达式中：\n$$\nf = \\frac{\\frac{9}{50} \\cdot [2(1-\\frac{7}{10}) + 3 \\cdot \\frac{7}{10}]}{\\frac{7}{10} \\cdot 1}\n$$\n首先，我们计算方括号中的项：\n$$\n1-\\frac{7}{10} = \\frac{3}{10}\n$$\n$$\n2\\left(\\frac{3}{10}\\right) + 3\\left(\\frac{7}{10}\\right) = \\frac{6}{10} + \\frac{21}{10} = \\frac{27}{10}\n$$\n现在，将此结果代回 $f$ 的表达式中：\n$$\nf = \\frac{\\frac{9}{50} \\cdot \\frac{27}{10}}{\\frac{7}{10}}\n$$\n我们可以简化这个繁分数：\n$$\nf = \\frac{9}{50} \\cdot \\frac{27}{10} \\cdot \\frac{10}{7}\n$$\n分子和分母中的因子 $10$ 被消掉：\n$$\nf = \\frac{9}{50} \\cdot \\frac{27}{7}\n$$\n最后，我们进行乘法运算：\n$$\nf = \\frac{9 \\times 27}{50 \\times 7} = \\frac{243}{350}\n$$\n为确认此分数为最简形式，我们注意到分子的质因数分解为 $243 = 3^5$，分母的质因数分解为 $350 = 2 \\times 5^2 \\times 7$。分子和分母没有共同的质因数，因此该分数是不可约的。", "answer": "$$\n\\boxed{\\frac{243}{350}}\n$$", "id": "4549139"}, {"introduction": "理解了从VAF到CCF的转换后，下一步便是将其应用于真实的肿瘤样本中的一组突变。本练习模拟了一个实际的生物信息学分析场景，您需要处理等位基因特异性拷贝数（$C_{t}$ 和 $C_{m}$）和突变多重性（$m$）选择等复杂情况，来为多个变异体估算其CCF值[@problem_id:4549121]。最终，您将利用这些估算值进行初步的聚类分析，这是识别不同克隆群体的第一步。", "problem": "一份单一实体肿瘤测序样本已知其纯度 $p=0.7$（样本中癌细胞的比例）。对于每个体细胞单核苷酸变异，给定了其变异和参考读取计数，以及通过分段推断出的局部等位基因特异性拷贝数：总拷贝数 $C_{t}$ 和次要等位基因拷贝数 $C_{m}$。假设正常细胞群在所有位点的总拷贝数为 $2$，测序无偏，且位点水平的肿瘤拷贝数在包含或不包含该变异的癌细胞中均一适用。设变异存在于比例为 $c$ 的癌细胞中（癌细胞分数，CCF），并令多重性 $m$ 表示携带该变异的每个癌细胞中的突变拷贝数。变异等位基因频率（VAF）定义为支持变异等位基因的测序读取的比例：$v = \\frac{a}{a+r}$，其中 $a$ 和 $r$ 分别是变异和参考读取计数。\n\n从这些定义以及肿瘤和正常细胞的混合模型出发，推导出从观测到的VAF $v$ 到CCF $c$ 的映射关系，该关系是 $p$、$C_{t}$ 和 $m$ 的函数。然后，对下面的每个变异，通过使用观测到的 $v$ 反转该映射来计算调整后的CCF，并选择满足 $1 \\leq m \\leq C_{\\mathrm{maj}}$ 且所得 $c$ 位于区间 $[0,1]$ 内的最小整数多重性 $m$，其中 $C_{\\mathrm{maj}} = C_{t} - C_{m}$ 是主要等位基因拷贝数。如果没有这样的 $m$ 能使得 $c \\in [0,1]$，则选择使 $c$ 与 $1$ 的绝对偏差最小的最小 $m$。\n\n计算出调整后的CCF后，将每个变异分配到由固定的CCF中心定义的两个聚类之一：中心为 $1.0$ 的克隆聚类和中心为 $0.35$ 的显性亚克隆聚类。使用绝对差 $|c - \\text{center}|$ 的最近中心分配法，若出现平局则优先选择克隆聚类（$1.0$）。\n\n五个变异如下：\n- 变异 $1$：$a_{1}=45$， $r_{1}=55$， $C_{t,1}=3$， $C_{m,1}=1$。\n- 变异 $2$：$a_{2}=40$， $r_{2}=80$， $C_{t,2}=2$， $C_{m,2}=1$。\n- 变异 $3$：$a_{3}=20$， $r_{3}=80$， $C_{t,3}=4$， $C_{m,3}=1$。\n- 变异 $4$：$a_{4}=25$， $r_{4}=75$， $C_{t,4}=3$, $C_{m,4}=0$。\n- 变异 $5$：$a_{5}=20$， $r_{5}=80$， $C_{t,5}=5$, $C_{m,5}=2$。\n\n将每个CCF表示为四舍五入到四位有效数字的小数。最终答案必须以单行矩阵的形式给出，前五个条目依次是变异1到5的四舍五入后的CCF，后面是五个聚类分配，编码为整数（$1$ 代表克隆聚类，$2$ 代表显性亚克隆聚类）。", "solution": "第一步是推导癌细胞分数（$c$）与观测到的变异等位基因频率（$v$）之间的一般关系。测序样本是正常细胞（比例 $1-p$）和肿瘤细胞（比例 $p$）的混合物。\n\n让我们考虑在给定基因座上被测序的等位基因总数。\n正常细胞群的比例为 $1-p$，总拷贝数为 $2$。因此，正常细胞贡献的等位基因数量与 $2(1-p)$ 成正比。\n肿瘤细胞群的比例为 $p$，特定位点的总拷贝数为 $C_t$。因此，肿瘤细胞贡献的等位基因数量与 $p C_t$ 成正比。\n样本中等位基因的总数是两个细胞群贡献之和，与 $N_{total} = 2(1-p) + p C_t$ 成正比。\n\n接下来，让我们考虑变异（突变）等位基因的数量。体细胞变异仅存在于比例为 $c$ 的癌细胞中。\n正常细胞不携带该体细胞变异，因此它们贡献了 $0$ 个变异等位基因。\n不携带该变异的肿瘤细胞（占肿瘤细胞群的比例为 $1-c$）也贡献了 $0$ 个变异等位基因。\n携带该变异的肿瘤细胞（占肿瘤细胞群的比例为 $c$）的多重性为 $m$，意味着每个这样的细胞有 $m$ 个突变等位基因的拷贝。这些细胞对样本中变异等位基因总数的贡献与 $N_{alt} = p \\cdot c \\cdot m$ 成正比。\n\n变异等位基因频率（$v$）是变异等位基因数量与总等位基因数量的比值。\n$$v = \\frac{N_{alt}}{N_{total}} = \\frac{p c m}{2(1-p) + p C_t}$$\n问题要求我们找到作为观测值 $v$ 的函数的CCF $c$。我们可以反转上述方程来求解 $c$：\n$$c(v, m) = \\frac{v \\left( 2(1-p) + p C_t \\right)}{p m}$$\n给定肿瘤纯度 $p=0.7$，上式可简化为：\n$$c(v, m) = \\frac{v \\left( 2(1-0.7) + 0.7 C_t \\right)}{0.7 m} = \\frac{v \\left( 0.6 + 0.7 C_t \\right)}{0.7 m}$$\n此公式将用于计算每个变异的CCF。\n\n我们现在将通过应用此公式和选择多重性 $m$ 的规则来分析每个变异。\n\n**变异 1**\n- 数据：$a_1=45$，$r_1=55$，$C_{t,1}=3$，$C_{m,1}=1$。\n- 观测到的VAF：$v_1 = \\frac{a_1}{a_1+r_1} = \\frac{45}{45+55} = 0.45$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},1} = C_{t,1} - C_{m,1} = 3-1 = 2$。\n- 多重性 $m$ 必须是整数，且 $1 \\leq m \\leq C_{\\mathrm{maj},1}$。因此，$m \\in \\{1, 2\\}$。\n- 我们为每个可能的 $m$ 计算 $c_1(m)$：\n$$c_1(m) = \\frac{0.45 \\left( 0.6 + 0.7 \\times 3 \\right)}{0.7 m} = \\frac{0.45 \\left( 2.7 \\right)}{0.7 m} = \\frac{1.215}{0.7 m} \\approx \\frac{1.7357}{m}$$\n- 对于 $m=1$：$c_1(1) \\approx 1.7357$。这不在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_1(2) \\approx 1.7357/2 = 0.86785$。这在 $[0,1]$ 区间内。\n- 根据规则，我们选择能使 $c \\in [0,1]$ 的最小整数 $m$。这里，只有 $m=2$ 满足条件。\n- 变异1的CCF是 $c_1 = 0.86785$。四舍五入到四位有效数字，$c_1 = 0.8679$。\n\n**变异 2**\n- 数据：$a_2=40$，$r_2=80$，$C_{t,2}=2$，$C_{m,2}=1$。\n- 观测到的VAF：$v_2 = \\frac{40}{40+80} = \\frac{40}{120} = \\frac{1}{3}$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},2} = C_{t,2} - C_{m,2} = 2-1 = 1$。\n- 多重性 $m$ 必须是整数，且 $1 \\leq m \\leq C_{\\mathrm{maj},2}$。因此，$m \\in \\{1\\}$。\n- 我们计算 $c_2(m)$：\n$$c_2(m) = \\frac{(1/3) \\left( 0.6 + 0.7 \\times 2 \\right)}{0.7 m} = \\frac{(1/3) \\left( 2.0 \\right)}{0.7 m} = \\frac{2/3}{0.7 m} = \\frac{2}{2.1 m} \\approx \\frac{0.95238}{m}$$\n- 对于 $m=1$：$c_2(1) \\approx 0.95238$。这在 $[0,1]$ 区间内。\n- 由于 $m=1$ 是唯一的可能性，并且它得出了一个有效的 $c_2$，我们选择 $m=1$。\n- 变异2的CCF是 $c_2 \\approx 0.95238$。四舍五入到四位有效数字，$c_2 = 0.9524$。\n\n**变异 3**\n- 数据：$a_3=20$，$r_3=80$，$C_{t,3}=4$，$C_{m,3}=1$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},3} = C_{t,3} - C_{m,3} = 4-1 = 3$。\n- 观测到的VAF：$v_3 = \\frac{20}{20+80} = 0.2$。\n- 多重性 $m \\in \\{1, 2, 3\\}$。\n- 我们计算 $c_3(m)$：\n$$c_3(m) = \\frac{0.2 \\left( 0.6 + 0.7 \\times 4 \\right)}{0.7 m} = \\frac{0.2 \\left( 3.4 \\right)}{0.7 m} = \\frac{0.68}{0.7 m} \\approx \\frac{0.97143}{m}$$\n- 对于 $m=1$：$c_3(1) \\approx 0.97143$。这在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_3(2) \\approx 0.97143/2 = 0.48571$。这在 $[0,1]$ 区间内。\n- 对于 $m=3$：$c_3(3) \\approx 0.97143/3 = 0.32381$。这在 $[0,1]$ 区间内。\n- 我们有多个 $m$ 值可以使 $c \\in [0,1]$。我们必须选择最小的那个，即 $m=1$。\n- 变异3的CCF是 $c_3 \\approx 0.97143$。四舍五入到四位有效数字，$c_3 = 0.9714$。\n\n**变异 4**\n- 数据：$a_4=25$，$r_4=75$，$C_{t,4}=3$，$C_{m,4}=0$。\n- 观测到的VAF：$v_4 = \\frac{25}{25+75} = 0.25$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},4} = C_{t,4} - C_{m,4} = 3-0 = 3$。\n- 多重性 $m \\in \\{1, 2, 3\\}$。\n- 我们计算 $c_4(m)$：\n$$c_4(m) = \\frac{0.25 \\left( 0.6 + 0.7 \\times 3 \\right)}{0.7 m} = \\frac{0.25 \\left( 2.7 \\right)}{0.7 m} = \\frac{0.675}{0.7 m} \\approx \\frac{0.96429}{m}$$\n- 对于 $m=1$：$c_4(1) \\approx 0.96429$。这在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_4(2) \\approx 0.96429/2 = 0.48214$。这在 $[0,1]$ 区间内。\n- 对于 $m=3$：$c_4(3) \\approx 0.96429/3 = 0.32143$。这在 $[0,1]$ 区间内。\n- 我们选择能使 $c \\in [0,1]$ 的最小 $m$，即 $m=1$。\n- 变异4的CCF是 $c_4 \\approx 0.96429$。四舍五入到四位有效数字，$c_4 = 0.9643$。\n\n**变异 5**\n- 数据：$a_5=20$，$r_5=80$，$C_{t,5}=5$，$C_{m,5}=2$。\n- 观测到的VAF：$v_5 = \\frac{20}{20+80} = 0.2$。\n- 主要等位基因拷贝数：$C_{\\mathrm{maj},5} = C_{t,5} - C_{m,5} = 5-2 = 3$。\n- 多重性 $m \\in \\{1, 2, 3\\}$。\n- 我们计算 $c_5(m)$：\n$$c_5(m) = \\frac{0.2 \\left( 0.6 + 0.7 \\times 5 \\right)}{0.7 m} = \\frac{0.2 \\left( 4.1 \\right)}{0.7 m} = \\frac{0.82}{0.7 m} \\approx \\frac{1.1714}{m}$$\n- 对于 $m=1$：$c_5(1) \\approx 1.1714$。这不在 $[0,1]$ 区间内。\n- 对于 $m=2$：$c_5(2) \\approx 1.1714/2 = 0.5857$。这在 $[0,1]$ 区间内。\n- 对于 $m=3$：$c_5(3) \\approx 1.1714/3 = 0.39047$。这在 $[0,1]$ 区间内。\n- 我们选择能使 $c \\in [0,1]$ 的最小 $m$，即 $m=2$。\n- 变异5的CCF是 $c_5 \\approx 0.5857$。四舍五入到四位有效数字，$c_5 = 0.5857$。\n\n现在我们进行聚类。聚类中心为 $1.0$（克隆，聚类ID 1）和 $0.35$（亚克隆，聚类ID 2）。我们使用最近中心分配法。\n\n- **V1 ($c_1=0.8679$):** $|0.8679 - 1.0| = 0.1321$, $|0.8679 - 0.35| = 0.5179$。更接近 $1.0$。聚类：**1**。\n- **V2 ($c_2=0.9524$):** $|0.9524 - 1.0| = 0.0476$, $|0.9524 - 0.35| = 0.6024$。更接近 $1.0$。聚类：**1**。\n- **V3 ($c_3=0.9714$):** $|0.9714 - 1.0| = 0.0286$, $|0.9714 - 0.35| = 0.6214$。更接近 $1.0$。聚类：**1**。\n- **V4 ($c_4=0.9643$):** $|0.9643 - 1.0| = 0.0357$, $|0.9643 - 0.35| = 0.6143$。更接近 $1.0$。聚类：**1**。\n- **V5 ($c_5=0.5857$):** $|0.5857 - 1.0| = 0.4143$, $|0.5857 - 0.35| = 0.2357$。更接近 $0.35$。聚类：**2**。\n\n最终结果结合了五个CCF值和五个聚类分配。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8679  0.9524  0.9714  0.9643  0.5857  1  1  1  1  2\n\\end{pmatrix}\n}\n$$", "id": "4549121"}, {"introduction": "在识别出突变簇之后，我们的最终目标是重建肿瘤的演化历史，即构建一棵克隆系统发育树。此练习将探讨在“无限位点假设”（Infinite Sites Assumption）下，支配克隆群体之间关系的逻辑规则[@problem_id:4549150]。通过利用来自多个样本的数据，检验不同树形结构是否符合这些规则（如祖先原则和总和规则），您将学会如何验证或排除各种可能的肿瘤演化路径。", "problem": "一个肿瘤在两个空间上分离的批量样本中进行了测序，记为 $S_{\\mathrm{A}}$ 和 $S_{\\mathrm{B}}$。体细胞单核苷酸变异 (SNV) 已根据其共现模式和推断的癌细胞分数 (CCF) 聚类成 $3$ 个突变簇。这些 CCF 已根据肿瘤纯度进行了调整，并假定为拷贝数中性。设这些簇为 $C_1$（推定的主干）、$C_2$ 和 $C_3$。每个样本中每个簇的估计 CCF 如下：\n- 在 $S_{\\mathrm{A}}$ 中：$C_1: 0.95$，$C_2: 0.40$，$C_3: 0.55$。\n- 在 $S_{\\mathrm{B}}$ 中：$C_1: 0.96$，$C_2: 0.60$，$C_3: 0.25$。\n\n假设无限位点假设 (ISA) 成立，即每个突变只发生一次，且永不丢失或恢复，并且所有簇共享一个在样本间一致的单一克隆系统发育。在 ISA 和拷贝数中性的条件下，对于任何样本中的任何克隆，其父克隆的癌细胞分数必须至少等于其子克隆的癌细胞分数之和。此外，如果克隆 $u$ 是克隆 $v$ 的祖先，则在每个样本中，克隆 $v$ 的癌细胞分数不能超过克隆 $u$ 的癌细胞分数。将上述 CCF 值视为精确值。\n\n只考虑以 $C_1$ 为根（主干）、$C_2$ 和 $C_3$ 为非根节点的有根树。在所有满足 ISA 结构约束的关于 $\\{C_1,C_2,C_3\\}$ 的不同有根标记拓扑中，确定有多少种拓扑可以使用给定的 CCF 同时满足 $S_{\\mathrm{A}}$ 和 $S_{\\mathrm{B}}$ 两个样本的频率约束。将计数报告为单个整数。无需四舍五入，也无需单位。", "solution": "目标是确定关联三个突变簇 $\\{C_1, C_2, C_3\\}$ 的可能系统发育树（拓扑）中，有多少种与两个样本 $S_{\\mathrm{A}}$ 和 $S_{\\mathrm{B}}$ 的给定癌细胞分数 (CCF) 一致。问题指定 $C_1$ 是树的根。节点是带标记的，因此 $C_2$ 和 $C_3$ 的位置是不同的。\n\n给定三个节点，其中一个固定为根，可能的树结构数量有限。非根节点 $C_2$ 和 $C_3$ 要么在分支结构中作为根 $C_1$ 的子节点，要么形成从 $C_1$ 向下的线性链。这产生了三种不同的有根标记拓扑：\n\n1.  线性链，其中 $C_2$ 是 $C_1$ 的子代，$C_3$ 是 $C_2$ 的子代。拓扑为 $C_1 \\to C_2 \\to C_3$。\n2.  线性链，其中 $C_3$ 是 $C_1$ 的子代，$C_2$ 是 $C_3$ 的子代。拓扑为 $C_1 \\to C_3 \\to C_2$。\n3.  分支结构，其中 $C_2$ 和 $C_3$ 都是 $C_1$ 的子代。\n\n必须使用来自样本 $S_{\\mathrm{A}}$ 和 $S_{\\mathrm{B}}$ 的 CCF 数据，对这些拓扑中的每一种进行祖先法则和求和法则的检验。一个拓扑只有在对两个样本都满足规则时才有效。\n\nCCF 数据如下：\n-   $S_{\\mathrm{A}}$: $CCF(C_1, S_{\\mathrm{A}}) = 0.95$, $CCF(C_2, S_{\\mathrm{A}}) = 0.40$, $CCF(C_3, S_{\\mathrm{A}}) = 0.55$。\n-   $S_{\\mathrm{B}}$: $CCF(C_1, S_{\\mathrm{B}}) = 0.96$, $CCF(C_2, S_{\\mathrm{B}}) = 0.60$, $CCF(C_3, S_{\\mathrm{B}}) = 0.25$。\n\n我们应用以下规则：\n-   **祖先法则**: 如果 $u$ 是 $v$ 的祖先，则在每个样本 $S$ 中必须满足 $CCF(v, S) \\le CCF(u, S)$。\n-   **求和法则**: 对于任何父克隆 $u$，必须满足 $CCF(u, S) \\ge \\sum_{v \\in \\text{children}(u)} CCF(v, S)$。\n\n让我们评估每种拓扑。\n\n**拓扑 1: $C_1 \\to C_2 \\to C_3$**\n此拓扑要求对所有样本 $S$ 满足 $CCF(C_3, S) \\le CCF(C_2, S) \\le CCF(C_1, S)$。\n-   检查样本 $S_{\\mathrm{A}}$：是否 $0.55 \\le 0.40$？此为**假**。\n因此，拓扑 1 无效。\n\n**拓扑 2: $C_1 \\to C_3 \\to C_2$**\n此拓扑要求对所有样本 $S$ 满足 $CCF(C_2, S) \\le CCF(C_3, S) \\le CCF(C_1, S)$。\n-   检查样本 $S_{\\mathrm{A}}$：$0.40 \\le 0.55 \\le 0.95$。此为真。\n-   检查样本 $S_{\\mathrm{B}}$：是否 $0.60 \\le 0.25$？此为**假**。\n因此，拓扑 2 无效。\n\n**拓扑 3: 分支结构（$C_2$ 和 $C_3$ 是兄弟节点）**\n此拓扑要求对所有样本 $S$ 满足以下条件：\n1.  $CCF(C_2, S) \\le CCF(C_1, S)$\n2.  $CCF(C_3, S) \\le CCF(C_1, S)$\n3.  $CCF(C_2, S) + CCF(C_3, S) \\le CCF(C_1, S)$\n\n-   检查样本 $S_{\\mathrm{A}}$：\n    1.  $0.40 \\le 0.95$ (真)。\n    2.  $0.55 \\le 0.95$ (真)。\n    3.  $0.40 + 0.55 = 0.95$。是否 $0.95 \\le 0.95$？是。\n    该拓扑与样本 $S_{\\mathrm{A}}$ 的数据一致。\n\n-   检查样本 $S_{\\mathrm{B}}$：\n    1.  $0.60 \\le 0.96$ (真)。\n    2.  $0.25 \\le 0.96$ (真)。\n    3.  $0.60 + 0.25 = 0.85$。是否 $0.85 \\le 0.96$？是。\n    该拓扑也与样本 $S_{\\mathrm{B}}$ 的数据一致。\n\n由于此拓扑对两个样本都有效，因此它是一个有效的系统发育树。\n\n**最终计数**\n-   拓扑 1 ($C_1 \\to C_2 \\to C_3$)：无效。\n-   拓扑 2 ($C_1 \\to C_3 \\to C_2$)：无效。\n-   拓扑 3 (分支结构)：有效。\n\n在三种可能的拓扑中，只有一种与两个样本的 CCF 数据都一致。因此，有效拓扑的数量为 $1$。", "answer": "$$\\boxed{1}$$", "id": "4549150"}]}