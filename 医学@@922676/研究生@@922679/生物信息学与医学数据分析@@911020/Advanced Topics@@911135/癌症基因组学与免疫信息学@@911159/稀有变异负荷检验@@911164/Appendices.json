{"hands_on_practices": [{"introduction": "罕见变异负担检验最简单的形式，是将一个基因中所有符合条件的罕见变异“折叠”成一个单一的指标，如果一个个体携带至少一个此类变异，则被视为“携带者”。这项练习 [@problem_id:4603573] 将引导您从基本原理出发，计算这种折叠负担检验的比值比（odds ratio）。掌握这一计算过程有助于您巩固对负担检验如何在病例-对照研究中量化遗传关联的理解。", "problem": "在一项关于基因$G$的病例-对照测序研究中，您将通过合并极罕见变异来进行罕见变异负担分析。设个体$i$的合并负担指标为$B_i \\in \\{0,1\\}$，其中如果个体$i$在基因$G$的一组预先指定的罕见变异中携带至少一个次要等位基因，则$B_i = 1$，否则$B_i = 0$。您被给予以下汇总计数：\n- 病例数：$n_{1} = 1500$。\n- 对照数：$n_{0} = 2000$。\n- 病例组累积次要等位基因计数 (CMAC; cumulative minor allele count)：$m_{1} = 28$。\n- 对照组累积次要等位基因计数：$m_{0} = 22$。\n\n假设满足以下标准的罕见变异条件：\n- 变异足够罕见，以至于在给定的样本量下，次要纯合基因型可以忽略不计，同一个体中两个不同罕见变异同时出现的情况也可以忽略不计。\n- 因此，每组中负担阳性携带者的数量等于其累积次要等位基因计数，即在病例组中，$B=1$的个体数量为$m_{1}$，在对照组中，$B=1$的个体数量为$m_{0}$。\n\n仅使用第一性原理和上述假设：\n1) 定义量化$B$与病例状态之间关联的群体比值比，并推导一个仅用 $m_{1}$、$m_{0}$、$n_{1}$ 和 $n_{0}$ 表示的一致样本估计量。\n2) 计算所提供数据下该估计量的数值。\n3) 就携带者与非携带者的患病几率而言，对计算出的数值给出一句流行病学解释。\n\n将最终的比值比表示为一个无单位的纯数，四舍五入到四位有效数字。由于在此设定中没有单元格为零，因此不要使用任何连续性校正或平滑处理。", "solution": "用户请求解决一个生物统计学问题，具体涉及病例-对照研究中的罕见变异负担分析。任务包括定义和计算一个比值比估计量，并解释其结果。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 研究类型：基因$G$的病例-对照测序研究。\n- 分析类型：通过合并变异进行罕见变异负担分析。\n- 负担指标变量：个体$i$的$B_i \\in \\{0,1\\}$。\n- 如果个体$i$在基因$G$的一组罕见变异中至少有一个次要等位基因，则$B_i=1$。\n- 否则$B_i=0$。\n- 病例数：$n_{1} = 1500$。\n- 对照数：$n_{0} = 2000$。\n- 病例组累积次要等位基因计数 (CMAC)：$m_{1} = 28$。\n- 对照组累积次要等位基因计数 (CMAC)：$m_{0} = 22$。\n- 假设：次要纯合基因型和单个个体中不同罕见变异的共现可以忽略不计。\n- 假设的推论：每组中负担阳性携带者的数量等于该组的CMAC。\n- $B=1$的病例数是$m_1$。\n- $B=1$的对照数是$m_0$。\n- 任务是：\n    1. 定义群体比值比并推导一个样本估计量。\n    2. 计算估计量的数值。\n    3. 提供一句流行病学解释。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题在遗传流行病学和生物统计学原理方面有充分的依据。它描述了一种标准的病例-对照设计和一种针对罕见遗传变异的常用分析方法（负担检验）。比值比是此研究设计中正确的关联度量。对于“极罕见变异”的背景，这些简化假设是标准且恰当的。\n- **适定性**：该问题是适定的。它提供了构建一个 $2 \\times 2$ 列联表并计算样本比值比所需的所有数据（$n_1$、$n_0$、$m_1$、$m_0$）。问题明确无歧义，且存在唯一解。\n- **客观性**：该问题以精确、客观和科学的语言陈述，不含任何主观或基于观点的内容。\n\n该问题不违反任何无效标准。数据是一致的，假设是该领域的标准，并且要求进行标准的统计计算和解释。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。我将继续进行解答。\n\n根据要求，解答分为三个部分。\n\n### 1) 比值比估计量的定义与推导\n\n设 $D$ 为疾病状态，其中 $D=1$ 代表病例，$D=0$ 代表对照。设 $B$ 为负担状态，其中 $B=1$ 代表携带至少一个符合条件的罕见变异的个体（携带者），$B=0$ 代表非携带者。\n\n群体**比值比 (OR)** 是携带者中患病几率与非携带者中患病几率之比。其定义为：\n$$\n\\text{OR} = \\frac{P(D=1|B=1) / P(D=0|B=1)}{P(D=1|B=0) / P(D=0|B=0)}\n$$\n在病例-对照研究中，我们根据受试者的疾病状态 ($D$) 进行抽样，因此我们无法直接估计条件概率 $P(D=1|B)$ 和 $P(D=0|B)$。然而，通过应用贝叶斯定理，比值比可以等价地表示为病例中暴露（成为携带者）的几率与对照中暴露几率之比：\n$$\n\\text{OR} = \\frac{P(B=1|D=1) / P(B=0|D=1)}{P(B=1|D=0) / P(B=0|D=0)}\n$$\n这种形式可以从病例-对照数据中估计。我们可以将所提供的数据总结在一个 $2 \\times 2$ 列联表中：\n\n| | 病例 ($D=1$) | 对照 ($D=0$) |\n| :--- | :--- | :--- |\n| 携带者 ($B=1$) | $a$ | $b$ |\n| 非携带者 ($B=0$) | $c$ | $d$ |\n\n根据问题陈述，我们有：\n- 病例组中的携带者数量：$a = m_1$。\n- 对照组中的携带者数量：$b = m_0$。\n- 病例总数：$n_1 = a + c$。\n- 对照总数：$n_0 = b + d$。\n\n由此，我们可以推断出每组中非携带者的数量：\n- 病例组中的非携带者数量：$c = n_1 - a = n_1 - m_1$。\n- 对照组中的非携带者数量：$d = n_0 - b = n_0 - m_0$。\n\n比值比的样本估计量，记作 $\\widehat{\\text{OR}}$，是通过将群体概率替换为列联表中的样本频率来计算的：\n$$\n\\widehat{\\text{OR}} = \\frac{(a/n_1) / (c/n_1)}{(b/n_0) / (d/n_0)} = \\frac{a/c}{b/d} = \\frac{ad}{bc}\n$$\n代入给定的变量，一致的样本估计量为：\n$$\n\\widehat{\\text{OR}} = \\frac{m_1 (n_0 - m_0)}{m_0 (n_1 - m_1)}\n$$\n\n### 2) 数值计算\n\n我们有以下给定值：\n- 病例数，$n_1 = 1500$。\n- 对照数，$n_0 = 2000$。\n- 病例组中的携带者数量，$m_1 = 28$。\n- 对照组中的携带者数量，$m_0 = 22$。\n\n首先，我们确定非携带者的数量：\n- 病例组中的非携带者：$n_1 - m_1 = 1500 - 28 = 1472$。\n- 对照组中的非携带者：$n_0 - m_0 = 2000 - 22 = 1978$。\n\n现在，我们将这些值代入估计量公式：\n$$\n\\widehat{\\text{OR}} = \\frac{28 \\times (2000 - 22)}{22 \\times (1500 - 28)} = \\frac{28 \\times 1978}{22 \\times 1472}\n$$\n$$\n\\widehat{\\text{OR}} = \\frac{55384}{32384} \\approx 1.710227...\n$$\n四舍五入到四位有效数字，估计量的数值为 $1.710$。\n\n### 3) 流行病学解释\n\n计算出的比值比为 $1.710$，它提供了携带基因G中符合条件的罕见变异与该疾病之间关联强度的度量。\n\n携带基因$G$中符合条件的罕见变异的个体的患病几率，估计为非携带者患病几率的 $1.710$ 倍。", "answer": "$$\\boxed{1.710}$$", "id": "4603573"}, {"introduction": "将所有罕见变异同等对待可能并非最优策略，因为某些变异可能比其他变异具有更大的功能影响。现代负担检验通常采用加权方案来解释这种异质性。本实践 [@problem_id:4603598] 介绍了一种更复杂的加权负担评分，它同时考虑了变异的罕见程度和预测的功能重要性（通过CADD评分），您将为一个特定个体计算此分数，并概述用于检验其与疾病关联的统计框架，从而使您更接近真实世界的研究应用。", "problem": "您正在为一个基于基因的稀有变异负担关联研究分析一个病例-对照数据集。对于一个给定的基因，存在 $5$ 个非同义稀有变异，由 $j \\in \\{1,2,3,4,5\\}$ 索引。对于每个变异，您有从研究样本中估计出的次要等位基因频率 $p_j$ 和通过组合注释依赖性缺失（Combined Annotation Dependent Depletion, CADD）测量的功能注释。对于个体 $i^{\\star}$，您观察到其次要等位基因的基因型计数 $X_{i^{\\star}j} \\in \\{0,1,2\\}$。\n\n为了在单个负担分数中结合频率降权和功能影响升权，您将使用一个由下式定义的权重\n$$\nw_j \\equiv \\frac{\\ln\\!\\big(1 + \\mathrm{CADD}_j\\big)}{\\sqrt{p_j\\left(1 - p_j\\right)}},\n$$\n并将个体的加权负担分数定义为所有变异的加权和，\n$$\nS_{i^{\\star}} \\equiv \\sum_{j=1}^{5} w_j\\,X_{i^{\\star}j}.\n$$\n您还计划在逻辑斯蒂回归框架下，检验基因负担与二元疾病结局之间的关联。\n\n请使用以下关于此基因的科学上合理且自洽的数据：\n- 变异水平的次要等位基因频率：$p_1 = 0.002$, $p_2 = 0.005$, $p_3 = 0.010$, $p_4 = 0.020$, $p_5 = 0.030$。\n- CADD分数：$\\mathrm{CADD}_1 = 25.0$, $\\mathrm{CADD}_2 = 12.3$, $\\mathrm{CADD}_3 = 35.0$, $\\mathrm{CADD}_4 = 15.0$, $\\mathrm{CADD}_5 = 5.0$。\n- 个体 $i^{\\star}$ 的基因型：$X_{i^{\\star}1} = 1$, $X_{i^{\\star}2} = 0$, $X_{i^{\\star}3} = 2$, $X_{i^{\\star}4} = 1$, $X_{i^{\\star}5} = 0$。\n\n任务：\n1. 仅使用给定的定义以及自然对数和平方根的标准性质，计算加权负担 $S_{i^{\\star}}$。将您的最终数值答案四舍五入至四位有效数字。\n2. 从二元结局的逻辑斯蒂回归模型的标准定义和最大似然估计量的渐近正态性出发，概述您将如何获得一个双边 $p$ 值，用以检验基因负担是否与疾病状态相关，同时校正诸如年龄、性别和群体结构主成分等已测量的协变量。您的概述必须从第一性原理（模型设定和似然）开始，并逐步构建一个有效的大样本检验统计量。\n\n只有任务1的结果会被数字评分；请将其表示为一个四舍五入到四位有效数字的实数。负担分数不需要单位。", "solution": "我们从稀有变异负担和逻辑斯蒂回归模型的核心定义开始。\n\n对于任务1，个体 $i^{\\star}$ 的负担分数定义为每个变异的权重乘以其基因型计数后，对所有变异求和。权重 $w_j$ 随着预测的功能影响而增加，这通过组合注释依赖性缺失（CADD）分数加一的自然对数来体现；同时，随着变异变得更稀有，权重也通过 $p_j(1-p_j)$ 平方根的倒数而增加。具体来说，\n$$\nw_j \\equiv \\frac{\\ln\\!\\big(1 + \\mathrm{CADD}_j\\big)}{\\sqrt{p_j\\left(1 - p_j\\right)}}, \\quad S_{i^{\\star}} \\equiv \\sum_{j=1}^{5} w_j\\,X_{i^{\\star}j}.\n$$\n使用所提供的值，我们计算每个 $w_j$：\n- 对于 $j=1$：$p_1 = 0.002$，$\\mathrm{CADD}_1 = 25.0$，因此\n$$\nw_1 = \\frac{\\ln(1 + 25.0)}{\\sqrt{0.002 \\cdot (1 - 0.002)}} = \\frac{\\ln(26)}{\\sqrt{0.001996}}.\n$$\n- 对于 $j=2$：$p_2 = 0.005$，$\\mathrm{CADD}_2 = 12.3$，因此\n$$\nw_2 = \\frac{\\ln(1 + 12.3)}{\\sqrt{0.005 \\cdot (1 - 0.005)}} = \\frac{\\ln(13.3)}{\\sqrt{0.004975}}.\n$$\n- 对于 $j=3$：$p_3 = 0.010$，$\\mathrm{CADD}_3 = 35.0$，因此\n$$\nw_3 = \\frac{\\ln(1 + 35.0)}{\\sqrt{0.010 \\cdot (1 - 0.010)}} = \\frac{\\ln(36)}{\\sqrt{0.0099}}.\n$$\n- 对于 $j=4$：$p_4 = 0.020$，$\\mathrm{CADD}_4 = 15.0$，因此\n$$\nw_4 = \\frac{\\ln(1 + 15.0)}{\\sqrt{0.020 \\cdot (1 - 0.020)}} = \\frac{\\ln(16)}{\\sqrt{0.0196}}.\n$$\n- 对于 $j=5$：$p_5 = 0.030$，$\\mathrm{CADD}_5 = 5.0$，因此\n$$\nw_5 = \\frac{\\ln(1 + 5.0)}{\\sqrt{0.030 \\cdot (1 - 0.030)}} = \\frac{\\ln(6)}{\\sqrt{0.0291}}.\n$$\n\n我们象征性地计算必要的对数和平方根，然后进行数值计算以组合成 $S_{i^{\\star}}$：\n- $\\ln(26)$ 是一个常数；数值上 $\\ln(26) \\approx 3.258096538$。\n- $\\sqrt{0.001996} \\approx 0.04467663$，因此 $w_1 \\approx 3.258096538 / 0.04467663 \\approx 72.92616$。\n- $\\ln(13.3) \\approx 2.587764$，$\\sqrt{0.004975} \\approx 0.07054251$，因此 $w_2 \\approx 2.587764 / 0.07054251 \\approx 36.6839$。\n- $\\ln(36) = 2 \\ln(6) \\approx 3.583518938$，且 $\\sqrt{0.0099} = \\sqrt{99}/100 \\approx 0.0994987437$，因此 $w_3 \\approx 3.583518938 / 0.0994987437 \\approx 36.01572$。\n- $\\ln(16) = 4 \\ln(2) \\approx 2.772588722$，且 $\\sqrt{0.0196} = 0.14$，因此 $w_4 \\approx 2.772588722 / 0.14 \\approx 19.804205$。\n- $\\ln(6) \\approx 1.791759469$，且 $\\sqrt{0.0291} \\approx 0.170587$，因此 $w_5 \\approx 1.791759469 / 0.170587 \\approx 10.508$。\n\n使用基因型 $X_{i^{\\star}1} = 1$, $X_{i^{\\star}2} = 0$, $X_{i^{\\star}3} = 2$, $X_{i^{\\star}4} = 1$, $X_{i^{\\star}5} = 0$，负担为\n$$\nS_{i^{\\star}} = w_1 \\cdot 1 + w_2 \\cdot 0 + w_3 \\cdot 2 + w_4 \\cdot 1 + w_5 \\cdot 0 = w_1 + 2 w_3 + w_4.\n$$\n代入数值，\n$$\nS_{i^{\\star}} \\approx 72.92616 + 2 \\times 36.01572 + 19.804205 \\approx 72.92616 + 72.03144 + 19.804205 \\approx 164.761805.\n$$\n四舍五入到四位有效数字，得到 $S_{i^{\\star}} \\approx 164.8$。\n\n对于任务2，我们从第一性原理出发，概述在逻辑斯蒂回归下获得双边 $p$ 值的步骤：\n- 模型设定：令 $Y_i \\in \\{0,1\\}$ 表示个体 $i$ 的二元结局，$S_i$ 表示基因负担，$\\mathbf{C}_i$ 表示协变量向量（例如，年龄、性别和祖先主成分）。逻辑斯蒂回归模型通过标准的logit链接函数指定条件概率，\n$$\n\\Pr(Y_i = 1 \\mid S_i, \\mathbf{C}_i) \\equiv \\pi_i, \\quad \\ln\\!\\left(\\frac{\\pi_i}{1 - \\pi_i}\\right) = \\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i.\n$$\n- 似然：在独立观测的假设下，参数 $(\\alpha, \\beta, \\boldsymbol{\\gamma})$ 的伯努利似然为\n$$\nL(\\alpha, \\beta, \\boldsymbol{\\gamma}) = \\prod_{i=1}^{n} \\pi_i^{Y_i} (1 - \\pi_i)^{1 - Y_i}, \\quad \\text{其中} \\quad \\pi_i = \\frac{\\exp(\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i)}{1 + \\exp(\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i)}.\n$$\n对数似然为\n$$\n\\ell(\\alpha, \\beta, \\boldsymbol{\\gamma}) = \\sum_{i=1}^{n} \\left\\{ Y_i (\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i) - \\ln\\!\\big(1 + \\exp(\\alpha + \\beta S_i + \\boldsymbol{\\gamma}^{\\top} \\mathbf{C}_i)\\big) \\right\\}.\n$$\n- 估计：通过求解得分方程 $\\nabla \\ell = \\mathbf{0}$ 来获得最大似然估计 $(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}})$，通常使用迭代重加权最小二乘法或牛顿-拉弗森法。\n- 方差估计：计算观测到的费雪信息矩阵，即对数似然函数的负海森矩阵（negative Hessian），\n$$\n\\mathcal{I}(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}}) = - \\nabla^2 \\ell(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}}),\n$$\n并从 $\\mathcal{I}^{-1}$ 中提取相应的对角元素作为 $\\hat{\\beta}$ 的估计方差，记作 $\\widehat{\\mathrm{Var}}(\\hat{\\beta})$；标准误为 $\\mathrm{SE}(\\hat{\\beta}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\hat{\\beta})}$。\n- 假设检验：检验原假设 $H_0\\!: \\beta = 0$ 与双边备择假设 $H_1\\!: \\beta \\neq 0$。根据最大似然估计量的大样本理论，在 $H_0$ 下，\n$$\nZ \\equiv \\frac{\\hat{\\beta}}{\\mathrm{SE}(\\hat{\\beta})} \\overset{approx}{\\sim} \\mathcal{N}(0, 1).\n$$\n- $p$ 值：双边 $p$ 值计算如下\n$$\np = 2 \\left[ 1 - \\Phi\\!\\left( \\left| Z \\right| \\right) \\right],\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态累积分布函数。作为替代方法，也可以构建一个似然比检验，使用 $2 \\left\\{\\ell(\\hat{\\alpha}, \\hat{\\beta}, \\hat{\\boldsymbol{\\gamma}}) - \\ell(\\tilde{\\alpha}, 0, \\tilde{\\boldsymbol{\\gamma}})\\right\\}$，该统计量在 $H_0$ 下渐近服从 $\\chi^2_1$ 分布；或者在 $\\beta = 0$ 处进行得分检验，该检验由在原假设模型下评估的梯度和信息计算得出。在所有情况下，核心步骤仍然是模型设定、参数估计（或原假设模型拟合）、方差或信息评估，以及使用大样本参考分布将检验统计量映射到 $p$ 值。", "answer": "$$\\boxed{164.8}$$", "id": "4603598"}]}