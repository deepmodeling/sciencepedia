## 引言
在[癌症基因组学](@entry_id:143632)的研究领域，准确解读测[序数](@entry_id:150084)据是理解肿瘤生物学行为和指导临床决策的基石。然而，一个根本性的挑战在于，我们分析的肿瘤组织样本几乎无一例外是肿瘤细胞与正常细胞的混合物。这种固有的样本异质性导致我们观测到的基因组信号（如拷贝数、[等位基因频率](@entry_id:146872)）被严重“污染”和“压缩”，若不加校正，将直接导致对肿瘤基因组变异的错误解读。因此，如何从复杂的混合信号中精确推断出肿瘤的内在属性，尤其是其在样本中的占比（纯度）和整体的基因组拷贝数水平（倍性），成为了所有下游分析前必须解决的核心问题。

本文旨在系统性地阐述肿瘤纯度与倍性估计的完整框架。我们将带领读者穿越理论、应用与实践的三个层面，构建一个从原始数据到生物学洞见的完整认知路径。
- 在“**原理与机制**”一章中，我们将深入探讨连接观测数据与生物学参数的底层数学模型，明确定义肿瘤纯度、倍性等核心概念，并揭示如何利用不同类型的基因组信号来联合求解这些未知量。
- 随后的“**应用与跨学科交叉**”一章将展示这些估计值在实际中的广泛价值，从校正拷贝数和突变频率，到解构肿瘤[克隆演化](@entry_id:272083)，再到精准计算TMB、HRD等关键[临床生物标志物](@entry_id:183949)。
- 最后，通过“**动手实践**”部分，读者将有机会通过解决具体问题，将理论知识转化为可操作的分析技能。

通过本指南的学习，您将掌握从混合测序数据中提炼真实肿瘤基因组信息的关键方法。让我们首先从构建这一切分析的基石——其背后的核心原理与机制——开始。

## 原理与机制

在对肿瘤基因组进行测序分析时，我们面临的一个核心挑战是，测序样本几乎总是肿瘤细胞与周围正常细胞的混合物。这种[细胞异质性](@entry_id:262569)意味着我们观察到的测序信号——无论是拷贝数变异、等位基因频率还是[体细胞突变](@entry_id:276057)频率——都是来自不同细胞群体的信号的加权平均。为了准确解读肿瘤的基因组特征，我们必须首先建立一个能够解构这种混合信号的数学模型。本章将从基本定义出发，系统阐述肿瘤纯度与倍性估计的核心原理，探讨其背后的数学关系、关键的分析挑战以及相应的解决方法。

### 基本概念：定义细胞与基因组混合体

为了构建一个精确的模型，我们必须首先明确几个关键的生物学和数学概念。这些概念是后续所有分析的基石。

#### 肿瘤细胞占比 vs. 肿瘤纯度

在讨论肿瘤样本的组成时，两个术语经常被提及：**肿瘤细胞占比 (tumor cellularity)** 和 **肿瘤纯度 (tumor purity)**。尽管它们有时被混用，但其精确定义有所不同，理解这种差异至关重要。

**肿瘤细胞占比**，在此记为 $c$，指的是在一个组织样本中，肿瘤细胞数量占所有有核细胞总数的比例。这是一个基于细胞计数的生物学比例。

然而，高通量测序技术分析的对象是DNA，而非细胞本身。由于肿瘤细胞常常存在[非整倍性](@entry_id:137510)（即[染色体数目异常](@entry_id:261469)），其单个细胞的DNA含量可能与正常的[二倍体细胞](@entry_id:147615)不同。**肿瘤纯度**，在此记为 $p$，定义为来自肿瘤细胞的DNA质量（或在理想测序实验中，测序读数）占样本总DNA质量（或总测序读数）的比例。

这两个量之间的关系取决于肿瘤细胞相对于正常细胞的平均DNA含量。假设正常细胞是二倍体，其倍性为 $2$。我们定义**平均肿瘤倍性 (average tumor ploidy)**，记为 $\pi$，为肿瘤细胞基因组范围内的平均总拷贝数。那么，来自肿瘤细胞的DNA贡献量与 $c \cdot \pi$ 成正比，而来自正常细胞的DNA贡献量与 $(1-c) \cdot 2$ 成正比。因此，肿瘤纯度 $p$ 可以表示为：

$$
p = \frac{c \cdot \pi}{c \cdot \pi + (1-c) \cdot 2}
$$

从这个公式可以看出，$p=c$ 的充分必要条件是 $\pi=2$。也就是说，只有当肿瘤细胞的平均DNA含量与正常细胞相同时，肿瘤纯度才等于肿瘤细胞占比。当肿瘤是近[二倍体](@entry_id:268054)（$\pi \approx 2$）时，$p$ 和 $c$ 近似相等。但对于具有显著[非整倍性](@entry_id:137510)（特别是全基因组加倍后）的肿瘤，$\pi$ 可能远大于2，此时肿瘤纯度 $p$ 将会显著高于肿瘤细胞占比 $c$ [@problem_id:4616081]。在后续的讨论中，我们将主要使用肿瘤纯度 $p$，因为它直接反映了其在测[序数](@entry_id:150084)据中的信号贡献。

#### 平均肿瘤倍性 ($\pi$) 与基因组片段拷贝数 ($C_i$)

如上所述，**平均肿瘤倍性** $\pi$ 是一个描述肿瘤细胞基因组整体DNA含量的统计量。然而，肿瘤基因组内的拷贝数通常不是均一的，而是呈现为一系列具有不同拷贝数的区段。假设我们将一个肿瘤基因组划分为 $n$ 个不重叠的片段，第 $i$ 个片段的长度为 $L_i$，在该片段内肿瘤细胞的**总拷贝数 (total copy number)** 为整数 $C_i$。

那么，平均肿瘤倍性 $\pi$ 并非简单地对所有片段的 $C_i$ 值取平均，而是这些值的**长度加权平均值**。这是因为一个更长的基因组片段对整个基因组的DNA总含量的贡献更大。其精确定义如下：

$$
\pi = \frac{\sum_{i=1}^{n} L_i C_i}{\sum_{i=1}^{n} L_i}
$$

一个重要的推论是，即使每个片段的拷贝数 $C_i$ 都是整数，它们的加权平均值 $\pi$ 通常是一个有理数，而非整数。例如，假设一个肿瘤基因组由三个片段组成：片段1长度为12亿个碱基对，$C_1=3$；片段2长度为8亿个碱基对，$C_2=1$；片段3长度为10亿个碱基对，$C_3=2$。那么，其平均肿瘤倍性为：

$$
\pi = \frac{(1.2 \times 10^9 \cdot 3) + (0.8 \times 10^9 \cdot 1) + (1.0 \times 10^9 \cdot 2)}{1.2 \times 10^9 + 0.8 \times 10^9 + 1.0 \times 10^9} = \frac{6.4 \times 10^9}{3.0 \times 10^9} \approx 2.133
$$

这个例子清楚地表明，$\pi$ 是一个连续变量，而非离散的整数 [@problem_id:4616130]。

### 从测[序数](@entry_id:150084)据中观测信号

我们将上述生物学和基因组学参数与高通量测序产生的主要数据类型联系起来：总拷贝数比率、B-等位基因频率和变异[等位基因频率](@entry_id:146872)。

#### 总拷贝数信号：对数[R比](@entry_id:161177)率 ($L$)

在测序实验中，一个特定基因组片段的[测序深度](@entry_id:178191)（read depth）通常与该片段在样本中的绝对拷贝数成正比。在混合样本中，一个片段的期望绝对拷贝数 $\langle CN \rangle$ 是肿瘤和正常细胞贡献的加权平均：

$$
\langle CN \rangle = p \cdot C + (1-p) \cdot 2
$$

其中 $p$ 是肿瘤纯度，$C$ 是该片段在肿瘤细胞中的总拷贝数。为了进行样本间的标准化（例如，校正测序文库大小的差异），通常将该值与一个已知的二倍体基准（拷贝数为2）进行比较，得到**拷贝数比率 (copy ratio)** $R$：

$$
R = \frac{\langle CN \rangle}{2} = \frac{p \cdot C + (1-p) \cdot 2}{2} = \frac{p(C-2)+2}{2}
$$

在实践中，为了使信号的分布更接近正态分布并使增益和缺失在数值上对称，分析时通常使用该比率的以2为底的对数，即**对数[R比](@entry_id:161177)率 (Log R Ratio)**，记为 $L$：

$$
L = \log_{2}(R) = \log_{2}\left(\frac{p(C-2)+2}{2}\right)
$$

$L$ 值是衡量总拷贝数变化的主要信号。对于正常的二倍体区域（$C=2$），$L=0$。对于拷贝数增加（$C>2$），$L>0$；对于拷贝数减少（$C2$），$L0$ [@problem_id:4616085]。

#### 等位基因特异性信号：B-[等位基因频率](@entry_id:146872) (BAF)

除了总拷贝数，我们还可以利用**等位基因特异性拷贝数 (allele-specific copy number)** 信息。这通常通过分析基因组中天然存在的、个体遗传的杂合性[单核苷酸多态性](@entry_id:173601)（SNP）位点来实现。在正常细胞中，这些位点的等位基因拷贝数是 $(1,1)$，即一个A等位基因，一个B等位基因。

**B-[等位基因频率](@entry_id:146872) (B-Allele Frequency, BAF)** 定义为在某个特定位点，支持B等位基因的测序读数占支持A和B两种等位基因的总读数的比例。对于一个正常的杂合位点，BAF的[期望值](@entry_id:150961)是 $0.5$。

然而，在肿瘤细胞中，由于拷贝数变异常常以等位基因不平衡的方式发生，BAF会偏离 $0.5$。例如，**杂合性缺失 (Loss of Heterozygosity, LOH)** 是指肿瘤细胞完全丢失了两个亲本等位基因中的一个。这会导致BAF信号发生可预测的变化，其变化模式依赖于肿瘤纯度 $p$ 和LOH的具体机制 [@problem_id:4616090]。

假设肿瘤细胞中的等位基因拷贝数是 $(a_t, 0)$（B[等位基因丢失](@entry_id:175439)），而正常细胞是 $(1,1)$。混合样本中B等位基因的期望频率为：
$$
\text{E}[\text{BAF}] = \frac{\text{B等位基因总拷贝数}}{\text{A,B等位基因总拷贝数}} = \frac{(1-p) \cdot 1 + p \cdot 0}{(1-p) \cdot (1+1) + p \cdot (a_t+0)} = \frac{1-p}{2(1-p) + p \cdot a_t}
$$
通常，分析中使用的是**次要等位基因频率 (minor-allele BAF)**，即 $\min(\text{BAF}, 1-\text{BAF})$。在上述LOH的例子中，B等位基因是次要等位基因。根据不同的LOH机制，我们得到不同的BAF特征：
- **缺失介导的LOH**: 肿瘤拷贝数为 $(1,0)$，即 $a_t=1$。
  $$ \text{E}[\text{mBAF}] = \frac{1-p}{2-p} $$
- **拷贝中性LOH (Copy-Neutral LOH)**: 肿瘤拷贝数为 $(2,0)$，即 $a_t=2$。
  $$ \text{E}[\text{mBAF}] = \frac{1-p}{2} $$
- **扩增介导的LOH**: 例如，肿瘤拷贝数为 $(3,0)$，即 $a_t=3$。
  $$ \text{E}[\text{mBAF}] = \frac{1-p}{2+p} $$

这些公式表明，BAF信号不仅能揭示特定类型的等位基因不平衡事件，其偏离正常值（$0$ 或 $0.5$）的程度还直接与肿瘤纯度 $p$ 相关，为估计 $p$ 提供了至关重要的信息。

#### [体细胞突变](@entry_id:276057)信号：变异[等位基因频率](@entry_id:146872) (VAF)

最后，体细胞单[核苷](@entry_id:195320)酸变异（SNV）的**变异[等位基因频率](@entry_id:146872) (Variant Allele Fraction, VAF)** 也蕴含着关于样本组成和肿瘤结构的信息。VAF定义为在某个突变位点，支持突变等位基因的测序读数占总读数的比例。

为了解释VAF，我们需要引入另外两个概念：
- **突变多样性 (Mutation Multiplicity, $m$)**: 在携带突变的单个癌细胞中，该突变等位基因的拷贝数。$m$ 的值受限于该位点的总拷贝数 $C$，即 $0 \le m \le C$。
- **癌细胞分数 (Cancer Cell Fraction, CCF, $f$)**: 携带某个特定突变的癌细胞占所有癌细胞的比例。$f=1$ 表示该突变为克隆性突变，存在于所有癌细胞中；$f1$ 表示为亚克隆突变。

需要强调的是，CCF ($f$) 是在肿瘤细胞群体内部定义的比例，而肿瘤纯度 ($p$) 是指整个样本中肿瘤细胞的比例，两者是不同的概念 [@problem_id:4616143]。

结合这些定义，一个[体细胞突变](@entry_id:276057)的期望VAF可以表示为 [@problem_id:4616081]：

$$
V = \frac{\text{突变等位基因总拷贝数}}{\text{该位点总拷贝数}} = \frac{p \cdot f \cdot m}{p \cdot C + (1-p) \cdot 2}
$$

这个公式是连接宏观测序数据（VAF）与微观生物学参数（$p, C, f, m$）的核心桥梁。通过这个公式，我们可以根据观测到的VAF，结合已知的拷贝数信息，来推断突变的克隆状态（$f$）[@problem_id:4616143]。例如，通过重排公式，我们可以从VAF中估计CCF：

$$
f = \frac{V \cdot (p \cdot C + (1-p) \cdot 2)}{p \cdot m}
$$

### 核心挑战：可识别性与模型模糊性

尽管我们已经建立了连接生物学参数与测序信号的数学模型，但在实际应用中，一个核心的挑战是模型的**可识别性 (identifiability)** 问题。这意味着可能存在多组不同的参数（例如，不同的纯度和倍性组合）能够同样好地解释观测到的数据，导致结果的模糊性。

#### 纯度-倍性权衡

最主要的模糊性来源是**纯度-倍性权衡 (purity-ploidy trade-off)** [@problem_id:4616145]。仅考虑总拷贝数信号 $L$ 时，一个低纯度、高倍性的肿瘤样本可以产生与一个高纯度、低倍性样本非常相似的信号。从 $L$ 的公式可以看出，其值主要由 $p(C-2)$ 这一项驱动。如果我们将片段拷贝数 $C$ 近似为平均倍性 $\pi$，则两个解 $(p_1, \pi_1)$ 和 $(p_2, \pi_2)$ 若满足 $p_1(\pi_1-2) \approx p_2(\pi_2-2)$，它们将产生相似的整体拷贝数谱。这使得仅凭总拷贝数数据很难唯一确定 $p$ 和 $\pi$。

#### 利用等位基因特异性信息打破模糊性

幸运的是，BAF提供的等位基因特异性信息可以有效打破这种模糊性。原因在于，许多不同拷贝数状态的BAF信号对纯度 $p$ 的依赖方式是不同的，而它们的总拷贝数信号 $L$ 可能相同。

一个绝佳的例子是区分肿瘤等位基因特异性拷贝数状态 $(3,1)$ 和 $(2,2)$ [@problem_id:4616107]。这两种状态的总拷贝数都是 $C=4$。因此，它们产生的期望对数[R比](@entry_id:161177)率 $L$ 是完全相同的：

$$
L_{(3,1)} = L_{(2,2)} = \log_2\left(\frac{p(4) + 2(1-p)}{2}\right) = \log_2(p+1)
$$

如果只使用 $L$ 数据，这两个状态是无法区分的。但是，它们的BAF信号却截然不同。对于状态 $(2,2)$（等位基因平衡），BAF的[期望值](@entry_id:150961)恒为 $0.5$。对于状态 $(3,1)$（不平衡），假设B等位基因是单拷贝，则其期望BAF为：

$$
\text{BAF}_{(3,1)} = \frac{p \cdot 1 + (1-p)}{p \cdot 4 + 2(1-p)} = \frac{1}{2(p+1)}
$$

只要纯度 $p>0$，该值就严格小于 $0.5$。因此，通过联合分析 $L$ 和 BAF，我们可以轻易地区分这两种状态。

这个原理可以被推广。通常，具有以下特征的基因组片段最有助于打破纯度-倍性权衡 [@problem_id:4616145]：
1.  **拷贝中性LOH (cnLOH)**：如前所述，其BAF为 $(1-p)/2$，直接提供了对 $p$ 的估计。
2.  **奇数总拷贝数**：例如 $C=1, 3, 5$ 等，这些状态必然导致等位基因不平衡（如 $1:0, 2:1, 3:2$），其BA[F值](@entry_id:178445)会对 $p$ 产生独特的依赖关系。
3.  **具有LOH的偶数总拷贝数**：例如 $C=4$ 时的 $(4,0)$ 状态。

相反，那些等位基因平衡的偶数拷贝数状态（如 $C=4$ 时的 $(2,2)$ 或 $C=6$ 时的 $(3,3)$）的BAF值恒为 $0.5$，对约束纯度 $p$ 没有帮助，从而保留了纯度-倍性的模糊性。

#### 形式化约束与统计推断

通过观测到的 $(L, \text{BAF})$ 数据点，我们可以为给定的纯度 $p$ 反解出可能的整数等位基因拷贝数 $(a,b)$。通过重排 $L$ 和 BAF 的公式，我们可以为总拷贝数 $s=a+b$ 和B等位基因拷贝数 $b$ 建立不等式约束。对于一个观测到的数据点 $(L, \text{BAF})$，其对应一个整数解 $(a,b)$ 的[可行域](@entry_id:136622)，从而将可能的拷贝数状态限制在一个很小的范围内 [@problem_id:4616105]。

在实践中，这些原理被整合到复杂的[统计模型](@entry_id:755400)中，如[隐马尔可夫模型](@entry_id:141989)（HMM）或[贝叶斯网络](@entry_id:261372)。例如，我们可以为一组观测到的VAF数据构建一个**似然函数 (likelihood function)**。假设VAF的读数抽样遵循[二项分布](@entry_id:141181)，其[似然函数](@entry_id:141927)可以写成：

$$
L(p,f \mid \{(k_i,n_i)\}) = \prod_{i=1}^{K} \binom{n_i}{k_i} q(p,f)^{k_i} (1 - q(p,f))^{n_i - k_i}
$$

其中 $(k_i, n_i)$ 是第 $i$ 个突变的变异读数和总读数，$q(p,f)$ 是期望VAF。通过最大化这个[似然函数](@entry_id:141927)，我们可以获得参数（如 $p$）的**最大似然估计 (Maximum Likelihood Estimator, MLE)** [@problem_id:4616082]。现代算法通过对整个基因组的所有 $L$、BAF 和 VAF 数据点构建一个[联合似然](@entry_id:750952)模型，来同时搜索最优的 $(p, \pi)$ 解。

### 应对真实数据中的实际混杂因素

上述模型是在理想化假设下建立的。在处理真实的测序数据时，还必须考虑一些实际的混杂因素，它们可能扭曲观测信号，导致错误的推断。

#### 可作图性偏倚 (Mappability Bias)

基因组的某些区域由于含有重复序列，导致测序读数无法被唯一地比对到该位置，这一属性被称为**可作图性 (mappability)**。低可作图性区域的有效[测序深度](@entry_id:178191)会系统性地降低，即使其真实拷贝数是正常的。这种效应会引入一个与拷贝数无关的偏倚，混淆 $L$ 值的解读。

假设一个片段 $j$ 的可作图性因子为 $\mu_j \in (0,1]$，那么在只使用肿瘤样本进行标准化时，期望的对数[R比](@entry_id:161177)率会包含一个偏倚项：
$$
\text{E}[L^{\text{tumor-only}}_{j}] = \log_{2}(\mu_j) + \log_{2}\left(\frac{p C_j + 2(1-p)}{2}\right)
$$
由于 $\mu_j \le 1$，$\log_2(\mu_j)$ 是一个负值或零，它会系统性地拉低 $L$ 值，可能将一个正常的拷贝数区域误判为缺失，或将一个扩增区域误判为正常。

解决这个问题最有效的方法是使用**配对的正常样本 (matched normal)** 作为对照。通过计算肿瘤样本和正常样本在同一片段的标准化读[数密度](@entry_id:268986)之比，可以消除共同的可作图性因子 $\mu_j$ 和文库大小的差异，得到一个校正后的对数比率 $L_j^*$，它能更准确地反映真实的拷贝数变化 [@problem_id:4616125]。

#### 样本交叉污染

另一个潜在的复杂因素是样本间的交叉污染，尤其是**正常样本中的肿瘤污染 (Tumor-in-Normal, TiN)**。在样本处理过程中，少量肿瘤细胞或其DNA可能混入本应是纯净的正常对照样本中。这将导致正常样本的BAF不再是理想的 $0.5$（对于杂合位点），而是被拉向肿瘤的BAF值。

如果忽略TiN污染，将污染的正常样本作为基准，会导致对肿瘤等位基因拷贝数的推断产生系统性偏差。假设肿瘤样本的纯度为 $\rho$，而正常样本中的肿瘤DNA污染比例为 $\eta$，我们可以建立一个更复杂的[混合模型](@entry_id:266571)，同时对两个样本的BAF进行建模。通过求解这个方程组，可以消除污染引入的基准BAF（记为 $X$）和正常细胞固有的等位基因偏倚，从而精确求解出肿瘤本身的B等位基因组分 $p_B$ [@problem_id:4616124]。这个校正过程对于精确解析肿瘤的等位[基因结构](@entry_id:190285)，特别是在低纯度样本或研究微小残留病灶时，至关重要。

综上所述，肿瘤纯度和倍性的估计是一个多层次的推断过程。它始于建立一个基于物理混合原理的数学模型，然后利用基因组中不同类型的信号（总拷贝数、等位基因频率、突[变频](@entry_id:196535)率）来联合约束模型参数，并最终考虑和校正真实世界数据中的各种技术偏倚。只有通过这样系统而严谨的方法，我们才能从复杂的混合测[序数](@entry_id:150084)据中准确地重构出肿瘤基因组的真实面貌。