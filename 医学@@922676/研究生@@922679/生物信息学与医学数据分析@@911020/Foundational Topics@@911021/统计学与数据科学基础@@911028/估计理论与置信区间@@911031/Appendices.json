{"hands_on_practices": [{"introduction": "在任何生物信息学或临床研究中，一个基本问题是在项目开始前确定需要多少样本。本练习将理论与实践相结合，引导您推导置信区间宽度、样本量 $n$、方差 $\\sigma^2$ 和置信水平 $1-\\alpha$ 之间的基本关系。通过解决这个在生物标志物研究背景下提出的问题 [@problem_id:4560495]，您将掌握估算所需样本量的核心技能，以达到预期的估计精度。", "problem": "一项全身性炎症的临床生物标志物以毫克/升 (mg/L) 为单位进行量化。研究人员计划进行一项研究，旨在使用置信水平为 $1 - \\alpha = 0.95$ 的双侧置信区间 (CI) 来估计该生物标志物的总体均值 $\\mu$。根据一项对多个独立队列进行的先前元分析，该生物标志物的受试者内测量过程和生物学变异性，可以通过均值为 $\\mu$、已知方差为 $\\sigma^{2}$ 的独立同分布 (i.i.d.) 高斯观测值 $X_{1}, X_{2}, \\dots, X_{n}$ 很好地进行建模。该元分析提供了一个经过外部验证的方差估计值 $\\sigma^{2} = 64$ (mg/L)$^{2}$，在进行研究计划时可将其视为已知值。\n\n从双侧置信区间的核心定义以及已知方差的高斯模型下样本均值的抽样分布出发，推导出一个连接置信区间宽度 $W$、样本量 $n$、方差 $\\sigma^{2}$ 以及标准正态分布的相应分位数之间的关系式。然后，利用此关系式，确定能保证在置信水平 0.95 下，为 $\\mu$ 设计的双侧置信区间总宽度为 $W = 3$ mg/L 的最小整数 $n$。\n\n将最终的样本量 $n$ 报告为单个整数。如果计算结果为非整数，应选择满足宽度约束 $W \\leq 3$ mg/L 的最小整数 $n$。最终数值答案中请勿包含任何单位。", "solution": "本题要求在已知总体方差 $\\sigma^2$ 的情况下，为使总体均值 $\\mu$ 的置信区间达到指定的宽度，确定所需的最小样本量 $n$。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- 待估计的总体参数：总体生物标志物水平均值，$\\mu$。\n- 数据模型：独立同分布 (i.i.d.) 的高斯观测值 $X_{1}, X_{2}, \\dots, X_{n}$。\n- 观测值分布：$X_i \\sim N(\\mu, \\sigma^2)$。\n- 已知总体方差：$\\sigma^2 = 64$ (mg/L)$^2$。\n- 置信水平：$1 - \\alpha = 0.95$。\n- 期望的双侧置信区间总宽度：$W = 3$ mg/L。\n- 约束条件：最终样本量 $n$ 必须是满足宽度要求的最小整数。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题牢固地建立在假设检验和估计的标准统计理论之上，特别是为已知方差的正态分布均值构建置信区间。这是生物统计学和临床试验设计中的一个经典问题。所提供的值对于生物学测量是合理的。\n- **适定性：** 该问题是适定的。它提供了所有必要的信息（$\\sigma^2$、置信水平、目标宽度），足以确定样本量 $n$ 的唯一整数解。\n- **客观性：** 问题陈述是客观、精确的，没有歧义或主观性语言。\n\n**1.3. 结论：**\n该问题是有效的。它在科学上是合理的，是适定的和客观的。没有矛盾、信息缺失或违反基本原则的情况。我们可以继续进行求解。\n\n### 步骤 2：推导与求解\n\n总体均值 $\\mu$ 的估计量是样本均值 $\\bar{X}$，定义为：\n$$\n\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i\n$$\n鉴于 $X_i$ 是从正态分布 $N(\\mu, \\sigma^2)$ 中抽取的独立同分布随机变量，样本均值 $\\bar{X}$ 的抽样分布也服从正态分布。$\\bar{X}$ 的均值为 $E[\\bar{X}] = \\mu$，其方差为 $\\text{Var}(\\bar{X}) = \\frac{\\sigma^2}{n}$。因此，抽样分布为：\n$$\n\\bar{X} \\sim N\\left(\\mu, \\frac{\\sigma^2}{n}\\right)\n$$\n为了构建置信区间，我们使用一个其分布不依赖于未知参数 $\\mu$ 的枢轴量。我们对 $\\bar{X}$ 进行标准化，以获得一个标准正态随机变量 $Z$：\n$$\nZ = \\frac{\\bar{X} - \\mu}{\\sigma / \\sqrt{n}} \\sim N(0, 1)\n$$\n置信水平为 $1 - \\alpha$ 的双侧置信区间是根据以下概率陈述构建的：\n$$\nP(-z_{\\alpha/2} \\le Z \\le z_{\\alpha/2}) = 1 - \\alpha\n$$\n其中 $z_{\\alpha/2}$ 是标准正态分布的上 $\\alpha/2$ 分位数，其定义为 $P(Z > z_{\\alpha/2}) = \\alpha/2$。\n\n代入 $Z$ 的表达式可得：\n$$\nP\\left(-z_{\\alpha/2} \\le \\frac{\\bar{X} - \\mu}{\\sigma / \\sqrt{n}} \\le z_{\\alpha/2}\\right) = 1 - \\alpha\n$$\n我们整理不等式以分离出参数 $\\mu$：\n$$\n-z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le \\bar{X} - \\mu \\le z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n$$\n-\\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le -\\mu \\le -\\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n$$\n\\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le \\mu \\le \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n这就定义了 $\\mu$ 的 $100(1-\\alpha)\\%$ 置信区间：\n$$\n\\text{CI} = \\left[ \\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}, \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\right]\n$$\n该置信区间的总宽度 $W$ 是其上限与下限之差：\n$$\nW = \\left( \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\right) - \\left( \\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\right) = 2 z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n这个方程提供了连接宽度 $W$、样本量 $n$、标准差 $\\sigma$ 和标准正态分位数 $z_{\\alpha/2}$ 所需的关系。\n\n问题要求总宽度为 $W = 3$ mg/L。更准确地说，计划的宽度应最多为 3 mg/L。因此，我们有以下不等式：\n$$\nW \\le 3 \\implies 2 z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le 3\n$$\n现在我们可以求解 $n$：\n$$\n\\sqrt{n} \\ge \\frac{2 z_{\\alpha/2} \\sigma}{3}\n$$\n$$\nn \\ge \\left( \\frac{2 z_{\\alpha/2} \\sigma}{3} \\right)^2\n$$\n现在我们代入给定的值。\n置信水平为 $1 - \\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。标准正态分布对应的分位数是 $z_{0.025}$。这个值对应的累积概率为 $1 - 0.025 = 0.975$。$z_{0.025}$ 的标准值约为 $1.96$。\n已知方差为 $\\sigma^2 = 64$ (mg/L)$^2$，因此标准差为 $\\sigma = \\sqrt{64} = 8$ mg/L。\n期望的最大宽度为 $W = 3$ mg/L。\n\n将这些值代入关于 $n$ 的不等式中：\n$$\nn \\ge \\left( \\frac{2 \\times 1.96 \\times 8}{3} \\right)^2\n$$\n$$\nn \\ge \\left( \\frac{31.36}{3} \\right)^2\n$$\n$$\nn \\ge (10.4533...)^2\n$$\n$$\nn \\ge 109.2718...\n$$\n由于样本量 $n$ 必须是整数，我们必须取大于或等于 $109.2718...$ 的最小整数。这是确保宽度约束 $W \\le 3$ 得以满足所必需的。因此，所需的最小样本量为 $n=110$。", "answer": "$$\\boxed{110}$$", "id": "4560495"}, {"introduction": "线性回归是分析生物数据中变量关系的重要工具，但其预测的不确定性有两种截然不同的形式。本练习 [@problem_id:4560427] 探讨了平均响应 $\\mu(x_0)$ 的置信区间与单个未来观测值 $Y_{\\text{new}}(x_0)$ 的预测区间之间的关键区别。通过在药物基因组学剂量反应分析的场景中推导和计算这两个区间，您将深刻理解预测不确定性的两个来源——模型参数估计的不确定性和体现在预测区间中的固有随机误差 $\\sigma^2$。", "problem": "一项药物基因组学分析应用线性回归来量化在对照研究中，信使核糖核酸测序（RNA-seq）对数转换后的转录本丰度如何响应剂量。设 $Y_i$ 表示受试者 $i$ 的细胞色素P450 $2\\text{D}6$ 基因的 log$_2$ 百万转录本表达量，设 $X_i$ 表示给药剂量，单位为 $\\text{mg}\\cdot\\text{kg}^{-1}$。考虑简单线性模型 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$，其中 $(\\varepsilon_1,\\ldots,\\varepsilon_n)$ 独立同分布于 $\\mathcal{N}(0,\\sigma^2)$，且独立于 $(X_1,\\ldots,X_n)$。对 $n=20$ 名受试者的普通最小二乘拟合得到以下摘要：$\\hat{\\beta}_0 = 6.2$，$\\hat{\\beta}_1 = -0.8$，残差均方误差 $\\hat{\\sigma}^2 = 0.36$，样本剂量均值 $\\bar{X} = 2.5$，以及 $S_{XX} = \\sum_{i=1}^{n} (X_i - \\bar{X})^2 = 40$。对于一个新的协变量值 $x_0 = 3$，请执行以下操作：\n\n- 从上述假设和线性模型的标准定义出发，推导期望响应 $\\mu(x_0) = \\beta_0 + \\beta_1 x_0$ 的双侧置信水平为 $0.95$ 的置信区间的形式，以及在相同 $x_0$ 处未来观测值 $Y_{\\text{new}}(x_0)$ 的双侧置信水平为 $0.95$ 的预测区间的形式，并明确说明残差方差的引入如何使预测区间相对于置信区间发生变化。\n\n- 使用提供的摘要数值计算这两个区间。然后，报告在 $x_0$ 处预测区间半宽与置信区间半宽的比率。\n\n将最终比率表示为单个数字。如果您选择给出小数近似值，请将答案四舍五入到四位有效数字。该比率为无量纲量。", "solution": "该设置为标准简单线性回归，模型为 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$，其中 $(\\varepsilon_i)$ 独立同分布，$\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$，且与协变量无关。在这些假设下，普通最小二乘估计量 $\\hat{\\boldsymbol{\\beta}} = (\\hat{\\beta}_0,\\hat{\\beta}_1)^{\\top}$ 是无偏的、正态分布的，并且在给定设计下其协方差矩阵等于 $\\sigma^2 (X^{\\top}X)^{-1}$，其中 $X$ 是 $n \\times 2$ 的设计矩阵，第一列为 $1$，第二列为 $(X_i)$。\n\n对于一个固定的 $x_0$，预测的平均响应是线性泛函\n$$\n\\hat{y}(x_0) = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_0.\n$$\n根据正态估计量线性函数的性质，\n$$\n\\hat{y}(x_0) \\mid X \\sim \\mathcal{N}\\!\\left(\\mu(x_0),\\ \\sigma^2\\,\\operatorname{Var}\\big(\\hat{\\beta}_0 + \\hat{\\beta}_1 x_0\\big)\\right).\n$$\n对于简单线性回归，可以计算出\n$$\n\\operatorname{Var}\\big(\\hat{\\beta}_0 + \\hat{\\beta}_1 x_0\\big) = \\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}},\n$$\n其中 $S_{XX} = \\sum_{i=1}^{n} (X_i - \\bar{X})^2$。这可从双参数设计的 $(X^{\\top}X)^{-1}$ 的显式形式以及通过线性组合的方差传播得出。\n\n由于 $\\sigma^2$ 未知，我们用其无偏估计量 $\\hat{\\sigma}^2$ 代替，其中 $\\hat{\\sigma}^2 = \\text{RSS}/(n-2)$，$\\text{RSS}$ 是残差平方和。标准化枢轴量\n$$\nT_{\\text{mean}}(x_0) = \\frac{\\hat{y}(x_0) - \\mu(x_0)}{\\hat{\\sigma}\\,\\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}}}\n$$\n服从自由度为 $n-2$ 的学生t分布。因此，$\\mu(x_0)$ 的一个双侧置信水平为 $0.95$ 的置信区间是\n$$\n\\hat{y}(x_0) \\ \\pm\\ t_{0.975,\\,n-2}\\ \\hat{\\sigma}\\ \\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}}.\n$$\n\n对于在 $x_0$ 处的一个未来观测值，记为 $Y_{\\text{new}}(x_0) = \\mu(x_0) + \\varepsilon_{\\text{new}}$，其中 $\\varepsilon_{\\text{new}} \\sim \\mathcal{N}(0,\\sigma^2)$ 且与数据独立。预测误差可以分解为\n$$\nY_{\\text{new}}(x_0) - \\hat{y}(x_0) = \\big(\\mu(x_0) - \\hat{y}(x_0)\\big) + \\varepsilon_{\\text{new}},\n$$\n其中 $\\mu(x_0) - \\hat{y}(x_0)$ 是正态分布，均值为 $0$，方差为 $\\sigma^2\\left(\\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}\\right)$，且与 $\\varepsilon_{\\text{new}}$ 独立。因此，\n$$\n\\operatorname{Var}\\big(Y_{\\text{new}}(x_0) - \\hat{y}(x_0)\\big) = \\sigma^2\\left(1 + \\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}\\right).\n$$\n使用相同的替换 $\\sigma^2 \\to \\hat{\\sigma}^2$，并且类似的标准化枢轴量服从自由度为 $n-2$ 的学生t分布，可以得到 $Y_{\\text{new}}(x_0)$ 的一个双侧置信水平为 $0.95$ 的预测区间是\n$$\n\\hat{y}(x_0) \\ \\pm\\ t_{0.975,\\,n-2}\\ \\hat{\\sigma}\\ \\sqrt{1 + \\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}}.\n$$\n其区别在于预测区间的平方根内多了一个 $1$，这反映了新观测值围绕其均值 $\\mu(x_0)$ 的不可约残差变异 $\\sigma^2$。\n\n现在根据给定的摘要在 $x_0 = 3$ 处计算这些量。首先，\n$$\n\\hat{y}(3) = \\hat{\\beta}_0 + \\hat{\\beta}_1 \\cdot 3 = 6.2 + (-0.8)\\cdot 3 = 3.8.\n$$\n接下来，计算\n$$\n\\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}} = \\frac{1}{20} + \\frac{(3 - 2.5)^2}{40} = 0.05 + \\frac{0.25}{40} = 0.05 + 0.00625 = 0.05625.\n$$\n注意 $0.05625 = \\frac{9}{160}$，因为 $\\frac{0.25}{40} = \\frac{1}{160}$。因此，\n$$\n\\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}} = \\sqrt{\\frac{9}{160}} = \\frac{3}{4\\sqrt{10}}.\n$$\n相应的预测区间标准因子是\n$$\n\\sqrt{1 + \\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}} = \\sqrt{1 + \\frac{9}{160}} = \\sqrt{\\frac{169}{160}} = \\frac{13}{4\\sqrt{10}}.\n$$\n\n自由度为 $n-2 = 18$，置信水平为 $0.95$ 时，临界值 $t_{0.975,\\,18}$ 近似为 $2.100922$。使用 $\\hat{\\sigma} = \\sqrt{0.36} = 0.6$，置信区间的半宽为\n$$\nh_{\\text{CI}} = t_{0.975,\\,18}\\ \\hat{\\sigma}\\ \\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}} = 2.100922 \\times 0.6 \\times \\frac{3}{4\\sqrt{10}},\n$$\n预测区间的半宽为\n$$\nh_{\\text{PI}} = t_{0.975,\\,18}\\ \\hat{\\sigma}\\ \\sqrt{1 + \\frac{1}{n} + \\frac{(x_0 - \\bar{X})^2}{S_{XX}}} = 2.100922 \\times 0.6 \\times \\frac{13}{4\\sqrt{10}}.\n$$\n数值上，\n$$\nh_{\\text{CI}} \\approx 2.100922 \\times 0.6 \\times 0.237170 \\approx 0.298,\n$$\n且\n$$\nh_{\\text{PI}} \\approx 2.100922 \\times 0.6 \\times 1.027939 \\approx 1.296.\n$$\n因此，$\\mu(3)$ 的置信水平为 $0.95$ 的置信区间近似为 $3.8 \\pm 0.298$，$Y_{\\text{new}}(3)$ 的置信水平为 $0.95$ 的预测区间近似为 $3.8 \\pm 1.296$。\n\n所要求的半宽比率为\n$$\nR = \\frac{h_{\\text{PI}}}{h_{\\text{CI}}} = \\frac{t_{0.975,\\,18}\\ \\hat{\\sigma}\\ \\frac{13}{4\\sqrt{10}}}{t_{0.975,\\,18}\\ \\hat{\\sigma}\\ \\frac{3}{4\\sqrt{10}}} = \\frac{13}{3}.\n$$\n对于给定的 $n$、$\\bar{X}$、$S_{XX}$ 和 $x_0$，这个比率是精确的，因为 $t$ 临界值和 $\\hat{\\sigma}$ 会相互抵消。如果偏好小数形式，$\\frac{13}{3} \\approx 4.3333$。", "answer": "$$\\boxed{\\frac{13}{3}}$$", "id": "4560427"}, {"introduction": "生物医学数据，特别是浓度等测量值，常常呈现出偏态分布，这使得基于正态性假设的标准方法（如学生 $t$-区间）的有效性受到质疑。本练习 [@problem_id:4560482] 通过一个模拟研究，让您亲手比较在偏态数据下，$t$-区间的实际覆盖率与更稳健的非参数自助法 BCa 区间的表现。这项实践将使您掌握评估和应对模型假设被违反时情况的关键能力，并展示自助法在现代生物数据分析中的强大威力。", "problem": "给定一个严格为正的生物标志物的独立同分布（i.i.d.）样本，其总体分布呈正偏态，这是生物信息学和医学数据分析中针对类似浓度测量的常见情景。假设该生物标志物浓度分布为对数正态分布，这对于非负的、乘性的生物过程是符合实际的，并专注于估计总体均值。您的任务是通过模拟研究两种均值置信区间方法的覆盖概率：一种是学生t置信区间（Student’s $t$-interval），另一种是非参数自助法的偏差校正和加速（BCa）区间。\n\n设计应仅基于基本且经过充分检验的原理：中心极限定理、置信区间作为具有名义覆盖率的区间估计量的定义、在正态性假设下当方差未知时标准化样本均值服从学生t分布、用于近似抽样分布的非参数自助重抽样定义，以及用于估计BCa区间中加速项的刀切法（jackknife）。除这些基础原理外，不假设任何额外的简化公式。\n\n定义和要求：\n- 设 $X_1,\\dots,X_n$ 为来自参数为 $(\\mu, \\sigma)$ 的对数正态分布的独立同分布样本，即 $\\log(X_i) \\sim \\mathcal{N}(\\mu, \\sigma^2)$。$X$ 的总体均值为 $\\theta = \\mathbb{E}[X] = \\exp(\\mu + \\sigma^2/2)$。\n- 均值的学生t置信区间由样本均值和样本标准差构造。对于给定的 $\\alpha \\in (0,1)$，其名义水平为 $1-\\alpha$。\n- 偏差校正和加速（BCa）区间是一种非参数自助置信区间，它使用通过刀切法计算的偏差校正项和加速项。使用对原始样本的非参数自助重抽样来近似均值的抽样分布。使用刀切法估计加速参数。\n- 对于区间 $\\mathcal{I}(X_1,\\dots,X_n)$，其相对于 $\\theta$ 的覆盖概率为 $\\mathbb{P}(\\theta \\in \\mathcal{I}(X_1,\\dots,X_n))$。您将通过蒙特卡洛方法，即在许多独立的模拟数据集上计算指示函数 $\\mathbf{1}\\{\\theta \\in \\mathcal{I}\\}$ 的平均值，来估计该概率。\n\n实现一个程序，该程序：\n1. 对于下面测试套件中的每组参数，从指定的对数正态分布中重复模拟 $R$ 个独立的数据集 $X_1,\\dots,X_n$。\n2. 对于每个数据集，计算：\n   - 一个名义水平为 $1-\\alpha$ 的均值双侧学生t置信区间，\n   - 一个名义水平相同、使用 $B$ 个自助法重复次数和刀切法计算加速参数的均值双侧非参数自助法BCa区间。\n3. 对于每种方法和每组参数，通过覆盖指示函数相对于真实均值 $\\theta = \\exp(\\mu + \\sigma^2/2)$ 的蒙特卡洛平均值，计算经验覆盖概率。\n4. 使用固定的伪随机数生成器种子 $20231105$，以确保不同运行结果的可复现性。\n\n蒙特卡洛指南：\n- 您的覆盖率蒙特卡洛估计量必须是取值于 $\\{0,1\\}$ 的指示变量的样本均值，结果为一个在 $[0,1]$ 内的浮点数。\n- 为确保BCa计算中的数值稳定性，在必要时，任何累积分布函数的参数或分位数概率水平都应被裁剪到开区间 $(0,1)$ 内。\n\n不涉及角度或物理单位。所有概率必须表示为小数，而非百分比。将每个报告的覆盖率和差异四舍五入到四位小数；允许打印时尾随零较少。\n\n测试套件：\n- 情况 A（中等 $n$，中等偏度）：$n=20$，$\\mu=2.0$，$\\sigma=1.0$，$\\alpha=0.05$，$B=500$，$R=200$。\n- 情况 B（较大 $n$，轻微偏度）：$n=50$，$\\mu=2.0$，$\\sigma=0.5$，$\\alpha=0.05$，$B=400$，$R=200$。\n- 情况 C（小 $n$，重偏度）：$n=15$，$\\mu=1.5$，$\\sigma=1.2$，$\\alpha=0.05$，$B=500$，$R=200$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。\n- 对于每个测试用例，按 A、B、C 的顺序，附加三个浮点数：\n  1. 学生t置信区间的经验覆盖率，\n  2. BCa区间的经验覆盖率，\n  3. 差值“BCa覆盖率减去t覆盖率”。\n- 因此，输出必须是包含9个浮点数的单行：$[t_A, bca_A, \\Delta_A, t_B, bca_B, \\Delta_B, t_C, bca_C, \\Delta_C]$，其中每个条目都按规定四舍五入到四位小数。", "solution": "所提出的问题要求进行一项模拟研究，以比较学生t置信区间（Student’s $t$-confidence interval）和非参数自助法偏差校正和加速（BCa）置信区间在估计对数正态分布均值时的经验覆盖概率。该问题在科学和数学上是适定的，为进行严谨的计算实验提供了所有必要的参数和定义。其背景，即对偏态生物标志物数据的估计，是生物统计学中一个成熟的领域。待比较的方法——一种经典的参数方法和一种现代的、计算密集型的非参数方法——是统计推断中的标准工具。目标是量化每种方法在偏态数据上的实际覆盖概率与其名义置信水平的比较情况。该问题是有效的，我将着手提供一个完整的解决方案。\n\n解决方案的核心是蒙特卡洛模拟。对于给定的一组参数——样本量 $n$、对数正态分布参数 $\\mu$ 和 $\\sigma$、以及显著性水平 $\\alpha$——我们将在 $R$ 次独立重复中执行以下步骤：\n1. 从参数为 $(\\mu, \\sigma)$ 的对数正态分布中生成一个样本 $X_1, \\dots, X_n$。其基础的正态分布 $\\log(X_i)$ 为 $\\mathcal{N}(\\mu, \\sigma^2)$。\n2. 计算我们置信区间的目标——真实总体均值。对于对数正态分布，该值为 $\\theta = \\mathbb{E}[X] = \\exp(\\mu + \\sigma^2/2)$。\n3. 构建一个双侧 $(1-\\alpha)$ 的学生t置信区间。\n4. 构建一个双侧 $(1-\\alpha)$ 的BCa自助法置信区间。\n5. 对每个区间，记录它是否成功捕获了真实均值 $\\theta$。\n在所有 $R$ 次重复完成后，每种方法的经验覆盖概率被估计为相应区间包含 $\\theta$ 的次数所占的比例。\n\n在此，我们详细说明每种置信区间程序背后的理论原理。\n\n**学生t置信区间**\n该区间是频率派推断的基石。对于一个样本 $\\{x_1, \\dots, x_n\\}$，样本均值为 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^n x_i$，样本标准差为 $s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^n (x_i - \\bar{x})^2}$。中心极限定理（CLT）指出，对于足够大的样本量 $n$，标准化均值 $\\frac{\\bar{X} - \\theta}{S/\\sqrt{n}}$ 的抽样分布近似于一个自由度为 $n-1$ 的学生t分布。这为构建区间提供了基础：\n$$ \\mathcal{I}_t = \\left[ \\bar{x} - t_{1-\\alpha/2, n-1} \\frac{s}{\\sqrt{n}}, \\quad \\bar{x} + t_{1-\\alpha/2, n-1} \\frac{s}{\\sqrt{n}} \\right] $$\n其中 $t_{1-\\alpha/2, n-1}$ 是自由度为 $n-1$ 的学生t分布的 $(1-\\alpha/2)$ 分位数。该区间的有效性依赖于样本均值抽样分布的正态性。对于来自像对数正态分布这样高度偏态分布的小样本，此假设被违反，实际覆盖概率可能与名义水平 $1-\\alpha$ 有显著偏差。\n\n**非参数自助法BCa置信区间**\n自助法（bootstrap）是一种重抽样方法，用于在不对总体做出强分布假设的情况下近似统计量的抽样分布。BCa区间通过引入两个校正因子来增强简单的百分位自助法：一个偏差校正项 $z_0$ 和一个加速项 $a$。这些因子调整区间端点，以分别解释自助法分布中的偏度和估计量方差的非恒定性，从而达到更高阶的准确性。\n\nBCa区间的构建过程如下：\n1.  **自助重抽样**：通过从原始样本中有放回地抽取 $n$ 个观测值来生成 $B$ 个自助样本。对每个自助样本计算感兴趣的统计量（样本均值），从而得到一组自助估计量 $\\{\\hat{\\theta}^*_1, \\dots, \\hat{\\theta}^*_B\\}$。这个集合被称为自助分布，它作为样本均值 $\\hat{\\theta}$ 真实抽样分布的经验近似。\n\n2.  **偏差校正 ($z_0$)**：偏差校正因子衡量自助分布的中位数偏差。其计算公式为：\n    $$ z_0 = \\Phi^{-1} \\left( \\frac{1}{B} \\sum_{b=1}^{B} \\mathbf{1}\\{\\hat{\\theta}^*_b  \\hat{\\theta}\\} \\right) $$\n    其中 $\\hat{\\theta}$ 是原始数据的样本均值，$\\Phi^{-1}$ 是标准正态分布 $\\mathcal{N}(0, 1)$ 的逆累积分布函数（CDF），$\\mathbf{1}\\{\\cdot\\}$ 是指示函数。如果自助分布是中位数无偏的（即其中位数等于 $\\hat{\\theta}$），则该比例为 $0.5$ 且 $z_0=0$。\n\n3.  **加速项 ($a$)**：加速项解释了估计量标准误相对于参数的变化率，它捕捉了抽样分布的偏度。它通过刀切法（jackknife method）进行估计：\n    -   计算 $n$ 个均值的刀切估计量 $\\hat{\\theta}_{(i)}$，每个都是通过从原始样本中剔除第 $i$ 个观测值得到的。\n    -   令 $\\hat{\\theta}_{(\\cdot)} = \\frac{1}{n}\\sum_{i=1}^n \\hat{\\theta}_{(i)}$ 为这些刀切估计量的均值。\n    -   则加速项为：\n        $$ a = \\frac{\\sum_{i=1}^n (\\hat{\\theta}_{(\\cdot)} - \\hat{\\theta}_{(i)})^3}{6 \\left[ \\sum_{i=1}^n (\\hat{\\theta}_{(\\cdot)} - \\hat{\\theta}_{(i)})^2 \\right]^{3/2}} $$\n\n4.  **调整后的区间端点**：BCa区间使用调整后的概率水平 $\\alpha_1$ 和 $\\alpha_2$ 从自助分布中找到端点。这些值是使用 $z_0$ 和 $a$ 计算的：\n    $$ \\alpha_1 = \\Phi \\left( z_0 + \\frac{z_0 + z_{\\alpha/2}}{1 - a(z_0 + z_{\\alpha/2})} \\right) $$\n    $$ \\alpha_2 = \\Phi \\left( z_0 + \\frac{z_0 + z_{1-\\alpha/2}}{1 - a(z_0 + z_{1-\\alpha/2})} \\right) $$\n    其中 $\\Phi$ 是标准正态CDF，$z_p = \\Phi^{-1}(p)$ 是标准正态分位数函数。\n\n5.  **最终区间**：BCa置信区间由排序后的自助分布 $\\{\\hat{\\theta}^*_b\\}$ 的 $\\alpha_1$ 和 $\\alpha_2$ 分位数给出：\n    $$ \\mathcal{I}_{BCa} = \\left[ \\hat{\\theta}^*_{(\\alpha_1)}, \\hat{\\theta}^*_{(\\alpha_2)} \\right] $$\n\n这种复杂的程序有望产生更接近名义水平 $1-\\alpha$ 的覆盖概率，特别是在测试套件中指定的小样本量和高偏度的挑战性情景下。模拟将为这一理论优势提供量化证据。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t, norm\n\ndef t_interval(data, alpha):\n    \"\"\"\n    Computes the two-sided Student's t-confidence interval for the mean.\n    \"\"\"\n    n = len(data)\n    if n  2:\n        return np.nan, np.nan\n    \n    mean = np.mean(data)\n    std_dev = np.std(data, ddof=1)\n    se = std_dev / np.sqrt(n)\n    \n    t_critical = t.ppf(1 - alpha / 2, df=n - 1)\n    \n    lower = mean - t_critical * se\n    upper = mean + t_critical * se\n    \n    return lower, upper\n\ndef bca_interval(data, alpha, B, stat_func, rng):\n    \"\"\"\n    Computes the nonparametric bootstrap BCa confidence interval for a statistic.\n    \"\"\"\n    n = len(data)\n    if n  2:\n        return np.nan, np.nan\n\n    # Original statistic from the sample\n    theta_hat = stat_func(data)\n\n    # 1. Generate bootstrap replicates of the statistic\n    bootstrap_indices = rng.choice(n, size=(B, n), replace=True)\n    bootstrap_samples = data[bootstrap_indices]\n    bootstrap_stats = np.apply_along_axis(stat_func, 1, bootstrap_samples)\n\n    # 2. Bias-correction factor (z0)\n    # Proportion of bootstrap stats less than the original stat\n    prop_less = np.sum(bootstrap_stats  theta_hat) / B\n    # Clip for numerical stability if prop_less is 0 or 1\n    prop_less_clipped = np.clip(prop_less, 1e-10, 1 - 1e-10)\n    z0 = norm.ppf(prop_less_clipped)\n\n    # 3. Acceleration factor (a) using jackknife\n    jackknife_stats = np.zeros(n)\n    for i in range(n):\n        jackknife_sample = np.delete(data, i)\n        jackknife_stats[i] = stat_func(jackknife_sample)\n    \n    jackknife_mean = np.mean(jackknife_stats)\n    \n    # Calculate numerator and denominator for 'a'\n    numerator = np.sum((jackknife_mean - jackknife_stats) ** 3)\n    sum_sq_diffs = np.sum((jackknife_mean - jackknife_stats) ** 2)\n\n    # Handle cases where all jackknife estimates are identical (sum_sq_diffs=0)\n    if sum_sq_diffs == 0:\n        a = 0.0\n    else:\n        denominator = 6 * (sum_sq_diffs ** 1.5)\n        a = numerator / denominator\n\n    # 4. Adjusted interval endpoints (alpha1, alpha2)\n    z_alpha_half = norm.ppf(alpha / 2)\n    z_1m_alpha_half = norm.ppf(1 - alpha / 2)\n\n    # Numerators for the adjustment fractions\n    num1 = z0 + z_alpha_half\n    num2 = z0 + z_1m_alpha_half\n    \n    # Denominators for adjustment fractions, preventing division by zero\n    den1 = 1 - a * num1\n    if den1 == 0: den1 = 1e-10\n    den2 = 1 - a * num2\n    if den2 == 0: den2 = 1e-10\n\n    # Arguments for the final CDF evaluation\n    arg1 = z0 + num1 / den1\n    arg2 = z0 + num2 / den2\n\n    alpha1 = norm.cdf(arg1)\n    alpha2 = norm.cdf(arg2)\n    \n    # 5. Final interval from quantiles of the bootstrap distribution\n    # Using np.quantile handles interpolation for non-integer indices\n    lower = np.quantile(bootstrap_stats, alpha1)\n    upper = np.quantile(bootstrap_stats, alpha2)\n\n    return lower, upper\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (moderate n, moderate skew)\n        {'n': 20, 'mu': 2.0, 'sigma': 1.0, 'alpha': 0.05, 'B': 500, 'R': 200},\n        # Case B (larger n, mild skew)\n        {'n': 50, 'mu': 2.0, 'sigma': 0.5, 'alpha': 0.05, 'B': 400, 'R': 200},\n        # Case C (small n, heavy skew)\n        {'n': 15, 'mu': 1.5, 'sigma': 1.2, 'alpha': 0.05, 'B': 500, 'R': 200},\n    ]\n\n    # Initialize the random number generator with the specified seed\n    seed = 20231105\n    rng = np.random.default_rng(seed)\n\n    results = []\n    \n    stat_func = np.mean\n\n    for case in test_cases:\n        n, mu, sigma, alpha, B, R = case.values()\n\n        # True population mean for the log-normal distribution\n        theta_true = np.exp(mu + (sigma**2) / 2)\n\n        t_coverage_count = 0\n        bca_coverage_count = 0\n\n        for _ in range(R):\n            # 1. Generate a dataset from the log-normal distribution\n            # The `mean` and `sigma` arguments of rng.lognormal correspond to the\n            # mean and std. dev. of the underlying normal distribution.\n            data = rng.lognormal(mean=mu, sigma=sigma, size=n)\n\n            # 2. Compute the t-interval and check coverage\n            t_low, t_high = t_interval(data, alpha)\n            if t_low = theta_true = t_high:\n                t_coverage_count += 1\n\n            # 3. Compute the BCa interval and check coverage\n            bca_low, bca_high = bca_interval(data, alpha, B, stat_func, rng)\n            if bca_low = theta_true = bca_high:\n                bca_coverage_count += 1\n\n        # Calculate empirical coverage probabilities\n        t_coverage = t_coverage_count / R\n        bca_coverage = bca_coverage_count / R\n        coverage_diff = bca_coverage - t_coverage\n        \n        results.extend([\n            round(t_coverage, 4),\n            round(bca_coverage, 4),\n            round(coverage_diff, 4)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4560482"}]}