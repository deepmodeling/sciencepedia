{"hands_on_practices": [{"introduction": "在生物医学数据分析中，我们处理的数据往往并非完美，时常会包含极端值或异常值。虽然样本均值是衡量数据集中趋势最常用的指标，但它对异常值极为敏感，这一特性可能导致我们得出有偏的结论。本练习将引导您计算一种更为稳健的中心趋势估计量——截尾均值 (trimmed mean)，并量化比较它与样本均值在面对异常值时的稳定性，从而加深您对稳健统计方法在确保结论可靠性方面重要性的理解。[@problem_id:4555567]", "problem": "一个生物信息学团队正在使用酶联免疫吸附测定（ELISA）分析白细胞介素-6（IL-6）细胞因子浓度，单位为皮克/毫升。为了评估医学数据分析中汇总统计量对异常值的稳健性，请考虑以下来自 $20$ 个患者样本的模拟IL-6浓度：\n$\\{4, 5, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 400\\}$。\n\n您的任务是：\n- 仅使用描述性统计学的基本原理，计算给定数据集的样本均值和 $20\\%$ 截尾均值。截尾的解释是：对于大小为 $n$ 的数据集，丢弃最小和最大的 $k$ 个有序值（其中 $k = \\lfloor 0.2 n \\rfloor$），然后对剩余的值求平均。\n- 为了量化对异常值的敏感性，为数据集 $X$ 上的统计量 $T$ 定义异常值敏感性指数如下。设 $X'$ 是从 $X$ 中删除单个最大观测值后得到的数据集。定义 $\\Delta_{T} = |T(X) - T(X')|$。计算比率\n$$S = \\frac{\\Delta_{\\bar{X}}}{\\Delta_{T_{0.2}}},$$\n其中 $\\bar{X}$ 是样本均值，$T_{0.2}$ 是 $20\\%$ 截尾均值，每个值都是在其各自的数据集大小上独立计算的，并使用其自身的截尾参数 $k = \\lfloor 0.2 n \\rfloor$。\n\n请以精确有理数（不进行四舍五入）的形式提供您的最终数值答案。需要提交的最终答案是 $S$ 的单个值（无单位）。", "solution": "首先对用户提供的问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n- **数据集 $X$**：$\\{4, 5, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 400\\}$\n- **数据集大小 $n$**：$20$\n- **任务1**：计算 $X$ 的样本均值 ($\\bar{X}$) 和 $20\\%$ 截尾均值 ($T_{0.2}$)。\n- **截尾的定义**：对于大小为 $n$ 的数据集，丢弃最小和最大的 $k$ 个有序值（其中 $k = \\lfloor 0.2 n \\rfloor$），然后对剩余的值求平均。\n- **任务2**：计算异常值敏感性比率 $S$。\n- **$X'$ 的定义**：从 $X$ 中删除单个最大观测值后得到的数据集。\n- **敏感性指数 $\\Delta_T$ 的定义**：$\\Delta_{T} = |T(X) - T(X')|$，其中 $T$ 是一个统计量。\n- **比率 $S$ 的定义**：$S = \\frac{\\Delta_{\\bar{X}}}{\\Delta_{T_{0.2}}}$，其中 $\\bar{X}$ 是样本均值，$T_{0.2}$ 是 $20\\%$ 截尾均值。\n- **计算约束**：对于 $X'$ 上的计算，统计量（$\\bar{X}$ 和 $T_{0.2}$）在新数据集大小 $n'$ 及其对应的截尾参数 $k' = \\lfloor 0.2 n' \\rfloor$ 上独立计算。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **具有科学依据**：该问题基于描述性统计学的既定原理。分析含有异常值的细胞因子浓度是医学数据分析和生物信息学中的一个标准且现实的问题。样本均值、截尾均值和敏感性分析的概念是稳健统计学的基础。\n2.  **定义明确**：所有术语都有明确无误的定义。提供了数据集，并清晰地说明了计算步骤。为缩减后的数据集 $X'$ 重新计算截尾参数的规则确保了没有歧义，从而导向唯一的解。\n3.  **客观性**：问题使用精确、定量的语言陈述，不含主观或基于观点的论断。\n\n### 第3步：结论与行动\n问题是**有效的**。它具有科学性，定义明确，客观，并包含得出唯一解所需的所有信息。现在可以开始解题过程。\n\n### 解题推导\n\n初始数据集为 $X = \\{4, 5, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 400\\}$。该数据集已按升序排序。数据集的大小为 $n=20$。\n\n**1. 计算完整数据集 $X$ 的统计量**\n\n首先，我们计算 $X$ 的样本均值，记为 $\\bar{X}(X)$。\n$X$ 中所有观测值的和为：\n$$ \\sum_{i=1}^{n} x_i = (4+5+7+9+10+11+12+13+14+15+16+17+18+19+20+21+22+23+24) + 400 $$\n前 $19$ 个观测值的和是 $280$。\n$$ \\sum_{i=1}^{n} x_i = 280 + 400 = 680 $$\n样本均值为：\n$$ \\bar{X}(X) = \\frac{1}{n} \\sum_{i=1}^{n} x_i = \\frac{680}{20} = 34 $$\n\n接下来，我们计算 $X$ 的 $20\\%$ 截尾均值，记为 $T_{0.2}(X)$。\n从两端截去的观测值数量为 $k = \\lfloor 0.2 \\times n \\rfloor = \\lfloor 0.2 \\times 20 \\rfloor = \\lfloor 4 \\rfloor = 4$。\n我们丢弃 $4$ 个最小值 $\\{4, 5, 7, 9\\}$ 和 $4$ 个最大值 $\\{22, 23, 24, 400\\}$。\n用于计算截尾均值的剩余数据集包含 $n - 2k = 20 - 2(4) = 12$ 个观测值：\n$$ X_{T} = \\{10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21\\} $$\n这些值构成一个等差数列，它们的和是：\n$$ \\sum_{x \\in X_T} x = \\frac{12}{2} (10 + 21) = 6 \\times 31 = 186 $$\n$20\\%$ 截尾均值为：\n$$ T_{0.2}(X) = \\frac{186}{12} = \\frac{31}{2} $$\n\n**2. 计算缩减数据集 $X'$ 的统计量**\n\n数据集 $X'$ 是通过从 $X$ 中移除单个最大观测值（$400$）形成的。\n$$ X' = \\{4, 5, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24\\} $$\n这个新数据集的大小是 $n' = 19$。\n\n首先，我们计算 $X'$ 的样本均值，记为 $\\bar{X}(X')$。\n$X'$ 中观测值的和是 $X$ 的总和减去被移除的异常值：\n$$ \\sum_{x \\in X'} x = 680 - 400 = 280 $$\n$X'$ 的样本均值是：\n$$ \\bar{X}(X') = \\frac{280}{19} $$\n\n接下来，我们计算 $X'$ 的 $20\\%$ 截尾均值，记为 $T_{0.2}(X')$。\n根据 $n'=19$ 重新计算要截去的观测值数量：\n$$ k' = \\lfloor 0.2 \\times n' \\rfloor = \\lfloor 0.2 \\times 19 \\rfloor = \\lfloor 3.8 \\rfloor = 3 $$\n我们从 $X'$ 中丢弃 $3$ 个最小值 $\\{4, 5, 7\\}$ 和 $3$ 个最大值 $\\{22, 23, 24\\}$。\n用于计算截尾均值的剩余数据集包含 $n' - 2k' = 19 - 2(3) = 13$ 个观测值：\n$$ X'_{T} = \\{9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21\\} $$\n这些值构成一个等差数列，它们的和是：\n$$ \\sum_{x \\in X'_{T}} x = \\frac{13}{2} (9 + 21) = \\frac{13}{2} (30) = 13 \\times 15 = 195 $$\n$X'$ 的 $20\\%$ 截尾均值是：\n$$ T_{0.2}(X') = \\frac{195}{13} = 15 $$\n\n**3. 计算敏感性指数和最终比率 $S$**\n\n样本均值的敏感性指数 $\\Delta_{\\bar{X}}$ 是：\n$$ \\Delta_{\\bar{X}} = |\\bar{X}(X) - \\bar{X}(X')| = \\left|34 - \\frac{280}{19}\\right| = \\left|\\frac{34 \\times 19}{19} - \\frac{280}{19}\\right| = \\left|\\frac{646 - 280}{19}\\right| = \\frac{366}{19} $$\n\n截尾均值的敏感性指数 $\\Delta_{T_{0.2}}$ 是：\n$$ \\Delta_{T_{0.2}} = |T_{0.2}(X) - T_{0.2}(X')| = \\left|\\frac{31}{2} - 15\\right| = \\left|\\frac{31}{2} - \\frac{30}{2}\\right| = \\frac{1}{2} $$\n\n最后，我们计算比率 $S$：\n$$ S = \\frac{\\Delta_{\\bar{X}}}{\\Delta_{T_{0.2}}} = \\frac{\\frac{366}{19}}{\\frac{1}{2}} = \\frac{366}{19} \\times 2 = \\frac{732}{19} $$\n数字 $19$ 是质数，而 $732$ 不是 $19$ 的倍数（$732 = 38 \\times 19 + 10$）。因此，该分数为最简分数。", "answer": "$$\n\\boxed{\\frac{732}{19}}\n$$", "id": "4555567"}, {"introduction": "在从描述数据转向对总体进行推断时，一个核心任务是基于样本估计总体参数。在生物医学研究中，我们常常需要从一个小型试点研究中估计一个比例，例如某种生物标志物的阳性率。尽管教科书中广泛介绍的瓦尔德 (Wald) 置信区间方法简单，但在小样本情况下其表现往往不佳。本练习将指导您从第一性原理出发，推导更为可靠的威尔逊 (Wilson) 分数置信区间，让您深入理解其理论基础，并通过动手计算直观地比较其与瓦尔德区间在实际应用中的性能差异。[@problem_id:4555572]", "problem": "一个转化肿瘤学团队正在试行一种二元免疫组织化学分析法，用以量化与靶向治疗反应相关的细胞表面生物标志物呈阳性的肿瘤活检比例。在该试点研究中，有 $n = 12$ 份独立的活检样本，其中 $x = 2$ 份呈阳性。设 $p$ 表示目标人群中该生物标志物呈阳性的真实概率。\n\n从二项抽样模型和双侧置信区间（CI）作为检验反演的定义出发，使用标准正态分位数 $z_{0.975}$ 推导 $p$ 的双侧置信水平为 $95\\%$ 的 Wilson 得分置信区间，并基于渐近正态近似推导 $p$ 的 Wald 置信区间。假设无连续性校正，并使用 $z_{0.975} = 1.96$。\n\n将区间长度定义为 $L = U - L_L$，其中 $U$ 和 $L_L$ 分别是上端点和下端点。计算观测数据（$n = 12$，$x = 2$）下的比值\n$$\nR \\;=\\; \\frac{L_{\\text{Wald}}}{L_{\\text{Wilson}}}\n$$\n将 $R$ 的最终数值答案四舍五入至四位有效数字。", "solution": "该问题要求推导二项比例 $p$ 的两种置信区间（CI），并随后为给定数据集计算它们的长度之比。这两种置信区间是 Wald 区间和 Wilson 得分区间。\n\n设 $n$ 为独立伯努利试验的次数，$x$ 为成功的次数。真实比例 $p$ 的点估计是样本比例 $\\hat{p} = x/n$。假设成功次数 $X$ 服从二项分布，$X \\sim \\text{Binomial}(n,p)$。根据中心极限定理，对于足够大的样本量 $n$，$\\hat{p}$ 的抽样分布可以近似为正态分布：$\\hat{p} \\approx \\mathcal{N}\\left(p, \\frac{p(1-p)}{n}\\right)$。\n\n指定的置信水平为 $95\\%$，对应的显著性水平为 $\\alpha = 0.05$。给出的标准正态分布分位数为 $z_{1-\\alpha/2} = z_{0.975} = 1.96$。\n\n**1. Wald 置信区间的推导与公式**\n\nWald 置信区间由 $\\hat{p}$ 分布的正态近似推导而来。它通过用样本估计值 $\\hat{p}$ 替代未知参数 $p$ 来近似 $\\hat{p}$ 的标准误 $SE = \\sqrt{p(1-p)/n}$。这给出了估计的标准误 $\\widehat{SE}(\\hat{p}) = \\sqrt{\\hat{p}(1-\\hat{p})/n}$。\n\n该置信区间由枢轴量 $Z = (\\hat{p}-p)/\\widehat{SE}(\\hat{p})$ 构建，假设其服从标准正态分布。$100(1-\\alpha)\\%$ 置信区间是满足以下条件的 $p$ 值范围：\n$$\n-z_{1-\\alpha/2} \\le \\frac{\\hat{p}-p}{\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}} \\le z_{1-\\alpha/2}\n$$\n求解 $p$ 可得区间：\n$$\n\\hat{p} \\pm z_{1-\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\n$$\n下端点（$L_L$）和上端点（$U$）分别为 $L_{L, \\text{Wald}} = \\hat{p} - z_{1-\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$ 和 $U_{\\text{Wald}} = \\hat{p} + z_{1-\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$。Wald 区间的长度是上、下端点之差：\n$$\nL_{\\text{Wald}} = U_{\\text{Wald}} - L_{L, \\text{Wald}} = 2 z_{1-\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\n$$\n\n**2. Wilson 得分置信区间的推导与公式**\n\nWilson 得分置信区间是通过反演比例 $p$ 的得分检验得出的。得分检验统计量使用原假设值 $p_0$ 来计算标准误，而不是样本估计值 $\\hat{p}$。检验统计量为：\n$$\nZ = \\frac{\\hat{p}-p_0}{\\sqrt{\\frac{p_0(1-p_0)}{n}}}\n$$\n$p$ 的置信区间包含所有使得原假设 $H_0: p = p_0$ 不被拒绝的 $p_0$ 值，即满足 $|Z| \\le z_{1-\\alpha/2}$ 的值。\n$$\n\\left| \\frac{\\hat{p}-p_0}{\\sqrt{\\frac{p_0(1-p_0)}{n}}} \\right| \\le z_{1-\\alpha/2}\n$$\n将两边平方并重新整理，得到一个关于 $p_0$ 的二次不等式：\n$$\n(\\hat{p}-p_0)^2 \\le z_{1-\\alpha/2}^2 \\left( \\frac{p_0(1-p_0)}{n} \\right)\n$$\n$$\nn(\\hat{p}^2 - 2\\hat{p}p_0 + p_0^2) \\le z_{1-\\alpha/2}^2 (p_0 - p_0^2)\n$$\n$$\n(n + z_{1-\\alpha/2}^2)p_0^2 - (2n\\hat{p} + z_{1-\\alpha/2}^2)p_0 + n\\hat{p}^2 \\le 0\n$$\n置信区间的端点是二次方程 $(n + z^2)p^2 - (2n\\hat{p} + z^2)p + n\\hat{p}^2 = 0$ 的根，其中 $z = z_{1-\\alpha/2}$。使用二次公式 $p = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，根为：\n$$\np = \\frac{(2n\\hat{p} + z^2) \\pm \\sqrt{(2n\\hat{p} + z^2)^2 - 4(n + z^2)(n\\hat{p}^2)}}{2(n + z^2)}\n$$\n化简判别式：\n$$\n\\sqrt{4n^2\\hat{p}^2 + 4n\\hat{p}z^2 + z^4 - 4n^2\\hat{p}^2 - 4n\\hat{p}^2z^2} = \\sqrt{z^2(4n\\hat{p}(1-\\hat{p}) + z^2)} = z\\sqrt{4n\\hat{p}(1-\\hat{p}) + z^2}\n$$\nWilson 得分区间的端点是：\n$$\np = \\frac{2n\\hat{p} + z^2 \\pm z\\sqrt{4n\\hat{p}(1-\\hat{p}) + z^2}}{2(n + z^2)}\n$$\nWilson 区间的长度是这些端点之差：\n$$\nL_{\\text{Wilson}} = \\frac{2z\\sqrt{4n\\hat{p}(1-\\hat{p}) + z^2}}{2(n + z^2)} = \\frac{z\\sqrt{4n\\hat{p}(1-\\hat{p}) + z^2}}{n + z^2}\n$$\n\n**3. 长度比的计算**\n\n给定数据：$n = 12$，$x = 2$，以及 $z_{0.975} = 1.96$。\n样本比例为 $\\hat{p} = \\frac{x}{n} = \\frac{2}{12} = \\frac{1}{6}$。\n\n首先，计算 Wald 区间的长度 $L_{\\text{Wald}}$：\n$$\nL_{\\text{Wald}} = 2(1.96)\\sqrt{\\frac{(1/6)(1 - 1/6)}{12}} = 3.92\\sqrt{\\frac{(1/6)(5/6)}{12}} = 3.92\\sqrt{\\frac{5/36}{12}} = 3.92\\sqrt{\\frac{5}{432}}\n$$\n数值上，$L_{\\text{Wald}} \\approx 3.92 \\times 0.10758286 = 0.4217255...$\n\n接下来，计算 Wilson 得分区间的长度 $L_{\\text{Wilson}}$。令 $z = 1.96$：\n$$\nL_{\\text{Wilson}} = \\frac{z\\sqrt{4n\\hat{p}(1-\\hat{p}) + z^2}}{n + z^2}\n$$\n计算各组成部分：\n$z^2 = 1.96^2 = 3.8416$。\n$4n\\hat{p}(1-\\hat{p}) = 4(12)(\\frac{1}{6})(\\frac{5}{6}) = 48(\\frac{5}{36}) = \\frac{4}{3} \\times 5 = \\frac{20}{3}$。\n分母是 $n + z^2 = 12 + 3.8416 = 15.8416$。\n分子是 $z\\sqrt{\\frac{20}{3} + 3.8416} = 1.96\\sqrt{6.6666... + 3.8416} = 1.96\\sqrt{10.508266...}$。\n所以，$L_{\\text{Wilson}} = \\frac{1.96 \\times 3.2416456...}{15.8416} = \\frac{6.353625...}{15.8416} \\approx 0.4010728...$\n\n最后，计算比值 $R$：\n$$\nR = \\frac{L_{\\text{Wald}}}{L_{\\text{Wilson}}} = \\frac{0.4217255...}{0.4010728...} \\approx 1.051493...\n$$\n将此结果四舍五入至四位有效数字，得到 $1.051$。", "answer": "$$\\boxed{1.051}$$", "id": "4555572"}, {"introduction": "在现代生物信息学中，对高通量测序数据的分析是一个核心领域，其中包含了许多微妙的统计学问题。一个常见的实践是，在对RNA测序（RNA-seq）的计数数据进行对数转换之前添加一个“伪计数”（pseudocount），以避免对零取对数。然而，这种便捷的非线性变换并非没有代价，它会引入系统性的偏差。本项高级练习将运用统计理论，通过泰勒展开来推导并量化这种偏差，旨在促使您批判性地审视标准数据处理流程，并开始思考更为严谨的替代方案，例如基于广义线性模型 (GLM) 的方法。[@problem_id:4555561]", "problem": "一家转录组学实验室进行核糖核酸测序 (RNA-seq)，并通过负二项 (NB) 分布对基因水平的读取计数进行建模，该分布的均值为 $\\,\\mu > 0\\,$，离散参数为 $\\,\\phi \\ge 0\\,$，因此计数 $\\,X\\,$ 的方差满足 $\\,\\mathrm{Var}(X) = \\mu + \\phi \\mu^{2}\\,$。为了避免零计数的未定义值，该实验室在取自然对数之前添加一个正的伪计数 $\\,\\alpha>0\\,$，计算出转换后的值 $\\,Y=\\ln(X+\\alpha)\\,$。在下游分析中，$\\,Y\\,$ 被解释为潜对数丰度 $\\,\\ln(\\mu)\\,$ 的一个估计量。\n\n假设 $\\,X\\,$ 遵循指定的负二项均值-方差关系，并且 $\\,\\mu\\,$ 小到足以使低计数行为具有相关性，但又大到足以证明使用平滑函数期望近似的合理性。请在关于 $\\,\\mu\\,$ 的平滑函数展开中推导至二阶，求出近似偏差 $\\,B(\\mu,\\alpha,\\phi)\\,$，其定义为\n$$\nB(\\mu,\\alpha,\\phi) = \\mathbb{E}\\big[\\ln(X+\\alpha)\\big] - \\ln(\\mu),\n$$\n并使用NB均值-方差关系，以 $\\,\\mu\\,$, $\\,\\alpha\\,$ 和 $\\,\\phi\\,$ 的闭合形式表示。您的最终答案必须是单个闭合形式的解析表达式。无需单位。此外，请用文字简要讨论在RNA-seq分析中，有哪些遵循给定均值-方差结构的有原则的替代方法可以减轻这种偏差，但您的最终答案必须仅为 $\\,B(\\mu,\\alpha,\\phi)\\,$ 的表达式。", "solution": "用户想要推导对数转换随机变量的近似偏差，并讨论替代方法。\n\n### 步骤1：提取已知条件\n- 随机变量 $X$ 代表基因水平的读取计数。\n- $X$ 由负二项 (NB) 分布建模。\n- $X$ 的均值为 $\\mathbb{E}[X] = \\mu > 0$。\n- 离散参数为 $\\phi \\ge 0$。\n- $X$ 的方差为 $\\mathrm{Var}(X) = \\mu + \\phi \\mu^{2}$。\n- 使用了正的伪计数 $\\alpha > 0$。\n- 转换后的变量为 $Y = \\ln(X+\\alpha)$。\n- 目标量为潜对数丰度 $\\ln(\\mu)$。\n- 任务是推导近似偏差 $B(\\mu,\\alpha,\\phi) = \\mathbb{E}\\big[\\ln(X+\\alpha)\\big] - \\ln(\\mu)$。\n- 近似应在关于 $\\mu$ 的平滑函数展开中达到二阶。\n- 推导的合理性在于假设 $\\mu$ 足够大以支持平滑函数近似，但又足够小以使低计数行为具有相关性。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学或事实上的不健全性**：无。该问题在科学上是健全的。具有指定二次均值-方差关系的负二项分布是RNA-seq计数数据的经典模型。在生物信息学中，使用对数加伪计数的转换是一种常见但备受批评的做法。由这种非线性转换引入的偏差问题是一个公认的统计问题。\n- **不可形式化或不相关**：无。该问题是一个形式化的数理统计练习，与*生物信息学和医学数据分析*领域中*描述性统计和抽样概念*的指定主题直接相关。\n- **不完整或矛盾的设置**：无。问题提供了所有必要信息：函数 $g(X) = \\ln(X+\\alpha)$，$X$ 的前两个中心矩（均值 $\\mu$ 和方差 $\\mu + \\phi\\mu^2$），以及近似的阶数。关于 $\\mu$ “足够小”又“足够大”的条件是应用统计学中一种标准的启发式框架，表明该问题具有实际相关性（由于低计数），同时所选的数学工具（泰勒展开）是适用的。\n- **不切实际或不可行**：无。该场景真实地再现了转录组学中数据处理的挑战。\n- **不适定或结构不良**：无。该问题是适定的，并要求进行标准的统计推导（应用Delta方法求期望）。近似偏差存在唯一的解析表达式。\n- **伪深刻、微不足道或同义反复**：无。该推导需要非平凡地应用泰勒级数来近似转换后随机变量的期望，这是统计理论中的一个核心概念。\n- **超出科学可验证性**：无。该推导是一个完全可验证的数学过程。\n\n### 步骤3：结论与行动\n问题有效。现在提供推导和解答。\n\n问题要求对偏差 $B(\\mu,\\alpha,\\phi) = \\mathbb{E}[\\ln(X+\\alpha)] - \\ln(\\mu)$ 进行二阶近似。此任务的核心在于近似一个随机变量的非线性函数 $g(X) = \\ln(X+\\alpha)$ 的期望 $\\mathbb{E}[g(X)]$。我们使用 $g(X)$ 在 $X$ 的均值 $\\mu = \\mathbb{E}[X]$ 附近的二阶泰勒级数展开。\n\n平滑函数 $g(X)$ 在 $\\mu$ 附近的泰勒展开为：\n$$\ng(X) = g(\\mu) + g'(\\mu)(X-\\mu) + \\frac{1}{2!} g''(\\mu)(X-\\mu)^2 + \\frac{1}{3!} g'''(\\mu)(X-\\mu)^3 + \\dots\n$$\n为求期望 $\\mathbb{E}[g(X)]$，我们对级数的每一项取期望：\n$$\n\\mathbb{E}[g(X)] = \\mathbb{E}\\left[g(\\mu) + g'(\\mu)(X-\\mu) + \\frac{1}{2} g''(\\mu)(X-\\mu)^2 + \\dots\\right]\n$$\n利用期望的线性性质，我们得到：\n$$\n\\mathbb{E}[g(X)] = g(\\mu) + g'(\\mu)\\mathbb{E}[X-\\mu] + \\frac{1}{2} g''(\\mu)\\mathbb{E}[(X-\\mu)^2] + \\dots\n$$\n根据定义，$\\mathbb{E}[X-\\mu] = \\mathbb{E}[X] - \\mu = \\mu - \\mu = 0$，且 $\\mathbb{E}[(X-\\mu)^2] = \\mathrm{Var}(X)$。将展开式截断至二阶项，得到近似值：\n$$\n\\mathbb{E}[g(X)] \\approx g(\\mu) + \\frac{1}{2} g''(\\mu) \\mathrm{Var}(X)\n$$\n现在，我们将此通用公式应用于我们的具体问题。函数为 $g(x) = \\ln(x+\\alpha)$。我们需要它的一阶和二阶导数：\n一阶导数：\n$$\ng'(x) = \\frac{d}{dx}\\ln(x+\\alpha) = \\frac{1}{x+\\alpha}\n$$\n二阶导数：\n$$\ng''(x) = \\frac{d}{dx}\\left(\\frac{1}{x+\\alpha}\\right) = -\\frac{1}{(x+\\alpha)^2}\n$$\n接下来，我们在展开点 $x=\\mu$ 处计算该函数及其二阶导数的值：\n$$\ng(\\mu) = \\ln(\\mu+\\alpha)\n$$\n$$\ng''(\\mu) = -\\frac{1}{(\\mu+\\alpha)^2}\n$$\n问题指定 $X$ 的方差为：\n$$\n\\mathrm{Var}(X) = \\mu + \\phi \\mu^2\n$$\n将这些分量代入期望的近似公式中：\n$$\n\\mathbb{E}[\\ln(X+\\alpha)] \\approx g(\\mu) + \\frac{1}{2} g''(\\mu) \\mathrm{Var}(X)\n$$\n$$\n\\mathbb{E}[\\ln(X+\\alpha)] \\approx \\ln(\\mu+\\alpha) + \\frac{1}{2} \\left(-\\frac{1}{(\\mu+\\alpha)^2}\\right) (\\mu + \\phi \\mu^2)\n$$\n$$\n\\mathbb{E}[\\ln(X+\\alpha)] \\approx \\ln(\\mu+\\alpha) - \\frac{\\mu + \\phi \\mu^2}{2(\\mu+\\alpha)^2}\n$$\n偏差 $B(\\mu, \\alpha, \\phi)$ 定义为 $\\mathbb{E}[\\ln(X+\\alpha)] - \\ln(\\mu)$。使用我们对期望项的近似，我们得到近似偏差：\n$$\nB(\\mu, \\alpha, \\phi) \\approx \\left(\\ln(\\mu+\\alpha) - \\frac{\\mu + \\phi \\mu^2}{2(\\mu+\\alpha)^2}\\right) - \\ln(\\mu)\n$$\n可以通过组合对数项来重新排列此表达式：\n$$\nB(\\mu, \\alpha, \\phi) \\approx \\ln(\\mu+\\alpha) - \\ln(\\mu) - \\frac{\\mu(1 + \\phi \\mu)}{2(\\mu+\\alpha)^2}\n$$\n$$\nB(\\mu, \\alpha, \\phi) \\approx \\ln\\left(\\frac{\\mu+\\alpha}{\\mu}\\right) - \\frac{\\mu(1 + \\phi \\mu)}{2(\\mu+\\alpha)^2}\n$$\n最后，简化对数的参数，得到近似偏差的闭合形式表达式：\n$$\nB(\\mu, \\alpha, \\phi) \\approx \\ln\\left(1 + \\frac{\\alpha}{\\mu}\\right) - \\frac{\\mu(1 + \\phi \\mu)}{2(\\mu+\\alpha)^2}\n$$\n该表达式揭示了偏差的两个来源。第一项 $\\ln(1 + \\alpha/\\mu)$ 是由添加伪计数 $\\alpha$ 产生的，并且始终为正。第二项 $-\\frac{\\mu(1 + \\phi \\mu)}{2(\\mu+\\alpha)^2}$ 是由对数函数的凹性（琴生不等式）产生的，并且始终为负。总偏差取决于这两个分量之间的相互作用。\n\n关于减轻这种偏差的有原则的替代方法，存在两大类遵循给定均值-方差结构的方法：\n1. **方差稳定和正则化转换**：替代特设的 $\\ln(X+\\alpha)$ 转换，可以使用专门为稳定负二项分布数据的方差而推导出的转换。对于方差函数 $\\mathrm{Var}(X) = V(\\mu)$，方差稳定转换是 $T(\\mu) = \\int \\frac{1}{\\sqrt{V(\\mu)}} d\\mu$。对于负二项分布的方差 $\\mu + \\phi\\mu^2$，这会导出与反双曲正弦函数相关的转换。像在`DESeq2` R包中实现的正则化对数 (`rlog`) 等方法提供了一种更复杂的方法，通过对所有基因的离散-均值趋势拟合一个模型，并对低计数基因的对数倍数变化进行收缩，从而有效地减少偏差并稳定方差。\n2. **广义线性模型 (GLM)**：最直接且统计上最严谨的方法是完全避免转换。取而代之，可以使用一个GLM框架，直接对未经转换的计数进行建模。通过指定负二项误差分布和对数连接函数，该模型直接将 $\\ln(\\mu)$ 估计为协变量的线性函数。这种方法被`edgeR`和`DESeq2`等领先的RNA-seq分析工具所采用，能够恰当地处理计数数据的均值-方差关系，而不会引入 $\\ln(X+\\alpha)$ 方法固有的转换偏差。", "answer": "$$\n\\boxed{\\ln\\left(1 + \\frac{\\alpha}{\\mu}\\right) - \\frac{\\mu(1 + \\phi \\mu)}{2(\\mu+\\alpha)^{2}}}\n$$", "id": "4555561"}]}