## 引言
在[生物序列](@entry_id:174368)分析中，找到一个高分的[序列比对](@entry_id:172191)仅仅是第一步。真正的挑战在于判断这个得分究竟是反映了真实的生物学关系，还是仅仅是偶然的产物。如果无法从统计上区分信号与噪声，那么任何基于[序列相似性](@entry_id:178293)的推断——无论是[功能注释](@entry_id:270294)、同源关系确定还是进化历史重构——都将失去科学根基。因此，对[序列比对](@entry_id:172191)的统计显著性进行精确评估，是整个生物信息学领域的一项基石性任务。

本文旨在系统性地解决这一核心问题，为读者构建一个从理论到实践的完整知识体系。我们将通过三个章节的深入探讨，带领您全面掌握比对显著性评估的精髓：
- 在第一章“**原理与机制**”中，我们将揭示比对得分背后的统计学魔法，从作为[假设检验](@entry_id:142556)的对数优势评分系统出发，深入讲解分数分布的Gumbel[极值理论](@entry_id:140083)，并最终推导出[E值](@entry_id:177316)和[比特分](@entry_id:174968)数等关键度量。
- 接着，在第二章“**应用与跨学科联系**”中，我们将展示这些理论如何在处理海量基因组数据、应对组分偏倚等真实世界挑战中发挥作用，并探索其如何超越生物学，在用户行为分析等领域创造价值。
- 最后，在“**动手实践**”部分，我们提供了一系列精心设计的计算练习，帮助您将理论知识转化为解决实际问题的能力。

通过本次学习，您将不仅能理解BLAST等工具输出结果的深层含义，更能获得一种强大的、可推广的分析思维，用于评估任何领域中模式的[统计显著性](@entry_id:147554)。

## 原理与机制

### 统计学问题：何时比对得分具有显著性？

在上一章中，我们学习了如何通过动态规划算法在两条序列之间找到一个局部最优比对，并为其计算出一个原始得分（raw score）。然而，一个高的原始得分本身并不足以断定两条序列之间存在生物学上的关联。任何两条随机序列，仅仅由于偶然，也可能产生一个看似很高的得分。因此，核心的科学问题转变为：我们观察到的这个比对得分，在多大程度上仅仅是偶然的产物？换言之，其统计显著性如何？

为了回答这个问题，我们需要建立一个**零假设（null hypothesis）**。在序列比对的背景下，零假设通常陈述为：被比较的两条序列是**不相关的**，它们可以被看作是从特定的背景[频率分布](@entry_id:176998)中独立生成的随机序列。我们的任务就是计算，在这个零假设下，获得一个等于或高于我们观察到的得分的概率是多少。这个概率，即**P值（P-value）**，量化了我们观察结果的“意外程度”。一个极小的P值意味着在随机模型下几乎不可能出现这样的高分，从而使我们有信心拒绝零假设，并推断该比对可能反映了真实的生物学关系（如共同的进化祖先）。

本章将深入探讨估计这种[统计显著性](@entry_id:147554)的理论基础和实用方法，这一理论框架是现代生物信息学工具（如BLAST）的基石。

### 对数优势评分框架：作为假设检验的评分

在深入研究得分分布的统计学之前，我们必须首先理解比对评分系统本身的概率解释。现代的[替换矩阵](@entry_id:170141)（如BLASUM和PAM系列）并非随意构建，它们本质上是**对数优势评分（log-odds scores）**。这个概念将比对过程置于一个明确的[统计假设检验](@entry_id:274987)框架中。

在这个框架下，我们比较两个相互竞争的模型：

1.  **相关模型（Alignment Model）**：该模型假设两条序列是相关的（例如，具有共同的进化祖先）。在该模型下，一个氨基酸（或[核苷](@entry_id:195320)酸）$i$ 与另一个 $j$ 对齐的概率由一个目标联合概率分布 $t_{ij}$ 描述。这些概率通常从已知的相关蛋白家族的可靠比对中估计得出。

2.  **随机模型（Null/Random Model）**：该模型对应于我们的零假设，即两条序列是不相关的。在该模型下，字母 $i$ 和 $j$ 同时出现仅仅是因为它们各自在序列中独立出现。如果两条序列的背景[频率分布](@entry_id:176998)分别为 ${p_i}$ 和 ${q_j}$，那么观察到配对 $(i,j)$ 的概率就是它们频率的乘积 $p_i q_j$。

对于一个给定的比对，我们可以计算它在这两个模型下出现的概率之比。这个比率，称为**[似然比](@entry_id:170863)（likelihood ratio）**，告诉我们该比对在相关模型下的可能性相对于在随机模型下的可能性高多少。为了计算方便，我们通常取其对数。因此，一个理想的替换分 $s_{ij}$ 被定义为[对数似然比](@entry_id:274622)：

$S_{ij} = \log\frac{t_{ij}}{p_i q_j}$

一个正的 $s_{ij}$ 意味着配对 $(i,j)$ 在相关序列中比在随机序列中更常见，而负分则意味着更少见。整个比对的**原始总分（raw score）$S$** 是所有比对上的字母对的 $s_{ij}$ 之和，（如果考虑空位）再加上[空位罚分](@entry_id:176259)。如果[空位罚分](@entry_id:176259)也以类似的方式被定义为相关模型与随机模型下产生空位的概率的对数比，那么整个比对的总分 $S$ 就代表了该比对路径的整体[对数似然比](@entry_id:274622) [@problem_id:4538909]。这种对数优势的解释是序列比对[统计显著性](@entry_id:147554)理论的出发点。

### 比对分数的[渐近分布](@entry_id:272575)：[Gumbel分布](@entry_id:268317)

有了对分数的概率解释，我们现在回到核心问题：在零假设下，两条随机序列（长度为 $m$ 和 $n$）之间的最高[局部比对](@entry_id:164979)得分 $S_{max}$ 的分布是什么？

一个惊人但极其重要的理论结果是，对于一大类评分系统，$S_{max}$ 的分布可以被**I型[极值分布](@entry_id:174061)（Type I Extreme Value Distribution, EVD）**，也称为**[Gumbel分布](@entry_id:268317)**，很好地近似。

这个结论的背后是深刻的概率论和[随机过程](@entry_id:268487)理论。我们可以从以下几个层面来直观理解其原因 [@problem_id:4538936]：

1.  **负漂移的随机游走**：对于无空位的[局部比对](@entry_id:164979)，沿着序列对角线的得分累积过程可以被建模为一个**随机游走（random walk）**。每一步的增量是随机选择的一对字母的得分 $s_{ij}$。一个至关重要的前提条件是，在零假设下，随机配对的期望得分必须是负数，即 $\mathbb{E}[s] = \sum_{i,j} p_i q_j s_{ij}  0$ [@problem_id:4538932]。这个**负漂移（negative drift）**条件确保了随机游走的路径总体上趋向于下降。

2.  **罕见事件和指数尾部**：由于存在负漂移，获得一个高的正值总分就成了一个**罕见事件（rare event）**，它需要一段连续的、得分异常高的“幸运”序列。**大偏差理论（Large Deviation Theory）**告诉我们，这种罕见事件的概率随着得分阈值的增加而呈指数级衰减。也就是说，一个随机片段获得至少为 $S$ 的高分的概率 $P(\text{score} \ge S)$ 近似地与 $e^{-\lambda S}$ 成正比，其中 $\lambda$ 是一个正的常数。

3.  **极值的Gumbel定律**：在两条长度为 $m$ 和 $n$ 的序列中，大约有 $mn$ 个可能的起始点可以开始一个[局部比对](@entry_id:164979)。因此，最终的最高分 $S_{max}$ 可以被看作是从大约 $mn$ 个（近似独立的）随机变量中取出的最大值。**Fisher–Tippett–Gnedenko定理**是[极值理论](@entry_id:140083)的中心结果，它指出，对于一大类具有“轻”指数尾的初始分布（如我们这里的情况），其样本最大值的分布在经过适当的中心化和缩放后，会收敛到[Gumbel分布](@entry_id:268317)。

综上所述，[局部比对](@entry_id:164979)得分的[Gumbel分布](@entry_id:268317)特性，源于负漂移随机游走中高分作为罕见事件的指数衰减特性，以及在巨大搜索空间中对这些罕见事件取最大值的统计学行为。

### 量化显著性：E值和P值

[Gumbel分布](@entry_id:268317)的[累积分布函数](@entry_id:143135)（CDF）具有一个特征性的双指数形式。对于最大[局部比对](@entry_id:164979)分 $S_{max}$，其CDF可以写作：

$\mathbb{P}(S_{max} \le S) \approx \exp(-e^{-(\lambda S + c)})$

其中 $c$ 是一个与搜索空间大小相关的常数。通过简单的代数变换，这个公式可以被重写成一种更具解释性的形式。我们关心的**P值**，即观察到得分不小于 $S$ 的概率，是其尾部概率：

$\text{P-value} = \mathbb{P}(S_{max} \ge S) = 1 - \mathbb{P}(S_{max} \le S) \approx 1 - \exp(-K m n e^{-\lambda S})$

这里，参数 $\lambda$ 和 $K$ 是由评分系统和背景频率决定的统计常数（我们将在下一节详细讨论），而 $m$ 和 $n$ 是序列长度，代表了搜索空间的大小。

当得分很高时，指数项 $K m n e^{-\lambda S}$ 会变得很小。在这种情况下，我们可以使用近似 $1-e^{-x} \approx x$（对于小 $x$）。这就引出了一个在生物信息学中更为常用的度量——**[E值](@entry_id:177316)（E-value）** [@problem_id:4538909]。

**E值**被定义为在一次与给定大小的数据库（总长度为 $n$）的搜索中，随机期望找到的得分不低于 $S$ 的比对数量。其表达式为：

$E(S) \approx K m n e^{-\lambda S}$

[E值](@entry_id:177316)与P值的关系可以从罕见事件的**[泊松近似](@entry_id:265225)（Poisson approximation）**中理解 [@problem_id:4538976]。在巨大的搜索空间中，得分超过某个高阈值的“命中”事件是罕见的，可以被建模为一个泊松过程。命中次数 $N$ 服从均值为 $E(S)$ 的泊松分布。因此，至少有一次命中的概率（即P值）是：

$\text{P-value} = \mathbb{P}(N \ge 1) = 1 - \mathbb{P}(N=0) = 1 - \frac{E^0 e^{-E}}{0!} = 1 - e^{-E}$

从这个关系中我们可以得出几个关键的解释 [@problem_id:4538976]：

*   **定义**：[E值](@entry_id:177316)是期望的随机命中数。例如，一个 $E=0.2$ 的比对意味着，在与同样大小的随机数据库进行比较时，我们期望平均能找到0.2个得分同样好或更好的偶然比对。
*   **与P值的关系**：当E值很小（例如 $E  0.05$）时，$P \approx E$。因此，[E值](@entry_id:177316)可以被看作是P值的[一阶近似](@entry_id:147559)。
*   **对数据库大小的依赖性**：[E值](@entry_id:177316)与搜索空间大小 $mn$ 成正比。如果保持查询序列和比对得分不变，将数据库大小加倍，[E值](@entry_id:177316)也会近似加倍。这使得[E值](@entry_id:177316)成为一个依赖于特定搜索上下文的度量。
*   **频率学解释**：E值是一个频率学概念，它描述了在重复实验中对随机数据库进行搜索时平均会发生什么。它**不是**一个[贝叶斯后验概率](@entry_id:197730)，即它不代表“这个特定比对是假的概率为0.2”。

### 统计参数：$\lambda$ 和 $K$

[E值](@entry_id:177316)公式中的两个核心参数 $\lambda$ 和 $K$ 捕捉了评分系统在特定背景氨基酸（或[核苷](@entry_id:195320)酸）频率下的统计特性。理解它们的来源对于掌握整个理论至关重要。

#### [尺度参数](@entry_id:268705) $\lambda$

参数 $\lambda$ 是一个**尺度参数（scale parameter）**，它将原始得分的单位与概率的指数衰减联系起来。对于无空位比对的理想情况，$\lambda$ 被唯一地定义为以下方程的[正根](@entry_id:199264) [@problem_id:4538909] [@problem_id:4538941]：

$\sum_{i,j} p_i q_j e^{\lambda s_{ij}} = 1$

其中 $p_i, q_j$ 是背景频率，$s_{ij}$ 是替换分。这个方程的左边是得分随机变量 $s$ 的[矩母函数](@entry_id:154347) $M_s(\lambda) = \mathbb{E}[e^{\lambda s}]$。这个方程的根源在于大偏差理论中的“倾斜分布”技术，该技术通过一个指数因子来调整原始概率分布，以研究罕见事件。

从函数 $f(\lambda) = \sum p_i q_j e^{\lambda s_{ij}}$ 的性质可以看出：
*   $f(0) = \sum p_i q_j = 1$，所以 $\lambda=0$ 总是一个解。
*   $f'(\lambda) = \sum p_i q_j s_{ij} e^{\lambda s_{ij}}$，所以 $f'(0) = \sum p_i q_j s_{ij}$，这正是期望得分。由于期望得分为负，函数在原点处是递减的。
*   $f''(\lambda) = \sum p_i q_j s_{ij}^2 e^{\lambda s_{ij}} > 0$，所以函数是凸的。

一个在原点值为1、初始斜率为负且凸的函数，必然在正半轴与直线 $y=1$ 有另一个唯一的交点。这个唯一的[正根](@entry_id:199264)就是我们寻找的 $\lambda$ [@problem_id:4538909]。至关重要的是，$\lambda$ 的值仅取决于[评分矩阵](@entry_id:172456) $\{s_{ij}\}$ 和背景频率 $\{p_i, q_j\}$，而**与序列长度 $m$ 和 $n$ 无关** [@problem_id:4538941]。

#### 预因子 $K$

参数 $K$ 是一个更为复杂的**预因子（pre-factor）**，它与[随机游走过程](@entry_id:171699)的“更新结构（renewal structure）”有关 [@problem_id:4538907]。直观地，它可以被理解为与能够启动一个潜在高分比对的“种子”的密度有关。它的精确计算涉及到比对模型的更精细的细节，包括：

*   **评分系统和频率**：与 $\lambda$ 一样，$K$ 也依赖于 $s_{ij}$ 和 $p_i, q_j$。
*   **[空位罚分](@entry_id:176259)**：在有空位的比对中，$K$ 会受到空位开放和延伸罚分的影响。
*   **种子规则**：在实际的[搜索算法](@entry_id:272182)中，并非所有位置都可以启动比对。例如，某些算法可能要求比对的第一个字母对必须有非负分。这些“种子可接纳性”规则会改变边界条件，从而影响 $K$ 的值 [@problem_id:4538907]。

与 $\lambda$ 类似，只要评分系统和背景模型固定，$K$ 就是一个常数，**不依赖于序列长度 $m$ 和 $n$**。数据库大小对[E值](@entry_id:177316)的影响完全被公式中的 $mn$ 项所捕获。

### 标准化比较：[比特分](@entry_id:174968)

原始得分 $S$ 的值取决于所使用的特定[评分矩阵](@entry_id:172456)。E值则取决于数据库的大小。这使得在不同搜索之间直接比较结果变得困难。为了解决这个问题，生物信息学引入了一个标准化的、可移植的度量：**[比特分](@entry_id:174968)（bit score）**。

[比特分](@entry_id:174968)的思想是，通过一个变换，将原始分 $S$ 转换成一个新分数 $S'$，使得E值公式可以被写成一种通用的、与信息论相关的形式：

$E(S) = m n \cdot 2^{-S'}$

通过将这个形式与我们已知的E值公式 $E(S) = K m n e^{-\lambda S}$ 相等，我们可以推导出从 $S$ 到 $S'$ 的转换关系 [@problem_id:4538970]：

$K m n e^{-\lambda S} = m n \cdot 2^{-S'}$

$K e^{-\lambda S} = 2^{-S'}$

两边取自然对数：

$\ln(K) - \lambda S = -S' \ln(2)$

解出 $S'$，我们得到[比特分](@entry_id:174968)的定义：

$S' = \frac{\lambda S - \ln(K)}{\ln(2)}$

这个[线性变换](@entry_id:143080)将原始分 $S$ 映射到[比特分](@entry_id:174968) $S'$。[比特分](@entry_id:174968)具有以下重要特性：

*   **信息论解释**：[比特分](@entry_id:174968)量化了比对得分的“意外程度”，以比特为单位。从 $E = mn \cdot 2^{-S'}$ 可以看出，$2^{-S'} = E / (mn)$，这可以被解释为在搜索空间中每个“单位位置”产生一个如此高分的概率。因此，$S' = -\log_2(P_{\text{per_site}})$，这正是信息论中一个事件的信息量（或惊奇度）的定义 [@problem_id:4538970]。
*   **可移植性**：[比特分](@entry_id:174968)的计算公式只涉及原始分 $S$ 和统计参数 $\lambda, K$。这些都与序列长度 $m, n$ 无关。因此，一个特定比对的[比特分](@entry_id:174968)是恒定的，无论它是在一个小数据库还是一个大数据库中找到的。这使得[比特分](@entry_id:174968)成为一个比较不同搜索结果的理想度量。

当然，[比特分](@entry_id:174968)和整个E值框架的有效性，完全依赖于其背后的[统计模型](@entry_id:755400)（即[Gumbel分布](@entry_id:268317)）是否成立。如果模型的假设被违反，那么从原始分到[比特分](@entry_id:174968)的转换就失去了其统计学校准的意义 [@problem_id:4538932]。

### 实际挑战与扩展

卡林-阿尔茨休尔（Karlin–Altschul）理论为理解比对得分的显著性提供了坚实的理论基础。然而，在实际应用中，理想化的模型假设常常面临挑战。本节将讨论几个关键的实际问题及其解决方案。

#### 有空位比对

最初的、最严格的卡林-阿尔茨休尔理论证明仅适用于**无空位（gapless）**比对。当引入空位，特别是**[仿射空位罚分](@entry_id:169823)（affine gap penalties）**（即区分空位开放罚分和空位延伸罚分）时，底层的[随机过程](@entry_id:268487)变得复杂得多。得分的累积不再是[独立同分布](@entry_id:169067)（i.i.d.）增量的简单随机游走。一个空位的存在会引入[长程依赖](@entry_id:181727)性，因为一个长的空位会影响下游很远位置的比对决策 [@problem_id:4538960]。

这种[长程依赖](@entry_id:181727)性破坏了原始证明所依赖的某些数学条件（如强混合条件）。从理论上讲，为[仿射空位罚分](@entry_id:169823)下的[局部比对](@entry_id:164979)得分分布推导出严谨的解析形式，至今仍是一个开放的数学难题。

然而，大量的经验证据（通过大规模计算机模拟）表明，对于具有负期望得分和合理[仿射空位罚分](@entry_id:169823)的系统，最大[局部比对](@entry_id:164979)分的分布仍然以极高的精度遵循[Gumbel分布](@entry_id:268317) [@problem_id:4538909] [@problem_id:4538960]。这一实证观察是现代生物信息学工具（如BLAST）能够为有空位比对提供可靠E值的基础。在实践中，统计参数 $\lambda$ 和 $K$ 不再通过解析方程计算，而是通过对随机序列进行大量比对模拟，然后将得到的得分分布拟合到[Gumbel分布](@entry_id:268317)来预先估计。

需要注意的是，这种经验性的Gumbel行为并非在所有情况下都成立。如果[空位罚分](@entry_id:176259)过低，导致比对的期望得分变为正值，或者使用某些非仿射的[空位罚分](@entry_id:176259)函数（如凹函数），那么得分的增长模式可能会从对数增长（$O(\log(mn))$）转变为线性增长（$O(\min(m,n))$）或介于两者之间的模式。在这种“线性相”中，卡林-阿尔茨休尔理论完全失效，E值的计算也不再有效 [@problem_id:4538932]。

#### [边缘效应](@entry_id:183162)

卡林-阿尔茨休尔理论的推导是在序列长度 $m, n \to \infty$ 的渐近极限下进行的，其中搜索空间的大小被近似为 $mn$。然而，在有限长度的序列中，这个近似并不完全准确。一个长度为 $L$ 的比对，不可能从查询序列的最后 $L-1$ 个位置或目标序列的最后 $L-1$ 个位置开始。因此，可用的起始位置对的数量实际上小于 $mn$。这种由于序列末端而导致的搜索空间减小被称为**[边缘效应](@entry_id:183162)（edge effects）** [@problem_id:4538906]。

这种效应对于短序列尤为明显。忽略[边缘效应](@entry_id:183162)会高估搜索空间的大小，从而导致计算出的E值偏大，即低估了比对的真实显著性 [@problem_id:4538932]。

为了修正这个问题，通常会用**[有效长度](@entry_id:184361)（effective lengths）** $m'$ 和 $n'$ 来代替实际长度 $m$ 和 $n$。一个常见的修正是：

$m' = m - L_{typ}$
$n' = n - L_{typ}$

其中 $L_{typ}$ 是在给定评分系统下，一个随机高分比对的[特征长度](@entry_id:265857)。修正后的搜索空间大小为 $m'n'$。E值公式也相应地调整为 $E(S) \approx K m' n' e^{-\lambda S}$。

#### 组分偏倚

也许在实践中最普遍和最棘手的挑战是**组分偏倚（compositional bias）**。理论框架假设被比较的序列的字母频率（例如氨基酸组分）与构建[评分矩阵](@entry_id:172456)时所用的背景频率相匹配。当实际序列的组分与此假设严重偏离时（例如，在富含某个或某类氨基酸的[低复杂度区域](@entry_id:176542)或跨膜区域），[统计计算](@entry_id:637594)可能会产生严重错误。

问题根源在于期望得分。即使一个[评分矩阵](@entry_id:172456)在标准背景频率下具有负的期望得分，但对于一个具有偏倚组分的序列，其期望得分可能变为正值 [@problem_id:4538923]。例如，比对两个都富含疏水性氨基酸的随机序列，使用一个对疏水性配对给予高分的[标准矩阵](@entry_id:151240)（如[BLOSUM62](@entry_id:169866)），很可能得到一个正的期望得分。这违反了理论的基本前提，导致随机比对得分不断累积，产生虚假的高分，从而使[E值](@entry_id:177316)被严重低估（即结果看起来比实际更显著）。因此，在处理组分异构的数据库时，使用一套固定的、从平均组分估计出的 $(\lambda, K)$ 参数是一个严重错误 [@problem_id:4538932]。

为了解决这个问题，发展出了**基于组分的得分调整（composition-based score adjustment）**技术。其核心思想是，在保持原始[评分矩阵](@entry_id:172456)相对关系的同时，对其进行调整，以确保在**实际观测到的**序列组分下，期望得分为负，且统计参数得到正确校准。下面我们通过一个具体的计算例子来说明这一过程 [@problem_id:4538923]。

**示例：组分偏倚的校正**

假设我们工作在一个简化的双字母 $\{A, B\}$ 蛋白质世界中。

1.  **原始系统**：一个对数优势[评分矩阵](@entry_id:172456) $S_{ij}$ 是基于目标频率 $Q^0$ 和背景频率 $P=(0.5, 0.5)$ 构建的，其中 $S_{ij} = \ln(q^0_{ij} / (p_i p_j))$。
    $Q^{0} = \begin{pmatrix} 0.4  0.1 \\ 0.1  0.4 \end{pmatrix}, \quad P = (0.5, 0.5)$
    计算出的原始[评分矩阵](@entry_id:172456)为 $S_{AA} = S_{BB} = \ln(1.6) \approx 0.47$，$S_{AB} = S_{BA} = \ln(0.4) \approx -0.92$。
    该系统在背景 $P$ 下是校准的，即 $\sum p_i p_j e^{S_{ij}} = \sum q^0_{ij} = 1$，所以 $\lambda=1$。

2.  **偏倚的出现**：现在我们用这个评分系统去比对一个组分为 $s=(0.8, 0.2)$ 的查询序列和一个组分为 $r=(0.9, 0.1)$ 的目标序列。实际的零假设背景是 $s_i r_j$。在该背景下，期望得分为：
    $E_{s,r}[S] = \sum_{i,j} s_i r_j S_{ij} = 0.72 \cdot S_{AA} + 0.08 \cdot S_{AB} + 0.18 \cdot S_{BA} + 0.02 \cdot S_{BB} \approx 0.11 > 0$
    期望得分为正，统计框架失效。此时 $\sum s_i r_j e^{S_{ij}} \approx 1.288 > 1$，系统处于“超临界”状态。

3.  **校正过程**：我们的目标是找到一个新的、调整后的[评分矩阵](@entry_id:172456) $S'_{ij}$，使其在 $s,r$ 背景下重新校准。这通过寻找一个新的[联合概率分布](@entry_id:171550) $\widetilde{Q}$ 实现，该分布：(a) 满足边际约束，即其行和与列和分别等于组分 $s$ 和 $r$；(b) 与原始模型“最接近”（在最小化Kullback-Leibler散度的意义上）。这个过程可以通过迭代的比例拟合算法（如Sinkhorn-Knopp算法）来求解。求解后，我们得到调整后的联合概率 $\widetilde{Q}$。
    对于本例，求解可得 $\widetilde{Q} \approx \begin{pmatrix} 0.773  0.027 \\ 0.127  0.072 \end{pmatrix}$。

4.  **计算调整后分数和[E值](@entry_id:177316)**：新的、校准后的[评分矩阵](@entry_id:172456)定义为 $S'_{ij} = \ln(\widetilde{q}_{ij} / (s_i r_j))$。
    $S'_{AA} \approx \ln(0.773/0.72) \approx 0.07$, $S'_{AB} \approx \ln(0.027/0.08) \approx -1.07$
    $S'_{BA} \approx \ln(0.127/0.18) \approx -0.35$, $S'_{BB} \approx \ln(0.072/0.02) \approx 1.29$
    通过构造，这个新的评分系统 $S'_{ij}$ 在背景 $s,r$ 下被校准到 $\lambda=1$。
    现在，假设我们观察到一个比对，其包含的配对数为 $N_{AA}=6, N_{AB}=1, N_{BA}=1, N_{BB}=12$。其调整后的总分 $S'_{\text{obs}}$ 为：
    $S'_{\text{obs}} = 6 \cdot S'_{AA} + 1 \cdot S'_{AB} + 1 \cdot S'_{BA} + 12 \cdot S'_{BB} \approx 14.46$
    使用校准后的参数 $\lambda=1$ 和一个预先计算的 $K$ 值（例如 $K=0.05$），以及序列长度 $m=100, n=1000$，我们可以计算出校正后的E值：
    $E \approx K m n \exp(-\lambda S'_{\text{obs}}) = 0.05 \cdot 100 \cdot 1000 \cdot \exp(-1 \cdot 14.46) \approx 0.00262$

这个例子清晰地展示了，面对组分偏倚，必须对评分系统进行动态调整，以恢复统计显著性估计的有效性。现代的BLAST等工具已经内置了类似的自动校正程序。