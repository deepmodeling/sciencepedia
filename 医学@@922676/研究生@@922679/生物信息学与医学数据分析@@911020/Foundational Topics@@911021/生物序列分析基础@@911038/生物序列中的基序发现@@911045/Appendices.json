{"hands_on_practices": [{"introduction": "构建位置权重矩阵（PWM）是量化生物序列基序（motif）的第一步。由于实验数据（如结合位点序列）的数量通常有限，直接从观测频率计算概率可能会导致零概率问题，从而影响模型的泛化能力。本练习 [@problem_id:4586777] 将指导您运用贝叶斯方法，通过引入狄利克雷先验（即伪计数）来构建一个更稳健的 PWM，并深入探讨均匀伪计数与基于背景频率加权的伪计数对模型参数估计，特别是对低频或未观测碱基的影响。", "problem": "一种量化脱氧核糖核酸（DNA）结合位点比对中基序的常用方法是使用位置权重矩阵（PWM），其条目表示在某个基序位置观察到一个碱基相对于已知背景分布的对数优势比（log-odds）。为了从每个位置的观测计数构建PWM，标准做法是假设碱基出现遵循多项式采样模型，并在每个位置的碱基概率上设置狄利克雷先验。狄利克雷先验是多项式分布的共轭先验，这使得后验分布具有易于解析处理的特性。\n\n考虑一个包含 $N=5$ 个结合位点的比对中的单个基序列 $j$，其观测计数为 $(n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j}) = (3, 0, 1, 1)$，已知背景分布为 $b = (b_{A}, b_{C}, b_{G}, b_{T}) = (0.3, 0.2, 0.2, 0.3)$。假设在第 $j$ 列的碱基概率 $p_{j} = (p_{A,j}, p_{C,j}, p_{G,j}, p_{T,j})$ 上存在一个狄利克雷先验，采用两种不同的伪计数方案，它们具有相同的总先验强度 $\\alpha_{0}=1$：\n1. 均匀伪计数方案，先验参数为 $\\alpha^{(u)} = (\\alpha_{A}^{(u)}, \\alpha_{C}^{(u)}, \\alpha_{G}^{(u)}, \\alpha_{T}^{(u)}) = (0.25, 0.25, 0.25, 0.25)$。\n2. 背景加权伪计数方案，先验参数为 $\\alpha^{(b)} = (\\alpha_{A}^{(b)}, \\alpha_{C}^{(b)}, \\alpha_{G}^{(b)}, \\alpha_{T}^{(b)}) = (0.3, 0.2, 0.2, 0.3)$。\n\n从多项式似然和狄利克雷先验的性质出发，推导在两种伪计数方案下 $p_{C,j}$ 的后验均值估计，然后构建第 $j$ 列胞嘧啶对应的PWM对数优势比条目，定义为 $w_{C,j} = \\log_{2}\\!\\big(p_{C,j}/b_{C}\\big)$。最后，计算均匀和背景加权胞嘧啶PWM条目之差 $w_{C,j}^{(u)} - w_{C,j}^{(b)}$，并给出其值。将最终答案四舍五入至四位有效数字，并以比特（bits）为单位表示最终值。", "solution": "该问题要求计算DNA结合位点比对中特定列 $j$ 处胞嘧啶（$C$）的两个位置权重矩阵（PWM）条目之差。这两个条目是在贝叶斯框架内，根据两种不同的先验假设（伪计数方案）推导出来的。\n\n该问题基于狄利克雷分布和多项式分布之间的共轭先验关系。给定在第 $j$ 列观测到的四种DNA碱基 $\\{A, C, G, T\\}$ 的一组计数，用向量 $n_j = (n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j})$ 表示，这些计数的似然由一个多项式分布建模，其参数为 $p_j = (p_{A,j}, p_{C,j}, p_{G,j}, p_{T,j})$，其中 $p_{k,j}$ 是在位置 $j$ 观测到碱基 $k$ 的未知概率。\n\n在概率向量 $p_j$ 上设置一个狄利克雷先验分布。该先验由一个伪计数向量 $\\alpha = (\\alpha_{A}, \\alpha_{C}, \\alpha_{G}, \\alpha_{T})$ 参数化。给定观测计数 $n_j$，$p_j$ 的后验分布也是一个狄利克雷分布，其更新后的参数为 $\\alpha' = \\alpha + n_j = (\\alpha_{A}+n_{A,j}, \\alpha_{C}+n_{C,j}, \\alpha_{G}+n_{G,j}, \\alpha_{T}+n_{T,j})$。\n\n在第 $j$ 列特定碱基 $k$ 的概率的后验均值估计，记为 $\\hat{p}_{k,j}$，由以下公式给出：\n$$\n\\hat{p}_{k,j} = E[p_{k,j} | n_j, \\alpha] = \\frac{\\alpha_k + n_{k,j}}{\\sum_{i \\in \\{A,C,G,T\\}} (\\alpha_i + n_{i,j})}\n$$\n令 $N = \\sum_{i} n_{i,j}$ 为观测位点的总数，$\\alpha_0 = \\sum_{i} \\alpha_i$ 为总先验强度（总伪计数）。该公式简化为：\n$$\n\\hat{p}_{k,j} = \\frac{n_{k,j} + \\alpha_k}{N + \\alpha_0}\n$$\n问题提供了以下数据：\n- 位点数 $N=5$。\n- 第 $j$ 列的观测计数：$(n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j}) = (3, 0, 1, 1)$。具体来说，$n_{C,j} = 0$。\n- 总先验强度 $\\alpha_0 = 1$。\n- 背景分布 $b = (b_{A}, b_{C}, b_{G}, b_{T}) = (0.3, 0.2, 0.2, 0.3)$。具体来说，$b_C = 0.2$。\n\n我们现在将针对两种伪计数方案计算胞嘧啶的后验均值概率 $\\hat{p}_{C,j}$。\n\n1.  **均匀伪计数方案：**\n    先验参数为 $\\alpha^{(u)} = (0.25, 0.25, 0.25, 0.25)$。胞嘧啶的伪计数为 $\\alpha_{C}^{(u)} = 0.25$。\n    $p_{C,j}$ 的后验均值估计为：\n    $$\n    \\hat{p}_{C,j}^{(u)} = \\frac{n_{C,j} + \\alpha_{C}^{(u)}}{N + \\alpha_0} = \\frac{0 + 0.25}{5 + 1} = \\frac{0.25}{6} = \\frac{1}{24}\n    $$\n    胞嘧啶对应的PWM条目 $w_{C,j}^{(u)}$ 定义为对数优势比得分：\n    $$\n    w_{C,j}^{(u)} = \\log_{2}\\left(\\frac{\\hat{p}_{C,j}^{(u)}}{b_C}\\right) = \\log_{2}\\left(\\frac{1/24}{0.2}\\right) = \\log_{2}\\left(\\frac{1/24}{1/5}\\right) = \\log_{2}\\left(\\frac{5}{24}\\right)\n    $$\n\n2.  **背景加权伪计数方案：**\n    先验参数为 $\\alpha^{(b)} = (0.3, 0.2, 0.2, 0.3)$。胞嘧啶的伪计数为 $\\alpha_{C}^{(b)} = 0.2$。\n    $p_{C,j}$ 的后验均值估计为：\n    $$\n    \\hat{p}_{C,j}^{(b)} = \\frac{n_{C,j} + \\alpha_{C}^{(b)}}{N + \\alpha_0} = \\frac{0 + 0.2}{5 + 1} = \\frac{0.2}{6} = \\frac{1/5}{6} = \\frac{1}{30}\n    $$\n    胞嘧啶对应的PWM条目 $w_{C,j}^{(b)}$ 为：\n    $$\n    w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{\\hat{p}_{C,j}^{(b)}}{b_C}\\right) = \\log_{2}\\left(\\frac{1/30}{0.2}\\right) = \\log_{2}\\left(\\frac{1/30}{1/5}\\right) = \\log_{2}\\left(\\frac{5}{30}\\right) = \\log_{2}\\left(\\frac{1}{6}\\right)\n    $$\n\n最后，我们计算两个PWM条目之差 $w_{C,j}^{(u)} - w_{C,j}^{(b)}$。\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{5}{24}\\right) - \\log_{2}\\left(\\frac{1}{6}\\right)\n$$\n利用对数性质 $\\log(x) - \\log(y) = \\log(x/y)$，我们得到：\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{5/24}{1/6}\\right) = \\log_{2}\\left(\\frac{5}{24} \\times 6\\right) = \\log_{2}\\left(\\frac{30}{24}\\right) = \\log_{2}\\left(\\frac{5}{4}\\right)\n$$\n为了求出数值，我们计算该表达式：\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}(1.25)\n$$\n使用换底公式 $\\log_2(x) = \\frac{\\ln(x)}{\\ln(2)}$：\n$$\n\\log_{2}(1.25) = \\frac{\\ln(1.25)}{\\ln(2)} \\approx \\frac{0.22314355}{0.69314718} \\approx 0.32192809 \\text{ bits}\n$$\n将结果四舍五入到四位有效数字，得到 $0.3219$。", "answer": "$$\\boxed{0.3219}$$", "id": "4586777"}, {"introduction": "拥有一个基序模型（如 PWM）后，下一步关键任务是在基因组序列中扫描并识别潜在的功能位点。然而，高分匹配的序列可能仅仅是随机出现的，因此必须评估其统计显著性。本练习 [@problem_id:4586666] 将引导您计算在背景模型下一个给定 PWM 分数阈值的精确 $p$-value，并进一步推导在扫描大规模序列时，为达到特定期望值（$E$-value）所需的最低分数阈值，这是区分真实生物信号与随机噪声的核心技能。", "problem": "一个实验室正在使用位置权重矩阵 (PWM) 扫描脱氧核糖核酸 (DNA) 序列，以寻找一个转录因子结合基序。该 PWM 的宽度为 $w = 8$，并且在每个位置 $i \\in \\{1,\\dots,8\\}$，它为碱基 $A$ 分配的概率为 $\\theta_{i,A} = \\frac{1}{2}$，为每个非 $A$ 碱基 $b \\in \\{C,G,T\\}$ 分配的概率为 $\\theta_{i,b} = \\frac{1}{6}$。背景核苷酸分布是独立同分布的，其中 $b_{A} = b_{C} = b_{G} = b_{T} = \\frac{1}{4}$。一个长度为 8 的字串 $x_{1:8}$ 的得分 $S(x_{1:8})$ 定义为每个位置的对数似然比之和（以自然对数为单位），即 $S(x_{1:8}) = \\sum_{i=1}^{8} \\ln\\!\\left(\\frac{\\theta_{i,x_{i}}}{b_{x_{i}}}\\right)$。对于一个阈值 $t$，背景 p 值定义为在背景模型下 $S(x_{1:8}) \\ge t$ 的概率。E 值是在扫描序列时预期超过阈值的次数，在此设定中，它被建模为计分窗口的数量乘以背景 p 值。\n\n仅从这些定义和背景模型中固有的独立性假设出发，完成以下任务：\n- 推导出每个位置的不同得分值的集合，并将总分 $S(x_{1:8})$ 表示为 $x_{1:8}$ 中等于 A 的位置数 $k$ 的函数。\n- 使用背景模型，推导出 $k$ 的精确分布，并在 $t$ 等于某个 $k$ 可实现的得分时，用该分布的尾部概率来表示精确的背景 p 值 $\\Pr(S \\ge t)$。\n- 该实验室扫描一条长度为 $L = 32775$ 的 DNA 序列的两条链，对两条链上的每个可能窗口进行计分，总共计有 $N = 2\\,(L - w + 1)$ 个窗口。确定最小得分阈值 $t^{\\ast}$（以自然对数为单位表示），使得背景中超过阈值的期望次数（即 E 值）恰好为 $1$。\n\n将最终阈值 $t^{\\ast}$ 以自然对数为单位的精确封闭形式表达式给出。不要进行四舍五入。", "solution": "我们从位置权重矩阵 (PWM) 和背景模型下的得分定义开始。根据定义，对于一个长度为 $w$ 的字串 $x_{1:w}$，其对数似然比得分为\n$$\nS(x_{1:w}) \\;=\\; \\sum_{i=1}^{w} \\ln\\!\\left(\\frac{\\theta_{i,x_{i}}}{b_{x_{i}}}\\right).\n$$\n在此，$w = 8$，在每个位置 $i$，对于碱基 $A$ 有 $\\theta_{i,A} = \\frac{1}{2}$，对于 $b \\in \\{C,G,T\\}$ 有 $\\theta_{i,b} = \\frac{1}{6}$，并且背景概率为 $b_{A} = b_{C} = b_{G} = b_{T} = \\frac{1}{4}$。\n\n首先，我们推导每个位置的不同得分值。在任意位置 $i$：\n- 如果 $x_{i} = A$，那么该位置的贡献为 $\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{4}}\\right) = \\ln 2$。\n- 如果 $x_{i} \\in \\{C,G,T\\}$，那么该位置的贡献为 $\\ln\\!\\left(\\frac{\\frac{1}{6}}{\\frac{1}{4}}\\right) = \\ln\\!\\left(\\frac{2}{3}\\right)$。\n\n因此，每个位置只有两个得分值：$\\ln 2$ 和 $\\ln\\!\\left(\\frac{2}{3}\\right)$。令 $k$ 表示在 8 个位置中 $x_{i} = A$ 的位置数量。那么总分为\n$$\nS \\;=\\; k \\cdot \\ln 2 + (8 - k)\\cdot \\ln\\!\\left(\\frac{2}{3}\\right).\n$$\n这可以等价地重写为\n$$\nS \\;=\\; 8 \\cdot \\ln\\!\\left(\\frac{2}{3}\\right) + k \\cdot \\left[\\ln 2 - \\ln\\!\\left(\\frac{2}{3}\\right)\\right]\n\\;=\\; 8 \\cdot \\ln\\!\\left(\\frac{2}{3}\\right) + k \\cdot \\ln 3.\n$$\n\n接下来，我们推导在背景模型下 $k$ 的精确分布。在背景模型下，各位置的碱基是独立的，其中 $b_{A} = \\frac{1}{4}$ 且 $b_{\\text{non-}A} = \\frac{3}{4}$。因此，在一个长度为 8 的随机背景字串中，碱基 $A$ 的数量 $k$ 服从参数为 $n = 8$ 和 $p = \\frac{1}{4}$ 的二项分布：\n$$\nk \\sim \\text{Binomial}\\!\\left(8, \\frac{1}{4}\\right),\n\\quad \\text{so} \\quad\n\\Pr(k = j) \\;=\\; \\binom{8}{j} \\left(\\frac{1}{4}\\right)^{j} \\left(\\frac{3}{4}\\right)^{8-j}.\n$$\n因为 $S$ 是 $k$ 的单调递增函数（$k$ 每增加 1，就会将一个 $\\ln\\!\\left(\\frac{2}{3}\\right)$ 替换为 $\\ln 2$，从而使总和增加），所以任何等于某个整数 $k$ 可实现的得分 $S$ 的阈值 $t$ 都对应于 $k$ 的一个尾部事件。具体来说，如果对于某个整数 $k_{0} \\in \\{0,1,\\dots,8\\}$ 有 $t = k_{0} \\cdot \\ln 2 + (8 - k_{0})\\cdot \\ln\\!\\left(\\frac{2}{3}\\right)$，那么\n$$\n\\Pr(S \\ge t) \\;=\\; \\Pr(k \\ge k_{0}) \\;=\\; \\sum_{j = k_{0}}^{8} \\binom{8}{j} \\left(\\frac{1}{4}\\right)^{j} \\left(\\frac{3}{4}\\right)^{8-j}.\n$$\n\n我们现在来确定最小得分阈值 $t^{\\ast}$，使得当扫描一条长度为 $L = 32775$ 的序列的两条链时，超过阈值的期望次数恰好为 $1$。计分窗口的数量是\n$$\nN \\;=\\; 2 \\, (L - w + 1) \\;=\\; 2 \\, (32775 - 8 + 1) \\;=\\; 2 \\cdot 32768 \\;=\\; 65536.\n$$\n对于给定的阈值 $t$，背景中超过阈值的期望次数（E 值）根据定义为\n$$\nE(t) \\;=\\; N \\cdot \\Pr(S \\ge t).\n$$\n我们寻求最小阈值 $t^{\\ast}$ 使得 $E(t^{\\ast}) = 1$。考虑对应于 $k=8$ 的最高可实现得分的阈值：\n$$\nt_{8} \\;=\\; 8 \\cdot \\ln 2.\n$$\n在这个阈值下，唯一达到或超过该阈值的字串是那些所有 8 个位置都等于 $A$ 的字串，因此\n$$\n\\Pr(S \\ge t_{8}) \\;=\\; \\Pr(k = 8) \\;=\\; \\left(\\frac{1}{4}\\right)^{8} \\;=\\; \\frac{1}{4^{8}} \\;=\\; \\frac{1}{65536}.\n$$\n因此，\n$$\nE(t_{8}) \\;=\\; N \\cdot \\Pr(S \\ge t_{8}) \\;=\\; 65536 \\cdot \\frac{1}{65536} \\;=\\; 1.\n$$\n因为 $S$ 随 $k$ 严格递增，任何严格大于 $t_{8}$ 的阈值 $t$ 都会有 $\\Pr(S \\ge t) = 0$，因此 $E(t) = 0$。而对于区间 $[t_{8}, t_{7})$（其中 $t_7$ 是 $k=7$ 时的得分）内的任何阈值 $t$，其尾部概率将与 $t_8$ 处相同，即 $\\Pr(S \\ge t) = \\Pr(k = 8)$，因此 E 值也同样为 1。所以，实现 $E=1$ 的最小可实现阈值恰好是 $t^{\\ast} = t_{8} = 8 \\cdot \\ln 2$。\n\n因此，以自然对数为单位表示，所需的阈值为\n$$\nt^{\\ast} \\;=\\; 8 \\cdot \\ln 2.\n$$", "answer": "$$\\boxed{8\\ln 2}$$", "id": "4586666"}, {"introduction": "在许多实际应用中，基序发现是一个迭代优化的过程，并且常常需要处理包含模糊碱基（如“N”）的不完美测序数据。期望最大化（EM）算法为此类问题提供了强大的框架，它能够从未对齐或不完整的序列数据中学习模型参数。本练习 [@problem_id:4586827] 将带您实践一种改进的 EM 算法，学习如何将模糊字符作为分数证据（fractional evidence）整合到 PWM 的参数更新中，并通过与简单的排除策略进行对比，加深您对处理真实世界数据复杂性的理解。", "problem": "位置权重矩阵 (PWM) 通过为每个基序位置分配脱氧核糖核酸 (DNA) 核苷酸 $\\{A, C, G, T\\}$ 上的一个分类分布来模拟转录因子结合基序。考虑当一些观测碱基是模糊的时，应用期望最大化 (EM) 算法 (Expectation-Maximization (EM)) 从一个对齐的基序实例集中更新一个 PWM，特别是当国际纯粹与应用化学联合会 (IUPAC) 编码 $N$ 表示一个未知核苷酸时。在改进的 EM 算法中，一个模糊碱基被视为一个潜在字母，其先验分类分布由背景核苷酸频率给出。在朴素排除策略中，当更新某个位置时，在该位置具有 $N$ 的实例将被忽略。\n\n从以下基本假设开始：每个基序位置是多项分类发射，位置之间相互独立，以及每个核苷酸具有集中度参数 $\\alpha$ 的对称狄利克雷先验。EM 的最大化步骤是使用每个实例的基序占据软责任来执行的。模糊字母根据背景分布贡献分数证据。\n\n现给定在特定位置 $j$ 的 $m = 8$ 个对齐的基序实例，及其每个实例的责任 $\\{r_{i}\\}_{i=1}^{m}$ 和观测字符 $\\{x_{i}\\}_{i=1}^{m}$：\n- 实例 1：$x_{1} = A$，$r_{1} = 0.9$\n- 实例 2：$x_{2} = N$，$r_{2} = 0.8$\n- 实例 3：$x_{3} = G$，$r_{3} = 0.7$\n- 实例 4：$x_{4} = T$，$r_{4} = 0.6$\n- 实例 5：$x_{5} = C$，$r_{5} = 0.5$\n- 实例 6：$x_{6} = N$，$r_{6} = 0.4$\n- 实例 7：$x_{7} = A$，$r_{7} = 0.3$\n- 实例 8：$x_{8} = T$，$r_{8} = 0.2$\n\n假设用于 $N$ 的背景核苷酸分布为 $\\pi = (\\pi_{A}, \\pi_{C}, \\pi_{G}, \\pi_{T}) = (0.3, 0.2, 0.2, 0.3)$，并对位置 $j$ 的每个核苷酸使用对称狄利克雷先验，其参数 $\\alpha = 0.1$。\n\n使用将 $N$ 解释为由 $\\pi$ 控制的分数证据并通过责任 $\\{r_{i}\\}$ 加权的改进 EM 方法，计算位置 $j$ 上核苷酸 $A$ 的更新后的 PWM 条目。另外，使用朴素排除策略，即忽略位置 $j$ 上 $x_{i} = N$ 的实例，计算位置 $j$ 上核苷酸 $A$ 的更新后的 PWM 条目。令 $\\Delta$ 为这两个更新条目之间的差值，定义为 $\\Delta = p_{\\text{EM}}(A) - p_{\\text{excl}}(A)$。\n\n以单个实数形式提供 $\\Delta$。将您的答案四舍五入到四位有效数字。不需要单位。", "solution": "该问题要求计算位置权重矩阵 (PWM) 参数的两种不同估计值以及它们的差值。我们感兴趣的参数是在特定位置 $j$ 观测到核苷酸 $A$ 的概率，记为 $p(A)$。给定 $m=8$ 个对齐的实例，其观测字符为 $\\{x_i\\}_{i=1}^8$，相应的责任为 $\\{r_i\\}_{i=1}^8$。PWM 参数的更新规则包含一个对称狄利克雷先验，每个核苷酸的集中度参数为 $\\alpha = 0.1$。\n\n在贝叶斯框架中，EM 算法的 M 步将参数更新为其后验均值。对于具有狄利克雷先验的多项分布，其后验分布也是一个狄利克雷分布。在位置 $j$（为了符号简洁，我们省略此标记）上，核苷酸 $b \\in \\{A, C, G, T\\}$ 的概率的后验均值由下式给出：\n$$ p(b) = \\frac{C_b + \\alpha_b}{\\sum_{k \\in \\{A, C, G, T\\}} (C_k + \\alpha_k)} $$\n此处，$C_b$ 是来自数据的核苷酸 $b$ 的期望计数，而 $\\alpha_b$ 是对应于核苷酸 $b$ 的狄利克雷先验的参数。给定每个核苷酸的集中度参数为 $\\alpha = 0.1$ 的对称先验，我们有 $\\alpha_A = \\alpha_C = \\alpha_G = \\alpha_T = 0.1$。公式变为：\n$$ p(b) = \\frac{C_b + \\alpha}{\\sum_{k} C_k + 4\\alpha} = \\frac{C_b + 0.1}{C_{\\text{total}} + 0.4} $$\n其中 $C_{\\text{total}} = \\sum_{k} C_k$。\n\n我们需要使用两种不同的策略来处理模糊核苷酸 $N$，并计算这个值。\n\n首先，我们使用改进的 EM 算法计算 $A$ 的更新后的 PWM 条目 $p_{\\text{EM}}(A)$。在这种方法中，模糊核苷酸 $N$ 根据背景分布 $\\pi = (\\pi_A, \\pi_C, \\pi_G, \\pi_T) = (0.3, 0.2, 0.2, 0.3)$ 贡献分数计数。一个具有明确碱基 $x_i=b$ 的实例 $i$ 对计数 $C_b$ 贡献 $r_i$。一个具有 $x_i=N$ 的实例 $i$ 对计数 $C_b$ 贡献 $r_i \\pi_b$。\n\n给定的数据是：\n- $x_1=A, r_1=0.9$\n- $x_2=N, r_2=0.8$\n- $x_3=G, r_3=0.7$\n- $x_4=T, r_4=0.6$\n- $x_5=C, r_5=0.5$\n- $x_6=N, r_6=0.4$\n- $x_7=A, r_7=0.3$\n- $x_8=T, r_8=0.2$\n\n核苷酸 $A$ 的期望计数，记为 $C_{\\text{EM},A}$，是所有实例贡献的总和：\n$$ C_{\\text{EM},A} = r_1 \\cdot 1 + r_2 \\cdot \\pi_A + r_7 \\cdot 1 + r_6 \\cdot \\pi_A $$\n$$ C_{\\text{EM},A} = 0.9 + (0.8)(0.3) + 0.3 + (0.4)(0.3) = 0.9 + 0.24 + 0.3 + 0.12 = 1.56 $$\n总期望计数 $C_{\\text{EM,total}}$ 是所有责任的总和，因为 $\\sum_b \\pi_b = 1$：\n$$ C_{\\text{EM,total}} = \\sum_{i=1}^8 r_i = 0.9 + 0.8 + 0.7 + 0.6 + 0.5 + 0.4 + 0.3 + 0.2 = 4.4 $$\n现在，我们可以计算 $p_{\\text{EM}}(A)$：\n$$ p_{\\text{EM}}(A) = \\frac{C_{\\text{EM},A} + \\alpha}{C_{\\text{EM,total}} + 4\\alpha} = \\frac{1.56 + 0.1}{4.4 + 4(0.1)} = \\frac{1.66}{4.4 + 0.4} = \\frac{1.66}{4.8} $$\n\n其次，我们使用朴素排除策略计算 $A$ 的更新后的 PWM 条目 $p_{\\text{excl}}(A)$。在这种方法中，具有 $x_i = N$ 的实例（实例 2 和 6）从该位置的计算中被省略。考虑的实例集合是 $\\{1, 3, 4, 5, 7, 8\\}$。\n\n核苷酸 $A$ 的期望计数 $C_{\\text{excl},A}$ 是从这个子集中计算得出的：\n$$ C_{\\text{excl},A} = r_1 + r_7 = 0.9 + 0.3 = 1.2 $$\n此策略的总期望计数 $C_{\\text{excl,total}}$ 是所包含实例的责任之和：\n$$ C_{\\text{excl,total}} = r_1 + r_3 + r_4 + r_5 + r_7 + r_8 = 0.9 + 0.7 + 0.6 + 0.5 + 0.3 + 0.2 = 3.2 $$\n现在我们可以计算 $p_{\\text{excl}}(A)$：\n$$ p_{\\text{excl}}(A) = \\frac{C_{\\text{excl},A} + \\alpha}{C_{\\text{excl,total}} + 4\\alpha} = \\frac{1.2 + 0.1}{3.2 + 4(0.1)} = \\frac{1.3}{3.2 + 0.4} = \\frac{1.3}{3.6} $$\n\n最后，我们计算差值 $\\Delta = p_{\\text{EM}}(A) - p_{\\text{excl}}(A)$：\n$$ \\Delta = \\frac{1.66}{4.8} - \\frac{1.3}{3.6} $$\n我们将分数转换为小数形式进行计算：\n$$ p_{\\text{EM}}(A) = \\frac{1.66}{4.8} = 0.3458333... $$\n$$ p_{\\text{excl}}(A) = \\frac{1.3}{3.6} = 0.3611111... $$\n$$ \\Delta = 0.3458333... - 0.3611111... = -0.0152777... $$\n问题要求答案四舍五入到四位有效数字。第一个有效数字是百分位上的 $1$。四位有效数字是 $1、5、2、7$。第四位有效数字后面的数字是 $7$，它 $\\ge 5$，所以我们将最后一位数字向上取整。\n$$ \\Delta \\approx -0.01528 $$", "answer": "$$\\boxed{-0.01528}$$", "id": "4586827"}]}