{"hands_on_practices": [{"introduction": "理解评分矩阵的构建原理是有效使用它们的第一步。本练习将通过指导你为一个简化的氨基酸集构建一个点接受突变（PAM）矩阵，来揭开这一过程的神秘面纱。此练习将马尔可夫链和进化时间等抽象概念与基于比对数据的具体计算联系起来，让你亲手体验从原始数据到对数几率分数的完整流程。[@problem_id:4591478]", "problem": "一位计算生物学家正在使用一个包含四种残基的简化字母表，为氨基酸替换构建一个点接受突变 (PAM) 模型。这四种残基是：丙氨酸 (A)、甘氨酸 (G)、丝氨酸 (S) 和苏氨酸 (T)。该数据集包含在仿射空位罚分模型（空位开放成本为 $g$，空位延伸成本为 $e$）下构建的比对，该模型经过调整，使得在此进化距离上空位出现率可以忽略不计；用于估计的列中没有空位字符。进化分歧约为一个点接受突变 (PAM)，这意味着每个位点的预期可接受点突变分数为 $0.01$。该生物学家假设替换过程遵循一个时间可逆的连续时间马尔可夫链 (CTMC) 模型，其瞬时速率矩阵为 $Q=\\{q_{ij}\\}$，对于 $i\\neq j$ 满足 $q_{ij}=s_{ij}\\,\\pi_{j}$，其中 $\\pi_{j}$ 是稳态氨基酸频率，$S=\\{s_{ij}\\}$ 是可交换性矩阵。对角线元素遵循 $q_{ii}=-\\sum_{j\\neq i}q_{ij}$。\n\n从一组独立比对位置的集合中，获得了以下汇总计数。总比对位置数为 $N=10{,}000$。观察到的稳态频率（由经验边际概率近似）为 $\\pi_{\\mathrm{A}}=0.35$、$\\pi_{\\mathrm{G}}=0.25$、$\\pi_{\\mathrm{S}}=0.25$ 和 $\\pi_{\\mathrm{T}}=0.15$。错配比对对的总数为 $M=100$。残基对之间的无序错配计数为：A–G 有 $30$ 个，A–S 有 $24$ 个，A–T 有 $6$ 个，G–S 有 $20$ 个，G–T 有 $10$ 个，S–T 有 $10$ 个。假设在每个无序对中，方向性变化是对称的，即 A–G 错配中恰好有一半对应于 $\\mathrm{A}\\to\\mathrm{G}$，另一半对应于 $\\mathrm{G}\\to\\mathrm{A}$，其他无序对也类似。\n\n使用基本的 CTMC 小时间近似，即对于足够小的时间 $t$，替换概率满足 $p_{ij}(t)\\approx q_{ij}\\,t$ (当 $i\\neq j$) 和 $p_{ii}(t)\\approx 1+\\!q_{ii}\\,t$，并定义 PAM$1$ 时间尺度，使得每个位点的预期变化分数为 $0.01$，按以下步骤进行：\n\n1. 从方向性计数的定义 $E_{ij}\\approx N\\,\\pi_{i}\\,q_{ij}\\,t$ 出发，根据观察到的计数和频率，估计模型的缩放后可交换性参数 $s_{ij}\\,t$，并明确计算 $s_{\\mathrm{AG}}\\,t$。\n2. 使用相同的近似，计算 $\\mathrm{A}\\to\\mathrm{G}$ 的 PAM$1$ 转换概率 $p_{\\mathrm{AG}}$。\n3. 在 PAM$1$ 模型下，相对于背景频率为 $\\pi_{\\mathrm{G}}$ 的随机模型，推导观察到与祖先 $\\mathrm{A}$ 比对的 $\\mathrm{G}$ 的对数奇比分（以比特为单位），其定义为 $S_{\\mathrm{AG}}=\\log_{2}\\!\\left(\\frac{p_{\\mathrm{AG}}}{\\pi_{\\mathrm{G}}}\\right)$。\n\n请以 $S_{\\mathrm{AG}}$ 的单个精确解析表达式（以比特为单位）给出最终答案。不需要四舍五入。最终的方框答案中不要包含单位。", "solution": "首先对问题进行验证，以确保其科学上合理、提法明确且客观。\n\n**问题验证**\n\n**第 1 步：提取的已知条件**\n-   氨基酸字母表：{A, G, S, T}\n-   模型：时间可逆连续时间马尔可夫链 (CTMC)\n-   进化距离：1 PAM，对应于每个位点 $0.01$ 的预期可接受点突变分数。\n-   瞬时速率矩阵：$Q = \\{q_{ij}\\}$，其中当 $i \\neq j$ 时，$q_{ij} = s_{ij}\\pi_j$。$S = \\{s_{ij}\\}$ 是对称的可交换性矩阵，$\\pi_j$ 是稳态频率。对角线元素满足 $q_{ii} = -\\sum_{j \\neq i} q_{ij}$。\n-   总比对位置数：$N = 10,000$。\n-   稳态频率：$\\pi_{\\mathrm{A}} = 0.35$、$\\pi_{\\mathrm{G}} = 0.25$、$\\pi_{\\mathrm{S}} = 0.25$ 和 $\\pi_{\\mathrm{T}} = 0.15$。\n-   总错配对数：$M = 100$。\n-   无序错配计数：A–G (30)、A–S (24)、A–T (6)、G–S (20)、G–T (10)、S–T (10)。\n-   方向性变化的对称性：假定在每个无序对中，每个方向的变化占 1/2。\n-   小时间近似：当 $i \\neq j$ 时，$p_{ij}(t) \\approx q_{ij}t$，以及 $p_{ii}(t) \\approx 1 + q_{ii}t$。\n-   预期方向性计数估计量：$E_{ij} \\approx N\\pi_i q_{ij}t$。\n-   对数奇比分定义：$S_{\\mathrm{AG}} = \\log_{2}(p_{\\mathrm{AG}} / \\pi_{\\mathrm{G}})$。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   问题是**科学上合理的**。它使用了分子进化建模的标准原理，特别是 CTMC 框架和 PAM 模型，这些都是生物信息学的基石。\n-   问题是**提法明确且完整的**。所有必要的数据（计数、频率、总位点数）和定义（速率矩阵结构、PAM 距离、对数奇比分）都已提供。给定频率的总和为 $0.35 + 0.25 + 0.25 + 0.15 = 1.00$。无序错配计数的总和为 $30+24+6+20+10+10 = 100$，与总错配计数 $M$ 相符。错配位点的分数为 $100/10,000 = 0.01$，这与 1 PAM 的定义一致。问题是内部一致的。\n-   问题是**客观且陈述精确的**，使用了正式的数学和生物学术语，没有歧义。\n\n**第 3 步：结论与行动**\n该问题被判定为有效。将提供完整解答。\n\n**解题推导**\n\n该问题要求分三步计算对数奇比分 $S_{\\mathrm{AG}}$。我们将遵循这一结构。\n\n**1. 估计缩放后的可交换性参数 $s_{\\mathrm{AG}}t$**\n\n在 $N$ 个位点的比对中，经过时间间隔 $t$ 后，从残基 $i$ 到残基 $j$ 的预期方向性替换数由 $E_{ij}$ 给出。问题为此量提供了一个基于 CTMC 模型的近似值：\n$$ E_{ij} \\approx N \\pi_i p_{ij}(t) $$\n使用小时间近似 $p_{ij}(t) \\approx q_{ij}t$（对于 $i \\neq j$），上式变为：\n$$ E_{ij} \\approx N \\pi_i q_{ij} t $$\n问题进一步指明了速率矩阵的结构为 $q_{ij} = s_{ij}\\pi_j$，其中 $s_{ij}$ 是残基 $i$ 和 $j$ 之间的可交换性。将此代入前面的表达式可得：\n$$ E_{ij} \\approx N \\pi_i (s_{ij}\\pi_j) t = N \\pi_i \\pi_j s_{ij}t $$\n我们可以使用观察到的方向性替换计数 $C_{ij}$ 来估计理论期望值 $E_{ij}$。因此，我们可以写出：\n$$ C_{ij} \\approx N \\pi_i \\pi_j s_{ij}t $$\n这使我们能够估计缩放后的可交换性参数 $s_{ij}t$：\n$$ s_{ij}t \\approx \\frac{C_{ij}}{N \\pi_i \\pi_j} $$\n问题提供了无序 A–G 错配的数量为 30。根据对称性假设，方向性 $\\mathrm{A} \\to \\mathrm{G}$ 替换的数量是此值的一半：\n$$ C_{\\mathrm{AG}} = \\frac{30}{2} = 15 $$\n给定以下值：$N = 10,000$、$\\pi_{\\mathrm{A}} = 0.35$ 和 $\\pi_{\\mathrm{G}} = 0.25$。将这些值代入 $s_{\\mathrm{AG}}t$ 的表达式中：\n$$ s_{\\mathrm{AG}}t \\approx \\frac{15}{10,000 \\times 0.35 \\times 0.25} = \\frac{15}{10,000 \\times \\frac{35}{100} \\times \\frac{25}{100}} = \\frac{15}{10,000 \\times \\frac{7}{20} \\times \\frac{1}{4}} = \\frac{15}{875} = \\frac{3}{175} $$\n这就完成了任务的第一部分。\n\n**2. 计算 PAM1 转换概率 $p_{\\mathrm{AG}}$**\n\n数据中的时间尺度 $t$ 对应于 1 PAM，其定义为每个位点预期有 0.01 次替换。数据中观察到的错配分数为 $M/N = 100/10,000 = 0.01$，证实了进化距离确实是 1 PAM。因此，我们可以使用小时间近似来计算 PAM$1$ 转换概率 $p_{\\mathrm{AG}}$：\n$$ p_{\\mathrm{AG}} \\approx q_{\\mathrm{AG}}t $$\n根据速率矩阵的定义，$q_{\\mathrm{AG}} = s_{\\mathrm{AG}}\\pi_{\\mathrm{G}}$。因此：\n$$ p_{\\mathrm{AG}} \\approx (s_{\\mathrm{AG}}\\pi_{\\mathrm{G}})t = (s_{\\mathrm{AG}}t)\\pi_{\\mathrm{G}} $$\n我们可以代入从计数中导出的 $s_{\\mathrm{AG}}t$ 的表达式：\n$$ s_{\\mathrm{AG}}t \\approx \\frac{C_{\\mathrm{AG}}}{N \\pi_{\\mathrm{A}} \\pi_{\\mathrm{G}}} $$\n这给出了以观测数据表示的转换概率：\n$$ p_{\\mathrm{AG}} \\approx \\left(\\frac{C_{\\mathrm{AG}}}{N \\pi_{\\mathrm{A}} \\pi_{\\mathrm{G}}}\\right) \\pi_{\\mathrm{G}} = \\frac{C_{\\mathrm{AG}}}{N \\pi_{\\mathrm{A}}} $$\n代入数值：\n$$ p_{\\mathrm{AG}} \\approx \\frac{15}{10,000 \\times 0.35} = \\frac{15}{3500} = \\frac{3}{700} $$\n\n**3. 推导对数奇比分 $S_{\\mathrm{AG}}$**\n\n将残基 $j$ 与祖先残基 $i$ 比对的对数奇比分定义为替换的条件概率与残基 $j$ 的背景概率之比的对数。对于 A-G 对，以比特为单位，其值为：\n$$ S_{\\mathrm{AG}} = \\log_{2}\\left(\\frac{p_{\\mathrm{AG}}}{\\pi_{\\mathrm{G}}}\\right) $$\n使用我们计算出的值 $p_{\\mathrm{AG}} \\approx \\frac{3}{700}$ 和给定的稳态频率 $\\pi_{\\mathrm{G}} = 0.25 = \\frac{1}{4}$：\n$$ S_{\\mathrm{AG}} = \\log_{2}\\left(\\frac{3/700}{1/4}\\right) $$\n$$ S_{\\mathrm{AG}} = \\log_{2}\\left(\\frac{3}{700} \\times 4\\right) = \\log_{2}\\left(\\frac{12}{700}\\right) $$\n简化对数内的分数：\n$$ \\frac{12}{700} = \\frac{6}{350} = \\frac{3}{175} $$\n因此，对数奇比分的最终精确解析表达式为：\n$$ S_{\\mathrm{AG}} = \\log_{2}\\left(\\frac{3}{175}\\right) $$\n此表达式是按要求给出的精确表达式，无需进行数值计算。顺便提一下，也可以通过将 $p_{\\mathrm{AG}}$ 的完整符号表达式代入分数定义来推导：\n$$ S_{\\mathrm{AG}} \\approx \\log_{2}\\left(\\frac{C_{\\mathrm{AG}}/(N \\pi_{\\mathrm{A}})}{\\pi_{\\mathrm{G}}}\\right) = \\log_{2}\\left(\\frac{C_{\\mathrm{AG}}}{N \\pi_{\\mathrm{A}} \\pi_{\\mathrm{G}}}\\right) $$\n代入值 $C_{\\mathrm{AG}}=15$、$N=10,000$、$\\pi_{\\mathrm{A}}=0.35$ 和 $\\pi_{\\mathrm{G}}=0.25$ 会得到相同的结果：\n$$ S_{\\mathrm{AG}} = \\log_{2}\\left(\\frac{15}{10,000 \\times 0.35 \\times 0.25}\\right) = \\log_{2}\\left(\\frac{15}{875}\\right) = \\log_{2}\\left(\\frac{3}{175}\\right) $$", "answer": "$$\\boxed{\\log_{2}\\left(\\frac{3}{175}\\right)}$$", "id": "4591478"}, {"introduction": "作为PAM模型的替代方法，BLOSUM系列矩阵是通过直接观察保守区域中的替换而开发的，从而避免了PAM模型中的进化外推。本练习将重点介绍序列聚类和加权的关键步骤，这些步骤是为修正系统发育偏差而设计的，也是现代替换矩阵构建的基石。通过这个练习，你将理解如何从一个多重序列比对块中提取信息并构建一个BLOSUM类型的评分矩阵。[@problem_id:4591431]", "problem": "考虑一个由四个蛋白质序列组成的无空位保守块比对，每个序列的长度为 $6$ 列。序列如下：\n- $S_1$: ACDEFG\n- $S_2$: ACDQFG\n- $S_3$: ASDEFG\n- $S_4$: VCNEYG\n\n假设使用贪婪单链接方案在一致性阈值 $T = 0.7$ 下进行 BLOSUM（区块替换矩阵）聚类。在贪婪单链接聚类中，序列被视为图中的节点，如果两个节点间的两两一致性（在比对列中相同残基的比例）至少为 $T$，则在这两个节点之间画一条边，而聚类则是由这些边导出的连通分量。在每个聚类内部，为每个序列分配一个等于该聚类大小倒数的权重，并且簇内的比对残基对将从所有后续计数中排除。在聚类之间，每对序列都对观测到的比对残基对计数有贡献，其贡献值按这两个序列权重的乘积进行加权。\n\n使用对数奇数替换评分量化观测到的比对残基对相对于独立背景组成期望值的信息含量的基本定义，从第一性原理出发执行以下步骤：\n- 确定在阈值 $T$ 下的聚类以及由此产生的每个序列的权重。\n- 遍历所有列，枚举所有跨聚类的序列对，并为每个无序残基对 $\\{i,j\\}$ 累加加权计数，忽略簇内对。\n- 将这些计数归一化，以获得所有无序对的无序对概率 $p^{\\mathrm{unord}}_{ij}$，使得 $\\sum_{i \\le j} p^{\\mathrm{unord}}_{ij} = 1$。\n- 对于 $i \\ne j$ 的情况，通过在 $(i,j)$ 和 $(j,i)$ 之间均等分配概率质量，将 $p^{\\mathrm{unord}}_{ij}$ 转换为有序对概率 $p_{ij}$，并保持 $p_{ii}$ 不变，使得 $\\sum_{i}\\sum_{j} p_{ij} = 1$。\n- 通过对与 $i$ 比对的所有项求和，从有序对概率中获得残基背景概率 $q_i$，即 $q_i = \\sum_{j} p_{ij}$。\n\n最后，使用这些定义，推导特定非对角线对 $D$ 与 $N$ 比对的、类似BLOSUM的以2为底的对数奇数替换分数。将最终分数表示为精确的以2为底的对数，不进行四舍五入且不带单位。由于该块是无空位的，因此不需要空位罚分模型，但您的推导应清楚说明，根据典型的基于块的替换矩阵构建原则，为何在此阶段会排除空位。", "solution": "该问题要求基于一个由四个序列组成的小型、无空位的块比对，计算氨基酸对 (D, N) 的类似BLOSUM的对数奇数分数。推导过程必须遵循第一性原理，从序列聚类和加权开始，然后进行配对计数和概率计算，最后得出对数奇数分数公式。推导过程按以下步骤进行。\n\n**步骤 1：序列聚类与加权**\n\n我们首先计算所有序列对的两两一致性。一致性 $I(S_a, S_b)$ 是比对中相同残基的比例。比对长度为 $L=6$。所有序列对都根据一致性阈值 $T = 0.7$ 进行评估。\n\n序列如下：\n$S_1$: ACDEFG\n$S_2$: ACDQFG\n$S_3$: ASDEFG\n$S_4$: VCNEYG\n\n两两一致性：\n- $I(S_1, S_2)$: 匹配位置在第 $1, 2, 3, 5, 6$ 列。匹配数量 = $5$。一致性 = $5/6 \\approx 0.833$。由于 $0.833 > 0.7$，$S_1$ 和 $S_2$ 之间存在一条边。\n- $I(S_1, S_3)$: 匹配位置在第 $1, 3, 4, 5, 6$ 列。匹配数量 = $5$。一致性 = $5/6 \\approx 0.833$。由于 $0.833 > 0.7$，$S_1$ 和 $S_3$ 之间存在一条边。\n- $I(S_1, S_4)$: 匹配位置在第 $2, 4, 6$ 列。匹配数量 = $3$。一致性 = $3/6 = 0.5$。由于 $0.5  0.7$，$S_1$ 和 $S_4$ 之间不存在边。\n- $I(S_2, S_3)$: 匹配位置在第 $1, 3, 5, 6$ 列。匹配数量 = $4$。一致性 = $4/6 \\approx 0.667$。由于 $0.667  0.7$，$S_2$ 和 $S_3$ 之间不存在边。\n- $I(S_2, S_4)$: 匹配位置在第 $2, 6$ 列。匹配数量 = $2$。一致性 = $2/6 \\approx 0.333$。由于 $0.333  0.7$，$S_2$ 和 $S_4$ 之间不存在边。\n- $I(S_3, S_4)$: 匹配位置在第 $4, 6$ 列。匹配数量 = $2$。一致性 = $2/6 \\approx 0.333$。由于 $0.333  0.7$，$S_3$ 和 $S_4$ 之间不存在边。\n\n基于单链接聚类，我们识别连通分量。由于 $S_1$ 与 $S_2$ 和 $S_3$ 都相连，序列 $\\{S_1, S_2, S_3\\}$ 构成一个聚类。$S_4$ 没有与之相连的边，因此它自己形成一个单个元素的聚类。\n聚类如下：\n- 聚类 1：$\\{S_1, S_2, S_3\\}$，大小 $n_1 = 3$。\n- 聚类 2：$\\{S_4\\}$，大小 $n_2 = 1$。\n\n一个聚类中每个序列的权重是该聚类大小的倒数。\n- 对于聚类 1 中的 $S_1, S_2, S_3$，权重为 $w_1 = w_2 = w_3 = 1/n_1 = 1/3$。\n- 对于聚类 2 中的 $S_4$，权重为 $w_4 = 1/n_2 = 1/1 = 1$。\n\n**步骤 2：累加加权配对计数**\n\n根据规则，我们只计算来自不同聚类的序列的残基对。需要考虑的对是 $(S_1, S_4)$、$(S_2, S_4)$ 和 $(S_3, S_4)$。簇内的对，如 $(S_1, S_2)$，被排除在外。每个比对残基对的计数按序列权重的乘积进行加权。此处所有跨聚类的对的权重为 $w_i \\times w_4 = (1/3) \\times 1 = 1/3$。\n\n我们逐列枚举跨聚类序列对的无序残基对 $\\{i,j\\}$，并累加它们的加权计数，记为 $N_{ij}$。\n\n- 来自 $(S_1, S_4)$ 的比对对：`ACDEFG` vs `VCNEYG` $\\rightarrow$ {A,V}, {C,C}, {D,N}, {E,E}, {F,Y}, {G,G}。每个对其各自的计数贡献 $1/3$。\n- 来自 $(S_2, S_4)$ 的比对对：`ACDQFG` vs `VCNEYG` $\\rightarrow$ {A,V}, {C,C}, {D,N}, {Q,E}, {F,Y}, {G,G}。每个对其各自的计数贡献 $1/3$。\n- 来自 $(S_3, S_4)$ 的比对对：`ASDEFG` vs `VCNEYG` $\\rightarrow$ {A,V}, {S,C}, {D,N}, {E,E}, {F,Y}, {G,G}。每个对其各自的计数贡献 $1/3$。\n\n每个无序对 $\\{i,j\\}$ 的总加权计数：\n- $N_{AV} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{CC} = 1/3 + 1/3 = 2/3$\n- $N_{DN} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{EE} = 1/3 + 1/3 = 2/3$\n- $N_{FY} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{GG} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{EQ} = 1/3$\n- $N_{CS} = 1/3$\n\n所有其他对的计数均为 $0$。加权对的总数 $N_{tot}$ 是这些计数的总和：\n$N_{tot} = 1 + 2/3 + 1 + 2/3 + 1 + 1 + 1/3 + 1/3 = 4 + 6/3 = 4 + 2 = 6$。\n这与贡献对的总数（$3$ 个序列对 $\\times 6$ 列）乘以它们的权重（$1/3$）相匹配，即 $3 \\times 6 \\times (1/3) = 6$。\n\n**步骤 3：计算配对概率 ($p^{\\mathrm{unord}}_{ij}$ 和 $p_{ij}$)**\n\n观测到无序对 $\\{i,j\\}$ 的概率 $p^{\\mathrm{unord}}_{ij}$ 是其加权计数除以总加权计数得到的归一化值。\n$p^{\\mathrm{unord}}_{ij} = N_{ij} / N_{tot}$。\n对于我们感兴趣的对 $\\{D,N\\}$：\n$p^{\\mathrm{unord}}_{DN} = N_{DN} / N_{tot} = 1/6$。\n\n接下来，我们将这些转换为有序对概率 $p_{ij}$。对于 $i \\neq j$，$p_{ij} = p_{ji} = p^{\\mathrm{unord}}_{ij} / 2$。对于 $i=j$，$p_{ii} = p^{\\mathrm{unord}}_{ii}$。\n由于 $D \\neq N$，有序对 $(D,N)$ 的概率为：\n$p_{DN} = p^{\\mathrm{unord}}_{DN} / 2 = (1/6) / 2 = 1/12$。\n\n**步骤 4：计算背景残基概率 ($q_i$)**\n\n残基 $i$ 的背景概率 $q_i$ 是其总体频率，由有序对概率导出：$q_i = \\sum_{j} p_{ij}$。我们需要求出 $q_D$ 和 $q_N$。\n从我们的计数中，唯一与D比对的残基是N，唯一与N比对的残基是D。\n$q_D = \\sum_{j} p_{Dj} = p_{DN} = 1/12$。\n$q_N = \\sum_{j} p_{Nj} = p_{ND} = 1/12$。\n所以，$q_D = 1/12$ 且 $q_N = 1/12$。\n\n**步骤 5：计算对数奇数分数**\n\n残基 $i$ 替换为残基 $j$ 的对数奇数分数 $S_{ij}$，比较的是观测到的比对概率 $p_{ij}$ 与一个模型下的期望概率 $e_{ij}$。在该模型中，残基根据其背景频率随机比对。期望概率为 $e_{ij} = q_i q_j$。分数以2为底的对数（比特）给出。\n\n$S_{ij} = \\log_2 \\left( \\frac{p_{ij}}{e_{ij}} \\right) = \\log_2 \\left( \\frac{p_{ij}}{q_i q_j} \\right)$。\n\n我们要求的是对 $(D,N)$ 的分数 $S_{DN}$：\n- $p_{DN} = 1/12$\n- $q_D = 1/12$\n- $q_N = 1/12$\n\n代入这些值：\n$S_{DN} = \\log_2 \\left( \\frac{1/12}{(1/12) \\times (1/12)} \\right) = \\log_2 \\left( \\frac{1}{1/12} \\right) = \\log_2(12)$。\n\n最终分数要求以精确的以2为底的对数形式表示。\n\n**空位的排除**\n\n问题指明了“无空位保守块比对”，而构建BLOSUM矩阵的过程本身就从频率计数中排除了空位。其基本原理在于替换事件与插入/删除（indel）事件之间的根本区别。像BLOSUM这样的替换矩阵旨在为一种氨基酸在进化过程中被另一种氨基酸替换的可能性打分。一个由'-'表示的空位不是氨基酸；它标志着一个插入/删除事件。控制替换的进化过程和概率与控制插入/删除的过程和概率是不同的。因此，比对评分包含两个独立的部分：一个用于匹配/不匹配残基的替换矩阵和一个用于插入/删除的空位罚分函数。要构建替换矩阵，必须分离出纯粹的替换事件。这通过使用根据定义不含空位的比对块来实现。源多重比对中任何包含空位的列在统计残基-残基对频率时都将被忽略。", "answer": "$$\\boxed{\\log_{2}(12)}$$", "id": "4591431"}, {"introduction": "掌握了矩阵的构建方法后，我们的重点转向解读其分数的统计意义。对于局部比对（如BLAST所使用的），原始分数的显著性取决于一个严谨的统计框架（Karlin-Altschul统计理论）。本练习将探讨该理论的核心参数 $\\lambda$，并揭示实际应用中的权衡——例如，为计算速度而将分数取整——如何影响比对分数的统计基础。[@problem_id:4591501]", "problem": "考虑一个基于字母表 $\\{A, C, G, T\\}$ 的核苷酸计分方案，其背景频率是均一的，$q_{A} = q_{C} = q_{G} = q_{T} = \\frac{1}{4}$。得分矩阵 $S$ 为匹配指定 $S_{ii} = s_{\\mathrm{m}}$，为错配指定 $S_{ij} = s_{\\mathrm{x}}$，其中 $s_{\\mathrm{m}} = 1.64$ 且 $s_{\\mathrm{x}} = -1.64$。在局部比对理论中，参数 $\\lambda$ 被定义为矩生成函数方程的唯一正解：\n$$\\sum_{i,j} q_{i} q_{j} \\exp\\!\\big(\\lambda\\, S_{ij}\\big) = 1.$$\n在动态规划中实现计分时，替换矩阵的整数化是一个常见步骤。设整数化矩阵 $S'$ 是通过将 $S$ 的每个元素四舍五入到最近的整数得到的，因此 $S'_{ii} = 2$ 且 $S'_{ij} = -2$。\n\n从背景频率和对数-奇数计分的基本定义出发，并使用上述矩生成函数方程，确定在整数化之前（使用 $S$）和整数化之后（使用 $S'$）求解该方程的唯一正 $\\lambda$。然后计算绝对相对变化\n$$\\Delta = \\frac{|\\lambda_{\\mathrm{int}} - \\lambda_{\\mathrm{real}}|}{\\lambda_{\\mathrm{real}}},$$\n其中 $\\lambda_{\\mathrm{real}}$ 是使用 $S$ 得到的解，而 $\\lambda_{\\mathrm{int}}$ 是使用 $S'$ 得到的解。将 $\\Delta$ 表示为一个纯数（无量纲）。将您的最终答案四舍五入到四位有效数字。", "solution": "该问题被评估为有科学依据、提法明确且客观。它基于局部序列比对的既定统计框架（Karlin-Altschul 统计学），提供了所有必要的数据和定义，并且没有歧义或矛盾。存在唯一正 $\\lambda$ 的条件，即期望得分为负，对于实数和整数化得分矩阵都得到满足。因此，我们可以继续进行求解。\n\n该问题要求我们找到参数 $\\lambda$，它是方程的唯一正解：\n$$ \\sum_{i,j} q_{i} q_{j} \\exp(\\lambda S_{ij}) = 1 $$\n字母表为 $\\{A, C, G, T\\}$，因此有 $4 \\times 4 = 16$ 个 $(i,j)$ 对。给定的背景频率是均一的：$q_{A} = q_{C} = q_{G} = q_{T} = \\frac{1}{4}$。因此，对于任何一对 $(i,j)$，背景频率的乘积为 $q_{i} q_{j} = (\\frac{1}{4})(\\frac{1}{4}) = \\frac{1}{16}$。\n\n求和可以分为两部分：一部分用于 $i=j$ 的匹配，另一部分用于 $i \\neq j$ 的错配。有 $4$ 种可能的匹配（$(A,A), (C,C), (G,G), (T,T)$）和 $16 - 4 = 12$ 种可能的错配。得分矩阵 $S$ 对所有匹配有恒定的得分 $S_{ii} = s_{\\mathrm{m}}$，对所有错配有恒定的得分 $S_{ij} = s_{\\mathrm{x}}$（当 $i \\neq j$ 时）。\n\n因此，方程可以写成：\n$$ 4 \\cdot \\left(q_i q_j\\right) \\exp(\\lambda s_{\\mathrm{m}}) + 12 \\cdot \\left(q_i q_j\\right) \\exp(\\lambda s_{\\mathrm{x}}) = 1 $$\n代入 $q_i q_j = \\frac{1}{16}$：\n$$ 4 \\cdot \\frac{1}{16} \\exp(\\lambda s_{\\mathrm{m}}) + 12 \\cdot \\frac{1}{16} \\exp(\\lambda s_{\\mathrm{x}}) = 1 $$\n$$ \\frac{1}{4} \\exp(\\lambda s_{\\mathrm{m}}) + \\frac{3}{4} \\exp(\\lambda s_{\\mathrm{x}}) = 1 $$\n\n首先，我们使用实数值得分矩阵 $S$ 计算 $\\lambda_{\\mathrm{real}}$，其中 $s_{\\mathrm{m}} = 1.64$ 且 $s_{\\mathrm{x}} = -1.64$。\n将这些值代入方程：\n$$ \\frac{1}{4} \\exp(1.64 \\lambda_{\\mathrm{real}}) + \\frac{3}{4} \\exp(-1.64 \\lambda_{\\mathrm{real}}) = 1 $$\n为了解这个超越方程，令 $y = \\exp(1.64 \\lambda_{\\mathrm{real}})$。方程变为：\n$$ \\frac{1}{4} y + \\frac{3}{4} y^{-1} = 1 $$\n整个方程乘以 $4y$ 以消去分母和负指数，得到：\n$$ y^2 + 3 = 4y $$\n整理成标准二次型：\n$$ y^2 - 4y + 3 = 0 $$\n这个二次方程可以因式分解为：\n$$ (y - 1)(y - 3) = 0 $$\n$y$ 的解是 $y=1$ 和 $y=3$。我们代回 $y = \\exp(1.64 \\lambda_{\\mathrm{real}})$。\n情况1：$y = 1$。\n$$ \\exp(1.64 \\lambda_{\\mathrm{real}}) = 1 $$\n$$ 1.64 \\lambda_{\\mathrm{real}} = \\ln(1) = 0 $$\n$$ \\lambda_{\\mathrm{real}} = 0 $$\n这是一个平凡解。Karlin-Altschul 统计学理论保证，当期望得分为负时，$\\lambda$ 存在唯一的正解，因此我们寻找非零解。\n\n情况2：$y = 3$。\n$$ \\exp(1.64 \\lambda_{\\mathrm{real}}) = 3 $$\n$$ 1.64 \\lambda_{\\mathrm{real}} = \\ln(3) $$\n$$ \\lambda_{\\mathrm{real}} = \\frac{\\ln(3)}{1.64} $$\n这就是所求的唯一正解。\n\n接下来，我们使用整数化得分矩阵 $S'$ 计算 $\\lambda_{\\mathrm{int}}$，其中 $s'_{\\mathrm{m}} = 2$ 且 $s'_{\\mathrm{x}} = -2$。过程是相同的。控制方程为：\n$$ \\frac{1}{4} \\exp(\\lambda s'_{\\mathrm{m}}) + \\frac{3}{4} \\exp(\\lambda s'_{\\mathrm{x}}) = 1 $$\n$$ \\frac{1}{4} \\exp(2 \\lambda_{\\mathrm{int}}) + \\frac{3}{4} \\exp(-2 \\lambda_{\\mathrm{int}}) = 1 $$\n令 $z = \\exp(2 \\lambda_{\\mathrm{int}})$。方程变为：\n$$ \\frac{1}{4} z + \\frac{3}{4} z^{-1} = 1 $$\n$$ z^2 - 4z + 3 = 0 $$\n这与之前的二次方程相同，解为 $z=1$ 和 $z=3$。同样，我们舍弃导致 $\\lambda_{\\mathrm{int}} = 0$ 的解。唯一的正解来自 $z=3$：\n$$ \\exp(2 \\lambda_{\\mathrm{int}}) = 3 $$\n$$ 2 \\lambda_{\\mathrm{int}} = \\ln(3) $$\n$$ \\lambda_{\\mathrm{int}} = \\frac{\\ln(3)}{2} $$\n\n最后，我们计算绝对相对变化 $\\Delta$：\n$$ \\Delta = \\frac{|\\lambda_{\\mathrm{int}} - \\lambda_{\\mathrm{real}}|}{\\lambda_{\\mathrm{real}}} $$\n代入我们找到的 $\\lambda_{\\mathrm{real}}$ 和 $\\lambda_{\\mathrm{int}}$ 的表达式：\n$$ \\Delta = \\frac{\\left|\\frac{\\ln(3)}{2} - \\frac{\\ln(3)}{1.64}\\right|}{\\frac{\\ln(3)}{1.64}} $$\n由于 $\\ln(3) > 0$，我们可以将其从分子中提出来，并与分母约掉：\n$$ \\Delta = \\frac{\\ln(3) \\left|\\frac{1}{2} - \\frac{1}{1.64}\\right|}{\\ln(3) \\left(\\frac{1}{1.64}\\right)} = 1.64 \\cdot \\left|\\frac{1}{2} - \\frac{1}{1.64}\\right| $$\n由于 $1.64  2$，我们有 $\\frac{1}{2}  \\frac{1}{1.64}$。因此，在将绝对值内的项重新排序后，其值为正，故可以去掉绝对值符号：\n$$ \\Delta = 1.64 \\cdot \\left(\\frac{1}{1.64} - \\frac{1}{2}\\right) $$\n使用分配律展开 $1.64$：\n$$ \\Delta = 1.64 \\cdot \\frac{1}{1.64} - 1.64 \\cdot \\frac{1}{2} = 1 - \\frac{1.64}{2} = 1 - 0.82 $$\n$$ \\Delta = 0.18 $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\Delta = 0.1800 $$", "answer": "$$\n\\boxed{0.1800}\n$$", "id": "4591501"}]}