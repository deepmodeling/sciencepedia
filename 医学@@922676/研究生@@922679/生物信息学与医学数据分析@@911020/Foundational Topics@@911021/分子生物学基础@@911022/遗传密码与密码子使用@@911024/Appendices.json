{"hands_on_practices": [{"introduction": "“标准”遗传密码是分子生物学的基石，但它并非真正通用。本练习通过比较两种不同系统中的翻译过程——标准核基因密码和脊椎动物线粒体密码——来探讨这一关键例外。\n\n通过解决这个问题，学生将能更深刻地体会遗传密码的进化多样性，并理解特定情境下的规则（例如不同的起始密码子）如何能从同一段 $mRNA$ 序列中产生截然不同的蛋白质产物。这项练习能够提升对细节的关注度，并强化“生物学‘规则’常有重要例外”这一概念。", "problem": "一个序列为 $5'$-AUAUGAUGCU-$3'$ 的mRNA（信使核糖核酸）片段将使用两种不同的遗传密码进行翻译：用于人类胞质翻译的标准核遗传密码和脊椎动物线粒体遗传密码。请使用以下基本原则和假设作为您推理的基础：\n\n1. 中心法则：翻译从 $5'$ 端到 $3'$ 端进行，使用非重叠的三联体密码子从mRNA模板合成多肽。\n2. 起始规则（核环境）：真核细胞胞质起始遵循扫描模型，选择第一个AUG三联体（$5'$-AUG-$3'$）作为起始密码子；不假设非AUG起始。\n3. 起始规则（脊椎动物线粒体）：脊椎动物线粒体起始可以使用 $5'$-AUG-$3'$ 或 $5'$-AUA-$3'$ 作为起始密码子；假设从 $5'$ 端遇到的第一个此类三联体用于起始翻译。\n4. 阅读框：一旦起始发生，密码子在该阅读框内被连续读取，直到遇到终止密码子或mRNA结束；$3'$ 端的末尾不完整密码子不被翻译。\n5. 标准核遗传密码：$5'$-AUG-$3'$ 编码甲硫氨酸，$5'$-UGA-$3'$ 是一个终止（停止）密码子，而 $5'$-AUA-$3'$ 编码异亮氨酸。\n6. 此处相关的脊椎动物线粒体遗传密码差异：$5'$-AUA-$3'$ 编码甲硫氨酸（并可作为起始密码子），$5'$-UGA-$3'$ 编码色氨酸，而 $5'$-AUG-$3'$ 仍然编码甲硫氨酸。所有其他未明确重新分配的密码子遵循其标准含义。\n\n任务：\n- 确定在标准核遗传密码下，应用所述的起始规则和阅读框推进，从给定mRNA翻译出的多肽。\n- 确定在脊椎动物线粒体遗传密码下，应用所述的起始规则和阅读框推进，从相同mRNA翻译出的多肽。\n- 根据密码子重分配和起始规则解释两种多肽为何不同，明确指出序列中脊椎动物线粒体密码与标准核密码含义不同的每个密码子。\n- 最后，计算两个所得多肽序列之间的 Levenshtein 编辑距离 $D$，其中 Levenshtein 距离是将一个多肽转换为另一个所需的最少单残基插入、删除或替换次数。\n\n提供 $D$ 作为您的最终答案。不需要四舍五入。将最终答案表示为一个无单位的实数。", "solution": "我们从中心法则的原则开始，即翻译在指定的阅读框内，从 $5'$ 端以非重叠的三联体方式读取mRNA。阅读框由起始密码子的位置决定，该位置根据适合该翻译系统的起始模型确定。\n\n设mRNA序列为 $5'$-AUAUGAUGCU-$3'$。从 $5'$ 端开始将核苷酸索引为位置 $1$ 到 $10$，这样位置是：\n- $1$: A\n- $2$: U\n- $3$: A\n- $4$: U\n- $5$: G\n- $6$: A\n- $7$: U\n- $8$: G\n- $9$: C\n- $10$: U\n\n我们根据规则扫描候选的起始三联体。\n\n标准核遗传密码（真核细胞胞质起始）：\n- 假设：起始需要 $5'$-AUG-$3'$，并使用从 $5'$ 端开始的第一个AUG（扫描模型）。\n- 检查从每个位置开始的三联体是否为AUG：\n  - 位置 $(1,2,3)$ 构成 AUA（不是AUG）。\n  - 位置 $(2,3,4)$ 构成 UAU（不是AUG）。\n  - 位置 $(3,4,5)$ 构成 AUG（这是AUG）。\n因此，第一个AUG位于位置 $(3,4,5)$，所以起始发生在位置 $3$，将阅读框设置为密码子边界 $(3,4,5)$、$(6,7,8)$、$(9,10,11)$。\n- 在此阅读框中翻译密码子：\n  - $(3,4,5)$: AUG 编码甲硫氨酸 (Met)。\n  - $(6,7,8)$: AUG 编码甲硫氨酸 (Met)。\n  - $(9,10)$: 这是一个不完整的密码子，不被翻译。\n- 在结束前没有遇到终止密码子；翻译在mRNA末端终止，得到多肽序列：Met–Met。\n\n因此，在标准核遗传密码和指定的起始规则下，多肽是 Met–Met。\n\n脊椎动物线粒体遗传密码：\n- 假设：起始可以发生在从 $5'$ 端遇到的第一个AUG或AUA处；第一个出现的此类密码子用于起始翻译。\n- 从 $5'$ 端开始检查：\n  - 位置 $(1,2,3)$ 构成 AUA，这在脊椎动物线粒体中是一个有效的起始密码子，并且当用作起始时编码甲硫氨酸。\n因此，起始发生在位置 $1$，将阅读框设置为密码子边界 $(1,2,3)$、$(4,5,6)$、$(7,8,9)$。\n- 在此阅读框中根据脊椎动物线粒体密码分配规则翻译密码子：\n  - $(1,2,3)$: 在脊椎动物线粒体中，AUA 编码甲硫氨酸 (Met)。\n  - $(4,5,6)$: 在脊椎动物线粒体中，UGA 编码色氨酸 (Trp)（注意：在标准密码中，UGA是终止密码子）。\n  - $(7,8,9)$: UGC 编码半胱氨酸 (Cys)；相对于标准密码，此密码子没有被重新分配。\n  - $(10)$: 不完整；不被翻译。\n- 所得的多肽是 Met–Trp–Cys。\n\n因此，在脊椎动物线粒体遗传密码和指定的起始规则下，多肽是 Met–Trp–Cys。\n\n关于重分配密码子和起始差异的解释：\n- 起始规则差异：\n  - 标准核环境：起始需要AUG；第一个AUG出现在位置 $(3,4,5)$，所以翻译从AUG开始，产生 Met–Met。\n  - 脊椎动物线粒体环境：起始允许AUA和AUG；遇到的第一个起始子是位于位置 $(1,2,3)$ 的AUA，所以翻译开始得更早并产生更长的多肽。\n- 在此序列中遇到的密码子重分配差异：\n  - 位置 $(1,2,3)$ 的AUA：\n    - 标准核密码含义：异亮氨酸 (Ile)；然而，在此处的核扫描模型中，它不起始翻译，因此对多肽没有贡献。\n    - 脊椎动物线粒体密码含义：甲硫氨酸 (Met) 并可作为起始密码子；在这里它起始翻译并贡献了Met。\n  - 位置 $(4,5,6)$ 的UGA：\n    - 标准核密码含义：终止密码子；如果翻译在一个假设的阅读框中从位置1开始，它将在这里终止，但在指定的核起始模型下，翻译不会在位置3之前开始，因此UGA不会在阅读框内被遇到。\n    - 脊椎动物线粒体密码含义：色氨酸 (Trp)，它贡献一个残基而不是终止翻译。\n  - 位置 $(7,8,9)$ 的UGC没有被重新分配，在两种密码下都编码半胱氨酸 (Cys)，但它仅相对于在位置1的线粒体起始而言是框内的。在位置3的核起始下，框内的密码子在位置 $(6,7,8)$ 是AUG，而不是UGC。\n\nLevenshtein 编辑距离的计算：\n- 设核多肽为 $P_{\\mathrm{nuc}} = \\text{Met–Met}$，脊椎动物线粒体多肽为 $P_{\\mathrm{mt}} = \\text{Met–Trp–Cys}$。\n- Levenshtein 距离 $D(P_{\\mathrm{nuc}}, P_{\\mathrm{mt}})$ 被定义为将一个多肽转换为另一个所需的最少单残基插入、删除或替换次数。\n- 一个将 Met–Met 转换为 Met–Trp–Cys 的最优编辑序列是：\n  - 将第二个残基Met替换为Trp：1次替换。\n  - 在末尾插入Cys：1次插入。\n- 这总共产生2次编辑。不可能做得更好，因为第一个残基匹配，长度差异为1，这至少需要一次插入或删除，并且如果我们避免第二次插入加一次删除，剩余的不匹配至少需要一次替换。\n因此，Levenshtein距离为 $D = 2$。\n\n因此，所要求的数值为 $2$。", "answer": "$$\\boxed{2}$$", "id": "4568314"}, {"introduction": "虽然遗传密码具有简并性，但生物体通常对特定的同义密码子表现出明显的偏好。为了研究这一现象，我们需要定量的度量标准。本练习将介绍相对同义密码子使用度（Relative Synonymous Codon Usage, RSCU），这是一个用于标准化密码子计数并揭示潜在偏好的基础工具。\n\n该练习提供了从原始数据计算 RSCU 的实践经验，并利用它来评估特定的进化压力，例如对富含 $GC$ 的密码子的偏好。它将学生从简单的观察引向定量分析，这是生物信息学的一项核心技能。", "problem": "从一份人类肿瘤活检样本中，对一个单一蛋白质编码基因的丙氨酸家族密码子使用情况进行了分析。在标准遗传密码中，丙氨酸由四个同义密码子 GCU、GCC、GCA 和 GCG 编码。在该基因中，观察到的丙氨酸同义密码子计数如下：GCU: $30$, GCC: $50$, GCA: $10$, GCG: $10$。根据分子生物学的中心法则和相对同义密码子使用度（RSCU）的规范定义——该定义比较了在同义密码子均等使用的零假设下观察到的计数值与期望计数值——请按以下步骤进行。首先，计算四个丙氨酸密码子的 RSCU 值。其次，定义一个汇总统计量 $S$，其值为以鸟嘌呤或胞嘧啶结尾的密码子（GCC 和 GCG）的平均 RSCU 与以腺嘌呤或尿嘧啶结尾的密码子（GCA 和 GCU）的平均 RSCU 之比的以 2 为底的对数，即：\n$$\nS \\equiv \\log_{2}\\!\\left(\\frac{\\text{mean RSCU of GCC and GCG}}{\\text{mean RSCU of GCA and GCU}}\\right).\n$$\n报告 $S$ 的值。将您的答案四舍五入至 $4$ 位有效数字。将您的答案表示为一个无单位的无量纲标量。在最终报告的值中，不要包含任何定性解释。", "solution": "该问题要求基于氨基酸丙氨酸的相对同义密码子使用度（RSCU），计算一个汇总统计量 $S$。分析过程分三个阶段：首先，计算丙氨酸的四个同义密码子中每一个的 RSCU 值；其次，计算两个已定义的密码子组的平均 RSCU 值；第三，根据这些平均值的比率计算统计量 $S$。\n\n在一个包含 $k$ 个同义密码子的家族中，特定密码子 $i$ 的 RSCU 定义为其观察频率与假设所有同义密码子均等使用时的期望频率之比。其公式为：\n$$\nRSCU_i = \\frac{X_i}{\\frac{1}{k} \\sum_{j=1}^{k} X_j} = \\frac{k \\cdot X_i}{\\sum_{j=1}^{k} X_j}\n$$\n其中 $X_i$ 是密码子 $i$ 出现的次数。\n\n此问题的已知条件是编码丙氨酸（Ala）的四个同义密码子的观察计数：GCU、GCC、GCA 和 GCG。\n丙氨酸的同义密码子数量为 $k=4$。\n观察到的计数是：\n-   $N_{GCU} = 30$\n-   $N_{GCC} = 50$\n-   $N_{GCA} = 10$\n-   $N_{GCG} = 10$\n\n首先，我们计算观察到的丙氨酸密码子总数：\n$$\nN_{total} = \\sum_{j=1}^{4} N_j = N_{GCU} + N_{GCC} + N_{GCA} + N_{GCG} = 30 + 50 + 10 + 10 = 100\n$$\n\n在均等使用的零假设下，每个密码子的期望计数是：\n$$\nN_{expected} = \\frac{N_{total}}{k} = \\frac{100}{4} = 25\n$$\n\n现在，我们计算每个密码子的 RSCU 值：\n$$\nRSCU_{GCU} = \\frac{N_{GCU}}{N_{expected}} = \\frac{30}{25} = 1.2\n$$\n$$\nRSCU_{GCC} = \\frac{N_{GCC}}{N_{expected}} = \\frac{50}{25} = 2.0\n$$\n$$\nRSCU_{GCA} = \\frac{N_{GCA}}{N_{expected}} = \\frac{10}{25} = 0.4\n$$\n$$\nRSCU_{GCG} = \\frac{N_{GCG}}{N_{expected}} = \\frac{10}{25} = 0.4\n$$\n一个强制性检查是，一种氨基酸的 RSCU 值之和必须等于其同义密码子的数量 $k$。\n$$\n\\sum_{j=1}^{4} RSCU_j = 1.2 + 2.0 + 0.4 + 0.4 = 4.0\n$$\n此和等于 $k=4$，证实了 RSCU 计算的正确性。\n\n接下来，我们计算两个指定密码子组的平均 RSCU。\n第一组由以鸟嘌呤或胞嘧啶结尾的密码子组成：GCC 和 GCG。\n该组的平均 RSCU 为：\n$$\n\\text{mean RSCU}_{(\\text{GCC, GCG})} = \\frac{RSCU_{GCC} + RSCU_{GCG}}{2} = \\frac{2.0 + 0.4}{2} = \\frac{2.4}{2} = 1.2\n$$\n第二组由以腺嘌呤或尿嘧啶结尾的密码子组成：GCA 和 GCU。\n该组的平均 RSCU 为：\n$$\n\\text{mean RSCU}_{(\\text{GCA, GCU})} = \\frac{RSCU_{GCA} + RSCU_{GCU}}{2} = \\frac{0.4 + 1.2}{2} = \\frac{1.6}{2} = 0.8\n$$\n\n最后，我们根据其定义计算汇总统计量 $S$：\n$$\nS \\equiv \\log_{2}\\!\\left(\\frac{\\text{mean RSCU of GCC and GCG}}{\\text{mean RSCU of GCA and GCU}}\\right)\n$$\n代入计算出的平均值：\n$$\nS = \\log_{2}\\!\\left(\\frac{1.2}{0.8}\\right) = \\log_{2}(1.5)\n$$\n为了计算这个值，我们使用对数的换底公式，$\\log_{b}(x) = \\frac{\\ln(x)}{\\ln(b)}$：\n$$\nS = \\frac{\\ln(1.5)}{\\ln(2)}\n$$\n使用自然对数的标准值：\n$$\n\\ln(1.5) \\approx 0.4054651\n$$\n$$\n\\ln(2) \\approx 0.6931472\n$$\n$$\nS \\approx \\frac{0.4054651}{0.6931472} \\approx 0.5849625\n$$\n问题要求将答案四舍五入到 $4$ 位有效数字。第五位有效数字是 $6$，所以我们将第四位有效数字（$9$）向上舍入。这导致了进位。\n$$\nS \\approx 0.5850\n$$\n末尾的零是有效数字，必须包含以表明所需的精度。", "answer": "$$\\boxed{0.5850}$$", "id": "4568298"}, {"introduction": "理解密码子使用偏好不仅仅是一项学术活动；它在合成生物学和生物技术领域有着强大的实际应用。这个问题模拟了一项真实的基因优化任务：设计一个编码序列，以在特定宿主生物中最大化蛋白质的表达量。\n\n这项高级练习挑战学生将密码子偏好、翻译效率和序列约束等概念整合到一个正式的优化框架中。解决此问题需要计算思维，并展示了如何利用基本的生物学原理进行生物工程设计。", "problem": "给定一个针对固定氨基酸序列、在宿主特异性翻译偏好下的同义密码子选择的形式化模型。分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）意味着，由于遗传密码的简并性，一个蛋白质的一级序列（氨基酸）可以由多个核苷酸序列编码。在一个简单的翻译延伸动力学近似中，每个密码子特异性的延伸步骤被视为一个独立事件，其预期停留时间与该密码子的有效延伸速率成反比。对于一个宿主偏好权重为 $w$、同源转移核糖核酸（tRNA）丰度为 $a$ 的密码子，其有效延伸速率为 $r = w \\cdot a$，预期停留时间为 $t = 1 / r$。对于一个长度为 $n$ 个密码子的编码序列，在位置 $i \\in \\{1,\\dots,n\\}$ 选择了密码子 $c_i$，则总预期延伸时间为\n$$\nT = \\sum_{i=1}^{n} \\frac{1}{w(c_i)\\, a(c_i)}.\n$$\n目标是在编码给定氨基酸序列的所有同义密码子选择中最小化 $T$，同时满足两个全局序列级别的约束：\n- 鸟嘌呤-胞嘧啶（GC）含量分数约束：整个编码序列中 G 或 C 核苷酸的比例必须位于指定的闭区间 $[g_{\\min}, g_{\\max}]$ 内。\n- 禁止基序约束：一个指定的核苷酸子串 $M$（基于字母表 $\\{A,C,G,T\\}$）不得作为连接后的核苷酸序列的连续子串出现在任何位置。\n\n假设使用标准遗传密码，将氨基酸映射到其同义密码子，但您只需考虑每个测试用例中明确列出的氨基酸和密码子。对于下方的每个测试用例，您将获得：\n- 一个氨基酸序列（一个基于单字母氨基酸字母表的字符串）。\n- 一个宿主密码子偏好映射 $w(\\text{codon})$，其值在 $(0,1]$ 区间内。\n- 一个 tRNA 丰度映射 $a(\\text{codon})$，其值为正实数。\n- 一个 GC 含量边界 $[g_{\\min}, g_{\\max}]$，其中两个端点都是实数，且 $0 \\le g_{\\min} \\le g_{\\max} \\le 1$。\n- 一个禁止基序 $M$（一个基于 $\\{A,C,G,T\\}$ 的字符串）。\n\n您的程序必须为每个测试用例计算一个最优编码序列，该序列在满足两个约束的同时最小化 $T$。如果存在多个最优序列，任何一个满足约束的序列都是可接受的。\n\n精确解释与要求：\n- 设总核苷酸长度为 $L = 3n$，对应一个长度为 $n$ 的肽链。GC 计数约束被强制为对 G 或 C 核苷酸数量的整数界限：该计数必须位于区间 $[\\lceil g_{\\min} \\cdot L \\rceil,\\ \\lfloor g_{\\max} \\cdot L \\rfloor]$ 内。\n- 基序 $M$ 不得作为最终连接的核苷酸序列中的连续子串出现。所有匹配均使用大写字母，区分大小写。\n- 目标值 $T$ 是每个密码子时间 $1/(w \\cdot a)$ 的总和，如上所述。\n\n您对每个测试用例的输出必须是一个三元组，包含：\n- 最小预期总延伸时间 $T^\\star$，作为十进制浮点数，精确到小数点后六位。\n- 实现的 GC 分数，作为十进制浮点数，精确到小数点后四位。\n- 一个布尔值，指示禁止基序是否不存在（对于任何可接受的解决方案，此值必须为 true）。\n\n将所有测试用例的结果汇总到一个单一的扁平列表中，格式完全如下：一行包含一个由方括号括起来、逗号分隔的列表，没有空格，按顺序连接所有测试用例的三元组，例如：\"[t1,gc1,b1,t2,gc2,b2,t3,gc3,b3]\"。输出中不要包含任何单位。\n\n测试套件：\n- 测试用例 1：\n    - 氨基酸序列：\"AKG\"。\n    - 宿主密码子偏好权重 $w(\\cdot)$：\n        - 丙氨酸 (A): GCT:$0.20$, GCC:$0.30$, GCA:$0.25$, GCG:$0.25$.\n        - 赖氨酸 (K): AAA:$0.55$, AAG:$0.45$.\n        - 甘氨酸 (G): GGT:$0.18$, GGC:$0.32$, GGA:$0.20$, GGG:$0.30$.\n    - tRNA 丰度 $a(\\cdot)$：\n        - GCT:$0.90$, GCC:$1.40$, GCA:$1.00$, GCG:$0.80$.\n        - AAA:$1.20$, AAG:$0.70$.\n        - GGT:$1.10$, GGC:$1.50$, GGA:$0.90$, GGG:$1.00$.\n    - GC 边界：$[g_{\\min}, g_{\\max}] = [0.4, 0.7]$。\n    - 禁止基序 $M = \\text{\"CGCG\"}$。\n\n- 测试用例 2：\n    - 氨基酸序列：\"DP\"。\n    - 宿主密码子偏好权重 $w(\\cdot)$：\n        - 天冬氨酸 (D): GAT:$0.60$, GAC:$0.40$.\n        - 脯氨酸 (P): CCT:$0.30$, CCC:$0.20$, CCA:$0.25$, CCG:$0.25$.\n    - tRNA 丰度 $a(\\cdot)$：\n        - GAT:$0.80$, GAC:$1.40$.\n        - CCT:$1.20$, CCC:$1.00$, CCA:$0.90$, CCG:$1.30$.\n    - GC 边界：$[g_{\\min}, g_{\\max}] = [0.66, 1.0]$。\n    - 禁止基序 $M = \\text{\"GATC\"}$。\n\n- 测试用例 3：\n    - 氨基酸序列：\"SRS\"。\n    - 宿主密码子偏好权重 $w(\\cdot)$：\n        - 丝氨酸 (S): TCT:$0.15$, TCC:$0.20$, TCA:$0.15$, TCG:$0.20$, AGT:$0.15$, AGC:$0.15$.\n        - 精氨酸 (R): CGT:$0.18$, CGC:$0.22$, CGA:$0.12$, CGG:$0.22$, AGA:$0.12$, AGG:$0.14$.\n    - tRNA 丰度 $a(\\cdot)$：\n        - 丝氨酸密码子: TCT:$1.00$, TCC:$1.30$, TCA:$0.90$, TCG:$1.20$, AGT:$0.80$, AGC:$1.10$.\n        - 精氨酸密码子: CGT:$1.10$, CGC:$1.30$, CGA:$0.90$, CGG:$1.40$, AGA:$0.85$, AGG:$1.00$.\n    - GC 边界：$[g_{\\min}, g_{\\max}] = [0.5, 0.6]$。\n    - 禁止基序 $M = \\text{\"AGAG\"}$。\n\n科学依据和使用的假设：\n- 中心法则和标准遗传密码是氨基酸到密码子映射的基础。\n- 根据经验，密码子特异性延伸速率与宿主密码子使用/可得性以及同源 tRNA 丰度相关；简化的模型 $r = w \\cdot a$ 是一个广泛使用的一阶近似，用于预期速率的缩放。\n- 在延伸步骤相互独立的假设下，总预期时间是各密码子时间的加和，即 $T = \\sum_i 1/r_i$。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3]\"）。不需要用户输入。所有计算必须是确定性的。将所有实数值输出表示为按规定四舍五入的小数；不要包含任何百分号或物理单位。", "solution": "所提出的问题是一个约束优化任务，是合成生物学领域的典型问题，特别是在设计用于异源表达的合成基因方面。其目标是为给定的氨基酸序列确定一个核苷酸编码序列，该序列能在满足鸟嘌呤-胞嘧啶（GC）含量和禁止出现特定核苷酸基序的约束条件下，最小化总预期翻译延伸时间。这个问题有充分的科学依据，并且可以通过算法解决。\n\n该问题可以建模为在有向无环图（DAG）中寻找最短路径。此图中的节点代表序列合成过程的状态，边代表添加一个新密码子。动态规划是解决此类问题的标准且最有效的方法。\n\n设给定的氨基酸序列为 $A = (A_1, A_2, \\dots, A_n)$，长度为 $n$。对于每个氨基酸 $A_i$，都有一组同义密码子 $C(A_i)$。对于每个密码子 $c$，我们已知其宿主偏好权重 $w(c)$ 和同源 tRNA 丰度 $a(c)$。密码子 $c$ 的时间贡献为 $t(c) = 1 / (w(c) \\cdot a(c))$。我们还定义 $\\text{gc}(c)$ 为密码子 $c$ 中 G 或 C 核苷酸的数量。\n\n为了应用动态规划，我们通过做出未来决策和验证约束所需的信息来定义状态。一个状态必须包含：\n1. 已编码的氨基酸序列中的位置 $i$。\n2. 到目前为止构建的核苷酸序列的累积 GC 计数 $g$。\n3. 已构建核苷酸序列的后缀 $s$。这是检查是否形成禁止基序 $M$ 所必需的。此后缀所需的长度为 $|M|-1$。\n\n设 $DP(i, g, s)$ 为编码目标蛋白质前 $i$ 个氨基酸的核苷酸序列可能达到的最小总延伸时间，该序列总共有 $g$ 个 GC 核苷酸，且其长度为 $\\min(3i, |M|-1)$ 的后缀是字符串 $s$。\n\nDP 状态转移由为下一个氨基酸选择密码子来定义。为了计算第 $i$ 步的值，我们使用从第 $i-1$ 步计算出的值。递推关系如下：\n\n$$\nDP(i, g, s) = \\min_{(g', s', c)} \\{ DP(i-1, g', s') + t(c) \\}\n$$\n\n最小化操作针对所有有效的前驱状态 $(i-1, g', s')$ 以及所有能够转移到状态 $(i, g, s)$ 的同义密码子 $c \\in C(A_i)$。一个转移是有效的，如果：\n1. 新的 GC 计数是正确的：$g = g' + \\text{gc}(c)$。\n2. 将密码子 $c$ 附加到以后缀 $s'$ 结尾的序列不会产生禁止基序 $M$。也就是说，$M$ 不是 $s' + c$ 的子串。\n3. 新的后缀 $s$ 是正确派生的：$s = (s' + c)[-(|M|-1):]$，其中该表示法意为取最后 $|M|-1$ 个字符。\n\n递归的基例是在 $i=0$ 时（编码任何氨基酸之前）：\n$$\nDP(0, 0, \\text{''}) = 0\n$$\n所有其他 $DP(0, g, s)$ 的值都初始化为无穷大，表示它们是不可达的。\n\n该算法通过迭代计算 $i=1, 2, \\dots, n$ 的 DP 表来推进。当 $i=n$ 的表完全填充后，最后一步是找到满足全局 GC 含量约束的总体最小时间。设核苷酸序列的总长度为 $L = 3n$。GC 碱基的数量必须在整数区间 $[G_{\\min}, G_{\\max}]$ 内，其中 $G_{\\min} = \\lceil g_{\\min} \\cdot L \\rceil$ 且 $G_{\\max} = \\lfloor g_{\\max} \\cdot L \\rfloor$。\n\n最小总延伸时间 $T^\\star$ 则由下式给出：\n$$\nT^\\star = \\min_{s, g \\in [G_{\\min}, G_{\\max}]} \\{ DP(n, g, s) \\}\n$$\n最优核苷酸序列本身可以通过在 DP 计算期间存储回溯指针来重构，这些指针记录了导致每个最小状态的密码子选择。\n\n通过系统地探索所有有效的密码子组合及其相关成本，这种动态规划方法保证能找到全局最优解。其复杂度与状态和转移的数量成正比，约为 $O(n \\cdot (3n) \\cdot 4^{|M|-1} \\cdot |C_{\\max}|)$，其中 $|C_{\\max}|$ 是任何氨基酸的最大同义密码子数。考虑到测试用例中的参数较小，该方法在计算上是可行的。", "answer": "[5.979434,0.6667,true,4.563492,0.6667,true,15.563380,0.5556,true]", "id": "2965766"}]}