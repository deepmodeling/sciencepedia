{"hands_on_practices": [{"introduction": "RNA-seq 实验的统计推断能力取决于对生物学变异的准确估计。本练习 [@problem_id:2385533] 提出了一个常见但有缺陷的实验设计——样本混合（pooling），旨在强调为何独立的生物学重复是得出差异基因表达有效结论所不可或缺的。通过这个思想实验，我们将深入辨析生物学差异和技术性差异的根本区别，并理解为何后者无法替代前者。", "problem": "一位研究者希望评估对照组和处理组之间的差异基因表达（Differential Gene Expression, DGE）。他们从 $n_c$ 个对照组捐赠者和 $n_t$ 个处理组捐赠者身上收集组织，提取总核糖核酸（RNA），并创建了两个混合样本池：一个是通过合并所有对照组捐赠者的等量RNA质量而得到的，另一个是通过合并所有处理组捐赠者的等量RNA质量而得到的。他们在不同的日期，从每个混合样本池中构建一个测序文库，并进行高深度RNA测序（RNA-seq），获得了 $G$ 个基因的基因水平计数数据。他们计划通过应用一个标准的DGE分析流程来鉴定差异表达基因，该流程会输出 $p$ 值和错误发现率（False Discovery Rate, FDR）$q$ 值。\n\n以下哪项陈述是对该设计最准确的批评，并附带了恰当的补救措施？\n\nA. 根本缺陷在于缺乏独立的生物学重复，这使得样本间方差无法确定，从而导致差异表达的推断性 $p$ 值无效；文库内的读数（reads）不是独立的实验单位。混合样本也掩盖了捐赠者之间的异质性。恰当的补救措施是每个条件至少包含 $k\\geq 3$ 个独立的生物学重复，并在文库制备批次之间进行随机化和平衡，以便能够估计方差并将批次效应与条件效应分离开来。\n\nB. 如果测序深度极高（例如，每个文库 $\\geq 10^8$ 条读数），该设计是可接受的，因为大数定律确保了每个基因的均值和方差能够以足够的精度进行估计，从而在没有生物学重复的情况下也能进行有效的假设检验。\n\nC. 如果通过对两个相同的混合文库分别在 $r\\geq 3$ 个测序泳道（lane）上进行测序来生成多个技术重复，那么生物学重复就是不必要的；泳道间的变异为条件间的有效差异表达检验提供了所需的方差。\n\nD. 外源spike-in对照可以在没有生物学重复的情况下实现完全的归一化和假设检验；通过适当的spike-in，尽管每个条件只有一个混合样本，也可以为每个基因计算出有效的 $p$ 值。\n\nE. 即使每个条件只有一个混合文库，也可以通过在两个文库之间随机置换读数来为每个基因构建一个经验零分布，从而在没有生物学重复的情况下获得有效的 $p$ 值。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知信息\n- 一位研究者旨在进行对照组和处理组之间的差异基因表达（DGE）分析。\n- 组织样本来自 $n_c$ 个对照组捐赠者和 $n_t$ 个处理组捐赠者。\n- 从所有样本中提取总核糖核酸（RNA）。\n- 创建了两个RNA混合样本池：一个通过合并所有 $n_c$ 个对照组捐赠者的等量RNA质量得到，另一个通过合并所有 $n_t$ 个处理组捐赠者的等量RNA质量得到。\n- 从两个混合样本池中各构建一个测序文库。\n- 两个文库在不同的日期制备。\n- 对两个文库进行高深度RNA测序（RNA-seq）。\n- 获得了 $G$ 个基因的基因水平计数数据。\n- 研究者的计划是使用一个标准的DGE分析流程来鉴定差异表达基因，该流程输出 $p$ 值和错误发现率（FDR）$q$ 值。\n- 问题要求对该实验设计给出最准确的批评以及恰当的补救措施。\n\n步骤2：使用提取的信息进行验证\n该问题描述了一个RNA-seq实验的具体实验设计，并要求基于生物统计学和生物信息学的原理进行批判性评估。\n\n- **科学性：** 问题中提出的概念——DGE、RNA-seq、样本混合、生物学重复、批次效应、$p$ 值和FDR——都是计算生物学和基因组学领域的标准和基础概念。所描述的实验设计虽然存在缺陷，却是研究者可能提出的一个现实情景。该问题基于已确立的科学原理。\n- **问题明确性：** 问题以多项选择题的形式组织，要求从一组选项中找出最准确的批评。这是一种评估对实验设计原则理解的标准且明确的格式。根据该领域的既定最佳实践，预期存在一个唯一的最佳答案。\n- **客观性：** 语言技术性强且精确。诸如“对照条件”、“处理”、“RNA-seq”和“生物学重复”等术语在该科学背景下具有清晰、无歧义的定义。对实验过程的描述是客观的，没有主观性陈述。\n\n问题陈述本身不包含科学谬误；相反，它描述了一个在科学上存在缺陷的实验设计，并要求学生找出这些缺陷。这是一种有效的教学方法。问题是自洽的、一致的，并且与其主题直接相关。它没有违反任何无效标准。\n\n步骤3：结论和行动\n问题陈述有效。我将继续进行完整的推导和分析。\n\n差异基因表达分析的核心任务是检验一个基因的平均表达量在两个或多个群体（例如，对照群体 vs. 处理群体）之间是否存在差异的假设。统计检验需要一个效应量（均值差异）的估计值，以及与该效应量相关的方差或不确定性的估计值。\n\n在生物学实验中，总方差有两个主要组成部分：生物学方差和技术方差。\n1.  **生物学方差** (${\\sigma^2}_{bio}$)：这代表同一群体或条件内不同个体之间基因表达水平的真实、自然的变异。在本问题中，它指的是捐赠者之间的变异性。对群体进行推断需要量化这种方差。\n2.  **技术方差** (${\\sigma^2}_{tech}$)：这是在实验测量过程中引入的变异，包括RNA提取、文库制备和测序。对于像RNA-seq这样的计数数据，技术噪音的一个主要组成部分是泊松散粒噪声。\n\n所提议的实验设计的根本缺陷是完全没有**独立的生物学重复**。通过将来自 $n_c$ 个对照组捐赠者的所有RNA混合成一个样本，并将来自 $n_t$ 个处理组捐赠者的所有RNA混合成另一个样本，研究者最终得到的有效样本量是：对照组 $n=1$，处理组 $n=1$。\n\n当每组样本量为 $n=1$ 时，从数学上讲，无法估计生物学方差（${\\sigma^2}_{bio}$）。两个混合文库之间观察到的任何基因表达差异都存在无法解决的混淆。这种差异可能源于：\n- 处理带来的真实生物学效应。\n- 随机因素，即特定的 $n_c$ 个捐赠者群体恰好平均表达水平与特定的 $n_t$ 个捐赠者群体不同，即使没有任何处理。\n- 一种系统性的技术人为因素，即**批次效应**，因为两个文库是在不同的日期制备的。制备日期与条件（对照 vs. 处理）完全混淆。\n\n从单个文库测序获得的读数是**技术重复**，而不是生物学重复。增加测序深度可以更精确地测量*那个特定RNA混合池中*的平均表达水平，从而减少由技术（抽样）方差引起的不确定性。然而，它完全无法提供关于捐赠者来源群体的生物学方差的任何信息。DGE的推断统计学关注的是观察到的效应相对于群体中的生物学变异是否足够大，而不是测量单个样本时的技术变异。像DESeq2或edgeR这样的标准DGE软件包是专门设计用来利用生物学重复的数据来模拟生物学方差的。没有生物学重复，这些模型就无法正确拟合，最终得到的 $p$ 值也是无效的。\n\n恰当的补救措施必须纠正这些缺陷。它需要：\n1.  为每个条件的多个个体创建独立的文库。这构成了真正的生物学重复，并允许估计生物学方差。每个条件至少 $k=3$ 个重复是获得合理统计功效和稳健方差估计的公认标准。\n2.  解决批次效应问题。实验单元（来自对照组和处理组的文库）必须在不同批次（例如，文库制备的不同日期）之间以随机化和平衡的方式进行处理，以确保任何与批次相关的技术变异不会与感兴趣的生物学信号相混淆。\n\n现在，我将评估每个选项。\n\n**A. 根本缺陷在于缺乏独立的生物学重复，这使得样本间方差无法确定，从而导致差异表达的推断性 $p$ 值无效；文库内的读数（reads）不是独立的实验单位。混合样本也掩盖了捐赠者之间的异质性。恰当的补救措施是每个条件至少包含 $k\\geq 3$ 个独立的生物学重复，并在文库制备批次之间进行随机化和平衡，以便能够估计方差并将批次效应与条件效应分离开来。**\n该陈述是一个精确而全面的批评。它正确地指出了缺乏生物学重复是核心问题，解释了其后果（无法确定生物学方差和无效的 $p$ 值），正确地区分了技术单位和生物学单位，并指出了混合样本导致的信息丢失。提出的补救措施——每个条件使用至少3个生物学重复，并采用随机化、平衡的设计来减轻批次效应——是现代基因组学中的标准和正确解决方案。原始设计存在批次效应（不同的日期），该补救措施也明确解决了这个问题。\n结论：**正确**。\n\n**B. 如果测序深度极高（例如，每个文库 $\\geq 10^8$ 条读数），该设计是可接受的，因为大数定律确保了每个基因的均值和方差能够以足够的精度进行估计，从而在没有生物学重复的情况下也能进行有效的假设检验。**\n这是不正确的。高测序深度只减少技术方差，为特定的混合样本提供了非常精确的测量。它不能也无法提供关于捐赠者群体内生物学方差的信息。大数定律适用于从文库中对RNA分子的技术抽样，而不是从群体中对受试者的生物学抽样。假设检验是关于群体的，因此需要对群体方差进行估计，这必须要有生物学重复。\n结论：**不正确**。\n\n**C. 如果通过对两个相同的混合文库分别在 $r\\geq 3$ 个测序泳道（lane）上进行测序来生成多个技术重复，那么生物学重复就是不必要的；泳道间的变异为条件间的有效差异表达检验提供了所需的方差。**\n这是不正确的。技术重复（例如，同一文库的多个测序泳道）只允许估计技术方差。在假设检验中用技术方差代替生物学方差是一个严重的统计错误。生物学方差几乎总是显著大于技术方差。这样做会导致检验统计量的分母极小，从而导致假阳性的大量增加。人们会检测到成千上万个“显著”的基因，而这些基因仅仅反映了两个特定混合池之间的微小随机波动，并非可推广到群体的真实生物学效应。\n结论：**不正确**。\n\n**D. 外源spike-in对照可以在没有生物学重复的情况下实现完全的归一化和假设检验；通过适当的spike-in，尽管每个条件只有一个混合样本，也可以为每个基因计算出有效的 $p$ 值。**\n这是不正确的。Spike-in对照是添加到每个样本中已知浓度的外源RNA分子。它们的主要用途是技术归一化和评估技术性能。它们可以帮助估计技术方差和模拟技术偏差。然而，由于它们不受生物体内的生物学调控，因此它们完全不提供任何关于感兴趣的内源基因的生物学方差的信息。因此，它们不能在DGE分析中替代生物学重复。\n结论：**不正确**。\n\n**E. 即使每个条件只有一个混合文库，也可以通过在两个文库之间随机置换读数来为每个基因构建一个经验零分布，从而在没有生物学重复的情况下获得有效的 $p$ 值。**\n这是不正确的。置换检验依赖于零假设下样本标签的可交换性。可交换的单元是独立的生物学重复。在这里，每个条件只有一个单元（混合文库）。没有任何东西可以置换。在文库之间随机置换单个读数不是一个有效的统计程序。一个文库内的读数不是独立的；它们的计数是相关的，并取决于该特定文库的组成。置换它们会破坏数据的结构，并且不会生成一个有效的检验统计量零分布。\n结论：**不正确**。\n\n总之，选项A是唯一一个正确诊断了实验设计的关键缺陷，并提出了正确、标准补救措施的选项。", "answer": "$$\\boxed{A}$$", "id": "2385533"}, {"introduction": "在理解了重复实验的必要性之后，下一个关键问题是“需要多少个重复？”。本练习 [@problem_id:4605882] 将我们从定性原则引向定量设计，要求从第一性原理出发，推导出一个样本量计算公式。这个练习将揭示功效分析的内在逻辑，展示它如何将我们期望的统计功效、效应大小、生物学变异（离散度 $\\phi$）以及测序深度联系起来。", "problem": "一个研究团队正在计划一项双组核糖核酸测序（RNA-seq）实验，以检测单个基因在对照组和处理组之间的差异表达效应。他们将使用一个带有对数连接函数和文库大小偏移量的负二项广义线性模型（GLM）。每个样本具有相同的文库大小 $L$（以reads为单位）。设对照组的基线单位read表达率为 $\\mu$，因此对照组中该基因的期望计数为 $L \\mu$。处理效应由log倍数变化 $\\delta$ 参数化，因此处理组中的期望计数为 $L \\mu \\exp(\\delta)$。负二项模型的离散参数为 $\\phi$，且给定均值 $m$ 的计数 $Y$ 的方差假定遵循经过充分检验的形式 $\\operatorname{Var}(Y \\mid m) = m \\left(1 + \\phi m\\right)$。假定样本独立且 $\\phi$ 已知。\n\nGLM指定为 $\\ln(m_i) = \\ln(L) + \\beta_0 + \\beta_1 x_i$，其中 $x_i \\in \\{0,1\\}$ 表示处理组成员身份，我们感兴趣的参数是 $\\beta_1 = \\delta$。该团队将对 $\\beta_1$ 进行Wald检验，双侧显著性水平为 $\\alpha$，并期望有 $1 - \\beta$ 的统计功效来检测真实的log倍数变化 $\\delta$。\n\n从负二项方差和带对数连接的GLM的定义出发，并利用迭代重加权最小二乘法下 $\\beta_1$ 的大样本费雪信息，推导出一个近似的闭式表达式，用于计算为达到指定的显著性水平和功效以检测 $\\delta$ 所需的最小每组样本量 $n$（两组相等）。将您的最终答案表示为关于 $\\mu$、$\\phi$、$L$、$\\delta$、$\\alpha$ 和 $\\beta$ 的单个解析表达式。您可以使用标准正态分位数 $z_{1-\\alpha/2}$ 和 $z_{1-\\beta}$，其中 $z_{p}$ 表示标准正态分布的第 $p$ 个分位数。\n\n无需进行数值计算。仅提供 $n$ 的表达式；不要包含任何单位。", "solution": "问题要求为一个双组RNA测序实验推导最小每组样本量 $n$ 的闭式表达式。该分析基于负二项广义线性模型（GLM）和对log倍数变化参数的Wald检验。\n\n使用双侧Wald检验，在显著性水平 $\\alpha$ 下检测到真实效应 $\\delta$ 的统计功效 $1-\\beta$ 由效应大小、其估计量的标准误以及标准正态分布的分位数之间的关系确定。我们感兴趣的参数 $\\beta_1$（即log倍数变化 $\\delta$）的Wald检验统计量是 $Z = \\hat{\\beta_1} / \\text{se}(\\hat{\\beta_1})$。对于大样本，$\\hat{\\beta_1}$ 近似服从均值为 $\\delta$、方差为 $\\operatorname{Var}(\\hat{\\beta_1})$ 的正态分布。达到期望功效的条件由下式给出：\n$$ \\frac{|\\delta|}{\\sqrt{\\operatorname{Var}(\\hat{\\beta_1})}} \\ge z_{1-\\alpha/2} + z_{1-\\beta} $$\n两边平方并假设真实效应为 $\\delta$，我们得到：\n$$ \\frac{\\delta^2}{\\operatorname{Var}(\\hat{\\beta_1})} \\ge \\left(z_{1-\\alpha/2} + z_{1-\\beta}\\right)^2 $$\n为了求出样本量 $n$，我们首先需要确定 $\\operatorname{Var}(\\hat{\\beta_1})$ 的表达式。在GLM的背景下，参数估计 $\\hat{\\boldsymbol{\\beta}}$ 的渐近方差-协方差矩阵是费雪信息矩阵的逆，即 $I(\\boldsymbol{\\beta})^{-1}$。对于 $N$ 个独立观测值，费雪信息为 $I(\\boldsymbol{\\beta}) = X^T W X$，其中 $X$ 是设计矩阵，$W$ 是一个对角权重矩阵。\n\n对于一个GLM，第 $i$ 个观测值的权重由下式给出：\n$$ w_i = \\frac{1}{\\operatorname{Var}(Y_i) (g'(m_i))^2} $$\n其中 $Y_i$ 是计数，$m_i$ 是其期望值，$g(m_i)$ 是连接函数。\n问题指定方差函数为 $\\operatorname{Var}(Y_i \\mid m_i) = m_i(1 + \\phi m_i)$，连接函数为对数，$g(m_i) = \\ln(m_i)$。连接函数的导数是 $g'(m_i) = 1/m_i$。将这些代入权重公式：\n$$ w_i = \\frac{m_i^2}{m_i(1 + \\phi m_i)} = \\frac{m_i}{1 + \\phi m_i} $$\n我们有两个组：对照组（$x=0$）和处理组（$x=1$），每组有 $n$ 个样本。\n对于对照组，平均计数为 $m_C = L\\mu$。相应的权重是：\n$$ w_C = \\frac{m_C}{1 + \\phi m_C} = \\frac{L\\mu}{1 + \\phi L\\mu} $$\n对于处理组，平均计数为 $m_T = L\\mu \\exp(\\delta)$。相应的权重是：\n$$ w_T = \\frac{m_T}{1 + \\phi m_T} = \\frac{L\\mu \\exp(\\delta)}{1 + \\phi L\\mu \\exp(\\delta)} $$\nGLM是 $\\ln(m_i) = \\ln(L) + \\beta_0 + \\beta_1 x_i$。参数向量是 $\\boldsymbol{\\beta} = (\\beta_0, \\beta_1)^T$。总共 $2n$ 个样本的设计矩阵 $X$ 是：\n$$ X = \\begin{pmatrix} 1  0 \\\\ \\vdots  \\vdots \\\\ 1  0 \\\\ 1  1 \\\\ \\vdots  \\vdots \\\\ 1  1 \\end{pmatrix} $$\n其中前 $n$ 行对应对照组，后 $n$ 行对应处理组。权重矩阵 $W$ 是一个 $2n \\times 2n$ 的对角矩阵，其对角线上先是 $n$ 个 $w_C$，然后是 $n$ 个 $w_T$。\n\n费雪信息矩阵是 $I(\\boldsymbol{\\beta}) = X^T W X$。\n$$ I(\\boldsymbol{\\beta}) = \\begin{pmatrix} 1  \\dots  1  1  \\dots  1 \\\\ 0  \\dots  0  1  \\dots  1 \\end{pmatrix} \\begin{pmatrix} w_C   \\\\  \\ddots  \\\\   w_T  \\\\    \\ddots \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ \\vdots  \\vdots \\\\ 1  0 \\\\ 1  1 \\\\ \\vdots  \\vdots \\\\ 1  1 \\end{pmatrix} $$\n计算这个乘积得到：\n$$ I(\\boldsymbol{\\beta}) = \\begin{pmatrix} \\sum_{i=1}^{2n} w_i  \\sum_{i=1}^{2n} w_i x_i \\\\ \\sum_{i=1}^{2n} w_i x_i  \\sum_{i=1}^{2n} w_i x_i^2 \\end{pmatrix} = \\begin{pmatrix} n w_C + n w_T  n w_T \\\\ n w_T  n w_T \\end{pmatrix} = n \\begin{pmatrix} w_C + w_T  w_T \\\\ w_T  w_T \\end{pmatrix} $$\n渐近方差-协方差矩阵是 $I(\\boldsymbol{\\beta})$ 的逆：\n$$ \\operatorname{Var}(\\hat{\\boldsymbol{\\beta}}) = I(\\boldsymbol{\\beta})^{-1} = \\frac{1}{n^2 \\det \\begin{pmatrix} w_C + w_T  w_T \\\\ w_T  w_T \\end{pmatrix}} n \\begin{pmatrix} w_T  -w_T \\\\ -w_T  w_C + w_T \\end{pmatrix} $$\n行列式为 $n^2((w_C+w_T)w_T - w_T^2) = n^2 w_C w_T$。\n$$ \\operatorname{Var}(\\hat{\\boldsymbol{\\beta}}) = \\frac{1}{n w_C w_T} \\begin{pmatrix} w_T  -w_T \\\\ -w_T  w_C + w_T \\end{pmatrix} $$\n估计量 $\\hat{\\beta_1}$ 的方差是该矩阵的第 $(2,2)$ 个元素：\n$$ \\operatorname{Var}(\\hat{\\beta_1}) = \\frac{w_C + w_T}{n w_C w_T} = \\frac{1}{n} \\left(\\frac{1}{w_C} + \\frac{1}{w_T}\\right) $$\n现在我们回到功效方程并求解 $n$：\n$$ n = \\frac{(z_{1-\\alpha/2} + z_{1-\\beta})^2}{\\delta^2} \\left(\\frac{1}{w_C} + \\frac{1}{w_T}\\right) $$\n最后一步是代入 $w_C$ 和 $w_T$ 的表达式。\n$$ \\frac{1}{w_C} = \\frac{1 + \\phi L\\mu}{L\\mu} = \\frac{1}{L\\mu} + \\phi $$\n$$ \\frac{1}{w_T} = \\frac{1 + \\phi L\\mu \\exp(\\delta)}{L\\mu \\exp(\\delta)} = \\frac{1}{L\\mu \\exp(\\delta)} + \\phi $$\n将这两项相加：\n$$ \\frac{1}{w_C} + \\frac{1}{w_T} = \\left(\\frac{1}{L\\mu} + \\phi\\right) + \\left(\\frac{1}{L\\mu \\exp(\\delta)} + \\phi\\right) = \\frac{1}{L\\mu} + \\frac{1}{L\\mu \\exp(\\delta)} + 2\\phi $$\n这可以写成：\n$$ \\frac{1}{w_C} + \\frac{1}{w_T} = \\frac{1 + \\exp(-\\delta)}{L\\mu} + 2\\phi $$\n将此代回 $n$ 的表达式，得到所需每组样本量的最终公式：\n$$ n = \\frac{\\left(z_{1-\\alpha/2} + z_{1-\\beta}\\right)^2}{\\delta^2} \\left( \\frac{1}{L\\mu} + \\frac{1}{L\\mu \\exp(\\delta)} + 2\\phi \\right) $$\n或者，以一个更紧凑的形式：\n$$ n = \\frac{\\left(z_{1-\\alpha/2} + z_{1-\\beta}\\right)^2}{\\delta^2} \\left( \\frac{1 + \\exp(-\\delta)}{L\\mu} + 2\\phi \\right) $$\n该表达式提供了在双侧显著性水平为 $\\alpha$ 时，以功效 $1-\\beta$ 检测出log倍数变化 $\\delta$ 所需的两个组（对照组和处理组）中每组的近似样本量 $n$。", "answer": "$$\\boxed{\\frac{\\left(z_{1-\\alpha/2} + z_{1-\\beta}\\right)^2}{\\delta^2} \\left( \\frac{1}{L\\mu} + \\frac{1}{L\\mu \\exp(\\delta)} + 2\\phi \\right)}$$", "id": "4605882"}, {"introduction": "完美的实验在现实中是罕见的，数据质量控制是确保分析有效性的关键一步。本练习 [@problem_id:4605754] 提供了一个真实的案例：在一系列质量控制（QC）指标的支持下，一个样本表现为明显的异常值。通过这个练习，我们将锻炼数据驱动的决策能力，学习如何权衡证据以区分极端生物学现象与技术性失败，并决定最科学严谨的处理方法。", "problem": "一项信使核糖核酸测序（RNA-seq）研究旨在评估疾病状况和对照组之间的基因表达差异。研究共有 $n=12$ 个文库：$6$ 个疾病样本和 $6$ 个对照样本。文库制备分两个批次 $\\mathcal{B}_1$ 和 $\\mathcal{B}_2$ 进行，每个批次包含 $3$ 个疾病样本和 $3$ 个对照样本，使用相同的试剂盒和方案。对于每个样本 $i$，基因 $g$ 的观测计数（记为 $Y_{gi}$）被建模为一个抽样过程的产物，在该过程中，来自表达转录本的片段被随机捕获和测序。一个经过充分检验的计数数据基础模型假设数据服从负二项分布，其均值为 $\\mu_{gi}$，方差为 $\\mu_{gi} + \\alpha_g \\mu_{gi}^2$。其中 $\\mu_{gi} = s_i q_{gi}$，$s_i$ 是样本特异性的文库大小（大小因子），$q_{gi}$ 是样本 $i$ 中基因 $g$ 的潜在表达水平，$\\alpha_g$ 是基因特异性的离散度。技术故障可能会扭曲 $s_i$ 的值，并在 $q_{gi}$ 中引入基因和转录本长度依赖性的偏倚（例如，由于降解导致 $3'$ 端富集），从而违反了差异可由固定的设计协变量捕获的假设。\n\n所有样本的质量控制 (QC) 摘要均可用，包括总读数 (reads) $R_i$、唯一比对分数 $\\hat{p}_{u,i}$、重复率 $d_i$、核糖体分数 $r_i$、3' 端到 5' 端的覆盖率比值 $b_i$、RNA 完整性数值 $q_i$ (RIN)，以及通过中位数比率法估计的大小因子 $s_i$。对所有基因的对数转换和标准化后的计数进行了主成分分析 (PCA)，通过计算样本协方差矩阵的特征分解，得到具有特征值 $\\lambda_1, \\lambda_2, \\ldots$ 的主成分；前两个主成分分别解释了方差的 $\\lambda_1 / \\sum_j \\lambda_j$ 和 $\\lambda_2 / \\sum_j \\lambda_j$。\n\n一个标记为 $S7$ 的疾病样本，在 PCA 中是一个明显的异常值。第一个主成分解释了 $35\\%$ 的方差（即 $\\lambda_1 / \\sum_j \\lambda_j = 0.35$），第二个主成分解释了 $18\\%$ 的方差（即 $\\lambda_2 / \\sum_j \\lambda_j = 0.18$）。$S7$ 在主成分 1 上的 PCA 坐标为 $z_{1,7} = 5.2$，在主成分 2 上的坐标为 $z_{2,7} = -0.4$，而所有其他样本都满足 $|z_{1,i}| < 1.0$ 和 $|z_{2,i}| < 1.2$。按批次着色显示 $\\mathcal{B}_1$ 和 $\\mathcal{B}_2$ 的簇是重叠的，而 $S7$ 与两个批次都分开了。\n\n$S7$ 的 QC 指标与其他样本的范围对比如下：\n- $R_7 = 2.8 \\times 10^7$ 读数 (其他样本: $R_i \\in [3.0 \\times 10^7, 4.1 \\times 10^7]$),\n- $\\hat{p}_{u,7} = 0.52$ (其他样本: $\\hat{p}_{u,i} \\in [0.76, 0.88]$),\n- $d_7 = 0.65$ (其他样本: $d_i \\in [0.22, 0.44]$),\n- $r_7 = 0.23$ (其他样本: $r_i \\in [0.04, 0.09]$),\n- $b_7 = 2.3$ (其他样本: $b_i \\in [0.93, 1.15]$),\n- $q_7 = 5.1$ (其他样本: $q_i \\in [7.8, 9.2]$),\n- $s_7 = 0.42$ (其他样本: $s_i \\in [0.84, 1.15]$).\n\n此外，还在样本中添加了已知数量的外源 RNA 对照联盟 (ERCC) 外参分子。对于 $S7$，观测到的 ERCC 计数与预期浓度之间的斯皮尔曼相关性为 $\\rho_7 = 0.31$（其他样本：$\\rho_i \\in [0.78, 0.92]$）。$S7$ 剩余可用的起始 RNA 材料为 $M_7 = 0.8 \\,\\mu\\text{g}$，而文库试剂盒的规格要求起始 RNA 的量 $\\geq 1.0 \\,\\mu\\text{g}$ 且质量要高。\n\n您计划使用一个包含截距和条件指示变量的设计矩阵 $X$，可能还会包含批次协变量或其他无关因子，来对计数 $Y_{gi}$ 拟合一个广义线性模型。基于以上信息，为 $S7$ 选择最恰当的处理方案，以确保科学有效的推断，并从数据生成和分析模型的首要原则出发，论证您的选择。\n\n哪项措施最为恰当？\nA. 将 $S7$ 从下游差异表达分析中排除，并记录因技术故障而排除。\nB. 使用剩余的 RNA 材料为 $S7$ 重新进行文库制备，以期获得一个可用的文库。\nC. 保留 $S7$，并在设计矩阵 $X$ 中加入一个批次指示变量来解释该异常值。\nD. 保留 $S7$，并应用代理变量分析来捕获隐藏因子，同时保留该样本。\nE. 保留 $S7$ 并过滤掉比对到核糖体 RNA 的读数；其余步骤照常进行。", "solution": "该问题要求确定处理样本 $S7$ 的最恰当方案，该样本在一次 RNA 测序实验中表现为一个显著的异常值。所做的决定必须基于实验设计、数据质量控制和统计建模的原则，以确保最终结论的科学有效性。\n\n首先，我将总结和解释所提供的关于样本 $S7$ 的大量证据。目标是确定该样本的异常状态是反映了真实的生物学现象还是技术故障。\n\n**关于样本 $S7$ 的证据分析**\n\n数据为样本 $S7$ 处理过程中出现的严重技术故障提供了强有力且多方面的证据。\n\n1.  **主成分分析 (PCA):** 样本 $S7$ 在第一主成分 (PC1) 上是一个极端异常值，其坐标为 $z_{1,7} = 5.2$，而所有其他样本的坐标绝对值 $|z_{1,i}| < 1.0$。由于 PC1 解释了数据集中总方差的 $35\\%$（$\\lambda_1 / \\sum_j \\lambda_j = 0.35$），这意味着这单个样本是驱动主要变异模式的原因。当变异的主要来源是由单个样本驱动，而不是由感兴趣的实验条件驱动时，这强烈表明存在技术假象，而非生物学上的极端表型。$S7$ 与两个批次 $\\mathcal{B}_1$ 和 $\\mathcal{B}_2$ 都分离，这一事实证实了这并非简单的批次效应。\n\n2.  **RNA 质量与降解:** $S7$ 的 RNA 完整性数值 (RIN) 为 $q_7 = 5.1$，远低于其他样本的范围（$q_i \\in [7.8, 9.2]$）。低于 $6.0$ 的 RIN 分数表明 RNA 严重降解。高 3' 端到 5' 端的覆盖率比值 $b_7 = 2.3$（其他样本：$b_i \\in [0.93, 1.15]$）也证实了这一点。RNA 降解与 poly-A 尾文库制备方法相结合，会导致读数在转录本的 3' 端积聚。这会产生一种基因长度依赖性的定量偏倚，而这种偏倚无法通过单个样本特异性的大小因子 $s_i$ 来校正。\n\n3.  **文库质量:** 从 $S7$ 生成的文库质量很差。重复率极高（$d_7 = 0.65$，而其他样本在 $[0.22, 0.44]$ 范围内），表明这是一个低复杂度的文库，其中 PCR 扩增过度以达到足够的产量。这降低了有效测序深度和表达量估计的精确度。唯一比对分数非常低（$\\hat{p}_{u,7} = 0.52$，而其他样本在 $[0.76, 0.88]$ 范围内），这可能表明存在污染或其他文库制备失败，如接头二聚体的形成。\n\n4.  **测序效率和污染:** 核糖体 RNA 分数显著升高（$r_7 = 0.23$，而其他样本在 $[0.04, 0.09]$ 范围内），表明 poly-A 筛选或 rRNA 去除步骤效率低下。因此，大部分测序资源被浪费在非目标分子上。这一点，再加上总读数略低（$R_7 = 2.8 \\times 10^7$），导致估计的大小因子非常低（$s_7 = 0.42$），这意味着用于编码转录本的有效文库大小仅为其他样本的一小部分。\n\n5.  **定量准确性（地面实况）:** 最明确的失败证据来自外源 RNA 对照联盟 (ERCC) 的外参数据。对于 $S7$，观测计数与预期浓度之间的斯皮尔曼相关性仅为 $\\rho_7 = 0.31$，而所有其他样本该值都很高（$\\rho_i \\in [0.78, 0.92]$）。这表明样本 $S7$ 的定量测量结果不能忠实地反映原始样本中分子的真实丰度。整个测量的定量基础都已受损。\n\n**对统计模型的影响**\n\n预期的分析使用负二项模型，其中平均计数 $\\mu_{gi}$ 被建模为 $\\mu_{gi} = s_i q_{gi}$。该模型假设所有样本特异性的技术效应都可以通过一个单一的缩放因子 $s_i$ 来捕获，从而使 $q_{gi}$ 代表感兴趣的生物学量。关于 $S7$ 的证据表明，这一假设被严重违反。RNA 降解引入了复杂的、基因依赖性的偏倚（例如，与转录本长度相关的偏倚），这是单个因子 $s_7$ 无法校正的。将此样本纳入分析会夸大方差估计（离散度 $\\alpha_g$），急剧降低统计功效，并由于大量未建模的技术噪声而引入假阳性和假阴性差异表达检出的高风险。\n\n基于此分析，我们可以评估所提出的各项措施。\n\n**逐项分析**\n\n**A. 将 $S7$ 从下游差异表达分析中排除，并记录因技术故障而排除。**\n证据是结论性的：由于从劣质起始 RNA 开始的一系列技术故障，$S7$ 的数据不能有效代表样本的生物学特性。下游统计分析的基本假设被一种计算上无法纠正的方式所违反。在这种情况下，最科学严谨且站得住脚的做法是排除该样本。这优先考虑了研究结论的有效性和完整性，而非计较样本量的边际损失。最终分析将在 $5$ 个疾病样本对 $6$ 个对照样本的情况下进行。排除样本的决定及其详细原因必须被透明地记录下来。\n**结论：正确。**\n\n**B. 使用剩余的 RNA 材料为 $S7$ 重新进行文库制备，以期获得一个可用的文库。**\n问题指出，剩余的 RNA 材料为 $M_7 = 0.8 \\,\\mu\\text{g}$，而试剂盒要求 $\\geq 1.0 \\,\\mu\\text{g}$。此外，这部分剩余的 RNA 与已被证实质量极差（$q_7 = 5.1$）的 RNA 属于同一批。试图用数量不足且已降解的起始材料生成新文库，是违反实验方案的，并且几乎肯定会导致又一个失败的文库。这种做法是浪费时间和资源。\n**结论：不正确。**\n\n**C. 保留 $S7$，并在设计矩阵 $X$ 中加入一个批次指示变量来解释该异常值。**\n批次效应是影响一组一同处理的样本的系统性技术变异。PCA 图显示 $S7$ 相对于*所有*其他样本（包括其自身批次的样本）都是一个异常值。因此，它的变异不是批次效应。在模型中加入批次协变量无法解释 $S7$ 的独特偏差。将 $S7$ 建模为其自身的批次是一种临时的修正，它没有解决根本性的非线性、基因依赖性偏倚（如 3' 偏倚）以及 ERCC 数据所证实的定量准确性缺失的问题。\n**结论：不正确。**\n\n**D. 保留 $S7$，并应用代理变量分析来捕获隐藏因子，同时保留该样本。**\n代理变量分析 (SVA) 是一种估计和解释未测量到的系统性变异来源的方法。虽然 SVA 很强大，但它并非用于挽救来自单个灾难性样本失败的数据。来自 $S7$ 的变异是如此之大（$\\lambda_1 / \\sum_j \\lambda_j = 0.35$），其技术原因又如此明确（降解、低复杂度等），以至于它不是一个“隐藏”的因子。更重要的是，SVA 和其他线性模型调整无法修复数据不具有定量性的根本问题，正如低 ERCC 相关性（$\\rho_7 = 0.31$）所示。最佳实践是在应用 SVA 等方法寻找更微妙、未知的混杂因素*之前*，先移除已知存在严重技术假象的样本。\n**结论：不正确。**\n\n**E. 保留 $S7$ 并过滤掉比对到核糖体 RNA 的读数；其余步骤照常进行。**\n过滤 rRNA 读数是一个标准的数据处理步骤。高 rRNA 分数（$r_7 = 0.23$）是文库制备失败的一个症状，而不是根本原因。移除这些读数无法解决 RNA 降解（$q_7 = 5.1, b_7 = 2.3$）、低文库复杂度（$d_7 = 0.65$）或由此导致的定量准确性丧失（$\\rho_7 = 0.31$）等根本问题。剩余的非 rRNA 读数仍将携带所有这些技术假象，使其不适合用于差异表达分析。\n**结论：不正确。**\n\n总之，来自多个独立 QC 指标的压倒性且一致的证据表明，样本 $S7$ 存在不可挽回的技术故障。唯一科学合理的做法是排除该样本，以保持分析的完整性。", "answer": "$$\\boxed{A}$$", "id": "4605754"}]}