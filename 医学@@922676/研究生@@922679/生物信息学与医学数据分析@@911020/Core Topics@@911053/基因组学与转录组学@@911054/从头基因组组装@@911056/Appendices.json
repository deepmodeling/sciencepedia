{"hands_on_practices": [{"introduction": "在任何基因组组装项目中，测序覆盖度（$C$）都是基石。在尝试组装之前，我们必须确保拥有足够的数据。本练习要求你推导经典的 Lander-Waterman 模型结果，该模型量化了覆盖度与组装中出现“缺口”概率之间的关系，为高覆盖度的必要性提供了理论基础 [@problem_id:4552682]。", "problem": "一个长度为 $G$ 的连续基因组由 $N$ 个独立的、长度固定为 $L$ 的读长（reads）进行测序。假设读长的起始位置是独立的，并以相等的概率均匀分布在 $G$ 个可能的起始位点上，并且由于 $G \\gg L$，可以忽略边缘效应。在从头组装（de novo assembly）的重叠-布局-一致性（Overlap–Layout–Consensus, OLC）和 de Bruijn 图模型中，一个基本量是名义测序覆盖度 $C$，定义为 $C = \\frac{N L}{G}$。仅使用核心概率定义以及连接二项分布与泊松分布的极限，从第一性原理出发，推导基因组中任意一个碱基未被任何读长覆盖的概率表达式。用纯粹的 $C$ 的形式表示您的最终结果。根据该结果，简要解释在所述假设下，此概率对于重叠-布局-一致性（OLC）和 de Bruijn 图框架中的组装完整性有何意义。您的最终答案必须是单一的封闭形式解析表达式，且无需四舍五入。", "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确、客观且内部一致。它代表了测序理论中的一个经典问题。因此，我们可以开始求解。\n\n设 $G$ 为基因组长度，$N$ 为读长数量，$L$ 为每个读长的长度。名义测序覆盖度定义为 $C = \\frac{NL}{G}$。我们旨在求解在读长起始位置独立且均匀分布于 $G$ 个可能的起始位点的假设下，基因组中任意一个碱基未被 $N$ 个读长中任何一个覆盖的概率。$G \\gg L$ 的条件使我们能够忽略边缘效应。\n\n考虑基因组中特定位置的一个任意碱基。要使单个读长覆盖此碱基，其起始位置必须落在一个特定的窗口内。一个从位置 $s$ 开始的长度为 $L$ 的读长覆盖基因组区间 $[s, s+L-1]$。为了使这个读长能覆盖我们位于位置 $k$ 的任意碱基，必须满足条件 $s \\le k \\le s+L-1$。这等价于起始位置 $s$ 在范围 $k-L+1 \\le s \\le k$ 内。满足此条件的整数起始位置的数量为 $k - (k-L+1) + 1 = L$。\n\n问题陈述，对于任何给定的读长，有 $G$ 个可能的起始位点，且每个位点被选择的概率相等。因此，单个随机放置的读长覆盖我们特定碱基的概率 $p$ 是有利起始位置数与总可能起始位置数的比值：\n$$p = \\frac{L}{G}$$\n\n因此，单个读长*不*覆盖此特定碱基的概率是 $1-p$：\n$$1-p = 1 - \\frac{L}{G}$$\n\n问题陈述，$N$ 个读长是独立放置的。因此，一个碱基被一个读长覆盖的事件与被另一个读长覆盖的事件是独立的。该碱基未被 $N$ 个读长中任何一个覆盖的概率是每个读长都不覆盖它的各个概率的乘积。设 $P_0$ 为未被覆盖（即覆盖度为零）的概率。这对应于 $N$ 次独立的 Bernoulli 试验，每次试验的“失败”概率为 $1-p$。\n$$P_0 = (1 - p)^N = \\left(1 - \\frac{L}{G}\\right)^N$$\n\n问题要求我们使用连接二项分布与泊松分布的极限。覆盖特定碱基的读长数量遵循二项分布 $B(N, p)$，其中 $N$ 是试验次数，$p = L/G$ 是单次试验中成功（覆盖）的概率。在典型的测序实验中，读长数量 $N$ 非常大（数百万到数十亿），并且由于 $G \\gg L$，概率 $p$ 非常小。在这个极限下，当 $N \\to \\infty$ 且 $p \\to 0$，使得均值 $\\lambda = Np$ 保持不变时，二项分布可以由均值为 $\\lambda$ 的泊松分布精确近似。\n\n我们的任意碱基被覆盖的平均次数是：\n$$\\lambda = Np = N \\left(\\frac{L}{G}\\right) = \\frac{NL}{G}$$\n根据定义，这正是名义测序覆盖度 $C$。所以，$\\lambda = C$。\n\n泊松分布给出了观察到恰好 $k$ 次事件（在此情况下，即 $k$ 个读长覆盖该碱基）的概率为：\n$$P(k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n我们关心的是碱基未被覆盖的概率，这对应于 $k=0$。将 $k=0$ 和 $\\lambda=C$ 代入泊松概率质量函数，我们得到：\n$$P_0 = P(k=0) = \\frac{C^0 \\exp(-C)}{0!}$$\n由于 $C^0 = 1$ 且 $0! = 1$，该表达式简化为：\n$$P_0 = \\exp(-C)$$\n这就是基因组中任意一个碱基未被覆盖的概率，纯粹用名义覆盖度 $C$ 表示。\n\n这个结果对基因组组装的完整性具有直接而重要的意义。数值 $\\exp(-C)$ 代表了基因组中覆盖度为零部分的期望比例。\n\n在重叠-布局-一致性（Overlap-Layout-Consensus, OLC）框架中，组装通过寻找读长之间的重叠来构建更长的连续序列（contigs）。如果基因组的某个片段覆盖度为零，那么测序数据中将不会有源自该区域的读长。因此，将没有读长来桥接由侧翼区域生成的重叠群（contigs）之间的间隙。组装图将在这些点断开，导致组装结果碎片化。因此，数量 $\\exp(-C)$ 直接估计了由于覆盖度间隙而导致最终组装中缺失的基因组比例。\n\n在 de Bruijn 图（DBG）框架中，所有读长都被分解成长度为 $k$ 的更小的重叠子序列（k-mers）。这些 k-mers 构成图的节点，边连接在读长中相邻的 k-mers。一个完整且连续的组装对应于找到一条（或多条）遍历所有与真实基因组序列相对应的边的路径。如果基因组的某个区域覆盖度为零，那么该区域所有独特的 k-mers 都将不在读长集中。这些缺失的 k-mers 会在 de Bruijn 图中造成断裂，从而无法重构出一条单一的连续路径。因此，组装算法将输出多个不相交的重叠群（contigs），对应于图的连通分量。概率 $\\exp(-C)$ 是一个强有力的代理指标，用于衡量遇到此类破坏组装的间隙的可能性，再次直接关系到组装的预期完整性。", "answer": "$$\\boxed{\\exp(-C)}$$", "id": "4552682"}, {"introduction": "在建立了覆盖度的理论基础后，我们转向算法实践。德布莱金图（de Bruijn graph）是现代组装算法的主流数据结构，但基因组中的重复序列和模糊连接可能导致图中存在多条可能的路径，对应着不同的潜在组装结果。本练习提供了一个具体的德布莱金图，要求你应用图论原理（特别是BEST定理），精确计算有效组装路径的总数，从而量化图结构中固有的模糊性 [@problem_id:4552656]。", "problem": "考虑一个生物信息学和医学数据分析中的 de novo 组装任务，该任务针对一个小型病原体质粒，使用由短读序列构建的 de Bruijn 图进行建模。在此位点，字母表是脱氧核糖核酸（DNA）核苷酸，限定为 $\\{\\mathrm{A}, \\mathrm{T}\\}$。组装在 $k=3$ 的条件下进行，因此顶点是 $(k-1)$-mer，边是 $k$-mer。给你观测到的 $k$-mer 的多重集（其重数源于覆盖度）如下：\n$\\{\\mathrm{AAA}, \\mathrm{AAA}, \\mathrm{AAT}, \\mathrm{ATA}, \\mathrm{ATA}, \\mathrm{TAA}, \\mathrm{TAA}, \\mathrm{TAT}\\}$。\n构建有向 de Bruijn 图 $G$，其顶点是出现的所有不同的 $(k-1)$-mer，其有向多重边代表给定的 $k$-mer（从前缀到后缀）。得到的顶点集是 $\\{\\mathrm{AA}, \\mathrm{AT}, \\mathrm{TA}\\}$，边的多重集（带计数）如下：\n- 从 $\\mathrm{AA}$ 到 $\\mathrm{AA}$：$2$ 条边（来自 $\\mathrm{AAA}$），\n- 从 $\\mathrm{AA}$ 到 $\\mathrm{AT}$：$1$ 条边（来自 $\\mathrm{AAT}$），\n- 从 $\\mathrm{AT}$ 到 $\\mathrm{TA}$：$2$ 条边（来自 $\\mathrm{ATA}$），\n- 从 $\\mathrm{TA}$ 到 $\\mathrm{AA}$：$2$ 条边（来自 $\\mathrm{TAA}$），\n- 从 $\\mathrm{TA}$ 到 $\\mathrm{AT}$：$1$ 条边（来自 $\\mathrm{TAT}$）。\n\n这些边的计数意味着图 $G$ 的入度和出度如下：\n- $\\mathrm{outdeg}(\\mathrm{AA})=3$，$\\mathrm{indeg}(\\mathrm{AA})=4$，\n- $\\mathrm{outdeg}(\\mathrm{AT})=2$，$\\mathrm{indeg}(\\mathrm{AT})=2$，\n- $\\mathrm{outdeg}(\\mathrm{TA})=3$，$\\mathrm{indeg}(\\mathrm{TA})=2$。\n\n仅从 de Bruijn 图、有向图中的欧拉路径的核心定义，以及组装中欧拉遍历存在的标准连通性要求出发，判断图 $G$ 是否存在欧拉路径。如果存在，请从第一性原理和有向欧拉图的成熟计数结果出发，严格推导图 $G$ 中欧拉路径可以构成的不同序列的总数（每条不同的欧拉路径通过尊重重叠的方式拼接 $k$-mer 构成一个序列）。将最终答案表示为一个精确的整数。无需四舍五入。", "solution": "问题要求计算可以从给定的 $k$-mer 多重集中组装出的不同基因组序列的数量。这等价于在相应的 de Bruijn 图中寻找不同欧拉路径的数量。我们首先验证存在欧拉路径的条件，然后进行计数。\n\n设 $G(V, E)$ 为 de Bruijn 图，其中 $V$ 是 $(k-1)$-mer 的集合，$E$ 是 $k$-mer 的多重集。\n问题提供了以下信息：\n- 字母表是 $\\{\\mathrm{A}, \\mathrm{T}\\}$。\n- $k$-mer 的长度为 $k=3$。\n- 顶点集为 $V = \\{\\mathrm{AA}, \\mathrm{AT}, \\mathrm{TA}\\}$。\n- 边的多重集（观测到的 $k$-mer）总共有 $8$ 条边。\n- 顶点的入度和出度如下：\n  - 对于顶点 $\\mathrm{AA}$：$\\mathrm{outdeg}(\\mathrm{AA})=3$，$\\mathrm{indeg}(\\mathrm{AA})=4$。\n  - 对于顶点 $\\mathrm{AT}$：$\\mathrm{outdeg}(\\mathrm{AT})=2$，$\\mathrm{indeg}(\\mathrm{AT})=2$。\n  - 对于顶点 $\\mathrm{TA}$：$\\mathrm{outdeg}(\\mathrm{TA})=3$，$\\mathrm{indeg}(\\mathrm{TA})=2$。\n\n一个有向多重图存在欧拉路径，当且仅当：\n1. 其底层的无向图是连通的。\n2. 最多有一个顶点 $u$ 满足 $\\mathrm{outdeg}(u) - \\mathrm{indeg}(u) = 1$。\n3. 最多有一个顶点 $v$ 满足 $\\mathrm{indeg}(v) - \\mathrm{outdeg}(v) = 1$。\n4. 所有其他顶点 $w$ 满足 $\\mathrm{outdeg}(w) = \\mathrm{indeg}(w)$。\n\n首先，我们检查连通性。边包括 $\\mathrm{AA} \\to \\mathrm{AA}$、$\\mathrm{AA} \\to \\mathrm{AT}$、$\\mathrm{AT} \\to \\mathrm{TA}$、$\\mathrm{TA} \\to \\mathrm{AA}$ 和 $\\mathrm{TA} \\to \\mathrm{AT}$。我们可以追踪任意两个顶点之间的路径，例如：$\\mathrm{AA} \\to \\mathrm{AT} \\to \\mathrm{TA} \\to \\mathrm{AA}$。这表明该图是强连通的，满足连通性要求。\n\n接下来，我们检查度数：\n- 对于顶点 $\\mathrm{AA}$：$\\mathrm{indeg}(\\mathrm{AA}) - \\mathrm{outdeg}(\\mathrm{AA}) = 4 - 3 = 1$。\n- 对于顶点 $\\mathrm{AT}$：$\\mathrm{indeg}(\\mathrm{AT}) - \\mathrm{outdeg}(\\mathrm{AT}) = 2 - 2 = 0$。\n- 对于顶点 $\\mathrm{TA}$：$\\mathrm{outdeg}(\\mathrm{TA}) - \\mathrm{indeg}(\\mathrm{TA}) = 3 - 2 = 1$。\n\n欧拉路径的条件得到满足。恰好有一个顶点 $u = \\mathrm{TA}$ 的出度比入度多 $1$，恰好有一个顶点 $v = \\mathrm{AA}$ 的入度比出度多 $1$。所有其他顶点都是平衡的。因此，存在欧拉路径，且它们都必须从 $\\mathrm{TA}$ 开始，到 $\\mathrm{AA}$ 结束。\n\n为了计算从 $\\mathrm{TA}$ 到 $\\mathrm{AA}$ 的不同欧拉路径的数量，我们使用一种标准技术。我们通过添加一条从终点 $\\mathrm{AA}$ 到起点 $\\mathrm{TA}$ 的“虚拟”边来扩充图 $G$。我们将这个新图称为 $G'$。这个新图 $G'$ 现在是平衡的（欧拉图），即对于所有顶点 $w \\in V$，都有 $\\mathrm{indeg}_{G'}(w) = \\mathrm{outdeg}_{G'}(w)$。\n$G'$ 中的度数为：\n- 对于顶点 $\\mathrm{AA}$：$\\mathrm{outdeg}_{G'}(\\mathrm{AA})=3+1=4$，$\\mathrm{indeg}_{G'}(\\mathrm{AA})=4$。\n- 对于顶点 $\\mathrm{AT}$：$\\mathrm{outdeg}_{G'}(\\mathrm{AT})=2$，$\\mathrm{indeg}_{G'}(\\mathrm{AT})=2$。\n- 对于顶点 $\\mathrm{TA}$：$\\mathrm{outdeg}_{G'}(\\mathrm{TA})=3$，$\\mathrm{indeg}_{G'}(\\mathrm{TA})=2+1=3$。\n\n在 $G$ 中从 $\\mathrm{TA}$ 到 $\\mathrm{AA}$ 的欧拉路径与 $G'$ 中的欧拉回路之间存在一一对应关系。有向欧拉图中欧拉回路的总数量由 BEST 定理（de Bruijn, van Aardenne-Ehrenfest, Smith, Tutte）给出：\n$$N = t(G') \\prod_{w \\in V} (\\mathrm{indeg}_{G'}(w) - 1)!$$\n其中 $t(G')$ 是以任意选定顶点为根的生成树状图的数量。\n\n首先，我们计算乘积项：\n$$ \\prod_w (\\mathrm{indeg}_{G'}(w) - 1)! = (\\mathrm{indeg}_{G'}(\\mathrm{AA}) - 1)! \\times (\\mathrm{indeg}_{G'}(\\mathrm{AT}) - 1)! \\times (\\mathrm{indeg}_{G'}(\\mathrm{TA}) - 1)! $$\n$$ = (4-1)! \\times (2-1)! \\times (3-1)! = 3! \\times 1! \\times 2! = 6 \\times 1 \\times 2 = 12 $$\n\n接下来，我们计算 $t(G')$，即生成树状图的数量。根据有向图的矩阵树定理，$t(G')$ 等于图 $G'$ 的拉普拉斯矩阵 $L'$ 的任何一个代数余子式。拉普拉斯矩阵定义为 $L' = D'_{out} - A'$，其中 $D'_{out}$ 是 $G'$ 的出度对角矩阵，$A'$ 是 $G'$ 的邻接矩阵。\n\n设顶点索引为 $1: \\mathrm{AA}$，$2: \\mathrm{AT}$，$3: \\mathrm{TA}$。图 $G'$ 的邻接矩阵 $A'$（包括重数和虚拟边 $\\mathrm{AA} \\to \\mathrm{TA}$）为：\n$$ A' = \\begin{pmatrix} 2  1  1 \\\\ 0  0  2 \\\\ 2  1  0 \\end{pmatrix} $$\n出度矩阵 $D'_{out}$ 为：\n$$ D'_{out} = \\begin{pmatrix} 4  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} $$\n拉普拉斯矩阵 $L'$ 为：\n$$ L' = D'_{out} - A' = \\begin{pmatrix} 4  0  0 \\\\ 0  2  0 \\\\ 0  0  3 \\end{pmatrix} - \\begin{pmatrix} 2  1  1 \\\\ 0  0  2 \\\\ 2  1  0 \\end{pmatrix} = \\begin{pmatrix} 2  -1  -1 \\\\ 0  2  -2 \\\\ -2  -1  3 \\end{pmatrix} $$\n生成树状图的数量 $t(G')$ 是 $L'$ 的任意一个代数余子式。我们计算 $(1,1)$-代数余子式：\n$$ C_{11} = (-1)^{1+1} \\det \\begin{pmatrix} 2  -2 \\\\ -1  3 \\end{pmatrix} = (2)(3) - (-2)(-1) = 6 - 2 = 4 $$\n所以，$t(G') = 4$。\n\n最后，$G$ 中欧拉路径的总数就是 $G'$ 中欧拉回路的数量，即：\n$$ N = t(G') \\times \\prod_w (\\mathrm{indeg}_{G'}(w) - 1)! = 4 \\times 12 = 48 $$\n每条不同的欧拉路径构成一个唯一的核苷酸序列。因此，可以组装出 $48$ 个不同的序列。", "answer": "$$\\boxed{48}$$", "id": "4552656"}, {"introduction": "在上一个练习的基础上，本节将探讨如何*解决*而非仅仅是量化模糊性。我们将关注图中的“气泡”（bubbles），它既可能代表真实的生物学变异（如杂合性），也可能源于测序错误。这个高级练习要求你利用似然比检验（Likelihood Ratio Test）建立一个统计决策框架，以区分这两种情况，这模仿了顶尖组装软件为生成更准确序列而采用的复杂逻辑 [@problem_id:4552729]。", "problem": "在从头组装（de novo assembly）过程中，德布莱金图（DBG）中的一个气泡结构（bubble）是指两条可选的有向路径从一个节点分叉然后又重新汇合，这通常反映了真实的二倍体杂合性或测序错误。在一个二倍体基因组中，一个杂合单核苷酸多态性（SNP）会产生两条等位基因路径，其覆盖度与等位基因频率成正比；而测序错误则倾向于产生一条低覆盖度的伪路径。假设新一代测序（NGS）中 $k$-mer 的读段覆盖度可以很好地用独立的泊松变量来建模，这些泊松变量的均值与路径特异性的暴露权重成正比，该权重是沿路径聚合每个 $k$-mer 的贡献（例如，长度或质量加权多重性）得到的。考虑一个具有两条分支路径 $A$ 和 $B$ 的单一气泡结构，其在暴露权重 $E_{A}$ 和 $E_{B}$ 上观察到的聚合 $k$-mer 计数分别为 $S_{A}$ 和 $S_{B}$。设碱基识别错误率为 $\\epsilon$，并假设一个简单的替换错误模型，其中，在区分位点发生错误的条件下，错误的碱基是三种可能的替代核苷酸之一的均匀分布，因此特定错误等位基因的概率为 $\\epsilon/3$。\n\n构建一个似然比检验（LRT; Likelihood Ratio Test）来在以下两个假设之间做出决策：\n- $\\mathcal{H}_{0}$（错误气泡）：分支 $A$ 是真实等位基因，其单位暴露率与 $(1-\\epsilon)$ 成正比；分支 $B$ 是伪错误等位基因，其单位暴露率与 $\\epsilon/3$ 成正比，两者共享一个未知的缩放因子 $\\lambda$。\n- $\\mathcal{H}_{1}$（杂合气泡）：两个分支都是真实等位基因，分支 $A$ 的单位暴露率与 $\\lambda q$ 成正比，分支 $B$ 的单位暴露率与 $\\lambda(1-q)$ 成正比，其中 $\\lambda0$ 和 $q\\in(0,1)$ 是未知的。\n\n从泊松似然函数出发，不使用任何快捷公式，推导出覆盖度加权的 LRT 统计量 $-2\\ln\\Lambda$ 的闭式解，用 $S_{A}$、$S_{B}$、$E_{A}$、$E_{B}$ 和 $\\epsilon$ 表示。然后，使用推导出的表达式，为以下气泡计算 $-2\\ln\\Lambda$ 的数值：\n- $S_{A} = 240$, $S_{B} = 230$,\n- $E_{A} = 12$, $E_{B} = 12$,\n- $\\epsilon = 0.01$。\n\n将最终数值四舍五入到四位有效数字。将最终统计量表示为一个无量纲数。最后，用文字解释这个决策规则如何证明保留反映真实杂合性的气泡是合理的，而不是合并由测序错误引起的气泡，但最终答案只报告数值。", "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于统计基因组学的原理，是良定的、客观的，并包含推导出解决方案所需的所有必要信息。\n\n任务是构建一个似然比检验（LRT），以区分德布莱金图中的错误诱导气泡和杂合气泡。我们已知两条可选路径 A 和 B 的聚合 $k$-mer 观测计数 $S_A$ 和 $S_B$，以及相应的暴露权重 $E_A$ 和 $E_B$。假设这些计数服从独立的泊松分布。\n\n两个独立的、均值为 $\\mu_A$ 和 $\\mu_B$ 的泊松分布随机变量 $S_A$ 和 $S_B$ 的似然函数由下式给出：\n$$L(\\mu_A, \\mu_B; S_A, S_B) = \\frac{\\mu_A^{S_A} \\exp(-\\mu_A)}{S_A!} \\cdot \\frac{\\mu_B^{S_B} \\exp(-\\mu_B)}{S_B!}$$\n对数似然函数，忽略在 LRT 中会抵消的 $S_A!$ 和 $S_B!$ 中的常数项，为：\n$$\\ln L(\\mu_A, \\mu_B) = S_A \\ln(\\mu_A) - \\mu_A + S_B \\ln(\\mu_B) - \\mu_B$$\n\n我们将在每个假设下找到最大化的对数似然。\n\n**零假设 $\\mathcal{H}_0$：错误气泡**\n在 $\\mathcal{H}_0$ 下，均值由一个单一的未知缩放因子 $\\lambda  0$ 参数化：\n$$\\mu_A = \\lambda (1-\\epsilon) E_A$$\n$$\\mu_B = \\lambda \\frac{\\epsilon}{3} E_B$$\n$\\mathcal{H}_0$ 下的对数似然是 $\\lambda$ 的函数：\n$$\\ln L_0(\\lambda) = S_A \\ln(\\lambda (1-\\epsilon) E_A) - \\lambda (1-\\epsilon) E_A + S_B \\ln(\\lambda \\frac{\\epsilon}{3} E_B) - \\lambda \\frac{\\epsilon}{3} E_B$$\n$$\\ln L_0(\\lambda) = (S_A + S_B) \\ln(\\lambda) - \\lambda \\left((1-\\epsilon)E_A + \\frac{\\epsilon}{3}E_B\\right) + \\text{constant terms}$$\n为了找到 $\\lambda$ 的最大似然估计（MLE），我们对 $\\lambda$ 求导并将结果设为零：\n$$\\frac{\\partial \\ln L_0}{\\partial \\lambda} = \\frac{S_A + S_B}{\\lambda} - \\left((1-\\epsilon)E_A + \\frac{\\epsilon}{3}E_B\\right) = 0$$\n解出 $\\lambda$ 得到 MLE $\\hat{\\lambda}_0$：\n$$\\hat{\\lambda}_0 = \\frac{S_A + S_B}{(1-\\epsilon)E_A + \\frac{\\epsilon}{3}E_B}$$\n$\\mathcal{H}_0$ 下均值的 MLE 为：\n$$\\hat{\\mu}_{A,0} = \\hat{\\lambda}_0 (1-\\epsilon) E_A = (S_A + S_B) \\frac{(1-\\epsilon)E_A}{(1-\\epsilon)E_A + \\frac{\\epsilon}{3}E_B}$$\n$$\\hat{\\mu}_{B,0} = \\hat{\\lambda}_0 \\frac{\\epsilon}{3} E_B = (S_A + S_B) \\frac{\\frac{\\epsilon}{3}E_B}{(1-\\epsilon)E_A + \\frac{\\epsilon}{3}E_B}$$\n注意 $\\hat{\\mu}_{A,0} + \\hat{\\mu}_{B,0} = S_A + S_B$。\n$\\mathcal{H}_0$ 下的最大化对数似然为 $\\ln L_0(\\hat{\\lambda}_0) = S_A \\ln(\\hat{\\mu}_{A,0}) - \\hat{\\mu}_{A,0} + S_B \\ln(\\hat{\\mu}_{B,0}) - \\hat{\\mu}_{B,0}$。\n\n**备择假设 $\\mathcal{H}_1$：杂合气泡**\n在 $\\mathcal{H}_1$ 下，均值由两个未知参数 $\\lambda  0$ 和 $q \\in (0,1)$ 参数化：\n$$\\mu_A = \\lambda q E_A$$\n$$\\mu_B = \\lambda (1-q) E_B$$\n该模型有两个自由参数。对于任何一对正的观测计数 $(S_A, S_B)$，我们可以在指定范围内找到唯一的 $(\\lambda, q)$ 对，使得模型均值等于观测值。求解 $\\hat{\\mu}_{A,1} = S_A$ 和 $\\hat{\\mu}_{B,1} = S_B$ 以得到 $\\lambda$ 和 $q$：\n$$\\hat{q}_1 = \\frac{S_A/E_A}{S_A/E_A + S_B/E_B} = \\frac{S_A E_B}{S_A E_B + S_B E_A}$$\n$$\\hat{\\lambda}_1 = \\frac{S_A}{E_A} + \\frac{S_B}{E_B}$$\n由于给定的计数 $S_A, S_B$ 是正数，所以 $\\hat{q}_1 \\in (0,1)$ 且 $\\hat{\\lambda}_1  0$。因此，$\\mathcal{H}_1$ 下的参数空间足够丰富，可以完美拟合任何正数据。这意味着 $\\mathcal{H}_1$ 是饱和模型的一个重新参数化。该假设下均值的 MLE 就是观测到的计数：\n$$\\hat{\\mu}_{A,1} = S_A$$\n$$\\hat{\\mu}_{B,1} = S_B$$\n$\\mathcal{H}_1$ 下的最大化对数似然为 $\\ln L_1 = S_A \\ln(S_A) - S_A + S_B \\ln(S_B) - S_B$。\n\n**似然比检验统计量**\nLRT 统计量由 $-2\\ln\\Lambda$ 给出，其中 $\\Lambda = \\frac{L_0(\\hat{\\lambda}_0)}{L_1(\\hat{\\lambda}_1, \\hat{q}_1)}$。\n$$-2\\ln\\Lambda = -2 (\\ln L_0 - \\ln L_1)$$\n$$-2\\ln\\Lambda = -2 \\left[ (S_A \\ln(\\hat{\\mu}_{A,0}) - \\hat{\\mu}_{A,0} + S_B \\ln(\\hat{\\mu}_{B,0}) - \\hat{\\mu}_{B,0}) - (S_A \\ln(S_A) - S_A + S_B \\ln(S_B) - S_B) \\right]$$\n使用 $\\hat{\\mu}_{A,0} + \\hat{\\mu}_{B,0} = S_A+S_B$ 这一事实，$-\\hat{\\mu}_{A,0} - \\hat{\\mu}_{B,0}$ 和 $-S_A - S_B$ 项相互抵消。\n$$-2\\ln\\Lambda = -2 \\left[ S_A \\ln(\\hat{\\mu}_{A,0}) + S_B \\ln(\\hat{\\mu}_{B,0}) - S_A \\ln(S_A) - S_B \\ln(S_B) \\right]$$\n$$-2\\ln\\Lambda = 2 \\left[ S_A (\\ln(S_A) - \\ln(\\hat{\\mu}_{A,0})) + S_B (\\ln(S_B) - \\ln(\\hat{\\mu}_{B,0})) \\right]$$\n$$-2\\ln\\Lambda = 2 \\left[ S_A \\ln\\left(\\frac{S_A}{\\hat{\\mu}_{A,0}}\\right) + S_B \\ln\\left(\\frac{S_B}{\\hat{\\mu}_{B,0}}\\right) \\right]$$\n代入 $\\hat{\\mu}_{A,0}$ 和 $\\hat{\\mu}_{B,0}$ 的表达式，我们得到闭式解：\n$$ -2\\ln\\Lambda = 2 \\left[ S_A \\ln\\left(\\frac{S_A \\left((1-\\epsilon)E_A + \\frac{\\epsilon}{3}E_B\\right)}{(S_A+S_B)(1-\\epsilon)E_A}\\right) + S_B \\ln\\left(\\frac{S_B \\left((1-\\epsilon)E_A + \\frac{\\epsilon}{3}E_B\\right)}{(S_A+S_B)\\frac{\\epsilon}{3}E_B}\\right) \\right] $$\n\n**数值计算**\n我们给定的值为：$S_A = 240$，$S_B = 230$，$E_A = 12$，$E_B = 12$，以及 $\\epsilon=0.01$。\n首先，计算 $\\mathcal{H}_0$ 下的期望计数：\n$$S_A + S_B = 240 + 230 = 470$$\n由于 $E_A=E_B=12$，均值的表达式简化为：\n$$\\hat{\\mu}_{A,0} = (470) \\frac{(1-0.01) \\cdot 12}{(1-0.01) \\cdot 12 + \\frac{0.01}{3} \\cdot 12} = 470 \\frac{0.99}{0.99 + 0.01/3} = 470 \\frac{0.99}{2.98/3} = 470 \\frac{2.97}{2.98} \\approx 468.4228$$\n$$\\hat{\\mu}_{B,0} = 470 - \\hat{\\mu}_{A,0} = 470 - 470 \\frac{2.97}{2.98} = 470 \\left(1 - \\frac{2.97}{2.98}\\right) = 470 \\frac{0.01}{2.98} \\approx 1.5772$$\n现在我们计算统计量：\n$$-2\\ln\\Lambda = 2 \\left[ 240 \\ln\\left(\\frac{240}{468.4228}\\right) + 230 \\ln\\left(\\frac{230}{1.5772}\\right) \\right]$$\n$$-2\\ln\\Lambda = 2 \\left[ 240 \\ln(0.512358) + 230 \\ln(145.8298) \\right]$$\n$$-2\\ln\\Lambda = 2 \\left[ 240(-0.668735) + 230(4.982410) \\right]$$\n$$-2\\ln\\Lambda = 2 \\left[ -160.4964 + 1145.9543 \\right]$$\n$$-2\\ln\\Lambda = 2 [985.4579] = 1970.9158$$\n四舍五入到四位有效数字，值为 $1971$。\n\n**决策规则解释**\nLRT 统计量 $-2\\ln\\Lambda$ 量化了备择假设 $\\mathcal{H}_1$（杂合等位基因）比零假设 $\\mathcal{H}_0$（测序错误）能更好地解释观测数据的程度。该统计量的值越大，表示反对零假设的证据越强。\n根据 Wilks 定理，对于嵌套模型或正确指定的模型，该统计量渐近服从卡方分布，其自由度等于两个假设之间自由参数数量的差值（在本例中为 $df = 2-1=1$）。研究人员会将计算出的 $-2\\ln\\Lambda$ 值与来自 $\\chi^2_1$ 分布的临界值（例如，对于 $\\alpha=0.05$ 的显著性水平，临界值为 $3.84$）进行比较。\n在我们的案例中，观测计数 $S_A=240$ 和 $S_B=230$ 非常接近。杂合模型（$\\mathcal{H}_1$）可以很容易地通过估计的等位基因频率 $\\hat{q}_1 = 240/470 \\approx 0.51$ 来解释这些相似的计数。相比之下，错误模型（$\\mathcal{H}_0$）假设其中一条路径是罕见的假象，因此它预测的计数比例接近 $(1-\\epsilon) : \\epsilon/3$，即大约 $0.99 : 0.0033$。该模型下的期望计数（$\\hat{\\mu}_{A,0} \\approx 468, \\hat{\\mu}_{B,0} \\approx 2$）与观测计数截然不同。错误模型的这种拟合不佳导致其似然 $L_0$ 相对于 $L_1$ 非常小，从而得到一个非常大的正值 $-2\\ln\\Lambda$。\n极大的统计量值（$1971$）提供了压倒性的证据来拒绝错误假设，转而支持杂合假设。因此，该决策规则证明了保留该气泡是合理的，因为它几乎肯定代表了真实的生物变异（杂合性），而不是技术假象。", "answer": "$$\\boxed{1971}$$", "id": "4552729"}]}