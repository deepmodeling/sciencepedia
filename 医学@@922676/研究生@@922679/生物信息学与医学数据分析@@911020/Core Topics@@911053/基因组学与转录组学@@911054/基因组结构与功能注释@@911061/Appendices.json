{"hands_on_practices": [{"introduction": "评估是任何计算模型开发中不可或缺的一环。在开始构建复杂的基因组注释模型之前，我们必须首先掌握如何量化其性能。这项练习将引导您从第一性原理出发，计算基因预测任务中两种基本而关键的评估指标集：基于碱基的指标和基于特征的指标，从而深入理解精确率（precision）、召回率（recall）和F1分数在生物信息学背景下的具体含义。[@problem_id:4611315]", "problem": "一个结构基因组注释系统在单个连续的基因组位点上，与一个经过校订的基准参考（ground truth）进行比较评估。在结构注释中，外显子表示为具有整数坐标的闭合基因组区间，评估可以在碱基水平（逐个核苷酸）或特征水平（整个外显子对象）上进行。从基本原理出发：集合、整数坐标上的计数测度，以及混淆矩阵的定义。使用这些基本原理，形式化地定义碱基级精确率、碱基级召回率、精确率和召回率的碱基级调和平均数（F1 分数），以及基于明确匹配规则的特征级对应指标。然后，为给定的数据计算这些指标。\n\n使用的基本依据和定义如下：\n- 考虑一个位点，其整数坐标集为 $\\Omega \\subset \\mathbb{Z}$，并使用计数测度 $\\mu$。对于任意有限子集 $A \\subset \\Omega$，该测度赋予其值 $\\mu(A)$，等于 $A$ 中元素的数量。\n- 设基准参考外显子集为 $\\Omega$ 上的一个闭合区间的有限集合，$T = \\{[s_i, e_i]\\}_{i=1}^{n}$，其中 $s_i, e_i \\in \\mathbb{Z}$ 且 $s_i \\leq e_i$。基准参考所覆盖的碱基并集为 $U_T = \\bigcup_{i=1}^{n} [s_i, e_i]$。\n- 设预测外显子集为 $P = \\{[a_j, b_j]\\}_{j=1}^{m}$，预测所覆盖的碱基并集为 $U_P = \\bigcup_{j=1}^{m} [a_j, b_j]$。\n- 碱基级混淆计数由集合定义：真阳性碱基 $TP_{\\text{b}} = \\mu(U_P \\cap U_T)$，假阳性碱基 $FP_{\\text{b}} = \\mu(U_P \\setminus U_T)$，以及假阴性碱基 $FN_{\\text{b}} = \\mu(U_T \\setminus U_P)$。\n- 碱基级精确率为 $P_{\\text{b}} = \\frac{TP_{\\text{b}}}{TP_{\\text{b}} + FP_{\\text{b}}}$，碱基级召回率为 $R_{\\text{b}} = \\frac{TP_{\\text{b}}}{TP_{\\text{b}} + FN_{\\text{b}}}$，碱基级 F1 分数为 $F1_{\\text{b}} = \\frac{2 P_{\\text{b}} R_{\\text{b}}}{P_{\\text{b}} + R_{\\text{b}}}$。\n- 特征级评估将外显子视为原子特征。定义一个预测区间 $[a,b]$ 和一个基准参考区间 $[s,e]$ 之间的交并比（IoU），也称为 Jaccard 指数，为 $\\mathrm{IoU}([a,b],[s,e]) = \\frac{\\mu([a,b] \\cap [s,e])}{\\mu([a,b] \\cup [s,e])}$。使用一对一匹配协议：按 IoU 降序贪婪地构建匹配，每个预测外显子和每个基准参考外显子最多允许一个匹配，并且当且仅当其 IoU 至少为阈值 $\\tau = 0.5$ 时，才声明匹配有效。在此协议下，特征级真阳性 $TP_{\\text{f}}$ 是有效匹配的数量，特征级假阳性 $FP_{\\text{f}}$ 是未匹配的预测外显子的数量，特征级假阴性 $FN_{\\text{f}}$ 是未匹配的基准参考外显子的数量。\n- 特征级精确率为 $P_{\\text{f}} = \\frac{TP_{\\text{f}}}{TP_{\\text{f}} + FP_{\\text{f}}}$，特征级召回率为 $R_{\\text{f}} = \\frac{TP_{\\text{f}}}{TP_{\\text{f}} + FN_{\\text{f}}}$，特征级 F1 分数为 $F1_{\\text{f}} = \\frac{2 P_{\\text{f}} R_{\\text{f}}}{P_{\\text{f}} + R_{\\text{f}}}$。\n\n数据：\n- 基准参考外显子 $T$：$[1000,1199]$，$[1500,1699]$，$[2000,2199]$。\n- 预测外显子 $P$：$[995,1205]$，$[1600,1799]$，$[1900,2099]$，$[3000,3099]$。\n- 所有长度都包含端点计算：区间 $[x,y]$ 的长度为 $y - x + 1$。\n\n任务：\n1. 使用上述基本定义，计算 $TP_{\\text{b}}$、$FP_{\\text{b}}$ 和 $FN_{\\text{b}}$，然后计算 $P_{\\text{b}}$、$R_{\\text{b}}$ 和 $F1_{\\text{b}}$。\n2. 使用基于 IoU、阈值为 $\\tau = 0.5$ 的一对一匹配方法，计算 $TP_{\\text{f}}$、$FP_{\\text{f}}$ 和 $FN_{\\text{f}}$，然后计算 $P_{\\text{f}}$、$R_{\\text{f}}$ 和 $F1_{\\text{f}}$。\n\n将报告的每个指标四舍五入到四位有效数字，并以小数形式表示。按以下顺序报告您的六个指标：碱基级精确率、碱基级召回率、碱基级 F1 分数、特征级精确率、特征级召回率、特征级 F1 分数。", "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于标准的生物信息学评估方法，其定义和数据集完整且一致，问题是适定的，并以客观、正式的语言表达。可以从提供的信息中推导出唯一解。我们现在将按任务要求，分两部分进行解答。\n\n第 1 部分：碱基级评估\n\n基准参考注释包含一个由 $n=3$ 个外显子组成的集合 $T = \\{T_1, T_2, T_3\\}$，其中 $T_1 = [1000, 1199]$，$T_2 = [1500, 1699]$，$T_3 = [2000, 2199]$。预测注释包含一个由 $m=4$ 个外显子组成的集合 $P = \\{P_1, P_2, P_3, P_4\\}$，其中 $P_1 = [995, 1205]$，$P_2 = [1600, 1799]$，$P_3 = [1900, 2099]$，$P_4 = [3000, 3099]$。整数坐标集的测度是其基数，对于区间 $[x,y]$，测度为 $\\mu([x,y]) = y-x+1$。\n\n首先，我们计算基准参考中的总碱基数 $\\mu(U_T)$ 和预测中的总碱基数 $\\mu(U_P)$。集合 $T$ 中的区间是不相交的，集合 $P$ 中的区间也是不相交的。\n基准参考外显子的长度为：\n$\\mu(T_1) = 1199 - 1000 + 1 = 200$\n$\\mu(T_2) = 1699 - 1500 + 1 = 200$\n$\\mu(T_3) = 2199 - 2000 + 1 = 200$\n基准参考碱基的并集是 $U_T = T_1 \\cup T_2 \\cup T_3$，其测度为 $\\mu(U_T) = \\mu(T_1) + \\mu(T_2) + \\mu(T_3) = 200 + 200 + 200 = 600$。这对应于基准参考中的正例总数（$TP_{\\text{b}} + FN_{\\text{b}}$）。\n\n预测外显子的长度为：\n$\\mu(P_1) = 1205 - 995 + 1 = 211$\n$\\mu(P_2) = 1799 - 1600 + 1 = 200$\n$\\mu(P_3) = 2099 - 1900 + 1 = 200$\n$\\mu(P_4) = 3099 - 3000 + 1 = 100$\n预测碱基的并集是 $U_P = P_1 \\cup P_2 \\cup P_3 \\cup P_4$，其测度为 $\\mu(U_P) = \\mu(P_1) + \\mu(P_2) + \\mu(P_3) + \\mu(P_4) = 211 + 200 + 200 + 100 = 711$。这对应于预测的正例总数（$TP_{\\text{b}} + FP_{\\text{b}}$）。\n\n接下来，我们确定真阳性碱基的集合，即两个并集的交集 $U_P \\cap U_T$。我们计算组成区间的交集：\n$P_1 \\cap T_1 = [995, 1205] \\cap [1000, 1199] = [1000, 1199]$。其测度为 $\\mu([1000, 1199]) = 200$。\n$P_2 \\cap T_2 = [1600, 1799] \\cap [1500, 1699] = [1600, 1699]$。其测度为 $\\mu([1600, 1699]) = 100$。\n$P_3 \\cap T_3 = [1900, 2099] \\cap [2000, 2199] = [2000, 2099]$。其测度为 $\\mu([2000, 2099]) = 100$。\n来自 $P$ 和 $T$ 的所有其他区间对的交集均为空集。\n真阳性碱基的测度是这些不相交交集测度的总和：\n$TP_{\\text{b}} = \\mu(U_P \\cap U_T) = 200 + 100 + 100 = 400$。\n\n现在我们可以计算假阳性和假阴性碱基的数量：\n$FP_{\\text{b}} = \\mu(U_P \\setminus U_T) = \\mu(U_P) - \\mu(U_P \\cap U_T) = 711 - 400 = 311$。\n$FN_{\\text{b}} = \\mu(U_T \\setminus U_P) = \\mu(U_T) - \\mu(U_P \\cap U_T) = 600 - 400 = 200$。\n\n使用这些计数，我们计算碱基级精确率（$P_{\\text{b}}$）、召回率（$R_{\\text{b}}$）和 F1 分数（$F1_{\\text{b}}$）：\n$P_{\\text{b}} = \\frac{TP_{\\text{b}}}{TP_{\\text{b}} + FP_{\\text{b}}} = \\frac{400}{400 + 311} = \\frac{400}{711} \\approx 0.5625879...$\n$R_{\\text{b}} = \\frac{TP_{\\text{b}}}{TP_{\\text{b}} + FN_{\\text{b}}} = \\frac{400}{400 + 200} = \\frac{400}{600} = \\frac{2}{3} \\approx 0.666666...$\n$F1_{\\text{b}} = \\frac{2 P_{\\text{b}} R_{\\text{b}}}{P_{\\text{b}} + R_{\\text{b}}} = \\frac{2 TP_{\\text{b}}}{2 TP_{\\text{b}} + FP_{\\text{b}} + FN_{\\text{b}}} = \\frac{2 \\cdot 400}{2 \\cdot 400 + 311 + 200} = \\frac{800}{1311} \\approx 0.6102212...$\n\n四舍五入到四位有效数字，碱基级指标为：$P_{\\text{b}} = 0.5626$，$R_{\\text{b}} = 0.6667$，$F1_{\\text{b}} = 0.6102$。\n\n第 2 部分：特征级评估\n\n对于特征级评估，我们基于交并比（IoU）将预测的外显子与基准参考的外显子进行配对，阈值为 $\\tau = 0.5$。匹配是按 IoU 降序进行的一对一贪婪匹配。\n$\\mathrm{IoU}([a,b],[s,e]) = \\frac{\\mu([a,b] \\cap [s,e])}{\\mu([a,b] \\cup [s,e])} = \\frac{\\mu([a,b] \\cap [s,e])}{\\mu([a,b]) + \\mu([s,e]) - \\mu([a,b] \\cap [s,e])}$。\n\n我们为所有具有非空交集的配对 $(P_j, T_i)$ 计算 IoU：\n1. 对于 $(P_1, T_1)$：$\\mu(P_1 \\cap T_1) = 200$。$\\mu(P_1) = 211$，$\\mu(T_1) = 200$。\n   $\\mathrm{IoU}(P_1, T_1) = \\frac{200}{211 + 200 - 200} = \\frac{200}{211} \\approx 0.947867$。\n2. 对于 $(P_2, T_2)$：$\\mu(P_2 \\cap T_2) = 100$。$\\mu(P_2) = 200$，$\\mu(T_2) = 200$。\n   $\\mathrm{IoU}(P_2, T_2) = \\frac{100}{200 + 200 - 100} = \\frac{100}{300} = \\frac{1}{3} \\approx 0.333333$。\n3. 对于 $(P_3, T_3)$：$\\mu(P_3 \\cap T_3) = 100$。$\\mu(P_3) = 200$，$\\mu(T_3) = 200$。\n   $\\mathrm{IoU}(P_3, T_3) = \\frac{100}{200 + 200 - 100} = \\frac{100}{300} = \\frac{1}{3} \\approx 0.333333$。\n\n所有其他配对的交集为 $\\emptyset$，因此 IoU 为 $0$。\n非零 IoU 配对按降序排列的列表是：$(\\mathrm{IoU}(P_1, T_1) \\approx 0.9479)$，$(\\mathrm{IoU}(P_2, T_2) \\approx 0.3333)$，$(\\mathrm{IoU}(P_3, T_3) \\approx 0.3333)$。\n\n应用贪婪匹配协议：\n1. 最高的 IoU 是 $\\mathrm{IoU}(P_1, T_1) \\approx 0.9479$，大于阈值 $\\tau=0.5$。我们接受这是一个有效匹配。$P_1$ 和 $T_1$ 现在被视为已匹配。\n2. 第二高的 IoU 是 $\\mathrm{IoU}(P_2, T_2) \\approx 0.3333$，小于 $\\tau=0.5$。这不是一个有效匹配。\n3. 接下来最高的 IoU 是 $\\mathrm{IoU}(P_3, T_3) \\approx 0.3333$，也小于 $\\tau=0.5$。这不是一个有效匹配。\n\n因此，只有一个有效匹配：$(P_1, T_1)$。我们现在计算特征级混淆计数：\n$TP_{\\text{f}}$ = 有效匹配数 = $1$。\n$FP_{\\text{f}}$ = 未匹配的预测外显子数 = $|\\{P_2, P_3, P_4\\}| = 3$。\n$FN_{\\text{f}}$ = 未匹配的基准参考外显子数 = $|\\{T_2, T_3\\}| = 2$。\n预测总数为 $m = TP_{\\text{f}} + FP_{\\text{f}} = 1 + 3 = 4$。基准参考特征总数为 $n = TP_{\\text{f}} + FN_{\\text{f}} = 1 + 2 = 3$。这些计数是一致的。\n\n使用这些计数，我们计算特征级精确率（$P_{\\text{f}}$）、召回率（$R_{\\text{f}}$）和 F1 分数（$F1_{\\text{f}}$）：\n$P_{\\text{f}} = \\frac{TP_{\\text{f}}}{TP_{\\text{f}} + FP_{\\text{f}}} = \\frac{1}{1 + 3} = \\frac{1}{4} = 0.25$。\n$R_{\\text{f}} = \\frac{TP_{\\text{f}}}{TP_{\\text{f}} + FN_{\\text{f}}} = \\frac{1}{1 + 2} = \\frac{1}{3} \\approx 0.333333...$\n$F1_{\\text{f}} = \\frac{2 P_{\\text{f}} R_{\\text{f}}}{P_{\\text{f}} + R_{\\text{f}}} = \\frac{2 \\cdot (1/4) \\cdot (1/3)}{(1/4) + (1/3)} = \\frac{2/12}{7/12} = \\frac{2}{7} \\approx 0.285714...$\n\n四舍五入到四位有效数字，特征级指标为：$P_{\\text{f}} = 0.2500$，$R_{\\text{f}} = 0.3333$，$F1_{\\text{f}} = 0.2857$。\n\n最终指标总结：\n碱基级精确率 ($P_{\\text{b}}$): $0.5626$\n碱基级召回率 ($R_{\\text{b}}$): $0.6667$\n碱基级 F1 ($F1_{\\text{b}}$): $0.6102$\n特征级精确率 ($P_{\\text{f}}$): $0.2500$\n特征级召回率 ($R_{\\text{f}}$): $0.3333$\n特征级 F1 ($F1_{\\text{f}}$): $0.2857$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5626 & 0.6667 & 0.6102 & 0.2500 & 0.3333 & 0.2857\n\\end{pmatrix}\n}\n$$", "id": "4611315"}, {"introduction": "真实的基因组数据往往充满噪声和来自不同实验证据的矛盾信号。一个强大的注释流程不仅需要预测，更需要一套做出最优决策的原则性框架。本练习将向您介绍如何运用贝叶斯决策理论，在一个外显子边界存在争议的实际场景中，通过整合先验知识、似然估计和非对称损失函数，来解决RNA测序与蛋白质同源比对之间的证据冲突。[@problem_id:4611300]", "problem": "在一个结构和功能基因组注释下的一个基因模型中，存在一个有争议的单一外显子边界，对此有两种相互竞争的假设：由核糖核酸测序（RNA-seq）建议的边界，记为 $H_{R}$，以及由蛋白质同源性比对建议的边界，记为 $H_{P}$。注释流程必须在给定的损失函数下选择一个边界以最大化预期准确性，而已知观测证据 $d$ 来自RNA-seq剪接连接点和蛋白质同源性比对分数。\n\n使用以下基本原理：\n- 分子生物学中心法则指出，基因编码信使核糖核酸（mRNA），后者翻译成蛋白质。外显子边界决定了编码框；错误的注释可能导致移码或功能域截短。\n- 贝叶斯决策理论：后验概率由贝叶斯定理给出，最优行动旨在最小化预期损失。形式上，后验优势比满足 $$\\frac{P(H_{R}\\,|\\,d)}{P(H_{P}\\,|\\,d)}=\\frac{\\pi_{R}}{\\pi_{P}} \\cdot \\frac{p(d\\,|\\,H_{R})}{p(d\\,|\\,H_{P})},$$ 其中 $\\pi_{R}$ 和 $\\pi_{P}$ 是先验概率， $p(d\\,|\\,H)$ 是在假设 $H$ 下证据的似然。\n\n假设在给定真实边界的情况下，RNA-seq和蛋白质同源性证据是条件独立的，因此 $$p(d\\,|\\,H)=p(d_{\\mathrm{RNA}}\\,|\\,H)\\cdot p(d_{\\mathrm{PROT}}\\,|\\,H).$$ 先验概率由剪接基序强度和比较基因组学信息确定：$$\\pi_{R}=0.6,\\quad \\pi_{P}=0.4.$$ 在每种假设下观测数据 $d$ 的似然，由一个校准过的关于连接点读取计数和比对分数的生成模型估计得出，分别为：\n- RNA-seq连接点证据：$$p(d_{\\mathrm{RNA}}\\,|\\,H_{R})=0.92,\\quad p(d_{\\mathrm{RNA}}\\,|\\,H_{P})=0.12.$$\n- 蛋白质同源性证据：$$p(d_{\\mathrm{PROT}}\\,|\\,H_{R})=0.35,\\quad p(d_{\\mathrm{PROT}}\\,|\\,H_{P})=0.78.$$\n\n由于潜在的移码与框内截短的后果不同，损失函数对错误选择的惩罚是不对称的：\n- 当 $H_{P}$ 为真时选择 $H_{R}$，损失为 $$L(H_{R},H_{P})=9.$$\n- 当 $H_{R}$ 为真时选择 $H_{P}$，损失为 $$L(H_{P},H_{R})=3.$$\n- 选择真实边界的损失为零：$$L(H_{R},H_{R})=0,\\quad L(H_{P},H_{P})=0.$$\n\n任务：\n1. 从贝叶斯定理和预期损失的定义出发，推导一个决策规则，该规则能根据后验优势比 $\\frac{P(H_{R}\\,|\\,d)}{P(H_{P}\\,|\\,d)}$ 和损失比率来最小化预期损失。\n2. 使用提供的先验概率和似然，计算后验优势比，并应用该决策规则来选择最优边界。\n3. 将你的最终选择表示为一个无单位的单一数字：如果最优行动是选择RNA-seq支持的边界 $H_{R}$，则输出 $0$；如果最优行动是选择蛋白质同源性支持的边界 $H_{P}$，则输出 $1$。\n\n最终选择无需四舍五入。所有步骤必须基于所述基本原理进行论证，不得援引任何未提供的快捷公式。", "solution": "首先根据指定标准验证问题陈述。\n\n### 步骤1：提取已知条件\n- **假设**：$H_{R}$（来自RNA-seq的边界），$H_{P}$（来自蛋白质同源性的边界）。\n- **证据**：$d = (d_{\\mathrm{RNA}}, d_{\\mathrm{PROT}})$。\n- **贝叶斯框架**：\n  - 后验优势比：$\\frac{P(H_{R}\\,|\\,d)}{P(H_{P}\\,|\\,d)}=\\frac{\\pi_{R}}{\\pi_{P}} \\cdot \\frac{p(d\\,|\\,H_{R})}{p(d\\,|\\,H_{P})}$。\n  - 条件独立性：$p(d\\,|\\,H)=p(d_{\\mathrm{RNA}}\\,|\\,H)\\cdot p(d_{\\mathrm{PROT}}\\,|\\,H)$。\n- **先验概率**：$\\pi_{R} = P(H_{R}) = 0.6$，$\\pi_{P} = P(H_{P}) = 0.4$。\n- **RNA-seq证据（$d_{\\mathrm{RNA}}$）的似然**：\n  - $p(d_{\\mathrm{RNA}}\\,|\\,H_{R}) = 0.92$。\n  - $p(d_{\\mathrm{RNA}}\\,|\\,H_{P}) = 0.12$。\n- **蛋白质同源性证据（$d_{\\mathrm{PROT}}$）的似然**：\n  - $p(d_{\\mathrm{PROT}}\\,|\\,H_{R}) = 0.35$。\n  - $p(d_{\\mathrm{PROT}}\\,|\\,H_{P}) = 0.78$。\n- **损失函数（$L(\\text{行动}, \\text{真实情况})$）**：\n  - $L(H_{R}, H_{P}) = 9$。\n  - $L(H_{P}, H_{R}) = 3$。\n  - $L(H_{R}, H_{R}) = 0$。\n  - $L(H_{P}, H_{P}) = 0$。\n- **任务**：\n  1. 推导一个决策规则以最小化预期损失。\n  2. 计算后验优势比并应用该规则。\n  3. 为选择 $H_{R}$ 输出 $0$ 或为选择 $H_{P}$ 输出 $1$。\n\n### 步骤2：使用提取的已知条件进行验证\n问题评估如下：\n- **科学基础**：该问题基于生物信息学和分子生物学的原理，特别是基因组注释。使用贝叶斯决策理论来整合来自RNA-seq和蛋白质同源性的冲突证据是一种标准且科学上合理的方法。\n- **良态问题**：该问题是良态的。它提供了所有必要信息：一个完备的假设集、总和为 $1$ 的先验概率（$0.6 + 0.4 = 1$）、在每个假设下关于证据的一整套似然，以及一个明确定义的损失函数。任务是具体的，并导向一个唯一的、可计算的解。\n- **客观性**：该问题以精确、量化和客观的语言陈述，没有歧义或主观论断。\n\n该问题未表现出任何列举的无效性缺陷。它在科学上是合理的，形式上是明确的，是完整的，并且在逻辑上是一致的。\n\n### 步骤3：结论与行动\n该问题有效。下面提供完整解答。\n\n### 任务1：决策规则的推导\n\n目标是选择一个行动（选择 $H_R$ 或选择 $H_P$），以最小化预期损失。期望是在给定观测证据 $d$ 的条件下，对所有可能的自然真实状态（$H_R$ 或 $H_P$）进行计算。为此，我们使用后验概率 $P(H_{R}\\,|\\,d)$ 和 $P(H_{P}\\,|\\,d)$。\n\n选择行动 $H_R$ 的预期损失，记为 $E[L|a=H_R]$，是：\n$$ E[L\\,|\\,a=H_{R}] = L(H_{R}, H_{R}) \\cdot P(H_{R}\\,|\\,d) + L(H_{R}, H_{P}) \\cdot P(H_{P}\\,|\\,d) $$\n鉴于 $L(H_{R}, H_{R}) = 0$，这简化为：\n$$ E[L\\,|\\,a=H_{R}] = L(H_{R}, H_{P}) \\cdot P(H_{P}\\,|\\,d) $$\n\n选择行动 $H_P$ 的预期损失，记为 $E[L|a=H_P]$，是：\n$$ E[L\\,|\\,a=H_{P}] = L(H_{P}, H_{R}) \\cdot P(H_{R}\\,|\\,d) + L(H_{P}, H_{P}) \\cdot P(H_{P}\\,|\\,d) $$\n鉴于 $L(H_{P}, H_{P}) = 0$，这简化为：\n$$ E[L\\,|\\,a=H_{P}] = L(H_{P}, H_{R}) \\cdot P(H_{R}\\,|\\,d) $$\n\n为了最小化预期损失，如果选择行动 $H_R$ 的预期损失小于选择 $H_P$ 的预期损失，我们应选择 $H_R$。也就是说，我们选择 $H_R$ 如果：\n$$ E[L\\,|\\,a=H_{R}] < E[L\\,|\\,a=H_{P}] $$\n代入预期损失的表达式：\n$$ L(H_{R}, H_{P}) \\cdot P(H_{P}\\,|\\,d) < L(H_{P}, H_{R}) \\cdot P(H_{R}\\,|\\,d) $$\n为了以后验优势比的形式表示，我们重排不等式。由于后验概率和损失都是非负的，并假设 $P(H_{P}\\,|\\,d) > 0$ 和 $L(H_{P}, H_{R}) > 0$，我们可以进行除法而不改变不等式的方向：\n$$ \\frac{L(H_{R}, H_{P})}{L(H_{P}, H_{R})} < \\frac{P(H_{R}\\,|\\,d)}{P(H_{P}\\,|\\,d)} $$\n这就是所求的决策规则：如果支持 $H_R$ 的后验优势比大于错误决策的损失比率，则选择 $H_R$。反之，如果后验优势比小于损失比率，则选择 $H_P$。\n\n### 任务2：决策规则的计算与应用\n\n首先，我们根据给定的损失函数计算损失比率：\n$$ \\text{损失比率} = \\frac{L(H_{R}, H_{P})}{L(H_{P}, H_{R})} = \\frac{9}{3} = 3 $$\n所以，决策规则是：如果 $\\frac{P(H_{R}\\,|\\,d)}{P(H_{P}\\,|\\,d)} > 3$，则选择 $H_R$。\n\n接下来，我们使用提供的公式和数据计算后验优势比。后验优势比是先验优势比和贝叶斯因子（似然比）的乘积。\n先验优势比是：\n$$ \\frac{\\pi_{R}}{\\pi_{P}} = \\frac{0.6}{0.4} = 1.5 $$\n贝叶斯因子 $BF$ 是似然比，由于证据的条件独立性，它是：\n$$ BF = \\frac{p(d\\,|\\,H_{R})}{p(d\\,|\\,H_{P})} = \\frac{p(d_{\\mathrm{RNA}}\\,|\\,H_{R}) \\cdot p(d_{\\mathrm{PROT}}\\,|\\,H_{R})}{p(d_{\\mathrm{RNA}}\\,|\\,H_{P}) \\cdot p(d_{\\mathrm{PROT}}\\,|\\,H_{P})} $$\n代入给定的似然值：\n$$ BF = \\frac{0.92 \\cdot 0.35}{0.12 \\cdot 0.78} = \\frac{0.322}{0.0936} $$\n现在，我们计算后验优势比：\n$$ \\frac{P(H_{R}\\,|\\,d)}{P(H_{P}\\,|\\,d)} = \\frac{\\pi_{R}}{\\pi_{P}} \\cdot BF = 1.5 \\cdot \\frac{0.322}{0.0936} = \\frac{0.483}{0.0936} $$\n为了将此值与损失比率 $3$ 进行比较，我们可以进行除法运算：\n$$ \\frac{0.483}{0.0936} \\approx 5.16025... $$\n或者，我们可以在不进行除法的情况下进行比较：\n$\\frac{0.483}{0.0936} > 3$ 是否成立？\n这等价于询问 $0.483 > 3 \\cdot 0.0936$ 是否成立。\n$3 \\cdot 0.0936 = 0.2808$。\n因为 $0.483 > 0.2808$，所以不等式成立。\n\n后验优势比（$\\approx 5.16$）大于损失比率（$3$）。\n根据我们推导的决策规则，最优行动是选择RNA-seq支持的边界 $H_R$。\n\n### 任务3：最终选择\n问题规定如果最优行动是选择 $H_R$，则输出 $0$；如果最优行动是选择 $H_P$，则输出 $1$。由于我们的分析得出结论，选择 $H_R$ 是最小化预期损失的最优行动，因此最终输出是 $0$。", "answer": "$$\\boxed{0}$$", "id": "4611300"}, {"introduction": "掌握了评估和决策的基本方法后，我们可以将这些理念扩展到一个完整的分类系统中。这项练习要求您构建一个朴素贝叶斯分类器，用于区分细菌基因组中的染色体、质粒和前噬菌体序列，这是一个在微生物基因组学中常见的实际任务。您将学习如何将覆盖度、GC含量和功能蛋白命中数等多种生物学特征整合到一个统一的概率模型中，以实现对基因组元件的自动化、原则性分类。[@problem_id:4611389]", "problem": "您的任务是形式化并实现一个原则性的流程，用于结构和功能基因组注释，以便将细菌基因组组装中的重叠群（contig）分为三类之一：染色体、质粒或前噬菌体。您的流程必须源于基因组学和统计学的基础原则，并且只能依赖以下经过实验验证的事实、公式和假设：\n\n- 脱氧核糖核酸（DNA）测序中每个位点的覆盖深度近似与样本中基础分子的拷贝数成正比；在稳定的文库制备条件下，由于作图变异和局部偏差，每个重叠群的平均覆盖度可以近似为一个高斯（正态）分布，其均值和标准差依赖于类别。\n- 根据中心极限定理（CLT），一个足够长的重叠群的鸟嘌呤-胞嘧啶（GC）含量比例可以建模为近似高斯分布，其均值和标准差依赖于类别，反映了成分的异质性。\n- 每个重叠群中噬菌体标志性蛋白的命中数可以建模为一个泊松过程，其速率（单位：每千碱基，kb）依赖于类别，并按重叠群的长度（单位：千碱基）进行缩放。\n\n在条件独立性假设（朴素贝叶斯）下构建一个贝叶斯分类器：给定一个带特征的重叠群，将覆盖度、GC含量和噬菌体蛋白命中数视为在给定类别下条件独立的。对于每个类别，计算后验分数，该分数与先验概率乘以在该类别下观测到特征的似然的乘积成正比。使用对数后验分数以避免数值下溢，并预测具有最大对数后验分数的类别。\n\n您的分类器必须使用以下类条件模型和先验，这些模型和先验是固定的，并通过对宿主的先前校准而预先已知：\n\n- 类别：染色体、质粒、前噬菌体。将这些编码为整数：染色体 $\\to$ $0$，质粒 $\\to$ $1$，前噬菌体 $\\to$ $2$。\n- 先验：$P(\\text{染色体}) = 0.75$, $P(\\text{质粒}) = 0.20$, $P(\\text{前噬菌体}) = 0.05$。\n- 覆盖深度模型（重叠群的平均覆盖度，单位为$x$-fold；无单位）：\n  - 染色体：$\\mathcal{N}(\\mu = 60, \\sigma = 6)$。\n  - 质粒：$\\mathcal{N}(\\mu = 180, \\sigma = 18)$。\n  - 前噬菌体：$\\mathcal{N}(\\mu = 60, \\sigma = 6)$。\n- GC含量模型（比例在 $[0,1]$ 之间，以小数表示）：\n  - 染色体：$\\mathcal{N}(\\mu = 0.51, \\sigma = 0.015)$。\n  - 质粒：$\\mathcal{N}(\\mu = 0.44, \\sigma = 0.03)$。\n  - 前噬菌体：$\\mathcal{N}(\\mu = 0.47, \\sigma = 0.02)$。\n- 噬菌体蛋白命中模型（命中计数，无量纲），建模为泊松分布，其均值等于特定类别的每千碱基速率乘以重叠群长度（千碱基）：\n  - 染色体：速率 $\\lambda = 0.01$ 每kb。\n  - 质粒：速率 $\\lambda = 0.04$ 每kb。\n  - 前噬菌体：速率 $\\lambda = 0.60$ 每kb。\n\n使用的数学定义：\n- 如果 $X$ 是均值为 $\\mu$、标准差为 $\\sigma$ 的高斯分布，则其概率密度函数为\n  $$f_{X}(x \\mid \\mu, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)。$$\n- 如果 $K$ 是均值为 $\\lambda$ 的泊松分布，则其概率质量函数为\n  $$\\Pr(K = k \\mid \\lambda) = \\frac{\\lambda^{k} e^{-\\lambda}}{k!}。$$\n- 在朴素贝叶斯假设下，对于先验 $P(C)$ 和给定类别 $C$ 的独立特征 $F_{1},F_{2},F_{3}$，后验概率正比于\n  $$P(C \\mid F_{1},F_{2},F_{3}) \\propto P(C)\\, p(F_{1} \\mid C)\\, p(F_{2} \\mid C)\\, p(F_{3} \\mid C)。$$\n- 为保证数值稳定性，使用对数分数：\n  $$\\log \\text{score}(C) = \\log P(C) + \\log p(\\text{覆盖度} \\mid C) + \\log p(\\text{GC} \\mid C) + \\log p(\\text{命中数} \\mid C),$$\n  其中 $\\log p(\\text{覆盖度} \\mid C)$ 和 $\\log p(\\text{GC} \\mid C)$ 是高斯对数密度，$\\log p(\\text{命中数} \\mid C)$ 是泊松对数质量。类别预测为 $\\arg \\max_{C} \\log \\text{score}(C)$。\n\n实现一个程序，对下面测试套件中的每个重叠群，使用上述模型计算预测的类别代码（整数），并按照“最终输出格式”的规定，将所有预测结果作为单个列表在一行上打印。无需用户输入。\n\n输入特征的单位和约束：\n- 重叠群长度必须以千碱基（kb）为单位。\n- 平均覆盖深度以 $x$-fold 为单位（无单位）。\n- GC含量必须是 $[0,1]$ 区间内的小数。\n- 噬菌体命中数是一个非负整数。\n\n重叠群测试套件（每个以元组 $(L_{\\text{kb}}, \\text{覆盖度}, \\text{GC}, \\text{命中数})$ 形式表示）：\n- 案例 $1$：$(200, 62, 0.51, 1)$。\n- 案例 $2$：$(50, 170, 0.43, 3)$。\n- 案例 $3$：$(40, 58, 0.46, 28)$。\n- 案例 $4$：$(30, 65, 0.45, 1)$。\n- 案例 $5$：$(20, 185, 0.46, 10)$。\n- 案例 $6$：$(5, 135, 0.45, 0)$。\n\n覆盖范围设计：\n- 包括一个标准的“理想”染色体类情况（案例1）。\n- 包括一个标准的“理想”质粒类情况（案例2）。\n- 包括一个标准的“理想”前噬菌体类情况（案例3）。\n- 包括边缘条件：GC含量变化但覆盖度无变化（案例4），高覆盖度与大量噬菌体命中数之间的冲突（案例5），以及一个非常短且噬菌体命中数为零的重叠群（案例6）。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个由逗号分隔的整数列表，并用方括号括起来，例如 $[0,1,2]$。\n- 使用类别编码：染色体 $= 0$，质粒 $= 1$，前噬菌体 $= 2$。", "solution": "用户提供了一个生物信息学问题，要求构建并实现一个用于基因组重叠群的朴素贝叶斯分类器。我将首先根据指定标准验证问题陈述，然后在验证通过后提供完整的解决方案。\n\n### 步骤1：提取给定信息\n\n- **任务**：将基因组重叠群分为三类之一：染色体、质粒或前噬菌体。\n- **分类器模型**：朴素贝叶斯，假设特征在给定类别下条件独立。\n- **类别和编码**：染色体 $\\to 0$，质粒 $\\to 1$，前噬菌体 $\\to 2$。\n- **先验概率**：\n    - $P(\\text{染色体}) = 0.75$\n    - $P(\\text{质粒}) = 0.20$\n    - $P(\\text{前噬菌体}) = 0.05$\n- **特征1：平均覆盖深度（$x_{\\text{cov}}$）**：通过高斯分布 $\\mathcal{N}(\\mu, \\sigma)$ 建模。\n    - 染色体 ($C=0$): $\\mathcal{N}(\\mu = 60, \\sigma = 6)$。\n    - 质粒 ($C=1$): $\\mathcal{N}(\\mu = 180, \\sigma = 18)$。\n    - 前噬菌体 ($C=2$): $\\mathcal{N}(\\mu = 60, \\sigma = 6)$。\n- **特征2：GC含量（$x_{\\text{GC}}$）**：通过高斯分布 $\\mathcal{N}(\\mu, \\sigma)$ 建模。\n    - 染色体 ($C=0$): $\\mathcal{N}(\\mu = 0.51, \\sigma = 0.015)$。\n    - 质粒 ($C=1$): $\\mathcal{N}(\\mu = 0.44, \\sigma = 0.03)$。\n    - 前噬菌体 ($C=2$): $\\mathcal{N}(\\mu = 0.47, \\sigma = 0.02)$。\n- **特征3：噬菌体蛋白命中数（$k_{\\text{hits}}$）**：通过泊松分布建模，其均值为 $\\lambda_C \\cdot L_{\\text{kb}}$，其中 $L_{\\text{kb}}$ 是以千碱基为单位的重叠群长度。\n    - 染色体 ($C=0$): 速率 $\\lambda = 0.01$ 每 kb。\n    - 质粒 ($C=1$): 速率 $\\lambda = 0.04$ 每 kb。\n    - 前噬菌体 ($C=2$): 速率 $\\lambda = 0.60$ 每 kb。\n- **数学公式**：\n    - 高斯PDF: $f_{X}(x \\mid \\mu, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$。\n    - 泊松PMF: $\\Pr(K = k \\mid \\lambda) = \\frac{\\lambda^{k} e^{-\\lambda}}{k!}$。\n    - 用于分类的对数分数：$\\log \\text{score}(C) = \\log P(C) + \\log p(\\text{覆盖度} \\mid C) + \\log p(\\text{GC} \\mid C) + \\log p(\\text{命中数} \\mid C)$。\n    - 预测规则: $\\arg \\max_{C} \\log \\text{score}(C)$。\n- **测试套件**：一组6个重叠群，每个由元组 $(L_{\\text{kb}}, \\text{覆盖度}, \\text{GC}, \\text{命中数})$ 定义。\n    - 案例1：($200$, $62$, $0.51$, $1$)\n    - 案例2：($50$, $170$, $0.43$, $3$)\n    - 案例3：($40$, $58$, $0.46$, $28$)\n    - 案例4：($30$, $65$, $0.45$, $1$)\n    - 案例5：($20$, $185$, $0.46$, $10$)\n    - 案例6：($5$, $135$, $0.45$, $0$)\n\n### 步骤2：使用提取的给定信息进行验证\n\n根据指定标准对问题进行严格验证。\n\n- **科学基础（关键）**：该问题在科学上是合理的。使用覆盖深度、GC含量和噬菌体特异性蛋白计数是微生物基因组学中区分染色体、质粒和前噬菌体的标准、经验上合理的特征。为这些特征选择高斯和泊松分布也是有充分根据的，分别由中心极限定理和计数数据的性质所证明。\n- **适定性**：该问题是适定的。它为所有特征提供了完整的先验概率集和类条件概率分布。目标被明确定义为最大化对数后验分数，这保证了每个测试用例解的存在性和唯一性。\n- **客观性（关键）**：该问题以精确、定量和无偏见的语言陈述。所有参数都以固定的数值给出，没有主观解释的余地。\n- **缺陷清单**：\n    1.  **科学/事实不健全**：无。前提与基因组学和统计学的既定原则一致。\n    2.  **不可形式化/不相关**：无。该问题是在指定的功能基因组结构和功能注释领域内贝叶斯分类的一个形式化和典型的应用。\n    3.  **不完整/矛盾的设置**：无。所有必要信息（先验、模型参数、测试数据）均已提供，且无矛盾。\n    4.  **不现实/不可行**：无。测试套件中的参数值和特征值都在合理的生物学范围内。\n    5.  **不适定/结构不良**：无。问题结构是一个具有唯一解的经典分类任务。\n    6.  **伪深刻/琐碎**：无。该问题需要正确应用统计学原理，并非琐碎。测试用例包括了非显而易见的情景，用于测试模型的鲁棒性。\n    7.  **超出科学可验证范围**：无。该方法是标准的，结果是确定性的且可验证。\n\n### 步骤3：结论与行动\n\n该问题**有效**。它是一个定义明确、有科学依据且可形式化的计算生物学任务。我现在将着手构建解决方案。\n\n### 原则性解决方案\n\n目标是将一个由其特征 $(L_{\\text{kb}}, x_{\\text{cov}}, x_{\\text{GC}}, k_{\\text{hits}})$ 描述的基因组重叠群分类到三个类别 $C \\in \\{0, 1, 2\\}$ 中的一个，分别对应于染色体、质粒和前噬菌体。我们采用朴素贝叶斯分类器，该分类器计算给定观测特征下每个类别的后验概率，并选择概率最高的类别。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$P(C \\mid \\text{特征}) = \\frac{P(\\text{特征} \\mid C) P(C)}{P(\\text{特征})}$$\n由于 $P(\\text{特征})$ 是一个对所有类别都相同的归一化常数，我们可以在最大化时忽略它。任务简化为找到使似然与先验的乘积 $P(\\text{特征} \\mid C) P(C)$ 最大化的类别 $C$。\n\n“朴素”的条件独立性假设允许我们将似然表示为单个特征似然的乘积：\n$$P(\\text{特征} \\mid C) = p(x_{\\text{cov}} \\mid C) \\cdot p(x_{\\text{GC}} \\mid C) \\cdot p(k_{\\text{hits}} \\mid C)$$\n为了防止因乘以多个小概率而导致的数值下溢，并为计算方便，我们使用分数的对数。因此，决策规则是：\n$$\\hat{C} = \\arg\\max_{C} \\left( \\log P(C) + \\log p(x_{\\text{cov}} \\mid C) + \\log p(x_{\\text{GC}} \\mid C) + \\log p(k_{\\text{hits}} \\mid C) \\right)$$\n其中 $\\hat{C}$ 是预测的类别。\n\n各个对数似然分量由指定的分布导出：\n\n1.  **高斯对数概率密度函数**：对于一个服从 $\\mathcal{N}(\\mu, \\sigma)$ 的特征 $x$，其对数PDF为：\n    $$\\log p(x \\mid \\mu, \\sigma) = \\log\\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)\\right) = -\\frac{1}{2}\\log(2\\pi) - \\log(\\sigma) - \\frac{(x - \\mu)^2}{2\\sigma^2}$$\n    此公式用于计算覆盖度 $\\log p(x_{\\text{cov}} \\mid C)$ 和GC含量 $\\log p(x_{\\text{GC}} \\mid C)$ 的对数似然，使用特定类别的参数 $(\\mu_C, \\sigma_C)$。\n\n2.  **泊松对数概率质量函数**：对于一个服从均值为 $\\lambda$ 的泊松分布的特征 $k$，其对数PMF为：\n    $$\\log \\Pr(K=k \\mid \\lambda) = \\log\\left(\\frac{\\lambda^{k} e^{-\\lambda}}{k!}\\right) = k \\log(\\lambda) - \\lambda - \\log(k!)$$\n    对于噬菌体命中数特征，均值 $\\lambda$ 依赖于类别和长度：$\\lambda_C = \\text{rate}_C \\times L_{\\text{kb}}$。项 $\\log(k!)$ 可以使用对数伽马函数高效计算，即 $\\log(k!) = \\texttt{lgamma}(k+1)$。\n\n对于测试套件中的每个重叠群，算法按以下步骤进行：\n1.  为3个类别中的每一个初始化一个分数。\n2.  对于每个类别 $C \\in \\{0, 1, 2\\}$：\n    a. 从对数先验概率 $\\log P(C)$ 开始。\n    b. 使用类别 $C$ 的参数，通过高斯对数PDF计算观测到的平均覆盖度 $x_{\\text{cov}}$ 的对数似然。将其加到分数上。\n    c. 使用类别 $C$ 的参数，通过高斯对数PDF计算观测到的GC含量 $x_{\\text{GC}}$ 的对数似然。将其加到分数上。\n    d. 计算泊松均值 $\\lambda_C = \\text{rate}_C \\times L_{\\text{kb}}$。\n    e. 使用均值为 $\\lambda_C$ 的泊松对数PMF计算观测到的噬菌体蛋白命中数 $k_{\\text{hits}}$ 的对数似然。将其加到分数上。\n3.  比较所有三个类别的最终对数后验分数。具有最大分数的类别即为该重叠群的预测类别。\n\n此过程将被实现并应用于所有6个测试用例，以生成最终的预测列表。使用对数分数和基于第一性原理的直接计算，确保了忠实于问题定义的稳健而准确的实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Implements a naive Bayes classifier for genomic contigs based on provided\n    statistical models and parameters.\n    \"\"\"\n\n    # Define the class-conditional models and priors as per the problem statement.\n    # Classes: 0: chromosome, 1: plasmid, 2: prophage\n    PARAMS = {\n        0: {\n            \"name\": \"chromosome\",\n            \"prior\": 0.75,\n            \"coverage\": {\"mu\": 60, \"sigma\": 6},\n            \"gc\": {\"mu\": 0.51, \"sigma\": 0.015},\n            \"phage_rate\": 0.01\n        },\n        1: {\n            \"name\": \"plasmid\",\n            \"prior\": 0.20,\n            \"coverage\": {\"mu\": 180, \"sigma\": 18},\n            \"gc\": {\"mu\": 0.44, \"sigma\": 0.03},\n            \"phage_rate\": 0.04\n        },\n        2: {\n            \"name\": \"prophage\",\n            \"prior\": 0.05,\n            \"coverage\": {\"mu\": 60, \"sigma\": 6},\n            \"gc\": {\"mu\": 0.47, \"sigma\": 0.02},\n            \"phage_rate\": 0.60\n        }\n    }\n\n    # Pre-calculate log priors for efficiency\n    LOG_PRIORS = {\n        class_id: np.log(params[\"prior\"]) for class_id, params in PARAMS.items()\n    }\n\n    # Define the test suite of contigs.\n    # Each tuple is (L_kb, coverage, GC_fraction, phage_hits).\n    test_cases = [\n        (200, 62, 0.51, 1),    # Case 1\n        (50, 170, 0.43, 3),    # Case 2\n        (40, 58, 0.46, 28),    # Case 3\n        (30, 65, 0.45, 1),     # Case 4\n        (20, 185, 0.46, 10),   # Case 5\n        (5, 135, 0.45, 0)      # Case 6\n    ]\n\n    def log_gaussian_pdf(x, mu, sigma):\n        \"\"\"\n        Calculates the log of the Gaussian Probability Density Function.\n        log p(x|mu, sigma) = -0.5*log(2*pi) - log(sigma) - (x - mu)^2 / (2*sigma^2)\n        \"\"\"\n        # The constant -0.5 * np.log(2 * np.pi) can be omitted for maximization,\n        # but is included here for formal correctness.\n        log_prob = -0.5 * np.log(2 * np.pi) - np.log(sigma) - 0.5 * ((x - mu) / sigma)**2\n        return log_prob\n\n    def log_poisson_pmf(k, rate, length_kb):\n        \"\"\"\n        Calculates the log of the Poisson Probability Mass Function.\n        log P(K=k|lambda) = k*log(lambda) - lambda - log(k!)\n        \"\"\"\n        lambda_val = rate * length_kb\n        \n        # Handle edge case where lambda is 0.\n        # If lambda = 0, P(k=0) = 1 (log(P) = 0), and P(k>0) = 0 (log(P) = -inf).\n        if lambda_val == 0:\n            return 0.0 if k == 0 else -np.inf\n\n        # The term -gammaln(k + 1) is -log(k!). It is constant for a given k\n        # across classes, but included for formal correctness.\n        log_prob = k * np.log(lambda_val) - lambda_val - gammaln(k + 1)\n        return log_prob\n\n    results = []\n    for case in test_cases:\n        L_kb, coverage, gc, hits = case\n        log_posterior_scores = {}\n\n        for class_id, params in PARAMS.items():\n            # 1. Start with log prior\n            log_score = LOG_PRIORS[class_id]\n\n            # 2. Add log-likelihood for coverage\n            cov_params = params[\"coverage\"]\n            log_score += log_gaussian_pdf(coverage, cov_params[\"mu\"], cov_params[\"sigma\"])\n\n            # 3. Add log-likelihood for GC fraction\n            gc_params = params[\"gc\"]\n            log_score += log_gaussian_pdf(gc, gc_params[\"mu\"], gc_params[\"sigma\"])\n\n            # 4. Add log-likelihood for phage protein hits\n            phage_rate = params[\"phage_rate\"]\n            log_score += log_poisson_pmf(hits, phage_rate, L_kb)\n\n            log_posterior_scores[class_id] = log_score\n\n        # Find the class with the maximum log-posterior score\n        predicted_class = max(log_posterior_scores, key=log_posterior_scores.get)\n        results.append(predicted_class)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4611389"}]}