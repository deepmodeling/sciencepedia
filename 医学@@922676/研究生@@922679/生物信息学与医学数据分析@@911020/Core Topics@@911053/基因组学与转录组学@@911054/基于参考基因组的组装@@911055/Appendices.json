{"hands_on_practices": [{"introduction": "在规划任何测序项目时，一个首要问题是：“我们需要多少测序数据？”。本练习将引导你运用一个基础模型，将平均测序深度（$ \\lambda $）与基因组组装中出现覆盖空白（gap）的概率联系起来。通过这个实践，你将从根本上理解为什么高测序覆盖度对于获得一个完整、无间断的共识序列至关重要 ([@problem_id:4604752])。", "problem": "在生物信息学和医学数据分析领域的基于参考的基因组组装中，源自新一代测序（NGS）比对的每碱基读段覆盖度通常被建模为一个计数过程。假设一个长度为 $L$ 的基因组，有 $N$ 个长度为 $\\ell$ 的独立读段，其起始位置在参考基因组上均匀分布，并假设比对是完美且独立的。考虑一个固定的位点，并令 $X$ 表示覆盖该位点的读段数量。在 $N \\to \\infty$ 和 $\\ell/L \\to 0$ 且 $N(\\ell/L) \\to \\lambda$ 的极限情况下，该过程被建模为极限期望每碱基覆盖度为 $\\lambda$。仅使用泊松过程的公理或从上述抽样模型出发的二项分布到泊松分布的极限论证，推导该位点覆盖度为零（即 $X=0$）的概率，结果表示为 $\\lambda$ 的一个闭式解析函数。将您的最终答案表示为关于 $\\lambda$ 的精确表达式。然后，讨论在均匀性假设下，该概率对于根据参考构建的共有序列中成为缺口的位点的期望比例有何影响。不需要进行数值评估，也无需四舍五入；仅提供以 $\\lambda$ 表示的概率的闭式解析表达式。", "solution": "问题陈述已经过验证，并且被认为是合理的。它在科学上基于生物信息学和概率论的原理，特别是用于鸟枪法测序的 Lander-Waterman 模型。该问题定义明确、客观，并包含进行严谨推导所需的所有必要信息。\n\n我们的任务是在一组建模假设和特定的极限条件下，推导某个特定位点出现零覆盖的概率。让我们将该模型形式化。\n\n基因组总长度为 $L$。我们考虑 $N$ 个独立读段，每个读段的长度为 $\\ell$。每个读段的起始位置从基因组上的一个均匀分布中选择。对于一个固定的位点，我们用 $i$ 表示其位置。如果一个读段的起始位置 $s$ 落在区间 $[i - \\ell + 1, i]$ 内，则该读段覆盖此位点。这个区间的长度是 $\\ell$。假设边缘效应可以忽略不计（因为 $L \\gg \\ell$ 这是合理的），单个随机放置的读段覆盖该位点的概率 $p$ 是目标区间长度与基因组总长度的比值：\n$$p = \\frac{\\ell}{L}$$\n这 $N$ 个读段中的每一个都代表一次独立的伯努利试验，其中“成功”定义为读段覆盖了特定位点。因此，计算覆盖该位点的读段数的随机变量 $X$ 服从参数为 $N$ 和 $p$ 的二项分布：\n$$X \\sim \\text{Binomial}(N, p)$$\n$X$ 的概率质量函数由下式给出：\n$$P(X=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n我们关心的是该位点覆盖度为零的概率，这对应于 $k=0$ 的情况。将 $k=0$ 代入二项分布的概率质量函数，我们得到：\n$$P(X=0) = \\binom{N}{0} p^0 (1-p)^{N-0}$$\n由于 $\\binom{N}{0} = 1$ 且 $p^0 = 1$ (对于 $p \\neq 0$)，上式简化为：\n$$P(X=0) = (1-p)^{N}$$\n代入 $p$ 的表达式：\n$$P(X=0) = \\left(1 - \\frac{\\ell}{L}\\right)^N$$\n问题指定了一个极限条件，其中 $N \\to \\infty$，$\\frac{\\ell}{L} \\to 0$，而乘积 $N \\left(\\frac{\\ell}{L}\\right)$ 收敛到一个有限正常数 $\\lambda$。这个常数 $\\lambda$ 被定义为极限期望每碱基覆盖度。这是二项分布的泊松近似的特征条件。\n\n让我们在这些条件下评估 $P(X=0)$ 的极限。我们可以用 $N$ 和极限值 $\\lambda$ 来表示 $\\frac{\\ell}{L}$。对于大的 $N$，我们有近似值 $\\frac{\\ell}{L} \\approx \\frac{\\lambda}{N}$。将其代入我们对 $P(X=0)$ 的表达式中：\n$$P(X=0) \\approx \\left(1 - \\frac{\\lambda}{N}\\right)^N$$\n极限下的确切概率通过计算以下极限得到：\n$$\\lim_{N \\to \\infty} \\left(1 - \\frac{\\ell}{L}\\right)^N = \\lim_{N \\to \\infty} \\left(1 - \\frac{N(\\ell/L)}{N}\\right)^N$$\n当 $N \\to \\infty$ 时，项 $N(\\ell/L)$ 趋近于 $\\lambda$。因此，极限变为：\n$$\\lim_{N \\to \\infty} \\left(1 - \\frac{\\lambda}{N}\\right)^N$$\n这是指数函数的一个标准极限定义。具体来说，对于任何实数 $x$，$\\lim_{n \\to \\infty} (1 + \\frac{x}{n})^n = \\exp(x)$。在我们的例子中，$x = -\\lambda$。因此，零覆盖的极限概率是：\n$$P(X=0) = \\exp(-\\lambda)$$\n这个结果表明，在指定的高通量测序模型下，覆盖任何给定碱基的读段数可以很好地由均值为 $\\lambda$ 的泊松分布来描述，这个结果被称为 Lander-Waterman 模型。观测到 $k$ 个读段的概率是 $P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，对于 $k=0$ 的情况，我们恢复得到 $P(X=0) = \\exp(-\\lambda)$。\n\n问题的第二部分要求探讨这个概率对于共有序列中成为缺口的位点的期望比例有何影响。在基于参考的组装中，“缺口”是指没有读段比对上的位置，导致无法确定该位置的核苷酸。这恰好对应于一个位点的覆盖度为 $X=0$ 的情况。\n\n在模型的均匀性假设下，控制覆盖度的随机过程对于基因组中的每个位点都是相同的（忽略边界效应）。因此，单个任意选择的位点具有零覆盖的概率对于所有位点都是相同的。根据期望的线性性，整个基因组中具有零覆盖的位点的期望比例等于任何单个位点具有零覆盖的概率。\n设 $I_j$ 为一个指示随机变量，如果位点 $j$ 的覆盖度为零，则 $I_j=1$，否则 $I_j=0$。其概率为 $P(I_j=1) = P(X_j=0) = \\exp(-\\lambda)$，其中 $X_j$ 是位点 $j$ 的覆盖度。缺口的总数是 $\\sum_{j=1}^L I_j$。缺口的期望数量是 $E[\\sum_{j=1}^L I_j] = \\sum_{j=1}^L E[I_j] = \\sum_{j=1}^L P(I_j=1) = L \\exp(-\\lambda)$。\n成为缺口的位点的期望比例是这个数字除以位点总数 $L$：\n$$\\text{Expected Fraction of Gaps} = \\frac{L \\exp(-\\lambda)}{L} = \\exp(-\\lambda)$$\n因此，表达式 $\\exp(-\\lambda)$ 直接量化了序列组装的期望完整性。对于给定的期望完整性水平（即较低的缺口比例），可以确定所需的平均覆盖深度 $\\lambda$。例如，要确保缺口的期望比例低于 $1\\%$（即 $0.01$），必须达到的覆盖度 $\\lambda$ 需满足 $\\exp(-\\lambda)  0.01$，这意味着 $\\lambda > -\\ln(0.01) \\approx 4.6$。这是规划测序实验时使用的一个基本原则。", "answer": "$$\\boxed{\\exp(-\\lambda)}$$", "id": "4604752"}, {"introduction": "获得足够的测序覆盖度后，下一步是将读长（reads）比对到参考基因组上，但并非所有比对都同样可靠。本练习将演示比对软件如何运用贝叶斯原理，将比对得分转换为作图质量（MAPQ）值，该值是衡量比对错误可能性的标准化指标。掌握这一技能对于过滤低质量数据和确保下游分析的准确性至关重要 ([@problem_id:4604740])。", "problem": "在一个人体全基因组重测序的参考基因组组装流程中，一个单端读段（single-end read）对参考基因组产生了两个候选比对：得分最高的候选者，其比对分数为$s_{1}$，以及得分次高的候选者，其分数为$s_{2}$。假设已使用标准的仿射空位罚分方案来产生$s_{1}$和$s_{2}$，并且从大型训练集中学到的经验校准为最高比对与次高比对之间的竞争决策提供了一个分数到似然度的关系。具体而言，该校准指出，支持“最高比对是正确比对”这一假设相对于“次高比对是正确比对”这一假设的似然比为\n$$\n\\Lambda(s_{1}, s_{2}) = \\exp\\!\\big(\\lambda\\,(s_{1}-s_{2})\\big).\n$$\n该读段起源于基因组中一个中等可比对性（mappability）的区域，先验分析表明，在观察到分数差异之前，在这两个候选者中，最高比对是正确位点的先验概率为$\\pi$，产生的先验优势比为$O_{\\text{prior}} = \\pi/(1-\\pi)$。利用基本概率原理，计算在给定观察到的分数和校准的情况下，最高比对是正确的后验概率，然后将此后验概率转换为序列比对/图（Sequence Alignment/Map, SAM）格式中使用的比对质量（Mapping Quality, MAPQ）。对于本问题，将比对质量（MAPQ）定义为\n$$\n\\mathrm{MAPQ} = -10\\,\\log_{10}\\!\\big(P_{\\text{error}}\\big),\n$$\n其中$P_{\\text{error}}$是最高比对不正确的后验概率。\n\n请使用以下具体数值进行计算，这些数值是现代短读段比对器的代表性值：$s_{1} = 173$，$s_{2} = 152$，$\\lambda = 0.25$和$\\pi = 0.85$。以单个实数形式提供最终的MAPQ值。将最终答案四舍五入到三位有效数字。MAPQ是无量纲的。", "solution": "任务是计算最高比对是正确的后验概率，然后将后验错误概率转换为对数尺度上的比对质量（MAPQ）。推导必须依赖于核心概率定义和贝叶斯定理。\n\n从以优势比（odds）形式表达的贝叶斯定理开始。令$H_{1}$表示最高比对是正确的假设，令$H_{2}$表示次高比对是正确的假设。先验优势比为\n$$\nO_{\\text{prior}} = \\frac{P(H_{1})}{P(H_{2})} = \\frac{\\pi}{1-\\pi}.\n$$\n给定由比对分数$(s_{1}, s_{2})$概括的观测数据，校准提供了似然比\n$$\n\\Lambda(s_{1}, s_{2}) = \\frac{P\\big((s_{1}, s_{2}) \\mid H_{1}\\big)}{P\\big((s_{1}, s_{2}) \\mid H_{2}\\big)} = \\exp\\!\\big(\\lambda\\,(s_{1}-s_{2})\\big).\n$$\n后验优势比则由先验优势比和似然比的乘积给出，\n$$\nO_{\\text{post}} = O_{\\text{prior}} \\times \\Lambda(s_{1}, s_{2}).\n$$\n$H_{1}$为真的后验概率是\n$$\nP(H_{1} \\mid s_{1}, s_{2}) = \\frac{O_{\\text{post}}}{1 + O_{\\text{post}}}.\n$$\n因此，最高比对的后验错误概率是\n$$\nP_{\\text{error}} = 1 - P(H_{1} \\mid s_{1}, s_{2}) = \\frac{1}{1 + O_{\\text{post}}}.\n$$\n最后，比对质量（MAPQ）定义为\n$$\n\\mathrm{MAPQ} = -10\\,\\log_{10}\\!\\big(P_{\\text{error}}\\big) = -10\\,\\log_{10}\\!\\left(\\frac{1}{1 + O_{\\text{post}}}\\right).\n$$\n\n我们现在代入给定的数值。首先计算先验优势比：\n$$\nO_{\\text{prior}} = \\frac{\\pi}{1-\\pi} = \\frac{0.85}{0.15} = \\frac{17}{3}.\n$$\n使用校准计算似然比：\n$$\n\\Lambda(s_{1}, s_{2}) = \\exp\\!\\big(\\lambda\\,(s_{1}-s_{2})\\big) = \\exp\\!\\big(0.25\\,(173 - 152)\\big) = \\exp\\!\\left(0.25 \\times 21\\right) = \\exp\\!\\left(\\frac{21}{4}\\right).\n$$\n因此，后验优势比为\n$$\nO_{\\text{post}} = \\frac{17}{3}\\,\\exp\\!\\left(\\frac{21}{4}\\right).\n$$\n后验错误概率为\n$$\nP_{\\text{error}} = \\frac{1}{1 + O_{\\text{post}}} = \\frac{1}{1 + \\frac{17}{3}\\,\\exp\\!\\left(\\frac{21}{4}\\right)}.\n$$\n因此，\n$$\n\\mathrm{MAPQ} = -10\\,\\log_{10}\\!\\left(\\frac{1}{1 + \\frac{17}{3}\\,\\exp\\!\\left(\\frac{21}{4}\\right)}\\right) = 10\\,\\log_{10}\\!\\left(1 + \\frac{17}{3}\\,\\exp\\!\\left(\\frac{21}{4}\\right)\\right).\n$$\n\n对于所要求的数值，计算指数并完成计算。首先，\n$$\n\\exp\\!\\left(\\frac{21}{4}\\right) = \\exp(5.25) \\approx 190.512.\n$$\n因此，\n$$\nO_{\\text{post}} \\approx \\frac{17}{3} \\times 190.512 \\approx 1079.568,\n$$\n并且\n$$\nP_{\\text{error}} \\approx \\frac{1}{1 + 1079.568} = \\frac{1}{1080.568} \\approx 9.254 \\times 10^{-4}.\n$$\n最后，\n$$\n\\mathrm{MAPQ} = -10\\,\\log_{10}\\!\\big(9.254 \\times 10^{-4}\\big) = -10\\left(\\log_{10}(9.254) - 4\\right) \\approx -10\\left(0.9667 - 4\\right) \\approx 30.33.\n$$\n四舍五入到三位有效数字，比对质量为$30.3$。", "answer": "$$\\boxed{30.3}$$", "id": "4604740"}, {"introduction": "参考基因组组装的最终目标之一是确定目标样本的真实序列，但这并非总是简单的“少数服从多数”投票。本练习将展示一个精密的贝叶斯模型如何通过整合碱基质量和作图质量信息，得出比朴素投票法更准确的共识碱基。这个例子突显了在处理复杂和矛盾的测序数据时，概率推理的强大力量 ([@problem_id:4604819])。", "problem": "在基于参考的基因组组装中，每个位置的一致性碱基是根据比对到参考基因组上的短读长来决定的。通常会对比两种决策规则：多数投票一致性，即选择在观测到的碱基检出中计数最多的碱基；以及贝叶斯一致性，即在给定读长质量和比对不确定性的情况下，选择具有最大后验概率的碱基。考虑一个具有两个候选碱基——腺嘌呤（A）和鸟嘌呤（G）的基因组位点。一组短读长已比对到该位点，它们具有不同的碱基质量和比对质量。假设以下基本要素：\n- Phred碱基质量 $Q$ 将碱基检出错误的概率 $e$ 编码为 $e = 10^{-Q/10}$。\n- Phred比对质量 $M$ 将不正确比对（错误比对）的概率 $m$ 编码为 $m = 10^{-M/10}$。\n- 在给定真实碱基且读长被正确比对的条件下，测序仪以概率 $1 - e$ 输出正确的碱基，并以概率 $e/3$ 输出其他三种碱基中的任意一种。\n- 在给定读长被错误比对的条件下，输出的碱基与该位点的真实碱基无关，并在 $\\{A,C,G,T\\}$ 上均匀分布，每种碱基的概率为 $1/4$。\n- 在给定真实碱基的条件下，各读长是条件独立的，并且在 $\\{A,G\\}$ 上的先验是均匀分布的。\n\n观测数据包含比对到该位点的 $6$ 个读长，其碱基检出和质量如下：\n- 读长 $1$：碱基检出 $A$，碱基质量 $Q = 10$，比对质量 $M = 10$。\n- 读长 $2$：碱基检出 $A$，碱基质量 $Q = 12$，比对质量 $M = 12$。\n- 读长 $3$：碱基检出 $A$，碱基质量 $Q = 15$，比对质量 $M = 12$。\n- 读长 $4$：碱基检出 $A$，碱基质量 $Q = 10$，比对质量 $M = 7$。\n- 读长 $5$：碱基检出 $G$，碱基质量 $Q = 35$，比对质量 $M = 40$。\n- 读长 $6$：碱基检出 $G$，碱基质量 $Q = 35$，比对质量 $M = 40$。\n\n任务：\n1. 从上述定义和独立性假设出发，对于给定的候选真实碱基，构建单个读长的似然函数，并推导出每个读长的似然比作为 $e$ 和 $m$ 的函数。利用这一点，推导一个条件，在该条件下，多数投票一致性（此处选择 $A$，因为有 $4$ 个读长检出为 $A$ 对比 $2$ 个检出为 $G$）与贝叶斯一致性不一致，即尽管大多数碱基检出为 $A$，后验概率却支持 $G$。用这 $6$ 个读长的似然比的乘积来表示这个条件。\n2. 使用给定的 $Q$ 和 $M$ 值，计算该位点真实碱基为 $G$ 的贝叶斯后验概率。将最终数值答案四舍五入到四位有效数字，并以小数形式表示（不带百分号）。", "solution": "该问题要求比较多数投票一致性和贝叶斯一致性在确定特定基因组位点真实碱基时的差异。我们将首先根据任务1的要求推导贝叶斯一致性的数学框架，然后将其应用于给定数据以计算任务2的后验概率。\n\n令 $B_{true}$ 为该位点的真实碱基，其为腺嘌呤（$A$）或鸟嘌呤（$G$）。第 $i$ 个读长的观测数据为 $R_i = (B_{obs, i}, Q_i, M_i)$，其中 $B_{obs, i}$ 是观测到的碱基检出，$Q_i$ 是Phred碱基质量，$M_i$ 是Phred比对质量。先验概率是均匀的，所以 $P(B_{true}=A) = P(B_{true}=G) = 1/2$。\n\n真实碱基的后验概率由贝叶斯定理给出。对于真实碱基为 $G$ 的情况，我们有：\n$$P(B_{true}=G | D) = \\frac{P(D | B_{true}=G) P(B_{true}=G)}{P(D)}$$\n其中 $D = \\{R_1, \\dots, R_6\\}$ 是所有观测数据的集合。由于先验是均匀的，最大化后验概率等同于最大化似然 $P(D | B_{true})$。\n\n**任务1：似然公式和不一致性条件**\n\n首先，我们为单个读长 $R_i$ 构建似然函数 $L_i(B_{true}) = P(R_i | B_{true})$。读长观测到的碱基 $B_{obs, i}$ 取决于该读长是否正确比对到该位点。令 $C_i$ 为读长 $i$ 被正确比对的事件，$\\bar{C}_i$ 为其被错误比对的事件。错误比对的概率由比对质量 $M_i$ 给出，为 $m_i = 10^{-M_i/10}$。因此，$P(\\bar{C}_i) = m_i$ 且 $P(C_i) = 1 - m_i$。\n\n通过对映状态进行边缘化得到似然：\n$$P(B_{obs, i} | B_{true}, Q_i, M_i) = P(B_{obs, i} | B_{true}, Q_i, C_i)P(C_i) + P(B_{obs, i} | B_{true}, Q_i, \\bar{C}_i)P(\\bar{C}_i)$$\n\n各项定义如下：\n-   $P(B_{obs, i} | B_{true}, Q_i, C_i)$：如果正确比对，碱基检出错误的概率为 $e_i = 10^{-Q_i/10}$。\n    -   如果 $B_{obs, i} = B_{true}$，概率为 $1 - e_i$。\n    -   如果 $B_{obs, i} \\neq B_{true}$，概率为 $e_i/3$。\n-   $P(B_{obs, i} | B_{true}, Q_i, \\bar{C}_i)$：如果错误比对，观测到的碱基是均匀随机的，因此无论 $B_{true}$ 为何，概率均为 $1/4$。\n\n将这些代入似然公式，对于给定的读长 $i$ 和假设的真实碱基 $B_{true}$，可得到两种情况：\n\n1.  如果 $B_{obs, i} = B_{true}$：\n    $$L_i(B_{true}) = (1 - e_i)(1 - m_i) + \\frac{1}{4}m_i$$\n2.  如果 $B_{obs, i} \\neq B_{true}$：\n    $$L_i(B_{true}) = \\left(\\frac{e_i}{3}\\right)(1 - m_i) + \\frac{1}{4}m_i$$\n\n每个读长的似然比为 $\\lambda_i = L_i(G) / L_i(A)$。\n-   对于 $B_{obs, i}=A$ 的读长：\n    $$L_i(A) = (1 - e_i)(1 - m_i) + \\frac{1}{4}m_i$$\n    $$L_i(G) = \\left(\\frac{e_i}{3}\\right)(1 - m_i) + \\frac{1}{4}m_i$$\n    $$\\lambda_i = \\frac{(e_i/3)(1 - m_i) + m_i/4}{(1 - e_i)(1 - m_i) + m_i/4}$$\n-   对于 $B_{obs, i}=G$ 的读长：\n    $$L_i(A) = \\left(\\frac{e_i}{3}\\right)(1 - m_i) + \\frac{1}{4}m_i$$\n    $$L_i(G) = (1 - e_i)(1 - m_i) + \\frac{1}{4}m_i$$\n    $$\\lambda_i = \\frac{(1 - e_i)(1 - m_i) + m_i/4}{(e_i/3)(1 - m_i) + m_i/4}$$\n\n观测数据中有4个读长检出为A，2个读长检出为G。因此，多数投票一致性结果为A。如果G的后验概率大于A的后验概率，即 $P(B_{true}=G | D)  P(B_{true}=A | D)$，则贝叶斯一致性将与此不一致（即结果为G）。在均匀先验下，这个不等式成立当且仅当G的总似然大于A的总似然：$P(D|B_{true}=G)  P(D|B_{true}=A)$。\n\n由于在给定真实碱基的条件下各读长是条件独立的，总似然是单个读长似然的乘积：$P(D|B_{true}) = \\prod_{i=1}^6 L_i(B_{true})$。该条件变为：\n$$\\prod_{i=1}^6 L_i(G)  \\prod_{i=1}^6 L_i(A)$$\n两边同除以右侧（其为正数），得到以各读长似然比乘积表示的条件：\n$$\\prod_{i=1}^6 \\lambda_i = \\prod_{i=1}^6 \\frac{L_i(G)}{L_i(A)}  1$$\n这就是多数投票一致性与贝叶斯一致性不一致的条件。\n\n**任务2：贝叶斯后验概率的计算**\n\n我们需要计算 $P(B_{true}=G | D)$。这可以用总似然比 $\\Lambda = \\prod_{i=1}^6 \\lambda_i$ 来表示：\n$$P(B_{true}=G | D) = \\frac{P(D|G)P(G)}{P(D|G)P(G) + P(D|A)P(A)} = \\frac{P(D|G)}{P(D|G) + P(D|A)} = \\frac{\\Lambda}{\\Lambda + 1}$$\n我们现在通过计算 $6$ 个读长中每个读长的 $\\lambda_i$ 来计算 $\\Lambda$。\n\n-   **读长 1:** $B_{obs}=A$, $Q=10$, $M=10$。\n    $e_1 = 10^{-10/10} = 0.1$, $m_1 = 10^{-10/10} = 0.1$。\n    $L_1(A) = (1-0.1)(1-0.1) + \\frac{0.1}{4} = 0.9 \\times 0.9 + 0.025 = 0.835$。\n    $L_1(G) = (\\frac{0.1}{3})(1-0.1) + \\frac{0.1}{4} = \\frac{0.09}{3} + 0.025 = 0.055$。\n    $\\lambda_1 = 0.055 / 0.835 \\approx 0.065868$。\n\n-   **读长 2:** $B_{obs}=A$, $Q=12$, $M=12$。\n    $e_2 = 10^{-12/10} = 10^{-1.2}$, $m_2 = 10^{-12/10} = 10^{-1.2}$。\n    $L_2(A) = (1-10^{-1.2})(1-10^{-1.2}) + \\frac{10^{-1.2}}{4} \\approx 0.893563$。\n    $L_2(G) = (\\frac{10^{-1.2}}{3})(1-10^{-1.2}) + \\frac{10^{-1.2}}{4} \\approx 0.035480$。\n    $\\lambda_2 \\approx 0.035480 / 0.893563 \\approx 0.039704$。\n\n-   **读长 3:** $B_{obs}=A$, $Q=15$, $M=12$。\n    $e_3 = 10^{-15/10} = 10^{-1.5}$, $m_3 = 10^{-12/10} = 10^{-1.2}$。\n    $L_3(A) = (1-10^{-1.5})(1-10^{-1.2}) + \\frac{10^{-1.2}}{4} \\approx 0.922978$。\n    $L_3(G) = (\\frac{10^{-1.5}}{3})(1-10^{-1.2}) + \\frac{10^{-1.2}}{4} \\approx 0.025650$。\n    $\\lambda_3 \\approx 0.025650 / 0.922978 \\approx 0.027791$。\n\n-   **读长 4:** $B_{obs}=A$, $Q=10$, $M=7$。\n    $e_4 = 10^{-10/10} = 0.1$, $m_4 = 10^{-7/10} = 10^{-0.7}$。\n    $L_4(A) = (1-0.1)(1-10^{-0.7}) + \\frac{10^{-0.7}}{4} \\approx 0.770308$。\n    $L_4(G) = (\\frac{0.1}{3})(1-10^{-0.7}) + \\frac{10^{-0.7}}{4} \\approx 0.076565$。\n    $\\lambda_4 \\approx 0.076565 / 0.770308 \\approx 0.099395$。\n\n-   **读长 5:** $B_{obs}=G$, $Q=35$, $M=40$。\n    $e_5 = 10^{-35/10} = 10^{-3.5}$, $m_5 = 10^{-40/10} = 10^{-4}$。\n    $L_5(A) = (\\frac{10^{-3.5}}{3})(1-10^{-4}) + \\frac{10^{-4}}{4} \\approx 0.00013040$。\n    $L_5(G) = (1-10^{-3.5})(1-10^{-4}) + \\frac{10^{-4}}{4} \\approx 0.999609$。\n    $\\lambda_5 \\approx 0.999609 / 0.00013040 \\approx 7665.65$。\n\n-   **读长 6:** $B_{obs}=G$, $Q=35$, $M=40$。\n    该读长与读长5相同，所以 $\\lambda_6 = \\lambda_5 \\approx 7665.65$。\n\n现在我们计算总似然比 $\\Lambda$：\n$$\\Lambda = \\lambda_1 \\times \\lambda_2 \\times \\lambda_3 \\times \\lambda_4 \\times \\lambda_5 \\times \\lambda_6$$\n$$\\Lambda \\approx (0.065868) \\times (0.039704) \\times (0.027791) \\times (0.099395) \\times (7665.65)^2$$\n$$\\Lambda \\approx (7.224 \\times 10^{-6}) \\times (5.876 \\times 10^7) \\approx 424.5$$\n由于 $\\Lambda \\approx 424.5  1$，不一致的条件得到满足。\n\n最后，我们计算真实碱基为G的后验概率：\n$$P(B_{true}=G | D) = \\frac{\\Lambda}{\\Lambda + 1} \\approx \\frac{424.5}{424.5 + 1} = \\frac{424.5}{425.5}$$\n$$P(B_{true}=G | D) \\approx 0.9976498$$\n将此结果四舍五入到四位有效数字，得到 $0.9976$。", "answer": "$$\\boxed{0.9976}$$", "id": "4604819"}]}