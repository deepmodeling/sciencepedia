{"hands_on_practices": [{"introduction": "要有效评估基因组组装的质量，我们必须首先掌握其基础评价指标。第一个练习将引导您逐步计算 $N_{50}$ 统计量，这是组装质量评估的基石。通过一个具体的小例子，您将从第一性原理出发，巩固对 $N_{50}$ 如何量化组装连续性的理解 [@problem_id:4540123]。", "problem": "在用于宏基因组分析的临床生物信息学流程中，一个基因组草图组装由一组 contig 长度的多重集表示。质量评估通常需要通过一个阈值统计量来概括长度分布，该统计量描述了最长的 contig 覆盖了多少组装结果。从以下基本原则出发：(i) 组装总长度是所有 contig 长度的总和，以及 (ii) 累积覆盖度是通过按长度对 contig 进行排序并累加其长度得到的。基于这些原则，首先为统计量 $N_{50}$ 提供一个严格的定义，将其定义为从 contig 长度的累积分布中导出的长度加权阈值。然后，对于以碱基对 (bp) 为单位的特定 contig 长度 $[800,\\,200,\\,300,\\,700,\\,500]$，执行以下操作：\n\n- 论证为什么应按非递增长度对 contig 进行排序，以构建从最长到最短的累积覆盖度函数。\n- 计算组装总长度以及与总长度的 $\\frac{1}{2}$ 相对应的覆盖目标。\n- 按照所论证的顺序累加长度，直到达到覆盖目标，并确定正式对应于 $N_{50}$ 的阈值长度。\n\n将最终结果表示为单个整数，单位为碱基对 (bp)。无需四舍五入。不要用中间公式代替定义；从给定的基本原则推导出 $N_{50}$，并展示计算的每一步。", "solution": "该问题陈述具有科学依据、提法恰当且客观。它提供了一组清晰的 contig 长度，并要求计算一个标准的、定义明确的生物信息学指标 $N_{50}$。所有必要信息均已提供，没有矛盾或含糊之处。该问题是有效的。\n\n我们首先根据所提供的基本原则来形式化定义 $N_{50}$ 统计量。设包含 $n$ 个 contig 长度的多重集为 $L = \\{l_1, l_2, \\dots, l_n\\}$。\n\n首先，根据问题中的第一个基本原则，组装总长度 $L_{total}$ 是所有单个 contig 长度的总和。\n$$L_{total} = \\sum_{i=1}^{n} l_i$$\n\n其次，为了评估最长 contig 的贡献，我们必须按特定顺序排列这些长度。设 $L' = \\{l'_1, l'_2, \\dots, l'_n\\}$ 是从多重集 $L$ 中按非递增顺序排序的 contig 长度序列，使得 $l'_1 \\ge l'_2 \\ge \\dots \\ge l'_n$。\n\n根据这个有序序列，我们可以定义一个累积长度函数 $C(k)$，它表示 $k$ 个最长 contig 的长度之和：\n$$C(k) = \\sum_{i=1}^{k} l'_i$$\n\n$N_{50}$ 统计量是一个长度加权的阈值。它被定义为：在能共同覆盖至少 $50\\%$（或分数 $\\frac{1}{2}$）组装总长度的最长 contig 的最小集合中，最短 contig 的长度。为找到此值，我们必须首先确定一个最小整数索引，我们称之为 $k_{50}$，使得累积和 $C(k)$ 达到或超过 $\\frac{1}{2}L_{total}$ 的覆盖目标。\n$$k_{50} = \\min \\left\\{ k \\in \\{1, \\dots, n\\} \\mid \\sum_{i=1}^{k} l'_i \\ge \\frac{1}{2} L_{total} \\right\\}$$\n$N_{50}$ 的值就恰好是排序后列表 $L'$ 中位于此索引 $k_{50}$ 处的 contig 的长度。\n$$N_{50} = l'_{k_{50}}$$\n\n现在我们将此形式化步骤应用于给定的数据。\n\n**按非递增长度排序的理由**\n像 $N_{50}$ 这样的指标旨在评估组装的连续性。一个由少数非常长的 contig 组成的组装，通常被认为比一个由许多短 contig 组成的组装质量更高，即使它们的总长度相同。通过从最长到最短对 contig 进行排序，我们优先考虑了上述的长 contig。按此顺序构建累积和直接回答了这样一个问题：“使得所有长度等于或大于该长度的 contig 加起来能覆盖基因组一半的最小 contig 长度是多少？” 这为 contig 长度分布的高值区提供了一个单一数值的摘要，而这对于评估质量最为相关。按递增顺序求和将回答一个关于最短 contig 贡献的不同且信息量较少的问题。\n\n**计算**\n给定的 contig 长度多重集为 $L = \\{800, 200, 300, 700, 500\\}$，单位为碱基对 (bp)。\n\n1.  **计算组装总长度 ($L_{total}$):**\n    $$L_{total} = 800 + 200 + 300 + 700 + 500 = 2500 \\text{ bp}$$\n\n2.  **计算覆盖目标:**\n    目标是组装总长度的 $\\frac{1}{2}$。\n    $$\\text{目标} = \\frac{1}{2} L_{total} = \\frac{1}{2} \\times 2500 \\text{ bp} = 1250 \\text{ bp}$$\n\n3.  **按非递增长度对 contig 进行排序并累加:**\n    首先，我们对 $L$ 中的长度进行排序，以创建有序序列 $L'$。\n    $$L' = \\{800, 700, 500, 300, 200\\}$$\n    接下来，我们按此顺序累加长度，并与 $1250$ bp 的目标进行比较。\n    -   加上第一个 contig ($l'_1 = 800$): 累积长度为 $C(1) = 800$。这小于 $1250$ bp 的目标。\n    -   加上第二个 contig ($l'_2 = 700$): 累积长度为 $C(2) = 800 + 700 = 1500$。这个值 $1500$ 达到并超过了 $1250$ bp 的目标。\n\n4.  **确定 $N_{50}$ 值:**\n    当我们包含第二个 contig ($k_{50}=2$) 时，累积和首次达到目标。根据定义，$N_{50}$ 统计量是越过阈值时加入的最后一个 contig 的长度。\n    $$N_{50} = l'_{k_{50}} = l'_2 = 700$$\n    因此，此组装的 $N_{50}$ 为 $700$ bp。", "answer": "$$\\boxed{700}$$", "id": "4540123"}, {"introduction": "摘要统计量功能强大，但如果脱离具体情境解读，也可能产生误导。本练习设定了一个场景，比较了两个总长度相同但结构截然不同的组装结果。通过计算和对比 $N_{50}$ 与 $L_{90}$ 这两个指标，您将学会批判性地分析不同组装特征之间的权衡，并理解为何多维度质量控制至关重要 [@problem_id:4540052]。", "problem": "一个临床生物信息学团队评估了两个源自肿瘤基因组样本的基因组组装草图，以了解其结构连续性，并为下游的变异分析提供信息。在基因组组装评估中，重叠群（contig）按长度从长到短排序，组装总跨度是所有重叠群长度的总和，而连续性指标则基于该有序列表计算。根据组装评估中使用的标准定义：$N_{50}$统计量（百分之五十重叠群长度统计量）是指，在一个有序的重叠群列表中，其累积跨度达到总组装跨度至少一半的最小前缀中，最短的那个重叠群的长度。$L_{90}$统计量（百分之九十跨度重叠群计数）是指，在有序列表中，累积长度达到总组装跨度至少十分之九所需的最少重叠群数量。这两个组装的重叠群长度多重集分别为 $A:[3000, 3000, 3000]$ 和 $B:[8000, 500, 500]$，其中每个数字表示以碱基对为单位的长度。根据这些定义，计算组装 $A$ 和 $B$ 的 $N_{50}$ 和 $L_{90}$ 值。然后，从基本原理出发，阐明这些指标所揭示的，在以少数极长重叠群为特征的组装与具有更均衡分布的组装之间的权衡，并特别关注 $\\left(N_{50}, L_{90}\\right)$ 这对指标如何共同制约其在医学数据分析中的可解释性和下游应用价值。所有重叠群长度以碱基对表示，所有计数以无单位整数表示。如果出现任何非整数，则四舍五入至四位有效数字。以单行矩阵的形式提供最终答案，顺序为 $\\left(N_{50}(A), L_{90}(A), N_{50}(B), L_{90}(B)\\right)$。", "solution": "用户提供的问题已根据指定标准进行评估，并被确定为有效。该问题在科学上基于生物信息学和基因组组装评估的原理，定义清晰，数据充分，表述客观，因此我们可以进行正式求解。\n\n该问题要求为两个给定的组装（指定为 $A$ 和 $B$）计算两个标准的基因组组装质量指标：$N_{50}$ 统计量（百分之五十重叠群长度统计量）和 $L_{90}$ 统计量（百分之九十跨度重叠群计数）。此外，还要求阐明这些指标所揭示的权衡。\n\n设给定组装的重叠群长度多重集为 $C = \\{c_1, c_2, \\dots, c_n\\}$。\n组装总跨度 $S$ 是所有重叠群长度的总和：\n$$S = \\sum_{i=1}^{n} c_i$$\n为计算 $N_{50}$ 和 $L_{90}$，必须首先将重叠群按长度降序排列，得到一个有序列表 $C' = (l_1, l_2, \\dots, l_n)$，其中 $l_1 \\ge l_2 \\ge \\dots \\ge l_n$。\n\n$N_{50}$ 统计量定义为，在有序列表 $C'$ 的最小前缀中，当其长度累积和达到总跨度 $S$ 的至少 $50\\%$ 时，该前缀中最短的重叠群的长度 $l_k$。也就是说，找到满足以下条件的最小整数 $k$：\n$$\\sum_{i=1}^{k} l_i \\ge 0.5 \\times S$$\n$N_{50}$ 值即为 $l_k$，即集合 $\\{l_1, l_2, \\dots, l_k\\}$ 中最短重叠群的长度。由于列表是经过排序的， $l_k$ 总是最短的。\n\n$L_{90}$ 统计量定义为，在有序列表 $C'$ 中，累积长度达到总跨度 $S$ 的至少 $90\\%$ 所需的最少重叠群数量。也就是说，找到满足以下条件的最小整数 $k$：\n$$\\sum_{i=1}^{k} l_i \\ge 0.9 \\times S$$\n$L_{90}$ 的值就是这个整数 $k$。\n\n现在我们将这些定义应用于组装 $A$ 和 $B$。\n\n**组装 A**\n重叠群长度的多重集为 $A = [3000, 3000, 3000]$。\n1.  **重叠群排序**：所有长度相同，因此有序列表为 $C'_A = (3000, 3000, 3000)$。\n2.  **总跨度**：组装总跨度为 $S_A = 3000 + 3000 + 3000 = 9000$ 碱基对。\n3.  **阈值**：$50\\%$ 的阈值为 $0.5 \\times 9000 = 4500$。$90\\%$ 的阈值为 $0.9 \\times 9000 = 8100$。\n\n4.  **计算 $N_{50}(A)$**：我们寻找最小的 $k$，使得累积和 $\\ge 4500$。\n    -   当 $k=1$ 时：累积和为 $3000$。这小于 4500。\n    -   当 $k=2$ 时：累积和为 $3000 + 3000 = 6000$。这 $\\ge 4500$。\n    满足条件的最小重叠群集合为 $(3000, 3000)$。此集合中最短（也是唯一）的长度为 $3000$。\n    因此，$N_{50}(A) = 3000$。\n\n5.  **计算 $L_{90}(A)$**：我们寻找最小的 $k$，使得累积和 $\\ge 8100$。\n    -   当 $k=1$ 时：累积和为 $3000$。这小于 8100。\n    -   当 $k=2$ 时：累积和为 $6000$。这小于 8100。\n    -   当 $k=3$ 时：累积和为 $6000 + 3000 = 9000$。这 $\\ge 8100$。\n    所需的最小重叠群数量为 $3$。\n    因此，$L_{90}(A) = 3$。\n\n**组装 B**\n重叠群长度的多重集为 $B = [8000, 500, 500]$。\n1.  **重叠群排序**：有序列表为 $C'_B = (8000, 500, 500)$。\n2.  **总跨度**：组装总跨度为 $S_B = 8000 + 500 + 500 = 9000$ 碱基对。\n3.  **阈值**：阈值与组装 $A$ 相同：$50\\%$ 为 $4500$，$90\\%$ 为 $8100$。\n\n4.  **计算 $N_{50}(B)$**：我们寻找最小的 $k$，使得累积和 $\\ge 4500$。\n    -   当 $k=1$ 时：累积和为 $8000$。这 $\\ge 4500$。\n    满足条件的最小重叠群集合为 $(8000)$。此集合中最短（也是唯一）的长度为 $8000$。\n    因此，$N_{50}(B) = 8000$。\n\n5.  **计算 $L_{90}(B)$**：我们寻找最小的 $k$，使得累积和 $\\ge 8100$。\n    -   当 $k=1$ 时：累积和为 $8000$。这小于 8100。\n    -   当 $k=2$ 时：累积和为 $8000 + 500 = 8500$。这 $\\ge 8100$。\n    所需的最小重叠群数量为 $2$。\n    因此，$L_{90}(B) = 2$。\n\n**权衡的解读**\n计算出的指标为：\n-   组装 $A$：$(N_{50}, L_{90}) = (3000, 3)$\n-   组装 $B$：$(N_{50}, L_{90}) = (8000, 2)$\n\n尽管这两个组装的总大小相同，但这两对指标揭示了它们在结构上的根本差异。\n\n-   **$N_{50}$ 作为连续性的度量**：$N_{50}$ 值越高通常越好，表示至少一半的基因组被组装成了大的连续片段。组装 $B$ 的 $N_{50}$ 值为 $8000$，远高于组装 $A$ 的 $3000$，这表明其至少一半内容具有更优的大尺度连续性。\n\n-   **$L_{90}$ 作为碎片化程度的度量**：$L_{90}$ 值越低越好，表示组装的碎片化程度较低。组装 $B$ 的 $L_{90}$ 值为 $2$，低于组装 $A$ 的 $3$，这意味着在组装 $B$ 中可以用更少的重叠群覆盖 $90\\%$ 的基因组。\n\n这对 $(N_{50}, L_{90})$ 共同制约了解读：\n1.  **组装 $A$ ($(3000, 3)$)** 代表一个**均衡但碎片化**的组装。其所有重叠群的长度均一且适中。较低的 $N_{50}$ 值反映了其缺乏非常长的重叠群。对于下游分析而言，这意味着虽然质量一致，但任何大于 $3000$ 碱基对的基因或结构变异都将被打断在多个重叠群中，从而使分析复杂化。\n\n2.  **组装 $B$ ($(8000, 2)$)** 代表一个**头重脚轻或偏斜**的组装。其特点是一个非常长的重叠群和一条由非常短的重叠群组成的“尾巴”。高 $N_{50}$ 和低 $L_{90}$ 都是由单个 $8000$ bp的重叠群驱动的。\n    -   **应用价值**：如果感兴趣的区域（例如一个大的癌基因）完全位于这个长重叠群内，那么这种结构就非常有利。它允许对该区域的变异和局部结构进行明确的分析。\n    -   **可解释性约束**：高质量的指标可能具有误导性。它们掩盖了一个事实，即组装中约 $100\\% - (8000/9000 \\times 100\\%) \\approx 11.1\\%$ 的部分被高度碎片化为小的 $500$ bp片段。这些碎片化区域中的信息是孤立的，它们与主重叠群的关系未知。这说明了一个关键的权衡：追求高 $N_{50}$ 有时可能导致产生少数“英雄”重叠群，但代价是牺牲了其余序列的正确放置，从而产生一个碎片化的尾部。\n\n在医学数据分析的背景下，对于分析其单个大重叠群内的长程特征，组装 $B$ 会是更优选择。然而，研究人员必须保持谨慎，因为 $(8000, 2)$ 这样亮眼的统计数据掩盖了组装中相当一部分的低质量。组装 $A$ 在纸面上不那么引人注目，但可能具有更高的一致可靠性，尽管其在研究大型基因或结构变异方面的应用价值因其碎片化而受到内在限制。两者之间的选择取决于具体的分析目标。\n\n最终结果向量的顺序为 $(N_{50}(A), L_{90}(A), N_{50}(B), L_{90}(B))$。\n这些值为 $(3000, 3, 8000, 2)$。所有值均为整数，因此无需四舍五入。", "answer": "$$\\boxed{\\begin{pmatrix} 3000  3  8000  2 \\end{pmatrix}}$$", "id": "4540052"}, {"introduction": "在现实世界的基因组学研究中，我们所依赖的参考数据通常是带有内在不确定性的估计值。最后一个练习引入了 $NG_{50}$ 指标，该指标根据估算的基因组大小对连续性进行归一化，并探讨了这种估计的不确定性如何传导至最终的评估指标。通过计算 $NG_{50}$ 对基因组大小估计变化的敏感性，您将深入了解组装评估的稳健性以及考虑外部误差来源的重要性 [@problem_id:4540059]。", "problem": "对一个临床细菌分离株进行测序，其从头组装产生了四个重叠群，长度分别为 $[900, 800, 700, 600]$ 千碱基对 (kbp)。送检实验室提供了一个估计的单倍体基因组大小 $G$，其不确定性为 $\\pm 5\\%$。在基因组组装评估中，$N_{50}$（组装的加权中位重叠群长度）被定义为：将重叠群按长度非递增顺序排列并从最大到最小累加其长度，当累积长度首次达到至少组装总长度的一半时的那个重叠群的长度。$NG_{50}$（基因组大小归一化的 $N_{50}$）的定义与此相同，只是累积长度是与估计的基因组大小 $G$ 的一半进行比较，而不是与组装总长度的一半进行比较。具体来说，将重叠群按长度非递增顺序排序，设其长度为 $L_{1}, L_{2}, \\dots, L_{n}$，则 $NG_{50}$ 是满足总和 $\\sum_{i=1}^{k} L_{i} \\geq \\frac{G}{2}$ 的最小前缀集合 $\\{L_{1}, \\dots, L_{k}\\}$ 中最短的重叠群的长度。\n\n假设 $G = 1800$ kbp。为了量化 $G$ 中的不确定性如何传播到报告的 $NG_{50}$ 值，定义 $NG_{50}$ 相对于 $G$ 在 $\\pm 5\\%$ 扰动下的对称有限差分灵敏度为\n$$\nS \\equiv \\frac{NG50\\big((1+0.05)G\\big) - NG50\\big((1-0.05)G\\big)}{(1+0.05)G - (1-0.05)G}.\n$$\n计算给定重叠群长度下的 $S$ 值。你的最终答案以千碱基对/千碱基对 (kbp/kbp) 为单位表示，并四舍五入到四位有效数字。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在生物信息学领域有科学依据，问题提出得当、客观且内部一致。唯一解所需的所有数据和定义均已提供。\n\n目标是计算在 $\\pm 5\\%$ 扰动下，$NG_{50}$ 指标相对于估计基因组大小 $G$ 的对称有限差分灵敏度 $S$。$S$ 的计算公式如下：\n$$\nS \\equiv \\frac{NG50\\big((1+0.05)G\\big) - NG50\\big((1-0.05)G\\big)}{(1+0.05)G - (1-0.05)G}\n$$\n问题提供了以下信息：\n重叠群长度集合为 $\\{900, 800, 700, 600\\}$ 千碱基对 (kbp)。我们将这些长度按非递增顺序排序，它们已经是这个顺序了：\n$L_1 = 900$ kbp\n$L_2 = 800$ kbp\n$L_3 = 700$ kbp\n$L_4 = 600$ kbp\n\n标称的估计单倍体基因组大小为 $G = 1800$ kbp。\n\n$NG_{50}$ 的定义是，在排序后的重叠群中，其累积和至少为基因组大小一半的最小前缀集合 $\\{L_{1}, \\dots, L_{k}\\}$ 中最短重叠群的长度，即 $\\sum_{i=1}^{k} L_{i} \\geq \\frac{G}{2}$。由于重叠群是按非递增顺序排序的（$L_1 \\geq L_2 \\geq \\dots$），前缀 $\\{L_1, \\dots, L_k\\}$ 中最短的重叠群总是 $L_k$。因此，$NG_{50}$ 是使得累积和首次达到或超过阈值 $\\frac{G}{2}$ 的那个重叠群的长度 $L_k$。\n\n计算过程分为三个主要步骤：\n1.  确定扰动后的基因组大小 $G_{lower}$ 和 $G_{upper}$。\n2.  计算 $NG50(G_{lower})$ 和 $NG50(G_{upper})$。\n3.  将这些值代入 $S$ 的公式。\n\n首先，我们计算对应于 $\\pm 5\\%$ 变化的扰动后基因组大小。设扰动因子为 $\\delta = 0.05$。\n基因组大小的上限是：\n$$\nG_{upper} = (1 + \\delta)G = (1 + 0.05) \\times 1800 = 1.05 \\times 1800 = 1890 \\text{ kbp}\n$$\n基因组大小的下限是：\n$$\nG_{lower} = (1 - \\delta)G = (1 - 0.05) \\times 1800 = 0.95 \\times 1800 = 1710 \\text{ kbp}\n$$\n灵敏度公式的分母是该扰动的范围：\n$$\nG_{upper} - G_{lower} = 1890 - 1710 = 180 \\text{ kbp}\n$$\n\n接下来，我们计算 $G_{lower}$ 和 $G_{upper}$ 对应的 $NG_{50}$ 值。这需要将累积的重叠群长度与各自的阈值 $\\frac{G_{lower}}{2}$ 和 $\\frac{G_{upper}}{2}$ 进行比较。\n阈值分别为：\n$$\n\\text{阈值}_{lower} = \\frac{G_{lower}}{2} = \\frac{1710}{2} = 855 \\text{ kbp}\n$$\n$$\n\\text{阈值}_{upper} = \\frac{G_{upper}}{2} = \\frac{1890}{2} = 945 \\text{ kbp}\n$$\n我们来计算排序后重叠群长度的累积和：\n$C_1 = \\sum_{i=1}^{1} L_i = L_1 = 900$ kbp\n$C_2 = \\sum_{i=1}^{2} L_i = L_1 + L_2 = 900 + 800 = 1700$ kbp\n$C_3 = \\sum_{i=1}^{3} L_i = C_2 + L_3 = 1700 + 700 = 2400$ kbp\n$C_4 = \\sum_{i=1}^{4} L_i = C_3 + L_4 = 2400 + 600 = 3000$ kbp\n\n为了找到 $NG50(G_{lower})$，我们寻找最小的整数 $k$，使得 $C_k \\geq 855$ kbp。\n对于 $k=1$，$C_1 = 900$，且 $900 \\geq 855$。条件在 $k=1$ 时满足。\n因此，$NG50(G_{lower}) = L_1 = 900$ kbp。\n\n为了找到 $NG50(G_{upper})$，我们寻找最小的整数 $k$，使得 $C_k \\geq 945$ kbp。\n对于 $k=1$，$C_1 = 900$，且 $900  945$。条件不满足。\n对于 $k=2$，$C_2 = 1700$，且 $1700 \\geq 945$。条件在 $k=2$ 时满足。\n因此，$NG50(G_{upper}) = L_2 = 800$ kbp。\n\n最后，我们将这些值代入灵敏度 $S$ 的公式：\n$$\nS = \\frac{NG50(G_{upper}) - NG50(G_{lower})}{G_{upper} - G_{lower}} = \\frac{800 \\text{ kbp} - 900 \\text{ kbp}}{180 \\text{ kbp}} = \\frac{-100}{180}\n$$\n化简该分数可得：\n$$\nS = -\\frac{10}{18} = -\\frac{5}{9}\n$$\n以小数形式表示，$S = -0.5555...$\n题目要求答案四舍五入到四位有效数字。\n$$\nS \\approx -0.5556\n$$\n单位是 kbp/kbp，这是一个无量纲量，与灵敏度的预期相符。", "answer": "$$\\boxed{-0.5556}$$", "id": "4540059"}]}