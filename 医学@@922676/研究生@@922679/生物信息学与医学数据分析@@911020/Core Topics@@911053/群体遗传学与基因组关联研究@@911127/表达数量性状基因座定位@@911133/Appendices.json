{"hands_on_practices": [{"introduction": "发现一个统计上显著的 eQTL 只是分析的第一步，下一个关键问题是量化其影响的大小。本练习将指导您计算由基因型解释的表达方差比例 ($R^2$)，这是理解遗传变异对基因表达影响的生物学重要性的核心指标。通过这个基础计算，您将掌握 eQTL 效应大小评估的核心原理 [@problem_id:4562167]。", "problem": "考虑一项顺式表达数量性状位点 (cis-eQTL) 定位分析，其中单个基因的信使核糖核酸 (mRNA) 表达通过加性基因型效应进行建模。设个体水平的表达量由 $y$ 表示，该值是在移除已知协变量后，在对数转换和分位数归一化的尺度上测量的。设基因型剂量由 $g \\in \\{0,1,2\\}$ 表示，代表次要等位基因的数量。假设如下：\n- 线性模型 $y = \\alpha + \\beta g + \\varepsilon$ 成立，其中 $\\varepsilon$ 是独立于 $g$ 的随机残差，$\\alpha$ 和 $\\beta$ 是常数。\n- 次要等位基因频率为 $p = 0.25$。\n- 种群处于 Hardy–Weinberg Equilibrium (HWE) 状态，因此 $g$ 可被视为具有两次试验且成功概率为 $p$ 的二项随机变量。\n- 表达表型的边际方差（协变量校正后）为 $\\mathrm{Var}(y) = 0.8$。\n- 每个等位基因对表达影响的普通最小二乘 (OLS) 估计值为 $\\beta = 0.3$。\n\n从全方差公式和具有独立残差的线性模型的定义出发，推导一个用 $\\beta$、$p$ 和 $\\mathrm{Var}(y)$ 表示的、由基因型解释的表达方差比例（记为 $R^{2}$）的解析表达式。然后，使用所提供的值，计算 $R^{2}$ 的数值。将您的最终数值答案四舍五入到三位有效数字，并以不带单位的小数形式表示。作为推理的一部分，请将计算出的 $R^{2}$ 的量级与观测到的 cis-eQTL 效应大小的典型范围进行比较，但请确保您最终报告的答案仅为所要求的数字。", "solution": "首先将根据所需标准对问题陈述进行验证。\n\n### 步骤1：提取给定信息\n- 基因表达 $y$ 的模型是一个具有加性基因型效应的线性模型：$y = \\alpha + \\beta g + \\varepsilon$。\n- $y$ 是移除已知协变量后，在对数转换和分位数归一化尺度上的个体水平表达量。\n- $g$ 是次要等位基因计数的基因型剂量，其中 $g \\in \\{0, 1, 2\\}$。\n- $\\varepsilon$ 是一个独立于 $g$ 的随机残差。\n- $\\alpha$ 和 $\\beta$ 是常数。\n- 次要等位基因频率为 $p = 0.25$。\n- 种群处于 Hardy–Weinberg Equilibrium (HWE) 状态。\n- $g$ 被视为具有两次试验且成功概率为 $p$ 的二项随机变量。\n- 表达表型的边际方差为 $\\mathrm{Var}(y) = 0.8$。\n- 每个等位基因对表达影响的普通最小二乘 (OLS) 估计值为 $\\beta = 0.3$。\n\n### 步骤2：使用提取的给定信息进行验证\n对问题的有效性进行评估：\n- **科学依据：** 该问题牢固地建立在统计遗传学和生物信息学的原理之上，特别是在表达数量性状位点 (eQTL) 分析的背景下。加性线性模型、Hardy-Weinberg Equilibrium 以及可解释方差的概念是该领域的标准组成部分。给定的次要等位基因频率 ($p=0.25$)、效应大小 ($\\beta=0.3$) 和总表达方差 ($\\mathrm{Var}(y)=0.8$) 对于 cis-eQTL 来说是符合实际的。\n- **适定性：** 这是一个适定的问题。它提供了推导唯一且有意义的解所需的所有必要信息和清晰定义。问题是明确无误的。\n- **客观性：** 问题以精确、客观的语言陈述，没有任何主观主张或偏见。\n- **完整性与一致性：** 问题设定是自洽且内部一致的。没有信息缺失或相互矛盾。\n- **可行性：** 所描述的情景不仅在科学上是合理的，而且代表了真实世界遗传数据分析中使用的标准简化模型。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的解答。\n\n目标是推导由基因型解释的表达方差比例 $R^2$ 的表达式，然后计算其数值。\n\n可解释方差比例 $R^2$ 定义为由模型预测变量（基因型 $g$）解释的方差与结果变量（表达量 $y$）总方差的比率。\n$$\nR^2 = \\frac{\\mathrm{Var}_{\\text{explained}}}{\\mathrm{Var}_{\\text{total}}} = \\frac{\\mathrm{Var}(\\text{E}[y|g])}{\\mathrm{Var}(y)}\n$$\n\n按照规定，我们从全方差公式开始：\n$$\n\\mathrm{Var}(y) = \\mathrm{E}[\\mathrm{Var}(y|g)] + \\mathrm{Var}(\\mathrm{E}[y|g])\n$$\n该公式将 $y$ 的总方差分解为两个部分：条件方差的期望值（残差方差）和条件期望的方差（可解释方差）。\n\n我们使用给定的线性模型 $y = \\alpha + \\beta g + \\varepsilon$ 来确定这些分量。\n首先，我们求给定 $g$ 时 $y$ 的条件期望：\n$$\n\\mathrm{E}[y|g] = \\mathrm{E}[\\alpha + \\beta g + \\varepsilon | g]\n$$\n由于 $\\alpha$ 和 $\\beta$ 是常数，且在条件中 $g$ 是已知的，我们有：\n$$\n\\mathrm{E}[y|g] = \\alpha + \\beta g + \\mathrm{E}[\\varepsilon|g]\n$$\n问题陈述指出残差 $\\varepsilon$ 独立于 $g$。因此，$\\mathrm{E}[\\varepsilon|g] = \\mathrm{E}[\\varepsilon]$。在 OLS 框架中，假定 $\\mathrm{E}[\\varepsilon]=0$。因此，条件期望为：\n$$\n\\mathrm{E}[y|g] = \\alpha + \\beta g\n$$\n这一项代表了由基因型预测的表达水平部分。\n\n接下来，我们求这个条件期望的方差，也就是由基因型解释的方差：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\mathrm{Var}(\\alpha + \\beta g)\n$$\n由于 $\\alpha$ 是一个常数，它对方差没有贡献。根据方差的性质 $\\mathrm{Var}(cX) = c^2\\mathrm{Var}(X)$，我们得到：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\mathrm{Var}(\\beta g) = \\beta^2 \\mathrm{Var}(g)\n$$\n\n问题陈述指出种群处于 Hardy-Weinberg Equilibrium (HWE) 状态，并且基因型剂量 $g$ 可被视为具有 $n=2$ 次试验（对于二倍体生物）和成功概率 $p$（次要等位基因频率）的二项随机变量。二项随机变量的方差由 $np(1-p)$ 给出。\n因此，基因型剂量的方差是：\n$$\n\\mathrm{Var}(g) = 2p(1-p)\n$$\n将此代入可解释方差的表达式中，得到：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\beta^2 [2p(1-p)] = 2p(1-p)\\beta^2\n$$\n\n现在我们回到 $R^2$ 的定义。我们已经有了可解释方差的表达式，而已知总方差 $\\mathrm{Var}(y)$。\n由基因型解释的方差比例的解析表达式为：\n$$\nR^2 = \\frac{\\mathrm{Var}(\\mathrm{E}[y|g])}{\\mathrm{Var}(y)} = \\frac{2p(1-p)\\beta^2}{\\mathrm{Var}(y)}\n$$\n这就是所要求的用 $\\beta$、$p$ 和 $\\mathrm{Var}(y)$ 表示的通用公式。\n\n现在，我们将提供的数值代入此表达式中：\n- $\\beta = 0.3$\n- $p = 0.25$\n- $\\mathrm{Var}(y) = 0.8$\n\n首先，计算基因型的方差 $\\mathrm{Var}(g)$：\n$$\n\\mathrm{Var}(g) = 2p(1-p) = 2(0.25)(1-0.25) = 2(0.25)(0.75) = 0.5(0.75) = 0.375\n$$\n接下来，计算由基因型解释的方差：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\beta^2 \\mathrm{Var}(g) = (0.3)^2 \\times 0.375 = 0.09 \\times 0.375 = 0.03375\n$$\n最后，计算 $R^2$：\n$$\nR^2 = \\frac{0.03375}{\\mathrm{Var}(y)} = \\frac{0.03375}{0.8} = 0.0421875\n$$\n题目要求将答案四舍五入到三位有效数字。第一位有效数字是 $4$，第二位是 $2$，第三位是 $1$。后面的数字是 $8$，大于或等于 $5$，所以我们将第三位有效数字向上取整。\n$$\nR^2 \\approx 0.0422\n$$\n\n这个值，代表由单个遗传变异解释的基因表达方差的 $4.22\\%$，对于一个强 cis-eQTL 来说是一个合理且常见的效应大小。在像 Genotype-Tissue Expression (GTEx) 项目这样的大规模研究中，对于一个给定基因（即“eGene”）来说，最显著的 cis-eQTL 通常能解释 $1\\%$ 到 $20\\%$ 的表达方差，少数特殊情况会超过 $50\\%$。因此，大约 $4\\%$ 的 $R^2$ 值在此生物学背景下是一个相当大且符合实际的效应大小。", "answer": "$$\n\\boxed{0.0422}\n$$", "id": "4562167"}, {"introduction": "在理想模型中，我们假设基因型是精确已知的，但现实世界的大规模研究通常依赖于基因型填充（imputation）来推断缺失的变异。本练习探讨了使用填充“剂量”（dosage）数据替代真实基因型所带来的统计学后果。您将推导出填充不确定性如何通过降低有效样本量来削弱统计功效，并理解为何它通常不会对效应大小的估计引入偏差 [@problem_id:4562182]。", "problem": "一位研究者在一个包含 $n$ 个个体的队列中进行表达数量性状位点 (eQTL) 定量分析。对于一个在哈迪-温伯格平衡 (HWE) 下，次要等位基因频率为 $p$ 的单个变异，其真实基因型计数 $G_i \\in \\{0,1,2\\}$ 无法直接观测到。取而代之的是，基因型填充提供了一个剂量 $D_i = \\mathbb{E}[G_i \\mid \\mathcal{I}_i]$，其中 $\\mathcal{I}_i$ 表示个体 $i$ 的填充信息，以及每个个体的后验方差 $v_i = \\operatorname{Var}(G_i \\mid \\mathcal{I}_i)$。基因表达通过线性回归模型 $Y_i = \\alpha + \\beta G_i + \\varepsilon_i$ 进行建模，其中误差项 $\\varepsilon_i$ 是独立同分布的，满足 $\\mathbb{E}[\\varepsilon_i] = 0$ 和 $\\operatorname{Var}(\\varepsilon_i) = \\sigma^2$。然而，分析师使用普通最小二乘法 (OLS) 拟合模型 $Y_i = \\alpha + \\beta D_i + \\varepsilon_i$。\n\n仅使用诸如全方差定律、全协方差定律和 OLS 估计量的性质等第一性原理，分析填充不确定性如何通过剂量方差进入关联检验，及其对 $Z$ 统计量或 Wald 统计量的影响。假设在 HWE 下 $\\operatorname{Var}(G) = 2p(1-p)$，并根据群体水平的量和填充后验方差定义该变异的填充质量度量 $R^2$。根据你的推导，选择所有正确的陈述：\n\nA. 在 $Y$ 对 $D$ 的 OLS 回归中，$\\beta$ 的斜率估计量是无偏的。相对于使用真实基因型，用于检验 $H_0:\\beta=0$ 的期望 Wald 统计量或 $Z$ 统计量会衰减一个因子 $\\sqrt{R^2}$，其中 $R^2 = 1 - \\mathbb{E}[v_i]/(2p(1-p))$。\n\nB. 将剂量不确定性建模为 $D_i = G_i + \\epsilon_i$ 且 $\\operatorname{Var}(\\epsilon_i) = v_i$ 意味着 $\\operatorname{Var}(D) = \\operatorname{Var}(G) + \\mathbb{E}[v_i]$，因此填充不确定性会增加预测变量的方差，从而提高统计功效。\n\nC. 填充质量度量 $R^2$ 等于 $\\operatorname{Corr}(D,G)$（不是平方），且关联 $Z$ 统计量会减少一个因子 $R^2$。\n\nD. 通过 $R^2$ 阈值筛选变异必然会使效应估计向零产生偏差，因为保留的变异具有 $\\operatorname{Var}(D)  \\operatorname{Var}(G)$。\n\nE. 根据全方差定律，$\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$，这意味着 $R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$；因此，使用剂量的检验具有一个有效样本量 $n_{\\text{eff}} = R^2 n$。\n\nF. 因为 $R^2$ 量化了剂量所捕获的基因型方差的比例，所以一个有原则的做法是筛选掉 $R^2$ 值低的变异（例如，在大样本中低于 $0.3$ 或对于稀有变异低于 $0.8$），因为它们贡献的有效样本量约为 $n_{\\text{eff}} \\approx R^2 n$，功效有限，且不会提高推断质量。", "solution": "在尝试解答之前，首先验证问题陈述，以确保其科学上合理、定义明确且客观。\n\n### 第 1 步：提取已知条件\n- **队列大小**：$n$ 个个体。\n- **变异**：一个次要等位基因频率为 $p$ 的单个变异。\n- **遗传模型**：假设哈迪-温伯格平衡 (HWE)。\n- **真实基因型**：$G_i \\in \\{0, 1, 2\\}$，是未观测到的个体 $i$ 的次要等位基因计数。根据 HWE，$\\mathbb{E}[G] = 2p$ 且 $\\operatorname{Var}(G) = 2p(1-p)$。\n- **填充剂量**：$D_i = \\mathbb{E}[G_i \\mid \\mathcal{I}_i]$，其中 $\\mathcal{I}_i$ 是个体特异性的填充信息。\n- **后验方差**：$v_i = \\operatorname{Var}(G_i \\mid \\mathcal{I}_i)$，个体 $i$ 填充基因型的不确定性。\n- **真实表型模型**：$Y_i = \\alpha + \\beta G_i + \\varepsilon_i$。\n- **误差项**：误差 $\\varepsilon_i$ 是独立同分布 (i.i.d.) 的，满足 $\\mathbb{E}[\\varepsilon_i] = 0$ 和 $\\operatorname{Var}(\\varepsilon_i) = \\sigma^2$。误差 $\\varepsilon_i$ 与遗传信息 $G_i$ 和 $\\mathcal{I}_i$ 独立。\n- **拟合模型**：分析师使用普通最小二乘法 (OLS) 拟合模型 $Y_i = \\alpha + \\beta D_i + \\varepsilon_i$。\n- **目标**：分析拟合模型中 $\\beta$ 的 OLS 估计量和相关的 Wald ($Z$) 统计量的性质，并定义一个填充质量度量 $R^2$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础**：该问题描述了统计遗传学和 eQTL 定量分析中的一个标准情景。基因型填充、剂量 ($D_i$) 的使用、后验方差 ($v_i$) 和线性回归都是现代遗传关联研究的基本组成部分。统计公式，包括将 $D_i$ 和 $v_i$ 定义为条件期望和方差，都是正确的。应用全方差和全协方差定律等第一性原理是恰当的。该问题在科学和数学上都是合理的。\n- **定义明确**：问题陈述清晰，包含了所有必要的定义和假设，以推导使用填充剂量替代真实基因型的后果。问题是具体的，并导向一个唯一的分析解。\n- **客观性**：语言技术性强、精确，没有主观或含糊的术语。\n\n### 第 3 步：结论与行动\n问题陈述是**有效的**。可以进行完整的推导和选项评估。\n\n### 核心关系的推导\n\n我们将使用群体水平的量，这些量对应于其样本估计量的大样本行为。分析依赖于全期望、全方差和全协方差定律。\n\n1.  **$\\operatorname{Var}(G)$、$\\operatorname{Var}(D)$ 和 $\\mathbb{E}[v_i]$ 之间的关系**：\n    全方差定律指出，对于随机变量 $X$ 和 $Z$，$\\operatorname{Var}(X) = \\operatorname{Var}(\\mathbb{E}[X \\mid Z]) + \\mathbb{E}[\\operatorname{Var}(X \\mid Z)]$。\n    令 $X=G$ 和 $Z=\\mathcal{I}$。问题中的量是基于对每个个体 $i$ 的 $\\mathcal{I}_i$ 进行条件化定义的。我们可以将这些看作是在个体及其填充信息 $\\mathcal{I}$ 的分布上的群体水平期望。\n    -   根据定义，$\\mathbb{E}[G \\mid \\mathcal{I}] = D$。因此，$\\operatorname{Var}(\\mathbb{E}[G \\mid \\mathcal{I}]) = \\operatorname{Var}(D)$。\n    -   根据定义，$\\operatorname{Var}(G \\mid \\mathcal{I}) = v$。因此，$\\mathbb{E}[\\operatorname{Var}(G \\mid \\mathcal{I})] = \\mathbb{E}[v_i]$（对所有个体取期望）。\n    -   将这些代入全方差定律，得到基本方程：\n        $$ \\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i] $$\n    这表明，填充剂量的方差总是小于或等于真实基因型的方差：$\\operatorname{Var}(D) = \\operatorname{Var}(G) - \\mathbb{E}[v_i] \\le \\operatorname{Var}(G)$。\n\n2.  **$\\beta$ 的 OLS 估计量**：\n    分析师对 $Y$ 和 $D$ 进行回归。该回归的群体 OLS 斜率为 $\\beta_D = \\frac{\\operatorname{Cov}(Y, D)}{\\operatorname{Var}(D)}$。这是 OLS 估计量 $\\hat{\\beta}_D$ 在大样本中收敛到的值。\n    -   让我们分析协方差项：$\\operatorname{Cov}(Y, D) = \\operatorname{Cov}(\\alpha + \\beta G + \\varepsilon, D) = \\beta \\operatorname{Cov}(G, D) + \\operatorname{Cov}(\\varepsilon, D)$。\n    -   非遗传残差 $\\varepsilon$ 独立于遗传填充过程，因此 $\\operatorname{Cov}(\\varepsilon, D) = 0$。\n    -   现在，我们使用全协方差定律分析 $\\operatorname{Cov}(G, D)$：$\\operatorname{Cov}(X,Y) = \\mathbb{E}[\\operatorname{Cov}(X,Y|Z)] + \\operatorname{Cov}(\\mathbb{E}[X|Z], \\mathbb{E}[Y|Z])$。\n    -   令 $X=G, Y=D, Z=\\mathcal{I}$。\n    -   $\\mathbb{E}[G \\mid \\mathcal{I}]=D$。由于 $D$ 是 $\\mathcal{I}$ 的函数，当以 $\\mathcal{I}$ 为条件时，它是“常数”，因此 $\\mathbb{E}[D \\mid \\mathcal{I}] = D$ 且 $\\operatorname{Cov}(G, D \\mid \\mathcal{I}) = 0$。\n    -   因此，$\\operatorname{Cov}(G, D) = \\operatorname{Cov}(\\mathbb{E}[G \\mid \\mathcal{I}], \\mathbb{E}[D \\mid \\mathcal{I}]) = \\operatorname{Cov}(D, D) = \\operatorname{Var}(D)$。\n    -   将此代入 $\\beta_D$ 的表达式中：\n        $$ \\beta_D = \\frac{\\beta \\operatorname{Cov}(G, D)}{\\operatorname{Var}(D)} = \\frac{\\beta \\operatorname{Var}(D)}{\\operatorname{Var}(D)} = \\beta $$\n    这表明，当对定义为条件期望的填充剂量进行回归时，斜率的 OLS 估计量对于真实效应大小 $\\beta$ 是**无偏**的。这类模型，其中 $D_i = \\mathbb{E}[G_i | \\mathcal{I}_i]$，被称为 Berkson 误差模型。\n\n3.  **填充质量 $R^2$**：\n    填充质量的标准度量，记为 $R^2$，是真实基因型 $G$ 和填充剂量 $D$ 之间相关系数的平方。\n    $$ R^2 = (\\operatorname{Corr}(G, D))^2 = \\frac{(\\operatorname{Cov}(G, D))^2}{\\operatorname{Var}(G) \\operatorname{Var}(D)} $$\n    -   使用我们之前的结论 $\\operatorname{Cov}(G, D) = \\operatorname{Var}(D)$：\n        $$ R^2 = \\frac{(\\operatorname{Var}(D))^2}{\\operatorname{Var}(G) \\operatorname{Var}(D)} = \\frac{\\operatorname{Var}(D)}{\\operatorname{Var}(G)} $$\n    -   这证实了 $R^2$ 是填充剂量所捕获的真实基因型方差的比例。\n    -   使用 $\\operatorname{Var}(D) = \\operatorname{Var}(G) - \\mathbb{E}[v_i]$ 和问题给出的 $\\operatorname{Var}(G) = 2p(1-p)$：\n        $$ R^2 = \\frac{\\operatorname{Var}(G) - \\mathbb{E}[v_i]}{\\operatorname{Var}(G)} = 1 - \\frac{\\mathbb{E}[v_i]}{\\operatorname{Var}(G)} = 1 - \\frac{\\mathbb{E}[v_i]}{2p(1-p)} $$\n\n4.  **Wald ($Z$) 统计量和统计功效**：\n    用于检验 $H_0: \\beta=0$ 的 Wald 统计量是 $Z = \\hat{\\beta} / \\operatorname{SE}(\\hat{\\beta})$。统计功效由检验的非中心参数决定，对于大样本 $n$，该参数为 $\\lambda = \\mathbb{E}[\\hat{\\beta}] / \\operatorname{SE}(\\hat{\\beta})$。\n    -   **使用真实基因型 ($G$)**：估计量 $\\hat{\\beta}_G$ 对 $\\beta$ 是无偏的。标准误为 $\\operatorname{SE}(\\hat{\\beta}_G) \\approx \\sqrt{\\frac{\\sigma^2}{n \\operatorname{Var}(G)}}$。平方非中心参数为：\n        $$ \\lambda_G^2 = \\frac{\\beta^2}{\\operatorname{Var}(\\hat{\\beta}_G)} \\approx \\frac{n \\beta^2 \\operatorname{Var}(G)}{\\sigma^2} $$\n    -   **使用填充剂量 ($D$)**：估计量 $\\hat{\\beta}_D$ 对 $\\beta$ 也是无偏的。用于检验 $H_0$ 的标准误是在零假设 $\\beta=0$ 下估计的。在拟合模型 $Y_i = \\alpha + \\beta D_i + u_i$ 中，零假设下的误差方差就是 $\\operatorname{Var}(\\varepsilon_i)=\\sigma^2$。预测变量方差为 $\\operatorname{Var}(D)$。因此，标准误为 $\\operatorname{SE}(\\hat{\\beta}_D) \\approx \\sqrt{\\frac{\\sigma^2}{n \\operatorname{Var}(D)}}$。平方非中心参数为：\n        $$ \\lambda_D^2 = \\frac{\\beta^2}{\\operatorname{Var}(\\hat{\\beta}_D)} \\approx \\frac{n \\beta^2 \\operatorname{Var}(D)}{\\sigma^2} $$\n    -   **比较**：让我们计算非中心参数的比率。\n        $$ \\frac{\\lambda_D}{\\lambda_G} = \\sqrt{\\frac{n \\beta^2 \\operatorname{Var}(D) / \\sigma^2}{n \\beta^2 \\operatorname{Var}(G) / \\sigma^2}} = \\sqrt{\\frac{\\operatorname{Var(D)}}{\\operatorname{Var}(G)}} = \\sqrt{R^2} $$\n    在备择假设下，$Z$ 统计量的期望值（即其非中心性）被一个因子 $\\sqrt{R^2}$ 衰减。在零假设下，检验统计量的方差仍然是 $1$，但在备择假设下，其均值的偏移较小，导致统计功效损失。\n    -   **有效样本量 ($n_{\\text{eff}}$)**：我们可以通过重写 $\\lambda_D^2$ 来看到统计功效是如何损失的：\n        $$ \\lambda_D^2 = \\frac{n \\beta^2 (R^2 \\operatorname{Var}(G))}{\\sigma^2} = \\frac{(n R^2) \\beta^2 \\operatorname{Var}(G)}{\\sigma^2} $$\n    这表明，一个样本量为 $n$ 并使用剂量的研究，与一个样本量为 $n_{\\text{eff}} = n R^2$ 并使用真实基因型的研究具有相同的统计功效（非中心参数）。\n\n### 逐项分析\n\n**A. 在 $Y$ 对 $D$ 的 OLS 回归中，$\\beta$ 的斜率估计量是无偏的。相对于使用真实基因型，用于检验 $H_0:\\beta=0$ 的期望 Wald 统计量或 $Z$ 统计量会衰减一个因子 $\\sqrt{R^2}$，其中 $R^2 = 1 - \\mathbb{E}[v_i]/(2p(1-p))$。**\n- **无偏估计量**：如第 2 节所推导，OLS 估计量 $\\hat{\\beta}_D$ 对 $\\beta$ 是渐近无偏的。**正确**。\n- **Z 统计量衰减**：如第 4 节所推导，Z 统计量的非中心参数衰减了 $\\sqrt{R^2}$。这对应于期望统计量的衰减。**正确**。\n- **$R^2$ 公式**：如第 3 节所推导，$R^2 = 1 - \\mathbb{E}[v_i]/\\operatorname{Var}(G) = 1 - \\mathbb{E}[v_i]/(2p(1-p))$。**正确**。\n该陈述的所有部分都与我们的推导一致。\n**结论：正确**\n\n**B. 将剂量不确定性建模为 $D_i = G_i + \\epsilon_i$ 且 $\\operatorname{Var}(\\epsilon_i) = v_i$ 意味着 $\\operatorname{Var}(D) = \\operatorname{Var}(G) + \\mathbb{E}[v_i]$，因此填充不确定性会增加预测变量的方差，从而提高统计功效。**\n- 关系式 $\\operatorname{Var}(D) = \\operatorname{Var}(G) + \\mathbb{E}[v_i]$ 是不正确的。我们从全方差定律的推导表明 $\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$，这意味着 $\\operatorname{Var}(D) = \\operatorname{Var}(G) - \\mathbb{E}[v_i]$。填充不确定性*减少*了预测变量的方差。\n- 因为预测变量方差减少，统计功效*降低*，而不是增加。该陈述的前提和结论都是错误的。\n**结论：不正确**\n\n**C. 填充质量度量 $R^2$ 等于 $\\operatorname{Corr}(D,G)$（不是平方），且关联 $Z$ 统计量会减少一个因子 $R^2$。**\n- 度量 $R^2$ 是相关系数的*平方*。从第 3 节中，我们证明了 $\\operatorname{Corr}(D,G) = \\sqrt{\\frac{\\operatorname{Var}(D)}{\\operatorname{Var}(G)}} = \\sqrt{R^2}$。所以 $R^2 = \\operatorname{Corr}(D,G)$ 的说法是错误的，除非 $R^2=1$ 或 $R^2=0$。\n- 关联 $Z$ 统计量衰减一个因子 $\\sqrt{R^2}$，而不是 $R^2$。卡方统计量 $Z^2$ 衰减一个因子 $R^2$。两个论断都是错误的。\n**结论：不正确**\n\n**D. 通过 $R^2$ 阈值筛选变异必然会使效应估计向零产生偏差，因为保留的变异具有 $\\operatorname{Var}(D)  \\operatorname{Var}(G)$。**\n- 如第 2 节所示，$\\beta$ 的 OLS 估计量是无偏的，无论 $R^2$ 的值是多少（只要 $R^2>0$）。根据 $R^2$ 进行筛选不会对效应估计本身引入偏差。这与根据统计显著性（p值）进行筛选不同，后者可能导致赢家诅咒偏差。\n- 虽然前提“保留的变异具有 $\\operatorname{Var}(D)  \\operatorname{Var}(G)$”对于任何非完美填充的变异都是正确的，但这是导致统计功效损失的原因，而不是 $\\hat{\\beta}$ 的偏差。结论是不正确的。\n**结论：不正确**\n\n**E. 根据全方差定律，$\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$，这意味着 $R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$；因此，使用剂量的检验具有一个有效样本量 $n_{\\text{eff}} = R^2 n$。**\n- 方差分解 $\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$ 是全方差定律的直接应用，如第 1 节所示。**正确**。\n- 推论 $R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$ 是填充 $R^2$ 的标准定义，并且源于相关性的定义以及我们推导出的性质 $\\operatorname{Cov}(G,D)=\\operatorname{Var}(D)$，如第 3 节所示。**正确**。\n- 有效样本量 $n_{\\text{eff}} = R^2 n$ 是填充对检验统计量非中心参数影响的直接结果，如第 4 节所示。**正确**。\n该陈述的所有部分都是正确的，并且逻辑上相互关联。\n**结论：正确**\n\n**F. 因为 $R^2$ 量化了剂量所捕获的基因型方差的比例，所以一个有原则的做法是筛选掉 $R^2$ 值低的变异（例如，在大样本中低于 $0.3$ 或对于稀有变异低于 $0.8$），因为它们贡献的有效样本量约为 $n_{\\text{eff}} \\approx R^2 n$，功效有限，且不会提高推断质量。**\n- 该陈述正确地将 $R^2$ 确定为捕获的方差比例 ($R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$)。\n- 它正确地指出有效样本量约为 $R^2 n$。\n- 基于这一数学事实，它得出结论，$R^2$ 非常低的变异其统计功效极其有限。例如，一个 $R^2=0.1$ 的变异，其有效样本量仅为完美基因分型变异的 $10\\%$。\n- 因此，筛选掉这类变异是一个合乎逻辑的、“有原则的”策略，以避免在它们身上浪费统计功效（它们增加了多重检验的负担），而提供的信息却很少。给定的阈值说明了这一原则。该陈述正确地将数学推导与合理的科学实践联系起来。\n**结论：正确**", "answer": "$$\\boxed{AEF}$$", "id": "4562182"}, {"introduction": "eQTL 分析的挑战不仅在于基因型数据，同样在于表达数据的复杂性。现代研究广泛使用的 RNA 测序（RNA-seq）数据是具有“零膨胀”（zero-inflation）等特性的计数数据，这使得标准线性模型不再适用。本练习将促使您思考，当处理低表达基因时，为何简单的数据变换或标准广义线性模型可能会导致错误的结论，以及为何需要采用双栏模型（hurdle model）等更严谨的统计策略 [@problem_id:4562156]。", "problem": "一名研究者对 $n$ 个个体的低表达基因的批量核糖核酸测序 (RNA-seq) 数据进行表达数量性状位点 (eQTL) 定位。设 $G_i \\in \\{0,1,2\\}$ 为个体 $i$ 的单个双等位基因变异的基因型剂量，设 $L_i > 0$ 表示个体 $i$ 的文库大小（测序深度），设 $Y_i \\in \\{0,1,2,\\dots\\}$ 为该基因的观测读数。假设 $Y_i$ 的数据生成过程遵循两个经过充分检验的基本事实：(i) 转录本计数通过对分子进行抽样产生，在均质抽样下，其近似服从泊松分布，其均值与真实丰度和文库大小成正比；(ii) 相对于泊松抽样的生物学过离散性可以通过负二项分布来捕捉。进一步假设，由于生物学上的缺失和技术灵敏度限制的混合，许多观测值为零，导致了零膨胀。\n\n通过一个双组分混合模型对此进行建模：以概率 $\\pi_i \\in (0,1)$，$Y_i = 0$；否则，$Y_i \\sim \\mathrm{NB}(\\mu_i,\\kappa)$，其中 $\\mathrm{NB}(\\mu,\\kappa)$ 表示均值为 $\\mu$、散度参数为 $\\kappa>0$ 的负二项分布。设真实丰度通过一个带偏移量的对数连接函数依赖于基因型和文库大小，\n$$\n\\log \\mu_i \\;=\\; \\alpha \\;+\\; \\beta G_i \\;+\\; \\log L_i,\n$$\n并允许零膨胀概率 $\\pi_i$ 依赖于样本水平的特征，如灵敏度或组成，也可能通过混杂因素依赖于 $G_i$。一位分析师不了解零膨胀，考虑了实践中常见的两种朴素策略：(a) 对 $Y_i$ 拟合一个标准的负二项广义线性模型 (GLM)，使用对数连接和偏移量 $\\log L_i$，忽略 $\\pi_i$；(b) 将计数进行对数转换，即 $\\log(1+Y_i)$，并对 $G_i$ 拟合同方差高斯线性回归。\n\n从基础抽样模型（泊松抽样因过离散性导致负二项分布，灵敏度限制导致混合诱导的零膨胀）出发，论证当 $\\pi_i$ 很大且可能随 $G_i$ 变化时，在朴素策略下零膨胀如何影响 eQTL 检测，重点关注偏倚、方差、功效和 I 型错误率的校准。然后，提出统计学上合理的建模策略，这些策略能直接处理零膨胀问题，同时保持基因型对丰度影响的可解释性，并控制文库大小和批次效应。\n\n以下哪些陈述是正确的？\n\nA. 当许多观测值为零时，零膨胀会降低检测基因型效应的功效，并且如果 $\\pi_i$ 随 $G_i$ 变化或通过混杂因素与 $G_i$ 相关，则可能诱发伪关联；一个原则性的补救方法是使用一个两部分（跨栏）模型，该模型通过逻辑连接将 $G_i$ 回归到零指示符上，并通过负二项均值将 $G_i$ 回归到正计数上，同时包含偏移量 $\\log L_i$ 和批次的随机效应。\n\nB. 在对 $\\log(1+Y_i)$ 进行对数正态回归时，零膨胀主要导致估计的基因型效应出现向上偏倚，从而在保持有效的 I 型错误率的同时增加了功效；最有效的策略是丢弃所有 $Y_i=0$ 的样本。\n\nC. 对于 $Y_i$，一个具有固定散度的标准负二项 GLM，并在对数转换前添加一个小的伪计数，可以完全解决零膨胀问题；无需显式地对零概率 $\\pi_i$ 进行建模。\n\nD. 当零值是由检测限而非结构性缺失驱动时，它们可以表示为在某个阈值处的截尾；对数丰度上进行截尾（Tobit）回归，包含基因型效应和样本水平的随机截距，相对于朴素高斯回归可以改善校准，特别是当与 $\\log L_i$ 的偏移量结合时。\n\nE. 使用 Spearman 相关性对每百万转录本 (TPM) 进行的基于排序的 eQTL 测试，并忽略文库大小偏移量，能自动对零膨胀具有稳健性，并在存在大量零值时最大化功效。\n\n选择所有适用的选项。", "solution": "我们从基本事实开始：RNA-seq 计数可以通过对分子进行泊松抽样来建模，其生物学过离散性由负二项 (NB) 分布捕捉。当由于检测限或真实缺失导致许多观测计数为零时，混合模型引入了零膨胀：以概率 $\\pi_i$，$Y_i=0$；以概率 $1-\\pi_i$，$Y_i \\sim \\mathrm{NB}(\\mu_i,\\kappa)$，其中均值 $\\mu_i$ 与文库大小 $L_i$ 和真实丰度成比例。基因型效应通过 $\\log \\mu_i = \\alpha + \\beta G_i + \\log L_i$ 进入对数平均丰度。零概率 $\\pi_i$ 可能依赖于灵敏度、组成，并可能通过混杂因素依赖于 $G_i$（例如，如果 $G_i$ 与影响检测的细胞类型组成相关）。\n\n零膨胀对朴素模型的影响：\n\n- 混合模型下的期望和方差：\n$$\n\\mathbb{E}[Y_i \\mid G_i] \\;=\\; (1-\\pi_i)\\mu_i,\\quad \n\\mathrm{Var}(Y_i \\mid G_i) \\;=\\; (1-\\pi_i)\\left(\\mu_i + \\frac{\\mu_i^2}{\\kappa}\\right) + \\pi_i(1-\\pi_i)\\mu_i^2.\n$$\n相对于均值为 $\\mu_i$ 的纯负二项分布，零膨胀将均值降低到 $(1-\\pi_i)\\mu_i$ 并通过项 $\\pi_i(1-\\pi_i)\\mu_i^2$ 增大了方差。如果 $\\pi_i$ 很大，方差可能会显著增大。\n\n- 忽略零膨胀的朴素负二项 GLM：用 $\\log \\tilde\\mu_i = \\tilde\\alpha + \\tilde\\beta G_i + \\log L_i$ 拟合 $Y_i \\sim \\mathrm{NB}(\\tilde\\mu_i,\\tilde\\kappa)$ 会迫使额外的零值由散度 $\\tilde\\kappa$ 或更小的均值来解释。在 Kullback–Leibler 意义上，伪真实参数满足\n$$\n\\tilde\\mu_i \\approx (1-\\pi_i)\\mu_i,\n$$\n直到由 $\\tilde\\kappa$ 吸收的调整项。如果 $\\pi_i$ 随 $G_i$ 变化，则 $\\log \\tilde\\mu_i \\approx \\alpha + \\beta G_i + \\log L_i + \\log(1-\\pi_i)$，因此相对于 $G_i$ 的回归斜率变为 $\\beta + \\frac{\\partial}{\\partial G_i}\\log(1-\\pi_i)$，将丰度效应与零概率效应混为一谈。即使 $\\pi_i$ 是常数，有效均值也被 $(1-\\pi_i)$ 削弱，这降低了信号强度，从而降低了功效。如果由于混杂因素（例如，批次或细胞组成）$\\pi_i$ 与 $G_i$ 相关，朴素的负二项 GLM 可能会表现出伪关联，因为 $\\log(1-\\pi_i)$ 随 $G_i$ 变化。\n\n- 对 $\\log(1+Y_i)$ 的朴素高斯回归：考虑 $T_i=\\log(1+Y_i)$。在混合模型下，\n$$\n\\mathbb{E}[T_i \\mid G_i] \\;=\\; \\pi_i\\log(1+0) + (1-\\pi_i)\\,\\mathbb{E}\\big[\\log(1+Y_i) \\mid Y_i \\sim \\mathrm{NB}(\\mu_i,\\kappa)\\big] \\;=\\; (1-\\pi_i)\\,\\mathbb{E}\\big[\\log(1+Y_i)\\big].\n$$\n当负二项方差适中时，delta 方法近似得出 $\\mathbb{E}[\\log(1+Y_i)] \\approx \\log(1+\\mu_i) - \\frac{\\mathrm{Var}(Y_i)}{2(1+\\mu_i)^2}$。对 $G_i$ 求导，\n$$\n\\frac{\\partial}{\\partial G_i}\\,\\mathbb{E}[T_i \\mid G_i] \\;\\approx\\; (1-\\pi_i)\\,\\frac{\\partial}{\\partial G_i}\\log(1+\\mu_i) \\;+\\; \\text{terms from variance} \\;-\\; \\Big(\\frac{\\partial \\pi_i}{\\partial G_i}\\Big)\\,\\mathbb{E}[\\log(1+Y_i)].\n$$\n如果 $\\pi_i$ 是常数，相对于理想的对数尺度斜率，斜率被 $(1-\\pi_i)$ 缩放，导致衰减。此外，由于 $T_i$ 的方差依赖于 $\\mu_i$ 和 $\\pi_i$，会出现异方差性；使用同方差误差的普通最小二乘法会产生校准不当的标准误。如果 $\\frac{\\partial \\pi_i}{\\partial G_i} \\neq 0$，即使 $\\beta=0$，第二项也可能诱发明显的基因型效应，导致 I 型错误率膨胀。丢弃所有零值（限制于 $Y_i>0$）会将估计目标更改为正值中的条件均值，并且如果正值性依赖于 $G_i$ 或混杂因素，则会引入选择偏倚；它还减少了样本量并丢弃了关于零机制的信息。\n\n遵循基础过程的原则性建模策略：\n\n- 两部分跨栏模型：设 $Z_i = \\mathbb{I}\\{Y_i>0\\}$。对\n$$\n\\mathrm{logit}\\,\\Pr(Z_i = 1 \\mid G_i, L_i, \\text{batch}) \\;=\\; \\gamma_0 + \\gamma_1 G_i + \\delta^\\top \\text{batch}_i + \\eta \\log L_i,\n$$\n进行建模，并且在 $Z_i=1$ 的条件下，对 $Y_i \\mid Z_i=1 \\sim \\mathrm{NB}(\\mu_i,\\kappa)$ 进行建模，其中\n$$\n\\log \\mu_i \\;=\\; \\alpha + \\beta G_i + \\log L_i + b_i,\n$$\n而 $b_i$ 是批次或样本效应的随机截距。这将零生成机制与正值中的丰度分开，避免了将 $\\beta$ 与 $\\pi_i$ 混淆，并通过偏移量正确地考虑了 $\\log L_i$。可以对 $\\gamma_1$（存在/缺失）和 $\\beta$（丰度）进行基因型效应检验，并对基因和变异进行多重检验校正。\n\n- 零膨胀负二项 (ZINB)：或者，在 ZINB 模型中联合建模 $\\pi_i$ 和 $\\mu_i$；将 $G_i$（和 $\\log L_i$）包含在两个部分中。这直接反映了混合模型，并且当零值同时反映技术和生物来源时，可以改善校准和功效。\n\n- 对数丰度的截尾（Tobit）回归：如果零值主要来自检测限，那么 $A_i=\\log(\\text{abundance}_i)$ 仅在 $A_i>\\tau$ 时才被观测到；否则，它在 $\\tau$ 处被截尾。一个 Tobit 模型，\n$$\nA_i^\\ast \\;=\\; \\alpha + \\beta G_i + \\log L_i + b_i + \\varepsilon_i, \\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2),\n$$\n其观测规则为 $A_i = \\max(A_i^\\ast,\\tau)$，将零值视为截尾而非结构性的。当检测限占主导地位时，包含样本水平的随机截距 $b_i$ 和深度偏移量 $\\log L_i$ 可以改善相对于对 $\\log(1+Y_i)$ 的朴素高斯回归的校准。\n\n- 稳健方差估计和偏移量：无论选择何种均值模型，将 $\\log L_i$ 作为偏移量并使用批次的随机效应都能减少混杂。稳健（三明治）标准误解决了异方差性问题，但不能消除因忽略 $\\pi_i$ 而产生的偏倚。\n\n逐项分析：\n\nA. 这个陈述与推导一致。零膨胀将有效均值降低到 $(1-\\pi_i)\\mu_i$，增大了方差，从而降低了功效。如果 $\\pi_i$ 随 $G_i$ 变化或通过混杂因素与其相关，朴素模型会将 $\\beta$ 与 $\\pi_i$ 混淆，产生伪关联。一个两部分跨栏模型，包含一个用于零值的逻辑斯蒂部分和一个用于正计数的负二项部分，并包括偏移量 $\\log L_i$ 和批次随机效应，直接针对混合结构，并保留了可解释性。结论：正确。\n\nB. 声称在对数正态回归下零膨胀主要导致向上偏倚并保持有效的 I 型错误率，这与 delta 方法的分析相矛盾：当 $\\pi_i$ 为常数时，斜率被 $(1-\\pi_i)$ 削弱；当 $\\pi_i$ 随 $G_i$ 变化时，I 型错误率可能被夸大。丢弃所有零值会引入选择偏倚并丢弃信息，不是一个最优策略。结论：错误。\n\nC. 添加伪计数并拟合标准的负二项 GLM 并未显式地对 $\\pi_i$ 建模；额外的零值无法完全被散度吸收，特别是当 $\\pi_i$ 随 $G_i$ 变化时。伪计数改变了尺度，但不能解决来自零机制的偏倚或混杂问题。结论：错误。\n\nD. 当零值是由检测限引起时，将其视为截尾是合适的。在对数丰度上使用包含基因型效应、样本水平随机截距和深度偏移量的 Tobit 模型可以处理截尾问题，并相对于朴素高斯回归改善校准。当结构性零值不太可能时，这是一个有原则的替代方案。结论：正确。\n\nE. 基于排序的检验忽略了偏移量，并且对零值的结（ties）可能很敏感；如果不建模 $\\log L_i$ 或零机制，排序本身并不能自动赋予稳健性，当零的模式与 $G_i$ 相关时，功效可能会降低或关联会产生偏倚。结论：错误。\n\n因此，正确的选项是 A 和 D。", "answer": "$$\\boxed{AD}$$", "id": "4562156"}]}