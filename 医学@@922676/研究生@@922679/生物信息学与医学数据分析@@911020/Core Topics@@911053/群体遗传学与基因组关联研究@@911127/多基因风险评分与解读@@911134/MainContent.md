## 引言
随着[全基因组](@entry_id:195052)关联研究（GWAS）的蓬勃发展，我们已经识别出成千上万个与[复杂疾病](@entry_id:261077)和性状相关的遗传变异。然而，如何将这些海量的、效应微弱的遗传信息整合为一个对个体有意义的、可操作的风险度量，是现代遗传学面临的关键挑战。多基因风险评分（Polygenic Risk Score, PRS）应运而生，它旨在通过一个单一的分数来量化个体对特定疾病的遗传易感性，为[精准医疗](@entry_id:152668)和个性化预防开辟了新的可能。

本文旨在系统性地剖析多基因风险评分的完整生命周期——从其深层的统计学原理到广阔的临床应用前景。读者将踏上一段从理论到实践的旅程，全面掌握PRS的构建、评估、解读与伦理考量。

在“原理与机制”一章中，我们将深入探讨构建PRS的核心数学模型、加性遗传假设，以及必须应对的关键统计学挑战，如[连锁不平衡](@entry_id:146203)和群体分层。接着，在“应用与跨学科连接”一章中，我们将展示PRS如何在临床医学、流行病学和药物基因组学等领域发挥作用，并讨论如何评估其临床效用、与患者沟通风险，以及应对跨祖源人群的公平性问题。最后，“动手实践”部分将提供具体的编码练习，帮助读者将理论知识转化为实际操作能力，亲手构建和解释PRS。

## 原理与机制

本章深入探讨多基因风险评分（Polygenic Risk Score, PRS）背后的核心科学原理与计算机制。我们将从构建PRS的基础数学模型出发，剖析其核心的加性遗传假设，并系统性地阐述在实际应用中必须应对的关键统计学挑战，例如[群体分层](@entry_id:175542)、胜者诅咒和[连锁不平衡](@entry_id:146203)。随后，我们将介绍从经典的 clump-and-threshold 方法到前沿的贝叶斯[收缩方法](@entry_id:167472)的演进，并探讨如何选择最适合特定遗传结构的策略。最后，本章将讨论标准加性模型的局限性，如非加性效应，并阐明在不同人群和研究设计中应用PRS时面临的可移植性问题。

### 多基因风险评分的基本加性模型

多基因风险评分（PRS）的构建基于一个简洁而强大的线性模型，该模型旨在通过汇集大量遗传变异的微小效应来量化个体对特定性状或疾病的遗传易感性。一个标准的PRS计算公式如下：

$$
PRS_i = \sum_{j=1}^{m} \hat{\beta}_j x_{ij}
$$

为了深刻理解这一公式，我们必须精确定义其中的每一个组成部分 [@problem_id:4594559]。

-   $i$ 代表研究队列中的某一个体。
-   $j$ 代表纳入评分模型中的某一个遗传变异，通常是[单核苷酸多态性](@entry_id:173601)（Single Nucleotide Polymorphism, SNP）。
-   $m$ 是构成该PRS的变异总数。
-   $x_{ij}$ 是个体 $i$ 在变异位点 $j$ 的 **效应等位[基因剂量](@entry_id:141444)（effect-allele dosage）**。效应等位基因是指在全基因组关联研究（Genome-Wide Association Study, GWAS）中被发现与性状相关的等位基因。对于一个二倍体生物（如人类），基因型通常被编码为一个加性变量：如果个体不携带效应等位基因，则 $x_{ij}=0$；如果携带一个（杂合子），则 $x_{ij}=1$；如果携带两个（纯合子），则 $x_{ij}=2$。在现代遗传学研究中，基因型数据通常通过[插补](@entry_id:270805)（imputation）获得，此时 $x_{ij}$ 可以是区间 $[0, 2]$ 内的一个期望剂量值，代表个体携带效应等位基因数量的概率加权平均值。
-   $\hat{\beta}_j$ 是从一个独立的、大规模的发现队列（discovery cohort）的GWAS中估计出的变异 $j$ 的 **效应值（effect size）**。这个值代表了每增加一个效应等位基因拷贝，个体性状的期望变化量。至关重要的是，$\hat{\beta}_j$ 的单位和尺度取决于GWAS所使用的[统计模型](@entry_id:755400)。
    -   对于 **定量性状**（如身高、血压），若使用[线性回归](@entry_id:142318)，$\hat{\beta}_j$ 的单位就是性状本身的单位（例如，厘米）。
    -   对于 **二元性状**（如病例-对照研究中的疾病状态），若使用[逻辑斯谛回归](@entry_id:136386)（Logistic Regression），$\hat{\beta}_j$ 代表的是 **对数优势比（log-odds ratio）**，是一个无量纲的量。
    -   对于 **生存数据**，若使用[Cox比例风险模型](@entry_id:174252)，$\hat{\beta}_j$ 代表的是 **对数风险比（log-hazard ratio）**。

因此，$PRS_i$ 本身是一个 **[线性预测](@entry_id:180569)器（linear predictor）**，其尺度与用于构建它的 $\hat{\beta}_j$ 相同。例如，基于[逻辑斯谛回归](@entry_id:136386)结果构建的PRS，其单位是[对数优势比](@entry_id:141427)。要将其转化为更直观的风险度量，例如个体相对于基线风险的优势比（Odds Ratio, OR），必须应用相应模型的逆连接函数（inverse link function）。在此例中，需要对PRS进行指数变换，即 $\exp(PRS_i)$。

这一线性模型的核心是 **加性假设（additive assumption）**。它假定每个变异对性状的影响是独立的，并且总的遗传效应是所有这些独立效应的简单加总。在[数量遗传学](@entry_id:154685)的框架下，这对应于经典的 **遗传[易感性-阈值模型](@entry_id:154597)（liability-threshold model）**，其中个体的表型（如是否患病）由一个潜在的、连续的正态分布的易感性（liability）决定。该模型的遗传部分可以分解为加性（additive）、显性（dominance）和上位性（epistasis）等组分。一个标准的加性PRS旨在估计这个模型中的加性遗传组分 $A$ [@problem_id:4594814]。当显性（$D$）和[上位性](@entry_id:136574)（$I$）效应对性状变异的贡献可以忽略不计时，加性模型是一个良好近似。我们将在后续章节深入探讨当这一核心假设被违背时的情况。

### 从GWAS中估计效应值：关键挑战

PRS的准确性高度依赖于其权重 $\hat{\beta}_j$ 的质量，而这些权重来源于GWAS。然而，从GWAS中获得的效应值估计可能受到多种系统性偏差的影响，若不加以识别和校正，这些偏差将直接传递并污染下游的PRS。

#### 群体分层

**[群体分层](@entry_id:175542)（Population stratification）** 是GWAS中最主要的混杂因素之一。它指的是研究样本由多个具有不同遗传背景的亚群组成，并且这些亚群在[等位基因频率](@entry_id:146872)和非遗传性状相关暴露（如环境、生活方式）上均存在系统性差异。当这种结构未经校正时，会导致虚假的[基因-性状关联](@entry_id:263910) [@problem_id:4594393]。

我们可以通过一个简化的数学模型来精确理解这一现象。假设个体 $i$ 的真实表型 $y_i$ 由以下部分决定：
$$
y_i = \mu + \alpha g_i + \gamma z_i + \varepsilon_i
$$
其中，$g_i$ 是基因型剂量，$\alpha$ 是其真实的因果效应， $z_i$ 是一个未被观测到的、代表个体祖源群体的[指示变量](@entry_id:266428)，$\gamma$ 是与该祖源相关的非遗传因素（如环境）对表型的影响，$\mu$ 是基线值，$\varepsilon_i$ 是随机误差。

一个未校正祖源信息的“朴素”GWAS模型仅仅将 $y_i$ 对 $g_i$ 进行回归。根据遗漏变量偏倚（omitted-variable bias）的经典理论，此时估计出的效应值 $\widehat{\alpha}$ 的期望为：
$$
\mathbb{E}[\widehat{\alpha}] = \frac{\operatorname{Cov}(g_i, y_i)}{\operatorname{Var}(g_i)} = \alpha + \gamma \frac{\operatorname{Cov}(g_i, z_i)}{\operatorname{Var}(g_i)}
$$
这个公式清晰地表明，估计的效应值 $\widehat{\alpha}$ 由两部分构成：真实的遗传效应 $\alpha$ 和一个偏倚项。这个偏倚项的大小取决于两个因素的乘积：祖源相关的非遗传效应强度（$\gamma$）以及基因型与祖源之间的相关性（$\operatorname{Cov}(g_i, z_i)$）。只要这两个因素同时不为零，$\widehat{\alpha}$ 就是一个有偏估计。即使一个变异完全没有生物学效应（$\alpha=0$），但只要其[等位基因频率](@entry_id:146872)在不同祖源群体间存在差异（导致 $\operatorname{Cov}(g_i, z_i) \neq 0$），它就可能因为与真正的非遗传风险因素（由 $z_i$ 代理）相关联而表现出虚假的统计显著性。

当这些被污染的效应值被用于构建PRS时，该PRS不仅捕捉了真实的遗传信号，还“吸收”了与祖源相关的环境和社会经济因素。这导致PRS在不同祖源人群中的预测性能出现严重偏差和校准错误，因为它实际上成了一个祖源信息的代理指标，而非纯粹的遗传风险度量。现代GWAS通常通过在线性模型中加入主成分（Principal Components）作为协变量来校正[群体分层](@entry_id:175542)。

#### 胜者诅咒

**胜者诅咒（Winner's Curse）** 是统计学中一个普遍存在的选择性偏倚现象，在GWAS的背景下尤为突出。GWAS需要[检验数](@entry_id:173345)百万个遗传变异，为了控制[假阳性率](@entry_id:636147)，研究者必须采用极其严格的[统计显著性](@entry_id:147554)阈值（例如，$p  5 \times 10^{-8}$）。只有那些偶然获得了较大效应值估计的变异才能“胜出”并通过这一阈值 [@problem_id:4594399]。

从统计学原理上看，每个变异的真实效应值为 $\beta_j$，而GWAS得到的估计值 $\hat{\beta}_j$ 是一个围绕 $\beta_j$ 波动的随机变量，其抽样分布可近似为正态分布 $\mathcal{N}(\beta_j, s_j^2)$。GWAS的选择标准是基于Z统计量 $|Z_j| = |\hat{\beta}_j / s_j|$ 是否足够大。这种选择行为相当于从一个完整的正态分布中只挑选出位于尾部的样本。

对于一个给定的真实效应 $\beta_j$，只有当随机抽样误差恰好与 $\beta_j$ 同向且足够大，使得 $\hat{\beta}_j$ 的绝对值被高估时，这个变异才更有可能达到全基因组显著性。因此，当我们只观察那些“胜出”的变异时，它们的效应值估计 $\hat{\beta}_j$ 的条件期望值会系统性地偏离真实的 $\beta_j$，方向与估计值的符号相同。具体来说：
-   对于一个被发现具有正向效应的SNP，其[条件期望](@entry_id:159140)满足 $E[\hat{\beta}_j \mid Z_j > c] > \beta_j$。
-   对于一个被发现具有负向效应的SNP，其[条件期望](@entry_id:159140)满足 $E[\hat{\beta}_j \mid Z_j  -c]  \beta_j$。

这意味着，在达到显著性的变异集合中，其效应值的 **绝对值** 被普遍高估了。如果直接使用这些被高估的效应值来构建PRS，会导致PRS的预测效应在独立的验证数据集中被夸大。这就是胜者诅咒的直接后果。为了修正这种偏倚，研究者需要采用诸如贝叶斯收缩、样本分割或在独立样本中重新估计效应值等方法。

### 从位点到评分：处理[遗传相关](@entry_id:176283)性

在获得了每个变异的效应值估计后，下一步是如何将它们组合成一个单一的评分。一个核心的挑战是，人类基因组上的变异并非相互独立，而是以块状结构遗传，这种现象被称为 **[连锁不平衡](@entry_id:146203)（Linkage Disequilibrium, LD）**。

#### 连锁不平衡与信息冗余

连锁不平衡是指在某一群体中，不同基因座位的等位基因之间存在非随机关联。从第一性原理出发，如果位点 $j$ 和 $k$ 上的等位基因是随机组合的，那么同时携带两个特定等位基因的单倍型（haplotype）频率应等于这两个等位基因各自频率的乘积。当实际的单倍型频率偏离这个乘积时，就存在LD。其程度可以用LD系数 $D_{jk}$ 来量化 [@problem_id:4594411]：
$$
D_{jk} = \mathbb{P}(A_j=1, A_k=1) - p_j p_k
$$
其中，$A_j=1$ 和 $A_k=1$ 代表在一条染色体上存在特定等位基因的事件，$p_j$ 和 $p_k$ 是它们的边际频率。

LD在单倍型（gametic）层面的存在，会直接导致在[二倍体](@entry_id:268054)（diploid）基因型层面的相关性。在[随机交配](@entry_id:149892)的群体中，两个不同位点的基因型剂量 $G_j$ 和 $G_k$ 之间的协方差可以直接表示为：
$$
\operatorname{Cov}(G_j, G_k) = 2D_{jk}
$$
这个简单的关系揭示了一个深刻的后果：由于LD的存在，PRS公式 $\sum \hat{\beta}_j G_j$ 中的许多项 $G_j$ 是相互关联的。如果直接将位于同一LD块内的多个相关变异都纳入PRS，就相当于将同一个潜在的遗传信号重复计算了多次。这不仅会不成比例地放大该基因组区域的贡献，还会累积相关的[估计误差](@entry_id:263890)，从而降低PRS的预测准确性和稳健性。因此，任何有效的PRS构建方法都必须妥善处理由LD引起的信息冗余。

#### 基础方法：Clumping and Thresholding (C+T)

处理LD最常用和最直观的方法之一是 **Clumping and Thresholding (C+T)**。这个两步流程旨在筛选出一个信息量大且近似独立的变异集合 [@problem_id:4594780]。

1.  **Clumping (聚类)**：此步骤旨在解决LD问题。算法首先根据GWAS的[p值](@entry_id:136498)确定“领头SNP”（lead SNP），即某个基因组区域内关联信号最强的变异。然后，它会移除所有与该领头SNP处于高度LD状态（例如，[相关系数](@entry_id:147037)的平方 $r^2$ 大于一个预设阈值，如 $0.1$）的邻近SNP。这个过程在整个基因组中迭代进行，最终得到一个由各地最强信号代表组成的、相对独立的SNP集合。

2.  **Thresholding (阈值筛选)**：在经过clumping处理的SNP集合上，研究者会应用一个[p值](@entry_id:136498)阈值（$p_T$）。只有GWAS关联p值小于这个阈值的SNP才会被最终纳入PRS模型。这个阈值是一个可调参数，通常需要在一系列值（例如，$5 \times 10^{-8}, 10^{-6}, 10^{-4}, 0.01, 0.1, 0.5$）中进行选择，以在独立的验证数据集中找到最优的预测性能。

为什么[p值](@entry_id:136498)阈值能够作为优化PRS的工具？其背后的逻辑是一个 **[信噪比](@entry_id:271196)（signal-to-noise ratio）** 的权衡。我们可以将GWAS的Z统计量分解为信号和噪声两部分：
$$
Z_j = \frac{\beta_j \sqrt{N}}{\sigma} + \eta_j
$$
其中，第一项 $\beta_j \sqrt{N}/\sigma$ 代表真实的遗传信号强度（它与真实效应 $\beta_j$ 和研究样本量 $N$ 成正比），第二项 $\eta_j \sim \mathcal{N}(0,1)$ 代表随机抽样噪声。[p值](@entry_id:136498)阈值筛选等价于对Z统计量的绝对值进行筛选。一个严格的p值阈值会倾向于选择那些真实信号 $\beta_j$ 非常强的SNP，但代价是会错过大量真实但信号较弱的SNP。相反，一个宽松的[p值](@entry_id:136498)阈值会纳入更多微弱的真实信号，但同时也会引入大量纯粹的噪声（即那些 $\beta_j=0$ 但由于偶然性 $\eta_j$ 较大的SNP）。因此，通过调整[p值](@entry_id:136498)阈值，研究者实际上是在探索一个最佳平衡点，使得纳入的总信号最大化，而总噪声最小化，从而实现最佳的预测性能。

### 先进的PRS方法：拥抱多基因性和[连锁不平衡](@entry_id:146203)

尽管C+T方法直观且易于实现，但它本质上是一种[启发式算法](@entry_id:176797)，其硬性阈值选择可能导致信息损失。特别是对于复杂的“多基因”性状，其遗传基础由成千上万个效应微弱的变异构成，C+T方法往往表现不佳。因为这些变异的p值很少能达到严格的阈值，导致大部分遗传信号被丢弃 [@problem_id:4594782]。这一认知推动了更先进的、基于模型的PRS构建方法的发展，特别是贝叶斯[收缩方法](@entry_id:167472)。

这些方法通常在一个统一的贝叶斯回归框架下运作，它们将GWAS的摘要统计数据（$\hat{\beta}_j$ 和其标准误）作为“数据”，并结合一个外部的LD参考面板（用于估计变异间的相关性矩阵 $\mathbf{R}$）和一个关于真实效应值 $\beta_j$ 分布的“先验”假设。通过后验推断，可以得到考虑了LD和先验信念的、经过“收缩”的效应值估计。不同方法的核心区别在于它们对遗传结构（即 $\beta_j$ 的分布）的先验假设不同 [@problem_id:4594710]。

-   **LDpred**：该方法采用“尖峰-厚板”（spike-and-slab）先验，假设基因组中只有一部分比例（$\pi$）的变异是因果变异（其效应服从正态分布，即“厚板”），而其余部分则完全没有效应（效应精确为零，即“尖峰”）。通过调整 $\pi$，LDpred可以灵活地模拟从稀疏到高度多基因的各种遗传结构。

-   **PRS-CS**：此方法使用一种“[连续收缩](@entry_id:154115)”（Continuous Shrinkage）先验，特别是Strawderman-Berger先验。这种先验在零点有一个无限高的尖峰，可以有效地将噪声效应收缩至接近零；同时它具有[重尾](@entry_id:274276)（heavy tails），允许少数具有强信号的真实效应基本不被收缩。其理论优势在于无需预先指定因果变异的比例，能够自适应地匹配未知的遗传结构，对LD参考面板的轻微不匹配也更具稳健性。

-   **SBayesR**：该方法则采用一个有限正态混合模型作为先验。它假定每个效应值 $\beta_j$ 来自于几个预设方差的正态分布的混合，其中包括一个方差为零的“无效”组分。这使得模型能够捕捉更复杂的效应分布，例如一个由大量微小效应和少数较大效应共同构成的遗传结构。

这些先进方法通过对所有变异进行“软”阈值处理（即收缩而非完全剔除）并明确地在模型中整合LD信息，通常能够在多基因性状的预测中获得比C+T更高的准确性。

在此背景下，区分 **遗传风险评分（Genetic Risk Score, GRS）** 和 **多基因风险评分（PRS）** 这两个术语也变得重要。历史上，GRS通常指代早期基于少数几个达到全基因组显著性的“明星”位点构建的评分，无论是加权还是不加权的。而PRS这一术语的流行，则伴随着对复杂性状“多基因”本质的认识，强调了汇总大量（成千上万甚至数百万）亚显著变异信号的必要性。因此，**主要的区别在于纳入评分的变异数量**：GRS通常是“寡基因”的，而PRS是“多基因”的。然而，在文献中，当评分包含的位点数量处于中等规模（如几十到几百个）时，这两个术语有时会被互换使用 [@problem_id:4594875]。

### 超越加性模型：纳入非加性效应

标准PRS模型的一个核心局限是其固有的加性假设，即忽略了 **显性（dominance）** 和 **上位性（epistasis）** 等非加性遗传效应。这些效应的存在意味着基因的真实作用方式是非线性的，一个单纯的加性模型可能无法完全捕捉，甚至会误解其遗传贡献 [@problem_id:4594814]。

**显性效应** 指的是杂合子（如基因型Aa）的表型值不完全是两个纯合子（AA和aa）表型值的中间值。在一个纯粹的显性效应场景中（例如，只有杂合子才表现出特定表型），一个旨在估计加性效应的[线性回归](@entry_id:142318)模型会产生误导性的结果。例如，对于一个只有杂合子效应（$\delta$）的位点，其在加性模型中估计出的效应值 $w$ 实际上等于 $\delta(1-2p)$，其中 $p$ 是等位基因频率 [@problem_id:4594781]。这意味着，估计出的“加性”效应不仅大小依赖于等位基因频率，当 $p > 0.5$ 时，其符号甚至可能与真实效应相反。

**[上位性](@entry_id:136574)效应** 指的是不同基因位点之间的相互作用，即一个位点的效应依赖于另一个位点的基因型。在加性模型中，这种[交互作用](@entry_id:164533)通常被忽略。然而，[上位性](@entry_id:136574)效应可以通过LD“泄漏”到表观的加性效应中。具体来说，如果两个存在上位性[交互作用](@entry_id:164533)的位点处于[连锁不平衡](@entry_id:146203)状态，那么对其中任一位点进行边缘回归分析时，都会观察到一个非零的“加性”效应，即使该位点本身没有独立的加性贡献。这个表观效应的大小与[上位性](@entry_id:136574)效应的强度以及LD的强度成正比 [@problem_id:4594781]。

虽然加性效应通常解释了复杂性状的大部分遗传变异，但非加性效应在特定疾病和性状中可能扮演重要角色。为了捕捉这些效应，研究者可以构建更复杂的模型。例如，可以通过在标准的[线性模型](@entry_id:178302)中加入显性[指示变量](@entry_id:266428)（如，一个指示基因型是否为杂合子的变量）和基因-基因交互项（如，两个位点基因型剂量的乘积）来直接估计[显性与上位性](@entry_id:193536)效应 [@problem_id:4594781]。此外，在[混合模型](@entry_id:266571)框架下，除了标准的加性遗传关系矩阵（GRM），还可以构建显性GRM和上位性GRM，以分别估计这些非加性组分对总[表型方差](@entry_id:274482)的贡献。

### 应用与解释：可移植性的挑战

一个PRS构建完成后，其最终的价值体现在它能否在新的、独立的样本中准确预测风险。然而，PRS的预测性能常常在从 **基础数据集（base dataset）**（用于GWAS发现和权重估计的样本）转移到 **目标数据集（target dataset）**（用于PRS验证和应用的样本）时出现显著下降。这种性能衰减，或称为 **可移植性（portability）** 问题，源于多种因素的不匹配 [@problem_id:4594865]。

-   **祖源不匹配（Ancestry Mismatch）**：这是PRS可移植性差最主要的原因。不同人群由于其独特的演化历史，其[等位基因频率](@entry_id:146872)和LD模式存在显著差异。当一个主要在欧洲人群中开发的PRS被应用于非洲或亚洲人群时，其性能通常会大幅下降。这是因为在GWAS中发现的标签SNP（tag SNP）与其所代理的因果变异之间的LD关系在不同人群中发生了变化。一个在欧洲人群中是良好代理的标签SNP，在非洲人群中可能不再是，反之亦然。这导致原有的权重不再适用。

-   **表型定义不匹配（Phenotype Definition Mismatch）**：基础数据集和目标数据集可能对同一疾病或性状采用了不同的定义或测量方式。例如，基础GWAS可能基于严格的临床诊断（二元性状），而目标队列中可用的可能是与疾病相关的某个连续生物标志物。从[逻辑斯谛回归](@entry_id:136386)（对数优势比尺度）得到的权重直接用于预测一个连续性状，会导致PRS的校准不良和潜在的系统性偏差。在这种情况下，需要进行适当的尺度转换才能进行有意义的比较和解释。

-   **技术平台不匹配（Technical Platform Mismatch）**：基础和目标数据集可能使用了不同的基因分型芯片和插补参考面板。这会导致两个问题：首先，两个数据集共有的高质量变异数量可能有限，导致PRS中包含的信息量减少；其次，即使对于共同的变异，不同的插补参考面板（例如，一个主要基于欧洲人群，另一个更多样化）也会导致插补质量的差异。低质量的插补基因型会引入噪声，直接削弱PRS与表型之间的关联。

综上所述，PRS的构建和解释是一个涉及多层面考量的复杂过程。它不仅要求对核心的[统计模型](@entry_id:755400)有深刻理解，还需要审慎处理数据生成过程中的各种生物学和技术混杂因素，并清醒地认识到其在不同人群和情境中应用的局限性。