{"hands_on_practices": [{"introduction": "在深入研究复杂的计算之前，我们必须首先掌握基因型定相的基本术语。此练习旨在巩固对单倍型、定相以及“转换错误”概念的理解，这些都是衡量定相准确性的基础。通过分析一个简单的双位点杂合基因型，我们将明确区分可能的单倍型组合与定相错误，为后续更高级的分析奠定坚实的基础 [@problem_id:4569491]。", "problem": "一个二倍体生物携带两条同源染色体。在一个双等位基因座上，基因型记录了存在于两条同源染色体上的等位基因的无序多重集；如果两个等位基因不同，则该基因型称为杂合的。单倍型是沿着单条同源染色体的等位基因的有序序列，而定相（phasing）则是将每个基因座上观察到的等位基因分配给两个单倍型中的一个。考虑一个个体，其在基因座 $1$ 上的观察基因型为 $A/G$，在基因座 $2$ 上的观察基因型为 $T/C$。仅使用二倍性、杂合性、单倍型和跨基因座定相一致性的核心定义，确定哪个选项正确地列举了与观察到的基因型一致的所有可能的定相单倍型对，并且还正确地定义了什么构成了跨越基因座 $1$ 和 $2$ 的片段特有的转换错误。\n  \nA. 与观察到的基因型一致的唯一可能的定相单倍型对是 $\\{(A,T),(G,C)\\}$ 和 $\\{(A,C),(G,T)\\}$。基因座 $1$ 和 $2$ 之间的转换错误意味着，相对于真实的定相，推断出的基因座 $2$ 上等位基因到染色体的分配相对于基因座 $1$ 上的分配是颠倒的，从而产生了互补的定相配对；等效地说，两个基因座之间的相对相位被反转了。\n\nB. 可能的定相单倍型包括 $\\{(A,T),(G,C)\\}$、$\\{(A,C),(G,T)\\}$，以及 $\\{(A,G),(T,C)\\}$，因为每个基因座可以任意地在染色体间配对。转换错误是指在任一基因座上，无论是否杂合，推断出的等位基因与真实的等位基因不匹配的任何情况。\n\nC. 可能的单倍型正好是 $\\{(A,T),(G,C)\\}$ 和 $\\{(A,C),(G,T)\\}$，但转换错误被定义为错误分配基因座 $1$ 上的等位基因，而保持基因座 $2$ 正确；在纯合位点上的错误分配也构成转换错误。\n\nD. 可能的单倍型是 $\\{(A,T),(G,C)\\}$ 和 $\\{(A,C),(G,T)\\}$，但转换错误仅在基因座 $1$ 和 $2$ 之间的减数分裂重组改变了真实的单倍型时发生；因此，当真实情况是 $\\{(A,T),(G,C)\\}$ 时，推断出 $\\{(A,C),(G,T)\\}$ 并不算转换错误。", "solution": "该问题在科学上是合理的，旨在检验对基因型、单倍型、定相和转换错误这些基本概念的理解。问题表述清晰，并提供了所有必要的信息。\n\n**第一部分：确定可能的单倍型对**\n\n问题描述了一个在两个基因座上均为杂合的二倍体个体：\n- 基因座1的基因型为 $A/G$。\n- 基因座2的基因型为 $T/C$。\n\n**基因型**是无序的等位基因集合，而**单倍型**是存在于单条染色体上的有序等位基因序列。**定相**的过程就是确定这两条单倍型。\n\n对于这个个体，等位基因 $A$ 和 $G$ 必须分别位于两条不同的同源染色体上。同样，等位基因 $T$ 和 $C$ 也必须分别位于两条不同的同源染色体上。这导致了两种可能的组合方式来构建两条完整的单倍型：\n1.  **组合 1 (顺式构型)**：一条染色体携带 $(A, T)$，另一条携带 $(G, C)$。该单倍型对表示为 $\\{(A,T), (G,C)\\}$。\n2.  **组合 2 (反式构型)**：一条染色体携带 $(A, C)$，另一条携带 $(G, T)$。该单倍型对表示为 $\\{(A,C), (G,T)\\}$。\n\n这两个是唯一与观察到的基因型一致的单倍型对。选项B中提出的 $\\{(A,G), (T,C)\\}$ 是不正确的，因为它将两个基因座的等位基因混为一谈，这不符合单倍型的定义。\n\n**第二部分：定义转换错误**\n\n**转换错误（Switch Error）**是衡量定相准确性的关键指标。它特指在两个相邻的杂合位点之间，推断出的相对相位与真实相位相反。\n- 假设真实的单倍型对是 $\\{(A,T), (G,C)\\}$。\n- 如果定相算法推断出的结果是 $\\{(A,C), (G,T)\\}$，那么在基因座1和2之间就发生了一次转换错误。\n\n这个错误可以被看作是，相对于基因座1上等位基因的分配，基因座2上等位基因在两条染色体间的分配被“转换”或“颠倒”了。\n\n**评估选项：**\n- **A选项**：正确地列出了两种可能的单倍型对，并准确地将转换错误定义为两个基因座之间相对相位的反转。这是正确的。\n- **B选项**：列出的单倍型对不正确，且对转换错误的定义也错误，将其混淆为基因分型错误。\n- **C选项**：对转换错误的定义不准确，将其描述为仅一个基因座的错误分配，而转换错误是关于两个位点间 *相对* 相位的错误。\n- **D选项**：将推断错误（转换错误）与生物学过程（减数分裂重组）相混淆。转换错误是衡量推断结果与真实情况之间差异的指标，无论真实情况是如何产生的。\n\n因此，选项A是唯一完全正确的描述。", "answer": "$$\\boxed{A}$$", "id": "4569491"}, {"introduction": "基因型填充算法通常不会输出一个单一的“最佳猜测”基因型，而是提供一个关于各种可能性的后验概率分布。本练习将演示如何将这些概率信息转化为一个简洁而实用的指标——“等位基因剂量”（dosage），它代表了在给定数据下某个等位基因的期望计数。掌握剂量计算对于解释和使用填充数据至关重要，因为它是许多下游分析（如关联研究）的标准输入 [@problem_id:4569492]。", "problem": "考虑一个具有指定次要等位基因的双等位基因单核苷酸多态性（SNP）。设未观测到的基因型由随机变量 $G \\in \\{0,1,2\\}$ 表示，代表次要等位基因的数量。一个基于隐马尔可夫模型（HMM）的填补算法，根据观测数据生成了关于 $G$ 的后验分布，其编码为 $P(G=0 \\mid \\text{data}) = 0.1$，$P(G=1 \\mid \\text{data}) = 0.3$ 和 $P(G=2 \\mid \\text{data}) = 0.6$。仅使用概率论中条件期望的核心定义，以及将填补剂量解释为后验分布下期望的次要等位基因计数，计算此 SNP 的填补剂量 $\\hat{d}$。\n\n然后，仅使用概率校准的基本原则，简要用文字说明，在一个拥有可用真实基因型的大型队列中，您将如何评估此类后验基因型概率是否针对真实基因型进行了校准，本题中无需计算任何数值指标。\n\n提供填补剂量的精确值（无需四舍五入）。剂量不需要单位。", "solution": "该问题被评估为有效。它在科学上基于统计遗传学和概率论的原理，问题表述清晰，提供了所有必要信息，并且没有歧义或矛盾。\n\n该问题包含两部分。第一部分要求计算一个单核苷酸多态性（SNP）的填补剂量，第二部分要求从概念上解释如何评估基因型概率的校准情况。\n\n**第一部分：计算填补剂量**\n\n问题将未观测的基因型定义为一个离散随机变量 $G$，它代表一个双等位基因 SNP 上次要等位基因的数量。$G$ 的可能取值为 $g \\in \\{0, 1, 2\\}$，分别对应零个、一个或两个次要等位基因的拷贝。\n\n一个填补算法已经生成了基于观测数据的 $G$ 的条件后验概率分布。这些概率如下：\n$P(G=0 \\mid \\text{data}) = 0.1$\n$P(G=1 \\mid \\text{data}) = 0.3$\n$P(G=2 \\mid \\text{data}) = 0.6$\n\n问题指出，填补剂量（记为 $\\hat{d}$）应被解释为在该后验分布下期望的次要等位基因计数。这等同于计算随机变量 $G$ 在给定数据下的条件期望，写作 $E[G \\mid \\text{data}]$。\n\n根据离散随机变量期望的核心定义，期望值是每个可能值乘以其对应概率的总和。将此定义应用于条件情境，我们得到：\n$$ \\hat{d} = E[G \\mid \\text{data}] = \\sum_{g \\in \\{0,1,2\\}} g \\cdot P(G=g \\mid \\text{data}) $$\n\n现在我们可以将给定的值代入这个公式：\n$$ \\hat{d} = (0 \\cdot P(G=0 \\mid \\text{data})) + (1 \\cdot P(G=1 \\mid \\text{data})) + (2 \\cdot P(G=2 \\mid \\text{data})) $$\n$$ \\hat{d} = (0 \\cdot 0.1) + (1 \\cdot 0.3) + (2 \\cdot 0.6) $$\n$$ \\hat{d} = 0 + 0.3 + 1.2 $$\n$$ \\hat{d} = 1.5 $$\n\n因此，该 SNP 的填补剂量为 $1.5$。这个值代表在给定观测数据和模型的情况下，我们期望该个体拥有的次要等位基因的平均数量。\n\n**第二部分：评估概率校准**\n\n问题的第二部分要求解释如何使用基本原则和一个拥有已知真实基因型的大型队列，来评估后验基因型概率是否经过校准。\n\n概率校准，从其最根本的意义上说，是指如果一个模型以概率 $p$ 预测一个结果，那么在做出该预测的许多实例中，该结果被观察到的频率应约等于 $p$。\n\n要评估后验基因型概率（例如，对于 $g \\in \\{0, 1, 2\\}$ 的 $P(G=g \\mid \\text{data})$）相对于真实基因型的校准情况，可以执行以下概念性步骤：\n1.  取一个大型个体队列，对于队列中的每个个体，我们既有模型填补的后验概率，也有通过实验确定的真实基因型。\n2.  为了检查特定基因型（例如 $G=2$）的校准情况，根据预测的后验概率 $P(G=2 \\mid \\text{data})$ 将个体分组（分箱）。例如，一个分组可以包含所有模型预测 $P(G=2 \\mid \\text{data})$ 在区间 $[0.55, 0.65]$ 内的个体。\n3.  在每个分组内，计算经验频率：统计真实基因型确实为 $G=2$ 的个体数量，然后用该数量除以该分组内的总个体数。\n4.  如果模型校准良好，这个计算出的经验频率应接近该分组的平均预测概率（例如，对于 $[0.55, 0.65]$ 分组，该频率应约等于 $0.6$）。\n5.  对覆盖 $0$ 到 $1$ 范围的多个概率分组，以及对所有可能的基因型状态（$G=0$、$G=1$ 和 $G=2$），重复此过程，以形成对模型校准情况的全面评估。一个校准良好的模型，其指定的概率与在所有基因型和所有概率水平上观察到的频率之间将表现出高度的一致性。", "answer": "$$\\boxed{1.5}$$", "id": "4569492"}, {"introduction": "生成并解释了填充数据后，我们如何评估其质量？最后一个练习聚焦于计算和解读“转换错误率”（switch error rate），这是评估定相性能的关键质量控制指标。理解这一比率对于判断定相单倍型的可靠性至关重要，直接影响到关联研究或群体遗传学分析等后续应用的成败 [@problem_id:4569545]。", "problem": "在基因型定相和插补中，一个常见的质量指标是推断出的单倍型在连续杂合位点之间错误地切换其亲本来源的发生率。考虑一个已定相的染色体片段，该片段与一个源自亲子三人组的外部真实数据集进行评估。该片段包含 $T$ 对相邻的杂合位点，这些位点定义了潜在的定相转换位置（杂合转换）。假设校对过程在该片段中识别出 $E$ 个错误的定相转换。使用将每个杂合转换视为定相转换正确与否的伯努利试验的基本定义，并将转换错误率定义为转换中错误部分的期望分数，计算当有 $T = 1{,}000$ 个转换和 $E = 25$ 个错误转换时的转换错误率。请以小数形式给出最终答案，并四舍五入至四位有效数字。然后，基于基于单倍型的推断的基本原理以及基于隐马尔可夫模型（HMM）的定相在不同连锁不平衡（LD）和次要等位基因频率（MAF）区域中的行为，论证此水平的转换错误率预计将如何影响下游基于单倍型的插补准确性和相关分析。在数值答案中不要使用百分号；将该比率表示为无单位的小数。", "solution": "该问题要求根据给定数据计算转换错误率，并随后论证其对下游生物信息学分析的影响。验证过程确认该问题具有科学依据、提法明确，并包含完整解答所需的所有信息。\n\n首先，让我们将转换错误率（$SER$）的计算过程形式化。问题指出， $T$ 个相邻的杂合位点对（或称杂合转换）中的每一个都可以被视为一次伯努利试验。在此背景下，一次试验代表了发生定相转换错误的一次机会。每次试验的结果是二元的：要么定相被正确推断，要么是错误的。问题给出了此类转换的总数 $T$ 和观测到的错误定相转换的总数 $E$。\n\n给定的数值为：\n- 杂合转换总数，$T = 1,000$。\n- 错误定相转换数，$E = 25$。\n\n问题将转换错误率定义为转换中错误部分的期望分数。对于一系列伯努利试验，对目标事件（在本例中为错误）发生概率的最佳估计是其发生的相对频率。因此，转换错误率 $SER$ 计算为观测到的错误数与总错误机会数之比：\n$$\nSER = \\frac{E}{T}\n$$\n将给定的数值代入此方程，得到：\n$$\nSER = \\frac{25}{1,000} = 0.025\n$$\n问题要求最终答案以小数形式表示，并四舍五入至四位有效数字。数字 $0.025$ 实际上有两位有效数字（$2$ 和 $5$）。为了用四位有效数字表示，我们在后面追加两个零，得到 $0.02500$。\n\n接下来，我们必须根据基本原理，论证此水平的转换错误率对下游基于单倍型的分析（如插补）的影响。$SER$ 为 $0.025$ 意味着，平均而言，相邻杂合位点之间有 $2.5\\%$ 的定相关联是错误的。这意味着每 $40$ 个这样的转换中就有一个是错误的。\n\n基于单倍型的插补的基本原理是，通过利用一个包含已知单倍型的高密度基因分型参考面板，来推断研究样本中未进行基因分型的变异。算法（通常基于隐马尔可夫模型，HMM）通过识别与研究个体稀疏的、已定相的单倍型框架相匹配的参考单倍型片段来工作。然后，算法从最佳匹配的参考单倍型中“复制”等位基因，以填补缺失的基因型。\n\n定相转换错误从根本上破坏了这一过程。当算法错误地交换了父源和母源的染色体片段时，就会发生转换错误。例如，如果两个连续杂合位点的真实父源和母源单倍型分别是 $H_{pat} = \\dots A \\dots T \\dots$ 和 $H_{mat} = \\dots G \\dots C \\dots$，那么这些位点之间的转换错误将导致推断出的单倍型变为例如 $\\dots A \\dots C \\dots$。这会产生一个“嵌合”或“镶嵌”单倍型，这种单倍型在个体中不存在，并且由于它是两种不同祖先背景的人为构造，因此极不可能存在于参考面板中。\n\n这种嵌合单倍型对插补准确性的影响是严重的，尤其是在紧邻转换错误之后的区域。当基于HMM的插补算法遇到转换错误时，当前追踪的参考单倍型会突然与个体的推断单倍型不再匹配。模型被迫转换到另一个不同的参考单倍型，以解释转换后观测到的数据。这种突然且人为的转换带来了很高的错误概率。从本质上讲，转换错误破坏了单倍型块的完整性，导致插补算法“迷失方向”，并在试图恢复匹配时犯错。这导致在转换错误位点周围的插补质量（以 $r^2$ 等指标衡量）出现局部下降。\n\n这种影响的大小受到局部基因组背景的调节，特别是连锁不平衡（$LD$）和次要等位基因频率（$MAF$）。\n- 在高$LD$区域，长距离内的等位基因强相关，单倍型较长且多样性较低。单个转换错误的破坏性极高，因为它破坏了一个长的、保守的单倍型块，产生了一个在群体模型下概率极低的序列。这使得该块内任何变异的插补都极易出错，尤其是那些依赖于这种长程背景的稀有变异。\n- 在低$LD$区域（例如重组热点），单倍型较短且更加混杂。定相算法在这些区域自然会遇到更多困难，通常导致更高密度的转换错误。虽然在已经碎片化的区域中，单个错误可能被认为破坏性较小，但多个邻近错误的累积效应会降低整个低$LD$片段的插补质量。\n- 低$MAF$（稀有）变异的插补受到定相错误不成比例的影响。稀有变异通常存在于单一的、长的祖先单倍型上。该单倍型的完整性对其准确插补至关重要。$0.025$ 的转换错误率高到足以频繁破坏这些携带稀有变异的单倍型，从而显著降低依赖于插补数据的稀有变异关联研究的效力和准确性。\n\n总之，$0.025$ 的转换错误率给数据带来了显著的嵌合单倍型负担。这直接通过引起与参考面板的局部错配，迫使底层HMM进行错误的状态转换，并最终导致插补准确性出现可测量的下降，从而降低了下游插补的性能，对稀有遗传变异的推断影响尤为严重。", "answer": "$$\n\\boxed{0.02500}\n$$", "id": "4569545"}]}