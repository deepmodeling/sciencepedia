{"hands_on_practices": [{"introduction": "曼哈顿图的核心是通过转换后的 $p$ 值来可视化全基因组关联的强度。本练习旨在提供将 GWAS 模型原始统计输出（如效应值 $\\beta$ 和标准误 SE）转换为曼哈顿图 y 轴坐标 $-\\log_{10}(p)$ 值的实践经验。通过这个基础计算，您可以将抽象的统计检验结果与直观的数据可视化联系起来，这是解读 GWAS 结果的第一步。", "problem": "全基因组关联研究 (GWAS) 通常使用转换后 $p$ 值的曼哈顿图和分位数-分位数 (QQ) 图来总结单核苷酸多态性 (SNP) 的关联结果，并评估原假设下检验统计量的校准情况。\n\n考虑一个通过广义线性模型分析的单个 SNP，其中获得了遗传效应参数 $\\beta$ 的最大似然估计量 $\\hat{\\beta}$ 及其标准误 $\\mathrm{SE}$。\n\n从最大似然估计量的大样本理论出发，假设在标准正则性条件下以及无关联的原假设 ($\\beta=0$) 下，由 $\\hat{\\beta}$ 和 $\\mathrm{SE}$ 构成的标准化检验统计量服从标准正态分布。利用这一事实和 $\\beta=0$ 的双边检验的定义，推导标准化检验统计量与 $(\\hat{\\beta}, \\mathrm{SE})$ 对之间的关系，然后用该统计量和标准正态累积分布函数表示双边 $p$ 值。\n\n最后，在双边检验下，计算当 $\\hat{\\beta}=0.05$ 和 $\\mathrm{SE}=0.01$ 时曼哈顿图的纵坐标 $-\\log_{10}(p)$。将您的最终值 $-\\log_{10}(p)$ 四舍五入到四位有效数字。最终答案以纯数字形式表示，不带单位。", "solution": "用户提供了一个来自生物信息学和统计遗传学领域的问题，要求在全基因组关联研究 (GWAS) 的框架下推导检验统计量和 $p$ 值，并进行具体计算。\n\n**问题验证**\n\n**第 1 步：提取已知条件**\n- 分析涉及单核苷酸多态性 (SNP) 和广义线性模型。\n- 遗传效应的最大似然估计量是 $\\hat{\\beta}$，标准误为 $\\mathrm{SE}$。\n- 在原假设 $H_0: \\beta=0$ 和大样本理论下，一个标准化的检验统计量服从标准正态分布 $N(0, 1)$。\n- 检验是针对 $\\beta=0$ 的双边检验。\n- 用于计算的具体值为 $\\hat{\\beta}=0.05$ 和 $\\mathrm{SE}=0.01$。\n- 期望的输出是曼哈顿图的纵坐标 $-\\log_{10}(p)$，并四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地基于最大似然理论和假设检验（特别是沃尔德检验）的成熟原则，这些是统计遗传学和 GWAS 分析的基础。其假设（最大似然估计量的渐近正态性）是标准的。\n- **定义明确：** 该问题定义清晰，提供了所有必要信息和明确的目标。从理论前提​​到数值计算的路径是明确无误的，并导向唯一的解。\n- **客观性：** 语言严谨、精确，不带主观性。\n\n**第 3 步：结论与行动**\n该问题被认为是有效的，因为它是科学合理的、定义明确的和客观的。将提供详细的解决方案。\n\n**推导与求解**\n\n问题始于一个前提：对于大样本，最大似然估计量 $\\hat{\\beta}$ 近似服从正态分布。该分布以真实参数值 $\\beta$ 为中心，其方差是标准误 $\\mathrm{SE}$ 的平方。\n在数学上，这表示为：\n$$\n\\hat{\\beta} \\approx N(\\beta, \\mathrm{SE}^2)\n$$\n原假设 ($H_0$) 假定没有遗传关联，这对应于参数 $\\beta$ 等于零，即 $H_0: \\beta=0$。在此假设下，估计量的分布变为：\n$$\n\\hat{\\beta} \\mid H_0 \\approx N(0, \\mathrm{SE}^2)\n$$\n为了构建一个标准化的检验统计量，我们减去原假设下的均值（即 $0$），然后除以标准差（即标准误 $\\mathrm{SE}$）。我们将这个标准化的检验统计量记为 $Z$。\n因此，检验统计量与 $(\\hat{\\beta}, \\mathrm{SE})$ 对之间的关系是：\n$$\nZ = \\frac{\\hat{\\beta} - 0}{\\mathrm{SE}} = \\frac{\\hat{\\beta}}{\\mathrm{SE}}\n$$\n正如问题所述并由正态分布的性质所证实，在原假设下，这个 $Z$ 统计量服从标准正态分布：\n$$\nZ \\mid H_0 \\sim N(0, 1)\n$$\n下一步是定义双边检验的 $p$ 值。双边检验考虑在任一方向（$\\beta > 0$ 或 $\\beta  0$）上反对原假设的证据。$p$ 值是在假设 $H_0$ 为真的情况下，观测到至少与从数据中计算出的检验统计量一样极端的统计量的概率。对于双边检验，“至少一样极端”对应于统计量的绝对值。\n\n设 $z_{obs}$ 是从我们的数据中计算出的检验统计量的观测值。$p$ 值由下式给出：\n$$\np = P(|Z| \\ge |z_{obs}| \\mid H_0)\n$$\n其中 $Z \\sim N(0, 1)$。这可以展开为：\n$$\np = P(Z \\ge |z_{obs}|) + P(Z \\le -|z_{obs}|)\n$$\n由于标准正态分布关于 $0$ 的对称性，我们有 $P(Z \\le -|z_{obs}|) = P(Z \\ge |z_{obs}|)$。因此，$p$ 值的表达式简化为：\n$$\np = 2 \\times P(Z \\ge |z_{obs}|)\n$$\n设 $\\Phi(\\cdot)$ 表示标准正态分布的累积分布函数 (CDF)，即 $\\Phi(x) = P(Z \\le x)$。尾部概率 $P(Z \\ge |z_{obs}|)$ 可以用 CDF 表示为 $1 - \\Phi(|z_{obs}|)$。将此代入 $p$ 值的表达式，得到最终关系式：\n$$\np = 2 \\times (1 - \\Phi(|z_{obs}|))\n$$\n现在，我们可以使用给定的值进行计算：$\\hat{\\beta}=0.05$ 和 $\\mathrm{SE}=0.01$。\n\n首先，我们计算检验统计量的观测值 $z_{obs}$：\n$$\nz_{obs} = \\frac{\\hat{\\beta}}{\\mathrm{SE}} = \\frac{0.05}{0.01} = 5\n$$\n接下来，我们使用上面推导的公式计算双边 $p$ 值：\n$$\np = 2 \\times (1 - \\Phi(5))\n$$\n$\\Phi(5)$ 的值非常接近 $1$。使用高精度计算器计算标准正态 CDF，我们发现单边尾部概率 $P(Z > 5)$ 约等于 $2.8665157 \\times 10^{-7}$。\n因此，$p$ 值为：\n$$\np = 2 \\times P(Z \\ge 5) \\approx 2 \\times (2.8665157 \\times 10^{-7}) = 5.7330314 \\times 10^{-7}\n$$\n最后，我们计算曼哈顿图的纵坐标，其定义为 $-\\log_{10}(p)$：\n$$\n-\\log_{10}(p) = -\\log_{10}(5.7330314 \\times 10^{-7})\n$$\n使用对数的性质 $\\log_{10}(a \\times 10^b) = \\log_{10}(a) + b$：\n$$\n-\\log_{10}(p) = -(\\log_{10}(5.7330314) + \\log_{10}(10^{-7})) = -(\\log_{10}(5.7330314) - 7) = 7 - \\log_{10}(5.7330314)\n$$\n计算对数：\n$$\n\\log_{10}(5.7330314) \\approx 0.758384\n$$\n所以，纵坐标为：\n$$\n-\\log_{10}(p) \\approx 7 - 0.758384 = 6.241616\n$$\n问题要求将这个最终值四舍五入到四位有效数字。前四位有效数字是 $6, 2, 4, 1$。第五位有效数字是 $6$，大于或等于 $5$，所以我们将第四位数字向上进位。\n$$\n6.241616 \\rightarrow 6.242\n$$\n计算出的曼哈顿图纵坐标是 $6.242$。", "answer": "$$\\boxed{6.242}$$", "id": "4580204"}, {"introduction": "在进行全基因组关联研究（GWAS）时，我们同时对数百万个遗传变异进行检验，这极大地增加了偶然发现假阳性关联的风险。因此，必须对多重检验进行校正。本练习将引导您计算并比较两种常用的多重检验校正方法（Bonferroni 和 Šidák）所产生的显著性阈值，这个阈值在曼哈顿图中通常显示为一条横跨全图的水平线，是判断关联是否达到全基因组显著性的关键标准。[@problem_id:4580282]", "problem": "一个联盟对一个复杂性状进行了一项大型多队列全基因组关联研究（GWAS），汇总了来自不同平台的估算基因型。经过质量控制后，最终的关联扫描评估了 $M = 7.5 \\times 10^{6}$ 个单核苷酸多态性（SNPs）。为了在全族错误率控制下解释曼哈顿图和分位数-分位数（QQ）图，该研究针对所有 $M$ 个假设检验设定了 $\\alpha = 0.05$ 的全族错误率（FWER）。\n\n从生物信息学和医学数据分析中多重检验的基本原理出发：\n- 使用全族错误率的定义，即在 $M$ 个原假设中至少有一个错误拒绝的概率。\n- 在除了边际 $p$ 值同分布外没有其他分布假设的情况下，应用并集界（union bound）推导确保 FWER 控制的单次检验阈值。\n- 在 $M$ 个检验相互独立的假设下，推导确保 FWER 控制的精确单次检验阈值。\n\n然后，对于给定的 $M$ 和 $\\alpha$：\n1. 计算由并集界所隐含的 Bonferroni 单次检验 $p$ 值阈值。\n2. 计算由独立性假设所隐含的 Šidák 单次检验 $p$ 值阈值。\n3. 计算乘法差异 $\\rho$，定义为 Šidák 阈值与 Bonferroni 阈值的比率。\n\n最后，根据 SNP 之间的连锁不平衡，简要论证在解释具有相关标记的真实 GWAS 中的曼哈顿图和 QQ 图时，这两个阈值中哪一个更为保守。\n\n将报告的每个数值四舍五入到四位有效数字，并用标准的以 10 为底的科学记数法表示 $p$ 值阈值。不需要物理单位。", "solution": "该问题被验证为具有科学依据、问题明确且客观。它是统计遗传学中的一个标准问题，可以使用多重假设检验的既定原则来解决。\n\n设 $M$ 为测试的单核苷酸多态性（SNPs）总数，即 $M = 7.5 \\times 10^{6}$。设 $\\alpha$ 为期望的全族错误率（FWER），给定为 $\\alpha = 0.05$。对于每个 SNP $i \\in \\{1, 2, \\dots, M\\}$，我们检验一个原假设 $H_{0i}$，即该 SNP 与性状无关。每次检验的结果是一个 $p$ 值，$P_i$。\n\n全族错误率（FWER）定义为在所有 $M$ 次检验中犯至少一次 I 型错误（错误地拒绝一个真实的原假设）的概率。设 $E_i$ 为第 $i$ 次检验犯 I 型错误的事件。假设在所有原假设都为真的最坏情况下，FWER 由下式给出：\n$$\n\\text{FWER} = P\\left(\\bigcup_{i=1}^{M} E_i\\right)\n$$\n我们寻求一个单次检验的显著性阈值，称之为 $p_{th}$，使得如果 $P_i \\le p_{th}$，我们就拒绝 $H_{0i}$。在原假设下，$p$ 值在 $[0, 1]$ 上均匀分布，因此单次检验犯 I 型错误的概率是 $P(E_i) = P(P_i \\le p_{th}) = p_{th}$。\n\n**Bonferroni 阈值的推导（并集界）**\n\nBonferroni 校正是使用布尔不等式（Boole's inequality），也称为并集界（union bound）推导出来的。该不等式指出，对于任何事件集合，其并集的概率小于或等于它们各自概率的总和。此推导不对检验的依赖结构做任何假设。\n$$\n\\text{FWER} = P\\left(\\bigcup_{i=1}^{M} E_i\\right) \\le \\sum_{i=1}^{M} P(E_i)\n$$\n代入 $P(E_i) = p_{th}$：\n$$\n\\text{FWER} \\le \\sum_{i=1}^{M} p_{th} = M \\cdot p_{th}\n$$\n为确保 FWER 控制在水平 $\\alpha$，我们强制执行条件：\n$$\nM \\cdot p_{th} \\le \\alpha\n$$\n这就得到了 Bonferroni 单次检验阈值，$p_{Bonf}$：\n$$\np_{Bonf} = \\frac{\\alpha}{M}\n$$\n\n**Šidák 阈值的推导（独立性假设）**\n\nŠidák 校正假设所有 $M$ 个检验都是相互独立的。在此假设下，事件并集的概率可以精确计算。不犯任何 I 型错误的概率是每次独立检验中不犯 I 型错误的概率的乘积：\n$$\nP(\\text{no Type I errors}) = P\\left(\\bigcap_{i=1}^{M} E_i^c\\right) = \\prod_{i=1}^{M} P(E_i^c)\n$$\n其中 $E_i^c$ 是事件 $E_i$ 的补集。单次检验不犯 I 型错误的概率是 $P(E_i^c) = 1 - P(E_i) = 1 - p_{th}$。\n$$\nP(\\text{no Type I errors}) = \\prod_{i=1}^{M} (1 - p_{th}) = (1 - p_{th})^M\n$$\nFWER 是至少犯一次 I 型错误的概率，即 1 减去不犯任何 I 型错误的概率：\n$$\n\\text{FWER} = 1 - P(\\text{no Type I errors}) = 1 - (1 - p_{th})^M\n$$\n为了将 FWER 精确控制在水平 $\\alpha$，我们设定：\n$$\n1 - (1 - p_{th})^M = \\alpha\n$$\n解出 $p_{th}$ 得到 Šidák 单次检验阈值，$p_{Sidak}$：\n$$\n(1 - p_{Sidak})^M = 1 - \\alpha\n$$\n$$\n1 - p_{Sidak} = (1 - \\alpha)^{1/M}\n$$\n$$\np_{Sidak} = 1 - (1 - \\alpha)^{1/M}\n$$\n\n**数值计算**\n\n给定 $M = 7.5 \\times 10^{6}$ 和 $\\alpha = 0.05$。\n\n1.  **Bonferroni 单次检验 $p$ 值阈值 ($p_{Bonf}$):**\n    $$\n    p_{Bonf} = \\frac{\\alpha}{M} = \\frac{0.05}{7.5 \\times 10^{6}} = \\frac{5 \\times 10^{-2}}{7.5 \\times 10^{6}} = \\frac{2}{3} \\times 10^{-8} \\approx 6.6667 \\times 10^{-9}\n    $$\n    四舍五入到四位有效数字，$p_{Bonf} = 6.667 \\times 10^{-9}$。\n\n2.  **Šidák 单次检验 $p$ 值阈值 ($p_{Sidak}$):**\n    $$\n    p_{Sidak} = 1 - (1 - 0.05)^{1/(7.5 \\times 10^{6})} = 1 - (0.95)^{1/(7.5 \\times 10^{6})}\n    $$\n    为了计算这个值，我们可以使用近似。让我们来计算指数部分：\n    $$\n    \\frac{1}{M} \\ln(1-\\alpha) = \\frac{1}{7.5 \\times 10^{6}} \\ln(0.95) \\approx \\frac{-0.05129329}{7.5 \\times 10^{6}} \\approx -6.8391059 \\times 10^{-9}\n    $$\n    所以，$p_{Sidak} = 1 - \\exp\\left(\\frac{\\ln(0.95)}{7.5 \\times 10^{6}}\\right) \\approx 1 - \\exp(-6.8391059 \\times 10^{-9})$。\n    对于小的 $x$，使用近似 $1-e^x \\approx -x$ 可得 $p_{Sidak} \\approx -(-6.8391059 \\times 10^{-9}) = 6.8391059 \\times 10^{-9}$。\n    四舍五入到四位有效数字，$p_{Sidak} = 6.839 \\times 10^{-9}$。\n\n3.  **乘法差异 ($\\rho$):**\n    $$\n    \\rho = \\frac{p_{Sidak}}{p_{Bonf}} = \\frac{6.8391059 \\times 10^{-9}}{6.666666... \\times 10^{-9}} \\approx 1.0258659\n    $$\n    四舍五入到四位有效数字，$\\rho = 1.026$。这表明 Šidák 阈值比 Bonferroni 阈值稍微不那么严格（即更大）。\n\n**GWAS 中保守性的论证**\n\n在真实 GWAS 的背景下，**Bonferroni 阈值比 Šidák 阈值更保守**。一个更保守的阈值是一个更严格（即更小）的阈值，这使得宣布一个结果具有统计显著性变得更加困难，从而减少了发现的数量。\n\n我们的计算表明 $p_{\\text{Bonf}}  p_{\\text{Sidak}}$。对于任何 $M > 1$ 和 $\\alpha \\in (0, 1)$，这个数学关系都成立，这意味着 Bonferroni 阈值在数值上总是更小，因此更严格。\n\n从连锁不平衡（LD）的角度论证如下：\n-   **连锁不平衡（LD）** 指的是不同位点上等位基因的非随机关联。在 GWAS 中，染色体上物理位置相近的 SNP 通常会一起遗传，这意味着它们的基因型（以及它们的检验统计量）是正相关的。\n-   **Šidák 校正** 明确假设 $M$ 个检验是独立的。LD 的存在直接违反了这一假设。\n-   **Bonferroni 校正** 基于并集界，不对依赖性做任何假设。它是 FWER 的一个通用控制器。然而，由于它考虑了最坏的依赖情况，因此它被认为是过于保守的，特别是当检验呈正相关时，就像 LD 中的 SNP 一样。正相关意味着有效独立检验的数量远小于 $M$。\n-   事实上，对于具有广泛 LD 的典型 GWAS 数据集，这两种方法都过于保守。然而，问题是问两者中哪一个*更*保守。由于 $p_{Bonf}$ 总是小于 $p_{Sidak}$，并且这种关系不受相关性存在的影响，Bonferroni 校正仍然是更保守的方法。它对原始检验数（$M$）进行了过度校正，而没有对 LD 引入的冗余进行任何调整，导致在这两者之间产生了最严格的显著性标准。", "answer": "$$ \\boxed{ \\begin{pmatrix} 6.667 \\times 10^{-9}  6.839 \\times 10^{-9}  1.026 \\end{pmatrix} } $$", "id": "4580282"}, {"introduction": "在解读曼哈顿图和 QQ 图时，一个关键技能是识别并过滤掉由技术误差而非真实生物学效应引起的伪影信号。本练习聚焦于一个常见的伪影来源：哈迪-温伯格平衡（Hardy–Weinberg equilibrium, HWE）的偏离。通过这个案例，您将理解基因分型或插补错误如何导致曼哈顿图上出现虚假的关联峰以及 QQ 图的膨胀，并学习如何设计一个科学合理的 HWE 质控过滤器来提高 GWAS 结果的可靠性。[@problem_id:4580225]", "problem": "一项针对二元性状疾病的病例-对照全基因组关联研究（GWAS）包含 $n_{\\text{cases}} = 20{,}000$ 名病例和 $n_{\\text{controls}} = 30{,}000$ 名对照，他们的数据通过高密度芯片进行基因分型，随后进行了插补。曼哈顿图显示，在8号染色体的一个片段上，存在一个由高度显著的单核苷酸多态性（SNP）组成的密集簇，而分位数-分位数（QQ）图显示，其分布很早就偏离了零假设，基因组控制（GC）膨胀因子 $\\lambda_{\\text{GC}} \\approx 1.15$。可疑区域的变异位点插补质量较低，并且在对照组中表现出过多的杂合性。已知全基因组中有 $m = 8 \\times 10^{6}$ 个次要等位基因频率（MAF）$\\ge 0.01$ 的常见变异，以及另外 $m_{\\text{rare}} = 12 \\times 10^{6}$ 个 MAF $ 0.01$ 的罕见变异。\n\n从哈代-温伯格平衡（HWE）的基本定义出发：对于一个双等位基因位点，在一个随机交配、无分层、无选择、无突变、无迁移的群体中，如果参考等位基因的频率为 $p$，备择等位基因的频率为 $q = 1 - p$，则预期的基因型频率为 $p^{2}$、$2pq$ 和 $q^{2}$。HWE检验评估观察到的基因型计数是否偏离这些预期值；在HWE的零假设下，HWE检验的p值在 $\\left[0,1\\right]$ 上均匀分布。在GWAS中，曼哈顿图中的伪关联峰和QQ图中的膨胀，可能源于系统性的基因分型或插补假象，这些假象会引起HWE偏离，并与病例-对照状态产生伪相关（例如，病例和对照之间的批次效应差异）。\n\n以下哪种策略最恰当地解释了哈代-温伯格平衡的违背如何产生伪曼哈顿峰，并设计了一个科学合理的基于HWE的变异过滤方法，以减少此类假象，同时保留真实的关联？此外，在你选择的过滤方法下，根据在零假设下HWE的p值是均匀分布这一事实，说明在完美HWE的零模型下，被移除的常见变异的预期数量是多少。\n\nA. 在所有样本中合并计算HWE的p值，并移除全基因组范围内任何HWE $p  10^{-2}$ 的变异。这将积极地抑制伪关联峰，而不会影响真实信号。在零假设下，被移除的常见变异的预期数量是 $8 \\times 10^{4}$。\n\nB. 仅在对照组中计算HWE的p值，并在每个祖源组内进行分层，过滤掉在任何分层中HWE $p  10^{-6}$ 的常见变异（MAF $\\ge 0.01$）；对于罕见变异（MAF $ 0.01$），不应用HWE过滤器，而是依赖于正交的质量指标。这针对的是导致对照组杂合子过多或过少的假象，并避免移除在病例中可能偏离HWE的真实疾病信号。在零假设下，被移除的常见变异的预期数量是 $8$。\n\nC. 仅在病例组中计算HWE的p值，并移除全基因组范围内任何HWE $p  10^{-6}$ 的变异。这样可以保持统计功效并避免移除致病变异。在零假设下，被移除的常见变异的预期数量是 $8$。\n\nD. 不使用HWE过滤，因为QQ图的膨胀（$\\lambda_{\\text{GC}} \\approx 1.15$）表明这是一个高度多基因的性状。相反，依赖于更严格的Bonferroni关联阈值。在零假设下，被移除的常见变异的预期数量是 $0$。\n\n选择唯一的最佳选项。", "solution": "我们从哈代-温伯格平衡（HWE）的定义开始。对于一个双等位基因位点，其等位基因频率为 $p$ 和 $q = 1 - p$，在一个理想的随机交配群体中，预期的基因型比例为 $p^{2}$（纯合参考型）、$2pq$（杂合型）和 $q^{2}$（纯合备择型）。HWE检验将观察到的基因型计数与这些期望值进行比较，并产生一个p值，在HWE的零假设下，该p值在 $\\left[0,1\\right]$ 上均匀分布。因此，如果在零假设下使用HWE p值阈值 $\\alpha$ 作为质量控制过滤器，则被移除的变异的预期比例为 $\\alpha$。对于 $m$ 个独立的常见变异，被移除的预期数量为 $m \\alpha$。\n\n将HWE与曼哈顿图和分位数-分位数（QQ）图联系起来：曼哈顿图总结了全基因组的关联p值；QQ图将观察到的关联检验统计量的分布与其零假设下的期望分布进行比较。系统性的基因分型或插补错误可能导致偏离HWE，而这并非由真实的生物学效应引起。例如，等位基因判读偏差可能导致杂合子缺失或过量，而病例和对照之间不同的批次效应可能将这种偏差与表型联系起来。这会膨胀关联统计量，并在基因分型质量较低的区域产生低p值簇（伪峰）。在QQ图中，这表现为早期的膨胀，超出了仅由多基因性所预期的程度，特别是当这种膨胀与质量问题和集中在特定区域的HWE偏离同时发生时。\n\n在病例-对照研究中，由于外显率效应，真实的致病变异可能会在病例组中违背HWE，而对照组在没有群体结构或选择的情况下应严格遵守HWE。因此，在对照组中（并在祖源分层内）计算HWE是标准做法，以避免过滤掉那些在病例组中合理偏离HWE的真实信号。此外，HWE检验在极低的次要等位基因频率（MAF）下功效较低且存在偏差行为，因此谨慎的做法是根据MAF应用不同的策略：对常见变异应用严格的HWE阈值，而对罕见变异避免或放宽HWE过滤器，转而依赖于正交的质量指标（例如，深度、等位基因平衡、孟德尔一致性或根据基因型不确定性调整的哈代-温伯格平衡检验）。\n\n我们现在分析每个选项。\n\n选项 A：在所有样本中计算HWE，并使用一个宽松的阈值 $p  10^{-2}$。在p值均匀分布的零假设下，对于 $m = 8 \\times 10^{6}$ 个常见变异，被移除的预期数量为 $m \\alpha = \\left(8 \\times 10^{6}\\right) \\times \\left(10^{-2}\\right) = 8 \\times 10^{4}$，与选项中所述数字相符。然而，这种方法有两个缺陷。首先，使用所有样本可能会不恰当地移除真实的关联，因为与疾病相关的位点可能在病例组中偏离HWE。其次，$10^{-2}$ 的阈值并非一个富集假象的阈值；它过于宽松，以至于在完美HWE条件下会移除大约 $1\\%$ 的所有常见变异，其中包括许多高质量的变异，从而降低统计功效并可能使下游分析产生偏差。它也没有解决按祖源进行分层的必要性，而这对于避免因群体结构引起的伪偏离至关重要。结论：不正确。\n\n选项 B：在对照组中计算HWE，按祖源分层，对常见变异使用严格的过滤器 $p  10^{-6}$，对罕见变异不使用HWE过滤器，而是依赖于正交的质量指标。这与最佳实践的推理相符：当假象引起HWE偏离并在病例和对照组之间存在差异时，就会出现伪峰；在对照组中检验HWE可以避免移除与疾病真正相关的变异。按祖源分层可以处理群体亚结构。所选的阈值 $10^{-6}$ 足够严格，主要针对由技术错误而非随机波动引起的重大偏离，尤其是在大样本中。对于常见变异，在零假设下，被移除的预期数量是 $m \\alpha = \\left(8 \\times 10^{6}\\right) \\times \\left(10^{-6}\\right) = 8$。对于罕见变异，HWE检验不稳定；避免一刀切的HWE过滤可以防止无理地移除真实变异，而是利用专为罕见变异质量设计的指标。该选项还直接解释了假象如何产生伪曼哈顿峰，以及该过滤器如何解决这些问题。结论：正确。\n\n选项 C：仅在病例组中计算HWE，过滤阈值为 $p  10^{-6}$。虽然在零假设下，被移除的常见变异的预期数量如上计算为 $8$，但这种设计在概念上是有缺陷的。真实的致病变异可能在受影响的群体中偏离HWE，因为外显率会改变病例中的基因型频率，因此在病例组中基于HWE进行过滤会优先移除真实的关联，使结果偏向于零假设。它也没有按祖源进行分层，也没有解决在对照组中检测假象的问题。结论：不正确。\n\n选项 D：放弃HWE过滤，将QQ膨胀完全视为多基因效应，仅通过更严格的Bonferroni阈值来补偿。这忽略了存在假象的经验线索：在低质量区域聚集的曼哈顿峰和对照组中的HWE偏离。更严格的显著性阈值无法纠正系统性偏差；它可能使伪峰未被处理，并降低检测真实关联的功效。质量控制，包括适当应用的HWE过滤，是在进行关联检验和多重检验校正之前减少假象所必需的。结论：不正确。\n\n因此，最佳选择是选项B。在选项B下，零假设下被移除的常见变异的预期数量为 $8$。", "answer": "$$\\boxed{B}$$", "id": "4580225"}]}