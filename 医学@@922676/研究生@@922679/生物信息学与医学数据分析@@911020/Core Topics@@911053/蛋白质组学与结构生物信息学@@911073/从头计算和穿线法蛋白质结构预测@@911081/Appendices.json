{"hands_on_practices": [{"introduction": "精准的蛋白质结构预测有赖于将物理化学原理编码为能量函数或评分函数。一个强大的信息来源是从已知的高分辨率实验结构中观察到的几何特征的统计分布。本练习 [@problem_id:4538326] 聚焦于此方法的一个基石：使用复杂的统计模型对主链二面角（$\\phi$, $\\psi$）的拉马钱德兰图进行建模，这对于在从头预测和穿线法中验证和指导构象采样至关重要。", "problem": "在从头蛋白质折叠和基于穿针法的结构比对中，源自拉曼钱德兰分布的扭转角先验充当对主链构象的基于知识的约束。考虑一个给定残基的主链二面角 $\\phi$ 和 $\\psi$ 的经验先验，该先验是使用核密度估计 (KDE) 从高分辨率结构中估计出来的。该经验密度被建模为角度的二维环面（具有主值角差）上轴对齐高斯核的混合模型，反映了主要的构象盆地。该混合模型有三个组分，由 $i \\in \\{1,2,3\\}$ 索引，其权重 $w_i$ 满足 $\\sum_i w_i = 1$。组分密度为\n$$\nK_{\\sigma_{\\phi,i}}(\\phi; \\mu_{\\phi,i}) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_{\\phi,i}} \\exp\\!\\left(-\\frac{\\Delta(\\phi,\\mu_{\\phi,i})^2}{2\\sigma_{\\phi,i}^2}\\right), \\quad\nK_{\\sigma_{\\psi,i}}(\\psi; \\mu_{\\psi,i}) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma_{\\psi,i}} \\exp\\!\\left(-\\frac{\\Delta(\\psi,\\mu_{\\psi,i})^2}{2\\sigma_{\\psi,i}^2}\\right),\n$$\n其中 $\\Delta(\\theta,\\mu)$ 是在 $(-\\pi,\\pi]$ 范围内的与 $\\theta - \\mu$ 模 $2\\pi$ 同余的主值角差。联合密度为\n$$\nf(\\phi,\\psi) = \\sum_{i=1}^{3} w_i \\, K_{\\sigma_{\\phi,i}}(\\phi; \\mu_{\\phi,i}) \\, K_{\\sigma_{\\psi,i}}(\\psi; \\mu_{\\psi,i}).\n$$\n假设所有角度都以弧度为单位。混合参数（典型拉曼钱德兰盆地中的均值、标准差和权重）如下：\n- 组分 $i=1$ (右手α螺旋盆地): $\\mu_{\\phi,1} = -1.0472$, $\\mu_{\\psi,1} = -0.7854$, $\\sigma_{\\phi,1} = 0.1745$, $\\sigma_{\\psi,1} = 0.1745$, $w_1 = 0.5$。\n- 组分 $i=2$ (β折叠盆地): $\\mu_{\\phi,2} = -2.3562$, $\\mu_{\\psi,2} = 2.3562$, $\\sigma_{\\phi,2} = 0.2618$, $\\sigma_{\\psi,2} = 0.2618$, $w_2 = 0.3$。\n- 组分 $i=3$ (左手α螺旋盆地): $\\mu_{\\phi,3} = 1.0472$, $\\mu_{\\psi,3} = 0.0$, $\\sigma_{\\phi,3} = 0.2618$, $\\sigma_{\\psi,3} = 0.2618$, $w_3 = 0.2$。\n\n一个通过从头计算方法预测的残基得到的角度为 $\\phi^{\\ast} = -1.0$ 和 $\\psi^{\\ast} = -0.7$。在从头计算和穿针法流程共有的模型验证中，如果一个残基的角度处的经验密度超过阈值 $\\tau$，则其构象被称为允许构象。此处，使用准则 $f(\\phi^{\\ast},\\psi^{\\ast}) \\ge \\tau$，其中 $\\tau = 2.0$。计算指示函数\n$$\nI = \\begin{cases}\n1, & f(\\phi^{\\ast},\\psi^{\\ast}) \\ge \\tau,\\\\\n0, & f(\\phi^{\\ast},\\psi^{\\ast}) < \\tau,\n\\end{cases}\n$$\n并将 $I$ 作为您的最终答案报告。无需四舍五入；中间计算至少保留四位有效数字，以为决策提供依据。答案无单位，角度以弧度为单位。", "solution": "该问题提出了一个生物信息学中有效、适定且有科学依据的场景。计算所需的所有必要参数和定义都已提供，并且其背景——使用高斯混合模型表示用于蛋白质结构验证的拉曼钱德兰分布——是该领域的标准实践。该问题是自洽的，没有矛盾或歧义。因此，可以通过直接计算来确定解决方案。\n\n目标是计算指示函数 $I$ 的值，该值取决于在给定二面角 $\\phi^{\\ast} = -1.0$ 和 $\\psi^{\\ast} = -0.7$ 处的经验概率密度 $f(\\phi^{\\ast},\\psi^{\\ast})$ 是否超过阈值 $\\tau = 2.0$。指示函数 $I$ 定义为：\n$$\nI = \\begin{cases}\n1, & f(\\phi^{\\ast},\\psi^{\\ast}) \\ge \\tau,\\\\\n0, & f(\\phi^{\\ast},\\psi^{\\ast}) < \\tau,\n\\end{cases}\n$$\n联合密度函数 $f(\\phi,\\psi)$ 是三个组分的混合：\n$$\nf(\\phi,\\psi) = \\sum_{i=1}^{3} w_i \\, K_{\\sigma_{\\phi,i}}(\\phi; \\mu_{\\phi,i}) \\, K_{\\sigma_{\\psi,i}}(\\psi; \\mu_{\\psi,i})\n$$\n其中每个组分的贡献（我们表示为 $T_i$）是其权重与两个高斯核的乘积。对于特定角度 $(\\phi^{\\ast}, \\psi^{\\ast})$，这表示为：\n$$\nT_i = w_i \\, K_{\\sigma_{\\phi,i}}(\\phi^{\\ast}; \\mu_{\\phi,i}) \\, K_{\\sigma_{\\psi,i}}(\\psi^{\\ast}; \\mu_{\\psi,i}) = \\frac{w_i}{2\\pi \\sigma_{\\phi,i} \\sigma_{\\psi,i}} \\exp\\left( - \\frac{\\Delta(\\phi^{\\ast},\\mu_{\\phi,i})^2}{2\\sigma_{\\phi,i}^2} - \\frac{\\Delta(\\psi^{\\ast},\\mu_{\\psi,i})^2}{2\\sigma_{\\psi,i}^2} \\right)\n$$\n我们通过计算每一项来计算总密度 $f(\\phi^{\\ast},\\psi^{\\ast}) = T_1 + T_2 + T_3$。\n\n**组分 $i=1$:**\n参数为 $w_1 = 0.5$, $\\mu_{\\phi,1} = -1.0472$, $\\mu_{\\psi,1} = -0.7854$ 以及 $\\sigma_{\\phi,1} = \\sigma_{\\psi,1} = 0.1745$。\n首先，我们计算主值角差：\n$$\n\\Delta(\\phi^{\\ast}, \\mu_{\\phi,1}) = \\Delta(-1.0, -1.0472) = -1.0 - (-1.0472) = 0.0472\n$$\n$$\n\\Delta(\\psi^{\\ast}, \\mu_{\\psi,1}) = \\Delta(-0.7, -0.7854) = -0.7 - (-0.7854) = 0.0854\n$$\n现在，我们计算贡献 $T_1$：\n$$\nT_1 = \\frac{0.5}{2\\pi (0.1745)^2} \\exp\\left( - \\frac{(0.0472)^2 + (0.0854)^2}{2(0.1745)^2} \\right)\n$$\n$$\nT_1 \\approx \\frac{0.5}{2\\pi (0.03045025)} \\exp\\left( - \\frac{0.00222784 + 0.00729316}{2(0.03045025)} \\right)\n$$\n$$\nT_1 \\approx \\frac{0.5}{0.191325} \\exp\\left( - \\frac{0.009521}{0.0609005} \\right)\n$$\n$$\nT_1 \\approx 2.6133 \\times \\exp(-0.156337) \\approx 2.6133 \\times 0.85527 \\approx 2.2352\n$$\n\n**组分 $i=2$:**\n参数为 $w_2 = 0.3$, $\\mu_{\\phi,2} = -2.3562$, $\\mu_{\\psi,2} = 2.3562$ 以及 $\\sigma_{\\phi,2} = \\sigma_{\\psi,2} = 0.2618$。\n角差为：\n$$\n\\Delta(\\phi^{\\ast}, \\mu_{\\phi,2}) = \\Delta(-1.0, -2.3562) = -1.0 - (-2.3562) = 1.3562\n$$\n$$\n\\Delta(\\psi^{\\ast}, \\mu_{\\psi,2}) = \\Delta(-0.7, 2.3562) = -0.7 - 2.3562 = -3.0562\n$$\n值 $-3.0562$ 在主值范围 $(-\\pi, \\pi]$ 内，因为 $-\\pi \\approx -3.1416$。\n为了评估该组分贡献的大小，我们可以用标准差来检验指数函数的参数：\n$$\n\\frac{|\\Delta(\\phi^{\\ast}, \\mu_{\\phi,2})|}{\\sigma_{\\phi,2}} = \\frac{1.3562}{0.2618} \\approx 5.18\n$$\n$$\n\\frac{|\\Delta(\\psi^{\\ast}, \\mu_{\\psi,2})|}{\\sigma_{\\psi,2}} = \\frac{3.0562}{0.2618} \\approx 11.67\n$$\n点 $(\\phi^{\\ast}, \\psi^{\\ast})$ 距离均值 $(\\mu_{\\phi,2}, \\mu_{\\psi,2})$ 超过 $5$ 个和 $11$ 个标准差。高斯函数在离其均值如此远的距离处的值实际上为零。指数的参数约为 $-\\frac{1}{2}(5.18^2 + 11.67^2) \\approx -81.5$。因此，$T_2 \\approx 0$。\n\n**组分 $i=3$:**\n参数为 $w_3 = 0.2$, $\\mu_{\\phi,3} = 1.0472$, $\\mu_{\\psi,3} = 0.0$ 以及 $\\sigma_{\\phi,3} = \\sigma_{\\psi,3} = 0.2618$。\n角差为：\n$$\n\\Delta(\\phi^{\\ast}, \\mu_{\\phi,3}) = \\Delta(-1.0, 1.0472) = -1.0 - 1.0472 = -2.0472\n$$\n$$\n\\Delta(\\psi^{\\ast}, \\mu_{\\psi,3}) = \\Delta(-0.7, 0.0) = -0.7\n$$\n以标准差表示的距离为：\n$$\n\\frac{|\\Delta(\\phi^{\\ast}, \\mu_{\\phi,3})|}{\\sigma_{\\phi,3}} = \\frac{2.0472}{0.2618} \\approx 7.82\n$$\n$$\n\\frac{|\\Delta(\\psi^{\\ast}, \\mu_{\\psi,3})|}{\\sigma_{\\psi,3}} = \\frac{0.7}{0.2618} \\approx 2.67\n$$\n与组分2类似，该点远离该组分的均值。指数的参数约为 $-\\frac{1}{2}(7.82^2 + 2.67^2) \\approx -34.1$。贡献 $T_3$ 也可忽略不计，$T_3 \\approx 0$。\n\n**总密度和最终决策：**\n总密度是三个组分贡献的总和：\n$$\nf(\\phi^{\\ast},\\psi^{\\ast}) = T_1 + T_2 + T_3 \\approx 2.2352 + 0 + 0 = 2.2352\n$$\n我们将此值与给定的阈值 $\\tau = 2.0$ 进行比较：\n$$\n2.2352 \\ge 2.0\n$$\n条件满足。因此，指示变量 $I$ 等于 $1$。", "answer": "$$\\boxed{1}$$", "id": "4538326"}, {"introduction": "在基于知识的势能概念之上，本练习 [@problem_id:4538342] 深入探讨了穿线法的核心。您将看到一个完整的评分函数是如何通过整合多种信息源——包括序列相似性、结构环境兼容性以及对空位的罚分——来构建的。这个练习具体展示了如何评估一个查询序列与一个模板结构的匹配程度，这是蛋白质穿线法的基本任务。", "problem": "一个生物信息学穿线模型通过对每个位置的序列-概貌对数似然比和环境特异性对数似然罚分求和，然后减去一个环境加权的仿射空位罚分，来为一个固定的查询-模板比对打分。该评分的基础是对数优势原则：对于一个比对位置 $i$ 和氨基酸 $a$，序列-概貌的贡献由自然对数 $\\ln\\!\\big(p_i(a)/q(a)\\big)$ 给出，其中 $p_i(a)$ 是位置特异性评分矩阵（PSSM）在模板位置 $i$ 处残基 $a$ 的概率，而 $q(a)$ 是背景氨基酸概率。环境相容性通过 $\\ln\\!\\big(\\pi_{s_i}(a)/q(a)\\big)$ 以类似方式处理，其中 $\\pi_{s_i}(a)$ 是残基 $a$ 在状态 $s_i$ (状态 $s_i \\in \\{\\text{暴露}, \\text{埋藏}\\}$) 下的环境特异性倾向。空位则使用一个仿射模型 $g_o + g_e(L-1)$ 进行罚分，该模型根据空位所在模板区域的状态乘以一个环境乘子 $\\beta(s)$。所有对数优势项都必须使用自然对数。\n\n考虑查询序列 $Q=(R,L,G,V,A)$ 与一个长度为 $6$ 的模板在位置 $1,2,3,5,6$ 处进行比对，并在模板位置 $4$ 处有一个长度为 $L=1$ 的内部空位。模板环境如下：位置 $1$ 暴露，位置 $2$ 埋藏，位置 $3$ 埋藏，位置 $4$ 埋藏，位置 $5$ 暴露，位置 $6$ 暴露。\n\n每个位置的序列-概貌权重为：$w_1=1.0$，$w_2=1.2$，$w_3=0.8$，$w_5=1.0$，$w_6=0.9$。每个位置的环境罚分权重为：$\\alpha_1=0.5$，$\\alpha_2=0.7$，$\\alpha_3=0.6$，$\\alpha_5=0.5$，$\\alpha_6=0.4$。\n\n背景氨基酸概率为：$q(R)=0.05$，$q(L)=0.09$，$q(G)=0.07$，$q(V)=0.07$，$q(A)=0.05$。\n\n比对上的残基的位置特异性概貌概率 $p_i(a)$ 为：\n- 位置 $1$ ($R$)：$p_1(R)=0.10$。\n- 位置 $2$ ($L$)：$p_2(L)=0.18$。\n- 位置 $3$ ($G$)：$p_3(G)=0.035$。\n- 位置 $5$ ($V$)：$p_5(V)=0.14$。\n- 位置 $6$ ($A$)：$p_6(A)=0.10$。\n\n比对上的残基的环境倾向 $\\pi_{s}(a)$ 为：\n- 暴露：$\\pi_{\\text{exposed}}(R)=0.10$，$\\pi_{\\text{exposed}}(V)=0.035$，$\\pi_{\\text{exposed}}(A)=0.075$。\n- 埋藏：$\\pi_{\\text{buried}}(L)=0.18$，$\\pi_{\\text{buried}}(G)=0.035$。\n\n假设这些项的环境背景使用与上述相同的 $q(a)$。仿射空位参数为 $g_o=2.0$ 和 $g_e=0.4$，环境乘子为 $\\beta(\\text{埋藏})=1.3$ 和 $\\beta(\\text{暴露})=1.0$。单个内部空位出现在一个埋藏区域（模板位置 4）。\n\n使用上述的对数优势和仿射空位原则，计算此固定比对的总穿线得分。对所有对数项使用自然对数，并将最终数值结果四舍五入到四位有效数字。不需要单位。", "solution": "问题提供了一组参数和一种评分方法，用于计算一个查询蛋白序列与一个模板结构固定比对的总分。该问题具有科学依据，提法明确，并且为得出唯一解提供了所有必要数据。因此，该问题被认为是有效的。\n\n总穿线得分 $S$ 定义为加权的序列-概貌对数似然分数和加权的环境特异性对数似然分数的总和，并从中减去一个环境加权的仿射空位罚分。总分的公式为：\n$$\nS = S_{\\text{profile}} + S_{\\text{env}} - G_{\\text{gap}}\n$$\n其中 $S_{\\text{profile}}$ 是总序列-概貌得分，$S_{\\text{env}}$ 是总环境相容性得分，而 $G_{\\text{gap}}$ 是空位罚分。\n\n该比对指定查询序列 $Q=(R,L,G,V,A)$ 与模板位置 $i \\in \\{1, 2, 3, 5, 6\\}$ 对齐。在模板位置 4 处存在一个长度为 $L=1$ 的空位。\n\n首先，我们计算序列-概貌得分 $S_{\\text{profile}}$。这是每个位置得分的总和，其中每个得分是位置特异性概率与背景概率的对数优势比，再乘以一个位置特异性权重 $w_i$。\n$$\nS_{\\text{profile}} = \\sum_{i \\in \\{1,2,3,5,6\\}} w_i \\ln\\left(\\frac{p_i(a_i)}{q(a_i)}\\right)\n$$\n这里，$a_i$ 是查询序列中与位置 $i$ 对齐的氨基酸。\n- 位置 $1$：比对对是模板-$1$ 和查询-R。\n  第 $1$ 项：$w_1 \\ln\\left(\\frac{p_1(R)}{q(R)}\\right) = 1.0 \\times \\ln\\left(\\frac{0.10}{0.05}\\right) = 1.0 \\times \\ln(2)$\n- 位置 $2$：比对对是模板-$2$ 和查询-L。\n  第 $2$ 项：$w_2 \\ln\\left(\\frac{p_2(L)}{q(L)}\\right) = 1.2 \\times \\ln\\left(\\frac{0.18}{0.09}\\right) = 1.2 \\times \\ln(2)$\n- 位置 $3$：比对对是模板-$3$ 和查询-G。\n  第 $3$ 项：$w_3 \\ln\\left(\\frac{p_3(G)}{q(G)}\\right) = 0.8 \\times \\ln\\left(\\frac{0.035}{0.07}\\right) = 0.8 \\times \\ln(0.5) = -0.8 \\times \\ln(2)$\n- 位置 $5$：比对对是模板-$5$ 和查询-V。\n  第 $5$ 项：$w_5 \\ln\\left(\\frac{p_5(V)}{q(V)}\\right) = 1.0 \\times \\ln\\left(\\frac{0.14}{0.07}\\right) = 1.0 \\times \\ln(2)$\n- 位置 $6$：比对对是模板-$6$ 和查询-A。\n  第 $6$ 项：$w_6 \\ln\\left(\\frac{p_6(A)}{q(A)}\\right) = 0.9 \\times \\ln\\left(\\frac{0.10}{0.05}\\right) = 0.9 \\times \\ln(2)$\n\n将这些项相加得到 $S_{\\text{profile}}$：\n$$\nS_{\\text{profile}} = (1.0 + 1.2 - 0.8 + 1.0 + 0.9) \\ln(2) = 3.3 \\ln(2)\n$$\n\n其次，我们计算环境相容性得分 $S_{\\text{env}}$。这是基于氨基酸对其局部结构环境的倾向性的每位置得分的总和，并由 $\\alpha_i$ 加权。\n$$\nS_{\\text{env}} = \\sum_{i \\in \\{1,2,3,5,6\\}} \\alpha_i \\ln\\left(\\frac{\\pi_{s_i}(a_i)}{q(a_i)}\\right)\n$$\n这里，$s_i$ 是模板位置 $i$ 的环境状态。\n- 位置 $1$：残基 R 处于“暴露”环境（$s_1=\\text{exposed}$）。\n  第 $1$ 项：$\\alpha_1 \\ln\\left(\\frac{\\pi_{\\text{exposed}}(R)}{q(R)}\\right) = 0.5 \\times \\ln\\left(\\frac{0.10}{0.05}\\right) = 0.5 \\times \\ln(2)$\n- 位置 $2$：残基 L 处于“埋藏”环境（$s_2=\\text{buried}$）。\n  第 $2$ 项：$\\alpha_2 \\ln\\left(\\frac{\\pi_{\\text{buried}}(L)}{q(L)}\\right) = 0.7 \\times \\ln\\left(\\frac{0.18}{0.09}\\right) = 0.7 \\times \\ln(2)$\n- 位置 $3$：残基 G 处于“埋藏”环境（$s_3=\\text{buried}$）。\n  第 $3$ 项：$\\alpha_3 \\ln\\left(\\frac{\\pi_{\\text{buried}}(G)}{q(G)}\\right) = 0.6 \\times \\ln\\left(\\frac{0.035}{0.07}\\right) = 0.6 \\times \\ln(0.5) = -0.6 \\times \\ln(2)$\n- 位置 $5$：残基 V 处于“暴露”环境（$s_5=\\text{exposed}$）。\n  第 $5$ 项：$\\alpha_5 \\ln\\left(\\frac{\\pi_{\\text{exposed}}(V)}{q(V)}\\right) = 0.5 \\times \\ln\\left(\\frac{0.035}{0.07}\\right) = 0.5 \\times \\ln(0.5) = -0.5 \\times \\ln(2)$\n- 位置 $6$：残基 A 处于“暴露”环境（$s_6=\\text{exposed}$）。\n  第 $6$ 项：$\\alpha_6 \\ln\\left(\\frac{\\pi_{\\text{exposed}}(A)}{q(A)}\\right) = 0.4 \\times \\ln\\left(\\frac{0.075}{0.05}\\right) = 0.4 \\times \\ln(1.5)$\n\n将这些项相加得到 $S_{\\text{env}}$：\n$$\nS_{\\text{env}} = (0.5 + 0.7 - 0.6 - 0.5) \\ln(2) + 0.4 \\ln(1.5) = 0.1 \\ln(2) + 0.4 \\ln(1.5)\n$$\n\n第三，我们计算仿射空位罚分 $G_{\\text{gap}}$。在模板位置 4 处有一个长度为 $L=1$ 的单个空位，该位置处于“埋藏”环境中。公式为：\n$$\nG_{\\text{gap}} = \\beta(s_{\\text{gap}}) \\left( g_o + g_e(L-1) \\right)\n$$\n使用给定的参数：$g_o=2.0$，$g_e=0.4$，$\\beta(\\text{buried})=1.3$ 和 $L=1$。\n$$\nG_{\\text{gap}} = 1.3 \\times (2.0 + 0.4(1-1)) = 1.3 \\times (2.0 + 0) = 2.6\n$$\n\n最后，我们将这些部分组合起来计算总分 $S$：\n$$\nS = S_{\\text{profile}} + S_{\\text{env}} - G_{\\text{gap}}\n$$\n$$\nS = 3.3 \\ln(2) + \\left(0.1 \\ln(2) + 0.4 \\ln(1.5)\\right) - 2.6\n$$\n$$\nS = 3.4 \\ln(2) + 0.4 \\ln(1.5) - 2.6\n$$\n为了获得数值，我们使用近似值 $\\ln(2) \\approx 0.693147$ 和 $\\ln(1.5) \\approx 0.405465$。\n$$\nS \\approx 3.4 \\times 0.693147 + 0.4 \\times 0.405465 - 2.6\n$$\n$$\nS \\approx 2.3566998 + 0.162186 - 2.6\n$$\n$$\nS \\approx 2.5188858 - 2.6\n$$\n$$\nS \\approx -0.0811142\n$$\n将结果四舍五入到四位有效数字，得到 $-0.08111$。", "answer": "$$\n\\boxed{-0.08111}\n$$", "id": "4538342"}, {"introduction": "当一种预测方法生成一个三维模型后，我们如何衡量其准确性？本练习 [@problem_id:4538381] 聚焦于一个关键的评估策略：评定预测的残基间接触的正确性。您将应用数据分析中的标准指标——精确率（precision）、召回率（recall）和 F1 分数（F1-score）——来量化接触预测器的性能，这对于比较不同算法和理解预测结构的置信度至关重要。", "problem": "在从头计算（ab initio）和穿线（threading）蛋白质结构预测的背景下，对一个序列长度为 $L = 120$ 的蛋白质进行长程残基接触分析。当一个经过整理的蛋白质数据库（PDB）结构中，位置 $i$ 和 $j$ 之间的β-碳原子（$\\mathrm{C}\\beta$）–$\\mathrm{C}\\beta$ 欧几里得距离（对于甘氨酸，使用α-碳原子（$\\mathrm{C}\\alpha$））小于一个具有物理意义的阈值 $d_c = 8\\,\\text{\\AA}$，并且序列间隔满足 $|i - j| \\geq 24$ 时，定义它们之间存在一个残基接触。一个从头计算预测器（在统计势下对构象进行采样）和一个基于穿线的预测器（将序列与结构模板进行比对）生成了预测的接触对；在预测距离的决策阈值 $d_c$ 下，共识预测集由任一预测器估计距离在 $d_c$ 之内的接触对组成。为了进行评估，我们只考虑满足 $i  j$ 和 $|i - j| \\geq 24$ 的无序残基索引对。\n\n从PDB结构中得到的真实长程接触集为\n$$\n\\mathbb{T} = \\{(5,40),(7,85),(12,68),(15,98),(22,90),(27,60),(31,79),(33,75),(35,100),(42,70),(50,95),(62,88)\\}.\n$$\n在阈值 $d_c$ 下预测的长程接触集（从头计算和基于穿线的预测器的共识）为\n$$\n\\mathbb{P} = \\{(5,40),(8,85),(12,68),(15,99),(22,90),(27,61),(31,79),(33,76),(35,100),(42,71),(50,95),(62,89),(10,55),(75,110)\\}.\n$$\n\n使用医学数据分析中二元分类的精确率（precision）、召回率（recall）和F1分数（F1-score）的标准定义，计算限定于所述长程标准的接触预测的精确率、召回率和F1分数。将最终答案表示为（精确率，召回率，F1分数）顺序的行向量。将每个值四舍五入到四位有效数字。最终数值答案中不应包含任何单位。", "solution": "该问题要求计算蛋白质结构分析中一个接触预测任务的精确率、召回率和F1分数。这些指标是二元分类中的标准指标，并且是根据真阳性（true positives）、假阳性（false positives）和假阴性（false negatives）来定义的。\n\n设 $\\mathbb{T}$ 为真实残基接触集（“真实情况”），$\\mathbb{P}$ 为预测的残基接触集。问题给出的这些集合如下：\n$$\n\\mathbb{T} = \\{(5,40),(7,85),(12,68),(15,98),(22,90),(27,60),(31,79),(33,75),(35,100),(42,70),(50,95),(62,88)\\}\n$$\n$$\n\\mathbb{P} = \\{(5,40),(8,85),(12,68),(15,99),(22,90),(27,61),(31,79),(33,76),(35,100),(42,71),(50,95),(62,89),(10,55),(75,110)\\}\n$$\n这个问题定义明确，并且所有给定的残基对 $(i,j)$ 都满足长程条件 $|i-j| \\geq 24$。\n\n我们定义以下量：\n1.  **真阳性 ($TP$)**：预测的接触中同时也是真实接触的数量。这等于两个集合交集的大小，即 $TP = |\\mathbb{T} \\cap \\mathbb{P}|$。\n2.  **假阳性 ($FP$)**：预测的接触中不是真实接触的数量。这是在 $\\mathbb{P}$ 中但不在 $\\mathbb{T}$ 中的元素数量，所以 $FP = |\\mathbb{P} \\setminus \\mathbb{T}| = |\\mathbb{P}| - TP$。\n3.  **假阴性 ($FN$)**：未被预测到的真实接触的数量。这是在 $\\mathbb{T}$ 中但不在 $\\mathbb{P}$ 中的元素数量，所以 $FN = |\\mathbb{T} \\setminus \\mathbb{P}| = |\\mathbb{T}| - TP$。\n\n首先，我们通过找出两个集合中都存在的对来确定交集 $\\mathbb{T} \\cap \\mathbb{P}$。只有当两个集合中的索引完全相同时，一对 $(i,j)$ 才被视为匹配。\n- $(5,40)$ 同时存在于 $\\mathbb{T}$ 和 $\\mathbb{P}$ 中。\n- $(7,85) \\in \\mathbb{T}$，但 $(7,85) \\notin \\mathbb{P}$。注意 $(8,85) \\in \\mathbb{P}$ 是一个不同的对。\n- $(12,68)$ 同时存在于 $\\mathbb{T}$ 和 $\\mathbb{P}$ 中。\n- $(15,98) \\in \\mathbb{T}$，但 $(15,98) \\notin \\mathbb{P}$。注意 $(15,99) \\in \\mathbb{P}$ 是一个不同的对。\n- $(22,90)$ 同时存在于 $\\mathbb{T}$ 和 $\\mathbb{P}$ 中。\n- $(27,60) \\in \\mathbb{T}$，但 $(27,60) \\notin \\mathbb{P}$。注意 $(27,61) \\in \\mathbb{P}$ 是一个不同的对。\n- $(31,79)$ 同时存在于 $\\mathbb{T}$ 和 $\\mathbb{P}$ 中。\n- $(33,75) \\in \\mathbb{T}$，但 $(33,75) \\notin \\mathbb{P}$。注意 $(33,76) \\in \\mathbb{P}$ 是一个不同的对。\n- $(35,100)$ 同时存在于 $\\mathbb{T}$ 和 $\\mathbb{P}$ 中。\n- $(42,70) \\in \\mathbb{T}$，但 $(42,70) \\notin \\mathbb{P}$。注意 $(42,71) \\in \\mathbb{P}$ 是一个不同的对。\n- $(50,95)$ 同时存在于 $\\mathbb{T}$ 和 $\\mathbb{P}$ 中。\n- $(62,88) \\in \\mathbb{T}$，但 $(62,88) \\notin \\mathbb{P}$。注意 $(62,89) \\in \\mathbb{P}$ 是一个不同的对。\n\n正确预测的接触集（真阳性）是：\n$$\n\\mathbb{T} \\cap \\mathbb{P} = \\{(5,40), (12,68), (22,90), (31,79), (35,100), (50,95)\\}\n$$\n真阳性的数量是 $TP = |\\mathbb{T} \\cap \\mathbb{P}| = 6$。\n\n真实接触的总数是 $|\\mathbb{T}| = 12$。\n预测接触的总数是 $|\\mathbb{P}| = 14$。\n\n现在我们可以计算 $FP$ 和 $FN$：\n$FP = |\\mathbb{P}| - TP = 14 - 6 = 8$。\n$FN = |\\mathbb{T}| - TP = 12 - 6 = 6$。\n\n有了这些值，我们就可以计算精确率 ($P$)、召回率 ($R$) 和 F1分数 ($F_1$)：\n**精确率 ($P$)** 是预测正确的接触占所有预测接触的比例：\n$$\nP = \\frac{TP}{TP + FP} = \\frac{TP}{|\\mathbb{P}|} = \\frac{6}{14} = \\frac{3}{7}\n$$\n**召回率 ($R$)**，也称为灵敏度，是正确预测的接触占所有真实接触的比例：\n$$\nR = \\frac{TP}{TP + FN} = \\frac{TP}{|\\mathbb{T}|} = \\frac{6}{12} = \\frac{1}{2}\n$$\n**F1分数 ($F_1$)** 是精确率和召回率的调和平均数：\n$$\nF_1 = 2 \\cdot \\frac{P \\cdot R}{P + R} = \\frac{2TP}{2TP + FP + FN} = \\frac{2 \\cdot 6}{2 \\cdot 6 + 8 + 6} = \\frac{12}{12 + 14} = \\frac{12}{26} = \\frac{6}{13}\n$$\n\n最后，我们按照要求将这些分数转换成小数值，并四舍五入到四位有效数字：\n$P = \\frac{3}{7} \\approx 0.428571... \\approx 0.4286$\n$R = \\frac{1}{2} = 0.5$。表示为四位有效数字，即为 $0.5000$。\n$F_1 = \\frac{6}{13} \\approx 0.461538... \\approx 0.4615$\n\n最终答案是行向量（精确率，召回率，F1分数）。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4286 & 0.5000 & 0.4615 \\end{pmatrix}}\n$$", "id": "4538381"}]}