## 引言
医学图像处理是连接医学成像物理学与临床定量分析的关键桥梁，它使我们能够从CT、MRI等扫描图像中提取有价值的生物学和解剖学信息。然而，许多从业者面临的挑战在于，如何将抽象的数学原理与处理真实世界复杂数据的实践有效结合起来。本文旨在填补这一知识沟鸿，系统性地引导您从基础理论走向实际应用。

在接下来的内容中，您将首先在“原理与机制”一章中学习到构建医学图像的统一数学模型，并掌握卷积、傅里叶变换以及线性和[非线性滤波](@entry_id:201008)等核心技术。接着，“应用与跨学科连接”一章将展示这些原理如何应用于边缘检测、去噪、图像配准等真实场景，并探讨其与医学物理、统计学乃至法规伦理的交叉点。最后，“动手实践”部分将提供具体的编程练习，让您将理论付诸实践。通过这个结构化的学习路径，您将为应对高级医学图像分析挑战打下坚实的基础。

## 原理与机制

本章旨在系统性地阐述医学[图像处理](@entry_id:276975)中的核心原理与基础机制。我们将从一个统一的[线性系统](@entry_id:163135)模型出发，探讨图像的形成与退化过程，然后深入分析用于[图像增强](@entry_id:635785)、去噪和特征提取的基本操作。通过本章的学习，您将掌握空间域滤波、[频域分析](@entry_id:265642)、梯度计算以及非线性处理等关键技术，并理解它们在处理不同模态（如CT、MRI和超声）医学图像时的具体应用与理论依据。

### 医学图像建模：[线性系统](@entry_id:163135)框架

在深入研究[图像处理](@entry_id:276975)算法之前，建立一个描述图像获取过程的数学模型至关重要。一个在实践中广泛应用且富有洞察力的模型将观测到的医学图像 $y$ 视为一个线性移不变（Linear Shift-Invariant, LSI）系统对真实物理场景 $x$ 响应的结果，并叠加了噪声 $n$。该模型可表示为：

$$y = (x * h) + n$$

这里，各个符号代表的意义如下：
- $y$ 是我们实际观测或测量到的图像，是一个二维或三维的数值矩阵。
- $x$ 是未知的“真实”图像，它代表了我们希望测量的组织或器官的内在物理属性。
- $h$ 是系统的**点扩散函数（Point Spread Function, PSF）**。它描述了成像系统对一个理想[点源](@entry_id:196698)的响应。物理上，由于成像设备存在固有的局限性，一个无限小的点在最终图像中会被模糊成一个有一定尺寸和形状的斑点，这个斑点就是PSF。
- $*$ 表示**卷积（convolution）**运算。该运算精确地描述了[LSI系统](@entry_id:274179)如何通过其PSF $h$ 对输入图像 $x$ 的每一点进行模糊，并将所有模糊结果线性叠加，形成最终的无噪声图像。
- $n$ 是**噪声（noise）**项，代表了在图像采集和重建过程中引入的各种随机扰动。

这个看似简单的模型具有强大的概括性，但其具体内涵在不同的医学成像模态中有着显著的差异。理解这些差异对于设计和应用有效的图像处理算法至关重要 [@problem_id:4540852]。

- **[计算机断层扫描](@entry_id:747638)（Computed Tomography, CT）**：
    - **真实对象 $x$**：CT图像旨在重建组织对X射线的衰减能力。因此，$x$ 代表了**线性衰减系数 $\mu$** 的空间分布图。图像中的亨斯菲尔德单位（Hounsfield Units, HU）是这些系数的[线性缩放](@entry_id:197235)。
    - **PSF $h$**：CT图像的模糊源于多个因素，包括[X射线源](@entry_id:268482)的有限尺寸、探测器单元的[孔径效应](@entry_id:269954)，以及至关重要的**重建算法**。例如，在滤波反投影（Filtered Back-projection, FBP）算法中，所选的重建核（如Ram-Lak或Shepp-Logan核）直接决定了最终图像的PSF。尽管存在一定的[空间变异性](@entry_id:755146)，但在局部区域内，系统通常可被近似为[LSI系统](@entry_id:274179)。
    - **噪声 $n$**：CT噪声的根本来源是X射线[光子计数](@entry_id:186176)的量子统计特性，其本质上遵循**泊松分布（Poisson distribution）**。然而，在经过对数变换和重建过程后，对于中高剂量的扫描，最终图像中的噪声可以被很好地近似为**加性[高斯噪声](@entry_id:260752)（additive Gaussian noise）**。

- **[磁共振成像](@entry_id:153995)（Magnetic Resonance Imaging, MRI）**：
    - **真实对象 $x$**：MRI通过探测组织内核自旋（主要是氢质子）的响应来成像。通过调整脉冲序列，可以使图像对比度依赖于多种参数。因此，$x$ 代表了**质子密度**或由[弛豫时间](@entry_id:191572)（如 $T_1$ 和 $T_2$）加权的**自旋属性**的[空间分布](@entry_id:188271)。
    - **PSF $h$**：MRI在[空间频率](@entry_id:270500)域（即**k空间**）中采集数据，通过[傅里叶逆变换](@entry_id:178300)重建图像。由于k空间采样范围有限，这相当于在频域中乘以一个窗函数。根据[卷积定理](@entry_id:264711)，这对应于在图像域中与该[窗函数](@entry_id:139733)的[傅里叶逆变换](@entry_id:178300)进行卷积。对于一个矩形的k空间采样窗口，其PSF是一个**[sinc函数](@entry_id:274746)**。MRI系统通常在指定的[视场](@entry_id:175690)（Field of View, FOV）内被视为高度移不变的。
    - **噪声 $n$**：MRI中的主要噪声源是来自患者身体和接收线圈电子器件的热噪声。在复数图像数据中，该噪声被精确地建模为**加性、白色、复[高斯噪声](@entry_id:260752)**。临床上显示的模图像是通过对复数图像取幅度得到的。一个具有高斯实部和虚部的复随机变量的模遵循**莱斯分布（Rician distribution）**。

- **诊断超声（Diagnostic Ultrasound）**：
    - **真实对象 $x$**：B模式超声图像的亮度反映了组织微结构对声波的回波强度。因此，$x$ 代表了组织的**声学背向散射反射率**。
    - **PSF $h$**：超声的PSF由声脉冲的时空特性决定，具有显著的各向异性和[空间变异性](@entry_id:755146)，尤其是在深度方向上。
    - **噪声 $n$**：超声图像的“噪声”成分较为复杂。除了电子系统引入的加性高斯噪声外，其最显著的特征是**散斑（speckle）**。散斑并非真正的随机噪声，而是由相干的超声波与小于分辨率的散射体相互干涉形成的确定性干涉图样。关键在于，在标准的[B模](@entry_id:161767)式图像中，散斑被最佳地建模为**[乘性噪声](@entry_id:261463)（multiplicative noise）**。因此，加性模型 $y = (x * h) + n$ 对于原始超声图像的物理过程是一个较差的近似。更精确的模型是 $y = (x * h) \cdot s$，其中 $s$ 是散斑分量。为了应用处理[加性噪声](@entry_id:194447)的算法，通常需要进行对数压缩等**同态处理（homomorphic processing）**，将乘性噪声转换为[加性噪声](@entry_id:194447)。

### 基本运算：卷积与相关

线性滤波是医学图像处理的基石，其核心运算是**卷积**。对于一个离散的二维图像 $f[i,j]$ 和一个滤波器核（或称冲激响应）$g[u,v]$，它们的卷积定义为：

$$(f * g)[i,j] = \sum_{m}\sum_{n} f[m,n]\,g[i-m,j-n]$$

这个公式的直观解释是“翻转并滑动”（flip-and-slide）。为了计算输出图像在位置 $(i,j)$ 的值，我们首先将滤波器核 $g$ 相对于其原点进行水平和垂直翻转（即 $g[u,v]$ 变为 $g[-u,-v]$），然后将翻转后的核的中心平移到图像的 $(i,j)$ 位置，最后将核的每个元素与覆盖的图像像素值相乘并求和 [@problem_id:4540908]。

与卷积密切相关的是**[互相关](@entry_id:143353)（cross-correlation）**运算，其定义为：

$$(f \star g)[i,j] = \sum_{m}\sum_{n} f[i+m,j+n]\,g[m,n]$$

[互相关](@entry_id:143353)的直观解释是“滑动”（slide），即直接将滤波器核 $g$ 在图像上滑动，并在每个位置计算加权和，没有翻转的步骤。

[卷积和](@entry_id:263238)相关的关系可以通过翻转的核联系起来：与核 $g$ 进行卷积等价于与翻转后的核 $g_{flip}[u,v] = g[-u,-v]$ 进行相关。这一区别在实际应用中至关重要：

- **对于对称核**：如果一个滤波器核是中心对称的，即 $g[u,v] = g[-u,-v]$（例如，高斯核或盒状核），那么翻转操作不改变核本身。在这种情况下，**[卷积和](@entry_id:263238)相关是等价的**。许多软件库在实现时可能使用相关运算来代替卷积，因为它的实现更直接。

- **对于非对称核**：如果核是非对称的（例如，用于边缘检测的Sobel等一阶导数算子），[卷积和](@entry_id:263238)相关将产生不同的结果。例如，一个设计用于检测从暗到亮过渡的垂直边缘的[卷积核](@entry_id:635097)，如果用相关运算实现，则会变成一个检测从亮到暗过渡的垂直边缘的算子，其响应符号会反转。

**[匹配滤波](@entry_id:144625)（Matched Filtering）** 是相关运算的一个重要应用。在加性白高斯噪声中，为了最大化检测一个已知信号或模板 $g$ 的[信噪比](@entry_id:271196)（Signal-to-Noise Ratio, SNR），最佳的线性滤波器（即[匹配滤波器](@entry_id:137210)）的冲激响应 $h$ 必须是模板的共轭和翻转版本，即 $h[u,v] = \overline{g[-u,-v]}$。应用此滤波器（即计算 $f*h$）在数学上恰好等价于计算输入图像 $f$ 与原始模板 $g$ 的[互相关](@entry_id:143353) $(f \star g)$。因此，在图像中寻找特定模式的最佳方法是使用相关运算 [@problem_id:4540908]。

### 线性与[非线性滤波](@entry_id:201008)

根据系统理论，一个滤波器 $T$ 如果满足**叠加原理（superposition principle）**，则被称为**线性滤波器**。[叠加原理](@entry_id:144649)包括两个方面：可加性（$T(f+g) = T(f)+T(g)$）和齐次性（$T(af) = aT(f)$）。综合起来，线性滤波器的定义为：

$$T(af+bg) = aT(f) + bT(g)$$

其中 $f$ 和 $g$ 是任意图像，$a$ 和 $b$ 是任意标量。所有通过与一个[固定核](@entry_id:169539)进行卷积实现的滤波器都是线性移不变（LSI）滤波器。

不满足[叠加原理](@entry_id:144649)的滤波器则被称为**[非线性滤波器](@entry_id:271726)**。[非线性滤波器](@entry_id:271726)在医学[图像处理](@entry_id:276975)中扮演着同样重要的角色，因为它们可以实现线性滤波器无法完成的任务，例如在去除特定类型噪声的同时保持边缘的清晰度。

一个典型的[非线性滤波器](@entry_id:271726)是**[中值滤波器](@entry_id:264182)（median filter）**。[中值滤波器](@entry_id:264182)将其邻域内所有像素值的中值作为该像素的输出值。它对于去除“椒盐噪声”（salt-and-pepper noise）等脉冲噪声非常有效，且相比于均值滤波（一种线性滤波），它能更好地保护图像边缘。

我们可以通过一个简单的反例来证明[中值滤波器](@entry_id:264182)的非线性 [@problem_id:4540881]。考虑两个一维信号（可视为图像的一行）：$f = [0, 0, 10]$ 和 $g = [10, 0, 0]$。我们对一个长度为3的窗口应用中值滤波：
- $M(f) = \text{median}\{0, 0, 10\} = 0$
- $M(g) = \text{median}\{10, 0, 0\} = 0$
- 因此，$M(f) + M(g) = 0 + 0 = 0$

现在，我们先将信号相加，再应用滤波器：
- $f+g = [0, 0, 10] + [10, 0, 0] = [10, 0, 10]$
- $M(f+g) = \text{median}\{10, 0, 10\} = 10$

由于 $M(f+g) = 10 \neq M(f) + M(g) = 0$，[中值滤波器](@entry_id:264182)违反了可加性原则，因此它是一个[非线性滤波器](@entry_id:271726)。

### [频域分析](@entry_id:265642)：傅里叶变换

傅里叶变换是将图像从空间域转换到频率域的强大数学工具。在频率域中，图像被表示为其不同空间频率（对应于图像中从慢到快变化的模式）正弦波分量的集合。这种表示方式为理解和设计滤波器提供了深刻的见解。

#### 卷积定理

[频域分析](@entry_id:265642)的核心是**[卷积定理](@entry_id:264711)（Convolution Theorem）**。该定理指出，两个函数在空间域的卷积等价于它们各自的傅里叶变换在频率域的**逐点相乘**。对于图像 $f$ 和滤波器 $h$，其卷积结果 $g = f*h$ 的傅里叶变换 $G$ 满足：

$$G(\omega_x, \omega_y) = F(\omega_x, \omega_y) \cdot H(\omega_x, \omega_y)$$

其中 $F$ 和 $H$ 分别是 $f$ 和 $h$ 的傅里叶变换。这个定理揭示了滤波的本质：一个线性滤波器通过其[频率响应](@entry_id:183149) $H$ 来调制输入图像的[频谱](@entry_id:276824) $F$，即放大或衰减特定频率的分量 [@problem_id:4540889]。例如，一个低通滤波器会衰减高频分量，从而实现平滑去噪。

#### [计算效率](@entry_id:270255)

除了理论上的洞察力，卷积定理还提供了计算卷积的一种高效方法，特别是当滤波器核尺寸较大时。直接在空间域计算一个 $n \times n$ 图像与一个 $k \times k$ 核的卷积，其计算复杂度约为 $O(n^2 k^2)$。

利用卷积定理，我们可以通过以下步骤计算卷积：
1. 计算图像 $f$ 的傅里叶变换 $F$。
2. 计算滤波器核 $h$ 的傅里叶变换 $H$。
3. 在频率域中将它们逐点相乘得到 $G = F \cdot H$。
4. 计算 $G$ 的[傅里叶逆变换](@entry_id:178300)得到最终结果 $g$。

当使用**快速傅里叶变换（Fast Fourier Transform, FFT）**算法时，对一个 $N \times N$ 的（填充后的）图像进行变换的复杂度约为 $O(N^2 \log N)$。因此，整个基于FFT的卷积过程的复杂度也为 $O(N^2 \log N)$。

比较两种方法的复杂度，当核尺寸 $k$ 足够大时，$O(N^2 \log N)$ 将远小于 $O(N^2 k^2)$。我们可以计算出一个“盈亏平衡”的核尺寸 $k^\star$，当 $k > k^\star$ 时，使用FFT方法在计算上更高效。这个 $k^\star$ 的值取决于FFT和直接乘法加法的相对计算成本，但对于典型的中大尺寸图像，它通常是一个较小的值（例如，对于2048x2048的图像，可能在 $k \approx 13$ 左右）[@problem_id:4540889]。这解释了为什么在许多应用中，[频域滤波](@entry_id:147532)是首选的实现方式。

### 核心应用：平滑与去噪

图像平滑是一种旨在抑制噪声和微小细节的低通滤波过程。理想的平滑滤波器应能有效去除噪声，同时最大限度地保留重要的结构信息，如边缘。

#### [平滑核](@entry_id:195877)的比较：盒状核 vs. 高斯核

- **盒状核（Box Filter）**：也称为均值滤波器，它将其邻域内所有像素的平均值作为输出。它实现简单，但性能不佳。其[频率响应](@entry_id:183149)是一个**[sinc函数](@entry_id:274746)**，即 $\frac{\sin(x)}{x}$。[sinc函数](@entry_id:274746)除了在零频处的主瓣外，还包含一系列衰减的[旁瓣](@entry_id:270334)，并且这些旁瓣会取负值。这些负值旁瓣会导致在图像的强边缘附近产生“振铃”伪影（ringing artifacts）[@problem_id:4540882]。

- **高斯核（Gaussian Filter）**：高斯核的权重随着与中心像素距离的增加而平滑地呈高斯分布下降。高斯核是线性平滑的首选滤波器，其优越性源于其独特的数学性质。[高斯函数的傅里叶变换](@entry_id:260759)仍然是一个高斯函数。这个频率响应函数始终为正，且从零频开始单调递减，没有任何[旁瓣](@entry_id:270334)。这意味着高斯滤波在衰减高频噪声的同时，不会引入[振铃伪影](@entry_id:147177) [@problem_id:4540882]。

#### 不确定性原理与高斯核的最优性

高斯核的优越性可以通过**空间-频率[不确定性原理](@entry_id:141278)**得到更深刻的解释。该原理指出，一个信号在空间域的局部化程度（即其有效宽度 $\sigma_x$）和在频率域的局部化程度（即其[有效带宽](@entry_id:748805) $\sigma_\omega$）之间存在一个固有的权衡。它们的乘积有一个下限：

$$\sigma_x \sigma_\omega \ge \frac{1}{2}$$

这意味着一个信号不可能在空间域和频率域都无限地集中。[高斯函数](@entry_id:261394)是唯一能够达到这个理论下限的函数。这表明，高斯滤波器在空间局部化（避免过度模糊）和频率局部化（精确地作为低通滤波器）之间实现了最佳的平衡 [@problem_id:4540882]。

#### 理论基础：尺度空间理论

高斯核的重要性也在**尺度空间理论（Scale-Space Theory）**中得到了公理化的证明。该理论旨在为多[尺度图](@entry_id:195156)像分析建立一个坚实的理论基础。它提出了一组看似自然的公理，要求一个尺度空间表示 $L(x, \sigma)$（其中 $\sigma$ 是[尺度参数](@entry_id:268705)）必须满足：线性、移不变性、**因果性**（随着尺度的增加不应创建新的[局部极值](@entry_id:144991)），以及**[半群性质](@entry_id:271012)**（在尺度 $\sigma_1$ 上平滑后再在尺度 $\sigma_2$ 上平滑，等同于一次性在尺度 $\sqrt{\sigma_1^2 + \sigma_2^2}$ 上平滑）。

惊人的结论是，唯一满足所有这些公理的卷积核族就是**高斯核**。这种演化过程在数学上由热传导方程（heat equation）$\partial_\sigma L = \alpha \Delta L$ 描述，其中 $\Delta$ 是[拉普拉斯算子](@entry_id:262740)。这为高斯核在图像分析中的核心地位提供了强有力的理论支持 [@problem_id:4540907]。

#### 保边平滑：双边滤波器

尽管高斯滤波性能优越，但它作为一种线性滤波器，仍会无差别地模糊图像中的所有结构，包括我们希望保留的锐利边缘。为了解决这个问题，研究者们开发了多种**保边平滑（edge-preserving smoothing）**技术，其中最著名的是**双边滤波器（bilateral filter）**。

双边滤波器是一种[非线性滤波器](@entry_id:271726)，其输出是邻域像素的加权平均。其巧妙之处在于，权重由两个核的乘积决定 [@problem_id:4540917]：
1. **空间核（Spatial Kernel）**：与高斯滤波一样，它根据像素间的空间距离分配权重。距离越近的像素权重越高。
2. **值域核（Range Kernel）**：这是双边滤波器的关键。它根据像素值的相似性分配权重。与中心像素值越接近的邻域像素，其权重越高。

完整的权重 $w(p,q)$ 可以写成：
$$w(p,q) = \exp\left( - \frac{\|p-q\|^2}{2\sigma_s^2} \right) \exp\left( - \frac{(I(p)-I(q))^2}{2\sigma_r^2} \right)$$
其中 $\sigma_s$ 控制[空间平滑](@entry_id:202768)的尺度，$\sigma_r$ 控制值域平滑的尺度。

这种机制使得双边滤波器能够在平滑区域内（像素值相似，值域核权重高）进行有效的[噪声抑制](@entry_id:276557)，同时在边缘处（像素值差异大，值域核权重接近零）停止平滑，从而保护了边缘。当值域尺度 $\sigma_r \to \infty$ 时，值域核恒等于1，双边滤波器退化为标准的高斯滤波器。在实践中，$\sigma_r$ 的选择通常与图像中的噪声水平相关，一个常见的[经验法则](@entry_id:262201)是将其设置为噪声标准差的1到2倍 [@problem_id:4540917]。

### 核心应用：基于梯度的边缘检测

边缘是图像中强度发生急剧变化的位置，通常对应于物理对象的边界。检测边缘是许多医学图像分析任务（如分割和配准）的第一步。最常用的边缘检测方法是基于图像梯度。

#### 图像梯度及其不变性

对于一个二维图像 $I(x,y)$，其**梯度（gradient）**是一个向量，指向图像强度增长最快的方向：

$$\nabla I(x,y) = \begin{pmatrix} \frac{\partial I}{\partial x}  \frac{\partial I}{\partial y} \end{pmatrix}$$

梯度的**幅度** $\lVert \nabla I \rVert_2 = \sqrt{(\frac{\partial I}{\partial x})^2 + (\frac{\partial I}{\partial y})^2}$ 表示强度变化的大小，即边缘的强度。梯度的**方向** $\theta = \operatorname{atan2}(\frac{\partial I}{\partial y}, \frac{\partial I}{\partial x})$ 表示边缘的法线方向。

[梯度算子](@entry_id:275922)有一个至关重要的性质：它对图像整体亮度的加性变化是不变的。如果图像被一个常数偏置 $b$ 改变，即 $I_b = I + b$，其梯度保持不变：$\nabla I_b = \nabla (I+b) = \nabla I + \nabla b = \nabla I$（因为常数的导数为零）。因此，梯度幅度和方向也保持不变 [@problem_id:4540876]。这个性质保证了边缘检测结果不会因为扫描仪的亮度漂移等因素而改变。在离散图像中，使用如Sobel或Prewitt这样系数和为零的导数核进行卷积，同样可以保持这种不变性。

#### 噪声问题与高斯导数

直接在含噪图像上计算梯度会产生严重的问题。从频域角度看，[微分算子](@entry_id:140145) $\frac{\partial}{\partial x}$ 的频率响应为 $i\omega_x$。这意味着它会线性地放大高频分量。由于噪声通常主要分布在高频段，[微分](@entry_id:158422)操作会极大地放大噪声，使得真实的边缘被淹没在虚假的噪声响应中 [@problem_id:4540915]。对于理想的白噪声模型，其输出噪声的方差甚至会发散到无穷大。

解决这个问题的标准方法是**先平滑后[微分](@entry_id:158422)**。具体而言，我们首先用高斯核 $G_\sigma$ 对图像进行平滑，以抑制高频噪声，然后再计算平滑后图像的梯度。利用[卷积和](@entry_id:263238)[微分的线性](@entry_id:161574)[可交换性](@entry_id:263314)，这个两步过程等价于一步操作：将[原始图](@entry_id:262918)像与一个**高斯导数（Derivative of Gaussian, DoG）**核进行卷积。

$$\nabla (G_\sigma * I) = (\nabla G_\sigma) * I$$

这个组合算子 $\nabla G_\sigma$ 的核函数为 [@problem_id:4540915]：

$$\nabla G_{\sigma}(x,y) = \begin{pmatrix} -\frac{x}{2\pi\sigma^{4}} \exp\left(-\frac{x^{2}+y^{2}}{2\sigma^{2}}\right)  -\frac{y}{2\pi\sigma^{4}} \exp\left(-\frac{x^{2}+y^{2}}{2\sigma^{2}}\right) \end{pmatrix}$$

通过选择合适的高斯尺度 $\sigma$，我们可以在抑制噪声和保持边缘定位精度之间取得平衡。这个“平滑后[微分](@entry_id:158422)”的策略是现代边缘检测算法（如Canny边缘检测器）的理论核心。

### 多分辨率处理：采样与金字塔

[多分辨率分析](@entry_id:275968)，即在不同尺度上分析图像，是医学图像处理中的一个强大范式。构建图像金字塔是实现[多分辨率分析](@entry_id:275968)的常用方法，它涉及到对图像的**[降采样](@entry_id:265757)（downsampling）**。

[降采样](@entry_id:265757)，或称抽取（decimation），是通过保留原始图像中的部分像素来创建一幅尺寸更小的图像。例如，因子为 $s$ 的[降采样](@entry_id:265757)意味着每隔 $s$ 个像素取一个像素，从而使图像尺寸在每个维度上都缩小为原来的 $1/s$。

然而，直接进行[降采样](@entry_id:265757)会导致一种称为**混叠（aliasing）**的严重失真。从频域角度看，对图像进行因子为 $s$ 的[降采样](@entry_id:265757)，会导致其[频谱](@entry_id:276824)在每个维度上被“拉伸” $s$ 倍，并产生 $s^2-1$ 个[频谱](@entry_id:276824)副本。如果[原始图](@entry_id:262918)像的[频谱](@entry_id:276824)不够窄，这些被拉伸和复制的[频谱](@entry_id:276824)就会发生重叠，高频信息就会错误地“伪装”成低频信息，导致图像出现锯齿和[摩尔纹](@entry_id:276058)等失真 [@problem_id:4540832]。

根据**[奈奎斯特-香农采样定理](@entry_id:262499)（Nyquist-Shannon sampling theorem）**，为了避免[降采样](@entry_id:265757)时的混叠，必须确保在[降采样](@entry_id:265757)之前，原始图像的[频谱](@entry_id:276824)被限制在一个特定的范围内。具体来说，对于因子为 $s$ 的[降采样](@entry_id:265757)，图像信号的频率必须被限制在 $[-\pi/s, \pi/s]$ [弧度](@entry_id:171693)/像素的范围内。

因此，正确的[降采样](@entry_id:265757)流程是：
1. **预滤波（Pre-filtering）**：在[降采样](@entry_id:265757)之前，使用一个低通滤波器对原始图像进行平滑，以去除所有高于截止频率 $\Omega_c = \pi/s$ 的频率分量。
2. **抽取（Decimation）**：在经过低通滤波的图像上进行像素抽取。

这个过程确保了[降采样](@entry_id:265757)后的图像不会出现混叠失真，为稳健的[多尺度分析](@entry_id:270982)奠定了基础。理想情况下，这个预滤波器是一个[理想低通滤波器](@entry_id:266159)，但在实践中，通常使用高斯滤波器作为其近似。