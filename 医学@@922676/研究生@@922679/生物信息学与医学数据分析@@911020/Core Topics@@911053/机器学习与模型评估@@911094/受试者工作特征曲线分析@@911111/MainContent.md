## 引言
在生物信息学和医学数据分析领域，我们不断开发新的模型来预测疾病风险、诊断疾病状态或评估治疗效果。然而，如何客观、全面地评估这些模型的性能，并在此基础上做出可靠的科学与临床决策，是一个核心挑战。[受试者工作特征](@entry_id:634523)（Receiver Operating Characteristic, ROC）分析正是应对这一挑战的基石性工具。它提供了一个独立于决策阈值的强大框架，用以量化和比较分类器区分不同类别（如“患病”与“健康”）的能力。

本文旨在系统性地阐释ROC分析的理论与实践。我们首先会解决一个关键的知识缺口：超越对AU[C值](@entry_id:272975)的表面认知，深入理解ROC曲线是如何从分类器评分中产生的，其形状由何决定，以及它在不同统计和临床背景下的深刻含义。通过学习本文，您将能够自信地构建、解读和应用ROC分析来评估您的模型。

文章的结构清晰，层层递进。在“原理与机制”一章中，我们将奠定坚实的理论基础，从定义ROC空间到探讨AUC的概率解释、[奈曼-皮尔逊引理](@entry_id:163022)等核心概念。接着，在“应用与跨学科联系”一章中，我们将展示ROC分析如何从一个评估工具演变为指导临床决策、比较复杂模型、处理生存数据以及确保[算法公平性](@entry_id:143652)的多功能框架。最后，“动手实践”部分将通过具体的计算练习，帮助您将理论知识转化为实践技能，从而真正掌握ROC分析的精髓。

## 原理与机制

本章旨在深入探讨[受试者工作特征](@entry_id:634523)（Receiver Operating Characteristic, ROC）分析的核心原理与底层机制。我们将从构建[ROC曲线](@entry_id:182055)的基本要素出发，系统地阐释其数学基础、关键性质以及在实际应用中必须考虑的重要因素。读完本章后，您将能够理解[ROC曲线](@entry_id:182055)如何从分类器评分中产生，如何量化和解释其性能，以及在不同应用场景下（如类别不平衡或人群异质性）如何正确地使用和解读ROC分析。

### 基本概念：定义ROC空间

在生物信息学和医学数据分析中，我们常常构建模型来根据一系列测量指标（如基因表达水平、影像学特征）预测一个[二元结果](@entry_id:173636)，例如疾病状态。设想一个分类器，它为每个样本输出一个连续的**风险评分 (score)** $S$，其中较高的分值表示该样本属于“阳性”类别（例如，患有某种疾病）的可能性更大。为了将这个连续评分转化为一个二元决策（阳性或阴性），我们需要设定一个**决策阈值 (decision threshold)** $c$。一个常见的决策规则是：如果样本的评分 $S$ 大于阈值 $c$，则将其预测为阳性；否则，预测为阴性。

对于任何给定的阈值 $c$，分类器的表现可以通过一个2x2的**[混淆矩阵](@entry_id:635058) (confusion matrix)** 来总结，该矩阵包含四种可能的结果：

*   **[真阳性](@entry_id:637126) (True Positives, TP)**：真实为阳性且被正确预测为阳性的样本。
*   **[假阳性](@entry_id:635878) (False Positives, FP)**：真实为阴性但被错误预测为阳性的样本。
*   **真阴性 (True Negatives, TN)**：真实为阴性且被正确预测为阴性的样本。
*   **假阴性 (False Negatives, FN)**：真实为阳性但被错误预测为阴性的样本。

虽然这些计数本身很有用，但它们依赖于样本量。为了得到普适性的性能度量，我们使用比率，这些比率可以从条件概率的角度进行严格定义。设 $Y$ 为真实类别标签，其中 $Y=1$ 表示阳性（例如，患病），$Y=0$ 表示阴性（例如，健康）。决策规则可以表示为 $D_c = \mathbf{1}\{S > c\}$，其中 $\mathbf{1}\{\cdot\}$ 是[指示函数](@entry_id:186820)。

**从概率到比率：核心性能度量**

ROC分析的两个基本轴是[真阳性率](@entry_id:637442)和假阳性率，它们源于灵敏度和特异性的概念 [@problem_id:4604287]。

*   **灵敏度 (Sensitivity)**，也称为**[真阳性率](@entry_id:637442) (True Positive Rate, TPR)** 或**召回率 (Recall)**，指的是在所有真实阳性样本中，被正确识别为阳性的比例。它衡量了分类器“找出”阳性样本的能力。从概率上讲，它是给定样本为阳性（$Y=1$）的条件下，测试结果为阳性（$D_c=1$）的[条件概率](@entry_id:151013)：
    $$
    \text{TPR}(c) = \text{灵敏度}(c) = \Pr(D_c = 1 \mid Y = 1) = \Pr(S > c \mid Y = 1)
    $$

*   **特异性 (Specificity)** 指的是在所有真实阴性样本中，被正确识别为阴性的比例。它衡量了分类器“排除”阴性样本的能力。其定义为给定样本为阴性（$Y=0$）的条件下，测试结果为阴性（$D_c=0$）的条件概率：
    $$
    \text{特异性}(c) = \Pr(D_c = 0 \mid Y = 0) = \Pr(S \le c \mid Y = 0)
    $$

*   **假阳性率 (False Positive Rate, FPR)** 指的是在所有真实阴性样本中，被错误识别为阳性的比例。这通常被视为“误报率”。它是给定样本为阴性（$Y=0$）的条件下，测试结果为阳性（$D_c=1$）的[条件概率](@entry_id:151013)：
    $$
    \text{FPR}(c) = \Pr(D_c = 1 \mid Y = 0) = \Pr(S > c \mid Y = 0)
    $$

通过这些定义，我们可以清晰地看到特异性与假阳性率之间的内在联系。对于给定的阴性群体，样本要么被正确分类为阴性（真阴性），要么被错误分类为阳性（[假阳性](@entry_id:635878)）。因此，这两个事件的概率之和必须为1。
$$
\text{特异性}(c) + \text{FPR}(c) = \Pr(S \le c \mid Y = 0) + \Pr(S > c \mid Y = 0) = 1
$$
因此，我们得到一个至关重要的关系式：$\text{FPR}(c) = 1 - \text{特异性}(c)$。ROC空间正是由这两个核心指标——TPR和FPR——构成的。

### ROC曲线的构建与解读

**理论[ROC曲线](@entry_id:182055)**

**ROC曲线**是通过改变决策阈值 $c$ 从 $-\infty$ 到 $+\infty$，将所有可能产生的 $(\text{FPR}(c), \text{TPR}(c))$ 点对绘制在一个二维平面上所形成的轨迹。这个平面通常被称为**ROC空间**，其横轴为假阳性率（FPR），纵轴为真阳性率（TPR），范围均为 $[0, 1]$。

我们可以从阳性和阴性群体的评分分布来更深刻地理解[ROC曲线](@entry_id:182055)。设 $F_1(s) = \Pr(S \le s \mid Y=1)$ 和 $F_0(s) = \Pr(S \le s \mid Y=0)$ 分别为阳性群体和阴性群体的评分的**累积分布函数 (Cumulative Distribution Function, CDF)**。根据TPR和FPR的定义，我们可以将它们重写为 [@problem_id:4918273]：
$$
\text{TPR}(c) = 1 - \Pr(S \le c \mid Y = 1) = 1 - F_1(c)
$$
$$
\text{FPR}(c) = 1 - \Pr(S \le c \mid Y = 0) = 1 - F_0(c)
$$
因此，[ROC曲线](@entry_id:182055)本质上是当阈值 $c$ 遍历所有可[能值](@entry_id:187992)时，点集 $\{(1 - F_0(c), 1 - F_1(c))\}$ 形成的曲线。

如果 $F_0$ 在其支撑集上是严格递增的，那么它的反函数（即**[分位数函数](@entry_id:271351) (quantile function)**）$F_0^{-1}$ 就存在。我们可以将ROC曲线表示为一个以FPR（设为 $u$）为[自变量](@entry_id:267118)的函数 $\text{ROC}(u)$。设 $u = \text{FPR}(c) = 1 - F_0(c)$，解出 $c$ 可得 $c = F_0^{-1}(1-u)$。将其代入TPR的表达式中，我们得到ROC曲线的函数形式 [@problem_id:4918273]：
$$
\text{ROC}(u) = \text{TPR} = 1 - F_1(F_0^{-1}(1-u))
$$
这个表达式揭示了ROC曲线的形状完全由两个[条件概率分布](@entry_id:163069) $F_0$ 和 $F_1$ 决定。

**经验[ROC曲线](@entry_id:182055)**

在实践中，我们通常只有一组有限的、带有真实标签的样本数据 $\{(s_i, y_i)\}_{i=1}^n$。从这些数据构建的[ROC曲线](@entry_id:182055)称为**经验ROC曲线**。其构建算法如下 [@problem_id:4604334]：

1.  **初始化与计数**：计算样本中阳性总数 $P$ 和阴性总数 $N$。将[真阳性](@entry_id:637126)计数 $TP$ 和[假阳性](@entry_id:635878)计数 $FP$ 初始化为0。在ROC图上绘制第一个点 $(0, 0)$，这对应于一个高于所有样本评分的阈值，此时没有样本被预测为阳性。

2.  **排序与遍历**：将所有样本的评分 $s_i$ 从高到低进行排序。

3.  **迭代更新与绘点**：按照排好序的列表，依次处理每个样本。当阈值从当前样本的评分值 $s_i$ 跨过时，该样本的预测标签从阴性变为阳性。
    *   如果该样本是真实阳性 ($y_i=1$)，则 $TP$ 增加1。
    *   如果该样本是真实阴性 ($y_i=0$)，则 $FP$ 增加1。
    *   每次更新后，在图上绘制一个新的点 $(FP/N, TP/P)$。这会在ROC图上产生一个阶梯状的路径：处理一个阳性样本会使曲线向上移动一步（长度为 $1/P$），处理一个阴性样本会使曲线向右移动一步（长度为 $1/N$）。

4.  **处理评分相同的情况（Ties）**：如果多个样本具有完全相同的评分，标准做法是将它们视为一个组。当阈值跨过这个共同的评分时，所有这些样本同时被归为阳性。这意味着 $TP$ 和 $FP$ 会根据这个组内的阳性和阴性样本数量一次性更新。在ROC图上，这对应于一条斜线段，连接处理该组前后所对应的点。该斜线段的斜率等于该组中阳性样本数与阴性样本数之比 [@problem_id:4604334]。

5.  **终止**：处理完所有样本后，最后一个点将是 $(N/N, P/P) = (1, 1)$，对应于一个低于所有样本评分的阈值，此时所有样本都被预测为阳性。

### ROC性能的量化与表征

**曲线下面积 (Area Under the Curve, AUC)**

ROC曲线本身提供了分类器在所有可能阈值下性能的全面视图，但通常我们需要一个单一的数值来总结其整体性能。**[曲线下面积](@entry_id:169174) (Area Under the Curve, AUC)** 正是为此而生。AUC的取值范围在0到1之间。

AUC有一个非常直观和重要的概率解释：它等于从阳性群体中随机抽取一个样本，其评分高于从阴性群体中随机抽取一个样本的评分的概率 [@problem_id:4604309]。若用 $S_1$ 表示随机抽取的阳性样本评分，用 $S_0$ 表示随机抽取的阴性样本评分，则：
$$
\text{AUC} = \Pr(S_1 > S_0)
$$
（在处理离散或有限样本时，对于评分相等的情况，通常将其贡献计为0.5，即 $\text{AUC} = \Pr(S_1 > S_0) + 0.5 \cdot \Pr(S_1 = S_0)$。）

AUC值的含义如下 [@problem_id:4604294]：
*   **AUC = 1**：表示一个完美的分类器。存在一个阈值，可以完美地将两类样本分开。这意味着阳性样本的评分总是高于阴性样本的评分。
*   **AUC = 0.5**：表示一个不具信息量的分类器，其性能等同于随机猜测。在这种情况下，$\Pr(S_1 > S_0) = 0.5$，意味着一个阳性样本的评分高于一个阴性样本的可能性与低于它的可能性相同。这通常发生在阳性和阴性群体的评分分布完全相同时。
*   **AUC  0.5**：表示一个性能差于随机猜测的分类器。然而，这并非毫无价值。这通常意味着分类器系统性地将排序弄反了，即阳性样本的评分倾向于低于阴性样本的评分。通过简单地颠倒评分（例如，使用 $S' = -S$），我们可以得到一个新的分类器，其AUC为 $1 - \text{AUC}$，这个值将大于0.5。例如，如果一个分类器的评分分布为 $S_1 \sim \mathcal{N}(0, 1)$ 和 $S_0 \sim \mathcal{N}(1, 1)$，它的AUC会小于0.5。但如果我们使用 $S'=-S$，新的评分分布将变为 $S'_1 \sim \mathcal{N}(0, 1)$ 和 $S'_0 \sim \mathcal{N}(-1, 1)$，此时阳性样本的评分倾向于更高，新的AUC将大于0.5 [@problem_id:4604294]。

**尤登指数 (Youden's Index)**

除了AUC这个全局指标，有时我们也希望根据ROC曲线选择一个“最佳”的单一决策阈值。**尤登指数** $J(c)$ 就是为此设计的常用指标之一。它定义为在特定阈值 $c$ 下，灵敏度与特异性之和减1：
$$
J(c) = \text{灵敏度}(c) + \text{特异性}(c) - 1
$$
利用我们之前的关系式，$\text{灵敏度} = \text{TPR}$ 和 $\text{特异性} = 1 - \text{FPR}$，我们可以将尤登指数简化为 [@problem_id:4604287]：
$$
J(c) = \text{TPR}(c) + (1 - \text{FPR}(c)) - 1 = \text{TPR}(c) - \text{FPR}(c)
$$
这个表达式在ROC空间中具有清晰的几何意义：$J(c)$ 是ROC曲线上对应于阈值 $c$ 的点到机会线（对角线 $y=x$）的**最大[垂直距离](@entry_id:176279)**。因此，最大化尤登指数的阈值，就是使ROC曲线离机会线最远的点所对应的阈值，这通常被认为是一个在灵敏度和特异性之间取得良好平衡的点。

### 关键性质与理论基础

**单调变换的不变性**

ROC分析一个极其重要的性质是其对评分的**严格单调递增变换 (strictly increasing monotonic transformation)** 的不变性。这意味着，如果您将原始评分 $S$ 替换为一个新的评分 $S' = g(S)$，其中 $g$ 是一个严格递增函数（例如，$g(S) = \log(S)$ 或 $g(S) = aS+b$ 且 $a>0$），那么得到的ROC曲线将与原始的完全相同 [@problem_id:4918273] [@problem_id:4918280]。

其原理在于，[ROC曲线](@entry_id:182055)只依赖于样本评分的**排序 (ranking)**，而不依赖于评分的绝对值。一个严格递增的变换会改变评分的数值和间距，但不会改变任何两个样本评分之间的大小关系。如果原来 $s_i > s_j$，那么变换后一定有 $g(s_i) > g(s_j)$。因此，对于任何原始阈值 $c$，决策规则 $S > c$ 等价于新的决策规则 $S' > c'$，其中 $c' = g(c)$。这意味着对于新评分系统中的每一个阈值，都存在一个旧评分系统中的阈值，它们对所有样本的分类结果完全相同，从而产生相同的(FPR, TPR)点对。因此，所有可能的(FPR, TPR)点对集合，即[ROC曲线](@entry_id:182055)，保持不变 [@problem_id:4918280]。

这一性质非常有用，因为它意味着分类器的性能评估（就排序能力而言）不依赖于其输出评分的校准或尺度。

**[奈曼-皮尔逊引理](@entry_id:163022)与曲线形状**

ROC曲线的凹形（concave）外观并非偶然，它源于[统计决策理论](@entry_id:174152)的深刻结果——**[奈曼-皮尔逊引理](@entry_id:163022) (Neyman-Pearson Lemma)** [@problem_id:4918268]。该引理指出，在给定[假阳性率](@entry_id:636147)（即[第一类错误](@entry_id:163360)率）$\alpha$ 的上限时，要最大化[真阳性率](@entry_id:637442)（即检验的功效），最优的决策规则是基于**[似然比](@entry_id:170863) (Likelihood Ratio)** 进行阈值判断。

设 $p_1(s)$ 和 $p_0(s)$ 分别为阳性类别和阴性类别下评分 $s$ 的概率密度函数。似然比定义为 $LR(s) = p_1(s)/p_0(s)$。[奈曼-皮尔逊引理](@entry_id:163022)表明，最强大的检验具有“拒绝原假设（即判定为阳性）”的决策区域，该区域由 $LR(s) \ge \tau$ 的所有 $s$ 构成，其中 $\tau$ 是为满足FPR约束而选择的某个阈值。

通过改变[似然比](@entry_id:170863)的阈值 $\tau$ 从 $\infty$ 到 $0$，我们可以得到一系列最优的(FPR, TPR)点，这些点构成了**最优[ROC曲线](@entry_id:182055)**。这条曲线是所有可能的ROC曲线的上[包络线](@entry_id:174062)。一个关键的数学结论是，在对应于似然比阈值为 $\tau$ 的[ROC曲线](@entry_id:182055)点上，曲线的**斜率**恰好等于 $\tau$ [@problem_id:4918268]：
$$
\frac{d(\text{TPR})}{d(\text{FPR})} = \tau
$$
当我们沿着[ROC曲线](@entry_id:182055)从左上角移动到右下角时，FPR从0增加到1。这对应于将[似然比](@entry_id:170863)阈值 $\tau$ 从 $\infty$ 减小到 $0$。由于斜率等于 $\tau$，这意味着ROC曲线的斜率是单调递减的。一个斜率单调递减的函数，其图形是**凹的**。这就是最优[ROC曲线](@entry_id:182055)总是呈现为“向左上方凸出”的形状的原因。

此外，如果我们在两个由奈曼-皮尔逊检验产生的ROC点之间进行随机化（即以一定概率选择第一个检验的结果，以另一概率选择第二个检验的结果），那么得到的新的(FPR, TPR)点将位于连接这两个原始点的直线上。所有这些可能的随机化组合填充了最优[ROC曲线](@entry_id:182055)下方的区域，形成了所有可能检验性能点的[凸集](@entry_id:155617)，而最优ROC曲线本身正是这个[凸集](@entry_id:155617)的上边界 [@problem_id:4918268]。

### [参数化](@entry_id:265163)ROC模型：双正态模型

虽然经验[ROC曲线](@entry_id:182055)在实践中很有用，但它们可能是锯齿状的且依赖于特定样本。为了进行更平滑的分析和推断，我们可以使用**[参数化](@entry_id:265163)模型**来拟合ROC曲线。其中最著名和最广泛应用的是**双正态模型 (binormal model)**。

该模型假设阳性群体和阴性群体的评分都服从正态分布 [@problem_id:4604261]：
$$
S \mid Y=1 \sim \mathcal{N}(\mu_1, \sigma_1^2)
$$
$$
S \mid Y=0 \sim \mathcal{N}(\mu_0, \sigma_0^2)
$$
在这一假设下，我们可以推导出TPR和FPR之间的封闭函数关系。通过对两个群体的评分进行标准化，并消除阈值变量 $t$，可以证明 $\Phi^{-1}(\text{TPR})$ 与 $\Phi^{-1}(\text{FPR})$ 之间存在线性关系，其中 $\Phi$ 是标准正态分布的CDF，$\Phi^{-1}$ 是其[反函数](@entry_id:141256)（也称为probit函数）。最终，ROC曲线可以表示为 [@problem_id:4604261]：
$$
\text{TPR} = \Phi\left(a + b \cdot \Phi^{-1}(\text{FPR})\right)
$$
其中参数 $a$ 和 $b$ 完全由原始正态分布的均值和标准差决定：
$$
a = \frac{\mu_1 - \mu_0}{\sigma_1} \quad \text{且} \quad b = \frac{\sigma_0}{\sigma_1}
$$
参数 $a$ 代表以阳性群体标准差为单位的分布分离度，而参数 $b$ 是阴性群体与阳性群体标准差之比。当 $b=1$ 时（即两群体方差相等），[ROC曲线](@entry_id:182055)在probit-probit空间中是一条斜率为1的直线，此时曲线关于副对角线对称。这个模型不仅为[ROC曲线](@entry_id:182055)提供了一个简洁的数学形式，还允许我们通[过拟合](@entry_id:139093)经验数据来估计参数 $a$ 和 $b$，从而得到一条平滑的[ROC曲线](@entry_id:182055)并进行[统计推断](@entry_id:172747)。

### 实践考量与高级主题

**患病率与预测值**

ROC分析的一个核心优势是其**患病率无关性 (prevalence-independence)**。TPR和FPR的定义都是在特定真实类别（阳性或阴性）的条件下计算的，因此它们不依赖于这两个类别在总人口中的相对比例（即患病率或类别流行度 $\pi = \Pr(Y=1)$）。因此，ROC曲线和AUC作为分类器内在判别能力的度量，理论上在不同患病率的人群之间是可移植的 [@problem_id:4918301]。

然而，这与临床实践中非常重要的另一些指标形成了鲜明对比，例如**阳性预测值 (Positive Predictive Value, PPV)** 和**阴性预测值 (Negative Predictive Value, NPV)**。PPV定义为测试结果为阳性的个体确实患病的概率，即 $\text{PPV} = \Pr(Y=1 \mid D_c=1)$。根据[贝叶斯定理](@entry_id:151040)，PPV强烈依赖于患病率 $\pi$ [@problem_id:4918301]：
$$
\text{PPV} = \frac{\text{TPR} \cdot \pi}{\text{TPR} \cdot \pi + \text{FPR} \cdot (1-\pi)}
$$
这意味着，即使一个分类器具有固定的[ROC曲线](@entry_id:182055)（即固定的TPR和FPR组合），当它应用于患病率较低的人群时，其PPV也会显著下降。这一现象对于理解ROC分析的局限性至关重要。

**[类别不平衡](@entry_id:636658)与[精确率-召回率曲线](@entry_id:637864)**

在许多生物信息学应用中，例如罕见病筛查或药物[靶点识别](@entry_id:267563)，我们面临着极端的**类别不平衡 (class imbalance)** 问题，即阴性样本的数量远远超过阳性样本（$N \gg P$）。在这种情况下，[ROC曲线](@entry_id:182055)可能会产生误导性的乐观评估 [@problem_id:4604276]。

原因在于，当阴性样本[基数](@entry_id:754020)巨大时，即使是一个非常低的FPR，也可能导致大量的[假阳性](@entry_id:635878)样本。从PPV的公式可以看出，分母中的项 $\text{FPR} \cdot (1-\pi)$（或在计数中为 $FP = \text{FPR} \cdot N$）会因为巨大的 $N$ 而被放大。例如，在一个 $10^6$ 人的队列中，阳性病例有 $10^3$ 例（$\pi=0.001$）。一个分类器在FPR=0.001时，会产生 $0.001 \times 999,000 \approx 999$ 个[假阳性](@entry_id:635878)。如果此时TPR=0.9，则有900个[真阳性](@entry_id:637126)。其精确率（PPV）约为 $900/(900+999) \approx 0.47$。如果FPR仅略微增加到0.002，[假阳性](@entry_id:635878)数量就会翻倍到约1998个，而精确率会骤降至 $900/(900+1998) \approx 0.31$。在ROC图上，从FPR=0.001到0.002只是一个微小的、几乎看不见的移动，但在实际应用中，这对应着阳性预测可信度的大幅下降 [@problem_id:4604276]。

为了更好地在这种场景下评估模型，**精确率-召回率 (Precision-Recall, PR)** 曲线应运而生。P[R曲线](@entry_id:183670)以召回率（即TPR）为[横轴](@entry_id:177453)，以精确率（即PPV）为纵轴。由于精确率依赖于患病率，PR曲线本身是患病率相关的。在一个高度不平衡的问题中，一个无技能的随机分类器的PR曲线基线大约是一条水平线，其高度等于阳性类别的患病率 $\pi$。P[R曲线](@entry_id:183670)能更清晰地展示出分类器在识别稀有阳性类别方面的性能，尤其是与这一极低的基线相比的表现 [@problem_id:4604276]。

**谱系偏倚与模型可移植性**

虽然[ROC曲线](@entry_id:182055)对患病率不敏感，但它们对所谓的**谱系偏倚 (spectrum bias)** 却非常敏感。谱系偏倚指的是当分类器从一个群体（如训练集）应用到另一个群体（如评估集）时，由于病例的内在构成（或“谱系”）发生变化而导致的性能改变 [@problem_id:4604282]。

例如，一个用于疾病诊断的分类器可能在包含大量重症患者的专科医院环境中进行训练和验证，获得了很高的AUC。但当它被应用于社区筛查时，面对的是大量早期或轻症患者，其性能可能会显著下降。这是因为阳性群体 ($Y=1$) 的内部组成发生了变化。

我们可以用一个混合模型来说明这一点。假设阳性群体由 $w$ 比例的重症亚型和 $1-w$ 比例的轻症亚型组成，且重症患者的评分分布比轻症患者更能与健康人群分开。如果评估集中的重症比例 $w$ 高于训练集，那么阳性群体的整体评分分布 $p(S \mid Y=1)$ 就会向更高分值移动，从而使得在任何给定阈值下的TPR都增加。由于阴性群体的分布 $p(S \mid Y=0)$ 未变，FPR保持不变。结果是，评估集的[ROC曲线](@entry_id:182055)将整体上移，AUC也会相应增加 [@problem_id:4604282]。

谱系偏倚提醒我们，ROC曲线的“可移植性”是有条件的。它只在分类器所面对的阳性和阴性群体的评分分布本身保持不变时才成立。当病例的严重程度、亚型构成或共病情况等因素在不同应用场景中存在差异时，必须谨慎评估和重新校准分类器的性能。