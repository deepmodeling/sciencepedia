{"hands_on_practices": [{"introduction": "“朴素”的条件独立性假设是朴素贝叶斯分类器的核心，它以牺牲在特征相关时的准确性为代价换取了模型的简洁性。本练习提供了一个定量框架，用于评估当这一假设被违背时的后果——这在使用相互关联的生物标志物时是常见情况。通过计算后验几率中的乘性偏差 [@problem_id:4588292]，您将更深入地理解模型性能会如何受到影响，以及为何在实践中评估此假设至关重要。", "problem": "在生物信息学和医学数据分析的医学诊断背景下，考虑一个二元疾病指标 $D \\in \\{0,1\\}$，其中 $D=1$ 表示存在疾病，$D=0$ 表示不存在疾病。两个二元特征 $X_{1}$ 和 $X_{2}$ 源自基因表达阈值（当相应的生物标志物过表达时，每个特征等于 $1$，否则等于 $0$）。假设有以下科学上合理的数据：\n- 疾病患病率：$P(D=1)=0.02$ 和 $P(D=0)=0.98$。\n- 在患病（$D=1$）情况下，特征是正条件相关的，其边际概率为 $P(X_{1}=1 \\mid D=1)=0.70$ 和 $P(X_{2}=1 \\mid D=1)=0.60$，联合概率为 $P(X_{1}=1, X_{2}=1 \\mid D=1)=0.55$。这些值意味着 $P(X_{1}=1, X_{2}=0 \\mid D=1)=0.15$，$P(X_{1}=0, X_{2}=1 \\mid D=1)=0.05$，以及 $P(X_{1}=0, X_{2}=0 \\mid D=1)=0.25$，这与边际概率一致，并且表明了正条件依赖性，因为 $P(X_{1}=1, X_{2}=1 \\mid D=1)=0.55 > 0.70 \\times 0.60=0.42$。\n- 在不患病（$D=0$）情况下，特征是条件独立的，有 $P(X_{1}=1 \\mid D=0)=0.10$，$P(X_{2}=1 \\mid D=0)=0.15$，因此 $P(X_{1}=1, X_{2}=1 \\mid D=0)=0.10 \\times 0.15=0.015$。\n\n朴素贝叶斯（NB）分类器将 $X_{1}$ 和 $X_{2}$ 建模为在给定 $D$ 的条件下是条件独立的，因此对于任何 $d \\in \\{0,1\\}$，有\n$$\nP_{\\text{NB}}(X_{1}=x_{1}, X_{2}=x_{2} \\mid D=d) = P(X_{1}=x_{1} \\mid D=d)\\, P(X_{2}=x_{2} \\mid D=d).\n$$\n一个正确指定的相依模型使用真实的联合分布 $P(X_{1}, X_{2} \\mid D)$，而不作独立性假设。\n\n仅从贝叶斯定理和后验几率的定义出发，推导对于一个呈现 $X_{1}=1$ 和 $X_{2}=1$ 的患者，由朴素贝叶斯独立性假设引起的后验几率中的乘性偏差。将乘性偏差定义为\n$$\nB \\equiv \\frac{O_{\\text{NB}}(D=1 \\mid X_{1}=1, X_{2}=1)}{O_{\\text{true}}(D=1 \\mid X_{1}=1, X_{2}=1)},\n$$\n其中 $O(\\cdot)$ 表示后验几率。使用上述数据计算 $B$，并将最终结果表示为一个无量纲的小数。将答案四舍五入到四位有效数字。不要使用百分号。", "solution": "问题要求计算对于一个呈现特征 $X_{1}=1$ 和 $X_{2}=1$ 的患者，由朴素贝叶斯（NB）独立性假设引起的后验几率中的乘性偏差。偏差 $B$ 定义为由 NB 模型计算的后验几率与真实后验几率之比。设证据表示为 $X = (X_{1}=1, X_{2}=1)$。\n\n首先，我们建立后验几率的一般形式。在给定证据 $X$ 的条件下，患病（$D=1$）与不患病（$D=0$）的后验几率定义为：\n$$\nO(D=1 \\mid X) = \\frac{P(D=1 \\mid X)}{P(D=0 \\mid X)}\n$$\n通过将贝叶斯定理 $P(D=d \\mid X) = \\frac{P(X \\mid D=d)P(D=d)}{P(X)}$ 应用于分子和分母，我们得到：\n$$\nO(D=1 \\mid X) = \\frac{\\frac{P(X \\mid D=1)P(D=1)}{P(X)}}{\\frac{P(X \\mid D=0)P(D=0)}{P(X)}}\n$$\n证据的边际概率 $P(X)$ 被消掉，得到后验几率的表达式，即似然比与先验几率的乘积：\n$$\nO(D=1 \\mid X) = \\left(\\frac{P(X \\mid D=1)}{P(X \\mid D=0)}\\right) \\left(\\frac{P(D=1)}{P(D=0)}\\right)\n$$\n\n乘性偏差 $B$ 定义为：\n$$\nB \\equiv \\frac{O_{\\text{NB}}(D=1 \\mid X)}{O_{\\text{true}}(D=1 \\mid X)}\n$$\n其中 $O_{\\text{NB}}$ 是使用朴素贝叶斯假设计算的几率，而 $O_{\\text{true}}$ 是使用真实条件概率计算的几率。\n\n使用推导出的后验几率公式，我们可以写出真实几率和 NB 几率。设 $X$ 代表具体观测值 $(X_{1}=1, X_{2}=1)$。\n真实的后验几率是：\n$$\nO_{\\text{true}}(D=1 \\mid X) = \\frac{P(X_{1}=1, X_{2}=1 \\mid D=1)}{P(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}\n$$\n朴素贝叶斯后验几率是：\n$$\nO_{\\text{NB}}(D=1 \\mid X) = \\frac{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1)}{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}\n$$\n将这些表达式代入偏差 $B$ 的定义中：\n$$\nB = \\frac{\\frac{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1)}{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}}{\\frac{P(X_{1}=1, X_{2}=1 \\mid D=1)}{P(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}}\n$$\n先验几率项 $\\frac{P(D=1)}{P(D=0)}$ 被消掉了，留下一个似然比的比值：\n$$\nB = \\frac{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1)}{P(X_{1}=1, X_{2}=1 \\mid D=1)} \\times \\frac{P(X_{1}=1, X_{2}=1 \\mid D=0)}{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)}\n$$\n现在我们必须使用所提供的数据计算此表达式中的四个条件概率。\n\n1.  对于 $D=1$ 的真实条件概率：问题明确给出了相依特征的联合概率：\n    $$P(X_{1}=1, X_{2}=1 \\mid D=1) = 0.55$$\n\n2.  对于 $D=1$ 的朴素贝叶斯条件概率：NB 模型假设条件独立，使用给定的边际概率：\n    $$P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1) = P(X_{1}=1 \\mid D=1) P(X_{2}=1 \\mid D=1) = 0.70 \\times 0.60 = 0.42$$\n\n3.  对于 $D=0$ 的真实条件概率：问题指出，对于 $D=0$，特征是条件独立的。因此，真实的联合概率是边际概率的乘积：\n    $$P(X_{1}=1, X_{2}=1 \\mid D=0) = P(X_{1}=1 \\mid D=0) P(X_{2}=1 \\mid D=0) = 0.10 \\times 0.15 = 0.015$$\n\n4.  对于 $D=0$ 的朴素贝叶斯条件概率：NB 模型也假设条件独立：\n    $$P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0) = P(X_{1}=1 \\mid D=0) P(X_{2}=1 \\mid D=0) = 0.10 \\times 0.15 = 0.015$$\n\n由于对于 $D=0$ 类别，特征是真正条件独立的，因此 NB 假设成立，并且 $P(X_{1}=1, X_{2}=1 \\mid D=0) = P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)$。这两项的比值为 $1$。\n\n将这些值代入偏差 $B$ 的表达式中：\n$$\nB = \\frac{0.42}{0.55} \\times \\frac{0.015}{0.015} = \\frac{0.42}{0.55} \\times 1\n$$\n$$\nB = \\frac{0.42}{0.55}\n$$\n进行除法运算：\n$$\nB \\approx 0.76363636...\n$$\n按照要求将结果四舍五入到四位有效数字，我们得到：\n$$\nB \\approx 0.7636\n$$\n这个小于 $1$ 的偏差因子表明，朴素贝叶斯分类器低估了两种生物标志物均过表达患者的疾病后验几率，这是因为它未能考虑到患病人群中特征之间的正条件依赖性。", "answer": "$$\\boxed{0.7636}$$", "id": "4588292"}, {"introduction": "有效的参数估计至关重要，尤其是在处理来自罕见疾病或症状的稀疏数据时。本练习将最大似然 (ML) 估计——它可能受“零频问题”困扰——与贝叶斯最大后验 (MAP) 估计进行对比。通过一个涉及罕见症状的场景 [@problem_id:4588350]，您将看到如何通过 MAP 估计融合先验知识，从而提供一种强大的正则化技术，得出更稳健、更合理的概率估计。", "problem": "一家医院正在构建一个二元朴素贝叶斯分类器，用于诊断一种罕见疾病。该疾病由类别标签 $y \\in \\{0,1\\}$ 表示，其中 $y=1$ 表示存在疾病。该分类器使用单一的二元症状指示符 $x \\in \\{0,1\\}$，如果患者报告有特定症状，则 $x=1$。根据疾病登记处的数据，目标人群中的疾病患病率为 $p(y=1)=\\pi$，其中 $\\pi=0.005$。有一个小的已标记训练集可用：在 $n_{1}=4$ 名已知患病患者 ($y=1$) 中，有 $k_{1}=1$ 人报告了该症状 ($x=1$)；在 $n_{0}=6$ 名已知未患病的对照者 ($y=0$) 中，有 $k_{0}=0$ 人报告了该症状 ($x=1$)。\n\n令 $\\theta_{1}=p(x=1 \\mid y=1)$ 和 $\\theta_{0}=p(x=1 \\mid y=0)$。考虑两种估计策略：\n- 最大似然 (ML) 估计，仅使用观测到的计数。\n- 最大后验 (MAP) 估计，使用与临床知识一致的独立贝塔先验：$\\theta_{1} \\sim \\mathrm{Beta}(\\alpha_{1},\\beta_{1})$，其中 $\\alpha_{1}=2$, $\\beta_{1}=2$；以及 $\\theta_{0} \\sim \\mathrm{Beta}(\\alpha_{0},\\beta_{0})$，其中 $\\alpha_{0}=2$, $\\beta_{0}=198$。\n\n仅使用基本定义（在朴素贝叶斯建模假设下计算后验概率的贝叶斯定理，以及贝塔先验与伯努利似然的共轭性），计算在每种估计策略下，一个新出现症状（$x=1$）的患者患病的后验概率，即 $p_{\\mathrm{ML}}(y=1 \\mid x=1)$ 和 $p_{\\mathrm{MAP}}(y=1 \\mid x=1)$。然后通过差值量化后验概率的下游变化\n$$\\Delta \\equiv p_{\\mathrm{MAP}}(y=1 \\mid x=1) - p_{\\mathrm{ML}}(y=1 \\mid x=1)。$$\n报告 $\\Delta$ 的单一数值，四舍五入到四位有效数字。答案以纯小数形式表示（不带百分号）。", "solution": "本题要求在两种不同的朴素贝叶斯分类器参数估计方案下，计算和比较给定症状下的疾病后验概率 $p(y=1 \\mid x=1)$：最大似然 (ML) 估计和最大后验 (MAP) 估计。最终目标是计算这两种方法得到的后验概率之差 $\\Delta$。\n\n首先，我们使用贝叶斯定理建立后验概率的一般公式。朴素贝叶斯模型假设在给定类别 $y$ 的条件下，特征 $x$ 与其他特征是条件独立的。由于只有一个特征，这个假设是自然满足的。在出现症状 ($x=1$) 的条件下患有该疾病 ($y=1$) 的后验概率为：\n$$p(y=1 \\mid x=1) = \\frac{p(x=1 \\mid y=1) p(y=1)}{p(x=1)}$$\n分母 $p(x=1)$ 是证据的边缘概率，可以使用全概率定律展开：\n$$p(x=1) = p(x=1 \\mid y=1) p(y=1) + p(x=1 \\mid y=0) p(y=0)$$\n使用问题陈述中提供的符号：\n-   疾病患病率（疾病的先验概率）为 $p(y=1) = \\pi$。\n-   非患病状态的概率为 $p(y=0) = 1 - \\pi$。\n-   患病患者中出现症状的类条件概率为 $\\theta_1 = p(x=1 \\mid y=1)$。\n-   未患病患者中出现症状的类条件概率为 $\\theta_0 = p(x=1 \\mid y=0)$。\n\n将这些代入后验概率的公式中得到：\n$$p(y=1 \\mid x=1) = \\frac{\\theta_1 \\pi}{\\theta_1 \\pi + \\theta_0 (1-\\pi)}$$\n我们已知 $\\pi = 0.005$，所以 $1-\\pi = 0.995$。问题的核心在于使用 ML 和 MAP 方法估计参数 $\\theta_1$ 和 $\\theta_0$。\n\n**1. 最大似然 (ML) 估计**\n\n伯努利分布（我们的二元症状 $x$ 的模型）参数的 ML 估计就是成功事件的样本比例。\n-   对于患病组 ($y=1$)，在 $n_1=4$ 名患者中，有 $k_1=1$ 次出现该症状 ($x=1$)。$\\theta_1$ 的 ML 估计为：\n$$\\hat{\\theta}_{1, \\mathrm{ML}} = \\frac{k_1}{n_1} = \\frac{1}{4} = 0.25$$\n-   对于未患病组 ($y=0$)，在 $n_0=6$ 名患者中，有 $k_0=0$ 次出现该症状 ($x=1$)。$\\theta_0$ 的 ML 估计为：\n$$\\hat{\\theta}_{0, \\mathrm{ML}} = \\frac{k_0}{n_0} = \\frac{0}{6} = 0$$\n\n现在，我们使用这些 ML 估计值来计算后验概率 $p_{\\mathrm{ML}}(y=1 \\mid x=1)$：\n$$p_{\\mathrm{ML}}(y=1 \\mid x=1) = \\frac{\\hat{\\theta}_{1, \\mathrm{ML}} \\pi}{\\hat{\\theta}_{1, \\mathrm{ML}} \\pi + \\hat{\\theta}_{0, \\mathrm{ML}} (1-\\pi)} = \\frac{0.25 \\times 0.005}{0.25 \\times 0.005 + 0 \\times 0.995}$$\n$$p_{\\mathrm{ML}}(y=1 \\mid x=1) = \\frac{0.00125}{0.00125 + 0} = 1$$\n这个结果表明，在 ML 估计下，观察到该症状就保证了疾病的存在。这是零频率问题的直接后果：由于小型训练集中没有未患病者出现该症状，模型错误地学习到未患病者不可能有此症状。\n\n**2. 最大后验 (MAP) 估计**\n\nMAP 估计包含了关于参数的先验信念，这有助于对估计进行正则化，并避免像零频率这样的问题。问题指定了 $\\theta_1$ 和 $\\theta_0$ 的贝塔先验。贝塔分布是伯努利似然的共轭先验，这简化了后验分布的计算。\n\n对于一个具有 $\\mathrm{Beta}(\\alpha, \\beta)$ 先验的参数 $\\theta$，在 $n$ 次试验中观察到 $k$ 次成功后，其后验分布为 $\\mathrm{Beta}(k+\\alpha, n-k+\\beta)$。MAP 估计是此后验分布的众数。一个 $\\mathrm{Beta}(a,b)$ 分布（其中 $a, b > 1$）的众数由 $\\frac{a-1}{a+b-2}$ 给出。\n\n-   对于 $\\theta_1$，先验分布是 $\\mathrm{Beta}(\\alpha_1, \\beta_1)$，其中 $\\alpha_1=2, \\beta_1=2$。数据是 $k_1=1, n_1=4$。$\\theta_1$ 的后验分布为：\n$$\\theta_1 \\mid \\text{data} \\sim \\mathrm{Beta}(k_1+\\alpha_1, n_1-k_1+\\beta_1) = \\mathrm{Beta}(1+2, 4-1+2) = \\mathrm{Beta}(3, 5)$$\n由于后验分布的两个参数（$3$ 和 $5$）都大于 $1$，因此 MAP 估计即为众数：\n$$\\hat{\\theta}_{1, \\mathrm{MAP}} = \\frac{(k_1+\\alpha_1)-1}{(k_1+\\alpha_1) + (n_1-k_1+\\beta_1)-2} = \\frac{3-1}{3+5-2} = \\frac{2}{6} = \\frac{1}{3}$$\n-   对于 $\\theta_0$，先验分布是 $\\mathrm{Beta}(\\alpha_0, \\beta_0)$，其中 $\\alpha_0=2, \\beta_0=198$。数据是 $k_0=0, n_0=6$。$\\theta_0$ 的后验分布为：\n$$\\theta_0 \\mid \\text{data} \\sim \\mathrm{Beta}(k_0+\\alpha_0, n_0-k_0+\\beta_0) = \\mathrm{Beta}(0+2, 6-0+198) = \\mathrm{Beta}(2, 204)$$\n后验分布的参数（$2$ 和 $204$）也都大于 $1$。MAP 估计为：\n$$\\hat{\\theta}_{0, \\mathrm{MAP}} = \\frac{(k_0+\\alpha_0)-1}{(k_0+\\alpha_0) + (n_0-k_0+\\beta_0)-2} = \\frac{2-1}{2+204-2} = \\frac{1}{204}$$\n\n现在我们使用这些 MAP 估计值来计算后验概率 $p_{\\mathrm{MAP}}(y=1 \\mid x=1)$。我们使用参数的精确分数形式，以及 $\\pi = 0.005 = \\frac{1}{200}$ 和 $1-\\pi = 0.995 = \\frac{199}{200}$：\n$$p_{\\mathrm{MAP}}(y=1 \\mid x=1) = \\frac{\\hat{\\theta}_{1, \\mathrm{MAP}} \\pi}{\\hat{\\theta}_{1, \\mathrm{MAP}} \\pi + \\hat{\\theta}_{0, \\mathrm{MAP}} (1-\\pi)} = \\frac{\\frac{1}{3} \\times \\frac{1}{200}}{\\frac{1}{3} \\times \\frac{1}{200} + \\frac{1}{204} \\times \\frac{199}{200}}$$\n为了简化这个繁分数，我们可以从分子和分母的和的每一项中消去 $\\frac{1}{200}$ 项：\n$$p_{\\mathrm{MAP}}(y=1 \\mid x=1) = \\frac{\\frac{1}{3}}{\\frac{1}{3} + \\frac{199}{204}} = \\frac{\\frac{1}{3}}{\\frac{1 \\times 68}{3 \\times 68} + \\frac{199}{204}} = \\frac{\\frac{1}{3}}{\\frac{68}{204} + \\frac{199}{204}} = \\frac{\\frac{1}{3}}{\\frac{267}{204}}$$\n$$p_{\\mathrm{MAP}}(y=1 \\mid x=1) = \\frac{1}{3} \\times \\frac{204}{267} = \\frac{68}{267}$$\n\n**3. 量化变化**\n\n最后一步是计算差值 $\\Delta$：\n$$\\Delta = p_{\\mathrm{MAP}}(y=1 \\mid x=1) - p_{\\mathrm{ML}}(y=1 \\mid x=1)$$\n$$\\Delta = \\frac{68}{267} - 1 = \\frac{68 - 267}{267} = -\\frac{199}{267}$$\n为了提供数值答案，我们计算其小数值并四舍五入到四位有效数字：\n$$\\Delta = -\\frac{199}{267} \\approx -0.74531835...$$\n四舍五入到四位有效数字得到 $-0.7453$。这个显著的负差值凸显了 MAP 估计的强大正则化效应，它将后验概率从过度自信的 ML 模型产生的极端值 $1$ 拉了回来。", "answer": "$$\\boxed{-0.7453}$$", "id": "4588350"}, {"introduction": "现实世界的临床数据往往是不完美的，包含缺失值或删失 (censored) 的测量值（例如，低于检测下限）。一个稳健的模型必须恰当地处理这些数据，而非简单丢弃。这个高级练习 [@problem_id:4588331] 将指导您在朴素贝叶斯框架内，对左侧删失和缺失数据进行建模，这需要您基于累积分布函数构建似然函数。这项技能对于构建能最大限度利用现有信息的实用诊断模型至关重要。", "problem": "一家临床实验室使用朴素贝叶斯分类器，根据两种血清生物标志物 $X$ 和 $Y$ 来估计一种急性传染病的概率，该疾病由二元变量 $D \\in \\{1,0\\}$ 表示。该分类器假设在给定 $D$ 的条件下特征是条件独立的，并为每种生物标志物使用一个生成式测量模型。对于生物标志物 $X$，仪器存在检测限（LOD），这意味着报告的结果是左删失的：如果测量值 $M_X$ 低于仪器阈值 $L$，报告将返回分类事件“低于检测限”，而不是一个数值。$X$ 的测量过程被建模为一个未观测到的真实浓度 $X^{\\text{true}}$ 与一个独立的测量误差 $\\varepsilon_X$ 的和。在给定 $D=d$ 的条件下，真实浓度 $X^{\\text{true}}$ 服从均值为 $\\mu_{Xd}$、标准差为 $\\sigma_{Xd}$ 的高斯分布，而独立的测量误差 $\\varepsilon_X$ 服从均值为 $0$、标准差为 $\\tau_X$ 的高斯分布。该患者的生物标志物 $Y$ 缺失，其缺失机制是完全随机缺失（MCAR），且独立于 $D$ 和所有其他变量。\n\n对于疾病类别 $D=1$（患病）和 $D=0$（未患病），生物标志物 $X$ 的生成参数如下：\n- $D=1$：$\\mu_{X1} = 1.25$，$\\sigma_{X1} = 0.4$，\n- $D=0$：$\\mu_{X0} = 0.6$，$\\sigma_{X0} = 0.4$，\n在两个类别中，$X$ 的测量误差均为 $\\tau_X = 0.3$。检测限为 $L = 0.5$。先验概率为 $P(D=1) = 0.12$ 和 $P(D=0) = 0.88$。\n\n对于某位特定患者，$X$ 的实验室报告为“低于检测限”，即 $M_X \\le L$，且生物标志物 $Y$ 缺失。使用上述假设的朴素贝叶斯模型，计算后验概率 $P(D=1 \\mid M_X \\le L, \\text{ $Y$ missing})$。将最终答案表示为 $0$ 和 $1$ 之间的小数，并四舍五入到四位有效数字。无需单位。", "solution": "目标是根据两种生物标志物提供的证据，计算疾病存在（$D=1$）的后验概率。证据（表示为 $E$）包括以下观察结果：生物标志物 $X$ 的测量值 $M_X$ 低于检测限 $L$，并且生物标志物 $Y$ 的测量值缺失。因此，我们需要计算 $P(D=1 \\mid E)$，其中 $E = \\{M_X \\le L, \\text{ $Y$ missing}\\}$。\n\n我们从贝叶斯定理开始：\n$$\nP(D=1 \\mid E) = \\frac{P(E \\mid D=1) P(D=1)}{P(E)}\n$$\n分母 $P(E)$ 是证据的边际似然，可以通过使用全概率定律对疾病状态 $D$ 进行边缘化来计算：\n$$\nP(E) = P(E \\mid D=1) P(D=1) + P(E \\mid D=0) P(D=0)\n$$\n将此代入贝叶斯定理表达式，得到：\n$$\nP(D=1 \\mid E) = \\frac{P(E \\mid D=1) P(D=1)}{P(E \\mid D=1) P(D=1) + P(E \\mid D=0) P(D=0)}\n$$\n问题陈述，朴素贝叶斯分类器假设在给定疾病状态 $D$ 的条件下，特征（生物标志物 $X$ 和 $Y$）是条件独立的。因此，组合证据 $E$ 的似然可以分解为：\n$$\nP(E \\mid D=d) = P(M_X \\le L, \\text{ $Y$ missing} \\mid D=d) = P(M_X \\le L \\mid D=d) \\cdot P(\\text{$Y$ missing} \\mid D=d)\n$$\n对于 $d \\in \\{0, 1\\}$。\n\n问题还指出，生物标志物 $Y$ 的缺失机制是完全随机缺失（MCAR），并且独立于 $D$。这意味着无论疾病状态如何，$Y$ 缺失的概率是相同的：\n$$\nP(\\text{$Y$ missing} \\mid D=1) = P(\\text{$Y$ missing} \\mid D=0) = c\n$$\n其中 $c$ 是某个常数概率。\n\n让我们将此代入后验概率的表达式中：\n$$\nP(D=1 \\mid E) = \\frac{P(M_X \\le L \\mid D=1) \\cdot c \\cdot P(D=1)}{P(M_X \\le L \\mid D=1) \\cdot c \\cdot P(D=1) + P(M_X \\le L \\mid D=0) \\cdot c \\cdot P(D=0)}\n$$\n常数因子 $c$ 同时出现在分子和分母的每一项中，因此可以被消去。这表明，在 MCAR 假设下，缺失的生物标志物 $Y$ 对区分 $D=1$ 和 $D=0$ 不提供任何信息，后验概率完全由生物标志物 $X$ 的证据决定。问题简化为计算：\n$$\nP(D=1 \\mid M_X \\le L) = \\frac{P(M_X \\le L \\mid D=1) P(D=1)}{P(M_X \\le L \\mid D=1) P(D=1) + P(M_X \\le L \\mid D=0) P(D=0)}\n$$\n下一步是确定似然项 $P(M_X \\le L \\mid D=d)$。测量值 $M_X$ 被建模为真实浓度 $X^{\\text{true}}$ 和一个独立的测量误差 $\\varepsilon_X$ 的和：$M_X = X^{\\text{true}} + \\varepsilon_X$。\n在给定疾病状态 $D=d$ 的条件下，我们已知以下分布：\n-   $X^{\\text{true}} \\mid (D=d) \\sim \\mathcal{N}(\\mu_{Xd}, \\sigma_{Xd}^2)$\n-   $\\varepsilon_X \\sim \\mathcal{N}(0, \\tau_X^2)$\n\n由于 $X^{\\text{true}}$ 和 $\\varepsilon_X$ 是独立的高斯随机变量，它们的和 $M_X$ 也是一个高斯随机变量。\n在给定 $D=d$ 的条件下，$M_X$ 的均值是各均值之和：\n$$\nE[M_X \\mid D=d] = E[X^{\\text{true}} \\mid D=d] + E[\\varepsilon_X] = \\mu_{Xd} + 0 = \\mu_{Xd}\n$$\n在给定 $D=d$ 的条件下，$M_X$ 的方差是各方差之和（由于独立性）：\n$$\n\\text{Var}(M_X \\mid D=d) = \\text{Var}(X^{\\text{true}} \\mid D=d) + \\text{Var}(\\varepsilon_X) = \\sigma_{Xd}^2 + \\tau_X^2\n$$\n令 $\\Sigma_{Xd}^2 = \\sigma_{Xd}^2 + \\tau_X^2$ 为在给定 $D=d$ 条件下测量值 $M_X$ 的方差。因此，$M_X \\mid (D=d) \\sim \\mathcal{N}(\\mu_{Xd}, \\Sigma_{Xd}^2)$。\n\n现在我们可以计算 $d=1$ 和 $d=0$ 时的似然。\n对于 $D=1$：\n-   $\\mu_{X1} = 1.25$\n-   $\\sigma_{X1} = 0.4$\n-   $\\tau_X = 0.3$\n方差为 $\\Sigma_{X1}^2 = \\sigma_{X1}^2 + \\tau_X^2 = (0.4)^2 + (0.3)^2 = 0.16 + 0.09 = 0.25$。\n标准差为 $\\Sigma_{X1} = \\sqrt{0.25} = 0.5$。\n所以，$M_X \\mid (D=1) \\sim \\mathcal{N}(1.25, 0.5^2)$。\n\n对于 $D=0$：\n-   $\\mu_{X0} = 0.6$\n-   $\\sigma_{X0} = 0.4$\n-   $\\tau_X = 0.3$\n方差为 $\\Sigma_{X0}^2 = \\sigma_{X0}^2 + \\tau_X^2 = (0.4)^2 + (0.3)^2 = 0.16 + 0.09 = 0.25$。\n标准差为 $\\Sigma_{X0} = \\sqrt{0.25} = 0.5$。\n所以，$M_X \\mid (D=0) \\sim \\mathcal{N}(0.6, 0.5^2)$。\n\n似然 $P(M_X \\le L \\mid D=d)$ 是相应高斯分布在 $L=0.5$ 处的累积分布函数（CDF）的值。设 $\\Phi(z)$ 表示标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数。通过对变量进行标准化，我们得到：\n$$\nP(M_X \\le L \\mid D=d) = \\Phi\\left(\\frac{L - \\mu_{Xd}}{\\Sigma_{Xd}}\\right)\n$$\n对于 $D=1$：\n$$\nP(M_X \\le 0.5 \\mid D=1) = \\Phi\\left(\\frac{0.5 - 1.25}{0.5}\\right) = \\Phi\\left(\\frac{-0.75}{0.5}\\right) = \\Phi(-1.5)\n$$\n对于 $D=0$：\n$$\nP(M_X \\le 0.5 \\mid D=0) = \\Phi\\left(\\frac{0.5 - 0.6}{0.5}\\right) = \\Phi\\left(\\frac{-0.1}{0.5}\\right) = \\Phi(-0.2)\n$$\n给定的先验概率为 $P(D=1) = 0.12$ 和 $P(D=0) = 0.88$。\n现在我们将这些部分代入后验概率公式中：\n$$\nP(D=1 \\mid M_X \\le 0.5) = \\frac{\\Phi(-1.5) \\cdot P(D=1)}{\\Phi(-1.5) \\cdot P(D=1) + \\Phi(-0.2) \\cdot P(D=0)}\n$$\n$$\nP(D=1 \\mid M_X \\le 0.5) = \\frac{\\Phi(-1.5) \\cdot 0.12}{\\Phi(-1.5) \\cdot 0.12 + \\Phi(-0.2) \\cdot 0.88}\n$$\n使用标准正态累积分布函数的值：\n-   $\\Phi(-1.5) \\approx 0.0668072$\n-   $\\Phi(-0.2) \\approx 0.4207403$\n\n现在，我们计算数值结果：\n分子：$0.0668072 \\times 0.12 = 0.008016864$\n分母第1项：$0.008016864$\n分母第2项：$0.4207403 \\times 0.88 = 0.370251464$\n分母总计：$0.008016864 + 0.370251464 = 0.378268328$\n后验概率：\n$$\nP(D=1 \\mid M_X \\le 0.5) = \\frac{0.008016864}{0.378268328} \\approx 0.02119293\n$$\n问题要求将答案四舍五入到四位有效数字。值为 $0.02119293...$。前四位有效数字是 $2、1、1、9$。第五位有效数字是 $2$，小于 $5$，因此向下舍入。\n最终结果是 $0.02119$。", "answer": "$$\\boxed{0.02119}$$", "id": "4588331"}]}