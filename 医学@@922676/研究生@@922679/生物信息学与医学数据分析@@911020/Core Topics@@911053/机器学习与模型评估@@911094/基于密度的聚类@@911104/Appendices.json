{"hands_on_practices": [{"introduction": "在应用任何基于距离的聚类算法（如DBSCAN）之前，一个至关重要的预处理步骤是特征缩放。本练习将通过第一性原理推导，量化展示Z-score标准化如何平衡不同生物标志物的贡献，从而防止具有较大变异性的特征主导距离计算，这是确保在多维生物数据空间中进行无偏密度估计的基础。[@problem_id:4555248]", "problem": "您正在一项转化肿瘤学研究中，使用基于噪声应用的密度空间聚类 (DBSCAN) 对患者资料进行聚类。每位患者由一个包含 $d$ 个定量生物标志物的向量表示，构成一个随机向量 $X \\in \\mathbb{R}^{d}$。这些生物标志物具有不同的物理单位和动态范围。您怀疑若不进行标准化，变异性较大的特征可能会主导成对距离，从而使 DBSCAN 用来定义其 $\\varepsilon$-邻域的密度估计产生偏差。\n\n假设存在以下数据生成模型：患者资料独立同分布于 $X \\sim \\mathcal{N}(\\mu, \\Sigma)$，其中协方差矩阵 $\\Sigma \\in \\mathbb{R}^{d \\times d}$ 为满秩，均值 $\\mu \\in \\mathbb{R}^{d}$ 未知。考虑从该分布中抽取的两位独立患者 $X$ 和 $Y$。DBSCAN 使用患者之间的欧几里得距离。\n\n您决定通过 z-score 对每个生物标志物进行标准化：定义对角缩放矩阵 $D = \\mathrm{diag}(\\sigma_{1}, \\dots, \\sigma_{d})$，其中 $\\sigma_{i}^{2}$ 是生物标志物 $i$ 的方差，即 $\\Sigma$ 的第 $i$ 个对角元素。定义标准化向量 $Z = D^{-1}(X - \\mu)$，使得每个坐标的方差均为单位方差。令 $R = D^{-1}\\Sigma D^{-1}$ 表示相关矩阵。\n\n仅使用欧几里得距离、协方差的定义以及独立多元正态变量的基本性质（不调用任何关于距离分布的现成公式），完成以下任务：\n\n1.  推导标准化前两位独立患者之间欧几里得距离平方的期望和方差，即，用 $\\Sigma$ 表示 $\\mathbb{E}\\big[\\|X - Y\\|_{2}^{2}\\big]$ 和 $\\mathrm{Var}\\big(\\|X - Y\\|_{2}^{2}\\big)$ 的表达式。\n\n2.  推导经过 z-score 标准化后两位独立患者之间欧几里得距离平方的期望和方差，即，用 $R$ 表示 $\\mathbb{E}\\big[\\|Z_{X} - Z_{Y}\\|_{2}^{2}\\big]$ 和 $\\mathrm{Var}\\big(\\|Z_{X} - Z_{Y}\\|_{2}^{2}\\big)$ 的表达式。\n\n3.  基于您的结果，从基本原理出发解释为什么 z-score 标准化可以减轻成对距离中的尺度主导性（DBSCAN 使用成对距离来估计点密度），以及这如何影响邻域半径 $\\varepsilon$ 在不同数据集或研究间的选择和可迁移性。\n\n提供以下比率的单个闭式解析表达式作为您的最终答案：\n$$\n\\rho \\;=\\; \\frac{\\mathbb{E}\\big[\\|X - Y\\|_{2}^{2}\\big]}{\\mathbb{E}\\big[\\|Z_{X} - Z_{Y}\\|_{2}^{2}\\big]}\n$$\n该表达式仅用生物标志物的方差 $\\sigma_{1}^{2}, \\dots, \\sigma_{d}^{2}$ 来表示。最终答案不需要数值近似，并且由于该比率是无量纲的，因此不需要单位。您的推理必须基于给定的假设和定义得到充分证明。最终答案必须是单个解析表达式。", "solution": "在进行求解之前，首先评估问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- 患者资料由一个包含 $d$ 个定量生物标志物的随机向量 $X \\in \\mathbb{R}^{d}$ 表示。\n- 患者资料独立同分布 (i.i.d.) 于 $X \\sim \\mathcal{N}(\\mu, \\Sigma)$，其中 $\\mu \\in \\mathbb{R}^{d}$ 是未知均值，$\\Sigma \\in \\mathbb{R}^{d \\times d}$ 是一个满秩协方差矩阵。\n- $X$ 和 $Y$ 是从该分布中抽取的两位独立患者的资料。\n- DBSCAN 使用欧几里得距离 $\\|X - Y\\|_{2}$。\n- 对角缩放矩阵为 $D = \\mathrm{diag}(\\sigma_{1}, \\dots, \\sigma_{d})$，其中 $\\sigma_{i}^{2} = \\Sigma_{ii}$ 是第 $i$ 个生物标志物的方差。\n- 标准化向量定义为 $Z = D^{-1}(X - \\mu)$。令 $Z_X = D^{-1}(X - \\mu)$ 和 $Z_Y = D^{-1}(Y - \\mu)$。\n- 相关矩阵为 $R = D^{-1}\\Sigma D^{-1}$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **科学上合理：** 该问题牢固地植根于多元统计学及其在生物信息学和机器学习（DBSCAN）中一个常见数据预处理步骤（标准化）的应用。多元正态分布的使用是一个标准且基本的模型。所有定义都是线性代数和概率论中的标准定义。\n- **定义明确：** 该问题提供了一个清晰的概率模型，并要求推导特定的统计量（期望和方差）以及进行概念性解释。输入信息足以推导出唯一且有意义的解。\n- **客观性：** 语言精确、正式，没有主观或基于观点的论断。\n\n该问题没有表现出任何诸如科学上不成立、信息缺失或歧义等缺陷。假设是自洽且一致的。例如，满秩协方差矩阵 $\\Sigma$ 意味着所有对角元素 $\\sigma_i^2$ 都严格为正，这确保了缩放矩阵 $D$ 是可逆的。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将按要求从第一性原理推导解答。\n\n***\n\n### 求解推导\n\n设 $X, Y \\in \\mathbb{R}^{d}$ 是从分布 $\\mathcal{N}(\\mu, \\Sigma)$ 中抽取的两个独立随机向量。我们关心它们之间欧几里得距离平方的性质。我们定义一个新的随机向量 $W = X - Y$。\n\n由于 $X$ 和 $Y$ 是独立的正态分布，它们的差 $W$ 也是正态分布的。\n$W$ 的期望是：\n$$\n\\mathbb{E}[W] = \\mathbb{E}[X - Y] = \\mathbb{E}[X] - \\mathbb{E}[Y] = \\mu - \\mu = 0\n$$\n由于 $X$ 和 $Y$ 的独立性，$W$ 的协方差矩阵是：\n$$\n\\mathrm{Cov}(W) = \\mathrm{Cov}(X - Y) = \\mathrm{Cov}(X) + \\mathrm{Cov}(-Y) = \\mathrm{Cov}(X) + (-1)^2 \\mathrm{Cov}(Y) = \\Sigma + \\Sigma = 2\\Sigma\n$$\n因此，差向量 $W$ 服从一个中心化的多元正态分布：$W \\sim \\mathcal{N}(0, 2\\Sigma)$。\n\n欧几里得距离的平方为 $\\|X - Y\\|_{2}^{2} = W^{T}W = \\sum_{i=1}^{d} W_{i}^{2}$，其中 $W_i$ 是向量 $W$ 的分量。\n\n#### 1. 标准化前距离的统计量\n\n我们推导 $\\|X-Y\\|_2^2$ 的期望和方差。\n\n**期望：**\n欧几里得距离平方的期望是该向量协方差矩阵的迹。\n$$\n\\mathbb{E}\\big[\\|X - Y\\|_{2}^{2}\\big] = \\mathbb{E}[W^{T}W]\n$$\n利用期望的线性和方差的定义：\n$$\n\\mathbb{E}[W_i^2] = \\mathrm{Var}(W_i) + (\\mathbb{E}[W_i])^2\n$$\n因为 $\\mathbb{E}[W] = 0$，所以对于所有 $i \\in \\{1, \\dots, d\\}$，我们有 $\\mathbb{E}[W_i] = 0$。$W$ 的第 $i$ 个分量的方差是其协方差矩阵 $\\mathrm{Cov}(W) = 2\\Sigma$ 的第 $i$ 个对角元素。\n$$\n\\mathrm{Var}(W_i) = (2\\Sigma)_{ii} = 2\\Sigma_{ii} = 2\\sigma_{i}^{2}\n$$\n因此，$\\mathbb{E}[W_i^2] = 2\\sigma_i^2$。\n和的期望等于期望的和：\n$$\n\\mathbb{E}\\big[\\|X - Y\\|_{2}^{2}\\big] = \\mathbb{E}\\left[\\sum_{i=1}^{d} W_{i}^{2}\\right] = \\sum_{i=1}^{d} \\mathbb{E}[W_{i}^{2}] = \\sum_{i=1}^{d} 2\\sigma_{i}^{2} = 2\\sum_{i=1}^{d} \\sigma_{i}^{2}\n$$\n这也可以用迹算子表示：$\\mathbb{E}\\big[\\|X - Y\\|_{2}^{2}\\big] = 2\\mathrm{tr}(\\Sigma)$。\n\n**方差：**\n欧几里得距离平方的方差是 $\\mathrm{Var}\\big(\\|X - Y\\|_{2}^{2}\\big) = \\mathrm{Var}(W^{T}W)$。这个计算需要 $W$ 各分量的四阶矩。对于一个中心化的多元正态向量，Isserlis 定理给出了四阶矩 $\\mathbb{E}[W_i W_j W_k W_l]$ 与二阶矩（协方差）的关系。设 $\\Gamma = \\mathrm{Cov}(W) = 2\\Sigma$。\n对于 $\\mathbb{E}[W_i^2 W_j^2]$，该定理给出：\n$$\n\\mathbb{E}[W_i^2 W_j^2] = \\mathbb{E}[W_i^2]\\mathbb{E}[W_j^2] + 2(\\mathbb{E}[W_i W_j])^2 = \\Gamma_{ii}\\Gamma_{jj} + 2\\Gamma_{ij}^2\n$$\n方差为 $\\mathrm{Var}(W^{T}W) = \\mathbb{E}[(W^{T}W)^2] - (\\mathbb{E}[W^{T}W])^2$。\n$$\n\\mathbb{E}[(W^{T}W)^2] = \\mathbb{E}\\left[\\left(\\sum_{i=1}^{d} W_i^2\\right)^2\\right] = \\sum_{i=1}^{d}\\sum_{j=1}^{d} \\mathbb{E}[W_i^2 W_j^2] = \\sum_{i,j} (\\Gamma_{ii}\\Gamma_{jj} + 2\\Gamma_{ij}^2)\n$$\n$$\n= \\left(\\sum_i \\Gamma_{ii}\\right)\\left(\\sum_j \\Gamma_{jj}\\right) + 2\\sum_{i,j} \\Gamma_{ij}^2 = (\\mathrm{tr}(\\Gamma))^2 + 2\\mathrm{tr}(\\Gamma^2)\n$$\n项 $\\sum_{i,j} \\Gamma_{ij}^2 = \\sum_{i,j} \\Gamma_{ij}\\Gamma_{ji}$ 是 $\\mathrm{tr}(\\Gamma^2)$ 的定义。\n因为 $\\mathbb{E}[W^TW] = \\mathrm{tr}(\\Gamma)$，我们有：\n$$\n\\mathrm{Var}(W^{T}W) = ((\\mathrm{tr}(\\Gamma))^2 + 2\\mathrm{tr}(\\Gamma^2)) - (\\mathrm{tr}(\\Gamma))^2 = 2\\mathrm{tr}(\\Gamma^2)\n$$\n代入 $\\Gamma = 2\\Sigma$：\n$$\n\\mathrm{Var}\\big(\\|X - Y\\|_{2}^{2}\\big) = 2\\mathrm{tr}((2\\Sigma)^2) = 2\\mathrm{tr}(4\\Sigma^2) = 8\\mathrm{tr}(\\Sigma^2)\n$$\n\n#### 2. 标准化后距离的统计量\n\n设 $Z_X = D^{-1}(X - \\mu)$ 和 $Z_Y = D^{-1}(Y - \\mu)$。\n这些是独立同分布的随机向量。它们的分布是正态的。\n$$\n\\mathbb{E}[Z_X] = D^{-1}(\\mathbb{E}[X] - \\mu) = D^{-1}(\\mu - \\mu) = 0\n$$\n$$\n\\mathrm{Cov}(Z_X) = \\mathrm{Cov}(D^{-1}X) = D^{-1}\\mathrm{Cov}(X)(D^{-1})^T = D^{-1}\\Sigma D^{-1} = R\n$$\n因此，$Z_X, Z_Y \\sim \\mathcal{N}(0, R)$。相关矩阵 $R$ 的对角元素为 $R_{ii} = (D^{-1}\\Sigma D^{-1})_{ii} = \\frac{1}{\\sigma_i}\\Sigma_{ii}\\frac{1}{\\sigma_i} = \\frac{\\sigma_i^2}{\\sigma_i^2} = 1$。\n\n设差值为 $W_Z = Z_X - Z_Y$。可以得出 $W_Z \\sim \\mathcal{N}(0, 2R)$。\n现在问题的形式与第1部分相同，只是将 $\\Sigma$ 替换为 $R$。我们可以直接应用推导出的公式。\n\n**期望：**\n$$\n\\mathbb{E}\\big[\\|Z_X - Z_Y\\|_{2}^{2}\\big] = \\mathrm{tr}(\\mathrm{Cov}(W_Z)) = \\mathrm{tr}(2R) = 2\\mathrm{tr}(R)\n$$\n相关矩阵的迹是其对角元素之和，而这些对角元素都为1。\n$$\n\\mathrm{tr}(R) = \\sum_{i=1}^{d} R_{ii} = \\sum_{i=1}^{d} 1 = d\n$$\n因此：\n$$\n\\mathbb{E}\\big[\\|Z_X - Z_Y\\|_{2}^{2}\\big] = 2d\n$$\n\n**方差：**\n使用方差公式并代入 $\\Gamma = 2R$：\n$$\n\\mathrm{Var}\\big(\\|Z_X - Z_Y\\|_{2}^{2}\\big) = 2\\mathrm{tr}((2R)^2) = 8\\mathrm{tr}(R^2)\n$$\n\n#### 3. 关于减轻尺度主导性的解释\n\n根据第1部分，标准化前成对距离平方的期望是 $\\mathbb{E}\\big[\\|X - Y\\|_{2}^{2}\\big] = 2\\sum_{i=1}^{d} \\sigma_{i}^{2}$。这个总期望值是每个生物标志物贡献的总和，其中第 $i$ 个生物标志物的贡献是 $2\\sigma_i^2$。如果某个生物标志物（比如第 $j$ 个）的方差 $\\sigma_j^2$ 比其他标志物大几个数量级，那么它的项 $2\\sigma_j^2$ 将会主导这个和。因此，欧几里得距离几乎完全变成了沿这单个高方差特征的差异度量。DBSCAN算法基于距离阈值 $\\varepsilon$ 来定义邻域，这样实际上它将会在数据的一维投影上进行聚类，而忽略了其他 $d-1$ 个生物标志物中可能包含的丰富信息。\n\n根据第2部分，z-score标准化后成对距离平方的期望是 $\\mathbb{E}\\big[\\|Z_X - Z_Y\\|_{2}^{2}\\big] = 2d$。该值仅取决于特征的数量 $d$。每个标准化生物标志物对这个总和的期望贡献是 $\\mathbb{E}[(Z_{X,i} - Z_{Y,i})^2] = \\mathrm{Var}(Z_{X,i} - Z_{Y,i}) = \\mathrm{Var}(Z_{X,i}) + \\mathrm{Var}(Z_{Y,i}) = 1 + 1 = 2$。通过标准化，我们强制每个生物标志物对距离平方的期望贡献相同。这种均等的权重防止了任何单个特征因其原始尺度或变异性而主导距离度量。聚类继而基于点在整个 $d$ 维空间中的几何排列。\n\n邻域半径 $\\varepsilon$ 的选择对DBSCAN至关重要。在标准化之前，一个合适的 $\\varepsilon$ 大约在 $\\sqrt{2\\sum \\sigma_i^2}$ 的数量级。这个值对给定数据集中生物标志物的具体方差高度敏感。如果一项新研究使用不同的测量仪器或不同的患者队列，$\\sigma_i^2$ 的值可能会发生巨大变化，从而使原始的 $\\varepsilon$ 值失效。该参数将不具有可迁移性。标准化之后，一个合适的 $\\varepsilon$ 大约在 $\\sqrt{2d}$ 的数量级。这个尺度仅取决于特征空间的维度 $d$，而不取决于单个特征的方差。这使得 $\\varepsilon$ 的选择更加稳健，其值在具有相同数量生物标志物的不同数据集或研究之间更具可比性和可迁移性。\n\n#### 比率 $\\rho$ 的最终计算\n\n问题要求计算比率 $\\rho = \\frac{\\mathbb{E}\\big[\\|X - Y\\|_{2}^{2}\\big]}{\\mathbb{E}\\big[\\|Z_{X} - Z_{Y}\\|_{2}^{2}\\big]}$。\n使用上面推导出的期望值：\n$$\n\\rho = \\frac{2\\sum_{i=1}^{d} \\sigma_{i}^{2}}{2d} = \\frac{\\sum_{i=1}^{d} \\sigma_{i}^{2}}{d}\n$$\n这个表达式是生物标志物方差的算术平均值。", "answer": "$$\n\\boxed{\\frac{1}{d} \\sum_{i=1}^{d} \\sigma_{i}^{2}}\n$$", "id": "4555248"}, {"introduction": "DBSCAN的性能关键取决于其两个核心参数 $\\epsilon$ 和 $\\mathrm{MinPts}$ 的选择。这个练习提供了一个“微观”视角，通过分析一个孤立的、由七个细胞组成的微簇，让您精确计算出决定该簇被识别或被标记为噪声的关键参数阈值。通过这个练习，您将深刻理解DBSCAN如何根据局部密度定义一个“簇”，以及参数选择不当如何导致对稀有细胞亚群的漏检。[@problem_id:4555299]", "problem": "在一个由均匀流形近似与投影（UMAP）生成的单细胞基因表达嵌入中，一个小而稀有的细胞亚群将使用基于密度的噪声应用空间聚类（DBSCAN）进行聚类。该嵌入是二维的，并使用标准的欧几里得度量。考虑以下由七个点组成的孤立微簇：一个中心点位于坐标 $(0,0)$，以及六个均匀分布在单位圆上的周围点，角度分别为 $0$, $\\pi/3$, $2\\pi/3$, $\\pi$, $4\\pi/3$ 和 $5\\pi/3$。形式上，该微簇是集合\n$$\n\\mathcal{C}=\\left\\{(0,0)\\right\\}\\cup\\left\\{(\\cos(k\\pi/3),\\sin(k\\pi/3)):\\;k\\in\\{0,1,2,3,4,5\\}\\right\\}.\n$$\n数据集中的所有其他细胞与 $\\mathcal{C}$ 中每个点的欧几里得距离都严格大于 $5$，这确保了在任何邻域半径 $\\epsilon\\leq 2$ 的情况下，该微簇都是孤立的。DBSCAN由两个参数定义：邻域半径 $\\epsilon0$ 和最小点数 $\\mathrm{MinPts}\\in\\mathbb{N}$。对于任何点 $p$，其 $\\epsilon$-邻域是\n$$\nN_{\\epsilon}(p)=\\left\\{q:\\;\\|q-p\\|_2\\leq\\epsilon\\right\\},\n$$\n如果 $|N_{\\epsilon}(p)|\\geq \\mathrm{MinPts}$，则点 $p$ 是一个核心点。簇的成员资格由从核心点出发的密度可达性确定；如果一个集合不包含任何核心点，DBSCAN 会将该集合中的所有点标记为噪声。\n\n根据上述DBSCAN的定义，推导出一个包含 $n$ 个点的孤立密集微簇因选择过小的 $\\epsilon$ 和过大的 $\\mathrm{MinPts}$而被标记为噪声的一般条件。然后，对于上面指定的具体微簇 $\\mathcal{C}$，计算以下两个阈值：\n\n1. 当 $\\mathrm{MinPts}=5$ 时，确定精确的临界邻域半径 $\\epsilon_{\\mathrm{crit}}$，其定义为使得 $\\mathcal{C}$ 中至少有一个点成为核心点的 $\\epsilon$ 的下确界；对于任何 $\\epsilon\\epsilon_{\\mathrm{crit}}$，整个微簇都被标记为噪声。\n\n2. 将 $\\epsilon$ 限制在区间 $[0,2]$ 内以保持与数据集中其余部分的隔离，确定最小整数阈值 $\\mathrm{MinPts}_{\\mathrm{crit}}$，使得对于每一个 $\\epsilon\\in[0,2]$，$\\mathcal{C}$ 中都没有点是核心点；对于任何 $\\mathrm{MinPts}\\geq \\mathrm{MinPts}_{\\mathrm{crit}}$，在整个 $\\epsilon$ 范围内，整个微簇都被标记为噪声。\n\n将你的最终答案报告为一个单行矩阵，按顺序包含 $\\epsilon_{\\mathrm{crit}}$ 和 $\\mathrm{MinPts}_{\\mathrm{crit}}$。不需要单位。不需要四舍五入。", "solution": "问题要求为应用于一个已定义的点微簇 $\\mathcal{C}$ 的DBSCAN算法提供两个具体参数。首先，我们推导出一个孤立微簇被分类为噪声的一般条件。然后，我们为具体的点集 $\\mathcal{C}$ 计算临界参数。\n\n一个一般的孤立微簇（我们称之为 $S$）包含 $n$ 个点。根据提供的DBSCAN定义，如果整个簇 $S$ 不包含任何核心点，它将被标记为噪声。如果点 $p \\in S$ 的 $\\epsilon$-邻域至少包含 $\\mathrm{MinPts}$ 个点，则该点为核心点。由于簇 $S$ 是孤立的，任何 $p \\in S$ 的邻居也必须来自 $S$。因此，$p$ 成为核心点的条件是 $|N_{\\epsilon}(p) \\cap S| \\geq \\mathrm{MinPts}$。\n\n要使整个簇 $S$ 被标记为噪声，这个条件必须对每个点 $p \\in S$ 都不成立。也就是说，对于所有 $p \\in S$，我们必须有 $|N_{\\epsilon}(p) \\cap S|  \\mathrm{MinPts}$。这等价于，对于给定的 $\\epsilon$，$\\mathrm{MinPts}$ 必须严格大于簇内发现的最大邻域的大小：\n$$\n\\mathrm{MinPts}  \\max_{p \\in S} |N_{\\epsilon}(p) \\cap S|\n$$\n这个不等式展示了较小的半径 $\\epsilon$（这会减小最大邻域的大小）和较大的最小点数要求 $\\mathrm{MinPts}$ 如何导致所有点被分类为噪声。\n\n现在，我们分析由 $n=7$ 个点组成的具体微簇 $\\mathcal{C}$。点集为 $\\mathcal{C} = \\{P_c\\} \\cup \\{P'_k\\}_{k=0}^5$，其中 $P_c = (0,0)$ 是中心点，而 $P'_k = (\\cos(k\\pi/3), \\sin(k\\pi/3))$ (对于 $k \\in \\{0, 1, 2, 3, 4, 5\\}$) 是单位圆上的六个点。\n\n为了确定邻域大小，我们必须计算 $\\mathcal{C}$ 中各点之间的成对欧几里得距离。由于该配置的旋转对称性，我们只需要计算从两个代表性点出发的距离：中心点 $P_c$ 和任意一个外围点，例如 $P'_0 = (1,0)$。\n\n1.  **从中心点 $P_c = (0,0)$ 出发的距离：**\n    从 $P_c$ 到任何外围点 $P'_k$ 的距离是：\n    $$\n    \\|P'_k - P_c\\|_2 = \\sqrt{\\cos^2(k\\pi/3) + \\sin^2(k\\pi/3)} = 1\n    $$\n    因此，所有 $6$ 个外围点与中心的距离都为 $1$。\n\n2.  **从外围点 $P'_0 = (1,0)$ 出发的距离：**\n    -   到中心点 $P_c$ 的距离：$\\|P_c - P'_0\\|_2 = \\|(0,0) - (1,0)\\|_2 = 1$。\n    -   到其他外围点 $P'_k$ ($k \\neq 0$) 的距离：这些是内接于单位圆的正六边形的弦长。\n        -   到 $P'_1 = (\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$ 和 $P'_5 = (\\frac{1}{2}, -\\frac{\\sqrt{3}}{2})$：\n            $\\|P'_1 - P'_0\\|_2 = \\sqrt{(\\frac{1}{2}-1)^2 + (\\frac{\\sqrt{3}}{2}-0)^2} = \\sqrt{\\frac{1}{4} + \\frac{3}{4}} = 1$。\n        -   到 $P'_2 = (-\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$ 和 $P'_4 = (-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2})$：\n            $\\|P'_2 - P'_0\\|_2 = \\sqrt{(-\\frac{1}{2}-1)^2 + (\\frac{\\sqrt{3}}{2}-0)^2} = \\sqrt{\\frac{9}{4} + \\frac{3}{4}} = \\sqrt{3}$。\n        -   到 $P'_3 = (-1,0)$：\n            $\\|P'_3 - P'_0\\|_2 = \\sqrt{(-1-1)^2 + (0-0)^2} = \\sqrt{4} = 2$。\n\n从 $\\mathcal{C}$ 中任意一点到 $\\mathcal{C}$ 中其他点的不同非零距离为 $1$、$\\sqrt{3}$ 和 $2$。\n\n我们将 $M(p, \\epsilon) = |N_{\\epsilon}(p) \\cap \\mathcal{C}|$ 定义为 $p$ 在 $\\mathcal{C}$ 内邻域中的点的数量。\n\n-   **对于中心点 $P_c$**：\n    -   如果 $\\epsilon  1$，只有 $P_c$ 本身在邻域内。$M(P_c, \\epsilon) = 1$。\n    -   如果 $\\epsilon \\geq 1$，$P_c$ 和所有 $6$ 个外围点都包含在内。$M(P_c, \\epsilon) = 7$。\n\n-   **对于任意外围点 $P'_k$**（根据对称性，我们使用 $P'_0$）：\n    -   如果 $\\epsilon  1$，只有 $P'_k$ 在其邻域内。$M(P'_k, \\epsilon) = 1$。\n    -   如果 $1 \\leq \\epsilon  \\sqrt{3}$，该点本身（1个）、中心点（1个）和两个相邻的外围点（2个）被包含在内。$M(P'_k, \\epsilon) = 1+1+2 = 4$。\n    -   如果 $\\sqrt{3} \\leq \\epsilon  2$，之前的 $4$ 个点加上距离为 $\\sqrt{3}$ 的两个点被包含在内。$M(P'_k, \\epsilon) = 4+2 = 6$。\n    -   如果 $\\epsilon \\geq 2$，$\\mathcal{C}$ 中的所有 $7$ 个点都被包含在内。$M(P'_k, \\epsilon) = 7$。\n\n有了这些信息，我们就可以解决问题的两个部分了。\n\n**1. 计算当 $\\mathrm{MinPts}=5$ 时的 $\\epsilon_{\\mathrm{crit}}$**\n我们需要找到下确界 $\\epsilon$，使得在 $\\mathrm{MinPts}=5$ 的条件下，$\\mathcal{C}$ 中至少有一个点成为核心点。如果 $M(p, \\epsilon) \\geq 5$，点 $p$ 就是一个核心点。\n\n-   对于 $P_c$：当 $M(P_c, \\epsilon) = 7$ 时，条件 $M(P_c, \\epsilon) \\geq 5$ 得到满足，这发生在 $\\epsilon \\geq 1$ 的情况下。\n-   对于任何 $P'_k$：当 $M(P'_k, \\epsilon)$ 至少为 $6$ 时，条件 $M(P'_k, \\epsilon) \\geq 5$ 得到满足，这发生在 $\\epsilon \\geq \\sqrt{3}$ 的情况下。\n\n在 $\\epsilon$ 上任何点成为核心点的第一个时刻是这两个阈值的最小值：$\\min(1, \\sqrt{3}) = 1$。设 $S$ 为存在至少一个核心点的 $\\epsilon$ 值的集合。根据我们的分析，$S = [1, \\infty)$。这个集合的下确界是 $1$。\n因此，临界邻域半径为 $\\epsilon_{\\mathrm{crit}} = 1$。\n\n**2. 计算当 $\\epsilon \\in [0,2]$ 时的 $\\mathrm{MinPts}_{\\mathrm{crit}}$**\n我们寻求最小整数 $\\mathrm{MinPts}_{\\mathrm{crit}}$，使得对于任何 $\\mathrm{MinPts} \\geq \\mathrm{MinPts}_{\\mathrm{crit}}$，在区间 $[0,2]$ 内的任何 $\\epsilon$ 值下，$\\mathcal{C}$ 中都没有点是核心点。这意味着对于 $\\mathrm{MinPts} = \\mathrm{MinPts}_{\\mathrm{crit}}$，我们必须对所有 $p \\in \\mathcal{C}$ 和所有 $\\epsilon \\in [0,2]$ 都有 $M(p, \\epsilon)  \\mathrm{MinPts}_{\\mathrm{crit}}$。这等价于找到满足以下条件的最小整数 $\\mathrm{MinPts}_{\\mathrm{crit}}$：\n$$\n\\mathrm{MinPts}_{\\mathrm{crit}}  \\max_{p \\in \\mathcal{C}, \\epsilon \\in [0,2]} M(p, \\epsilon)\n$$\n我们需要找到当 $\\epsilon$ 被限制在 $[0,2]$ 时，$\\mathcal{C}$ 中任意点的最大可能邻域大小。\n\n-   对于 $P_c$：在区间 $\\epsilon \\in [0,2]$ 中，$M(P_c, \\epsilon)$ 的最大值出现在任何 $\\epsilon \\in [1,2]$ 处，此时 $M(P_c, \\epsilon) = 7$。\n-   对于任何 $P'_k$：在区间 $\\epsilon \\in [0,2]$ 中，$M(P'_k, \\epsilon)$ 的最大值出现在 $\\epsilon = 2$ 处，此时 $M(P'_k, 2) = 7$。\n\n在给定范围内的总体最大邻域大小为 $7$。\n$$\n\\max_{p \\in \\mathcal{C}, \\epsilon \\in [0,2]} M(p, \\epsilon) = 7\n$$\n条件变为 $\\mathrm{MinPts}_{\\mathrm{crit}}  7$。由于 $\\mathrm{MinPts}$ 必须是整数（$\\mathrm{MinPts} \\in \\mathbb{N}$），满足这个严格不等式的 $\\mathrm{MinPts}_{\\mathrm{crit}}$ 的最小整数值是 $8$。确实，如果 $\\mathrm{MinPts}=8$，那么任何点都永远不能成为核心点，因为任何邻域中可能的最大点数是 $7$。\n因此，最小整数阈值为 $\\mathrm{MinPts}_{\\mathrm{crit}} = 8$。\n\n最终答案结合了这两个结果。\n$\\epsilon_{\\mathrm{crit}} = 1$。\n$\\mathrm{MinPts}_{\\mathrm{crit}} = 8$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  8 \\end{pmatrix}}\n$$", "id": "4555299"}]}