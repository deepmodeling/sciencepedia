{"hands_on_practices": [{"introduction": "独立成分分析（ICA）的一个关键预处理步骤是“白化”，它能简化后续的源分离任务。这个过程通过线性变换去除数据中的二阶统计相关性（即协方差），使得变换后的数据协方差矩阵变为单位矩阵。本练习 [@problem_id:4572813] 将引导您从第一性原理出发，通过对一个给定的协方差矩阵进行谱分解，亲手推导出主成分分析（PCA）白化矩阵，从而为理解ICA的计算流程奠定坚实的数学基础。", "problem": "在许多生物信息学分析流程中，执行独立成分分析 (ICA) 以分离潜在的生物源之前，会使用主成分分析 (PCA) 进行预白化。考虑一个来自两个潜在生物过程的混合基因表达强度的 $2$ 维均值中心化数据集。其经验样本协方差为\n$$\n\\hat{\\Sigma} = \\begin{pmatrix}4  2 \\\\ 2  3\\end{pmatrix}.\n$$\n仅从协方差的定义、实对称矩阵的谱定理以及“白化变换是将协方差矩阵映射到单位矩阵的线性映射”这一要求出发，推导 PCA 白化矩阵 $W$ 和白化后的协方差 $C_{\\text{white}}$。你的最终答案必须以精确的根式形式表示，不得进行数值近似。请以单个行矩阵的形式提供最终答案，并按顺序罗列其元素 $\\big(W_{11}, W_{12}, W_{21}, W_{22}, C_{\\text{white},11}, C_{\\text{white},12}, C_{\\text{white},21}, C_{\\text{white},22}\\big)$。无需四舍五入。", "solution": "此问题经核实，科学上成立、定义明确、客观且完整。这是一个应用于数据分析的线性代数中的标准问题，具体来说是主成分分析 (PCA) 白化。我们可以开始推导。\n\n设原始的 $2$ 维均值中心化数据向量表示为 $\\mathbf{x} \\in \\mathbb{R}^2$。经验样本协方差矩阵给定为 $\\hat{\\Sigma} = E[\\mathbf{x}\\mathbf{x}^T] = \\begin{pmatrix}4  2 \\\\ 2  3\\end{pmatrix}$。白化变换是一个线性映射 $\\mathbf{y} = W\\mathbf{x}$，它使得变换后数据 $\\mathbf{y}$ 的协方差为单位矩阵 $I$。$\\mathbf{y}$ 的协方差由下式给出：\n$$\nC_{\\mathbf{y}} = E[\\mathbf{y}\\mathbf{y}^T] = E[(W\\mathbf{x})(W\\mathbf{x})^T] = E[W\\mathbf{x}\\mathbf{x}^T W^T] = W E[\\mathbf{x}\\mathbf{x}^T] W^T = W \\hat{\\Sigma} W^T\n$$\n问题要求我们找到白化矩阵 $W$ 使得 $W \\hat{\\Sigma} W^T = I$。根据这个定义，得到的白化协方差矩阵是 $C_{\\text{white}} = I = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}$。\n\n为了找到 $W$，我们使用实对称矩阵 $\\hat{\\Sigma}$ 的谱定理。该定理指出 $\\hat{\\Sigma}$ 可以被其特征向量构成的正交矩阵 $U$ 对角化：\n$$\n\\hat{\\Sigma} = U \\Lambda U^T\n$$\n其中 $U$ 是一个正交矩阵（$U^T U = U U^T = I$），其列是 $\\hat{\\Sigma}$ 的归一化特征向量，而 $\\Lambda$ 是一个包含相应特征值的对角矩阵。\n\nPCA 白化矩阵 $W$ 定义为 $W = \\Lambda^{-1/2} U^T$。让我们验证这个 $W$ 的选择满足白化条件：\n$$\nW \\hat{\\Sigma} W^T = (\\Lambda^{-1/2} U^T) (U \\Lambda U^T) (\\Lambda^{-1/2} U^T)^T = \\Lambda^{-1/2} (U^T U) \\Lambda (U^T U) (\\Lambda^{-1/2})^T\n$$\n因为 $U^T U = I$ 且 $\\Lambda^{-1/2}$ 是对角矩阵，因此也是对称的，所以 $(\\Lambda^{-1/2})^T = \\Lambda^{-1/2}$。\n$$\nW \\hat{\\Sigma} W^T = \\Lambda^{-1/2} I \\Lambda I \\Lambda^{-1/2} = \\Lambda^{-1/2} \\Lambda \\Lambda^{-1/2} = \\Lambda^{1/2} \\Lambda^{-1/2} = I\n$$\n该条件得到满足。我们现在的任务是计算 $\\hat{\\Sigma}$ 的特征值和特征向量。\n\n首先，我们通过求解特征方程 $\\det(\\hat{\\Sigma} - \\lambda I) = 0$ 来找到特征值。\n$$\n\\det \\begin{pmatrix} 4-\\lambda  2 \\\\ 2  3-\\lambda \\end{pmatrix} = (4-\\lambda)(3-\\lambda) - (2)(2) = \\lambda^2 - 7\\lambda + 12 - 4 = \\lambda^2 - 7\\lambda + 8 = 0\n$$\n使用二次求根公式，特征值 $\\lambda$ 为：\n$$\n\\lambda = \\frac{-(-7) \\pm \\sqrt{(-7)^2 - 4(1)(8)}}{2(1)} = \\frac{7 \\pm \\sqrt{49 - 32}}{2} = \\frac{7 \\pm \\sqrt{17}}{2}\n$$\n设较大的特征值为 $\\lambda_1 = \\frac{7 + \\sqrt{17}}{2}$，较小的为 $\\lambda_2 = \\frac{7 - \\sqrt{17}}{2}$。特征值矩阵为 $\\Lambda = \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix}$。\n\n接下来，我们通过求解 $(\\hat{\\Sigma} - \\lambda I)\\mathbf{v} = \\mathbf{0}$ 来找到对应的特征向量 $\\mathbf{v}$。对于一个特征向量 $\\mathbf{v} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$，方程的第一行是 $(4-\\lambda)x + 2y = 0$。这意味着我们可以选择一个与 $\\begin{pmatrix} 2 \\\\ -(4-\\lambda) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ \\lambda-4 \\end{pmatrix}$ 成比例的特征向量。\n\n对于 $\\lambda_1 = \\frac{7 + \\sqrt{17}}{2}$，未归一化的特征向量 $\\mathbf{v}_1$ 是：\n$$\n\\mathbf{v}_1 = \\begin{pmatrix} 2 \\\\ \\lambda_1 - 4 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ \\frac{7 + \\sqrt{17}}{2} - 4 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ \\frac{\\sqrt{17}-1}{2} \\end{pmatrix}\n$$\n$\\mathbf{v}_1$ 的范数平方是 $\\|\\mathbf{v}_1\\|^2 = 2^2 + \\left(\\frac{\\sqrt{17}-1}{2}\\right)^2 = 4 + \\frac{17 - 2\\sqrt{17} + 1}{4} = 4 + \\frac{18 - 2\\sqrt{17}}{4} = \\frac{16 + 18 - 2\\sqrt{17}}{4} = \\frac{34 - 2\\sqrt{17}}{4} = \\frac{17-\\sqrt{17}}{2}$。\n归一化特征向量 $\\mathbf{u}_1$ 是 $\\frac{\\mathbf{v}_1}{\\|\\mathbf{v}_1\\|}$。\n\n对于 $\\lambda_2 = \\frac{7 - \\sqrt{17}}{2}$，未归一化的特征向量 $\\mathbf{v}_2$ 是：\n$$\n\\mathbf{v}_2 = \\begin{pmatrix} 2 \\\\ \\lambda_2 - 4 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ \\frac{7 - \\sqrt{17}}{2} - 4 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ \\frac{-1 - \\sqrt{17}}{2} \\end{pmatrix}\n$$\n$\\mathbf{v}_2$ 的范数平方是 $\\|\\mathbf{v}_2\\|^2 = 2^2 + \\left(\\frac{-1 - \\sqrt{17}}{2}\\right)^2 = 4 + \\frac{1 + 2\\sqrt{17} + 17}{4} = 4 + \\frac{18 + 2\\sqrt{17}}{4} = \\frac{16 + 18 + 2\\sqrt{17}}{4} = \\frac{34 + 2\\sqrt{17}}{4} = \\frac{17+\\sqrt{17}}{2}$。\n归一化特征向量 $\\mathbf{u}_2$ 是 $\\frac{\\mathbf{v}_2}{\\|\\mathbf{v}_2\\|}$。\n\n矩阵 $U$ 以 $\\mathbf{u}_1$ 和 $\\mathbf{u}_2$ 为其列。矩阵 $U^T$ 以归一化的特征向量为其行：\n$$\nU^T = \\begin{pmatrix} \\mathbf{u}_1^T \\\\ \\mathbf{u}_2^T \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\|\\mathbf{v}_1\\|} \\begin{pmatrix} 2  \\frac{\\sqrt{17}-1}{2} \\end{pmatrix} \\\\ \\frac{1}{\\|\\mathbf{v}_2\\|} \\begin{pmatrix} 2  \\frac{-1-\\sqrt{17}}{2} \\end{pmatrix} \\end{pmatrix}\n$$\n对角矩阵 $\\Lambda^{-1/2}$ 是：\n$$\n\\Lambda^{-1/2} = \\begin{pmatrix} 1/\\sqrt{\\lambda_1}  0 \\\\ 0  1/\\sqrt{\\lambda_2} \\end{pmatrix}\n$$\n现在我们计算白化矩阵 $W = \\Lambda^{-1/2} U^T$：\n$$\nW = \\begin{pmatrix} \\frac{1}{\\sqrt{\\lambda_1}} \\frac{1}{\\|\\mathbf{v}_1\\|} \\begin{pmatrix} 2  \\frac{\\sqrt{17}-1}{2} \\end{pmatrix} \\\\ \\frac{1}{\\sqrt{\\lambda_2}} \\frac{1}{\\|\\mathbf{v}_2\\|} \\begin{pmatrix} 2  \\frac{-1-\\sqrt{17}}{2} \\end{pmatrix} \\end{pmatrix}\n$$\n我们来计算 $W$ 的分量。\n$W_{11} = \\frac{2}{\\sqrt{\\lambda_1}\\|\\mathbf{v}_1\\|} = \\frac{2}{\\sqrt{\\lambda_1 \\|\\mathbf{v}_1\\|^2}} = \\frac{2}{\\sqrt{(\\frac{7+\\sqrt{17}}{2})(\\frac{17-\\sqrt{17}}{2})}} = \\frac{2}{\\sqrt{\\frac{119 - 7\\sqrt{17} + 17\\sqrt{17} - 17}{4}}} = \\frac{2}{\\sqrt{\\frac{102+10\\sqrt{17}}{4}}} = \\frac{4}{\\sqrt{102+10\\sqrt{17}}} = \\frac{4\\sqrt{2}}{\\sqrt{2(102+10\\sqrt{17})}}$。让我们换种方式简化。\n$W_{11} = \\frac{2}{\\sqrt{\\frac{51+5\\sqrt{17}}{2}}} = \\frac{2\\sqrt{2}}{\\sqrt{51+5\\sqrt{17}}}$。\n\n$W_{12} = \\frac{(\\sqrt{17}-1)/2}{\\sqrt{\\lambda_1}\\|\\mathbf{v}_1\\|} = \\frac{(\\sqrt{17}-1)/2}{\\sqrt{\\frac{51+5\\sqrt{17}}{2}}} = \\frac{(\\sqrt{17}-1)\\sqrt{2}}{2\\sqrt{51+5\\sqrt{17}}}$。\n\n$W_{21} = \\frac{2}{\\sqrt{\\lambda_2}\\|\\mathbf{v}_2\\|} = \\frac{2}{\\sqrt{\\lambda_2 \\|\\mathbf{v}_2\\|^2}} = \\frac{2}{\\sqrt{(\\frac{7-\\sqrt{17}}{2})(\\frac{17+\\sqrt{17}}{2})}} = \\frac{2}{\\sqrt{\\frac{119 + 7\\sqrt{17} - 17\\sqrt{17} - 17}{4}}} = \\frac{2}{\\sqrt{\\frac{102-10\\sqrt{17}}{4}}} = \\frac{4}{\\sqrt{102-10\\sqrt{17}}}$。\n$W_{21} = \\frac{2}{\\sqrt{\\frac{51-5\\sqrt{17}}{2}}} = \\frac{2\\sqrt{2}}{\\sqrt{51-5\\sqrt{17}}}$。\n\n$W_{22} = \\frac{(-1-\\sqrt{17})/2}{\\sqrt{\\lambda_2}\\|\\mathbf{v}_2\\|} = \\frac{-(\\sqrt{17}+1)/2}{\\sqrt{\\frac{51-5\\sqrt{17}}{2}}} = \\frac{-(\\sqrt{17}+1)\\sqrt{2}}{2\\sqrt{51-5\\sqrt{17}}}$。\n\n因此，PCA 白化矩阵 $W$ 是：\n$$\nW = \\begin{pmatrix} \\frac{2\\sqrt{2}}{\\sqrt{51+5\\sqrt{17}}}  \\frac{(\\sqrt{17}-1)\\sqrt{2}}{2\\sqrt{51+5\\sqrt{17}}} \\\\ \\frac{2\\sqrt{2}}{\\sqrt{51-5\\sqrt{17}}}  \\frac{-(\\sqrt{17}+1)\\sqrt{2}}{2\\sqrt{51-5\\sqrt{17}}} \\end{pmatrix}\n$$\n根据白化变换的定义，白化协方差矩阵 $C_{\\text{white}}$ 是单位矩阵：\n$$\nC_{\\text{white}} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n问题要求提供一个按顺序列出 $W$ 和 $C_{\\text{white}}$ 元素的单行矩阵。\n这些元素是 $W_{11}$、$W_{12}$、$W_{21}$、$W_{22}$、$C_{\\text{white},11}=1$、$C_{\\text{white},12}=0$、$C_{\\text{white},21}=0$、$C_{\\text{white},22}=1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\sqrt{2}}{\\sqrt{51+5\\sqrt{17}}}  \\frac{(\\sqrt{17}-1)\\sqrt{2}}{2\\sqrt{51+5\\sqrt{17}}}  \\frac{2\\sqrt{2}}{\\sqrt{51-5\\sqrt{17}}}  \\frac{-(\\sqrt{17}+1)\\sqrt{2}}{2\\sqrt{51-5\\sqrt{17}}}  1  0  0  1 \\end{pmatrix}}\n$$", "id": "4572813"}, {"introduction": "在数据经过白化处理后，独立成分分析的核心任务便是通过寻找一个旋转变换，来最大化投影数据的非高斯性，从而分离出原始的独立信源。这个练习 [@problem_id:4572820] 以一个简化的脑电图（EEG）信号去噪场景为例，让您运用FastICA算法的逻辑，从混合信号中分离出具有超高斯分布特性的眨眼伪迹。通过这个实践，您将深入理解从白化空间到原始信号空间的完整解混过程。", "problem": "脑电图（EEG）记录通常包含眼动伪迹，这些伪迹由于容积传导会同时出现在多个通道中。考虑一个通过独立成分分析（ICA）建模的双通道EEG混合信号，其中观测信号向量为 $X(t) \\in \\mathbb{R}^{2}$，它由两个统计独立的源信号 $S(t) \\in \\mathbb{R}^{2}$ 线性混合而成，其中一个源是眨眼伪迹，另一个是背景神经活动。假设源信号是中心化的，并且具有单位方差。混合过程遵循 $X(t) = A S(t)$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是一个固定的满秩混合矩阵。\n\n假设眨眼伪迹是第一个源，并且是具有正超额峰度的超高斯分布，而背景神经源近似为高斯分布，其超额峰度接近于零。混合矩阵明确给出为\n$$\nA = \\begin{pmatrix}\n\\sqrt{2}  -\\frac{1}{\\sqrt{2}} \\\\\n\\sqrt{2}  \\phantom{-}\\frac{1}{\\sqrt{2}}\n\\end{pmatrix},\n$$\n这对应于一个 $45^{\\circ}$ 的旋转，随后对眨眼成分在两个通道中进行更强的缩放。\n\n你将应用快速独立成分分析（FastICA），采用单单元（one-unit）方法和三次非线性来恢复眨眼成分。在以下科学标准假设下进行：\n- 由于源信号具有单位方差且相互独立，$X(t)$ 的协方差等于 $A A^{\\top}$。\n- 使用理论白化矩阵 $P = \\Sigma_{x}^{-1/2}$ 进行白化，其中 $\\Sigma_{x} = \\mathbb{E}[X X^{\\top}] = A A^{\\top}$，使得 $Z(t) = P X(t)$ 满足 $\\mathbb{E}[Z Z^{\\top}] = I$。\n- FastICA的对比度函数基于使用三次非线性最大化非高斯性，并且收敛到白化空间中的一个单位范数解混向量，该向量与对应于具有非零超额峰度源的正交混合矩阵的列对齐。\n\n从线性混合、白化、独立性和非高斯性的定义出发，推导白化变换、白化混合以及FastICA不动点特征，以在白化域中识别眨眼成分。然后将得到的单位解混向量映射回原始的、未白化的域，以获得解混权重向量 $c \\in \\mathbb{R}^{2}$，使得恢复的眨眼时间序列为 $\\hat{s}_{\\text{blink}}(t) = c^{\\top} X(t)$。\n\n将最终的解混权重向量 $c$ 表示为一个包含有理根式的精确双元素行矩阵。无需四舍五入。", "solution": "用户希望我解决一个在脑电图（EEG）数据背景下与独立成分分析（ICA）相关的问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **线性混合模型**：观测信号向量 $X(t) \\in \\mathbb{R}^{2}$ 是两个统计独立的源信号 $S(t) \\in \\mathbb{R}^{2}$ 的线性混合，由 $X(t) = A S(t)$ 给出。\n*   **混合矩阵**：$A = \\begin{pmatrix} \\sqrt{2}  -1/\\sqrt{2} \\\\ \\sqrt{2}  1/\\sqrt{2} \\end{pmatrix}$。该矩阵被指定为满秩。\n*   **源属性**：\n    *   源信号 $S(t) = [s_1(t), s_2(t)]^{\\top}$ 是中心化的、统计独立的，并具有单位方差。这意味着 $\\mathbb{E}[S] = 0$ 且 $\\mathbb{E}[S S^{\\top}] = I$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n    *   $s_1(t)$ 是一个具有正超额峰度的超高斯眨眼伪迹。\n    *   $s_2(t)$ 是一个超额峰度接近零的高斯神经源。\n*   **协方差**：观测信号的协方差是 $\\Sigma_{x} = \\mathbb{E}[X X^{\\top}] = A A^{\\top}$。\n*   **白化**：使用矩阵 $P = \\Sigma_{x}^{-1/2}$ 进行白化，产生白化信号 $Z(t) = P X(t)$，使得 $\\mathbb{E}[Z Z^{\\top}] = I$。\n*   **算法**：使用带有单单元方法和三次非线性的FastICA算法来恢复眨眼成分。假设该算法收敛到白化空间中对应于超高斯源的单位范数解混向量。\n*   **目标**：推导解混权重向量 $c \\in \\mathbb{R}^{2}$，使得恢复的眨眼时间序列为 $\\hat{s}_{\\text{blink}}(t) = c^{\\top} X(t)$，并将其表示为一个双元素行矩阵。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题是ICA在生物医学信号处理（EEG伪迹去除）中的一个标准且成熟的应用。线性混合、源独立性、非高斯性、白化和FastICA算法等概念都是该领域的基础。将眨眼伪迹描述为超高斯也是标准做法。该问题在科学上是合理的。\n*   **适定性**：该问题提供了所有必要信息：混合矩阵、源的统计属性以及具体的分析流程（白化后跟FastICA）。混合矩阵 $A$ 是满秩的（其行列式为 $(\\sqrt{2})(1/\\sqrt{2}) - (-1/\\sqrt{2})(\\sqrt{2}) = 1 - (-1) = 2 \\neq 0$），确保问题是可逆的。目标定义明确。该问题是适定的。\n*   **客观性**：该问题以精确、数学化和客观的术语陈述，没有歧义或主观内容。\n\n**步骤3：结论与行动**\n\n该问题是有效的。它在科学上是合理的、适定的和客观的。将提供一个完整的、有理有据的解决方案。\n\n### 解题过程\n\n找到解混向量 $c$ 的过程包括三个主要阶段：1) 对观测数据 $X(t)$ 进行白化，2) 在白化空间中识别与眨眼源对应的解混向量，3) 将此向量变换回原始数据空间。\n\n**1. 推导白化变换**\n\n首先，我们计算观测信号 $X(t)$ 的协方差矩阵 $\\Sigma_x$。鉴于源信号具有单位方差且不相关，$\\mathbb{E}[S S^{\\top}] = I$。\n$$\n\\Sigma_x = \\mathbb{E}[X X^{\\top}] = A \\mathbb{E}[S S^{\\top}] A^{\\top} = A A^{\\top}\n$$\n使用给定的混合矩阵 $A$：\n$$\nA = \\begin{pmatrix} \\sqrt{2}  -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n协方差矩阵为：\n$$\n\\Sigma_x = \\begin{pmatrix} \\sqrt{2}  -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} \\sqrt{2}  \\sqrt{2} \\\\ -\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\end{pmatrix} = \\begin{pmatrix} (\\sqrt{2})^2 + (-\\frac{1}{\\sqrt{2}})^2  (\\sqrt{2})^2 - (\\frac{1}{\\sqrt{2}})^2 \\\\ (\\sqrt{2})^2 - (\\frac{1}{\\sqrt{2}})^2  (\\sqrt{2})^2 + (\\frac{1}{\\sqrt{2}})^2 \\end{pmatrix} = \\begin{pmatrix} 2 + \\frac{1}{2}  2 - \\frac{1}{2} \\\\ 2 - \\frac{1}{2}  2 + \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{2}  \\frac{3}{2} \\\\ \\frac{3}{2}  \\frac{5}{2} \\end{pmatrix}\n$$\n白化矩阵 $P$ 定义为 $\\Sigma_x^{-1/2}$。我们通过对 $\\Sigma_x$ 进行特征分解来找到它，即 $\\Sigma_x = U D U^{\\top}$，其中 $D$ 是特征值的对角矩阵，$U$ 是相应特征向量的正交矩阵。那么 $P = U D^{-1/2} U^{\\top}$。\n\n特征方程为 $\\det(\\Sigma_x - \\lambda I) = 0$：\n$$\n\\left(\\frac{5}{2} - \\lambda\\right)^2 - \\left(\\frac{3}{2}\\right)^2 = 0 \\implies \\frac{5}{2} - \\lambda = \\pm \\frac{3}{2}\n$$\n这给出了特征值 $\\lambda_1 = \\frac{5}{2} - \\frac{3}{2} = 1$ 和 $\\lambda_2 = \\frac{5}{2} + \\frac{3}{2} = 4$。让我们将它们排序为 $\\lambda_1=4$ 和 $\\lambda_2=1$。\n\n相应的归一化特征向量是：\n对于 $\\lambda_1=4$：$v_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n对于 $\\lambda_2=1$：$v_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n分解所用的矩阵是：\n$$\nD = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}, \\quad U = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}\n$$\n然后，$D^{-1/2} = \\begin{pmatrix} 4^{-1/2}  0 \\\\ 0  1^{-1/2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix}$。\n白化矩阵 $P$ 是：\n$$\nP = U D^{-1/2} U^{\\top} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}\n$$\n$$\nP = \\frac{1}{2} \\begin{pmatrix} \\frac{1}{2}  1 \\\\ \\frac{1}{2}  -1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} \\frac{1}{2}+1  \\frac{1}{2}-1 \\\\ \\frac{1}{2}-1  \\frac{1}{2}+1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} \\frac{3}{2}  -\\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{4}  -\\frac{1}{4} \\\\ -\\frac{1}{4}  \\frac{3}{4} \\end{pmatrix}\n$$\n\n**2. 在白化域中识别眨眼成分**\n\n白化信号是 $Z(t) = P X(t) = P A S(t)$。白化空间中的有效混合由正交矩阵 $A_{\\text{whitened}} = PA$ 描述。\n$$\nA_{\\text{whitened}} = \\begin{pmatrix} \\frac{3}{4}  -\\frac{1}{4} \\\\ -\\frac{1}{4}  \\frac{3}{4} \\end{pmatrix} \\begin{pmatrix} \\sqrt{2}  -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3\\sqrt{2}-\\sqrt{2}  -\\frac{3}{\\sqrt{2}}-\\frac{1}{\\sqrt{2}} \\\\ -\\sqrt{2}+3\\sqrt{2}  \\frac{1}{\\sqrt{2}}+\\frac{3}{\\sqrt{2}} \\end{pmatrix}\n$$\n$$\nA_{\\text{whitened}} = \\frac{1}{4} \\begin{pmatrix} 2\\sqrt{2}  -\\frac{4}{\\sqrt{2}} \\\\ 2\\sqrt{2}  \\frac{4}{\\sqrt{2}} \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2\\sqrt{2}  -2\\sqrt{2} \\\\ 2\\sqrt{2}  2\\sqrt{2} \\end{pmatrix} = \\frac{\\sqrt{2}}{2} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix}\n$$\n白化数据的解混矩阵是 $W_z = A_{\\text{whitened}}^{-1} = A_{\\text{whitened}}^{\\top}$。\n$$\nW_z = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix}\n$$\n$W_z$ 的行是用于从白化数据 $Z$ 中恢复原始源的解混向量。第一行 $w_{z,1}^{\\top} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix}$ 恢复了第一个源 $s_1(t)$，即超高斯眨眼伪迹。FastICA算法（对超高斯源使用三次非线性）将收敛到相应的列向量 $w_z = w_{z,1} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$（或其负向量，这在源的符号翻转意义下是等效的）。\n\n**3. 变换回原始数据空间**\n\n估计的眨眼源由 $\\hat{s}_{\\text{blink}}(t) = w_z^{\\top} Z(t)$ 给出。我们希望找到向量 $c$ 使得 $\\hat{s}_{\\text{blink}}(t) = c^{\\top}X(t)$。\n通过代入 $Z(t) = P X(t)$，我们得到：\n$$\n\\hat{s}_{\\text{blink}}(t) = w_z^{\\top} (P X(t)) = (w_z^{\\top} P) X(t)\n$$\n将此与 $\\hat{s}_{\\text{blink}}(t) = c^{\\top} X(t)$ 进行比较，我们确定 $c^{\\top} = w_z^{\\top} P$。\n我们现在计算这个乘积：\n$$\nc^{\\top} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{4}  -\\frac{1}{4} \\\\ -\\frac{1}{4}  \\frac{3}{4} \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{3}{4}-\\frac{1}{4}  -\\frac{1}{4}+\\frac{3}{4} \\end{pmatrix}\n$$\n$$\nc^{\\top} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{2}{4}  \\frac{2}{4} \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2\\sqrt{2}}  \\frac{1}{2\\sqrt{2}} \\end{pmatrix}\n$$\n为了使分母有理化，我们将分子和分母同乘以 $\\sqrt{2}$：\n$$\nc^{\\top} = \\begin{pmatrix} \\frac{\\sqrt{2}}{4}  \\frac{\\sqrt{2}}{4} \\end{pmatrix}\n$$\n这就是最终的解混权重向量，表示为一个行矩阵，它从原始观测信号 $X(t)$ 中分离出眨眼成分。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{4}  \\frac{\\sqrt{2}}{4} \\end{pmatrix}}\n$$", "id": "4572820"}, {"introduction": "在生物信息学应用中，成功分离出统计上的独立成分仅仅是分析的开始，更关键的步骤是赋予这些成分生物学意义。通路富集分析是一种核心的统计方法，用于检验一个独立成分中高权重的基因集是否显著地富集了某个已知的生物学通路。本练习 [@problem_id:4572795] 将指导您从零开始，实现一个完整的验证流程，包括使用超几何检验计算富集p值，并通过Benjamini-Hochberg方法进行多重检验校正，最终判断所提取的成分是否映射到不同的生物学过程。", "problem": "给定一个有限的基因全集和表示为基因上实值权重向量的独立成分分析（ICA）成分。目标是设计一个程序，为每个测试用例通过通路富集分析和计算富集 p 值来评估 ICA 成分是否映射到不同的生物过程。您的设计必须基于以下基本统计事实：(i) 超几何分布给出无放回抽样的确切概率，以及 (ii) Benjamini–Hochberg 程序控制伪发现率（FDR）。独立成分分析（ICA）由生成线性混合模型定义，其中观察变量是统计独立源的线性混合，但在这里，您只被提供了基因全集上的估计成分权重向量，而不会进行估计。\n\n您必须从第一性原理出发实现以下定义和程序。\n\n1. 基因全集和 ICA 成分：\n- 设基因全集为一个有限集 $\\mathcal{U}$，其中 $|\\mathcal{U}| = N$，由 $\\{0,1,\\dots,N-1\\}$ 中的索引标记。\n- 设有 $C$ 个独立成分分析（ICA）成分，每个成分由一个实值权重向量 $\\mathbf{w}^{(c)} \\in \\mathbb{R}^{N}$ 表示，其中 $c \\in \\{1,\\dots,C\\}$。\n\n2. 通路：\n- 设有 $M$ 条通路，每条通路 $P_j \\subseteq \\mathcal{U}$，其中 $j \\in \\{1,\\dots,M\\}$。\n\n3. 每个成分的活性基因集选择：\n- 对每个成分 $c$，通过选择绝对权重 $|\\mathbf{w}^{(c)}_i|$ 最大的 $k$ 个基因来定义其活性基因集 $S_c \\subseteq \\mathcal{U}$，平局时由较小的基因索引决定。形式上，$S_c$ 是对应于 $|\\mathbf{w}^{(c)}_i|$ 前 $k$ 大值的 $k$ 个索引的集合，平局时按 $i$ 递增解决。\n\n4. 富集 p 值（单侧重叠富集）：\n- 对于给定的成分 $c$ 和通路 $P_j$，设 $K = |P_j|$，$n = |S_c| = k$，并观察到 $x = |S_c \\cap P_j|$。\n- 在原假设（即 $S_c$ 是从 $\\mathcal{U}$ 中均匀随机抽取的 $n$ 元子集）下，重叠计数 $X$ 服从参数为 $(N, K, n)$ 的超几何分布。单侧富集 p 值为\n$$\np_{c,j} = \\mathbb{P}[X \\ge x] = \\sum_{i=x}^{\\min(K,n)} \\frac{\\binom{K}{i}\\binom{N-K}{n-i}}{\\binom{N}{n}}.\n$$\n\n5. 多重检验校正：\n- 对每个测试用例，考虑包含 $C \\times M$ 个 p 值的族 $\\{p_{c,j}\\}$。在目标水平 $q \\in (0,1)$ 下应用 Benjamini–Hochberg 伪发现率（FDR）程序，以获得校正后的 p 值 $\\{\\tilde{p}_{c,j}\\}$。其中，将 p 值排序为 $p_{(1)} \\le \\dots \\le p_{(m)}$（$m = C M$），秩为 $r \\in \\{1,\\dots,m\\}$，排序后的校正值计算如下：\n$$\n\\tilde{p}_{(r)} = \\min_{s \\ge r} \\left( \\frac{m}{s} p_{(s)} \\right),\n$$\n然后将其映射回成分-通路对。\n\n6. 成分到通路的映射决策和独特性：\n- 对每个成分 $c$，设 $j^\\star(c) = \\arg\\min_{j} \\tilde{p}_{c,j}$ 为该成分具有最小校正后 p 值的通路（平局时由较小的 $j$ 决定）。如果 $\\tilde{p}_{c,j^\\star(c)} \\le q$，则称成分 $c$ 映射到通路 $j^\\star(c)$；否则，成分 $c$ 不映射到任何通路。\n- 如果每个成分都映射到某个通路，并且没有两个成分映射到相同的通路索引，则称一个测试用例支持“不同生物过程映射”；也就是说，映射 $c \\mapsto j^\\star(c)$ 在所有 $c \\in \\{1,\\dots,C\\}$ 上是单射的。\n\n您的任务是实现一个程序，为每个测试用例计算校正后的 p 值，并如上所述确定其独特性决策。对于每个测试用例，您的程序必须输出：\n- 一个布尔值，指示成分是否如第 6 项所定义的那样映射到不同的通路。\n- 一个每个成分的最小校正后 p 值列表 $\\left[\\min_{j} \\tilde{p}_{1,j}, \\dots, \\min_{j} \\tilde{p}_{C,j}\\right]$，每个值四舍五入到六位小数。\n\n不涉及角度。不涉及物理单位。所有浮点结果必须四舍五入到六位小数。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果应该是一个双元素列表，形式为 $[ \\text{distinct}, [\\text{min\\_adj\\_p\\_comp1}, \\dots ] ]$。例如，总的输出格式为 $[[\\dots],[\\dots],[\\dots]]$，不含任何额外文本。\n\n测试套件：\n请精确实现以下三个测试用例。\n\n- 测试用例 A（正常路径；清晰、不相交的信号）：\n  - 全集大小：$N = 100$，$\\mathcal{U} = \\{0,1,\\dots,99\\}$，成分数量：$C = 2$，通路数量：$M = 5$，选择大小：$k = 15$，目标 FDR：$q = 0.05$。\n  - 成分权重 $\\mathbf{w}^{(1)}$ 和 $\\mathbf{w}^{(2)}$：\n    - 对成分 1，当 $i \\in \\{0,1,\\dots,19\\}$ 时，设 $\\mathbf{w}^{(1)}_i = 5.0$；对所有其他 $i$，设 $\\mathbf{w}^{(1)}_i = 1.0$。\n    - 对成分 2，当 $i \\in \\{40,41,\\dots,59\\}$ 时，设 $\\mathbf{w}^{(2)}_i = 5.0$；对所有其他 $i$，设 $\\mathbf{w}^{(2)}_i = 1.0$。\n  - 通路：\n    - $P_1 = \\{0,1,\\dots,19\\}$,\n    - $P_2 = \\{40,41,\\dots,59\\}$,\n    - $P_3 = \\{80,81,\\dots,89\\}$,\n    - $P_4 = \\{20,21,\\dots,29\\}$,\n    - $P_5 = \\{60,61,\\dots,69\\}$。\n\n- 测试用例 B（边界情况；无真实富集）：\n  - 全集大小：$N = 80$，$\\mathcal{U} = \\{0,1,\\dots,79\\}$，成分数量：$C = 1$，通路数量：$M = 3$，选择大小：$k = 15$，目标 FDR：$q = 0.01$。\n  - 成分权重 $\\mathbf{w}^{(1)}$：对所有 $i \\in \\{0,1,\\dots,79\\}$，设 $\\mathbf{w}^{(1)}_i = 1.0$。\n  - 通路：\n    - $P_1 = \\{30,31,\\dots,44\\}$,\n    - $P_2 = \\{45,46,\\dots,59\\}$,\n    - $P_3 = \\{60,61,\\dots,74\\}$。\n\n- 测试用例 C（边界条件；极小和极大通路）：\n  - 全集大小：$N = 50$，$\\mathcal{U} = \\{0,1,\\dots,49\\}$，成分数量：$C = 2$，通路数量：$M = 3$，选择大小：$k = 10$，目标 FDR：$q = 0.05$。\n  - 成分权重 $\\mathbf{w}^{(1)}$ 和 $\\mathbf{w}^{(2)}$：\n    - 对成分 1，当 $i \\in \\{0,1,\\dots,9\\}$ 时，设 $\\mathbf{w}^{(1)}_i = 5.0$；对所有其他 $i$，设 $\\mathbf{w}^{(1)}_i = 1.0$。\n    - 对成分 2，当 $i \\in \\{40,41,\\dots,49\\}$ 时，设 $\\mathbf{w}^{(2)}_i = 5.0$；对所有其他 $i$，设 $\\mathbf{w}^{(2)}_i = 1.0$。\n  - 通路：\n    - $P_1 = \\{0,1,\\dots,49\\}$,\n    - $P_2 = \\{0,1,\\dots,9\\}$,\n    - $P_3 = \\{5\\}$。\n\n您的程序必须实现 $S_c$ 的选择，完全按照第 4 项计算所有超几何 p 值，按照第 5 项应用 Benjamini–Hochberg 校正，按照第 6 项决定映射和独特性，并最终打印单行：一个包含三个元素（每个测试用例一个）的列表，其中每个元素是一个双项列表，包含布尔独特性和每个成分的最小校正后 p 值列表，所有浮点数四舍五入到六位小数，且无额外输出文本。", "solution": "该问题要求设计并实现一个程序，以评估独立成分分析（ICA）的成分是否对应于不同的生物过程。这是通过一个多步骤的统计程序实现的，该程序涉及通路富集分析。该解决方案分为几个不同且有原则的阶段：活性基因集选择、用于富集的超几何 p 值计算、使用 Benjamini-Hochberg 程序的多次检验校正，以及用于将成分映射到通路的最终决策逻辑。\n\n基因全集是一个大小为 $N$ 的有限集 $\\mathcal{U}$。我们给定 $C$ 个 ICA 成分，每个成分由一个权重向量 $\\mathbf{w}^{(c)} \\in \\mathbb{R}^{N}$ 表示，以及 $M$ 个生物通路 $P_j \\subseteq \\mathcal{U}$。\n\n1.  **活性基因集选择**：对于每个 ICA 成分 $c$，我们必须首先确定它影响最强的基因集。这通过定义一个活性基因集 $S_c$ 来形式化，该集合包含与最大绝对权重 $|\\mathbf{w}_i^{(c)}|$ 对应的 $k$ 个基因。问题指定了一个确定性的平局打破规则：如果多个基因具有相同的绝对权重，则选择索引 $i$ 较小的基因。这是通过为每个基因创建（绝对权重，基因索引）对，并按权重降序、然后按索引升序进行稳定排序来实现的。从此排序列表中排名前 $k$ 的基因构成集合 $S_c$。\n\n2.  **富集 P 值计算**：为了确定 ICA 成分的活性基因集 $S_c$ 是否与生物通路 $P_j$ 显著相关，我们进行统计检验。原假设 $H_0$ 是，活性集 $S_c$ 是从全集 $\\mathcal{U}$ 中无放回随机抽取的 $k$ 个基因的样本。在此原假设下，活性集与通路之间共享的基因数 $X = |S_c \\cap P_j|$ 服从超几何分布。该分布的参数为：总体大小 $N=|\\mathcal{U}|$，总体中“成功”项的数量 $K=|P_j|$，以及抽样数量 $n=k=|S_c|$。观察到的重叠是 $x = |S_c \\cap P_j|$。单侧 p 值，衡量偶然观察到至少与 $x$ 一样大的重叠的概率，由超几何分布的生存函数给出：\n    $$\n    p_{c,j} = \\mathbb{P}[X \\ge x] = \\sum_{i=x}^{\\min(K,n)} \\frac{\\binom{K}{i}\\binom{N-K}{n-i}}{\\binom{N}{n}}\n    $$\n    对每个成分-通路对执行此计算，总共得到 $m = C \\times M$ 个 p 值。在计算上，这可以通过使用科学库（如 `scipy.stats.hypergeom`）中的生存函数（`sf`）来高效处理，该函数计算 $\\mathbb{P}[X > x']$，并可作为 `sf(x-1)` 来获得 $\\mathbb{P}[X \\ge x]$。\n\n3.  **多重检验校正**：由于我们同时进行 $m=C \\times M$ 个假设检验，偶然获得小 p 值（第一类错误）的风险会增加。为了解决这个问题，我们必须调整原始 p 值以控制一个集体的错误度量。问题指定了 Benjamini-Hochberg (BH) 程序来在目标水平 $q$ 控制伪发现率 (FDR)。BH 程序涉及将所有 $m$ 个 p 值按升序排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。第 $r$ 秩 p 值对应的校正后 p 值 $\\tilde{p}_{(r)}$ 计算如下：\n    $$\n    \\tilde{p}_{(r)} = \\min_{s=r, \\dots, m} \\left( \\frac{m}{s} p_{(s)} \\right)\n    $$\n    这可以通过首先计算序列值 $p_{(r)} \\cdot m/r$（对于 $r=1, \\dots, m$），然后从末尾（$r=m$）开始计算该序列的累积最小值来高效实现。最终的校正后 p 值也被限制在 $1.0$ 以内。\n\n4.  **成分到通路的映射和独特性决策**：有了校正后的 p 值 $\\{\\tilde{p}_{c,j}\\}$，我们可以对生物相关性做出正式的决策。对于每个成分 $c$，我们确定产生最小校正后 p 值的通路 $j^\\star(c)$，即 $j^\\star(c) = \\arg\\min_{j} \\tilde{p}_{c,j}$（平局由较小的通路索引 $j$ 决定）。如果这个最小校正后 p 值小于或等于目标 FDR 水平，即 $\\tilde{p}_{c,j^\\star(c)} \\le q$，则宣布成分 $c$ 显著映射到通路 $j^\\star(c)$。当且仅当满足两个条件时，整个测试用例支持“不同生物过程映射”：（i）每个成分 $c \\in \\{1, \\dots, C\\}$ 都映射到某个通路，以及（ii）映射 $c \\mapsto j^\\star(c)$ 是单射的，意味着没有两个成分映射到同一个通路。\n\n最终程序为每个测试用例集成了这些步骤，计算独特性布尔值，并为每个成分编译最小校正后 p 值列表。", "answer": "[[true,[0.0,0.0]],[false,[1.0]],[false,[0.0,1.0]]]", "id": "4572795"}]}