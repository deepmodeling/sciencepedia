{"hands_on_practices": [{"introduction": "泊松分布是生物学中计数数据建模的基础，例如基因突变或细胞事件的数量。矩生成函数 (MGF) 是一个强大的工具，它将一个分布的所有矩压缩到单个函数中，为推导均值和方差等性质提供了一种系统性的方法。本练习要求您从第一性原理出发进行推导，将概率质量函数与矩生成函数及其导数联系起来，从而深入理解如何描述一个关键的生物医学模型，以巩固您的基础技能 ([@problem_id:4378385])。", "problem": "对一个组织工程构建体进行成像，以量化标准化视野内的微血管分支事件。在分支事件独立且稀疏发生的假设下，单个视野内观察到的分支数量可以用参数为 $\\lambda0$ 的泊松随机变量 $X$ 来建模，其中 $\\lambda$ 是每个视野的预期分支数。从泊松分布的概率质量函数 (PMF) 的定义和矩生成函数 (MGF) 的定义出发，推导 $X$ 的矩生成函数 $M_{X}(t)$ 的显式闭合形式表达式。然后，仅使用矩在 $t=0$ 处求值的 MGF 导数的定义，以符号形式计算前三个原始矩 $\\mathbb{E}[X]$、$\\mathbb{E}[X^{2}]$ 和 $\\mathbb{E}[X^{3}]$。\n\n您的推导必须从以下基本定义开始：\n- 泊松随机变量的 PMF：对于 $x\\in\\{0,1,2,\\dots\\}$，$\\mathbb{P}(X=x)$ 取决于 $\\lambda$。\n- 矩生成函数 (MGF) 的定义：对于任意实数 $t$，$M_{X}(t)=\\mathbb{E}[\\exp(tX)]$。\n\n用 $\\lambda$ 和 $t$ 的符号形式表示您的最终结果；不要引入任何数值。不需要四舍五入。提供 MGF 和三个原始矩。", "solution": "根据指定标准对问题陈述进行验证。\n\n**问题验证**\n\n**步骤 1：提取的已知条件**\n- 随机变量 $X$ 表示微血管分支事件的计数。\n- $X$ 服从参数为 $\\lambda  0$ 的泊松分布。\n- $\\lambda$ 是每个视野的预期分支数。\n- 对于 $x \\in \\{0, 1, 2, \\dots\\}$，给出了 $X$ 的概率质量函数 (PMF)，定义为 $\\mathbb{P}(X=x)$。\n- 矩生成函数 (MGF) 定义为 $M_{X}(t) = \\mathbb{E}[\\exp(tX)]$。\n- 任务是推导 MGF $M_{X}(t)$ 的闭合形式。\n- 随后，必须仅使用 MGF 及其导数计算前三个原始矩 $\\mathbb{E}[X]$、$\\mathbb{E}[X^2]$ 和 $\\mathbb{E}[X^3]$。\n- 结果必须是关于 $\\lambda$ 和 $t$ 的符号形式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题被评估为有效。\n- **科学依据：** 泊松分布是计算固定域内罕见、独立事件（例如所述的生物学背景）的标准和适当模型。该问题基于概率论的基本原理。\n- **适定性：** 问题表述清晰。它要求为一个明确定义的概率分布（泊松分布）推导标准的统计特性（MGF 和矩）。存在唯一且有意义的解。\n- **客观性：** 问题使用精确、标准的数学和统计术语表达，没有任何主观性或模糊性。\n- **完整性和一致性：** 提供了所有必要的定义和约束条件。对“泊松分布的 PMF 定义”的引用是明确的，因为该函数是普遍定义的。没有矛盾之处。\n\n**步骤 3：结论和行动**\n问题有效。将提供完整解答。\n\n**矩生成函数 (MGF) 的推导**\n\n分析从提供的基本定义开始。对于离散随机变量 $X$，$X$ 的函数（例如 $g(X)$）的期望值由 $\\mathbb{E}[g(X)] = \\sum_{x} g(x) \\mathbb{P}(X=x)$ 给出，其中求和涵盖了 $X$ 可以取的所有可能值 $x$。随机变量 $X$ 服从参数为 $\\lambda$ 的泊松分布，因此其支撑集为非负整数集合 $\\{0, 1, 2, \\dots\\}$，其概率质量函数 (PMF) 由下式给出：\n$$\n\\mathbb{P}(X=x) = \\frac{\\lambda^{x} \\exp(-\\lambda)}{x!}, \\quad \\text{for } x = 0, 1, 2, \\dots\n$$\n矩生成函数 (MGF) 定义为 $M_{X}(t) = \\mathbb{E}[\\exp(tX)]$。应用期望公式，其中 $g(X) = \\exp(tX)$，我们得到：\n$$\nM_{X}(t) = \\sum_{x=0}^{\\infty} \\exp(tx) \\mathbb{P}(X=x)\n$$\n将泊松分布的 PMF 代入此定义，得到：\n$$\nM_{X}(t) = \\sum_{x=0}^{\\infty} \\exp(tx) \\frac{\\lambda^{x} \\exp(-\\lambda)}{x!}\n$$\n项 $\\exp(-\\lambda)$ 不依赖于求和索引 $x$，可以从求和中提取出来：\n$$\nM_{X}(t) = \\exp(-\\lambda) \\sum_{x=0}^{\\infty} \\frac{\\exp(tx) \\lambda^{x}}{x!}\n$$\n我们可以合并以 $x$ 为幂的项：$\\exp(tx) \\lambda^{x} = (\\lambda \\exp(t))^{x}$。\n$$\nM_{X}(t) = \\exp(-\\lambda) \\sum_{x=0}^{\\infty} \\frac{(\\lambda \\exp(t))^{x}}{x!}\n$$\n这个求和可以识别为指数函数的麦克劳林级数展开，$\\exp(z) = \\sum_{k=0}^{\\infty} \\frac{z^{k}}{k!}$。在此表达式中，$z = \\lambda \\exp(t)$。因此，该和的计算结果为 $\\exp(\\lambda \\exp(t))$。\n将此结果代回，我们得到 MGF 的闭合形式表达式：\n$$\nM_{X}(t) = \\exp(-\\lambda) \\exp(\\lambda \\exp(t)) = \\exp(-\\lambda + \\lambda \\exp(t))\n$$\n在指数中提出因子 $\\lambda$，得到泊松随机变量 MGF 的最终标准形式：\n$$\nM_{X}(t) = \\exp(\\lambda(\\exp(t) - 1))\n$$\n此推导完成了问题的第一部分。\n\n**原始矩的显式闭合形式表达式的计算**\n\n$X$ 的第 $n$ 阶原始矩，记为 $\\mathbb{E}[X^n]$，通过计算 MGF 关于 $t$ 的第 $n$ 阶导数并在 $t=0$ 处求值得到。\n$$\n\\mathbb{E}[X^n] = \\frac{d^n}{dt^n} M_{X}(t) \\bigg|_{t=0}\n$$\n我们现在将使用此性质计算前三个原始矩。\n\n**一阶原始矩：$\\mathbb{E}[X]$**\n一阶矩是 $M_X(t)$ 的一阶导数在 $t=0$ 处的值。\n$$\nM'_{X}(t) = \\frac{d}{dt} \\exp(\\lambda(\\exp(t) - 1))\n$$\n使用链式法则，其中外函数为 $\\exp(u)$，内函数为 $u(t) = \\lambda(\\exp(t) - 1)$，我们有 $u'(t)=\\lambda\\exp(t)$。\n$$\nM'_{X}(t) = \\exp(\\lambda(\\exp(t) - 1)) \\cdot (\\lambda \\exp(t)) = \\lambda \\exp(t) M_{X}(t)\n$$\n在 $t=0$ 处求值：\n$$\n\\mathbb{E}[X] = M'_{X}(0) = \\lambda \\exp(0) M_{X}(0) = \\lambda \\cdot 1 \\cdot \\exp(\\lambda(\\exp(0) - 1)) = \\lambda \\cdot \\exp(\\lambda(1-1)) = \\lambda \\exp(0) = \\lambda\n$$\n因此，一阶原始矩为 $\\mathbb{E}[X] = \\lambda$。\n\n**二阶原始矩：$\\mathbb{E}[X^2]$**\n二阶矩是 $M_X(t)$ 的二阶导数在 $t=0$ 处的值。我们使用乘法法则对 $M'_{X}(t) = \\lambda \\exp(t) M_{X}(t)$ 进行微分。\n$$\nM''_{X}(t) = \\frac{d}{dt} (\\lambda \\exp(t) M_{X}(t)) = \\left(\\frac{d}{dt} (\\lambda \\exp(t))\\right) M_{X}(t) + (\\lambda \\exp(t)) \\left(\\frac{d}{dt} M_{X}(t)\\right)\n$$\n$$\nM''_{X}(t) = (\\lambda \\exp(t)) M_{X}(t) + (\\lambda \\exp(t)) M'_{X}(t)\n$$\n代入 $M'_{X}(t) = \\lambda \\exp(t) M_{X}(t)$：\n$$\nM''_{X}(t) = \\lambda \\exp(t) M_{X}(t) + (\\lambda \\exp(t))(\\lambda \\exp(t) M_{X}(t)) = M_{X}(t)[\\lambda \\exp(t) + \\lambda^2 \\exp(2t)]\n$$\n在 $t=0$ 处求值：\n$$\n\\mathbb{E}[X^2] = M''_{X}(0) = M_{X}(0)[\\lambda \\exp(0) + \\lambda^2 \\exp(2 \\cdot 0)] = 1 \\cdot [\\lambda \\cdot 1 + \\lambda^2 \\cdot 1] = \\lambda + \\lambda^2\n$$\n因此，二阶原始矩为 $\\mathbb{E}[X^2] = \\lambda^2 + \\lambda$。\n\n**三阶原始矩：$\\mathbb{E}[X^3]$**\n三阶矩是 $M_X(t)$ 的三阶导数在 $t=0$ 处的值。我们使用乘法法则对 $M''_{X}(t) = M_{X}(t)[\\lambda \\exp(t) + \\lambda^2 \\exp(2t)]$ 进行微分。\n$$\nM'''_{X}(t) = \\frac{d}{dt} \\left(M_{X}(t)[\\lambda \\exp(t) + \\lambda^2 \\exp(2t)]\\right)\n$$\n$$\nM'''_{X}(t) = M'_{X}(t)[\\lambda \\exp(t) + \\lambda^2 \\exp(2t)] + M_{X}(t)[\\lambda \\exp(t) + 2\\lambda^2 \\exp(2t)]\n$$\n在 $t=0$ 处求值，并使用先前计算的值 $M_X(0)=1$ 和 $M'_X(0)=\\lambda$：\n$$\n\\mathbb{E}[X^3] = M'''_{X}(0) = M'_{X}(0)[\\lambda \\exp(0) + \\lambda^2 \\exp(0)] + M_X(0)[\\lambda \\exp(0) + 2\\lambda^2 \\exp(0)]\n$$\n$$\n\\mathbb{E}[X^3] = \\lambda[\\lambda + \\lambda^2] + 1[\\lambda + 2\\lambda^2] = \\lambda^2 + \\lambda^3 + \\lambda + 2\\lambda^2\n$$\n合并各项，我们得到三阶原始矩：\n$$\n\\mathbb{E}[X^3] = \\lambda^3 + 3\\lambda^2 + \\lambda\n$$\n这完成了所需的推导。MGF 和前三个原始矩的表达式在最终答案中提供。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp(\\lambda(\\exp(t) - 1))  \\lambda  \\lambda^2 + \\lambda  \\lambda^3 + 3\\lambda^2 + \\lambda\n\\end{pmatrix}\n}\n$$", "id": "4378385"}, {"introduction": "在临床研究中，我们通常只有来自一部分患者样本的数据，但希望对整个群体进行推断，例如某个生物标志物的平均水平。中心极限定理 (CLT) 是统计学的基石，它使我们即使在未知潜在群体分布的情况下，也能够近似推断样本均值的分布。这项实践展示了如何为群体均值构建置信区间这一生物统计学中的关键技能，并强调了当处理总体参数未知的真实世界数据时，中心极限定理和 Slutsky 定理等理论结果的实际应用意义 ([@problem_id:4378418])。", "problem": "一个系统生物医学团队正在表征一组患者队列中的血浆白细胞介素-6浓度，并将其作为一种全身性炎症生物标志物。设 $\\{X_{i}\\}_{i=1}^{n}$ 表示来自 $n$ 位不同患者的生物标志物测量值，这些测量值被建模为来自一个具有总体均值 $\\mu$ 和有限方差 $\\sigma^{2}$ 的未知分布的独立同分布（i.i.d.）样本。给定 $n=64$ 个患者样本，样本均值 $\\bar{X}=155$，样本标准差 $S=42$，单位为皮克/毫升（pg/mL）。\n\n从中心极限定理（CLT）以及样本均值和样本方差的定义出发，并引用 Slutsky 定理来证明用样本标准差 $S$ 替换未知 $\\sigma$ 的合理性（学生化），推导出一个考虑了未知方差的 $\\mu$ 的渐近双侧 $(1-\\alpha)$ 置信区间。然后，令 $\\alpha=0.05$，计算该“CLT-学生化”区间的数值端点。\n\n此外，如果假设生物标志物测量值服从严格的高斯分布，请基于具有 $n-1$ 个自由度的学生 $t$ 分布，推导 $\\mu$ 的精确双侧 $(1-\\alpha)$ 置信区间，并计算当 $\\alpha=0.05$ 时的数值端点。\n\n将每个端点四舍五入到四位有效数字。以 pg/mL 为单位表示区间端点。按以下顺序返回四个端点值：CLT-学生化下限、CLT-学生化上限、$t$-精确下限、$t$-精确上限。", "solution": "首先根据所需标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n- 生物标志物测量值 $\\{X_{i}\\}_{i=1}^{n}$ 是独立同分布的（i.i.d.）。\n- 总体均值：$\\mu$（未知）。\n- 总体方差：$\\sigma^2$（有限且未知）。\n- 样本量：$n=64$。\n- 样本均值：$\\bar{X}=155$ pg/mL。\n- 样本标准差：$S=42$ pg/mL。\n- 显著性水平：$\\alpha=0.05$。\n\n**步骤2：使用提取的信息进行验证**\n- **科学依据**：该问题描述了一项标准的生物统计学任务：使用置信区间从样本数据中估计总体均值。这是概率论在生物医学中的一个基本且现实的应用。给定值对于生物测量而言是合理的。\n- **适定性**：该问题是适定的。它要求在明确说明的假设（一个渐近假设，一个精确分布假设）下推导和计算两种不同类型的置信区间。所有必要的数据都已提供。\n- **客观性**：该问题以精确、客观的语言陈述，没有歧义或主观论断。\n- **结论**：该问题没有科学上的不健全、不完整、矛盾或其他缺陷。它是一个有效、定义明确的应用统计学问题。\n\n**步骤3：判定与行动**\n问题有效。现在开始推导解答。\n\n### 第1部分：通过CLT和Slutsky定理推导渐近置信区间\n\n目标是在不假设数据服从正态分布的情况下，为总体均值 $\\mu$ 推导一个双侧 $(1-\\alpha)$ 置信区间。我们给定一个样本量为 $n=64$ 的样本，其样本均值为 $\\bar{X}=155$，样本标准差为 $S=42$。\n\n中心极限定理（CLT）指出，对于一个具有有限均值 $\\mu$ 和有限非零方差 $\\sigma^2$ 的独立同分布随机变量序列 $\\{X_i\\}_{i=1}^n$，当 $n \\to \\infty$ 时，标准化的样本均值在分布上收敛于标准正态分布。用数学语言表示，\n$$ \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}} \\xrightarrow{d} Z \\sim N(0, 1) $$\n其中 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^n X_i$ 是样本均值。\n\n在这个问题中，总体标准差 $\\sigma$ 是未知的。我们使用样本标准差 $S$ 来估计它，其中样本方差 $S^2$ 定义为 $S^2 = \\frac{1}{n-1} \\sum_{i=1}^n (X_i - \\bar{X})^2$。样本方差 $S^2$ 是总体方差 $\\sigma^2$ 的一个相合估计量，这意味着当 $n \\to \\infty$ 时，$S^2$ 依概率收敛于 $\\sigma^2$。这可以写作 $S^2 \\xrightarrow{p} \\sigma^2$。根据连续映射定理，可以得出 $S \\xrightarrow{p} \\sigma$。\n\n我们现在构造学生化统计量，即用其估计值 $S$ 替换未知的 $\\sigma$：\n$$ T_n = \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}} $$\n这可以改写为：\n$$ T_n = \\left(\\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}\\right) \\left(\\frac{\\sigma}{S}\\right) $$\n我们有两个部分：\n1. $Y_n = \\frac{\\bar{X} - \\mu}{\\sigma/\\sqrt{n}}$，根据CLT，它在分布上收敛于 $Z \\sim N(0, 1)$。\n2. $Z_n = \\frac{S}{\\sigma}$，因为 $S$ 是 $\\sigma$ 的相合估计量，所以它依概率收敛于 $1$。因此，它的倒数 $\\frac{\\sigma}{S}$ 也依概率收敛于 $1$。\n\nSlutsky 定理指出，如果 $Y_n \\xrightarrow{d} Y$ 且 $Z_n \\xrightarrow{p} c$（一个常数），那么 $Y_n Z_n^{-1} \\xrightarrow{d} Y/c$。将此应用于我们的情况，其中 $Y_n = \\sqrt{n}(\\bar{X}-\\mu)$ 和 $Z_n=S$，我们发现学生化统计量 $T_n$ 在分布上收敛于一个标准正态随机变量：\n$$ T_n = \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}} \\xrightarrow{d} Z \\sim N(0, 1) $$\n因此，对于大样本量 $n$，我们可以用标准正态分布来近似 $T_n$ 的分布。这使我们能够为 $(1-\\alpha)$ 置信水平写出以下概率陈述：\n$$ P\\left(-z_{\\alpha/2} \\le \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}} \\le z_{\\alpha/2}\\right) \\approx 1-\\alpha $$\n其中 $z_{\\alpha/2}$ 是来自标准正态分布的临界值，使得 $P(Z  z_{\\alpha/2}) = \\alpha/2$。\n\n整理不等式以分离出 $\\mu$：\n$$ \\bar{X} - z_{\\alpha/2} \\frac{S}{\\sqrt{n}} \\le \\mu \\le \\bar{X} + z_{\\alpha/2} \\frac{S}{\\sqrt{n}} $$\n这就得到了 $\\mu$ 的渐近双侧 $(1-\\alpha)$ 置信区间：\n$$ \\left[ \\bar{X} - z_{\\alpha/2} \\frac{S}{\\sqrt{n}}, \\bar{X} + z_{\\alpha/2} \\frac{S}{\\sqrt{n}} \\right] $$\n对于这个问题，我们有 $n=64$，$\\bar{X}=155$，$S=42$，以及 $\\alpha=0.05$。这意味着 $\\alpha/2=0.025$。相应的临界值为 $z_{0.025} \\approx 1.9600$。\n均值的标准误是 $SE = \\frac{S}{\\sqrt{n}} = \\frac{42}{\\sqrt{64}} = \\frac{42}{8} = 5.25$。\n误差范围是 $ME_{CLT} = z_{0.025} \\times SE \\approx 1.9600 \\times 5.25 = 10.29$。\n下限端点是 $\\bar{X} - ME_{CLT} = 155 - 10.29 = 144.71$。\n上限端点是 $\\bar{X} + ME_{CLT} = 155 + 10.29 = 165.29$。\n四舍五入到四位有效数字，下限端点是 $144.7$ pg/mL，上限端点是 $165.3$ pg/mL。\n\n### 第2部分：假设正态分布的精确置信区间（学生t分布）\n\n现在，我们增加一个假设，即测量值 $\\{X_i\\}$ 来自正态分布，即 $X_i \\sim N(\\mu, \\sigma^2)$。在此假设下，枢轴量\n$$ \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}} $$\n服从一个自由度为 $n-1$ 的精确学生 $t$ 分布。\n对于一个 $(1-\\alpha)$ 置信区间的概率陈述是：\n$$ P\\left(-t_{n-1, \\alpha/2} \\le \\frac{\\bar{X} - \\mu}{S/\\sqrt{n}} \\le t_{n-1, \\alpha/2}\\right) = 1-\\alpha $$\n其中 $t_{n-1, \\alpha/2}$ 是来自自由度为 $n-1$ 的学生 $t$ 分布的临界值，使得上尾面积为 $\\alpha/2$。\n\n为 $\\mu$ 整理不等式，得到 $\\mu$ 的精确 $(1-\\alpha)$ 置信区间：\n$$ \\left[ \\bar{X} - t_{n-1, \\alpha/2} \\frac{S}{\\sqrt{n}}, \\bar{X} + t_{n-1, \\alpha/2} \\frac{S}{\\sqrt{n}} \\right] $$\n对于这个问题，$\\alpha=0.05$，自由度为 $df = n-1 = 64-1=63$。我们需要临界值 $t_{63, 0.025}$。使用统计表或软件，得到 $t_{63, 0.025} \\approx 1.9983$。\n标准误与之前相同：$SE = \\frac{S}{\\sqrt{n}} = 5.25$。\n误差范围是 $ME_t = t_{63, 0.025} \\times SE \\approx 1.9983 \\times 5.25 \\approx 10.4911$。\n下限端点是 $\\bar{X} - ME_t = 155 - 10.4911 = 144.5089$。\n上限端点是 $\\bar{X} + ME_t = 155 + 10.4911 = 165.4911$。\n四舍五入到四位有效数字，下限端点是 $144.5$ pg/mL，上限端点是 $165.5$ pg/mL。\n\n所要求的四个端点值是：\n1. CLT-学生化下限：$144.7$\n2. CLT-学生化上限：$165.3$\n3. $t$-精确下限：$144.5$\n4. $t$-精确上限：$165.5$\n\n这些值将以行矩阵的形式呈现在最终答案中。注意，对于像 $n=64$ 这样相对较大的样本量，自由度为 $63$ 的t分布与标准正态分布非常接近，因此各自的区间也非常相似。", "answer": "$$\\boxed{\\begin{pmatrix} 144.7  165.3  144.5  165.5 \\end{pmatrix}}$$", "id": "4378418"}, {"introduction": "精准医疗旨在根据个体患者数据定制临床决策，但这需要一个形式化的框架来权衡不同类型诊断错误的风险。贝叶斯决策理论通过最小化预期损失，明确考虑先验概率和非对称的错分成本，为设计最优分类器提供了一种有原则的方法。通过为一个败血症生物标志物推导贝叶斯最优决策阈值，这个问题弥合了概率论与临床应用之间的鸿沟，展示了当假阴性的后果远比假阳性严重时，如何将决策过程形式化 ([@problem_id:4378388])。", "problem": "在系统生物医学中，一种精准医疗分诊算法使用以 ng/mL 为单位测量的血浆生物标志物浓度来筛查脓毒症。令 $B$ 表示生物标志物浓度，并定义变换后的变量 $X = \\ln(B)$。在目标住院人群中，假设存在以下具有科学动机的模型：\n- 疾病标签为 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示脓毒症，$Y=0$ 表示无脓毒症。\n- 先验概率为 $\\pi_{1} = 0.12$ 和 $\\pi_{0} = 0.88$。\n- $X$ 的类条件分布是方差相等的高斯分布：$X \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$ 和 $X \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$，其中 $\\mu_{0} = -0.2$，$\\mu_{1} = 0.6$，$\\sigma = 0.5$。\n- 决策规则基于应用于 $X$ 或等价地应用于 $B$ 的阈值，输出 $\\hat{Y} \\in \\{0,1\\}$。假阴性（当 $Y=1$ 时预测为 $0$）产生的损失为 $C_{\\mathrm{FN}} = 40$，假阳性（当 $Y=0$ 时预测为 $1$）产生的损失为 $C_{\\mathrm{FP}} = 1$。正确分类产生的损失为零。\n\n从贝叶斯决策理论的第一性原理出发，推导在原始浓度标度上的贝叶斯最优阈值，即找到值 $B^{\\ast}$（单位为 ng/mL），使得最小化期望错分损失的贝叶斯分类器当且仅当 $B \\geq B^{\\ast}$ 时预测为脓毒症。你的推导过程必须从期望损失和先验概率的定义开始，并使用给定的类条件分布，不得引用任何预先给出的最终决策公式。给出最终的贝叶斯最优阈值 $B^{\\ast}$（单位为 ng/mL），并将你的答案四舍五入到四位有效数字。", "solution": "该问题要求从第一性原理出发，推导用于诊断脓毒症的贝叶斯最优决策阈值。目标是找到生物标志物浓度 $B$ 的一个阈值 $B^{\\ast}$，使得期望损失最小化。决策规则是如果 $B \\ge B^{\\ast}$ 则预测为脓毒症（$\\hat{Y}=1$），如果 $B  B^{\\ast}$ 则预测为无脓毒症（$\\hat{Y}=0$）。由于分析是在变换后的变量 $X = \\ln(B)$ 上进行的，我们将首先推导 $X$ 的阈值 $X^{\\ast}$。\n\n设 $x$ 是随机变量 $X$ 的一个观测值。根据贝叶斯决策理论，我们必须选择能够最小化条件期望损失的行动（预测 $\\hat{Y}=0$ 或 $\\hat{Y}=1$），条件是观测到 $X=x$。正确分类的损失为零，而错分的损失为：假阴性（$\\hat{Y}=0, Y=1$）的损失为 $C_{\\mathrm{FN}} = 40$，假阳性（$\\hat{Y}=1, Y=0$）的损失为 $C_{\\mathrm{FP}} = 1$。\n\n在给定观测值 $X=x$ 的条件下，决定 $\\hat{Y}=1$（预测为脓毒症）的条件期望损失（或风险）为：\n$$R(\\hat{Y}=1 | X=x) = (\\text{loss for } \\hat{Y}=1, Y=0) P(Y=0|X=x) + (\\text{loss for } \\hat{Y}=1, Y=1) P(Y=1|X=x)$$\n$$R(\\hat{Y}=1 | X=x) = C_{\\mathrm{FP}} P(Y=0|X=x) + 0 \\cdot P(Y=1|X=x) = C_{\\mathrm{FP}} P(Y=0|X=x)$$\n\n在给定观测值 $X=x$ 的条件下，决定 $\\hat{Y}=0$（预测为无脓毒症）的条件期望损失为：\n$$R(\\hat{Y}=0 | X=x) = (\\text{loss for } \\hat{Y}=0, Y=0) P(Y=0|X=x) + (\\text{loss for } \\hat{Y}=0, Y=1) P(Y=1|X=x)$$\n$$R(\\hat{Y}=0 | X=x) = 0 \\cdot P(Y=0|X=x) + C_{\\mathrm{FN}} P(Y=1|X=x) = C_{\\mathrm{FN}} P(Y=1|X=x)$$\n\n贝叶斯最优决策规则是，如果预测为脓毒症（$\\hat{Y}=1$）的风险小于预测为无脓毒症的风险，则预测为脓毒症。也就是说，我们在以下情况下预测 $\\hat{Y}=1$：\n$$R(\\hat{Y}=1 | X=x)  R(\\hat{Y}=0 | X=x)$$\n$$C_{\\mathrm{FP}} P(Y=0|X=x)  C_{\\mathrm{FN}} P(Y=1|X=x)$$\n\n为了用给定的类条件分布来表示这个不等式，我们对后验概率 $P(Y=k|X=x)$ 使用贝叶斯定理：\n$$P(Y=k|X=x) = \\frac{p(x|Y=k)P(Y=k)}{p(x)} = \\frac{p(x|Y=k)\\pi_k}{p(x)}$$\n其中 $p(x|Y=k)$ 是类条件概率密度函数（似然），$\\pi_k$ 是类别 $k$ 的先验概率，$p(x)$ 是 $X$ 的边缘概率密度（证据）。\n\n将此代入不等式，得到：\n$$C_{\\mathrm{FP}} \\frac{p(x|Y=0)\\pi_0}{p(x)}  C_{\\mathrm{FN}} \\frac{p(x|Y=1)\\pi_1}{p(x)}$$\n证据项 $p(x)$ 是正数，可以从不等式两边消去，从而得到一个关于似然和先验的条件：\n$$C_{\\mathrm{FP}} p(x|Y=0)\\pi_0  C_{\\mathrm{FN}} p(x|Y=1)\\pi_1$$\n由于我们正在寻找一个形式为 $X \\ge X^{\\ast}$ 的规则，并且我们知道脓毒症（$Y=1$）对应于更高的平均生物标志物水平（$\\mu_1  \\mu_0$），我们期望对较大的 $x$ 值分类为脓毒症。我们可以将不等式重排为似然比检验：\n$$\\frac{p(x|Y=1)}{p(x|Y=0)}  \\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}$$\n\n类条件分布是高斯分布：$X|Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$ 和 $X|Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$。它们的概率密度函数是：\n$$p(x|Y=0) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu_{0})^2}{2\\sigma^2}\\right)$$\n$$p(x|Y=1) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu_{1})^2}{2sigma^2}\\right)$$\n似然比为：\n$$\\frac{p(x|Y=1)}{p(x|Y=0)} = \\frac{\\exp\\left(-\\frac{(x - \\mu_{1})^2}{2\\sigma^2}\\right)}{\\exp\\left(-\\frac{(x - \\mu_{0})^2}{2\\sigma^2}\\right)} = \\exp\\left(\\frac{(x - \\mu_{0})^2 - (x - \\mu_{1})^2}{2\\sigma^2}\\right)$$\n指数部分化简为：\n$$(x - \\mu_{0})^2 - (x - \\mu_{1})^2 = (x^2 - 2x\\mu_{0} + \\mu_{0}^2) - (x^2 - 2x\\mu_{1} + \\mu_{1}^2) = 2x(\\mu_{1} - \\mu_{0}) - (\\mu_{1}^2 - \\mu_{0}^2)$$\n将此代回，决策规则为：\n$$\\exp\\left(\\frac{2x(\\mu_{1} - \\mu_{0}) - (\\mu_{1}^2 - \\mu_{0}^2)}{2\\sigma^2}\\right)  \\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}$$\n对不等式两边取自然对数，这是一个单调变换，保持不等式方向不变：\n$$\\frac{2x(\\mu_{1} - \\mu_{0}) - (\\mu_{1}^2 - \\mu_{0}^2)}{2\\sigma^2}  \\ln\\left(\\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}\\right)$$\n现在，我们解出 $x$：\n$$2x(\\mu_{1} - \\mu_{0}) - (\\mu_{1}^2 - \\mu_{0}^2)  2\\sigma^2 \\ln\\left(\\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}\\right)$$\n$$2x(\\mu_{1} - \\mu_{0})  (\\mu_{1}^2 - \\mu_{0}^2) + 2\\sigma^2 \\ln\\left(\\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}\\right)$$\n由于 $\\mu_{1}  \\mu_{0}$，$(\\mu_1 - \\mu_0)$ 是正数，因此用它相除不会改变不等式方向：\n$$x  \\frac{\\mu_{1}^2 - \\mu_{0}^2}{2(\\mu_{1} - \\mu_{0})} + \\frac{2\\sigma^2}{2(\\mu_{1} - \\mu_{0})} \\ln\\left(\\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}\\right)$$\n使用恒等式 $\\mu_1^2 - \\mu_0^2 = (\\mu_1 - \\mu_0)(\\mu_1 + \\mu_0)$，我们化简第一项：\n$$x  \\frac{\\mu_{1} + \\mu_{0}}{2} + \\frac{\\sigma^2}{\\mu_{1} - \\mu_{0}} \\ln\\left(\\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}\\right)$$\n这就给出了关于 $X$ 的决策规则。阈值 $X^{\\ast}$ 是两个风险相等时的值：\n$$X^{\\ast} = \\frac{\\mu_{1} + \\mu_{0}}{2} + \\frac{\\sigma^2}{\\mu_{1} - \\mu_{0}} \\ln\\left(\\frac{C_{\\mathrm{FP}}\\pi_0}{C_{\\mathrm{FN}}\\pi_1}\\right)$$\n我们代入给定值：$\\mu_{0} = -0.2$，$\\mu_{1} = 0.6$，$\\sigma = 0.5$（所以 $\\sigma^2 = 0.25$），$\\pi_{0} = 0.88$，$\\pi_{1} = 0.12$，$C_{\\mathrm{FP}} = 1$ 以及 $C_{\\mathrm{FN}} = 40$。\n$$X^{\\ast} = \\frac{0.6 - 0.2}{2} + \\frac{0.25}{0.6 - (-0.2)} \\ln\\left(\\frac{1 \\times 0.88}{40 \\times 0.12}\\right)$$\n$$X^{\\ast} = \\frac{0.4}{2} + \\frac{0.25}{0.8} \\ln\\left(\\frac{0.88}{4.8}\\right)$$\n$$X^{\\ast} = 0.2 + 0.3125 \\ln\\left(\\frac{11}{60}\\right)$$\n对此表达式进行数值计算：\n$$\\ln\\left(\\frac{11}{60}\\right) \\approx -1.69648$$\n$$X^{\\ast} \\approx 0.2 + 0.3125 \\times (-1.69648) \\approx 0.2 - 0.53015 = -0.33015$$\n问题要求的是原始浓度标度上的阈值 $B^{\\ast}$。决策规则是如果 $X \\ge X^{\\ast}$ 则预测为脓毒症。由于 $X = \\ln(B)$，这等价于 $\\ln(B) \\ge X^{\\ast}$。因为指数函数是单调递增的，这变为 $B \\ge \\exp(X^{\\ast})$。因此，最优阈值为 $B^{\\ast} = \\exp(X^{\\ast})$。\n$$B^{\\ast} = \\exp(-0.33015)$$\n$$B^{\\ast} \\approx 0.7188236$$\n将最终答案四舍五入到四位有效数字，得到 $0.7188$。单位是 ng/mL。\n如果测得的生物标志物浓度 $B$ 大于或等于 $0.7188$ ng/mL，分类器就预测为脓毒症。", "answer": "$$\\boxed{0.7188}$$", "id": "4378388"}]}