{"hands_on_practices": [{"introduction": "在系统生物学和代谢工程中，将复杂的生化反应网络转化为数学形式是进行分析的第一步。化学计量矩阵 $S$ 是这种表示的核心，它精确地捕捉了每个反应中代谢物的质量平衡关系。这项练习旨在巩固您将生物化学反应转化为矩阵形式的能力，这是通量平衡分析（FBA）等强大分析技术的基础，直接将网络结构（哪些节点参与哪些反应）与功能（化学计量）联系起来 [@problem_id:4367418]。", "problem": "考虑一个由代谢物和反应之间的二分图表示的粗粒度代谢网络片段。代谢物集合为 $\\mathcal{M} = \\{X_{1}, X_{2}, X_{3}\\}$，反应集合为 $\\mathcal{R} = \\{R_{1}, R_{2}, R_{3}\\}$。这些反应由基团的守恒转换（化学计量层面的质量平衡）定义，其中反应物根据其系数被消耗，产物根据其系数被生成：\n- $R_{1}$: $X_{1} + 2 X_{2} \\rightarrow X_{3}$，\n- $R_{2}$: $X_{3} \\rightarrow X_{1}$，\n- $R_{3}$: $X_{1} \\rightarrow 2 X_{2}$。\n\n二分图中的边连接 $X_{i} \\in \\mathcal{M}$ 和 $R_{j} \\in \\mathcal{R}$，其方向约定定义了有符号关联：对于每个反应物，画一条从 $X_{i}$ 到 $R_{j}$ 的边，权重为 $\\nu_{ij}$，符号为 $-1$；对于每个产物，画一条从 $R_{j}$ 到 $X_{i}$ 的边，权重为 $\\nu_{ij}$，符号为 $+1$，其中 $\\nu_{ij}$ 是 $X_{i}$ 在 $R_{j}$ 中的化学计量系数。该约定确保了二分图的关联性将消耗表示为负，生成表示为正，这与通量平衡分析（Flux Balance Analysis, FBA）中使用的质量平衡记账法一致。\n\n从化学计量系数的基本定义以及 $\\mathcal{M}$ 和 $\\mathcal{R}$ 之间二分图的有符号关联出发：\n- 推导化学计量矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$，其中 $S_{ij}$ 是代谢物 $i$ 在反应 $j$ 中的化学计量系数，生成时 $S_{ij} > 0$，消耗时 $S_{ij}  0$。\n- 在上述方向和符号约定下，说明 $S$ 与代谢物和反应节点之间的有符号二分图关联有何关系。\n- 计算行列式 $\\det(S)$。\n\n将最终结果表示为一个精确整数。不需要四舍五入，最终答案中也不报告单位。", "solution": "用户提供了一个在系统生物学领域有科学依据的、定义明确的问题。其前提清晰、一致，并足以推导出一个唯一的解。该问题被验证为是合理的。\n\n该问题要求为给定的代谢网络片段构建化学计量矩阵 $S$ 并计算其行列式。该网络由一个代谢物集合 $\\mathcal{M} = \\{X_{1}, X_{2}, X_{3}\\}$ 和一个反应集合 $\\mathcal{R} = \\{R_{1}, R_{2}, R_{3}\\}$ 组成。\n\n化学计量矩阵 $S$ 是一个 $m \\times n$ 矩阵，其中 $m$ 是代谢物的数量， $n$ 是反应的数量。在本例中，$S$ 是一个 $3 \\times 3$ 矩阵。元素 $S_{ij}$ 表示代谢物 $i$ 在反应 $j$ 中的化学计量系数。根据约定，反应物（被消耗）的系数为负，产物（被生成）的系数为正。\n\n我们将逐列构建该矩阵，每一列对应一个反应。行将按顺序对应于代谢物 $X_1$、$X_2$ 和 $X_3$。\n\n1.  **反应 $R_{1}: X_{1} + 2 X_{2} \\rightarrow X_{3}$**\n    - 代谢物 $X_{1}$ 被消耗，化学计量系数为 $1$。因此，$S_{11} = -1$。\n    - 代谢物 $X_{2}$ 被消耗，化学计量系数为 $2$。因此，$S_{21} = -2$。\n    - 代谢物 $X_{3}$ 被生成，化学计量系数为 $1$。因此，$S_{31} = 1$。\n    $S$ 的第一列是 $\\begin{pmatrix} -1 \\\\ -2 \\\\ 1 \\end{pmatrix}$。\n\n2.  **反应 $R_{2}: X_{3} \\rightarrow X_{1}$**\n    - 代谢物 $X_{1}$ 被生成，化学计量系数为 $1$。因此，$S_{12} = 1$。\n    - 代谢物 $X_{2}$ 不参与此反应。因此，$S_{22} = 0$。\n    - 代谢物 $X_{3}$ 被消耗，化学计量系数为 $1$。因此，$S_{32} = -1$。\n    $S$ 的第二列是 $\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$。\n\n3.  **反应 $R_{3}: X_{1} \\rightarrow 2 X_{2}$**\n    - 代谢物 $X_{1}$ 被消耗，化学计量系数为 $1$。因此，$S_{13} = -1$。\n    - 代谢物 $X_{2}$ 被生成，化学计量系数为 $2$。因此，$S_{23} = 2$。\n    - 代谢物 $X_{3}$ 不参与此反应。因此，$S_{33} = 0$。\n    $S$ 的第三列是 $\\begin{pmatrix} -1 \\\\ 2 \\\\ 0 \\end{pmatrix}$。\n\n合并这些列，化学计量矩阵 $S$ 为：\n$$ S = \\begin{pmatrix} -1  1  -1 \\\\ -2  0  2 \\\\ 1  -1  0 \\end{pmatrix} $$\n\n问题还问到 $S$ 与有符号二分图关联矩阵的关系。矩阵 $S$ *就是* 代谢物集合 $\\mathcal{M}$ 和反应集合 $\\mathcal{R}$ 之间二分图的有符号加权关联矩阵。在这种表示中，节点被划分为两个集合（$\\mathcal{M}$ 和 $\\mathcal{R}$），边只存在于不同集合的节点之间。元素 $S_{ij}$ 指定了代谢物 $X_i$ 和反应 $R_j$ 之间相互作用的性质。$S_{ij}$ 的符号对应于质量流动的方向（消耗与生成），问题描述中将其与图形方向约定关联起来（从 $X_i$ 到 $R_j$ 的边表示消耗，从 $R_j$ 到 $X_i$ 的边表示生成）。$|S_{ij}|$ 的大小是相互作用的权重，对应于化学计量系数 $\\nu_{ij}$。\n\n最后，我们必须计算 $S$ 的行列式 $\\det(S)$。我们可以沿第一行使用代数余子式展开法：\n$$ \\det(S) = S_{11} \\cdot C_{11} + S_{12} \\cdot C_{12} + S_{13} \\cdot C_{13} $$\n其中 $C_{ij} = (-1)^{i+j} M_{ij}$ 是元素 $S_{ij}$ 的代数余子式，$M_{ij}$ 是其子式。\n\n$$ \\det(S) = (-1) \\cdot \\det \\begin{pmatrix} 0  2 \\\\ -1  0 \\end{pmatrix} - (1) \\cdot \\det \\begin{pmatrix} -2  2 \\\\ 1  0 \\end{pmatrix} + (-1) \\cdot \\det \\begin{pmatrix} -2  0 \\\\ 1  -1 \\end{pmatrix} $$\n\n我们计算 $2 \\times 2$ 子矩阵的行列式：\n- $\\det \\begin{pmatrix} 0  2 \\\\ -1  0 \\end{pmatrix} = (0)(0) - (2)(-1) = 2$\n- $\\det \\begin{pmatrix} -2  2 \\\\ 1  0 \\end{pmatrix} = (-2)(0) - (2)(1) = -2$\n- $\\det \\begin{pmatrix} -2  0 \\\\ 1  -1 \\end{pmatrix} = (-2)(-1) - (0)(1) = 2$\n\n将这些值代回展开式中：\n$$ \\det(S) = (-1)(2) - (1)(-2) + (-1)(2) $$\n$$ \\det(S) = -2 + 2 - 2 $$\n$$ \\det(S) = -2 $$\n\n化学计量矩阵 $S$ 的行列式是 $-2$。", "answer": "$$ \\boxed{-2} $$", "id": "4367418"}, {"introduction": "网络构建完成后，我们常常需要识别其中最重要的节点。介数中心性（betweenness centrality）通过量化一个节点出现在其他节点之间最短通信路径上的频率来衡量其重要性，因此可作为其对信息或物质流动控制能力的一个代理指标。这项练习 [@problem_id:4367423] 要求您从第一性原理出发推导这个概念，确保您能理解公式背后的逻辑，并通过具体计算来培养分析蛋白质相互作用网络或信号网络中连通性所需的算法思维。", "problem": "在系统生物医学背景下，考虑一个无向、无权的交互网络，其中节点代表生物分子实体，边代表信息可以沿其传播的直接物理或调控相互作用。设该网络被建模为一个简单图 $G=(V,E)$，其中 $|V|=n$，并将路径长度定义为所经过的边的数量。假设任意两个节点 $s,t \\in V$ 之间的信号传播仅限于测地路径，即最小长度的路径。并且，如果给定的一对节点之间存在多条测地路径，那么在没有进一步机理细节的情况下，每条测地路径作为信息通道都是同等可能的。此外，假设不同源-目标对之间的可加性，以及在保持测地结构的节点重标记下的不变性。\n\n任务 1 (推导)：从测地距离的定义和上述针对多条测地路径的对称性假设出发，推导一个介数中心性 $C_{B}(v)$ 的标量泛函。该泛函为每个 $v \\in V$ 量化了在所有穿过 $v$ 的无序源-目标对（不包括 $v$ 作为端点的情况）之间，测地路径所占的平均比例。你的推导必须 (i) 明确如何聚合来自无序对的贡献，(ii) 精确说明如何处理同一对节点之间的多条测地路径，以及 (iii) 展示一种通过对所有不涉及 $v$ 的无序对进行平均，将该量缩放到单位区间的归一化方法。\n\n任务 2 (应用)：将你推导出的表达式应用于以下具有节点集 $V=\\{A,B,C,D,E,F\\}$ 和边集\n$$\nE=\\{ \\{A,B\\},\\{A,C\\},\\{B,C\\},\\{B,D\\},\\{C,D\\},\\{C,E\\},\\{D,E\\},\\{E,F\\},\\{B,F\\} \\}\n$$\n的无向、无权交互网络。计算标记为 $C$ 的节点（在你的推导中用 $v^{\\star}$ 表示此节点）的归一化介数中心性。将你的最终数值表示为一个精确的有理数。不要包含任何单位。", "solution": "该问题分为两部分：首先，推导归一化的介数中心性泛函；其次，将其应用于一个特定的网络。问题陈述具有科学依据，提法恰当且客观。它基于图论在系统生物医学中应用的既定原则。所有提供的信息都是自洽和一致的。因此，该问题被认为是有效的。\n\n### 任务 1：归一化介数中心性的推导\n\n设 $G=(V,E)$ 是一个有 $|V|=n$ 个节点和 $|E|$ 条边的简单、无向、无权图。两个节点 $s, t \\in V$ 之间的距离 $d(s,t)$ 是它们之间最短路径（或测地路径）的长度，其中长度是边的数量。\n\n设 $\\sigma_{st}$ 是节点 $s$ 和节点 $t$ 之间不同测地路径的总数。设 $\\sigma_{st}(v)$ 是这些测地路径中经过中间节点 $v \\in V$ (其中 $v \\neq s$ 且 $v \\neq t$) 的数量。\n\n问题陈述所有测地路径作为信息通道是同等可能的。因此，$s$ 和 $t$ 之间通过 $v$ 的测地路径介导的通信比例由比率 $\\frac{\\sigma_{st}(v)}{\\sigma_{st}}$ 给出。如果 $s$ 和 $t$ 之间没有路径，则 $\\sigma_{st}=0$，此贡献定义为 $0$。\n\n节点 $v$ 的介数中心性量化了它在连接网络中其他节点方面的重要性。它通过聚合来自所有可能的源和目标节点对的分数贡献来定义。问题指定聚合应针对所有不以 $v$ 为端点的“无序源-目标对”。一个无序对是两个不同节点的集合 $\\{s,t\\}$。$v$ 不是端点的条件意味着 $s \\neq v$ 且 $t \\neq v$。因此，我们必须对所有对 $\\{s,t\\} \\subseteq V \\setminus \\{v\\}$ 进行求和。\n\n未归一化的介数中心性，我们记为 $C'_{B}(v)$，是这些分数贡献的总和：\n$$\nC'_{B}(v) = \\sum_{\\{s,t\\} \\subseteq V \\setminus \\{v\\}} \\frac{\\sigma_{st}(v)}{\\sigma_{st}}\n$$\n为了计算，这个和可以更明确地写成遍历所有满足 $s \\neq v$, $t \\neq v$ 且 $s \\neq t$ 的不同节点 $s, t \\in V$，并考虑到每个无序对 $\\{s,t\\}$ 在对所有有序对 $(s,t)$ 和 $(t,s)$ 的求和中被计算了两次。由于图是无向的，$\\sigma_{st} = \\sigma_{ts}$ 且 $\\sigma_{st}(v) = \\sigma_{ts}(v)$。我们可以通过对唯一对求和来写出（例如，通过对节点施加任意顺序）：\n$$\nC'_{B}(v) = \\sum_{s, t \\in V, s  t, s \\neq v, t \\neq v} \\frac{\\sigma_{st}(v)}{\\sigma_{st}}\n$$\n一个节点 $v$ 位于 $s$ 和 $t$ 之间的测地路径上，当且仅当距离上的三角不等式变为等式：$d(s,t) = d(s,v) + d(v,t)$。在这种情况下，从 $s$ 到 $t$ 经过 $v$ 的测地路径数量是从 $s$ 到 $v$ 的测地路径数量与从 $v$ 到 $t$ 的测地路径数量的乘积，即 $\\sigma_{st}(v) = \\sigma_{sv} \\cdot \\sigma_{vt}$。\n\n问题要求通过“对所有不涉及 $v$ 的无序对进行平均”来进行归一化。不包括 $v$ 的节点集是 $V \\setminus \\{v\\}$，其大小为 $n-1$。该集合中不同节点的无序对的总数由二项式系数给出：\n$$\nN_v = \\binom{n-1}{2} = \\frac{(n-1)(n-2)}{2}\n$$\n这是 $C'_{B}(v)$ 求和中的项数。为了求平均值，我们将总和除以项数。这就得到了归一化的介数中心性 $C_{B}(v)$：\n$$\nC_{B}(v) = \\frac{C'_{B}(v)}{N_v} = \\frac{1}{\\binom{n-1}{2}} \\sum_{\\{s,t\\} \\subseteq V \\setminus \\{v\\}} \\frac{\\sigma_{st}(v)}{\\sigma_{st}}\n$$\n这就是所要求的标量泛函。它适当地聚合了来自无序对的贡献，通过比率 $\\sigma_{st}(v)/\\sigma_{st}$ 处理了多条测地路径，并按所考虑的对的数量进行了归一化，正如所指定的那样。\n\n### 任务 2：应用\n\n给定网络的节点集为 $V=\\{A,B,C,D,E,F\\}$，因此 $n=6$。边集为 $E=\\{ \\{A,B\\},\\{A,C\\},\\{B,C\\},\\{B,D\\},\\{C,D\\},\\{C,E\\},\\{D,E\\},\\{E,F\\},\\{B,F\\} \\}$。我们必须计算节点 $v^{\\star}=C$ 的归一化介数中心性。\n\n归一化因子是 $\\frac{1}{\\binom{n-1}{2}} = \\frac{1}{\\binom{6-1}{2}} = \\frac{1}{\\binom{5}{2}} = \\frac{1}{10}$。\n\n需要考虑的节点对集合是 $\\{s,t\\} \\subseteq V \\setminus \\{C\\} = \\{A,B,D,E,F\\}$。共有 $\\binom{5}{2}=10$ 对这样的节点对。我们必须为每一对计算贡献 $\\frac{\\sigma_{st}(C)}{\\sigma_{st}}$。仅当 $C$ 位于 $s$ 和 $t$ 之间的测地路径上时，贡献才非零，这意味着 $d(s,t) = d(s,C) + d(t,C)$。\n\n首先，我们确定所有相关节点到 $C$ 的最短路径距离：\n从 $C$ 开始使用广度优先搜索 (BFS)：\n- 层 0：$\\{C\\}$\n- 层 1：$C$ 的邻居是 $\\{A,B,D,E\\}$。所以，$d(A,C)=1$, $d(B,C)=1$, $d(D,C)=1$, $d(E,C)=1$。\n- 层 2：层 1 节点的邻居（不包括已访问过的）。从 $B$ 可以到达 $F$。从 $E$ 可以到达 $F$。所以，$d(F,C)=2$。路径是 $(C,B,F)$ 和 $(C,E,F)$。\n\n接下来，我们分析 $\\{A,B,D,E,F\\}$ 中的 10 对节点 $\\{s,t\\}$ 中的每一对：\n\n1.  节点对 $\\{A,B\\}$：$d(A,B)=1$ (直接相连)。$d(A,C)+d(B,C)=1+1=2 \\neq 1$。贡献为 $0$。\n2.  节点对 $\\{A,D\\}$：从 $A$ 到 $D$ 的最短路径长度为 $2$：$(A,B,D)$ 和 $(A,C,D)$。所以，$\\sigma_{AD}=2$。由于 $d(A,C)+d(D,C)=1+1=2=d(A,D)$，经过 $C$ 的路径是测地路径。路径 $(A,C,D)$ 是两条测地路径之一。因此，$\\sigma_{AD}(C)=1$。贡献是 $\\frac{1}{2}$。\n3.  节点对 $\\{A,E\\}$：从 $A$ 到 $E$ 的唯一最短路径是 $(A,C,E)$，长度为 $2$。所以，$\\sigma_{AE}=1$。我们检查 $d(A,C)+d(E,C)=1+1=2=d(A,E)$。经过 $C$ 的路径是测地路径。因此，$\\sigma_{AE}(C)=1$。贡献是 $\\frac{1}{1}=1$。\n4.  节点对 $\\{A,F\\}$：从 $A$ 到 $F$ 的唯一最短路径是 $(A,B,F)$，长度为 $2$。所以，$d(A,F)=2$。我们检查 $d(A,C)+d(F,C)=1+2=3 \\neq 2$。没有从 $A$ 到 $F$ 的测地路径经过 $C$。贡献为 $0$。\n5.  节点对 $\\{B,D\\}$：$d(B,D)=1$。$d(B,C)+d(D,C)=1+1=2 \\neq 1$。贡献为 $0$。\n6.  节点对 $\\{B,E\\}$：从 $B$ 到 $E$ 的最短路径长度为 $2$。通过观察，这些路径是 $(B,C,E)$、$(B,D,E)$ 和 $(B,F,E)$。所以，$\\sigma_{BE}=3$。我们检查 $d(B,C)+d(E,C)=1+1=2=d(B,E)$。路径 $(B,C,E)$ 是测地路径。因此，$\\sigma_{BE}(C)=1$。贡献是 $\\frac{1}{3}$。\n7.  节点对 $\\{B,F\\}$：$d(B,F)=1$。$d(B,C)+d(F,C)=1+2=3 \\neq 1$。贡献为 $0$。\n8.  节点对 $\\{D,E\\}$：$d(D,E)=1$。$d(D,C)+d(E,C)=1+1=2 \\neq 1$。贡献为 $0$。\n9.  节点对 $\\{D,F\\}$：从 $D$ 到 $F$ 的最短路径长度为 $2$：$(D,B,F)$ 和 $(D,E,F)$。所以，$d(D,F)=2$。我们检查 $d(D,C)+d(F,C)=1+2=3 \\neq 2$。没有测地路径经过 $C$。贡献为 $0$。\n10. 节点对 $\\{E,F\\}$：$d(E,F)=1$。$d(E,C)+d(F,C)=1+2=3 \\neq 1$。贡献为 $0$。\n\n现在，我们将非零贡献相加，以求得未归一化的中心性 $C'_{B}(C)$：\n$$\nC'_{B}(C) = \\frac{1}{2} + 1 + \\frac{1}{3} = \\frac{3}{6} + \\frac{6}{6} + \\frac{2}{6} = \\frac{11}{6}\n$$\n最后，我们应用归一化因子：\n$$\nC_{B}(C) = \\frac{1}{10} \\cdot C'_{B}(C) = \\frac{1}{10} \\cdot \\frac{11}{6} = \\frac{11}{60}\n$$\n节点 $C$ 的归一化介数中心性是 $\\frac{11}{60}$。", "answer": "$$\\boxed{\\frac{11}{60}}$$", "id": "4367423"}, {"introduction": "生物网络很少是随机的，它们常常表现出模块化或社群结构，即节点在模块内部的连接比与网络其余部分的连接更为密集。模块度（modularity）是识别和评估这些社群结构的关键指标，它将观测到的社群内部边的权重与一个随机网络模型中的期望值进行比较。这项练习 [@problem_id:4367489] 将挑战您把模块度的概念推广到更真实的加权有向网络，如基因调控网络，掌握这一技能将帮助您揭示复杂生物系统的高阶组织结构。", "problem": "一个系统生物医学团队将一个小型基因调控网络 (GRN) 建模为一个加权有向网络，以研究三个转录因子之间的转录影响。节点代表基因，有向边代表调控影响，其强度与结合亲和力和转录效应成正比。设加权有向邻接矩阵为 $\\{W_{ij}\\}$，节点集为 $\\{1,2,3\\}$，非零元素为 $W_{12}=5$、$W_{21}=1$、$W_{23}=4$ 和 $W_{31}=2$，所有其他 $W_{ij}=0$。总边权重为 $m=\\sum_{i=1}^{3}\\sum_{j=1}^{3}W_{ij}$。\n\n从有向加权图的基本网络定义和保留入强度与出强度序列的配置模型零模型出发，推导一个适用于加权有向网络的模块度函数 $Q$。该函数用观测权重 $W_{ij}$、总权重 $m$、出强度 $k_{i}^{\\mathrm{out}}=\\sum_{j}W_{ij}$、入强度 $k_{j}^{\\mathrm{in}}=\\sum_{i}W_{ij}$ 以及社群指示符 $\\delta(c_{i},c_{j})$ 表示，其中当节点 $i$ 和 $j$ 属于同一社群时 $\\delta(c_{i},c_{j})=1$，否则为 $0$。\n\n然后，对于社群分配 $c_{1}=c_{2}\\neq c_{3}$（社群 $A=\\{1,2\\}$，社群 $B=\\{3\\}$），精确计算模块度 $Q$。将你的最终答案表示为一个精确值。不需要四舍五入。", "solution": "目标是为加权有向网络构建一个模块度 $Q$，该模块度衡量相对于一个有原则的零模型，社群内部权重的超出部分。标准基础是无权无向网络的模块度概念，它将观测到的边与在保留度序列的配置模型零模型下预期的边进行比较。为了推广到加权有向网络，我们用强度替换度，并将度（强度）分解为出强度和入强度，以体现方向性。\n\n我们从核心定义开始。一个加权有向网络由一个权重矩阵 $\\{W_{ij}\\}$ 来表征，其中 $W_{ij}\\geq 0$ 表示从节点 $i$ 到节点 $j$ 的有向边的强度。节点 $i$ 的出强度定义为\n$$\nk_{i}^{\\mathrm{out}}=\\sum_{j}W_{ij},\n$$\n节点 $j$ 的入强度定义为\n$$\nk_{j}^{\\mathrm{in}}=\\sum_{i}W_{ij}.\n$$\n网络中的总权重为\n$$\nm=\\sum_{i}\\sum_{j}W_{ij}=\\sum_{i}k_{i}^{\\mathrm{out}}=\\sum_{j}k_{j}^{\\mathrm{in}},\n$$\n该等式成立，因为离开一个节点（出强度）的每一个单位权重都会到达某个节点（入强度）。\n\n为了构建零模型，我们使用有向加权配置模型，该模型保留了序列 $\\{k_{i}^{\\mathrm{out}}\\}$ 和 $\\{k_{j}^{\\mathrm{in}}\\}$。将节点 $i$ 的出强度 $k_{i}^{\\mathrm{out}}$ 视为待分配到目标节点的权重单位。在零模型下，来自节点 $i$ 的每个单位的出权重按入强度比例选择其目标，也就是说，来自 $i$ 的一个单位权重落在节点 $j$ 上的概率与 $k_{j}^{\\mathrm{in}}$ 成正比。通过总权重 $m$ 进行归一化，从 $i$ 出发的权重落在 $j$ 上的预期比例是 $\\frac{k_{j}^{\\mathrm{in}}}{m}$。因此，在零模型下从 $i$ 到 $j$ 的预期权重是\n$$\n\\mathbb{E}[W_{ij}]=k_{i}^{\\mathrm{out}}\\cdot\\frac{k_{j}^{\\mathrm{in}}}{m}=\\frac{k_{i}^{\\mathrm{out}}k_{j}^{\\mathrm{in}}}{m}.\n$$\n这在期望上同时保留了出强度和入强度：\n$$\n\\sum_{j}\\mathbb{E}[W_{ij}]=\\sum_{j}\\frac{k_{i}^{\\mathrm{out}}k_{j}^{\\mathrm{in}}}{m}=k_{i}^{\\mathrm{out}}\\cdot\\frac{\\sum_{j}k_{j}^{\\mathrm{in}}}{m}=k_{i}^{\\mathrm{out}},\n$$\n同样地，\n$$\n\\sum_{i}\\mathbb{E}[W_{ij}]=\\sum_{i}\\frac{k_{i}^{\\mathrm{out}}k_{j}^{\\mathrm{in}}}{m}=k_{j}^{\\mathrm{in}}\\cdot\\frac{\\sum_{i}k_{i}^{\\mathrm{out}}}{m}=k_{j}^{\\mathrm{in}}.\n$$\n\n有了这个零模型，加权有向网络的模块度定义为比较观测到的社群内部权重与其期望值：\n$$\nQ=\\frac{1}{m}\\sum_{i}\\sum_{j}\\left(W_{ij}-\\frac{k_{i}^{\\mathrm{out}}k_{j}^{\\mathrm{in}}}{m}\\right)\\delta(c_{i},c_{j}).\n$$\n当权重为二元且忽略方向时，该表达式可简化为广泛使用的无向无权情况，但在这里，它通过使用 $k_{i}^{\\mathrm{out}}$ 和 $k_{j}^{\\mathrm{in}}$ 正确地考虑了权重和方向性。\n\n接下来，我们为给定的网络和社群分配计算 $Q$。非零权重为 $W_{12}=5$、$W_{21}=1$、$W_{23}=4$、$W_{31}=2$，所有其他 $W_{ij}=0$。总权重为\n$$\nm=W_{12}+W_{21}+W_{23}+W_{31}=5+1+4+2=12.\n$$\n计算出强度：\n$$\nk_{1}^{\\mathrm{out}}=W_{12}+W_{13}=5+0=5,\\quad k_{2}^{\\mathrm{out}}=W_{21}+W_{23}=1+4=5,\\quad k_{3}^{\\mathrm{out}}=W_{31}+W_{32}=2+0=2.\n$$\n计算入强度：\n$$\nk_{1}^{\\mathrm{in}}=W_{21}+W_{31}=1+2=3,\\quad k_{2}^{\\mathrm{in}}=W_{12}+W_{32}=5+0=5,\\quad k_{3}^{\\mathrm{in}}=W_{13}+W_{23}=0+4=4.\n$$\n\n社群分配为 $c_{1}=c_{2}\\neq c_{3}$，因此由 $\\delta(c_{i},c_{j})$ 计数的点对是社群 $A=\\{1,2\\}$ 内的 $(1,1)$、$(1,2)$、$(2,1)$、$(2,2)$ 和社群 $B=\\{3\\}$ 内的 $(3,3)$。我们计算每一项 $\\left(W_{ij}-\\frac{k_{i}^{\\mathrm{out}}k_{j}^{\\mathrm{in}}}{m}\\right)$：\n\n在社群 $A$ 内：\n- 对于 $(1,1)$：$W_{11}=0$，预期权重 $\\frac{k_{1}^{\\mathrm{out}}k_{1}^{\\mathrm{in}}}{m}=\\frac{5\\cdot 3}{12}=\\frac{15}{12}$，因此贡献为 $0-\\frac{15}{12}=-\\frac{5}{4}$。\n- 对于 $(1,2)$：$W_{12}=5$，预期权重 $\\frac{k_{1}^{\\mathrm{out}}k_{2}^{\\mathrm{in}}}{m}=\\frac{5\\cdot 5}{12}=\\frac{25}{12}$，因此贡献为 $5-\\frac{25}{12}=\\frac{35}{12}$。\n- 对于 $(2,1)$：$W_{21}=1$，预期权重 $\\frac{k_{2}^{\\mathrm{out}}k_{1}^{\\mathrm{in}}}{m}=\\frac{5\\cdot 3}{12}=\\frac{15}{12}$，因此贡献为 $1-\\frac{15}{12}=-\\frac{1}{4}$。\n- 对于 $(2,2)$：$W_{22}=0$，预期权重 $\\frac{k_{2}^{\\mathrm{out}}k_{2}^{\\mathrm{in}}}{m}=\\frac{5\\cdot 5}{12}=\\frac{25}{12}$，因此贡献为 $0-\\frac{25}{12}=-\\frac{25}{12}$。\n\n将社群 $A$ 的这四个贡献相加：\n$$\n-\\frac{5}{4}+\\frac{35}{12}-\\frac{1}{4}-\\frac{25}{12}=\\left(-\\frac{15}{12}+\\frac{35}{12}-\\frac{3}{12}-\\frac{25}{12}\\right)=\\frac{-8}{12}=-\\frac{2}{3}.\n$$\n\n在社群 $B$ 内：\n- 对于 $(3,3)$：$W_{33}=0$，预期权重 $\\frac{k_{3}^{\\mathrm{out}}k_{3}^{\\mathrm{in}}}{m}=\\frac{2\\cdot 4}{12}=\\frac{8}{12}$，因此贡献为 $0-\\frac{8}{12}=-\\frac{2}{3}$。\n\n将两个社群的社群内贡献相加得到\n$$\n-\\frac{2}{3}+(-\\frac{2}{3})=-\\frac{4}{3}.\n$$\n因此，\n$$\nQ=\\frac{1}{m}\\left(-\\frac{4}{3}\\right)=\\frac{1}{12}\\left(-\\frac{4}{3}\\right)=-\\frac{4}{36}=-\\frac{1}{9}.\n$$\n\n因此，对于指定的加权有向网络和划分，广义模块度的精确值为 $-\\frac{1}{9}$。", "answer": "$$\\boxed{-\\frac{1}{9}}$$", "id": "4367489"}]}