{"hands_on_practices": [{"introduction": "在系统生物医学中，来自电子健康记录（EHR）等来源的观察性数据非常普遍，但它们很容易受到混杂因素的干扰。本练习探讨了辛普森悖论（Simpson's paradox），这是一种在汇总数据中观察到的关联趋势在分组数据中发生逆转的现象 [@problem_id:4318462]。通过应用全概率定律，本练习将演示如何正确地对混杂变量进行调整，从而揭示真实的效应；掌握这一概念对于批判性地解读观察性研究结果和避免在临床及生物学研究中得出虚假结论至关重要。", "problem": "一个医院系统正在评估一项靶向治疗在脓毒症患者的观察性电子健康记录（EHR; Electronic Health Records）数据中的效果。令 $X \\in \\{0,1\\}$ 表示治疗分配，其中 $X=1$ 表示靶向治疗，$X=0$ 表示标准护理。令 $Y \\in \\{0,1\\}$ 表示30天死亡率，其中 $Y=1$ 表示死亡。一个综合严重程度指数 $Z \\in \\{\\mathrm{L}, \\mathrm{H}\\}$，取值为 $\\mathrm{L}$ 表示低严重程度，$\\mathrm{H}$ 表示高严重程度，是一个潜在的混杂因素，因为严重程度与治疗决策和死亡率都有关联。\n\n估计得到以下观察概率：\n- 在每个严重程度分层内：\n  - $P(Y=1 \\mid X=1, Z=\\mathrm{L}) = 0.04$, $P(Y=1 \\mid X=0, Z=\\mathrm{L}) = 0.05$。\n  - $P(Y=1 \\mid X=1, Z=\\mathrm{H}) = 0.20$, $P(Y=1 \\mid X=0, Z=\\mathrm{H}) = 0.24$。\n- 严重程度的分布因治疗组而异：\n  - $P(Z=\\mathrm{H} \\mid X=1) = 0.90$, $P(Z=\\mathrm{L} \\mid X=1) = 0.10$。\n  - $P(Z=\\mathrm{H} \\mid X=0) = 0.10$, $P(Z=\\mathrm{L} \\mid X=0) = 0.90$。\n\n仅使用条件概率的基本定义和全概率定律，完成以下任务：\n1. 从定义 $P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$ 和全概率定律出发，推导一个用严重程度分层内的条件死亡率 $P(Y=1 \\mid X=x, Z=z)$ 和严重程度分布 $P(Z=z \\mid X=x)$ 来表示汇总死亡率 $P(Y=1 \\mid X=x)$ 的表达式，其中 $x \\in \\{0,1\\}$ 且 $z \\in \\{\\mathrm{L}, \\mathrm{H}\\}$。\n2. 从数学上解释为什么对 $Z$ 进行汇总会产生相对于分层比较的逆转（辛普森悖论），并指出 $P(Z=z \\mid X=x)$ 在这种逆转中的作用。\n3. 计算汇总风险差\n$$\\mathrm{RD} = P(Y=1 \\mid X=1) - P(Y=1 \\mid X=0),$$\n使用上述数值。将 $\\mathrm{RD}$ 的最终数值以精确分数形式给出。不要四舍五入。最终答案不带单位和百分号。", "solution": "该问题提法明确，具有科学依据，并提供了进行推导所需的所有信息。其目标是分析靶向治疗对死亡率的影响，同时考虑一个混杂变量，这是条件概率在生物统计学中的一个经典应用。\n\n根据题目要求，解答分为三个部分。首先，我们推导汇总死亡率的公式。其次，我们解释在此背景下辛普森悖论的机制。第三，我们使用所提供的数值计算汇总风险差。\n\n1. 汇总死亡率表达式的推导\n\n令 $Y \\in \\{0,1\\}$ 为死亡结局，$X \\in \\{0,1\\}$ 为治疗分配，$Z \\in \\{\\mathrm{L}, \\mathrm{H}\\}$ 为严重程度分层。我们需要为给定治疗组 $x \\in \\{0,1\\}$ 推导汇总死亡率 $P(Y=1 \\mid X=x)$ 的表达式。\n\n推导从条件概率的定义和全概率定律开始。条件概率的定义表明，对于任意两个事件 $A$ 和 $B$，当 $P(B)  0$ 时，我们有 $P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$。\n令事件 $A$ 为 $\\{Y=1\\}$，事件 $B$ 为 $\\{X=x\\}$。我们想求 $P(Y=1 \\mid X=x) = \\frac{P(Y=1 \\cap X=x)}{P(X=x)}$。\n\n全概率定律允许我们通过考虑样本空间的一个划分来计算一个事件的概率。严重程度指数 $Z$ 将患者群体划分为两个不相交的集合：低严重程度者 ($Z=\\mathrm{L}$) 和高严重程度者 ($Z=\\mathrm{H}$)。我们可以对联合事件 $\\{Y=1 \\cap X=x\\}$ 应用全概率定律：\n$$P(Y=1 \\cap X=x) = P(Y=1 \\cap X=x \\cap Z=\\mathrm{L}) + P(Y=1 \\cap X=x \\cap Z=\\mathrm{H})$$\n这可以写成求和形式：\n$$P(Y=1 \\cap X=x) = \\sum_{z \\in \\{\\mathrm{L}, \\mathrm{H}\\}} P(Y=1, X=x, Z=z)$$\n现在，我们使用概率的链式法则，它是条件概率定义的重复应用：$P(E_1 \\cap E_2 \\cap E_3) = P(E_1 \\mid E_2 \\cap E_3) P(E_2 \\cap E_3) = P(E_1 \\mid E_2 \\cap E_3) P(E_2 \\mid E_3) P(E_3)$。\n在我们的记法中，对于一个特定的分层 $z$：\n$$P(Y=1, X=x, Z=z) = P(Y=1 \\mid X=x, Z=z) P(X=x, Z=z)$$\n我们可以使用条件概率的定义将 $P(X=x, Z=z)$ 项进一步展开为 $P(Z=z \\mid X=x) P(X=x)$。将其代入，我们得到：\n$$P(Y=1, X=x, Z=z) = P(Y=1 \\mid X=x, Z=z) P(Z=z \\mid X=x) P(X=x)$$\n现在我们将其代回求和式中：\n$$P(Y=1 \\cap X=x) = \\sum_{z \\in \\{\\mathrm{L}, \\mathrm{H}\\}} P(Y=1 \\mid X=x, Z=z) P(Z=z \\mid X=x) P(X=x)$$\n由于 $P(X=x)$ 是求和式中的一个公因子，我们可以将其提取出来：\n$$P(Y=1 \\cap X=x) = P(X=x) \\sum_{z \\in \\{\\mathrm{L}, \\mathrm{H}\\}} P(Y=1 \\mid X=x, Z=z) P(Z=z \\mid X=x)$$\n最后，我们将此表达式代入我们最初的 $P(Y=1 \\mid X=x)$ 定义中的分子：\n$$P(Y=1 \\mid X=x) = \\frac{P(X=x) \\sum_{z \\in \\{\\mathrm{L}, \\mathrm{H}\\}} P(Y=1 \\mid X=x, Z=z) P(Z=z \\mid X=x)}{P(X=x)}$$\n假设每个治疗组非空，即 $P(X=x)  0$，我们可以从分子和分母中消去这一项，得到所需的表达式：\n$$P(Y=1 \\mid X=x) = \\sum_{z \\in \\{\\mathrm{L}, \\mathrm{H}\\}} P(Y=1 \\mid X=x, Z=z) P(Z=z \\mid X=x)$$\n该表达式表明，一个治疗组的汇总（边际）死亡风险是各分层特异性风险的加权平均，其中权重是给定治疗条件下，处于每个分层的概率。\n\n2. 辛普森悖论的数学解释\n\n辛普森悖论是一种现象，其中在几个不同数据组中观察到的趋势或关联在这些组合并后消失或逆转。在本问题中，关联存在于治疗 $X$ 和死亡率 $Y$ 之间，而组是严重程度分层 $Z$。\n\n首先，让我们检查分层风险差：\n对于低严重程度分层 ($Z=\\mathrm{L}$)：\n$$\\mathrm{RD}_{\\mathrm{L}} = P(Y=1 \\mid X=1, Z=\\mathrm{L}) - P(Y=1 \\mid X=0, Z=\\mathrm{L}) = 0.04 - 0.05 = -0.01$$\n对于高严重程度分层 ($Z=\\mathrm{H}$)：\n$$\\mathrm{RD}_{\\mathrm{H}} = P(Y=1 \\mid X=1, Z=\\mathrm{H}) - P(Y=1 \\mid X=0, Z=\\mathrm{H}) = 0.20 - 0.24 = -0.04$$\n在两个分层中，风险差都是负数，表明与标准护理 ($X=0$) 相比，靶向治疗 ($X=1$) 与较低的死亡风险相关。\n\n当我们对混杂因素 $Z$ 进行汇总时，悖论就出现了。汇总风险差为 $\\mathrm{RD} = P(Y=1 \\mid X=1) - P(Y=1 \\mid X=0)$。使用第1部分的公式，我们将 $P(Y=1 \\mid X=x)$ 写成加权和：\n$$P(Y=1 \\mid X=x) = P(Y=1 \\mid X=x, Z=\\mathrm{L})P(Z=\\mathrm{L} \\mid X=x) + P(Y=1 \\mid X=x, Z=\\mathrm{H})P(Z=\\mathrm{H} \\mid X=x)$$\n关联的逆转是由加权因子 $P(Z=z \\mid X=x)$ 引起的。这些因子代表了每个治疗组 $X=x$ 内混杂因素 $Z$ 的分布。如果混杂因素与治疗和结果都相关，就可能发生逆转。在这里，$Z$ 是一个混杂因素，因为：\n1.  它与结果 $Y$ 相关：无论采用何种治疗，高严重程度组的死亡率（$0.20$ 和 $0.24$）都高于低严重程度组（$0.04$ 和 $0.05$）。\n2.  它与治疗 $X$ 相关：严重程度的分布在不同治疗组之间存在差异。具体来说，$P(Z=\\mathrm{H} \\mid X=1) = 0.90$，而 $P(Z=\\mathrm{H} \\mid X=0) = 0.10$。\n\n这意味着接受靶向治疗 ($X=1$) 的患者更有可能处于高严重程度组 ($90\\%$)，而接受标准护理 ($X=0$) 的患者则更有可能处于低严重程度组 ($90\\%$)。这是观察性研究中的一个典型情景，医生可能优先为病情更重的患者提供更新、更具侵入性或实验性的治疗。\n\n接受治疗组的汇总死亡率 $P(Y=1 \\mid X=1)$，是低风险 ($0.04$) 和高风险 ($0.20$) 的加权平均，但对高风险的权重很大 ($0.90$)。\n$$P(Y=1 \\mid X=1) = (0.04)(0.10) + (0.20)(0.90)$$\n相反，对照组的汇总死亡率 $P(Y=1 \\mid X=0)$，是其相应风险 ($0.05$ 和 $0.24$) 的加权平均，但对低风险的权重很大 ($0.90$)。\n$$P(Y=1 \\mid X=0) = (0.05)(0.90) + (0.24)(0.10)$$\n因此，$P(Y=1 \\mid X=1)$ 与 $P(Y=1 \\mid X=0)$ 的比较，是主要为高风险群体与主要为低风险群体之间的比较。这种由严重程度引起的混杂很容易掩盖治疗在每个分层内的真正有益效果，从而导致在汇总层面得出相反的结论。\n\n3. 汇总风险差的计算\n\n我们使用推导出的公式和给定的数值来计算每个治疗组的汇总死亡率。\n\n对于靶向治疗组 ($X=1$)：\n$$P(Y=1 \\mid X=1) = P(Y=1 \\mid X=1, Z=\\mathrm{L})P(Z=\\mathrm{L} \\mid X=1) + P(Y=1 \\mid X=1, Z=\\mathrm{H})P(Z=\\mathrm{H} \\mid X=1)$$\n$$P(Y=1 \\mid X=1) = (0.04)(0.10) + (0.20)(0.90)$$\n$$P(Y=1 \\mid X=1) = 0.004 + 0.180 = 0.184$$\n\n对于标准护理组 ($X=0$)：\n$$P(Y=1 \\mid X=0) = P(Y=1 \\mid X=0, Z=\\mathrm{L})P(Z=\\mathrm{L} \\mid X=0) + P(Y=1 \\mid X=0, Z=\\mathrm{H})P(Z=\\mathrm{H} \\mid X=0)$$\n$$P(Y=1 \\mid X=0) = (0.05)(0.90) + (0.24)(0.10)$$\n$$P(Y=1 \\mid X=0) = 0.045 + 0.024 = 0.069$$\n\n汇总风险差为：\n$$\\mathrm{RD} = P(Y=1 \\mid X=1) - P(Y=1 \\mid X=0) = 0.184 - 0.069 = 0.115$$\n汇总风险差为正，表明靶向治疗与更高的死亡风险相关。这与从分层特异性分析得出的结论相反，证实了辛普森悖论的存在。\n\n要将其表示为精确分数：\n$$0.115 = \\frac{115}{1000}$$\n我们可以通过将分子和分母除以它们的最大公约数 5 来简化此分数：\n$$\\mathrm{RD} = \\frac{115 \\div 5}{1000 \\div 5} = \\frac{23}{200}$$\n由于 23 是一个质数且 $200 = 2^3 \\cdot 5^2$，该分数已完全简化。", "answer": "$$\\boxed{\\frac{23}{200}}$$", "id": "4318462"}, {"introduction": "生物医学数据通常具有层级结构，例如来自不同医院的患者或在不同实验室进行的实验，而我们常常希望在利用更广泛群体信息的同时，对某个特定群体进行推断。本练习使用Beta-二项共轭模型来推导后验预测分布，并明确展示贝叶斯推断如何自然地产生“部分池化”（partial pooling）效应 [@problem_id:4318486]。这个练习揭示了贝叶斯层级建模的一个关键优势：通过向其他群体“借力”，即使在某个群体数据有限的情况下，也能做出更稳定和稳健的估计。", "problem": "一个由多家医院的系统生物医学实验室组成的联盟，正在使用定量聚合酶链式反应 (qPCR) 监测直肠拭子中某种特定抗生素耐药基因的携带情况。在任何一家医院 $j$ 中，某一天患者层面的携带结果被建模为可交换的伯努利试验，其未知的潜在流行率为 $\\theta_{j} \\in (0,1)$。跨医院间，潜在流行率 $\\theta_{j}$ 被假定来自于一个共同的群体水平分布，该分布编码了医院间的异质性。\n\n假设先前对多家医院进行的一项荟萃分析，为潜在流行率提供了一个具有科学依据的群体水平先验，即一个超参数为 $\\alpha$ 和 $\\beta$ 的贝塔分布，也就是说 $\\theta_{j} \\sim \\operatorname{Beta}(\\alpha,\\beta)$。在某一天，于特定医院 $j^{\\star}$，处理了 $n$ 个独立同分布的患者拭子，其中 $x$ 个样本的耐药基因检测呈阳性。在医院 $j^{\\star}$ 的贝塔-二项可交换模型下，通过对潜在流行率 $\\theta_{j^{\\star}}$ 进行积分，从第一性原理推导该医院下一次伯努利试验 $Y_{\\text{next}} \\in \\{0,1\\}$ 的后验预测分布。明确展示部分池化是如何从该积分中以医院特定的经验比例和群体水平的先验均值的凸组合形式出现的。\n\n为了进行具体计算，对医院 $j^{\\star}$ 取 $\\alpha = 1.5$，$\\beta = 6.5$, $n = 12$ 和 $x = 7$。在此模型下，计算后验预测概率 $\\mathbb{P}(Y_{\\text{next}} = 1 \\mid \\text{来自 } j^{\\star} \\text{ 的数据})$。将最终概率表示为小数，并将答案四舍五入到四位有效数字。", "solution": "该问题是良定的，在贝叶斯统计及其在系统生物医学中的应用框架内具有科学依据，并为获得唯一解提供了所有必要信息。\n\n令 $\\theta_{j^{\\star}} \\in (0,1)$ 代表特定医院 $j^{\\star}$ 中抗生素耐药基因的潜在流行率。为方便起见，我们将其简记为 $\\theta$。该问题提供了一个分层模型结构。\n\n首先，我们定义潜在流行率 $\\theta$ 的先验分布。根据先前的荟萃分析，该先验分布为一个超参数为 $\\alpha$ 和 $\\beta$ 的贝塔分布。其先验概率密度函数 (PDF) 为：\n$$\np(\\theta) = \\operatorname{Beta}(\\theta; \\alpha, \\beta) = \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)}\n$$\n其中 $B(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$ 是贝塔函数。\n\n其次，我们定义在给定潜在流行率 $\\theta$ 的条件下观测到数据的似然。数据包含 $n$ 个独立同分布 (i.i.d.) 的患者拭子，这些拭子被建模为可交换的伯努利试验。在 $n$ 次试验中，阳性拭子的数量 $x$ 服从二项分布。似然函数为：\n$$\np(x \\mid n, \\theta) = \\binom{n}{x} \\theta^x (1-\\theta)^{n-x}\n$$\n为简洁起见，我们将观测数据记为 $D = \\{x, n\\}$。\n\n要推导后验预测分布，我们必须首先求出给定数据 $D$ 后 $\\theta$ 的后验分布。根据贝叶斯定理，后验概率密度函数 $p(\\theta \\mid D)$ 与似然和先验的乘积成正比：\n$$\np(\\theta \\mid D) \\propto p(D \\mid \\theta) p(\\theta)\n$$\n代入似然和先验的表达式：\n$$\np(\\theta \\mid D) \\propto \\left[ \\binom{n}{x} \\theta^x (1-\\theta)^{n-x} \\right] \\left[ \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)} \\right]\n$$\n由于 $\\binom{n}{x}$ 和 $B(\\alpha, \\beta)$ 是关于 $\\theta$ 的常数，我们可以合并包含 $\\theta$ 的项：\n$$\np(\\theta \\mid D) \\propto \\theta^x (1-\\theta)^{n-x} \\theta^{\\alpha-1} (1-\\theta)^{\\beta-1} = \\theta^{\\alpha+x-1} (1-\\theta)^{\\beta+n-x-1}\n$$\n该表达式是贝塔分布的核。因此，$\\theta$ 的后验分布也是一个贝塔分布，这一性质被称为共轭性。更新后的超参数为 $\\alpha' = \\alpha+x$ 和 $\\beta' = \\beta+n-x$。完整的后验概率密度函数为：\n$$\np(\\theta \\mid D) = \\operatorname{Beta}(\\theta; \\alpha+x, \\beta+n-x) = \\frac{\\theta^{\\alpha+x-1} (1-\\theta)^{\\beta+n-x-1}}{B(\\alpha+x, \\beta+n-x)}\n$$\n\n现在，我们可以推导新的一次伯努利试验 $Y_{\\text{next}} \\in \\{0, 1\\}$ 的后验预测分布。我们关心的是下一次试验为成功（即拭子为阳性）的概率 $\\mathbb{P}(Y_{\\text{next}}=1 \\mid D)$。该概率通过将新观测值的似然对参数 $\\theta$ 的后验分布进行边缘化（积分）得到：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\int_{0}^{1} \\mathbb{P}(Y_{\\text{next}}=1 \\mid \\theta, D) p(\\theta \\mid D) \\,d\\theta\n$$\n根据可交换性假设，在给定参数 $\\theta$ 的条件下，下一次试验的结果与过去的数据 $D$ 条件独立。因此，$\\mathbb{P}(Y_{\\text{next}}=1 \\mid \\theta, D) = \\mathbb{P}(Y_{\\text{next}}=1 \\mid \\theta) = \\theta$。积分变为：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\int_{0}^{1} \\theta \\cdot p(\\theta \\mid D) \\,d\\theta\n$$\n根据定义，该积分是 $\\theta$ 在后验分布下的期望值 $\\mathbb{E}[\\theta \\mid D]$。贝塔分布 $\\operatorname{Beta}(\\alpha', \\beta')$ 的均值为 $\\frac{\\alpha'}{\\alpha'+\\beta'}$。对于我们的后验分布 $\\operatorname{Beta}(\\theta; \\alpha+x, \\beta+n-x)$，其均值为：\n$$\n\\mathbb{E}[\\theta \\mid D] = \\frac{\\alpha+x}{(\\alpha+x) + (\\beta+n-x)} = \\frac{\\alpha+x}{\\alpha+\\beta+n}\n$$\n所以，阳性结果的后验预测概率为：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\frac{\\alpha+x}{\\alpha+\\beta+n}\n$$\n伯努利试验 $Y_{\\text{next}}$ 的后验预测分布是一个参数为 $p = \\mathbb{P}(Y_{\\text{next}}=1 \\mid D)$ 的伯努利分布。\n\n为了展示该结果如何体现部分池化，我们可以将表达式重写为加权平均。被平均的两个量是医院特定的阳性经验比例 $\\frac{x}{n}$ 和先验平均流行率 $\\mathbb{E}[\\theta] = \\frac{\\alpha}{\\alpha+\\beta}$。我们可以证明后验预测概率是这两者的凸组合，通过展开该组合并证明其等价于我们已推导出的结果：\n$$\n\\frac{n}{\\alpha+\\beta+n} \\left(\\frac{x}{n}\\right) + \\frac{\\alpha+\\beta}{\\alpha+\\beta+n} \\left(\\frac{\\alpha}{\\alpha+\\beta}\\right) = \\frac{x}{\\alpha+\\beta+n} + \\frac{\\alpha}{\\alpha+\\beta+n} = \\frac{\\alpha+x}{\\alpha+\\beta+n}\n$$\n这证实了该结构。因此，后验预测概率是一个凸组合：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\left( \\frac{n}{n + \\alpha+\\beta} \\right) \\left( \\frac{x}{n} \\right) + \\left( \\frac{\\alpha+\\beta}{n + \\alpha+\\beta} \\right) \\left( \\frac{\\alpha}{\\alpha+\\beta} \\right)\n$$\n这里，权重 $\\frac{n}{n+\\alpha+\\beta}$ 应用于医院特定的经验比例（$\\frac{x}{n}$），而互补的权重 $\\frac{\\alpha+\\beta}{n+\\alpha+\\beta}$ 应用于群体水平的先验均值（$\\frac{\\alpha}{\\alpha+\\beta}$）。$\\alpha+\\beta$ 这一项可以解释为“先验样本量”或先验信念强度的度量。因此，后验估计从局部数据被“拉向”全局均值，这种效应被称为部分池化或收缩。收缩的程度取决于观测样本量（$n$）和先验有效样本量（$\\alpha+\\beta$）的相对大小。\n\n对于具体计算，给定值为 $\\alpha = 1.5$, $\\beta = 6.5$, $n = 12$ 和 $x = 7$。\n后验预测概率 $\\mathbb{P}(Y_{\\text{next}} = 1 \\mid D)$ 使用上面推导的公式计算：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\frac{\\alpha+x}{\\alpha+\\beta+n} = \\frac{1.5+7}{1.5+6.5+12} = \\frac{8.5}{8+12} = \\frac{8.5}{20}\n$$\n计算小数值：\n$$\n\\frac{8.5}{20} = 0.425\n$$\n问题要求答案四舍五入到四位有效数字。这得到 $0.4250$。\n我们也可以计算部分池化的各组成部分以进行验证：\n先验均值：$\\frac{\\alpha}{\\alpha+\\beta} = \\frac{1.5}{1.5+6.5} = \\frac{1.5}{8} = 0.1875$。\n经验比例：$\\frac{x}{n} = \\frac{7}{12} \\approx 0.5833$。\n权重为：\n数据权重：$\\frac{n}{n+\\alpha+\\beta} = \\frac{12}{12+8} = \\frac{12}{20} = 0.6$。\n先验权重：$\\frac{\\alpha+\\beta}{n+\\alpha+\\beta} = \\frac{8}{12+8} = \\frac{8}{20} = 0.4$。\n后验均值为 $(0.6) \\times (\\frac{7}{12}) + (0.4) \\times (0.1875) = 0.35 + 0.075 = 0.425$。计算结果一致。最终概率为 $0.4250$。", "answer": "$$\\boxed{0.4250}$$", "id": "4318486"}, {"introduction": "系统生物医学旨在理解由基因和蛋白质等相互作用的组分构成的复杂网络，而贝叶斯网络是表示和推理这些系统的主要工具。本练习聚焦于马尔可夫毯（Markov blanket）的概念，它定义了预测一个节点行为所需的局部邻域 [@problem_id:4318431]。您将推导出一个基因活性$G$的完整条件分布，这是像吉布斯采样（Gibbs sampling）这类常用推断算法的核心步骤，理解马尔可夫毯是掌握如何在大型复杂图模型中高效进行推断的关键，它使得对错综复杂的生物网络进行分析在计算上成为可能。", "problem": "在系统生物医学的背景下，考虑一个为基因调控模块建模的贝叶斯网络片段。一个二元基因激活节点 $G \\in \\{0,1\\}$ 受两个二元父节点调控：一个转录因子活性节点 $T \\in \\{0,1\\}$ 和一个上游刺激节点 $S \\in \\{0,1\\}$。激活的基因 $G$ 有两个子节点：一个二元下游通路读数 $C \\in \\{0,1\\}$（它也依赖于一个辅助调节器 $H \\in \\{0,1\\}$），以及一个表示直接依赖于 $G$ 的检测分析的二元测量节点 $M \\in \\{0,1\\}$。有向边为 $T \\to G$、$S \\to G$、$G \\to C$、$H \\to C$ 和 $G \\to M$。您将重点关注给定其马尔可夫毯时 $G$ 的条件分布。\n\n假设以下条件概率表是经过科学校准和固定的：\n- 对于给定其父节点 $(T,S)$ 的 $G$：\n  - $P(G=1 \\mid T=1,S=1) = \\frac{3}{4}$，\n  - $P(G=1 \\mid T=1,S=0) = \\frac{1}{2}$，\n  - $P(G=1 \\mid T=0,S=1) = \\frac{1}{3}$，\n  - $P(G=1 \\mid T=0,S=0) = \\frac{1}{5}$。\n- 对于给定 $(G,H)$ 的读数 $C$：\n  - $P(C=1 \\mid G=1,H=1) = \\frac{4}{5}$，\n  - $P(C=1 \\mid G=0,H=1) = \\frac{2}{5}$，\n  - $P(C=1 \\mid G=1,H=0) = \\frac{1}{2}$，\n  - $P(C=1 \\mid G=0,H=0) = \\frac{1}{10}$。\n- 对于给定 $G$ 的分析 $M$：\n  - $P(M=0 \\mid G=1) = \\frac{1}{4}$，\n  - $P(M=0 \\mid G=0) = \\frac{4}{5}$。\n\n假设在用于近似推断的 Gibbs 采样器的当前状态下，$G$ 的马尔可夫毯中的变量具有以下值：$T=1$，$S=0$，$H=1$，$C=1$ 和 $M=0$。您可以假设，给定该马尔可夫毯，任何不在其中的变量都与 $G$ 条件独立。\n\n任务：\n- 仅使用基本定义（贝叶斯网络的乘积分解、贝叶斯法则和马尔可夫毯的定义），从基本原理出发，推导出全条件分布 $P(G=1 \\mid T=1,S=0,H=1,C=1,M=0)$ 并计算其精确值。请以最简分数形式给出您的最终答案；不要四舍五入。\n- 用一句话简要说明为什么在 Gibbs 采样更新中，$G$ 的马尔可夫毯之外的节点不进入 $G$ 的全条件分布。\n\n您最终报告的答案必须是一个精确分数形式的实数值，不带单位。不要四舍五入。", "solution": "任务是计算给定贝叶斯网络中基因激活节点 $G$ 的全条件概率 $P(G=1 \\mid T=1,S=0,H=1,C=1,M=0)$，并论证使用马尔可夫毯的合理性。\n\n首先，我们必须识别节点 $G$ 的马尔可夫毯，记为 $MB(G)$。在贝叶斯网络中，一个节点的马尔可夫毯由其父节点、其子节点以及其子节点的其他父节点（共父节点）组成。\n根据问题陈述，有向边为 $T \\to G$、$S \\to G$、$G \\to C$、$H \\to C$ 和 $G \\to M$。\n- $G$ 的父节点是边指向 $G$ 的节点：$\\{T, S\\}$。\n- $G$ 的子节点是边从 $G$ 指出的节点：$\\{C, M\\}$。\n- $G$ 的共父节点是 $G$ 的子节点的其他父节点。子节点 $C$ 除了 $G$ 之外还有父节点 $H$。子节点 $M$ 没有其他父节点。因此，唯一的共父节点是 $\\{H\\}$。\n\n结合这些集合，$G$ 的马尔可夫毯是 $MB(G) = \\{T, S, C, H, M\\}$。问题中给出的条件变量集合 $\\{T=1, S=0, H=1, C=1, M=0\\}$ 对应于对 $G$ 的马尔可夫毯中节点的一次赋值。令该赋值为 $mb_G$。\n\n贝叶斯网络的一个基本属性是，给定一个节点的马尔可夫毯，该节点与网络中所有其他节点条件独立。这意味着，为了进行 Gibbs 采样更新或任何条件概率查询，我们只需要考虑这个局部邻域内的节点。$G$ 的全条件概率的表达式为：\n$$ P(G \\mid mb_G) = P(G \\mid T, S, H, C, M) $$\n根据条件概率的定义和贝叶斯网络的链式法则，该分布正比于给定其父节点时 $G$ 的条件概率，以及给定各自的父节点时 $G$ 的每个子节点的条件概率的乘积。\n$$ P(G \\mid mb_G) \\propto P(G, mb_G) = P(G, T, S, H, C, M) $$\n假设 $T$、$S$ 和 $H$ 是根节点，网络中所有变量的联合概率可分解为 $P(T,S,H,G,C,M) = P(T)P(S)P(H)P(G \\mid T,S)P(C \\mid G,H)P(M \\mid G)$。在以 $mb_G$ 为条件时，对于 $G$ 的所有值，$P(T)$、$P(S)$ 和 $P(H)$ 均为常数，并将在归一化过程中被约去。因此，$G$ 的全条件分布简化为仅与完全联合分布中涉及 $G$ 的项成正比：\n$$ P(G \\mid T, S, H, C, M) \\propto P(G \\mid T, S) P(C \\mid G, H) P(M \\mid G) $$\n我们需要计算 $P(G=1 \\mid T=1,S=0,H=1,C=1,M=0)$。我们可以通过计算 $G=1$ 和 $G=0$ 的未归一化值，然后进行归一化，来利用这个比例关系。\n\n设 $\\tilde{P}(G=g)$ 为状态 $g \\in \\{0,1\\}$ 的未归一化概率，给定马尔可夫毯的观测状态为 $\\{T=1,S=0,H=1,C=1,M=0\\}$。\n对于 $G=1$：\n$$ \\tilde{P}(G=1) = P(G=1 \\mid T=1, S=0) \\times P(C=1 \\mid G=1, H=1) \\times P(M=0 \\mid G=1) $$\n使用提供的条件概率表（CPT）中的值：\n- $P(G=1 \\mid T=1, S=0) = \\frac{1}{2}$\n- $P(C=1 \\mid G=1, H=1) = \\frac{4}{5}$\n- $P(M=0 \\mid G=1) = \\frac{1}{4}$\n因此，$G=1$ 的未归一化项为：\n$$ \\tilde{P}(G=1) = \\frac{1}{2} \\times \\frac{4}{5} \\times \\frac{1}{4} = \\frac{4}{40} = \\frac{1}{10} $$\n对于 $G=0$：\n$$ \\tilde{P}(G=0) = P(G=0 \\mid T=1, S=0) \\times P(C=1 \\mid G=0, H=1) \\times P(M=0 \\mid G=0) $$\n我们需要从给定的 CPT 中推导出所需的概率。一个变量的概率之和必须为 $1$。\n- $P(G=0 \\mid T=1,S=0) = 1 - P(G=1 \\mid T=1,S=0) = 1 - \\frac{1}{2} = \\frac{1}{2}$\n- $P(C=1 \\mid G=0, H=1) = \\frac{2}{5}$\n- $P(M=0 \\mid G=0) = \\frac{4}{5}$\n因此，$G=0$ 的未归一化项为：\n$$ \\tilde{P}(G=0) = \\frac{1}{2} \\times \\frac{2}{5} \\times \\frac{4}{5} = \\frac{8}{50} = \\frac{4}{25} $$\n为了求得最终概率，我们对这些值进行归一化：\n$$ P(G=1 \\mid mb_G) = \\frac{\\tilde{P}(G=1)}{\\tilde{P}(G=1) + \\tilde{P}(G=0)} = \\frac{\\frac{1}{10}}{\\frac{1}{10} + \\frac{4}{25}} $$\n为了计算分母中的和，我们找到一个公分母，即 $50$：\n$$ \\frac{1}{10} + \\frac{4}{25} = \\frac{5}{50} + \\frac{8}{50} = \\frac{13}{50} $$\n将此代回概率表达式中：\n$$ P(G=1 \\mid mb_G) = \\frac{\\frac{1}{10}}{\\frac{13}{50}} = \\frac{1}{10} \\times \\frac{50}{13} = \\frac{50}{130} = \\frac{5}{13} $$\n全条件概率的精确值为 $\\frac{5}{13}$。\n\n关于任务的第二部分，关于为什么马尔可夫毯之外的节点不进入全条件分布的论证，是贝叶斯网络定义的直接推论。\n由于贝叶斯网络结构中固有的条件独立性（由d-分离准则形式化描述），任何节点在给定其马尔可夫毯的情况下，与图中所有其他节点都是条件独立的。", "answer": "$$\n\\boxed{\\frac{5}{13}}\n$$", "id": "4318431"}]}