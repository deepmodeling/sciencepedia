{"hands_on_practices": [{"introduction": "蛋白质功能的基石是分子识别，例如一个结构域精确地结合到一个特定的基序上。理解这种识别的驱动力需要我们超越静态的结构图，进入生物物理热力学的世界。本练习将引导你分析一个假设的量热实验数据，通过计算吉布斯自由能（$\\Delta G$）、焓变（$\\Delta H$）和熵变（$\\Delta S$），来揭示驱动翻译后修饰基序识别的分子作用力本质，从而将抽象的热力学参数与具体的氢键、静电相互作用等联系起来 [@problem_id:4379776]。", "problem": "一个识别翻译后修饰肽基序的模块化信号蛋白结构域通过等温滴定微量热法（Isothermal Titration Calorimetry, ITC）进行测定。具体来说，一个14-3-3结构域与来自一个代谢调节剂的含磷酸化丝氨酸的基序结合。实验在恒温恒压下进行，溶液经过缓冲处理，确保没有相变发生，并且溶剂在量热法测定中表现为理想状态。\n\n恒温恒压过程的基本热力学定义包括吉布斯自由能 $G$、焓 $H$、熵 $S$，以及自发结合与吉布斯自由能变 $\\Delta G$ 符号的关系。ITC直接报告结合的摩尔焓变 $\\Delta H$，而温度标度的熵项 $-T\\Delta S$ 可以通过平衡结合等温线的温度依赖性来确定。在这些条件下，焓贡献和熵贡献的符号及相对大小决定了结合主要是由焓驱动还是由熵驱动。\n\n对于在 $T = 298 \\ \\text{K}$ 下磷酸化基序与14-3-3结构域的相互作用，测得的量为：\n- $\\Delta H = -51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$,\n- $-T\\Delta S = +22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$.\n\n仅使用适用于恒温恒压的基本热力学关系，计算结合过程的吉布斯自由能变 $\\Delta G$。然后，根据 $\\Delta H$ 和 $-T\\Delta S$ 的符号和大小，判断该结合是由焓驱动还是由熵驱动，并从模块化结构域识别磷酸化基序的典型分子相互作用角度解释你的结论。\n\n将 $\\Delta G$ 的最终数值以 $\\text{kJ} \\ \\text{mol}^{-1}$ 为单位表示，并将答案四舍五入至四位有效数字。在你的计算过程中提供解释，但最终报告的值必须仅为 $\\Delta G$ 的数值。", "solution": "题目陈述经评估有效。它在科学上基于应用于生物物理化学（特别是蛋白质-配体结合）的化学热力学原理。该问题设定良好，提供了使用一个基本且符合情境的方程计算吉布斯自由能变（$\\Delta G$）所需的所有数据（$\\Delta H$ 和 $-T\\Delta S$）。所提供的值对于所述的生物相互作用是符合实际的。该问题客观且无歧义。因此，可以构建一个解决方案。\n\n主要任务是计算结合事件的吉布斯自由能变 $\\Delta G$，并确定该相互作用的热力学驱动力。在恒温恒压下，吉布斯自由能、焓（$H$）和熵（$S$）之间的关系由吉布斯-亥姆霍兹方程给出：\n$$\n\\Delta G = \\Delta H - T\\Delta S\n$$\n这个方程是判断一个过程自发性的基础。$\\Delta G$ 的负值表示自发过程，而正值表示非自发过程。\n\n题目提供了在温度 $T = 298 \\ \\text{K}$ 下，磷酸化基序与14-3-3结构域结合的实验测量量如下：\n1.  摩尔焓变，$\\Delta H = -51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$。\n2.  对自由能的熵贡献，$-T\\Delta S = +22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$。\n\n吉布斯-亥姆霍兹方程可以方便地改写以直接使用所提供的项：\n$$\n\\Delta G = (\\Delta H) + (-T\\Delta S)\n$$\n将给定值代入此方程：\n$$\n\\Delta G = (-51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}) + (+22.6 \\ \\text{kJ} \\ \\text{mol}^{-1})\n$$\n$$\n\\Delta G = -28.6 \\ \\text{kJ} \\ \\text{mol}^{-1}\n$$\n题目要求最终答案四舍五入至四位有效数字。计算出的值 $-28.6$ 有三位有效数字。为了用四位有效数字表示，我们添加一个末尾的零：\n$$\n\\Delta G = -28.60 \\ \\text{kJ} \\ \\text{mol}^{-1}\n$$\n$\\Delta G$ 的符号为负，这证实了在指定条件下结合过程是自发的。\n\n接下来，我们必须确定该结合是由焓驱动还是由熵驱动。我们分析焓项和熵项对总自由能变的贡献。\n-   焓项为 $\\Delta H = -51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$。该项为负，表示过程是放热的，在能量上是有利的。这个有利的贡献促进了结合。\n-   熵项为 $-T\\Delta S = +22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$。该项为正，意味着 $T\\Delta S$ 项为负（$T\\Delta S = -22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$）。由于 $T$ 是正值，熵变本身 $\\Delta S$ 必定为负。负的 $\\Delta S$ 表示有序性增加，这对于自发过程是不利的。这个不利的贡献阻碍了结合。\n\n该结合被认为是**焓驱动**的，因为巨大的、有利的焓变（$|\\Delta H| = 51.2 \\ \\text{kJ} \\ \\text{mol}^{-1}$）是主导驱动力，并成功克服了与之相反的、不利的熵变（此处表示为 $|-T\\Delta S| = 22.6 \\ \\text{kJ} \\ \\text{mol}^{-1}$）。最终结果是一个自发反应（$\\Delta G  0$）。\n\n这种热力学特征的分子层面解释根植于所形成的相互作用类型和系统有序性的变化。\n-   **有利的焓（$\\Delta H  0$）：** 巨大的负焓变源于结合口袋中形成的强而特异的非共价相互作用，这些作用释放能量。对于一个结合磷酸化丝氨酸的14-3-3结构域，这些相互作用通常包括：\n    1.  磷酸丝氨酸上的二价阴离子磷酸基团（$-\\text{PO}_3^{2-}$）与结构域结合裂口内的一组带正电的残基（例如，精氨酸、赖氨酸）之间强的静电相互作用（盐桥）。\n    2.  肽主链、肽侧链和蛋白质的极性残基之间广泛的氢键网络。\n    - 这些高度特异性和方向性的相互作用在能量上比单个分子与溶剂（水）的相互作用更有利，从而导致净热量释放。\n\n-   **不利的熵（$\\Delta S  0$）：** 阻碍结合的负熵变主要是由于系统有序性的增加。\n    1.  **平动和转动自由度的损失：** 两个独立的分子（蛋白质结构域和肽基序）结合形成一个单一的、移动性较低的复合物，从而减少了总的平动和转动熵。\n    2.  **构象自由度的损失：** 柔性的、非结构化的肽基序在结合后被锁定在一个特定的、有序的构象中。同样，蛋白质结构域表面的柔性环也可能变得更加刚性。这种运动自由度的“冻结”代表了构象熵的显著降低。\n    - 尽管从结合表面置换有序水分子（疏水效应）可以对 $\\Delta S$ 做出有利的（正）贡献，但在本例中，总熵变为负。这表明由生物分子的缔合和构象限制所带来的有序化效应占主导地位。\n\n总之，该结合是一个典型的焓驱动相互作用案例，其中强而特异的静电和氢键相互作用的形成提供了能量，以“支付”形成有序复合物的熵罚。", "answer": "$$\n\\boxed{-28.60}\n$$", "id": "4379776"}, {"introduction": "在细胞内，蛋白质的修饰状态并非一成不变，而是由修饰酶（如激酶）和去修饰酶（如磷酸酶）之间持续不断的“拉锯战”所决定的动态平衡。本练习将带你构建一个动力学模型，用以计算在激酶和磷酸酶的共同作用下，目标蛋白磷酸化水平的稳态比例。你将探索结构域介导的“脚手架效应”如何精确调控这一平衡，从而理解细胞信号通路中分子开关的工作原理 [@problem_id:4379708]。", "problem": "一种胞质蛋白 $P$ 包含一个可被磷酸化的丝氨酸基序，产生磷酸化状态 $P_{p}$。一种丝氨酸/苏氨酸激酶 $K$ 通过其Src同源2 (SH2) 结构域识别一个对接基序，而一种丝氨酸/苏氨酸磷酸酶 $F$ 通过其色氨酸 (WW) 结构域被招募到一个支架上。在三磷酸腺苷 (ATP) 近似恒定、低底物占有率和酶浓度恒定的生理条件下，该基序的磷酸化和去磷酸化通量可分别被建模为相对于 $[P]$ 和 $[P_{p}]$ 的伪一级过程。\n\nSH2结构域介导的激酶 $K$ 到支架肽 $S$ 的招募调节了磷酸化的有效催化速率常数。设SH2–$S$相互作用的解离常数为 $K_{d}^{D} = 2.0\\,\\mu\\text{M}$，游离支架肽浓度为 $[S] = 5.0\\,\\mu\\text{M}$。假设存在单个结合位点且 $[S] \\gg [K]_{\\text{tot}}$，则对接位点被占据的激酶分子的分数为 $f_{D} = \\dfrac{[S]}{K_{d}^{D} + [S]}$。当对接位点被占据时，有效伪一级磷酸化速率常数为 $k_{\\text{kin}}^{\\text{on}} = 0.08\\,\\text{s}^{-1}$；当未被占据时，该常数为 $k_{\\text{kin}}^{\\text{off}} = 0.01\\,\\text{s}^{-1}$。总有效磷酸化速率常数是加权平均值 $k_{\\text{kin}} = f_{D}\\,k_{\\text{kin}}^{\\text{on}} + (1 - f_{D})\\,k_{\\text{kin}}^{\\text{off}}$。\n\n类似地，WW结构域介导的磷酸酶 $F$ 到支架基序 $M$ 的招募调节了有效去磷酸化速率常数。设WW–$M$相互作用的解离常数为 $K_{d}^{WW} = 10\\,\\mu\\text{M}$，游离支架基序浓度为 $[M] = 20\\,\\mu\\text{M}$。通过WW结构域结合的磷酸酶分子的分数为 $f_{WW} = \\dfrac{[M]}{K_{d}^{WW} + [M]}$。在没有WW介导的招募的情况下，基础伪一级去磷酸化速率常数为 $k_{\\text{phos},0} = 0.06\\,\\text{s}^{-1}$。当WW结构域被占据时，局部微环境将催化速率降低了因子 $r = 0.5$，因此有效去磷酸化速率常数为 $k_{\\text{phos}} = (1 - f_{WW})\\,k_{\\text{phos},0} + f_{WW}\\,(r\\,k_{\\text{phos},0})$。\n\n在稳态下，该基序的质量作用平衡满足\n$$\n\\frac{d[P_{p}]}{dt} = k_{\\text{kin}}[P] - k_{\\text{phos}}[P_{p}] = 0,\n$$\n这意味着一个恒定的比率 $\\dfrac{[P_{p}]}{[P]} = \\dfrac{k_{\\text{kin}}}{k_{\\text{phos}}}$。\n\n使用上述信息计算稳态比率 $\\dfrac{[P_{p}]}{[P]}$。将您的最终答案表示为一个无量纲的小数，并将结果四舍五入到四位有效数字。", "solution": "用户希望基于所提供的由支架调节的酶动力学模型，确定磷酸化蛋白与未磷酸化蛋白的稳态比率 $\\dfrac{[P_{p}]}{[P]}$。\n\n首先验证问题以确保其科学上合理、问题明确且客观。\n\n### 步骤1：提取已知条件\n- 激酶 $K$ 对磷酸化的调节：\n  - SH2–$S$ 相互作用的解离常数： $K_{d}^{D} = 2.0\\,\\mu\\text{M}$\n  - 游离支架肽浓度： $[S] = 5.0\\,\\mu\\text{M}$\n  - 对接位点被占据的激酶分数： $f_{D} = \\dfrac{[S]}{K_{d}^{D} + [S]}$\n  - 伪一级磷酸化速率常数（对接位点被占据）： $k_{\\text{kin}}^{\\text{on}} = 0.08\\,\\text{s}^{-1}$\n  - 伪一级磷酸化速率常数（对接位点未被占据）： $k_{\\text{kin}}^{\\text{off}} = 0.01\\,\\text{s}^{-1}$\n  - 总有效磷酸化速率常数： $k_{\\text{kin}} = f_{D}\\,k_{\\text{kin}}^{\\text{on}} + (1 - f_{D})\\,k_{\\text{kin}}^{\\text{off}}$\n\n- 磷酸酶 $F$ 对去磷酸化的调节：\n  - WW–$M$ 相互作用的解离常数： $K_{d}^{WW} = 10\\,\\mu\\text{M}$\n  - 游离支架基序浓度： $[M] = 20\\,\\mu\\text{M}$\n  - 通过WW结构域结合的磷酸酶分数： $f_{WW} = \\dfrac{[M]}{K_{d}^{WW} + [M]}$\n  - 基础伪一级去磷酸化速率常数： $k_{\\text{phos},0} = 0.06\\,\\text{s}^{-1}$\n  - WW结构域被占据时的催化速率降低因子： $r = 0.5$\n  - 有效去磷酸化速率常数： $k_{\\text{phos}} = (1 - f_{WW})\\,k_{\\text{phos},0} + f_{WW}\\,(r\\,k_{\\text{phos},0})$\n\n- 稳态条件：\n  - $\\dfrac{d[P_{p}]}{dt} = k_{\\text{kin}}[P] - k_{\\text{phos}}[P_{p}] = 0$\n  - 稳态比率： $\\dfrac{[P_{p}]}{[P]} = \\dfrac{k_{\\text{kin}}}{k_{\\text{phos}}}$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了一个标准的磷酸化-去磷酸化循环的生化模型。使用SH2和WW结构域进行蛋白质-蛋白质相互作用和支架作用、通过此类相互作用调节酶活性、以及在低底物浓度条件下应用伪一级动力学，都是分子生物学和酶动力学中公认的原理。参数值在生理上是合理的。该模型是系统生物学中一个有效且常用的简化模型。\n- **问题明确：** 计算所需比率的所有必要常数、浓度和公式均已提供。问题是自洽的，并导向唯一的解。\n- **客观性：** 语言精确且定量化。问题基于已建立的动力学模型，不含主观论断。\n\n### 步骤3：结论与行动\n问题被判定为 **有效**。将推导解答。\n\n解答需要计算磷酸化 ($k_{\\text{kin}}$) 和去磷酸化 ($k_{\\text{phos}}$) 的总有效速率常数，然后求出它们的比值。\n\n首先，我们计算对接位点被占据的激酶分子的分数 $f_{D}$。\n给定 $K_{d}^{D} = 2.0\\,\\mu\\text{M}$ 和 $[S] = 5.0\\,\\mu\\text{M}$：\n$$\nf_{D} = \\frac{[S]}{K_{d}^{D} + [S]} = \\frac{5.0\\,\\mu\\text{M}}{2.0\\,\\mu\\text{M} + 5.0\\,\\mu\\text{M}} = \\frac{5.0}{7.0} = \\frac{5}{7}\n$$\n\n接下来，我们使用这个分数来计算总有效磷酸化速率常数 $k_{\\text{kin}}$。\n给定 $k_{\\text{kin}}^{\\text{on}} = 0.08\\,\\text{s}^{-1}$ 和 $k_{\\text{kin}}^{\\text{off}} = 0.01\\,\\text{s}^{-1}$：\n$$\nk_{\\text{kin}} = f_{D}\\,k_{\\text{kin}}^{\\text{on}} + (1 - f_{D})\\,k_{\\text{kin}}^{\\text{off}}\n$$\n$$\nk_{\\text{kin}} = \\left(\\frac{5}{7}\\right) (0.08\\,\\text{s}^{-1}) + \\left(1 - \\frac{5}{7}\\right) (0.01\\,\\text{s}^{-1})\n$$\n$$\nk_{\\text{kin}} = \\left(\\frac{5}{7}\\right) (0.08\\,\\text{s}^{-1}) + \\left(\\frac{2}{7}\\right) (0.01\\,\\text{s}^{-1})\n$$\n$$\nk_{\\text{kin}} = \\frac{5 \\times 0.08 + 2 \\times 0.01}{7}\\,\\text{s}^{-1} = \\frac{0.40 + 0.02}{7}\\,\\text{s}^{-1} = \\frac{0.42}{7}\\,\\text{s}^{-1} = 0.06\\,\\text{s}^{-1}\n$$\n\n现在，我们计算通过WW结构域结合的磷酸酶分子的分数 $f_{WW}$。\n给定 $K_{d}^{WW} = 10\\,\\mu\\text{M}$ 和 $[M] = 20\\,\\mu\\text{M}$：\n$$\nf_{WW} = \\frac{[M]}{K_{d}^{WW} + [M]} = \\frac{20\\,\\mu\\text{M}}{10\\,\\mu\\text{M} + 20\\,\\mu\\text{M}} = \\frac{20}{30} = \\frac{2}{3}\n$$\n\n使用这个分数，我们计算有效去磷酸化速率常数 $k_{\\text{phos}}$。\n给定 $k_{\\text{phos},0} = 0.06\\,\\text{s}^{-1}$ 和 $r = 0.5$：\n$$\nk_{\\text{phos}} = (1 - f_{WW})\\,k_{\\text{phos},0} + f_{WW}\\,(r\\,k_{\\text{phos},0})\n$$\n该表达式可以因式分解：\n$$\nk_{\\text{phos}} = k_{\\text{phos},0} \\left( (1 - f_{WW}) + r\\,f_{WW} \\right) = k_{\\text{phos},0} \\left( 1 - f_{WW} + r\\,f_{WW} \\right) = k_{\\text{phos},0} \\left( 1 - (1-r)f_{WW} \\right)\n$$\n代入数值：\n$$\nk_{\\text{phos}} = (0.06\\,\\text{s}^{-1}) \\left( 1 - (1-0.5)\\left(\\frac{2}{3}\\right) \\right)\n$$\n$$\nk_{\\text{phos}} = (0.06\\,\\text{s}^{-1}) \\left( 1 - (0.5)\\left(\\frac{2}{3}\\right) \\right) = (0.06\\,\\text{s}^{-1}) \\left( 1 - \\frac{1}{3} \\right)\n$$\n$$\nk_{\\text{phos}} = (0.06\\,\\text{s}^{-1}) \\left( \\frac{2}{3} \\right) = 0.04\\,\\text{s}^{-1}\n$$\n\n最后，我们计算稳态比率 $\\dfrac{[P_{p}]}{[P]}$。\n$$\n\\frac{[P_{p}]}{[P]} = \\frac{k_{\\text{kin}}}{k_{\\text{phos}}} = \\frac{0.06\\,\\text{s}^{-1}}{0.04\\,\\text{s}^{-1}} = \\frac{6}{4} = 1.5\n$$\n问题要求答案表示为一个无量纲的小数，并四舍五入到四位有效数字。\n$$\n1.5 \\implies 1.500\n$$", "answer": "$$\n\\boxed{1.500}\n$$", "id": "4379708"}, {"introduction": "将视角从单个蛋白放大到整个蛋白质组的演化，我们会发现蛋白质常常是不同功能结构域的“马赛克”。这些结构域的线性排列，即“结构域架构”，在演化过程中通过基因复制、重组和丢失而不断变化。本练习将引入一种生物信息学方法，教你如何使用集合论中的Jaccard相似性指数，从结构域组成、数量和顺序等多个维度，来定量比较不同蛋白质的结构域架构，从而为分析蛋白质功能的演化变迁提供有力的计算工具 [@problem_id:4379742]。", "problem": "给定一组旁系同源蛋白对。每个蛋白质由一个结构域标识符（例如，经过整理的名称或蛋白质家族 (Pfam) 标识符）的有序列表表示，这些标识符共同构成一个结构域架构。使用集合论和序列组织的定义，为每对蛋白构建比较性结构域架构图，并计算三个 Jaccard 相似性指数以量化其分化程度。目标是量化结构域内容、多重性和顺序方面的相似性。\n\n基本原理：\n- 蛋白质是氨基酸的线性聚合物；蛋白质通常包含称为结构域的模块化亚基，这些亚基在不同蛋白质中反复出现，并与特定功能相关。沿蛋白质的结构域线性顺序即为结构域架构。\n- 旁系同源体由基因复制产生，并可能在进化过程中在结构域架构上发生分化。\n- 两个集合 $X$ 和 $Y$ 之间的 Jaccard 指数定义为 $J(X,Y) = \\frac{|X \\cap Y|}{|X \\cup Y|}$。\n- 多重集是集合的推广，允许一个元素出现多次；对于多重集 $M$ 和 $N$，其元素计数分别为 $n_M(d)$ 和 $n_N(d)$，广义 Jaccard 指数定义为 $J(M,N) = \\frac{\\sum_d \\min\\{n_M(d), n_N(d)\\}}{\\sum_d \\max\\{n_M(d), n_N(d)\\}}$。\n\n待实现的定义：\n- 设一个蛋白质结构为一个有序列表 $A = [a_1, a_2, \\dots, a_m]$，其中元素为结构域标识符，类似地，$B = [b_1, b_2, \\dots, b_n]$。\n- 定义唯一结构域内容集 $U_A = \\{a_i \\mid i \\in \\{1,\\dots,m\\}\\}$ 和 $U_B = \\{b_j \\mid j \\in \\{1,\\dots,n\\}\\}$。\n- 定义结构域多重性计数 $n_A(d)$ 为结构域 $d$ 在 $A$ 中出现的次数，对于 $B$ 中的 $n_B(d)$ 定义类似。\n- 定义邻接集（有序二元组）为 $S_A = \\{(a_i, a_{i+1}) \\mid i \\in \\{1,\\dots,m-1\\}\\}$ 和 $S_B = \\{(b_j, b_{j+1}) \\mid j \\in \\{1,\\dots,n-1\\}\\}$，其中每个元素是连续结构域类型的有序对。允许重复；例如，如果 $a_i = a_{i+1}$，则该对为 $(a_i, a_{i+1})$ 即 $(d,d)$，并且在集合定义中每个邻接位置只包含一次（集合会移除重复项）。\n- 为每对计算三个 Jaccard 相似性指数：\n  - 内容 Jaccard 指数 $J_c = \\frac{|U_A \\cap U_B|}{|U_A \\cup U_B|}$。\n  - 多重集 Jaccard 指数 $J_m = \\frac{\\sum_d \\min\\{n_A(d), n_B(d)\\}}{\\sum_d \\max\\{n_A(d), n_B(d)\\}}$，其中求和遍历存在于 $A$ 或 $B$ 中的所有结构域标识符 $d$。\n  - 邻接 Jaccard 指数 $J_a = \\frac{|S_A \\cap S_B|}{|S_A \\cup S_B|}$。\n\n边界约定：\n- 如果任何 Jaccard 指数的分母为 $0$（例如，$U_A$ 和 $U_B$ 均为空，或 $S_A$ 和 $S_B$ 均为空，或所有多重集计数均为零），则将该 Jaccard 指数定义为 $1$。\n\n角度单位不适用。没有物理单位。\n\n你的任务：\n- 对于下面的每个测试用例，根据上述定义计算 $J_c$、$J_m$ 和 $J_a$。\n- 将三个浮点数结果中的每一个都精确到小数点后 $6$ 位。\n\n测试套件（每个项目是一对结构 $(A,B)$，其中每个结构都是一个有序的结构域标识符列表）：\n- 案例 $1$：$A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$。\n- 案例 $2$：$A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}]$, $B = [\\text{\"RRM\"}, \\text{\"WD40\"}]$。\n- 案例 $3$：$A = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"PH\"}, \\text{\"FHA\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$。\n- 案例 $4$：$A = [\\text{\"zf-C2H2\"}]$, $B = [\\text{\"zf-C2H2\"}, \\text{\"zf-C2H2\"}]$。\n- 案例 $5$：$A = [\\ ]$ (空列表), $B = [\\ ]$ (空列表)。\n- 案例 $6$：$A = [\\text{\"SH3\"}, \\text{\"Pro-rich\"}, \\text{\"SH2\"}]$, $B = [\\text{\"SH2\"}, \\text{\"Pro-rich\"}, \\text{\"SH3\"}]$。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每一项都是一个三元组列表，按 $[J_c, J_m, J_a]$ 的顺序对应于相应测试用例的结果。每个浮点数必须精确到小数点后 $6$ 位。\n- 例如，对于两个案例，一个有效的整体格式如下所示：$[[0.123456,0.654321,1.000000],[1.000000,0.000000,0.500000]]$。", "solution": "### 步骤 1：提取已知信息\n\n问题提供了以下数据、定义和条件：\n- **旁系同源蛋白**：由基因复制产生的成对蛋白质。\n- **蛋白质结构域架构**：一个有序的结构域标识符列表。设两个结构为 $A = [a_1, a_2, \\dots, a_m]$ 和 $B = [b_1, b_2, \\dots, b_n]$。\n- **唯一结构域内容集**：对于结构 $A$，这是 $U_A = \\{a_i \\mid i \\in \\{1,\\dots,m\\}\\}$。对于 $B$，它是 $U_B = \\{b_j \\mid j \\in \\{1,\\dots,n\\}\\}$。\n- **结构域多重性计数**：对于结构 $A$ 中的一个结构域 $d$，其计数为 $n_A(d)$。对于 $B$，则为 $n_B(d)$。\n- **邻接集**：对于结构 $A$，它是序偶对的集合 $S_A = \\{(a_i, a_{i+1}) \\mid i \\in \\{1,\\dots,m-1\\}\\}$。对于 $B$，它是 $S_B = \\{(b_j, b_{j+1}) \\mid j \\in \\{1,\\dots,n-1\\}\\}$。\n- **内容 Jaccard 指数 ($J_c$)**：$J_c = \\frac{|U_A \\cap U_B|}{|U_A \\cup U_B|}$。\n- **多重集 Jaccard 指数 ($J_m$)**：$J_m = \\frac{\\sum_d \\min\\{n_A(d), n_B(d)\\}}{\\sum_d \\max\\{n_A(d), n_B(d)\\}}$，对 $A$ 或 $B$ 中所有的结构域 $d$ 求和。\n- **邻接 Jaccard 指数 ($J_a$)**：$J_a = \\frac{|S_A \\cap S_B|}{|S_A \\cup S_B|}$。\n- **边界约定**：如果任何 Jaccard 指数的分母为 $0$，则该指数定义为 $1$。\n- **舍入**：所有最终浮点结果必须精确到小数点后 $6$ 位。\n- **测试套件**：\n    - 案例 $1$：$A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$\n    - 案例 $2$：$A = [\\text{\"Pkinase\"}, \\text{\"SH2\"}]$, $B = [\\text{\"RRM\"}, \\text{\"WD40\"}]$\n    - 案例 $3$：$A = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"PH\"}, \\text{\"FHA\"}]$, $B = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$\n    - 案例 $4$：$A = [\\text{\"zf-C2H2\"}]$, $B = [\\text{\"zf-C2H2\"}, \\text{\"zf-C2H2\"}]$\n    - 案例 $5$：$A = [\\ ]$, $B = [\\ ]$\n    - 案例 $6$：$A = [\\text{\"SH3\"}, \\text{\"Pro-rich\"}, \\text{\"SH2\"}]$, $B = [\\text{\"SH2\"}, \\text{\"Pro-rich\"}, \\text{\"SH3\"}]$\n\n### 步骤 2：使用提取的已知信息进行验证\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题在计算生物学和生物信息学领域有充分的依据。蛋白质结构域、结构域架构、旁系同源体等概念，以及使用 Jaccard 指数这类基于集合的相似性度量，都是比较蛋白质序列的标准且科学合理的方法。\n- **定义明确**：该问题在数学上是适定的。它为所有三个必需的度量（$J_c, J_m, J_a$）提供了明确、无歧义的定义，包括必要的集合和计数函数。所有输入数据（测试用例）都已提供。对除以零的边界条件也进行了明确规定。这确保了每个测试用例都存在唯一且稳定的解。\n- **客观性**：该问题以精确、客观的语言陈述。定义是形式化的，不依赖于主观解释。\n- **缺陷清单**：该问题没有表现出任何列出的缺陷。它在科学上是有效的、可形式化的、完整的、可行的、结构良好的、非平凡的且可验证的。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。将制定解决方案。\n\n### 解决方案推导\n\n任务是为每对给定的蛋白质结构域架构 $(A, B)$ 计算三个不同的 Jaccard 相似性指数。这些指数基于唯一结构域内容 ($J_c$)、结构域多重性 ($J_m$) 和结构域顺序/邻接性 ($J_a$) 来量化相似性。我们将系统地将所提供的定义应用于每个测试用例。\n\n让我们以案例 3 为例说明该过程：\n$A = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"PH\"}, \\text{\"FHA\"}]$\\\n$B = [\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}, \\text{\"PH\"}]$\n\n**1. 内容 Jaccard 指数 ($J_c$)**\n该指数比较唯一结构域的集合，忽略计数和顺序。\n首先，我们构建唯一结构域内容集 $U_A$ 和 $U_B$：\n$U_A = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"FHA\"}\\}$\n$U_B = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"SH2\"}\\}$\n\n接下来，我们求它们的交集和并集：\n$U_A \\cap U_B = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}\\}$\n$U_A \\cup U_B = \\{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"FHA\"}, \\text{\"SH2\"}\\}$\n\n这些集合的基数分别为 $|U_A \\cap U_B| = 2$ 和 $|U_A \\cup U_B| = 4$。\n内容 Jaccard 指数是：\n$$ J_c = \\frac{|U_A \\cap U_B|}{|U_A \\cup U_B|} = \\frac{2}{4} = 0.5 $$\n\n**2. 多重集 Jaccard 指数 ($J_m$)**\n该指数考虑了每个结构域出现的次数。\n我们首先识别两个结构中的所有唯一结构域，即集合 $U_A \\cup U_B$：{\\text{\"Pkinase\"}, \\text{\"PH\"}, \\text{\"FHA\"}, \\text{\"SH2\"}}。\n然后我们计算该集合中每个结构域 $d$ 的计数 $n_A(d)$ 和 $n_B(d)$。\n\n- 对于 $d = \\text{\"Pkinase\"}$：$n_A(d) = 1$, $n_B(d) = 1$。$\\min=1$, $\\max=1$。\n- 对于 $d = \\text{\"PH\"}$：$n_A(d) = 2$, $n_B(d) = 2$。$\\min=2$, $\\max=2$。\n- 对于 $d = \\text{\"FHA\"}$：$n_A(d) = 1$, $n_B(d) = 0$。$\\min=0$, $\\max=1$。\n- 对于 $d = \\text{\"SH2\"}$：$n_A(d) = 0$, $n_B(d) = 1$。$\\min=0$, $\\max=1$。\n\n分子是最小值的总和：\n$$ \\sum_d \\min\\{n_A(d), n_B(d)\\} = 1 + 2 + 0 + 0 = 3 $$\n分母是最大值的总和：\n$$ \\sum_d \\max\\{n_A(d), n_B(d)\\} = 1 + 2 + 1 + 1 = 5 $$\n多重集 Jaccard 指数是：\n$$ J_m = \\frac{3}{5} = 0.6 $$\n\n**3. 邻接 Jaccard 指数 ($J_a$)**\n该指数通过检查相邻对（二元组）的集合来比较结构域的排序。\n首先，我们构建邻接集 $S_A$ 和 $S_B$。长度为 $k$ 的结构将有 $k-1$ 个邻接关系。\n对于 $A = [a_1, a_2, a_3, a_4]$，$S_A = \\{(a_1, a_2), (a_2, a_3), (a_3, a_4)\\}$。\n$S_A = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"FHA\"})\\}$\n对于 $B = [b_1, b_2, b_3, b_4]$，$S_B = \\{(b_1, b_2), (b_2, b_3), (b_3, b_4)\\}$。\n$S_B = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"SH2\"}), (\\text{\"SH2\"}, \\text{\"PH\"})\\}$\n\n接下来，我们求这些对的集合的交集和并集：\n$S_A \\cap S_B = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"})\\}$\n$S_A \\cup S_B = \\{(\\text{\"Pkinase\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"PH\"}), (\\text{\"PH\"}, \\text{\"FHA\"}), (\\text{\"PH\"}, \\text{\"SH2\"}), (\\text{\"SH2\"}, \\text{\"PH\"})\\}$\n\n基数分别为 $|S_A \\cap S_B| = 1$ 和 $|S_A \\cup S_B| = 5$。\n邻接 Jaccard 指数是：\n$$ J_a = \\frac{|S_A \\cap S_B|}{|S_A \\cup S_B|} = \\frac{1}{5} = 0.2 $$\n\n此过程被系统地应用于所有测试用例，以推导出最终结果。特别注意边界情况。例如，在案例 5 中，结构 $A$ 和 $B$ 都是空列表。这导致唯一结构域集和邻接集为空，多重集指数的计数值总和为零。在这三种情况下，Jaccard 公式的分母都为 $0$。根据指定的边界约定，$J_c、J_m$ 和 $J_a$ 都被定义为 $1$。类似地，对于案例 4，第一个结构的长度为 $1$，因此其邻接集 $S_A$ 为空。\n这种对给定严格定义的全面、逐步应用，确保了对每对蛋白质结构的三个相似性指数的正确计算。实现将把这个逻辑形式化。", "answer": "[[1.000000,1.000000,1.000000],[0.000000,0.000000,0.000000],[0.500000,0.600000,0.200000],[1.000000,0.500000,0.000000],[1.000000,1.000000,1.000000],[1.000000,1.000000,0.000000]]", "id": "4379742"}]}