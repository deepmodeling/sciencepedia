{"hands_on_practices": [{"introduction": "钙信号之所以强大，源于驱动 $Ca^{2+}$ 内流的巨大电化学驱动力。本练习将引导你从第一性原理出发，通过推导能斯特电位来量化这一驱动力，从而对钙作为快速第二信使的热力学基础建立核心理解。[@problem_id:4385284]", "problem": "细胞内钙离子 ($\\mathrm{Ca}^{2+}$) 作为第二信使，触发多种过程，如囊泡融合、酶活化和基因表达。$\\mathrm{Ca}^{2+}$信号的保真度源于陡峭的跨膜梯度和对胞质游离$\\mathrm{Ca}^{2+}$的严格缓冲，这两者共同设定了当通道打开时$\\mathrm{Ca}^{2+}$进入的热力学驱动力。从将跨膜电化学势相等的电化学平衡热力学定义出发，推导在细胞外游离$\\mathrm{Ca}^{2+}$浓度 $[\\mathrm{Ca}^{2+}]_{\\mathrm{out}}=2\\,\\mathrm{mM}$、细胞内游离$\\mathrm{Ca}^{2+}$浓度 $[\\mathrm{Ca}^{2+}]_{\\mathrm{in}}=100\\,\\mathrm{nM}$以及绝对温度 $T=310\\,\\mathrm{K}$ 条件下，$\\mathrm{Ca}^{2+}$的平衡（能斯特）电位 $E_{\\mathrm{Ca}}$。采用膜电位 $V$ 是细胞内电位减去细胞外电位的符号约定，并在本计算中将活度视为等于浓度。在推导出表达式后，使用标准物理常数对其进行数值计算，并简要讨论其大小对在典型静息膜电位为 $-70\\,\\mathrm{mV}$ 时$\\mathrm{Ca}^{2+}$进入的驱动力的影响。将您的数值答案四舍五入至四位有效数字，并以毫伏为单位表示。", "solution": "该问题是有效的，因为它科学地基于热力学和电生理学原理，问题阐述清晰且提供了所有必要信息，并且表述客观。我们将继续进行解答。\n\n该问题要求推导钙离子（$\\mathrm{Ca}^{2+}$）的能斯特平衡电位（$E_{\\mathrm{Ca}}$），对其进行数值计算，并讨论其影响。\n\n基本原理是，在电化学平衡状态下，离子没有跨膜的净通量。这种情况发生在膜两侧离子的电化学势相等时。对于浓度为 $[C]$、化合价为 $z$ 的离子种类，在电位为 $V$ 的位置，其电化学势 $\\tilde{\\mu}$ 由以下公式给出：\n$$ \\tilde{\\mu} = \\mu^0 + RT \\ln[C] + zFV $$\n其中 $\\mu^0$ 是标准化学势，$R$ 是通用气体常数，$T$ 是绝对温度，$F$ 是法拉第常数。\n\n在平衡状态下，细胞内的电化学势（$\\tilde{\\mu}_{\\mathrm{in}}$）必须等于细胞外的电化学势（$\\tilde{\\mu}_{\\mathrm{out}}$）：\n$$ \\tilde{\\mu}_{\\mathrm{in}} = \\tilde{\\mu}_{\\mathrm{out}} $$\n将两侧的$\\mathrm{Ca}^{2+}$的 $\\tilde{\\mu}$ 表达式代入，得到：\n$$ \\mu^0 + RT \\ln([\\mathrm{Ca}^{2+}]_{\\mathrm{in}}) + zFV_{\\mathrm{in}} = \\mu^0 + RT \\ln([\\mathrm{Ca}^{2+}]_{\\mathrm{out}}) + zFV_{\\mathrm{out}} $$\n标准化学势 $\\mu^0$ 是离子的固有属性，因此可以从两侧消去。重新排列各项，将电位和浓度分组，我们得到：\n$$ zF(V_{\\mathrm{in}} - V_{\\mathrm{out}}) = RT \\ln([\\mathrm{Ca}^{2+}]_{\\mathrm{out}}) - RT \\ln([\\mathrm{Ca}^{2+}]_{\\mathrm{in}}) $$\n项 $(V_{\\mathrm{in}} - V_{\\mathrm{out}})$ 是离子处于平衡状态时的膜电位。根据定义，这就是该离子的能斯特电位，记为 $E_{\\mathrm{ion}}$。对于 $\\mathrm{Ca}^{2+}$，这就是 $E_{\\mathrm{Ca}}$。利用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们有：\n$$ zFE_{\\mathrm{Ca}} = RT \\ln\\left(\\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{out}}}{[\\mathrm{Ca}^{2+}]_{\\mathrm{in}}}\\right) $$\n求解 $E_{\\mathrm{Ca}}$，得到能斯特方程：\n$$ E_{\\mathrm{Ca}} = \\frac{RT}{zF} \\ln\\left(\\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{out}}}{[\\mathrm{Ca}^{2+}]_{\\mathrm{in}}}\\right) $$\n这个表达式代表了推导出的$\\mathrm{Ca}^{2+}$的能斯特电位。\n\n接下来，我们对这个表达式进行数值计算。给定的和标准的值如下：\n- 通用气体常数，$R \\approx 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- 绝对温度，$T = 310\\,\\mathrm{K}$\n- 钙离子的化合价，$z = +2$\n- 法拉第常数，$F \\approx 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- 细胞外浓度，$[\\mathrm{Ca}^{2+}]_{\\mathrm{out}} = 2\\,\\mathrm{mM} = 2 \\times 10^{-3}\\,\\mathrm{M}$\n- 细胞内浓度，$[\\mathrm{Ca}^{2+}]_{\\mathrm{in}} = 100\\,\\mathrm{nM} = 1 \\times 10^{-7}\\,\\mathrm{M}$\n\n首先，我们计算浓度比：\n$$ \\frac{[\\mathrm{Ca}^{2+}]_{\\mathrm{out}}}{[\\mathrm{Ca}^{2+}]_{\\mathrm{in}}} = \\frac{2 \\times 10^{-3}\\,\\mathrm{M}}{1 \\times 10^{-7}\\,\\mathrm{M}} = 2 \\times 10^4 $$\n现在我们将所有值代入能斯特方程：\n$$ E_{\\mathrm{Ca}} = \\frac{(8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(310\\,\\mathrm{K})}{(2)(96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1})} \\ln(2 \\times 10^4) $$\n计算各项：\n$$ \\ln(2 \\times 10^4) \\approx 9.90348755 $$\n$$ E_{\\mathrm{Ca}} \\approx \\frac{2577.34\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}}{192970\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}} \\times 9.90348755 $$\n$$ E_{\\mathrm{Ca}} \\approx 0.0133562\\,\\mathrm{V} \\times 9.90348755 $$\n$$ E_{\\mathrm{Ca}} \\approx 0.132274\\,\\mathrm{V} $$\n问题要求答案以毫伏（$mV$）为单位，并四舍五入到四位有效数字。\n$$ E_{\\mathrm{Ca}} \\approx 132.274\\,\\mathrm{mV} \\approx 132.3\\,\\mathrm{mV} $$\n在这些条件下，$\\mathrm{Ca}^{2+}$的平衡电位约为 $+132.3\\,\\mathrm{mV}$。\n\n最后，我们讨论这对$\\mathrm{Ca}^{2+}$进入的驱动力的影响。作用于离子的电化学驱动力（$V_{DF}$）是实际膜电位（$V_m$）与该离子平衡电位（$E_{\\mathrm{ion}}$）之间的差值：\n$$ V_{DF} = V_m - E_{\\mathrm{ion}} $$\n对于$\\mathrm{Ca}^{2+}$，在典型的静息膜电位 $V_m = -70\\,\\mathrm{mV}$ 和我们计算出的 $E_{\\mathrm{Ca}} = +132.3\\,\\mathrm{mV}$ 时，驱动力为：\n$$ V_{DF, \\mathrm{Ca}} = (-70\\,\\mathrm{mV}) - (132.3\\,\\mathrm{mV}) = -202.3\\,\\mathrm{mV} $$\n$+132.3\\,\\mathrm{mV}$ 的能斯特电位是高度正的，这表明需要一个非常强的去极化电位才能阻止$\\mathrm{Ca}^{2+}$进入细胞。在 $-70\\,\\mathrm{mV}$ 的静息电位下，实际膜电位远低于 $E_{\\mathrm{Ca}}$。$-202.3\\,\\mathrm{mV}$ 的巨大负驱动力意味着带正电的$\\mathrm{Ca}^{2+}$离子有强大的热力学动力，顺着其电化学梯度流入细胞。这种巨大的驱动力是$\\mathrm{Ca}^{2+}$信号保真度的关键特征；它确保了即使只有少数$\\mathrm{Ca}^{2+}$通道打开，也能导致离子快速、大量的内流，从而引起胞质$[\\mathrm{Ca}^{2+}]$的局部急剧增加，有效触发下游的细胞反应。", "answer": "$$\\boxed{132.3}$$", "id": "4385284"}, {"introduction": "快速的信号需要同样高效的终止机制，以使细胞恢复到静息状态。本练习将运用米氏动力学原理来分析负责清除钙离子的离子泵（如SERCA和PMCA），让你能够量化它们在维持钙稳态中的作用。[@problem_id:4385295]", "problem": "在一个混合均匀的哺乳动物细胞的细胞质室中，胞质钙离子浓度 $[\\mathrm{Ca}^{2+}]$ 由两种转运ATP酶介导的清除过程调节：肌/内质网钙ATP酶 (SERCA) 和质膜钙ATP酶 (PMCA)。这两种泵都与胞质钙结合，并将其转运出细胞质溶胶（SERCA将其转运至内质网腔，PMCA将其转运至细胞外空间）。假设每种泵都通过单底物酶机制运行，其基元步骤为 $E + S \\rightleftharpoons ES \\rightarrow E + P$，其中 $S$ 代表 $\\mathrm{Ca}^{2+}$，并且酶-底物复合物 $ES$ 处于准稳态。总酶浓度 $E_T$ 是守恒的，并且 $ES$ 转化为产物的过程由一个催化速率常数来表征。每种泵的参数 $V_{\\max}$ 和 $K_m$ 由应用于此机制的标准准稳态推导定义。\n\n当胞质钙离子浓度 $[\\mathrm{Ca}^{2+}] = 0.5 \\,\\mu\\mathrm{M}$ 时，SERCA泵的参数为 $V_{\\max} = 5 \\,\\mu\\mathrm{M\\,s^{-1}}$ 和 $K_m = 0.2 \\,\\mu\\mathrm{M}$，而PMCA泵的参数为 $V_{\\max} = 1 \\,\\mu\\mathrm{M\\,s^{-1}}$ 和 $K_m = 0.3 \\,\\mu\\mathrm{M}$。将 SERCA 和 PMCA 的通量视为对胞质 $\\mathrm{Ca}^{2+}$ 清除的独立且可加的贡献，并忽略任何其他来源或汇。\n\n从单底物酶机制和准稳态假设出发，推导每种泵的 $\\mathrm{Ca}^{2+}$ 清除通量表达式，用 $V_{\\max}$、$K_m$ 和 $[\\mathrm{Ca}^{2+}]$ 表示。然后，使用所提供的参数值，计算在 $[\\mathrm{Ca}^{2+}] = 0.5 \\,\\mu\\mathrm{M}$ 时的净清除速率。以 $\\mu\\mathrm{M\\,s^{-1}}$ 为单位表示最终数值答案，并四舍五入至四位有效数字。", "solution": "对问题陈述的严格审查证实了其有效性。该问题在科学上基于酶动力学和细胞钙稳态的原理，这些是系统生物医学的核心。该问题提法恰当，为获得唯一解提供了所有必要的参数和假设。术语精确且客观。给定的 $V_{\\max}$、$K_m$ 和 $[\\mathrm{Ca}^{2+}]$ 值在生理上是合理的。因此，将进行推导和计算。\n\n问题首先要求从基本的单底物酶机制推导清除通量表达式：\n$$ E + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\stackrel{k_{cat}}{\\longrightarrow} E + P $$\n在这里，$E$ 代表转运ATP酶（SERCA或PMCA），$S$ 是底物，即胞质钙离子 $\\mathrm{Ca}^{2+}$，$P$ 是被转运的钙离子。这些物质的浓度表示为 $[E]$、$[S]$、$[ES]$ 和 $[P]$。正向结合、逆向解离和催化步骤的速率常数分别为 $k_1$、$k_{-1}$ 和 $k_{cat}$。\n\n酶-底物复合物 $[ES]$ 的形成速率由下式给出：\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_{cat}[ES] $$\n准稳态假设 (QSSA) 假定在初始瞬态阶段之后，中间复合物 $[ES]$ 的浓度大致保持不变，即 $\\frac{d[ES]}{dt} \\approx 0$。应用此假设可得：\n$$ k_1 [E][S] = (k_{-1} + k_{cat})[ES] $$\n总酶浓度 $[E_T]$ 是守恒的，因此 $[E_T] = [E] + [ES]$。因此，游离酶的浓度为 $[E] = [E_T] - [ES]$。将此代入稳态方程可得：\n$$ k_1 ([E_T] - [ES])[S] = (k_{-1} + k_{cat})[ES] $$\n我们现在可以解出 $[ES]$：\n$$ k_1 [E_T][S] - k_1 [ES][S] = (k_{-1} + k_{cat})[ES] $$\n$$ k_1 [E_T][S] = (k_{-1} + k_{cat} + k_1 [S])[ES] $$\n$$ [ES] = \\frac{k_1 [E_T][S]}{k_{-1} + k_{cat} + k_1 [S]} $$\n为简化此表达式，分子和分母同除以 $k_1$：\n$$ [ES] = \\frac{[E_T][S]}{\\frac{k_{-1} + k_{cat}}{k_1} + [S]} $$\n米氏常数 $K_m$ 定义为 $K_m = \\frac{k_{-1} + k_{cat}}{k_1}$。代入此定义可得：\n$$ [ES] = \\frac{[E_T][S]}{K_m + [S]} $$\n清除通量，即反应速率 ($v$)，是产物的生成速率，由 $v = k_{cat}[ES]$ 给出。代入 $[ES]$ 的表达式：\n$$ v = k_{cat} \\frac{[E_T][S]}{K_m + [S]} = \\frac{k_{cat}[E_T][S]}{K_m + [S]} $$\n当酶被底物饱和（$[S] \\gg K_m$）时，达到最大速率 $V_{\\max}$，此时 $[ES] \\approx [E_T]$。在这种情况下，$v = V_{\\max} = k_{cat}[E_T]$。将 $V_{\\max}$ 代入速率方程，得到米氏方程：\n$$ v = \\frac{V_{\\max}[S]}{K_m + [S]} $$\n对于此特定问题，底物是胞质钙，所以 $[S] = [\\mathrm{Ca}^{2+}]$。因此，每种泵的清除通量为：\n$$ v = \\frac{V_{\\max}[\\mathrm{Ca}^{2+}]}{K_m + [\\mathrm{Ca}^{2+}]} $$\n推导至此完成。\n\n接下来，我们计算净清除速率。问题陈述指出，SERCA 和 PMCA 泵的通量是独立的且可相加的。净清除速率 $v_{\\text{net}}$ 是单个通量 $v_{\\text{SERCA}}$ 和 $v_{\\text{PMCA}}$ 的和。\n$$ v_{\\text{net}} = v_{\\text{SERCA}} + v_{\\text{PMCA}} $$\n$$ v_{\\text{net}} = \\frac{V_{\\max, \\text{SERCA}}[\\mathrm{Ca}^{2+}]}{K_{m, \\text{SERCA}} + [\\mathrm{Ca}^{2+}]} + \\frac{V_{\\max, \\text{PMCA}}[\\mathrm{Ca}^{2+}]}{K_{m, \\text{PMCA}} + [\\mathrm{Ca}^{2+}]} $$\n给定的参数值为：\n$[\\mathrm{Ca}^{2+}] = 0.5 \\,\\mu\\mathrm{M}$\n对于 SERCA：$V_{\\max, \\text{SERCA}} = 5 \\,\\mu\\mathrm{M\\,s^{-1}}$ 和 $K_{m, \\text{SERCA}} = 0.2 \\,\\mu\\mathrm{M}$。\n对于 PMCA：$V_{\\max, \\text{PMCA}} = 1 \\,\\mu\\mathrm{M\\,s^{-1}}$ 和 $K_{m, \\text{PMCA}} = 0.3 \\,\\mu\\mathrm{M}$。\n\n我们计算每种泵的通量。所有单位都是一致的，所以我们可以直接使用数值进行计算。\n对于 SERCA：\n$$ v_{\\text{SERCA}} = \\frac{(5)(0.5)}{0.2 + 0.5} = \\frac{2.5}{0.7} = \\frac{25}{7} \\,\\mu\\mathrm{M\\,s^{-1}} $$\n对于 PMCA：\n$$ v_{\\text{PMCA}} = \\frac{(1)(0.5)}{0.3 + 0.5} = \\frac{0.5}{0.8} = \\frac{5}{8} \\,\\mu\\mathrm{M\\,s^{-1}} $$\n净清除速率是这两个通量之和：\n$$ v_{\\text{net}} = \\frac{25}{7} + \\frac{5}{8} = \\frac{25 \\times 8 + 5 \\times 7}{56} = \\frac{200 + 35}{56} = \\frac{235}{56} \\,\\mu\\mathrm{M\\,s^{-1}} $$\n为了得到最终的数值答案，我们进行除法运算：\n$$ v_{\\text{net}} = \\frac{235}{56} \\approx 4.19642857... \\,\\mu\\mathrm{M\\,s^{-1}} $$\n根据问题陈述的要求，四舍五入到四位有效数字，我们得到：\n$$ v_{\\text{net}} \\approx 4.196 \\,\\mu\\mathrm{M\\,s^{-1}} $$", "answer": "$$\\boxed{4.196}$$", "id": "4385295"}, {"introduction": "钙信号的真正复杂性在于其动态学特性，其中信息常常被编码在信号的振荡频率中。这项高级练习要求你建立一个定量模型，将钙振荡频率与下游的细胞响应（即NFAT的核输入）联系起来，从而架起从动态信号到功能输出的桥梁。[@problem_id:4385258]", "problem": "考虑一个典型的频率调制钙信号，该信号通过钙激活的蛋白磷酸酶3（钙调神经磷酸酶）（CaN）控制活化T细胞核因子（NFAT）的核输入。使用以下建模基础、参数定义和测试要求，建立一个从振荡频率到平均核输入速率（单位为 $s^{-1}$）的第一性原理定量映射。\n\n用作起点的建模基础：\n- 胞质钙浓度被建模为一个周期性方波 $C(t)$，在每个周期 $T$ 内，它在升高的水平 $C_{\\text{on}}$（持续时间为“开启”时长 $t_{\\text{on}}$）和基线水平 $C_{\\text{off}}$（持续时间为“关闭”时长 $t_{\\text{off}}$）之间交替。其中 $T = 1/f$，$f$ 是振荡频率。占空比为 $\\delta = t_{\\text{on}}/T$。\n- 钙通过协同结合激活钙调神经磷酸酶，该过程由希尔函数 $H(C) = \\dfrac{C^{n}}{K^{n} + C^{n}}$ 描述，其中 $K$ 是半活化浓度，$n$ 是希尔系数。\n- 钙调神经磷酸酶的活化分数，记为 $a(t) \\in [0,1]$，遵循一级质量作用动力学，其活化与 $H(C(t))$ 成正比，失活对 $a(t)$ 是一级反应。具体来说，$a(t)$ 根据定律 $\\dfrac{da}{dt} = k_{a} \\, H(C(t)) \\, \\left(1 - a(t)\\right) - k_{d} \\, a(t)$ 演化，其中 $k_{a}$ 和 $k_{d}$ 是速率常数，单位为 $s^{-1}$。\n- NFAT的瞬时核输入通量建模为 $r_{\\text{in}}(t) = k_{\\text{imp}} \\, a(t)$，其中 $k_{\\text{imp}}$ 是一个常数，单位为 $s^{-1}$。我们感兴趣的量是在 $a(t)$ 的周期性稳态下，作为振荡频率 $f$ 和占空比 $\\delta$ 函数的周期平均核输入速率 $\\overline{r_{\\text{in}}}$。\n\n您的任务：\n- 基于上述基础，推导当 $C(t)$ 是一个方波（在持续时间 $t_{\\text{on}} = \\delta/f$ 和 $t_{\\text{off}} = (1-\\delta)/f$ 内，常数分别为 $C_{\\text{on}}$ 和 $C_{\\text{off}}$）时，周期性稳态下钙调神经磷酸酶的周期平均活化分数 $\\overline{a}$ 的闭式表达式。使用该表达式获得 $\\overline{r_{\\text{in}}} = k_{\\text{imp}} \\, \\overline{a}$ 作为频率到输入速率的定量映射。\n- 在一个程序中实现推导出的表达式，为下面的测试套件计算 $\\overline{r_{\\text{in}}}$。\n\n要求的物理单位和输出：\n- 以 $s^{-1}$ 为单位表示 $\\overline{r_{\\text{in}}}$ 的最终数值。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个值都应四舍五入到六位小数，并且不带单位符号，例如：“[0.012345,0.067890]”。\n\n除非明确改变，否则对所有测试用例使用以下固定参数：\n- 钙活化希尔参数：$K = 0.3 \\,\\mu\\mathrm{M}$ 和 $n = 3$。\n- 钙调神经磷酸酶活化和失活速率：$k_{a} = 1.5 \\,\\mathrm{s}^{-1}$ 和 $k_{d} = 0.5 \\,\\mathrm{s}^{-1}$。\n- NFAT核输入比例常数：$k_{\\text{imp}} = 0.02 \\,\\mathrm{s}^{-1}$。\n\n测试套件：\n- 情况1（一般情况）：$f = 0.05 \\,\\mathrm{Hz}$，$\\delta = 0.25$，$C_{\\text{on}} = 0.8 \\,\\mu\\mathrm{M}$，$C_{\\text{off}} = 0.05 \\,\\mu\\mathrm{M}$。\n- 情况2（低频边界）：$f = 0.005 \\,\\mathrm{Hz}$，$\\delta = 0.25$，$C_{\\text{on}} = 0.8 \\,\\mu\\mathrm{M}$，$C_{\\text{off}} = 0.05 \\,\\mu\\mathrm{M}$。\n- 情况3（高频边界）：$f = 1.0 \\,\\mathrm{Hz}$，$\\delta = 0.25$，$C_{\\text{on}} = 0.8 \\,\\mu\\mathrm{M}$，$C_{\\text{off}} = 0.05 \\,\\mu\\mathrm{M}$。\n- 情况4（占空比边缘，无“开启”时间）：$f = 0.5 \\,\\mathrm{Hz}$，$\\delta = 0.0$，$C_{\\text{on}} = 0.8 \\,\\mu\\mathrm{M}$，$C_{\\text{off}} = 0.05 \\,\\mu\\mathrm{M}$。\n- 情况5（占空比边缘，完全“开启”时间）：$f = 0.5 \\,\\mathrm{Hz}$，$\\delta = 1.0$，$C_{\\text{on}} = 0.8 \\,\\mu\\mathrm{M}$，$C_{\\text{off}} = 0.05 \\,\\mu\\mathrm{M}$。\n- 情况6（近阈值振幅）：$f = 0.1 \\,\\mathrm{Hz}$，$\\delta = 0.25$，$C_{\\text{on}} = 0.25 \\,\\mu\\mathrm{M}$，$C_{\\text{off}} = 0.05 \\,\\mu\\mathrm{M}$。\n\n实现说明：\n- 在方波输入下计算 $a(t)$ 的周期性稳态，然后通过在“开启”和“关闭”子区间上对 $a(t)$ 进行积分并除以 $T$ 来计算周期平均值 $\\overline{a}$；到 $\\overline{r_{\\text{in}}}$ 的推导映射遵循 $\\overline{r_{\\text{in}}} = k_{\\text{imp}} \\, \\overline{a}$。\n- 确保所有测试用例的数值稳定性。", "solution": "用户提供的问题经评估有效。它在科学上基于生物化学动力学原理，数学上是适定的，其参数定义清晰且一致。因此，我们可以着手推导解决方案。\n\n问题要求计算转录因子NFAT的周期平均核输入速率 $\\overline{r_{\\text{in}}}$，该速率假定与钙调神经磷酸酶（CaN）的周期平均活化分数 $\\overline{a}$ 成正比。任务是在周期性方波钙信号 $C(t)$ 下，为 $\\overline{a}$ 推导一个闭式表达式，然后进行计算实现。\n\n钙调神经磷酸酶的活化分数 $a(t)$ 的动力学由以下一阶常微分方程（ODE）控制：\n$$\n\\frac{da}{dt} = k_{a} \\, H(C(t)) \\, \\left(1 - a(t)\\right) - k_{d} \\, a(t)\n$$\n其中 $H(C) = \\frac{C^{n}}{K^{n} + C^{n}}$ 是描述钙依赖性活化的希尔函数。该方程可以重排为线性一阶常微分方程的标准形式：\n$$\n\\frac{da}{dt} + \\left(k_a H(C(t)) + k_d\\right) a(t) = k_a H(C(t))\n$$\n钙信号 $C(t)$ 是一个频率为 $f$、占空比为 $\\delta$ 的周期性方波。在每个周期 $T=1/f$ 内，信号在高浓度 $C_{\\text{on}}$（持续时间 $t_{\\text{on}} = \\delta T = \\delta/f$）和低浓度 $C_{\\text{off}}$（持续时间 $t_{\\text{off}} = (1-\\delta)T = (1-\\delta)/f$）之间交替。\n\n在“开启”阶段（$0 \\le t  t_{\\text{on}}$），$C(t) = C_{\\text{on}}$。常微分方程变为：\n$$\n\\frac{da}{dt} + (k_a H(C_{\\text{on}}) + k_d) a(t) = k_a H(C_{\\text{on}})\n$$\n我们为“开启”阶段定义以下常量：\n- 希尔函数值：$H_{\\text{on}} = H(C_{\\text{on}}) = \\frac{C_{\\text{on}}^n}{K^n + C_{\\text{on}}^n}$\n- 有效速率常数：$k_{\\text{on}} = k_a H_{\\text{on}} + k_d$\n- 稳态活化水平：$a_{\\infty, \\text{on}} = \\frac{k_a H_{\\text{on}}}{k_a H_{\\text{on}} + k_d} = \\frac{k_a H_{\\text{on}}}{k_{\\text{on}}}$\n常微分方程简化为 $\\frac{da}{dt} = k_{\\text{on}}(a_{\\infty, \\text{on}} - a(t))$。\n\n同样，在“关闭”阶段（$t_{\\text{on}} \\le t  T$），$C(t) = C_{\\text{off}}$。常量为：\n- 希尔函数值：$H_{\\text{off}} = H(C_{\\text{off}}) = \\frac{C_{\\text{off}}^n}{K^n + C_{\\text{off}}^n}$\n- 有效速率常数：$k_{\\text{off}} = k_a H_{\\text{off}} + k_d$\n- 稳态活化水平：$a_{\\infty, \\text{off}} = \\frac{k_a H_{\\text{off}}}{k_a H_{\\text{off}} + k_d} = \\frac{k_a H_{\\text{off}}}{k_{\\text{off}}}$\n常微分方程简化为 $\\frac{da}{dt} = k_{\\text{off}}(a_{\\infty, \\text{off}} - a(t))$。\n\n对于形如 $\\frac{da}{dt} = k(a_\\infty - a)$ 且初始值为 $a(t_0) = a_{init}$ 的常微分方程，其通解为 $a(t) = a_\\infty + (a_{init} - a_\\infty)e^{-k(t-t_0)}$。\n\n令 $a_0 = a(0)$ 为周期性稳态下一个周期开始时的活化分数。在“开启”阶段，解为 $a(t) = a_{\\infty, \\text{on}} + (a_0 - a_{\\infty, \\text{on}})e^{-k_{\\text{on}}t}$。在“开启”阶段结束时，$t = t_{\\text{on}}$，其值为 $a_1 = a(t_{\\text{on}})$。\n$$\na_1 = a_{\\infty, \\text{on}} + (a_0 - a_{\\infty, \\text{on}})e^{-k_{\\text{on}}t_{\\text{on}}}\n$$\n在“关闭”阶段，从 $t=t_{\\text{on}}$ 时的 $a_1$ 开始，解为 $a(t) = a_{\\infty, \\text{off}} + (a_1 - a_{\\infty, \\text{off}})e^{-k_{\\text{off}}(t-t_{\\text{on}})}$。在完整周期结束时，$t = T = t_{\\text{on}}+t_{\\text{off}}$，其值为 $a_2 = a(T)$。\n$$\na_2 = a_{\\infty, \\text{off}} + (a_1 - a_{\\infty, \\text{off}})e^{-k_{\\text{off}}t_{\\text{off}}}\n$$\n对于周期性稳态，有 $a(T)=a(0)$，因此 $a_2 = a_0$。我们可以求解这个由两个线性方程组成的方程组来得到 $a_0$ 和 $a_1$。将第一个方程代入第二个方程并令 $a_2=a_0$，可得：\n$$\na_0 = \\frac{a_{\\infty, \\text{on}} e^{-k_{\\text{off}}t_{\\text{off}}}(1-e^{-k_{\\text{on}}t_{\\text{on}}}) + a_{\\infty, \\text{off}}(1-e^{-k_{\\text{off}}t_{\\text{off}}})}{1 - e^{-k_{\\text{on}}t_{\\text{on}}} e^{-k_{\\text{off}}t_{\\text{off}}}}\n$$\n由此，我们可以求得 $a_1$。\n\n我们感兴趣的量是周期平均活化分数 $\\overline{a}$：\n$$\n\\overline{a} = \\frac{1}{T} \\int_0^T a(t) dt = \\frac{1}{T} \\left( \\int_0^{t_{\\text{on}}} a(t) dt + \\int_{t_{\\text{on}}}^T a(t) dt \\right)\n$$\n积分可以直接从常微分方程求得。对于“开启”区间：\n$\\int_0^{t_{\\text{on}}} \\frac{da}{dt} dt = a_1 - a_0 = \\int_0^{t_{\\text{on}}} (k_{\\text{on}}a_{\\infty, \\text{on}} - k_{\\text{on}}a(t)) dt = k_{\\text{on}}a_{\\infty, \\text{on}}t_{\\text{on}} - k_{\\text{on}}\\int_0^{t_{\\text{on}}} a(t) dt$。\n这得到 $\\int_0^{t_{\\text{on}}} a(t) dt = a_{\\infty, \\text{on}}t_{\\text{on}} - \\frac{a_1 - a_0}{k_{\\text{on}}}$。\n同样，对于“关闭”区间：\n$\\int_{t_{\\text{on}}}^T a(t) dt = a_{\\infty, \\text{off}}t_{\\text{off}} - \\frac{a_0 - a_1}{k_{\\text{off}}}$。\n\n将这些相加并除以 $T$ 得到 $\\overline{a}$：\n$$\n\\overline{a} = \\frac{1}{T} \\left( a_{\\infty, \\text{on}}t_{\\text{on}} + a_{\\infty, \\text{off}}t_{\\text{off}} + (a_1 - a_0) \\left(\\frac{1}{k_{\\text{off}}} - \\frac{1}{k_{\\text{on}}}\\right) \\right)\n$$\n代入 $t_{\\text{on}}=\\delta/f$ 和 $t_{\\text{off}}=(1-\\delta)/f$：\n$$\n\\overline{a} = \\delta a_{\\infty, \\text{on}} + (1-\\delta) a_{\\infty, \\text{off}} + f (a_1 - a_0) \\left(\\frac{1}{k_{\\text{off}}} - \\frac{1}{k_{\\text{on}}}\\right)\n$$\n为完成推导，我们需要 $(a_1 - a_0)$ 的表达式。从稳态条件推导出的 $a_1$ 和 $a_0$ 表达式相减，得到一个紧凑形式：\n$$\na_1 - a_0 = (a_{\\infty, \\text{on}} - a_{\\infty, \\text{off}}) \\frac{(1 - e^{-k_{\\text{on}}t_{\\text{on}}})(1 - e^{-k_{\\text{off}}t_{\\text{off}}})}{1 - e^{-(k_{\\text{on}}t_{\\text{on}} + k_{\\text{off}}t_{\\text{off}})}}\n$$\n该表达式概括了 $a(t)$ 的振荡幅度。\n因此，从频率到输入速率的最终映射为 $\\overline{r_{\\text{in}}} = k_{\\text{imp}} \\, \\overline{a}$，其中 $\\overline{a}$ 使用上述公式计算。\n\n在实现时，需特别注意边缘情况。\n- 如果 $\\delta=0$，则 $t_{\\text{on}}=0$，系统始终处于关闭状态。项 $(1 - e^{-k_{\\text{on}}t_{\\text{on}}})$ 变为 $0$，因此 $a_1-a_0=0$。平均值简化为 $\\overline{a} = a_{\\infty, \\text{off}}$。\n- 如果 $\\delta=1$，则 $t_{\\text{off}}=0$，系统始终处于开启状态。项 $(1 - e^{-k_{\\text{off}}t_{\\text{off}}})$ 变为 $0$，因此 $a_1-a_0=0$。平均值简化为 $\\overline{a} = a_{\\infty, \\text{on}}$。\n这些极限在物理上是正确的，因为系统会平衡到恒定状态。\n\n为了数值稳定性，特别是在高频下指数接近于零时，形如 $1-e^{-x}$ 的表达式最好使用 `numpy.expm1(-x)` 来计算。\n\n以下程序实现了这个推导出的解决方案，用于在提供的测试套件中求解 $\\overline{r_{\\text{in}}}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the cycle-averaged NFAT nuclear import rate based on a frequency-modulated\n    calcium signal.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    K = 0.3  # muM\n    n = 3.0\n    k_a = 1.5  # s^-1\n    k_d = 0.5  # s^-1\n    k_imp = 0.02  # s^-1\n\n    # --- Test Suite ---\n    test_cases = [\n        # (f, delta, C_on, C_off)\n        (0.05, 0.25, 0.8, 0.05),  # Case 1: General case\n        (0.005, 0.25, 0.8, 0.05), # Case 2: Low-frequency\n        (1.0, 0.25, 0.8, 0.05),   # Case 3: High-frequency\n        (0.5, 0.0, 0.8, 0.05),    # Case 4: Duty cycle edge (delta=0)\n        (0.5, 1.0, 0.8, 0.05),    # Case 5: Duty cycle edge (delta=1)\n        (0.1, 0.25, 0.25, 0.05),  # Case 6: Near-threshold amplitude\n    ]\n\n    results = []\n    \n    for f, delta, C_on, C_off in test_cases:\n        # 1. Compute Hill function values\n        H_on = (C_on**n) / (K**n + C_on**n)\n        H_off = (C_off**n) / (K**n + C_off**n)\n\n        # 2. Compute kinetic parameters for each phase\n        k_on = k_a * H_on + k_d\n        k_off = k_a * H_off + k_d\n        \n        # 3. Compute steady-state values for each phase\n        a_inf_on = (k_a * H_on) / k_on\n        a_inf_off = (k_a * H_off) / k_off\n\n        # 4. Handle edge cases for duty cycle\n        if delta == 0.0:\n            avg_a = a_inf_off\n        elif delta == 1.0:\n            avg_a = a_inf_on\n        else:\n            # 5. For 0  delta  1, compute the full expression\n            # Time durations\n            t_on = delta / f\n            t_off = (1.0 - delta) / f\n\n            # Arguments for exponentials\n            x_on = k_on * t_on\n            x_off = k_off * t_off\n\n            # For numerical stability, use expm1 for terms like 1 - exp(-x)\n            # 1 - exp(-x) = -expm1(-x)\n            one_minus_E_on = -np.expm1(-x_on)\n            one_minus_E_off = -np.expm1(-x_off)\n            one_minus_E_on_E_off = -np.expm1(-(x_on + x_off))\n            \n            # Compute a1 - a0, the amplitude of the active fraction oscillation\n            # Check for division by zero, although theoretically one_minus_E_on_E_off > 0\n            if one_minus_E_on_E_off == 0:\n                # This limit corresponds to f -> infinity\n                H_avg = delta * H_on + (1.0 - delta) * H_off\n                avg_a = (k_a * H_avg) / (k_d + k_a * H_avg)\n            else:\n                a1_minus_a0_num = (a_inf_on - a_inf_off) * one_minus_E_on * one_minus_E_off\n                a1_minus_a0 = a1_minus_a0_num / one_minus_E_on_E_off\n\n                # Compute cycle-averaged active fraction\n                correction_term = f * a1_minus_a0 * (1.0/k_off - 1.0/k_on)\n                avg_a = delta * a_inf_on + (1.0 - delta) * a_inf_off + correction_term\n        \n        # 6. Compute final result: cycle-averaged import rate\n        r_in_avg = k_imp * avg_a\n        results.append(f\"{r_in_avg:.6f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4385258"}]}