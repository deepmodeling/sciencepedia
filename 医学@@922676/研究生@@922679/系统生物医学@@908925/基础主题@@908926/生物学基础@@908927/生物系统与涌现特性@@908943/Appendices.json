{"hands_on_practices": [{"introduction": "复杂的涌现行为通常源于简单的局部相互作用。基因“拨动开关”是系统生物学中的一个典型范例，它揭示了两个相互抑制的基因如何能够产生双稳态——一种“全有或全无”的细胞决策基础。这个练习将指导你通过线性稳定性分析，从第一性原理出发，解析地推导出这一基本模块产生双稳态所需的条件[@problem_id:4320312]。掌握这项技能对于理解和设计能够执行逻辑功能的合成基因线路至关重要。", "problem": "考虑一个对称双基因拨动开关，其中每个基因都通过希尔（Hill）型结合来抑制另一个基因，其抑制函数为 $f(x) = \\frac{1}{1 + \\left(\\frac{x}{K}\\right)^{n}}$。令 $x(t)$ 和 $y(t)$ 表示两种基因产物的浓度。该动力学由以下常微分方程组 (ODEs) 建模\n$$\n\\frac{dx}{dt} = \\beta\\,f(y) - \\gamma\\,x,\\quad \\frac{dy}{dt} = \\beta\\,f(x) - \\gamma\\,y,\n$$\n其中 $\\beta > 0$ 是最大产出率，$\\gamma > 0$ 是一阶降解率。引入无量纲参数 $\\,\\alpha = \\frac{\\beta}{\\gamma}\\,$ 并通过 $\\tau = \\gamma t$ 重标定时间，得到无量纲系统\n$$\n\\frac{dx}{d\\tau} = \\alpha\\,f(y) - x,\\quad \\frac{dy}{d\\tau} = \\alpha\\,f(x) - y.\n$$\n从平衡和线性稳定性的定义出发，并且仅使用第一性原理（零斜线的存在性和基于雅可比矩阵的局部稳定性），推导在线 $x=y$ 上的对称平衡点失去稳定性以及系统呈现出两个不同稳定平衡点（双稳态）的条件。对于固定的 $\\alpha > 0$，确定分岔边界 $K_{\\mathrm{crit}}(n)$ 的精确闭式解析表达式（用 $\\alpha$ 和 $n$ 表示），该边界将对称拨动开关的单稳态区域（一个稳定平衡点）与双稳态区域（两个稳定平衡点）分隔开。你的推导必须从平衡条件和对称平衡点处的雅可比矩阵特征值开始，并且不得假定任何预先推导出的分岔公式。用与 $x$ 和 $y$ 相同的浓度单位表示你的最终边界 $K_{\\mathrm{crit}}(n)$。无需数值近似或四舍五入。最终答案必须是单个闭式表达式。", "solution": "用户提供的问题已经过严格验证，确认其科学性、适定性和客观性。没有可识别的缺陷。该问题是动力系统稳定性分析中的一个标准练习，应用于系统生物学中的一个典范模型。所有必要的定义和参数都已提供，任务是从第一性原理推导出一个特定的解析结果。\n\n解答过程如下。\n\n系统的动力学由以下无量纲常微分方程组（ODEs）描述：\n$$\n\\frac{dx}{d\\tau} = \\alpha\\,f(y) - x\n$$\n$$\n\\frac{dy}{d\\tau} = \\alpha\\,f(x) - y\n$$\n其中 $f(z) = \\frac{1}{1 + \\left(\\frac{z}{K}\\right)^{n}}$。\n\n系统的一个平衡点，或不动点，$(x^*, y^*)$ 是时间导数为零的点。这要求：\n$$\nx^* = \\alpha\\,f(y^*)\n$$\n$$\ny^* = \\alpha\\,f(x^*)\n$$\n该问题要求分析位于直线 $x = y$ 上的对称平衡点。设该平衡点为 $(x_s^*, x_s^*)$，其中 $x_s^*$ 满足方程：\n$$\nx_s^* = \\alpha\\,f(x_s^*) = \\frac{\\alpha}{1 + \\left(\\frac{x_s^*}{K}\\right)^{n}}\n$$\n为确定此平衡点的稳定性，我们进行线性稳定性分析。这涉及到计算系统的雅可比矩阵 $J$，该矩阵是常微分方程组右侧函数的偏导数矩阵。令 $F(x, y) = \\alpha\\,f(y) - x$ 和 $G(x, y) = \\alpha\\,f(x) - y$。雅可比矩阵为：\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial F}{\\partial x}  \\frac{\\partial F}{\\partial y} \\\\ \\frac{\\partial G}{\\partial x}  \\frac{\\partial G}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} -1  \\alpha\\,f'(y) \\\\ \\alpha\\,f'(x)  -1 \\end{pmatrix}\n$$\n我们需要Hill函数 $f'(z)$ 的导数：\n$$\nf'(z) = \\frac{d}{dz}\\left(1 + \\left(\\frac{z}{K}\\right)^{n}\\right)^{-1} = -\\left(1 + \\left(\\frac{z}{K}\\right)^{n}\\right)^{-2} \\cdot n\\left(\\frac{z}{K}\\right)^{n-1} \\cdot \\frac{1}{K} = -\\frac{n}{K} \\frac{\\left(\\frac{z}{K}\\right)^{n-1}}{\\left(1 + \\left(\\frac{z}{K}\\right)^{n}\\right)^2}\n$$\n注意，对于具有物理意义的参数（$z>0, K>0, n>0$），$f'(z)$ 总是负的。\n\n我们计算在对称平衡点 $(x_s^*, x_s^*)$ 处的雅可比矩阵：\n$$\nJ(x_s^*, x_s^*) = \\begin{pmatrix} -1  \\alpha\\,f'(x_s^*) \\\\ \\alpha\\,f'(x_s^*)  -1 \\end{pmatrix}\n$$\n平衡点的稳定性由该矩阵的特征值 $\\lambda$ 决定。特征值是特征方程 $\\det(J - \\lambda I) = 0$ 的根：\n$$\n\\det\\begin{pmatrix} -1-\\lambda  \\alpha\\,f'(x_s^*) \\\\ \\alpha\\,f'(x_s^*)  -1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1-\\lambda)^2 - (\\alpha\\,f'(x_s^*))^2 = 0\n$$\n$$\n(1+\\lambda)^2 = (\\alpha\\,f'(x_s^*))^2\n$$\n$$\n1+\\lambda = \\pm \\alpha\\,f'(x_s^*)\n$$\n这给出了两个实数特征值：\n$$\n\\lambda_1 = -1 + \\alpha\\,f'(x_s^*)\n$$\n$$\n\\lambda_2 = -1 - \\alpha\\,f'(x_s^*)\n$$\n对称平衡点是稳定的，当且仅当两个特征值都为负。\n由于 $\\alpha > 0$ 且 $f'(x_s^*)  0$，第一个特征值 $\\lambda_1 = -1 + \\alpha f'(x_s^*)$ 总是负的。\n因此，稳定性完全由 $\\lambda_2$ 的符号决定。如果 $\\lambda_2  0$，平衡点是稳定的；如果 $\\lambda_2 > 0$，则是不稳定的。\n稳定的条件是：\n$$\n\\lambda_2 = -1 - \\alpha\\,f'(x_s^*)  0 \\implies -1  \\alpha\\,f'(x_s^*)\n$$\n系统通过一个叉式分岔，从拥有一个稳定的对称平衡点（单稳态）过渡到拥有两个新的稳定非对称平衡点和一个不稳定的对称平衡点（双稳态）。这个分岔恰好在对称平衡点失去其稳定性时发生，即当 $\\lambda_2=0$ 时。\n因此，分岔条件是：\n$$\n\\lambda_2 = -1 - \\alpha\\,f'(x_s^*) = 0 \\implies \\alpha\\,f'(x_s^*) = -1\n$$\n为了找到分岔边界 $K_{\\mathrm{crit}}(n)$，我们必须找到使不动点 $x_s^*$ 同时满足平衡条件和分岔条件的参数值。这给出了一个关于两个未知数 $x_s^*$ 和 $K$ 的方程组：\n$$\n(1) \\quad x_s^* = \\frac{\\alpha}{1 + (x_s^*/K)^n}\n$$\n$$\n(2) \\quad \\alpha \\left( -\\frac{n}{K} \\frac{(x_s^*/K)^{n-1}}{(1 + (x_s^*/K)^n)^2} \\right) = -1 \\implies \\frac{\\alpha n}{K} \\frac{(x_s^*/K)^{n-1}}{(1 + (x_s^*/K)^n)^2} = 1\n$$\n我们可以解这个方程组。从方程（1）中，我们可以将方程（2）的分母以更简单的形式表示：\n$$\n1 + \\left(\\frac{x_s^*}{K}\\right)^n = \\frac{\\alpha}{x_s^*}\n$$\n将此代入方程（2）：\n$$\n\\frac{\\alpha n}{K} \\frac{(x_s^*/K)^{n-1}}{(\\alpha/x_s^*)^2} = 1\n$$\n$$\n\\frac{\\alpha n}{K} \\frac{x_s^{*(n-1)}}{K^{n-1}} \\frac{x_s^{*2}}{\\alpha^2} = 1\n$$\n$$\n\\frac{n x_s^{*(n-1+2)}}{\\alpha K^{1+n-1}} = 1 \\implies \\frac{n x_s^{*(n+1)}}{\\alpha K^n} = 1\n$$\n解出 $x_s^*$：\n$$\nx_s^{*(n+1)} = \\frac{\\alpha K^n}{n} \\implies x_s^* = \\left(\\frac{\\alpha K^n}{n}\\right)^{\\frac{1}{n+1}}\n$$\n这个表达式给出了分岔发生瞬间对称不动点处的浓度。现在，我们将此表达式代回平衡条件，即方程（1），以找到边界上参数 $K$、$\\alpha$ 和 $n$ 之间的关系。整理方程（1）得到 $x_s^*(1 + (x_s^*/K)^n) = \\alpha$。代入我们关于 $x_s^*$ 的表达式：\n$$\n\\left(\\frac{\\alpha K^n}{n}\\right)^{\\frac{1}{n+1}} \\left( 1 + \\frac{1}{K^n} \\left[ \\left(\\frac{\\alpha K^n}{n}\\right)^{\\frac{1}{n+1}} \\right]^n \\right) = \\alpha\n$$\n$$\n\\left(\\frac{\\alpha K^n}{n}\\right)^{\\frac{1}{n+1}} \\left( 1 + \\frac{1}{K^n} \\left(\\frac{\\alpha K^n}{n}\\right)^{\\frac{n}{n+1}} \\right) = \\alpha\n$$\n我们来简化括号内的项：\n$$\n1 + \\frac{1}{K^n} \\frac{\\alpha^{\\frac{n}{n+1}} K^{\\frac{n^2}{n+1}}}{n^{\\frac{n}{n+1}}} = 1 + \\frac{\\alpha^{\\frac{n}{n+1}} K^{\\frac{n^2}{n+1}-n}}{n^{\\frac{n}{n+1}}} = 1 + \\frac{\\alpha^{\\frac{n}{n+1}} K^{-\\frac{n}{n+1}}}{n^{\\frac{n}{n+1}}}\n$$\n将此代回主方程：\n$$\n\\frac{\\alpha^{\\frac{1}{n+1}} K^{\\frac{n}{n+1}}}{n^{\\frac{1}{n+1}}} \\left( 1 + \\frac{\\alpha^{\\frac{n}{n+1}}}{n^{\\frac{n}{n+1}} K^{\\frac{n}{n+1}}} \\right) = \\alpha\n$$\n展开左侧的项：\n$$\n\\frac{\\alpha^{\\frac{1}{n+1}} K^{\\frac{n}{n+1}}}{n^{\\frac{1}{n+1}}} + \\frac{\\alpha^{\\frac{1}{n+1}} K^{\\frac{n}{n+1}}}{n^{\\frac{1}{n+1}}} \\cdot \\frac{\\alpha^{\\frac{n}{n+1}}}{n^{\\frac{n}{n+1}} K^{\\frac{n}{n+1}}} = \\alpha\n$$\n$$\n\\frac{\\alpha^{\\frac{1}{n+1}} K^{\\frac{n}{n+1}}}{n^{\\frac{1}{n+1}}} + \\frac{\\alpha^{\\frac{1}{n+1}+\\frac{n}{n+1}}}{n^{\\frac{1}{n+1}+\\frac{n}{n+1}}} = \\alpha\n$$\n$$\n\\frac{\\alpha^{\\frac{1}{n+1}} K^{\\frac{n}{n+1}}}{n^{\\frac{1}{n+1}}} + \\frac{\\alpha}{n} = \\alpha\n$$\n现在，我们分离出包含 $K$ 的项：\n$$\n\\frac{\\alpha^{\\frac{1}{n+1}} K^{\\frac{n}{n+1}}}{n^{\\frac{1}{n+1}}} = \\alpha - \\frac{\\alpha}{n} = \\alpha \\left(1 - \\frac{1}{n}\\right) = \\alpha \\frac{n-1}{n}\n$$\n为了解出 $K$，我们首先将其他因子移到等式右侧：\n$$\nK^{\\frac{n}{n+1}} = \\frac{n-1}{n} \\cdot \\alpha \\cdot \\frac{n^{\\frac{1}{n+1}}}{\\alpha^{\\frac{1}{n+1}}} = \\frac{n-1}{n} \\cdot n^{\\frac{1}{n+1}} \\cdot \\alpha^{1-\\frac{1}{n+1}} = \\frac{n-1}{n} \\cdot n^{\\frac{1}{n+1}} \\cdot \\alpha^{\\frac{n}{n+1}}\n$$\n最后，我们将两边同时取 $\\frac{n+1}{n}$ 次方来解出 $K$，即 $K_{\\mathrm{crit}}$：\n$$\nK_{\\mathrm{crit}}(n) = \\left( \\frac{n-1}{n} \\cdot n^{\\frac{1}{n+1}} \\cdot \\alpha^{\\frac{n}{n+1}} \\right)^{\\frac{n+1}{n}}\n$$\n$$\nK_{\\mathrm{crit}}(n) = \\left(\\frac{n-1}{n}\\right)^{\\frac{n+1}{n}} \\cdot (n^{\\frac{1}{n+1}})^{\\frac{n+1}{n}} \\cdot (\\alpha^{\\frac{n}{n+1}})^{\\frac{n+1}{n}}\n$$\n$$\nK_{\\mathrm{crit}}(n) = \\left(\\frac{n-1}{n}\\right)^{\\frac{n+1}{n}} \\cdot n^{\\frac{1}{n}} \\cdot \\alpha\n$$\n这个表达式可以进一步简化：\n$$\nK_{\\mathrm{crit}}(n) = \\alpha \\cdot n^{\\frac{1}{n}} \\cdot (n-1)^{\\frac{n+1}{n}} \\cdot n^{-\\frac{n+1}{n}} = \\alpha \\cdot (n-1)^{\\frac{n+1}{n}} \\cdot n^{\\frac{1}{n} - \\frac{n+1}{n}}\n$$\n$$\nK_{\\mathrm{crit}}(n) = \\alpha \\cdot (n-1)^{\\frac{n+1}{n}} \\cdot n^{\\frac{1-n-1}{n}} = \\alpha \\cdot (n-1)^{\\frac{n+1}{n}} \\cdot n^{-1}\n$$\n这就给出了分岔边界的最终闭式解析表达式：\n$$\nK_{\\mathrm{crit}}(n) = \\frac{\\alpha}{n} (n-1)^{\\frac{n+1}{n}}\n$$\n这个边界分隔了单稳态和双稳态区域。请注意，为使此表达式为实数且为正，我们必须有 $n>1$，这是拨动开关中实现双稳态的众所周知条件（即，需要一定程度的协同性）。", "answer": "$$\\boxed{\\frac{\\alpha}{n} (n-1)^{\\frac{n+1}{n}}}$$", "id": "4320312"}, {"introduction": "双稳态系统的一个关键宏观特征是“迟滞”现象，即系统的响应不仅取决于当前的输入，还依赖于其过去的状态，表现出一种形式的“细胞记忆”。这个计算练习让你将抽象的双稳态理论与可观测的动力学行为联系起来。你将通过数值模拟一个带有正反馈的信号通路，在缓慢变化的刺激下，亲手绘制并量化迟滞环，从而直观地理解系统如何在动力学上演绎其内在的双稳态特性[@problem_id:4320335]。", "problem": "考虑一个表现出正反馈和饱和非线性的最小、充分混合的信号模块，该模块被建模为单一动力学变量 $x(t)$，代表活化信号效应子的浓度。该模块接收一个随时间缓慢变化（扫描）的外部刺激 $S(t)$。$x(t)$ 的时间演化由以下常微分方程给出\n$$\n\\frac{dx}{dt} \\;=\\; v_{\\mathrm{basal}} \\;+\\; v_{\\mathrm{act}}(S(t), x(t)) \\;-\\; v_{\\mathrm{deg}}(x(t)),\n$$\n其中 $v_{\\mathrm{basal}}$ 是一个恒定的基础生产项，$v_{\\mathrm{act}}(S, x)$ 是一个激活项，其对 $S$ 的依赖性呈饱和状态，并对 $x$ 具有协同正反馈作用，$v_{\\mathrm{deg}}(x)$ 是一个饱和降解项。基于酶饱和和协同结合的原理，使用 Michaelis–Menten 和 Hill 型函数对这些项进行建模：\n$$\nv_{\\mathrm{act}}(S, x) \\;=\\; k_{\\mathrm{act}} \\cdot \\frac{S}{K_S + S} \\cdot \\frac{x^n}{K_{\\mathrm{fb}}^n + x^n}, \\quad\nv_{\\mathrm{deg}}(x) \\;=\\; k_{\\mathrm{deg}} \\cdot \\frac{x}{K_{\\mathrm{deg}} + x}.\n$$\n假设刺激 $S(t)$ 以一个小的正速率 $r$ 从 $S_{\\min}$ 线性扫描到 $S_{\\max}$（“上升扫描”），\n$$\nS_{\\uparrow}(t) \\;=\\; S_{\\min} + r\\,t, \\quad t \\in [0, T_{\\uparrow}], \\quad T_{\\uparrow} = \\frac{S_{\\max} - S_{\\min}}{r},\n$$\n然后再以相同的速率大小从 $S_{\\max}$ 扫描回 $S_{\\min}$（“下降扫描”），\n$$\nS_{\\downarrow}(t) \\;=\\; S_{\\max} - r\\,t, \\quad t \\in [0, T_{\\downarrow}], \\quad T_{\\downarrow} = \\frac{S_{\\max} - S_{\\min}}{r}.\n$$\n为了探究由饱和引起的非线性和正反馈所产生的滞后现象，将“滞后回线”定义为函数对 $x_{\\uparrow}(S)$ 和 $x_{\\downarrow}(S)$，它们分别通过在上升扫描和下降扫描期间对上述动力学进行积分，并在扫描轨迹上对应相同的 $S$ 值采样 $x(t)$ 得到。通过计算这些曲线之间的面积来量化滞后现象，\n$$\n\\mathcal{A} \\;=\\; \\int_{S_{\\min}}^{S_{\\max}} \\left| x_{\\uparrow}(S) - x_{\\downarrow}(S) \\right| \\, dS,\n$$\n该面积通过在指定的 $S$ 值网格上使用梯形法则进行数值计算。定义一个布尔型的滞后指示器 $\\mathsf{H} = (\\mathcal{A} > \\varepsilon)$，其中 $\\varepsilon$ 是一个很小的阈值。\n\n实现一个程序，该程序：\n- 从初始条件 $x(0) = x_0$ 开始，使用 $S_{\\uparrow}(t)$ 对上升扫描动力学进行积分，然后从上升扫描的最终状态开始，使用 $S_{\\downarrow}(t)$ 对下降扫描动力学进行积分。\n- 在一个包含 $N$ 个点的均匀 $S$ 网格上采样 $x_{\\uparrow}(S)$ 和 $x_{\\downarrow}(S)$，通过梯形法则计算 $\\mathcal{A}$，并根据阈值 $\\varepsilon$ 设置 $\\mathsf{H}$。\n- 使用一个能够处理刚性问题的求解器，并设置适合慢速扫描和潜在急剧转变的容差。\n\n除非另有说明，所有运行均使用以下固定的数值规格：\n- 初始条件：$x_0 = 0.01$。\n- $N = 201$ 个在 $[S_{\\min}, S_{\\max}]$ 区间内均匀分布的 $S$ 点。\n- 阈值：$\\varepsilon = 10^{-3}$。\n- 求解器绝对容差 $10^{-10}$，相对容差 $10^{-8}$。\n- 使用刚性问题求解器方法。\n\n测试套件：\n对于下面的每一组参数，运行模拟并报告滞后面积 $\\mathcal{A}$（浮点数）和滞后指示器 $\\mathsf{H}$（布尔值）。\n\n- 案例 1（预期的双稳态/滞后）：\n  - $v_{\\mathrm{basal}} = 0.05$\n  - $k_{\\mathrm{act}} = 2.5$\n  - $K_S = 0.3$\n  - $K_{\\mathrm{fb}} = 0.4$\n  - $n = 4$\n  - $k_{\\mathrm{deg}} = 3.0$\n  - $K_{\\mathrm{deg}} = 0.2$\n  - $S_{\\min} = 0.0$\n  - $S_{\\max} = 2.0$\n  - $r = 5 \\times 10^{-3}$\n\n- 案例 2（接近阈值，弱滞后）：\n  - $v_{\\mathrm{basal}} = 0.05$\n  - $k_{\\mathrm{act}} = 1.5$\n  - $K_S = 0.3$\n  - $K_{\\mathrm{fb}} = 0.7$\n  - $n = 3$\n  - $k_{\\mathrm{deg}} = 3.0$\n  - $K_{\\mathrm{deg}} = 0.25$\n  - $S_{\\min} = 0.0$\n  - $S_{\\max} = 2.0$\n  - $r = 5 \\times 10^{-3}$\n\n- 案例 3（单稳态，无滞后）：\n  - $v_{\\mathrm{basal}} = 0.05$\n  - $k_{\\mathrm{act}} = 0.8$\n  - $K_S = 0.3$\n  - $K_{\\mathrm{fb}} = 3.0$\n  - $n = 1$\n  - $k_{\\mathrm{deg}} = 3.0$\n  - $K_{\\mathrm{deg}} = 0.4$\n  - $S_{\\min} = 0.0$\n  - $S_{\\max} = 2.0$\n  - $r = 5 \\times 10^{-3}$\n\n最终输出格式：\n你的程序应生成单行输出，其中包含三个案例的结果，格式为逗号分隔的 Python 风格列表，列表中包含成对的 $[\\mathcal{A}, \\mathsf{H}]$，顺序与上述案例规定的一致。例如，输出应如下所示\n`[[A_1, H_1],[A_2, H_2],[A_3, H_3]]`\n其中每个 $A_i$ 是一个浮点数，每个 $H_i$ 是 `True` 或 `False`。输出中不需要单位，因为根据构造，这些量是无量纲的。", "solution": "该问题要求分析一个由单一常微分方程（ODE）描述的极简生物信号模块中的滞后现象。该分析涉及在缓慢变化的外部刺激下对系统动力学进行数值积分，然后量化所得的滞后回线面积。\n\n系统状态的时间演化由活化信号效应子浓度 $x(t)$ 表示，并由以下常微分方程控制：\n$$\n\\frac{dx}{dt} \\;=\\; f(t, x) \\;=\\; v_{\\mathrm{basal}} \\;+\\; v_{\\mathrm{act}}(S(t), x(t)) \\;-\\; v_{\\mathrm{deg}}(x(t))\n$$\n该方程平衡了 $x$ 的变化率与三个过程：\n1.  一个恒定的基础生产率，$v_{\\mathrm{basal}}$。\n2.  一个激活率，$v_{\\mathrm{act}}(S, x)$，它同时依赖于外部刺激 $S$ 和浓度 $x$ 本身。该项模拟了一个正反馈回路。\n3.  一个降解率，$v_{\\mathrm{deg}}(x)$。\n\n激活率和降解率的具体函数形式由标准的生物化学动力学模型给出：\n$$\nv_{\\mathrm{act}}(S, x) \\;=\\; k_{\\mathrm{act}} \\cdot \\frac{S}{K_S + S} \\cdot \\frac{x^n}{K_{\\mathrm{fb}}^n + x^n}\n$$\n$$\nv_{\\mathrm{deg}}(x) \\;=\\; k_{\\mathrm{deg}} \\cdot \\frac{x}{K_{\\mathrm{deg}} + x}\n$$\n激活项包含了两种饱和现象：对刺激 $S$ 的依赖性遵循类似 Michaelis–Menten 的形式，而对 $x$ 的正反馈则由一个带有 Hill 系数 $n$ 的协同 Hill 函数描述。降解项也遵循类似 Michaelis–Menten 的饱和动力学。非线性正反馈和饱和的结合是在生物系统中产生双稳态的常见模体。\n\n双稳态，即系统在同一组外部条件下能够存在于两个不同稳定状态的能力，可以通过观察滞后现象来揭示。滞后现象是指系统状态对其历史的依赖性。在此背景下，我们通过将刺激 $S$ 从低值 $S_{\\min}$ 缓慢扫描到高值 $S_{\\max}$，然后再扫描回来，来探测滞后现象。如果系统是双稳态的，那么 $x$ 在上升扫描期间的轨迹 $x_{\\uparrow}(S)$ 将不同于其在下降扫描期间的轨迹 $x_{\\downarrow}(S)$。\n\n量化此现象的数值步骤如下：\n1.  **刺激域离散化**：在区间 $[S_{\\min}, S_{\\max}]$ 上为刺激 $S$ 定义一个包含 $N$ 个点的均匀网格。\n2.  **上升扫描模拟**：在时间区间 $t \\in [0, T_{\\uparrow}]$（其中 $T_{\\uparrow} = (S_{\\max} - S_{\\min})/r$）上对控制常微分方程进行积分。刺激定义为 $S_{\\uparrow}(t) = S_{\\min} + rt$。积分从初始条件 $x(0) = x_0$ 开始。使用能够处理刚性问题的数值求解器（如后向分化公式（BDF）方法）求解该常微分方程，该方法适用于具有潜在快慢动力学（尤其是在分岔点附近）的系统。在与预定义的 $S$ 网格相对应的时间点上评估解 $x(t)$，从而得到轨迹 $x_{\\uparrow}(S)$。\n3.  **下降扫描模拟**：从上升扫描的最终状态 $x(T_{\\uparrow})$ 开始，再次在相同持续时间的时间区间 $t \\in [0, T_{\\downarrow}]$ 上对常微分方程进行积分。此时，刺激根据 $S_{\\downarrow}(t) = S_{\\max} - rt$ 向下扫描。同样，在与同一 $S$ 网格相对应的时间点上评估解 $x(t)$，得到轨迹 $x_{\\downarrow}(S)$。\n4.  **滞后面积计算**：由两条轨迹所包围的面积 $\\mathcal{A}$ 是滞后的定量度量。它是通过在刺激范围内对上升扫描和下降扫描曲线之间的绝对差进行数值积分来计算的：\n    $$\n    \\mathcal{A} \\;=\\; \\int_{S_{\\min}}^{S_{\\max}} \\left| x_{\\uparrow}(S) - x_{\\downarrow}(S) \\right| \\, dS\n    $$\n    该积分在离散化网格上使用梯形法则计算。\n5.  **滞后指示器**：定义一个布尔指示器 $\\mathsf{H}$，用于根据计算出的面积 $\\mathcal{A}$ 是否超过一个预定义的小阈值 $\\varepsilon$ 来将系统分类为滞后或非滞后。$\\mathsf{H} = (\\mathcal{A} > \\varepsilon)$。\n\n对三组不同的参数集实施这整个过程，这三组参数分别设计用于展示强滞后、弱滞后和无滞后，从而测试模型在不同动态区域下的行为。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Fixed numerical specifications\n    x0 = 0.01\n    N = 201\n    epsilon = 1e-3\n    atol = 1e-10\n    rtol = 1e-8\n    solver_method = 'BDF'\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case 1 (expected bistability/hysteresis)\n        {\n            \"v_basal\": 0.05, \"k_act\": 2.5, \"K_S\": 0.3, \"K_fb\": 0.4, \"n\": 4,\n            \"k_deg\": 3.0, \"K_deg\": 0.2, \"S_min\": 0.0, \"S_max\": 2.0, \"r\": 5e-3\n        },\n        # Case 2 (near-threshold, weak hysteresis)\n        {\n            \"v_basal\": 0.05, \"k_act\": 1.5, \"K_S\": 0.3, \"K_fb\": 0.7, \"n\": 3,\n            \"k_deg\": 3.0, \"K_deg\": 0.25, \"S_min\": 0.0, \"S_max\": 2.0, \"r\": 5e-3\n        },\n        # Case 3 (monostable, no hysteresis)\n        {\n            \"v_basal\": 0.05, \"k_act\": 0.8, \"K_S\": 0.3, \"K_fb\": 3.0, \"n\": 1,\n            \"k_deg\": 3.0, \"K_deg\": 0.4, \"S_min\": 0.0, \"S_max\": 2.0, \"r\": 5e-3\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(params, x0, N, epsilon, atol, rtol, solver_method)\n        results.append(result)\n        \n    # Format the output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef ode_system(t, x, params, sweep_direction):\n    \"\"\"\n    Defines the right-hand side of the ODE system.\n    dx/dt = f(t, x)\n    \"\"\"\n    x_val = x[0]\n    \n    # Unpack parameters\n    v_basal = params[\"v_basal\"]\n    k_act = params[\"k_act\"]\n    K_S = params[\"K_S\"]\n    K_fb = params[\"K_fb\"]\n    n = params[\"n\"]\n    k_deg = params[\"k_deg\"]\n    K_deg = params[\"K_deg\"]\n    S_min = params[\"S_min\"]\n    S_max = params[\"S_max\"]\n    r = params[\"r\"]\n\n    # Calculate stimulus S(t) based on sweep direction\n    if sweep_direction == 'up':\n        S = S_min + r * t\n    else:  # 'down'\n        S = S_max - r * t\n    \n    # Clamp S to its defined range to avoid floating point inaccuracies near boundaries\n    S = np.clip(S, S_min, S_max)\n    \n    # Calculate rate terms\n    v_act = k_act * (S / (K_S + S)) * (x_val**n / (K_fb**n + x_val**n))\n    v_deg = k_deg * (x_val / (K_deg + x_val))\n    \n    # Return the derivative\n    return [v_basal + v_act - v_deg]\n\ndef run_simulation(params, x0, N, epsilon, atol, rtol, method):\n    \"\"\"\n    Performs the up-sweep and down-sweep simulations for a given set of parameters.\n    \"\"\"\n    S_min = params[\"S_min\"]\n    S_max = params[\"S_max\"]\n    r = params[\"r\"]\n    \n    # Define stimulus grid and time intervals\n    S_grid = np.linspace(S_min, S_max, N)\n    T_sweep = (S_max - S_min) / r\n    t_span = (0, T_sweep)\n\n    # --- Up-sweep simulation ---\n    # `t_eval` points are chosen to correspond to the uniform `S_grid`\n    t_eval_up = (S_grid - S_min) / r\n    sol_up = solve_ivp(\n        ode_system, t_span, [x0],\n        method=method,\n        t_eval=t_eval_up,\n        rtol=rtol, atol=atol,\n        args=(params, 'up')\n    )\n    x_up = sol_up.y[0]\n    \n    # Initial condition for down-sweep is the final state of up-sweep\n    x0_down = x_up[-1]\n\n    # --- Down-sweep simulation ---\n    # `t_eval` must be sorted, so we evaluate at times corresponding to\n    # S from S_max down to S_min, which means t from 0 to T_sweep.\n    # We use a reversed S_grid to generate a sorted t_eval array.\n    S_grid_rev = S_grid[::-1]\n    t_eval_down = (S_max - S_grid_rev) / r\n    sol_down = solve_ivp(\n        ode_system, t_span, [x0_down],\n        method=method,\n        t_eval=t_eval_down,\n        rtol=rtol, atol=atol,\n        args=(params, 'down')\n    )\n    # The solution `sol_down.y` corresponds to `S_grid_rev` (S decreasing).\n    # We reverse it to align with `S_grid` (S increasing).\n    x_down = sol_down.y[0][::-1]\n\n    # --- Hysteresis analysis ---\n    # Calculate area using the trapezoidal rule\n    area = np.trapz(np.abs(x_up - x_down), x=S_grid)\n\n    # Determine hysteresis indicator\n    is_hysteretic = area > epsilon\n    \n    return [area, is_hysteretic]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "4320335"}, {"introduction": "确定性模型为我们理解生物系统提供了清晰的框架，但真实的细胞环境充满了随机噪声。这个练习将我们带入更为真实的随机世界，探讨噪声如何与一个双稳态系统的能量景观相互作用，并驱动在不同稳定状态之间的自发性跃迁。你将运用Kramers逸出率理论这一强大工具，计算从一个稳定状态越过势垒到达另一个状态所需的平均首通时间（Mean First Passage Time），从而深刻理解在噪声背景下，涌现出的稳定状态是如何维持其稳定性以及发生转换的[@problem_id:4320262]。", "problem": "考虑一个表现出双稳态的自激活基因的粗粒度、无量纲模型，其中基因产物的浓度（用 $x$ 表示）遵循斯特拉托诺维奇（Stratonovich）意义下的一维随机微分方程（SDE）\n$$\ndx = f(x)\\,dt + \\sqrt{2D}\\,g(x)\\circ dW_t,\n$$\n其中 $W_t$ 是标准布朗运动，$D$ 是一个小的、无量纲的有效噪声强度，源于爆发性产生和启动子转换，$f(x)$ 是由平均场合成与降解平衡产生的确定性漂移，而 $g(x)$ 捕捉了由于拷贝数依赖性涨落引起的状态依赖性噪声振幅。假设双稳态漂移为\n$$\nf(x) = -\\frac{dU}{dx}(x), \\quad U(x) = \\frac{(x^2 - 1)^2}{4},\n$$\n使得 $f(x) = -x(x^2 - 1)$，其稳定不动点位于 $x=-1$ 和 $x=+1$，不稳定不动点位于 $x=0$。假设乘性噪声振幅为\n$$\ng(x) = \\sqrt{1 + \\lambda x^2}, \\quad \\lambda > 0.\n$$\n在系统生物医学中，从低表达态 $x=-1$ 到高表达态 $x=+1$ 的噪声诱导转变，是在小噪声情况 $D \\ll 1$ 下，通过越过位于 $x=0$ 的分界线的稀有势垒穿越事件进行的，这是耦合非线性动力学和随机涨落的一个涌现特性。\n\n仅使用一维扩散过程和首过问题（first-passage problems）的基本定义和定律（即后向科尔莫戈罗夫方程和小噪声的克拉默斯渐近方法），推导从左势阱底部 $x=-1$ 出发，到达位于 $x=0$ 的分界线的平均首过时间 $\\mathcal{T}_{-1\\to 0}(D,\\lambda)$ 的领先阶、小 $D$ 渐近表达式。其中 $x=0$ 为吸收边界，$x=-1$ 为反射边界。\n\n你的推导必须：\n- 从后向方程或一个等效变换开始，该变换能在合适的坐标系中使噪声变为加性噪声。\n- 识别出在小噪声极限下控制指数标度的有效势垒泛函，并为给定的 $f(x)$ 和 $g(x)$ 显式计算它。\n- 计算决定稳定不动点（$x=-1$）和不稳定不动点（$x=0$）处前置因子的曲率（局部线性化）项。\n\n以 $D$ 和 $\\lambda$ 表示的 $\\mathcal{T}_{-1\\to 0}(D,\\lambda)$ 的单个闭合形式解析表达式给出最终答案。不要进行任何数值四舍五入；需要精确表达式。最终答案不带单位（在此表述中所有量均为无量纲）。", "solution": "该问题要求在一个粒子从一个稳定不动点移动到邻近的不稳定不动点的过程中，在小噪声极限 $D \\ll 1$ 下，推导平均首过时间（MFPT）的领先阶渐近表达式。该粒子的动力学由一个一维斯特拉托诺维奇（Stratonovich）随机微分方程（SDE）描述。\n\n该SDE以斯特拉托诺维奇（Stratonovich）形式给出：\n$$\ndx = f(x)\\,dt + \\sqrt{2D}\\,g(x)\\circ dW_t\n$$\n漂移项为 $f(x) = -x(x^2 - 1) = x - x^3$，噪声振幅为 $g(x) = \\sqrt{1 + \\lambda x^2}$（$\\lambda > 0$）。该过程从稳定不动点 $x_{st} = -1$ 开始，首过时间测量到不稳定不动点 $x_{un} = 0$，后者作为一个吸收边界。\n\n标准的克拉默斯（Kramers）逃逸率理论适用于具有加性噪声的伊藤（Ito）过程。关键的第一步是将给定的SDE变换成这种形式。对于斯特拉托诺维奇（Stratonovich）SDE，这可以通过兰珀蒂（Lamperti）变换来实现。\n\n让我们通过变换定义一个新的坐标 $z$：\n$$\nz(x) = \\int_0^x \\frac{dy}{g(y)}\n$$\n微分为 $dz = \\frac{1}{g(x)}dx$。因为原始SDE是斯特拉托诺维奇（Stratonovich）形式，我们可以应用标准的链式法则：\n$$\ndz = \\frac{1}{g(x)} dx = \\frac{1}{g(x)} \\left( f(x)\\,dt + \\sqrt{2D}\\,g(x)\\circ dW_t \\right)\n$$\n$$\ndz = \\frac{f(x)}{g(x)}\\,dt + \\sqrt{2D}\\,dW_t\n$$\n这个变换后的SDE是一个伊藤（Ito）过程，因为扩散系数现在是一个常数 $\\sqrt{2D}$。新的漂移项是新坐标 $z$ 的函数，$F(z) = f(x(z))/g(x(z))$。在 $z$ 坐标系中的过程具有加性噪声。\n\n对于一个具有加性噪声的过程，从有效势 $\\Psi(z)$ 的一个稳定点 $z_{st}$ 到一个邻近的不稳定点 $z_{un}$ 的平均首过时间 $\\mathcal{T}$，在小噪声极限 $D \\ll 1$ 下由克拉默斯（Kramers）公式给出：\n$$\n\\mathcal{T}_{z_{st}\\to z_{un}} \\approx \\frac{2\\pi}{\\sqrt{|\\Psi''(z_{st})|\\Psi''(z_{un})|}} \\exp\\left(\\frac{\\Delta\\Psi}{D}\\right)\n$$\n其中 $\\Psi(z)$ 是对应于漂移 $F(z)$ 的势，即 $F(z) = -\\frac{d\\Psi}{dz}$，$\\Delta\\Psi = \\Psi(z_{un}) - \\Psi(z_{st})$ 是势垒高度。点 $z_{st}$ 和 $z_{un}$ 对应于原始的不动点 $x_{st}=-1$ 和 $x_{un}=0$。\n\n推导过程是通过计算该公式的两个组成部分：势垒高度 $\\Delta\\Psi$ 和曲率 $\\Psi''(z_{st})$ 及 $\\Psi''(z_{un})$。\n\n**1. 势垒高度 $\\Delta\\Psi$ 的计算**\n\n势垒是漂移力的积分：\n$$\n\\Delta\\Psi = \\Psi(z_{un}) - \\Psi(z_{st}) = -\\int_{z_{st}}^{z_{un}} F(z') dz'\n$$\n我们将积分变量换回 $x$。积分限是从 $x_{st} = -1$ 到 $x_{un} = 0$。使用 $dz = dx/g(x)$ 和 $F(z) = f(x)/g(x)$，我们得到：\n$$\n\\Delta\\Psi = -\\int_{-1}^{0} \\frac{f(x)}{g(x)} \\frac{dx}{g(x)} = -\\int_{-1}^{0} \\frac{f(x)}{g(x)^2} dx\n$$\n代入给定的 $f(x)$ 和 $g(x)$ 表达式：\n$$\n\\Delta\\Psi = -\\int_{-1}^{0} \\frac{x - x^3}{(1 + \\lambda x^2)} dx = \\int_{-1}^{0} \\frac{x^3 - x}{1 + \\lambda x^2} dx\n$$\n我们对被积函数进行多项式长除法：\n$$\n\\frac{x^3 - x}{ \\lambda x^2 + 1} = \\frac{x}{\\lambda} - \\frac{(1+1/\\lambda)x}{\\lambda x^2+1} = \\frac{x}{\\lambda} - \\frac{\\lambda+1}{\\lambda}\\frac{x}{\\lambda x^2+1}\n$$\n现在我们将此表达式从 $-1$ 积分到 $0$：\n$$\n\\Delta\\Psi = \\int_{-1}^{0} \\left( \\frac{x}{\\lambda} - \\frac{\\lambda+1}{\\lambda^2}\\frac{\\lambda x}{1 + \\lambda x^2} \\right) dx\n$$\n积分为：\n$$\n\\Delta\\Psi = \\left[ \\frac{x^2}{2\\lambda} - \\frac{\\lambda+1}{2\\lambda^2}\\ln(1 + \\lambda x^2) \\right]_{-1}^{0}\n$$\n在边界处求值：\n$$\n\\text{在 } x=0 \\text{ 处}: \\quad \\frac{0^2}{2\\lambda} - \\frac{\\lambda+1}{2\\lambda^2}\\ln(1) = 0\n$$\n$$\n\\text{在 } x=-1 \\text{ 处}: \\quad \\frac{(-1)^2}{2\\lambda} - \\frac{\\lambda+1}{2\\lambda^2}\\ln(1 + \\lambda (-1)^2) = \\frac{1}{2\\lambda} - \\frac{\\lambda+1}{2\\lambda^2}\\ln(1 + \\lambda)\n$$\n势垒高度是上限值减去下限值：\n$$\n\\Delta\\Psi = 0 - \\left( \\frac{1}{2\\lambda} - \\frac{\\lambda+1}{2\\lambda^2}\\ln(1 + \\lambda) \\right) = -\\frac{1}{2\\lambda} + \\frac{\\lambda+1}{2\\lambda^2}\\ln(1+\\lambda)\n$$\n\n**2. 前置因子曲率的计算**\n\n前置因子取决于在稳定和不稳定不动点处计算的势 $\\Psi(z)$ 的二阶导数。\n$$\n\\Psi''(z) = -\\frac{dF(z)}{dz} = -\\frac{d}{dz}\\left(\\frac{f(x(z))}{g(x(z))}\\right)\n$$\n使用链式法则，$\\frac{d}{dz} = \\frac{dx}{dz}\\frac{d}{dx} = g(x)\\frac{d}{dx}$：\n$$\n\\Psi''(z) = -g(x) \\frac{d}{dx}\\left(\\frac{f(x)}{g(x)}\\right) = -g(x) \\left( \\frac{f'(x)g(x) - f(x)g'(x)}{g(x)^2} \\right) = - \\left( f'(x) - \\frac{f(x)g'(x)}{g(x)} \\right)\n$$\n我们需要在不动点处计算这个表达式，根据定义，在不动点处 $f(x)=0$。因此，在不动点 $x^*$ 处，表达式显著简化：\n$$\n\\Psi''(z(x^*)) = -f'(x^*)\n$$\n我们需要计算 $f'(x)$：\n$$\nf(x) = x - x^3 \\implies f'(x) = 1 - 3x^2\n$$\n现在，我们在稳定和不稳定不动点处计算它：\n在稳定不动点 $x_{st} = -1$ 处：\n$$\n\\Psi''(z_{st}) = -f'(-1) = -(1 - 3(-1)^2) = -(1-3) = 2\n$$\n这是正值，符合势阱最小值的预期。\n在不稳定不动点 $x_{un} = 0$ 处：\n$$\n\\Psi''(z_{un}) = -f'(0) = -(1 - 3(0)^2) = -1\n$$\n这是负值，符合势垒最大值的预期。\n\n曲率的绝对值为 $|\\Psi''(z_{st})| = 2$ 和 $|\\Psi''(z_{un})| = 1$。因此，前置因子是：\n$$\n\\frac{2\\pi}{\\sqrt{|\\Psi''(z_{st})||\\Psi''(z_{un})|}} = \\frac{2\\pi}{\\sqrt{2 \\cdot 1}} = \\frac{2\\pi}{\\sqrt{2}} = \\pi\\sqrt{2}\n$$\n\n**3. 最终渐近表达式**\n\n结合前置因子和指数项，我们得到平均首过时间 $\\mathcal{T}_{-1\\to 0}(D,\\lambda)$ 的最终表达式：\n$$\n\\mathcal{T}_{-1\\to 0}(D,\\lambda) \\approx \\pi\\sqrt{2} \\exp\\left( \\frac{\\Delta\\Psi}{D} \\right) = \\pi\\sqrt{2} \\exp\\left( \\frac{1}{D} \\left[ -\\frac{1}{2\\lambda} + \\frac{\\lambda+1}{2\\lambda^2}\\ln(1+\\lambda) \\right] \\right)\n$$\n这个表达式给出了在小噪声极限 $D \\ll 1$ 下逃逸时间的领先阶行为。", "answer": "$$\n\\boxed{\\pi\\sqrt{2} \\exp\\left( \\frac{1}{D} \\left( -\\frac{1}{2\\lambda} + \\frac{\\lambda+1}{2\\lambda^2}\\ln(1+\\lambda) \\right) \\right)}\n$$", "id": "4320262"}]}