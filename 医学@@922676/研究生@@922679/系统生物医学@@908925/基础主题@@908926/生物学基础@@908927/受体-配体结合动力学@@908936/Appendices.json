{"hands_on_practices": [{"introduction": "掌握受体-配体相互作用的定量描述是理解药理学和细胞信号转导中剂量-效应关系的基础。这个练习将指导你从基本的质量作用定律出发，推导出在平衡状态下受体占据分数与游离配体浓度及解离常数 $K_D$ 之间的关系，这是所有后续更复杂模型的核心。[@problem_id:1462243]", "problem": "在一个药物发现项目中，一个生物化学家团队正在研究细胞表面受体 $R$ 与其天然配体 $L$ 之间的相互作用。结合过程是可逆的，可以用以下化学反应来描述：\n$$R + L \\rightleftharpoons C$$\n其中 $C$ 代表受体-配体复合物。正向结合反应的速率与游离受体浓度 $[R]$ 和游离配体浓度 $[L]$ 成正比，结合速率常数为 $k_{on}$。反向解离反应的速率与复合物浓度 $[C]$ 成正比，解离速率常数为 $k_{off}$。\n\n该团队希望为这种相互作用创建一个模型。该模型中的一个关键参数是解离常数，定义为 $K_D = \\frac{k_{off}}{k_{on}}$。当系统达到稳态时（即复合物的生成速率等于其解离速率），系统的生物学响应通常与结合了配体的总受体所占的比例直接相关。\n\n你的任务是确定这个已结合受体比例的表达式。设游离配体浓度为 $[L]$，解离常数为 $K_D$。以 $[L]$ 和 $K_D$ 表示的已结合受体比例的表达式是什么？", "solution": "考虑可逆结合反应 $R + L \\rightleftharpoons C$，其结合速率为 $k_{on}[R][L]$，解离速率为 $k_{off}[C]$。在稳态（平衡）时，复合物的净生成速率为零，因此正向和反向速率相等：\n$$\nk_{on}[R][L] = k_{off}[C].\n$$\n重新整理并使用定义 $K_{D} = \\frac{k_{off}}{k_{on}}$，得到平衡关系式\n$$\n\\frac{[R][L]}{[C]} = K_{D}.\n$$\n用 $[C]$ 和 $[L]$ 求解 $[R]$：\n$$\n[R] = \\frac{K_{D}[C]}{[L]}.\n$$\n\n设总受体浓度为 $[R]_{T} = [R] + [C]$。代入 $[R]$ 的表达式：\n$$\n[R]_{T} = \\frac{K_{D}[C]}{[L]} + [C] = [C]\\left(\\frac{K_{D}}{[L]} + 1\\right).\n$$\n求解复合物浓度分数 $[C]/[R]_{T}$：\n$$\n\\frac{[C]}{[R]_{T}} = \\frac{1}{\\frac{K_{D}}{[L]} + 1} = \\frac{[L]}{K_{D} + [L]}.\n$$\n因此，已结合的总受体所占的比例为 $\\frac{[L]}{K_{D} + [L]}$。", "answer": "$$\\boxed{\\frac{[L]}{K_{D} + [L]}}$$", "id": "1462243"}, {"introduction": "在真实的生物系统中，受体往往会遇到多种配体。此练习将基础模型扩展到一个更复杂但极为常见的情景——竞争性结合，即多种配体争夺同一个结合位点。理解这一过程对于药物设计和阐明拮抗剂与激动剂的作用机制至关重要。[@problem_id:4382816]", "problem": "一种单一位点受体 $R$ 暴露于两种可溶性配体 $L_1$ 和 $L_2$ 中，它们竞争性地结合到同一位点，形成 $RL_1$ 或 $RL_2$，但绝不同时形成两者。假设系统混合均匀，处于热力学平衡状态，且配体耗尽可忽略不计，因此游离配体浓度保持在其本体值 $[L_1]$ 和 $[L_2]$。设 $K_{D1}$ 和 $K_{D2}$ 分别表示 $L_1$ 和 $L_2$ 与该受体结合的平衡解离常数。设总受体浓度为 $R_T$，并定义分数占据率 $\\theta_1 = [RL_1]/R_T$ 和 $\\theta_2 = [RL_2]/R_T$。仅从质量作用定律、平衡解离常数的定义和受体守恒出发，推导 $\\theta_1$ 和 $\\theta_2$ 关于 $K_{D1}$、$K_{D2}$、$[L_1]$ 和 $[L_2]$ 的精确解析表达式。将你的最终答案表示为 $\\theta_1$ 和 $\\theta_2$ 的闭式表达式。不需要进行数值计算，分数占据率也无需单位。", "solution": "该系统在热力学平衡下涉及两个可逆结合反应：\n$$ R + L_1 \\rightleftharpoons RL_1 $$\n$$ R + L_2 \\rightleftharpoons RL_2 $$\n此处，$R$ 是游离受体，$L_1$ 和 $L_2$ 是两种配体，$RL_1$ 和 $RL_2$ 是相应的受体-配体复合物。\n\n根据质量作用定律，这些反应的平衡解离常数 $K_{D1}$ 和 $K_{D2}$ 定义如下：\n$$ K_{D1} = \\frac{[R][L_1]}{[RL_1]} $$\n$$ K_{D2} = \\frac{[R][L_2]}{[RL_2]} $$\n其中 $[X]$ 表示物质 $X$ 在平衡时的摩尔浓度。问题陈述指出，配体耗尽可忽略不计，因此游离配体浓度等于其总（本体）浓度 $[L_1]$ 和 $[L_2]$。\n\n总受体浓度 $R_T$ 是守恒的。由于受体可以以三种状态之一存在——未结合 ($R$)、与 $L_1$ 结合 ($RL_1$) 或与 $L_2$ 结合 ($RL_2$)——因此守恒方程为：\n$$ R_T = [R] + [RL_1] + [RL_2] $$\n\n我们的目标是找到分数占据率 $\\theta_1 = \\frac{[RL_1]}{R_T}$ 和 $\\theta_2 = \\frac{[RL_2]}{R_T}$ 的表达式。为实现此目标，我们必须用给定参数（$K_{D1}$、$K_{D2}$、$[L_1]$、$[L_2]$）和总受体浓度 $R_T$ 来表示 $[RL_1]$ 和 $[RL_2]$。\n\n首先，我们重排解离常数的定义，用游离受体浓度 $[R]$ 来表示结合复合物的浓度：\n$$ [RL_1] = \\frac{[R][L_1]}{K_{D1}} $$\n$$ [RL_2] = \\frac{[R][L_2]}{K_{D2}} $$\n\n接下来，我们将这些表达式代入受体守恒方程：\n$$ R_T = [R] + \\frac{[R][L_1]}{K_{D1}} + \\frac{[R][L_2]}{K_{D2}} $$\n\n我们可以从方程右侧提出游离受体浓度 $[R]$：\n$$ R_T = [R] \\left( 1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}} \\right) $$\n\n这使我们能够求解游离受体浓度 $[R]$，用 $R_T$ 和已知参数表示：\n$$ [R] = \\frac{R_T}{1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}}} $$\n\n现在，我们将这个 $[R]$ 的表达式代回 $[RL_1]$ 和 $[RL_2]$ 的方程中：\n$$ [RL_1] = \\frac{[R][L_1]}{K_{D1}} = \\left( \\frac{R_T}{1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}}} \\right) \\frac{[L_1]}{K_{D1}} $$\n$$ [RL_2] = \\frac{[R][L_2]}{K_{D2}} = \\left( \\frac{R_T}{1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}}} \\right) \\frac{[L_2]}{K_{D2}} $$\n\n最后，我们使用分数占据率的定义 $\\theta_1 = \\frac{[RL_1]}{R_T}$ 和 $\\theta_2 = \\frac{[RL_2]}{R_T}$ 来找到所需的表达式。我们将 $[RL_1]$ 和 $[RL_2]$ 的方程除以 $R_T$：\n$$ \\theta_1 = \\frac{[RL_1]}{R_T} = \\frac{\\frac{[L_1]}{K_{D1}}}{1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}}} $$\n$$ \\theta_2 = \\frac{[RL_2]}{R_T} = \\frac{\\frac{[L_2]}{K_{D2}}}{1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}}} $$\n\n这些就是在存在两种竞争性配体的情况下，单一位点受体在平衡状态下的分数占据率的精确解析表达式。分母代表所有可能受体状态（未结合、与 $L_1$ 结合、与 $L_2$ 结合）的统计权重之和，其经过归一化，使得未结合状态的权重为 $1$。每个分数占据率的分子是该特定结合状态的统计权重。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\frac{[L_1]}{K_{D1}}}{1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}}}  \\frac{\\frac{[L_2]}{K_{D2}}}{1 + \\frac{[L_1]}{K_{D1}} + \\frac{[L_2]}{K_{D2}}} \\end{pmatrix}}$$", "id": "4382816"}, {"introduction": "理论模型最终必须与实验数据相结合。这个综合性练习将引导你从解析推导过渡到计算实践，模拟一个从生成带有噪声的协同结合数据，到利用非线性最小二乘法拟合模型参数，再到评估参数可辨识性的完整工作流程。通过这个练习，你将掌握连接理论与数据分析的关键计算技能，这是系统生物医学研究的核心环节。[@problem_id:4382780]", "problem": "您将构建一个完整的、可运行的程序，该程序在协同结合假说下模拟受体-配体滴定数据，从含有噪声的模拟数据中估计表观半饱和浓度和希尔系数，并使用费雪信息矩阵（FIM）评估参数的可辨识性。请以纯数学术语和明确的算法步骤进行工作，并使您的程序具有确定性。\n\n科学基础和假设如下：\n\n- 从质量作用定律出发：对于单一结合事件，受体-配体复合物的形成和解离速率由 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 控制，在平衡状态下，分数占据率可以表示为配体浓度 $[L]$ 和解离常数 $K_{\\mathrm{d}}$ 的函数。在表现出协同性的系统中，一种唯象的宏观描述将多个微观步骤聚合为占据率和 $[L]$ 之间的有效平衡关系。\n\n- 将表观半饱和浓度 $K_{1/2}$ 定义为归一化响应等于 $1/2$ 时的配体浓度。\n\n- 将希尔系数 $n_{\\mathrm{H}}$ 定义为半饱和点处希尔图的斜率，即 $n_{\\mathrm{H}}$ 是 $\\log\\left(y/(1-y)\\right)$ 对 $\\log [L]$ 的导数在 $y=1/2$ 处的值，其中 $y$ 是分数占据率或归一化效应。\n\n- 测量噪声被建模为独立同分布的零均值高斯噪声，其标准差 $\\sigma_{y}$ 已知（以与测量响应相同的单位表示）。\n\n您的程序必须：\n\n- 通过在一组指定的配体浓度 $[L]$ 上生成响应 $y([L])$ 来模拟滴定数据，添加具有指定 $\\sigma_{y}$ 和固定随机种子的的高斯噪声，然后拟合一个由三个正参数（最大响应 $B_{\\max}$、表观半饱和浓度 $K_{1/2}$ 和希尔系数 $n_{\\mathrm{H}}$）参数化的协同结合响应模型。您必须通过带有正值约束的非线性最小二乘法来估计 $B_{\\max}$、$K_{1/2}$ 和 $n_{\\mathrm{H}}$。\n\n- 计算在最优点处残差关于参数的雅可比矩阵 $J$，近似费雪信息矩阵（FIM）$\\mathcal{I} \\approx J^{\\top}J/\\hat{\\sigma}^{2}$（其中 $\\hat{\\sigma}^{2}$ 是残差方差），条件数 $\\kappa(\\mathcal{I})$，以及近似参数协方差 $\\hat{\\Sigma} \\approx \\hat{\\sigma}^{2}(J^{\\top}J)^{-1}$。\n\n- 从 $\\hat{\\Sigma}$ 中计算 $K_{1/2}$ 和 $n_{\\mathrm{H}}$ 的标准误差以及在正态近似下的双侧 $95\\%$ 置信区间。使用这些来量化可辨识性。\n\n- 根据以下规则，将 $K_{1/2}$ 和 $n_{\\mathrm{H}}$ 的联合可辨识性声明为单个布尔值：拟合必须收敛且估计值严格为正；条件数 $\\kappa(\\mathcal{I})$ 必须小于 $10^{8}$；$K_{1/2}$ 和 $n_{\\mathrm{H}}$ 都必须具有有限的 $95\\%$ 置信区间，且其相对半宽小于 $0.5$（即，$1.96$ 乘以标准误差再除以估计值的绝对值小于 $0.5$）。\n\n- 以纳摩尔（nM）为单位报告估计的 $K_{1/2}$，并以无量纲值的形式报告 $n_{\\mathrm{H}}$。\n\n- 对于所有计算，请使用标准双精度。除了将浓度值解释为纳摩尔外，不需要进行任何物理单位转换。\n\n测试套件：\n\n模拟如下定义的三个测试用例。在每个用例中，使用真实参数 $(B_{\\max}^{\\mathrm{true}},K_{1/2}^{\\mathrm{true}},n_{\\mathrm{H}}^{\\mathrm{true}})$ 从协同结合响应中生成滴定数据，然后添加标准差为 $\\sigma_{y}$ 的高斯噪声。\n\n- 用例 $1$（可辨识性良好，范围宽，噪声低）：\n  - 真实参数：$B_{\\max}^{\\mathrm{true}}=1.0$, $K_{1/2}^{\\mathrm{true}}=50.0\\,\\text{nM}$, $n_{\\mathrm{H}}^{\\mathrm{true}}=2.0$。\n  - 浓度：$[L]$ 在 $0.5\\,\\text{nM}$ 到 $5000\\,\\text{nM}$ 之间对数均匀分布的 $30$ 个点。\n  - 噪声：$\\sigma_{y}=0.02$。随机种子：$12345$。\n\n- 用例 $2$（相同范围，噪声较高）：\n  - 真实参数：$B_{\\max}^{\\mathrm{true}}=1.0$, $K_{1/2}^{\\mathrm{true}}=50.0\\,\\text{nM}$, $n_{\\mathrm{H}}^{\\mathrm{true}}=2.0$。\n  - 浓度：$[L]$ 在 $0.5\\,\\text{nM}$ 到 $5000\\,\\text{nM}$ 之间对数均匀分布的 $30$ 个点。\n  - 噪声：$\\sigma_{y}=0.15$。随机种子：$67890$。\n\n- 用例 $3$（接近饱和的有限范围，噪声低，曲率信息差）：\n  - 真实参数：$B_{\\max}^{\\mathrm{true}}=1.0$, $K_{1/2}^{\\mathrm{true}}=50.0\\,\\text{nM}$, $n_{\\mathrm{H}}^{\\mathrm{true}}=2.0$。\n  - 浓度：$[L]$ 在 $100\\,\\text{nM}$ 到 $5000\\,\\text{nM}$ 之间对数均匀分布的 $15$ 个点。\n  - 噪声：$\\sigma_{y}=0.02$。随机种子：$24680$。\n\n程序要求：\n\n- 精确地按照描述实现带有正值约束的非线性最小二乘法，并计算所需的可辨识性指标，不使用任何外部数据。通过指定的种子使用确定性伪随机数生成。\n\n- 以 $\\text{nM}$ 为单位表示最终估计的 $K_{1/2}$，并以无量纲数表示 $n_{\\mathrm{H}}$。将 $K_{1/2}$ 和 $n_{\\mathrm{H}}$ 都四舍五入到三位有效数字进行输出。\n\n- 最终输出格式：您的程序应生成单行输出，其中包含三个用例的结果，格式为 Python 风格的列表的列表，其中每个内部列表按 $[K_{1/2}^{\\text{est}}\\ \\text{in nM},\\ n_{\\mathrm{H}}^{\\text{est}},\\ \\text{identifiable}]$ 的顺序列出。例如，打印的行必须具有 $[[x_{1},y_{1},b_{1}],[x_{2},y_{2},b_{2}],[x_{3},y_{3},b_{3}]]$ 的形式，其中 $x_{i}$ 和 $y_{i}$ 是浮点数，$b_{i}$ 是布尔值。不应打印任何其他文本。", "solution": "该问题要求开发一个计算工作流程，以在协同结合假说下模拟和分析受体-配体滴定数据。此过程涉及三个主要阶段：首先，基于带有叠加高斯噪声的希尔模型生成合成数据；其次，通过非线性最小二乘法从此噪声数据中估计模型参数；第三，使用基于费雪信息矩阵（FIM）的方法对这些参数的实际可辨识性进行严格评估。\n\n**1. 协同结合模型：希尔方程**\n\n对于表现出协同性的系统，配体浓度 $[L]$ 和测量响应 $y$ 之间的关系由希尔方程进行唯象描述。该模型由一组三个正参数来表征：最大响应 $B_{\\max}$、表观半饱和浓度 $K_{1/2}$ 和希尔系数 $n_{\\mathrm{H}}$。模型的函数形式是：\n$$ y([L]; B_{\\max}, K_{1/2}, n_{\\mathrm{H}}) = B_{\\max} \\frac{[L]^{n_{\\mathrm{H}}}}{K_{1/2}^{n_{\\mathrm{H}}} + [L]^{n_{\\mathrm{H}}}} $$\n在此方程中，$B_{\\max}$ 表示在饱和配体浓度下的渐近响应。$K_{1/2}$ 代表响应 $y$ 达到其最大值一半时的配体浓度，即 $y(K_{1/2}) = B_{\\max}/2$。希尔系数 $n_{\\mathrm{H}}$ 量化了协同性程度：$n_{\\mathrm{H}}  1$ 意味着正协同性（变构结合增强），$n_{\\mathrm{H}}  1$ 表明负协同性，而 $n_{\\mathrm{H}} = 1$ 则恢复为非协同的 Michaelis-Menten 或 Langmuir 结合等温线。\n\n**2. 数据模拟**\n\n对于每个指定的测试用例，我们生成一组模拟观测值。设真实参数为 $\\theta^{\\mathrm{true}} = (B_{\\max}^{\\mathrm{true}}, K_{1/2}^{\\mathrm{true}}, n_{\\mathrm{H}}^{\\mathrm{true}})$。\n首先，生成一个包含 $N$ 个配体浓度的向量 $\\{[L]_i\\}_{i=1}^N$。对于每个浓度 $[L]_i$，计算其真实（无噪声）响应：\n$$ y_i^{\\mathrm{true}} = y([L]_i; \\theta^{\\mathrm{true}}) $$\n测量噪声被建模为从零均值正态分布中抽取的独立同分布（i.i.d.）随机变量 $\\epsilon_i$，其标准差为指定的 $\\sigma_y$，即 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_y^2)$。模拟的观测值 $y_i^{\\mathrm{obs}}$ 则由下式给出：\n$$ y_i^{\\mathrm{obs}} = y_i^{\\mathrm{true}} + \\epsilon_i $$\n为确保结果的确定性和可复现性，每个测试用例的伪随机数生成器都使用特定的种子进行初始化。\n\n**3. 通过非线性最小二乘法（NLLS）进行参数估计**\n\n目标是从模拟数据 $([L]_i, y_i^{\\mathrm{obs}})$ 中估计参数 $\\theta = (B_{\\max}, K_{1/2}, n_{\\mathrm{H}})$。这通过最小化残差平方和（SSR）来实现，SSR 是 NLLS 的目标函数：\n$$ \\hat{\\theta} = \\arg\\min_{\\theta} \\sum_{i=1}^{N} \\left( y_i^{\\mathrm{obs}} - y([L]_i; \\theta) \\right)^2 $$\n参数搜索受正值约束 $B_{\\max}  0$，$K_{1/2}  0$ 和 $n_{\\mathrm{H}}  0$ 的限制。这个约束优化问题进行数值求解，信赖域反射（`trf`）算法适用于此问题。\n\n**4. 参数可辨识性分析**\n\n实际可辨识性关注的是模型参数是否可以从给定的有限且含噪声的数据集中被唯一且精确地估计出来。我们使用从 NLLS 拟合中导出的几个指标来评估这一点。设 $\\hat{\\theta}$ 为最优参数向量。\n\n**雅可比矩阵：**分析始于模型残差向量 $r(\\theta)$ 在估计参数 $\\hat{\\theta}$ 处计算的雅可比矩阵 $J$。残差向量的分量为 $r_i(\\theta) = y_i^{\\mathrm{obs}} - y([L]_i; \\theta)$。雅可比矩阵是一个 $N \\times 3$ 的矩阵，其元素为：\n$$ J_{ij}(\\hat{\\theta}) = \\frac{\\partial r_i}{\\partial \\theta_j} \\bigg|_{\\theta=\\hat{\\theta}} = - \\frac{\\partial y([L]_i; \\theta)}{\\partial \\theta_j} \\bigg|_{\\theta=\\hat{\\theta}} $$\n希尔函数对其参数的偏导数是：\n- $\\frac{\\partial y}{\\partial B_{\\max}} = \\frac{[L]^{n_{\\mathrm{H}}}}{K_{1/2}^{n_{\\mathrm{H}}} + [L]^{n_{\\mathrm{H}}}}$\n- $\\frac{\\partial y}{\\partial K_{1/2}} = - B_{\\max} n_{\\mathrm{H}} K_{1/2}^{n_{\\mathrm{H}}-1} \\frac{[L]^{n_{\\mathrm{H}}}}{(K_{1/2}^{n_{\\mathrm{H}}} + [L]^{n_{\\mathrm{H}}})^2}$\n- $\\frac{\\partial y}{\\partial n_{\\mathrm{H}}} = B_{\\max} \\frac{[L]^{n_{\\mathrm{H}}} K_{1/2}^{n_{\\mathrm{H}}} \\ln([L]/K_{1/2})}{(K_{1/2}^{n_{\\mathrm{H}}} + [L]^{n_{\\mathrm{H}}})^2}$\n\n**费雪信息和协方差：**在独立同分布高斯噪声的假设下，费雪信息矩阵（FIM）的一个近似由下式给出：\n$$ \\mathcal{I} \\approx \\frac{J^{\\top}J}{\\hat{\\sigma}^2} $$\n其中 $J$ 是在 $\\hat{\\theta}$ 处计算的雅可比矩阵，$\\hat{\\sigma}^2$ 是估计的残差方差。使用方差的无偏估计量：\n$$ \\hat{\\sigma}^2 = \\frac{\\text{SSR}(\\hat{\\theta})}{N - p} $$\n其中 $p=3$ 是参数的数量。\nFIM 的逆矩阵为任何无偏估计量的方差提供了 Cramér-Rao 下界。因此，近似的参数协方差矩阵 $\\hat{\\Sigma}$ 为：\n$$ \\hat{\\Sigma} \\approx \\mathcal{I}^{-1} = \\hat{\\sigma}^2 (J^{\\top}J)^{-1} $$\n\n**可辨识性指标：**\n- **条件数：**FIM 的条件数 $\\kappa(\\mathcal{I})$ 衡量了参数估计对数据变化的敏感性。大的条件数表明 FIM 近似奇异，意味着参数估计之间存在强相关性，因此可辨识性较差。它被计算为 $\\mathcal{I}$ 的最大特征值与最小特征值的比率。问题指定了一个阈值 $\\kappa(\\mathcal{I})  10^8$。\n- **标准误差和置信区间：**参数估计 $\\hat{\\theta}_j$ 的标准误差（SE）是协方差矩阵相应对角元素的平方根，$\\text{SE}(\\hat{\\theta}_j) = \\sqrt{\\hat{\\Sigma}_{jj}}$。使用正态分布近似计算 $95\\%$ 置信区间（CI）为 $\\hat{\\theta}_j \\pm 1.96 \\times \\text{SE}(\\hat{\\theta}_j)$。\n- **可辨识性规则：**$K_{1/2}$ 和 $n_{\\mathrm{H}}$ 的联合可辨识性由一个复合布尔规则确定：\n    1. NLLS 优化必须成功收敛，并且所有估计参数必须严格为正。\n    2. FIM 的条件数必须小于 $10^8$。\n    3. $K_{1/2}$ 和 $n_{\\mathrm{H}}$ 的 $95\\%$ 置信区间都必须是有限的。这要求 $(J^{\\top}J)$ 是可逆的。\n    4. $K_{1/2}$ 和 $n_{\\mathrm{H}}$ 的 $95\\%$ CI 的相对半宽都必须小于 $0.5$。参数 $\\hat{\\theta}_j$ 的相对半宽定义为 $\\frac{1.96 \\times \\text{SE}(\\hat{\\theta}_j)}{|\\hat{\\theta}_j|}$。\n\n这个全面的程序允许定量评估实验设计和数据质量是否足以可靠地确定模型参数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Main function to simulate, fit, and analyze cooperative binding data for three test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Case 1: Well-identified, wide range, low noise\",\n            \"true_params\": (1.0, 50.0, 2.0),\n            \"L_config\": {\"start\": 0.5, \"stop\": 5000, \"num\": 30},\n            \"sigma_y\": 0.02,\n            \"seed\": 12345\n        },\n        {\n            \"name\": \"Case 2: Same range, higher noise\",\n            \"true_params\": (1.0, 50.0, 2.0),\n            \"L_config\": {\"start\": 0.5, \"stop\": 5000, \"num\": 30},\n            \"sigma_y\": 0.15,\n            \"seed\": 67890\n        },\n        {\n            \"name\": \"Case 3: Limited range near saturation, low noise\",\n            \"true_params\": (1.0, 50.0, 2.0),\n            \"L_config\": {\"start\": 100, \"stop\": 5000, \"num\": 15},\n            \"sigma_y\": 0.02,\n            \"seed\": 24680\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_binding_case(\n            case[\"true_params\"],\n            case[\"L_config\"],\n            case[\"sigma_y\"],\n            case[\"seed\"]\n        )\n        results.append(result)\n\n    # Format the final output as a Python-style list of lists.\n    # The boolean values True/False must be lowercase as per Python syntax.\n    output_str = \"[\" + \",\".join(\n        f\"[{k},{n},{str(b).lower()}]\" for k, n, b in results\n    ) + \"]\"\n    print(output_str)\n\n\ndef analyze_binding_case(true_params, L_config, sigma_y, seed):\n    \"\"\"\n    Performs the simulation, fitting, and identifiability analysis for a single case.\n    \n    Args:\n        true_params (tuple): (Bmax_true, K12_true, nH_true).\n        L_config (dict): Configuration for ligand concentrations.\n        sigma_y (float): Standard deviation of Gaussian noise.\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        list: [k12_est_rounded, nH_est_rounded, is_identifiable].\n    \"\"\"\n    \n    Bmax_true, K12_true, nH_true = true_params\n    \n    # 1. Simulate titration data\n    L = np.logspace(np.log10(L_config[\"start\"]), np.log10(L_config[\"stop\"]), L_config[\"num\"])\n    y_true = hill_equation(true_params, L)\n    rng = np.random.default_rng(seed)\n    noise = rng.normal(0, sigma_y, size=L.shape)\n    y_obs = y_true + noise\n\n    # 2. Perform Nonlinear Least Squares (NLLS) fitting\n    p0 = [Bmax_true, K12_true, nH_true] # Initial guess\n    bounds = (0, np.inf)\n    \n    res = least_squares(\n        fun=residuals,\n        x0=p0,\n        args=(L, y_obs),\n        bounds=bounds,\n        method='trf'\n    )\n    \n    # Initialize default results for non-identifiable case\n    k_est_final, nH_est_final, is_identifiable = np.nan, np.nan, False\n\n    # 3. Assess identifiability\n    # Condition 1: Fit must converge and estimates must be positive\n    if res.success and np.all(res.x > 0):\n        p_est = res.x\n        Bmax_est, K12_est, nH_est = p_est\n        \n        N = len(y_obs)  # Number of data points\n        p_num = len(p_est)  # Number of parameters\n\n        try:\n            # Jacobian J from the fit results\n            jac = res.jac\n\n            # Calculate J^T * J\n            jtj = jac.T @ jac\n            \n            # Check if J^T*J is invertible\n            if np.linalg.matrix_rank(jtj)  p_num:\n                raise np.linalg.LinAlgError(\"Singular matrix\")\n\n            # Residual variance estimate\n            ssr = np.sum(res.fun**2)\n            residual_variance = ssr / (N - p_num)\n\n            # Approximate Fisher Information Matrix (FIM)\n            fim = jtj / residual_variance \n            \n            # Condition 2: Condition number of FIM\n            kappa_fim = np.linalg.cond(fim)\n            cond_num_ok = kappa_fim  1e8\n\n            # Approximate Covariance Matrix\n            cov_matrix = residual_variance * np.linalg.inv(jtj)\n            \n            # Standard Errors\n            se = np.sqrt(np.diag(cov_matrix))\n            se_Bmax, se_K12, se_nH = se\n\n            # Condition 3: Finite confidence intervals (implied by finite SE)\n            finite_ci_ok = np.all(np.isfinite(se))\n\n            # Condition 4: Relative half-width of CIs for K1/2 and nH\n            # rel_half_width = 1.96 * SE / estimate\n            rel_hw_k12 = 1.96 * se_K12 / K12_est\n            rel_hw_nH = 1.96 * se_nH / nH_est\n            \n            rel_hw_ok = (abs(rel_hw_k12)  0.5) and (abs(rel_hw_nH)  0.5)\n\n            # Combine all identifiability conditions\n            if cond_num_ok and finite_ci_ok and rel_hw_ok:\n                is_identifiable = True\n                k_est_final = format_sig_figs(K12_est, 3)\n                nH_est_final = format_sig_figs(nH_est, 3)\n            else: # If any condition fails, but fit was successful\n                k_est_final = format_sig_figs(K12_est, 3)\n                nH_est_final = format_sig_figs(nH_est, 3)\n                is_identifiable = False\n\n        except np.linalg.LinAlgError:\n            # If J^T*J is singular, identifiability check fails\n            k_est_final = format_sig_figs(p_est[1], 3)\n            nH_est_final = format_sig_figs(p_est[2], 3)\n            is_identifiable = False\n    else: # If fit did not converge or gave non-positive parameters\n        is_identifiable = False\n        # Use NaN or initial guess, problem requires outputting estimates anyway.\n        # Try to provide last estimate if available, otherwise NaN\n        if res.x is not None:\n             k_est_final = format_sig_figs(res.x[1], 3) if res.x[1]>0 else np.nan\n             nH_est_final = format_sig_figs(res.x[2], 3) if res.x[2]>0 else np.nan\n        else:\n             k_est_final, nH_est_final = np.nan, np.nan\n\n    return [k_est_final, nH_est_final, is_identifiable]\n\ndef hill_equation(p, L):\n    \"\"\"\n    Calculates the response based on the Hill equation.\n    \n    Args:\n        p (tuple/list): Parameters (Bmax, K1/2, nH).\n        L (ndarray): Ligand concentrations.\n        \n    Returns:\n        ndarray: The calculated response y.\n    \"\"\"\n    Bmax, K12, nH = p\n    return Bmax * (L**nH) / (K12**nH + L**nH)\n\ndef residuals(p, L, y_obs):\n    \"\"\"\n    Calculates the residuals between observed data and the Hill model.\n    \"\"\"\n    return y_obs - hill_equation(p, L)\n\ndef format_sig_figs(num, sig_figs):\n    \"\"\"\n    Rounds a number to a specified number of significant figures.\n    \"\"\"\n    if not np.isfinite(num) or num == 0:\n        return num\n    return float(f'{num:.{sig_figs}g}')\n\nif __name__ == '__main__':\n    solve()\n```", "id": "4382780"}]}