## 引言
生物组织的功能与其复杂的三维结构密不可分。从器官的宏观形态到细胞的微观排布，这种空间组织并非细胞的随机混合，而是由精确的生物学规则和物理定律共同塑造而成。然而，如何定量地描述、测量并最终理解这些复杂结构的形成机制与功能意义，是现代生物医学面临的核心挑战。本文旨在为这一挑战提供一个综合性的框架，揭示如何识别和分析组织中的空间域及其整体架构。

为了系统性地解决这一问题，本文将分为三个核心章节。在“原理与机制”一章中，我们将深入探讨组织空间域的[生物物理学](@entry_id:200723)起源，并介绍用于从高维[空间组学](@entry_id:156223)和组织学图像数据中识别这些结构的关键计算方法与[统计模型](@entry_id:755400)。随后，“应用与跨学科连接”一章将展示这些原理和方法在发育生物学、计算病理学和[精准医疗](@entry_id:152668)等多个领域的实际应用，突显了组织架构分析在连接基础科学与临床转化中的桥梁作用。最后，“动手实践”部分将提供一系列精心设计的计算练习，帮助读者将理论知识转化为解决实际问题的能力。通过这一结构化的学习路径，读者将能够建立一个从第一性原理到前沿应用，全面理解组织空间结构的知识体系。

## 原理与机制

本章旨在深入探讨识别空间域与组织结构背后的核心科学原理和关键机制。我们将从一个基本问题出发：空间域究竟是什么，以及它们为何会形成？随后，我们将讨论如何通过现代生物医学成像和组学技术来测量和观测这些结构。在此基础上，我们将阐述用以从复杂数据中识别和分割这些域的计算方法。最后，我们将介绍用于模拟[组织结构](@entry_id:146183)形成与动态演化的力学模型，并讨论如何稳健地验证这些[空间分析](@entry_id:183208)的有效性。本章的目标是为读者构建一个从[生物物理学](@entry_id:200723)第一性原理到前沿计算方法，再到严谨[模型验证](@entry_id:141140)的完整知识框架。

### 空间域的定义与起源

在深入探讨计算方法之前，我们必须首先精确定义我们的研究对象——“空间域”，并理解其在生物组织中形成的物理与化学基础。一个空间域不仅是一个形态学上的区域，更是一个功能和结构上具有内在一致性的单元。

#### [生物物理学](@entry_id:200723)起源：为何存在空间域？

组织并非细胞的随机混合物，其高度有序的结构源于深刻的[生物物理学](@entry_id:200723)原理。空间域的形成可以追溯到几个关键的[自组织](@entry_id:186805)过程。

首先是基于**[形态发生素梯度](@entry_id:154137) (morphogen gradients)** 的化学预成图模式。在发育生物学中，一个经典的范式是形态发生素（一类可扩散的信号分子）从一个源头释放，在组织中形成一个浓度梯度。细胞根据其所在位置感受到的局部[形态发生素](@entry_id:149113)浓度 $c(x)$ 来决定自身的命运。假设存在一个浓度阈值 $T$，细胞在 $c(x) > T$ 的区域分化为 $\mathcal{A}$ 型，而在 $c(x)  T$ 的区域分化为 $\mathcal{B}$ 型。在[稳态](@entry_id:139253)下，[形态发生素](@entry_id:149113)的浓度分布通常由一个[反应-扩散方程](@entry_id:170319)决定。例如，在一个一维组织条带中，若[形态发生素](@entry_id:149113)在 $x=0$ 处产生，并随着距离被降解，其[稳态](@entry_id:139253)浓度 $c(x)$ 可由方程 $D \frac{\mathrm{d}^2 c}{\mathrm{d}x^2} - k c = 0$ 描述，其中 $D$ 是扩散系数，$k$ 是一阶降解速率。这个方程的解是一个从源头单调递减的指数函数，其[特征长度](@entry_id:265857)为 $L_d = \sqrt{D/k}$。只要源头浓度 $c_0$ 高于阈值 $T$，就必然存在一个唯一的位置 $x^\star$，使得 $c(x^\star) = T$。这个位置就为 $\mathcal{A}$ 型和 $\mathcal{B}$ 型细胞之间的边界提供了初始的空间坐标信息 [@problem_id:4354097]。

其次，**差异性[细胞黏附](@entry_id:146786) (differential cell adhesion)** 驱动细胞进行分选，从而形成清晰的边界。根据Steinberg的差异性黏附假说，细胞间的相互作用可以被视为一个[热力学过程](@entry_id:141636)，系统倾向于达到总黏附能最低的状态。定义 $\mathcal{A}$ 型和 $\mathcal{B}$ 型细胞间的接触自由能分别为 $E_{\mathcal{A}\mathcal{A}}$, $E_{\mathcal{B}\mathcal{B}}$ 和 $E_{\mathcal{A}\mathcal{B}}$。如果同类型细胞间的黏附（对应较低的能量）强于不同类型细胞间的黏附，那么一个衡量[界面能](@entry_id:198323)的有效[界面张力](@entry_id:271901) $\gamma = E_{\mathcal{A}\mathcal{B}} - \frac{1}{2}(E_{\mathcal{A}\mathcal{A}} + E_{\mathcal{B}\mathcal{B}})$ 将为正值（$\gamma  0$）。在这种情况下，系统会通过减少高能量的 $\mathcal{A}$-$\mathcal{B}$ 接触面积来降低总能量，最终导致细胞“相分离”，形成由连续的 $\mathcal{A}$ 细胞和 $\mathcal{B}$ 细胞组成的、边界清晰的两个域 [@problem_id:4354097]。

最后，**力学约束与差异性生长 (mechanical constraints and differential growth)** 也能驱动空间域的形成。在形态发生过程中，组织的不同部分可能以不同的速率生长，这可以通过一个空间依赖的生长因子场 $g(x)$ 来描述。例如，一个上皮细胞层受到下方基底膜的约束，无法自由伸展。如果细胞层经历不均匀的生长（例如，$g(x)$ 从一端到另一端单调递增），这种不相容的生长（即生长后的各微元无法在无应力状态下完美拼接）会在组织内部产生**残余应力 (residual stress)**。由于生长被约束，组织内会累积起压缩应力。当这种压缩应力超过一个由组织厚度 $h$ 和[材料刚度](@entry_id:158390)（如剪切模量 $\mu$）决定的临界阈值时，平面的细胞层会变得不稳定，并通过**[屈曲](@entry_id:162815) (buckling)** 或起皱的方式释放能量，形成一系列[褶皱](@entry_id:199664)。这些[褶皱](@entry_id:199664)的波峰方向通常垂直于压缩应力的方向，从而将组织划分为具有不同曲率和细胞堆积模式的力学空间域 [@problem_id:4354035]。

#### 一个形式化的数学定义

基于这些物理起源，我们可以给空间域一个更严谨、与模型相关的定义。在系统生物医学中，组织可以被视为一个连续介质，其性质由一系列空间变化的场来描述，例如细胞类型组成 $\mathbf{u}(\mathbf{x})$、细胞密度 $\rho(\mathbf{x})$ 和柯西应力场 $\boldsymbol{\sigma}(\mathbf{x})$。一个**空间域 (spatial domain)** 是组织内的一个连通子区域 $D$，在此区域内，这些多变量场是近似平滑的，且域内异质性远低于域间差异。域的边界则对应于这些场发生不连续或剧烈梯变的界面 [@problem_id:4354051]。

这个定义有助于我们将空间域与其他相关概念区分开来：
- **解剖学区室 (Anatomical Compartment)**：这通常是生理学或药代动力学中的一个宏观概念（如血液、肝脏），在建模时常被处理为“充分混合”的单元，其内部的空间变化被忽略，适合用[常微分方程](@entry_id:147024)（ODE）描述。
- **微环境 (Microenvironment)**：这是指单个细胞周围的局部邻域，由该点连续变化的场（如信号分子浓度、力学应力）所定义。它是一个点尺度或小邻域尺度的概念，不要求在一个大范围内的连通性或均一性。

在多尺度模型中，空间域是连接宏观与微观的桥梁。例如，我们可以将组织划分为多个空间域，在每个域内[求解偏微分方程](@entry_id:138485)（PDE）来描述场（如反应-扩散方程 $\partial_t c = D \nabla^2 c + s - \lambda c$）的连续变化，并通过在域间界面上施加通量连续等条件将它们耦合起来。

#### 空间域的可操作化公理

为了使“空间域”这一概念在面对真实、带噪声的实验数据时具有可操作性，我们需要一个更为抽象的公理化定义。我们可以将组织视为一个紧子集 $X \subset \mathbb{R}^2$，并假设存在一个可观测的多变量场 $F: X \to \mathbb{R}^p$（例如，结合了基因表达和组织学特征的场）。实验测量得到的是这个场在有限个点上的带噪采样 $\{(x_i, Y_i)\}$。

一个可操作的空间域定义可以构建如下：
1.  **分割函数 (Segmentation Function)**：我们定义一个分割函数 $g: X \to \{1,\dots,K\}$，它将组织中的每个点映射到一个离散的域标签。这个函数应仅依赖于可观测场 $F$，即 $g = \phi \circ F$，其中 $\phi$ 是一个从特征空间到标签空间的决策规则。为符合物理[局域性原理](@entry_id:753741)，$\phi$ 在点 $x$ 的决策应仅依赖于 $F$ 在 $x$ 的一个极小邻域内的值。
2.  **域与边界 (Domains and Boundaries)**：空间域被定义为分割函数的[原像](@entry_id:150899) $D_k = g^{-1}(\{k\})$。这些域构成了对 $X$ 的一个划分。域的边界 $B = \bigcup_k \partial D_k$（其中 $\partial D_k$ 是拓扑边界）在物理上应是“小”的，即其[勒贝格测度](@entry_id:139781)为零 ($\lambda(B)=0$)，且具有有限的周长（例如，其一维[豪斯多夫测度](@entry_id:200740) $\mathcal{H}^1(B)$ 是有限的）。
3.  **不变性 (Invariance)**：这个构造应该对可观测场的单位变换或可逆的染色变换不敏感。也就是说，对于 $F$ 的值域上的任何一个可测的可逆变换 $h$，我们定义的域划分不应改变。这保证了定义的内在稳定性。
4.  **认知一致性 (Epistemic Coherence)**：这样的定义与我们的数据生成过程是一致的。由于域是可观测场的原像，我们可以从带噪样本 $\{(x_i, Y_i)\}$ 中学习或估计分割函数 $g$。边界的测度为零且具有正则性（有限周长），这保证了我们在域上进行的积分等数学操作是良定义的。不变性则确保了我们从数据中识别出的结构是物理真实的，而非测量手段的人为产物 [@problem_id:4354077]。

### 空间域的测量与观测

理论上定义了空间域后，我们面临的下一个挑战是如何通过实验手段来精确地观测和测量它们。任何测量技术都有其固有的局限性，这些局限性直接决定了我们能够解析的[组织结构](@entry_id:146183)的尺度。

#### 测量技术的局限性

表征组织结构的主要技术包括光学显微镜和各类[空间组学](@entry_id:156223)技术。它们的分辨能力和采样方式截然不同，深刻影响着我们对空间域边界的识别能力。

一个成像或测量系统的性能可以用其**空间分辨率 (spatial resolution)** 来概括，它量化了系统能够区分的两个点状物体的最小间距。这个能力主要受**点扩展函数 (Point Spread Function, PSF)** 的限制。PSF，记为 $h(\mathbf{r})$，是系统对一个理想点源的响应。对于一个[线性移不变系统](@entry_id:274179)，我们观测到的图像 $I(\mathbf{r})$ 是真实物体 $o(\mathbf{r})$ 与系统PSF的卷积，再加上噪声 $n(\mathbf{r})$，即 $I(\mathbf{r}) = (h \ast o)(\mathbf{r}) + n(\mathbf{r})$。卷积操作相当于一个低通滤波器，会模糊掉小于PSF尺度的细节。

- **光学显微镜**：对于衍射受限的[荧光显微镜](@entry_id:138406)，其分辨率由光的波长 $\lambda$ 和[物镜](@entry_id:167334)的[数值孔径](@entry_id:138876) $NA$ 决定，理论极限约为 $d \approx \lambda/(2NA)$。一个典型的[共聚焦显微镜](@entry_id:199733)，其PSF的半高全宽（FWHM）可能在 $0.3 \, \mu\mathrm{m}$ 的量级。为了避免采样失真（混叠），数字相机的像素大小 $p$ 必须满足**香农-奈奎斯特采样准则 (Shannon-Nyquist sampling criterion)**，即采样频率至少是信号最高频率的两倍。在空间域，一个实用的准则是每个分辨率单元内至少有两个采样点，即 $p \le \mathrm{FWHM}/2$。如果满足此条件，那么限制边界识别能力的主要因素就是[光学分辨率](@entry_id:172575)本身，而非[数字采样](@entry_id:140476) [@problem_id:4354085]。

- **[空间转录组学](@entry_id:270096)**：许多基于捕获阵列的空间转录组学技术（如[10x Genomics Visium](@entry_id:181467)）的分辨率则由捕获探针点的大小 $D_s$ 和点间距 $s$ 决定。例如，一个平台的探针点直径可能为 $D_s=55\,\mu\mathrm{m}$，点间距为 $s=100\,\mu\mathrm{m}$。在这种情况下，每次测量都是对一个直径 $55\,\mu\mathrm{m}$ 区域内所有细胞转录本的平均。其有效空间分辨率就在 $D_s$ 的量级。

让我们考虑一个具体的例子：假设一个组织中两个域的边界过渡区域宽度为 $w = 5\,\mu\mathrm{m}$。对于上述显微镜（分辨率 $\approx 0.3\,\mu\mathrm{m}$），由于 $w \gg 0.3\,\mu\mathrm{m}$，它可以清晰地解析这个边界。然而，对于上述空间转录组学平台，由于 $w \ll D_s$，这个 $5\,\mu\mathrm{m}$ 的边界将被完全模糊在单个 $55\,\mu\mathrm{m}$ 的测量点中，导致来自不同域的转录本信息混合在一起，无法精确定位边界的位置 [@problem_id:4354085]。

#### 从组织学图像中提取特征

除了[空间组学](@entry_id:156223)，传统的[组织学染色](@entry_id:273995)图像（如HE染色）也是提取组织[微架构](@entry_id:751960)特征的重要来源。

- **[图像分割](@entry_id:263141) (Image Segmentation)**：分割是将图像划分为有意义区域的过程。
    - **[U-Net](@entry_id:635895)** 是一种深度学习模型，属于[编码器-解码器](@entry_id:637839)架构，通过[跳跃连接](@entry_id:637548)将高分辨率的浅层特征与深层语义特征融合，能够进行精确的像素级分类，非常适合用于分割不同的组织类型，如上皮和基质 [@problem_id:4354073]。
    - **分水岭分割 (Watershed Segmentation)** 是一种经典的基于拓扑学的分割算法。它将图像的梯度幅值视为地形，从局部最小值开始“注水”，水流相遇之处即为边界。为避免过度分割，通常使用**标记点控制的分水岭 (marker-controlled watershed)**。例如，在分离彼此接触的细胞核时，可以先计算细胞核二值掩膜的距离变换，其峰值对应细胞核中心，将这些峰值作为标记点，即可准确地在细胞核接触处画出边界 [@problem_id:4354073]。

- **[纹理分析](@entry_id:202600) (Texture Analysis)**：纹理是图像中重复出现的局部模式，能够反映组织的微观结构。
    - **Haralick纹理特征** 来源于**灰度[共生](@entry_id:142479)矩阵 (Gray Level Co-occurrence Matrix, GLCM)**。GLCM统计了在给定空间位移（距离和方向）下，成对像素灰度值的[联合概率分布](@entry_id:171550)，从而量化了图像的二阶空间统计信息。从GLCM可以计算出对比度、相关性、能量等一系列特征。这些特征对方向敏感，除非在多个方向上计算并平均 [@problem_id:4354073]。
    - **Gabor滤波器** 是一系列[带通滤波器](@entry_id:271673)，每个滤波器对特定方向和频率的条纹模式响应最强。通过应用一个覆盖不同方向和频率的Gabor[滤波器组](@entry_id:266441)，我们可以有效地识别和量化具有方向性的结构，例如基质中排列整齐的胶原纤维的**各向异性 (anisotropy)** [@problem_id:4354073]。

### 从[空间组学](@entry_id:156223)数据中识别域

[空间组学](@entry_id:156223)技术提供了在前所未有的规模上同时测量基因表达和空间位置的能力。分析这些数据需要一套专门的统计和计算方法。

#### 空间组织的统计特征

一个基本问题是：如何判断一个基因的表达模式在空间上是随机的，还是与[组织结构](@entry_id:146183)相关？

这个问题的核心是**[空间自相关](@entry_id:177050) (spatial autocorrelation)** 的概念，即一个变量在某个位置的值与其在邻近位置的值之间的相关性。在组织中，如果一个基因的表达呈现出聚集模式（高表达区域与高表达区域相邻，低表达区域与低表达区域相邻），我们就说它具有正[空间[自相](@entry_id:177050)关](@entry_id:138991)。这类基因被称为**空间变异基因 (Spatially Variable, SV, genes)**，它们是揭示潜在组织域的关键 [@problem_id:4354056]。

为了定量衡量[空间自相关](@entry_id:177050)，我们需要定义一个**空间权重矩阵 (Spatial Weight Matrix, SWM)** $W$。$W$ 是一个 $n \times n$ 的矩阵（$n$ 为测量点数），其中元素 $w_{ij}$ 表示点 $i$ 和点 $j$ 之间的“邻近度”或空间影响。$w_{ij}$ 可以基于距离（如 $w_{ij} = \exp(-d_{ij}/\ell)$，其中 $d_{ij}$ 是欧氏距离，$\ell$ 是长度尺度）或邻接关系（如 $w_{ij}=1$ 如果 $j$ 是 $i$ 的 $k$ 个最近邻之一，否则为0）来定义。通常 $w_{ii}=0$。

基于 $W$，可以计算两个经典的全局[空间自相关](@entry_id:177050)指数 [@problem_id:4354095]：
- **[Moran's I](@entry_id:192667)**：它类似于皮尔逊相关系数，衡量的是变量（中心化后）与其空间滞后值（邻近值的加权平均）之间的相关性。其公式为：
$$ I = \frac{n}{\sum_i \sum_j w_{ij}} \frac{\sum_i \sum_j w_{ij}(x_i - \bar{x})(x_j - \bar{x})}{\sum_i (x_i - \bar{x})^2} $$
其中 $x_i$ 是点 $i$ 的表达值，$\bar{x}$ 是样本均值。$I  0$ 表示正自相关（聚集），$I  0$ 表示负[自相关](@entry_id:138991)（棋盘状分散），$I \approx 0$ 表示空间随机性。

- **Geary's C**：它关注的是邻近位置值的差异。其公式为：
$$ C = \frac{n-1}{2 \sum_i \sum_j w_{ij}} \frac{\sum_i \sum_j w_{ij}(x_i - x_j)^2}{\sum_i (x_i - \bar{x})^2} $$
$C$ 的解释与[Moran's I](@entry_id:192667)相反：$C  1$ 表示正[自相关](@entry_id:138991)， $C  1$ 表示负[自相关](@entry_id:138991)， $C \approx 1$ 表示空间随机性。

值得注意的是，空间变异（SV）和**[差异表达](@entry_id:748396) (Differentially Expressed, DE)** 是两个正交的概念。DE基因是指其在不同样本（如疾病vs健康）间的平均表达水平有差异。一个基因可以是SV但非DE（例如，在两个样本中都呈棋盘状，但平均水平相同），也可以是DE但非SV（例如，在两个样本中平均水平不同，但在每个样本内部都是随机分布的），当然也可以两者都是或都不是 [@problem_id:4354056]。

#### 细胞邻域图与局部[结构表征](@entry_id:181604)

为了分析比单个测量点更宏观的结构，我们需要从离散的点云数据构建一个能够反映局部细胞环境的图结构，即**细胞邻域图 (cell neighborhood graph)**。

两种常用的建图方法是 [@problem_id:4354068]：
- **Delaunay[三角剖分](@entry_id:272253) (Delaunay Triangulation)**：它是一种连接点集的剖分方法，生成的图是平面的（边不交叉）。一个重要的特性是，对于一个足够大的随机点集，节点的[平均度](@entry_id:261638)数趋近于6。这意味着每个细胞的邻居数量相对恒定，而邻域的物理半径则会自适应于局部细胞密度：在稀疏区域，会连接到更远的细胞；在密集区域，邻居则很近。这种特性有助于稳定基于邻域的[统计估计](@entry_id:270031)。
- **[k-近邻图](@entry_id:751051) (k-Nearest Neighbor, k-NN, Graph)**：对于每个细胞，连接其最近的 $k$ 个细胞。这种方法保证了每个细胞的邻居数量严格为 $k$（如果进行对称化处理，度数会变化），但邻域的物理半径会随密度变化。与Delaunay[三角剖分](@entry_id:272253)不同，$k$-NN图不保证是平面的。

一旦构建了邻域图，我们就可以在每个细胞上计算其**邻域组成向量 (neighborhood composition vector)**，即其邻居细胞类型的加权[直方图](@entry_id:178776)。这提供了一种捕捉局部组织[微架构](@entry_id:751960)的强大方式。例如，通过统计一个上皮细胞的邻居中有多少是基质细胞，多少是免疫细胞，可以量化该细胞所处的边界或浸润环境。

#### 空间感知聚类：发现域的算法

识别空间域的最终目标是将所有测量点划分到不同的簇中，其中每个簇对应一个生物学上有意义的域。这要求[聚类算法](@entry_id:146720)不仅考虑分子特征的相似性，还要考虑空间邻近性。

- **DBSCAN (Density-Based Spatial Clustering of Applications with Noise)**：这是一种基于密度的[聚类算法](@entry_id:146720)。它需要两个参数：邻域半径 $\varepsilon$ 和[核心点](@entry_id:636711)所需的最小邻居数 $\mathrm{minPts}$。如果一个点的 $\varepsilon$-邻域内至少有 $\mathrm{minPts}$ 个点，它就被定义为[核心点](@entry_id:636711)。簇被定义为由[核心点](@entry_id:636711)密度可达的最大点集。DBSCAN的优势在于能发现任意形状的簇，并且能将稀疏区域的点识别为噪声。然而，它的一个关键限制是它对绝对密度敏感。在一个细胞密度不均的组织中，一个固定的 $(\varepsilon, \mathrm{minPts})$ 组合可能只能成功识别高密度区域的簇，而将低密度区域错误地标记为噪声或碎片化的小簇 [@problem_id:4354102]。

- **空间谱聚类 (Spatial Spectral Clustering)**：这是一种[基于图的聚类](@entry_id:174462)方法。它首先构建一个亲和力图，其中节点是细胞，边的权重 $A_{ij}$ 反映了细胞 $i$ 和 $j$ 的相似度。为了整合空间信息，边的权重可以设计为空间距离和分子特征距离的函数。一个常见的选择是高斯核的乘积：
$$ A_{ij} = \exp\left(-\frac{\|\mathbf{x}_i - \mathbf{x}_j\|^2}{2\sigma_x^2}\right) \cdot \exp\left(-\frac{\|\mathbf{g}_i - \mathbf{g}_j\|^2}{2\sigma_g^2}\right) $$
其中 $\mathbf{x}_i$ 是空间坐标，$\mathbf{g}_i$ 是基因表达向量，$\sigma_x$ 和 $\sigma_g$ 分别是空间和分子特征的带宽参数。谱聚类通过分析[图拉普拉斯矩阵](@entry_id:275190)的特征向量来寻找一个划分，该划分能最小化被切断的边的总权重（归一化割）。与DBSCAN不同，谱聚类对连接的**相对强度**敏感。只要域内连接的权重远大于域间连接，即使在绝对密度较低的区域，它也能成功地将域分离开 [@problem_id:4354102]。

### [组织结构](@entry_id:146183)形成与动力学的建模

识别出空间域后，一个更深层次的科学问题是：这些结构是如何形成和维持的？[计算建模](@entry_id:144775)为我们提供了一个“虚拟实验室”，可以在其中测试关于细胞行为和相互作用如何产生宏观[组织结构](@entry_id:146183)的假设。

两种在计算生物学中被广泛应用的框架是**细胞[Potts模型](@entry_id:139361) (Cellular Potts Model, CPM)** 和 **[顶点模型](@entry_id:756482) (Vertex Model, VM)** [@problem_id:4354053]。

- **细胞[Potts模型](@entry_id:139361) (CPM)**
    - **表示**：CPM是一个基于格点的模型。空间被划分为一个规则的[晶格](@entry_id:148274)（如正方形或立方体网格）。每个细胞被表示为一个具有相同细胞ID的连通格点区域。
    - **能量与机制**：系统的行为由一个能量函数（哈密顿量）驱动，该函数通常包括：
        1.  **黏附能**：位于不同细胞边界上的相邻格点对会贡献一个[界面能](@entry_id:198323) $J_{\tau_1, \tau_2}$，其中 $\tau$ 是细胞类型。较低的 $J$ 值对应更强的黏附。
        2.  **形状约束**：通过能量惩罚项来约束细胞的面积（或体积）和周长，使其接近目标值。这间接模拟了细胞的不可压缩性和皮层张力。
    - **动力学**：CPM的演化是**随机的**。在每个模拟步骤中，系统随机尝试将一个格点的ID更改为其邻居的ID。该尝试是否被接受取决于能量变化 $\Delta H$ 和一个代表细胞膜波动或活性的“[有效温度](@entry_id:161960)” $T$，遵循[Metropolis算法](@entry_id:137520)。这使得CPM非常适合模拟包含随机性的过程，如细胞迁移和边界重排。

- **[顶点模型](@entry_id:756482) (VM)**
    - **表示**：VM是一个离格点的、连续的模型，特别适用于模拟汇合的[上皮组织](@entry_id:261324)层。组织被表示为一个多边形网络，每个多边形代表一个细胞。模型的自由度是这些多边形相交的**顶点**。
    - **能量与机制**：系统的能量函数直接定义在顶点的几何位置上，通常包括：
        1.  **面积弹性**：一个惩罚项，惩罚细胞面积偏离其目标面积，模拟细胞的体积维持。
        2.  **线张力**：每个细胞间的连接边都被赋予一个线张力 $\Lambda_{ij}$，总能量包含所有边的线张力与长度的乘积之和。这个有效线张力综合了[细胞皮层](@entry_id:172828)的收缩力和细胞间的黏附力（更强的黏附会降低有效线张-力）。
    - **动力学**：VM的动力学通常是**确定性的**和[过阻尼](@entry_id:167953)的。每个顶点受到的力被计算为总能量对该顶点位置的负梯度 $\mathbf{F}_k = -\nabla_{\mathbf{v}_k} E$。顶点则沿着力的方向移动，直至系统达到[力平衡](@entry_id:267186)状态（$\mathbf{F}_k=0$）。这使得VM非常适合研究组织的力学[稳态](@entry_id:139253)和准静态重排过程。

这两个模型将本章开头讨论的[生物物理学](@entry_id:200723)原理（如差异性黏附和皮层张力）转化为具体的、可计算的规则，从而连接了细胞级的力与宏观的组织形态。

### 确保[空间分析](@entry_id:183208)的稳健性

在开发任何基于空间数据的预测模型或进行统计推断时，一个至关重要但常被忽视的问题是如何正确地评估模型的性能。由于空间数据存在自相关性，传统的[交叉验证方法](@entry_id:634398)可能会产生严重误导的结果。

#### [空间自相关](@entry_id:177050)的挑战

标准的 $K$-折交叉验证（CV）将数据随机分成 $K$ 份，轮流使用一份作为测试集，其余作为[训练集](@entry_id:636396)。其有效性的一个基本假设是训练集和[测试集](@entry_id:637546)之间是**独立同分布 (i.i.d.)** 的。然而，在空间数据中，由于[空间自相关](@entry_id:177050)，随机抽取的测试点几乎总能在其附近找到一个非常相似的训练点。这意味着训练集和测试集并非独立，模型可以轻易地通过“局部插值”来预测测试点，而不是学习到底层的、可泛化的规律。这导致交叉验证评估出的[预测误差](@entry_id:753692)会**系统性地偏低**，造成对模型性能的过度乐观估计 [@problem_id:4354038]。

#### 空间交叉验证方案

为了获得对模型在全新、未见过的空间区域上性能的[无偏估计](@entry_id:756289)，我们必须采用**空间[交叉验证](@entry_id:164650) (spatial cross-validation)** 方案，其核心思想是在训练集和测试集之间强制实现空间上的分离。

- **空间区块[交叉验证](@entry_id:164650) (Spatial Block Cross-Validation)**：此方法将整个空间[区域划分](@entry_id:748628)为若干个地理上邻接的区块（例如，网格）。然后，以整个区块为单位进行[交叉验证](@entry_id:164650)，即每次留出一个区块作为[测试集](@entry_id:637546)，用所有其他区块的数据进行训练。为了确保训练集和测试集间的独立性，区块的大小 $b$ 应被选择为大于或等于数据的[空间自相关](@entry_id:177050)长度 $\ell$（即相关性衰减到可忽略不计的距离） [@problem_id:4354038]。

- **留一区域法[交叉验证](@entry_id:164650) (Leave-One-Region-Out Cross-Validation)**：在处理来自多个独立样本（例如，多个病人的组织切片、多个发育阶段的胚胎）的数据时，这种方法最为直观和稳健。它每次留出一个完整的生物学样本（如一个完整的组织切片）作为[测试集](@entry_id:637546)，用所有其他样本进行训练。这直接模拟了模型在未来应用于一个全新样本时的场景，是评估[模型泛化](@entry_id:174365)能力的金标准 [@problem_id:4354038]。

总之，对空间数据进行建模时，必须摒弃朴素的[随机抽样](@entry_id:175193)验证，转向能够尊[重数](@entry_id:136466)据空间依赖结构的空间[交叉验证方法](@entry_id:634398)。只有这样，我们才能建立起对[组织结构](@entry_id:146183)和功能真正具有预测能力的、稳健的计算模型。