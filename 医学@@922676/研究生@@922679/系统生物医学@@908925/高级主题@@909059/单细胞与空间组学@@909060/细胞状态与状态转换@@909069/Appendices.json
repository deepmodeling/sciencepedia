{"hands_on_practices": [{"introduction": "这个练习使用一个简洁的一维动力学模型来阐明细胞状态的核心概念。通过分析一个描述基因调控的简单方程，我们将亲手计算系统的稳态（代表不同的细胞表型），判断其稳定性，并划分各自的吸引盆 ([@problem_id:4326573])。这个过程将揭示细胞如何根据其初始状态，最终“决定”其分化命运。", "problem": "考虑一个混合均匀的细胞群体，其宏观表型可以由一个单一的无量纲状态变量 $x \\in \\mathbb{R}$ 表示，该变量概括了某个调控程序（例如，一个归一化的基因表达模块）的活动。假设每个细胞的 $x$ 的时间演化由以下自治常微分方程 (ODE) 控制，\n$$\n\\frac{dx}{dt} \\;=\\; x\\,(1 - x)\\,(x - a)\n$$\n其中参数 $a \\in (0,1)$ 代表一个可调的生化阈值。在系统生物医学中，细胞状态对应于状态动力学的固定点（平衡点），其稳定性决定了表型的稳健性，而吸引盆则根据细胞的长期命运对初始条件进行划分。\n\n仅使用一维动力系统的基本定义和不动点附近的线性化概念，完成以下任务：\n\n1. 根据平衡的定义（$dx/dt = 0$）推导出系统的固定点。\n2. 通过分析每个固定点附近的线性化流的符号，对每个固定点的稳定性（稳定与不稳定）进行分类。\n3. 通过确定整个实线上的向量场的符号，确定与每个稳定固定点相关的吸引盆。\n\n最后，假设初始细胞状态 $x(0)$ 分布在区间 $[0,1]$ 上，并且独立地从具有形状参数 $\\alpha > 0$ 和 $\\beta > 0$ 的 Beta 分布中抽取，其概率密度为\n$$\n\\rho(x) \\;=\\; \\frac{x^{\\alpha - 1}\\,(1 - x)^{\\beta - 1}}{B(\\alpha,\\beta)} \\quad \\text{for } x \\in [0,1],\n$$\n其中 $B(\\alpha,\\beta) = \\displaystyle \\int_{0}^{1} t^{\\alpha - 1}\\,(1 - t)^{\\beta - 1}\\,dt$ 是欧拉 Beta 函数。令 $B_{z}(\\alpha,\\beta) = \\displaystyle \\int_{0}^{z} t^{\\alpha - 1}\\,(1 - t)^{\\beta - 1}\\,dt$ 表示（非正则化的）不完全 Beta 函数。以闭合形式计算 $[0,1]$ 中收敛到高表达状态 $x = 1$ 的初始状态的比例，该比例是 $a$、$\\alpha$ 和 $\\beta$ 的函数。将你的最终答案表示为单个解析表达式。最终答案中不要提供中间结果。不需要四舍五入，也无需报告物理单位。", "solution": "该问题陈述清晰，具有科学依据，并提供了一套完整的已知条件。这是一维动力系统中的一个标准问题，并应用于系统生物学中的种群动力学。因此，我们开始求解。\n\n细胞状态变量 $x$ 的时间演化由以下常微分方程控制：\n$$\n\\frac{dx}{dt} = f(x) = x(1 - x)(x - a)\n$$\n其中 $a \\in (0,1)$ 是一个参数。\n\n**1. 推导固定点**\n\n根据定义，系统的固定点（或平衡点）是使得变化率为零的 $x$ 值，记作 $x^*$。我们令 $\\frac{dx}{dt} = 0$：\n$$\nx^*(1 - x^*)(x^* - a) = 0\n$$\n此方程的解是左侧多项式的根。通过观察可得，固定点为：\n$$\nx_1^* = 0\n$$\n$$\nx_2^* = a\n$$\n$$\nx_3^* = 1\n$$\n\n**2. 固定点稳定性的分类**\n\n一维固定点 $x^*$ 的稳定性由向量场导数 $f'(x) = \\frac{df}{dx}$ 在 $x^*$ 处的值的符号决定。如果 $f'(x^*)  0$，则固定点是稳定的；如果 $f'(x^*) > 0$，则是不稳定的。\n\n首先，我们计算 $f(x)$ 的导数。为方便求导，我们先展开 $f(x)$：\n$$\nf(x) = (x - x^2)(x - a) = x^2 - ax - x^3 + ax^2 = -x^3 + (1+a)x^2 - ax\n$$\n其导数为：\n$$\nf'(x) = \\frac{d}{dx} \\left( -x^3 + (1+a)x^2 - ax \\right) = -3x^2 + 2(1+a)x - a\n$$\n现在，我们计算 $f'(x)$ 在三个固定点处的值。\n\n- **对于 $x_1^* = 0$**：\n$$\nf'(0) = -3(0)^2 + 2(1+a)(0) - a = -a\n$$\n因为给定 $a \\in (0,1)$，所以 $a > 0$，因此 $f'(0)  0$。位于 $x^* = 0$ 的固定点是**稳定的**。\n\n- **对于 $x_3^* = 1$**：\n$$\nf'(1) = -3(1)^2 + 2(1+a)(1) - a = -3 + 2 + 2a - a = a - 1\n$$\n因为 $a \\in (0,1)$，所以 $a  1$，因此 $f'(1)  0$。位于 $x^* = 1$ 的固定点是**稳定的**。这就是问题中提到的“高表达状态”。\n\n- **对于 $x_2^* = a$**：\n$$\nf'(a) = -3a^2 + 2(1+a)a - a = -3a^2 + 2a + 2a^2 - a = a - a^2 = a(1-a)\n$$\n因为 $a \\in (0,1)$，所以 $a > 0$ 且 $1-a > 0$。因此，它们的乘积 $f'(a) = a(1-a) > 0$。位于 $x^* = a$ 的固定点是**不稳定的**。\n\n**3. 确定吸引盆**\n\n固定点 $0$、$a$ 和 $1$ 将实线分割开。不稳定的固定点 $x^*=a$ 作为一个分界线，将状态空间划分为流向不同稳定吸引子的区域。为了确定吸引盆，我们分析固定点之间各区间上 $\\frac{dx}{dt} = f(x)$ 的符号。\n\n- 对于 $x \\in (a, 1)$：此时 $x > 0$，$1-x > 0$ 且 $x-a > 0$。因此 $f(x) = (+)(+)(+) > 0$。流向右侧，所以 $(a,1)$ 内的任何初始条件都将收敛到 $x=1$。\n- 对于 $x \\in (0, a)$：此时 $x > 0$，$1-x > 0$ 且 $x-a  0$。因此 $f(x) = (+)(+)(-)  0$。流向左侧，所以 $(0,a)$ 内的任何初始条件都将收敛到 $x=0$。\n- 对于 $x > 1$：此时 $x > 0$，$1-x  0$ 且 $x-a > 0$。因此 $f(x) = (+)(-)(+)  0$。流向左侧，所以 $(1, \\infty)$ 内的任何初始条件都将收敛到 $x=1$。\n- 对于 $x  0$：此时 $x  0$，$1-x > 0$ 且 $x-a  0$。因此 $f(x) = (-)(+)(-) > 0$。流向右侧，所以 $(-\\infty, 0)$ 内的任何初始条件都将收敛到 $x=0$。\n\n稳定固定点 $x^*=0$ 的吸引盆是 $(-\\infty, a)$。\n稳定固定点 $x^*=1$（高表达状态）的吸引盆是 $(a, \\infty)$。\n\n**4. 计算收敛到高表达状态的比例**\n\n问题要求计算收敛到高表达状态 $x=1$ 的初始细胞状态的比例。这些初始状态 $x(0)$ 位于 $x=1$ 的吸引盆内，即区间 $(a, \\infty)$。\n\n初始状态是从一个Beta分布中抽取的，其概率密度函数 $\\rho(x)$ 仅在区间 $[0,1]$ 上非零。因此，我们关心的是初始种群中状态 $x(0)$ 位于吸引盆和分布支撑集交集内的比例，即 $(a, \\infty) \\cap [0,1]$。由于 $a \\in (0,1)$，该交集为区间 $(a, 1]$。\n\n收敛到 $x=1$ 的细胞比例 $F$ 是 $x(0) \\in (a, 1]$ 的概率。该概率通过在此区间上对概率密度函数 $\\rho(x)$ 进行积分得到：\n$$\nF = P(a  x \\le 1) = \\int_a^1 \\rho(x) \\, dx\n$$\n代入给定的 $\\rho(x)$ 表达式：\n$$\nF = \\int_a^1 \\frac{x^{\\alpha - 1}(1 - x)^{\\beta - 1}}{B(\\alpha,\\beta)} \\, dx = \\frac{1}{B(\\alpha,\\beta)} \\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx\n$$\n积分 $\\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx$ 可以使用完全和不完全 Beta 函数的定义来表示。我们知道：\n$$\n\\int_0^1 t^{\\alpha - 1}(1 - t)^{\\beta - 1} \\, dt = B(\\alpha,\\beta)\n$$\n并且\n$$\n\\int_0^a t^{\\alpha - 1}(1 - t)^{\\beta - 1} \\, dt = B_a(\\alpha,\\beta)\n$$\n我们可以将从 $a$ 到 $1$ 的积分写为：\n$$\n\\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx = \\int_0^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx - \\int_0^a x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx\n$$\n代入定义：\n$$\n\\int_a^1 x^{\\alpha - 1}(1 - x)^{\\beta - 1} \\, dx = B(\\alpha,\\beta) - B_a(\\alpha,\\beta)\n$$\n最后，我们将此结果代回到比例 $F$ 的表达式中：\n$$\nF = \\frac{1}{B(\\alpha,\\beta)} \\left( B(\\alpha,\\beta) - B_a(\\alpha,\\beta) \\right) = 1 - \\frac{B_a(\\alpha,\\beta)}{B(\\alpha,\\beta)}\n$$\n这就是收敛到高表达状态 $x=1$ 的初始状态比例的最终闭合形式表达式。", "answer": "$$\n\\boxed{1 - \\frac{B_{a}(\\alpha, \\beta)}{B(\\alpha, \\beta)}}\n$$", "id": "4326573"}, {"introduction": "我们将分析系统生物学中的一个经典模型——基因“拨动开关”，它由两个相互抑制的基因构成。这项实践的核心是推导系统产生双稳态（两种稳定的细胞状态共存）的临界条件 ([@problem_id:4326416])。通过这种方式，我们可以理解细胞如何通过调节基因表达速率等参数，从单一命运潜能转变为可以在两种不同状态之间做出选择，这是细胞分化的一个基本机制。", "problem": "考虑一个对称的双基因相互抑制模块，其在粗粒化蛋白质浓度水平上由以下耦合常微分方程(ODEs)组建模：\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha}{1 + y^{n}} \\;-\\; x, \\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha}{1 + x^{n}} \\;-\\; y\n$$\n其中$x$和$y$表示两个相互抑制的转录因子的无量纲浓度，$\\alpha > 0$是一个由降解速率缩放的无量纲最大合成参数，而$n \\geq 1$是抑制作用的希尔协作指数。该系统在交换$x \\leftrightarrow y$时是对称的，细胞状态对应于该动力学系统的稳态，细胞状态的转变则对应于这些稳态在参数变化下的分岔。\n\n从稳态是满足$\\frac{dx}{dt} = 0$和$\\frac{dy}{dt} = 0$的解这一基本定义出发，并通过在稳态处计算方程组右端的雅可比矩阵进行线性稳定性分析，推导稳态方程并刻画其交点。然后，利用线性化和基于特征值的稳定性判据，确定对称稳态通过对称性破缺分岔失稳，转变为一对非对称稳态的条件。基于此，确定产生双稳态（两个稳定的非对称状态与一个不稳定的对称状态共存）的参数区域。\n\n将你的最终结果表示为一个精确的、闭合形式的解析表达式，即临界合成参数$\\alpha_{\\mathrm{crit}}(n)$作为希尔系数$n$的函数，它标志着对称平衡点双稳态的开始。不需要数值近似，也不需要单位，因为该问题是完全无量纲的。你的最终方框答案必须是单个解析表达式。", "solution": "该问题有效。这是一个来自系统生物学领域的、提法恰当且有科学依据的问题，要求为一个经典的基因拨动开关模型推导其分岔条件。\n\n描述两种蛋白质浓度$x$和$y$动力学的常微分方程(ODEs)组如下：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y\n$$\n其中$\\alpha > 0$和$n \\geq 1$是参数。\n\n首先，我们通过将时间导数设为零来确定系统的稳态$(x^*, y^*)$：$\\frac{dx}{dt} = 0$和$\\frac{dy}{dt} = 0$。这得到以下代数方程对，它们定义了系统的零斜线：\n$$\nx^* = \\frac{\\alpha}{1 + (y^*)^n} \\quad (1)\n$$\n$$\ny^* = \\frac{\\alpha}{1 + (x^*)^n} \\quad (2)\n$$\n稳态是这两条零斜线的交点。\n\n由于方程在交换$x \\leftrightarrow y$时具有对称性，我们可以寻找一个对称稳态，其中$x^* = y^*$。我们将此对称状态的浓度表示为$x_s$。将$y^* = x_s$和$x^* = x_s$代入方程(1)得到：\n$$\nx_s = \\frac{\\alpha}{1 + x_s^n}\n$$\n这个方程可以重新整理，以隐式地将$x_s$定义为参数$\\alpha$和$n$的函数：\n$$\nx_s(1 + x_s^n) = \\alpha\n$$\n对于$\\alpha > 0$和$n \\ge 1$，函数$f(x_s) = x_s(1+x_s^n)$在$x_s \\ge 0$时是单调递增的，这保证了对于任何给定的$\\alpha$，都存在唯一的对称稳态。\n\n接下来，我们进行线性稳定性分析，以确定此对称稳态稳定的条件。稳定性由系统在稳态$(x_s, x_s)$处计算的雅可比矩阵$J$的特征值决定。向量场由$F(x,y) = (\\frac{\\alpha}{1 + y^{n}} - x, \\frac{\\alpha}{1 + x^{n}} - y)$给出。雅可比矩阵是：\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1 + y^{n}} - x)  \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1 + y^{n}} - x) \\\\ \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1 + x^{n}} - y)  \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1 + x^{n}} - y) \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{\\alpha n y^{n-1}}{(1 + y^n)^2} \\\\ -\\frac{\\alpha n x^{n-1}}{(1 + x^n)^2}  -1 \\end{pmatrix}\n$$\n在对称稳态$(x_s, x_s)$处计算该矩阵：\n$$\nJ_s = J(x_s, x_s) = \\begin{pmatrix} -1  -\\frac{\\alpha n x_s^{n-1}}{(1 + x_s^n)^2} \\\\ -\\frac{\\alpha n x_s^{n-1}}{(1 + x_s^n)^2}  -1 \\end{pmatrix}\n$$\n为了简化非对角线项，我们使用稳态关系$\\alpha = x_s(1 + x_s^n)$。将其代入非对角线元素得到：\n$$\n-\\frac{\\alpha n x_s^{n-1}}{(1 + x_s^n)^2} = -\\frac{x_s(1 + x_s^n) n x_s^{n-1}}{(1 + x_s^n)^2} = -\\frac{n x_s^n}{1 + x_s^n}\n$$\n让我们定义一个无量纲量$\\beta = \\frac{n x_s^n}{1 + x_s^n}$。在对称稳态处的雅可比矩阵变为：\n$$\nJ_s = \\begin{pmatrix} -1  -\\beta \\\\ -\\beta  -1 \\end{pmatrix}\n$$\n$J_s$的特征值$\\lambda$是特征方程$\\det(J_s - \\lambda I) = 0$的根：\n$$\n\\det \\begin{pmatrix} -1 - \\lambda  -\\beta \\\\ -\\beta  -1 - \\lambda \\end{pmatrix} = (-1 - \\lambda)^2 - (-\\beta)^2 = (1 + \\lambda)^2 - \\beta^2 = 0\n$$\n这得到$1 + \\lambda = \\pm \\beta$，所以两个特征值是：\n$$\n\\lambda_1 = -1 - \\beta\n$$\n$$\n\\lambda_2 = -1 + \\beta\n$$\n为使稳态稳定，所有特征值的实部必须为负。由于$n \\ge 1$且$x_s > 0$（因为$\\alpha > 0$），我们有$\\beta = \\frac{n x_s^n}{1 + x_s^n} > 0$。因此，$\\lambda_1 = -1 - \\beta$总是负的。对称状态的稳定性因此完全由$\\lambda_2$的符号决定。\n如果$\\lambda_2  0$，即$-1 + \\beta  0$，或$\\beta  1$，则状态是稳定的。\n如果$\\lambda_2 > 0$，即$-1 + \\beta > 0$，或$\\beta > 1$，则状态变得不稳定。\n\n当对称稳态失去其稳定性时，发生对称性破缺分岔。这恰好发生在$\\lambda_2$穿过零的点，即$\\lambda_2 = 0$。这个临界条件是$\\beta = 1$。代入$\\beta$的表达式：\n$$\n\\frac{n x_s^n}{1 + x_s^n} = 1\n$$\n$$\nn x_s^n = 1 + x_s^n\n$$\n$$\n(n - 1) x_s^n = 1\n$$\n这个方程仅在$n-1 > 0$，即$n > 1$时，对$x_s > 0$有解。对于$n=1$，我们有$\\beta = \\frac{x_s}{1+x_s}  1$对于所有$x_s > 0$成立，因此对称状态总是稳定的，不会发生双稳态。为了使分岔存在，我们要求$n > 1$。\n求解分岔点处的稳态值$x_s$：\n$$\nx_s^n = \\frac{1}{n-1} \\implies x_s = \\left(\\frac{1}{n-1}\\right)^{1/n} = (n-1)^{-1/n}\n$$\n问题要求的是标记此分岔的临界合成参数$\\alpha_{\\mathrm{crit}}(n)$。我们可以通过将$x_s$的临界值代回稳态方程$\\alpha = x_s(1 + x_s^n)$来找到它。\n$$\n\\alpha_{\\mathrm{crit}}(n) = (n-1)^{-1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n简化括号中的项：\n$$\n1 + \\frac{1}{n-1} = \\frac{n-1 + 1}{n-1} = \\frac{n}{n-1}\n$$\n将此代回，我们得到$\\alpha_{\\mathrm{crit}}(n)$的最终表达式：\n$$\n\\alpha_{\\mathrm{crit}}(n) = (n-1)^{-1/n} \\left(\\frac{n}{n-1}\\right) = \\frac{n}{(n-1)^{1} (n-1)^{1/n}} = \\frac{n}{(n-1)^{1 + 1/n}}\n$$\n这可以写成：\n$$\n\\alpha_{\\mathrm{crit}}(n) = \\frac{n}{(n-1)^{\\frac{n+1}{n}}}\n$$\n对于$\\alpha > \\alpha_{\\mathrm{crit}}(n)$，系统表现出双稳态，具有两个稳定的非对称状态和一个不稳定的对称状态。对于$\\alpha  \\alpha_{\\mathrm{crit}}(n)$（且$n > 1$），系统是单稳态的，具有单个稳定的对称状态。因此，值$\\alpha_{\\mathrm{crit}}(n)$标志着双稳态的开始。", "answer": "$$\\boxed{\\frac{n}{(n-1)^{\\frac{n+1}{n}}}}$$", "id": "4326416"}, {"introduction": "现实中的细胞并非在完全确定的环境中演化，随机噪声扮演着至关重要的角色。本练习引入了“表观遗传景观”的概念，将细胞状态视为势能景观中的“山谷”，而状态间的转换则是噪声驱动的“翻山”过程 ([@problem_id:4326517])。我们将结合理论推导与数值计算，来量化这种随机转换的速率，从而更完整地理解细胞命运的可塑性与稳定性。", "problem": "在系统生物医学中，粗粒度的细胞状态可以表示为有效表观遗传景观上的吸引盆（稳定极小值），而噪声驱动的状态转换可以建模为随机越过势垒。考虑一个描述两种细胞状态的一维有效势，\n$$\nU(x) = \\frac{x^4}{4} - \\frac{x^2}{2},\n$$\n以及一个标量状态变量 $x(t)$ 的过阻尼随机动力学，该动力学由朗之万随机微分方程（SDE）控制，\n$$\ndx_t = -U'(x_t)\\,dt + \\sigma\\,dW_t,\n$$\n其中 $U'(x)$ 是 $U(x)$ 的导数，$\\sigma$ 是噪声振幅，$W_t$ 是标准维纳过程。对应的关于概率密度 $p(x,t)$ 的福克-普朗克方程（FPE）是描述 $p(x,t)$ 时间演化的一个经过充分检验的模型。\n\n任务：\n1. 严格从与给定SDE相关的FPE和稳态概率流为零的条件出发，推导出稳态概率密度 $p_{\\mathrm{ss}}(x)$（可相差一个乘法常数）。不要假设任何快捷公式；从第一性原理（FPE和流量平衡）进行推导。\n2. 在对称有限区间 $[-L,L]$ 上使用数值离散化方法，选择合适的 $L$ 以确保所有测试案例的尾部概率可忽略不计，对推导出的 $p_{\\mathrm{ss}}(x)$ 进行归一化，并计算对应于势垒和两个势阱区域的积分。使用足够大的 $L$ 以确保数值归一化的准确性；设置 $L = 3.5$ 并在 $[-L,L]$ 上使用 $N = 100001$ 个网格点进行均匀离散化。\n3. 使用 Kramers 过阻尼势垒穿越在小噪声区域的近似，根据势在极小值点和势垒顶点的曲率以及势垒高度，推导两个势阱之间的跃迁率。从经典假设出发推导此近似；不要使用未经证明的快捷公式。\n4. 实现一个程序，对每个指定的 $\\sigma$ 值执行以下操作：\n   - 根据推导的表达式数值构建未归一化的 $p_{\\mathrm{ss}}(x)$，并在 $[-L,L]$ 上对其进行归一化。\n   - 计算由 $\\{|x| \\le r\\}$ 定义的势垒区域中的概率质量，其中 $r = 0.25$。\n   - 计算由 $\\{x  -r\\}$ 定义的左势阱区域和由 $\\{x > r\\}$ 定义的右势阱区域中的概率质量。\n   - 根据您在过阻尼极限下推导的近似，计算势阱之间的 Kramers 跃迁率。\n\n使用的基本原理：\n- 过阻尼朗之万 SDE $dx_t = -U'(x_t)\\,dt + \\sigma\\,dW_t$。\n- 相关的关于 $p(x,t)$ 的福克-普朗克方程。\n- FPE 的稳态零流量解的概念。\n- 将跃迁率与势垒高度和局部曲率联系起来的经典小噪声过阻尼 Kramers 近似。\n\n测试套件：\n- 案例 1：$\\sigma = 0.05$。\n- 案例 2：$\\sigma = 0.20$。\n- 案例 3：$\\sigma = 0.70$。\n\n对于每个测试案例，您的程序必须按顺序输出一个列表，其中包含：Kramers 速率（浮点数）、势垒区域概率质量（浮点数）、左侧区域概率质量（浮点数）和右侧区域概率质量（浮点数）。将所有三个测试案例的列表聚合到单行输出中，该输出包含一个用方括号括起来的逗号分隔列表，例如 $\\texttt{[[a,b,c,d],[e,f,g,h],[i,j,k,l]]}$。不需要物理单位，也不涉及角度；所有输出都是无量纲的浮点数。", "solution": "这个问题是随机动力学和统计物理学中一个有效的练习，专门解决了双稳态系统中状态转换的建模问题。我们将首先进行所需的理论推导，然后概述数值实现。每个数学表达式，包括所有变量、数字和符号，都将用 LaTeX 排版。\n\n系统的状态由标量变量 $x(t)$ 描述，其动力学由过阻尼朗之万方程控制：\n$$\ndx_t = -U'(x_t)\\,dt + \\sigma\\,dW_t\n$$\n势是一个对称的双阱势，由下式给出：\n$$\nU(x) = \\frac{x^4}{4} - \\frac{x^2}{2}\n$$\n代表确定性力的势的导数是 $U'(x) = x^3 - x$。\n\n### 1. 稳态概率密度的推导\n\n状态变量 $x$ 的概率密度 $p(x,t)$ 的时间演化由福克-普朗克方程（FPE）描述。对于一个通用的一维朗之万方程 $dx_t = A(x_t)dt + B(x_t)dW_t$，其FPE为：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [A(x)p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [B(x)^2 p(x,t)]\n$$\n在我们的情况下，漂移项是 $A(x) = -U'(x)$，扩散项是常数 $B(x) = \\sigma$。将这些代入FPE得到：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [-U'(x)p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [\\sigma^2 p(x,t)]\n$$\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = \\frac{\\partial}{\\partial x} [U'(x)p(x,t)] + \\frac{\\sigma^2}{2}\\frac{\\partial^2 p(x,t)}{\\partial x^2}\n$$\n这个方程可以写成连续性方程的形式 $\\frac{\\partial p}{\\partial t} = -\\frac{\\partial J}{\\partial x}$，其中 $J(x,t)$ 是概率流。通过对 $x$ 提取一个偏导数，我们确定了流量：\n$$\n\\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ -U'(x)p(x,t) - \\frac{\\sigma^2}{2}\\frac{\\partial p(x,t)}{\\partial x} \\right]\n$$\n因此，概率流为：\n$$\nJ(x,t) = -U'(x)p(x,t) - \\frac{\\sigma^2}{2}\\frac{\\partial p(x,t)}{\\partial x}\n$$\n在稳态下，概率密度变得与时间无关，即 $p_{\\mathrm{ss}}(x)$，所以 $\\frac{\\partial p}{\\partial t} = 0$。这意味着稳态流 $J_{\\mathrm{ss}}(x)$ 必须相对于 $x$ 是一个常数，即 $\\frac{\\partial J_{\\mathrm{ss}}}{\\partial x} = 0$。\n\n问题指定了“稳态概率流为零”的条件，这对应于一个处于热平衡且满足细致平衡的系统。设置 $J_{\\mathrm{ss}}(x) = 0$：\n$$\n-U'(x)p_{\\mathrm{ss}}(x) - \\frac{\\sigma^2}{2}\\frac{dp_{\\mathrm{ss}}(x)}{dx} = 0\n$$\n这是一个关于 $p_{\\mathrm{ss}}(x)$ 的一阶可分离常微分方程。我们重新整理它来求解 $p_{\\mathrm{ss}}(x)$：\n$$\n\\frac{dp_{\\mathrm{ss}}}{p_{\\mathrm{ss}}} = -\\frac{2U'(x)}{\\sigma^2} dx\n$$\n两边积分得到：\n$$\n\\int \\frac{1}{p_{\\mathrm{ss}}} dp_{\\mathrm{ss}} = -\\frac{2}{\\sigma^2} \\int U'(x) dx\n$$\n$$\n\\ln(p_{\\mathrm{ss}}(x)) = -\\frac{2}{\\sigma^2} U(x) + C'\n$$\n其中 $C'$ 是积分常数。对两边取指数，我们得到未归一化的稳态概率密度：\n$$\np_{\\mathrm{ss}}(x) = e^{C'} \\exp\\left(-\\frac{2U(x)}{\\sigma^2}\\right)\n$$\n这就是玻尔兹曼-吉布斯分布。令 $C = e^{C'}$ 为归一化常数，我们有：\n$$\np_{\\mathrm{ss}}(x) = C \\exp\\left(-\\frac{2U(x)}{\\sigma^2}\\right)\n$$\n常数 $C$ 由归一化条件 $\\int_{-\\infty}^{\\infty} p_{\\mathrm{ss}}(x) dx = 1$ 确定。未归一化的分布是 $\\tilde{p}_{\\mathrm{ss}}(x) = \\exp\\left(-\\frac{2U(x)}{\\sigma^2}\\right)$。\n\n### 2. Kramers 跃迁率的推导\n\nKramers 理论提供了一个近似方法，用于计算通过热激活越过势垒从而逃离亚稳态（势阱）的速率。该理论在小噪声区域内有效，此时热能远小于势垒高度。在我们的朗之万方程中，摩擦系数为 $\\gamma=1$，扩散系数为 $D = \\sigma^2/2$。小噪声条件是 $\\Delta U \\gg D$，或 $2\\Delta U / \\sigma^2 \\gg 1$。\n\n跃迁率 $k$ 定义为流出势阱的概率流除以该势阱内的布居，即 $k = J/N_A$。我们考虑从左势阱（A）到右势阱（B）的跃迁。稳态流 $J$ 是恒定的。根据流量方程，我们有：\n$$\nJ = -U'(x)p(x) - \\frac{\\sigma^2}{2}\\frac{dp(x)}{dx}\n$$\n我们可以重新排列并乘以一个积分因子 $e^{2U(x)/\\sigma^2}$：\n$$\nJ e^{2U(x)/\\sigma^2} = -p(x)U'(x)e^{2U(x)/\\sigma^2} - \\frac{\\sigma^2}{2}\\frac{dp(x)}{dx} e^{2U(x)/\\sigma^2} = -\\frac{\\sigma^2}{2}\\frac{d}{dx}\\left( p(x)e^{2U(x)/\\sigma^2} \\right)\n$$\n将此式从深处A阱中的点 $x_1$ 积分到深处B阱中的点 $x_2$：\n$$\nJ \\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' = -\\frac{\\sigma^2}{2} \\left[ p(x_2)e^{2U(x_2)/\\sigma^2} - p(x_1)e^{2U(x_1)/\\sigma^2} \\right]\n$$\n为了计算速率，我们假设一个准稳态，即在A阱深处有一个源维持其平衡布居，在B阱深处有一个汇，使得 $p(x_2) \\to 0$。在A阱内，假设布居处于局部平衡：对于 $x \\approx x_1$，$p(x) \\approx N_A \\frac{e^{-2U(x)/\\sigma^2}}{Z_A}$，其中 $N_A$ 是A阱中的总布居数，$Z_A = \\int_A e^{-2U(x)/\\sigma^2}dx$ 是该阱的配分函数。设 $p(x_2)=0$ 并代入 $p(x_1)$：\n$$\nJ \\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' = \\frac{\\sigma^2}{2} p(x_1)e^{2U(x_1)/\\sigma^2} = \\frac{\\sigma^2}{2} \\left( N_A \\frac{e^{-2U(x_1)/\\sigma^2}}{Z_A} \\right) e^{2U(x_1)/\\sigma^2} = \\frac{\\sigma^2 N_A}{2 Z_A}\n$$\n那么跃迁率 $k = J/N_A$ 是：\n$$\nk = \\frac{\\sigma^2}{2} \\frac{1}{Z_A \\left( \\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' \\right)}\n$$\n这两个积分使用鞍点（拉普拉斯）方法进行评估，该方法对于小 $\\sigma$ 是准确的。\n势的极小值点在 $x_{min} = \\pm 1$，势垒顶点在 $x_{bar} = 0$。\n积分 $Z_A$ 主要由A阱中 $U(x)$ 在 $x_{min}$ 处的极小值决定。我们在 $x_{min}$ 附近对 $U(x)$ 进行二次近似：$U(x) \\approx U(x_{min}) + \\frac{1}{2}U''(x_{min})(x-x_{min})^2$。令 $\\omega_{min}^2 = U''(x_{min})$。\n$$\nZ_A = \\int_A e^{-2U(x)/\\sigma^2} dx \\approx \\int_{-\\infty}^{\\infty} e^{-\\frac{2}{\\sigma^2}[U(x_{min}) + \\frac{1}{2}\\omega_{min}^2(x-x_{min})^2]} dx = e^{-2U(x_{min})/\\sigma^2} \\sqrt{\\frac{2\\pi\\sigma^2}{2\\omega_{min}^2}} = e^{-2U(x_{min})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{min}}\n$$\n积分 $\\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx'$ 主要由 $U(x')$ 的最大值，即势垒顶点 $x_{bar}$ 决定。我们在 $x_{bar}$ 附近对 $U(x)$ 进行二次近似：$U(x) \\approx U(x_{bar}) - \\frac{1}{2}|U''(x_{bar})|(x-x_{bar})^2$。令 $\\omega_{bar}^2 = |U''(x_{bar})|$。\n$$\n\\int_{x_1}^{x_2} e^{2U(x')/\\sigma^2} dx' \\approx \\int_{-\\infty}^{\\infty} e^{\\frac{2}{\\sigma^2}[U(x_{bar}) - \\frac{1}{2}\\omega_{bar}^2(x-x_{bar})^2]} dx' = e^{2U(x_{bar})/\\sigma^2} \\sqrt{\\frac{2\\pi\\sigma^2}{2\\omega_{bar}^2}} = e^{2U(x_{bar})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{bar}}\n$$\n将这些近似值代回 $k$ 的表达式中：\n$$\nk \\approx \\frac{\\sigma^2}{2} \\frac{1}{\\left(e^{-2U(x_{min})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{min}}\\right) \\left(e^{2U(x_{bar})/\\sigma^2} \\frac{\\sigma\\sqrt{\\pi}}{\\omega_{bar}}\\right)} = \\frac{\\sigma^2}{2} \\frac{\\omega_{min}\\omega_{bar}}{\\sigma^2\\pi} e^{-2(U(x_{bar})-U(x_{min}))/\\sigma^2}\n$$\n这简化为过阻尼极限下（摩擦系数 $\\gamma=1$）的 Kramers 速率的最终表达式：\n$$\nk = \\frac{\\omega_{min}\\omega_{bar}}{2\\pi} \\exp\\left(-\\frac{2\\Delta U}{\\sigma^2}\\right)\n$$\n其中 $\\Delta U = U(x_{bar}) - U(x_{min})$ 是势垒高度。\n\n### 3. 对特定势的应用\n\n对于 $U(x) = x^4/4 - x^2/2$：\n-   极值点：$U'(x) = x^3 - x = 0 \\implies x = 0, \\pm 1$。\n-   二阶导数：$U''(x) = 3x^2 - 1$。\n-   极小值点在 $x_{min} = \\pm 1$。势值为 $U(\\pm 1) = 1/4 - 1/2 = -1/4$。\n-   势垒顶点在 $x_{bar} = 0$。势值为 $U(0) = 0$。\n-   势垒高度：$\\Delta U = U(0) - U(-1) = 0 - (-1/4) = 1/4$。\n-   极小值点曲率：$\\omega_{min}^2 = U''(\\pm 1) = 3(1)^2 - 1 = 2 \\implies \\omega_{min} = \\sqrt{2}$。\n-   势垒处曲率：$\\omega_{bar}^2 = |U''(0)| = |-1| = 1 \\implies \\omega_{bar} = 1$。\n\n将这些值代入速率公式：\n$$\nk = \\frac{\\sqrt{2} \\cdot 1}{2\\pi} \\exp\\left(-\\frac{2(1/4)}{\\sigma^2}\\right) = \\frac{\\sqrt{2}}{2\\pi} \\exp\\left(-\\frac{1}{2\\sigma^2}\\right)\n$$\n该公式将用于计算跃迁率。请注意，此近似在 $\\sigma$ 较小时最准确。对于 $\\sigma=0.7$，条件 $2\\Delta U/\\sigma^2 = 0.5/(0.7^2) \\approx 1.02$ 并不比 $1$ 大很多，因此预计 Kramers 公式的准确性会降低。\n\n### 4. 数值计算计划\n\n对于每个给定的 $\\sigma$ 值：\n1.  **Kramers 速率：** 使用推导出的公式计算 $k$。\n2.  **数值积分：**\n    a.  在区间 $[-L, L]$（其中 $L=3.5$）上为 $x$ 定义一个包含 $N=100001$ 个点的离散网格。\n    b.  在每个网格点 $x_i$ 上计算未归一化的概率密度 $\\tilde{p}_{\\mathrm{ss}}(x_i) = \\exp\\left(-\\frac{2(x_i^4/4 - x_i^2/2)}{\\sigma^2}\\right)$。\n    c.  使用数值积分（例如，梯形法则）计算归一化常数 $Z = \\int_{-L}^{L} \\tilde{p}_{\\mathrm{ss}}(x) dx$。\n    d.  获得归一化的概率密度 $p_{\\mathrm{ss}}(x_i) = \\tilde{p}_{\\mathrm{ss}}(x_i) / Z$。\n    e.  使用边界参数 $r=0.25$ 定义感兴趣的区域：左势阱（$x  -r$）、势垒（$-r \\le x \\le r$）和右势阱（$x > r$）。\n    f.  再次使用数值积分，通过在相应子区间上积分 $p_{\\mathrm{ss}}(x)$ 来计算每个区域的概率质量。\n    -   $P_{\\text{barrier}} = \\int_{-r}^{r} p_{\\mathrm{ss}}(x) dx$\n    -   $P_{\\text{left}} = \\int_{-L}^{-r} p_{\\mathrm{ss}}(x) dx$\n    -   $P_{\\text{right}} = \\int_{r}^{L} p_{\\mathrm{ss}}(x) dx$\n\n由于势 $U(x)$ 的对称性，我们预计 $P_{\\text{left}} \\approx P_{\\text{right}}$。这三个概率之和应接近于 $1$。", "answer": "```python\nimport numpy as np\n# scipy is listed as an allowed library, but numpy's trapz is sufficient and standard.\n# from scipy.integrate import trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating Kramers' rate and regional probabilities\n    for a particle in a double-well potential.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    L = 3.5  # Interval [-L, L]\n    N = 100001  # Number of grid points\n    r = 0.25  # Barrier region radius {|x| = r}\n    test_cases = [0.05, 0.20, 0.70]  # Noise amplitudes (sigma)\n\n    # --- Analytical values from derivation for Kramers Rate ---\n    # U(x) = x^4/4 - x^2/2\n    # Minima at x_min = +/- 1, barrier at x_bar = 0\n    # U(x_min) = -1/4, U(x_bar) = 0 => Delta_U = 1/4\n    # U''(x) = 3x^2 - 1\n    # omega_min^2 = U''(1) = 2  => omega_min = sqrt(2)\n    # omega_bar^2 = |U''(0)| = 1 => omega_bar = 1\n    sqrt_2 = np.sqrt(2)\n    two_pi = 2 * np.pi\n    \n    # --- Grid for numerical integration ---\n    x_grid = np.linspace(-L, L, N)\n\n    def potential(x):\n        \"\"\"The double-well potential U(x).\"\"\"\n        return x**4 / 4 - x**2 / 2\n\n    # --- Lists to store results ---\n    all_results = []\n\n    for sigma in test_cases:\n        # 1. Compute Kramers Rate\n        # k = (omega_min * omega_bar) / (2*pi) * exp(-2 * Delta_U / sigma^2)\n        # k = (sqrt(2) * 1) / (2*pi) * exp(-2 * (1/4) / sigma^2)\n        exponent = -1 / (2 * sigma**2)\n        kramers_rate = (sqrt_2 / two_pi) * np.exp(exponent)\n\n        # 2. Compute Probability Masses\n        # Unnormalized steady-state probability density\n        p_unnormalized = np.exp(-2 * potential(x_grid) / sigma**2)\n        \n        # Normalization constant Z using trapezoidal rule\n        Z = np.trapz(p_unnormalized, x_grid)\n        \n        # Normalized probability density\n        p_ss = p_unnormalized / Z\n\n        # Define masks for the integration regions\n        barrier_mask = np.abs(x_grid) = r\n        left_mask = x_grid  -r\n        right_mask = x_grid > r\n\n        # Compute probability mass in each region\n        # np.trapz(y, x) integrates y(x) dx\n        prob_barrier = np.trapz(p_ss[barrier_mask], x_grid[barrier_mask])\n        prob_left = np.trapz(p_ss[left_mask], x_grid[left_mask])\n        prob_right = np.trapz(p_ss[right_mask], x_grid[right_mask])\n        \n        # Store results for this case\n        case_results = [kramers_rate, prob_barrier, prob_left, prob_right]\n        all_results.append(case_results)\n\n    # --- Format and print the final output ---\n    # The required format is a list of lists, string-formatted without spaces.\n    # Ex: [[a,b,c,d],[e,f,g,h],[i,j,k,l]]\n    inner_strs = []\n    for sublist in all_results:\n        # Format numbers to be clean and comma-separated\n        formatted_numbers = \",\".join(f\"{x:.8e}\" for x in sublist)\n        inner_strs.append(f\"[{formatted_numbers}]\")\n    \n    final_output = f\"[{','.join(inner_strs)}]\"\n    print(final_output)\n\nsolve()\n\n```", "id": "4326517"}]}