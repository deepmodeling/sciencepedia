{"hands_on_practices": [{"introduction": "掌握动态贝叶斯网络（DBN）的第一步是理解如何利用其进行推理。本练习将引导您完成一个基本但至关重要的任务：滤波（filtering）。通过在一个小规模的基因调控网络模型中手动计算，您将实践如何根据一系列观测数据，逐步推断出系统在每个时间点的隐藏状态，即“信念状态”。这个过程揭示了DBN中信息传播的核心机制——预测与更新的递归循环，为理解更复杂的推理算法（如平滑和解码）奠定了坚实的基础。[@problem_id:4336551]", "problem": "考虑一个由动态贝叶斯网络（DBN）建模的基因调控时间序列，其中隐变量是转录因子活性 $T_t \\in \\{0,1\\}$ 和基因激活状态 $G_t \\in \\{0,1\\}$，观测变量是在时间 $t$ 的离散化表达测量值 $Y_t \\in \\{0,1\\}$。该 DBN 由以下结构定义：初始先验 $p(T_1)$ 和 $p(G_1 \\mid T_1)$；马尔可夫转移 $p(T_t \\mid T_{t-1})$ 和 $p(G_t \\mid G_{t-1}, T_t)$；以及一个发射模型 $p(Y_t \\mid G_t)$。条件概率表（CPT）如下所示（所有数值均为概率）：\n\n- 转录因子的初始先验：$p(T_1=1) = 0.6$， $p(T_1=0) = 0.4$。\n- 给定转录因子的初始基因状态：$p(G_1=1 \\mid T_1=1) = 0.7$， $p(G_1=0 \\mid T_1=1) = 0.3$； $p(G_1=1 \\mid T_1=0) = 0.2$， $p(G_1=0 \\mid T_1=0) = 0.8$。\n- 转录因子动态：$p(T_t=1 \\mid T_{t-1}=1) = 0.8$， $p(T_t=0 \\mid T_{t-1}=1) = 0.2$； $p(T_t=1 \\mid T_{t-1}=0) = 0.3$， $p(T_t=0 \\mid T_{t-1}=0) = 0.7$。\n- 以先前基因状态和当前转录因子为条件的基因动态：$p(G_t=1 \\mid G_{t-1}=1, T_t=1) = 0.9$， $p(G_t=0 \\mid G_{t-1}=1, T_t=1) = 0.1$； $p(G_t=1 \\mid G_{t-1}=0, T_t=1) = 0.5$， $p(G_t=0 \\mid G_{t-1}=0, T_t=1) = 0.5$； $p(G_t=1 \\mid G_{t-1}=1, T_t=0) = 0.6$， $p(G_t=0 \\mid G_{t-1}=1, T_t=0) = 0.4$； $p(G_t=1 \\mid G_{t-1}=0, T_t=0) = 0.1$， $p(G_t=0 \\mid G_{t-1}=0, T_t=0) = 0.9$。\n- 发射模型：$p(Y_t=1 \\mid G_t=1) = 0.85$， $p(Y_t=0 \\mid G_t=1) = 0.15$； $p(Y_t=1 \\mid G_t=0) = 0.2$， $p(Y_t=0 \\mid G_t=0) = 0.8$。\n\n观测序列为 $y_{1:3} = (y_1, y_2, y_3) = (1, 0, 1)$。请使用贝叶斯定理的基本原理、全概率定律以及由 DBN 条件独立性编码的马尔可夫性质，执行精确滤波，为有序状态对 $(T_t,G_t) \\in \\{(1,1),(1,0),(0,1),(0,0)\\}$ 计算在 $t \\in \\{1,2,3\\}$ 时的归一化联合置信度 $p(T_t, G_t \\mid y_{1:t})$。\n\n最后，计算后验概率 $p(G_3 = 1 \\mid y_{1:3})$ 并将其作为最终答案报告。将最终答案四舍五入至四位有效数字。将最终答案表示为一个纯数字（无单位，无百分号）。", "solution": "该问题要求对动态贝叶斯网络（DBN）执行精确滤波，以计算在给定观测序列的情况下隐状态的后验概率。时间 $t$ 的隐状态是一个复合变量 $X_t = (T_t, G_t)$，其中 $T_t$ 是转录因子活性，$G_t$ 是基因激活状态。$X_t$ 的状态空间由 4 个可能的状态组成，我们将始终按 $\\{(1,1), (1,0), (0,1), (0,0)\\}$ 的顺序排列。时间 $t$ 的观测值为 $Y_t$。我们得到的观测序列为 $y_{1:3}=(1,0,1)$。\n\n滤波任务是计算 $t=1, 2, 3$ 时的后验分布 $p(X_t \\mid y_{1:t})$。这通过一个涉及预测步骤和更新步骤的递归过程来实现。令 $\\pi_t(X_t) \\equiv p(X_t \\mid y_{1:t})$ 为时间 $t$ 的滤波置信度。\n\n递归过程如下：\n1.  **预测**：状态的一步向前预测由 Chapman-Kolmogorov 方程给出：\n    $$p(X_t \\mid y_{1:t-1}) = \\sum_{X_{t-1}} p(X_t \\mid X_{t-1}) p(X_{t-1} \\mid y_{1:t-1})$$\n    转移概率 $p(X_t \\mid X_{t-1})$ 由 DBN 结构确定：$p(X_t \\mid X_{t-1}) = p(T_t, G_t \\mid T_{t-1}, G_{t-1}) = p(T_t \\mid T_{t-1}) p(G_t \\mid G_{t-1}, T_t)$。\n\n2.  **更新**：使用贝叶斯法则，通过观测值 $y_t$ 更新预测分布：\n    $$p(X_t \\mid y_{1:t}) = \\frac{p(y_t \\mid X_t, y_{1:t-1}) p(X_t \\mid y_{1:t-1})}{p(y_t \\mid y_{1:t-1})}$$\n    根据 DBN 结构，给定当前状态 $X_t$，发射 $Y_t$ 与过去的状态和观测条件独立。具体来说，$p(y_t \\mid X_t, y_{1:t-1}) = p(y_t \\mid X_t) = p(y_t \\mid G_t)$。分母是一个归一化常数。因此，更新可以写为：\n    $$\\pi_t(X_t) \\propto p(y_t \\mid G_t) p(X_t \\mid y_{1:t-1})$$\n\n现在我们将对 $t=1, 2, 3$ 应用此过程。\n\n**时间步 $t=1$**\n\n对于 $t=1$， “预测”就是初始状态 $X_1$ 的先验分布。\n先验联合概率为 $p(X_1) = p(T_1, G_1) = p(T_1) p(G_1 \\mid T_1)$。\n$p(T_1=1, G_1=1) = p(T_1=1) p(G_1=1 \\mid T_1=1) = 0.6 \\times 0.7 = 0.42$。\n$p(T_1=1, G_1=0) = p(T_1=1) p(G_1=0 \\mid T_1=1) = 0.6 \\times 0.3 = 0.18$。\n$p(T_1=0, G_1=1) = p(T_1=0) p(G_1=1 \\mid T_1=0) = 0.4 \\times 0.2 = 0.08$。\n$p(T_1=0, G_1=0) = p(T_1=0) p(G_1=0 \\mid T_1=0) = 0.4 \\times 0.8 = 0.32$。\n\n接下来，我们用观测值 $y_1=1$ 更新此先验。未归一化的后验（前向消息）$\\alpha_1(X_1)$ 为：\n$\\alpha_1(X_1) = p(y_1 \\mid G_1) p(X_1)$。\n$y_1=1$ 的发射概率：$p(Y_1=1 \\mid G_1=1) = 0.85$，$p(Y_1=1 \\mid G_1=0) = 0.2$。\n$\\alpha_1(1,1) = p(Y_1=1 \\mid G_1=1) p(1,1) = 0.85 \\times 0.42 = 0.357$。\n$\\alpha_1(1,0) = p(Y_1=1 \\mid G_1=0) p(1,0) = 0.20 \\times 0.18 = 0.036$。\n$\\alpha_1(0,1) = p(Y_1=1 \\mid G_1=1) p(0,1) = 0.85 \\times 0.08 = 0.068$。\n$\\alpha_1(0,0) = p(Y_1=1 \\mid G_1=0) p(0,0) = 0.20 \\times 0.32 = 0.064$。\n\n归一化常数为 $Z_1 = \\sum_{X_1} \\alpha_1(X_1) = 0.357 + 0.036 + 0.068 + 0.064 = 0.525$。\n滤波置信度 $\\pi_1(X_1)=p(X_1 \\mid y_1)$ 为：\n$\\pi_1(1,1) = 0.357 / 0.525 = 0.68$。\n$\\pi_1(1,0) = 0.036 / 0.525 \\approx 0.06857$。\n$\\pi_1(0,1) = 0.068 / 0.525 \\approx 0.12952$。\n$\\pi_1(0,0) = 0.064 / 0.525 \\approx 0.12190$。\n\n**时间步 $t=2$**\n\n首先是预测步骤。我们计算 $p(X_2 \\mid y_1) = \\sum_{X_1} p(X_2 \\mid X_1) \\pi_1(X_1)$。\n$p(X_2=(T_2,G_2) \\mid y_1) = \\sum_{T_1,G_1} p(T_2 \\mid T_1) p(G_2 \\mid G_1, T_2) \\pi_1(T_1, G_1)$。\n对 $X_2$ 的 4 个状态中的每一个都执行此计算。为简洁起见，我们给出预测概率向量 $(p(1,1 \\mid y_1), p(1,0 \\mid y_1), p(0,1 \\mid y_1), p(0,0 \\mid y_1))$ 的结果：\n$p(X_2 \\mid y_1) \\approx (0.57029, 0.10400, 0.14590, 0.17981)$。这些是通过对前一时刻的滤波置信度 $\\pi_1$ 应用转移模型计算得出的。\n或者，使用分数表示法来避免舍入误差，预测概率为 $(\\frac{299.4}{525}, \\frac{54.6}{525}, \\frac{76.6}{525}, \\frac{94.4}{525})$。\n\n接下来，我们用观测值 $y_2=0$ 进行更新。$y_2=0$ 的发射概率：$p(Y_2=0 \\mid G_2=1) = 0.15$，$p(Y_2=0 \\mid G_2=0) = 0.8$。\n未归一化的后验为 $\\alpha_2(X_2) \\propto p(y_2 \\mid G_2) p(X_2 \\mid y_1)$。\n$\\alpha_2(1,1) \\propto 0.15 \\times (299.4/525) = 44.91/525$。\n$\\alpha_2(1,0) \\propto 0.80 \\times (54.6/525) = 43.68/525$。\n$\\alpha_2(0,1) \\propto 0.15 \\times (76.6/525) = 11.49/525$。\n$\\alpha_2(0,0) \\propto 0.80 \\times (94.4/525) = 75.52/525$。\n\n归一化常数为 $Z_2 = (44.91 + 43.68 + 11.49 + 75.52) / 525 = 175.6/525$。\n滤波置信度 $\\pi_2(X_2)=p(X_2 \\mid y_{1:2})$ 为：\n$\\pi_2(1,1) = (44.91/525) / (175.6/525) = 44.91 / 175.6 \\approx 0.25575$。\n$\\pi_2(1,0) = 43.68 / 175.6 \\approx 0.24875$。\n$\\pi_2(0,1) = 11.49 / 175.6 \\approx 0.06543$。\n$\\pi_2(0,0) = 75.52 / 175.6 \\approx 0.43007$。\n\n**时间步 $t=3$**\n\n预测步骤：$p(X_3 \\mid y_{1:2}) = \\sum_{X_2} p(X_3 \\mid X_2) \\pi_2(X_2)$。\n$X_3$ 的预测概率向量（使用分数表示法）：\n$p(X_3 \\mid y_{1:2}) = (\\frac{64.2375}{175.6}, \\frac{32.7375}{175.6}, \\frac{16.375}{175.6}, \\frac{62.25}{175.6})$。\n\n用观测值 $y_3=1$ 进行更新。$y_3=1$ 的发射概率：$p(Y_3=1 \\mid G_3=1) = 0.85$，$p(Y_3=1 \\mid G_3=0) = 0.2$。\n未归一化的后验为 $\\alpha_3(X_3) \\propto p(y_3 \\mid G_3) p(X_3 \\mid y_{1:2})$。\n$\\alpha_3(1,1) \\propto 0.85 \\times (64.2375/175.6) = 54.601875/175.6$。\n$\\alpha_3(1,0) \\propto 0.20 \\times (32.7375/175.6) = 6.5475/175.6$。\n$\\alpha_3(0,1) \\propto 0.85 \\times (16.375/175.6) = 13.91875/175.6$。\n$\\alpha_3(0,0) \\propto 0.20 \\times (62.25/175.6) = 12.45/175.6$。\n\n归一化常数 $Z_3 = (54.601875 + 6.5475 + 13.91875 + 12.45) / 175.6 = 87.518125/175.6$。\n滤波置信度 $\\pi_3(X_3)=p(X_3 \\mid y_{1:3})$ 为：\n$\\pi_3(1,1) = 54.601875 / 87.518125 \\approx 0.62388$。\n$\\pi_3(1,0) = 6.5475 / 87.518125 \\approx 0.07481$。\n$\\pi_3(0,1) = 13.91875 / 87.518125 \\approx 0.15904$。\n$\\pi_3(0,0) = 12.45 / 87.518125 \\approx 0.14225$。\n\n**最终答案计算**\n\n问题要求计算后验概率 $p(G_3=1 \\mid y_{1:3})$。这通过将联合后验分布 $p(T_3, G_3 \\mid y_{1:3})$ 对变量 $T_3$ 进行边际化来获得。\n$$p(G_3=1 \\mid y_{1:3}) = \\sum_{T_3 \\in \\{0,1\\}} p(T_3, G_3=1 \\mid y_{1:3})$$\n$$p(G_3=1 \\mid y_{1:3}) = p(T_3=1, G_3=1 \\mid y_{1:3}) + p(T_3=0, G_3=1 \\mid y_{1:3})$$\n$$p(G_3=1 \\mid y_{1:3}) = \\pi_3(1,1) + \\pi_3(0,1)$$\n使用未舍入的值以获得最大精度：\n$$p(G_3=1 \\mid y_{1:3}) = \\frac{54.601875}{87.518125} + \\frac{13.91875}{87.518125} = \\frac{54.601875 + 13.91875}{87.518125} = \\frac{68.520625}{87.518125}$$\n$$p(G_3=1 \\mid y_{1:3}) \\approx 0.78293605$$\n将结果四舍五入到四位有效数字得到 $0.7829$。", "answer": "$$\\boxed{0.7829}$$", "id": "4336551"}, {"introduction": "一个模型的实用性取决于其参数的准确性。然而，在生物系统中，这些参数（如状态转换速率）通常是未知的。本练习将带您进入参数学习的核心，通过应用著名的 Baum-Welch 算法（期望最大化算法在隐马尔可夫模型中的一个特例）来解决这个问题。您将利用前向-后向算法计算的期望统计量，从观测数据中估计模型的转换概率。这项实践是连接理论模型与真实实验数据的桥梁，是利用时间序列数据构建和校准生物网络模型的关键技能。[@problem_id:4336550]", "problem": "考虑一个用于系统生物医学中单个基因调控活性的双态隐马尔可夫模型 (HMM) 的动态贝叶斯网络 (DBN) 表示。潜在调控状态由 $Z_t \\in \\{1,2\\}$ 表示，其中 $Z_t=1$ 表示非活动状态，$Z_t=2$ 表示活动状态。在时间 $t$ 的观测表达测量值是一个连续变量 $Y_t \\in \\mathbb{R}$。该模型遵循一阶马尔可夫性质和给定潜在状态下观测值之间的条件独立性，其基本组成部分如下：\n- 初始分布 $p(Z_1=i)=\\pi_i$。\n- 转移分布 $p(Z_t=j \\mid Z_{t-1}=i)=a_{ij}$，其中对于每个 $i$，$\\sum_{j} a_{ij}=1$ 且 $a_{ij} \\ge 0$。\n- 发射分布 $p(Y_t \\mid Z_t=i)$。\n\n假设发射模型是高斯分布：$Y_t \\mid Z_t=i \\sim \\mathcal{N}(\\mu_i,\\sigma^2)$，其中 $\\mu_1=0$，$\\mu_2=2$，$\\sigma^2=1$。潜在动态的 HMM 参数为：\n- 初始分布 $\\pi_1=0.6$，$\\pi_2=0.4$。\n- 转移矩阵项 $a_{11}=0.85$，$a_{12}=0.15$，$a_{21}=0.30$，$a_{22}=0.70$。\n\n您观测到时间序列 $Y_1=0.3$，$Y_2=1.9$，$Y_3=2.1$（即 $T=3$）。使用从联合因子分解 $p(Z_{1:T},Y_{1:T}) = p(Z_1)\\prod_{t=2}^{T}p(Z_t\\mid Z_{t-1})\\prod_{t=1}^{T}p(Y_t\\mid Z_t)$ 推导出的前向-后向算法和条件期望的定义，计算 $t=2$ 和 $t=3$ 的期望转移计数 $\\mathbb{E}\\left[\\mathbb{I}\\{Z_{t-1}=1,Z_t=2\\}\\mid Y_{1:3}\\right]$，并使用它们在归一化约束 $\\sum_{j} a_{1j}=1$ 下执行转移概率 $p(Z_t=2\\mid Z_{t-1}=1)$ 的最大似然更新。\n\n提供 $p(Z_t=2\\mid Z_{t-1}=1)$ 的最终更新值，作为一个实数。将您的答案四舍五入到四位有效数字。以小数形式表示概率（不要使用百分号）。", "solution": "目标是找到转移概率 $a_{12} = p(Z_t=2 \\mid Z_{t-1}=1)$ 的 M 步更新。在 Baum-Welch 算法中，重估 $a_{ij}$ 的通用公式是从状态 $i$ 到状态 $j$ 的期望转移次数与从状态 $i$ 出发的所有期望转移次数之比。\n$$\n\\hat{a}_{ij} = \\frac{\\sum_{t=2}^{T} p(Z_{t-1}=i, Z_t=j \\mid Y_{1:T})}{\\sum_{k=1}^{2} \\sum_{t=2}^{T} p(Z_{t-1}=i, Z_t=k \\mid Y_{1:T})} = \\frac{\\sum_{t=2}^{T} p(Z_{t-1}=i, Z_t=j \\mid Y_{1:T})}{\\sum_{t=1}^{T-1} p(Z_t=i \\mid Y_{1:T})}\n$$\n量 $p(Z_{t-1}=i, Z_t=j \\mid Y_{1:T})$ 和 $p(Z_t=i \\mid Y_{1:T})$ 是平滑后验概率，使用前向-后向算法计算。\n\n令 $\\alpha_t(i) = p(Y_{1:t}, Z_t=i)$ 为前向变量，$\\beta_t(i) = p(Y_{t+1:T} \\mid Z_t=i)$ 为后向变量。\n单个状态 $Z_t$ 的平滑概率用 $\\gamma_t(i)$ 表示：\n$$\n\\gamma_t(i) = p(Z_t=i \\mid Y_{1:T}) = \\frac{\\alpha_t(i)\\beta_t(i)}{p(Y_{1:T})}\n$$\n连续状态对 $(Z_{t-1}, Z_t)$ 的平滑概率用 $\\xi_t(i,j)$ 表示：\n$$\n\\xi_t(i,j) = p(Z_{t-1}=i, Z_t=j \\mid Y_{1:T}) = \\frac{\\alpha_{t-1}(i) a_{ij} p(Y_t \\mid Z_t=j) \\beta_t(j)}{p(Y_{1:T})}\n$$\n观测序列的似然为 $p(Y_{1:T}) = \\sum_{i=1}^2 \\alpha_T(i)$。\n\n当 $T=3$ 时，$a_{12}$ 的更新公式变为：\n$$\n\\hat{a}_{12} = \\frac{\\xi_2(1,2) + \\xi_3(1,2)}{\\gamma_1(1) + \\gamma_2(1)}\n$$\n\n**步骤 I：发射概率**\n令 $b_i(Y_t) = p(Y_t \\mid Z_t=i) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(Y_t - \\mu_i)^2}{2\\sigma^2}\\right)$。当 $\\sigma^2=1$ 时：\n-   $Y_1=0.3$:\n    $b_1(Y_1) = \\mathcal{N}(0.3; 0, 1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.045) \\approx 0.381384$\n    $b_2(Y_1) = \\mathcal{N}(0.3; 2, 1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-1.445) \\approx 0.094045$\n-   $Y_2=1.9$:\n    $b_1(Y_2) = \\mathcal{N}(1.9; 0, 1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-1.805) \\approx 0.065616$\n    $b_2(Y_2) = \\mathcal{N}(1.9; 2, 1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.005) \\approx 0.396953$\n-   $Y_3=2.1$:\n    $b_1(Y_3) = \\mathcal{N}(2.1; 0, 1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-2.205) \\approx 0.043984$\n    $b_2(Y_3) = \\mathcal{N}(2.1; 2, 1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.005) \\approx 0.396953$\n\n**步骤 II：前向传递 ($\\alpha_t(i)$)**\n-   $t=1$:\n    $\\alpha_1(1) = \\pi_1 b_1(Y_1) = 0.6 \\times 0.381384 = 0.228830$\n    $\\alpha_1(2) = \\pi_2 b_2(Y_1) = 0.4 \\times 0.094045 = 0.037618$\n-   $t=2$:\n    $\\alpha_2(1) = (\\alpha_1(1)a_{11} + \\alpha_1(2)a_{21}) b_1(Y_2) = (0.228830 \\times 0.85 + 0.037618 \\times 0.30) \\times 0.065616 = 0.205791 \\times 0.065616 \\approx 0.013504$\n    $\\alpha_2(2) = (\\alpha_1(1)a_{12} + \\alpha_1(2)a_{22}) b_2(Y_2) = (0.228830 \\times 0.15 + 0.037618 \\times 0.70) \\times 0.396953 = 0.060657 \\times 0.396953 \\approx 0.024078$\n-   $t=3$:\n    $\\alpha_3(1) = (\\alpha_2(1)a_{11} + \\alpha_2(2)a_{21}) b_1(Y_3) = (0.013504 \\times 0.85 + 0.024078 \\times 0.30) \\times 0.043984 = 0.018702 \\times 0.043984 \\approx 0.00082256$\n    $\\alpha_3(2) = (\\alpha_2(1)a_{12} + \\alpha_2(2)a_{22}) b_2(Y_3) = (0.013504 \\times 0.15 + 0.024078 \\times 0.70) \\times 0.396953 = 0.018880 \\times 0.396953 \\approx 0.00749448$\n-   数据似然：$p(Y_{1:3}) = \\alpha_3(1) + \\alpha_3(2) \\approx 0.00082256 + 0.00749448 = 0.00831704$\n\n**步骤 III：后向传递 ($\\beta_t(i)$)**\n-   $t=3$: $\\beta_3(1) = 1, \\beta_3(2) = 1$。\n-   $t=2$:\n    $\\beta_2(1) = a_{11}b_1(Y_3)\\beta_3(1) + a_{12}b_2(Y_3)\\beta_3(2) = (0.85 \\times 0.043984) + (0.15 \\times 0.396953) = 0.037386 + 0.059543 = 0.096929$\n    $\\beta_2(2) = a_{21}b_1(Y_3)\\beta_3(1) + a_{22}b_2(Y_3)\\beta_3(2) = (0.30 \\times 0.043984) + (0.70 \\times 0.396953) = 0.013195 + 0.277867 = 0.291062$\n-   $t=1$:\n    $\\beta_1(1) = a_{11}b_1(Y_2)\\beta_2(1) + a_{12}b_2(Y_2)\\beta_2(2) = (0.85 \\times 0.065616 \\times 0.096929) + (0.15 \\times 0.396953 \\times 0.291062) = 0.005405 + 0.017329 = 0.022734$\n    $\\beta_1(2) = a_{21}b_1(Y_2)\\beta_2(1) + a_{22}b_2(Y_2)\\beta_2(2) = (0.30 \\times 0.065616 \\times 0.096929) + (0.70 \\times 0.396953 \\times 0.291062) = 0.001908 + 0.080870 = 0.082778$\n\n**步骤 IV：平滑概率**\n-   $\\gamma_t(i)$ 计算：\n    $\\gamma_1(1) = \\frac{\\alpha_1(1)\\beta_1(1)}{p(Y_{1:3})} = \\frac{0.228830 \\times 0.022734}{0.00831704} \\approx 0.62557$\n    $\\gamma_2(1) = \\frac{\\alpha_2(1)\\beta_2(1)}{p(Y_{1:3})} = \\frac{0.013504 \\times 0.096929}{0.00831704} \\approx 0.15738$\n    更新规则的分母是 $\\gamma_1(1) + \\gamma_2(1) \\approx 0.62557 + 0.15738 = 0.78295$。\n\n-   $\\xi_t(i,j)$ 计算（用于分子）：\n    $\\xi_2(1,2) = \\frac{\\alpha_1(1) a_{12} b_2(Y_2) \\beta_2(2)}{p(Y_{1:3})} = \\frac{0.228830 \\times 0.15 \\times 0.396953 \\times 0.291062}{0.00831704} = \\frac{0.0039665}{0.00831704} \\approx 0.47691$\n    $\\xi_3(1,2) = \\frac{\\alpha_2(1) a_{12} b_2(Y_3) \\beta_3(2)}{p(Y_{1:3})} = \\frac{0.013504 \\times 0.15 \\times 0.396953 \\times 1}{0.00831704} = \\frac{0.00080447}{0.00831704} \\approx 0.096726$\n    更新规则的分子是 $\\xi_2(1,2) + \\xi_3(1,2) \\approx 0.47691 + 0.096726 = 0.573636$。\n\n**步骤 V：参数更新**\n更新后的转移概率 $\\hat{a}_{12}$ 是：\n$$\n\\hat{a}_{12} = \\frac{\\xi_2(1,2) + \\xi_3(1,2)}{\\gamma_1(1) + \\gamma_2(1)} = \\frac{0.573636}{0.78295} \\approx 0.73266\n$$\n四舍五入到四位有效数字，结果为 $0.7327$。", "answer": "$$\\boxed{0.7327}$$", "id": "4336550"}, {"introduction": "系统生物学的一个中心目标不仅是描述系统，更是预测干预（如基因敲除或药物治疗）的后果。本练习将您的技能从观测性建模提升到因果推理的层面。您将学习如何通过在动态贝叶斯网络中引入“干预节点”，来明确地表示外部操作。通过推导干预下的联合分布的修正因子分解形式，您将从根本上理解 Judea Pearl 的“do-算子”如何改变模型的概率结构，从而使我们能够预测对系统进行特定操作时会发生什么。[@problem_id:4336566]", "problem": "在系统生物医学的背景下，考虑一个被建模为动态贝叶斯网络 (DBN) 的调控模块，该网络用双切片时序贝叶斯网络 (2TBN) 表示。该模块在每个时间索引 $t \\in \\{0,1,\\dots,T\\}$ 包含三个离散值生物状态变量：一个转录因子 $X_t$、一个下游基因产物 $Y_t$ 和一个翻译后修饰状态 $Z_t$。假设跨时间切片具有一阶马尔可夫性质且无切片内边缘，切片间父节点集由 $\\mathrm{Pa}(X_t)=\\{X_{t-1},Z_{t-1}\\}$、$\\mathrm{Pa}(Y_t)=\\{X_{t-1},Y_{t-1}\\}$ 和 $\\mathrm{Pa}(Z_t)=\\{Y_{t-1},Z_{t-1}\\}$ 给出。令 $p(X_0,Y_0,Z_0)$ 表示时间 $t=0$ 时的初始联合分布，对于 $t \\ge 1$，令 $p(X_t \\mid X_{t-1},Z_{t-1})$、$p(Y_t \\mid X_{t-1},Y_{t-1})$ 和 $p(Z_t \\mid Y_{t-1},Z_{t-1})$ 表示观测条件概率分布 (CPD)。\n\n要求您引入显式干预节点来表示时间局域化的实验扰动。为每个时间 $t \\in \\{1,\\dots,T\\}$ 引入一个二元干预节点 $I_t \\in \\{0,1\\}$，并带有一条有向边 $I_t \\to X_t$，其语义为：当 $I_t=0$ 时，对 $X_t$ 应用观测动态；当 $I_t=1$ 时，变量 $X_t$ 被外生地设置为一个固定值 $x^{\\star}$，且与其父节点无关。考虑在特定时间 $t_{\\mathrm{int}} \\in \\{1,\\dots,T\\}$ 应用的单个硬干预，其中 $I_{t_{\\mathrm{int}}}=1$ 且 $X_{t_{\\mathrm{int}}}$ 因此被强制设为 $x^{\\star}$，而对于所有 $t \\ne t_{\\mathrm{int}}$，我们有 $I_t=0$。令 $\\delta_{a,b}$ 表示克罗内克δ函数，当 $a=b$ 时等于 $1$，否则等于 $0$。\n\n仅从联合分布的链式法则、贝叶斯网络分解法则以及由上述双切片模板定义的一阶马尔可夫性质出发，推导由所述干预引起的全轨迹 $(X_0,\\dots,X_T,Y_0,\\dots,Y_T,Z_0,\\dots,Z_T)$ 上的干预联合分布的修正分解式。您的最终表达式应随时间分解，并清楚地反映出 $X_{t_{\\mathrm{int}}}$ 被设为 $x^{\\star}$，而所有其他CPD保持为观测形式。请用 $p(X_0,Y_0,Z_0)$、观测CPD和克罗内克δ函数 $\\delta_{\\,\\cdot,\\cdot}$ 将您的最终答案表示为单个闭式解析表达式。您的最终答案中不应包含等号。不需要数值近似或四舍五入，也不适用任何物理单位。", "solution": "我们从定义动态贝叶斯网络 (DBN) 的双切片时序贝叶斯网络 (2TBN) 的标准原理开始。两个关键的基础要素是：联合分布的链式法则和贝叶斯网络分解性质。结合一阶马尔可夫性质，这些要素意味着，在有限时间范围 $t \\in \\{0,1,\\dots,T\\}$ 内，联合观测分布可分解为\n$$\np(X_0,Y_0,Z_0) \\prod_{t=1}^{T} p(X_t \\mid X_{t-1},Z_{t-1}) \\, p(Y_t \\mid X_{t-1},Y_{t-1}) \\, p(Z_t \\mid Y_{t-1},Z_{t-1}) .\n$$\n这是因为一阶马尔可夫性质和指定的父节点集 $\\mathrm{Pa}(X_t)=\\{X_{t-1},Z_{t-1}\\}$、$\\mathrm{Pa}(Y_t)=\\{X_{t-1},Y_{t-1}\\}$ 及 $\\mathrm{Pa}(Z_t)=\\{Y_{t-1},Z_{t-1}\\}$ 决定了2TBN所编码的条件独立性，而贝叶斯网络分解将联合分布写为每个节点给定其父节点的条件概率的乘积。\n\n我们现在引入显式干预节点。对于每个时间 $t \\in \\{1,\\dots,T\\}$，我们添加一个二元干预变量 $I_t \\in \\{0,1\\}$ 以及一条有向边 $I_t \\to X_t$。其语义如下：当 $I_t=0$ 时，$X_t$ 遵循其观测 CPD $p(X_t \\mid X_{t-1},Z_{t-1})$；当 $I_t=1$ 时，从其观测父节点指向 $X_t$ 的入边被有效切断，$X_t$ 被确定性地设置为一个固定值 $x^{\\star}$，且与 $(X_{t-1},Z_{t-1})$ 无关。一种方便且标准的、将此编码到 $X_t$ 的单个条件概率表中的方法是定义\n$$\np(X_t \\mid X_{t-1},Z_{t-1},I_t) \\;=\\; (1-I_t)\\, p(X_t \\mid X_{t-1},Z_{t-1}) \\;+\\; I_t \\, \\delta_{X_t,\\,x^{\\star}} ,\n$$\n其中 $\\delta_{a,b}$ 是克罗内克δ函数，当 $a=b$ 时等于 $1$，否则等于 $0$。这为 $X_t$ 定义了一个有效的条件分布，因为对于所有 $I_t \\in \\{0,1\\}$，它都是两个有效条件分布的凸组合，并且在 $X_t$ 的支撑集上求和为 $1$。\n\n添加这些干预节点后，$(X_{0:T},Y_{0:T},Z_{0:T},I_{1:T})$ 上的增广贝叶斯网络可分解为\n$$\np(X_0,Y_0,Z_0)\\,\\prod_{t=1}^{T} p(I_t)\\, p(X_t \\mid X_{t-1},Z_{t-1},I_t)\\, p(Y_t \\mid X_{t-1},Y_{t-1})\\, p(Z_t \\mid Y_{t-1},Z_{t-1}) .\n$$\n此处 $p(I_t)$ 是干预节点的任意外生先验。在 $t_{\\mathrm{int}} \\in \\{1,\\dots,T\\}$ 处进行一次硬性的、时间局域化的干预，该干预设定 $I_{t_{\\mathrm{int}}}=1$ 且对于所有 $t \\ne t_{\\mathrm{int}}$ 设定 $I_t=0$。我们依据干预语义，固定这些变量，从而无需在生物状态变量 $(X_{0:T},Y_{0:T},Z_{0:T})$ 的干预分布中包含它们的概率。具体来说，干预联合分布 $p_{\\mathrm{do}}(X_{0:T},Y_{0:T},Z_{0:T})$ 是通过将观测因子 $p(X_{t_{\\mathrm{int}}} \\mid X_{t_{\\mathrm{int}}-1},Z_{t_{\\mathrm{int}}-1})$ 替换为退化因子 $\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}$ 得到的，而所有其他因子保持不变。这是贝叶斯网络分解的直接结果，其中 $X_{t_{\\mathrm{int}}}$ 的条件分布由 $I_{t_{\\mathrm{int}}}=1$ 修正，而所有 $t \\ne t_{\\mathrm{int}}$ 时的 $I_t=0$ 则在这些时间点恢复了 $X_t$ 的观测条件分布。\n\n因此，生物状态完整轨迹上的干预联合分布的修正分解式为\n$$\np(X_0,Y_0,Z_0)\\;\n\\left[\\prod_{\\substack{t=1\\\\ t \\ne t_{\\mathrm{int}}}}^{T} p(X_t \\mid X_{t-1},Z_{t-1})\\right]\\;\n\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}\\;\n\\left[\\prod_{t=1}^{T} p(Y_t \\mid X_{t-1},Y_{t-1})\\; p(Z_t \\mid Y_{t-1},Z_{t-1})\\right] .\n$$\n该表达式精确地反映了干预的效果：$X_{t_{\\mathrm{int}}}$ 的因子被 $\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}$ 替代，编码了 $X_{t_{\\mathrm{int}}}$ 被固定为 $x^{\\star}$ 的事实，而所有其他因子保持观测形式，并保留了2TBN所蕴含的原始时间分解结构。干预的下游影响通过那些对于 $t \\ge t_{\\mathrm{int}}+1$ 依赖于 $X_t$ 的、未改变的观测CPD向前传播。", "answer": "$$\\boxed{p(X_0,Y_0,Z_0)\\,\\left[\\prod_{\\substack{t=1\\\\ t \\ne t_{\\mathrm{int}}}}^{T} p(X_t \\mid X_{t-1},Z_{t-1})\\right]\\,\\delta_{X_{t_{\\mathrm{int}}},\\,x^{\\star}}\\,\\left[\\prod_{t=1}^{T} p(Y_t \\mid X_{t-1},Y_{t-1})\\,p(Z_t \\mid Y_{t-1},Z_{t-1})\\right]}$$", "id": "4336566"}]}