{"hands_on_practices": [{"introduction": "沃丁顿表观遗传学景观中的“山谷”代表了潜在基因调控网络的稳定状态。那么，一个核心问题是：系统如何从只有一个稳定状态（单一命运）转变为拥有两个稳定状态（两种命运）？本练习将探讨这一基本问题，通过对经典的基因开关模型进行线性稳定性分析，我们能精确推导出这种“分岔”发生的条件 [@problem_id:4398469]。掌握这项技能是理解细胞命运多样性如何从数学上产生的关键。", "problem": "考虑一个用于模拟 Waddington 表观遗传景观中细胞命运决定的对称双基因触发开关。设两种转录因子的浓度为 $x$ 和 $y$，并假设它们具有相同的希尔指数且相互抑制。其动力学由以下常微分方程 (ODEs; ordinary differential equations) 建模：\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1+y^{n}} \\;-\\; \\beta\\,x, \n\\qquad\n\\dot{y} \\;=\\; \\frac{\\alpha}{1+x^{n}} \\;-\\; \\beta\\,y,\n$$\n其中 $\\alpha>0$ 是最大合成速率，$\\beta>0$ 是线性降解速率，而 $n>0$ 是代表抑制协同性的希尔系数。在 Waddington 表观遗传景观建模框架内，稳定吸引子对应于谷（细胞命运），而不稳定不动点对应于脊。在对称触发开关中，当对称不动点失去稳定性并出现双阱景观时，便会产生具有两个不同谷的双稳态。\n\n从动力学系统的不动点和线性稳定性的基本定义出发，并且不假设任何快捷公式，确定对称不动点从稳定转变为不稳定的确切参数条件。将您的最终答案表示为临界合成速率 $\\alpha_{\\mathrm{c}}$ 关于 $\\beta$ 和 $n$ 的闭式解析表达式。您的答案必须是单个表达式。如果您的表达式涉及参数，请不要代入数值。无需四舍五入。", "solution": "该问题要求确定双基因触发开关模型中对称不动点稳定性转变的参数条件。该条件需要表示为临界合成速率 $\\alpha_{\\mathrm{c}}$，作为降解速率 $\\beta$ 和希尔系数 $n$ 的函数。推导必须从第一性原理出发。\n\n该系统的动力学由以下常微分方程组 (ODEs) 描述：\n$$\n\\dot{x} \\;=\\; \\frac{\\alpha}{1+y^{n}} \\;-\\; \\beta\\,x\n$$\n$$\n\\dot{y} \\;=\\; \\frac{\\alpha}{1+x^{n}} \\;-\\; \\beta\\,y\n$$\n其中 $x$ 和 $y$ 是两种转录因子的浓度。参数为最大合成速率 $\\alpha > 0$、降解速率 $\\beta > 0$ 和希尔系数 $n > 0$。\n\n首先，我们确定系统的对称不动点。不动点是满足 $\\dot{x}=0$ 和 $\\dot{y}=0$ 的状态 $(x^*, y^*)$。对称不动点的特征是 $x^* = y^*$。我们用 $z^*$ 表示这个共同的浓度值。将 $x = y = z^*$ 代入第一个 ODE 并将导数设为零，得到：\n$$\n0 \\;=\\; \\frac{\\alpha}{1+(z^*)^{n}} \\;-\\; \\beta\\,z^*\n$$\n该方程给出了不动点浓度 $z^*$ 与系统参数之间的关系：\n$$\n\\alpha \\;=\\; \\beta z^* (1 + (z^*)^n)\n$$\n\n接下来，我们进行线性稳定性分析，以确定该不动点在何种条件下是稳定的。稳定性由系统在不动点处求值的雅可比矩阵 $J$ 的特征值决定。雅可比矩阵定义为：\n$$\nJ(x,y) \\;=\\; \\begin{pmatrix} \\frac{\\partial \\dot{x}}{\\partial x} & \\frac{\\partial \\dot{x}}{\\partial y} \\\\ \\frac{\\partial \\dot{y}}{\\partial x} & \\frac{\\partial \\dot{y}}{\\partial y} \\end{pmatrix}\n$$\n所需的偏导数为：\n$$\n\\frac{\\partial \\dot{x}}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x} \\left( \\frac{\\alpha}{1+y^{n}} - \\beta x \\right) \\;=\\; -\\beta\n$$\n$$\n\\frac{\\partial \\dot{x}}{\\partial y} \\;=\\; \\frac{\\partial}{\\partial y} \\left( \\frac{\\alpha}{1+y^{n}} - \\beta x \\right) \\;=\\; -\\frac{\\alpha n y^{n-1}}{(1+y^n)^2}\n$$\n由于系统的对称性，我们有：\n$$\n\\frac{\\partial \\dot{y}}{\\partial y} \\;=\\; -\\beta\n$$\n$$\n\\frac{\\partial \\dot{y}}{\\partial x} \\;=\\; -\\frac{\\alpha n x^{n-1}}{(1+x^n)^2}\n$$\n在对称不动点 $(z^*, z^*)$ 处计算雅可比矩阵 $J$：\n$$\nJ^* \\;=\\; J(z^*, z^*) \\;=\\; \\begin{pmatrix} -\\beta & -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\\\ -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} & -\\beta \\end{pmatrix}\n$$\n让我们将非对角项表示为 $C$：\n$$\nC \\;=\\; -\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2}\n$$\n于是雅可比矩阵为 $J^* = \\begin{pmatrix} -\\beta & C \\\\ C & -\\beta \\end{pmatrix}$。该矩阵的特征值 $\\lambda$ 通过求解特征方程 $\\det(J^* - \\lambda I) = 0$ 得到：\n$$\n\\det \\begin{pmatrix} -\\beta - \\lambda & C \\\\ C & -\\beta - \\lambda \\end{pmatrix} \\;=\\; (-\\beta - \\lambda)^2 - C^2 \\;=\\; 0\n$$\n这得到 $(\\lambda + \\beta)^2 = C^2$，所以 $\\lambda + \\beta = \\pm C$。两个特征值为：\n$$\n\\lambda_1 \\;=\\; -\\beta + C \\quad \\text{和} \\quad \\lambda_2 \\;=\\; -\\beta - C\n$$\n如果一个不动点的所有特征值的实部都为负，则该不动点是稳定的。由于所有参数都是实数，因此特征值也是实数。由于 $\\alpha > 0$、$\\beta > 0$、$n > 0$ 和 $z^* > 0$，项 $C$ 严格为负。因此，$\\lambda_2 = -\\beta - C = -\\beta + |C|$ 且 $\\lambda_1 = -\\beta + C = -\\beta - |C|$。\n特征值 $\\lambda_1 = -\\beta - |C|$ 总是负的。因此，不动点的稳定性由 $\\lambda_2$ 的符号决定。\n如果 $\\lambda_2 < 0$，不动点是稳定的，这意味着 $-\\beta + |C| < 0$，或 $|C| < \\beta$。\n如果 $\\lambda_2 > 0$，不动点变得不稳定，这意味着 $|C| > \\beta$。\n从稳定不动点到不稳定不动点的转变，在该对称系统中对应于叉式分岔，恰好在 $\\lambda_2 = 0$ 时发生。此转变的条件是：\n$$\n|C| \\;=\\; \\beta\n$$\n代入 $C$ 的表达式：\n$$\n\\frac{\\alpha n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\;=\\; \\beta\n$$\n这个方程定义了分岔边界。为了仅用参数来表示这个条件，我们使用不动点方程 $\\alpha = \\beta z^* (1 + (z^*)^n)$ 来消去 $z^*$。将此代入分岔条件中：\n$$\n\\frac{[\\beta z^* (1+(z^*)^n)] n (z^*)^{n-1}}{(1+(z^*)^n)^2} \\;=\\; \\beta\n$$\n对于 $\\beta > 0$，我们可以从等式两边消去 $\\beta$：\n$$\n\\frac{n (z^*)^n (1+(z^*)^n)}{(1+(z^*)^n)^2} \\;=\\; 1\n$$\n$$\n\\frac{n(z^*)^n}{1+(z^*)^n} \\;=\\; 1\n$$\n求解 $(z^*)^n$：\n$$\nn(z^*)^n \\;=\\; 1 + (z^*)^n \\quad \\implies \\quad (n-1)(z^*)^n \\;=\\; 1 \\quad \\implies \\quad (z^*)^n \\;=\\; \\frac{1}{n-1}\n$$\n该方程表明，只有当 $n-1 > 0$，即 $n>1$ 时，分岔点处才存在 $z^*$ 的实数正解。这是协同性实现双稳态的众所周知的要求。\n分岔点处的浓度为 $z^* = \\left(\\frac{1}{n-1}\\right)^{1/n}$。\n\n临界合成速率 $\\alpha_c$ 是该分岔点处的 $\\alpha$ 值。我们再次使用不动点关系式：\n$$\n\\alpha_c \\;=\\; \\beta z^* (1 + (z^*)^n)\n$$\n在分岔点代入 $z^*$ 和 $(z^*)^n$ 的表达式：\n$$\n\\alpha_c \\;=\\; \\beta \\left(\\frac{1}{n-1}\\right)^{1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n简化括号中的第二项：\n$$\n1 + \\frac{1}{n-1} \\;=\\; \\frac{n-1+1}{n-1} \\;=\\; \\frac{n}{n-1}\n$$\n将此代回 $\\alpha_c$ 的表达式：\n$$\n\\alpha_c \\;=\\; \\beta \\left(\\frac{n}{n-1}\\right) \\left(\\frac{1}{n-1}\\right)^{1/n}\n$$\n最后，我们合并包含 $n-1$ 的项，以获得闭式表达式：\n$$\n\\alpha_c \\;=\\; \\frac{\\beta n}{(n-1)^{1} (n-1)^{1/n}} \\;=\\; \\frac{\\beta n}{(n-1)^{1+1/n}} \\;=\\; \\frac{\\beta n}{(n-1)^{(n+1)/n}}\n$$\n这就是对称单稳态转变为双稳态时的临界合成速率的解析表达式。", "answer": "$$\n\\boxed{\\frac{\\beta n}{(n-1)^{(n+1)/n}}}\n$$", "id": "4398469"}, {"introduction": "一旦细胞进入一个“山谷”（即一个稳定的命运），它对外界扰动的抵抗力有多强？Waddington将这一概念称为“渠道化”(canalization)。本练习提供了一种定量衡量渠道化强度的方法 [@problem_id:4398483]。通过在稳定不动点附近对系统动力学进行线性化，并分析雅可比矩阵的特征值，我们可以定义一个“渠道化强度”，它量化了系统在受到微小扰动后恢复到其吸引子的速度。", "problem": "考虑一个双基因的基因调控网络 (GRN)，该网络在一个 Waddington 表观遗传景观背景下，通过一个代表相互抑制的确定性常微分方程 (ODE) 系统进行建模。令状态向量为 $x = (x_{1}, x_{2})^{\\top}$，其中 $x_{i}$ 表示基因 $i$ 的信使RNA (mRNA) 的拷贝数。其动力学由以下方程给出：\n$$\n\\frac{dx_{1}}{dt} = f_{1}(x_{1}, x_{2}) = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1}, \\quad\n\\frac{dx_{2}}{dt} = f_{2}(x_{1}, x_{2}) = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2}.\n$$\n假设以下经验校准的参数，这些参数与 Waddington 表观遗传景观中的一个祖细胞吸引子一致：$\\alpha_{1} = \\alpha_{2} = 6.25$ (分子$\\cdot$小时$^{-1}$)，$\\delta_{1} = \\delta_{2} = 1$ (小时$^{-1}$)，$K_{12} = K_{21} = 10$ (分子)，$n_{12} = n_{21} = 2$，以及一个满足 $f(x^{\\ast}) = 0$ 的测量不动点 $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast}) = (5, 5)$ (分子)。\n\n从不动点的定义和函数 $f$ 在 $x^{\\ast}$ 附近的多元泰勒展开出发，将动力学在 $x^{\\ast}$ 附近线性化，以获得在 $x^{\\ast}$ 处求值的雅可比矩阵。然后，计算该雅可比矩阵的特征值，并用它们来确定不动点在小扰动下的局部稳定性。将渠道化强度 $C$ 定义为最小的恢复速率，即\n$$\nC = \\min_{i:\\,\\Re(\\lambda_{i}) < 0} \\big(-\\Re(\\lambda_{i})\\big),\n$$\n其中 $\\lambda_{i}$ 是雅可比矩阵在 $x^{\\ast}$ 处的特征值，$\\Re(\\cdot)$ 表示实部。将 $C$ 解释为量化 Waddington 表观遗传景观中吸引子的最弱局部拉回力。将 $C$ 的最终答案以 小时$^{-1}$ 为单位表示，并将结果四舍五入到四位有效数字。", "solution": "该问题要求计算一个双基因调控网络的给定不动点的渠道化强度 $C$。该过程包括围绕指定不动点线性化系统动力学，计算相应雅可比矩阵的特征值，然后应用给定的 $C$ 的定义。\n\n该常微分方程 (ODE) 系统由以下公式给出：\n$$\n\\frac{dx_{1}}{dt} = f_{1}(x_{1}, x_{2}) = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1}\n$$\n$$\n\\frac{dx_{2}}{dt} = f_{2}(x_{1}, x_{2}) = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2}\n$$\n所提供的参数为：$\\alpha_{1} = \\alpha_{2} = 6.25$，$\\delta_{1} = \\delta_{2} = 1$， $K_{12} = K_{21} = 10$，以及 $n_{12} = n_{21} = 2$。不动点为 $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast})^{\\top} = (5, 5)^{\\top}$。\n\n首先，我们通过计算雅可比矩阵 $J(x^{\\ast})$ 来将系统在不动点 $x^{\\ast}$ 附近线性化。雅可比矩阵 $J$ 是向量函数 $f = (f_1, f_2)^{\\top}$ 的所有一阶偏导数组成的矩阵：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f_{1}}{\\partial x_{1}} & \\frac{\\partial f_{1}}{\\partial x_{2}} \\\\ \\frac{\\partial f_{2}}{\\partial x_{1}} & \\frac{\\partial f_{2}}{\\partial x_{2}} \\end{pmatrix}\n$$\n我们计算雅可比矩阵的每个元素。\n\n对于对角线元素：\n$$\n\\frac{\\partial f_{1}}{\\partial x_{1}} = \\frac{\\partial}{\\partial x_{1}} \\left( \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}} - \\delta_{1} x_{1} \\right) = -\\delta_{1}\n$$\n$$\n\\frac{\\partial f_{2}}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}} \\left( \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}} - \\delta_{2} x_{2} \\right) = -\\delta_{2}\n$$\n\n对于非对角线元素：\n$$\n\\frac{\\partial f_{1}}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}} \\left( \\alpha_{1} \\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{-1} - \\delta_{1} x_{1} \\right) = -\\alpha_{1} \\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{-2} \\cdot \\left( \\frac{n_{21} x_{2}^{n_{21}-1}}{K_{21}^{n_{21}}} \\right)\n$$\n$$\n\\frac{\\partial f_{1}}{\\partial x_{2}} = - \\frac{\\alpha_{1} n_{21}}{K_{21}} \\frac{\\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}-1}}{\\left(1 + \\left(\\frac{x_{2}}{K_{21}}\\right)^{n_{21}}\\right)^{2}}\n$$\n根据方程的对称性，另一个非对角线元素是：\n$$\n\\frac{\\partial f_{2}}{\\partial x_{1}} = - \\frac{\\alpha_{2} n_{12}}{K_{12}} \\frac{\\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}-1}}{\\left(1 + \\left(\\frac{x_{1}}{K_{12}}\\right)^{n_{12}}\\right)^{2}}\n$$\n现在，我们使用给定的参数值来计算在不动点 $x^{\\ast}=(5, 5)$ 处的雅可比矩阵：\n$J_{11} = -\\delta_{1} = -1$\n$J_{22} = -\\delta_{2} = -1$\n\n对于 $J_{12}$：\n$$\nJ_{12}(x^{\\ast}) = - \\frac{6.25 \\times 2}{10} \\frac{\\left(\\frac{5}{10}\\right)^{2-1}}{\\left(1 + \\left(\\frac{5}{10}\\right)^{2}\\right)^{2}} = -1.25 \\frac{0.5}{(1 + 0.5^2)^2} = -1.25 \\frac{0.5}{(1 + 0.25)^2} = -1.25 \\frac{0.5}{1.25^2} = - \\frac{0.5}{1.25} = -0.4\n$$\n由于问题的参数和不动点具有对称性，$J_{21}(x^{\\ast}) = J_{12}(x^{\\ast}) = -0.4$。\n\n在不动点处求值的雅可比矩阵为：\n$$\nJ(x^{\\ast}) = \\begin{pmatrix} -1 & -0.4 \\\\ -0.4 & -1 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(J(x^{\\ast}) - \\lambda I) = 0$ 来找到 $J(x^{\\ast})$ 的特征值 $\\lambda$，其中 $I$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} -1-\\lambda & -0.4 \\\\ -0.4 & -1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-1-\\lambda)(-1-\\lambda) - (-0.4)(-0.4) = 0\n$$\n$$\n(\\lambda + 1)^{2} - 0.16 = 0\n$$\n$$\n(\\lambda + 1)^{2} = 0.16\n$$\n两边取平方根：\n$$\n\\lambda + 1 = \\pm\\sqrt{0.16} = \\pm 0.4\n$$\n这给出了两个实数特征值：\n$$\n\\lambda_{1} = -1 + 0.4 = -0.6\n$$\n$$\n\\lambda_{2} = -1 - 0.4 = -1.4\n$$\n由于两个特征值都是实数且为负（$\\Re(\\lambda_{1}) = -0.6 < 0$ 且 $\\Re(\\lambda_{2}) = -1.4 < 0$），该不动点是一个稳定节点。这与其在 Waddington 景观中作为祖细胞吸引子的解释是一致的。\n\n渠道化强度 $C$ 被定义为最小的恢复速率：\n$$\nC = \\min_{i:\\,\\Re(\\lambda_{i}) < 0} \\big(-\\Re(\\lambda_{i})\\big)\n$$\n特征值的实部分别为 $\\Re(\\lambda_{1}) = -0.6$ 和 $\\Re(\\lambda_{2}) = -1.4$。恢复速率是这些实部的负值：\n$$\n-\\Re(\\lambda_{1}) = 0.6\n$$\n$$\n-\\Re(\\lambda_{2}) = 1.4\n$$\n渠道化强度 $C$ 是这些值中的最小值：\n$$\nC = \\min(0.6, 1.4) = 0.6\n$$\n雅可比矩阵元素的单位是 (浓度变化率) / (浓度)，即 (分子$\\cdot$小时$^{-1}$)/分子 = 小时$^{-1}$。因此，特征值和 $C$ 的单位是 小时$^{-1}$。\n\n问题要求最终答案四舍五入到四位有效数字。\n$$\nC = 0.6000 \\, \\text{hour}^{-1}\n$$\n这个值代表了最弱的局部恢复速率，它刻画了吸引盆在其最不稳定方向上的“浅度”。", "answer": "$$\\boxed{0.6000}$$", "id": "4398483"}, {"introduction": "细胞的命运并非一成不变；它们可以被诱导从一个山谷过渡到另一个，例如在干细胞分化或细胞重编程中。这些转变本质上是随机的，常由基因表达的“噪声”驱动。本练习将从静态分析转向动态模拟 [@problem_id:4398501]。我们将模拟一个细胞在预设景观上的旅程，并量化转变速度与抵达目标命运的保真度（准确性）之间的复杂权衡，这是再生医学领域的一个核心挑战。", "problem": "考虑一个最小化的双基因 Waddington 表观遗传学景观，该景观被建模为一个在合成势上的过阻尼随机梯度流，该势支持三个细胞命运盆：一个起始命运、一个期望的目标命运和一个脱靶命运。状态是一个二维向量 $\\mathbf{z}(t) = (x(t), y(t))$。其动力学由 Itô 诠释下的朗之万方程控制：\n$$\n\\frac{d\\mathbf{z}}{dt} = -\\nabla U(\\mathbf{z}) + \\sqrt{2\\varepsilon}\\,\\boldsymbol{\\xi}(t),\n$$\n其中 $U(\\mathbf{z})$ 是有效景观势，$\\varepsilon$ 是标量噪声强度，$\\boldsymbol{\\xi}(t)$ 是分量独立且单位方差的高斯白噪声。势 $U(\\mathbf{z})$ 由代表起始、目标和脱靶命运的三个高斯势阱之和，外加一个弱二次约束项构成：\n$$\nU(\\mathbf{z}) = k \\|\\mathbf{z}\\|^2 - \\sum_{i \\in \\{S,B,C\\}} A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right),\n$$\n势阱中心分别为 $\\mathbf{z}_S = (-1.2, 0.0)$、$\\mathbf{z}_B = (0.9, 0.9)$、$\\mathbf{z}_C = (0.9, -0.9)$，深度分别为 $A_S = 3.0$、$A_B = 6.0$、$A_C = 5.2$，高斯宽度为 $\\sigma = 0.3$，约束系数为 $k = 0.05$。初始条件为 $\\mathbf{z}(0) = \\mathbf{z}_S$，时间是无量纲的。\n\n您将使用欧拉-丸山格式，在步长为 $\\Delta t = 0.01$ 的固定时间网格上，对该随机微分方程进行数值模拟，直至最大时间 $T_{\\max} = 50.0$。设命中半径为 $r_{\\mathrm{hit}} = 0.25$。如果一条轨迹首次进入围绕目标 $\\mathbf{z}_B$ 或脱靶目标 $\\mathbf{z}_C$ 的半径为 $r_{\\mathrm{hit}}$ 的闭球内，则称该轨迹已到达一个命运。对于每个噪声强度 $\\varepsilon$ 和固定数量的独立轨迹 $N = 150$，定义以下量化指标：\n\n- 速度度量 $S(\\varepsilon)$：在时间 $T_{\\max}$ 内命中任一命运的轨迹中，其首次命中时间的中位数。如果在 $T_{\\max}$ 内没有轨迹命中任一命运，则设 $S(\\varepsilon) = T_{\\max}$。\n- 保真度度量 $F(\\varepsilon)$：在所有命中一个命运的轨迹中，命中目标命运 $\\mathbf{z}_B$ 的轨迹所占的比例，表示为 $0$ 到 $1$ 之间的小数。如果在 $T_{\\max}$ 内没有轨迹命中任一命运，则设 $F(\\varepsilon) = 0$。\n\n对噪声强度参数使用以下测试集：\n- $\\varepsilon = 0.0$ (确定性边界),\n- $\\varepsilon = 0.02$ (低噪声),\n- $\\varepsilon = 0.06$ (中等噪声),\n- $\\varepsilon = 0.15$ (高噪声)。\n\n所有模拟都必须使用固定的伪随机数种子以确保可复现性。您的程序应实现上述系统的欧拉-丸山离散化，并为测试集中的每个 $\\varepsilon$ 计算 $(S(\\varepsilon), F(\\varepsilon))$。时间是无量纲的，所有量都必须作为无量纲量处理。您的程序应生成单行输出，其中包含结果，格式为一个包含四个数对的逗号分隔列表，每个数对本身是按 $[S(\\varepsilon),F(\\varepsilon)]$ 顺序排列的两个浮点数的逗号分隔列表，并用方括号括起来，例如：\n$$\n\\text{[}[S(\\varepsilon_1),F(\\varepsilon_1)],[S(\\varepsilon_2),F(\\varepsilon_2)],[S(\\varepsilon_3),F(\\varepsilon_3)],[S(\\varepsilon_4),F(\\varepsilon_4)]\\text{]}.\n$$\n每个测试用例的最终输出必须是浮点数，且程序不得打印任何其他文本。", "solution": "该问题要求对一个模拟 Waddington 景观中细胞命运决定的二维随机微分方程（SDE）进行数值模拟。解决方案首先推导运动方程的显式形式，然后实现一个合适的数值积分方案，最后从模拟输出中计算指定的统计度量。\n\n系统的状态由向量 $\\mathbf{z}(t) = (x(t), y(t))$ 给出，其动力学由 Itô 诠释下的过阻尼朗之万方程控制：\n$$\nd\\mathbf{z} = -\\nabla U(\\mathbf{z}) dt + \\sqrt{2\\varepsilon}\\,d\\mathbf{W}(t)\n$$\n其中 $\\mathbf{z}$ 是状态向量，$U(\\mathbf{z})$ 是势能景观，$\\varepsilon$ 是噪声强度，$d\\mathbf{W}(t)$ 表示向量值维纳过程的增量，其分量是独立的高斯白噪声。\n\n势 $U(\\mathbf{z})$ 定义为：\n$$\nU(\\mathbf{z}) = k \\|\\mathbf{z}\\|^2 - \\sum_{i \\in \\{S,B,C\\}} A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right)\n$$\n第一步是计算势的梯度 $\\nabla U(\\mathbf{z})$，它定义了确定性力 $\\mathbf{F}(\\mathbf{z}) = -\\nabla U(\\mathbf{z})$。使用标准向量微积分，可求得梯度为：\n$$\n\\nabla U(\\mathbf{z}) = \\nabla \\left(k \\|\\mathbf{z}\\|^2\\right) - \\sum_{i \\in \\{S,B,C\\}} \\nabla \\left( A_i \\exp\\!\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right) \\right)\n$$\n$$\n\\nabla U(\\mathbf{z}) = 2k\\mathbf{z} + \\frac{1}{\\sigma^2} \\sum_{i \\in \\{S,B,C\\}} A_i (\\mathbf{z} - \\mathbf{z}_i) \\exp\\left(-\\frac{\\|\\mathbf{z} - \\mathbf{z}_i\\|^2}{2\\sigma^2}\\right)\n$$\n该 SDE 使用欧拉-丸山方法进行数值求解，这是随机积分器的标准格式。从时间步 $n$ 的状态向量 $\\mathbf{z}_n$ 到时间步 $n+1$ 的状态向量 $\\mathbf{z}_{n+1}$ 的离散化更新规则由下式给出：\n$$\n\\mathbf{z}_{n+1} = \\mathbf{z}_n - \\nabla U(\\mathbf{z}_n)\\Delta t + \\sqrt{2\\varepsilon\\Delta t}\\,\\boldsymbol{\\eta}_n\n$$\n此处，$\\Delta t$ 是时间步长，$\\boldsymbol{\\eta}_n$ 是一个二维随机向量，其分量是从标准正态分布 $N(0,1)$ 中抽取的独立随机变量。该方程构成了模拟的核心。\n\n整体模拟算法结构如下。对于测试集 $\\{0.0, 0.02, 0.06, 0.15\\}$ 中的每个指定噪声水平 $\\varepsilon$：\n1. 初始化两个空列表，一个用于存储成功轨迹的首次命中时间，另一个用于存储命中了哪个命运（'B' 或 'C'）。\n2. 对于 $N=150$ 条独立轨迹中的每一条：\n    a. 设置初始条件 $\\mathbf{z}(0) = \\mathbf{z}_S = (-1.2, 0.0)$。\n    b. 从 $t=0$ 到 $T_{\\max}=50.0$ 以 $\\Delta t=0.01$ 的步长进行时间迭代。\n    c. 在每一步中，使用上面推导的欧拉-丸山规则更新位置向量 $\\mathbf{z}$。使用固定的伪随机数种子以确保随机数序列 $\\boldsymbol{\\eta}_n$ 是可复现的。\n    d. 每次更新后，检查新位置 $\\mathbf{z}$ 是否已进入目标命运 $\\mathbf{z}_B = (0.9, 0.9)$ 或脱靶命运 $\\mathbf{z}_C = (0.9, -0.9)$ 的命中区域。如果 $\\|\\mathbf{z} - \\mathbf{z}_B\\| \\le r_{\\mathrm{hit}}$ 或 $\\|\\mathbf{z} - \\mathbf{z}_C\\| \\le r_{\\mathrm{hit}}$，则记录一次命中，其中命中半径为 $r_{\\mathrm{hit}} = 0.25$。\n    e. 如果发生命中，则将当前时间记录为首次命中时间，记下相应的命运，并终止该轨迹的模拟。\n    f. 如果轨迹在时间 $t$ 到达 $T_{\\max}$ 前未命中任何命运，则不将其计入命中统计中。\n\n3. 在给定 $\\varepsilon$ 的所有 $N$ 条轨迹都模拟完毕后，计算指定的度量：\n    - **速度 $S(\\varepsilon)$**：如果有任何轨迹命中了一个命运，$S(\\varepsilon)$ 是收集到的命中时间的中位数。如果没有轨迹命中，则将 $S(\\varepsilon)$ 设置为 $T_{\\max}$，即 $50.0$。\n    - **保真度 $F(\\varepsilon)$**：如果有任何轨迹命中了一个命运，$F(\\varepsilon)$ 是命中目标命运 $\\mathbf{z}_B$ 的轨迹数与命中任一命运的总轨迹数之比。如果没有轨迹命中，则将 $F(\\varepsilon)$ 设置为 $0.0$。\n\n对测试集中的每个 $\\varepsilon$ 值重复整个过程。该实现使用 `numpy` 库进行高效的向量化操作。最终结果是每个 $\\varepsilon$ 对应的一对 $[S(\\varepsilon), F(\\varepsilon)]$ 的列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates cell fate transitions on a Waddington landscape and computes\n    speed and fidelity metrics for different noise levels.\n    \"\"\"\n    # Set a fixed seed for reproducibility as required by the problem\n    np.random.seed(42)\n\n    # --- Problem Parameters ---\n    # Potential parameters\n    k = 0.05\n    sigma = 0.3\n    sigma_sq = sigma**2\n    z_S = np.array([-1.2, 0.0])\n    z_B = np.array([0.9, 0.9])\n    z_C = np.array([0.9, -0.9])\n    A_S = 3.0\n    A_B = 6.0\n    A_C = 5.2\n\n    # Simulation parameters\n    dt = 0.01\n    T_max = 50.0\n    N = 150  # Number of trajectories\n\n    # Hitting criteria\n    r_hit = 0.25\n    r_hit_sq = r_hit**2\n\n    # Test cases for the noise strength parameter\n    test_cases = [0.0, 0.02, 0.06, 0.15]\n\n    def grad_U(z):\n        \"\"\"\n        Computes the gradient of the potential U at a given position z.\n        The parameters of the potential are taken from the enclosing scope.\n        \"\"\"\n        grad = 2 * k * z\n        \n        # Contribution from well S\n        diff_S = z - z_S\n        sq_dist_S = np.dot(diff_S, diff_S)\n        exp_S = np.exp(-sq_dist_S / (2 * sigma_sq))\n        grad += (A_S / sigma_sq) * exp_S * diff_S\n        \n        # Contribution from well B\n        diff_B = z - z_B\n        sq_dist_B = np.dot(diff_B, diff_B)\n        exp_B = np.exp(-sq_dist_B / (2 * sigma_sq))\n        grad += (A_B / sigma_sq) * exp_B * diff_B\n\n        # Contribution from well C\n        diff_C = z - z_C\n        sq_dist_C = np.dot(diff_C, diff_C)\n        exp_C = np.exp(-sq_dist_C / (2 * sigma_sq))\n        grad += (A_C / sigma_sq) * exp_C * diff_C\n        \n        return grad\n\n    results = []\n    # Loop over each noise strength\n    for epsilon in test_cases:\n        hitting_times = []\n        hit_fates = []\n        \n        noise_magnitude = np.sqrt(2 * epsilon * dt)\n        \n        # Run N independent trajectories\n        for _ in range(N):\n            z = z_S.copy()\n            num_steps = int(T_max / dt)\n            \n            for i in range(num_steps):\n                # Calculate deterministic force component\n                force_dt = -grad_U(z) * dt\n                \n                # Calculate stochastic displacement component\n                if epsilon > 0:\n                    random_displacement = noise_magnitude * np.random.randn(2)\n                else:\n                    random_displacement = np.array([0.0, 0.0])\n                \n                # Update position using Euler-Maruyama step\n                z += force_dt + random_displacement\n                \n                # Check for hitting a fate\n                if np.sum((z - z_B)**2) = r_hit_sq:\n                    hit_time = (i + 1) * dt\n                    hitting_times.append(hit_time)\n                    hit_fates.append('B')\n                    break  # End this trajectory\n                \n                if np.sum((z - z_C)**2) = r_hit_sq:\n                    hit_time = (i + 1) * dt\n                    hitting_times.append(hit_time)\n                    hit_fates.append('C')\n                    break  # End this trajectory\n        \n        # --- Calculate metrics for this epsilon ---\n        num_hits = len(hitting_times)\n        \n        if num_hits == 0:\n            speed_metric = T_max\n            fidelity_metric = 0.0\n        else:\n            # Speed metric: median of hitting times for successful trajectories\n            speed_metric = np.median(hitting_times)\n            \n            # Fidelity metric: fraction of successful hits that reached target B\n            num_hits_B = hit_fates.count('B')\n            fidelity_metric = num_hits_B / num_hits\n\n        results.append([float(speed_metric), float(fidelity_metric)])\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4398501"}]}