{"hands_on_practices": [{"introduction": "突变与自然选择之间的平衡是进化理论的基石，它决定了种群中有害等位基因的长期普遍性。本练习将通过一个简洁而强大的微分方程模型来探讨这一基本平衡。通过推导有害等位基因的平衡频率并分析其近似条件[@problem_id:4339039]，您将锻炼数学建模和渐近分析的技能，这对于理解生物系统的动态行为至关重要。", "problem": "在系统生物医学的背景下，考虑一个大型无性细胞群体，其中一个有害等位基因以单位时间正向突变率 $\\mu > 0$ 从野生型等位基因产生，并且携带该有害等位基因的细胞相对于野生型细胞，由于清除率增加或增殖率降低，经历一个恒定的人均马尔萨斯适应性劣势 $s > 0$。假设反向突变可以忽略不计，并且在所关注的时间尺度上可以忽略人口随机性，因此等位基因频率的动态变化可以由一个连续时间常微分方程（ODE）很好地近似，该方程表达了突变流入和选择移除之间的平衡。令 $q(t)$ 表示在时间 $t$ 时有害等位基因的频率，其中 $q(0) \\in [0,1]$，并假设其动态变化遵循\n$$\n\\dot{q}(t) \\equiv \\frac{dq}{dt} = \\mu \\big(1 - q(t)\\big) - s\\, q(t).\n$$\n从这个常微分方程及其项作为遗传状态之间通量的解释出发，推导出平衡频率 $q^{\\ast}$ 并确定其局部稳定性。使用基于尺度分离的渐近推理，确定领头阶近似 $q^{\\ast} \\approx \\mu/s$ 成立的参数范围，并通过展开到第一个非平凡阶来证明该近似的合理性。以 $\\mu$ 和 $s$ 的精确闭式表达式给出 $q^{\\ast}$ 作为最终答案。不需要进行数值计算。", "solution": "用户提供了一个问题陈述，描述了大型无性细胞群体中有害等位基因的动态变化。任务是验证此问题，如果有效，则通过推导平衡等位基因频率、分析其稳定性以及使用渐近分析证明一个常用近似的合理性来解决它。\n\n### 第1步：提取已知条件\n\n-   **系统**：一个大型无性细胞群体。\n-   **等位基因**：野生型和有害等位基因。\n-   **正向突变率**：$\\mu > 0$（每单位时间）。\n-   **选择劣势**：$s > 0$（恒定的人均马尔萨斯适应性劣势）。\n-   **变量**：$q(t)$ 是在时间 $t$ 时有害等位基因的频率。\n-   **初始条件**：$q(0) \\in [0, 1]$。\n-   **假设**：反向突变可忽略；人口随机性被忽略。\n-   **控制方程**：动态变化由以下常微分方程（ODE）描述：\n    $$\n    \\dot{q}(t) \\equiv \\frac{dq}{dt} = \\mu \\big(1 - q(t)\\big) - s\\, q(t)\n    $$\n-   **任务**：\n    1.  推导平衡频率 $q^{\\ast}$。\n    2.  确定 $q^{\\ast}$ 的局部稳定性。\n    3.  确定近似 $q^{\\ast} \\approx \\mu/s$ 在何种参数范围内有效。\n    4.  通过展开证明此近似的合理性。\n    5.  提供 $q^{\\ast}$ 的精确闭式表达式作为最终答案。\n\n### 第2步：使用已知条件进行验证\n\n1.  **科学依据**：该问题具有科学依据。该常微分方程代表了一个标准的、确定性的突变-选择平衡模型，这是群体遗传学和演化生物学中的一个基本概念。项 $\\mu(1-q)$ 正确地模拟了来自野生型群体（频率为 $1-q$）的新有害等位基因的流入，而项 $-sq$ 则正确地模拟了由于选择劣势而导致的有害等位基因的移除。大群体规模（证明确定性常微分方程的合理性）、常数参数 $\\mu$ 和 $s$ 以及可忽略的反向突变等假设是使问题在分析上易于处理的标准简化。\n2.  **良定性**：该问题是良定的。控制方程是一个具有常系数的一阶线性常微分方程，这保证了对于任何给定的初始条件 $q(0)$，解的存在性和唯一性。任务具体且在数学上定义明确，能够得出一个唯一的分析结果。\n3.  **客观性**：问题以精确、客观和定量的语言陈述。它不含任何主观或基于意见的主张。\n4.  **完整性与一致性**：该问题是自洽的。所有必需的参数（$\\mu$，$s$）和控制方程都已提供。约束条件 $\\mu > 0$ 和 $s > 0$ 具有物理意义且在数学上是一致的。频率 $q$ 的状态空间是区间 $[0, 1]$。动态变化尊重这个空间：如果 $q(t)=0$，则 $\\dot{q}(t) = \\mu > 0$；如果 $q(t)=1$，则 $\\dot{q}(t) = -s  0$，这意味着从 $[0, 1]$ 内开始的轨迹将保持在 $[0, 1]$ 内。不存在矛盾。\n\n### 第3步：结论与行动\n\n该问题是**有效的**，因为它具有科学合理性、良定性且自洽。我现在将开始求解。\n\n### 求解推导\n\n该问题要求我们分析由以下常微分方程控制的等位基因频率 $q(t)$ 的动态变化：\n$$\n\\frac{dq}{dt} = \\mu(1 - q) - sq\n$$\n\n**1. 平衡频率 ($q^{\\ast}$)**\n\n平衡频率，记作 $q^{\\ast}$，是频率不随时间变化的 $q$ 值。这对应于 $\\frac{dq}{dt} = 0$ 的状态。将常微分方程的右侧设为零，我们得到：\n$$\n\\mu(1 - q^{\\ast}) - sq^{\\ast} = 0\n$$\n我们求解这个关于 $q^{\\ast}$ 的线性方程：\n$$\n\\mu - \\mu q^{\\ast} - sq^{\\ast} = 0\n$$\n$$\n\\mu = \\mu q^{\\ast} + sq^{\\ast}\n$$\n$$\n\\mu = (\\mu + s)q^{\\ast}\n$$\n分离出 $q^{\\ast}$ 得到平衡频率的精确表达式：\n$$\nq^{\\ast} = \\frac{\\mu}{\\mu + s}\n$$\n由于 $\\mu  0$ 且 $s  0$，显然有 $0  q^{\\ast}  1$，这是一个物理上现实的频率。\n\n**2. 局部稳定性分析**\n\n为了确定平衡点 $q^{\\ast}$ 的局部稳定性，我们考察系统在该点附近的行为。令 $f(q) = \\mu(1 - q) - sq$。稳定性由 $f(q)$ 关于 $q$ 的导数在 $q=q^{\\ast}$ 处的值的符号决定。\n$$\nf'(q) = \\frac{d}{dq} \\left( \\mu - \\mu q - sq \\right) = -\\mu - s\n$$\n导数为 $f'(q) = -(\\mu + s)$。因为 $\\mu  0$ 且 $s  0$，所以和 $\\mu + s$ 严格为正。因此，对于所有 $q$ 值，导数都严格为负：\n$$\nf'(q^{\\ast}) = -(\\mu + s)  0\n$$\n平衡点处导数为负号表明该平衡是局部稳定的。如果频率 $q$ 从 $q^{\\ast}$ 发生微小扰动，它将返回到 $q^{\\ast}$。实际上，由于 $f'(q)$ 是一个负常数，因此对于任何初始条件 $q(0) \\in [0, 1]$，这都是一个全局稳定平衡。\n\n**3. 近似的渐近范围**\n\n问题要求确定近似 $q^{\\ast} \\approx \\mu/s$ 在何种参数范围内有效。我们从精确表达式开始：\n$$\nq^{\\ast} = \\frac{\\mu}{\\mu + s}\n$$\n为了得到 $\\mu/s$ 的形式，我们可以从分母中提出因子 $s$：\n$$\nq^{\\ast} = \\frac{\\mu}{s\\left(1 + \\frac{\\mu}{s}\\right)}\n$$\n要使近似 $q^{\\ast} \\approx \\frac{\\mu}{s}$ 成立，分母 $s\\left(1 + \\frac{\\mu}{s}\\right)$ 必须接近 $s$。当项 $\\frac{\\mu}{s}$ 远小于1时，此条件得到满足。\n$$\n\\frac{\\mu}{s} \\ll 1 \\implies \\mu \\ll s\n$$\n因此，该近似有效的参数范围是当突变率 $\\mu$ 远小于选择系数 $s$ 时。这在生物学中是一个非常常见的情景，其中突变率通常非常低（例如，每代 $10^{-9}$ 到 $10^{-5}$），而选择系数可能大得多。\n\n**4. 通过展开进行证明**\n\n为了更正式地证明这个近似，我们在 $\\mu/s \\to 0$ 的极限下对精确解 $q^{\\ast}$ 进行渐近展开。令小的无量纲参数为 $\\epsilon = \\mu/s$。我们可以将 $q^{\\ast}$ 重写为：\n$$\nq^{\\ast} = \\frac{\\mu}{s(1 + \\mu/s)} = \\left(\\frac{\\mu}{s}\\right) \\frac{1}{1 + \\epsilon} = \\epsilon (1 + \\epsilon)^{-1}\n$$\n使用对于 $|\\epsilon|  1$ 收敛的 $(1 + \\epsilon)^{-1}$ 的几何级数展开：\n$$\n(1 + \\epsilon)^{-1} = 1 - \\epsilon + \\epsilon^2 - \\epsilon^3 + \\dots\n$$\n将此级数代回 $q^{\\ast}$ 的表达式中：\n$$\nq^{\\ast} = \\epsilon \\left( 1 - \\epsilon + \\epsilon^2 - \\dots \\right) = \\epsilon - \\epsilon^2 + \\epsilon^3 - \\dots\n$$\n现在，代回 $\\epsilon = \\mu/s$：\n$$\nq^{\\ast} = \\frac{\\mu}{s} - \\left(\\frac{\\mu}{s}\\right)^2 + \\left(\\frac{\\mu}{s}\\right)^3 - \\dots\n$$\n此展开的领头阶项是 $\\mu/s$。这正是我们所讨论的近似。该展开明确表明，此近似的误差是 $(\\mu/s)^2$ 阶。例如，第一个非平凡阶的展开是 $q^{\\ast} \\approx \\frac{\\mu}{s} - \\frac{\\mu^2}{s^2}$。当 $\\mu \\ll s$ 时，第一项占主导地位，级数中的每个后续项都逐渐变小，这证明了将级数截断到领头阶以获得良好近似的合理性。这证实了 $q^{\\ast} \\approx \\mu/s$ 是在选择远强于突变的范围内正确的领头阶近似。\n\n最后的任务是提供 $q^{\\ast}$ 的精确闭式表达式，这已在第一步中推导出。", "answer": "$$\n\\boxed{\\frac{\\mu}{\\mu+s}}\n$$", "id": "4339039"}, {"introduction": "虽然单个突变是进化的基本单位，但基因的适应性效应往往取决于其所处的遗传背景，这种现象被称为上位性（epistasis）。理解上位性对于揭示复杂性状、疾病易感性和药物抗性的进化轨迹至关重要。本练习[@problem_id:4339125]引入了一个标准框架，通过衡量组合突变的适应性与个体效应的加和性之间的偏差来量化上位性，帮助您将基因互作的概念形式化，并将其与可测量的适应性景观联系起来。", "problem": "在一个恒定环境中，考虑一个克隆微生物种群，其具有两个双等位基因座，记为$A$和$B$，每个基因座既可以是野生型（$0$），也可以是突变型（$1$）。令$x_A \\in \\{0,1\\}$和$x_B \\in \\{0,1\\}$分别为基因座$A$和$B$上存在突变等位基因的指示变量。绝对（赖特）适应度定义为每代存活后代的期望数量，并且是无量纲的。假设基因型到适应度的映射可以在绝对适应度标度上用最小二基因座多项式模型表示\n$$\nw(x_A,x_B) = \\beta_0 + \\beta_A x_A + \\beta_B x_B + \\beta_{AB} x_A x_B,\n$$\n其中$\\beta_{AB}$是捕捉由两个基因座之间相互作用引起的与加性偏离的系数。四个可观测的基因型是：适应度为$w_0$的基线野生型$(x_A,x_B)=(0,0)$，适应度为$w_A$的在$A$处的单一突变体$(1,0)$，适应度为$w_B$的在$B$处的单一突变体$(0,1)$，以及适应度为$w_{AB}$的双突变体$(1,1)$。\n\n(a) 从上述模型出发，仅使用绝对适应度标度上加性和相互作用的定义，推导相互作用系数$\\epsilon$关于$w_0$、$w_A$、$w_B$和$w_{AB}$的表达式。请清楚地说明该表达式是如何通过消除模型参数$\\beta_0$、$\\beta_A$和$\\beta_B$，并用可观测的量来表示的。\n\n(b) 在一个特定的实验系统中，测得的适应度值为$w_0 = 1.00$，$w_A = 1.10$，$w_B = 1.05$和$w_{AB} = 1.20$。计算该系统中$\\epsilon$的数值。不需要四舍五入。\n\n根据你推导的表达式，简要地用文字解释$\\epsilon \\neq 0$对于该系统中基因座之间的相互作用意味着什么，以及$\\epsilon$的符号在绝对适应度标度上应如何解释。最终报告的答案必须是$\\epsilon$的单个数值。", "solution": "此问题经评估有效。它在科学上基于种群遗传学和进化生物学的原理，特别是上位性的概念。问题提法明确、客观，并包含足够的信息来推导出唯一解。该模型是分析基因相互作用的标准表述。用$\\epsilon$表示相互作用系数是标准的，并且将其与模型参数$\\beta_{AB}$等同是该问题结构的直接结果。\n\n(a) 相互作用系数$\\epsilon$的推导。\n\n问题使用多项式模型定义了一个二基因座基因型到适应度的映射：\n$$\nw(x_A,x_B) = \\beta_0 + \\beta_A x_A + \\beta_B x_B + \\beta_{AB} x_A x_B\n$$\n这里，$x_A, x_B \\in \\{0, 1\\}$分别是基因座$A$和$B$上存在突变等位基因的指示变量。系数$\\beta_{AB}$量化了上位性相互作用，问题中将其表示为$\\epsilon$。因此，我们设$\\epsilon = \\beta_{AB}$。\n\n四个可观测的基因型对应于$(x_A, x_B)$的四种可能组合。我们可以为每个基因型的适应度写出具体的方程：\n1.  野生型基因型$(x_A, x_B) = (0,0)$:\n    $$w_0 = w(0,0) = \\beta_0 + \\beta_A(0) + \\beta_B(0) + \\beta_{AB}(0)(0) = \\beta_0$$\n2.  在基因座$A$上的单一突变体基因型$(x_A, x_B) = (1,0)$:\n    $$w_A = w(1,0) = \\beta_0 + \\beta_A(1) + \\beta_B(0) + \\beta_{AB}(1)(0) = \\beta_0 + \\beta_A$$\n3.  在基因座$B$上的单一突变体基因型$(x_A, x_B) = (0,1)$:\n    $$w_B = w(0,1) = \\beta_0 + \\beta_A(0) + \\beta_B(1) + \\beta_{AB}(0)(1) = \\beta_0 + \\beta_B$$\n4.  双突变体基因型$(x_A, x_B) = (1,1)$:\n    $$w_{AB} = w(1,1) = \\beta_0 + \\beta_A(1) + \\beta_B(1) + \\beta_{AB}(1)(1) = \\beta_0 + \\beta_A + \\beta_B + \\beta_{AB}$$\n\n我们的目标是找到$\\epsilon = \\beta_{AB}$关于可测量的适应度值$w_0$、$w_A$、$w_B$和$w_{AB}$的表达式。这需要消除其他模型参数$\\beta_0$、$\\beta_A$和$\\beta_B$。\n\n从第一个方程，我们直接得到：\n$$ \\beta_0 = w_0 $$\n这意味着$\\beta_0$是基线野生型基因型的适应度。\n\n将此结果代入第二个方程，我们求解$\\beta_A$：\n$$ w_A = \\beta_0 + \\beta_A \\implies \\beta_A = w_A - \\beta_0 = w_A - w_0 $$\n参数$\\beta_A$表示在野生型背景下，基因座$A$上突变的适应度效应。\n\n类似地，使用第三个方程，我们求解$\\beta_B$：\n$$ w_B = \\beta_0 + \\beta_B \\implies \\beta_B = w_B - \\beta_0 = w_B - w_0 $$\n参数$\\beta_B$表示在野生型背景下，基因座$B$上突变的适应度效应。\n\n最后，我们使用第四个方程，并代入$\\beta_0$、$\\beta_A$和$\\beta_B$的表达式：\n$$ w_{AB} = \\beta_0 + \\beta_A + \\beta_B + \\beta_{AB} $$\n求解我们称之为$\\epsilon$的$\\beta_{AB}$：\n$$ \\epsilon = \\beta_{AB} = w_{AB} - \\beta_0 - \\beta_A - \\beta_B $$\n将推导出的参数表达式（用观测到的适应度值表示）代入：\n$$ \\epsilon = w_{AB} - (w_0) - (w_A - w_0) - (w_B - w_0) $$\n展开各项：\n$$ \\epsilon = w_{AB} - w_0 - w_A + w_0 - w_B + w_0 $$\n$$ \\epsilon = w_{AB} - w_A - w_B + w_0 $$\n这就是我们所求的相互作用系数$\\epsilon$的表达式。\n\n(b) 数值计算与解释。\n\n给定测得的适应度值为$w_0 = 1.00$，$w_A = 1.10$，$w_B = 1.05$和$w_{AB} = 1.20$。我们使用推导出的表达式来计算$\\epsilon$：\n$$ \\epsilon = 1.20 - 1.10 - 1.05 + 1.00 $$\n$$ \\epsilon = (1.20 + 1.00) - (1.10 + 1.05) $$\n$$ \\epsilon = 2.20 - 2.15 $$\n$$ \\epsilon = 0.05 $$\n\n相互作用系数$\\epsilon$衡量了与加性的偏离程度。如果两个突变的效果是纯粹加性的，那么双突变体的适应度$w_{AB}^{add}$将是基线适应度加上每个突变单独效应的总和。突变$A$的效应是$(w_A - w_0)$，突变$B$的效应是$(w_B - w_0)$。因此，期望的加性适应度是：\n$$ w_{AB}^{add} = w_0 + (w_A - w_0) + (w_B - w_0) = w_A + w_B - w_0 $$\n相互作用系数$\\epsilon$是观测到的双突变体适应度与这个期望的加性适应度之间的差值：\n$$ \\epsilon = w_{AB} - (w_A + w_B - w_0) = w_{AB} - w_{AB}^{add} $$\n因此，$\\epsilon \\neq 0$意味着突变的适应度效应不是加性的；基因座之间存在上位性。双突变体的适应度不是简单地将单个突变的单独效应组合起来所能预测的。\n\n$\\epsilon$的符号表明了这种相互作用的性质：\n-   $\\epsilon  0$：这被称为**正上位性**（或协同上位性）。它意味着$w_{AB}  w_{AB}^{add}$。双突变体的组合适应度高于根据单个效应之和所预期的值。这两个突变协同作用，产生了比预期更有利的效果。在该系统中，预期的加性适应度是$1.10 + 1.05 - 1.00 = 1.15$。观测到的适应度是$1.20$，高出$0.05$个单位，因此$\\epsilon = 0.05$。\n-   $\\epsilon  0$：这被称为**负上位性**（或拮抗上位性）。它意味着$w_{AB}  w_{AB}^{add}$。组合适应度低于预期，表明突变相互干扰或具有冗余效应。\n-   $\\epsilon = 0$：这表示没有上位性（加性）。突变的适应度效应呈线性组合。\n\n在这个具体案例中，$\\epsilon = 0.05  0$，表示正上位性。", "answer": "$$\\boxed{0.05}$$", "id": "4339125"}, {"introduction": "进化系统生物学的一个核心目标是从实验数据中推断进化作用力的大小。现代测序技术使我们能够前所未有地追踪进化种群中等位基因频率的动态变化。本练习[@problem_id:4339123]将向您展示如何从时间序列数据中估计选择系数$s$，这是量化自然选择强度的关键参数。通过将理论模型与等位基因频率数据相结合，您将掌握一种连接进化理论与实验观察的实用方法。", "problem": "考虑一个大的、充分混合的无性细胞群体，其中有两种基因型在竞争。设目标基因型在时间 $t$ 的频率为 $p(t)$。假设存在马尔萨斯（连续时间）选择，其选择系数 $s$ 为常数，使得频率动态遵循复制子方程，并且种群大小足够大，可以忽略遗传漂变。在离散时间点进行的深度测序提供了目标基因型的等位基因计数，在时间 $t$ 的 $n_t$ 次总读数中有 $k_t$ 次成功，从而得到经验频率 $\\hat{p}_t = k_t/n_t$。观测数据如下：\n- $(t, k_t, n_t) = (0, 100, 1000)$,\n- $(t, k_t, n_t) = (5, 200, 1000)$,\n- $(t, k_t, n_t) = (10, 350, 1000)$,\n- $(t, k_t, n_t) = (15, 550, 1000)$,\n- $(t, k_t, n_t) = (20, 700, 1000)$。\n\n使用具有二项似然和 logit 链接函数的广义线性模型 (GLM)，对 $\\ln\\!\\left(\\frac{\\hat{p}_t}{1 - \\hat{p}_t}\\right)$ 与时间 $t$ 进行逻辑斯谛回归拟合，以估计选择系数 $s$。为了在此情况下便于计算，您可以将 $\\hat{p}_t$ 视为 $p(t)$ 的无噪声估计，并对转换后的响应 $\\ln\\!\\left(\\frac{\\hat{p}_t}{1 - \\hat{p}_t}\\right)$ 与 $t$ 进行普通最小二乘法分析。\n\n从适用于演化系统生物学的第一性原理出发，推导连接选择与等位基因频率 logit 变换随时间演化的关系，证明为何在所述模型下 GLM 斜率对应于 $s$，并列举使该估计量无偏的假设。\n\n根据给定数据计算数值估计值 $\\hat{s}$。将最终数值估计四舍五入到四位有效数字，并以 天$^{-1}$ 为单位表示。最终答案仅提供数值。", "solution": "问题要求推导选择系数与等位基因频率随时间演化之间的关系，为所提出的估计方法提供理由，列举相关假设，并根据给定数据计算选择系数。\n\n### 第 1 步：问题验证\n题目陈述提供了一组清晰的数据点、一个定义明确的群体遗传学模型（马尔萨斯选择，复制子动态）和一个指定的统计程序（广义线性模型简化为对转换后数据的普通最小二乘法）。其前提建立在成熟的演化理论之上，具有科学依据，且目标是适定的。将正式的 GLM 简化为 OLS 被明确说明是为便于计算而采取的可行步骤，这使得问题内部一致。该问题是有效的。\n\n### 第 2 步：从第一性原理推导\n我们从一个由两种竞争的无性基因型组成的种群开始，目标基因型的种群大小为 $N_1(t)$，参考基因型的种群大小为 $N_2(t)$。总种群大小为 $N(t) = N_1(t) + N_2(t)$。目标基因型的频率为 $p(t) = N_1(t) / N(t)$。\n\n在马尔萨斯模型下，每种基因型根据其马尔萨斯适应度参数（增长率）呈指数增长。设目标基因型的适应度为 $r_1$，参考基因型的适应度为 $r_2$。动态方程如下：\n$$\n\\frac{dN_1}{dt} = r_1 N_1(t)\n$$\n$$\n\\frac{dN_2}{dt} = r_2 N_2(t)\n$$\n选择系数 $s$ 定义为目标基因型的适应度优势，即 $s = r_1 - r_2$。\n\n为了求出频率 $p(t)$ 的动态，我们使用商法则对其进行时间求导：\n$$\n\\frac{dp}{dt} = \\frac{d}{dt} \\left( \\frac{N_1}{N_1 + N_2} \\right) = \\frac{\\frac{dN_1}{dt}(N_1 + N_2) - N_1\\left(\\frac{dN_1}{dt} + \\frac{dN_2}{dt}\\right)}{(N_1 + N_2)^2}\n$$\n代入马尔萨斯增长方程：\n$$\n\\frac{dp}{dt} = \\frac{r_1 N_1 (N_1 + N_2) - N_1 (r_1 N_1 + r_2 N_2)}{(N_1 + N_2)^2}\n$$\n$$\n\\frac{dp}{dt} = \\frac{r_1 N_1^2 + r_1 N_1 N_2 - r_1 N_1^2 - r_2 N_1 N_2}{(N_1 + N_2)^2}\n$$\n$$\n\\frac{dp}{dt} = \\frac{(r_1 - r_2) N_1 N_2}{(N_1 + N_2)^2}\n$$\n通过代入 $s = r_1 - r_2$，$p = N_1/N$ 和 $1-p = N_2/N$，我们得到连续时间复制子方程：\n$$\n\\frac{dp}{dt} = s \\cdot p(t) \\cdot (1 - p(t))\n$$\n这是一个可分离常微分方程。我们可以通过分离变量来求解它：\n$$\n\\frac{dp}{p(1-p)} = s \\, dt\n$$\n使用部分分式分解，$\\frac{1}{p(1-p)} = \\frac{1}{p} + \\frac{1}{1-p}$。方程变为：\n$$\n\\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = s \\, dt\n$$\n对两边从初始时间 $t_0=0$ 到 $t$ 进行积分：\n$$\n\\int_{p(0)}^{p(t)} \\left(\\frac{1}{p'} + \\frac{1}{1-p'}\\right) dp' = \\int_{0}^{t} s \\, d\\tau\n$$\n$$\n[\\ln(p') - \\ln(1-p')]_{p(0)}^{p(t)} = [s\\tau]_{0}^{t}\n$$\n$$\n\\left(\\ln(p(t)) - \\ln(1-p(t))\\right) - \\left(\\ln(p(0)) - \\ln(1-p(0))\\right) = st\n$$\n这可以用 logit 函数 $\\text{logit}(x) = \\ln\\left(\\frac{x}{1-x}\\right)$ 来表示：\n$$\n\\text{logit}(p(t)) = st + \\text{logit}(p(0))\n$$\n该方程表明，等位基因频率的 logit 是时间的线性函数，其斜率等于选择系数 $s$。\n\n### 第 3 步：估计方法的合理性与假设\n推导出的关系形式为 $Y(t) = \\beta_1 X(t) + \\beta_0$，其中 $Y(t) = \\text{logit}(p(t))$，$X(t) = t$，斜率为 $\\beta_1 = s$，截距为 $\\beta_0 = \\text{logit}(p(0))$。\n\n广义线性模型 (GLM) 是解决此问题的合适框架。观测数据是 $n_t$ 次试验中的计数 $k_t$，其服从二项分布，$k_t \\sim \\text{Binomial}(n_t, p(t))$。二项分布族的典则链接函数是 logit 链接函数，$g(\\mu) = \\text{logit}(\\mu)$，其中 $\\mu$ 是响应的均值（此处 $\\mu = p(t)$）。GLM 将转换后的均值建模为预测变量的线性函数：$g(p(t)) = \\text{logit}(p(t)) = st + \\beta_0$。因此，拟合这样一个 GLM 将得到斜率的估计值，该值直接对应于选择系数 $s$。\n\n问题允许一种简化：对转换后的经验频率 $y_t = \\text{logit}(\\hat{p}_t) = \\ln(\\frac{\\hat{p}_t}{1-\\hat{p}_t})$ 与时间 $t$ 进行普通最小二乘法 (OLS) 分析。这种方法通过假设 $y_t$ 的方差是恒定的来近似 GLM，但这并非严格成立（logit 转换后频率的方差取决于 $p(t)$ 和 $n_t$）。然而，根据题目中将 $\\hat{p}_t$ 视为“无噪声估计”的指示，这种简化是合理的。\n\nOLS 斜率估计量作为 $s$ 的无偏估计量所需满足的假设如下：\n1.  **正确的模型设定**：潜在动态必须遵循复制子方程 $\\frac{dp}{dt} = s p(1-p)$。这又依赖于以下生物学假设：\n    *   无性繁殖。\n    *   一个大的、充分混合的群体，其中遗传漂变可以忽略不计。\n    *   马尔萨斯（连续时间指数）增长。\n    *   选择系数 $s$ 随时间恒定且不依赖于频率。\n    *   两种基因型之间没有新的突变或回复突变。\n2.  **线性**：如推导所示，转换后的变量 $\\text{logit}(p(t))$ 与时间 $t$ 之间存在线性关系。\n3.  **无噪声数据（根据题目陈述）**：经验频率 $\\hat{p}_t$ 被视为真实频率 $p(t)$ 的精确测量值。这是一个非常强且不切实际的假设，它消除了抽样噪声这一误差来源，从而排除了对非线性 logit 变换引入偏差的担忧（即 $E[\\text{logit}(\\hat{p}_t)] \\neq \\text{logit}(E[\\hat{p}_t])$）。在这一特定指令下，OLS 程序应用于完全落在真实轨迹上的无误差数据点，因此根据定义，该估计量是无偏的。\n4.  **自变量无误差**：时间 $t$ 的测量没有误差。\n\n### 第 4 步：选择系数的数值估计\n首先，我们计算经验频率 $\\hat{p}_t = k_t/n_t$ 及其 logit 变换 $y_t = \\ln(\\hat{p}_t / (1-\\hat{p}_t))$。\n数据点 $(t, k_t, n_t)$ 如下：\n- $t=0$: $\\hat{p}_0 = 100/1000 = 0.1$, $y_0 = \\ln(0.1/0.9) = \\ln(1/9) \\approx -2.19722$\n- $t=5$: $\\hat{p}_5 = 200/1000 = 0.2$, $y_5 = \\ln(0.2/0.8) = \\ln(1/4) \\approx -1.38629$\n- $t=10$: $\\hat{p}_{10} = 350/1000 = 0.35$, $y_{10} = \\ln(0.35/0.65) = \\ln(7/13) \\approx -0.61904$\n- $t=15$: $\\hat{p}_{15} = 550/1000 = 0.55$, $y_{15} = \\ln(0.55/0.45) = \\ln(11/9) \\approx 0.20067$\n- $t=20$: $\\hat{p}_{20} = 700/1000 = 0.7$, $y_{20} = \\ln(0.7/0.3) = \\ln(7/3) \\approx 0.84730$\n\n现在我们对 $y$ 和 $t$ 进行简单线性回归。斜率的估计值 $\\hat{s}$ 由 OLS 公式给出：\n$$\n\\hat{s} = \\frac{\\sum_{i=1}^{N} (t_i - \\bar{t})(y_i - \\bar{y})}{\\sum_{i=1}^{N} (t_i - \\bar{t})^2}\n$$\n时间点为 $t = \\{0, 5, 10, 15, 20\\}$。\n平均时间为 $\\bar{t} = (0+5+10+15+20)/5 = 10$。\nlogit 变换后的频率为 $y \\approx \\{-2.19722, -1.38629, -0.61904, 0.20067, 0.84730\\}$。\ny 值的均值为 $\\bar{y} \\approx (-2.19722 - 1.38629 - 0.61904 + 0.20067 + 0.84730)/5 = -3.15458/5 \\approx -0.63092$。\n\n分子计算： $\\sum (t_i - \\bar{t})(y_i - \\bar{y})$\n- $(0-10)(-2.19722 - (-0.63092)) = (-10)(-1.56630) = 15.6630$\n- $(5-10)(-1.38629 - (-0.63092)) = (-5)(-0.75537) = 3.77685$\n- $(10-10)(-0.61904 - (-0.63092)) = (0)(0.01188) = 0$\n- $(15-10)(0.20067 - (-0.63092)) = (5)(0.83159) = 4.15795$\n- $(20-10)(0.84730 - (-0.63092)) = (10)(1.47822) = 14.7822$\n乘积之和 = $15.6630 + 3.77685 + 0 + 4.15795 + 14.7822 = 38.3800$\n\n分母计算： $\\sum (t_i - \\bar{t})^2$\n- $(0-10)^2 + (5-10)^2 + (10-10)^2 + (15-10)^2 + (20-10)^2$\n- $100 + 25 + 0 + 25 + 100 = 250$\n\n估计的选择系数为：\n$$\n\\hat{s} = \\frac{38.3800}{250} = 0.15352\n$$\n四舍五入到四位有效数字，我们得到 $\\hat{s} = 0.1535$。单位是 天$^{-1}$，因为 logit 是无量纲的，而时间单位是天。", "answer": "$$\\boxed{0.1535}$$", "id": "4339123"}]}