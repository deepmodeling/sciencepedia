{"hands_on_practices": [{"introduction": "在最优实验设计中，最基础的任务是设计一个能最大限度帮助我们了解未知参数的实验。本练习将引导您通过贝叶斯推断，来预测一个实验将如何减少参数不确定性（即后验方差），这是 A-最优性（A-optimality）等设计标准的核心。通过完成这个计算，您将掌握在进行实验前量化其实验价值的基础方法 [@problem_id:4313149]。", "problem": "在系统生物医学中，考虑一个主动学习（AL）任务，该任务旨在通过优化实验设计（OED）来校准单个转录因子调控报告基因的线性剂量-反应关系。设测量模型为 $y=\\theta x+\\varepsilon$，其中 $x$ 是一个可控的实验设计变量（例如，配体浓度），$\\theta$ 是一个未知的敏感度参数，$\\varepsilon$ 是测量噪声。假设 $\\varepsilon\\sim\\mathcal{N}(0,\\sigma^{2})$ 且 $\\theta$ 的先验为 $\\theta\\sim\\mathcal{N}(\\mu_{0},\\tau_{0}^{2})$。您在设计 $x$ 下进行一次实验，并获得一个测量值 $y$。\n\n从贝叶斯法则以及高斯似然和高斯先验的定义出发，通过对指数项进行显式配方法来推导后验分布 $p(\\theta\\mid y,x)$，然后计算在设计 $x$ 下观察到一个测量值后的期望后验方差，定义为 $\\mathbb{E}_{y\\mid x}\\big[\\operatorname{Var}(\\theta\\mid y,x)\\big]$。请将您的最终答案表示为一个关于 $x$、$\\sigma^{2}$ 和 $\\tau_{0}^{2}$ 的闭式解析表达式。无需进行数值计算。最终答案必须是单一表达式，不带单位。", "solution": "用户要求推导线性模型中参数的期望后验方差，这是贝叶斯优化实验设计的核心任务。我将首先验证问题陈述。\n\n### 第一步：提取已知条件\n- 测量模型：$y = \\theta x + \\varepsilon$\n- 实验设计变量：$x$\n- 未知参数：$\\theta$\n- 测量噪声分布：$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$\n- 参数的先验分布：$\\theta \\sim \\mathcal{N}(\\mu_0, \\tau_0^2)$\n- 任务：通过配方法推导后验分布 $p(\\theta \\mid y, x)$。\n- 任务：计算期望后验方差 $\\mathbb{E}_{y \\mid x}[\\operatorname{Var}(\\theta \\mid y, x)]$。\n- 最终答案格式：一个关于 $x$、$\\sigma^2$ 和 $\\tau_0^2$ 的闭式表达式。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据、提法恰当且客观。它呈现了一个涉及共轭高斯分布的标准贝叶斯推断场景，这是包括系统生物医学在内的许多科学学科中一个基础且广泛使用的模型。模型 $y = \\theta x + \\varepsilon$ 是一个基本的线性回归。对参数 $\\theta$ 使用高斯先验和对数据 $y$ 使用高斯似然是一个经典范例。需要计算的量——期望后验方差，是优化实验设计领域的一个标准准则（与 A-最优性相关）。所有组成部分都定义清晰，没有矛盾、模糊或事实错误。该问题是一个有效、可解的数理统计问题。\n\n### 第三步：结论与行动\n该问题有效。我将继续进行详细的解答。\n\n### 后验分布与期望后验方差的推导\n\n目标是求出期望后验方差 $\\mathbb{E}_{y\\mid x}\\big[\\operatorname{Var}(\\theta\\mid y,x)\\big]$。我们首先使用贝叶斯法则推导后验分布 $p(\\theta\\mid y,x)$。\n\n贝叶斯法则所需的两个组成部分是数据的似然和参数的先验分布。\n\n$1$. **似然**：测量模型为 $y = \\theta x + \\varepsilon$，其中噪声项 $\\varepsilon$ 服从均值为 $0$、方差为 $\\sigma^2$ 的正态分布，即 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着对于给定的 $\\theta$ 和 $x$，测量值 $y$ 也服从正态分布。具体来说，$y \\mid \\theta, x \\sim \\mathcal{N}(\\theta x, \\sigma^2)$。因此，似然函数 $p(y \\mid \\theta, x)$ 为：\n$$ p(y \\mid \\theta, x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y - \\theta x)^2}{2\\sigma^2} \\right) $$\n\n$2$. **先验**：关于参数 $\\theta$ 的先验信念被设定为正态分布，$\\theta \\sim \\mathcal{N}(\\mu_0, \\tau_0^2)$。先验概率密度函数 $p(\\theta)$ 为：\n$$ p(\\theta) = \\frac{1}{\\sqrt{2\\pi\\tau_0^2}} \\exp\\left( -\\frac{(\\theta - \\mu_0)^2}{2\\tau_0^2} \\right) $$\n\n$3$. **后验分布**：根据贝叶斯法则，后验分布 $p(\\theta \\mid y, x)$ 与似然和先验的乘积成正比：\n$$ p(\\theta \\mid y, x) \\propto p(y \\mid \\theta, x) p(\\theta) $$\n代入似然和先验的表达式，并舍去不依赖于 $\\theta$ 的归一化常数：\n$$ p(\\theta \\mid y, x) \\propto \\exp\\left( -\\frac{(y - \\theta x)^2}{2\\sigma^2} \\right) \\exp\\left( -\\frac{(\\theta - \\mu_0)^2}{2\\tau_0^2} \\right) $$\n我们可以合并指数项：\n$$ p(\\theta \\mid y, x) \\propto \\exp\\left( -\\frac{(y - \\theta x)^2}{2\\sigma^2} - \\frac{(\\theta - \\mu_0)^2}{2\\tau_0^2} \\right) $$\n我们关注指数的参数，记为 $\\Phi$：\n$$ \\Phi = -\\frac{1}{2} \\left( \\frac{(y - \\theta x)^2}{\\sigma^2} + \\frac{(\\theta - \\mu_0)^2}{\\tau_0^2} \\right) $$\n为了找到后验分布的形式，我们对 $\\theta$ 进行配方法。展开括号内的平方项：\n$$ \\Phi = -\\frac{1}{2} \\left( \\frac{y^2 - 2y\\theta x + \\theta^2 x^2}{\\sigma^2} + \\frac{\\theta^2 - 2\\theta\\mu_0 + \\mu_0^2}{\\tau_0^2} \\right) $$\n现在，我们根据 $\\theta$ 的幂次收集项：\n$$ \\Phi = -\\frac{1}{2} \\left[ \\theta^2 \\left( \\frac{x^2}{\\sigma^2} + \\frac{1}{\\tau_0^2} \\right) - 2\\theta \\left( \\frac{yx}{\\sigma^2} + \\frac{\\mu_0}{\\tau_0^2} \\right) + \\left( \\frac{y^2}{\\sigma^2} + \\frac{\\mu_0^2}{\\tau_0^2} \\right) \\right] $$\n由于先验和似然是共轭的，我们知道 $\\theta$ 的后验分布是高斯分布。$\\theta$ 的一般高斯密度函数的指数形式为 $-\\frac{(\\theta - \\mu_1)^2}{2\\tau_1^2}$，其中 $\\mu_1$ 是后验均值，$\\tau_1^2$ 是后验方差。展开此式得到：\n$$ -\\frac{1}{2\\tau_1^2}(\\theta^2 - 2\\theta\\mu_1 + \\mu_1^2) = -\\frac{1}{2} \\left[ \\theta^2 \\left(\\frac{1}{\\tau_1^2}\\right) - 2\\theta \\left(\\frac{\\mu_1}{\\tau_1^2}\\right) + \\frac{\\mu_1^2}{\\tau_1^2} \\right] $$\n通过比较我们推导的 $\\Phi$ 表达式中的 $\\theta^2$ 项系数与一般形式，我们可以确定后验方差的倒数，也称为后验精度。\n$$ \\frac{1}{\\tau_1^2} = \\frac{x^2}{\\sigma^2} + \\frac{1}{\\tau_0^2} $$\n后验方差 $\\operatorname{Var}(\\theta \\mid y, x)$ 即为 $\\tau_1^2$。我们可以解出它：\n$$ \\frac{1}{\\tau_1^2} = \\frac{x^2\\tau_0^2 + \\sigma^2}{\\sigma^2\\tau_0^2} $$\n$$ \\tau_1^2 = \\operatorname{Var}(\\theta \\mid y, x) = \\frac{\\sigma^2\\tau_0^2}{\\sigma^2 + x^2\\tau_0^2} $$\n尽管最终答案不需要，我们也可以通过比较 $\\theta$ 项的系数来找到后验均值 $\\mu_1$：\n$$ \\frac{\\mu_1}{\\tau_1^2} = \\frac{yx}{\\sigma^2} + \\frac{\\mu_0}{\\tau_0^2} \\implies \\mu_1 = \\tau_1^2 \\left( \\frac{yx}{\\sigma^2} + \\frac{\\mu_0}{\\tau_0^2} \\right) = \\frac{\\tau_0^2 yx + \\sigma^2 \\mu_0}{\\sigma^2 + x^2\\tau_0^2} $$\n因此，后验分布为 $p(\\theta \\mid y, x) = \\mathcal{N}(\\mu_1, \\tau_1^2)$。\n\n$4$. **期望后验方差**：最后一步是计算期望后验方差 $\\mathbb{E}_{y\\mid x}\\big[\\operatorname{Var}(\\theta\\mid y,x)\\big]$。该期望是针对给定实验设计 $x$ 的所有可能测量值 $y$ 的分布来计算的。这个分布是边缘似然或证据，$p(y \\mid x) = \\int p(y \\mid \\theta, x)p(\\theta) d\\theta$。\n\n我们推导出的后验方差为：\n$$ \\operatorname{Var}(\\theta \\mid y, x) = \\frac{\\sigma^2\\tau_0^2}{\\sigma^2 + x^2\\tau_0^2} $$\n关键在于，我们观察到后验方差的这个表达式仅取决于实验设计 $x$、测量噪声方差 $\\sigma^2$ 和先验方差 $\\tau_0^2$。它**不**依赖于具体的测量值 $y$。\n\n因此，当我们对 $y$ 求期望时，我们是在对一个相对于 $y$ 是常量的量求期望。对于任何随机变量 $Y$ 和任何常数 $C$，期望为 $\\mathbb{E}[C] = C$。\n$$ \\mathbb{E}_{y\\mid x}\\big[\\operatorname{Var}(\\theta\\mid y,x)\\big] = \\mathbb{E}_{y\\mid x}\\left[\\frac{\\sigma^2\\tau_0^2}{\\sigma^2 + x^2\\tau_0^2}\\right] $$\n由于期望内的项相对于 $y$ 是一个常数，所以期望就是该项本身：\n$$ \\mathbb{E}_{y\\mid x}\\big[\\operatorname{Var}(\\theta\\mid y,x)\\big] = \\frac{\\sigma^2\\tau_0^2}{\\sigma^2 + x^2\\tau_0^2} $$\n这个结果表明，对于这个线性高斯模型，参数 $\\theta$ 不确定性的减少量甚至可以在实验进行之前就被计算出来。它仅取决于我们选择在哪里测量（即设计 $x$），而不取决于测量的结果（$y$）。这是优化实验设计中用于选择 $x$ 以最小化该期望后验方差的一项关键原则。", "answer": "$$\n\\boxed{\\frac{\\sigma^{2}\\tau_{0}^{2}}{\\sigma^{2} + x^{2}\\tau_{0}^{2}}}\n$$", "id": "4313149"}, {"introduction": "在前一个概念的基础上，我们现在探索一种基于信息论的强大方法来衡量实验的价值。本实践将重点放在最大化未知参数与我们将要收集的数据之间的互信息（Mutual Information）。这种方法是 D-最优（D-optimal）设计的核心，它将实验设计的目标重新定义为最大化信息增益，并常常能引导我们得出关于实验策略的直观结论 [@problem_id:4313206]。", "problem": "在一个系统生物医学扰动实验中，单细胞响应 $y$ 对可控刺激振幅 $x$ 的模型为 $y=\\theta x+\\varepsilon$，其中未知灵敏度参数 $\\theta$ 代表群体中的一个潜在药物反应系数，实验噪声 $\\varepsilon$ 则解释了所有测量和过程变异性。假设 $\\theta$ 的先验分布是高斯分布 $\\theta\\sim\\mathcal{N}(0,\\tau_{0}^{2})$，噪声也是高斯分布 $\\varepsilon\\sim\\mathcal{N}(0,\\sigma^{2})$，其中 $\\tau_{0}>0$ 且 $\\sigma>0$。你可以选择刺激振幅 $x$，但需满足可行性约束 $|x|\\leq c$，其中 $c>0$。\n\n采用主动学习准则进行优化实验设计，选择 $x$ 以最大化在给定 $x$ 的条件下 $\\theta$ 和可观测量 $y$ 之间的互信息 (MI)，记为 $I(\\theta;y\\,|\\,x)$。从连续随机变量微分熵的基本定义以及互信息定义 $I(\\theta;y\\,|\\,x)=h(y\\,|\\,x)-h(y\\,|\\,\\theta,x)$ 出发，并仅使用高斯随机变量的标准性质，推导 $I(\\theta;y\\,|\\,x)$ 作为 $x$、$\\tau_{0}$ 和 $\\sigma$ 的函数的解析表达式。然后，在约束 $|x|\\leq c$ 下，确定使 $I(\\theta;y\\,|\\,x)$ 最大化的值 $x^{\\star}$。如果存在多个最大化值，选择满足 $x^{\\star}\\geq 0$ 的那一个。请以单一闭式表达式提供 $x^{\\star}$。不需要数值近似或四舍五入，并且根据设计，所有变量都是无量纲的。", "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 单细胞响应 $y$ 对刺激 $x$ 的模型为 $y = \\theta x + \\varepsilon$。\n- $\\theta$ 是一个未知的灵敏度参数，其先验分布为高斯分布：$\\theta \\sim \\mathcal{N}(0, \\tau_{0}^{2})$，其中 $\\tau_{0} > 0$。\n- $\\varepsilon$ 是实验噪声，其分布为高斯分布：$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2})$，其中 $\\sigma > 0$。\n- 刺激振幅 $x$ 是可控的，受约束 $|x| \\leq c$ 的限制，其中 $c > 0$。\n- 目标是选择 $x$ 来最大化互信息 (MI)，$I(\\theta; y \\,|\\, x)$。\n- 互信息需从定义 $I(\\theta; y \\,|\\, x) = h(y \\,|\\, x) - h(y \\,|\\, \\theta, x)$ 推导得出，其中 $h(\\cdot)$ 是微分熵。\n- 任务是在给定约束下找到使互信息最大化的最优刺激 $x^{\\star}$。\n- 指定了一条决胜规则：如果存在多个最大化值，应选择非负的那一个 ($x^{\\star} \\geq 0$)。\n- 所有变量均被说明是无量纲的。\n\n**第2步：使用提取的已知条件进行验证**\n对问题的有效性进行评估：\n- **科学依据充分：** 该问题使用了带有高斯噪声和高斯先验的标准线性模型，这是贝叶斯统计中的一个基本设置。最大化互信息的目标是贝叶斯优化实验设计的基石。在系统生物学和机器学习等领域，这是一个科学上合理且现实的问题表述。\n- **适定性：** 问题陈述清晰，具有明确定义的目标函数 $I(\\theta; y \\,|\\, x)$ 和紧凑的约束集 $|x| \\leq c$。所有参数（$\\tau_{0}$、$\\sigma$、$c$）均为正，避免了退化情况。最大值的存在性得到保证，决胜规则确保了所要求解的唯一性。\n- **客观性：** 语言正式、数学化且无歧义。没有主观或基于观点的陈述。\n- **其他缺陷：** 问题自洽、一致，没有表现出任何列出的缺陷，如科学上不合理、不完整或结构不良。\n\n**第3步：结论与行动**\n问题被确定为**有效**。现在将执行求解过程。\n\n### 推导与求解\n\n目标是找到 $x$ 的值，记为 $x^{\\star}$，它在约束 $|x| \\leq c$ 下最大化互信息 $I(\\theta; y \\,|\\, x)$。互信息的定义为：\n$$\nI(\\theta; y \\,|\\, x) = h(y \\,|\\, x) - h(y \\,|\\, \\theta, x)\n$$\n其中 $h(\\cdot)$ 表示微分熵。对于一个概率密度函数为 $p(z)$ 的连续随机变量 $Z$，其微分熵为 $h(Z) = -\\int p(z) \\ln(p(z)) dz$。对于一个高斯随机变量 $Z \\sim \\mathcal{N}(\\mu, \\Sigma^2)$，其微分熵由标准公式给出：$h(Z) = \\frac{1}{2}\\ln(2\\pi e \\Sigma^2)$。\n\n我们分别计算这两个熵项。\n\n**1. 计算 $h(y \\,|\\, \\theta, x)$**\n这是在参数 $\\theta$ 和刺激 $x$ 的值已知条件下，可观测量 $y$ 的熵。模型为 $y = \\theta x + \\varepsilon$。当 $\\theta$ 和 $x$ 给定时，$\\theta x$ 是一个常数。$y$ 中唯一的随机性来源是噪声项 $\\varepsilon$。\n给定 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$， $y$ 的条件分布为：\n$$\ny \\,|\\, (\\theta, x) \\sim \\mathcal{N}(\\theta x, \\sigma^2)\n$$\n该条件分布的方差是 $\\sigma^2$。使用高斯变量的熵公式，我们得到：\n$$\nh(y \\,|\\, \\theta, x) = \\frac{1}{2}\\ln(2\\pi e \\sigma^2)\n$$\n该项相对于 $x$ 是一个常数。\n\n**2. 计算 $h(y \\,|\\, x)$**\n这是仅以刺激 $x$ 为条件时，可观测量 $y$ 的边缘熵。响应 $y$ 是两个独立随机变量 $\\theta x$ 和 $\\varepsilon$ 的和。\n首先，我们确定项 $\\theta x$ 的分布。由于 $\\theta \\sim \\mathcal{N}(0, \\tau_{0}^{2})$，乘以常数 $x$ 后得到：\n$$\n\\theta x \\sim \\mathcal{N}(x \\cdot 0, x^2 \\tau_{0}^{2}) = \\mathcal{N}(0, x^2 \\tau_{0}^{2})\n$$\n响应 $y$ 是 $\\theta x$ 和 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$ 的和。两个独立高斯随机变量的和也是一个高斯随机变量。其均值是均值之和，其方差是方差之和。\n$y \\,|\\, x$ 的均值为：\n$$\nE[y \\,|\\, x] = E[\\theta x + \\varepsilon] = E[\\theta x] + E[\\varepsilon] = 0 + 0 = 0\n$$\n$y \\,|\\, x$ 的方差为：\n$$\n\\text{Var}(y \\,|\\, x) = \\text{Var}(\\theta x + \\varepsilon) = \\text{Var}(\\theta x) + \\text{Var}(\\varepsilon) = x^2 \\tau_{0}^{2} + \\sigma^2\n$$\n因此，以 $x$ 为条件的 $y$ 的边缘分布为：\n$$\ny \\,|\\, x \\sim \\mathcal{N}(0, x^2 \\tau_{0}^{2} + \\sigma^2)\n$$\n该分布的熵为：\n$$\nh(y \\,|\\, x) = \\frac{1}{2}\\ln\\left(2\\pi e (x^2 \\tau_{0}^{2} + \\sigma^2)\\right)\n$$\n\n**3. 互信息的解析表达式**\n将两个熵项的表达式代入互信息的定义中：\n$$\nI(\\theta; y \\,|\\, x) = \\frac{1}{2}\\ln\\left(2\\pi e (x^2 \\tau_{0}^{2} + \\sigma^2)\\right) - \\frac{1}{2}\\ln(2\\pi e \\sigma^2)\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们简化表达式：\n$$\nI(\\theta; y \\,|\\, x) = \\frac{1}{2}\\ln\\left(\\frac{2\\pi e (x^2 \\tau_{0}^{2} + \\sigma^2)}{2\\pi e \\sigma^2}\\right) = \\frac{1}{2}\\ln\\left(\\frac{x^2 \\tau_{0}^{2} + \\sigma^2}{\\sigma^2}\\right)\n$$\n这就得到了互信息作为 $x$ 的函数的解析表达式：\n$$\nI(\\theta; y \\,|\\, x) = \\frac{1}{2}\\ln\\left(1 + \\frac{\\tau_{0}^{2}}{\\sigma^2}x^2\\right)\n$$\n\n**4. 互信息的最大化**\n我们必须在约束 $|x| \\leq c$ 下找到使 $I(\\theta; y \\,|\\, x)$ 最大化的 $x^{\\star}$。\n设目标函数为 $J(x) = \\frac{1}{2}\\ln\\left(1 + \\frac{\\tau_{0}^{2}}{\\sigma^2}x^2\\right)$。自然对数函数 $\\ln(u)$ 是其参数 $u$ 的单调递增函数。因此，最大化 $J(x)$ 等价于最大化其参数：\n$$\n\\text{arg}\\max_{|x|\\leq c} J(x) = \\text{arg}\\max_{|x|\\leq c} \\left(1 + \\frac{\\tau_{0}^{2}}{\\sigma^2}x^2\\right)\n$$\n由于 $\\tau_{0} > 0$ 且 $\\sigma > 0$，系数 $\\frac{\\tau_{0}^{2}}{\\sigma^2}$ 是一个正常数。最大化表达式 $1 + (\\text{正常数}) \\cdot x^2$ 等价于最大化项 $x^2$。\n优化问题简化为：\n$$\n\\max_{|x| \\leq c} x^2\n$$\n约束 $|x| \\leq c$ 等价于 $-c \\leq x \\leq c$。函数 $f(x) = x^2$ 是一个开口向上、关于 $y$ 轴对称的抛物线。它在闭区间 $[-c, c]$ 上的最大值将出现在区间的端点处。\n当 $x=c$ 时，$x^2 = c^2$。\n当 $x=-c$ 时，$x^2 = c^2$。\n因此，$x^2$ 的最大值是 $c^2$，这个最大值在两个点上达到：$x = c$ 和 $x = -c$。这两个就是使互信息最大化的刺激振幅值。\n\n**5. 应用决胜规则**\n问题指定，如果存在多个最大化值，我们必须选择满足 $x^{\\star} \\geq 0$ 的那一个。两个最大化值是 $c$ 和 $-c$。因为给定 $c > 0$，所以非负的最大化值是 $c$。\n因此，最优刺激振幅是 $x^{\\star} = c$。这意味着在最大可行振幅下施加刺激，可以最大化关于参数 $\\theta$ 所获得的信息。", "answer": "$$ \\boxed{c} $$", "id": "4313206"}, {"introduction": "现在，我们将视角从设计单个最佳实验转向自适应地设计一系列实验，这在当我们需要从多个选项中进行研究且资源有限时至关重要。本练习将介绍多臂老虎机（multi-armed bandit）框架和汤普森采样（Thompson sampling），这是一种在探索新选项和利用已知最优选项之间进行平衡的先进算法。通过解决一个具体的 Beta-Bernoulli 模型案例，您将亲身体验一种前沿的主动学习策略，它被广泛用于高效地优化各种流程 [@problem_id:4313130]。", "problem": "在一个系统生物医学优化任务中，您正在设计针对三种微环境条件的后续实验，以提高一个二元检测的成功率（成功为$1$，失败为$0$）。每种条件 $i \\in \\{1,2,3\\}$ 都有一个未知的成功概率 $\\theta_{i} \\in (0,1)$。您将结果建模为参数为 $\\theta_{i}$ 的独立同分布的伯努利随机变量（针对条件 $i$），并为每个 $\\theta_{i}$ 设置一个贝塔先验。\n\n基本原理：\n- 在条件 $i$ 下，对于有 $S_{i}$ 次成功和 $F_{i}$ 次失败的聚合二元数据，其伯努利似然为 $p(D_{i} \\mid \\theta_{i}) \\propto \\theta_{i}^{S_{i}} (1 - \\theta_{i})^{F_{i}}$。\n- 贝塔先验满足 $p(\\theta_{i}) \\propto \\theta_{i}^{\\alpha_{i}-1} (1 - \\theta_{i})^{\\beta_{i}-1}$。\n- 贝叶斯法则给出 $p(\\theta_{i} \\mid D_{i}) \\propto p(D_{i} \\mid \\theta_{i}) p(\\theta_{i})$。\n\n您使用相同的先验 $\\theta_{i} \\sim \\mathrm{Beta}(\\alpha_{i}, \\beta_{i})$（其中 $(\\alpha_{i}, \\beta_{i}) = (1,1)$）来初始化每种条件。一项引导性研究得出了以下观测计数：\n- 条件 $1$：$S_{1} = 1$, $F_{1} = 0$。\n- 条件 $2$：$S_{2} = 0$, $F_{2} = 1$。\n- 条件 $3$：$S_{3} = 2$, $F_{3} = 0$。\n\n您打算使用汤普森采样来选择下一个要检测的条件：从每个 $\\theta_{i}$ 的后验分布中独立抽取一个样本 $\\tilde{\\theta}_{i}$，并选择其采样值最大的条件。为使采样过程可复现，您将使用逆变换采样法，并提供如下独立的均匀分布随机变量 $u_{i} \\sim \\mathrm{Uniform}(0,1)$：\n- $u_{1} = 0.36$\n- $u_{2} = 0.49$\n- $u_{3} = 0.20$\n\n任务：\n1. 在观测到引导性研究数据后，使用贝叶斯法则和上述定义，推导每个 $\\theta_{i}$ 的后验分布。\n2. 利用当贝塔分布的第一个或第二个参数等于 $1$ 时，其累积分布函数会简化并存在闭式反函数这一事实，使用逆变换采样法，根据给定的 $u_{i}$ 和任务 $1$ 中的后验分布，计算采样值 $\\tilde{\\theta}_{i}$。\n3. 在汤普森采样下，确定下一个要检测的条件的索引 $i \\in \\{1,2,3\\}$，即 $\\tilde{\\theta}_{i}$ 值最大的那个条件。\n\n答案格式要求：\n- 仅报告所选条件的单个索引 $i$ 作为您的最终答案。无需四舍五入，也无需单位。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取给定条件**\n\n- **模型：**三个条件 $i \\in \\{1,2,3\\}$，其成功概率 $\\theta_{i} \\in (0,1)$ 未知。结果被建模为参数为 $\\theta_{i}$ 的独立伯努利试验。\n- **似然：**对于 $S_{i}$ 次成功和 $F_{i}$ 次失败，其似然为 $p(D_{i} \\mid \\theta_{i}) \\propto \\theta_{i}^{S_{i}} (1 - \\theta_{i})^{F_{i}}$。\n- **先验：**为每个 $\\theta_{i}$ 设置一个贝塔先验，$p(\\theta_{i}) \\propto \\theta_{i}^{\\alpha_{i}-1} (1 - \\theta_{i})^{\\beta_{i}-1}$。\n- **贝叶斯法则：**$p(\\theta_{i} \\mid D_{i}) \\propto p(D_{i} \\mid \\theta_{i}) p(\\theta_{i})$。\n- **初始先验：**对于每个条件，先验为 $\\theta_{i} \\sim \\mathrm{Beta}(\\alpha_{i}, \\beta_{i})$，其中 $(\\alpha_{i}, \\beta_{i}) = (1,1)$。\n- **引导性研究数据：**\n  - 条件 $1$：$S_{1} = 1$, $F_{1} = 0$。\n  - 条件 $2$：$S_{2} = 0$, $F_{2} = 1$。\n  - 条件 $3$：$S_{3} = 2$, $F_{3} = 0$。\n- **采样方法：**汤普森采样，需要从每个后验分布 $p(\\theta_{i} \\mid D_{i})$ 中抽取一个样本 $\\tilde{\\theta}_{i}$。选择 $\\tilde{\\theta}_{i}$ 最大的条件。\n- **随机变量：**通过逆变换采样法，使用独立的均匀分布随机变量 $u_{i} \\sim \\mathrm{Uniform}(0,1)$ 进行采样：\n  - $u_{1} = 0.36$\n  - $u_{2} = 0.49$\n  - $u_{3} = 0.20$\n- **提示：**当贝塔分布的第一个或第二个参数等于 $1$ 时，其累积分布函数（CDF）有闭式反函数。\n- **任务：**\n  1. 推导每个 $\\theta_{i}$ 的后验分布。\n  2. 使用逆变换采样法计算采样值 $\\tilde{\\theta}_{i}$。\n  3. 确定 $\\tilde{\\theta}_{i}$ 值最大的条件的索引 $i$。\n\n**步骤 2：使用提取的给定条件进行验证**\n\n- **科学依据：**该问题基于标准的贝叶斯统计学和机器学习原理。贝塔-伯努利共轭先验模型是建模率和比例的基本工具。汤普森采样是用于强化学习和最优实验设计的先进算法。逆变换采样是生成随机变量的基本方法。将其应用于系统生物医学中的优化实验是一个有效且常见的用例。\n- **良态问题：**所有必需的组成部分都已提供：先验、数据、明确的信念更新规则（贝叶斯法则）、明确的决策协议（汤普森采样），以及采样方法的具体输入（$u_i$）。任务定义明确，并能导向唯一解。\n- **客观性：**该问题以精确、正式的语言陈述，没有主观性或歧义。\n\n该问题没有验证清单中列出的任何缺陷。它在科学上是合理的、自洽的且是良态的。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。将提供解答。\n\n### 解答\n\n**任务 1：推导后验分布**\n\n贝塔分布是伯努利似然的共轭先验。给定先验分布 $\\theta \\sim \\mathrm{Beta}(\\alpha, \\beta)$ 以及包含 $S$ 次成功和 $F$ 次失败的数据，后验分布由下式给出：\n$$\np(\\theta \\mid S, F) \\sim \\mathrm{Beta}(\\alpha + S, \\beta + F)\n$$\n对于每种条件 $i \\in \\{1,2,3\\}$，初始先验给定为 $\\theta_{i} \\sim \\mathrm{Beta}(\\alpha_{i}, \\beta_{i})$，其中 $\\alpha_{i}=1$ 且 $\\beta_{i}=1$。我们用相应的引导性研究数据更新这些先验中的每一个。\n\n对于条件 1：\n- 先验：$\\theta_{1} \\sim \\mathrm{Beta}(1, 1)$。\n- 数据：$S_{1} = 1$, $F_{1} = 0$。\n- 后验参数：$\\alpha'_{1} = \\alpha_{1} + S_{1} = 1 + 1 = 2$, $\\beta'_{1} = \\beta_{1} + F_{1} = 1 + 0 = 1$。\n- 后验分布：$p(\\theta_{1} \\mid D_{1}) \\sim \\mathrm{Beta}(2, 1)$。\n\n对于条件 2：\n- 先验：$\\theta_{2} \\sim \\mathrm{Beta}(1, 1)$。\n- 数据：$S_{2} = 0$, $F_{2} = 1$。\n- 后验参数：$\\alpha'_{2} = \\alpha_{2} + S_{2} = 1 + 0 = 1$, $\\beta'_{2} = \\beta_{2} + F_{2} = 1 + 1 = 2$。\n- 后验分布：$p(\\theta_{2} \\mid D_{2}) \\sim \\mathrm{Beta}(1, 2)$。\n\n对于条件 3：\n- 先验：$\\theta_{3} \\sim \\mathrm{Beta}(1, 1)$。\n- 数据：$S_{3} = 2$, $F_{3} = 0$。\n- 后验参数：$\\alpha'_{3} = \\alpha_{3} + S_{3} = 1 + 2 = 3$, $\\beta'_{3} = \\beta_{3} + F_{3} = 1 + 0 = 1$。\n- 后验分布：$p(\\theta_{3} \\mid D_{3}) \\sim \\mathrm{Beta}(3, 1)$。\n\n**任务 2：计算采样值 $\\tilde{\\theta}_{i}$**\n\n逆变换采样需要找到累积分布函数（CDF）的反函数 $F^{-1}$。对于贝塔分布，CDF 是正则化不完全贝塔函数，$F(x; \\alpha, \\beta) = I_x(\\alpha, \\beta)$。我们需要解方程 $I_{\\tilde{\\theta}}(\\alpha, \\beta) = u$ 以求得 $\\tilde{\\theta}$。题目提示了当其中一个参数为 $1$ 时的特殊情况。\n\n情况 1：$\\mathrm{Beta}(\\alpha, 1)$ 分布。\n其概率密度函数（PDF）为 $p(x;\\alpha,1) = \\alpha x^{\\alpha-1}$，其中 $x \\in (0,1)$。\n其累积分布函数（CDF）为 $F(x;\\alpha,1) = \\int_{0}^{x} \\alpha t^{\\alpha-1} dt = x^{\\alpha}$。\n令 $F(\\tilde{\\theta}) = u$ 得到 $\\tilde{\\theta}^{\\alpha} = u$，所以逆CDF为 $F^{-1}(u) = u^{1/\\alpha}$。\n\n情况 2：$\\mathrm{Beta}(1, \\beta)$ 分布。\n其概率密度函数（PDF）为 $p(x;1, \\beta) = \\beta (1-x)^{\\beta-1}$，其中 $x \\in (0,1)$。\n其累积分布函数（CDF）为 $F(x;1,\\beta) = \\int_{0}^{x} \\beta(1-t)^{\\beta-1} dt = [-(1-t)^{\\beta}]_{0}^{x} = 1 - (1-x)^{\\beta}$。\n令 $F(\\tilde{\\theta}) = u$ 得到 $1 - (1-\\tilde{\\theta})^{\\beta} = u$，所以 $(1-\\tilde{\\theta})^{\\beta} = 1-u$，这给出了逆CDF $F^{-1}(u) = 1 - (1-u)^{1/\\beta}$。\n\n现在，我们将这些公式应用于我们的后验分布，并使用给定的均匀分布随机变量 $u_i$。\n\n对于条件 1：\n- 后验：$\\mathrm{Beta}(2, 1)$。这属于情况 1，其中 $\\alpha'_{1} = 2$。\n- 均匀随机变量：$u_{1} = 0.36$。\n- 采样值：$\\tilde{\\theta}_{1} = (u_{1})^{1/\\alpha'_{1}} = (0.36)^{1/2} = \\sqrt{0.36} = 0.6$。\n\n对于条件 2：\n- 后验：$\\mathrm{Beta}(1, 2)$。这属于情况 2，其中 $\\beta'_{2} = 2$。\n- 均匀随机变量：$u_{2} = 0.49$。\n- 采样值：$\\tilde{\\theta}_{2} = 1 - (1-u_{2})^{1/\\beta'_{2}} = 1 - (1-0.49)^{1/2} = 1 - (0.51)^{1/2}$。\n\n对于条件 3：\n- 后验：$\\mathrm{Beta}(3, 1)$。这属于情况 1，其中 $\\alpha'_{3} = 3$。\n- 均匀随机变量：$u_{3} = 0.20$。\n- 采样值：$\\tilde{\\theta}_{3} = (u_{3})^{1/\\alpha'_{3}} = (0.20)^{1/3} = \\sqrt[3]{0.20}$。\n\n**任务 3：确定所选条件**\n\n根据汤普森采样，我们选择使采样值 $\\tilde{\\theta}_{i}$ 最大化的条件 $i$。我们必须比较 $\\tilde{\\theta}_{1}$、$\\tilde{\\theta}_{2}$ 和 $\\tilde{\\theta}_{3}$ 的值。\n\n- $\\tilde{\\theta}_{1} = 0.6$。\n- $\\tilde{\\theta}_{2} = 1 - \\sqrt{0.51}$。\n- $\\tilde{\\theta}_{3} = \\sqrt[3]{0.20}$。\n\n让我们比较 $\\tilde{\\theta}_{1}$ 与 $\\tilde{\\theta}_{2}$ 和 $\\tilde{\\theta}_{3}$。\n\n$\\tilde{\\theta}_{1}$ 和 $\\tilde{\\theta}_{2}$ 的比较：\n我们想确定 $\\tilde{\\theta}_{1} - \\tilde{\\theta}_{2} = 0.6 - (1 - \\sqrt{0.51}) = \\sqrt{0.51} - 0.4$ 的符号。\n我们可以通过对两个正数取平方来进行比较：$(\\sqrt{0.51})^2 = 0.51$ 且 $(0.4)^2 = 0.16$。\n由于 $0.51 > 0.16$，因此 $\\sqrt{0.51} > 0.4$。\n所以，$\\tilde{\\theta}_{1} - \\tilde{\\theta}_{2} > 0$，这意味着 $\\tilde{\\theta}_{1} > \\tilde{\\theta}_{2}$。\n\n$\\tilde{\\theta}_{1}$ 和 $\\tilde{\\theta}_{3}$ 的比较：\n我们想比较 $\\tilde{\\theta}_{1} = 0.6$ 和 $\\tilde{\\theta}_{3} = (0.20)^{1/3}$。\n我们可以通过对两个正数取立方来进行比较：$(\\tilde{\\theta}_{1})^3 = (0.6)^3 = 0.216$ 且 $(\\tilde{\\theta}_{3})^3 = ((0.20)^{1/3})^3 = 0.20$。\n由于 $0.216 > 0.20$，因此 $0.6 > (0.20)^{1/3}$。\n所以，$\\tilde{\\theta}_{1} > \\tilde{\\theta}_{3}$。\n\n由于 $\\tilde{\\theta}_{1}$ 大于 $\\tilde{\\theta}_{2}$ 和 $\\tilde{\\theta}_{3}$，因此它是三个样本中的最大值。\n$$\n\\tilde{\\theta}_{1} = \\max(\\tilde{\\theta}_{1}, \\tilde{\\theta}_{2}, \\tilde{\\theta}_{3})\n$$\n因此，在汤普森采样下，下一个要检测的条件是条件 $1$。其索引为 $i=1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "4313130"}]}