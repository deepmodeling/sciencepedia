{"hands_on_practices": [{"introduction": "掌握从图结构中读取条件独立性的能力，是有效利用贝叶斯和因果网络的基石。此练习将通过d-分离（d-separation）准则，帮助你理解变量间的依赖关系如何由图的路径决定，特别是被称为“对撞”（collider）的特殊结构。通过分析一个简单的基因调控模型[@problem_id:4318044]，你将学会如何判断变量之间是否存在（条件）独立关系。", "problem": "一位研究人员将一个细胞基因调控情景建模为一个贝叶斯网络（BN）中的有向无环图（DAG），其节点包括基因表达潜能 $G$、外部刺激 $S$ 和测得的信使RNA表达 $E$。该图具有有向边 $G \\to E$、$S \\to E$ 和 $G \\to S$。假设在马尔可夫性质和常用的忠实性假设下，使用标准的贝叶斯网络语义。该研究人员希望使用d-分离的概念来判断结构性条件独立关系，其定义如下：如果路径上存在一个非对撞节点位于条件集中，或者路径上存在一个对撞节点，且该对撞节点及其任何后代都不在条件集中，则两个变量之间的路径被该条件集阻断；否则该路径是连通的。在马尔可夫和忠实性假设下，d-分离意味着条件独立。\n\n基于此，请确定在给定的DAG中，$(G, S, E)$ 之间哪些独立关系成立，并解释其对撞结构。选择唯一最佳选项。\n\nA. $G \\perp S$ 和 $G \\perp S \\mid E$ 均成立；$E$ 是一个对撞节点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$。\n\nB. $G \\not\\perp S$ 但 $G \\perp S \\mid E$ 成立；$E$ 是一个对撞节点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$，使得 $G$ 和 $S$ 之间没有连通路径。\n\nC. $G \\not\\perp S$ 和 $G \\not\\perp S \\mid E$ 均成立；$E$ 是路径 $G \\to E \\leftarrow S$ 上的一个对撞节点，以 $E$ 为条件打开了该对撞路径，同时直接边 $G \\to S$ 仍然是一条连通路径。\n\nD. $G \\perp S$ 但 $G \\not\\perp S \\mid E$ 成立；$E$ 是一个对撞节点，以 $E$ 为条件打开了路径 $G \\to E \\leftarrow S$。", "solution": "### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **模型：** 一个代表贝叶斯网络（BN）的有向无环图（DAG）。\n- **节点：**\n    - $G$：基因表达潜能\n    - $S$：外部刺激\n    - $E$：测得的信使RNA表达\n- **有向边：** 图结构由边 $G \\to E$、$S \\to E$ 和 $G \\to S$ 定义。\n- **假设：**\n    - 标准贝叶斯网络语义。\n    - 应用于DAG的马尔可夫性质。\n    - 忠实性假设。\n- **关键定义（d-分离）：** 如果满足以下任一条件，则两个变量之间的路径被一个条件集阻断：\n    1. 路径上存在一个位于条件集中的非对撞节点，或者\n    2. 路径上存在一个对撞节点，且该对撞节点及其任何后代都不在条件集中。\n    否则，路径是连通的。\n- **推断规则：** 在所述假设下，d-分离意味着条件独立。根据忠实性假设，反之亦然：条件独立意味着d-分离。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据验证标准评估问题陈述：\n\n- **科学上合理：** 该问题使用了图模型和贝叶斯统计领域的标准、成熟概念（DAG、BN、d-分离、马尔可夫性质、忠实性）。其在基因调控中的应用是系统生物学中一个常见且恰当的应用案例。该模型虽是简化模型，但为了阐述这些原理，它在科学上是合理的。\n- **提法明确：** 该问题提供了一个完全指定的DAG和一条用于确定条件独立的精确规则（d-分离）。问题清晰无歧义，要求从给定结构中确定一组特定的关系，这会导出一个唯一解。\n- **客观性：** 该问题以统计学和计算机科学中常见的精确、形式化的语言陈述。它不含主观或模棱两可的术语。\n\n该问题没有表现出任何缺陷，如科学不合理、信息缺失或逻辑矛盾。由边 $G \\to S$、$G \\to E$ 和 $S \\to E$ 给出的DAG确实是无环的。前提条件是一致且充分的，足以得出一个确定的答案。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。将推导完整解答。\n\n### 解答推导\n\n该问题要求我们确定给定贝叶斯网络中节点 $G$、$S$ 和 $E$ 之间的独立关系。网络结构是一个DAG，节点为 $\\{G, S, E\\}$，有向边为 $\\{G \\to S, G \\to E, S \\to E\\}$。我们使用d-分离原理来评估独立性。如果两个节点之间的所有路径都被阻断，则它们是独立的（或条件独立的）。\n\n**1. $G$ 与 $S$ 之间路径的分析**\n\n节点 $G$ 和节点 $S$ 之间有两条路径：\n- **路径 1：** 直接边 $G \\to S$。\n- **路径 2：** 路径 $G \\to E \\leftarrow S$。\n\n**2. 边际独立性 $G \\perp S$ 的分析**\n\n为检验边际独立性，我们使用空条件集 $\\emptyset$。我们必须检查 $G$ 和 $S$ 之间的所有路径是否被 $\\emptyset$ 阻断。\n\n- **路径 1 ($G \\to S$)：** 这是一条直接的连通路径。长度为 1 的路径不能被空集阻断，因为它上面没有中间节点（对撞节点或非对撞节点）。因此，该路径是**连通的**。\n- **路径 2 ($G \\to E \\leftarrow S$)：** 在此路径上，节点 $E$ 是一个**对撞节点**，因为有两条箭头指向它（$G \\to E$ 和 $S \\to E$）。根据d-分离规则，如果对撞节点及其任何后代都不在条件集中，则包含对撞节点的路径被阻断。在这里，条件集是 $\\emptyset$。对撞节点是 $E$。$E$ 不在 $\\emptyset$ 中。在此图中，节点 $E$ 没有后代。因此，满足阻断条件。该路径是**被阻断的**。\n\n由于路径 1 ($G \\to S$) 是连通的，所以并非所有 $G$ 和 $S$ 之间的路径都被阻断。因此，$G$ 和 $S$ 不是d-分离的。在忠实性假设下，这意味着它们不是边际独立的：$G \\not\\perp S$。\n\n**3. 条件独立性 $G \\perp S \\mid E$ 的分析**\n\n为检验给定 $E$ 的条件独立性，我们使用条件集 $\\{E\\}$。我们必须检查 $G$ 和 $S$ 之间的所有路径是否被 $\\{E\\}$ 阻断。\n\n- **路径 1 ($G \\to S$)：** 该路径不包含任何中间节点。条件变量 $E$ 不在此路径上。因此，以 $E$ 为条件对此路径没有影响。它仍然是**连通的**。\n- **路径 2 ($G \\to E \\leftarrow S$)：** 此路径包含对撞节点 $E$。d-分离规则规定，*除非*对撞节点或其后代在条件集中，否则对撞路径被阻断。在这里，对撞节点 $E$ *在*条件集 $\\{E\\}$ 中。因此，以 $E$ 为条件会**解除阻断**或**打开**此路径。该路径变为**连通的**。这是一个经典的“解释消除”效应：了解一个共同效应（$E$）的值可以在其原因（$G$ 和 $S$）之间引入依赖关系。\n\n由于在以 $E$ 为条件时，路径 1 和路径 2 都是连通的，因此 $G$ 和 $S$ 没有被 $E$ d-分离。在忠实性假设下，这意味着它们在给定 $E$ 的条件下不是条件独立的：$G \\not\\perp S \\mid E$。\n\n**研究结果摘要：**\n- 边际独立性：$G \\not\\perp S$。\n- 条件独立性：$G \\not\\perp S \\mid E$。\n- 对撞结构：节点 $E$ 是路径 $G \\to E \\leftarrow S$ 上的一个对撞节点。\n\n### 选项评估\n\n现在，我们根据我们的推导来评估每个选项。\n\n**A. $G \\perp S$ 和 $G \\perp S \\mid E$ 均成立；$E$ 是一个对撞节点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$。**\n- “$G \\perp S$ ... 成立”的陈述是**错误的**。我们发现 $G \\not\\perp S$。\n- “$G \\perp S \\mid E$ ... 成立”的陈述是**错误的**。我们发现 $G \\not\\perp S \\mid E$。\n- “以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$”的陈述是**错误的**。以对撞节点为条件会*解除阻断*该路径。\n因此，该选项是**错误的**。\n\n**B. $G \\not\\perp S$ 但 $G \\perp S \\mid E$ 成立；$E$ 是一个对撞节点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$，使得 $G$ 和 $S$ 之间没有连通路径。**\n- “$G \\not\\perp S$”的陈述是正确的。\n- “$G \\perp S \\mid E$ 成立”的陈述是**错误的**。我们发现 $G \\not\\perp S \\mid E$。\n- “以 $E$ 为条件阻断了路径”的陈述是**错误的**。\n- 短语“使得 $G$ 和 $S$ 之间没有连通路径”是**错误的**，因为路径 $G \\to S$ 保持连通，而路径 $G \\to E \\leftarrow S$ 变为连通。\n因此，该选项是**错误的**。\n\n**C. $G \\not\\perp S$ 和 $G \\not\\perp S \\mid E$ 均成立；$E$ 是路径 $G \\to E \\leftarrow S$ 上的一个对撞节点，以 $E$ 为条件打开了该对撞路径，同时直接边 $G \\to S$ 仍然是一条连通路径。**\n- “$G \\not\\perp S$ ... 成立”的陈述是**正确的**。\n- “$G \\not\\perp S \\mid E$ ... 成立”的陈述是**正确的**。\n- “$E$ 是路径 $G \\to E \\leftarrow S$ 上的一个对撞节点”的描述是**正确的**。\n- “以 $E$ 为条件打开了该对撞路径”的解释是**正确的**。\n- “直接边 $G \\to S$ 仍然是一条连通路径”的解释是**正确的**。\n该选项根据我们的分析，准确地描述了 $G$ 和 $S$ 之间关系的所有方面。因此，该选项是**正确的**。\n\n**D. $G \\perp S$ 但 $G \\not\\perp S \\mid E$ 成立；$E$ 是一个对撞节点，以 $E$ 为条件打开了路径 $G \\to E \\leftarrow S$。**\n- “$G \\perp S$ ... 成立”的陈述是**错误的**。由于存在直接边，我们发现 $G \\not\\perp S$。\n- 该陈述的其余部分，“$G \\not\\perp S \\mid E$ 成立”以及所给出的理由是正确的，但初始前提是错误的。\n因此，该选项是**错误的**。", "answer": "$$\\boxed{C}$$", "id": "4318044"}, {"introduction": "理论上的概念如果不在实践中加以体会，往往难以深入理解，对撞偏倚（collider bias）便是如此。错误地对一个对撞节点进行条件控制，可能会在原本独立的变量间凭空制造出关联，甚至扭转真实的关联方向。这个练习[@problem_id:4318057]提供了一个具体的线性高斯模型，让你亲手计算并量化这种偏倚，从而深刻体会“解释得通”效应的危险。", "problem": "在一项关于炎症反应的系统生物医学研究中，考虑一个因果数据生成过程，该过程被建模为一个线性高斯结构因果模型 (SCM)。设 $U$ 是一个未被观测到的全身性炎症因子，它影响两个循环生物标志物 $X$ 和 $Y$。一个分诊评分 $Z$ 由这两个生物标志物计算得出，并用于入院决策。其因果结构由一个有向无环图给出，箭头为 $U \\to X$，$U \\to Y$，$X \\to Z$ 和 $Y \\to Z$，因此 $Z$ 是 $X$ 和 $Y$ 的一个对撞因子。假设这些变量由以下具有独立高斯噪声的线性系统生成：\n$$\nU \\sim \\mathcal{N}(0,1), \\quad \\varepsilon_{1} \\sim \\mathcal{N}(0,1), \\quad \\varepsilon_{2} \\sim \\mathcal{N}(0,1), \\quad \\varepsilon_{3} \\sim \\mathcal{N}\\!\\left(0,\\tfrac{1}{10}\\right),\n$$\n$$\nX = U + \\varepsilon_{1}, \\quad Y = U + \\varepsilon_{2}, \\quad Z = X + Y + \\varepsilon_{3},\n$$\n其中所有四个噪声项相互独立，并且独立于 $U$。\n\n仅使用关于多元正态变量的期望、方差、协方差和相关性的基本定义和经过充分检验的事实，完成以下任务：\n\n1) 确定 $X$ 和 $Y$ 之间的边际 Pearson 相关性并说明其符号。\n\n2) 一位分析师错误地对对撞因子 $Z$ 进行了调整。在这个线性高斯设置中，计算在给定 $Z$ 的条件下 $X$ 和 $Y$ 之间的 Pearson 相关性。将这个虚假的条件相关性报告为一个精确的实数。\n\n你的最终答案必须是第 2) 部分中得到的虚假条件相关性的单一数值。不涉及单位。不要四舍五入；请提供精确值。", "solution": "用户提供了一个关于线性高斯结构因果模型 (SCM) 的问题陈述，并要求计算一个边际相关性和一个条件相关性。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n问题提供了以下信息：\n- 由有向无环图定义的因果结构：$U \\to X$，$U \\to Y$，$X \\to Z$，$Y \\to Z$。\n- 一组结构方程：\n  - $X = U + \\varepsilon_{1}$\n  - $Y = U + \\varepsilon_{2}$\n  - $Z = X + Y + \\varepsilon_{3}$\n- 外生变量的分布：\n  - $U \\sim \\mathcal{N}(0,1)$\n  - $\\varepsilon_{1} \\sim \\mathcal{N}(0,1)$\n  - $\\varepsilon_{2} \\sim \\mathcal{N}(0,1)$\n  - $\\varepsilon_{3} \\sim \\mathcal{N}(0,\\frac{1}{10})$\n- 一个独立性假设：$U, \\varepsilon_{1}, \\varepsilon_{2}, \\varepsilon_{3}$ 相互独立。\n\n**步骤 2：使用提取的给定信息进行验证**\n- **科学依据**：该问题基于结构因果模型这一成熟的框架，这是统计学、计量经济学和系统生物学中用于建模因果关系的标准工具。所描述的模型是一个用于说明混杂和对撞偏误的典型例子。它在科学上是合理的。\n- **适定性**：该问题是适定的。变量 $(X, Y, Z)$ 是独立高斯变量的线性组合，这意味着它们构成一个多元正态分布。对于这样的分布，所有的边际和条件相关性都是唯一定义的，并且可以从协方差矩阵计算得出。\n- **客观性**：问题使用精确的数学语言陈述，没有主观或含糊的术语。\n- 问题是自洽的、一致的，并且不违反任何物理或数学原理。这是因果推断中的一个标准练习。\n\n**步骤 3：结论与行动**\n问题是有效的。现在将推导求解过程。\n\n### 求解推导\n\n求解过程需要计算两个量：边际相关性 $\\operatorname{Corr}(X, Y)$ 和条件相关性 $\\operatorname{Corr}(X, Y | Z)$。最终答案是第二个量的值。\n\n两个随机变量 $A$ 和 $B$ 之间的 Pearson 相关系数定义为 $\\operatorname{Corr}(A, B) = \\frac{\\operatorname{Cov}(A, B)}{\\sqrt{\\operatorname{Var}(A) \\operatorname{Var}(B)}}$。\n\n首先，我们确定变量 $X$ 和 $Y$ 的均值、方差和协方差。\n均值为：\n$E[X] = E[U + \\varepsilon_{1}] = E[U] + E[\\varepsilon_{1}] = 0 + 0 = 0$。\n$E[Y] = E[U + \\varepsilon_{2}] = E[U] + E[\\varepsilon_{2}] = 0 + 0 = 0$。\n\n方差是使用源变量的独立性计算的：\n$\\operatorname{Var}(X) = \\operatorname{Var}(U + \\varepsilon_{1}) = \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_{1}) = 1 + 1 = 2$。\n$\\operatorname{Var}(Y) = \\operatorname{Var}(U + \\varepsilon_{2}) = \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_{2}) = 1 + 1 = 2$。\n\n$X$ 和 $Y$ 之间的协方差为：\n$\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(U + \\varepsilon_{1}, U + \\varepsilon_{2})$。\n使用协方差的双线性和 $U, \\varepsilon_{1}, \\varepsilon_{2}$ 的相互独立性：\n$\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(U, U) + \\operatorname{Cov}(U, \\varepsilon_{2}) + \\operatorname{Cov}(\\varepsilon_{1}, U) + \\operatorname{Cov}(\\varepsilon_{1}, \\varepsilon_{2})$\n$\\operatorname{Cov}(X, Y) = \\operatorname{Var}(U) + 0 + 0 + 0 = 1$。\n\n**1) $X$ 和 $Y$ 之间的边际相关性**\n\n使用上面推导出的量：\n$$\n\\operatorname{Corr}(X, Y) = \\frac{\\operatorname{Cov}(X, Y)}{\\sqrt{\\operatorname{Var}(X) \\operatorname{Var}(Y)}} = \\frac{1}{\\sqrt{2 \\cdot 2}} = \\frac{1}{2}\n$$\n边际相关性为正，这是预料之中的，因为 $U$ 是 $X$ 和 $Y$ 的共同原因。\n\n**2) 在给定 $Z$ 的条件下 $X$ 和 $Y$ 之间的虚假相关性**\n\n由于 $(X, Y, Z)$ 是联合高斯分布，在给定 $Z$ 的条件下 $X$ 和 $Y$ 之间的相关性就是偏相关性 $\\rho_{XY \\cdot Z}$，可以使用以下公式计算：\n$$\n\\rho_{XY \\cdot Z} = \\frac{\\rho_{XY} - \\rho_{XZ}\\rho_{YZ}}{\\sqrt{(1 - \\rho_{XZ}^2)(1 - \\rho_{YZ}^2)}}\n$$\n其中 $\\rho_{AB}$ 表示 $\\operatorname{Corr}(A, B)$。我们已经求得 $\\rho_{XY} = \\frac{1}{2}$。现在我们需要计算 $\\rho_{XZ}$ 和 $\\rho_{YZ}$。这需要 $Z$ 的方差以及协方差 $\\operatorname{Cov}(X, Z)$ 和 $\\operatorname{Cov}(Y, Z)$。\n\n首先，用独立源变量表示 $Z$：\n$Z = X + Y + \\varepsilon_{3} = (U + \\varepsilon_{1}) + (U + \\varepsilon_{2}) + \\varepsilon_{3} = 2U + \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3}$。\n\n$Z$ 的方差为：\n$\\operatorname{Var}(Z) = \\operatorname{Var}(2U + \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3})$\n由于 $U, \\varepsilon_{1}, \\varepsilon_{2}, \\varepsilon_{3}$ 相互独立：\n$\\operatorname{Var}(Z) = \\operatorname{Var}(2U) + \\operatorname{Var}(\\varepsilon_{1}) + \\operatorname{Var}(\\varepsilon_{2}) + \\operatorname{Var}(\\varepsilon_{3}) = 2^2\\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_{1}) + \\operatorname{Var}(\\varepsilon_{2}) + \\operatorname{Var}(\\varepsilon_{3})$\n$\\operatorname{Var}(Z) = 4(1) + 1 + 1 + \\frac{1}{10} = 6 + \\frac{1}{10} = \\frac{61}{10}$。\n\n现在，我们计算协方差 $\\operatorname{Cov}(X, Z)$：\n$\\operatorname{Cov}(X, Z) = \\operatorname{Cov}(X, X + Y + \\varepsilon_{3}) = \\operatorname{Cov}(X, X) + \\operatorname{Cov}(X, Y) + \\operatorname{Cov}(X, \\varepsilon_{3})$\n$\\operatorname{Cov}(X, Z) = \\operatorname{Var}(X) + \\operatorname{Cov}(X, Y) + \\operatorname{Cov}(U + \\varepsilon_{1}, \\varepsilon_{3})$\n由于 $U$ 和 $\\varepsilon_{1}$ 独立于 $\\varepsilon_{3}$，所以 $\\operatorname{Cov}(U + \\varepsilon_{1}, \\varepsilon_{3}) = 0$。\n$\\operatorname{Cov}(X, Z) = 2 + 1 + 0 = 3$。\n\n根据模型结构中关于 $X$ 和 $Y$ 的对称性，我们可以推断出 $\\operatorname{Cov}(Y, Z) = 3$。让我们来验证一下：\n$\\operatorname{Cov}(Y, Z) = \\operatorname{Cov(Y, X + Y + \\varepsilon_{3})} = \\operatorname{Cov}(Y, X) + \\operatorname{Var}(Y) + \\operatorname{Cov}(Y, \\varepsilon_{3}) = 1 + 2 + 0 = 3$。\n\n现在我们可以计算相关性 $\\rho_{XZ}$ 和 $\\rho_{YZ}$：\n$$\n\\rho_{XZ} = \\operatorname{Corr}(X, Z) = \\frac{\\operatorname{Cov}(X, Z)}{\\sqrt{\\operatorname{Var(X)\\operatorname{Var}(Z)}}} = \\frac{3}{\\sqrt{2 \\cdot \\frac{61}{10}}} = \\frac{3}{\\sqrt{\\frac{61}{5}}}\n$$\n$$\n\\rho_{YZ} = \\operatorname{Corr}(Y, Z) = \\frac{\\operatorname{Cov}(Y, Z)}{\\sqrt{\\operatorname{Var}(Y)\\operatorname{Var}(Z)}} = \\frac{3}{\\sqrt{2 \\cdot \\frac{61}{10}}} = \\frac{3}{\\sqrt{\\frac{61}{5}}}\n$$\n我们需要这些相关性的平方：\n$\\rho_{XZ}^2 = \\rho_{YZ}^2 = \\frac{3^2}{(\\sqrt{61/5})^2} = \\frac{9}{61/5} = \\frac{45}{61}$。\n\n现在我们将所有的相关性值代入偏相关性公式：\n$$\n\\rho_{XY \\cdot Z} = \\frac{\\rho_{XY} - \\rho_{XZ}\\rho_{YZ}}{\\sqrt{(1 - \\rho_{XZ}^2)(1 - \\rho_{YZ}^2)}} = \\frac{\\frac{1}{2} - \\left(\\frac{45}{61}\\right)}{\\sqrt{\\left(1 - \\frac{45}{61}\\right)\\left(1 - \\frac{45}{61}\\right)}} = \\frac{\\frac{1}{2} - \\frac{45}{61}}{1 - \\frac{45}{61}}\n$$\n我们计算分子和分母：\n分子：$\\frac{1}{2} - \\frac{45}{61} = \\frac{61 \\cdot 1 - 45 \\cdot 2}{122} = \\frac{61 - 90}{122} = -\\frac{29}{122}$。\n分母：$1 - \\frac{45}{61} = \\frac{61 - 45}{61} = \\frac{16}{61}$。\n\n最后，条件相关性为：\n$$\n\\rho_{XY \\cdot Z} = \\frac{-29/122}{16/61} = -\\frac{29}{122} \\cdot \\frac{61}{16}\n$$\n由于 $122 = 2 \\cdot 61$，我们可以简化：\n$$\n\\rho_{XY \\cdot Z} = -\\frac{29}{2 \\cdot 61} \\cdot \\frac{61}{16} = -\\frac{29}{2 \\cdot 16} = -\\frac{29}{32}\n$$\n这个结果展示了对撞偏误现象。对对撞因子 $Z$ 进行条件化，在 $X$ 和 $Y$ 之间引入了强的负相关性，改变了它们最初的正边际相关性。\n虚假的条件相关性恰好是 $-\\frac{29}{32}$。", "answer": "$$\\boxed{-\\frac{29}{32}}$$", "id": "4318057"}, {"introduction": "在生物系统中，未观测到的混杂因素是常态，这给因果推断带来了巨大挑战。前门准则（front-door criterion）提供了一种精妙的解决方案，允许我们在存在未观测混杂的情况下，通过一个中介变量来识别因果效应。本练习[@problem_id:4318079]将指导你应用前门调整公式，在一个模拟的信号通路中，从观测数据中计算出干预的真实效果。", "problem": "考虑系统生物医学中的一个信号模块，该模块由一个有向无环图 (DAG) 表示，其节点包括受体磷酸化 $X \\in \\{0,1\\}$、衔接蛋白活化 $M \\in \\{0,1\\}$ 和下游转录反应 $Y \\in \\{0,1\\}$。假设因果结构满足前门准则：存在一条有向路径 $X \\to M \\to Y$；可能存在一个未观测到的共同原因 $U$，它同时是 $X$ 和 $Y$ 的原因，并存在边 $U \\to X$ 和 $U \\to Y$；不存在从 $X$ 到 $Y$ 绕过 $M$ 的直接效应；并且在以 $X$ 为条件的情况下，不存在未观测到的 $M$ 和 $Y$ 的共同原因。观测分布根据经验估计如下：$p(M=1 \\mid X=1) = 0.8$，$p(M=1 \\mid X=0) = 0.2$，$p(Y=1 \\mid M=1, X) = 0.7$ (对所有 $X$)，$p(Y=1 \\mid M=0, X) = 0.1$ (对所有 $X$)，以及 $p(X=1) = 0.5$。请仅使用干预（do-算子）的语义和适用于前门准则的概率定律，从第一性原理推导 $E[Y \\mid do(X=x)]$ 的表达式（用观测数据表示），并计算因果效应差异 $E[Y \\mid do(X=1)] - E[Y \\mid do(X=0)]$。请将最终数值答案表示为不带单位的小数。", "solution": "该问题要求计算一个生物信号系统的因果效应差异 $E[Y \\mid do(X=1)] - E[Y \\mid do(X=0)]$。该系统由一个有向无环图 (DAG) 描述，涉及受体磷酸化状态 $X$、衔接蛋白活化状态 $M$、下游反应 $Y$ 以及一个未观测到的 $X$ 和 $Y$ 的共同原因 $U$。变量 $X$、$M$ 和 $Y$ 均为二元变量，取值于 $\\{0,1\\}$。对于像 $Y$ 这样的二元变量，其期望值等于其处于状态 1 的概率。因此，我们必须计算 $P(Y=1 \\mid do(X=1)) - P(Y=1 \\mid do(X=0))$。\n\n问题陈述该因果结构满足前门准则。这意味着存在一组特定的条件独立性，使我们能够从观测数据中识别出 $X$ 对 $Y$ 的因果效应，即使存在未观测到的混杂因子 $U$。指定的结构包含一条因果路径 $X \\to M \\to Y$ 和一条混杂的后门路径 $X \\leftarrow U \\to Y$。前门准则允许我们通过使用中介变量 $M$ 来估计因果效应。\n\n我们将基于 do-算子的语义和前门准则所保证的图属性，从第一性原理推导干预概率 $P(Y=y \\mid do(X=x))$ 的表达式。\n\n首先，我们通过对中介变量 $M$ 的所有状态求和来表示 $X$ 对 $Y$ 的总因果效应。由于问题陈述不存在从 $X$ 到 $Y$ 绕过 $M$ 的直接效应，所有 $X$ 对 $Y$ 的影响都必须通过 $M$ 传递。这使我们可以使用中介公式来链接因果效应：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{m} P(Y=y \\mid do(M=m)) P(M=m \\mid do(X=x)) $$\n该公式将问题分解为两个子问题：\n1.  识别 $X$ 对 $M$ 的因果效应，由 $P(M=m \\mid do(X=x))$ 给出。\n2.  识别 $M$ 对 $Y$ 的因果效应，由 $P(Y=y \\mid do(M=m))$ 给出。\n\n对于第一项 $P(M=m \\mid do(X=x))$，前门准则要求不存在从 $X$到 $M$ 的未被阻断的后门路径。给定的结构中，混杂因子 $U$ 仅影响 $X$ 和 $Y$，满足此条件。因此，$X$ 对 $M$ 的因果效应等于观测到的条件概率分布：\n$$ P(M=m \\mid do(X=x)) = P(M=m \\mid X=x) $$\n\n对于第二项 $P(Y=y \\mid do(M=m))$，$M$ 和 $Y$ 之间的关系被后门路径 $M \\leftarrow X \\leftarrow U \\to Y$ 所混杂。前门准则要求该路径可以通过以 $X$ 为条件来阻断。因此，我们可以使用后门调整公式来识别 $M$ 对 $Y$ 的因果效应，其中 $X$ 作为调整集：\n$$ P(Y=y \\mid do(M=m)) = \\sum_{x'} P(Y=y \\mid M=m, X=x') P(X=x') $$\n\n结合这两个结果，得到前门调整公式：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{m} P(M=m \\mid X=x) \\left[ \\sum_{x'} P(Y=y \\mid M=m, X=x') P(X=x') \\right] $$\n我们从问题陈述中获得了计算该量所需的所有观测概率。变量 $y$、$m$、$x$ 和 $x'$ 的取值范围是 $\\{0,1\\}$。\n\n我们首先计算内部括号中的项，它表示 $M$ 对 $Y$ 的因果效应，我们将其表示为 $P^*(Y=1 \\mid M=m) = P(Y=1 \\mid do(M=m))$。\n给定的数据是：\n- $P(X=1) = 0.5$，这意味着 $P(X=0) = 1 - 0.5 = 0.5$。\n- $P(Y=1 \\mid M=1, X) = 0.7$ (对所有 $X$)。\n- $P(Y=1 \\mid M=0, X) = 0.1$ (对所有 $X$)。\n\n对于 $m=1$：\n$$ P^*(Y=1 \\mid M=1) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=1, X=x') P(X=x') $$\n$$ P^*(Y=1 \\mid M=1) = P(Y=1 \\mid M=1, X=0)P(X=0) + P(Y=1 \\mid M=1, X=1)P(X=1) $$\n$$ P^*(Y=1 \\mid M=1) = (0.7)(0.5) + (0.7)(0.5) = 0.35 + 0.35 = 0.7 $$\n\n对于 $m=0$：\n$$ P^*(Y=1 \\mid M=0) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=0, X=x') P(X=x') $$\n$$ P^*(Y=1 \\mid M=0) = P(Y=1 \\mid M=0, X=0)P(X=0) + P(Y=1 \\mid M=0, X=1)P(X=1) $$\n$$ P^*(Y=1 \\mid M=0) = (0.1)(0.5) + (0.1)(0.5) = 0.05 + 0.05 = 0.1 $$\n\n现在我们计算 $E[Y \\mid do(X=x)] = P(Y=1 \\mid do(X=x))$，分别对 $x=1$ 和 $x=0$ 进行计算。\n\n对于 $x=1$：\n$$ P(Y=1 \\mid do(X=1)) = \\sum_{m \\in \\{0,1\\}} P(M=m \\mid X=1) P^*(Y=1 \\mid M=m) $$\n$$ P(Y=1 \\mid do(X=1)) = P(M=0 \\mid X=1)P^*(Y=1 \\mid M=0) + P(M=1 \\mid X=1)P^*(Y=1 \\mid M=1) $$\n给定 $P(M=1 \\mid X=1) = 0.8$，我们有 $P(M=0 \\mid X=1) = 1 - 0.8 = 0.2$。\n$$ P(Y=1 \\mid do(X=1)) = (0.2)(0.1) + (0.8)(0.7) = 0.02 + 0.56 = 0.58 $$\n因此，$E[Y \\mid do(X=1)] = 0.58$。\n\n对于 $x=0$：\n$$ P(Y=1 \\mid do(X=0)) = \\sum_{m \\in \\{0,1\\}} P(M=m \\mid X=0) P^*(Y=1 \\mid M=m) $$\n$$ P(Y=1 \\mid do(X=0)) = P(M=0 \\mid X=0)P^*(Y=1 \\mid M=0) + P(M=1 \\mid X=0)P^*(Y=1 \\mid M=1) $$\n给定 $P(M=1 \\mid X=0) = 0.2$，我们有 $P(M=0 \\mid X=0) = 1 - 0.2 = 0.8$。\n$$ P(Y=1 \\mid do(X=0)) = (0.8)(0.1) + (0.2)(0.7) = 0.08 + 0.14 = 0.22 $$\n因此，$E[Y \\mid do(X=0)] = 0.22$。\n\n最后，我们计算因果效应差异：\n$$ E[Y \\mid do(X=1)] - E[Y \\mid do(X=0)] = 0.58 - 0.22 = 0.36 $$\n该值表示当受体磷酸化从非活性状态被强制变为活性状态时，下游转录反应概率的平均增量。", "answer": "$$\n\\boxed{0.36}\n$$", "id": "4318079"}]}