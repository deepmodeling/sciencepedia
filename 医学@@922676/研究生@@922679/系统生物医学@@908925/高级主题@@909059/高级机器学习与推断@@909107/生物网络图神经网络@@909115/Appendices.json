{"hands_on_practices": [{"introduction": "图神经网络（GNN）的核心是信息传递机制，节点通过聚合其邻居节点的信息来迭代更新自身的表示。为了真正掌握GNN如何从网络结构中学习，亲手计算这一过程至关重要。第一个实践练习 [@problem_id:1436694] 将引导你在一个假设的蛋白质相互作用网络中，完成一个基本的信息更新步骤，从而阐明特征聚合与非线性更新如何结合以创造出更丰富的节点嵌入。", "problem": "在系统生物学领域，图神经网络 (GNN) 是从网络结构数据中学习的强大工具，例如蛋白质-蛋白质相互作用 (PPI) 网络。考虑一个简单的 GNN 模型，该模型旨在根据蛋白质之间的连接来更新其特征。\n\n我们关注 PPI 网络的一小部分，其中涉及一个中心蛋白质 Protein V，它与两个相邻蛋白质 Protein U1 和 Protein U2 相互作用。每个蛋白质都由一个二维特征向量描述。向量的第一个元素表示蛋白质的归一化表达水平，第二个元素表示其线粒体定位分数。\n\n初始特征向量如下：\n- 蛋白质 V：$h_V = [0.1, 0.9]$\n- 蛋白质 U1：$h_{U1} = [0.2, 0.3]$\n- 蛋白质 U2：$h_{U2} = [0.6, 0.1]$\n\nGNN 在单个消息传递步骤中执行更新，以找到 Protein V 的新特征向量，记为 $h'_V$。该过程包括两个阶段：\n\n1.  **聚合 (Aggregation)：** 通过对 Protein V 所有邻居的特征向量进行逐元素求和，创建一个聚合邻居向量 $h_{N(V)}$。\n2.  **更新 (Update)：** 将聚合邻居向量 $h_{N(V)}$ 与 Protein V 的原始特征向量 $h_V$ 相加，然后对结果应用逐元素的整流线性单元 (ReLU) 激活函数，从而计算出新的特征向量 $h'_V$。ReLU 函数对向量的每个分量定义为 $\\text{ReLU}(x) = \\max(0, x)$。\n\n计算 Protein V 的更新后特征向量 $h'_V$。", "solution": "给定三种蛋白质的初始特征向量：\n$$\nh_{V}=\\begin{pmatrix}0.1  0.9\\end{pmatrix},\\quad\nh_{U1}=\\begin{pmatrix}0.2  0.3\\end{pmatrix},\\quad\nh_{U2}=\\begin{pmatrix}0.6  0.1\\end{pmatrix}.\n$$\n聚合步骤：聚合邻居向量是邻居特征的逐元素和，\n$$\nh_{N(V)}=h_{U1}+h_{U2}\n=\\begin{pmatrix}0.2  0.3\\end{pmatrix}+\\begin{pmatrix}0.6  0.1\\end{pmatrix}\n=\\begin{pmatrix}0.8  0.4\\end{pmatrix}.\n$$\n更新步骤：将逐元素的 ReLU 函数应用于 $h_{V}$ 和 $h_{N(V)}$ 的和，\n$$\nh'_{V}=\\operatorname{ReLU}\\!\\big(h_{V}+h_{N(V)}\\big)\n=\\operatorname{ReLU}\\!\\left(\\begin{pmatrix}0.1  0.9\\end{pmatrix}+\\begin{pmatrix}0.8  0.4\\end{pmatrix}\\right)\n=\\operatorname{ReLU}\\!\\begin{pmatrix}0.9  1.3\\end{pmatrix}.\n$$\n由于每个分量都是正数，因此对于两个分量都有 $\\operatorname{ReLU}(x)=x$，所以\n$$\nh'_{V}=\\begin{pmatrix}0.9  1.3\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.9  1.3\\end{pmatrix}}$$", "id": "1436694"}, {"introduction": "除了理解节点特征，GNN也是预测生物网络中未知连接（即“链接预测”任务）的强大工具。然而，链接预测模型的性能在很大程度上取决于其训练方式，尤其是“负样本”（即不存在的链接）的选择。本练习 [@problem_id:1436726] 深入探讨了这一挑战，要求你分析负样本的构成，揭示为何简单的随机抽样策略可能并非最优，以及特定的网络结构如何产生对模型稳健训练至关重要的“困难负样本”。", "problem": "一个系统生物学研究小组正在训练一个图神经网络（GNN）来预测新的蛋白质-蛋白质相互作用（PPI）。所研究生物体的完整PPI网络包含`M`个蛋白质和`E`个已知的相互作用。训练过程包括向GNN提供正例（已知的相互作用）和负例（不相互作用的蛋白质对）。\n\n当前的负采样策略很简单：通过从所有不属于`E`个已知相互作用的可能蛋白质对中，均匀随机地选择一对蛋白质`(u, v)`来生成一个负例。\n\n研究人员担心这种策略如何处理特定的网络基序。他们关注一个显著的枢纽蛋白质`H`，该蛋白质已知与`N`个不同的外周蛋白质`P_1, P_2, ..., P_N`相互作用。在这个局部邻域中，唯一已知的相互作用是枢纽蛋白质`H`和每个外周蛋白质`P_i`之间的相互作用。任何两个外周蛋白质之间没有相互作用，即对于所有`i \\neq j`，`(P_i, P_j)`是一个非相互作用对。这样的蛋白质对被认为是“难分负样本”，因为这两个蛋白质共享一个共同的邻居`H`，这可能会使一个简单的模型错误地预测它们之间存在相互作用。\n\n给定`M = 6000`个蛋白质，`E = 25000`个相互作用，以及一个拥有`N = 80`个外周蛋白质的枢纽，计算单个随机选择的负样本是`(P_i, P_j)`（其中`i \\neq j`）形式的“难分负样本”对的概率。\n\n将您的答案表示为一个保留三位有效数字的实数。", "solution": "负样本是从所有不相互作用的无序蛋白质对中均匀随机抽取的。$M$个蛋白质中无序对的总数是$\\binom{M}{2}$。由于已知有$E$对相互作用，因此可用的负样本对的数量是$\\binom{M}{2} - E$。\n\n在$N$个外周蛋白质中，“难分负样本”对的数量是$i \\neq j$的无序对$(P_{i},P_{j})$的数量，即$\\binom{N}{2}$，并且根据假设，所有这样的对都是非相互作用的。\n\n因此，所求概率为\n$$\np=\\frac{\\binom{N}{2}}{\\binom{M}{2}-E}.\n$$\n代入$M=6000$，$E=25000$和$N=80$，\n$$\n\\binom{6000}{2}=\\frac{6000\\cdot 5999}{2}=17,997,000,\\quad \\binom{80}{2}=\\frac{80\\cdot 79}{2}=3,160,\n$$\n所以\n$$\np=\\frac{3160}{17,997,000-25,000}=\\frac{3160}{17,972,000}=\\frac{79}{449,300}\\approx 1.75829\\times 10^{-4}.\n$$\n保留三位有效数字，\n$$\np\\approx 1.76\\times 10^{-4}.\n$$", "answer": "$$\\boxed{1.76 \\times 10^{-4}}$$", "id": "1436726"}, {"introduction": "在系统生物学中，衡量一个计算模型的最终标准是其能否产生可通过实验验证的新颖假说。GNN对分子相互作用的预测并非终点，而是湿实验研究的起点。这项高级实践 [@problem_id:4349417] 旨在挑战你弥合计算与生物实验之间的鸿沟，要求你设计一个全面且在统计上严谨的实验方案来验证源自GNN的预测。这将促使你思考现实世界中的各种约束，例如批次效应、多重假设检验和统计功效。", "problem": "一个在多重生物网络上训练的图神经网络（GNN），其节点特征源自转录组学和磷酸化蛋白质组学数据，预测在配体刺激 $L$ 下，扰动某些源基因将通过特定的蛋白质-蛋白质相互作用边增加一个读出标记物 $Y$（例如，磷酸化的核糖体蛋白S6）。该GNN输出了一个包含 $m = 300$ 个候选边的排序列表。你计划使用成簇规律间隔短回文重复序列干扰（CRISPRi）进行湿实验验证，以扰动源基因，并通过定量免疫印迹法测量 $Y$。在 $L$ 条件下，对相同细胞系进行的预实验得出的 $Y$ 的经验方差为 $\\sigma^2 = 0.09$（标准化单位），GNN预测的感兴趣的最小效应量为 $\\delta = 0.40$（扰动条件下组均值相对于非靶向对照的增加量）。培养板可容纳 $b = 24$ 个孔，且日间的批次效应不可忽略。\n\n你必须设计一个验证方案，将模型预测与湿实验联系起来，该方案需包含适当的对照、重复和统计显著性阈值。该方案必须：\n\n- 将每个边级别的预测映射到一个可证伪的假设，其中原假设 $H_0$ 为在相应扰动下 $Y$ 的均值无变化，备择假设 $H_1$ 为 $Y$ 的均值增加至少 $\\delta$。\n- 在每个培养板上都包含阴性对照（非靶向导向RNA）和阳性对照（一个已知的、能增加 $Y$ 的配体响应性相互作用）。\n- 安排将导向RNA随机分配到孔中并对测量进行盲法操作，以避免分配偏倚和测量偏倚。\n- 使用生物学重复（跨天进行的独立培养），明确区分其与技术重复（每个培养物的多个孔），并通过将推断单位定义为生物学重复来避免伪重复。\n- 使用一个有原则的程序来控制 $m$ 个假设的多重检验问题，并声明错误率（例如，在水平 $q$ 上的错误发现率（FDR）或家族错误率）。\n- 从第一性原理出发，为验证性检验证明每个条件的样本量是合理的，以在给定的显著性水平下达到 $1 - \\beta = 0.80$ 的统计功效，并明确考虑观察到的 $\\sigma^2$ 和最小感兴趣效应量 $\\delta$。\n\n以下哪个方案在保持科学合理性和资源可行性的同时，最好地满足了这些要求？\n\nA. 在单阶段筛选所有 $m = 300$ 个预测，每个条件每板设 $n = 3$ 个孔，将孔视为独立重复，应用未经校正的双侧检验，显著性水平为 $\\alpha = 0.05$，并通过结合倍数变化阈值 $\\geq \\delta$ 和 $p  0.05$ 来确定阳性结果。仅包含一个非靶向阴性对照。无随机化，无盲法，且不对批次效应进行校正。\n\nB. 使用两阶段设计。阶段1：对所有 $m = 300$ 个预测，将导向RNA的分配在培养板和天数上进行随机化，对 $Y$ 的测量进行盲法操作，并包含每板的阴性和阳性对照。在 $r_b = 3$ 个独立的天数里，为每个条件收集 $n_s = 6$ 个生物学重复，每个生物学重复设 $r_t = 2$ 个技术孔；使用包含天作为随机效应的线性混合效应模型分析生物学重复的均值，以减轻批次变异。在 $m$ 个假设中，使用Benjamini–Hochberg方法将错误发现率（FDR）控制在 $q = 0.10$。阶段2：对阶段1中排名前 $k$ 的候选者及所有对照，进行独立的培养、随机化和盲法操作的验证性实验，并根据给定的 $\\sigma^2 = 0.09$ 和 $\\delta = 0.40$，从第一性原理计算每个条件的样本量 $n_c$，以在单侧检验 $\\alpha = 0.01$ 的条件下达到 $1 - \\beta = 0.80$ 的统计功效；使用双样本检验分析生物学重复的均值，并报告效应量及其置信区间。如果验证性 $p$ 值低于 $\\alpha$ 且估计效应 $\\geq \\delta$，则宣布已验证。\n\nC. 进行单阶段实验，每个条件设 $n = 4$ 个孔，将每个孔计为一个独立重复，并在 $m = 300$ 个检验中应用Bonferroni校正，每个检验的阈值为 $\\alpha = 0.05 / 300$。包含一个非靶向阴性对照，但省略阳性对照。不在培养板之间进行随机化；将给定预测的所有导向RNA分配到同一块板上。使用原始孔水平数据，不对批次效应进行建模。\n\nD. 使用单阶段实验，每个条件设 $n = 10$ 个生物学重复，进行随机化和盲法操作，包含阴性和阳性对照，并对每个预测使用未经校正的单侧检验，显著性水平为 $\\alpha = 0.05$。不进行多重检验校正；而是应用倍数变化筛选 $\\geq \\delta$ 并要求 $p  0.05$ 来宣布显著性。无验证性后续研究。\n\n选择最佳选项。", "solution": "该问题要求为图神经网络（GNN）的计算预测设计一个湿实验验证方案。方案的质量将根据一套关于科学和统计严谨性的具体要求进行评判。\n\n首先，我们验证问题陈述。\n\n### 步骤1：提取已知条件\n-   **模型：** 在多重生物网络上训练的图神经网络（GNN）。\n-   **GNN输入：** 源自转录组学和磷酸化蛋白质组学的节点特征。\n-   **GNN输出：** 一个包含 $m = 300$ 个候选边的排序列表，这些边被预测在配体刺激 $L$ 下扰动源基因后会增加读出标记物 $Y$。\n-   **验证技术：** CRISPRi扰动源基因。\n-   **读出测量：** 对 $Y$ 进行定量免疫印迹法测量。\n-   **预实验数据：** $Y$ 的经验方差为 $\\sigma^2 = 0.09$（标准化单位）。\n-   **效应量：** 感兴趣的最小效应量是组均值增加 $\\delta = 0.40$。\n-   **实验限制：** 培养板尺寸为 $b = 24$ 个孔；日间的批次效应不可忽略。\n-   **方案要求：**\n    1.  将预测映射到可证伪的假设（$H_0$：无变化，$H_1$：增加 $\\ge \\delta$）。\n    2.  包含每板的阴性和阳性对照。\n    3.  实施随机化和盲法操作。\n    4.  使用真正的生物学重复，与技术重复区分开，并避免伪重复。\n    5.  使用有原则的方法控制 $m=300$ 个假设的多重检验问题。\n    6.  根据给定的 $\\sigma^2$ 和 $\\delta$，为达到 $1 - \\beta = 0.80$ 的统计功效和给定的显著性水平，证明样本量的合理性。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述具有科学依据，提法得当且客观。它概述了系统生物学中一个标准且现实的场景，即通过实验验证计算预测。所有术语（GNN、CRISPRi、FDR、功效分析）都是该领域的标准术语。提供的数据（$\\sigma^2=0.09$、$\\delta=0.40$、 $m=300$）是合理的。对方案的要求符合良好实验设计和统计分析的基本原则。该问题没有科学上的不合理性、模糊性或矛盾之处。\n\n### 步骤3：结论与行动\n该问题是有效的。我们将继续分析各个选项。一个关键的定量要求是样本量计算（要求6），我们首先进行这个计算。\n\n### 基于原理的推导：样本量计算\n\n方案必须证明样本量的合理性，以达到 $1 - \\beta = 0.80$ 的统计功效来检测至少为 $\\delta = 0.40$ 的效应量。备择假设是有方向性的（$H_1$：$Y$ 增加），因此适合使用单侧统计检验。在双样本检验中，每组所需样本量 $n$ 的公式为（假设方差已知）：\n$$ n = \\frac{(\\sigma_1^2 + \\sigma_2^2) (z_{1-\\alpha} + z_{1-\\beta})^2}{\\delta^2} $$\n假设对照组和扰动组的方差相等，$\\sigma_1^2 = \\sigma_2^2 = \\sigma^2$，公式简化为：\n$$ n = \\frac{2 \\sigma^2 (z_{1-\\alpha} + z_{1-\\beta})^2}{\\delta^2} $$\n我们已知：\n-   方差：$\\sigma^2 = 0.09$，因此标准差 $\\sigma = \\sqrt{0.09} = 0.30$。\n-   效应量：$\\delta = 0.40$。\n-   统计功效：$1 - \\beta = 0.80$，对应的标准正态分位数为 $z_{1-\\beta} = z_{0.80} \\approx 0.842$。\n\n选项B指定了验证性显著性水平为 $\\alpha = 0.01$。对于单侧检验，这对应的分位数为 $z_{1-\\alpha} = z_{0.99} \\approx 2.326$。\n\n让我们计算选项B中描述的验证阶段所需的样本量 $n_c$：\n$$ n_c = \\frac{2 \\times 0.09 \\times (z_{0.99} + z_{0.80})^2}{(0.40)^2} $$\n$$ n_c = \\frac{0.18 \\times (2.326 + 0.842)^2}{0.16} $$\n$$ n_c = \\frac{0.18 \\times (3.168)^2}{0.16} $$\n$$ n_c = \\frac{0.18 \\times 10.036224}{0.16} \\approx 11.29 $$\n由于重复次数必须是整数，实验需要每个条件 $n_c = 12$ 个生物学重复（例如，扰动组12个，非靶向对照组12个）才能满足这些严格的验证标准。\n\n### 逐项分析\n\n**A. 在单阶段筛选所有 $m = 300$ 个预测，每个条件每板设 $n = 3$ 个孔，将孔视为独立重复，应用未经校正的双侧检验，显著性水平为 $\\alpha = 0.05$，并通过结合倍数变化阈值 $\\geq \\delta$ 和 $p  0.05$ 来确定阳性结果。仅包含一个非靶向阴性对照。无随机化，无盲法，且不对批次效应进行校正。**\n\n*   **要求1（假设）：** 不满足。对于有方向性的预测（“增加”），使用了双侧检验，这会降低统计功效。\n*   **要求2（对照）：** 不满足。忽略了必需的阳性对照。\n*   **要求3（偏倚控制）：** 不满足。明确指出“无随机化，无盲法”，这会导致系统性偏倚。\n*   **要求4（重复）：** 不满足。犯了将孔（技术重复）视为独立生物学重复的严重伪重复错误。\n*   **要求5（多重检验）：** 不满足。对 $m=300$ 个假设使用了“未经校正”的检验，这将导致大量的假阳性（平均为 $300 \\times 0.05 = 15$）。简单的p值加倍数变化阈值不是控制错误率的有原则的方法。\n*   **要求6（统计功效）：** 不满足。$n=3$ 的样本量是任意选择的，对于期望的统计功效来说严重不足。\n\n**结论：** 错误。该方案在根本上是不合理的，违反了稳健实验设计的每一条关键原则。\n\n**B. 使用两阶段设计。阶段1：对所有 $m = 300$ 个预测，将导向RNA的分配在培养板和天数上进行随机化，对 $Y$ 的测量进行盲法操作，并包含每板的阴性和阳性对照。在 $r_b = 3$ 个独立的天数里，为每个条件收集 $n_s = 6$ 个生物学重复，每个生物学重复设 $r_t = 2$ 个技术孔；使用包含天作为随机效应的线性混合效应模型分析生物学重复的均值，以减轻批次变异。在 $m$ 个假设中，使用Benjamini–Hochberg方法将错误发现率（FDR）控制在 $q = 0.10$。阶段2：对阶段1中排名前 $k$ 的候选者及所有对照，进行独立的培养、随机化和盲法操作的验证性实验，并根据给定的 $\\sigma^2 = 0.09$ 和 $\\delta = 0.40$，从第一性原理计算每个条件的样本量 $n_c$，以在单侧检验 $\\alpha = 0.01$ 的条件下达到 $1 - \\beta = 0.80$ 的统计功效；使用双样本检验分析生物学重复的均值，并报告效应量及其置信区间。如果验证性 $p$ 值低于 $\\alpha$ 且估计效应 $\\geq \\delta$，则宣布已验证。**\n\n*   **要求1（假设）：** 满足。验证阶段使用了单侧检验和效应量标准，直接检验了指定的假设。\n*   **要求2（对照）：** 满足。包含了阴性和阳性对照。\n*   **要求3（偏倚控制）：** 满足。明确包含了随机化和盲法操作。\n*   **要求4（重复）：** 满足。正确区分了生物学重复（$n_s=6$）和技术重复（$r_t=2$），避免了伪重复，并使用了一个精密的混合效应模型来妥善处理批次效应和数据结构。\n*   **要求5（多重检验）：** 满足。通过Benjamini-Hochberg方法控制FDR，这是对此类发现性筛选的标准且适当的方法。\n*   **要求6（统计功效）：** 满足。明确承诺从第一性原理出发计算验证阶段的样本量 $n_c$，并使用了问题陈述中给出的确切参数。两阶段设计也是一种资源利用效率高的方法。\n\n**结论：** 正确。该方案是严谨、现代实验设计的典范。它使用适当的统计方法正确地解决了所有指定的要求。\n\n**C. 进行单阶段实验，每个条件设 $n = 4$ 个孔，将每个孔计为一个独立重复，并在 $m = 300$ 个检验中应用Bonferroni校正，每个检验的阈值为 $\\alpha = 0.05 / 300$。包含一个非靶向阴性对照，但省略阳性对照。不在培养板之间进行随机化；将给定预测的所有导向RNA分配到同一块板上。使用原始孔水平数据，不对批次效应进行建模。**\n\n*   **要求1（假设）：** 部分满足，假设进行了检验。\n*   **要求2（对照）：** 不满足。忽略了阳性对照。\n*   **要求3（偏倚控制）：** 不满足。缺乏跨培养板的随机化会引入处理效应和板效应之间的混淆。未提及盲法操作。\n*   **要求4（重复）：** 不满足。存在伪重复（“将每个孔计为一个独立重复”）。\n*   **要求5（多重检验）：** 原则上满足。它使用了Bonferroni校正，这是一种有效但极其保守的控制家族错误率的方法。\n*   **要求6（统计功效）：** 不满足。在校正后的显著性水平 $\\alpha_{adj} = 0.05 / 300 \\approx 0.000167$ 和不合理的样本量 $n=4$ 的情况下，检测到任何真实效应的统计功效将极小，从而使实验变得徒劳无功。\n\n**结论：** 错误。尽管它正确地识别了多重检验问题，但其其他设计缺陷（伪重复、缺乏对照、无随机化）以及将Bonferroni校正与极小样本量相结合的不切实际的做法，使其成为一个糟糕的设计。\n\n**D. 使用单阶段实验，每个条件设 $n = 10$ 个生物学重复，进行随机化和盲法操作，包含阴性和阳性对照，并对每个预测使用未经校正的单侧检验，显著性水平为 $\\alpha = 0.05$。不进行多重检验校正；而是应用倍数变化筛选 $\\geq \\delta$ 并要求 $p  0.05$ 来宣布显著性。无验证性后续研究。**\n\n*   **要求1（假设）：** 满足。正确使用了单侧检验。\n*   **要求2（对照）：** 满足。包含了阴性和阳性对照。\n*   **要求3（偏倚控制）：** 满足。包含了随机化和盲法操作。\n*   **要求4（重复）：** 满足。正确使用了合理数量（$n=10$）的*生物学*重复。\n*   **要求5（多重检验）：** 不满足。关键的是，它明确指出“不进行多重检验校正”，这对于一个有 $m=300$ 个假设的实验来说是不可接受的。\n*   **要求6（统计功效）：** 部分满足。样本量 $n=10$ 是合理的，很可能达到足够的功效（我们对 $\\alpha=0.05$ 的计算得出 $n=7$），但该方案没有承诺从第一性原理推导它。\n\n**结论：** 错误。该方案有几个好的特点，但完全忽略多重检验校正是一个致命的缺陷，会使从筛选中得出的任何结论都无效。\n\n**结论：** 方案B是唯一一个满足了严谨、统计上合理且设计良好的验证实验所有要求的选项。它展示了对实验设计原则的深入理解，包括分阶段设计、功效分析、错误率控制和批次效应的减轻。", "answer": "$$\\boxed{B}$$", "id": "4349417"}]}