## 引言
在当今世界，从生物分子网络到社会关系，复杂的系统无处不在，其特点是存在多种类型且随时间变化的相互作用。传统的单层[网络模型](@entry_id:136956)在描述这种异质性和动态性时显得力不从心，忽略了系统丰富的多维结构。本文旨在填补这一空白，系统介绍多重网络与[时间网络分析](@entry_id:755847)这一前沿领域，为理解和操控复杂系统提供强大的理论与实践工具。

通过本文的学习，您将首先在“原理与机制”一章中掌握[多层网络](@entry_id:270365)的核心数学语言，学会如何用[超邻接矩阵](@entry_id:755671)和张量来表示系统，并理解层间耦合如何塑造网络上的动态过程。随后，在“应用与跨学科连接”一章中，我们将通过系统生物学、神经科学和流行病学等领域的真实案例，展示这些理论如何被用于整合多组学数据、解构[神经回路](@entry_id:163225)以及预测疾病传播。最后，“动手实践”部分将提供具体的计算练习，让您将理论知识转化为解决实际问题的能力。这趟旅程将带领您从基础理论出发，深入应用前沿，最终掌握分析动态复杂世界的关键技能。

## 原理与机制

在理解了[多层网络](@entry_id:270365)作为描述复杂系统不可或缺的工具之后，本章将深入探讨其核心原理与机制。我们将首先建立描述这些系统的基本数学表示法，区分不同类型的多层结构。随后，我们将探讨在这些结构上展开的动态过程，揭示层间耦合与时间依赖性如何从根本上改变系统行为。最后，我们将介绍一系列为[多层网络](@entry_id:270365)量身定制的分析方法，用于识别关键节点和功能模块。

### 多层系统的[基本表示](@entry_id:157678)

为了精确地研究多层系统，我们必须首先建立一个清晰且一致的数学框架。这需要我们严格区分表面上相似但概念上迥异的网络结构，并为它们开发合适的[代数表示](@entry_id:143783)。

#### 定义范畴：多图、多重网络与[时间网络](@entry_id:269883)

在网络科学的语境中，术语的精确性至关重要。尽管“多图”（multigraph）、“多重网络”（multiplex network）和“[时间网络](@entry_id:269883)”（temporal network）都涉及节点间的多重连接，但它们描述了截然不同的系统，其区别在于连接的“类型”和“顺序”的语义。

**多图 (Multigraph)** 是最简单的形式。在一个多图 $G = (V, E)$ 中，节点集合 $V$ 上的任意一对节点之间可以存在多条边。然而，这些平行的边在语义上是无法区分的；它们代表了同一类型关系的多次实例。例如，在[蛋白质相互作用网络](@entry_id:165520)中，两个蛋白质分子间的两条边可能仅表示实验重复，而不是两种不同类型的相互作用。因此，多图本质上是一个单层结构，其邻接矩阵的元素 $A_{ij}$ 可以是自然数，表示节点 $i$ 和 $j$ 之间的边的数量。

**多重网络 (Multiplex Network)** 则引入了关系异质性的概念。一个多重网络包含一个共享的节点集 $V$ 和一组有限的“层” $\mathcal{L} = \{1, 2, \dots, L\}$，其中每一层代表一种特定类型的关系（例如，基因调控、蛋白质相互作用、代谢催化）。层内的连接，称为**层内边 (intralayer edges)**，由每层的邻接矩阵 $A^{(\ell)}$ 描述。多重网络的一个决定性特征是其**层间边 (interlayer edges)** 的形式：它们严格地只连接同一物理实体在不同层中的副本。也就是说，层间边只能存在于节点 $(i, \ell)$ 和 $(i, m)$ 之间（其中 $\ell \neq m$），而不能存在于 $(i, \ell)$ 和 $(j, m)$ 之间（其中 $i \neq j$）。这些层代表了不同的关系类别，它们之间没有固有的顺序。因此，任意置换层的标签不会改变网络的内在含义。

**[时间网络](@entry_id:269883) (Temporal Network)** 则将时间的有序性作为其核心。一个[时间网络](@entry_id:269883)描述了连接随时间演化的系统。它可以被看作一系列按时间排序的图快照 $\{G_{t_1}, G_{t_2}, \dots, G_{t_L}\}$，其中时间点集合 $\mathcal{T}=\{t_1, \dots, t_L\}$ 是一个[全序](@entry_id:146781)集。与多重网络中可互换的层不同，[时间网络](@entry_id:269883)的“层”（即时间快照）的顺序是不可改变的，因为调换时间顺序会破坏系统的[因果结构](@entry_id:159914)。当将[时间网络](@entry_id:269883)提升为多层表示时，层间边通常用于模拟节点随时间的持续存在，最常见的模型是仅在相邻时间层之间连接节点副本，例如，连接 $(i, t_\ell)$ 和 $(i, t_{\ell+1})$。这种结构反映了时间的连续性，而非关系类型的异质性 [@problem_id:4363984]。

#### 构建模块：节点、层与副本

在[多层网络](@entry_id:270365)的形式化过程中，基本的构成单元不再是简单的节点，而是**节点-层副本 (node-layer replica)**，也称为**状态节点 (state node)**。一个节点-层副本是一个[有序对](@entry_id:269702) $(i, \alpha)$，表示物理实体（或节点）$i$ 在层 $\alpha$ 中的实例。这个概念是理解多层结构的关键，因为它将一个包含 $N$ 个节点和 $L$ 个层的系统转化为一个拥有 $N \times L$ 个状态节点的“[超图](@entry_id:270943)”（supra-graph）。

在处理真实世界的生物医学数据时，我们经常遇到并非所有物理实体都存在于每一层的情况。例如，在一个包含转录调控、蛋白质相互作用和代谢网络的多重模型中，某些基因可能不参与代谢过程。这引出了两种主要的表示约定 [@problem_id:4364016]：

1.  **部分重叠 (Partially Overlapping) 或简化嵌入 (Reduced Embedding)**：这种表示只包含数据中实际存在的节点-层副本。如果层 $\alpha$ 中的节点集为 $V_\alpha \subseteq V$，则总的状态节点数是 $\sum_{\alpha=1}^{L} |V_\alpha|$。例如，如果一个包含100个物理实体的研究中，三个层分别有80、90和70个活跃节点，那么这种表示下的总状态节点数将是 $80+90+70=240$。这种方法忠实于原始数据，但可能导致代数处理上的复杂性。

2.  **对齐 (Aligned) 或全嵌入 (Aligned Embedding)**：为了数学上的便利，我们常常采用一种对齐的表示，其中我们假设每一个物理实体 $i \in V$ 在每一层 $\alpha \in \mathcal{L}$ 中都有一个副本。那些在原始数据中不存在的节点-层副本被作为孤立节点（即在该层内没有任何连接）加入。在这种表示下，总的状态节点数总是 $|V| \times |\mathcal{L}|$。在上述例子中，这将是 $100 \times 3 = 300$ 个状态节点。这种方法虽然引入了结构上的零，但保证了[网络表示](@entry_id:752440)的高度规整性，简化了矩阵和张量运算。

#### 数学形式化：[超邻接矩阵](@entry_id:755671)与邻接张量

为了对整个多层系统进行数学分析，我们需要一个能够统一编码所有层内和层间连接的单一对象。

最直观的方法是**[超邻接矩阵](@entry_id:755671) (supra-adjacency matrix)**, 记为 $A^{\mathrm{supra}}$。这是一个 $(NL) \times (NL)$ 的巨大矩阵（在对齐表示下），其行和列索引对应于所有的状态节点 $(i, \ell)$。通过对状态节点进行[字典序](@entry_id:143032)排列（例如，先按层索引，再按节点索引），$A^{\mathrm{supra}}$ 可以被看作一个 $L \times L$ 的[块矩阵](@entry_id:148435)，其中每个块是一个 $N \times N$ 的矩阵。

- **对角块 (Diagonal Blocks)**：位于块对角线上的第 $(\ell, \ell)$ 个块是第 $\ell$ 层的层内邻接矩阵 $A^{(\ell)}$。
- **非对角块 (Off-diagonal Blocks)**：第 $(\ell, m)$ 个块（其中 $\ell \neq m$）编码了从层 $\ell$ 到层 $m$ 的层间连接。在典型的多重网络中，由于层间边仅连接节点副本，这些非对角块是[对角矩阵](@entry_id:637782)。如果所有不同层之间的副本连接强度都是一个统一的常数 $\omega > 0$，那么所有非对角块都将是 $\omega I_N$，其中 $I_N$ 是 $N \times N$ 的单位矩阵 [@problem_id:4364034]。

因此，一个具有统一对角耦合的多重网络的[超邻接矩阵](@entry_id:755671)可以写成：
$$
A^{\mathrm{supra}} =
\begin{pmatrix}
A^{[1]}  \omega I_{N}  \cdots  \omega I_{N} \\
\omega I_{N}  A^{[2]}  \cdots  \omega I_{N} \\
\vdots  \vdots  \ddots  \vdots \\
\omega I_{N}  \omega I_{N}  \cdots  A^{[L]}
\end{pmatrix}
= \operatorname{diag}(A^{[1]}, \dots, A^{[L]}) + \omega (J_L - I_L) \otimes I_N
$$
其中 $J_L$ 是全一矩阵，$\otimes$ 表示[克罗内克积](@entry_id:182766)。

一个更通用且强大的表示法是使用**四阶邻接张量 (order-4 adjacency tensor)** $\mathcal{A}$ [@problem_id:4363986]。张量元素 $\mathcal{A}_{ij\ell m}$ 定义为从状态节点 $(i, \ell)$ 到状态节点 $(j, m)$ 的边的权重。这种表示法极为灵活：
- **层内连接**：当层索引相同时（$\ell = m$），张量切片 $\mathcal{A}_{ij\ell\ell}$ 就对应于第 $\ell$ 层的[邻接矩阵](@entry_id:151010) $A^{(\ell)}_{ij}$。
- **层间连接**：当层索引不同时（$\ell \neq m$），$\mathcal{A}_{ij\ell m}$ 描述了从层 $\ell$ 的节点 $i$ 到层 $m$ 的节点 $j$ 的连接。多重网络中常见的对角耦合约束（即 $i=j$）只是这种通用表示法的一个特例，即 $\mathcal{A}_{ij\ell m} = C_{i\ell,jm} \propto \delta_{ij}$，其中 $\delta_{ij}$ 是克罗内克 delta。

[张量表示法](@entry_id:272140)为描述更复杂的场景（例如，层间连接不仅限于节点副本）提供了自然的框架。

#### 建模层间耦合

层间耦合的结构是[多层网络](@entry_id:270365)建模的核心，它直接反映了我们对不同层之间关系的假设。耦合模式的选择必须基于所研究系统的基本原理 [@problem_id:4364005]。层间耦合的强度和模式可以由一个**层[耦合矩阵](@entry_id:191757) (layer coupling matrix)** $C \in \mathbb{R}^{L \times L}$ 来描述，其中 $C_{\alpha\beta}$ 编码了层 $\alpha$ 和层 $\beta$ 之间的耦合权重。

- **无序模态 (Unordered Modalities)**：当层代表没有内在顺序的类别时（例如，多组学数据中的[转录组](@entry_id:274025)、蛋白质组和代谢组层），模型应具有**[置换不变性](@entry_id:753356)**。这意味着任意交换层的标签不应改变系统的基本属性。为了满足这一要求，任何一对不同层 $(\alpha, \beta)$ 之间的耦合强度必须是相同的。因此，层[耦合矩阵](@entry_id:191757) $C$ 的所有非对角元素都应为一个常数 $\omega$，而对角元素通常为零（$C_{\alpha\alpha}=0$），即 $C_{\alpha\beta} = \omega(1 - \delta_{\alpha\beta})$。这代表了一种全连接的、无偏好的耦合结构。

- **有序层 (Ordered Layers)**：当层代表有序的序列时，最典型的例子是[时间网络](@entry_id:269883)中的时间片。[生物过程](@entry_id:164026)或信息传播通常遵循**时间局域性**原理（例如，一阶马尔可夫依赖性），即当前状态主要受其紧邻的过去状态影响。为了在模型中体现这一点，层间耦合应主要限制在相邻层之间。在这种情况下，层[耦合矩阵](@entry_id:191757) $C$ 呈带状结构，最常见的形式是仅在主对角线两侧的第一条次对角线上有非零元素，即 $C_{tt'} = \omega$ 当且仅当 $|t-t'|=1$，否则为零。这种结构明确地编码了时间顺序和局部依赖关系，打破了[置换不变性](@entry_id:753356)。

### [多层网络](@entry_id:270365)上的动力学与过程

[多层网络](@entry_id:270365)的丰富结构为其上展开的动态过程提供了新的可能性和复杂性。无论是信息的传播、疾病的扩散还是网络自身的演化，都深受多层拓扑的影响。

#### 时间[网络动力学](@entry_id:268320)：时间尊重路径的首要性

在[时间网络](@entry_id:269883)中，连接的存在与否及其发生的时间同样重要。任何在[时间网络](@entry_id:269883)上传播的过程，无论是信号转导还是疾病感染，都必须遵循因果关系。这引出了**时间尊重路径 (time-respecting paths)** 的核心概念。一条从节点 $u$ 到节点 $v$ 的路径是时间尊重的，当且仅当构成该路径的边的（或事件的）时间戳是单调不减的。

让我们通过一个[病原体传播](@entry_id:138852)的例子来说明这一点 [@problem_id:4364038]。假设一个网络中存在一条静态路径 $s \to a \to b$。如果 $s$ 和 $a$ 之间的接触发生在时间 $t=2$，而 $a$ 和 $b$ 之间的接触发生在 $t=1$，那么感染就不可能沿着这条路径从 $s$ 传播到 $b$。信号或疾病不能“回到过去”去利用一个已经发生的接触机会。因此，在[时间网络](@entry_id:269883)中，仅仅存在拓扑上的连接并不足以保证[可达性](@entry_id:271693)。

更进一步，生物过程通常有延迟。例如，一个人被感染后，需要经过一段潜伏期才能具有传染性。假设潜伏期为 $\delta$。如果节点 $u$ 在时间 $\tau_u$ 被感染，那么它最早在 $\tau_u + \delta$ 时刻才具有传染性。任何由 $u$ 传出的感染，其接触时间 $t_{uv}$ 必须满足 $t_{uv} \ge \tau_u + \delta$。

基于这些原则，我们可以定义从源节点 $s$ 到任何其他节点 $v$ 的**最早到达时间 (Earliest Arrival Time)** $\tau_{\mathrm{EA}}(s \to v)$，即沿着所有可能的时间尊重路径，感染能够到达 $v$ 的最早时间。一个节点 $v$ 的**[可达集](@entry_id:276191) (reachable set)** 就是所有满足 $\tau_{\mathrm{EA}}(s \to v)  \infty$ 的节点的集合。静态聚合网络（即忽略所有时间戳，将所有发生过的连接合并成一个图）上的[可达性](@entry_id:271693)分析会严重高估真实传播的范围，因为它会错误地包含那些违反时间因果性的路径。

#### 全局动力学：谱特性与系统级行为

[超邻接矩阵](@entry_id:755671) $A^{\mathrm{supra}}$ 的谱特性，特别是其**[谱半径](@entry_id:138984) (spectral radius)** $\lambda_{\max}(A^{\mathrm{supra}})$，在决定整个多层系统宏观动力学行为方面扮演着核心角色 [@problem_id:4363974]。谱半径定义为矩阵所有特征值中模最大的那个。根据[Perron-Frobenius定理](@entry_id:138708)，对于一个非负且不可约的矩阵（这在连通的[多层网络](@entry_id:270365)中通常成立），其[谱半径](@entry_id:138984)是一个实数、正数且唯一的最大特征值。

考虑一个由 $A^{\mathrm{supra}}$ 控制的通用[线性动力学](@entry_id:177848)过程，例如连续时间线性扩散：
$$
\frac{d\mathbf{y}(t)}{dt} = \alpha A^{\mathrm{supra}} \mathbf{y}(t)
$$
其中 $\mathbf{y}(t)$ 是一个描述所有状态节点上某种“浓度”或“激活水平”的向量。该[线性系统](@entry_id:163135)的解是各个[特征模](@entry_id:174677)态的线性叠加，每个模态随时间的演化由 $e^{\alpha \lambda_i t}$ 决定，其中 $\lambda_i$ 是 $A^{\mathrm{supra}}$ 的特征值。系统的最快指数增长率由具有最大实部的特征值决定，而这个值正是谱半径 $\lambda_{\max}(A^{\mathrm{supra}})$。因此，系统的长期行为由 $\alpha \lambda_{\max}(A^{\mathrm{supra}})$ 主导。

在[流行病学模型](@entry_id:260705)中，[谱半径](@entry_id:138984)同样关键。对于一个在[多层网络](@entry_id:270365)上发生的易感-感染-易感（SIS）模型，其在零感染状态附近的线性化动力学可以近似为：
$$
\frac{d\mathbf{p}(t)}{dt} \approx (\beta A^{\mathrm{supra}} - \mu I) \mathbf{p}(t)
$$
其中 $\mathbf{p}(t)$ 是各状态节点的感染[概率向量](@entry_id:200434)，$\beta$ 是感染率，$\mu$ 是恢复率。疫情爆发的条件是零感染状态不稳定，即矩阵 $(\beta A^{\mathrm{supra}} - \mu I)$ 至少有一个正的实部特征值。这等价于 $\beta \lambda_{\max}(A^{\mathrm{supra}}) - \mu  0$。这个条件通常被写成**[流行病阈值](@entry_id:275627) (epidemic threshold)**：
$$
\frac{\beta}{\mu}  \frac{1}{\lambda_{\max}(A^{\mathrm{supra}})}
$$
这表明，谱半径的倒数决定了启动大规模爆发所需的最小“传染性”与“恢复性”之比。$\lambda_{\max}(A^{\mathrm{supra}})$ 越大，网络结构越有利于传播，流行病爆发的门槛就越低。

#### [网络鲁棒性](@entry_id:146798)：相互依赖与级联失效

[多层网络](@entry_id:270365)的另一个关键特性是**相互依赖性 (interdependence)**。在许多生物系统中，一个子系统（层）的正常功能依赖于另一个子系统（层）的完整性。例如，一个蛋白质要发挥功能，不仅需要它在[蛋白质相互作用网络](@entry_id:165520)（一层）中处于正确的位置，还需要编码它的基因在[基因调控网络](@entry_id:150976)（另一层）中被正常表达。

这种依赖关系从根本上改变了网络的鲁棒性。考虑一个双层网络，一个节点的存活需要它在每一层中都保持与某个功能核心的连接。如果一个节点因为在第一层中失去了所有连接而被移除，它的消失也可能导致其在第二层中的邻居变得孤立。这些新孤立的节点随后也会被移除，从而可能在第一层中引发新一轮的断连，如此往复，形成**级联失效 (cascading failures)**。

这个过程最终会收敛到一个稳定的核心，即**相互连接[巨组分](@entry_id:273002) (Mutually Connected Giant Component, MCGC)** [@problem_id:4364018]。MCGC被定义为最大的节点子集 $S$，使得由 $S$ 诱导的子图在每一层中都是连通的。也就是说，对于 $S$ 中的任意两个节点 $u, v$，必须存在一条完全由 $S$ 中节点构成的路径在第一层连接它们，**并且**存在另一条这样的路径在第二层连接它们。

MCGC的概念与聚合图的[巨组分](@entry_id:273002)（GC）有本质区别。聚合图的GC仅要求节点在边的并集上连通，这是一个宽松得多的条件。因此，MCGC的大小通常远小于聚合图的GC。仅仅因为两层网络各自拥有一个[巨组分](@entry_id:273002)，并不意味着它们的交集是稳固的；计算MCGC需要一个迭代移除的过程，以确保[相互可达性](@entry_id:263473)。这个概念揭示了一个深刻的结论：相互依赖会使系统变得比其任何单个组成部分都更加脆弱。

### [多层网络](@entry_id:270365)中的节点与社团表征

为了从[多层网络](@entry_id:270365)中提取有意义的生物学洞见，我们需要开发能够处理其复杂结构的分析工具。这包括推广传统的节点[中心性度量](@entry_id:144795)和社团发现算法。

#### 多层环境下的节点中心性

节点的重要性现在不仅取决于其在单层内的位置，还取决于其跨层连接的模式。

**多重[特征向量中心性](@entry_id:155536) (Multiplex Eigenvector Centrality)** [@problem_id:4363992] 是一个有力的度量。它被定义为[超邻接矩阵](@entry_id:755671) $A^{\mathrm{supra}}$ 的[主特征向量](@entry_id:264358) $\mathbf{x}$。这个 $NL \times 1$ 的向量 $\mathbf{x}$ 可以被划分为 $L$ 个块 $\mathbf{x}^{(\ell)}$，其中 $\mathbf{x}^{(\ell)}_i$ 表示节点 $i$ 在层 $\ell$ 的中心性得分。一个节点的总中心性得分可以定义为其在所有层得分的总和，$s_i = \sum_{\ell=1}^{L} x_i^{(\ell)}$。

这种方法与简单的替代方案形成对比：
- **逐层中心性 (Layer-wise Centrality)**：独立计算每层 $A^{(\ell)}$ 的[特征向量中心性](@entry_id:155536)。这种方法的主要问题在于，不同层的中心性得分无法直接比较，因为它们的尺度取决于各层独特的谱特性。
- **聚合中心性 (Aggregated Centrality)**：在聚合矩阵 $A^{\mathrm{agg}} = \sum_\ell A^{(\ell)}$ 上计算[特征向量中心性](@entry_id:155536)。这种方法通过将不同类型的关系简单相加，丢失了所有关于层结构的信息。

多重[特征向量中心性](@entry_id:155536)的美妙之处在于它如何通过层间[耦合参数](@entry_id:747983) $\omega$ 来调和这两种极端情况：
- 当 $\omega \to 0$ 时，多重中心性会退化，其得分主要由具有最大谱半径的单个层决定，而不是独立地反映所有层。
- 当 $\omega \to \infty$ 时，各层的中心性向量 $\mathbf{x}^{(\ell)}$ 会趋于一致，而节点的总体排名将收敛于聚合网络的中心性排名。
- 在**中等耦合强度** $\omega  0$ 时，多重中心性最能发挥其优势。它能够识别出那些“跨模态桥梁”节点：这些节点在任何单层中可能都不是最核心的，但通过在多个层中占据中等重要的位置并利用层间耦合，它们获得了很高的总分。

**时间[介数中心性](@entry_id:267828) (Temporal Betweenness Centrality)** [@problem_id:4363985] 则是为[时间网络](@entry_id:269883)量身定制的。传统的介数中心性计算通过一个节点的最短路径数量。在[时间网络](@entry_id:269883)中，这个概念必须被修正为计算通过一个节点的**时间尊重[测地线](@entry_id:155237) (time-respecting geodesics)** 的数量。[测地线](@entry_id:155237)（最短路径）的定义本身也变得依赖于具体的传播过程。我们可以定义一个包含时间惩罚的[成本函数](@entry_id:138681)，例如：
$$
C_\lambda(\text{path}) = \text{到达时间} + \lambda \times (\text{网络内总等待时间})
$$
当 $\lambda=0$ 时，[测地线](@entry_id:155237)是“最快”路径。当 $\lambda0$ 时，模型开始惩罚那些需要在中间节点长时间“等待”才能赶上下一个连接的路径。通过改变 $\lambda$，我们可以探索不同传播策略下的关键节点。一个节点的时间介数中心性会随着 $\lambda$ 的变化而变化，因为不同的路径会根据其等待时间模式而交替成为[测地线](@entry_id:155237)。这揭示了节点在网络中作为“快速通道”或“耐心枢纽”的动态角色。

#### 社团发现：跨层寻找[功能模块](@entry_id:275097)

社团（或模块）是在网络中连接紧密的节[点群](@entry_id:142456)。在[多层网络](@entry_id:270365)中，社团结构可以跨越多个层，形成更丰富的功能单元。**多层模块度 (Multilayer Modularity)** [@problem_id:4364008] 是一个广泛用于发现这种结构的[质量函数](@entry_id:158970)。它扩展了经典的Newman-Girvan模块度：
$$
Q = \sum_{\ell=1}^{L}\left[\sum_{i,j}\left(A^{[\ell]}_{ij}-\gamma^{[\ell]}P^{[\ell]}_{ij}\right)\delta(g_i^{[\ell]},g_j^{[\ell]})\right] + \sum_{i}\sum_{\ell,m}\omega^{\ell m}\delta(g_i^{[\ell]},g_i^{[m]})
$$
这个表达式由两部分组成：

1.  **层内模块度项**：第一项是对所有层内的模块度贡献求和。对于每一层 $\ell$，它比较了社团内部（由 $\delta(g_i^{[\ell]},g_j^{[\ell]})$ 保证）观察到的边权重 $A^{[\ell]}_{ij}$ 与一个[零模型](@entry_id:181842)（例如，保持度分布的[随机图](@entry_id:270323)）所期望的边权重 $P^{[\ell]}_{ij}$ 之间的差异。$\gamma^{[\ell]}$ 是一个分辨率参数，用于调整社团的大小。

2.  **层间耦合项**：第二项是多层模块度的精髓。它对所有节点 $i$ 和所有层对 $(\ell, m)$ 进行求和。每当节点 $i$ 在层 $\ell$ 和层 $m$ 中被分配到相同的社团时（即 $\delta(g_i^{[\ell]},g_i^{[m]})=1$），[质量函数](@entry_id:158970) $Q$ 就会增加一个等于耦合权重 $\omega^{\ell m}$ 的奖励。这个项的作用是鼓励社团结构在不同层之间保持一致。通过设置 $\omega^{\ell m}$ 矩阵，研究者可以精确地控制哪些层应该具有相似的社团结构。例如，在[时间网络](@entry_id:269883)中，设置 $\omega^{\ell m}$ 仅在 $\ell$ 和 $m$ 相邻时为正，可以促进社团随时间的平滑演化。

通过最大化这个统一的[质量函数](@entry_id:158970) $Q$，算法可以同时优化所有层的社团划分，并平衡层内连接模式与跨层社团一致性之间的关系，从而揭示出在单一层面上无法发现的、更加稳健和功能相关的生物学模块。