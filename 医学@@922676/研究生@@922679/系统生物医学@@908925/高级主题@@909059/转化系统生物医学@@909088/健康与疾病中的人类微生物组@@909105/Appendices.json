{"hands_on_practices": [{"introduction": "量化微生物群落的复杂性是理解其在健康和疾病中作用的第一步。香农多样性指数是生态学中的一个核心工具，它能够通过衡量物种的丰富度和均匀度来为我们提供一个量化的视角。通过这个练习，你将亲手计算并比较两个假设样本的α多样性，从而直观地理解多样性指数如何帮助我们评估和区分不同的微生物组状态。", "problem": "在系统生物医学中，人类肠道微生物组的样本内（alpha）多样性通常使用基于期望惊奇度的信息论度量来量化。考虑两个粪便宏基因组图谱，它们源自对三个细菌属的测序深度标准化的相对丰度。设样本 $\\mathcal{P}$ 的三个属的概率为 $p = (0.1, 0.2, 0.7)$，样本 $\\mathcal{Q}$ 的概率为 $q = (0.3, 0.3, 0.4)$。使用基于自然对数的香农熵的信息论定义，计算每个样本的alpha多样性 $H$。以奈特（nats）为单位表示最终的熵值，并将您的答案四舍五入到四位有效数字。然后，仅根据计算出的值，确定哪个样本根据香农准则表现出更高的样本内多样性。", "solution": "该问题陈述清晰且科学上合理，为解决问题提供了所有必要信息。它要求计算香农熵，这是信息论中的一个基本概念，应用于量化微生物学中的alpha多样性。\n\n对于一个离散概率分布 $P = \\{p_1, p_2, \\dots, p_n\\}$，其中 $p_i$ 是第 $i$ 个结果的概率，其香农熵 $H$ 定义为一个结果的信息量（惊奇度）的期望值。其公式为：\n$$\nH = - \\sum_{i=1}^{n} p_i \\log_{b}(p_i)\n$$\n问题指定使用自然对数 ($\\ln$)，这对应于底数 $b=e$。在这种情况下，熵以“奈特”（nats）为单位进行度量。因此，公式变为：\n$$\nH = - \\sum_{i=1}^{n} p_i \\ln(p_i)\n$$\n较高的 $H$ 值表示更大的不确定性或惊奇度，在生态学和微生物学的背景下，这被解释为物种（或在此案例中为属）分布的更高多样性或均匀度。\n\n给定两个样本 $\\mathcal{P}$ 和 $\\mathcal{Q}$，每个样本都有一个关于 $n=3$ 个细菌属的概率分布。\n\n对于样本 $\\mathcal{P}$，其概率向量为 $p = (0.1, 0.2, 0.7)$。香农熵 $H(\\mathcal{P})$ 计算如下：\n$$\nH(\\mathcal{P}) = - \\left[ p_1 \\ln(p_1) + p_2 \\ln(p_2) + p_3 \\ln(p_3) \\right]\n$$\n$$\nH(\\mathcal{P}) = - \\left[ 0.1 \\ln(0.1) + 0.2 \\ln(0.2) + 0.7 \\ln(0.7) \\right]\n$$\n我们计算各项的值：\n$0.1 \\ln(0.1) \\approx 0.1 \\times (-2.302585) = -0.2302585$\n$0.2 \\ln(0.2) \\approx 0.2 \\times (-1.609438) = -0.3218876$\n$0.7 \\ln(0.7) \\approx 0.7 \\times (-0.356675) = -0.2496725$\n将这些值相加：\n$$\nH(\\mathcal{P}) \\approx - \\left[ -0.2302585 - 0.3218876 - 0.2496725 \\right]\n$$\n$$\nH(\\mathcal{P}) \\approx - ( -0.8018186 )\n$$\n$$\nH(\\mathcal{P}) \\approx 0.8018186 \\text{ nats}\n$$\n四舍五入到四位有效数字，我们得到 $H(\\mathcal{P}) = 0.8018$。\n\n对于样本 $\\mathcal{Q}$，其概率向量为 $q = (0.3, 0.3, 0.4)$。香农熵 $H(\\mathcal{Q})$ 计算如下：\n$$\nH(\\mathcal{Q}) = - \\left[ q_1 \\ln(q_1) + q_2 \\ln(q_2) + q_3 \\ln(q_3) \\right]\n$$\n$$\nH(\\mathcal{Q}) = - \\left[ 0.3 \\ln(0.3) + 0.3 \\ln(0.3) + 0.4 \\ln(0.4) \\right]\n$$\n这可以简化为：\n$$\nH(\\mathcal{Q}) = - \\left[ 2 \\times 0.3 \\ln(0.3) + 0.4 \\ln(0.4) \\right]\n$$\n$$\nH(\\mathcal{Q}) = - \\left[ 0.6 \\ln(0.3) + 0.4 \\ln(0.4) \\right]\n$$\n我们计算各项的值：\n$0.6 \\ln(0.3) \\approx 0.6 \\times (-1.203973) = -0.7223838$\n$0.4 \\ln(0.4) \\approx 0.4 \\times (-0.916291) = -0.3665164$\n将这些值相加：\n$$\nH(\\mathcal{Q}) \\approx - \\left[ -0.7223838 - 0.3665164 \\right]\n$$\n$$\nH(\\mathcal{Q}) \\approx - ( -1.0889002 )\n$$\n$$\nH(\\mathcal{Q}) \\approx 1.0889002 \\text{ nats}\n$$\n四舍五入到四位有效数字，我们得到 $H(\\mathcal{Q}) = 1.089$。\n\n为了确定哪个样本表现出更高的样本内多样性，我们比较它们计算出的香农熵值。\n$$\nH(\\mathcal{P}) \\approx 0.8018 \\text{ nats}\n$$\n$$\nH(\\mathcal{Q}) \\approx 1.089 \\text{ nats}\n$$\n由于 $1.089 > 0.8018$，我们有 $H(\\mathcal{Q}) > H(\\mathcal{P})$。\n根据香non准则，较高的熵值对应于更高的多样性。因此，样本 $\\mathcal{Q}$ 表现出比样本 $\\mathcal{P}$ 更高的样本内多样性。这与以下观察结果一致：$\\mathcal{Q}$ 的概率分布 $(0.3, 0.3, 0.4)$ 比 $\\mathcal{P}$ 的分布 $(0.1, 0.2, 0.7)$ 更均匀（即，更少地由单个类别主导）。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.8018  1.089 \\end{pmatrix}}\n$$", "id": "4393633"}, {"introduction": "虽然像香农指数这样的多样性指标很有用 [@problem_id:4393633]，但解读它们需要我们理解其基础数据的局限性。宏基因组测序数据通常是相对丰度，而非绝对丰度，这带来了所谓的“组分性”问题。本练习将通过一个具体的案例，揭示组分性如何导致对微生物丰度变化的错误判断，这是一个在微生物组研究中至关重要且必须警惕的分析陷阱。", "problem": "一项关于肠道微生物组的病例对照研究使用流式细胞术结合 16S 核糖体核糖核酸扩增子测序，测量了每克粪便中微生物的绝对丰度。考虑一个简化的群落，其中有 $3$ 个主要分类单元，记为 $T_1$、$T_2$ 和 $T_3$。在对照组中，测得的绝对丰度（细胞数/克）为 $x_1^{(0)} = 10^{6}$、$x_2^{(0)} = 10^{9}$ 和 $x_3^{(0)} = 10^{9}$。在疾病组中，它们是 $x_1^{(1)} = 10^{6}$、$x_2^{(1)} = 5 \\times 10^{8}$ 和 $x_3^{(1)} = 5 \\times 10^{8}$。假设测序产生的相对丰度等于绝对比例（即没有分类单元特异性的扩增偏倚），因此在条件 $k$ 下，分类单元 $i$ 的相对丰度为 $\\tilde{x}_i^{(k)} = x_i^{(k)} / \\sum_{j=1}^{3} x_j^{(k)}$。\n\n将在相对丰度分析下，分类单元 $T_1$ 的观测 log$_2$ 倍数变化定义为 $L_{\\mathrm{rel}} = \\log_{2}\\!\\left(\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}\\right)$，基于绝对丰度的真实 log$_2$ 倍数变化定义为 $L_{\\mathrm{abs}} = \\log_{2}\\!\\left(x_1^{(1)} / x_1^{(0)}\\right)$。将 $T_1$ 的组成性偏倚定义为 $B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$。\n\n仅使用组成数据的基本原理（即相对丰度受限于总和为 $1$，且等于绝对丰度除以总载量）和所提供的计数，计算 $T_1$ 的 $B$ 值。然后，简要论证一种方法，通过使用绝对丰度或组成平衡，在对 $T_1$ 与疾病状态进行关联分析时，能够消除或适当地重新解释这种偏倚。\n\n将最终的 $B$ 值报告为单个无量纲数，并将答案四舍五入到 $4$ 位有效数字。", "solution": "对所提供的问题进行验证。\n\n逐字提取已知条件：\n- 一个群落有 $3$ 个分类单元：$T_1$、$T_2$、$T_3$。\n- 对照组绝对丰度（细胞数/克）：$x_1^{(0)} = 10^{6}$、$x_2^{(0)} = 10^{9}$ 和 $x_3^{(0)} = 10^{9}$。\n- 疾病组绝对丰度（细胞数/克）：$x_1^{(1)} = 10^{6}$、$x_2^{(1)} = 5 \\times 10^{8}$ 和 $x_3^{(1)} = 5 \\times 10^{8}$。\n- 相对丰度定义：对于条件 $k \\in \\{0, 1\\}$，$\\tilde{x}_i^{(k)} = x_i^{(k)} / \\sum_{j=1}^{3} x_j^{(k)}$。\n- $T_1$ 的观测相对 log$_2$ 倍数变化：$L_{\\mathrm{rel}} = \\log_{2}\\!\\left(\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}\\right)$。\n- $T_1$ 的真实绝对 log$_2$ 倍数变化：$L_{\\mathrm{abs}} = \\log_{2}\\!\\left(x_1^{(1)} / x_1^{(0)}\\right)$。\n- $T_1$ 的组成性偏倚：$B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$。\n- 任务是计算 $T_1$ 的 $B$ 值，将其报告到 $4$ 位有效数字，并论证一种分析方法以减轻这种偏倚。\n\n验证开始。\n该问题具有科学依据。它解决了微生物组数据分析中组成性的根本问题，这是一个公认的概念。相对丰度数据可能产生伪相关的假设是该领域的一个主要议题。所提供的数据值是合理的。该问题是良定的，为 $B$ 的唯一解提供了所有必要的定义和数据。语言客观且技术性强。该问题不违反任何无效性标准。\n\n结论：该问题有效。将制定解决方案。\n\n组成性偏倚 $B$ 定义为由相对丰度计算的对数倍数变化与由绝对丰度计算的对数倍数变化之差。\n$$B = L_{\\mathrm{rel}} - L_{\\mathrm{abs}}$$\n代入 $L_{\\mathrm{rel}}$ 和 $L_{\\mathrm{abs}}$ 的定义：\n$$B = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)}}{\\tilde{x}_1^{(0)}}\\right) - \\log_{2}\\!\\left(\\frac{x_1^{(1)}}{x_1^{(0)}}\\right)$$\n使用对数的性质 $\\log(a) - \\log(b) = \\log(a/b)$，我们合并这些项：\n$$B = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)} / \\tilde{x}_1^{(0)}}{x_1^{(1)} / x_1^{(0)}}\\right) = \\log_{2}\\!\\left(\\frac{\\tilde{x}_1^{(1)}}{\\tilde{x}_1^{(0)}} \\cdot \\frac{x_1^{(0)}}{x_1^{(1)}}\\right)$$\n相对丰度 $\\tilde{x}_i^{(k)}$ 定义为绝对丰度 $x_i^{(k)}$ 除以微生物总载量 $S^{(k)} = \\sum_{j=1}^{3} x_j^{(k)}$。我们将这个定义代入 $\\tilde{x}_1^{(1)}$ 和 $\\tilde{x}_1^{(0)}$：\n$$B = \\log_{2}\\!\\left(\\frac{x_1^{(1)}/S^{(1)}}{x_1^{(0)}/S^{(0)}} \\cdot \\frac{x_1^{(0)}}{x_1^{(1)}}\\right)$$\n绝对丰度项 $x_1^{(1)}$ 和 $x_1^{(0)}$ 被消去，揭示出偏倚仅取决于两种条件之间微生物总载量的变化：\n$$B = \\log_{2}\\!\\left(\\frac{S^{(0)}}{S^{(1)}}\\right)$$\n这个结果对于任何绝对丰度不变的分类单元都是普遍适用的。其在相对项中的表观变化完全是由总和的变化所驱动的人为结果。\n\n首先，我们计算对照组（$k=0$）的总绝对丰度：\n$$S^{(0)} = x_1^{(0)} + x_2^{(0)} + x_3^{(0)} = 10^{6} + 10^{9} + 10^{9} = 1 \\times 10^{6} + 2 \\times 10^{9} = 2001 \\times 10^{6} = 2.001 \\times 10^{9}$$\n接下来，我们计算疾病组（$k=1$）的总绝对丰度：\n$$S^{(1)} = x_1^{(1)} + x_2^{(1)} + x_3^{(1)} = 10^{6} + 5 \\times 10^{8} + 5 \\times 10^{8} = 10^{6} + 10 \\times 10^{8} = 10^{6} + 10^{9} = 1001 \\times 10^{6} = 1.001 \\times 10^{9}$$\n现在我们计算偏倚 $B$：\n$$B = \\log_{2}\\!\\left(\\frac{2.001 \\times 10^{9}}{1.001 \\times 10^{9}}\\right) = \\log_{2}\\!\\left(\\frac{2.001}{1.001}\\right)$$\n使用对数换底公式 $\\log_a(x) = \\frac{\\ln(x)}{\\ln(a)}$：\n$$B = \\frac{\\ln(1.999000999...)}{\\ln(2)} \\approx \\frac{0.69264746}{0.69314718} \\approx 0.99927909$$\n四舍五入到 $4$ 位有效数字，我们得到 $B = 0.9993$。\n$T_1$ 的真实对数倍数变化是 $L_{\\mathrm{abs}} = \\log_{2}(10^6 / 10^6) = \\log_{2}(1) = 0$。表观对数倍数变化是 $L_{\\mathrm{rel}} = B+L_{\\mathrm{abs}} \\approx 0.9993$。这表明，相对丰度分析会错误地暗示分类单元 $T_1$ 的丰度大约增加了一倍（$\\log_{2}(2) = 1$），而实际上其绝对丰度保持不变。\n\n为了解决这种偏倚，存在两种主要方法：\n\n1.  **绝对丰度分析**：最直接和科学上最合理的方法是放弃相对丰度分析，直接对绝对丰度数据（$x_i^{(k)}$）进行统计检验。问题陈述中说明了这些数据已经获得。通过分析这些值（通常在对数转换后，例如 $\\ln(x_i^{(k)} + 1)$，以稳定方差），可以直接检验关于我们关注的真实量，即细胞绝对数量的假设。这种方法完全消除了组成性偏倚，因为分母 $S^{(k)}$ 从未被引入计算中。在这个问题中，这样的分析会正确地得出 $L_{\\mathrm{abs}}=0$，从而得出正确的结论，即就其绝对数量而言，$T_1$ 与疾病状态无关。\n\n2.  **对数比率分析（组成数据分析）**：如果无法获得绝对丰度数据，只能使用相对丰度（$\\tilde{x}_i^{(k)}$），则必须采用为组成数据设计的方法。Aitchison 几何为此提供了一个框架。分析的不是单个组分，而是组分的对数比率。例如，可以定义一个等距对数比率 (ilr) 平衡，如 $z = \\ln\\left(\\frac{\\tilde{x}_1}{\\sqrt{\\tilde{x}_2 \\tilde{x}_3}}\\right)$。然后检验组间这种平衡的变化。这样的比率对数据的缩放是不变的（即，对于绝对丰度和相对丰度，它是相同的：$\\ln\\left(\\frac{x_1/S}{\\sqrt{(x_2/S)(x_3/S)}}\\right) = \\ln\\left(\\frac{x_1}{\\sqrt{x_2 x_3}}\\right)$）。这种方法不能恢复 $T_1$ 的绝对变化。相反，它将分析问题从“$T_1$ 的变化是什么？”重新解释为“$T_1$ 与 $T_2$ 和 $T_3$ 的几何平均值的比率变化是什么？”。这是一个有效、良定的问题，但其解释是根本不同的。它正确地识别出微生物生态系统的结构相对于 $T_1$ 发生了变化，但将这种变化恰当地归因于组分之间的比率，而不是归因于单个组分的谬误变化。\n\n总之，使用绝对丰度数据更优，因为它直接处理了生物学上关注的量。如果仅限于相对数据，对数比率分析提供了一个数学上严谨的框架，但需要对科学假设进行仔细的重新解释。", "answer": "$$\n\\boxed{0.9993}\n$$", "id": "2538319"}, {"introduction": "除了分析群落的组成结构，理解微生物组的功能输出对于揭示其对宿主健康的影响更为关键。短链脂肪酸（SCFAs）是连接饮食、微生物群和宿主生理的关键代谢物。本练习将引导你使用化学计量产率的基本原理，来模拟和计算从膳食纤维中产生SCFA的量，从而将抽象的微生物功能具体化为可量化的生物化学过程。", "problem": "在人体结肠中，可发酵纤维（如菊粉）被肠道菌群代谢为短链脂肪酸 (SCFA)，主要包括乙酸盐、丙酸盐和丁酸盐。在系统生物医学中，化学计量产率定义为每单位质量的底物消耗所形成的产物质量。考虑摄入质量为 $20\\,\\mathrm{g}$ 的菊粉，其到达结肠并被完全代谢为三种短链脂肪酸：乙酸盐、丙酸盐和丁酸盐，其恒定的化学计量产率分别为 $y_{a}$、$y_{p}$ 和 $y_{b}$（单位为 $\\mathrm{g}/\\mathrm{g}$）。假设产率分别为 $y_{a}=0.5$、$y_{p}=0.2$ 和 $y_{b}=0.3$，并且在这种简化的集总表示下，这些产物的总质量是守恒的。\n\n以化学计量产率的定义和质量守恒为基本出发点，在这些假设下，推导由 $20\\,\\mathrm{g}$ 菊粉生成的乙酸盐、丙酸盐和丁酸盐的质量。将最终答案表示为一个单行矩阵，其中包含按乙酸盐、丙酸盐、丁酸盐顺序排列的三个质量，每个条目代表以克为单位的质量。提供精确值，无需四舍五入。矩阵中不包含单位。", "solution": "首先对问题进行验证。\n\n**步骤1：提取已知条件**\n-   底物：菊粉\n-   消耗的菊粉质量 $m_{inulin}$：$20\\,\\mathrm{g}$\n-   代谢是完全的，并且只产生三种指定的产物。\n-   产物：乙酸盐、丙酸盐、丁酸盐。\n-   化学计量产率 $y$ 的定义：每单位质量的底物消耗所形成的产物质量（$\\mathrm{g}/\\mathrm{g}$）。\n-   乙酸盐的化学计量产率 $y_a$：$0.5$\n-   丙酸盐的化学计量产率 $y_p$：$0.2$\n-   丁酸盐的化学计量产率 $y_b$：$0.3$\n-   约束条件：在这种简化的集总表示下，这些产物的总质量是守恒的。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它描述了结肠中纤维发酵成短链脂肪酸 (SCFA) 这一众所周知的代谢过程。化学计量产率的概念是化学工程和系统生物学中的一个标准定量工具。该问题提法得当，为获得唯一解提供了所有必要信息。验证的一个关键点是给定产率与所述质量守恒假设之间的一致性。质量产率之和为 $y_a + y_p + y_b = 0.5 + 0.2 + 0.3 = 1.0$。这意味着每消耗 $1\\,\\mathrm{g}$ 菊粉，就会生成总计 $1\\,\\mathrm{g}$ 的指定产物（乙酸盐、丙酸盐和丁酸盐）。这与问题中“在这种简化的集总表示下，这些产物的总质量是守恒的”这一明确假设完全一致。虽然这是对真实生物过程（该过程还产生气体和微生物生物质）的简化，但它创建了一个内部一致且可解的问题。语言客观，问题结构清晰。因此，该问题被认为是有效的。\n\n**步骤3：继续求解**\n\n问题的核心在于由底物 $s$ 生成产物 $i$ 的化学计量产率 $y_i$ 的定义。它被定义为生成的产物质量 $m_i$ 与消耗的底物质量 $m_s$ 之比：\n$$y_i = \\frac{m_i}{m_s}$$\n为了求出生成的产物质量，可以对该方程进行代数重排：\n$$m_i = y_i \\times m_s$$\n\n在本例中，底物是菊粉，消耗质量为 $m_s = m_{inulin} = 20\\,\\mathrm{g}$。产物是乙酸盐 ($a$)、丙酸盐 ($p$) 和丁酸盐 ($b$)，给定产率分别为 $y_a = 0.5$、$y_p = 0.2$ 和 $y_b = 0.3$。我们可以应用重排后的公式来求出每种产物的质量。\n\n乙酸盐的质量 $m_a$ 计算如下：\n$$m_a = y_a \\times m_{inulin}$$\n代入给定的数值：\n$$m_a = 0.5 \\times 20\\,\\mathrm{g} = 10\\,\\mathrm{g}$$\n\n丙酸盐的质量 $m_p$ 计算如下：\n$$m_p = y_p \\times m_{inulin}$$\n代入给定的数值：\n$$m_p = 0.2 \\times 20\\,\\mathrm{g} = 4\\,\\mathrm{g}$$\n\n丁酸盐的质量 $m_b$ 计算如下：\n$$m_b = y_b \\times m_{inulin}$$\n代入给定的数值：\n$$m_b = 0.3 \\times 20\\,\\mathrm{g} = 6\\,\\mathrm{g}$$\n\n为了验证与问题中所述的质量守恒原理的一致性，我们将产物的质量相加：\n$$m_{\\text{total}} = m_a + m_p + m_b = 10\\,\\mathrm{g} + 4\\,\\mathrm{g} + 6\\,\\mathrm{g} = 20\\,\\mathrm{g}$$\n该总质量与消耗的菊粉初始质量 $m_{inulin} = 20\\,\\mathrm{g}$ 完全相同，这证实了问题前提与推导出的解的内部一致性。\n\n最终答案应表示为一个单行矩阵，按乙酸盐、丙酸盐和丁酸盐的顺序包含三个质量。计算出的质量为 $m_a=10\\,\\mathrm{g}$、$m_p=4\\,\\mathrm{g}$ 和 $m_b=6\\,\\mathrm{g}$。", "answer": "$$\\boxed{\\begin{pmatrix} 10  4  6 \\end{pmatrix}}$$", "id": "4393702"}]}