{"hands_on_practices": [{"introduction": "逻辑斯谛增长模型是描述资源有限环境下种群动态的基础工具。本练习旨在通过求解该模型的解析解，帮助您深入理解肿瘤微环境如何对CAR-T细胞的扩增施加一个“承载能力”上限，这是限制治疗效果的关键因素[@problem_id:4361771]。掌握这一基本原理，是构建和分析更复杂相互作用模型的基石。", "problem": "考虑嵌合抗原受体（CAR）T细胞在过继性转移到实体瘤患者体内后的扩增过程。一个广泛应用的粗粒化种群模型假定，CAR T细胞的丰度 $T(t)$ 满足以下常微分方程：\n$$\\frac{dT}{dt} = r\\,T\\left(1 - \\frac{T}{K}\\right),$$\n其中 $r>0$ 是在 $T$ 较低时的内在人均增长率，而 $K>0$ 是一个由肿瘤微环境约束（例如，抗原可及性、葡萄糖和氧气等代谢资源、抑制性细胞因子以及空间限制）施加的有限上界。假设初始条件为 $T(0)=T_0$，且 $0  T_0  K$。从该微分方程和初始条件出发，推导出 $T(t)$ 的解析解。", "solution": "首先根据指定标准验证问题陈述。\n\n### 步骤1：提取已知条件\n- 微分方程：$$\\frac{dT}{dt} = r\\,T\\left(1 - \\frac{T}{K}\\right)$$\n- 参数与约束：$r>0$, $K>0$。\n- 初始条件：$T(0)=T_0$，且 $0  T_0  K$。\n\n### 步骤2：识别ODE类型\n这是一个一阶非线性常微分方程。它也是一个可分离变量的方程。\n\n### 步骤3：分离变量\n我们将包含 $T$ 的项移到左边，包含 $t$ 的项移到右边：\n$$\n\\frac{dT}{T\\left(1 - \\frac{T}{K}\\right)} = r\\,dt\n$$\n$$\n\\frac{K}{T(K-T)}dT = r\\,dt\n$$\n\n### 步骤4：使用部分分式分解法对左侧进行积分\n左侧的被积函数 $\\frac{K}{T(K-T)}$ 可以分解为部分分式：\n$$\n\\frac{K}{T(K-T)} = \\frac{A}{T} + \\frac{B}{K-T}\n$$\n解出 $A$ 和 $B$：\n$$\nK = A(K-T) + BT\n$$\n当 $T=0$ 时，$K = AK \\implies A=1$。\n当 $T=K$ 时，$K = BK \\implies B=1$。\n所以，分解为：\n$$\n\\frac{1}{T} + \\frac{1}{K-T}\n$$\n\n现在对方程两边进行积分：\n$$\n\\int \\left(\\frac{1}{T} + \\frac{1}{K-T}\\right) dT = \\int r\\,dt\n$$\n\n### 步骤5：执行积分\n$$\n\\ln|T| - \\ln|K-T| = rt + C_1\n$$\n其中 $C_1$ 是积分常数。\n$$\n\\ln\\left|\\frac{T}{K-T}\\right| = rt + C_1\n$$\n\n### 步骤6：求解T\n$$\n\\left|\\frac{T}{K-T}\\right| = e^{rt + C_1} = e^{C_1}e^{rt}\n$$\n由于 $0  T_0  K$，且解是连续的，所以 $T(t)$ 将始终保持在 $0$ 和 $K$ 之间。因此，$T$ 和 $K-T$ 都将是正数，我们可以去掉绝对值符号：\n$$\n\\frac{T}{K-T} = C e^{rt}\n$$\n其中 $C = e^{C_1}$ 是一个新的正常数。\n\n### 步骤7：应用初始条件求解C\n在 $t=0$ 时，$T(t)=T_0$。\n$$\n\\frac{T_0}{K-T_0} = C e^{r(0)} = C\n$$\n\n### 步骤8：代回C并求解T(t)\n将 $C$ 的表达式代回方程：\n$$\n\\frac{T}{K-T} = \\left(\\frac{T_0}{K-T_0}\\right) e^{rt}\n$$\n现在，我们求解 $T(t)$：\n$$\nT(K-T_0) = (K-T) T_0 e^{rt}\n$$\n$$\nT(K-T_0) = K T_0 e^{rt} - T T_0 e^{rt}\n$$\n$$\nT(K-T_0) + T T_0 e^{rt} = K T_0 e^{rt}\n$$\n$$\nT(K - T_0 + T_0 e^{rt}) = K T_0 e^{rt}\n$$\n$$\nT(t) = \\frac{K T_0 e^{rt}}{K - T_0 + T_0 e^{rt}}\n$$\n为了得到更标准的形式，我们将分子和分母同除以 $T_0 e^{rt}$：\n$$\nT(t) = \\frac{K}{\\frac{K-T_0}{T_0 e^{rt}} + 1} = \\frac{K}{1 + \\frac{K-T_0}{T_0}e^{-rt}}\n$$\n这与最终答案的格式相匹配。", "answer": "$$\n\\boxed{T(t) = \\frac{K}{1 + \\left(\\frac{K - T_0}{T_0}\\right) \\exp(-rt)}}\n$$", "id": "4361771"}, {"introduction": "真实的生物系统通常涉及众多参数，这使得分析变得异常复杂。本练习将介绍一种强大的分析技术——无量纲化，它能有效减少模型的参数数量，揭示出真正主导系统动态的核心参数组合[@problem_id:4361877]。通过将此技术应用于一个经典的CAR-T细胞-肿瘤“捕食者-猎物”模型，您将学会如何提炼出决定治疗成败的关键动态关系。", "problem": "嵌合抗原受体（CAR）T细胞免疫疗法的一个最小相互作用模型耦合了肿瘤细胞群体动力学和效应CAR-T细胞动力学。设 $T(t)$ 表示时间 $t$ 时的肿瘤细胞数， $E(t)$ 表示CAR-T细胞数。假设肿瘤细胞呈逻辑斯谛增长，并通过与CAR-T细胞的质量作用接触而被杀死，而CAR-T细胞在遇到肿瘤细胞时增殖，并以一个基准速率死亡。该有量纲模型为\n$$\n\\frac{dT}{dt} \\;=\\; r\\,T\\left(1 - \\frac{T}{K}\\right) \\;-\\; \\kappa\\,E\\,T,\n\\qquad\n\\frac{dE}{dt} \\;=\\; \\eta\\,E\\,T \\;-\\; \\delta\\,E,\n$$\n其中，$r$ 是肿瘤的内禀人均增长率，$K$ 是肿瘤的环境承载力，$\\kappa$ 是单位CAR-T细胞的人均细胞毒性速率常数，$\\eta$ 是每次遇到肿瘤细胞时CAR-T细胞的增殖速率常数，$\\delta$ 是CAR-T细胞的死亡率。所有参数均为正数，并具有与所述过程一致的固定单位。\n\n从这些控制方程和标准的质量作用及逻辑斯谛增长假设出发，通过引入一个重新标度的无量纲时间 $\\tau$、一个重新标度的肿瘤变量 $x(\\tau)$ 和一个重新标度的CAR-T变量 $y(\\tau)$，进行系统的无量纲化，并遵循以下要求：\n- 分别使用肿瘤的内禀时间尺度和环境承载力作为特征时间和特征肿瘤尺度。\n- 选择CAR-T细胞的尺度，使得重新标度的肿瘤方程中肿瘤-CAR-T相互作用项的系数为1。\n\n推导出以 $x(\\tau)$ 和 $y(\\tau)$ 表示的完全无量纲系统，并确定控制其动力学和结果的独立无量纲参数组合的完整集合。将最终答案表示为一个单行向量，其中包含这些独立的无量纲参数，每个参数都以原始有量纲参数 $r$, $K$, $\\kappa$, $\\eta$ 和 $\\delta$ 的封闭形式解析表达式写出。无需提供数值，最终答案中也不应包含任何单位。最终答案必须仅由所要求的行向量组成。", "solution": "该问题要求对一个描述肿瘤细胞群体 $T(t)$ 和CAR-T效应细胞群体 $E(t)$ 动力学的二元耦合常微分方程组进行无量纲化。\n\n控制方程的有量纲形式如下：\n$$\n\\frac{dT}{dt} = rT\\left(1 - \\frac{T}{K}\\right) - \\kappa ET \\label{eq:T}\n$$\n$$\n\\frac{dE}{dt} = \\eta ET - \\delta E \\label{eq:E}\n$$\n所有参数 $r, K, \\kappa, \\eta, \\delta$ 均为正常数。\n\n根据题意，我们引入时间、肿瘤细胞和CAR-T细胞的无量纲变量 $\\tau$、$x(\\tau)$ 和 $y(\\tau)$。尺度关系定义如下：\n$$\nt = t_c \\tau\n$$\n$$\nT(t) = T_c x(\\tau)\n$$\n$$\nE(t) = E_c y(\\tau)\n$$\n其中 $t_c$、$T_c$ 和 $E_c$ 分别是时间、肿瘤群体和CAR-T细胞群体的特征尺度。\n\n问题指定了其中两个尺度的选择：\n1.  特征时间 $t_c$ 是肿瘤的内禀时间尺度。参数 $r$ 是肿瘤的内禀人均增长率，单位为 $(\\text{时间})^{-1}$。$r$ 的倒数提供了一个自然的肿瘤增长时间尺度。因此，我们设：\n    $$\n    t_c = \\frac{1}{r}\n    $$\n2.  特征肿瘤群体 $T_c$ 是肿瘤的环境承载力 $K$。所以，我们设：\n    $$\n    T_c = K\n    $$\n\n因此，变量 $t$ 和 $T$ 的尺度变换为：\n$$\nt = \\frac{\\tau}{r}, \\qquad T(t) = K x(\\tau)\n$$\n\n特征CAR-T细胞尺度 $E_c$ 的选择应使重新标度的肿瘤方程中肿瘤-CAR-T相互作用项的系数为1。我们将通过强制执行此条件来确定 $E_c$。\n\n首先，我们使用链式法则变换时间导数：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau}\n$$\n从 $t = \\tau/r$ 可得 $\\frac{dt}{d\\tau} = \\frac{1}{r}$，这意味着 $\\frac{d\\tau}{dt} = r$。因此，导数算子变换为：\n$$\n\\frac{d}{dt} = r \\frac{d}{d\\tau}\n$$\n\n现在，我们将尺度关系代入第一个关于肿瘤群体的微分方程：\n$$\nr \\frac{d(Kx)}{d\\tau} = r(Kx)\\left(1 - \\frac{Kx}{K}\\right) - \\kappa(E_c y)(Kx)\n$$\n$$\nrK \\frac{dx}{d\\tau} = rKx(1 - x) - \\kappa E_c K xy\n$$\n为简化起见，我们将整个方程除以因子 $rK$（因为 $r > 0$ 且 $K > 0$）：\n$$\n\\frac{dx}{d\\tau} = x(1 - x) - \\frac{\\kappa E_c}{r} xy\n$$\n根据问题的要求，相互作用项 $xy$ 的系数必须为1。这给了我们条件：\n$$\n\\frac{\\kappa E_c}{r} = 1\n$$\n解出 $E_c$，我们得到CAR-T细胞群体的特征尺度：\n$$\nE_c = \\frac{r}{\\kappa}\n$$\n通过这个 $E_c$ 的选择，$E(t)$ 的尺度变换为 $E(t) = \\frac{r}{\\kappa} y(\\tau)$，肿瘤群体的无量纲方程变为：\n$$\n\\frac{dx}{d\\tau} = x(1 - x) - xy\n$$\n\n接下来，我们使用现已完全确定的尺度关系对第二个关于CAR-T细胞群体的微分方程进行无量纲化：\n$$\nt = \\frac{\\tau}{r}, \\quad T = Kx, \\quad E = \\frac{r}{\\kappa} y, \\quad \\frac{d}{dt} = r\\frac{d}{d\\tau}\n$$\n将这些代入 $dE/dt$ 的方程：\n$$\nr \\frac{d}{d\\tau}\\left(\\frac{r}{\\kappa}y\\right) = \\eta\\left(\\frac{r}{\\kappa}y\\right)(Kx) - \\delta\\left(\\frac{r}{\\kappa}y\\right)\n$$\n$$\nr\\left(\\frac{r}{\\kappa}\\right)\\frac{dy}{d\\tau} = \\left(\\frac{\\eta rK}{\\kappa}\\right)xy - \\left(\\frac{\\delta r}{\\kappa}\\right)y\n$$\n为了分离出 $\\frac{dy}{d\\tau}$，我们将整个方程除以因子 $r(\\frac{r}{\\kappa}) = \\frac{r^2}{\\kappa}$：\n$$\n\\frac{dy}{d\\tau} = \\frac{\\frac{\\eta rK}{\\kappa}}{\\frac{r^2}{\\kappa}} xy - \\frac{\\frac{\\delta r}{\\kappa}}{\\frac{r^2}{\\kappa}} y\n$$\n简化系数：\n$$\n\\frac{dy}{d\\tau} = \\left(\\frac{\\eta rK}{\\kappa} \\cdot \\frac{\\kappa}{r^2}\\right) xy - \\left(\\frac{\\delta r}{\\kappa} \\cdot \\frac{\\kappa}{r^2}\\right) y\n$$\n$$\n\\frac{dy}{d\\tau} = \\left(\\frac{\\eta K}{r}\\right) xy - \\left(\\frac{\\delta}{r}\\right) y\n$$\n此方程也可以写成 $\\frac{dy}{d\\tau} = \\left(\\frac{\\eta K}{r}x - \\frac{\\delta}{r}\\right) y$。\n\n完整的无量纲系统是：\n$$\n\\frac{dx}{d\\tau} = x(1 - x) - xy\n$$\n$$\n\\frac{dy}{d\\tau} = \\left(\\frac{\\eta K}{r}\\right) xy - \\left(\\frac{\\delta}{r}\\right) y\n$$\n该系统的动力学由作为系数出现的无量纲参数组合所控制。这两个独立的参数组是：\n1.  第二个方程中 $xy$ 项的系数：$\\frac{\\eta K}{r}$\n2.  第二个方程中 $y$ 项的系数：$\\frac{\\delta}{r}$\n\n这两个组合代表了控制系统动力学的完整独立无量纲参数集。它们是由原始的五个有量纲参数（$r, K, \\kappa, \\eta, \\delta$）的组合构成的。参数 $\\kappa$ 已被吸收到CAR-T细胞变量 $y$ 的尺度变换中。\n\n最终答案是这两个参数的集合，以行向量形式表示。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\eta K}{r}  \\frac{\\delta}{r}\n\\end{pmatrix}\n}\n$$", "id": "4361877"}, {"introduction": "从理论模型到临床应用预测之间需要一座桥梁，而数值模拟正是这座桥梁。本练习将指导您在计算机上实现CAR-T细胞与肿瘤的动力学模型，以模拟不同的虚拟患者情景[@problem_id:4361819]。通过这项实践，您将能够探索模型参数如何影响肿瘤清除、长期控制或最终复发等临床相关结果，从而培养利用模型进行预测和假设检验的能力。", "problem": "肿瘤细胞与嵌合抗原受体T细胞（CAR-T）之间的动态相互作用，可以利用质量守恒、资源限制和质量作用相遇动力学从第一性原理进行建模。肿瘤的生长受到有限资源和空间的限制，这促使其呈现逻辑斯谛增长。CAR-T细胞与肿瘤细胞相互作用，一方面杀伤肿瘤，另一方面在识别抗原后进行扩增，同时也会发生自然衰减。您的任务是实现并模拟一个模型，用以在给定特定参数和初始条件下，估算肿瘤被根除或肿瘤再生的最早发生时间。\n\n使用以下源自经过充分检验的系统生物医学原理的建模假设：\n- 肿瘤细胞群体 $T(t)$ 以内禀增长率 $r$ 和环境承载能力 $K$ 进行逻辑斯谛增长，并通过CAR-T介导的杀伤作用而减少，其减少速率与肿瘤细胞和CAR-T细胞数量的乘积成正比（质量作用）。\n- CAR-T细胞群体 $E(t)$ 在接触肿瘤细胞时发生净增殖，增殖速率与乘积 $T(t)E(t)$ 成正比，比例系数为 $\\alpha$，并以每个细胞 $\\delta$ 的速率衰减。\n\n从这些假设出发：\n- 肿瘤动力学满足以下常微分方程\n$$\\frac{dT}{dt} = r\\,T\\left(1-\\frac{T}{K}\\right) - \\kappa\\,E\\,T,$$\n其中 $r$ 的单位是 $\\text{day}^{-1}$，$K$ 的单位是 $\\text{cells}$，$\\kappa$ 的单位是 $\\text{cell}^{-1}\\,\\text{day}^{-1}$。\n- CAR-T动力学满足以下常微分方程\n$$\\frac{dE}{dt} = \\alpha\\,T\\,E - \\delta\\,E,$$\n其中 $\\alpha$ 的单位是 $\\text{cell}^{-1}\\,\\text{day}^{-1}$，$\\delta$ 的单位是 $\\text{day}^{-1}$。\n- 初始条件为 $T(0)=T_0$ 和 $E(0)=E_0$，其中 $T_0$ 和 $E_0$ 的单位是 $\\text{cells}$。\n\n定义两个临床相关阈值：\n- 肿瘤根除：当 $T(t) \\le T_{\\text{erad}}$ 时，其中 $T_{\\text{erad}} = 1.0$ $\\text{cells}$。\n- 肿瘤再生（逃逸）：当 $T(t) \\ge T_{\\text{reg}}$ 时，其中 $T_{\\text{reg}} = 0.8\\,K$ $\\text{cells}$。\n\n估算最早时间 $t^\\ast$（单位：天），在该时间点 $T(t)$ 首次满足 $T(t) \\le T_{\\text{erad}}$ 或 $T(t) \\ge T_{\\text{reg}}$。如果在 $t_{\\max}=180$ 天的模拟时限内两个事件均未发生，则返回哨兵值 $-1.0$。最终答案以天为单位，四舍五入到两位小数，但哨兵值必须精确为 $-1.0$。\n\n实现一个程序，该程序对耦合系统进行积分，并使用稳健的事件检测来发现首次阈值穿越。使用固定的环境承载能力 $K=10^9$ 个细胞。假设时间单位为天，所有细胞计数单位为个。必须以适当的精度对模型进行数值积分，以正确检测到第一个事件。每个测试用例的输出是一个浮点数，代表估算的最早事件时间（单位：天），四舍五入到两位小数（或为 $-1.0$）。\n\n测试套件：\n模拟以下四位假设的患者，每位患者由参数值 $(r,\\kappa,\\alpha,\\delta)$ 和初始条件 $(T_0,E_0)$ 指定，所有数值的单位均如上文定义。\n\n- 病例 $1$ (预期根除): $(r=$$0.03$, $\\kappa=$$1\\times10^{-9}$, $\\alpha=$$5\\times10^{-9}$, $\\delta=$$0.10$$)$, $(T_0=$$1\\times10^{8}$, $E_0=$$5\\times10^{7}$$)$.\n- 病例 $2$ (预期再生): $(r=$$0.04$, $\\kappa=$$1\\times10^{-10}$, $\\alpha=$$1\\times10^{-9}$, $\\delta=$$0.20$$)$, $(T_0=$$1\\times10^{8}$, $E_0=$$1\\times10^{6}$$)$.\n- 病例 $3$ (时限内无事件): $(r=$$0.001$, $\\kappa=$$5\\times10^{-11}$, $\\alpha=$$5\\times10^{-10}$, $\\delta=$$0.05$$)$, $(T_0=$$1\\times10^{8}$, $E_0=$$1\\times10^{5}$$)$.\n- 病例 $4$ (临界动态): $(r=$$0.03$, $\\kappa=$$5\\times10^{-10}$, $\\alpha=$$3\\times10^{-9}$, $\\delta=$$0.20$$)$, $(T_0=$$1\\times10^{8}$, $E_0=$$1\\times10^{7}$$)$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是以天为单位的浮点数时间，四舍五入到两位小数；如果到 $t_{\\max}$ 时仍未发生事件，则为精确的 $-1.0$。不应打印任何额外文本。", "solution": "所提出的问题是一个定义明确的耦合非线性常微分方程（ODE）组的初值问题，这是系统生物学和计算科学中的一项标准任务。该模型是捕食者-猎物范式的一个变体，专门用于描述作为猎物的肿瘤细胞（$T$）和作为捕食者的嵌合抗原受体T细胞（$E$）的动力学。\n\n该系统由以下方程控制：\n$$\n\\frac{dT}{dt} = r\\,T\\left(1 - \\frac{T}{K}\\right) - \\kappa\\,E\\,T\n$$\n$$\n\\frac{dE}{dt} = \\alpha\\,T\\,E - \\delta\\,E\n$$\n在此模型中，肿瘤群体 $T(t)$ 以内禀增长率 $r$ 和环境承载能力 $K$ 进行逻辑斯谛增长。它通过与CAR-T细胞 $E(t)$ 的相互作用而被消耗，这是一个速率常数为 $\\kappa$ 的质量作用动力学项。CAR-T细胞群体 $E(t)$ 在遇到肿瘤细胞时增殖，此过程同样由一个速率常数为 $\\alpha$ 的质量作用项控制，并以 $\\delta$ 的速率进行自然的一阶衰减。系统的初始状态由 $T(0) = T_0$ 和 $E(0) = E_0$ 给出。\n\n由于这些耦合方程的非线性特性，通常无法获得解析解。因此，我们必须采用数值积分来近似求解随时间变化的解轨迹 $T(t)$ 和 $E(t)$。该任务的核心是确定肿瘤细胞群体 $T(t)$ 穿过两个指定阈值之一的最早时间 $t^\\ast$：\n1.  **根除 (Eradication):** $T(t) \\le T_{\\text{erad}}$，其中 $T_{\\text{erad}} = 1.0$。\n2.  **再生 (Regrowth):** $T(t) \\ge T_{\\text{reg}}$，其中 $T_{\\text{reg}} = 0.8\\,K = 8 \\times 10^8$。\n\n这类需要找到ODE解满足特定条件的时间的问题，被称为事件查找问题。现代数值ODE求解器为此提供了稳健的机制。我们将使用Python的SciPy库中一个功能强大且用途广泛的ODE求解器函数——`scipy.integrate.solve_ivp`。\n\n`solve_ivp`函数允许指定事件函数。当一个事件函数的值穿过零点时，事件即被触发。我们定义两个与我们的阈值相对应的此类函数：\n-   对于根除，事件函数为 $g_{\\text{erad}}(t, y) = y_0 - T_{\\text{erad}}$，其中 $y_0$ 代表肿瘤细胞群体 $T(t)$。如果此函数在减小过程中变为零（即 $T(t)$ 下降到 $T_{\\texterad}$），积分应停止。这通过将事件的 `direction` 属性设置为 $-1$ 来指定。\n-   对于再生，事件函数为 $g_{\\text{reg}}(t, y) = y_0 - T_{\\text{reg}}$。如果此函数在增加过程中变为零（即 $T(t)$ 上升到 $T_{\\text{reg}}$），积分应停止。这通过将事件的 `direction` 属性设置为 $1$ 来指定。\n\n对于这两个事件函数，我们都将 `terminal` 属性设置为 `True`。这会指示求解器在检测到这些事件中的第一个时立即终止积分。终止的时刻正是我们寻求的最早事件时间 $t^\\ast$。\n\n每个测试用例的总体算法如下：\n1.  定义一个Python函数，该函数根据当前状态 $[T, E]$、时间 $t$ 和模型参数 $(r, \\kappa, \\alpha, \\delta, K)$ 计算导数 $[\\frac{dT}{dt}, \\frac{dE}{dt}]$。\n2.  如上所述定义两个事件函数，并适当设置它们的 `terminal` 和 `direction` 属性。\n3.  将积分时间范围设置为从 $t=0$ 到 $t=t_{\\text{max}} = 180$ 天。\n4.  使用导数函数、时间范围、初始条件 $(T_0, E_0)$、模型参数和事件函数列表来调用 `solve_ivp`。我们使用 `LSODA` 方法，这是一个备受推崇的自适应求解器，适用于非刚性和刚性问题，并启用 `dense_output=True` 以实现精确的事件定位。\n5.  积分后，我们检查求解器的状态。如果触发了事件，求解器会终止，事件时间即为解输出中的最后一个时间点 `sol.t[-1]`。此值四舍五入到两位小数。\n6.  如果在时间范围 $[0, t_{\\text{max}}]$ 内没有触发任何事件，求解器将完成整个区间的计算。在这种情况下，我们报告哨兵值 $-1.0$。\n\n将此过程系统地应用于四个测试用例中的每一个，以生成最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves a system of ODEs modeling CAR-T cell and tumor dynamics\n    to find the earliest time of tumor eradication or regrowth.\n    \"\"\"\n    # Define global constants and thresholds\n    K = 1.0e9  # cells, tumor carrying capacity\n    T_erad = 1.0  # cells, eradication threshold\n    T_reg = 0.8 * K  # cells, regrowth threshold\n    t_max = 180.0  # days, simulation horizon\n\n    # Test suite: (r, kappa, alpha, delta, T0, E0)\n    test_cases = [\n        # Case 1 (anticipated eradication)\n        (0.03, 1e-9, 5e-9, 0.10, 1e8, 5e7),\n        # Case 2 (anticipated regrowth)\n        (0.04, 1e-10, 1e-9, 0.20, 1e8, 1e6),\n        # Case 3 (no event within horizon)\n        (0.001, 5e-11, 5e-10, 0.05, 1e8, 1e5),\n        # Case 4 (borderline dynamics)\n        (0.03, 5e-10, 3e-9, 0.20, 1e8, 1e7),\n    ]\n\n    results = []\n\n    def model(t, y, r, kappa, alpha, delta, K_val):\n        \"\"\"\n        Defines the coupled ODE system for tumor (T) and CAR-T cells (E).\n        y = [T, E]\n        \"\"\"\n        T, E = y\n        # Ensure cell counts do not become negative in the numerical solution\n        T = max(0, T)\n        E = max(0, E)\n        \n        dT_dt = r * T * (1 - T / K_val) - kappa * E * T\n        dE_dt = alpha * T * E - delta * E\n        return [dT_dt, dE_dt]\n\n    # Define event for tumor eradication\n    def event_eradication(t, y, r, kappa, alpha, delta, K_val):\n        return y[0] - T_erad\n    event_eradication.terminal = True\n    event_eradication.direction = -1  # Event triggers when T crosses T_erad from above\n\n    # Define event for tumor regrowth\n    def event_regrowth(t, y, r, kappa, alpha, delta, K_val):\n        return y[0] - T_reg\n    event_regrowth.terminal = True\n    event_regrowth.direction = 1  # Event triggers when T crosses T_reg from below\n\n    for params in test_cases:\n        r_case, kappa_case, alpha_case, delta_case, T0_case, E0_case = params\n        \n        y0 = [T0_case, E0_case]\n        t_span = (0, t_max)\n        \n        # Package arguments for the model and event functions\n        args = (r_case, kappa_case, alpha_case, delta_case, K)\n\n        sol = solve_ivp(\n            fun=model,\n            t_span=t_span,\n            y0=y0,\n            method='LSODA',  # General-purpose solver for stiff/non-stiff problems\n            args=args,\n            events=[event_eradication, event_regrowth],\n            dense_output=True, # Recommended for accurate event location\n        )\n\n        # sol.status == 1 indicates that a terminal event was triggered\n        if sol.status == 1 and sol.t_events and any(len(e) > 0 for e in sol.t_events):\n            # The integration stops at the first terminal event.\n            # The time of this event is the last time point in the solution.\n            event_time = sol.t[-1]\n            results.append(round(event_time, 2))\n        else:\n            # No event occurred within the simulation horizon\n            results.append(-1.0)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4361819"}]}