{"hands_on_practices": [{"introduction": "癌症的演化根植于突变的累积，而“基因组不稳定”这一癌症标志性特征极大地加速了这一进程。本练习 [@problem_id:4392020] 旨在建立一个定量框架，用于理解诸如突变率等分子参数如何直接影响癌症演化的时间尺度。通过将驱动突变的出现建模为一个泊松过程，你将推导出获得下一个驱动突变的等待时间，从而深入理解肿瘤发生的概率性基础。", "problem": "在系统肿瘤学背景下，考虑基因组不稳定性和突变这一标志，并对克隆性肿瘤细胞群体中下一次驱动突变发生的时间进行建模。假设存在 $N$ 个不同的可驱动基因座，每个基因座在连续时间内独立地发生点突变。设在基线错配修复条件下，每个基因座的突变率为单位时间 $\\mu$。假设跨基因座的驱动突变的到来可以很好地用独立泊松过程的叠加来近似，并回顾一个经过充分检验的事实：总率为 $\\lambda$ 的泊松过程中首次事件的等待时间服从指数分布，其生存函数为 $S(t)=\\exp(-\\lambda t)$。\n\n出现一种错配修复缺陷，它将每个基因座的突变率乘以一个因子 $k>1$，使得每个基因座的突变率变为 $k\\mu$。定义加速因子 $A$ 为基线条件下与缺陷条件下出现下一次驱动突变的中位等待时间之比。以闭合形式推导 $A$，将最终答案表示为单个解析表达式。不需要进行数值计算或四舍五入。", "solution": "该问题要求推导加速因子 $A$，$A$ 定义为基线条件下与错配修复缺陷条件下发生下一次驱动突变的中位等待时间之比。推导过程首先计算每种情况下的中位等待时间。\n\n问题陈述，在 $N$ 个不同基因座上驱动突变的到来可以建模为 $N$ 个独立泊松过程的叠加。\n\n**1. 基线情况**\n设 $T_{base}$ 是表示基线条件下下一次驱动突变等待时间的随机变量。\n每个基因座的突变率给定为 $\\mu$。由于有 $N$ 个独立的基因座，根据泊松过程的叠加原理，总突变率 $\\lambda_{base}$ 是各个速率的总和。\n$$\n\\lambda_{base} = \\sum_{i=1}^{N} \\mu = N\\mu\n$$\n问题陈述，总率为 $\\lambda$ 的泊松过程中首次事件的等待时间服从指数分布，其生存函数为 $S(t) = \\exp(-\\lambda t)$。\n因此，基线等待时间的生存函数为：\n$$\nS_{base}(t) = P(T_{base} > t) = \\exp(-\\lambda_{base} t) = \\exp(-N\\mu t)\n$$\n中位等待时间，记为 $t_{m,base}$，是等待时间等于或超过该时间的概率为 $0.5$ 的时间点。等价地，它是累积分布函数 $F(t) = 1 - S(t)$ 等于 $0.5$ 的时间。\n将生存函数设为 $0.5$：\n$$\nS_{base}(t_{m,base}) = \\exp(-N\\mu t_{m,base}) = 0.5 = \\frac{1}{2}\n$$\n为了求解 $t_{m,base}$，我们对等式两边取自然对数：\n$$\n\\ln(\\exp(-N\\mu t_{m,base})) = \\ln\\left(\\frac{1}{2}\\right)\n$$\n$$\n-N\\mu t_{m,base} = -\\ln(2)\n$$\n求解基线中位等待时间，得到：\n$$\nt_{m,base} = \\frac{\\ln(2)}{N\\mu}\n$$\n\n**2. 错配修复缺陷情况**\n设 $T_{def}$ 是错配修复缺陷条件下等待时间的随机变量。\n在这种情况下，每个基因座的突变率乘以一个因子 $k > 1$ 增加，变为 $k\\mu$。\n新的总突变率 $\\lambda_{def}$ 是新的各个速率的总和：\n$$\n\\lambda_{def} = \\sum_{i=1}^{N} (k\\mu) = Nk\\mu\n$$\n缺陷等待时间的生存函数为：\n$$\nS_{def}(t) = P(T_{def} > t) = \\exp(-\\lambda_{def} t) = \\exp(-Nk\\mu t)\n$$\n缺陷情况的中位等待时间 $t_{m,def}$ 可通过将其生存函数设为 $0.5$ 来求得：\n$$\nS_{def}(t_{m,def}) = \\exp(-Nk\\mu t_{m,def}) = 0.5 = \\frac{1}{2}\n$$\n对等式两边取自然对数：\n$$\n\\ln(\\exp(-Nk\\mu t_{m,def})) = \\ln\\left(\\frac{1}{2}\\right)\n$$\n$$\n-Nk\\mu t_{m,def} = -\\ln(2)\n$$\n求解缺陷中位等待时间，得到：\n$$\nt_{m,def} = \\frac{\\ln(2)}{Nk\\mu}\n$$\n\n**3. 加速因子 (A)**\n加速因子 $A$ 定义为基线中位等待时间与缺陷中位等待时间之比：\n$$\nA = \\frac{t_{m,base}}{t_{m,def}}\n$$\n代入上面推导出的表达式：\n$$\nA = \\frac{\\frac{\\ln(2)}{N\\mu}}{\\frac{\\ln(2)}{Nk\\mu}}\n$$\n我们可以通过将分子乘以分母的倒数来简化这个繁分数：\n$$\nA = \\frac{\\ln(2)}{N\\mu} \\times \\frac{Nk\\mu}{\\ln(2)}\n$$\n项 $\\ln(2)$、$N$ 和 $\\mu$ 同时出现在分子和分母中，因此它们可以消去：\n$$\nA = k\n$$\n结果表明，加速因子就等于每个基因座突变率增加的乘法因子 $k$。这是一个直观的结果，因为事件发生率的 $k$ 倍增加应该导致期望和中位等待时间的 $k$ 倍减少。", "answer": "$$\n\\boxed{k}\n$$", "id": "4392020"}, {"introduction": "驱动突变的获得会改变细胞行为，最终导致肿瘤细胞群体的扩张。本练习 [@problem_id:4392029] 将焦点从单个随机事件转移到细胞群体的确定性动态学上，通过分析一个常微分方程模型来探索肿瘤的生长。你将学习如何通过该模型量化“持续性增殖信号”和“抵抗细胞死亡”这两个标志性特征之间的动态平衡，并推导出肿瘤的稳态大小，从而将分子层面的特征与宏观的生长结果联系起来。", "problem": "在一个受限的微环境中，一个肿瘤细胞群体的模型是通过密度依赖性增殖和一个明确的单位细胞凋亡项来建立的，这反映了维持增殖信号和抵抗细胞死亡这两个标志性特征之间的平衡。令 $N(t)$ 表示时间 $t$ 时的肿瘤细胞数量。考虑以下常微分方程 (ODE)\n$$\n\\frac{dN}{dt} \\;=\\; r\\,N\\left(1-\\frac{N}{K}\\right) \\;-\\; k_a\\,N \\;=\\; \\bigg[r\\left(1-\\frac{N}{K}\\right) - k_a\\bigg]\\,N,\n$$\n其中，$r$ 是在没有密度限制的情况下的基准单位细胞增殖率，$K$ 是由资源限制所施加的环境承载能力，$k_a$ 是单位细胞凋亡率。\n\n仅从平衡的定义（即 $\\frac{dN}{dt}=0$）和给定的常微分方程出发，推导出非零平衡点 $N^{\\ast}$ 作为 $r$，$K$ 和 $k_a$ 的函数，并从增殖与凋亡之间竞争的角度解释其可行性条件。然后，使用 $r=0.5$ 天$^{-1}$，$K=10^{9}$ 个细胞，以及 $k_a=0.1$ 天$^{-1}$，计算无量纲比率\n$$\nR \\;=\\; \\frac{N^{\\ast}(k_a=0.1\\ \\text{day}^{-1})}{N^{\\ast}(k_a=0)},\n$$\n该比率量化了在有细胞凋亡情况下的平衡肿瘤负荷相对于完全逃避细胞凋亡（即 $k_a=0$）的假设情况。将 $R$ 的最终值以保留三位有效数字的小数形式报告。", "solution": "该问题具有科学依据，提法明确，并包含得出唯一解所需的所有定义和数据。所提出的模型是逻辑斯谛增长方程的一个标准扩展，在数学生物学中常用于描述具有恒定单位个体死亡率的种群动态。因此，该问题被认为是有效的，并将提供解答。\n\n肿瘤细胞群体的动态由以下常微分方程（ODE）描述：\n$$\n\\frac{dN}{dt} \\;=\\; \\bigg[r\\left(1-\\frac{N}{K}\\right) - k_a\\bigg]\\,N\n$$\n平衡点，我们记作 $N^{\\ast}$，是指种群大小不随时间变化的 $N$ 的值。这对应于条件 $\\frac{dN}{dt} = 0$。将此条件应用于给定的常微分方程，得到：\n$$\n\\bigg[r\\left(1-\\frac{N^{\\ast}}{K}\\right) - k_a\\bigg]\\,N^{\\ast} = 0\n$$\n这个方程对于 $N^{\\ast}$ 有两个解。第一个是平凡平衡点，$N^{\\ast}_1 = 0$，表示肿瘤细胞群体的完全消失或灭绝。\n\n非零平衡点，也就是本题的重点，是通过将方括号中的项设为零来找到的，假设 $N^{\\ast} \\neq 0$：\n$$\nr\\left(1-\\frac{N^{\\ast}}{K}\\right) - k_a = 0\n$$\n我们现在解这个关于 $N^{\\ast}$ 的方程，将其表示为参数 $r$，$K$ 和 $k_a$ 的函数。\n$$\nr - \\frac{r N^{\\ast}}{K} - k_a = 0\n$$\n重新整理各项以分离出含有 $N^{\\ast}$ 的项：\n$$\nr - k_a = \\frac{r N^{\\ast}}{K}\n$$\n两边同乘以 $\\frac{K}{r}$ 得到非零平衡点的表达式：\n$$\nN^{\\ast} = \\frac{K}{r}(r - k_a)\n$$\n通过分配因子 $\\frac{K}{r}$，可以将其写成更具说明性的形式：\n$$\nN^{\\ast} = K\\left(1 - \\frac{k_a}{r}\\right)\n$$\n这个非零平衡点的可行性条件是它必须是一个具有物理意义的量，即一个正的种群大小（$N^{\\ast} > 0$）。由于环境承载能力 $K$ 内在地是正的（$K>0$），可行性条件简化为：\n$$\n1 - \\frac{k_a}{r} > 0\n$$\n这个不等式简化为 $1 > \\frac{k_a}{r}$，即 $r > k_a$。其生物学解释很清楚：为了使一个有活力的肿瘤群体能够维持在非零水平，基准单位细胞增殖率（$r$）必须大于单位细胞凋亡率（$k_a$）。如果 $k_a \\geq r$，细胞死亡率等于或超过了最大可能的增殖率，导致种群崩溃至平凡平衡点 $N^{\\ast}=0$。\n\n问题要求计算无量纲比率 $R$：\n$$\nR \\;=\\; \\frac{N^{\\ast}(k_a=0.1\\ \\text{day}^{-1})}{N^{\\ast}(k_a=0)}\n$$\n首先，我们确定分母 $N^{\\ast}(k_a=0)$，它代表在没有细胞凋亡的假设情景下的平衡种群。将 $k_a=0$ 代入 $N^{\\ast}$ 的表达式中：\n$$\nN^{\\ast}(k_a=0) = K\\left(1 - \\frac{0}{r}\\right) = K(1) = K\n$$\n正如预期的那样，在没有凋亡项的情况下，平衡点就是标准逻辑斯谛模型中的环境承载能力 $K$。\n\n现在，我们可以使用 $N^{\\ast}$ 的一般表达式来写出比率 $R$：\n$$\nR = \\frac{K\\left(1 - \\frac{k_a}{r}\\right)}{K} = 1 - \\frac{k_a}{r}\n$$\n给定的参数值为 $r=0.5$ 天$^{-1}$ 和 $k_a=0.1$ 天$^{-1}$。将这些值代入 $R$ 的表达式中：\n$$\nR = 1 - \\frac{0.1 \\text{ day}^{-1}}{0.5 \\text{ day}^{-1}} = 1 - \\frac{1}{5} = 1 - 0.2 = 0.8\n$$\n问题要求答案为保留三位有效数字的小数。因此，我们将结果表示为 $0.800$。", "answer": "$$\\boxed{0.800}$$", "id": "4392029"}, {"introduction": "对癌症系统的深刻理解为我们设计靶向治疗策略提供了基础，其中“合成致死”是一个极具潜力的概念。本练习 [@problem_id:4392039] 构架起定量建模与转化肿瘤学之间的桥梁，介绍了一种发现治疗靶点的计算方法。你将通过分析模拟的CRISPR筛选数据，学习如何定义和计算协同作用得分与治疗影响指数，从而识别出具有合成致死效应的基因对。这项实践展示了如何运用系统生物学原理，来优先选择那些对癌细胞高效且对正常组织安全的联合治疗方案。", "problem": "系统肿瘤学的一个核心目标是识别基因扰动的组合，这些组合能在癌细胞中产生合成致死效应，同时不伤害正常细胞，从而靶向持续性增殖信号和抵抗细胞死亡等核心特征。在高通量成簇规律间隔短回文重复序列 (CRISPR) 筛选中，可观察的量是向导丰度的对数倍数变化 (log-fold change)，该值近似于扰动下相对细胞活力的对数。在没有相互作用的情况下，单基因扰动是独立的，此假设下活力因子是相乘的；因此，在对数域中，预期的组合效应是相加的。与这种可加性的偏离表明存在相互作用（协同作用或拮抗作用）。关于通路串扰的先验生物学知识可以被编码为一个非负的相互作用权重，该权重用于缩放相互作用项对合成致死分数的贡献。然后，治疗决策需要将此分数与基于阈值的约束相结合，这些约束反映了在癌细胞中期望的致死率和在正常细胞中可接受的毒性。\n\n实现一个程序，对于下述每个测试用例，根据癌症和正常细胞的对数倍数变化以及相互作用权重计算合成致死分数，整合基于阈值的组合扰动门控，汇总一个治疗影响指标（该指标奖励超过癌症致死阈值的行为并惩罚违反正常细胞毒性阈值的行为），并根据此预期治疗影响对基因对进行排序。每个测试用例的最终输出应为通过所有门控标准的基因对索引列表，按计算出的预期治疗影响降序排序，若影响相同则按索引升序解决。您的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素本身是表示排序后索引的整数列表，对应一个测试用例的结果。\n\n使用的科学基础和定义：\n- 令 $\\ell_{A}^{c}$、$\\ell_{B}^{c}$ 和 $\\ell_{AB}^{c}$ 分别表示基因 $A$ 单扰动、基因 $B$ 单扰动及其双重扰动的癌细胞对数倍数变化。\n- 令 $\\ell_{A}^{n}$、$\\ell_{B}^{n}$ 和 $\\ell_{AB}^{n}$ 表示在正常细胞中测得的相应对数倍数变化。\n- 独立性意味着在活力空间中，预期的组合效应是乘性的；因此，在对数空间中，预期的组合对数倍数变化是加性的，而相互作用通过与可加性的偏离来量化。\n- 一个非负的相互作用权重 $\\gamma$ 根据先验网络信息，缩放相互作用偏离对合成致死分数的贡献。\n\n您必须严格基于这些原则进行计算，不使用捷径或预先指定的公式。输出必须是通用的，仅依赖于对所提供数字的数学和逻辑运算。\n\n对于每个测试用例，您将获得 $N$ 个基因对（索引为 $0,1,\\dots,N-1$）的参数数组：\n- 癌细胞单扰动：$\\{\\ell_{A,i}^{c}\\}_{i=0}^{N-1}$ 和 $\\{\\ell_{B,i}^{c}\\}_{i=0}^{N-1}$。\n- 癌细胞双扰动：$\\{\\ell_{AB,i}^{c}\\}_{i=0}^{N-1}$。\n- 正常细胞单扰动：$\\{\\ell_{A,i}^{n}\\}_{i=0}^{N-1}$ 和 $\\{\\ell_{B,i}^{n}\\}_{i=0}^{N-1}$。\n- 正常细胞双扰动：$\\{\\ell_{AB,i}^{n}\\}_{i=0}^{N-1}$。\n- 相互作用权重：$\\{\\gamma_{i}\\}_{i=0}^{N-1}$。\n- 全局参数：癌症致死阈值 $\\lambda_{c}$，正常细胞毒性阈值 $\\lambda_{n}$，癌症权重 $w_{c}$，正常细胞惩罚权重 $w_{n}$，正常细胞相互作用惩罚分数 $\\alpha$（其中 $0 \\le \\alpha \\le 1$），协同作用缩放因子 $\\beta > 0$，以及最低合成致死分数阈值 $\\tau_{SL} \\ge 0$。\n\n门控和排序要求：\n- 仅当癌细胞双重扰动达到或超过癌症致死率时，即 $\\ell_{AB,i}^{c} \\le \\lambda_{c}$，才考虑基因对 $i$。\n- 仅当正常细胞双重扰动是可接受的时，即 $\\ell_{AB,i}^{n} \\ge \\lambda_{n}$，才考虑基因对 $i$。\n- 仅当其合成致死分数达到最低阈值时，即至少为 $\\tau_{SL}$，才考虑基因对 $i$。\n- 预期治疗影响必须随着癌症致死率超过 $\\lambda_{c}$ 而增加，并且必须随着对正常细胞毒性相对于 $\\lambda_{n}$ 的违反而减少。\n\n测试套件：\n\n测试用例 1 ($N=5$):\n- 癌细胞单扰动 $\\ell_{A}^{c}$: $[-0.2,-0.8,-0.1,-0.5,0.0]$。\n- 癌细胞单扰动 $\\ell_{B}^{c}$: $[-0.3,-0.7,-0.1,-0.4,0.0]$。\n- 癌细胞双扰动 $\\ell_{AB}^{c}$: $[-1.0,-2.1,-0.2,-1.6,-0.7]$。\n- 正常细胞单扰动 $\\ell_{A}^{n}$: $[-0.1,-0.4,-0.1,-0.2,0.0]$。\n- 正常细胞单扰动 $\\ell_{B}^{n}$: $[-0.05,-0.5,-0.1,-0.1,0.0]$。\n- 正常细胞双扰动 $\\ell_{AB}^{n}$: $[-0.2,-1.5,-0.2,-0.3,-0.4]$。\n- 相互作用权重 $\\gamma$: $[1.2,1.0,0.5,1.5,0.8]$。\n- 全局参数: $\\lambda_{c}=-0.9$, $\\lambda_{n}=-0.5$, $w_{c}=1.0$, $w_{n}=0.7$, $\\alpha=0.5$, $\\beta=1.0$, $\\tau_{SL}=0.3$。\n\n测试用例 2 ($N=3$):\n- 癌细胞单扰动 $\\ell_{A}^{c}$: $[-0.5,-0.2,-0.6]$。\n- 癌细胞单扰动 $\\ell_{B}^{c}$: $[-0.6,-0.3,-0.4]$。\n- 癌细胞双扰动 $\\ell_{AB}^{c}$: $[-1.0,-1.1,-1.0]$。\n- 正常细胞单扰动 $\\ell_{A}^{n}$: $[-0.1,-0.05,-0.2]$。\n- 正常细胞单扰动 $\\ell_{B}^{n}$: $[-0.2,-0.05,-0.2]$。\n- 正常细胞双扰动 $\\ell_{AB}^{n}$: $[-0.4,-0.35,-0.5]$。\n- 相互作用权重 $\\gamma$: $[1.0,1.5,0.9]$。\n- 全局参数: $\\lambda_{c}=-1.0$, $\\lambda_{n}=-0.4$, $w_{c}=1.0$, $w_{n}=1.0$, $\\alpha=0.3$, $\\beta=1.2$, $\\tau_{SL}=0.4$。\n\n测试用例 3 ($N=4$):\n- 癌细胞单扰动 $\\ell_{A}^{c}$: $[-0.4,-0.1,-0.3,-0.5]$。\n- 癌细胞单扰动 $\\ell_{B}^{c}$: $[-0.3,-0.1,-0.3,-0.6]$。\n- 癌细胞双扰动 $\\ell_{AB}^{c}$: $[-1.0,-0.9,-0.7,-1.4]$。\n- 正常细胞单扰动 $\\ell_{A}^{n}$: $[-0.1,-0.05,-0.2,-0.3]$。\n- 正常细胞单扰动 $\\ell_{B}^{n}$: $[-0.1,-0.05,-0.2,-0.3]$。\n- 正常细胞双扰动 $\\ell_{AB}^{n}$: $[-0.7,-0.55,-0.65,-0.9]$。\n- 相互作用权重 $\\gamma$: $[0.0,1.1,0.7,1.3]$。\n- 全局参数: $\\lambda_{c}=-0.8$, $\\lambda_{n}=-0.6$, $w_{c}=0.8$, $w_{n}=0.6$, $\\alpha=0.5$, $\\beta=1.0$, $\\tau_{SL}=0.2$。\n\n最终输出格式：\n- 您的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素是相应测试用例的排序后索引列表（例如，`[[i_{1},i_{2}], [j_{1}], [k_{1},k_{2},k_{3}]]`）。不应打印任何额外文本。", "solution": "该问题是有效的，因为它在科学上基于系统肿瘤学的原理，定义明确，并且提供了所有必要的参数和定义。问题的核心在于从第一性原理形式化合成致死分数（$SLS$）和治疗影响指标（$TI$）的概念，然后应用一系列已定义的计算步骤。\n\n### 基于原则的评分指标推导\n\n解决方案需要推导两个关键指标：合成致死分数（$SLS$）和治疗影响（$TI$）。\n\n1.  **相互作用分数 ($S$):** 问题陈述，对于非相互作用的基因扰动，其对活力的组合效应是乘性的。在对数倍数变化（$\\ell$）的对数域中，这转化为可加性。假设独立，基因 $A$ 和 $B$ 双重扰动的预期对数倍数变化是 $\\ell_{A} + \\ell_{B}$。相互作用是与此预期值的偏差。在癌细胞中期望的协同相互作用，对应于测得的双重扰动效应 $\\ell_{AB}$ 比单一效应之和更负（更具致死性）。我们将协同作用分数 $S$ 定义为该偏差的负值，因此正值表示协同作用。\n    对于给定的基因对 $i$，癌细胞协同作用分数（$S_{c,i}$）和正常细胞协同作用分数（$S_{n,i}$）因此为：\n    $$S_{c,i} = (\\ell_{A,i}^{c} + \\ell_{B,i}^{c}) - \\ell_{AB,i}^{c}$$\n    $$S_{n,i} = (\\ell_{A,i}^{n} + \\ell_{B,i}^{n}) - \\ell_{AB,i}^{n}$$\n    正的 $S_{c,i}$ 表示治疗协同作用，而正的 $S_{n,i}$ 表示毒性协同作用。\n\n2.  **合成致死分数 ($SLS$):** 此分数量化了协同相互作用的治疗潜力。它必须包含由相互作用权重 $\\gamma_i$ 编码的先验生物学知识、通过分数 $\\alpha$ 对正常细胞相互作用的惩罚，以及一个整体协同作用缩放因子 $\\beta$。一个合乎逻辑的构造是奖励癌症特异性协同作用并惩罚正常细胞协同作用。我们假设只有协同相互作用（其中 $S_{c,i} > 0$ 或 $S_{n,i} > 0$）对分数有贡献。这通过使用 $\\max(0, \\cdot)$ 函数来实现。\n    基因对 $i$ 的 $SLS$ 公式为：\n    $$SLS_i = \\beta \\left( \\gamma_i \\cdot \\max(0, S_{c,i}) - \\alpha \\cdot \\max(0, S_{n,i}) \\right)$$\n    该公式确保分数随着加权的癌症协同作用（$\\gamma_i S_{c,i}$）增加而增加，并随着加权的正常细胞协同作用（$\\alpha S_{n,i}$）增加而减少。\n\n3.  **治疗影响 ($TI$):** $TI$ 指标用于对已通过所有准入过滤器（门控标准）的基因对进行排序。问题陈述，它应该奖励超过阈值 $\\lambda_c$ 的癌细胞致死率，并惩罚相对于阈值 $\\lambda_n$ 的正常细胞毒性。\n    对癌症致死率的奖励可以建模为 $w_c \\cdot (\\lambda_c - \\ell_{AB,i}^{c})$，该值随着 $\\ell_{AB,i}^{c}$ 变得更负而增加。对正常细胞毒性的惩罚可以建模为 $w_n \\cdot (\\lambda_n - \\ell_{AB,i}^{n})$，该值随着 $\\ell_{AB,i}^{n}$ 变得比 $\\lambda_n$ 更负而增加。\n    完整的概念定义是：\n    $$TI_i = w_c \\cdot \\max(0, \\lambda_c - \\ell_{AB,i}^{c}) - w_n \\cdot \\max(0, \\lambda_n - \\ell_{AB,i}^{n})$$\n    然而，排序仅对通过门控标准的基因对执行。对于一个通过的基因对，我们知道 $\\ell_{AB,i}^{c} \\le \\lambda_c$ 和 $\\ell_{AB,i}^{n} \\ge \\lambda_n$。\n    - 第一个条件意味着 $\\lambda_c - \\ell_{AB,i}^{c} \\ge 0$，所以 $\\max(0, \\lambda_c - \\ell_{AB,i}^{c})$ 简化为 $(\\lambda_c - \\ell_{AB,i}^{c})$。\n    - 第二个条件意味着 $\\lambda_n - \\ell_{AB,i}^{n} \\le 0$，所以 $\\max(0, \\lambda_n - \\ell_{AB,i}^{n})$ 简化为 $0$。\n    因此，对于任何通过门控的基因对，治疗影响指标简化为：\n    $$TI_i = w_c \\cdot (\\lambda_c - \\ell_{AB,i}^{c})$$\n    这意味着，在被认为足够安全和有效的候选者中，最终排名仅由癌细胞致死率的大小决定。\n\n### 算法流程\n\n对于每个测试用例，算法对每个基因对 $i=0, \\dots, N-1$ 执行以下步骤：\n1.  **计算协同作用分数：** 使用推导出的公式计算 $S_{c,i}$ 和 $S_{n,i}$。\n2.  **计算合成致死分数：** 使用其推导出的公式计算 $SLS_i$。\n3.  **应用门控标准：** 一个基因对 $i$ 被视为候选者，当且仅当以下所有三个条件都满足时：\n    - 癌症致死门控：$\\ell_{AB,i}^{c} \\le \\lambda_c$\n    - 正常细胞毒性门控：$\\ell_{AB,i}^{n} \\ge \\lambda_n$\n    - $SLS$ 阈值门控：$SLS_i \\ge \\tau_{SL}$\n4.  **筛选并存储候选者：** 对于每个通过所有三个门控的基因对，计算其治疗影响 $TI_i$ 并存储对 $(TI_i, i)$。\n5.  **排序和输出：** 对存储的候选元组列表进行排序。主要排序键是 $TI_i$，按降序排列。平局通过次要键，即索引 $i$，按升序解决。该测试用例的最终结果是排序后的索引列表。\n\n这种结构化的、原则驱动的方法确保了问题的所有约束都以逻辑上一致且科学上合理的方式得到满足。为提高效率，计算使用 `numpy` 库的向量化操作实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the systems oncology gene pair ranking problem based on a set of test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"lAc\": np.array([-0.2,-0.8,-0.1,-0.5,0.0]),\n            \"lBc\": np.array([-0.3,-0.7,-0.1,-0.4,0.0]),\n            \"lABc\": np.array([-1.0,-2.1,-0.2,-1.6,-0.7]),\n            \"lAn\": np.array([-0.1,-0.4,-0.1,-0.2,0.0]),\n            \"lBn\": np.array([-0.05,-0.5,-0.1,-0.1,0.0]),\n            \"lABn\": np.array([-0.2,-1.5,-0.2,-0.3,-0.4]),\n            \"gamma\": np.array([1.2,1.0,0.5,1.5,0.8]),\n            \"params\": {\"lambda_c\": -0.9, \"lambda_n\": -0.5, \"w_c\": 1.0, \"w_n\": 0.7, \"alpha\": 0.5, \"beta\": 1.0, \"tau_SL\": 0.3}\n        },\n        {\n            \"lAc\": np.array([-0.5,-0.2,-0.6]),\n            \"lBc\": np.array([-0.6,-0.3,-0.4]),\n            \"lABc\": np.array([-1.0,-1.1,-1.0]),\n            \"lAn\": np.array([-0.1,-0.05,-0.2]),\n            \"lBn\": np.array([-0.2,-0.05,-0.2]),\n            \"lABn\": np.array([-0.4,-0.35,-0.5]),\n            \"gamma\": np.array([1.0,1.5,0.9]),\n            \"params\": {\"lambda_c\": -1.0, \"lambda_n\": -0.4, \"w_c\": 1.0, \"w_n\": 1.0, \"alpha\": 0.3, \"beta\": 1.2, \"tau_SL\": 0.4}\n        },\n        {\n            \"lAc\": np.array([-0.4,-0.1,-0.3,-0.5]),\n            \"lBc\": np.array([-0.3,-0.1,-0.3,-0.6]),\n            \"lABc\": np.array([-1.0,-0.9,-0.7,-1.4]),\n            \"lAn\": np.array([-0.1,-0.05,-0.2,-0.3]),\n            \"lBn\": np.array([-0.1,-0.05,-0.2,-0.3]),\n            \"lABn\": np.array([-0.7,-0.55,-0.65,-0.9]),\n            \"gamma\": np.array([0.0,1.1,0.7,1.3]),\n            \"params\": {\"lambda_c\":-0.8, \"lambda_n\": -0.6, \"w_c\": 0.8, \"w_n\": 0.6, \"alpha\": 0.5, \"beta\": 1.0, \"tau_SL\": 0.2}\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        lAc, lBc, lABc = case[\"lAc\"], case[\"lBc\"], case[\"lABc\"]\n        lAn, lBn, lABn = case[\"lAn\"], case[\"lBn\"], case[\"lABn\"]\n        gamma = case[\"gamma\"]\n        p = case[\"params\"]\n        lambda_c, lambda_n, w_c, w_n, alpha, beta, tau_SL = \\\n            p[\"lambda_c\"], p[\"lambda_n\"], p[\"w_c\"], p[\"w_n\"], p[\"alpha\"], p[\"beta\"], p[\"tau_SL\"]\n        \n        # 1. Calculate Synergy Scores\n        S_c = (lAc + lBc) - lABc\n        S_n = (lAn + lBn) - lABn\n\n        # 2. Calculate Synthetic Lethality Score (SLS)\n        SLS = beta * (gamma * np.maximum(0, S_c) - alpha * np.maximum(0, S_n))\n        \n        # 3. Apply Gating Criteria\n        gate1_pass = lABc = lambda_c\n        gate2_pass = lABn >= lambda_n\n        gate3_pass = SLS >= tau_SL\n\n        passing_indices = np.where(gate1_pass  gate2_pass  gate3_pass)[0]\n        \n        candidates = []\n        if passing_indices.size > 0:\n            # 4. Calculate Therapeutic Impact (TI) for passing pairs\n            TI_values = w_c * (lambda_c - lABc[passing_indices])\n            \n            # 5. Store candidates for sorting\n            candidates = list(zip(TI_values, passing_indices))\n            \n            # 6. Rank candidates: TI descending, index ascending\n            candidates.sort(key=lambda x: (-x[0], x[1]))\n            \n        ranked_indices = [idx for ti, idx in candidates]\n        all_results.append(ranked_indices)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f'[{\",\".join(map(str, r))}]' for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n```", "id": "4392039"}]}