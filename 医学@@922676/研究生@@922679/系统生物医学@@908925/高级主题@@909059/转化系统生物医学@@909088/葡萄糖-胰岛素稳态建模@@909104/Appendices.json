{"hands_on_practices": [{"introduction": "调控血糖稳态的复杂反馈回路导致了内在的非线性数学模型。为了应用线性系统理论中强大的分析工具，我们通常围绕生理稳态对这些模型进行线性化处理。本实践将引导您完成从一个非线性房室模型推导出一个线性时不变（LTI）状态空间表达式的基本过程，这是控制器设计和系统分析的一项基石技能。[@problem_id:4348634]", "problem": "考虑一个用于葡萄糖-胰岛素调节的非线性房室模型，该模型源自质量平衡和一级动力学，并包含一个介导胰岛素依赖性葡萄糖摄取的远程胰岛素作用房室。设状态变量为血浆葡萄糖浓度 $G(t)$、血浆胰岛素浓度 $I(t)$ 和远程胰岛素作用 $X(t)$。设外源输入为葡萄糖出现率 $u_{g}(t)$ 和外源胰岛素输注率 $u_{i}(t)$。其控制常微分方程 (ODE) 如下\n$$\n\\frac{dG}{dt} \\;=\\; -\\,k_{g}\\,\\big(G(t)-G_{b}\\big)\\;-\\;X(t)\\,G(t)\\;+\\;u_{g}(t),\n$$\n$$\n\\frac{dI}{dt} \\;=\\; -\\,k_{i}\\,\\big(I(t)-I_{b}\\big)\\;+\\;S\\!\\big(G(t)\\big)\\;-\\;S(G_{b})\\;+\\;u_{i}(t),\n$$\n$$\n\\frac{dX}{dt} \\;=\\; -\\,k_{x}\\,X(t)\\;+\\;k_{xi}\\,\\big(I(t)-I_{b}\\big),\n$$\n其中，$k_{g}>0$ 代表一级基础葡萄糖处置率，$k_{i}>0$ 是一级胰岛素清除率，$k_{x}>0$ 是一级远程胰岛素作用清除率，而 $k_{xi}>0$ 将胰岛素与远程作用的产生耦合起来。胰腺分泌函数 $S(G)$ 被建模为一个可饱和的 S 型响应\n$$\nS(G) \\;=\\; \\frac{\\sigma}{1+\\exp\\!\\big(-\\,m\\,\\big(G-G_{b}\\big)\\big)},\n$$\n其最大分泌规模为 $\\sigma>0$，灵敏度斜率为 $m>0$，并以基础葡萄糖 $G_{b}$ 为中心，因此 $S(G_{b})=\\sigma/2$。在零外源输入下，基础三元组 $\\big(G_{b},I_{b},X_{b}\\big)$ 处于平衡状态，输出取为血浆葡萄糖 $y(t)=G(t)$。\n\n从房室动力学的守恒律推理和 $S(G)$ 的平滑性出发，将非线性系统在零输入的基准工作点附近进行线性化。推导一个适用于控制器设计的线性时不变 (LTI) 近似，该近似以状态空间形式表示，使用偏差变量 $g(t)=G(t)-G_{b}$，$i(t)=I(t)-I_{b}$ 和 $x(t)=X(t)-X_{b}$：\n$$\n\\frac{d}{dt}\\begin{pmatrix}g\\\\[4pt]i\\\\[4pt]x\\end{pmatrix}\n\\;=\\;\nA\\,\\begin{pmatrix}g\\\\[4pt]i\\\\[4pt]x\\end{pmatrix}\n\\;+\\;\nB\\,\\begin{pmatrix}u_{g}\\\\[4pt]u_{i}\\end{pmatrix},\n\\qquad\ny \\;=\\; C\\,\\begin{pmatrix}g\\\\[4pt]i\\\\[4pt]x\\end{pmatrix} \\;+\\; D\\,\\begin{pmatrix}u_{g}\\\\[4pt]u_{i}\\end{pmatrix}.\n$$\n\n将矩阵 $A$、$B$、$C$ 和 $D$ 明确地用参数 $k_{g}$、$k_{i}$、$k_{x}$、$k_{xi}$、$\\sigma$、$m$ 和基础葡萄糖 $G_{b}$ 表示，仅使用在基础平衡点处的求值结果。通过写出一个条目依次为 $A$、$B$、$C$ 和 $D$ 的行矩阵，将你的最终答案报告为单个解析表达式。不需要数值。不需要四舍五入。最终答案必须只包含解析表达式，并且在方框形式中不得包含任何单位。", "solution": "用户希望找到一个用于葡萄糖-胰岛素调节的非线性生理模型的线性化状态空间表示。该过程涉及将给定的非线性常微分方程 (ODE) 系统在其基础平衡点附近进行线性化。\n\n### 第 1 步：问题验证\n\n首先根据所需标准对问题进行验证。\n\n**1.1. 提取的已知条件：**\n-   **状态变量：**血浆葡萄糖浓度 $G(t)$、血浆胰岛素浓度 $I(t)$ 和远程胰岛素作用 $X(t)$。\n-   **输入：**外源葡萄糖出现率 $u_{g}(t)$ 和外源胰岛素输注率 $u_{i}(t)$。\n-   **系统动力学 (ODE)：**\n    $$\n    \\frac{dG}{dt} \\;=\\; -\\,k_{g}\\,\\big(G(t)-G_{b}\\big)\\;-\\;X(t)\\,G(t)\\;+\\;u_{g}(t)\n    $$\n    $$\n    \\frac{dI}{dt} \\;=\\; -\\,k_{i}\\,\\big(I(t)-I_{b}\\big)\\;+\\;S\\!\\big(G(t)\\big)\\;-\\;S(G_{b})\\;+\\;u_{i}(t)\n    $$\n    $$\n    \\frac{dX}{dt} \\;=\\; -\\,k_{x}\\,X(t)\\;+\\;k_{xi}\\,\\big(I(t)-I_{b}\\big)\n    $$\n-   **胰腺分泌函数：**\n    $$\n    S(G) \\;=\\; \\frac{\\sigma}{1+\\exp\\!\\big(-\\,m\\,\\big(G-G_{b}\\big)\\big)}\n    $$\n-   **参数：**$k_{g}>0$、$k_{i}>0$、$k_{x}>0$、$k_{xi}>0$、$\\sigma>0$、$m>0$ 以及基础葡萄糖 $G_{b}$。\n-   **平衡点：**三元组 $(G_{b}, I_{b}, X_{b})$ 是在零输入（$u_{g}(t)=0$ 和 $u_{i}(t)=0$）下的平衡点。\n-   **输出：**$y(t) = G(t)$。\n-   **任务：**推导系统的线性时不变 (LTI) 状态空间矩阵 $A$、$B$、$C$ 和 $D$，该系统用偏差变量 $g(t)=G(t)-G_{b}$、$i(t)=I(t)-I_{b}$ 和 $x(t)=X(t)-X_{b}$ 表示。\n\n**1.2. 验证：**\n-   **科学依据：**该模型是 Bergman Minimal Model 的一个变体，后者是系统生物医学中用于葡萄糖稳态的房室建模的基石。它基于已确立的质量平衡和反应动力学原理。该模型在科学上是合理的。\n-   **适定性：**任务是将一个平滑的非线性系统在一个平衡点附近线性化，这是控制理论中一个标准且定义明确的数学问题。\n-   **客观性与完整性：**问题使用精确的数学语言陈述。所有必要的方程、参数和条件都已提供。我们必须验证平衡条件的一致性。在零输入的平衡状态下，所有时间导数均为零：\n    -   由 $\\frac{dG}{dt}=0$ 得：$-k_{g}(G_{b}-G_{b}) - X_{b}G_{b} + 0 = 0 \\implies -X_{b}G_{b} = 0$。由于基础葡萄糖 $G_{b}$ 必须为正，这意味着 $X_{b}=0$。\n    -   由 $\\frac{dX}{dt}=0$ 得：$-k_{x}X_{b} + k_{xi}(I_{b}-I_{b}) = 0 \\implies -k_{x}X_{b} = 0$。由于 $k_{x}>0$，这也意味着 $X_{b}=0$。\n    -   由 $\\frac{dI}{dt}=0$ 得：$-k_{i}(I_{b}-I_{b}) + S(G_{b}) - S(G_{b}) + 0 = 0 \\implies 0=0$。\n    所有条件都是一致的。$X$ 的平衡值为 $X_{b}=0$。问题是自洽且一致的。\n\n**1.3. 结论：**问题有效。\n\n### 第 2 步：推导 LTI 状态空间模型\n\n非线性系统 $\\frac{d\\mathbf{z}}{dt} = \\mathbf{f}(\\mathbf{z}, \\mathbf{u})$ 和 $y = h(\\mathbf{z}, \\mathbf{u})$ 在平衡点 $(\\mathbf{z}_b, \\mathbf{u}_b)$ 附近的线性化由以下公式给出：\n$$\n\\frac{d(\\delta\\mathbf{z})}{dt} = A\\,\\delta\\mathbf{z} + B\\,\\delta\\mathbf{u}\n$$\n$$\n\\delta y = C\\,\\delta\\mathbf{z} + D\\,\\delta\\mathbf{u}\n$$\n其中 $\\delta\\mathbf{z} = \\mathbf{z} - \\mathbf{z}_b$，$\\delta\\mathbf{u} = \\mathbf{u} - \\mathbf{u}_b$，以及 $\\delta y = y - y_b$。矩阵是在平衡点处求值的雅可比矩阵：\n$$\nA = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{z}}\\bigg|_{\\mathbf{z}_b, \\mathbf{u}_b}, \\quad B = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{u}}\\bigg|_{\\mathbf{z}_b, \\mathbf{u}_b}, \\quad C = \\frac{\\partial h}{\\partial \\mathbf{z}}\\bigg|_{\\mathbf{z}_b, \\mathbf{u}_b}, \\quad D = \\frac{\\partial h}{\\partial \\mathbf{u}}\\bigg|_{\\mathbf{z}_b, \\mathbf{u}_b}\n$$\n这里，状态向量是 $\\mathbf{z} = \\begin{pmatrix} G  I  X \\end{pmatrix}^T$，输入向量是 $\\mathbf{u} = \\begin{pmatrix} u_g  u_i \\end{pmatrix}^T$，偏差状态向量是 $\\delta\\mathbf{z} = \\begin{pmatrix} g  i  x \\end{pmatrix}^T$。平衡点是 $(\\mathbf{z}_b, \\mathbf{u}_b) = ((G_b, I_b, X_b=0), (0, 0))$。输出是 $y=G$，所以其偏差是 $\\delta y = g$。\n\n向量函数 $\\mathbf{f}$ 为：\n$$\n\\mathbf{f}(G, I, X, u_g, u_i) = \\begin{pmatrix} -k_{g}(G-G_{b}) - XG + u_{g} \\\\ -k_{i}(I-I_{b}) + S(G) - S(G_{b}) + u_{i} \\\\ -k_{x}X + k_{xi}(I-I_{b}) \\end{pmatrix}\n$$\n\n**2.1. 矩阵 A 的计算**\n$A$ 是 $\\mathbf{f}$ 关于状态向量 $\\mathbf{z} = \\begin{pmatrix} G  I  X \\end{pmatrix}^T$ 的雅可比矩阵。\n$$\nA = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial G}  \\frac{\\partial f_1}{\\partial I}  \\frac{\\partial f_1}{\\partial X} \\\\ \\frac{\\partial f_2}{\\partial G}  \\frac{\\partial f_2}{\\partial I}  \\frac{\\partial f_2}{\\partial X} \\\\ \\frac{\\partial f_3}{\\partial G}  \\frac{\\partial f_3}{\\partial I}  \\frac{\\partial f_3}{\\partial X} \\end{pmatrix}_{\\text{eq}}\n$$\n偏导数如下：\n- $\\frac{\\partial f_1}{\\partial G} = -k_g - X$。在平衡点处，其值为 $-k_g - X_b = -k_g$。\n- $\\frac{\\partial f_1}{\\partial I} = 0$。\n- $\\frac{\\partial f_1}{\\partial X} = -G$。在平衡点处，其值为 $-G_b$。\n- $\\frac{\\partial f_2}{\\partial G} = S'(G)$。S 型函数 $S(G)$ 的导数为 $S'(G) = \\frac{d}{dG}\\left( \\frac{\\sigma}{1+\\exp(-m(G-G_b))} \\right) = \\frac{\\sigma m \\exp(-m(G-G_b))}{(1+\\exp(-m(G-G_b)))^2}$。在平衡点 $G=G_b$ 处，我们有 $S'(G_b) = \\frac{\\sigma m \\exp(0)}{(1+\\exp(0))^2} = \\frac{\\sigma m}{(1+1)^2} = \\frac{\\sigma m}{4}$。\n- $\\frac{\\partial f_2}{\\partial I} = -k_i$。\n- $\\frac{\\partial f_2}{\\partial X} = 0$。\n- $\\frac{\\partial f_3}{\\partial G} = 0$。\n- $\\frac{\\partial f_3}{\\partial I} = k_{xi}$。\n- $\\frac{\\partial f_3}{\\partial X} = -k_x$。\n\n将这些值组合起来得到矩阵 $A$：\n$$\nA = \\begin{pmatrix} -k_g  0  -G_b \\\\ \\frac{\\sigma m}{4}  -k_i  0 \\\\ 0  k_{xi}  -k_x \\end{pmatrix}\n$$\n\n**2.2. 矩阵 B 的计算**\n$B$ 是 $\\mathbf{f}$ 关于输入向量 $\\mathbf{u} = \\begin{pmatrix} u_g  u_i \\end{pmatrix}^T$ 的雅可比矩阵。\n$$\nB = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial u_g}  \\frac{\\partial f_1}{\\partial u_i} \\\\ \\frac{\\partial f_2}{\\partial u_g}  \\frac{\\partial f_2}{\\partial u_i} \\\\ \\frac{\\partial f_3}{\\partial u_g}  \\frac{\\partial f_3}{\\partial u_i} \\end{pmatrix}_{\\text{eq}}\n$$\n偏导数如下：\n- $\\frac{\\partial f_1}{\\partial u_g} = 1$, $\\frac{\\partial f_1}{\\partial u_i} = 0$。\n- $\\frac{\\partial f_2}{\\partial u_g} = 0$, $\\frac{\\partial f_2}{\\partial u_i} = 1$。\n- $\\frac{\\partial f_3}{\\partial u_g} = 0$, $\\frac{\\partial f_3}{\\partial u_i} = 0$。\n这些导数是常数，所以矩阵 $B$ 是：\n$$\nB = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix}\n$$\n\n**2.3. 矩阵 C 的计算**\n$C$ 是输出函数 $h=G$ 关于状态向量 $\\mathbf{z}$ 的雅可比矩阵。LTI 系统的输出是偏差 $y_{dev} = g(t)$。\n$$\ny_{dev} = g(t) = G(t)-G_b = 1 \\cdot g(t) + 0 \\cdot i(t) + 0 \\cdot x(t)\n$$\n因此，$C$ 是一个行向量：\n$$\nC = \\begin{pmatrix} 1  0  0 \\end{pmatrix}\n$$\n\n**2.4. 矩阵 D 的计算**\n$D$ 是输出函数 $h=G$ 关于输入向量 $\\mathbf{u}$ 的雅可比矩阵。由于输出函数 $h=G$ 并不显式依赖于 $u_g$ 或 $u_i$，其偏导数为零。\n$$\n\\frac{\\partial h}{\\partial u_g} = 0, \\quad \\frac{\\partial h}{\\partial u_i} = 0\n$$\n因此，$D$ 是一个零行向量：\n$$\nD = \\begin{pmatrix} 0  0 \\end{pmatrix}\n$$\n\n最终用偏差变量表示的 LTI 系统为：\n$$\n\\frac{d}{dt}\\begin{pmatrix}g\\\\i\\\\x\\end{pmatrix}\n=\n\\begin{pmatrix} -k_g  0  -G_b \\\\ \\frac{\\sigma m}{4}  -k_i  0 \\\\ 0  k_{xi}  -k_x \\end{pmatrix}\n\\begin{pmatrix}g\\\\i\\\\x\\end{pmatrix}\n+\n\\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix}\n\\begin{pmatrix}u_{g}\\\\u_{i}\\end{pmatrix}\n$$\n$$\ny_{dev} = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix}g\\\\i\\\\x\\end{pmatrix} + \\begin{pmatrix} 0  0 \\end{pmatrix} \\begin{pmatrix}u_{g}\\\\u_{i}\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} -k_{g}  0  -G_{b} \\\\ \\frac{\\sigma m}{4}  -k_{i}  0 \\\\ 0  k_{xi}  -k_{x} \\end{pmatrix}\n\n\\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix}\n\n\\begin{pmatrix} 1  0  0 \\end{pmatrix}\n\n\\begin{pmatrix} 0  0 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$", "id": "4348634"}, {"introduction": "生理控制系统很少是瞬时响应的；激素运输、信号传导和作用中的时间延迟是普遍存在的。这些延迟会深刻影响系统稳定性，可能导致不希望的振荡。本练习使用一个延迟微分方程（DDE）来模拟葡萄糖调控，探讨了这一关键概念，要求您推导出延迟引发振荡出现的精确条件，以及如何通过控制器调优来防止它们。[@problem_id:4348659]", "problem": "考虑一个在基础稳态附近的闭环血糖控制场景，其中血浆葡萄糖浓度的小偏差（记为 $g(t)$）由胰岛素调节，其作用受到因转运和受体信号传导引起的生理延迟的影响。假设采用以下基于质量平衡和围绕基础值进行线性化的建模框架：\n\n- 葡萄糖偏差 $g(t)$ 的变化率是流入和流出之间的差值。非胰岛素依赖的葡萄糖清除贡献了一个与当前偏差成正比的项，即 $-a\\,g(t)$（其中 $a>0$），反映了例如在基础状态附近非胰岛素依赖的摄取和肾脏排泄。\n- 胰岛素依赖的摄取是由具有固定生理延迟 $\\tau>0$ 的胰岛素作用驱动的。在使用增益为 $K>0$ 的比例控制器对葡萄糖偏差进行闭环控制时，对葡萄糖的有效延迟负反馈在小信号下可以用项 $-K\\,g(t-\\tau)$ 来表示。\n\n在这些假设下，小信号葡萄糖动力学由线性时不变延迟微分方程（Delay Differential Equation, DDE）建模：\n$$\n\\frac{d}{dt}g(t)\\;=\\;-a\\,g(t)\\;-\\;K\\,g(t-\\tau).\n$$\n\n从该模型和上述定义出发，根据第一性原理推导由于延迟 $\\tau$ 而在 $g(t)$ 中产生持续振荡的条件，并确定一对特征根穿过虚轴（振荡开始）时的临界延迟 $\\tau_{c}(K)$。说明控制器增益 $K$ 如何调节 $\\tau_{c}(K)$，并解释消除延迟引起的振荡的调节原则。\n\n答案要求：\n- 提供关于 $a$ 和 $K$ 的最小正临界延迟 $\\tau_{c}(K)$ 的单个闭式解析表达式。\n- 假设 $a$ 和 $K$ 的单位为 $\\text{min}^{-1}$，将临界延迟以分钟表示。\n- 最终答案必须是单个闭式表达式；不要提供不等式或多种情况。", "solution": "问题要求推导在一个由线性延迟微分方程（DDE）描述的系统中，出现持续振荡时的临界延迟 $\\tau_{c}(K)$。\n\n血浆葡萄糖浓度偏差 $g(t)$ 的控制方程如下：\n$$\n\\frac{d}{dt}g(t) = -a\\,g(t) - K\\,g(t-\\tau)\n$$\n其中 $a > 0$ 是非胰岛素依赖的清除率，$K > 0$ 是比例控制器增益，$\\tau > 0$ 是生理延迟。\n\n为了分析稳态 $g(t) = 0$ 的稳定性，我们寻求形式为 $g(t) = C\\exp(\\lambda t)$ 的解，其中 $C$ 是一个常数，$\\lambda$ 是表示特征根或特征值的复数。将此试探解代入 DDE 得到：\n$$\n\\lambda C\\exp(\\lambda t) = -a\\,C\\exp(\\lambda t) - K\\,C\\exp(\\lambda(t-\\tau))\n$$\n两边除以 $C\\exp(\\lambda t)$（假设存在非平凡解，$C \\neq 0$），我们得到关于 $\\lambda$ 的特征方程：\n$$\n\\lambda = -a - K\\exp(-\\lambda \\tau)\n$$\n这可以改写为：\n$$\n\\lambda + a + K\\exp(-\\lambda \\tau) = 0\n$$\n稳态 $g(t)=0$ 的稳定性由根 $\\lambda$ 的实部决定。系统是渐近稳定的当且仅当所有根的 $\\text{Re}(\\lambda)  0$。当一对共轭复根穿过虚轴，即其实部变为零时，出现持续振荡。这是 Hopf 分岔的开始。\n\n因此，我们寻找根具有形式 $\\lambda = i\\omega$ 的条件，其中 $\\omega$ 是一个实数、非零的角频率。由于特征方程的系数是实数，如果 $i\\omega$ 是一个根，那么它的共轭复数 $-i\\omega$ 也必须是一个根。不失一般性，我们可以假设 $\\omega  0$。临界延迟 $\\tau_c$ 是存在这样一个根的最小正 $\\tau$ 值。\n\n将 $\\lambda = i\\omega$ 代入特征方程得到：\n$$\ni\\omega + a + K\\exp(-i\\omega\\tau_c) = 0\n$$\n使用欧拉公式 $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$，我们可以展开指数项：\n$$\ni\\omega + a + K(\\cos(\\omega\\tau_c) - i\\sin(\\omega\\tau_c)) = 0\n$$\n为了使这个复数方程成立，其实部和虚部都必须为零。\n\n分离实部和虚部：\n实部：\n$$\na + K\\cos(\\omega\\tau_c) = 0\n$$\n$$\n\\cos(\\omega\\tau_c) = -\\frac{a}{K} \\quad (1)\n$$\n虚部：\n$$\n\\omega - K\\sin(\\omega\\tau_c) = 0\n$$\n$$\n\\sin(\\omega\\tau_c) = \\frac{\\omega}{K} \\quad (2)\n$$\n\n这两个方程必须被求解以得到未知数 $\\omega$ 和 $\\tau_c$。我们可以使用基本三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$。将方程 $(1)$ 和 $(2)$ 平方并相加：\n$$\n\\left(-\\frac{a}{K}\\right)^2 + \\left(\\frac{\\omega}{K}\\right)^2 = 1\n$$\n$$\n\\frac{a^2}{K^2} + \\frac{\\omega^2}{K^2} = 1\n$$\n乘以 $K^2$：\n$$\na^2 + \\omega^2 = K^2\n$$\n求解振荡频率 $\\omega$：\n$$\n\\omega^2 = K^2 - a^2\n$$\n由于 $\\omega$ 必须是实频率，所以 $\\omega^2$ 必须为正。这为振荡的发生施加了一个必要条件：\n$$\nK^2 - a^2  0 \\implies K  a\n$$\n（因为 $K$ 和 $a$ 都被定义为正数）。如果此条件成立，出现的振荡频率为：\n$$\n\\omega = \\sqrt{K^2 - a^2}\n$$\n\n现在我们求解临界延迟 $\\tau_c$。从方程 $(1)$ 和 $(2)$，我们确定了 $\\cos(\\omega\\tau_c)$ 和 $\\sin(\\omega\\tau_c)$ 的值。由于 $Ka0$ 且 $\\omega0$，我们有 $\\cos(\\omega\\tau_c)  0$ 和 $\\sin(\\omega\\tau_c)  0$。这表明角 $\\omega\\tau_c$ 必须位于第二象限。\n\n满足此条件的最小正角可以使用反余弦函数找到。对于 $x \\in [-1, 1]$，$\\arccos(x)$ 的主值在 $[0, \\pi]$ 范围内。由于我们的自变量 $-a/K$ 在 $(-1, 0)$ 范围内，$\\arccos(-a/K)$ 将在 $(\\pi/2, \\pi)$ 范围内，这正是在第二象限。\n\n该角的通解为 $\\omega\\tau_c = \\arccos(-a/K) + 2n\\pi$，其中 $n$ 为任意整数。最小正临界延迟 $\\tau_c$ 对应于当 $\\tau$ 从 0 增加时首次穿越虚轴的情况，这对应于 $n=0$。\n$$\n\\omega\\tau_c = \\arccos\\left(-\\frac{a}{K}\\right)\n$$\n分离出 $\\tau_c$：\n$$\n\\tau_c = \\frac{1}{\\omega} \\arccos\\left(-\\frac{a}{K}\\right)\n$$\n代入 $\\omega$ 的表达式：\n$$\n\\tau_c(K) = \\frac{1}{\\sqrt{K^2 - a^2}} \\arccos\\left(-\\frac{a}{K}\\right)\n$$\n这就是最小正临界延迟的闭式解析表达式。鉴于 $a$ 和 $K$ 的单位是 $\\text{min}^{-1}$，项 $\\sqrt{K^2-a^2}$ 的单位也是 $\\text{min}^{-1}$，因此 $\\tau_c$ 的单位将是分钟，符合要求。\n\n消除延迟引起的振荡的调节原则直接从其存在的必要条件中推导出来。只有当 $K  a$ 时，振荡才可能发生。因此，为了保证系统对任何延迟 $\\tau0$ 都稳定，控制器增益 $K$ 的选择必须满足 $K \\le a$。在这种情况下，由非胰岛素依赖的葡萄糖清除（与 $a$ 成正比）提供的内在阻尼足够强大，可以防止延迟反馈回路引发不稳定性，无论延迟时间有多长。", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{K^2 - a^2}} \\arccos\\left(-\\frac{a}{K}\\right)}\n$$", "id": "4348659"}, {"introduction": "尽管我们可以连续监测像血糖这样的变量，但许多关键的生理状态，例如胰岛素的远程作用，仍然是无法测量的。扩展卡尔曼滤波器（EKF）是一种强大的算法，它利用系统的非线性模型，从带噪声的测量中估计这些隐藏状态。本实践将让您亲手执行EKF的单个测量更新步骤，从而提供具体的实践经验，展示新信息是如何被整合以优化我们对系统状态的认知的。[@problem_id:4348707]", "problem": "您正在使用一个通过对连续模型进行一阶前向欧拉离散化得到的离散时间公式，来为一个非线性两状态最小模型建立葡萄糖-胰岛素稳态模型。令状态向量为 $x_k = \\begin{pmatrix} g_k \\\\ a_k \\end{pmatrix}$，其中 $g_k$ 是血浆葡萄糖浓度相对于基础值的偏差，单位为 $\\mathrm{mg/dL}$，$a_k$ 是远端胰岛素作用，单位为 $\\mathrm{min}^{-1}$。已知的外源输入是血浆胰岛素浓度 $I_k$ (单位 $\\mathrm{\\mu U/mL}$) 和单位葡萄糖分布容积的净葡萄糖出现项 $r_k = R_a(k)/V_g$ (单位 $\\mathrm{mg/dL/min}$)。\n\n假设在采样间隔 $\\Delta t$ 下，离散时间状态方程如下：\n$$\n\\begin{aligned}\ng_{k+1} = g_k + \\Delta t\\left( -\\left(S_G + a_k\\right) g_k + r_k \\right), \\\\\na_{k+1} = a_k + \\Delta t\\left( -p_2 a_k + p_3 \\,\\frac{\\left(I_k - I_b\\right)^{n}}{K^{n} + \\left(I_k - I_b\\right)^{n}} \\right),\n\\end{aligned}\n$$\n其中 $S_G$、$p_2$、$p_3$、$I_b$、$K$ 和 $n$ 是正常数。扩展卡尔曼滤波器（EKF）的测量模型是带有加性测量噪声的直接葡萄糖观测，\n$$\ny_k = h(x_k) + v_k, \\quad h(x_k) = g_k,\n$$\n其中 $v_k$ 是均值为零、方差为 $R_k$ 的高斯噪声。\n\n从状态转移函数 $f(x_k)$ 和测量函数 $h(x_k)$ 的定义出发，并使用围绕先验状态估计 $x_{k|k-1}$ 的一阶泰勒线性化，完成以下任务：\n\n1. 为上述模型推导雅可比矩阵 $F_k = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x_{k|k-1}}$ 和 $H_k = \\left.\\frac{\\partial h}{\\partial x}\\right|_{x_{k|k-1}}$。用模型参数、$\\Delta t$ 和先验状态分量表示每个矩阵元素。\n\n2. 给定数值\n$$\n\\Delta t = 1 \\ \\mathrm{min}, \\quad S_G = 0.02 \\ \\mathrm{min}^{-1}, \\quad p_2 = 0.02 \\ \\mathrm{min}^{-1}, \\quad p_3 = 5.0 \\times 10^{-4} \\ \\mathrm{min}^{-1},\n$$\n$$\nI_b = 10 \\ \\mathrm{\\mu U/mL}, \\quad K = 50 \\ \\mathrm{\\mu U/mL}, \\quad n = 2, \\quad I_k = 60 \\ \\mathrm{\\mu U/mL}, \\quad r_k = 0 \\ \\mathrm{mg/dL/min},\n$$\n以及EKF输入\n$$\nx_{k|k-1} = \\begin{pmatrix} 12 \\ \\mathrm{mg/dL} \\\\ 0.015 \\ \\mathrm{min}^{-1} \\end{pmatrix}, \\quad\nP_{k|k-1} = \\begin{pmatrix} 4  2.0\\times 10^{-3} \\\\ 2.0\\times 10^{-3}  1.0\\times 10^{-5} \\end{pmatrix}, \\quad\nR_k = 1 \\ \\left(\\mathrm{mg/dL}\\right)^2,\n$$\n以及一个葡萄糖测量值\n$$\ny_k = 13 \\ \\mathrm{mg/dL},\n$$\n计算一次EKF测量更新，以获得后验状态估计 $x_{k|k}$。\n\n对于此任务，请使用标准的EKF测量更新，其中新息协方差为 $S_k = H_k P_{k|k-1} H_k^{\\top} + R_k$，卡尔曼增益为 $K_k = P_{k|k-1} H_k^{\\top} S_k^{-1}$，新息为 $\\nu_k = y_k - h\\!\\left(x_{k|k-1}\\right)$，更新后的状态为 $x_{k|k} = x_{k|k-1} + K_k \\nu_k$。\n\n将最终数值答案的每个分量四舍五入到四位有效数字。用上述单位表示最终状态分量，但报告最终方框内的数值时不带单位。最终答案必须是写成 LaTeX $\\mathrm{pmatrix}$ 形式的行向量，包含 $x_{k|k}$ 的两个分量，顺序为 $\\left(g_{k|k},\\; a_{k|k}\\right)$。", "solution": "该问题要求完成与葡萄糖-胰岛素稳态模型的扩展卡尔曼滤波器（EKF）相关的两个任务。首先，推导状态转移函数和测量函数的雅可比矩阵。其次，执行一次数值上的EKF测量更新。\n\n状态向量定义为 $x_k = \\begin{pmatrix} g_k \\\\ a_k \\end{pmatrix}$。\n\n离散时间状态转移函数 $x_{k+1} = f(x_k)$ 由以下方程组给出：\n$$\nf(x_k) = \\begin{pmatrix} f_g(x_k) \\\\ f_a(x_k) \\end{pmatrix} = \\begin{pmatrix} g_k + \\Delta t\\left( -\\left(S_G + a_k\\right) g_k + r_k \\right) \\\\ a_k + \\Delta t\\left( -p_2 a_k + p_3 \\,\\frac{\\left(I_k - I_b\\right)^{n}}{K^{n} + \\left(I_k - I_b\\right)^{n}} \\right) \\end{pmatrix}\n$$\n测量函数为 $h(x_k) = g_k$。\n\n**第1部分：雅可比矩阵的推导**\n\n第一个任务是求雅可比矩阵 $F_k = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x_{k|k-1}}$ 和 $H_k = \\left.\\frac{\\partial h}{\\partial x}\\right|_{x_{k|k-1}}$。\n\n**$F_k$ 的推导：**\n状态转移函数的雅可比矩阵 $F_k$ 是一个 $2 \\times 2$ 的矩阵，其元素是 $f(x_k)$ 对 $x_k$ 各分量的偏导数：\n$$\nF_k = \\frac{\\partial f}{\\partial x_k} = \\begin{pmatrix} \\frac{\\partial f_g}{\\partial g_k}  \\frac{\\partial f_g}{\\partial a_k} \\\\ \\frac{\\partial f_a}{\\partial g_k}  \\frac{\\partial f_a}{\\partial a_k} \\end{pmatrix}\n$$\n我们计算矩阵的每个元素：\n$f$ 的第一个分量是 $f_g(x_k) = g_k - \\Delta t(S_G + a_k)g_k + \\Delta t r_k$。\n$$\n\\frac{\\partial f_g}{\\partial g_k} = \\frac{\\partial}{\\partial g_k} \\left[ g_k - \\Delta t S_G g_k - \\Delta t a_k g_k + \\Delta t r_k \\right] = 1 - \\Delta t S_G - \\Delta t a_k = 1 - \\Delta t (S_G + a_k)\n$$\n$$\n\\frac{\\partial f_g}{\\partial a_k} = \\frac{\\partial}{\\partial a_k} \\left[ g_k - \\Delta t S_G g_k - \\Delta t a_k g_k + \\Delta t r_k \\right] = -\\Delta t g_k\n$$\n$f$ 的第二个分量是 $f_a(x_k) = a_k - \\Delta t p_2 a_k + \\Delta t p_3 \\,\\frac{\\left(I_k - I_b\\right)^{n}}{K^{n} + \\left(I_k - I_b\\right)^{n}}$。包含 $I_k$ 的项与状态变量 $g_k$ 和 $a_k$ 无关。\n$$\n\\frac{\\partial f_a}{\\partial g_k} = \\frac{\\partial}{\\partial g_k} \\left[ a_k + \\Delta t(\\ldots) \\right] = 0\n$$\n$$\n\\frac{\\partial f_a}{\\partial a_k} = \\frac{\\partial}{\\partial a_k} \\left[ a_k - \\Delta t p_2 a_k + \\text{constant term} \\right] = 1 - \\Delta t p_2\n$$\n组合成矩阵并在先验状态估计 $x_{k|k-1} = \\begin{pmatrix} g_{k|k-1} \\\\ a_{k|k-1} \\end{pmatrix}$ 处求值：\n$$\nF_k = \\begin{pmatrix} 1 - \\Delta t(S_G + a_{k|k-1})  -\\Delta t g_{k|k-1} \\\\ 0  1 - \\Delta t p_2 \\end{pmatrix}\n$$\n\n**$H_k$ 的推导：**\n测量函数的雅可比矩阵 $H_k$ 是一个 $1 \\times 2$ 的矩阵，其元素是 $h(x_k) = g_k$ 的偏导数：\n$$\nH_k = \\frac{\\partial h}{\\partial x_k} = \\begin{pmatrix} \\frac{\\partial h}{\\partial g_k}  \\frac{\\partial h}{\\partial a_k} \\end{pmatrix}\n$$\n偏导数为：\n$$\n\\frac{\\partial h}{\\partial g_k} = \\frac{\\partial}{\\partial g_k}(g_k) = 1\n$$\n$$\n\\frac{\\partial h}{\\partial a_k} = \\frac{\\partial}{\\partial a_k}(g_k) = 0\n$$\n因此，测量雅可比矩阵 $H_k$ 是一个常数矩阵：\n$$\nH_k = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n该矩阵不依赖于状态估计 $x_{k|k-1}$。\n\n**第2部分：EKF测量更新计算**\n\n第二个任务是使用提供的数值和标准的EKF测量更新方程来计算后验状态估计 $x_{k|k}$。\n给定值为：\n- 先验状态估计：$x_{k|k-1} = \\begin{pmatrix} g_{k|k-1} \\\\ a_{k|k-1} \\end{pmatrix} = \\begin{pmatrix} 12 \\\\ 0.015 \\end{pmatrix}$\n- 先验误差协方差：$P_{k|k-1} = \\begin{pmatrix} 4  2.0\\times 10^{-3} \\\\ 2.0\\times 10^{-3}  1.0\\times 10^{-5} \\end{pmatrix}$\n- 测量值：$y_k = 13$\n- 测量噪声方差：$R_k = 1$\n\nEKF测量更新按以下步骤进行：\n\n1.  **计算预测测量值：**\n    通过将测量函数应用于先验状态估计来获得预测测量值：\n    $$\n    \\hat{y}_k = h(x_{k|k-1}) = g_{k|k-1} = 12\n    $$\n\n2.  **计算新息（测量残差）：**\n    新息是实际测量值与预测测量值之差：\n    $$\n    \\nu_k = y_k - \\hat{y}_k = 13 - 12 = 1\n    $$\n\n3.  **计算新息协方差：**\n    新息协方差 $S_k$ 由 $S_k = H_k P_{k|k-1} H_k^{\\top} + R_k$ 给出。\n    使用 $H_k = \\begin{pmatrix} 1  0 \\end{pmatrix}$：\n    $$\n    H_k P_{k|k-1} H_k^{\\top} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 4  2.0\\times 10^{-3} \\\\ 2.0\\times 10^{-3}  1.0\\times 10^{-5} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4  2.0\\times 10^{-3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 4\n    $$\n    此项即为 $P_{k|k-1}$ 的 $(1,1)$ 元素。\n    $$\n    S_k = 4 + R_k = 4 + 1 = 5\n    $$\n\n4.  **计算卡尔曼增益：**\n    卡尔曼增益 $K_k$ 由 $K_k = P_{k|k-1} H_k^{\\top} S_k^{-1}$ 给出。标量 $S_k$ 的逆是 $S_k^{-1} = 1/5 = 0.2$。\n    $$\n    P_{k|k-1} H_k^{\\top} = \\begin{pmatrix} 4  2.0\\times 10^{-3} \\\\ 2.0\\times 10^{-3}  1.0\\times 10^{-5} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 2.0\\times 10^{-3} \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 0.002 \\end{pmatrix}\n    $$\n    $$\n    K_k = \\begin{pmatrix} 4 \\\\ 0.002 \\end{pmatrix} S_k^{-1} = \\begin{pmatrix} 4 \\\\ 0.002 \\end{pmatrix} (0.2) = \\begin{pmatrix} 0.8 \\\\ 0.0004 \\end{pmatrix}\n    $$\n\n5.  **计算更新后的（后验）状态估计：**\n    通过用卡尔曼增益缩放的新息来校正先验估计，从而找到后验状态估计 $x_{k|k}$：\n    $$\n    x_{k|k} = x_{k|k-1} + K_k \\nu_k\n    $$\n    $$\n    x_{k|k} = \\begin{pmatrix} 12 \\\\ 0.015 \\end{pmatrix} + \\begin{pmatrix} 0.8 \\\\ 0.0004 \\end{pmatrix} (1) = \\begin{pmatrix} 12 + 0.8 \\\\ 0.015 + 0.0004 \\end{pmatrix} = \\begin{pmatrix} 12.8 \\\\ 0.0154 \\end{pmatrix}\n    $$\n后验状态估计的分量是 $g_{k|k} = 12.8$ 和 $a_{k|k} = 0.0154$。问题要求将每个分量四舍五入到四位有效数字。\n- $12.8$ 变为 $12.80$。\n- $0.0154$ 变为 $0.01540$。\n\n最终的后验状态估计是 $x_{k|k} = \\begin{pmatrix} 12.80 \\\\ 0.01540 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n12.80  0.01540\n\\end{pmatrix}\n}\n$$", "id": "4348707"}]}