{"hands_on_practices": [{"introduction": "本练习旨在奠定跨组学QTL分析的统计学基础。我们将从最基本的单标记回归模型出发，推导出关联检验中广泛使用的$z$-统计量，并揭示连锁不平衡（LD）是如何影响多个遗传变异的关联信号之间的相关性。通过这个实践[@problem_id:4395278]，你将能深刻理解QTL研究中汇总统计数据的来源，以及为何必须考虑遗传标记间的相关性。", "problem": "在系统生物医学中，考虑一项跨组学数量性状基因座 (QTL) 分析，其中分子表型是一个整合的跨组学性状，由信使核糖核酸 (mRNA)、蛋白质和代谢物水平的标准化聚合构建而成。设有 $n$ 个个体和 $p$ 个单核苷酸多态性 (SNP)。用 $\\mathbf{y} \\in \\mathbb{R}^{n}$ 表示标准化的跨组学性状向量（均值为 $0$，方差为 $1$），用 $\\mathbf{G} \\in \\mathbb{R}^{n \\times p}$ 表示 $p$ 个 SNP 的标准化基因型矩阵（每个 SNP 列的均值为 $0$，方差为 $1$）。假设线性模型为\n$$\n\\mathbf{y} = \\mathbf{G}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\boldsymbol{\\theta} \\in \\mathbb{R}^{p}$ 是 SNP 对跨组学性状的效应大小，$\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n})$ 表示个体间的独立残差变异。定义连锁不平衡 (LD) 矩阵为\n$$\n\\mathbf{R} = \\frac{1}{n}\\mathbf{G}^{\\top}\\mathbf{G},\n$$\n在所述的标准化条件下，该矩阵是由于 LD 引起的 SNP 间的经验相关矩阵。\n\n基于摘要统计量的 SNP $j$ 的关联统计量是通过对每个 SNP 分别拟合一个普通最小二乘 (OLS) 回归来构建的，\n$$\n\\mathbf{y} = \\alpha_{j}\\mathbf{1} + \\beta_{j}\\mathbf{g}_{j} + \\boldsymbol{\\varepsilon}_{j},\n$$\n其中 $\\mathbf{g}_{j}$ 表示 $\\mathbf{G}$ 的第 $j$ 列，然后将估计效应与其标准误的比值构造成 $z$ 统计量。从 OLS 估计量及其抽样方差出发，推导在零假设 $\\boldsymbol{\\theta} = \\mathbf{0}$ 下，$z$ 统计量的形式以及所有 SNP 的 $z$ 统计量向量的联合抽样分布，并明确说明 LD（通过 $\\mathbf{R}$）如何进入该分布。\n\n然后，考虑一个具有 $p = 2$ 个 SNP 的基因座，其 LD 相关系数为 $r$，因此\n$$\n\\mathbf{R} = \\begin{pmatrix} 1  r \\\\ r  1 \\end{pmatrix}.\n$$\n在零假设 $\\boldsymbol{\\theta} = \\mathbf{0}$ 和上述模型假设下，计算线性对比 $z_{1} - z_{2}$ 的方差（用 $r$ 表示）。请仅以 $r$ 的函数形式提供 $\\mathrm{Var}(z_{1} - z_{2})$ 的最终标量表达式。不需要单位。不要四舍五入；要求一个精确的封闭形式表达式。", "solution": "该问题要求得到两个主要结果：首先，在零假设 $\\boldsymbol{\\theta} = \\mathbf{0}$ 下，推导单个 SNP 的 $z$ 统计量的形式以及 $z$ 统计量向量的联合抽样分布；其次，对于一个具有连锁不平衡相关系数 $r$ 的双 SNP 基因座，计算对比 $z_{1} - z_{2}$ 的方差。\n\n分析分为两部分。首先，我们推导 $z$ 统计量的一般分布。其次，我们将此结果应用于给定的具体情况。\n\n**第 1 部分：$z$ 统计量及其分布的推导**\n\n我们首先考察 SNP $j$ 的单个普通最小二乘 (OLS) 回归模型：\n$$\n\\mathbf{y} = \\alpha_{j}\\mathbf{1} + \\beta_{j}\\mathbf{g}_{j} + \\boldsymbol{\\varepsilon}_{j}\n$$\n这里，$\\mathbf{y} \\in \\mathbb{R}^{n}$ 是表型向量，$\\mathbf{g}_{j} \\in \\mathbb{R}^{n}$ 是 SNP $j$ 的基因型向量，$\\mathbf{1}$ 是一个全为 1 的向量。问题陈述，表型向量 $\\mathbf{y}$ 和每个基因型向量 $\\mathbf{g}_{j}$ 都经过标准化，均值为 $0$，方差为 $1$。\n\n令 $\\mathbf{X}_{j} = [\\mathbf{1}, \\mathbf{g}_j]$ 为该回归的设计矩阵。$\\alpha_j$ 和 $\\beta_j$ 的 OLS 估计量由 $\\begin{pmatrix} \\hat{\\alpha}_j \\\\ \\hat{\\beta}_j \\end{pmatrix} = (\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j})^{-1}\\mathbf{X}_{j}^{\\top}\\mathbf{y}$ 给出。\n\n由于标准化，$\\mathbf{X}_j$ 的列是正交的。我们有 $\\mathbf{1}^{\\top}\\mathbf{g}_{j} = \\sum_{i=1}^{n} g_{ij} = n \\bar{g}_{j} = 0$。\n因此，矩阵 $\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j}$ 是块对角的：\n$$\n\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j} = \\begin{pmatrix} \\mathbf{1}^{\\top}\\mathbf{1}  \\mathbf{1}^{\\top}\\mathbf{g}_{j} \\\\ \\mathbf{g}_{j}^{\\top}\\mathbf{1}  \\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} \\end{pmatrix} = \\begin{pmatrix} n  0 \\\\ 0  \\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} \\end{pmatrix}\n$$\n$\\mathbf{g}_{j}$ 的方差为 $1$ 的条件意味着 $\\frac{1}{n} \\sum_{i=1}^n (g_{ij} - \\bar{g}_j)^2 = 1$。由于 $\\bar{g}_j = 0$，这简化为 $\\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} = 1$，即 $\\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} = n$。\n代入此结果，我们得到：\n$$\n\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j} = \\begin{pmatrix} n  0 \\\\ 0  n \\end{pmatrix} \\quad \\implies \\quad (\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j})^{-1} = \\begin{pmatrix} \\frac{1}{n}  0 \\\\ 0  \\frac{1}{n} \\end{pmatrix}\n$$\n那么 OLS 估计的向量是：\n$$\n\\begin{pmatrix} \\hat{\\alpha}_j \\\\ \\hat{\\beta}_j \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{n}  0 \\\\ 0  \\frac{1}{n} \\end{pmatrix} \\begin{pmatrix} \\mathbf{1}^{\\top}\\mathbf{y} \\\\ \\mathbf{g}_{j}^{\\top}\\mathbf{y} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{n}\\mathbf{1}^{\\top}\\mathbf{y} \\\\ \\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{y} \\end{pmatrix}\n$$\n由于 $\\mathbf{y}$ 也被标准化为均值为 $0$，所以 $\\mathbf{1}^{\\top}\\mathbf{y} = n\\bar{y} = 0$。因此，截距的估计量是 $\\hat{\\alpha}_{j} = 0$。SNP 效应大小 $\\beta_j$ 的估计量是：\n$$\n\\hat{\\beta}_{j} = \\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{y}\n$$\n$\\hat{\\beta}_j$ 的抽样方差由 $\\mathrm{Var}(\\hat{\\beta}_{j}) = (\\sigma_{j}^{2}) [(\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j})^{-1}]_{22}$ 给出，其中 $(\\sigma_{j}^{2})$ 是残差 $\\boldsymbol{\\varepsilon}_{j}$ 的方差。根据完整模型 $\\mathbf{y} = \\mathbf{G}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$，残差方差为 $\\sigma^2$。因此，我们有 $\\mathrm{Var}(\\hat{\\beta}_{j}) = \\sigma^2 \\cdot \\frac{1}{n} = \\frac{\\sigma^2}{n}$。\n\nSNP $j$ 的 $z$ 统计量是估计效应与其标准误的比值，$z_j = \\hat{\\beta}_j / \\mathrm{SE}(\\hat{\\beta}_j)$。\n$$\nz_{j} = \\frac{\\hat{\\beta}_{j}}{\\sqrt{\\sigma^2/n}} = \\frac{\\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{y}}{\\sigma/\\sqrt{n}} = \\frac{1}{\\sigma\\sqrt{n}}\\mathbf{g}_{j}^{\\top}\\mathbf{y}\n$$\n在零假设 $H_0: \\boldsymbol{\\theta} = \\mathbf{0}$ 下，完整模型简化为 $\\mathbf{y} = \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n})$。所述的向量 $\\mathbf{y}$ 被标准化为方差为 $1$ 的条件意味着，在 $H_0$ 下，任何分量 $y_i$ 的方差都为 $1$。由于 $\\mathrm{Var}(y_i) = \\mathrm{Var}(\\varepsilon_i) = \\sigma^2$，这意味着 $\\sigma^2 = 1$。\n\n当 $\\sigma^2=1$ 时，$z$ 统计量变为：\n$$\nz_{j} = \\frac{1}{\\sqrt{n}}\\mathbf{g}_{j}^{\\top}\\mathbf{y}\n$$\n我们可以将 $z$ 统计量向量 $\\mathbf{z} = (z_1, z_2, \\ldots, z_p)^{\\top}$ 写成矩阵形式。\n$$\n\\mathbf{z} = \\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{y}\n$$\n现在我们求解在 $H_0$ 下 $\\mathbf{z}$ 的联合分布。在 $H_0$ 下，由于 $\\sigma^{2} = 1$，$\\mathbf{y} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I}_{n})$。由于 $\\mathbf{z}$ 是正态分布向量 $\\mathbf{y}$ 的线性变换，$\\mathbf{z}$ 本身也服从多元正态分布。\n\n$\\mathbf{z}$ 的均值为：\n$$\nE[\\mathbf{z}] = E\\left[\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{y}\\right] = \\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}E[\\mathbf{y}] = \\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{0} = \\mathbf{0}\n$$\n$\\mathbf{z}$ 的协方差矩阵为：\n$$\n\\mathrm{Cov}(\\mathbf{z}) = \\mathrm{Var}(\\mathbf{z}) = \\mathrm{Var}\\left(\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{y}\\right) = \\left(\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\right) \\mathrm{Var}(\\mathbf{y}) \\left(\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\right)^{\\top}\n$$\n代入 $\\mathrm{Var}(\\mathbf{y}) = \\mathbf{I}_{n}$：\n$$\n\\mathrm{Cov}(\\mathbf{z}) = \\frac{1}{n} \\mathbf{G}^{\\top}\\mathbf{I}_{n}\\mathbf{G} = \\frac{1}{n}\\mathbf{G}^{\\top}\\mathbf{G}\n$$\n问题将连锁不平衡 (LD) 矩阵定义为 $\\mathbf{R} = \\frac{1}{n}\\mathbf{G}^{\\top}\\mathbf{G}$。因此，$\\mathrm{Cov}(\\mathbf{z}) = \\mathbf{R}$。\n\n在零假设下，$z$ 统计量向量的联合抽样分布是一个均值向量为 $\\mathbf{0}$、协方差矩阵为 $\\mathbf{R}$ 的多元正态分布：\n$$\n\\mathbf{z} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})\n$$\n\n**第 2 部分：对比 $z_1 - z_2$ 的方差**\n\n我们被要求计算一个具有 $p=2$ 个 SNP 的基因座的 $\\mathrm{Var}(z_{1} - z_{2})$，其 LD 矩阵由下式给出：\n$$\n\\mathbf{R} = \\begin{pmatrix} 1  r \\\\ r  1 \\end{pmatrix}\n$$\n根据第 1 部分的结果，向量 $\\mathbf{z} = (z_1, z_2)^{\\top}$ 的协方差矩阵是 $\\mathbf{R}$。我们可以写出：\n$$\n\\mathrm{Cov}(\\mathbf{z}) = \\begin{pmatrix} \\mathrm{Var}(z_1)  \\mathrm{Cov}(z_1, z_2) \\\\ \\mathrm{Cov}(z_2, z_1)  \\mathrm{Var}(z_2) \\end{pmatrix} = \\begin{pmatrix} 1  r \\\\ r  1 \\end{pmatrix}\n$$\n这给了我们 $\\mathrm{Var}(z_1) = 1$，$\\mathrm{Var}(z_2) = 1$ 以及 $\\mathrm{Cov}(z_1, z_2) = r$。\n\n使用两个随机变量之差的方差的一般公式：\n$$\n\\mathrm{Var}(z_1 - z_2) = \\mathrm{Var}(z_1) + \\mathrm{Var}(z_2) - 2\\mathrm{Cov}(z_1, z_2)\n$$\n代入协方差矩阵中的值：\n$$\n\\mathrm{Var}(z_1 - z_2) = 1 + 1 - 2(r) = 2 - 2r\n$$\n线性对比 $z_1 - z_2$ 的方差是 $2 - 2r$。", "answer": "$$\n\\boxed{2 - 2r}\n$$", "id": "4395278"}, {"introduction": "在识别出QTL信号后，下一步是量化其效应大小及其在不同分子层级间的影响。本练习将指导你如何在一个加性遗传模型中分解由多个独立遗传变异解释的性状方差，并将其通过一个简单的中介模型（从转录物到蛋白质）进行传递。这项实践[@problem_id:4395232]有助于你掌握系统生物学中的一个核心技能：量化遗传信息流经不同分子层次的贡献，从而理解下游性状的变异在多大程度上可归因于其上游性状的遗传效应。", "problem": "在一项针对单个基因、跨越信使核糖核酸（mRNA）和蛋白质的跨组学数量性状基因座分析中，给定三个处于哈代-温伯格平衡中的独立顺式变异。设变异 $i$ 的基因型剂量为 $G_i \\in \\{0,1,2\\}$，表示效应等位基因的数量，其等位基因频率为 $p_i$。转录本丰度 $Y_{m}$ 已被标准化为单位方差，即 $\\operatorname{Var}(Y_{m}) = 1$。从一个包含所有三个变异的转录本丰度联合加性模型中，已知以下群体数量：\n- 等位基因频率：$p_1 = 0.20$，$p_2 = 0.35$，$p_3 = 0.50$。\n- 对标准化转录本丰度的单等位基因效应（来自包含所有三个变异的单一联合回归，使用中心化预测变量）：$b_1 = 0.18$，$b_2 = -0.12$，$b_3 = 0.10$。\n\n假设：\n- 基因型 $(G_1,G_2,G_3)$ 相互独立，且每个都遵循哈代-温伯格平衡。\n- 回归是加性的，没有交互作用项（无上位性），并使用中心化的基因型 $G_i - \\mathbb{E}[G_i]$。\n- 残差与所有预测变量不相关。\n\n此外，蛋白质丰度 $Y_{p}$ 通过一个带有独立残差的转录本线性中介模型进行建模，即 $Y_{p} = \\alpha Y_{m} + \\eta$，其中 $\\eta$ 与 $Y_{m}$ 独立，且通过标准化使得 $\\operatorname{Var}(Y_{p}) = 1$。耦合系数为 $\\alpha = 0.60$。\n\n仅使用方差、协方差和线性模型的基本定义，并以分子生物学的中心法则作为中介结构的概念性理由，从第一性原理出发，推导如何将由三个变异解释的 $Y_{m}$ 方差分解为加性分量，然后通过线性中介传播此分解，以获得这些顺式变异通过 $Y_{m}$ 解释的 $Y_{p}$ 方差比例。将最终答案表示为小数比例，并四舍五入到四位有效数字。在最终答案中，仅报告由顺式变异通过转录本介导的蛋白质水平方差解释比例。", "solution": "目标是确定由三个独立的顺式遗传变异解释的蛋白质丰度（$Y_p$）的方差比例，其中它们的影响是通过信使RNA（$Y_m$）的丰度来介导的。这需要一个两步过程：首先，计算由变异解释的 $Y_m$ 方差；其次，通过给定的中介模型将此解释的方差传播到 $Y_p$。\n\n步骤1：计算每个基因型的方差。\n问题陈述，对于每个变异 $i$，基因型剂量 $G_i$ 是集合 $\\{0, 1, 2\\}$ 中的一个整数，代表效应等位基因的数量。种群处于哈代-温伯格平衡（HWE）状态，效应等位基因频率为 $p_i$。在HWE下，三种可能基因型的概率是：\n- $P(G_i=2) = p_i^2$ （效应等位基因纯合子）\n- $P(G_i=1) = 2p_i(1-p_i)$ （杂合子）\n- $P(G_i=0) = (1-p_i)^2$ （非效应等位基因纯合子）\n\n从第一性原理出发，基因型剂量 $G_i$ 的期望值为：\n$$ \\mathbb{E}[G_i] = (2 \\cdot p_i^2) + (1 \\cdot 2p_i(1-p_i)) + (0 \\cdot (1-p_i)^2) = 2p_i^2 + 2p_i - 2p_i^2 = 2p_i $$\n$G_i$ 的方差为 $\\operatorname{Var}(G_i) = \\mathbb{E}[G_i^2] - (\\mathbb{E}[G_i])^2$。我们首先计算二阶矩：\n$$ \\mathbb{E}[G_i^2] = (2^2 \\cdot p_i^2) + (1^2 \\cdot 2p_i(1-p_i)) + (0^2 \\cdot (1-p_i)^2) = 4p_i^2 + 2p_i - 2p_i^2 = 2p_i^2 + 2p_i $$\n因此，方差为：\n$$ \\operatorname{Var}(G_i) = (2p_i^2 + 2p_i) - (2p_i)^2 = 2p_i^2 + 2p_i - 4p_i^2 = 2p_i - 2p_i^2 = 2p_i(1-p_i) $$\n使用给定的等位基因频率：\n- 对于变异1，$p_1 = 0.20$。\n  $\\operatorname{Var}(G_1) = 2p_1(1-p_1) = 2(0.20)(1-0.20) = 2(0.20)(0.80) = 0.32$。\n- 对于变异2，$p_2 = 0.35$。\n  $\\operatorname{Var}(G_2) = 2p_2(1-p_2) = 2(0.35)(1-0.35) = 2(0.35)(0.65) = 0.455$。\n- 对于变异3，$p_3 = 0.50$。\n  $\\operatorname{Var}(G_3) = 2p_3(1-p_3) = 2(0.50)(1-0.50) = 2(0.50)(0.50) = 0.50$。\n\n步骤2：计算由变异解释的转录本丰度（$Y_m$）的方差比例。\n转录本丰度 $Y_m$ 被建模为中心化基因型的线性加性函数：\n$$ Y_m = \\beta_0 + \\sum_{i=1}^{3} b_i (G_i - \\mathbb{E}[G_i]) + \\epsilon_m $$\n其中 $b_i$ 是单等位基因效应，$\\epsilon_m$ 是与基因型不相关的残差项。$Y_m$ 的总方差可以被分解。由遗传学解释的 $Y_m$ 部分是 $Y_{m,g} = \\sum_{i=1}^{3} b_i (G_i - \\mathbb{E}[G_i])$。这个遗传分量的方差是：\n$$ \\operatorname{Var}(Y_{m,g}) = \\operatorname{Var}\\left(\\sum_{i=1}^{3} b_i (G_i - \\mathbb{E}[G_i])\\right) $$\n由于给定的变异（$G_1, G_2, G_3$）是相互独立的，对于 $i \\neq j$，任意两项 $b_i(G_i - \\mathbb{E}[G_i])$ 和 $b_j(G_j - \\mathbb{E}[G_j])$ 之间的协方差为零。因此，和的方差是方差的和：\n$$ \\operatorname{Var}(Y_{m,g}) = \\sum_{i=1}^{3} \\operatorname{Var}(b_i (G_i - \\mathbb{E}[G_i])) = \\sum_{i=1}^{3} b_i^2 \\operatorname{Var}(G_i - \\mathbb{E}[G_i]) = \\sum_{i=1}^{3} b_i^2 \\operatorname{Var}(G_i) $$\n由变异解释的 $Y_m$ 方差比例，记为 $R^2_m$，是遗传方差与总方差的比率：\n$$ R^2_m = \\frac{\\operatorname{Var}(Y_{m,g})}{\\operatorname{Var}(Y_m)} $$\n鉴于 $Y_m$ 已被标准化为单位方差，$\\operatorname{Var}(Y_m) = 1$。因此，$R^2_m = \\operatorname{Var}(Y_{m,g})$。\n代入给定的效应大小 $b_1 = 0.18$, $b_2 = -0.12$, $b_3 = 0.10$ 和计算出的基因型方差：\n$$ R^2_m = b_1^2 \\operatorname{Var}(G_1) + b_2^2 \\operatorname{Var}(G_2) + b_3^2 \\operatorname{Var}(G_3) $$\n$$ R^2_m = (0.18)^2(0.32) + (-0.12)^2(0.455) + (0.10)^2(0.50) $$\n$$ R^2_m = (0.0324)(0.32) + (0.0144)(0.455) + (0.01)(0.50) $$\n$$ R^2_m = 0.010368 + 0.006552 + 0.005 $$\n$$ R^2_m = 0.02192 $$\n\n步骤3：通过中介模型将解释的方差传播到蛋白质丰度（$Y_p$）。\n蛋白质丰度 $Y_p$ 被建模为 $Y_m$ 的线性函数：\n$$ Y_p = \\alpha Y_m + \\eta $$\n其中 $\\alpha = 0.60$ 是耦合系数，$\\eta$ 是一个与 $Y_m$ 独立的残差项。\n为了找到由顺式变异解释的 $Y_p$ 分量，我们将 $Y_m$ 的分解代入方程。设 $Y_m = Y_{m,g} + \\epsilon'_m$，其中 $Y_{m,g}$ 是遗传分量，$\\epsilon'_m$ 是非遗传分量（残差，包括截距）。\n$$ Y_p = \\alpha (Y_{m,g} + \\epsilon'_m) + \\eta = \\alpha Y_{m,g} + \\alpha \\epsilon'_m + \\eta $$\n代表顺式变异通过转录本介导的对蛋白质丰度的遗传效应的项是 $\\alpha Y_{m,g}$。\n这个分量的方差是：\n$$ \\operatorname{Var}(\\alpha Y_{m,g}) = \\alpha^2 \\operatorname{Var}(Y_{m,g}) = \\alpha^2 R^2_m $$\n由顺式变异通过 $Y_m$ 解释的 $Y_p$ 方差比例是此方差与 $Y_p$ 总方差的比率：\n$$ \\text{Proportion} = \\frac{\\operatorname{Var}(\\alpha Y_{m,g})}{\\operatorname{Var}(Y_p)} $$\n问题陈述 $Y_p$ 也被标准化为单位方差，所以 $\\operatorname{Var}(Y_p) = 1$。因此，所求比例为：\n$$ \\text{Proportion} = \\frac{\\alpha^2 R^2_m}{1} = \\alpha^2 R^2_m $$\n代入 $\\alpha$ 和 $R^2_m$ 的值：\n$$ \\text{Proportion} = (0.60)^2 \\times 0.02192 = 0.36 \\times 0.02192 = 0.0078912 $$\n最后，将结果四舍五入到四位有效数字，得到 $0.007891$。\n这个值代表了可归因于给定顺式作用遗传变异的蛋白质丰度方差比例，其影响是通过它们对转录本丰度的作用传递的。", "answer": "$$\n\\boxed{0.007891}\n$$", "id": "4395232"}, {"introduction": "大规模QTL筛选研究普遍存在一个被称为“赢家诅咒”的统计陷阱，即通过显著性阈值的信号其效应量往往被高估。本高级练习将引导你从理论上推导这种偏差的来源，并应用基于条件似然的方法来校正观察到的效应量[@problem_id:4395285]。掌握这一概念对于准确解读和复现QTL研究结果至关重要，它将让你学会如何获得更精确的效应量估计，从而提升研究的严谨性。", "problem": "一项多层次贯穿组学研究在一个系统生物医学队列中，研究了一个加性基因型-代谢物数量性状位点。在线性模型中，单核苷酸变异剂量 $g \\in \\{0,1,2\\}$ 对代谢物浓度 $m$ 的自然对数（代谢组学层）进行回归，同时调整了协变量。该模型中每个等位基因效应的最大似然估计量表示为 $\\hat{\\beta}$。在线性回归的独立同分布误差的标准正则性条件下，假设大样本分布为 $\\hat{\\beta} \\sim \\mathcal{N}(\\beta, s^{2})$，其中 $\\beta$ 是每个等位基因真实的对数倍数变化，$s$ 是标准误。\n\n发现在代谢组学层应用了一个全基因组筛选规则：只有那些估计效应为正且超过一个标准化阈值的位点，才会被进一步用于多组学整合。具体来说，设 $z_{\\star}$ 为标准化截断值，且 $c = z_{\\star} s$；选择事件为 $\\hat{\\beta}  c$。这个选择规则可能会在已发现的位点中夸大 $\\hat{\\beta}$（即“赢家诅咒”）。\n\n给定一个已发现的位点，其观测值为 $\\hat{\\beta} = 0.90$ 和 $s = 0.12$，筛选阈值为 $z_{\\star} = 5$（因此 $c = z_{\\star} s = 0.60$），请完成以下任务：\n\n1. 从 $\\hat{\\beta}$ 的渐近正态性和选择事件 $\\hat{\\beta}  c$ 出发，推导出条件期望 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta}  c]$，并证明对于任何有限的 $\\beta$ 和 $s  0$，差值 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta}  c] - \\beta$ 严格为正，从而量化“赢家诅咒”。\n\n2. 在事件 $\\hat{\\beta}  c$ 下，对于单个观测值 $\\hat{\\beta} = x$，使用条件（截断）似然，通过最大化关于 $\\beta$ 的条件似然，推导出偏差校正效应 $\\tilde{\\beta}$ 的估计方程。然后，使用 $x = 0.90$，$s = 0.12$ 和 $c = 0.60$，数值求解此估计方程，以获得条件似然校正估计值 $\\tilde{\\beta}$。\n\n3. 提出一个参数化自助法方案（概念上，无需运行模拟），该方案可用于在相同设置下估计并减去由选择引起的偏差，并解释它与第1部分中推导出的截断正态期望有何关系。\n\n将第2部分得到的最终校正后每个等位基因的效应 $\\tilde{\\beta}$ 报告为单一数值。将答案四舍五入至四位有效数字。将校正后的效应表示为每个等位基因的自然对数倍数变化。", "solution": "按照要求，解答分为三部分呈现。\n\n### 第1部分：条件期望与“赢家诅咒”\n\n设 $Y$ 为一个代表估计量 $\\hat{\\beta}$ 的随机变量，因此 $Y \\sim \\mathcal{N}(\\beta, s^{2})$。其概率密度函数 (PDF) 为 $f_Y(y) = \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y-\\beta)^2}{2s^2}\\right)$。设 $\\phi(\\cdot)$ 和 $\\Phi(\\cdot)$ 分别表示标准正态分布 $\\mathcal{N}(0, 1)$ 的概率密度函数 (PDF) 和累积分布函数 (CDF)。$Y$ 的 PDF 可以写为 $f_Y(y) = \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right)$。\n\n选择事件的概率是：\n$$ P(Y  c) = \\int_c^{\\infty} \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right) dy $$\n令 $u = \\frac{y-\\beta}{s}$，则 $dy = s du$。积分下限变为 $\\alpha = \\frac{c-\\beta}{s}$。\n$$ P(Y  c) = \\int_{\\alpha}^{\\infty} \\phi(u) du = 1 - \\Phi(\\alpha) = 1 - \\Phi\\left(\\frac{c-\\beta}{s}\\right) $$\n在 $Y  c$ 条件下，$Y$ 的条件概率密度函数是：\n$$ f_{Y|Yc}(y) = \\frac{f_Y(y)}{P(Y  c)} = \\frac{\\frac{1}{s}\\phi\\left(\\frac{y-\\beta}{s}\\right)}{1 - \\Phi\\left(\\frac{c-\\beta}{s}\\right)} \\quad \\text{for } y  c $$\n条件期望 $\\mathbb{E}[Y \\mid Y  c]$ 是：\n$$ \\mathbb{E}[Y \\mid Y  c] = \\int_c^{\\infty} y f_{Y|Yc}(y) dy = \\frac{1}{1 - \\Phi(\\alpha)} \\int_c^{\\infty} y \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right) dy $$\n使用相同的代换 $u = \\frac{y-\\beta}{s}$ (因此 $y = su + \\beta$)：\n$$ \\int_c^{\\infty} y \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right) dy = \\int_{\\alpha}^{\\infty} (su+\\beta) \\phi(u) du = s \\int_{\\alpha}^{\\infty} u\\phi(u)du + \\beta \\int_{\\alpha}^{\\infty} \\phi(u)du $$\n第二个积分是 $\\beta (1 - \\Phi(\\alpha))$。对于第一个积分，我们注意到 $\\frac{d}{du}\\phi(u) = -u\\phi(u)$。\n$$ s \\int_{\\alpha}^{\\infty} u\\phi(u)du = -s \\int_{\\alpha}^{\\infty} (-\\phi'(u))du = s [-\\phi(u)]_{\\alpha}^{\\infty} = s(0 - (-\\phi(\\alpha))) = s\\phi(\\alpha) $$\n合并各项，分子变为 $s\\phi(\\alpha) + \\beta(1-\\Phi(\\alpha))$。除以分母 $P(Yc)=1-\\Phi(\\alpha)$：\n$$ \\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta}  c] = \\frac{s\\phi(\\alpha) + \\beta(1-\\Phi(\\alpha))}{1 - \\Phi(\\alpha)} = \\beta + s \\frac{\\phi(\\alpha)}{1 - \\Phi(\\alpha)} $$\n代回 $\\alpha = \\frac{c-\\beta}{s}$：\n$$ \\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta}  c] = \\beta + s \\frac{\\phi\\left(\\frac{c-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n$\\frac{\\phi(z)}{1-\\Phi(z)}$ 这一项被称为逆米尔斯比率。选择偏差，即“赢家诅咒”，是条件期望与真实参数 $\\beta$ 之间的差值：\n$$ \\text{Bias} = \\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta}  c] - \\beta = s \\frac{\\phi\\left(\\frac{c-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n为了证明此偏差为严格正数，我们分析其组成部分。标准误 $s$ 被给定为大于 $0$。标准正态 PDF $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$ 对所有实数 $z$ 都是严格为正的。标准正态 CDF $\\Phi(z)$ 是一个严格递增的函数，其值域为 $(0,1)$，这意味着 $1 - \\Phi(z)$ 对所有实数 $z$ 都是严格为正的。由于偏差是严格为正的量的乘积和比率，因此对于任何有限的 $\\beta$ 和 $s  0$，它都是严格为正的。\n\n### 第2部分：条件似然估计\n\n给定 $\\hat{\\beta}$ 的单个观测值 $x$，已知其因 $\\hat{\\beta}  c$ 而被选中，相关的似然是条件似然。这基于第1部分推导出的条件 PDF，在 $x$ 处求值：\n$$ L(\\beta; x | \\hat{\\beta}  c) = f_{\\hat{\\beta}|\\hat{\\beta}c}(x) = \\frac{\\frac{1}{s}\\phi\\left(\\frac{x-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n为了找到在此条件模型下 $\\beta$ 的最大似然估计量 (MLE)，我们将其记为 $\\tilde{\\beta}$，我们需要最大化对数似然函数 $\\ell(\\beta) = \\ln L(\\beta; x)$。\n$$ \\ell(\\beta) = \\ln\\left(\\frac{1}{s}\\phi\\left(\\frac{x-\\beta}{s}\\right)\\right) - \\ln\\left(1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)\\right) $$\n$$ \\ell(\\beta) = -\\ln(s) - \\ln(\\sqrt{2\\pi}) - \\frac{(x-\\beta)^2}{2s^2} - \\ln\\left(1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)\\right) $$\n我们对 $\\ell(\\beta)$ 关于 $\\beta$ 求导，并令结果为 $0$。令 $u = \\frac{c-\\beta}{s}$，则 $\\frac{du}{d\\beta} = -\\frac{1}{s}$。\n$$ \\frac{\\partial\\ell}{\\partial\\beta} = -\\frac{2(x-\\beta)(-1)}{2s^2} - \\frac{1}{1-\\Phi(u)} \\cdot \\frac{d}{d\\beta}\\left(1-\\Phi(u)\\right) $$\n$$ \\frac{\\partial\\ell}{\\partial\\beta} = \\frac{x-\\beta}{s^2} - \\frac{1}{1-\\Phi(u)} \\left(-\\phi(u) \\frac{du}{d\\beta}\\right) = \\frac{x-\\beta}{s^2} - \\frac{\\phi(u)}{1-\\Phi(u)} \\left(-\\frac{1}{s}\\right) $$\n$$ \\frac{\\partial\\ell}{\\partial\\beta} = \\frac{x-\\beta}{s^2} - \\frac{1}{s} \\frac{\\phi\\left(\\frac{c-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n将导数设为零，得到 $\\tilde{\\beta}$ 的估计方程：\n$$ \\frac{x-\\tilde{\\beta}}{s^2} = \\frac{1}{s} \\frac{\\phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)} $$\n$$ x - \\tilde{\\beta} = s \\frac{\\phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)} $$\n这可以重新排列为 $\\tilde{\\beta} = x - s \\frac{\\phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}$。校正项是第1部分中的解析偏差，在校正后的估计值 $\\tilde{\\beta}$ 处进行评估。\n\n我们使用给定值 $x=0.90$，$s=0.12$ 和 $c=0.60$ 数值求解此方程。\n$$ \\tilde{\\beta} = 0.90 - 0.12 \\frac{\\phi\\left(\\frac{0.60-\\tilde{\\beta}}{0.12}\\right)}{1-\\Phi\\left(\\frac{0.60-\\tilde{\\beta}}{0.12}\\right)} $$\n这是一个非线性方程，可以通过不动点迭代或求根算法求解。设初始猜测值为 $\\beta_0 = x = 0.90$。\n第一次迭代是：\n$$ \\beta_1 = 0.90 - 0.12 \\frac{\\phi\\left(\\frac{0.60-0.90}{0.12}\\right)}{1-\\Phi\\left(\\frac{0.60-0.90}{0.12}\\right)} = 0.90 - 0.12 \\frac{\\phi(-2.5)}{1-\\Phi(-2.5)} $$\n使用标准正态表值，$\\phi(-2.5) \\approx 0.017528$ 且 $\\Phi(-2.5) \\approx 0.006210$。注意 $1 - \\Phi(-2.5) = \\Phi(2.5) \\approx 0.99379$。\n$$ \\beta_1 \\approx 0.90 - 0.12 \\left(\\frac{0.017528}{0.99379}\\right) \\approx 0.90 - 0.12(0.017637) \\approx 0.90 - 0.002116 = 0.897884 $$\n继续此迭代过程直至收敛：\n$\\beta_2 \\approx 0.897791$\n$\\beta_3 \\approx 0.897786$\n该序列收敛迅速。$\\tilde{\\beta}$ 的解，四舍五入到四位有效数字，是 $0.8978$。\n\n### 第3部分：参数化自助法方案\n\n参数化自助法（parametric bootstrap）可用于估计选择偏差并校正观测估计值 $x$。目标是估计偏差项 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta}  c] - \\beta$，该项依赖于未知的真实 $\\beta$。\n\n概念方案如下：\n1.  **初始估计**：获取一个合理的真实效应 $\\beta$ 的初始估计。一个合适的选择是第2部分中计算出的条件最大似然估计 $\\tilde{\\beta} \\approx 0.8978$。我们将其表示为 $\\hat{\\beta}_{\\text{init}}$。\n\n2.  **自助法模拟**：执行大量的自助法重复，例如 $B$ 次（如 $B=10,000$）。对于每次重复 $b=1, \\dots, B$：\n    a.  **生成数据**：使用初始估计作为真实均值，从假定的抽样分布中模拟一个新的效应估计值 $\\hat{\\beta}^{*}_b$：$\\hat{\\beta}^{*}_b \\sim \\mathcal{N}(\\hat{\\beta}_{\\text{init}}, s^2)$。在这里，即从 $\\mathcal{N}(0.8978, (0.12)^2)$ 中抽取一个样本。\n    b.  **应用选择规则**：通过应用选择规则来模仿研究的发现过程。仅当 $\\hat{\\beta}^{*}_b$ 超过截断值 $c$ 时，才保留它。即，如果 $\\hat{\\beta}^{*}_b  0.60$。\n\n3.  **偏差估计**：在所有 $B$ 次重复之后，计算被选中的自助法估计值的平均值。设此集合为 $S = \\{\\hat{\\beta}^{*}_b \\mid \\hat{\\beta}^{*}_b  c\\}$。平均值为 $\\bar{\\beta}^{*} = \\frac{1}{|S|} \\sum_{\\hat{\\beta}^{*} \\in S} \\hat{\\beta}^{*}$。\n    估计的偏差是这个条件均值与用于模拟的均值之间的差值：$\\widehat{\\text{Bias}} = \\bar{\\beta}^{*} - \\hat{\\beta}_{\\text{init}}$。\n\n4.  **偏差校正**：从原始的、未校正的观测值 $x$ 中减去估计的偏差：\n    $$ \\hat{\\beta}_{\\text{corrected}} = x - \\widehat{\\text{Bias}} = 0.90 - (\\bar{\\beta}^{*} - 0.8978) $$\n\n**与第1部分的关系**：参数化自助法为第1部分的解析结果提供了一个数值上的蒙特卡洛近似。当真实效应假定为 $\\hat{\\beta}_{\\text{init}}$ 时，被选中的自助样本的平均值 $\\bar{\\beta}^{*}$ 是条件期望 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta}  c]$ 的一个数值估计。因此，估计的偏差 $\\widehat{\\text{Bias}}$ 是第1部分中推导出的解析偏差量的一个数值估计：\n$$ \\widehat{\\text{Bias}} = \\bar{\\beta}^{*} - \\hat{\\beta}_{\\text{init}} \\approx s \\frac{\\phi\\left(\\frac{c-\\hat{\\beta}_{\\text{init}}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\hat{\\beta}_{\\text{init}}}{s}\\right)} $$\n本质上，自助法程序通过模拟数据生成和选择过程，来经验性地测量第1部分解析公式以闭合形式描述的高估量（赢家诅咒）。", "answer": "$$\\boxed{0.8978}$$", "id": "4395285"}]}