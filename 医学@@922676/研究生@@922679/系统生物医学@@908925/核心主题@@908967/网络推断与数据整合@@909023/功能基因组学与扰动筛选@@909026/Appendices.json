{"hands_on_practices": [{"introduction": "在汇集式CRISPR筛选实验中，感染复数（MOI）是一个关键的设计参数，它决定了每个细胞平均接收的病毒整合事件数量。为了确保大多数细胞只接受一个独特的单导向RNA（sgRNA），从而简化下游分析，精确控制MOI至关重要。本练习 [@problem_id:4344697] 将引导你从第一性原理出发，推导在给定MOI（表示为 $\\lambda$）的条件下，细胞群体中未感染、单次感染和多次感染细胞的比例，从而加深对泊松分布在模拟此随机过程中核心作用的理解。", "problem": "在一项混合型成簇规律间隔短回文重复序列 (Clustered Regularly Interspaced Short Palindromic Repeats, CRISPR) 扰动筛选中，哺乳动物细胞通过慢病毒文库进行转导，使得每个细胞的成功整合事件数由许多独立的、每次试验成功概率很小且每个细胞平均成功次数有限的试验所决定。实验感染复数 (multiplicity of infection, MOI) 定义为每个细胞的预期成功整合事件数，并用 $\\lambda$ 表示。假设病毒颗粒和细胞间的感染事件是独立的，并且每个细胞都暴露于大量的病毒颗粒，每个病毒颗粒的感染概率很小，使得每个细胞的预期成功感染数保持为 $\\lambda$，请从第一性原理推导未感染（恰好 $0$ 次整合）、单次感染（恰好 $1$ 次整合）和多次感染（至少 $2$ 次整合）的细胞比例的解析表达式（以 $\\lambda$ 表示）。将你的最终答案以单行向量的形式报告，其中包含按未感染、单次感染和多次感染顺序排列的三个表达式。只需提供解析表达式；不需要进行数值计算或四舍五入，最终表达式中不应包含任何单位。", "solution": "用户提供了一个问题陈述，在尝试解决方案之前需要对其进行验证。\n\n### 步骤 1：提取已知条件\n- **背景**：一项使用慢病毒文库转导哺乳动物细胞的混合型 CRISPR 扰动筛选。\n- **过程描述**：每个细胞的成功整合事件数由许多独立的、每次试验成功概率很小的试验所决定。\n- **变量定义**：实验感染复数 (MOI)，用 $\\lambda$ 表示，是每个细胞的预期成功整合事件数。\n- **假设**：\n    1.  病毒颗粒和细胞间的感染事件是独立的。\n    2.  每个细胞都暴露于大量的病毒颗粒。\n    3.  每个病毒颗粒的感染概率很小。\n    4.  每个细胞的预期成功感染数固定为 $\\lambda$。\n- **目标**：从第一性原理推导以下细胞比例的解析表达式：\n    1.  未感染（恰好 $0$ 次整合）。\n    2.  单次感染（恰好 $1$ 次整合）。\n    3.  多次感染（至少 $2$ 次整合）。\n- **要求的输出格式**：一个单行向量，按指定顺序包含用 $\\lambda$ 表示的三个表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题陈述进行严格评估。\n\n- **科学依据**：该问题在病毒学和分子生物遗传学原理方面有充分的依据。使用慢病毒载体进行基因递送、感染复数 (MOI) 的概念以及转导事件的统计建模是系统生物医学和功能基因组学领域的标准和基本概念。将感染过程描述为“许多独立的、每次试验成功概率很小的试验”是泊松分布的经典物理动因。\n- **适定性**：该问题是适定的。它定义了一个随机过程，指定了其关键参数和极限行为，并要求从所得分布中计算特定概率。问题明确，根据所提供的信息，可以得出一个唯一、稳定且有意义的解析解。\n- **客观性**：问题以客观、正式的语言陈述。没有主观或基于意见的主张。\n- **缺陷分析**：\n    1.  **科学/事实不健全**：无。所描述的模型是对给定 MOI 下慢病毒转导的标准且准确的表示。\n    2.  **非形式化/不相关**：无。该问题可以直接形式化为一个标准的概率论框架，并且与其指定的主题高度相关。\n    3.  **不完整/矛盾的设定**：无。问题提供了足够的约束条件（大量病毒颗粒，小感染概率，固定的平均值 $\\lambda$），以唯一地确定主导的概率分布。\n    4.  **不切实际/不可行**：无。该场景描述了生物医学研究中的一个常规实验程序。\n    5.  **不适定/结构不良**：无。目标陈述清晰，解决方案的路径可以从前提中逻辑推导出来。\n    6.  **伪深刻/琐碎**：无。虽然结果是一个众所周知的公式，但“从第一性原理推导”的要求需要对二项分布的泊松极限进行严格的证明，这是一个实质性的推理练习。\n    7.  **超出科学可验证性**：无。该模型的预测可以并且经常与 CRISPR 筛选的实验数据进行比较。\n\n### 步骤 3：结论与行动\n该问题是**有效的**，因为它在科学上是健全的、适定的，并且没有任何指定的缺陷。我将继续进行解决方案的完整推导。\n\n该问题要求从第一性原理进行推导。对转导过程的描述——大量的独立试验（$N$，一个细胞暴露的病毒颗粒数量），每次试验的成功概率很小（$p$，单个病毒颗粒成功整合的概率）——表明每个细胞的成功整合次数遵循二项分布。设随机变量 $K$ 表示单个细胞中成功整合事件的数量。\n\n在二项分布模型下，在 $N$ 次试验中观察到恰好 $k$ 次成功的概率由概率质量函数 (PMF) 给出：\n$$P(K=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n问题陈述，平均整合数是感染复数 $\\lambda$。对于二项分布，平均值为 $E[K] = Np$。因此，我们有约束条件：\n$$\\lambda = Np$$\n问题还指明 $N$ 很大且 $p$ 很小。这正是二项分布收敛于泊松分布的精确条件。我们可以通过在保持 $\\lambda = Np$ 恒定的情况下，取 $N \\to \\infty$ 的极限来证明这一点。\n\n由 $\\lambda = Np$，我们可以将 $p$ 表示为 $p = \\frac{\\lambda}{N}$。将其代入二项分布的 PMF：\n$$P(K=k) = \\binom{N}{k} \\left(\\frac{\\lambda}{N}\\right)^k \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n展开二项式系数 $\\binom{N}{k} = \\frac{N!}{k!(N-k)!} = \\frac{N(N-1)(N-2)\\cdots(N-k+1)}{k!}$：\n$$P(K=k) = \\frac{N(N-1)\\cdots(N-k+1)}{k!} \\frac{\\lambda^k}{N^k} \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n我们可以重新排列这个表达式：\n$$P(K=k) = \\frac{\\lambda^k}{k!} \\left[\\frac{N(N-1)\\cdots(N-k+1)}{N^k}\\right] \\left(1-\\frac{\\lambda}{N}\\right)^N \\left(1-\\frac{\\lambda}{N}\\right)^{-k}$$\n现在，我们计算当 $N \\to \\infty$ 时各部分的极限：\n1.  项 $\\frac{N(N-1)\\cdots(N-k+1)}{N^k}$ 是关于 $N$ 的 $k$ 次多项式的比值。\n    $$\\lim_{N\\to\\infty} \\frac{N(N-1)\\cdots(N-k+1)}{N^k} = \\lim_{N\\to\\infty} \\left(\\frac{N}{N}\\right)\\left(\\frac{N-1}{N}\\right)\\cdots\\left(\\frac{N-k+1}{N}\\right) = \\lim_{N\\to\\infty} (1)\\left(1-\\frac{1}{N}\\right)\\cdots\\left(1-\\frac{k-1}{N}\\right) = 1$$\n2.  项 $\\left(1-\\frac{\\lambda}{N}\\right)^N$ 有一个定义了指数函数的著名极限：\n    $$\\lim_{N\\to\\infty} \\left(1-\\frac{\\lambda}{N}\\right)^N = \\exp(-\\lambda)$$\n3.  对于固定的 $k$ 值，最后一项变为：\n    $$\\lim_{N\\to\\infty} \\left(1-\\frac{\\lambda}{N}\\right)^{-k} = (1-0)^{-k} = 1$$\n结合这些结果，我们得到极限概率：\n$$\\lim_{N\\to\\infty} P(K=k) = \\frac{\\lambda^k}{k!} \\cdot 1 \\cdot \\exp(-\\lambda) \\cdot 1 = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n这是平均值为 $\\lambda$ 的泊松分布的 PMF。因此，每个细胞的整合事件数 $K$ 由 $K \\sim \\text{Pois}(\\lambda)$ 描述。恰好有 $k$ 次整合的细胞比例由 $P(K=k)$ 给出。\n\n我们现在可以计算所需的比例：\n1.  **未感染细胞的比例**：这对应于 $k=0$ 次整合。\n    $$P(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda)$$\n2.  **单次感染细胞的比例**：这对应于 $k=1$ 次整合。\n    $$P(K=1) = \\frac{\\lambda^1 \\exp(-\\lambda)}{1!} = \\frac{\\lambda \\exp(-\\lambda)}{1} = \\lambda \\exp(-\\lambda)$$\n3.  **多次感染细胞的比例**：这对应于 $k \\geq 2$ 次整合。其概率为 $P(K \\geq 2)$。更方便的计算方法是将其作为有 $0$ 次或 $1$ 次整合的细胞的补集。\n    $$P(K \\geq 2) = 1 - P(K  < 2) = 1 - \\left(P(K=0) + P(K=1)\\right)$$\n    代入我们找到的表达式：\n    $$P(K \\geq 2) = 1 - \\left(\\exp(-\\lambda) + \\lambda \\exp(-\\lambda)\\right) = 1 - (1+\\lambda)\\exp(-\\lambda)$$\n\n所要求的三个比例是 $\\exp(-\\lambda)$、$\\lambda \\exp(-\\lambda)$ 和 $1 - (1+\\lambda)\\exp(-\\lambda)$。这些将以单行向量的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp(-\\lambda)  \\lambda \\exp(-\\lambda)  1 - (1+\\lambda)\\exp(-\\lambda)\n\\end{pmatrix}\n}\n$$", "id": "4344697"}, {"introduction": "成功设计实验后，下一步是对产生的数据进行精确建模。CRISPR筛选的原始输出是高通量测序读数，这些计数数据通常表现出比简单泊松模型预测的更大变异性，这种现象被称为“过度离散”（overdispersion）。本练习 [@problem_id:4344572] 深入探讨了为何负二项分布是分析此类数据的更优选择，它将引导你辨析正确的模型设定，理解其作为泊松-伽马混合模型的内在机理，以及该模型如何有效捕捉由生物和技术因素引入的额外变异。", "problem": "一项汇集的成簇规律间隔短回文重复序列 (Clustered Regularly Interspaced Short Palindromic Repeats, CRISPR) 功能缺失筛选实验，使用了多种单导向RNA (single-guide RNA, sgRNA) 构建体，并设置了多个生物学重复。对于重复实验 $i$ 和 sgRNA（靶向某个基因或作为对照）$g$，观测到的测序计数记为 $Y_{ig}$。假定以下基本前提：测序计数是由许多独立的、稀有的抽样事件加总而成，对此，一个均一速率模型会产生均值与方差相等的泊松定律；而在细胞和技术步骤（例如，编辑效率、生长和文库制备的差异）中，有效速率存在未被观察到的异质性，这导致方差相对于泊松定律发生膨胀。设 $s_i$ 为重复实验 $i$ 的已知测序深度或文库大小归一化因子，$z_i \\in \\{0,1\\}$ 为一个处理条件的指示变量，并设 sgRNA $g$ 的基线丰度和处理效应为潜对数尺度参数。\n\n哪个选项正确地指定了 $Y_{ig}$ 的负二项分布模型，该模型 (i) 为边际计数分布提供了一个有效的概率质量函数，(ii) 使用了适当的广义线性模型 (GLM) 连接函数，并为 $s_i$ 设置了偏移量，(iii) 导出的均值-方差关系能够捕捉相对于泊松定律的过度离散现象，以及 (iv) 从泊松分布基础出发，为源于生物学和技术变异的过度离散现象提供了机理上的解释？\n\nA. 对每个 $i,g$，设条件抽样模型为 $Y_{ig}\\mid \\Lambda_{ig} \\sim \\mathrm{Poisson}(\\Lambda_{ig})$，其中随机速率 $\\Lambda_{ig}$ 服从伽马分布 $\\Lambda_{ig} \\sim \\mathrm{Gamma}(k, k/\\mu_{ig})$（形状-速率参数化），其中 $k>0$。那么边际上 $Y_{ig} \\sim \\mathrm{NB}(k,\\mu_{ig})$，其\n$$\n\\mathbb{P}(Y_{ig}=y) \\;=\\; \\frac{\\Gamma(y+k)}{\\Gamma(k)\\,y!}\\left(\\frac{k}{k+\\mu_{ig}}\\right)^{k}\\left(\\frac{\\mu_{ig}}{k+\\mu_{ig}}\\right)^{y},\\quad y\\in \\{0,1,2,\\dots\\},\n$$\n$\\mathbb{E}[Y_{ig}]=\\mu_{ig}$ 且 $\\mathrm{Var}(Y_{ig})=\\mu_{ig}+\\mu_{ig}^{2}/k=\\mu_{ig}+\\alpha\\,\\mu_{ig}^{2}$，其中 $\\alpha=1/k$。使用带有测序深度偏移量的对数连接函数，\n$$\n\\log \\mu_{ig} \\;=\\; \\log s_i \\;+\\; \\alpha_g \\;+\\; \\beta_g\\, z_i,\n$$\n其中 $\\alpha_g$ 是基线对数丰度，$\\beta_g$ 是 sgRNA $g$ 的条件效应。相对于泊松分布的过度离散之所以产生，是因为有效速率中未被观察到的异质性（例如，可变的编辑效率、差异性生长和聚合酶链式反应扩增）导致 $\\Lambda_{ig}$ 服从伽马分布，而泊松-伽马混合产生了负二项定律。\n\nB. 将 $Y_{ig}$ 建模为 $Y_{ig} \\sim \\mathrm{Poisson}(\\mu_{ig})$，使用对数连接函数 $\\log \\mu_{ig}=\\log s_i+\\alpha_g+\\beta_g z_i$，并假设 $\\mathrm{Var}(Y_{ig})=\\phi\\,\\mu_{ig}$（其中常数 $\\phi>1$）以解释过度离散。过度离散完全由聚合酶链式反应扩增引起，它将泊松方差线性地重新缩放为 $\\mu_{ig}$ 的倍数。\n\nC. 将 $Y_{ig}$ 建模为 $Y_{ig} \\sim \\mathrm{NB}(r,p_{ig})$，使用恒等连接函数 $\\mu_{ig}=s_i+\\alpha_g+\\beta_g z_i$ 和方差 $\\mathrm{Var}(Y_{ig})=\\mu_{ig}+\\alpha\\,\\mu_{ig}$，其中某个 $\\alpha>0$。通过假设一个贝塔-泊松混合来解释过度离散。\n\nD. 使用对数正态-泊松混合：$Y_{ig}\\mid \\eta_{ig}\\sim \\mathrm{Poisson}(\\mu_{ig} e^{\\eta_{ig}})$，其中 $\\eta_{ig}\\sim \\mathcal{N}(0,\\sigma^{2})$ 且 $\\log \\mu_{ig}=\\log s_i+\\alpha_g+\\beta_g z_i$。声称这种混合等价于一个负二项分布，其方差为 $\\mathrm{Var}(Y_{ig})=\\mu_{ig}+\\alpha\\,\\mu_{ig}^{2}$，并且过度离散是由乘性噪声引起的。\n\nE. 使用零膨胀泊松模型，其中 $\\mathbb{P}(Y_{ig}=0)=\\pi+(1-\\pi)e^{-\\mu_{ig}}$，$\\mathbb{P}(Y_{ig}=y>0)=(1-\\pi)e^{-\\mu_{ig}}\\mu_{ig}^{y}/y!$，$\\log \\mu_{ig}=\\log s_i+\\alpha_g+\\beta_g z_i$，以及方差 $\\mathrm{Var}(Y_{ig})=\\mu_{ig}(1-\\pi)$。通过非切割导向RNA引起的过多零值来解释过度离散。", "solution": "用户要求对问题陈述进行严格验证，然后对所提供的用于 CRISPR 筛选计数数据建模的选项进行详细推导和评估。\n\n### 步骤 1：提取已知条件\n\n- **实验**：汇集的 CRISPR 功能缺失筛选。\n- **数据**：测序计数，$Y_{ig}$，对应重复实验 $i$ 和 sgRNA $g$。\n- **协变量**：\n    - $s_i$：重复实验 $i$ 的已知测序深度/文库大小归一化因子。\n    - $z_i \\in \\{0,1\\}$：重复实验 $i$ 的处理条件的指示变量。\n- **参数**：sgRNA $g$ 的基线丰度 ($\\alpha_g$) 和处理效应 ($\\beta_g$) 的潜对数尺度参数。\n- **基本模型前提**：\n    1.  测序计数是许多独立的、稀有抽样事件的总和，这为使用泊松定律作为基础提供了依据。\n    2.  有效速率中未被观察到的异质性（由于编辑效率、生长、文库制备等因素）导致方差相对于泊松模型膨胀。这是过度离散的来源。\n- **任务**：识别正确指定了 $Y_{ig}$ 的负二项分布模型的选项，该模型需满足四个标准：\n    1.  为边际计数分布提供有效的概率质量函数 (PMF)。\n    2.  使用适当的广义线性模型 (GLM) 连接函数，并为 $s_i$ 设置偏移量。\n    3.  导出的均值-方差关系能够捕捉过度离散现象。\n    4.  为源于基本模型前提的过度离散现象提供机理上的解释。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n问题陈述描述了功能基因组学和计算生物学中的一个标准情景：分析高通量测序实验中存在过度离散的计数数据。\n\n- **科学上合理**：该问题牢固地植根于统计基因组学的既定原则。CRISPR 筛选的使用、测序计数的生成，以及归一化和过度离散的挑战都是该领域的核心内容。所涉及的统计概念——泊松分布作为计数的基础、过度离散、负二项 (NB) 分布作为过度离散计数的模型，以及带有对数连接和偏移量的广义线性模型 (GLM)——都是用于此类数据分析的最新和教科书式的方法（例如，在 DESeq2 和 edgeR 等广泛使用的软件中实现）。\n- **定义明确**：问题定义清晰。它要求根据四个精确且可验证的技术标准来识别正确的模型设定。对于什么构成正确答案没有歧义。\n- **客观性**：问题以精确、定量和客观的语言陈述，不含任何主观或非科学内容。\n\n该问题没有违反任何无效标准。它在科学上是合理的、定义明确的、客观的、完整的且相关的。它提出了一个实质性问题，测试了对系统生物医学中一个常见且重要分析流程背后统计理论的理解。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。解决方案将通过对照四个指定标准逐一评估每个选项来展开。\n\n### 推导与逐项分析\n\n问题的核心是将陈述“有效速率的异质性...导致方差膨胀”形式化。这通常被建模为一个混合分布模型。计数的基础模型是泊松分布，所以我们从 $Y_{ig} \\mid \\Lambda_{ig} \\sim \\mathrm{Poisson}(\\Lambda_{ig})$ 开始，其中 $\\Lambda_{ig}$ 是计数 $Y_{ig}$ 的未观察到的“真实”速率参数。异质性通过假设 $\\Lambda_{ig}$ 本身是一个从某个分布中抽取的随机变量来建模。\n\n为了使 $Y_{ig}$ 的边际分布是负二项分布，速率 $\\Lambda_{ig}$ 的分布必须是伽马分布。这是统计学中一个众所周知的结果：泊松-伽马混合产生负二项分布。让我们将其形式化。\n\n如果 $Y \\mid \\Lambda \\sim \\mathrm{Poisson}(\\Lambda)$ 且 $\\Lambda \\sim \\mathrm{Gamma}(\\text{shape}=k, \\text{scale}=\\theta)$，则 $Y$ 的边际分布是 $\\mathrm{NB}(\\text{r}=k, \\text{p}=1/(1+\\theta))$。此负二项分布的均值和方差是 $\\mathbb{E}[Y]=k\\theta$ 和 $\\mathrm{Var}(Y)=k\\theta(1+\\theta)$。我们将均值定义为 $\\mu \\equiv k\\theta$。那么方差可以重写为 $\\mathrm{Var}(Y) = \\mu + k\\theta^2 = \\mu + (k\\theta)^2/k = \\mu + \\mu^2/k$。这是标准的 NB2 参数化，通常写作 $\\mathrm{Var}(Y) = \\mu + \\alpha\\mu^2$，其中 $\\alpha=1/k$ 是离散度参数。方差是均值的二次函数，对于任何 $\\alpha>0$，$\\mathrm{Var}(Y) > \\mathbb{E}[Y]$，这定义了相对于泊松模型（其中 $\\mathrm{Var}(Y) = \\mathbb{E}[Y]$）的过度离散。\n\nGLM 组件将均值 $\\mu_{ig}$ 与协变量关联起来。对于计数数据，使用对数连接函数以确保 $\\mu_{ig} > 0$。文库中的总读数 $s_i$ 作为对潜在相对丰度的缩放因子。因此，我们期望 $\\mu_{ig} \\propto s_i$。在对数线性模型中，这变为 $\\log(\\mu_{ig}) = \\log(s_i) + \\text{其他项}$。在这里，$\\log(s_i)$ 是一个已知项，因此是一个“偏移量”。模型变为 $\\log(\\mu_{ig}) = \\log s_i + \\alpha_g + \\beta_g z_i$。\n\n在这些原则建立之后，我们评估各个选项。\n\n#### **选项 A**\n\n-   **(i) 有效的 PMF**：该选项提出了一个泊松-伽马混合模型：$Y_{ig}\\mid \\Lambda_{ig} \\sim \\mathrm{Poisson}(\\Lambda_{ig})$，其中 $\\Lambda_{ig} \\sim \\mathrm{Gamma}(k, k/\\mu_{ig})$（形状-速率）。此伽马分布的均值为 $\\mathbb{E}[\\Lambda_{ig}] = \\text{形状}/\\text{速率} = k / (k/\\mu_{ig}) = \\mu_{ig}$。因此，$Y_{ig}$ 的边际分布是以 $\\mu_{ig}$ 为均值的负二项分布。所提供的 PMF 是由其均值 $\\mu_{ig}$ 和形状/离散度参数 $k$ 参数化的 NB 分布的正确 PMF。标准 (i) 满足。\n-   **(ii) 适当的 GLM**：它提出了对数连接模型 $\\log \\mu_{ig} = \\log s_i + \\alpha_g + \\beta_g z_i$。这正确地使用了对数连接函数以确保均值为正，并包含 $\\log s_i$ 作为偏移量来考虑测序深度。这是此类数据的标准且正确的 GLM 结构。标准 (ii) 满足。\n-   **(iii) 均值-方差关系**：它指出 $\\mathbb{E}[Y_{ig}]=\\mu_{ig}$ 和 $\\mathrm{Var}(Y_{ig})=\\mu_{ig}+\\mu_{ig}^{2}/k$。正如上面从泊松-伽马混合的总方差定律推导出的，这是 NB2 模型的正确方差。由于 $k>0$，方差大于均值，二次项 $\\mu_{ig}^2/k$ 明确地模拟了过度离散。标准 (iii) 满足。\n-   **(iv) 机理上的解释**：它正确地将过度离散归因于有效速率中未被观察到的异质性，将其形式化为泊松速率的伽马分布，并正确地将得到的混合分布识别为负二项分布。这与问题陈述的前提完全一致。标准 (iv) 满足。\n\n对 A 的结论：**正确**。所有四个标准都得到了满足。\n\n#### **选项 B**\n\n-   该选项提出了一个拟泊松模型，而不是负二项模型。这立即违反了问题明确要求的“负二项模型”。拟似然是一种估计方法，而不是一个具有 PMF 的完全指定的概率分布。因此，标准 (i) 未满足。此外，它假定了一个线性的均值-方差关系，$\\mathrm{Var}(Y_{ig})=\\phi\\,\\mu_{ig}$，这对于测序数据通常不如 NB 模型的二次关系准确。\n\n对 B 的结论：**不正确**。\n\n#### **选项 C**\n\n-   该选项对均值使用了恒等连接函数：$\\mu_{ig}=s_i+\\alpha_g+\\beta_g z_i$。这是不正确的。恒等连接不保证均值为正（$\\mu_{ig} \\ge 0$）。此外，它将测序深度 $s_i$ 的效应建模为加性的，而它本质上是一个乘性的缩放因子。正确的方法是使用带有对数偏移量的对数连接，如选项 A 所示。这不满足标准 (ii)。\n-   它还提出了一个线性的均值-方差关系 $\\mathrm{Var}(Y_{ig})=\\mu_{ig}+\\alpha\\,\\mu_{ig}$，这不如二次关系标准，且通常不太适用。这是标准 (iii) 下的一个弱点。\n-   最后，它提到了“贝塔-泊松混合”。这不是 NB 分布的标准推导；正确的推导是泊松-伽马混合。这不满足标准 (iv)。\n\n对 C 的结论：**不正确**。\n\n#### **选项 D**\n\n-   该选项提出了一个对数正态-泊松混合模型。这种混合产生的边际分布不是负二项分布，并且它没有闭合形式的 PMF。声称“这种混合等价于一个负二项分布”在事实上是错误的。虽然它们都是过度离散的计数模型，但它们在数学上是不同的分布。这不满足标准 (i)。\n\n对 D 的结论：**不正确**。\n\n#### **选项 E**\n\n-   该选项提出了一个零膨胀泊松 (ZIP) 模型。ZIP 模型不是负二项模型。它通过一种不同的机制（过多的零）来处理过度离散，而不是 NB 模型（一般的速率异质性）。这不满足问题对 NB 模型的明确要求，因此不满足标准 (i)。\n-   所提供的方差公式 $\\mathrm{Var}(Y_{ig})=\\mu_{ig}(1-\\pi)$ 是不正确的。所指定的 ZIP 模型的实际均值是 $\\mathbb{E}[Y_{ig}]=(1-\\pi)\\mu_{ig}$，方差是 $\\mathrm{Var}(Y_{ig}) = (1-\\pi)\\mu_{ig} + \\pi(1-\\pi)\\mu_{ig}^2$。选项中的公式是错误的，甚至没有正确地描述过度离散。这不满足标准 (iii)。\n\n对 E 的结论：**不正确**。\n\n### 结论\n\n只有选项 A 正确且全面地满足了问题陈述中列出的所有四个标准。它展示了应用于测序计数数据的负二项 GLM 的标准且理论上合理的泊松-伽马混合推导。", "answer": "$$\\boxed{A}$$", "id": "4344572"}, {"introduction": "在为数千个基因拟合统计模型并生成p值后，分析的最后一步是从中筛选出真正的“命中”基因，同时避免被大量的假阳性结果所淹没。对于大规模筛选，错误发现率（FDR）是比家族谬误率（FWER）更为实用和强大的错误控制指标。本练习 [@problem_id:4344579] 提供了一个动手实践的机会，你将应用Benjamini-Hochberg（BH）程序——一个控制FDR的标准方法——将一系列p值转化为一组具有统计显著性的发现，从而掌握从数据到结论的关键一步。", "problem": "在系统生物医学中，一项汇集的成簇规律间隔短回文重复序列 (CRISPR) 敲除生存力筛选通过为每个基因拟合一个广义线性模型并生成一个 $p$-值来测试 $m$ 个基因的必需性。假设对应于真正非必需基因的 $p$-值是有效的（在 $[0,1]$ 上均匀分布），并且这些检验是独立的或满足子集正回归依赖性 (Positive Regression Dependence on a Subset, PRDS)。研究者希望在宣布必需基因的同时控制伪发现率 (False Discovery Rate, FDR)。\n\n考虑一个包含 $m = 12$ 个基因的预实验板，产生了以下有序的 $p$-值（已按升序排列）：$p_{(1)} = 0.001$, $p_{(2)} = 0.009$, $p_{(3)} = 0.020$, $p_{(4)} = 0.031$, $p_{(5)} = 0.045$, $p_{(6)} = 0.060$, $p_{(7)} = 0.120$, $p_{(8)} = 0.200$, $p_{(9)} = 0.330$, $p_{(10)} = 0.500$, $p_{(11)} = 0.700$, $p_{(12)} = 0.900$。目标 FDR 水平为 $q = 0.10$。\n\n哪个选项正确地陈述了 (i) 以伪发现数 $V$ 和总发现数 $R$ 表示的伪发现率 (FDR) 的正式定义，(ii) 在独立或 PRDS 检验下控制 FDR 的 Benjamini–Hochberg (BH) 升阶程序，包括如何选择拒绝阈值，(iii) BH 控制 FDR 的条件和界限，以及 (iv) 对于给定的预实验 $p$-值，在 $q = 0.10$ 时的拒绝数量？\n\nA. FDR 是 $P(V > 0)$。BH 程序按降序对 $p$-值进行排序，并拒绝所有满足 $p_{(i)} \\ge \\frac{i}{m} q$ 的 $p_{(i)}$。它在任何依赖结构下都将 FDR 控制在最多 $q$。对于该预实验板，它拒绝了 $5$ 个基因。\n\nB. FDR 是 $\\mathbb{E}\\!\\left[\\dfrac{V}{R \\vee 1}\\right]$，其中 $R \\vee 1$ 表示 $\\max(R, 1)$。BH 升阶程序按升序对 $p$-值进行排序，找到满足 $p_{(k)} \\le \\dfrac{k}{m} q$ 的最大索引 $k$，并拒绝所有索引 $i \\le k$ 的假设。在独立性或子集正回归依赖性 (PRDS) 的条件下，BH 将 FDR 控制在 $\\mathbb{E}\\!\\left[\\dfrac{V}{R \\vee 1}\\right] \\le \\dfrac{m_{0}}{m} q$，其中 $m_{0}$ 是为真的原假设的数量；特别地，如果所有假设都为原假设，则 $\\mathbb{E}\\!\\left[\\dfrac{V}{R \\vee 1}\\right] \\le q$。对于 $q = 0.10$ 的预实验板，它拒绝了 $4$ 个基因。\n\nC. FDR 是 $\\mathbb{E}\\!\\left[\\dfrac{V}{m}\\right]$。BH 方法是 Holm 程序的一个降阶变体，它在依次检查 $p_{(i)} \\le \\dfrac{q}{m - i + 1}$ 的同时拒绝最小的 $p$-值。它在水平 $q$ 上控制家族谬误率 (Family-Wise Error Rate, FWER)。对于该预实验板，它拒绝了 $6$ 个基因。\n\nD. FDR 是 $\\mathbb{E}\\!\\left[\\dfrac{R}{m}\\right]$。BH 程序简化为 Bonferroni 校正，拒绝所有 $p_{i} \\le \\dfrac{q}{m}$；它仅在 $m_{0}$ 未知时确保 FDR 最多为 $q$。对于该预实验板，它拒绝了 $1$ 个基因。", "solution": "在进行解答之前，对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n-   背景是系统生物医学中的一项汇集的 CRISPR 敲除生存力筛选。\n-   测试的基因数量为 $m = 12$。\n-   对每个基因进行统计检验，每个基因产生一个 $p$-值。\n-   原假设是基因非必需。\n-   假设是：\n    1.  对应于真正非必需基因的 $p$-值服从 $[0,1]$ 上的均匀分布。\n    2.  这些检验是独立的或满足子集正回归依赖性 (PRDS)。\n-   目标是控制伪发现率 (FDR)。\n-   目标 FDR 水平为 $q = 0.10$。\n-   有序的 $p$-值为：$p_{(1)} = 0.001$, $p_{(2)} = 0.009$, $p_{(3)} = 0.020$, $p_{(4)} = 0.031$, $p_{(5)} = 0.045$, $p_{(6)} = 0.060$, $p_{(7)} = 0.120$, $p_{(8)} = 0.200$, $p_{(9)} = 0.330$, $p_{(10)} = 0.500$, $p_{(11)} = 0.700$, $p_{(12)} = 0.900$。\n-   问题要求选出涵盖四个组成部分的正确陈述：(i) FDR 的正式定义，(ii) Benjamini–Hochberg (BH) 程序的描述，(iii) BH 程序控制 FDR 的条件和界限，以及 (iv) 所提供数据的拒绝数量。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题陈述在科学上和数学上都是合理的。\n-   **科学依据**：CRISPR 筛选、检验基因必需性以及使用多重假设检验校正的场景，是现代功能基因组学和系统生物学中一个标准且基础的工作流程。包括 $p$-值、FDR、独立性和 PRDS 在内的统计概念在统计学文献中已有完善的定论。\n-   **问题定义明确**：问题定义清晰。它提供了所有必要的数据（$p$-值的集合、$m$ 和 $q$）和必要的假设（独立性或 PRDS），以唯一确定 Benjamini-Hochberg 程序的结果。\n-   **用语精确**：语言精确，并使用了统计学和生物信息学中标准的、无歧义的术语。\n-   **完整性与一致性**：提供的 $p$-值数量（12个）与所述的基因数量 $m=12$ 相符。所有数据都一致且足以得出解答。\n\n### 第 3 步：结论与行动\n问题有效。将推导解答。\n\n### 正确答案的推导\n\n该问题要求对伪发现率和 Benjamini-Hochberg (BH) 程序有全面的理解。在评估选项之前，我们将逐一分析所需的四个组成部分。\n\n我们将 $m$ 个假设检验的结果整理成一个表格：\n| | 宣布不显著 (接受原假设) | 宣布显著 (拒绝原假设) | 总计 |\n| :--- | :---: | :---: | :---: |\n| **原假设为真** | $U$ | $V$ (伪发现) | $m_0$ |\n| **原假设为假**| $T$ | $S$ (真发现) | $m_1$ |\n| **总计** | $m-R$ | $R$ (总发现数) | $m$ |\n\n在这里，$V$ 是伪发现的数量（第一类错误），$R$ 是总拒绝数（发现数）。$m_0$ 是为真的原假设的数量。\n\n**(i) 伪发现率 (FDR) 的正式定义**\n伪发现比例 (False Discovery Proportion, FDP) 是所有发现中伪发现的比例。其定义为，如果 $R > 0$，则 $Q = V/R$；如果 $R = 0$，则 $Q = 0$。为避免除以零，可简洁地写作 $Q = \\dfrac{V}{\\max(R, 1)}$，也可表示为 $\\dfrac{V}{R \\vee 1}$。伪发现率 (FDR) 是 FDP 的统计期望：\n$$\n\\text{FDR} = \\mathbb{E}[Q] = \\mathbb{E}\\left[\\frac{V}{R \\vee 1}\\right]\n$$\n\n**(ii) Benjamini–Hochberg (BH) 升阶程序**\n在目标水平 $q$ 控制 FDR 的程序如下：\n1.  将 $m$ 个 $p$-值从小到大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。\n2.  找到满足以下不等式的最大索引 $k \\in \\{1, 2, \\dots, m\\}$：\n    $$\n    p_{(k)} \\le \\frac{k}{m} q\n    $$\n3.  如果存在这样的 $k$，则拒绝所有 $i \\le k$ 的原假设 $H_{(i)}$。如果不存在这样的 $k$，则不拒绝任何原假设。\n\n**(iii) 使用 BH 控制 FDR 的条件和界限**\nBenjamini and Hochberg (1995) 证明了 BH 程序可以为独立的检验统计量控制 FDR。Benjamini and Yekutieli (2001) 将此保证扩展到满足子集正回归依赖性 (PRDS) 条件的检验统计量。在这些条件（独立性或 PRDS）下，BH 程序保证：\n$$\n\\text{FDR} = \\mathbb{E}\\left[\\frac{V}{R \\vee 1}\\right] \\le \\frac{m_0}{m} q\n$$\n由于为真的原假设数量 $m_0$ 总是小于或等于总检验数 $m$ (即，$m_0 \\le m$)，这意味着 $\\text{FDR} \\le q$。\n\n**(iv) 给定数据的拒绝数量**\n我们将 BH 程序应用于给定数据。\n-   $m = 12$\n-   $q = 0.10$\n-   有序的 $p$-值为 $p_{(1)} = 0.001, p_{(2)} = 0.009, \\dots$。\n-   我们需要找到满足 $p_{(k)} \\le \\frac{k}{12} \\times 0.10 = \\frac{k}{120}$ 的最大 $k$。\n\n我们来检查 $k$ 值递增时的情况：\n-   对于 $k=1$：$p_{(1)} = 0.001$。阈值为 $\\frac{1}{120} \\approx 0.00833$。因为 $0.001 \\le 0.00833$，条件满足。\n-   对于 $k=2$：$p_{(2)} = 0.009$。阈值为 $\\frac{2}{120} \\approx 0.01667$。因为 $0.009 \\le 0.01667$，条件满足。\n-   对于 $k=3$：$p_{(3)} = 0.020$。阈值为 $\\frac{3}{120} = 0.025$。因为 $0.020 \\le 0.025$，条件满足。\n-   对于 $k=4$：$p_{(4)} = 0.031$。阈值为 $\\frac{4}{120} \\approx 0.03333$。因为 $0.031 \\le 0.03333$，条件满足。\n-   对于 $k=5$：$p_{(5)} = 0.045$。阈值为 $\\frac{5}{120} \\approx 0.04167$。因为 $0.045 > 0.04167$，条件不满足。\n-   对于任何 $k > 5$，条件也不会满足，因为 $p$-值是非递减的。\n\n满足条件 $p_{(k)} \\le \\frac{k}{m} q$ 的最大索引是 $k=4$。因此，BH 程序拒绝与 4 个最小 $p$-值相对应的 4 个原假设。被拒绝的假设数量为 4。\n\n### 选项评估\n\n**选项 A**：FDR 是 $P(V > 0)$。BH 程序按降序对 $p$-值进行排序，并拒绝所有满足 $p_{(i)} \\ge \\frac{i}{m} q$ 的 $p_{(i)}$。它在任何依赖结构下都将 FDR 控制在最多 $q$。对于该预实验板，它拒绝了 $5$ 个基因。\n-   (i) 定义 “FDR 是 $P(V > 0)$” 是家族谬误率 (FWER) 的定义，而非 FDR。\n-   (ii) 程序描述不正确。BH 按升序排序，且不等式为 $\\le$，而非 $\\ge$。\n-   (iii) 声称 BH “在任何依赖结构下”都控制 FDR 是错误的。标准的 BH 程序要求独立性或 PRDS。\n-   (iv) 拒绝数量被陈述为 $5$，这与我们计算出的 $4$ 相矛盾。\n**结论**：错误。\n\n**选项 B**：FDR 是 $\\mathbb{E}\\!\\left[\\dfrac{V}{R \\vee 1}\\right]$，其中 $R \\vee 1$ 表示 $\\max(R, 1)$。BH 升阶程序按升序对 $p$-值进行排序，找到满足 $p_{(k)} \\le \\dfrac{k}{m} q$ 的最大索引 $k$，并拒绝所有索引 $i \\le k$ 的假设。在独立性或子集正回归依赖性 (PRDS) 的条件下，BH 将 FDR 控制在 $\\mathbb{E}\\!\\left[\\dfrac{V}{R \\vee 1}\\right] \\le \\dfrac{m_{0}}{m} q$，其中 $m_{0}$ 是为真的原假设的数量；特别地，如果所有假设都为原假设，则 $\\mathbb{E}\\!\\left[\\dfrac{V}{R \\vee 1}\\right] \\le q$。对于 $q = 0.10$ 的预实验板，它拒绝了 $4$ 个基因。\n-   (i) 定义 $\\mathbb{E}\\!\\left[\\dfrac{V}{R \\vee 1}\\right]$ 是 FDR 的正确正式定义。\n-   (ii) 对 BH 程序的描述完全准确。\n-   (iii) 条件（独立性或 PRDS）和所得的界限（$\\le \\frac{m_0}{m} q$）陈述得正确且精确。\n-   (iv) 拒绝数量被陈述为 $4$，与我们的计算相符。\n**结论**：正确。\n\n**选项 C**：FDR 是 $\\mathbb{E}\\!\\left[\\dfrac{V}{m}\\right]$。BH 方法是 Holm 程序的一个降阶变体，它在依次检查 $p_{(i)} \\le \\dfrac{q}{m - i + 1}$ 的同时拒绝最小的 $p$-值。它在水平 $q$ 上控制家族谬误率 (Family-Wise Error Rate, FWER)。对于该预实验板，它拒绝了 $6$ 个基因。\n-   (i) 定义 $\\mathbb{E}\\!\\left[\\dfrac{V}{m}\\right]$ 是每次比较错误率 (Per-Comparison Error Rate, PCER)，而非 FDR。\n-   (ii) 描述的是 Holm-Bonferroni 方法（一种降阶程序），而非 BH 方法（一种升阶程序）。阈值 $\\frac{q}{m - i + 1}$ 属于 Holm 方法。\n-   (iii) 断言该程序控制 FWER 对 Holm 方法是正确的，但对控制 FDR 的 BH 方法是错误的。\n-   (iv) 拒绝数量被陈述为 $6$，这与我们为 BH 程序计算出的 $4$ 相矛盾。\n**结论**：错误。\n\n**选项 D**：FDR 是 $\\mathbb{E}\\!\\left[\\dfrac{R}{m}\\right]$。BH 程序简化为 Bonferroni 校正，拒绝所有 $p_{i} \\le \\dfrac{q}{m}$；它仅在 $m_{0}$ 未知时确保 FDR 最多为 $q$。对于该预实验板，它拒绝了 $1$ 个基因。\n-   (i) 定义 $\\mathbb{E}\\!\\left[\\dfrac{R}{m}\\right]$ 是预期的拒绝比例，与统计功效有关，而非 FDR。\n-   (ii) BH 程序不会简化为 Bonferroni 校正。Bonferroni 校正使用单一阈值 $\\frac{q}{m}$ 来控制 FWER，而 BH 使用自适应阈值 $\\frac{k}{m} q$。\n-   (iii) 关于 $m_0$ 的陈述是无稽之谈。BH 程序的有效性不取决于 $m_0$ 是否已知。\n-   (iv) 拒绝数量被陈述为 $1$。Bonferroni 校正确实会拒绝 $1$ 个基因（$p_{(1)}=0.001 \\le 0.10/12 \\approx 0.00833$，但 $p_{(2)}=0.009 > 0.00833$）。然而，问题问的是 BH 程序，其拒绝数量为 $4$。\n**结论**：错误。\n\n最终结论是，选项 B 是唯一正确陈述所有四个组成部分的选项。", "answer": "$$\\boxed{B}$$", "id": "4344579"}]}