{"hands_on_practices": [{"introduction": "有效的网络可视化依赖于将数据属性精确地映射到可感知的视觉变量上。节点大小是编码蛋白质活性或基因表达水平等定量数据的常用通道。然而，关键的挑战在于确保大小的差异不仅在数学上存在，而且能被人类视觉系统清晰地分辨。本练习将引导您应用心理物理学的基本原理——韦伯定律，来量化确保节点大小可区分性所需的最小尺寸比率，从而为您的数据编码决策提供科学依据。[@problem_id:4368328]", "problem": "在一个系统生物医学可视化中，显示了一个加权的蛋白质-蛋白质相互作用（PPI）网络，其中节点面积编码了一个定量属性，例如推断的蛋白质活性。考虑一个基准显示面积为 $s$（单位为平方像素）的特定节点。为了使第二个节点在尺寸上能够被感知地与基准节点区分开，其视觉编码必须在当前的显示和观看条件下超过观看者对面积的恰可察觉差（JND）阈值。\n\n使用心理物理学中的基本原理，即韦伯定律：刺激的最小可察觉变化与基准刺激强度成正比。假设在这些条件下，用于面积判断的比例常数（韦伯分数）是一个已知的正常数 $k$。设修改后的节点面积为 $s'$，并将尺寸比 $r$ 定义为 $r = s'/s$。\n\n从韦伯定律和上述定义出发，推导在节点尺寸上产生恰可察觉差所需的最小尺寸比 $r$。将你的最终答案表示为关于 $k$ 的闭式解析表达式。无需进行数值评估，也不应进行四舍五入。你的推导应清楚说明根据韦伯定律，该结果是否依赖于基准面积 $s$。", "solution": "问题要求基于心理物理学的韦伯定律，推导在节点面积上产生可感知差异所需的最小尺寸比 $r$。对问题陈述的验证证实了其科学性、适定性和客观性。所有提供的信息都是一致的，并且足以得到唯一解。\n\n首先，我们将问题中描述的韦伯定律形式化。该定律指出，刺激的最小可察觉变化，即恰可察觉差（JND），与基准刺激的强度成正比。设基准刺激为 $S$，JND为 $\\Delta S_{jnd}$。韦伯定律可表示为：\n$$\n\\Delta S_{jnd} \\propto S\n$$\n引入给定的比例常数，即韦伯分数 $k$，我们得到方程：\n$$\n\\Delta S_{jnd} = k S\n$$\n\n在本问题的背景下，刺激是节点的视觉面积，以平方像素为单位。基准刺激是参考节点的面积，给定为 $s$。因此，我们可以在公式中用 $s$ 替代 $S$：\n$$\n\\Delta s_{jnd} = k s\n$$\n这里，$\\Delta s_{jnd}$ 代表面积的恰可察觉差。\n\n问题描述了第二个节点，其修改后的面积 $s'$ 恰好能与面积为 $s$ 的基准节点在感知上区分开。要实现这一点，面积的变化量 $\\Delta s$ 必须等于恰可察觉差 $\\Delta s_{jnd}$。假设修改后的面积 $s'$ 大于基准面积 $s$ 才能被感知为更大，则面积的变化量为：\n$$\n\\Delta s = s' - s\n$$\n为了找到恰好有显著差异的最小修改面积 $s'$，我们将此变化量设为等于 JND：\n$$\ns' - s = \\Delta s_{jnd}\n$$\n代入我们从韦伯定律得到的 $\\Delta s_{jnd}$ 表达式，我们有：\n$$\ns' - s = k s\n$$\n\n我们的目标是求出最小尺寸比 $r$，其定义为 $r = s'/s$。为此，我们首先对上述方程求解 $s'$：\n$$\ns' = s + k s\n$$\n从右侧提取出基准面积 $s$ 可得：\n$$\ns' = s(1 + k)\n$$\n现在，我们可以通过将方程两边同时除以 $s$ 来计算比率 $r$：\n$$\n\\frac{s'}{s} = 1 + k\n$$\n根据定义，$r = s'/s$，因此我们得到最小尺寸比的最终表达式：\n$$\nr = 1 + k\n$$\n该结果是按要求得出的关于韦伯分数 $k$ 的闭式解析表达式。\n\n问题还要求解释为什么结果依赖或不依赖于基准面积 $s$。如推导所示，基准面积 $s$ 同时出现在面积变化量（$s' - s$）和 JND（$k s$）的表达式中。当我们构建比率 $r = s'/s$ 时，项 $s$ 从分子和分母中消去：\n$$\nr = \\frac{s(1 + k)}{s} = 1 + k\n$$\n这种消去表明，产生恰可察觉差的最小尺寸比 $r$ 与基准面积 $s$ 无关。这是韦伯定律的一个基本推论。该定律假定一个*比例*变化，意味着 JND 是基准刺激的一个恒定*分数*。因此，为实现这一分数变化所需的新刺激强度（$s'$）与基准刺激强度（$s$）之比本身也是一个常数，仅依赖于韦伯分数 $k$，而不依赖于基准刺激的绝对强度 $s$。", "answer": "$$\\boxed{1 + k}$$", "id": "4368328"}, {"introduction": "在系统生物医学中，原始数据网络（如配体-受体相互作用网络）通常需要经过转换才能揭示高阶模式。一种常见的分析方法是将二分网络投影到单模网络（例如，配体-配体网络）以研究协同靶向模式。然而，这种降维操作并非没有代价，它可能引入误导性的可视化伪影。本练习将深入探讨二分网络投影的陷阱，特别是“枢纽”节点如何导致虚假的密集连接，并评估归一化等策略在增强可视化解释性方面的作用。[@problem_id:4368322]", "problem": "一个系统生物医学团队使用二分网络对配体-受体特异性进行建模。该二分图有一个配体集 $U=\\{L_1,L_2,L_3\\}$ 和一个受体集 $V=\\{R_1,R_2,R_3,R_4\\}$。从 $L_i$ 到 $R_j$ 的边带有一个非负权重 $W_{ij}$，该权重代表证据的强度（例如，丰度加权的亲和力）。唯一的非零项是：\n- $W_{L_1,R_1}=10$， $W_{L_1,R_2}=1$\n- $W_{L_2,R_1}=9$， $W_{L_2,R_3}=1$\n- $W_{L_3,R_1}=8$， $W_{L_3,R_4}=1$\n\n所有其他的 $W_{ij}$ 均为 $0$。该团队考虑对配体进行单模投影以可视化共靶向模式，并考虑使用归一化相似性来减轻可视化伪影。仅使用图论和线性代数的核心定义（如邻接、度、路径计数和矩阵乘法），分析将二分网络投影为单模网络如何产生边权重，以及这在配体-受体分析的背景下如何影响可解释性。然后判断以下哪些陈述是合理的。\n\nA. 在给定矩阵 $W$ 的加权情况下，未归一化的配体-配体投影等于 $P=W W^\\top$，并且对于这个 $W$，严格排序 $P_{12}  P_{13}  P_{23}$ 成立。\n\nB. 对于一个二元二分网络，配体-配体投影中无向边的数量恰好是 $\\sum_{r \\in V} \\binom{d_r}{2}$，其中 $d_r$ 是受体 $r$ 的度；因此，投影不会将表观的边数夸大到超过这个组合和，并且绝不会产生重复的边。\n\nC. 投影权重的余弦归一化，定义为 $S_{ij} = \\dfrac{P_{ij}}{\\sqrt{P_{ii} P_{jj}}}$，可以减轻由枢纽节点引起的主导作用；在给定的 $W$ 中，这种归一化得出 $S_{12} \\approx S_{13} \\approx S_{23}$，这反映了共靶向几乎完全是通过 $R_1$ 实现的。\n\nD. 通过对所有配体-受体对求和，将配体-受体二分网络投影到细胞类型-细胞类型通讯网络上不会损害可解释性，因为方向性（从发送者到接收者）在投影中得以保留。\n\nE. 当受体度较低且配体间的邻域相对不相交时（这会产生与模块一致的小型团），投影有助于提高可解释性；但当一个受体是高度或高权重的枢纽节点时，投影倾向于通过产生密集的团来模糊特异性；在这种情况下，二分图布局或度归一化的边加权对于可视化更为可取。\n\n选择所有正确选项。", "solution": "问题陈述在系统生物学领域，特别是关于网络分析方面，提出了一个有效且定义明确的问题。它具有科学依据、客观，并提供了评估附带陈述所需的所有信息。我将进行完整的推导和分析。\n\n问题描述了一个具有两个不相交节点集的二分网络：一个配体集 $U=\\{L_1, L_2, L_3\\}$ 和一个受体集 $V=\\{R_1, R_2, R_3, R_4\\}$。相互作用由一个权重矩阵 $W$ 给出，该矩阵可以表示为一个 $3 \\times 4$ 的矩阵，其中行对应配体，列对应受体。根据提供的非零权重，矩阵 $W$ 为：\n$$\nW = \\begin{pmatrix}\n10  1  0  0 \\\\\n9  0  1  0 \\\\\n8  0  0  1\n\\end{pmatrix}\n$$\n问题要求分析到配体集 $U$ 的单模投影。\n\n### 选项 A 的评估\n\n这个陈述提出了两个论点：一是未归一化的配体-配体投影矩阵 $P$ 由 $P = W W^\\top$ 给出，二是对于给定的权重，严格排序 $P_{12}  P_{13}  P_{23}$ 成立。\n\n首先，我们来验证投影的公式。二分图到其一个划分（这里是配体 $U$）的单模投影，会在两个节点 $L_i$ 和 $L_j$ 之间创建一条边，如果它们在另一个划分（受体 $V$）中共享一个共同的邻居。在加权投影中，投影边 $P_{ij}$ 的权重是所有共同邻居贡献的总和。权重 $P_{ij}$ 的一个标准定义是 $\\sum_{k \\in V} W_{ik}W_{jk}$。这正是矩阵乘积 $W W^\\top$ 的第 $(i,j)$ 个元素的定义。维度是一致的：$W$ 是 $3 \\times 4$ 矩阵，其转置 $W^\\top$ 是 $4 \\times 3$ 矩阵。它们的乘积 $P = W W^\\top$ 是一个 $3 \\times 3$ 的矩阵，代表配体-配体网络。对角线元素 $P_{ii} = \\sum_{k \\in V} W_{ik}^2$ 代表配体 $L_i$ 的加权度。第一个论点是正确的。\n\n其次，我们计算 $P$ 的非对角线元素来检查排序。\n$W$ 的转置是：\n$$\nW^\\top = \\begin{pmatrix}\n10  9  8 \\\\\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n现在我们计算乘积 $P = W W^\\top$：\n$P_{12} = (10)(9) + (1)(0) + (0)(1) + (0)(0) = 90$\n$P_{13} = (10)(8) + (1)(0) + (0)(0) + (0)(1) = 80$\n$P_{23} = (9)(8) + (0)(0) + (1)(0) + (0)(1) = 72$\n\n比较这些值，我们得到 $90  80  72$，这确认了严格排序 $P_{12}  P_{13}  P_{23}$。\n\n陈述中的两个论点都是正确的。\n**结论：正确。**\n\n### 选项 B 的评估\n\n这个陈述声称，对于一个二元（非加权）二分网络，配体-配体投影中无向边的数量恰好是 $\\sum_{r \\in V} \\binom{d_r}{2}$，其中 $d_r$ 是受体 $r$ 的度。\n\n我们来分析这个公式。对于一个给定的度为 $d_r$ 的受体 $r \\in V$，它连接着 $d_r$ 个不同的配体。在投影中，这 $d_r$ 个配体中的每一对都将被连接，因为它们共享 $r$ 作为共同邻居。这样的配对数量是 $\\binom{d_r}{2}$。公式 $\\sum_{r \\in V} \\binom{d_r}{2}$ 是对所有受体将这个数量求和。\n\n这个和计算的是形式为 $L_i - r - L_j$（其中 $i \\neq j$）的长度为2的路径数量。然而，投影图中的边数对应于至少有一个共同邻居的唯一配体对 $(L_i, L_j)$ 的数量。如果一对配体 $(L_i, L_j)$ 共享多个共同受体，比如说 $r_1$ 和 $r_2$，那么边 $(L_i, L_j)$ 会被该公式多次计数（一次为 $r_1$，一次为 $r_2$），但它在生成的简单图中只代表一条边。\n\n考虑一个简单的反例：\n设 $U=\\{L_1, L_2\\}$ 和 $V=\\{R_1, R_2\\}$。边为 $(L_1, R_1)$, $(L_2, R_1)$, $(L_1, R_2)$ 和 $(L_2, R_2)$。这是一个二元网络。受体的度为 $d_{R_1} = 2$ 和 $d_{R_2} = 2$。该公式得出 $\\sum_{r \\in V} \\binom{d_r}{2} = \\binom{2}{2} + \\binom{2}{2} = 1 + 1 = 2$。然而，到 $U$ 的投影只包含一条边：$L_1$ 和 $L_2$ 之间的边，因为它们共享共同的邻居（$R_1$ 和 $R_2$）。边的数量是 1。由于 $2 \\neq 1$，该公式是不正确的。它代表的是投影矩阵非对角线项的总和，而不是简单图中边的数量。最后的子句“...并且绝不会产生重复的边”具有误导性；简单图根据定义没有重复的边，但正是所提出的计数方法导致了错误。\n\n**结论：不正确。**\n\n### 选项 C 的评估\n\n这个陈述是关于余弦归一化，定义为 $S_{ij} = \\frac{P_{ij}}{\\sqrt{P_{ii} P_{jj}}}$，及其效果。\n\n首先，是原理。未归一化的投影权重 $P_{ij}$ 受到节点 $i$ 和 $j$ “活跃度”的影响。如果 $L_i$ 和 $L_j$ 连接到一个高权重的枢纽受体，$P_{ij}$ 可能会很大，即使共享的连接是非特异性的。对角线项 $P_{ii} = \\sum_k W_{ik}^2$ 和 $P_{jj} = \\sum_k W_{jk}^2$ 是配体 $i$ 和 $j$ 权重向量的平方范数。$S_{ij}$ 的公式是对应于配体 $L_i$ 和 $L_j$ 的 $W$ 的行向量之间的余弦相似度的定义。余弦相似度衡量连接*模式*的相似性，而与其大小无关，从而减轻了枢纽节点的影响。陈述的第一部分是对网络分析中一种标准归一化技术的正确描述。\n\n其次，我们对给定的 $W$ 进行计算。我们首先需要 $P$ 的对角线元素：\n$P_{11} = (10)^2 + (1)^2 + (0)^2 + (0)^2 = 101$\n$P_{22} = (9)^2 + (0)^2 + (1)^2 + (0)^2 = 82$\n$P_{33} = (8)^2 + (0)^2 + (0)^2 + (1)^2 = 65$\n使用选项 A 中的非对角线值：$P_{12}=90, P_{13}=80, P_{23}=72$。\n\n现在，我们计算余弦相似度：\n$S_{12} = \\frac{90}{\\sqrt{101 \\times 82}} = \\frac{90}{\\sqrt{8282}} \\approx \\frac{90}{91.005} \\approx 0.9889$\n$S_{13} = \\frac{80}{\\sqrt{101 \\times 65}} = \\frac{80}{\\sqrt{6565}} \\approx \\frac{80}{81.025} \\approx 0.9873$\n$S_{23} = \\frac{72}{\\sqrt{82 \\times 65}} = \\frac{72}{\\sqrt{5330}} \\approx \\frac{72}{73.007} \\approx 0.9862$\n\n这些值（$0.9889, 0.9873, 0.9862$）确实彼此非常接近，并且都接近于 $1$。这证实了 $S_{12} \\approx S_{13} \\approx S_{23}$。这个结果正确地反映了所有三个配体的连接概况都由它们与枢纽受体 $R_1$ 的强连接所主导，使得它们相应的权重向量几乎平行。\n\n**结论：正确。**\n\n### 选项 D 的评估\n\n这个陈述声称将特定的配体-受体相互作用聚合成一个总结性的细胞类型-细胞类型通讯分数“不会损害可解释性”。\n\n这是一个错误的论点。聚合是一个总结数据的过程，这内在地涉及细节的丢失。虽然粗粒度的方向性（从发送细胞群到接收细胞群）确实被保留了，但关于*哪些分子媒介*介导通讯的细粒度信息却丢失了。\n\n例如，如果细胞类型 A 和细胞类型 B 之间的聚合分数很高，聚合网络并不会告诉我们这是由于相互作用 $L_1 \\to R_1$ 还是 $L_5 \\to R_8$。这种细节的丢失对可解释性是一个重大的损害，特别是当目标是设计一种治疗性干预来阻断或增强一个特定的信号通路时。“不会损害”这一绝对的断言是错误的。虽然聚合对于获得高层次的概览可能很有用，但它是以牺牲分子特异性为代价的。\n\n**结论：不正确。**\n\n### 选项 E 的评估\n\n这个陈述为网络投影在此背景下的效用和陷阱提供了一个定性指南。\n\n第一部分：“当受体度较低且配体间的邻域相对不相交时，投影有助于提高可解释性...”。如果一个受体 $R_k$ 连接到一个小而独特的配体集合，它将在投影的配体网络中创建一个小而密集的团。如果不同的受体连接到不相交的配体集合，投影将由分离的或松散连接的团组成。这种模块化结构易于可视化和解释，每个团对应一组共同靶向特定受体的配体。这是一个合理的原则。\n\n第二部分：“...但当一个受体是高度或高权重的枢纽节点时，投影倾向于通过产生密集的团来模糊特异性；在这种情况下，二分图布局或度归一化的边加权对于可视化更为可取。” 这描述了枢纽引起的伪影问题。一个连接到许多配体的枢纽受体将在投影中创建一个大的、密集的团（一个“毛球”），使得所有连接的配体看起来都很相似，并模糊了它们更具体的相互作用。我们使用枢纽 $R_1$ 的例子完美地说明了这一点。该陈述正确地提出了两种标准解决方案：\n1. 可视化原始的二分图：这可以避免信息丢失，并清晰地揭示枢纽结构。\n2. 使用归一化的边权重：如选项 C 中所示，像余弦相似度这样的技术可以纠正枢纽的主导作用，并揭示更微妙的特异性模式。\n\n这个陈述对网络投影的权衡提供了一个正确且精细入微的总结，与网络可视化和分析的既定原则相一致。\n\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "4368322"}, {"introduction": "高通量实验产生的数据往往会生成极其密集的网络图，即所谓的“毛球”，这使得从中提取有意义的生物学见解变得十分困难。为了构建清晰且可信的可视化，一个关键步骤是仅突出显示那些具有统计学意义的连接。本练习将向您介绍在多重假设检验中控制伪发现率（FDR）的强大方法，并指导您应用Benjamini-Hochberg程序来计算一个数据自适应的$p$值阈值，以确保您的网络可视化能够稳健地平衡发现与错误。[@problem_id:4368371]", "problem": "一个系统生物医学实验室正在整理一个根据多组学扰动数据推断出来的机制性基因调控网络。为了使网络清晰可读，并只强调具有可重现证据的边，该团队将突出那些统计证据在旨在控制虚假高亮部分预期比例的多重检验校正后仍然显著的边。他们将零假设下每条边的检验统计量建模为生成一个在 $[0,1]$ 上均匀分布的 $p$-值，并假设各条边的 $p$-值相互独立。整理策略是控制错误发现率（FDR），其定义为高亮显示的边中假阳性（false positives）所占的期望比例。\n\n仅从以下核心事实出发：在零假设下，$p$-值在 $[0,1]$ 上均匀分布；错误发现率是被错误判为发现的数量与总发现数量之比的期望值；以及一个“步升”（step-up）规则可以对排序后的 $p$-值选择一个数据自适应的截断值。请推导一个有原则的程序，该程序能确定一个作用于排序后的边级别 $p$-值的阈值，以便在独立性假设下将错误发现率控制在目标水平 $q$。解释为什么由此产生的规则在这种情况下对可视化是有效的。\n\n给定 $m = 24$ 条候选边及其对应的边级别 $p$-值（未排序）：\n$\\{0.074,\\ 0.003,\\ 0.12,\\ 0.028,\\ 0.061,\\ 0.046,\\ 0.001,\\ 0.069,\\ 0.091,\\ 0.44,\\ 0.096,\\ 0.017,\\ 0.78,\\ 0.034,\\ 0.052,\\ 0.006,\\ 0.039,\\ 0.23,\\ 0.011,\\ 0.084,\\ 0.57,\\ 0.022,\\ 0.081,\\ 0.94\\}$。\n\n设目标错误发现率为 $q = 0.10$。使用你推导出的程序，计算用于强调边的数据自适应 $p$-值阈值 $t^{\\ast}$（即，所有满足 $p \\leq t^{\\ast}$ 的边都将被着重渲染）。仅报告阈值 $t^{\\ast}$，作为一个无单位的纯数字。不要四舍五入；给出数据所隐含的精确小数值。", "solution": "所述问题具有科学依据，提法恰当，客观且内部一致。它描述了一个典型的统计问题——多重假设检验中的错误发现率控制——及其在系统生物医学这一现实场景中的应用。所有必要的数据和定义都已提供。因此，我将进行完整的推导和求解。\n\n任务是推导一个用于控制错误发现率（FDR）的有原则的程序，并将其应用于给定的数据集。该程序必须确定一个用于网络可视化的、作用于边级别 $p$-值的数据自适应阈值。\n\n假设有 $m$ 个零假设 $H_1, \\dots, H_m$，对应于网络中 $m$ 条潜在的边。设它们各自的 $p$-值为 $P_1, \\dots, P_m$。我们已知，在一个为真的零假设下，其对应的 $p$-值在 $[0,1]$ 上均匀分布，并且所有的 $p$-值都是独立的。设 $m_0$ 是为真的零假设的未知数量。\n\n设 $R$ 为被拒绝的假设数量（即被高亮显示的边的数量），$V$ 为被错误拒绝的为真零假设的数量（错误发现）。错误发现比例（FDP）是比率 $V/R$，当 $R=0$ 时定义为 $0$。错误发现率（FDR）是该量的期望值，$FDR = E[FDP]$。我们寻求一个程序，对于选定的水平 $q$，能保证 $FDR \\le q$。\n\nBenjamini-Hochberg（BH）程序是一种实现这种控制的“步升”（step-up）程序。该程序如下：\n1. 将 $m$ 个 $p$-值从小到大排序：$P_{(1)} \\le P_{(2)} \\le \\dots \\le P_{(m)}$。设 $H_{(i)}$ 是与 $P_{(i)}$ 对应的零假设。\n2. 找到最大的索引 $k$（我们将其表示为 $k_{max}$），使其对应的排序后的 $p$-值满足以下条件：\n    $$P_{(k)} \\le \\frac{k}{m}q$$\n3. 如果存在这样的 $k_{max}$，则拒绝所有 $i = 1, \\dots, k_{max}$ 的零假设 $H_{(i)}$。被拒绝的假设数量为 $R = k_{max}$。\n4. 如果不存在这样的索引 $k$，则不拒绝任何假设（$R=0$）。\n\n用于判断显著性的数据自适应阈值 $t^{\\ast}$ 是被拒绝集合中最大的 $p$-值，即 $t^{\\ast} = P_{(k_{max})}$。所有 $p$-值 $P_j \\le t^{\\ast}$ 的边都会被高亮显示。\n\n现在我们来推导为什么该程序在独立性假设下能将FDR控制在期望的水平 $q$。\n设 $I_0$ 为对应于 $m_0$ 个为真零假设的索引集合。错误发现的数量为 $V = \\sum_{j \\in I_0} \\mathbb{1}(P_j \\text{ 被拒绝})$。根据 BH 规则，一个假设被拒绝的条件是其 $p$-值小于或等于阈值 $t^{\\ast} = P_{(k_{max})}$。因此，$V = \\sum_{j \\in I_0} \\mathbb{1}(P_j \\le t^{\\ast})$。总发现数量为 $R = k_{max}$。\n\n$k_{max}$的定义意味着阈值 $t^{\\ast}$ 满足 $t^{\\ast} = P_{(k_{max})} \\le \\frac{k_{max}}{m}q = \\frac{R}{m}q$。这个不等式在 $R  0$ 时成立，是证明的核心。它可以被重新整理为 $R \\ge \\frac{m t^{\\ast}}{q}$。\n\nFDR 的定义为 $FDR = E\\left[\\frac{V}{R}\\right]$。为了避免除以零，FDP 通常定义为 $V/\\max(R,1)$，但对于此推导，我们可以考虑在 $R0$ 条件下的期望。\n$$FDR = E\\left[\\frac{V}{R} \\mathbb{1}(R0)\\right]$$\n使用不等式 $R \\ge \\frac{m t^{\\ast}}{q}$，我们有 $\\frac{1}{R} \\le \\frac{q}{m t^{\\ast}}$。将此代入 FDR 表达式中得到：\n$$FDR \\le E\\left[V \\cdot \\frac{q}{m t^{\\ast}} \\mathbb{1}(R0)\\right] = \\frac{q}{m} E\\left[\\frac{V}{t^{\\ast}} \\mathbb{1}(R0)\\right]$$\n随机变量 $V$ 是 $m_0$ 个为真零假设的指示函数之和：$V = \\sum_{j \\in I_0} \\mathbb{1}(P_j \\le t^{\\ast})$。根据期望的线性性质：\n$$E\\left[\\frac{V}{t^{\\ast}} \\mathbb{1}(R0)\\right] = \\sum_{j \\in I_0} E\\left[\\frac{\\mathbb{1}(P_j \\le t^{\\ast})}{t^{\\ast}} \\mathbb{1}(R0)\\right]$$\n阈值 $t^{\\ast}$ 是所有 $p$-值的函数。BH 程序的一个关键性质是，$t^{\\ast}$ 是任何单个 $p$-值的非增函数。我们来分析和中针对某个特定为真零假设 $j \\in I_0$ 的一项。可以通过对其他 $p$-值 $P_{-j}$ 取条件来评估期望。内部期望是关于 $P_j$ 分布（在 $[0,1]$ 上均匀分布）的积分。\n$$E_{P_j}\\left[\\frac{\\mathbb{1}(P_j \\le t^{\\ast}(P_j, P_{-j}))}{t^{\\ast}(P_j, P_{-j})}\\right] = \\int_0^1 \\frac{\\mathbb{1}(p_j \\le t^{\\ast}(p_j, P_{-j}))}{t^{\\ast}(p_j, P_{-j})} dp_j$$\n因为 $t^{\\ast}$ 在 $p_j$ 上是非增的，所以 $p_j \\le t^{\\ast}(p_j, P_{-j})$ 的区域构成一个区间 $[0, c]$，其中 $c$ 是满足该不等式的 $p_j$ 的上确界。在此边界上，$c = t^{\\ast}(c, P_{-j})$。对于任何 $p_j \\in [0,c]$，$t^{\\ast}(p_j, P_{-j}) \\ge t^{\\ast}(c, P_{-j}) = c$。因此，该积分有界：\n$$\\int_0^c \\frac{1}{t^{\\ast}(p_j, P_{-j})} dp_j \\le \\int_0^c \\frac{1}{c} dp_j = \\frac{c}{c} = 1$$\n因此，对于 $m_0$ 个为真零假设中的每一个，和中的对应项都小于或等于 $1$。这得出：\n$$E\\left[\\frac{V}{t^{\\ast}} \\mathbb{1}(R0)\\right] \\le \\sum_{j \\in I_0} 1 = m_0$$\n将此结果代回 FDR 的主要不等式中，我们得到：\n$$FDR \\le \\frac{q}{m} m_0 = q \\frac{m_0}{m}$$\n由于为真零假设的数量 $m_0$ 不能超过总检验数 $m$，我们有 $\\frac{m_0}{m} \\le 1$，这证实了 Benjamini-Hochberg 程序将错误发现率控制在期望的水平 $q$ 以下：$FDR \\le q$。\n\n该程序特别适用于系统生物医学等探索性背景下的网络可视化。控制族失误率（FWER），即出现至少一个假阳性的概率，通常过于严格，会导致统计功效较低，从而错失许多真实的生物学相互作用。FDR 提供了一个稳健且可解释的替代方案：控制高亮显示的边中虚假边的期望*比例*。选择 $q=0.10$ 表示愿意接受平均而言，高亮显示的发现中至多有 $10\\%$ 可能是错误的。这在发现的需求与有原则的错误控制之间取得了平衡，使其成为一个优秀的工具，用于生成一个高置信度且足够丰富的网络，以供视觉分析和进一步的实验验证。\n\n现在，我们将此程序应用于给定的数据。\n我们有 $m = 24$ 条候选边和目标 FDR 为 $q = 0.10$。\n$p$-值的集合为 $\\{0.074, 0.003, 0.12, 0.028, 0.061, 0.046, 0.001, 0.069, 0.091, 0.44, 0.096, 0.017, 0.78, 0.034, 0.052, 0.006, 0.039, 0.23, 0.011, 0.084, 0.57, 0.022, 0.081, 0.94\\}$。\n\n首先，我们将 $p$-值按升序排列：\n$P_{(1)} = 0.001$\n$P_{(2)} = 0.003$\n$P_{(3)} = 0.006$\n$P_{(4)} = 0.011$\n$P_{(5)} = 0.017$\n$P_{(6)} = 0.022$\n$P_{(7)} = 0.028$\n$P_{(8)} = 0.034$\n……（以此类推）\n\n接下来，我们找到满足 $P_{(k)} \\le \\frac{k}{m}q$ 的最大索引 $k$。这里，$m=24$，$q=0.10$，所以条件是 $P_{(k)} \\le \\frac{k \\cdot 0.10}{24} = \\frac{k}{240}$。\n我们对每个索引 $k$ 检验此条件：\n- 对于 $k=1$：$P_{(1)} = 0.001$。条件：$0.001 \\le \\frac{1}{240} \\approx 0.00417$。成立。\n- 对于 $k=2$：$P_{(2)} = 0.003$。条件：$0.003 \\le \\frac{2}{240} \\approx 0.00833$。成立。\n- 对于 $k=3$：$P_{(3)} = 0.006$。条件：$0.006 \\le \\frac{3}{240} = 0.0125$。成立。\n- 对于 $k=4$：$P_{(4)} = 0.011$。条件：$0.011 \\le \\frac{4}{240} \\approx 0.01667$。成立。\n- 对于 $k=5$：$P_{(5)} = 0.017$。条件：$0.017 \\le \\frac{5}{240} \\approx 0.02083$。成立。\n- 对于 $k=6$：$P_{(6)} = 0.022$。条件：$0.022 \\le \\frac{6}{240} = 0.025$。成立。\n- 对于 $k=7$：$P_{(7)} = 0.028$。条件：$0.028 \\le \\frac{7}{240} \\approx 0.02917$。成立。\n- 对于 $k=8$：$P_{(8)} = 0.034$。条件：$0.034 \\le \\frac{8}{240} \\approx 0.03333$。不成立。\n\n由于不等式 $P_{(k)} \\le \\frac{k}{m}q$ 随着 $k$ 的增加变得越来越严格（直线 $\\frac{k}{m}q$ 线性增长，而排序后的 $P_{(k)}$ 非线性增长且通常更快），我们无需再检查下去。满足该条件的最大索引是 $k_{max}=7$。\n\n因此，该程序拒绝了 $p$-值最小的 7 条边所对应的零假设。显著性阈值 $t^{\\ast}$ 是此截断点处的 $p$-值，即 $t^{\\ast} = P_{(k_{max})} = P_{(7)}$。\n\n根据我们的排序列表，$P_{(7)} = 0.028$。\n因此，数据自适应的 $p$-值阈值为 $t^{\\ast} = 0.028$。所有 $p$-值小于或等于此阈值的边都将被高亮显示。", "answer": "$$\\boxed{0.028}$$", "id": "4368371"}]}