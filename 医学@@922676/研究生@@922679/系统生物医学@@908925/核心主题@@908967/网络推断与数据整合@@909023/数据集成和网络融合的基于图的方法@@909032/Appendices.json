{"hands_on_practices": [{"introduction": "最优传输 (Optimal Transport, OT) 提供了一个强大的数学框架，通过寻找从一个分布到另一个分布的最优“传输”方案来对齐不同的数据集。在系统生物医学中，这可以用来定义来自不同组学层面的细胞之间的对应关系。这项练习 [@problem_id:4350125] 提供了一个具体的、小规模的例子，演示了如何使用OT来创建图间的连接边。通过手动计算一个一维问题的最优耦合，您将直观地理解OT的工作原理及其在网络整合任务中的应用。", "problem": "在系统生物医学中，您正在沿着一个共同的潜在谱系轴整合两个小型生物图谱，这两个图谱分别代表三种转录组细胞状态和三种表观基因组细胞状态。设转录组层的节点为 $x_{1}, x_{2}, x_{3}$，其潜在位置分别为 $0$、$1$ 和 $3$；表观基因组层的节点为 $y_{1}, y_{2}, y_{3}$，其潜在位置分别为 $0.2$、$1.1$ 和 $3.2$。作为背景信息，层内邻接矩阵（对称，对角线为零）如下：\n$$\nA_{X}=\\begin{pmatrix}\n0 & 0.8 & 0.2\\\\\n0.8 & 0 & 0.7\\\\\n0.2 & 0.7 & 0\n\\end{pmatrix},\\quad\nA_{Y}=\\begin{pmatrix}\n0 & 0.75 & 0.15\\\\\n0.75 & 0 & 0.65\\\\\n0.15 & 0.65 & 0\n\\end{pmatrix}.\n$$\n您将通过添加图间边来整合这两个图，这些边的权重由 $X=\\{x_{1},x_{2},x_{3}\\}$ 和 $Y=\\{y_{1},y_{2},y_{3}\\}$ 上的离散样本分布之间的最优传输 (OT) 耦合定义。\n\n假设转录组经验分布为 $\\mu=(0.4,\\,0.4,\\,0.2)$（对应 $(x_{1},x_{2},x_{3})$），表观基因组经验分布为 $\\nu=(0.3,\\,0.5,\\,0.2)$（对应 $(y_{1},y_{2},y_{3})$）。通过潜在轴上的平方欧几里得距离来定义基本成本，即对于 $i\\in\\{1,2,3\\}$ 和 $j\\in\\{1,2,3\\}$，\n$$\nc_{ij}=\\big(\\text{position}(x_{i})-\\text{position}(y_{j})\\big)^{2}.\n$$\n考虑平衡的 Kantorovich 最优传输问题：找到一个耦合矩阵 $\\Gamma\\in\\mathbb{R}_{\\ge 0}^{3\\times 3}$，使其在满足边际约束 $\\sum_{j=1}^{3}\\Gamma_{ij}=\\mu_{i}$ 和 $\\sum_{i=1}^{3}\\Gamma_{ij}=\\nu_{j}$ 的条件下，最小化总传输成本 $\\sum_{i=1}^{3}\\sum_{j=1}^{3} c_{ij}\\,\\Gamma_{ij}$。计算出最优耦合 $\\Gamma^{\\star}$ 后，将 $x_{i}$ 和 $y_{j}$ 之间的图间边权重定义为 $w_{ij}=\\Gamma^{\\star}_{ij}$，这样融合后的超邻接矩阵是一个分块矩阵，其对角块为 $A_{X}$ 和 $A_{Y}$，非对角块为 $W=(w_{ij})$ 和 $W^{\\top}$。\n\n计算最优传输耦合，并确定连接 $x_{1}$ 和 $y_{2}$ 的导出图间边权重，即 $w_{x_{1},y_{2}}$。将您的最终答案表示为四舍五入到四位有效数字的小数。不需要单位。", "solution": "该问题要求我们解决一个离散最优传输问题，以找到一条线上两个分布之间的耦合矩阵 $\\Gamma^{\\star}$，然后从该矩阵中提取一个特定的权重。\n\n首先，我们计算成本矩阵 $C = (c_{ij})$，其中 $c_{ij}$ 是节点 $x_i$ 和节点 $y_j$ 的潜在位置之间的平方欧几里得距离。$X$ 节点的潜在位置为 $p_{X} = (0, 1, 3)$，$Y$ 节点的潜在位置为 $p_{Y} = (0.2, 1.1, 3.2)$。\n\n成本矩阵 $C$ 的条目为：\n$$c_{11} = (0 - 0.2)^2 = 0.04$$\n$$c_{12} = (0 - 1.1)^2 = 1.21$$\n$$c_{13} = (0 - 3.2)^2 = 10.24$$\n$$c_{21} = (1 - 0.2)^2 = 0.8^2 = 0.64$$\n$$c_{22} = (1 - 1.1)^2 = (-0.1)^2 = 0.01$$\n$$c_{23} = (1 - 3.2)^2 = (-2.2)^2 = 4.84$$\n$$c_{31} = (3 - 0.2)^2 = 2.8^2 = 7.84$$\n$$c_{32} = (3 - 1.1)^2 = 1.9^2 = 3.61$$\n$$c_{33} = (3 - 3.2)^2 = (-0.2)^2 = 0.04$$\n\n完整的成本矩阵是：\n$$\nC = \\begin{pmatrix}\n0.04 & 1.21 & 10.24 \\\\\n0.64 & 0.01 & 4.84 \\\\\n7.84 & 3.61 & 0.04\n\\end{pmatrix}\n$$\n\n问题是找到 $\\Gamma = (\\Gamma_{ij})$，使其在满足以下条件的情况下最小化 $\\sum_{i,j} c_{ij} \\Gamma_{ij}$：\n1.  行和约束：$\\sum_{j=1}^3 \\Gamma_{1j} = 0.4$，$\\sum_{j=1}^3 \\Gamma_{2j} = 0.4$，$\\sum_{j=1}^3 \\Gamma_{3j} = 0.2$。\n2.  列和约束：$\\sum_{i=1}^3 \\Gamma_{i1} = 0.3$，$\\sum_{i=1}^3 \\Gamma_{i2} = 0.5$，$\\sum_{i=1}^3 \\Gamma_{i3} = 0.2$。\n3.  非负性：对于所有 $i,j$，$\\Gamma_{ij} \\ge 0$。\n\n这是一个一维最优传输的实例，因为所有点都位于单个潜在轴上。每个集合内的位置都是有序的：$p_{X_1} < p_{X_2} < p_{X_3}$ 和 $p_{Y_1} < p_{Y_2} < p_{Y_3}$。对于具有凸成本函数（如平方距离）的一维最优传输，最优传输方案是单调的，这意味着它不会“交叉”质量。这允许使用一个简单的贪心算法来找到最优耦合 $\\Gamma^{\\star}$。\n\n设源点的可用质量为 $\\mu = (0.4, 0.4, 0.2)$，目标点的需求质量为 $\\nu = (0.3, 0.5, 0.2)$。我们从耦合矩阵的左上角 $\\Gamma_{11}$ 开始，迭代地分配质量。\n\n**步骤 1：** 考虑单元格 $(1,1)$。源点 $x_1$ 的供应量为 $\\mu_1=0.4$，目标点 $y_1$ 的需求量为 $\\nu_1=0.3$。我们移动尽可能多的质量：$\\delta_1 = \\min(0.4, 0.3) = 0.3$。\n因此，$\\Gamma_{11} = 0.3$。\n现在 $y_1$ 的需求已满足。$x_1$ 的剩余供应量为 $0.4 - 0.3 = 0.1$。\n更新后的供应量：$\\mu' = (0.1, 0.4, 0.2)$。\n更新后的需求量：$\\nu' = (0, 0.5, 0.2)$。\n由于第 1 列已满足，我们移动到下一列 $j=2$。\n\n**步骤 2：** 考虑单元格 $(1,2)$。$x_1$ 的当前供应量为 $\\mu'_1=0.1$，$y_2$ 的需求量为 $\\nu'_2=0.5$。我们移动 $\\delta_2 = \\min(0.1, 0.5) = 0.1$。\n因此，$\\Gamma_{12} = 0.1$。\n现在 $x_1$ 的供应已满足。$y_2$ 的剩余需求量为 $0.5 - 0.1 = 0.4$。\n更新后的供应量：$\\mu'' = (0, 0.4, 0.2)$。\n更新后的需求量：$\\nu'' = (0, 0.4, 0.2)$。\n由于第 1 行已满足，我们移动到下一行 $i=2$。\n\n**步骤 3：** 考虑单元格 $(2,2)$。$x_2$ 的供应量为 $\\mu''_2=0.4$，$y_2$ 的需求量为 $\\nu''_2=0.4$。我们移动 $\\delta_3 = \\min(0.4, 0.4) = 0.4$。\n因此，$\\Gamma_{22} = 0.4$。\n$x_2$ 的供应和 $y_2$ 的需求都已满足。\n更新后的供应量：$\\mu''' = (0, 0, 0.2)$。\n更新后的需求量：$\\nu''' = (0, 0, 0.2)$。\n由于第 2 行和第 2 列已满足，我们移动到单元格 $(3,3)$。\n\n**步骤 4：** 考虑单元格 $(3,3)$。$x_3$ 的供应量为 $\\mu'''_3=0.2$，$y_3$ 的需求量为 $\\nu'''_3=0.2$。我们移动 $\\delta_4 = \\min(0.2, 0.2) = 0.2$。\n因此，$\\Gamma_{33} = 0.2$。\n现在所有供应和需求都已满足。所有其他条目 $\\Gamma_{ij}$ 均为 $0$。\n\n得到的最优耦合矩阵 $\\Gamma^{\\star}$ 是：\n$$\n\\Gamma^{\\star} = \\begin{pmatrix}\n0.3 & 0.1 & 0 \\\\\n0 & 0.4 & 0 \\\\\n0 & 0 & 0.2\n\\end{pmatrix}\n$$\n\n我们可以验证行和与列和与所需的边际分布 $\\mu$ 和 $\\nu$ 相匹配。\n行和：$0.3+0.1+0=0.4$, $0+0.4+0=0.4$, $0+0+0.2=0.2$。这与 $\\mu=(0.4, 0.4, 0.2)$ 相匹配。\n列和：$0.3+0+0=0.3$, $0.1+0.4+0=0.5$, $0+0+0.2=0.2$。这与 $\\nu=(0.3, 0.5, 0.2)$ 相匹配。\n\n问题要求的是连接 $x_1$ 和 $y_2$ 的图间边权重，其定义为 $w_{x_{1},y_{2}} = \\Gamma^{\\star}_{12}$。根据我们计算出的矩阵，该值为 $0.1$。\n\n最终答案应表示为四舍五入到四位有效数字的小数。数字 $0.1$ 有一位有效数字。要用四位有效数字表示，我们写作 $0.1000$。", "answer": "$$\\boxed{0.1000}$$", "id": "4350125"}, {"introduction": "当不同的生物相似性网络被融合成一个单一的图后，一个关键的挑战是如何提取节点（如表型或患者）之间有意义的距离或相似性度量。基于随机游走的方法通过考虑网络的全局连通性，为此提供了一种稳健的解决方案。这项实践 [@problem_id:4350096] 要求您计算首达时间和通勤时间，这是随机游走理论中的基本概念。本练习将帮助您理解这些度量如何捕捉图上的“距离”概念，以及为何它们在量化多模态融合网络中的相似性时特别有用。", "problem": "在系统生物医学中，通常会整合由不同数据模态构建的异构相似性网络，以捕获互补的生物信号。考虑一个整合表型网络，该网络由融合两个基于相同表型集合 $\\{P_1, P_2, P_3, P_4\\}$ 的特定模态的无向加权图而形成，其中 $P_i$ 表示表型 $i$。这两个层是：\n- 基因组相似性层，其非零边权重为：$w^{(g)}(P_1,P_2)=1$，$w^{(g)}(P_2,P_3)=2$，$w^{(g)}(P_3,P_4)=1$。\n- 临床相似性层，其非零边权重为：$w^{(c)}(P_1,P_2)=2$，$w^{(c)}(P_2,P_3)=1$，$w^{(c)}(P_3,P_4)=2$。\n\n假设两个层都已通过预处理被缩放到可比较的权重范围。该整合图是通过对两个邻接函数进行凸融合来构建的：对于每对 $(i,j)$，有 $w^{(\\mathrm{fuse})}(P_i,P_j)=\\alpha\\,w^{(g)}(P_i,P_j)+(1-\\alpha)\\,w^{(c)}(P_i,P_j)$，其中 $\\alpha=\\frac{1}{2}$。令 $A$ 表示融合后的邻接矩阵，$D$ 表示对角度矩阵，其元素为 $D_{ii}=\\sum_j A_{ij}$。考虑在融合图上的简单随机游走，这是一个时齐马尔可夫链，其一步转移概率由 $P=D^{-1}A$ 给出。\n\n将首达时间 $H(P_i\\to P_j)$ 定义为从节点 $P_i$ 开始的随机游走首次访问节点 $P_j$ 所需的期望步数。将两个节点之间的往返时间定义为 $C(P_i,P_j)=H(P_i\\to P_j)+H(P_j\\to P_i)$。使用马尔可夫链的首步分析原理（即停时的期望可以写成从下一步状态出发的期望以一步转移概率为权重的和，再加上目标的首达时间为 $0$ 的边界条件）来推导并求解融合图上的必要线性方程组。\n\n计算融合图上的往返时间 $C(P_1,P_4)$。以单个实数形式提供精确值，不带单位。在推导过程中，通过将首达时间和往返时间与图上随机游走的结构以及网络融合聚合多模态证据的方式联系起来，论证为什么它们是整合网络中表型相似性的合适距离度量。最终报告的答案必须是单个数字，且不得包含单位。", "solution": "我们首先使用 $\\alpha=\\frac{1}{2}$ 的凸组合从两个层构建融合邻接矩阵 $A$。对于每个列出的边，我们有\n\n$$\nw^{(\\mathrm{fuse})}(P_1,P_2)=\\tfrac{1}{2}\\cdot 1+\\tfrac{1}{2}\\cdot 2=\\tfrac{3}{2},\\quad\nw^{(\\mathrm{fuse})}(P_2,P_3)=\\tfrac{1}{2}\\cdot 2+\\tfrac{1}{2}\\cdot 1=\\tfrac{3}{2},\\quad\nw^{(\\mathrm{fuse})}(P_3,P_4)=\\tfrac{1}{2}\\cdot 1+\\tfrac{1}{2}\\cdot 2=\\tfrac{3}{2}.\n$$\n\n所有其他点对的融合权重为 $0$，因为它们在两个层中的权重都为 $0$，且融合是线性的。因此，融合图是一个包含4个节点的简单路径，相邻节点之间的边权重相等，均为 $\\tfrac{3}{2}$，没有其他边。\n\n每个节点的度是其入射融合权重的总和。因此，\n\n$$\n\\deg(P_1)=\\tfrac{3}{2},\\quad \\deg(P_2)=\\tfrac{3}{2}+\\tfrac{3}{2}=3,\\quad \\deg(P_3)=3,\\quad \\deg(P_4)=\\tfrac{3}{2}.\n$$\n\n简单随机游走的转移概率由 $P=D^{-1}A$ 给出，因此对于每个节点，移动到邻居的概率是入射边权重除以节点度。因为每个节点最多有两个邻居，并且在有两个邻居的情况下入射权重相等，所以我们有\n\n$$\nP(P_1\\to P_2)=1,\\quad P(P_2\\to P_1)=\\tfrac{1}{2},\\quad P(P_2\\to P_3)=\\tfrac{1}{2},\\quad P(P_3\\to P_2)=\\tfrac{1}{2},\\quad P(P_3\\to P_4)=\\tfrac{1}{2},\\quad P(P_4\\to P_3)=1.\n$$\n\n\n现在我们通过首步分析计算首达时间。对于一个固定的目标节点，比如 $P_4$，定义 $h_i=H(P_i\\to P_4)$，其中 $i\\in\\{1,2,3,4\\}$。根据定义，$h_4=0$。对于 $i\\neq 4$，首步分析得出\n\n$$\nh_i=1+\\sum_{j} P(P_i\\to P_j)\\,h_j,\n$$\n\n因为先走一步，然后期望的剩余时间是根据转移概率对下一个状态的（首达时间）进行加权平均。明确写出方程组：\n\n$$\n\\begin{aligned}\nh_1=1+h_2 \\quad \\text{(因为 }P(P_1\\to P_2)=1\\text{)},\\\\\nh_2=1+\\tfrac{1}{2}h_1+\\tfrac{1}{2}h_3,\\\\\nh_3=1+\\tfrac{1}{2}h_2+\\tfrac{1}{2}h_4=1+\\tfrac{1}{2}h_2,\\\\\nh_4=0.\n\\end{aligned}\n$$\n\n我们解这个线性方程组。将 $h_3=1+\\tfrac{1}{2}h_2$ 代入 $h_2$ 的方程中：\n\n$$\nh_2=1+\\tfrac{1}{2}h_1+\\tfrac{1}{2}\\left(1+\\tfrac{1}{2}h_2\\right)=\\tfrac{3}{2}+\\tfrac{1}{2}h_1+\\tfrac{1}{4}h_2,\n$$\n\n这意味着\n\n$$\nh_2-\\tfrac{1}{4}h_2=\\tfrac{3}{2}+\\tfrac{1}{2}h_1\\quad \\Rightarrow\\quad \\tfrac{3}{4}h_2=\\tfrac{3}{2}+\\tfrac{1}{2}h_1.\n$$\n\n两边乘以 4 得到\n\n$$\n3h_2=6+2h_1.\n$$\n\n根据 $h_1=1+h_2$，我们有 $h_1-h_2=1$。将 $h_1=h_2+1$ 代入 $3h_2=6+2h_1$：\n\n$$\n3h_2=6+2(h_2+1)=6+2h_2+2 \\quad \\Rightarrow\\quad h_2=8.\n$$\n\n那么 $h_1=1+h_2=9$ 且 $h_3=1+\\tfrac{1}{2}h_2=1+4=5$。因此，\n\n$$\nH(P_1\\to P_4)=h_1=9.\n$$\n\n\n根据路径图的对称性以及无向加权图上简单随机游走的时间可逆性，我们预期 $H(P_4\\to P_1)=H(P_1\\to P_4)$。为了完整起见，我们可以用同样的方法显式计算它。定义 $g_i=H(P_i\\to P_1)$，其中 $g_1=0$，对于 $i\\neq 1$，方程组为\n\n$$\n\\begin{aligned}\ng_4=1+g_3\\quad \\text{(因为 }P(P_4\\to P_3)=1\\text{)},\\\\\ng_3=1+\\tfrac{1}{2}g_2+\\tfrac{1}{2}g_4,\\\\\ng_2=1+\\tfrac{1}{2}g_1+\\tfrac{1}{2}g_3=1+\\tfrac{1}{2}g_3,\\\\\ng_1=0.\n\\end{aligned}\n$$\n\n将 $g_2=1+\\tfrac{1}{2}g_3$ 代入 $g_3$ 的方程：\n\n$$\ng_3=1+\\tfrac{1}{2}\\left(1+\\tfrac{1}{2}g_3\\right)+\\tfrac{1}{2}g_4=\\tfrac{3}{2}+\\tfrac{1}{4}g_3+\\tfrac{1}{2}g_4.\n$$\n\n因此\n\n$$\ng_3-\\tfrac{1}{4}g_3=\\tfrac{3}{2}+\\tfrac{1}{2}g_4 \\quad \\Rightarrow\\quad \\tfrac{3}{4}g_3=\\tfrac{3}{2}+\\tfrac{1}{2}g_4.\n$$\n\n两边乘以 4 得到 $3g_3=6+2g_4$。根据 $g_4=1+g_3$，代入得到\n\n$$\n3g_3=6+2(1+g_3)=8+2g_3 \\quad \\Rightarrow\\quad g_3=8,\n$$\n\n由此可得 $g_4=1+g_3=9$ 且 $g_2=1+\\tfrac{1}{2}g_3=1+4=5$。因此，\n\n$$\nH(P_4\\to P_1)=g_4=9.\n$$\n\n\n往返时间定义为 $C(P_1,P_4)=H(P_1\\to P_4)+H(P_4\\to P_1)$。因此，\n\n$$\nC(P_1,P_4)=9+9=18.\n$$\n\n\n最后，我们论证为何首达时间和往返时间可作为整合网络中表型相似性的距离度量。在融合图上的随机游走编码了沿着由多模态相似性加权的路径的移动；融合邻接矩阵 $A$ 线性地聚合了基因组和临床证据，因此转移概率 $P=D^{-1}A$ 反映了来自两种模态的相对支持度。首达时间 $H(P_i\\to P_j)$ 是从 $P_i$ 出发遇到 $P_j$ 的期望步数，它对所有由 $P$ 决定的概率的可能路径进行了积分。当 $P_i$ 和 $P_j$ 之间存在多条高概率的短路径时，该值很小，表明存在由共享模块介导的强整合相似性；而当路径稀疏或微弱时，该值很大，表明存在差异性。往返时间通过将两个方向的首达时间相加来对称化这一概念，使其成为一个对节点间的、对全局网络结构而非仅仅局部边权重敏感的、合适的类距离度量。在系统生物医学的网络融合中，这种基于游走的距离对任何单一模态中的噪声都具有鲁棒性，因为它们在许多路径上进行平均，而这些路径的概率源于融合的多模态拓扑结构。因此，计算出的往返时间量化了融合网络中表型 $P_1$ 和 $P_4$ 之间一种整合的、基于路径系综的非相似性。", "answer": "$$\\boxed{18}$$", "id": "4350096"}, {"introduction": "开发任何网络融合方法的关键步骤是严格评估其性能。在生物网络的背景下，由于网络通常是稀疏和不完整的，评估通常被构建为一个链路预测任务。选择合适的评估指标对于得出有效结论至关重要。这项练习 [@problem_id:4350086] 将引导您构建ROC曲线和精确率-召回率 (PR) 曲线，这是评估二元分类器的两个标准工具。它着重强调了为何在生物医学链路预测中常见的类别极度不平衡场景下，PR曲线通常比ROC曲线更具信息量，这对该领域的任何实践者来说都是至关重要的一课。", "problem": "您正在使用标准的网络融合程序（例如，相似性网络融合 (SNF)）整合两个源自组学的患者相似性图谱，以在融合后的图谱上执行链接预测。链接预测模型为每个候选边 $(i,j)$ 生成一个校准分数 $s_{ij} \\in [0,1]$，其中较高的 $s_{ij}$ 表示该边在底层生物网络中真实存在的置信度更高。假设您在一个包含10个候选边的留出集上评估该模型，这些边具有校准分数和真实标签 $y_{ij} \\in \\{0,1\\}$（其中 $1$ 表示真实边，$0$ 表示非边）。按分数从高到低排序的列表如下：\n- $e_1: s=0.95, y=1$\n- $e_2: s=0.90, y=0$\n- $e_3: s=0.85, y=0$\n- $e_4: s=0.80, y=1$\n- $e_5: s=0.60, y=0$\n- $e_6: s=0.55, y=0$\n- $e_7: s=0.50, y=1$\n- $e_8: s=0.40, y=0$\n- $e_9: s=0.30, y=0$\n- $e_{10}: s=0.10, y=0$\n\n令 $P$ 为正例数，$N$ 为负例数，并考虑通过阈值 $t$ 进行划分，使得分数 $s \\ge t$ 的边被预测为正例。使用受试者工作特征 (ROC) 曲线和精确率-召回率 (PR) 曲线的核心定义：真阳性率 ($TPR$)、假阳性率 ($FPR$)、精确率 (Precision) 和召回率 (Recall)，它们分别定义为 $TPR = TP/P$，$FPR = FP/N$，$Precision = TP/(TP+FP)$，以及 $Recall = TP/P$，其中 $TP$、$FP$、$TN$ 和 $FN$ 是混淆矩阵的计数。通过在不同的分数上将阈值 $t$ 从1扫到0，构建所获得的ROC和PR点。然后，根据这些定义，解释为什么在生物医学网络（例如，蛋白质-蛋白质相互作用图谱或患者相似性图谱）典型的稀疏设置（其中 $N \\gg P$）中，PR 通常优于 ROC，而无需借助领域特定的启发式方法。\n\n以下哪些陈述是正确的？\n\nA. 使用阈值 $t \\ge 0.70$，ROC 曲线上的点是 $(FPR,TPR) = \\left(\\frac{2}{7}, \\frac{2}{3}\\right)$，PR 曲线上对应的点是 $(Recall,Precision) = \\left(\\frac{2}{3}, \\frac{1}{2}\\right)$。\n\nB. 根据上述排名计算的 ROC 曲线下面积等于 $\\frac{15}{21} \\approx 0.714$，而平均精确率 (AP) 等于 $\\left(1 + \\frac{1}{2} + \\frac{3}{7}\\right)/3 \\approx 0.643$。在 $N \\gg P$ 的稀疏生物医学图谱中，PR 更受青睐，因为即使 $FP$ 很大，$FPR = FP/N$ 在数值上仍然可能很小，这可能使 ROC 曲线看起来过于乐观。\n\nC. 在 $N \\gg P$ 的设置中，ROC 更可取，因为精确率不随 $FP$ 改变，而每增加一个 $FP$，$FPR$ 都会显著增加，这使得 ROC 比 PR 更保守。\n\nD. 在阈值 $t \\ge 0.70$ 时，混淆矩阵的计数为 $(TP,FP,FN,TN) = (2,2,1,5)$。\n\nE. 精确率-召回率曲线对类别流行度 $P/(P+N)$ 是不变的，因此无论稀疏性如何，它们都具有相同的基线；这种不变性是生物医学网络偏好使用 PR 的主要原因。\n\n选择所有适用项。通过从定义中推导出相关量，并就类别不平衡对 $FPR$ 与精确率的影响进行推理，来证明您的选择。", "solution": "首先，我们确定真实标签中的正例 ($P$) 和负例 ($N$) 的总数。\n- 正例 ($y=1$) 是 $e_1, e_4, e_7$。因此，$P = 3$。\n- 负例 ($y=0$) 是 $e_2, e_3, e_5, e_6, e_8, e_9, e_{10}$。因此，$N = 7$。\n- 实例总数为 $P+N = 3+7=10$。\n\n**逐项分析**\n\n**选项 D 的分析：在阈值 $t \\ge 0.70$ 时，混淆矩阵的计数为 $(TP,FP,FN,TN) = (2,2,1,5)$。**\n- 阈值为 $t \\ge 0.70$ 意味着我们将所有分数 $s \\ge 0.70$ 的边分类为正例。\n- 满足此条件的边是 $e_1 (s=0.95)$、$e_2 (s=0.90)$、$e_3 (s=0.85)$ 和 $e_4 (s=0.80)$。共有4个预测为正例的边。\n- 我们检查这些预测的真实标签：\n    - $e_1 (y=1)$ 是一个真阳性 ($TP$)。\n    - $e_2 (y=0)$ 是一个假阳性 ($FP$)。\n    - $e_3 (y=0)$ 是一个假阳性 ($FP$)。\n    - $e_4 (y=1)$ 是一个真阳性 ($TP$)。\n- 这得出 $TP = 2$ 和 $FP = 2$。\n- 假阴性 ($FN$) 的数量是未被预测为正例的实际正例数。实际正例是 $e_1, e_4, e_7$。由于 $e_1$ 和 $e_4$ 被正确预测，唯一漏掉的是 $e_7 (s=0.50 < 0.70)$。因此，$FN = 1$。\n- 真阴性 ($TN$) 的数量是未被预测为正例的实际负例数。实际负例是 $e_2, e_3, e_5, e_6, e_8, e_9, e_{10}$。在这7个负例中，$e_2$ 和 $e_3$ 被错误地预测为正例。剩下的5个实例 ($e_5, e_6, e_8, e_9, e_{10}$) 被正确地识别为负例。因此，$TN = 5$。\n- 混淆矩阵的计数为 $(TP, FP, FN, TN) = (2, 2, 1, 5)$。\n- 选项 D 中的陈述是 **正确的**。\n\n**选项 A 的分析：使用阈值 $t \\ge 0.70$，ROC 曲线上的点是 $(FPR,TPR) = \\left(\\frac{2}{7}, \\frac{2}{3}\\right)$，PR 曲线上对应的点是 $(Recall,Precision) = \\left(\\frac{2}{3}, \\frac{1}{2}\\right)$。**\n- 我们使用为选项 D 推导出的混淆矩阵计数：$TP=2, FP=2, FN=1, TN=5$，其中 $P=3$ 且 $N=7$。\n- 计算 ROC 点的坐标：\n    - $TPR = TP/P = 2/3$。\n    - $FPR = FP/N = 2/7$。\n    - ROC 点是 $(FPR, TPR) = (2/7, 2/3)$。陈述的这一部分是正确的。\n- 计算 PR 点的坐标：\n    - $Recall = TP/P = 2/3$。\n    - $Precision = TP/(TP+FP) = 2/(2+2) = 2/4 = 1/2$。\n    - PR 点是 $(Recall, Precision) = (2/3, 1/2)$。陈述的这一部分也是正确的。\n- 由于陈述的两个部分都通过计算得到了验证，选项 A 是 **正确的**。\n\n**选项 B 的分析：根据上述排名计算的 ROC 曲线下面积等于 $\\frac{15}{21} \\approx 0.714$，而平均精确率 (AP) 等于 $\\left(1 + \\frac{1}{2} + \\frac{3}{7}\\right)/3 \\approx 0.643$。在 $N \\gg P$ 的稀疏生物医学图谱中，PR 更受青睐，因为即使 $FP$ 很大，$FPR = FP/N$ 在数值上仍然可能很小，这可能使 ROC 曲线看起来过于乐观。**\n- **AUC-ROC 计算：**AUC-ROC 可以使用 Wilcoxon-Mann-Whitney U 统计量来计算，它表示随机选择一个正例的排名高于随机选择一个负例的概率。我们有 $P=3$ 个正例和 $N=7$ 个负例，总共有 $P \\times N = 21$ 对（正例，负例）实例。\n    - 排名第1的正例排在所有7个负例之前。\n    - 排名第4的正例排在排名为5、6、8、9、10的5个负例之前。\n    - 排名第7的正例排在排名为8、9、10的3个负例之前。\n    - 正确排序的对数为 $7 + 5 + 3 = 15$。\n    - $AUC = 15 / (P \\times N) = 15/21$。该值是正确的。\n- **平均精确率 (AP) 计算：**AP 是每次检索到正例时获得的精确率值的平均值。我们将每个正例排名处的精确率相加，然后除以正例总数 $P$。\n    - 正例位于排名1、4、7。\n    - 在排名1（实例 $e_1$）处：$TP=1, FP=0$。精确率 $= 1/1 = 1$。\n    - 在排名4（实例 $e_4$）处：$TP=2, FP=2$。精确率 $= 2/4 = 1/2$。\n    - 在排名7（实例 $e_7$）处：$TP=3, FP=4$。精确率 $= 3/7$。\n    - $AP = \\frac{1}{P} \\sum_{k \\in \\text{positive ranks}} \\text{Precision at rank } k = \\frac{1}{3} \\left(1 + \\frac{1}{2} + \\frac{3}{7}\\right)$。\n    - $AP = \\frac{1}{3} \\left(\\frac{14+7+6}{14}\\right) = \\frac{1}{3} \\left(\\frac{27}{14}\\right) = \\frac{9}{14} \\approx 0.642857$。所提供的计算 $\\left(1 + \\frac{1}{2} + \\frac{3}{7}\\right)/3 \\approx 0.643$ 是正确的。\n- **推理：**该陈述声称，在稀疏设置 ($N \\gg P$) 中，PR 更受青睐，因为即使 $FP$ 发生较大变化，$FPR = FP/N$ 的变化也很小。这是正确的。如果 $N$ 非常大（例如，$10^6$），$FP$ 从10增加到1000（假发现数量增加100倍）只会使 $FPR$ 从 $10^{-5}$ 变为 $10^{-3}$。ROC 曲线 x 轴上的这种微小变化可能不会显著降低 AUC-ROC，从而给出过于乐观的评估。然而，精确率 ($TP/(TP+FP)$) 对 $FP$ 非常敏感，会急剧下降，从而为从业者准确反映出较差的性能。这个推理是合理的。\n- 因此，选项 B 是 **正确的**。\n\n**选项 C 的分析：在 $N \\gg P$ 的设置中，ROC 更可取，因为精确率不随 $FP$ 改变，而每增加一个 $FP$，$FPR$ 都会显著增加，这使得 ROC 比 PR 更保守。**\n- 这个陈述包含多个错误。\n- “精确率不随 $FP$ 改变”：错误。定义是 $Precision = TP/(TP+FP)$。精确率与 $FP$ 成反比。\n- “每增加一个 $FP$，$FPR$ 都会显著增加”：错误。在指定的 $N \\gg P$ 设置中，随着 $FP$ 的增加，$FPR = FP/N$ 增加得非常*缓慢*，因为分母 $N$ 非常大。这正是 ROC 可能产生误导性乐观结果的原因。\n- “ROC 更可取……使得 ROC 比 PR 更保守”：错误。事实恰恰相反。PR 对假阳性的数量更敏感，因此在生物医学网络分析中典型的类别不平衡场景下，被认为是一个信息更丰富、更保守的指标。\n- 因此，选项 C 是 **不正确的**。\n\n**选项 E 的分析：精确率-召回率曲线对类别流行度 $P/(P+N)$ 是不变的，因此无论稀疏性如何，它们都具有相同的基线；这种不变性是生物医学网络偏好使用 PR 的主要原因。**\n- 这个陈述从根本上是错误的。声称 PR 曲线对类别流行度不变是错误的。让我们分析 PR 曲线的组成部分。召回率 = $TP/P$。精确率 = $TP/(TP+FP)$。虽然召回率不依赖于负例数 $N$，但精确率依赖，因为 $FP$ 来自负例类别。如果在数据集中增加负例数 $N$（从而改变流行度），一个对于每个类别具有固定分数分布的分类器，在任何给定的分数阈值下都会产生更多的假阳性 $FP$，导致精确率值降低。这意味着 PR 曲线的形状和位置高度依赖于类别流行度。\n- 此外，在 PR 空间中，随机分类器的基线是一条位于 $Precision = P/(P+N)$ 的水平线，这正是类别流行度。根据定义，该基线依赖于稀疏性。\n- 被认为对类别流行度不变的是 ROC 曲线，因为它的两个轴（$TPR=TP/P$ 和 $FPR=FP/N$）都通过各自类别的数量进行了归一化。这种不变性正是 ROC 在稀疏设置中可能产生误导的原因。该陈述错误地将此属性归因于 PR 曲线，并错误地指出了偏好 PR 的原因。\n- 因此，选项 E 是 **不正确的**。\n\n正确的陈述是 A、B 和 D。", "answer": "$$\\boxed{ABD}$$", "id": "4350086"}]}