{"hands_on_practices": [{"introduction": "理解通量平衡分析（FBA）的最佳方式是亲手完成一个实例。这个练习要求你为一个微型代谢网络计算最优通量分布。通过手动求解这个小规模的线性规划问题，你将具体地理解稳态质量平衡和通量约束如何共同定义细胞的代谢能力。", "problem": "一个最小细胞尺度代谢网络在流平衡分析 (FBA) 中使用的稳态假设下被建模。内部代谢物是细胞内葡萄糖 ($G$)、丙酮酸 ($P$) 和三磷酸腺苷 ($A$)。该网络包含五个不可逆反应：\n- $R_{1}$ (摄取)：$\\varnothing \\rightarrow G$，通量为 $v_{1}$，\n- $R_{2}$ (糖酵解)：$G \\rightarrow 2 P + 2 A$，通量为 $v_{2}$，\n- $R_{3}$ (呼吸作用)：$P \\rightarrow 3 A$，通量为 $v_{3}$，\n- $R_{4}$ (维持)：$A \\rightarrow \\varnothing$，通量为 $v_{4}$，\n- $R_{5}$ (生物质需求)：$P + 4 A \\rightarrow \\varnothing$，通量为 $v_{5}$。\n\n内部代谢物的化学计量矩阵 $S$，其反应列按 $(R_{1},R_{2},R_{3},R_{4},R_{5})$ 的顺序排列，为\n$$\nS \\;=\\;\n\\begin{pmatrix}\n1  -1  0  0  0 \\\\\n0  2  -1  0  -1 \\\\\n0  2  3  -1  -4\n\\end{pmatrix},\n$$\n对应于代谢物行 $(G,P,A)$。\n\n假设标准的 FBA 稳态质量平衡 $S \\, v = 0$ 和以下通量边界：\n- $0 \\leq v_{1} \\leq 6$,\n- $0 \\leq v_{2}$,\n- $0 \\leq v_{3}$,\n- $1 \\leq v_{4}$,\n- $0 \\leq v_{5}$.\n\n目标是在稳态质量平衡和通量边界的约束下，最大化生物质需求通量 $v_{5}$。\n\n从给定的基本定义和约束出发，手动求解该优化问题，以确定最优通量向量 $(v_{1}, v_{2}, v_{3}, v_{4}, v_{5})$ 和最优目标值 $v_{5}^{\\star}$。将两者按顺序 $(v_{1}, v_{2}, v_{3}, v_{4}, v_{5}, v_{5}^{\\star})$ 一起以单行矩阵的形式报告。\n\n通量以毫摩尔每克干重每小时 (mmol gDW$^{-1}$ h$^{-1}$) 表示。提供精确的有理数值；无需四舍五入。在最终的方框答案中不要包含单位。", "solution": "该问题经验证具有科学依据、是适定的、客观的且内部一致。它构成了流平衡分析 (FBA) 中常见的标准线性规划问题。所有必要的数据和约束都已提供。因此，我们可以开始求解。\n\n问题是在一组线性约束下最大化生物质需求通量 $v_{5}$。这可以形式化地表述为以下线性规划问题：\n\n最大化 $Z = v_{5}$\n\n约束条件：\n1. 稳态质量平衡：$S v = 0$\n2. 通量边界\n\n通量向量为 $v = (v_{1}, v_{2}, v_{3}, v_{4}, v_{5})^{T}$。稳态方程 $S v = 0$ 展开为一个线性方程组：\n$$\n\\begin{pmatrix}\n1  -1  0  0  0 \\\\\n0  2  -1  0  -1 \\\\\n0  2  3  -1  -4\n\\end{pmatrix}\n\\begin{pmatrix}\nv_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\\\ v_{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n\n该矩阵方程对应于以下方程组：\n(i) $v_{1} - v_{2} = 0$\n(ii) $2v_{2} - v_{3} - v_{5} = 0$\n(iii) $2v_{2} + 3v_{3} - v_{4} - 4v_{5} = 0$\n\n通量边界给定为：\n(iv) $0 \\leq v_{1} \\leq 6$\n(v) $v_{2} \\geq 0$\n(vi) $v_{3} \\geq 0$\n(vii) $v_{4} \\geq 1$\n(viii) $v_{5} \\geq 0$\n\n我们将通过将变量用一个更小的独立变量集来表示，然后应用边界约束来求解该系统。\n\n从方程 (i) 中，我们发现 $v_{1}$ 和 $v_{2}$ 之间存在直接关系：\n$v_{2} = v_{1}$\n\n将此代入方程 (ii)，我们可以用 $v_{1}$ 和 $v_{5}$ 表示 $v_{3}$：\n$2v_{1} - v_{3} - v_{5} = 0 \\implies v_{3} = 2v_{1} - v_{5}$\n\n接下来，我们将 $v_{2} = v_{1}$ 和 $v_{3} = 2v_{1} - v_{5}$ 都代入方程 (iii)：\n$2v_{1} + 3(2v_{1} - v_{5}) - v_{4} - 4v_{5} = 0$\n$2v_{1} + 6v_{1} - 3v_{5} - v_{4} - 4v_{5} = 0$\n$8v_{1} - 7v_{5} - v_{4} = 0$\n\n现在我们可以用 $v_{1}$ 和 $v_{4}$ 来表示我们的目标函数变量 $v_{5}$：\n$7v_{5} = 8v_{1} - v_{4}$\n$v_{5} = \\frac{8}{7}v_{1} - \\frac{1}{7}v_{4}$\n\n我们的目标是最大化 $v_{5}$。$v_{5}$ 的表达式是 $v_{1}$ 和 $v_{4}$ 的线性函数。为了最大化 $v_{5}$，我们必须根据它们各自的边界，最大化 $v_{1}$ 并最小化 $v_{4}$。\n\n根据约束 (iv)，$v_{1}$ 的最大值为 $6$。\n根据约束 (vii)，$v_{4}$ 的最小值为 $1$。\n\n我们设定 $v_{1} = 6$ 和 $v_{4} = 1$。只要得到的通量向量满足所有其他约束，这个选择将使目标函数最大化。\n\n$v_{5}$ 的最优值，记为 $v_{5}^{\\star}$，是：\n$v_{5}^{\\star} = \\frac{8}{7}(6) - \\frac{1}{7}(1) = \\frac{48}{7} - \\frac{1}{7} = \\frac{47}{7}$\n\n现在我们必须计算其他通量 $v_{2}$ 和 $v_{3}$ 的相应值，并验证它们是否满足其非负约束。\n$v_{2} = v_{1} = 6$\n$v_{3} = 2v_{1} - v_{5} = 2(6) - \\frac{47}{7} = 12 - \\frac{47}{7} = \\frac{84 - 47}{7} = \\frac{37}{7}$\n\n我们来检查计算出的最优通量向量 $(v_{1}, v_{2}, v_{3}, v_{4}, v_{5}) = (6, 6, \\frac{37}{7}, 1, \\frac{47}{7})$ 的约束条件：\n- $0 \\leq v_{1} \\leq 6$: $0 \\leq 6 \\leq 6$。满足。\n- $v_{2} \\geq 0$: $6 \\geq 0$。满足。\n- $v_{3} \\geq 0$: $\\frac{37}{7} \\geq 0$。满足。\n- $v_{4} \\geq 1$: $1 \\geq 1$。满足。\n- $v_{5} \\geq 0$: $\\frac{47}{7} \\geq 0$。满足。\n\n所有约束都满足。选择 $v_{1}=6$ 和 $v_{4}=1$ 导出了一个有效且最优的解。\n\n最优通量向量为 $(v_{1}, v_{2}, v_{3}, v_{4}, v_{5}) = (6, 6, \\frac{37}{7}, 1, \\frac{47}{7})$。\n最优目标值为 $v_{5}^{\\star} = \\frac{47}{7}$。\n\n最终答案要求将最优通量向量和最优目标值一起以单行矩阵 $(v_{1}, v_{2}, v_{3}, v_{4}, v_{5}, v_{5}^{\\star})$ 的形式报告。\n这给出了向量 $(6, 6, \\frac{37}{7}, 1, \\frac{47}{7}, \\frac{47}{7})$。\n这些结果是所要求的精确有理数。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6  6  \\frac{37}{7}  1  \\frac{47}{7}  \\frac{47}{7}\n\\end{pmatrix}\n}\n$$", "id": "4360669"}, {"introduction": "除了找到最优生长速率，FBA 通过影子价格的概念为我们揭示了代谢经济学的深层见解。在这个高级实践中，你将推导一个 FBA 问题的对偶问题，并计算一个关键代谢物的影子价格。这个练习阐明了，如果细胞能额外获得一个单位的特定代谢物，其生长目标会受益多少，从而为其代谢价值提供了一个量化指标。", "problem": "考虑一个由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 表示的代谢网络，该网络包含 $m$ 种代谢物和 $n$ 个反应。在细胞内代谢物浓度不随时间变化的稳态假设下，对于反应通量向量 $v \\in \\mathbb{R}^{n}$，质量平衡约束为 $S v = 0$。通量平衡分析 (Flux Balance Analysis, FBA) 将生长最优化问题构建为一个线性规划 (Linear Programming, LP) 问题，其中线性目标 $c^{\\top} v$ 在线性等式和边界约束下被最大化。该问题基于以下基本原理：稳态下的质量守恒、伪稳态机制下通量的线性，以及线性规划对偶和灵敏度的典范形式。\n\n给定标准边界约束形式的原始 FBA 线性规划问题：目标为最大化 $c^{\\top} v$，约束条件为 $S v = 0$，$l \\leq v \\leq u$。对偶线性规划为这些约束引入了拉格朗日乘子。与代谢物平衡约束 $S v = 0$ 相关联的对偶变量被解释为影子价格，其量化了在生长最优化中放宽代谢物可用性的边际价值。\n\n任务：\n1. 从具有等式和边界约束的原始最大化问题的线性规划对偶基本定义出发，为给定的原始 FBA 构建形式推导其对偶线性规划。明确指出对应于等式约束 $S v = 0$ 和边界约束 $l \\leq v \\leq u$ 的对偶变量，并求出对偶可行性条件和对偶目标。\n2. 对于下文给出的特定代谢网络，求解原始问题以达到最优，然后使用 Karush-Kuhn-Tucker (KKT) 最优性条件来确定相应的最优对偶变量。通过将与 $S v = 0$ 相关联的对偶变量与放宽稳态可用性时目标函数的边际改善联系起来，将其解释为代谢物的影子价格。\n3. 报告代谢物 $B$ 的可用性影子价格。此处的约定是，可用性放宽以供应松弛量 $s \\geq 0$ 的形式进入平衡方程 $S v - s = 0$，因此影子价格等于 $-\\lambda_{B}$，其中 $\\lambda_{B}$ 是与代谢物 $B$ 的平衡方程相关联的对偶变量。\n\n网络规格：\n- 代谢物：$A$ 和 $B$。\n- 反应：$v_{1}$（$A$ 的摄取），$v_{2}$（$A \\to B$），$v_{3}$（$B \\to$ 生物质），$v_{4}$（$B$ 的分泌）。\n- 化学计量矩阵 $S$（行：$A, B$；列：$v_{1}, v_{2}, v_{3}, v_{4}$）：\n$$\nS = \\begin{pmatrix}\n1  -1  0  0 \\\\\n0  1  -1  -1\n\\end{pmatrix}.\n$$\n- 边界：$0 \\leq v_{1} \\leq 10$，$0 \\leq v_{2}$，$0 \\leq v_{3}$，$0 \\leq v_{4}$，并将 $v_{2}, v_{3}, v_{4}$ 视为没有有限上界。\n- 目标：最大化生长，即 $c^{\\top} v$，其中 $c = (0, 0, 1, 0)^{\\top}$。\n\n请将最终答案表示为在所述约定下代谢物 $B$ 的可用性影子价格对应的单个实数。无需单位。无需四舍五入。", "solution": "该问题被验证为有科学依据、适定、客观、完整且可形式化。它代表了线性规划 (LP) 对偶和灵敏度分析在代谢网络建模的通量平衡分析 (FBA) 领域中的一个标准应用。解答按要求分为三部分进行。\n\n### 第1部分：FBA 对偶线性规划的推导\n\n原始 FBA 问题被构建为最大化线性规划：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad  c^{\\top} v \\\\\n\\text{约束于} \\quad  S v = 0 \\\\\n l \\leq v \\leq u\n\\end{aligned}\n$$\n其中 $v \\in \\mathbb{R}^{n}$ 是通量向量，$c \\in \\mathbb{R}^{n}$ 是目标向量，$S \\in \\mathbb{R}^{m \\times n}$ 是化学计量矩阵，$l, u \\in \\mathbb{R}^{n}$ 分别是通量的下界和上界。\n\n为了推导对偶问题，我们首先将约束写成最大化问题的标准小于等于形式：\n$$\n\\begin{aligned}\n S v \\leq 0 \\\\\n -S v \\leq 0 \\\\\n v \\leq u \\\\\n -v \\leq -l\n\\end{aligned}\n$$\n我们为每个约束分配非负的拉格朗日乘子（对偶变量）。令 $\\lambda^{+} \\geq 0$ 和 $\\lambda^{-} \\geq 0$ 分别是 $S v \\leq 0$ 和 $-S v \\leq 0$ 的对偶变量。习惯上将它们合并为一个对应于等式约束 $S v = 0$ 的自由变量 $\\lambda = \\lambda^{+} - \\lambda^{-} \\in \\mathbb{R}^{m}$。令 $\\mu_u \\geq 0$ 为 $v \\leq u$ (即 $v - u \\leq 0$) 的对偶变量，$\\mu_l \\geq 0$ 为 $-v \\leq -l$ (即 $l - v \\leq 0$) 的对偶变量。\n\n原始问题的拉格朗日函数是：\n$$\nL(v, \\lambda, \\mu_u, \\mu_l) = c^{\\top} v - \\lambda^{\\top}(S v) - \\mu_u^{\\top}(v - u) - \\mu_l^{\\top}(l - v)\n$$\n此处使用了乘子的标准符号约定。根据原始变量 $v$ 重新整理各项：\n$$\nL(v, \\lambda, \\mu_u, \\mu_l) = (c^{\\top} - \\lambda^{\\top}S - \\mu_u^{\\top} + \\mu_l^{\\top})v + \\mu_u^{\\top}u - \\mu_l^{\\top}l\n$$\n对偶函数 $g(\\lambda, \\mu_u, \\mu_l)$ 是拉格朗日函数关于 $v$ 的上确界。为使上确界有限， $v$ 的系数必须为零。这给出了对偶可行性约束：\n$$\nc^{\\top} - \\lambda^{\\top}S - \\mu_u^{\\top} + \\mu_l^{\\top} = 0 \\quad \\implies \\quad S^{\\top}\\lambda + \\mu_u - \\mu_l = c\n$$\n当此条件成立时，拉格朗日函数与 $v$ 无关，对偶函数为 $g = \\mu_u^{\\top}u - \\mu_l^{\\top}l$。对偶线性规划旨在在对偶可行性约束下最小化此函数。\n\n因此，对偶线性规划是：\n$$\n\\begin{aligned}\n\\text{最小化} \\quad  u^{\\top}\\mu_u - l^{\\top}\\mu_l \\\\\n\\text{约束于} \\quad  S^{\\top}\\lambda + \\mu_u - \\mu_l = c \\\\\n \\lambda \\in \\mathbb{R}^{m} \\quad (\\text{自由变量}) \\\\\n \\mu_u \\in \\mathbb{R}^{n}, \\mu_u \\geq 0 \\\\\n \\mu_l \\in \\mathbb{R}^{n}, \\mu_l \\geq 0\n\\end{aligned}\n$$\n对偶变量 $\\lambda$ 对应于质量平衡约束 $S v = 0$，对偶变量 $\\mu_u$ 和 $\\mu_l$ 分别对应于通量的上界和下界约束。\n\n### 第2部分：通过 KKT 条件求解原始解和计算对偶变量\n\n具体的 FBA 问题是：\n- 代谢物：$A$ (第1行)，$B$ (第2行)。\n- 反应：$v = (v_1, v_2, v_3, v_4)^{\\top}$。\n- 目标：最大化 $v_3$，所以 $c = (0, 0, 1, 0)^{\\top}$。\n- 约束：\n$$\nS v = \\begin{pmatrix} 1  -1  0  0 \\\\ 0  1  -1  -1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\\\ v_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\nl = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\leq v \\leq u = \\begin{pmatrix} 10 \\\\ \\infty \\\\ \\infty \\\\ \\infty \\end{pmatrix}\n$$\n展开为：\n1.  $v_1 - v_2 = 0 \\implies v_1 = v_2$\n2.  $v_2 - v_3 - v_4 = 0 \\implies v_3 = v_2 - v_4$\n3.  $0 \\leq v_1 \\leq 10$\n4.  $v_2 \\geq 0, v_3 \\geq 0, v_4 \\geq 0$\n\n为了最大化 $v_3$，我们必须最大化 $v_2$ 并最小化 $v_4$。根据约束 (1) 和 (3)，$v_2 = v_1$，因此 $v_2$ 的最大可能值为 $10$。根据约束 (4)，$v_4$ 的最小可能值为 $0$。\n将这些值代入约束 (2) 得到最大目标值：$v_3 = 10 - 0 = 10$。\n最优原始通量向量为 $v^* = (10, 10, 10, 0)^{\\top}$。最优目标值为 $Z^* = 10$。\n\n接下来，我们使用 Karush-Kuhn-Tucker (KKT) 条件来寻找最优对偶变量。KKT 条件包括原始可行性（由 $v^*$ 满足）、对偶可行性和互补松弛性。\n对偶可行性条件为 $S^{\\top}\\lambda + \\mu_u - \\mu_l = c$：\n$$\n\\begin{pmatrix} 1  0 \\\\ -1  1 \\\\ 0  -1 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} \\lambda_A \\\\ \\lambda_B \\end{pmatrix} + \\begin{pmatrix} \\mu_{u1} \\\\ \\mu_{u2} \\\\ \\mu_{u3} \\\\ \\mu_{u4} \\end{pmatrix} - \\begin{pmatrix} \\mu_{l1} \\\\ \\mu_{l2} \\\\ \\mu_{l3} \\\\ \\mu_{l4} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n互补松弛性条件为对每个反应 $j=1, \\dots, 4$，都有 $\\mu_{u,j}(v_j^* - u_j) = 0$ 和 $\\mu_{l,j}(l_j - v_j^*) = 0$。\n- 对于 $v_1^* = 10$：上界 $u_1=10$ 是激活的，因此 $\\mu_{u1} \\geq 0$。下界 $l_1=0$ 未激活，因此 $\\mu_{l1} = 0$。\n- 对于 $v_2^* = 10$：没有有限上界 ($u_2 = \\infty$)，因此 $\\mu_{u2} = 0$。下界 $l_2=0$ 未激活，因此 $\\mu_{l2} = 0$。\n- 对于 $v_3^* = 10$：没有有限上界 ($u_3 = \\infty$)，因此 $\\mu_{u3} = 0$。下界 $l_3=0$ 未激活，因此 $\\mu_{l3} = 0$。\n- 对于 $v_4^* = 0$：上界 $u_4=\\infty$ 未激活，因此 $\\mu_{u4} = 0$。下界 $l_4=0$ 是激活的，因此 $\\mu_{l4} \\geq 0$。\n\n将这些已知的零值代入对偶可行性方程：\n1.  ($j=1$): $\\quad \\lambda_A + \\mu_{u1} - 0 = 0 \\implies \\lambda_A + \\mu_{u1} = 0$\n2.  ($j=2$): $\\quad -\\lambda_A + \\lambda_B + 0 - 0 = 0 \\implies \\lambda_B = \\lambda_A$\n3.  ($j=3$): $\\quad -\\lambda_B + 0 - 0 = 1 \\implies \\lambda_B = -1$\n4.  ($j=4$): $\\quad -\\lambda_B + 0 - \\mu_{l4} = 0 \\implies \\mu_{l4} = -\\lambda_B$\n\n从方程 (3) 中，我们得到 $\\lambda_B^* = -1$。\n从方程 (2) 可知，$\\lambda_A^* = \\lambda_B^* = -1$。\n从方程 (1) 可知，$\\mu_{u1}^* = -\\lambda_A^* = -(-1) = 1$。这满足 $\\mu_{u1} \\geq 0$。\n从方程 (4) 可知，$\\mu_{l4}^* = -\\lambda_B^* = -(-1) = 1$。这满足 $\\mu_{l4} \\geq 0$。\n\n与质量平衡约束相关的最优对偶变量是 $\\lambda_A^* = -1$ 和 $\\lambda_B^* = -1$。\n\n### 第3部分：代谢物B的影子价格\n\n问题将代谢物（例如 $B$）的可用性影子价格定义为 $-\\lambda_B$，其中 $\\lambda_B$ 是代谢物 $B$ 质量平衡方程的对偶变量。\n根据我们在第2部分的计算，代谢物 $B$ 的最优对偶变量是 $\\lambda_B^* = -1$。\n\n因此，根据指定的约定，代谢物 $B$ 的可用性影子价格是：\n$$\n\\text{影子价格}_B = -\\lambda_B^* = -(-1) = 1\n$$\n这个值代表了当代谢物 $B$ 作为外部输入的可用性每增加一个单位时，目标函数（生物质产量，$v_3$）的边际增加量。以速率 $\\epsilon$ 输入 $B$ 会使质量平衡方程变为 $v_2 - v_3 - v_4 = -\\epsilon$，从而允许 $v_3$ 增加 $\\epsilon$。边际值为 $\\frac{dZ^*}{d\\epsilon}=1$，这证实了我们的结果。", "answer": "$$\\boxed{1}$$", "id": "4287610"}, {"introduction": "代谢模型是生成和检验生物学假设的强大工具。这个实践展示了如何运用 FBA 框架来研究一个特定的生理现象：细胞膜“渗漏”对 ATP 产量的影响。通过将质子被动扩散建模为一个新的反应，你将量化细胞效率如何受到影响，这显示了 FBA 如何将一个生物学问题转化为一个可预测的计算模型。", "problem": "使用一个最小质量平衡化学计量模型来量化质子被动扩散（一种渗漏膜现象）对三磷酸腺苷（ATP）生产能力的影响。考虑内膜外侧（周质/膜间隙）的一个由代谢物 $H_p$ 代表的单一集总质子池。还原当量由一个抽象代谢物 $Red$ 表示。对于所追踪的代谢物，所有通量必须被视为稳态，即满足 $S v = 0$。定义了以下反应：\n- 还原当量供应：$R_{in}: \\ \\emptyset \\rightarrow Red$，通量为 $v_{in}$，边界为 $0 \\le v_{in} \\le R_{max}$。\n- 电子传递链质子泵：$R_{pump}: \\ Red \\rightarrow \\emptyset + s \\ H_p$，通量为 $v_{pump}$，边界为 $0 \\le v_{pump} \\le U_{pump}$。其中 $s$ 是每消耗单位还原当量所泵出的质子数。\n- ATP合酶：$R_{ATP}: \\ p \\ H_p \\rightarrow \\emptyset$，通量为 $v_{ATP}$，边界为 $v_{ATP} \\ge 0$。其中 $p$ 是每合成一个ATP所需的质子数，$v_{ATP}$ 直接等于ATP的生产速率。\n- 质子渗漏：$R_{leak}: \\ H_p \\rightarrow \\emptyset$，通量 $v_{leak}$ 固定为指定的常数 $L$（即 $v_{leak} = L$）。这模拟了耗散质子动力势的质子被动扩散。\n\n设决策变量向量为 $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$，其中 $v_{sink} \\ge 0$ 允许任何未使用的还原当量被消耗掉（$Red \\rightarrow \\emptyset$），以满足 $Red$ 的平衡。$Red$ 和 $H_p$ 的稳态质量平衡方程为：\n- $Red$：$v_{in} - v_{pump} - v_{sink} = 0$。\n- $H_p$：$s \\ v_{pump} - p \\ v_{ATP} - v_{leak} = 0$。\n\n所有通量的单位均为毫摩尔每克干重每小时，即 $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$，并且所有参数 $R_{max}$、$U_{pump}$、$s$、$p$、$L$ 均为非负实数，其含义如下：\n- $R_{max}$：还原当量供应 $v_{in}$ 的上限。\n- $U_{pump}$：电子传递链泵送通量 $v_{pump}$ 的上限。\n- $s$：每消耗单位 $Red$ 所泵出的质子数。\n- $p$：每合成一个ATP所消耗的质子数。\n- $L$：固定的质子渗漏通量 $v_{leak}$。\n\n任务：对于下面的每一组参数集，计算满足上述约束的最大可行ATP生产速率 $v_{ATP}^\\star$。如果不存在稳态解（即约束不可行），则返回 $-1.0$。\n\n您必须只使用给定的模型、稳态平衡和边界条件。将每个结果以 $\\mathrm{mmol} \\cdot \\mathrm{gDW}^{-1} \\cdot \\mathrm{h}^{-1}$ 为单位表示为一个实数，并四舍五入到六位小数。\n\n测试套件（每个案例为 $(R_{max}, U_{pump}, s, p, L)$）：\n1. $(10, 8, 10, 4, 0)$\n2. $(10, 8, 10, 4, 10)$\n3. $(10, 8, 10, 4, 85)$\n4. $(5, 100, 10, 4, 10)$\n5. $(12, 12, 10, 3.67, 0)$\n\n最终输出格式：您的程序应产生单行输出，其中包含五个结果，形式为方括号内的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 都按规定四舍五入到六位小数。", "solution": "所提出的问题是一个约束优化任务，可以形式化为一个线性规划问题。其目标是在一个简化的代谢模型中，根据一组化学计量和容量约束，确定三磷酸腺苷的最大生产速率 $v_{ATP}$。\n\n该系统由以下变量和约束定义：\n\n**决策变量：** 通量向量为 $v = [v_{in}, v_{pump}, v_{ATP}, v_{leak}, v_{sink}]^\\top$。\n\n**稳态质量平衡：**\n1. 对于还原当量 $Red$：$v_{in} - v_{pump} - v_{sink} = 0$。\n2. 对于质子 $H_p$：$s \\cdot v_{pump} - p \\cdot v_{ATP} - v_{leak} = 0$。\n\n**通量边界与条件：**\n3. $0 \\le v_{in} \\le R_{max}$\n4. $0 \\le v_{pump} \\le U_{pump}$\n5. $v_{ATP} \\ge 0$\n6. $v_{leak} = L$\n7. $v_{sink} \\ge 0$\n\n任务是最大化目标函数 $f(v) = v_{ATP}$。\n\n我们将通过简化约束系统来解析地解决这个问题。\n\n从平衡(1)和约束(7)，我们推导出 $v_{sink} = v_{in} - v_{pump} \\ge 0$，这意味着一个重要的耦合关系：$v_{in} \\ge v_{pump}$。将其与约束(3)结合，我们发现 $v_{pump} \\le v_{in} \\le R_{max}$，这就确立了泵送通量的上限：$v_{pump} \\le R_{max}$。\n\n从平衡(2)和条件(6)，我们将 $v_{ATP}$ 表示为 $v_{pump}$ 的函数：\n$p \\cdot v_{ATP} = s \\cdot v_{pump} - v_{leak} = s \\cdot v_{pump} - L$。\n对于一个物理上有意义的问题，ATP的合成需要质子动力势，因此参数 $p$（每个ATP所需的质子数）必须严格为正，即 $p > 0$。所有提供的测试案例都满足此条件。在这个必要假设下，我们可以写出：\n$$v_{ATP} = \\frac{s \\cdot v_{pump} - L}{p}$$\n\n目标是最大化 $v_{ATP}$。由于参数 $s$ 和 $p$ 是正常数，最大化 $v_{ATP}$ 等价于最大化通量 $v_{pump}$。问题因此简化为寻找 $v_{pump}$ 的最大可行值。\n\n让我们整合所有关于 $v_{pump}$ 的约束：\na. 根据约束(4)，$0 \\le v_{pump} \\le U_{pump}$。\nb. 根据从约束(1)、(3)和(7)的推导，$v_{pump} \\le R_{max}$。\nc. 根据约束(5)，$v_{ATP} \\ge 0$，这意味着 $\\frac{s \\cdot v_{pump} - L}{p} \\ge 0$。在 $p>0$ 和 $s>0$（对于一个功能正常的泵来说是这样）的情况下，这简化为 $s \\cdot v_{pump} - L \\ge 0$，即 $v_{pump} \\ge \\frac{L}{s}$。\n\n综合这些， $v_{pump}$ 的可行范围是：\n$$ \\frac{L}{s} \\le v_{pump} \\le \\min(U_{pump}, R_{max}) $$\n\n为了存在一个可行的稳态解，这个区间必须非空。这要求下界小于或等于上界：\n$$ \\frac{L}{s} \\le \\min(U_{pump}, R_{max}) $$\n\n如果这个条件被违反，约束就是矛盾的，导致系统不可行。在这种情况下，不存在稳态解，指定的输出为 $-1.0$。\n\n如果条件满足，则存在一个可行的通量集。为了最大化 $v_{pump}$（从而最大化 $v_{ATP}$），我们必须从其可行范围中选择最大值。设这个最优通量为 $v_{pump}^\\star$：\n$$ v_{pump}^\\star = \\min(U_{pump}, R_{max}) $$\n这个值代表了通过质子泵的有效最大通量，其瓶颈要么是还原当量的可用性（受 $R_{max}$ 限制），要么是泵本身的内在能力（受 $U_{pump}$ 限制）。\n\n接着，通过将 $v_{pump}^\\star$ 代入推导出的 $v_{ATP}$ 表达式中，计算出最大ATP生产速率 $v_{ATP}^\\star$：\n$$ v_{ATP}^\\star = \\frac{s \\cdot v_{pump}^\\star - L}{p} = \\frac{s \\cdot \\min(U_{pump}, R_{max}) - L}{p} $$\n这个最终表达式为计算每个参数集所需的值提供了一个直接的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum feasible ATP production rate for a series of metabolic models.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (R_max, U_pump, s, p, L)\n    test_cases = [\n        (10, 8, 10, 4, 0),\n        (10, 8, 10, 4, 10),\n        (10, 8, 10, 4, 85),\n        (5, 100, 10, 4, 10),\n        (12, 12, 10, 3.67, 0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_max, U_pump, s, p, L = case\n\n        # The maximum possible flux through the pump is limited by the supply of\n        # reducing equivalents (R_max) and the pump's own capacity (U_pump).\n        v_pump_effective_max = min(R_max, U_pump)\n\n        # For ATP synthesis to be non-negative (v_ATP >= 0), the proton pumping\n        # rate must be sufficient to overcome the passive proton leak (L).\n        # The condition is s * v_pump - L >= 0.\n        # This gives a minimum required v_pump.\n        # We must handle the case s=0 to avoid division by zero.\n        # If s=0 and L>0, the condition can never be met, so it's infeasible.\n        # If s=0 and L=0, the condition becomes 0 >= 0, and v_pump_min_req is 0.\n        if s == 0:\n            if L > 0:\n                # Infeasible if pump doesn't work but there is a leak\n                v_pump_min_req = float('inf')\n            else:\n                # No leak, no pumping needed to overcome it\n                v_pump_min_req = 0.0\n        else:\n            v_pump_min_req = L / s\n\n        # A steady-state solution is feasible only if the maximum possible pump flux\n        # is greater than or equal to the minimum required pump flux.\n        if v_pump_effective_max >= v_pump_min_req:\n            # If feasible, we maximize v_ATP by maximizing v_pump.\n            # The optimal v_pump is its effective maximum value.\n            v_pump_star = v_pump_effective_max\n            \n            # The parameter p must be > 0 for ATP synthesis to be well-defined.\n            # The problem context and test cases imply p > 0.\n            if p > 0:\n                v_atp_star = (s * v_pump_star - L) / p\n            else:\n                # If p=0, ATP can be produced 'for free'.\n                # If s*v_pump_star - L == 0, v_ATP is not constrained.\n                # If s*v_pump_star - L != 0, it's a contradiction.\n                # This case represents a poorly defined model, but we can treat v_ATP as 0\n                # or infeasible. Problem statement implies p > 0.\n                v_atp_star = -1.0 # Fallback for malformed problem not in tests.\n            \n            results.append(v_atp_star)\n        else:\n            # If the constraints cannot be simultaneously satisfied, the system is infeasible.\n            results.append(-1.0)\n    \n    # Format results to six decimal places as specified.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2404803"}]}