{"hands_on_practices": [{"introduction": "基于规则的建模之所以强大，在于它能有效处理那些具有海量潜在分子种类的系统。本练习将通过一个简单的组合计数任务，让您亲身体会这种“组合爆炸”的威力。我们将计算一个带有多个修饰位点的蛋白质可能存在的状态总数，从而揭示为何在许多生物系统中，逐一列举所有分子种类是不切实际甚至是不可能的。[@problem_id:4384749]", "problem": "在基于规则的生物化学网络建模中，例如在那些定义了带有内部状态位点的分子的语言中，单个单体的微观状态被定义为其所有标记位点的内部状态的完全赋值。考虑一个单体种类，它有 $k$ 个标记的磷酸化位点，表示为 $(y_1, y_2, \\dots, y_k)$，每个位点的内部状态取自二元字母表 $\\{U, P\\}$，其中 $U$ 表示未磷酸化，$P$ 表示磷酸化。假设这些位点是可区分的（已标记），并且在没有约束的情况下，它们的内部状态是相互独立的。从组合数学中的基本计数原理和微观状态作为位点状态的完全赋值的定义出发，推导出不同微观状态的总数，作为 $k$ 的函数。然后，引入一个表示耦合规则 $y_2 = y_1$ 的结构约束，即位点 $y_1$ 和 $y_2$ 被约束为始终具有相同的内部状态，并在此约束下推导出新的不同微观状态的总数，作为 $k$ 的函数。以 $k$ 的简化闭式表达式形式给出这两个计数。不需要进行数值计算，也不涉及单位。将你的最终答案以单行矩阵中的两个表达式的形式陈述。", "solution": "该问题陈述被评估为有效。它在科学上基于组合系统生物学的原理，问题定义良好，具有明确的定义和目标，并以客观、正式的语言表述。它是基本计数原理在有约束和无约束两种情况下，对一个已定义状态空间的直接应用。\n\n任务是为一个具有 $k$ 个可区分磷酸化位点 $(y_1, y_2, \\dots, y_k)$ 的单体推导出不同微观状态的总数。每个位点可以处于两种内部状态之一，属于集合 $S = \\{U, P\\}$。一个微观状态被定义为对所有 $k$ 个位点的状态的完全赋值。我们必须针对两种情况进行推导：第一种情况是无约束，第二种情况是位点 $y_1$ 和 $y_2$ 必须具有相同状态的约束。\n\n设 $N_{unc}$ 为无约束微观状态的总数，$N_{con}$ 为有约束微观状态的总数。\n\n**第一部分：无约束微观状态数 ($N_{unc}$) 的推导**\n\n一个微观状态形式上是一个有序 $k$-元组 $(s_1, s_2, \\dots, s_k)$，其中 $s_i$ 是位点 $y_i$ 的状态，且 $s_i \\in S = \\{U, P\\}$。任何给定可能状态的数量为 $|S| = 2$。\n\n这些位点是标记的，因此是可区分的。在没有约束的情况下，每个位点的状态选择都与其他位点无关。我们可以应用基本计数原理（也称为乘法法则）来确定可能组合的总数。\n\n对于第一个位点 $y_1$，有 $2$ 种可能的状态。\n对于第二个位点 $y_2$，有 $2$ 种可能的状态。\n对于所有 $k$ 个位点都是如此。\n对于第 $k$ 个位点 $y_k$，有 $2$ 种可能的状态。\n\n不同微观状态的总数 $N_{unc}$ 是每个位点选择数的乘积：\n$$N_{unc} = \\underbrace{2 \\times 2 \\times \\dots \\times 2}_{k \\text{ factors}}$$\n这个乘积表示为幂运算：\n$$N_{unc} = 2^k$$\n这是笛卡尔积空间 $S^k = S \\times S \\times \\dots \\times S$（$k$ 次）中元素的总数，其中 $|S^k| = |S|^k = 2^k$。\n\n**第二部分：有约束微观状态数 ($N_{con}$) 的推导**\n\n接下来，我们引入结构约束 $y_2 = y_1$。这个约束意味着位点 $y_2$ 的状态不再独立，而是由位点 $y_1$ 的状态决定。为了使这个约束有明确的定义，该单体必须至少有两个位点，因此我们假设 $k \\ge 2$。\n\n我们再次使用基本计数原理，但这次要考虑依赖关系。\n允许的微观状态集合是 $S^k$ 的一个子集，定义为 $\\{(s_1, s_2, \\dots, s_k) \\in S^k \\mid s_2 = s_1\\}$。\n\n让我们来计算在这个规则下形成一个有效微观状态的方法数：\n1.  对于第一个位点 $y_1$，其状态仍有 $2$ 个独立的选择，$s_1 \\in \\{U, P\\}$。\n2.  对于第二个位点 $y_2$，约束 $y_2 = y_1$ 规定了其状态 $s_2$ 必须与 $s_1$ 相同。因此，一旦 $s_1$ 被选定，$s_2$ 就只有 $1$ 种可能的选择。\n3.  对于剩下的 $k-2$ 个位点 $y_3, y_4, \\dots, y_k$，它们的状态不受此约束影响。这些位点中的每一个都可以独立地处于 $2$ 种状态中的任意一种。\n\n在此约束下，不同微观状态的总数 $N_{con}$ 是系统各独立部分选择数的乘积：\n$$N_{con} = (\\text{choices for } y_1) \\times (\\text{choices for } y_2) \\times (\\text{choices for } y_3, \\dots, y_k)$$\n$$N_{con} = 2 \\times 1 \\times \\underbrace{(2 \\times 2 \\times \\dots \\times 2)}_{k-2 \\text{ factors}}$$\n简化后得到：\n$$N_{con} = 2 \\times 1 \\times 2^{k-2}$$\n$$N_{con} = 2^{1 + (k-2)} = 2^{k-1}$$\n实际上，该约束将位点 $y_1$ 和 $y_2$ 合并成一个单一的复合实体，该实体有 $2$ 种可能的状态（要么都是 $U$，要么都是 $P$）。这个复合实体与其他 $k-2$ 个独立位点一起，构成了一个包含 $1 + (k-2) = k-1$ 个独立单元的系统，每个单元有 $2$ 种状态。因此，微观状态的总数是 $2^{k-1}$。\n\n推导出的两个表达式分别是：无约束情况下的 $2^k$ 和有约束情况下的 $2^{k-1}$。", "answer": "$$\\boxed{\\begin{pmatrix} 2^k & 2^{k-1} \\end{pmatrix}}$$", "id": "4384749"}, {"introduction": "理解了为何需要基于规则的建模后，下一步是探究其模拟机制。许多基于规则的模型依赖于对单个分子进行操作的随机模拟算法（Stochastic Simulation Algorithm, SSA）。本练习旨在搭建起宏观世界与微观世界之间的桥梁：您将学习如何将在确定性模型中常用的宏观反应速率常数（单位如 $\\mathrm{M^{-1}\\,s^{-1}}$）转换为随机模拟中必需的微观速率常数（单位为 $\\mathrm{s^{-1}}$）。掌握这一转换是构建和正确解释随机模型的关键一步。[@problem_id:4384735]", "problem": "在系统生物医学中使用的基于规则的生物分子结合模型中，考虑物种 $A$ 和 $B$ 之间的单价结合反应。该反应被编码为一条规则：当 $A$ 的结合位点和 $B$ 的结合位点匹配时，生成复合物 $A:B$。在确定性质量作用描述中，宏观结合速率常数为 $k_{\\text{on}}$，单位为 $\\mathrm{M^{-1}\\,s^{-1}}$，在充分混合的体积 $V$ 中，由该反应引起的 $A$ 浓度的变化率由质量作用定律给出。在随机模拟算法（SSA；Gillespie 随机模拟算法）中，不同反应物的反应倾向性建模为 $a(n_A,n_B)=c_{\\text{on}}\\,n_A\\,n_B$，其中 $n_A$ 和 $n_B$ 是分子数，$c_{\\text{on}}$ 是随机速率常数，单位为 $\\mathrm{s^{-1}}$。\n\n从基本的质量作用动力学和以分子数表示的浓度定义出发，推导 $c_{\\text{on}}$ 关于 $k_{\\text{on}}$、体积 $V$ 和阿伏伽德罗常数 $N_A$ 的表达式。然后，对 $V=1\\,\\mathrm{fL}$（其中 $1\\,\\mathrm{fL}=10^{-15}\\,\\mathrm{L}$）、$k_{\\text{on}}=10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$ 和 $N_A=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$，数值计算 $c_{\\text{on}}$ 的值。将最终数值结果四舍五入至四位有效数字，并以 $\\mathrm{s^{-1}}$ 为单位表示。", "solution": "题目要求推导随机速率常数 $c_{\\text{on}}$ 关于宏观速率常数 $k_{\\text{on}}$、系统体积 $V$ 和阿伏伽德罗常数 $N_A$ 的表达式。随后，需要用一组给定参数对该表达式进行求值。\n\n首先，我们对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 反应类型：物种 $A$ 和 $B$ 之间发生单价结合，形成复合物 $A:B$。\n- 确定性模型：质量作用动力学。\n- 宏观结合速率常数：$k_{\\text{on}}$，单位为 $\\mathrm{M^{-1}\\,s^{-1}}$。\n- $A$ 的浓度变化率遵循质量作用定律。\n- 系统体积：$V$。\n- 随机模型：随机模拟算法（SSA）。\n- 不同反应物的反应倾向性：$a(n_A,n_B)=c_{\\text{on}}\\,n_A\\,n_B$。\n- 分子数：$n_A$ 和 $n_B$。\n- 随机速率常数：$c_{\\text{on}}$，单位为 $\\mathrm{s^{-1}}$。\n- 用于求值的数值：$V=1\\,\\mathrm{fL}$（$1\\,\\mathrm{fL}=10^{-15}\\,\\mathrm{L}$）、$k_{\\text{on}}=10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$ 和 $N_A=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$。\n- 四舍五入要求：最终数值结果保留四位有效数字。\n- 单位要求：最终答案以 $\\mathrm{s^{-1}}$ 为单位。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它描述了系统生物学和化学物理学中一个标准且基本的过程，用于关联化学反应的确定性（连续）描述和随机（粒子）描述。质量作用定律和 Gillespie SSA 分别是各自领域内的基石模型。所有参数和常数都定义清晰，单位一致。所提供的体积、速率常数和阿伏伽德罗常数的值都是标准且符合物理实际的。该问题自成体系，没有矛盾或含糊之处。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n### $c_{\\text{on}}$ 表达式的推导\n\n推导过程通过将确定性速率方程与随机模型的期望速率相关联来进行。\n\n1.  **确定性表述：**\n    反应为 $A + B \\xrightarrow{k_{\\text{on}}} A:B$。根据质量作用定律，物种 $A$ 浓度（记为 $[A]$）的变化率由下式给出：\n    $$ \\frac{d[A]}{dt} = -k_{\\text{on}}[A][B] $$\n    浓度的单位是摩尔浓度（$M$），即摩尔/升（$\\mathrm{mol\\,L^{-1}}$）。$k_{\\text{on}}$ 的单位是 $\\mathrm{M^{-1}\\,s^{-1}}$。\n\n2.  **关联浓度与分子数：**\n    物种 $X$ 的浓度 $[X]$ 可以用体积 $V$ 中的分子数 $n_X$ 来表示。物质的量是分子数除以阿伏伽德罗常数 $N_A$。因此，\n    $$ [X] = \\frac{\\text{moles of } X}{\\text{Volume}} = \\frac{n_X / N_A}{V} = \\frac{n_X}{N_A V} $$\n    此处，$V$ 的单位必须是升，以与摩尔浓度的单位保持一致。\n\n3.  **重构速率方程：**\n    我们将以分子数表示的浓度表达式代入确定性速率方程中。\n    $$ \\frac{d}{dt}\\left(\\frac{n_A}{N_A V}\\right) = -k_{\\text{on}}\\left(\\frac{n_A}{N_A V}\\right)\\left(\\frac{n_B}{N_A V}\\right) $$\n    假设体积 $V$ 和 $N_A$ 是常数，我们可以将它们移到导数符号外面：\n    $$ \\frac{1}{N_A V} \\frac{dn_A}{dt} = -k_{\\text{on}} \\frac{n_A n_B}{(N_A V)^2} $$\n    现在，我们求解 $A$ 的分子数变化率 $\\frac{dn_A}{dt}$：\n    $$ \\frac{dn_A}{dt} = -(N_A V) \\left( k_{\\text{on}} \\frac{n_A n_B}{(N_A V)^2} \\right) = -\\frac{k_{\\text{on}}}{N_A V} n_A n_B $$\n    该方程描述了在确定性（连续）近似下 $A$ 的分子数变化率。\n\n4.  **随机表述：**\n    在随机模拟算法（SSA）中，下一个无穷小时间间隔 $dt$ 内发生反应的概率由 $a\\,dt$ 给出，其中 $a$ 是反应倾向性。对于两个不同物种 $A$ 和 $B$ 之间的双分子反应，其倾向性为：\n    $$ a(n_A, n_B) = c_{\\text{on}} n_A n_B $$\n    每当该反应发生一次，$A$ 的分子数就减少 1。因此，在随机模型中 $n_A$ 的期望变化率是倾向性函数的负值：\n    $$ E\\left[\\frac{dn_A}{dt}\\right] = -a(n_A, n_B) = -c_{\\text{on}} n_A n_B $$\n\n5.  **联立两种表述：**\n    为了找到 $k_{\\text{on}}$ 和 $c_{\\text{on}}$ 之间的关系，我们将确定性模型的速率与随机模型的期望速率相等。这在热力学极限下是有效的，此时确定性方程描述了随机过程均值的演化。\n    $$ -\\frac{k_{\\text{on}}}{N_A V} n_A n_B = -c_{\\text{on}} n_A n_B $$\n    从两边消去公因子 $-n_A n_B$，我们得到 $c_{\\text{on}}$ 的表达式：\n    $$ c_{\\text{on}} = \\frac{k_{\\text{on}}}{N_A V} $$\n    快速检查单位可以验证该表达式。已知 $k_{\\text{on}}$ 的单位是 $\\mathrm{M^{-1}\\,s^{-1}}$（即 $\\mathrm{L\\,mol^{-1}\\,s^{-1}}$），$N_A$ 的单位是 $\\mathrm{mol^{-1}}$，$V$ 的单位是 $\\mathrm{L}$：\n    $$ \\text{units of } c_{\\text{on}} = \\frac{\\mathrm{L\\,mol^{-1}\\,s^{-1}}}{(\\mathrm{mol^{-1}}) (\\mathrm{L})} = \\mathrm{s^{-1}} $$\n    这与随机速率常数的指定单位相符。\n\n### 数值计算\n\n我们被给予以下数值：\n- $k_{\\text{on}} = 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}} = 10^{6}\\,\\mathrm{L\\,mol^{-1}\\,s^{-1}}$\n- $V = 1\\,\\mathrm{fL} = 1 \\times 10^{-15}\\,\\mathrm{L}$\n- $N_A = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$\n\n将这些值代入推导出的表达式：\n$$ c_{\\text{on}} = \\frac{10^{6}\\,\\mathrm{L\\,mol^{-1}\\,s^{-1}}}{(6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}) \\times (10^{-15}\\,\\mathrm{L})} $$\n$$ c_{\\text{on}} = \\frac{10^{6}}{6.02214076 \\times 10^{23-15}}\\,\\mathrm{s^{-1}} $$\n$$ c_{\\text{on}} = \\frac{10^{6}}{6.02214076 \\times 10^{8}}\\,\\mathrm{s^{-1}} $$\n$$ c_{\\text{on}} = \\frac{1}{6.02214076 \\times 10^{2}}\\,\\mathrm{s^{-1}} $$\n$$ c_{\\text{on}} = \\frac{1}{602.214076}\\,\\mathrm{s^{-1}} $$\n$$ c_{\\text{on}} \\approx 0.00166053878\\,\\mathrm{s^{-1}} $$\n题目要求将最终结果四舍五入到四位有效数字。前四位有效数字是 1、6、6、0。第五位是 5，所以我们将第四位数字向上取整。\n$$ c_{\\text{on}} \\approx 0.001661\\,\\mathrm{s^{-1}} $$\n用科学记数法表示，即为 $1.661 \\times 10^{-3}\\,\\mathrm{s^{-1}}$。", "answer": "$$\\boxed{1.661 \\times 10^{-3}}$$", "id": "4384735"}, {"introduction": "在掌握了概念和技术基础之后，最后的这项实践将把这些原理应用于一个经典的生物学场景：竞争性结合。您将从基本原理出发，构建一个数学模型来分析抑制剂如何影响目标蛋白与受体的结合。这项练习不仅展示了如何将生物学知识转化为可执行的定量模型，还演示了如何利用模型进行预测，例如计算半数有效浓度（EC50）的偏移，这是系统生物学和药物研发中的一项核心任务。[@problem_id:4384759]", "problem": "构建一个完整、可运行的程序，该程序编码生长因子受体结合蛋白$2$ (GRB$2$)和一种抑制性蛋白之间在重叠位点上的竞争性结合，并计算抑制剂浓度如何改变GRB$2$结合的剂量-反应曲线。该生化系统是一个单一的受体群体，每个受体有一个磷酸化酪氨酸位点。该位点可以处于三种相互排斥的状态之一：未结合、与GRB$2$结合或与抑制剂结合。建模必须是基于规则的：状态变化由结合和解离规则控制，这些规则实现了同一位点被占用的相互排斥性。使用以下基本原理。\n\n- 质量作用动力学，用于双分子结合和单分子解离，具有结合速率常数和解离速率常数。\n- 在热力学平衡状态下，复合物浓度与反应物浓度乘积之比等于解离常数的倒数（平衡质量作用定律）。\n- 每种分子种类的质量守恒。\n\n基于这些原理，推导一个平衡模型，该模型包含一个总浓度为$R_{\\text{tot}}$（单位为纳摩尔）的单一受体群体、一个总浓度为$G_{\\text{tot}}$（单位为纳摩尔）的GRB$2$池，以及一个总浓度为$I_{\\text{tot}}$（单位为纳摩尔）的抑制剂池。令$K_{D,G}$和$K_{D,I}$分别表示GRB$2$和抑制剂与受体位点结合的解离常数（单位为纳摩尔）。结合规则是相互排斥的，因为它们作用于同一个位点：与GRB$2$结合的受体不能结合抑制剂，反之亦然。目标是计算在平衡状态下，GRB$2$结合的受体比例等于$0.5$时的GRB$2$总浓度$G_{\\text{tot}}^{\\ast}$（即GRB$2$剂量-反应曲线的半最大效应点，也称为半数有效浓度，缩写为EC$50$），并针对几种不同的抑制剂条件进行计算。\n\n您的程序必须：\n\n- 从质量作用平衡关系和守恒定律出发，不假设任何预先推导的竞争性结合的简化公式。\n- 对于每组指定的参数，计算使平衡时GRB$2$结合的受体比例恰好为$0.5$的$G_{\\text{tot}}^{\\ast}$值。\n- 使用稳健的数值方法求解由结合规则和守恒约束所隐含的非线性代数系统。所有浓度都必须以纳摩尔为单位处理。不涉及角度。不应打印百分比；当提到分数（如$0.5$）时，必须使用小数形式。\n- 以纳摩尔为单位表示每个最终的EC$50$值$G_{\\text{tot}}^{\\ast}$，并四舍五入到$6$位小数。\n\n需要在程序中编码的建模细节：\n\n- 物种和总量（单位为纳摩尔）：游离受体$R$，受体–GRB$2$复合物$RG$，受体–抑制剂复合物$RI$，游离GRB$2$$g$，游离抑制剂$i$，总量分别为$R_{\\text{tot}}$，$G_{\\text{tot}}$，$I_{\\text{tot}}$。\n- 来自质量作用的平衡关系：$RG = \\dfrac{R \\, g}{K_{D,G}}$ 和 $RI = \\dfrac{R \\, i}{K_{D,I}}$。\n- 守恒关系：$R_{\\text{tot}} = R + RG + RI$，$G_{\\text{tot}} = g + RG$，$I_{\\text{tot}} = i + RI$。\n- 目标响应是GRB$2$结合的受体比例，定义为$f_G = \\dfrac{RG}{R_{\\text{tot}}}$。\n- EC$50$ $G_{\\text{tot}}^{\\ast}$定义为$f_G(G_{\\text{tot}}^{\\ast}; R_{\\text{tot}}, K_{D,G}, K_{D,I}, I_{\\text{tot}}) = 0.5$。\n\n测试套件和要求的输出：\n\n使用以下参数集，每个参数集以有序元组$\\left(R_{\\text{tot}}, K_{D,G}, K_{D,I}, I_{\\text{tot}}\\right)$的形式给出，单位为纳摩尔：\n\n- 情况1：$\\left(10, 30, 30, 0\\right)$。\n- 情况2：$\\left(10, 30, 30, 30\\right)$。\n- 情况3：$\\left(10, 30, 3, 10\\right)$。\n- 情况4：$\\left(100, 10, 10, 10\\right)$。\n- 情况5：$\\left(10, 5, 0.5, 100\\right)$。\n\n对于每种情况，计算EC$50$值$G_{\\text{tot}}^{\\ast}$（单位为纳摩尔）。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个值都四舍五入到$6$位小数，例如$\\left[\\text{result}_1,\\text{result}_2,\\dots\\right]$。", "solution": "用户希望计算在存在竞争性抑制剂的情况下，GRB$2$与受体结合的半数最大效应浓度（EC$50$）。EC$50$定义为使GRB$2$结合的受体比例恰好为$0.5$时的总GRB$2$浓度，记为$G_{\\text{tot}}^{\\ast}$。解决方案必须从质量作用动力学和质量守恒的基本原理推导得出，并且底层的非线性系统必须通过数值方法求解。\n\n该生化系统由受体（$R$）、GRB$2$（$G$）和抑制剂（$I$）组成。受体有一个单一的结合位点，该位点可以处于未结合状态、与GRB$2$结合（形成复合物$RG$）或与抑制剂结合（形成复合物$RI$）。\n\n系统在平衡时的状态由以下方程组描述，如问题陈述中所提供：\n\n1.  **平衡关系（来自质量作用定律）：** 这些描述了每个结合反应中结合与解离之间的平衡。$K_{D,G}$和$K_{D,I}$是解离常数。\n    $$RG = \\frac{R \\cdot g}{K_{D,G}}$$\n    $$RI = \\frac{R \\cdot i}{K_{D,I}}$$\n    此处，$R$、$g$和$i$分别是游离受体、游离GRB$2$和游离抑制剂的平衡浓度。$RG$和$RI$是受体-GRB$2$和受体-抑制剂复合物的浓度。\n\n2.  **质量守恒：** 这些表明每种物质的总量是恒定的。\n    $$R_{\\text{tot}} = R + RG + RI$$\n    $$G_{\\text{tot}} = g + RG$$\n    $$I_{\\text{tot}} = i + RI$$\n    此处，$R_{\\text{tot}}$、$G_{\\text{tot}}$和$I_{\\text{tot}}$是总浓度。\n\n问题是要找到满足以下条件的特定值$G_{\\text{tot}} = G_{\\text{tot}}^{\\ast}$：\n$$f_G = \\frac{RG}{R_{\\text{tot}}} = 0.5$$\n\n这是一个求根问题。我们寻求求解方程$F(G_{\\text{tot}}) = 0$的值$G_{\\text{tot}}^{\\ast}$，其中目标函数$F$定义为：\n$$F(G_{\\text{tot}}) = \\frac{RG(G_{\\text{tot}})}{R_{\\text{tot}}} - 0.5$$\n符号$RG(G_{\\text{tot}})$强调了复合物$RG$的平衡浓度取决于系统中GRB$2$的总量。\n\n为了对给定的$G_{\\text{tot}}$值求出函数$F(G_{\\text{tot}})$的值，我们必须首先求解由五个平衡和守恒方程组成的方程组，以找到对应的$RG$值。该系统可以简化为只含一个变量的非线性方程。一个方便的选择是使用游离受体浓度$R$作为该变量。\n\n首先，我们使用守恒定律将游离浓度$g$和$i$表示为总浓度和复合物浓度的函数：\n$$g = G_{\\text{tot}} - RG$$\n$$i = I_{\\text{tot}} - RI$$\n\n接下来，我们将这些表达式代入平衡关系，以用$R$和总浓度表示复合物浓度：\n$$RG K_{D,G} = R(G_{\\text{tot}} - RG) \\implies RG(K_{D,G} + R) = R \\cdot G_{\\text{tot}} \\implies RG = \\frac{R \\cdot G_{\\text{tot}}}{K_{D,G} + R}$$\n$$RI K_{D,I} = R(I_{\\text{tot}} - RI) \\implies RI(K_{D,I} + R) = R \\cdot I_{\\text{tot}} \\implies RI = \\frac{R \\cdot I_{\\text{tot}}}{K_{D,I} + R}$$\n\n现在，我们将$RG$和$RI$的这些表达式代入受体守恒定律：\n$$R_{\\text{tot}} = R + \\frac{R \\cdot G_{\\text{tot}}}{K_{D,G} + R} + \\frac{R \\cdot I_{\\text{tot}}}{K_{D,I} + R}$$\n该方程可以重排为一个关于$R$的函数，对于给定的总浓度和常数集，我们必须找到它的根。让我们将这个内层问题定义为求解$H(R) = 0$：\n$$H(R; G_{\\text{tot}}, I_{\\text{tot}}, \\dots) = R + \\frac{R \\cdot G_{\\text{tot}}}{K_{D,G} + R} + \\frac{R \\cdot I_{\\text{tot}}}{K_{D,I} + R} - R_{\\text{tot}} = 0$$\n这是一个关于$R$的非线性方程（可以证明它是一个关于$R$的三次多项式）。对于任何具有物理意义的参数集，在区间$[0, R_{\\text{tot}}]$内都存在一个唯一的正实数根$R$。\n\n整体算法设计是一个嵌套的双层数值解法：\n\n1.  **外层：** 使用数值求根算法（例如由`scipy.optimize.root_scalar`提供的布伦特方法）来找到求解$F(G_{\\text{tot}}) = 0$的值$G_{\\text{tot}}^{\\ast}$。这需要为$G_{\\text{tot}}^{\\ast}$设定一个搜索区间，可以保守地设置（例如，从$0$到一个足够大的正数）。\n\n2.  **内层：** 外层求解器对目标函数$F(G_{\\text{tot}})$的每次求值都需要$RG$的值。要计算它，我们必须首先求解内层方程$H(R) = 0$以得到游离受体浓度$R$。这也是使用数值求根器完成的。对$R$的搜索被很好地约束在区间$[0, R_{\\text{tot}}]$内。一旦找到平衡值$R$，就可以使用推导出的表达式计算复合物$RG$的浓度：$RG = \\frac{R \\cdot G_{\\text{tot}}}{K_{D,G} + R}$。\n\n这个数值程序稳健地解决了从第一性原理推导出的完整非线性方程组，从而为测试套件中提供的每组参数确定了EC$50$值$G_{\\text{tot}}^{\\ast}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the EC50 for GRB2 binding in a competitive inhibition model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is an ordered tuple (R_tot, K_D_G, K_D_I, I_tot) in nanomolar.\n    test_cases = [\n        (10, 30, 30, 0),\n        (10, 30, 30, 30),\n        (10, 30, 3, 10),\n        (100, 10, 10, 10),\n        (10, 5, 0.5, 100),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        R_tot, KD_G, KD_I, I_tot = case\n\n        def compute_ec50(R_tot_p, KD_G_p, KD_I_p, I_tot_p):\n            \"\"\"\n            Calculates the EC50 (G_tot_star) for a given set of parameters.\n            This involves a nested numerical solution.\n            \"\"\"\n\n            # Inner function: For a given G_tot, solves for equilibrium R and returns RG.\n            def get_RG_at_equilibrium(G_tot_val):\n                \n                # This is the conservation of receptor equation, H(R) = 0.\n                def find_R_equation(R):\n                    # Physical constraint: concentration cannot be negative.\n                    if R  0:\n                        return np.inf\n\n                    # Expressions for RG and RI in terms of R and total concentrations.\n                    rg_val = (R * G_tot_val) / (KD_G_p + R)\n                    ri_val = (R * I_tot_p) / (KD_I_p + R)\n                    \n                    return R + rg_val + ri_val - R_tot_p\n\n                # Solve for R. The root must be between 0 and R_tot.\n                # H(0) = -R_tot  0. H(R_tot) > 0.\n                # So [0, R_tot] is a valid bracket for the root.\n                # Using a small epsilon to avoid potential issues at exactly 0.\n                sol_R = root_scalar(find_R_equation, bracket=[0, R_tot_p], method='brentq')\n                R_eq = sol_R.root\n                \n                # With the equilibrium R, calculate the corresponding RG concentration.\n                RG_eq = (R_eq * G_tot_val) / (KD_G_p + R_eq)\n                return RG_eq\n\n            # Outer objective function: F(G_tot) = RG(G_tot) / R_tot - 0.5 = 0.\n            def objective_for_G_tot(G_tot_val):\n                # Physical constraint: total concentration cannot be negative.\n                if G_tot_val  0:\n                    return np.inf\n                \n                RG_eq = get_RG_at_equilibrium(G_tot_val)\n                fraction_bound = RG_eq / R_tot_p\n                \n                return fraction_bound - 0.5\n\n            # Solve for G_tot_star.\n            # At G_tot=0, RG=0, so the objective is -0.5.\n            # The function is monotonic, so we just need an upper bound where the objective is positive.\n            # A sufficiently large number will serve as a safe upper bracket.\n            # This estimate is based on typical concentration ranges in such problems.\n            upper_bound_G = 10 * (KD_G_p + R_tot_p + I_tot_p * (KD_G_p / KD_I_p if KD_I_p > 0 else 1) + 1)\n            \n            # Increase bound if initial guess is too small.\n            while objective_for_G_tot(upper_bound_G)  0:\n                upper_bound_G *= 10\n            \n            sol_G_tot = root_scalar(objective_for_G_tot, bracket=[0, upper_bound_G], method='brentq')\n            g_tot_star = sol_G_tot.root\n            \n            return g_tot_star\n\n        # Calculate the result for the current case.\n        result = compute_ec50(R_tot, KD_G, KD_I, I_tot)\n        results.append(result)\n\n    # Format the results for the final output string.\n    # Each value is rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4384759"}]}