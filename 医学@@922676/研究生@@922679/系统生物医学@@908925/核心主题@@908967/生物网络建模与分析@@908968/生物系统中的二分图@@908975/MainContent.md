## 引言
在系统生物学中，许多关键相互作用——如药物与靶点、转录因子与基因——本质上连接着两种截然不同的实体。二部图（Bipartite Graph）为此类“两组分”系统提供了一个强大而精确的数学框架。然而，研究人员在分析时常常忽略其二部特性，将其简化为普通网络，这不仅会丢失关键的机理信息，还可能因投影而产生误导性的拓拓扑假象，从而掩盖了真实的生物学规律。本文旨在弥合这一知识差距，系统性地阐明[二部图](@entry_id:262451)模型的核心价值。

本文将分三部分展开。在“原理与机制”一章中，我们将奠定数学基础，讲解[二部图](@entry_id:262451)的表示法、矩阵形式以及用于揭示网络宏观与微观结构的关键分析技术。接着，在“应用与跨学科连接”一章中，我们将展示这些理论如何转化为解决现实问题的工具，涵盖从[代谢网络建模](@entry_id:273758)到[药物重定位](@entry_id:748682)，再到与流行病学和机器学习的交叉。最后，“动手实践”部分将提供具体的编程练习，帮助读者将理论知识应用于实际数据分析。通过这一结构，读者将全面掌握利用[二部图](@entry_id:262451)解析复杂生物系统的理论与实践。

## 原理与机制

在系统生物学中，许多关键的相互作用本质上是“两组分”的：它们连接了两种不同类型的生物实体。例如，转录因子（Transcription Factors, TFs）与它们调控的基因、药物与它们的靶点蛋白、酶与它们催化的底物、或宿主与感染它们的病原体。对于这类系统，[二部图](@entry_id:262451)（bipartite graph）提供了一个精确且富有洞察力的数学框架，能够捕捉这些关系的内在不对称性，并支持严谨的计算分析。本章将深入探讨[二部图](@entry_id:262451)建[模的基](@entry_id:156416)本原理、数学形式以及用于揭示生物网络结构和功能的关键机制。

### [二部图](@entry_id:262451)的[基本表示](@entry_id:157678)法

一个**二部图**，记为 $G=(U, V, E)$，由两个不相交的节点集 $U$ 和 $V$ 以及一个[边集](@entry_id:267160) $E$ 组成。[二部图](@entry_id:262451)的定义性特征是，它的每一条边都连接一个 $U$ 中的节点和一个 $V$ 中的节点。在图的内部，即 $U$ 内部或 $V$ 内部，不允许有任何边存在。这个简单的约束对于在系统生物学中保持模型的清晰性和机理的保真度至关重要。

考虑一个代谢系统，其中 $U$ 代表酶集合，$V$ 代表小分子底物集合。一条连接酶 $u \in U$ 和底物 $v \in V$ 的边，表示 $u$ 催化涉及 $v$ 的反应。在这种表示法中，酶和底物被放置在不同的节点集合中，这直接反映了它们在生物化学上不同的角色：一个是催化剂，另一个是反应物。通过构造，这种模型禁止了酶-酶或底物-底物之间的直接连接，从而避免了将机理上截然不同的实体混为一谈 [@problem_id:4321174]。

一个常见的替代方法是将这个系统表示为一个“单模”（one-mode）网络，例如，通过连接共享至少一个共同底物的两个酶来构建一个[蛋白质-蛋白质相互作用](@entry_id:271521)（Protein-Protein Interaction, PPI）网络。然而，这种方法会丢失重要信息并引入误导性的拓扑假象。在单模投影中，一条边代表的是一种“共享邻居”的关系，而非直接的生物化学相互作用。例如，如果许多酶都作用于一个常见的、高度连接的底物（如ATP或水，常被称为“货币”底物），这将在单模网络中诱导出大量的酶-酶连接，形成密集的三角形和团块结构。这些结构是投影过程的数学产物，而非酶之间存在直接物理接触或形成功能复合物的证据。因此，与单模投影相比，二部图表示法能够更忠实地保留原始数据的结构和机理特异性 [@problem_id:4321174]。

此外，保留二部结构使得我们能够在分析中有意识地处理这些“货币”底物。由于在二部图中底物是显式节点，我们可以识别并过滤掉那些度非常高的底物节点，从而避免它们在酶之间产生大量虚假的关联。而在单模[PPI网络](@entry_id:271273)中，一旦投影完成，一条边仅仅是一条边，我们无法仅从图的结构中区分这条连接是由一个高度特异性的底物还是一个普遍存在的货币分子所引起的 [@problem_id:4321174]。

在建模工具的选择上，将[二部图](@entry_id:262451)与**[超图](@entry_id:270943)（hypergraph）**进行比较也很有启发性。在[超图](@entry_id:270943)中，一条“超边”可以连接任意数量的节点。对于一个化学反应 $A + B \rightarrow C + D$，可以将其表示为一个从节点集 $\{A, B\}$ 指向 $\{C, D\}$ 的超边。然而，在许多标准的系统生物学分析框架中，如通量平衡分析（Flux Balance Analysis, FBA），其核心是基于质量守恒的[线性方程组](@entry_id:140416)。这些关系由[化学计量系数](@entry_id:204082)精确定义，描述了每个反应事件中每种代谢物数量的离散变化。这种关系本质上是线性的和成对的，即连接一个反应事件和每个参与的代谢物。因此，一个带权重的有向[二部图](@entry_id:262451)（其关联矩阵即为化学计量矩阵）足以完美地捕捉这些线性关系。仅当建模任务需要表达非线性或超越化学计量的更高阶约束时，例如，多个底物的逻辑选择（“或”关系）、不被消耗或产生的变构调节剂，或者需要将一组代谢物的共参与视为一个不可分割的单元的拓扑分析时，超[图表示](@entry_id:273102)法才变得必要 [@problem_id:4321170]。

### 数学形式：矩阵与投影

为了进行计算分析，我们将[二部图](@entry_id:262451)用矩阵语言来描述。给定一个[二部图](@entry_id:262451) $G=(U, V, E)$，其中 $|U|=m$ 和 $|V|=n$，其结构可以由一个 $m \times n$ 的**双[邻接矩阵](@entry_id:151010)（biadjacency matrix）** $B$ 来表示。如果图中存在一条连接节点 $u_i \in U$ 和 $v_j \in V$ 的边，则[矩阵元](@entry_id:186505)素 $B_{ij}$ 通常设为 $1$（对于[无权图](@entry_id:273533)）或边的权重（对于有[权图](@entry_id:204634)）；否则，$B_{ij} = 0$ [@problem_id:4321178]。

整个[二部图](@entry_id:262451)的完整**[邻接矩阵](@entry_id:151010)** $A$ 是一个 $(m+n) \times (m+n)$ 的[分块矩阵](@entry_id:148435)。如果我们先排列 $U$ 中的节点，再排列 $V$ 中的节点，那么 $A$ 的形式为：
$$
A = \begin{pmatrix} 0 & B \\ B^{\top} & 0 \end{pmatrix}
$$
这里的 $0$ 是适当维度的[零矩阵](@entry_id:155836)，$B^{\top}$ 是 $B$ 的[转置](@entry_id:142115)。对角线上的零块强制执行了二部图的约束，即分区内部没有边。非对角线上的 $B$ 和 $B^{\top}$ 块则编码了跨区间的连接。

#### 节点度

一个节点的**度（degree）**是指连接到该节点的边的数量。使用双邻接矩阵 $B$，我们可以简洁地计算出所有节点的度。对于 $U$ 中的一个节点 $u_i$，其度是 $B$ 的第 $i$ 行所有元素的和。因此，包含所有 $U$ 中节点度的向量 $d_U$ 可以通过将 $B$ 乘以一个全为1的列向量 $\mathbf{1}_n$ 来得到：
$$
d_U = B \mathbf{1}_n
$$
同样，对于 $V$ 中的一个节点 $v_j$，其度是 $B$ 的第 $j$ 列所有元素的和，这等价于 $B^{\top}$ 的第 $j$ 行的和。因此，包含所有 $V$ 中节点度的向量 $d_V$ 为：
$$
d_V = B^{\top} \mathbf{1}_m
$$
这些度向量在生物学上具有直接的解释。例如，在一个药物-靶点网络中，其中 $U$ 是药物集，$V$ 是靶点集，$d_U$ 的每个元素表示一种药物作用的靶点数量，这个概念被称为**[多靶点药理学](@entry_id:266182)（polypharmacology）**。相应地，$d_V$ 的每个元素表示一个靶点能被多少种不同的药物作用，这可被视为靶点的**混杂性（promiscuity）**或可药性的一种度量 [@problem_id:4321148]。通过分析这些度向量的统计特性，例如它们的方差，我们可以量化网络中相互作用模式的异质性。

#### 单模投影

如前所述，单模投影是一种常见的[降维](@entry_id:142982)方法，但伴随着信息损失。这种投影在数学上与二部图邻接矩阵的幂密切相关。在任何图中，[邻接矩阵](@entry_id:151010) $A$ 的 $k$ 次幂 $A^k$ 的元素 $(A^k)_{ij}$ 给出了从节点 $i$ 到节点 $j$ 的长度为 $k$ 的路径的数量（或加权和）。在二部图中，长度为2的路径必然连接同一分区中的两个节点（例如，从 $U$ 到 $V$ 再回到 $U$）。

计算 $A^2$ 可以揭示这一点：
$$
A^2 = \begin{pmatrix} 0 & B \\ B^{\top} & 0 \end{pmatrix} \begin{pmatrix} 0 & B \\ B^{\top} & 0 \end{pmatrix} = \begin{pmatrix} BB^{\top} & 0 \\ 0 & B^{\top} B \end{pmatrix}
$$
这个结果非常清晰：$A^2$ 是一个分[块对角矩阵](@entry_id:145530)。
-   **$W_U = BB^{\top}$** 是一个 $m \times m$ 的矩阵，代表到 $U$ 的**单模投影**。其元素 $(W_U)_{ij}$ 是从 $u_i$ 到 $u_j$ 的长度为2的路径数。每条这样的路径都必须通过一个 $V$ 中的共同邻居。因此，$(W_U)_{ij}$ 精确地计算了节点 $u_i$ 和 $u_j$ 共享的 $V$ 中邻居的数量。对角[线元](@entry_id:196833)素 $(W_U)_{ii}$ 等于 $u_i$ 的度。
-   **$W_V = B^{\top}B$** 是一个 $n \times n$ 的矩阵，代表到 $V$ 的单模投影，其元素 $(W_V)_{ij}$ 计算了 $v_i$ 和 $v_j$ 共享的 $U$ 中邻居的数量。

这些投影矩阵在生物学上很有用，因为它们量化了节点间的相似性。例如，在酶-代谢物网络中，$BB^{\top}$ 的一个元素 $(BB^{\top})_{ij}$ 表示酶 $i$ 和酶 $j$ 共同作用的代谢物数量，这可能是它们功能相关的一个指标 [@problem_id:4321150]。

然而，这种简单的投影方式有一个缺点：它平等地对待所有共享的邻居。一个被许多酶共享的“中枢”代谢物会比一个稀有的、特异性的代谢物对投影权重贡献更大，这可能不是我们期望的。为了解决这个问题，可以引入**归一化投影**。一种常见的方法是根据共享邻居的度对其贡献进行加权。例如，可以使用以下形式的归一化投影：
$$
W_U^{\text{norm}} = B D_V^{-1} B^{\top}
$$
其中 $D_V$ 是一个对角矩阵，其对角线元素是 $V$ 中节点的度。在这个公式中，每个共享邻居 $v_k$ 的贡献被其度的倒数 $1/d(v_k)$ 加权。这意味着，与一个高度连接的“中枢”节点共享连接所获得的相似性得分，将低于与一个低度、更具特异性的节点共享连接所得的分数 [@problem_id:4321150]。

### [网络结构分析](@entry_id:276819)：从宏观到微观

装备了二部图的数学形式，我们现在可以探索用于表征其结构特性的分析方法，这些方法涵盖了从网络的宏观整体特性到其微观局部模式的多个尺度。

#### 宏观结构：度分布与[嵌套性](@entry_id:194755)

**度分布**

网络最基本的宏观特征之一是其**度分布**，它描述了随机选择一个节点具有特定度的概率。对于二部图，我们必须区分两个分区的度分布：$P_U(k)$（$U$ 中节点的度分布）和 $P_V(k)$（$V$ 中节点的度分布）。它们的定义为 [@problem_id:4321193]：
$$
P_U(k) = \frac{1}{|U|} \sum_{u \in U} \mathbf{1}\{k_u = k\} \quad \text{和} \quad P_V(k) = \frac{1}{|V|} \sum_{v \in V} \mathbf{1}\{k_v = k\}
$$
其中 $\mathbf{1}\{\cdot\}$ 是指示函数。一个基本的图论属性，即[握手引理](@entry_id:261183)（handshaking lemma），在二部图中意味着 $\sum_{u \in U} k_u = \sum_{v \in V} k_v = |E|$。但这仅仅约束了两个分布的[平均度](@entry_id:261638)（$\langle k \rangle_U = |E|/|U|$ 和 $\langle k \rangle_V = |E|/|V|$），并不意味着它们的形状或尾部行为必须相同 [@problem_id:4321193]。

事实上，这两个分布的形状差异往往能揭示深刻的生物学不对称性。在[转录调控网络](@entry_id:199723)中，$U$ 为转录因子（TFs），$V$ 为基因。通常，$P_U(k)$ 会表现出“[重尾](@entry_id:274276)”或“[长尾](@entry_id:274276)”特性，这意味着存在一些“[主调节子](@entry_id:265566)”能够调控大量基因。相比之下，$P_V(k)$ 的尾部通常较轻，因为大多数基因仅由少数几个特定的TFs[组合调控](@entry_id:147939)。这种分布形状的差异反映了调控网络的层级和功能组织 [@problem_id:4321193]。值得注意的是，实验数据的测量伪影，如随机的边丢失（“稀疏化”），虽然会改变分布的具体参数，但通常会保留其尾部行为的类别（例如，[重尾分布](@entry_id:142737)在稀疏化后仍然是重尾的），这对于从噪声数据中解读结构至关重要 [@problem_id:4321193]。

**[嵌套性](@entry_id:194755)**

另一个关键的宏观结构属性是**[嵌套性](@entry_id:194755)（nestedness）**。一个高度嵌套的网络表现出一种有序的层级结构，其中低度节点（“专家”）的相互作用伙伴往往是高度节点（“多面手”）伙伴的子集。这种结构与**模块化（modularity）**形成对比，在模块化结构中，节点倾向于与特定群组内的其他节点紧密连接，而群组之间连接稀疏。

**基于重叠和递减填充的嵌套度量（NODF, Nestedness metric based on Overlap and Decreasing Fill）** 是一个广泛使用的量化[嵌套性](@entry_id:194755)的指标。计算NODF的步骤如下 [@problem_id:4321162]：
1.  **排序**：分别按度非递增的顺序对矩阵的行（$U$ 中的节点）和列（$V$ 中的节点）进行排序。
2.  **成对计算**：对于每一对度严格递减的行 $(i, i')$（即 $k_i^R > k_{i'}^R$），计算其嵌套贡献 $N_{ii'} = \frac{O_{ii'}^R}{k_{i'}^R}$，其中 $O_{ii'}^R$ 是两行之间的重叠（共享的邻居数），$k_{i'}^R$ 是度较小的行（专家）的度。类似地，为所有度严格递减的列对计算贡献。
3.  **平均**：NODF值是所有这些成对贡献的平均值。

一个高的NOD[F值](@entry_id:178445)（接近1）表示网络具有很强的嵌套结构。在[宿主-病原体相互作用](@entry_id:271586)网络中，这意味着专性病原体（感染少数宿主）所能感染的宿主集合，往往是广谱病原体（感染多种宿主）宿主范围的子集 [@problem_id:4321162]。

#### 微观结构：聚类与基序

**聚类**

在单模网络中，**[聚类系数](@entry_id:144483)（clustering coefficient）**衡量节点的邻居之间相互连接的紧密程度，通常通过计算三角形（3-周期）的密度来度量。然而，在二部图中，所有环路的长度都必须是偶数，因此不存在三角形。这意味着标准的[聚类系数](@entry_id:144483)对于任何二部图都恒为零。

为了在[二部图](@entry_id:262451)中量化类似的概念，我们需要关注最短的环路，即**4-周期**（也称为“正方形”或“方块”）。一个4-周期由两个 $U$ 中的节点和两个 $V$ 中的节点组成，例如 $u_1 \to v_1 \to u_2 \to v_2 \to u_1$。一个节点的**二部[聚类系数](@entry_id:144483)** $C_v$ 定义为经过该节点 $v$ 的4-周期（$C_4$）数量，与以该节点为中心的长度为2的路径数量之比。以节点 $v$ 为中心的长度为2的路径数量等于其邻居对的数量，即 $\binom{k_v}{2}$，其中 $k_v$ 是节点 $v$ 的度。因此，公式为 [@problem_id:4321226]：
$$
C_v = \frac{\text{包含 } v \text{ 的 } C_4 \text{ 数量}}{\binom{k_v}{2}}
$$
这个系数衡量了节点局部邻域中的“冗余”程度，例如，一个代谢物参与的多个反应在多大程度上共享其他代谢物，从而形成紧密的生化途径模块 [@problem_id:4321226]。

**基序**

**网络基序（network motifs）**是小的、在网络中频繁出现的[诱导子图](@entry_id:270312)，其出现频率显著高于在具有相同度分布的随机网络中的频率。它们被认为是网络的基本计算单元。在二部图中，最基本和最重要的连接基序是 [@problem_id:4321215]：
-   **大小为3的基序**：唯一的连接形式是**2-星图 ($K_{1,2}$)**，即一个中心节点连接到两个叶子节点。根据中心节点在 $U$ 还是 $V$ 中，这代表了两种基本的调控模式：一个调控者作用于两个靶标（**共调控**），或两个调控者共同作用于一个靶标（**共结合**）。
-   **大小为4的基序**：主要有两种形式。第一种是**3-星图 ($K_{1,3}$)**，是2-星图的直接扩展。第二种是**4-周期 ($K_{2,2}$)**，即前面讨论过的“正方形”。$K_{2,2}$ 基序代表了一种基本的**[组合调控](@entry_id:147939)**模式，其中两个调控者共同作用于两个靶标。

通过将真实网络中的基序计数与适当的[零模型](@entry_id:181842)（如二部[配对模型](@entry_id:747676)）进行比较，来确定哪些基序是统计上显著富集的，这有助于揭示网络中隐藏的设计原则。

#### 模块化结构：双团

在许多生物网络中，功能模块表现为一组节点，它们彼此之间紧密连接，而与网络的其余部分连接稀疏。在[二部图](@entry_id:262451)中，这种模块的一个理想化形式是**双团（biclique）**，记为 $K_{p,q}$。一个 $K_{p,q}$ 是一个由 $p$ 个 $U$ 中的节点和 $q$ 个 $V$ 中的节点组成的[子图](@entry_id:273342)，其中这 $p$ 个节点中的每一个都与那 $q$ 个节点中的每一个相连 [@problem_id:4321185]。在基因调控网络中，一个双团可以代表一个由 $p$ 个TF协同调控的包含 $q$ 个基因的模块。

寻找双团是识别共调控模块的一种常用策略。然而，一个关键的挑战是区分真正的生物学模块和仅仅由随机连接产生的双团。在一个随机[二部图](@entry_id:262451)（例如，每个可能的边以概率 $p_0$ 独立出现的Erdős–Rényi模型）中，偶然形成一个 $K_{p,q}$ 的概率虽然很小，但由于可能的候选[子图](@entry_id:273342)数量巨大（$\binom{m}{p}\binom{n}{q}$），随机双团的预期数量可能并不可忽略 [@problem_id:4321185]。例如，在一个包含100个TF和1000个基因的网络中，即使[边密度](@entry_id:271104)只有 $1\%$，我们仍然期望仅凭偶然就能找到接近一个完整的 $K_{2,3}$ 双团。

这突出表明，在声明发现一个有意义的模块之前，必须进行严格的**统计显著性检验**。由于通常会同时测试数百万个潜在的双团，**[多重假设检验](@entry_id:171420)校正**是必不可少的。像**[Bonferroni校正](@entry_id:261239)**（控制族错率 FWER）或更强大的**[Benjamini-Hochberg程序](@entry_id:171997)**（控制错误发现率 FDR）等方法被用来确保我们发现的模块的可靠性 [@problem_id:4321185]。

总之，二部图为系统生物学中的两组分系统提供了一个强大而严谨的框架。通过理解其基本原理、数学表示以及分析其宏观和微观结构的方法——从度分布、[嵌套性](@entry_id:194755)到聚类、基序和双团——研究人员可以从复杂的[高通量数据](@entry_id:275748)中提取出关于生物系统组织和功能的深刻见解。