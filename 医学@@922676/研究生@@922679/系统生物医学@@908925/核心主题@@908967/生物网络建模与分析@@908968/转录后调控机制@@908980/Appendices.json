{"hands_on_practices": [{"introduction": "构建定量模型是系统生物学研究的基石。这个练习将复杂的mRNA生命周期简化为一个可解的数学模型，旨在训练从基本原理出发进行建模和求解的能力。通过推导细胞质中成熟mRNA的稳态丰度[@problem_id:4376249]，我们将揭示一个关于生物稳态的核心原则：在最简单的线性路径中，最终产物的稳态水平仅由总合成速率和总降解速率决定，而与中间步骤的快慢无关。理解这一点为分析更复杂的调控网络提供了重要的概念基础。", "problem": "在系统生物医学框架下，考虑一个单细胞内的双室转录后调控模型。在核室中，新合成的未加工前体信使核糖核酸（pre-mRNA）分子以转录速率 $\\alpha$ （单位：分子/单位时间）产生。这些核内pre-mRNA分子以一级核加工速率 $k_{p}$ （单位：每单位时间）被加工成成熟的核内信使核糖核酸（mRNA）。成熟的核内mRNA以一级输出速率 $k_{e}$ （单位：每单位时间）被输出到细胞质。在细胞质室中，成熟mRNA以一级细胞质降解速率 $\\delta$ （单位：每单位时间）被降解。假设以下基本依据：\n- 分子生物学的中心法则确立了信使核糖核酸（mRNA）由脱氧核糖核酸（DNA）合成，经过加工并输出到细胞质，在细胞质中可以被翻译和降解。\n- 根据质量作用动力学，每个单分子转变的瞬时速率与所涉及的底物物种的丰度成正比，比例常数由速率参数给出。\n\n使用这些依据为核内pre-mRNA、成熟核内mRNA和细胞质成熟mRNA的丰度建立一个动力学系统，将丰度视为绝对分子数。假设所有参数 $\\alpha$、$k_{p}$、$k_{e}$ 和 $\\delta$ 均为正常数，不存在核内降解，且系统达到一个时不变的稳态。\n\n从你构建的质量作用动力学系统出发，推导细胞质成熟mRNA的稳态丰度，将其表示为关于 $\\alpha$、$k_{p}$、$k_{e}$ 和 $\\delta$ 的闭式解析表达式。以分子数表示最终丰度。以单个闭式表达式提供你的答案，且表达式内不应包含单位。无需进行数值计算或四舍五入。", "solution": "该问题要求基于一个双室转录后调控模型，推导细胞质成熟信使核糖核酸（mRNA）的稳态丰度。该问题是有效的，因为它具有分子生物学的科学依据，是适定且客观的。它提供了一套完整的参数和约束来构建一个可解的数学模型。\n\n首先，我们将代表系统中各物种丰度（绝对分子数）的变量定义为时间 $t$ 的函数。\n设 $P(t)$ 为核内pre-mRNA的丰度。\n设 $N(t)$ 为成熟核内mRNA的丰度。\n设 $C(t)$ 为细胞质成熟mRNA的丰度。\n\n问题陈述描述了以下过程，我们基于质量作用动力学原理将其转化为一个常微分方程（ODE）组：\n\n1.  **核内pre-mRNA ($P(t)$):** pre-mRNA以恒定的转录速率 $\\alpha$ 产生。它以一级速率 $k_{p}$ 被加工成成熟核内mRNA而消耗，意味着消耗速率为 $k_{p}P(t)$。问题没有为 $P(t)$ 指定其他产生或消耗项。\n    $P(t)$ 的变化率由下式给出：\n    $$ \\frac{dP}{dt} = \\alpha - k_{p}P(t) $$\n\n2.  **成熟核内mRNA ($N(t)$):** 成熟核内mRNA由pre-mRNA加工产生，速率为 $k_{p}P(t)$。它以一级速率 $k_{e}$ 输出到细胞质而被消耗，意味着消耗速率为 $k_{e}N(t)$。问题陈述假设没有核内降解。\n    $N(t)$ 的变化率由下式给出：\n    $$ \\frac{dN}{dt} = k_{p}P(t) - k_{e}N(t) $$\n\n3.  **细胞质成熟mRNA ($C(t)$):** 细胞质mRNA由成熟核内mRNA输出产生，速率为 $k_{e}N(t)$。它以一级速率 $\\delta$ 降解而被消耗，意味着消耗速率为 $\\delta C(t)$。\n    $C(t)$ 的变化率由下式给出：\n    $$ \\frac{dC}{dt} = k_{e}N(t) - \\delta C(t) $$\n\n问题要求的是稳态丰度。在稳态时，系统是时不变的，这意味着每种物种的变化率都为零。我们将稳态丰度表示为 $P_{ss}$、$N_{ss}$ 和 $C_{ss}$。\n$$ \\frac{dP}{dt} = 0, \\quad \\frac{dN}{dt} = 0, \\quad \\frac{dC}{dt} = 0 $$\n\n我们依次求解所得的代数方程组。\n\n从 $P(t)$ 的方程，我们有：\n$$ 0 = \\alpha - k_{p}P_{ss} $$\n解出 $P_{ss}$ 得：\n$$ k_{p}P_{ss} = \\alpha $$\n$$ P_{ss} = \\frac{\\alpha}{k_{p}} $$\n\n接下来，我们使用 $N(t)$ 的稳态方程：\n$$ 0 = k_{p}P_{ss} - k_{e}N_{ss} $$\n$$ k_{e}N_{ss} = k_{p}P_{ss} $$\n我们代入刚刚求得的 $P_{ss}$ 表达式：\n$$ k_{e}N_{ss} = k_{p}\\left(\\frac{\\alpha}{k_{p}}\\right) = \\alpha $$\n解出 $N_{ss}$ 得：\n$$ N_{ss} = \\frac{\\alpha}{k_{e}} $$\n\n最后，我们使用 $C(t)$ 的稳态方程来求得所求量 $C_{ss}$：\n$$ 0 = k_{e}N_{ss} - \\delta C_{ss} $$\n$$ \\delta C_{ss} = k_{e}N_{ss} $$\n我们代入 $N_{ss}$ 的表达式：\n$$ \\delta C_{ss} = k_{e}\\left(\\frac{\\alpha}{k_{e}}\\right) = \\alpha $$\n解出 $C_{ss}$ 得到细胞质成熟mRNA的稳态丰度：\n$$ C_{ss} = \\frac{\\alpha}{\\delta} $$\n\n这个结果表明，在稳态时，mRNA的总产生速率（$\\alpha$）与总降解速率（$\\delta C_{ss}$）精确平衡。由速率 $k_p$ 和 $k_e$ 控制的中间加工和输出步骤决定了前体物种的稳态水平，但在所指定的途径是线性和不可逆的条件下，它们不影响细胞质mRNA的最终稳态水平。", "answer": "$$\\boxed{\\frac{\\alpha}{\\delta}}$$", "id": "4376249"}, {"introduction": "现代生物学研究已经从单一维度测量转向整合多组学数据。这个练习模拟了一个真实的研究场景，要求你综合运用多种高通量测序数据，包括MeRIP-seq、RNA-seq和核糖体图谱分析，来推断N6-甲基腺苷（$m^6A$）修饰在不同转录本上的具体功能[@problem_id:4376227]。这项练习的核心在于，学习如何建立清晰、可量化的标准，以区分$m^6A$是通过影响mRNA的稳定性还是翻译效率来发挥作用，从而将原始数据转化为可靠的机理假设。", "problem": "一个研究团队通过急性抑制甲基转移酶样蛋白$3$ (METTL$3$)来扰动N6-甲基腺苷 (m6A) 的修饰，并使用甲基化RNA免疫沉淀测序 (MeRIP-seq)、RNA测序 (RNA-seq) 和核糖体分析来估计信使RNA (mRNA) 的翻译效率 (TE)。所有变化均以METTL$3$抑制条件相对于对照组的$\\log_2$倍数变化报告，mRNA半衰期$t_{1/2}$通过代谢标记法测量。您可以假设，稳态mRNA丰度的转录后调控主要由降解动力学决定，并且翻译效率被估计为核糖体保护片段与mRNA丰度的比率。四个转录本 (X, Y, Z, W) 各自含有一个主要的m6A峰，其特征如下：\n- 转录本X：峰位置在$3'$非翻译区，MeRIP-seq峰的$\\log_2$倍数变化为$-2.0$；mRNA的$\\log_2$倍数变化为$+0.8$；TE的$\\log_2$倍数变化为$+0.05$；$t_{1/2}$从$3\\,\\mathrm{h}$增加到$5.5\\,\\mathrm{h}$。\n- 转录本Y：峰位置在$5'$非翻译区，MeRIP-seq峰的$\\log_2$倍数变化为$-1.2$；mRNA的$\\log_2$倍数变化为$+0.1$；TE的$\\log_2$倍数变化为$-0.7$；$t_{1/2}$从$4.0\\,\\mathrm{h}$增加到$4.1\\,\\mathrm{h}$。\n- 转录本Z：峰位置在靠近终止密码子的编码序列，MeRIP-seq峰的$\\log_2$倍数变化为$-1.0$；mRNA的$\\log_2$倍数变化为$+0.7$；TE的$\\log_2$倍数变化为$-0.6$；$t_{1/2}$从$2.5\\,\\mathrm{h}$增加到$3.5\\,\\mathrm{h}$。\n- 转录本W：峰位置在$3'$非翻译区，MeRIP-seq峰的$\\log_2$倍数变化为$-0.4$；mRNA的$\\log_2$倍数变化为$0.0$；TE的$\\log_2$倍数变化为$0.0$；$t_{1/2}$保持在$6.0\\,\\mathrm{h}$不变。\n\n根据关于mRNA周转和翻译的第一性原理，选择一个选项，该选项为分类m6A位点主要通过mRNA稳定性还是翻译起作用提出了可辩护的定量标准，并正确地将这些标准应用于X、Y、Z和W。\n\nA. 标准：仅限于m6A严重丢失的转录本（MeRIP-seq的$\\log_2$倍数变化 $\\leq -0.8$）。如果mRNA的$\\log_2$倍数变化 $\\geq +0.5$，TE的$\\log_2$倍数变化在$\\left[-0.2,+0.2\\right]$范围内，并且$t_{1/2}$增加$\\geq 30\\%$，则分类为“稳定性介导”。如果$\\lvert$mRNA的$\\log_2$倍数变化$\\rvert \\leq 0.2$，TE的$\\log_2$倍数变化 $\\leq -0.5$，并且$t_{1/2}$变化在$\\pm 10\\%$范围内，则分类为“翻译介导”。如果同时超过稳定性和翻译的阈值（mRNA的$\\log_2$倍数变化$\\geq +0.5$且TE的$\\log_2$倍数变化$\\leq -0.5$，或$t_{1/2}$增加$\\geq 30\\%$同时TE降低$\\leq -0.5$），则分类为“混合型”。如果MeRIP-seq丢失$>-0.6$或未超过任何阈值，则分类为“无功能性影响”。应用：X稳定性介导；Y翻译介导；Z混合型；W无功能性影响。\n\nB. 标准：仅限于m6A严重丢失的转录本（MeRIP-seq的$\\log_2$倍数变化 $\\leq -0.8$）。如果mRNA的$\\log_2$倍数变化$\\leq -0.5$或$t_{1/2}$减少$\\geq 30\\%$，则分类为“稳定性介导”；如果TE的$\\log_2$倍数变化$\\geq +0.5$且$\\lvert$mRNA的$\\log_2$倍数变化$\\rvert \\leq 0.2$，则分类为“翻译介导”；否则为“无功能性影响”。应用：X翻译介导；Y翻译介导；Z稳定性介导；W无功能性影响。\n\nC. 标准：仅使用峰位置。将任何$3'$非翻译区峰分类为“稳定性介导”，任何$5'$非翻译区峰分类为“翻译介导”，任何靠近终止密码子的编码序列峰分类为“稳定性介导”，而不管mRNA、TE或$t_{1/2}$的倍数变化如何。应用：X稳定性介导；Y翻译介导；Z稳定性介导；W稳定性介导。\n\nD. 标准：通过效应大小进行赢者通吃，不设硬性阈值。计算mRNA和TE的$\\log_2$倍数变化的绝对值；如果$\\lvert$mRNA的$\\log_2$倍数变化$\\rvert > \\lvert$TE的$\\log_2$倍数变化$\\rvert$，则分类为“稳定性介导”，如果相反，则分类为“翻译介导”，如果两者均$\\leq 0.1$，则分类为“无功能性影响”。忽略$t_{1/2}$和MeRIP-seq的大小。应用：X稳定性介导；Y翻译介导；Z稳定性介导；W无功能性影响。", "solution": "该解题过程在于将每个选项中提供的定义系统地应用于转录本X、Y、Z和W的数据。首先，我们必须根据m6A生物学的第一性原理来分析每个转录本的数据。\n\n**第一性原理：**\n扰动是m6A的丢失，因此我们预期其效应会反转。m6A的一个典型作用是招募促进mRNA降解的“阅读器”蛋白。因此，m6A的丢失预计会增加mRNA丰度和半衰期。这是一个**稳定性介导**的效应。\n\nm6A的另一个主要作用是调节翻译。例如，$5^{\\prime}$ UTR中的m6A可以促进帽非依赖性翻译起始。丢失这样一个m6A位点预计会降低翻译效率（TE）。在其他情况下，m6A可以通过促进核糖体停滞或脱落来阻碍翻译。丢失这样一个位点会增加TE。TE的主要变化伴随着mRNA稳定性（半衰期）的微小或无变化，是**翻译介导**的效应。\n\n如果m6A的丢失导致mRNA稳定性和TE都发生显著变化，则该效应是**混合型**的。\n如果m6A的丢失对两者都没有显著影响，则在此背景下它**没有功能性影响**。\n\n**转录本分析：**\n让我们计算每个转录本$t_{1/2}$的百分比变化。\n*   X: $t_{1/2}$从$3\\,\\mathrm{h}$增加到$5.5\\,\\mathrm{h}$。变化：$(5.5 - 3) / 3 = 2.5 / 3 \\approx +83.3\\%$。稳定性大幅增加。mRNA丰度也增加（$\\log_2$ FC $+0.8$）。TE变化可忽略不计（$\\log_2$ FC $+0.05$）。这是一个明显的**稳定性介导**效应的例子。\n*   Y: $t_{1/2}$从$4.0\\,\\mathrm{h}$增加到$4.1\\,\\mathrm{h}$。变化：$(4.1 - 4.0) / 4.0 = 0.1 / 4.0 = +2.5\\%$。稳定性变化可忽略不计。mRNA丰度变化也可忽略不计（$\\log_2$ FC $+0.1$）。TE显著下降（$\\log_2$ FC $-0.7$）。这是一个明显的**翻译介导**效应的例子。\n*   Z: $t_{1/2}$从$2.5\\,\\mathrm{h}$增加到$3.5\\,\\mathrm{h}$。变化：$(3.5 - 2.5) / 2.5 = 1.0 / 2.5 = +40\\%$。稳定性显著增加。mRNA丰度也显著增加（$\\log_2$ FC $+0.7$）。TE也显著下降（$\\log_2$ FC $-0.6$）。由于稳定性和翻译都受到强烈影响，这是一个**混合型**效应。\n*   W: MeRIP-seq的$\\log_2$倍数变化仅为$-0.4$。这表明m6A的丢失很弱。mRNA、TE和$t_{1/2}$均未改变。这是一个明显的**无功能性影响**的例子。\n\n**选项分析：**\n\n*   **A. 标准：** 这些标准是定量的、多方面的，并且基于合理的原理。它们要求一个位点要有强烈的m6A丢失（MeRIP-seq $\\leq -0.8$）才被考虑。稳定性（$\\Delta$mRNA, $\\Delta t_{1/2}$）和翻译（$\\Delta$TE）的阈值是明确的且设置合理。“混合型”类别正确地捕捉了双重效应。“无功能性影响”标准正确地过滤掉了弱的m6A丢失或低于阈值的变化。 **应用：**\n    *   X: MeRIP-seq ($-2.0 \\leq -0.8$), mRNA ($+0.8 \\geq +0.5$), TE ($+0.05$ 在 $\\left[-0.2,+0.2\\right]$ 范围内), $t_{1/2}$ ($+83.3\\% \\geq 30\\%$)。符合“稳定性介导”。正确。\n    *   Y: MeRIP-seq ($-1.2 \\leq -0.8$), mRNA ($+0.1$ 在 $\\lvert \\cdot \\rvert \\leq 0.2$ 范围内), TE ($-0.7 \\leq -0.5$), $t_{1/2}$ ($+2.5\\%$ 在 $\\pm 10\\%$ 范围内)。符合“翻译介导”。正确。\n    *   Z: MeRIP-seq ($-1.0 \\leq -0.8$), mRNA ($+0.7 \\geq +0.5$), TE ($-0.6 \\leq -0.5$)。同时超过了稳定性（mRNA）和翻译（TE）的阈值。符合“混合型”。正确。\n    *   W: MeRIP-seq ($-0.4 > -0.6$)。符合“无功能性影响”。正确。\n    **结论：** 其标准和应用都是正确且可辩护的。\n\n*   **B. 标准：** 这些标准存在缺陷。对于稳定性，它们要求mRNA的$\\log_2$ FC $\\leq -0.5$或$t_{1/2}$减少。但丢失一个不稳定的m6A标记应该会*增加*mRNA水平和半衰期。对于翻译，它们要求TE的$\\log_2$ FC $\\geq +0.5$，这忽略了m6A促进翻译的常见情况（因此其丢失会降低TE）。 **应用：** 基于这些有缺陷的标准，其应用也是不正确的（例如，X的mRNA增加了，而不是减少了）。 **结论：** 标准不正确。\n\n*   **C. 标准：** 这是一种过度简化。虽然峰位置和功能之间存在相关性，但它不是一个确定性的规则。功能必须通过mRNA丰度、半衰期和TE等数据进行经验验证。忽略定量数据是不科学的。 **应用：** 虽然对X和Y的分类恰好与我们基于数据的分析一致，但将Z分类为“稳定性介导”忽略了其强烈的TE效应，将W分类为“稳定性介导”则忽略了其完全没有效应。 **结论：** 标准过于简单，并导致不正确的分类。\n\n*   **D. 标准：** 这种“赢者通吃”的方法原则上合理，但在具体制定上存在缺陷。它正确地识别了X和Y的主要效应。然而，对于Z，其中$\\lvert \\text{mRNA $\\log_2$ FC} \\rvert = 0.7$而$\\lvert \\text{TE $\\log_2$ FC} \\rvert = 0.6$，效应是可比的。将其仅仅分类为“稳定性介导”忽略了显著的翻译组分，使得“混合型”分类更为合适。对于W，它正确地识别为“无功能性影响”，因为两个变化都是$0.0 \\leq 0.1$。主要问题是对于像Z这样两种效应都很强的情况，缺乏“混合型”类别。 **应用：** 应用遵循了所述标准，但标准本身并非最优。将Z纯粹归类为稳定性介导是一个关键弱点。 **结论：** 这些标准是合理的，但不如选项A中的标准细致和准确。\n\n**最终结论：**\n选项A提供了最全面、科学上最合理、定量上最可辩护的一套标准。它基于对所提供数据的多方面分析，正确地对所有四个转录本进行了分类，与对m6A功能的第一性原理理解完全一致。因此，选项A是最佳答案。", "answer": "$$\\boxed{A}$$", "id": "4376227"}, {"introduction": "在复杂的生物系统中，区分相关性与因果性是推断调控网络时面临的核心挑战。本练习将引导你超越简单的相关性分析，应用结构因果模型来剖析一个RNA结合蛋白 (RBP) 的直接与间接调控效应[@problem_id:4376240]。通过编写代码实现一个线性回归模型，你将学习如何量化并控制混杂变量的影响，从而分离出RBP对mRNA半衰期和翻译效率的独立因果作用。掌握这种计算因果推断方法对于在系统层面提出强有力的科学论断至关重要。", "problem": "给定与特定 RNA 结合蛋白 (RBP) 进行的转录后调控相关的单转录本测量数据。目标是使用一个能解释已测混杂因素的原则性模型，从观测特征中推断因果调控效应。科学基础包括分子生物学中心法则、信使核糖核酸 (mRNA) 半衰期（定义为降解前的预期时间）、作为翻译效率代理指标的核糖体密度，以及标准的因果图模型假设。增强型交聯免疫沉澱 (eCLIP) 占有率被用作 RBP 在转录本上结合概率的代理指标。所有变化都定义为相对于适当匹配对照组的差异，因此残余基线偏移实际上为零，可以省略截距。\n\n假设存在共同影响 eCLIP 占有率、mRNA 半衰期变化和核糖体密度变化的已测混杂因素。设变量为：\n- eCLIP 占有率 $O$（范围在 $[0,1]$ 内，无单位），\n- mRNA 半衰期变化 $H$（$\\log_2$ 倍数变化，无单位），\n- 核糖体密度变化 $R$（$\\log_2$ 倍数变化，无单位），\n- 已测混杂因素向量 $C = (C_1, C_2)$（无单位）。\n\n你需要假设以下线性结构方程成立，其噪声项独立且均值为零，并且没有截距（因为所有变量都是相对于对照组的变化量）：\n- $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$，其中 $\\mathbb{E}[\\varepsilon_H \\mid O, C] = 0$，\n- $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$，其中 $\\mathbb{E}[\\varepsilon_R \\mid O, H, C] = 0$。\n\n根据后门准则，在以已测混杂因素 $C$ 为条件时，$O$ 对 $H$ 的因果效应可以通过偏回归系数 $\\beta_{OH}$ 来识别。在受控直接效应的标准可识别性条件下，$O$ 对 $R$ 的非经由 $H$ 介导的直接因果效应，可以通过在 $R$ 对 $(O, H, C)$ 的多元回归中得到的偏回归系数 $\\gamma_{OR}$ 来识别。\n\n你的任务是实现一个程序，对每个提供的数据集估计：\n- 通过对 $H$ 关于 $(O, C_1, C_2)$ 进行无截距的最小二乘回归，估计 eCLIP 占有率对半衰期的校正后因果效应 $\\beta_{OH}$，以及\n- 通过对 $R$ 关于 $(O, H, C_1, C_2)$ 进行无截距的最小二乘回归，估计 eCLIP 占有率对核糖体密度的校正后直接因果效应 $\\gamma_{OR}$。\n\n所有数据集都是小型的、确定性的，并且在科学上是合理的。它们被设计成满足线性关系，并包含轻微的噪声项以避免完全共線性，同时保持结果的可解释性。每个数据集对应于索引为 $i = 1, \\dots, n$ 的转录本。\n\n测试套件。对于以下每种情况，请使用给出的精确数组。所有数值均无单位。\n\n情况 A（一般情况，可识别，存在介导效应和直接效应）：\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.01,\\,0.39,\\,0.82,\\,-0.02,\\,0.40,\\,0.81\\,]$\n- $R$: $[\\,0.087,\\,0.613,\\,1.174,\\,0.146,\\,0.70,\\,1.247\\,]$\n\n情况 B（对 $R$ 没有直接效应，仅通过 $H$ 介导）：\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.175,\\,0.505,\\,0.860,\\,0.330,\\,0.680,\\,1.025\\,]$\n- $R$: $[\\,0.090,\\,0.454,\\,0.838,\\,0.164,\\,0.544,\\,0.920\\,]$\n\n情况 C（对 $R$ 有负向直接效应，对 $H$ 有弱效应）：\n- $O$: $[\\,0.1,\\,0.3,\\,0.5,\\,0.7,\\,0.9\\,]$\n- $C_1$: $[\\,0,\\,1,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,0,\\,2,\\,1,\\,0\\,]$\n- $H$: $[\\, -0.19,\\,0.34,\\,-0.36,\\,0.17,\\,0.695\\,]$\n- $R$: $[\\,0.05,\\,0.05,\\,-0.05,\\,-0.05,\\,-0.05\\,]$\n\n算法要求：\n- 对于每种情况，按照规定为两个回归构建设计矩阵，省略截距列。\n- 使用普通最小二乘法估计系数。如果设计矩阵不是满秩的，则使用由数值稳定的求解器返回的最小范数最小二乘解。\n- 在 $H$ 的模型中，将 $O$ 的系数提取为 $\\beta_{OH}$。\n- 在 $R$ 的模型中，将 $O$ 的系数提取为 $\\gamma_{OR}$。\n\n角度单位不适用。没有物理单位；所有量纲均为一。不得使用百分比；请使用给定的小数。\n\n输出规范：\n- 对于每种情况，返回一个包含两个浮点数的列表 $[\\,\\widehat{\\beta}_{OH},\\,\\widehat{\\gamma}_{OR}\\,]$，每个浮点数四舍五入到三位小数。\n- 将三种情况的结果聚合到程序打印的单行中，形式为列表的列表，不含额外文本。确切格式必须是：\n\"[[0.500, 0.400],[0.600, 0.000],[0.100, -0.500]]\"，但除了分隔数字和括号所必需的逗号和空格外，不含其他空格，且每个数字都精确显示三位小数，例如： \"[[0.500, 0.400],[0.600, 0.000],[0.100, -0.500]]\"。\n\n您的程序應生成單行輸出，其中包含如上所述的、用方括號括起來並以逗號分隔的結果列表。", "solution": "用户提供了一个系统生物医学领域的问题，重点是转录后基因调控。任务是使用一个指定的线性结构模型，从观测数据中估计因果参数。\n\n该问题已经过验证，并被确定为是合理的。它在科学上基于分子生物学，并采用标准的统计方法进行因果推断，特别是使用回归分析来校正混杂因素。该问题提法明确、客观，并为获得唯一解提供了所有必要的数据和规范。\n\n问题的核心是从一组线性结构方程中估计两个参数 $\\beta_{OH}$ 和 $\\gamma_{OR}$：\n1. $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$\n2. $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$\n\n其中 $O$ 代表 eCLIP 占有率，$H$ 是 mRNA 半衰期变化，$R$ 是核糖体密度变化，$C=(C_1, C_2)$ 是已测混杂因素的向量。这些模型拟合时不应包含截距，因为所有变量都定义为相对于对照组的变化量。\n\n规定的估计方法是普通最小二乘法 (OLS)。对于形如 $y = X\\beta + \\varepsilon$ 的一般线性模型，参数向量 $\\beta$ 的 OLS 估计量 $\\hat{\\beta}$ 是使残差平方和 $\\|y - X\\hat{\\beta}\\|_2^2$ 最小化的向量。这可以通过求解正规方程 $X^\\top X \\hat{\\beta} = X^\\top y$ 得到。一种数值上稳定的求解方法，同时也能处理设计矩阵 $X$ 不是列满秩的情况，是使用基于奇异值分解 (SVD) 的求解器，例如 `numpy.linalg.lstsq` 函数。该函数在秩亏的情况下会按要求返回最小范数解。\n\n我们必须为每个提供的数据集执行两次独立的回归。\n\n首先，为了估计 $\\beta_{OH}$，我们考虑 $H$ 的模型：\n$$ H = \\beta_{OH} O + \\beta_{C_1H} C_1 + \\beta_{C_2H} C_2 + \\varepsilon_H $$\n这对应一个线性回归问题，其中响应向量 $y_H$ 是 $H$ 的观测值集合。设计矩阵 $X_H$ 是通过将 $O$、$C_1$ 和 $C_2$ 的观测向量作为其列来构建的。\n$$ y_H = \\begin{pmatrix} H_1 \\\\ \\vdots \\\\ H_n \\end{pmatrix}, \\quad X_H = \\begin{pmatrix} O_1  C_{1,1}  C_{2,1} \\\\ \\vdots  \\vdots  \\vdots \\\\ O_n  C_{1,n}  C_{2,n} \\end{pmatrix} $$\n待估计的系数向量是 $\\beta_H = [\\beta_{OH}, \\beta_{C_1H}, \\beta_{C_2H}]^{\\top}$。通过使用最小二乘法求解线性系统 $X_H \\beta_H = y_H$，我们得到估计值 $\\hat{\\beta}_H$。所求的参数估计值 $\\widehat{\\beta}_{OH}$ 是向量 $\\hat{\\beta}_H$ 的第一个元素。\n\n其次，为了估计 $\\gamma_{OR}$，我们使用 $R$ 的模型：\n$$ R = \\gamma_{OR} O + \\gamma_{HR} H + \\gamma_{C_1R} C_1 + \\gamma_{C_2R} C_2 + \\varepsilon_R $$\n在这里，响应向量 $y_R$ 是 $R$ 的观测值集合。设计矩阵 $X_R$ 由 $O$、$H$、$C_1$ 和 $C_2$ 的观测向量构建。关键要注意的是，在此回归中，$H$ 的*测量*值被用作预测变量，这与受控直接效应的识别策略是一致的。\n$$ y_R = \\begin{pmatrix} R_1 \\\\ \\vdots \\\\ R_n \\end{pmatrix}, \\quad X_R = \\begin{pmatrix} O_1  H_1  C_{1,1}  C_{2,1} \\\\ \\vdots  \\vdots  \\vdots  \\vdots \\\\ O_n  H_n  C_{1,n}  C_{2,n} \\end{pmatrix} $$\n系数向量是 $\\gamma_R = [\\gamma_{OR}, \\gamma_{HR}, \\gamma_{C_1R}, \\gamma_{C2R}]^{\\top}$。通过最小二乘法求解系统 $X_R \\gamma_R = y_R$ 得到估计值 $\\hat{\\gamma}_R$。直接因果效应的估计值 $\\widehat{\\gamma}_{OR}$ 是 $\\hat{\\gamma}_R$ 的第一个元素。\n\n此过程将应用于所提供的三种情况（A、B 和 C）中的每一种。将收集得到的 $\\beta_{OH}$ 和 $\\gamma_{OR}$ 的估计值并四舍五入到三位小数。最终的实现将为所有测试用例自动化此过程，并按规定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Estimates causal effects from transcriptional data using OLS regression.\n\n    For each test case, the function performs two linear regressions without intercept:\n    1. Regresses H on (O, C1, C2) to find beta_OH.\n    2. Regresses R on (O, H, C1, C2) to find gamma_OR.\n\n    The results are formatted and printed as specified in the problem statement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'A',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.01, 0.39, 0.82, -0.02, 0.40, 0.81]),\n            'R': np.array([0.087, 0.613, 1.174, 0.146, 0.70, 1.247]),\n        },\n        {\n            'name': 'B',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.175, 0.505, 0.860, 0.330, 0.680, 1.025]),\n            'R': np.array([0.090, 0.454, 0.838, 0.164, 0.544, 0.920]),\n        },\n        {\n            'name': 'C',\n            'O': np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n            'C1': np.array([0, 1, 0, 1, 2]),\n            'C2': np.array([1, 0, 2, 1, 0]),\n            'H': np.array([-0.19, 0.34, -0.36, 0.17, 0.695]),\n            'R': np.array([0.05, 0.05, -0.05, -0.05, -0.05]),\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract data for the current case\n        O, C1, C2, H, R = case['O'], case['C1'], case['C2'], case['H'], case['R']\n\n        # --- Regression 1: Estimate beta_OH ---\n        # Model: H = beta_OH*O + beta_C1H*C1 + beta_C2H*C2\n        # Design matrix X_H, response vector y_H = H\n        X_H = np.vstack([O, C1, C2]).T \n        \n        # Solve for coefficients using least squares.\n        # np.linalg.lstsq returns a tuple, the first element is the solution vector.\n        coeffs_H = np.linalg.lstsq(X_H, H, rcond=None)[0]\n        beta_OH = coeffs_H[0]\n\n        # --- Regression 2: Estimate gamma_OR ---\n        # Model: R = gamma_OR*O + gamma_HR*H + gamma_C1R*C1 + gamma_C2R*C2\n        # Design matrix X_R, response vector y_R = R\n        X_R = np.vstack([O, H, C1, C2]).T\n\n        # Solve for coefficients using least squares.\n        coeffs_R = np.linalg.lstsq(X_R, R, rcond=None)[0]\n        gamma_OR = coeffs_R[0]\n        \n        all_results.append((beta_OH, gamma_OR))\n\n    # Format the final output string exactly as required.\n    # Each number is formatted to three decimal places.\n    # The final string is a list of lists, e.g., [[bA, gA],[bB, gB],...].\n    results_str_list = [f\"[{res[0]:.3f}, {res[1]:.3f}]\" for res in all_results]\n    final_output = f\"[{','.join(results_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "4376240"}]}