{"hands_on_practices": [{"introduction": "在实验上，确定希尔系数 $n$ 对于理解一个系统的响应灵敏度至关重要。一种强大的分析技术是通过对数坐标变换来处理数据，这可以将希尔曲线的特定区域线性化，从而在视觉上和定量上更容易地提取像 $n$ 这样的关键参数。这个练习将探讨不同的绘图策略如何揭示潜在的协同性，并帮助您掌握从实验数据中解读转录调控动力学的实用技能。[@problem_id:4393066]", "problem": "一个单基因启动子被转录因子 (TF) $X$ 激活，该转录因子以 $n$-聚体的形式协同结合到 $n$ 个位点上，其方式为“全有或全无”：只有当所有 $n$ 个位点都被占据时，转录才会发生。假设相对于转录起始，结合和解离是快速的，因此结合可以被视为处于热力学平衡状态。根据质量作用定律，完全结合（活性）启动子相对于空（非活性）启动子的统计权重与 $\\left(\\frac{x}{K}\\right)^{n}$ 成比例，其中 $x$ 表示浓度 $[X]$，$K$ 是一个浓度标度，设定了激活的中点。在此模型中，部分结合的状态是无转录活性的。基础泄漏可以忽略不计，因此转录速率满足 $r(x) = r_{\\max} \\, p_{\\mathrm{on}}(x)$，其中 $p_{\\mathrm{on}}(x)$ 是启动子处于完全结合状态的概率，$r_{\\max}$ 是最大速率。\n\n当 $x$ 变化时，你绘制以下图形：\n\n- 图 1：$y_{1}(x) = \\log r(x)$ 对 $\\log x$ 的对数-对数图。\n- 图 2：$y_{2}(x) = \\log\\!\\left(\\frac{r(x)}{r_{\\max}}\\right)$ 对 $\\log x$ 的对数-对数图。\n- 图 3：一个 log-logit 图，定义为 $y_{3}(x) = \\log\\!\\left(\\frac{\\frac{r(x)}{r_{\\max}}}{1 - \\frac{r(x)}{r_{\\max}}}\\right)$ 对 $\\log x$。\n\n在全文中，$\\log$ 表示自然对数，在浓度 $x_{\\ast}$ 处的“局部斜率”指代导数 $\\left.\\frac{d y_{i}}{d \\log x}\\right|_{x = x_{\\ast}}$。\n\n在给定的假设下或在明确描述的修改下，哪些陈述是正确的？\n\nA. 在图 1 中，于 $x = K$ 处计算的局部斜率等于 $\\frac{n}{2}$。\n\nB. 在图 2 中，在 $x \\ll K$ 的区域，局部斜率趋近于 $n$。\n\nC. 在图 3 中（基础泄漏可忽略），对于所有 $x$，局部斜率都等于 $n$。\n\nD. 如果基础泄漏不为零（即 $r_{0} > 0$）但结合机制保持不变，并且在 logit 中改用动态范围归一化变量 $z(x) = \\frac{r(x) - r_{0}}{r_{\\max} - r_{0}}$，即绘制 $y(x) = \\log\\!\\left(\\frac{z(x)}{1 - z(x)}\\right)$ 对 $\\log x$ 的图，则对于所有 $x$，局部斜率都等于 $n$。\n\nE. 在图 1 中，于 $x = K$ 处计算的局部斜率等于 $n$。\n\nF. 在图 3 中（基础泄漏可忽略），在 $x \\ll K$ 的区域，局部斜率趋近于 $\\frac{n}{2}$。", "solution": "首先验证问题陈述的科学合理性、自洽性和清晰度。\n\n### 步骤 1：提取已知条件\n-   一个转录因子 $X$ 以 $n$-聚体的形式协同结合到启动子上的 $n$ 个位点。\n-   结合是“全有或全无”的；只有当所有 $n$ 个位点都被占据时，转录才会发生。\n-   结合处于热力学平衡状态。\n-   完全结合状态相对于空状态的统计权重为 $\\left(\\frac{x}{K}\\right)^{n}$，其中 $x = [X]$。\n-   $K$ 是激活达到中点时的浓度。\n-   部分结合的状态是无转录活性的。\n-   基础泄漏可以忽略不计，意味着当启动子未完全结合时，转录速率为零。\n-   转录速率为 $r(x) = r_{\\max} \\, p_{\\mathrm{on}}(x)$，其中 $p_{\\mathrm{on}}(x)$ 是启动子处于完全结合状态的概率。\n-   图 1：$y_{1}(x) = \\log r(x)$ 对 $\\log x$。\n-   图 2：$y_{2}(x) = \\log\\!\\left(\\frac{r(x)}{r_{\\max}}\\right)$ 对 $\\log x$。\n-   图 3：$y_{3}(x) = \\log\\!\\left(\\frac{\\frac{r(x)}{r_{\\max}}}{1 - \\frac{r(x)}{r_{\\max}}}\\right)$ 对 $\\log x$。\n-   $\\log$ 表示自然对数。\n-   在 $x_{\\ast}$ 处的局部斜率定义为 $\\left.\\frac{d y_{i}}{d \\log x}\\right|_{x = x_{\\ast}}$。\n-   选项 D 引入了一个不为零的基础泄漏 $r_0 > 0$ 和一个归一化变量 $z(x) = \\frac{r(x) - r_{0}}{r_{\\max} - r_{0}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了一个经典的协同转录激活模型，该模型导出了希尔方程。这个模型是系统生物学的基石，并且在科学上是合理的。诸如“全有或全无”结合和热力学平衡等假设，是用于推导响应函数形式的标准简化方法。\n\n设空启动子的统计权重为 $w_0 = 1$。完全结合的启动子的统计权重给定为 $w_n = \\left(\\frac{x}{K}\\right)^{n}$。所有中间状态都是非活性的，并且在“全有或全无”模型中，被认为具有可忽略的统计权重。配分函数 $Z$ 是所有可能状态的权重之和：$Z = w_0 + w_n = 1 + \\left(\\frac{x}{K}\\right)^{n}$。\n\n启动子处于完全结合（活性）状态的概率是活性状态的权重与配分函数之比：\n$$p_{\\mathrm{on}}(x) = \\frac{w_n}{Z} = \\frac{\\left(\\frac{x}{K}\\right)^{n}}{1 + \\left(\\frac{x}{K}\\right)^{n}} = \\frac{x^n}{K^n + x^n}$$\n在 $x=K$ 时，$p_{\\mathrm{on}}(K) = \\frac{K^n}{K^n + K^n} = \\frac{1}{2}$。这与 $K$ 作为中点激活浓度的定义是一致的。\n\n转录速率为 $r(x) = r_{\\max} p_{\\mathrm{on}}(x) = r_{\\max} \\frac{x^n}{K^n + x^n}$。该问题是适定的，所有术语都有明确的定义。问题是关于该函数的数学性质，可以唯一确定。问题是客观的，不包含任何科学或逻辑上的矛盾。\n\n### 步骤 3：结论和行动\n问题陈述是**有效的**。现在将推导解答。\n\n### 局部斜率的推导\n“局部斜率”定义为 $\\frac{d y}{d \\log x}$。使用链式法则，令 $u = \\log x$，我们有 $x = e^u$ 且 $\\frac{dx}{du} = e^u = x$。因此，微分算子是 $\\frac{d}{d \\log x} = x \\frac{d}{dx}$。\n\n首先，我们来分析要绘制的函数。\n$y_1(x) = \\log r(x) = \\log \\left(r_{\\max} \\frac{x^n}{K^n + x^n}\\right) = \\log r_{\\max} + n\\log x - \\log(K^n + x^n)$.\n$y_2(x) = \\log\\left(\\frac{r(x)}{r_{\\max}}\\right) = \\log(p_{\\mathrm{on}}(x)) = n\\log x - \\log(K^n + x^n)$.\n\n图 1 和图 2 的局部斜率（分别表示为 $S_1(x)$ 和 $S_2(x)$）是相同的，因为它们仅相差一个常数 $\\log r_{\\max}$，其导数为零。\n$$S_{1,2}(x) = \\frac{d y_2}{d \\log x} = x \\frac{d}{dx} \\left( n\\log x - \\log(K^n + x^n) \\right)$$\n$$S_{1,2}(x) = x \\left( \\frac{n}{x} - \\frac{nx^{n-1}}{K^n + x^n} \\right) = n - \\frac{nx^n}{K^n + x^n} = n \\left( \\frac{K^n + x^n - x^n}{K^n + x^n} \\right)$$\n$$S_{1,2}(x) = n \\frac{K^n}{K^n + x^n}$$\n\n现在，我们来分析图 3。函数是 $y_3(x) = \\log\\left(\\frac{p_{\\mathrm{on}}(x)}{1 - p_{\\mathrm{on}}(x)}\\right)$。我们来计算对数的参数：\n$$\\frac{p_{\\mathrm{on}}(x)}{1 - p_{\\mathrm{on}}(x)} = \\frac{\\frac{x^n}{K^n + x^n}}{1 - \\frac{x^n}{K^n + x^n}} = \\frac{\\frac{x^n}{K^n + x^n}}{\\frac{K^n + x^n - x^n}{K^n + x^n}} = \\frac{x^n}{K^n} = \\left(\\frac{x}{K}\\right)^n$$\n所以，$y_3(x) = \\log\\left(\\left(\\frac{x}{K}\\right)^n\\right) = n \\log\\left(\\frac{x}{K}\\right) = n(\\log x - \\log K)$。\n图 3 的局部斜率 $S_3(x)$ 是：\n$$S_3(x) = \\frac{d y_3}{d \\log x} = \\frac{d}{d \\log x}(n\\log x - n\\log K) = n \\frac{d(\\log x)}{d \\log x} - 0 = n$$\n\n### 逐项分析\n\n**A. 在图 1 中，于 $x = K$ 处计算的局部斜率等于 $\\frac{n}{2}$。**\n图 1 的局部斜率是 $S_1(x) = n \\frac{K^n}{K^n + x^n}$。\n在 $x=K$ 处计算：\n$$S_1(K) = n \\frac{K^n}{K^n + K^n} = n \\frac{K^n}{2K^n} = \\frac{n}{2}$$\n该陈述是**正确的**。\n\n**B. 在图 2 中，在 $x \\ll K$ 的区域，局部斜率趋近于 $n$。**\n图 2 的局部斜率是 $S_2(x) = n \\frac{K^n}{K^n + x^n}$。\n在 $x \\ll K$ 的区域，我们可以分析当 $x \\to 0$ 时的极限：\n$$\\lim_{x \\to 0} S_2(x) = \\lim_{x \\to 0} n \\frac{K^n}{K^n + x^n} = n \\frac{K^n}{K^n + 0} = n$$\n在低浓度下，斜率趋近于 $n$。该陈述是**正确的**。\n\n**C. 在图 3 中（基础泄漏可忽略），对于所有 $x$，局部斜率都等于 $n$。**\n我们推导出图 3 的局部斜率为 $S_3(x) = n$。这个值是一个常数，与 $x$ 无关。\n该陈述是**正确的**。\n\n**D. 如果基础泄漏不为零（即 $r_{0} > 0$）但结合机制保持不变，并且在 logit 中改用动态范围归一化变量 $z(x) = \\frac{r(x) - r_{0}}{r_{\\max} - r_{0}}$，即绘制 $y(x) = \\log\\!\\left(\\frac{z(x)}{1 - z(x)}\\right)$ 对 $\\log x$ 的图，则对于所有 $x$，局部斜率都等于 $n$。**\n当存在基础泄漏 $r_0$ 时，总速率是基础速率和 TF 诱导速率之和。诱导速率与启动子处于活性状态的概率 $p_{\\mathrm{on}}(x)$ 成正比。最大诱导速率是 $r_{\\max} - r_0$。\n所以，完整的速率表达式为 $r(x) = r_0 + (r_{\\max} - r_0)p_{\\mathrm{on}}(x)$。\n我们来计算归一化变量 $z(x)$：\n$$z(x) = \\frac{r(x) - r_0}{r_{\\max} - r_0} = \\frac{\\left(r_0 + (r_{\\max} - r_0)p_{\\mathrm{on}}(x)\\right) - r_0}{r_{\\max} - r_0} = \\frac{(r_{\\max} - r_0)p_{\\mathrm{on}}(x)}{r_{\\max} - r_0} = p_{\\mathrm{on}}(x)$$\n因此，变量 $z(x)$ 与启动子处于活性状态的概率 $p_{\\mathrm{on}}(x)$ 是相同的。该图是 $y(x) = \\log\\left(\\frac{p_{\\mathrm{on}}(x)}{1 - p_{\\mathrm{on}}(x)}\\right)$ 对 $\\log x$ 的图。这与图 3 完全相同。\n如选项 C 的分析所示，该图的局部斜率对于所有 $x$ 都是 $n$。\n该陈述是**正确的**。\n\n**E. 在图 1 中，于 $x = K$ 处计算的局部斜率等于 $n$。**\n根据对选项 A 的分析，图 1 在 $x=K$ 处的局部斜率是 $\\frac{n}{2}$。该陈述声称斜率为 $n$。\n该陈述是**不正确的**。\n\n**F. 在图 3 中（基础泄漏可忽略），在 $x \\ll K$ 的区域，局部斜率趋近于 $\\frac{n}{2}$。**\n根据对选项 C 的分析，图 3 的局部斜率对于所有 $x$ 值都精确地是 $n$。因此，在 $x \\ll K$ 的区域，斜率也是 $n$。\n该陈述是**不正确的**。", "answer": "$$\\boxed{ABCD}$$", "id": "4393066"}, {"introduction": "希尔函数本身描述的是一种稳态或平衡关系，即在给定转录因子浓度下，启动子的激活概率。然而，生物过程是动态的。为了理解基因表达如何随时间变化，我们必须将此函数嵌入到一个包含信使核糖核酸（mRNA）产生和降解过程的动态模型中。本练习将引导您推导在受到恒定刺激后基因表达的时间进程，这是将平衡模型与动力学方程相结合的一项基本技能。[@problem_id:4393067]", "problem": "哺乳动物细胞核中的单个基因受激活转录因子（TF）的调控。启动子有 $n$ 个相同的结合位点，其行为方式为“全或无”协同模式：当且仅当所有 $n$ 个位点都被 TF 占据时，启动子才具有转录活性。假设转录因子与启动子的结合和解离在比信使核糖核酸（mRNA）合成和降解快得多的时间尺度上达到热力学平衡。该基因产生 mRNA 的合成速率与启动子处于活性状态的概率成正比，而 mRNA 按一级动力学降解。从核心的物理化学和生物化学原理出发——启动子-TF 相互作用的质量作用结合平衡、细致平衡定律和中心法则（脱氧核糖核酸（DNA）转录为 mRNA）——推导当 TF 浓度在时间 $t=0$ 时被钳制在恒定值 $\\bar{T}$ 且初始 mRNA 为 $x(0)=0$ 时，mRNA 时间进程 $x(t)$ 的闭合形式表达式。\n\n假设如下：\n- 单个 TF 结合位点的解离常数为 $K$。\n- 协同结合实际上是“全或无”的：启动子的活性状态需要 $n$ 个 TF 分子同时占据。\n- mRNA 合成速率常数为 $k_{\\mathrm{tr}}$（单位为分子/细胞/单位时间），与启动子处于活性状态的概率成正比。\n- mRNA 降解速率常数为 $\\gamma$（单位为/单位时间）。\n- TF 浓度 $\\bar{T}$ 和解离常数 $K$ 使用相同的浓度单位表示。\n- 以分子/细胞为单位表示最终的 mRNA 浓度函数 $x(t)$。\n\n您的答案必须是关于 $k_{\\mathrm{tr}}$、$\\gamma$、$\\bar{T}$、$K$、$n$ 和 $t$ 的单个闭合形式解析表达式 $x(t)$。请勿提供不等式、待解方程或数值。无需四舍五入。", "solution": "该问题要求推导由激活转录因子（TF）调控的基因的信使核糖核酸（mRNA）浓度的时间进程，记为 $x(t)$。推导必须基于生物化学和物理化学的基本原理。\n\n首先，我们对基因启动子的状态进行建模。问题指出，启动子有 $n$ 个相同的 TF 结合位点，并且结合是“全或无协同方式”。这意味着我们可以将启动子建模为仅存在两种状态：一个自由的非活性状态（$P_{\\text{free}}$）和一个所有 $n$ 个位点都被占据的完全结合的活性状态（$P_{\\text{active}}$）。具有部分占据的中间状态被认为是可忽略的。可逆的结合反应是：\n$$ P_{\\text{free}} + nT \\rightleftharpoons P_{\\text{active}} $$\n其中 $T$ 代表 TF 分子。\n\n问题指出，与转录和翻译的时间尺度相比，这种结合-解离过程迅速达到热力学平衡。因此，我们可以将质量作用定律应用于此平衡。该反应的总解离常数 $K_{D}$ 由下式给出：\n$$ K_{D} = \\frac{[P_{\\text{free}}][T]^{n}}{[P_{\\text{active}}]} $$\n其中 $[...]$ 表示浓度。\n\n问题提供了一个单个 TF 结合位点的解离常数 $K$。对于涉及 $n$ 个相同位点的“全或无”或完全协同过程，总解离常数 $K_{D}$ 与单位点常数 $K$ 的关系为 $K_{D} = K^{n}$。这是建模高协同性系统的标准假设，反映了协同结合事件中各个结合亲和力的乘法效应。将此代入我们的平衡方程得到：\n$$ K^{n} = \\frac{[P_{\\text{free}}][T]^{n}}{[P_{\\text{active}}]} $$\n\n启动子仅在处于 $P_{\\text{active}}$ 状态时才具有转录活性。启动子处于活性状态的概率 $p_{\\text{active}}$ 是总启动子群体中处于活性状态的部分：\n$$ p_{\\text{active}} = \\frac{[P_{\\text{active}}]}{[P_{\\text{total}}]} = \\frac{[P_{\\text{active}}]}{[P_{\\text{free}}] + [P_{\\text{active}}]} $$\n从平衡表达式中，我们可以用 $[P_{\\text{active}}]$ 来表示 $[P_{\\text{free}}]$：\n$$ [P_{\\text{free}}] = [P_{\\text{active}}] \\frac{K^{n}}{[T]^{n}} $$\n将此代入 $p_{\\text{active}}$ 的方程中：\n$$ p_{\\text{active}} = \\frac{[P_{\\text{active}}]}{[P_{\\text{active}}] \\frac{K^{n}}{[T]^{n}} + [P_{\\text{active}}]} $$\n通过消去分子和分母中的 $[P_{\\text{active}}]$ 项，我们得到：\n$$ p_{\\text{active}} = \\frac{1}{\\frac{K^{n}}{[T]^{n}} + 1} = \\frac{[T]^{n}}{K^{n} + [T]^{n}} $$\n这是著名的希尔函数，描述了启动子对 TF 浓度的概率响应。问题指出，对于 $t \\ge 0$，TF 浓度被钳制在一个恒定值 $\\bar{T}$。因此，激活概率在时间上是恒定的：\n$$ p_{\\text{active}} = \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} $$\n\n接下来，我们构建控制 mRNA 浓度 $x(t)$ 的微分方程。$x(t)$ 的变化率是其合成速率和降解速率之差。\n$$ \\frac{dx}{dt} = (\\text{合成速率}) - (\\text{降解速率}) $$\n合成速率与启动子处于活性状态的概率成正比，速率常数为 $k_{\\mathrm{tr}}$。\n$$ \\text{synthesis rate} = k_{\\mathrm{tr}} \\cdot p_{\\text{active}} = k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} $$\nmRNA 的降解遵循一级动力学，速率常数为 $\\gamma$。\n$$ \\text{degradation rate} = \\gamma x(t) $$\n结合这些项，我们得到以下一阶线性常微分方程（ODE）：\n$$ \\frac{dx}{dt} = k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} - \\gamma x(t) $$\n令常数合成项表示为 $C_S = k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}}$。ODE 变为：\n$$ \\frac{dx}{dt} + \\gamma x(t) = C_S $$\n这是一阶线性 ODE 的标准形式。通解可以通过使用积分因子或将齐次解和特解相加来求得。对于齐次方程 $\\frac{dx_h}{dt} + \\gamma x_h = 0$ 的解是 $x_h(t) = A \\exp(-\\gamma t)$，其中 $A$ 是一个积分常数。对于特解，由于右侧是常数，我们可以假设一个常数特解 $x_p(t) = B$。将此代入 ODE 得到 $0 + \\gamma B = C_S$，因此 $B = \\frac{C_S}{\\gamma}$。\n通解是齐次解和特解的和：\n$$ x(t) = x_h(t) + x_p(t) = A \\exp(-\\gamma t) + \\frac{C_S}{\\gamma} $$\n\n为了确定常数 $A$，我们应用问题中指定的初始条件：$x(0) = 0$。\n$$ x(0) = A \\exp(-\\gamma \\cdot 0) + \\frac{C_S}{\\gamma} = A \\cdot 1 + \\frac{C_S}{\\gamma} = 0 $$\n这给出 $A = -\\frac{C_S}{\\gamma}$。\n\n将 $A$ 代回通解中，我们找到 $x(t)$ 的特解：\n$$ x(t) = -\\frac{C_S}{\\gamma} \\exp(-\\gamma t) + \\frac{C_S}{\\gamma} = \\frac{C_S}{\\gamma} (1 - \\exp(-\\gamma t)) $$\n最后，我们代入 $C_S$ 的完整表达式：\n$$ x(t) = \\frac{1}{\\gamma} \\left( k_{\\mathrm{tr}} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} \\right) (1 - \\exp(-\\gamma t)) $$\n这个表达式可以更紧凑地写为：\n$$ x(t) = \\frac{k_{\\mathrm{tr}}}{\\gamma} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} (1 - \\exp(-\\gamma t)) $$\n这就是基于给定参数和原理的 mRNA 浓度随时间变化的闭合形式解析表达式。", "answer": "$$\\boxed{\\frac{k_{\\mathrm{tr}}}{\\gamma} \\frac{\\bar{T}^{n}}{K^{n} + \\bar{T}^{n}} (1 - \\exp(-\\gamma t))}$$", "id": "4393067"}, {"introduction": "将简单的调控元件组合在一起可以产生复杂的涌现行为，这是系统生物学的核心主题之一。一个经典的例子是基因产物激活其自身的转录，形成一个正反馈回路。这个练习将通过计算的方式演示，由希尔函数描述的协同性对于使该回路作为双稳态开关（能够稳定地处于“开”和“关”两种状态）是多么关键，这是理解细胞记忆和决策过程的基石。[@problem_id:4393065]", "problem": "单个基因产物通过与其启动子的协同结合来激活自身的转录，从而参与正反馈。假设转录激活源于激活物对启动子的平衡占据，激活物浓度用 $A$（单位为 $\\mathrm{nM}$）表示。此过程在快速平衡近似下，遵循解离常数为 $K$（单位为 $\\mathrm{nM}$）、协同阶数为 $n$ 的协同结合模型。设存在基础生产速率 $\\alpha_0$（单位为 $\\mathrm{nM}/\\mathrm{h}$）、最大激活扩增生产贡献 $\\alpha$（单位为 $\\mathrm{nM}/\\mathrm{h}$）以及一级降解速率常数 $\\delta$（单位为 $\\mathrm{h}^{-1}$）。激活物浓度 $A(t)$ 的连续时间动力学由一个根据这些组分构建的一维常微分方程所控制。\n\n从以下基础出发：(i) 具有协同性的启动子占据的质量作用结合平衡，(ii) 分子生物学的中心法则（DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质）断言转录活性决定生产速率，以及 (iii) 线性一级降解，推导出由协同性启动子占据产生的、作为 $A$ 的饱和单调递增函数的调控激活函数，并构建 $A(t)$ 的动力学方程。然后，重点研究稳态及其稳定性。\n\n对于给定的参数集 $(\\alpha_0,\\alpha,\\delta,K,n)$，通过令总生产速率等于总降解速率，为 $A\\ge 0$ 定义稳态方程 $f(A)=0$。如果一维稳定性判据成立，即导数 $\\frac{d f}{d A}(A^\\ast)$ 为负，则稳态 $A^\\ast$ 是稳定的；如果导数为正，则是不稳定的。在具有足够协同性的强正反馈下，可能存在多个稳态，包括由一个不稳定稳态隔开的两个稳定稳態所构成的双稳态。\n\n您的程序必须：\n- 基于具有协同性的平衡占据，实现所推导的调控函数，并根据生产项和降解项构建 $f(A)$。\n- 通过扫描一个足够大的区间并包围符号变化，然后使用鲁棒的求解器精确求解根，以数值方式找到所有非负稳态 $A^\\ast$（$f(A)$ 在 $A\\ge 0$ 上的根）。\n- 使用根位置上 $\\frac{d f}{d A}$ 的符号，将每个稳态分类为稳定或不稳定。\n- 对于每个测试用例，返回稳定稳态的数量以及稳定稳态浓度的排序列表（升序），以浮点数形式表示，单位为 $\\mathrm{nM}$。\n\n使用以下具有科学合理性的参数的测试套件：\n- 测试用例1：$(\\alpha_0,\\alpha,\\delta,K,n)=(2,120,1,20,4)$，其中 $A$ 的单位为 $\\mathrm{nM}$，速率单位为 $\\mathrm{nM}/\\mathrm{h}$ 和 $\\mathrm{h}^{-1}$。\n- 测试用例2：$(\\alpha_0,\\alpha,\\delta,K,n)=(2,15,1,20,4)$，其中 $A$ 的单位为 $\\mathrm{nM}$，速率单位为 $\\mathrm{nM}/\\mathrm{h}$ 和 $\\mathrm{h}^{-1}$。\n- 测试用例3：$(\\alpha_0,\\alpha,\\delta,K,n)=(2,120,8,20,4)$，其中 $A$ 的单位为 $\\mathrm{nM}$，速率单位为 $\\mathrm{nM}/\\mathrm{h}$ 和 $\\mathrm{h}^{-1}$。\n- 测试用例4：$(\\alpha_0,\\alpha,\\delta,K,n)=(2,120,1,20,1)$，其中 $A$ 的单位为 $\\mathrm{nM}$，速率单位为 $\\mathrm{nM}/\\mathrm{h}$ 和 $\\mathrm{h}^{-1}$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表内是各用例的结果，并用方括号括起来。每个用例的结果本身必须是 $[\\text{num\\_stable},[\\text{stable\\_root}_1,\\text{stable\\_root}_2,\\ldots]]$ 的形式，不含空格。例如，对于两个用例，格式为 $[[2,[a,b]],[1,[c]]]$，其中 $a$、$b$ 和 $c$ 是以小数表示的浮点浓度，单位为 $\\mathrm{nM}$。最终输出必须严格遵循上述四个测试用例的此确切格式。", "solution": "该问题要求分析一个基因自调控网络的稳态及其稳定性。核心任务包括推导控制微分方程，确定稳态条件，并实现一种数值算法，以针对给定的参数集寻找和分类稳态。\n\n首先，我们根据所提供的物理和生物学原理构建数学模型。激活蛋白的浓度（用 $A$ 表示）随时间的变化取决于其生产和降解之间的平衡。这可以表示为一个一维常微分方程（ODE）：\n$$ \\frac{dA}{dt} = \\text{生产速率} - \\text{降解速率} $$\n\n降解过程被描述为速率常数为 $\\delta$ 的一级反应。因此，降解速率与浓度 $A$ 成正比：\n$$ \\text{降解速率} = \\delta A $$\n\n激活物的生产受其自身调控。存在一个基础生产速率 $\\alpha_0$，即使在没有激活物的情况下也会发生。此外，激活物通过与其启动子结合来增强自身的生产。这种结合被描述为一个协同阶数为 $n$ 的协同过程。在快速平衡近似下，被激活物占据的启动子比例 $\\theta$ 由希尔函数给出：\n$$ \\theta(A) = \\frac{A^n}{K^n + A^n} $$\n此处，$K$ 是解离常数，代表启动子占据率达到一半时的 $A$ 浓度。激活的生产速率与该占据分数成正比，其最大激活扩增贡献为 $\\alpha$。总生产速率是基础速率和激活速率之和：\n$$ \\text{生产速率} = \\alpha_0 + \\alpha \\cdot \\theta(A) = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} $$\n\n结合生产项和降解项，我们得到 $A(t)$ 的完整动力学方程：\n$$ \\frac{dA}{dt} = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} - \\delta A $$\n\n系统的稳态是指净变化率为零时的浓度 $A^\\ast$，即 $\\frac{dA}{dt} = 0$。此条件定义了稳态方程 $f(A) = 0$，其中：\n$$ f(A) = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} - \\delta A $$\n该方程的非负根 $A^\\ast \\ge 0$ 对应于稳态浓度。在图形上，这些是 S 型生产曲线 $P(A) = \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n}$ 和线性降解直线 $D(A) = \\delta A$ 的交点。\n\n稳态 $A^\\ast$ 的稳定性由系统对 $A^\\ast$ 周围小扰动的响应决定。对于一维系统，这由在稳态处计算的 $f(A)$ 的导数符号给出。如果 $\\frac{df}{dA}(A^\\ast) < 0$，则稳态 $A^\\ast$ 是稳定的，这意味着扰动会衰减，系统返回到 $A^\\ast$。如果 $\\frac{df}{dA}(A^\\ast) > 0$，则是不稳定的，这意味着扰动会被放大，使系统偏离 $A^\\ast$。\n\n为了求导数，我们将 $f(A)$ 对 $A$ 求导：\n$$ \\frac{df}{dA} = \\frac{d}{dA} \\left( \\alpha_0 + \\alpha \\frac{A^n}{K^n + A^n} - \\delta A \\right) $$\n对希尔函数项使用商法则，我们得到：\n$$ \\frac{df}{dA} = \\alpha \\frac{(nA^{n-1})(K^n + A^n) - (A^n)(nA^{n-1})}{(K^n + A^n)^2} - \\delta = \\alpha \\frac{nK^nA^{n-1}}{(K^n + A^n)^2} - \\delta $$\n\n数值实现过程如下：\n1.  对于每个参数集 $(\\alpha_0, \\alpha, \\delta, K, n)$，定义函数 $f(A)$ 和 $\\frac{df}{dA}$。\n2.  确定根 $A^\\ast$ 的合适搜索区间。任何稳态的一个安全上限由最大可能生产速率除以降解常数给出，$A_{max} = (\\alpha_0 + \\alpha) / \\delta$。我们扫描一个稍大的区间，例如，从 $0$ 到 $1.5 \\cdot A_{max} + 10$。\n3.  以小步长扫描此区间，以识别 $f(A)$ 符号发生变化的连续点对。每个这样的点对都包含一个根。\n4.  对于找到的每个区间，使用一个鲁棒的数值求根算法，例如 Brent-Dekker 方法（在 `scipy.optimize.brentq` 中实现），来找到根 $A^\\ast$ 的精确值。\n5.  对于每个根 $A^\\ast$，计算导数 $\\frac{df}{dA}(A^\\ast)$。\n6.  如果 $\\frac{df}{dA}(A^\\ast) < 0$，则该根被分类为稳定。\n7.  收集每个案例的稳定根，按升序排序，并连同其数量一起按照问题陈述中指定的格式进行格式化。\n此过程系统地找到所有非负稳态并确定其稳定性，使我们能够为每组参数表征系统的行为（单稳态与双稳态）。", "answer": "[[2,[2.016335198425175,121.36838380816928]],[1,[2.146864117769537]],[1,[2.000000019841269]],[1,[111.80339887498948]]]", "id": "4393065"}]}