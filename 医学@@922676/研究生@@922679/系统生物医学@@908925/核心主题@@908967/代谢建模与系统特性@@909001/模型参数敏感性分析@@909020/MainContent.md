## 引言
在系统生物医学领域，数学模型是探索复杂生命过程的强大工具，但其预测的准确性严重依赖于模型中众多参数的精确赋值。然而，这些参数往往充满不确定性，这源于实验测量的局限或生物系统的内在变异性。这就带来了一个核心挑战：我们如何系统地理解并量化这种[参数不确定性](@entry_id:264387)对模型预测结果的影响？解决这一问题对于建立可信、可预测的生物学模型至关重要。

[参数敏感性分析](@entry_id:201589)正是应对这一挑战的关键方法论。本文将全面引导读者深入掌握敏感性分析的理论与实践。在“原理与机制”一章中，我们将奠定数学基础，详细拆解从局部到[全局敏感性分析](@entry_id:171355)的核心概念、计算方法以及与[参数可辨识性](@entry_id:197485)的深刻联系。随后的“应用与跨学科联系”一章将理论联系实际，通过药代动力学、生物节律、优化实验设计等丰富案例，展示[敏感性分析](@entry_id:147555)如何在真实科研问题中发挥威力。最后，通过“动手实践”部分，读者将有机会通过具体的计算练习，将所学知识转化为解决实际问题的能力。

通过这三个层层递进的章节，您将不仅理解[敏感性分析](@entry_id:147555)的“是什么”和“为什么”，更能掌握“怎么做”，从而在您的科研工作中更自信地构建、校准和解读数学模型。让我们首先深入探索其基本原理与机制。

## 原理与机制

在系统生物医学中，数学模型是连接理论假设与实验数据的桥梁。然而，这些模型的预测能力往往取决于一组参数，这些参数的数值通常存在不确定性。因此，理解模型的输出如何响应其参数的变化，即进行**[参数敏感性分析](@entry_id:201589)**（Parameter Sensitivity Analysis），是模型构建、校准和验证过程中的一个核心环节。本章将深入探讨[参数敏感性分析](@entry_id:201589)的基本原理、关键机制及其在[模型辨识](@entry_id:139651)性和实验设计中的应用。

### 敏感性的基本概念

在研究模型行为之前，我们必须首先精确定义模型参数与可观测量之间的数学关系。

#### 参数-输出映射的定义

考虑一个由常微分方程（ODE）描述的动态系统，这是系统生物医学中的常见形式：
$$
\dot{x}(t) = f(x(t), p), \quad x(0) = x_0
$$
其中，$x(t) \in \mathbb{R}^n$ 是[状态向量](@entry_id:154607)，$p \in \mathbb{R}^m$ 是参数向量。模型的[可观测量](@entry_id:267133)（例如，生物标志物的浓度）通常是状态和参数的函数：
$$
y(t) = h(x(t), p)
$$
由于状态轨迹 $x(t)$ 的解本身依赖于参数 $p$，我们可以记为 $x(t; p)$，因此输出也隐式和显式地依赖于 $p$，即 $y(t; p) = h(x(t; p), p)$。

敏感性分析的核心是研究从参数到输出的映射关系。这个“参数-输出映射”可以从两个互补的视角来精确定义 [@problem_id:4385545]：

1.  **[函数空间](@entry_id:136890)视角**：我们可以将此映射视为一个函数 $S$，它将一个特定的参数向量 $p$ 映射到在整个时间区间 $[0, T]$ 上的完整输出轨迹 $y(\cdot; p)$。形式上，该映射为 $S: P \to C([0, T], \mathbb{R}^q)$，其中 $S(p) = y(\cdot; p)$。这里的 $P$ 是保证解在 $[0, T]$ 上存在且唯一的参数集合，$C([0, T], \mathbb{R}^q)$ 是从 $[0, T]$ 到 $\mathbb{R}^q$ 的[连续函数空间](@entry_id:150395)。这个视角对于理解参数如何影响输出的整体动态行为至关重要。

2.  **时间点视角**：或者，对于任何固定的时间点 $t \in [0, T]$，我们可以定义一个映射 $S_t$，它将参数向量 $p$ 映射到该特定时刻的输出值 $y(t; p)$。形式上，该映射为 $S_t: P \to \mathbb{R}^q$，其中 $S_t(p) = y(t; p)$。这个视角对于计算在特定时间点测量的局部[敏感性系数](@entry_id:273552)是基础性的。

这两种定义都是严谨且有用的，它们构成了后续不同类型[敏感性分析](@entry_id:147555)的数学基础。

#### 局部敏感性分析：前向方法

最直接的敏感性度量是**局部[敏感性系数](@entry_id:273552)**，它量化了在参数空间中一个特定点附近，输出对单个参数微小变化的响应。该系数定义为输出 $y(t)$ 关于参数 $p_i$ 的[偏导数](@entry_id:146280), $S_{y,p_i}(t) = \frac{\partial y(t)}{\partial p_i}$。

为了计算这个导数，我们必须考虑参数 $p_i$ 对输出 $y(t; p) = h(x(t; p), p)$ 的双重影响：通过状态 $x(t; p)$ 的隐式依赖，以及通过函数 $h$ 的显式依赖。应用[多变量链式法则](@entry_id:146671)，我们得到 [@problem_id:4385550]：
$$
S_{y,p_i}(t) = \frac{\partial y(t)}{\partial p_i} = \frac{\partial h}{\partial x}(x(t), p) \frac{\partial x(t)}{\partial p_i} + \frac{\partial h}{\partial p_i}(x(t), p)
$$
此表达式中的核心是状态敏感性向量 $S_{x,p_i}(t) = \frac{\partial x(t)}{\partial p_i}$。为了得到它的动态演化方程，我们对原始的ODE系统 $\dot{x} = f(x, p)$ 关于 $p_i$ 求导。在函数 $f$ 和初始条件 $x_0$ 对其参数足够光滑（例如，$C^1$ 连续可微）的[正则性条件](@entry_id:166962)下，我们可以交换求导次序，得到一个描述状态敏感性的线性时变ODE，称为**敏感性方程**：
$$
\frac{d}{dt}S_{x,p_i}(t) = \frac{\partial f}{\partial x}(x(t), p) S_{x,p_i}(t) + \frac{\partial f}{\partial p_i}(x(t), p)
$$
其中 $J(t) = \frac{\partial f}{\partial x}(x(t), p)$ 是沿状态轨迹 $x(t)$ 计算的系统[雅可比矩阵](@entry_id:178326)。该方程的初始条件为 $S_{x,p_i}(0) = \frac{\partial x_0(p)}{\partial p_i}$。

这种计算敏感性的方法被称为**前向[敏感性分析](@entry_id:147555)**，因为它将[状态方程](@entry_id:274378)和所有参数的敏感性方程联立成一个大的ODE系统，并从 $t=0$ 开始向前积分。

#### 归一化敏感性：[弹性系数](@entry_id:192914)

局部[敏感性系数](@entry_id:273552) $\frac{\partial y}{\partial p_i}$ 的值和单位依赖于参数 $p_i$ 和输出 $y$ 的尺度，这使得直接比较不同参数的敏感性变得困难。为了实现无量纲的比较，我们引入**归一化[敏感性系数](@entry_id:273552)**，也称为**弹性系数**（Elasticity）。它量化了输出的相对变化与参数的相对变化之间的关系 [@problem_id:4385523]：
$$
E_{y,p_i}(t) = \frac{\partial y/y}{\partial p_i/p_i} = \frac{p_i}{y(t)} \frac{\partial y(t)}{\partial p_i}
$$
这个定义等价于对数导数形式 $E_{y,p_i}(t) = \frac{\partial \ln y(t)}{\partial \ln p_i}$，这在分析其变换性质时特别有用。例如，考虑一个与参数无关的尺度变换 $\tilde{y}(t) = c \cdot y(t)$ 或 $\tilde{y}(t) = s(t) \cdot y(t)$，其中 $c$ 是常数，$s(t)$ 是时间依赖因子。由于 $\ln(\tilde{y}) = \ln(c) + \ln(y)$ 或 $\ln(\tilde{y}) = \ln(s(t)) + \ln(y)$，而 $\ln(c)$ 和 $\ln(s(t))$ 对 $\ln(p_i)$ 的导数为零，因此弹性系数在这种尺度变换下保持不变。这是一个非常理想的属性，因为它意味着[敏感性分析](@entry_id:147555)的结果不应受测量单位变化的影响。

然而，弹性对于其他类型的变换并非不变。例如，对于加性变换 $\tilde{y}(t) = y(t) + b$，弹性变为 $E_{\tilde{y},p_i} = \frac{y(t)}{y(t) + b} E_{y,p_i}$，它不等于 $E_{y,p_i}$。同样，如果尺度因子本身依赖于参数，如 $\tilde{y}(t) = h(p_i) y(t)$，则弹性会增加一个额外的项：$E_{\tilde{y},p_i} = E_{y,p_i} + E_{h,p_i}$。理解这些性质对于正确解释归一化敏感性至关重要。

### [全局敏感性分析](@entry_id:171355)

对于具有显著非线性和参数间相互作用的复杂模型，仅在参数空间的一个点上进行局部[敏感性分析](@entry_id:147555)可能具有误导性。参数的影响力可能在整个[参数空间](@entry_id:178581)中发生巨大变化。**[全局敏感性分析](@entry_id:171355)（Global Sensitivity Analysis, GSA）**旨在通过在整个[参数不确定性](@entry_id:264387)范围内探索来量化每个参数对输出不确定性的贡献。

#### 筛选方法：[Morris方法](@entry_id:270291)

**[Morris方法](@entry_id:270291)**是一种[计算效率](@entry_id:270255)较高的GSA筛选技术，特别适用于具有大量参数的模型，用于识别哪些参数是重要的，哪些可以被忽略。该方法的核心是计算**基本效应（Elementary Effects, EE）** [@problem_id:4385580]。

在一个离散化的参数网格上，参数 $p_i$ 的基本效应被定义为一个[前向差分](@entry_id:173829)商，它近似于该参数方向上的局部导数：
$$
\mathrm{EE}_i(\mathbf{p}) = \frac{Y(\mathbf{p} + \Delta e_i) - Y(\mathbf{p})}{\Delta}
$$
其中 $Y(\mathbf{p})$ 是在固定读出时间的标量输出，$e_i$ 是第 $i$ 个[标准基向量](@entry_id:152417)，$\Delta$ 是网格步长。[Morris方法](@entry_id:270291)通过在参数空间中[随机抽样](@entry_id:175193) $R$ 个基点 $\mathbf{p}^{(r)}$，并从每个基点开始构建一系列一次只改变一个参数（One-At-a-Time, OAT）的轨迹，来计算每个参数的一系列基本效应。

然后，使用两个统计量来总结这些基本效应的分布：
1.  **$\mu^{\star}$**：基本效应绝对值的均值，$\mu^{\star} = \frac{1}{R} \sum_{r=1}^R |\mathrm{EE}_i(\mathbf{p}^{(r)})|$。$\mu^{\star}$ 衡量参数 $p_i$ 对输出的**总体影响**大小。使用绝对值可以避免因非单调响应（即参数在不同区域对输出有相反方向的影响）而导致的有符号效应相互抵消，从而低估了参数的重要性。
2.  **$\sigma$**：基本效应的标准差，$\sigma = \sqrt{\frac{1}{R-1} \sum_{r=1}^R (\mathrm{EE}_i(\mathbf{p}^{(r)}) - \overline{\mathrm{EE}}_i)^2}$。$\sigma$ 衡量基本效应在参数空间中的**变异性**。一个较大的 $\sigma$ 值表明参数 $p_i$ 的影响显著依赖于参数空间中的位置，这通常是由**非线性**或与其他参数的**相互作用**引起的。

通过绘制 $(\mu^{\star}, \sigma)$ 图，可以对参数进行分类：高 $\mu^{\star}$ 的参数是重要的；高 $\sigma$ 的参数具有非线性效应或与其他参数有相互作用。

#### 方差分解方法：[Sobol指数](@entry_id:156558)

**[方差分解](@entry_id:272134)敏感性分析（Variance-Based Sensitivity Analysis, [VBS](@entry_id:138121)A）**，特别是**[Sobol指数](@entry_id:156558)**，是一种更定量的GSA方法。其核心思想是将模型输出的总方差 $V = \mathrm{Var}(Y)$ 分解为由单个输入参数或参数组引起的部分方差。

假设模型输入参数是相互独立的随机变量，[Sobol指数](@entry_id:156558)定义如下 [@problem_id:4385518]：

*   **一阶[Sobol指数](@entry_id:156558) ($S_i$)**：度量参数 $p_i$ 单独对输出方差的贡献，即通过固定 $p_i$ 能平均减少多少输出方差。其定义为：
    $$
    S_i = \frac{V_i}{V} = \frac{\mathrm{Var}_{p_i}[\mathbb{E}_{\mathbf{p}_{\sim i}}(Y|p_i)]}{\mathrm{Var}(Y)}
    $$
    其中 $\mathbf{p}_{\sim i}$ 表示除 $p_i$ 之外的所有参数。$S_i$ 也被称为**主效应指数**。

*   **总阶[Sobol指数](@entry_id:156558) ($S_{T_i}$)**：度量参数 $p_i$ 的主效应加上其与其他所有参数的[交互效应](@entry_id:164533)对输出方差的总贡献。其定义为：
    $$
    S_{T_i} = 1 - \frac{\mathrm{Var}_{\mathbf{p}_{\sim i}}[\mathbb{E}_{p_i}(Y|\mathbf{p}_{\sim i})]}{\mathrm{Var}(Y)}
    $$
    $S_{T_i} - S_i$ 的差值量化了 $p_i$ 参与的所有[交互作用](@entry_id:164533)的总贡献。

对于一个纯粹的**加性模型**（$Y = \sum f_i(p_i)$），所有方差贡献都来自主效应，因此 $\sum S_i = 1$。对于任何具有[交互作用](@entry_id:164533)的模型，$\sum S_i  1$。这个差值 $1 - \sum S_i$ 代表了所有高阶[交互作用](@entry_id:164533)对总方差的贡献。

例如，考虑一个简化的信号通路模型 $Y = p_R p_S p_A$，其中三个增益参数是独立的随机变量 [@problem_id:4385518]。通过计算，我们可能发现 $S_R + S_S + S_A \approx 0.95  1$，这直接表明参数之间存在不可忽略的[交互作用](@entry_id:164533)。此外，我们可能发现 $S_{TR} \approx 0.40$ 显著大于 $S_R \approx 0.36$，这定量地揭示了参数 $p_R$ 通过与其他参数的乘法交互对输出方差产生了额外贡献。

### 敏感性、[可辨识性](@entry_id:194150)与实验设计

[敏感性分析](@entry_id:147555)不仅是为了理解模型，它更是评估和改善[模型可辨识性](@entry_id:186414)以及指导未来实验设计的关键工具。**[参数可辨识性](@entry_id:197485)**（identifiability）涉及从给定的实验数据中唯一确定模型参数值的可能性。

#### [费雪信息矩阵](@entry_id:750640)：连接敏感性与信息

当从含有噪声的数据中估计参数时，敏感性直接决定了数据中包含多少关于参数的信息。考虑一个测量模型 $z_k = y(t_k; \mathbf{p}) + \varepsilon_k$，其中测量误差 $\varepsilon_k$ 是独立的零均值高斯噪声，方差为 $\sigma_k^2$。

在这种情况下，**[费雪信息矩阵](@entry_id:750640)（Fisher Information Matrix, FIM）** $F$ 提供了一个衡量数据对参数约束能力的强大工具。其 $(i, j)$ 元素可以从对数似然函数推导得出，并且对于上述[高斯噪声](@entry_id:260752)模型，它具有一个非常直观的形式 [@problem_id:4385555]：
$$
F_{ij}(\mathbf{p}) = \sum_{k=1}^N \frac{1}{\sigma_k^2} \frac{\partial y(t_k; \mathbf{p})}{\partial p_i} \frac{\partial y(t_k; \mathbf{p})}{\partial p_j}
$$
这个表达式清晰地表明，FIM是所有测量时间点上敏感性向量[外积](@entry_id:147029)的加权和。权重是逆方差 $1/\sigma_k^2$，意味着噪声较小的测量点贡献更多的信息。

FIM的威力在于它通过**[克拉默-拉奥下界](@entry_id:154412)（Cramér-Rao Lower Bound, CRLB）**与参数估计的精度直接相关 [@problem_id:4385548]。CRLB指出，对于任何无偏估计量 $\hat{p}$，其协方差矩阵的“大小”有一个下界，这个下界就是FIM的逆：
$$
\mathrm{Cov}(\hat{p}) \succeq F^{-1}
$$
这个关系意味着：
*   **高敏感性带来高精度**：较大的输出敏感性会使得FIM的元素变大，从而使其[逆矩阵](@entry_id:140380) $F^{-1}$ 的元素变小，这意味着参数估计方差的下界更紧，即可实现的估计精度更高。
*   **参数间的共线性导致不[可辨识性](@entry_id:194150)**：如果两个参数（例如 $p_i$ 和 $p_j$）的敏感性向量（即敏感性矩阵 $S$ 的两列）在所有测量时间点上近似[线性相关](@entry_id:185830)，那么 $F = S^T S / \sigma^2$ 将是病态的或接近奇异的。这意味着 $F^{-1}$ 在某个方向上将具有非常大的元素，表明沿该参数组合方向的估计方差将非常大。这正是**[实际不可辨识性](@entry_id:270178)**的体现。
*   **增加测量可以增加信息**：在敏感性非零的时间点增加更多的测量，会向FIM中添加正定项，从而“增大”FIM并“减小”$F^{-1}$，进而收紧CRLB，提高[参数估计](@entry_id:139349)的理论最佳精度 [@problem_id:4385548]。

#### “草率”模型：费雪信息矩阵的谱分析

在系统生物学中，许多模型表现出一种称为**“草率”（Sloppy）**的特性。这意味着模型对某些参数组合的变化极其敏感，而对另一些组合则非常不敏感。这种结构可以通过对FIM进行[特征分解](@entry_id:181333)来揭示 [@problem_id:4385556]。

设FIM的[特征分解](@entry_id:181333)为 $F = Q \Lambda Q^T$，其中 $\Lambda$ 是由特征值 $\lambda_i$ 组成的对角矩阵， $Q$ 的列是对应的特征向量 $q_i$。
*   **特征向量 $q_i$** 代表了参数空间中的特定方向，即参数的特定组合。
*   **特征值 $\lambda_i$** 量化了数据在相应方向 $q_i$ 上包含的信息量。大的特征值对应**“刚性”（stiff）**方向，这些方向上的参数组合被数据很好地约束。小的特征值对应**“草率”（sloppy）**方向，这些方向上的参数组合几乎不受数据约束，因而具有很高的不确定性。

草率模型的典型特征是FIM的特征值谱跨越多个数量级，例如 $\lambda_{\max} / \lambda_{\min} \gg 1$。考虑一个FIM，其特征值为 $\lambda_1 = 200, \lambda_2 = 2, \lambda_3 = 0.01$ [@problem_id:4385556]。参数估计的不确定性（方差）沿每个特征向量方向与 $1/\lambda_i$ 成正比。因此，沿最草率方向 $q_3$ 的不确定性大约是沿最刚性方向 $q_1$ 的 $200 / 0.01 = 20000$ 倍。这表明与 $q_3$ 相关的参数组合是**实际不可辨识的**。

这种分析对于**实验设计**至关重要。为了最有效地减少[参数不确定性](@entry_id:264387)，新的实验应该被设计来提供关于当前最草率方向的信息。这意味着新的测量应该在对这些草[率参数](@entry_id:265473)组合最敏感的条件下进行 [@problem_id:4385556]。

#### [剖面似然](@entry_id:269700)分析

FIM分析是局部的，它在线性假设下评估[参数不确定性](@entry_id:264387)。**[剖面似然](@entry_id:269700)（Profile Likelihood）**提供了一种强大的非线性方法来探索[参数可辨识性](@entry_id:197485)，它能更好地处理参数间的补偿效应 [@problem_id:4385520]。

对于一个感兴趣的参数 $\theta_i$，其[剖面似然](@entry_id:269700)函数 $L_p(\theta_i)$ 的定义是，在固定 $\theta_i$ 的每个值时，通过优化所有其他“讨厌”参数 $\theta_{-i}$ 所能得到的最大似然值：
$$
L_p(\theta_i) = \max_{\theta_{-i}} L(\theta)
$$
[剖面似然](@entry_id:269700)的形状直接反映了参数的可辨识性：
*   如果 $L_p(\theta_i)$（或更常见的 $\log L_p(\theta_i)$）在其最大值附近呈现一个**尖锐的山峰**，这表明即使允许其他参数进行最佳补偿，偏离最优值的 $\theta_i$ 仍会导致似然度的显著下降。这说明 $\theta_i$ 是**实际可辨识的**。
*   如果 $L_p(\theta_i)$ 呈现一个**平坦的区域或平台**，这表明可以在一个很宽的范围内改变 $\theta_i$，而其影响可以通过调整其他参数来完全补偿，使得似然度几乎不变。这揭示了 $\theta_i$ 是**实际不可辨识的**。

[剖面似然](@entry_id:269700)因此成为评估[参数不确定性](@entry_id:264387)和[置信区间](@entry_id:138194)的一种强大的、非局部的诊断工具。

### 敏感性分析的计算考量

执行敏感性分析，特别是对于大规模OD[E模](@entry_id:160271)型，会带来显著的计算挑战。

#### 刚性问题及其对策

生物化学网络模型通常是**刚性（stiff）**的，这意味着系统包含多个时间尺度差异巨大的动态过程（例如，快速的结合/解离与缓慢的合成/降解）。如前所述，前向敏感性方程 $\dot{S}_i = J(t) S_i + \partial f / \partial p_i$ 的动态由与原系统完全相同的[雅可比矩阵](@entry_id:178326) $J(t)$ 控制。因此，**如果原状态系统是刚性的，那么其敏感性方程也必然是刚性的** [@problem_id:4385519]。

对于[刚性系统](@entry_id:146021)，使用标准显式[数值积分方法](@entry_id:141406)（如经典的[四阶龙格-库塔法](@entry_id:138005)）是极其低效的，因为为了维持数值稳定性，步长必须由系统中最快的时间尺度来限制，即使该快速动态已经衰减。因此，必须使用专为刚性问题设计的**隐式积分方法**，例如：
*   **向后[微分](@entry_id:158422)公式（BDF）方法**
*   **隐式[龙格-库塔](@entry_id:140452)（IRK）方法**（如Radau或Lobatto族）
*   **线性隐式Rosenbrock-W方法**

在同时积分状态和敏感性方程时，这些[隐式方法](@entry_id:137073)在每个时间步都需要求解线性方程组。一个关键的效率提升来自于**重用[雅可比矩阵](@entry_id:178326)信息**。由于状态和所有敏感性方程共享同一个[雅可比矩阵](@entry_id:178326) $J(t)$，为求解状态而进行的计算成本高昂的矩阵分解（如LU分解）或[预条件子](@entry_id:753679)构建可以被缓存并重用于求解所有敏感性方程的[线性系统](@entry_id:163135)，从而大大降低了总计算成本 [@problem_id:4385519]。

#### 前向方法 vs. 伴随方法

对于计算一个标量目标函数 $J$（例如，[拟合优度](@entry_id:637026)或某个时间点的输出）关于所有 $m$ 个参数的梯度 $\nabla_p J$，存在两种主流策略：前向敏感性分析和**伴随敏感性分析（Adjoint Sensitivity Analysis）**。它们的计算成本有显著差异 [@problem_id:4385560]。

*   **前向[敏感性分析](@entry_id:147555)**：如前所述，它需要求解一个包含状态和所有 $m$ 个[参数敏感性](@entry_id:274265)的扩展ODE系统。或者，如某些算法所做，对每个参数求解一个大小为 $2n$ 的增广系统。在后一种情况下，假设每个求解的成本与状态维度的三次方成正比（由于稠密线性代数），总成本大约为 $\mathcal{O}(N \cdot m \cdot n^3)$，其中 $N$ 是时间步数，$n$ 是状态数。成本与参数数量 $m$ **[线性相关](@entry_id:185830)**。

*   **伴随[敏感性分析](@entry_id:147555)**：此方法通过求解一个称为**伴随方程**的辅助ODE系统来工作。它只需要：
    1.  一次**前向积分**原始状态方程 $\dot{x}=f(x,p)$，存储所需的状态轨迹。
    2.  一次**后向积分**一个维度为 $n$ 的线性伴随方程 $\dot{\lambda} = -J(t)^T \lambda - (\partial L/\partial x)^T$。
    梯度 $\nabla_p J$ 的每个分量随后可以通过一个积分计算得到，该积分的被积函数依赖于已知的状态和伴随变量。总计算成本主要由两次维度为 $n$ 的ODE求解构成，大约为 $\mathcal{O}(N \cdot n^3)$。关键在于，成本与参数数量 $m$ **无关**。

因此，选择哪种方法取决于模型的大小：
*   当参数数量 $m$ 很少，或者需要完整的状态敏感性矩阵 $\partial x / \partial p$ 时，**前向方法**是合适的。
*   当参数数量 $m$ 很大（例如，在优化或大规模参数估计中， $m \gg 1$），并且目标只是一个标量函数的梯度时，**伴随方法**在计算上具有压倒性优势。