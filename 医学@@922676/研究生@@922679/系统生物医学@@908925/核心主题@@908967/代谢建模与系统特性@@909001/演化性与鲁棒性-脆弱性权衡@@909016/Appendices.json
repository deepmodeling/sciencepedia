{"hands_on_practices": [{"introduction": "正反馈是生物回路中常见的模体，能够产生复杂的动态行为。本练习将指导您通过分析一个自激活基因回路的非线性动力学方程，来精确推导产生双稳态（一种系统可以稳定存在于两种状态的鲁棒性形式）的条件。通过这个过程，您将揭示这种状态层面的鲁棒性为何对系统底层生化参数（如反馈增益）的变化表现出固有的脆弱性 [@problem_id:4339395]。", "problem": "考虑一个自激活基因回路，其模型为一个单物种常微分方程（ODE），描述了激活自身表达的转录因子浓度 $x(t)$。其生成速率由一个希尔函数给出，该函数具有系数 $n$ 和半饱和常数 $K$，并由反馈增益 $A$ 缩放；其降解是线性的，速率常数为 $\\beta$。动力学方程为\n$$\n\\frac{dx}{dt} \\;=\\; A \\,\\frac{x^{n}}{K^{n} + x^{n}} \\;-\\; \\beta\\, x \\,,\n$$\n其中 $A  0$，$K  0$，$\\beta  0$，且 $n \\geq 1$。当 $n  1$ 时，希尔函数表现出超敏性。系统生物医学中的稳健性-脆弱性权衡预测，超敏正反馈可以产生双稳态和滞后现象，这种现象对状态 $x$ 的小扰动是稳健的，但对参数 $n$ 和 $A$ 的变化是脆弱的。\n\n从确定性非线性动力学的基础事实出发，即当一个稳态同时满足平衡条件和正常双曲性丧失（矢量场关于 $x$ 的导数在稳态处为零）时，会发生鞍结（折叠）分岔。仅使用希尔函数的定义，推导该系统表现出双稳态和滞后现象的精确条件。具体来说：\n\n- 确定反馈增益 $A$ 的解析阈值，用希尔系数 $n$、半饱和常数 $K$ 和降解速率 $\\beta$ 表示。在该阈值下，对于 $n1$ 的情况，鞍结分岔首次出现并产生双稳态。\n- 解释该阈值如何在不涉及随机动力学的情况下，意味着对 $x$ 的小扰动具有稳健性（两个外部平衡点的局部稳定性），但对参数变化具有脆弱性（当 $A$ 或 $n$ 越过阈值时双稳态的丧失）。\n\n你的最终答案必须是双稳态出现时的临界增益 $A_{c}(n, K, \\beta)$ 的闭式解析表达式。请用浓度/时间的单位表示 $A_{c}$ 的最终答案。无需进行数值计算或四舍五入。", "solution": "问题要求基于非线性动力学原理，特别是鞍结分岔的发生，推导自激活基因回路中双稳态的临界条件。我们还必须解释其中蕴含的稳健性-脆弱性权衡。\n\n系统的动力学由蛋白质浓度 $x(t)$ 的常微分方程（ODE）描述：\n$$\n\\frac{dx}{dt} = f(x; A, K, \\beta, n) = A \\frac{x^{n}}{K^{n} + x^{n}} - \\beta x\n$$\n参数为反馈增益 $A  0$、半饱和常数 $K  0$、降解速率 $\\beta  0$ 和希尔系数 $n \\geq 1$。\n\n稳态，记作 $x_{ss}$，是指变化率为零的浓度，即 $\\frac{dx}{dt} = 0$。这给出了平衡条件：\n$$\nf(x_{ss}) = A \\frac{x_{ss}^{n}}{K^{n} + x_{ss}^{n}} - \\beta x_{ss} = 0 \\quad (*_1)\n$$\n这个方程总有一个平凡解 $x_{ss} = 0$。非平凡解必须满足：\n$$\nA \\frac{x_{ss}^{n-1}}{K^{n} + x_{ss}^{n}} = \\beta\n$$\n鞍结分岔标志着一对新稳态（一个稳定，一个不稳定）的诞生，它发生在一个稳态失去其正常双曲性的临界参数值处。这意味着系统在稳态处的线性化有一个零特征值。对于一维系统，这对应于常微分方程右侧的导数为零。设分岔点处的稳态为 $x_{sn}$。这些条件是：\n1.  平衡条件: $f(x_{sn}) = 0$。\n2.  分岔条件: $\\frac{df}{dx}\\bigg|_{x=x_{sn}} = 0$。\n\n首先，我们计算 $f(x)$ 关于 $x$ 的导数：\n$$\n\\frac{df}{dx} = A \\frac{d}{dx}\\left(\\frac{x^{n}}{K^{n} + x^{n}}\\right) - \\beta\n$$\n使用除法求导法则 $\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{\\frac{du}{dx}v - u\\frac{dv}{dx}}{v^{2}}$，令 $u = x^{n}$ 且 $v = K^{n} + x^{n}$：\n$$\n\\frac{d}{dx}\\left(\\frac{x^{n}}{K^{n} + x^{n}}\\right) = \\frac{(nx^{n-1})(K^{n} + x^{n}) - (x^{n})(nx^{n-1})}{(K^{n} + x^{n})^{2}} = \\frac{nx^{n-1}K^{n}}{(K^{n} + x^{n})^{2}}\n$$\n因此，$f(x)$ 的导数是：\n$$\n\\frac{df}{dx} = A \\frac{nx^{n-1}K^{n}}{(K^{n} + x^{n})^{2}} - \\beta\n$$\n因此，分岔条件 $\\frac{df}{dx}|_{x=x_{sn}} = 0$ 为：\n$$\nA \\frac{nx_{sn}^{n-1}K^{n}}{(K^{n} + x_{sn}^{n})^{2}} - \\beta = 0 \\quad (*_2)\n$$\n我们现在有一个由两个方程 $(*_1)$ 和 $(*_2)$ 组成的方程组，稳态浓度 $x_{sn}$ 和临界反馈增益（我们称之为 $A_c$）必须同时满足这两个方程。\n根据 $(*_1)$，对于一个非平凡稳态 $x_{sn}  0$：\n$$\nA_c \\frac{x_{sn}^{n-1}}{K^{n} + x_{sn}^{n}} = \\beta \\implies A_c = \\beta \\frac{K^{n} + x_{sn}^{n}}{x_{sn}^{n-1}} \\quad (Eq. 1)\n$$\n根据 $(*_2)$：\n$$\nA_c \\frac{nx_{sn}^{n-1}K^{n}}{(K^{n} + x_{sn}^{n})^{2}} = \\beta \\implies A_c = \\beta \\frac{(K^{n} + x_{sn}^{n})^{2}}{nx_{sn}^{n-1}K^{n}} \\quad (Eq. 2)\n$$\n为了求出 $x_{sn}$，我们让 $A_c$ 的两个表达式相等：\n$$\n\\beta \\frac{K^{n} + x_{sn}^{n}}{x_{sn}^{n-1}} = \\beta \\frac{(K^{n} + x_{sn}^{n})^{2}}{nx_{sn}^{n-1}K^{n}}\n$$\n由于我们正在寻找一个非平凡分岔（$x_{sn}  0$）并且 $\\beta  0$，我们可以消去 $\\beta$ 和项 $x_{sn}^{n-1}$。我们还知道 $K^{n} + x_{sn}^{n}  0$，所以我们可以用它来除方程两边：\n$$\n1 = \\frac{K^{n} + x_{sn}^{n}}{nK^{n}}\n$$\n重新整理以求解 $x_{sn}$：\n$$\nnK^{n} = K^{n} + x_{sn}^{n}\n$$\n$$\nx_{sn}^{n} = nK^{n} - K^{n} = (n-1)K^{n}\n$$\n$$\nx_{sn} = K(n-1)^{1/n}\n$$\n这给出了鞍结分岔点处的稳态浓度。为了使 $x_{sn}$ 为正实数，我们必须有 $n-1  0$，即 $n  1$。这证实了问题的假设，即双稳态需要超敏性（$n  1$）。\n\n现在，通过将 $x_{sn}$ 的值代入关于 $A_c$ 的一个方程中来求临界增益 $A_c$。使用来自（方程 1）的更简单的形式：\n$$\nA_c = \\beta \\frac{K^{n} + x_{sn}^{n}}{x_{sn}^{n-1}}\n$$\n代入 $x_{sn}^n = (n-1)K^n$：\n$$\nK^{n} + x_{sn}^{n} = K^{n} + (n-1)K^{n} = nK^{n}\n$$\n将 $x_{sn} = K(n-1)^{1/n}$ 代入分母：\n$$\nx_{sn}^{n-1} = \\left(K(n-1)^{1/n}\\right)^{n-1} = K^{n-1} (n-1)^{(n-1)/n}\n$$\n综合这些结果，得到 $A_c$ 的表达式：\n$$\nA_c = \\beta \\frac{nK^{n}}{K^{n-1}(n-1)^{(n-1)/n}} = \\beta n K \\frac{1}{(n-1)^{(n-1)/n}}\n$$\n这个表达式可以改写为：\n$$\nA_c = \\frac{\\beta n K}{(n-1)^{1 - 1/n}}\n$$\n当反馈增益 $A$ 大于此临界值，即 $A  A_c$ 时，存在双稳态。在 $A=A_c$ 时，发生鞍结分岔，而对于 $A  A_c$，系统是单稳态的，在 $x=0$ 处有唯一的稳态。\n\n现在，我们来解释稳健性-脆弱性权衡：\n1.  **对状态扰动的稳健性**：对于 $A  A_c$ 的情况，S形的生成曲线 $A \\frac{x^n}{K^n+x^n}$ 与线性的降解直线 $\\beta x$ 相交于三点：一个低的稳定状态（靠近 $x=0$）、一个中间的不稳定状态和一个高的稳定状态。系统可以存在于“低”（OFF）或“高”（ON）的稳定状态。如果系统处于这些稳定状态之一，浓度 $x$ 的小扰动将会衰减，系统将返回其原始状态。这代表了对动态变量波动的稳健性。需要一个大的扰动才能将系统推过由不稳定的中间状态定义的阈值，以使其从“ON”切换到“OFF”，反之亦然。这种在小扰动面前维持状态的特性是一种形式的稳健性。\n\n2.  **对参数变化的脆弱性**：这种稳健性是以系统参数保持在双稳态区域（$A  A_c$）为条件的。双稳态开关的存在性对于定义阈值 $A_c$ 的参数 $A$ 和 $n$ 的变化是脆弱的。如果系统处于高的“ON”状态，而某个参数（例如增益 $A$）缓慢减小，直到越过临界值 $A_c$，那么高的稳定状态和中间的不稳定状态将在鞍结分岔中合并和消失。唯一剩下的稳态是低的“OFF”状态。因此，系统的浓度将从高状态灾难性地降至低状态。在阈值 $A_c$ 附近，参数 $A$ 的一个微小变化会导致系统行为发生巨大的、质的变化（失去一个稳定状态）。类似地，$A_c$ 对希尔系数 $n$ 高度敏感，特别是当 $n$ 接近 1 时，$A_c \\to \\infty$。$n$ 的一个微小降低就可能使 $A_c$ 升高到当前工作增益 $A$ 之上，从而破坏双稳态。系统定性行为对特定参数值的这种依赖性，就是一种脆弱性。\n\n总之，该系统对其状态变量 $x$ 的扰动是稳健的，但对其基础参数 $A$ 和 $n$ 的扰动是脆弱的。", "answer": "$$\\boxed{\\frac{\\beta n K}{(n-1)^{1 - 1/n}}}$$", "id": "4339395"}, {"introduction": "接下来，我们将视角从单个分子回路提升到群体进化层面。本练习引入了量化遗传学中的核心概念——遗传方差-协方差矩阵（$G$ 矩阵），它描述了性状的遗传基础。通过计算具体案例中的进化响应，您将理解性状间的遗传相关性（这有助于维持表型的稳定性）如何限制种群适应新选择压力的能力，从而揭示了当前整合性与未来进化能力之间的权衡 [@problem_id:4339449]。", "problem": "在一个系统生物医学模型中，考虑代表患者群体中协同免疫-代谢表型的两个相互作用的数量性状：性状 $x_{1}$ 是标准化的促炎信号活动，性状 $x_{2}$ 是标准化的肝脏脂质输出活动。根据经验，遗传方差-协方差矩阵（G矩阵）估计为\n$$\n\\mathbf{G}=\\begin{pmatrix}\n0.8  0.6 \\\\\n0.6  1.2\n\\end{pmatrix},\n$$\n由于性状是标准化的，矩阵中的所有条目都是无量纲的。假设稳定的临床管理被中断，导致自然选择暂时倾向于降低 $x_{2}$ 同时适度增加 $x_{1}$。方向选择梯度向量为\n$$\n\\beta=\\begin{pmatrix}\n0.5 \\\\\n-0.25\n\\end{pmatrix}.\n$$\n仅使用基本的数量遗传学原理，计算性状向量的预期平均响应和沿着给定选择方向的标量可进化性。然后，定性地解释一种减少性状间耦合的结构性变化（例如，向模块化的转变，将遗传协方差设为零，同时保持边际方差不变）将如何影响该免疫-代谢系统中的可进化性以及鲁棒性-脆弱性权衡。\n\n将您的最终单一数值答案表示为沿给定选择梯度的标量可进化性。不要四舍五入；提供不带单位的精确值。您计算过程中的所有中间量和符号都必须用数学符号表示。", "solution": "该问题要求计算两个量：性状向量的预期平均响应 $\\Delta\\mathbf{\\bar{z}}$ 和沿给定选择梯度的标量可进化性 $e(\\beta)$。它还要求定性解释模块化如何影响可进化性以及鲁棒性-脆弱性权衡。\n\n描述对选择响应的多变量数量遗传学基本方程是多变量育种家方程：\n$$\n\\Delta\\mathbf{\\bar{z}} = \\mathbf{G}\\beta\n$$\n其中 $\\Delta\\mathbf{\\bar{z}}$ 是每代平均性状变化的向量，$\\mathbf{G}$ 是遗传方差-协方差矩阵，$\\beta$ 是方向选择梯度向量。\n\n首先，我们通过将给定的 $\\mathbf{G}$ 矩阵和 $\\beta$ 向量相乘来计算预期平均响应向量 $\\Delta\\mathbf{\\bar{z}}$。令 $\\Delta\\mathbf{\\bar{z}} = \\begin{pmatrix} \\Delta\\bar{x}_{1} \\\\ \\Delta\\bar{x}_{2} \\end{pmatrix}$。\n$$\n\\Delta\\mathbf{\\bar{z}} = \\begin{pmatrix} 0.8  0.6 \\\\ 0.6  1.2 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.25 \\end{pmatrix}\n$$\n响应向量的分量为：\n$$\n\\Delta\\bar{x}_{1} = (0.8)(0.5) + (0.6)(-0.25) = 0.4 - 0.15 = 0.25\n$$\n$$\n\\Delta\\bar{x}_{2} = (0.6)(0.5) + (1.2)(-0.25) = 0.3 - 0.3 = 0\n$$\n因此，性状向量的预期平均响应为：\n$$\n\\Delta\\mathbf{\\bar{z}} = \\begin{pmatrix} 0.25 \\\\ 0 \\end{pmatrix}\n$$\n这一结果表明，虽然选择倾向于增加 $x_{1}$ 和减少 $x_{2}$，但系统预计将仅通过增加 $x_{1}$ 的均值来响应。$x_{2}$ 的均值预计不会改变。这是一个经典的遗传约束的例子，其中性状间的遗传相关阻止了群体向选择有利的方向进化。正的遗传协方差（$G_{12}=0.6$）意味着增加 $x_{1}$ 的选择也倾向于增加 $x_{2}$，这抵消了降低 $x_{2}$ 的直接选择作用。\n\n接下来，我们计算标量可进化性 $e(\\beta)$，它是响应向量 $\\Delta\\mathbf{\\bar{z}}$ 在选择梯度向量 $\\beta$ 上的投影。它衡量了在选择方向上的适应速率，计算公式为：\n$$\ne(\\beta) = \\frac{\\beta^T \\Delta\\mathbf{\\bar{z}}}{||\\beta||^2} = \\frac{\\beta^T \\mathbf{G} \\beta}{||\\beta||^2}\n$$\n按照惯例，可进化性通常在归一化选择梯度（$||\\beta||=1$）的情况下讨论。在这种情况下，$e(\\beta) = \\beta^T \\mathbf{G} \\beta$。由于标准教科书通常使用后一个公式来表示可进化性（代表选择方向上的加性遗传方差），我们将计算这个值。\n$$\ne(\\beta) = \\beta^T (\\mathbf{G}\\beta)\n$$\n我们已经计算出 $\\mathbf{G}\\beta = \\Delta\\mathbf{\\bar{z}} = \\begin{pmatrix} 0.25 \\\\ 0 \\end{pmatrix}$。现在我们计算其与 $\\beta^T$ 的点积：\n$$\ne(\\beta) = \\begin{pmatrix} 0.5  -0.25 \\end{pmatrix} \\begin{pmatrix} 0.25 \\\\ 0 \\end{pmatrix}\n$$\n$$\ne(\\beta) = (0.5)(0.25) + (-0.25)(0) = 0.125\n$$\n沿给定选择梯度的标量可进化性为 $0.125$。\n\n对于定性分析部分，我们考虑一种将遗传协方差设为零的结构性变化。新的G矩阵 $\\mathbf{G}'$ 将是：\n$$\n\\mathbf{G}' = \\begin{pmatrix} 0.8  0 \\\\ 0  1.2 \\end{pmatrix}\n$$\n这代表了向模块化系统的转变，其中对 $x_{1}$ 和 $x_{2}$ 的遗传影响是独立的。让我们为这个模块化系统计算新的响应向量 $\\Delta\\mathbf{\\bar{z}}'$ 和新的可进化性 $e'(\\beta)$。\n$$\n\\Delta\\mathbf{\\bar{z}}' = \\mathbf{G}'\\beta = \\begin{pmatrix} 0.8  0 \\\\ 0  1.2 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.25 \\end{pmatrix} = \\begin{pmatrix} (0.8)(0.5) \\\\ (1.2)(-0.25) \\end{pmatrix} = \\begin{pmatrix} 0.4 \\\\ -0.3 \\end{pmatrix}\n$$\n新的可进化性为：\n$$\ne'(\\beta) = \\beta^T \\Delta\\mathbf{\\bar{z}}' = \\begin{pmatrix} 0.5  -0.25 \\end{pmatrix} \\begin{pmatrix} 0.4 \\\\ -0.3 \\end{pmatrix} = (0.5)(0.4) + (-0.25)(-0.3) = 0.2 + 0.075 = 0.275\n$$\n由于 $e'(\\beta) = 0.275  e(\\beta) = 0.125$，选择方向上的可进化性显著增加。通过移除遗传协方差，遗传约束被解除。冲突的多效性效应被消除，使得性状 $x_{2}$ 能够如选择所倾向的那样减少。响应向量 $\\Delta\\mathbf{\\bar{z}}'$ 现在与选择梯度 $\\beta$ 的方向更为一致。\n\n这说明了鲁棒性-脆弱性权衡。\n-   **鲁棒性：**原始的耦合系统（具有非零协方差）可以被认为对需要 $x_{1}$ 和 $x_{2}$ 协同变化的扰动具有鲁棒性。这种紧密耦合有助于维持免疫和代谢性状之间的特定功能关系，这在之前的稳定临床管理机制下可能是有利的。这种整合缓冲了系统状态。\n-   **脆弱性：**然而，当面对一种要求性状以非协同方式（增加 $x_{1}$，减少 $x_{2}$）变化的新选择压力时，这同一个耦合却使系统变得脆弱。系统朝所需方向进化的无能（$ \\Delta\\bar{x}_{2} = 0$）证明了这种脆弱性或适应性的缺乏。\n-   **模块化的效应：**转向模块化系统（$\\mathbf{G}'$）增加了可进化性，使系统对新的选择压力不那么脆弱且更具适应性。然而，这是以牺牲原有的功能整合为代价的。对于那些以前由两个性状的协同响应来管理的扰动，系统可能会变得不那么鲁棒。模块化结构更具“可进化性”，但在其稳态调节方面可能不那么“鲁棒”。\n总而言之，向模块化（零协方差）的结构性转变打破了遗传约束，增加了选择方向上的可进化性，并例证了这样一种权衡：适应性的增加（对特定选择压力的脆弱性降低）可能是以牺牲整合的生理稳定性（鲁棒性）为代价的。", "answer": "$$\n\\boxed{0.125}\n$$", "id": "4339449"}, {"introduction": "负反馈对于维持生物体内稳态至关重要，但其性能受到基本物理定律的制约。本练习运用工程控制论中的强大工具——灵敏度函数，来探索这一固有限制。您将通过一个数值计算任务，直观地理解“水床效应”，即在某些频率上抑制扰动敏感性的收益，必然以在其他频率上敏感性增加为代价，这为理解鲁棒性与脆弱性的权衡提供了定量的基础 [@problem_id:4339439]。", "problem": "考虑一个系统生物医学中的反馈控制信号通路，其开环传递函数建模为 $L(s)=\\dfrac{K}{(1+s\\tau)^2}$，其中 $K$ 是一个表示反馈强度的无量纲增益参数，$\\tau$ 是一个以秒为单位的特征时间常数。在频域中，灵敏度函数 $S(s)$ 由基础控制理论关系 $S(s)=\\dfrac{1}{1+L(s)}$ 定义，对于稳定、最小相位系统，Bode 灵敏度积分 (BSI) 指出，在所有频率（单位为弧度/秒）上，$\\ln|S(i\\omega)|$ 下的面积是受限的，这导致了“水床效应”：在某些频率上灵敏度的降低会由其他频率上灵敏度的增加来补偿。这些是鲁棒控制中被广泛接受、经过充分检验的事实，并且可作为反馈调节的抽象应用于生化信号传导。\n\n您的任务是：\n- 从上述定义出发，推导在通用条件 $K\\ge 0$ 和 $\\tau0$ 下 $S(i\\omega)$ 的精确代数表达式，并将其简化为能明确显示 $K$ 和 $\\tau$ 如何进入实部和虚部的形式。\n- 实现一个程序，针对每个指定的测试用例，计算三个量，以数值方式说明当 $K$ 增加时的水床效应：\n  1. 在 $\\omega=0$ 处计算的低频灵敏度幅值 $|S(i\\omega)|$，记为 $|S(0)|$。\n  2. 在 $\\omega_{\\min}$ 和 $\\omega_{\\max}$ （单位为弧度/秒）之间对数间隔的频率网格上的峰值灵敏度幅值 $\\max_{\\omega\\in[\\omega_{\\min},\\omega_{\\max}]} |S(i\\omega)|$。\n  3. 使用梯形法则对截断的 Bode 灵敏度积分 $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} \\ln |S(i\\omega)|\\,\\mathrm{d}\\omega$ 进行数值近似。该积分应以弧度/秒为单位计算，其值的量纲为弧度/秒，而 $|S(i\\omega)|$ 是无量纲的。\n\n使用以下测试套件：\n- 所有情况下，固定时间常数 $\\tau=1$ 秒。\n- 频率范围限制为 $\\omega_{\\min}=10^{-6}$ 弧度/秒和 $\\omega_{\\max}=10^{4}$ 弧度/秒。在 $[\\omega_{\\min},\\omega_{\\max}]$ 上使用一个包含 $N=10000$ 个点的对数间隔网格。\n- 增益值 $K\\in\\{0,0.1,1,10,100\\}$。\n\n对于每个测试用例 $\\{K,\\tau\\}$，计算三元组 $\\left[|S(0)|,\\ \\max_{\\omega\\in[\\omega_{\\min},\\omega_{\\max}]} |S(i\\omega)|,\\ \\int_{\\omega_{\\min}}^{\\omega_{\\max}} \\ln |S(i\\omega)|\\,\\mathrm{d}\\omega\\right]$，其中前两项表示为无量纲浮点数，积分项表示为弧度/秒。将报告的每个值四舍五入到 $6$ 位小数。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素是针对一个测试用例的浮点数三元组，也用方括号括起来，并用逗号分隔。例如，对于三个测试用例，输出应类似于 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$。", "solution": "解决方案分为两部分。首先，我们将对灵敏度函数 $S(i\\omega)$ 进行解析推导。其次，我们将概述用于计算指定量以说明水床效应的数值实现方法。\n\n**第1部分：灵敏度函数 $S(i\\omega)$ 的解析推导**\n\n问题要求推导灵敏度函数 $S(i\\omega)$，其形式应明确显示其实部和虚部是增益 $K$ 和时间常数 $\\tau$ 的函数。\n\n1.  **从给定的定义开始。**\n    开环传递函数由下式给出：\n    $$L(s) = \\frac{K}{(1+s\\tau)^2}$$\n    灵敏度函数定义为：\n    $$S(s) = \\frac{1}{1+L(s)}$$\n\n2.  **将 $L(s)$ 代入 $S(s)$ 的表达式。**\n    $$S(s) = \\frac{1}{1 + \\frac{K}{(1+s\\tau)^2}} = \\frac{(1+s\\tau)^2}{(1+s\\tau)^2 + K}$$\n\n3.  **通过设置 $s = i\\omega$ 在频域中计算该函数。**\n    此处，$i$ 是虚数单位，$\\omega$ 是角频率，单位为弧度/秒。\n    $$S(i\\omega) = \\frac{(1+i\\omega\\tau)^2}{(1+i\\omega\\tau)^2 + K}$$\n\n4.  **展开项 $(1+i\\omega\\tau)^2$。**\n    $$(1+i\\omega\\tau)^2 = 1^2 + 2(1)(i\\omega\\tau) + (i\\omega\\tau)^2 = 1 + 2i\\omega\\tau - \\omega^2\\tau^2 = (1-\\omega^2\\tau^2) + i(2\\omega\\tau)$$\n\n5.  **将展开的项代回 $S(i\\omega)$ 的表达式。**\n    分子为 $(1-\\omega^2\\tau^2) + i(2\\omega\\tau)$。\n    分母为 $((1-\\omega^2\\tau^2) + i(2\\omega\\tau)) + K = (1+K-\\omega^2\\tau^2) + i(2\\omega\\tau)$。\n    这得出：\n    $$S(i\\omega) = \\frac{(1-\\omega^2\\tau^2) + i(2\\omega\\tau)}{(1+K-\\omega^2\\tau^2) + i(2\\omega\\tau)}$$\n\n6.  **分离实部和虚部。**\n    为此，我们将分子和分母同乘以分母的复共轭，即 $(1+K-\\omega^2\\tau^2) - i(2\\omega\\tau)$。\n    $$S(i\\omega) = \\frac{[(1-\\omega^2\\tau^2) + i(2\\omega\\tau)] \\cdot [(1+K-\\omega^2\\tau^2) - i(2\\omega\\tau)]}{[(1+K-\\omega^2\\tau^2) + i(2\\omega\\tau)] \\cdot [(1+K-\\omega^2\\tau^2) - i(2\\omega\\tau)]}$$\n\n    分母变为：\n    $$\\text{Denominator} = (1+K-\\omega^2\\tau^2)^2 + (2\\omega\\tau)^2$$\n\n    分子变为：\n    $$\\text{Numerator} = (1-\\omega^2\\tau^2)(1+K-\\omega^2\\tau^2) - i(1-\\omega^2\\tau^2)(2\\omega\\tau) + i(2\\omega\\tau)(1+K-\\omega^2\\tau^2) + (2\\omega\\tau)^2$$\n    $$\\text{Numerator} = [(1-\\omega^2\\tau^2)(1+K-\\omega^2\\tau^2) + 4\\omega^2\\tau^2] + i[2\\omega\\tau(1+K-\\omega^2\\tau^2) - 2\\omega\\tau(1-\\omega^2\\tau^2)]$$\n\n    简化分子的虚部：\n    $$i[2\\omega\\tau(1+K-\\omega^2\\tau^2 - 1 + \\omega^2\\tau^2)] = i(2\\omega\\tau K)$$\n\n7.  **实部和虚部的最终表达式。**\n    综合结果，我们得到 $S(i\\omega)$ 的实部和虚部：\n    $$\\text{Re}[S(i\\omega)] = \\frac{(1-\\omega^2\\tau^2)(1+K-\\omega^2\\tau^2) + 4\\omega^2\\tau^2}{(1+K-\\omega^2\\tau^2)^2 + 4\\omega^2\\tau^2}$$\n    $$\\text{Im}[S(i\\omega)] = \\frac{2K\\omega\\tau}{(1+K-\\omega^2\\tau^2)^2 + 4\\omega^2\\tau^2}$$\n    这些就是所要求的代数表达式，明确显示了对 $K$、$\\tau$ 和 $\\omega$ 的依赖关系。\n\n**第2部分：数值计算方案**\n\n现在，我们将概述针对每个 $K \\in \\{0, 0.1, 1, 10, 100\\}$（$\\tau=1$ 秒）的值，数值计算问题中指定的三个量的方法。\n\n1.  **灵敏度函数 $|S(i\\omega)|$ 的幅值。**\n    为了提高数值计算效率，直接推导幅值 $|S(i\\omega)|$ 的表达式比先计算实部和虚部更简单。\n    $$|S(i\\omega)| = \\left| \\frac{(1+i\\omega\\tau)^2}{(1+i\\omega\\tau)^2 + K} \\right| = \\frac{|(1+i\\omega\\tau)^2|}{|(1+K-\\omega^2\\tau^2) + i(2\\omega\\tau)|}$$\n    分子的幅值为 $|1+i\\omega\\tau|^2 = 1+\\omega^2\\tau^2$。\n    分母的幅值为 $\\sqrt{(1+K-\\omega^2\\tau^2)^2 + (2\\omega\\tau)^2}$。\n    因此，幅值由下式给出：\n    $$|S(i\\omega)| = \\frac{1+\\omega^2\\tau^2}{\\sqrt{(1+K-\\omega^2\\tau^2)^2 + 4\\omega^2\\tau^2}}$$\n    此表达式将用于数值计算。\n\n2.  **计算 $|S(0)|$。**\n    通过在 $|S(i\\omega)|$ 的表达式中设置 $\\omega=0$，可以找到低频灵敏度幅值。\n    $$|S(0)| = \\frac{1+0}{\\sqrt{(1+K-0)^2 + 0}} = \\frac{1}{\\sqrt{(1+K)^2}}$$\n    由于 $K \\ge 0$，这可以简化为：\n    $$|S(0)| = \\frac{1}{1+K}$$\n\n3.  **计算峰值灵敏度幅值。**\n    将生成一个频率网格 $\\omega$，包含 $N=10000$ 个点，在 $\\omega_{\\min}=10^{-6}$ 到 $\\omega_{\\max}=10^{4}$ rad/s 之间呈对数间隔。对于每个给定的 $K$，将在该网格上的每个点计算 $|S(i\\omega)|$ 的值，从而创建一个灵敏度幅值数组。峰值灵敏度是此数组中的最大值。\n    $$\\max_{\\omega\\in[\\omega_{\\min},\\omega_{\\max}]} |S(i\\omega)| \\approx \\max_{\\omega_j \\in \\text{grid}} |S(i\\omega_j)|$$\n\n4.  **计算截断的 Bode 灵敏度积分。**\n    积分 $\\int_{\\omega_{\\min}}^{\\omega_{\\max}} \\ln |S(i\\omega)|\\,\\mathrm{d}\\omega$ 将使用梯形法则进行数值近似。该方法适用于非均匀间隔的点，正如我们的对数频率网格的情况。将使用 `numpy.trapz(y, x)` 函数，其中 `y` 是函数值 $\\ln|S(i\\omega_j)|$ 的数组，`x` 是频率点 $\\omega_j$ 的数组。\n\n这些计算将展示**水床效应**：随着闭环反馈增益 $K$ 的增加，低频下的灵敏度 ($|S(0)|$) 会被抑制（即减小）。这种标称性能的改善是以高频下灵敏度的增加为代价的，这将通过峰值灵敏度幅值的增加来观察到。$\\ln|S(i\\omega)|$ 的积分是受限的，因此在一个频率区域将曲线向下压，必然会迫使其在另一个区域向上凸起。对于 $K=0$，系统是开环的，$L(s)=0$，因此对于所有频率 $S(s)=1$，得到 $|S(i\\omega)|=1$。这种情况的计算结果将是 $[1.0, 1.0, 0.0]$，可作为基准。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sensitivity metrics for a feedback-controlled signaling pathway\n    to illustrate the waterbed effect.\n    \"\"\"\n    \n    # Define the fixed parameters from the problem statement.\n    tau = 1.0  # s\n    omega_min = 1e-6  # rad/s\n    omega_max = 1e4  # rad/s\n    N = 10000  # Number of points in the frequency grid\n    \n    # Define the test cases for the gain parameter K.\n    test_cases_K = [0.0, 0.1, 1.0, 10.0, 100.0]\n\n    # Create the logarithmically spaced frequency grid.\n    omega = np.logspace(np.log10(omega_min), np.log10(omega_max), N)\n    \n    # List to store the results for each test case.\n    results = []\n\n    # Iterate through each value of K.\n    for K in test_cases_K:\n        # Task 1: Compute low-frequency sensitivity magnitude |S(0)|\n        # Analytically, |S(0)| = 1 / (1 + K) for K >= 0.\n        s0_mag = 1.0 / (1.0 + K)\n\n        # Compute the magnitude of the sensitivity function |S(i*omega)|\n        # over the entire frequency grid.\n        # Formula: |S(i*omega)| = (1 + (omega*tau)^2) / sqrt((1 + K - (omega*tau)^2)^2 + (2*omega*tau)^2)\n        omega_tau_sq = (omega * tau)**2\n        numerator = 1.0 + omega_tau_sq\n        denominator_term1 = 1.0 + K - omega_tau_sq\n        denominator = np.sqrt(denominator_term1**2 + 4.0 * omega_tau_sq)\n        \n        # Avoid division by zero, although for omega > 0 and tau > 0, this is not an issue.\n        # However, at K=0, for omega=0, denom is 1. If K=-1, it would be 0, but K>=0.\n        s_iw_mag = numerator / denominator\n\n        # Task 2: Compute the peak sensitivity magnitude over the grid.\n        peak_s_mag = np.max(s_iw_mag)\n\n        # Task 3: Compute the truncated Bode sensitivity integral.\n        # The integral is of ln|S(i*omega)|.\n        # np.log computes the natural logarithm.\n        integrand = np.log(s_iw_mag)\n        \n        # Use the trapezoidal rule for numerical integration with non-uniform spacing.\n        # np.trapz(y, x) where y=integrand and x=omega.\n        bode_integral = np.trapz(integrand, omega)\n        \n        # Round the results to 6 decimal places as required.\n        s0_mag_rounded = round(s0_mag, 6)\n        peak_s_mag_rounded = round(peak_s_mag, 6)\n        bode_integral_rounded = round(bode_integral, 6)\n\n        # Append the triple of results for the current K value.\n        results.append([s0_mag_rounded, peak_s_mag_rounded, bode_integral_rounded])\n\n    # Format the final output string according to the specification.\n    # e.g., [[x1,y1,z1],[x2,y2,z2]]\n    result_strings = []\n    for res_triple in results:\n        # Format each triple as \"[x,y,z]\"\n        result_strings.append(f\"[{res_triple[0]},{res_triple[1]},{res_triple[2]}]\")\n    \n    # Join the formatted triples with commas and enclose in brackets.\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Print the final, single-line output.\n    print(final_output)\n\n# Run the solver.\nsolve()\n```", "id": "4339439"}]}