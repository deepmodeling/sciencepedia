{"hands_on_practices": [{"introduction": "在模型拟合中，仅仅获得参数的最佳估计值只是第一步。为了得出稳健的科学结论，我们还必须量化该估计值的不确定性。本练习将介绍一种强大而直观的计算方法——自举法（bootstrapping），用于估计参数的置信区间。我们将把这一技术应用于一个常见的生物学场景：信使RNA（mRNA）的降解过程，从而为我们估计的降解速率提供一个统计置信度的度量。[@problem_id:1447275]", "problem": "一位系统生物学家正在研究真核细胞中一种特定信使核糖核酸 (mRNA) 分子的稳定性。在转录停止后，该 mRNA 降解的主流模型是一级衰减，由方程 $M(t) = M_0 \\exp(-\\gamma t)$ 描述。在此模型中，$M(t)$ 是时间 $t$ 时的 mRNA 浓度，$M_0$ 是 $t=0$ 时的初始浓度，而 $\\gamma$ 是恒定的降解速率。\n\n为了估计 $\\gamma$，进行了一项实验，在 $t=0$ 时停止转录，并在随后的几个时间点测量 mRNA 浓度。收集到的数据如下：\n\n| 时间, $t$ (分钟) | mRNA 浓度, $M$ (任意单位) |\n|---|---|\n| 0 | 102.1 |\n| 10 | 59.8 |\n| 20 | 35.5 |\n| 30 | 23.0 |\n| 40 | 14.1 |\n\n为了评估 $\\gamma$ 估计值的统计置信度，进行了一项自助法 (bootstrap) 分析。该分析包括通过对原始的五对数据进行有放回的随机抽样，生成 $B=1000$ 个新的数据集。对于每个自助法数据集，通过对变换后的模型 $\\ln(M(t)) = \\ln(M_0) - \\gamma t$ 进行线性最小二乘拟合，重新估计降解速率 $\\gamma$。\n\n该过程产生了 1000 个降解速率的自助法估计值，记为 $\\{\\gamma^*_1, \\gamma^*_2, \\dots, \\gamma^*_{1000}\\}$。然后将这些估计值按升序排序。以下是该排序列表中的两段摘录：\n\n- 排名在 23 至 28 的值：\n`0.0488, 0.0491, 0.0493, 0.0495, 0.0496, 0.0499`\n\n- 排名在 973 至 978 的值：\n`0.0525, 0.0527, 0.0529, 0.0531, 0.0533, 0.0538`\n\n使用百分位数法处理此自助法分布，确定降解速率 $\\gamma$ 的 95% 置信区间。请给出该区间的下限和上限作为答案。最终答案以 min$^{-1}$ 为单位表示。将每个界限四舍五入到三位有效数字。", "solution": "降解模型为 $M(t)=M_{0}\\exp(-\\gamma t)$，取自然对数后，变为线性关系\n$$\n\\ln(M(t))=\\ln(M_{0})-\\gamma t,\n$$\n因此，对 $(t,\\ln M)$ 数据进行最小二乘拟合得到的斜率为 $-\\gamma$。使用 $B=1000$ 次重抽样的自助法产生估计值 $\\{\\gamma^{*}_{1},\\dots,\\gamma^{*}_{1000}\\}$。对于置信水平为 $1-\\alpha=0.95$ 的百分位数法，置信区间由排序后的自助法分布在概率 $p_{L}=\\alpha/2=0.025$ 和 $p_{U}=1-\\alpha/2=0.975$ 处的经验分位数给出。\n\n设顺序统计量为 $\\gamma^{*}_{(1)}\\leq\\dots\\leq\\gamma^{*}_{(B)}$。使用常见的百分位数规则，选取秩为\n$$\nr_{L}=p_{L}B=0.025\\times 1000=25,\\qquad r_{U}=p_{U}B=0.975\\times 1000=975,\n$$\n的顺序统计量，则 $95$% 置信区间为 $[\\gamma^{*}_{(25)},\\gamma^{*}_{(975)}]$。\n\n根据提供的排序列表摘录：\n- 排名 $23$ 至 $28$ 的值为 $0.0488, 0.0491, 0.0493, 0.0495, 0.0496, 0.0499$，所以 $\\gamma^{*}_{(25)}=0.0493$。\n- 排名 $973$ 至 $978$ 的值为 $0.0525, 0.0527, 0.0529, 0.0531, 0.0533, 0.0538$，所以 $\\gamma^{*}_{(975)}=0.0529$。\n\n因此，$\\gamma$ 的 95% 百分位数置信区间为 $[0.0493,\\,0.0529]$，单位为 $\\text{min}^{-1}$。将每个界限四舍五入到三位有效数字，其值保持不变。", "answer": "$$\\boxed{\\begin{pmatrix}0.0493  0.0529\\end{pmatrix}}$$", "id": "1447275"}, {"introduction": "将模型与数据拟合后，一个至关重要的步骤是评估模型在多大程度上真实地描述了数据。本练习聚焦于残差分析，这是一种关键的诊断工具。通过检查观测数据与模型预测值之间的差异模式（即残差），我们可以识别出系统性的偏差，这些偏差可能表明我们的模型并不完整或存在错误设定。[@problem_id:1447309]", "problem": "一位系统生物学家正在分析一个细菌种群的生长动态。在几个时间点记录了以任意单位的光密度（OD）测量的种群密度。该生物学家提出，其生长可以用逻辑斯谛模型来描述：\n$$N(t) = \\frac{K}{1 + \\left(\\frac{K}{N_0} - 1\\right) \\exp(-r t)}$$\n其中 $N(t)$ 是时间 $t$ 时的种群密度，$N_0$ 是初始种群密度，$K$ 是环境承载力，$r$ 是内禀增长率。\n\n在对实验数据进行非线性回归分析后，确定最佳拟合参数为环境承载力 $K = 1.0$，初始密度 $N_0 = 0.1$，以及内禀增长率 $r = 0.5 \\text{ 小时}^{-1}$。\n\n时间和对应的光密度测量值如下：\n- 在 $t_1 = 0$ 小时，OD = 0.11\n- 在 $t_2 = 2$ 小时，OD = 0.22\n- 在 $t_3 = 4$ 小时，OD = 0.44\n- 在 $t_4 = 6$ 小时，OD = 0.70\n- 在 $t_5 = 8$ 小时，OD = 0.85\n\n为了评估拟合的质量并检查是否存在系统性的随时间变化的偏差，该生物学家决定基于残差计算一个趋势度量。第 $i$ 个数据点的残差定义为 $R_i = \\text{OD}_i - N(t_i)$，其中 $\\text{OD}_i$ 是测量值，$N(t_i)$ 是模型在时间 $t_i$ 的预测值。\n\n计算趋势度量 $T = \\sum_{i=1}^{n-1} R_i R_{i+1}$ 的值，其中 $n=5$ 是数据点的总数。该度量代表连续残差乘积之和。将您的最终答案以四舍五入到三位有效数字的形式报告。", "solution": "逻辑斯谛模型由下式给出\n$$N(t) = \\frac{K}{1 + \\left(\\frac{K}{N_{0}} - 1\\right)\\exp(-r t)}.$$\n使用最佳拟合参数 $K=1$，$N_{0}=0.1$ 和 $r=0.5$，该模型简化为\n$$N(t) = \\frac{1}{1 + 9\\,\\exp(-0.5\\,t)}.$$\n在给定的时间点计算 $N(t_{i})$：\n- 在 $t_{1}=0$ 时：\n$$N(0) = \\frac{1}{1 + 9\\,\\exp(0)} = \\frac{1}{10} = 0.1.$$\n- 在 $t_{2}=2$ 时：\n$$N(2) = \\frac{1}{1 + 9\\,\\exp(-1)} \\approx \\frac{1}{1 + 9 \\times 0.367879441171} \\approx \\frac{1}{4.310914970543} \\approx 0.231969315.$$\n- 在 $t_{3}=4$ 时：\n$$N(4) = \\frac{1}{1 + 9\\,\\exp(-2)} \\approx \\frac{1}{1 + 9 \\times 0.135335283237} \\approx \\frac{1}{2.21801754913} \\approx 0.450852701.$$\n- 在 $t_{4}=6$ 时：\n$$N(6) = \\frac{1}{1 + 9\\,\\exp(-3)} \\approx \\frac{1}{1 + 9 \\times 0.049787068368} \\approx \\frac{1}{1.44808361531} \\approx 0.690567858.$$\n- 在 $t_{5}=8$ 时：\n$$N(8) = \\frac{1}{1 + 9\\,\\exp(-4)} \\approx \\frac{1}{1 + 9 \\times 0.018315638889} \\approx \\frac{1}{1.16484075000} \\approx 0.858486450.$$\n计算残差 $R_{i} = \\text{OD}_{i} - N(t_{i})$：\n$$R_{1} = 0.11 - 0.1 = 0.01,$$\n$$R_{2} = 0.22 - 0.231969315 = -0.011969315,$$\n$$R_{3} = 0.44 - 0.450852701 = -0.010852701,$$\n$$R_{4} = 0.70 - 0.690567858 = 0.009432142,$$\n$$R_{5} = 0.85 - 0.858486450 = -0.008486450.$$\n计算趋势度量\n$$T = \\sum_{i=1}^{4} R_{i}R_{i+1} = R_{1}R_{2} + R_{2}R_{3} + R_{3}R_{4} + R_{4}R_{5}.$$\n逐项计算：\n$$R_{1}R_{2} = 0.01 \\times (-0.011969315) = -0.00011969315,$$\n$$R_{2}R_{3} = (-0.011969315)\\times(-0.010852701) \\approx 0.000129899401,$$\n$$R_{3}R_{4} = (-0.010852701)\\times(0.009432142) \\approx -0.000102364220,$$\n$$R_{4}R_{5} = (0.009432142)\\times(-0.008486450) \\approx -0.000080045401.$$\n将这些贡献相加得到\n$$T \\approx -0.00011969315 + 0.000129899401 - 0.000102364220 - 0.000080045401 \\approx -0.000172203371.$$\n四舍五入到三位有效数字，得到\n$$T \\approx -1.72 \\times 10^{-4}.$$", "answer": "$$\\boxed{-1.72 \\times 10^{-4}}$$", "id": "1447309"}, {"introduction": "系统生物学中的许多过程都由常微分方程（ODE）等动态模型描述。本练习将带您进入对此类复杂模型进行贝叶斯推断的高级领域，重点介绍哈密顿蒙特卡洛（HMC）方法，这是一种前沿的采样技术。您将需要理解HMC的核心组成部分，以及它如何利用通过伴随法等高效计算出的梯度信息，来探索复杂生物系统的高维参数空间。[@problem_id:3925022]", "problem": "一个合成生物学的基因表达模型被设定为一个常微分方程（ODE）系统，其中信使核糖核酸（mRNA）浓度 $m(t)$ 和蛋白质浓度 $p(t)$ 的演化遵循\n$$\n\\frac{dm}{dt} = \\alpha - \\delta_m m, \\qquad \\frac{dp}{dt} = \\beta m - \\delta_p p,\n$$\n其中参数 $\\theta = (\\alpha,\\beta,\\delta_m,\\delta_p)$ 以及初始条件 $m(0)$ 和 $p(0)$ 已知。在时间 $t_k$（$k=1,\\dots,n$）收集蛋白质浓度的观测值 $y_k$。这些观测值带有方差为 $\\sigma^2$ 的加性高斯测量噪声，因此 $y_k = p(t_k;\\theta) + \\varepsilon_k$，其中 $\\varepsilon_k \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立同分布的。先验分布 $p(\\theta)$ 代表了关于可行速率的生物学知识，我们寻求通过马尔可夫链蒙特卡洛（MCMC）方法对 $\\theta$ 进行贝叶斯推断。\n\n根据贝叶斯法则，后验密度满足 $p(\\theta \\mid y) \\propto p(y \\mid \\theta)\\,p(\\theta)$，其中 $y=(y_1,\\dots,y_n)$，$p(y \\mid \\theta)$ 是由ODE解和高斯噪声模型导出的似然。考虑使用带有对称正定质量矩阵 $M$ 的哈密顿蒙特卡洛（HMC）方法从 $p(\\theta \\mid y)$ 中采样。在HMC中，正则坐标 $(\\theta,p)$ 引入了一个辅助动量 $p$ 和一个哈密顿量 $H(\\theta,p)$。该哈密顿量分解为一个势能 $U(\\theta)$ 和一个动能 $K(p)$，通过对哈密顿动力学进行数值积分来驱动确定性提议。算法需要计算关于 $\\theta$ 的梯度；对于基于ODE的似然，这些梯度通过伴随灵敏度方法获得。在该方法中，一个时间反向的伴随方程被积分，其在观测时间点有跳跃条件，并包含从测量残差导出的源项，最终得到 $\\nabla_{\\theta}\\log p(y \\mid \\theta)$。像蛙跳法这样的辛积分器使用步长 $\\varepsilon0$ 和质量矩阵 $M$ 来演化 $(\\theta,p)$，并保持体积和可逆性。\n\n对于这个基于ODE的合成生物学模型，哪个选项正确地指定了势能 $U(\\theta)$、动能 $K(p)$ 以及根据通过伴随方法计算的 $\\nabla_{\\theta}\\log p(\\theta \\mid y)$ 进行的蛙跳法更新？\n\nA. $U(\\theta) = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big)$（至多相差一个加性常数）；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，再然后 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta) = -\\nabla_{\\theta} \\log p(\\theta \\mid y)$，而 $\\nabla_{\\theta}\\log p(y \\mid \\theta)$ 通过伴随灵敏度方法计算，并加上来自先验的 $\\nabla_{\\theta}\\log p(\\theta)$。\n\nB. $U(\\theta) = \\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} M p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M p$，再然后 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过ODE的伴随方法计算。\n\nC. 仅有 $U(\\theta) = -\\log p(y \\mid \\theta)$；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，再然后 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$；其中 $\\nabla_{\\theta} \\log p(\\theta \\mid y)$ 通过ODE解的前向灵敏度计算。\n\nD. $U(\\theta) = -\\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} p$；步长为 $\\varepsilon$ 的蛙跳法：\n首先 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$，然后 $p \\leftarrow p - \\varepsilon\\,\\nabla_{\\theta} U(\\theta)$，再然后 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过 $\\log p(\\theta \\mid y)$ 的有限差分来近似。", "solution": "问题要求为由常微分方程（ODE）系统描述的合成生物学模型中的参数进行贝叶斯推断，确定哈密顿蒙特卡洛（HMC）算法的正确表述。让我们根据第一性原理和问题描述来推导HMC算法的各个组成部分。\n\n贝叶斯推断的目标是从参数 $\\theta$ 的后验分布中采样，该分布由贝叶斯法则给出：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) \\, p(\\theta)\n$$\n其中 $y = (y_1, \\dots, y_n)$ 代表观测数据。\n\n哈密顿蒙特卡洛是一种马尔可夫链蒙特卡洛（MCMC）方法，它使用哈密顿动力学的框架来提议新状态。它定义了一个具有坐标 $(\\theta, p)$ 的相空间，其中 $\\theta$ 是我们感兴趣的参数（位置），$p$ 是一个与 $\\theta$ 维度相同的辅助动量变量。\n\n哈密顿量 $H(\\theta, p)$ 定义为势能 $U(\\theta)$ 和动能 $K(p)$ 的和：\n$$\nH(\\theta, p) = U(\\theta) + K(p)\n$$\n\n**1. 势能 $U(\\theta)$**\n在HMC中，势能 $U(\\theta)$ 定义为目标概率密度函数的负对数（至多相差一个加性常数）。目标密度是后验分布 $p(\\theta \\mid y)$。\n$$\nU(\\theta) = -\\log p(\\theta \\mid y) + C_1\n$$\n其中 $C_1$ 是一个任意常数。使用贝叶斯法则的后验表达式：\n$$\nU(\\theta) = -\\log \\big(p(y \\mid \\theta) \\, p(\\theta)\\big) + C_2 = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big) + C_2\n$$\n常数不影响动力学过程，通常被省略。因此，势能为：\n$$\nU(\\theta) = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big)\n$$\n\n**2. 动能 $K(p)$**\n动量 $p$ 通常从一个独立于 $\\theta$ 的零均值高斯分布中抽取。动能定义为该高斯分布密度的负对数。对于一个协方差矩阵为 $M$ 的通用多元高斯分布，其密度为 $p(p) \\propto \\exp(-\\frac{1}{2} p^{\\top} M^{-1} p)$。\n质量矩阵 $M$ 是一个对称正定矩阵，可以对其进行调整以提高采样效率。因此，动能为：\n$$\nK(p) = \\frac{1}{2} p^{\\top} M^{-1} p\n$$\n\n**3. 哈密顿动力学与蛙跳积分器**\n系统在相空间中的演化由哈密顿方程控制：\n$$\n\\frac{d\\theta_i}{dt} = \\frac{\\partial H}{\\partial p_i} = \\frac{\\partial K}{\\partial p_i} \\implies \\frac{d\\theta}{dt} = \\nabla_p K(p) = M^{-1} p\n$$\n$$\n\\frac{dp_i}{dt} = -\\frac{\\partial H}{\\partial \\theta_i} = -\\frac{\\partial U}{\\partial \\theta_i} \\implies \\frac{dp}{dt} = -\\nabla_{\\theta} U(\\theta)\n$$\n为了模拟这些动力学过程，我们使用数值积分器。蛙跳法（或Störmer-Verlet法）是一个常见的选择，因为它是一种辛积分器，能够保持相空间体积并且时间可逆。标准蛙跳积分器（特别是速度Verlet变体）步长为 $\\varepsilon$ 的单步更新包括三个步骤：\n1.  对动量进行半步更新：$p \\leftarrow p - \\frac{\\varepsilon}{2} \\nabla_{\\theta} U(\\theta)$。\n2.  对位置进行全步更新：$\\theta \\leftarrow \\theta + \\varepsilon M^{-1} p$。\n3.  使用新位置处的梯度，对动量进行最后的半步更新：$p \\leftarrow p - \\frac{\\varepsilon}{2} \\nabla_{\\theta} U(\\theta)$。\n\n**4. 梯度项 $\\nabla_{\\theta} U(\\theta)$**\n动量更新需要势能的梯度。\n$$\n\\nabla_{\\theta} U(\\theta) = \\nabla_{\\theta} \\left( -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big) \\right) = -\\left( \\nabla_{\\theta} \\log p(y \\mid \\theta) + \\nabla_{\\theta} \\log p(\\theta) \\right)\n$$\n这等价于 $\\nabla_{\\theta} U(\\theta) = -\\nabla_{\\theta} \\log p(\\theta \\mid y)$。问题陈述中提到，似然梯度 $\\nabla_{\\theta} \\log p(y \\mid \\theta)$ 是使用伴随灵敏度方法计算的，并且必须加上对数先验的梯度 $\\nabla_{\\theta} \\log p(\\theta)$。这与我们的推导完全一致。\n\n**逐项分析**\n\nA. **$U(\\theta) = -\\big(\\log p(y \\mid \\theta) + \\log p(\\theta)\\big)$（至多相差一个加性常数）；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，再然后 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta) = -\\nabla_{\\theta} \\log p(\\theta \\mid y)$，而 $\\nabla_{\\theta}\\log p(y \\mid \\theta)$ 通过伴随灵敏度方法计算，并加上来自先验的 $\\nabla_{\\theta}\\log p(\\theta)$。**\n-   势能 $U(\\theta)$ 被正确地指定为负对数后验。\n-   动能 $K(p)$ 被正确地指定，使用了逆质量矩阵 $M^{-1}$。\n-   蛙跳法更新是标准的速度Verlet实现，是正确的。\n-   关于梯度 $\\nabla_{\\theta} U(\\theta)$ 如何计算的描述与其定义以及问题陈述中给出的信息一致。\n-   **结论：正确。**\n\nB. **$U(\\theta) = \\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} M p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M p$，再然后 $p \\leftarrow p + \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} U(\\theta)$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过ODE的伴随方法计算。**\n-   势能 $U(\\theta)$ 的符号错误。它应该是负对数后验。\n-   动能 $K(p)$ 使用了 $M$ 而不是 $M^{-1}$。这是一个非标准的表述，与标准的HMC推导不一致。\n-   动量的蛙跳法更新符号错误（应为 `-` 而不是 `+`）。\n-   **结论：不正确。**\n\nC. **仅有 $U(\\theta) = -\\log p(y \\mid \\theta)$；$K(p) = \\tfrac{1}{2} p^{\\top} M^{-1} p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$，然后 $\\theta \\leftarrow \\theta + \\varepsilon\\, M^{-1} p$，再然后 $p \\leftarrow p - \\tfrac{\\varepsilon}{2}\\,\\nabla_{\\theta} \\log p(\\theta \\mid y)$；其中 $\\nabla_{\\theta} \\log p(\\theta \\mid y)$ 通过ODE解的前向灵敏度计算。**\n-   势能 $U(\\theta)$ 不完整；它省略了先验项 $\\log p(\\theta)$。这将导致从似然而不是后验进行采样。\n-   关于梯度计算方法的描述（“前向灵敏度”）与问题陈述相矛盾，问题陈述指定的是“伴随灵敏度方法”。\n-   该选项内部存在矛盾：$U(\\theta)$ 仅基于似然定义，但蛙跳法更新却使用了对数后验的梯度 $\\nabla_{\\theta} \\log p(\\theta \\mid y)$。\n-   **结论：不正确。**\n\nD. **$U(\\theta) = -\\log p(\\theta \\mid y)$；$K(p) = \\tfrac{1}{2} p^{\\top} p$；步长为 $\\varepsilon$ 的蛙跳法：首先 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$，然后 $p \\leftarrow p - \\varepsilon\\,\\nabla_{\\theta} U(\\theta)$，再然后 $\\theta \\leftarrow \\theta + \\tfrac{\\varepsilon}{2}\\, p$；其中 $\\nabla_{\\theta} U(\\theta)$ 通过 $\\log p(\\theta \\mid y)$ 的有限差分来近似。**\n-   势能 $U(\\theta)$ 被正确地表述为 $-\\log p(\\theta \\mid y)$。\n-   动能 $K(p)$ 是质量矩阵 $M$ 为单位矩阵（$M=I$）的特例。虽然这是一个有效的选择，但问题陈述指的是一个通用的对称正定质量矩阵 $M$。\n-   蛙跳法更新对应于一个有效的“位置Verlet”变体，但它们是针对 $M=I$ 的特例。\n-   至关重要的是，计算梯度的方法（“通过有限差分近似”）与问题陈述直接矛盾，问题陈述指定了“伴随灵敏度方法”。\n-   **结论：不正确。**\n\n基于详细分析，选项A是唯一一个为给定问题情境提供了完全正确且一致的HMC算法描述的选项。", "answer": "$$\\boxed{A}$$", "id": "3925022"}]}