{"hands_on_practices": [{"introduction": "理论联系实践是掌握任何计算概念的关键。本节将通过一系列动手实践，带你深入理解网络模块度分析的核心。我们从一个最基础的练习开始：为一个简单的小型网络计算模块度$Q$。这个练习将帮助你巩固模块度的基本定义，即比较社区内部观察到的边权重与在随机网络（零模型）中期望的边权重之间的差异。[@problem_id:4365529]", "problem": "在系统生物医学中，分子相互作用网络中的社群结构通常通过模块度得分来量化，该得分将观测到的模块内连接性与一个度保持的随机零模型进行比较。考虑一个无向简单加权网络，其节点集为 $\\{1,2,3,4\\}$，边为 $(1,2)$, $(2,3)$, $(3,4)$，每条边的权重均为 $1$。令 $A_{ij}$ 表示对称加权邻接矩阵的元素，令 $k_i$ 表示节点强度（与节点 $i$ 相关联的边的权重之和）。令 $m$ 表示总边权重，因此 $2m=\\sum_{i}k_i$。度保持零模型（配置模型，CM）的期望邻接关系 $\\mathbb{E}[A_{ij}]$ 仅取决于 $\\{k_i\\}$ 和 $m$。\n\n从模块度的基本定义（即观测到的社群内部边权重分数与其在度保持零模型下的期望值之间的归一化差异）出发，推导划分 $\\{\\{1,2\\},\\{3,4\\}\\}$ 的模块度 $Q$ 的表达式，并计算其在该网络中的值。根据 $Q$ 的符号，判断此划分是否相对于随机情况增加了 $Q$ 值。将最终数值结果表示为一个未经四舍五入的精确有理数。", "solution": "用户提供的问题经评估有效。它在科学上基于网络理论，问题设定良好，有唯一答案，是客观的，并包含了求解所需的所有必要信息。\n\n该问题要求对给定加权网络的特定划分，推导并计算其模块度得分 $Q$。如上所述，模块度的基本定义是观测到的社群内部边权重分数与在度保持零模型（配置模型）下的期望值之间的归一化差异。\n\n首先，我们根据给定信息形式化网络结构和属性。\n该网络有一个节点集 $V=\\{1,2,3,4\\}$ 和三条权重均为 $1$ 的边：$(1,2)$, $(2,3)$ 和 $(3,4)$。\n加权邻接矩阵 $A$（其中 $A_{ij}$ 是节点 $i$ 和 $j$ 之间边的权重）为：\n$$\nA = \\begin{pmatrix}\n0  1  0  0 \\\\\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n0  0  1  0\n\\end{pmatrix}\n$$\n节点 $i$ 的强度，记为 $k_i$，是所有连接到该节点的边的权重之和，$k_i = \\sum_j A_{ij}$。我们计算每个节点的强度：\n- $k_1 = A_{12} = 1$\n- $k_2 = A_{21} + A_{23} = 1 + 1 = 2$\n- $k_3 = A_{32} + A_{34} = 1 + 1 = 2$\n- $k_4 = A_{43} = 1$\n\n网络的总边权重 $m$ 是所有边权重之和：$m = 1+1+1=3$。这可以通过关系式 $2m = \\sum_i k_i$ 进行验证，即 $2m = k_1+k_2+k_3+k_4 = 1+2+2+1=6$，因此 $m=3$。\n\n指定的划分将节点分为两个社群：$C_1 = \\{1,2\\}$ 和 $C_2 = \\{3,4\\}$。\n\n我们可以从基本原理推导模块度 $Q$ 的表达式。令 $L_s$ 为社群 $s$ 内部的边权重之和，令 $K_s$ 为社群 $s$ 中所有节点的强度之和。令 $m$ 为网络中的总边权重。\n\n落在社群 $s$ 内部的总边权重分数为 $e_{ss} = \\frac{L_s}{m}$。\n连接到社群 $s$ 中节点的所有边“端点”（或配置模型中的“末梢”）的分数为 $a_s = \\frac{K_s}{2m}$。在一个通过均匀随机连接末梢来形成边的随机网络中，随机选择一条边的两端都落在社群 $s$ 内的概率是 $a_s \\times a_s = a_s^2$。$a_s^2$ 这一项表示在度保持零模型下，社群 $s$ 内部的期望总边权重分数。\n\n模块度 $Q$ 是划分中所有社群的观测分数与期望分数之差的总和：\n$$\nQ = \\sum_{s} (e_{ss} - a_s^2) = \\sum_{s} \\left[ \\frac{L_s}{m} - \\left(\\frac{K_s}{2m}\\right)^2 \\right]\n$$\n这是加权网络模块度的一个标准且直接的公式。现在，我们为给定的划分计算必要的量。\n\n对于社群 $C_1 = \\{1,2\\}$：\n- 社群内部权重 $L_1$ 是边 $(1,2)$ 的权重，所以 $L_1 = 1$。\n- 节点强度之和 $K_1$ 是 $k_1 + k_2 = 1 + 2 = 3$。\n\n对于社群 $C_2 = \\{3,4\\}$：\n- 社群内部权重 $L_2$ 是边 $(3,4)$ 的权重，所以 $L_2 = 1$。\n- 节点强度之和 $K_2$ 是 $k_3 + k_4 = 2 + 1 = 3$。\n\n网络总权重为 $m=3$，且 $2m=6$。\n\n现在我们可以计算每个社群对 $Q$ 的贡献项。\n\n来自 $C_1$ 的贡献：\n$$e_{11} - a_1^2 = \\frac{L_1}{m} - \\left(\\frac{K_1}{2m}\\right)^2 = \\frac{1}{3} - \\left(\\frac{3}{6}\\right)^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4}$$\n$$ = \\frac{4}{12} - \\frac{3}{12} = \\frac{1}{12}$$\n\n来自 $C_2$ 的贡献：\n$$e_{22} - a_2^2 = \\frac{L_2}{m} - \\left(\\frac{K_2}{2m}\\right)^2 = \\frac{1}{3} - \\left(\\frac{3}{6}\\right)^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4}$$\n$$ = \\frac{4}{12} - \\frac{3}{12} = \\frac{1}{12}$$\n\n总模块度 $Q$ 是这些贡献的总和：\n$$Q = (e_{11} - a_1^2) + (e_{22} - a_2^2) = \\frac{1}{12} + \\frac{1}{12} = \\frac{2}{12} = \\frac{1}{6}$$\n\n计算出的模块度为 $Q = \\frac{1}{6}$。\n\n模块度得分的符号表明该划分所识别的社群结构是否比随机预期的更显著。由于 $Q > 0$，划分 $\\{\\{1,2\\},\\{3,4\\}\\}$ 中社群内部的边密度（总权重）大于配置模型零假设下的期望值。因此，这个划分反映了网络中有意义的社群结构，并且它相对于随机基线增加了 $Q$ 值。", "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$", "id": "4365529"}, {"introduction": "生物网络通常具有特殊的结构，直接应用标准模块度公式可能产生误导性结果。一个常见的例子是转录因子-基因调控网络，它天然是二分图结构。这个练习将引导你计算一个假设的二分网络的模块度，让你掌握如何为这类特殊网络调整零模型，从而进行更准确的社区发现。[@problem_id:4365476]", "problem": "考虑一个系统生物医学中的小型基因调控网络，该网络被建模为一个加权二分图，其中转录因子 (TF) 和基因构成两个不相交的节点集。TF集为 $\\{T_1, T_2\\}$，基因集为 $\\{G_1, G_2\\}$。边权重表示从实验测定中推断出的归一化调控相互作用强度，且只存在 TF 到基因的相互作用。为了在二分结构上进行模块度分析，将该图视为无向图。非零边权重为：$w_{T_1 G_1} = 2$，$w_{T_1 G_2} = 1$，$w_{T_2 G_1} = 1$ 以及 $w_{T_2 G_2} = 3$。所有其他 TF-基因对的权重为 $0$。考虑将网络划分为 $2$ 个社群：一个社群包含 $(T_1, G_1)$，另一个社群包含 $(T_2, G_2)$。使用经典的二分模块度方法，该方法在保留节点强度的二分结构零模型下，将观察到的 TF-基因权重与其期望值进行比较，计算此划分的模块度 $Q$。将最终答案表示为无单位的最简分数。", "solution": "用户提供的问题已经过分析，被认为是有效的。该问题具有科学依据，提法明确，客观，并为得出唯一解提供了所有必要信息。\n\n该问题要求计算一个加权二分图给定划分的模块度 $Q$。该图表示一个基因调控网络，包含两个不相交的节点集：一个转录因子 (TF) 集 $U = \\{T_1, T_2\\}$，和一个基因集 $V = \\{G_1, G_2\\}$。\n\n二分图的经典模块度，记为 $Q_b$，其定义基于社群内部的边权重之和与在适当的零模型下期望的权重之和之间的比较。对于加权二分图，公式为：\n$$Q_b = \\frac{1}{m} \\sum_{i \\in U, j \\in V} \\left( A_{ij} - \\frac{k_i d_j}{m} \\right) \\delta(c_i, c_j)$$\n其中：\n- $A_{ij}$ 是来自第一个集合（TF）的节点 $i$ 与来自第二个集合（基因）的节点 $j$ 之间的边权重。\n- $m$ 是网络中所有边的总权重。\n- $k_i$ 是节点 $i \\in U$ 的强度（加权度），计算公式为 $k_i = \\sum_{j \\in V} A_{ij}$。\n- $d_j$ 是节点 $j \\in V$ 的强度（加权度），计算公式为 $d_j = \\sum_{i \\in U} A_{ij}$。\n- $c_i$ 是节点 $i$ 所属的社群。\n- $\\delta(c_i, c_j)$ 是克罗内克δ函数，如果节点 $i$ 和 $j$ 在同一个社群中（$c_i=c_j$），则其值为 $1$，否则为 $0$。\n\n首先，我们必须根据给定的问题陈述计算必要的量。\n\n给定的边权重如下：\n- $w_{T_1 G_1} = A_{T_1, G_1} = 2$\n- $w_{T_1 G_2} = A_{T_1, G_2} = 1$\n- $w_{T_2 G_1} = A_{T_2, G_1} = 1$\n- $w_{T_2 G_2} = A_{T_2, G_2} = 3$\n\n所有边的总权重 $m$ 是这些权重之和：\n$$m = A_{T_1, G_1} + A_{T_1, G_2} + A_{T_2, G_1} + A_{T_2, G_2} = 2 + 1 + 1 + 3 = 7$$\n\n接下来，我们计算每个节点的强度（加权度）。\n对于集合 $U$ 中的 TF 节点：\n- $k_{T_1} = A_{T_1, G_1} + A_{T_1, G_2} = 2 + 1 = 3$\n- $k_{T_2} = A_{T_2, G_1} + A_{T_2, G_2} = 1 + 3 = 4$\n\n对于集合 $V$ 中的基因节点：\n- $d_{G_1} = A_{T_1, G_1} + A_{T_2, G_1} = 2 + 1 = 3$\n- $d_{G_2} = A_{T_1, G_2} + A_{T_2, G_2} = 1 + 3 = 4$\n\n问题指定了划分为 $2$ 个社群：\n- 社群 $1$ ($C_1$)：包含节点 $\\{T_1, G_1\\}$。\n- 社群 $2$ ($C_2$)：包含节点 $\\{T_2, G_2\\}$。\n\n模块度公式对属于同一社群的节点对 $(i,j)$（其中 $i \\in U$ 且 $j \\in V$）的贡献进行求和。项 $\\delta(c_i, c_j)$ 确保了这一点。\n对于给定的划分，来自不同集合 $(U, V)$ 且处于同一社群的节点对是 $C_1$ 中的 $(T_1, G_1)$ 和 $C_2$ 中的 $(T_2, G_2)$。所有其他节点对，$(T_1, G_2)$ 和 $(T_2, G_1)$，处于不同社群，因此它们对总和的贡献为零。\n\n因此，模块度的计算简化为：\n$$Q = \\frac{1}{m} \\left[ \\left( A_{T_1, G_1} - \\frac{k_{T_1} d_{G_1}}{m} \\right) + \\left( A_{T_2, G_2} - \\frac{k_{T_2} d_{G_2}}{m} \\right) \\right]$$\n\n现在我们将计算出的值代入此表达式：\n- $m = 7$\n- $A_{T_1, G_1} = 2$ 且 $A_{T_2, G_2} = 3$\n- $k_{T_1} = 3$ 且 $d_{G_1} = 3$\n- $k_{T_2} = 4$ 且 $d_{G_2} = 4$\n\n$$Q = \\frac{1}{7} \\left[ \\left( 2 - \\frac{3 \\times 3}{7} \\right) + \\left( 3 - \\frac{4 \\times 4}{7} \\right) \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\left( 2 - \\frac{9}{7} \\right) + \\left( 3 - \\frac{16}{7} \\right) \\right]$$\n为了进行括号内的减法，我们通分：\n$$Q = \\frac{1}{7} \\left[ \\left( \\frac{14}{7} - \\frac{9}{7} \\right) + \\left( \\frac{21}{7} - \\frac{16}{7} \\right) \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\frac{5}{7} + \\frac{5}{7} \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\frac{10}{7} \\right]$$\n$$Q = \\frac{10}{49}$$\n分数 $\\frac{10}{49}$ 已经是最简形式，因为 $10$ 和 $49$ 的最大公约数为 $1$。\n给定划分的模块度为 $\\frac{10}{49}$。", "answer": "$$\\boxed{\\frac{10}{49}}$$", "id": "4365476"}, {"introduction": "除了二分结构，方向性是生物网络中另一个至关重要的特征，例如在信号传导通路或基因调控网络中，相互作用是有方向的。因此，模块度分析必须考虑边的方向。这个练习将挑战你为一个有向网络计算模块度，这需要你区分并使用每个节点的入度（$k^{\\text{in}}$）和出度（$k^{\\text{out}}$）来构建正确的零模型。[@problem_id:4365539]", "problem": "在系统生物医学中，有向生物分子相互作用网络（如基因调控网络 GRN）中的社区发现，通常通过一个称为网络模块度的标量来量化。该模块度衡量了给定的划分在多大程度上将边集中在社区内部，超出了在保持入度和出度序列不变的随机零模型下的预期。考虑一个有向网络，包含节点 $1$、$2$ 和 $3$，以及有向边 $1 \\to 2$、$2 \\to 3$ 和 $3 \\to 1$。设节点的划分为 $\\{\\{1,2\\},\\{3\\}\\}$，其中节点 $1$ 和 $2$ 形成一个社区，节点 $3$ 单独在另一个社区中。使用保持每个节点入度和出度的有向网络标准配置模型零系综，计算该划分的模块度 $Q$。您的计算必须按以下步骤进行：首先明确计算每个节点 $i \\in \\{1,2,3\\}$ 的入度 $k_{i}^{\\text{in}}$ 和出度 $k_{i}^{\\text{out}}$，然后评估观测到的社区内部边数及其在零模型下的期望值，最后将这些组合起来计算指定划分的模块度 $Q$。请将您的最终答案表示为一个精确的有理数，不进行四舍五入。", "solution": "问题要求计算一个特定有向网络给定划分的模块度 $Q$。有向网络的模块度衡量了与随机零模型相比，边在社区内集中的程度。对于一个将有向网络划分为一组社区 $\\{c\\}$ 的划分，模块度 $Q$ 的标准定义如下：\n\n$$ Q = \\frac{1}{M} \\sum_{i,j} \\left[ A_{ij} - P_{ij} \\right] \\delta(c_i, c_j) $$\n\n其中：\n- $M$ 是网络中的总边数。\n- $A_{ij}$ 是邻接矩阵元素，如果存在从节点 $i$ 到节点 $j$ 的有向边，则为 $1$，否则为 $0$。\n- $P_{ij}$ 是在配置零模型中存在从节点 $i$ 到节点 $j$ 的边的概率，由 $P_{ij} = \\frac{k_i^{\\text{out}} k_j^{\\text{in}}}{M}$ 给出。这里，$k_i^{\\text{out}}$ 是节点 $i$ 的出度，$k_j^{\\text{in}}$ 是节点 $j$ 的入度。\n- $c_i$ 是节点 $i$ 所属的社区。\n- $\\delta(c_i, c_j)$ 是克罗内克 delta 函数，如果节点 $i$ 和 $j$ 在同一个社区中 ($c_i = c_j$)，则为 $1$，否则为 $0$。\n\n计算将遵循问题陈述中概述的步骤进行。\n\n首先，我们根据问题描述确定网络的属性。\n网络有节点 $V = \\{1, 2, 3\\}$。\n有向边为 $1 \\to 2$、$2 \\to 3$ 和 $3 \\to 1$。\n总边数为 $M=3$。\n邻接矩阵 $A$ 是：\n$$ A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 1  0  0 \\end{pmatrix} $$\n\n指定的划分为 $\\{\\{1,2\\},\\{3\\}\\}$。我们记社区 $C_1 = \\{1, 2\\}$ 和社区 $C_2 = \\{3\\}$。\n\n**步骤 1：计算每个节点的入度和出度。**\n\n- 对于节点 $1$：有一条出边 ($1 \\to 2$) 和一条入边 ($3 \\to 1$)。\n  $$ k_1^{\\text{out}} = 1, \\quad k_1^{\\text{in}} = 1 $$\n- 对于节点 $2$：有一条出边 ($2 \\to 3$) 和一条入边 ($1 \\to 2$)。\n  $$ k_2^{\\text{out}} = 1, \\quad k_2^{\\text{in}} = 1 $$\n- 对于节点 $3$：有一条出边 ($3 \\to 1$) 和一条入边 ($2 \\to 3$)。\n  $$ k_3^{\\text{out}} = 1, \\quad k_3^{\\text{in}} = 1 $$\n出度之和为 $\\sum_{i} k_i^{\\text{out}} = 1+1+1=3$，入度之和为 $\\sum_{j} k_j^{\\text{in}} = 1+1+1=3$。这两个和都等于总边数 $M$，符合预期。\n\n**步骤 2：评估观测到的社区内部边数。**\n\n模块度公式可以表示为社区内部边所占的比例与零模型下这种边的预期比例之间的差值。\n社区内部边所占的比例由 $\\frac{1}{M}\\sum_{i,j} A_{ij} \\delta(c_i, c_j)$ 给出。\n我们对起始和终止于同一社区的边数进行求和。\n- 对于社区 $C_1 = \\{1, 2\\}$，我们检查 $i,j \\in \\{1,2\\}$ 的边 $(i,j)$。唯一的此类边是 $1 \\to 2$。因此，内部边数为 $L_{C_1} = 1$。\n- 对于社区 $C_2 = \\{3\\}$，我们检查 $i,j \\in \\{3\\}$ 的边 $(i,j)$。节点 $3$ 上没有自环。因此，内部边数为 $L_{C_2} = 0$。\n\n观测到的社区内部总边数为 $L = L_{C_1} + L_{C_2} = 1 + 0 = 1$。\n观测到的社区内部边所占的比例为 $\\frac{L}{M} = \\frac{1}{3}$。\n\n**步骤 3：评估零模型下预期的社区内部边数。**\n\n社区内部边的预期比例由 $\\frac{1}{M}\\sum_{i,j} P_{ij} \\delta(c_i, c_j) = \\frac{1}{M^2}\\sum_{i,j} k_i^{\\text{out}} k_j^{\\text{in}} \\delta(c_i, c_j)$ 给出。\n这一项可以通过对每个社区的贡献求和来计算。设 $K_c^{\\text{out}} = \\sum_{i \\in c} k_i^{\\text{out}}$ 和 $K_c^{\\text{in}} = \\sum_{j \\in c} k_j^{\\text{in}}$。预期比例为 $\\sum_{c} \\frac{K_c^{\\text{out}} K_c^{\\text{in}}}{M^2}$。\n\n- 对于社区 $C_1 = \\{1, 2\\}$：\n  总出度为 $K_{C_1}^{\\text{out}} = k_1^{\\text{out}} + k_2^{\\text{out}} = 1 + 1 = 2$。\n  总入度为 $K_{C_1}^{\\text{in}} = k_1^{\\text{in}} + k_2^{\\text{in}} = 1 + 1 = 2$。\n  $C_1$ 内部边的预期比例为 $\\frac{K_{C_1}^{\\text{out}} K_{C_1}^{\\text{in}}}{M^2} = \\frac{2 \\times 2}{3^2} = \\frac{4}{9}$。\n\n- 对于社区 $C_2 = \\{3\\}$：\n  总出度为 $K_{C_2}^{\\text{out}} = k_3^{\\text{out}} = 1$。\n  总入度为 $K_{C_2}^{\\text{in}} = k_3^{\\text{in}} = 1$。\n  $C_2$ 内部边的预期比例为 $\\frac{K_{C_2}^{\\text{out}} K_{C_2}^{\\text{in}}}{M^2} = \\frac{1 \\times 1}{3^2} = \\frac{1}{9}$。\n\n社区内部边的总预期比例是这些贡献的总和：\n$$ \\frac{4}{9} + \\frac{1}{9} = \\frac{5}{9} $$\n\n**步骤 4：组合这些部分以计算模块度 $Q$。**\n\n模块度 $Q$ 是观测到的社区内部边比例与预期比例之间的差值：\n$$ Q = (\\text{观测比例}) - (\\text{预期比例}) $$\n$$ Q = \\frac{1}{3} - \\frac{5}{9} $$\n为了进行减法，我们找到公分母 $9$：\n$$ Q = \\frac{3}{9} - \\frac{5}{9} = -\\frac{2}{9} $$\n\n给定划分的模块度为 $-\\frac{2}{9}$。负值表明，在指定的配置零模型下，该划分的内部边数少于随机预期的数量。", "answer": "$$\\boxed{-\\frac{2}{9}}$$", "id": "4365539"}]}