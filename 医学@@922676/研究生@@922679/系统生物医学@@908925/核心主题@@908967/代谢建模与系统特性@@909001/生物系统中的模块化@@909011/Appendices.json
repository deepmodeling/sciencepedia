{"hands_on_practices": [{"introduction": "本节的第一个练习是一个基础性的“纸笔”问题，它将指导您从第一性原理出发，为一个小型示例网络计算模块度。通过对比基于全局社群结构和基于局部模体（motif）密度的两种不同划分，本练习旨在阐明模块度分析所能提供的独特见解，并强调局部特征与全局组织之间的重要区别。[@problem_id:4362361]", "problem": "给定一个无向的蛋白质-蛋白质相互作用网络，它代表了两个具有串扰的通路区室，包含 $10$ 个标记为 $1$ 到 $10$ 的节点。边是无序对\n$\\{(1,2), (2,3), (3,4), (4,5), (6,7), (7,8), (6,8), (8,9), (9,10), (3,6), (3,7), (4,6), (4,7)\\}$.\n将 $3$ 节点环路基序（三角形）视为我们感兴趣的基序。假设一位基序富集分析师提出将集合 $S=\\{3,4,6,7\\}$ 作为一个假定模块，因为这些节点参与了许多三角形。而一位社群分析师则提出了区室划分 $C_1=\\{1,2,3,4,5\\}$ 和 $C_2=\\{6,7,8,9,10\\}$，其动机是区室内边的密度以及区室间的串扰边。\n\n使用网络基序（三角形是 $3$ 节点环路）的基本定义和通过与度保持零模型（广泛使用的 Newman–Girvan 模块度框架）进行比较来评估的社群质量，请按以下步骤进行，不要依赖任何快捷公式：\n- 枚举网络中的三角形，并验证集合 $S$ 中的节点是否确实比其他节点有更高的三角形参与度。\n- 对于两个候选划分中的每一个，量化每个社群内部的边数以及每个社群中节点的度之和。\n- 从第一性原理出发，评估在度保持零模型下哪个划分能产生更高的社群质量，并解释 $S$ 处的高基序频率是否与社群边界一致。\n\n哪种说法与这些结果及其对系统生物医学推断的意义最为一致？\n\nA. 基序富集划分 $\\{S, V\\setminus S\\}$ 产生的社群质量高于 $\\{C_1, C_2\\}$；因此，高三角形频率足以划分社群边界。\n\nB. 区室划分 $\\{C_1, C_2\\}$ 产生的社群质量高于 $\\{S, V\\setminus S\\}$；$\\{3,4,6,7\\}$ 处的高三角形频率并未定义社群边界，并且仅依赖基序计数可能将边界区域错误地识别为独立的模块。\n\nC. 两种划分具有相同的社群质量，因为它们各自包含相同总数的内部边；社群质量仅取决于内部边的数量，而不取决于度分布。\n\nD. 即使在度保持零模型下社群质量较低，基序富集也能检测到功能性社群，因此模块度与生物网络中的模块检测无关。", "solution": "问题陈述提供了一个定义明确的网络和两种备选划分。它提出了一个清晰的、定量的问题，即使用网络科学中的一个标准且指定的度量来比较这些划分。给定的条件是完整的、一致的且科学上合理的。因此，我们可以进行形式化分析。\n\n设网络由图 $G=(V, E)$ 表示，其中顶点集为 $V = \\{1, 2, 3, 4, 5, 6, 7, 8, 9, 10\\}$，边集为 $E = \\{(1,2), (2,3), (3,4), (4,5), (6,7), (7,8), (6,8), (8,9), (9,10), (3,6), (3,7), (4,6), (4,7)\\}$. 边的总数为 $m = |E| = 13$。\n\n首先，我们计算每个节点 $i \\in V$ 的度 $k_i$：\n$k_1=1$\n$k_2=2$\n$k_3=4$ (连接到 $2,4,6,7$ 的边)\n$k_4=4$ (连接到 $3,5,6,7$ 的边)\n$k_5=1$\n$k_6=4$ (连接到 $3,4,7,8$ 的边)\n$k_7=4$ (连接到 $3,4,6,8$ 的边)\n$k_8=3$ (连接到 $6,7,9$ 的边)\n$k_9=2$\n$k_{10}=1$\n度的总和是 $\\sum_{i \\in V} k_i = 1+2+4+4+1+4+4+3+2+1 = 26$，这正确地等于 $2m = 2 \\times 13$。\n\n**1. 三角形枚举与参与度**\n\n三角形是一个 $3$ 节点环路，即三个节点的集合 $\\{a,b,c\\}$，使得 $(a,b), (b,c), (c,a) \\in E$。通过检查边集，我们枚举出所有三角形：\n- $\\{3,4,6\\}$：边 $(3,4), (3,6), (4,6)$ 存在。\n- $\\{3,4,7\\}$：边 $(3,4), (3,7), (4,7)$ 存在。\n- $\\{3,6,7\\}$：边 $(3,6), (3,7), (6,7)$ 存在。\n- $\\{4,6,7\\}$：边 $(4,6), (4,7), (6,7)$ 存在。\n- $\\{6,7,8\\}$：边 $(6,7), (6,8), (7,8)$ 存在。\n网络中总共有 $5$ 个三角形。\n\n每个节点参与的三角形数量是：\n- 节点 $3$：在 $\\{3,4,6\\}, \\{3,4,7\\}, \\{3,6,7\\}$ 中。总共：$3$。\n- 节点 $4$：在 $\\{3,4,6\\}, \\{3,4,7\\}, \\{4,6,7\\}$ 中。总共：$3$。\n- 节点 $6$：在 $\\{3,4,6\\}, \\{3,6,7\\}, \\{4,6,7\\}, \\{6,7,8\\}$ 中。总共：$4$。\n- 节点 $7$：在 $\\{3,4,7\\}, \\{3,6,7\\}, \\{4,6,7\\}, \\{6,7,8\\}$ 中。总共：$4$。\n- 节点 $8$：在 $\\{6,7,8\\}$ 中。总共：$1$。\n- 所有其他节点（$1,2,5,9,10$）的度小于或等于 $2$，且它们的邻居节点之间没有连接，因此它们的三角形参与度为 $0$。\n\n集合 $S = \\{3,4,6,7\\}$ 由三角形参与计数分别为 $3, 3, 4, 4$ 的节点组成。所有其他节点的参与计数为 $1$ 或 $0$。因此，$S$ 中的节点确实具有显著更高的三角形参与度。\n\n**2. 社群质量评估**\n\n我们使用 Newman-Girvan 模块度 $Q$ 来评估社群质量。对于网络的一个社群划分为 $c$，模块度从第一性原理定义为：落在给定社群内部的边所占的比例，减去在保持每个节点度不变的情况下随机重连边时，这种边所占的期望比例。\n其公式为：\n$$Q = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]$$\n其中对于每个社群 $c$，$L_c$ 是内部边的数量，$K_c$ 是其节点度的总和。这里，$m=13$ 且 $2m=26$。\n\n**划分1：基序富集划分 $P_S = \\{S, V\\setminus S\\}$**\n- 社群 $S = \\{3,4,6,7\\}$。\n- 社群 $V\\setminus S = \\{1,2,5,8,9,10\\}$。\n\n对于社群 $S$：\n- 内部边为 $(3,4)$, $(3,6)$, $(3,7)$, $(4,6)$, $(4,7)$, $(6,7)$。因此，$L_S = 6$。\n- 度的总和为 $K_S = k_3 + k_4 + k_6 + k_7 = 4+4+4+4 = 16$。\n\n对于社群 $V\\setminus S$：\n- 内部边为 $(1,2)$, $(8,9)$, $(9,10)$。因此，$L_{V\\setminus S} = 3$。\n- 度的总和为 $K_{V\\setminus S} = k_1+k_2+k_5+k_8+k_9+k_{10} = 1+2+1+3+2+1=10$。\n\n内部边的总数为 $6+3=9$。模块度 $Q_{P_S}$ 为：\n$$Q_{P_S} = \\left[ \\frac{6}{13} - \\left(\\frac{16}{26}\\right)^2 \\right] + \\left[ \\frac{3}{13} - \\left(\\frac{10}{26}\\right)^2 \\right]$$\n$$Q_{P_S} = \\left[ \\frac{6}{13} - \\left(\\frac{8}{13}\\right)^2 \\right] + \\left[ \\frac{3}{13} - \\left(\\frac{5}{13}\\right)^2 \\right]$$\n$$Q_{P_S} = \\left[ \\frac{78}{169} - \\frac{64}{169} \\right] + \\left[ \\frac{39}{169} - \\frac{25}{169} \\right] = \\frac{14}{169} + \\frac{14}{169} = \\frac{28}{169}$$\n$Q_{P_S} \\approx 0.1657$.\n\n**划分2：区室划分 $P_C = \\{C_1, C_2\\}$**\n- 社群 $C_1 = \\{1,2,3,4,5\\}$。\n- 社群 $C_2 = \\{6,7,8,9,10\\}$。\n\n对于社群 $C_1$：\n- 内部边为 $(1,2)$, $(2,3)$, $(3,4)$, $(4,5)$。因此，$L_{C_1} = 4$。\n- 度的总和为 $K_{C_1} = k_1+k_2+k_3+k_4+k_5 = 1+2+4+4+1 = 12$。\n\n对于社群 $C_2$：\n- 内部边为 $(6,7)$, $(7,8)$, $(6,8)$, $(8,9)$, $(9,10)$。因此，$L_{C_2} = 5$。\n- 度的总和为 $K_{C_2} = k_6+k_7+k_8+k_9+k_{10} = 4+4+3+2+1=14$。\n\n内部边的总数为 $4+5=9$。模块度 $Q_{P_C}$ 为：\n$$Q_{P_C} = \\left[ \\frac{4}{13} - \\left(\\frac{12}{26}\\right)^2 \\right] + \\left[ \\frac{5}{13} - \\left(\\frac{14}{26}\\right)^2 \\right]$$\n$$Q_{P_C} = \\left[ \\frac{4}{13} - \\left(\\frac{6}{13}\\right)^2 \\right] + \\left[ \\frac{5}{13} - \\left(\\frac{7}{13}\\right)^2 \\right]$$\n$$Q_{P_C} = \\left[ \\frac{52}{169} - \\frac{36}{169} \\right] + \\left[ \\frac{65}{169} - \\frac{49}{169} \\right] = \\frac{16}{169} + \\frac{16}{169} = \\frac{32}{169}$$\n$Q_{P_C} \\approx 0.1893$.\n\n**3. 比较与启示**\n\n比较模块度值，我们发现 $Q_{P_C} = \\frac{32}{169} > Q_{P_S} = \\frac{28}{169}$。区室划分 $\\{C_1, C_2\\}$ 的社群质量得分高于基序富集划分 $\\{S, V\\setminus S\\}$。\n\n集合 $S=\\{3,4,6,7\\}$ 是一个稠密子图（具体来说是一个 $K_4$ 团），其中的节点具有很高的三角形参与度。然而，这些节点也构成了两个原本独立的通路之间的唯一通信桥梁。节点 $\\{3,4\\}$ 属于通路 $1$，而节点 $\\{6,7\\}$ 属于通路 $2$。划分 $\\{S, V\\setminus S\\}$ 将这个稠密的接口作为一个社群孤立出来，这导致了较低的模块度。$\\{C_1, C_2\\}$ 较高的模块度表明，该网络更适合被描述为两个具有一定串扰的较大学社群，而不是一个稠密的核心模块和一个稀疏的外围。这表明，高基序密度的区域不一定本身构成社群；它们可以代表社群之间的接口或边界区域。仅仅依赖像基序计数这样的局部特征来识别全局社群结构可能会产生误导。\n\n**选项评估**\n\nA. 基序富集划分 $\\{S, V\\setminus S\\}$ 产生的社群质量高于 $\\{C_1, C_2\\}$；因此，高三角形频率足以划分社群边界。\n- 前提是错误的。我们的计算表明 $Q_{P_S} < Q_{P_C}$。结论也与我们的发现不一致。\n- **错误**。\n\nB. 区室划分 $\\{C_1, C_2\\}$ 产生的社群质量高于 $\\{S, V\\setminus S\\}$；$\\{3,4,6,7\\}$ 处的高三角形频率并未定义社群边界，并且仅依赖基序计数可能将边界区域错误地识别为独立的模块。\n- 第一句话是正确的 ($Q_{P_C} > Q_{P_S}$)。后续的论断是对这一结果的正确解释，正如我们在分析中所解释的。高基序频率是这两个较高模块度社群之间接口的特征。\n- **正确**。\n\nC. 两种划分具有相同的社群质量，因为它们各自包含相同总数的内部边；社群质量仅取决于内部边的数量，而不取决于度分布。\n- 社群质量相同的前提是错误的。提供的理由也是错误的；模块度公式明确包含一个项 $(K_c/2m)^2$，该项依赖于度的总和 $K_c$。虽然两种划分恰好具有相同数量的内部边（$9$ 条），但由于社群内度分布的不同，它们的模块度得分也不同。\n- **错误**。\n\nD. 即使在度保持零模型下社群质量较低，基序富集也能检测到功能性社群，因此模块度与生物网络中的模块检测无关。\n- 这种说法对模块度的普遍效用作出了一个宽泛、主观的论断，这超出了本特定问题分析的范围。问题问的是哪种说法与此处得出的结果一致。结果是，与简单的基序计数相比，模块度提供了一个不同的、且在这种情况下更直观的答案。基于此就宣称模块度“无关紧要”是一个站不住脚的逻辑跳跃。\n- **错误**。", "answer": "$$\\boxed{B}$$", "id": "4362361"}, {"introduction": "在静态模块度概念的基础上，本练习将探索其在动态系统中的关键功能性意义。您将实现一个线性响应模型，以模拟局部扰动 $\\Delta f$ 如何在网络中传播，并引起响应 $\\Delta x = -J^{-1}\\Delta f$。该练习直观地展示了系统生物学中的一个核心原则：模块化结构能够隔离和控制扰动，这对维持生物功能的稳定性和鲁棒性至关重要。[@problem_id:4362272]", "problem": "给定一个生物系统的线性化连续时间网络模型，该系统被划分为两个模块，分别记为 $A$ 和 $B$。设状态向量为 $x \\in \\mathbb{R}^N$，其中 $N = n_A + n_B$，$n_A$ 是模块 $A$ 中的节点数，$n_B$ 是模块 $B$ 中的节点数。考虑一个常微分方程 (ODE) 模型 $dx/dt = f(x)$ 的稳态 $x^\\star$ 满足 $f(x^\\star) = 0$，以及 $f$ 在 $x^\\star$ 附近的线性化，其雅可比矩阵为 $J = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x^\\star} \\in \\mathbb{R}^{N \\times N}$。动力学的一个微小常数扰动由 $\\Delta f \\in \\mathbb{R}^N$ 表示。在稳态线性响应下，受扰动的稳态 $x^\\star + \\Delta x$ 服从以下线性一致性关系\n$$\n\\Delta f + J\\,\\Delta x = 0,\n$$\n该关系隐式地定义了响应 $\\Delta x$。\n\n你的任务是，针对一个指定的分块结构雅可比矩阵 $J$ 族，实现一个计算过程，该过程构建 $J$，计算系统对一个局域于模块 $A$ 的扰动 $\\Delta f$ 的稳态响应 $\\Delta x$，然后通过以下比率来量化跨模块影响：\n$$\n\\rho = \\frac{\\|\\Delta x_B\\|_1}{\\|\\Delta x_A\\|_1},\n$$\n其中 $\\Delta x_A \\in \\mathbb{R}^{n_A}$ 和 $\\Delta x_B \\in \\mathbb{R}^{n_B}$ 分别是 $\\Delta x$ 中对应于模块 $A$ 和 $B$ 的子向量，$\\|\\cdot\\|_1$ 表示逐项 $1$-范数（绝对值之和）。标量 $\\rho$ 是无量纲的。通过改变非对角线的模块间耦合参数，你将量化减小 $J$ 的模块间元素值如何减弱跨模块影响 $\\rho$。\n\n雅可比矩阵 $J$ 的构建：对于给定的参数 $(n_A, n_B, s, c, k_{\\text{off}}, \\alpha)$，定义 $N = n_A + n_B$ 并按如下方式构建 $J \\in \\mathbb{R}^{N \\times N}$：\n$$\nJ = s I - W,\n$$\n其中 $I$ 是 $N \\times N$ 单位矩阵，$W$ 通过以下针对索引 $i \\neq j$ 的规则逐项定义：\n- 如果 $i$ 和 $j$ 都在同一模块中（都在 $A$ 中或都在 $B$ 中），则 $W_{ij} = c$。\n- 如果 $i$ 和 $j$ 在不同模块中，则 $W_{ij} = \\alpha\\,k_{\\text{off}}$。\n- 所有对角线元素满足 $W_{ii} = 0$（对所有 $i$）。\n只要 $s$ 的值超过 $W$ 的最大行和的绝对值，该构建方法就会产生一个对角占优的 $J$，从而保证了其可逆性和唯一的线性响应。\n\n扰动说明：按如下方式定义 $\\Delta f \\in \\mathbb{R}^N$：\n$$\n(\\Delta f)_i =\n\\begin{cases}\n1  \\text{如果节点 } i \\text{ 属于模块 } A, \\\\\n0  \\text{如果节点 } i \\text{ 属于模块 } B.\n\\end{cases}\n$$\n\n每个测试用例的计算任务：\n1. 使用上述规则根据 $(n_A, n_B, s, c, k_{\\text{off}}, \\alpha)$ 构建 $J$。\n2. 求解满足 $\\Delta f + J\\,\\Delta x = 0$ 的线性系统以得到 $\\Delta x \\in \\mathbb{R}^N$。\n3. 提取 $\\Delta x_A$ 和 $\\Delta x_B$，计算 $\\|\\Delta x_A\\|_1$ 和 $\\|\\Delta x_B\\|_1$，然后计算 $\\rho = \\|\\Delta x_B\\|_1 / \\|\\Delta x_A\\|_1$。\n4. 将 $\\rho$ 作为浮点数报告，四舍五入到六位小数（无量纲）。\n\n测试套件：按所列顺序使用以下四个参数集，每个参数集定义一个测试用例，所有数字和参数均按给定的值精确解释。\n- 测试用例 1：$(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 1.0)$。\n- 测试用例 2：$(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 0.4)$。\n- 测试用例 3：$(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 0.1)$。\n- 测试用例 4：$(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 0.0)$。\n\n最终输出格式：你的程序应生成单行输出，其中包含四个测试用例的结果，结果为逗号分隔的列表，并用方括号括起来，顺序与上文指定的一致。每个条目必须是对应的 $\\rho$ 值，四舍五入到六位小数。例如，输出必须采用以下形式：\n$$\n[\\rho_1,\\rho_2,\\rho_3,\\rho_4],\n$$\n该行中任何位置都不得有空格。\n\n此问题中的所有量均为无量纲；将最终数字报告为四舍五入到六位小数的无量纲浮点数。", "solution": "对用户提供的问题进行有效性评估。\n\n### 步骤 1：提取已知条件\n- **系统模型**：线性化的连续时间网络，包含两个模块 $A$ 和 $B$。\n- **状态向量**：$x \\in \\mathbb{R}^N$，其中 $N = n_A + n_B$。\n- **线性响应关系**：$\\Delta f + J\\,\\Delta x = 0$，其中 $J$ 是稳态下的雅可比矩阵，$\\Delta f$ 是一个常数扰动。\n- **影响度量**：$\\rho = \\frac{\\|\\Delta x_B\\|_1}{\\|\\Delta x_A\\|_1}$，其中 $\\Delta x_A$ 和 $\\Delta x_B$ 是响应 $\\Delta x$ 中对应于模块 $A$ 和 $B$ 的子向量，$\\|\\cdot\\|_1$ 是 $L_1$ 范数。\n- **雅可比矩阵构建**：$J = s I - W$，其中 $I$ 是 $N \\times N$ 单位矩阵。\n- **相互作用矩阵 $W$**：对于 $i \\neq j$：\n    - 如果节点 $i$ 和 $j$ 在同一模块中，则 $W_{ij} = c$。\n    - 如果节点 $i$ 和 $j$ 在不同模块中，则 $W_{ij} = \\alpha\\,k_{\\text{off}}$。\n    - 对所有 $i$，$W_{ii} = 0$。\n- **扰动向量 $\\Delta f$**：\n    - 对于节点 $i \\in A$，$(\\Delta f)_i = 1$。\n    - 对于节点 $i \\in B$，$(\\Delta f)_i = 0$。\n- **计算任务**：对于每个参数集 $(n_A, n_B, s, c, k_{\\text{off}}, \\alpha)$：\n    1.  构建 $J$。\n    2.  在 $\\Delta f + J\\,\\Delta x = 0$ 中求解 $\\Delta x$。\n    3.  计算 $\\rho$。\n    4.  报告 $\\rho$，四舍五入到六位小数。\n- **测试用例**：\n    1. $(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 1.0)$\n    2. $(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 0.4)$\n    3. $(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 0.1)$\n    4. $(n_A, n_B, s, c, k_{\\text{off}}, \\alpha) = (3, 3, 1.0, 0.15, 0.05, 0.0)$\n- **输出格式**：单行 `[\\rho_1,\\rho_2,\\rho_3,\\rho_4]`，无空格。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **有科学依据**：该问题在系统生物学和控制理论中有坚实的基础。它使用标准的线性响应理论来分析网络的模块化，这是该领域的一个核心概念。雅可比矩阵 $J = sI - W$ 的构建是稳定动力系统的一个常见建模范式，其中 $s$ 代表自降解或衰减率，$W$ 是一个加权相互作用矩阵。\n- **适定的**：该问题需要求解线性系统 $J\\Delta x = -\\Delta f$。当且仅当矩阵 $J$ 可逆时，存在唯一解。问题陈述指出，对于足够大的 $s$，$J$ 是对角占优的。对于模块 $A$ 中的行 $i$，非对角线元素的绝对值之和为 $\\sum_{j \\neq i} |J_{ij}| = \\sum_{j \\neq i} |W_{ij}| = (n_A - 1)c + n_B \\alpha k_{\\text{off}}$。对于测试用例 1 中的给定参数（这是对角占优性的最坏情况，因为 $\\alpha$ 是最大的），$n_A=3, n_B=3, c=0.15, k_{\\text{off}}=0.05, \\alpha=1.0$。该和为 $(3-1)(0.15) + 3(1.0 \\times 0.05) = 2 \\times 0.15 + 3 \\times 0.05 = 0.3 + 0.15 = 0.45$。对角线元素为 $J_{ii} = s = 1.0$。由于 $|J_{ii}| = 1.0 > 0.45$，矩阵 $J$ 在所有测试用例中都是严格对角占优的，这保证了它是非奇异和可逆的。因此，存在唯一的解 $\\Delta x$，问题是适定的。\n- **客观的**：问题以精确的数学语言陈述。所有参数都进行了数值定义，所需的计算也得到了明确的指定。没有主观因素。\n- **缺陷清单**：该问题没有表现出任何列出的缺陷（科学上不健全、不可形式化、不完整、不切实际、不适定、伪深刻或不可验证）。该问题是定量生物学中一个标准的、定义明确的计算任务。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供一个解决方案。\n\n### 基于原理的解决方案设计\n任务是量化一个生物模块中的扰动对另一个模块的影响。这是通过线性响应理论实现的，该理论适用于考虑系统稳态的微小偏差时的情况。\n\n问题的核心在于线性方程：\n$$ J \\Delta x = -\\Delta f $$\n这个方程将系统的稳态响应 $\\Delta x$ 与一个微小的常数扰动 $\\Delta f$ 联系起来。雅可比矩阵 $J$ 概括了系统围绕其稳态的局部动力学。\n\n**步骤 1：构建雅可比矩阵 $J$**\n雅可比矩阵 $J$ 定义为 $J = sI - W$。项 $sI$ 代表每个物种的均匀自稳定效应（例如，蛋白质降解或代谢消耗），速率为 $s$。矩阵 $W$ 代表相互作用网络。其结构是分块的，反映了系统的模块化组织。设前 $n_A$ 个索引对应于模块 $A$，后 $n_B$ 个索引对应于模块 $B$。那么 $W$ 可以写成如下的分块形式：\n$$\nW =\n\\begin{pmatrix}\nW_{AA}  W_{AB} \\\\\nW_{BA}  W_{BB}\n\\end{pmatrix}\n$$\n- 模块内分块 $W_{AA} \\in \\mathbb{R}^{n_A \\times n_A}$ 的所有非对角线元素等于 $c$，对角线元素等于 $0$。\n- 模块内分块 $W_{BB} \\in \\mathbb{R}^{n_B \\times n_B}$ 的所有非对角线元素等于 $c$，对角线元素等于 $0$。\n- 模块间分块 $W_{AB} \\in \\mathbb{R}^{n_A \\times n_B}$ 和 $W_{BA} \\in \\mathbb{R}^{n_B \\times n_A}$ 的所有元素都等于耦合强度 $\\alpha k_{\\text{off}}$。这个参数 $\\alpha$ 缩放了基线模块间连接强度 $k_{\\text{off}}$，使我们能够研究减弱这些连接的效果。\n\n**步骤 2：构建扰动向量 $\\Delta f$**\n扰动 $\\Delta f$ 被设计为局域于模块 $A$。对于模块 $A$ 中的所有节点，其元素等于 $1$，对于模块 $B$ 中的所有节点，其元素等于 $0$。\n$$\n\\Delta f = \\begin{pmatrix} \\mathbf{1}_{n_A} \\\\ \\mathbf{0}_{n_B} \\end{pmatrix}\n$$\n其中 $\\mathbf{1}_{n_A}$ 是一个长度为 $n_A$ 的全一向量，$\\mathbf{0}_{n_B}$ 是一个长度为 $n_B$ 的零向量。这代表一个均匀施加于整个模块 $A$ 的恒定刺激。\n\n**步骤 3：求解响应 $\\Delta x$**\n响应向量 $\\Delta x$ 可通过求解线性系统 $J\\Delta x = -\\Delta f$ 得到。这是线性代数中的一个标准问题，可以用数值库高效求解。出于数值稳定性和计算效率的考虑，使用专用的线性求解器优于计算矩阵的逆 $J^{-1}$。解为 $\\Delta x = -J^{-1}\\Delta f$。\n\n**步骤 4：量化跨模块影响 $\\rho$**\n一旦计算出 $\\Delta x$，就将其划分为对应于两个模块的子向量：\n$$\n\\Delta x = \\begin{pmatrix} \\Delta x_A \\\\ \\Delta x_B \\end{pmatrix}\n$$\n其中 $\\Delta x_A \\in \\mathbb{R}^{n_A}$ 包含模块 $A$ 中节点的响应，$\\Delta x_B \\in \\mathbb{R}^{n_B}$ 包含模块 $B$ 中节点的响应。\n\n每个模块中响应的总体大小使用 $L_1$ 范数（各分量绝对值之和）来衡量：\n$$\n\\|\\Delta x_A\\|_1 = \\sum_{i=1}^{n_A} |(\\Delta x_A)_i| \\quad \\text{和} \\quad \\|\\Delta x_B\\|_1 = \\sum_{i=1}^{n_B} |(\\Delta x_B)_i|\n$$\n比率 $\\rho = \\|\\Delta x_B\\|_1 / \\|\\Delta x_A\\|_1$ 是一个无量纲度量，它量化了模块 $A$ 中的扰动传播到模块 $B$ 的程度。一个小的 $\\rho$ 值表明模块 $A$ 与模块 $B$ 良好地隔离，这是模块化系统的一个关键特征。随着模块间耦合 $\\alpha$ 的减小，我们预期 $\\rho$ 会减小，当模块完全解耦时（$\\alpha=0$），$\\rho$ 趋近于 $0$。\n\n该计算过程将为测试套件中提供的每组参数实现这四个步骤。", "answer": "[0.321689,0.14725,0.03927,0.0]", "id": "4362272"}, {"introduction": "在现实世界的生物学数据中，网络结构通常是推断出来的，因此会受到噪声和不确定性的影响。这个高级练习将介绍一种强大的计算方法，用以评估您发现的模块是否具有统计稳健性，而非仅仅是数据的偶然产物。通过实现一个完整的自助法（bootstrap）重采样和验证流程，您将掌握任何实用网络分析中的一项关键技能：如何量化研究结果的可信度。[@problem_id:4362312]", "problem": "给定一个由邻接概率矩阵 $P \\in [0,1]^{n \\times n}$（其中 $P_{ii} = 0$ 且 $P_{ij} = P_{ji}$）表示的无向、无自环、带权图族。每个条目 $P_{ij}$ 被解释为节点 $i$ 和节点 $j$ 之间存在边的概率。目标是评估在对边进行自助重采样（bootstrap resampling）并进行社群检测后，模块（社群）的可复现性，使用节点成员关系的杰卡德相似度（Jaccard similarity）来识别一致的模块。\n\n评估必须从基本原理出发，并实现为单个可运行的程序。您的程序必须实现以下定义和步骤：\n\n- 图构建与零模型：\n    - 图由一个对称邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 表示，其中 $A_{ij} \\ge 0$ 且 $A_{ii} = 0$。\n    - 节点 $i$ 的度为 $k_i = \\sum_{j=1}^{n} A_{ij}$。\n    - 总边权为 $m = \\frac{1}{2} \\sum_{i,j=1}^{n} A_{ij}$。\n    - 社群分配是一个向量 $c \\in \\{0,1,\\dots,K-1\\}^{n}$，其中 $c_i$ 标记了节点 $i$ 所属的社群。\n    - 一个划分 $c$ 的模块度 $Q$ 是相对于配置模型零期望定义的：\n      $$ Q(A,c) = \\frac{1}{2m} \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\left( A_{ij} - \\frac{k_i k_j}{2m} \\right) \\, \\mathbf{1}\\{ c_i = c_j \\}, $$\n      其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数，且 $m > 0$。如果 $m = 0$，则定义 $Q(A,c) = 0$。\n\n- 边的自助重采样：\n    - 给定 $P$，通过对上三角矩阵进行独立的伯努利抽取来生成自助重采样副本 $\\tilde{A}^{(b)}$，其中 $b \\in \\{1,\\dots,B\\}$：对于 $i < j$，抽取 $\\tilde{A}^{(b)}_{ij} \\sim \\text{Bernoulli}(P_{ij})$ 并设置 $\\tilde{A}^{(b)}_{ji} = \\tilde{A}^{(b)}_{ij}$，同时设置 $\\tilde{A}^{(b)}_{ii} = 0$。\n    - 这将边的存在与否的不确定性建模为与给定概率一致的独立试验。\n\n- 通过贪心模块度最大化进行社群检测：\n    - 实现一个确定性的贪心算法，该算法开始时将每个节点置于其自身的社群中，然后迭代地将节点移动到能够严格增加 $Q$ 值的社群，每次候选移动后都重新计算 $Q$。在没有任何单节点移动可以改善 $Q$ 之后，尝试能够严格增加 $Q$ 值的成对社群合并，直到无法进一步改善为止。更新后，将社群索引重新标记为连续整数。该算法必须适用于带权图，并且除了基本矩阵运算外，不得假定任何专门的库函数。\n\n- 节点成员关系的杰卡德相似度：\n    - 对于一个划分 $c$，节点 $i$ 的成员集合是 $S_i(c) = \\{ j \\in \\{1,\\dots,n\\} \\,:\\, c_j = c_i \\}$。\n    - 对于一个参考划分 $c^{(0)}$（通过将贪心模块度算法应用于被视为加权邻接矩阵的 $P$ 获得），以及对于从 $\\tilde{A}^{(b)}$ 获得的每个自助重采样划分 $c^{(b)}$，定义节点级杰卡德相似度：\n      $$ J_i^{(b)} = \\frac{ \\left| S_i\\!\\left(c^{(0)}\\right) \\cap S_i\\!\\left(c^{(b)}\\right) \\right| }{ \\left| S_i\\!\\left(c^{(0)}\\right) \\cup S_i\\!\\left(c^{(b)}\\right) \\right| }. $$\n    - 对于一个参考模块 $M \\subseteq \\{1,\\dots,n\\}$，其中对于某个标签 $\\ell$，$M = \\{ i \\,:\\, c_i^{(0)} = \\ell \\}$，将其可复现性得分定义为其成员节点在所有自助重采样副本中的平均杰卡德相似度：\n      $$ R_M = \\frac{1}{|M| \\, B} \\sum_{i \\in M} \\sum_{b=1}^{B} J_i^{(b)}. $$\n    - 通过要求 $|M| \\ge 2$ 来排除平凡的单例模块，不评估其一致性。\n\n- 一致性决策规则：\n    - 给定一个阈值 $\\tau \\in [0,1]$，如果 $R_M \\ge \\tau$，则宣布模块 $M$ 是一致的。\n\n您的程序必须实现上述完整过程，并评估以下测试套件，其中每个测试用例由 $(\\text{module\\_sizes}, p_{\\text{in}}, p_{\\text{out}}, B, \\tau, s)$ 指定：\n\n- 测试用例 1（清晰的模块化结构）：\n    - $\\text{module\\_sizes} = [4,4]$，\n    - $p_{\\text{in}} = 0.9$，\n    - $p_{\\text{out}} = 0.05$，\n    - $B = 200$，\n    - $\\tau = 0.8$，\n    - $s = 123$。\n\n- 测试用例 2（模糊结构）：\n    - $\\text{module\\_sizes} = [3,3,3]$，\n    - $p_{\\text{in}} = 0.6$，\n    - $p_{\\text{out}} = 0.4$，\n    - $B = 300$，\n    - $\\tau = 0.8$，\n    - $s = 456$。\n\n- 测试用例 3（均匀连接性，单模块）：\n    - $\\text{module\\_sizes} = [6]$，\n    - $p_{\\text{in}} = 0.5$，\n    - $p_{\\text{out}} = 0.5$，\n    - $B = 200$，\n    - $\\tau = 0.8$，\n    - $s = 789$。\n\n- 测试用例 4（类核心-边缘结构，带一个单例）：\n    - $\\text{module\\_sizes} = [1,3,3]$，\n    - $p_{\\text{in}} = 0.85$，\n    - $p_{\\text{out}} = 0.1$，\n    - $B = 250$，\n    - $\\tau = 0.8$，\n    - $s = 42$。\n\n对于每个测试用例，按如下方式构建概率邻接矩阵 $P$：令 $n$ 为 $\\text{module\\_sizes}$ 的总和。对于声明在同一模块内的节点，设置 $P_{ij} = p_{\\text{in}}$（当 $i \\ne j$）；对于声明在不同模块中的节点，设置 $P_{ij} = p_{\\text{out}}$（当 $i \\ne j$）。始终设置 $P_{ii} = 0$。在单模块情况下，这简化为 $P_{ij} = p_{\\text{in}}$（当 $i \\ne j$）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4]”），每个结果是相应测试用例的一致模块（大小至少为 2）的整数计数，按上面列出的顺序排列。不应打印任何额外文本。所有量都是无单位的实数或整数；不涉及物理单位或角度单位。阈值 $\\tau$ 必须作为 $[0,1]$ 区间内的小数值处理。", "solution": "目标是评估在一个由边概率矩阵 P 定义的图族中，所识别出的网络模块（社群）的可复现性。评估过程涉及对图的边进行自助重采样，随后通过贪心模块度最大化算法进行社群检测，并使用节点成员关系的杰卡德相似度来量化一致性。\n\n### **1. 问题阐述**\n\n设一个图由对称邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 表示，其中 $n$ 是节点数，$A_{ij} \\ge 0$ 是节点 $i$ 和 $j$ 之间边的权重，$A_{ii} = 0$（无自环）。\n\n节点 $i$ 的**度**是其关联边的权重之和：\n$$ k_i = \\sum_{j=1}^{n} A_{ij} $$\n\n图中的**总边权**为 $m$：\n$$ m = \\frac{1}{2} \\sum_{i=1}^{n} \\sum_{j=1}^{n} A_{ij} = \\frac{1}{2} \\sum_{i=1}^{n} k_i $$\n\n**社群结构**是将节点划分为不相交的集合。它由一个社群分配向量 $c \\in \\{0, 1, \\dots, K-1\\}^n$ 表示，其中 $c_i$ 是分配给节点 $i$ 的社群标签。\n\n**模块度** $Q$ 用于衡量一个划分的质量。它将社群内部的边权比例与一个零模型（配置模型）中的期望比例进行比较，在零模型中，边是随机放置的，同时保持节点的度不变。对于图 $A$ 的一个划分 $c$，模块度为：\n$$ Q(A, c) = \\frac{1}{2m} \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\left( A_{ij} - \\frac{k_i k_j}{2m} \\right) \\mathbf{1}\\{c_i = c_j\\} $$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。如果 $m=0$，我们定义 $Q(A,c) = 0$。\n\n该问题通过一个对称的**邻接概率矩阵** $P \\in [0,1]^{n \\times n}$ 定义了一个图族，其中 $P_{ij}$ 是节点 $i$ 和 $j$ 之间存在边的概率。\n\n### **2. 算法流程**\n\n对每个测试用例，评估过程包括以下步骤。\n\n**步骤1：参考社群检测**\n概率矩阵 $P$ 本身被视为一个加权邻接矩阵，代表了期望的图结构。通过将一个确定性的贪心模块度最大化算法应用于该矩阵 $P$，可以得到一个**参考划分** $c^{(0)}$。\n\n**步骤2：自助重采样**\n为评估稳定性，生成 $B$ 个自助重采样副本图，其邻接矩阵表示为 $\\tilde{A}^{(b)}$，其中 $b \\in \\{1, \\dots, B\\}$。每个 $\\tilde{A}^{(b)}$ 是一个无权无向图。对于每对节点 $(i, j)$（$i < j$），以概率 $P_{ij}$ 独立地创建一条边。形式上：\n$$ \\tilde{A}^{(b)}_{ij} \\sim \\text{Bernoulli}(P_{ij}) \\quad \\text{对于 } i < j $$\n通过设置 $\\tilde{A}^{(b)}_{ji} = \\tilde{A}^{(b)}_{ij}$ 使矩阵对称，且对角线元素为零，即 $\\tilde{A}^{(b)}_{ii} = 0$。指定的随机种子 $s$ 确保了此过程的可复现性。\n\n**步骤3：在副本上进行社群检测**\n将相同的贪心模块度最大化算法应用于每个自助重采样副本 $\\tilde{A}^{(b)}$，以获得一组自助重采样划分 $\\{c^{(1)}, c^{(2)}, \\dots, c^{(B)}\\}$。\n\n**步骤4：一致性评估**\n将参考划分 $c^{(0)}$ 中找到的模块与自助重采样划分 $c^{(b)}$ 进行比较，以评估其一致性。\n\n- **节点成员集合**：对于一个给定的划分 $c$，节点 $i$ 的成员集合 $S_i(c)$ 是所有与 $i$ 属于同一社群的节点的集合：\n  $$ S_i(c) = \\{ j \\in \\{1, \\dots, n\\} \\,:\\, c_j = c_i \\} $$\n\n- **节点级杰卡德相似度**：节点 $i$ 周围的局部社群结构在参考划分 $c^{(0)}$ 和自助重采样划分 $c^{(b)}$ 之间的相似性，通过其成员集合的杰卡德相似度来量化：\n  $$ J_i^{(b)} = \\frac{ \\left| S_i(c^{(0)}) \\cap S_i(c^{(b)}) \\right| }{ \\left| S_i(c^{(0)}) \\cup S_i(c^{(b)}) \\right| } $$\n\n- **模块可复现性得分**：一个**参考模块** $M$ 是在参考划分中共享相同社群标签的一组节点，即对于某个标签 $\\ell$，$M = \\{i \\,:\\, c_i^{(0)} = \\ell\\}$。此模块的可复现性得分 $R_M$ 是节点级杰卡德相似度的平均值，该平均值是对模块中所有节点和所有自助重采样副本计算的：\n  $$ R_M = \\frac{1}{|M| \\cdot B} \\sum_{i \\in M} \\sum_{b=1}^{B} J_i^{(b)} $$\n  大小 $|M| < 2$ 的平凡模块被排除在此分析之外。\n\n- **一致性决策**：如果一个参考模块 $M$（$|M| \\ge 2$）的可复现性得分达到或超过给定的阈值 $\\tau$，则该模块被声明为**一致的**：\n  $$ R_M \\ge \\tau $$\n一个测试用例的最终结果是这样的一致模块的总数。\n\n### **3. 贪心模块度最大化算法**\n\n实现了一个确定性的贪心算法来寻找一个近似最大化模块度 $Q$ 的划分。该算法分两个阶段进行，并重复这两个阶段，直到 $Q$ 值无法再增加为止。\n\n**初始化**：$n$ 个节点中的每一个都被分配到其自己唯一的社群中。\n\n**阶段1：迭代式节点移动**\n此阶段包括在社群之间迭代地移动单个节点。算法遍历每个节点，并评估将其移动到其他每个社群时模块度的变化 $\\Delta Q$。执行导致最大正 $\\Delta Q$ 的移动。为确保确定性，此实现方式在每一步中搜索所有节点和所有可能目标社群中的全局最佳移动。只有当 $\\Delta Q > 0$ 时才进行移动。此阶段重复进行，直到没有单个节点移动可以严格增加 $Q$。将节点 $u$ 从社群 $C$ 移动到社群 $D$ 所引起的模块度变化由下式给出：\n$$ \\Delta Q_{move} = \\frac{k_{u,D} - k_{u,C}}{m} + \\frac{k_u(K_C - K_D - k_u)}{2m^2} $$\n其中，$k_{u,X} = \\sum_{j \\in X} A_{uj}$ 是从节点 $u$ 到社群 $X$ 中节点的边权之和，$K_X = \\sum_{j \\in X} k_j$ 是社群 $X$ 中节点的度之和。\n\n**阶段2：迭代式社群合并**\n节点移动阶段收敛后，算法尝试合并现有的社群对。它评估每对可能合并的社群的 $\\Delta Q$。执行产生最大正 $\\Delta Q$ 的合并。此阶段重复进行，直到没有成对合并可以严格增加 $Q$。合并两个社群 $C_1$ 和 $C_2$ 所引起的模块度变化为：\n$$ \\Delta Q_{merge} = \\frac{L_{12}}{m} - \\frac{K_1 K_2}{2m^2} $$\n其中 $L_{12} = \\sum_{i \\in C_1, j \\in C_2} A_{ij}$ 是社群 $C_1$ 和 $C_2$ 之间的边权之和。\n\n**终止**：整个算法在阶段1和阶段2之间交替运行，每个阶段都运行至收敛。当完整地执行一遍两个阶段后，社群结构不再发生变化，从而全局模块度也无法进一步增加时，算法终止。在任何可能产生空社群的更新之后，社群标签都会被重新标记为连续整数。", "answer": "[2,0,0,2]", "id": "4362312"}]}