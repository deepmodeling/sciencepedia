## 引言
细胞的生命活动依赖于一个由数千个生化反应构成的复杂代谢网络。理解这个网络的系统性行为，以及它如何将基因型信息转化为可观察的表型，是后基因组时代系统生物学的核心挑战之一。基因组尺度[代谢模型](@entry_id:167873)（Genome-Scale Metabolic Models, GEMs）为应对这一挑战提供了强有力的计算框架。它通过数学方式系统性地整合了基因组、生物化学和生理学知识，构建了一个能够预测细胞在不同遗传和环境条件下代谢能力的计算机模拟模型。然而，从零散的[基因注释](@entry_id:164186)信息到一个具有预测能力的可靠模型，其重建过程涉及一系列严谨的原理和步骤，这也是本章旨在阐明的主题。

本文将系统地引导读者穿越基因组尺度[代谢模型](@entry_id:167873)重建的全过程。在“原理和机制”部分，我们将奠定理论基础，深入探讨化学计量矩阵的构建、从动态到[稳态](@entry_id:139253)的简化、[GPR规则](@entry_id:274031)的整合以及生物质函数的定义等核心概念。随后，在“应用与交叉学科联系”部分，我们将展示这些模型如何被应用于解决真实的生物学问题，从预测基因必需性、设计[个性化医疗](@entry_id:152668)方案到解析[微生物群落](@entry_id:167568)的复杂相互作用。最后，“动手实践”部分将提供一系列编码练习，帮助读者将理论知识转化为实际操作技能。通过这三个层面的学习，读者将对如何构建、精炼和应用基因组尺度[代谢模型](@entry_id:167873)建立一个全面而深刻的理解。

## 原理和机制

### [化学计量学](@entry_id:140916)基础：质量守恒与 $S$ 矩阵

基因组尺度[代谢模型](@entry_id:167873)（Genome-Scale Metabolic Model, GEM）的核心是一种将细胞内庞大的生化反应网络进行结构化和数学化的表示。这个表示的基石是 **[化学计量矩阵](@entry_id:275342)（stoichiometric matrix）**，通常用符号 $S$ 表示。该矩阵以一种精确且系统的方式，编码了网络中所有已知的化学转化和物质运输过程中的[质量守恒](@entry_id:204015)关系。[@problem_id:4383475]

具体来说，$S$ 矩阵的维度为 $m \times n$，其中 $m$ 是模型中不同代谢物的数量，而 $n$ 是反应的数量。矩阵的每一行对应一种特定的代谢物（考虑到[区室化](@entry_id:270828)，同一种化学物质在不同区室中被视为不同的代谢物），每一列则对应一个特定的生化反应或运输过程。矩阵中的元素 $S_{ij}$ 代表了代谢物 $i$ 在反应 $j$ 中的[化学计量系数](@entry_id:204082)。根据系统生物学领域的普遍约定，我们采用如下的符号惯例：

*   如果代谢物 $i$ 是反应 $j$ 的产物，则 $S_{ij} > 0$。
*   如果代谢物 $i$ 是反应 $j$ 的反应物（即被消耗），则 $S_{ij}  0$。
*   如果代谢物 $i$ 不参与反应 $j$，则 $S_{ij} = 0$。

通过这种方式，$S$ 矩阵将一个复杂的[反应网络](@entry_id:203526)图转化为一个可以进行代数运算的数学对象。代谢物浓度随时间的变化率可以通过一个常微分方程组（ODE）来描述，其矩阵形式简洁而有力：

$$
\frac{d\mathbf{c}}{dt} = S \cdot \mathbf{v}
$$

在这个基本方程中，$\mathbf{c}$ 是一个 $m \times 1$ 的列向量，表示 $m$ 种代谢物的浓度；而 $\mathbf{v}$ 是一个 $n \times 1$ 的列向量，代表 $n$ 个反应的速率，即 **通量（flux）**。这个方程优雅地阐明了，任何代谢物浓度的净变化都等于其在所有反应中总生成速率与总消耗速率之和。

此外，$S$ 矩阵的结构还蕴含了关于 **[守恒量](@entry_id:161475)（conserved moieties）** 的信息。[守恒量](@entry_id:161475)是指一组代谢物浓度的[线性组合](@entry_id:155091)，其总量在网络中任何反应发生时都保持不变，例如腺苷酸（ATP, ADP, AMP）的总库。在数学上，一个表征[守恒量](@entry_id:161475)的向量 $\mathbf{l}$ 位于 $S$ 矩阵的左零空间，满足 $\mathbf{l}^T S = \mathbf{0}$。这意味着，对于任何通量向量 $\mathbf{v}$，该[守恒量](@entry_id:161475)的总浓度变化率 $\frac{d(\mathbf{l}^T \mathbf{c})}{dt} = \mathbf{l}^T \frac{d\mathbf{c}}{dt} = \mathbf{l}^T S \mathbf{v} = \mathbf{0}$，总量恒定。[@problem_id:4383475]

### 从动态到[稳态](@entry_id:139253)：基于约束的方法

尽管 $\frac{d\mathbf{c}}{dt} = S \cdot \mathbf{v}$ 方程为描述代谢网络动态提供了普适框架，但构建一个完整的动态模型（即 **动力学模型**）面临着巨大挑战。这主要是因为确定每个反应的精确[速率方程](@entry_id:198152)（例如[米氏方程](@entry_id:146495)）需要大量的动力学参数（如 $V_{max}$, $K_M$ 等），而这些参数在基因组尺度上绝大多数是未知的，且难以实验测定。[@problem_id:4383481]

为了克服这一障碍，基因组尺度模型采用了一种不同的、功能强大的简化假设：**[准稳态假设](@entry_id:273480)（quasi-steady-state assumption, QSSA）**。该假设认为，与[细胞生长](@entry_id:175634)、分裂等较慢过程（小时级别）相比，胞内小分子代谢物的浓度达到平衡的速度非常快（秒或毫秒级别）。因此，在研究细胞的稳定生长表型时，可以合理地假设胞内代谢物的净浓度变化率为零。

在数学上，QSSA 意味着 $\frac{d\mathbf{c}}{dt} = \mathbf{0}$。这将核心的动态方程简化为一个线性的代数约束方程组：

$$
S \cdot \mathbf{v} = \mathbf{0}
$$

这个方程是 **通量平衡分析（Flux Balance Analysis, FBA）** 等[基于约束的分析](@entry_id:203563)方法的基础。它构成了代谢网络的一个核心约束，即在[稳态](@entry_id:139253)下，每种代谢物的总生成速率必须精确地等于其总消耗速率。

这一转变深刻地改变了建模的范式。在动力学模型中，主要变量是随时间变化的 **代谢物浓度** $\mathbf{c}(t)$；而在基于约束的模型中，主要变量变成了 **反应通量** $\mathbf{v}$。模型的参数不再是难以获取的动力学常数，而是相对容易确定的[化学计量关系](@entry_id:144494)（$S$ 矩阵）以及对通量的 **边界约束（bounds）**（$v_{min} \le v_j \le v_{max}$）。这些边界可以代表[热力学](@entry_id:172368)不可逆性（例如，$v_j \ge 0$）、酶的催化能力上限或营养物质的吸收速率限制。这种方法的[计算效率](@entry_id:270255)极高，使其能够处理包含数千个反应和代谢物的[全基因组](@entry_id:195052)尺度网络，用以分析代谢能力、预测生长表型和识别药物靶点等重要生物学问题。[@problem_id:4383481]

### 重建的基本单元：反应与代谢物

#### 反应的校订：确保基本守恒

在向 $S$ 矩阵中添加任何一个反应（即矩阵的一列）之前，必须确保该反应在化学上是正确的。这要求每个反应都必须同时满足 **[质量守恒](@entry_id:204015)** 和 **电荷守恒**。[@problem_id:4383414] 在建模实践中，这意味着对于一个反应，反应物侧所有分子中每种元素的原子总数必须等于产物侧的原子总数，同时，反应物侧的总电荷也必须等于产物侧的总电荷。

这一原则的实施需要考虑细胞环境的生理化学特性，特别是pH。因为代谢物通常是弱酸或[弱碱](@entry_id:143319)，它们在溶液中的[质子化状态](@entry_id:753827)（以及所带电荷）取决于所在区室的pH。因此，模型中的每个代谢物都应以其在特定pH下的主要质子化形式表示。

例如，考虑在细胞质（假定 $pH = 7.2$）中[ATP水解](@entry_id:142984)这一基本反应。在此pH下，ATP、ADP和无机[磷酸盐](@entry_id:196950)的主要形式分别是 $\mathrm{ATP}^{4-}$、$\mathrm{ADP}^{3-}$ 和 $\mathrm{HPO_4^{2-}}$。一个看似合理的反应式是：

$$
\mathrm{ATP}^{4-} + \mathrm{H_2O} \rightarrow \mathrm{ADP}^{3-} + \mathrm{HPO_4^{2-}}
$$

然而，通过仔细检查可以发现，这个反应式并未实现守恒。反应物侧的总电荷是 $-4$，而产物侧的总电荷是 $-3 + (-2) = -5$。此外，反应物侧有14个氢原子（$\mathrm{ATP}^{4-}$ 中12个，$\mathrm{H_2O}$ 中2个），而产物侧只有13个（$\mathrm{ADP}^{3-}$ 中12个，$\mathrm{HPO_4^{2-}}$ 中1个）。为了同时平衡电荷和氢原子，必须在产物侧显式地加入一个质子：

$$
\mathrm{ATP}^{4-} + \mathrm{H_2O} \rightarrow \mathrm{ADP}^{3-} + \mathrm{HPO_4^{2-}} + \mathrm{H^+}
$$

现在，反应物侧和产物侧的总电荷都是 $-4$，氢[原子数](@entry_id:746561)都是14，实现了完全的质量与电荷守恒。这个例子强调，即使在高度缓冲的细胞环境中，质子（$\mathrm{H^+}$）也必须作为一种独立的代谢物被精确追踪和平衡，否则将违反基本的物理化学定律，导致模型在数学上不自洽。[@problem_id:4383414]

#### 反应的方向性：[热力学](@entry_id:172368)与约束

在构建模型时，必须为每个反应的通量 $v_j$ 设定方向性约束，即其上界和下界。一个反应在模型中被定义为 **可逆的（reversible）**，当且仅当其通量被允许取正值（正向）和负值（逆向），即 $v_{min}  0$ 且 $v_{max}  0$。如果一个反应被限制为只能朝一个方向进行（通常是 $v_{min} = 0$），则它在模型中是 **不可逆的（irreversible）**。

需要强调的是，模型中的这种“可逆性”是一个基于约束的计算属性，它与反应的微观 **动力学可逆性**（即正向和逆向[速率常数](@entry_id:140362)均不为零）以及 **[热力学](@entry_id:172368)可行性** 既有联系又有区别。[@problem_id:4383509]

一个反应的实际方向由其在特定细胞条件下的 **吉布斯自由能变（Gibbs free energy change）** $\Delta G$ 决定。只有当 $\Delta G  0$ 时，反应才能自发地朝正向进行。$\Delta G$ 的值不仅取决于反应的[标准自由能变](@entry_id:163383) $\Delta G^{\circ'}$，还取决于反应物和产物的实际浓度，其关系由下式给出：

$$
\Delta G = \Delta G^{\circ'} + RT \ln Q
$$

其中 $R$ 是气体常数，$T$ 是绝对温度，$Q$ 是[反应商](@entry_id:145217)（产物浓度与反应物浓度的比值）。

因此，一个反应在模型中是否应被设为可逆，取决于在生理浓度范围内，其 $\Delta G$ 的符号是否可能发生改变。例如，假设一个反应 $\mathrm{A} \rightleftharpoons \mathrm{B}$ 的 $\Delta G^{\circ'} = +5\,\mathrm{kJ\,mol^{-1}}$，这是一个在标准条件下非自发的过程。然而，如果在细胞内，代谢物浓度可以在 $[0.1, 10]\,\mathrm{mM}$ 范围内波动，我们可以通过计算发现：当反应物A的浓度远高于产物B时（例如 $[A] = 10\,\mathrm{mM}, [B]=0.1\,\mathrm{mM}$），反应商 $Q$ 会变得非常小，足以使 $\ln Q$ 项成为一个较大的负数，从而让总的 $\Delta G$ 变为负值，驱动反应正向进行。反之，当B的浓度远高于A时，$\Delta G$ 会是正值，驱动反应逆向进行。由于在生理条件下反应可以双向进行，因此在模型中将其设置为可逆是合理的。[@problem_id:4383509] 相反，如果一个反应的 $\Delta G$ 在所有生理条件下都保持很大的负值，那么即使它在动力学上是可逆的（即逆向[速率常数](@entry_id:140362)非零），其逆向通量也几乎可以忽略不计，因此在模型中通常将其简化为不[可逆反应](@entry_id:202665)。

### 构建细胞空间：区室、运输与交换

细胞内的代谢并非在均一的“反应袋”中发生，而是在多个由膜分隔开的 **区室（compartments）** 中有序进行，例如细胞质、线粒体、[叶绿体](@entry_id:151416)、过氧化物酶体等。为了准确地模拟细胞代谢，GEMs必须明确地表示这种[区室化](@entry_id:270828)结构。[@problem_id:4383569]

在数学模型中，[区室化](@entry_id:270828)是通过将同一种化学物质在不同区室中的存在视为不同的代谢物来实现的。例如，细胞质中的ATP（表示为 `ATP[c]`）和线粒体中的ATP（表示为 `ATP[m]`）在 $S$ 矩阵中被分配到不同的行，并被视为两个独立的变量。[@problem_id:4390645] 这种表示方法极大地扩展了模型的规模，但也极大地提升了其生物学真实性。

区室化的引入自然地将模型中的反应分为三类：

1.  **内部反应（Internal reactions）**：这类反应的所有反应物和产物都位于同一个区室中。在 $S$ 矩阵中，该反应对应的列中，所有非零元素都只出现在属于同一区室的代谢物行中。

2.  **运输反应（Transport reactions）**：这类反应负责将代谢物从一个区室移动到另一个区室。例如，一个将物质A从细胞质运输到线粒体的反应（$A[c] \rightarrow A[m]$），在其对应的 $S$ 矩阵列中，`A[c]` 的行将有一个负的[化学计量系数](@entry_id:204082)（如-1），而 `A[m]` 的行将有一个正的系数（如+1）。许多运输过程更为复杂，可能涉及多种物质的[协同运输](@entry_id:137109)（symport）或反向运输（antiport），例如[质子梯度](@entry_id:154755)驱动的运输。无论如何，运输反应的本质是在模型内部重新分配物质，它们自身不会改变某种物质在所有区室中的总和。如果我们将一个被运输的物质在所有区室的[稳态平衡](@entry_id:137090)方程相加，所有运输该物质的反应通量项都将相互抵消。[@problem_id:4383569]

3.  **交换反应（Exchange reactions）**：这类反应是模型与外界环境进行物质交换的通道，允许营养物质的摄取和代谢废物的分泌。交换反应在模型中通常被实现为“伪反应”，它连接一个外部“无限”环境（不作为模型的一行出现）和一个模型内的代谢物（通常是位于胞外区室的代谢物）。例如，葡萄糖的摄取反应可以写为 $\emptyset \rightarrow \text{glucose}[e]$。在 $S$ 矩阵中，这个反应的列只有一个非零元素，即在 `glucose[e]` 对应的行上有一个+1。通过设定这个交换反应通量的边界，我们可以模拟不同的培养基条件。例如，将葡萄糖摄取通量的下界设为-10，就代表细胞最多可以以 10 个单位的速率吸收葡萄糖。正是通过交换反应，整个代谢系统得以开放，实现与环境的物质交换，并在[稳态](@entry_id:139253)下维持生命活动。[@problem_id:4383569]

### 连接[基因型与表型](@entry_id:142682)：[GPR规则](@entry_id:274031)与生物质功能

一个完整的基因组尺度代谢 **重建（reconstruction）** 不仅仅是一个数学模型，它首先是一个结构化的、有证据支持的知识库，系统地整理了某个物种的基因、蛋白质、反应、代谢物和区室等信息。[@problem_id:4390645] 这个知识库是推导数学模型的基础。其中，连接基因组信息和代谢功能的关键环节是 **[基因-蛋白质-反应](@entry_id:261823)（Gene-Protein-Reaction, GPR）规则**。

[GPR规则](@entry_id:274031)是[布尔逻辑](@entry_id:143377)表达式，它精确地描述了基因、蛋白质和它们所催化的反应之间的关系，是中心法则在代谢网络中的具体体现。

*   **异构酶（Isoenzymes）**：如果多个不同的基因编码的蛋白质可以催化同一个反应，这层关系由 **OR** [逻辑表示](@entry_id:270811)。例如，如果基因 $g_1$ 和 $g_2$ 分别编码的酶都能催化反应 $R_j$，则其[GPR规则](@entry_id:274031)为 $g_1 \lor g_2$。只要 $g_1$ 或 $g_2$ 任意一个基因被表达，反应 $R_j$ 就可以发生。

*   **酶复合物（Enzyme complexes）**：如果一个酶由多个不同的[蛋白质亚基](@entry_id:178628)组成，这些亚基必须同时存在才能形成有活性的酶，这层关系由 **AND** [逻辑表示](@entry_id:270811)。例如，如果反应 $R_k$ 由基因 $g_3$ 和 $g_4$ 编码的[蛋白质亚基](@entry_id:178628)组成的复合物催化，则其[GPR规则](@entry_id:274031)为 $g_3 \land g_4$。只有当 $g_3$ 和 $g_4$ 都被表达时，反应 $R_k$ 才能发生。

在FBA等[基于约束的分析](@entry_id:203563)中，[GPR规则](@entry_id:274031)的作用是决定反应的 **可用性**。当模拟基因敲除时（例如，删除基因 $g_1$），模型会评估所有与 $g_1$ 相关的[GPR规则](@entry_id:274031)。如果某个反应 $R_j$ 的[GPR规则](@entry_id:274031)在 $g_1$ 缺失后其布尔值变为FALSE，那么该反应就被认为是“关闭”的，其通量 $v_j$ 的上下界将被设为0。重要的是，[GPR规则](@entry_id:274031)影响的是通量向量 $\mathbf{v}$ 的约束，而不是化学计量矩阵 $S$ 本身。[@problem_id:4390645]

为了模拟细胞生长这一复杂的生物学过程，模型中引入了一个特殊的 **生物质目标函数（biomass objective function）**。这是一个“伪反应”，它从网络中按照精确的比例消耗各种[生物合成](@entry_id:174272)前体（如氨基酸、核苷酸、脂质、[辅因子](@entry_id:137503)等），以合成一个单位的“生物质（Biomass）”伪代谢物。[@problem_id:4383542] 通过最大化这个生物质反应的通量（$v_{biomass}$），FBA可以预测在给定营养条件下细胞的最大理论生长速率。

生物质[反应的化学计量](@entry_id:153621)系数是根据实验测定的细胞干重中各大类生物大分子的组成比例来计算的。例如，如果已知蛋白质占细胞干重的55%（$f_{prot} = 0.55$），且平均氨基酸的分子量为 $110 \, \mathrm{g\,mol^{-1}}$（$M_{AA}$），那么在合成1克生物质的反应中，所需氨基酸前体的摩尔量就是：

$$
c_{AA} = \frac{f_{prot}}{M_{AA}} = \frac{0.55}{110} = 0.005 \, \mathrm{mol \cdot (gDW)^{-1}}
$$

通过对所有生物质组分（蛋白质、RNA、DNA、脂质、细胞壁成分、辅因子等）进行类似计算，就可以构建一个精确的、[质量归一化](@entry_id:178966)的生物质反应。值得注意的是，生物大分子的聚合过程本身也需要消耗能量（如ATP），这部分能量消耗通常在一个独立的 **生长[相关能](@entry_id:144432)量维持（Growth-Associated Maintenance, GAM）** 反应中核算，而不是直接包含在生物质组分反应中，以清晰地区分物质需求和能量需求。[@problem_id:4383542]

### 模型的精炼与校订：处理不完备性与伪影

#### 识别网络缺口：死端代谢物与阻塞反应

自动化的重建流程产生的草稿模型往往是不完整的，存在许多 **网络缺口（gaps）**。这些缺口在模型中表现为 **死端代谢物（dead-end metabolites）** 和 **阻塞反应（blocked reactions）**。[@problem_id:4383576]

*   **死端代谢物**：是指一个代谢物在网络中只有生成的反应而没有消耗的反应（no-consumer dead-end），或者只有消耗的反应而没有生成的反应（no-producer dead-end）。

*   **阻塞反应**：是指在任何满足[稳态](@entry_id:139253)条件 $S\mathbf{v}=\mathbf{0}$ 的可行通量分布中，其通量都必须为零的反应。

这两种现象密切相关。根据[稳态](@entry_id:139253)约束，一个“无消费者”的死端代谢物，其所有[生成反应](@entry_id:147837)都必须是阻塞的，因为任何净生成都无法被消耗，从而会破坏[稳态](@entry_id:139253)。同样，一个“无生产者”的死端代谢物，其所有消耗反应也必然被阻塞。

例如，考虑一个简单的线性通路 $A_c \xrightarrow{r_1} B_c \xrightarrow{r_3} B_m \xrightarrow{r_4} C_m$，其中 $r_3$ 是一个将物质B从细胞质（c）运输到线粒体（m）的转运蛋白。如果因为[基因注释](@entry_id:164186)不完整而导致转运蛋白 $r_3$ 在模型中缺失，那么 $B_c$ 就成为了一个死端代谢物（它由 $r_1$ 生成，但没有出路），而 $B_m$ 也成为了一个死端代谢物（它需要被 $r_4$ 消耗，但没有来源）。其后果是，为了满足[稳态](@entry_id:139253)条件，生成 $B_c$ 的反应 $r_1$ 和消耗 $B_m$ 的反应 $r_4$ 的通量都必须为零。这个局部的缺口（缺失 $r_3$）导致了整个通路的阻塞。识别这些死端和阻塞反应是诊断模型不完备性的关键步骤。[@problem_id:4383576]

#### 填补缺口：缺口填充过程

识别出网络缺口后，下一步就是 **缺口填充（gap filling）**。这是一个通过向模型中添加新反应来修复[网络连通性](@entry_id:149285)、使其能够执行特定生物学功能（如产生生物质）的过程。[@problem_id:4383426]

由于可能的生化反应数量极其庞大，盲目添加反应会导致模型失去生物学意义。因此，缺口填充通常在一个预先定义的 **候选反应集** ($\mathcal{R}_{cand}$) 中进行搜索。这个集合是基于生物信息学证据（如同源[基因注释](@entry_id:164186)）和通用生化知识库（如KEGG, MetaCyc）为特定物种精心策划的，它极大地缩小了搜索空间，并确保了添加的反应具有生物学合理性。

缺口填充算法可以分为两大类：

1.  **拓扑缺口填充**：这类方法仅从网络图的连通性出发，寻找能够连接“孤岛”和“断路”的最短路径。它能有效地恢复基本的[路径连通性](@entry_id:142695)，但因为它忽略了反应的方向性和[热力学约束](@entry_id:755911)，所以可能会提出一些虽然在拓扑上可行但实际上在[热力学](@entry_id:172368)上不可能发生的反应组合。

2.  **[热力学](@entry_id:172368)可行缺口填充**：这是一种更为严谨的方法。它不仅要求找到一条能够实现功能的[化学计量学](@entry_id:140916)[平衡路径](@entry_id:749059)（即存在满足 $S\mathbf{v}=\mathbf{0}$ 的通量 $\mathbf{v}$），还要求同时存在一个在生理范围内的代谢物浓度分布，使得该路径上所有反应的吉布斯自由能变都与其通量方向一致（即 $v_j \Delta G_j \le 0$）。这种方法可以避免引入[热力学](@entry_id:172368)上不成立的“[伪路径](@entry_id:168255)”，从而构建出更加真实和可靠的模型。[@problem_id:4383426]

#### 识别伪影：冗余循环与货币代谢物

即使一个模型在拓扑上是完全连通的，它也可能包含另一类被称为 **冗余循环（futile cycles）** 或II型基本模式的建模伪影。这些循环是一组反应，当它们以特定比例运行时，其净效应是零，不消耗任何外部底物，也不产生任何最终产物，但却在模型内部空转，消耗能量（例如，将ATP水解为ADP再重新合成ATP）。

这类循环的产生往往与 **货币代谢物（currency metabolites）** 有关。[@problem_id:4383428] 货币代谢物，如ATP/ADP、NADH/NAD+、水和质子等，参与了网络中成百上千个反应，具有极高的连接度。它们的广泛参与在 $S$ 矩阵中造成了大量的[线性依赖](@entry_id:185830)关系，从而增加了 $S$ 矩阵零空间（即满足 $S\mathbf{v}=\mathbf{0}$ 的解空间）的维度。冗余循环正是这个零空间中的一些非[平凡解](@entry_id:155162)。

例如，考虑一个包含三个反应的简单网络：
$R_1: \mathrm{A} + \mathrm{ATP} \rightarrow \mathrm{B} + \mathrm{ADP}$
$R_2: \mathrm{B} + \mathrm{H_2O} \rightarrow \mathrm{A} + \mathrm{P_i}$
$R_3: \mathrm{ADP} + \mathrm{P_i} \rightarrow \mathrm{ATP} + \mathrm{H_2O}$ ([ATP合成](@entry_id:138525))

仅从[化学计量学](@entry_id:140916)角度看，如果这三个反应以相同的通量 $v  0$ 运行，可以验证所有代谢物的净变化都为零，完全满足 $S\mathbf{v}=\mathbf{0}$ 的约束。然而，这三个反应的总和是 $0 \rightarrow 0$，实际上构成了一个将ATP水解与合成相耦合的空转。从[热力学](@entry_id:172368)角度看，在细胞内，ATP合成（$R_3$）需要巨大的能量输入（$\Delta G_3  0$），而 $R_1$ 和 $R_2$ 的自由能变总和通常不足以驱动它。因此，这个在[化学计量学](@entry_id:140916)上成立的循环，在[热力学](@entry_id:172368)上是不可能发生的。

纯粹的FBA无法区分这种伪影。为了消除它们，需要引入额外的约束。最有效的方法是整合[热力学](@entry_id:172368)信息，要求所有反应都满足 $v_j \Delta G_j \le 0$。对于上述例子，由于生理条件下 $\Delta G_3  0$，该约束将迫使 $v_3 \le 0$，从而打破了需要 $v_3  0$ 的冗余循环。此外，也发展了如“无环路FBA”（loopless FBA）等算法，它们在优化求解过程中通过数学方法直接移除这些循环解。[@problem_id:4383428] 简单地从模型中删除货币代谢物是不可取的，因为这会破坏模型预测能量和[氧化还原平衡](@entry_id:166906)等关键生理功能的能力。