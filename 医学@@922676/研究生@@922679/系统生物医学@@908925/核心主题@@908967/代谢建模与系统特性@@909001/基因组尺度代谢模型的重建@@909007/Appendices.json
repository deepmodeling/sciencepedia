{"hands_on_practices": [{"introduction": "任何可靠的基因组尺度代谢模型（GEM）都建立在基本物理定律之上，即质量和电荷守恒。此练习将指导您对单个生化反应进行审计，这是确保模型内部一致性和物理可行性的基本技能。通过解决一个被错误编码的反应，您将亲身体验模型修正过程中的一个关键质量控制步骤，即验证和校正每个反应的化学计量，以防止物质在模拟中被无中生有或凭空消失 [@problem_id:4383604]。", "problem": "基因组尺度代谢模型 (Genome-Scale Metabolic Model, GEM) 以明确的化学计量系数表示特定细胞区室中的代谢物所参与的生物化学反应，并要求严格遵守质量守恒和电荷守恒。考虑一个人类细胞中的胞质碳酸酐酶反应，其在模型中被错误地编码为\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}},\n$$\n其中下标 $\\mathrm{c}$ 和 $\\mathrm{m}$ 分别表示胞质和线粒体区室。在生理pH值下，使用以下代谢物分子式和净电荷：\n- $\\mathrm{CO_2}$：分子式 $C_1O_2$，净电荷 $0$。\n- $\\mathrm{H_2O}$：分子式 $H_2O_1$，净电荷 $0$。\n- $\\mathrm{HCO_3^-}$：分子式 $C_1H_1O_3$，净电荷 $-1$。\n- $\\mathrm{H^+}$：分子式 $H_1$，净电荷 $+1$。\n\n从质量守恒（反应前后每种元素的数量守恒）和电荷守恒（反应物和产物的电荷代数和必须相等）的基本原理出发，对给定反应进行质量和电荷审查。由于纯粹的酶促转化不会跨区室转运物质，首先通过将 $\\mathrm{H_2O}$ 放置在胞质区室来修正水的区室分配。然后，确定在产物侧分配给 $\\mathrm{H^+}_{\\mathrm{c}}$ 的单一化学计量系数 $n$，以使修正后的胞质反应中质量和电荷均守恒：\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}.\n$$\n提供 $n$ 的值作为你的最终答案。无需单位。最终答案必须是单个实数值。如果计算出非整数值，不要四舍五入，报告精确值。如果计算出整数值，请准确报告。", "solution": "根据科学合理性、一致性和形式化能力的原则，对所述问题进行验证。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- **初始反应（错误）：** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}}$\n- **区室定义：** $\\mathrm{c}$ 代表胞质，$\\mathrm{m}$ 代表线粒体。\n- **代谢物性质（在生理pH值下）：**\n  - $\\mathrm{CO_2}$：分子式 $C_1O_2$，净电荷 $0$。\n  - $\\mathrm{H_2O}$：分子式 $H_2O_1$，净电荷 $0$。\n  - $\\mathrm{HCO_3^-}$：分子式 $C_1H_1O_3$，净电荷 $-1$。\n  - $\\mathrm{H^+}$：分子式 $H_1$，净电荷 $+1$。\n- **修正说明：**\n  1. 该反应是纯粹的酶促反应，不涉及物质转运；因此，$\\mathrm{H_2O}$ 必须被分配到胞质区室，即 $\\mathrm{H_2O_c}$。\n  2. 必须通过在产物侧引入一个带有未知化学计量系数 $n$ 的质子 $\\mathrm{H^+_c}$ 来平衡反应的质量和电荷。\n- **待平衡的最终反应形式：** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}$。\n\n**步骤2：验证提取的已知条件**\n- **科学依据：** 该问题围绕碳酸酐酶反应展开，这是一个基本的生物化学过程。它正确地应用了质量守恒和电荷守恒原理，这些是化学和物理学中不可违背的定律。基因组尺度代谢模型 (GEM) 和区室化的背景是系统生物学领域的核心。该问题的前提具有科学合理性。\n- **适定性：** 该问题提供了所有必要信息（原子组成、电荷以及修正后反应的结构形式），以确定单个未知变量 $n$。这种结构导向一个唯一且稳定的解。\n- **客观性：** 该问题使用精确的化学和数学术语进行陈述。它没有模糊性、主观性或观点。\n\n**步骤3：结论与行动**\n- **结论：** 该问题有效。它具有科学依据、适定性且内部一致。\n- **行动：** 继续求解。\n\n**求解推导**\n\n任何有效的生物化学反应都遵循基本原理，即各元素的质量守恒和总电荷守恒。本题要求我们找到质子 $\\mathrm{H^+_c}$ 的化学计量系数 $n$，以使胞质碳酸酐酶反应满足这些原理。\n\n待平衡的修正后反应为：\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\n由于所有物质都处于同一胞质区室（$\\mathrm{c}$），为不失一般性，在平衡计算中可以省略区室标签。因此，反应的化学计量关系为：\n$$\n1\\,\\mathrm{CO_2} + 1\\,\\mathrm{H_2O} \\rightarrow 1\\,\\mathrm{HCO_3^-} + n\\,\\mathrm{H^+}\n$$\n我们现在将对每种元素（碳、氧、氢）和净电荷进行审查。\n\n**1. 质量平衡审查：**\n\n我们列表计算反应物侧和产物侧每种元素的原子数。\n\n- **碳 (C)：**\n  - 反应物：来自 $\\mathrm{CO_2}$（分子式 $C_1O_2$）的 $1$ 个原子。\n  - 产物：来自 $\\mathrm{HCO_3^-}$（分子式 $C_1H_1O_3$）的 $1$ 个原子。\n  - 平衡方程为 $1 = 1$。此式成立，但未对 $n$ 提供任何约束。\n\n- **氧 (O)：**\n  - 反应物：来自 $\\mathrm{CO_2}$ 的 $2$ 个原子 + 来自 $\\mathrm{H_2O}$（分子式 $H_2O_1$）的 $1$ 个原子。总计 $2 + 1 = 3$。\n  - 产物：来自 $\\mathrm{HCO_3^-}$ 的 $3$ 个原子。\n  - 平衡方程为 $3 = 3$。此式也成立，但未对 $n$ 提供任何约束。\n\n- **氢 (H)：**\n  - 反应物：来自 $\\mathrm{H_2O}$（分子式 $H_2O_1$）的 $2$ 个原子。\n  - 产物：来自 $\\mathrm{HCO_3^-}$ 的 $1$ 个原子 + 来自 $n\\,\\mathrm{H^+}$（分子式 $H_1$）的 $n \\times 1$ 个原子。总计 $1 + n$。\n  - 为保证质量守恒，两边的氢原子数必须相等：\n  $$\n  2 = 1 + n\n  $$\n\n**2. 电荷平衡审查：**\n\n接下来，我们平衡净电荷。\n\n- **反应物：**\n  - $\\mathrm{CO_2}$ 的电荷为 $0$。\n  - $\\mathrm{H_2O}$ 的电荷为 $0$。\n  - 反应物侧的总电荷为 $0 + 0 = 0$。\n\n- **产物：**\n  - $\\mathrm{HCO_3^-}$ 的电荷为 $-1$。\n  - $n\\,\\mathrm{H^+}$ 贡献的总电荷为 $n \\times (+1) = +n$。\n  - 产物侧的总电荷为 $-1 + n$。\n\n- 为保证电荷守恒，两边的净电荷必须相等：\n  $$\n  0 = -1 + n\n  $$\n\n**3. 求解 $n$：**\n\n我们为未知系数 $n$ 推导出了两个独立的方程。一个一致的问题陈述必须从两个方程中得出相同的 $n$ 值。\n\n根据氢原子质量守恒：\n$$\n2 = 1 + n \\implies n = 2 - 1 = 1\n$$\n根据电荷守恒：\n$$\n0 = -1 + n \\implies n = 1\n$$\n两个方程均得出一致的结果 $n=1$。这证实了该方法的正确性以及问题的适定性。\n\n因此，胞质中化学计量正确且电荷平衡的碳酸酐酶反应为：\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + 1\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\n化学计量系数 $n$ 的值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "4383604"}, {"introduction": "为了模拟细胞生长，模型需要一个“生物质目标函数”（Biomass Objective Function, BOF）。这是一个特殊的伪反应，它以精确的比例消耗各种代谢前体（如氨基酸、核苷酸），以合成一克细胞干重（gDW）所需的全部生物大分子。此练习将向您展示如何将实验室测得的细胞宏观分子组成数据，转化为BOF中各个组分的化学计量系数，这是将模型“定制”到特定生物体并定义其生长目标的关键一步 [@problem_id:4383603]。", "problem": "在平衡指数生长条件下培养的某种微生物，其大分子组成已按克干重 (gDW) 基础进行了测量。您正在为一个基因组尺度代谢模型构建一个生物质伪反应，其中生物质产物代表产生的一克干重。在此模型中，您使用聚合残基伪代谢物来表示大分子，这些伪代谢物的分子量已经过校正，扣除了聚合过程中损失的水的质量。生物质伪反应应消耗这些伪代谢物，其量应精确反映测得的组成，且化学计量系数的单位必须是毫摩尔/克干重 (mmol/gDW)。\n\n已知：\n- 各大分子类别的质量分数（克/克干重）：\n  - 蛋白质：$0.55$\n  - 核糖核酸 (RNA)：$0.20$\n  - 脱氧核糖核酸 (DNA)：$0.03$\n  - 脂质（集总）：$0.12$\n  - 碳水化合物（聚糖，作为聚合葡萄糖残基）：$0.10$\n- 聚合残基的分子量（克/摩尔）：\n  - 平均氨基酸残基 (Protein\\_res)：$110$\n  - 核糖核苷酸单磷酸残基 (rNMP\\_res)：$324$\n  - 脱氧核糖核苷酸单磷酸残基 (dNMP\\_res)：$308$\n  - 集总脂质单元 (Lipid\\_unit)：$700$\n  - 脱水葡萄糖残基 (Glycan\\_res)：$162$\n\n任务：\n1. 从质量守恒和物质的量的定义出发，推导每个聚合残基伪代谢物 $i$ 的化学计量系数 $s_{i}$（单位为 mmol/gDW）的通用表达式，该表达式是其质量分数 $f_{i}$（单位为 g/gDW）和聚合残基分子量 $M_{i}$（单位为 g/mol）的函数。当产生 1 gDW 生物质时，系数 $s_{i}$ 应为负值以表示消耗。\n2. 使用给定数据，计算伪代谢物 Protein\\_res、rNMP\\_res、dNMP\\_res、Lipid\\_unit 和 Glycan\\_res 的五个化学计量系数。不包括任何能量辅因子或无机副产物，并且在您报告的答案中不包括生物质产物项。\n\n将您的最终答案报告为包含五个化学计量系数的单行向量，顺序为 [Protein\\_res, rNMP\\_res, dNMP\\_res, Lipid\\_unit, Glycan\\_res]。在适当的情况下，将精确值表示为简化的有理数。单位是 mmol/gDW，但最终向量中不包含单位。", "solution": "该问题是有效的，因为它具有科学依据、问题明确、客观、自洽且一致。所提供的数据对于微生物系统是合理的，并且足以得出一个完整、唯一的解。质量分数的总和为 $0.55 + 0.20 + 0.03 + 0.12 + 0.10 = 1.00$，这证实了组分数据的一致性。我们将继续进行求解。\n\n问题分为两个任务：首先，推导化学计量系数的通用表达式；其次，计算它们的具体值。\n\n**任务1：化学计量系数 $s_i$ 的通用表达式推导**\n\n生物质伪反应表示消耗前体代谢物以产生 $1$ 克干重 (gDW) 的生物质。对于给定的前体伪代谢物 $i$，反应可以写为：\n$$\n\\dots + s_i \\cdot \\text{Metabolite}_i + \\dots \\longrightarrow 1 \\cdot \\text{Biomass}\n$$\n在此公式中，化学计量系数 $s_i$ 表示每单位产生的生物质所消耗的代谢物 $i$ 的摩尔数（或毫摩尔数）。根据代谢建模的惯例，反应物（消耗的物质）的系数为负，而产物（生成的物质）的系数为正。问题规定 $s_i$ 的单位为毫摩尔/克干重 (mmol/gDW)。\n\n设 $f_i$ 为生物质中大分子类别 $i$ 的质量分数，单位为组分 $i$ 的克数/总干重的克数 (g/gDW)。要产生 $1$ gDW 的生物质，必须合成质量为 $m_i$ 的组分 $i$。该质量由下式给出：\n$$\nm_i = f_i \\cdot (1 \\text{ gDW}) = f_i \\text{ [g]}\n$$\n组分 $i$ 的物质的量（单位为摩尔），记作 $n_i$，与其质量 $m_i$ 和分子量 $M_i$ 相关。问题给出的 $M_i$ 单位为克/摩尔 (g/mol)。关系式为：\n$$\nn_i = \\frac{m_i}{M_i}\n$$\n代入 $m_i$ 的表达式：\n$$\nn_i = \\frac{f_i}{M_i}\n$$\n$n_i$ 的单位是 $\\frac{\\text{g/gDW}}{\\text{g/mol}} = \\frac{\\text{mol}}{\\text{gDW}}$。这给出了产生 $1$ gDW 生物质所需的组分 $i$ 的摩尔量。\n\n问题要求化学计量系数 $s_i$ 的单位为毫摩尔/克干重 (mmol/gDW)。为了从摩尔转换为毫摩尔，我们使用转换因子 $1 \\text{ mol} = 1000 \\text{ mmol}$。\n$$\n|s_i| = n_i \\cdot 1000 \\left[\\frac{\\text{mmol}}{\\text{mol}}\\right] = \\frac{1000 \\cdot f_i}{M_i}\n$$\n$|s_i|$ 的单位是 $\\left[\\frac{\\text{mol}}{\\text{gDW}}\\right] \\cdot \\left[\\frac{\\text{mmol}}{\\text{mol}}\\right] = \\left[\\frac{\\text{mmol}}{\\text{gDW}}\\right]$，符合要求。\n\n最后，由于组分 $i$ 是反应物（被消耗），其化学计量系数必须为负。因此，$s_i$ 的通用表达式为：\n$$\ns_i = -\\frac{1000 \\cdot f_i}{M_i}\n$$\n其中 $f_i$ 的单位是 g/gDW，$M_i$ 的单位是 g/mol。\n\n**任务2：化学计量系数的计算**\n\n我们现在应用这个推导出的公式，使用所提供的数据来计算所要求的五个化学计量系数。\n\n1.  **Protein\\_res (氨基酸残基):**\n    $f_{\\text{protein}} = 0.55$ g/gDW\n    $M_{\\text{protein\\_res}} = 110$ g/mol\n    $$\n    s_{\\text{protein\\_res}} = -\\frac{1000 \\times 0.55}{110} = -\\frac{550}{110} = -5\n    $$\n\n2.  **rNMP\\_res (用于RNA的核糖核苷酸残基):**\n    $f_{\\text{RNA}} = 0.20$ g/gDW\n    $M_{\\text{rNMP\\_res}} = 324$ g/mol\n    $$\n    s_{\\text{rNMP\\_res}} = -\\frac{1000 \\times 0.20}{324} = -\\frac{200}{324} = -\\frac{100}{162} = -\\frac{50}{81}\n    $$\n\n3.  **dNMP\\_res (用于DNA的脱氧核糖核苷酸残基):**\n    $f_{\\text{DNA}} = 0.03$ g/gDW\n    $M_{\\text{dNMP\\_res}} = 308$ g/mol\n    $$\n    s_{\\text{dNMP\\_res}} = -\\frac{1000 \\times 0.03}{308} = -\\frac{30}{308} = -\\frac{15}{154}\n    $$\n\n4.  **Lipid\\_unit (集总脂质单元):**\n    $f_{\\text{lipid}} = 0.12$ g/gDW\n    $M_{\\text{lipid\\_unit}} = 700$ g/mol\n    $$\n    s_{\\text{lipid\\_unit}} = -\\frac{1000 \\times 0.12}{700} = -\\frac{120}{700} = -\\frac{12}{70} = -\\frac{6}{35}\n    $$\n\n5.  **Glycan\\_res (用于碳水化合物的脱水葡萄糖残基):**\n    $f_{\\text{carb}} = 0.10$ g/gDW\n    $M_{\\text{glycan\\_res}} = 162$ g/mol\n    $$\n    s_{\\text{glycan\\_res}} = -\\frac{1000 \\times 0.10}{162} = -\\frac{100}{162} = -\\frac{50}{81}\n    $$\n\n因此，只考虑这些大分子前体的生物质伪反应将是：\n$$\n5 \\text{ Protein\\_res} + \\frac{50}{81} \\text{ rNMP\\_res} + \\frac{15}{154} \\text{ dNMP\\_res} + \\frac{6}{35} \\text{ Lipid\\_unit} + \\frac{50}{81} \\text{ Glycan\\_res} \\longrightarrow 1 \\text{ Biomass}\n$$\n最终答案中报告的化学计量系数必须是计算出的负值。按所要求的顺序 [Protein\\_res, rNMP\\_res, dNMP\\_res, Lipid\\_unit, Glycan\\_res]，这五个系数是 $[-5, -\\frac{50}{81}, -\\frac{15}{154}, -\\frac{6}{35}, -\\frac{50}{81}]$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -5  -\\frac{50}{81}  -\\frac{15}{154}  -\\frac{6}{35}  -\\frac{50}{81} \\end{pmatrix}}\n$$", "id": "4383603"}, {"introduction": "流平衡分析（Flux Balance Analysis, FBA）是利用GEMs预测代谢通量的核心 computational tool。然而，FBA的预测能力在很大程度上取决于模型结构的准确性，尤其是在真核细胞中，区室化是一个不可忽视的关键特征。这个动手编码练习将引导您构建并比较两个模型——一个简化版和另一个包含明确区室（线粒体和细胞质）及转运蛋白限制的模型——从而具体地揭示模型结构细节如何影响细胞代谢行为和氧化还原平衡的预测结果 [@problem_id:4383433]。", "problem": "一位开发者被要求研究在基因组尺度代谢重建的背景下，对穿梭代谢物的区室特异性处理和显式的转运能力如何影响稳态途径通量和氧化还原耦合。其数学基础是质量守恒定律和稳态平衡，这给出了线性约束 $S v = 0$，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量。所采用的方法是流平衡分析 (FBA)，它被构建为一个线性规划问题：在约束条件 $S v = 0$ 和边界约束 $\\ell \\le v \\le u$ 下，最大化线性目标 $c^\\top v$。流平衡分析 (FBA) 依赖于已知的化学计量关系以及对内部代谢物处于准稳态的假设。\n\n您将构建并比较两个小型的区室化代谢模型，这些模型包括胞质糖酵解、胞質乳酸脱氢酶、丙酮酸进入线粒体的转运、一个产生线粒体还原型烟酰胺腺嘌呤二核苷酸 (NADH) 的简化三羧酸循环、一个利用氧气将还原型烟酰胺腺嘌呤二核苷酸 (NADH) 转化为三磷酸腺苷 (ATP) 的电子传递链，以及一个苹果酸介导的氧化还原穿梭。第一个模型使用单区室版本的苹果酸（未区分的苹果酸），隐式地允许通过该代谢物无限混合氧化还原当量。第二个模型将苹果酸区分为胞质和线粒体形式（显式区室），为苹果酸添加一个具有有限能力的显式转运反应，并重新计算 FBA 最优解。您的程序必须计算这种区分和转运能力如何改变途径通量和区室氧化还原平衡。\n\n基本基础：\n- 稳态下的质量守恒：$S v = 0$。\n- 线性规划目标：最大化 $c^\\top v$ 作为细胞性能的代理（此处为 ATP 消耗）。\n- 交换反应是外部代谢物的源或汇，其边界代表可用性或移除速率。\n- 反应边界模拟了可逆性和能力限制。\n\n模型 A (未区分的苹果酸)：\n- 代谢物（内部和外部）：$\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, $\\mathrm{ATP}$。\n- 反应（附化学计量，每个系数的单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$）：\n    1. $\\mathrm{EX\\_glc}$：$+\\mathrm{Glc\\_ext}$，边界 $[0, G_{\\max}]$。\n    2. $\\mathrm{EX\\_o2}$：$+\\mathrm{O2\\_ext}$，边界 $[0, O_{\\max}]$。\n    3. $\\mathrm{EX\\_lac}$：$-\\mathrm{Lac\\_ext}$，边界 $[0, \\infty)$。\n    4. $\\mathrm{R1\\_Glycolysis}$：$-\\mathrm{Glc\\_ext} + 2\\,\\mathrm{Pyr\\_c} + 2\\,\\mathrm{NADH\\_c} + 2\\,\\mathrm{ATP}$，边界 $[0, \\infty)$。\n    5. $\\mathrm{R2\\_LDH}$：$-\\mathrm{Pyr\\_c} - \\mathrm{NADH\\_c} + \\mathrm{Lac\\_ext}$，边界 $[0, \\infty)$。\n    6. $\\mathrm{T\\_pyr}$：$-\\mathrm{Pyr\\_c} + \\mathrm{Pyr\\_m}$，边界 $[0, \\infty)$。\n    7. $\\mathrm{R7\\_TCA}$：$-\\mathrm{Pyr\\_m} + 4\\,\\mathrm{NADH\\_m} + 1\\,\\mathrm{ATP}$，边界 $[0, \\infty)$。\n    8. $\\mathrm{R3\\_MDH\\_c}$：$-\\mathrm{NADH\\_c} + \\mathrm{Mal}$，边界 $[0, \\infty)$。\n    9. $\\mathrm{R4\\_MDH\\_m}$：$-\\mathrm{Mal} + \\mathrm{NADH\\_m}$，边界 $[0, \\infty)$。\n    10. $\\mathrm{R5\\_ETC}$：$-\\mathrm{NADH\\_m} - 0.5\\,\\mathrm{O2\\_ext} + 2.5\\,\\mathrm{ATP}$，边界 $[0, \\infty)$。\n    11. $\\mathrm{ATP\\_drain}$：$-\\mathrm{ATP}$，边界 $[0, \\infty)$；这是要最大化的目标反应。\n\n模型 B (区分苹果酸，带转运能力)：\n- 代谢物：$\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal\\_c}$, $\\mathrm{Mal\\_m}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, $\\mathrm{ATP}$。\n- 反应：\n    1. $\\mathrm{EX\\_glc}$：$+\\mathrm{Glc\\_ext}$，边界 $[0, G_{\\max}]$。\n    2. $\\mathrm{EX\\_o2}$：$+\\mathrm{O2\\_ext}$，边界 $[0, O_{\\max}]$。\n    3. $\\mathrm{EX\\_lac}$：$-\\mathrm{Lac\\_ext}$，边界 $[0, \\infty)$。\n    4. $\\mathrm{R1\\_Glycolysis}$：$-\\mathrm{Glc\\_ext} + 2\\,\\mathrm{Pyr\\_c} + 2\\,\\mathrm{NADH\\_c} + 2\\,\\mathrm{ATP}$，边界 $[0, \\infty)$。\n    5. $\\mathrm{R2\\_LDH}$：$-\\mathrm{Pyr\\_c} - \\mathrm{NADH\\_c} + \\mathrm{Lac\\_ext}$，边界 $[0, \\infty)$。\n    6. $\\mathrm{T\\_pyr}$：$-\\mathrm{Pyr\\_c} + \\mathrm{Pyr\\_m}$，边界 $[0, \\infty)$。\n    7. $\\mathrm{R7\\_TCA}$：$-\\mathrm{Pyr\\_m} + 4\\,\\mathrm{NADH\\_m} + 1\\,\\mathrm{ATP}$，边界 $[0, \\infty)$。\n    8. $\\mathrm{R3s\\_MDH\\_c}$：$-\\mathrm{NADH\\_c} + \\mathrm{Mal\\_c}$，边界 $[0, \\infty)$。\n    9. $\\mathrm{T\\_mal}$：$-\\mathrm{Mal\\_c} + \\mathrm{Mal\\_m}$，边界 $[0, T_{\\max}]$ (单向能力)。\n    10. $\\mathrm{R4s\\_MDH\\_m}$：$-\\mathrm{Mal\\_m} + \\mathrm{NADH\\_m}$，边界 $[0, \\infty)$。\n    11. $\\mathrm{R5\\_ETC}$：$-\\mathrm{NADH\\_m} - 0.5\\,\\mathrm{O2\\_ext} + 2.5\\,\\mathrm{ATP}$，边界 $[0, \\infty)$。\n    12. $\\mathrm{ATP\\_drain}$：$-\\mathrm{ATP}$，边界 $[0, \\infty)$；要最大化的目标。\n\n目标和约束：\n- 对每个模型，在满足 $S v = 0$ 和边界约束的条件下，最大化 $\\mathrm{ATP\\_drain}$ 通量。这是一个线性规划问题，通过最小化 $-v_{\\mathrm{ATP\\_drain}}$ 来实现最大化，并带有等式约束 $S v = 0$。\n\n每个测试案例计算的量：\n- $\\Delta \\mathrm{ATP} = v_{\\mathrm{ATP\\_drain}}^{\\text{split}} - v_{\\mathrm{ATP\\_drain}}^{\\text{unsplit}}$，单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$。\n- $\\mathrm{ATP\\_unsplit}$ 和 $\\mathrm{ATP\\_split}$，单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$。\n- 区分模型下胞质乳酸脱氢酶分数：$f_{\\mathrm{LDH}}^{\\text{split}} = v_{\\mathrm{R2\\_LDH}}^{\\text{split}} / \\left(2\\, v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}}\\right)$，以 $[0,1]$ 范围内的小数表示；如果 $v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}} = 0$，则定义 $f_{\\mathrm{LDH}}^{\\text{split}} = 0$。\n- 区分模型下的电子传递链通量：$v_{\\mathrm{R5\\_ETC}}^{\\text{split}}$，单位为 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$。\n\n单位：\n- 所有通量均以 $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ 为单位报告，并以小数值表示。\n\n测试套件：\n- 案例 $1$：$(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 10, 5)$。\n- 案例 $2$：$(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 0, 5)$。\n- 案例 $3$：$(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 10, 0)$。\n- 案例 $4$：$(G_{\\max}, O_{\\max}, T_{\\max}) = (1, 10, 1000)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个列表的列表，每个测试案例对应一个内部列表，每个内部列表为 $[\\mathrm{ATP\\_unsplit}, \\mathrm{ATP\\_split}, \\Delta \\mathrm{ATP}, f_{\\mathrm{LDH}}^{\\text{split}}, v_{\\mathrm{R5\\_ETC}}^{\\text{split}}]$。外部列表必须打印为用方括号括起来的逗号分隔列表，例如 $[[x_1,x_2,x_3,x_4,x_5],[\\dots],\\dots]$。", "solution": "所给出的问题是使用流平衡分析 (FBA) 对两个简化代谢模型进行的比较研究。其目标是量化区室化和转运能力对代谢通量，特别是对三磷酸腺苷 (ATP) 生产的影响。该问题在科学上基于化学计量和稳态质量平衡的原理，在数学上是适定的，表现为一系列线性规划 (LP) 问题。所有必要的数据，包括四个独立测试案例的反应化学计量、代谢物列表和反应边界，均已提供。因此，该问题被认为是有效的，可以构建一个形式化的解。\n\n问题的核心在于为四个测试案例中的每一个，构建并求解两个不同的 LP 问题，每个模型一个（模型 A：未区分苹果酸；模型 B：区分苹果酸）。FBA 线性规划的一般形式是：\n$$\n\\begin{align*}\n\\text{maximize} \\quad  c^\\top v \\\\\n\\text{subject to} \\quad  S v = 0 \\\\\n \\ell \\le v \\le u\n\\end{align*}\n$$\n其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量，$c$ 是目标向量，$\\ell$ 和 $u$ 分别是通量的下界和上界。目标是最大化 `ATP_drain` 反应的通量，该反应代表细胞的总 ATP 生成速率。这一最大化是通过最小化 $-v_{\\mathrm{ATP\\_drain}}$ 来实现的。\n\n首先，我们定义模型 A（未区分苹果酸）。\n该模型由 $m=9$ 种代謝物和 $n=11$ 个反应组成。这些代謝物是 $\\mathrm{Glc\\_ext}$、$\\mathrm{O2\\_ext}$、$\\mathrm{Lac\\_ext}$、$\\mathrm{Mal}$、$\\mathrm{Pyr\\_c}$、$\\mathrm{Pyr\\_m}$、$\\mathrm{NADH\\_c}$、$\\mathrm{NADH\\_m}$ 和 $\\mathrm{ATP}$。反应按如下方式索引：\n$v_0$：$\\mathrm{EX\\_glc}$，$v_1$：$\\mathrm{EX\\_o2}$，$v_2$：$\\mathrm{EX\\_lac}$，$v_3$：$\\mathrm{R1\\_Glycolysis}$，$v_4$：$\\mathrm{R2\\_LDH}$，$v_5$：$\\mathrm{T\\_pyr}$，$v_6$：$\\mathrm{R7\\_TCA}$，$v_7$：$\\mathrm{R3\\_MDH\\_c}$，$v_8$：$\\mathrm{R4\\_MDH\\_m}$，$v_9$：$\\mathrm{R5\\_ETC}$，$v_{10}$：$\\mathrm{ATP\\_drain}$。\n\n$9 \\times 11$ 的化学计量矩阵 $S_A$ 是根据反应定义构建的。行对应代谢物，列对应反应。\n$$\nS_A = \\begin{pmatrix}\n 1   0   0   -1   0   0   0   0   0   0   0 \\\\\n 0   1   0   0   0   0   0   0   0   -0.5   0 \\\\\n 0   0   -1   0   1   0   0   0   0   0   0 \\\\\n 0   0   0   0   0   0   0   1   -1   0   0 \\\\\n 0   0   0   2   -1   -1   0   0   0   0   0 \\\\\n 0   0   0   0   0   1   -1   0   0   0   0 \\\\\n 0   0   0   2   -1   0   0   -1   0   0   0 \\\\\n 0   0   0   0   0   0   4   0   1   -1   0 \\\\\n 0   0   0   2   0   0   1   0   0   2.5   -1\n\\end{pmatrix}\n$$\n对于所有反应 $i$，通量下界均为 $\\ell_i = 0$。除了 $v_0$ ($\\mathrm{EX\\_glc}$) 和 $v_1$ ($\\mathrm{EX\\_o2}$) 外，所有反应的上界 $u_i$ 均为无穷大，这两个反应分别受 $u_0 = G_{\\max}$ 和 $u_1 = O_{\\max}$ 的约束。目标向量 $c_A$ 是一个在对应于 $v_{10}$ ($\\mathrm{ATP\\_drain}$) 的位置为1，其余位置为0的向量。\n\n接下来，我们定义模型 B（带转运能力的区分苹果酸）。\n该模型更为详细，包含 $m=10$ 种代谢物和 $n=12$ 个反应。苹果酸被区分为胞质 ($\\mathrm{Mal\\_c}$) 和线粒体 ($\\mathrm{Mal\\_m}$) 池，并引入了一个显式转运反应 $\\mathrm{T\\_mal}$。反应索引如下：\n$v_0$：$\\mathrm{EX\\_glc}$，$v_1$：$\\mathrm{EX\\_o2}$，$v_2$：$\\mathrm{EX\\_lac}$，$v_3$：$\\mathrm{R1\\_Glycolysis}$，$v_4$：$\\mathrm{R2\\_LDH}$，$v_5$：$\\mathrm{T\\_pyr}$，$v_6$：$\\mathrm{R7\\_TCA}$，$v_7$：$\\mathrm{R3s\\_MDH\\_c}$，$v_8$：$\\mathrm{T\\_mal}$，$v_9$：$\\mathrm{R4s\\_MDH\\_m}$，$v_{10}$：$\\mathrm{R5\\_ETC}$，$v_{11}$：$\\mathrm{ATP\\_drain}$。\n\n$10 \\times 12$ 的化学计量矩阵 $S_B$ 是：\n$$\nS_B = \\begin{pmatrix}\n 1   0   0   -1   0   0   0   0   0   0   0   0 \\\\\n 0   1   0   0   0   0   0   0   0   0   -0.5   0 \\\\\n 0   0   -1   0   1   0   0   0   0   0   0   0 \\\\\n 0   0   0   0   0   0   0   1   -1   0   0   0 \\\\\n 0   0   0   0   0   0   0   0   1   -1   0   0 \\\\\n 0   0   0   2   -1   -1   0   0   0   0   0   0 \\\\\n 0   0   0   0   0   1   -1   0   0   0   0   0 \\\\\n 0   0   0   2   -1   0   0   -1   0   0   0   0 \\\\\n 0   0   0   0   0   0   4   0   0   1   -1   0 \\\\\n 0   0   0   2   0   0   1   0   0   0   2.5   -1\n\\end{pmatrix}\n$$\n通量下界再次对所有反应均为 $\\ell_i=0$。除了 $u_0 = G_{\\max}$、$u_1 = O_{\\max}$ 和 $u_8 = T_{\\max}$（用于 $\\mathrm{T\\_mal}$ 转运蛋白）外，所有上界 $u_i$ 均为无穷大。目标向量 $c_B$ 是一个在 $v_{11}$ ($\\mathrm{ATP\\_drain}$) 位置为1，其余位置为0的向量。\n\n对于由元组 $(G_{\\max}, O_{\\max}, T_{\\max})$ 定义的四个测试案例中的每一个，执行以下步骤：\n1. 使用相应的 $G_{\\max}$ 和 $O_{\\max}$ 值求解模型 A 的 LP 问题，以获得最优通量向量 $v^{\\text{unsplit}}$。最优目标值给出 $\\mathrm{ATP\\_unsplit} = v_{\\mathrm{ATP\\_drain}}^{\\text{unsplit}}$。\n2. 使用相应的 $G_{\\max}$、$O_{\\max}$ 和 $T_{\\max}$ 值求解模型 B 的 LP 问题，以获得最优通量向量 $v^{\\text{split}}$。\n3. 从解向量中计算出以下量：\n   - $\\mathrm{ATP\\_split} = v_{\\mathrm{ATP\\_drain}}^{\\text{split}}$ (来自 $v^{\\text{split}}$ 的索引 11)。\n   - $\\Delta \\mathrm{ATP} = \\mathrm{ATP\\_split} - \\mathrm{ATP\\_unsplit}$。\n   - $v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}}$ (来自 $v^{\\text{split}}$ 的索引 3) 和 $v_{\\mathrm{R2\\_LDH}}^{\\text{split}}$ (来自 $v^{\\text{split}}$ 的索引 4) 用于计算胞质乳酸脱氢酶分数，$f_{\\mathrm{LDH}}^{\\text{split}} = v_{\\mathrm{R2\\_LDH}}^{\\text{split}} / (2 \\cdot v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}})$，如果分母为0，则定义为0。\n   - $v_{\\mathrm{R5\\_ETC}}^{\\text{split}}$ 从 $v^{\\text{split}}$ 的索引 10 中提取。\n4. 为每个测试案例收集五个计算值 $[\\mathrm{ATP\\_unsplit}, \\mathrm{ATP\\_split}, \\Delta \\mathrm{ATP}, f_{\\mathrm{LDH}}^{\\text{split}}, v_{\\mathrm{R5\\_ETC}}^{\\text{split}}]$。\n\n该过程以编程方式实现，利用 `scipy.optimize.linprog` 求解线性规划问题。最终输出是所有四个测试案例结果的聚合，格式化为列表的列表。\n```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Constructs and solves two Flux Balance Analysis (FBA) problems,\n    Model A (unsplit malate) and Model B (split malate), for four\n    different test cases to analyze the effect of compartmentalization\n    and transport capacity on metabolic fluxes.\n    \"\"\"\n\n    test_cases = [\n        # (G_max, O_max, T_max)\n        (10, 10, 5),\n        (10, 0, 5),\n        (10, 10, 0),\n        (1, 10, 1000),\n    ]\n\n    # --- Model A: Unsplit Malate ---\n    # Metabolites (9): Glc_ext, O2_ext, Lac_ext, Mal, Pyr_c, Pyr_m, NADH_c, NADH_m, ATP\n    # Reactions (11): EX_glc, EX_o2, EX_lac, R1, R2, T_pyr, R7, R3, R4, R5, ATP_drain\n    S_A = np.array([\n        # EXg, EXo, EXl,  R1,  R2, T pyr, R7, R3,  R4,   R5,   AD\n        [1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Glc_ext\n        [0.0, 1.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0, 0.0, -0.5, 0.0], # O2_ext\n        [0.0, 0.0, -1.0, 0.0, 1.0,  0.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Lac_ext\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 1.0, -1.0, 0.0, 0.0], # Mal\n        [0.0, 0.0, 0.0,  2.0, -1.0, -1.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Pyr_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  1.0, -1.0, 0.0, 0.0,  0.0, 0.0], # Pyr_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0], # NADH_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 4.0, 0.0,  1.0, -1.0, 0.0], # NADH_m\n        [0.0, 0.0, 0.0,  2.0, 0.0,  0.0, 1.0, 0.0,  0.0,  2.5, -1.0] # ATP\n    ])\n    num_fluxes_A = S_A.shape[1]\n    c_A = np.zeros(num_fluxes_A)\n    c_A[10] = -1.0  # Maximize ATP_drain (index 10) by minimizing its negative\n    b_eq_A = np.zeros(S_A.shape[0])\n\n    # --- Model B: Split Malate ---\n    # Metabolites (10): Glc_ext, O2_ext, Lac_ext, Mal_c, Mal_m, Pyr_c, Pyr_m, NADH_c, NADH_m, ATP\n    # Reactions (12): EX_glc, EX_o2, EX_lac, R1, R2, T_pyr, R7, R3s, T_mal, R4s, R5, ATP_drain\n    S_B = np.array([\n        # EXg, EXo, EXl,  R1,  R2, T pyr, R7, R3s,T mal, R4s,   R5,   AD\n        [1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Glc_ext\n        [0.0, 1.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0, 0.0, 0.0, -0.5,  0.0], # O2_ext\n        [0.0, 0.0, -1.0, 0.0, 1.0,  0.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Lac_ext\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 1.0, -1.0, 0.0,  0.0,  0.0], # Mal_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0,  1.0, -1.0, 0.0,  0.0], # Mal_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, -1.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Pyr_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  1.0, -1.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Pyr_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0,  0.0,  0.0], # NADH_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 4.0, 0.0,  0.0, 1.0, -1.0,  0.0], # NADH_m\n        [0.0, 0.0, 0.0,  2.0, 0.0,  0.0, 1.0, 0.0,  0.0, 0.0,  2.5, -1.0] # ATP\n    ])\n    num_fluxes_B = S_B.shape[1]\n    c_B = np.zeros(num_fluxes_B)\n    c_B[11] = -1.0  # Maximize ATP_drain (index 11)\n    b_eq_B = np.zeros(S_B.shape[0])\n\n    results = []\n    \n    TOL = 1e-9 # Tolerance for floating point comparisons\n\n    for G_max, O_max, T_max in test_cases:\n        # Solve for Model A\n        bounds_A = [(0, None)] * num_fluxes_A\n        bounds_A[0] = (0, G_max)  # EX_glc\n        bounds_A[1] = (0, O_max)  # EX_o2\n        res_A = linprog(c=c_A, A_eq=S_A, b_eq=b_eq_A, bounds=bounds_A, method='highs')\n        \n        fluxes_A = res_A.x if res_A.success else np.zeros(num_fluxes_A)\n        atp_unsplit = fluxes_A[10] if fluxes_A[10]  TOL else 0.0\n\n        # Solve for Model B\n        bounds_B = [(0, None)] * num_fluxes_B\n        bounds_B[0] = (0, G_max)  # EX_glc\n        bounds_B[1] = (0, O_max)  # EX_o2\n        bounds_B[8] = (0, T_max)  # T_mal\n        res_B = linprog(c=c_B, A_eq=S_B, b_eq=b_eq_B, bounds=bounds_B, method='highs')\n\n        fluxes_B = res_B.x if res_B.success else np.zeros(num_fluxes_B)\n\n        # Calculate required quantities\n        atp_split = fluxes_B[11] if fluxes_B[11]  TOL else 0.0\n        delta_atp = atp_split - atp_unsplit\n        \n        v_r1_split = fluxes_B[3] # R1_Glycolysis\n        v_r2_split = fluxes_B[4] # R2_LDH\n        \n        denominator = 2 * v_r1_split\n        if denominator  TOL:\n            f_ldh_split = v_r2_split / denominator\n        else:\n            f_ldh_split = 0.0\n            \n        v_r5_etc_split = fluxes_B[10] if fluxes_B[10]  TOL else 0.0\n        \n        # Collect and format results\n        case_results = [\n            round(atp_unsplit, 5),\n            round(atp_split, 5),\n            round(delta_atp, 5),\n            round(f_ldh_split, 5),\n            round(v_r5_etc_split, 5)\n        ]\n        results.append(case_results)\n\n    # Format final output string\n    inner_results_str = [f\"[{','.join(map(str, res))}]\" for res in results]\n    print(f\"[{','.join(inner_results_str)}]\")\n\n# solve()\n```", "answer": "[[140.0,132.5,-7.5,0.0,50.0],[20.0,20.0,0.0,1.0,0.0],[140.0,125.0,-15.0,0.0,50.0],[14.0,14.0,0.0,0.0,5.0]]", "id": "4383433"}]}