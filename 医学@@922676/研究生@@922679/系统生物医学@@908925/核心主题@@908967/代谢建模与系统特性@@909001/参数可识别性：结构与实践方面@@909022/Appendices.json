{"hands_on_practices": [{"introduction": "本练习使用一个基础的指数增长模型，从根源上探讨结构不可辨识性的一个核心原因：模型对称性。通过该练习，您将学习到不同的参数组合如何能够产生完全相同的模型输出，并推导出数据真正能够确定的可辨识参数组合。这项实践将抽象的对称性概念与费雪信息矩阵（Fisher Information Matrix）的具体性质（如秩亏）联系起来。[@problem_id:4372101]", "problem": "考虑一个生物化学信号基序中的单状态线性系统，其中可测量物种 $x(t)$ 服从常微分方程 $\\dot{x}(t)=\\alpha \\beta x(t)$，输出为 $y(t)=x(t)$。初始条件 $x(0)=x_{0}>0$ 已知，参数 $\\alpha>0$ 和 $\\beta>0$ 未知。假设在有限时间窗口 $t\\in[0,T]$ 内，可在两种情况下获得连续时间测量值 $y(t)$：(i) 理想的无噪声观测；(ii) 附加测量噪声，建模为均值为零、方差为常数 $\\sigma^{2}>0$ 且与 $t$ 无关的高斯噪声。\n\n使用基本定义：结构可辨识性意味着对于所有容许的输入和初始条件，不同的参数值会产生不同的输出；而参数化模型的对称性是一种使输入-输出行为保持不变的参数变换。在小噪声极限下，可以通过费雪信息矩阵（FIM）评估实际可辨识性，该矩阵量化了似然函数的局部曲率，并通过克拉默-拉奥下界与估计量的方差相关联。\n\n任务：\n- 从基本定义出发，证明参数化模型在 $(\\alpha,\\beta)$ 中存在一个非平凡的单参数缩放对称性，该对称性使 $y(t)$ 对所有 $t$ 保持不变。推导此对称性的无穷小生成元，作为参数流形上的向量场。\n- 利用此对称性的不变量，确定在无噪声观测下 $(\\alpha,\\beta)$ 的结构可辨识组合，并得出结论：$(\\alpha,\\beta)$ 的哪些函数是结构可辨识的。\n- 通过引入单一参数 $\\phi=\\alpha\\beta$ 构建一个可辨识的重新参数化模型，并用 $\\phi$ 写出所得模型。\n- 在高斯噪声情况下，写出在 $[0,T]$ 上连续时间观测的对数似然函数，并推导 $(\\alpha,\\beta)$ 的费雪信息矩阵以及可辨識参数 $\\phi$ 的费雪信息标量。证明 $(\\alpha,\\beta)$ 的费雪信息矩阵是秩亏的（反映了不可辨识性），而 $\\phi$ 的费雪信息是正的。\n- 作为最终计算答案，提供重新参数化后的输出 $y(t)$ 关于可辨识参数 $\\phi$、初始条件 $x_{0}$ 和时间 $t$ 的显式表达式。您的最终答案必须是单一的闭式解析表达式，不带单位。无需四舍五入。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   **模型方程**: $\\dot{x}(t)=\\alpha \\beta x(t)$\n-   **输出方程**: $y(t)=x(t)$\n-   **初始条件**: $x(0)=x_{0}>0$，已知。\n-   **参数**: $\\alpha>0$, $\\beta>0$，未知。\n-   **观测区间**: $t \\in [0,T]$。\n-   **观测情况**:\n    -   (i) 理想的无噪声观测。\n    -   (ii) 附加的均值为零、方差为常数 $\\sigma^{2}>0$ 的高斯测量噪声。\n-   **定义**: 结构可辨识性、模型对称性、通过费雪信息矩阵（FIM）评估的实际可辨识性。\n-   **任务**:\n    1.  推导单参数缩放对称性及其无穷小生成元。\n    2.  利用对称性不变量确定结构可辨識组合。\n    3.  使用 $\\phi=\\alpha\\beta$ 构建可辨识的重新参数化。\n    4.  推导 $(\\alpha,\\beta)$ 和 $\\phi$ 的FIM，并分析其秩/正定性。\n    5.  提供重新参数化后输出 $y(t)$ 的最终表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于标准的线性常微分方程，这是动态系统建模的基本工具。结构可辨识性、实际可辨识性、对称性分析和费雪信息矩阵等概念是系统理论和参数估计中的基石性原理，尤其是在系统生物医学领域。该问题牢固地植根于成熟的数学和统计理论。\n-   **适定性**：问题定义明确。该常微分方程的初值问题有唯一解。每个任务都是基于所给模型和定义的一个具体的、可回答的问题。\n-   **客观性**：问题使用精确的数学语言陈述，没有主观或模糊的术语。\n-   **完整性与一致性**：问题是自洽的，提供了进行所需分析的所有必要方程、条件和概念定义。内部没有矛盾。\n-   **现实性与可行性**：虽然模型是一种简化，但它代表了可辨识性分析的一个有效理论框架。其中的假设（例如，连续时间观测、已知初始条件）是理论研究中的标准理想化处理。\n-   **结构与平凡性**：问题结构良好，引导分析从结构可辨識性（无噪声）过渡到实际可辨识性（有噪声）。它正确地将模型对称性的抽象概念与参数估计的实际意义联系起来，这一点反映在FIM中。这是一个说明基本概念的非平凡的教学问题。\n\n### 步骤3：结论与行动\n该问题是有效的。它具有科学合理性、适定性和完整性。我将继续进行详细求解。\n\n### 求解推导\n\n该系统由以下线性一阶常微分方程（ODE）描述：\n$$\n\\frac{dx}{dt} = (\\alpha\\beta) x(t)\n$$\n初始条件为 $x(0) = x_0$。这是一个可分离的ODE，其解可通过积分求得：\n$$\n\\int_{x_0}^{x(t)} \\frac{dx}{x} = \\int_0^t \\alpha\\beta \\,d\\tau\n$$\n$$\n\\ln(x(t)) - \\ln(x_0) = \\alpha\\beta t\n$$\n$$\nx(t) = x_0 \\exp(\\alpha\\beta t)\n$$\n系统输出为 $y(t) = x(t)$，因此输入-输出关系由下式给出：\n$$\ny(t) = y(\\alpha, \\beta; t) = x_0 \\exp(\\alpha\\beta t)\n$$\n\n**任务1：对称性分析**\n\n模型的对称性是一种参数变换 $(\\alpha, \\beta) \\to (\\tilde{\\alpha}, \\tilde{\\beta})$，该变换使得输出 $y(t)$ 对所有 $t \\in [0,T]$ 保持不变。\n$$\ny(\\tilde{\\alpha}, \\tilde{\\beta}; t) = y(\\alpha, \\beta; t)\n$$\n$$\nx_0 \\exp(\\tilde{\\alpha}\\tilde{\\beta} t) = x_0 \\exp(\\alpha\\beta t)\n$$\n由于 $x_0 > 0$ 且该等式必须对所有 $t$ 成立，我们必须有 $\\tilde{\\alpha}\\tilde{\\beta} = \\alpha\\beta$。这个方程定义了对称性。我们可以定义一个由标量 $c>0$ 索引的单参数变换族为：\n$$\n\\tilde{\\alpha}(c) = c \\alpha\n$$\n$$\n\\tilde{\\beta}(c) = \\frac{1}{c} \\beta\n$$\n这个变换将参数空间中的点 $(\\alpha, \\beta)$沿着一条双曲线映射，对于任何 $c$，其乘积保持不变：$\\tilde{\\alpha}\\tilde{\\beta} = (c\\alpha)(\\frac{1}{c}\\beta) = \\alpha\\beta$。这是一个非平凡的缩放对称性。\n\n为了找到此对称性的无穷小生成元，我们考虑单位元附近的变换，这对应于 $c \\approx 1$。设 $c = \\exp(\\epsilon)$，其中 $\\epsilon$ 是一个无穷小量。\n$$\n\\tilde{\\alpha} = \\alpha \\exp(\\epsilon) \\approx \\alpha(1 + \\epsilon) = \\alpha + \\epsilon\\alpha\n$$\n$$\n\\tilde{\\beta} = \\beta \\exp(-\\epsilon) \\approx \\beta(1 - \\epsilon) = \\beta - \\epsilon\\beta\n$$\n参数的无穷小变化为 $(\\delta\\alpha, \\delta\\beta) = (\\tilde{\\alpha}-\\alpha, \\tilde{\\beta}-\\beta) = (\\epsilon\\alpha, -\\epsilon\\beta)$。无穷小生成元是参数流形上的向量场 $V$，定义为 $V = (\\frac{\\delta\\alpha}{\\epsilon}, \\frac{\\delta\\beta}{\\epsilon})$。\n$$\nV = (\\alpha, -\\beta)\n$$\n用微分算子形式表示，该向量场为 $V = \\alpha \\frac{\\partial}{\\partial \\alpha} - \\beta \\frac{\\partial}{\\partial \\beta}$。\n\n**任务2：结构可辨识组合**\n\n参数的结构可辨识组合是对称群的不变量。如果一个函数 $f(\\alpha, \\beta)$ 沿着由 $V$ 生成的流是常数，那么它就是不变量。这等价于 $f$ 关于 $V$ 的李导数为零：\n$$\nL_V f = V(f) = \\alpha \\frac{\\partial f}{\\partial \\alpha} - \\beta \\frac{\\partial f}{\\partial \\beta} = 0\n$$\n这是一个一阶偏微分方程。特征线法给出特征方程：\n$$\n\\frac{d\\alpha}{\\alpha} = \\frac{d\\beta}{-\\beta}\n$$\n对两边积分得到 $\\ln|\\alpha| = -\\ln|\\beta| + K$，其中 $K$ 是某个常数。由于 $\\alpha>0$ 和 $\\beta>0$，这可简化为 $\\ln(\\alpha) + \\ln(\\beta) = K$，或 $\\ln(\\alpha\\beta) = K$。这意味着 $\\alpha\\beta$ 沿着特征曲线（$V$ 的流）是常数。因此，乘积 $\\alpha\\beta$ 的任何函数都是该对称性的不变量。基本不变量是乘积 $\\phi = \\alpha\\beta$。\n由于输出 $y(t)$ 仅依赖于这个不变量组合，因此无法区分共享相同乘积的不同参数对 $(\\alpha, \\beta)$。因此，只有 $\\alpha\\beta$ 的函数（记为 $g(\\alpha\\beta)$）是结构可辨识的。参数 $\\alpha$ 和 $\\beta$ 本身不是单独可辨識的。\n\n**任务3：可辨識的重新参数化**\n\n基于对称性分析，可辨識的参数是 $\\phi = \\alpha\\beta$。我们可以仅使用这个新参数来重新参数化模型。\n原始ODE为 $\\dot{x}(t) = (\\alpha\\beta) x(t)$。代入 $\\phi = \\alpha\\beta$，我们得到重新参数化后的模型：\n$$\n\\dot{x}(t) = \\phi x(t)\n$$\n其输出为 $y(t) = x(t)$，初始条件为 $x(0) = x_0$。这是一个只有一个参数 $\\phi > 0$ 的新模型。该模型是结构可辨识的，因为不同的 $\\phi$ 值将生成不同的输出轨迹 $y(t) = x_0 \\exp(\\phi t)$。\n\n**任务4：费雪信息矩阵（FIM）分析**\n\n在附加高斯噪声的情况下，观测数据为 $y_{obs}(t) = y(t) + \\epsilon(t)$，其中 $\\epsilon(t)$ 是连续时间白噪声。对数似然泛函正比于：\n$$\nL(\\boldsymbol{\\theta}) \\propto -\\frac{1}{2\\sigma^2} \\int_0^T [y_{obs}(t) - y(t; \\boldsymbol{\\theta})]^2 dt\n$$\n参数矢量 $\\boldsymbol{\\theta}$ 的费雪信息矩阵由下式给出：\n$$\nF_{ij} = \\frac{1}{\\sigma^2} \\int_0^T \\left( \\frac{\\partial y(t; \\boldsymbol{\\theta})}{\\partial \\theta_i} \\right) \\left( \\frac{\\partial y(t; \\boldsymbol{\\theta})}{\\partial \\theta_j} \\right) dt\n$$\n首先，对于不可辨识的参数化 $\\boldsymbol{\\theta} = (\\alpha, \\beta)$，其中 $y(t) = x_0 \\exp(\\alpha\\beta t)$：\n偏导数（灵敏度）为：\n$$\n\\frac{\\partial y}{\\partial \\alpha} = x_0 (\\beta t) \\exp(\\alpha\\beta t)\n$$\n$$\n\\frac{\\partial y}{\\partial \\beta} = x_0 (\\alpha t) \\exp(\\alpha\\beta t)\n$$\nFIM 的分量 $F_{(\\alpha,\\beta)}$ 为：\n$$\nF_{\\alpha\\alpha} = \\frac{1}{\\sigma^2} \\int_0^T [x_0 \\beta t \\exp(\\alpha\\beta t)]^2 dt = \\frac{x_0^2 \\beta^2}{\\sigma^2} \\int_0^T t^2 \\exp(2\\alpha\\beta t) dt\n$$\n$$\nF_{\\beta\\beta} = \\frac{1}{\\sigma^2} \\int_0^T [x_0 \\alpha t \\exp(\\alpha\\beta t)]^2 dt = \\frac{x_0^2 \\alpha^2}{\\sigma^2} \\int_0^T t^2 \\exp(2\\alpha\\beta t) dt\n$$\n$$\nF_{\\alpha\\beta} = F_{\\beta\\alpha} = \\frac{1}{\\sigma^2} \\int_0^T [x_0 \\beta t \\exp(\\alpha\\beta t)][x_0 \\alpha t \\exp(\\alpha\\beta t)] dt = \\frac{x_0^2 \\alpha\\beta}{\\sigma^2} \\int_0^T t^2 \\exp(2\\alpha\\beta t) dt\n$$\n设 $I = \\int_0^T t^2 \\exp(2\\alpha\\beta t) dt$。由于当 $T>0$ 时，被积函数非负且不恒为零，我们有 $I>0$。FIM 为：\n$$\nF_{(\\alpha,\\beta)} = \\frac{x_0^2 I}{\\sigma^2} \\begin{pmatrix} \\beta^2  & \\alpha\\beta \\\\ \\alpha\\beta  & \\alpha^2 \\end{pmatrix}\n$$\n该矩阵的行列式为：\n$$\n\\det(F_{(\\alpha,\\beta)}) = \\left(\\frac{x_0^2 I}{\\sigma^2}\\right)^2 (\\beta^2 \\alpha^2 - (\\alpha\\beta)(\\alpha\\beta)) = 0\n$$\n由于 $\\det(F_{(\\alpha,\\beta)}) = 0$，该矩阵是奇异的（秩亏的）。这证实了参数 $(\\alpha, \\beta)$ 不是实际可辨识的，因为任何无偏估计量方差的克拉默-拉奥下界都将是无穷大。该矩阵的零空间由向量 $(\\alpha, -\\beta)^T$ 生成，这对应于对称性的无穷小生成元，从而证实了结构不可辨识性（对称性）和实际不可辨识性（奇异FIM）之间的联系。\n\n接下来，对于可辨识的参数化，参数为 $\\phi = \\alpha\\beta$，其中 $y(t) = x_0 \\exp(\\phi t)$：\n灵敏度为：\n$$\n\\frac{\\partial y}{\\partial \\phi} = x_0 t \\exp(\\phi t)\n$$\nFIM 是一个 $1 \\times 1$ 矩阵（一个标量），$F_{\\phi}$：\n$$\nF_{\\phi} = \\frac{1}{\\sigma^2} \\int_0^T \\left(\\frac{\\partial y}{\\partial \\phi}\\right)^2 dt = \\frac{x_0^2}{\\sigma^2} \\int_0^T [t \\exp(\\phi t)]^2 dt = \\frac{x_0^2}{\\sigma^2} \\int_0^T t^2 \\exp(2\\phi t) dt\n$$\n由于 $x_0^2 > 0$, $\\sigma^2 > 0$，并且当 $T>0$ 和 $\\phi>0$时，积分 $\\int_0^T t^2 \\exp(2\\phi t) dt$ 严格为正，我们有 $F_{\\phi} > 0$。一个正的（非奇异的）FIM 表明参数 $\\phi$ 是实际可辨識的。\n\n**任务5：最终计算答案**\n\n最后一个任务是提供重新参数化后的输出 $y(t)$ 关于可辨识参数 $\\phi$、初始条件 $x_0$ 和时间 $t$ 的显式表达式。通过求解重新参数化后的ODE $\\dot{x}(t) = \\phi x(t)$（其中 $x(0)=x_0$ 且 $y(t)=x(t)$）推导得出，该表达式为：\n$$\ny(t) = x_0 \\exp(\\phi t)\n$$\n这就是所要求的最终答案。", "answer": "$$\n\\boxed{x_{0} \\exp(\\phi t)}\n$$", "id": "4372101"}, {"introduction": "在理解了参数可辨识性的概念之后，下一个关键问题是如何在存在噪声的真实数据中，量化我们对参数估计值的信心。本练习将通过一个简单的衰减模型，指导您构建剖面似然函数（profile likelihood），并用它来计算估计参数的置信区间。这是评估参数实用可辨识性（practical identifiability）的一项基石技术。[@problem_id:4372099]", "problem": "考虑一个系统生物医学中的简单生物标志物衰变实验，其中分子读数被建模为带有加性高斯噪声的单参数指数衰减轨迹：无噪声轨迹为 $y(t)=\\theta \\exp(-t)$，测量数据满足 $y_{i}=y(t_{i})+\\varepsilon_{i}$，其中 $\\varepsilon_{i}\\sim\\mathcal{N}(0,\\sigma^{2})$ 独立同分布。振幅参数 $\\theta$ 未知，噪声标准差 $\\sigma$ 已知。给定在时间 $t_{1}=0$, $t_{2}=1$, $t_{3}=2$, $t_{4}=3$, $t_{5}=4$ 的 $n=5$ 次测量，观测值分别为 $y_{1}=2.45$, $y_{2}=0.95$, $y_{3}=0.31$, $y_{4}=0.12$, $y_{5}=0.06$，已知 $\\sigma=0.05$。测量是无量纲的。\n\n从高斯似然定义和模型的参数线性结构出发，完成以下任务：\n\n- 仅使用基本模型属性和定义，确定 $\\theta$ 是否可以从 $t\\geq 0$ 上 $y(t)$ 的无噪声观测中被结构可辨识。\n- 构建 $\\theta$ 的剖面似然 $L_{p}(\\theta)$（在这种单参数且 $\\sigma$ 已知的情况下，它与全似然一致），在相差一个乘法常数的情况下，并将其对应的负二倍对数似然写成 $\\theta$ 和数据的函数。\n- 使用单参数的似然比框架，通过阈值 $\\Delta\\chi^{2}=1$ 从剖面似然中推导出 $\\theta$ 的近似置信区间（即，负二倍对数似然相对于其最小值的增量不超过 $1$ 的 $\\theta$ 值集合）。\n- 对给定数据，数值计算此置信区间。将每个端点四舍五入到四位有效数字。用与 $y$ 相同的（无量纲）单位表示该区间。", "solution": "首先将验证问题陈述的科学合理性、完整性和客观性。\n\n### 步骤1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n-   无噪声轨迹模型：$y(t)=\\theta \\exp(-t)$\n-   测量模型：$y_{i}=y(t_{i})+\\varepsilon_{i}$\n-   噪声分布：$\\varepsilon_{i}\\sim\\mathcal{N}(0,\\sigma^{2})$，独立同分布\n-   未知参数：$\\theta$\n-   已知噪声标准差：$\\sigma=0.05$\n-   测量次数：$n=5$\n-   测量时间：$t_{1}=0$, $t_{2}=1$, $t_{3}=2$, $t_{4}=3$, $t_{5}=4$\n-   观测值：$y_{1}=2.45$, $y_{2}=0.95$, $y_{3}=0.31$, $y_{4}=0.12$, $y_{5}=0.06$\n-   单位：测量是无量纲的。\n-   置信区间阈值：$\\Delta\\chi^{2}=1$\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题进行验证。\n-   **科学依据：** 该问题基于基本原理。指数衰减是科学和工程中无处不在的模型。加性、独立同分布的高斯噪声的假设是统计数据建模和参数估计中的标准且成熟的程序。\n-   **适定性：** 问题明确。它要求确定结构可辨识性，并使用标准统计方法（似然比框架）计算单个参数的置信区间。所提供的数据足以得到唯一解。\n-   **客观性：** 问题使用精确、定量和无偏见的语言陈述。\n\n该问题没有表现出科学上不合理、不完整、矛盾或模棱两可等任何缺陷。这是一个与系统生物医学相关的参数估计中的标准、适定的问题。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将推导完整的解答。\n\n### 解答推导\n\n根据问题陈述的要求，解答分为四个部分呈现。\n\n首先，确定参数 $\\theta$ 的结构可辨识性。结构可辨识性关注在给定模型结构下参数的唯一性，假设在连续时间域上有完美的、无噪声的观测。为检查 $\\theta$ 是否是结构可辨识的，我们假设两个参数值 $\\theta_{1}$ 和 $\\theta_{2}$ 在所有时间 $t \\ge 0$ 产生相同的模型输出。\n$$\ny(t; \\theta_{1}) = y(t; \\theta_{2})\n$$\n$$\n\\theta_{1} \\exp(-t) = \\theta_{2} \\exp(-t)\n$$\n由于函数 $\\exp(-t)$ 对于 $t \\ge 0$ 并非恒等于零，我们可以将等式两边同除以 $\\exp(-t)$，得到：\n$$\n\\theta_{1} = \\theta_{2}\n$$\n这表明不可能找到两个不同的 $\\theta$ 值产生相同的无噪声轨迹。因此，参数 $\\theta$ 是结构可辨识的。\n\n第二，我们构建似然函数。测量值 $y_i$ 是独立的，每个都从均值为 $\\theta \\exp(-t_i)$ 且已知方差为 $\\sigma^2$ 的高斯分布中抽取。给定 $\\theta$，单个测量值 $y_i$ 的概率密度函数为：\n$$\np(y_i|\\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - \\theta \\exp(-t_i))^2}{2\\sigma^2}\\right)\n$$\n似然函数 $L(\\theta)$ 是观测到整个数据集 $\\{y_i\\}_{i=1}^n$ 的概率的乘积：\n$$\nL(\\theta) = \\prod_{i=1}^{n} p(y_i|\\theta) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\theta \\exp(-t_i))^2\\right)\n$$\n由于问题涉及单个未知参数 $\\theta$ 且 $\\sigma$ 已知，剖面似然 $L_p(\\theta)$ 与全似然 $L(\\theta)$ 相同。在相差一个乘法常数的情况下，剖面似然为：\n$$\nL_p(\\theta) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\theta \\exp(-t_i))^2\\right)\n$$\n相应的负二倍对数似然函数，我们记为 $\\chi^2(\\theta)$，从 $L(\\theta)$ 推导得出：\n$$\n\\ln L(\\theta) = -\\frac{n}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\theta \\exp(-t_i))^2\n$$\n$$\n\\chi^2(\\theta) = -2\\ln L(\\theta) = n\\ln(2\\pi\\sigma^2) + \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (y_i - \\theta \\exp(-t_i))^2\n$$\n按照惯例，项 $\\chi^2(\\theta)$ 通常指平方和部分，它与省略了常数项的负对数似然成正比。作为 $\\theta$ 和数据的函数的表达式为：\n$$\n\\chi^2(\\theta) = \\sum_{i=1}^{n} \\frac{(y_i - \\theta \\exp(-t_i))^2}{\\sigma^2}\n$$\n\n第三，我们推导置信区间。置信区间由满足条件 $\\chi^2(\\theta) \\leq \\chi^2_{\\text{min}} + \\Delta\\chi^2$ 的 $\\theta$ 值集合找到，其中 $\\chi^2_{\\text{min}}$ 是 $\\chi^2(\\theta)$ 的最小值，$\\Delta\\chi^{2}=1$ 是指定的阈值。最小值出现在 $\\theta$ 的最大似然估计（MLE）处，记为 $\\hat{\\theta}$。为了找到 $\\hat{\\theta}$，我们通过将其关于 $\\theta$ 的导数设为零来最小化 $\\chi^2(\\theta)$。令 $x_i = \\exp(-t_i)$。\n$$\n\\frac{d\\chi^2(\\theta)}{d\\theta} = \\frac{d}{d\\theta} \\left[\\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (y_i - \\theta x_i)^2\\right] = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} 2(y_i - \\theta x_i)(-x_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} (y_i x_i - \\theta x_i^2) = 0 \\implies \\sum_{i=1}^{n} y_i x_i = \\theta \\sum_{i=1}^{n} x_i^2\n$$\n求解 $\\hat{\\theta}$：\n$$\n\\hat{\\theta} = \\frac{\\sum_{i=1}^{n} y_i x_i}{\\sum_{i=1}^{n} x_i^2}\n$$\n置信区间由不等式 $\\chi^2(\\theta) - \\chi^2(\\hat{\\theta}) \\leq 1$ 定义。\n$$\n\\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (y_i - \\theta x_i)^2 - \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (y_i - \\hat{\\theta} x_i)^2 \\leq 1\n$$\n展开求和式：\n$$\n(\\sum y_i^2 - 2\\theta \\sum y_i x_i + \\theta^2 \\sum x_i^2) - (\\sum y_i^2 - 2\\hat{\\theta} \\sum y_i x_i + \\hat{\\theta}^2 \\sum x_i^2) \\leq \\sigma^2\n$$\n使用 $\\hat{\\theta} = (\\sum y_i x_i) / (\\sum x_i^2)$：\n$$\n-2\\theta (\\hat{\\theta} \\sum x_i^2) + \\theta^2 \\sum x_i^2 + 2\\hat{\\theta} (\\hat{\\theta} \\sum x_i^2) - \\hat{\\theta}^2 \\sum x_i^2 \\leq \\sigma^2\n$$\n$$\n\\theta^2 \\sum x_i^2 - 2\\theta\\hat{\\theta} \\sum x_i^2 + \\hat{\\theta}^2 \\sum x_i^2 \\leq \\sigma^2\n$$\n$$\n(\\sum x_i^2) (\\theta^2 - 2\\theta\\hat{\\theta} + \\hat{\\theta}^2) \\leq \\sigma^2\n$$\n$$\n(\\sum x_i^2) (\\theta - \\hat{\\theta})^2 \\leq \\sigma^2 \\implies (\\theta - \\hat{\\theta})^2 \\leq \\frac{\\sigma^2}{\\sum_{i=1}^{n} x_i^2}\n$$\n这给出了 $\\theta$ 的区间：\n$$\n\\hat{\\theta} - \\frac{\\sigma}{\\sqrt{\\sum_{i=1}^{n} x_i^2}} \\leq \\theta \\leq \\hat{\\theta} + \\frac{\\sigma}{\\sqrt{\\sum_{i=1}^{n} x_i^2}}\n$$\n\n第四，我们数值计算置信区间。数据为 $n=5$，$\\sigma=0.05$，$t_i \\in \\{0, 1, 2, 3, 4\\}$，以及 $y_i \\in \\{2.45, 0.95, 0.31, 0.12, 0.06\\}$。\n我们计算回归变量值 $x_i = \\exp(-t_i)$：\n$x_1 = \\exp(0) = 1$\n$x_2 = \\exp(-1) \\approx 0.36788$\n$x_3 = \\exp(-2) \\approx 0.13534$\n$x_4 = \\exp(-3) \\approx 0.04979$\n$x_5 = \\exp(-4) \\approx 0.01832$\n\n接下来，我们计算所需的和：$\\sum_{i=1}^{5} x_i^2$ 和 $\\sum_{i=1}^{5} y_i x_i$。\n$$\n\\sum_{i=1}^{5} x_i^2 = \\exp(0)^2 + \\exp(-1)^2 + \\exp(-2)^2 + \\exp(-3)^2 + \\exp(-4)^2 = \\exp(0) + \\exp(-2) + \\exp(-4) + \\exp(-6) + \\exp(-8) \\approx 1.156465\n$$\n$$\n\\sum_{i=1}^{5} y_i x_i = (2.45 \\times \\exp(0)) + (0.95 \\times \\exp(-1)) + (0.31 \\times \\exp(-2)) + (0.12 \\times \\exp(-3)) + (0.06 \\times \\exp(-4)) \\approx 2.848513\n$$\n现在我们计算 $\\theta$ 的最大似然估计：\n$$\n\\hat{\\theta} = \\frac{\\sum y_i x_i}{\\sum x_i^2} \\approx \\frac{2.848513}{1.156465} \\approx 2.46313\n$$\n置信区间的半宽度为：\n$$\nw = \\frac{\\sigma}{\\sqrt{\\sum x_i^2}} \\approx \\frac{0.05}{\\sqrt{1.156465}} \\approx \\frac{0.05}{1.07539} \\approx 0.046495\n$$\n置信区间 $[\\theta_{\\text{lower}}, \\theta_{\\text{upper}}]$ 为：\n$\\theta_{\\text{lower}} = \\hat{\\theta} - w \\approx 2.46313 - 0.046495 = 2.416635$\n$\\theta_{\\text{upper}} = \\hat{\\theta} + w \\approx 2.46313 + 0.046495 = 2.509625$\n\n将每个端点四舍五入到四位有效数字，我们得到：\n$\\theta_{\\text{lower}} \\approx 2.417$\n$\\theta_{\\text{upper}} \\approx 2.510$\n置信区间约为 $[2.417, 2.510]$。", "answer": "$$\\boxed{\\begin{pmatrix} 2.417  & 2.510 \\end{pmatrix}}$$", "id": "4372099"}, {"introduction": "最后的这项实践将前述概念综合应用于一个计算场景中。通过编程实现剖面似然分析，您将亲眼观察到数据的质量和类型如何显著影响参数的可辨识性。练习将对比一个设计良好的实验与仅有稀疏或晚期时间点数据的场景，从而揭示结构不可辨识性与实用不可辨识性在实践中的具体表现和后果。[@problem_id:4372027]", "problem": "考虑由常微分方程（ODE）$$\\frac{dx}{dt} = -\\theta x,$$给出的指数衰减模型，其在未知初始条件下的解为$$x(t) = x(0)\\,e^{-\\theta t}.$$假设采集到的测量值为$$y_i = x(t_i) + \\varepsilon_i,$$其中测量噪声满足$$\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$$，在各个时间点上独立，并且$$\\sigma$$已知。任务是，在$$x(0)$$未知的情况下，通过计算$$\\theta$$在最大似然估计（MLE）下的剖面似然（PL）来评估参数$$\\theta$$的可辨识性，并说明当只有稳态或晚期数据可用时出现的平坦方向。\n\n您必须实现一个程序，对于一个$$\\theta$$值的网格，通过对每个$$\\theta$$的讨厌参数$$x(0)$$进行负对数似然函数的最小化，来计算剖面负对数似然$$\\ell(\\theta)$$。然后，对于每个测试用例，您必须报告：\n- MLE $$\\hat{\\theta}$$，单位为$$\\mathrm{s}^{-1}$$，\n- 在似然比阈值$$\\Delta \\ell^\\star$$处的 PL 宽度，单位为$$\\mathrm{s}^{-1}$$，\n- 一个布尔标志，指示 PL 是否根据指定标准表现出平坦方向。\n\n必须使用的定义：\n- 剖面似然（PL）：在对$$x(0)$$进行优化后，作为$$\\theta$$函数的似然。\n- 最大似然估计（MLE）：通过最小化剖面负对数似然得到的估计值$$\\hat{\\theta}$$。\n- 此处平坦方向定义为以下任一情况：在阈值$$\\Delta \\ell^\\star$$处的置信集触及$$\\theta$$-网格边界，或者其宽度至少为总网格跨度的$$w_{\\mathrm{flat}}$$分数。\n\n您必须在区间$$[\\theta_{\\min},\\theta_{\\max}]$$上使用一个固定步长$$\\delta_\\theta$$的网格来计算$$\\theta$$，并通过优化掉$$x(0)$$来计算每个网格点上的 PL。使用似然比阈值$$\\Delta \\ell^\\star$$来定义置信集$$\\{\\theta : \\ell(\\theta) - \\min_{\\theta} \\ell(\\theta) \\le \\Delta \\ell^\\star\\}$$，并报告其宽度为此集合中最大和最小$$\\theta$$之间的差值。对于布尔标志，请使用上述的平坦度标准。\n\n您的程序必须实现以下使用合成数据的测试套件。在所有情况下，测量单位为任意浓度单位，时间单位为秒；报告$$\\hat{\\theta}$$和宽度时单位为$$\\mathrm{s}^{-1}$$。对于有噪声的场景，使用指定的种子绘制高斯噪声以确保可复现性。\n\n- 测试用例$$1$$（全时程，可辨识）：\n  - 真实参数：$$\\theta_{\\mathrm{true}} = 0.5$$，$$x(0)_{\\mathrm{true}} = 5.0$$。\n  - 时间点：$$t = [0.0,\\,0.5,\\,1.0,\\,2.0,\\,3.5,\\,5.0,\\,6.0]$$。\n  - 噪声水平：$$\\sigma = 0.05$$。\n  - 噪声种子：$$12345$$。\n\n- 测试用例$$2$$（仅晚期时间，实践上平坦）：\n  - 真实参数：$$\\theta_{\\mathrm{true}} = 0.5$$，$$x(0)_{\\mathrm{true}} = 5.0$$。\n  - 时间点：$$t = [5.0,\\,6.0,\\,8.0,\\,10.0,\\,12.0]$$。\n  - 噪声水平：$$\\sigma = 0.05$$。\n  - 噪声种子：$$23456$$。\n\n- 测试用例$$3$$（仅稳态，结构性平坦）：\n  - 时间点：$$t = [100.0]$$。\n  - 观测测量值：$$y = [0.0]$$ 精确值（无噪声抽取）。\n  - 似然函数中使用的噪声水平：$$\\sigma = 0.01$$。\n\n在所有测试用例中一致使用以下全局分析设置：\n- $$\\theta_{\\min} = 0.001$$，\n- $$\\theta_{\\max} = 3.000$$，\n- $$\\delta_\\theta = 0.001$$，\n- 似然比阈值$$\\Delta \\ell^\\star = 2.0$$，\n- 平坦度分数阈值$$w_{\\mathrm{flat}} = 0.7$$。\n\n程序必须为每个测试用例执行的算法任务：\n- 根据用例规范模拟或设置观测值$$y_i$$。\n- 对于网格上的每个$$\\theta$$，数值上优化掉$$x(0)$$并计算剖面负对数似然$$\\ell(\\theta)$$。\n- 计算$$\\hat{\\theta}$$为网格上最小化$$\\ell(\\theta)$$的$$\\theta$$。\n- 计算在$$\\Delta \\ell^\\star$$处的 PL 宽度。\n- 使用指定标准计算平坦度标志。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个元素对应一个测试用例，并且本身是包含三个条目$$[\\hat{\\theta},\\text{width},\\text{is\\_flat}]$$的子列表。前两个条目是单位为$$\\mathrm{s}^{-1}$$的浮点数，第三个是布尔值。例如，格式应类似于$$[[0.500000,0.123000,\\mathrm{False}],[\\dots],[\\dots]]$$，不含空格。\n\n不允许外部输入；所有值和数据都在程序内部定义。", "solution": "该问题要求使用剖面似然法评估指数衰减模型的参数可辨识性。这是系统生物学和其他定量领域中分析参数估计置信度的基本技术，特别是当某些参数（所谓的讨厌参数）不是主要关注对象时。\n\n该模型由一个常微分方程的解来描述：\n$$x(t) = x(0)\\,e^{-\\theta t}$$\n其中$$x(t)$$是在时间$$t$$的状态，$$x(0)$$是初始状态，而$$\\theta$$是衰减速率常数。在时间点$$t_i$$进行测量$$y_i$$，测量值受独立同分布的高斯噪声影响：\n$$y_i = x(t_i) + \\varepsilon_i, \\quad \\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$$\n噪声的标准差$$\\sigma$$假定为已知。需要从数据$$\\{y_i, t_i\\}$$中估计的参数是$$\\theta$$和$$x(0)$$。我们的兴趣在于$$\\theta$$的可辨识性，并将$$x(0)$$视为讨厌参数。\n\n分析过程首先构建似然函数，该函数量化了对于给定的参数集，观测数据出现的可能性。对于单个数据点$$y_i$$，其概率密度函数为：\n$$p(y_i | \\theta, x(0)) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - x(0)e^{-\\theta t_i})^2}{2\\sigma^2} \\right)$$\n假设测量是独立的，整个包含$$N$$个点的数据集的总似然$$\\mathcal{L}(\\theta, x(0))$$是单个概率的乘积：\n$$\\mathcal{L}(\\theta, x(0)) = \\prod_{i=1}^{N} p(y_i | \\theta, x(0))$$\n在数值计算上，处理负对数似然$$\\ell(\\theta, x(0)) = -\\log(\\mathcal{L}(\\theta, x(0)))$$更为方便。取对数并取反得到：\n$$\\ell(\\theta, x(0)) = \\frac{N}{2}\\log(2\\pi\\sigma^2) + \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - x(0)e^{-\\theta t_i})^2$$\n为了找到参数的最大似然估计（MLE），需要最小化此函数。\n\n对于我们感兴趣的参数$$\\theta$$，其剖面似然是通过对每个固定的$$\\theta$$值，就讨厌参数$$x(0)$$对负对数似然进行最小化来获得的。我们将剖面负对数似然定义为：\n$$\\ell_{PL}(\\theta) = \\min_{x(0)} \\ell(\\theta, x(0))$$\n由于常数项$$\\frac{N}{2}\\log(2\\pi\\sigma^2)$$不依赖于$$x(0)$$，这等价于最小化残差平方和$$S(\\theta, x(0)) = \\sum_{i=1}^{N} (y_i - x(0)e^{-\\theta t_i})^2$$。这是一个关于$$x(0)$$的线性最小二乘问题。为了找到最优的$$x(0)$$（我们记作$$\\hat{x}(0)(\\theta)$$），我们将$$S$$对$$x(0)$$的偏导数设为零：\n$$\\frac{\\partial S}{\\partial x(0)} = -2 \\sum_{i=1}^{N} (y_i - x(0)e^{-\\theta t_i})e^{-\\theta t_i} = 0$$\n求解$$x(0)$$得到其在给定$$\\theta$$下的最优值的解析解：\n$$\\hat{x}(0)(\\theta) = \\frac{\\sum_{i=1}^{N} y_i e^{-\\theta t_i}}{\\sum_{i=1}^{N} e^{-2\\theta t_i}}$$\n二阶导数$$\\frac{\\partial^2 S}{\\partial x(0)^2} = 2 \\sum_{i=1}^{N} e^{-2\\theta t_i}$$对于实数$$t_i$$和$$\\theta$$总是正的，这确认了这是一个最小值点。\n\n将$$\\hat{x}(0)(\\theta)$$代回负对数似然表达式，得到$$\\theta$$的剖面负对数似然：\n$$\\ell_{PL}(\\theta) = \\frac{N}{2}\\log(2\\pi\\sigma^2) + \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - \\hat{x}(0)(\\theta)e^{-\\theta t_i})^2$$\n\n需要实现的算法如下：\n1. 对于每个测试用例，生成或定义在时间点$$\\{t_i\\}$$的测量数据$$\\{y_i\\}$$。\n2. 创建一个从$$\\theta_{\\min}$$到$$\\theta_{\\max}$$，步长为$$\\delta_\\theta$$的离散$$\\theta$$值网格。\n3. 对于网格上的每个$$\\theta_j$$，使用上述解析公式计算$$\\hat{x}(0)(\\theta_j)$$。然后，计算剖面负对数似然的值$$\\ell_{PL}(\\theta_j)$$。\n4. 找到计算出的剖面的全局最小值$$\\ell_{\\min} = \\min_j \\ell_{PL}(\\theta_j)$$。对应的参数值$$\\hat{\\theta} = \\arg\\min_j \\ell_{PL}(\\theta_j)$$是$$\\theta$$的最大似然估计。\n5. 基于似然比检验确定置信集。在某一置信水平下与数据一致的参数集合由$$\\{\\theta : \\ell_{PL}(\\theta) - \\ell_{\\min} \\le \\Delta \\ell^\\star\\}$$给出。这里，$$\\Delta \\ell^\\star$$是预定义的阈值。该集合的宽度是其最大值和最小值之间的差。\n6. 根据指定的标准评估剖面似然是否表现出“平坦方向”：置信集与$$\\theta$$网格的边界相交，或者其宽度超过总网格跨度的一个分数$$w_{\\text{flat}}$$。\n\n此程序将应用于三个旨在说明不同可辨识性场景的测试用例：\n- **案例1：**来自完整时程的数据预计能很好地约束$$x(0)$$和$$\\theta$$，从而在剖面似然中产生一个明确定义的最小值和一个窄的置信区间。这代表一个可辨识的参数。\n- **案例2：**仅来自晚期时间点的数据，此时信号$$x(t)$$接近于零。信息含量低，使得难以区分不同（足够大）的$$\\theta$$值。这导致一个“实践上不可辨识”的参数，其特征是宽而平坦的似然剖面和一个大的置信区间。\n- **案例3：**在非常晚的时间（稳态）的单个数据点，此时$$x(t \\to \\infty) \\to 0$$。一个为零的测量值可以通过为任何正衰减率$$\\theta$$设置$$\\hat{x}(0) = 0$$来完美解释。对于所有$$\\theta > 0$$，似然将是常数，使得该参数从此数据中“结构上不可辨识”。置信区间将跨越整个参数范围。\n实现部分将对每个案例进行数值分析，并按要求报告结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for parameter identifiability in an exponential decay model\n    using profile likelihood for three test cases.\n    \"\"\"\n\n    # Global analysis settings\n    theta_min = 0.001\n    theta_max = 3.000\n    delta_theta = 0.001\n    delta_ell_star = 2.0\n    w_flat = 0.7\n\n    # Test case definitions\n    test_cases = [\n        {\n            \"name\": \"Case 1: Full time-course, identifiable\",\n            \"true_params\": {\"theta\": 0.5, \"x0\": 5.0},\n            \"time_points\": np.array([0.0, 0.5, 1.0, 2.0, 3.5, 5.0, 6.0]),\n            \"sigma\": 0.05,\n            \"noise_seed\": 12345,\n            \"y_data\": None\n        },\n        {\n            \"name\": \"Case 2: Late-time-only, practically flat\",\n            \"true_params\": {\"theta\": 0.5, \"x0\": 5.0},\n            \"time_points\": np.array([5.0, 6.0, 8.0, 10.0, 12.0]),\n            \"sigma\": 0.05,\n            \"noise_seed\": 23456,\n            \"y_data\": None\n        },\n        {\n            \"name\": \"Case 3: Steady-state-only, structurally flat\",\n            \"true_params\": None,\n            \"time_points\": np.array([100.0]),\n            \"sigma\": 0.01,\n            \"noise_seed\": None,\n            \"y_data\": np.array([0.0])\n        }\n    ]\n\n    # Generate theta grid\n    # Use linspace for robustness against floating point errors with arange\n    num_points = int(round((theta_max - theta_min) / delta_theta)) + 1\n    theta_grid = np.linspace(theta_min, theta_max, num_points)\n\n    all_results = []\n\n    for case in test_cases:\n        t = case[\"time_points\"]\n        sigma = case[\"sigma\"]\n        y = case[\"y_data\"]\n        N = len(t)\n        \n        # Generate synthetic data if not provided directly\n        if y is None:\n            rng = np.random.default_rng(case[\"noise_seed\"])\n            theta_true = case[\"true_params\"][\"theta\"]\n            x0_true = case[\"true_params\"][\"x0\"]\n            x_true = x0_true * np.exp(-theta_true * t)\n            noise = rng.normal(0, sigma, size=N)\n            y = x_true + noise\n\n        # Compute profile negative log-likelihood\n        profile_nll = np.zeros_like(theta_grid)\n        \n        for i, theta_val in enumerate(theta_grid):\n            exp_t = np.exp(-theta_val * t)\n            exp_2t = np.exp(-2 * theta_val * t)\n            \n            numerator = np.sum(y * exp_t)\n            denominator = np.sum(exp_2t)\n\n            # If denominator underflows to 0, it means all exp(-theta*t) are\n            # effectively 0. The model predicts 0, and x0 is indeterminate.\n            # The RSS is then simply sum of squares of y.\n            if denominator = np.finfo(float).tiny:\n                rss = np.sum(y**2)\n            else:\n                x0_hat = numerator / denominator\n                rss = np.sum((y - x0_hat * exp_t)**2)\n            \n            # The full negative log-likelihood formula\n            nll = N / 2 * np.log(2 * np.pi * sigma**2) + rss / (2 * sigma**2)\n            profile_nll[i] = nll\n\n        # Find MLE and confidence interval\n        nll_min = np.min(profile_nll)\n        mle_idx = np.argmin(profile_nll)\n        theta_mle = theta_grid[mle_idx]\n        \n        threshold = nll_min + delta_ell_star\n        confidence_indices = np.where(profile_nll = threshold)[0]\n        \n        # Calculate width of confidence interval\n        if len(confidence_indices) > 0:\n            ci_min_theta = theta_grid[confidence_indices[0]]\n            ci_max_theta = theta_grid[confidence_indices[-1]]\n            width = ci_max_theta - ci_min_theta\n        else: # Should not happen if logic is correct\n            width = 0.0\n\n        # Check for flatness\n        touches_boundary = False\n        if len(confidence_indices) > 0:\n            touches_boundary = (confidence_indices[0] == 0) or \\\n                               (confidence_indices[-1] == len(theta_grid) - 1)\n        \n        grid_span = theta_max - theta_min\n        width_is_large = (width >= w_flat * grid_span)\n        \n        is_flat = touches_boundary or width_is_large\n        \n        all_results.append([theta_mle, width, is_flat])\n\n    # Format output string\n    result_strings = []\n    for res in all_results:\n        theta_str = f\"{res[0]:.6f}\"\n        width_str = f\"{res[1]:.6f}\"\n        bool_str = str(res[2])\n        result_strings.append(f\"[{theta_str},{width_str},{bool_str}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "4372027"}]}