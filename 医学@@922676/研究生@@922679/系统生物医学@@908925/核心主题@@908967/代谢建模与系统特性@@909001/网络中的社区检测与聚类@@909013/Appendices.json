{"hands_on_practices": [{"introduction": "Girvan-Newman算法是一种经典的“分裂式”社区发现方法，其核心思想是逐步移除连接不同社区的“桥梁”边。要识别这些关键的桥梁，该算法依赖于边介数中心性的计算。本练习 [@problem_id:4329316] 提供了一个具体的情景，让你通过亲手计算一个小型蛋白质相互作用网络中每条边的介数，来实践该算法的第一步，从而直观地理解其工作原理。", "problem": "考虑一个系统生物医学中的无向、无权重的蛋白质-蛋白质相互作用（PPI）网络，其节点为 $A, B, C, D, E, F, G, H$。该网络代表了由一个连接蛋白连接的两个蛋白质复合物。边的标记如下，每条边表示一个二元相互作用：边 $1$: $(A,B)$，边 $2$: $(A,C)$，边 $3$: $(B,C)$，边 $4$: $(C,D)$，边 $5$: $(D,E)$，边 $6$: $(E,F)$，边 $7$: $(E,G)$，边 $8$: $(F,G)$，边 $9$: $(E,H)$。其拓扑结构为：一个由 {A, B, C} 组成的团和一个由 {E, F, G} 组成的团通过路径 C-D-E 相连，另有一个叶节点 H 连接到节点 E。执行一次 Girvan–Newman 社区发现算法的迭代：根据所有无序的不同节点对之间的最短路径，计算每条标记边的边介数中心性，然后确定要移除的单条边（如果有多条边并列最高，则选择边索引最小的边来打破平局）。以整数形式报告要移除的边的索引。最终答案必须是单个数字。无需四舍五入。", "solution": "该问题是有效的，因为它提出了一个在图论中定义明确的问题，并应用于系统生物医学中一个合理的网络结构。所有必要信息都已提供，术语明确，要求的任务在计算上是可行的，并且会得出一个唯一的解。\n\n任务是执行一次 Girvan–Newman 算法的迭代。这包括计算网络中每条边的边介数中心性，然后移除中心性得分最高的边。如果出现平局，则移除索引最小的边。\n\n该网络由 $8$ 个节点 $V = \\{A, B, C, D, E, F, G, H\\}$ 和 $9$ 条无向、无权重的边组成：\n- 边 $1$: $(A,B)$\n- 边 $2$: $(A,C)$\n- 边 $3$: $(B,C)$\n- 边 $4$: $(C,D)$\n- 边 $5$: $(D,E)$\n- 边 $6$: $(E,F)$\n- 边 $7$: $(E,G)$\n- 边 $8$: $(F,G)$\n- 边 $9$: $(E,H)$\n\n该网络的拓扑结构由两个三节点团 $\\{A, B, C\\}$ 和 $\\{E, F, G\\}$ 组成，通过一个桥接结构相连。具体来说，节点 $C$ 连接到节点 $D$，节点 $D$ 再连接到节点 $E$。此外，节点 $H$ 是一个连接到节点 $E$ 的叶节点。\n\n一条边 $e$ 的边介数中心性 $C_B(e)$ 定义为所有不同节点对之间通过 $e$ 的最短路径所占比例的总和。\n$$C_B(e) = \\sum_{u, v \\in V, u \\neq v} \\frac{\\sigma_{uv}(e)}{\\sigma_{uv}}$$\n其中 $\\sigma_{uv}$ 是节点 $u$ 和 $v$ 之间最短路径的总数，而 $\\sigma_{uv}(e)$ 是这些最短路径中通过边 $e$ 的数量。由于图是无向的，我们对每个无序对 $\\{u, v\\}$ 只考虑一次。\n\n由于团之间连接的简单、无环性质，对于这个特定图中的任意节点对 $\\{u, v\\}$，它们之间只有一条最短路径。因此，对于所有对 $\\{u, v\\}$，$\\sigma_{uv} = 1$。公式简化为计算通过每条边的最短路径的数量。\n\n我们将通过识别其唯一最短路径穿过该边的节点对，来计算这 $9$ 条边中每一条的 $C_B(e)$。\n\n1.  **边 5: $(D,E)$**\n    该边是连接包含节点 $S_1 = \\{A, B, C, D\\}$ 的子图与包含节点 $S_2 = \\{E, F, G, H\\}$ 的子图的桥。任何在节点 $u \\in S_1$ 和节点 $v \\in S_2$ 之间的最短路径都必须通过边 $(D,E)$。\n    $S_1$ 中的节点数为 $|S_1| = 4$。$S_2$ 中的节点数为 $|S_2| = 4$。\n    这样的节点对数量为 $|S_1| \\times |S_2| = 4 \\times 4 = 16$。\n    因此，$C_B(D,E) = 16$。\n\n2.  **边 4: $(C,D)$**\n    该边是连接团 $\\{A, B, C\\}$ 与网络其余部分 $\\{D, E, F, G, H\\}$ 的桥。设 $S_1' = \\{A, B, C\\}$ 和 $S_2' = \\{D, E, F, G, H\\}$。任何在节点 $u \\in S_1'$ 和节点 $v \\in S_2'$ 之间的最短路径都必须通过边 $(C,D)$。\n    $S_1'$ 中的节点数为 $|S_1'| = 3$。$S_2'$ 中的节点数为 $|S_2'| = 5$。\n    这样的节点对数量为 $|S_1'| \\times |S_2'| = 3 \\times 5 = 15$。\n    因此，$C_B(C,D) = 15$。\n\n3.  **边 9: $(E,H)$**\n    这是一条叶边。从节点 $H$ 到网络中任何其他节点的最短路径都必须通过 $(E,H)$。有 $7$ 个其他节点：$\\{A, B, C, D, E, F, G\\}$。\n    因此，$C_B(E,H) = 7$。\n\n4.  **边 1: $(A,B)$ 和边 8: $(F,G)$**\n    这些边是三节点团的一部分。考虑边 $(A,B)$。包含 $(A,B)$ 的最短路径不能同时包含节点 $C$，因为通过用 $A-B$（长度为 $1$）替换子路径 $A-C-B$（长度为 $2$）或反之，可以缩短路径。例如，路径 $X-\\dots-C-A-B-\\dots-Y$可以缩短为 $X-\\dots-C-B-\\dots-Y$。这意味着没有最短路径会*穿过*边 $(A,B)$ 来连接其他节点。唯一使用边 $(A,B)$ 的最短路径是 $A$ 和 $B$ 自身之间的路径。\n    因此，只有节点对 $\\{A,B\\}$ 对 $(A,B)$ 的中心性有贡献。\n    $C_B(A,B) = 1$。\n    根据对称性，对于边 $(F,G)$，只有节点对 $\\{F,G\\}$ 有贡献。\n    $C_B(F,G) = 1$。\n\n5.  **边 2: $(A,C)$ 和边 3: $(B,C)$**\n    根据网络关于节点 $A$ 和 $B$ 的对称性，$C_B(A,C) = C_B(B,C)$。我们来计算 $C_B(A,C)$。\n    穿过 $(A,C)$ 的最短路径是连接 $A$ 与 $C$ “另一侧”的节点的路径，以及节点对 $\\{A,C\\}$ 本身的路径。\n    从 $A$ 的角度看，在 $C$ 另一侧的节点是 $\\{B, D, E, F, G, H\\}$。\n    -   从 $A$到 $B$ 的最短路径是直接边 $(A,B)$。\n    -   从 $A$ 到集合 $\\{D, E, F, G, H\\}$ 的最短路径都以 $A-C-D-\\dots$ 开始。有 $5$ 个这样的目标节点。\n    -   节点对 $\\{A,C\\}$ 的最短路径是边 $(A,C)$ 本身。\n    因此，通往节点 $\\{D, \\dots, H\\}$ 的 $5$ 条路径加上 $\\{A,C\\}$ 的路径使用了这条边。\n    $C_B(A,C) = 5 + 1 = 6$。\n    根据对称性，$C_B(B,C) = 6$。\n\n6.  **边 6: $(E,F)$ 和边 7: $(E,G)$**\n    根据网络关于节点 $F$ 和 $G$ 的对称性，$C_B(E,F) = C_B(E,G)$。我们来计算 $C_B(E,F)$。\n    穿过 $(E,F)$ 的最短路径是连接 $F$ 与 $E$ “另一侧”的节点的路径，以及节点对 $\\{E,F\\}$ 本身的路径。\n    从 $F$ 的角度看，在 $E$ 另一侧的节点是 $\\{A, B, C, D, H\\}$。\n    -   从 $F$到这 $5$ 个节点的最短路径都以 $F-E-\\dots$ 开始（例如，$F-E-D-C-A$）。有 $5$ 条这样的路径。\n    -   节点对 $\\{E,F\\}$ 的最短路径是边 $(E,F)$ 本身。\n    因此，$C_B(E,F) = 5 + 1 = 6$。\n    根据对称性，$C_B(E,G) = 6$。\n\n边介数中心性得分总结：\n-   $C_B(\\text{边 1, } (A,B)) = 1$\n-   $C_B(\\text{边 2, } (A,C)) = 6$\n-   $C_B(\\text{边 3, } (B,C)) = 6$\n-   $C_B(\\text{边 4, } (C,D)) = 15$\n-   $C_B(\\text{边 5, } (D,E)) = 16$\n-   $C_B(\\text{边 6, } (E,F)) = 6$\n-   $C_B(\\text{边 7, } (E,G)) = 6$\n-   $C_B(\\text{边 8, } (F,G)) = 1$\n-   $C_B(\\text{边 9, } (E,H)) = 7$\n\n最高中心性得分为 $16$，对应于边 $(D,E)$。最大值没有并列情况。\n边 $(D,E)$ 的索引为 $5$。\n因此，在 Girvan–Newman 算法的第一次迭代中要移除的单条边是边 $5$。", "answer": "$$\\boxed{5}$$", "id": "4329316"}, {"introduction": "在识别出潜在的社区结构后，我们需要一个量化指标来评估其优劣，而模块度（Modularity）正是最广泛使用的评估标准之一。然而，标准的模块度存在一个著名的“分辨率极限”问题，即它可能无法识别出小于特定尺寸的社区。本练习 [@problem_id:4329295] 旨在通过一个加权基因共表达网络，让你深入探索带分辨率参数$\\gamma$的广义模块度，并计算出决定社区划分粒度的临界值$\\gamma^{\\ast}$。这有助于你理解如何在具有层级结构的复杂生物网络中，通过调整分辨率来发现不同尺度的功能模块。", "problem": "考虑一个包含六个基因的加权基因共表达网络（WGCN），其对称加权邻接矩阵的元素在 $i \\neq j$ 时已指定，且 $w_{ii} = 0$：\n- 在三元组 $\\{1,2,3\\}$ 内部，$w_{12} = w_{13} = w_{23} = 0.8$。\n- 在 $\\{1,2,3\\}$ 和 $\\{4,5\\}$ 之间，所有权重均为 $0.1$，即 $w_{14} = w_{15} = w_{24} = w_{25} = w_{34} = w_{35} = 0.1$。\n- 在二元组 $\\{4,5\\}$ 内部，$w_{45} = 0.9$。\n- 在 $\\{1,2,3,4,5\\}$ 中的每个基因与基因 $6$ 之间，所有权重均为 $0.2$，即 $w_{16} = w_{26} = w_{36} = w_{46} = w_{56} = 0.2$。\n\n令 $s_i = \\sum_{j} w_{ij}$ 表示节点强度，$2m = \\sum_{i} s_i$ 表示总强度。使用加权配置模型的零期望（对于 $i \\neq j$，$p_{ij} = \\frac{s_i s_j}{2m}$，且 $p_{ii} = 0$）。使用带有分辨率参数 $\\gamma$ 的广义模块度，计算以下两个候选划分的模块度 $Q(\\gamma)$：\n- 划分 $\\mathcal{P}_A$：社群 $\\{1,2,3\\}$ 和 $\\{4,5,6\\}$。\n- 划分 $\\mathcal{P}_B$：社群 $\\{1,2,3\\}$, $\\{4,5\\}$ 和 $\\{6\\}$。\n\n在所述零模型下，推导 $Q_A(\\gamma)$ 和 $Q_B(\\gamma)$ 的精确表达式（用 $\\gamma$ 表示），并确定使 $Q_A(\\gamma^{\\ast}) = Q_B(\\gamma^{\\ast})$ 成立的精确临界值 $\\gamma^{\\ast}$。在推导过程中，从第一性原理出发，解释 $\\gamma$ 的选择如何影响 WGCN 中小基因模块的分辨率，以及如何选择 $\\gamma$ 来分辨像 $\\{4,5\\}$ 和 $\\{6\\}$ 这样的模块。最终答案请表示为 $\\gamma^{\\ast}$ 的精确值，无需四舍五入。", "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它提供了来自网络科学领域的完整数据集和定义，从而可以得出一个唯一的、可验证的解。\n\n问题要求计算并比较一个加权网络的两种不同划分的广义模块度 $Q(\\gamma)$。广义模块度的定义为：\n$$Q(\\gamma) = \\frac{1}{2m} \\sum_{i,j} \\left[ w_{ij} - \\gamma \\frac{s_i s_j}{2m} \\right] \\delta(c_i, c_j)$$\n其中 $w_{ij}$ 是节点 $i$ 和 $j$ 之间边的权重，$s_i = \\sum_{k} w_{ik}$ 是节点 $i$ 的强度，$2m = \\sum_{i} s_i$ 是网络的总强度，$c_i$ 是节点 $i$ 所属的社群，$ \\delta(c_i, c_j) $ 是克罗内克 delta 函数，当 $c_i = c_j$ 时为 $1$，否则为 $0$，而 $\\gamma$ 是分辨率参数。\n\n这个表达式可以通过对划分 $\\mathcal{P}$ 中的社群 $C$ 进行求和来方便地重写：\n$$Q(\\gamma) = \\sum_{C \\in \\mathcal{P}} \\left[ \\frac{L_C}{2m} - \\gamma \\left( \\frac{S_C}{2m} \\right)^2 \\right]$$\n其中 $L_C = \\sum_{i,j \\in C} w_{ij}$ 是社群 $C$ 内部所有连接的权重之和（由于对称性，每条连接计算两次），$S_C = \\sum_{i \\in C} s_i$ 是社群 $C$ 中所有节点的强度之和。\n\n首先，我们根据给定的加权邻接矩阵 $W$ 计算六个基因的节点强度 $s_i$。\n非零的非对角线权重为：$w_{12} = w_{13} = w_{23} = 0.8$；$w_{14} = w_{15} = w_{24} = w_{25} = w_{34} = w_{35} = 0.1$；$w_{45} = 0.9$；以及 $w_{16} = w_{26} = w_{36} = w_{46} = w_{56} = 0.2$。该矩阵是对称的（$w_{ij} = w_{ji}$）且 $w_{ii} = 0$。\n\n节点强度为：\n$s_1 = w_{12} + w_{13} + w_{14} + w_{15} + w_{16} = 0.8 + 0.8 + 0.1 + 0.1 + 0.2 = 2.0$\n$s_2 = w_{21} + w_{23} + w_{24} + w_{25} + w_{26} = 0.8 + 0.8 + 0.1 + 0.1 + 0.2 = 2.0$\n$s_3 = w_{31} + w_{32} + w_{34} + w_{35} + w_{36} = 0.8 + 0.8 + 0.1 + 0.1 + 0.2 = 2.0$\n$s_4 = w_{41} + w_{42} + w_{43} + w_{45} + w_{46} = 0.1 + 0.1 + 0.1 + 0.9 + 0.2 = 1.4$\n$s_5 = w_{51} + w_{52} + w_{53} + w_{54} + w_{56} = 0.1 + 0.1 + 0.1 + 0.9 + 0.2 = 1.4$\n$s_6 = w_{61} + w_{62} + w_{63} + w_{64} + w_{65} = 0.2 + 0.2 + 0.2 + 0.2 + 0.2 = 1.0$\n\n网络的总强度 $2m$ 是所有节点强度的总和：\n$$2m = s_1 + s_2 + s_3 + s_4 + s_5 + s_6 = 3 \\times 2.0 + 2 \\times 1.4 + 1.0 = 6.0 + 2.8 + 1.0 = 9.8$$\n\n接下来，我们定义两种划分的社群，并计算它们各自的 $S_C$ 和 $L_C$ 值。\n令 $C_1 = \\{1,2,3\\}$，$C_2 = \\{4,5\\}$，$C_3 = \\{6\\}$，以及 $C_{23} = \\{4,5,6\\}$。\n划分 $\\mathcal{P}_A$ 由社群 $\\{C_1, C_{23}\\}$ 组成。\n划分 $\\mathcal{P}_B$ 由社群 $\\{C_1, C_2, C_3\\}$ 组成。\n\n对于社群 $C_1 = \\{1,2,3\\}$：\n$S_{C_1} = s_1 + s_2 + s_3 = 2.0 + 2.0 + 2.0 = 6.0$\n$L_{C_1} = 2(w_{12} + w_{13} + w_{23}) = 2(0.8 + 0.8 + 0.8) = 2(2.4) = 4.8$\n\n对于社群 $C_2 = \\{4,5\\}$：\n$S_{C_2} = s_4 + s_5 = 1.4 + 1.4 = 2.8$\n$L_{C_2} = 2(w_{45}) = 2(0.9) = 1.8$\n\n对于社群 $C_3 = \\{6\\}$：\n$S_{C_3} = s_6 = 1.0$\n$L_{C_3} = 0$ (因为没有自环)\n\n对于社群 $C_{23} = \\{4,5,6\\}$：\n$S_{C_{23}} = s_4 + s_5 + s_6 = 1.4 + 1.4 + 1.0 = 3.8$\n$L_{C_{23}}$ 是 $\\{4,5,6\\}$ 内部连接的总和，这包括 $\\{4,5\\}$ 内部的连接以及 $\\{4,5\\}$ 与 $\\{6\\}$ 之间的连接：\n$L_{C_{23}} = L_{C_2} + 2(w_{46} + w_{56}) = 1.8 + 2(0.2 + 0.2) = 1.8 + 0.8 = 2.6$\n\n现在，我们可以写出每个划分的模块度表达式。\n对于划分 $\\mathcal{P}_A = \\{\\{1,2,3\\}, \\{4,5,6\\}\\}$：\n$$Q_A(\\gamma) = \\left[ \\frac{L_{C_1}}{2m} - \\gamma \\left(\\frac{S_{C_1}}{2m}\\right)^2 \\right] + \\left[ \\frac{L_{C_{23}}}{2m} - \\gamma \\left(\\frac{S_{C_{23}}}{2m}\\right)^2 \\right]$$\n$$Q_A(\\gamma) = \\frac{4.8}{9.8} - \\gamma \\left(\\frac{6.0}{9.8}\\right)^2 + \\frac{2.6}{9.8} - \\gamma \\left(\\frac{3.8}{9.8}\\right)^2$$\n$$Q_A(\\gamma) = \\frac{7.4}{9.8} - \\frac{\\gamma}{(9.8)^2} (6.0^2 + 3.8^2) = \\frac{74}{98} - \\frac{\\gamma}{96.04} (36 + 14.44)$$\n$$Q_A(\\gamma) = \\frac{37}{49} - \\gamma \\frac{50.44}{96.04} = \\frac{37}{49} - \\gamma \\frac{1261}{2401}$$\n\n对于划分 $\\mathcal{P}_B = \\{\\{1,2,3\\}, \\{4,5\\}, \\{6\\}\\}$：\n$$Q_B(\\gamma) = \\left[ \\frac{L_{C_1}}{2m} - \\gamma \\left(\\frac{S_{C_1}}{2m}\\right)^2 \\right] + \\left[ \\frac{L_{C_2}}{2m} - \\gamma \\left(\\frac{S_{C_2}}{2m}\\right)^2 \\right] + \\left[ \\frac{L_{C_3}}{2m} - \\gamma \\left(\\frac{S_{C_3}}{2m}\\right)^2 \\right]$$\n$$Q_B(\\gamma) = \\frac{4.8}{9.8} - \\gamma \\left(\\frac{6.0}{9.8}\\right)^2 + \\frac{1.8}{9.8} - \\gamma \\left(\\frac{2.8}{9.8}\\right)^2 + \\frac{0}{9.8} - \\gamma \\left(\\frac{1.0}{9.8}\\right)^2$$\n$$Q_B(\\gamma) = \\frac{6.6}{9.8} - \\frac{\\gamma}{(9.8)^2} (6.0^2 + 2.8^2 + 1.0^2) = \\frac{66}{98} - \\frac{\\gamma}{96.04} (36 + 7.84 + 1)$$\n$$Q_B(\\gamma) = \\frac{33}{49} - \\gamma \\frac{44.84}{96.04} = \\frac{33}{49} - \\gamma \\frac{1121}{2401}$$\n\n我们需要找到临界值 $\\gamma^{\\ast}$，使得 $Q_A(\\gamma^{\\ast}) = Q_B(\\gamma^{\\ast})$。\n$$\\frac{37}{49} - \\gamma^{\\ast} \\frac{1261}{2401} = \\frac{33}{49} - \\gamma^{\\ast} \\frac{1121}{2401}$$\n$$\\frac{37}{49} - \\frac{33}{49} = \\gamma^{\\ast} \\left( \\frac{1261}{2401} - \\frac{1121}{2401} \\right)$$\n$$\\frac{4}{49} = \\gamma^{\\ast} \\left( \\frac{140}{2401} \\right)$$\n由于 $2401 = 49^2$：\n$$\\frac{4}{49} = \\gamma^{\\ast} \\frac{140}{49^2}$$\n两边同乘以 $49$：\n$$4 = \\gamma^{\\ast} \\frac{140}{49}$$\n求解 $\\gamma^{\\ast}$：\n$$\\gamma^{\\ast} = 4 \\times \\frac{49}{140} = \\frac{196}{140}$$\n简化分数：\n$$\\gamma^{\\ast} = \\frac{196 \\div 28}{140 \\div 28} = \\frac{7}{5}$$\n\n分辨率参数 $\\gamma$ 控制了观测到的社群内部密度（$L_C$ 项）与基于零模型的社群存在惩罚（$S_C^2$ 项）之间的平衡。更大的 $\\gamma$ 会对社群施加更强的惩罚，特别是那些总强度 $S_C$ 较大的社群，因为惩罚项与 $S_C$呈二次方关系。这种现象被称为模块度的“分辨率极限”，即如果 $\\gamma$ 太小（经典值为 $\\gamma=1$），小的、定义明确的社群可能会被合并成更大的社群。\n\n从划分 $\\mathcal{P}_A$ 到 $\\mathcal{P}_B$ 的转变涉及到将社群 $C_{23}=\\{4,5,6\\}$ 分裂成两个更小的社群 $C_2=\\{4,5\\}$ 和 $C_3=\\{6\\}$。对于 $\\gamma  \\gamma^{\\ast}$，我们有 $Q_A(\\gamma) > Q_B(\\gamma)$，这意味着更粗糙的划分 $\\mathcal{P}_A$ 更优。对于 $\\gamma > \\gamma^{\\ast}$，我们有 $Q_B(\\gamma) > Q_A(\\gamma)$，这意味着更精细的划分 $\\mathcal{P}_B$ 更优。因此，$\\gamma^{\\ast}$ 是一个临界分辨率，在此分辨率下，算法对于将 $\\{4,5,6\\}$ 保持为单个模块还是将其分裂没有偏好。要分辨出更小的模块 $\\{4,5\\}$ 和 $\\{6\\}$，必须选择一个分辨率参数 $\\gamma > \\gamma^{\\ast} = \\frac{7}{5}$。在更高的分辨率下，尽管会从模块度得分中損失 $\\{4,5\\}$ 和 $\\{6\\}$ 之间的内部连接，但对合并后的大社群 $\\{4,5,6\\}$ 的大规模惩罚变得足够大，从而有利于分裂。", "answer": "$$\\boxed{\\frac{7}{5}}$$", "id": "4329295"}, {"introduction": "理论模型和算法的性能在很大程度上取决于输入数据的质量，而在系统生物医学中，实验数据往往充满噪声。例如，通过高通量实验构建的蛋白质相互作用（PPI）网络通常包含假阴性（遗漏的真实相互作用）和假阳性（错误的相互作用）。本练习 [@problem_id:4329349] 构建了一个数学模型，用于分析这两类测量误差如何影响网络的预期邻接矩阵和模块度得分。通过这个推导，你将量化地理解数据质量如何直接影响社区结构的可检测性，这是将理论应用于实践的关键一步。", "problem": "在一项系统生物医学研究中，您正在分析一个小型蛋白质-蛋白质相互作用（PPI）网络。六个蛋白质，标记为 $1,2,3,4,5,6$，形成两个推定的复合物：$\\{1,2,3\\}$ 和 $\\{4,5,6\\}$。在底层的生物相互作用网络中，当且仅当两个蛋白质属于同一个复合物时，它们之间存在一条无向、无权边，而不同复合物中的蛋白质之间没有相互作用。设真实邻接矩阵表示为 $A \\in \\mathbb{R}^{6 \\times 6}$，其中如果蛋白质 $i$ 和 $j$ 相互作用，则 $A_{ij} = 1$，否则 $A_{ij} = 0$。设真实度向量为 $k \\in \\mathbb{R}^{6}$，其中 $k_i = \\sum_{j=1}^{6} A_{ij}$。\n\n在测量过程中，每个真实的相互作用以概率 $p \\in (0,1)$ 被独立地漏掉，而每个非相互作用以概率 $r \\in (0,1)$ 被独立地错误报告（假阳性）。因此，测量得到的邻接矩阵是一个随机矩阵 $\\tilde{A}$，其中对于 $i \\neq j$，一条真实的边以概率 $1-p$ 被观测到，而一条真实的非边以概率 $r$ 被错误地观测为一条边。按元素定义期望测量邻接矩阵 $\\bar{A}$ 为 $\\bar{A}_{ij} = \\mathbb{E}[\\tilde{A}_{ij}]$（对于 $i \\neq j$）和 $\\bar{A}_{ii} = 0$。期望度向量为 $\\bar{k}$，其分量为 $\\bar{k}_i = \\sum_{j=1}^{6} \\bar{A}_{ij}$，期望总边权为 $m = \\sum_{1 \\leq i  j \\leq 6} \\bar{A}_{ij}$。\n\n任务：\n1. 根据所述的复合物，构建真实邻接矩阵 $A$ 和真实度向量 $k$。\n2. 利用测量误差的独立性，用 $p$ 和 $r$ 写出 $\\bar{A}$ 的元素。\n3. 考虑一个划分 $c$，它将蛋白质 $\\{1,2,3\\}$ 分到一个社群，将 $\\{4,5,6\\}$ 分到另一个社群。从给定划分下无向加权图的模块度核心定义出发，推导期望测量网络关于此划分的模块度 $Q(\\bar{A}, c)$ 的一个仅含 $p$ 和 $r$ 的闭式符号表达式。\n4. 基于网络建模和社群检测的基本原理，简要解释缺失的相互作用（参数 $p$）和测量噪声（参数 $r$）如何改变 $\\bar{A}$ 以及下游的社群检测行为。\n\n请以 $p$ 和 $r$ 表示的 $Q(\\bar{A}, c)$ 的单一简化表达式作为您的最终答案。不需要进行数值代入。无需报告单位。最终答案必须是单一的闭式表达式。", "solution": "该问题被认为是有效的，因为它在网络理论和系统生物学方面有科学依据，是一个具有唯一可解结构的适定问题，并且陈述客观。所有必需信息都已提供且内部一致。\n\n解答过程遵循四个指定任务进行。\n\n### 任务1：真实邻接矩阵和度向量\n\n该网络由 $6$ 个蛋白质组成，形成两个复合物（社群），$C_1 = \\{1, 2, 3\\}$ 和 $C_2 = \\{4, 5, 6\\}$。当且仅当两个蛋白质在同一个复合物中时，它们之间才存在边。这意味着该网络由两个不相交的3-团（3个顶点的完全图）组成。\n\n真实邻接矩阵 $A \\in \\mathbb{R}^{6 \\times 6}$ 定义为：如果蛋白质 $i$ 和 $j$ 之间存在边，则 $A_{ij}=1$，否则 $A_{ij}=0$。按照惯例，$A_{ii}=0$。矩阵 $A$ 是块对角的：\n$$\nA = \\begin{pmatrix}\n0  1  1  0  0  0 \\\\\n1  0  1  0  0  0 \\\\\n1  1  0  0  0  0 \\\\\n0  0  0  0  1  1 \\\\\n0  0  0  1  0  1 \\\\\n0  0  0  1  1  0\n\\end{pmatrix}\n$$\n蛋白质 $i$ 的真实度 $k_i$ 是它拥有的相互作用数量，由 $k_i = \\sum_{j=1}^{6} A_{ij}$ 给出。$C_1$ 中的每个蛋白质都与 $C_1$ 中的另外 $2$ 个蛋白质相连。同样，$C_2$ 中的每个蛋白质也与 $C_2$ 中的另外 $2$ 个蛋白质相连。因此，每个蛋白质的度都是 $2$。\n真实度向量 $k \\in \\mathbb{R}^6$ 是：\n$$\nk = \\begin{pmatrix} 2  2  2  2  2  2 \\end{pmatrix}^T\n$$\n\n### 任务2：期望测量邻接矩阵\n\n测量得到的邻接矩阵 $\\tilde{A}$ 是一个随机矩阵。期望测量邻接矩阵 $\\bar{A}$ 的元素为 $\\bar{A}_{ij} = \\mathbb{E}[\\tilde{A}_{ij}]$（对于 $i \\neq j$）。由于 $\\tilde{A}_{ij}$ 是一个伯努利随机变量（只能取 $0$ 或 $1$），其期望就是 $\\tilde{A}_{ij}=1$ 的概率。\n\n我们考虑 $i \\neq j$ 的两种情况：\n1.  存在真实相互作用（$A_{ij}=1$）：这发生在蛋白质 $i$ 和 $j$ 处于同一复合物中时。该相互作用被观测到的概率为 $1-p$。因此，$\\mathbb{P}(\\tilde{A}_{ij}=1 | A_{ij}=1) = 1-p$。\n2.  不存在真实相互作用（$A_{ij}=0$）：这发生在蛋白质 $i$ 和 $j$ 处于不同复合物中时。一个虚假的相互作用被报告的概率为 $r$。因此，$\\mathbb{P}(\\tilde{A}_{ij}=1 | A_{ij}=0) = r$。\n\n综合这些，$\\bar{A}$ 的元素是：\n-   如果 $i$ 和 $j$ 在同一个复合物中（$i \\neq j$），则 $\\bar{A}_{ij} = 1-p$。\n-   如果 $i$ 和 $j$ 在不同的复合物中，则 $\\bar{A}_{ij} = r$。\n-   对所有 $i$，$\\bar{A}_{ii} = 0$。\n\n### 任务3：期望网络的模块度\n\n对于一个划分成社群的加权无向图，其模块度 $Q$ 由下式给出：\n$$\nQ = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\n其中 $c$ 为社群的索引，$L_c$ 是社群 $c$ 内部边的权重之和，$K_c$ 是社群 $c$ 中所有节点的强度（加权度）之和，$m$ 是网络中所有边的权重之和。\n\n首先，我们为期望网络 $\\bar{A}$ 计算必要的量。\n-   **总边权 $m$**：\n    $m = \\sum_{1 \\le i  j \\le 6} \\bar{A}_{ij}$。在 $C_1$ 内部有 $\\binom{3}{2}=3$ 对节点，在 $C_2$ 内部有 $3$ 对节点。这 $6$ 个社群内点对的权重为 $1-p$。有 $3 \\times 3 = 9$ 个社群间点对，其权重为 $r$。\n    $$ m = 6(1-p) + 9r $$\n-   **节点强度（期望度）$\\bar{k}_i$**：\n    对于 $C_1$ 中的任意节点 $i$（例如 $i=1$），它有 $2$ 个社群内连接（到节点 $2, 3$）和 $3$ 个社群间连接（到节点 $4, 5, 6$）。\n    $$ \\bar{k}_i = 2(1-p) + 3r \\quad \\text{for } i \\in C_1 $$\n    根据对称性，这对于 $C_2$ 中的任何节点也成立。令 $\\bar{k}_{node} = 2(1-p) + 3r$。因此对于所有 $i=1, \\dots, 6$，都有 $\\bar{k}_i = \\bar{k}_{node}$。\n-   **社群内权重之和 $L_c$**：\n    对于 $C_1$，有 $3$ 条边，每条边的权重为 $1-p$。所以，$L_{C_1} = 3(1-p)$。\n    同样地，对于 $C_2$，$L_{C_2} = 3(1-p)$。\n-   **社群内强度之和 $K_c$**：\n    对于 $C_1$，$K_{C_1} = \\sum_{i \\in C_1} \\bar{k}_i = 3 \\times \\bar{k}_{node} = 3(2(1-p) + 3r)$。\n    同样地，对于 $C_2$，$K_{C_2} = 3(2(1-p) + 3r)$。\n\n总强度和为 $2m = \\sum_{i=1}^6 \\bar{k}_i = 6 \\bar{k}_{node} = 6(2(1-p)+3r) = 12(1-p)+18r$，这与我们对 $m$ 的计算结果相符。\n\n现在，我们计算模块度 $Q(\\bar{A}, c)$。由于两个社群 $C_1$ 和 $C_2$ 是对称的，我们可以写成：\n$$\nQ = 2 \\left[ \\frac{L_{C_1}}{m} - \\left( \\frac{K_{C_1}}{2m} \\right)^2 \\right]\n$$\n代入以 $p$ 和 $r$ 表示的表达式：\n$$\nQ = 2 \\left[ \\frac{3(1-p)}{6(1-p) + 9r} - \\left( \\frac{3(2(1-p) + 3r)}{2(6(1-p) + 9r)} \\right)^2 \\right]\n$$\n从分母中提出因子 $3$：\n$$\nQ = 2 \\left[ \\frac{3(1-p)}{3(2(1-p) + 3r)} - \\left( \\frac{3(2(1-p) + 3r)}{2 \\cdot 3(2(1-p) + 3r)} \\right)^2 \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{1-p}{2(1-p) + 3r} - \\left( \\frac{1}{2} \\right)^2 \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{1-p}{2(1-p) + 3r} - \\frac{1}{4} \\right]\n$$\n$$\nQ = \\frac{2(1-p)}{2(1-p) + 3r} - \\frac{1}{2}\n$$\n通过通分合并各项：\n$$\nQ = \\frac{2 \\cdot 2(1-p) - 1 \\cdot (2(1-p) + 3r)}{2(2(1-p) + 3r)}\n$$\n$$\nQ = \\frac{4(1-p) - 2(1-p) - 3r}{2(2(1-p) + 3r)}\n$$\n$$\nQ = \\frac{2(1-p) - 3r}{2(2(1-p) + 3r)}\n$$\n这就是模块度的最终简化符号表达式。\n\n### 任务4：参数影响的解释\n\n参数 $p$ 和 $r$ 分别代表两种不同类型的测量误差：假阴性（漏掉真实的相互作用）和假阳性（报告了虚假的相互作用）。\n\n1.  **对 $\\bar{A}$ 的影响**：\n    -   参数 $p \\in (0,1)$ 控制漏掉真实相互作用的速率。$p$ 的增加会使期望网络 $\\bar{A}$ 中社群内部边的权重从 $1$ 减小到趋近于 $0$（具体权重为 $1-p$）。这削弱了定义社群的“信号”，使它们变得不那么内聚。\n    -   参数 $r \\in (0,1)$ 控制虚假相互作用的速率。$r$ 的增加会为在真实网络中不存在的社群间边增加权重。这引入了“噪声”，模糊了社群之间的边界，实际上连接了之前独立的模块。\n\n2.  **对社群检测的影响**：\n    -   社群检测算法，特别是基于模块度优化的算法，其功能是识别出与随机零模型相比，具有高密度内部边和低密度外部边的网络划分。\n    -   增加 $p$ 会减弱内部内聚性（模块度公式第一项的分子），而增加 $r$ 会引入外部连接（这既减小了模块度得分的分子，又增大了分母）。这两种效应都通过降低社群内和社群间连接性的对比度来降低社群结构的质量。\n    -   推导出的模块度表达式 $Q = \\frac{2(1-p) - 3r}{2(2(1-p) + 3r)}$ 定量地捕捉了这种退化。为了使社群结构可被检测到（$Q > 0$），分子必须为正，即 $2(1-p) - 3r > 0$，或 $2p+3r  2$。这个不等式显示了两种误差类型之间的权衡。在这种特定的拓扑结构中，模块度对假阳性（$r$，系数为 $3$）比对假阴性（$p$，系数为 $2$）更敏感，因为可能变成噪声的非边（$9$ 条）比可能作为信号丢失的真边（$6$ 条）更多。当 $1-p = r$ 时，期望图变成一个具有统一边权的完全图，社群结构完全消失，导致模块度得分为负。", "answer": "$$\n\\boxed{\\frac{2(1-p) - 3r}{2(2(1-p) + 3r)}}\n$$", "id": "4329349"}]}