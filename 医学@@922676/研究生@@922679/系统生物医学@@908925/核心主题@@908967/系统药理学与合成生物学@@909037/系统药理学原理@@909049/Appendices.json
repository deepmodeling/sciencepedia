{"hands_on_practices": [{"introduction": "$E_{max}$ 模型是药理学的基石，但其生物物理学基础却常常被忽略。第一个实践将挑战你直接从受体结合的质量作用动力学原理出发，推导出这个基本的剂量-效应关系 [@problem_id:4374362]。通过完成这个练习，你将巩固对微观参数（如解离常数 $K_D$）如何转化为宏观药理学特性（如半数有效浓度 $EC_{50}$）的理解。", "problem": "一种药物在靶组织中产生生物标志物响应，该过程在一个基于生理的药代动力学（PBPK）框架内建模。由于效应室快速平衡，效应室浓度被假定等于中央血浆浓度。药效学转导由受体结合及随后的信号生成所决定。考虑一个单一受体类别，其配体结合是可逆的，并遵循质量作用动力学：游离受体浓度表示为 $R$，游离配体（药物）浓度表示为 $L$，受体-配体复合物浓度表示为 $RL$。结合和解离速率常数分别为 $k_{\\text{on}}$ 和 $k_{\\text{off}}$。在平衡状态下，解离常数 $K_{D}$ 满足 $K_{D} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{R \\, L}{RL}$。总受体浓度为 $R_{\\text{tot}} = R + RL$。假设非协同结合和线性转导：分数占有率是已结合受体的比例，观测到的效应 $E$ 与受体占有率成正比，比例常数等于最大效应 $E_{\\max}$。此外，半数最大效应浓度 $EC_{50}$ 定义为能产生 $E = \\frac{E_{\\max}}{2}$ 效应的配体浓度 $L$。\n\n观察到一个群体变异体，其最大转导能力为 $E_{\\max} = 100$ 单位，效能参数为 $EC_{50} = 2$ mg/L，希尔系数为 $n = 1$。利用这些生物物理定义和假设，推导稳态输入-输出关系式 $E$ 作为浓度 $C$ 的函数（将 $C$ 等同于 $L$），然后计算在 $C = 1$ mg/L、$C = 2$ mg/L 和 $C = 8$ mg/L 时的 $E$ 值。\n\n将您的数值结果四舍五入至四位有效数字。最终效应以“单位”表示。以行向量的形式给出您的最终答案，其中三个效应值按 $C = 1$、$C = 2$ 和 $C = 8$ mg/L 的顺序列出。", "solution": "该问题要求推导一个稳态药效学模型，并应用该模型计算特定的生物标志物响应。验证问题陈述的有效性是强制性的第一步。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   药效学模型框架：基于生理的药代动力学（PBPK）。\n-   效应室浓度：假定等于中央血浆浓度（$C_e = C_p$），表示为 $L$，后又表示为 $C$。\n-   受体结合动力学：可逆，质量作用。\n-   变量：游离受体浓度（$R$）、游离配体浓度（$L$）、受体-配体复合物浓度（$RL$）。\n-   速率常数：结合（$k_{\\text{on}}$）、解离（$k_{\\text{off}}$）。\n-   平衡解离常数：$K_{D} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{R \\, L}{RL}$。\n-   总受体浓度：$R_{\\text{tot}} = R + RL$。\n-   结合特性：非协同。\n-   转导模型：线性，效应 $E$ 与受体占有率成正比。\n-   比例常数：最大效应 $E_{\\max}$。\n-   效能参数：$EC_{50}$ 是产生 $E = \\frac{E_{\\max}}{2}$ 效应的配体浓度 $L$。\n-   群体变异体参数：$E_{\\max} = 100$ 单位，$EC_{50} = 2$ mg/L，希尔系数 $n = 1$。\n-   任务：推导关系式 $E(C)$ 并计算在 $C = 1$ mg/L、$C = 2$ mg/L 和 $C = 8$ mg/L 时的 $E$ 值。\n-   取整：结果必须四舍五入至四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学基础：** 该问题基于经典受体理论和药效学原理。质量作用动力学的使用、解离常数 $K_D$ 的定义、受体占有率的概念以及简单的 Emax 模型都是药理学和系统生物医学中的标准和基本概念。该问题具有科学合理性。\n-   **良定性：** 问题陈述是自洽的。它提供了一套清晰的定义和参数（$E_{\\max}$、$EC_{50}$、$n=1$），并要求进行特定的推导和数值计算。所给信息足以得出一个唯一解。机理描述（非协同结合）和现象学参数（希尔系数 $n=1$）之间的一致性证实了问题的内部逻辑。\n-   **客观性：** 该问题使用精确、无歧义的科学语言陈述。没有主观或基于观点的元素。\n\n**步骤 3：结论与行动**\n该问题有效。它具有科学基础、良定性、客观性且内部一致。可以继续求解过程。\n\n### 解题推导与计算\n\n问题要求基于所提供的生物物理原理，推导稳态输入-输出关系式 $E(C)$。\n\n观测到的效应 $E$ 被陈述为与分数受体占有率成线性比例，比例常数为最大效应 $E_{\\max}$。分数占有率（我们可表示为 $\\theta$）是已结合受体浓度（$RL$）与总受体浓度（$R_{\\text{tot}}$）之比。\n$$E = E_{\\max} \\cdot \\theta = E_{\\max} \\cdot \\frac{RL}{R_{\\text{tot}}}$$\n为了找到 $\\theta$ 作为配体浓度 $L$ 的函数的表达式，我们使用平衡条件和受体守恒。\n总受体浓度是游离受体和已结合受体之和：\n$$R_{\\text{tot}} = R + RL \\implies R = R_{\\text{tot}} - RL$$\n在平衡状态下，解离常数 $K_{D}$ 由下式给出：\n$$K_{D} = \\frac{R \\cdot L}{RL}$$\n将 $R$ 的表达式代入 $K_{D}$ 的方程中：\n$$K_{D} = \\frac{(R_{\\text{tot}} - RL) \\cdot L}{RL}$$\n我们现在求解此方程以得到复合物浓度 $RL$：\n$$K_{D} \\cdot RL = (R_{\\text{tot}} - RL) \\cdot L = R_{\\text{tot}} \\cdot L - RL \\cdot L$$\n$$K_{D} \\cdot RL + RL \\cdot L = R_{\\text{tot}} \\cdot L$$\n$$RL \\cdot (K_{D} + L) = R_{\\text{tot}} \\cdot L$$\n$$RL = \\frac{R_{\\text{tot}} \\cdot L}{K_{D} + L}$$\n现在，我们可以确定分数占有率 $\\theta$：\n$$\\theta = \\frac{RL}{R_{\\text{tot}}} = \\frac{1}{R_{\\text{tot}}} \\left( \\frac{R_{\\text{tot}} \\cdot L}{K_{D} + L} \\right) = \\frac{L}{K_{D} + L}$$\n将此 $\\theta$ 的表达式代回效应 $E$ 的方程中：\n$$E(L) = E_{\\max} \\cdot \\frac{L}{K_{D} + L}$$\n问题将 $EC_{50}$ 定义为效应达到半数最大值时的浓度 $L$，即 $E(L=EC_{50}) = \\frac{E_{\\max}}{2}$。我们使用这个定义来关联 $K_{D}$ 和 $EC_{50}$。\n$$\\frac{E_{\\max}}{2} = E_{\\max} \\cdot \\frac{EC_{50}}{K_{D} + EC_{50}}$$\n假设 $E_{\\max} \\neq 0$，我们可以将等式两边同除以 $E_{\\max}$：\n$$\\frac{1}{2} = \\frac{EC_{50}}{K_{D} + EC_{50}}$$\n$$K_{D} + EC_{50} = 2 \\cdot EC_{50}$$\n$$K_{D} = EC_{50}$$\n这表明，对于一个简单的非协同结合模型，微观解离常数 $K_D$ 等同于宏观效能参数 $EC_{50}$。\n\n通过将配体浓度 $L$ 等同于一般药物浓度 $C$，最终的稳态输入-输出关系式为：\n$$E(C) = E_{\\max} \\frac{C}{EC_{50} + C}$$\n这个方程是标准的简单 $E_{\\max}$ 模型，它是希尔方程 $E(C) = \\frac{E_{\\max} \\cdot C^n}{EC_{50}^n + C^n}$ 在希尔系数 $n=1$ 时的特例。问题给出的 $n=1$ 的值与这个从非协同结合的第一性原理推导出的结果是一致的。\n\n现在，我们使用给定的参数：$E_{\\max} = 100$ 单位和 $EC_{50} = 2$ mg/L，来计算在给定浓度下的 $E$ 值。\n模型为：\n$$E(C) = 100 \\frac{C}{2 + C}$$\n\n1.  对于 $C = 1$ mg/L：\n    $$E(1) = 100 \\cdot \\frac{1}{2 + 1} = 100 \\cdot \\frac{1}{3} = 33.333... \\text{ 单位}$$\n    四舍五入到四位有效数字，我们得到 $E(1) = 33.33$ 单位。\n\n2.  对于 $C = 2$ mg/L：\n    $$E(2) = 100 \\cdot \\frac{2}{2 + 2} = 100 \\cdot \\frac{2}{4} = 100 \\cdot \\frac{1}{2} = 50 \\text{ 单位}$$\n    正如预期的，当 $C = EC_{50}$ 时，效应恰好是 $E_{\\max}$ 的一半。\n    用四位有效数字表示，得到 $E(2) = 50.00$ 单位。\n\n3.  对于 $C = 8$ mg/L：\n    $$E(8) = 100 \\cdot \\frac{8}{2 + 8} = 100 \\cdot \\frac{8}{10} = 80 \\text{ 单位}$$\n    用四位有效数字表示，得到 $E(8) = 80.00$ 单位。\n\n在浓度 $C=1$、$C=2$ 和 $C=8$ mg/L 时，计算出的效应 $E$ 值分别为 $33.33$、$50.00$ 和 $80.00$ 单位。", "answer": "$$\n\\boxed{\\begin{pmatrix} 33.33  50.00  80.00 \\end{pmatrix}}\n$$", "id": "4374362"}, {"introduction": "在基础受体模型之上，我们现在将探讨系统层面的特性如何导致药物的结合亲和力与其观察到的效能之间出现脱节。本实践引入了激动剂作用的操作模型，以剖析部分效能和受体储备的概念 [@problem_id:4378030]。通过这一推导，你将理解为何某些药物仅占据一小部分受体就能产生最大效应，这是药物设计和效应解读中的一个关键概念。", "problem": "考虑一个作用于均相室中单一受体群体的部分激动剂。假设配体结合遵循质量作用定律，得到受体占有率 $f(C)=\\frac{C}{K_{A}+C}$，其中 $C$ 是游离配体浓度，$K_{A}$ 是平衡解离常数。设总受体浓度为 $R_{T}$，激动剂的内在效能为 $\\epsilon$（无量纲），因此由已占用的受体产生的近端刺激为 $S(C)=\\epsilon R_{T} f(C)$。下游信号传导通过一个从刺激 $S$ 到观测效应 $E$ 的可饱和希尔型转导映射来描述，\n$$\nE(C)=E_{0}+E_{\\text{sys}}\\frac{S(C)^{n}}{K_{E}^{n}+S(C)^{n}},\n$$\n其中 $E_{0}$ 是基线效应，$E_{\\text{sys}}$ 是系统的最大转导能力，$K_{E}$ 是与 $S$ 具有相同单位的转导标度参数，$n$ 是反映信号协同性的希尔系数。定义该激动剂的观测最大效应为 $E_{\\max}^{\\text{obs}}=\\lim_{C\\to\\infty}E(C)$。\n\n将备用受体情况下的半数最大效应浓度 (EC50)，即 $\\mathrm{EC50}_{\\text{reserve}}$，定义为满足\n$$\nE(C)=E_{0}+\\frac{1}{2}\\big(E_{\\max}^{\\text{obs}}-E_{0}\\big).\n$$\n的浓度 $C$。同时，将无备用受体情况下的基线半数最大效应浓度，即 $\\mathrm{EC50}_{\\text{no-reserve}}$，定义为当转导模块在整个占有率范围内实际上未饱和时（形式上为 $K_{E}\\to\\infty$）$\\mathrm{EC50}_{\\text{reserve}}$ 的极限值。仅使用上述定义和质量作用定律，首先推导一个用 $K_{A}$、$R_{T}$、$\\epsilon$、$K_{E}$ 和 $n$ 表示的 $\\mathrm{EC50}_{\\text{reserve}}$ 的解析表达式。然后，使用此表达式，计算由备用受体引起的效价倍数变化，\n$$\n\\phi=\\frac{\\mathrm{EC50}_{\\text{reserve}}}{\\mathrm{EC50}_{\\text{no-reserve}}},\n$$\n其中参数集为 $K_{A}=50\\,\\text{nM}$、$R_{T}=100\\,\\text{nM}$、$\\epsilon=0.3$、$K_{E}=10\\,\\text{nM}$ 和 $n=1$。将 $\\phi$ 的最终答案四舍五入到4位有效数字，并以无单位小数形式表示。", "solution": "问题陈述经评估是有效的，因为它基于系统药理学的既定原则，具有科学依据，在数学上是适定的，并且没有矛盾或含糊不清之处。\n\n任务是首先推导备用受体情况下半数最大效应浓度 $\\mathrm{EC50}_{\\text{reserve}}$ 的表达式，然后对给定的参数集计算效价的倍数变化 $\\phi = \\frac{\\mathrm{EC50}_{\\text{reserve}}}{\\mathrm{EC50}_{\\text{no-reserve}}}$。\n\n首先，我们推导观测最大效应 $E_{\\max}^{\\text{obs}}$ 的表达式。这被定义为当配体浓度 $C$ 趋近于无穷大时效应 $E(C)$ 的极限。\n$$\nE_{\\max}^{\\text{obs}} = \\lim_{C\\to\\infty} E(C) = \\lim_{C\\to\\infty} \\left(E_{0}+E_{\\text{sys}}\\frac{S(C)^{n}}{K_{E}^{n}+S(C)^{n}}\\right)\n$$\n为求此极限，我们首先求近端刺激 $S(C)$ 的极限。刺激由 $S(C) = \\epsilon R_{T} f(C)$ 给出，其中 $f(C) = \\frac{C}{K_{A}+C}$ 是受体占有率。\n当 $C \\to \\infty$ 时，占有率 $f(C)$ 趋近于 $1$：\n$$\n\\lim_{C\\to\\infty} f(C) = \\lim_{C\\to\\infty} \\frac{C}{K_{A}/C+1} = 1\n$$\n因此，最大刺激 $S_{\\max}$ 为：\n$$\nS_{\\max} = \\lim_{C\\to\\infty} S(C) = \\epsilon R_{T} \\lim_{C\\to\\infty} f(C) = \\epsilon R_{T}\n$$\n将此代入 $E_{\\max}^{\\text{obs}}$ 的表达式中，得出：\n$$\nE_{\\max}^{\\text{obs}} = E_{0}+E_{\\text{sys}}\\frac{(\\epsilon R_{T})^{n}}{K_{E}^{n}+(\\epsilon R_{T})^{n}}\n$$\n\n接下来，我们使用 $\\mathrm{EC50}_{\\text{reserve}}$ 的定义，即产生介于基线 $E_{0}$ 和观测最大值 $E_{\\max}^{\\text{obs}}$ 之间中点效应的浓度 $C$。令 $C = \\mathrm{EC50}_{\\text{reserve}}$，条件为：\n$$\nE(\\mathrm{EC50}_{\\text{reserve}}) = E_{0}+\\frac{1}{2}\\left(E_{\\max}^{\\text{obs}}-E_{0}\\right)\n$$\n代入 $E(C)$ 和 $E_{\\max}^{\\text{obs}}-E_{0}$ 的表达式：\n$$\nE_{0}+E_{\\text{sys}}\\frac{S(\\mathrm{EC50}_{\\text{reserve}})^{n}}{K_{E}^{n}+S(\\mathrm{EC50}_{\\text{reserve}})^{n}} = E_{0}+\\frac{1}{2} E_{\\text{sys}}\\frac{(\\epsilon R_{T})^{n}}{K_{E}^{n}+(\\epsilon R_{T})^{n}}\n$$\n通过消去 $E_{0}$ 和 $E_{\\text{sys}}$（假设 $E_{\\text{sys}} \\neq 0$），我们得到一个关于 $\\mathrm{EC50}_{\\text{reserve}}$ 处刺激的方程，我们将其记为 $S_{50} = S(\\mathrm{EC50}_{\\text{reserve}})$：\n$$\n\\frac{S_{50}^{n}}{K_{E}^{n}+S_{50}^{n}} = \\frac{1}{2} \\frac{(\\epsilon R_{T})^{n}}{K_{E}^{n}+(\\epsilon R_{T})^{n}}\n$$\n为了解出 $S_{50}^{n}$，我们重新整理该方程。\n$$\n2 S_{50}^{n} (K_{E}^{n}+(\\epsilon R_{T})^{n}) = (\\epsilon R_{T})^{n} (K_{E}^{n}+S_{50}^{n})\n$$\n$$\n2 S_{50}^{n} K_{E}^{n} + 2 S_{50}^{n} (\\epsilon R_{T})^{n} = (\\epsilon R_{T})^{n} K_{E}^{n} + (\\epsilon R_{T})^{n} S_{50}^{n}\n$$\n$$\n2 S_{50}^{n} K_{E}^{n} + S_{50}^{n} (\\epsilon R_{T})^{n} = (\\epsilon R_{T})^{n} K_{E}^{n}\n$$\n$$\nS_{50}^{n} (2 K_{E}^{n} + (\\epsilon R_{T})^{n}) = K_{E}^{n} (\\epsilon R_{T})^{n}\n$$\n$$\nS_{50}^{n} = \\frac{K_{E}^{n} (\\epsilon R_{T})^{n}}{2 K_{E}^{n} + (\\epsilon R_{T})^{n}}\n$$\n取 n 次方根，我们得到 $S_{50}$ 的表达式：\n$$\nS_{50} = K_{E} \\left( \\frac{(\\epsilon R_{T})^{n}}{2 K_{E}^{n} + (\\epsilon R_{T})^{n}} \\right)^{1/n}\n$$\n现在我们使用刺激的定义 $S(C) = \\epsilon R_{T} \\frac{C}{K_{A}+C}$ 将 $S_{50}$ 与 $\\mathrm{EC50}_{\\text{reserve}}$ 联系起来。\n$$\nS_{50} = \\epsilon R_{T} \\frac{\\mathrm{EC50}_{\\text{reserve}}}{K_{A}+\\mathrm{EC50}_{\\text{reserve}}}\n$$\n解出 $\\mathrm{EC50}_{\\text{reserve}}$：\n$$\nS_{50}(K_{A}+\\mathrm{EC50}_{\\text{reserve}}) = \\epsilon R_{T} \\mathrm{EC50}_{\\text{reserve}}\n$$\n$$\nS_{50}K_{A} = (\\epsilon R_{T} - S_{50}) \\mathrm{EC50}_{\\text{reserve}}\n$$\n$$\n\\mathrm{EC50}_{\\text{reserve}} = K_{A} \\frac{S_{50}}{\\epsilon R_{T} - S_{50}}\n$$\n这就是 $\\mathrm{EC50}_{\\text{reserve}}$ 的解析表达式。\n\n接下来，我们推导 $\\mathrm{EC50}_{\\text{no-reserve}}$ 的表达式，它对应于 $K_{E} \\to \\infty$ 的极限。我们首先计算当 $K_{E} \\to \\infty$ 时 $S_{50}$ 的极限。\n$$\n\\lim_{K_{E}\\to\\infty} S_{50} = \\lim_{K_{E}\\to\\infty} K_{E} \\left( \\frac{(\\epsilon R_{T})^{n}}{2 K_{E}^{n} + (\\epsilon R_{T})^{n}} \\right)^{1/n} = \\lim_{K_{E}\\to\\infty} K_{E} \\left( \\frac{(\\epsilon R_{T}/K_{E})^{n}}{2 + (\\epsilon R_{T}/K_{E})^{n}} \\right)^{1/n}\n$$\n$$\n= \\lim_{K_{E}\\to\\infty} K_{E} \\frac{\\epsilon R_{T}/K_{E}}{(2 + (\\epsilon R_{T}/K_{E})^{n})^{1/n}} = \\lim_{K_{E}\\to\\infty} \\frac{\\epsilon R_{T}}{(2 + (\\epsilon R_{T}/K_{E})^{n})^{1/n}} = \\frac{\\epsilon R_{T}}{2^{1/n}}\n$$\n现在，我们通过对 $\\mathrm{EC50}_{\\text{reserve}}$ 的表达式取极限来求 $\\mathrm{EC50}_{\\text{no-reserve}}$：\n$$\n\\mathrm{EC50}_{\\text{no-reserve}} = \\lim_{K_{E}\\to\\infty} \\mathrm{EC50}_{\\text{reserve}} = K_{A} \\frac{\\lim_{K_{E}\\to\\infty} S_{50}}{\\epsilon R_{T} - \\lim_{K_{E}\\to\\infty} S_{50}}\n$$\n$$\n\\mathrm{EC50}_{\\text{no-reserve}} = K_{A} \\frac{\\frac{\\epsilon R_{T}}{2^{1/n}}}{\\epsilon R_{T} - \\frac{\\epsilon R_{T}}{2^{1/n}}} = K_{A} \\frac{\\frac{1}{2^{1/n}}}{1 - \\frac{1}{2^{1/n}}} = K_{A} \\frac{1}{2^{1/n}-1}\n$$\n现在我们对给定的参数 $K_{A}=50\\,\\text{nM}$、$R_{T}=100\\,\\text{nM}$、$\\epsilon=0.3$、$K_{E}=10\\,\\text{nM}$ 和 $n=1$ 计算倍数变化 $\\phi = \\frac{\\mathrm{EC50}_{\\text{reserve}}}{\\mathrm{EC50}_{\\text{no-reserve}}}$。\n\n对于 $n=1$，表达式得以简化。首先，计算最大刺激：\n$$\n\\epsilon R_{T} = 0.3 \\times 100\\,\\text{nM} = 30\\,\\text{nM}\n$$\n达到半数最大效应时的刺激 $S_{50}$ 变为：\n$$\nS_{50} = K_{E} \\frac{\\epsilon R_{T}}{2 K_{E} + \\epsilon R_{T}} = (10\\,\\text{nM}) \\frac{30\\,\\text{nM}}{2(10\\,\\text{nM}) + 30\\,\\text{nM}} = 10 \\frac{30}{20+30}\\,\\text{nM} = 10 \\frac{30}{50}\\,\\text{nM} = 6\\,\\text{nM}\n$$\n现在我们可以计算 $\\mathrm{EC50}_{\\text{reserve}}$：\n$$\n\\mathrm{EC50}_{\\text{reserve}} = K_{A} \\frac{S_{50}}{\\epsilon R_{T} - S_{50}} = (50\\,\\text{nM}) \\frac{6\\,\\text{nM}}{30\\,\\text{nM} - 6\\,\\text{nM}} = 50 \\frac{6}{24}\\,\\text{nM} = 50 \\times \\frac{1}{4}\\,\\text{nM} = 12.5\\,\\text{nM}\n$$\n接下来，我们计算 $n=1$ 时的 $\\mathrm{EC50}_{\\text{no-reserve}}$：\n$$\n\\mathrm{EC50}_{\\text{no-reserve}} = K_{A} \\frac{1}{2^{1/1}-1} = K_{A} \\frac{1}{2-1} = K_{A} = 50\\,\\text{nM}\n$$\n最后，我们计算倍数变化 $\\phi$：\n$$\n\\phi = \\frac{\\mathrm{EC50}_{\\text{reserve}}}{\\mathrm{EC50}_{\\text{no-reserve}}} = \\frac{12.5\\,\\text{nM}}{50\\,\\text{nM}} = 0.25\n$$\n题目要求将答案四舍五入到4位有效数字。\n$$\n\\phi = 0.2500\n$$", "answer": "$$\\boxed{0.2500}$$", "id": "4378030"}, {"introduction": "系统药理学的目标不仅是为生物通路建模，更是要理解其控制节点。最后一个实践将介绍灵敏度分析，这是一种强大的计算方法，用于识别信号网络中哪些参数对系统输出的影响最大 [@problem_id:4378068]。通过计算参数的弹性，你将亲身体验这项对于识别新药靶点和预测网络扰动如何影响细胞反应至关重要的技术。", "problem": "考虑一个系统药理学中的最小药效学（Pharmacodynamics, PD）信号模块，该模块通过质量作用动力学和可饱和转导将药物-受体相互作用映射到下游效应。假设浓度为 $D$ 的药物与总浓度为 $R_{\\mathrm{tot}}$ 的受体结合形成复合物 $C$，其参数为结合速率 $k_{\\mathrm{on}}$ 和解离速率 $k_{\\mathrm{off}}$。该复合物以生成速率 $k_{\\mathrm{cat}}$ 和降解速率 $k_{\\mathrm{deg}}$ 激活效应物种 $X$。下游效应 $E$ 是 $X$ 的一个可饱和函数，具有最大效应 $E_{\\max}$ 和半饱和常数 $EC_{50}$。除动态变量 $C$ 和 $X$ 外，所有量均假定为正值且不随时间变化。假设药物浓度 $D$ 不会耗尽并保持恒定。\n\n从质量作用定律和受体守恒出发，该系统的常微分方程（Ordinary Differential Equations, ODEs）为：\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}}\\, D\\, (R_{\\mathrm{tot}} - C) - k_{\\mathrm{off}}\\, C,\n$$\n$$\n\\frac{dX}{dt} = k_{\\mathrm{cat}}\\, C - k_{\\mathrm{deg}}\\, X.\n$$\n下游效应建模如下：\n$$\nE(X) = \\frac{E_{\\max}\\, X}{EC_{50} + X}.\n$$\n您必须计算在稳态下，效应 $E$ 相对于每个通路参数 $p \\in \\{k_{\\mathrm{on}}, k_{\\mathrm{off}}, R_{\\mathrm{tot}}, D, k_{\\mathrm{cat}}, k_{\\mathrm{deg}}, E_{\\max}, EC_{50}\\}$ 的无量纲弹性（归一化灵敏度），其定义为：\n$$\n\\mathcal{S}_p = \\frac{\\partial E}{\\partial p}\\cdot\\frac{p}{E},\n$$\n在给定的参数集下，于稳态效应 $E^\\ast$ 处进行评估。\n\n为确保数值稳定性和普适性，使用中心有限差分法来估计 $\\frac{\\partial E}{\\partial p}$，其中对参数 $p$ 应用一个小的乘性扰动 $h$：\n- 使用 $h = 10^{-6}$。\n- 对于每个参数 $p$，在保持所有其他参数固定的情况下，分别在 $p(1+h)$ 和 $p(1-h)$ 处评估 $E$。\n- 使用乘性扰动下的弹性中心差分近似，可简化为：\n$$\n\\mathcal{S}_p \\approx \\frac{E\\big|_{p(1+h)} - E\\big|_{p(1-h)}}{2\\,h\\,E\\big|_{p}}.\n$$\n\n单位：\n- $D$ 和 $R_{\\mathrm{tot}}$ 的单位是纳摩尔（nM）。\n- $k_{\\mathrm{on}}$ 的单位是 $(\\mathrm{nM}\\cdot \\mathrm{s})^{-1}$。\n- $k_{\\mathrm{off}}$、$k_{\\mathrm{cat}}$ 和 $k_{\\mathrm{deg}}$ 的单位是 $\\mathrm{s}^{-1}$。\n- $X$ 和 $EC_{50}$ 的单位是 nM。\n- $E_{\\max}$ 和 $E$ 的单位是任意效应单位（a.u.）。\n您计算出的弹性 $\\mathcal{S}_p$ 是无量纲的。\n\n供参考，在给定的常微分方程下，稳态由 $dC/dt = 0$ 和 $dX/dt = 0$ 定义。没有提供显式公式；请从第一性原理推导出所有需要的量。\n\n实现一个程序，对于下述测试套件中的每个参数集，计算弹性列表 $[\\mathcal{S}_{k_{\\mathrm{on}}}, \\mathcal{S}_{k_{\\mathrm{off}}}, \\mathcal{S}_{R_{\\mathrm{tot}}}, \\mathcal{S}_{D}, \\mathcal{S}_{k_{\\mathrm{cat}}}, \\mathcal{S}_{k_{\\mathrm{deg}}}, \\mathcal{S}_{E_{\\max}}, \\mathcal{S}_{EC_{50}}]$ 以及该列表中具有最大绝对弹性值的参数的索引（整数），其中索引遵循刚才列出的参数顺序（从 0 开始）。\n\n测试套件（每个案例都是一个有序的参数元组 $(k_{\\mathrm{on}}, k_{\\mathrm{off}}, R_{\\mathrm{tot}}, D, k_{\\mathrm{cat}}, k_{\\mathrm{deg}}, E_{\\max}, EC_{50})$）：\n1. 标称操作状态（正常路径）：$(1.0\\times 10^{-3}, 1.0\\times 10^{-2}, 100.0, 50.0, 0.5, 0.1, 1.0, 20.0)$。\n2. 饱和药物浓度：$(1.0\\times 10^{-3}, 1.0\\times 10^{-2}, 100.0, 10000.0, 0.5, 0.1, 1.0, 20.0)$。\n3. 低受体可用性边界：$(1.0\\times 10^{-3}, 1.0\\times 10^{-2}, 1.0, 50.0, 0.5, 0.1, 1.0, 20.0)$。\n4. 快速效应物转换边界：$(1.0\\times 10^{-3}, 1.0\\times 10^{-2}, 100.0, 50.0, 0.5, 10.0, 1.0, 20.0)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果本身必须是一个列表，其中包含按指定顺序排列的八个弹性值，后跟具有最大绝对弹性值的参数的整数索引。例如：\n\"[[e11,e12,e13,e14,e15,e16,e17,e18,i1],[e21,e22,e23,e24,e25,e26,e27,e28,i2],...]\".\n所有数值输出必须是原始的十进制浮点数，不附带任何单位。不涉及角度。不涉及百分比。", "solution": "用户提供的问题陈述已经过仔细验证，并被确定为**有效**。该问题具有科学依据、自成体系且定义明确。任务是计算药效学（PD）效应相对于其底层模型参数在稳态下的无量纲弹性。\n\n解决方案主要分两个阶段进行：首先，推导系统变量的稳态表达式；其次，设计一个数值算法来计算所需的弹性。\n\n### 1. 药效学模型的稳态分析\n\n该系统由一组耦合的常微分方程（ODEs）描述，用于描述药物-受体复合物 $C$ 和下游效应物 $X$ 的浓度。\n\n第一个常微分方程控制药物-受体复合物 $C$ 的形成和解离：\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}}\\, D\\, (R_{\\mathrm{tot}} - C) - k_{\\mathrm{off}}\\, C\n$$\n在稳态下，变化率为零，即 $\\frac{dC}{dt} = 0$。我们求解稳态浓度 $C^\\ast$：\n$$\nk_{\\mathrm{on}}\\, D\\, (R_{\\mathrm{tot}} - C^\\ast) - k_{\\mathrm{off}}\\, C^\\ast = 0\n$$\n$$\nk_{\\mathrm{on}}\\, D\\, R_{\\mathrm{tot}} - k_{\\mathrm{on}}\\, D\\, C^\\ast - k_{\\mathrm{off}}\\, C^\\ast = 0\n$$\n$$\nk_{\\mathrm{on}}\\, D\\, R_{\\mathrm{tot}} = (k_{\\mathrm{on}}\\, D + k_{\\mathrm{off}})\\, C^\\ast\n$$\n分离出 $C^\\ast$ 可得：\n$$\nC^\\ast = \\frac{k_{\\mathrm{on}}\\, D\\, R_{\\mathrm{tot}}}{k_{\\mathrm{on}}\\, D + k_{\\mathrm{off}}}\n$$\n通过引入平衡解离常数 $K_D = k_{\\mathrm{off}}/k_{\\mathrm{on}}$，该表达式可以被简化，从而得到熟悉的用于受体占用的 Hill-Langmuir 方程：\n$$\nC^\\ast = \\frac{R_{\\mathrm{tot}}\\, D}{K_D + D}\n$$\n\n第二个常微分方程描述了效应物种 $X$ 的转换，它以与 $C$ 成正比的速率生成，并进行一级降解：\n$$\n\\frac{dX}{dt} = k_{\\mathrm{cat}}\\, C - k_{\\mathrm{deg}}\\, X\n$$\n在稳态下，$\\frac{dX}{dt} = 0$，因此我们可以使用先前求得的 $C^\\ast$ 来求解稳态浓度 $X^\\ast$：\n$$\nk_{\\mathrm{cat}}\\, C^\\ast - k_{\\mathrm{deg}}\\, X^\\ast = 0\n$$\n$$\nX^\\ast = \\frac{k_{\\mathrm{cat}}}{k_{\\mathrm{deg}}}\\, C^\\ast\n$$\n代入 $C^\\ast$ 的表达式：\n$$\nX^\\ast = \\frac{k_{\\mathrm{cat}}}{k_{\\mathrm{deg}}} \\left( \\frac{k_{\\mathrm{on}}\\, D\\, R_{\\mathrm{tot}}}{k_{\\mathrm{on}}\\, D + k_{\\mathrm{off}}} \\right)\n$$\n\n最后，下游生物效应 $E$ 是 $X$ 的一个可饱和函数，由以下公式给出：\n$$\nE(X) = \\frac{E_{\\max}\\, X}{EC_{50} + X}\n$$\n稳态效应 $E^\\ast$ 可通过将 $X^\\ast$ 代入此方程求得：\n$$\nE^\\ast = \\frac{E_{\\max}\\, X^\\ast}{EC_{50} + X^\\ast}\n$$\n这个关于 $E^\\ast$ 的复合函数提供了从所有参数集 $p \\in \\{k_{\\mathrm{on}}, k_{\\mathrm{off}}, R_{\\mathrm{tot}}, D, k_{\\mathrm{cat}}, k_{\\mathrm{deg}}, E_{\\max}, EC_{50}\\}$ 到稳态系统输出的完整解析映射。该函数是我们分析的计算核心。\n\n### 2. 数值弹性计算\n\n问题要求计算效应 $E$ 相对于每个参数 $p$ 的无量纲弹性（或归一化灵敏度）。弹性 $\\mathcal{S}_p$ 定义为 $E$ 的分数变化与 $p$ 的分数变化之比：\n$$\n\\mathcal{S}_p = \\frac{\\partial E}{\\partial p}\\cdot\\frac{p}{E} = \\frac{\\partial \\ln E}{\\partial \\ln p}\n$$\n问题没有采用对复杂的 $E^\\ast$ 表达式进行直接解析微分的方法，而是指定了一种使用中心有限差分近似的数值方法。应用于每个参数 $p$ 的扰动是乘性的，扰动因子 $h = 10^{-6}$ 很小。弹性的计算公式如下：\n$$\n\\mathcal{S}_p \\approx \\frac{E\\big|_{p(1+h)} - E\\big|_{p(1-h)}}{2\\,h\\,E\\big|_{p}}\n$$\n该公式在标称参数值处数值估算了对数导数 $\\frac{\\partial \\ln E}{\\partial \\ln p}$。\n\n### 3. 算法实现\n\n整体算法实现为一个函数，用于处理每个测试案例（一组特定的参数）。\n\n1.  定义一个核心函数 `calculate_E_ss(params)`。该函数接收一个包含八个参数的元组作为输入，并通过实现在第 1 节中推导的解析公式来返回稳态效应 $E^\\ast$。\n\n2.  对于提供的每个测试案例：\n    a. 取标称参数向量 $P_{nominal} = (k_{\\mathrm{on}}, k_{\\mathrm{off}}, \\dots, EC_{50})$。\n    b. 计算基线效应 $E_{nominal} = \\text{calculate\\_E\\_ss}(P_{nominal})$。\n    c. 循环遍历 $P_{nominal}$ 中的每个参数 $p_i$，其中 $i \\in \\{0, 1, \\dots, 7\\}$。\n    d. 在循环内部，对于每个参数 $p_i$：\n        i. 生成两个受扰动的参数向量：\n           - $P_{plus}$，其第 $i$ 个元素为 $p_i(1+h)$。\n           - $P_{minus}$，其第 $i$ 个元素为 $p_i(1-h)$。\n        ii. 计算相应的效应 $E_{plus} = \\text{calculate\\_E\\_ss}(P_{plus})$ 和 $E_{minus} = \\text{calculate\\_E\\_ss}(P_{minus})$。\n        iii. 使用中心差分公式计算弹性 $\\mathcal{S}_{p_i}$：\n            $$\n            \\mathcal{S}_{p_i} = \\frac{E_{plus} - E_{minus}}{2 \\cdot h \\cdot E_{nominal}}\n            $$\n            鉴于所有参数都指定为正值，$E_{nominal}$ 将不为零，从而避免了除以零的错误。\n        iv. 将计算出的弹性存储在一个列表中。\n    e. 循环结束后，获得一个对应于八个参数的八个弹性值的列表。\n    f. 取这些弹性值的绝对值，并确定最大绝对值的索引。该索引对应于系统效应最敏感的参数。\n    g. 将此索引附加到弹性列表中，形成该测试案例的完整结果。\n\n3.  收集所有测试案例的结果，并按照问题陈述中指定的格式将其格式化为单个字符串，每个测试案例的结果表示为一个包含九个数字（八个弹性值和一个索引）的列表。\n\n这种结构化的数值方法能够稳健而准确地估计系统的灵敏度，而无需对完整的稳态响应函数进行复杂且容易出错的解析微分。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the systems pharmacology elasticity problem for a given test suite.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is an ordered tuple of parameters:\n    # (k_on, k_off, R_tot, D, k_cat, k_deg, E_max, EC50)\n    test_cases = [\n        (1.0e-3, 1.0e-2, 100.0, 50.0, 0.5, 0.1, 1.0, 20.0),\n        (1.0e-3, 1.0e-2, 100.0, 10000.0, 0.5, 0.1, 1.0, 20.0),\n        (1.0e-3, 1.0e-2, 1.0, 50.0, 0.5, 0.1, 1.0, 20.0),\n        (1.0e-3, 1.0e-2, 100.0, 50.0, 0.5, 10.0, 1.0, 20.0),\n    ]\n\n    h = 1.0e-6  # Multiplicative perturbation factor\n\n    def calculate_E_ss(params):\n        \"\"\"\n        Calculates the steady-state aeffect E* based on the model equations.\n        \n        Args:\n            params (tuple): A tuple of the 8 model parameters in the specified order.\n\n        Returns:\n            float: The steady-state effect E*.\n        \"\"\"\n        k_on, k_off, R_tot, D, k_cat, k_deg, E_max, EC50 = params\n        \n        # Calculate steady-state complex concentration C*\n        # C* = (k_on * D * R_tot) / (k_on * D + k_off)\n        # All parameters are positive, so no division by zero here.\n        C_ss = (k_on * D * R_tot) / (k_on * D + k_off)\n        \n        # Calculate steady-state effector concentration X*\n        # X* = (k_cat / k_deg) * C*\n        # k_deg is positive, so no division by zero.\n        X_ss = (k_cat / k_deg) * C_ss\n        \n        # Calculate steady-state effect E*\n        # E* = (E_max * X_ss) / (EC50 + X_ss)\n        # EC50 and X_ss are positive, so no division by zero.\n        E_ss = (E_max * X_ss) / (EC50 + X_ss)\n        \n        return E_ss\n\n    def compute_elasticities_for_case(case_params):\n        \"\"\"\n        Computes the list of elasticities and the index of the max absolute elasticity\n        for a single parameter set.\n        \n        Args:\n            case_params (tuple): A tuple of the 8 model parameters.\n            \n        Returns:\n            list: A list containing 8 float elasticities and 1 integer index.\n        \"\"\"\n        num_params = len(case_params)\n        params_nominal = list(case_params)\n        \n        E_nominal = calculate_E_ss(params_nominal)\n        \n        elasticities = []\n        \n        for i in range(num_params):\n            p_i = params_nominal[i]\n            \n            # Perturb parameter p_i positively\n            params_plus = params_nominal[:]\n            params_plus[i] = p_i * (1 + h)\n            E_plus = calculate_E_ss(params_plus)\n            \n            # Perturb parameter p_i negatively\n            params_minus = params_nominal[:]\n            params_minus[i] = p_i * (1 - h)\n            E_minus = calculate_E_ss(params_minus)\n            \n            # Calculate elasticity using the central finite difference formula\n            if E_nominal == 0:\n                # This case should not be reached given positive parameters,\n                # but it's a safe guard. If E is 0, elasticity is undefined\n                # or 0 if the numerator is also 0.\n                elasticity = 0.0\n            else:\n                elasticity = (E_plus - E_minus) / (2 * h * E_nominal)\n            \n            elasticities.append(elasticity)\n            \n        # Find the index of the parameter with the largest absolute elasticity\n        if elasticities:\n            max_abs_elasticity_idx = np.argmax(np.abs(np.array(elasticities)))\n        else:\n            max_abs_elasticity_idx = -1 # Should not happen\n\n        result_for_case = elasticities + [int(max_abs_elasticity_idx)]\n        \n        return result_for_case\n\n    # Process all test cases\n    results = []\n    for case in test_cases:\n        result_list = compute_elasticities_for_case(case)\n        # Format the list of numbers into a string like \"[num1,num2,...]\"\n        # Corrected line to ensure full floating-point precision\n        result_string = f\"[{','.join([f'{v:.17g}' for v in result_list[:-1]] + [str(result_list[-1])])}]\"\n        results.append(result_string)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Example: \"[[e1,e2,i1],[f1,f2,i2]]\"\n    # The `results` list already contains strings like `\"[e1,e2,i1]\"`.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "answer": "[[0.1428571428571428,-0.1428571428571428,0.1428571428571428,0.1428571428571428,1,-1,1,-0.7142857142857142,4],[-0.0009900990099009901,-0.99009900990099,0.009900990099009901,0.0009900990099009901,1,-1,1,-0.7142857142857142,4],[0.1428571428571428,-0.1428571428571428,0.9857142857142858,0.1428571428571428,1,-1,1,-0.014285714285714285,4],[0.1379310344827586,-0.1379310344827586,0.9998000199980002,0.1379310344827586,1,-1,1,-0.00019998000199980002,4]]", "id": "4378068"}]}