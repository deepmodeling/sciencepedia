{"hands_on_practices": [{"introduction": "在将中心性度量应用于复杂的现实世界网络之前，通过分析其在基本图结构上的行为来建立直觉至关重要。[@problem_id:4327511] 这项练习要求您从第一性原理出发，为三种原型图——完全图 ($K_n$)、路径图 ($P_n$) 和星形图 ($S_n$)——推导度、接近度和介数中心性。掌握这些推导将为在更复杂的生物学背景下解释中心性提供坚实的理论基础。", "problem": "在系统生物医学中，典型的相互作用模式会反复出现：稳定复合物内的全对全绑定、信号级联中的线性传递，以及围绕主调节器的中心辐射型组织。分别用具有$n$个标记节点的完全图$K_{n}$、路径图$P_{n}$和星形图$S_{n}$来对这些模式建模，其中所有图都是简单、无向、无权的，并且$n \\geq 3$。对于$P_{n}$，将路径上的节点从一端到另一端用$i \\in \\{1,2,\\dots,n\\}$进行索引；对于$S_{n}$，区分唯一的中心节点和$n-1$个叶节点。\n\n仅从以下关于一个具有$n$个节点的连通图的核心定义出发：\n- 节点$v$的度中心性是其度$k_{v}$。\n- 节点$v$的接近中心性是 $C_{C}(v) = \\dfrac{n-1}{\\sum_{u \\neq v} d(v,u)}$，其中$d(v,u)$是$v$和$u$之间的最短路径距离。\n- 节点$v$的介数中心性是 $C_{B}(v) = \\sum_{\\substack{\\{s,t\\} \\subset V \\\\ s \\neq v,\\, t \\neq v}} \\dfrac{\\sigma_{st}(v)}{\\sigma_{st}}$，其中$\\sigma_{st}$是$s$和$t$之间的最短路径数量，而$\\sigma_{st}(v)$是这些路径中经过$v$的数量，\n\n完成以下任务：\n- 通过从第一性原理出发，计算必要的距离和最短路径数量，为$K_{n}$、$P_{n}$和$S_{n}$中的每一类节点推导出度中心性、接近中心性和介数中心性的精确表达式，这些表达式是关于$n$（以及在适用时关于$i$）的函数。\n- 使用你推导出的表达式，确定极限的精确值\n$$\n\\lim_{n \\to \\infty} \\frac{\\max_{v \\in V(S_{n})} C_{B}(v)}{\\max_{w \\in V(P_{n})} C_{B}(w)}.\n$$\n\n从定义出发，证明所有步骤的合理性。将最终答案表示为单个实数。不需要四舍五入。", "solution": "经评估，问题陈述有效。它在科学上基于图论的既定原则，特别是关于中心性度量的原则。该问题提法明确，为度中心性、接近中心性和介数中心性提供了精确、标准的定义。所考虑的图——完全图$K_n$、路径图$P_n$和星形图$S_n$——是明确定义的数学对象。该问题是自洽的、客观的，其任务可以根据给定的定义进行计算。不存在矛盾、歧义或事实错误。因此，我们可以进行完整的推导。\n\n任务是为$n \\geq 3$时的$K_n$、$P_n$和$S_n$中的所有节点类别推导度中心性、接近中心性和介数中心性，然后计算一个特定的极限。\n\n### 第1部分：完全图，$K_n$\n\n在完全图$K_n$中，每对不同的节点都由一条边连接。由于图的完美对称性，所有$n$个节点都属于同一个等价类。设$v$为$K_n$中的任意节点。\n\n- **度中心性 ($k_v$)：**\n节点$v$与其他所有$n-1$个节点相连。\n$$\nk_v = n-1\n$$\n\n- **接近中心性 ($C_C(v)$)：**\n任意两个不同节点$v$和$u$之间的最短路径距离$d(v,u)$为$1$，因为它们直接相连。从$v$到所有其他节点的距离之和为：\n$$\n\\sum_{u \\neq v} d(v,u) = \\sum_{u \\neq v} 1 = n-1\n$$\n根据接近中心性的定义：\n$$\nC_C(v) = \\frac{n-1}{\\sum_{u \\neq v} d(v,u)} = \\frac{n-1}{n-1} = 1\n$$\n\n- **介数中心性 ($C_B(v)$)：**\n考虑任意一对不同节点$\\{s, t\\}$，其中$s \\neq v$且$t \\neq v$。$s$和$t$之间的最短路径是直接边$(s,t)$，其长度为$1$。最短路径的数量为$\\sigma_{st} = 1$。由于该路径不经过任何中间节点，因此$s$和$t$之间经过$v$的最短路径数量为$\\sigma_{st}(v) = 0$。\n对所有此类节点对求和：\n$$\nC_B(v) = \\sum_{\\substack{\\{s,t\\} \\subset V \\\\ s \\neq v,\\, t \\neq v}} \\frac{\\sigma_{st}(v)}{\\sigma_{st}} = \\sum_{\\substack{\\{s,t\\} \\subset V \\\\ s \\neq v,\\, t \\neq v}} \\frac{0}{1} = 0\n$$\n\n### 第2部分：路径图，$P_n$\n\n在路径图$P_n$中，节点排列成一条线。我们用$i \\in \\{1, 2, \\dots, n\\}$来索引它们。节点$i$和$n-i+1$是对称的。\n\n- **度中心性 ($k_i$)：**\n两个端点（节点$1$和$n$）各自连接到另一个节点。任何内部节点$i$（其中$1  i  n$）都连接到两个邻居，$i-1$和$i+1$。\n$$\nk_i = \\begin{cases} 1   \\text{当 } i=1 \\text{ 或 } i=n \\text{ 时} \\\\ 2   \\text{当 } 1  i  n \\text{ 时} \\end{cases}\n$$\n\n- **接近中心性 ($C_C(i)$)：**\n节点$i$和节点$j$之间的最短路径距离为$d(i,j) = |i-j|$。从节点$i$到所有其他节点的距离之和为：\n$$\n\\sum_{j \\neq i} d(i,j) = \\sum_{j=1}^{i-1} |i-j| + \\sum_{j=i+1}^{n} |i-j| = \\sum_{j=1}^{i-1} (i-j) + \\sum_{j=i+1}^{n} (j-i)\n$$\n这些是等差数列的和：$\\sum_{k=1}^{m} k = \\frac{m(m+1)}{2}$。\n$$\n\\sum_{j \\neq i} d(i,j) = \\frac{(i-1)i}{2} + \\frac{(n-i)(n-i+1)}{2}\n$$\n因此，节点$i$的接近中心性为：\n$$\nC_C(i) = \\frac{n-1}{\\frac{(i-1)i}{2} + \\frac{(n-i)(n-i+1)}{2}} = \\frac{2(n-1)}{i^2-i + (n-i)(n-i+1)}\n$$\n\n- **介数中心性 ($C_B(i)$)：**\n在路径图中，任意两个节点$s$和$t$之间的最短路径是唯一的，因此对所有$\\{s,t\\}$都有$\\sigma_{st} = 1$。$s$和$t$之间的最短路径经过第三个节点$i$当且仅当$i$位于它们之间的路径上。这种情况发生在$s  i  t$或$t  i  s$时。\n如果$i$在唯一路径上，则项$\\frac{\\sigma_{st}(i)}{\\sigma_{st}}$为$1$，否则为$0$。因此，$C_B(i)$是满足$i$位于它们之间的节点对$\\{s,t\\}$的数量。要形成这样的一个节点对，我们必须从$\\{1, ..., i-1\\}$中选择一个节点（有$i-1$个选择），并从$\\{i+1, ..., n\\}$中选择一个节点（有$n-i$个选择）。\n这种节点对的数量是选择数量的乘积。\n$$\nC_B(i) = (i-1)(n-i)\n$$\n\n### 第3部分：星形图，$S_n$\n\n星形图$S_n$（或$K_{1,n-1}$）有两类节点：一个中心节点（$v_h$）和$n-1$个外围叶节点（$v_l$）。\n\n- **度中心性：**\n中心节点连接到所有$n-1$个叶节点。每个叶节点只连接到中心节点。\n$$\nk_{v_h} = n-1\n$$\n$$\nk_{v_l} = 1\n$$\n\n- **接近中心性：**\n对于中心节点$v_h$：它到任何叶节点的距离都是$1$。\n$$\n\\sum_{u \\neq v_h} d(v_h,u) = \\sum_{l=1}^{n-1} d(v_h, v_l) = \\sum_{l=1}^{n-1} 1 = n-1\n$$\n$$\nC_C(v_h) = \\frac{n-1}{n-1} = 1\n$$\n对于一个叶节点$v_l$：它到中心节点的距离是$1$。它到其他$n-2$个叶节点中的任何一个的距离都是$2$（通过路径$v_l \\to v_h \\to v_{l'}$）。\n$$\n\\sum_{u \\neq v_l} d(v_l,u) = d(v_l, v_h) + \\sum_{v_{l'} \\neq v_l, v_h} d(v_l, v_{l'}) = 1 + (n-2) \\times 2 = 1 + 2n-4 = 2n-3\n$$\n$$\nC_C(v_l) = \\frac{n-1}{2n-3}\n$$\n\n- **介数中心性：**\n对于一个叶节点$v_l$：任何经过$v_l$的最短路径都必须以$v_l$为起点或终点，因为任何其他路径都必须通过中心节点进入和离开$v_l$（$... \\to v_h \\to v_l \\to v_h \\to ...$），而这并非最短路径。根据定义，介数中心性只考虑与$v_l$不同的节点$s,t$之间的路径。因此，对于所有有效的节点对$\\{s,t\\}$，$\\sigma_{st}(v_l) = 0$。\n$$\nC_B(v_l) = 0\n$$\n对于中心节点$v_h$：我们考虑的节点对$\\{s,t\\}$中，$s$和$t$都不是$v_h$。这意味着$s$和$t$都必须是叶节点。任意两个叶节点$s$和$t$之间的最短路径是唯一的（$\\sigma_{st}=1$），形式为$s \\to v_h \\to t$。这条路径总是经过中心节点。因此，$\\sigma_{st}(v_h) = 1$。对于每一对叶节点，比率$\\frac{\\sigma_{st}(v_h)}{\\sigma_{st}} = 1$。\n总介数是叶节点对的数量。有$n-1$个叶节点。\n$$\nC_B(v_h) = \\binom{n-1}{2} = \\frac{(n-1)(n-2)}{2}\n$$\n\n### 第4部分：极限计算\n\n我们需要计算 $\\lim_{n \\to \\infty} \\frac{\\max_{v \\in V(S_{n})} C_{B}(v)}{\\max_{w \\in V(P_{n})} C_{B}(w)}$。\n\n首先，我们求出$S_n$和$P_n$的最大介数中心性。\n\n对于$S_n$，叶节点的中心性为$0$，中心节点的中心性为$\\frac{(n-1)(n-2)}{2}$。\n$$\n\\max_{v \\in V(S_n)} C_B(v) = \\frac{(n-1)(n-2)}{2}\n$$\n\n对于$P_n$，节点$i$的中心性为$C_B(i) = (i-1)(n-i)$。这是一个关于$i$的二次函数，在路径的中心处取得最大值。抛物线$f(x) = (x-1)(n-x)$的顶点在$x = \\frac{n+1}{2}$。\n如果$n$是奇数，设$n=2k+1$。最大值在整数$i = \\frac{2k+1+1}{2} = k+1$处取得。\n$$\n\\max C_B(P_n) = ((k+1)-1)(n-(k+1)) = k(2k+1-k-1) = k^2 = \\left(\\frac{n-1}{2}\\right)^2 = \\frac{n^2-2n+1}{4}\n$$\n如果$n$是偶数，设$n=2k$。最大值在$i=k$和$i=k+1$处取得。\n$$\n\\max C_B(P_n) = (k-1)(n-k) = (k-1)(2k-k) = k(k-1) = \\frac{n}{2}\\left(\\frac{n}{2}-1\\right) = \\frac{n(n-2)}{4} = \\frac{n^2-2n}{4}\n$$\n\n现在我们计算极限。我们可以分别分析$n$为奇数和偶数的情况。当$n \\to \\infty$时，关于$n$的多项式的首项决定了渐近行为。\n\n让我们构建比率 $R(n) = \\frac{\\max_{v \\in V(S_{n})} C_{B}(v)}{\\max_{w \\in V(P_{n})} C_{B}(w)}$。\n\n情况1：$n$ 为奇数时。\n$$\nR(n) = \\frac{\\frac{(n-1)(n-2)}{2}}{\\frac{(n-1)^2}{4}} = \\frac{4(n-1)(n-2)}{2(n-1)^2} = \\frac{2(n-2)}{n-1} = \\frac{2n - 4}{n-1}\n$$\n$$\n\\lim_{n \\to \\infty} R(n) = \\lim_{n \\to \\infty} \\frac{2n - 4}{n-1} = \\lim_{n \\to \\infty} \\frac{2 - 4/n}{1 - 1/n} = \\frac{2-0}{1-0} = 2\n$$\n\n情况2：$n$ 为偶数时。\n$$\nR(n) = \\frac{\\frac{(n-1)(n-2)}{2}}{\\frac{n(n-2)}{4}} = \\frac{4(n-1)(n-2)}{2n(n-2)} = \\frac{2(n-1)}{n} = \\frac{2n-2}{n}\n$$\n$$\n\\lim_{n \\to \\infty} R(n) = \\lim_{n \\to \\infty} \\frac{2n-2}{n} = \\lim_{n \\to \\infty} \\frac{2 - 2/n}{1} = \\frac{2-0}{1} = 2\n$$\n由于奇数$n$子序列和偶数$n$子序列的极限都为$2$，因此总极限存在且等于$2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "4327511"}, {"introduction": "生物过程（如信号级联反应）通常被建模为信息从源头流向目标的有向无环图 (DAG)。[@problem_id:4327549] 这项实践将介数中心性的概念应用于一个假设的信号网络，以量化中间节点的重要性。您将学习如何计算最短路径的数量，并确定通过特定节点的路径所占的比例，从而为衡量其对信号转导的影响提供一个具体的度量。", "problem": "考虑一个系统生物医学中简化的有向信号网络，该网络模拟了从受体通过接头和激酶中间体到转录因子的激活流。该网络是一个有向无环图（DAG），其边长为单位长度，代表单步、无权重的相互作用。设顶点集为 $V = \\{S, T, X, W, Y, Z, M\\}$，其中 $S$ 是受体，$T$ 是转录因子，$X$、$W$、$Y$、$Z$、$M$ 是中间体。有向边集为\n$$\nE = \\{S \\to X,\\ S \\to W,\\ X \\to Y,\\ X \\to Z,\\ X \\to M,\\ W \\to Y,\\ W \\to Z,\\ Y \\to T,\\ Z \\to T,\\ M \\to T\\}.\n$$\n假设在单位长度的假定下，从 $S$ 到 $T$ 的生物信号遵循最短有向路径。\n\n仅使用关于最短有向路径和路径计数的第一性原理，确定从 $S$ 到 $T$ 的不同最短有向路径的总数 $\\sigma_{st}$，并对每个中间节点 $i \\in \\{X, W, Y, Z, M\\}$，确定经过 $i$ 的最短有向路径数量 $\\sigma_{st}(i)$。由此，推导出中间体的点对特异性介数份额，其定义为穿过每个中间体的最短 $S \\to T$ 路径所占的比例。\n\n作为最终答案，报告节点 $Z$ 的介数份额，表示为最简分数。无需四舍五入，最终答案框中不报告单位。", "solution": "该问题要求计算给定有向信号网络中中间节点 $Z$ 的点对特异性介数份额。这被定义为从源节点 $S$ 到目标节点 $T$ 的所有最短有向路径中，经过 $Z$ 的路径所占的比例。该网络是一个边长为单位长度的有向无环图（DAG）。解答将从第一性原理出发。\n\n设给定的顶点集为 $V = \\{S, T, X, W, Y, Z, M\\}$，边集为 $E = \\{S \\to X,\\ S \\to W,\\ X \\to Y,\\ X \\to Z,\\ X \\to M,\\ W \\to Y,\\ W \\to Z,\\ Y \\to T,\\ Z \\to T,\\ M \\to T\\}$。\n\n首先，我们确定从源节点 $S$ 到网络中所有其他节点的最短路径长度。由于所有边的单位长度均为 $1$，最短路径长度就是形成路径所需的最少边数。这可以通过从 $S$ 开始的广度优先搜索（BFS）找到。设 $d(S, v)$ 表示从 $S$ 到任意节点 $v \\in V$ 的最短路径距离。\n\n距离计算如下：\n$d(S, S) = 0$。\n$S$ 的邻居是 $X$ 和 $W$。因此，$d(S, X) = 1$ 且 $d(S, W) = 1$。\n$X$ 的邻居是 $Y$、$Z$ 和 $M$。$W$ 的邻居是 $Y$ 和 $Z$。\n$d(S, Y) = \\min(d(S, X) + 1, d(S, W) + 1) = \\min(1+1, 1+1) = 2$。\n$d(S, Z) = \\min(d(S, X) + 1, d(S, W) + 1) = \\min(1+1, 1+1) = 2$。\n$d(S, M) = d(S, X) + 1 = 1+1 = 2$。\n$Y$、$Z$ 和 $M$ 的邻居都连接到 $T$。\n$d(S, T) = \\min(d(S, Y) + 1, d(S, Z) + 1, d(S, M) + 1) = \\min(2+1, 2+1, 2+1) = 3$。\n从 $S$ 到 $T$ 的最短路径长度是 $d(S, T) = 3$。\n\n接下来，我们计算从 $S$ 到 $T$ 的不同最短路径的总数，记为 $\\sigma_{st}$。设 $\\sigma_{Sv}$ 为从 $S$ 到节点 $v$ 的最短路径数量。对于DAG，这可以递归计算。根据定义，$\\sigma_{SS} = 1$。对于任何其他节点 $v$，从 $S$ 出发的最短路径数量是到其前驱节点 $u$ 的最短路径数量之和，其中这些前驱节点 $u$ 位于到 $v$ 的一条最短路径上，即满足 $d(S, v) = d(S, u) + 1$ 的前驱节点。\n\n$\\sigma_{SX} = \\sigma_{SS} = 1$。\n$\\sigma_{SW} = \\sigma_{SS} = 1$。\n$Y$ 的前驱节点是 $X$ 和 $W$。由于 $d(S,Y)=2$，$d(S,X)=1$ 且 $d(S,W)=1$，两者都位于到 $Y$ 的最短路径上。因此，$\\sigma_{SY} = \\sigma_{SX} + \\sigma_{SW} = 1 + 1 = 2$。\n$Z$ 的前驱节点是 $X$ 和 $W$。类似地，$\\sigma_{SZ} = \\sigma_{SX} + \\sigma_{SW} = 1 + 1 = 2$。\n$M$ 的唯一前驱节点是 $X$。因此，$\\sigma_{SM} = \\sigma_{SX} = 1$。\n最后，$T$ 的前驱节点是 $Y$、$Z$ 和 $M$。由于 $d(S,T)=3$，$d(S,Y)=2$，$d(S,Z)=2$ 且 $d(S,M)=2$，这三个节点都位于到 $T$ 的最短路径上。\n$\\sigma_{st} = \\sigma_{ST} = \\sigma_{SY} + \\sigma_{SZ} + \\sigma_{SM} = 2 + 2 + 1 = 5$。\n从 $S$ 到 $T$ 有 $5$ 条不同的最短路径。\n\n经过中间节点 $i$ 的从 $S$ 到 $T$ 的最短路径数量，记为 $\\sigma_{st}(i)$，可以在 $i$ 至少位于一条最短路径上的情况下计算。这个条件是 $d(S,T) = d(S,i) + d(i,T)$。我们需要为所有中间体找到 $d(i,T)$。这可以通过反转所有边并从 $T$ 开始运行BFS，或者通过观察来完成。\n$d(Y,T)=1$, $d(Z,T)=1$, $d(M,T)=1$。\n$d(X,T) = 1 + \\min(d(Y,T), d(Z,T), d(M,T)) = 1+1=2$。\n$d(W,T) = 1 + \\min(d(Y,T), d(Z,T)) = 1+1=2$。\n对于节点 $Z$，$d(S,Z) + d(Z,T) = 2 + 1 = 3 = d(S,T)$。所以，$Z$ 位于最短路径上。\n对于任何这样的节点 $i$，经过它的最短路径数量由DAG的乘法法则给出：$\\sigma_{st}(i) = \\sigma_{Si} \\times \\sigma_{iT}$，其中 $\\sigma_{iT}$ 是从 $i$ 到 $T$ 的最短路径数量。\n\n我们需要计算 $\\sigma_{iT}$。\n$\\sigma_{TT} = 1$（根据定义）。\n$\\sigma_{YT} = \\sigma_{TT} = 1$。\n$\\sigma_{ZT} = \\sigma_{TT} = 1$。\n$\\sigma_{MT} = \\sigma_{TT} = 1$。\n\n现在，我们可以找到我们感兴趣的节点 $Z$ 的值。\n我们已经计算出 $\\sigma_{SZ} = 2$。\n我们也已经得到 $\\sigma_{ZT} = 1$。\n使用乘法法则，从 $S$ 到 $T$ 经过 $Z$ 的最短路径数量为：\n$\\sigma_{st}(Z) = \\sigma_{SZ} \\times \\sigma_{ZT} = 2 \\times 1 = 2$。\n\n节点 $Z$ 的点对特异性介数份额是比率 $\\frac{\\sigma_{st}(Z)}{\\sigma_{st}}$。\n使用推导出的值：\n$Z$ 的介数份额 = $\\frac{2}{5}$。\n这个分数已经是其最简形式。\n为了完整起见，我们可以计算其他中间体的份额。\n$\\sigma_{st}(X) = \\sigma_{SX} \\times \\sigma_{XT} = 1 \\times (\\sigma_{YT}+\\sigma_{ZT}+\\sigma_{MT}) = 1 \\times (1+1+1) = 3$。份额是 $\\frac{3}{5}$。\n$\\sigma_{st}(W) = \\sigma_{SW} \\times \\sigma_{WT} = 1 \\times (\\sigma_{YT}+\\sigma_{ZT}) = 1 \\times (1+1) = 2$。份额是 $\\frac{2}{5}$。\n$\\sigma_{st}(Y) = \\sigma_{SY} \\times \\sigma_{YT} = 2 \\times 1 = 2$。份额是 $\\frac{2}{5}$。\n$\\sigma_{st}(M) = \\sigma_{SM} \\times \\sigma_{MT} = 1 \\times 1 = 1$。份额是 $\\frac{1}{5}$。\n问题明确要求节点 $Z$ 的介数份额。\n最终结果是 $\\frac{2}{5}$。", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "4327549"}, {"introduction": "现实世界中的生物网络很少是完全连通的；它们通常由不同的模块或组件构成。这种碎片化为标准的中心性度量（如接近中心性）带来了挑战。[@problem_id:4327521] 这项动手练习通过要求您在一个非连通的基因调控网络上计算和比较两种版本的接近中心性——经典定义 ($C_C(i)$) 和调和变体 ($C_H(i)$)——来探讨这个问题。通过分析它们之间的差异，您将更深入地理解如何为模块化或碎片化的系统选择和恰当解释中心性指标。", "problem": "给定一个有向无权图，代表一个基因调控网络 (Gene Regulatory Network, GRN)，其中某些节点对应于转录因子 (Transcription Factors, TF)。该图有 $10$ 个节点，索引从 $0$ 到 $9$。有向边表示调控影响。请按照以下纯图论术语进行操作。\n\n使用的基本基础和定义：\n- 从节点 $i$ 到节点 $j$ 的有向路径是指一系列从 $i$ 开始并在 $j$ 结束的有向边。最短路径距离 $d(i,j)$ 是从 $i$ 到 $j$ 的任何有向路径上的最小边数。如果不存在这样的有向路径，则定义 $d(i,j) = +\\infty$。\n- 对于一个节点 $i$，令 $R(i)$ 表示可通过至少一条有限长度的有向路径从 $i$ 到达的节点集合 $j \\neq i$。令 $r_i = |R(i)|$ 为从 $i$ 可达的节点数（不包括 $i$ 本身）。\n- 通过调整可达性，为不连通有向图定义接近中心性 $C_C(i)$：\n  $$C_C(i) = \\begin{cases}\n  \\dfrac{r_i}{\\sum\\limits_{j \\in R(i)} d(i,j)}   \\text{若 } r_i  0, \\\\[6pt]\n  0   \\text{若 } r_i = 0.\n  \\end{cases}$$\n- 定义调和接近中心性 $C_H(i)$ 为：\n  $$C_H(i) = \\sum_{\\substack{j=0 \\\\ j \\neq i}}^{9} \\frac{1}{d(i,j)}, \\quad \\text{其中 } \\frac{1}{+\\infty} \\equiv 0.$$\n\n图的规格（边是序偶 $(u,v)$，表示从 $u$ 到 $v$ 的一条边）：\n- 模块 A：$(0,1)$, $(1,2)$, $(2,3)$, $(3,1)$。\n- 模块 B：$(4,5)$。\n- 模块 C：$(6,7)$, $(7,8)$。\n- 节点 $9$ 是孤立的（没有入边或出边）。\n\n转录因子 (TF) 节点：索引为 $0,1,4,5,6,7,9$。\n\n任务：\n1. 对于每个 TF 节点 $i \\in \\{0,1,4,5,6,7,9\\}$，仅使用上述定义和有向图中的距离计算 $C_C(i)$ 和 $C_H(i)$。\n2. 对于每个 TF 节点，计算差值\n   $$D(i) = C_H(i) - C_C(i)。$$\n3. 从图可达性和距离的第一性原理出发，解释为什么在部分不连通的图中 $C_H(i)$ 和 $C_C(i)$ 会出现差异，以及 $D(i)$ 的大小如何反映一个 TF 是嵌入在较大的可达子模块中，还是孤立在小子模块中或作为一个汇点。\n\n测试套件和要求的输出：\n- 使用上面指定的单个图，以 TF 集合 $\\{0,1,4,5,6,7,9\\}$ 作为测试套件，该套件涵盖：\n  - 循环子图中的一般情况（例如，$0,1$），\n  - 包含一个汇点的小型双节点子模块（例如，$4,5$），\n  - 线性链（例如，$6,7$），\n  - 完全孤立的节点（例如，$9$）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，并严格按照 TF 节点 $[0,1,4,5,6,7,9]$ 的顺序，为每个 TF 提供三元组：\n  $$\\big[C_C(0), C_H(0), D(0), C_C(1), C_H(1), D(1), C_C(4), C_H(4), D(4), C_C(5), C_H(5), D(5), C_C(6), C_H(6), D(6), C_C(7), C_H(7), D(7), C_C(9), C_H(9), D(9)\\big].$$\n- 所有浮点数必须精确到小数点后 $6$ 位。\n\n最终输出格式：\n- 单行输出上述列表，例如：\n  - \"[0.123456,0.654321,0.530865,...]\"，每个数字无空格且小数点后恰好有 $6$ 位数字。", "solution": "该问题是有效的，因为它具有科学依据、定义明确且客观。它为待计算的量提供了完整的图规格和精确的数学定义。我们接下来进行完整解答。\n\n主要目标是计算并分析给定有向图中一组指定转录因子 (TF) 节点的两种中心性度量：接近中心性 ($C_C$) 和调和接近中心性 ($C_H$)。分析涉及计算这些度量、它们的差值 $D(i) = C_H(i) - C_C(i)$，并基于图结构对其差异提供原理性解释。\n\n**1. 图分析与最短路径距离**\n\n该图由10个节点（索引0到9）和一组有向边定义。其结构由三个不连通分量和一个孤立节点组成：\n- **模块A**：节点 $\\{0, 1, 2, 3\\}$，边为 $(0,1), (1,2), (2,3), (3,1)$。该模块包含一个环 $1 \\to 2 \\to 3 \\to 1$。\n- **模块B**：节点 $\\{4, 5\\}$，边为 $(4,5)$。\n- **模块C**：节点 $\\{6, 7, 8\\}$，边为 $(6,7), (7,8)$。\n- **孤立节点**：节点 $\\{9\\}$。\n\n为了计算中心性度量，我们首先需要从每个 TF 节点 $i$ 到所有其他节点 $j$ 的最短路径距离 $d(i,j)$。对于一个无权有向图，这些距离可以通过从每个节点 $i$ 开始使用广度优先搜索 (Breadth-First Search, BFS) 算法来高效计算。如果节点 $j$ 从节点 $i$ 不可达，距离 $d(i,j)$ 定义为 $+\\infty$。\n\n指定的 TF 节点为 $\\{0, 1, 4, 5, 6, 7, 9\\}$。我们将为这些节点中的每一个计算必要的距离。\n\n**2. TF 节点的中心性计算**\n\n我们为每个 TF 节点 $i$ 系统地计算 $C_C(i)$ 和 $C_H(i)$。\n\n**对于 TF 节点 $i=0$：**\n- 从 $0$ 可达的节点集合是 $R(0) = \\{1, 2, 3\\}$。可达节点数为 $r_0 = |R(0)| = 3$。\n- 最短路径距离为：$d(0,1) = 1$, $d(0,2) = 2$, $d(0,3) = 3$。\n- 到可达节点的距离之和为 $\\sum_{j \\in R(0)} d(0,j) = 1 + 2 + 3 = 6$。\n- 接近中心性：$C_C(0) = \\dfrac{r_0}{\\sum_{j \\in R(0)} d(0,j)} = \\dfrac{3}{6} = 0.5$。\n- 调和接近中心性：$C_H(0) = \\sum_{j \\neq 0} \\frac{1}{d(0,j)} = \\frac{1}{d(0,1)} + \\frac{1}{d(0,2)} + \\frac{1}{d(0,3)} = \\frac{1}{1} + \\frac{1}{2} + \\frac{1}{3} = \\frac{6+3+2}{6} = \\frac{11}{6} \\approx 1.833333$。\n- 差值：$D(0) = C_H(0) - C_C(0) = \\frac{11}{6} - \\frac{1}{2} = \\frac{8}{6} = \\frac{4}{3} \\approx 1.333333$。\n\n**对于 TF 节点 $i=1$：**\n- 从 $1$ 可达的节点集合是 $R(1) = \\{2, 3\\}$。可达节点数为 $r_1 = |R(1)| = 2$。\n- 最短路径距离为：$d(1,2) = 1$, $d(1,3) = 2$。\n- 距离之和：$\\sum_{j \\in R(1)} d(1,j) = 1 + 2 = 3$。\n- 接近中心性：$C_C(1) = \\dfrac{r_1}{\\sum_{j \\in R(1)} d(1,j)} = \\dfrac{2}{3} \\approx 0.666667$。\n- 调和接近中心性：$C_H(1) = \\sum_{j \\neq 1} \\frac{1}{d(1,j)} = \\frac{1}{d(1,2)} + \\frac{1}{d(1,3)} = \\frac{1}{1} + \\frac{1}{2} = \\frac{3}{2} = 1.5$。\n- 差值：$D(1) = C_H(1) - C_C(1) = \\frac{3}{2} - \\frac{2}{3} = \\frac{9-4}{6} = \\frac{5}{6} \\approx 0.833333$。\n\n**对于 TF 节点 $i=4$：**\n- 从 $4$ 可达的节点集合是 $R(4) = \\{5\\}$。可达节点数为 $r_4 = |R(4)| = 1$。\n- 最短路径距离为：$d(4,5) = 1$。\n- 距离之和：$\\sum_{j \\in R(4)} d(4,j) = 1$。\n- 接近中心性：$C_C(4) = \\dfrac{r_4}{\\sum_{j \\in R(4)} d(4,j)} = \\dfrac{1}{1} = 1.0$。\n- 调和接近中心性：$C_H(4) = \\sum_{j \\neq 4} \\frac{1}{d(4,j)} = \\frac{1}{d(4,5)} = \\frac{1}{1} = 1.0$。\n- 差值：$D(4) = C_H(4) - C_C(4) = 1.0 - 1.0 = 0.0$。\n\n**对于 TF 节点 $i=5$：**\n- 节点 $5$ 是一个汇点；它没有出边。\n- 可达节点集合是 $R(5) = \\emptyset$。可达节点数为 $r_5 = 0$。\n- 接近中心性：根据定义，$C_C(5) = 0$。\n- 调和接近中心性：$C_H(5) = \\sum_{j \\neq 5} \\frac{1}{d(5,j)} = 0$，因为对于 $j \\neq 5$，所有 $d(5,j) = +\\infty$。\n- 差值：$D(5) = C_H(5) - C_C(5) = 0.0 - 0.0 = 0.0$。\n\n**对于 TF 节点 $i=6$：**\n- 从 $6$ 可达的节点集合是 $R(6) = \\{7, 8\\}$。可达节点数为 $r_6 = |R(6)| = 2$。\n- 最短路径距离为：$d(6,7) = 1$, $d(6,8) = 2$。\n- 距离之和：$\\sum_{j \\in R(6)} d(6,j) = 1 + 2 = 3$。\n- 接近中心性：$C_C(6) = \\dfrac{r_6}{\\sum_{j \\in R(6)} d(6,j)} = \\dfrac{2}{3} \\approx 0.666667$。\n- 调和接近中心性：$C_H(6) = \\sum_{j \\neq 6} \\frac{1}{d(6,j)} = \\frac{1}{d(6,7)} + \\frac{1}{d(6,8)} = \\frac{1}{1} + \\frac{1}{2} = 1.5$。\n- 差值：$D(6) = C_H(6) - C_C(6) = \\frac{3}{2} - \\frac{2}{3} = \\frac{5}{6} \\approx 0.833333$。\n\n**对于 TF 节点 $i=7$：**\n- 从 $7$ 可达的节点集合是 $R(7) = \\{8\\}$。可达节点数为 $r_7 = |R(7)| = 1$。\n- 最短路径距离为：$d(7,8) = 1$。\n- 距离之和：$\\sum_{j \\in R(7)} d(7,j) = 1$。\n- 接近中心性：$C_C(7) = \\dfrac{r_7}{\\sum_{j \\in R(7)} d(7,j)} = \\dfrac{1}{1} = 1.0$。\n- 调和接近中心性：$C_H(7) = \\sum_{j \\neq 7} \\frac{1}{d(7,j)} = \\frac{1}{d(7,8)} = \\frac{1}{1} = 1.0$。\n- 差值：$D(7) = C_H(7) - C_C(7) = 1.0 - 1.0 = 0.0$。\n\n**对于 TF 节点 $i=9$：**\n- 节点 $9$ 是孤立的。\n- 可达节点集合是 $R(9) = \\emptyset$。可达节点数为 $r_9 = 0$。\n- 接近中心性：根据定义，$C_C(9) = 0$。\n- 调和接近中心性：$C_H(9) = \\sum_{j \\neq 9} \\frac{1}{d(9,j)} = 0$，因为对于 $j \\neq 9$，所有 $d(9,j) = +\\infty$。\n- 差值：$D(9) = C_H(9) - C_C(9) = 0.0 - 0.0 = 0.0$。\n\n**3. $C_C(i)$ 和 $C_H(i)$ 之间差异的分析**\n\n两种中心性度量 $C_C(i)$ 和 $C_H(i)$ 可能会有显著差异，尤其是在非强连通图中。这种差异源于它们根本上不同的数学公式以及它们对可达性的处理方式。\n\n**基本定义：**\n- 接近中心性 $C_C(i) = \\frac{r_i}{\\sum_{j \\in R(i)} d(i,j)}$ 是到可达节点距离的算术平均值的倒数，即 $(\\frac{1}{r_i}\\sum_{j \\in R(i)} d(i,j))^{-1}$。它完全忽略了不可达节点，仅关注节点可达分量内的平均路径长度。\n- 调和接近中心性 $C_H(i) = \\sum_{j \\neq i} \\frac{1}{d(i,j)}$ 是到所有其他节点距离倒数之和。约定 $\\frac{1}{+\\infty} \\equiv 0$ 确保不可达节点对总和的贡献为零，从而有效地将它们包含在计算框架中，但影响为空。\n\n**差异的来源：**\n差异 $D(i) = C_H(i) - C_C(i)$ 是算术平均值和调和平均值之间不等式的直接结果。对于有限距离集合 $\\{d(i,j) | j \\in R(i)\\}$，算术平均值总是大于或等于调和平均值。这意味着当一个节点可以到达多个不同距离的目标时，$C_H(i)$ 通常大于 $C_C(i)$。差值 $D(i)$ 的大小表明，在这两种不同视角下，一个节点的可达子模块的结构如何影响其中心性得分。\n\n**基于图结构的 $D(i)$ 解释：**\n\n1.  **孤立节点或汇点 ($D(i) = 0$)：**\n    对于节点 $5$ 和 $9$（分别为汇点和孤立节点），可达集合 $R(i)$ 为空，因此 $r_i=0$。$C_C(i)$ 和 $C_H(i)$ 的计算结果都为 $0$，因此 $D(i)=0$。这反映了它们缺乏影响力；两种度量都认同它们的中心性为零。\n\n2.  **小而简单的可达子模块 ($D(i) = 0$)：**\n    对于节点 $4$ 和 $7$，每个节点只能到达另一个节点（$r_4=1, r_7=1$），距离为 $1$。在这种情况下，$C_C(i) = \\frac{1}{1} = 1$ 且 $C_H(i) = \\frac{1}{1} = 1$，导致 $D(i) = 0$。当一个节点只能到达另一个节点时，“平均距离”就是那一个距离，“距离倒数之和”就是那一个距离的倒数。此时，$C_C(i)=1/d$ 且 $C_H(i)=1/d$。推广来说，当 $r_i=1$ 时，$C_C(i)$ 和 $C_H(i)$ 总是相等的，得到 $D(i)=0$。没有差异表明其作用非常简单，影响力有限。\n\n3.  **嵌入在较大可达子模块中的 TF ($D(i) > 0$)：**\n    对于节点 $0$、$1$ 和 $6$，$D(i)$ 显著大于 $0$。这是因为它们可以到达多个不同距离的节点 ($r_i > 1$)。\n    - $C_C(i)$ 对长距离很敏感。通过取平均值，一个非常遥远的节点就可以显著降低中心性得分。\n    - $C_H(i)$ 对附近的节点给予不成比例的高权重（由于倒数 $1/d$），而受远处节点的影响较小。它奖励节点建立的每一个连接，尤其是近处的连接。\n    - 对于节点 $1$（$r_1=2$，距离为 $\\{1,2\\}$）和节点 $6$（$r_6=2$，距离为 $\\{1,2\\}$），其度量值相同：$C_C = 2/3$ 和 $C_H=1.5$，得出 $D \\approx 0.833333$。这个正差值反映了它们双节点可达集的不平凡结构。\n    - 对于节点 $0$（$r_0=3$，距离为 $\\{1,2,3\\}$），差异更大：$D(0) \\approx 1.333333$。与 $D(1)$ 和 $D(6)$ 相比，$D(0)$ 的值更大，这正确地反映了节点 $0$ 在其局部环境中“更中心”；它可以到达更多的节点（$r_0=3$ vs. $r_1=r_6=2$）。因此，$D(i)$ 的大小可作为 TF 能影响的子模块的大小 ($r_i$) 和复杂性（距离的方差）的指标。一个更大的 $D(i)$ 表明该 TF 是一个更大、更复杂的下游网络模块的关键入口点或调控者。\n\n```python\nimport numpy as np\nfrom collections import deque\n\ndef solve():\n    \"\"\"\n    Computes and analyzes centrality measures for TF nodes in a given GRN graph.\n    \"\"\"\n    \n    # 1. Define the graph and problem parameters\n    NUM_NODES = 10\n    edges = [\n        (0, 1), (1, 2), (2, 3), (3, 1),  # Module A\n        (4, 5),                         # Module B\n        (6, 7), (7, 8)                  # Module C\n    ]\n    \n    # Adjacency list representation of the directed graph\n    adj_list = {i: [] for i in range(NUM_NODES)}\n    for u, v in edges:\n        adj_list[u].append(v)\n        \n    tf_nodes = [0, 1, 4, 5, 6, 7, 9]\n\n    def bfs_shortest_paths(start_node):\n        \"\"\"\n        Computes shortest path distances from a start node using BFS.\n        Returns a dictionary mapping each node to its distance from start_node.\n        \"\"\"\n        distances = {node: np.inf for node in range(NUM_NODES)}\n        \n        # A node might not be in adj_list if it's a sink, but it still exists\n        queue = deque([(start_node, 0)])\n        distances[start_node] = 0\n        \n        while queue:\n            current_node, dist = queue.popleft()\n            \n            # Check if the current node has outgoing edges\n            if current_node in adj_list:\n                for neighbor in adj_list[current_node]:\n                    if distances[neighbor] == np.inf:\n                        distances[neighbor] = dist + 1\n                        queue.append((neighbor, dist + 1))\n        return distances\n\n    final_results = []\n    \n    # 2. Iterate through each TF node and compute metrics\n    for i in tf_nodes:\n        # Compute shortest paths from node i\n        all_distances = bfs_shortest_paths(i)\n        \n        # Identify the set of reachable nodes R(i) and their distances\n        reachable_nodes_distances = {}\n        for j, dist in all_distances.items():\n            if i != j and dist != np.inf:\n                reachable_nodes_distances[j] = dist\n        \n        # Calculate r_i and sum of distances\n        r_i = len(reachable_nodes_distances)\n        sum_of_distances = sum(reachable_nodes_distances.values())\n        \n        # Calculate Closeness Centrality C_C(i)\n        if r_i > 0:\n            c_c = r_i / sum_of_distances\n        else:\n            c_c = 0.0\n            \n        # Calculate Harmonic Closeness Centrality C_H(i)\n        c_h = 0.0\n        for j in range(NUM_NODES):\n            if i == j:\n                continue\n            dist_ij = all_distances[j]\n            if dist_ij != np.inf:\n                c_h += 1.0 / dist_ij\n        \n        # Calculate the difference D(i)\n        d_i = c_h - c_c\n        \n        # Append the triplet of results\n        final_results.extend([c_c, c_h, d_i])\n\n    # 3. Format the final output string\n    # Round all values to exactly 6 decimal places.\n    formatted_strings = [f\"{x:.6f}\" for x in final_results]\n    \n    # print(f\"[{','.join(formatted_strings)}]\")\n\nsolve()\n```", "answer": "[0.500000,1.833333,1.333333,0.666667,1.500000,0.833333,1.000000,1.000000,0.000000,0.000000,0.000000,0.000000,0.666667,1.500000,0.833333,1.000000,1.000000,0.000000,0.000000,0.000000,0.000000]", "id": "4327521"}]}