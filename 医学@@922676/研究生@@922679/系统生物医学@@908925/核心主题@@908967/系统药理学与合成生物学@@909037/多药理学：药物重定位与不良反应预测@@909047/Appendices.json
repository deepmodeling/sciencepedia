{"hands_on_practices": [{"introduction": "多靶点药理学的核心思想是一种药物分子可以与多个生物靶点相互作用。然而，在给定的药物浓度下，药物与不同靶点的结合程度（即占有率）会有所不同，这主要取决于它们各自的亲和力（以解离常数 $K_d$衡量）。本练习将通过计算不同亲和力靶点的分数占有率，帮助您掌握评估药物在生理相关浓度下主要作用靶点的基本方法，这是理解药物选择性和预测其治疗效果与潜在副作用的基础 [@problem_id:4375871]。", "problem": "在强调多重药理学和不良反应预测的系统生物医学框架中，对一个用于药物重定位的小分子候选药物进行评估。假设以下生物物理环境基于单个非协同结合位点的质量作用定律：一个受体 $R$ 与一个配体（游离药物）$L$ 结合，通过 $R + L \\rightleftharpoons RL$ 在平衡状态下形成复合物 $RL$。解离常数 $K_d$ 定义为 $K_d = \\frac{[R][L]}{[RL]}$，分数占据率 $\\theta$ 定义为已结合受体的分数，即 $\\theta = \\frac{[RL]}{[R]_{\\text{tot}}}$，其中 $[R]_{\\text{tot}} = [R] + [RL]$。假设 $[L]$ 等于最大游离血浆浓度 $C_{\\max,\\mathrm{free}}$，因为靶点浓度相对于循环药物浓度较低，因此配体耗尽可以忽略不计。\n\n单次口服剂量产生的 $C_{\\max,\\mathrm{free}} = 150\\ \\mathrm{nM}$。与治疗效果和不良反应均相关的三个分子靶点的解离常数分别为 $K_d \\in \\{30\\ \\mathrm{nM}, 100\\ \\mathrm{nM}, 300\\ \\mathrm{nM}\\}$。\n\n仅使用上述给出的 $K_d$ 的质量作用平衡定义和分数占据率 $\\theta$ 的定义，推导出 $\\theta$ 关于 $[L]$ 和 $K_d$ 的表达式，然后计算在 $[L] = C_{\\max,\\mathrm{free}}$ 时每个靶点的分数占据率。最后，确定在 $C_{\\max,\\mathrm{free}}$ 时哪些靶点的占据率超过 $0.5$。\n\n将您的最终答案表示为一个单行矩阵，其中按顺序包含三个分数占据率，然后是占据率超过 $0.5$ 的靶点的索引，其中索引 $1$ 对应 $K_d = 30\\ \\mathrm{nM}$，索引 $2$ 对应 $K_d = 100\\ \\mathrm{nM}$，索引 $3$ 对应 $K_d = 300\\ \\mathrm{nM}$。请提供精确值，不要四舍五入。", "solution": "首先对问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 结合平衡：$R + L \\rightleftharpoons RL$。\n- 系统特征：平衡状态下的单个非协同结合位点。\n- 解离常数定义：$K_d = \\frac{[R][L]}{[RL]}$。\n- 分数占据率定义：$\\theta = \\frac{[RL]}{[R]_{\\text{tot}}}$。\n- 总受体浓度定义：$[R]_{\\text{tot}} = [R] + [RL]$。\n- 配体浓度假设：$[L]$ 是恒定的，等于 $C_{\\max,\\mathrm{free}}$。\n- 特定配体浓度：$C_{\\max,\\mathrm{free}} = 150\\ \\mathrm{nM}$。\n- 靶点解离常数集合：$K_d \\in \\{30\\ \\mathrm{nM}, 100\\ \\mathrm{nM}, 300\\ \\mathrm{nM}\\}$。\n- 任务要求：\n    1.  推导 $\\theta$ 作为 $[L]$ 和 $K_d$ 的函数。\n    2.  计算在 $[L] = C_{\\max,\\mathrm{free}}$ 时三个靶点各自的 $\\theta$ 值。\n    3.  确定 $\\theta > 0.5$ 的靶点。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据**：该问题基于质量作用定律，这是物理化学和药理学的基石。所给出的解离常数（$K_d$）和分数占据率（$\\theta$）的定义在受体理论领域是标准的。多重药理学和不良反应预测的背景是现代系统生物医学的核心。所有前提都具有科学合理性。\n- **适定性**：该问题提供了执行所需推导和计算所必需的所有定义、常数和变量。目标明确，并能导出一个唯一的、确定性的解。\n- **客观性**：该问题以精确、定量的语言陈述，没有歧义或主观解释。\n\n该问题被发现没有任何缺陷，如科学上不合理、信息缺失或含糊不清。它代表了生物物理化学中一个标准的、可形式化的问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供解答。\n\n第一个任务是推导分数占据率 $\\theta$ 关于配体浓度 $[L]$ 和解离常数 $K_d$ 的表达式。我们从给定的定义开始。\n\n总受体浓度由下式给出：\n$$[R]_{\\text{tot}} = [R] + [RL]$$\n分数占据率 $\\theta$ 是结合的受体-配体复合物浓度 $[RL]$ 与总受体浓度 $[R]_{\\text{tot}}$ 的比值：\n$$\\theta = \\frac{[RL]}{[R]_{\\text{tot}}} = \\frac{[RL]}{[R] + [RL]}$$\n解离常数 $K_d$ 由平衡关系定义：\n$$K_d = \\frac{[R][L]}{[RL]}$$\n根据这个定义，我们可以用其他物种的浓度来表示游离受体浓度 $[R]$：\n$$[R] = \\frac{K_d [RL]}{[L]}$$\n现在，我们将这个 $[R]$ 的表达式代入 $\\theta$ 方程的分母中：\n$$\\theta = \\frac{[RL]}{\\left(\\frac{K_d [RL]}{[L]}\\right) + [RL]}$$\n分数中的每一项都含有 $[RL]$，因此可以通过从分母中提取公因子来消去它：\n$$\\theta = \\frac{[RL]}{[RL] \\left(\\frac{K_d}{[L]} + 1\\right)} = \\frac{1}{\\frac{K_d}{[L]} + 1}$$\n为了简化这个繁分数，我们为主分母中的各项通分：\n$$\\theta = \\frac{1}{\\frac{K_d + [L]}{[L]}}$$\n最后，将分母颠倒，得到所需的表达式，即单个结合位点的 Hill-Langmuir 方程：\n$$\\theta = \\frac{[L]}{[L] + K_d}$$\n下一个任务是使用给定的最大游离血浆浓度 $[L] = C_{\\max,\\mathrm{free}} = 150 \\ \\mathrm{nM}$，计算三个靶点各自的分数占据率。\n\n对于第一个靶点（索引 $1$），$K_{d,1} = 30\\ \\mathrm{nM}$。\n$$\\theta_1 = \\frac{[L]}{[L] + K_{d,1}} = \\frac{150}{150 + 30} = \\frac{150}{180} = \\frac{15}{18} = \\frac{5}{6}$$\n\n对于第二个靶点（索引 $2$），$K_{d,2} = 100\\ \\mathrm{nM}$。\n$$\\theta_2 = \\frac{[L]}{[L] + K_{d,2}} = \\frac{150}{150 + 100} = \\frac{150}{250} = \\frac{15}{25} = \\frac{3}{5}$$\n\n对于第三个靶点（索引 $3$），$K_{d,3} = 300\\ \\mathrm{nM}$。\n$$\\theta_3 = \\frac{[L]}{[L] + K_{d,3}} = \\frac{150}{150 + 300} = \\frac{150}{450} = \\frac{15}{45} = \\frac{1}{3}$$\n\n最后的任务是确定哪些靶点的分数占据率大于 $0.5$，即大于 $\\frac{1}{2}$。\n\n- 对于靶点 $1$，$\\theta_1 = \\frac{5}{6}$。因为 $5 \\times 2 = 10$ 且 $6 \\times 1 = 6$，我们有 $10 > 6$，这意味着 $\\frac{5}{6} > \\frac{1}{2}$。因此，靶点 $1$ 的占据率超过 $0.5$。\n- 对于靶点 $2$，$\\theta_2 = \\frac{3}{5}$。因为 $3 \\times 2 = 6$ 且 $5 \\times 1 = 5$，我们有 $6 > 5$，这意味着 $\\frac{3}{5} > \\frac{1}{2}$。因此，靶点 $2$ 的占据率超过 $0.5$。\n- 对于靶点 $3$，$\\theta_3 = \\frac{1}{3}$。因为 $1 \\times 2 = 2$ 且 $3 \\times 1 = 3$，我们有 $2  3$，这意味着 $\\frac{1}{3}  \\frac{1}{2}$。因此，靶点 $3$ 的占据率未超过 $0.5$。\n\n总之，计算出的分数占据率分别为 $\\theta_1 = \\frac{5}{6}$、$\\theta_2 = \\frac{3}{5}$ 和 $\\theta_3 = \\frac{1}{3}$。占据率超过 $0.5$ 的靶点是索引为 $1$ 和 $2$ 的靶点。\n\n最终答案以单行矩阵形式呈现，其中包含三个分数占据率，然后是占据率超过 $0.5$ 的靶点的索引。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{6}  \\frac{3}{5}  \\frac{1}{3}  1  2\n\\end{pmatrix}\n}\n$$", "id": "4375871"}, {"introduction": "药物与靶点的相互作用不仅关乎其结合的紧密程度（亲和力），还涉及结合与解离的速度（动力学）。靶点占有率随时间的变化，特别是在药物浓度变化的给药和清除阶段，对于区分持久的治疗效果和短暂的副作用至关重要。本练习将引导您从静态的平衡视角转向动态的动力学视角，通过模拟给药和清除过程中的占有率变化，来理解药物-靶点相互作用的“停留时间”概念的重要性 [@problem_id:4375810]。", "problem": "一种用于药物重定位的小分子候选药物通过与两种人类靶点（记为靶点 A 和靶点 B）结合而表现出多靶点药理学特性。假设为单一位点、非协同、可逆结合，遵循质量作用动力学，并且在一个充分混合室中，给药期间游离药物浓度恒定。给药以维持恒定的游离浓度 $C=100\\ \\mathrm{nM}$，持续时间为 $T=2\\ \\mathrm{h}$，之后药物被瞬时洗脱，使得在所有后续时间里 $C$ 变为零。给药开始时，初始靶点占有率为零。动力学参数如下：对于靶点 A，$k_{\\mathrm{on}}=10^{6}\\ \\mathrm{M^{-1}s^{-1}}$ 且 $k_{\\mathrm{off}}=10^{-3}\\ \\mathrm{s^{-1}}$；对于靶点 B，$k_{\\mathrm{on}}=10^{5}\\ \\mathrm{M^{-1}s^{-1}}$ 且 $k_{\\mathrm{off}}=10^{-4}\\ \\mathrm{s^{-1}}$。此处，$k_{\\mathrm{on}}$ 是双分子结合速率常数，$k_{\\mathrm{off}}$ 是解离速率常数。在系统生物医学中，当涉及多个靶点时，靶点占有率保持在某一阈值（例如 $0.5$）以上的连续时间间隔，可以作为衡量靶向疗效与不良反应之间关系的有效替代指标。\n\n从质量作用下的基本可逆结合定律出发，确定在 $T$ 小时给药及随后的洗脱过程中，每个靶点的占有率保持在 $0.5$ 以上的持续时间，然后计算靶点 B 相对于靶点 A 的这些持续时间的比率。将此比率报告为一个无单位的小数，并四舍五入到四位有效数字。", "solution": "### 步骤 1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n-   药物与两种人类靶点结合：靶点 A 和靶点 B。\n-   结合是单一位点、非协同、可逆的，并遵循质量作用动力学。\n-   系统是一个充分混合室。\n-   给药期间游离药物浓度恒定：$C=100\\ \\mathrm{nM}$。\n-   给药持续时间：$T=2\\ \\mathrm{h}$。\n-   给药后，药物被瞬时洗脱，因此当 $t  T$ 时，$C=0$。\n-   初始靶点占有率为零。\n-   靶点 A 的动力学参数：$k_{\\mathrm{on,A}}=10^{6}\\ \\mathrm{M^{-1}s^{-1}}$，$k_{\\mathrm{off,A}}=10^{-3}\\ \\mathrm{s^{-1}}$。\n-   靶点 B 的动力学参数：$k_{\\mathrm{on,B}}=10^{5}\\ \\mathrm{M^{-1}s^{-1}}$，$k_{\\mathrm{off,B}}=10^{-4}\\ \\mathrm{s^{-1}}$。\n-   占有率阈值：$0.5$。\n-   任务是求出每个靶点占有率保持在 $0.5$ 以上的持续时间，并计算这些持续时间的比率（靶点 B / 靶点 A）。\n-   最终比率应为一个无单位小数，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估该问题：\n-   **科学基础：** 该问题基于应用于可逆双分子相互作用的质量作用基本定律，这是化学动力学、药理学和系统生物学的基石。结合速率（$k_{\\mathrm{on}}$）、解离速率（$k_{\\mathrm{off}}$）、靶点占有率（$\\theta$）和药物浓度（$C$）等概念都是标准概念。给定的动力学参数在药物-靶点相互作用的物理现实范围内。给药期后进行洗脱的模型是标准的体外和体内实验范式。该问题在科学上是合理的。\n-   **适定性：** 该问题提供了一整套参数（两个靶点的 $k_{\\mathrm{on}}$、$k_{\\mathrm{off}}$，$C$，$T$）和初始条件（$\\theta(0)=0$），这些参数足以唯一确定靶点占有率随时间的演变。目标是计算一个具体的、明确定义的量（时间持续的比率）。该问题在数学上是适定的。\n-   **客观性：** 该问题以精确、定量和无偏见的专业技术语言陈述。没有主观或基于观点的论断。\n-   **完整性和一致性：** 提供了所有必要信息。单位转换后是一致的。例如，$C$ 的单位是 $\\mathrm{nM}$（$10^{-9}\\ \\mathrm{M}$），$T$ 的单位是小时，速率常数的单位是 $\\mathrm{M}$ 和 $\\mathrm{s}$。所有单位必须转换为一个一致的体系（例如，M，s）。该问题是自洽和一致的。\n-   **未检测到其他缺陷：** 该问题不是比喻性的，与指定领域直接相关，不是不切实际的，不是结构不良的，不是微不足道的，并且是科学可验证的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解题推导\n药物（$D$）与靶点（$R$）可逆结合形成复合物（$DR$）的过程表示为 $D + R \\rightleftharpoons DR$。占有率 $\\theta$ 是总靶点中处于复合物形式的部分，即 $\\theta = \\frac{[DR]}{[R]_{\\mathrm{total}}}$。占有率随时间的演变由质量作用定律推导出的微分方程描述：\n$$ \\frac{d\\theta}{dt} = k_{\\mathrm{on}} [D] (1 - \\theta) - k_{\\mathrm{off}} \\theta $$\n这是一个一阶线性常微分方程。我们将系统分为两个阶段进行分析。\n\n**第一阶段：给药（$0 \\le t \\le T$）**\n在此阶段，游离药物浓度恒定，$[D] = C$。常微分方程为：\n$$ \\frac{d\\theta}{dt} = k_{\\mathrm{on}} C - (k_{\\mathrm{on}}C + k_{\\mathrm{off}})\\theta $$\n设表观速率常数为 $k_{\\mathrm{obs}} = k_{\\mathrm{on}}C + k_{\\mathrm{off}}$，平衡占有率为 $\\theta_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{on}}C + k_{\\mathrm{off}}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{obs}}}$。方程变为 $\\frac{d\\theta}{dt} + k_{\\mathrm{obs}}\\theta = k_{\\mathrm{on}}C$。\n在初始条件 $\\theta(0)=0$ 下，解为：\n$$ \\theta(t) = \\theta_{\\mathrm{eq}}(1 - \\exp(-k_{\\mathrm{obs}}t)) $$\n\n**第二阶段：洗脱（$t  T$）**\n在此阶段，药物浓度为零，$[D]=0$。常微分方程简化为：\n$$ \\frac{d\\theta}{dt} = -k_{\\mathrm{off}}\\theta $$\n该解描述了指数衰减。此阶段的初始条件是给药期结束时的占有率 $\\theta(T)$。当 $t  T$ 时，解为：\n$$ \\theta(t) = \\theta(T) \\exp(-k_{\\mathrm{off}}(t-T)) $$\n其中 $\\theta(T) = \\theta_{\\mathrm{eq}}(1 - \\exp(-k_{\\mathrm{obs}}T))$。\n\n**持续时间计算**\n我们需要找到 $\\theta(t) \\ge 0.5$ 的连续时间区间。该区间从时间 $t_{\\mathrm{on}}$ 开始，到时间 $t_{\\mathrm{off}}$ 结束。\n开始时间 $t_{\\mathrm{on}}$ 是在给药阶段占有率首次达到 $0.5$ 的时刻。这要求 $\\theta_{\\mathrm{eq}}  0.5$。\n$$ 0.5 = \\theta_{\\mathrm{eq}}(1 - \\exp(-k_{\\mathrm{obs}}t_{\\mathrm{on}})) \\implies t_{\\mathrm{on}} = \\frac{1}{k_{\\mathrm{obs}}} \\ln\\left(\\frac{\\theta_{\\mathrm{eq}}}{\\theta_{\\mathrm{eq}} - 0.5}\\right) $$\n结束时间 $t_{\\mathrm{off}}$ 是在洗脱阶段占有率回落到 $0.5$ 的时刻。这要求 $\\theta(T)  0.5$。\n$$ 0.5 = \\theta(T)\\exp(-k_{\\mathrm{off}}(t_{\\mathrm{off}}-T)) \\implies t_{\\mathrm{off}} = T + \\frac{1}{k_{\\mathrm{off}}} \\ln\\left(\\frac{\\theta(T)}{0.5}\\right) $$\n高于阈值的总持续时间为 $\\Delta t = t_{\\mathrm{off}} - t_{\\mathrm{on}}$。\n\n**单位换算**\n首先，我们统一单位。我们将使用 M（摩尔/升）和 s（秒）。\n$C = 100\\ \\mathrm{nM} = 100 \\times 10^{-9}\\ \\mathrm{M} = 10^{-7}\\ \\mathrm{M}$。\n$T = 2\\ \\mathrm{h} = 2 \\times 3600\\ \\mathrm{s} = 7200\\ \\mathrm{s}$。\n\n**靶点 A 的计算**\n- 参数：$k_{\\mathrm{on,A}} = 10^6\\ \\mathrm{M^{-1}s^{-1}}$，$k_{\\mathrm{off,A}} = 10^{-3}\\ \\mathrm{s^{-1}}$。\n- $k_{\\mathrm{on,A}}C = (10^6\\ \\mathrm{M^{-1}s^{-1}})(10^{-7}\\ \\mathrm{M}) = 0.1\\ \\mathrm{s^{-1}}$。\n- $k_{\\mathrm{obs,A}} = k_{\\mathrm{on,A}}C + k_{\\mathrm{off,A}} = 0.1\\ \\mathrm{s^{-1}} + 10^{-3}\\ \\mathrm{s^{-1}} = 0.101\\ \\mathrm{s^{-1}}$。\n- $\\theta_{\\mathrm{eq,A}} = \\frac{k_{\\mathrm{on,A}}C}{k_{\\mathrm{obs,A}}} = \\frac{0.1}{0.101} = \\frac{100}{101}$。\n由于 $\\theta_{\\mathrm{eq,A}} \\approx 0.99  0.5$，占有率将超过阈值。\n- $t_{\\mathrm{on,A}} = \\frac{1}{0.101} \\ln\\left(\\frac{100/101}{100/101 - 0.5}\\right) = \\frac{1}{0.101} \\ln\\left(\\frac{200}{99}\\right) \\approx \\frac{0.7031971}{0.101} \\approx 6.96235\\ \\mathrm{s}$。\n- 在 $t=T$ 时的占有率：$k_{\\mathrm{obs,A}}T = 0.101 \\times 7200 = 727.2$。$\\exp(-727.2)$ 这一项在数值上与 $0$ 没有区别。因此，$\\theta_{\\mathrm{A}}(T) \\approx \\theta_{\\mathrm{eq,A}} = \\frac{100}{101}$。\n- $t_{\\mathrm{off,A}} = 7200 + \\frac{1}{10^{-3}} \\ln\\left(\\frac{100/101}{0.5}\\right) = 7200 + 1000 \\ln\\left(\\frac{200}{101}\\right) \\approx 7200 + 1000 \\times 0.6831962 \\approx 7200 + 683.1962 = 7883.1962\\ \\mathrm{s}$。\n- 靶点 A 的持续时间：$\\Delta t_A = t_{\\mathrm{off,A}} - t_{\\mathrm{on,A}} \\approx 7883.1962 - 6.96235 = 7876.23385\\ \\mathrm{s}$。\n\n**靶点 B 的计算**\n- 参数：$k_{\\mathrm{on,B}} = 10^5\\ \\mathrm{M^{-1}s^{-1}}$，$k_{\\mathrm{off,B}} = 10^{-4}\\ \\mathrm{s^{-1}}$。\n- $k_{\\mathrm{on,B}}C = (10^5\\ \\mathrm{M^{-1}s^{-1}})(10^{-7}\\ \\mathrm{M}) = 0.01\\ \\mathrm{s^{-1}}$。\n- $k_{\\mathrm{obs,B}} = k_{\\mathrm{on,B}}C + k_{\\mathrm{off,B}} = 0.01\\ \\mathrm{s^{-1}} + 10^{-4}\\ \\mathrm{s^{-1}} = 0.0101\\ \\mathrm{s^{-1}}$。\n- $\\theta_{\\mathrm{eq,B}} = \\frac{k_{\\mathrm{on,B}}C}{k_{\\mathrm{obs,B}}} = \\frac{0.01}{0.0101} = \\frac{100}{101}$。\n这与靶点 A 的平衡占有率相同，正如预期的那样，因为两个靶点的解离常数 $K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}} = 10^{-9}\\ \\mathrm{M} = 1\\ \\mathrm{nM}$ 是相同的。\n- $t_{\\mathrm{on,B}} = \\frac{1}{0.0101} \\ln\\left(\\frac{100/101}{100/101 - 0.5}\\right) = \\frac{1}{0.0101} \\ln\\left(\\frac{200}{99}\\right) \\approx \\frac{0.7031971}{0.0101} \\approx 69.6235\\ \\mathrm{s}$。\n- 在 $t=T$ 时的占有率：$k_{\\mathrm{obs,B}}T = 0.0101 \\times 7200 = 72.72$。$\\exp(-72.72)$ 这一项在数值上为零。因此，$\\theta_{\\mathrm{B}}(T) \\approx \\theta_{\\mathrm{eq,B}} = \\frac{100}{101}$。\n- $t_{\\mathrm{off,B}} = 7200 + \\frac{1}{10^{-4}} \\ln\\left(\\frac{100/101}{0.5}\\right) = 7200 + 10000 \\ln\\left(\\frac{200}{101}\\right) \\approx 7200 + 10000 \\times 0.6831962 \\approx 7200 + 6831.962 = 14031.962\\ \\mathrm{s}$。\n- 靶点 B 的持续时间：$\\Delta t_B = t_{\\mathrm{off,B}} - t_{\\mathrm{on,B}} \\approx 14031.962 - 69.6235 = 13962.3385\\ \\mathrm{s}$。\n\n**计算比率**\n所要求的比率是靶点 B 相对于靶点 A 的持续时间之比。\n$$ \\text{Ratio} = \\frac{\\Delta t_B}{\\Delta t_A} \\approx \\frac{13962.3385}{7876.23385} \\approx 1.772783 $$\n四舍五入到四位有效数字，该比率为 $1.773$。", "answer": "$$\\boxed{1.773}$$", "id": "4375810"}, {"introduction": "现代药物发现越来越多地借助系统层面的计算方法来整合和分析复杂的生物数据。通过将药物、靶点、疾病和副作用构建成一个异构网络，我们可以利用网络算法来揭示它们之间隐藏的关联。本练习将向您介绍一种强大的网络分析工具——带重启的随机游走（RWR），并通过一个简化的实例，让您亲手实践如何利用该算法在网络中量化节点间的“接近度”，从而为药物重定位或不良反应预测提供候选排序 [@problem_id:4375843]。", "problem": "在一个用于多重药理学、药物重定位和不良反应预测的系统生物医学流程中，使用了一种带重启的随机游走算法。该算法应用于一个异构网络，此网络将药物、靶点和表型层整合成一个元图。考虑一个由三个节点组成的玩具元图，这三个节点分别代表一种药物、一个靶点和一种不良反应。其动态过程被建模为一个带重启的离散时间马尔可夫链，具体如下：在每一步中，游走者以概率 $\\alpha$ 重启到种子分布 $\\mathbf{p}_{0}$，并以概率 $1-\\alpha$ 遵循由行随机转移矩阵 $\\mathbf{W}$ 编码的网络转移。根据全概率定律，这为时间 $t$ 的状态分布 $\\mathbf{p}_{t}$ 引入了一个凸组合更新。\n\n给定行随机转移矩阵\n$$\n\\mathbf{W}=\\begin{bmatrix}\n0  0.5  0.5 \\\\\n0.5  0  0.5 \\\\\n0.5  0.5  0\n\\end{bmatrix},\n$$\n重启概率 $\\alpha=0.3$，以及对应于药物节点的种子分布 $\\mathbf{p}_{0}=\\begin{bmatrix}1 \\\\ 0 \\\\ 0\\end{bmatrix}$。从马尔可夫链的原理和上述重启机制出发，推导带重启随机游走的前两次迭代结果 $\\mathbf{p}_{1}$ 和 $\\mathbf{p}_{2}$。然后，根据节点在 $\\mathbf{p}_{2}$ 中的得分，按降序对节点进行排序。如果出现得分相同的情况，则按节点索引的升序打破平局。\n\n将您的最终答案以单行矩阵的形式报告，其中依次包含 $\\mathbf{p}_{1}$ 的三个条目、$\\mathbf{p}_{2}$ 的三个条目以及排序后的三个节点索引。无需四舍五入。本问题不涉及物理单位。", "solution": "用户希望解决此问题，因此我们首先需要验证其有效性。\n\n### 步骤 1：提取已知条件\n- **模型**：一个在三节点元图上的带重启的离散时间马尔可夫链。\n- **更新机制**：在每一步，游走者以概率 $\\alpha$ 重启到种子分布 $\\mathbf{p}_{0}$，或以概率 $1-\\alpha$ 根据行随机转移矩阵 $\\mathbf{W}$ 进行转移。\n- **更新规则形式**：凸组合。\n- **转移矩阵**：$\\mathbf{W}=\\begin{bmatrix} 0  0.5  0.5 \\\\ 0.5  0  0.5 \\\\ 0.5  0.5  0 \\end{bmatrix}$。\n- **重启概率**：$\\alpha=0.3$。\n- **种子分布**：$\\mathbf{p}_{0}=\\begin{bmatrix}1 \\\\ 0 \\\\ 0\\end{bmatrix}$。\n- **任务**：\n  1. 推导前两次迭代结果 $\\mathbf{p}_{1}$ 和 $\\mathbf{p}_{2}$。\n  2. 根据节点在 $\\mathbf{p}_{2}$ 中的得分按降序排序。\n  3. 平局打破规则：按节点索引升序。\n  4. 以单行矩阵报告 $\\mathbf{p}_{1}$ 的分量、$\\mathbf{p}_{2}$ 的分量和节点排序。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了带重启随机游走 (RWR) 算法，这是网络分析和系统生物学中一种标准且成熟的方法。将其表述为马尔可夫链在数学上和科学上都是合理的。\n- **适定性**：所有必要的参数（$\\mathbf{W}$、$\\alpha$、$\\mathbf{p}_{0}$）均已提供。任务具体，并有唯一的可计算解。排名标准，包括打破平局的规则，都是明确的。\n- **客观性**：问题以精确、客观的数学语言陈述。\n\n该问题没有违反任何无效性标准。这是一个定义明确且标准的 RWR 算法应用练习。\n\n### 步骤 3：结论与行动\n此问题是**有效的**。将提供解答。\n\n### 解题推导\n\n所描述的过程是带重启的随机游走 (RWR)。设 $\\mathbf{p}_{t}$ 是一个列向量，表示在时间步 $t$ 游走者位置在各节点上的概率分布。问题陈述，新的分布 $\\mathbf{p}_{t+1}$ 是基于两个事件形成的：转移或重启。\n\n更新规则可以从全概率定律推导得出。在时间 $t+1$ 位于任意节点 $j$ 的概率，表示为 $\\mathbf{p}_{t+1}$ 的第 $j$ 个分量，是：\n$$ (\\mathbf{p}_{t+1})_j = (1-\\alpha) \\times P(\\text{walker at } j \\text{ after transition}) + \\alpha \\times P(\\text{walker at } j \\text{ after restart}) $$\n给定状态 $\\mathbf{p}_t$，从任意节点 $i$ 转移后位于节点 $j$ 的概率是 $\\sum_{i} W_{ij} (\\mathbf{p}_t)_i$。对于列向量 $\\mathbf{p}_t$，用矩阵形式表示，这对应于向量 $\\mathbf{W}^T \\mathbf{p}_t$ 的第 $j$ 个分量。重启后，位于节点 $j$ 的概率就是种子分布的第 $j$ 个分量 $(\\mathbf{p}_{0})_j$。\n\n因此，向量更新方程为：\n$$ \\mathbf{p}_{t+1} = (1-\\alpha)\\mathbf{W}^T \\mathbf{p}_{t} + \\alpha \\mathbf{p}_{0} $$\n迭代从一个初始状态开始。通常以种子分布开始这个过程，所以我们设定计算的初始状态为 $\\mathbf{p}_{0}$。问题要求前两次迭代结果 $\\mathbf{p}_{1}$ 和 $\\mathbf{p}_{2}$，我们将按顺序计算它们。\n\n给定的参数是：\n- 重启概率 $\\alpha = 0.3$，所以转移概率是 $1-\\alpha = 0.7$。\n- 种子分布 $\\mathbf{p}_{0} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n- 行随机转移矩阵 $\\mathbf{W} = \\begin{bmatrix} 0  0.5  0.5 \\\\ 0.5  0  0.5 \\\\ 0.5  0.5  0 \\end{bmatrix}$。\n\n需要 $\\mathbf{W}$ 的转置。因为 $\\mathbf{W}$ 是一个对称矩阵，所以 $\\mathbf{W}^T = \\mathbf{W}$。\n$$ \\mathbf{W}^T = \\begin{bmatrix} 0  0.5  0.5 \\\\ 0.5  0  0.5 \\\\ 0.5  0.5  0 \\end{bmatrix} $$\n\n**计算第一次迭代结果 $\\mathbf{p}_{1}$**\n\n我们使用 $t=0$ 时的更新规则来计算 $\\mathbf{p}_{1}$：\n$$ \\mathbf{p}_{1} = (1-\\alpha)\\mathbf{W}^T \\mathbf{p}_{0} + \\alpha \\mathbf{p}_{0} $$\n首先，我们计算乘积 $\\mathbf{W}^T \\mathbf{p}_{0}$：\n$$ \\mathbf{W}^T \\mathbf{p}_{0} = \\begin{bmatrix} 0  0.5  0.5 \\\\ 0.5  0  0.5 \\\\ 0.5  0.5  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} (0)(1) + (0.5)(0) + (0.5)(0) \\\\ (0.5)(1) + (0)(0) + (0.5)(0) \\\\ (0.5)(1) + (0.5)(0) + (0)(0) \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0.5 \\\\ 0.5 \\end{bmatrix} $$\n现在，我们将其代回 $\\mathbf{p}_{1}$ 的方程中：\n$$ \\mathbf{p}_{1} = (0.7) \\begin{bmatrix} 0 \\\\ 0.5 \\\\ 0.5 \\end{bmatrix} + (0.3) \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0.35 \\\\ 0.35 \\end{bmatrix} + \\begin{bmatrix} 0.3 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0.3 \\\\ 0.35 \\\\ 0.35 \\end{bmatrix} $$\n作为检验，$\\mathbf{p}_{1}$ 的各分量之和为 $0.3 + 0.35 + 0.35 = 1.0$。\n\n**计算第二次迭代结果 $\\mathbf{p}_{2}$**\n\n我们使用 $t=1$ 时的更新规则来计算 $\\mathbf{p}_{2}$：\n$$ \\mathbf{p}_{2} = (1-\\alpha)\\mathbf{W}^T \\mathbf{p}_{1} + \\alpha \\mathbf{p}_{0} $$\n首先，我们计算乘积 $\\mathbf{W}^T \\mathbf{p}_{1}$：\n$$ \\mathbf{W}^T \\mathbf{p}_{1} = \\begin{bmatrix} 0  0.5  0.5 \\\\ 0.5  0  0.5 \\\\ 0.5  0.5  0 \\end{bmatrix} \\begin{bmatrix} 0.3 \\\\ 0.35 \\\\ 0.35 \\end{bmatrix} = \\begin{bmatrix} (0)(0.3) + (0.5)(0.35) + (0.5)(0.35) \\\\ (0.5)(0.3) + (0)(0.35) + (0.5)(0.35) \\\\ (0.5)(0.3) + (0.5)(0.35) + (0)(0.35) \\end{bmatrix} = \\begin{bmatrix} 0 + 0.175 + 0.175 \\\\ 0.15 + 0 + 0.175 \\\\ 0.15 + 0.175 + 0 \\end{bmatrix} = \\begin{bmatrix} 0.35 \\\\ 0.325 \\\\ 0.325 \\end{bmatrix} $$\n现在，我们将其代回 $\\mathbf{p}_{2}$ 的方程中：\n$$ \\mathbf{p}_{2} = (0.7) \\begin{bmatrix} 0.35 \\\\ 0.325 \\\\ 0.325 \\end{bmatrix} + (0.3) \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} (0.7)(0.35) \\\\ (0.7)(0.325) \\\\ (0.7)(0.325) \\end{bmatrix} + \\begin{bmatrix} 0.3 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0.245 \\\\ 0.2275 \\\\ 0.2275 \\end{bmatrix} + \\begin{bmatrix} 0.3 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0.545 \\\\ 0.2275 \\\\ 0.2275 \\end{bmatrix} $$\n作为检验，$\\mathbf{p}_{2}$ 的各分量之和为 $0.545 + 0.2275 + 0.2275 = 1.0$。\n\n**节点排序**\n\n节点的得分是向量 $\\mathbf{p}_{2}$ 的分量：\n- 节点 $1$ 得分: $0.545$\n- 节点 $2$ 得分: $0.2275$\n- 节点 $3$ 得分: $0.2275$\n\n我们根据节点的得分按降序对其进行排序。\n节点 $1$ 的得分最高。节点 $2$ 和节点 $3$ 的得分相等。问题指定按节点索引的升序来打破平局。因此，节点 $2$ 排在节点 $3$ 之前。\n最终的节点索引排序是 $1, 2, 3$。\n\n**最终答案组合**\n\n最终答案要求一个单行矩阵，其中依次包含 $\\mathbf{p}_{1}$ 的三个条目、$\\mathbf{p}_{2}$ 的三个条目以及排序后的三个节点索引。\n- $\\mathbf{p}_{1}$ 条目：$0.3$, $0.35$, $0.35$\n- $\\mathbf{p}_{2}$ 条目：$0.545$, $0.2275$, $0.2275$\n- 排序后的索引：$1$, $2$, $3$\n\n这 $9$ 个值将构成最终的行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3  0.35  0.35  0.545  0.2275  0.2275  1  2  3 \\end{pmatrix}}\n$$", "id": "4375843"}]}