{"hands_on_practices": [{"introduction": "合成生物学的核心理念之一是将生物系统视为可由标准化的、可预测的“部件”组装而成。为了实现这一目标，我们必须能够定量地描述这些部件的行为。本练习将指导您从基本生物物理原理出发，为一个基于 CRISPRi 的基因抑制器推导其输入-输出响应函数 [@problem_id:4377812]。通过将解离常数（$K_d$）等微观参数与宏观的基因抑制水平联系起来，您将掌握构建和理解基因元件定量模型的基本技能。", "problem": "在一个充分混合的细胞中，一个单一启动子受到CRISPR干扰（CRISPRi）的调控。在该调控中，一个催化失活的成簇规律间隔短回文重复序列相关蛋白9（dCas9）与一个单向导RNA（sgRNA）结合，形成的复合物会与启动子附近的一个单一靶点结合，从而阻碍转录。假设在转录起始的时间尺度上，靶点与dCas9-sgRNA复合物之间的结合反应处于准平衡状态。设$T$表示未结合的靶点，$C$表示游离的dCas9-sgRNA复合物，$TC$表示已结合的复合物。解离常数由基本平衡关系式 $K_{d} = \\frac{[T][C]}{[TC]}$ 定义，其中 $[\\,\\cdot\\,]$ 表示浓度。设$G$表示活性dCas9-sgRNA复合物的游离浓度 $[C]$。\n\n定义靶点被复合物占据的分数占有率为 $\\theta = \\frac{[TC]}{[T] + [TC]}$。归一化转录输出定义为 $y(G) = \\frac{r(G)}{r_{0}}$，其中$r(G)$是游离复合物浓度为$G$时的转录速率，$r_{0}$是无结合时的基础速率。假设抑制作用与占有率成正比，即$y(G)$随$\\theta$线性下降，比例因子为$\\alpha \\in [0,1]$，其中$\\alpha = 1$表示结合后转录完全关闭，$\\alpha = 0$表示结合对转录无影响。\n\n仅从$K_d$的平衡定义、单一靶点的守恒以及上述的比例抑制假设出发，推导$y(G)$作为$G$、$K_d$和$\\alpha$的函数的闭式表达式。将最终答案表示为单个解析表达式。无需数值计算，也无需单位。", "solution": "用户希望我解决一个合成生物学领域的问题。\n\n### 步骤1：提取已知条件\n- 系统：一个在充分混合细胞中由CRISPR干扰（CRISPRi）调控的单一启动子。\n- 组分：$T$（未结合的靶点），$C$（游离的dCas9-sgRNA复合物），$TC$（已结合的复合物）。\n- 平衡假设：结合反应处于准平衡状态。\n- 解离常数：$K_{d} = \\frac{[T][C]}{[TC]}$，其中 $[\\,\\cdot\\,]$ 表示浓度。\n- 变量定义：$G = [C]$。\n- 分数占有率：$\\theta = \\frac{[TC]}{[T] + [TC]}$。\n- 归一化转录输出：$y(G) = \\frac{r(G)}{r_{0}}$，其中$r(G)$是游离复合物浓度为$G$时的转录速率，$r_{0}$是基础速率。\n- 抑制模型：$y(G)$随$\\theta$线性下降，比例因子为$\\alpha \\in [0,1]$。\n- 守恒定律：问题提到“单一靶点”，这意味着靶点的总浓度 $[T]_{total} = [T] + [TC]$ 是一个常数。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在分子生物学和生物物理学原理上有充分的依据。CRISPRi是一种标准的遗传学工具。使用解离常数（$K_d$）来描述平衡结合是生物化学中的一个基本概念。用启动子占有率的函数来表示转录抑制的模型是定量生物学中常用且有效的简化方法。\n- **适定性**：该问题提供了明确的目标和一组充分的定义与关系，足以推导出所需的$y(G)$表达式。预期会有一个唯一、稳定且有意义的解。\n- **客观性**：该问题使用精确、客观的科学语言陈述。所有术语都有明确定义。\n- **一致性与完整性**：所提供的信息是自洽且一致的。$K_d$、$\\theta$的定义以及线性抑制模型足以将$y(G)$与$G$联系起来。\n- **结论**：该问题被判定为有效，因为它科学合理、适定且客观。它没有违反任何指定的无效标准。\n\n### 步骤3：判定与行动\n问题有效。我将继续进行求解。\n\n目标是推导归一化转录输出$y(G)$的闭式表达式，使其成为游离dCas9-sgRNA复合物浓度$G$、解离常数$K_d$和抑制比例因子$\\alpha$的函数。推导将基于所给的定义和假设。\n\n首先，我们形式化归一化转录输出$y(G)$与分数占有率$\\theta$之间的关系。问题陈述$y(G)$随$\\theta$线性下降。这可以表示为一个线性方程：\n$$ y = m\\theta + c $$\n我们有两个边界条件来确定常数$m$和$c$。\n1. 在没有dCas9-sgRNA复合物的情况下，浓度$G=0$，这意味着没有结合发生，所以分数占有率$\\theta=0$。在这种情况下，转录速率是基础速率$r_0$。归一化输出为$y(G=0) = \\frac{r(0)}{r_0} = \\frac{r_0}{r_0} = 1$。将$\\theta=0$和$y=1$代入线性方程，得到：\n$$ 1 = m(0) + c \\implies c = 1 $$\n所以，关系式为$y = m\\theta + 1$。\n\n2. 问题陈述下降与$\\theta$成正比，因子为$\\alpha$。这意味着直线的斜率是$m = -\\alpha$。因此，方程变为：\n$$ y(G) = 1 - \\alpha \\theta $$\n我们可以根据所提供的关于$\\alpha$的信息来检验这一点。如果$\\alpha=0$（无影响），则对于所有的$\\theta$都有$y(G)=1$，这是正确的。如果$\\alpha=1$（完全关闭），则输出变为$y(G) = 1-\\theta$。当靶点完全被占据时（$\\theta=1$），$y(G)=0$，表示完全抑制，这也是正确的。因此，这个函数形式准确地表示了所述的抑制模型。\n\n接下来，我们必须将分数占有率$\\theta$表示为$G$和$K_d$的函数。$\\theta$的定义是：\n$$ \\theta = \\frac{[TC]}{[T] + [TC]} $$\n靶点的总浓度是$[T]_{total} = [T] + [TC]$。\n平衡结合由解离常数$K_d$描述：\n$$ K_{d} = \\frac{[T][C]}{[TC]} $$\n我们已知$G = [C]$。我们可以重新排列平衡方程来求解未结合靶点的浓度$[T]$：\n$$ [T] = K_{d} \\frac{[TC]}{[C]} = K_{d} \\frac{[TC]}{G} $$\n现在，我们将这个$[T]$的表达式代入$\\theta$的定义中：\n$$ \\theta = \\frac{[TC]}{\\left( K_{d} \\frac{[TC]}{G} \\right) + [TC]} $$\n假设已结合复合物的浓度$[TC]$不为零（如果$[TC]=0$，则$\\theta=0$是平凡解），我们可以从分子和分母中消去$[TC]$：\n$$ \\theta = \\frac{1}{\\frac{K_{d}}{G} + 1} $$\n为了简化这个表达式，我们将分子和分母同时乘以$G$：\n$$ \\theta = \\frac{G}{K_{d} + G} $$\n这是描述单一位点结合的标准Hill-Langmuir方程。\n\n最后，我们将这个$\\theta$的表达式代入我们的$y(G)$方程：\n$$ y(G) = 1 - \\alpha \\theta = 1 - \\alpha \\left( \\frac{G}{K_{d} + G} \\right) $$\n为了将其表示为单个分数，我们找到一个共同的分母：\n$$ y(G) = \\frac{K_{d} + G}{K_{d} + G} - \\frac{\\alpha G}{K_{d} + G} $$\n$$ y(G) = \\frac{K_{d} + G - \\alpha G}{K_{d} + G} $$\n从分子中的后两项中提出因子$G$，得到最终的闭式表达式：\n$$ y(G) = \\frac{K_{d} + (1-\\alpha)G}{K_{d} + G} $$\n这个归一化转录输出$y(G)$的表达式仅是$G$、$K_d$和$\\alpha$的函数，符合问题陈述的要求。", "answer": "$$ \\boxed{\\frac{K_{d} + (1-\\alpha)G}{K_{d} + G}} $$", "id": "4377812"}, {"introduction": "在掌握了单个抑制元件的建模之后，一个自然而然的问题是：当我们将这些部件连接起来时会发生什么？本练习探讨了合成生物学中最具标志性的基因回路之一——基因拨动开关的设计原理 [@problem_id:4377847]。通过分析两个相互抑制的基因组成的系统，您将学习如何使用数学方法（特别是通过分析零增长等斜线）来确定实现双稳态所需的条件，这是创造细胞记忆和决策行为的关键。", "problem": "一个双基因触发开关实现了基因 $X$ 和基因 $Y$ 之间的相互转录抑制。在一个充分混合的单细胞模型中，相应蛋白质的浓度 $x(t)$ 和 $y(t)$ 服从由分子生物学中心法则和质量平衡推导出的常微分方程：蛋白质由启动子产生，其抑制受平衡结合（希尔形式）调控；蛋白质经历一阶降解。假设系统为对称结构且无基础泄漏：两个基因的最大启动子强度（产生速率）均为 $\\beta$（单位为 $\\mathrm{nM}\\,\\mathrm{min}^{-1}$），两种蛋白质以相同的速率 $\\delta$（单位为 $\\mathrm{min}^{-1}$）降解，并且两个阻遏蛋白均以希尔系数 $n$ 和解离常数 $K$（单位为 $\\mathrm{nM}$）进行协同结合。其动力学方程为\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\beta}{1+\\left(\\frac{y}{K}\\right)^{n}} \\;-\\; \\delta\\,x,\n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\beta}{1+\\left(\\frac{x}{K}\\right)^{n}} \\;-\\; \\delta\\,y.\n$$\n当零增长等斜线 $x=\\frac{\\beta}{\\delta\\left(1+(y/K)^{n}\\right)}$ 和 $y=\\frac{\\beta}{\\delta\\left(1+(x/K)^{n}\\right)}$ 的对称交点不稳定时，这种触发开关中会出现双稳态。该不稳定条件可以通过要求在交点处两条零增长等斜线斜率的绝对值之积大于1来满足。\n\n给定 $\\delta = 0.02\\,\\mathrm{min}^{-1}$，$K = 50\\,\\mathrm{nM}$ 和 $n = 2$，确定在对称交点处满足上述不稳定判据所需的最小启动子强度 $\\beta_{\\mathrm{min}}$（单位为 $\\mathrm{nM}\\,\\mathrm{min}^{-1}$）。将答案四舍五入至四位有效数字，并以 $\\mathrm{nM}\\,\\mathrm{min}^{-1}$ 为单位表示。", "solution": "用户想要找到对称触发开关表现出双稳态所需的最小启动子强度 $\\beta_{\\mathrm{min}}$。双稳态的条件是该对称稳态不稳定，这发生在在该点处零增长等斜线斜率的绝对值之积大于1时。\n\n系统的动力学由以下耦合常微分方程给出：\n$$\n\\frac{dx}{dt} = \\frac{\\beta}{1+\\left(\\frac{y}{K}\\right)^{n}} - \\delta x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\beta}{1+\\left(\\frac{x}{K}\\right)^{n}} - \\delta y\n$$\n\n首先，我们确定系统的零增长等斜线。$x$-零增长等斜线是 $(x, y)$ 相平面上满足 $\\frac{dx}{dt} = 0$ 的曲线，$y$-零增长等斜线是满足 $\\frac{dy}{dt} = 0$ 的曲线。\n\n由 $\\frac{dx}{dt} = 0$，我们得到 $x$-零增长等斜线的方程：\n$$\nx = \\frac{\\beta}{\\delta\\left(1+\\left(\\frac{y}{K}\\right)^{n}\\right)}\n$$\n由 $\\frac{dy}{dt} = 0$，我们得到 $y$-零增长等斜线的方程：\n$$\ny = \\frac{\\beta}{\\delta\\left(1+\\left(\\frac{x}{K}\\right)^{n}\\right)}\n$$\n\n接下来，我们找到浓度相等的对称稳态，即 $x = y = x_{ss}$。将此代入任一稳态方程可得：\n$$\nx_{ss} = \\frac{\\beta}{\\delta\\left(1+\\left(\\frac{x_{ss}}{K}\\right)^{n}\\right)}\n$$\n该方程隐式地定义了由系统参数表示的对称稳态浓度 $x_{ss}$。\n\n问题陈述，当在该点处零增长等斜线斜率的绝对值之积大于1时，对称交点变得不稳定。设 $S_x = \\frac{dx}{dy}$ 为 $x$-零增长等斜线的斜率，$S_y = \\frac{dy}{dx}$ 为 $y$-零增长等斜线的斜率。不稳定判据为 $|S_x| \\cdot |S_y| > 1$。\n\n我们通过对 $x$ 关于 $y$ 求导来计算 $x$-零增长等斜线的斜率：\n$$\nS_x = \\frac{dx}{dy} = \\frac{d}{dy} \\left[ \\frac{\\beta}{\\delta} \\left(1 + \\frac{y^n}{K^n}\\right)^{-1} \\right] = \\frac{\\beta}{\\delta} (-1) \\left(1 + \\frac{y^n}{K^n}\\right)^{-2} \\left(\\frac{ny^{n-1}}{K^n}\\right) = -\\frac{\\beta n y^{n-1}}{\\delta K^n \\left(1 + \\left(\\frac{y}{K}\\right)^{n}\\right)^2}\n$$\n由于系统的对称性，$y$-零增长等斜线的斜率 $S_y$ 具有类似的形式。在对称稳态 $y=x=x_{ss}$ 处，斜率相等：$S = S_x(x_{ss}) = S_y(x_{ss})$。不稳定条件简化为 $|S|^2 > 1$，这等价于 $|S| > 1$。由于所有参数和变量都是正的，$S$ 是负的，因此条件变为 $-S > 1$。\n\n让我们在稳态 $x_{ss}$ 处计算斜率 $S$。为了简化 $S$ 的表达式，可以方便地先使用稳态关系式 $x_{ss} = \\frac{\\beta}{\\delta(1+(x_{ss}/K)^n)}$：\n$$\nS = -\\frac{n y^{n-1}}{K^n \\left(1 + \\left(\\frac{y}{K}\\right)^{n}\\right)} \\cdot \\frac{\\beta}{\\delta\\left(1 + \\left(\\frac{y}{K}\\right)^{n}\\right)}\n$$\n在对称稳态 $(x_{ss}, x_{ss})$ 处，我们代入 $y=x_{ss}$ 和 $x_{ss}$ 的稳态表达式：\n$$\nS = -\\frac{n x_{ss}^{n-1}}{K^n \\left(1 + \\left(\\frac{x_{ss}}{K}\\right)^{n}\\right)} \\cdot x_{ss} = -\\frac{n x_{ss}^{n}}{K^n \\left(1 + \\left(\\frac{x_{ss}}{K}\\right)^{n}\\right)}\n$$\n让我们定义一个无量纲浓度 $u = \\frac{x_{ss}}{K}$。斜率则变为：\n$$\nS = -\\frac{n u^n}{1+u^n}\n$$\n不稳定条件 $-S > 1$ 转换为：\n$$\n\\frac{n u^n}{1+u^n} > 1 \\implies n u^n > 1+u^n \\implies (n-1)u^n > 1\n$$\n这要求 $n > 1$，这与双稳态所需的协同性要求是一致的。关于无量纲对称稳态的条件是：\n$$\nu > \\left(\\frac{1}{n-1}\\right)^{1/n}\n$$\n现在我们必须将这个关于 $u$ 的条件与参数 $\\beta$ 联系起来。用 $u$ 表示的稳态方程（$x_{ss}=uK$）是：\n$$\nuK = \\frac{\\beta}{\\delta(1+u^n)} \\implies \\beta(u) = \\delta K u(1+u^n)\n$$\n为了分析 $\\beta$ 如何依赖于 $u$，我们计算其导数：\n$$\n\\frac{d\\beta}{du} = \\delta K \\frac{d}{du}(u+u^{n+1}) = \\delta K (1+(n+1)u^n)\n$$\n由于 $\\delta, K, n$ 是正数且 $u \\ge 0$，所以 $\\frac{d\\beta}{du}$ 总是正的。这意味着 $\\beta(u)$ 是 $u$ 的一个单调递增函数。因此，关于 $u$ 的不等式直接映射为关于 $\\beta$ 的不等式。不稳定性所需的 $\\beta$ 的最小值 $\\beta_{\\mathrm{min}}$ 对应于使不等式变为等式的 $u$ 的临界值。\n设 $u_{\\mathrm{crit}} = \\left(\\frac{1}{n-1}\\right)^{1/n}$。那么 $\\beta_{\\mathrm{min}} = \\beta(u_{\\mathrm{crit}})$。\n\n我们有 $u_{\\mathrm{crit}}^n = \\frac{1}{n-1}$。将此代入 $\\beta_{\\mathrm{min}}$ 的表达式中：\n$$\n\\beta_{\\mathrm{min}} = \\delta K u_{\\mathrm{crit}} (1+u_{\\mathrm{crit}}^n) = \\delta K \\left(\\frac{1}{n-1}\\right)^{1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n$$\n\\beta_{\\mathrm{min}} = \\delta K \\left(\\frac{1}{n-1}\\right)^{1/n} \\left(\\frac{n-1+1}{n-1}\\right) = \\delta K \\frac{n}{n-1} \\left(\\frac{1}{n-1}\\right)^{1/n}\n$$\n$$\n\\beta_{\\mathrm{min}} = \\frac{n \\delta K}{(n-1)^{1+1/n}} = \\frac{n \\delta K}{(n-1)^{(n+1)/n}}\n$$\n这是最小启动子强度的一般表达式。现在我们代入给定值：$\\delta = 0.02\\,\\mathrm{min}^{-1}$，$K = 50\\,\\mathrm{nM}$ 和 $n = 2$。\n$$\n\\beta_{\\mathrm{min}} = \\frac{2 \\cdot (0.02\\,\\mathrm{min}^{-1}) \\cdot (50\\,\\mathrm{nM})}{(2-1)^{(2+1)/2}}\n$$\n$$\n\\beta_{\\mathrm{min}} = \\frac{2 \\cdot (1\\,\\mathrm{nM}\\,\\mathrm{min}^{-1})}{1^{3/2}} = \\frac{2}{1} = 2\\,\\mathrm{nM}\\,\\mathrm{min}^{-1}\n$$\n题目要求将答案四舍五入到四位有效数字。\n$$\n\\beta_{\\mathrm{min}} = 2.000\\,\\mathrm{nM}\\,\\mathrm{min}^{-1}\n$$", "answer": "$$\\boxed{2.000}$$", "id": "4377847"}, {"introduction": "合成生物学的应用远不止于构建小型基因回路，它在改造整个细胞代谢以生产有价值的化合物方面也显示出巨大潜力。本练习将您的视角从精细的动力学模型转换到系统级的约束优化模型 [@problem_id:4377803]。您将运用通量平衡分析（FBA）——一种在代谢工程中广泛使用的强大计算方法，通过求解线性规划问题来预测一个简化代谢网络的最大产物收率，这模拟了合成生物学家在工程化微生物工厂时面临的真实挑战。", "problem": "考虑一个简化的细胞内代谢网络，使用线性规划计算在底物摄取约束下的最大产品产率。使用基于稳态质量守恒的通量平衡分析（FBA; Flux Balance Analysis）方法。设反应通量向量为 $v \\in \\mathbb{R}^8$，其分量为 $v = [v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8]$，排序如下：$v_1$ 是底物摄取，$v_2$ 是底物到中间产物的转化，$v_3$ 是厌氧产品形成，$v_4$ 是生物质前体形成，$v_5$ 是生物质流出（生长），$v_6$ 是氧气摄取，$v_7$ 是需氧产品形成，$v_8$ 是产品输出。内源代谢物排序为 $[S, A, O, B, P]$，分别对应底物、中间产物 $A$、氧气、生物质前体和产品。稳态约束为 $S v = 0$，其中化学计量矩阵 $S \\in \\mathbb{R}^{5 \\times 8}$ 由下式给出\n$$\nS = \n\\begin{bmatrix}\n+1  -1  0  0  0  0  0  0 \\\\\n0  +1  -1  -1  0  0  -1  0 \\\\\n0  0  0  0  0  +1  -1  0 \\\\\n0  0  0  +1  -1  0  0  0 \\\\\n0  0  +1  0  0  0  +2  -1 \\\\\n\\end{bmatrix}.\n$$\n所有通量的单位均为 $mmol \\cdot gDW^{-1} \\cdot h^{-1}$。不可逆性约束为 $v_j \\ge 0$ 对所有 $j \\in \\{1,2,3,4,5,6,7,8\\}$ 成立。底物摄取被归一化为 $v_1 = 1$（单位为 $mmol \\cdot gDW^{-1} \\cdot h^{-1}$），以便将目标转换为直接产生产品产率的线性规划问题。氧气摄取受限于 $0 \\le v_6 \\le v_{6,\\max}$，并通过最小生物质流出 $v_5 \\ge \\mu_{\\min}$ 来强制维持细胞活性，其中 $v_5$ 代表生长速率的代理。目标是最大化产品输出 $v_8$，由于 $v_1 = 1$，该值等于产品产率；这通过最小化 $-v_8$ 来实现。\n\n形式上，求解\n$$ \\text{maximize } v_8 \\quad \\text{subject to } S v = 0, \\quad v_1 = 1, \\quad 0 \\le v_6 \\le v_{6,\\max}, \\quad v_5 \\ge \\mu_{\\min}, \\quad v_j \\ge 0 \\ \\forall j \\in \\{1, \\dots, 8\\} $$\n并报告每个测试用例的最优 $v_8$。将所有产率以 $mmol/mmol$（无量纲比率）的浮点数形式报告，保留 $6$ 位小数。\n\n测试套件：\n使用以下参数值，每个值定义一个独立的实例：\n$1.$ $(v_{6,\\max} = 2.0, \\ \\mu_{\\min} = 0.1)$，\n$2.$ $(v_{6,\\max} = 0.0, \\ \\mu_{\\min} = 0.1)$，\n$3.$ $(v_{6,\\max} = 0.5, \\ \\mu_{\\min} = 0.0)$，\n$4.$ $(v_{6,\\max} = 2.0, \\ \\mu_{\\min} = 0.9)$。\n\n您的程序应为每个测试用例求解线性规划问题，并生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_i$ 是测试用例 $i$ 的最优产率，以 $mmol/mmol$ 为单位，保留 $6$ 位小数的浮点数。", "solution": "用户提供了一个问题陈述，要求将通量平衡分析（FBA）应用于一个简化的代谢网络。任务是计算在氧气摄取和生物质生产的不同约束下的最大产品产率。\n\n### 步骤1：提取已知条件\n\n-   **通量向量**：$v \\in \\mathbb{R}^8$，其分量为 $v = [v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8]$。这些分量分别代表以下通量：底物摄取、底物转化、厌氧产品形成、生物质前体形成、生物质流出（生长）、氧气摄取、需氧产品形成和产品输出。\n-   **化学计量矩阵**：$S \\in \\mathbb{R}^{5 \\times 8}$，由下式给出：\n    $$\n    S = \n    \\begin{bmatrix}\n    +1  -1  0  0  0  0  0  0 \\\\\n    0  +1  -1  -1  0  0  -1  0 \\\\\n    0  0  0  0  0  +1  -1  0 \\\\\n    0  0  0  +1  -1  0  0  0 \\\\\n    0  0  +1  0  0  0  +2  -1 \\\\\n    \\end{bmatrix}\n    $$\n-   **稳态约束**：$S v = 0$。\n-   **不可逆性约束**：$v_j \\ge 0$ 对所有 $j \\in \\{1, 2, ..., 8\\}$ 成立。\n-   **底物摄取约束**：$v_1 = 1 \\, mmol \\cdot gDW^{-1} \\cdot h^{-1}$。\n-   **氧气摄取约束**：$0 \\le v_6 \\le v_{6,\\max}$。\n-   **细胞活性约束**：$v_5 \\ge \\mu_{\\min}$。\n-   **目标函数**：最大化 $v_8$。\n-   **测试用例** ($v_{6,\\max}, \\mu_{\\min}$):\n    1.  $(2.0, 0.1)$\n    2.  $(0.0, 0.1)$\n    3.  $(0.5, 0.0)$\n    4.  $(2.0, 0.9)$\n-   **输出格式**：报告每个用例的最优 $v_8$，格式化为保留 $6$ 位小数。\n\n### 步骤2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题是通量平衡分析（FBA）的一个典型应用，FBA是系统生物学和代谢工程的基石。化学计量矩阵的使用、稳态假设（$S v = 0$）以及目标通量的优化都是标准且成熟的原则。该模型虽然简化，但代表了合理的代谢权衡（例如，资源在生物质、厌氧和需氧途径之间的分配）。该问题在科学上是合理的。\n-   **良态问题**：该问题被表述为一个标准的线性规划（LP）问题。它有一个线性目标函数（最大化 $v_8$）和一组线性的等式及不等式约束。对于每个测试用例，约束定义了一个凸可行域（一个多胞体）。只要这个区域非空，解就保证存在。为测试用例提供的约束看起来是一致且不矛盾的，表明每个实例都存在可行解。因此，该问题是良态的。\n-   **目标**：该问题以数学的严谨性和精确性进行定义。所有变量、矩阵和约束都被明确陈述，没有留下任何模糊或主观解释的余地。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。它是一个清晰、自洽且科学合理的计算系统生物学问题，可以使用线性规划来解决。我现在将继续构建和实现解决方案。\n\n### 基于原理的设计与求解\n\n问题的核心是为每组给定的参数求解一个线性规划（LP）问题。FBA框架为这个LP问题提供了结构。\n\n**1. 表述为线性规划问题**\n\nLP问题的一般形式是在一组线性等式和不等式约束下，优化（最小化或最大化）一个线性目标函数。该问题要求最大化产品输出通量 $v_8$。标准的LP求解器通常设计为最小化目标函数。最大化 $v_8$ 等同于最小化 $-v_8$。\n\n决策变量向量是通量向量 $v \\in \\mathbb{R}^8$：\n$$ v = [v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8]^T $$\n\n要最小化的目标函数是 $c^T v$，其中 $c$ 是一个成本向量。为了最小化 $-v_8$，我们将 $c$ 设置为：\n$$ c = [0, 0, 0, 0, 0, 0, 0, -1]^T $$\n\n**2. 约束条件**\n\n约束条件定义了代谢状态的可行空间。它们由等式约束和边界约束组成。\n\n-   **等式约束**：形式为 $A_{eq} v = b_{eq}$。在此问题中，唯一的等式约束是稳态质量平衡条件 $S v = 0$。\n    因此，等式约束矩阵 $A_{eq}$ 就是化学计量矩阵 $S$ 本身，而向量 $b_{eq}$ 是适当维度的零向量，$b_{eq} = [0, 0, 0, 0, 0]^T$。\n    $$ A_{eq} = S = \\begin{bmatrix} +1  -1  0  0  0  0  0  0 \\\\ 0  +1  -1  -1  0  0  -1  0 \\\\ 0  0  0  0  0  +1  -1  0 \\\\ 0  0  0  +1  -1  0  0  0 \\\\ 0  0  +1  0  0  0  +2  -1 \\\\ \\end{bmatrix}, \\quad b_{eq} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} $$\n\n-   **边界约束**：这些是对单个通量范围的约束，形式为 $l_j \\le v_j \\le u_j$。\n    -   所有反应的不可逆性意味着所有通量的下界为 $0$：$v_j \\ge 0$。\n    -   底物摄取速率是固定的：$v_1 = 1$。这可以实现为一个紧密的边界：$1 \\le v_1 \\le 1$。\n    -   生物质流出有一个最低要求：$v_5 \\ge \\mu_{\\min}$。这是一个下界。上界没有约束（或为无穷大）。\n    -   氧气摄取是有限的：$0 \\le v_6 \\le v_{6,\\max}$。这给出了下界和上界。\n    -   所有其他通量（$v_2, v_3, v_4, v_7, v_8$）仅受非负性约束，因此它们的下界为 $0$，上界为无穷大。\n\n结合这些，对于每个测试用例，向量 $v = [v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8]$ 的边界是：\n-   $v_1$: $[1, 1]$\n-   $v_2$: $[0, \\infty)$\n-   $v_3$: $[0, \\infty)$\n-   $v_4$: $[0, \\infty)$\n-   $v_5$: $[\\mu_{\\min}, \\infty)$\n-   $v_6$: $[0, v_{6,\\max}]$\n-   $v_7$: $[0, \\infty)$\n-   $v_8$: $[0, \\infty)$\n\n**3. 算法实现**\n\n解决方案将使用Python的`scipy.optimize.linprog`函数实现，该函数非常适合此任务。算法流程如下：\n\n1.  定义LP问题的常量部分：目标向量`c`、等式约束矩阵`S`（作为`A_eq`）以及相应的右侧向量`b_eq`。\n2.  创建一个测试用例列表，其中每个用例是一个元组`(v_6_max, mu_min)`。\n3.  遍历每个测试用例。\n4.  在循环内部，为每对 $(v_{6,\\max}, \\mu_{\\min})$，构建通量向量$v$的`bounds`列表，如上所述。`None`用于表示无穷大。\n5.  使用定义的`c`、`A_eq`、`b_eq`和特定于用例的`bounds`调用`scipy.optimize.linprog`。选择`highs`求解器方法，因其鲁棒性和效率。\n6.  `linprog`函数返回一个结果对象。最优通量向量位于`res.x`中。最大产品产率，即$v_8$的最优值，是该向量的第8个分量，`res.x[7]`。\n7.  计算出的每个用例的产率被格式化为6位小数并存储。\n8.  最后，将收集到的结果以指定格式打印：一个包含用方括号括起来的逗号分隔值列表的单行。\n\n此过程系统地解决了每个指定代谢条件下的FBA问题，得出了在给定约束下的最大可能产品通量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a Flux Balance Analysis problem for a toy metabolic network\n    to find the maximum product yield under different constraints.\n    \"\"\"\n    \n    # Stoichiometric matrix S, representing the equality constraints A_eq\n    # Rows correspond to metabolites: [S, A, O, B, P]\n    # Columns to fluxes: [v1, v2, v3, v4, v5, v6, v7, v8]\n    S = np.array([\n        [+1, -1,  0,  0,  0,  0,  0,  0],\n        [ 0, +1, -1, -1,  0,  0, -1,  0],\n        [ 0,  0,  0,  0,  0, +1, -1,  0],\n        [ 0,  0,  0, +1, -1,  0,  0,  0],\n        [ 0,  0, +1,  0,  0,  0, +2, -1]\n    ], dtype=float)\n\n    # Right-hand side of the equality constraints Sv = 0\n    b_eq = np.zeros(5)\n\n    # Objective function vector c. We want to maximize v8, which is\n    # equivalent to minimizing -v8.\n    c = np.array([0, 0, 0, 0, 0, 0, 0, -1], dtype=float)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (v_6_max, mu_min).\n    test_cases = [\n        (2.0, 0.1),\n        (0.0, 0.1),\n        (0.5, 0.0),\n        (2.0, 0.9)\n    ]\n\n    results = []\n    \n    for v6_max, mu_min in test_cases:\n        # Define the bounds for all fluxes for the current test case.\n        # The tuple (lower_bound, upper_bound) is used for each flux.\n        # None represents infinity.\n        bounds = [\n            (1.0, 1.0),      # v1 (substrate uptake): v1 = 1\n            (0.0, None),     # v2 (substrate conversion): v2 >= 0\n            (0.0, None),     # v3 (anaerobic product): v3 >= 0\n            (0.0, None),     # v4 (biomass precursor): v4 >= 0\n            (mu_min, None),  # v5 (biomass drain): v5 >= mu_min\n            (0.0, v6_max),   # v6 (oxygen uptake): 0 = v6 = v6_max\n            (0.0, None),     # v7 (aerobic product): v7 >= 0\n            (0.0, None)      # v8 (product export): v8 >= 0\n        ]\n\n        # Solve the linear program using the 'highs' method.\n        res = linprog(c, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n\n        if res.success:\n            # The optimal value for v8 is the 8th element (index 7) of the solution vector res.x.\n            # We round to handle potential floating point inaccuracies near zero.\n            optimal_v8 = res.x[7]\n            if np.isclose(optimal_v8, 0):\n                optimal_v8 = 0.0\n            results.append(f\"{optimal_v8:.6f}\")\n        else:\n            # This block would handle cases where the solver fails, e.g., if the problem is infeasible.\n            # Based on pre-analysis, all test cases are feasible.\n            results.append(\"error\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "4377803"}]}