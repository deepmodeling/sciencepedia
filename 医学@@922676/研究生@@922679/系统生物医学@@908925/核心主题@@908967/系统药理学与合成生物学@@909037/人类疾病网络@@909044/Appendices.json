{"hands_on_practices": [{"introduction": "疾病之间的相似性可以通过比较它们的临床表型来量化，这些表型通常被组织在像人类表型本体（HPO）这样的层次结构中。这个练习将引导你使用信息含量（Information Content）和 Resnik 相似性度量来计算两个疾病之间的语义相似度，并使用最佳匹配平均法（Best-Match Average）进行汇总。通过这个计算过程 [@problem_id:4393308]，你将掌握一种基于表型数据来量化疾病关联的标准生物信息学方法。", "problem": "给定两种疾病，$X$ 和 $Y$，每种疾病都标注了一组人类表型本体 (Human Phenotype Ontology, HPO) 术语。人类表型本体 (HPO) 是一个具有“is-a”关系的有向无环图 (DAG)，两个 HPO 术语之间的语义相似度将使用基于信息内容 (Information Content, IC) 的 Resnik 度量来计算。疾病-疾病相似度将使用最佳匹配平均法 (Best-Match Average) 进行聚合，该方法定义为在两个方向上计算的最大术语-术语相似度的平均值。\n\n本问题的基本定义：\n- 对于任何 HPO 术语 $t$，令 $p(t)$ 表示其经验标注概率；信息内容 (IC) 定义为 $\\mathrm{IC}(t) = -\\ln p(t)$，其中 $\\ln$ 是自然对数。\n- 对于两个 HPO 术语 $t_i$ 和 $t_j$，Resnik 语义相似度定义为其在 DAG 中共同祖先的最大 IC：$\\mathrm{sim}_{\\mathrm{Resnik}}(t_i, t_j) = \\max\\{\\mathrm{IC}(u) : u \\in \\mathrm{Anc}(t_i) \\cap \\mathrm{Anc}(t_j)\\}$，其中 $\\mathrm{Anc}(t)$ 表示 $t$ 的祖先集合（包括 $t$ 本身）。\n- 要使用最佳匹配平均法将术语-术语相似度聚合成疾病-疾病相似度，请按以下步骤进行：对于一种疾病集合中的每个术语，取其与另一种疾病集合中任何术语的最大相似度，然后对该集合求平均值；在反方向重复此过程；然后取两个方向性平均值的均值。\n\n考虑 HPO DAG 的以下片段，其中包含指定的祖先集和概率。令 $r$ 表示根术语“表型异常” (Phenotypic abnormality)，其概率为 $p(r) = 1$。中间层术语是：\n- $p_1$：“心血管异常” (Cardiovascular abnormality)，概率 $p(p_1) = \\exp(-1)$，\n- $p_2$：“神经系统异常” (Neurological abnormality)，概率 $p(p_2) = \\exp(-1.2)$，\n- $d$：“自主神经系统异常” (Autonomic nervous system abnormality)，概率 $p(d) = \\exp(-1.6)$。\n\n其他内部表型术语：\n- $c_1$：“心脏传导表型” (Cardiac conduction phenotype)，概率 $p(c_1) = \\exp(-2.0)$，\n- $c_2$：“心肌表型” (Cardiac muscle phenotype)，概率 $p(c_2) = \\exp(-1.8)$，\n- $n_2$：“运动协调表型” (Motor coordination phenotype)，概率 $p(n_2) = \\exp(-2.0)$。\n\n标注于疾病的叶级 HPO 术语：\n- 疾病 $X$ 标注了 $T_X = \\{a_1, a_2, a_3\\}$，其中：\n  - $a_1$：“心律失常” (Arrhythmia)，概率 $p(a_1) = \\exp(-3.0)$，且 $\\mathrm{Anc}(a_1) = \\{a_1, c_1, p_1, r\\}$，\n  - $a_2$：“心肌病” (Cardiomyopathy)，概率 $p(a_2) = \\exp(-2.5)$，且 $\\mathrm{Anc}(a_2) = \\{a_2, c_2, p_1, r\\}$，\n  - $a_3$：“晕厥” (Syncope)，概率 $p(a_3) = \\exp(-2.2)$，且 $\\mathrm{Anc}(a_3) = \\{a_3, d, p_2, p_1, r\\}$。\n- 疾病 $Y$ 标注了 $T_Y = \\{b_1, b_2\\}$，其中：\n  - $b_1$：“直立性低血压” (Orthostatic hypotension)，概率 $p(b_1) = \\exp(-3.1)$，且 $\\mathrm{Anc}(b_1) = \\{b_1, d, p_2, r\\}$，\n  - $b_2$：“共济失调” (Ataxia)，概率 $p(b_2) = \\exp(-2.7)$，且 $\\mathrm{Anc}(b_2) = \\{b_2, n_2, p_2, r\\}$。\n\n任务：\n1. 计算每个可以作为来自 $T_X \\times T_Y$ 的任意术语对的共同祖先的术语 $t$ 的信息内容 $\\mathrm{IC}(t)$。\n2. 使用上述信息量最大的共同祖先的定义，计算所有 $a_i \\in T_X$ 和 $b_j \\in T_Y$ 的逐对 Resnik 语义相似度 $\\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_j)$。\n3. 如上所述，使用最佳匹配平均法将术语-术语相似度聚合成一个针对 $(X, Y)$ 的单一疾病-疾病相似度分数。将最终的疾病-疾病相似度分数表示为单个精确数。无需四舍五入，也不应使用单位。", "solution": "用户希望我解决一个问题，在其中我需要根据两种疾病 $X$ 和 $Y$ 相关的人类表型本体 (HPO) 术语集来计算它们之间的语义相似度。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n问题提供了以下数据和定义：\n- **信息内容 (IC):** $\\mathrm{IC}(t) = -\\ln p(t)$，其中 $p(t)$ 是 HPO 术语 $t$ 的经验标注概率。\n- **Resnik 语义相似度:** $\\mathrm{sim}_{\\mathrm{Resnik}}(t_i, t_j) = \\max\\{\\mathrm{IC}(u) : u \\in \\mathrm{Anc}(t_i) \\cap \\mathrm{Anc}(t_j)\\}$，其中 $\\mathrm{Anc}(t)$ 是 $t$ 的祖先集合，包括 $t$ 本身。\n- **最佳匹配平均法 (BMA):** 疾病-疾病相似度是两个方向性平均值的均值。第一个平均值是通过取第一个疾病集合中每个术语与第二个疾病集合中任何术语的最大相似度，然后对这些最大值求平均来计算的。第二个平均值以相反方向计算。\n- **根术语：** $r$，$p(r) = 1$。\n- **术语概率：**\n  - $p(p_1) = \\exp(-1)$\n  - $p(p_2) = \\exp(-1.2)$\n  - $p(d) = \\exp(-1.6)$\n  - $p(c_1) = \\exp(-2.0)$\n  - $p(c_2) = \\exp(-1.8)$\n  - $p(n_2) = \\exp(-2.0)$\n  - $p(a_1) = \\exp(-3.0)$\n  - $p(a_2) = \\exp(-2.5)$\n  - $p(a_3) = \\exp(-2.2)$\n  - $p(b_1) = \\exp(-3.1)$\n  - $p(b_2) = \\exp(-2.7)$\n- **疾病标注：**\n  - 疾病 $X$：$T_X = \\{a_1, a_2, a_3\\}$\n  - 疾病 $Y$：$T_Y = \\{b_1, b_2\\}$\n- **祖先集：**\n  - $\\mathrm{Anc}(a_1) = \\{a_1, c_1, p_1, r\\}$\n  - $\\mathrm{Anc}(a_2) = \\{a_2, c_2, p_1, r\\}$\n  - $\\mathrm{Anc}(a_3) = \\{a_3, d, p_2, p_1, r\\}$\n  - $\\mathrm{Anc}(b_1) = \\{b_1, d, p_2, r\\}$\n  - $\\mathrm{Anc}(b_2) = \\{b_2, n_2, p_2, r\\}$\n\n**步骤 2：使用提取的已知条件进行验证**\n\n该问题具有科学依据，使用了生物信息学中的标准概念（HPO、Resnik 相似度、BMA）。问题是适定且客观的。我们必须验证给定条件的内部一致性，特别是祖先集，它们必须符合有向无环图 (DAG) 的结构。\n\n一个潜在的不一致性来自于 $a_3$ 和 $b_1$ 的祖先集。\n从 $\\mathrm{Anc}(b_1) = \\{b_1, d, p_2, r\\}$，我们推断 $d$ 是 $b_1$ 的一个祖先，并且 $d$ 的祖先是 $\\{d, p_2, r\\}$ 的一个子集。\n从 $\\mathrm{Anc}(a_3) = \\{a_3, d, p_2, p_1, r\\}$，我们推断 $d$ 是 $a_3$ 的一个祖先。同时，$p_1$ 也是 $a_3$ 的一个祖先。\n如果 $p_1$ 是 $d$ 的祖先，那么根据传递性，$p_1$ 也必须是 $b_1$ 的祖先。然而，$p_1$ 不在 $\\mathrm{Anc}(b_1)$ 中。这意味着 $p_1$ 不能是 $d$ 的祖先。\n\n这并不矛盾。在 DAG 中，一个节点可以有多个父节点（多重继承）。给定的集合与这样一种结构是一致的：$a_3$ 至少有两个父系路径：一个通过祖先 $u_1$，其祖先集包括 $\\{d, p_2, r\\}$；另一个通过祖先 $u_2$，其祖先集包括 $\\{p_1, r\\}$。术语 $d$ 和 $p_1$ 可以都是 $a_3$ 的祖先，而彼此之间没有祖先关系。\n\n因此，所提供的祖先集与 DAG 的属性是一致的。该问题是自洽的、适定的，并且在科学上是合理的。\n\n**步骤 3：结论与行动**\n\n问题是有效的。我将继续进行解答。\n\n### 解答\n\n解答过程按照题目要求分为三个步骤。\n\n**1. 计算信息内容 (IC)**\nIC 定义为 $\\mathrm{IC}(t) = -\\ln p(t)$。鉴于概率的形式为 $p(t) = \\exp(-k)$，IC 简化为 $\\mathrm{IC}(t) = -\\ln(\\exp(-k)) = k$。\n我们需要计算所有在 $T_X$ 中任一术语与 $T_Y$ 中任一术语之间可能成为共同祖先的术语的 IC。通过检查祖先集，这些术语是 $r$、$p_1$、$p_2$ 和 $d$。\n\n- $\\mathrm{IC}(r) = -\\ln(p(r)) = -\\ln(1) = 0$。\n- $\\mathrm{IC}(p_1) = -\\ln(p(p_1)) = -\\ln(\\exp(-1)) = 1$。\n- $\\mathrm{IC}(p_2) = -\\ln(p(p_2)) = -\\ln(\\exp(-1.2)) = 1.2$。\n- $\\mathrm{IC}(d) = -\\ln(p(d)) = -\\ln(\\exp(-1.6)) = 1.6$。\n\n**2. 计算逐对 Resnik 语义相似度**\nResnik 相似度是 $\\mathrm{sim}_{\\mathrm{Resnik}}(t_i, t_j) = \\max\\{\\mathrm{IC}(u) : u \\in \\mathrm{Anc}(t_i) \\cap \\mathrm{Anc}(t_j)\\}$。我们必须为所有 6 对 $(a_i, b_j)$（其中 $a_i \\in T_X$ 且 $b_j \\in T_Y$）计算此值。\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_1)$:**\n  $\\mathrm{Anc}(a_1) \\cap \\mathrm{Anc}(b_1) = \\{a_1, c_1, p_1, r\\} \\cap \\{b_1, d, p_2, r\\} = \\{r\\}$。\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_1) = \\max\\{\\mathrm{IC}(r)\\} = 0$。\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_2)$:**\n  $\\mathrm{Anc}(a_1) \\cap \\mathrm{Anc}(b_2) = \\{a_1, c_1, p_1, r\\} \\cap \\{b_2, n_2, p_2, r\\} = \\{r\\}$。\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_2) = \\max\\{\\mathrm{IC}(r)\\} = 0$。\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_1)$:**\n  $\\mathrm{Anc}(a_2) \\cap \\mathrm{Anc}(b_1) = \\{a_2, c_2, p_1, r\\} \\cap \\{b_1, d, p_2, r\\} = \\{r\\}$。\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_1) = \\max\\{\\mathrm{IC}(r)\\} = 0$。\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_2)$:**\n  $\\mathrm{Anc}(a_2) \\cap \\mathrm{Anc}(b_2) = \\{a_2, c_2, p_1, r\\} \\cap \\{b_2, n_2, p_2, r\\} = \\{r\\}$。\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_2) = \\max\\{\\mathrm{IC}(r)\\} = 0$。\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_1)$:**\n  $\\mathrm{Anc}(a_3) \\cap \\mathrm{Anc}(b_1) = \\{a_3, d, p_2, p_1, r\\} \\cap \\{b_1, d, p_2, r\\} = \\{d, p_2, r\\}$。\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_1) = \\max\\{\\mathrm{IC}(d), \\mathrm{IC}(p_2), \\mathrm{IC}(r)\\} = \\max\\{1.6, 1.2, 0\\} = 1.6$。\n\n- **$\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_2)$:**\n  $\\mathrm{Anc}(a_3) \\cap \\mathrm{Anc}(b_2) = \\{a_3, d, p_2, p_1, r\\} \\cap \\{b_2, n_2, p_2, r\\} = \\{p_2, r\\}$。\n  $\\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_2) = \\max\\{\\mathrm{IC}(p_2), \\mathrm{IC}(r)\\} = \\max\\{1.2, 0\\} = 1.2$。\n\n逐对相似度矩阵如下：\n$$\n\\begin{array}{c|cc}\n\\mathrm{sim}_{\\mathrm{Resnik}}  b_1  b_2 \\\\\n\\hline\na_1  0  0 \\\\\na_2  0  0 \\\\\na_3  1.6  1.2 \\\\\n\\end{array}\n$$\n\n**3. 使用最佳匹配平均法 (BMA) 进行聚合**\nBMA 相似度是两个方向性平均值的均值。\n设从集合 $A$ 到集合 $B$ 的方向性平均值表示为 $\\mathrm{sim}_{avg}(A \\to B)$。\n$$\n\\mathrm{sim}_{BMA}(X, Y) = \\frac{1}{2} \\left( \\mathrm{sim}_{avg}(T_X \\to T_Y) + \\mathrm{sim}_{avg}(T_Y \\to T_X) \\right)\n$$\n其中\n$$\n\\mathrm{sim}_{avg}(T_X \\to T_Y) = \\frac{1}{|T_X|} \\sum_{a_i \\in T_X} \\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_j)\n$$\n且\n$$\n\\mathrm{sim}_{avg}(T_Y \\to T_X) = \\frac{1}{|T_Y|} \\sum_{b_j \\in T_Y} \\max_{a_i \\in T_X} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_j)\n$$\n\n首先，我们计算从 $T_X$ 到 $T_Y$ 的方向性平均值。$|T_X| = 3$。\n- 对于 $a_1$：$\\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_1, b_j) = \\max\\{0, 0\\} = 0$。\n- 对于 $a_2$：$\\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_2, b_j) = \\max\\{0, 0\\} = 0$。\n- 对于 $a_3$：$\\max_{b_j \\in T_Y} \\mathrm{sim}_{\\mathrm{Resnik}}(a_3, b_j) = \\max\\{1.6, 1.2\\} = 1.6$。\n$$\n\\mathrm{sim}_{avg}(T_X \\to T_Y) = \\frac{1}{3} (0 + 0 + 1.6) = \\frac{1.6}{3}\n$$\n\n接下来，我们计算从 $T_Y$ 到 $T_X$ 的方向性平均值。$|T_Y| = 2$。\n- 对于 $b_1$：$\\max_{a_i \\in T_X} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_1) = \\max\\{0, 0, 1.6\\} = 1.6$。\n- 对于 $b_2$：$\\max_{a_i \\in T_X} \\mathrm{sim}_{\\mathrm{Resnik}}(a_i, b_2) = \\max\\{0, 0, 1.2\\} = 1.2$。\n$$\n\\mathrm{sim}_{avg}(T_Y \\to T_X) = \\frac{1}{2} (1.6 + 1.2) = \\frac{2.8}{2} = 1.4\n$$\n\n最后，我们计算 BMA 相似度分数。\n$$\n\\mathrm{sim}_{BMA}(X, Y) = \\frac{1}{2} \\left( \\frac{1.6}{3} + 1.4 \\right)\n$$\n为了将其表示为精确分数：\n$$\n\\frac{1.6}{3} = \\frac{16/10}{3} = \\frac{16}{30} = \\frac{8}{15}\n$$\n$$\n1.4 = \\frac{14}{10} = \\frac{7}{5}\n$$\n$$\n\\mathrm{sim}_{BMA}(X, Y) = \\frac{1}{2} \\left( \\frac{8}{15} + \\frac{7}{5} \\right) = \\frac{1}{2} \\left( \\frac{8}{15} + \\frac{21}{15} \\right) = \\frac{1}{2} \\left( \\frac{29}{15} \\right) = \\frac{29}{30}\n$$\n最终的疾病-疾病相似度分数为 $\\frac{29}{30}$。", "answer": "$$\\boxed{\\frac{29}{30}}$$", "id": "4393308"}, {"introduction": "从共享的遗传因素出发构建疾病网络是系统生物学中的常用方法，这通常通过投影一个疾病-基因二分图来实现。然而，简单地计算共享基因的数量可能会产生误导，因为它没有考虑到节点的度分布。本练习 [@problem_id:4393323] 将向你展示如何使用一个零模型（二分图配置模型，BiCM）来评估投影连边的统计显著性，这是区分真实生物信号与随机预期的关键步骤。", "problem": "在系统生物医学中，人类疾病组网络通常是通过将疾病-基因关联二分图投影到疾病层来构建的。假设一个二分图拥有一个疾病集合 $\\mathcal{D}=\\{D_{1},D_{2},D_{3},D_{4}\\}$ 和一个基因集合 $\\mathcal{G}=\\{G_{1},G_{2},G_{3},G_{4},G_{5}\\}$。疾病与基因之间的邻接关系由一个二元矩阵 $B \\in \\{0,1\\}^{4 \\times 5}$ 给出，其非零元素定义如下：$B_{1,1}=1$, $B_{1,2}=1$, $B_{1,4}=1$; $B_{2,1}=1$, $B_{2,3}=1$, $B_{2,4}=1$; $B_{3,1}=1$, $B_{3,3}=1$, $B_{3,5}=1$; $B_{4,2}=1$, $B_{4,3}=1$, $B_{4,5}=1$。这对应于疾病 $D_{1}$ 连接到基因 $\\{G_{1},G_{2},G_{4}\\}$，$D_{2}$ 连接到 $\\{G_{1},G_{3},G_{4}\\}$，$D_{3}$ 连接到 $\\{G_{1},G_{3},G_{5}\\}$，以及 $D_{4}$ 连接到 $\\{G_{2},G_{3},G_{5}\\}$。\n\n您将分析度校正的归一化如何影响投影网络中高置信度疾病-疾病边的识别。使用二分图投影、度序列和二分图配置模型（BiCM）的标准定义作为基础，其中BiCM被理解为一个保持期望度的最大熵零模型。\n\n从第一性原理出发，不调用任何预封装的投影公式，按以下步骤进行。首先，将原始加权疾病-疾病投影权重 $w^{(0)}_{ij}$ 定义为 $D_{i}$ 和 $D_{j}$ 之间共享基因的数量，并用 $B$ 表示。然后，使用基因度 $k_{g}=\\sum_{i} B_{i g}$，定义并计算一个度校正的资源分配（RA）权重 $w^{(\\mathrm{RA})}_{ij}$，该权重对来自高度基因的贡献进行降权。\n\n接下来，为评估统计置信度，采用二分图配置模型（BiCM），其中疾病-基因的关联事件是独立的伯努利变量，其概率为 $\\{p_{ig}\\}$，并被约束以重现期望的疾病度 $k_{i}=\\sum_{g} B_{i g}$ 和基因度 $k_{g}$。使用与BiCM约束和全期望定律一致的、广泛使用的末端匹配近似法，在基因间独立的假设下，推导 $D_{i}$ 和 $D_{j}$ 之间共享基因的期望共现 $\\mathbb{E}[X_{i j}]$ 及其方差 $\\mathrm{Var}(X_{i j})$ 的解析表达式，并用 $\\{k_{i}\\}$、$\\{k_{g}\\}$ 和总边数 $m=\\sum_{i,g} B_{i g}$ 表示。利用这些结果为每个疾病对计算一个 $z$-分数 $z_{ij}=\\big(w^{(0)}_{i j}-\\mathbb{E}[X_{i j}]\\big)/\\sqrt{\\mathrm{Var}(X_{i j})}$。\n\n用两种方式定义“高置信度”边：(a) 朴素标准，即如果 $w^{(0)}_{i j} \\geq 2$，则该对为高置信度；(b) 度校正的统计标准，即如果 $z_{ij} \\geq 2$（单侧正偏差），则该对为高置信度。在此数据集上评估这两种标准。\n\n最后，令 $N_{\\mathrm{naive}}$ 为根据朴素标准被视为高置信度的疾病对数量，令 $N_{\\mathrm{BiCM}}$ 为根据BiCM $z$-分数标准被视为高置信度的疾病对数量。报告差值 $\\Delta=N_{\\mathrm{naive}}-N_{\\mathrm{BiCM}}$ 作为您的最终答案。您的最终答案应为一个精确整数，不带单位。", "solution": "问题陈述具有科学依据、提法恰当、客观且自洽，为得出唯一解提供了所有必要的数据和定义。其所需的方法——二分网络投影、二分图配置模型（BiCM）和z-分数显著性检验——在网络科学和系统生物学中是标准方法。因此，该问题是有效的。\n\n问题要求对一个给定的疾病-基因二分网络进行分析。我们已知疾病集合 $\\mathcal{D}=\\{D_{1}, D_{2}, D_{3}, D_{4}\\}$ 和基因集合 $\\mathcal{G}=\\{G_{1}, G_{2}, G_{3}, G_{4}, G_{5}\\}$。关联由一个二元邻接矩阵 $B$ 定义，其中如果疾病 $D_i$ 与基因 $G_g$ 相关联，则 $B_{ig}=1$。根据提供的非零元素列表，矩阵 $B$ 为：\n$$\nB = \\begin{pmatrix}\n1  1  0  1  0 \\\\\n1  0  1  1  0 \\\\\n1  0  1  0  1 \\\\\n0  1  1  0  1\n\\end{pmatrix}\n$$\n行对应于疾病 $D_1$ 到 $D_4$，列对应于基因 $G_1$ 到 $G_5$。\n\n首先，我们计算所有节点的度。疾病节点 $D_i$ 的度，记为 $k_i$，是与其关联的基因数量。这是矩阵 $B$ 第 $i$ 行各项的和。基因节点 $G_g$ 的度，记为 $k_g$，是与其关联的疾病数量。这是矩阵 $B$ 第 $g$ 列各项的和。\n\n疾病度：\n$k_1 = \\sum_{g=1}^{5} B_{1g} = 1+1+0+1+0 = 3$\n$k_2 = \\sum_{g=1}^{5} B_{2g} = 1+0+1+1+0 = 3$\n$k_3 = \\sum_{g=1}^{5} B_{3g} = 1+0+1+0+1 = 3$\n$k_4 = \\sum_{g=1}^{5} B_{4g} = 0+1+1+0+1 = 3$\n疾病度序列为 $\\{k_i\\} = (3, 3, 3, 3)$。\n\n基因度：\n$k_{G_1} = \\sum_{i=1}^{4} B_{i1} = 1+1+1+0 = 3$\n$k_{G_2} = \\sum_{i=1}^{4} B_{i2} = 1+0+0+1 = 2$\n$k_{G_3} = \\sum_{i=1}^{4} B_{i3} = 0+1+1+1 = 3$\n$k_{G_4} = \\sum_{i=1}^{4} B_{i4} = 1+1+0+0 = 2$\n$k_{G_5} = \\sum_{i=1}^{4} B_{i5} = 0+0+1+1 = 2$\n基因度序列为 $\\{k_g\\} = (3, 2, 3, 2, 2)$。\n\n网络中的总边数 $m$ 是其中一个部分所有度的总和：\n$m = \\sum_{i=1}^{4} k_i = 3+3+3+3 = 12$。\n这必须等于另一部分所有度的总和：$\\sum_{g=1}^{5} k_g = 3+2+3+2+2 = 12$。计数是一致的。\n\n两个疾病 $D_i$ 和 $D_j$ 之间的原始加权投影权重 $w^{(0)}_{ij}$ 是它们共享的基因数量。这可以从邻接矩阵 $B$ 计算得出：\n$$\nw^{(0)}_{ij} = \\sum_{g=1}^{5} B_{ig}B_{jg}\n$$\n这是 $B$ 矩阵第 $i$ 行和第 $j$ 行的点积。我们为所有 $\\binom{4}{2}=6$ 个唯一的疾病对（$i  j$）计算这些值：\n$w^{(0)}_{12} = \\sum_g B_{1g}B_{2g} = 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 1 + 0 \\cdot 0 = 2$\n$w^{(0)}_{13} = \\sum_g B_{1g}B_{3g} = 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 1$\n$w^{(0)}_{14} = \\sum_g B_{1g}B_{4g} = 1 \\cdot 0 + 1 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 1$\n$w^{(0)}_{23} = \\sum_g B_{2g}B_{3g} = 1 \\cdot 1 + 0 \\cdot 0 + 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 2$\n$w^{(0)}_{24} = \\sum_g B_{2g}B_{4g} = 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 1 = 1$\n$w^{(0)}_{34} = \\sum_g B_{3g}B_{4g} = 1 \\cdot 0 + 0 \\cdot 1 + 1 \\cdot 1 + 0 \\cdot 0 + 1 \\cdot 1 = 2$\n\n题目接着要求定义和计算度校正的资源分配（RA）权重 $w^{(\\mathrm{RA})}_{ij}$。标准定义是：\n$$\nw^{(\\mathrm{RA})}_{ij} = \\sum_{g=1}^{5} \\frac{B_{ig}B_{jg}}{k_g}\n$$\n使用先前计算的基因度 $\\{k_g\\} = (3, 2, 3, 2, 2)$：\n$w^{(\\mathrm{RA})}_{12} = \\frac{1}{k_{G_1}} + \\frac{1}{k_{G_4}} = \\frac{1}{3} + \\frac{1}{2} = \\frac{5}{6}$\n$w^{(\\mathrm{RA})}_{13} = \\frac{1}{k_{G_1}} = \\frac{1}{3}$\n$w^{(\\mathrm{RA})}_{14} = \\frac{1}{k_{G_2}} = \\frac{1}{2}$\n$w^{(\\mathrm{RA})}_{23} = \\frac{1}{k_{G_1}} + \\frac{1}{k_{G_3}} = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}$\n$w^{(\\mathrm{RA})}_{24} = \\frac{1}{k_{G_3}} = \\frac{1}{3}$\n$w^{(\\mathrm{RA})}_{34} = \\frac{1}{k_{G_3}} + \\frac{1}{k_{G_5}} = \\frac{1}{3} + \\frac{1}{2} = \\frac{5}{6}$\n\n接下来，我们评估“高置信度”边的两个标准。\n(a) 朴素标准是 $w^{(0)}_{ij} \\geq 2$。满足此条件的对是 (1,2)、(2,3) 和 (3,4)。因此，根据朴素标准，高置信度对的数量为 $N_{\\mathrm{naive}} = 3$。\n\n(b) 度校正的统计标准基于从 BiCM 零模型导出的 z 分数。z 分数为 $z_{ij} = (w^{(0)}_{ij} - \\mathbb{E}[X_{ij}])/\\sqrt{\\mathrm{Var}(X_{ij})}$，其中 $X_{ij}$ 是共享基因数量的随机变量。\n\n在 BiCM 下，使用末端匹配近似，疾病 $D_i$ 和基因 $G_g$ 之间存在一条边的概率是 $p_{ig} = \\frac{k_i k_g}{m}$。将边 $(i,g)$ 和 $(j,g)$ 的形成视为独立事件，则 $D_i$ 和 $D_j$ 都链接到 $G_g$ 的事件概率为 $p_{ig}p_{jg}$。令 $X_{ijg}$ 为此事件的指示变量。则 $\\mathbb{E}[X_{ijg}] = p_{ig}p_{jg} = \\frac{k_i k_j k_g^2}{m^2}$。\n共享基因的总期望数量是 $\\mathbb{E}[X_{ij}] = \\mathbb{E}[\\sum_g X_{ijg}] = \\sum_g \\mathbb{E}[X_{ijg}]$。\n$$\n\\mathbb{E}[X_{ij}] = \\sum_{g=1}^{5} \\frac{k_i k_j k_g^2}{m^2} = \\frac{k_i k_j}{m^2} \\sum_{g=1}^{5} k_g^2\n$$\n由于所有疾病的度都是 $k_i=3$，对于任何疾病对 $(i,j)$，其乘积 $k_i k_j = 3 \\times 3 = 9$。我们有 $m=12$ 并且 $\\sum_{g} k_g^2 = 3^2 + 2^2 + 3^2 + 2^2 + 2^2 = 9+4+9+4+4 = 30$。\n$$\n\\mathbb{E}[X_{ij}] = \\frac{9}{12^2} \\times 30 = \\frac{9}{144} \\times 30 = \\frac{1}{16} \\times 30 = \\frac{15}{8} = 1.875\n$$\n这个期望值对所有疾病对都是相同的。\n\n对于方差，问题明确了基因间独立的假设。这意味着 $\\mathrm{Var}(X_{ij}) = \\mathrm{Var}(\\sum_g X_{ijg}) = \\sum_g \\mathrm{Var}(X_{ijg})$。由于 $X_ {ijg}$ 是一个成功概率为 $p_{g} = p_{ig}p_{jg}$ 的伯努利变量，其方差为 $p_{g}(1-p_{g})$。\n$$\n\\mathrm{Var}(X_{ij}) = \\sum_{g=1}^{5} \\left(\\frac{k_i k_j k_g^2}{m^2}\\right) \\left(1 - \\frac{k_i k_j k_g^2}{m^2}\\right)\n$$\n代入 $k_i k_j=9$ 和 $m=12$：\n$$\n\\mathrm{Var}(X_{ij}) = \\sum_{g=1}^{5} \\left(\\frac{9 k_g^2}{144}\\right) \\left(1 - \\frac{9 k_g^2}{144}\\right) = \\sum_{g=1}^{5} \\frac{k_g^2}{16} \\left(1 - \\frac{k_g^2}{16}\\right)\n$$\n基因度的平方为 $\\{k_g^2\\} = (9, 4, 9, 4, 4)$。\n$g=1$ 的项 ($k_{G_1}^2=9$)： $\\frac{9}{16} (1 - \\frac{9}{16}) = \\frac{9}{16} \\times \\frac{7}{16} = \\frac{63}{256}$。\n$g=2$ 的项 ($k_{G_2}^2=4$)： $\\frac{4}{16} (1 - \\frac{4}{16}) = \\frac{1}{4} \\times \\frac{3}{4} = \\frac{3}{16} = \\frac{48}{256}$。\n$g=3$ 的项 ($k_{G_3}^2=9$)： $\\frac{9}{16} (1 - \\frac{9}{16}) = \\frac{63}{256}$。\n$g=4$ 的项 ($k_{G_4}^2=4$)： $\\frac{4}{16} (1 - \\frac{4}{16}) = \\frac{48}{256}$。\n$g=5$ 的项 ($k_{G_5}^2=4$)： $\\frac{4}{16} (1 - \\frac{4}{16}) = \\frac{48}{256}$。\n将这些项相加：\n$$\n\\mathrm{Var}(X_{ij}) = \\frac{63+48+63+48+48}{256} = \\frac{270}{256} = \\frac{135}{128}\n$$\n标准差为 $\\sigma_{ij} = \\sqrt{\\mathrm{Var}(X_{ij})} = \\sqrt{\\frac{135}{128}}$。\n\n现在我们计算z-分数 $z_{ij} = (w^{(0)}_{ij} - \\mathbb{E}[X_{ij}])/\\sigma_{ij}$。\n这些对的 $w^{(0)}_{ij}$ 值要么是 1 要么是 2。\n对于 $w^{(0)}_{ij} = 2$ 的对：(1,2)、(2,3)、(3,4)。\n$z_{ij} = \\frac{2 - 1.875}{\\sqrt{135/128}} = \\frac{0.125}{\\sqrt{135/128}} = \\frac{1/8}{\\sqrt{135/128}}$。\n要检查是否 $z_{ij} \\geq 2$，我们测试 $\\frac{1}{8} \\geq 2\\sqrt{\\frac{135}{128}}$ 是否成立。两边平方得到 $\\frac{1}{64} \\geq 4 \\times \\frac{135}{128} = \\frac{135}{32}$，这显然是错误的。所以 $z_{ij}  2$。\n\n对于 $w^{(0)}_{ij} = 1$ 的对：(1,3)、(1,4)、(2,4)。\n$z_{ij} = \\frac{1 - 1.875}{\\sqrt{135/128}} = \\frac{-0.875}{\\sqrt{135/128}}$。这个值是负数，因此小于2。\n\n没有疾病对满足条件 $z_{ij} \\geq 2$。因此，根据 BiCM 标准，高置信度对的数量为 $N_{\\mathrm{BiCM}} = 0$。\n\n最后，我们计算所要求的差值 $\\Delta = N_{\\mathrm{naive}} - N_{\\mathrm{BiCM}}$。\n$$\n\\Delta = 3 - 0 = 3\n$$\n这一结果凸显了朴素阈值方法可能高估连接的显著性。BiCM零模型通过考虑基于度的期望，提供了一个更严格的统计评估，揭示出观测到的共现在这个网络中不具有统计显著性。", "answer": "$$\n\\boxed{3}\n$$", "id": "4393323"}, {"introduction": "构建疾病网络后，我们可以通过分析其拓扑结构来发现关键的疾病节点。这个练习 [@problem_id:4393332] 探讨了如何应用网络中心性理论来对疾病进行排序。通过计算并比较简单的度中心性（Degree Centrality）与更复杂的特征向量中心性（Eigenvector Centrality），你将理解不同中心性指标如何揭示疾病在网络中所扮演的不同角色和影响力。", "problem": "在系统生物医学中，人类疾病组网络是一个疾病-基因二分关联网络的疾病-疾病投影，其中如果两种疾病共享蛋白质编码基因，则它们之间存在连接。考虑一个包含三种疾病 $D_A$、$D_B$ 和 $D_C$ 的简易、无向、加权疾病组网络。边权重 $w_{ij}$ 等于疾病 $i$ 和 $j$ 之间共享的蛋白质编码基因的数量，其中 $w_{AB} = 1$，$w_{AC} = 1$，$w_{BC} = 3$，并且对所有 $i$ 都有 $w_{ii} = 0$。加权邻接矩阵是实对称矩阵 $A$，其元素为 $a_{ij} = w_{ij}$。\n\n从实对称矩阵的谱定理和不可约非负矩阵的 Perron–Frobenius 定理 (PF) 出发，将特征向量中心性 (EC) 定义为与 $A$ 的最大特征值相关联的正特征向量。对 EC 向量进行归一化，使其各分量之和为 $1$（即，使用 $\\ell_{1}$ 归一化）。将加权度中心性 (DC) 定义为 $s_i = \\sum_{j} a_{ij}$，并通过总强度进行归一化，$\\hat{s}_i = s_i / \\sum_{k} s_k$，使得归一化后的 DC 各分量之和也为 $1$。\n\n基于这些基础，推导上述网络的归一化 EC 和归一化 DC。然后计算 $D_A$ 的归一化 EC 与 $D_A$ 的归一化 DC 之间的差值。将最终答案表示为一个无量纲实数，并四舍五入到四位有效数字。", "solution": "问题陈述已经过验证，被认为是有效的。它在网络理论和系统生物学方面有科学依据，问题设定良好，具有唯一解和客观性，并包含完整且一致的设置。\n\n第一步是为包含三种疾病 $D_A$、$D_B$ 和 $D_C$ 的网络构建加权邻接矩阵 $A$。令这些疾病分别对应于索引 $1$、$2$ 和 $3$。矩阵的元素 $a_{ij}$ 是权重 $w_{ij}$。已知 $w_{AB} = 1$，$w_{AC} = 1$，$w_{BC} = 3$，以及 $w_{ii}=0$，并且网络是无向的（$w_{ij} = w_{ji}$），矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix} a_{AA}  a_{AB}  a_{AC} \\\\ a_{BA}  a_{BB}  a_{BC} \\\\ a_{CA}  a_{CB}  a_{CC} \\end{pmatrix} = \\begin{pmatrix} 0  1  1 \\\\ 1  0  3 \\\\ 1  3  0 \\end{pmatrix}\n$$\n该矩阵是实的、对称的、非负的且不可约的（因为对应的图是连通的），因此 Perron–Frobenius 定理适用。\n\n首先，我们计算归一化的加权度中心性 (DC)。节点 $i$ 的未归一化度中心性（强度）$s_i$ 是其关联边的权重之和，也就是邻接矩阵中对应行的元素之和：$s_i = \\sum_{j} a_{ij}$。\n对于疾病 $D_A$：$s_A = a_{11} + a_{12} + a_{13} = 0 + 1 + 1 = 2$。\n对于疾病 $D_B$：$s_B = a_{21} + a_{22} + a_{23} = 1 + 0 + 3 = 4$。\n对于疾病 $D_C$：$s_C = a_{31} + a_{32} + a_{33} = 1 + 3 + 0 = 4$。\n\n总强度是所有单个强度之和：$\\sum_k s_k = s_A + s_B + s_C = 2 + 4 + 4 = 10$。\n归一化度中心性 $\\hat{s}_i$ 由 $\\hat{s}_i = s_i / \\sum_k s_k$ 给出。\n对于疾病 $D_A$，其归一化度中心性为：\n$$\nDC_A = \\hat{s}_A = \\frac{2}{10} = \\frac{1}{5} = 0.2\n$$\n\n接下来，我们计算归一化的特征向量中心性 (EC)。这需要找到矩阵 $A$ 的最大特征值对应的特征向量。特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根。\n$$\n\\det\\begin{pmatrix} -\\lambda  1  1 \\\\ 1  -\\lambda  3 \\\\ 1  3  -\\lambda \\end{pmatrix} = 0\n$$\n展开行列式：\n$$\n-\\lambda((-\\lambda)(-\\lambda) - 3 \\cdot 3) - 1(1(-\\lambda) - 3 \\cdot 1) + 1(1 \\cdot 3 - (-\\lambda) \\cdot 1) = 0 \\\\\n-\\lambda(\\lambda^2 - 9) - (-\\lambda - 3) + (3 + \\lambda) = 0 \\\\\n-\\lambda^3 + 9\\lambda + \\lambda + 3 + 3 + \\lambda = 0 \\\\\n-\\lambda^3 + 11\\lambda + 6 = 0 \\\\\n\\lambda^3 - 11\\lambda - 6 = 0\n$$\n通过观察，我们可以测试 $-6$ 的整数因子。对于 $\\lambda = -3$：$(-3)^3 - 11(-3) - 6 = -27 + 33 - 6 = 0$。因此，$(\\lambda+3)$ 是一个因子。将 $(\\lambda^3 - 11\\lambda - 6)$ 除以 $(\\lambda+3)$ 进行多项式除法，得到 $\\lambda^2 - 3\\lambda - 2$。\n剩下的特征值是 $\\lambda^2 - 3\\lambda - 2 = 0$ 的根。使用求根公式：\n$$\n\\lambda = \\frac{-(-3) \\pm \\sqrt{(-3)^2 - 4(1)(-2)}}{2} = \\frac{3 \\pm \\sqrt{9+8}}{2} = \\frac{3 \\pm \\sqrt{17}}{2}\n$$\n三个特征值是 $\\lambda_1 = \\frac{3 + \\sqrt{17}}{2}$，$\\lambda_2 = \\frac{3 - \\sqrt{17}}{2}$ 和 $\\lambda_3 = -3$。\n数值上，$\\sqrt{17} \\approx 4.123$，所以 $\\lambda_1 \\approx 3.562$，$\\lambda_2 \\approx -0.562$，$\\lambda_3 = -3$。最大特征值是 $\\lambda_{\\text{max}} = \\frac{3 + \\sqrt{17}}{2}$。\n\n现在，我们通过求解 $(A - \\lambda_{\\text{max}} I)\\mathbf{v} = \\mathbf{0}$ 来找到与 $\\lambda_{\\text{max}}$ 对应的特征向量 $\\mathbf{v} = (v_A, v_B, v_C)^T$。\n$$\n\\begin{pmatrix} -\\lambda_{\\text{max}}  1  1 \\\\ 1  -\\lambda_{\\text{max}}  3 \\\\ 1  3  -\\lambda_{\\text{max}} \\end{pmatrix} \\begin{pmatrix} v_A \\\\ v_B \\\\ v_C \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n由第二行得：$v_A - \\lambda_{\\text{max}} v_B + 3v_C = 0$。\n由第三行得：$v_A + 3v_B - \\lambda_{\\text{max}} v_C = 0$。\n将第三个方程减去第二个方程得到 $(3 + \\lambda_{\\text{max}})v_B - (3 + \\lambda_{\\text{max}})v_C = 0$。因为 $\\lambda_{\\text{max}} \\neq -3$，这意味着 $v_B = v_C$。\n将 $v_C = v_B$ 代入第二个方程：$v_A - \\lambda_{\\text{max}}v_B + 3v_B = 0$，得到 $v_A = (\\lambda_{\\text{max}} - 3)v_B$。\n特征向量与 $\\mathbf{v'} = ((\\lambda_{\\text{max}} - 3), 1, 1)^T$ 成正比。\n我们来计算第一个分量的值：\n$$\n\\lambda_{\\text{max}} - 3 = \\frac{3 + \\sqrt{17}}{2} - 3 = \\frac{3 + \\sqrt{17} - 6}{2} = \\frac{\\sqrt{17} - 3}{2}\n$$\n因此，未归一化的特征向量是 $\\mathbf{v'} = \\left(\\frac{\\sqrt{17} - 3}{2}, 1, 1\\right)^T$。由于 $\\sqrt{17} > 3$，所有分量都是正的，这由 Perron-Frobenius 定理保证。\n\n为了得到 EC 向量，我们使用 $\\ell_1$ 范数对 $\\mathbf{v'}$ 进行归一化，即使其分量之和等于 $1$。\n各分量之和为：\n$$\nS = \\frac{\\sqrt{17} - 3}{2} + 1 + 1 = \\frac{\\sqrt{17} - 3 + 2 + 2}{2} = \\frac{\\sqrt{17} + 1}{2}\n$$\n疾病 $D_A$ 的归一化 EC 是 $\\mathbf{v'}$ 的第一个分量除以总和 $S$：\n$$\nEC_A = \\frac{(\\sqrt{17} - 3)/2}{(\\sqrt{17} + 1)/2} = \\frac{\\sqrt{17} - 3}{\\sqrt{17} + 1}\n$$\n为了简化，我们对分母进行有理化：\n$$\nEC_A = \\frac{\\sqrt{17} - 3}{\\sqrt{17} + 1} \\times \\frac{\\sqrt{17} - 1}{\\sqrt{17} - 1} = \\frac{17 - \\sqrt{17} - 3\\sqrt{17} + 3}{17 - 1} = \\frac{20 - 4\\sqrt{17}}{16} = \\frac{5 - \\sqrt{17}}{4}\n$$\n\n最后，我们计算 $D_A$ 的归一化 EC 与 $D_A$ 的归一化 DC 之间的差值。\n$$\n\\text{Difference} = EC_A - DC_A = \\frac{5 - \\sqrt{17}}{4} - \\frac{1}{5}\n$$\n合并各项：\n$$\n\\text{Difference} = \\frac{5(5 - \\sqrt{17}) - 4(1)}{20} = \\frac{25 - 5\\sqrt{17} - 4}{20} = \\frac{21 - 5\\sqrt{17}}{20}\n$$\n为了提供一个四舍五入到四位有效数字的数值答案，我们近似计算该值：\n$$\n\\sqrt{17} \\approx 4.1231056\n$$\n$$\n\\text{Difference} \\approx \\frac{21 - 5(4.1231056)}{20} = \\frac{21 - 20.615528}{20} = \\frac{0.384472}{20} = 0.0192236\n$$\n四舍五入到四位有效数字得到 $0.01922$。", "answer": "$$\\boxed{0.01922}$$", "id": "4393332"}]}