{"hands_on_practices": [{"introduction": "在网络医学中，并非所有节点（例如基因或蛋白质）都具有同等的重要性。衡量一个节点重要性的方法之一是看它在多大程度上充当了网络中其他节点对之间通信的“桥梁”。本练习将指导您手动计算一个节点的介数中心性（betweenness centrality），从而量化其作为网络中扰动传播潜在瓶颈的角色。[@problem_id:4329672]", "problem": "考虑一个模拟了系统生物医学中疾病相关相互作用图谱一小部分的简单无向网络，其节点为 $A$、$B$、$C$、$D$ 和 $E$，无向边为 $\\{(A,B),(B,C),(C,D),(D,E),(A,C)\\}$。在网络医学中，通常研究局部扰动如何沿着最小化拓扑距离的路径传播，以及某些节点如何可能作为瓶颈来限制这些传播。使用无向简单图的介数中心性的标准定义——即对于每一对满足 $s \\neq C \\neq t$ 的不同节点 $s,t$ 的无序对，计算节点 $C$ 严格位于 $s$ 和 $t$ 之间的最短路径占 $s$ 和 $t$ 之间所有最短路径的比例，然后用此类无序对的总数进行归一化——计算节点 $C$ 的介数中心性。将您的最终答案表示为一个最简分数。根据计算出的值，判断节点 $C$ 在此网络中是否作为基于最短路径的扰动传播的瓶颈，并请将您的推理建立在网络医学的基本概念之上，避免使用除最短路径考量之外的经验捷径或特定启发式方法。", "solution": "该网络是一个简单无向图 $G=(V,E)$，其中 $V=\\{A,B,C,D,E\\}$，$E=\\{(A,B),(B,C),(C,D),(D,E),(A,C)\\}$。在此类图中，两个节点 $s$ 和 $t$ 之间的最短路径是连接 $s$ 和 $t$ 的具有最少边数的任何路径。对于一个无向图，一个节点的介数中心性定义为：对所有不包含节点 $C$ 的不同节点无序对 $\\{s,t\\}$（即 $s,t \\in V \\setminus \\{C\\}$），将包含节点 $C$ 作为内部节点（即 $C$ 严格位于 $s$ 和 $t$ 之间）的最短路径数占 $s$ 和 $t$ 之间总最短路径数的比例进行求和，然后用不包含 $C$ 的节点无序对的总数进行归一化。\n\n我们按以下步骤进行。首先，列出所有满足 $s,t \\in V \\setminus \\{C\\}$ 的无序对 $\\{s,t\\}$。由于 $V \\setminus \\{C\\}=\\{A,B,D,E\\}$ 有 4 个元素，无序对的数量为 $\\binom{4}{2}=6$。这些对是：\n\n$$\n\\{A,B\\},\\quad \\{A,D\\},\\quad \\{A,E\\},\\quad \\{B,D\\},\\quad \\{B,E\\},\\quad \\{D,E\\}.\n$$\n\n\n对于每一对，我们找出最短路径长度并计算最短路径的数量。然后，我们确定节点 $C$ 是否位于这些最短路径上，并计算包含 $C$ 的最短路径的比例。\n\n1. 对 $\\{A,B\\}$：存在一条长度为 1 的直接边 $(A,B)$。任何经过 $C$ 的路径，如 $A \\to C \\to B$，长度为 2，不是最短路径。因此，$C$ 的贡献分数为 $0$。\n\n2. 对 $\\{A,D\\}$：路径包括长度为 2 的 $A \\to C \\to D$ 和长度为 3 的 $A \\to B \\to C \\to D$。唯一的最短路径是 $A \\to C \\to D$，它包含 $C$。因此，$C$ 的贡献分数为 $1$。\n\n3. 对 $\\{A,E\\}$：考虑长度为 3 的路径 $A \\to C \\to D \\to E$ 和长度为 4 的路径 $A \\to B \\to C \\to D \\to E$。唯一的最短路径是 $A \\to C \\to D \\to E$，它包含 $C$。因此，$C$ 的贡献分数为 $1$。\n\n4. 对 $\\{B,D\\}$：路径包括长度为 2 的 $B \\to C \\to D$ 和长度为 3 的 $B \\to A \\to C \\to D$。唯一的最短路径是 $B \\to C \\to D$，它包含 $C$。因此，$C$ 的贡献分数为 $1$。\n\n5. 对 $\\{B,E\\}$：路径包括长度为 3 的 $B \\to C \\to D \\to E$ 和长度为 4 的 $B \\to A \\to C \\to D \\to E$。唯一的最短路径是 $B \\to C \\to D \\to E$，它包含 $C$。因此，$C$ 的贡献分数为 $1$。\n\n6. 对 $\\{D,E\\}$：存在一条长度为 1 的直接边 $(D,E)$。任何经过 $C$ 的路径都会更长，所以 $C$ 不在最短路径上。因此，$C$ 的贡献分数为 $0$。\n\n将这六对的贡献分数相加，总和为\n\n$$\n0 + 1 + 1 + 1 + 1 + 0 = 4.\n$$\n\n用不包含 $C$ 的无序对的总数 $\\binom{4}{2}=6$ 进行归一化，得到节点 $C$ 的归一化介数中心性：\n\n$$\n\\text{BC}(C) = \\frac{4}{6} = \\frac{2}{3}.\n$$\n\n\n在网络医学中的解释：介数中心性量化了其他节点之间的最短路径通信对节点 $C$ 的依赖程度。在这个网络中，$C$ 位于连接 $\\{A,B\\}$ 集合与 $\\{D,E\\}$ 集合的所有最短路径上，除了那些本身相邻且不需要通过 $C$ 的节点对（即 $\\{A,B\\}$ 和 $\\{D,E\\}$）。$\\frac{2}{3}$ 这个值表明，在除 $C$ 以外的节点之间，大部分基于最短路径的流量都必须经过 $C$。在基于最短路径的扰动传播假设下——这与生物网络中扰动倾向于沿最小拓扑阻力路径传播的观点相一致——节点 $C$ 作为一个瓶颈，连接了由 $\\{A,B,C\\}$ 组成的三角形和线性链 $\\{C,D,E\\}$。因此，源于 $\\{A,B\\}$ 并靶向 $\\{D,E\\}$ 的扰动（反之亦然）很可能穿过 $C$，这使得 $C$ 成为一个关键的介导者，其功能障碍可能会对该网络片段中的跨模块传播产生不成比例的影响。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "4329672"}, {"introduction": "在理解了节点重要性的概念后，我们进一步探索网络中的动态过程。本练习模拟了“疾病影响”如何从一个已知的疾病相关基因扩散到其邻居的第一步，这借鉴了“带重启的随机游走”（Random Walk with Restart）模型的思想。通过这个计算，您将具体了解许多基于网络的疾病基因排序算法背后的基本传播机制。[@problem_id:4329697]", "problem": "考虑一个分子相互作用网络上的疾病传播模型，这是系统生物医学中网络医学的一个核心构念。设该网络被建模为一个有 $5$ 个节点 $\\{1,2,3,4,5\\}$ 的无向、无权重线图，代表了某个通路中的一个线性相互作用链。该图由其邻接矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 编码，其中如果 $|i-j|=1$，则 $A_{ij} = 1$，否则 $A_{ij}=0$。一个疾病种子向量 $Y \\in \\mathbb{R}^{5}$ 编码了每个节点与疾病关联的先验证据，其中 $Y = [1,0,0,0,0]^{\\top}$。疾病影响分数 $f^{(t)} \\in \\mathbb{R}^{5}$ 通过扩散步骤和源保留的凸组合进行演化，这与带重启的随机游走（Random Walk with Restart, RWR）一致，其更新方式为\n$$\nf^{(t+1)} = \\beta A f^{(t)} + (1-\\beta) Y,\n$$\n其中 $\\beta \\in (0,1)$ 是重启参数。假设常规初始化为 $f^{(0)} = Y$，并取 $\\beta = 0.5$。使用上述更新进行一次迭代，为指定的线图和 $Y$ 计算 $f^{(1)}$。将最终答案以包含 $f^{(1)}$ 的 $5$ 个元素的单行矩阵形式报告，要求为精确形式。无需四舍五入，且分数是无量纲的。", "solution": "疾病影响分数向量 $f^{(t)} \\in \\mathbb{R}^{5}$ 的演化由以下迭代方程决定：\n$$\nf^{(t+1)} = \\beta A f^{(t)} + (1-\\beta) Y\n$$\n任务是在给定初始条件 $f^{(0)} = Y$ 的情况下，计算第一次迭代时的分数向量 $f^{(1)}$。在更新方程中令 $t=0$ 可得：\n$$\nf^{(1)} = \\beta A f^{(0)} + (1-\\beta) Y\n$$\n我们已知以下信息：\n$1$. 该网络是一个有 $5$ 个节点的线图，节点标记为 $\\{1, 2, 3, 4, 5\\}$。其连接规则是：当且仅当 $|i-j|=1$ 时，节点 $i$ 和 $j$ 之间存在一条边。因此，这个无权重、无向图的邻接矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 为：\n$$\nA = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}\n$$\n$2$. 疾病种子向量为 $Y = [1, 0, 0, 0, 0]^{\\top}$，根据问题陈述，这也是系统的初始状态，即 $f^{(0)} = Y$。\n$$\nf^{(0)} = \\begin{pmatrix}\n1 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n$3$. 重启参数为 $\\beta = 0.5$。因此，源保留权重为 $(1-\\beta) = 1 - 0.5 = 0.5$。\n\n将给定的 $\\beta$、$f^{(0)}$ 和 $Y$ 的值代入 $f^{(1)}$ 的方程中：\n$$\nf^{(1)} = 0.5 \\cdot A \\cdot f^{(0)} + 0.5 \\cdot Y\n$$\n我们可以提取出标量 $0.5$：\n$$\nf^{(1)} = 0.5 \\left( A f^{(0)} + Y \\right)\n$$\n首先，我们计算邻接矩阵 $A$ 与初始分数向量 $f^{(0)}$ 的乘积。这一项代表了影响从初始状态向其直接邻居的扩散。\n$$\nA f^{(0)} = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n= \\begin{pmatrix}\n(0)(1) + (1)(0) + (0)(0) + (0)(0) + (0)(0) \\\\\n(1)(1) + (0)(0) + (1)(0) + (0)(0) + (0)(0) \\\\\n(0)(1) + (1)(0) + (0)(0) + (1)(0) + (0)(0) \\\\\n(0)(1) + (0)(0) + (1)(0) + (0)(0) + (1)(0) \\\\\n(0)(1) + (0)(0) + (0)(0) + (1)(0) + (0)(0)\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\\n1 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n这个结果表明，来自节点 $1$ 的影响扩散到了其唯一的邻居——节点 $2$。\n\n接下来，我们将此结果代回到 $f^{(1)}$ 的表达式中：\n$$\nf^{(1)} = 0.5 \\left( \\begin{pmatrix}\n0 \\\\\n1 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix} + Y \\right) = 0.5 \\left( \\begin{pmatrix}\n0 \\\\\n1 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix} + \\begin{pmatrix}\n1 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix} \\right)\n$$\n进行向量加法：\n$$\nf^{(1)} = 0.5 \\begin{pmatrix}\n0+1 \\\\\n1+0 \\\\\n0+0 \\\\\n0+0 \\\\\n0+0\n\\end{pmatrix}\n= 0.5 \\begin{pmatrix}\n1 \\\\\n1 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n最后，进行标量乘法得到向量 $f^{(1)}$：\n$$\nf^{(1)} = \\begin{pmatrix}\n0.5 \\\\\n0.5 \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\frac{1}{2} \\\\\n\\frac{1}{2} \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n问题要求答案以单行矩阵的形式呈现。因此，结果向量为 $[\\frac{1}{2}, \\frac{1}{2}, 0, 0, 0]$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2}  0  0  0 \\end{pmatrix}}\n$$", "id": "4329697"}, {"introduction": "除了单个节点和路径，生物网络通常表现出宏观的组织结构，即聚集成执行特定功能的“社区”或“模块”。本练习将介绍模块度（$Q$），这是一个核心指标，用于评估网络划分为社区的优劣程度。通过为一个给定的划分方案计算 $Q$ 值，您将学会如何定量地判断一组蛋白质是否真正构成了一个紧密的疾病模块。[@problem_id:4329713]", "problem": "考虑一个与系统生物医学中的疾病模块推断任务相关的无向加权蛋白质相互作用网络。八个蛋白质（节点）被划分到两个假设的社群中：社群 $\\mathcal{C}_{1} = \\{1, 2, 3, 4\\}$ 和社群 $\\mathcal{C}_{2} = \\{5, 6, 7, 8\\}$。观察到的相互作用强度由邻接矩阵 $A$ 编码，其条目以任意正权重标度为单位，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n0  2  3  0  0  1  0  1 \\\\\n2  0  1  2  1  0  0  0 \\\\\n3  1  0  1  0  1  1  0 \\\\\n0  2  1  0  0  0  1  0 \\\\\n0  1  0  0  0  2  2  1 \\\\\n1  0  1  0  2  0  3  0 \\\\\n0  0  1  1  2  3  0  2 \\\\\n1  0  0  0  1  0  2  0\n\\end{pmatrix}.\n$$\n仅使用网络医学的基本定义和度保持随机图零模型（配置模型），计算给定划分的模块度 $Q$。对于此问题，采用当 $Q  0$ 时，划分表示存在显著模块化结构的标准。将 $Q$ 的数值报告为一个无单位的实数，并将最终结果四舍五入到四位有效数字。", "solution": "模块度 $Q$ 是衡量网络划分为模块或社群的强度的一种度量。对于一个具有邻接矩阵 $A$ 的通用加权无向网络，其对于给定划分的值定义为：\n$$\nQ = \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - P_{ij} \\right] \\delta(c_i, c_j)\n$$\n此处，$A_{ij}$ 是节点 $i$ 和节点 $j$ 之间边的权重。网络中所有边的总权重是 $m = \\frac{1}{2} \\sum_{i,j} A_{ij}$。项 $P_{ij}$ 是在指定零模型下节点 $i$ 和 $j$ 之间边的期望权重。函数 $\\delta(c_i, c_j)$ 是克罗内克δ函数，如果节点 $i$ 和 $j$ 在同一社群中（$c_i = c_j$），其值等于 $1$，否则等于 $0$。\n\n问题指定了度保持随机图零模型，也称为配置模型。在此模型中，节点 $i$ 和 $j$ 之间边的期望权重由下式给出：\n$$\nP_{ij} = \\frac{k_i k_j}{2m}\n$$\n其中 $k_i = \\sum_{j} A_{ij}$ 是节点 $i$ 的强度（加权度），$2m = \\sum_i k_i$ 是网络中所有节点强度的总和。\n\n将此 $P_{ij}$ 的表达式代入 $Q$ 的公式，并通过对社群求和进行简化，得到一个更实用的计算公式：\n$$\nQ = \\sum_{c=1}^{N_c} \\left[ \\frac{l_c}{m} - \\left( \\frac{d_c}{2m} \\right)^2 \\right]\n$$\n其中 $N_c$ 是社群的数量，$l_c$ 是完全在社群 $c$ 内部的边的权重之和，$d_c$ 是社群 $c$ 中所有节点强度的总和。\n\n现在，我们将根据给定的邻接矩阵 $A$ 和划分 $\\mathcal{C}_{1} = \\{1, 2, 3, 4\\}$ 及 $\\mathcal{C}_{2} = \\{5, 6, 7, 8\\}$ 来计算所需的量。\n\n首先，我们通过对 $A$ 中相应行的条目求和来计算 $8$ 个节点中每个节点的强度 $k_i$：\n$k_1 = 0+2+3+0+0+1+0+1 = 7$\n$k_2 = 2+0+1+2+1+0+0+0 = 6$\n$k_3 = 3+1+0+1+0+1+1+0 = 7$\n$k_4 = 0+2+1+0+0+0+1+0 = 4$\n$k_5 = 0+1+0+0+0+2+2+1 = 6$\n$k_6 = 1+0+1+0+2+0+3+0 = 7$\n$k_7 = 0+0+1+1+2+3+0+2 = 9$\n$k_8 = 1+0+0+0+1+0+2+0 = 4$\n\n接下来，我们计算网络总权重 $m$。所有节点强度的总和是 $2m$：\n$$\n2m = \\sum_{i=1}^{8} k_i = 7+6+7+4+6+7+9+4 = 50\n$$\n因此，总边权重为 $m = 25$。\n\n现在，我们分析每个社群。\n\n对于社群 $\\mathcal{C}_{1} = \\{1, 2, 3, 4\\}$：\n其节点强度之和 $d_1$ 为：\n$$\nd_1 = k_1 + k_2 + k_3 + k_4 = 7+6+7+4 = 24\n$$\n内部边的总权重 $l_1$ 是对应于 $\\mathcal{C}_1$ 的子矩阵中条目总和的一半：\n$$\nl_1 = \\frac{1}{2} \\sum_{i,j \\in \\mathcal{C}_1} A_{ij} = A_{12} + A_{13} + A_{23} + A_{24} + A_{34} = 2+3+1+2+1 = 9\n$$\n\n对于社群 $\\mathcal{C}_{2} = \\{5, 6, 7, 8\\}$：\n其节点强度之和 $d_2$ 为：\n$$\nd_2 = k_5 + k_6 + k_7 + k_8 = 6+7+9+4 = 26\n$$\n作为检验，$d_1 + d_2 = 24 + 26 = 50 = 2m$。\n内部边的总权重 $l_2$ 为：\n$$\nl_2 = \\frac{1}{2} \\sum_{i,j \\in \\mathcal{C}_2} A_{ij} = A_{56} + A_{57} + A_{58} + A_{67} + A_{78} = 2+2+1+3+2 = 10\n$$\n\n在计算出所有分量后，我们现在可以计算模块度 $Q$：\n$$\nQ = \\left[ \\frac{l_1}{m} - \\left( \\frac{d_1}{2m} \\right)^2 \\right] + \\left[ \\frac{l_2}{m} - \\left( \\frac{d_2}{2m} \\right)^2 \\right]\n$$\n代入数值：\n$m = 25$\n$2m = 50$\n$l_1 = 9$, $d_1 = 24$\n$l_2 = 10$, $d_2 = 26$\n$$\nQ = \\left[ \\frac{9}{25} - \\left( \\frac{24}{50} \\right)^2 \\right] + \\left[ \\frac{10}{25} - \\left( \\frac{26}{50} \\right)^2 \\right]\n$$\n化简分数：\n$$\nQ = \\left[ \\frac{9}{25} - \\left( \\frac{12}{25} \\right)^2 \\right] + \\left[ \\frac{10}{25} - \\left( \\frac{13}{25} \\right)^2 \\right]\n$$\n$$\nQ = \\left[ \\frac{9}{25} - \\frac{144}{625} \\right] + \\left[ \\frac{10}{25} - \\frac{169}{625} \\right]\n$$\n通分：\n$$\nQ = \\left[ \\frac{225}{625} - \\frac{144}{625} \\right] + \\left[ \\frac{250}{625} - \\frac{169}{625} \\right]\n$$\n$$\nQ = \\frac{81}{625} + \\frac{81}{625} = \\frac{162}{625}\n$$\n将分数转换为小数：\n$$\nQ = 0.2592\n$$\n问题要求答案四舍五入到四位有效数字，而精确值 $0.2592$ 已经满足此要求。由于 $Q = 0.2592 > 0$，根据所述标准，该划分表明存在显著的模块化结构。", "answer": "$$\n\\boxed{0.2592}\n$$", "id": "4329713"}]}