{"hands_on_practices": [{"introduction": "掌握线性系统可控性的代数基础是至关重要的。本练习将引导你应用卡尔曼可控性秩条件（Kalman rank condition），这是判断线性时不变（LTI）系统能否被完全控制的黄金标准。通过计算一个简化的双基因信号模块的可控性矩阵，你将把抽象的数学理论与具体的生物系统模型联系起来 ([@problem_id:4364519])。", "problem": "一个细胞通路中的双基因信号模块在一个稳态平衡点附近被线性化，以研究由代表药物输注的外部控制输入引起的小信号调节。该线性化状态空间模型是一个单输入线性时不变（LTI）系统，由 $\\dot{x}(t)=A x(t)+B u(t)$ 给出，其中 $x(t)\\in\\mathbb{R}^{2}$ 是基因活动偏离稳态的偏差， $u(t)\\in\\mathbb{R}$ 是控制输入。矩阵为\n$$\nA=\\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\n仅使用线性时不变系统能控性的基本定义，计算与 $\\left(A,B\\right)$ 相关的能控性矩阵的秩，并判断该线性化基因模块在平衡点附近是否在小信号意义下是能控的。将能控性矩阵的秩 $\\operatorname{rank}(\\mathcal{C})$ 作为最终答案报告，形式为单个整数，无单位。无需四舍五入。", "solution": "问题要求评估一个由线性时不变（LTI）状态空间模型描述的线性化双基因信号模块的能控性。该模型由方程 $\\dot{x}(t)=A x(t)+B u(t)$ 给出，其中状态维度为 $n=2$。给定的矩阵为：\n$$\nA=\\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\n$$\nLTI 系统的能控性由其能控性矩阵的秩决定，记为 $\\mathcal{C}$。对于一个维度为 $n$ 的系统，能控性矩阵构造如下：\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB  A^2B  \\cdots  A^{n-1}B \\end{bmatrix}\n$$\n系统是能控的当且仅当能控性矩阵 $\\mathcal{C}$ 满秩，即 $\\operatorname{rank}(\\mathcal{C}) = n$。这被称为卡尔曼能控性秩条件。\n\n对于给定的系统，状态维度为 $n=2$。因此，能控性矩阵由下式给出：\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB \\end{bmatrix}\n$$\n$\\mathcal{C}$ 的第一列是输入矩阵 $B$ 本身：\n$$\nB = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n$\\mathcal{C}$ 的第二列是状态矩阵 $A$ 和输入矩阵 $B$ 的乘积。我们计算这个乘积：\n$$\nAB = \\begin{bmatrix}0  1 \\\\ -2  -3\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\end{bmatrix}\n$$\n现在，我们可以通过拼接列向量 $B$ 和 $AB$ 来构建能控性矩阵 $\\mathcal{C}$：\n$$\n\\mathcal{C} = \\begin{bmatrix} 0  1 \\\\ 1  -3 \\end{bmatrix}\n$$\n为了确定 $2 \\times 2$ 矩阵 $\\mathcal{C}$ 的秩，我们可以计算它的行列式。一个方阵满秩当且仅当其行列式不为零。\n$$\n\\det(\\mathcal{C}) = (0)(-3) - (1)(1) = 0 - 1 = -1\n$$\n由于 $\\det(\\mathcal{C}) = -1 \\neq 0$，矩阵 $\\mathcal{C}$ 的列是线性无关的。对于一个 $2 \\times 2$ 矩阵，这意味着它的秩为 $2$。\n$$\n\\operatorname{rank}(\\mathcal{C}) = 2\n$$\n根据卡尔曼秩条件，如果 $\\operatorname{rank}(\\mathcal{C})$ 等于状态空间的维度 $n$，则系统是能控的。在本例中，我们发现 $\\operatorname{rank}(\\mathcal{C}) = 2$，且状态维度为 $n=2$。由于 $\\operatorname{rank}(\\mathcal{C}) = n$，该系统是完全能控的。这意味着可以使用适当的控制输入 $u(t)$，在有限时间内将线性化基因模块的状态从任何初始状态驱动到任何期望的最终状态。\n\n问题要求能控性矩阵的秩，我们已计算出其值为 $2$。", "answer": "$$\\boxed{2}$$", "id": "4364519"}, {"introduction": "对于参数未知的复杂生物网络，结构可控性理论提供了一个强大的分析框架。该理论的核心在于通过图论中的最大匹配来识别“驱动节点”，即控制整个网络所需的最少输入节点。本练习将指导你分析一个信号网络的拓扑结构，以确定其最小驱动节点集，从而将控制问题从具体的动力学参数转移到网络的连接模式上 ([@problem_id:4364459])。", "problem": "一个系统生物医学中的信号网络在一个稳定工作点附近被线性化，因此其动态特性可以由一个线性时不变（LTI）系统表示，该系统的状态矩阵稀疏性由一个包含七个标记为 $1$ 到 $7$ 的节点的有向图编码。一条边 $i \\to j$ 表示在线性化模型中，节点 $i$ 的状态直接影响节点 $j$ 的状态。有向边如下：\n- $1 \\to 2$\n- $1 \\to 3$\n- $2 \\to 3$\n- $3 \\to 4$\n- $3 \\to 5$\n- $4 \\to 6$\n- $5 \\to 6$\n- $6 \\to 7$\n- $7 \\to 5$\n\n仅使用有向网络的结构可控性的基本定义以及有向图的二分表示上的图论匹配概念，构造一个最大匹配，并推断出由未匹配节点所决定的最小驱动节点数。仅报告最小驱动节点数，结果为一个没有单位的整数。", "solution": "该问题要求基于结构可控性原理和图论匹配，求出控制给定有向网络所需的最小驱动节点数。\n\n连接结构可控性与图论的基本原理指出，完全控制一个具有 $N$ 个节点的有向网络所需的最小驱动节点数（表示为 $N_D$）由以下方程给出：\n$$N_D = N - |M^*|$$\n其中 $|M^*|$ 是有向图中最大匹配的大小（基数）。驱动节点本身是在最大匹配中不被任何边指向的节点。\n\n首先，我们必须将网络结构形式化为一个有向图 $G = (V, E)$，其中 $V$ 是节点集合， $E$ 是有向边集合。\n根据问题描述，节点集合为 $V = \\{1, 2, 3, 4, 5, 6, 7\\}$，因此节点总数为 $N=7$。\n有向边集合为 $E = \\{(1, 2), (1, 3), (2, 3), (3, 4), (3, 5), (4, 6), (5, 6), (6, 7), (7, 5)\\}$。\n\n为了在有向图 $G$ 中找到最大匹配，我们构建一个相应的二分图 $G_B = (V_A \\cup V_B, E')$。该图由两个不相交的顶点集 $V_A$ 和 $V_B$ 组成，每个集合都是原始节点集 $V$ 的一个副本。设 $V_A = \\{x_1, x_2, x_3, x_4, x_5, x_6, x_7\\}$ 和 $V_B = \\{y_1, y_2, y_3, y_4, y_5, y_6, y_7\\}$。对于原始图 $G$ 中的每条有向边 $i \\to j$，我们在 $V_A$ 中的顶点 $x_i$ 和 $V_B$ 中的顶点 $y_j$ 之间添加一条无向边。\n\n因此，二分图 $G_B$ 中的边 $E'$ 如下：\n\\begin{itemize}\n    \\item $(x_1, y_2)$ 来自边 $1 \\to 2$\n    \\item $(x_1, y_3)$ 来自边 $1 \\to 3$\n    \\item $(x_2, y_3)$ 来自边 $2 \\to 3$\n    \\item $(x_3, y_4)$ 来自边 $3 \\to 4$\n    \\item $(x_3, y_5)$ 来自边 $3 \\to 5$\n    \\item $(x_4, y_6)$ 来自边 $4 \\to 6$\n    \\item $(x_5, y_6)$ 来自边 $5 \\to 6$\n    \\item $(x_6, y_7)$ 来自边 $6 \\to 7$\n    \\item $(x_7, y_5)$ 来自边 $7 \\to 5$\n\\end{itemize}\n\n$G_B$ 中的一个匹配 $M$ 是 $E'$ 的一个子集，其中 $M$ 中没有两条边共享一个公共顶点。最大匹配 $M^*$ 是具有最大可能边数的匹配。我们需要找到这个匹配的大小 $|M^*|$。\n\n让我们分析一下 $G_B$ 的结构。集合 $V_B$ 中的顶点 $y_1$ 没有任何关联的边。这是因为在原始图 $G$ 中，节点 $1$ 的入度为 $0$（没有边指向它）。没有边的顶点不能成为任何匹配的一部分。因此，在任何匹配 $M$ 中，$y_1$ 必为一个未匹配的顶点。由于一个匹配由来自 $V_A$ 和 $V_B$ 的顶点对组成，任何匹配的最大可能大小受限于可匹配的顶点数量。因为 $y_1$ 无法被匹配，所以最大匹配的大小 $|M^*|$ 最多为 $N-1 = 7-1 = 6$。\n\n现在，我们需要确定是否存在一个大小为 $6$ 的匹配。我们可以通过观察来构造这样一个匹配。让我们从 $E'$ 中选取一个包含 $6$ 条没有公共顶点的边的集合。\n考虑以下边的集合，我们称之为 $M_{test}$：\n\\begin{itemize}\n    \\item $(x_1, y_2)$\n    \\item $(x_2, y_3)$\n    \\item $(x_3, y_4)$\n    \\item $(x_7, y_5)$\n    \\item $(x_4, y_6)$\n    \\item $(x_6, y_7)$\n\\end{itemize}\n让我们验证一下 $M_{test}$ 是否是一个有效的匹配。\n使用的 $V_A$ 中的顶点是 $\\{x_1, x_2, x_3, x_4, x_6, x_7\\}$，它们都是不同的。\n使用的 $V_B$ 中的顶点是 $\\{y_2, y_3, y_4, y_5, y_6, y_7\\}$，它们也都是不同的。\n由于没有顶点被使用超过一次，$M_{test}$ 是一个有效的匹配。这个匹配的大小是 $|M_{test}| = 6$。\n\n既然我们已经确定了匹配的最大可能大小最多为 $6$，并且我们已经找到了一个大小为 $6$ 的有效匹配，我们可以得出结论，最大匹配的大小是 $|M^*| = 6$。\n\n在这个匹配中，未匹配的顶点是 $V_A$ 中的 $x_5$ 和 $V_B$ 中的 $y_1$。驱动节点的集合对应于 $V_B$ 中未匹配的顶点集合。在这种情况下，$V_B$ 中唯一未匹配的顶点是 $y_1$，它对应于原始网络中的节点 $1$。这类节点的数量是 $1$。\n\n最后，我们应用最小驱动节点数的公式：\n$$N_D = N - |M^*|$$\n代入我们已经找到的值：\n$$N_D = 7 - 6 = 1$$\n确保网络结构可控性所需的最小驱动节点数是 $1$。", "answer": "$$\\boxed{1}$$", "id": "4364459"}, {"introduction": "一个系统在结构上可观测，并不意味着它在所有参数条件下都可观测，这是一个深刻而重要的区别。本练习探讨了一种称为“参数抵消”的现象，即特定的动力学参数组合会导致信号通路发生破坏，从而使一个结构上可观测的系统变得不可观测。通过分析一个前馈环网络模体，你将理解为何在系统生物学分析中，必须同时考虑网络拓扑和具体的相互作用强度 ([@problem_id:1451365])。", "problem": "在系统生物学中，理解可以从其他组分的测量中推断出细胞网络的哪些组分，是一个基本的可观测性问题。考虑一个由三种蛋白质P1、P2和P3组成的信号模块的简化线性模型，其浓度与稳态的偏差分别由状态变量$x_1(t)$、$x_2(t)$和$x_3(t)$表示。\n\n这些蛋白质以一种称为相干前馈环的网络基序相互作用：P1影响P2和P3，P2也影响P3。该系统的动力学可以用以下线性常微分方程组来描述：\n$$\n\\begin{aligned}\n\\dot{x}_1 = -k_1 x_1 \\\\\n\\dot{x}_2 = k_{21} x_1 - k_2 x_2 \\\\\n\\dot{x}_3 = k_{31} x_1 + k_{32} x_2 - k_3 x_3\n\\end{aligned}\n$$\n此处，$k_1, k_2, k_3$是正常数，分别代表P1、P2和P3的一阶降解或失活率。正常数$k_{21}, k_{31}, k_{32}$代表调控相互作用的强度。这可以写成状态空间形式$\\dot{\\mathbf{x}} = A\\mathbf{x}$。\n\n假设一个实验装置可以连续测量蛋白质P3的浓度，使得系统输出由$y = x_3$给出。对于非零动力学参数的一般选择，该系统是结构可观测的。然而，当参数之间存在某些特定关系时，可能会发生一种称为参数抵消的现象，从而使系统变得不可观测。\n\n关于动力学参数的下列哪个条件会导致系统变得不可观测？\n\nA. $k_{31}(k_1 - k_2) = k_{32}k_{21}$\n\nB. $k_{31}(k_1 + k_2) = k_{32}k_{21}$\n\nC. $k_{21}(k_2 - k_3) = k_{31}k_{32}$\n\nD. $k_1 k_{21} + k_2 k_{32} = k_3 k_{31}$\n\nE. $k_{31} = k_{32} + k_{21}$", "solution": "我们将系统写成状态空间形式$\\dot{\\mathbf{x}} = A \\mathbf{x}$，输出为$y = C \\mathbf{x}$，其中\n$$\nA = \\begin{pmatrix}\n-k_{1}  0  0 \\\\\nk_{21}  -k_{2}  0 \\\\\nk_{31}  k_{32}  -k_{3}\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 0  0  1 \\end{pmatrix}.\n$$\n当且仅当可观测性矩阵是满秩时，系统对$(A,C)$是可观测的。对于一个三状态SISO（单输入单输出）系统，其可观测性矩阵为\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nC A \\\\\nC A^{2}\n\\end{pmatrix}.\n$$\n我们明确地计算每个块：\n- 第一个块是 $C = \\begin{pmatrix} 0  0  1 \\end{pmatrix}$。\n- 第二个块是 $C A$，它等于 $A$ 的第三行：\n$$\nC A = \\begin{pmatrix} k_{31}  k_{32}  -k_{3} \\end{pmatrix}.\n$$\n- 第三个块是 $C A^{2} = (C A) A$，即 $A^{2}$ 的第三行。使用行-列乘法，\n$$\nC A^{2} = \\begin{pmatrix}\nk_{32} k_{21} - k_{31} (k_{1} + k_{3})  -k_{32} (k_{2} + k_{3})  k_{3}^{2}\n\\end{pmatrix}.\n$$\n因此\n$$\n\\mathcal{O} =\n\\begin{pmatrix}\n0  0  1 \\\\\nk_{31}  k_{32}  -k_{3} \\\\\nk_{32} k_{21} - k_{31} (k_{1} + k_{3})  -k_{32} (k_{2} + k_{3})  k_{3}^{2}\n\\end{pmatrix}.\n$$\n系统不可观测的充要条件是$\\det(\\mathcal{O}) = 0$。沿着第一行（其前两个元素为零）展开行列式，得到\n$$\n\\det(\\mathcal{O}) = \\det\n\\begin{pmatrix}\nk_{31}  k_{32} \\\\\nk_{32} k_{21} - k_{31} (k_{1} + k_{3})  -k_{32} (k_{2} + k_{3})\n\\end{pmatrix}.\n$$\n计算这个 $2 \\times 2$ 行列式：\n$$\n\\det(\\mathcal{O}) = k_{31} \\bigl(-k_{32} (k_{2} + k_{3})\\bigr) - k_{32} \\bigl(k_{32} k_{21} - k_{31} (k_{1} + k_{3})\\bigr).\n$$\n化简得，\n$$\n\\det(\\mathcal{O}) = -k_{31} k_{32} (k_{2} + k_{3}) - k_{32}^{2} k_{21} + k_{32} k_{31} (k_{1} + k_{3})\n= k_{31} k_{32} (k_{1} - k_{2}) - k_{32}^{2} k_{21}.\n$$\n提出因子 $k_{32}$：\n$$\n\\det(\\mathcal{O}) = k_{32} \\bigl( k_{31} (k_{1} - k_{2}) - k_{32} k_{21} \\bigr).\n$$\n对于一般的非零动力学参数，$k_{32} \\neq 0$，因此当且仅当括号内的因子为零时，系统是不可观测的：\n$$\nk_{31} (k_{1} - k_{2}) - k_{32} k_{21} = 0 \\quad \\Longleftrightarrow \\quad k_{31} (k_{1} - k_{2}) = k_{32} k_{21}.\n$$\n这与选项A相匹配，并且不依赖于$k_{3}$。其他所列关系通常不会使行列式为零。", "answer": "$$\\boxed{A}$$", "id": "1451365"}]}