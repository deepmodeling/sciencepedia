{"hands_on_practices": [{"introduction": "在多发性内分泌肿瘤综合征（MEN）的管理中，基因检测是诊断和风险分层的基石。然而，任何诊断测试都并非完美，理解其结果的真正含义至关重要。本练习将引导您应用贝叶斯定理，这是循证医学中的一个核心工具，用于根据新的测试结果更新我们对疾病可能性的判断。通过这个案例[@problem_id:4674629]，您将学习如何量化地结合先验概率（来自家族史的初始风险）与测试的灵敏度和特异性，从而得出更为精确的后验概率，为后续的临床决策提供坚实的概率基础。", "problem": "一个外科团队正在根据胚系基因检测，为一个患有1型多发性内分泌肿瘤综合征 (MEN1) 的家族规划预防性干预的时机。在一个已知的 MEN1 家系中，一位无症状的成年一级亲属根据系谱分析和既定的外显率估计，其患有 MEN1 的先验概率 $p$ 为 $0.25$。针对 MEN1 致病性变异的胚系基因检测，其灵敏度 $s$ 为 $0.98$，特异度 $c$ 为 $0.99$。该患者的检测结果呈阳性。\n\n使用灵敏度和特异度的基本定义以及贝叶斯定理，推导出阳性结果后的后验概率 $P(\\text{MEN1} \\mid +)$，该表达式应纯粹用 $s$、$c$ 和 $p$ 表示，然后根据给定值进行计算。将最终数值答案四舍五入至四位有效数字，并以小数形式表示，不带百分号。", "solution": "目标是计算在基因检测结果为阳性的情况下，患者患有1型多发性内分泌肿瘤综合征 (MEN1) 的后验概率。我们已知先验概率以及检测的灵敏度和特异度。\n\n首先，我们根据问题陈述定义事件和概率：\n- 设 $M$ 为患者患有 MEN1 的事件。\n- 设 $M^c$ 为患者未患 MEN1 的事件。\n- 设 $+$ 为检测结果为阳性的事件。\n\n给定信息可以用概率术语表示：\n- 患有 MEN1 的先验概率为 $P(M) = p = 0.25$。\n- 未患 MEN1 的先验概率为 $P(M^c) = 1 - P(M) = 1 - p$。\n- 检测的灵敏度是指在患者患有 MEN1 的条件下检测结果为阳性的概率。这是真阳性率：$P(+ \\mid M) = s = 0.98$。\n- 检测的特异度是指在患者未患 MEN1 的条件下检测结果为阴性的概率。这是真阴性率：$P(- \\mid M^c) = c = 0.99$。\n\n我们需要求后验概率 $P(M \\mid +)$。我们将使用贝叶斯定理进行推导。贝叶斯定理表述如下：\n$$P(M \\mid +) = \\frac{P(+ \\mid M) P(M)}{P(+)}$$\n\n分母 $P(+)$ 是检测结果为阳性的总概率。它可以通过全概率定律计算，即对两种互斥情况求和：患者患有 MEN1，或患者未患 MEN1。\n$$P(+) = P(+ \\mid M) P(M) + P(+ \\mid M^c) P(M^c)$$\n\n为了使用这个公式，我们需要 $P(+ \\mid M^c)$ 这一项，即在患者未患病的情况下检测结果为阳性的概率（假阳性率）。这可以从特异度 $c$ 推导出来。由于检测结果不是阳性就是阴性，对于未患 MEN1 的患者，真阴性概率与假阳性概率之和必须为 $1$：\n$$P(+ \\mid M^c) + P(- \\mid M^c) = 1$$\n$$P(+ \\mid M^c) = 1 - P(- \\mid M^c) = 1 - c$$\n\n现在，我们可以将我们定义的符号代入总概率 $P(+)$ 的表达式中：\n$$P(+) = (s)(p) + (1 - c)(1 - p)$$\n\n最后，将这个 $P(+)$ 的表达式代回贝叶斯定理，得到所需的后验概率 $P(M \\mid +)$，纯粹用 $s$、$c$ 和 $p$ 表示：\n$$P(M \\mid +) = \\frac{s \\cdot p}{s \\cdot p + (1 - c)(1 - p)}$$\n这是后验概率的通用公式。\n\n现在，我们使用问题中提供的数值来计算这个表达式：\n- $p = 0.25$\n- $s = 0.98$\n- $c = 0.99$\n\n由此，我们还可以确定：\n- $1 - p = 1 - 0.25 = 0.75$\n- $1 - c = 1 - 0.99 = 0.01$\n\n我们计算公式中的各项：\n分子代表了人群队列中真阳性结果的概率，其值为：\n$$s \\cdot p = (0.98)(0.25) = 0.245$$\n\n分母是真阳性概率与假阳性概率之和。假阳性项为：\n$$(1 - c)(1 - p) = (0.01)(0.75) = 0.0075$$\n\n检测结果为阳性的总概率为：\n$$P(+) = s \\cdot p + (1-c)(1-p) = 0.245 + 0.0075 = 0.2525$$\n\n现在，我们可以计算后验概率：\n$$P(M \\mid +) = \\frac{0.245}{0.2525}$$\n为了方便计算，我们可以将其表示为整数的分数形式：\n$$P(M \\mid +) = \\frac{2450}{2525} = \\frac{98}{101}$$\n\n将此分数转换为小数，得到：\n$$P(M \\mid +) \\approx 0.9702970297...$$\n\n问题要求答案四舍五入至四位有效数字。前四位有效数字是 $9$、$7$、$0$ 和 $2$。第五位有效数字是 $9$，大于或等于 $5$，所以我们将第四位数字向上取整。\n$$P(M \\mid +) \\approx 0.9703$$\n因此，在检测结果为阳性后，该个体患有 MEN1 的概率从先验概率的 $25\\%$ 增加到约 $97.03\\%$。", "answer": "$$\\boxed{0.9703}$$", "id": "4674629"}, {"introduction": "在确立诊断之后，外科医生面临的关键任务是制定精确的手术方案。本练习从诊断推理更进一步，聚焦于基于模型的术前决策。它引入了一种强大的统计工具——逻辑回归模型——来根据关键生物标志物（降钙素水平）量化隐匿性淋巴结转移的风险[@problem_id:4674598]。更重要的是，本练习将此风险评估与决策理论框架相结合，通过比较不同选择的预期损失，为是否执行预防性侧颈清扫术等重大手术决策提供客观、量化的依据，充分体现了个体化精准外科的理念。", "problem": "一名患有2型多发性内分泌肿瘤综合征(MEN2)且经活检证实为甲状腺髓样癌(MTC)的患者，其基础降钙素浓度为 $C_0 = 120$ pg/mL。在普外科的术前手术规划中，是否追加颈部外侧区淋巴结清扫术的决策取决于对隐匿性外侧颈部淋巴结转移的估计概率。假设在给定基础降钙素浓度 $C$ (单位为pg/mL)的情况下，隐匿性外侧颈部淋巴结转移的概率 $p(C)$ 遵循一个基于自然对数尺度的标准逻辑斯蒂模型，该模型由来自多机构数据集的经验性校准点确定：当 $C_1 = 30$ pg/mL 时，概率为 $p_1 = 0.20$；当 $C_2 = 200$ pg/mL 时，概率为 $p_2 = 0.75$。在一个标准的决策理论框架下，设与不必要的颈部外侧区淋巴结清扫术相关的标准化期望损害（损失）为 $L_{\\text{LND}} = 0.10$，与遗漏隐匿性外侧颈部淋巴结转移（需要再次手术并有疾病进展风险）相关的标准化期望损害为 $L_{\\text{miss}} = 0.30$。\n\n从优势比、对数优势比和逻辑斯蒂连接函数的定义出发，并根据最小化期望损失的原则，完成以下任务：\n1. 推导与 $\\ln(C)$ 上的两个校准点一致的逻辑斯蒂参数 $\\alpha$ 和 $\\beta$。\n2. 计算当 $C_0 = 120$ pg/mL 时的概率 $p(C_0)$。\n3. 推导决策阈值 $p^{\\ast}$，在该阈值下，执行颈部外侧区淋巴结清扫术的期望损失与推迟该手术的期望损失相等，并通过比较 $p(C_0)$ 与 $p^{\\ast}$ 来确定在 $C_0$ 的情况下是否应进行颈部外侧区清扫术。\n\n将最终概率以小数形式表示（而非百分比），并四舍五入至四位有效数字。将您的最终结果表示为一个行矩阵 $\\begin{pmatrix} p  d \\end{pmatrix}$，其中 $p$ 是四舍五入后的概率，$d$ 是决策指标，若应进行颈部外侧区淋巴结清扫术则 $d = 1$，否则 $d = 0$。最终答案无需单位。", "solution": "该问题需要分三部分解答：\n1.  推导逻辑斯蒂模型的参数。\n2.  计算给定患者的转移概率。\n3.  基于损失最小化框架确定最佳手术决策。\n\n**第一部分：逻辑斯蒂模型参数的推导**\n\n隐匿性外侧颈部淋巴结转移的概率 $p(C)$ 遵循一个基于降钙素浓度 $C$ 的自然对数的逻辑斯蒂模型。该逻辑斯蒂模型将预测变量 $\\ln(C)$ 与概率 $p$ 的对数优势比（logit）关联起来：\n$$ \\text{logit}(p(C)) = \\ln\\left(\\frac{p(C)}{1 - p(C)}\\right) = \\alpha + \\beta \\ln(C) $$\n其中，$\\alpha$ 和 $\\beta$ 是待定参数。我们有两个已知的校准点：\n1.  $C_1 = 30$ pg/mL，对应概率 $p_1 = 0.20$。\n2.  $C_2 = 200$ pg/mL，对应概率 $p_2 = 0.75$。\n\n我们可以利用这两点建立一个关于 $\\alpha$ 和 $\\beta$ 的二元线性方程组。\n\n对于第一个点，其对数优势比为：\n$$ \\text{logit}(p_1) = \\ln\\left(\\frac{0.20}{1 - 0.20}\\right) = \\ln\\left(\\frac{0.20}{0.80}\\right) = \\ln(0.25) = \\ln\\left(\\frac{1}{4}\\right) = -\\ln(4) $$\n对应的方程是：\n$$ -\\ln(4) = \\alpha + \\beta \\ln(30) \\quad (1) $$\n\n对于第二个点，其对数优势比为：\n$$ \\text{logit}(p_2) = \\ln\\left(\\frac{0.75}{1 - 0.75}\\right) = \\ln\\left(\\frac{0.75}{0.25}\\right) = \\ln(3) $$\n对应的方程是：\n$$ \\ln(3) = \\alpha + \\beta \\ln(200) \\quad (2) $$\n\n为了求解 $\\beta$，我们将方程 $(2)$ 减去方程 $(1)$：\n$$ \\ln(3) - (-\\ln(4)) = (\\alpha + \\beta \\ln(200)) - (\\alpha + \\beta \\ln(30)) $$\n$$ \\ln(3) + \\ln(4) = \\beta (\\ln(200) - \\ln(30)) $$\n利用对数性质 $\\ln(a) + \\ln(b) = \\ln(ab)$ 和 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$ \\ln(12) = \\beta \\ln\\left(\\frac{200}{30}\\right) = \\beta \\ln\\left(\\frac{20}{3}\\right) $$\n解出 $\\beta$：\n$$ \\beta = \\frac{\\ln(12)}{\\ln(20/3)} $$\n\n现在我们可以通过重新整理方程 $(1)$ 来求解 $\\alpha$：\n$$ \\alpha = -\\ln(4) - \\beta \\ln(30) $$\n代入 $\\beta$ 的表达式：\n$$ \\alpha = -\\ln(4) - \\frac{\\ln(12)}{\\ln(20/3)} \\ln(30) $$\n\n**第二部分：计算 $C_0 = 120$ pg/mL 时的概率**\n\n我们现在使用推导出的模型来计算 $C_0 = 120$ pg/mL 患者的概率 $p(C_0)$。首先，我们计算 $C_0$ 的对数优势比：\n$$ \\text{logit}(p(C_0)) = \\alpha + \\beta \\ln(120) $$\n代入 $\\alpha$ 和 $\\beta$ 的表达式：\n$$ \\text{logit}(p(C_0)) = \\left(-\\ln(4) - \\frac{\\ln(12)}{\\ln(20/3)}\\ln(30)\\right) + \\left(\\frac{\\ln(12)}{\\ln(20/3)}\\right)\\ln(120) $$\n$$ \\text{logit}(p(C_0)) = -\\ln(4) + \\frac{\\ln(12)}{\\ln(20/3)} \\left(\\ln(120) - \\ln(30)\\right) $$\n$$ \\text{logit}(p(C_0)) = -\\ln(4) + \\frac{\\ln(12)}{\\ln(20/3)} \\ln\\left(\\frac{120}{30}\\right) $$\n$$ \\text{logit}(p(C_0)) = -\\ln(4) + \\frac{\\ln(12)}{\\ln(20/3)} \\ln(4) $$\n令 $L_0 = \\text{logit}(p(C_0))$。我们得到：\n$$ L_0 = \\ln(4) \\left(\\frac{\\ln(12)}{\\ln(20/3)} - 1\\right) = \\ln(4) (\\beta-1)$$\n为了求得数值，我们计算 $\\beta$：\n$$ \\beta = \\frac{\\ln(12)}{\\ln(20/3)} \\approx \\frac{2.484907}{1.897120} \\approx 1.309821 $$\n现在我们计算 $L_0$：\n$$ L_0 \\approx \\ln(4) (1.309821 - 1) = 1.386294 \\times 0.309821 \\approx 0.429533 $$\n为了从对数优势比 $L_0$ 求得概率 $p(C_0)$，我们使用逆逻辑斯蒂函数：\n$$ p(C_0) = \\frac{\\exp(L_0)}{1 + \\exp(L_0)} $$\n$$ p(C_0) \\approx \\frac{\\exp(0.429533)}{1 + \\exp(0.429533)} \\approx \\frac{1.53653}{1 + 1.53653} \\approx \\frac{1.53653}{2.53653} \\approx 0.60578 $$\n按要求四舍五入至四位有效数字，我们得到：\n$$ p(C_0) \\approx 0.6058 $$\n\n**第三部分：决策阈值的推导与最终决策**\n\n我们需要决定是执行颈部外侧区淋巴结清扫术（LND）还是推迟手术。该决策基于最小化期望损害（损失）。设 $p$ 为真实的转移概率。两种行为有如下的期望损失：\n-   **执行LND**：仅当没有转移时（不必要的手术）才会产生损失。期望损失为 $E_{\\text{LND}}(p) = L_{\\text{LND}} \\times (1-p)$。\n-   **推迟LND**：仅当存在转移时（漏诊）才会产生损失。期望损失为 $E_{\\text{defer}}(p) = L_{\\text{miss}} \\times p$。\n\n给定的损失值为 $L_{\\text{LND}} = 0.10$ 和 $L_{\\text{miss}} = 0.30$。\n决策阈值 $p^{\\ast}$ 是指两种行为的期望损失相等时的概率：\n$$ E_{\\text{LND}}(p^{\\ast}) = E_{\\text{defer}}(p^{\\ast}) $$\n$$ L_{\\text{LND}} (1-p^{\\ast}) = L_{\\text{miss}} p^{\\ast} $$\n$$ 0.10 (1-p^{\\ast}) = 0.30 p^{\\ast} $$\n$$ 0.10 - 0.10 p^{\\ast} = 0.30 p^{\\ast} $$\n$$ 0.10 = 0.40 p^{\\ast} $$\n$$ p^{\\ast} = \\frac{0.10}{0.40} = 0.25 $$\n\n决策规则如下：\n-   如果 $p(C) > p^{\\ast}$，则 $E_{\\text{defer}}(p) > E_{\\text{LND}}(p)$。为了最小化期望损失，我们应选择损失较小的行为，即执行LND。\n-   如果 $p(C) < p^{\\ast}$，则 $E_{\\text{LND}}(p) > E_{\\text{defer}}(p)$。我们应推迟LND。\n\n对于 $C_0=120$ pg/mL 的患者，我们计算出 $p(C_0) \\approx 0.6058$。我们将此值与阈值 $p^{\\ast}$ 进行比较：\n$$ 0.6058 > 0.25 $$\n由于患者的转移概率大于决策阈值，为最小化期望损害，应进行颈部外侧区清扫术。因此，决策指标为 $d=1$。\n\n最终结果是四舍五入至四位有效数字的概率 $p(C_0)$ 和决策指标 $d$。\n$p \\approx 0.6058$\n$d = 1$\n结果以行矩阵 $\\begin{pmatrix} p  d \\end{pmatrix}$ 的形式报告。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6058  1 \\end{pmatrix}}$$", "id": "4674598"}, {"introduction": "外科决策不仅限于术前规划，更贯穿于手术过程中的实时判断。本练习将我们的视角带入手术室，聚焦于 MEN1 型患者甲状旁腺功能亢进的手术治疗，并探讨术中甲状旁腺激素（IOPTH）监测的定量解释。通过构建一个描述激素清除动力学的一阶模型[@problem_id:4674634]，您将能够理解并预测手术切除腺体后激素水平的动态变化。这种将生理学原理与数学模型相结合的实践，是评估手术是否彻底、指导术中决策的关键技能。", "problem": "一位患有 $1$ 型多发性内分泌肿瘤综合征（MEN）的患者，因多腺体甲状旁腺增生而接受双侧颈部探查术和甲状旁腺次全切除术。采用术中甲状旁腺激素（IOPTH）监测来评估切除的充分性。在切除前，循环甲状旁腺激素浓度处于基线稳态 $P_{0}$，功能亢进的甲状旁腺共同主导其产生。在时间 $t=0$ 时切除一个功能亢进的腺体，原位保留两个功能亢进的腺体。假设以下基本事实：\n- 循环甲状旁腺激素（PTH）遵循一级、单室清除动力学，其血浆半衰期为 $t_{1/2} = 4$ 分钟，清除速率常数为 $k = \\ln(2)/t_{1/2}$。\n- 在稳态下，浓度与产生速率成正比，因此切除一个贡献了基线 $P_{0}$ 的一小部分 $f$ 的腺体，会立即将稳态目标浓度从 $P_{0}$ 降低到 $(1 - f) P_{0}$，而清除率保持不变。\n- 在 $t=0$ 时产生速率发生阶跃变化后，浓度轨迹 $P(t)$ 会指数地趋向新的稳态值。\n\n基于这些原理，推导在切除后 $t = 10$ 分钟时，IOPTH相对于基线的预期分数下降值，表示为小数（例如，$0.50$ 代表 $50$ 百分比）。您的最终答案必须是仅含 $f$ 的单个闭式解析表达式。无需四舍五入；请按要求提供精确表达式。不要包含百分号。", "solution": "甲状旁腺激素（PTH）浓度 $P(t)$ 的动态变化由一个一阶线性微分方程描述。设 $S(t)$ 为PTH的有效产生速率（单位为浓度/时间），$k$ 为一级清除速率常数。其控制方程为：\n$$\n\\frac{dP(t)}{dt} = S(t) - k P(t)\n$$\n对于 $t  0$，系统处于稳态，浓度为 $P_0$。在稳态下，$\\frac{dP}{dt} = 0$，因此基线产生速率 $S_0$ 必须满足：\n$$\nS_0 = k P_0\n$$\n在时间 $t=0$ 时，切除一个贡献了总产生量一小部分 $f$ 的腺体。这导致产生速率瞬间阶跃性降低。对于 $t \\ge 0$，新的产生速率 $S_{new}$ 为：\n$$\nS_{new} = (1 - f) S_0 = (1 - f) k P_0\n$$\n问题陈述正确地指出，这个新的产生速率对应于一个新的稳态浓度，$P_{ss, new} = (1-f)P_0$。\n\n对于 $t \\ge 0$，PTH浓度的微分方程变为：\n$$\n\\frac{dP(t)}{dt} = S_{new} - k P(t) = (1 - f) k P_0 - k P(t)\n$$\n这可以改写为一个标准的一阶线性常微分方程：\n$$\n\\frac{dP(t)}{dt} + k P(t) = k(1-f)P_0\n$$\n该方程的通解是齐次解 $P_h(t)$ 和一个特解 $P_p(t)$ 的和。齐次方程为 $\\frac{dP_h}{dt} + k P_h = 0$，其解为 $P_h(t) = C \\exp(-kt)$，其中 $C$ 是某个常数。对于特解，我们可以假设一个常数解 $P_p(t) = A$，代入后得到 $0 + kA = k(1-f)P_0$，所以 $A = (1-f)P_0$。这个特解就是新的稳态浓度。\n\n对于 $t \\ge 0$ 的通解是：\n$$\nP(t) = P_h(t) + P_p(t) = C \\exp(-kt) + (1-f)P_0\n$$\n为了求出常数 $C$，我们使用初始条件。血液中PTH的浓度不能瞬时改变。因此，在 $t=0$ 切除后的瞬间，其浓度必须与切除前一刻的浓度相同，即基线浓度 $P_0$。\n$$\nP(0) = P_0\n$$\n将此代入通解中：\n$$\nP(0) = C \\exp(-k \\cdot 0) + (1-f)P_0 = C + (1-f)P_0\n$$\n设 $P(0) = P_0$ 可得：\n$$\nP_0 = C + (1-f)P_0 \\implies C = P_0 - (1-f)P_0 = P_0 - P_0 + fP_0 = fP_0\n$$\n将 $C$ 的值代回通解，我们得到 $t \\ge 0$ 时PTH浓度的表达式：\n$$\nP(t) = f P_0 \\exp(-kt) + (1-f)P_0\n$$\n我们需要求出在 $t=10$ 分钟时，IOPTH相对于基线 $P_0$ 的分数下降值。分数下降定义为：\n$$\n\\text{分数下降} = \\frac{P_0 - P(10)}{P_0} = 1 - \\frac{P(10)}{P_0}\n$$\n代入 $P(t)$ 的表达式：\n$$\n\\frac{P(10)}{P_0} = \\frac{f P_0 \\exp(-10k) + (1-f)P_0}{P_0} = f \\exp(-10k) + (1-f)\n$$\n因此，分数下降值为：\n$$\n\\text{分数下降} = 1 - \\left[ f \\exp(-10k) + (1-f) \\right] = 1 - f \\exp(-10k) - 1 + f = f - f \\exp(-10k)\n$$\n提出因子 $f$，我们得到：\n$$\n\\text{分数下降} = f(1 - \\exp(-10k))\n$$\n问题给出了半衰期 $t_{1/2} = 4$ 分钟以及关系式 $k = \\ln(2)/t_{1/2}$。\n$$\nk = \\frac{\\ln(2)}{4} \\text{ min}^{-1}\n$$\n现在我们计算 $\\exp(-10k)$ 这一项：\n$$\n-10k = -10 \\left( \\frac{\\ln(2)}{4} \\right) = -\\frac{10}{4} \\ln(2) = -2.5 \\ln(2)\n$$\n使用恒等式 $a \\ln(b) = \\ln(b^a)$：\n$$\n-10k = \\ln(2^{-2.5})\n$$\n所以，指数项为：\n$$\n\\exp(-10k) = \\exp(\\ln(2^{-2.5})) = 2^{-2.5} = 2^{-5/2}\n$$\n我们可以简化此项：\n$$\n2^{-5/2} = \\frac{1}{2^{5/2}} = \\frac{1}{\\sqrt{2^5}} = \\frac{1}{\\sqrt{32}} = \\frac{1}{\\sqrt{16 \\cdot 2}} = \\frac{1}{4\\sqrt{2}}\n$$\n为了使分母有理化：\n$$\n\\frac{1}{4\\sqrt{2}} = \\frac{1}{4\\sqrt{2}} \\cdot \\frac{\\sqrt{2}}{\\sqrt{2}} = \\frac{\\sqrt{2}}{8}\n$$\n将此代回分数下降的表达式中：\n$$\n\\text{分数下降} = f \\left(1 - \\frac{\\sqrt{2}}{8} \\right)\n$$\n这可以写成通分形式：\n$$\n\\text{分数下降} = f \\left( \\frac{8 - \\sqrt{2}}{8} \\right)\n$$\n这是最终的、精确的、仅用 $f$ 表示的闭式解析表达式。", "answer": "$$\n\\boxed{f \\left( \\frac{8-\\sqrt{2}}{8} \\right)}\n$$", "id": "4674634"}]}