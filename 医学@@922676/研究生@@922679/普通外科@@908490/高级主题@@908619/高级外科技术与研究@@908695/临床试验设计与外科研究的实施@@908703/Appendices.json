{"hands_on_practices": [{"introduction": "样本量计算是临床试验设计的基石。一项研究需要招募足够数量的受试者，以确保其有足够的统计功效来检测具有临床意义的治疗效果，同时避免因样本量过大而造成资源浪费或不必要的受试者暴露。本练习将指导您从第一性原理出发，推导并计算一项比较两种手术技术优效性试验所需的样本量，这是外科研究人员必须掌握的核心技能。[@problem_id:4609200]", "problem": "一个外科团队正在计划一项双臂随机对照试验（RCT），旨在比较一种新的微创肝切除术与标准的开放式肝切除术。主要终点是在第 $90$ 天测量的一个经过验证的身体功能评分，该评分被视为一个在 $0$ 到 $100$ 范围内的连续性结局。根据先前的队列数据，计划的标准差为 $\\sigma = 18$ 分。该团队旨在检测的最小重要差异为 $\\delta = 6$ 分（新技术更优）。该试验将采用双臂均等分配，双侧I类错误率 $\\alpha = 0.05$，并在固定效应备择假设下，目标统计功效为 $1 - \\beta = 0.90$。假设臂内结局独立同分布，样本均值差异通过中心极限定理近似正态分布，且双臂方差相等。\n\n从适用于大样本双样本均值比较的第一性原理出发——即样本均值之差的抽样分布、在原假设下检验水平为 $\\alpha$ 的双侧临界区的定义，以及在非零均值差异下的统计功效的定义——推导出每臂所需的样本量，以确保该检验在检验水平为 $\\alpha$ 时，检测出差异 $\\delta$ 的统计功效至少达到目标值。然后，考虑到每位参与者有 $d = 0.12$ 的独立失访概率以及采用完整病例进行主要分析，对每臂的样本量进行扩充，以确保每臂预期可分析的参与者数量仍能满足要求。报告最终答案，即双臂总共需要招募的参与者数量。\n\n四舍五入和报告说明：\n- 在最终的样本量扩充步骤之前，任何非整数的中间量（包括分位数）至少保留四位有效数字。\n- 考虑到失访进行样本量扩充后，将每臂的参与者人数向上取整到下一个整数。\n- 将最终的总样本量报告为单个整数（参与者人数）。", "solution": "我们从均等分配和共同方差条件下独立样本均值之差的抽样分布开始。设 $X_{1,1}, \\dots, X_{1,n}$ 为新技术组的结局，$X_{2,1}, \\dots, X_{2,n}$ 为标准组的结局，其中 $X_{j,i} \\overset{\\text{i.i.d.}}{\\sim}$ 服从均值为 $\\mu_{j}$、共同方差为 $\\sigma^{2}$ 的分布。根据中心极限定理和独立性，样本均值 $\\bar{X}_{1}$ 和 $\\bar{X}_{2}$ 满足：\n$$\n\\bar{X}_{1} - \\bar{X}_{2} \\approx \\mathcal{N}\\!\\left(\\mu_{1} - \\mu_{2}, \\ \\frac{2\\sigma^{2}}{n}\\right).\n$$\n考虑在检验水平为 $\\alpha$ 时检验双侧原假设 $H_{0}: \\mu_{1} - \\mu_{2} = 0$ 与备择假设 $H_{1}: \\mu_{1} - \\mu_{2} \\neq 0$，计划的备择假设为 $\\mu_{1} - \\mu_{2} = \\delta > 0$。标准化的检验统计量是：\n$$\nT \\equiv \\frac{\\bar{X}_{1} - \\bar{X}_{2}}{\\sqrt{2}\\sigma/\\sqrt{n}}.\n$$\n在 $H_{0}$ 下，$T \\approx \\mathcal{N}(0,1)$，检验水平为 $\\alpha$ 的双侧临界区为 $|T| > z_{1-\\alpha/2}$，其中 $z_{p}$ 表示标准正态分布的 $p$-分位数。在真实效应为 $\\delta$ 的 $H_{1}$ 下，$T \\approx \\mathcal{N}\\!\\left(\\frac{\\delta}{\\sqrt{2}\\sigma/\\sqrt{n}}, \\ 1\\right)$。\n\n统计功效为：\n$$\n\\Pr\\!\\left(|T| > z_{1-\\alpha/2} \\ \\big|\\ H_{1}\\right) = \\Pr\\!\\left(T > z_{1-\\alpha/2} \\ \\big|\\ H_{1}\\right) + \\Pr\\!\\left(T  -z_{1-\\alpha/2} \\ \\big|\\ H_{1}\\right).\n$$\n对于 $\\delta  0$，主要项是上侧尾部，达到至少为 $1-\\beta$ 的统计功效的一个标准充分条件是：\n$$\n\\frac{\\delta}{\\sqrt{2}\\sigma/\\sqrt{n}} - z_{1-\\alpha/2} \\ge z_{1-\\beta}.\n$$\n重新整理得到每臂的样本量要求：\n$$\nn \\ge 2 \\left(\\frac{z_{1-\\alpha/2} + z_{1-\\beta}}{\\delta/\\sigma}\\right)^{2} = 2 \\left(\\frac{(z_{1-\\alpha/2} + z_{1-\\beta})\\,\\sigma}{\\delta}\\right)^{2}.\n$$\n这是均等分配下基于大样本正态近似的每臂样本量。\n\n现在代入计划值，非整数的量至少保留四位有效数字：\n- $\\alpha = 0.05 \\implies z_{1-\\alpha/2} = z_{0.975} = 1.960$，\n- $1-\\beta = 0.90 \\implies z_{1-\\beta} = z_{0.90} = 1.2816$，\n- $\\sigma = 18$，\n- $\\delta = 6$。\n\n首先计算分位数的和：\n$$\nz_{1-\\alpha/2} + z_{1-\\beta} = 1.960 + 1.2816 = 3.2416.\n$$\n接下来计算信噪比因子：\n$$\n\\frac{\\delta}{\\sigma} = \\frac{6}{18} = \\frac{1}{3}, \\quad \\text{so} \\quad \\frac{\\sigma}{\\delta} = 3.\n$$\n计算失访前的名义每臂样本量：\n$$\nn_{0} = 2 \\left( (3.2416)\\cdot 3 \\right)^{2} = 2 \\left( 9.7248 \\right)^{2} = 2 \\times 94.57173504 = 189.14347008.\n$$\n考虑到每位参与者有 $d = 0.12$ 的独立失访概率以及采用完整病例进行主要分析，每臂预期可分析的比例为 $(1-d) = 0.88$。为确保每臂至少有 $n_{0}$ 名可分析的参与者，需招募：\n$$\nn_{\\text{recruit, per arm}} = \\frac{n_{0}}{1-d} = \\frac{189.14347008}{0.88} = 214.9357615\\ldots\n$$\n将每臂的参与者人数向上取整到下一个整数：\n$$\nn_{\\text{per arm (final)}} = 215.\n$$\n因此，双臂总共需要招募的参与者数量为：\n$$\nN_{\\text{total}} = 2 \\times 215 = 430.\n$$", "answer": "$$\\boxed{430}$$", "id": "4609200"}, {"introduction": "许多外科研究的干预措施是在机构或团队层面实施的，例如在医院层面推行新的感染预防方案。在这种情况下，来自同一“集群”（如同一家医院）的患者结局可能存在相关性，传统的个体随机试验样本量计算方法不再适用。本练习将介绍设计效应（design effect）的概念，并演示如何使用组内相关系数（intracluster correlation coefficient, ICC）来调整样本量，以正确地为整群随机试验（cluster randomized trial）提供支持。[@problem_id:4609166]", "problem": "一项普外科领域的多中心整群随机试验将比较院级层面实施标准化围手术期感染预防组合措施与常规护理对个体患者的手术部位感染这一二元结局的影响。在一个忽略了整群效应的个体随机设计下，每组所需的样本量为 $n_{0} = 250$ 名参与者。在计划的整群设计中，医院是群组，每家医院在招募期间平均将提供 $m = 21$ 名符合条件的患者。既往数据表明，组内相关系数（ICC）为 $\\rho = 0.05$。从组内相关系数（ICC）的定义（即组间方差与总方差之比）以及在可交换相关结构下相关观测的样本均值方差出发，推导在相等群组大小情况下方差膨胀因子（设计效应）的一般表达式，并解释为什么必须将个体随机设计的每组样本量乘以该设计效应，以在整群抽样下保持相同的方差（和统计功效）。然后计算该整群随机试验两组所需的总膨胀样本量。假设两组分配均等，且整群设计中每组的样本量为 $n_{\\text{arm}} = D \\, n_{0}$，其中 $D$ 是您推导出的设计效应。以单个实数值形式提供最终答案（参与者人数）。除精确算术外，无需进行舍入。", "solution": "根据要求，解答分为三个部分：首先，推导设计效应（方差膨胀因子）；其次，解释其在样本量计算中的应用；第三，计算试验所需的总样本量。\n\n**第1部分：设计效应 ($D$) 的推导**\n\n设 $Y_{ij}$ 为第 $i$ 个群组（医院）中第 $j$ 名患者的二元结局。我们假设一个简单的方差分量模型，其中结局的总变异可以分解为两个来源：群组间变异和群组内变异。\n单个观测的总方差为 $\\text{Var}(Y_{ij}) = \\sigma^2$。这个总方差可以分解为 $\\sigma^2 = \\sigma_b^2 + \\sigma_w^2$，其中 $\\sigma_b^2$ 是组间方差，$\\sigma_w^2$ 是组内方差。\n\n组内相关系数（ICC），用 $\\rho$ 表示，定义为总方差中由组间变异引起的部分所占的比例。在数学上，这表示为：\n$$ \\rho = \\frac{\\sigma_b^2}{\\sigma_b^2 + \\sigma_w^2} = \\frac{\\sigma_b^2}{\\sigma^2} $$\nICC也表示同一群组 $i$ 内两个不同个体 $j$ 和 $l$ 结局之间的相关性：\n$$ \\rho = \\text{Corr}(Y_{ij}, Y_{il}) \\quad \\text{for } j \\neq l $$\n由此，同一群组中两个受试者之间的协方差为 $\\text{Cov}(Y_{ij}, Y_{il}) = \\rho \\sqrt{\\text{Var}(Y_{ij})\\text{Var}(Y_{il})} = \\rho \\sigma^2$。\n\n现在，考虑试验的一个组，有 $k$ 个群组，每个群组的规模统一为 $m$ 名患者。该组的总样本量为 $n = k \\times m$。该组的样本均值结局为 $\\bar{Y} = \\frac{1}{n} \\sum_{i=1}^{k} \\sum_{j=1}^{m} Y_{ij}$。\n\n该样本均值的方差为：\n$$ \\text{Var}(\\bar{Y}) = \\text{Var}\\left(\\frac{1}{km} \\sum_{i=1}^{k} \\sum_{j=1}^{m} Y_{ij}\\right) = \\frac{1}{(km)^2} \\text{Var}\\left(\\sum_{i=1}^{k} \\sum_{j=1}^{m} Y_{ij}\\right) $$\n由于不同群组中的患者是独立的，所有患者总和的方差是各群组总和方差之和：\n$$ \\text{Var}\\left(\\sum_{i=1}^{k} \\sum_{j=1}^{m} Y_{ij}\\right) = \\sum_{i=1}^{k} \\text{Var}\\left(\\sum_{j=1}^{m} Y_{ij}\\right) $$\n我们来计算单个群组总和 $\\sum_{j=1}^{m} Y_{ij}$ 的方差：\n$$ \\text{Var}\\left(\\sum_{j=1}^{m} Y_{ij}\\right) = \\sum_{j=1}^{m} \\text{Var}(Y_{ij}) + \\sum_{j \\neq l} \\text{Cov}(Y_{ij}, Y_{il}) $$\n这里有 $m$ 个方差项和 $m(m-1)$ 个协方差项。代入方差和协方差的表达式：\n$$ \\text{Var}\\left(\\sum_{j=1}^{m} Y_{ij}\\right) = m \\sigma^2 + m(m-1) \\rho \\sigma^2 = m \\sigma^2 [1 + (m-1)\\rho] $$\n因为有 $k$ 个这样的独立群组：\n$$ \\text{Var}\\left(\\sum_{i=1}^{k} \\sum_{j=1}^{m} Y_{ij}\\right) = k \\left( m \\sigma^2 [1 + (m-1)\\rho] \\right) $$\n将其代回样本均值方差的表达式中：\n$$ \\text{Var}(\\bar{Y}_{\\text{cluster}}) = \\frac{1}{(km)^2} \\left( k m \\sigma^2 [1 + (m-1)\\rho] \\right) = \\frac{\\sigma^2}{km} [1 + (m-1)\\rho] $$\n回想一下，$n=km$ 是该组中的受试者总数：\n$$ \\text{Var}(\\bar{Y}_{\\text{cluster}}) = \\frac{\\sigma^2}{n} [1 + (m-1)\\rho] $$\n相比之下，对于个体随机试验（等同于简单随机抽样），观测值是独立的，即 $\\rho=0$。大小为 $n$ 的样本的样本均值方差将是：\n$$ \\text{Var}(\\bar{Y}_{\\text{SRS}}) = \\frac{\\sigma^2}{n} $$\n方差膨胀因子（VIF），或称设计效应（$D$），是在整群随机化下均值的方差与在相同总样本量 $n$ 的简单随机抽样下均值的方差之比。\n$$ D = \\frac{\\text{Var}(\\bar{Y}_{\\text{cluster}})}{\\text{Var}(\\bar{Y}_{\\text{SRS}})} = \\frac{\\frac{\\sigma^2}{n} [1 + (m-1)\\rho]}{\\frac{\\sigma^2}{n}} $$\n在群组大小相等的情况下，这简化为设计效应的一般表达式：\n$$ D = 1 + (m-1)\\rho $$\n\n**第2部分：样本量膨胀的解释**\n\n一项比较两组的研究的统计功效是样本量、效应大小、显著性水平以及治疗效应估计量方差的函数。对于两个均值的比较，估计量是样本均值之差，其方差是每组均值方差的总和（假设组间独立）。\n\n设 $n_0$ 是在个体随机试验中达到期望功效所需的每组样本量。估计的治疗效应的方差与 $\\frac{\\sigma^2}{n_0} + \\frac{\\sigma^2}{n_0} = \\frac{2\\sigma^2}{n_0}$ 成正比。计算样本量 $n_0$ 是为了使该方差足够小，以便以指定的功效检测到目标效应大小。\n\n在整群随机试验中，每组样本均值的方差会因设计效应 $D$ 而膨胀。如果我们使用相同的每组样本量 $n_0$，均值的方差将是 $\\text{Var}(\\bar{Y}_{\\text{cluster}}) = \\frac{\\sigma^2}{n_0} D$。估计的治疗效应的方差将变为 $\\frac{\\sigma^2 D}{n_0} + \\frac{\\sigma^2 D}{n_0} = \\frac{2\\sigma^2 D}{n_0}$。由于 $D  1$（当 $\\rho  0$ 且 $m1$ 时），该方差大于个体随机试验中的方差，从而导致统计功效的损失。\n\n为了将功效恢复到最初计划的水平，整群试验中效应估计的方差必须与个体随机试验中的方差相等。设 $n_{\\text{arm}}$ 是整群试验所需的每组样本量。我们必须满足：\n$$ \\text{Var}_{\\text{cluster}} = \\text{Var}_{\\text{SRS}} $$\n$$ \\frac{2\\sigma^2 D}{n_{\\text{arm}}} = \\frac{2\\sigma^2}{n_0} $$\n求解 $n_{\\text{arm}}$ 可得：\n$$ n_{\\text{arm}} = D \\times n_0 $$\n这表明，个体随机化计算得出的样本量（$n_0$）必须乘以设计效应（$D$），才能得到整群随机试验中所需的每组样本量（$n_{\\text{arm}}$），以保持治疗效应估计的方差不变，从而保持相同的统计功效。\n\n**第3部分：总样本量的计算**\n\n我们已知以下数值：\n- 个体随机设计的每组样本量：$n_0 = 250$\n- 平均（假定为恒定）群组大小：$m = 21$\n- 组内相关系数：$\\rho = 0.05$\n\n首先，我们计算设计效应 $D$：\n$$ D = 1 + (m-1)\\rho $$\n$$ D = 1 + (21-1) \\times 0.05 = 1 + (20) \\times 0.05 = 1 + 1 = 2 $$\n接下来，我们计算整群随机试验每组所需的膨胀样本量 $n_{\\text{arm}}$：\n$$ n_{\\text{arm}} = D \\times n_0 = 2 \\times 250 = 500 $$\n两个组（干预组和常规护理组）每组需要 $500$ 名参与者。\n最后，整个试验所需的总样本量是两组样本量之和：\n$$ N_{\\text{total}} = 2 \\times n_{\\text{arm}} = 2 \\times 500 = 1000 $$\n该整群随机试验所需的总样本量为 $1000$ 名参与者。", "answer": "$$\\boxed{1000}$$", "id": "4609166"}, {"introduction": "在临床试验的实际执行过程中，受试者失访或数据缺失几乎是不可避免的，尤其是在需要长期随访的外科试验中。如果失访在不同治疗组之间存在差异，可能会导致分析结果产生偏倚。本练习将向您介绍一种重要的统计方法——逆概率加权（Inverse Probability Weighting, IPW），用于在满足特定假设（随机缺失）的前提下，调整因差异性失访造成的偏倚，从而得到更可靠的治疗效果估计。[@problem_id:4609170]", "problem": "一项在普外科进行的两臂随机对照试验（Randomized Controlled Trial, RCT）比较了择期结肠切除术中的腹腔镜技术$A$和技术$B$。主要终点是$30$天手术部位感染，编码为二元结局$Y \\in \\{0,1\\}$。部分参与者在$30$天时失访。被随访的概率（即$R=1$表示观察到结局）使用逻辑回归模型建模如下\n$$\n\\ln\\left(\\frac{p_{\\text{follow}}}{1-p_{\\text{follow}}}\\right) \\equiv \\text{logit}(p_{\\text{follow}}) = \\beta_{0} + \\beta_{1}\\,\\mathbb{I}\\{Z=B\\} + \\beta_{2}\\,\\mathbb{I}\\{\\text{Age}\\ge 65\\} + \\beta_{3}\\,\\mathbb{I}\\{\\text{American Society of Anesthesiologists (ASA)}\\ge 3\\} + \\beta_{4}\\,\\mathbb{I}\\{Z=B\\}\\cdot \\mathbb{I}\\{\\text{ASA}\\ge 3\\},\n$$\n其中$Z \\in \\{A,B\\}$是随机分组。拟合的系数为$\\beta_{0}=-0.4$, $\\beta_{1}=-0.2$, $\\beta_{2}=-0.6$, $\\beta_{3}=-0.7$和$\\beta_{4}=+0.3$。\n\n共有$N_{A}=160$名参与者被随机分配到技术$A$组，$N_{B}=140$名参与者被随机分配到技术$B$组。在有观察到结局（$R=1$）的参与者中，按年龄和ASA状态分层的观察到的参与者数量和观察到的感染数量如下：\n\n- 技术 A：\n  - 年龄 $ 65$，ASA $ 3$：观察到 $60$ 人，感染 $6$ 例。\n  - 年龄 $ 65$，ASA $\\ge 3$：观察到 $20$ 人，感染 $3$ 例。\n  - 年龄 $\\ge 65$，ASA $ 3$：观察到 $30$ 人，感染 $5$ 例。\n  - 年龄 $\\ge 65$，ASA $\\ge 3$：观察到 $10$ 人，感染 $3$ 例。\n\n- 技术 B：\n  - 年龄 $ 65$，ASA $ 3$：观察到 $50$ 人，感染 $2$ 例。\n  - 年龄 $ 65$，ASA $\\ge 3$：观察到 $15$ 人，感染 $3$ 例。\n  - 年龄 $\\ge 65$，ASA $ 3$：观察到 $25$ 人，感染 $3$ 例。\n  - 年龄 $\\ge 65$，ASA $\\ge 3$：观察到 $20$ 人，感染 $4$ 例。\n\n假设在逻辑模型中出现的协变量条件下，缺失是随机缺失（Missing At Random, MAR）。应用逆概率加权（Inverse Probability Weighting, IPW）方法，使用逻辑模型预测的随访概率作为权重，来调整差异性脱落。\n\n计算每组$30$天感染风险的IPW Horvitz–Thompson估计值，并以单个十进制比例报告IPW风险差$\\Delta = \\pi_{B} - \\pi_{A}$。将您的最终答案四舍五入到四位有效数字。最终答案以纯数字形式表示，不带单位，也不带百分号。", "solution": "目标是计算两种手术技术$A$和$B$之间$30$天手术部位感染风险差的逆概率加权（IPW）估计值。风险差定义为$\\Delta = \\pi_{B} - \\pi_{A}$，其中$\\pi_{A}$和$\\pi_{B}$是相应组别的真实感染风险。\n\n在治疗组$Z \\in \\{A, B\\}$中，平均结局（风险）的IPW估计值由Horvitz-Thompson估计量给出：\n$$ \\hat{\\pi}_Z^{IPW} = \\frac{1}{N_Z} \\sum_{i=1}^{N_Z} \\frac{R_i Y_i}{\\hat{p}_i} $$\n其中$N_Z$是随机分配到$Z$组的参与者总数，$R_i$是结局被观察到（$R_i=1$）或缺失（$R_i=0$）的指示变量，$Y_i$是二元结局（$Y_i=1$表示感染，否则为$0$），$\\hat{p}_i$是参与者$i$的估计随访概率。\n\n数据是按年龄和ASA评分组合定义的分层提供的。令$k$为这些分层的索引。在每个分层$k$和治疗组$Z$内，所有个体的随访概率$\\hat{p}_{Z,k}$是恒定的。对于分层数据，该公式可以改写为：\n$$ \\hat{\\pi}_Z^{IPW} = \\frac{1}{N_Z} \\sum_{k} \\frac{y_{Z,k}}{\\hat{p}_{Z,k}} $$\n其中$y_{Z,k}$是$Z$组分层$k$中观察到的感染数量。\n\n首先，我们必须为8个分层（2个组 $\\times$ 4个协变量组合）中的每一个计算随访概率$\\hat{p}$。逻辑模型由下式给出：\n$$ \\text{logit}(p) = \\beta_{0} + \\beta_{1}\\,\\mathbb{I}\\{Z=B\\} + \\beta_{2}\\,\\mathbb{I}\\{\\text{Age}\\ge 65\\} + \\beta_{3}\\,\\mathbb{I}\\{\\text{ASA}\\ge 3\\} + \\beta_{4}\\,\\mathbb{I}\\{Z=B\\}\\cdot \\mathbb{I}\\{\\text{ASA}\\ge 3\\} $$\n系数为$\\beta_{0}=-0.4$, $\\beta_{1}=-0.2$, $\\beta_{2}=-0.6$, $\\beta_{3}=-0.7$和$\\beta_{4}=+0.3$。概率$p$通过公式$p = \\frac{1}{1 + \\exp(-\\eta)}$从logit值$\\eta$中恢复。\n\n我们定义指示变量：$Z_B = \\mathbb{I}\\{Z=B\\}$, $Age_{65} = \\mathbb{I}\\{\\text{Age}\\ge 65\\}$和$ASA_3 = \\mathbb{I}\\{\\text{ASA}\\ge 3\\}$。logit模型为$\\eta = -0.4 - 0.2 Z_B - 0.6 Age_{65} - 0.7 ASA_3 + 0.3 Z_B \\cdot ASA_3$。\n\n我们为每个分层计算logit值$\\eta$和随访概率$\\hat{p}$：\n\n对于技术 A ($Z_B=0$):\n模型简化为$\\eta_A = -0.4 - 0.6 Age_{65} - 0.7 ASA_3$。\n1.  年龄 $ 65$，ASA $ 3$ ($Age_{65}=0, ASA_3=0$)：$\\eta_{A,1} = -0.4$。\n    $\\hat{p}_{A,1} = \\frac{1}{1+\\exp(0.4)} \\approx 0.401312$\n2.  年龄 $ 65$，ASA $\\ge 3$ ($Age_{65}=0, ASA_3=1$)：$\\eta_{A,2} = -0.4 - 0.7 = -1.1$。\n    $\\hat{p}_{A,2} = \\frac{1}{1+\\exp(1.1)} \\approx 0.249740$\n3.  年龄 $\\ge 65$，ASA $ 3$ ($Age_{65}=1, ASA_3=0$)：$\\eta_{A,3} = -0.4 - 0.6 = -1.0$。\n    $\\hat{p}_{A,3} = \\frac{1}{1+\\exp(1.0)} \\approx 0.268941$\n4.  年龄 $\\ge 65$，ASA $\\ge 3$ ($Age_{65}=1, ASA_3=1$)：$\\eta_{A,4} = -0.4 - 0.6 - 0.7 = -1.7$。\n    $\\hat{p}_{A,4} = \\frac{1}{1+\\exp(1.7)} \\approx 0.154465$\n\n对于技术 B ($Z_B=1$):\n模型简化为$\\eta_B = (-0.4 - 0.2) - 0.6 Age_{65} + (-0.7 + 0.3) ASA_3 = -0.6 - 0.6 Age_{65} - 0.4 ASA_3$。\n1.  年龄 $ 65$，ASA $ 3$ ($Age_{65}=0, ASA_3=0$)：$\\eta_{B,1} = -0.6$。\n    $\\hat{p}_{B,1} = \\frac{1}{1+\\exp(0.6)} \\approx 0.354344$\n2.  年龄 $ 65$，ASA $\\ge 3$ ($Age_{65}=0, ASA_3=1$)：$\\eta_{B,2} = -0.6 - 0.4 = -1.0$。\n    $\\hat{p}_{B,2} = \\frac{1}{1+\\exp(1.0)} \\approx 0.268941$\n3.  年龄 $\\ge 65$，ASA $ 3$ ($Age_{65}=1, ASA_3=0$)：$\\eta_{B,3} = -0.6 - 0.6 = -1.2$。\n    $\\hat{p}_{B,3} = \\frac{1}{1+\\exp(1.2)} \\approx 0.231475$\n4.  年龄 $\\ge 65$，ASA $\\ge 3$ ($Age_{65}=1, ASA_3=1$)：$\\eta_{B,4} = -0.6 - 0.6 - 0.4 = -1.6$。\n    $\\hat{p}_{B,4} = \\frac{1}{1+\\exp(1.6)} \\approx 0.167982$\n\n接下来，我们计算每组感染风险的IPW估计值。\n对于技术 A，$N_A = 160$。感染数量为 $y_{A,1}=6$, $y_{A,2}=3$, $y_{A,3}=5$, $y_{A,4}=3$。\n$$ \\hat{\\pi}_A^{IPW} = \\frac{1}{160} \\left( \\frac{6}{\\hat{p}_{A,1}} + \\frac{3}{\\hat{p}_{A,2}} + \\frac{5}{\\hat{p}_{A,3}} + \\frac{3}{\\hat{p}_{A,4}} \\right) $$\n$$ \\hat{\\pi}_A^{IPW} \\approx \\frac{1}{160} \\left( \\frac{6}{0.401312} + \\frac{3}{0.249740} + \\frac{5}{0.268941} + \\frac{3}{0.154465} \\right) $$\n$$ \\hat{\\pi}_A^{IPW} \\approx \\frac{1}{160} (14.9509 + 12.0122 + 18.5916 + 19.4225) = \\frac{64.9772}{160} \\approx 0.4061075 $$\n\n对于技术 B，$N_B = 140$。感染数量为 $y_{B,1}=2$, $y_{B,2}=3$, $y_{B,3}=3$, $y_{B,4}=4$。\n$$ \\hat{\\pi}_B^{IPW} = \\frac{1}{140} \\left( \\frac{2}{\\hat{p}_{B,1}} + \\frac{3}{\\hat{p}_{B,2}} + \\frac{3}{\\hat{p}_{B,3}} + \\frac{4}{\\hat{p}_{B,4}} \\right) $$\n$$ \\hat{\\pi}_B^{IPW} \\approx \\frac{1}{140} \\left( \\frac{2}{0.354344} + \\frac{3}{0.268941} + \\frac{3}{0.231475} + \\frac{4}{0.167982} \\right) $$\n$$ \\hat{\\pi}_B^{IPW} \\approx \\frac{1}{140} (5.6443 + 11.1549 + 12.9606 + 23.8116) = \\frac{53.5714}{140} \\approx 0.382653 $$\n\n最后，我们计算IPW风险差 $\\Delta = \\hat{\\pi}_B^{IPW} - \\hat{\\pi}_A^{IPW}$。\n$$ \\Delta \\approx 0.382653 - 0.4061075 = -0.0234545 $$\n\n问题要求将最终答案四舍五入到四位有效数字。\n值为 $-0.0234545$。要四舍五入到四位有效数字，我们检查第五位有效数字，即4。由于它小于5，我们向下舍入。\n最终结果是 $-0.02345$。", "answer": "$$ \\boxed{-0.02345} $$", "id": "4609170"}]}