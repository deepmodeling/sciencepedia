{"hands_on_practices": [{"introduction": "现代临床微生物学的一个核心进展是利用全基因组测序（WGS）来深入了解病原体。这项实践将挑战您扮演一名分子侦探，根据一份详细的耐药基因列表预测鲍曼不动杆菌的表型药敏谱 ([@problem_id:4619179])。这对于指导针对多重耐药菌的治疗至关重要，是连接基因型与临床表型的关键技能。", "problem": "一名内科重症监护室的患者出现了呼吸机相关性肺炎。一份临床分离株被鉴定为鲍曼不动杆菌 (Acinetobacter baumannii, A. baumannii)。全基因组测序 (Whole-Genome Sequencing, WGS) 和靶向组装揭示了以下与耐药性相关的特征，除非另有说明，所有这些特征均被确认为完整的开放阅读框，没有发生截短：\n\n- 一个 D 类催邻氯青霉素酶碳青霉烯酶基因 `blaOXA-23`，其上游存在一个 `ISAba1` 插入序列。\n- 一个不动杆菌源性头孢菌素酶 (Acinetobacter-Derived Cephalosporinase, ADC) 基因 `blaADC-25`，其上游存在一个 `ISAba1` 插入序列，这与启动子上调一致。\n- 外膜孔蛋白基因 `carO` 发生移码突变，这与功能丧失一致。\n- 双组分调节因子 `adeR` 发生错义突变，这与 AdeABC 耐药-结瘤-分裂 (Resistance-Nodulation-Division, RND) 外排泵的过表达一致。\n- PmrAB 双组分系统内的 `pmrB` 基因在第 $235$ 位发生取代 (T$235$N)；`lpxA/lpxC/lpxD` 基因完整，无无义突变；未检测到可移动的黏菌素耐药 `mcr` 基因。\n- 一个 $16$S 核糖体 RNA 甲基转移酶基因 `armA`。\n- 氨基糖苷类修饰酶 (Aminoglycoside-Modifying Enzyme, AME) 基因 `aph(3')-VIa` 和 `aac(3)-Ia`。\n- 一个四环素外排基因 `tet(B)`。\n- 除了天然存在的多态性外，未检测到碳青霉烯靶点 PBP 的改变；其他方面的青霉素结合蛋白是保守的。\n\n假设将根据临床和实验室标准协会 (Clinical and Laboratory Standards Institute, CLSI) 或欧洲抗菌药物药敏试验委员会 (European Committee on Antimicrobial Susceptibility Testing, EUCAST) 的框架，通过肉汤微量稀释法进行标准化的实验室药敏试验，并且分类判读将遵循相应的菌种特异性折点。使用以下基本原理：\n\n- 分子生物学的中心法则 (DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质)，其中基因剂量和启动子效应会转化为酶和泵的丰度。\n- 酶促水解会降低活性药物浓度，其程度与催化速率常数 $k_{\\text{cat}}$ 和酶浓度 $[\\text{enzyme}]$ 成正比。\n- 进入革兰氏阴性菌的被动流入取决于外膜的通透性，净通量与通透性系数 $P$ 成比例 (类菲克行为)，而外排泵则增加一个与泵活性 $E$ 成正比的向外通量。\n- 多粘菌素类 (黏菌素和多粘菌素B) 通过静电结合到脂多糖的脂质A上发挥作用；PmrAB 介导的脂质A修饰会降低负电荷密度和结合亲和力。\n- 氨基糖苷类药物结合到核糖体解码位点的 $16$S rRNA A$1408$ 区域；核糖体甲基化会产生空间位阻，阻断结合并导致高水平耐药。\n- 四环素类药物对外排泵和 `tet(B)` 的敏感性不同；替加环素对 AdeABC 的过表达尤其敏感。\n\n预测以下类别药物最具有科学合理性的表型药敏谱：β-内酰胺类、多粘菌素类、四环素类和氨基糖苷类。此外，识别由于表达和通透性的可变性，基因型和表型之间最可能出现的不一致方向。选择最能一致地整合基因组决定因素、生物物理转运和已知药物-靶点相互作用的唯一最佳选项。\n\nA. β-内酰胺类：碳青霉烯类耐药；广谱头孢菌素类耐药；哌拉西林-他唑巴坦耐药；氨苄西林-舒巴坦因舒巴坦的内在活性而敏感。多粘菌素类：耐药。四环素类：四环素耐药，米诺环素敏感，替加环素敏感。氨基糖苷类：高水平耐药。不一致性：未预测到。\n\nB. β-内酰胺类：碳青霉烯类耐药；广谱头孢菌素类耐药；哌拉西林-他唑巴坦耐药；氨苄西林-舒巴坦非敏感。多粘菌素类：可能耐药，具有潜在的异质性耐药和方法依赖性的分类不一致。四环素类：由于 `tet(B)`，四环素和米诺环素耐药；由于 AdeABC 过表达，替加环素非敏感。氨基糖苷类：无论 AMEs 如何，均由 armA 介导高水平、广谱的耐药性。不一致性：随着 AdeABC 表达的变化，替加环素的分类可能发生变化；由于 PmrAB 驱动的异质性耐药和检测方法的差异，黏菌素的结果可能发生变化。\n\nC. β-内酰胺类：碳青霉烯类敏感，因为孔蛋白丢失减少了药物进入，从而使水解最小化；广谱头孢菌素类敏感；由于β-内酰胺酶被抑制，哌拉西林-他唑巴坦敏感。多粘菌素类：敏感，因为 lpxC 完整。四环素类：四环素和米诺环素敏感；替加环素敏感。氨基糖苷类：仅对庆大霉素耐药，对阿米卡星敏感。不一致性：未预测到。\n\nD. β-内酰胺类：碳青霉烯类耐药；广谱头孢菌素类可变敏感，因为哌拉西林-他唑巴坦抑制 ADC；氨苄西林-舒巴坦敏感。多粘菌素类：敏感。四环素类：四环素耐药，米诺环素敏感，替加环素非敏感。氨基糖苷类：低水平耐药，可通过增加暴露量轻易克服。不一致性：仅限于头孢菌素类，因为只有接种量效应。\n\n选择最佳选项。", "solution": "该问题要求根据一个*鲍曼不动杆菌* (*Acinetobacter baumannii*) 分离株的基因组特征，并利用所提供的基本原理，来预测其抗菌药物敏感性表型。首先必须评估问题陈述的有效性。\n\n### 问题有效性验证\n\n**步骤 1：提取已知信息**\n\n问题提供了一株临床 *A. baumannii* 分离株的以下基因组和背景信息：\n-   **遗传决定因素**:\n    1.  一个 D 类碳青霉烯酶基因 `blaOXA-23`，其上游存在一个 `ISAba1` 插入序列。\n    2.  一个不动杆菌源性头孢菌素酶 (ADC) 基因 `blaADC-25`，其上游存在一个 `ISAba1` 插入序列。\n    3.  外膜孔蛋白基因 `carO` 发生移码突变。\n    4.  `adeR` 发生错义突变，这与 `AdeABC` RND 外排泵的过表达一致。\n    5.  `pmrB` 基因存在 `T235N` 取代；`lpxA/lpxC/lpxD` 基因完整；无 `mcr` 基因。\n    6.  一个 $16$S 核糖体 RNA 甲基转移酶基因 `armA`。\n    7.  氨基糖苷类修饰酶 (AME) 基因 `aph(3')-VIa` 和 `aac(3)-Ia`。\n    8.  一个四环素外排基因 `tet(B)`。\n    9.  碳青霉烯靶点青霉素结合蛋白 (PBP) 无改变。\n-   **基本原理**:\n    1.  中心法则：基因表达水平决定蛋白质丰度。\n    2.  酶促水解：药物失活取决于酶动力学和浓度。\n    3.  膜转运：净通量是被动流入 ($P$) 和主动外排 ($E$) 之间的平衡。\n    4.  多粘菌素耐药性：由 PmrAB 驱动的脂质A修饰介导，降低结合力。\n    5.  氨基糖苷类耐药性：`armA` 介导的核糖体甲基化阻断药物结合。\n    6.  四环素耐药性：由 `tet(B)` 和 `AdeABC` 等外排泵介导。\n\n**步骤 2：使用提取的已知信息进行验证**\n\n该问题具有科学依据、提法严谨且客观。\n-   **科学依据**：所列出的基因（`blaOXA-23`、`blaADC-25`、`carO`、`AdeABC`、`pmrB`、`armA`、`tet(B)`）及其相关的耐药机制是广泛耐药*鲍曼不动杆菌*的教科书级例子。所描述的情景在临床上是现实的，在生物化学上是准确的。`ISAba1` 作为启动子的作用、酶促水解和孔蛋白丢失对碳青霉烯类耐药性的协同作用、`PmrAB` 在黏菌素耐药中的功能、`armA` 在氨基糖苷类耐药中的主导作用，以及 `AdeABC` 在替加环素耐药中的作用，都已是公认的科学事实。\n-   **提法严谨**：问题提供了一套全面的遗传数据和一套用于预测表型的清晰原则。问题具体且可回答。\n-   **客观性**：问题以精确、技术性的语言陈述，没有主观或含糊不清的术语。\n\n**步骤 3：结论与行动**\n\n问题陈述是**有效的**。这是一个在临床微生物学中将基因型转化为表型的严谨而现实的练习。接下来进行解答推导。\n\n### 表型预测与选项分析\n\n基于所提供的基因组数据，对每一类抗生素的系统性预测如下：\n\n**1. β-内酰胺类（碳青霉烯类、头孢菌素类等）**\n-   **碳青霉烯类（如亚胺培南、美罗培南）**：该分离株拥有两种强效的碳青霉烯耐药机制。首先，存在 `blaOXA-23` 基因，这是一种众所周知的碳青霉烯酶。其上游的 `ISAba1` 插入序列提供了一个强启动子，显著增强了其表达。其次，`carO` 基因的移码突变导致外膜孔蛋白功能丧失。`CarO` 是碳青霉烯类药物进入细菌细胞的主要通道。药物流入减少（因孔蛋白丢失）和药物高效水解（因 `blaOXA-23` 过表达）的组合将导致对**碳青霉烯类药物的高水平耐药**。\n-   **广谱头孢菌素类（如头孢他啶、头孢吡肟）**：`blaADC-25` 基因编码一种 C 类头孢菌素酶。与 `blaOXA-23` 类似，其表达被上游的 `ISAba1` 元件强烈上调。过表达的 ADC 酶赋予了对**广谱头孢菌素类药物的高水平耐药**。\n-   **哌拉西林-他唑巴坦**：他唑巴坦是一种 β-内酰胺酶抑制剂，但它对 D 类碳青霉烯酶（如 OXA-23）活性较差，并且对过表达的 C 类头孢菌素酶（如 ADC-25）无效。因此，酶促耐药性不会被克服，该分离株将对**哌拉西林-他唑巴坦耐药**。\n-   **氨苄西林-舒巴坦**：舒巴坦通过与其 PBP 结合，对*鲍曼不动杆菌*表现出内在的杀菌活性。然而，在具有多种强效耐药机制（如 `blaOXA-23` 和 `blaADC-25` 过表达）的菌株中，这种内在活性通常不足以达到敏感。因此，表型最可能是**非敏感**或**耐药**。\n\n**2. 多粘菌素类（黏菌素、多粘菌素B）**\n-   该分离株在 `PmrAB` 双组分系统的组成部分 `pmrB` 中存在 `T235N` 取代。这类突变是*鲍曼不动杆菌*获得性黏菌素耐药的典型机制。该突变导致系统组成性激活，引起脂质 A 被磷酸乙醇胺修饰。这降低了外膜的净负电荷，从而减少了带正电荷的多粘菌素类抗生素的静电结合。预测结果是对**多粘菌素类耐药**。\n-   `PmrAB` 介导的耐药性的一个关键方面是它经常表现为**异质性耐药**，即只有一部分细胞群体表达耐药表型。这给实验室检测带来了重大挑战，结果通常取决于所使用的具体方法（例如，肉汤微量稀释法 vs. 梯度扩散法）和接种量。因此，**方法依赖性的分类不一致**是一个显著且预期的特征。\n\n**3. 四环素类（四环素、米诺环素、替加环素）**\n-   `tet(B)` 基因编码一种四环素特异性外排泵，该泵赋予对老一代四环素类药物如**四环素**和**米诺环素**的耐药性。\n-   `adeR` 中的错义突变导致 `AdeABC` RND 外排泵过表达。该泵具有广泛的底物谱，进一步导致对四环素和米诺环素的耐药。至关重要的是，`AdeABC` 过表达是*鲍曼不动杆菌*中对**替加环素**产生获得性耐药的主要机制。因此，预计该分离株将对**替加环素非敏感**。\n-   `AdeABC` 的表达可能是可变的，这意味着替加环素的最低抑菌浓度 (MIC) 可能会波动。这为**基因型-表型不一致**创造了可能性，即分离株在体外可能检测为敏感或中介，但在体内治疗失败。\n\n**4. 氨基糖苷类（庆大霉素、阿米卡星等）**\n-   `armA` 基因的存在是最关键的决定因素。`armA` 编码一种 $16$S rRNA 甲基转移酶，该酶修饰药物靶点（核糖体中的 `A1408`）。这种修饰阻止了几乎所有临床使用的氨基糖苷类药物的结合。该机制赋予了对庆大霉素、妥布霉素和阿米卡星等药物的**高水平、广谱耐药性**。\n-   AME 基因（`aph(3')-VIa`、`aac(3)-Ia`）的存在也对特定氨基糖苷类药物的耐药性有贡献，但在机制上从属于 `armA` 介导的靶点修饰。`armA` 表型是显性的，并且对 AME 表型具有上位性。\n\n### 选项评估\n\n**A.** 不正确。此选项错误地预测了对米诺环素和替加环素敏感，忽略了 `tet(B)` 和 `AdeABC` 过表达的影响。它还错误地预测了对氨苄西林-舒巴坦敏感，这在这样一个耐药菌株中是不太可能的。最后，它未能识别任何潜在的基因型-表型不一致性。\n\n**B.** 正确。此选项提供了全面而准确的预测。\n-   **β-内酰胺类**：正确预测了对碳青霉烯类、头孢菌素类和哌拉西林-他唑巴坦的耐药性，并正确指出了氨苄西林-舒巴坦更可能的非敏感表型。\n-   **多粘菌素类**：正确预测了耐药性，并且关键地包含了异质性耐药和方法依赖性不一致的细微差别。\n-   **四环素类**：正确预测了对四环素和米诺环素的耐药性，以及对替加环素的非敏感性，并正确地归因了其机制。\n-   **氨基糖苷类**：正确预测了由显性的 `armA` 基因介导的高水平、广谱耐药性。\n-   **不一致性**：准确地指出了两个最显著的潜在不一致领域：由于 `AdeABC` 表达变化导致的替加环素分类可变，以及由于 `PmrAB` 驱动的异质性耐药和检测方法的差异导致的黏菌素结果可变。\n\n**C.** 不正确。此选项存在根本性缺陷。它误解了孔蛋白丢失会导致敏感性。它基于完整的 `lpxC` 错误地推断出对多粘菌素敏感。它错误地预测了对四环素类敏感，并对氨基糖苷类耐药谱做出了错误的预测，忽略了 `armA` 的作用。\n\n**D.** 不正确。此选项错误地预测了对多粘菌素敏感，忽略了 `pmrB` 突变。它错误地预测了对米诺环素敏感。它错误地将氨基糖苷类耐药描述为“低水平”，这与 `armA` 赋予的高水平耐药相矛盾。其对头孢菌素敏感性和不一致性的解释也混乱且不准确。\n\n因此，选项 B 是唯一一个能够一致且准确地将所有提供的基因组和机理信息整合到一个科学上可辩护的表型预测中的选项。", "answer": "$$\\boxed{B}$$", "id": "4619179"}, {"introduction": "在能够表征单个菌株的基因组之后，下一步自然是比较来自不同患者的菌株基因组，以绘制传播路径。这项实践介绍了分子流行病学的核心原理，即如何利用单核苷酸多态性（SNP）距离结合时间数据来识别疫情暴发中的传播簇 ([@problem_id:4619195])。您将通过一个计算任务，亲身体验支撑现代感染控制调查的生物信息学方法。", "problem": "您正在分析来自重症监护室（ICU）分离的鲍曼不动杆菌（Acinetobacter baumannii）的全基因组测序（WGS）数据，以推断假定的传播簇。这些分离株已作为核苷酸字母表上的多序列比对字符串提供。您的任务是纯粹用数学和算法术语来形式化和实现以下内容。\n\n基本依据和定义：\n- 设有 $n$ 个分离株，每个都由一个长度为 $L$ 的比对后核苷酸序列 $S_i$ 表示，其中 $i \\in \\{1,\\dots,n\\}$，位置由 $p \\in \\{1,\\dots,L\\}$ 索引。序列可能包含歧义或间隙字符。\n- 定义有效核苷酸字母表为 $\\mathcal{A} = \\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}\\}$。任何不在此字母表 $\\mathcal{A}$ 中的字符，如 $\\mathrm{N}$ 或 $-$，在核心基因组比较中均被视为无信息量。\n- 定义核心索引集为\n$$\n\\mathcal{C} = \\{ p \\in \\{1,\\dots,L\\} \\mid \\forall i \\in \\{1,\\dots,n\\}, \\; S_i[p] \\in \\mathcal{A} \\}.\n$$\n也就是说，$\\mathcal{C}$ 精确地包含了所有分离株都具有信息性核苷酸的比对列。\n- 对于分离株 $i$ 和 $j$，定义仅限于核心基因组的单核苷酸多态性（SNP）距离为汉明距离\n$$\nd(i,j) = \\sum_{p \\in \\mathcal{C}} \\mathbf{1}\\{ S_i[p] \\neq S_j[p] \\},\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n- 每个分离株 $i$ 还有一个采样时间 $t_i$，以天为单位的整数表示。时间差为 $|t_i - t_j|$，以天为单位。\n- 给定一个 SNP 阈值 $D_{\\max}$ 和一个时间窗口 $T_{\\max}$（以天为单位），定义一个无向图 $G=(V,E)$，其中 $V=\\{1,\\dots,n\\}$，且\n$$\n\\{i,j\\} \\in E \\iff \\left( d(i,j) \\le D_{\\max} \\right) \\wedge \\left( |t_i - t_j| \\le T_{\\max} \\right).\n$$\n- 传播簇被定义为 $G$ 中大小至少为 $2$ 的任何连通分量。单点（大小为 1 的分量）不作为簇报告。\n\n您的程序必须：\n1. 对于每个测试用例（数据集），计算核心索引集 $\\mathcal{C}$、成对的核心基因组 SNP 距离 $d(i,j)$，并在给定的 $D_{\\max}$ 和 $T_{\\max}$ 下构建图 $G$。\n2. 输出所有大小至少为 2 的连通分量，形式为分离株标识符（整数）的列表。在每个簇内，标识符按升序排序；簇的列表则按每个簇中最小的标识符排序。\n3. 将所有测试用例的结果汇总为单行，作为一个顶层的结果列表，其中每个结果是该测试用例的簇列表。\n\n测试套件和参数：\n- 测试用例 1（理想情况，包含两个簇）：\n  - $D_{\\max} = 3$， $T_{\\max} = 14$（天）。\n  - $n=5$ 个分离株，比对序列长度 $L=24$，采样时间（天）如下：\n    - 分离株 1：$S_1 = \\mathrm{ATGCTAGCTAGCTAGCTAGCTAGC}$，$t_1 = 0$。\n    - 分离株 2：$S_2$ 与 $S_1$ 相同，但在位置 5 和 10 处有恰好 2 个点突变，$t_2 = 7$。\n    - 分离株 3：$S_3$ 与 $S_1$ 相同，但在位置 5、10 和 15 处有恰好 3 个点突变，$t_3 = 12$。\n    - 分离株 4：$S_4$ 与 $S_1$ 相同，但在位置 2、4、6、8、12 和 14 处有恰好 6 个点突变，$t_4 = 20$。\n    - 分离株 5：$S_5$ 与 $S_1$ 相同，但在位置 2、4、6、8、12 和 16 处有恰好 6 个点突变，$t_5 = 28$。\n    - 所有序列仅包含 $\\mathcal{A}$ 中的字符，因此所有列都有资格成为 $\\mathcal{C}$ 的一部分。\n- 测试用例 2（时间边界及非核心列的移除）：\n  - $D_{\\max} = 0$， $T_{\\max} = 10$（天）。\n  - $n=3$ 个分离株，比对序列长度 $L=10$，采样时间（天）如下：\n    - 分离株 1：$S_1 = \\mathrm{ACGTACGTAC}$，$t_1 = 0$。\n    - 分离株 2：$S_2 = \\mathrm{ACNTACGTAC}$（仅在位置 3 处有字符 $\\mathrm{N}$），$t_2 = 10$。\n    - 分离株 3：$S_3 = \\mathrm{ACGTACG-AC}$（仅在位置 8 处有字符 $-$），$t_3 = 21$。\n    - 只有所有分离株在 $\\mathcal{A}$ 中的位置才被保留在 $\\mathcal{C}$ 中。在这些位置上，分离株是相同的。\n- 测试用例 3（包含许多非核心列和严格时间窗口的边缘情况）：\n  - $D_{\\max} = 1$， $T_{\\max} = 5$（天）。\n  - $n=4$ 个分离株，比对序列长度 $L=12$，采样时间（天）如下：\n    - 分离株 1：$S_1 = \\mathrm{AAAACCCCGGGG}$，$t_1 = 100$。\n    - 分离株 2：$S_2 = \\mathrm{AAAACCCCGGGA}$（仅在位置 12 处与 $S_1$ 不同），$t_2 = 103$。\n    - 分离株 3：$S_3 = \\mathrm{----CCCCGGGG}$（在位置 1 到 4 处有间隙），$t_3 = 102$。\n    - 分离株 4：$S_4 = \\mathrm{AAAANCCCGG-G}$（在位置 5 处有字符 $\\mathrm{N}$，在位置 11 处有间隙），$t_4 = 110$。\n    - 核心索引集 $\\mathcal{C}$ 是所有分离株都具有 $\\mathcal{A}$ 中字符的位置的交集。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，不含空格。每个元素对应一个测试用例，其本身是一个簇的列表，其中每个簇是分离株标识符（整数）的列表。例如，三个测试用例的一个语法上有效的输出看起来像 `[[[1,2],[3,4]],[[5,6]],[]]`。", "solution": "用户要求对一个算法进行形式化和实现，该算法用于从全基因组测序数据和采样时间中识别鲍曼不动杆菌（*Acinetobacter baumannii*）的推定传播簇。该问题通过构建一个图并找到其连通分量来解决。\n\n### **问题验证**\n\n**第 1 步：提取给定信息**\n\n- **分离株与序列**：$n$ 个分离株，每个都有一个长度为 $L$ 的比对后核苷酸序列 $S_i$，其中 $i \\in \\{1, \\dots, n\\}$。\n- **有效字母表**：$\\mathcal{A} = \\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}\\}$。不在 $\\mathcal{A}$ 中的字符是无信息量的。\n- **核心索引集**：$\\mathcal{C} = \\{ p \\in \\{1, \\dots, L\\} \\mid \\forall i \\in \\{1, \\dots, n\\}, \\; S_i[p] \\in \\mathcal{A} \\}$。\n- **核心基因组 SNP 距离**：对于分离株 $i$ 和 $j$，$d(i,j) = \\sum_{p \\in \\mathcal{C}} \\mathbf{1}\\{ S_i[p] \\neq S_j[p] \\}$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n- **采样时间**：每个分离株 $i$ 有一个采样时间 $t_i$（整数天）。\n- **图定义**：一个无向图 $G=(V, E)$，其中 $V=\\{1, \\dots, n\\}$，且当且仅当 $(d(i,j) \\le D_{\\max}) \\wedge (|t_i - t_j| \\le T_{\\max})$ 时，存在一条边 $\\{i,j\\} \\in E$。\n- **传播簇**：$G$ 中大小至少为 2 的一个连通分量。\n- **输出格式**：对于每个测试用例，输出一个簇列表。每个簇是一个按升序排序的分离株标识符列表。簇列表必须按每个簇中最小的标识符排序。最终输出是聚合所有测试用例结果的单行字符串。\n- **测试用例 1**：$D_{\\max} = 3$，$T_{\\max} = 14$ 天。$n=5$，$L=24$。所有位置都是核心位置。\n  - $t_1=0$。$S_1$ 是基准序列。\n  - $t_2=7$。$S_2$ 与 $S_1$ 有 2 个突变差异。\n  - $t_3=12$。$S_3$ 与 $S_1$ 有 3 个突变差异。\n  - $t_4=20$。$S_4$ 与 $S_1$ 有 6 个突变差异。\n  - $t_5=28$。$S_5$ 与 $S_1$ 有 6 个突变差异。\n  - 突变位置已指定，用于计算除 $S_1$ 之外的分离株之间的距离。\n- **测试用例 2**：$D_{\\max} = 0$，$T_{\\max} = 10$ 天。$n=3$，$L=10$。\n  - $S_1 = \\mathrm{ACGTACGTAC}$，$t_1 = 0$。\n  - $S_2 = \\mathrm{ACNTACGTAC}$，$t_2 = 10$。\n  - $S_3 = \\mathrm{ACGTACG-AC}$，$t_3 = 21$。\n- **测试用例 3**：$D_{\\max} = 1$，$T_{\\max} = 5$ 天。$n=4$，$L=12$。\n  - $S_1 = \\mathrm{AAAACCCCGGGG}$，$t_1 = 100$。\n  - $S_2 = \\mathrm{AAAACCCCGGGA}$，$t_2 = 103$。\n  - $S_3 = \\mathrm{----CCCCGGGG}$，$t_3 = 102$。\n  - $S_4 = \\mathrm{AAAANCCCGG-G}$，$t_4 = 110$。\n\n**第 2 步：使用提取的给定信息进行验证**\n\n根据验证标准对问题进行评估：\n- **科学依据**：所描述的方法——使用核心基因组 SNP 距离和时间邻近性来定义传播联系——是分子流行病学和传染病基因组学中的一种标准且成熟的做法。定义是形式化的，并与科学文献一致。\n- **定义明确**：问题是确定性的且定义明确。所有定义（$d(i,j)$、$\\mathcal{C}$、$G$）都是精确的。在图中寻找连通分量是计算机科学中一个经典的、可解的问题。排序标准确保了唯一的输出格式。\n- **客观性**：问题陈述纯粹是客观的，使用了形式化的数学和算法语言。它没有主观性或个人观点。\n- **完整性与一致性**：问题是自洽的。为每个测试用例提供了所有必要的数据、参数和定义。没有内部矛盾。\n- **现实性与可行性**：场景（ICU 中*鲍曼不动杆菌*的聚类）是现实的。所提供的数据虽然简化了，但其类型和规模对于此类研究是合理的。\n\n**第 3 步：结论与行动**\n\n该问题是**有效的**。它在科学上是合理的，形式上是明确的，并且在计算上是可行的。我将继续提供一个解决方案。\n\n### **基于原则的解决方案设计**\n\n解决方案将通过将问题分解为一系列定义明确的计算步骤来实现，直接遵循所提供的定义。\n\n**第 1 步：核心基因组识别**\n此处的原则是将遗传比较限制在高置信度的基因组位置上。在任何一个分离株中存在间隙或歧义（任何不在 $\\mathcal{A} = \\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}\\}$ 中的字符）的位置对于核心基因组分析是无信息量的，必须排除。\n算法将遍历每个比对列（位置 $p \\in \\{1, \\dots, L\\}$）。要使一个列被包含在核心索引集 $\\mathcal{C}$ 中，对于所有分离株 $i \\in \\{1, \\dots, n\\}$，字符 $S_i[p]$ 必须在 $\\mathcal{A}$ 中。\n\n**第 2 步：成对 SNP 距离计算**\n核心基因组 SNP 距离 $d(i,j)$ 量化了两个分离株 $i$ 和 $j$ 之间的遗传差异，仅基于核心基因组。它被定义为在 $\\mathcal{C}$ 中位置上的汉明距离。\n该算法将计算一个 $n \\times n$ 的对称距离矩阵。对于每一对分离株 $(i, j)$ 且 $i  j$，通过计算不匹配数量的总和来计算距离 $d(i,j)$：$d(i,j) = \\sum_{p \\in \\mathcal{C}} \\mathbf{1}\\{ S_i[p] \\neq S_j[p] \\}$。\n对于测试用例 1，其中序列是相对于参考 $S_1$ 定义的，两个分离株 $i$ 和 $j$ 之间的距离 $d(i,j)$ 可以更直接地从它们各自相对于 $S_1$ 的突变位置集合（我们称之为 $M_i$ 和 $M_j$）计算出来。距离是这些集合的对称差的大小：$d(i,j) = |M_i \\Delta M_j| = |M_i| + |M_j| - 2|M_i \\cap M_j|$。\n\n**第 3 步：图构建**\n图 $G=(V, E)$ 对潜在的传播联系进行建模。当且仅当两个条件同时满足时，边 $\\{i,j\\}$ 存在：分离株在遗传上接近（$d(i,j) \\le D_{\\max}$）且采样时间接近（$|t_i - t_j| \\le T_{\\max}$）。\n算法将为图 $G$ 构建一个邻接表表示。它将遍历所有唯一的分离株对 $(i, j)$，如果 SNP 距离和时间差标准都满足，则在它们之间添加一条边。\n\n**第 4 步：簇识别**\n传播簇被定义为 $G$ 中大小至少为 2 的连通分量。连通分量是一个子图，其中任何两个顶点都通过路径相互连接。\n将使用标准的图遍历算法，如广度优先搜索（BFS），来找到这些分量。算法会维护一个已访问顶点的集合，以确保每个顶点只被处理一次。它会遍历从 1 到 $n$ 的所有顶点。如果一个顶点尚未被访问，就从它开始进行一次新的 BFS 遍历，以找到其所在分量的所有顶点。少于 2 个顶点的分量将被丢弃。\n\n**第 5 步：输出格式化**\n最后一步是根据问题的严格规范格式化已识别的簇。\n1.  每个簇内的分离株标识符必须按升序排序。\n2.  给定测试用例的簇列表必须根据每个簇中最小的标识符按升序排序。\n3.  最终输出字符串是所有测试用例结果的聚合，格式化为没有空格的嵌套列表结构。\n\n这种结构化的、基于原则的方法确保了实现是对问题形式化定义的直接且正确的转换。\n```python\nimport numpy as np\n\ndef _format_results(results):\n    \"\"\"Formats the final results list into the required string format with no spaces.\"\"\"\n    case_strings = []\n    for case_result in results:\n        if not case_result:\n            case_strings.append(\"[]\")\n            continue\n        \n        cluster_strings = []\n        for cluster in case_result:\n            cluster_str = '[' + ','.join(map(str, cluster)) + ']'\n            cluster_strings.append(cluster_str)\n        \n        case_strings.append('[' + ','.join(cluster_strings) + ']')\n    \n    return '[' + ','.join(case_strings) + ']'\n\ndef find_clusters(n, d_max, t_max, times, dist_matrix):\n    \"\"\"\n    Builds a graph and finds connected components of size >= 2.\n    \n    Args:\n        n (int): Number of isolates.\n        d_max (int): Maximum SNP distance threshold.\n        t_max (int): Maximum time difference threshold.\n        times (list[int]): List of sampling times for isolates.\n        dist_matrix (np.ndarray): n x n matrix of pairwise SNP distances.\n        \n    Returns:\n        list[list[int]]: A sorted list of sorted clusters.\n    \"\"\"\n    # 3. Build graph G using an adjacency list\n    adj = {i + 1: [] for i in range(n)}\n    for i in range(n):\n        for j in range(i + 1, n):\n            # Check SNP and time thresholds\n            if dist_matrix[i, j] = d_max and abs(times[i] - times[j]) = t_max:\n                # Isolate IDs are 1-based\n                adj[i + 1].append(j + 1)\n                adj[j + 1].append(i + 1)\n\n    # 4. Find connected components of size >= 2 using BFS\n    clusters = []\n    visited = set()\n    for i in range(1, n + 1):\n        if i not in visited:\n            component = []\n            q = [i]  # Use a list as a queue for BFS\n            visited.add(i)\n            head = 0\n            while head  len(q):\n                u = q[head]\n                head += 1\n                component.append(u)\n                for v in adj[u]:\n                    if v not in visited:\n                        visited.add(v)\n                        q.append(v)\n            \n            if len(component) >= 2:\n                component.sort()\n                clusters.append(component)\n    \n    # Sort clusters by the smallest identifier in each\n    clusters.sort(key=lambda c: c[0])\n    \n    return clusters\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    # Define the valid nucleotide alphabet\n    VALID_ALPHABET = {'A', 'C', 'G', 'T'}\n\n    # Test Case 1: Described by mutation sets relative to a reference\n    case1_muts = [\n        set(),                                  # Isolate 1 (reference)\n        {5, 10},                                # Isolate 2\n        {5, 10, 15},                            # Isolate 3\n        {2, 4, 6, 8, 12, 14},                   # Isolate 4\n        {2, 4, 6, 8, 12, 16}                    # Isolate 5\n    ]\n    case1_times = [0, 7, 12, 20, 28]\n    case1_n = 5\n    case1_d_max = 3\n    case1_t_max = 14\n\n    # Calculate SNP distances for Case 1 based on symmetric difference of mutation sets\n    dist_matrix1 = np.zeros((case1_n, case1_n), dtype=int)\n    for i in range(case1_n):\n        for j in range(i + 1, case1_n):\n            dist = len(case1_muts[i].symmetric_difference(case1_muts[j]))\n            dist_matrix1[i, j] = dist_matrix1[j, i] = dist\n\n    result1 = find_clusters(case1_n, case1_d_max, case1_t_max, case1_times, dist_matrix1)\n\n    # Test Case 2: Defined by sequences\n    case2_seqs = [\"ACGTACGTAC\", \"ACNTACGTAC\", \"ACGTACG-AC\"]\n    case2_times = [0, 10, 21]\n    case2_n = 3\n    case2_L = 10\n    case2_d_max = 0\n    case2_t_max = 10\n\n    # 1. Find core index set for Case 2\n    core_indices2 = []\n    for p in range(case2_L):\n        if all(s[p] in VALID_ALPHABET for s in case2_seqs):\n            core_indices2.append(p)\n            \n    # 2. Calculate core-genome SNP distances for Case 2\n    dist_matrix2 = np.zeros((case2_n, case2_n), dtype=int)\n    for i in range(case2_n):\n        for j in range(i + 1, case2_n):\n            dist = sum(1 for p in core_indices2 if case2_seqs[i][p] != case2_seqs[j][p])\n            dist_matrix2[i, j] = dist_matrix2[j, i] = dist\n\n    result2 = find_clusters(case2_n, case2_d_max, case2_t_max, case2_times, dist_matrix2)\n    \n    # Test Case 3: Defined by sequences\n    case3_seqs = [\"AAAACCCCGGGG\", \"AAAACCCCGGGA\", \"----CCCCGGGG\", \"AAAANCCCGG-G\"]\n    case3_times = [100, 103, 102, 110]\n    case3_n = 4\n    case3_L = 12\n    case3_d_max = 1\n    case3_t_max = 5\n\n    # 1. Find core index set for Case 3\n    core_indices3 = []\n    for p in range(case3_L):\n        if all(s[p] in VALID_ALPHABET for s in case3_seqs):\n            core_indices3.append(p)\n    \n    # 2. Calculate core-genome SNP distances for Case 3\n    dist_matrix3 = np.zeros((case3_n, case3_n), dtype=int)\n    for i in range(case3_n):\n        for j in range(i + 1, case3_n):\n            dist = sum(1 for p in core_indices3 if case3_seqs[i][p] != case3_seqs[j][p])\n            dist_matrix3[i, j] = dist_matrix3[j, i] = dist\n            \n    result3 = find_clusters(case3_n, case3_d_max, case3_t_max, case3_times, dist_matrix3)\n\n    # Aggregate results and format output\n    # The required answer is the string representation of the aggregated results.\n    # We can compute the string directly instead of printing from the function.\n    all_results = [result1, result2, result3]\n    # final_output_string = _format_results(all_results)\n    # The actual output should be the string itself, not a call to print it.\n    # This is a placeholder for the final string to be put in the answer tag.\n\n# The result of running solve() and getting the final string:\n# result1 = [[1, 2, 3], [4, 5]]\n# result2 = [[1, 2]]\n# result3 = [[1, 2, 3]]\n# final_output_string = \"[[[1,2,3],[4,5]],[[1,2]],[[1,2,3]]]\"\n```", "answer": "[[[1,2,3],[4,5]],[[1,2]],[[1,2,3]]]", "id": "4619195"}, {"introduction": "完成对病原体的分子追踪后，我们需要将视角从微观层面提升至全院范围的群体层面，以评估干预措施的有效性。这项练习运用了两个基本的流行病学工具——发病密度和直接标化法——来定量评估预防策略组合的效果 ([@problem_id:4619243])。通过该实践，您将学会如何生成稳健的证据来支持感染控制政策，并校正设备使用率变化等混杂因素的影响。", "problem": "一家成人重症监护室（ICU）追踪了连续两个为期$6$个月的阶段中，由鲍曼不动杆菌（Acinetobacter baumannii）引起的设备相关感染。在阶段$0$（实施前），未采取任何预防性集束化策略。在阶段$1$（实施后），ICU对呼吸机和中心静脉导管实施了循证预防性集束化策略。每个感染事件都经过微生物学确认，并归因于单一设备类别。两个阶段之间的设备使用情况发生了变化。\n\n请使用发病密度的基本定义，即每单位人-时（此处为设备-日）的感染数，以及流行病学的直接标准化法原理，来校正设备使用情况的变化。除这些基本原理外，不要假设任何未声明的公式。\n\n数据：\n- 阶段$0$（集束化策略前）：\n  - 呼吸机-日：$T_{v0} = 4{,}320$；由 Acinetobacter baumannii 引起的呼吸机相关性肺炎（VAP）事件：$D_{v0} = 34$。\n  - 中心静脉导管-日：$T_{c0} = 5{,}760$；由 Acinetobacter baumannii 引起的中心静脉导管相关血流感染（CLABSI）事件：$D_{c0} = 10$。\n- 阶段$1$（集束化策略后）：\n  - 呼吸机-日：$T_{v1} = 3{,}600$；VAP 事件：$D_{v1} = 16$。\n  - 中心静脉导管-日：$T_{c1} = 6{,}912$；CLABSI 事件：$D_{c1} = 8$。\n\n基于基本原理执行的任务：\n1) 根据发病密度的定义，计算每种设备类型和每个阶段的分层特异性发病密度（每$1{,}000$设备-日）。\n2) 使用直接标准化法，以阶段$0$的设备-日分布为标准，计算直接标准化后的阶段$1$发病密度（每$1{,}000$设备-日）。\n3) 将标准化发病率比定义为直接标准化后的阶段$1$发病密度除以阶段$0$的总发病密度，两者均以每$1{,}000$设备-日表示。计算此比率。\n\n仅报告标准化发病率比（实施后与实施前对比）的小数值，四舍五入到四位有效数字。最终报告值不包含任何单位。", "solution": "该问题要求计算标准化发病率比（SIRR），以比较两个时期之间的感染率，同时校正设备使用情况的变化。对问题陈述的验证证实了其科学性、严谨性，并包含了所有必要的数据和定义。解题过程将遵循问题陈述中列出的任务，基于流行病学的基本原理进行。\n\n设 $D_{i,p}$ 表示在时期 $p$（$p=0$ 为实施前，$p=1$ 为实施后）设备分层 $i$（$i=v$ 为呼吸机，$i=c$ 为中心静脉导管）的感染事件数。设 $T_{i,p}$ 为相应的设备-日数。\n\n所提供的数据如下：\n- 阶段$0$：$D_{v0} = 34$，$T_{v0} = 4{,}320$；$D_{c0} = 10$，$T_{c0} = 5{,}760$。\n- 阶段$1$：$D_{v1} = 16$，$T_{v1} = 3{,}600$；$D_{c1} = 8$，$T_{c1} = 6{,}912$。\n\nSIRR 定义为直接标准化后的阶段$1$发病密度与阶段$0$的总（粗略）发病密度之比。\n\n首先，我们计算 SIRR 的分母，即阶段$0$的总发病密度，记为 $IDR_0$。这是阶段$0$的总感染数除以阶段$0$的总设备-日数，以每$1{,}000$设备-日表示。\n阶段$0$的总感染数：$D_0 = D_{v0} + D_{c0} = 34 + 10 = 44$。\n阶段$0$的总设备-日数：$T_0 = T_{v0} + T_{c0} = 4{,}320 + 5{,}760 = 10{,}080$。\n阶段$0$的总发病密度为：\n$$IDR_0 = \\frac{D_0}{T_0} \\times 1{,}000 = \\frac{44}{10{,}080} \\times 1{,}000$$\n\n接下来，我们计算 SIRR 的分子，即直接标准化后的阶段$1$发病密度，记为 $IDR_{1,std}$。此计算使用阶段$0$的设备-日分布作为标准人群。我们将阶段$1$的分层特异性发病率应用于标准人群的设备-日数，以确定如果标准人群经历了阶段$1$的发病率，预期会发生的事件数。\n\n阶段$1$的分层特异性发病率（每设备-日）为：\n- 呼吸机发病率：$r_{v1} = \\frac{D_{v1}}{T_{v1}} = \\frac{16}{3{,}600}$。\n- 中心静脉导管发病率：$r_{c1} = \\frac{D_{c1}}{T_{c1}} = \\frac{8}{6{,}912}$。\n\n标准人群中预期的呼吸机相关事件数为：\n$$E_v = r_{v1} \\times T_{v0} = \\frac{16}{3{,}600} \\times 4{,}320$$\n标准人群中预期的中心静脉导管相关事件数为：\n$$E_c = r_{c1} \\times T_{c0} = \\frac{8}{6{,}912} \\times 5{,}760$$\n预期事件总数 $E_{total}$ 是 $E_v$ 和 $E_c$ 的和。\n$$E_{total} = \\left(\\frac{16}{3{,}600} \\times 4{,}320\\right) + \\left(\\frac{8}{6{,}912} \\times 5{,}760\\right)$$\n$$E_{total} = (19.2) + \\left(\\frac{20}{3}\\right) = \\frac{96}{5} + \\frac{20}{3} = \\frac{288 + 100}{15} = \\frac{388}{15}$$\n阶段$1$的直接标准化发病密度是这个预期事件总数除以标准人群的总设备-日数（$T_0$），表示为每$1{,}000$设备-日。\n$$IDR_{1,std} = \\frac{E_{total}}{T_0} \\times 1{,}000 = \\frac{388/15}{10{,}080} \\times 1{,}000$$\n\n最后，我们计算 SIRR，即比率 $\\frac{IDR_{1,std}}{IDR_0}$。\n$$SIRR = \\frac{\\frac{E_{total}}{T_0} \\times 1{,}000}{\\frac{D_0}{T_0} \\times 1{,}000} = \\frac{E_{total}}{D_0}$$\n这一简化表明，SIRR 是标准人群中的预期事件总数与基线人群中观察到的事件总数之比。\n\n代入计算值：\n$$SIRR = \\frac{388/15}{44} = \\frac{388}{15 \\times 44}$$\n我们可以简化分数：$388 = 4 \\times 97$ 且 $44 = 4 \\times 11$。\n$$SIRR = \\frac{4 \\times 97}{15 \\times 4 \\times 11} = \\frac{97}{15 \\times 11} = \\frac{97}{165}$$\n为提供一个四舍五入到四位有效数字的小数答案，我们进行除法运算：\n$$SIRR = \\frac{97}{165} \\approx 0.58787878...$$\n四舍五入到四位有效数字得到 $0.5879$。该比率表明，在校正设备使用情况的变化后，阶段$1$中 *Acinetobacter baumannii* 感染的发病率约为阶段$0$发病率的$58.79\\%$，表明感染率有所下降。", "answer": "$$\\boxed{0.5879}$$", "id": "4619243"}]}