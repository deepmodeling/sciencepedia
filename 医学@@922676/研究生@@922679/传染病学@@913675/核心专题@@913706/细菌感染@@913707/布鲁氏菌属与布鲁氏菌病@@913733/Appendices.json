{"hands_on_practices": [{"introduction": "血清学检测是布鲁氏菌病诊断的基石，但其可靠性常受到与其他细菌抗原交叉反应的挑战。这种交叉反应的分子基础通常是不同细菌间共享的抗原表位，例如在布鲁氏菌的光滑型脂多糖（LPS）O-抗原上发现的表位。本实践练习将引导您运用免疫化学的基本原理，特别是解离常数（$K_D$）的概念，来定量预测并设计策略以缓解这一常见的诊断难题 [@problem_id:4631916]。", "problem": "一家位于布鲁氏菌病流行区的临床实验室，使用带有光滑型流产布鲁氏菌 (Brucella abortus) 抗原的标准板凝集试验来筛查血清中的抗布鲁氏菌抗体。该试验依赖于多价抗原-抗体晶格的形成，这需要足够的抗体与光滑型布鲁氏菌脂多糖 (LPS) O-抗原上的重复性表位结合。根据抗原-抗体相互作用的基本原理，当对共享表位的特异性结合达到能够促成一个交联晶格形成的水平时，就会发生凝集。当不同的光滑型革兰氏阴性菌呈现出化学上和构象上相似的O-抗原表位时，预计会发生交叉反应。\n\n人群中的血清显示出针对光滑型布鲁氏菌LPS的免疫球蛋白G (IgG) 和免疫球蛋白M (IgM)。该实验室在凝集试验缓冲液条件下，独立测量了主要血清抗体与来自多种光滑型革兰氏阴性菌的纯化O-抗原多糖结合的表观平衡解离常数 ($K_D$)。对于流产布鲁氏菌 (Brucella abortus) 光滑型LPS O-抗原，$K_D$ 为 $1.0 \\times 10^{-9}$ $\\mathrm{M}$。对于O:9血清型的小肠结肠炎耶尔森菌 (Yersinia enterocolitica)，$K_D$ 为 $2.0 \\times 10^{-9}$ $\\mathrm{M}$。对于大肠杆菌 (Escherichia coli) O157，$K_D$ 为 $1.0 \\times 10^{-7}$ $\\mathrm{M}$。对于其他测试的光滑型革兰氏阴性菌，测得的 $K_D$ 值大于 $1.0 \\times 10^{-5}$ $\\mathrm{M}$。\n\n一份代表性血清中，针对布鲁氏菌光滑型LPS表位的IgG浓度 $[\\mathrm{IgG}] = 5.0 \\times 10^{-8}$ $\\mathrm{M}$，IgM浓度 $[\\mathrm{IgM}] = 1.0 \\times 10^{-8}$ $\\mathrm{M}$。所有测试的抗原都是高度多价的，具有长O-抗原链。假设凝集阈值需要特异性抗体对抗原上的重复表位有大量的分数占据率，足以形成晶格，并且平衡时的占据率由质量作用定律决定。\n\n哪个选项最准确地预测了在哪种光滑型革兰氏阴性菌中，由于共享O-抗原表位，在这些试验条件下最可能发生交叉凝集，并提出了在保持布鲁氏菌病诊断灵敏度的同时减少假阳性凝集的最科学合理的缓解策略？\n\nA. 小肠结肠炎耶尔森菌 (Yersinia enterocolitica) O:9 会发生强烈交叉凝集；缓解方法是用耶尔森菌O:9 LPS预吸收血清以去除交叉反应性抗体，并使用布鲁氏菌特异性蛋白抗原（例如，布鲁氏菌周质26千道尔顿蛋白，BP26）而非基于LPS的凝集试验来确认血清阳性。\n\nB. 铜绿假单胞菌 (Pseudomonas aeruginosa) 会因保守的脂质A而发生强烈交叉凝集；缓解方法是在反应中加入多粘菌素B以中和脂质A，从而防止交叉反应。\n\nC. 大肠杆菌 (Escherichia coli) O157 的交叉凝集程度将与布鲁氏菌相当；缓解方法是增加离子强度（例如，增加到 $0.5$ $\\mathrm{M}$ $\\mathrm{NaCl}$）以抑制非特异性相互作用。\n\nD. 肠炎沙门氏菌 (Salmonella enterica serovar Enteritidis) 会因保守的LPS核心而发生强烈交叉凝集；缓解方法是煮沸抗原以使其碳水化合物表位变性，从而降低交叉反应性。", "solution": "用户提供了一个诊断免疫学和微生物学领域的问题，需要基于抗原-抗体结合亲和力原理及其在血清学试验中的应用进行分析。\n\n### 第一步：提取已知条件\n\n以下是所有提供的数据、条件和定义的原样列表：\n- **试验类型**：标准板凝集试验。\n- **试验抗原**：光滑型流产布鲁氏菌 (Brucella abortus) 抗原。\n- **凝集机制**：基于与脂多糖 (LPS) O-抗原上重复性表位结合的多价抗原-抗体晶格形成。\n- **交叉反应条件**：当不同的光滑型革兰氏阴性菌呈现出化学上和构象上相似的O-抗原表位时发生。\n- **血清中的抗体**：免疫球蛋白G (IgG) 和免疫球蛋白M (IgM)。\n- **抗体与O-抗原结合的平衡解离常数 ($K_D$)**：\n    - *Brucella abortus*：$K_D = 1.0 \\times 10^{-9} \\mathrm{M}$。\n    - *Yersinia enterocolitica* O:9血清型：$K_D = 2.0 \\times 10^{-9} \\mathrm{M}$。\n    - *Escherichia coli* O157：$K_D = 1.0 \\times 10^{-7} \\mathrm{M}$。\n    - 其他测试的光滑型革兰氏阴性菌：$K_D  1.0 \\times 10^{-5} \\mathrm{M}$。\n- **代表性血清抗体浓度**：\n    - $[\\mathrm{IgG}] = 5.0 \\times 10^{-8} \\mathrm{M}$。\n    - $[\\mathrm{IgM}] = 1.0 \\times 10^{-8} \\mathrm{M}$。\n- **假设**：\n    1. 凝集需要表位有大量的分数占据率。\n    2. 平衡时的占据率由质量作用定律决定。\n    3. 所有测试的抗原都是高度多价的。\n- **问题**：确定最可能发生交叉凝集的光滑型革兰氏阴性菌，并找出科学上最合理的缓解策略。\n\n### 第二步：使用提取的已知条件进行验证\n\n现在将根据指定的标准对问题陈述进行验证。\n\n- **科学依据**：问题牢固地建立在免疫学和生物物理化学的基本原理之上。使用质量作用定律描述抗体-抗原结合、使用解离常数 ($K_D$) 作为亲和力的量度，以及凝集机制都是标准概念。关于布鲁氏菌属 (Brucella spp.) 和O:9型小肠结肠炎耶尔森菌 (Yersinia enterocolitica) 因其结构相同的O-多糖链而产生血清学交叉反应性的具体例子，是临床微生物学中一个经典且有据可查的现象。给出的 $K_D$ 值对于此类相互作用是合理的，抗体浓度也在特异性免疫应答的实际生理范围内。提议的缓解策略（预吸收、使用特异性蛋白抗原）是已确立的实验室技术。该问题在科学上是合理的。\n- **定义明确**：问题定义明确。它提供了所有必要的定量数据（以 $K_D$ 值表示的亲和力，抗体浓度）来评估不同抗原的结合程度。问题具体，要求根据这些数据预测最可能的交叉反应并评估缓解策略。可以得出一个唯一且有意义的结论。\n- **客观性**：问题以精确、客观和技术性的语言陈述。它依赖于定量数据和已确立的科学原理，没有主观或模糊的术语。\n\n问题陈述没有表现出验证清单中列出的任何缺陷（例如，科学上不合理、不完整、矛盾等）。\n\n### 第三步：结论与行动\n\n问题陈述是有效的。现在开始解题过程。\n\n### 从第一性原理推导\n\n凝集的可能性与抗体结合到多价抗原的程度直接相关。这种结合由相互作用的亲和力（由平衡解离常数 $K_D$ 量化）和反应物的浓度决定。较小的 $K_D$ 值表示较高的亲和力（更强的结合）。\n\n平衡时抗原表位的分数占据率 $\\theta$ 由质量作用定律推导出的方程给出：\n$$ \\theta = \\frac{[\\text{Ab}]}{[\\text{Ab}] + K_D} $$\n其中 $[\\text{Ab}]$ 是游离抗体的浓度。问题提供了两种同种型抗体IgG和IgM的浓度，它们都可以参与凝集。能够结合LPS表位的抗体总浓度是各自浓度的总和：\n$$ [\\text{Ab}]_{\\text{total}} = [\\mathrm{IgG}] + [\\mathrm{IgM}] = 5.0 \\times 10^{-8} \\mathrm{M} + 1.0 \\times 10^{-8} \\mathrm{M} = 6.0 \\times 10^{-8} \\mathrm{M} $$\n对于此分析，我们可以用总抗体浓度 $[\\text{Ab}]_{\\text{total}}$ 来近似游离抗体浓度 $[\\text{Ab}]$，当抗体浓度没有因结合而显著消耗时，或者用于在相同抗体浓度下比较相对结合倾向时，这是一个有效的简化。凝集需要“大量”的分数占据率。我们现在将计算所给出的每种情况的 $\\theta$。\n\n1.  **同源抗原：*Brucella abortus***\n    - $K_D = 1.0 \\times 10^{-9} \\mathrm{M}$\n    - $\\theta_{Brucella} = \\frac{6.0 \\times 10^{-8} \\mathrm{M}}{6.0 \\times 10^{-8} \\mathrm{M} + 1.0 \\times 10^{-9} \\mathrm{M}} = \\frac{60 \\times 10^{-9}}{60 \\times 10^{-9} + 1 \\times 10^{-9}} = \\frac{60}{61} \\approx 0.984$\n    这种高的分数占据率（98.4%）无疑会导致强烈的凝集，正如预期的那样。\n\n2.  **潜在交叉反应物：*Yersinia enterocolitica* O:9**\n    - $K_D = 2.0 \\times 10^{-9} \\mathrm{M}$\n    - $\\theta_{Yersinia} = \\frac{6.0 \\times 10^{-8} \\mathrm{M}}{6.0 \\times 10^{-8} \\mathrm{M} + 2.0 \\times 10^{-9} \\mathrm{M}} = \\frac{60 \\times 10^{-9}}{60 \\times 10^{-9} + 2 \\times 10^{-9}} = \\frac{60}{62} \\approx 0.968$\n    这个分数占据率（96.8%）非常高，并且与同源抗原的占据率非常接近。这预示着会发生强烈的交叉凝集反应。\n\n3.  **潜在交叉反应物：*Escherichia coli* O157**\n    - $K_D = 1.0 \\times 10^{-7} \\mathrm{M}$\n    - $\\theta_{E.coli} = \\frac{6.0 \\times 10^{-8} \\mathrm{M}}{6.0 \\times 10^{-8} \\mathrm{M} + 1.0 \\times 10^{-7} \\mathrm{M}} = \\frac{6.0 \\times 10^{-8}}{0.6 \\times 10^{-7} + 1.0 \\times 10^{-7}} = \\frac{0.6}{1.6} = 0.375$\n    37.5%的分数占据率虽然可观，但显著低于*Brucella*和*Yersinia*。可能会发生凝集，但会弱得多，与*Brucella*不可“相提并论”。\n\n4.  **其他光滑型革兰氏阴性菌**\n    - $K_D  1.0 \\times 10^{-5} \\mathrm{M}$\n    - $\\theta_{\\text{Other}} \\le \\frac{6.0 \\times 10^{-8} \\mathrm{M}}{6.0 \\times 10^{-8} \\mathrm{M} + 1.0 \\times 10^{-5} \\mathrm{M}} \\approx \\frac{6.0 \\times 10^{-8}}{1.0 \\times 10^{-5}} = 0.006$\n    分数占据率低于0.6%，这是微不足道的，极不可能引起凝集。\n\n基于此分析，*Yersinia enterocolitica* O:9 是所列细菌中唯一会引起与同源反应相当的强烈交叉凝集反应的细菌。\n\n对于缓解策略，目标是消除由这种交叉反应性引起的假阳性，同时保留真阳性（灵敏度）。交叉反应性源于抗体与共享的O-抗原结构结合。两种合乎逻辑的方法是：\n1.  **移除交叉反应性抗体**：这可以通过将患者血清与过量的交叉反应抗原（例如，*Y. enterocolitica* O:9 细胞或纯化的LPS）预孵育来实现。交叉反应性抗体将与该抗原结合并可被移除，仅留下对*Brucella*特有表位具有特异性的抗体，用于后续对*Brucella*抗原的检测。这被称为吸收。\n2.  **改变诊断靶点**：使用*Brucella*特有且不与*Yersinia*共享的抗原。蛋白抗原在不同细菌属之间遗传上是不同的，因此是极好的候选者。*Brucella*周质蛋白BP26（也称为Omp28）是一种已知的特异性抗原，用于布鲁氏菌病诊断的ELISA检测中，这完全避免了LPS交叉反应性问题。\n\n### 逐项分析选项\n\n**A. 小肠结肠炎耶尔森菌 (Yersinia enterocolitica) O:9 会发生强烈交叉凝集；缓解方法是用耶尔森菌O:9 LPS预吸收血清以去除交叉反应性抗体，并使用布鲁氏菌特异性蛋白抗原（例如，布鲁氏菌周质26千道尔顿蛋白，BP26）而非基于LPS的凝集试验来确认血清阳性。**\n- **预测**：关于*Y. enterocolitica* O:9会发生强烈交叉凝集的预测，得到了我们计算的直接支持。其 $K_D$ 仅为同源抗原的两倍，导致分数占据率约为97%。\n- **缓解**：提议的两种策略——用*Yersinia*抗原进行预吸收，以及使用像BP26这样的特异性蛋白抗原进行确认——都是解决这一特定诊断挑战的标准、科学合理且高效的方法。它们直接解决了交叉反应性的根本原因。\n- **结论**：**正确**。\n\n**B. 铜绿假单胞菌 (Pseudomonas aeruginosa) 会因保守的脂质A而发生强烈交叉凝集；缓解方法是在反应中加入多粘菌素B以中和脂质A，从而防止交叉反应。**\n- **预测**：*P. aeruginosa* 属于“其他...细菌”类别，其 $K_D  1.0 \\times 10^{-5} \\mathrm{M}$。如计算所示，这导致可忽略的结合（$\\theta \\le 0.006$），不可能发生强烈凝集。这个前提是错误的。此外，问题指明O-抗原是交叉反应性的基础，而不是保守的脂质A部分。\n- **缓解**：虽然多粘菌素B确实能结合脂质A，但该策略是无关的，因为所描述的特异性抗体介导的凝集是由于O-抗原结合。这不会阻止O-抗原特异性抗体与其表位结合。\n- **结论**：**错误**。\n\n**C. 大肠杆菌 (Escherichia coli) O157 的交叉凝集程度将与布鲁氏菌相当；缓解方法是增加离子强度（例如，增加到 $0.5$ $\\mathrm{M}$ $\\mathrm{NaCl}$）以抑制非特异性相互作用。**\n- **预测**：关于*E. coli* O157的交叉凝集程度“与布鲁氏菌相当”的说法在数量上是错误的。其结合亲和力弱了100倍（$K_D = 1.0 \\times 10^{-7} \\mathrm{M}$ 对比 $1.0 \\times 10^{-9} \\mathrm{M}$），导致的分数占据率要低得多（$\\theta \\approx 0.375$ 对比 $\\theta \\approx 0.984$）。\n- **缓解**：所描述的相互作用是特异性的交叉反应性结合，而不是“非特异性相互作用”。虽然高离子强度可以降低某些抗体-抗原相互作用的亲和力，但这是一种非特异性干预，很可能也会降低检测真正*Brucella*抗体的灵敏度。它不是最科学合理或最有针对性的方法。\n- **结论**：**错误**。\n\n**D. 肠炎沙门氏菌 (Salmonella enterica serovar Enteritidis) 会因保守的LPS核心而发生强烈交叉凝集；缓解方法是煮沸抗原以使其碳水化合物表位变性，从而降低交叉反应性。**\n- **预测**：*S. enterica* 属于“其他...细菌”类别，其 $K_D  1.0 \\times 10^{-5} \\mathrm{M}$，排除了强烈凝集的可能性。“因保守的LPS核心”这一理由也与问题陈述不一致，问题侧重于O-抗原的相似性。\n- **缓解**：该策略存在缺陷。像LPS这样的碳水化合物通常是热稳定的，不会像蛋白质那样“变性”。煮沸是正是因为这种热稳定性而常用于从细菌中提取LPS的方法。该策略不会消除导致相互作用的碳水化合物表位。\n- **结论**：**错误**。", "answer": "$$\\boxed{A}$$", "id": "4631916"}, {"introduction": "在诊断出疾病之后，追溯疫情的源头对于公共卫生控制至关重要。全基因组测序（WGS）已成为现代分子流行病学中用于病原体溯源的强大工具。通过比较分离株之间的单核苷酸多态性（SNP）差异，并结合对病原体突变率的了解，我们可以重建传播链。本练习将让您置身于一个真实的溯源场景中，通过整合基因组数据与流行病学信息，磨练您将人类病例与特定传染源联系起来的分析能力 [@problem_id:4631943]。", "problem": "在一个流产布鲁氏菌 (Brucella abortus) 的地方性流行区域，一个涉及骨关节的聚集性发热病例正在接受调查。对流产布鲁氏菌分离株进行全基因组测序（WGS），以进行溯源。对三个人类病例分离株（$H_1$、$H_2$、$H_3$）、来自Alpha奶牛场的两个分离株（$F_{A1}$、$F_{A2}$）以及来自Beta奶牛场的一个分离株（$F_{B1}$）进行了测序。调查得出了以下经过科学审查的事实和测量数据：\n\n- 流产布鲁氏菌是一种进化缓慢的胞内细菌。假设点突变（单核苷酸多态性，SNPs）的累积近似于一个泊松过程，其每年每个位点的恒定速率为 $\\mu$，核心基因组长度为 $G$ 个碱基对。该地区的监测研究支持 $\\mu \\approx 2\\times 10^{-7}$ 替换/位点/年 和 $G \\approx 3.3\\times 10^{6}$ 个碱基对。该地区流行病学上不相关的分离株之间的典型核心基因组SNP距离超过 $50$ 个SNP。\n- 测序质量控制显示平均覆盖度 $50\\times$，估计的碱基识别错误对每个基因组造成的假阳性SNP贡献 $0.1$ 个。在相同环境下，通过对单头牛和单个患者进行数周的重复采样评估，核心基因组内的宿主内多样性为 $0$–$2$ 个SNP。\n- 采样时间线：$F_{A1}$ 和 $F_{A2}$ 在五月初采集（将此日期定义为 $t_0$）。人类分离株的采集时间如下：$H_1$ 在 $t_0 + 1$ 个月，$H_2$ 在 $t_0 + 2$ 个月，$H_3$ 在 $t_0 + 5$ 个月。$F_{B1}$ 在四月下旬采集（即大约在 $t_0 - 0.25$ 个月，在所需精度的突变累积计算中，您可以将其近似为 $t_0$）。\n- 观察到的成对核心基因组SNP距离（用 $d(X,Y)$ 表示）如下：\n  - $d(F_{A1},F_{A2}) = 1$。\n  - $d(H_1,F_{A1}) = 0$，$d(H_2,F_{A1}) = 1$，$d(H_3,F_{A1}) = 9$。\n  - $d(H_1,F_{B1}) = 8$，$d(H_2,F_{B1}) = 7$，$d(H_3,F_{B1}) = 1$。\n  - $d(H_1,H_2) = 1$，$d(H_1,H_3) = 9$，$d(H_2,H_3) = 8$。\n\n使用基于突变累积和群体遗传学推理的原则性方法，选择科学上最站得住脚的溯源陈述：\n\nA. 所有三个人类病例（$H_1$、$H_2$、$H_3$）最简约地归因于Alpha奶牛场，因为核心基因组SNP距离小于10表示在几个月内发生了近期传播。\n\nB. $H_1$ 和 $H_2$ 与Alpha奶牛场的关联最为一致，而 $H_3$ 更可能与Beta奶牛场有关；SNP距离和采样时间与泊松模型下的预期突变累积以及观察到的牛场内多样性相符。\n\nC. 仅使用WGS无法将任何病例归因于任一牛场；这种量级的SNP距离太小，没有接触者追踪就无法提供信息。\n\nD. 鉴于与 $F_{B1}$ 的SNP距离最小且采样窗口重叠，所有三个人类病例都更符合源自Beta奶牛场。", "solution": "问题陈述是有效的。它在科学上基于分子流行病学原理，问题提出得很好，有充分且一致的数据，并且表述客观。我将从第一性原理出发进行推导。\n\n主要任务是评估人类和牛场 *Brucella abortus* 分离株之间的系统发育关系，以推断人类病例最可能的感染来源。这涉及到整合遗传距离（成对SNP差异）、采样时间线和突变累积模型的信息。\n\n**1. 突变率和预期SNP累积**\n\n问题提供了每个位点的突变率 $\\mu$ 和核心基因组大小 $G$。每年每个基因组累积的SNP预期数量，用 $\\lambda$ 表示，是这两个值的乘积。\n\n已知：\n- 每位点突变率，$\\mu \\approx 2 \\times 10^{-7}$ 替换/位点/年。\n- 核心基因组长度，$G \\approx 3.3 \\times 10^{6}$ 个碱基对。\n\n年SNP累积率 $\\lambda$ 的计算：\n$$ \\lambda = \\mu \\times G = (2 \\times 10^{-7} \\text{ year}^{-1}) \\times (3.3 \\times 10^{6}) = 0.66 \\text{ SNPs/year} $$\n这个速率代表了沿单一传播谱系在一年内累积的突变预期数量。\n\n**2. 基于SNP距离的遗传聚类分析**\n\n我们分析所提供的成对SNP距离 $d(X,Y)$，以识别密切相关的分离株聚类。简约性原则表明，由较少SNP分隔的分离株更可能共享一个近期的共同祖先。\n\n提供的距离如下：\n- $d(F_{A1}, F_{A2}) = 1$\n- $d(H_1, F_{A1}) = 0$\n- $d(H_2, F_{A1}) = 1$\n- $d(H_3, F_{A1}) = 9$\n- $d(H_1, F_{B1}) = 8$\n- $d(H_2, F_{B1}) = 7$\n- $d(H_3, F_{B1}) = 1$\n- $d(H_1, H_2) = 1$\n- $d(H_1, H_3) = 9$\n- $d(H_2, H_3) = 8$\n\n从这些距离中，浮现出两个截然不同的聚类：\n- **Alpha聚类：** $\\{H_1, H_2, F_{A1}, F_{A2}\\}$。该组内的所有成对距离（已提供或可推断的）都非常小（$0$ 或 $1$ 个SNP）。例如，$d(H_1, F_{A1})=0$，$d(H_2, F_{A1})=1$，$d(H_1, H_2)=1$，以及 $d(F_{A1}, F_{A2})=1$。这种模式强烈表明这些分离株有一个非常近期的共同起源。\n- **Beta聚类：** $\\{H_3, F_{B1}\\}$。这两个分离株之间的距离是 $d(H_3, F_{B1}) = 1$，也表明它们关系密切。\n\n这两个聚类*之间*的距离要大得多（$7$、$8$ 和 $9$ 个SNP）。例如，$d(H_1, H_3)=9$ 和 $d(H_2, F_{B1})=7$。这个巨大的遗传差距强烈表明，这两个聚类代表了独立的传播链，它们从一个共同祖先分歧的时间远早于本次暴发本身。给定的基准（不相关的分离株差异超过50个SNP）证实了所有分离株都是区域性暴发的一部分，但7到9个SNP的差距明确地划分出两个亚进化枝。\n\n**3. 时间一致性检验**\n\n我们必须验证观察到的SNP距离是否与采样时间一致，前提是假设存在从牛场到人的直接传播。我们将其建模为祖先-后代演化，其中预期的SNP数量为 $\\lambda \\times \\Delta t$，$\\Delta t$ 是自传播以来经过的时间（以年为单位）。\n\n- **假设：Alpha奶牛场是 $H_1$ 和 $H_2$ 的来源。**\n  - **病例 $H_1$**：在 $t_0 + 1$ 个月采样。$\\Delta t = 1/12$ 年。\n    预期SNP数 = $\\lambda \\times \\Delta t = 0.66 \\times (1/12) \\approx 0.055$。\n    观察到的距离是 $d(H_1, F_{A1}) = 0$。在期望值为 $0.055$ 的情况下观察到 $0$ 个SNP，在泊松模型下是极有可能的（$P(k=0) = e^{-\\lambda \\Delta t}$）。这完全一致。\n  - **病例 $H_2$**：在 $t_0 + 2$ 个月采样。$\\Delta t = 2/12$ 年。\n    预期SNP数 = $\\lambda \\times \\Delta t = 0.66 \\times (2/12) \\approx 0.11$。\n    观察到的距离是 $d(H_2, F_{A1}) = 1$。虽然期望值很低，但观察到1个SNP是合理的。此外，问题陈述中提到宿主内/牛场内多样性为0-2个SNP。这意味着1个SNP的差异可能代表了Alpha奶牛场源种群中预先存在的变异，而不是传播后的新发突变。$d(F_{A1}, F_{A2}) = 1$ 这一事实也加强了这一点。因此，这种关联也是高度一致的。\n\n- **假设：Beta奶牛场是 $H_3$ 的来源。**\n  - **病例 $H_3$**：在 $t_0 + 5$ 个月采样。假设 $F_{B1}$ 在 $t_0$ 采样，$\\Delta t = 5/12$ 年。\n    预期SNP数 = $\\lambda \\times \\Delta t = 0.66 \\times (5/12) \\approx 0.275$。\n    观察到的距离是 $d(H_3, F_{B1}) = 1$。与 $H_2$ 的情况类似，在期望值为 $0.275$ 的情况下观察到1个SNP是合理的，特别是考虑到背景多样性。此关联是一致的。\n\n- **假设：Alpha奶牛场是 $H_3$ 的来源。**\n  - **病例 $H_3$**：在 $t_0 + 5$ 个月采样。$\\Delta t = 5/12$ 年。\n    预期SNP数 $\\approx 0.275$。\n    观察到的距离是 $d(H_3, F_{A1}) = 9$。在预期数量为 $0.275$ 的情况下观察到 $9$ 个突变的概率是无穷小的（$P(k=9) = (\\text{exp}(-0.275) \\times 0.275^9) / 9! \\approx 1.5 \\times 10^{-11}$）。如此大的距离无法用5个月内的进化来解释。它意味着一个更深的分歧时间，大约在年这个数量级上（$T \\approx d / (2\\lambda) = 9 / (2 \\times 0.66) \\approx 6.8$ 年）。这个假设是站不住脚的。\n\n- **假设：Beta奶牛场是 $H_1$ 和 $H_2$ 的来源。**\n  - 同样，由于 $d(H_1, F_{B1}) = 8$ 和 $d(H_2, F_{B1}) = 7$ 的SNP距离很大，这与1-2个月的短时间框架不符，因此该假设也被排除。\n\n**4. 结论与选项评估**\n\n遗传距离和时间数据的综合分析得出了一个明确的结论：存在两个独立的传播聚类。$H_1$ 和 $H_2$ 与Alpha奶牛场相关，而 $H_3$ 与Beta奶牛场相关。\n\n- **A. 所有三个人类病例（$H_1$、$H_2$、$H_3$）最简约地归因于Alpha奶牛场，因为核心基因组SNP距离小于10表示在几个月内发生了近期传播。**\n  - **不正确**。这错误地将 $H_3$ 归因于Alpha奶牛场。考虑到该生物体的缓慢突变率，$d(H_3, F_{A1}) = 9$ 个SNP的距离与5个月内的传播不一致。“距离10”的启发式规则过于简单，并且在这种情况下具有误导性。\n\n- **B. $H_1$ 和 $H_2$ 与Alpha奶牛场的关联最为一致，而 $H_3$ 更可能与Beta奶牛场有关；SNP距离和采样时间与泊松模型下的预期突变累积以及观察到的牛场内多样性相符。**\n  - **正确**。该陈述准确地反映了分析结果。($H_1, H_2$) $\\to$ Alpha奶牛场和 $H_3 \\to$ Beta奶牛场的关联得到了最小SNP距离（分别为0、1和1）的支持。这些小距离与给定时间框架内的突变模型以及背景多样性水平完全相符。\n\n- **C. 仅使用WGS无法将任何病例归因于任一牛场；这种量级的SNP距离太小，没有接触者追踪就无法提供信息。**\n  - **不正确**。这是对数据过于轻视的看法。WGS数据提供了强大、结构化的信号。将分离株清晰地划分为两个聚类，聚类内距离小而聚类间距离大，这对于溯源具有高度的信息价值，即使还需要传统流行病学的确认。\n\n- **D. 所有三个人类病例都更符合源自Beta奶牛场，鉴于与 $F_{B1}$ 的SNP距离最小且采样窗口重叠。**\n  - **不正确**。这错误地将 $H_1$ 和 $H_2$ 归因于Beta奶牛场。$H_1$ 和 $H_2$ 与 $F_{B1}$ 的SNP距离很大（8和7个SNP），使得这种关联极不可能。$H_1$ 和 $H_2$ 的最小SNP距离是与Alpha奶牛场的分离株 $F_{A1}$（0和1个SNP），而不是 $F_{B1}$。", "answer": "$$\\boxed{B}$$", "id": "4631943"}, {"introduction": "超越诊断与流行病学，我们追求更深入地理解发病机制并开发更有效的治疗方法。宿主转录组学为了解细胞对感染的反应提供了一个全面的快照，使我们能够识别与疾病控制或持续感染相关的关键生物学通路。本练习将指导您完成一个典型的生物信息学分析流程，从原始基因表达数据出发，最终识别出潜在的宿主导向治疗靶点，这是现代传染病研究中的一项核心技能 [@problem_id:4631975]。", "problem": "您将获得一个数学定义的工作流程，该工作流程使用宿主转录组测量数据来识别与布鲁氏菌（brucellosis）感染期间的控制与持续相关的通路，并提出宿主导向的靶向治疗方案。您的程序必须基于基本的统计定义和经过充分检验的程序来实现以下内容。\n\n使用的基本原理和定义：\n- 分子生物学中心法则指出，基因表达水平反映了信使核糖核酸（mRNA）的丰度，而mRNA源于脱氧核糖核酸（DNA）的转录和随后的翻译；转录组数据是与宿主防御细胞内病原体（如布鲁氏菌）相关的基因活性的近似值。\n- 对于每个基因，将每种条件下的表达观测值视为独立同分布（i.i.d.）的样本。对于基因$g$，将对照组的样本数定义为$n_c$，持续组的样本数定义为$n_p$，样本均值定义为$\\bar{x}_c$和$\\bar{x}_p$，无偏样本方差定义为$s_c^2$和$s_p^2$。\n- 对每个基因$g$使用Welch不等方差$t$-统计量来检验对照组和持续组均值相等的原假设，并从适当的自由度推导出双边$p$-值。使用标准正态生存函数的反函数，将每个基因的双边$p$-值转换为一个带符号的标准正态离差，并携带$t$-统计量的符号以指示相对于对照组与持续组的方向。\n- 在独立性近似下，使用Stouffer方法将基因水平的带符号离差聚合成通路水平的得分，并从标准正态分布计算通路的双边$p$-值。使用Benjamini–Hochberg程序对所有通路的$p$-值进行调整，以获得作为小数的错误发现率（FDR）$q$-值。\n- 如果一个通路的Stouffer得分为正，则定义其为“对照相关”，如果为负，则为“持续相关”。通过选择统计上最显著的单个持续相关通路（最小的$q$-值；若$q$-值相同，则以更大的负Stouffer得分绝对值来打破平局）并将其映射到治疗代码来推荐靶向治疗。如果在FDR阈值$\\alpha$下没有显著的持续相关通路，则返回代码$0$。\n\n通路的治疗代码映射（程序将输出的整数）：\n- 通路索引$0$：Toll样受体信号通路（对照相关）$\\rightarrow$ 治疗代码$101$。\n- 通路索引$1$：白细胞介素-$10$信号通路（持续相关）$\\rightarrow$ 治疗代码$201$。\n- 通路索引$2$：自噬调节（持续相关）$\\rightarrow$ 治疗代码$202$。\n- 通路索引$3$：通过诱导型一氧化氮合酶产生一氧化氮（对照相关）$\\rightarrow$ 治疗代码$102$。\n- 通路索引$4$：内质网应激和未折叠蛋白反应（持续相关）$\\rightarrow$ 治疗代码$203$。\n\n嵌入在测试套件中的输入规范：\n对于每个测试用例，您将获得：\n- 一个形状为$(G,S)$的基因表达矩阵$X$，包含$G$个基因在$S$个样本中的$\\log_2$转换表达值。\n- 一个长度为$S$的二元标签向量$y$，其中$y_i = 1$表示对照组样本，$y_i = 0$表示持续组样本。\n- 一个通路基因集列表$\\{\\mathcal{P}_j\\}_{j=0}^{M-1}$，每个$\\mathcal{P}_j$是一个基因索引的集合。\n- 一个FDR决策阈值$\\alpha$，以小数形式表示。\n- 从通路索引到治疗代码的映射$T(j)$。\n\n您的程序必须为每个测试用例实现：\n- 计算每个基因的Welch统计量及其双边$p$-值，转换为带符号的标准正态离差，聚合成每个通路的Stouffer得分，计算通路的双边$p$-值，执行Benjamini–Hochberg调整以获得$q$-值，并如上所述选择推荐的治疗代码。\n\n测试套件和参数：\n使用以下四个测试用例，每个用例由明确的数字数组定义。所有数字都是没有物理单位的$\\log_2$-表达值。FDR值必须作为小数处理，而不是百分比。\n\n- 测试用例$1$（具有多个信号的理想路径）：\n    - $G = 8$, $S = 6$。\n    - $X$的行（基因$0$到$7$），列首先按对照组样本排序，然后是持续组样本：\n        - 基因$0$：$[9.1, 8.9, 9.0, 5.1, 5.2, 4.8]$。\n        - 基因$1$：$[8.7, 9.2, 9.0, 5.5, 5.0, 5.3]$。\n        - 基因$2$：$[4.0, 4.1, 4.2, 8.0, 8.2, 7.8]$。\n        - 基因$3$：$[3.9, 4.2, 4.1, 7.9, 8.1, 8.2]$。\n        - 基因$4$：$[7.0, 6.9, 7.1, 6.8, 7.1, 7.0]$。\n        - 基因$5$：$[7.2, 7.1, 7.0, 7.2, 7.1, 7.3]$。\n        - 基因$6$：$[10.0, 9.8, 10.2, 6.0, 6.2, 5.8]$。\n        - 基因$7$：$[5.0, 5.1, 4.9, 9.0, 9.2, 8.8]$。\n    - $y = [1, 1, 1, 0, 0, 0]$。\n    - 通路$\\{\\mathcal{P}_j\\}$：\n        - $j=0$: $\\{0,1\\}$。\n        - $j=1$: $\\{2,3\\}$。\n        - $j=2$: $\\{4,5\\}$。\n        - $j=3$: $\\{6\\}$。\n        - $j=4$: $\\{7\\}$。\n    - $\\alpha = 0.1$。\n    - $T(0)=101$, $T(1)=201$, $T(2)=202$, $T(3)=102$, $T(4)=203$。\n\n- 测试用例$2$（无差异信号的边界情况）：\n    - $G = 8$, $S = 6$。\n    - $X$：\n        - 基因$0$：$[7.0, 7.1, 6.9, 7.0, 7.1, 6.9]$。\n        - 基因$1$：$[7.5, 7.6, 7.4, 7.5, 7.6, 7.4]$。\n        - 基因$2$：$[8.0, 7.9, 8.1, 8.0, 7.9, 8.1]$。\n        - 基因$3$：$[6.0, 6.1, 5.9, 6.0, 6.1, 5.9]$。\n        - 基因$4$：$[5.0, 5.1, 4.9, 5.0, 5.1, 4.9]$。\n        - 基因$5$：$[9.0, 8.9, 9.1, 9.0, 8.9, 9.1]$。\n        - 基因$6$：$[6.5, 6.4, 6.6, 6.5, 6.4, 6.6]$。\n        - 基因$7$：$[7.2, 7.3, 7.1, 7.2, 7.3, 7.1]$。\n    - $y = [1, 1, 1, 0, 0, 0]$。\n    - 通路同测试用例$1$。\n    - $\\alpha = 0.1$。\n    - $T(j)$映射同测试用例$1$。\n\n- 测试用例$3$（具有单基因通路信号的边缘情况）：\n    - $G = 8$, $S = 6$。\n    - $X$:\n        - 基因$0$: $[7.0, 7.1, 7.0, 7.0, 7.1, 7.0]$。\n        - 基因$1$: $[7.0, 7.0, 7.1, 7.0, 7.0, 7.1]$。\n        - 基因$2$: $[6.9, 7.0, 7.0, 6.9, 7.0, 7.0]$。\n        - 基因$3$: $[6.8, 6.9, 6.9, 6.8, 6.9, 6.9]$。\n        - 基因$4$: $[6.0, 6.2, 5.9, 8.5, 8.7, 8.4]$。\n        - 基因$5$: $[7.1, 7.0, 7.1, 7.1, 7.0, 7.1]$。\n        - 基因$6$: $[6.9, 7.0, 7.0, 6.9, 7.0, 7.0]$。\n        - 基因$7$: $[7.0, 7.0, 6.9, 7.0, 7.0, 6.9]$。\n    - $y = [1, 1, 1, 0, 0, 0]$。\n    - 通路：\n        - $j=0$: $\\{0,1\\}$。\n        - $j=1$: $\\{2,3\\}$。\n        - $j=2$: $\\{4\\}$。\n        - $j=3$: $\\{6\\}$。\n        - $j=4$: $\\{7\\}$。\n    - $\\alpha = 0.1$。\n    - $T(j)$映射同测试用例$1$。\n\n- 测试用例$4$（基因集重叠）：\n    - $G = 8$, $S = 6$。\n    - $X$:\n        - 基因$0$: $[8.8, 9.0, 8.9, 5.6, 5.5, 5.7]$。\n        - 基因$1$: $[9.1, 9.2, 9.0, 5.3, 5.4, 5.2]$。\n        - 基因$2$: $[5.0, 5.1, 4.9, 7.4, 7.5, 7.6]$。\n        - 基因$3$: $[7.0, 7.1, 7.0, 7.0, 7.1, 7.0]$。\n        - 基因$4$: $[7.0, 7.1, 6.9, 7.0, 7.1, 6.9]$。\n        - 基因$5$: $[7.2, 7.1, 7.0, 7.2, 7.1, 7.0]$。\n        - 基因$6$: $[9.0, 8.9, 9.1, 8.8, 8.9, 8.7]$。\n        - 基因$7$: $[5.5, 5.6, 5.4, 7.9, 7.7, 8.0]$。\n    - $y = [1, 1, 1, 0, 0, 0]$。\n    - 通路：\n        - $j=0$: $\\{0,1\\}$。\n        - $j=1$: $\\{2,7\\}$。\n        - $j=2$: $\\{4,5\\}$。\n        - $j=3$: $\\{6\\}$。\n        - $j=4$: $\\{7\\}$。\n    - $\\alpha = 0.1$。\n    - $T(j)$映射同测试用例$1$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含四个测试用例的推荐治疗代码，形式为用方括号括起来的逗号分隔列表，例如$[x_1,x_2,x_3,x_4]$，其中每个$x_i$是如上定义的整数代码。不应打印任何其他文本。", "solution": "该问题要求实现一个多步生物信息学工作流程，以根据宿主转录组数据确定针对布鲁氏菌病的靶向治疗方案。解决方案是通过按顺序忠实地执行指定的统计程序来构建的。\n\n### 步骤1：数据分区\n对于每个测试用例，首先根据样本标签向量$y$将维度为$G$个基因乘以$S$个样本的基因表达矩阵$X$划分为两个子矩阵。对照组数据$X_c$由$X$中对应$y$标签为$1$的列组成。持续组数据$X_p$对应$y$标签为$0$的列。对照组中的样本数量为$n_c$，持续组中的样本数量为$n_p$。\n\n### 步骤2：基因差异表达分析\n对于每个基因$g$（从$g=0$到$G-1$），我们检验原假设，即对照组中的平均表达量等于持续组中的平均表达量。这是通过Welch不等方差$t$-检验完成的，该检验适用于小样本量并且不假设两组之间的方差相等。\n\n对于一个给定的基因，设样本均值为$\\bar{x}_c$和$\\bar{x}_p$，无偏样本方差为$s_c^2$和$s_p^2$。Welch $t$-统计量的计算公式为：\n$$\nt_g = \\frac{\\bar{x}_c - \\bar{x}_p}{\\sqrt{\\frac{s_c^2}{n_c} + \\frac{s_p^2}{n_p}}}\n$$\n自由度$\\nu$使用Welch-Satterthwaite方程计算：\n$$\n\\nu_g \\approx \\frac{\\left(\\frac{s_c^2}{n_c} + \\frac{s_p^2}{n_p}\\right)^2}{\\frac{(s_c^2/n_c)^2}{n_c-1} + \\frac{(s_p^2/n_p)^2}{n_p-1}}\n$$\n然后从具有$\\nu_g$自由度的学生$t$-分布中推导出双边$p$-值$p_g$。整个过程可以通过`scipy.stats.ttest_ind`函数并设置参数`equal_var=False`来可靠地实现。\n\n### 步骤3：转换为带符号的标准正态离差\n每个基因的检验结果，即一对$(t_g, p_g)$，被转换为一个单一的带符号的标准正态离差，或称$z$-分数，记为$z_g$。这种转换将所有基因的结果标准化，同时保留了显著性的大小和变化的方向。转换定义如下：\n$$\nz_g = \\text{sign}(t_g) \\cdot \\Phi^{-1}\\left(1 - \\frac{p_g}{2}\\right)\n$$\n其中$\\Phi^{-1}$是标准正态分布$\\mathcal{N}(0, 1)$的分位数函数（逆累积分布函数），$\\text{sign}(t_g)$在$t_g  0$时为$+1$，在$t_g  0$时为$-1$，在$t_g=0$时为$0$。正的$z_g$表示在对照组中表达量较高，而负的$z_g$表示在持续组中表达量较高。这可以使用`scipy.stats.norm.isf(p_g/2)`来计算，它直接计算$\\Phi^{-1}(1 - p_g/2)$。\n\n### 步骤4：使用Stouffer方法进行通路富集分析\n基因水平的$z$-分数被聚合成通路水平的得分。对于每个由$k_j$个基因集合定义的通路$\\mathcal{P}_j$，通过组合其成员基因的$z$-分数来计算Stouffer得分$S_j$：\n$$\nS_j = \\frac{\\sum_{i \\in \\mathcal{P}_j} z_i}{\\sqrt{k_j}}\n$$\n在原假设和声明的基因独立性假设下，$S_j$遵循标准正态分布。正的$S_j$表示该通路与对照表型相关，而负的$S_j$则表示与持续表型相关。然后从标准正态分布计算通路$j$的双边$p$-值，记为$p_j$：\n$$\np_j = 2 \\cdot \\Phi(-|S_j|) = 2 \\cdot (1 - \\Phi(|S_j|))\n$$\n其中$\\Phi$是标准正态分布的累积分布函数（CDF）。\n\n### 步骤5：多重检验校正\n为了解释同时检验多个通路的情况，原始的通路$p$-值$\\{p_j\\}_{j=0}^{M-1}$被调整以控制错误发现率（FDR）。应用Benjamini-Hochberg（BH）程序来获得调整后的$p$-值，或称$q$-值。该程序如下：\n1. 将$M$个通路的$p$-值按升序排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(M)}$。\n2. 对于每个排序后的$p$-值$p_{(i)}$，相应的$q$-值$q_{(i)}$计算如下：\n$$\nq_{(i)} = \\min_{j=i}^{M} \\left( \\frac{M}{j} p_{(j)} \\right)\n$$\n这确保了得到的$q$-值是单调递增的：$q_{(1)} \\le q_{(2)} \\le \\dots \\le q_{(M)}$。排序后的$q$-值随后被映射回其原始的通路索引。\n\n### 步骤6：治疗建议\n根据推导出的统计数据，遵循一套明确的规则提出治疗建议：\n1. 识别所有“持续相关”的通路，即Stouffer得分$S_j  0$的通路。\n2. 从这个子集中，选择那些统计上显著的通路，即其经FDR校正的$q$-值小于指定的阈值$\\alpha$（即$q_j  \\alpha$）。\n3. 如果没有发现显著的持续相关通路，推荐的治疗代码为$0$。\n4. 如果存在一个或多个这样的通路，选择其中最显著的一个。这是具有最小$q$-值的通路。\n5. 如果在最小$q$-值上出现平局，则通过选择具有更负的Stouffer得分（即绝对值更大）的通路来打破平局。\n6. 选定通路的索引$j^*$，然后用于从提供的映射$T(j^*)$中查找最终的治疗代码。\n\n这个全面的、分步的流程将原始$\\log_2$基因表达数据转化为基于严谨统计学原理的最终可行的治疗建议。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import ttest_ind, norm\n\ndef benjamini_hochberg(p_values):\n    \"\"\"\n    Computes q-values from p-values using the Benjamini-Hochberg procedure.\n    \"\"\"\n    m = len(p_values)\n    if m == 0:\n        return []\n    \n    p_array = np.asarray(p_values)\n    p_sorted_indices = np.argsort(p_array)\n    p_sorted = p_array[p_sorted_indices]\n\n    ranks = np.arange(1, m + 1)\n    q_values_sorted = p_sorted * m / ranks\n\n    # Enforce monotonicity by taking the cumulative minimum from the end.\n    q_values_sorted = np.minimum.accumulate(q_values_sorted[::-1])[::-1]\n\n    # Reorder to match the original p-value order.\n    q_values_original_order = np.empty(m)\n    q_values_original_order[p_sorted_indices] = q_values_sorted\n    \n    # Clamp maximum value at 1.0.\n    return np.minimum(q_values_original_order, 1.0)\n\ndef process_case(X, y, pathways, alpha, therapy_map):\n    \"\"\"\n    Implements the full bioinformatics pipeline for a single test case.\n    \"\"\"\n    # 1. Split data into control (y=1) and persistence (y=0) groups.\n    X = np.array(X)\n    y = np.array(y)\n    X_c = X[:, y == 1]\n    X_p = X[:, y == 0]\n    G, _ = X.shape\n    \n    # 2. Per-gene statistics: Welch's t-test and transformation to signed z-scores.\n    gene_z_scores = []\n    for g in range(G):\n        data_c = X_c[g, :]\n        data_p = X_p[g, :]\n        \n        # Welch's t-test gives the t-statistic and two-sided p-value.\n        # It internally handles cases with zero variance.\n        t_stat, p_val = ttest_ind(data_c, data_p, equal_var=False, nan_policy='raise')\n        \n        # Avoid p_val=0.0 which results in z=inf. Use smallest float instead.\n        if p_val == 0.0:\n            p_val = np.finfo(float).tiny\n            \n        # Transform (t, p) to a signed z-score.\n        # If t_stat is 0, sign is 0, z_score is 0. If p_val is 1, isf(0.5)=0, z_score is 0.\n        z_score = np.sign(t_stat) * norm.isf(p_val / 2)\n        gene_z_scores.append(z_score)\n\n    # 3. Pathway analysis: Stouffer's method.\n    pathway_results = []\n    pathway_p_values = []\n    for j, gene_indices in enumerate(pathways):\n        if not gene_indices:\n            stouffer_score = 0.0\n            pathway_p = 1.0\n        else:\n            pathway_z_scores = [gene_z_scores[i] for i in gene_indices]\n            k = len(pathway_z_scores)\n            stouffer_score = np.sum(pathway_z_scores) / np.sqrt(k)\n            pathway_p = 2 * norm.sf(np.abs(stouffer_score))\n        \n        pathway_results.append({'idx': j, 'score': stouffer_score})\n        pathway_p_values.append(pathway_p)\n        \n    # 4. Multiple testing correction using Benjamini-Hochberg.\n    q_values = benjamini_hochberg(pathway_p_values)\n    for i, res in enumerate(pathway_results):\n        res['q_val'] = q_values[i]\n\n    # 5. Therapeutic recommendation based on specified rules.\n    # Filter for persistence-associated pathways (negative Stouffer score).\n    persistence_pathways = [p for p in pathway_results if p['score']  0]\n    \n    # Filter for pathways significant at the FDR threshold alpha.\n    significant_persistence = [p for p in persistence_pathways if p['q_val']  alpha]\n    \n    if not significant_persistence:\n        return 0\n    \n    # Select best candidate: sort by q-value (asc), then Stouffer score (asc).\n    # For negative scores, ascending score order is equivalent to descending magnitude.\n    significant_persistence.sort(key=lambda p: (p['q_val'], p['score']))\n    \n    best_pathway_idx = significant_persistence[0]['idx']\n    return therapy_map[best_pathway_idx]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"X\": [\n                [9.1, 8.9, 9.0, 5.1, 5.2, 4.8],\n                [8.7, 9.2, 9.0, 5.5, 5.0, 5.3],\n                [4.0, 4.1, 4.2, 8.0, 8.2, 7.8],\n                [3.9, 4.2, 4.1, 7.9, 8.1, 8.2],\n                [7.0, 6.9, 7.1, 6.8, 7.1, 7.0],\n                [7.2, 7.1, 7.0, 7.2, 7.1, 7.3],\n                [10.0, 9.8, 10.2, 6.0, 6.2, 5.8],\n                [5.0, 5.1, 4.9, 9.0, 9.2, 8.8]\n            ],\n            \"y\": [1, 1, 1, 0, 0, 0],\n            \"pathways\": [{0,1}, {2,3}, {4,5}, {6}, {7}],\n            \"alpha\": 0.1,\n            \"therapy_map\": {0: 101, 1: 201, 2: 202, 3: 102, 4: 203}\n        },\n        {\n            \"X\": [\n                [7.0, 7.1, 6.9, 7.0, 7.1, 6.9],\n                [7.5, 7.6, 7.4, 7.5, 7.6, 7.4],\n                [8.0, 7.9, 8.1, 8.0, 7.9, 8.1],\n                [6.0, 6.1, 5.9, 6.0, 6.1, 5.9],\n                [5.0, 5.1, 4.9, 5.0, 5.1, 4.9],\n                [9.0, 8.9, 9.1, 9.0, 8.9, 9.1],\n                [6.5, 6.4, 6.6, 6.5, 6.4, 6.6],\n                [7.2, 7.3, 7.1, 7.2, 7.3, 7.1]\n            ],\n            \"y\": [1, 1, 1, 0, 0, 0],\n            \"pathways\": [{0,1}, {2,3}, {4,5}, {6}, {7}],\n            \"alpha\": 0.1,\n            \"therapy_map\": {0: 101, 1: 201, 2: 202, 3: 102, 4: 203}\n        },\n        {\n             \"X\": [\n                [7.0, 7.1, 7.0, 7.0, 7.1, 7.0],\n                [7.0, 7.0, 7.1, 7.0, 7.0, 7.1],\n                [6.9, 7.0, 7.0, 6.9, 7.0, 7.0],\n                [6.8, 6.9, 6.9, 6.8, 6.9, 6.9],\n                [6.0, 6.2, 5.9, 8.5, 8.7, 8.4],\n                [7.1, 7.0, 7.1, 7.1, 7.0, 7.1],\n                [6.9, 7.0, 7.0, 6.9, 7.0, 7.0],\n                [7.0, 7.0, 6.9, 7.0, 7.0, 6.9]\n            ],\n            \"y\": [1, 1, 1, 0, 0, 0],\n            \"pathways\": [{0,1}, {2,3}, {4}, {6}, {7}],\n            \"alpha\": 0.1,\n            \"therapy_map\": {0: 101, 1: 201, 2: 202, 3: 102, 4: 203}\n        },\n        {\n            \"X\": [\n                [8.8, 9.0, 8.9, 5.6, 5.5, 5.7],\n                [9.1, 9.2, 9.0, 5.3, 5.4, 5.2],\n                [5.0, 5.1, 4.9, 7.4, 7.5, 7.6],\n                [7.0, 7.1, 7.0, 7.0, 7.1, 7.0],\n                [7.0, 7.1, 6.9, 7.0, 7.1, 6.9],\n                [7.2, 7.1, 7.0, 7.2, 7.1, 7.0],\n                [9.0, 8.9, 9.1, 8.8, 8.9, 8.7],\n                [5.5, 5.6, 5.4, 7.9, 7.7, 8.0]\n            ],\n            \"y\": [1, 1, 1, 0, 0, 0],\n            \"pathways\": [{0,1}, {2,7}, {4,5}, {6}, {7}],\n            \"alpha\": 0.1,\n            \"therapy_map\": {0: 101, 1: 201, 2: 202, 3: 102, 4: 203}\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        result = process_case(case[\"X\"], case[\"y\"], case[\"pathways\"], case[\"alpha\"], case[\"therapy_map\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4631975"}]}