{"hands_on_practices": [{"introduction": "在临床实践中，准确诊断A群链球菌（GAS）咽炎对于预防急性风湿热等严重免疫后遗症至关重要。本练习旨在运用贝叶斯定理，将临床评分（如Centor标准）与社区流行率相结合，从而量化诊断的不确定性。通过计算后验概率，您将学会如何利用似然比来更新基于临床证据的判断，这是循证医学中的一项核心技能[@problem_id:4695178]。", "problem": "一名临床医生在评估一名患有急性咽炎的成年患者时，担心其感染了A组链球菌（GAS；Streptococcus pyogenes），因为该感染可能导致免疫介导的后遗症，如急性风湿热和链球菌感染后肾小球肾炎。该患者的Centor评分为4分，意味着所有四项标准都存在：扁桃体渗出物、颈前淋巴结肿大伴压痛、有发热史以及无咳嗽。假设社区中GAS的验前患病率（解释为验前概率）为$0.30$。在给定疾病状态的条件下，Centor标准对诊断证据的贡献是独立的，基于此假设，请使用贝叶斯定理和似然比的定义，计算当所有四项标准均为阳性时，GAS感染的后验概率。对于每个标准的单独（阳性）似然比，请使用以下数值，这些数值与成人人群的荟萃分析估计值一致：\n\n- 扁桃体渗出物: $\\text{LR}^{+} = 2.5$\n- 颈前淋巴结肿大伴压痛: $\\text{LR}^{+} = 1.7$\n- 有发热史: $\\text{LR}^{+} = 1.5$\n- 无咳嗽: $\\text{LR}^{+} = 1.3$\n\n请用小数概率形式表示你的最终答案，并四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题是有效的。它是在一个标准的临床诊断场景中，对贝叶斯推断的一个适定应用，使用了诸如验前概率和似然比等既定概念。所有必要的数据和假设均已提供。\n\n目标是计算在所有四项Centor标准都存在的情况下，A组链球菌（GAS）感染的后验概率。我们将使用贝叶斯定理，并以其方便的优势比-似然比形式来表示。\n\n设$D$为患者患有GAS感染的事件。问题提供了验前患病率，我们将其解释为验前概率$P(D)$。\n$$P(D) = 0.30$$\n感染的验前优势比$O(D)$由事件发生的概率与其补集概率之比给出：\n$$O(D) = \\frac{P(D)}{1 - P(D)}$$\n代入给定值：\n$$O(D) = \\frac{0.30}{1 - 0.30} = \\frac{0.30}{0.70} = \\frac{3}{7}$$\n设$E$表示收集到的证据，即所有四项Centor标准均为阳性。我们的任务是求出给定此证据下患病的后验概率$P(D|E)$。\n\n优势比形式的贝叶斯定理指出，后验优势比是验前优势比与证据的似然比（LR）的乘积：\n$$O(D|E) = O(D) \\times \\text{LR}^{+}(E)$$\n此处，$\\text{LR}^{+}(E)$是组合证据$E$的阳性似然比。\n\n问题陈述，在给定疾病状态的条件下，Centor标准是独立贡献的。这个关键假设使我们能够通过将每个阳性标准的单独似然比相乘来计算组合似然比。给定的各个阳性似然比（$\\text{LR}^{+}$）如下：\n- 扁桃体渗出物: $\\text{LR}^{+}_{1} = 2.5$\n- 颈前淋巴结肿大伴压痛: $\\text{LR}^{+}_{2} = 1.7$\n- 有发热史: $\\text{LR}^{+}_{3} = 1.5$\n- 无咳嗽: $\\text{LR}^{+}_{4} = 1.3$\n\n因此，组合似然比为：\n$$\\text{LR}^{+}(E) = \\text{LR}^{+}_{1} \\times \\text{LR}^{+}_{2} \\times \\text{LR}^{+}_{3} \\times \\text{LR}^{+}_{4}$$\n$$\\text{LR}^{+}(E) = 2.5 \\times 1.7 \\times 1.5 \\times 1.3$$\n进行乘法运算：\n$$\\text{LR}^{+}(E) = 8.2875$$\n现在我们可以计算感染的后验优势比：\n$$O(D|E) = O(D) \\times \\text{LR}^{+}(E) = \\frac{3}{7} \\times 8.2875$$\n$$O(D|E) = \\frac{24.8625}{7} \\approx 3.5517857$$\n最后，我们使用以下关系将后验优势比转换回概率：\n$$P(D|E) = \\frac{O(D|E)}{1 + O(D|E)}$$\n代入后验优势比的值：\n$$P(D|E) = \\frac{\\frac{24.8625}{7}}{1 + \\frac{24.8625}{7}} = \\frac{24.8625}{7 + 24.8625} = \\frac{24.8625}{31.8625}$$\n计算数值：\n$$P(D|E) \\approx 0.780305...$$\n问题要求答案四舍五入到四位有效数字。第五位有效数字是$0$，所以我们舍去。\n$$P(D|E) \\approx 0.7803$$\n这是在Centor评分为$4$分以及指定的验前概率和似然比的条件下，患者患有GAS咽炎的后验概率。", "answer": "$$\\boxed{0.7803}$$", "id": "4695178"}, {"introduction": "诊断和治疗链球菌性咽炎的主要目标之一是预防其免疫后遗症。本练习将视角从个体诊断转向公共卫生干预，通过概率模型来评估抗生素治疗在预防急性风湿热（ARF）方面的有效性。您将模拟抗生素干预与致病性免疫级联反应启动之间的“时间竞赛”，并使用指数分布来刻画这两个相互竞争的随机过程，从而量化一项公共卫生计划的预期影响[@problem_id:4695406]。", "problem": "考虑一个季节，在一个队列中有 $N$ 例由A群链球菌 (Streptococcus pyogenes) 引起的新的有症状的咽炎病例。在没有抗生素治疗的情况下，每例咽炎病例发展为急性风湿热 (ARF) 的基线概率为 $r_{0}$。比例为 $c$ 的病例接受了适当的抗生素治疗，一旦给药，只要在个体的免疫级联反应启动 ARF 之前进行，该治疗就能完全阻止向 ARF 的发展。设 $T$ 表示在那些未经治疗会发展为 ARF 的个体中，从症状出现到触发 ARF 的免疫级联反应启动的时间；设 $\\tau$ 表示在接受治疗的个体中，从症状出现到开始使用抗生素的时间。假设如下：\n- 在那些本会发展为 ARF 的个体中，随机变量 $T$ 服从率参数为 $\\alpha$ (天$^{-1}$) 的指数分布，这反映了病理免疫级联反应启动的无记忆性。\n- 在接受治疗的个体中，随机变量 $\\tau$ 服从率参数为 $\\beta$ (天$^{-1}$) 的指数分布，这反映了治疗时间的无记忆性过程。\n- 变量 $T$ 和 $\\tau$ 是独立的。\n- 当且仅当抗生素治疗在该个体 ARF 启动之前进行，即当 $\\tau  T$ 时，ARF 的发展被完全阻止；否则，ARF 不被阻止。\n\n根据概率论的第一性原理，推导该队列中被阻止的 ARF 病例的期望数量，并使用以下科学上合理的参数对其进行评估：\n- $N = 2.0 \\times 10^{5}$ 例，\n- $c = 0.70$，\n- $r_{0} = 0.018$，\n- $\\alpha = \\frac{1}{21}$ 天$^{-1}$，\n- $\\beta = 0.40$ 天$^{-1}$。\n\n将最终的期望计数表示为病例数，并将您的答案四舍五入到四位有效数字。", "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确且客观。它基于传染病流行病学和概率论的既定原则，提供了一套完整且一致的数据和条件，并且没有歧义或主观论断。\n\n目标是计算在一个A群链球菌 (GAS) 咽炎患者队列中，被阻止的急性风湿热 (ARF) 病例的期望数量。设此数量为 $E[\\text{Prevented}]$。\n\n首先，我们确定所给出的关键参数和变量：\n- 队列中咽炎病例总数为 $N = 2.0 \\times 10^{5}$。\n- 接受抗生素治疗的病例比例为 $c = 0.70$。\n- 单个未经治疗的病例发展为 ARF 的基线概率为 $r_{0} = 0.018$。\n- ARF 启动时间 $T$ 是一个率参数为 $\\alpha = \\frac{1}{21}$ 天$^{-1}$ 的指数随机变量。\n- 抗生素给药时间 $\\tau$ 是一个率参数为 $\\beta = 0.40$ 天$^{-1}$ 的指数随机变量。\n- 随机变量 $T$ 和 $\\tau$ 是独立的。\n\n对于一个个体，如果要阻止其 ARF 病例的发生，必须同时满足三个条件：\n1. 该个体属于在没有治疗的情况下本会发展为 ARF 的人群。\n2. 该个体接受了抗生素治疗。\n3. 治疗在免疫级联反应启动 ARF 之前进行，即 $\\tau  T$。\n\n让我们确定满足前两个条件的个体的期望数量。队列总人数为 $N$。接受治疗的个体数量为 $N \\times c$。在这个接受治疗的群体中，那些“注定”会发展为 ARF（基于基线风险 $r_{0}$）的个体的期望数量是接受治疗的群体规模乘以基线概率，即 $(N \\times c) \\times r_{0}$。这个乘积 $N c r_{0}$ 代表了治疗方案可能阻止的 ARF 病例的最大数量。\n\n对于这 $N c r_{0}$ 个个体中的每一个，只有当治疗及时，即 $\\tau  T$ 时，阻止才算成功。必须计算这个事件的概率 $P(\\tau  T)$。由于 $T$ 和 $\\tau$ 是独立的指数随机变量，我们可以通过在区域 $s  t$ 上对它们的联合概率密度函数 $f_{T,\\tau}(t, s) = f_T(t)f_\\tau(s)$ 进行积分来求得这个概率。\n\n$T$ 的概率密度函数 (PDF) 为 $f_T(t) = \\alpha \\exp(-\\alpha t)$，当 $t \\ge 0$。\n$\\tau$ 的 PDF 为 $f_\\tau(s) = \\beta \\exp(-\\beta s)$，当 $s \\ge 0$。\n联合 PDF 为 $f_{T,\\tau}(t, s) = \\alpha \\beta \\exp(-\\alpha t - \\beta s)$，当 $t, s \\ge 0$。\n\n概率 $P(\\tau  T)$ 计算如下：\n$$ P(\\tau  T) = \\int_{t=0}^{\\infty} \\int_{s=0}^{t} f_{T,\\tau}(t, s) \\, ds \\, dt $$\n$$ P(\\tau  T) = \\int_{t=0}^{\\infty} \\int_{s=0}^{t} \\alpha \\beta \\exp(-\\alpha t) \\exp(-\\beta s) \\, ds \\, dt $$\n首先，我们计算关于 $s$ 的内层积分：\n$$ \\int_{s=0}^{t} \\beta \\exp(-\\beta s) \\, ds = [-\\exp(-\\beta s)]_{s=0}^{t} = (-\\exp(-\\beta t)) - (-\\exp(0)) = 1 - \\exp(-\\beta t) $$\n接下来，我们将此结果代入外层积分：\n$$ P(\\tau  T) = \\int_{t=0}^{\\infty} \\alpha \\exp(-\\alpha t) (1 - \\exp(-\\beta t)) \\, dt $$\n$$ P(\\tau  T) = \\int_{t=0}^{\\infty} (\\alpha \\exp(-\\alpha t) - \\alpha \\exp(-(\\alpha + \\beta)t)) \\, dt $$\n这个积分可以分成两部分：\n$$ \\int_{0}^{\\infty} \\alpha \\exp(-\\alpha t) \\, dt - \\int_{0}^{\\infty} \\alpha \\exp(-(\\alpha + \\beta)t) \\, dt $$\n第一个积分是 $T$ 的指数分布的总概率，其值等于 $1$。对于第二个积分：\n$$ \\alpha \\int_{0}^{\\infty} \\exp(-(\\alpha + \\beta)t) \\, dt = \\alpha \\left[ \\frac{-\\exp(-(\\alpha + \\beta)t)}{\\alpha + \\beta} \\right]_{t=0}^{\\infty} = \\alpha \\left( 0 - \\frac{-1}{\\alpha + \\beta} \\right) = \\frac{\\alpha}{\\alpha + \\beta} $$\n因此，成功阻止的概率为：\n$$ P(\\tau  T) = 1 - \\frac{\\alpha}{\\alpha + \\beta} = \\frac{(\\alpha + \\beta) - \\alpha}{\\alpha + \\beta} = \\frac{\\beta}{\\alpha + \\beta} $$\n被阻止的 ARF 病例的期望数量 $E[\\text{Prevented}]$，是处于风险中的已治疗个体期望数量乘以每个个体成功阻止的概率：\n$$ E[\\text{Prevented}] = (N c r_{0}) \\times P(\\tau  T) = N c r_{0} \\frac{\\beta}{\\alpha + \\beta} $$\n现在，我们代入给定的数值：\n$N = 2.0 \\times 10^{5}$\n$c = 0.70$\n$r_{0} = 0.018$\n$\\alpha = \\frac{1}{21}$ 天$^{-1}$\n$\\beta = 0.40$ 天$^{-1}$\n\n首先，计算概率项 $\\frac{\\beta}{\\alpha + \\beta}$：\n$$ \\alpha + \\beta = \\frac{1}{21} + 0.40 = \\frac{1}{21} + \\frac{4}{10} = \\frac{1}{21} + \\frac{2}{5} = \\frac{5 \\times 1 + 2 \\times 21}{105} = \\frac{5 + 42}{105} = \\frac{47}{105} $$\n$$ \\frac{\\beta}{\\alpha + \\beta} = \\frac{0.40}{\\frac{47}{105}} = \\frac{2/5}{47/105} = \\frac{2}{5} \\times \\frac{105}{47} = \\frac{2 \\times 21}{47} = \\frac{42}{47} $$\n接下来，计算项 $N c r_{0}$：\n$$ N c r_{0} = (2.0 \\times 10^{5}) \\times 0.70 \\times 0.018 = 1.4 \\times 10^{5} \\times 0.018 = 2520 $$\n最后，计算被阻止病例的期望数量：\n$$ E[\\text{Prevented}] = 2520 \\times \\frac{42}{47} = \\frac{105840}{47} \\approx 2251.91489... $$\n问题要求答案四舍五入到四位有效数字。将 $2251.91489...$ 四舍五入到四位有效数字得到 $2252$。用标准科学记数法表示则为 $2.252 \\times 10^3$。", "answer": "$$\\boxed{2.252 \\times 10^3}$$", "id": "4695406"}, {"introduction": "开发安全有效的化脓性链球菌疫苗面临的一大挑战是分子模拟（molecular mimicry）可能导致的自身免疫风险。本练习将引导您进入免疫信息学的前沿领域，通过构建一个计算模型来量化疫苗候选抗原表位引发自身免疫的风险。您将学习如何综合利用结构相似性、免疫原性和序列保守性等多个特征，应用对数线性模型和贝叶斯更新来计算风险指数，这是现代疫苗设计和转化医学中的关键方法[@problem_id:4695267]。", "problem": "您的任务是建模因 Streptococcus pyogenes（酿脓链球菌）的表位与人体蛋白质中结构相似区域之间的分子模拟而引发的自身免疫风险，这是一种已被充分研究的、导致风湿性心脏病等免疫后遗症的机制。请将以下原则和定义作为您推导的基本依据：当由病原体表位塑造的适应性免疫反应，因序列和结构相似性而与宿主蛋白质发生交叉反应时，可引发免疫后遗症；这种交叉反应的概率随相似性和免疫原性的增加而单调递增；并且 Bayes' 定理关联了先验几率、似然比和后验几率。您必须推导一个有原则的、单调的映射，将特征层面的相似性和免疫原性变量映射到一个自身免疫的后验风险指数，然后基于一个阈值，决定是否将某些表位从候选疫苗中排除。\n\n使用的定义和建模假设：\n- 设风险指数为有害交叉反应激活的后验概率，记作 $p$，它由基线先验概率 $p_0$ 和一个从特征贡献中导出的似然比 $\\mathrm{LR}$ 计算得出。后验几率是先验几率乘以 $\\mathrm{LR}$，而后验概率是由几率转换而来的概率。\n- 每个表位的特征：\n  - 结构比对分数 $s \\in [0,1]$（无量纲），数值越高表示与人体蛋白质区域的结构相似性越大。\n  - 序列一致性分数 $q \\in [0,1]$（无量纲）。\n  - 归一化溶剂可及性 $e \\in [0,1]$（无量纲），代表与 B 细胞识别相关的暴露程度。\n  - 预测的人类白细胞抗原 (HLA) 结合亲和力 $IC_{50}$，单位为纳摩尔 (nM)，您必须使用单调映射将其转换为一个无量纲的 T 细胞免疫原性因子 $m \\in [0,1]$。\n  - 表位在 Streptococcus pyogenes 菌株间的保守性 $c \\in [0,1]$（无量纲）。\n- 对似然比使用一个与单调性和指数族一致的对数线性模型，其中包含固定的权重，这些权重编码了每个特征及其相互作用的相对重要性。权重以常数形式给出：$b_0 = 0$、$b_s = 1.5$、$b_q = 1.0$、$b_e = 0.5$、$b_m = 1.2$、$b_c = 0.8$ 和 $b_{sq} = 0.6$。基线先验为 $p_0 = 0.01$。\n- 在从 $IC_{50}$ 到 $m$ 的单调映射中，使用半饱和常数 $K = 50\\,\\mathrm{nM}$。\n- 决策规则：如果计算出的风险指数 $p$ 大于或等于阈值 $\\tau = 0.2$，则排除该表位。将风险指数表示为 $[0,1]$ 范围内的小数。\n\n您的程序必须为每个测试用例实现以下步骤：\n1. 使用单调变换从 $IC_{50}$ 计算 $m$，该变换将较低的 $IC_{50}$ 映射到较高的 $m$，并确保 $m \\in [0,1]$。\n2. 使用指定的权重以及结构和序列相似性之间的交互项，从特征计算似然比 $\\mathrm{LR}$。\n3. 使用 Bayes' 定理将先验概率 $p_0$ 和 $\\mathrm{LR}$ 转换为后验概率 $p$。\n4. 使用 $\\tau$ 应用决策规则，以产生布尔型的排除决策。\n\n测试套件（每个测试用例是一个元组 ($s, q, e, IC_{50}, c$)）：\n- 案例 1：$s = 0.6$, $q = 0.55$, $e = 0.8$, $IC_{50} = 30$, $c = 0.9$。\n- 案例 2：$s = 0.2$, $q = 0.1$, $e = 0.5$, $IC_{50} = 500$, $c = 0.4$。\n- 案例 3：$s = 0.9$, $q = 0.35$, $e = 0.3$, $IC_{50} = 20$, $c = 0.7$。\n- 案例 4：$s = 0.75$, $q = 0.5$, $e = 0.6$, $IC_{50} = 50$, $c = 0.5$。\n- 案例 5：$s = 1.0$, $q = 0.8$, $e = 0.9$, $IC_{50} = 10$, $c = 1.0$。\n- 案例 6：$s = 0.05$, $q = 0.0$, $e = 0.1$, $IC_{50} = 5$, $c = 0.2$。\n\n角度单位不适用。最终输出不需要物理单位。您必须将风险指数表示为 $[0,1]$ 范围内、四舍五入到四位小数的小数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个项目对应一个测试用例，并且本身必须是一个包含两个元素的列表，由四舍五入后的风险指数和布尔决策组成，例如 $[[0.1234,\\mathrm{False}],[0.5678,\\mathrm{True}],\\ldots]$。", "solution": "问题陈述被认为是有效的。它在科学上基于免疫信息学和统计学的既定原则，问题提法得当，具有清晰而完整的定义、数据和约束条件，并以客观、正式的语言表述。提供了推导每个测试用例的唯一、可验证解所需的所有必要信息。\n\n任务是针对给定的 *Streptococcus pyogenes* 表位计算自身免疫风险指数 $p$，并基于此风险决定是否将其从候选疫苗中排除。推导过程遵循一系列有原则的步骤，从原始特征开始，最终形成概率性风险评估。\n\n**步骤 1：计算 T 细胞免疫原性因子 ($m$)**\n\n问题要求一个从预测的人类白细胞抗原 (HLA) 结合亲和力 $IC_{50}$（单位为 nM）到无量纲的 T 细胞免疫原性因子 $m \\in [0,1]$ 的单调映射。较低的 $IC_{50}$ 值表示更强的结合力，因此具有更高的免疫原性。这种反比关系使用一个类似于 Hill-Langmuir 方程的函数进行建模，其中包含了给定的半饱和常数 $K = 50\\,\\mathrm{nM}$。$m$ 的值由以下方程确定：\n$$\nm = \\frac{K}{K + IC_{50}}\n$$\n代入给定的 $K$ 值：\n$$\nm = \\frac{50}{50 + IC_{50}}\n$$\n此函数正确地确保了当 $IC_{50} \\to 0$ 时，$m \\to 1$（最大免疫原性），而当 $IC_{50} \\to \\infty$ 时，$m \\to 0$（可忽略的免疫原性）。在 $IC_{50} = K = 50$ 时，我们有 $m=0.5$。\n\n**步骤 2：计算似然比 ($\\mathrm{LR}$)**\n\n问题指定了一个对数线性模型，用以将各种特征的贡献汇总成一个似然比 $\\mathrm{LR}$。该模型综合了来自结构相似性 ($s$)、序列一致性 ($q$)、溶剂可及性 ($e$)、免疫原性 ($m$) 和保守性 ($c$) 的证据。似然比的自然对数是这些特征的加权和，包括结构和序列相似性之间的交互项：\n$$\n\\ln(\\mathrm{LR}) = b_0 + b_s s + b_q q + b_e e + b_m m + b_c c + b_{sq} (s \\cdot q)\n$$\n似然比本身通过对该表达式取指数获得：\n$$\n\\mathrm{LR} = \\exp\\left( b_0 + b_s s + b_q q + b_e e + b_m m + b_c c + b_{sq} (s \\cdot q) \\right)\n$$\n提供的权重为：$b_0 = 0$、$b_s = 1.5$、$b_q = 1.0$、$b_e = 0.5$、$b_m = 1.2$、$b_c = 0.8$ 和 $b_{sq} = 0.6$。代入这些值，并注意到 $b_0=0$ 简化了方程：\n$$\n\\mathrm{LR} = \\exp\\left( 1.5 s + 1.0 q + 0.5 e + 1.2 m + 0.8 c + 0.6 s q \\right)\n$$\n\n**步骤 3：计算风险的后验概率 ($p$)**\n\n使用 Bayes' 定理，根据似然比 $\\mathrm{LR}$ 中封装的证据，将风险的先验概率 $p_0$ 更新为后验概率 $p$。该定理最方便的应用形式是基于几率。\n\n有害交叉反应激活的先验几率定义为：\n$$\n\\text{Odds}_0 = \\frac{p_0}{1 - p_0}\n$$\n给定基线先验概率 $p_0 = 0.01$，先验几率为：\n$$\n\\text{Odds}_0 = \\frac{0.01}{1 - 0.01} = \\frac{0.01}{0.99} = \\frac{1}{99}\n$$\n后验几率 $\\text{Odds}_p$ 是先验几率与似然比的乘积：\n$$\n\\text{Odds}_p = \\text{Odds}_0 \\times \\mathrm{LR}\n$$\n最后，从后验几率中恢复后验概率 $p$（风险指数）：\n$$\np = \\frac{\\text{Odds}_p}{1 + \\text{Odds}_p}\n$$\n\n**步骤 4：应用决策规则**\n\n如果一个表位计算出的风险指数 $p$ 大于或等于指定的阈值 $\\tau$，则将其从候选疫苗中排除。决策规则是：\n$$\n\\text{Decision} = \\begin{cases} \\text{True (排除)}  \\text{若 } p \\ge \\tau \\\\ \\text{False (包含)}  \\text{若 } p  \\tau \\end{cases}\n$$\n给定的阈值为 $\\tau = 0.2$。\n\n**案例 1 的示例计算**\n\n对于案例 1，特征值为：$s = 0.6$，$q = 0.55$，$e = 0.8$，$IC_{50} = 30$ 和 $c = 0.9$。\n\n1.  **计算 $m$**：\n    $$\n    m = \\frac{50}{50 + 30} = \\frac{50}{80} = 0.625\n    $$\n2.  **计算 $\\mathrm{LR}$**：\n    $$\n    \\ln(\\mathrm{LR}) = (1.5 \\times 0.6) + (1.0 \\times 0.55) + (0.5 \\times 0.8) + (1.2 \\times 0.625) + (0.8 \\times 0.9) + (0.6 \\times 0.6 \\times 0.55)\n    $$\n    $$\n    \\ln(\\mathrm{LR}) = 0.9 + 0.55 + 0.4 + 0.75 + 0.72 + 0.198 = 3.518\n    $$\n    $$\n    \\mathrm{LR} = \\exp(3.518) \\approx 33.7171\n    $$\n3.  **计算 $p$**：\n    $$\n    \\text{Odds}_p = \\frac{1}{99} \\times 33.7171 \\approx 0.340577\n    $$\n    $$\n    p = \\frac{0.340577}{1 + 0.340577} \\approx 0.25405\n    $$\n    四舍五入到四位小数，风险指数为 $p \\approx 0.2541$。\n4.  **应用决策规则**：\n    由于 $p \\approx 0.2541$ 且 $\\tau = 0.2$，我们有 $0.2541 \\ge 0.2$。决策为 `True` (排除)。\n\n对所有其他测试用例应用相同的程序以生成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the autoimmunity risk index for Streptococcus pyogenes epitopes and\n    determines if they should be excluded from a vaccine candidate.\n    \"\"\"\n    # Define the constants from the problem statement.\n    p0 = 0.01\n    K = 50.0  # nM\n    tau = 0.2\n    \n    # Weights for the log-linear model\n    b_s = 1.5\n    b_q = 1.0\n    b_e = 0.5\n    b_m = 1.2\n    b_c = 0.8\n    b_sq = 0.6\n\n    # Test suite: each case is a tuple (s, q, e, IC50, c)\n    test_cases = [\n        (0.6, 0.55, 0.8, 30, 0.9),\n        (0.2, 0.1, 0.5, 500, 0.4),\n        (0.9, 0.35, 0.3, 20, 0.7),\n        (0.75, 0.5, 0.6, 50, 0.5),\n        (1.0, 0.8, 0.9, 10, 1.0),\n        (0.05, 0.0, 0.1, 5, 0.2),\n    ]\n\n    results = []\n    \n    # Calculate prior odds once\n    prior_odds = p0 / (1 - p0)\n\n    for case in test_cases:\n        s, q, e, ic50, c = case\n        \n        # Step 1: Compute T-cell immunogenicity factor m from IC50\n        m = K / (K + ic50)\n        \n        # Step 2: Compute the likelihood ratio LR\n        # The log of the likelihood ratio is a weighted sum of features\n        log_lr = (b_s * s) + (b_q * q) + (b_e * e) + (b_m * m) + (b_c * c) + (b_sq * s * q)\n        lr = np.exp(log_lr)\n        \n        # Step 3: Convert prior probability and LR to a posterior probability p\n        posterior_odds = prior_odds * lr\n        p = posterior_odds / (1 + posterior_odds)\n        \n        # Round the risk index to four decimal places\n        p_rounded = round(p, 4)\n        \n        # Step 4: Apply the decision rule\n        decision = p >= tau\n        \n        results.append([p_rounded, decision])\n\n    # Format the final output string exactly as specified.\n    # The string representation of a list includes spaces, so we build the string manually.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "4695267"}]}