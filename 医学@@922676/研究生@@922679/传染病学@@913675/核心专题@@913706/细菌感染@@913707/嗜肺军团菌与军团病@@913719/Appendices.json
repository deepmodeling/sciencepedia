{"hands_on_practices": [{"introduction": "理解嗜肺军团菌的传播，首先要量化从受污染气溶胶中吸入的剂量。本练习将指导您完成一个基础的定量微生物风险评估（QMRA）计算，模拟在淋浴等常见暴露场景下的吸入剂量[@problem_id:4645005]。掌握这种计算是评估受污染水系统风险并设计有效干预措施的第一步。", "problem": "一位旅客在酒店房间里洗了 $10$ 分钟的淋浴。空气采样表明，淋浴产生的可吸入性含水气溶胶中含有 Legionella pneumophila，其平均浓度为每升空气 $10^{3}$ 个基因组拷贝。此人以每分钟 $12$ 升的稳定容积速率呼吸，在此条件下，吸入的气溶胶颗粒在下呼吸道沉积的比例（沉积效率）为 $0.3$。假设在暴露期间气溶胶浓度是均匀且稳定的，并忽略呼吸模式的任何变化。\n\n仅使用以下核心定义：(i) 总吸入体积等于呼吸速率乘以时间，(ii) 沉积的颗粒数量等于吸入的颗粒数量乘以沉积效率，计算 Legionella pneumophila 的预期吸入沉积剂量，以基因组拷贝表示。将您的答案四舍五入至三位有效数字，并以基因组拷贝为单位报告。\n\n然后，基于微生物风险评估的基本原理，简要解释该沉积剂量如何与军团病（Legionnaires’ disease）的感染风险相关，明确提及存活率的作用和通用的剂量-反应框架，但不要计算具体的风险数值。", "solution": "问题陈述经评估具有科学依据、提法明确且客观。计算所需的所有数据均已提供，并且在环境微生物学和公共卫生的背景下，这些数值是合理的。涉及因淋浴而吸入 *Legionella pneumophila* 的情景是导致军团病（Legionnaires' disease）的一个典型且现实的途径。因此，该问题被认为是有效的。\n\n根据提示，解答分为两部分：第一部分是计算沉积剂量，第二部分是概念性地解释此剂量与感染风险之间的关系。\n\n**第一部分：计算吸入沉积剂量**\n\n问题要求计算 *Legionella pneumophila* 的预期吸入沉积剂量，单位为基因组拷贝。我们获得了以下参数：\n\n- 暴露持续时间, $T = 10 \\text{ min}$\n- 呼吸速率, $R_b = 12 \\text{ L/min}$\n- *Legionella pneumophila* 的气溶胶浓度, $C = 10^3 \\text{ 基因组拷贝/L}$\n- 下呼吸道沉积效率, $\\eta = 0.3$\n\n根据问题中规定的定义，我们首先计算淋浴期间吸入的总空气体积。\n\n总吸入体积 $V_{inhaled}$ 是呼吸速率与暴露时间的乘积：\n$$V_{inhaled} = R_b \\times T$$\n代入给定值：\n$$V_{inhaled} = \\left( 12 \\, \\frac{\\text{L}}{\\text{min}} \\right) \\times (10 \\text{ min}) = 120 \\text{ L}$$\n\n接下来，我们计算吸入的 *Legionella* 基因组拷贝总数 $D_{inhaled}$。这是总吸入体积与空气中基因组拷贝浓度的乘积：\n$$D_{inhaled} = V_{inhaled} \\times C$$\n代入数值：\n$$D_{inhaled} = (120 \\text{ L}) \\times \\left( 10^3 \\, \\frac{\\text{genome copies}}{\\text{L}} \\right) = 120 \\times 1000 \\text{ genome copies} = 120000 \\text{ genome copies}$$\n\n最后，我们计算沉积剂量 $D_{dep}$，即在下呼吸道沉积的吸入基因组拷贝数。这是通过将吸入剂量乘以沉积效率 $\\eta$ 得出的。\n$$D_{dep} = D_{inhaled} \\times \\eta$$\n代入数值：\n$$D_{dep} = (120000 \\text{ genome copies}) \\times 0.3 = 36000 \\text{ genome copies}$$\n\n问题要求答案保留三位有效数字。用科学记数法表示为：\n$$D_{dep} = 3.60 \\times 10^4 \\text{ genome copies}$$\n\n**第二部分：沉积剂量与感染风险之间的关系**\n\n计算出的 $3.60 \\times 10^4$ 基因组拷贝的沉积剂量是暴露的量度，而非感染风险的直接量度。此剂量与发生军团病（Legionnaires’ disease）的概率之间的关系是复杂的，并受定量微生物风险评估（QMRA）基本原理的制约。\n\n1.  **存活率和感染性**：剂量是以“基因组拷贝”量化的，这是一个通常通过分子方法（如定量聚合酶链反应，qPCR）获得的指标。该技术检测并量化特定的DNA序列，但它不区分存活（活的、有感染性的）和非存活（死的）细菌，也不区分完整的细胞和气溶胶中自由漂浮的DNA片段。感染只能由能够在宿主细胞（肺泡巨噬细胞）内复制的存活细菌引发。因此，*感染剂量* 只是总沉积基因组拷贝的一部分。存活微生物与基因组拷贝的比率可能变化很大，而且通常很低。为了评估风险，必须估计存活细胞的剂量，通常以菌落形成单位（CFU）表示。\n\n2.  **剂量-反应框架**：感染风险不是一个确定性的结果，而是一个概率性的结果。感染剂量（$d$，以存活微生物数量衡量）与感染概率 $P(\\text{infection})$ 之间的关系由一个剂量-反应模型来描述。一个常用的通用模型是指数剂量-反应模型：\n    $$P(\\text{infection} | d) = 1 - \\exp(-r \\cdot d)$$\n    在这个模型中，$r$ 是感染性参数，代表单个微生物能够存活并引发感染的概率。该模型表明，没有绝对的“安全”阈值；即使是单个存活的微生物也有非零的概率导致感染。风险随着存活微生物剂量的增加而单调增加。剂量-反应曲线的确切形状和 $r$ 的值是病原体特异性的，并且可能受到细菌菌株和暴露途径的影响。\n\n3.  **宿主易感性**：从感染到临床疾病（军团病）的最后一步在很大程度上取决于宿主因素。暴露于 *Legionella pneumophila* 后发展为肺炎的风险，对于免疫系统受损的个体、老年人、吸烟者或患有慢性肺病的人来说要高得多。一个健康的个体可能吸入一个感染剂量后能清除细菌而无任何不良影响，而相同的剂量对于一个高度易感的人来说可能是致命的。因此，一个完整的风险评估必须考虑暴露人群中易感性的分布情况。\n\n总而言之，计算出的 $3.60 \\times 10^4$ 基因组拷贝的沉积剂量是风险评估的关键初始输入。然而，要估计实际的疾病风险，必须将这个暴露指标细化为感染剂量（通过考虑存活率），然后将其作为输入用于剂量-反应模型，所得的感染概率还需结合宿主特异性易感因素进行情境化分析。", "answer": "$$\n\\boxed{3.60 \\times 10^4}\n$$", "id": "4645005"}, {"introduction": "在暴露并出现症状后，准确的诊断对患者的预后至关重要。本练习应用贝叶斯定理来评估作为临床诊断基石的军团菌尿抗原检测的实际性能[@problem_id:4659410]。通过计算阳性预测值（PPV）和阴性预测值（NPV），您将学会如何在疾病患病率的背景下批判性地解读检测结果，这是循证临床决策的一项关键技能。", "problem": "在一项军团病的调查中，一个医院队列使用嗜肺军团菌尿抗原检测进行评估，该检测主要检测嗜肺军团菌血清1型。在这个队列中，疾病患病率为 $0.10$。该检测的灵敏度为 $0.80$，特异度为 $0.95$。根据灵敏度定义为 $\\mathbb{P}(\\text{Test}+\\mid \\text{Disease})$、特异度定义为 $\\mathbb{P}(\\text{Test}-\\mid \\neg \\text{Disease})$ 以及患病率定义为 $\\mathbb{P}(\\text{Disease})$，应用贝叶斯定理推导并计算阳性预测值 (PPV)（定义为 $\\mathbb{P}(\\text{Disease}\\mid \\text{Test}+)$）和阴性预测值 (NPV)（定义为 $\\mathbb{P}(\\neg \\text{Disease}\\mid \\text{Test}-)$）。将PPV和NPV均表示为小数，并将答案四舍五入至四位有效数字。请勿在任何地方使用百分号。然后，从与疑似军团病临床决策相关的后验概率角度，简要解释这些值的意义。", "solution": "该问题是有效的，因为它具有流行病学和概率论的科学依据，内容自洽，且提法得当。所有必要的数据均已提供，并且该场景对于临床调查是现实的。\n\n设 $D$ 为患者患有军团病的事件，$\\neg D$ 为患者未患该病的事件。设 $T+$ 表示阳性检测结果，$T-$ 表示阴性检测结果。题目提供了以下信息：\n\n1.  患病率：$\\mathbb{P}(D) = 0.10$。这是患者患病的先验概率。\n2.  灵敏度：$\\mathbb{P}(T+ \\mid D) = 0.80$。这是在患者患病的情况下，检测结果为阳性的概率。\n3.  特异度：$\\mathbb{P}(T- \\mid \\neg D) = 0.95$。这是在患者未患病的情况下，检测结果为阴性的概率。\n\n根据这些已知条件，我们可以推导出其他必要的概率：\n-   未患病的概率为 $\\mathbb{P}(\\neg D) = 1 - \\mathbb{P}(D) = 1 - 0.10 = 0.90$。\n-   假阴性的概率为 $\\mathbb{P}(T- \\mid D) = 1 - \\mathbb{P}(T+ \\mid D) = 1 - 0.80 = 0.20$。\n-   假阳性的概率为 $\\mathbb{P}(T+ \\mid \\neg D) = 1 - \\mathbb{P}(T- \\mid \\neg D) = 1 - 0.95 = 0.05$。\n\n任务是计算阳性预测值 (PPV) $\\mathbb{P}(D \\mid T+)$ 和阴性预测值 (NPV) $\\mathbb{P}(\\neg D \\mid T-)$。\n\n首先，我们使用贝叶斯定理计算 PPV：\n$$ \\text{PPV} = \\mathbb{P}(D \\mid T+) = \\frac{\\mathbb{P}(T+ \\mid D) \\mathbb{P}(D)}{\\mathbb{P}(T+)} $$\n分母 $\\mathbb{P}(T+)$ 是检测结果为阳性的总概率。我们使用全概率公式来计算它：\n$$ \\mathbb{P}(T+) = \\mathbb{P}(T+ \\mid D)\\mathbb{P}(D) + \\mathbb{P}(T+ \\mid \\neg D)\\mathbb{P}(\\neg D) $$\n代入已知值：\n$$ \\mathbb{P}(T+) = (0.80)(0.10) + (0.05)(0.90) $$\n$$ \\mathbb{P}(T+) = 0.08 + 0.045 = 0.125 $$\n现在我们可以计算 PPV：\n$$ \\text{PPV} = \\frac{0.08}{0.125} = 0.64 $$\n四舍五入至四位有效数字，PPV 为 $0.6400$。\n\n接下来，我们使用贝叶斯定理计算 NPV：\n$$ \\text{NPV} = \\mathbb{P}(\\neg D \\mid T-) = \\frac{\\mathbb{P}(T- \\mid \\neg D) \\mathbb{P}(\\neg D)}{\\mathbb{P}(T-)} $$\n分母 $\\mathbb{P}(T-)$ 是检测结果为阴性的总概率。我们使用全概率公式来计算它：\n$$ \\mathbb{P}(T-) = \\mathbb{P}(T- \\mid \\neg D)\\mathbb{P}(\\neg D) + \\mathbb{P}(T- \\mid D)\\mathbb{P}(D) $$\n代入已知值：\n$$ \\mathbb{P}(T-) = (0.95)(0.90) + (0.20)(0.10) $$\n$$ \\mathbb{P}(T-) = 0.855 + 0.02 = 0.875 $$\n或者，$\\mathbb{P}(T-) = 1 - \\mathbb{P}(T+) = 1 - 0.125 = 0.875$。\n现在我们可以计算 NPV：\n$$ \\text{NPV} = \\frac{0.855}{0.875} \\approx 0.9771428... $$\n四舍五入至四位有效数字，NPV 为 $0.9771$。\n\n结果解释：\n\n阳性预测值 (PPV) 为 $0.6400$，是在检测结果为阳性的条件下，患者患有军团病的后验概率。在这个特定队列中，如果一名患者的检测结果为阳性，那么他们实际患病的可能性为 $64.00\\%$。这说明即使检测具有良好的灵敏度和特异度，阳性结果也并非决定性的，因为在该人群中 $100\\% - 64.00\\% = 36.00\\%$ 的阳性结果是假阳性。该检测将患病概率从 $10\\%$ 的基础患病率显著提高到 $64\\%$ 的后验概率，但仍然需要临床判断和可能的确认性检测。\n\n阴性预测值 (NPV) 为 $0.9771$，是在检测结果为阴性的条件下，患者未患有军团病的后验概率。如果一名患者的检测结果为阴性，那么他们确实没有患病的可能性为 $97.71\\%$。尽管检测结果为阴性，但仍患有该病的概率非常低（$1 - 0.9771 = 0.0229$，即 $2.29\\%$）。高的NPV使得该检测在排除疾病方面非常有用。在临床环境中，阴性结果为将诊断方向引向其他病因提供了强有力的证据。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6400  0.9771\n\\end{pmatrix}\n}\n$$", "id": "4659410"}, {"introduction": "理解一次疫情的最后一步是评估其严重性以及影响患者预后的因素。本练习聚焦于计算病死率（CFR），这是衡量疾病致命性的一个关键流行病学指标[@problem_id:4659439]。通过推导该估计量并探讨其如何受年龄和合并症等人口特征的影响，您将深入理解如何正确衡量和解释军团病对公共卫生的影响。", "problem": "在一个为期$30$天的固定随访窗口内，对一起由嗜肺军团菌（Legionella pneumophila）引起的军团病社区暴发进行了调查。在确定病例定义时，有$n = 60$例实验室确诊病例，所有病例均被完整观察$30$天，并有完全的结局确定（无失访，无右删失）。在此窗口期内，其中$d = 9$例病例因各种原因死亡。\n\n从核心的流行病学和概率定义出发——具体来说，将固定窗口期内的病死率解释为已确定病例在该窗口期内的死亡概率，并将每例病例在$30$天内的死亡建模为伯努利结局——推导出$30$天病死率的大样本、基于似然的点估计量，然后计算本次暴发的该估计值。最终数值以小数形式表示，并四舍五入至三位有效数字。\n\n然后，在不代入更多数字的情况下，使用符号推理来形式化说明年龄（用$A$表示年龄分层）和合并症负担（用$C$表示合并症分层）的异质性如何改变不同病例组合人群的总体病死率。具体而言，将总体病死率表示为由$(A,C)$索引的分层特异性数量的混合，并根据这些数量和病例组合权重，解释当分层特异性风险保持不变时，$(A,C)$在不同人群中的分布变化如何改变总体值。除了所要求的单个暴发值外，不要计算任何额外的数值。所要求的最终答案应该是计算出的对应于该暴发$30$天病死率的单个小数值（无单位）。", "solution": "在尝试解答之前，首先评估问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- **背景**：一次由*嗜肺军团菌*（*Legionella pneumophila*）引起的军团病暴发。\n- **随访期**：固定的$30$天窗口。\n- **病例数**：$n = 60$例实验室确诊病例。\n- **观察细节**：所有病例均被完整观察$30$天，结局确定完整。无失访或右删失。\n- **死亡人数**：在$30$天窗口期内，因各种原因死亡的人数为$d = 9$。\n- **建模框架**：\n    1. 固定窗口期内的病死率被解释为病例的死亡概率$p$。\n    2. 每个病例在$30$天内死亡被建模为伯努利结局。\n- **任务**：\n    1. 推导出$30$天病死率的大样本、基于似然的点估计量。\n    2. 计算该估计量在本次暴发中的数值，四舍五入至三位有效数字。\n    3. 形式化说明总体病死率如何因年龄（$A$）和合并症（$C$）的异质性而改变。这涉及将总体数量表示为分层特异性数量的混合。\n    4. 解释$(A, C)$的病例组合分布变化如何影响总体病死率。\n- **最终答案要求**：计算出的病死率的单个小数值。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在流行病学和生物统计学方面具有科学依据。它描述了一种针对传染病暴发的标准队列研究场景。病死率、伯努利试验、最大似然估计和分层等概念是这些领域的基本原则。所提供的数据（$n=60, d=9$）对于一次社区军团病暴发是合理的。\n- **适定性**：该问题是适定的。它提供了推导和计算点估计量所需的所有信息（$n$和$d$）。关于异质性的概念性问题陈述清晰，并涉及标准的流行病学概念（标准化/混杂）。这些任务导向一个唯一且有意义的解决方案。\n- **客观性**：该问题使用客观、精确和标准的科学术语进行表述。它没有歧义、主观陈述或偏见。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的，提法是明确的，并且是客观的。它没有违反任何无效标准。因此，该问题被判定为**有效**，并将提供完整的解决方案。\n\n### 解题推导\n\n该问题要求推导和计算$30$天病死率，我们将其表示为$p$。这个量是从该人群中随机选择一个病例在$30$天随访期内死亡的概率。\n\n**第1部分：点估计量的推导**\n\n我们将$n=60$例病例中每一例的结局建模为一个独立同分布的伯努利随机变量。设$X_i$为病例$i$结局的随机变量，其中$i = 1, \\dots, n$。我们定义，如果病例$i$在$30$天内死亡，则$X_i = 1$，如果病例$i$存活，则$X_i = 0$。任何给定病例的死亡概率为$P(X_i = 1) = p$，存活概率为$P(X_i = 0) = 1-p$。\n\n观察到的总死亡人数为$d = \\sum_{i=1}^{n} x_i$，其中$x_i$是病例$i$的观察结局。鉴于各试验是独立的，$n$个病例中观察到$d$例死亡的概率遵循二项分布。似然函数$L(p)$，即在给定参数$p$的情况下观察到数据（特别是$d$例死亡）的概率，是：\n$$L(p | d, n) = \\binom{n}{d} p^d (1-p)^{n-d}$$\n为了找到$p$的最大似然估计量（MLE），记为$\\hat{p}$，我们必须找到使$L(p)$最大化的$p$值。在数学上，最大化似然函数的自然对数，即对数似然函数$\\ell(p) = \\ln(L(p))$，更为方便：\n$$\\ell(p) = \\ln\\left(\\binom{n}{d}\\right) + d \\ln(p) + (n-d) \\ln(1-p)$$\n为了找到最大值，我们对$\\ell(p)$关于$p$求一阶导数并令其为零。\n$$\\frac{d\\ell}{dp} = \\frac{d}{p} - \\frac{n-d}{1-p}$$\n将导数设为零，得到得分方程：\n$$\\frac{d\\ell}{dp} = 0 \\implies \\frac{d}{p} = \\frac{n-d}{1-p}$$\n解出$p$：\n$$d(1-p) = p(n-d)$$\n$$d - dp = np - dp$$\n$$d = np$$\n$$p = \\frac{d}{n}$$\n因此，$p$的点估计量为$\\hat{p} = \\frac{d}{n}$。为确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{dp^2} = -\\frac{d}{p^2} - \\frac{n-d}{(1-p)^2}$$\n对于$n > d > 0$，两项均为负。因此，$\\frac{d^2\\ell}{dp^2}  0$，这证实了对数似然函数是凹的，并且临界点对应于一个最大值。病死率的MLE是死亡病例的样本比例。\n\n**第2部分：暴发数据的计算**\n\n根据暴发数据：\n- 病例数：$n = 60$\n- 死亡人数：$d = 9$\n\n$30$天病死率的点估计值为：\n$$\\hat{p} = \\frac{d}{n} = \\frac{9}{60} = \\frac{3}{20} = 0.15$$\n问题要求答案四舍五入到三位有效数字。精确值$0.15$有两位有效数字。为了用三位有效数字表示，我们在末尾加一个零：$0.150$。\n\n**第3部分：异质性的形式化**\n\n问题要求形式化说明总体病死率如何因年龄（$A$）和合并症负担（$C$）的异质性而改变。总体病死率是整个病例人群的平均值，该人群可能由具有不同潜在风险的亚群（分层）组成。\n\n设$A$和$C$为随机变量，分别代表病例的年龄组和合并症状况。我们通过特定的水平组合$(a, c)$来定义一个分层，其中$a$属于年龄分层集合$\\mathcal{A}$，$c$属于合并症分层集合$\\mathcal{C}$。\n\n**分层特异性病死率**$p_{ac}$是在特定分层$(A=a, C=c)$内病例的死亡概率：\n$$p_{ac} = P(\\text{死亡} | A=a, C=c)$$\n人群的**病例组合**描述了病例在这些分层中的分布。我们可以用一组权重$w_{ac}$来表示，其中每个权重是总病例人群中属于分层$(a,c)$的比例：\n$$w_{ac} = P(A=a, C=c)$$\n这些权重之和必须为1：$\\sum_{a \\in \\mathcal{A}} \\sum_{c \\in \\mathcal{C}} w_{ac} = 1$。\n\n整个人群的**总体病死率**$p_{overall}$可以使用全概率定律来表示。它是分层特异性病死率的加权平均值，其中权重是每个分层中病例的比例：\n$$p_{overall} = \\sum_{a \\in \\mathcal{A}} \\sum_{c \\in \\mathcal{C}} P(\\text{死亡} | A=a, C=c) P(A=a, C=c)$$\n代入我们的符号，这变成：\n$$p_{overall} = \\sum_{a \\in \\mathcal{A}} \\sum_{c \\in \\mathcal{C}} p_{ac} w_{ac}$$\n\n**第4部分：病例组合变化的影响**\n\n这种形式化使我们能够理解，即使潜在的分层特异性风险（$p_{ac}$）保持不变，两个人群之间的总体病死率为何会不同，或者随时间发生变化。\n\n假设我们比较两个不同的人群，人群1和人群2，它们有不同的病例组合分布，分别用权重$w_{ac}^{(1)}$和$w_{ac}^{(2)}$表示。如果我们假设两个人群中的分层特异性风险$p_{ac}$（取决于生物因素和医疗质量）是相同的，那么它们的总体病死率将是：\n$$p_{overall}^{(1)} = \\sum_{a,c} p_{ac} w_{ac}^{(1)}$$\n$$p_{overall}^{(2)} = \\sum_{a,c} p_{ac} w_{ac}^{(2)}$$\n总体病死率的差异是：\n$$\\Delta p_{overall} = p_{overall}^{(2)} - p_{overall}^{(1)} = \\sum_{a,c} p_{ac} \\left( w_{ac}^{(2)} - w_{ac}^{(1)} \\right)$$\n这个方程表明，病例分布从风险较低的分层向风险较高的分层转移（即，与$w^{(1)}$相比，$w^{(2)}$在具有高$p_{ac}$值的分层$(a,c)$上赋予更多权重）将导致观察到的总体病死率增加（$p_{overall}^{(2)} > p_{overall}^{(1)}$）。相反，病例组合向更年轻、更健康的个体（具有较低$p_{ac}$的分层）转移，将降低总体病死率。这说明了一个人群未经调整的原始病死率既是病原体内在毒力（反映在$p_{ac}$中）的函数，也是受影响人群的人口统计/健康状况（反映在$w_{ac}$中）的函数。", "answer": "$$\\boxed{0.150}$$", "id": "4659439"}]}