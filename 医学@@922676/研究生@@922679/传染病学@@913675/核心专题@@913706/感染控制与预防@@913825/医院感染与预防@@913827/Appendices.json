{"hands_on_practices": [{"introduction": "在医疗相关感染（HAI）的监测中，发生密度是一个基石性的衡量指标。本练习不仅要求您计算这一核心比率，更重要的是，它将挑战您连接经验观察与理论概念，探讨在何种假设下，我们计算出的经验比率可以作为潜在随机过程中恒定风险率的有效估计 [@problem_id:4647335]。理解这些流行病学和生存分析的基本原理，对于严谨地解释监测数据和构建更复杂的传播模型至关重要。", "problem": "一家三级护理医院的重症监护室根据 United States Centers for Disease Control and Prevention (CDC) 的标准对医疗相关感染 (HAIs) 进行主动监测。在一个连续的观察窗口期内，该队列总共累积了$9{,}000$个无感染患者-日的风险时间，在此期间共查明了$18$例新发HAI。基于生存分析的基本定义（特别是风险函数 $h(t)$，即风险人群中单位时间的瞬时风险），并且不使用专门的简化公式，计算以每$1{,}000$个患者-日的感染数表示的发病密度。将您的数值答案四舍五入至四位有效数字，并以“每$1{,}000$个患者-日的感染数”为单位明确表示该值。然后，从风险函数的核心定义以及将稀有事件建模为泊松过程的成熟性质出发，解释在何种假设下，经验计算的发病密度能够近似在此情景下决定HAI发生的潜在风险率，内容需包括对平稳性、增量独立性和患者-时间非信息性删失的考量。", "solution": "该问题被评估为有效，因为其科学基础在于流行病学和生物统计学的原理，问题提法严谨，数据充分且一致，并以客观、正式的语言表述。它要求基于既有理论进行计算和概念性解释。\n\n主要任务是计算医疗相关感染 (HAIs) 的发病密度，并阐明使得这一经验测量值能够近似潜在理论风险率的假设。\n\n首先，我们进行发病密度的计算。发病密度（也称为发病率）是在特定人群中、在指定的“人-时”风险期内新事件发生速率的衡量指标。其定义为新发病例数除以总风险人时。\n\n已知数据如下：\n- 新发HAI数量，记为 $N = 18$。\n- 总风险人时，记为 $PT = 9,000$ 患者-日。\n\n发病密度 $ID$ 的计算公式为：\n$$\nID = \\frac{N}{PT}\n$$\n代入给定值：\n$$\nID = \\frac{18 \\text{ infections}}{9,000 \\text{ patient-days}} = 0.002 \\text{ infections per patient-day}\n$$\n问题要求发病密度以每$1,000$个患者-日的感染数表示。为转换单位，我们将计算出的比率乘以$1,000$：\n$$\nID_{\\text{per } 1000} = ID \\times 1,000 = 0.002 \\frac{\\text{infections}}{\\text{patient-day}} \\times 1,000 = 2 \\frac{\\text{infections}}{1,000 \\text{ patient-days}}\n$$\n问题规定数值答案应四舍五入至四位有效数字。因此，数值$2$必须表示为$2.000$。\n\n其次，我们解释在何种假设下，这个经验计算的发病密度可以近似潜在的风险率。\n\n在生存分析中，风险函数 $h(t)$ 表示在个体直到时间 $t$ 仍未发生事件的条件下，在时间 $t$ 发生事件（在此案例中为HAI）的瞬时风险。其正式定义为：\n$$\nh(t) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\le T  t + \\Delta t \\mid T \\ge t)}{\\Delta t}\n$$\n其中 $T$ 是表示到感染发生时间的随机变量。\n\n计算出的发病密度 $ID = N/PT$ 可作为风险率的经验估计量。这个近似值具体来说是观察期内平均风险率的估计。如果我们将HAI的发生建模为泊松过程，这个近似会变得更加有力且直接。在此框架下，在总人时 $PT$ 内观察到的事件数 $N$ 被假定服从均值为 $\\mu = \\lambda \\times PT$ 的泊松分布，其中 $\\lambda$ 是恒定的潜在风险率。该率参数 $\\lambda$ 的最大似然估计量是 $\\hat{\\lambda} = N/PT$，这正是发病密度的计算公式。\n\n为使经验发病密度成为单一、恒定潜在风险率 $\\lambda$ 的一个有效且准确的近似，必须满足泊松过程模型固有的几个关键假设：\n\n1.  **平稳性（恒定风险率）：** 这是最关键的假设。我们必须假设风险率 $\\lambda$ 在整个观察期内以及对所有患者都是恒定的。这意味着患者在ICU住院期间任何一天的HAI感染风险都是相同的，并且不随研究的日历时间而改变。这种时间齐次过程的假设，$h(t) = \\lambda$，极大地简化了分析。实际上，患者的风险可能会随其住院时间的长短或临床状况的变化而改变，但对于一个足够稳定的系统或在特定时期内，这可以是一个合理的近似。\n\n2.  **增量独立性：** 任何两个不重叠时间区间内发生的HAI数量必须是独立的。这意味着某一患者在特定时间发生HAI，并不会影响另一患者在之后时间发生HAI的概率。如果在存在同源暴发或直接人际传播的情况下，这一假设就会被违反，因为一个感染病例会增加附近其他人的风险。感染预防与控制的实践目的就是为了最小化这种依赖性，并维持事件的独立性。\n\n3.  **事件的稀有性：** 在任何无穷小的人-时区间内，发生多于一个事件的概率是微不足道的（比区间长度更快地趋近于零）。这是泊松过程的一个基本性质。对于HAI这种相对稀有的事件（此处发生率为每患者-日0.002例），这个条件通常是满足的。在同一个无穷小的瞬间记录到两个不同的HAI是极不可能的。\n\n4.  **非信息性删失：** 患者贡献人-时，直到他们发生HAI（事件）或被删失。当患者的随访因研究事件之外的原因结束时，就会发生删失，例如从ICU出院、因其他原因死亡或研究期行政性终止。如果删失的原因与患者发生HAI的潜在风险在统计上是独立的，则称删失为“非信息性的”。例如，如果病情危重（因此有更高HAI风险）的患者更有可能死于其基础疾病（一个删失事件），那么这种删失就是信息性的，由此产生的发病密度可能会低估仍在风险中的人群的真实风险率。我们计算出的率的有效性，取决于出院、因非HAI原因死亡或到达研究终点这些情况不依赖于发生HAI的潜在倾向这一假设。\n\n总之，计算出发病密度为每$1,000$个患者-日$2.000$例感染，是一个直接的经验总结。将其解释为一个随机过程的基本、恒定风险率的估计值，则有赖于平稳性、独立性、事件稀有性和非信息性删失这些假设，而这些正是使用泊松过程对此类计数数据进行建模的基石。", "answer": "$$\n\\boxed{2.000}\n$$", "id": "4647335"}, {"introduction": "有效的感染预防策略，如隔离措施，通常依赖于准确的筛查来识别定植或感染的患者。本练习将引导您运用贝叶斯定理，从一个假设的耐甲氧西林金黄色葡萄球菌（MRSA）筛查场景出发，推导并计算阳性预测值（$PPV$）和阴性预测值（$NPV$）[@problem_id:4647313]。掌握这项技能使您能够评估筛查测试在特定人群中的实际应用效果，并理解为何测试的表观性能会受到疾病患病率的显著影响。", "problem": "一家医院对重症监护室（ICU）新入院的患者实施耐甲氧西林金黄色葡萄球菌（MRSA）的通用鼻腔筛查。考虑一个用于MRSA定植的二元筛查测试，该测试具有特定的灵敏度、特异性以及该ICU人群中先验的定植患病率。设 $Se$ 表示灵敏度，$Sp$ 表示特异性，$Prev$ 表示入院时的定植患病率。阳性预测值（$PPV$）是在测试结果为阳性的条件下，患者确实定植的概率；阴性预测值（$NPV$）是在测试结果为阴性的条件下，患者确实未定植的概率。\n\n仅使用 $Se$、$Sp$ 和 $Prev$ 的形式化定义，结合概率公理（包括全概率公式和贝叶斯法则），首先推导出用 $Se$、$Sp$ 和 $Prev$ 表示 $PPV$ 和 $NPV$ 的表达式。然后在一个 $Se=0.85$，$Sp=0.95$，$Prev=0.12$ 的ICU中计算这些值。\n\n将每个最终数值四舍五入到四位有效数字。不要使用百分号；以小数形式表示结果。按顺序以有序对 $\\big(PPV, NPV\\big)$ 的形式提供您的最终答案。", "solution": "该问题陈述是有效的，因为它在科学上基于流行病学和生物统计学的原理，问题提出得当、客观且内部一致。它提供了推导和计算所需值的所有必要数据。\n\n让我们定义以下事件：\n- $D$：患者确实定植了耐甲氧西林金黄色葡萄球菌（MRSA）的事件。\n- $D^c$：患者未定植MRSA的事件。\n- $T^+$：筛查测试结果为阳性的事件。\n- $T^-$：筛查测试结果为阴性的事件。\n\n给定条件可以形式化地表示为概率：\n- 患病率，$Prev = P(D)$。根据概率公理，未定植的概率为 $P(D^c) = 1 - P(D) = 1 - Prev$。\n- 灵敏度，$Se = P(T^+ | D)$。这是在患者已定植的条件下，测试结果为阳性的条件概率（真阳性率）。\n- 特异性，$Sp = P(T^- | D^c)$。这是在患者未定植的条件下，测试结果为阴性的条件概率（真阴性率）。\n\n根据这些定义，我们还可以定义不正确测试结果的概率：\n- 假阴性率是 $P(T^- | D) = 1 - P(T^+ | D) = 1 - Se$。\n- 假阳性率是 $P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp$。\n\n目标是推导阳性预测值（$PPV$）和阴性预测值（$NPV$）的表达式。\n\n首先，我们推导 $PPV$ 的表达式。根据定义，$PPV$ 是在测试结果为阳性的条件下，患者已定植的概率，即 $P(D | T^+)$。使用贝叶斯法则：\n$$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n分母 $P(T^+)$ 是获得阳性测试结果的总概率。我们可以使用全概率公式，对互斥事件 $D$ 和 $D^c$求和来找到这个值：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n代入给定项和推导出的假阳性率：\n$$P(T^+) = (Se)(Prev) + (1 - Sp)(1 - Prev)$$\n现在，将这个 $P(T^+)$ 的表达式代回 $PPV$ 的方程中：\n$$PPV = \\frac{Se \\cdot Prev}{Se \\cdot Prev + (1 - Sp)(1 - Prev)}$$\n这是用 $Se$、$Sp$ 和 $Prev$ 表示 $PPV$ 的通用公式。\n\n接下来，我们推导 $NPV$ 的表达式。根据定义，$NPV$ 是在测试结果为阴性的条件下，患者未定植的概率，即 $P(D^c | T^-)$。使用贝叶斯法则：\n$$NPV = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}$$\n分母 $P(T^-)$ 是获得阴性测试结果的总概率。使用全概率公式：\n$$P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)$$\n代入给定项和推导出的假阴性率：\n$$P(T^-) = (Sp)(1 - Prev) + (1 - Se)(Prev)$$\n现在，将这个 $P(T^-)$ 的表达式代回 $NPV$ 的方程中：\n$$NPV = \\frac{Sp \\cdot (1 - Prev)}{Sp \\cdot (1 - Prev) + (1 - Se) \\cdot Prev}$$\n这是用 $Se$、$Sp$ 和 $Prev$ 表示 $NPV$ 的通用公式。\n\n现在，我们使用提供的数值来计算这些表达式：\n- $Se = 0.85$\n- $Sp = 0.95$\n- $Prev = 0.12$\n\n计算 $PPV$：\n$$PPV = \\frac{0.85 \\cdot 0.12}{0.85 \\cdot 0.12 + (1 - 0.95)(1 - 0.12)}$$\n$$PPV = \\frac{0.102}{0.102 + (0.05)(0.88)}$$\n$$PPV = \\frac{0.102}{0.102 + 0.044}$$\n$$PPV = \\frac{0.102}{0.146} \\approx 0.6986301...$$\n四舍五入到四位有效数字，$PPV = 0.6986$。\n\n计算 $NPV$：\n$$NPV = \\frac{0.95 \\cdot (1 - 0.12)}{0.95 \\cdot (1 - 0.12) + (1 - 0.85) \\cdot 0.12}$$\n$$NPV = \\frac{0.95 \\cdot 0.88}{0.95 \\cdot 0.88 + (0.15) \\cdot 0.12}$$\n$$NPV = \\frac{0.836}{0.836 + 0.018}$$\n$$NPV = \\frac{0.836}{0.854} \\approx 0.9789227...$$\n四舍五入到四位有效数字，$NPV = 0.9789$。\n\n最终答案是有序对 $(PPV, NPV)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6986  0.9789\n\\end{pmatrix}\n}\n$$", "id": "4647313"}, {"introduction": "在真实的医院环境中，患者同时面临多种互斥的事件风险，例如发生感染或出院。本练习引入了竞争风险分析这一高级但至关重要的概念，它要求您推导在存在出院这一竞争性事件时，感染的累积发生率函数 [@problem_id:4647339]。通过这项实践，您将理解为何传统的生存分析方法（如将出院视为删失的Kaplan-Meier方法）会高估感染风险，并学会如何在这种复杂情境下获得对事件概率的无偏估计。", "problem": "在一个具有标准化感染预防方案的普通医疗病房中，考虑一个住院患者队列，他们可能发生两种相互排斥的事件类型：院内感染和未感染出院。假设这些事件的发生机制满足生存分析中风险函数和生存函数的标准定义，并且特定原因风险率随时间保持不变。设出院的恒定特定原因风险为 $\\lambda_{D} = 0.2$ /天，感染的恒定特定原因风险为 $\\lambda_{I} = 0.05$ /天。仅使用基于风险和生存定义的第一性原理推理，推导出一个解析表达式，用于计算在出院作为竞争风险并将患者永久移出感染风险人群的情况下，患者在时间 $t$ 前发生感染的累积概率。然后，计算该表达式在 $t = 7$ 天时的值。此外，从概念和数学上解释为什么 Kaplan–Meier (KM) 方法在这种情况下将出院视为右删失时，会高估感染风险。以小数形式提供截至第7天的最终累积感染发生率，四舍五入到四位有效数字，不要包含百分号或任何单位。", "solution": "该问题是有效的。这是一个在生存分析领域，特别是关于竞争风险主题的适定问题，它具有科学依据，并且可以使用既定原则进行形式化求解。\n\n求解过程包括三个部分：\n1.  从第一性原理推导感染的累积发生函数 (CIF)。\n2.  计算该函数在时间 $t=7$ 天时的值。\n3.  解释为什么将出院视为删失的 Kaplan-Meier (KM) 方法会导致风险的高估。\n\n设 $T$ 为到第一个事件（感染或出院）发生时间的随机变量，设 $J$ 为事件类型，其中 $J \\in \\{I, D\\}$ 分别代表感染和出院。\n\n在时间 $t$ 时，类型为 $k$ 的事件的特定原因风险率 $\\lambda_k(t)$ 定义为，在受试者直到时间 $t$ 仍未发生任何事件的条件下，在时间 $t$ 发生事件 $k$ 的瞬时速率。\n$$\n\\lambda_k(t) = \\lim_{\\Delta t \\to 0} \\frac{P(t \\le T  t+\\Delta t, J=k | T \\ge t)}{\\Delta t}\n$$\n在这个问题中，特定原因风险率被设定为常数：\n-   感染的特定原因风险：$\\lambda_I(t) = \\lambda_I = 0.05 \\text{ day}^{-1}$。\n-   出院的特定原因风险：$\\lambda_D(t) = \\lambda_D = 0.2 \\text{ day}^{-1}$。\n\n在时间 $t$ 经历任何事件的总风险 $\\lambda(t)$ 是所有相互排斥事件的特定原因风险率之和。\n$$\n\\lambda(t) = \\lambda_I(t) + \\lambda_D(t) = \\lambda_I + \\lambda_D\n$$\n代入给定值，总风险为 $\\lambda = 0.05 + 0.2 = 0.25 \\text{ day}^{-1}$。\n\n总生存函数 $S(t)$ 是直到时间 $t$ 仍未发生任何事件（即既未感染也未出院）的概率。它与总风险函数的关系如下：\n$$\nS(t) = P(T  t) = \\exp\\left(-\\int_0^t \\lambda(u) du\\right)\n$$\n由于总风险 $\\lambda$ 是常数，这可以简化为：\n$$\nS(t) = \\exp(-\\lambda t) = \\exp(-(\\lambda_I + \\lambda_D)t)\n$$\n\n感染的累积发生函数 (CIF)，记作 $I_I(t)$，是患者在时间 $t$ 前发生感染的概率。它通过对感染的特定原因风险率随时间积分得到，并由每个时间点上处于风险中的概率进行加权。在时间 $u$ 处于风险中的概率是总生存概率 $S(u)$。\n$$\nI_I(t) = P(T \\le t, J=I) = \\int_0^t \\lambda_I(u) S(u) du\n$$\n代入常数风险 $\\lambda_I$ 和总生存函数 $S(u)$ 的表达式：\n$$\nI_I(t) = \\int_0^t \\lambda_I \\exp(-(\\lambda_I + \\lambda_D)u) du\n$$\n由于 $\\lambda_I$ 是一个常数，可以移到积分号外：\n$$\nI_I(t) = \\lambda_I \\int_0^t \\exp(-(\\lambda_I + \\lambda_D)u) du\n$$\n现在我们计算积分：\n$$\nI_I(t) = \\lambda_I \\left[ -\\frac{1}{\\lambda_I + \\lambda_D} \\exp(-(\\lambda_I + \\lambda_D)u) \\right]_0^t\n$$\n$$\nI_I(t) = \\lambda_I \\left( \\left( -\\frac{1}{\\lambda_I + \\lambda_D} \\exp(-(\\lambda_I + \\lambda_D)t) \\right) - \\left( -\\frac{1}{\\lambda_I + \\lambda_D} \\exp(0) \\right) \\right)\n$$\n$$\nI_I(t) = \\frac{\\lambda_I}{\\lambda_I + \\lambda_D} \\left( 1 - \\exp(-(\\lambda_I + \\lambda_D)t) \\right)\n$$\n这就是在存在出院这一竞争风险的情况下，感染累积概率的解析表达式。\n\n现在，我们用给定的风险率计算该表达式在 $t = 7$ 天时的值：\n$$\nI_I(7) = \\frac{0.05}{0.05 + 0.2} \\left( 1 - \\exp(-(0.05 + 0.2) \\times 7) \\right)\n$$\n$$\nI_I(7) = \\frac{0.05}{0.25} \\left( 1 - \\exp(-0.25 \\times 7) \\right)\n$$\n$$\nI_I(7) = 0.2 \\left( 1 - \\exp(-1.75) \\right)\n$$\n为了获得数值：\n$$\n\\exp(-1.75) \\approx 0.1737741\n$$\n$$\nI_I(7) \\approx 0.2 \\left( 1 - 0.1737741 \\right) = 0.2 \\left( 0.8262259 \\right) \\approx 0.16524518\n$$\n四舍五入到四位有效数字，截至第7天的累积感染发生率为 $0.1652$。\n\n最后，我们解释为什么当将出院视为右删失时，Kaplan-Meier (KM) 方法会高估感染风险。\n\n从概念上讲，KM 方法依赖于非信息性删失的假设。该假设意味着在特定时间被删失的受试者，其对于目标事件的未来风险状况必须与仍在研究中的受试者相同。在这个问题中，将出院视为删失违反了这一假设。出院的患者被永久地移出医院环境，因此他们获得*院内*感染的风险降至零。这与仍在医院的患者的未来风险有着根本的不同。因此，删失事件（出院）对于未来的感染风险是信息性的。KM 估计器错误地假设出院患者的风险被重新分配给其余患者，实际上在统计意义上将他们保留在风险池中，而现实中他们已不再处于风险之中。这会随着时间的推移夸大风险人群的分母，从而导致对事件概率的高估。\n\n在数学上，用于“免于感染的生存”（将出院视为删失）的 KM 估计器将估计在一个假设世界中的生存函数 $S_{KM,I}(t)$，在这个世界里，出院不会将人们从感染风险中移除。量 $1 - S_{KM,I}(t)$ 估计的是在一个唯一可能发生的事件就是感染的世界里的感染概率。对于恒定的风险率 $\\lambda_I$，这由以下公式给出：\n$$\nP_{KM}(t) = 1 - S_{KM,I}(t) = 1 - \\exp\\left(-\\int_0^t \\lambda_I(u) du\\right) = 1 - \\exp(-\\lambda_I t)\n$$\n让我们计算其在 $t=7$ 天时的值：\n$$\nP_{KM}(7) = 1 - \\exp(-0.05 \\times 7) = 1 - \\exp(-0.35) \\approx 1 - 0.704688 = 0.295312\n$$\n基于 KM 的估计值 $0.2953$ 远高于正确的 CIF 值 $0.1652$。出现高估的原因是 KM 计算 $1 - \\exp(-\\lambda_I t)$ 没有考虑到实际风险人群因出院这一竞争事件而减少。真实 CIF 计算中的分母 $\\lambda_I + \\lambda_D$ 大于基于 KM 方法中的隐式分母 $\\lambda_I$。正确的 CIF 公式 $I_I(t) = \\int_0^t \\lambda_I \\exp(-(\\lambda_I + \\lambda_D)u) du$ 正确地使用了总生存函数 $S(u) = \\exp(-(\\lambda_I + \\lambda_D)u)$，该函数恰当地解释了因*两种*事件而将受试者从风险池中移除的情况。项 $\\exp(-(\\lambda_I + \\lambda_D)u)$ 总是小于或等于 $\\exp(-\\lambda_I u)$，这意味着真实的风险人群比 KM 方法假设的收缩得更快，从而导致更低的真实累积发生率。", "answer": "$$\\boxed{0.1652}$$", "id": "4647339"}]}