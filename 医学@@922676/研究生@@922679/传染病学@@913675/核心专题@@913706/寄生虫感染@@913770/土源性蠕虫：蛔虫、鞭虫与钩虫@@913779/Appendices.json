{"hands_on_practices": [{"introduction": "理解寄生虫感染如何导致疾病是公共卫生干预的基础。本练习通过一个直接的计算，将钩虫的感染强度（即蠕虫负荷）与一个关键的临床后果——缺铁性贫血联系起来。通过推导每日铁流失量，你将亲身体会到量化方法在评估寄生虫病理负担中的力量和精确性 [@problem_id:4692667]。", "problem": "一个钩虫种群以宿主肠道血液为食，从而导致铁流失。考虑物种 Necator americanus。假设宿主的全血铁浓度约为 $0.5 \\, \\text{mg Fe/mL}$，该值基于成年人血液的平均血红蛋白含量和每个血红素基团的含铁量。假设每条 Necator americanus 蠕虫通过摄食和在摄食部位的血液渗漏，每日从宿主处移除的血量为 $\\ell = 0.03\\,\\mathrm{mL/day}$，并且在咬伤部位被破坏的红细胞（RBC）中的铁在肠腔内的回收量可忽略不计。从浓度定义 $c_{\\mathrm{Fe}} = m_{\\mathrm{Fe}}/V$ 和应用于每日容积性失血的质量守恒定律出发，推导每日铁流失量 $I$ 作为蠕虫负荷 $n$、每条蠕虫每日失血量 $\\ell$ 和血铁浓度 $c_{\\mathrm{Fe}}$ 的函数的解析表达式。然后，使用 $n = 200$、$\\ell = 0.03\\,\\mathrm{mL/day}$ 和 $c_{\\mathrm{Fe}} = 0.5\\,\\mathrm{mg/mL}$ 对该表达式求值。以 $\\text{mg Fe/day}$ 为单位表示最终的铁流失量，并将您的数值答案四舍五入到三位有效数字。", "solution": "该问题要求推导一个关于钩虫感染宿主每日铁流失量 $I$ 的解析表达式，然后对该表达式进行数值计算。推导将基于所给的浓度定义和质量守恒原理。\n\n首先，我们建立质量、体积和浓度之间的关系。血液中的铁浓度 $c_{\\mathrm{Fe}}$ 定义为每单位血容量 $V$ 中的铁质量 $m_{\\mathrm{Fe}}$。用数学方式表示为：\n$$c_{\\mathrm{Fe}} = \\frac{m_{\\mathrm{Fe}}}{V}$$\n这个方程可以通过代数变换来求解特定血容量中所含的铁质量：\n$$m_{\\mathrm{Fe}} = c_{\\mathrm{Fe}} \\cdot V$$\n根据质量守恒原理，在铁回收可忽略不计的假设下，每日流失的铁质量必须等于每日总失血量中所含的铁质量。\n\n每日总失血量是蠕虫数量（蠕虫负荷）$n$ 和平均每条蠕虫每日失血量 $\\ell$ 的函数。如果有 $n$ 条蠕虫，每条蠕虫导致 $\\ell$ 的失血量，那么每日总失血量，我们记为 $V_{\\text{daily}}$，是这两个量的乘积：\n$$V_{\\text{daily}} = n \\cdot \\ell$$\n每日铁流失量 $I$ 是该体积 $V_{\\text{daily}}$ 中所含的铁质量。使用变换后的浓度公式，我们可以将 $I$ 表示为：\n$$I = c_{\\mathrm{Fe}} \\cdot V_{\\text{daily}}$$\n将 $V_{\\text{daily}}$ 的表达式代入此方程，我们得到每日铁流失量作为给定参数函数的最终解析表达式：\n$$I = n \\cdot \\ell \\cdot c_{\\mathrm{Fe}}$$\n这就是所求的解析表达式。我们可以验证该公式的量纲一致性。$n$ 的单位是无量纲的（蠕虫），$\\ell$ 的单位是 $\\mathrm{mL/day}$，$c_{\\mathrm{Fe}}$ 的单位是 $\\mathrm{mg/mL}$。单位的乘积为：\n$$(\\text{dimensionless}) \\times \\left(\\frac{\\mathrm{mL}}{\\mathrm{day}}\\right) \\times \\left(\\frac{\\mathrm{mg}}{\\mathrm{mL}}\\right) = \\frac{\\mathrm{mg}}{\\mathrm{day}}$$\n该结果具有每日质量流失的正确单位，证实了所推导表达式的有效性。\n\n接下来，我们使用问题陈述中提供的数值来计算该表达式：\n蠕虫负荷，$n = 200$。\n每条蠕虫每日失血量，$\\ell = 0.03\\,\\mathrm{mL/day}$。\n血铁浓度，$c_{\\mathrm{Fe}} = 0.5\\,\\mathrm{mg/mL}$。\n\n将这些值代入推导出的 $I$ 方程中：\n$$I = (200) \\cdot (0.03\\,\\mathrm{mL/day}) \\cdot (0.5\\,\\mathrm{mg/mL})$$\n现在我们可以进行算术计算：\n$$I = (200 \\cdot 0.03 \\cdot 0.5) \\, \\mathrm{mg/day}$$\n$$I = (6 \\cdot 0.5) \\, \\mathrm{mg/day}$$\n$$I = 3 \\, \\mathrm{mg/day}$$\n问题要求最终答案用三位有效数字表示。计算值恰好为 $3$。为了以指定的精度表示该值，我们将其写为 $3.00$。因此，每日铁流失量为 $3.00 \\, \\text{mg Fe/day}$。", "answer": "$$\\boxed{3.00}$$", "id": "4692667"}, {"introduction": "土源性蠕虫的传播并非仅仅取决于蠕虫的总数，还取决于它们在宿主群体中的分布以及繁殖配对的成功率。本练习将引导你探索蠕虫负荷高度聚集的现象（通常用负二项分布描述）及其对繁殖的影响。通过推导宿主拥有至少一个“配对”的概率，你将掌握分析蠕虫繁殖成功率这一核心概念，它是所有现代蠕虫传播模型的基石 [@problem_id:4692663]。", "problem": "对于土源性蠕虫，如 Ascaris lumbricoides（蛔虫）、Trichuris trichiura（鞭虫）和钩虫，宿主内的成虫仅在宿主体内同时存在至少一只雄性和一只雌性时才会形成交配对。宿主间的经验性蠕虫负荷呈高度聚集分布，并且可以由泊松-伽马混合产生的负二项分布很好地描述。具体来说，假设以下机理基础：\n\n1. 令随机变量 $N$ 表示宿主体内的蠕虫数量。在给定单个宿主的暴露-定植率 $\\Lambda$ 的条件下，蠕虫数量为 $N \\mid \\Lambda \\sim \\mathrm{Poisson}(\\Lambda)$。\n2. 在不同宿主之间，$\\Lambda$ 的异质性由 $\\Lambda \\sim \\mathrm{Gamma}(k,\\theta)$ 建模，其中形状参数 $k0$，尺度参数 $\\theta0$，平均蠕虫负荷为 $\\mathrm{E}[N]=\\mathrm{E}[\\Lambda]=m0$。因此 $\\theta$ 满足 $\\theta = m/k$。\n3. 每条蠕虫成为雄性或雌性的概率各自独立为 $1/2$，且蠕虫之间以及宿主之间均相互独立。\n\n在宿主层面，将“交配对”定义为宿主同时携带至少一只雄性蠕虫和至少一只雌性蠕虫的事件。从上述机理基础出发，仅使用关于泊松分布、伽马分布和概率生成函数（PGF）的标准知识，推导出一个闭式解析表达式，该表达式表示拥有至少一个交配对的宿主比例，并将其作为平均蠕虫负荷 $m$ 和聚集参数 $k$ 的函数。\n\n你的最终答案必须是仅含 $m$ 和 $k$ 的单一闭式表达式。不需要进行数值近似或四舍五入。将该比例表示为一个无量纲的概率（即一个在 $[0,1]$ 区间内的实数）。", "solution": "令 $P_{pair}$ 表示拥有至少一个交配对的宿主比例。这是随机选择的宿主包含至少一只雄性蠕虫和至少一只雌性蠕虫的概率。令 $N_M$ 为雄性蠕虫数量的随机变量，$N_F$ 为雌性蠕虫数量的随机变量。总蠕虫数为 $N = N_M + N_F$。我们希望计算 $P_{pair} = P(N_M \\ge 1 \\text{ and } N_F \\ge 1)$。\n\n计算补事件的概率更方便，即不存在交配对的事件。当宿主要么没有雄性蠕虫（$N_M=0$），要么没有雌性蠕虫（$N_F=0$）时，就会发生这种情况。\n$$ P_{pair} = 1 - P(N_M = 0 \\text{ or } N_F = 0) $$\n使用概率的容斥原理，我们有：\n$$ P(N_M = 0 \\text{ or } N_F = 0) = P(N_M = 0) + P(N_F = 0) - P(N_M = 0 \\text{ and } N_F = 0) $$\n事件 $\\{N_M = 0 \\text{ and } N_F = 0\\}$ 等价于总蠕虫数为零的事件 $\\{N=0\\}$。由于性别比例的对称性（雄性概率 $1/2$，雌性概率 $1/2$），$N_M$ 和 $N_F$ 的边际分布是相同的。因此，$P(N_M = 0) = P(N_F = 0)$。\n将这些代入 $P_{pair}$ 的表达式中：\n$$ P_{pair} = 1 - \\left[ 2P(N_M = 0) - P(N = 0) \\right] $$\n我们的任务现在是求概率 $P(N=0)$ 和 $P(N_M=0)$。我们将按建议使用概率生成函数（PGF）方法。离散随机变量 $X$ 的 PGF 定义为 $G_X(z) = E[z^X]$。概率 $P(X=0)$ 可以通过在 $z=0$ 处评估 PGF 得到，即 $P(X=0) = G_X(0)$。\n\n首先，我们推导总蠕虫数 $N$ 的 PGF。$N$ 的分布是泊松-伽马混合。\n在给定 $\\Lambda$ 的条件下，$N \\sim \\mathrm{Poisson}(\\Lambda)$，所以其 PGF 为 $G_{N|\\Lambda}(z) = E[z^N|\\Lambda] = \\exp(\\Lambda(z-1))$。\n$N$ 的无条件 PGF 是通过对 $G_{N|\\Lambda}(z)$ 在 $\\Lambda$ 的分布（即 $\\Lambda \\sim \\mathrm{Gamma}(k, \\theta)$）上求期望得到的。\n$$ G_N(z) = E[G_{N|\\Lambda}(z)] = E[\\exp(\\Lambda(z-1))] $$\n这个期望是伽马分布的矩生成函数（MGF）$M_{\\Lambda}(t) = E[\\exp(\\Lambda t)]$ 在 $t = z-1$ 处的值。$\\mathrm{Gamma}(k, \\theta)$ 分布的 MGF 是 $M_{\\Lambda}(t) = (1 - \\theta t)^{-k}$。\n因此，$N$ 的 PGF 是：\n$$ G_N(z) = M_{\\Lambda}(z-1) = (1 - \\theta(z-1))^{-k} = (1 + \\theta - \\theta z)^{-k} $$\n这是负二项分布的 PGF。由此，我们可以求得 $P(N=0)$：\n$$ P(N=0) = G_N(0) = (1 + \\theta - \\theta \\cdot 0)^{-k} = (1+\\theta)^{-k} $$\n接下来，我们推导雄性蠕虫数量 $N_M$ 的 PGF。雄性蠕虫的数量是“稀疏化”过程的结果。对于给定的总蠕虫数 $N=n$，每条蠕虫是雄性的独立概率为 $p=1/2$。这种问题结构意味着 $N_M$ 的 PGF 可以通过将 $N$ 的 PGF 与性别决定的伯努利试验的 PGF 进行复合得到。\n令 $B \\sim \\mathrm{Bernoulli}(1/2)$ 为单条蠕虫是雄性的指示变量。其 PGF 是 $G_B(z) = E[z^B] = (1-1/2)z^0 + (1/2)z^1 = \\frac{1}{2} + \\frac{1}{2}z = \\frac{1+z}{2}$。\n$N_M$ 的 PGF 由复合函数 $G_{N_M}(z) = G_N(G_B(z))$ 给出：\n$$ G_{N_M}(z) = G_N\\left(\\frac{1+z}{2}\\right) = \\left(1 + \\theta - \\theta\\left(\\frac{1+z}{2}\\right)\\right)^{-k} $$\n化简括号内的表达式：\n$$ 1 + \\theta - \\frac{\\theta}{2} - \\frac{\\theta z}{2} = 1 + \\frac{\\theta}{2} - \\frac{\\theta z}{2} $$\n所以，$N_M$ 的 PGF 是：\n$$ G_{N_M}(z) = \\left(1 + \\frac{\\theta}{2} - \\frac{\\theta z}{2}\\right)^{-k} $$\n由此，我们可以求得 $P(N_M=0)$：\n$$ P(N_M=0) = G_{N_M}(0) = \\left(1 + \\frac{\\theta}{2} - 0\\right)^{-k} = \\left(1 + \\frac{\\theta}{2}\\right)^{-k} $$\n现在我们将 $P(N=0)$ 和 $P(N_M=0)$ 的表达式代回到 $P_{pair}$ 的公式中：\n$$ P_{pair} = 1 - \\left[ 2\\left(1 + \\frac{\\theta}{2}\\right)^{-k} - (1+\\theta)^{-k} \\right] $$\n最后一步是用平均蠕虫负荷 $m$ 和聚集参数 $k$ 来表示结果。我们已知关系式 $\\theta = m/k$。将其代入表达式中：\n$$ P_{pair} = 1 - \\left[ 2\\left(1 + \\frac{m/k}{2}\\right)^{-k} - \\left(1 + \\frac{m}{k}\\right)^{-k} \\right] $$\n$$ P_{pair} = 1 - 2\\left(1 + \\frac{m}{2k}\\right)^{-k} + \\left(1 + \\frac{m}{k}\\right)^{-k} $$\n这就是拥有至少一个交配对的宿主比例的闭式解析表达式。", "answer": "$$ \\boxed{1 - 2\\left(1 + \\frac{m}{2k}\\right)^{-k} + \\left(1 + \\frac{m}{k}\\right)^{-k}} $$", "id": "4692663"}, {"introduction": "为了设计有效的控制策略，我们必须理解整个传播循环的动态过程。数学模型是整合寄生虫生物学、环境因素和宿主行为，并预测干预效果的强大工具。在本练习中，你将构建一个描述土源性蠕虫传播的基本动力学模型，并求解其地方性流行平衡点，从而理解决定感染长期持续水平的关键参数 [@problem_id:4692696]。", "problem": "考虑土源性蠕虫（STH），特别是蛔虫、鞭虫和钩虫，其大型寄生虫生活史可概括如下：人类宿主体内的成虫产生虫卵或幼虫，这些虫卵或幼虫进入并在环境中累积；宿主随后获得这些环境中的感染阶段，从而建立新的成虫种群。设状态变量为宿主平均蠕虫负荷 $W$（每宿主蠕虫数）和环境感染阶段密度 $E$（每单位暴露的感染阶段数）。\n\n使用以下基于传染病动力学的基本依据：\n\n- 成虫以人均速率 $\\mu$ (time$^{-1}$) 死亡。\n- 由于衰变、移除或失活，环境感染阶段以人均速率 $\\delta$ (time$^{-1}$) 消失。\n- 宿主获得新蠕虫的速率与环境感染阶段密度成正比，比例常数为 $\\beta$（每单位时间每单位感染阶段密度每宿主的蠕虫数），该常数代表暴露接触、每次接触的定植概率以及成熟为成虫的过程。\n- 由于拥挤和交配限制，每条蠕虫的繁殖力表现出负密度依赖性；通过每条蠕虫的产卵量随平均蠕虫负荷呈指数下降来对此建模，因此每条蠕虫的繁殖力为 $\\phi_{0}\\exp(-\\gamma W)$，其中 $\\phi_{0}$（每单位时间每条蠕虫的感染阶段数）是最大繁殖力，$\\gamma$（每条蠕虫）量化了拥挤效应的强度。\n\n任务：\n\n1. 从这些定义和大型寄生虫生活史出发，使用常微分方程写出一个关于 $(W,E)$ 的最小确定性连续时间模型，该模型应体现宿主通过质量作用定律获得蠕虫以及密度依赖性繁殖力对环境输入的调节。\n2. 假设存在一个非平凡的地方性平衡点，满足 $W^{\\ast}  0$ 和 $E^{\\ast}  0$，请推导地方性平衡时的平均蠕虫负荷 $W^{\\ast}$ 关于模型参数 $\\beta$、$\\mu$、$\\phi_{0}$、$\\delta$ 和 $\\gamma$ 的闭式表达式。将最终答案表示为单个解析表达式。平均蠕虫负荷 $W^{\\ast}$ 是一个无量纲计数（每宿主蠕虫数）；无需进行数值四舍五入。", "solution": "该任务分为两部分：首先，构建描述平均宿主蠕虫负荷 $W$ 和环境感染阶段密度 $E$ 动力学的常微分方程组（ODEs）；其次，求解地方性平衡时的平均蠕虫负荷值 $W^{\\ast}$。\n\n**第1部分：确定性模型的构建**\n\n我们通过考虑每个状态变量 $W$ 和 $E$ 的变化率来构建模型，这些变化率基于问题中描述的流入和流出原则。\n\n平均宿主蠕虫负荷的变化率 $\\frac{dW}{dt}$ 是新蠕虫的获得速率减去现有成虫的死亡速率。\n- **流入（获得）：** 问题陈述宿主获得新蠕虫的速率与环境感染阶段密度 $E$ 成正比。比例常数给定为 $\\beta$。因此，获得速率为 $\\beta E$。\n- **流出（死亡）：** 成虫以人均速率 $\\mu$ 死亡。对于平均蠕虫负荷 $W$，总死亡速率为 $\\mu W$。\n\n综合这些项，得到 $W$ 的微分方程为：\n$$ \\frac{dW}{dt} = \\beta E - \\mu W $$\n\n环境感染阶段密度的变化率 $\\frac{dE}{dt}$ 是成虫产生新感染阶段的速率减去这些阶段从环境中消失的速率。\n- **流入（产生）：** 新的感染阶段（虫卵或幼虫）由成虫产生。总产生速率是平均蠕虫负荷 $W$ 与每条蠕虫繁殖力的乘积。每条蠕虫的繁殖力被给定为一个密度依赖函数 $\\phi_{0}\\exp(-\\gamma W)$，其中 $\\phi_{0}$ 是最大繁殖力，$\\gamma$ 量化了密度依赖性限制的强度。因此，每个平均宿主产生感染阶段的总速率为 $W \\phi_{0}\\exp(-\\gamma W)$。该项是环境库 $E$ 的来源。\n- **流出（消失）：** 环境感染阶段以人均速率 $\\delta$ 消失（例如，通过衰变或失活）。对于密度 $E$，总消失速率为 $\\delta E$。\n\n综合这些项，得到 $E$ 的微分方程为：\n$$ \\frac{dE}{dt} = \\phi_{0} W \\exp(-\\gamma W) - \\delta E $$\n\n描述 $(W, E)$ 耦合动力学的完整确定性连续时间模型是以下由两个常微分方程组成的方程组：\n$$ \\frac{dW}{dt} = \\beta E - \\mu W $$\n$$ \\frac{dE}{dt} = \\phi_{0} W \\exp(-\\gamma W) - \\delta E $$\n\n**第2部分：地方性平衡时蠕虫负荷（$W^{\\ast}$）的推导**\n\n地方性平衡是一个稳态，此时蠕虫和感染阶段的种群数量为非零且不随时间变化。这对应于系统的非平凡不动点 $(W^{\\ast}, E^{\\ast})$，其中 $W^{\\ast}  0$ 且 $E^{\\ast}  0$。在平衡状态下，变化率为零：\n$$ \\frac{dW}{dt} = 0 $$\n$$ \\frac{dE}{dt} = 0 $$\n\n这给了我们一个包含两个代数方程的方程组：\n1.  $\\beta E^{\\ast} - \\mu W^{\\ast} = 0$\n2.  $\\phi_{0} W^{\\ast} \\exp(-\\gamma W^{\\ast}) - \\delta E^{\\ast} = 0$\n\n从方程（1）中，我们可以用平衡时的蠕虫负荷 $W^{\\ast}$ 来表示平衡时的环境密度 $E^{\\ast}$。由于我们假设一个非平凡平衡点，其中 $W^{\\ast}0$，我们可以确定简单的代数操作是有效的。\n$$ \\beta E^{\\ast} = \\mu W^{\\ast} $$\n$$ E^{\\ast} = \\frac{\\mu}{\\beta} W^{\\ast} \\quad (*)$$\n\n这种关系表明，在平衡状态下，环境中的感染阶段密度与宿主种群的平均蠕虫负荷成正比。\n\n接下来，我们将 $E^{\\ast}$ 的这个表达式代入方程（2）：\n$$ \\phi_{0} W^{\\ast} \\exp(-\\gamma W^{\\ast}) - \\delta \\left( \\frac{\\mu}{\\beta} W^{\\ast} \\right) = 0 $$\n\n问题陈述我们关心的是非平凡平衡点，其中 $W^{\\ast}  0$。因此，我们可以安全地将整个方程除以 $W^{\\ast}$ 而不会丢失我们感兴趣的解：\n$$ \\phi_{0} \\exp(-\\gamma W^{\\ast}) - \\frac{\\delta \\mu}{\\beta} = 0 $$\n\n现在，我们的目标是解出这个方程中的 $W^{\\ast}$。我们首先分离指数项：\n$$ \\phi_{0} \\exp(-\\gamma W^{\\ast}) = \\frac{\\delta \\mu}{\\beta} $$\n$$ \\exp(-\\gamma W^{\\ast}) = \\frac{\\delta \\mu}{\\beta \\phi_{0}} $$\n\n为了解出 $W^{\\ast}$，我们对等式两边取自然对数（$\\ln$）：\n$$ \\ln\\left(\\exp(-\\gamma W^{\\ast})\\right) = \\ln\\left(\\frac{\\delta \\mu}{\\beta \\phi_{0}}\\right) $$\n$$ -\\gamma W^{\\ast} = \\ln\\left(\\frac{\\delta \\mu}{\\beta \\phi_{0}}\\right) $$\n\n最后，我们通过除以 $-\\gamma$ 来分离出 $W^{\\ast}$：\n$$ W^{\\ast} = -\\frac{1}{\\gamma} \\ln\\left(\\frac{\\delta \\mu}{\\beta \\phi_{0}}\\right) $$\n\n使用对数恒等式 $\\ln(x^{-1}) = -\\ln(x)$，我们可以通过对对数的参数取倒数，将表达式重写为更常规的形式：\n$$ W^{\\ast} = \\frac{1}{\\gamma} \\ln\\left(\\left(\\frac{\\delta \\mu}{\\beta \\phi_{0}}\\right)^{-1}\\right) $$\n$$ W^{\\ast} = \\frac{1}{\\gamma} \\ln\\left(\\frac{\\beta \\phi_{0}}{\\delta \\mu}\\right) $$\n\n这是地方性平衡时平均蠕虫负荷 $W^{\\ast}$ 关于模型参数的闭式表达式。这个正解（$W^{\\ast}  0$）的存在要求对数的参数大于1，即 $\\frac{\\beta \\phi_{0}}{\\delta \\mu}  1$。该比率是此系统的基本再生数 $R_0$，而条件 $R_0  1$ 是感染成为地方性流行的标准阈值。题目要求我们假设该平衡点的存在，这等同于假设 $R_0  1$。", "answer": "$$\\boxed{\\frac{1}{\\gamma} \\ln\\left(\\frac{\\beta \\phi_{0}}{\\mu \\delta}\\right)}$$", "id": "4692696"}]}