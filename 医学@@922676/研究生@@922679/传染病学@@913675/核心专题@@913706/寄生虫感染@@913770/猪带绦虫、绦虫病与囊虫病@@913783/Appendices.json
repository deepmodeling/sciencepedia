{"hands_on_practices": [{"introduction": "准确的诊断是有效管理任何疾病的第一步，对于猪囊尾蚴病尤其如此。然而，在现实世界中，任何诊断测试都不是完美的，其结果的解读在很大程度上取决于测试本身的性能（灵敏度和特异性）以及疾病在特定人群中的流行程度。这项练习将引导您应用贝叶斯定理来计算阳性预测值（PPV），这是一个关键指标，用于量化在特定情况下阳性测试结果真正表示存在疾病的概率，从而帮助临床医生做出更明智的决策 [@problem_id:4697204]。", "problem": "在一个流行地区的神经囊尾蚴病诊断项目中，临床医生使用酶联免疫电转移印迹法 (EITB) 来检测针对猪带绦虫囊尾蚴的抗体。考虑一个由新发癫痫的成年患者组成的定义明确的队列，其中已知该疾病的患病率为 $P=0.05$。在这个队列中，EITB 检测活动性感染的灵敏度为 $S=0.90$，特异度为 $C=0.98$。请仅使用概率论中灵敏度、特异度、患病率的核心定义以及贝叶斯定理，推导出阳性预测值 $\\Pr(\\text{disease} \\mid \\text{test positive})$ 关于 $S$、$C$ 和 $P$ 的表达式，然后用给定值计算其结果。将最终答案以小数形式表示，并四舍五入至四位有效数字。", "solution": "该问题要求在给定疾病患病率 ($P$)、检测灵敏度 ($S$) 和检测特异度 ($C$) 的情况下，推导并计算神经囊尾蚴病诊断测试的阳性预测值 (PPV)。推导过程必须基于概率论的基本原理，特别是条件概率的定义和贝叶斯定理。\n\n设 $D$ 为患者患有该疾病（神经囊尾蚴病）的事件，设 $D^c$ 为患者未患该疾病的互补事件。设 $T^+$ 为检测结果为阳性的事件。我们需要求的是阳性预测值，即条件概率 $\\Pr(D \\mid T^+)$。\n\n给定信息可以正式表述为：\n1.  患病率：$\\Pr(D) = P = 0.05$。因此，不患病的概率为 $\\Pr(D^c) = 1 - \\Pr(D) = 1 - P$。\n2.  灵敏度：$\\Pr(T^+ \\mid D) = S = 0.90$。这是在患有该疾病的情况下，检测结果为阳性的概率。\n3.  特异度：$\\Pr(T^- \\mid D^c) = C = 0.98$，其中 $T^-$ 是检测结果为阴性的事件。特异度是在未患该疾病的情况下，检测结果为阴性的概率。\n\n根据特异度的定义，我们可以确定假阳性的概率，即在未患该疾病的情况下检测结果为阳性的概率。这是特异度事件的补集：\n$$\n\\Pr(T^+ \\mid D^c) = 1 - \\Pr(T^- \\mid D^c) = 1 - C\n$$\n\n我们的目标是求 $\\Pr(D \\mid T^+)$。根据贝叶斯定理，该条件概率由下式给出：\n$$\n\\Pr(D \\mid T^+) = \\frac{\\Pr(T^+ \\mid D) \\Pr(D)}{\\Pr(T^+)}\n$$\n\n分母 $\\Pr(T^+)$ 是获得阳性检测结果的全概率。它可以使用全概率公式，通过以疾病状态（患病或未患病）为条件来计算：\n$$\n\\Pr(T^+) = \\Pr(T^+ \\mid D) \\Pr(D) + \\Pr(T^+ \\mid D^c) \\Pr(D^c)\n$$\n\n现在，我们将患病率 ($P$)、灵敏度 ($S$) 和特异度 ($C$) 的正式定义代入此表达式中：\n- $\\Pr(D) = P$\n- $\\Pr(D^c) = 1 - P$\n- $\\Pr(T^+ \\mid D) = S$\n- $\\Pr(T^+ \\mid D^c) = 1 - C$\n\n将这些代入 $\\Pr(T^+)$ 的公式，得到：\n$$\n\\Pr(T^+) = S \\cdot P + (1 - C)(1 - P)\n$$\n\n最后，我们将 $\\Pr(T^+)$ 的这个表达式代回到阳性预测值 $\\Pr(D \\mid T^+)$ 的贝叶斯定理公式中：\n$$\n\\Pr(D \\mid T^+) = \\frac{\\Pr(T^+ \\mid D) \\Pr(D)}{S \\cdot P + (1 - C)(1 - P)}\n$$\n这可以化简为我们所期望的，用 $S$、$C$ 和 $P$ 表示的 PPV 表达式：\n$$\n\\text{PPV} = \\frac{S \\cdot P}{S \\cdot P + (1 - C)(1 - P)}\n$$\n\n现在，我们使用给定的数值来计算这个表达式：$P=0.05$，$S=0.90$ 和 $C=0.98$。\n\n首先，我们计算公式的各个组成部分：\n- 分子是真阳性的概率：$S \\cdot P = 0.90 \\times 0.05 = 0.045$。\n- 对于分母，我们首先计算假阳性的概率：$(1 - C)(1 - P)$。\n  - $1 - C = 1 - 0.98 = 0.02$。\n  - $1 - P = 1 - 0.05 = 0.95$。\n  - 人群中假阳性检测的概率为 $(1-C)(1-P) = 0.02 \\times 0.95 = 0.019$。\n- 分母是真阳性概率与假阳性概率之和：\n  $\\Pr(T^+) = (S \\cdot P) + ((1 - C)(1 - P)) = 0.045 + 0.019 = 0.064$。\n\n现在我们可以计算 PPV：\n$$\n\\text{PPV} = \\frac{0.045}{0.064}\n$$\n进行除法运算：\n$$\n\\text{PPV} = 0.703125\n$$\n\n题目要求答案以小数形式表示，并四舍五入到四位有效数字。前四位有效数字是 $7, 0, 3, 1$。第五位数字是 $2$，小于 $5$，因此我们向下舍入（即，我们不改变第四位数字）。\n\n因此，阳性预测值为 $0.7031$。", "answer": "$$\n\\boxed{0.7031}\n$$", "id": "4697204"}, {"introduction": "在确诊脑囊尾蚴病后，制定精确的治疗方案是下一个关键步骤。本练习将我们的关注点从诊断转向临床药理学，重点是计算治疗脑囊尾蚴病的主要药物阿苯达唑的正确剂量。通过本练习，您将学会如何根据患者体重进行个性化剂量计算，同时遵守为确保患者安全而设定的每日最大剂量上限，这体现了在追求疗效与控制药物毒性之间的重要平衡 [@problem_id:4697329]。", "problem": "一名体重 $60\\,\\text{kg}$ 的成年人被诊断患有多发性脑实质囊尾蚴病 (NCC) 囊肿。治疗方案为按体重服用阿苯达唑，疗程为 $14$ 天。使用以下基本事实：(i) 基于体重的给药意味着，每日总剂量（以毫克计）等于规定的每日每公斤毫克数与患者体重（以公斤计）的乘积；(ii) 对于治疗脑囊尾蚴病的阿苯达唑，标准方案为 $15\\,\\text{mg/kg/天}$，每日分两次等量服用；(iii) 广泛接受的临床指南将阿苯达唑的每日总剂量上限定为 $800\\,\\text{mg/天}$，以限制毒性。\n\n根据这些原则，推导出在整个 $14$ 天疗程中将要服用的阿苯达唑累计总给药量（以毫克计），并考虑到每日两次分服和每日最大剂量上限。\n\n将最终答案以毫克为单位表示为单个数字。最终答案中不要包含单位。无需四舍五入。", "solution": "该问题经核实是自洽的、有科学依据且表述清晰的。所有必要信息均已提供，并且其前提与治疗脑囊尾蚴病的既定药理学和临床原则相符。\n\n让我们根据所提供的数据正式定义变量。\n患者体重为 $m = 60\\,\\text{kg}$。\n阿苯达唑的规定剂量率为 $D_r = 15\\,\\text{mg/kg/天}$。\n每日允许的最大总剂量（剂量上限）为 $D_{\\text{max}} = 800\\,\\text{mg/天}$。\n治疗疗程的持续时间为 $T = 14\\,\\text{天}$。\n\n第一步是根据原则(i)，基于患者体重计算理论上的每日总剂量。我们将此计算出的每日剂量表示为 $D_{\\text{calc}}$。\n$$D_{\\text{calc}} = m \\times D_r$$\n代入给定值：\n$$D_{\\text{calc}} = 60\\,\\text{kg} \\times 15\\,\\frac{\\text{mg}}{\\text{kg} \\cdot \\text{天}} = 900\\,\\frac{\\text{mg}}{\\text{天}}$$\n\n第二步是应用原则(iii)中规定的临床剂量上限。实际服用的每日剂量（我们表示为 $D_{\\text{actual}}$）不得超过 $D_{\\text{max}}$。因此，实际每日剂量是计算剂量和最大剂量上限中的较小者。\n$$D_{\\text{actual}} = \\min(D_{\\text{calc}}, D_{\\text{max}})$$\n代入数值：\n$$D_{\\text{actual}} = \\min(900\\,\\text{mg/天}, 800\\,\\text{mg/天})$$\n这得出：\n$$D_{\\text{actual}} = 800\\,\\frac{\\text{mg}}{\\text{天}}$$\n\n原则(ii)中提到剂量分两次等量服用（即每次 $400\\,\\text{mg}$）的信息是给药方案的一个细节，但这不改变每日服用的药物总量，该总量仍为 $800\\,\\text{mg}$。\n\n最后一步是计算在整个治疗疗程 $T$ 内服用的阿苯达唑累计总量 $A_{\\text{total}}$。该总量是实际每日剂量与治疗疗程天数的乘积。\n$$A_{\\text{total}} = D_{\\text{actual}} \\times T$$\n代入 $D_{\\text{actual}}$ 和 $T$ 的值：\n$$A_{\\text{total}} = 800\\,\\frac{\\text{mg}}{\\text{天}} \\times 14\\,\\text{天}$$\n$$A_{\\text{total}} = 11200\\,\\text{mg}$$\n\n因此，在整个 $14$ 天疗程中服用的阿苯达唑累计总量为 $11200\\,\\text{mg}$。", "answer": "$$\\boxed{11200}$$", "id": "4697329"}, {"introduction": "在处理了个体患者的诊断和治疗后，我们需要将视野扩展到更宏观的公共卫生层面，以实现对猪带绦虫的根本控制。根除这种寄生虫病需要打破其在人类和猪之间复杂的传播循环。这项练习介绍了一种强大的工具——数学模型——来分析这种传播动力学，您将通过构建下一代矩阵来推导基本再生数（$R_0$）。理解并计算 $R_0$ 对于设计和评估旨在中断传播链的“同一健康”控制策略至关重要 [@problem_id:4697304]。", "problem": "考虑一个涉及人类和猪的 Taenia solium 双宿主传播循环，该循环基于房室传染病模型的以下标准假设：宿主物种内部及之间的均匀混合、频率依赖性传播、恒定的人均移除率，以及在宿主完全易感的无病平衡点进行评估。设人类为患有肠道绦虫病的终末宿主，猪为患有囊尾蚴病的中间宿主。用 $S_h$、$I_h$ 表示人类的易感和感染房室，用 $S_p$、$I_p$ 表示猪的易感和感染房室。设 $N_h$ 和 $N_p$ 为宿主总群体规模，人类的人均移除（清除）率为 $\\gamma_h + \\mu_h$，猪的人均移除（清除）率为 $\\gamma_p + \\mu_p$，其中 $\\gamma_{\\cdot}$ 是恢复率，$\\mu_{\\cdot}$ 是宿主死亡率。假设感染力是频率依赖性的\n$$\\lambda_h = \\beta_{ph}\\frac{I_p}{N_p} \\quad \\text{和} \\quad \\lambda_p = \\beta_{hp}\\frac{I_h}{N_h},$$\n其中 $\\beta_{ph}$ 是通过食用受感染猪肉导致的猪到人感染的有效传播参数，$\\beta_{hp}$ 是通过环境污染和暴露导致的人到猪感染的有效传播参数。\n\n从基本再生数 $R_0$ 等于下一代矩阵 (NGM) 的谱半径这一定义出发，构建无病平衡点附近的感染子系统，确定新感染项和转移项的雅可比矩阵，并构成 $2 \\times 2$ 的下一代矩阵。将 $R_{ph}$ 定义为在无病平衡点时，由单个感染猪引起的预期新增人类感染数，将 $R_{hp}$ 定义为在无病平衡点时，由单个感染人引起的预期新增猪感染数。然后，将基本再生数 $R_0$ 表示为关于 $R_{ph}$ 和 $R_{hp}$ 的闭式解析表达式。\n\n将您的最终答案表示为单个解析表达式。无需四舍五入。", "solution": "问题陈述经过严格验证，确认有效。这是一个数学流行病学中的适定问题，基于标准假设和对 *Taenia solium* 传播循环的科学表述。所有必要的参数和定义都已提供，不存在内部矛盾或歧义。\n\n我们首先根据所给假设，为人类的感染房室 $I_h$ 和猪的感染房室 $I_p$ 构建微分方程组。每个感染群体的变化率等于新感染率减去移除率。\n\n人类的新增感染率是来自猪的感染力 $\\lambda_h$ 乘以易感人类数量 $S_h$。感染人类的移除率为 $(\\gamma_h + \\mu_h)I_h$。因此，$I_h$ 的方程为：\n$$ \\frac{dI_h}{dt} = \\lambda_h S_h - (\\gamma_h + \\mu_h)I_h = \\beta_{ph}\\frac{I_p}{N_p}S_h - (\\gamma_h + \\mu_h)I_h $$\n\n类似地，猪的新增感染率是来自人类的感染力 $\\lambda_p$ 乘以易感猪数量 $S_p$。感染猪的移除率为 $(\\gamma_p + \\mu_p)I_p$。因此，$I_p$ 的方程为：\n$$ \\frac{dI_p}{dt} = \\lambda_p S_p - (\\gamma_p + \\mu_p)I_p = \\beta_{hp}\\frac{I_h}{N_h}S_p - (\\gamma_p + \\mu_p)I_p $$\n\n基本再生数 $R_0$ 由无病平衡点 (DFE) 的稳定性决定，该平衡点位于 $(S_h, I_h, S_p, I_p) = (N_h, 0, N_p, 0)$。我们使用下一代矩阵 (NGM) 方法，该方法需要在 DFE 附近将系统线性化。感染房室的状态向量为 $x = (I_h, I_p)^T$。\n\n感染房室的变化率可以写成 $\\frac{dx}{dt} = \\mathcal{F}(x) - \\mathcal{V}(x)$，其中 $\\mathcal{F}(x)$ 是新感染率向量，$\\mathcal{V}(x)$ 是转移率（移除）向量。\n根据我们的方程组：\n$$ \\mathcal{F} = \\begin{pmatrix} \\beta_{ph}\\frac{I_p}{N_p}S_h \\\\ \\beta_{hp}\\frac{I_h}{N_h}S_p \\end{pmatrix} \\quad \\text{和} \\quad \\mathcal{V} = \\begin{pmatrix} (\\gamma_h + \\mu_h)I_h \\\\ (\\gamma_p + \\mu_p)I_p \\end{pmatrix} $$\n\nNGM 定义为 $K = FV^{-1}$，其中 $F$ 和 $V$ 是在 DFE 处求值的 $\\mathcal{F}$ 和 $\\mathcal{V}$ 的雅可比矩阵。\n$F = \\left. \\frac{\\partial \\mathcal{F}}{\\partial x} \\right|_{DFE}$ 和 $V = \\left. \\frac{\\partial \\mathcal{V}}{\\partial x} \\right|_{DFE}$。\n\n为了计算 $F$，我们在 DFE 处（即 $I_h=0$，$I_p=0$，$S_h=N_h$ 和 $S_p=N_p$）计算偏导数。在线性化过程中，我们将 $S_h$ 和 $S_p$ 分别用它们在 DFE 的值 $N_h$ 和 $N_p$ 来近似，因为对于初发流行病，易感者的消耗是二阶效应。\n新感染项线性化为：\n新增人类感染率 $\\approx \\beta_{ph}\\frac{I_p}{N_p}N_h = \\left(\\beta_{ph}\\frac{N_h}{N_p}\\right)I_p$\n新增猪感染率 $\\approx \\beta_{hp}\\frac{I_h}{N_h}N_p = \\left(\\beta_{hp}\\frac{N_p}{N_h}\\right)I_h$\n\n因此，新感染项的雅可比矩阵 $F$ 为：\n$$ F = \\begin{pmatrix} \\frac{\\partial}{\\partial I_h}  \\frac{\\partial}{\\partial I_p} \\end{pmatrix} \\begin{pmatrix} \\left(\\beta_{ph}\\frac{N_h}{N_p}\\right)I_p \\\\ \\left(\\beta_{hp}\\frac{N_p}{N_h}\\right)I_h \\end{pmatrix} = \\begin{pmatrix} 0  \\beta_{ph}\\frac{N_h}{N_p} \\\\ \\beta_{hp}\\frac{N_p}{N_h}  0 \\end{pmatrix} $$\n\n转移项的雅可比矩阵 $V$ 为：\n$$ V = \\left. \\frac{\\partial \\mathcal{V}}{\\partial x} \\right|_{DFE} = \\begin{pmatrix} \\gamma_h + \\mu_h  0 \\\\ 0  \\gamma_p + \\mu_p \\end{pmatrix} $$\n\n$V$ 的逆矩阵为：\n$$ V^{-1} = \\begin{pmatrix} \\frac{1}{\\gamma_h + \\mu_h}  0 \\\\ 0  \\frac{1}{\\gamma_p + \\mu_p} \\end{pmatrix} $$\n\n现在，我们构建 NGM，$K = FV^{-1}$：\n$$ K = \\begin{pmatrix} 0  \\beta_{ph}\\frac{N_h}{N_p} \\\\ \\beta_{hp}\\frac{N_p}{N_h}  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\gamma_h + \\mu_h}  0 \\\\ 0  \\frac{1}{\\gamma_p + \\mu_p} \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} \\\\ \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h}  0 \\end{pmatrix} $$\n\n基本再生数 $R_0$ 是谱半径 $\\rho(K)$，即 $K$ 的最大绝对值特征值。特征值 $\\lambda$ 是特征方程 $\\det(K - \\lambda I) = 0$ 的根：\n$$ \\det \\begin{pmatrix} -\\lambda  \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} \\\\ \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h}  -\\lambda \\end{pmatrix} = 0 $$\n$$ (-\\lambda)(-\\lambda) - \\left( \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} \\right) \\left( \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h} \\right) = 0 $$\n$$ \\lambda^2 - \\frac{\\beta_{ph}\\beta_{hp}}{(\\gamma_h + \\mu_h)(\\gamma_p + \\mu_p)} = 0 $$\n特征值为 $\\lambda = \\pm \\sqrt{\\frac{\\beta_{ph}\\beta_{hp}}{(\\gamma_h + \\mu_h)(\\gamma_p + \\mu_p)}}$。谱半径是正根：\n$$ R_0 = \\rho(K) = \\sqrt{\\frac{\\beta_{ph}\\beta_{hp}}{(\\gamma_h + \\mu_h)(\\gamma_p + \\mu_p)}} $$\n\n接下来，我们必须用 $R_{ph}$ 和 $R_{hp}$ 来表示 $R_0$。我们从它们的定义推导出这些量。\n$R_{hp}$ 是在完全易感的猪群体中，由单个感染人引起的预期新增猪感染数。单个感染人 ($I_h=1$) 在猪群体中产生新感染的速率为 $\\lambda_p S_p = (\\beta_{hp}\\frac{1}{N_h})S_p$。在 DFE 处，$S_p = N_p$，因此速率为 $\\beta_{hp}\\frac{N_p}{N_h}$。人类的平均感染期为 $\\frac{1}{\\gamma_h + \\mu_h}$。因此：\n$$ R_{hp} = (\\text{来自单个感染人的感染率}) \\times (\\text{人类的平均感染期}) = \\left(\\beta_{hp}\\frac{N_p}{N_h}\\right) \\left(\\frac{1}{\\gamma_h + \\mu_h}\\right) = \\frac{\\beta_{hp}N_p/N_h}{\\gamma_h + \\mu_h} $$\n\n$R_{ph}$ 是在完全易感的人类群体中，由单个感染猪引起的预期新增人类感染数。单个感染猪 ($I_p=1$) 在人类群体中产生新感染的速率为 $\\lambda_h S_h = (\\beta_{ph}\\frac{1}{N_p})S_h$。在 DFE 处，$S_h = N_h$，因此速率为 $\\beta_{ph}\\frac{N_h}{N_p}$。猪的平均感染期为 $\\frac{1}{\\gamma_p + \\mu_p}$。因此：\n$$ R_{ph} = (\\text{来自单头感染猪的感染率}) \\times (\\text{猪的平均感染期}) = \\left(\\beta_{ph}\\frac{N_h}{N_p}\\right) \\left(\\frac{1}{\\gamma_p + \\mu_p}\\right) = \\frac{\\beta_{ph}N_h/N_p}{\\gamma_p + \\mu_p} $$\n\n这些项 $R_{ph}$ 和 $R_{hp}$ 正是 NGM $K$ 的非对角线元素：\n$$ K = \\begin{pmatrix} 0  R_{ph} \\\\ R_{hp}  0 \\end{pmatrix} $$\n\n该矩阵的特征值由 $\\lambda^2 - R_{ph}R_{hp} = 0$ 给出，因此 $\\lambda = \\pm\\sqrt{R_{ph}R_{hp}}$。谱半径是正根。\n因此，基本再生数 $R_0$ 由这两个“代际”再生数的几何平均值给出：\n$$ R_0 = \\rho(K) = \\sqrt{R_{ph}R_{hp}} $$\n此表达式表示经过一个完整的传播循环（例如，人 $\\to$ 猪 $\\to$ 人）后，在同一宿主类型中产生的二代感染数。", "answer": "$$ \\boxed{\\sqrt{R_{ph}R_{hp}}} $$", "id": "4697304"}]}