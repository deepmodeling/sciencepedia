{"hands_on_practices": [{"introduction": "诺如病毒的易感性在很大程度上取决于宿主遗传因素，尤其是决定个体是否为分泌型（secretor status）的FUT2基因。本练习旨在通过一个模拟的暴发场景，让您运用流行病学分层分析的方法，计算校正后的风险比，从而精确量化遗传差异对感染风险的影响。这项实践将帮助您掌握控制混杂因素（如暴露水平）的关键技能，这对于准确评估风险和理解群体易感性至关重要。[@problem_id:4674287]", "problem": "诺如病毒肠胃炎的易感性受岩藻糖基转移酶2 (FUT2) 基因的影响，该基因决定了控制组织血型抗原 (HBGA) 表达的分泌型表型。考虑在一个封闭的居住环境中，在单一暴露期内爆发了一次GII.4型诺如病毒疫情。其中根据与被呕吐物污染的污染物直接接触的强度，预先定义了两个暴露分层：高暴露 ($H$) 和低暴露 ($L$)。该队列由$1000$名居民和工作人员组成，其基因型被分为分泌型阳性（功能性FUT2）和分泌型阴性（非功能性FUT2）。人员和病例的分布如下：\n- 整个队列中的暴露分布：$H$：$400$人；$L$：$600$人。\n- 每个暴露分层内按基因型构成的组成：\n  - $H$：$340$名分泌型阳性，$60$名分泌型阴性。\n  - $L$：$460$名分泌型阳性，$140$名分泌型阴性。\n- 暴露期内的诺如病毒病例：\n  - 分泌型阳性：$H$组$170$例，$L$组$92$例。\n  - 分泌型阴性：$H$组$3$例，$L$组$2$例。\n\n使用侵袭率作为分层内累积发病率的基本原理和全概率定律来构建直接标准化风险，计算分泌型阳性个体与分泌型阴性个体相比的暴露标准化风险比，并使用整个队列的暴露分布作为标准。将最终的调整后风险比作为一个无量纲量报告，并四舍五入至三位有效数字。\n\n在你的推理中，解释分泌型阴性个体的存在如何改变群体对该诺如病毒株的易感性，但最终数值答案仅提供调整后的风险比。", "solution": "目标是使用直接标准化原理，计算分泌型阳性个体与分泌型阴性个体相比的暴露标准化风险比 ($RR_{adj}$)。该方法允许在控制第三个变量（在本例中为暴露强度）的混杂效应的情况下，比较两组之间的风险。\n\n令下标$pos$表示分泌型阳性组，$neg$表示分泌型阴性组。令下标$H$表示高暴露分层，$L$表示低暴露分层。每个类别中的个体数用$N$表示，病例数用$C$表示。\n\n给定数据如下：\n- 高暴露组总人数，$N_H = 400$。\n- 低暴露组总人数，$N_L = 600$。\n- $H$组中的分泌型阳性：$N_{H, pos} = 340$，其中病例数为$C_{H, pos} = 170$。\n- $H$组中的分泌型阴性：$N_{H, neg} = 60$，其中病例数为$C_{H, neg} = 3$。\n- $L$组中的分泌型阳性：$N_{L, pos} = 460$，其中病例数为$C_{L, pos} = 92$。\n- $L$组中的分泌型阴性：$N_{L, neg} = 140$，其中病例数为$C_{L, neg} = 2$。\n\n第一步是计算分层特异性侵袭率，它代表了四个已定义亚组中的累积发病率或风险 ($R$)。风险定义为新发病例数除以风险人群数：$R_{i,j} = \\frac{C_{i,j}}{N_{i,j}}$。\n\n对于分泌型阳性组：\n- 高暴露分层中的风险：$R_{H, pos} = \\frac{C_{H, pos}}{N_{H, pos}} = \\frac{170}{340} = 0.5$。\n- 低暴露分层中的风险：$R_{L, pos} = \\frac{C_{L, pos}}{N_{L, pos}} = \\frac{92}{460} = 0.2$。\n\n对于分泌型阴性组：\n- 高暴露分层中的风险：$R_{H, neg} = \\frac{C_{H, neg}}{N_{H, neg}} = \\frac{3}{60} = 0.05$。\n- 低暴露分层中的风险：$R_{L, neg} = \\frac{C_{L, neg}}{N_{L, neg}} = \\frac{2}{140} = \\frac{1}{70}$。\n\n这些分层特异性风险表明，分泌型阴性个体对这种诺如病毒株的感染抵抗力远高于分泌型阳性个体。在高暴露和低暴露水平下，他们的患病风险都低一个数量级。这个有抵抗力的亚群（占$1000$人中的$60 + 140 = 200$人，即$20\\%$）的存在，内在地降低了整个队列的整体易感性。这种现象通过形成一个由免疫或有抵抗力的个体组成的天然缓冲，从而阻碍病原体传播，对群体易感性做出了贡献。\n\n下一步是进行直接标准化。这需要定义一个标准人群来计算每个分层的权重。问题指定使用整个队列的暴露分布作为标准。队列总人数为 $N_{total} = N_H + N_L = 400 + 600 = 1000$。\n\n每个暴露分层的权重 ($w_i$) 是标准人群在该分层中的比例：\n- 高暴露分层的权重：$w_H = \\frac{N_H}{N_{total}} = \\frac{400}{1000} = 0.4$。\n- 低暴露分层的权重：$w_L = \\frac{N_L}{N_{total}} = \\frac{600}{1000} = 0.6$。\n\n每个基因型组的调整后风险 ($R_{adj}$) 是其分层特异性风险的加权平均值，权重来自标准人群。公式为 $R_{adj,j} = \\sum_{i} w_i R_{i,j}$。\n\n对于分泌型阳性组：\n$$R_{adj, pos} = (w_H \\times R_{H, pos}) + (w_L \\times R_{L, pos}) = (0.4 \\times 0.5) + (0.6 \\times 0.2) = 0.20 + 0.12 = 0.32$$\n\n对于分泌型阴性组：\n$$R_{adj, neg} = (w_H \\times R_{H, neg}) + (w_L \\times R_{L, neg}) = (0.4 \\times 0.05) + (0.6 \\times \\frac{1}{70}) = 0.02 + \\frac{0.6}{70} = \\frac{1}{50} + \\frac{6}{700}$$\n为了合并这些分数，我们找到公分母 $350$：\n$$R_{adj, neg} = \\frac{7}{350} + \\frac{3}{350} = \\frac{10}{350} = \\frac{1}{35}$$\n\n最后，暴露标准化风险比 ($RR_{adj}$) 是这些调整后风险的比率：\n$$RR_{adj} = \\frac{R_{adj, pos}}{R_{adj, neg}}$$\n代入计算出的值：\n$$RR_{adj} = \\frac{0.32}{\\frac{1}{35}} = 0.32 \\times 35 = \\frac{32}{100} \\times 35 = \\frac{8}{25} \\times 35 = \\frac{8 \\times 7}{5} = \\frac{56}{5} = 11.2$$\n\n问题要求答案四舍五入至三位有效数字。计算值 $11.2$ 已经有三位有效数字。\n\n因此，在调整了暴露强度的混杂效应后，分泌型阳性个体患上诺如病毒肠胃炎的风险是分泌型阴性个体的 $11.2$ 倍。", "answer": "$$\n\\boxed{11.2}\n$$", "id": "4674287"}, {"introduction": "诺如病毒在环境中具有很强的稳定性，这使其通过接触污染物（fomites）的传播途径变得尤为重要。本练习将一级动力学衰变模型应用于病毒在不同材质表面的存活问题，这是一个在微生物学和感染控制中应用广泛的核心概念。通过从病毒的半衰期推导至达到特定对数削减所需的时间，您将学会如何为医院等高风险环境制定基于证据的清洁方案，从而有效地切断传播链。[@problem_id:4674304]", "problem": "一家医院爆发了诺如病毒肠胃炎，并实施了强化的环境卫生措施。为了对高频接触区域的环境持久性进行风险评估，假设在时间 $t=0$ 时发生单次污染事件后，表面上存活的诺如病毒数量根据一级动力学衰减，其数量 $N(t)$ 遵循 $N(t)=N_{0}\\exp(-k t)$，其中 $N_{0}$ 是初始存活数量，$k$ 是由表面和环境条件决定的恒定风险（衰减率）。$3\\log_{10}$ 的下降定义为 $N(t)/N_{0}=10^{-3}$。\n\n在医院条件下，对人类诺如病毒替代物的经验性半衰期观察表明，其在不锈钢上的半衰期中位数为 $t_{1/2}^{\\text{steel}}=15\\,\\text{h}$，在代表性的多孔表面（例如，棉花）上的半衰期中位数为 $t_{1/2}^{\\text{porous}}=5\\,\\text{h}$。使用一级衰减和半衰期的基本定义，从 $N(t)=N_{0}\\exp(-k t)$ 和半衰期的定义出发，推导在每种表面上达到 $3\\log_{10}$ 下降所需的时间 $t_{3}$。\n\n然后，在仅依靠定期清洁之间的自然衰减，以在下一次清洁事件到来时，在两种表面上都实现至少 $3\\log_{10}$ 下降的政策目标下，为高频接触区域推荐一个统一的清洁间隔 $\\tau$。标准是间隔 $\\tau$ 必须满足：对于间隔开始时的任何污染事件，到下一次定期清洁时，两种表面都经历了至少 $3\\log_{10}$ 的下降。\n\n计算：\n- 不锈钢所需的时间 $t_{3}^{\\text{steel}}$，\n- 多孔表面所需的时间 $t_{3}^{\\text{porous}}$，\n- 满足上述标准的推荐统一清洁间隔 $\\tau$。\n\n将您的答案四舍五入至四位有效数字，并以小时为单位表示所有时间。", "solution": "解答首先建立半衰期 $t_{1/2}$ 和衰减常数 $k$ 之间的一般关系，然后建立衰减常数 $k$ 和达到 $3\\log_{10}$ 下降所需时间 $t_3$ 之间的关系。\n\n首先，我们推导衰减常数 $k$ 和半衰期 $t_{1/2}$ 之间的关系。根据半衰期的定义，在时间 $t = t_{1/2}$ 时，存活颗粒的数量是初始数量的一半，因此 $N(t_{1/2}) = N_0 / 2$。将此代入衰减方程：\n$$\n\\frac{N_0}{2} = N_0 \\exp(-k t_{1/2})\n$$\n两边同除以 $N_0$（假设 $N_0  0$）：\n$$\n\\frac{1}{2} = \\exp(-k t_{1/2})\n$$\n取两边的自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k t_{1/2}\n$$\n使用属性 $\\ln(1/x) = -\\ln(x)$，我们得到：\n$$\n-\\ln(2) = -k t_{1/2}\n$$\n求解衰减常数 $k$：\n$$\nk = \\frac{\\ln(2)}{t_{1/2}}\n$$\n该方程表明衰减常数与半衰期成反比。\n\n接下来，我们推导达到 $3\\log_{10}$ 下降所需时间 $t_3$ 的表达式。条件为 $N(t_3)/N_0 = 10^{-3}$。将此代入衰减方程：\n$$\n\\frac{N(t_3)}{N_0} = \\exp(-k t_3) = 10^{-3}\n$$\n取两边的自然对数：\n$$\n\\ln(\\exp(-k t_3)) = \\ln(10^{-3})\n$$\n$$\n-k t_3 = -3 \\ln(10)\n$$\n求解 $t_3$：\n$$\nt_3 = \\frac{3 \\ln(10)}{k}\n$$\n现在，我们可以结合这两个导出的关系，直接用 $t_{1/2}$ 表示 $t_3$。将 $k$ 的表达式代入 $t_3$ 的方程中：\n$$\nt_3 = \\frac{3 \\ln(10)}{\\frac{\\ln(2)}{t_{1/2}}} = t_{1/2} \\left( \\frac{3 \\ln(10)}{\\ln(2)} \\right)\n$$\n括号中的项是一个常数因子，它将半衰期与减少 $1000$ 倍所需的时间联系起来。我们现在可以使用这个公式来计算两种表面所需的时间。\n\n对于不锈钢，其 $t_{1/2}^{\\text{steel}} = 15\\,\\text{h}$：\n$$\nt_{3}^{\\text{steel}} = (15\\,\\text{h}) \\left( \\frac{3 \\ln(10)}{\\ln(2)} \\right)\n$$\n$$\nt_{3}^{\\text{steel}} \\approx 15 \\times \\left( \\frac{3 \\times 2.302585}{0.693147} \\right) \\approx 15 \\times 9.965784 \\approx 149.48676\\,\\text{h}\n$$\n四舍五入到四位有效数字，得 $t_{3}^{\\text{steel}} = 149.5\\,\\text{h}$。\n\n对于多孔表面，其 $t_{1/2}^{\\text{porous}} = 5\\,\\text{h}$：\n$$\nt_{3}^{\\text{porous}} = (5\\,\\text{h}) \\left( \\frac{3 \\ln(10)}{\\ln(2)} \\right)\n$$\n$$\nt_{3}^{\\text{porous}} \\approx 5 \\times 9.965784 \\approx 49.82892\\,\\text{h}\n$$\n四舍五入到四位有效数字，得 $t_{3}^{\\text{porous}} = 49.83\\,\\text{h}$。\n\n最后，我们必须确定统一的清洁间隔 $\\tau$。政策要求该间隔足以在**两种**表面上都实现至少 $3\\log_{10}$ 的下降。这意味着时间间隔必须足够长，以适应两个衰减过程中较慢的一个。衰减较慢的表面是半衰期较长的不锈钢。因此，清洁间隔 $\\tau$ 必须至少与不锈钢上达到 $3\\log_{10}$ 下降所需的时间一样长。\n$$\n\\tau \\ge t_{3}^{\\text{steel}}\n$$\n$$\n\\tau \\ge 149.5\\,\\text{h}\n$$\n并且\n$$\n\\tau \\ge t_{3}^{\\text{porous}}\n$$\n$$\n\\tau \\ge 49.83\\,\\text{h}\n$$\n为了同时满足这两个条件，$\\tau$ 必须大于或等于两个所需时间中的最大值：\n$$\n\\tau = \\max(t_{3}^{\\text{steel}}, t_{3}^{\\text{porous}}) = \\max(149.5\\,\\text{h}, 49.83\\,\\text{h})\n$$\n$$\n\\tau = 149.5\\,\\text{h}\n$$\n推荐的统一清洁间隔 $\\tau$ 为 $149.5\\,\\text{h}$。\n\n计算出的值为：\n- $t_{3}^{\\text{steel}} = 149.5\\,\\text{h}$\n- $t_{3}^{\\text{porous}} = 49.83\\,\\text{h}$\n- $\\tau = 149.5\\,\\text{h}$", "answer": "$$\n\\boxed{\\begin{pmatrix} 149.5  49.83  149.5 \\end{pmatrix}}\n$$", "id": "4674304"}, {"introduction": "诺如病毒感染在全球许多地区表现出明显的季节性特征，尤其是在冬季高发，理解其背后的驱动机制是流行病学研究的一个核心课题。本练习将指导您构建一个从第一性原理出发的机械模型，将病毒在环境中的失活速率（受温度和湿度影响）与关键流行病学参数——有效再生数（$\\mathcal{R}_t$）直接关联。通过这项实践，您将学会如何运用数学模型来整合生物物理学数据与流行病学理论，从而揭示传染病季节性模式的环境决定因素。[@problem_id:4674293]", "problem": "您会获得温度和绝对湿度的月度环境时间序列，并被要求使用一种机理推导方法，计算诺如病毒肠胃炎有效再生数（Effective Reproduction Number (ERN)，$\\mathcal{R}_t$）的预测季节性变化。该推导始于标准的传染病仓室模型框架和关于环境灭活的经过充分检验的生物物理事实。目标是从第一性原理出发构建 $\\mathcal{R}_t(t)$，然后将其应用于指定的测试用例，并报告每个案例的季节性变化的单一量化指标。\n\n使用的基本依据和假设：\n- 易感-感染-康复 (SIR) 框架意味着瞬时有效再生数满足 $\\mathcal{R}_t(t) = \\beta(t)\\, D\\, \\frac{S}{N}$，其中 $\\beta(t)$ 是有效传播率，$D$ 是以天为单位的平均传染期，$S$ 是易感个体数量，$N$ 是总人口规模。在所关注的时间尺度内，将 $\\frac{S}{N}$ 视为常数。\n- 有效传播率可以表示为 $\\beta(t) = c\\, p(t)$，其中 $c$ 是每日平均有效接触率，$p(t)$ 是在时间 $t$ 发生接触导致传播的概率。\n- 对于通过受污染环境介导的诺如病毒传播，病毒颗粒在污染和接触之间的存活能力呈指数衰减，其灭活率受环境条件调节。将存活能力建模为 $s_{\\mathrm{env}}(T,H) = \\exp\\!\\left(-\\lambda(T,H)\\, \\tau\\right)$，其中 $\\lambda(T,H)$ 是作为绝对温度 $T$（单位：开尔文）和绝对湿度 $H$（单位：克/立方米）函数的灭活率，$\\tau$ 是以天为单位的平均污染到接触延迟时间。\n- 假设在参考环境附近，灭活率随 $T$ 和 $H$ 单调增加。使用参数形式 $\\lambda(T,H) = \\lambda_0 \\exp\\!\\left(\\eta_T \\left(T - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H - H_{\\mathrm{ref}}\\right)\\right)$，其中 $\\lambda_0$ 是在参考温度 $T_{\\mathrm{ref}}$ 和参考绝对湿度 $H_{\\mathrm{ref}}$ 下的基线灭活率，$\\eta_T$ 和 $\\eta_H$ 是正灵敏度参数。\n- 每次接触的传播概率与环境存活能力成比例：$p(T,H) = p_0\\, s_{\\mathrm{env}}(T,H)$，其中 $p_0$ 是参考条件下的基线单次接触传播概率。等效地，定义 $\\beta_0 = c\\, p_0$ 并写作 $\\beta(T,H) = \\beta_0\\, s_{\\mathrm{env}}(T,H)$。\n\n用于所有计算的参数值：\n- 传染期：$D = 2$ 天。\n- 易感比例：$\\frac{S}{N} = 0.6$ (无量纲)。\n- 基线传播系数：$\\beta_0 = 1.2$ 天$^{-1}$。\n- 参考温度：$T_{\\mathrm{ref}} = 293$ 开尔文。\n- 参考绝对湿度：$H_{\\mathrm{ref}} = 7$ 克/立方米。\n- 基线灭活率：$\\lambda_0 = 0.3$ 天$^{-1}$。\n- 温度灵敏度：$\\eta_T = 0.05$ 开尔文$^{-1}$。\n- 湿度灵敏度：$\\eta_H = 0.06$ (克/立方米)$^{-1}$。\n- 平均污染到接触延迟：$\\tau = 0.5$ 天。\n\n您的任务：\n1. 根据基本假设，推导出 $\\mathcal{R}_t(t)$ 作为 $T_t$ 和 $H_t$ 函数的显式表达式。\n2. 实现一个程序，对下面提供的每个测试用例，计算月度序列 $\\{\\mathcal{R}_t(m)\\}_{m=1}^{12}$，然后计算季节性振幅，其定义为 $\\max_m \\mathcal{R}_t(m) - \\min_m \\mathcal{R}_t(m)$，单位为无量纲的再生数。\n3. 按照最终输出格式的要求，在单行中报告每个测试用例的季节性振幅。\n\n测试套件（每个案例给出 $T$（单位：开尔文）和 $H$（单位：克/立方米）的 12 个月度值）：\n- 案例 1 (温带气候):\n  - $T$: $[279, 281, 285, 289, 293, 297, 300, 299, 295, 289, 283, 280]$\n  - $H$: $[4.0, 4.5, 5.5, 7.0, 9.0, 12.0, 14.0, 13.0, 10.0, 7.0, 5.0, 4.5]$\n- 案例 2 (热带暖湿):\n  - $T$: $[298, 299, 299, 300, 300, 301, 301, 301, 300, 299, 299, 298]$\n  - $H$: $[14.0, 15.0, 16.0, 17.0, 18.0, 18.0, 18.0, 17.0, 16.0, 15.0, 14.0, 14.0]$\n- 案例 3 (季节性强的干冷气候):\n  - $T$: $[273, 274, 276, 280, 285, 290, 292, 290, 285, 278, 274, 272]$\n  - $H$: $[2.0, 2.2, 3.0, 4.0, 5.5, 6.5, 8.0, 7.0, 5.0, 3.5, 2.5, 2.0]$\n- 案例 4 (恒定参考环境；边缘案例):\n  - $T$: $[293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293]$\n  - $H$: $[7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0]$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含案例 1 到 4 的季节性振幅，按顺序排列，四舍五入到 6 位小数，并以逗号分隔的列表形式包含在方括号内，例如 $[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4]$，其中每个 $\\alpha_i$ 是一个以再生数单位（无量纲）表示的浮点数。", "solution": "主要任务是推导随时间变化的有效再生数 $\\mathcal{R}_t(t)$ 的显式表达式，并用它来计算几种气候情景下的季节性振幅。\n\n首先，我们将通过依次代入所提供的定义来进行推导。起点是源自 SIR 框架的有效再生数表达式：\n$$\n\\mathcal{R}_t(t) = \\beta(t)\\, D\\, \\frac{S}{N}\n$$\n这里，$\\beta(t)$ 是随时间变化的有效传播率，$D$ 是平均传染期，$\\frac{S}{N}$ 是易感人群在总人口中所占的比例。\n\n问题陈述指出，有效传播率与单次接触传播概率 $p(t)$ 成正比，比例常数为 $c$，即平均有效接触率。这表示为 $\\beta(t) = c\\, p(t)$。此外，单次接触传播概率本身又与病毒的环境存活能力 $s_{\\mathrm{env}}(T,H)$ 成正比，因此 $p(t) = p(T_t, H_t) = p_0\\, s_{\\mathrm{env}}(T_t, H_t)$，其中 $p_0$ 是一个基线概率。将这些结合起来，我们可以定义一个基线传播系数 $\\beta_0 = c\\, p_0$，从而得到随时间变化的传播率表达式：\n$$\n\\beta(t) = \\beta(T_t, H_t) = \\beta_0\\, s_{\\mathrm{env}}(T_t, H_t)\n$$\n其中 $T_t$ 和 $H_t$ 分别是时间 $t$ 的绝对温度和绝对湿度。\n\n接下来，我们引入环境存活能力 $s_{\\mathrm{env}}$ 的模型。该项表示在平均污染到接触的延迟时间 $\\tau$ 内保持存活的病毒颗粒的比例。衰减是指数形式的，由依赖于环境的灭活率 $\\lambda(T_t, H_t)$ 控制：\n$$\ns_{\\mathrm{env}}(T_t, H_t) = \\exp\\!\\left(-\\lambda(T_t, H_t)\\, \\tau\\right)\n$$\n灭活率 $\\lambda$ 被建模为相对于参考环境 ($T_{\\mathrm{ref}}$, $H_{\\mathrm{ref}}$) 的温度 $T$ 和湿度 $H$ 的函数：\n$$\n\\lambda(T_t, H_t) = \\lambda_0 \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right)\n$$\n这里，$\\lambda_0$ 是基线灭活率，$\\eta_T$ 和 $\\eta_H$ 分别是温度和湿度的灵敏度参数。\n\n通过将 $\\lambda(T_t, H_t)$ 的表达式代入 $s_{\\mathrm{env}}(T_t, H_t)$ 的方程，我们得到：\n$$\ns_{\\mathrm{env}}(T_t, H_t) = \\exp\\!\\left(-\\left[ \\lambda_0 \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right) \\right] \\tau \\right)\n$$\n现在，我们将这个环境存活能力的表达式代入传播率 $\\beta(t)$ 的方程中：\n$$\n\\beta(T_t, H_t) = \\beta_0 \\exp\\!\\left(-\\lambda_0 \\tau \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right)\\right)\n$$\n最后，将这个完整的 $\\beta(T_t, H_t)$ 表达式代入 $\\mathcal{R}_t(t)$ 的初始方程，得到有效再生数作为环境条件函数的完整、显式模型：\n$$\n\\mathcal{R}_t(T_t, H_t) = \\left( \\beta_0 D \\frac{S}{N} \\right) \\exp\\!\\left(-\\lambda_0 \\tau \\exp\\!\\left(\\eta_T \\left(T_t - T_{\\mathrm{ref}}\\right) + \\eta_H \\left(H_t - H_{\\mathrm{ref}}\\right)\\right)\\right)\n$$\n这是我们计算的核心方程。请注意，项 $\\beta_0 D \\frac{S}{N}$ 是一个常数前置因子。\n\n计算步骤如下。对于每个测试用例，我们都给定了 12 个月的温度和湿度对，$\\{ (T_m, H_m) \\}_{m=1}^{12}$。\n1. 对于每个月 $m$，我们将使用推导出的公式和给定的参数值计算相应的 $\\mathcal{R}_t(m)$ 值。\n参数如下：\n- $D = 2$ 天\n- $\\frac{S}{N} = 0.6$\n- $\\beta_0 = 1.2$ 天$^{-1}$\n- $T_{\\mathrm{ref}} = 293$ K\n- $H_{\\mathrm{ref}} = 7$ 克/米$^3$\n- $\\lambda_0 = 0.3$ 天$^{-1}$\n- $\\eta_T = 0.05$ K$^{-1}$\n- $\\eta_H = 0.06$ (克/米$^3$)$^{-1}$\n- $\\tau = 0.5$ 天\n\n可以预先计算常数前置因子：\n$$\n\\mathcal{R}_{\\text{base}} = \\beta_0 D \\frac{S}{N} = (1.2)(2)(0.6) = 1.44\n$$\n外部指数函数的参数包含常数乘积 $\\lambda_0\\tau$：\n$$\n\\lambda_0 \\tau = (0.3)(0.5) = 0.15\n$$\n因此，要实现的最终方程是：\n$$\n\\mathcal{R}_t(T_m, H_m) = 1.44 \\cdot \\exp\\!\\left(-0.15 \\cdot \\exp\\!\\left(0.05 (T_m - 293) + 0.06 (H_m - 7)\\right)\\right)\n$$\n\n2. 该计算将产生一个包含 12 个月度 $\\mathcal{R}_t$ 值的时间序列，即 $\\{\\mathcal{R}_t(m)\\}_{m=1}^{12}$。\n3. 然后，我们将找到该序列中的最大值和最小值：$\\mathcal{R}_{t, \\max} = \\max_m \\mathcal{R}_t(m)$ 和 $\\mathcal{R}_{t, \\min} = \\min_m \\mathcal{R}_t(m)$。\n4. 季节性振幅 $\\alpha$ 定义为这些极值之间的差值，并按此计算：$\\alpha = \\mathcal{R}_{t, \\max} - \\mathcal{R}_{t, \\min}$。\n5. 对所有四个测试用例重复此过程，并按规定格式报告所得的振幅。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the seasonal amplitude of the Effective Reproduction Number for norovirus\n    based on a mechanistic model and environmental time series.\n    \"\"\"\n\n    # Define the constant parameters based on the problem statement.\n    D = 2.0         # Mean duration of infectiousness in days\n    S_div_N = 0.6   # Susceptible fraction of the population (unitless)\n    beta_0 = 1.2    # Baseline transmission coefficient in day^-1\n    T_ref = 293.0   # Reference temperature in Kelvin\n    H_ref = 7.0     # Reference absolute humidity in g/m^3\n    lambda_0 = 0.3  # Baseline inactivation rate in day^-1\n    eta_T = 0.05    # Temperature sensitivity in Kelvin^-1\n    eta_H = 0.06    # Humidity sensitivity in (g/m^3)^-1\n    tau = 0.5       # Mean contamination-to-contact delay in days\n\n    # Pre-calculate the constant part of the Rt equation for efficiency.\n    # Rt = (beta_0 * D * S_div_N) * exp(...)\n    R_base = beta_0 * D * S_div_N\n\n    # Pre-calculate the constant part of the exponent for efficiency.\n    # exp(-lambda_0 * tau * exp(...))\n    lambda_tau = lambda_0 * tau\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (temperate climate)\n        (\n            [279, 281, 285, 289, 293, 297, 300, 299, 295, 289, 283, 280],\n            [4.0, 4.5, 5.5, 7.0, 9.0, 12.0, 14.0, 13.0, 10.0, 7.0, 5.0, 4.5]\n        ),\n        # Case 2 (tropical warm-humid)\n        (\n            [298, 299, 299, 300, 300, 301, 301, 301, 300, 299, 299, 298],\n            [14.0, 15.0, 16.0, 17.0, 18.0, 18.0, 18.0, 17.0, 16.0, 15.0, 14.0, 14.0]\n        ),\n        # Case 3 (cold-dry with strong seasonality)\n        (\n            [273, 274, 276, 280, 285, 290, 292, 290, 285, 278, 274, 272],\n            [2.0, 2.2, 3.0, 4.0, 5.5, 6.5, 8.0, 7.0, 5.0, 3.5, 2.5, 2.0]\n        ),\n        # Case 4 (constant reference environment; edge case)\n        (\n            [293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293, 293],\n            [7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0]\n        )\n    ]\n\n    results = []\n    for T_monthly, H_monthly in test_cases:\n        # Convert lists to NumPy arrays for vectorized calculations.\n        T_arr = np.array(T_monthly, dtype=float)\n        H_arr = np.array(H_monthly, dtype=float)\n\n        # Calculate the derived expression for Rt(t) for all 12 months.\n        # Rt = R_base * exp(-lambda_tau * exp(eta_T * (T - T_ref) + eta_H * (H - H_ref)))\n        \n        # Step 1: Calculate the exponent term related to environmental deviation.\n        env_exponent = eta_T * (T_arr - T_ref) + eta_H * (H_arr - H_ref)\n        \n        # Step 2: Calculate the full argument of the outer exponential function.\n        full_exponent = -lambda_tau * np.exp(env_exponent)\n        \n        # Step 3: Calculate the monthly Rt values.\n        R_t_monthly = R_base * np.exp(full_exponent)\n\n        # Step 4: Calculate the seasonal amplitude.\n        amplitude = np.max(R_t_monthly) - np.min(R_t_monthly)\n        \n        # Step 5: Round the result to 6 decimal places and store it.\n        results.append(round(amplitude, 6))\n\n    # Format the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4674293"}]}