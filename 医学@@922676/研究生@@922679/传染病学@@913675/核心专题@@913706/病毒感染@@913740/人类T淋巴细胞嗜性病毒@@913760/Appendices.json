{"hands_on_practices": [{"introduction": "对人类 T 淋巴细胞病毒 1 型（HTLV-1）感染的定量管理是临床监测和研究的基础。前病毒载量（Proviral Load, PVL）是评估疾病进展和治疗反应的关键生物标志物。本练习将引导您完成从原始数字液滴聚合酶链式反应（ddPCR）数据中计算 PVL 的过程，通过定义“细胞当量”这一概念，将分子检测结果与细胞生物学的基本事实联系起来。通过这个实践，您将掌握将实验室测量值转化为具有临床意义的病毒载量指标的核心技能 [@problem_id:4652955]。", "problem": "一个临床病毒学实验室使用数字微滴聚合酶链式反应 (ddPCR) 来量化外周血单核细胞 (PBMC) 中的人类T淋巴细胞病毒1型 (HTLV-1) 前病毒载量。该检测方法针对一个单拷贝的HTLV-1前病毒基因，并在同一个DNA等分试样中，针对一个常染色体单拷贝的人类参考基因（$\\beta$-珠蛋白基因座），以估计存在的二倍体基因组数量。“细胞当量”的概念被定义为待测DNA中二倍体基因组的计数，其依据是PBMC是二倍体细胞，以及每个二倍体细胞中存在两个拷贝的常染色体单拷贝基因座这些生物学事实。\n\n从第一性原理出发，基于以下经过充分验证的事实：HTLV-1的感染是通过宿主基因组内整合的前病毒DNA来测量的；PBMC是二倍体的；一个常染色体单拷贝基因座在每个二倍体细胞中存在两个拷贝；ddPCR为每个靶标提供反应体积内的绝对模板计数。请根据测得的常染色体单拷贝基因座来定义“细胞当量”，并推导出一个表达式，该表达式表示每 $100$ 个 PBMC 的 HTLV-1 前病毒载量，它是在同一次反应中测得的 HTLV-1 拷贝数和测得的常染色体单拷贝基因座拷贝数的函数。然后，将您推导出的表达式应用于从同一次ddPCR反应中获得的以下测量数据：\n\n- 测得的HTLV-1靶标拷贝数：$1{,}780$。\n- 测得的$\\beta$-珠蛋白拷贝数：$42{,}500$。\n\n以“每$100$个PBMC的拷贝数”为单位表示最终的HTLV-1前病毒载量。将您的最终数值答案四舍五入到四位有效数字。在最终的方框答案中不要包含单位。", "solution": "问题陈述已经过验证，被确定为科学上合理、问题明确且完整。它描述了在临床环境中量化病毒载量的一种标准且有效的方法。我们可以继续进行推导和计算。\n\n目标有两方面：首先，从第一性原理出发，推导出每 $100$ 个外周血单核细胞 (PBMC) 的 HTLV-1 前病毒载量的表达式；其次，将此表达式应用于给定的数据集。\n\n让我们根据数字微滴聚合酶链式反应 (ddPCR) 测量的量来定义变量：\n- 设 $N_{HTLV}$ 为检测到的 HTLV-1 前病毒基因拷贝的绝对数量。\n- 设 $N_{REF}$ 为检测到的参考基因（在本例中为$\\beta$-珠蛋白）拷贝的绝对数量。\n\n第一个任务是根据测得的参考基因拷贝数来定义“细胞当量”。问题陈述中指出，PBMC是二倍体，且参考基因是常染色体单拷贝基因座。根据定义，一个二倍体细胞包含两套完整的常染色体。因此，一个二倍体细胞精确包含 $2$ 个任何单拷贝常染色体基因的拷贝。\n\n设 $N_{CE}$ 表示样本中的细胞当量数。细胞当量被定义为二倍体基因组的计数。由于每个二倍体基因组（也就是每个细胞）包含 $2$ 个参考基因的拷贝，因此测得的参考基因总拷贝数 $N_{REF}$ 与细胞当量数 $N_{CE}$ 之间的关系由以下方程表示：\n$$N_{REF} = 2 \\times N_{CE}$$\n从这个关系中，我们可以将细胞当量数表示为测得的参考基因拷贝数的函数：\n$$N_{CE} = \\frac{N_{REF}}{2}$$\n这个方程提供了基于ddPCR参考基因测量的细胞当量的正式定义。\n\n第二个任务是推导出每 $100$ 个 PBMC 的 HTLV-1 前病毒载量的表达式。前病毒载量是每个细胞平均病毒拷贝数的度量。我们首先可以计算单个细胞的载量，记为 $L_{cell}$。这是病毒总拷贝数与细胞当量总数的比率：\n$$L_{cell} = \\frac{N_{HTLV}}{N_{CE}}$$\n代入我们上面推导出的 $N_{CE}$ 表达式：\n$$L_{cell} = \\frac{N_{HTLV}}{\\frac{N_{REF}}{2}} = 2 \\frac{N_{HTLV}}{N_{REF}}$$\n这个表达式给出了每个细胞的 HTLV-1 前病毒平均拷贝数。临床报告标准通常要求这个值以每 $100$ 个细胞为单位表示。让我们将每 $100$ 个 PBMC 的前病毒载量记为 $L_{100}$。这就是每个细胞载量的 $100$ 倍：\n$$L_{100} = 100 \\times L_{cell}$$\n代入 $L_{cell}$ 的表达式：\n$$L_{100} = 100 \\times \\left( 2 \\frac{N_{HTLV}}{N_{REF}} \\right) = 200 \\frac{N_{HTLV}}{N_{REF}}$$\n这就是最终推导出的每 $100$ 个 PBMC 的 HTLV-1 前病毒载量的表达式，它是测得的 HTLV-1 靶标拷贝数和常染色体参考基因拷贝数的函数。\n\n现在，我们将这个表达式应用于所提供的数据：\n- 测得的HTLV-1靶标拷贝数，$N_{HTLV} = 1,780$。\n- 测得的$\\beta$-珠蛋白拷贝数，$N_{REF} = 42,500$。\n\n将这些值代入我们推导的 $L_{100}$ 公式中：\n$$L_{100} = 200 \\times \\frac{1,780}{42,500}$$\n在进行除法运算之前，我们可以简化表达式：\n$$L_{100} = \\frac{200 \\times 1,780}{42,500} = \\frac{2 \\times 17,800}{4,250} = \\frac{2 \\times 1,780}{425}$$\n$$L_{100} = \\frac{3,560}{425}$$\n进行除法运算得出：\n$$L_{100} \\approx 8.376470588...$$\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $8$、$3$、$7$ 和 $6$。第五位有效数字是 $4$。因为 $4  5$，我们向下舍入，即截断第四位有效数字后的部分。\n$$L_{100} \\approx 8.376$$\n因此，HTLV-1 前病毒载量为每 $100$ 个 PBMC 中 $8.376$ 个拷贝。", "answer": "$$\\boxed{8.376}$$", "id": "4652955"}, {"introduction": "在了解如何量化病毒载量之后，我们进一步探讨驱动其变化的生物学机制。HTLV-1 在宿主体内的持续存在主要依赖于两种模式：感染细胞的有丝分裂（克隆性增殖）和病毒对新靶细胞的感染（新生感染）。本练习通过构建一个基于群体动力学原理的数学模型，让您能够定量地剖析这两种机制对前病毒载量增长的贡献。这项实践不仅能加深您对 HTLV-1 核心发病机理的理解，还能锻炼您使用计算模型来探索复杂生物学问题的能力 [@problem_id:4652936]。", "problem": "构建一个程序，根据宿主-病原体动力学和种群守恒的基本原理，定量地划分人类T淋巴细胞病毒1型（HTLV-1）前病毒载量随时间的增加，将其分解为克隆增殖和从头感染两部分。请使用以下基础：\n\n- 总T细胞守恒：假设总T细胞群体恒定，因此受感染细胞比例的任何增加都是以未受感染细胞比例的减少为代价的。\n- 质量作用接触动力学：未受感染细胞通过从头感染变为受感染细胞的速率，与受感染细胞比例和未受感染细胞比例的乘积成正比。\n- 固定种群下的类复制子增殖：受感染细胞的克隆增殖使受感染细胞比例增加，其增加量与受感染细胞比例和未受感染细胞比例的乘积成正比，因为在种群恒定的约束下，新的受感染细胞会替代未受感染的细胞。\n- 标记守恒：在受感染细胞比例中追踪两个标记的亚群。一个亚群包含通过克隆增殖从初始受感染细胞繁衍而来的细胞，另一个亚群包含通过从头感染事件产生的细胞（及其后代）。这些标记是守恒的；增殖作用于每个标记亚群的程度与其当前大小成正比。\n\n令 $i(t)$ 表示携带整合型前病毒的T细胞比例（即前病毒载量比例），$i_C(t)$ 表示可归因于初始受感染细胞克隆增殖的比例，$i_D(t)$ 表示可归因于从头感染事件（及其标记后代）的比例，且有 $i(t) = i_C(t) + i_D(t)$。令 $c$ 为克隆增殖系数（单位：每日），$k$ 为从头感染系数（单位：每日）。根据质量作用和守恒原理，该系统必须满足\n$$\n\\frac{d i_C}{d t} = c\\, i_C(t)\\,\\bigl(1 - i(t)\\bigr), \\qquad\n\\frac{d i_D}{d t} = c\\, i_D(t)\\,\\bigl(1 - i(t)\\bigr) + k\\, i(t)\\,\\bigl(1 - i(t)\\bigr),\n$$\n初始条件为 $i_C(0) = i_0$ 和 $i_D(0) = 0$，其中 $i_0 \\in [0,1]$ 是初始前病毒载量比例。\n\n您的程序必须：\n- 对上述系统进行数值积分，以计算在指定时间 $T$（单位：天）的 $i(T)$、$i_C(T)$ 和 $i_D(T)$。\n- 计算在时间 $T$ 时，从头感染对变化率的瞬时贡献分数，定义为\n$$\nf_{\\text{de}}(T) = \\begin{cases}\n\\dfrac{k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)}{c\\, i(T)\\, \\bigl(1 - i(T)\\bigr) + k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)},  \\text{如果分母非零}，\\\\\n0.0,  \\text{如果 } i(T) \\in \\{0,1\\} \\text{ 或 } c = k = 0 \\text{ 导致分母为零。}\n\\end{cases}\n$$\n\n所有速率必须以“每日”为单位表示，时间以“天”为单位，前病毒载量为无量纲分数。对于每个测试用例，报告一个包含四个浮点数的列表 $[i(T), i_C(T), i_D(T), f_{\\text{de}}(T)]$。在生成最终输出时，将每个浮点数四舍五入到六位小数。\n\n要实现和评估的测试套件：\n- 案例A（一般情况）：$i_0 = 0.01$，$c = 0.02$ /天，$k = 0.005$ /天，$T = 365$ 天。\n- 案例B（仅从头感染）：$i_0 = 0.005$，$c = 0.0$ /天，$k = 0.05$ /天，$T = 100$ 天。\n- 案例C（混合，增长更快）：$i_0 = 0.2$，$c = 0.05$ /天，$k = 0.2$ /天，$T = 60$ 天。\n- 案例D（仅克隆增殖）：$i_0 = 0.005$，$c = 0.02$ /天，$k = 0.0$ /天，$T = 200$ 天。\n- 案例E（无初始种子）：$i_0 = 0.0$，$c = 0.03$ /天，$k = 0.1$ /天，$T = 50$ 天。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号括起来的列表的逗号分隔列表，例如：\n- \"[[a11,a12,a13,a14],[a21,a22,a23,a24],...]\"，其中每个 \"aij\" 是一个四舍五入到六位小数的浮点数，按顺序代表给定案例的 $i(T)$、$i_C(T)$、$i_D(T)$ 和 $f_{\\text{de}}(T)$。", "solution": "所提供的问题在科学上是适定的，数学上是一致的，并包含推导唯一解所需的所有必要信息。该模型基于已确立的种群动力学原理，特别是质量作用动力学和守恒定律，使其成为一个有效的数学生物学问题。因此，我们可以进行形式化的求解。\n\n问题的核心是求解一个关于T细胞比例 $i_C(t)$ 和 $i_D(t)$ 的双耦合常微分方程（ODEs）系统：\n$$\n\\frac{d i_C}{d t} = c\\, i_C(t)\\,\\bigl(1 - i(t)\\bigr) \\quad (1)\n$$\n$$\n\\frac{d i_D}{d t} = c\\, i_D(t)\\,\\bigl(1 - i(t)\\bigr) + k\\, i(t)\\,\\bigl(1 - i(t)\\bigr) \\quad (2)\n$$\n其中 $i(t) = i_C(t) + i_D(t)$ 是受感染细胞的总比例。初始条件为 $i_C(0) = i_0$ 和 $i_D(0) = 0$，这意味着 $i(0) = i_0$。\n\n虽然这些方程可以使用数值积分求解，但更严谨和准确的方法是找到解析解。首先，我们通过将方程 $(1)$ 和 $(2)$ 相加来推导总受感染比例 $i(t)$ 的方程：\n$$\n\\frac{d i}{d t} = \\frac{d i_C}{d t} + \\frac{d i_D}{d t} = c\\, i_C(t)\\,(1 - i(t)) + c\\, i_D(t)\\,(1 - i(t)) + k\\, i(t)\\,(1 - i(t))\n$$\n对各项进行因式分解并代入 $i(t) = i_C(t) + i_D(t)$：\n$$\n\\frac{d i}{d t} = c\\,\\bigl(i_C(t) + i_D(t)\\bigr)\\,(1 - i(t)) + k\\, i(t)\\,(1 - i(t))\n$$\n$$\n\\frac{d i}{d t} = c\\, i(t)\\,(1 - i(t)) + k\\, i(t)\\,(1 - i(t)) = (c+k)\\, i(t)\\,(1 - i(t))\n$$\n这是标准 logistic 增长方程，其有效增长率为 $K_{eff} = c+k$。对于初始条件 $i(0) = i_0$，其解析解为：\n$$\ni(t) = \\frac{i_0 e^{K_{eff} t}}{1 - i_0 + i_0 e^{K_{eff} t}} = \\frac{1}{1 + \\left(\\frac{1}{i_0} - 1\\right)e^{-K_{eff} t}}\n$$\n该解在 $i_0  0$ 且 $i_0  1$ 的条件下有效。如果 $i_0 = 0$，唯一解是对于所有 $t$，$i(t) = 0$。如果 $i_0 = 1$，解是对于所有 $t$，$i(t) = 1$。\n\n接下来，我们求解 $i_C(t)$。我们可以将方程 $(1)$ 重写为线性一阶常微分方程：\n$$\n\\frac{d i_C}{d t} - c\\,\\bigl(1 - i(t)\\bigr)\\,i_C(t) = 0\n$$\n为了求解此方程，我们也可以观察 $i_C(t)$ 和 $i(t)$ 的增长率之比。将 $\\frac{1}{i_C}\\frac{di_C}{dt}$ 除以 $\\frac{1}{i}\\frac{di}{dt}$：\n$$\n\\frac{\\frac{d}{dt}\\ln(i_C)}{\\frac{d}{dt}\\ln(i)} = \\frac{c\\,(1-i(t))}{(c+k)\\,(1-i(t))} = \\frac{c}{c+k}\n$$\n此式在 $1-i(t) \\neq 0$ 和 $c+k \\neq 0$ 的时间 $t$ 成立。这意味着 $i_C$ 和 $i$ 之间存在幂律关系：\n$$\nd(\\ln i_C) = \\frac{c}{c+k} d(\\ln i)\n$$\n从 $t=0$ 积分到任意时间 $t$ 可得：\n$$\n\\ln(i_C(t)) - \\ln(i_C(0)) = \\frac{c}{c+k} \\bigl( \\ln(i(t)) - \\ln(i(0)) \\bigr)\n$$\n使用初始条件 $i_C(0) = i_0$ 和 $i(0) = i_0$：\n$$\n\\ln\\left(\\frac{i_C(t)}{i_0}\\right) = \\frac{c}{c+k} \\ln\\left(\\frac{i(t)}{i_0}\\right) = \\ln\\left(\\left(\\frac{i(t)}{i_0}\\right)^{\\frac{c}{c+k}}\\right)\n$$\n对两边取指数，得到 $i_C(t)$ 的解析解：\n$$\ni_C(t) = i_0 \\left(\\frac{i(t)}{i_0}\\right)^{\\frac{c}{c+k}}\n$$\n该解在 $i_0  0$ 和 $c+k \\neq 0$ 时有效。\n\n如果 $k=0$ 且 $c0$，指数为 $1$，因此 $i_C(t) = i(t)$。这是一致的，因为没有从头感染意味着所有受感染的细胞都源于原始克隆。\n如果 $c=0$ 且 $k0$，指数为 $0$，因此 $i_C(t) = i_0 (i(t)/i_0)^0 = i_0$。这也是一致的，因为没有克隆增殖意味着初始克隆群体大小不增加（其比例仅因父模型中捕获的种群水平效应而改变，但在此处 $di_C/dt=0$）。\n\n比例 $i_D(t)$ 通过相减得到：$i_D(t) = i(t) - i_C(t)$。\n\n需要考虑的特殊情况：\n1. 如果 $i_0 = 0$：$i_C(0)=0$ 且 $i_D(0)=0$。$i(t)$ 的常微分方程给出对于所有 $t$，$i(t)=0$。因此，$i_C(t)=0$ 且 $i_D(t)=0$。\n2. 如果 $c+k = 0$：$i(t)$ 的增长率为 $0$，因此对于所有 $t$，$i(t) = i_0$。$i_C(t)$ 的方程变为 $\\frac{di_C}{dt} = c\\, i_C(t)\\,(1-i_0)$。解为 $i_C(t) = i_0 e^{c(1-i_0)t}$。\n\n最后，我们必须计算从头感染的瞬时贡献分数 $f_{\\text{de}}(T)$。所提供的定义为：\n$$\nf_{\\text{de}}(T) = \\frac{\\text{从头感染的增长率}}{\\text{总增长率}} = \\frac{k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)}{c\\, i(T)\\, \\bigl(1 - i(T)\\bigr) + k\\, i(T)\\, \\bigl(1 - i(T)\\bigr)}\n$$\n如果分母不为零，项 $i(T)(1-i(T))$ 可以消去，得到：\n$$\nf_{\\text{de}}(T) = \\frac{k}{c+k}\n$$\n如果 $i(T) \\in \\{0, 1\\}$ 或 $c+k=0$，则分母为零。问题规定在这些情况下 $f_{\\text{de}}(T) = 0.0$。我们的算法将实现此逻辑。如果 $c=k=0$，则 $c+k=0$，且 $f_{\\text{de}}(T) = 0.0$。\n\n每个测试用例的算法如下：\n1. 给定参数 $i_0$、$c$、$k$ 和 $T$。\n2. 处理边缘情况 $i_0=0$。如果成立，则 $i(T)=0$，$i_C(T)=0$，$i_D(T)=0$，以及 $f_{\\text{de}}(T)=0$。\n3. 如果 $i_0  0$，计算有效增长率 $K_{eff} = c+k$。\n4. 如果 $K_{eff} = 0$，则 $i(T) = i_0$。根据测试用例，这种情况在 $c  0$ 或 $k  0$ 时不会发生。如果两者都为零，则 $i_C(T) = i_0$，$i_D(T) = 0$。\n5. 如果 $K_{eff} \\ne 0$，使用 logistic 解的公式计算 $i(T)$。\n6. 使用推导出的幂律公式计算 $i_C(T)$。特别注意 $c=0$ 或 $k=0$ 的情况（只要 $c+k \\ne 0$，通用公式就能正确处理这些情况）。\n7. 计算 $i_D(T) = i(T) - i_C(T)$。\n8. 计算 $f_{\\text{de}}(T)$。如果 $c+k = 0$ 或 $i(T)$ 在数值上与 $0$ 或 $1$ 无法区分，则设置 $f_{\\text{de}}(T)=0$。否则，计算 $f_{\\text{de}}(T) = k/(c+k)$。\n9. 返回四个值 $[i(T), i_C(T), i_D(T), f_{\\text{de}}(T)]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not needed due to the analytical solution.\n\ndef solve():\n    \"\"\"\n    Main function to solve the HTLV-1 dynamics problem for a suite of test cases.\n    \"\"\"\n    # Test suite from the problem statement.\n    # Each case is a tuple: (i0, c, k, T)\n    test_cases = [\n        # Case A (general)\n        (0.01, 0.02, 0.005, 365),\n        # Case B (de novo only)\n        (0.005, 0.0, 0.05, 100),\n        # Case C (mixed, faster growth)\n        (0.2, 0.05, 0.2, 60),\n        # Case D (clonal only)\n        (0.005, 0.02, 0.0, 200),\n        # Case E (no seed)\n        (0.0, 0.03, 0.1, 50),\n    ]\n\n    all_results = []\n    \n    # Set a small tolerance for floating point comparisons to 0 and 1.\n    TOLERANCE = 1e-9\n\n    for case in test_cases:\n        i0, c, k, T = case\n\n        # Handle the trivial case where there are no initial infected cells.\n        if i0 == 0.0:\n            i_T, iC_T, iD_T = 0.0, 0.0, 0.0\n        else:\n            K_eff = c + k\n\n            # Handle case where total growth rate is zero.\n            if abs(K_eff)  TOLERANCE:\n                i_T = i0\n                # In this case, diC/dt = 0 since c is also 0.\n                if abs(c)  TOLERANCE:\n                    iC_T = i0\n                # A more general case (c=-k!=0) would solve diC/dt = c*iC*(1-i0)\n                else:\n                    iC_T = i0 * np.exp(c * (1.0 - i0) * T)\n            else:\n                # Calculate total infected fraction i(T) using the logistic solution.\n                # Avoid division by zero if i0 is 1.0.\n                if abs(i0 - 1.0)  TOLERANCE:\n                    i_T = 1.0\n                else:\n                    denominator = 1.0 + (1.0 / i0 - 1.0) * np.exp(-K_eff * T)\n                    i_T = 1.0 / denominator\n\n                # Calculate clonal fraction i_C(T).\n                if abs(c)  TOLERANCE:\n                    # If c=0, diC/dt = 0, so iC is constant.\n                    iC_T = i0\n                else:\n                    # Power-law relationship between i_C and i.\n                    # This formula correctly handles the k=0 case (exponent becomes 1).\n                    ratio = i_T / i0\n                    # Handle potential negative base in power for unstable numerical cases\n                    if ratio  0: ratio = 0\n                    exponent = c / K_eff\n                    iC_T = i0 * (ratio ** exponent)\n            \n            # De novo fraction is the remainder.\n            iD_T = i_T - iC_T\n\n        # Calculate the instantaneous fractional contribution of de novo infection f_de(T).\n        # The denominator of the full expression is zero if i(T) is 0 or 1, or if c+k is 0.\n        denominator_is_zero = (abs(c + k)  TOLERANCE) or \\\n                              (abs(i_T)  TOLERANCE) or \\\n                              (abs(i_T - 1.0)  TOLERANCE)\n        \n        if denominator_is_zero:\n            f_de_T = 0.0\n        else:\n            # Simplified formula when the denominator is non-zero.\n            f_de_T = k / (c + k)\n\n        all_results.append([i_T, iC_T, iD_T, f_de_T])\n\n    # Format the final output string as specified.\n    # Each float must be rounded to six decimal places.\n    output_parts = []\n    for res_list in all_results:\n        # e.g., res_list = [i(T), iC(T), iD(T), f_de(T)]\n        formatted_list = [f\"{x:.6f}\" for x in res_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    print(final_output_string)\n\nsolve()\n```", "id": "4652936"}, {"introduction": "最后，我们将把对病毒的理解应用于临床结果的分析。由 HTLV-1 引起的成人 T 细胞白血病/淋巴瘤（ATL）有多种亚型，其预后差异显著。本练习介绍了一种强大的统计工具——Cox 比例风险模型，用于分析不同 ATL 亚型患者的生存数据，并量化其死亡风险差异。更重要的是，本练习强调了评估模型基本假设（即比例风险假设）的必要性，这是严谨解读临床研究结果、培养批判性思维的关键一步 [@problem_id:4652901]。", "problem": "对一个感染了人类T淋巴细胞病毒1型 (HTLV-1) 的患者队列进行了前瞻性随访，以研究成人T细胞白血病/淋巴瘤 (ATL) 各亚型之间的生存差异。设事件时间变量以月为单位，记为 $t$，并假设为非信息性右删失。考虑一个Cox比例风险 (Cox PH) 模型，其基线风险 $h_{0}(t)$ 未指定，并包含一个分类协变量，该协变量指示ATL亚型，水平为急性型 (acute)、淋巴瘤型 (lymphoma) 和闷燃型 (smoldering)。使用两个指示变量 $x_{\\text{acute}} \\in \\{0,1\\}$ 和 $x_{\\text{lymphoma}} \\in \\{0,1\\}$ 对亚型进行编码，以闷燃型为参照组，因此急性型为 $x_{\\text{acute}}=1$ 和 $x_{\\text{lymphoma}}=0$，淋巴瘤型为 $x_{\\text{acute}}=0$ 和 $x_{\\text{lymphoma}}=1$，闷燃型为 $x_{\\text{acute}}=0$ 和 $x_{\\text{lymphoma}}=0$。拟合模型的线性预测子为 $\\eta(t)=\\beta_{\\text{acute}} x_{\\text{acute}}+\\beta_{\\text{lymphoma}} x_{\\text{lymphoma}}$，风险为 $h(t \\mid x)=h_{0}(t)\\exp(\\eta(t))$。\n\n对 $n=180$ 名患者拟合了一个Cox PH模型，得到亚型指示变量的最大偏似然估计值和稳健标准误如下：$\\hat{\\beta}_{\\text{acute}}=1.10$，其$\\operatorname{SE}(\\hat{\\beta}_{\\text{acute}})=0.25$；以及 $\\hat{\\beta}_{\\text{lymphoma}}=0.65$，其$\\operatorname{SE}(\\hat{\\beta}_{\\text{lymphoma}})=0.20$。为了评估比例风险假设（原假设下斜率为零），我们将每个系数的度量Schoenfeld残差对随访时间 $t$ (以月为单位) 进行了回归。估计的斜率及其标准误如下：对于急性型指示变量，$\\hat{\\gamma}_{\\text{acute}}=0.009$，其$\\operatorname{SE}(\\hat{\\gamma}_{\\text{acute}})=0.003$；对于淋巴瘤型指示变量，$\\hat{\\gamma}_{\\text{lymphoma}}=-0.001$，其$\\operatorname{SE}(\\hat{\\gamma}_{\\text{lymphoma}})=0.003$。对每个斜率使用 $\\alpha=0.05$ 的双边检验。\n\n从风险函数和比例风险结构的定义出发，推导比较急性型与闷燃型以及淋巴瘤型与闷燃型的风险比，并使用提供的Schoenfeld残差斜率判断比例风险假设对每个指示变量是否成立。然后，以无量纲小数形式报告急性型与闷燃型的风险比，将答案四舍五入到四位有效数字。", "solution": "本题将通过以下步骤解决：首先，从Cox比例风险 (PH) 模型的结构中推导出风险比 (HR) 的一般形式。其次，使用度量Schoenfeld残差分析提供的统计数据，检验每个协变量的比例风险假设。最后，计算所要求的特定风险比。\n\nCox比例风险模型将具有一组协变量 $x$ 的个体在时间 $t$ 的风险描述为：\n$$h(t \\mid x) = h_{0}(t) \\exp(\\eta)$$\n其中 $h_{0}(t)$ 是基线风险函数，是一个任意的非负时间函数，而 $\\eta$ 是线性预测子。在本题中，协变量是ATL亚型的指示变量，线性预测子为 $\\eta = \\beta_{\\text{acute}} x_{\\text{acute}} + \\beta_{\\text{lymphoma}} x_{\\text{lymphoma}}$。题目陈述中使用的 $\\eta(t)$ 存在轻微的符号不一致，因为线性预测子的定义表明它不是时间 $t$ 的函数。我们将采用 $\\eta$ 的标准时不变形式。\n\n让我们定义三种ATL亚型的风险函数：\n1.  对于闷燃型 (参照组)，$x_{\\text{acute}}=0$ 且 $x_{\\text{lymphoma}}=0$。其风险为：\n    $$h_{\\text{smoldering}}(t) = h_{0}(t) \\exp(\\beta_{\\text{acute}} \\cdot 0 + \\beta_{\\text{lymphoma}} \\cdot 0) = h_{0}(t) \\exp(0) = h_{0}(t)$$\n2.  对于急性型，$x_{\\text{acute}}=1$ 且 $x_{\\text{lymphoma}}=0$。其风险为：\n    $$h_{\\text{acute}}(t) = h_{0}(t) \\exp(\\beta_{\\text{acute}} \\cdot 1 + \\beta_{\\text{lymphoma}} \\cdot 0) = h_{0}(t) \\exp(\\beta_{\\text{acute}})$$\n3.  对于淋巴瘤型，$x_{\\text{acute}}=0$ 且 $x_{\\text{lymphoma}}=1$。其风险为：\n    $$h_{\\text{lymphoma}}(t) = h_{0}(t) \\exp(\\beta_{\\text{acute}} \\cdot 0 + \\beta_{\\text{lymphoma}} \\cdot 1) = h_{0}(t) \\exp(\\beta_{\\text{lymphoma}})$$\n\n风险比是两组风险函数的比率。“比例风险”特性源于该比率不随时间变化这一事实。\n\n比较急性型与闷燃型的风险比如下：\n$$HR_{\\text{acute vs smoldering}} = \\frac{h_{\\text{acute}}(t)}{h_{\\text{smoldering}}(t)} = \\frac{h_{0}(t) \\exp(\\beta_{\\text{acute}})}{h_{0}(t)} = \\exp(\\beta_{\\text{acute}})$$\n类似地，比较淋巴瘤型与闷燃型的风险比如下：\n$$HR_{\\text{lymphoma vs smoldering}} = \\frac{h_{\\text{lymphoma}}(t)}{h_{\\text{smoldering}}(t)} = \\frac{h_{0}(t) \\exp(\\beta_{\\text{lymphoma}})}{h_{0}(t)} = \\exp(\\beta_{\\text{lymphoma}})$$\n所提供的估计系数 $\\hat{\\beta}$ 是真实参数 $\\beta$ 的最大偏似然估计值。\n\n接下来，我们必须评估每个协变量的比例风险假设的有效性。该假设意味着上面推导出的风险比不随时间变化。题目提供了基于度量Schoenfeld残差的该假设的形式检验结果。对于每个协变量，度量残差都对时间 $t$ 进行回归。该回归的斜率 $\\gamma$ 针对原假设 $H_0: \\gamma = 0$ 进行检验。如果 $H_0$ 被拒绝，则有证据表明协变量的效应（对数风险比）随时间变化，这违反了PH假设。我们使用双边Wald检验，其检验统计量为 $Z = \\frac{\\hat{\\gamma}}{\\operatorname{SE}(\\hat{\\gamma})}$，在原假设下服从标准正态分布。给定的显著性水平为 $\\alpha=0.05$，其临界值为 $Z_{\\alpha/2} = \\pm 1.96$。\n\n对于急性型指示变量 ($x_{\\text{acute}}$)：\n估计的斜率为 $\\hat{\\gamma}_{\\text{acute}} = 0.009$，其 $\\operatorname{SE}(\\hat{\\gamma}_{\\text{acute}}) = 0.003$。\n检验统计量为：\n$$Z_{\\text{acute}} = \\frac{\\hat{\\gamma}_{\\text{acute}}}{\\operatorname{SE}(\\hat{\\gamma}_{\\text{acute}})} = \\frac{0.009}{0.003} = 3.00$$\n由于 $|Z_{\\text{acute}}| = 3.00 > 1.96$，我们拒绝原假设。在 $\\alpha=0.05$ 的水平上，有统计学上显著的证据表明，对于急性型指示变量，比例风险假设被违反。正斜率 $\\hat{\\gamma}_{\\text{acute}} > 0$ 表明急性型（相对于闷燃型）的风险比随时间增加。\n\n对于淋巴瘤型指示变量 ($x_{\\text{lymphoma}}$)：\n估计的斜率为 $\\hat{\\gamma}_{\\text{lymphoma}} = -0.001$，其 $\\operatorname{SE}(\\hat{\\gamma}_{\\text{lymphoma}}) = 0.003$。\n检验统计量为：\n$$Z_{\\text{lymphoma}} = \\frac{\\hat{\\gamma}_{\\text{lymphoma}}}{\\operatorname{SE}(\\hat{\\gamma}_{\\text{lymphoma}})} = \\frac{-0.001}{0.003} \\approx -0.333$$\n由于 $|Z_{\\text{lymphoma}}| \\approx 0.333  1.96$，我们未能拒绝原假设。没有足够的证据得出结论，认为对于淋巴瘤型指示变量，比例风险假设被违反。\n\n最后，题目要求报告急性型与闷燃型的风险比。尽管该协变量的PH假设被违反，但值 $\\exp(\\hat{\\beta}_{\\text{acute}})$ 代表了从拟合模型中得到的时间平均风险比。题目的要求是报告这个特定的量。\n使用提供的估计值 $\\hat{\\beta}_{\\text{acute}} = 1.10$：\n$$\\widehat{HR}_{\\text{acute vs smoldering}} = \\exp(\\hat{\\beta}_{\\text{acute}}) = \\exp(1.10)$$\n计算该值：\n$$\\exp(1.10) \\approx 3.00416602...$$\n四舍五入到四位有效数字，我们得到 $3.004$。\n应谨慎解释此值，因为它是一个平均效应，并且PH假设的检验表明，真实的风险比在随访期间并非恒定。", "answer": "$$\n\\boxed{3.004}\n$$", "id": "4652901"}]}