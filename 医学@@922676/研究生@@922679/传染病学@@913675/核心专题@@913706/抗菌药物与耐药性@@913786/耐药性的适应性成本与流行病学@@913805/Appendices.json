{"hands_on_practices": [{"introduction": "选择系数（$s$）是量化不同病原体株相对适应性的核心指标。本练习提供了一种基于流行病早期指数增长率直接计算 $s$ 的方法，将理论概念与可观测数据联系起来。通过这个计算，我们将探讨理解其背后假设的重要性，例如在测量适应性“成本”时，必须在无药物选择压力的环境中进行。[@problem_id:4643675]", "problem": "在一个充分混合的宿主群体中，传播的早期、低流行阶段，两种病原体菌株——药物敏感型和药物耐药型——近似呈指数增长。设菌株 $i \\in \\{s,r\\}$ 在时间 $t$ 的丰度为 $N_i(t)$，且 $N_i(t) = N_i(0)\\exp(r_i t)$，其中 $r_i$ 是马尔萨斯（人均）指数增长率。考虑一个相对适应度的连续时间定义，其中耐药菌株的选择系数 $s$ 是其马尔萨斯增长率与敏感菌株相比，相对于敏感菌株基线的比例差异。\n\n从第一性原理出发，基于指数增长模型和此相对适应度定义，推导出一个仅用 $r_r$ 和 $r_s$ 表示的 $s$ 的估计量。然后，给定从同一日历窗口收集的监测数据的独立对数线性拟合中观测到的早期增长估计值 $r_s = 0.28 \\text{ day}^{-1}$ 和 $r_r = 0.238 \\text{ day}^{-1}$，计算 $s$ 的数值。将您的 $s$ 数值答案四舍五入到四位有效数字，并以纯数（无单位）形式报告。\n\n最后，陈述该估计量在此情境下构成与耐药性相关的适应度成本或优势的有效度量的最低流行病学条件。您的讨论应基于原则并植根于潜在的模型假设，但您最终报告的答案必须仅为 $s$ 的数值。", "solution": "首先对问题陈述进行验证。\n\n### 第一步：提取已知条件\n- 两种病原体菌株：药物敏感型 ($s$) 和药物耐药型 ($r$)。\n- 背景：一个在传播的早期、低流行阶段的充分混合的宿主群体。\n- 菌株 $i \\in \\{s,r\\}$ 的增长模型：$N_i(t) = N_i(0)\\exp(r_i t)$，其中 $N_i(t)$ 是时间 $t$ 的丰度，$r_i$ 是马尔萨斯人均指数增长率。\n- 选择系数 ($s$) 的定义：耐药菌株 ($r_r$) 的马尔萨斯增长率与敏感菌株 ($r_s$) 相比，相对于敏感菌株基线的比例差异。\n- 观测数据：$r_s = 0.28 \\text{ day}^{-1}$ 和 $r_r = 0.238 \\text{ day}^{-1}$。\n- 要求输出：\n    1. 一个用 $r_r$ 和 $r_s$ 表示的 $s$ 的估计量。\n    2. $s$ 的数值，四舍五入到四位有效数字。\n    3. 该估计量作为适应度成本或优势的度量有效性的最低流行病学条件。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于流行病学中用于描述疫情早期的标准指数增长模型。将选择系数定义为马尔萨斯增长率的相对差异是演化生物学和群体遗传学中的一个基本概念。提供的增长率值是现实的。该问题在科学上是合理的。\n- **良态问题：** 该问题为待估计量 ($s$) 提供了明确的定义，所有必要的数据 ($r_r$ 和 $r_s$)，以及一组明确的任务。可以直接从提供的信息中推导出唯一且有意义的解。\n- **客观性：** 语言正式、精确，没有主观或含糊的术语。\n\n### 第三步：结论与行动\n该问题是有效的，因为它具有科学依据、是良态问题、客观且内部一致。可以继续求解过程。\n\n### 推导与计算\n\n问题将耐药菌株的选择系数 $s$ 定义为其马尔萨斯增长率 $r_r$ 与敏感菌株的增长率 $r_s$ 相比，相对于敏感菌株基线 $r_s$ 的比例差异。这个文字定义可以形式化为一个数学表达式。增长率的差异是 $r_r - r_s$。相对于敏感菌株基线 $r_s$ 的比例差异是这个差值除以 $r_s$。\n\n因此，选择系数 $s$ 的估计量为：\n$$s = \\frac{r_r - r_s}{r_s}$$\n该表达式也可以写作：\n$$s = \\frac{r_r}{r_s} - 1$$\n这就是所要求的仅用 $r_r$ 和 $r_s$ 表示的 $s$ 的估计量。\n\n接下来，我们使用提供的观测增长率计算 $s$ 的数值：$r_s = 0.28 \\text{ day}^{-1}$ 和 $r_r = 0.238 \\text{ day}^{-1}$。将这些值代入推导出的公式中：\n$$s = \\frac{0.238 - 0.28}{0.28}$$\n$$s = \\frac{-0.042}{0.28}$$\n$$s = -0.15$$\n问题要求答案四舍五入到四位有效数字。精确值为 $-0.15$，有两位有效数字。为了用四位有效数字表示，我们追加两个零。\n$$s = -0.1500$$\n负号表示在进行这些测量的环境中，耐药菌株的马尔萨斯增长率低于敏感菌株。这代表了一种选择劣势。\n\n### 有效性的最低流行病学条件\n\n要使这个估计量 $s = (r_r - r_s)/r_s$ 成为与耐药性相关的适应度成本的有效度量，必须满足某些流行病学条件，这些条件直接源于模型的假设。\n\n1.  **低疾病流行率：** 指数增长模型 $N_i(t) = N_i(0)\\exp(r_i t)$ 仅在宿主群体中易感者比例几乎恒定时才是一个精确的近似。这个条件在疫情早期阶段成立，此时流行率低，因此易感者的耗减可以忽略不计。\n\n2.  **无选择压力：** 耐药性的“适应度成本”这一术语特指由于耐药机制导致的病原体内在适应度的降低，这种降低是在*没有*选择剂（例如，药物）的环境中测量的。因此，要使计算出的 $s$ 的负值代表适应度*成本*，$r_s$ 和 $r_r$ 的增长率必须是在一个未接受针对 $r$ 菌株耐药的药物治疗的宿主群体中测得的。如果治疗普遍存在，耐药菌株很可能会具有选择*优势*（$s  0$），而 $s$ 将衡量在药物存在下耐药性的益处，而不是其内在成本。\n\n3.  **相同的流行病学背景：** 该估计量假设影响两种菌株人均增长率的唯一系统性差异是赋予耐药性的基因位点。这要求两种菌株在同一个充分混合的群体中共同传播，受到相同的接触模式、宿主免疫反应和其他生态因素的影响。问题中指明数据是“从同一日历窗口”从一个“充分混合的宿主群体”中收集的，这支持了这一条件。\n\n总而言之，最低条件是：疾病流行率低，宿主群体中没有相关的药物治疗，以及两种菌株共享一个同质的流行病学环境。", "answer": "$$\\boxed{-0.1500}$$", "id": "4643675"}, {"introduction": "即使在药物治疗下具有适应性优势，耐药株的成功建立也并非必然。种群数量波动带来的随机性——即个体随机的出生和死亡——可能导致小种群的灭绝。本练习运用分支过程模型来计算，要达到一个高的建立概率，所需耐药病原体的最小起始数量。这个过程揭示了适应性优势和初始种群规模之间的关键相互作用。[@problem_id:4643700]", "problem": "考虑暴露于治疗的宿主体内病原体种群。在没有治疗的情况下，耐药基因型相对于野生型会产生适应性成本，并呈现负净增长。在治疗下，野生型受到抑制，耐药基因型获得轻微优势，因此，当种群密度仍然很低且资源限制可以忽略不计时，耐药谱系的早期动态可以近似为一个连续时间线性生死分支过程：每个耐药个体独立地以人均速率 $b$ 出生，以人均速率 $d$ 死亡，且 $bd$。假设在治疗下，耐药基因型的 $b = 1.02\\,\\text{day}^{-1}$ 和 $d = 1.00\\,\\text{day}^{-1}$。在治疗开始时，有 $n_{0}$ 个耐药个体。\n\n将“建立”（establishment）操作性地定义为耐药谱系的不灭绝（即，在仅有种群随机性的影响下，该谱系最终不会灭绝的概率）。仅使用连续时间线性生死过程的第一性原理，且不假定任何预先推导的结果，从头推导一个表达式，用于计算使得建立概率至少为 $0.90$ 的最小整数 $n_{\\mathrm{crit}}$，然后用给定的 $b$ 和 $d$ 对其进行数值计算。将您的最终答案表示为一个整数计数（无单位）。除了选择满足标准的最小整数外，不需要其他舍入规则。", "solution": "问题要求计算使得耐药谱系的建立概率至少为 $0.90$ 所需的最小初始耐药个体数 $n_{\\mathrm{crit}}$。耐药谱系的动态由一个连续时间线性生死过程描述，其人均出生率为 $b$，人均死亡率为 $d$，且 $b  d$。我们需要从第一性原理推导解答。\n\n设 $N(t)$ 为时间 $t$ 时的耐药个体数。问题将建立定义为不灭绝。我们首先推导从单个个体 $N(0)=1$ 开始的谱系的最终灭绝概率。设 $P_{k}(t) = \\mathrm{Pr}(N(t)=k | N(0)=1)$。到时间 $t$ 为止的灭绝概率是 $P_0(t)$。我们寻求最终的灭绝概率 $\\pi_0 = \\lim_{t\\to\\infty} P_0(t)$。\n\n我们可以使用第一性原理的论证方法来推导 $P_0(t)$ 的微分方程。考虑一个微小的时间间隔 $\\Delta t$。一个从 $t=0$ 时的一个个体开始的谱系，会在时间 $t+\\Delta t$ 前灭绝，这可以通过以下几种方式之一发生：\n1. 初始个体在区间 $(0, \\Delta t]$ 内死亡。其概率为 $d \\Delta t + o(\\Delta t)$。此时谱系灭绝。\n2. 初始个体在区间 $(0, \\Delta t]$ 内出生。其概率为 $b \\Delta t + o(\\Delta t)$。种群数量变为 $2$。为了使整个谱系在时间 $t+\\Delta t$ 前灭绝，两个产生的子谱系都必须在剩余的时间 $t$ 内灭绝。由于子谱系独立演化，此事件的概率为 $(P_0(t))^2$。\n3. 初始个体在区间 $(0, \\Delta t]$ 内既不出生也不死亡。其概率为 $1 - (b+d)\\Delta t + o(\\Delta t)$。那么该谱系必须在剩余的时间 $t$ 内灭绝，其概率为 $P_0(t)$。\n\n将这些不相交的可能性相加，到时间 $t+\\Delta t$ 为止的总灭绝概率为：\n$$P_0(t+\\Delta t) = d \\Delta t + b \\Delta t [P_0(t)]^2 + [1 - (b+d)\\Delta t] P_0(t) + o(\\Delta t)$$\n整理各项，我们得到：\n$$\\frac{P_0(t+\\Delta t) - P_0(t)}{\\Delta t} = d + b [P_0(t)]^2 - (b+d) P_0(t) + \\frac{o(\\Delta t)}{\\Delta t}$$\n当 $\\Delta t \\to 0$ 时取极限，我们得到灭绝概率的微分方程，我们将其记为 $p_e(t) \\equiv P_0(t)$：\n$$\\frac{dp_e}{dt} = b p_e^2 - (b+d)p_e + d$$\n初始条件为 $p_e(0) = 0$，因为如果种群从一个个体开始，它在最开始时不可能已经灭绝。最终灭绝概率 $\\pi_0$ 是当 $t \\to \\infty$ 时该方程的稳态解。这对应于该动态系统的一个稳定不动点。通过设 $\\frac{dp_e}{dt} = 0$ 来找到不动点：\n$$b \\pi_0^2 - (b+d)\\pi_0 + d = 0$$\n这是一个关于 $\\pi_0$ 的二次方程，可以因式分解为：\n$$(b\\pi_0 - d)(\\pi_0 - 1) = 0$$\n两个不动点是 $\\pi_0 = 1$ 和 $\\pi_0 = \\frac{d}{b}$。\n\n由于问题陈述 $b  d$，我们有 $0  \\frac{d}{b}  1$。为了确定从 $p_e(0)=0$ 开始的最终灭绝概率对应哪个不动点，我们分析 $\\frac{dp_e}{dt}$ 的符号。函数 $f(p_e) = (bp_e - d)(p_e - 1)$ 是一个开口向上的抛物线。对于 $p_e \\in (0, d/b)$，我们有 $bp_e - d  0$ 和 $p_e - 1  0$，所以 $\\frac{dp_e}{dt} = f(p_e)  0$。这意味着如果系统从 $p_e(0)=0$ 开始，灭绝概率将随时间增加，趋近于它遇到的第一个不动点，即稳定不动点 $\\pi_0 = d/b$。不动点 $\\pi_0=1$ 是不稳定的。因此，从单个个体开始的谱系的最终灭绝概率是：\n$$\\pi_0 = \\frac{d}{b}$$\n\n现在，我们考虑一个由 $n_0$ 个耐药个体组成的初始种群。由于在线性生死过程中，每个个体的谱系是独立演化的，因此整个种群的灭绝当且仅当所有 $n_0$ 个独立谱系都灭绝。此事件的概率 $P_{ext}(n_0)$ 是各个灭绝概率的乘积：\n$$P_{ext}(n_0) = (\\pi_0)^{n_0} = \\left(\\frac{d}{b}\\right)^{n_0}$$\n建立的概率 $P_{est}(n_0)$ 是灭绝概率的补集：\n$$P_{est}(n_0) = 1 - P_{ext}(n_0) = 1 - \\left(\\frac{d}{b}\\right)^{n_0}$$\n我们需要找到最小的整数 $n_{\\mathrm{crit}}$，使得建立概率至少为 $0.90$。这给出了不等式：\n$$P_{est}(n_{\\mathrm{crit}}) \\ge 0.90$$\n$$1 - \\left(\\frac{d}{b}\\right)^{n_{\\mathrm{crit}}} \\ge 0.90$$\n整理不等式：\n$$\\left(\\frac{d}{b}\\right)^{n_{\\mathrm{crit}}} \\le 0.10$$\n为了解出 $n_{\\mathrm{crit}}$，我们对两边取自然对数。由于 $b  d$，我们有 $0  d/b  1$，这意味着 $\\ln(d/b)$ 是一个负数。取对数并除以这个负数会反转不等号的方向：\n$$\\ln\\left(\\left(\\frac{d}{b}\\right)^{n_{\\mathrm{crit}}}\\right) \\le \\ln(0.10)$$\n$$n_{\\mathrm{crit}} \\ln\\left(\\frac{d}{b}\\right) \\le \\ln(0.10)$$\n$$n_{\\mathrm{crit}} \\ge \\frac{\\ln(0.10)}{\\ln(d/b)}$$\n这个表达式可以简化为：\n$$n_{\\mathrm{crit}} \\ge \\frac{\\ln(10^{-1})}{\\ln(d) - \\ln(b)} = \\frac{-\\ln(10)}{-(\\ln(b) - \\ln(d))} = \\frac{\\ln(10)}{\\ln(b/d)}$$\n我们给定的参数值为 $b = 1.02\\,\\text{day}^{-1}$ 和 $d = 1.00\\,\\text{day}^{-1}$。我们将这些值代入不等式中：\n$$n_{\\mathrm{crit}} \\ge \\frac{\\ln(10)}{\\ln(1.02/1.00)} = \\frac{\\ln(10)}{\\ln(1.02)}$$\n现在，我们对此表达式进行数值计算：\n$$\\ln(10) \\approx 2.302585$$\n$$\\ln(1.02) \\approx 0.0198026$$\n$$n_{\\mathrm{crit}} \\ge \\frac{2.302585}{0.0198026} \\approx 116.276$$\n由于 $n_{\\mathrm{crit}}$ 必须是整数，满足此条件的最小整数值是大于 $116.276$ 的下一个整数。\n$$n_{\\mathrm{crit}} = 117$$", "answer": "$$\\boxed{117}$$", "id": "4643700"}, {"introduction": "本练习将适应性和选择的概念与真实的临床情景相结合，探索药理学中的一个关键概念：“突变选择窗”（MSW）。在这个浓度窗口内，药物浓度足以抑制敏感株，但不足以抑制耐药株。通过整合药代动力学（PK）和药效动力学（PD）模型，您将量化这种选择压力的持续时间及其累积强度，从而深入理解给药方案如何影响耐药性的出现。[@problem_id:4643699]", "problem": "考虑宿主中单剂量抗菌药物暴露，该过程由具有一级消除的一室药代动力学模型来模拟。设药物浓度随时间的变化为 $c(t)$，$t \\geq 0$，其中 $c(0) = c_0$ 且 $c(t)$ 根据一级消除单调递减。假设 $c(t)$ 由 $c(t) = c_0 e^{-k t}$ 给出，其中 $c_0$ 是初始浓度，$k$ 是消除速率常数。在药物暴露下，每个菌株 $i \\in \\{s, r\\}$（敏感株，耐药株）的净细菌生长速率由希尔型药效学函数描述：\n$$\ng_i(c) = \\psi_{\\min,i} + \\frac{\\psi_{\\max,i} - \\psi_{\\min,i}}{1 + \\left(\\frac{c}{\\mathrm{EC}_{50,i}}\\right)^{h_i}},\n$$\n其中 $\\psi_{\\max,i}$ 是无药物时的净生长速率，$\\psi_{\\min,i}$ 是在饱和药物浓度下的净生长速率（通常为负值，反映净杀菌效应），$\\mathrm{EC}_{50,i}$ 是半数有效浓度，而 $h_i$ 是控制曲线陡峭程度的希尔系数。\n\n将敏感株的最低抑菌浓度 (MIC) 定义为满足 $g_s(L) = 0$ 的浓度 $L$，将耐药株的突变预防浓度 (MPC) 定义为满足 $g_r(U) = 0$ 的浓度 $U$。突变选择窗 (MSW) 是浓度区间 $[L, U]$，在此区间内，敏感株被抑制（不生长），而耐药株可以生长，这意味着可能存在对耐药性的选择。令 $T$ 表示给药后 $c(t) \\in [L, U]$ 的总时间。此窗口内的累积选择压力由以下公式量化：\n$$\n\\int_{0}^{T} \\left[g_r(c(t)) - g_s(c(t))\\right] \\, dt,\n$$\n其中积分仅限于 $c(t)$ 位于 $[L, U]$ 内的实际时间区间（即，如果药代动力学轨迹未进入 MSW，则 $T$ 和积分均为零）。\n\n从上述定义以及给定的药代动力学和药效学模型出发，实现一个程序，为每个测试用例计算：\n- 在突变选择窗内停留的总时间 $T$（单位：小时）。\n- 累积选择 $\\int_{0}^{T} [g_r(c(t)) - g_s(c(t))] \\, dt$（无量纲量）。\n\n所有时间量必须以小时表示。浓度单位为毫克/升 (mg/L)。生长速率单位为小时的倒数 ($\\mathrm{h}^{-1}$)。累积选择积分为无量纲量。所有输出均表示为浮点数。如果药代动力学轨迹从未进入突变选择窗，或者如果 $U \\leq L$，则返回 $T = 0$ 且积分为 $0$。\n\n您的程序必须使用以下测试套件，其中每个用例指定了 $(c_0, k, \\psi_{\\max,s}, \\psi_{\\min,s}, \\mathrm{EC}_{50,s}, h_s, \\psi_{\\max,r}, \\psi_{\\min,r}, \\mathrm{EC}_{50,r}, h_r)$：\n\n- 用例 1（典型暴露，浓度高于两个边界）：$c_0 = 15$，$k = 0.35$，$\\psi_{\\max,s} = 1.2$，$\\psi_{\\min,s} = -5.0$，$\\mathrm{EC}_{50,s} = 2.0$，$h_s = 1.3$，$\\psi_{\\max,r} = 1.0$，$\\psi_{\\min,r} = -4.0$，$\\mathrm{EC}_{50,r} = 6.0$，$h_r = 1.3$。\n- 用例 2（初始浓度介于 $L$ 和 $U$ 之间）：$c_0 = 1.5$，$k = 0.35$，$\\psi_{\\max,s} = 1.2$，$\\psi_{\\min,s} = -5.0$，$\\mathrm{EC}_{50,s} = 2.0$，$h_s = 1.3$，$\\psi_{\\max,r} = 1.0$，$\\psi_{\\min,r} = -4.0$，$\\mathrm{EC}_{50,r} = 6.0$，$h_r = 1.3$。\n- 用例 3（初始浓度低于 $L$）：$c_0 = 0.5$，$k = 0.35$，$\\psi_{\\max,s} = 1.2$，$\\psi_{\\min,s} = -5.0$，$\\mathrm{EC}_{50,s} = 2.0$，$h_s = 1.3$，$\\psi_{\\max,r} = 1.0$，$\\psi_{\\min,r} = -4.0$，$\\mathrm{EC}_{50,r} = 6.0$，$h_r = 1.3$。\n- 用例 4（对于不同的药效学参数集，在上限边界处起始）：$c_0 = 0.809$，$k = 0.45$，$\\psi_{\\max,s} = 1.1$，$\\psi_{\\min,s} = -5.0$，$\\mathrm{EC}_{50,s} = 1.5$，$h_s = 1.0$，$\\psi_{\\max,r} = 0.9$，$\\psi_{\\min,r} = -4.5$，$\\mathrm{EC}_{50,r} = 3.5$，$h_r = 1.1$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果为格式化为 $[T,\\text{integral}]$ 的数对 $[T, \\text{积分}]$。因此，最终输出必须采用以下形式：\n$$\n[\\,[T_1,\\text{integral}_1],[T_2,\\text{integral}_2],[T_3,\\text{integral}_3],[T_4,\\text{integral}_4]\\,]\n$$\n其中每个浮点数格式化为六位小数。", "solution": "用户的问题被认为是有效的，因为它具有科学依据、问题明确且客观。它基于已建立的药代动力学和药效学原理，并为获得唯一解提供了全套所需的参数和定义。\n\n该问题要求为几组参数计算两个量：药物浓度 $c(t)$ 在突变选择窗 (MSW) 内停留的总时间 $T$，以及该时间段内的累积选择压力。\n\n求解过程可分解为三个主要步骤：\n1.  确定突变选择窗的边界 $[L, U]$。\n2.  确定药物浓度 $c(t)$ 落在此窗口内的时间区间。\n3.  计算总时间 $T$ 和选择压力在该时间区间上的定积分。\n\n**步骤 1：计算 MSW 边界（MIC 和 MPC）**\n\n一个菌株 $i$（敏感株 $s$ 或耐药株 $r$）的净细菌生长速率由希尔型函数给出：\n$$\ng_i(c) = \\psi_{\\min,i} + \\frac{\\psi_{\\max,i} - \\psi_{\\min,i}}{1 + \\left(\\frac{c}{\\mathrm{EC}_{50,i}}\\right)^{h_i}}\n$$\n敏感株的最低抑菌浓度 (MIC)，记为 $L$，是净生长速率为零时的浓度，即 $g_s(L) = 0$。我们求解 $L$：\n$$\n0 = \\psi_{\\min,s} + \\frac{\\psi_{\\max,s} - \\psi_{\\min,s}}{1 + \\left(\\frac{L}{\\mathrm{EC}_{50,s}}\\right)^{h_s}}\n$$\n整理各项可得：\n$$\n\\frac{\\psi_{\\max,s} - \\psi_{\\min,s}}{1 + \\left(\\frac{L}{\\mathrm{EC}_{50,s}}\\right)^{h_s}} = -\\psi_{\\min,s}\n$$\n$$\n1 + \\left(\\frac{L}{\\mathrm{EC}_{50,s}}\\right)^{h_s} = \\frac{\\psi_{\\max,s} - \\psi_{\\min,s}}{-\\psi_{\\min,s}}\n$$\n$$\n\\left(\\frac{L}{\\mathrm{EC}_{50,s}}\\right)^{h_s} = \\frac{\\psi_{\\max,s} - \\psi_{\\min,s}}{-\\psi_{\\min,s}} - 1 = \\frac{(\\psi_{\\max,s} - \\psi_{\\min,s}) - (-\\psi_{\\min,s})}{-\\psi_{\\min,s}} = \\frac{\\psi_{\\max,s}}{-\\psi_{\\min,s}}\n$$\n此推导在 $\\psi_{\\min,s}  0$ 和 $\\psi_{\\max,s} > 0$ 的条件下有效。求解 $L$：\n$$\nL = \\mathrm{EC}_{50,s} \\left( \\frac{\\psi_{\\max,s}}{-\\psi_{\\min,s}} \\right)^{\\frac{1}{h_s}}\n$$\n同理，通过设 $g_r(U) = 0$ 可求得耐药株的突变预防浓度 (MPC) $U$：\n$$\nU = \\mathrm{EC}_{50,r} \\left( \\frac{\\psi_{\\max,r}}{-\\psi_{\\min,r}} \\right)^{\\frac{1}{h_r}}\n$$\n突变选择窗是浓度区间 $[L, U]$。如果 $U \\leq L$，则认为 MSW 不存在，根据问题陈述，$T$ 和累积选择积分均为 $0$。\n\n**步骤 2：确定在 MSW 内的时间区间**\n\n药物浓度遵循一级消除曲线：$c(t) = c_0 e^{-k t}$。对于给定的 $k  0$，当 $t  0$ 时，该函数单调递减。我们需要找到时间区间 $[t_{\\text{start}}, t_{\\text{end}}]$，在此期间 $L \\leq c(t) \\leq U$。为了求出浓度达到特定值 $c$ 时的时间 $t$，我们对药代动力学方程进行逆运算：\n$$\nc = c_0 e^{-kt} \\implies \\frac{c}{c_0} = e^{-kt} \\implies \\ln\\left(\\frac{c}{c_0}\\right) = -kt \\implies t(c) = \\frac{1}{k} \\ln\\left(\\frac{c_0}{c}\\right)\n$$\n这仅在 $c  c_0$ 时有定义。令 $t_L = t(L)$ 和 $t_U = t(U)$。分析取决于初始浓度 $c_0$ 相对于 $L$ 和 $U$ 的值：\n\n1.  **情况 1：$c_0 > U$**\n    浓度从 MSW 上方开始，并衰减穿过该窗口。药物在时间 $t_U = \\frac{1}{k} \\ln\\left(\\frac{c_0}{U}\\right)$ 进入 MSW，并在时间 $t_L = \\frac{1}{k} \\ln\\left(\\frac{c_0}{L}\\right)$ 离开。积分的时间区间是 $[t_{\\text{start}}, t_{\\text{end}}] = [t_U, t_L]$。在窗口内的总时间是 $T = t_L - t_U = \\frac{1}{k}\\left(\\ln\\left(\\frac{c_0}{L}\\right) - \\ln\\left(\\frac{c_0}{U}\\right)\\right) = \\frac{1}{k}\\ln\\left(\\frac{U}{L}\\right)$。\n\n2.  **情况 2：$L  c_0 \\leq U$**\n    浓度从 MSW 内部开始。在窗口内的时间从 $t=0$ 开始，到浓度降至 $L$ 时结束，此时时间为 $t_L = \\frac{1}{k} \\ln\\left(\\frac{c_0}{L}\\right)$。积分区间是 $[t_{\\text{start}}, t_{\\text{end}}] = [0, t_L]$。总时间是 $T = t_L$。\n\n3.  **情况 3：$c_0 \\leq L$**\n    浓度从 MSW 的下边界或更低处开始，并且永远不会进入该窗口。在窗口内花费的时间是 $T = 0$，积分为 $0$。\n\n**步骤 3：计算累积选择**\n\n累积选择由以下积分给出：\n$$\nI = \\int_{t_{\\text{start}}}^{t_{\\text{end}}} \\left[ g_r(c(t)) - g_s(c(t)) \\right] dt\n$$\n被积函数是时间 $t$ 的函数：\n$$\n\\Delta g(t) = \\left(\\psi_{\\min,r} + \\frac{\\psi_{\\max,r} - \\psi_{\\min,r}}{1 + \\left(\\frac{c_0 e^{-kt}}{\\mathrm{EC}_{50,r}}\\right)^{h_r}}\\right) - \\left(\\psi_{\\min,s} + \\frac{\\psi_{\\max,s} - \\psi_{\\min,s}}{1 + \\left(\\frac{c_0 e^{-kt}}{\\mathrm{EC}_{50,s}}\\right)^{h_s}}\\right)\n$$\n该积分没有直接的解析解，必须进行数值计算。我们将使用标准的数值求积方法，例如 Python 中 `scipy.integrate.quad` 函数所提供的方法。\n\n**算法摘要**\n\n对于每个测试用例：\n1.  使用推导出的公式计算 $L$ 和 $U$。\n2.  如果 $U \\leq L$ 或初始浓度 $c_0 \\leq L$，则设 $T=0$ 和 $I=0$。\n3.  否则，根据 $c_0$ 相对于 $L$ 和 $U$ 的位置，确定积分界限 $[t_{\\text{start}}, t_{\\text{end}}]$ 和总时间 $T$。\n4.  定义被积函数 $\\Delta g(t) = g_r(c(t)) - g_s(c(t))$。\n5.  对 $\\Delta g(t)$ 从 $t_{\\text{start}}$ 到 $t_{\\text{end}}$ 进行数值积分以求得 $I$。\n6.  存储数对 $[T, I]$ 以备最终输出。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the antimicrobial resistance problem for a given set of test cases.\n    \"\"\"\n    \n    # Test cases: (c0, k, psi_max_s, psi_min_s, ec50_s, h_s, \n    #              psi_max_r, psi_min_r, ec50_r, h_r)\n    test_cases = [\n        (15, 0.35, 1.2, -5.0, 2.0, 1.3, 1.0, -4.0, 6.0, 1.3),\n        (1.5, 0.35, 1.2, -5.0, 2.0, 1.3, 1.0, -4.0, 6.0, 1.3),\n        (0.5, 0.35, 1.2, -5.0, 2.0, 1.3, 1.0, -4.0, 6.0, 1.3),\n        (0.809, 0.45, 1.1, -5.0, 1.5, 1.0, 0.9, -4.5, 3.5, 1.1),\n    ]\n\n    results = []\n\n    def growth_rate(c, psi_max, psi_min, ec50, h):\n        \"\"\"Calculates the net bacterial growth rate g(c) for a given concentration.\"\"\"\n        return psi_min + (psi_max - psi_min) / (1 + (c / ec50)**h)\n\n    for case in test_cases:\n        c0, k, psi_max_s, psi_min_s, ec50_s, h_s, \\\n        psi_max_r, psi_min_r, ec50_r, h_r = case\n\n        # Step 1: Calculate MIC (L) and MPC (U)\n        # Ensure psi_min values are negative to avoid division by zero or invalid log\n        if psi_min_s >= 0 or psi_min_r >= 0:\n            results.append([0.0, 0.0])\n            continue\n\n        L = ec50_s * (psi_max_s / -psi_min_s)**(1 / h_s)\n        U = ec50_r * (psi_max_r / -psi_min_r)**(1 / h_r)\n\n        # Step 2: Determine time interval based on c0, L, and U\n        if U = L or c0 = L:\n            T = 0.0\n            integral_val = 0.0\n        else:\n            if c0 > U:\n                # Starts above MSW, passes through it\n                t_start = (1 / k) * np.log(c0 / U)\n                t_end = (1 / k) * np.log(c0 / L)\n            else:  # L  c0 = U\n                # Starts inside MSW\n                t_start = 0.0\n                t_end = (1 / k) * np.log(c0 / L)\n            \n            T = t_end - t_start\n\n            # Step 3: Define integrand and compute the integral\n            def integrand(t):\n                ct = c0 * np.exp(-k * t)\n                g_s_t = growth_rate(ct, psi_max_s, psi_min_s, ec50_s, h_s)\n                g_r_t = growth_rate(ct, psi_max_r, psi_min_r, ec50_r, h_r)\n                return g_r_t - g_s_t\n            \n            # Use scipy.integrate.quad for numerical integration\n            integral_val, _ = quad(integrand, t_start, t_end)\n        \n        results.append([T, integral_val])\n    \n    # Format and print the final output\n    output_str = [f'[{r[0]:.6f},{r[1]:.6f}]' for r in results]\n    print(f\"[{','.join(output_str)}]\")\n\nsolve()\n```", "id": "4643699"}]}