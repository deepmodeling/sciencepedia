{"hands_on_practices": [{"introduction": "理解抗病毒药物作用的生物化学基础，是预测其疗效和耐药潜力的关键。本练习侧重于核苷类似物和核苷酸类似物之间的关键区别，要求您运用这些知识来预测西多福韦（cidofovir）对因病毒激酶突变而对其他药物产生耐药性的疱疹病毒的活性。掌握这种推理能力，能帮助临床医生和研究人员在主要治疗方案失败时，就二线治疗做出明智的决策。[@problem_id:4625062]", "problem": "一名患有严重皮肤黏膜单纯疱疹病毒 (HSV) 感染的患者，其实验室报告显示其胸苷激酶 (TK) 基因存在缺失。同时，该患者被发现患有巨细胞病毒 (CMV) 病毒血症，并证实其 UL97 磷酸转移酶发生突变，导致对 ganciclovir 耐药。请您基于核苷和核苷酸类似物激活以及病毒脱氧核糖核酸 (DNA) 聚合酶抑制的生物化学第一性原理，评估 cidofovir 在这种双重感染背景下的预期活性谱和耐药风险。\n\n使用以下基本原则：\n\n- 抗病毒核苷类似物通常需要通过病毒激酶进行初始磷酸化才能被激活；如果该激酶缺失或发生突变，依赖于它的药物通常会失去活性。\n- 抗病毒核苷酸类似物可以绕过第一步磷酸化所需的病毒激酶，并依赖宿主细胞激酶进行进一步磷酸化以达到活性状态。\n- 疱疹病毒的耐药性可能出现在激活步骤（激酶缺陷或突变）或靶点步骤（病毒 DNA 聚合酶突变，导致类似物结合或摻入减少）。\n\n基于这些原则，推断 cidofovir 是否对 TK 缺陷型 HSV 和 UL97 突变型 CMV 保持活性，如果保持活性，请指出可能消除 cidofovir 疗效的最合乎逻辑的耐药途径。假设 cidofovir 是一种无环胞苷单磷酸类似物，需要通过宿主激酶转化为 cidofovir 二磷酸来抑制病毒 DNA 聚合酶，并且靶向聚合酶的抗病毒药物之间的交叉耐药模式反映了聚合酶活性位点上共享的结合决定簇。\n\n在这种情况下，哪项陈述最能准确描述 cidofovir 的预期活性和耐药性特征？\n\nA. Cidofovir 对 TK 缺陷型 HSV 和 UL97 突变型 CMV 保持活性，因为其激活不依赖于病毒激酶；耐药性最可能通过病毒 DNA 聚合酶突变产生（对于 CMV 是 UL54；对于 HSV 是 DNA 聚合酶基因），可能与其他聚合酶抑制剂（如 foscarnet）存在依赖于具体突变的交叉耐药性；UL97 突变本身不会导致对 cidofovir 的耐药。\n\nB. Cidofovir 对 TK 缺陷型 HSV 失去活性，但对 UL97 突变型 CMV 保持活性，因为 TK 缺陷阻断了其初始磷酸化，而 UL97 突变不影响 cidofovir；对 cidofovir 的耐药性主要通过激酶突变产生。\n\nC. Cidofovir 对 TK 缺陷型 HSV 保持活性，但对 UL97 突变型 CMV 失去活性，因为在 CMV 中，UL97 是 cidofovir 初始磷酸化所必需的；CMV 对 cidofovir 的耐药性是由 UL97 突变介导的，而非聚合酶变化。\n\nD. Cidofovir 对 TK 缺陷型 HSV 和 UL97 突变型 CMV 均无活性，因为它需要病毒 TK 和 UL97 进行第一步磷酸化；因此，无论下游步骤如何，激酶突变都会普遍消除其活性。\n\nE. Cidofovir 对 TK 缺陷型 HSV 和 UL97 突变型 CMV 保持活性；然而，UL97 突变通常会导致对 cidofovir 的高级别交叉耐药，并且由于其活性位点与其他聚合酶抑制剂不同，由聚合酶介导的对 cidofovir 的耐药性不太可能发生。", "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 患者同时感染 (1) `Herpes Simplex Virus` ($HSV$) 和 (2) `Cytomegalovirus` ($CMV$)\n- $HSV$ 毒株存在 `thymidine kinase` ($TK$) 基因缺失。\n- $CMV$ 毒株存在 $UL97$ `phosphotransferase` 突变，导致对 ganciclovir 耐药。\n- 基本原则 $1$：抗病毒核苷类似物需要通过病毒激酶进行初始磷酸化才能激活。\n- 基本原则 $2$：抗病毒核苷酸类似物绕过第一步磷酸化所需的病毒激酶，转而使用宿主细胞激酶。\n- 基本原则 $3$：疱疹病毒的耐药性来自激酶缺陷/突变（激活步骤）或病毒 $DNA$ 聚合酶突变（靶点步骤）。\n- `cidofovir` 的定义：一种无环胞苷单磷酸类似物。\n- `cidofovir` 的激活：需要通过宿主激酶转化为 `cidofovir` 二磷酸，以抑制病毒 `deoxyribonucleic acid` ($DNA$) 聚合酶。\n- 关于交叉耐药性的假设：聚合酶抑制剂之间的交叉耐药性反映了聚合酶活性位点上共享的结合决定簇。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明確且客观。\n- **科学依据**：该问题基于病毒学和药理学的既定原则。`cidofovir`、ganciclovir 的作用机制以及病毒酶（如 $HSV$ $TK$ 和 $CMV$ $UL97$）的作用都得到了准确的表述。所描述的耐药机制——acyclovir 类药物的 $TK$ 缺失和 ganciclovir 的 $UL97$ 突变——在临床和科学上都是事实。核苷类似物和核苷酸类似物之间的区别是抗病毒治疗中的一个基本概念。\n- **提法明確**：该问题提供了一个清晰的场景以及一套基本原则和定义。它要求根据所提供的信息进行特定的逻辑推导。存在一个唯一的、稳定的且有意义的解。\n- **完整性和一致性**：该问题是自洽的。它提供了推断 `cidofovir` 活性和耐药性特征所需的所有信息。各项前提内部一致，互不矛盾。临床情景是合理的。\n- **客观性**：语言精确、技术性强，没有主观或含糊不清的措辞。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。将根据所提供的原则推导出解决方案。\n\n### 解决方案的推导\n问题的核心在于理解 `cidofovir` 的生物化学激活途径，并将其与 acyclovir 和 ganciclovir 等其他抗病毒药物的激活途径进行对比。\n\n$1$. **Cidofovir 的作用机制**：问题指出，`cidofovir` 是一种“无环胞苷单磷酸类似物”。这将其定义为一种**核苷酸类似物**，意味着它已经拥有一个磷酸基团。问题进一步明确，其激活为活性形式 `cidofovir` 二磷酸的过程是由**宿主细胞激酶**完成的。\n\n$2$. **将基本原则应用于 Cidofovir**：根据基本原则 $2$，核苷酸类似物绕过了初始磷酸化步骤所需的病毒激酶。这是关键区别。核**苷**类似物（如 acyclovir 和 ganciclovir）是简单的核碱基-糖结构，需要病毒激酶（例如，$HSV$ $TK$ 或 $CMV$ $UL97$）来添加第一个磷酸基团，这一步将药物“捕获”在受感染细胞内，并使其进入激活途径。`Cidofovir` 作为一种核**苷酸**类似物，不需要这个由病毒酶介导的步骤。\n\n$3$. **对 TK 缺陷型 HSV 的活性**：患者的 $HSV$ 毒株存在 $TK$ 基因缺失。这种突变使得病毒对 acyclovir 等核苷类似物产生高度耐药，因为这些药物依赖 $HSV$ $TK$ 进行其初始激活磷酸化。然而，由于 `cidofovir` 的激活独立于 $HSV$ $TK$，该酶的缺失不影响 `cidofovir` 被宿主激酶转化为其活性二磷酸形式的能力。因此，预计 `cidofovir` 将对这种 $TK$ 缺陷型 $HSV$ 毒株**保持完全活性**。\n\n$4$. **对 UL97 突变型 CMV 的活性**：患者的 $CMV$ 毒株存在 $UL97$ 突变，导致对 ganciclovir 耐药。Ganciclovir 是一种核苷类似物，需要 $CMV$ 病毒激酶 $UL97$ 磷酸转移酶进行其初始磷酸化。所述突变废除了这一步骤，导致 ganciclovir 耐药。与 $HSV$ 的情况类似，`cidofovir` 的激活绕过了这一病毒激酶步骤。宿主细胞激酶负责其磷酸化。因此，$UL97$ 的突变不影响 `cidofovir` 的激活。因此，预计 `cidofovir` 将对这种 $UL97$ 突变、ganciclovir 耐药的 $CMV$ 毒株**保持完全活性**。\n\n$5$. **对 Cidofovir 的耐药机制**：根据基本原则 $3$，耐药性可能出现在激活步骤或靶点步骤。\n- **激活步骤**：由于 `cidofovir` 的激活依赖于宿主细胞激酶，病毒无法通过突变这些酶来产生耐药性。病毒激酶（$TK$ 和 $UL97$）已经被绕过。因此，通过激活途径产生耐药性对病毒来说不是一种可行的机制。\n- **靶点步骤**：活性代谢物 `cidofovir` 二磷酸通过抑制病毒 $DNA$ 聚合酶发挥作用。因此，对 `cidofovir` 最合乎逻辑且有临床记录的耐药机制是通过**编码病毒 DNA 聚合酶的基因发生突变**。对于 $CMV$，这是 $UL54$ 基因。对于 $HSV$，这是同源的 $DNA$ 聚合酶基因（通常命名为 $UL30$）。\n\n$6$. **交叉耐药性特征**：问题指出，交叉耐药模式反映了共享的结合位点。`cidofovir` 的活性形式和另一种聚合酶抑制剂 foscarnet 都靶向病毒 $DNA$ 聚合酶。虽然它们结合到不同的位点（foscarnet 模拟焦磷酸盐），但聚合酶的突变可以改变蛋白质的构象，从而影响一种或两种药物的结合。因此，`cidofovir` 选择压力下产生的某些 $UL54$（对于 $CMV$）或聚合酶（对于 $HSV$）突变，可能赋予对 foscarnet 的交叉耐药性，反之亦然，这是合理的。这种交叉耐药性并非普遍存在，而是取决于具体的突变。\n\n### 选项评估\n\n**A. Cidofovir 对 TK 缺陷型 HSV 和 UL97 突变型 CMV 保持活性，因为其激活不依赖于病毒激酶；耐药性最可能通过病毒 DNA 聚合酶突变产生（对于 CMV 是 UL54；对于 HSV 是 DNA 聚合酶基因），可能与其他聚合酶抑制剂（如 foscarnet）存在依赖于具体突变的交叉耐药性；UL97 突变本身不会导致对 cidofovir 的耐药。**\n- 该陈述准确地描述了 `cidofovir` 由于其激活独立于病毒激酶而对两种病毒株都保持活性。\n- 它正确地指出了主要的耐药机制是病毒 $DNA$ 聚合酶基因（$CMV$ 的 $UL54$）的突变。\n- 它正确地指出了与 foscarnet 可能存在依赖于突变的交叉耐药性。\n- 它正确地说明了仅 $UL97$ 突变不会导致对 `cidofovir` 的耐药。\n该陈述与基于第一性原理的推导完全一致。\n**结论：正确。**\n\n**B. Cidofovir 对 TK 缺陷型 HSV 失去活性，但对 UL97 突变型 CMV 保持活性，因为 TK 缺陷阻断了其初始磷酸化，而 UL97 突变不影响 cidofovir；对 cidofovir 的耐药性主要通过激酶突变产生。**\n- 该陈述错误地声称 `cidofovir` 对 $TK$ 缺陷型 $HSV$ 失去活性。这与 `cidofovir` 是核苷酸类似物的事实相矛盾。\n- 它错误地声称对 `cidofovir` 的耐药性主要通过激酶突变产生。耐药性是通过聚合酶突变产生的。\n**结论：错误。**\n\n**C. Cidofovir 对 TK 缺陷型 HSV 保持活性，但对 UL97 突变型 CMV 失去活性，因为在 CMV 中，UL97 是 cidofovir 初始磷酸化所必需的；CMV 对 cidofovir 的耐药性是由 UL97 突变介导的，而非聚合酶变化。**\n- 该陈述错误地声称 `cidofovir` 对 $UL97$ 突变型 $CMV$ 失去活性。\n- 它给出了一个错误的理由，声称 $UL97$ 是 `cidofovir` 磷酸化所必需的。\n- 它错误地指出了 $CMV$ 中对 `cidofovir` 的耐药机制。\n**结论：错误。**\n\n**D. Cidofovir 对 TK 缺陷型 HSV 和 UL97 突变型 CMV 均无活性，因为它需要病毒 TK 和 UL97 进行第一步磷酸化；因此，无论下游步骤如何，激酶突变都会普遍消除其活性。**\n- 该陈述从根本上是错误的。它错误地将 `cidofovir` 归类为依赖病毒激酶的核苷类似物，而事实并非如此。`Cidofovir` 对两种毒株均有活性。\n**结论：错误。**\n\n**E. Cidofovir 对 TK 缺陷型 HSV 和 UL97 突变型 CMV 保持活性；然而，UL97 突变通常会导致对 cidofovir 的高级别交叉耐药，并且由于其活性位点与其他聚合酶抑制剂不同，由聚合酶介导的对 cidofovir 的耐药性不太可能发生。**\n- 该陈述正确地指出了 `cidofovir` 对两种毒株都保持活性。\n- 然而，它错误地声称 $UL97$ 突变会导致对 `cidofovir` 的交叉耐药。这是错误的；$UL97$ 突变导致对 ganciclovir 的耐药。\n- 它还错误地声称聚合酶介导的耐药性不太可能发生。这实际上是主要的耐药机制。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "4625062"}, {"introduction": "在理解了药物的作用机制之后，下一步是将其应用于临床。有效的抗病毒治疗需要为每位患者量身定制剂量。本练习将演示如何运用药代动力学的基本原理——生物利用度（$F$）、清除率（$Cl$）和曲线下面积（$AUC$）——来计算伐更昔洛韦（valganciclovir）的个体化剂量。练习将患者特定的肾功能（更昔洛韦清除率的主要决定因素）整合到剂量计算公式中。[@problem_id:4625127]", "problem": "一名患有巨细胞病毒 (CMV) 病的成年患者将接受口服缬更昔洛韦治疗。您的任务是确定能够达到更昔洛韦目标全身暴露量的每日口服总剂量。请使用以下科学依据和数据来构建所需的给药剂量计算：\n\n1. 给药间隔内的浓度-时间曲线下面积 (AUC) 由质量平衡和清除率定义为 $$\\mathrm{AUC}_{0-\\tau}=\\frac{\\text{amount absorbed over }[0,\\tau]}{Cl},$$ 其中 $Cl$ 是全身清除率。\n2. 对于一种口服前体药物，其活性成分以绝对生物利用度 $F$ 进入体循环，在线性药代动力学条件下，$[0,\\tau]$ 期间的吸收量等于 $F \\cdot \\text{Dose}_{0-\\tau}$。\n3. 更昔洛韦主要通过肾脏消除，并伴有显著的主动肾小管分泌。一项经过充分检验的群体药代动力学观察结果近似地描述了更昔洛韦全身清除率与肌酐清除率（用作肾功能的替代指标）之间的关系为 $$Cl \\approx \\alpha \\cdot \\mathrm{CrCl} \\cdot 0.06 \\ \\mathrm{L/h},$$ 其中 $0.06$ 是将 $\\mathrm{mL/min}$ 转换为 $\\mathrm{L/h}$ 的转换系数，$\\alpha$ 是一个无量纲因子，涵盖了主动分泌和次要非肾脏途径的贡献。使用 $\\alpha=1.40$。\n4. 使用 Cockcroft–Gault 公式计算男性的肌酐清除率：$$\\mathrm{CrCl}=\\frac{(140-\\text{age})\\cdot \\text{weight}}{72\\cdot SCr} \\ \\mathrm{mL/min}.$$\n\n患者特定数据：\n- 男性，年龄 $35$ 岁，体重 $80$ $\\mathrm{kg}$，血清肌酐 $SCr=1.0$ $\\mathrm{mg/dL}$。\n- 口服缬更昔洛韦至全身更昔洛韦的绝对生物利用度 $F=0.60$。\n- 目标更昔洛韦 $$\\mathrm{AUC}_{0-24}=55 \\ \\mathrm{mg \\cdot h / L}.$$\n\n假设处于稳态、线性药代动力学，并且目标 $\\mathrm{AUC}_{0-24}$ 对应于所给予的缬更昔洛韦剂量在每日吸收的总更昔洛韦量。根据上述依据推导给药剂量表达式，并计算达到目标暴露量所需的每日口服缬更昔洛韦总剂量。将您的最终剂量四舍五入至四位有效数字。以每 $24$ 小时 $\\mathrm{mg}$ 缬更昔洛韦为单位表示您的答案。", "solution": "用户要求计算一名患有巨细胞病毒病的患者每日口服缬更昔洛韦的总剂量，以达到其活性药物更昔洛韦的特定目标全身暴露量。\n\n首先，评估问题陈述的有效性。\n\n**步骤 1：提取已知条件**\n- 曲线下面积定义：$$\\mathrm{AUC}_{0-\\tau}=\\frac{\\text{amount absorbed over }[0,\\tau]}{Cl}$$\n- 吸收量定义：$$\\text{amount absorbed over }[0,\\tau] = F \\cdot \\text{Dose}_{0-\\tau}$$\n- 全身清除率模型：$$Cl \\approx \\alpha \\cdot \\mathrm{CrCl} \\cdot 0.06 \\ \\mathrm{L/h}$$\n- 无量纲因子：$$\\alpha=1.40$$\n- 肌酐清除率公式（男性）：$$\\mathrm{CrCl}=\\frac{(140-\\text{age})\\cdot \\text{weight}}{72\\cdot SCr} \\ \\mathrm{mL/min}$$\n- 患者数据：\n  - 性别：男\n  - 年龄 = $35$ 岁\n  - 体重 = $80$ $\\mathrm{kg}$\n  - 血清肌酐 $SCr = 1.0$ $\\mathrm{mg/dL}$\n- 药物数据：\n  - 绝对生物利用度 $F=0.60$\n- 目标暴露量：\n  - 目标更昔洛韦 $$\\mathrm{AUC}_{0-24}=55 \\ \\mathrm{mg \\cdot h / L}$$\n- 假设：稳态，线性药代动力学。\n- 要求输出：每日口服缬更昔洛韦总剂量，单位为 $\\mathrm{mg}$，四舍五入至四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：**该问题基于药代动力学的基本原理。对于稳态下的线性单室模型，剂量、生物利用度、清除率和 AUC 之间的关系陈述正确。所提供的更昔洛韦清除率作为肌酐清除率函数的公式是临床实践中使用的成熟经验关系。Cockcroft-Gault 方程是估算肾功能的标准方法。所有患者和药物参数在临床上都是现实的。\n- **问题适定性：**该问题是适定的。它提供了唯一确定所需剂量所必需的所有方程、常数和患者特定数据。目标陈述清晰。\n- **客观性：**该问题以精确、客观和定量的术语陈述，没有歧义或主观内容。\n\n**步骤 3：结论与行动**\n该问题有效。将提供一个合理的解决方案。\n\n目标是计算缬更昔洛韦的每日口服总剂量，记为 $\\text{Dose}_{\\text{VGCV, daily}}$。该剂量必须达到更昔洛韦的目标 24 小时浓度-时间曲线下面积 $\\mathrm{AUC}_{0-24}$。\n\n通过结合所提供的定义，可以建立目标暴露量与所需剂量之间的关系。给药间隔 $\\tau$ 为 24 小时。\n根据 AUC 的定义：\n$$ \\mathrm{AUC}_{0-24} = \\frac{\\text{24 小时内吸收的更昔洛韦量}}{Cl} $$\n吸收的更昔洛韦量来自其前体药物缬更昔洛韦的口服给药，并由生物利用度 $F$ 决定：\n$$ \\text{24 小时内吸收的更昔洛韦量} = F \\cdot \\text{Dose}_{\\text{VGCV, daily}} $$\n将第二个方程代入第一个方程，得到：\n$$ \\mathrm{AUC}_{0-24} = \\frac{F \\cdot \\text{Dose}_{\\text{VGCV, daily}}}{Cl} $$\n该方程可以重新整理，以求解所需的缬更昔洛韦每日剂量：\n$$ \\text{Dose}_{\\text{VGCV, daily}} = \\frac{\\mathrm{AUC}_{0-24} \\cdot Cl}{F} $$\n为了计算剂量，我们必须首先确定患者的更昔洛韦全身清除率 $Cl$。清除率 $Cl$ 是患者肌酐清除率 $\\mathrm{CrCl}$ 的函数。\n\n首先，我们使用 Cockcroft-Gault 公式，根据给定数据（年龄 = $35$ 岁，体重 = $80$ $\\mathrm{kg}$，血清肌酐 $SCr = 1.0$ $\\mathrm{mg/dL}$）计算男性患者的肌酐清除率 $\\mathrm{CrCl}$。\n$$ \\mathrm{CrCl} = \\frac{(140 - \\text{age}) \\cdot \\text{weight}}{72 \\cdot SCr} = \\frac{(140 - 35) \\cdot 80}{72 \\cdot 1.0} $$\n$$ \\mathrm{CrCl} = \\frac{105 \\cdot 80}{72} = \\frac{8400}{72} = \\frac{350}{3} \\ \\mathrm{mL/min} $$\n为了更高的精度，我们将保留这个分数值。$\\frac{350}{3} \\approx 116.67 \\ \\mathrm{mL/min}$。\n\n接下来，我们使用所提供的群体药代动力学模型计算更昔洛韦的全身清除率 $Cl$。必须使用给定的系数 $0.06$ 将 $\\mathrm{CrCl}$ 的值从 $\\mathrm{mL/min}$ 转换为 $\\mathrm{L/h}$。参数 $\\alpha$ 给定为 $1.40$。\n$$ Cl = \\alpha \\cdot \\mathrm{CrCl} \\cdot 0.06 $$\n$$ Cl = 1.40 \\cdot \\left(\\frac{350}{3} \\ \\mathrm{mL/min}\\right) \\cdot \\left(0.06 \\ \\frac{\\mathrm{L/h}}{\\mathrm{mL/min}}\\right) $$\n$$ Cl = 1.40 \\cdot \\frac{350}{3} \\cdot 0.06 \\ \\mathrm{L/h} $$\n$$ Cl = 1.40 \\cdot 350 \\cdot \\frac{0.06}{3} \\ \\mathrm{L/h} $$\n$$ Cl = 1.40 \\cdot 350 \\cdot 0.02 \\ \\mathrm{L/h} $$\n$$ Cl = 1.40 \\cdot 7 \\ \\mathrm{L/h} $$\n$$ Cl = 9.8 \\ \\mathrm{L/h} $$\n现在我们已经计算出全身清除率 $Cl$，我们可以计算缬更昔洛韦的每日总剂量 $\\text{Dose}_{\\text{VGCV, daily}}$。我们使用目标 $\\mathrm{AUC}_{0-24} = 55 \\ \\mathrm{mg \\cdot h / L}$、计算出的 $Cl = 9.8 \\ \\mathrm{L/h}$ 和给定的生物利用度 $F=0.60$。\n$$ \\text{Dose}_{\\text{VGCV, daily}} = \\frac{\\mathrm{AUC}_{0-24} \\cdot Cl}{F} $$\n$$ \\text{Dose}_{\\text{VGCV, daily}} = \\frac{(55 \\ \\mathrm{mg \\cdot h / L}) \\cdot (9.8 \\ \\mathrm{L/h})}{0.60} $$\n分子中的单位 $(\\mathrm{mg \\cdot h / L}) \\cdot (\\mathrm{L/h})$ 得出 $\\mathrm{mg}$，这是剂量的正确单位。\n$$ \\text{Dose}_{\\text{VGCV, daily}} = \\frac{55 \\cdot 9.8}{0.60} \\ \\mathrm{mg} $$\n$$ \\text{Dose}_{\\text{VGCV, daily}} = \\frac{539}{0.60} \\ \\mathrm{mg} $$\n$$ \\text{Dose}_{\\text{VGCV, daily}} = \\frac{5390}{6} \\ \\mathrm{mg} = \\frac{2695}{3} \\ \\mathrm{mg} \\approx 898.333... \\ \\mathrm{mg} $$\n问题要求最终答案四舍五入至四位有效数字。\n$$ \\text{Dose}_{\\text{VGCV, daily}} \\approx 898.3 \\ \\mathrm{mg} $$\n因此，为达到更昔洛韦的目标全身暴露量，所需的每日口服缬更昔洛韦总剂量为 $898.3$ $\\mathrm{mg}$。", "answer": "$$\\boxed{898.3}$$", "id": "4625127"}, {"introduction": "虽然个体化剂量至关重要，但评估一个给药方案在具有内在变异性的整个群体中的有效性，则是一项更高级的挑战。本练习向您介绍使用蒙特卡洛模拟进行靶标达成概率（Probability of Target Attainment, PTA）分析，这是一种强大的药理计量学技术。您将建立一个模型，该模型整合了药物清除率、生物利用度和病毒易感性（$EC_{50}$）的变异性，以评估标准剂量对从群体中随机选择的患者有效的可能性。[@problem_id:4625073]", "problem": "你的任务是编写一个完整的程序，在单室、线性药代动力学、一级消除模型下，使用蒙特卡洛模拟来估算 ganciclovir 的目标达成概率 (Probability of Target Attainment, PTA)。此处，PTA 定义为药代动力学/药效动力学 (PK/PD) 指数 $AUC/EC_{50}$ 超过一个指定目标阈值的概率。你的实现必须仅依赖于以下基本定义和经过充分检验的事实：\n\n- 对于线性药代动力学，清除率 $Cl$ 定义为 $Cl = \\frac{D \\cdot F}{AUC}$，其中 $D$ 是剂量，$F$ 是全身生物利用度。\n- 对于一级消除和线性动力学的单室模型，单次给药后的浓度-时间曲线下面积为 $AUC = \\frac{D \\cdot F}{Cl}$。\n- 在线性动力学下的稳态时，一个给药间隔内的浓度-时间曲线下面积等于单次给药的浓度-时间曲线下面积，即 $AUC_{\\tau} = \\frac{D \\cdot F}{Cl}$。\n- 药效动力学敏感性参数 $EC_{50}$ 的单位为 $\\mathrm{mg/L}$，而 $AUC$ 的单位为 $\\mathrm{mg \\cdot h/L}$。因此，指数 $AUC/EC_{50}$ 的单位是 $\\mathrm{h}$。所有目标阈值都应以 $\\mathrm{h}$ 为单位进行解释。\n\n你必须为一组测试用例计算 PTA，方法是根据指定的分布模拟 $Cl$、$F$、$V_d$ 和 $EC_{50}$ 的变异性。尽管在线性动力学下，$V_d$ (分布容积) 不影响 $AUC = \\frac{D \\cdot F}{Cl}$，但它仍被包含在模拟参数中，以反映变异性报告，并确保你的实现能正确地关注影响目标指数的参数。对于每个测试用例，使用指定的随机种子和蒙特卡洛样本量以确保确定性的结果。\n\n定义和要求：\n\n- 药代动力学/药效动力学 (PK/PD) 目标：$AUC/EC_{50} \\ge T$，其中 $T$ 是以 $\\mathrm{h}$ 为单位的目标阈值。\n- 目标达成概率 (PTA)：$\\mathbb{P}\\left(\\frac{AUC}{EC_{50}} \\ge T\\right)$ 的蒙特卡洛估计值，计算方法为在 $N$ 个模拟受试者中达到目标的虚拟受试者所占的比例。\n- 使用以下分布：\n  - $Cl \\sim \\mathrm{Lognormal}(\\mu_{\\ln,Cl}, \\sigma_{\\ln,Cl})$，即 $\\ln(Cl) \\sim \\mathcal{N}(\\mu_{\\ln,Cl}, \\sigma_{\\ln,Cl}^2)$，其中 $Cl$ 的单位为 $\\mathrm{L/h}$。\n  - $F \\sim \\mathrm{Beta}(\\alpha_F, \\beta_F)$，其中 $F \\in (0,1)$ (无量纲)。\n  - $V_d \\sim \\mathrm{Lognormal}(\\mu_{\\ln,V_d}, \\sigma_{\\ln,V_d})$，即 $\\ln(V_d) \\sim \\mathcal{N}(\\mu_{\\ln,V_d}, \\sigma_{\\ln,V_d}^2)$，其中 $V_d$ 的单位为 $\\mathrm{L}$。\n  - $EC_{50} \\sim \\mathrm{Lognormal}(\\mu_{\\ln,EC50}, \\sigma_{\\ln,EC50})$，即 $\\ln(EC_{50}) \\sim \\mathcal{N}(\\mu_{\\ln,EC50}, \\sigma_{\\ln,EC50}^2)$，其中 $EC_{50}$ 的单位为 $\\mathrm{mg/L}$。\n- 对于每个虚拟受试者，计算 $AUC = \\frac{D \\cdot F}{Cl}$，其中 $D$ 的单位是 $\\mathrm{mg}$，$Cl$ 的单位是 $\\mathrm{L/h}$，然后计算以 $\\mathrm{h}$ 为单位的 $R = \\frac{AUC}{EC_{50}}$，并检查是否 $R \\ge T$。\n- 将最终的 PTA 结果表示为小数（而非百分比）。\n\n物理单位和数值报告：\n\n- 剂量 $D$ 的单位是 $\\mathrm{mg}$。\n- 清除率 $Cl$ 的单位是 $\\mathrm{L/h}$。\n- 分布容积 $V_d$ 的单位是 $\\mathrm{L}$。\n- $EC_{50}$ 的单位是 $\\mathrm{mg/L}$。\n- $AUC$ 的单位是 $\\mathrm{mg \\cdot h/L}$。\n- $AUC/EC_{50}$ 和目标阈值 $T$ 的单位是 $\\mathrm{h}$。\n- 你的程序必须将每个 PTA 四舍五入到 $6$ 位小数。\n\n蒙特卡洛可复现性：\n\n- 在抽取样本之前，为每个测试用例使用指定的随机种子 $s$。\n- 每个测试用例使用恰好 $N$ 个样本。\n\n测试套件：\n\n对于每个测试用例 $i \\in \\{1,2,3,4\\}$，参数集以有序元组 ($D$, $\\alpha_F$, $\\beta_F$, $\\mu_{\\ln,Cl}$, $\\sigma_{\\ln,Cl}$, $\\mu_{\\ln,V_d}$, $\\sigma_{\\ln,V_d}$, $\\mu_{\\ln,EC50}$, $\\sigma_{\\ln,EC50}$, $T$, $N$, $s$) 的形式给出，具体数值如下：\n\n- 测试用例 $1$ (中等目标的一般情况)：\n  - ($D=900$, $\\alpha_F=18$, $\\beta_F=12$, $\\mu_{\\ln,Cl}=1.609437912$, $\\sigma_{\\ln,Cl}=0.25$, $\\mu_{\\ln,V_d}=3.806662489$, $\\sigma_{\\ln,V_d}=0.20$, $\\mu_{\\ln,EC50}=-0.510825624$, $\\sigma_{\\ln,EC50}=0.35$, $T=150$, $N=50000$, $s=12345$)。\n- 测试用例 $2$ (较低剂量边界行为)：\n  - ($D=450$, $\\alpha_F=18$, $\\beta_F=12$, $\\mu_{\\ln,Cl}=1.609437912$, $\\sigma_{\\ln,Cl}=0.25$, $\\mu_{\\ln,V_d}=3.806662489$, $\\sigma_{\\ln,V_d}=0.20$, $\\mu_{\\ln,EC50}=-0.510825624$, $\\sigma_{\\ln,EC50}=0.35$, $T=150$, $N=50000$, $s=23456$)。\n- 测试用例 $3$ (接近静脉注射的生物利用度和不同的敏感性分布)：\n  - ($D=500$, $\\alpha_F=95$, $\\beta_F=5$, $\\mu_{\\ln,Cl}=1.386294361$, $\\sigma_{\\ln,Cl}=0.20$, $\\mu_{\\ln,V_d}=3.688879454$, $\\sigma_{\\ln,V_d}=0.15$, $\\mu_{\\ln,EC50}=-0.916290732$, $\\sigma_{\\ln,EC50}=0.30$, $T=120$, $N=50000$, $s=34567$)。\n- 测试用例 $4$ (严格目标阈值的边界情况)：\n  - ($D=1000$, $\\alpha_F=18$, $\\beta_F=12$, $\\mu_{\\ln,Cl}=1.609437912$, $\\sigma_{\\ln,Cl}=0.25$, $\\mu_{\\ln,V_d}=3.806662489$, $\\sigma_{\\ln,V_d}=0.20$, $\\mu_{\\ln,EC50}=-0.510825624$, $\\sigma_{\\ln,EC50}=0.35$, $T=1000$, $N=50000$, $s=45678$)。\n\n程序规范：\n\n- 实现一个程序，对于每个测试用例，使用给定的种子从指定的分布中抽取 $N$ 个独立的 ($Cl,F,V_d,EC_{50}$) 样本，计算以 $\\mathrm{h}$ 为单位的 $R = \\frac{(D \\cdot F / Cl)}{EC_{50}}$，并将 PTA 估计为满足 $R \\ge T$ 的样本比例。\n- 你的程序应产生单行输出，其中包含测试用例 1 到 4 的 PTA 估计值，形式为方括号内以逗号分隔的列表，顺序如上所述，每个值都四舍五入到 6 位小数，例如：$[0.123456,0.654321,0.500000,0.000000]$。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于药代动力学和药效动力学的原理，问题定义明确，提供了所有必要信息，并以客观、正式的语言表述。其中没有矛盾、歧义或事实错误。因此，我们可以着手解决。\n\n目标是计算 ganciclovir 的目标达成概率 (PTA)，其定义为特定的药代动力学/药效动力学 (PK/PD) 指数超过给定目标阈值的概率。分析基于单室线性药代动力学模型，并将使用蒙特卡洛模拟进行。\n\n我们关注的 PK/PD 指数是浓度-时间曲线下面积 ($AUC$) 与半数有效浓度 ($EC_{50}$) 的比值。对于单个虚拟受试者，目标达成的条件由下式给出：\n$$\n\\frac{AUC}{EC_{50}} \\ge T\n$$\n其中 $T$ 是以小时 ($\\mathrm{h}$) 为单位的目标阈值。\n\n对于线性、一级消除的单室模型，稳态下一个给药间隔内的曲线下面积 $AUC_{\\tau}$ 等同于单次给药的 $AUC$。它由以下方程定义：\n$$\nAUC = \\frac{D \\cdot F}{Cl}\n$$\n此处，$D$ 是以 $\\mathrm{mg}$ 为单位的给药剂量，$F$ 是无量纲的全身生物利用度，$Cl$ 是以 $\\mathrm{L/h}$ 为单位的药物清除率。$AUC$ 的单位因此为 $\\mathrm{mg \\cdot h/L}$。鉴于 $EC_{50}$ 的单位是 $\\mathrm{mg/L}$，指数 $\\frac{AUC}{EC_{50}}$ 的单位正确地为小时 ($\\mathrm{h}$)，与目标 $T$ 一致。\n\n将 $AUC$ 的表达式代入目标达成不等式，我们可以仅用剂量和可变参数来表示该条件：\n$$\nR = \\frac{D \\cdot F}{Cl \\cdot EC_{50}} \\ge T\n$$\n问题指定参数 $Cl$、$F$ 和 $EC_{50}$ 是随机的，并遵循给定的概率分布，反映了群体中的个体间差异。分布容积 $V_d$ 也被指定为一个随机参数，尽管它没有出现在指数 $R$ 的公式中。包含它意在测试是否能正确识别相关变量，并且，虽然我们将按照指示对其进行抽样，但它不会被用于 $R$ 的最终计算。\n\nPTA 是使用蒙特卡洛模拟来估计的。每个测试用例的流程如下：\n\n$1$. **初始化**：使用指定的种子 $s$ 初始化随机数生成器，以确保模拟结果的确定性可复现。\n\n$2$. **抽样**：从指定的分布中为每个可变参数抽取总共 $N$ 个独立的随机样本：\n   - 清除率：$Cl_i \\sim \\mathrm{Lognormal}(\\mu_{\\ln,Cl}, \\sigma_{\\ln,Cl})$，对于 $i=1, ..., N$。这是通过从正态分布 $\\mathcal{N}(\\mu_{\\ln,Cl}, \\sigma_{\\ln,Cl}^2)$ 中抽样并对结果取指数来实现的。\n   - 生物利用度：$F_i \\sim \\mathrm{Beta}(\\alpha_F, \\beta_F)$，对于 $i=1, ..., N$。\n   - $EC_{50}$：$EC_{50,i} \\sim \\mathrm{Lognormal}(\\mu_{\\ln,EC50}, \\sigma_{\\ln,EC50})$，对于 $i=1, ..., N$。\n   - 分布容积 $V_{d,i}$ 也从其指定的对数正态分布中抽样，但被正确地排除在 $R_i$ 的计算之外。\n\n$3$. **计算**：对于 $N$ 个虚拟受试者中的每一个（由 $i$ 索引），使用抽样参数计算 PK/PD 指数 $R_i$：\n$$\nR_i = \\frac{D \\cdot F_i}{Cl_i \\cdot EC_{50,i}}\n$$\n这通过对抽样参数数组使用向量化操作来高效执行。\n\n$4$. **评估**：统计达到目标的虚拟受试者数量 $N_{\\text{success}}$。这是条件 $R_i \\ge T$ 为真的模拟次数。\n$$\nN_{\\text{success}} = \\sum_{i=1}^{N} \\mathbb{I}(R_i \\ge T)\n$$\n其中 $\\mathbb{I}(\\cdot)$ 是指示函数，当其参数为真时等于 $1$，否则等于 $0$。\n\n$5$. **估计**：PTA 被估计为成功模拟的比例：\n$$\n\\text{PTA} = \\frac{N_{\\text{success}}}{N}\n$$\n\n$6$. **报告**：按照规定，每个测试用例的最终 PTA 值四舍五入到 $6$ 位小数。\n\n对所提供的四个测试用例中的每一个都重复此完整过程，使用它们各自的参数集 $(D, \\alpha_F, \\beta_F, \\mu_{\\ln,Cl}, \\sigma_{\\ln,Cl}, \\mu_{\\ln,V_d}, \\sigma_{\\ln,V_d}, \\mu_{\\ln,EC50}, \\sigma_{\\ln,EC50}, T, N, s)$。最终输出是这四个结果的汇总。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Probability of Target Attainment (PTA) for ganciclovir\n    using Monte Carlo simulation for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (D, alpha_F, beta_F, mu_ln_Cl, sigma_ln_Cl, mu_ln_Vd, sigma_ln_Vd, \n    #  mu_ln_EC50, sigma_ln_EC50, T, N, s)\n    test_cases = [\n        (900, 18, 12, 1.609437912, 0.25, 3.806662489, 0.20, -0.510825624, 0.35, 150, 50000, 12345),\n        (450, 18, 12, 1.609437912, 0.25, 3.806662489, 0.20, -0.510825624, 0.35, 150, 50000, 23456),\n        (500, 95, 5, 1.386294361, 0.20, 3.688879454, 0.15, -0.916290732, 0.30, 120, 50000, 34567),\n        (1000, 18, 12, 1.609437912, 0.25, 3.806662489, 0.20, -0.510825624, 0.35, 1000, 50000, 45678),\n    ]\n\n    results = []\n    for case in test_cases:\n        D, alpha_F, beta_F, mu_ln_Cl, sigma_ln_Cl, mu_ln_Vd, sigma_ln_Vd, \\\n        mu_ln_EC50, sigma_ln_EC50, T, N, s = case\n\n        # Initialize the random number generator with the specified seed for reproducibility.\n        rng = np.random.default_rng(seed=s)\n\n        # Generate N random samples for each stochastic parameter.\n        # The problem specifies mu and sigma of the underlying normal distribution for lognormal.\n        # This maps directly to numpy.random.lognormal's `mean` and `sigma` parameters.\n        cl_samples = rng.lognormal(mean=mu_ln_Cl, sigma=sigma_ln_Cl, size=N)\n        f_samples = rng.beta(a=alpha_F, b=beta_F, size=N)\n        \n        # vd_samples are generated as per the problem description but are not used in the AUC calculation.\n        # This confirms understanding of the model, as specified in the problem statement.\n        vd_samples = rng.lognormal(mean=mu_ln_Vd, sigma=sigma_ln_Vd, size=N)\n        \n        ec50_samples = rng.lognormal(mean=mu_ln_EC50, sigma=sigma_ln_EC50, size=N)\n\n        # Calculate the Area Under the Curve (AUC) for each virtual subject.\n        # AUC = (Dose * Bioavailability) / Clearance\n        auc_samples = (D * f_samples) / cl_samples\n\n        # Calculate the PK/PD index R = AUC / EC50 for each virtual subject.\n        r_samples = auc_samples / ec50_samples\n\n        # Determine the number of virtual subjects who meet the target attainment criterion.\n        # Criterion: R >= T\n        num_attained = np.sum(r_samples >= T)\n\n        # Estimate the Probability of Target Attainment (PTA).\n        pta = num_attained / N\n\n        # Round the result to 6 decimal places.\n        rounded_pta = round(pta, 6)\n        results.append(rounded_pta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "4625073"}]}