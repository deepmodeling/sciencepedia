{"hands_on_practices": [{"introduction": "耐药性通常源于药物分子靶点的细微变化。革兰氏阳性菌中万古霉素耐药性的经典案例——肽聚糖末端的改变——为我们提供了一个完美的例证。此练习将深入探讨这种相互作用的生物物理化学原理，您将应用基本的热力学原理，来量化一个单一的原子替换（用酯键取代酰胺基团）如何破坏药物-靶点结合的稳定性，从而导致亲和力的大幅下降。通过将特定的结构变化与结合自由能（$ \\Delta G $）和解离常数（$ K_d $）联系起来，该练习让您在最基础的层面上对耐药性有了定量的理解 [@problem_id:4645089]。", "problem": "革兰氏阳性菌中一种临床相关的抗菌素耐药性机制涉及肽聚糖末端从 D-丙氨酰-D-丙氨酸 重塑为 D-丙氨酰-D-乳酸，这降低了糖肽类抗生素万古霉素的亲和力。根据结构结合原理，D-丙氨酰-D-乳酸的取代移除了末端酰胺上的一个关键氢键（H-bond）供体，造成了供体-受体错配，并在结合口袋中邻近的羰基和醚氧之间引入了孤对电子-孤对电子静电排斥。观察到这些变化相对于 D-丙氨酰-D-丙氨酸复合物，使标准结合自由能净增加量为 $\\Delta\\Delta G$。\n\n从配体-受体结合反应的结合平衡的质量作用定义出发，并利用连接标准结合自由能与平衡常数的统计热力学关系，推导出一个将平衡解离常数 $K_{d}$ 的倍数变化与标准结合自由能的变化 $\\Delta\\Delta G$ 联系起来的通用表达式。然后，使用以下经实验支持的 D-丙氨酰-D-乳酸取代的自由能罚分分解：\n- 失去关键氢键的焓稳定作用：$+17.0\\,\\mathrm{kJ\\,mol^{-1}}$，\n- 供体-受体错配和静电排斥：$+2.8\\,\\mathrm{kJ\\,mol^{-1}}$，\n- 构象互补性降低（熵罚）：$+1.2\\,\\mathrm{kJ\\,mol^{-1}}$，\n在生理温度 $T = 310\\,\\mathrm{K}$ 下，使用摩尔气体常数 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，计算 $K_{d}$ 的倍数增加。将倍数变化视为无量纲比率。将最终结果四舍五入至三位有效数字，并以无单位的单个数字形式报告。", "solution": "配体 $L$ 与受体 $R$ 结合形成复合物 $LR$ 的过程可以写为 $L + R \\rightleftharpoons LR$。结合平衡常数定义为 $K_{a} = [LR]/([L][R])$，解离平衡常数定义为 $K_{d} = 1/K_{a}$。\n\n根据统计热力学，结合反应的标准结合自由能满足\n$$\n\\Delta G^{\\circ}_{\\text{bind}} = - R T \\ln K_{a} = R T \\ln K_{d}.\n$$\n设原始复合物（含 D-丙氨酰-D-丙氨酸）的解离常数为 $K_{d}$，标准结合自由能为 $\\Delta G^{\\circ}_{\\text{bind}}$，而修饰后的复合物（含 D-丙氨酰-D-乳酸）的解离常数为 $K_{d}'$，标准结合自由能为 $\\Delta G_{\\text{bind}}^{\\circ\\,\\prime}$。定义由取代引起的标准结合自由能变化为\n$$\n\\Delta\\Delta G = \\Delta G_{\\text{bind}}^{\\circ\\,\\prime} - \\Delta G^{\\circ}_{\\text{bind}}.\n$$\n对每个复合物使用热力学关系，\n$$\n\\Delta G_{\\text{bind}}^{\\circ\\,\\prime} = R T \\ln K_{d}', \\quad \\Delta G^{\\circ}_{\\text{bind}} = R T \\ln K_{d},\n$$\n我们得到\n$$\n\\Delta\\Delta G = R T \\ln K_{d}' - R T \\ln K_{d} = R T \\ln\\!\\left(\\frac{K_{d}'}{K_{d}}\\right).\n$$\n因此，解离常数的倍数变化为\n$$\n\\frac{K_{d}'}{K_{d}} = \\exp\\!\\left(\\frac{\\Delta\\Delta G}{R T}\\right).\n$$\n\n我们现在根据所提供的结构贡献计算 $\\Delta\\Delta G$。将各项罚分相加，\n$$\n\\Delta\\Delta G = 17.0\\,\\mathrm{kJ\\,mol^{-1}} + 2.8\\,\\mathrm{kJ\\,mol^{-1}} + 1.2\\,\\mathrm{kJ\\,mol^{-1}} = 21.0\\,\\mathrm{kJ\\,mol^{-1}}.\n$$\n为了与 $R$ 的单位匹配，将其转换为焦耳每摩尔，\n$$\n\\Delta\\Delta G = 21.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}} = 2.10 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}.\n$$\n使用 $T = 310\\,\\mathrm{K}$ 和 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 计算指数部分，\n$$\n\\frac{\\Delta\\Delta G}{R T} = \\frac{2.10 \\times 10^{4}}{8.314 \\times 310}.\n$$\n计算分母，\n$$\nR T = 8.314 \\times 310 = 2{,}577.34\\,\\mathrm{J\\,mol^{-1}},\n$$\n所以\n$$\n\\frac{\\Delta\\Delta G}{R T} = \\frac{21{,}000}{2{,}577.34} \\approx 8.14794.\n$$\n因此倍数变化是\n$$\n\\frac{K_{d}'}{K_{d}} = \\exp(8.14794) \\approx 3.456 \\times 10^{3}.\n$$\n四舍五入到三位有效数字， $K_{d}$ 的无量纲倍数增加为\n$$\n3.46 \\times 10^{3}.\n$$\n这表明 D-丙氨酰-D-乳酸取代导致解离常数大约增加了 $3.46 \\times 10^{3}$ 倍，这与由于失去关键氢键、供体-受体错配和不利的静电相互作用而导致的结合亲和力大幅降低相一致，正如正值的 $\\Delta\\Delta G$ 以及 $K_{d}$ 对自由能的指数敏感性所反映的那样。", "answer": "$$\\boxed{3.46 \\times 10^{3}}$$", "id": "4645089"}, {"introduction": "一种抗生素要有效，不仅需要与其靶点结合，还必须以足够高的浓度到达靶点。细菌已经进化出复杂的系统，如外排泵和药物降解酶，以主动降低细胞内药物浓度。这个练习要求您构建一个简单但功能强大的药代动力学模型。通过运用质量平衡原理，您将推导出稳态细胞内药物浓度与药物流入、外排和降解速率之间的函数关系。该实践演示了如何用数学方法模拟药物进入和清除之间的竞争，从而深刻揭示主动外排和酶降解等耐药机制如何通过降低靶点占有率来保护细胞 [@problem_id:4645060]。", "problem": "在一个暴露于恒定外部抗生素浓度的革兰氏阴性菌中，药物的细胞内可用性受到两种核心耐药机制的限制：主动外排和周质中的酶降解。考虑一种抗生素，其外部浓度为 $C_e$，它以有效的一级流入速率常数 $k_{in}$ 穿过细胞包膜，被外排泵以一级速率常数 $k_{out}$ 从细胞质中主动输出，并沿跨包膜途径被周质酶以有效的一级降解速率常数 $k_{deg}$ 清除。假设采用单室粗粒度描述，其中净细胞内药物动力学由质量平衡和一级动力学控制。在这些条件下，当流入与清除达到平衡时，细胞质药物浓度 $C_i(t)$ 接近稳态。\n\n该药物与细胞内分子靶标（例如，核糖体位点）快速可逆地结合，该结合遵循质量作用定律，平衡解离常数为 $K_d$（对于一对一相互作用，在平衡条件下定义为 $K_d = k_{off}/k_{on}$）。在准平衡状态下，靶标的占据分数由 $f = \\frac{C_i}{C_i + K_d}$ 给出。\n\n任务：\n1. 使用质量守恒和一级动力学，推导稳态细胞内浓度 $C_i^{*}$，用 $C_e$、$k_{in}$、$k_{out}$ 和 $k_{deg}$ 表示。以与 $C_e$ 相同的浓度单位表示 $C_i^{*}$。\n2. 使用上述结合平衡定义，写出基线占据分数 $f_0$，用 $C_i^{*}$ 和 $K_d$ 表示。\n3. 通过计算当 $k_{out}$ 加倍（用 $2 k_{out}$ 替换 $k_{out}$）或 $k_{deg}$ 加倍（用 $2 k_{deg}$ 替换 $k_{deg}$）时的占据分数，来评估耐药性增强如何影响占据情况，然后形成相对于基线的占据比：$R_{out} = \\frac{f(\\text{with }2 k_{out})}{f_0}$ 和 $R_{deg} = \\frac{f(\\text{with }2 k_{deg})}{f_0}$。用 $C_e$、$k_{in}$、$k_{out}$、$k_{deg}$ 和 $K_d$ 以封闭形式给出这些比率。\n将您的最终结果报告为一个包含三个条目的单行矩阵，顺序为 $\\left(C_i^{*}, R_{out}, R_{deg}\\right)$。不需要进行数值计算。", "solution": "细胞内药物浓度 $C_i(t)$ 由一个基于流入和清除过程一级动力学的质量平衡方程控制。在指定的单室模型中，$C_i$ 的变化率是流入速率减去清除速率的总和。\n\n药物流入速率与外部浓度 $C_e$ 成正比，一级速率常数为 $k_{in}$。对 $\\frac{dC_i}{dt}$ 的贡献为 $+k_{in}C_e$。\n通过主动外排清除药物的速率与内部浓度 $C_i$ 成正比，一级速率常数为 $k_{out}$。对 $\\frac{dC_i}{dt}$ 的贡献为 $-k_{out}C_i$。\n通过酶降解清除药物的速率与内部浓度 $C_i$ 成正比，一级速率常数为 $k_{deg}$。对 $\\frac{dC_i}{dt}$ 的贡献为 $-k_{deg}C_i$。\n\n结合这些项，控制细胞内药物浓度的微分方程为：\n$$\n\\frac{dC_i(t)}{dt} = k_{in}C_e - k_{out}C_i(t) - k_{deg}C_i(t)\n$$\n这可以写成：\n$$\n\\frac{dC_i(t)}{dt} = k_{in}C_e - (k_{out} + k_{deg})C_i(t)\n$$\n\n**1. 稳态细胞内浓度 ($C_i^{*}$)**\n\n在稳态下，细胞内浓度不再随时间变化，因此 $\\frac{dC_i}{dt} = 0$。设稳态浓度为 $C_i^{*}$。将导数设为零，得到：\n$$\n0 = k_{in}C_e - (k_{out} + k_{deg})C_i^{*}\n$$\n求解 $C_i^{*}$ 得到第一个任务的结果：\n$$\n(k_{out} + k_{deg})C_i^{*} = k_{in}C_e\n$$\n$$\nC_i^{*} = \\frac{k_{in}C_e}{k_{out} + k_{deg}}\n$$\n这是稳态细胞内抗生素浓度。\n\n**2. 基线占据分数 ($f_0$)**\n\n分子靶标的占据分数 $f$ 由公式 $f = \\frac{C_i}{C_i + K_d}$ 给出。基线占据分数 $f_0$ 是在稳态浓度 $C_i^{*}$ 下的占据分数。\n$$\nf_0 = \\frac{C_i^{*}}{C_i^{*} + K_d}\n$$\n代入 $C_i^{*}$ 的表达式：\n$$\nf_0 = \\frac{\\frac{k_{in}C_e}{k_{out} + k_{deg}}}{\\frac{k_{in}C_e}{k_{out} + k_{deg}} + K_d}\n$$\n为简化，我们将分子和分母同乘以 $(k_{out} + k_{deg})$：\n$$\nf_0 = \\frac{k_{in}C_e}{k_{in}C_e + K_d(k_{out} + k_{deg})}\n$$\n\n**3. 占据比 ($R_{out}$ 和 $R_{deg}$)**\n\n我们现在评估当外排速率或降解速率加倍时，占据分数如何变化。\n\n**情况A：外排速率加倍 ($k_{out} \\to 2k_{out}$)**\n\n首先，我们通过在 $C_i^{*}$ 的表达式中用 $2k_{out}$ 替换 $k_{out}$ 来找到新的稳态浓度，称之为 $C_{i,out}^{*}$：\n$$\nC_{i,out}^{*} = \\frac{k_{in}C_e}{2k_{out} + k_{deg}}\n$$\n新的占据分数 $f_{out}$ 为：\n$$\nf_{out} = \\frac{C_{i,out}^{*}}{C_{i,out}^{*} + K_d} = \\frac{\\frac{k_{in}C_e}{2k_{out} + k_{deg}}}{\\frac{k_{in}C_e}{2k_{out} + k_{deg}} + K_d}\n$$\n将分子和分母同乘以 $(2k_{out} + k_{deg})$ 进行简化：\n$$\nf_{out} = \\frac{k_{in}C_e}{k_{in}C_e + K_d(2k_{out} + k_{deg})}\n$$\n占据比 $R_{out}$ 是这个新占据分数与基线占据分数 $f_0$ 的比值：\n$$\nR_{out} = \\frac{f_{out}}{f_0} = \\frac{\\frac{k_{in}C_e}{k_{in}C_e + K_d(2k_{out} + k_{deg})}}{\\frac{k_{in}C_e}{k_{in}C_e + K_d(k_{out} + k_{deg})}}\n$$\n消去公因式 $k_{in}C_e$ 后，我们得到：\n$$\nR_{out} = \\frac{k_{in}C_e + K_d(k_{out} + k_{deg})}{k_{in}C_e + K_d(2k_{out} + k_{deg})}\n$$\n\n**情况B：降解速率加倍 ($k_{deg} \\to 2k_{deg}$)**\n\n类似地，我们通过用 $2k_{deg}$ 替换 $k_{deg}$ 来找到新的稳态浓度 $C_{i,deg}^{*}$：\n$$\nC_{i,deg}^{*} = \\frac{k_{in}C_e}{k_{out} + 2k_{deg}}\n$$\n相应的新占据分数 $f_{deg}$ 为：\n$$\nf_{deg} = \\frac{C_{i,deg}^{*}}{C_{i,deg}^{*} + K_d} = \\frac{\\frac{k_{in}C_e}{k_{out} + 2k_{deg}}}{\\frac{k_{in}C_e}{k_{out} + 2k_{deg}} + K_d}\n$$\n将分子和分母同乘以 $(k_{out} + 2k_{deg})$ 进行简化：\n$$\nf_{deg} = \\frac{k_{in}C_e}{k_{in}C_e + K_d(k_{out} + 2k_{deg})}\n$$\n占据比 $R_{deg}$ 是 $f_{deg}$ 与基线占据分数 $f_0$ 的比值：\n$$\nR_{deg} = \\frac{f_{deg}}{f_0} = \\frac{\\frac{k_{in}C_e}{k_{in}C_e + K_d(k_{out} + 2k_{deg})}}{\\frac{k_{in}C_e}{k_{in}C_e + K_d(k_{out} + k_{deg})}}\n$$\n消去公因式 $k_{in}C_e$ 后，我们得到：\n$$\nR_{deg} = \\frac{k_{in}C_e + K_d(k_{out} + k_{deg})}{k_{in}C_e + K_d(k_{out} + 2k_{deg})}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k_{in}C_e}{k_{out} + k_{deg}} & \\frac{k_{in}C_e + K_d(k_{out} + k_{deg})}{k_{in}C_e + K_d(2k_{out} + k_{deg})} & \\frac{k_{in}C_e + K_d(k_{out} + k_{deg})}{k_{in}C_e + K_d(k_{out} + 2k_{deg})}\n\\end{pmatrix}\n}\n$$", "id": "4645060"}, {"introduction": "虽然耐药性可由自发突变产生，但其在细菌种群中的迅速传播通常是由水平基因转移（HGT）驱动的。噬菌体介导的转导是一种关键的HGT机制，它可以在不同细菌之间转移耐药基因。这项高级实践要求您使用常微分方程组来模拟转导的动力学过程。您将运用准稳态近似法推导耐药基因的转移速率，并利用灵敏度分析来确定对该过程影响最大的参数。通过构建和分析HGT的动力学模型，您将更深入地理解控制抗生素耐药性传播的种群层面动力学，这是其流行病学研究的一个关键方面 [@problem_id:4645038]。", "problem": "一个混合均匀的细菌群落包含供体和受体以及噬菌体（phage）。在普遍性转导中，一部分子代噬菌体会包装供体DNA（包括抗生素抗性基因），并在吸附到受体上后，可能成功整合该基因。请考虑以下质量作用框架，以推导抗性基因被转导到受体中的初始速率，并确定哪些参数对该速率的控制最强。\n\n基本依据与假设：\n- 质量作用吸附：噬菌体样颗粒与细菌之间的相遇速率与其密度之积成正比。\n- 裂解产生：裂解后，每个受感染的供体产生一批子代，其中一部分是携带供体DNA的转导颗粒。\n- 快速变量的短时准稳态条件：在所考虑的短时间窗口内，在近似恒定的供体、受体和游离噬菌体密度下，受感染的供体细胞和转导颗粒达到准稳态丰度。\n- 密度通过参考尺度进行无量纲化，因此所有细菌和噬菌体密度都是某个固定参考密度的无量纲分数。有效吸附常数将质量作用项的单位调整为每小时。\n\n定义变量和参数：\n- $D$：无量纲供体密度。\n- $R$：无量纲受体密度。\n- $P$：无量纲游离噬菌体密度。\n- $I_D$：受感染供体的无量纲密度。\n- $T$：转导颗粒（包装供体DNA的噬菌体样颗粒）的无量纲密度。\n- $X$：新转导的受体（通过转导获得抗性的受体）的无量纲密度。\n- $\\alpha$：有效吸附速率常数，单位为$\\mathrm{h}^{-1}$（包含了物理吸附常数和参考密度缩放）。\n- $\\lambda$：裂解速率，单位为$\\mathrm{h}^{-1}$。\n- $\\beta$：裂解量（每个裂解的受感染供体产生的子代数量，无量纲）。\n- $\\eta$：子代中转导颗粒所占的比例（无量纲）。\n- $\\delta$：转导颗粒的衰变或失活速率，单位为$\\mathrm{h}^{-1}$。\n- $\\gamma$：转导颗粒吸附到受体上导致成功基因转移的概率（无量纲）。\n\n动力学（常微分方程(ODE)系统），在短时近似下将$D$、$R$和$P$视为常数：\n- $\\dfrac{d I_D}{d t} = \\alpha P D - \\lambda I_D$.\n- $\\dfrac{d T}{d t} = \\eta \\beta \\lambda I_D - \\alpha T (D + R) - \\delta T$.\n- $\\dfrac{d X}{d t} = \\gamma \\alpha T R$.\n\n任务：\n1. 从上述基础和ODE系统出发，对$I_D$和$T$使用代数准稳态分析，推导初始转导速率$r$的闭式表达式，其中$r = \\dfrac{d X}{d t}$，单位为$\\mathrm{h}^{-1}$，并用$(\\alpha,\\beta,\\eta,\\gamma,P,D,R,\\delta)$表示。\n2. 使用推导出的$r$的表达式，计算$r$相对于有序集$\\left[\\alpha,\\beta,\\eta,\\gamma,P,D,R,\\delta\\right]$中每个参数$\\theta$的局部对数敏感度（弹性），其定义为$E_\\theta = \\dfrac{\\partial \\ln r}{\\partial \\ln \\theta}$。\n3. 对于下述测试套件中的每一组参数，计算：\n   - 初始转导速率$r$（以$\\mathrm{h}^{-1}$为单位），并四舍五入到六位小数。\n   - 在$\\left[\\alpha,\\beta,\\eta,\\gamma,P,D,R,\\delta\\right]$中具有最大绝对弹性$\\left|E_\\theta\\right|$的单个参数的索引（整数）。如果出现平局，选择最小的索引。如果$r = 0$，则将索引设置为$-1$。\n\n测试套件（每个案例是一个元组$(\\alpha,\\beta,\\eta,\\gamma,P,D,R,\\delta)$，所有速率单位为$\\mathrm{h}^{-1}$，密度无量纲）：\n- 案例1：$\\left(0.5, 50, 0.01, 0.2, 0.1, 0.3, 0.7, 0.1\\right)$。\n- 案例2：$\\left(0.5, 50, 0.01, 0.2, 0.1, 0.3, 0.0, 0.1\\right)$。\n- 案例3：$\\left(1.0, 20, 0.05, 0.3, 0.5, 0.2, 0.8, 0.0\\right)$。\n- 案例4：$\\left(1.0, 20, 0.05, 0.3, 0.5, 0.4, 0.6, 10.0\\right)$。\n- 案例5：$\\left(0.2, 100, 0.02, 0.1, 0.9, 0.0, 0.5, 0.05\\right)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个逗号分隔的内部列表组成的列表，每个内部列表包含四舍五入后的速率和索引，并用方括号括起来，例如$\\left[[r_1,i_1],[r_2,i_2],[r_3,i_3]\\right]$。", "solution": "### 第1部分：初始转导速率($r$)的推导\n\n核心任务是在对受感染供体($I_D$)和转导颗粒($T$)的密度采用准稳态近似(QSSA)的条件下，确定新转导受体的初始生成速率$r = \\dfrac{d X}{d t}$。QSSA假设，对于快速反应的中间物种，其净变化率近似为零。控制性的常微分方程(ODE)如下：\n$$ \\dfrac{d I_D}{d t} = \\alpha P D - \\lambda I_D $$\n$$ \\dfrac{d T}{d t} = \\eta \\beta \\lambda I_D - \\alpha T (D + R) - \\delta T $$\n$$ \\dfrac{d X}{d t} = \\gamma \\alpha T R $$\n\n1.  **受感染供体($I_D$)的准稳态**：\n    我们通过设置$\\dfrac{d I_D}{d t} = 0$将QSSA应用于受感染的供体群体。如果裂解过程相对于游离噬菌体($P$)、供体($D$)和受体($R$)群体变化的时间尺度而言是快速的，那么这种做法是合理的。\n    $$ \\alpha P D - \\lambda I_{D,qss} = 0 $$\n    求解受感染供体的准稳态浓度$I_{D,qss}$，我们得到：\n    $$ I_{D,qss} = \\frac{\\alpha P D}{\\lambda} $$\n    该式在裂解速率$\\lambda > 0$的条件下有效。\n\n2.  **转导颗粒($T$)的准稳态**：\n    接下来，我们通过设置$\\dfrac{d T}{d t} = 0$将QSSA应用于转导颗粒群体。如果转导颗粒的产生和清除是快速过程，则这种做法是合理的。\n    $$ \\eta \\beta \\lambda I_D - \\alpha T (D + R) - \\delta T = 0 $$\n    我们可以从清除项中提出$T$：\n    $$ \\eta \\beta \\lambda I_D = T(\\alpha (D + R) + \\delta) $$\n    现在，我们将之前找到的$I_{D,qss}$表达式代入此方程：\n    $$ \\eta \\beta \\lambda \\left( \\frac{\\alpha P D}{\\lambda} \\right) = T_{qss} (\\alpha (D + R) + \\delta) $$\n    假设$\\lambda \\neq 0$，裂解速率被消去：\n    $$ \\eta \\beta \\alpha P D = T_{qss} (\\alpha (D + R) + \\delta) $$\n    求解转导颗粒的准稳态浓度$T_{qss}$：\n    $$ T_{qss} = \\frac{\\eta \\beta \\alpha P D}{\\alpha (D + R) + \\delta} $$\n    只要转导颗粒的总清除速率$\\alpha (D + R) + \\delta$不为零，该表达式就有效。\n\n3.  **初始转导速率($r$)的表达式**：\n    转导受体的生成速率$r$由$\\dfrac{d X}{d t}$给出。我们将$T_{qss}$的表达式代入最后一个方程：\n    $$ r = \\frac{d X}{d t} = \\gamma \\alpha T R = \\gamma \\alpha R \\cdot T_{qss} $$\n    $$ r = \\gamma \\alpha R \\left( \\frac{\\eta \\beta \\alpha P D}{\\alpha (D + R) + \\delta} \\right) $$\n    合并各项，得到初始转导速率的最终闭式表达式：\n    $$ r = \\frac{\\gamma \\eta \\beta \\alpha^2 P D R}{\\alpha (D + R) + \\delta} $$\n\n### 第2部分：对数敏感度（弹性）的推导\n\n速率$r$相对于参数$\\theta$的弹性$E_\\theta$定义为对数导数$E_\\theta = \\dfrac{\\partial \\ln r}{\\partial \\ln \\theta}$。该量度量了$\\theta$的份数变化所引起的$r$的份数变化。我们首先使用推导出的速率方程来表示$\\ln r$：\n$$ \\ln r = \\ln(\\gamma) + \\ln(\\eta) + \\ln(\\beta) + 2\\ln(\\alpha) + \\ln(P) + \\ln(D) + \\ln(R) - \\ln(\\alpha(D+R) + \\delta) $$\n参数集为$\\left[\\alpha,\\beta,\\eta,\\gamma,P,D,R,\\delta\\right]$。我们通过对$\\ln r$取关于该参数自然对数的偏导数来计算每个参数的弹性。\n\n-   对于参数$\\beta$、$\\eta$、$\\gamma$和$P$，它们在分子中以简单的乘法项出现：\n    $E_\\beta = \\dfrac{\\partial \\ln r}{\\partial \\ln \\beta} = 1$\n    $E_\\eta = \\dfrac{\\partial \\ln r}{\\partial \\ln \\eta} = 1$\n    $E_\\gamma = \\dfrac{\\partial \\ln r}{\\partial \\ln \\gamma} = 1$\n    $E_P = \\dfrac{\\partial \\ln r}{\\partial \\ln P} = 1$\n\n-   对于参数$\\alpha$：\n    $E_\\alpha = \\dfrac{\\partial \\ln r}{\\partial \\ln \\alpha} = \\dfrac{\\partial}{\\partial \\ln \\alpha} \\left( 2\\ln\\alpha - \\ln(\\alpha(D+R) + \\delta) \\right) = 2 - \\dfrac{\\partial \\ln(\\alpha(D+R) + \\delta)}{\\partial \\ln \\alpha}$\n    使用链式法则，$\\frac{\\partial f}{\\partial \\ln x} = x \\frac{\\partial f}{\\partial x}$：\n    $E_\\alpha = 2 - \\alpha \\cdot \\dfrac{1}{\\alpha(D+R) + \\delta} \\cdot \\dfrac{\\partial}{\\partial \\alpha}(\\alpha(D+R) + \\delta) = 2 - \\dfrac{\\alpha(D+R)}{\\alpha(D+R) + \\delta}$\n    $$ E_\\alpha = \\frac{2(\\alpha(D+R) + \\delta) - \\alpha(D+R)}{\\alpha(D+R) + \\delta} = \\frac{\\alpha(D+R) + 2\\delta}{\\alpha(D+R) + \\delta} $$\n\n-   对于参数$D$：\n    $E_D = \\dfrac{\\partial \\ln r}{\\partial \\ln D} = \\dfrac{\\partial}{\\partial \\ln D} \\left( \\ln D - \\ln(\\alpha(D+R) + \\delta) \\right) = 1 - \\dfrac{\\alpha D}{\\alpha(D+R) + \\delta}$\n    $$ E_D = \\frac{\\alpha(D+R) + \\delta - \\alpha D}{\\alpha(D+R) + \\delta} = \\frac{\\alpha R + \\delta}{\\alpha(D+R) + \\delta} $$\n\n-   对于参数$R$：\n    $E_R = \\dfrac{\\partial \\ln r}{\\partial \\ln R} = \\dfrac{\\partial}{\\partial \\ln R} \\left( \\ln R - \\ln(\\alpha(D+R) + \\delta) \\right) = 1 - \\dfrac{\\alpha R}{\\alpha(D+R) + \\delta}$\n    $$ E_R = \\frac{\\alpha(D+R) + \\delta - \\alpha R}{\\alpha(D+R) + \\delta} = \\frac{\\alpha D + \\delta}{\\alpha(D+R) + \\delta} $$\n\n-   对于参数$\\delta$：\n    $E_\\delta = \\dfrac{\\partial \\ln r}{\\partial \\ln \\delta} = \\dfrac{\\partial}{\\partial \\ln \\delta} \\left( -\\ln(\\alpha(D+R) + \\delta) \\right) = - \\dfrac{\\delta}{\\alpha(D+R) + \\delta} \\cdot \\dfrac{\\partial}{\\partial \\delta}(\\alpha(D+R) + \\delta)$\n    $$ E_\\delta = -\\frac{\\delta}{\\alpha(D+R) + \\delta} $$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Solves the transduction rate problem for a suite of test cases.\n    It derives the initial transduction rate and its sensitivities to various parameters,\n    then computes these values for each case.\n    \"\"\"\n\n    # Test cases defined as tuples of (alpha, beta, eta, gamma, P, D, R, delta)\n    # Rates are in h^-1, other quantities are dimensionless.\n    test_cases = [\n        # Case 1\n        (0.5, 50, 0.01, 0.2, 0.1, 0.3, 0.7, 0.1),\n        # Case 2\n        (0.5, 50, 0.01, 0.2, 0.1, 0.3, 0.0, 0.1),\n        # Case 3\n        (1.0, 20, 0.05, 0.3, 0.5, 0.2, 0.8, 0.0),\n        # Case 4\n        (1.0, 20, 0.05, 0.3, 0.5, 0.4, 0.6, 10.0),\n        # Case 5\n        (0.2, 100, 0.02, 0.1, 0.9, 0.0, 0.5, 0.05),\n    ]\n\n    results = []\n    \n    # The order of parameters for elasticity indexing.\n    # Indices: alpha=0, beta=1, eta=2, gamma=3, P=4, D=5, R=6, delta=7.\n    \n    for case in test_cases:\n        alpha, beta, eta, gamma, P, D, R, delta = case\n\n        # Check for conditions that make the rate r = 0.\n        # The rate is proportional to the product of these parameters.\n        if alpha == 0 or beta == 0 or eta == 0 or gamma == 0 or P == 0 or D == 0 or R == 0:\n            rate = 0.0\n            max_elasticity_index = -1\n            results.append([f'{rate:.6f}', max_elasticity_index])\n            continue\n        \n        # Calculate the transduction rate, r, using the derived formula:\n        # r = (gamma * eta * beta * alpha^2 * P * D * R) / (alpha * (D + R) + delta)\n        numerator = gamma * eta * beta * (alpha**2) * P * D * R\n        denominator = alpha * (D + R) + delta\n        \n        # Although the problem setup ensures denominator > 0 for r > 0,\n        # it is good practice to handle potential division by zero.\n        if denominator == 0:\n            # This case implies alpha=0 and delta=0. If alpha=0, it's caught\n            # by the first check. This branch should not be reached with the given test cases.\n            rate = 0.0\n            max_elasticity_index = -1\n        else:\n            rate = numerator / denominator\n\n            # Calculate elasticities E_theta = d(ln r) / d(ln theta)\n            elasticities = np.zeros(8)\n            \n            # E_alpha = (alpha * (D + R) + 2*delta) / (alpha * (D + R) + delta)\n            elasticities[0] = (alpha * (D + R) + 2 * delta) / denominator\n            \n            # E_beta = 1\n            elasticities[1] = 1.0\n            \n            # E_eta = 1\n            elasticities[2] = 1.0\n\n            # E_gamma = 1\n            elasticities[3] = 1.0\n            \n            # E_P = 1\n            elasticities[4] = 1.0\n            \n            # E_D = (alpha * R + delta) / (alpha * (D + R) + delta)\n            elasticities[5] = (alpha * R + delta) / denominator\n            \n            # E_R = (alpha * D + delta) / (alpha * (D + R) + delta)\n            elasticities[6] = (alpha * D + delta) / denominator\n            \n            # E_delta = -delta / (alpha * (D + R) + delta)\n            elasticities[7] = -delta / denominator\n            \n            # Find the index of the parameter with the largest absolute elasticity.\n            # In case of a tie, np.argmax returns the first (smallest) index.\n            max_elasticity_index = int(np.argmax(np.abs(elasticities)))\n\n        # Format the result for the current case.\n        results.append([f'{rate:.6f}', max_elasticity_index])\n\n    # Format the final output string as a list of lists.\n    # The string representation [r, i] gets formatted without extra spaces.\n    formatted_results = [f'[{r},{i}]' for r, i in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "4645038"}]}