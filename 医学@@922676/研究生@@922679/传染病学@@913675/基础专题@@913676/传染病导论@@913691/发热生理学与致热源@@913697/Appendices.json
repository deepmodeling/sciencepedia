{"hands_on_practices": [{"introduction": "理解发热的生理机制始于分子层面。本练习将探讨前列腺素E2（$PGE_2$）与其受体之间关键的相互作用，这正是向大脑发出升高体温指令的直接分子开关。通过应用受体动力学的基本原理，我们可以量化发热级联反应中的这一个起始步骤([@problem_id:4642986])。", "problem": "下丘脑视前区的前列腺素E受体3 (EP3) 介导了对前列腺素E2 (PGE2) 的发热反应，PGE2是在感染诱导的环氧合酶活性下游产生的一种脂质介质。考虑一个单一位点、非协同的受体-配体系统，其中PGE2 ($L$) 与EP3 ($R$) 结合形成复合物 ($RL$)。假设条件为充分混合，且配体过量存在，因此游离配体浓度等于施加浓度。在平衡状态下，可逆结合反应 $R + L \\rightleftharpoons RL$ 遵循质量作用定律，平衡解离常数定义为 $K_{d} = \\frac{[R][L]}{[RL]}$，其中 $[R]$、$[L]$ 和 $[RL]$ 分别表示游离受体、游离配体和受体-配体复合物的平衡浓度。总受体浓度为 $R_{T} = [R] + [RL]$。视前区的温敏神经元降低其放电频率的程度与EP3的占有率成正比，其线性转导因子 $\\eta$ 由关系式 $r = \\eta f$ 定义，其中 $r$ 为放电频率的相对降低量，$f$ 为受体占有分数。\n\n从这些定义和质量作用定律出发，推导占有分数 $f$ 关于 $[L]$ 和 $K_{d}$ 的表达式，然后利用它来预测比例降低量 $r$，给定EP3-PGE2系统的以下实验支持参数：$[L] = 5\\,\\mathrm{nM}$，$K_{d} = 3\\,\\mathrm{nM}$，以及 $\\eta = 0.8$。将 $r$ 的最终答案表示为无单位的小数，并四舍五入到四位有效数字。", "solution": "问题要求推导受体占有分数 $f$，并随后计算神经元放电频率的相对降低量 $r$。\n\n首先，我们建立受体占有分数 $f$ 的关系式。占有分数定义为配体结合受体浓度 $[RL]$ 与总受体浓度 $R_T$ 的比值。\n$$f = \\frac{[RL]}{R_T}$$\n总受体浓度 $R_T$ 是游离受体浓度 $[R]$ 和配体结合受体浓度 $[RL]$ 的和。\n$$R_T = [R] + [RL]$$\n将此代入 $f$ 的表达式得到：\n$$f = \\frac{[RL]}{[R] + [RL]}$$\n为了用游离配体浓度 $[L]$ 和平衡解离常数 $K_d$ 来表示 $f$，我们使用质量作用定律为反应 $R + L \\rightleftharpoons RL$ 提供的 $K_d$ 定义。\n$$K_d = \\frac{[R][L]}{[RL]}$$\n我们可以重排这个方程来求解游离受体浓度 $[R]$。\n$$[R] = \\frac{K_d [RL]}{[L]}$$\n现在，我们将这个 $[R]$ 的表达式代入 $f$ 方程的分母中。\n$$f = \\frac{[RL]}{\\left(\\frac{K_d [RL]}{[L]}\\right) + [RL]}$$\n项 $[RL]$ 是分母中的一个公因子，可以被提取出来。\n$$f = \\frac{[RL]}{[RL] \\left(\\frac{K_d}{[L]} + 1\\right)}$$\n假设复合物浓度不为零 ($[RL] \\neq 0$)，我们可以从分子和分母中消去 $[RL]$ 项。\n$$f = \\frac{1}{\\frac{K_d}{[L]} + 1}$$\n为简化这个繁分数，我们将分子和分母同乘以 $[L]$。\n$$f = \\frac{1 \\cdot [L]}{\\left(\\frac{K_d}{[L]} + 1\\right) \\cdot [L]} = \\frac{[L]}{K_d + [L]}$$\n这就是推导出的占有分数 $f$ 关于 $[L]$ 和 $K_d$ 的表达式。\n\n接下来，我们计算神经元放电频率的相对降低量 $r$。问题陈述了 $r$ 和 $f$ 之间存在由转导因子 $\\eta$ 给出的线性关系。\n$$r = \\eta f$$\n代入我们推导出的 $f$ 表达式：\n$$r = \\eta \\left( \\frac{[L]}{[L] + K_d} \\right)$$\n我们已知以下实验参数：\n$[L] = 5\\,\\mathrm{nM}$\n$K_d = 3\\,\\mathrm{nM}$\n$\\eta = 0.8$\n\n我们将这些值代入 $r$ 的表达式中。分数中的浓度单位 ($\\mathrm{nM}$) 会消去，得到一个无量纲的 $f$ 值，正如预期。\n$$r = 0.8 \\left( \\frac{5\\,\\mathrm{nM}}{5\\,\\mathrm{nM} + 3\\,\\mathrm{nM}} \\right)$$\n$$r = 0.8 \\left( \\frac{5}{8} \\right)$$\n$$r = 0.8 \\times 0.625$$\n$$r = 0.5$$\n问题要求最终答案表示为无单位小数，并四舍五入到四位有效数字。因此，$0.5$ 写作 $0.5000$。", "answer": "$$\\boxed{0.5000}$$", "id": "4642986"}, {"introduction": "一旦大脑的“恒温器”被重置，整个身体的体温调节系统就会启动。本练习使用一个简化但功能强大的数学模型来探索核心体温如何动态地调整至新的设定点([@problem_id:4642970])。该模型还清晰地从数量上解释了为何退烧药对发热有效，但对劳力性热射病等其他类型的高热无效，这突显了区分不同高热状态的临床重要性。", "problem": "一名患有感染性疾病的发热成年人，其下丘脑设定点因前列腺素E2 (PGE2) 的作用而升高，在稳态下，其核心温度等于此升高的设定点。相比之下，在劳力性热射病 (EHS) 中，核心温度升高，但下丘脑设定点并未升高。考虑一个基于能量守恒和线性负反馈的单室体温调节模型：身体是一个混合均匀的热质量，热容为 $C$，体温调节效应器实施比例控制，产生一个净散热功率，该功率与误差 $e = T_{\\text{core}} - T_{\\text{set}}$ 成正比，比例常数为 $\\alpha$。假设以下基本事实：\n1) 在一个稳定工作点附近进行局部线性化，此时所有非体温调节性热通量均平衡且不变，能量平衡意味着核心温度 $T_{\\text{core}}$ 的变化仅由效应器功率驱动。\n2) 当发热由PGE2介导时，退烧药布洛芬 (ibuprofen) 会将下丘脑设定点 $T_{\\text{set}}$ 降低 $1\\,^{\\circ}\\mathrm{C}$，但在EHS中则不会改变 $T_{\\text{set}}$。\n3) 布洛芬 (Ibuprofen) 对产热、环境热交换参数或反馈增益 $\\alpha$ 没有直接影响。\n\n在时间 $t=0$ 时，给予布洛芬 (ibuprofen)。对于发热患者，在给药前，升高的设定点为 $T_{\\text{set,old}} = T_{\\text{norm}} + 2\\,^{\\circ}\\mathrm{C}$，系统处于稳态，因此 $T_{\\text{core}}(0^{-}) = T_{\\text{set,old}}$。在发热情景下，服用布洛芬后，设定点立即阶跃至 $T_{\\text{set,new}} = T_{\\text{norm}} + 1\\,^{\\circ}\\mathrm{C}$。在EHS情景下，$T_{\\text{set}}$ 不受布洛芬影响。设身体热容为 $C = 2.16 \\times 10^{5}\\ \\mathrm{J}\\,^{\\circ}\\mathrm{C}^{-1}$，比例反馈增益为 $\\alpha = 1.20 \\times 10^{2}\\ \\mathrm{W}\\,^{\\circ}\\mathrm{C}^{-1}$。在 $t = 30$ 分钟（即 $t = 1800\\ \\mathrm{s}$）时进行评估。\n\n仅使用上述原理，推导在发热情景中 $T_{\\text{set}}$ 发生阶跃变化后 $T_{\\text{core}}(t)$ 的控制方程，并计算在 $t=30$ 分钟时，发热和EHS两种情景下由布洛芬引起的核心温度下降的预期差异。此处，将“由布洛芬引起的核心温度下降”定义为在其他条件相同的情况下，仅由布洛芬引起的 $T_{\\text{set}}$ 变化所导致的 $T_{\\text{core}}(0) - T_{\\text{core}}(t)$。请以摄氏度表示您的最终结果，并将答案四舍五入至四位有效数字。", "solution": "该问题要求推导核心体温 $T_{\\text{core}}$ 的控制微分方程，然后应用该方程计算在服用布洛芬 (ibuprofen) 后，发热状态和劳力性热射病 (EHS) 状态下体温下降的差异。\n\n首先，我们根据所给原理推导控制方程。身体被建模为具有热容 $C$ 的单室。能量守恒原理指出，身体内能 $U$ 的变化率等于供给给它的净功率 $P_{\\text{net}}$。内能由 $U = C T_{\\text{core}}$ 给出。因此，其变化率为 $\\frac{dU}{dt} = C \\frac{dT_{\\text{core}}}{dt}$。\n\n问题指明，体温调节效应器响应产生一个净散热功率 $P_{\\text{loss}}$，该功率与误差 $e = T_{\\text{core}} - T_{\\text{set}}$ 成正比。比例常数是反馈增益 $\\alpha$。\n$$P_{\\text{loss}} = \\alpha (T_{\\text{core}} - T_{\\text{set}})$$\n这代表离开系统的功率。因此，由该调节作用产生的系统净输入功率为 $P_{\\text{reg}} = -P_{\\text{loss}}$。\n$$P_{\\text{reg}} = -\\alpha (T_{\\text{core}} - T_{\\text{set}})$$\n问题陈述“核心温度 $T_{\\text{core}}$ 的变化仅由效应器功率驱动”，这意味着我们在考虑温度*变化*的能量平衡时，只考虑这一功率项。将内能的变化率与此净功率相等，即可得到控制方程：\n$$C \\frac{dT_{\\text{core}}}{dt} = -\\alpha (T_{\\text{core}} - T_{\\text{set}})$$\n这是一个一阶线性常微分方程。它可以改写为标准形式：\n$$\\frac{dT_{\\text{core}}}{dt} + \\frac{\\alpha}{C} T_{\\text{core}} = \\frac{\\alpha}{C} T_{\\text{set}}$$\n这就是所求的 $T_{\\text{core}}(t)$ 的控制方程。\n\n接下来，我们求解发热情景下的这个方程。在 $t=0$ 时给予布洛芬 (ibuprofen)。\n$t=0^{-}$ 时的初始条件是一个稳态，此时核心温度等于升高的设定点，$T_{\\text{core}}(0^{-}) = T_{\\text{set,old}}$。由于热惯性，温度是连续的，所以 $T_{\\text{core}}(0) = T_{\\text{core}}(0^{-}) = T_{\\text{set,old}}$。\n对于 $t \\ge 0$，布洛芬将设定点降低到一个新的常数值 $T_{\\text{set,new}}$。微分方程变为：\n$$\\frac{dT_{\\text{core}}}{dt} + \\frac{\\alpha}{C} T_{\\text{core}} = \\frac{\\alpha}{C} T_{\\text{set,new}}$$\n该方程的通解是齐次解和特解之和。特解是新的稳态温度，$T_{\\text{core}} = T_{\\text{set,new}}$。齐次方程 $\\frac{dT_{h}}{dt} + \\frac{\\alpha}{C} T_{h} = 0$ 的解为 $T_{h}(t) = A \\exp\\left(-\\frac{\\alpha}{C}t\\right)$，其中 $A$ 是一个积分常数。\n完整解为：\n$$T_{\\text{core}}(t) = T_{\\text{set,new}} + A \\exp\\left(-\\frac{\\alpha}{C}t\\right)$$\n我们使用初始条件 $T_{\\text{core}}(0) = T_{\\text{set,old}}$ 来确定 $A$：\n$$T_{\\text{set,old}} = T_{\\text{set,new}} + A \\exp(0) \\implies A = T_{\\text{set,old}} - T_{\\text{set,new}}$$\n所以，发热患者的温度演变为：\n$$T_{\\text{core,fever}}(t) = T_{\\text{set,new}} + (T_{\\text{set,old}} - T_{\\text{set,new}}) \\exp\\left(-\\frac{\\alpha}{C}t\\right)$$\n由布洛芬引起的核心温度下降定义为 $\\Delta T_{\\text{reduction}}(t) = T_{\\text{core}}(0) - T_{\\text{core}}(t)$。对于发热情况：\n$$\\Delta T_{\\text{reduction, fever}}(t) = T_{\\text{core}}(0) - T_{\\text{core,fever}}(t) = T_{\\text{set,old}} - \\left[T_{\\text{set,new}} + (T_{\\text{set,old}} - T_{\\text{set,new}}) \\exp\\left(-\\frac{\\alpha}{C}t\\right)\\right]$$\n$$\\Delta T_{\\text{reduction, fever}}(t) = (T_{\\text{set,old}} - T_{\\text{set,new}}) \\left(1 - \\exp\\left(-\\frac{\\alpha}{C}t\\right)\\right)$$\n问题陈述对于发热，布洛芬将 $T_{\\text{set}}$ 降低 $1\\,^{\\circ}\\mathrm{C}$，所以 $T_{\\text{set,old}} - T_{\\text{set,new}} = 1\\,^{\\circ}\\mathrm{C}$。\n$$\\Delta T_{\\text{reduction, fever}}(t) = (1\\,^{\\circ}\\mathrm{C}) \\left(1 - \\exp\\left(-\\frac{\\alpha}{C}t\\right)\\right)$$\n\n对于EHS情景，问题陈述布洛芬不改变 $T_{\\text{set}}$。由于布洛芬对 $C$ 或 $\\alpha$ 也没有影响，它的给药不会改变控制方程中的任何参数。因此，$T_{\\text{core}}$ 的动态不受影响，*仅由布洛芬引起的 $T_{\\text{set}}$ 变化所导致*的温度变化为零。\n$$\\Delta T_{\\text{reduction, EHS}}(t) = 0\\,^{\\circ}\\mathrm{C}$$\n\n我们被要求计算在 $t = 30\\ \\text{minutes} = 1800\\ \\mathrm{s}$ 时这些下降值的差异：\n$$\\text{Difference} = \\Delta T_{\\text{reduction, fever}}(t=1800) - \\Delta T_{\\text{reduction, EHS}}(t=1800)$$\n$$\\text{Difference} = (1\\,^{\\circ}\\mathrm{C}) \\left(1 - \\exp\\left(-\\frac{\\alpha}{C}t\\right)\\right) - 0$$\n现在，我们代入数值：\n$C = 2.16 \\times 10^{5}\\ \\mathrm{J}\\,^{\\circ}\\mathrm{C}^{-1}$\n$\\alpha = 1.20 \\times 10^{2}\\ \\mathrm{W}\\,^{\\circ}\\mathrm{C}^{-1} = 1.20 \\times 10^{2}\\ \\mathrm{J}\\,\\mathrm{s}^{-1}\\,^{\\circ}\\mathrm{C}^{-1}$\n$t = 1800\\ \\mathrm{s}$\n\n指数项为 $-\\frac{\\alpha}{C}t$。量 $\\tau = C/\\alpha$ 是系统的特征时间常数。\n$$\\tau = \\frac{C}{\\alpha} = \\frac{2.16 \\times 10^{5}\\ \\mathrm{J}\\,^{\\circ}\\mathrm{C}^{-1}}{1.20 \\times 10^{2}\\ \\mathrm{J}\\,\\mathrm{s}^{-1}\\,^{\\circ}\\mathrm{C}^{-1}} = 1.8 \\times 10^{3}\\ \\mathrm{s} = 1800\\ \\mathrm{s}$$\n指定的时间 $t$ 正好是一个时间常数。所以，指数的宗量为 $-\\frac{t}{\\tau} = -\\frac{1800}{1800} = -1$。\n温度下降的差异是：\n$$\\text{Difference} = (1\\,^{\\circ}\\mathrm{C}) \\left(1 - \\exp(-1)\\right)$$\n数值计算此值：\n$$\\text{Difference} \\approx 1 \\times (1 - 0.36787944...) = 0.63212056... \\,^{\\circ}\\mathrm{C}$$\n将结果四舍五入到四位有效数字，我们得到 $0.6321\\,^{\\circ}\\mathrm{C}$。", "answer": "$$\\boxed{0.6321}$$", "id": "4642970"}, {"introduction": "为了准确预测药物在患者体内的效果，我们需要整合药物的吸收、分布、代谢及其对靶点作用等多个过程。这项高级计算练习将指导您构建一个综合的药代动力学-药效动力学（PK-PD）模型([@problem_id:4643000])。通过模拟从药物摄入到中枢神经系统效应的整个事件链，您可以预测服用退烧药后体温随时间变化的曲线，这是现代药物研发和定量药理学的核心技术。", "problem": "一名开发人员的任务是实现一个定量模型，该模型将口服退烧药剂量与中枢环氧合酶 (COX) 抑制以及由此导致的发热期间下丘脑体温调节设定点 $T_{\\text{set}}(t)$ 的降低联系起来。该模型必须根据适用于传染病中药代动力学-药效动力学 (PK-PD) 和发热生理学的基本原理推导得出。开发人员必须使用质量平衡常微分方程和一个经过充分测试的抑制性最大效应模型来表示从药物吸收到中枢效应以及体温设定点调节的链条。\n\n基于以下广为接受的基础进行推导和实现：\n- 药物从胃肠道室到中央血浆室的一级吸收。\n- 具有线性消除的单室分布。\n- 通过与血浆浓度的一级平衡来表示的效应部位（生物相）动力学。\n- 一个抑制性最大效应模型，将效应部位浓度与 COX 抑制分数联系起来，代表中枢神经系统 (CNS) 中前列腺素 E$_2$ (PGE$_2$) 合成的减少，从而调节发热设定点。\n\n定义以下变量和参数：\n- $A_g(t)$，单位 $\\mathrm{mg}$：胃肠道室中的药物量。\n- $A_c(t)$，单位 $\\mathrm{mg}$：中央室中的药物量。\n- $C_p(t) = A_c(t)/V$，单位 $\\mathrm{mg/L}$：血浆浓度，其中 $V$（单位 $\\mathrm{L}$）是分布容积。\n- $C_e(t)$，单位 $\\mathrm{mg/L}$：效应部位浓度。\n- $k_a$，单位 $\\mathrm{h^{-1}}$：一级吸收速率常数。\n- $CL$，单位 $\\mathrm{L/h}$：清除率，其中 $k_{\\mathrm{el}} = CL/V$（单位 $\\mathrm{h^{-1}}$）是消除速率常数。\n- $k_{e0}$，单位 $\\mathrm{h^{-1}}$：效应部位平衡速率常数。\n- $I_{\\max}$，无量纲单位：COX 的最大抑制分数。\n- $IC_{50}$，单位 $\\mathrm{mg/L}$：半最大抑制浓度。\n- $\\gamma$，无量纲单位：抑制关系的希尔系数（斜率）。\n- $T_{\\mathrm{pyrogen}}$，单位 $\\mathrm{^{\\circ}C}$：无药物情况下的发热设定点。\n- $\\Delta T_{\\max}$，单位 $\\mathrm{^{\\circ}C}$：在完全 COX 抑制下可实现的设定点最大下降值。\n- $D$，单位 $\\mathrm{mg}$：口服剂量，初始条件为 $A_g(0) = D$, $A_c(0) = 0$, $C_e(0) = 0$。\n\n构建系统方程：\n- 胃肠道室：$$\\frac{dA_g(t)}{dt} = -k_a A_g(t).$$\n- 中央室：$$\\frac{dA_c(t)}{dt} = k_a A_g(t) - k_{\\mathrm{el}} A_c(t), \\quad k_{\\mathrm{el}} = \\frac{CL}{V}, \\quad C_p(t) = \\frac{A_c(t)}{V}.$$\n- 效应部位生物相：$$\\frac{dC_e(t)}{dt} = k_{e0}\\left(C_p(t) - C_e(t)\\right).$$\n- COX 抑制分数：$$I_{\\mathrm{COX}}(t) = I_{\\max}\\,\\frac{C_e(t)^{\\gamma}}{IC_{50}^{\\gamma} + C_e(t)^{\\gamma}}.$$\n- 发热设定点调节：$$T_{\\mathrm{set}}(t) = T_{\\mathrm{pyrogen}} - \\Delta T_{\\max}\\, I_{\\mathrm{COX}}(t).$$\n\n在指定的时间范围 $[0, t_{\\max}]$（单位 $\\mathrm{h}$）内，使用足够密集的评估网格实现上述系统的数值求解器，以估计该窗口内的最小设定点。对于每个参数集，计算在 $t \\in [0, t_{\\max}]$ 内 $T_{\\mathrm{set}}(t)$ 的最小值，并以摄氏度为单位报告。\n\n使用的单位：\n- 剂量 $D$，单位 $\\mathrm{mg}$。\n- 容积 $V$，单位 $\\mathrm{L}$。\n- 清除率 $CL$，单位 $\\mathrm{L/h}$。\n- 速率常数 $k_a$, $k_{\\mathrm{el}}$, $k_{e0}$，单位 $\\mathrm{h^{-1}}$。\n- 浓度 $C_p$, $C_e$, $IC_{50}$，单位 $\\mathrm{mg/L}$。\n- 温度 $T_{\\mathrm{set}}$, $T_{\\mathrm{pyrogen}}$, $\\Delta T_{\\max}$，单位 $\\mathrm{^{\\circ}C}$。\n- 时间 $t$, $t_{\\max}$，单位 $\\mathrm{h}$。\n\n测试套件规范，参数科学上合理且自洽：\n- 情况 1（一般情况，中等剂量和典型动力学）：$D = 500$, $k_a = 1.2$, $V = 50$, $CL = 4.5$, $k_{e0} = 0.6$, $I_{\\max} = 0.9$, $IC_{50} = 6$, $\\gamma = 1.5$, $\\Delta T_{\\max} = 2.0$, $T_{\\mathrm{pyrogen}} = 39.0$, $t_{\\max} = 8.0$。\n- 情况 2（边界情况：零剂量）：$D = 0$, $k_a = 1.2$, $V = 50$, $CL = 4.5$, $k_{e0} = 0.6$, $I_{\\max} = 0.9$, $IC_{50} = 6$, $\\gamma = 1.5$, $\\Delta T_{\\max} = 2.0$, $T_{\\mathrm{pyrogen}} = 39.0$, $t_{\\max} = 8.0$。\n- 情况 3（边缘情况：高剂量接近抑制饱和）：$D = 1000$, $k_a = 1.2$, $V = 50$, $CL = 4.5$, $k_{e0} = 0.6$, $I_{\\max} = 0.9$, $IC_{50} = 6$, $\\gamma = 1.5$, $\\Delta T_{\\max} = 2.0$, $T_{\\mathrm{pyrogen}} = 39.0$, $t_{\\max} = 8.0$。\n- 情况 4（慢吸收和慢效应部位周转，伴有更高热度和改变的处置）：$D = 500$, $k_a = 0.2$, $V = 60$, $CL = 6.0$, $k_{e0} = 0.2$, $I_{\\max} = 0.95$, $IC_{50} = 8.0$, $\\gamma = 1.0$, $\\Delta T_{\\max} = 2.5$, $T_{\\mathrm{pyrogen}} = 39.5$, $t_{\\max} = 10.0$。\n\n答案规范：\n- 对于每种情况，计算一个等于 $\\min_{t \\in [0, t_{\\max}]} T_{\\mathrm{set}}(t)$ 的浮点数，单位为 $\\mathrm{^{\\circ}C}$。\n- 将每个浮点数四舍五入到 3 位小数。\n- 您的程序应生成单行输出，其中包含按情况 1 到 4 的顺序排列的结果，格式为逗号分隔的列表，并用方括号括起来，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是情况 $i$ 的四舍五入后的最小 $T_{\\mathrm{set}}$ 值。", "solution": "该问题陈述经过严格验证，被认为是科学可靠、问题明确、客观且完整的。它描述了一个标准的口服退烧药的房室药代动力学-药效动力学 (PK-PD) 模型，该模型被表述为常微分方程 (ODE) 和代数关系的系统。任务是为几个参数集数值求解该系统，并确定预测的下丘脑体温调节设定点的最小值。\n\n该模型描述了药物从初始口服剂量 $D$ 开始，通过各个生理房室直至其最终效应的进程。系统在任何时间 $t$ 的状态可以通过一个状态向量 $\\mathbf{y}(t)$ 来描述，该向量包含胃肠道中的药物量 $A_g(t)$、中央（血浆）室中的药物量 $A_c(t)$ 以及作用部位（效应部位）的药物浓度 $C_e(t)$。我们将状态向量定义为 $\\mathbf{y}(t) = [y_0(t), y_1(t), y_2(t)]^T = [A_g(t), A_c(t), C_e(t)]^T$。\n\n系统的动力学由一组三个耦合的一阶 ODE 控制：\n$$\n\\frac{d\\mathbf{y}(t)}{dt} = f(t, \\mathbf{y}(t))\n$$\n该系统的显式形式从问题陈述中推导得出：\n1. 胃肠道吸收：药物在肠道中量 $A_g$ 的变化率被建模为具有速率常数 $k_a$ 的一级过程。\n$$\n\\frac{dy_0(t)}{dt} = -k_a y_0(t)\n$$\n2. 中央室动力学：药物从肠道进入中央室，并从中消除。消除速率常数为 $k_{\\mathrm{el}} = CL/V$。\n$$\n\\frac{dy_1(t)}{dt} = k_a y_0(t) - k_{\\mathrm{el}} y_1(t)\n$$\n3. 效应部位平衡：效应部位浓度 $C_e$ 与血浆浓度 $C_p = A_c/V = y_1/V$ 平衡，由速率常数 $k_{e0}$ 控制。\n$$\n\\frac{dy_2(t)}{dt} = k_{e0}\\left(\\frac{y_1(t)}{V} - y_2(t)\\right)\n$$\n\n在时间 $t=0$ 时的初始条件由向空系统中口服剂量 $D$ 给出：\n$$\n\\mathbf{y}(0) = [A_g(0), A_c(0), C_e(0)]^T = [D, 0, 0]^T\n$$\n请注意，对于第三个分量，初始条件是 $C_e(0)=0$。\n\n这个具有常系数的线性 ODE 系统可以进行数值求解。我们将使用一个标准的数值积分程序，特别是 `scipy.integrate.solve_ivp`，来获得在指定时间区间 $[0, t_{\\max}]$ 内 $\\mathbf{y}(t)$ 的解。将使用一个密集的评估点网格来精确捕捉浓度的时间过程。\n\n一旦确定了随时间变化的效应部位浓度 $C_e(t) = y_2(t)$，就可以计算药效学效应。环氧合酶 (COX) 的抑制分数 $I_{\\mathrm{COX}}(t)$ 由抑制性最大效应模型（希尔方程的一种形式）描述：\n$$\nI_{\\mathrm{COX}}(t) = I_{\\max}\\,\\frac{C_e(t)^{\\gamma}}{IC_{50}^{\\gamma} + C_e(t)^{\\gamma}}\n$$\n该抑制分数直接减少由致热原引起的下丘脑体温调节设定点 $T_{\\mathrm{set}}(t)$ 的升高。该关系由下式给出：\n$$\nT_{\\mathrm{set}}(t) = T_{\\mathrm{pyrogen}} - \\Delta T_{\\max}\\, I_{\\mathrm{COX}}(t)\n$$\n其中 $T_{\\mathrm{pyrogen}}$ 是无药物时的发热设定点，$\\Delta T_{\\max}$ 是设定点可能的最大降低值。\n\n目标是为每个测试用例找到在时间范围内的 $T_{\\mathrm{set}}(t)$ 的最小值：\n$$\nT_{\\mathrm{set,min}} = \\min_{t \\in [0, t_{\\max}]} T_{\\mathrm{set}}(t)\n$$\n由于当 $I_{\\mathrm{COX}}(t)$ 最大化时，$T_{\\mathrm{set}}(t)$ 被最小化，而 $I_{\\mathrm{COX}}(t)$ 是 $C_e(t)$ 的单调递增函数，因此最小设定点温度对应于效应部位浓度达到峰值的时间。\n\n每个测试用例的算法如下：\n1.  定义所有模型参数（$k_a, V, CL, k_{e0}, I_{\\max}, IC_{50}, \\gamma, \\Delta T_{\\max}, T_{\\mathrm{pyrogen}}$）和初始条件（剂量 $D$）。计算导出参数 $k_{\\mathrm{el}} = CL/V$。\n2.  根据 ODE 系统定义计算导数 $d\\mathbf{y}/dt$ 的函数。\n3.  使用 `scipy.integrate.solve_ivp` 求解从 $t=0$ 到 $t=t_{\\max}$ 的 $\\mathbf{y}(t)$ 的初值问题。解在一组密集的时间点上进行评估，以构建 $C_e(t)$ 的精确剖面。\n4.  使用 $C_e(t)$ 的数值解，计算相应的 $I_{\\mathrm{COX}}(t)$ 值，并随后计算 $T_{\\mathrm{set}}(t)$。\n5.  找到计算出的 $T_{\\mathrm{set}}(t)$ 数组的最小值。\n6.  $D=0$ 的情况 2 作为基线检查。在没有给药的情况下，$A_g(t)$、$A_c(t)$ 和 $C_e(t)$ 在所有时间 $t$ 都必须保持为零。因此，$I_{\\mathrm{COX}}(t)=0$，并且 $T_{\\mathrm{set}}(t)$ 保持在 $T_{\\mathrm{pyrogen}}$ 不变。因此，最小值就是 $T_{\\mathrm{pyrogen}}$。\n\n此过程将针对问题陈述中提供的所有四个测试用例实施，并按规定报告结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the PK-PD model for an antipyretic drug for four test cases\n    and computes the minimum hypothalamic thermoregulatory set-point.\n    \"\"\"\n    \n    # Test suite specification\n    test_cases = [\n        # Case 1: (D, ka, V, CL, ke0, I_max, IC50, gamma, delta_T_max, T_pyrogen, t_max)\n        (500.0, 1.2, 50.0, 4.5, 0.6, 0.9, 6.0, 1.5, 2.0, 39.0, 8.0),\n        # Case 2: Zero dose boundary case\n        (0.0, 1.2, 50.0, 4.5, 0.6, 0.9, 6.0, 1.5, 2.0, 39.0, 8.0),\n        # Case 3: High dose edge case\n        (1000.0, 1.2, 50.0, 4.5, 0.6, 0.9, 6.0, 1.5, 2.0, 39.0, 8.0),\n        # Case 4: Slow kinetics and altered disposition\n        (500.0, 0.2, 60.0, 6.0, 0.2, 0.95, 8.0, 1.0, 2.5, 39.5, 10.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters for the current case\n        D, ka, V, CL, ke0, I_max, IC50, gamma, delta_T_max, T_pyrogen, t_max = case\n\n        # Derived parameter\n        kel = CL / V\n\n        # Initial conditions for the state vector y = [Ag, Ac, Ce]\n        y0 = [D, 0.0, 0.0]\n\n        # Define the system of ODEs\n        def pkpd_model(t, y, ka_p, kel_p, ke0_p, V_p):\n            \"\"\"\n            Defines the ODE system for the PK model.\n            y[0] = Ag (amount in GI)\n            y[1] = Ac (amount in central compartment)\n            y[2] = Ce (concentration in effect site)\n            \"\"\"\n            Ag, Ac, Ce = y\n            \n            # Plasma concentration\n            Cp = Ac / V_p\n            \n            # Differentials\n            dAg_dt = -ka_p * Ag\n            dAc_dt = ka_p * Ag - kel_p * Ac\n            dCe_dt = ke0_p * (Cp - Ce)\n            \n            return [dAg_dt, dAc_dt, dCe_dt]\n\n        # Time span for the integration\n        t_span = [0, t_max]\n        \n        # A dense grid for evaluation to find the minimum accurately\n        t_eval = np.linspace(t_span[0], t_span[1], 1001)\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=lambda t, y: pkpd_model(t, y, ka, kel, ke0, V),\n            t_span=t_span,\n            y0=y0,\n            t_eval=t_eval,\n            method='RK45'\n        )\n\n        # Extract the effect-site concentration from the solution\n        Ce_t = sol.y[2]\n\n        # Calculate fractional COX inhibition\n        # Avoid division by zero if IC50 is 0, though not in test cases\n        # Also handle Ce_t  0 due to numerical error by clipping\n        Ce_t_positive = np.maximum(0, Ce_t)\n        I_cox_t = I_max * (Ce_t_positive**gamma) / (IC50**gamma + Ce_t_positive**gamma)\n        \n        # Calculate the thermoregulatory set-point over time\n        T_set_t = T_pyrogen - delta_T_max * I_cox_t\n        \n        # Find the minimum set-point temperature\n        min_T_set = np.min(T_set_t)\n        \n        # Append the rounded result\n        results.append(round(min_T_set, 3))\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "4643000"}]}