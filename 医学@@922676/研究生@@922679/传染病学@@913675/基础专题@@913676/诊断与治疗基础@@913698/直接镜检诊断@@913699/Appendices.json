{"hands_on_practices": [{"introduction": "显微镜下所见之物，很大程度上取决于样本的制备方式。为了提高稀有病原体的检出率，临床上常采用离心等浓缩步骤来增加其密度，但这些过程并非百分之百有效。本练习将通过建立一个质量平衡模型来量化样本浓缩过程，并理解其中的效率和损失，从而揭示样本前处理对最终诊断结果的关键影响。[@problem_id:4638252]", "problem": "一个临床微生物学实验室使用离心法浓缩样本以进行直接镜检。考虑一个痰样本，其初始微生物浓度为 $c_0$ (微生物/毫升)，体积为 $V_0$。沉淀步骤将比例为 $s$ 的微生物移入沉淀物中；在倾析和转移过程中，比例为 $l$ 的沉淀微生物会丢失。然后将沉淀物重悬至最终体积 $V_f$。从微生物数量守恒出发，且不假设微生物的产生或消亡，推导最终微生物浓度 $c_f$ 关于 $c_0$、$V_0$、$s$、$l$ 和 $V_f$ 的表达式。\n\n将您的表达式应用于以下用于直接镜检制备的实际参数：$V_0 = 10\\,\\mathrm{mL}$，$c_0 = 3.6 \\times 10^{4}\\,\\mathrm{微生物/mL}$，$s = 0.93$，$l = 0.08$，以及 $V_f = 0.2\\,\\mathrm{mL}$。计算 $c_f$ 并以 微生物/毫升 表示。将您的答案四舍五入到四位有效数字。", "solution": "所依据的基本原理是微生物数量守恒，这是一个质量平衡原理，即在没有增殖、死亡或外部添加的情况下，微生物的数量在整个处理步骤中是守恒的。\n\n令 $N_0$ 表示样本中初始的微生物总数。根据定义，\n$$\nN_0 = c_0 V_0.\n$$\n离心将这些微生物中比例为 $s$ 的部分移入沉淀物中。离心后沉淀物中微生物的数量是\n$$\nN_{\\mathrm{pellet,\\,pre}} = s N_0.\n$$\n在倾析和转移过程中，比例为 $l$ 的沉淀微生物丢失，因此保留在沉淀物中并最终被重悬的微生物数量是\n$$\nN_{\\mathrm{final}} = (1 - l) N_{\\mathrm{pellet,\\,pre}} = (1 - l) s N_0 = s (1 - l) c_0 V_0.\n$$\n在重悬至最终体积 $V_f$ 后，最终微生物浓度 $c_f$ 是微生物数量除以最终体积：\n$$\nc_f = \\frac{N_{\\mathrm{final}}}{V_f} = \\frac{s (1 - l) c_0 V_0}{V_f}.\n$$\n\n该表达式显示了样本浓缩如何通过体积减小因子 $\\frac{V_0}{V_f}$ 增加微生物密度，并受到回收因子 $s(1 - l)$ 的调节。\n\n代入给定的数值：$V_0 = 10\\,\\mathrm{mL}$，$c_0 = 3.6 \\times 10^{4}\\,\\mathrm{微生物/mL}$，$s = 0.93$，$l = 0.08$，以及 $V_f = 0.2\\,\\mathrm{mL}$：\n$$\nc_f = \\frac{0.93 \\times (1 - 0.08) \\times \\left(3.6 \\times 10^{4}\\right) \\times 10}{0.2}.\n$$\n计算回收因子：\n$$\ns(1 - l) = 0.93 \\times 0.92 = 0.8556.\n$$\n计算分子：\n$$\n\\left(3.6 \\times 10^{4}\\right) \\times 10 \\times 0.8556 = \\left(3.6 \\times 10^{5}\\right) \\times 0.8556 = 3.08016 \\times 10^{5}.\n$$\n除以最终体积：\n$$\nc_f = \\frac{3.08016 \\times 10^{5}}{0.2} = 1.54008 \\times 10^{6}.\n$$\n四舍五入到四位有效数字，最终浓度为\n$$\nc_f \\approx 1.540 \\times 10^{6}\\ \\text{微生物/mL}.\n$$", "answer": "$$\\boxed{1.540 \\times 10^{6}}$$", "id": "4638252"}, {"introduction": "玻片制备完成后，一个核心的实践问题是：需要检查多少个视野才能有信心地报告阴性结果？这并非一个随意的决定。本练习将应用泊松分布——一种描述稀有事件的经典概率模型——来科学地回答这个问题，定量计算出为达到特定诊断置信度所需检查的最少视野数，从而为制定或理解实验室操作规程提供理论依据。[@problem_id:4638237]", "problem": "在传染病诊断的直接镜检中（例如，痰液中抗酸杆菌（AFB）的抗酸染色），当微生物稀少且随机分布时，每个独立视野下观察到的微生物计数通常被建模为泊松过程。假设每个扫描的视野产生的微生物计数是一个独立的泊松随机变量，每个视野的平均值为 $\\lambda$ 个微生物。如果在所有扫描的视野中总共观察到至少一个微生物，则诊断检查结果为阳性。仅从泊松分布的定义和标准性质以及视野间独立的假设出发，推导检测概率作为扫描视野数 $n$ 和每个视野平均值 $\\lambda$ 的函数的解析表达式。然后，使用您推导的表达式，确定当每个视野的平均值为 $\\lambda = 0.05$ 个微生物时，为达到至少 $0.95$ 的检测概率所需的最小整数视野数 $n$。将您的最终答案报告为满足该标准的最小整数 $n$。不要四舍五入；选择能达到至少 $0.95$ 检测概率的最小整数。", "solution": "问题陈述已经过严格验证，被认为是有效的。它有科学依据、提法得当、客观，并包含一套完整且一致的给定条件。使用泊松分布来建模稀有、独立的事件是生物统计学及相关领域的标准且合适的方法。\n\n设 $n$ 为扫描的视野总数。\n设 $\\lambda$ 为每个视野的平均微生物数。\n设 $X_i$ 为表示在第 $i$ 个视野中计数的微生物数量的随机变量，其中 $i = 1, 2, \\ldots, n$。\n\n根据问题陈述，每个 $X_i$ 是一个服从均值为 $\\lambda$ 的泊松分布的独立随机变量。$X_i$ 的概率质量函数 (PMF) 由下式给出：\n$$P(X_i = k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n其中 $k = 0, 1, 2, \\ldots$。\n\n如果在所有 $n$ 个扫描的视野中观察到至少一个微生物，则诊断检查为阳性。设 $P_D$ 为检测概率。这是微生物总数 $Y = \\sum_{i=1}^{n} X_i$ 大于或等于 $1$ 的概率。\n$$P_D = P(Y \\ge 1)$$\n\n计算其互补事件的概率更为简便，即在所有 $n$ 个视野中均未观察到微生物。检测概率则为 $1$ 减去该互补事件的概率。\n$$P_D = 1 - P(Y = 0)$$\n\n事件 $Y=0$ 发生当且仅当对于所有 $i=1, 2, \\ldots, n$，都有 $X_i = 0$。\n$$P(Y = 0) = P(X_1=0 \\text{ and } X_2=0 \\text{ and } \\ldots \\text{ and } X_n=0)$$\n\n由于随机变量 $X_i$ 是独立的，它们联合发生的概率是它们各自概率的乘积：\n$$P(Y = 0) = P(X_1=0) \\times P(X_2=0) \\times \\ldots \\times P(X_n=0) = \\prod_{i=1}^{n} P(X_i=0)$$\n\n对于任何给定的视野 $i$，观察到零个微生物的概率可以通过在泊松 PMF 中设置 $k=0$ 来求得：\n$$P(X_i = 0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda)$$\n\n将此代回 $P(Y=0)$ 的表达式中：\n$$P(Y = 0) = \\prod_{i=1}^{n} \\exp(-\\lambda) = (\\exp(-\\lambda))^n = \\exp(-n\\lambda)$$\n\n因此，检测概率 $P_D$ 作为 $n$ 和 $\\lambda$ 的函数的解析表达式为：\n$$P_D(n, \\lambda) = 1 - P(Y = 0) = 1 - \\exp(-n\\lambda)$$\n\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须找到当每个视野的平均计数为 $\\lambda = 0.05$ 时，为达到至少 $0.95$ 的检测概率所需的最小整数视野数 $n$。\n我们建立不等式：\n$$P_D(n, 0.05) \\ge 0.95$$\n$$1 - \\exp(-n \\cdot 0.05) \\ge 0.95$$\n\n为了解出 $n$，我们整理不等式：\n$$1 - 0.95 \\ge \\exp(-0.05n)$$\n$$0.05 \\ge \\exp(-0.05n)$$\n\n接下来，我们对两边取自然对数。由于自然对数函数 $\\ln(x)$ 对于 $x>0$ 是单调递增的，因此不等式的方向保持不变。\n$$\\ln(0.05) \\ge \\ln(\\exp(-0.05n))$$\n$$\\ln(0.05) \\ge -0.05n$$\n\n为了分离出 $n$，我们两边同除以 $-0.05$。除以一个负数会反转不等式的方向：\n$$n \\ge \\frac{\\ln(0.05)}{-0.05}$$\n我们可以使用性质 $\\ln(x) = -\\ln(1/x)$ 来简化右边的表达式：\n$$n \\ge \\frac{-\\ln(1/0.05)}{-0.05} = \\frac{\\ln(20)}{0.05}$$\n数值上，$\\ln(20) \\approx 2.99573227$。\n$$n \\ge \\frac{2.99573227}{0.05}$$\n$$n \\ge 59.9146454$$\n\n问题要求最小的*整数*视野数。由于 $n$ 必须是整数，我们必须找到大于或等于 $59.9146454$ 的最小整数。这个整数是 $60$。\n\n为了验证，我们可以检查 $n=59$ 和 $n=60$ 时的检测概率：\n对于 $n=59$：$P_D = 1 - \\exp(-59 \\times 0.05) = 1 - \\exp(-2.95) \\approx 1 - 0.05234 = 0.94766$，该值小于 $0.95$。\n对于 $n=60$：$P_D = 1 - \\exp(-60 \\times 0.05) = 1 - \\exp(-3.0) \\approx 1 - 0.04979 = 0.95021$，该值大于或等于 $0.95$。\n\n因此，所需的最小整数视野数是 $60$。", "answer": "$$\\boxed{60}$$", "id": "4638237"}, {"introduction": "在完成一次诊断测试后，我们必须评估其相对于“金标准”方法的性能。本练习将介绍评估诊断测试性能的三个核心指标：灵敏度、特异度和准确度。通过分析一个假设的临床数据集，你将学会如何计算这些关键指标，从而能够客观地评价直接显微镜检查在特定临床场景下的可靠性和价值。[@problem_id:4638228]", "problem": "在传染病的临床微生物学背景下，使用Ziehl–Neelsen染色法对痰涂片进行直接镜检以检测抗酸杆菌（AFB）的性能，将与培养或聚合酶链式反应（PCR）这一参考标准进行比较评估。设二元疾病状态为 $D$（感染存在）和 $\\bar{D}$（感染不存在），检测结果为 $T^{+}$（涂片阳性）和 $T^{-}$（涂片阴性）。使用条件概率的基本定义和事件划分的概念，用 $D$、$\\bar{D}$、$T^{+}$ 和 $T^{-}$ 来定义直接镜检的灵敏度、特异度和准确度。然后，根据以下数据集计算这些指标：\n- 有 $100$ 名真正感染的个体 ($D$)。\n- 在 $D$ 个体中，直接镜检产生 $80$ 例涂片阳性 ($T^{+}$) 和 $20$ 例涂片阴性 ($T^{-}$)。\n- 有 $150$ 名真正未感染的个体 ($\\bar{D}$)。\n- 在 $\\bar{D}$ 个体中，直接镜检产生 $10$ 例涂片阳性 ($T^{+}$)，其余为涂片阴性 ($T^{-}$)。\n\n将灵敏度、特异度和准确度均表示为小数，并将答案四舍五入到四位有效数字。无需单位。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n-   二元疾病状态用 $D$ 表示感染存在，用 $\\bar{D}$ 表示感染不存在。\n-   二元检测结果用 $T^{+}$ 表示涂片阳性，用 $T^{-}$ 表示涂片阴性。\n-   任务是用 $D$、$\\bar{D}$、$T^{+}$ 和 $T^{-}$ 来定义灵敏度、特异度和准确度。\n-   任务是根据给定的数据集计算这些指标。\n-   数据集：\n    -   处于状态 $D$ 的个体数：$N(D) = 100$。\n    -   在状态 $D$ 的个体中，结果为 $T^{+}$ 的个体数：$N(T^{+} \\cap D) = 80$。\n    -   在状态 $D$ 的个体中，结果为 $T^{-}$ 的个体数：$N(T^{-} \\cap D) = 20$。\n    -   处于状态 $\\bar{D}$ 的个体数：$N(\\bar{D}) = 150$。\n    -   在状态 $\\bar{D}$ 的个体中，结果为 $T^{+}$ 的个体数：$N(T^{+} \\cap \\bar{D}) = 10$。\n    -   在状态 $\\bar{D}$ 的个体中，结果为 $T^{-}$ 的个体数：余下的部分，即 $N(\\bar{D}) - N(T^{+} \\cap \\bar{D})$。\n-   输出格式：将灵敏度、特异度和准确度表示为小数，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是生物统计学和流行病学中的一个标准应用，用于评估一种诊断测试（用于检测AFB的Ziehl–Neelsen染色法）相对于金标准（培养或PCR）的性能。灵敏度、特异度和准确度的概念是基础性的，并且表述正确。该背景在科学上是有效的。\n-   **适定性**：该问题是适定的。它提供了定义和计算所需指标的所有必要数据。要求是明确的。\n-   **客观性**：问题以精确、客观的语言陈述，不含主观因素。\n-   **完整性与一致性**：所提供的数据是自洽的。对于患病组，$N(T^{+} \\cap D) + N(T^{-} \\cap D) = 80 + 20 = 100$，等于 $N(D)$。对于非患病组，$T^{-}$ 个体的数量是隐含定义且可计算的。没有矛盾之处。\n\n### 步骤3：结论与行动\n问题有效。将提供解决方案。\n\n### 解\n\n诊断测试的性能由其正确识别患病和未患病个体的能力来表征。这些特征通过条件概率进行形式化定义，而条件概率则通过样本计数来估计。样本空间由疾病状态 $\\{D, \\bar{D}\\}$ 和测试结果 $\\{T^{+}, T^{-}\\}$ 进行划分。\n\n首先，我们根据条件概率的原理建立灵敏度、特异度和准确度的定义。给定事件 $B$ 的情况下事件 $A$ 发生的概率是 $P(A|B) = \\frac{P(A \\cap B)}{P(B)}$。在当前的频率学派语境中，我们使用每个类别中的个体数量 $N$ 来估计这些概率。\n\n1.  **灵敏度**：灵敏度是指在个体确实感染的情况下，测试结果为阳性的概率。它衡量测试正确识别患病者的能力。\n    $$\n    \\text{灵敏度} = P(T^{+} | D) = \\frac{N(T^{+} \\cap D)}{N(D)}\n    $$\n    项 $N(T^{+} \\cap D)$ 代表真阳性（$TP$）的数量，$N(D)$ 是感染个体的总数，即真阳性（$TP$）和假阴性（$FN$）之和，其中 $FN = N(T^{-} \\cap D)$。因此，\n    $$\n    \\text{灵敏度} = \\frac{TP}{TP + FN}\n    $$\n\n2.  **特异度**：特异度是指在个体确实未感染的情况下，测试结果为阴性的概率。它衡量测试正确识别未患病者的能力。\n    $$\n    \\text{特异度} = P(T^{-} | \\bar{D}) = \\frac{N(T^{-} \\cap \\bar{D})}{N(\\bar{D})}\n    $$\n    项 $N(T^{-} \\cap \\bar{D})$ 代表真阴性（$TN$）的数量，$N(\\bar{D})$ 是未感染个体的总数，即真阴性（$TN$）和假阳性（$FP$）之和，其中 $FP = N(T^{+} \\cap \\bar{D})$。因此，\n    $$\n    \\text{特异度} = \\frac{TN}{TN + FP}\n    $$\n\n3.  **准确度**：准确度是指对于从总体中随机选择的任何个体，测试给出正确结果的总体概率。正确的结果是真阳性或真阴性。\n    $$\n    \\text{准确度} = \\frac{N(\\text{正确结果})}{N(\\text{总人口})} = \\frac{N(T^{+} \\cap D) + N(T^{-} \\cap \\bar{D})}{N(D) + N(\\bar{D})}\n    $$\n    用 $TP$、$TN$、$FP$ 和 $FN$ 表示为：\n    $$\n    \\text{准确度} = \\frac{TP + TN}{TP + TN + FP + FN}\n    $$\n\n接下来，我们使用所提供的数据计算这些指标。我们首先将数据整理成一个列联表。\n\n根据已知条件：\n-   真阳性（$TP$）：$N(T^{+} \\cap D) = 80$。\n-   假阴性（$FN$）：$N(T^{-} \\cap D) = 20$。\n-   总感染人数：$N(D) = TP + FN = 80 + 20 = 100$。这与问题陈述一致。\n-   假阳性（$FP$）：$N(T^{+} \\cap \\bar{D}) = 10$。\n-   总未感染人数：$N(\\bar{D}) = 150$。\n-   真阴性（$TN$）：$N(T^{-} \\cap \\bar{D}) = N(\\bar{D}) - N(T^{+} \\cap \\bar{D}) = 150 - 10 = 140$。\n\n总人口规模为 $N = N(D) + N(\\bar{D}) = 100 + 150 = 250$。\n\n现在我们计算这些值：\n\n**灵敏度计算**：\n$$\n\\text{灵敏度} = \\frac{TP}{TP + FN} = \\frac{80}{80 + 20} = \\frac{80}{100} = 0.8\n$$\n四舍五入到四位有效数字，结果是 $0.8000$。\n\n**特异度计算**：\n$$\n\\text{特异度} = \\frac{TN}{TN + FP} = \\frac{140}{140 + 10} = \\frac{140}{150} = \\frac{14}{15}\n$$\n作为小数，$\\frac{14}{15} \\approx 0.933333...$。四舍五入到四位有效数字得到 $0.9333$。\n\n**准确度计算**：\n$$\n\\text{准确度} = \\frac{TP + TN}{TP + TN + FP + FN} = \\frac{80 + 140}{100 + 150} = \\frac{220}{250} = \\frac{22}{25} = 0.88\n$$\n四舍五入到四位有效数字，结果是 $0.8800$。\n\n计算出的指标是：灵敏度 = $0.8000$，特异度 = $0.9333$，准确度 = $0.8800$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8000  0.9333  0.8800\n\\end{pmatrix}\n}\n$$", "id": "4638228"}]}