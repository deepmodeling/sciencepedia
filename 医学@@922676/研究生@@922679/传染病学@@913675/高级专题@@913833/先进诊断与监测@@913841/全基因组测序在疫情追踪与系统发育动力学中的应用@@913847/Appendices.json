{"hands_on_practices": [{"introduction": "病毒在宿主间传播并非传递整个病毒群体，而是通过一个随机抽样的少数病毒颗粒，这一过程被称为传播瓶颈。本练习将引导你运用基本的概率论原理，将瓶颈过程建模为二项分布抽样，从而计算一个低频变异成功传播的概率。掌握这一基础计算是理解系统发育动力学中遗传漂变和变异筛选的关键第一步。[@problem_id:4707057]", "problem": "在一次急性病毒爆发中，一个供体携带一种宿主内单核苷酸变异（iSNV），在传染性病毒粒子中的频率为 $f = 0.1$。在传播过程中，受体的感染由一个大小为 $b = 3$ 的紧密瓶颈引发，这意味着恰好有 $b$ 个病毒粒子建立了新的感染。假设在传染病的系统动力学和全基因组测序（WGS）中，采用以下经验上成立且广泛使用的模型假设：供体病毒种群数量庞大，因此病毒粒子可以被视为独立同分布的；每个病毒粒子独立地以概率 $f$ 携带该iSNV；瓶颈是从供体种群中简单随机抽取的 $b$ 个病毒粒子样本。将“iSNV传播”定义为 $b$ 个创始病毒粒子中至少有一个携带该iSNV的事件。从概率论的核心公理和独立伯努利试验的定义出发，推导在这些假设下iSNV被传播的概率，然后计算当 $f=0.1$ 和 $b=3$ 时的具体数值。将最终概率表示为小数，并四舍五入到四位有效数字。", "solution": "首先验证问题，以确保其科学上成立、定义明确且客观。\n\n### 步骤 1: 提取已知条件\n-   供体中宿主内单核苷酸变异（iSNV）的频率: $f = 0.1$。\n-   传播瓶颈的大小: $b = 3$。\n-   假设 1: 供体病毒种群数量庞大。\n-   假设 2: 病毒粒子是独立同分布的 (i.i.d.)。\n-   假设 3: 每个病毒粒子独立地以概率 $f$ 携带该iSNV。\n-   假设 4: 瓶颈是一个由 $b$ 个病毒粒子组成的简单随机样本。\n-   定义: “iSNV传播”是 $b$ 个创始病毒粒子中至少有一个携带该iSNV的事件。\n\n### 步骤 2: 使用提取的已知条件进行验证\n问题陈述描述了病毒系统动力学和群体遗传学中的一个标准和基础模型，特别是通过种群瓶颈的遗传漂变过程。\n-   **科学上成立:** 该模型是研究病毒进化和传播的基石。使用二项抽样过程来模拟传播瓶颈是一种被广泛接受且有经验支持的简化方法。给定的参数（$f=0.1$, $b=3$）对于急性病毒感染是符合实际的。该问题不含伪科学。\n-   **定义明确:** 所有必要的变量（$f$, $b$）、假设（独立同分布的伯努利试验）和定义（“iSNV传播”）都已明确给出。问题是自洽的，并且其结构能够得出一个唯一的、有意义的解。\n-   **客观:** 问题以精确、正式的语言陈述，不含任何主观或基于观点的内容。\n\n### 步骤 3: 结论与行动\n该问题被认为是有效的，因为它科学上成立、定义明确且客观。将推导解答。\n\n### 推导\n问题要求从概率论的核心公理和独立伯努利试验的定义出发，推导iSNV传播的概率。\n\n设 $T$ 为iSNV被传播的事件。根据定义，这意味着建立新感染的 $b$ 个病毒粒子中至少有一个携带该iSNV。\n\n直接计算 $T$ 的概率需要将恰好有1个病毒粒子携带iSNV的概率、恰好有2个病毒粒子携带iSNV的概率，...，一直到恰好有 $b$ 个病毒粒子携带iSNV的概率相加。一个更直接的方法是计算其补事件 $T^c$ 的概率，并利用概率公理 $P(T) = 1 - P(T^c)$。\n\n补事件 $T^c$ 是iSNV*未*被传播的事件。这当且仅当 $b$ 个创始病毒粒子中*没有一个*携带该iSNV时发生。\n\n设 $A_i$ 为瓶颈样本中第 $i$ 个病毒粒子携带iSNV的事件，其中 $i \\in \\{1, 2, \\dots, b\\}$。\n问题陈述每个病毒粒子独立地以概率 $f$ 携带iSNV。这构成了一个包含 $b$ 次独立伯努利试验的序列，其中“成功”定义为一个病毒粒子携带iSNV。\n任何一次试验成功的概率是 $P(A_i) = f$。 “失败”（病毒粒子不携带iSNV）的概率，用事件 $A_i^c$ 表示，为 $P(A_i^c) = 1 - P(A_i) = 1 - f$。\n\n事件 $T^c$（无传播）对应于所有 $b$ 个病毒粒子都未能携带iSNV。这可以表示为各个失败事件的交集：\n$$T^c = A_1^c \\cap A_2^c \\cap \\dots \\cap A_b^c$$\n因为问题陈述病毒粒子是独立的（假设3），这些事件交集的概率是它们各自概率的乘积：\n$$P(T^c) = P(A_1^c \\cap A_2^c \\cap \\dots \\cap A_b^c) = P(A_1^c) \\times P(A_2^c) \\times \\dots \\times P(A_b^c)$$\n由于这些试验是同分布的，对于所有的 $i$ 都有 $P(A_i^c) = 1 - f$。因此：\n$$P(T^c) = (1 - f) \\times (1 - f) \\times \\dots \\times (1 - f) \\quad (b \\text{ 次})$$\n$$P(T^c) = (1 - f)^b$$\n这个表达式给出了 $b$ 个病毒粒子中没有任何一个携带iSNV的概率。这个结果等同于在具有 $b$ 次试验和成功概率为 $f$ 的二项分布中获得 $k=0$ 次成功的概率，即 $P(k=0) = \\binom{b}{0} f^0 (1-f)^{b-0} = (1-f)^b$。\n\n现在，我们可以使用补集法则求出传播概率 $P(T)$：\n$$P(T) = 1 - P(T^c)$$\n$$P(T) = 1 - (1 - f)^b$$\n这就是在所述假设下，一个频率为 $f$ 的变异通过大小为 $b$ 的瓶颈进行传播的概率的通用公式。\n\n我们已知具体数值 $f = 0.1$ 和 $b = 3$。将这些值代入推导出的公式：\n$$P(T) = 1 - (1 - 0.1)^3$$\n$$P(T) = 1 - (0.9)^3$$\n计算幂：\n$$(0.9)^3 = 0.9 \\times 0.9 \\times 0.9 = 0.81 \\times 0.9 = 0.729$$\n现在，将这个值代回：\n$$P(T) = 1 - 0.729$$\n$$P(T) = 0.271$$\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。精确答案 $0.271$ 有三位有效数字。为了用四位有效数字表示，我们必须在末尾添加一个零，这个零在这种情况下是有效的。\n$$P(T) = 0.2710$$", "answer": "$$\\boxed{0.2710}$$", "id": "4707057"}, {"introduction": "利用全基因组测序追溯暴发历史，其能力取决于病毒在传播过程中是否积累了足够的可区分的基因突变。本练习模拟了一个短时暴发情景，要求你估算能够解析系统发育树分支顺序的“信息性位点”的期望数量。通过这个计算，你将深刻体会到为什么在传播速度快、持续时间短的暴发中，仅靠基因组数据往往难以精确重建传播链。[@problem_id:4706980]", "problem": "一个研究团队正在使用全基因组测序来追踪一次单倍体RNA病毒的短期暴发中的传播。在无限位点模型和可忽略的重组条件下，突变被建模为沿着时间标度系统发育树的每个分支发生的无记忆泊松点过程，其每个位点的替换率 $\\mu$ (每个位点每天的替换数) 为恒定值。在此设定下，一个位点对于解析分支顺序具有系统发育信息的条件是，当且仅当该突变发生在一个对应至少两个采样基因组的内部支上，从而使得在采样结束时，祖先等位基因和衍生等位基因均在至少两个序列中出现。\n\n考虑一个由暴发结束时采样的$12$个基因组重建的时间标度系统发育树，其内部支（每个都对应至少两个叶尖）的长度分别为$2.5$天、$1.2$天和$0.8$天。由于快速、近乎同步的采样，末端支很长，但在上述标准下，它们对系统发育信息变化没有贡献。全基因组比对长度为 $L=30{,}000$ 个位点，每个位点的替换率为 $\\mu = 1.1 \\times 10^{-6}$ 每个位点每天的替换数。\n\n仅使用上述假设和数值，估计此数据集中系统发育信息位点的期望数量。将您的答案四舍五入到三位有效数字，并将其表示为不带单位的纯数。根据您的估计值，简要解释在短期暴发中出现的解析度限制。", "solution": "该问题被评估为有效。它在科学上基于分子进化的原理，内部逻辑一致，并提供了计算所要求估计值所需的所有数据。\n\n问题要求计算一个来自病毒暴发的全基因组数据集中系统发育信息位点的期望数量。突变累积的模型是一个泊松过程。\n\n首先，我们确定给定的参数：\n- 全基因组比对长度为 $L = 30,000$ 个位点。\n- 每个位点的替换率为 $\\mu = 1.1 \\times 10^{-6}$ 每个位点每天的替换数。\n- 采样的基因组数量为 $12$ 个。\n- 问题将系统发育信息位点定义为在系统发育树的特定内部支上发生突变所产生的位点。这些分支的长度给出为 $b_1 = 2.5$ 天，$b_2 = 1.2$ 天，和 $b_3 = 0.8$ 天。\n\n沿着系统发育树任何给定分支的替换数是一个服从泊松分布的随机变量。该分布的速率参数 $\\lambda$ 是每个位点的替换率($\\mu$)、位点数($L$)和分支的时间长度($t$)的乘积。因此，长度为 $t$ 的分支上的期望替换数为 $E[S] = \\mu \\times L \\times t$。\n\n问题指出，系统发育信息位点源于仅在指定的内部支上发生的突变。在无限位点模型下，每个新突变都发生在基因组的一个独特位点上。因此，系统发育信息位点的期望数量，记为 $E[N_{\\text{inf}}]$，等于在所有指定的内部支上发生突变的期望总数。\n\n根据期望的线性性，突变的期望总数是每个独立分支上期望数量的总和。这等同于将基因组替换率($\\mu \\times L$)乘以所有相关分支的总长度。\n\n设 $T_{\\text{int}}$ 为可以发生信息性突变的内部支的总长度。\n$$T_{\\text{int}} = b_1 + b_2 + b_3$$\n代入给定值：\n$$T_{\\text{int}} = 2.5 + 1.2 + 0.8 = 4.5 \\text{ 天}$$\n\n现在，我们可以计算信息位点的期望数量，$E[N_{\\text{inf}}]$：\n$$E[N_{\\text{inf}}] = \\mu \\times L \\times T_{\\text{int}}$$\n\n代入参数的数值：\n$$E[N_{\\text{inf}}] = (1.1 \\times 10^{-6} \\text{ 位点}^{-1} \\text{天}^{-1}) \\times (30,000 \\text{ 位点}) \\times (4.5 \\text{ 天})$$\n\n首先，计算全基因组替换率 $R_G$：\n$$R_G = \\mu \\times L = (1.1 \\times 10^{-6}) \\times (3 \\times 10^4) = 3.3 \\times 10^{-2} \\text{ 每天的替换数}$$\n\n现在，乘以总内部支长度：\n$$E[N_{\\text{inf}}] = R_G \\times T_{\\text{int}} = (3.3 \\times 10^{-2}) \\times 4.5$$\n$$E[N_{\\text{inf}}] = 0.033 \\times 4.5 = 0.1485$$\n\n问题要求答案四舍五入到三位有效数字。前三位有效数字是 $1$、$4$ 和 $8$。下一位数字是 $5$，所以我们将最后一位有效数字向上进位。\n$$E[N_{\\text{inf}}] \\approx 0.149$$\n\n关于解析度限制，这个估计值提供了一个清晰的解释。系统发育信息位点的期望数量 $E[N_{\\text{inf}}]$ 约等于 $0.149$。由于这个值远小于1，它表明在这次暴发的任何一次具体实现中，极有可能观察到零个此类位点。信息位点的实际数量 $N_{\\text{inf}}$ 服从均值为 $\\lambda = 0.1485$ 的泊松分布。观察到零个信息位点的概率是：\n$$P(N_{\\text{inf}} = 0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-0.1485) \\approx 0.862$$\n这意味着大约有 $86\\%$ 的概率，该数据集将不包含任何有助于解析系统发育树内部支序的位点。系统发育解析度，即确定树拓扑结构的能力，关键性地依赖于这些信息位点。没有它们，采样基因组之间的关系就无法确定，并且得到的系统发育树是一个未解析的“星状”拓拓扑结构。在快速暴发的短内部支上累积的这种遗传变异的稀缺性，对使用基因组数据进行传播追踪的解析度构成了根本性的限制。", "answer": "$$\\boxed{0.149}$$", "id": "4706980"}, {"introduction": "在暴发调查中，我们常常需要判断两个病例之间是否存在直接传播关系。本练习提供了一个结合基因组数据（序列相同）和流行病学数据（采样时间间隔）的贝叶斯推断框架。你将学习如何使用伽马分布对连续传播间隔进行建模，并计算在给定时间间隔下，两个病例为直接传播的后验概率，这展示了在信息不完全时进行定量风险评估的强大能力。[@problem_id:4706992]", "problem": "在一次医院暴发的急性病毒感染中，全基因组测序（WGS；whole-genome sequencing）揭示了两个病例具有相同的一致性序列，采样时间相隔 $\\Delta t = 5$ 天。假设采用以下建模框架来整合基因组和流行病学时间信息以进行暴发追踪：序列间隔（从感染者出现症状到被感染者出现症状的时间）由伽马分布建模，其均值为 $m = 4$ 天，方差为 $v = 2$ 天$^{2}$。假设所有病例的采样延迟相同，因此采样时间差等于传播链上的序列间隔之和。此外，假设在给定传播链长度的情况下，链上的序列间隔是独立同分布的。鉴于在短时间内基因组序列相同，我们采用一个双假设模型，其中要么是单次直接传播（$N=1$），要么是存在一个中间宿主（$N=2$），其先验概率相等，$P(N=1) = P(N=2) = \\tfrac{1}{2}$ 且 $P(N \\ge 3) = 0$。在 $N=n$ 的假设下，$\\Delta t$ 是 $n$ 个独立序列间隔的和。在 $t=\\Delta t$ 附近的小窗口极限内，用在 $t$ 处评估的相应概率密度来近似事件概率。仅使用这些假设，并从伽马分布均值和方差的基本定义以及具有相同尺度参数的独立伽马变量的可加性出发，计算在给定 $\\Delta t = 5$ 天的情况下，这两个病例存在直接传播链的后验概率。将最终答案表示为小数，并四舍五入到四位有效数字。最终答案中不要包含任何单位。", "solution": "目标是计算在观测到样本间时间差为 $\\Delta t = 5$ 天的情况下，直接传播的后验概率 $P(N=1)$。这是一个贝叶斯推断问题，所求的量是 $P(N=1 | \\Delta t = 5)$。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$ P(N=1 | \\Delta t = 5) = \\frac{P(\\Delta t = 5 | N=1) P(N=1)}{P(\\Delta t = 5)} $$\n分母，即观测值的边际概率，可以通过全概率律对所有可能的假设求和得到：\n$$ P(\\Delta t = 5) = P(\\Delta t = 5 | N=1) P(N=1) + P(\\Delta t = 5 | N=2) P(N=2) $$\n问题陈述中说明，我们可以用在 $\\Delta t$ 附近的某个点上的概率密度函数（pdf）的值来近似该点周围小窗口内事件的概率。设 $f_n(t)$ 是在 $n$ 次传播假设下时间差 $\\Delta t$ 的概率密度函数。因此，我们可以写出 $P(\\Delta t=5 | N=n) \\propto f_n(5)$。后验概率变为：\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{f_1(5) P(N=1)}{f_1(5) P(N=1) + f_2(5) P(N=2)} $$\n给定先验概率相等，$P(N=1) = P(N=2) = \\frac{1}{2}$。代入这些值可以简化表达式：\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{f_1(5) \\cdot \\frac{1}{2}}{f_1(5) \\cdot \\frac{1}{2} + f_2(5) \\cdot \\frac{1}{2}} = \\frac{f_1(5)}{f_1(5) + f_2(5)} $$\n为了求解，我们必须首先确定概率密度函数 $f_1(t)$ 和 $f_2(t)$。\n\n首先，我们求出单个序列间隔的伽马分布参数。设单个序列间隔 $T$ 是一个服从伽马分布的随机变量，$T \\sim \\text{Gamma}(\\alpha, \\beta)$，其中形状参数 $\\alpha  0$，率参数 $\\beta  0$。其概率密度函数为 $f(t; \\alpha, \\beta) = \\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)} t^{\\alpha-1} \\exp(-\\beta t)$。该分布的均值 $m$ 和方差 $v$ 由以下公式给出：\n$$ m = E[T] = \\frac{\\alpha}{\\beta} $$\n$$ v = \\text{Var}(T) = \\frac{\\alpha}{\\beta^2} $$\n给定 $m = 4$ 天和 $v = 2$ 天$^2$。我们可以解出 $\\alpha$ 和 $\\beta$：\n$$ \\frac{m}{v} = \\frac{\\alpha/\\beta}{\\alpha/\\beta^2} = \\beta \\implies \\beta = \\frac{4}{2} = 2 $$\n使用 $\\beta=2$，我们可以求出 $\\alpha$：\n$$ \\alpha = m \\cdot \\beta = 4 \\cdot 2 = 8 $$\n所以，单个序列间隔由一个 $\\text{Gamma}(\\alpha=8, \\beta=2)$ 分布建模。\n\n在假设 $N=1$ 下，时间差 $\\Delta t$ 是单个序列间隔的持续时间。因此，$\\Delta t$ 的分布是 $\\text{Gamma}(8, 2)$，其概率密度函数 $f_1(t)$ 为：\n$$ f_1(t) = f(t; 8, 2) = \\frac{2^8}{\\Gamma(8)} t^{8-1} \\exp(-2t) = \\frac{256}{7!} t^7 \\exp(-2t) $$\n\n在假设 $N=2$ 下，$\\Delta t$ 是两个独立同分布的序列间隔之和，即 $\\Delta t = T_1 + T_2$，其中 $T_1, T_2 \\sim \\text{Gamma}(8, 2)$。伽马分布的一个基本性质是，具有相同率参数的独立伽马变量之和也是一个伽马变量。新的形状参数是各个形状参数之和。\n$$ \\Delta t \\sim \\text{Gamma}(\\alpha_1+\\alpha_2, \\beta) = \\text{Gamma}(8+8, 2) = \\text{Gamma}(16, 2) $$\n这种情况下的概率密度函数 $f_2(t)$ 为：\n$$ f_2(t) = f(t; 16, 2) = \\frac{2^{16}}{\\Gamma(16)} t^{16-1} \\exp(-2t) = \\frac{65536}{15!} t^{15} \\exp(-2t) $$\n\n现在我们可以通过在 $t = \\Delta t = 5$ 处计算这些密度的比率来计算后验概率：\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{f_1(5)}{f_1(5) + f_2(5)} = \\frac{1}{1 + \\frac{f_2(5)}{f_1(5)}} $$\n让我们计算比率 $R = \\frac{f_2(5)}{f_1(5)}$：\n$$ R = \\frac{\\frac{2^{16}}{15!} 5^{15} \\exp(-2 \\cdot 5)}{\\frac{2^8}{7!} 5^7 \\exp(-2 \\cdot 5)} = \\frac{2^{16} \\cdot 5^{15} \\cdot 7!}{2^8 \\cdot 5^7 \\cdot 15!} $$\n$\\exp(-10)$ 项相互抵消。简化幂和阶乘：\n$$ R = \\frac{2^{16-8} \\cdot 5^{15-7}}{15!/7!} = \\frac{2^8 \\cdot 5^8}{15 \\cdot 14 \\cdot 13 \\cdot 12 \\cdot 11 \\cdot 10 \\cdot 9 \\cdot 8} = \\frac{(2 \\cdot 5)^8}{15 \\cdot 14 \\cdot 13 \\cdot 12 \\cdot 11 \\cdot 10 \\cdot 9 \\cdot 8} $$\n$$ R = \\frac{10^8}{259459200} = \\frac{100000000}{259459200} $$\n为了简化这个分数，我们可以将分母表示为其质因数。分母是 $15!/7! = (3 \\cdot 5) \\cdot (2 \\cdot 7) \\cdot 13 \\cdot (2^2 \\cdot 3) \\cdot 11 \\cdot (2 \\cdot 5) \\cdot 3^2 \\cdot 2^3 = 2^7 \\cdot 3^4 \\cdot 5^2 \\cdot 7 \\cdot 11 \\cdot 13$。分子是 $10^8 = (2 \\cdot 5)^8 = 2^8 \\cdot 5^8$。因此，比率 $R$ 是：\n$$ R = \\frac{2^8 \\cdot 5^8}{2^7 \\cdot 3^4 \\cdot 5^2 \\cdot 7 \\cdot 11 \\cdot 13} = \\frac{2 \\cdot 5^6}{3^4 \\cdot 7 \\cdot 11 \\cdot 13} = \\frac{2 \\cdot 15625}{81 \\cdot 1001} = \\frac{31250}{81081} $$\n现在，我们将其代回后验概率的表达式中：\n$$ P(N=1 | \\Delta t = 5) \\approx \\frac{1}{1 + R} = \\frac{1}{1 + \\frac{31250}{81081}} = \\frac{1}{\\frac{81081 + 31250}{81081}} = \\frac{81081}{112331} $$\n进行除法运算得到最终的数值答案：\n$$ P(N=1 | \\Delta t = 5) \\approx 0.721815... $$\n四舍五入到四位有效数字，后验概率为 $0.7218$。", "answer": "$$\\boxed{0.7218}$$", "id": "4706992"}]}