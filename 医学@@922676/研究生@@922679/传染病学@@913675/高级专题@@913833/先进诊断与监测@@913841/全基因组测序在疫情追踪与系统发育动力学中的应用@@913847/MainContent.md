## 引言
传染病的快速传播对全球公共卫生构成持续挑战。传统的流行病学调查在追踪复杂疫情的传播路径时，常因接触史模糊或无症状传播而面临瓶颈，难以精确描绘“谁感染谁”的全貌。近年来，全基因组测序（WGS）技术与[系统发育](@entry_id:137790)动力学（Phylodynamics）分析方法的结合，为我们提供了前所未有的高分辨率工具，能够直接从病原体的遗传密码中解读其传播历史和动态。然而，要有效利用这一强大工具，研究者必须系统地掌握其背后的科学原理、多样的应用场景及其内在局限性，这正是本文旨在解决的知识缺口。

为构建一个完整的知识体系，本文将引导读者逐步深入这一前沿领域。我们首先将在**“原理与机制”**一章中，奠定坚实的理论基础，从[分子钟](@entry_id:141071)和突变累积理论出发，探讨传播瓶颈的随机效应，并比较不同的[系统发育推断](@entry_id:182186)方法。随后，在**“应用与跨学科联系”**一章中，我们将理论付诸实践，展示如何利用这些工具重建传播链、估算[有效再生数](@entry_id:164900)（$R_t$），以及在“同一健康”框架下追溯病原体的跨物种传播。最后，**“动手实践”**部分将提供一系列计算问题，帮助读者巩固核心概念，将理论知识转化为解决实际问题的分析能力。现在，让我们从第一章开始，揭示隐藏在病原体基因组中的演化与传播奥秘。

## 原理与机制

本章旨在阐述利用病原体[全基因组](@entry_id:195052)序列进行暴发追踪和[系统发育](@entry_id:137790)动力学（phylodynamics）分析的核心科学原理与关键机制。我们将从最基本的突变累积理论出发，逐步深入到复杂的[统计推断](@entry_id:172747)模型和实际应用中的挑战，系统性地构建一幅完整的知识图景。本章内容将作为后续章节具体方法学和案例分析的理论基石。

### 从序列差异到传播链

利用基因组数据追溯[传染病](@entry_id:182324)传播的基本前提是，病原体在复制和传播过程中会不断累积突变。这些突变如同一个分子层面的“条形码”，记录了病原体谱系的演化历史。通过解读这些遗传印记，我们能够重建病原体样本之间的亲缘关系，并结合流行病学信息，推断出可能的传播网络。

#### 分子钟与突变累积

在演化生物学中，**分子钟（molecular clock）**是一个核心概念，它假定在足够长的时间尺度上，基因或[蛋白质序列](@entry_id:184994)的突变以一个相对恒定的速率发生。对于在短期暴发中快速演化的病原体（如RNA病毒），这一概念尤为关键。我们可以将突变的发生建模为一个[随机过程](@entry_id:268487)。一个简单而强大的模型是假定在基因组的每一个核苷酸位点上，替换（substitution）的发生遵循一个**泊松过程（Poisson process）**。

具体而言，假设每个位点的中性[替换速率](@entry_id:150366)为 $\mu$（单位：每个位点每年发生的替换数），在时间间隔为 $t$ 的谱系分支上，单个位点发生替换的期望次数为 $\mu t$。对于一个长度为 $L$ 的基因组（或基因片段），在假设各位点独立演化的前提下，整个序列上发生新替换事件的总数 $K$ 也遵循泊松分布，其[期望值](@entry_id:150961)（或速率参数）$\Lambda$ 为：

$$ \Lambda = L \mu t $$

根据泊松分布的[概率质量函数](@entry_id:265484)，在时间间隔 $t$ 内观察到恰好 $k$ 个新替换的概率为 $P(K=k) = \frac{\exp(-\Lambda) \Lambda^k}{k!}$。对于传播溯源而言，最关键的情形是观察到零差异（$k=0$）。两个序列完全相同的概率为：

$$ P(K=0) = \exp(-\Lambda) = \exp(-L \mu t) $$

这个简单的公式揭示了一个核心原理：在给定的突变率 $\mu$ 和时间间隔 $t$ 下，序列越长（$L$ 越大），观察到零差异的概率就越低，从而观察到至少一个可区分的突变（$P(K \ge 1) = 1 - \exp(-\Lambda)$）的概率就越高。

#### [全基因组测序](@entry_id:169777)的分辨能力

正是基于上述原理，**[全基因组测序](@entry_id:169777)（Whole-Genome Sequencing, WGS）**在暴发调查中展现出远超传统测序方法的强大分辨能力。传统的[分子流行病学](@entry_id:167834)可能依赖于对单个或少数几个基因（即“部分基因标记”）的测序，其序列长度 $\ell$ 往往有限。

让我们通过一个具体的思辨实验来理解这一点[@problem_id:4706995]。假设一种急性RNA病毒的基因组长度 $L = 30,000$ 个核苷酸，其[全基因组](@entry_id:195052)替换率为 $\mu = 10^{-3}$ 次/位点/年。在一次医院暴发中，我们采集了两个病例的样本，采样时间相隔 $t = 30$ 天（约等于 $30/365 \approx 0.0822$ 年）。如果我们使用一个长度为 $\ell = 500$ 个核苷酸的常规基因标记进行分析，那么在这段时间内，该标记片段上出现新替换的期望数 $\Lambda_{\ell}$ 为：

$$ \Lambda_{\ell} = \ell \mu t = 500 \times 10^{-3} \times \frac{30}{365} \approx 0.041 $$

这意味着，两个样本在该基因标记上序列完全相同的概率高达 $P(K=0) = \exp(-0.041) \approx 0.96$。换言之，即便一个病例是另一个的直接传染源，我们有 $96\%$ 的概率无法在[基因序列](@entry_id:191077)上观察到任何差异。这使得区分直接传播与间接传播变得极为困难，传播链的解析能力非常有限。

相比之下，如果我们采用WGS，分析的序列长度 $L = 30,000$。此时，期望替换数 $\Lambda_{L}$ 变为：

$$ \Lambda_{L} = L \mu t = 30,000 \times 10^{-3} \times \frac{30}{365} \approx 2.47 $$

在这种情况下，两个全基因组序列完全相同的概率骤降至 $P(K=0) = \exp(-2.47) \approx 0.085$。相应地，观察到至少一个**[单核苷酸多态性](@entry_id:173601)（Single Nucleotide Polymorphism, SNP）**差异的概率约为 $1 - 0.085 = 0.915$。这种高概率的可区分性为精细解析“谁感染谁”提供了至关重要的遗传证据，尤其是在流行病学联系模糊的复杂场景中。**基因组流行病学（Genomic epidemiology）**正是通过整合病原体的这种遗传变异信息与传统的流行病学数据（如病例的发病时间、地点、接触史），来推断传播动态、种群历史和空间扩散模式的学科。

### 宿主内动态与传播瓶颈

病原体并非以单一基因型的形式存在于受感染的宿主体内，而是形成一个异质性的群体，即所谓的**[病毒准种](@entry_id:190834)（quasispecies）**。理解宿主内的这种遗传多样性及其在传播过程中的变化，是正确解读系统发育树的关键。

#### 共识序列与宿主内变异

通过高通量测序，我们可以获得覆盖基因组各个位置的大量序列读长（reads）。对于某个特定位点，我们可能会观察到多种不同的核苷酸碱基。基于这些读长的比对结果，我们可以构建一个**共识序列（consensus genome）**。这通常是指在每个位点上，由出现频率最高的核苷酸组成的序列。

然而，共识序列只是对宿主体内病毒群体“平均”或“主导”基因型的一种描述，它掩盖了群体内部的丰富变异。当某个位点上存在频率低于 $0.5$ 但显著高于测序噪音水平的次要等位基因时，我们称之为**宿主内单核苷酸变异（intrahost Single Nucleotide Variant, iSNV）**[@problem_id:4706963]。这些iSNV构成了宿主体内演化的原材料，也为更精细的传播分析提供了潜在信息。

#### 传播瓶颈的随机效应

当病原体从一个宿主（供体）传播到另一个宿主（受体）时，通常只有少数几个病毒颗粒能够成功建立新的感染。这个过程形成了一个[群体遗传学](@entry_id:146344)上的**瓶颈（bottleneck）**。成功建立感染的创始病毒颗粒数量被称为**传播瓶颈大小（transmission bottleneck size）**，记为 $N_b$。

传播瓶颈本质上是一个剧烈的[遗传漂变](@entry_id:145594)事件，它通过对供体病毒群体的[随机抽样](@entry_id:175193)，极大地影响了iSNV在代间的传递。瓶颈的宽度（即 $N_b$ 的大小）直接决定了宿主内多样性在多大程度上能够被传递给下一代宿主。

我们可以用一个简单的二项抽样模型来量化这一效应[@problem_id:4706963]。假设在供体宿主体内，某个iSNV的频率为 $p$。在传播事件中，随机抽取 $N_b$ 个病毒颗粒作为创始群体。那么，这 $N_b$ 个颗粒中携带该iSNV的病毒数量 $k$，就服从一个二项分布 $k \sim \text{Binomial}(N_b, p)$。

假设在受体中，只有当该iSNV的初始频率 $k/N_b$ 不低于某个检测阈值 $f_{\min}$ 时，我们才能可靠地观察到它。现在，我们比较两种情况：一个非常“狭窄”的瓶颈 $N_b=2$ 和一个相对“宽”的瓶颈 $N_b=50$。供体中iSNV的频率为 $p=0.1$，检测阈值为 $f_{\min}=0.05$。

-   **对于狭窄瓶颈 ($N_b=2$)**:
    检测条件为 $k/2 \ge 0.05$，即 $k \ge 0.1$。由于 $k$ 必须是整数，这意味着只要至少有1个创始病毒携带该iSNV（$k \ge 1$），它就有可能被检测到。其不被传递的概率（即 $k=0$）为：
    $$ P(k=0) = \binom{2}{0} p^0 (1-p)^2 = (1-0.1)^2 = 0.81 $$
    因此，该iSNV在受体中被检测到的概率为 $P(k \ge 1) = 1 - 0.81 = 0.19$。这是一个相当低的概率，表明在狭窄瓶颈下，即使是中等频率的iSNV也很容易在传播中丢失。

-   **对于宽瓶颈 ($N_b=50$)**:
    检测条件为 $k/50 \ge 0.05$，即 $k \ge 2.5$。由于 $k$ 是整数，这意味着需要至少3个创始病毒携带该iSNV（$k \ge 3$）。我们需要计算 $P(k \ge 3) = 1 - [P(k=0) + P(k=1) + P(k=2)]$。
    $$ P(k=0) = \binom{50}{0} (0.1)^0 (0.9)^{50} \approx 0.0052 $$
    $$ P(k=1) = \binom{50}{1} (0.1)^1 (0.9)^{49} \approx 0.0286 $$
    $$ P(k=2) = \binom{50}{2} (0.1)^2 (0.9)^{48} \approx 0.0779 $$
    因此，检测到的概率约为 $1 - (0.0052 + 0.0286 + 0.0779) \approx 0.888$。这个概率非常高。

这个例子清晰地表明，**更宽的传播瓶颈更能代表性地传递供体的[遗传多样性](@entry_id:201444)，从而增加了iSNV在传播链中持续存在的可能性**。反之，狭窄的瓶颈会放大[随机抽样](@entry_id:175193)的影响，导致多样性的丧失。

### 系统发育树与传播历史

基于测序数据，我们可以构建**[系统发育树](@entry_id:140506)（phylogeny）**，它以[树状图](@entry_id:266792)的形式展现了所采样病原体基因组之间的[演化关系](@entry_id:175708)。然而，这个基因层面的“家谱”与流行病学层面的“谁感染谁”的**传播树（transmission tree）**之间，并非简单的直接对应关系。

#### 系统发育树与传播树的差异

我们需要严格区分这两个概念[@problem_id:4706965]：
-   **传播树 $\mathcal{T}$**: 这是一个有向无环图，其节点代表受感染的**宿主**，有向边 $(H_i \to H_j)$ 代表了在特定时间发生的**感染事件**。它描述的是疾病在宿主群体中的传播路径。
-   **系统发育树 $\mathcal{G}$**: 这是一个根树，其[叶节点](@entry_id:266134)代表所采样的**病原体基因组**。树的拓扑结构反映了这些基因组谱系的共同祖先关系，而[分支长度](@entry_id:177486)则代表了[演化距离](@entry_id:177968)（例如，每位点替换数或时间）。

在最理想的、简化的情境下——例如，传播瓶颈极窄（$b=1$），且宿主体内不存在遗传多样性（即病毒群体是克隆的）——系统发育树的拓扑结构确实能直接反映传播树的拓扑。此时，[系统发育树](@entry_id:140506)上的每一个分叉事件都对应着一次传播事件。

#### [不完全谱系分选](@entry_id:141497)：系统发育与传播不一致的根源

然而，在现实世界中，由于宿主体内存在多样性以及传播瓶颈的随机效应，$\mathcal{G}$ 和 $\mathcal{T}$ 之间常会出现**不一致（discordance）**。这种现象在[群体遗传学](@entry_id:146344)中被称为**[不完全谱系分选](@entry_id:141497)（Incomplete Lineage Sorting, ILS）**。

其核心机制在于：在供体宿主内部，不同的病毒谱系共存并演化。当传播事件发生时，被传递到不同受体中的病毒谱系，可能在供体内部就具有不同的亲缘关系。

让我们考虑一个经典场景[@problem_id:4706965]：宿主 $H_A$ 在时间 $\tau_1$ 感染了宿主 $H_B$，之后在时间 $\tau_2$（$\tau_2 > \tau_1$）感染了宿主 $H_C$。传播树是明确的星状结构：$H_A \to H_B$ 和 $H_A \to H_C$。然而，传递给 $H_B$ 的病毒谱系（记为 $L_B$）和传递给 $H_C$ 的病毒谱系（记为 $L_C$）都源于 $H_A$ 体内的病毒群体。有可能，$L_B$ 和 $L_C$ 的[最近共同祖先](@entry_id:136722)（Most Recent Common Ancestor, MRCA）在 $H_A$ 体内出现的时间，比它们各自与后来在 $H_A$ 体内被采样到的谱系（记为 $L_A$）的MRCA出现的时间更晚（即更靠近现在）。在这种情况下，从 $H_B$ 和 $H_C$ 采样的基因组在系统发育树上会聚成一个姐妹群，而 $H_A$ 的基因组则成为它们的外群，形成 $((H_B, H_C), H_A)$ 的拓扑结构。这个拓扑结构与星状的传播历史发生了冲突。

这种不一致的发生概率与宿主体内病毒的**[有效种群大小](@entry_id:146802)（effective population size, $N_e$）**和谱系在供体内共存的时间密切相关。根据**[溯祖理论](@entry_id:155051)（coalescent theory）**，两个谱系在宿主体内合并（coalesce）的速率与 $N_e$ 成反比。较大的 $N_e$ 意味着谱系合并得更慢，它们可以在宿主体内共存更长时间，这便增加了发生ILS的概率。例如，在上述场景中，假设瓶颈大小 $b=1$，谱系 $L_B$ 和 $L_C$ 的祖先在 $H_A$ 体内共同存在了 $\tau_1 = \min(\tau_1, \tau_2)$ 的时间。根据[Kingman溯祖](@entry_id:169191)模型，它们在此期间发生合并的概率为 $1 - \exp(-\tau_1/N_e)$[@problem_id:4706965]。这个概率随着 $N_e$ 的增大而减小，因此，更大的宿主体内有效种群规模使得谱系在传播前合并的可能性更低，从而增加了发生[不完全谱系分选](@entry_id:141497)的概率，并加剧了[系统发育树](@entry_id:140506)与传播树之间的不一致性。

### [系统发育](@entry_id:137790)动力学的核心引擎

系统发育动力学（Phylodynamics）旨在通过分析病原体的[系统发育树](@entry_id:140506)来推断其在宿主群体中的流行病学和演化动态。其核心在于将[基因序列](@entry_id:191077)中蕴含的微观演化信息与宏观的种群过程联系起来。

#### 时间校准[系统发育](@entry_id:137790)：从[突变率](@entry_id:136737)到时间线

从[序列比对](@entry_id:172191)中直接构建的系统发育树，其[分支长度](@entry_id:177486)通常以遗传距离（如每位点替换数）来衡量。要将这棵“遗传树”转化为一棵[分支长度](@entry_id:177486)代表真实时间（如年、月、日）的“时间树”，我们必须解决**速率与时间的混淆（rate-time confounding）**问题。仅凭遗传距离，我们无法区分“慢速演化很长时间”和“快速演化很短时间”这两种情况。

**异时采样（heterochronous sampling）**，即在不同时间点对样本进行采集，是打破这种混淆的关键[@problem_id:4707042]。通过为系统发育树的每个[叶节点](@entry_id:266134)（即每个样本）标注其已知的日历采样时间，我们为演化过程提供了外部的时间锚点。

其原理可以通过一个简单的“根到叶尖回归”（root-to-tip regression）来直观理解。假设存在一个恒定的[分子钟](@entry_id:141071)速率 $\mu$。对于在时间 $t_i$ 采样的[叶节点](@entry_id:266134) $i$，其从树根（代表[最近共同祖先](@entry_id:136722)，其时间为 $t_{\text{root}}$）到叶尖的演化时间为 $(t_i - t_{\text{root}})$。因此，该路径上的预期遗传距离 $d_i$ 与时间成正比：

$$ d_i \approx \mu \times (t_i - t_{\text{root}}) $$

通过对所有样本的遗传距离 $d_i$ 与其采样时间 $t_i$ 进行线性回归，回归直线的斜率可以用来估计突变率 $\mu$，而其与x轴的交点则可以用来估计根节点的时间 $t_{\text{root}}$。一旦 $\mu$ 和 $t_{\text{root}}$ 被确定，整棵树所有内部节点的时间都可以被校准到日历时间尺度上。当然，这需要样本在时间上有足够大的跨度，以产生可被统计检测的遗传信号（即 $\mu L \Delta t$ 足够大）。在更复杂的[贝叶斯推断](@entry_id:146958)框架中，采样时间作为固定数据，与序列数据一同被纳入模型，从而联合推断速率、时间以及其他动力学参数的后验分布。

#### 谱系过程的宏观模型：出生-死亡过程

一旦我们有了时间校准的[系统发育树](@entry_id:140506)，下一个问题就是如何从树的形态（拓扑和[分支长度](@entry_id:177486)）中解读出流行病学信息。**出生-死亡过程（Birth-Death process）**是用于此目的的一类核心模型。

在一个简化的出生-死亡-采样模型中[@problem_id:4707006]，我们将[系统发育树](@entry_id:140506)中的每个谱系视为一个受感染的个体。该模型由三个关键速[率参数](@entry_id:265473)定义：
-   **出生率 $\lambda$ (Birth Rate)**：每个感染谱系产生新感染谱系的速率，对应于流行病学中的**传播率**。
-   **死亡率 $\delta$ (Death Rate)**：每个感染谱系变为非感染状态（通过康复、隔离或宿主死亡）的速率，对应于**移除率**。
-   **采样率 $\psi$ (Sampling Rate)**：每个感染谱系被采样（即其基因组被测序并纳入分析）的速率。在一个基本的观测模型中，采样事件本身不影响个体的感染或移除过程。

在这些定义下，流行病学中的一个关键参数——**[有效再生数](@entry_id:164900)（Effective Reproduction Number, $R_e$）**——可以与模型参数直接关联。$R_e$ 指在一个典型感染者整个感染期间，预期产生的二次感染人数。由于感染期可以被建模为持续时间服从均值为 $1/\delta$ 的[指数分布](@entry_id:273894)，因此 $R_e$ 等于传播率乘以平均感染期：

$$ R_e = \frac{\lambda}{\delta} $$

同时，感染谱系数量（即流行规模）的**指数增长率（Malthusian growth rate）** $r$ 由[出生率](@entry_id:203658)和死亡率之差决定：

$$ r = \lambda - \delta $$

系统发育树的分支模式直接反映了这些速率。例如，更快的谱系分支（更短的内部节点间距）暗示着更高的净增长率（$r$），而[叶节点](@entry_id:266134)（采样点）的分布则提供了关于采样率 $\psi$ 的信息。通过将这些[模型拟合](@entry_id:265652)到时间校准的系统发育树上，我们可以反向推断出 $\lambda$, $\delta$, $\psi$ 等参数，进而估算 $R_e(t)$ 等重要的流行病学动态。

### [系统发育推断](@entry_id:182186)的统计方法

从[多序列比对](@entry_id:176306)数据中重建系统发育树并推断其参数，主要依赖于三种统计学范式：简约法、最大似然法和[贝叶斯推断](@entry_id:146958)。理解它们的基本逻辑和局限性对于批判性地评估分析结果至关重要。

#### 三大范式：简约法、最大似然法与贝叶斯推断

-   **简约法 (Parsimony)**：该方法的目标是寻找一棵能够以最少演化步骤（即突变次数）来解释观测数据的树。它是一个非概率模型，不涉及复杂的演化模型，而是遵循“[奥卡姆剃刀](@entry_id:147174)”原则。其优点是计算速度快、概念直观。

-   **最大似然法 (Maximum Likelihood, ML)**：ML在一个明确的概率演化模型下（如[核苷](@entry_id:195320)酸[替换模型](@entry_id:177799)和分子钟模型）进行推断。其目标是寻找能使观测数据出现的**概率（似然, Likelihood）**最大化的[树拓扑](@entry_id:165290)和模型参数。给定数据 $D$、树 $T$ 和参数 $\theta$，似然值表示为 $L(D|T, \theta)$。ML通过复杂的优化算法在巨大的[参数空间](@entry_id:178581)中搜索最优解。

-   **贝叶斯推断 (Bayesian Inference)**：贝叶斯方法同样基于明确的概率模型，但它将树和参数都视为随机变量，并为其设定**先验分布 (prior distribution)** $p(T, \theta)$。通过[贝叶斯定理](@entry_id:151040)，它结合了[先验信息](@entry_id:753750)和数据的似然，计算出树和参数的**后验分布 (posterior distribution)** $p(T, \theta|D) \propto L(D|T, \theta)p(T, \theta)$。这个后验分布完整地描述了在给定数据和先验知识下，所有可能树和参数的相对可信度。这使得贝叶斯方法能自然地[量化不确定性](@entry_id:272064)。

#### 模型误设的影响

在ML和贝叶斯方法中，选择一个合适的演化模型至关重要。**模型误设（model misspecification）**，即使用的分析模型与真实的演化过程不符，可能导致系统性的偏差。

-   **[趋同演化](@entry_id:263490)与[长枝吸引](@entry_id:141763)**：简约法对**同oplasy**（[趋同演化](@entry_id:263490)或[反向突变](@entry_id:199794)导致的性状相似）非常敏感。当两个不相关但演化迅速的谱系（在树上表现为长枝）碰巧独立演化出相同的突变时，简约法会错误地将此解释为[共同祖先](@entry_id:175919)的特征，从而将它们不正确地聚集在一起。这种现象被称为**[长枝吸引](@entry_id:141763)（Long-Branch Attraction, LBA）**。相比之下，基于模型的ML和贝叶斯方法更能抵抗LBA，因为它们的演化模型可以解释在长枝上发生多次突变的高概率，从而正确评估趋同事件的可能性 [@problem_id:4707007]。

-   **[分子钟](@entry_id:141071)模型的误设**：真实的演化速率可能在不同谱系间存在差异（即**[宽松分子钟](@entry_id:165533), relaxed molecular clock**）。如果分析时错误地假设了一个恒定的**[严格分子钟](@entry_id:183441)（strict molecular clock）**，ML估计出的单一速率 $\mu$ 将会是所有真实分支速率的一个复杂加权平均值。这会导致对节点时间的系统性偏差，例如，高估了慢速演化谱系的年龄，而低估了快速演化谱系的年龄 [@problem_id:4707007]。

-   **先验分布的影响**：在[贝叶斯分析](@entry_id:271788)中，先验分布的设定会影响后验结果。尤其是在数据信息量有限时，一个信息量强但错误的先验（例如，为一个增长率 $r$ 设定了远离真实值的狭窄[先验分布](@entry_id:141376)），可能会将后验结果“拉”[向错](@entry_id:161223)误的方向，即使数据集较大也难以完全纠正这种偏差 [@problem_id:4707007]。

### 从序列数据到系统发育树：生物信息学实践

在进行[系统发育推断](@entry_id:182186)之前，必须先从原始测序读长中重建出每个样本的共识基因组。这个生物信息学步骤本身就充满了挑战，其选择和执行会直接影响最终的分析结果。

#### 基因组重建：参考序列导向比对与[从头组装](@entry_id:172264)

主要有两种策略来处理测序读长：
-   **参考序列导向比对 (Reference-guided Mapping)**：将测序读长比对到一个已知的、高质量的**参考基因组（reference genome）**上。这是一种高效的方法，适用于待分析样本与参考基因组差异不大的情况。
-   **[从头组装](@entry_id:172264) (De Novo Assembly)**：不依赖任何参考序列，仅通过读长之间的重叠信息，直接拼接出基因组序列。这在没有高质量参考基因组，或者样本与参考基因组差异巨大时是必要的。

参考序列导向比对虽然高效，但存在一个严重的潜在问题——**参考偏倚（reference bias）**[@problem_id:4707016]。比对软件通常有一个错配容忍度 $k$：如果一条读长与参考序列的差异超过 $k$ 个碱基，它就可能被丢弃。假设一个样本的基因组与参考序列的真实差异度（每位点差异概率）为 $\delta$。那么，一条长度为 $L$ 的读长与参考序列的错配数量 $X$ 可被建模为服从[二项分布](@entry_id:141181) $X \sim \text{Binomial}(L, \delta)$。该读长能够成功比对的概率为 $P(X \le k) = \sum_{i=0}^{k}\binom{L}{i}\delta^{i}(1-\delta)^{L-i}$。

这个概率会随着 $\delta$ 的增加而迅速下降。这意味着，与参考序列差异越大的样本（或基因组区域），其读长越容易被丢弃，导致这些区域的测序覆盖度降低，甚至完全缺失。这种系统性的数据丢失会使得该样本的共识序列看起来比实际情况更接近参考序列，从而在系统发育树上压缩其[分支长度](@entry_id:177486)。更严重的是，如果不同谱系与参考序列的差异度不同，这种偏倚会导致系统性的拓扑错误。例如，一个与参考序列差异较大的谱系，其特有的[系统发育](@entry_id:137790)信息位点（synapomorphies）可能因无法比对而丢失，导致该谱系在树中的位置被错误推断 [@problem_id:4707016]。

#### 测序覆盖度的挑战

无论采用哪种重建策略，**测序覆盖度（coverage）**都是一个核心质量指标。它包括两个维度[@problem_id:4706968]：
-   **深度 (Depth)**：基因组上某个特定位置被测序读长覆盖的次数。
-   **广度 (Breadth)**：基因组中[测序深度](@entry_id:178191)达到某个最低阈值（如$10\times$）的区域所占的比例。

在某些测序方案中（如基于扩增子（amplicon-based）的测序），覆盖度往往是不均匀的，某些区域深度很高，而另一些则很低甚至为零（“扩增子脱落”）。这种不均匀性会引入两类偏差：
1.  **低深度区域的随机错误**：在深度较低的位点，由于[抽样误差](@entry_id:182646)，iSNV可能被错误地识别为共识碱基。例如，一个真实频率为 $p=0.3$ 的iSNV，在深度仅为 $n=20$ 的情况下，由于随机波动，其观测到的读长数超过一半（即$X \ge 11$）的概率虽然小，但并非可以忽略（约为$0.017$）。然而，在深度为 $n=200$ 的情况下，发生同样事件的概率则变得微乎其微 [@problem_id:4706968]。这种随机错误会给共识序列引入噪音。
2.  **低深度区域的系统性数据缺失**：更常见的是，分析流程会将深度过低的位点直接标记为未知碱基（'N'）。由于覆盖度的不均匀性，这些'N'在基因组上的分布是高度非随机的。这会导致真实存在的变异信息在低覆盖区域被系统性地抹去，从而扭曲遗传距离的计算，并最终影响系统发育树的拓扑和[分支长度](@entry_id:177486)推断 [@problem_id:4706968]。

### 高级应用与关键考量

基于可靠的时间校准[系统发育树](@entry_id:140506)，我们可以开展更深入的分析，并必须对分析中的一些关键假设保持警惕。

#### 系统发育地理学：重建空间传播

**离散性状系统发育地理学（Discrete-trait phylogeography）**是一种强大的工具，用于重建病原体在不同地理位置（或其他离散状态，如宿主物种）之间的传播历史。该方法将样本的地理位置视为一个在[系统发育树](@entry_id:140506)上随时间演化的离散性状[@problem_id:4706972]。

其演化过程通常被建模为一个**[连续时间马尔可夫链](@entry_id:276307)（Continuous-Time Markov Chain, CTMC）**。这个过程由一个**瞬时速率矩阵 $Q$ (generator matrix)** 完全定义。$Q$ 矩阵的非对角元素 $q_{ij}$ 代表了从位置 $i$ 迁移到位置 $j$ 的瞬时速率。给定一棵时间校准的树和每个[叶节点](@entry_id:266134)的地理位置标注，我们可以利用Felsenstein的**剪枝算法（pruning algorithm）**来计算在给定 $Q$ 矩阵下观测到这些地理位置分布的似然值。通过最大化这个似然值（ML方法）或结合先验进行[MCMC采样](@entry_id:751801)（贝叶斯方法），我们便可以推断出不同地理位置间的迁移速率，并重建树上各个祖先节点的地理位置，从而描绘出一幅动态的病毒空间扩散地图。

#### [采样偏差](@entry_id:193615)的陷阱

所有系统发育动力学推断都隐含着关于**采样过程（sampling process）**的假设。如果这些假设与实际情况不符，就会产生严重的**[采样偏差](@entry_id:193615)（sampling bias）**。

-   **采样分数 (Sampling Fraction)**：指在特定时间 $t$，一个新发感染病例被采样并测序的概率，记为 $p(t)$。它将真实的疫情规模（总感染发生率 $I(t)$）与我们观测到的数据（样本收集速率 $\lambda_s(t) = p(t)I(t)$）联系起来。

-   **偏好性采样 (Preferential Sampling)**：指采样概率 $p(t)$ 与疫情动态本身（如 $I(t)$）相关联，而分析模型未能考虑到这种关联。这是一种常见的、危害极大的模型误设。

以下是两种典型的偏好性采样导致的偏差[@problem_id:4706982]：
1.  **采样力度随疫情增长而加强**：在疫情暴发初期，关注度低，采样少；随着疫情恶化，公共卫生响应增强，采样力度加大。这导致 $p(t)$ 与 $I(t)$ 正相关。如果分析模型错误地假设 $p(t)$ 恒定，它会将在近期观察到的样本密度急剧增加完全归因于病毒传播的加速。结果将是**高估**近期的有效再生数 $R_e(t)$ 和增长率 $r(t)$。
2.  **采样力度随时间减弱**：随着疫情进入平台期或末期，资源或关注度转移，采样力度可能下降。这导致 $p(t)$ 随时间下降。如果模型仍假设 $p(t)$ 恒定，它会将近期样本的稀疏错误地解读为疫情的真实放缓。结果将是**低估**近期的 $R_e(t)$ 和 $r(t)$，可能过早地得出疫情已得到控制的结论。

因此，在解释系统发育动力学的分析结果时，必须对采样策略有清醒的认识，并在可能的情况下将关于采样过程的信息明确地整合到推断模型中，以避免得出具有误导性的结论。