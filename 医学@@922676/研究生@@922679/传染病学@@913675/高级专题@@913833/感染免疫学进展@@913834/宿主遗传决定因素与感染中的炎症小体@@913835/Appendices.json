{"hands_on_practices": [{"introduction": "炎症小体的反应能力从根本上受到其组分（如 $\\text{pro-IL-1}\\beta$）可用性的限制。本练习运用一个简洁而强大的动力学模型，探讨影响蛋白质生成或降解速率的遗传变异如何改变这一基础水平。通过该练习，您将掌握分析炎症小体激活“信号一”的定量基础，并理解宿主遗传背景如何设定炎症反应的“阈值”[@problem_id:4650319]。", "problem": "单个人类巨噬细胞在感染期间响应核因子κB (NF-κB)的激活而产生前白细胞介素-1β (pro-IL-1β)。考虑一个粗粒化的细胞内模型，其中前IL-1β的丰度（记为 $P(t)$，单位为每个细胞的分子数）在一个恒定的有效生产速率 $k_t$（单位为每个细胞每单位时间的分子数）和速率常数为 $k_d$（单位为每单位时间）的一级降解作用下演变。假设在所关注的时间尺度上，$k_t$ 和 $k_d$ 是恒定的，并且相对于前IL-1β的一级降解，成熟白细胞介素-1β (IL-1β) 的加工过程构成一个可忽略的汇。宿主携带的遗传变异可以改变转录产出和降解。\n\n仅使用质量平衡和一级动力学，完成以下任务：\n\n1) 从基于生产和降解的 $P(t)$ 质量平衡微分方程出发，推导前IL-1β的稳态丰度 $P^{\\ast}$。\n\n2) 对于基线基因型，$k_t = 1.5 \\times 10^{4}$ 分子/细胞·小时，$k_d = 1.0 \\times 10^{-1}$ 小时$^{-1}$，计算基线稳态丰度 $P^{\\ast}$，并以分子/细胞为单位表示。\n\n3) 将 $P^{\\ast}$ 相对于参数 $\\theta$ 的局部对数敏感度（弹性）定义为 $E_{P^{\\ast},\\theta} \\equiv \\frac{\\partial \\ln P^{\\ast}}{\\partial \\ln \\theta}$。计算 $E_{P^{\\ast},k_t}$ 和 $E_{P^{\\ast},k_d}$。\n\n4) 宿主的一个遗传变异将有效生产速率变为原来的 $f_t = 9.0 \\times 10^{-1}$ 倍，并将降解速率常数变为原来的 $f_d = 1.2 \\times 10^{0}$ 倍。使用你的推导和敏感度分析，确定稳态丰度的预测相对变化量，定义为 $\\Delta \\equiv \\frac{P^{\\ast}_{\\text{variant}} - P^{\\ast}_{\\text{baseline}}}{P^{\\ast}_{\\text{baseline}}}$，并以无单位小数形式报告。将最终答案四舍五入到四位有效数字。", "solution": "该问题被验证为具有科学依据、提法恰当且客观。它在生物学相关背景下提出了一个标准的蛋白质动力学模型。所有必要信息均已提供，问题是可量化的，并可通过严谨推导得出答案。\n\n分析过程按顺序解决四个任务。\n\n1) 稳态丰度 $P^{\\ast}$ 的推导\n\n前IL-1β丰度 $P(t)$ 的演变由一个质量平衡常微分方程 (ODE) 控制。$P(t)$ 的变化率等于其生产速率减去其降解速率。\n生产速率为一个常数 $k_t$。\n降解是一个一级过程，意味着其速率与当前丰度成正比，即 $k_d P(t)$。\n因此，质量平衡方程为：\n$$\n\\frac{dP(t)}{dt} = k_t - k_d P(t)\n$$\n稳态被定义为丰度不随时间变化的条件。在数学上，这对应于时间导数为零：\n$$\n\\frac{dP(t)}{dt} = 0\n$$\n令 $P^{\\ast}$ 表示前IL-1β的稳态丰度。在稳态下，方程变为：\n$$\n0 = k_t - k_d P^{\\ast}\n$$\n解出 $P^{\\ast}$ 即可得到稳态丰度的表达式：\n$$\nk_d P^{\\ast} = k_t \\implies P^{\\ast} = \\frac{k_t}{k_d}\n$$\n\n2) 基线稳态丰度 $P^{\\ast}_{\\text{baseline}}$ 的计算\n\n问题为基线基因型提供了以下参数值：\n- 有效生产速率，$k_t = 1.5 \\times 10^{4}$ 分子/细胞·小时。\n- 降解速率常数，$k_d = 1.0 \\times 10^{-1} \\, \\text{小时}^{-1}$。\n\n使用推导出的 $P^{\\ast}$ 公式，我们代入这些基线值来求得基线稳态丰度，记为 $P^{\\ast}_{\\text{baseline}}$：\n$$\nP^{\\ast}_{\\text{baseline}} = \\frac{1.5 \\times 10^{4} \\, \\frac{\\text{分子}}{\\text{细胞} \\cdot \\text{小时}}}{1.0 \\times 10^{-1} \\, \\text{小时}^{-1}} = 1.5 \\times 10^{5} \\, \\frac{\\text{分子}}{\\text{细胞}}\n$$\n基线稳态丰度为 $1.5 \\times 10^{5}$ 分子/细胞。\n\n3) 对数敏感度（弹性）的计算\n\n$P^{\\ast}$ 相对于参数 $\\theta$ 的局部对数敏感度（或弹性）定义为：\n$$\nE_{P^{\\ast},\\theta} \\equiv \\frac{\\partial \\ln P^{\\ast}}{\\partial \\ln \\theta}\n$$\n该量衡量由 $\\theta$ 的无穷小相对变化引起的 $P^{\\ast}$ 的相对变化。它也可以写成 $E_{P^{\\ast},\\theta} = \\frac{\\theta}{P^{\\ast}} \\frac{\\partial P^{\\ast}}{\\partial \\theta}$。\n\n为了计算相对于 $k_t$ 和 $k_d$ 的敏感度，我们首先对 $P^{\\ast}$ 的表达式取自然对数：\n$$\n\\ln P^{\\ast} = \\ln\\left(\\frac{k_t}{k_d}\\right) = \\ln(k_t) - \\ln(k_d)\n$$\n现在，我们计算 $\\ln P^{\\ast}$ 对 $\\ln k_t$ 的偏导数来求得 $E_{P^{\\ast},k_t}$：\n$$\nE_{P^{\\ast},k_t} = \\frac{\\partial}{\\partial \\ln k_t} (\\ln k_t - \\ln k_d) = 1 - 0 = 1\n$$\n类似地，我们计算对 $\\ln k_d$ 的偏导数来求得 $E_{P^{\\ast},k_d}$：\n$$\nE_{P^{\\ast},k_d} = \\frac{\\partial}{\\partial \\ln k_d} (\\ln k_t - \\ln k_d) = 0 - 1 = -1\n$$\n敏感度为 $E_{P^{\\ast},k_t} = 1$ 和 $E_{P^{\\ast},k_d} = -1$。这些恒定的整数值表明 $P^{\\ast}$ 与 $k_t$ 成正比，与 $k_d$ 成反比。\n\n4) 稳态丰度相对变化量 $\\Delta$ 的确定\n\n遗传变异通过乘法因子 $f_t = 9.0 \\times 10^{-1}$ 和 $f_d = 1.2 \\times 10^{0}$ 分别修改了基线参数 $k_{t, \\text{baseline}}$ 和 $k_{d, \\text{baseline}}$。\n变异体的新参数 $k_{t, \\text{variant}}$ 和 $k_{d, \\text{variant}}$ 为：\n$$\nk_{t, \\text{variant}} = f_t \\cdot k_{t, \\text{baseline}}\n$$\n$$\nk_{d, \\text{variant}} = f_d \\cdot k_{d, \\text{baseline}}\n$$\n变异体的稳态丰度 $P^{\\ast}_{\\text{variant}}$ 由我们推导的公式给出：\n$$\nP^{\\ast}_{\\text{variant}} = \\frac{k_{t, \\text{variant}}}{k_{d, \\text{variant}}} = \\frac{f_t \\cdot k_{t, \\text{baseline}}}{f_d \\cdot k_{d, \\text{baseline}}}\n$$\n认识到 $P^{\\ast}_{\\text{baseline}} = \\frac{k_{t, \\text{baseline}}}{k_{d, \\text{baseline}}}$，我们可以写出：\n$$\nP^{\\ast}_{\\text{variant}} = \\frac{f_t}{f_d} P^{\\ast}_{\\text{baseline}}\n$$\n问题要求计算相对变化量 $\\Delta$，其定义为 $\\Delta \\equiv \\frac{P^{\\ast}_{\\text{variant}} - P^{\\ast}_{\\text{baseline}}}{P^{\\ast}_{\\text{baseline}}}$。\n代入 $P^{\\ast}_{\\text{variant}}$ 的表达式：\n$$\n\\Delta = \\frac{\\frac{f_t}{f_d} P^{\\ast}_{\\text{baseline}} - P^{\\ast}_{\\text{baseline}}}{P^{\\ast}_{\\text{baseline}}} = \\frac{P^{\\ast}_{\\text{baseline}} \\left(\\frac{f_t}{f_d} - 1\\right)}{P^{\\ast}_{\\text{baseline}}} = \\frac{f_t}{f_d} - 1\n$$\n这个结果是精确的。“敏感度分析”在此依赖于敏感度是恒定的这一事实，这使得乘法关系对于有限变化是精确的，而不仅仅是像更复杂函数那样对无穷小变化的近似。\n\n现在，我们代入给定的因子数值：\n$f_t = 9.0 \\times 10^{-1} = 0.9$\n$f_d = 1.2 \\times 10^{0} = 1.2$\n$$\n\\Delta = \\frac{0.9}{1.2} - 1 = \\frac{9}{12} - 1 = \\frac{3}{4} - 1 = 0.75 - 1 = -0.25\n$$\n问题要求最终答案以无单位小数形式报告，并四舍五入到四位有效数字。\n$$\n\\Delta = -0.2500\n$$", "answer": "$$\\boxed{-0.2500}$$", "id": "4650319"}, {"introduction": "真实的感染过程常常同时激活多种模式识别受体，细胞必须整合这些上游信号以作出精确响应。本练习将模拟两种不同的炎症小体（NLRP3 和 NLRC4）如何竞争有限的下游共享资源（如 ASC 和 caspase-1），从而产生复杂的系统行为。通过构建一个包含协同效应和饱和效应的计算模型，您将亲身体验非线性响应（如协同或拮抗作用）是如何从分子相互作用中涌现的 [@problem_id:4650333]。", "problem": "考虑由两种炎性体支架激活的$caspase-1$对促炎细胞因子的共享下游处理：NLR家族含pyrin结构域3（$\\mathrm{NLRP3}$）和NLR家族含caspase激活和招募结构域4（$\\mathrm{NLRC4}$）。该生物学背景由以下基本原理建模。\n\n- 基本定义：\n  - 炎性体支架介导含caspase招募结构域的凋亡相关斑点样蛋白（$\\mathrm{ASC}$）聚合物的成核，这些聚合物招募并激活$caspase-1$。活化的$caspase-1$将白细胞介素-$1$β等细胞因子前体切割成熟。\n  - $\\mathrm{ASC}$的协同聚合导致活性$caspase-1$总量对上游成核信号呈S型依赖关系，这与Hill型动力学一致。\n  - 在准稳态假设和底物过量的情况下，$caspase-1$的催化作用遵循Michaelis–Menten动力学。\n\n- 用作建模基础的成熟公式和事实：\n  - 用于协同招募的Hill函数：如果上游总成核信号为$\\phi$，则活性$caspase-1$的总浓度为 $$E_{\\text{active}}(\\phi) = E_{\\max}\\,\\frac{\\phi^n}{K^n+\\phi^n},$$ 其中$E_{\\max}$是可达到的最大活性$caspase-1$浓度，$K$是以信号单位表示的半饱和常数，$n$是表示协同性的Hill系数。\n  - 用于产物生成的Michaelis–Menten速率：对于底物浓度$[S]$、催化速率常数$k_{\\text{cat}}$（每分钟）和Michaelis常数$K_m$，瞬时产物生成速率为 $$v(E_{\\text{active}},[S]) = k_{\\text{cat}}\\,E_{\\text{active}}\\,\\frac{[S]}{K_m+[S]}.$$ 在固定时长$T$（分钟）内，生成的产物为 $$P = v \\times T.$$\n\n令来自$\\mathrm{NLRP3}$的上游成核信号为$\\phi_3=\\beta_3 s_3$，来自$\\mathrm{NLRC4}$的为$\\phi_4=\\beta_4 s_4$，其中$s_3$和$s_4$是无量纲的刺激强度，$\\beta_3,\\beta_4$是将刺激转换为成核信号的线性缩放系数。当两种炎性体都参与时，总成核信号为$\\phi_{12}=\\phi_3+\\phi_4$，下游的$caspase-1$池被共享。\n\n定义每种条件下的细胞因子输出为：\n- $P_1$：单独由$\\mathrm{NLRP3}$产生的产物，此时$\\phi=\\phi_3$，\n- $P_2$：单独由$\\mathrm{NLRC4}$产生的产物，此时$\\phi=\\phi_4$，\n- $P_{12}$：联合激活产生的产物，此时$\\phi=\\phi_{12}$。\n\n定义协同偏差$$\\Delta = P_{12}-(P_1+P_2)。$$ 对于以产物单位（微摩尔，见下文单位）表示的固定容差$\\delta$，如果$\\Delta>\\delta$，则将联合输出分类为协同；如果$|\\Delta|\\le \\delta$，则为累加；如果$\\Delta < -\\delta$，则为拮抗。使用整数代码报告分类：协同为$1$，累加为$0$，拮抗为$-1$。\n\n单位：\n- $E_{\\max}$单位为微摩尔，\n- $[S]$和$K_m$单位为微摩尔，\n- $k_{\\text{cat}}$单位为每分钟，\n- $T$单位为分钟，\n- $K$和$\\phi$单位为信号单位（为计算目的视为无量纲），\n- 容差$\\delta$单位为生成的产物的微摩尔浓度。\n\n所有测试用例共享的常数：\n- $E_{\\max}=0.5$ 微摩尔，\n- $k_{\\text{cat}}=1.2$ 每分钟，\n- $K_m=2.0$ 微摩尔，\n- $[S]=20.0$ 微摩尔，\n- $T=30.0$ 分钟，\n- $K=5.0$ 信号单位，\n- $\\beta_3=1.0$，\n- $\\beta_4=1.5$，\n- $\\delta=0.05$ 微摩尔。\n\n测试套件（每个用例指定$s_3$、$s_4$和$n$）：\n- 用例$1$：$s_3=2.0$, $s_4=2.0$, $n=2$。\n- 用例$2$：$s_3=0.0$, $s_4=4.0$, $n=2$。\n- 用例$3$：$s_3=10.0$, $s_4=10.0$, $n=2$。\n- 用例$4$：$s_3=0.1$, $s_4=0.1$, $n=1$。\n\n你的任务是实现一个程序，对每个测试用例，使用上述模型计算$P_1$、$P_2$、$P_{12}$，然后计算$\\Delta$并输出所定义的分类整数代码。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个逗号分隔的列表，用方括号括起来（例如，$[c_1,c_2,c_3,c_4]$），其中$c_i$是用例$i$的分类代码。", "solution": "问题陈述经过严格评估，被确定为有效。它在科学上基于酶动力学和协同结合的既定原则，问题设定良好，具有完整且一致的参数和方程组，并以客观、正式的语言表述。其中没有矛盾、模糊之处或事实错误。该问题是定量系统生物学中的一个标准练习。\n\n解决方案首先建立产物生成量$P$作为上游成核信号$\\phi$和Hill系数$n$的函数的一般公式。所有常数参数都被代入以导出一个单一的计算函数。然后将此函数应用于四个测试用例中的每一个，以确定最终分类。\n\n活性$caspase-1$的总浓度$E_{\\text{active}}$由Hill函数给出：\n$$E_{\\text{active}}(\\phi, n) = E_{\\max}\\,\\frac{\\phi^n}{K^n+\\phi^n}$$\n产物生成的瞬时速率$v$由Michaelis–Menten方程给出：\n$$v(E_{\\text{active}}, [S]) = k_{\\text{cat}}\\,E_{\\text{active}}\\,\\frac{[S]}{K_m+[S]}$$\n在固定时长$T$内生成的总产物为：\n$$P = v \\times T = \\left( k_{\\text{cat}}\\,T\\,\\frac{[S]}{K_m+[S]} \\right) E_{\\text{active}}$$\n让我们定义一个常数因子$C_{\\text{prod}}$，它结合了所有与催化和时间相关的项：\n$$C_{\\text{prod}} = k_{\\text{cat}}\\,T\\,\\frac{[S]}{K_m+[S]}$$\n代入给定的常数值：\n- $k_{\\text{cat}} = 1.2 \\text{ min}^{-1}$\n- $T = 30.0 \\text{ min}$\n- $[S] = 20.0 \\text{ }\\mu\\text{M}$\n- $K_m = 2.0 \\text{ }\\mu\\text{M}$\n\n$$C_{\\text{prod}} = (1.2)(30.0)\\frac{20.0}{2.0+20.0} = 36.0 \\times \\frac{20.0}{22.0} = 36.0 \\times \\frac{10.0}{11.0} = \\frac{360}{11} \\text{ }\\mu\\text{M}^{-1} \\cdot \\text{unit of } E_{\\text{active}}$$\n$E_{\\text{active}}$的单位是$\\mu\\text{M}$，因此在此公式中，如果我们将$C_{\\text{prod}}$视为一个缩放因子，它就是无量纲的。\n总产物$P$现在可以表示为：\n$$P(\\phi, n) = C_{\\text{prod}} \\times E_{\\text{active}}(\\phi, n) = \\frac{360}{11} \\times E_{\\max}\\,\\frac{\\phi^n}{K^n+\\phi^n}$$\n使用$E_{\\max}=0.5 \\text{ }\\mu\\text{M}$，$K=5.0$信号单位，我们得到$P$的最终计算函数：\n$$P(\\phi, n) = \\frac{360}{11} \\times (0.5) \\times \\frac{\\phi^n}{5.0^n+\\phi^n} = \\frac{180}{11} \\frac{\\phi^n}{5.0^n+\\phi^n}$$\nP的单位是$\\mu\\text{M}$。\n\n对于每个用例，我们计算信号$\\phi_3 = \\beta_3 s_3$和$\\phi_4 = \\beta_4 s_4$，其中$\\beta_3=1.0$和$\\beta_4=1.5$。然后我们计算$P_1 = P(\\phi_3, n)$，$P_2 = P(\\phi_4, n)$，和$P_{12} = P(\\phi_3+\\phi_4, n)$。协同偏差为$\\Delta = P_{12} - (P_1+P_2)$。分类代码根据容差$\\delta=0.05 \\text{ }\\mu\\text{M}$确定：如果$\\Delta > \\delta$则为$1$，如果$\\Delta < -\\delta$则为$-1$，否则为$0$。\n\n用例1：$s_3=2.0$, $s_4=2.0$, $n=2$。\n- 信号：$\\phi_3 = 1.0 \\times 2.0 = 2.0$；$\\phi_4 = 1.5 \\times 2.0 = 3.0$；$\\phi_{12} = 2.0+3.0=5.0$。\n- 产物：\n  - $P_1 = P(2.0, 2) = \\frac{180}{11} \\frac{2.0^2}{5.0^2+2.0^2} = \\frac{180}{11} \\frac{4}{29} = \\frac{720}{319} \\approx 2.257 \\text{ }\\mu\\text{M}$。\n  - $P_2 = P(3.0, 2) = \\frac{180}{11} \\frac{3.0^2}{5.0^2+3.0^2} = \\frac{180}{11} \\frac{9}{34} = \\frac{810}{187} \\approx 4.332 \\text{ }\\mu\\text{M}$。\n  - $P_{12} = P(5.0, 2) = \\frac{180}{11} \\frac{5.0^2}{5.0^2+5.0^2} = \\frac{180}{11} \\frac{25}{50} = \\frac{90}{11} \\approx 8.182 \\text{ }\\mu\\text{M}$。\n- 协同作用：$\\Delta = 8.182 - (2.257 + 4.332) = 8.182 - 6.589 = 1.593 \\text{ }\\mu\\text{M}$。\n- 分类：由于$\\Delta=1.593 > \\delta=0.05$，相互作用是协同的。代码为$1$。\n\n用例2：$s_3=0.0$, $s_4=4.0$, $n=2$。\n- 信号：$\\phi_3 = 1.0 \\times 0.0 = 0.0$；$\\phi_4 = 1.5 \\times 4.0 = 6.0$；$\\phi_{12} = 0.0+6.0=6.0$。\n- 产物：\n  - $P_1 = P(0.0, 2) = 0 \\text{ }\\mu\\text{M}$。\n  - $P_2 = P(6.0, 2) = \\frac{180}{11} \\frac{6.0^2}{5.0^2+6.0^2} = \\frac{180}{11} \\frac{36}{61} = \\frac{6480}{671} \\approx 9.657 \\text{ }\\mu\\text{M}$。\n  - $P_{12} = P(6.0, 2) = P_2 \\approx 9.657 \\text{ }\\mu\\text{M}$。\n- 协同作用：$\\Delta = P_{12} - (P_1 + P_2) = 9.657 - (0 + 9.657) = 0.0 \\text{ }\\mu\\text{M}$。\n- 分类：由于$|\\Delta|=0.0 \\le \\delta=0.05$，相互作用是累加的。代码为$0$。\n\n用例3：$s_3=10.0$, $s_4=10.0$, $n=2$。\n- 信号：$\\phi_3 = 1.0 \\times 10.0 = 10.0$；$\\phi_4 = 1.5 \\times 10.0 = 15.0$；$\\phi_{12} = 10.0+15.0=25.0$。\n- 产物：\n  - $P_1 = P(10.0, 2) = \\frac{180}{11} \\frac{10.0^2}{5.0^2+10.0^2} = \\frac{180}{11} \\frac{100}{125} = \\frac{144}{11} \\approx 13.091 \\text{ }\\mu\\text{M}$。\n  - $P_2 = P(15.0, 2) = \\frac{180}{11} \\frac{15.0^2}{5.0^2+15.0^2} = \\frac{180}{11} \\frac{225}{250} = \\frac{162}{11} \\approx 14.727 \\text{ }\\mu\\text{M}$。\n  - $P_{12} = P(25.0, 2) = \\frac{180}{11} \\frac{25.0^2}{5.0^2+25.0^2} = \\frac{180}{11} \\frac{625}{650} = \\frac{2250}{143} \\approx 15.734 \\text{ }\\mu\\text{M}$。\n- 协同作用：$\\Delta = 15.734 - (13.091 + 14.727) = 15.734 - 27.818 = -12.084 \\text{ }\\mu\\text{M}$。\n- 分类：由于$\\Delta=-12.084 < -\\delta=-0.05$，相互作用是拮抗的。代码为$-1$。\n\n用例4：$s_3=0.1$, $s_4=0.1$, $n=1$。\n- 信号：$\\phi_3 = 1.0 \\times 0.1 = 0.1$；$\\phi_4 = 1.5 \\times 0.1 = 0.15$；$\\phi_{12} = 0.1+0.15=0.25$。\n- 产物：\n  - $P_1 = P(0.1, 1) = \\frac{180}{11} \\frac{0.1^1}{5.0^1+0.1^1} = \\frac{180}{11} \\frac{0.1}{5.1} = \\frac{60}{187} \\approx 0.321 \\text{ }\\mu\\text{M}$。\n  - $P_2 = P(0.15, 1) = \\frac{180}{11} \\frac{0.15^1}{5.0^1+0.15^1} = \\frac{180}{11} \\frac{0.15}{5.15} = \\frac{540}{1133} \\approx 0.477 \\text{ }\\mu\\text{M}$。\n  - $P_{12} = P(0.25, 1) = \\frac{180}{11} \\frac{0.25^1}{5.0^1+0.25^1} = \\frac{180}{11} \\frac{0.25}{5.25} = \\frac{60}{77} \\approx 0.779 \\text{ }\\mu\\text{M}$。\n- 协同作用：$\\Delta = 0.779 - (0.321 + 0.477) = 0.779 - 0.798 = -0.019 \\text{ }\\mu\\text{M}$。\n- 分类：由于$|\\Delta|=0.019 \\le \\delta=0.05$，相互作用被分类为累加的。代码为$0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the inflammasome synergy problem for a given set of test cases.\n    \"\"\"\n    # Define constants shared across test cases.\n    E_max = 0.5  # micromolar\n    k_cat = 1.2  # per minute\n    K_m = 2.0    # micromolar\n    S = 20.0     # micromolar\n    T = 30.0     # minutes\n    K = 5.0      # signal units\n    beta3 = 1.0  # dimensionless\n    beta4 = 1.5  # dimensionless\n    delta = 0.05 # micromolar\n\n    # Define the test cases.\n    # Each case is a tuple (s3, s4, n).\n    test_cases = [\n        (2.0, 2.0, 2),\n        (0.0, 4.0, 2),\n        (10.0, 10.0, 2),\n        (0.1, 0.1, 1),\n    ]\n\n    # Pre-calculate the constant part of the product formation equation.\n    # This factor converts active enzyme concentration to total product.\n    # P = (k_cat * T * [S] / (K_m + [S])) * E_active\n    prod_factor = k_cat * T * S / (K_m + S)\n\n    def calculate_product(phi, n):\n        \"\"\"\n        Calculates the total product formed for a given signal and Hill coefficient.\n        \n        Args:\n            phi (float): The total upstream nucleation signal.\n            n (int): The Hill coefficient.\n            \n        Returns:\n            float: The concentration of product formed in micromolar.\n        \"\"\"\n        if phi == 0:\n            return 0.0\n        \n        # Calculate active caspase-1 concentration using the Hill function.\n        # E_active = E_max * (phi^n) / (K^n + phi^n)\n        phi_n = np.power(phi, n)\n        K_n = np.power(K, n)\n        E_active = E_max * phi_n / (K_n + phi_n)\n        \n        # Calculate total product.\n        product = prod_factor * E_active\n        return product\n\n    results = []\n    for s3, s4, n in test_cases:\n        # Calculate individual and combined signals.\n        phi3 = beta3 * s3\n        phi4 = beta4 * s4\n        phi12 = phi3 + phi4\n\n        # Calculate product for each condition.\n        p1 = calculate_product(phi3, n)\n        p2 = calculate_product(phi4, n)\n        p12 = calculate_product(phi12, n)\n        \n        # Calculate the synergy deviation.\n        synergy_dev = p12 - (p1 + p2)\n        \n        # Classify the interaction.\n        if synergy_dev > delta:\n            classification_code = 1  # Synergistic\n        elif synergy_dev  -delta:\n            classification_code = -1 # Antagonistic\n        else:\n            classification_code = 0  # Additive\n\n        results.append(classification_code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4650333"}, {"introduction": "验证宿主遗传决定因素相关性的最终标准是其在群体水平上对疾病结局的影响。本练习将分子机制与临床流行病学联系起来，让您掌握一项评估遗传关联强度的核心技能。您将学习如何使用来自一个模拟病例对照研究的数据，计算并解释比值比（Odds Ratio），从而量化炎症小体通路中的特定基因变异与严重感染风险之间的关联[@problem_id:4650289]。", "problem": "一个研究团队正在调查，在核苷酸结合结构域、富含亮氨酸重复序列的蛋白$3$ (NLRP3)炎症小体通路中，一个能增强白细胞介素-$1\\beta$ (IL-$1\\beta$)释放的编码单核苷酸多态性(SNP)，是否会增加流感合并感染期间发生严重细菌性肺炎的比值。他们在一个监测队列中进行了一项嵌套式病例对照研究。病例是需要重症监护的严重肺炎患者，对照是在年龄和季节时间上匹配的经微生物学确认的非严重肺炎患者。\n\n在严重病例($n=128$)中，有$38$名NLRP3变异携带者和$90$名非携带者。在非严重对照组($n=256$)中，有$40$名携带者和$216$名非携带者。设$a, b, c, d$分别表示严重病例中的变异携带者人数、严重病例中的非携带者人数、对照组中的变异携带者人数以及对照组中的非携带者人数。\n\n仅使用比值和比值比的基本定义，以及计数数据的渐近大样本理论，执行以下操作：\n\n- 从携带者和非携带者中患严重疾病的比值的定义出发，推导出用$a, b, c, d$表示的比值比$\\mathrm{OR}$的表达式，然后使用上述数据计算其数值。将比值比表示为纯数字，并将答案四舍五入到三位有效数字。\n\n- 使用一阶delta方法近似大样本条件下$\\ln(\\mathrm{OR})$的抽样分布，推导并计算$\\mathrm{OR}$的近似$0.95$置信区间。将两个区间界限报告为纯数字，每个都四舍五入到三位有效数字。\n\n- 陈述该区间是否排除$1$，并简要解释其与携带者患严重疾病风险相关的关联方向。\n\n您的最终数值答案应仅为比值比，按要求四舍五入到三位有效数字。不要包含任何单位。", "solution": "该问题具有科学依据，表述清晰且客观。它提出了遗传流行病学中的一个标准情景，并要求进行标准的统计分析。所有必要数据均已提供，没有内部矛盾或违反基本原则。因此，该问题被认为是有效的，并将提供解答。\n\n我们将患有严重肺炎的事件定义为“病例”，将患有非严重肺炎的事件定义为“对照”。我们将NLRP3变异的携带者状态定义为“暴露”。所提供的数据可以整理成一个$2 \\times 2$列联表：\n\n| | 病例（严重肺炎） | 对照（非严重肺炎） |\n| :--- | :--- | :--- |\n| **携带者（暴露）** | $a = 38$ | $c = 40$ |\n| **非携带者（未暴露）**| $b = 90$ | $d = 216$ |\n| **总计** | $a+b = 128$ | $c+d = 256$ |\n\n**第1部分：比值比($\\mathrm{OR}$)的推导与计算**\n\n问题要求从严重疾病的比值定义出发计算比值比。这个量，我们称之为疾病比值比($\\mathrm{OR}_{\\text{disease}}$)，是携带者中发生严重疾病的比值与非携带者中发生严重疾病的比值之比。\n设$D$为患有严重疾病（即为病例）的事件，$E$为变异携带者（即暴露）的事件。\n\n携带者中患严重疾病的比值为：\n$$ \\mathrm{Odds}(D|E) = \\frac{P(D|E)}{P(\\neg D|E)} $$\n非携带者中患严重疾病的比值为：\n$$ \\mathrm{Odds}(D|\\neg E) = \\frac{P(D|\\neg E)}{P(\\neg D|\\neg E)} $$\n那么疾病比值比为：\n$$ \\mathrm{OR}_{\\text{disease}} = \\frac{\\mathrm{Odds}(D|E)}{\\mathrm{Odds}(D|\\neg E)} $$\n在病例对照研究中，我们根据受试者的疾病状态（$D$或$\\neg D$）进行抽样，然后确定他们的暴露状态（$E$或$\\neg E$）。因此，我们无法直接估计以暴露为条件的概率，如$P(D|E)$。但是，我们可以估计以疾病状态为条件的暴露概率，如$P(E|D)$。这使我们能够计算暴露比值比($\\mathrm{OR}_{\\text{exposure}}$)，即病例中暴露的比值与对照中暴露的比值之比。\n\n病例中的暴露比值通过暴露病例数与非暴露病例数之比来估计：\n$$ \\widehat{\\mathrm{Odds}}(E|D) = \\frac{a}{b} $$\n对照中的暴露比值通过暴露对照数与非暴露对照数之比来估计：\n$$ \\widehat{\\mathrm{Odds}}(E|\\neg D) = \\frac{c}{d} $$\n暴露比值比是这两个比值的比率：\n$$ \\widehat{\\mathrm{OR}}_{\\text{exposure}} = \\frac{\\widehat{\\mathrm{Odds}}(E|D)}{\\widehat{\\mathrm{Odds}}(E|\\neg D)} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n比值比的一个基本性质是疾病比值比在数学上等同于暴露比值比($\\mathrm{OR}_{\\text{disease}} = \\mathrm{OR}_{\\text{exposure}}$)。这使得病例对照研究设计能够提供疾病比值比的有效估计。因此，用给定计数表示的比值比表达式为 $\\mathrm{OR} = \\frac{ad}{bc}$。\n\n使用所提供的数据：$a=38$, $b=90$, $c=40$, $d=216$。\n$$ \\widehat{\\mathrm{OR}} = \\frac{(38)(216)}{(90)(40)} = \\frac{8208}{3600} = 2.28 $$\n四舍五入到三位有效数字，比值比为$2.28$。\n\n**第2部分：$\\mathrm{OR}$的$0.95$置信区间的推导与计算**\n\n置信区间是使用计数数据的渐近大样本理论构建的。对于大样本量，比值比的对数$\\ln(\\widehat{\\mathrm{OR}})$的抽样分布近似为正态分布。$\\ln(\\widehat{\\mathrm{OR}})$的方差可以使用delta方法推导。\n\n考虑病例中的暴露对数比值$\\ln(a/b)$和对照中的暴露对数比值$\\ln(c/d)$。病例中携带者的计数$a$可以被建模为一个二项随机变量，其参数为$n_1 = a+b$和$p_1 = P(E|D)$。经过logit变换的比例$\\ln(\\hat{p}_1/(1-\\hat{p}_1)) = \\ln(a/b)$的方差近似为：\n$$ \\mathrm{Var}(\\ln(a/b)) \\approx \\frac{1}{n_1 p_1 (1-p_1)} \\approx \\frac{1}{(a+b) \\frac{a}{a+b} \\frac{b}{a+b}} = \\frac{a+b}{ab} = \\frac{1}{a} + \\frac{1}{b} $$\n同样，对于对照组：\n$$ \\mathrm{Var}(\\ln(c/d)) \\approx \\frac{1}{c} + \\frac{1}{d} $$\n由于病例和对照是独立样本，对数比值之差的方差，即$\\ln(\\widehat{\\mathrm{OR}}) = \\ln(a/b) - \\ln(c/d)$，是它们各自方差的总和：\n$$ \\mathrm{Var}(\\ln(\\widehat{\\mathrm{OR}})) \\approx \\left(\\frac{1}{a} + \\frac{1}{b}\\right) + \\left(\\frac{1}{c} + \\frac{1}{d}\\right) = \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d} $$\n标准误(SE)是方差的平方根。\n$$ \\mathrm{SE}(\\ln(\\widehat{\\mathrm{OR}})) = \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}} $$\n代入数值：\n$$ \\mathrm{SE}(\\ln(\\widehat{\\mathrm{OR}})) = \\sqrt{\\frac{1}{38} + \\frac{1}{90} + \\frac{1}{40} + \\frac{1}{216}} \\approx \\sqrt{0.026316 + 0.011111 + 0.025 + 0.004630} \\approx \\sqrt{0.067057} \\approx 0.25895 $$\n对数比值比的点估计值为$\\ln(\\widehat{\\mathrm{OR}}) = \\ln(2.28) \\approx 0.82418$。\n\n$\\ln(\\mathrm{OR})$的近似$0.95$置信区间由$\\ln(\\widehat{\\mathrm{OR}}) \\pm Z_{1-\\alpha/2} \\times \\mathrm{SE}(\\ln(\\widehat{\\mathrm{OR}}))$给出。对于$0.95$的置信水平，$\\alpha=0.05$，来自标准正态分布的临界值为$Z_{0.975} \\approx 1.96$。\n\n$\\ln(\\mathrm{OR})$的下限：$0.82418 - 1.96 \\times 0.25895 \\approx 0.82418 - 0.50754 = 0.31664$\n$\\ln(\\mathrm{OR})$的上限：$0.82418 + 1.96 \\times 0.25895 \\approx 0.82418 + 0.50754 = 1.33172$\n\n为了得到$\\mathrm{OR}$的置信区间，我们对$\\ln(\\mathrm{OR})$区间的界限取指数：\n$\\mathrm{OR}$的下限：$\\exp(0.31664) \\approx 1.3725$\n$\\mathrm{OR}$的上限：$\\exp(1.33172) \\approx 3.7874$\n\n将界限四舍五入到三位有效数字，比值比的$0.95$置信区间为$(1.37, 3.79)$。\n\n**第3部分：置信区间的解释**\n\n比值比的$0.95$置信区间为$(1.37, 3.79)$。该区间不包含无效值1。比值比为1表示暴露与结果之间没有关联。由于整个区间都大于1，因此在$\\alpha=0.05$水平上，观察到的关联是统计学显著的。\n\n关联的方向是正向的。$\\mathrm{OR}$的点估计值为$2.28$，置信区间范围为$1.37$到$3.79$。这表明，在流感合并感染的背景下，与非携带者相比，NLRP3变异的携带者患严重肺炎的比值显著增加。具体来说，据估计，NLRP3变异携带者患严重肺炎的比值是非携带者的$2.28$倍。", "answer": "$$ \\boxed{2.28} $$", "id": "4650289"}]}