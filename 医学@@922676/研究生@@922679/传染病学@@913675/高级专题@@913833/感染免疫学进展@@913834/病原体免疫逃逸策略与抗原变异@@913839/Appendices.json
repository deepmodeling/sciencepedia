{"hands_on_practices": [{"introduction": "病原体进化出多种策略来逃避抗体识别，其中聚糖屏蔽是一种常见机制，即病原体利用宿主样糖分子（聚糖）来遮盖其表面蛋白上的抗原表位。本练习 ([@problem_id:4677555]) 旨在通过定量模型，将这种物理变化（表现为结合亲和力降低或解离常数 $K_{D}$ 增加）与其功能性后果（抗体效价丧失）联系起来。通过这个练习，您可以推导出一个核心的生物物理免疫学原理，并理解亲和力变化如何直接影响中和效力。", "problem": "在一个由抗体介导的对带有糖蛋白刺突的包膜病毒的中和模型中，假设抗体与单个显性表位之间存在平衡结合，并且在抗体浓度为 $C$ 时被中和的病毒粒子比例遵循希尔型中和函数\n$$\nN(C) = \\frac{1}{1 + \\left(\\frac{K_{D}}{C}\\right)^{h}},\n$$\n其中 $K_{D}$ 是抗体-表位相互作用的解离常数（平衡亲和力参数），$h$ 是捕捉有效中和协同性的希尔系数。表位的聚糖屏蔽使解离常数增加到 $K_{D}' = \\beta K_{D}$（其中 $\\beta > 1$），这反映了由于空间位阻导致的亲和力降低，而不改变中和机制。\n\n对于一个固定的中和目标 $N^{*} \\in (0,1)$，将效价定义为达到 $N(C) = N^{*}$ 所需的最小抗体浓度，屏蔽前记为 $C^{*}(N^{*})$，屏蔽后记为 $C'^{*}(N^{*})$。推导效价倍数变化的闭式表达式\n$$\nF(\\beta,h,N^{*}) = \\frac{C'^{*}(N^{*})}{C^{*}(N^{*})}\n$$\n作为 $\\beta$、$h$ 和 $N^{*}$ 的函数。此外，许多研究以10为底的对数标度报告效价变化；定义\n$$\n\\delta_{p}(\\beta,h,N^{*}) = \\log_{10}\\!\\left(\\frac{C'^{*}(N^{*})}{C^{*}(N^{*})}\\right).\n$$\n将 $F(\\beta,h,N^{*})$ 和 $\\delta_{p}(\\beta,h,N^{*})$ 均表示为闭式解析表达式。不需要进行数值计算或四舍五入，最终表达式中不应包含任何单位。", "solution": "用户希望我解决以下问题：\n在一个由抗体介导的对带有糖蛋白刺突的包膜病毒的中和模型中，假设抗体与单个显性表位之间存在平衡结合，并且在抗体浓度为 $C$ 时被中和的病毒粒子比例遵循希尔型中和函数\n$$\nN(C) = \\frac{1}{1 + \\left(\\frac{K_{D}}{C}\\right)^{h}},\n$$\n其中 $K_{D}$ 是抗体-表位相互作用的解离常数（平衡亲和力参数），$h$ 是捕捉有效中和协同性的希尔系数。表位的聚糖屏蔽使解离常数增加到 $K_{D}' = \\beta K_{D}$（其中 $\\beta > 1$），这反映了由于空间位阻导致的亲和力降低，而不改变中和机制。\n\n对于一个固定的中和目标 $N^{*} \\in (0,1)$，将效价定义为达到 $N(C) = N^{*}$ 所需的最小抗体浓度，屏蔽前记为 $C^{*}(N^{*})$，屏蔽后记为 $C'^{*}(N^{*})$。推导效价倍数变化的闭式表达式\n$$\nF(\\beta,h,N^{*}) = \\frac{C'^{*}(N^{*})}{C^{*}(N^{*})}\n$$\n作为 $\\beta$、$h$ 和 $N^{*}$ 的函数。此外，许多研究以10为底的对数标度报告效价变化；定义\n$$\n\\delta_{p}(\\beta,h,N^{*}) = \\log_{10}\\!\\left(\\frac{C'^{*}(N^{*})}{C^{*}(N^{*})}\\right).\n$$\n将 $F(\\beta,h,N^{*})$ 和 $\\delta_{p}(\\beta,h,N^{*})$ 均表示为闭式解析表达式。不需要进行数值计算或四舍五入，最终表达式中不应包含任何单位。\n\n### 步骤1：提取已知条件\n- 中和函数：$N(C) = \\frac{1}{1 + \\left(\\frac{K_{D}}{C}\\right)^{h}}$\n- $K_{D}$：解离常数。\n- $h$：希尔系数。\n- $C$：抗体浓度。\n- 聚糖屏蔽效应：$K_{D}' = \\beta K_{D}$，其中 $\\beta > 1$。\n- 效价定义：$C^{*}(N^{*})$ 是使得对于固定目标 $N^{*} \\in (0,1)$ 有 $N(C) = N^{*}$ 的浓度 $C$。\n- 屏蔽后效价：$C'^{*}(N^{*})$ 是对应于解离常数 $K_{D}'$ 的效价。\n- 待求量1：效价的倍数变化，$F(\\beta,h,N^{*}) = \\frac{C'^{*}(N^{*})}{C^{*}(N^{*})}$。\n- 待求量2：对数效价漂移，$\\delta_{p}(\\beta,h,N^{*}) = \\log_{10}\\!\\left(\\frac{C'^{*}(N^{*})}{C^{*}(N^{*})}\\right)$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用希尔方程（一种用于协同结合的标准生物物理模型）来描述病毒中和。聚糖屏蔽的影响被建模为抗体亲和力的降低（$K_D$ 的增加），这是一个公认的病毒免疫逃逸机制。该问题在科学上是有效的。\n- **适定性**：该问题是适定的。它提供了推导所求量所需的所有必要定义和方程。在该模型的背景下，解是唯一的且有意义的。\n- **客观性**：该问题以精确的数学语言表述，没有主观性或歧义。\n\n### 步骤3：结论与行动\n问题有效。求解过程将继续。\n\n为了找到倍数变化 $F(\\beta,h,N^{*})$ 和对数漂移 $\\delta_{p}(\\beta,h,N^{*})$ 的表达式，我们必须首先推导出效价 $C^{*}(N^{*})$ 和 $C'^{*}(N^{*})$ 的表达式。\n\n效价 $C^{*}(N^{*})$ 被定义为达到特定中和分数 $N^{*}$ 的抗体浓度 $C$。我们通过在给定的中和函数中设置 $N(C) = N^{*}$ 并求解 $C$ 来找到它。\n$$\nN^{*} = \\frac{1}{1 + \\left(\\frac{K_{D}}{C^{*}(N^{*})}\\right)^{h}}\n$$\n我们重排这个方程以分离出 $C^{*}(N^{*})$。首先，对两边取倒数：\n$$\n\\frac{1}{N^{*}} = 1 + \\left(\\frac{K_{D}}{C^{*}(N^{*})}\\right)^{h}\n$$\n两边减去1：\n$$\n\\left(\\frac{K_{D}}{C^{*}(N^{*})}\\right)^{h} = \\frac{1}{N^{*}} - 1 = \\frac{1 - N^{*}}{N^{*}}\n$$\n两边取 $h$ 次方根：\n$$\n\\frac{K_{D}}{C^{*}(N^{*})} = \\left(\\frac{1 - N^{*}}{N^{*}}\\right)^{1/h}\n$$\n最后，解出 $C^{*}(N^{*})$：\n$$\nC^{*}(N^{*}) = K_{D} \\left(\\frac{1 - N^{*}}{N^{*}}\\right)^{-1/h} = K_{D} \\left(\\frac{N^{*}}{1 - N^{*}}\\right)^{1/h}\n$$\n这是聚糖屏蔽前效价的表达式。\n\n接下来，我们确定聚糖屏蔽后的效价 $C'^{*}(N^{*})$。问题指出，屏蔽使解离常数增加到 $K_{D}' = \\beta K_{D}$。中和机制，以及因此的希尔方程形式和希尔系数 $h$ 保持不变。因此，我们可以通过在 $C^{*}(N^{*})$ 的表达式中用 $K_{D}'$ 替换 $K_{D}$ 来获得 $C'^{*}(N^{*})$ 的表达式：\n$$\nC'^{*}(N^{*}) = K_{D}' \\left(\\frac{N^{*}}{1 - N^{*}}\\right)^{1/h}\n$$\n代入 $K_{D}' = \\beta K_{D}$：\n$$\nC'^{*}(N^{*}) = (\\beta K_{D}) \\left(\\frac{N^{*}}{1 - N^{*}}\\right)^{1/h}\n$$\n现在我们可以计算效价的倍数变化 $F(\\beta,h,N^{*})$。它是屏蔽后效价与屏蔽前效价的比值。\n$$\nF(\\beta,h,N^{*}) = \\frac{C'^{*}(N^{*})}{C^{*}(N^{*})} = \\frac{(\\beta K_{D}) \\left(\\frac{N^{*}}{1 - N^{*}}\\right)^{1/h}}{K_{D} \\left(\\frac{N^{*}}{1 - N^{*}}\\right)^{1/h}}\n$$\n涉及 $K_{D}$、$N^{*}$ 和 $h$ 的项相互抵消，留下一个非常简单的结果：\n$$\nF(\\beta,h,N^{*}) = \\beta\n$$\n这个结果表明，所需抗体浓度的倍数变化等于解离常数的倍数变化，而与协同性 $h$ 或目标中和水平 $N^{*}$ 无关。更高的 $\\beta$（更差的亲和力）直接转化为需要按比例增加的抗体浓度才能达到相同的效果。\n\n最后，我们计算对数效价漂移 $\\delta_{p}(\\beta,h,N^{*})$。这被定义为倍数变化 $F(\\beta,h,N^{*})$ 的以10为底的对数。\n$$\n\\delta_{p}(\\beta,h,N^{*}) = \\log_{10}\\left(F(\\beta,h,N^{*})\\right)\n$$\n代入我们为 $F(\\beta,h,N^{*})$ 找到的表达式：\n$$\n\\delta_{p}(\\beta,h,N^{*}) = \\log_{10}(\\beta)\n$$\n这个表达式也与 $h$ 和 $N^{*}$ 无关，仅取决于亲和力降低因子 $\\beta$。\n\n所要求的两个闭式表达式是 $F(\\beta,h,N^{*}) = \\beta$ 和 $\\delta_{p}(\\beta,h,N^{*}) = \\log_{10}(\\beta)$。", "answer": "$$\n\\boxed{F(\\beta,h,N^{*}) = \\beta, \\quad \\delta_{p}(\\beta,h,N^{*}) = \\log_{10}(\\beta)}\n$$", "id": "4677555"}, {"introduction": "除了逃避抗体，病原体还能破坏免疫系统的其他部分，例如补体级联反应。一种高级策略是分子模拟或劫持宿主自身的调节蛋白，例如，一些细菌通过模拟宿主细胞表面来招募补体系统的负调节因子H（Factor H）。本练习 ([@problem_id:4677573]) 提供了一个动力学模型，用于理解病原体如何通过增强与因子H的亲和力来直接降低补体沉积速率，从而保护自身。这个实践将平衡结合原理应用于一个动态的免疫逃逸场景。", "problem": "一种革兰氏阴性菌病原体通过增加脂寡糖 (LOS) 的唾液酸化来招募人补体因子H (FH)，从而抑制补体成分3b (C3b) 在其表面的沉积。考虑一个简单的动力学模型，其中FH以$1:1$的化学计量比（每个位点一个FH）与一类独立的LOS位点（记为$\\mathrm{S}$）结合。使用质量作用平衡作为基本依据。结合常数定义为 $K_{a} = \\frac{k_{\\mathrm{on}}}{k_{\\mathrm{off}}} = \\frac{[\\mathrm{FH}:\\mathrm{S}]}{[\\mathrm{FH}][\\mathrm{S}]}$。设$[\\mathrm{S}]_{\\mathrm{tot}}$为LOS位点的总浓度，$[\\mathrm{FH}]$为周围流体中游离FH的浓度，$\\theta$为平衡时被FH占据的LOS位点的分数。假设存在一个大的FH储存库，使得$[\\mathrm{FH}]$有效保持恒定，结合过程不会使其消耗。\n\n当LOS位点未被占据时，补体沉积到单个位点的过程遵循基线一级速率常数$k_{0}$。当FH结合后，该位点的沉积速率衰减为$\\alpha k_{0}$，其中衰减因子$\\alpha \\in [0, 1]$是一个与$K_{a}$和$[\\mathrm{FH}]$无关的常数。整个表面的有效沉积速率常数$k_{\\mathrm{eff}}$是已结合位点和未结合位点的占据率加权平均值。\n\n唾液酸化前，FH-LOS结合常数为 $K_{a,0} = 5.0 \\times 10^{6}\\ \\mathrm{M}^{-1}$。唾液酸化后，亲和力增加十倍，变为 $K_{a,1} = 5.0 \\times 10^{7}\\ \\mathrm{M}^{-1}$。表面周围的FH浓度为 $[\\mathrm{FH}] = 1.0 \\times 10^{-7}\\ \\mathrm{M}$。衰减因子为 $\\alpha = 0.05$。将$k_{0}$、$K_{a}$、$\\alpha$和$[\\mathrm{FH}]$视为不随时间变化的常数。\n\n仅使用质量作用平衡和给定的定义，推导分数占据率$\\theta$（用$K_{a}$和$[\\mathrm{FH}]$表示）的闭式表达式，然后用$\\theta$、$k_{0}$和$\\alpha$表示$k_{\\mathrm{eff}}$。最后，计算由唾液酸化引起的有效补体沉积速率常数的倍数变化$F$，其定义为\n$$\nF \\equiv \\frac{k_{\\mathrm{eff}}(K_{a,1})}{k_{\\mathrm{eff}}(K_{a,0})}.\n$$\n给出$F$的最终数值，四舍五入到四位有效数字。最终答案不需要单位。", "solution": "该问题经评估是有效的。其科学依据是生物物理化学和免疫学的既定原理，特别是蛋白质-配体结合的质量作用动力学和补体逃逸的简化模型。该问题提法恰当，为求得唯一解提供了所有必要的数据和定义。其语言客观，参数在物理上是现实的。\n\n第一个任务是推导LOS位点分数占据率$\\theta$的闭式表达式。根据定义，$\\theta$是已占据位点浓度$[\\mathrm{FH}:\\mathrm{S}]$与位点总浓度$[\\mathrm{S}]_{\\mathrm{tot}}$的比值。\n$$\n\\theta = \\frac{[\\mathrm{FH}:\\mathrm{S}]}{[\\mathrm{S}]_{\\mathrm{tot}}}\n$$\n位点总浓度是游离（未占据）位点浓度$[\\mathrm{S}]$和已占据位点浓度$[\\mathrm{FH}:\\mathrm{S}]$之和。\n$$\n[\\mathrm{S}]_{\\mathrm{tot}} = [\\mathrm{S}] + [\\mathrm{FH}:\\mathrm{S}]\n$$\n该结合过程受质量作用平衡支配，由结合常数$K_{a}$定义：\n$$\nK_{a} = \\frac{[\\mathrm{FH}:\\mathrm{S}]}{[\\mathrm{FH}][\\mathrm{S}]}\n$$\n从这个平衡表达式，我们可以将被占据位点的浓度写为$[\\mathrm{FH}:\\mathrm{S}] = K_{a}[\\mathrm{FH}][\\mathrm{S}]$。将此代入位点总浓度的方程，得到：\n$$\n[\\mathrm{S}]_{\\mathrm{tot}} = [\\mathrm{S}] + K_{a}[\\mathrm{FH}][\\mathrm{S}] = [\\mathrm{S}](1 + K_{a}[\\mathrm{FH}])\n$$\n现在我们可以用$[\\mathrm{S}]_{\\mathrm{tot}}$来表示游离位点的浓度$[\\mathrm{S}]$：\n$$\n[\\mathrm{S}] = \\frac{[\\mathrm{S}]_{\\mathrm{tot}}}{1 + K_{a}[\\mathrm{FH}]}\n$$\n现在，将$[\\mathrm{S}]$的这个表达式代回到$[\\mathrm{FH}:\\mathrm{S}]$的方程中：\n$$\n[\\mathrm{FH}:\\mathrm{S}] = K_{a}[\\mathrm{FH}] \\left( \\frac{[\\mathrm{S}]_{\\mathrm{tot}}}{1 + K_{a}[\\mathrm{FH}]} \\right)\n$$\n最后，我们将其代入$\\theta$的定义中：\n$$\n\\theta = \\frac{[\\mathrm{FH}:\\mathrm{S}]}{[\\mathrm{S}]_{\\mathrm{tot}}} = \\frac{K_{a}[\\mathrm{FH}]}{1 + K_{a}[\\mathrm{FH}]}\n$$\n这就是所要求的$\\theta$的闭式表达式。它是朗缪尔结合等温线的一种形式。\n\n第二个任务是用$\\theta$、$k_{0}$和$\\alpha$表示有效沉积速率常数$k_{\\mathrm{eff}}$。问题陈述，$k_{\\mathrm{eff}}$是未结合位点和已结合位点速率常数的占据率加权平均值。未结合位点的分数为$(1 - \\theta)$，其速率常数为$k_{0}$；已结合位点的分数为$\\theta$，其速率常数为$\\alpha k_{0}$。\n因此，加权平均值为：\n$$\nk_{\\mathrm{eff}} = k_{0}(1 - \\theta) + (\\alpha k_{0})\\theta\n$$\n提出因子$k_{0}$，得到：\n$$\nk_{\\mathrm{eff}} = k_{0}(1 - \\theta + \\alpha \\theta)\n$$\n这可以改写为：\n$$\nk_{\\mathrm{eff}} = k_{0}(1 - (1 - \\alpha)\\theta)\n$$\n这就是所要求的$k_{\\mathrm{eff}}$的表达式。\n\n最后的任务是计算由唾液酸化引起的有效补体沉积速率常数的倍数变化$F$。其定义为：\n$$\nF = \\frac{k_{\\mathrm{eff}}(K_{a,1})}{k_{\\mathrm{eff}}(K_{a,0})}\n$$\n设$\\theta_{0}$为对应唾液酸化前结合常数$K_{a,0}$的占据率，$\\theta_{1}$为对应唾液酸化后常数$K_{a,1}$的占据率。使用$k_{\\mathrm{eff}}$的表达式：\n$$\nF = \\frac{k_{0}(1 - (1 - \\alpha)\\theta_{1})}{k_{0}(1 - (1 - \\alpha)\\theta_{0})} = \\frac{1 - (1 - \\alpha)\\theta_{1}}{1 - (1 - \\alpha)\\theta_{0}}\n$$\n给定以下数值：\n$K_{a,0} = 5.0 \\times 10^{6}\\ \\mathrm{M}^{-1}$\n$K_{a,1} = 5.0 \\times 10^{7}\\ \\mathrm{M}^{-1}$\n$[\\mathrm{FH}] = 1.0 \\times 10^{-7}\\ \\mathrm{M}$\n$\\alpha = 0.05$\n\n首先，我们计算两种情况下的无量纲乘积$K_{a}[\\mathrm{FH}]$：\n$$\nK_{a,0}[\\mathrm{FH}] = (5.0 \\times 10^{6}) \\times (1.0 \\times 10^{-7}) = 0.5\n$$\n$$\nK_{a,1}[\\mathrm{FH}] = (5.0 \\times 10^{7}) \\times (1.0 \\times 10^{-7}) = 5.0\n$$\n接下来，我们计算分数占据率$\\theta_{0}$和$\\theta_{1}$：\n$$\n\\theta_{0} = \\frac{K_{a,0}[\\mathrm{FH}]}{1 + K_{a,0}[\\mathrm{FH}]} = \\frac{0.5}{1 + 0.5} = \\frac{0.5}{1.5} = \\frac{1}{3}\n$$\n$$\n\\theta_{1} = \\frac{K_{a,1}[\\mathrm{FH}]}{1 + K_{a,1}[\\mathrm{FH}]} = \\frac{5.0}{1 + 5.0} = \\frac{5.0}{6.0} = \\frac{5}{6}\n$$\n我们还计算因子$(1 - \\alpha)$：\n$$\n1 - \\alpha = 1 - 0.05 = 0.95\n$$\n现在，我们可以将这些值代入$F$的表达式中：\n$$\nF = \\frac{1 - (0.95)\\theta_{1}}{1 - (0.95)\\theta_{0}} = \\frac{1 - (0.95)(\\frac{5}{6})}{1 - (0.95)(\\frac{1}{3})}\n$$\n分别计算分子和分母：\n$$\n\\text{分子} = 1 - \\frac{0.95 \\times 5}{6} = 1 - \\frac{4.75}{6} = \\frac{6 - 4.75}{6} = \\frac{1.25}{6}\n$$\n$$\n\\text{分母} = 1 - \\frac{0.95}{3} = \\frac{3 - 0.95}{3} = \\frac{2.05}{3}\n$$\n现在计算比值$F$：\n$$\nF = \\frac{\\frac{1.25}{6}}{\\frac{2.05}{3}} = \\frac{1.25}{6} \\times \\frac{3}{2.05} = \\frac{1.25}{2 \\times 2.05} = \\frac{1.25}{4.1}\n$$\n转换为数值：\n$$\nF = \\frac{1.25}{4.1} \\approx 0.30487804878...\n$$\n按要求四舍五入到四位有效数字，得到$0.3049$。", "answer": "$$\n\\boxed{0.3049}\n$$", "id": "4677573"}, {"introduction": "为了在宿主体内实现长期慢性感染，病原体常常采用群体水平的策略，而不仅仅是单个微生物的逃逸机制。抗原变异就是一个典型例子，病原体群体通过系统性地改变其表面抗原，以持续领先于宿主的适应性免疫反应，从而导致一波又一波的感染。本练习 ([@problem_id:4677534]) 运用了来自流行病学的强大工具——下一代矩阵方法，来模拟这些抗原波。通过构建该模型，您可以确定在何种条件下（例如，转换率、增长率、交叉反应性），感染能够在宿主体内无限期地持续存在。", "problem": "考虑一个宿主感染了表达变异表面糖蛋白 (VSG) 的原生动物寄生虫，这种寄生虫能够进行抗原变异。寄生虫种群被划分为 $K$ 个抗原变异株，标记为 $i \\in \\{1,2,\\dots,K\\}$，其种群密度为 $P_i(t)$。在变异株特异性适应性免疫出现之前，每个变异株都以人均净增长率 $(r - d)$ 指数增长，其中 $r$ 是内在复制率（单位为 $\\text{day}^{-1}$），$d$ 是背景清除率（单位为 $\\text{day}^{-1}$）。靶向变异株 $i$ 的特异性适应性免疫在该变异株占主导地位后延迟 $\\tau$ 天（单位为 $\\text{days}$）出现，并迅速清除表达变异株 $i$ 的寄生虫。\n\n抗原转换是随机发生的：在单位增长间隔内，一部分比例为 $s$ 的寄生虫根据一个行随机转换矩阵 $S$ 从变异株 $i$ 转换为变异株 $j \\neq i$。矩阵 $S$ 的元素为 $S_{i,j}$，其中 $S_{i,j} \\ge 0$，$\\sum_{j=1}^K S_{i,j} = 1$，且 $S_{i,i} = 0$。当对变异株 $i$ 的免疫成熟时，交叉反应免疫会降低变异株 $j$ 的存活率；这由一个交叉反应矩阵 $R$ 编码，其元素为 $R_{j,i} \\in [0,1]$，解释为由对变异株 $i$ 的免疫所诱导的对变异株 $j$ 的部分中和程度。变异株 $j$ 对抗由变异株 $i$ 引发的免疫的直接存活分数为 $(1 - R_{j,i})$。\n\n在线性机制下，新生的变异株在出现时是罕见的，从变异株 $i$ 在其免疫前生长窗口开始时的播种密度 $N_i$ 到变异株 $j$ 在其自身窗口开始时的初始播种密度 $N_j$ 的映射可以近似为\n$$\nN_j \\approx \\left( e^{(r - d)\\tau} \\right) \\, s \\, S_{i,j} \\, \\left( 1 - R_{j,i} \\right) \\, N_i.\n$$\n这定义了一个跨抗原状态的下一代算子，其矩阵元素为\n$$\nM_{j,i} = e^{(r - d)\\tau} \\, s \\, S_{i,j} \\, \\left( 1 - R_{j,i} \\right).\n$$\n通过抗原波实现的持续感染对应于存在一个非平凡的变异株链，其密度不会衰减；在数学上，这当且仅当谱半径 $\\rho(M)$ 超过 $1$ 时发生。如果 $\\rho(M) \\le 1$，抗原波将消失。\n\n您的任务是实现一个程序，对于给定的参数集，构建矩阵 $M$ 并通过检查 $\\rho(M) > 1$ 是否成立来判断是否可能发生持续感染。所有速率必须以 $\\text{day}^{-1}$ 为单位处理，时间以 $\\text{days}$ 为单位。每个测试用例的最终答案必须是布尔值，指示条件 $\\rho(M) > 1$ 是否成立。\n\n使用以下参数集测试套件，每个参数集由 $(K, r, d, \\tau, s, c)$ 描述，其中 $c$ 定义了统一的非对角线交叉反应性，使得当 $j \\neq i$ 时 $R_{j,i} = c$ 且 $R_{i,i} = 1$，并且 $S$ 在 $j \\neq i$ 上是均匀的（即，$S_{i,i} = 0$ 且当 $j \\neq i$ 时 $S_{i,j} = \\frac{1}{K-1}$）：\n\n- 测试用例 1：$(K, r, d, \\tau, s, c) = (4, 2.8, 0.8, 4, 0.002, 0.1)$。\n- 测试用例 2：$(K, r, d, \\tau, s, c) = (4, 2.8, 0.8, 4, 0.0001, 0.1)$。\n- 测试用例 3：$(K, r, d, \\tau, s, c) = (4, 2.8, 0.8, 4, 0.0005, 0.7)$。\n- 测试用例 4：$(K, r, d, \\tau, s, c) = \\left(4, 2.8, 0.8, 4, \\frac{1}{e^{(2.8 - 0.8)\\cdot 4}\\cdot (1 - 0.5)}, 0.5\\right)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，`[true_result,false_result,...]`）。列表中的每个元素必须是为相应测试用例按上述方法计算出的布尔值。", "solution": "该问题被评估为有效，因为它在科学上基于免疫学和流行病学的既定模型，数学上是良定的，并且表述客观。构建下一代矩阵 $M$ 和计算其谱半径所需的所有参数和定义都已提供。问题是自洽的、一致的，并且对每个测试用例都有唯一、可验证的解。\n\n核心任务是通过评估条件 $\\rho(M) > 1$ 来确定是否可能发生持续的寄生虫感染，其中 $\\rho(M)$ 是下一代算子矩阵 $M$ 的谱半径。这个 $K \\times K$ 矩阵的元素由以下公式给出：\n$$\nM_{j,i} = e^{(r - d)\\tau} \\, s \\, S_{i,j} \\, \\left( 1 - R_{j,i} \\right)\n$$\n其中 $i, j \\in \\{1, 2, \\dots, K\\}$。\n\n问题为转换矩阵 $S$ 和交叉反应矩阵 $R$ 指定了特定的结构。\n转换矩阵 $S$ 定义为元素 $S_{i,i} = 0$，当 $j \\neq i$ 时 $S_{i,j} = \\frac{1}{K-1}$。这表示向任何其他 $K-1$ 个变异株转换的概率是均等的。\n交叉反应矩阵 $R$ 定义为 $R_{i,i} = 1$（对一个变异株的免疫对自身是 $100\\%$ 有效的）和当 $j \\neq i$ 时 $R_{j,i} = c$，其中 $c$ 是一个代表均一交叉反应性的常数。\n\n现在我们可以确定矩阵 $M$ 的元素。\n\n对于对角线元素 ($j=i$)：\n$$\nM_{i,i} = e^{(r - d)\\tau} \\, s \\, S_{i,i} \\, (1 - R_{i,i})\n$$\n由于 $S_{i,i} = 0$，矩阵 $M$ 的对角线元素全为零：\n$$\nM_{i,i} = 0\n$$\n\n对于非对角线元素 ($j \\neq i$)：\n$$\nM_{j,i} = e^{(r - d)\\tau} \\, s \\, S_{i,j} \\, (1 - R_{j,i})\n$$\n代入 $S_{i,j}$ 和 $R_{j,i}$ 的指定形式：\n$$\nM_{j,i} = e^{(r - d)\\tau} \\, s \\, \\left(\\frac{1}{K-1}\\right) \\, (1 - c)\n$$\n所有非对角线元素都等于这个常数值。我们用 $\\alpha$ 表示这个常数：\n$$\n\\alpha = \\frac{s(1-c)}{K-1}e^{(r-d)\\tau}\n$$\n因此，矩阵 $M$ 具有以下结构：\n$$\nM = \\begin{pmatrix}\n0  \\alpha  \\dots  \\alpha \\\\\n\\alpha  0  \\dots  \\alpha \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n\\alpha  \\alpha  \\dots  0\n\\end{pmatrix}\n$$\n这个矩阵可以写成 $M = \\alpha(J - I)$，其中 $J$ 是 $K \\times K$ 的全一矩阵，$I$ 是 $K \\times K$ 的单位矩阵。\n\n为了找到谱半径 $\\rho(M)$，我们首先求出 $M$ 的特征值。$J-I$ 的特征值是众所周知的。矩阵 $J$ 的特征值为 $K$（重数为 $1$）和 $0$（重数为 $K-1$）。因此，$J-I$ 的特征值为 $K-1$ 和 $0-1 = -1$。\n$M = \\alpha(J-I)$ 的特征值因此是 $\\alpha(K-1)$（重数为 $1$）和 $\\alpha(-1) = -\\alpha$（重数为 $K-1$）。\n\n谱半径 $\\rho(M)$ 是这些特征值绝对值的最大值：\n$$\n\\rho(M) = \\max(|\\alpha(K-1)|, |-\\alpha|)\n$$\n给定参数 $s > 0$，$r > d$，$\\tau > 0$ 和 $c \\in [0, 1)$，常数 $\\alpha$ 是非负的。为了使问题有意义，$K \\ge 2$，所以 $K-1 \\ge 1$。因此，我们有：\n$$\n\\rho(M) = \\max(\\alpha(K-1), \\alpha) = \\alpha(K-1)\n$$\n代入 $\\alpha$ 的表达式：\n$$\n\\rho(M) = \\left(\\frac{s(1-c)}{K-1}e^{(r-d)\\tau}\\right) (K-1) = s(1-c)e^{(r-d)\\tau}\n$$\n持续感染的条件 $\\rho(M) > 1$ 简化为：\n$$\ns(1-c)e^{(r-d)\\tau} > 1\n$$\n我们现在将这个简化条件应用于每个测试用例。\n\n测试用例 1：$(K, r, d, \\tau, s, c) = (4, 2.8, 0.8, 4, 0.002, 0.1)$。\n$$\n\\rho(M) = 0.002 \\cdot (1 - 0.1) \\cdot e^{(2.8 - 0.8) \\cdot 4} = 0.002 \\cdot 0.9 \\cdot e^{8} = 0.0018 \\cdot e^{8} \\approx 5.366\n$$\n由于 $5.366 > 1$，条件满足。可能发生持续感染。结果：`true`。\n\n测试用例 2：$(K, r, d, \\tau, s, c) = (4, 2.8, 0.8, 4, 0.0001, 0.1)$。\n$$\n\\rho(M) = 0.0001 \\cdot (1 - 0.1) \\cdot e^{(2.8 - 0.8) \\cdot 4} = 0.0001 \\cdot 0.9 \\cdot e^{8} = 0.00009 \\cdot e^{8} \\approx 0.268\n$$\n由于 $0.268 \\le 1$，条件不满足。感染波将消失。结果：`false`。\n\n测试用例 3：$(K, r, d, \\tau, s, c) = (4, 2.8, 0.8, 4, 0.0005, 0.7)$。\n$$\n\\rho(M) = 0.0005 \\cdot (1 - 0.7) \\cdot e^{(2.8 - 0.8) \\cdot 4} = 0.0005 \\cdot 0.3 \\cdot e^{8} = 0.00015 \\cdot e^{8} \\approx 0.447\n$$\n由于 $0.447 \\le 1$，条件不满足。感染波将消失。结果：`false`。\n\n测试用例 4：$(K, r, d, \\tau, s, c) = (4, 2.8, 0.8, 4, s_4, 0.5)$，其中 $s_4 = \\frac{1}{e^{(2.8 - 0.8)\\cdot 4}\\cdot (1 - 0.5)}$。\n参数 $s_4$ 定义为：\n$$\ns_4 = \\frac{1}{e^{2.0 \\cdot 4} \\cdot 0.5} = \\frac{1}{0.5 \\cdot e^{8}}\n$$\n现在我们计算 $\\rho(M)$：\n$$\n\\rho(M) = s_4 \\cdot (1 - 0.5) \\cdot e^{(2.8 - 0.8) \\cdot 4} = \\left(\\frac{1}{0.5 \\cdot e^{8}}\\right) \\cdot (0.5) \\cdot e^{8} = 1\n$$\n条件是 $\\rho(M) > 1$。由于 $\\rho(M) = 1$，条件不满足。抗原波处于临界阈值，不会增长。结果：`false`。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates whether sustained infection is possible for a series of test cases\n    based on a model of antigenic variation.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (4, 2.8, 0.8, 4, 0.002, 0.1),\n        (4, 2.8, 0.8, 4, 0.0001, 0.1),\n        (4, 2.8, 0.8, 4, 0.0005, 0.7),\n        (4, 2.8, 0.8, 4, 1.0 / (np.exp((2.8 - 0.8) * 4) * (1.0 - 0.5)), 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        K, r, d, tau, s, c = case\n        \n        # The condition for sustained infection is derived as rho(M) > 1, where\n        # rho(M) is the spectral radius of the next-generation matrix M.\n        # For the given structure of the switching (S) and cross-reactivity (R)\n        # matrices, the spectral radius simplifies to the analytical expression:\n        # rho(M) = s * (1 - c) * exp((r - d) * tau)\n\n        # Calculate the net growth rate\n        net_rate = r - d\n        \n        # Calculate the exponent term\n        exponent = net_rate * tau\n        \n        # Calculate the total growth factor over the immune delay period\n        growth_factor = np.exp(exponent)\n        \n        # Calculate the survival fraction from cross-reactive immunity\n        survival_fraction = 1.0 - c\n        \n        # Calculate the spectral radius using the simplified formula\n        spectral_radius = s * survival_fraction * growth_factor\n        \n        # Determine if sustained infection is possible\n        is_sustained = spectral_radius > 1.0\n        results.append(is_sustained)\n\n    # Final print statement in the exact required format.\n    # The boolean result is converted to a lowercase string: 'true' or 'false'.\n    print(f\"[{','.join(map(lambda x: str(x).lower(), results))}]\")\n\nsolve()\n\n```", "id": "4677534"}]}