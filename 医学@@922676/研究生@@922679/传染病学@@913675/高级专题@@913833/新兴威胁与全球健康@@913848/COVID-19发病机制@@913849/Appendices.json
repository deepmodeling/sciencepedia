{"hands_on_practices": [{"introduction": "要从数量上理解 COVID-19 的发病机制，第一步是建立一个描述病毒在宿主内基本动态的数学框架。这个练习将指导您把关于病毒与宿主细胞相互作用的核心生物学假设，转化为一个由常微分方程（ODEs）组成的标准“靶细胞限制模型”。通过构建这个基础模型，您将掌握将生物学原理精确翻译成数学语言的关键技能，这是传染病动力学建模的基石 [@problem_id:4635838]。", "problem": "对宿主体内严重急性呼吸综合征冠状病毒2（SARS-CoV-2）发病机制的充分混合单室描述，追踪了三种随时间变化的群体：未感染的易感呼吸道上皮靶细胞数量 $T(t)$，生产性感染细胞数量 $I(t)$，以及游离病毒粒子数量 $V(t)$。假设存在以下基于生物学的机制，每种机制都反映了传染病动力学中广泛使用的基础建模原则：（i）感染事件遵循质量作用动力学，其中游离病毒粒子与靶细胞的相遇导致感染，其速率与乘积 $V(t)T(t)$ 成正比；（ii）感染细胞以一个与时间无关的恒定人均风险率死亡，这与无记忆指数损失一致；（iii）每个感染细胞以恒定的人均速率产生游离病毒粒子；（iv）游离病毒粒子以恒定的人均风险率被清除（通过物理清除、感染性丧失或非特异性先天过程）。进一步假设在感兴趣的时间窗口内，这是一个靶细胞受限的机制，没有明确的靶细胞补充、空间结构、饱和效应或适应性免疫效应项。在这些假设下，选择正确指定了 $T(t)$、$I(t)$ 和 $V(t)$ 的常微分方程系统，并对每个参数 $\\beta$、$\\delta$、$p$ 和 $c$ 提供了正确生物学解释的选项。\n\nA. $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I,\\quad \\frac{dV}{dt}=p I-c V.$$ 此处，$\\beta$ 是将病毒粒子-靶细胞相遇与新感染联系起来的感染速率常数（质量作用），$\\delta$ 是感染细胞的人均死亡率，$p$ 是每个感染细胞的病毒粒子产生率，而 $c$ 是游离病毒粒子的人均清除率。假设与一个靶细胞受限、充分混合、没有明确免疫效应项或靶细胞来源的早期感染模型相匹配。\n\nB. $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-c I,\\quad \\frac{dV}{dt}=p I-\\delta V.$$ 此处，$\\beta$ 是感染速率常数，$c$ 是感染细胞的人均死亡率，$\\delta$ 是病毒粒子的人均清除率；$p$ 是每个感染细胞的病毒粒子产生率。除此以外，假设和结构与靶细胞受限模型中的相同。\n\nC. $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I,\\quad \\frac{dV}{dt}=c I-p V.$$ 此处，$\\beta$ 是感染速率常数，$\\delta$ 是感染细胞的死亡率，$c$ 是每个感染细胞的病毒粒子产生率，$p$ 是病毒粒子的清除率。\n\nD. $$\\frac{dT}{dt}=-\\beta V T+s,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I,\\quad \\frac{dV}{dt}=p I-c V.$$ 此处，$\\beta$ 是感染速率常数，$\\delta$ 是感染细胞的死亡率，$p$ 是每个感染细胞的病毒粒子产生率，$c$ 是病毒粒子的清除率，$s$ 代表一个恒定的靶细胞来源（例如，稳态补充）。\n\nE. $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I-k I V,\\quad \\frac{dV}{dt}=p I-c V.$$ 此处，$\\beta$ 是感染速率常数，$\\delta$ 是感染细胞的死亡率，$p$ 是病毒粒子产生率，$c$ 是病毒粒子清除率，$k$ 模拟了与 $I V$ 成比例的、由免疫效应器介导的对感染细胞的杀伤。", "solution": "用户提供了一个描述标准宿主体内病毒动力学模型的问题陈述，并要求找出正确的常微分方程（ODE）系统及参数解释。\n\n### 第一步：问题验证\n\n首先，我将根据指定标准验证问题陈述。\n\n**提取的已知条件：**\n- 该系统涉及三个随时间变化的群体：$T(t)$（未感染的靶细胞）、$I(t)$（感染细胞）和 $V(t)$（游离病毒粒子）。\n- 该模型是一个“充分混合的单室描述”。\n- 控制机制如下：\n    - （i）感染事件遵循质量作用动力学，新感染的速率与病毒粒子 $V(t)$ 和靶细胞 $T(t)$ 的乘积成正比。\n    - （ii）感染细胞以恒定的人均风险率死亡（无记忆指数损失）。\n    - （iii）每个感染细胞以恒定的人均速率产生游离病毒粒子。\n    - （iv）游离病毒粒子以恒定的人均风险率被清除。\n- 附加假设包括：\n    - 靶细胞受限机制。\n    - 没有明确的靶细胞补充。\n    - 没有空间结构。\n    - 没有饱和效应。\n    - 在感兴趣的时间窗口内没有适应性免疫效应项。\n- 需要验证其解释的参数是 $\\beta$、$\\delta$、$p$ 和 $c$。\n\n**验证分析：**\n- **科学依据：** 所描述的模型是经典的“靶细胞受限”病毒动力学模型，是数学和病毒学中一个基础且被广泛接受的框架。其原理（质量作用、生成和衰减的一阶动力学）是标准且科学上合理的近似。**（有效）**\n- **适定性：** 该问题描述了一个一阶非线性常微分方程系统。给定一组关于 $T(0)$、$I(0)$ 和 $V(0)$ 的非负初始条件，该系统是适定的，并且在 $t \\ge 0$ 时有唯一、稳定的解。**（有效）**\n- **客观性：** 所用语言精确、技术性强，没有主观或含糊的术语。**（有效）**\n- **完整性与一致性：** 问题提供了推导唯一常微分方程组所需的所有必要假设。这些假设内部一致（例如，“靶细胞受限”与“没有明确的靶细胞补充”相符）。**（有效）**\n- **现实性：** 尽管是对复杂生物现实的简化，该模型是对早期急性病毒感染动力学的一个科学上合理且常用的表示。**（有效）**\n- **结构与清晰度：** 问题陈述清晰，任务明确。**（有效）**\n\n**结论：** 问题陈述是有效的。这是定量生物学中一个定义明确的标准问题。我现在开始推导解答。\n\n### 第二步：常微分方程组的推导\n\n我将根据所提供的机制为每个群体构建微分方程。\n\n**1. 靶细胞方程，$T(t)$：**\n靶细胞群体 $T$ 仅通过感染而改变。\n- **因感染而减少（机制 i）：** 感染以与病毒粒子 $V$ 和靶细胞 $T$ 相遇成比例的速率发生。根据质量作用动力学，此速率为 $\\beta V T$，其中 $\\beta$ 是感染速率常数。该项表示靶细胞转变为感染细胞的速率。\n- **来源项：** 问题陈述“没有明确的靶细胞补充”，意味着 $T$ 没有正的来源项。\n因此，$T(t)$ 的变化率为：\n$$ \\frac{dT}{dt} = -\\beta V T $$\n\n**2. 感染细胞方程，$I(t)$：**\n感染细胞群体 $I$ 通过新感染细胞的产生和现有细胞的死亡而改变。\n- **因感染而增加（机制 i）：** 靶细胞被感染的速率 $\\beta V T$ 正是新感染细胞产生的速率。这是 $I$ 的一个来源项。\n- **因细胞死亡而减少（机制 ii）：** 感染细胞因“恒定人均风险”而减少。这可转换为一阶衰减过程。减少的速率与感染细胞数量 $I$ 成正比。设比例常数为 $\\delta$，即感染细胞的人均死亡率。损失项为 $\\delta I$。\n因此，$I(t)$ 的净变化率为：\n$$ \\frac{dI}{dt} = \\beta V T - \\delta I $$\n\n**3. 游离病毒粒子方程，$V(t)$：**\n游离病毒粒子群体 $V$ 通过感染细胞的产生和从系统中的清除而改变。\n- **因生产而增加（机制 iii）：** 感染细胞以“恒定人均速率”产生病毒粒子。设此速率为 $p$。对于一个数量为 $I$ 的感染细胞群体，总生产速率为 $p I$。\n- **因清除而减少（机制 iv）：** 病毒粒子因“恒定人均风险”而被清除。这是一个一阶衰减过程。清除的速率与病毒粒子数量 $V$ 成正比。设比例常数为 $c$，即病毒粒子的人均清除率。损失项为 $c V$。\n因此，$V(t)$ 的净变化率为：\n$$ \\frac{dV}{dt} = p I - c V $$\n\n**整合的系统：**\n完整的常微分方程系统为：\n$$ \\frac{dT}{dt} = -\\beta V T $$\n$$ \\frac{dI}{dt} = \\beta V T - \\delta I $$\n$$ \\frac{dV}{dt} = p I - c V $$\n\n**参数解释：**\n- $\\beta$：感染速率常数，量化了单位病毒粒子和靶细胞浓度下成功感染事件的速率。\n- $\\delta$：生产性感染细胞的人均死亡率。\n- $p$：一个感染细胞的人均病毒粒子生产率。\n- $c$：游离病毒粒子的人均清除率。\n\n### 第三步：评估选项\n\n现在，我将根据推导出的系统和参数解释来评估每个选项。\n\n**A.**\n- **方程：** $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I,\\quad \\frac{dV}{dt}=p I-c V.$$\n- **分析：** 这些方程与我推导的系统完全匹配。\n- **解释：**\n    - $\\beta$：感染速率常数（质量作用）- 正确。\n    - $\\delta$：感染细胞的人均死亡率 - 正确。\n    - $p$：每个感染细胞的病毒粒子生产率 - 正确。\n    - $c$：游离病毒粒子的人均清除率 - 正确。\n- **假设：** 模型的描述也与问题陈述完全一致。\n- **结论：** **正确**。\n\n**B.**\n- **方程：** $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-c I,\\quad \\frac{dV}{dt}=p I-\\delta V.$$\n- **分析：** 在 $dI/dt$ 的方程中，损失项是 $-c I$，而它应该是 $-\\delta I$。在 $dV/dt$ 的方程中，损失项是 $-\\delta V$，而它应该是 $-c V$。参数 $\\delta$ 和 $c$ 在方程中被互换了。所提供的解释也反映了这个错误的互换。\n- **结论：** **错误**。\n\n**C.**\n- **方程：** $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I,\\quad \\frac{dV}{dt}=c I-p V.$$\n- **分析：** 在 $dV/dt$ 的方程中，生产项是 $c I$（应为 $p I$），清除项是 $-p V$（应为 $-c V$）。参数 $p$ 和 $c$ 在方程中被互换了。所提供的解释也反映了这个错误的互换。\n- **结论：** **错误**。\n\n**D.**\n- **方程：** $$\\frac{dT}{dt}=-\\beta V T+s,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I,\\quad \\frac{dV}{dt}=p I-c V.$$\n- **分析：** $dT/dt$ 的方程包含一个项 $+s$，代表一个恒定的靶细胞来源。这明确违反了问题陈述中“没有明确的靶细胞补充”的假设。\n- **结论：** **错误**。\n\n**E.**\n- **方程：** $$\\frac{dT}{dt}=-\\beta V T,\\quad \\frac{dI}{dt}=\\beta V T-\\delta I-k I V,\\quad \\frac{dV}{dt}=p I-c V.$$\n- **分析：** $dI/dt$ 的方程包含一个额外的损失项 $-k I V$。选项正确地将其解释为模拟免疫效应器介导的杀伤。然而，这违反了问题陈述中“没有适应性免疫效应项”的假设。\n- **结论：** **错误**。\n\n基于从第一性原理的严谨推导和随后的分析，只有选项 A 准确地表示了问题陈述中描述的模型。", "answer": "$$\\boxed{A}$$", "id": "4635838"}, {"introduction": "在建立了病毒动力学模型之后，一个自然的后续问题是：在什么条件下，一次微量的病毒暴露会导致全面的感染？宿主内基本再生数（$R_{\\mathrm{intra}}$）的概念为我们提供了一个明确的阈值来回答这个问题。这个练习将引导您从基本原理出发，推导出 $R_{\\mathrm{intra}}$ 的表达式，从而将模型的各个参数（如感染率和清除率）与感染能否成功建立联系起来，这是从模型构建到模型分析的关键一步 [@problem_id:4635803]。", "problem": "严重急性呼吸综合征冠状病毒2 (SARS-CoV-2) 在感染极早期阶段于上呼吸道的宿主内动力学，可以通过一个基于质量作用感染和一级清除的靶细胞限制模型来表示。设 $T(t)$ 表示易感上皮靶细胞的比例（无量纲，$0 \\leq T \\leq 1$），$I(t)$ 表示受感染细胞的密度（无量纲），$V(t)$ 表示无量纲病毒载量（自由病毒粒子经参考水平缩放）。该模型为：\n$$\n\\frac{dT}{dt} = -\\beta\\,T\\,V,\\quad\n\\frac{dI}{dt} = \\beta\\,T\\,V - \\delta\\,I,\\quad\n\\frac{dV}{dt} = p\\,I - c\\,V,\n$$\n其中 $\\beta$ 是一个无量纲化的感染混合系数，单位为 $\\text{day}^{-1}$；$\\delta$ 是受感染细胞的损失率，单位为 $\\text{day}^{-1}$；$p$ 是在所选缩放标准下每个受感染细胞的病毒粒子产生率，单位为 $\\text{day}^{-1}$；$c$ 是自由病毒粒子的清除率，单位为 $\\text{day}^{-1}$。假设在时间 $t=0$ 时，系统处于接近无感染的状态，其中 $T(0) = T_0$ 且 $T_0$ 接近 1，$I(0) \\approx 0$，且 $V(0) > 0$ 是一个小数。在极早期阶段，将 $T(t)$ 视为在 $T_0$ 处准恒定。\n\n从这些基本定律和定义出发，并且不使用任何预先给出的阈值公式，完成以下任务：\n- 从第一性原理推导宿主内基本再生数 $R_{\\mathrm{intra}}$ 的解析表达式，该数定义为当单个受感染细胞被引入一个 $T(t) \\equiv T_0$ 保持恒定的宿主时，所产生的新的受感染细胞的期望数量。\n- 推导病毒载量初始增长而非衰减的条件，并用 $R_{\\mathrm{intra}}$ 表示。\n\n然后，使用参数值 $T_0 = 0.9$，$\\beta = 0.60\\,\\text{day}^{-1}$，$p = 50\\,\\text{day}^{-1}$，$\\delta = 1.0\\,\\text{day}^{-1}$ 和 $c = 10.0\\,\\text{day}^{-1}$ 计算 $R_{\\mathrm{intra}}$。将 $R_{\\mathrm{intra}}$ 的最终数值答案四舍五入到三位有效数字。将最终答案表示为一个纯数（无量纲）。", "solution": "该问题提出了一个标准的病毒动力学靶细胞限制模型，该模型在科学上是合理的、适定的，并且是内部一致的。所有必需的参数和定义都已提供。所做的假设表述清晰，并且适用于感染早期阶段的分析。该问题是有效的。\n\n推导按要求分三部分进行：首先，推导宿主内基本再生数 $R_{\\mathrm{intra}}$；其次，推导病毒初始增长的条件；第三，对 $R_{\\mathrm{intra}}$ 进行数值计算。\n\n**第一部分：推导宿主内基本再生数，$R_{\\mathrm{intra}}$**\n\n宿主内基本再生数 $R_{\\mathrm{intra}}$ 定义为，在完全易感的细胞群体中，由单个受感染细胞引入后所产生的新的受感染细胞的期望数量。我们通过追踪源自单个受感染细胞的感染生命周期，从第一性原理推导这个数。\n\n1.  **受感染细胞的寿命：** 受感染细胞 $I$ 以一级速率 $\\delta$ 被清除。在没有新感染的情况下，一组受感染细胞的衰减方程为 $\\frac{dI}{dt} = -\\delta I$。这是一个一级衰减过程。受感染细胞的平均寿命是速率常数的倒数，即 $\\frac{1}{\\delta}$。\n\n2.  **单个受感染细胞的病毒粒子产量：** 单个受感染细胞以速率 $p$ 产生病毒粒子。在其平均寿命 $\\frac{1}{\\delta}$ 天内，单个受感染细胞预期产生的病毒粒子总数等于产生速率乘以平均寿命：\n    $$\n    \\text{Total virions per infected cell} = p \\times \\frac{1}{\\delta} = \\frac{p}{\\delta}\n    $$\n\n3.  **病毒粒子对新细胞的感染：** 自由病毒粒子 $V$ 以一级速率 $c$ 被清除。因此，一个自由病毒粒子的平均寿命是 $\\frac{1}{c}$。在其寿命期间，一个病毒粒子可以感染易感细胞 $T$。新细胞被感染的速率由 $\\beta T V$ 给出。在易感细胞比例恒定为 $T_0$ 的近似下，每个病毒粒子的新感染率为 $\\beta T_0$。单个病毒粒子在其平均寿命内感染的新细胞总数是每个病毒粒子的感染率乘以其平均寿命：\n    $$\n    \\text{New infected cells per virion} = \\beta T_0 \\times \\frac{1}{c} = \\frac{\\beta T_0}{c}\n    $$\n\n4.  **合并步骤：** $R_{\\mathrm{intra}}$ 是由一个原代受感染细胞产生的二代受感染细胞的总数。这个数值是该细胞产生的病毒粒子总数与每个病毒粒子预期引起的新感染数量的乘积。\n    $$\n    R_{\\mathrm{intra}} = (\\text{Total virions per infected cell}) \\times (\\text{New infected cells per virion})\n    $$\n    $$\n    R_{\\mathrm{intra}} = \\left( \\frac{p}{\\delta} \\right) \\times \\left( \\frac{\\beta T_0}{c} \\right) = \\frac{p \\beta T_0}{c \\delta}\n    $$\n这个表达式代表了宿主内的基本再生数。\n\n**第二部分：推导病毒初始增长的条件**\n\n为了确定感染初始增长的条件，我们分析在接近无感染状态（$I \\approx 0$, $V \\approx 0$）时，受感染细胞 $I(t)$ 和病毒载量 $V(t)$ 的动力学。我们使用靶细胞群体近似恒定，$T(t) \\approx T_0$ 的假设。这将关于 $I$ 和 $V$ 的微分方程组线性化：\n$$\n\\frac{dI}{dt} = \\beta T_0 V - \\delta I\n$$\n$$\n\\frac{dV}{dt} = p I - c V\n$$\n这是一个线性常微分方程组，可以表示为矩阵形式：\n$$\n\\frac{d}{dt} \\begin{pmatrix} I \\\\ V \\end{pmatrix} = \\begin{pmatrix} -\\delta & \\beta T_0 \\\\ p & -c \\end{pmatrix} \\begin{pmatrix} I \\\\ V \\end{pmatrix}\n$$\n如果原点 $(I,V) = (0,0)$ 是一个不稳定的平衡点，感染将会增长。这种不稳定性由系统雅可比矩阵 $J$ 的特征值决定：\n$$\nJ = \\begin{pmatrix} -\\delta & \\beta T_0 \\\\ p & -c \\end{pmatrix}\n$$\n特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda \\mathcal{I}) = 0$ 的根，其中 $\\mathcal{I}$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} -\\delta - \\lambda & \\beta T_0 \\\\ p & -c - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\delta - \\lambda)(-c - \\lambda) - (p)(\\beta T_0) = 0\n$$\n$$\n\\lambda^2 + (c + \\delta)\\lambda + c\\delta - p\\beta T_0 = 0\n$$\n为了使感染增长，至少有一个特征值的实部必须为正。设两个特征值为 $\\lambda_1$ 和 $\\lambda_2$。根据二次方程的韦达定理，我们有：\n$$\n\\text{Trace}(J) = \\lambda_1 + \\lambda_2 = -(c + \\delta)\n$$\n$$\n\\det(J) = \\lambda_1 \\lambda_2 = c\\delta - p\\beta T_0\n$$\n由于参数 $c$ 和 $\\delta$ 是速率，它们是正的，因此 $c > 0$ 且 $\\delta > 0$。因此，矩阵的迹 $\\lambda_1 + \\lambda_2$ 总是负的。如果特征值是共轭复数对，它们的实部将是 $-(c+\\delta)/2 < 0$，导致衰减。因此，要发生增长，特征值必须是实数，并且至少有一个必须是正数。如果 $\\lambda_1 + \\lambda_2 < 0$，要使其中一个特征值为正，另一个必须为负。这当且仅当它们的乘积为负时才会发生。\n因此，增长的条件是 $\\lambda_1 \\lambda_2 < 0$：\n$$\nc\\delta - p\\beta T_0 < 0\n$$\n$$\np\\beta T_0 > c\\delta\n$$\n两边同除以 $c\\delta$（这是一个正数），我们得到：\n$$\n\\frac{p\\beta T_0}{c\\delta} > 1\n$$\n识别出第一部分推导出的 $R_{\\mathrm{intra}}$ 表达式，病毒载量初始增长的条件是：\n$$\nR_{\\mathrm{intra}} > 1\n$$\n\n**第三部分：$R_{\\mathrm{intra}}$ 的数值计算**\n\n最后一步是使用给定的参数值计算 $R_{\\mathrm{intra}}$ 的值：\n$T_0 = 0.9$\n$\\beta = 0.60\\,\\text{day}^{-1}$\n$p = 50\\,\\text{day}^{-1}$\n$\\delta = 1.0\\,\\text{day}^{-1}$\n$c = 10.0\\,\\text{day}^{-1}$\n\n使用推导出的公式：\n$$\nR_{\\mathrm{intra}} = \\frac{p \\beta T_0}{c \\delta} = \\frac{(50\\,\\text{day}^{-1}) (0.60\\,\\text{day}^{-1}) (0.9)}{(10.0\\,\\text{day}^{-1}) (1.0\\,\\text{day}^{-1})}\n$$\n单位相互抵消，证实了 $R_{\\mathrm{intra}}$ 是无量纲的。\n$$\nR_{\\mathrm{intra}} = \\frac{50 \\times 0.60 \\times 0.9}{10.0 \\times 1.0} = \\frac{27}{10} = 2.7\n$$\n题目要求将答案四舍五入到三位有效数字。\n$$\nR_{\\mathrm{intra}} = 2.70\n$$\n由于 $R_{\\mathrm{intra}} = 2.70 > 1$，该模型预测具有这些参数的感染最初将会增长。", "answer": "$$\n\\boxed{2.70}\n$$", "id": "4635803"}, {"introduction": "重症 COVID-19 的一个决定性特征是失调的免疫反应，即所谓的“细胞因子风暴”。要理解这种复杂的病理现象，我们需要能够表征驱动这些反应的分子网络动态。这个计算练习介绍了一种强大的系统生物学方法：通过将细胞因子相互作用网络近似为一个线性动力学系统，我们可以通过分析其相互作用矩阵的特征值来判断其行为模式（例如，振荡性或单调性）。您将学习如何从模拟的时间序列数据中估计模型参数，并利用这些参数来预测系统的动态特性，这反映了现代生物医学研究中数据驱动建模的精髓 [@problem_id:4635827]。", "problem": "一个基于2019冠状病毒病 (COVID-19) 发病机制的机理问题是，白细胞介素-6 (IL-6)、白细胞介素-1β (IL-1β) 和肿瘤坏死因子 (TNF) 的短时细胞因子网络是表现出振荡动力学还是单调动力学。已知严重急性呼吸综合征冠状病毒2 (SARS-CoV-2) 感染会诱导失调的细胞因子反应，而围绕准稳态进行线性化可提供一个有原则的局部模型。假设细胞因子浓度构成一个状态向量 $\\mathbf{C}(t) = [C_{\\mathrm{IL6}}(t), C_{\\mathrm{IL1\\beta}}(t), C_{\\mathrm{TNF}}(t)]^\\top$，其局部行为由一个线性时不变 (LTI) 的常微分方程 (ODE) 控制：$$\\frac{d \\mathbf{C}(t)}{dt} = \\mathbf{K}\\,\\mathbf{C}(t) + \\mathbf{p},$$ 其中 $\\mathbf{K} \\in \\mathbb{R}^{3 \\times 3}$ 是相互作用与清除雅可比矩阵，$\\mathbf{p} \\in \\mathbb{R}^{3}$ 是一个代表基线来源的恒定净生成向量。在此表示下，$\\mathbf{K}$ 的复数值特征值的存在表明存在振荡模式，而纯实数特征值则意味着单调动力学（无振荡的增长或衰减）。\n\n给定在离散时间 $t_k$（单位：小时）下的时间序列测量值，细胞因子浓度单位为 $\\mathrm{pg}/\\mathrm{mL}$。您需要使用有限差分近似在采样时间点估计 $\\frac{d\\mathbf{C}}{dt}$，然后通过普通最小二乘法拟合 $\\mathbf{K}$ 和 $\\mathbf{p}$，该方法旨在最小化所有时间点上估计导数值与 $\\mathbf{K}\\mathbf{C} + \\mathbf{p}$ 之间的残差平方和。在估计出 $\\mathbf{K}$ 后，计算其特征值，并根据以下规则判断是振荡动力学还是单调动力学：如果任何特征值的虚部模长超过数值容差 $\\epsilon = 10^{-6}$，则分类为振荡；否则分类为单调。每个测试用例的分类结果应以布尔值的形式返回。\n\n推导约束和数值步骤：\n- 对于内部时间点 $t_k$（其中 $k \\in \\{1,\\ldots,N-2\\}$），其导数的有限差分必须使用中心差分 $$\\frac{d \\mathbf{C}}{dt}\\Big|_{t_k} \\approx \\frac{\\mathbf{C}(t_{k+1}) - \\mathbf{C}(t_{k-1})}{t_{k+1} - t_{k-1}}.$$ 对于端点，在 $t_0$ 处使用前向差分：$$\\frac{d \\mathbf{C}}{dt}\\Big|_{t_0} \\approx \\frac{\\mathbf{C}(t_{1}) - \\mathbf{C}(t_{0})}{t_{1} - t_{0}},$$ 在 $t_{N-1}$ 处使用后向差分：$$\\frac{d \\mathbf{C}}{dt}\\Big|_{t_{N-1}} \\approx \\frac{\\mathbf{C}(t_{N-1}) - \\mathbf{C}(t_{N-2})}{t_{N-1} - t_{N-2}}.$$\n- 逐行拟合 $\\mathbf{K}$：对于每种细胞因子 $i \\in \\{\\mathrm{IL6}, \\mathrm{IL1\\beta}, \\mathrm{TNF}\\}$，将其导数分量 $y_i(t_k)$ 对预测变量 $[C_{\\mathrm{IL6}}(t_k), C_{\\mathrm{IL1\\beta}}(t_k), C_{\\mathrm{TNF}}(t_k), 1]$ 进行回归，通过普通最小二乘法估计系数 $[K_{i1}, K_{i2}, K_{i3}, p_i]$。\n\n测试套件（时间单位：小时，浓度单位：$\\mathrm{pg}/\\mathrm{mL}$）：\n- 案例 1（预期的耦合、潜在振荡）：时间 $\\{\\,0,\\,2,\\,4,\\,6,\\,8,\\,10\\,\\}$；$C_{\\mathrm{IL6}}(t_k)$ 值 $\\{\\,40,\\,62,\\,48,\\,46,\\,55,\\,60\\,\\}$；$C_{\\mathrm{IL1\\beta}}(t_k)$ 值 $\\{\\,30,\\,14,\\,26,\\,32,\\,24,\\,18\\,\\}$；$C_{\\mathrm{TNF}}(t_k)$ 值 $\\{\\,15,\\,16.5,\\,16.8,\\,16.9,\\,17.0,\\,17.05\\,\\}$。\n- 案例 2（预期的向更高水平的单调趋近）：时间 $\\{\\,0,\\,2,\\,4,\\,6,\\,8,\\,10\\,\\}$；$C_{\\mathrm{IL6}}(t_k)$ 值 $\\{\\,30,\\,40,\\,47,\\,51,\\,53,\\,54\\,\\}$；$C_{\\mathrm{IL1\\beta}}(t_k)$ 值 $\\{\\,12,\\,16,\\,19,\\,21,\\,22.2,\\,22.8\\,\\}$；$C_{\\mathrm{TNF}}(t_k)$ 值 $\\{\\,8,\\,10,\\,12,\\,13,\\,13.5,\\,13.8\\,\\}$。\n- 案例 3（具有近似恒定、弱漂移信号的边缘案例）：时间 $\\{\\,0,\\,2,\\,4,\\,6,\\,8,\\,10\\,\\}$；$C_{\\mathrm{IL6}}(t_k)$ 值 $\\{\\,50,\\,50.4,\\,50.8,\\,51.0,\\,51.1,\\,51.15\\,\\}$；$C_{\\mathrm{IL1\\beta}}(t_k)$ 值 $\\{\\,18,\\,18.05,\\,18.1,\\,18.15,\\,18.2,\\,18.25\\,\\}$；$C_{\\mathrm{TNF}}(t_k)$ 值 $\\{\\,12,\\,12.02,\\,12.03,\\,12.035,\\,12.04,\\,12.045\\,\\}$。\n\n您的程序必须为每个案例实现所述的估计和分类过程，并生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$\\texttt{[result1,result2,result3]}$），每个结果都是一个布尔值，指示动力学是振荡（$\\mathrm{True}$）还是单调（$\\mathrm{False}$）。输出中无需包含单位。在判断振荡行为时，请使用指定的有限差分公式和虚部的容差 $\\epsilon = 10^{-6}$。", "solution": "该问题要求我们判断一个由白细胞介素-6 ($C_{\\mathrm{IL6}}$)、白细胞介素-1β ($C_{\\mathrm{IL1\\beta}}$) 和肿瘤坏死因子 ($C_{\\mathrm{TNF}}$)组成的三方细胞因子网络的短时动力学是振荡的还是单调的。该动力学由一个线性时不变（LTI）的常微分方程（ODE）系统建模：\n$$\n\\frac{d \\mathbf{C}(t)}{dt} = \\mathbf{K}\\,\\mathbf{C}(t) + \\mathbf{p}\n$$\n其中 $\\mathbf{C}(t) = [C_{\\mathrm{IL6}}(t), C_{\\mathrm{IL1\\beta}}(t), C_{\\mathrm{TNF}}(t)]^\\top$ 是细胞因子浓度的状态向量，$\\mathbf{K} \\in \\mathbb{R}^{3 \\times 3}$ 是表示相互作用和清除率的雅可比矩阵，而 $\\mathbf{p} \\in \\mathbb{R}^{3}$ 是一个表示基线生成率的常数向量。\n\n动力学的性质（振荡 vs. 单调）由矩阵 $\\mathbf{K}$ 的特征值决定。共轭复数特征值对应于振荡模式，而纯实数特征值对应于单调的增长或衰减模式。我们的任务是从离散的时间序列数据中估计 $\\mathbf{K}$ 和 $\\mathbf{p}$，然后根据估计出的 $\\hat{\\mathbf{K}}$ 的特征值对动力学进行分类。该过程包括三个主要步骤：数值微分、通过普通最小二乘法（OLS）进行参数估计，以及特征值分析。\n\n**步骤 1：导数估计**\n\n给定每种细胞因子浓度 $C_i(t_k)$ 在 $N$ 个离散时间点 $t_0, t_1, \\ldots, t_{N-1}$ 的时间序列数据，我们必须首先估计每个点的时间导数 $\\frac{d\\mathbf{C}}{dt}$。问题指定使用有限差分公式。\n\n对于第一个时间点 $t_0$，使用一阶前向差分：\n$$\n\\frac{d \\mathbf{C}}{dt}\\Big|_{t_0} \\approx \\frac{\\mathbf{C}(t_{1}) - \\mathbf{C}(t_{0})}{t_{1} - t_{0}}\n$$\n\n对于所有内部时间点 $t_k$（其中 $k \\in \\{1, \\ldots, N-2\\}$），为提高准确性，使用二阶中心差分：\n$$\n\\frac{d \\mathbf{C}}{dt}\\Big|_{t_k} \\approx \\frac{\\mathbf{C}(t_{k+1}) - \\mathbf{C}(t_{k-1})}{t_{k+1} - t_{k-1}}\n$$\n\n对于最后一个时间点 $t_{N-1}$，使用一阶后向差分：\n$$\n\\frac{d \\mathbf{C}}{dt}\\Big|_{t_{N-1}} \\approx \\frac{\\mathbf{C}(t_{N-1}) - \\mathbf{C}(t_{N-2})}{t_{N-1} - t_{N-2}}\n$$\n\n将这些公式应用于给定数据中的三种细胞因子，可在 $N$ 个时间点中的每一个点上得到导数向量 $\\frac{d\\mathbf{C}}{dt}$ 的数值估计。我们将估计的导数矩阵表示为 $\\dot{\\mathbf{C}}_{\\text{est}}$，这是一个 $N \\times 3$ 的矩阵，其中每一列对应一种细胞因子。\n\n**步骤 2：通过普通最小二乘法（OLS）进行系统辨识**\n\nLTI 模型可以为每种细胞因子 $i \\in \\{\\mathrm{IL6}, \\mathrm{IL1\\beta}, \\mathrm{TNF}\\}$ 在每个时间点 $t_k$ 表示为：\n$$\n\\frac{dC_i}{dt}\\Big|_{t_k} = K_{i1} C_{\\mathrm{IL6}}(t_k) + K_{i2} C_{\\mathrm{IL1\\beta}}(t_k) + K_{i3} C_{\\mathrm{TNF}}(t_k) + p_i\n$$\n这里，$[K_{i1}, K_{i2}, K_{i3}]$ 构成了矩阵 $\\mathbf{K}$ 的第 $i$ 行，而 $p_i$ 是向量 $\\mathbf{p}$ 的第 $i$ 个分量。\n\n这是一个多元线性回归问题。我们可以为每种细胞因子独立求解未知参数。对于单个细胞因子 $i$，我们在所有 $N$ 个时间点上构建一个系统：\n$$\n\\begin{pmatrix}\n\\dot{C}_{i,\\text{est}}(t_0) \\\\\n\\dot{C}_{i,\\text{est}}(t_1) \\\\\n\\vdots \\\\\n\\dot{C}_{i,\\text{est}}(t_{N-1})\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{\\mathrm{IL6}}(t_0) & C_{\\mathrm{IL1\\beta}}(t_0) & C_{\\mathrm{TNF}}(t_0) & 1 \\\\\nC_{\\mathrm{IL6}}(t_1) & C_{\\mathrm{IL1\\beta}}(t_1) & C_{\\mathrm{TNF}}(t_1) & 1 \\\\\n\\vdots & \\vdots & \\vdots & \\vdots \\\\\nC_{\\mathrm{IL6}}(t_{N-1}) & C_{\\mathrm{IL1\\beta}}(t_{N-1}) & C_{\\mathrm{TNF}}(t_{N-1}) & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nK_{i1} \\\\\nK_{i2} \\\\\nK_{i3} \\\\\np_i\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n\\varepsilon_0 \\\\\n\\varepsilon_1 \\\\\n\\vdots \\\\\n\\varepsilon_{N-1}\n\\end{pmatrix}\n$$\n这可以以紧凑的矩阵形式表示为 $\\mathbf{y}_i = \\mathbf{X} \\mathbf{\\beta}_i + \\mathbf{\\varepsilon}_i$。设计矩阵 $\\mathbf{X}$ 是一个 $N \\times 4$ 的矩阵，其前三列是浓度时间序列，最后一列是全为1的向量，以考虑截距项 $p_i$。向量 $\\mathbf{y}_i$ 是细胞因子 $i$ 的 $N \\times 1$ 估计导数向量。向量 $\\mathbf{\\beta}_i = [K_{i1}, K_{i2}, K_{i3}, p_i]^\\top$ 包含待估计的参数。\n\nOLS 解 $\\hat{\\mathbf{\\beta}}_i$ 最小化了残差平方和 $\\|\\mathbf{y}_i - \\mathbf{X} \\mathbf{\\beta}_i\\|^2$，由下式给出：\n$$\n\\hat{\\mathbf{\\beta}}_i = (\\mathbf{X}^\\top \\mathbf{X})^{-1} \\mathbf{X}^\\top \\mathbf{y}_i\n$$\n对三种细胞因子（$i = 1, 2, 3$）中的每一种都执行此计算，以获得 $\\mathbf{K}$ 和 $\\mathbf{p}$ 的所有元素的估计值。得到的估计雅可比矩阵为 $\\hat{\\mathbf{K}} \\in \\mathbb{R}^{3 \\times 3}$。\n\n**步骤 3：特征值分析与分类**\n\n一旦估计出矩阵 $\\hat{\\mathbf{K}}$，就计算其特征值 $\\lambda_j$（$j=1, 2, 3$）。特征值是特征方程 $\\det(\\hat{\\mathbf{K}} - \\lambda \\mathbf{I}) = 0$ 的根。这些特征值可以是实数或复数。\n\n分类规则如下：\n- 如果任何特征值 $\\lambda_j$ 具有非零虚部，则系统表现出振荡行为。考虑到数值精度，如果存在至少一个特征值 $\\lambda_j$ 使得 $|\\text{Im}(\\lambda_j)| > \\epsilon$（其中容差给定为 $\\epsilon = 10^{-6}$），我们便将动力学分类为**振荡**。\n- 如果所有特征值的虚部都在此容差范围内，即对于所有 $j=1, 2, 3$，都有 $|\\text{Im}(\\lambda_j)| \\leq \\epsilon$，则将动力学分类为**单调**。\n\n将此完整过程应用于所提供的三个测试用例中的每一个，以确定在给定条件下细胞因子网络动力学的性质。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_dynamics(times, c_il6, c_il1b, c_tnf, tolerance=1e-6):\n    \"\"\"\n    Analyzes cytokine time series data to classify dynamics as oscillatory or monotonic.\n\n    This function performs the following steps:\n    1.  Estimates the time derivatives of cytokine concentrations using finite differences.\n    2.  Constructs a design matrix from the concentration data.\n    3.  Uses ordinary least squares to fit the parameters of the LTI model dC/dt = K*C + p.\n    4.  Computes the eigenvalues of the estimated interaction matrix K.\n    5.  Classifies the dynamics as oscillatory if any eigenvalue has a significant imaginary part.\n\n    Args:\n        times (np.ndarray): Array of time points.\n        c_il6 (np.ndarray): Array of IL-6 concentrations.\n        c_il1b (np.ndarray): Array of IL-1beta concentrations.\n        c_tnf (np.ndarray): Array of TNF concentrations.\n        tolerance (float): Numerical tolerance for checking if an imaginary part is non-zero.\n\n    Returns:\n        bool: True for oscillatory dynamics, False for monotonic dynamics.\n    \"\"\"\n    # 1. Assemble concentration data into a single matrix C\n    # C is an N x 3 matrix where N is the number of time points.\n    C = np.vstack([c_il6, c_il1b, c_tnf]).T\n    n_points = len(times)\n    \n    # 2. Estimate derivatives using finite differences\n    dCdt = np.zeros_like(C)\n    \n    # Forward difference for the first point (t_0)\n    dCdt[0, :] = (C[1, :] - C[0, :]) / (times[1] - times[0])\n    \n    # Central difference for interior points (t_1 to t_{N-2})\n    for k in range(1, n_points - 1):\n        dCdt[k, :] = (C[k + 1, :] - C[k - 1, :]) / (times[k + 1] - times[k - 1])\n        \n    # Backward difference for the last point (t_{N-1})\n    dCdt[-1, :] = (C[-1, :] - C[-2, :]) / (times[-1] - times[-2])\n    \n    # 3. Perform Ordinary Least Squares (OLS) to find K and p\n    # The model is dC/dt = K*C + p, which can be expressed for regression as\n    # dCdt = [C, 1] * [K^T, p^T]^T\n    # We solve this row-wise for each cytokine.\n\n    # Design matrix X (N x 4) with concentrations and an intercept term\n    X = np.hstack([C, np.ones((n_points, 1))])\n    \n    # Estimated Jacobian matrix K\n    K_hat = np.zeros((3, 3))\n    \n    # For each cytokine, regress its derivative onto the concentrations\n    for i in range(3):\n        y_i = dCdt[:, i]\n        # lstsq solves X * beta = y_i for beta\n        # beta will contain [K_i1, K_i2, K_i3, p_i]\n        beta_i, _, _, _ = np.linalg.lstsq(X, y_i, rcond=None)\n        \n        # The first 3 elements of beta_i form the i-th row of K\n        K_hat[i, :] = beta_i[:3]\n        \n    # 4. Compute eigenvalues of the estimated matrix K\n    eigenvalues = np.linalg.eigvals(K_hat)\n    \n    # 5. Classify dynamics based on the imaginary part of the eigenvalues\n    is_oscillatory = np.any(np.abs(np.imag(eigenvalues)) > tolerance)\n    \n    return is_oscillatory\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            np.array([0, 2, 4, 6, 8, 10], dtype=float),\n            np.array([40, 62, 48, 46, 55, 60], dtype=float),\n            np.array([30, 14, 26, 32, 24, 18], dtype=float),\n            np.array([15, 16.5, 16.8, 16.9, 17.0, 17.05], dtype=float),\n        ),\n        # Case 2\n        (\n            np.array([0, 2, 4, 6, 8, 10], dtype=float),\n            np.array([30, 40, 47, 51, 53, 54], dtype=float),\n            np.array([12, 16, 19, 21, 22.2, 22.8], dtype=float),\n            np.array([8, 10, 12, 13, 13.5, 13.8], dtype=float),\n        ),\n        # Case 3\n        (\n            np.array([0, 2, 4, 6, 8, 10], dtype=float),\n            np.array([50, 50.4, 50.8, 51.0, 51.1, 51.15], dtype=float),\n            np.array([18, 18.05, 18.1, 18.15, 18.2, 18.25], dtype=float),\n            np.array([12, 12.02, 12.03, 12.035, 12.04, 12.045], dtype=float),\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        times, c_il6, c_il1b, c_tnf = case\n        result = analyze_dynamics(times, c_il6, c_il1b, c_tnf)\n        results.append(str(result))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4635827"}]}