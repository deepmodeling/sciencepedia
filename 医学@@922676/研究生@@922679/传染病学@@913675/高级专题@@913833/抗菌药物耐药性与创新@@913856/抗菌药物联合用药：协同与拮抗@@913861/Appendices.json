{"hands_on_practices": [{"introduction": "棋盘格法和分数抑制浓度 (FIC) 指数是体外协同作用测试的基石。本练习 ([@problem_id:4623455]) 提供了根据实验数据计算 FIC 指数并对药物相互作用进行分类的基本实践。通过这个计算，您将掌握该领域最常用方法的应用，并为理解更复杂的模型打下基础。", "problem": "一株革兰氏阴性菌的临床分离株，使用两种抗菌药物——药物 $A$ 和药物 $B$ 进行测试。采用标准的肉汤微量稀释法来测定其最低抑菌浓度（Minimum Inhibitory Concentration, MIC），MIC 定义为在特定条件下能够抑制可见生长的最低药物浓度。单独使用时，测得的 MIC 值分别为 $\\mathrm{MIC}_A = 8 \\, \\mathrm{mg/L}$ 和 $\\mathrm{MIC}_B = 2 \\, \\mathrm{mg/L}$。随后，通过在微量滴定板上对每种药物进行两倍系列稀释，进行了棋盘格法检测。孵育后，在以下浓度组合的孔中首次观察到无生长现象（即抑制了可见生长的孔）：$(A,B) = (2 \\, \\mathrm{mg/L}, 0.25 \\, \\mathrm{mg/L})$，$(A,B) = (1 \\, \\mathrm{mg/L}, 0.5 \\, \\mathrm{mg/L})$，以及 $(A,B) = (0.5 \\, \\mathrm{mg/L}, 1 \\, \\mathrm{mg/L})$。请使用最低抑菌浓度 (MIC) 和协同抑菌指数 (Fractional Inhibitory Concentration, FIC) 的基本定义，为每个观察到无生长的孔计算药物 $A$ 的协同抑菌指数（记作 $\\mathrm{FIC}_A$）和药物 $B$ 的协同抑菌指数（记作 $\\mathrm{FIC}_B$）。找出所有观察到无生长的孔中最小的协同抑菌指数总和，并使用感染病药理学中常用的临界值对药物相互作用进行分类。在您的推理中，明确讨论在解释体外协同作用和拮抗作用时，这类临界值的任意性及其局限性。将最小的协同抑菌指数总和（记作 $\\mathrm{FIC}_{\\Sigma}$）作为一个无单位的精确数值作为您的最终答案。无需四舍五入。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 测试生物：一株革兰氏阴性菌的临床分离株。\n- 药物A和药物B是抗菌药物。\n- 检测方法：肉汤微量稀释棋盘格法。\n- 最低抑菌浓度 (MIC) 的定义：“在特定条件下能够抑制可见生长的最低药物浓度。”\n- 单独用药时药物 $A$ 的MIC：$\\mathrm{MIC}_A = 8 \\, \\mathrm{mg/L}$。\n- 单独用药时药物 $B$ 的MIC：$\\mathrm{MIC}_B = 2 \\, \\mathrm{mg/L}$。\n- 观察到的无生长浓度组合 $(A,B)$：\n  - $(2 \\, \\mathrm{mg/L}, 0.25 \\, \\mathrm{mg/L})$\n  - $(1 \\, \\mathrm{mg/L}, 0.5 \\, \\mathrm{mg/L})$\n  - $(0.5 \\, \\mathrm{mg/L}, 1 \\, \\mathrm{mg/L})$\n- 任务：\n  1. 为每对浓度组合计算药物 $A$ 的协同抑菌指数 ($\\mathrm{FIC}_A$) 和药物 $B$ 的协同抑菌指数 ($\\mathrm{FIC}_B$)。\n  2. 找出最小的协同抑菌指数总和 ($\\mathrm{FIC}_{\\Sigma}$)。\n  3. 对相互作用进行分类。\n  4. 讨论分类临界值的局限性。\n  5. 报告最小的 $\\mathrm{FIC}_{\\Sigma}$ 作为最终答案。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提问明确且客观。它描述了抗菌药物药理学中一种用于量化药物相互作用的标准且广泛使用的方法（棋盘格法）。所提供的数据（$\\mathrm{MIC}$值，组合浓度）是完整且合理的。MIC、FIC以及协同/拮抗作用的概念是该领域的基本原则。该问题要求直接应用这些原则，从而得出一个唯一的、可验证的解。问题内容不存在事实错误、含糊不清或自相矛盾之处。要求讨论解释标准的局限性，这反映了对该主题的深刻理解，而非问题本身的缺陷。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将提供完整解答。\n\n两种抗菌药物（药物 $A$ 和药物 $B$）之间的相互作用，使用协同抑菌指数 (Fractional Inhibitory Concentration, FIC) 来量化。在药物组合中，每种药物的 FIC 是其在有抑制作用的组合中的浓度与其单独使用时的最低抑菌浓度 (MIC) 的比值。\n\n药物 $A$ 的 FIC，记作 $\\mathrm{FIC}_A$，定义为：\n$$ \\mathrm{FIC}_A = \\frac{C_A}{\\mathrm{MIC}_A} $$\n其中 $C_A$ 是在特定孔中抑制可见生长的药物 $A$ 的浓度，而 $\\mathrm{MIC}_A$ 是药物 $A$ 单独使用时的 MIC。\n\n类似地，药物 $B$ 的 FIC，记作 $\\mathrm{FIC}_B$，为：\n$$ \\mathrm{FIC}_B = \\frac{C_B}{\\mathrm{MIC}_B} $$\n其中 $C_B$ 是在同一孔中药物 $B$ 的浓度。\n\nFIC 总和，或称 FIC 指数 ($\\mathrm{FIC}_{\\Sigma}$)，是各 FIC 之和：\n$$ \\mathrm{FIC}_{\\Sigma} = \\mathrm{FIC}_A + \\mathrm{FIC}_B $$\n\n题目给出了单独用药时的 MIC 值：$\\mathrm{MIC}_A = 8 \\, \\mathrm{mg/L}$ 和 $\\mathrm{MIC}_B = 2 \\, \\mathrm{mg/L}$。我们已知三个导致无生长的浓度组合 $(C_A, C_B)$。我们将为每对组合计算 $\\mathrm{FIC}_{\\Sigma}$。\n\n对于第一对组合，$(C_A, C_B) = (2 \\, \\mathrm{mg/L}, 0.25 \\, \\mathrm{mg/L})$：\n$$ \\mathrm{FIC}_A = \\frac{2 \\, \\mathrm{mg/L}}{8 \\, \\mathrm{mg/L}} = \\frac{1}{4} = 0.25 $$\n$$ \\mathrm{FIC}_B = \\frac{0.25 \\, \\mathrm{mg/L}}{2 \\, \\mathrm{mg/L}} = \\frac{1}{8} = 0.125 $$\n$$ \\mathrm{FIC}_{\\Sigma,1} = 0.25 + 0.125 = 0.375 $$\n\n对于第二对组合，$(C_A, C_B) = (1 \\, \\mathrm{mg/L}, 0.5 \\, \\mathrm{mg/L})$：\n$$ \\mathrm{FIC}_A = \\frac{1 \\, \\mathrm{mg/L}}{8 \\, \\mathrm{mg/L}} = \\frac{1}{8} = 0.125 $$\n$$ \\mathrm{FIC}_B = \\frac{0.5 \\, \\mathrm{mg/L}}{2 \\, \\mathrm{mg/L}} = \\frac{1}{4} = 0.25 $$\n$$ \\mathrm{FIC}_{\\Sigma,2} = 0.125 + 0.25 = 0.375 $$\n\n对于第三对组合，$(C_A, C_B) = (0.5 \\, \\mathrm{mg/L}, 1 \\, \\mathrm{mg/L})$：\n$$ \\mathrm{FIC}_A = \\frac{0.5 \\, \\mathrm{mg/L}}{8 \\, \\mathrm{mg/L}} = \\frac{1}{16} = 0.0625 $$\n$$ \\mathrm{FIC}_B = \\frac{1 \\, \\mathrm{mg/L}}{2 \\, \\mathrm{mg/L}} = \\frac{1}{2} = 0.5 $$\n$$ \\mathrm{FIC}_{\\Sigma,3} = 0.0625 + 0.5 = 0.5625 $$\n\n计算出的 $\\mathrm{FIC}_{\\Sigma}$ 值集合为 $\\{0.375, 0.375, 0.5625\\}$。最小协同抑菌指数总和是该集合中的最小值。\n$$ \\mathrm{FIC}_{\\Sigma, \\text{min}} = 0.375 $$\n\n药物相互作用的解释基于最小 $\\mathrm{FIC}_{\\Sigma}$ 值，并采用普遍接受但有一定任意性的临界值：\n- 协同作用 (Synergy): $\\mathrm{FIC}_{\\Sigma} \\le 0.5$\n- 相加作用 (Additivity) 或无关作用 (Indifference): $0.5  \\mathrm{FIC}_{\\Sigma} \\le 4.0$\n- 拮抗作用 (Antagonism): $\\mathrm{FIC}_{\\Sigma}  4.0$\n\n由于最小的 $\\mathrm{FIC}_{\\Sigma}$ 为 $0.375$，小于或等于 $0.5$，因此药物 $A$ 和药物 $B$ 对此分离株的相互作用被归类为协同作用。\n\n按要求，有必要讨论这些临界值的局限性。其主要局限性在于它们的任意性。用于判断协同作用的临界值 $0.5$ 是一个惯例，并非源自基本的生物物理原理。这可能导致错误的分类，特别是对于接近边界的值，例如 $\\mathrm{FIC}_{\\Sigma}$ 为 $0.51$ 时，它将被归类为非协同作用，尽管在实验上它与 $0.49$ 的值几乎无法区分。其次，棋盘格法本身也存在技术局限性。使用两倍系列稀释法将一个连续的浓度空间施加到一个离散的网格上，这意味着真实的抑制浓度位于一个范围内，而不是观察到的精确值。这引入了实验误差和可变性。结果很难完美重现，微小的变异就可能使计算出的 $\\mathrm{FIC}_{\\Sigma}$ 跨越分类边界。最后，也是最关键的一点，体外协同作用（如此处测得的）并不能保证体内的临床疗效。活体宿主的复杂环境，涉及药代动力学（药物的吸收、分布、代谢、排泄）和宿主-病原体相互作用，可以深刻地改变药物效果。在试管中被归类为协同的相互作用，在患者体内可能表现为无关甚至拮抗，反之亦然。因此，这些体外分类仅作为初步筛选工具，而非临床结果的确定性预测。\n\n问题要求以单个精确数字形式给出最小的协同抑菌指数总和 $\\mathrm{FIC}_{\\Sigma}$。计算出的最小值为 $0.375$，可以表示为精确分数 $\\frac{3}{8}$。", "answer": "$$\\boxed{\\frac{3}{8}}$$", "id": "4623455"}, {"introduction": "传统的基于最低抑菌浓度 (MIC) 的分析在面对具有“拖尾生长”现象的微生物时会遇到挑战，因为其终点不明确。本练习 ([@problem_id:4623412]) 旨在让您超越简单的终点判断，应用一种基于连续光密度数据的更稳健方法——分数抑制指数 (FII)。这个实践突显了为特定生物学情境选择正确分析工具的重要性，并深化了对相互作用模型的理解。", "problem": "一个已知具有拖尾生长现象的酵母菌种的临床分离株，在肉汤微量稀释法中测试了两种抗真菌药物，即药物 $A$ 和药物 $B$。在 $24\\,\\mathrm{h}$ 后测量了在 $600\\,\\mathrm{nm}$ 处的光密度（OD）；未经处理的对照组的 $OD_0 = 0.80$。在浓度 $c$ 下的抑制作用根据第一性原理定义为分数 $$I(c) = 1 - \\frac{OD(c)}{OD_0}$$。最小抑菌浓度（MIC）通常操作化定义为使 $I(c)$ 超过预选阈值的最小浓度 $c$。部分抑菌浓度（FIC）指数通常使用 MIC 计算，以对联合效应（协同、相加、拮抗）进行分类。具有拖尾生长现象的微生物在离散稀释取样下通常产生浅而连续的剂量-反应曲线，其终点不明确。\n\n单药数据：\n- 药物 $A$：在 $c_A = 0.00\\,\\mathrm{mg/L}$ 时，$OD = 0.80$；在 $c_A = 0.50\\,\\mathrm{mg/L}$ 时，$OD = 0.64$；在 $c_A = 1.00\\,\\mathrm{mg/L}$ 时，$OD = 0.48$；在 $c_A = 2.00\\,\\mathrm{mg/L}$ 时，$OD = 0.36$；在 $c_A = 4.00\\,\\mathrm{mg/L}$ 时，$OD = 0.24$；在 $c_A = 8.00\\,\\mathrm{mg/L}$ 时，$OD = 0.12$。\n- 药物 $B$：在 $c_B = 0.00\\,\\mathrm{mg/L}$ 时，$OD = 0.80$；在 $c_B = 0.25\\,\\mathrm{mg/L}$ 时，$OD = 0.72$；在 $c_B = 0.50\\,\\mathrm{mg/L}$ 时，$OD = 0.56$；在 $c_B = 1.00\\,\\mathrm{mg/L}$ 时，$OD = 0.40$；在 $c_B = 2.00\\,\\mathrm{mg/L}$ 时，$OD = 0.28$；在 $c_B = 4.00\\,\\mathrm{mg/L}$ 时，$OD = 0.16$。\n\n联合用药数据（固定比例测试点）：\n- 药物 $A$ 在 $c_A = 2.00\\,\\mathrm{mg/L}$ 加上药物 $B$ 在 $c_B = 1.00\\,\\mathrm{mg/L}$ 时，得到 $OD = 0.16$。\n\n假设剂量-反应是单调的，并且相邻测试浓度之间存在局部线性关系以进行插值。请评判对于这种具有拖尾生长现象的分离株，使用基于 MIC 的终点计算 FIC 指数的适用性，并选择一个提出了使用光密度抑制分数来对观察到的联合作用进行分类的定量合理替代方案的选项，包括根据所提供数据进行的任何必要计算。\n\nA. 基于 MIC 的终点在拖尾生长情况下仍然稳健，因为任何阈值选择都会产生等效的 FIC 指数。合适的替代方法是对抑制百分比使用 Bliss 独立模型，计算预期的联合抑制作用为 $$I_{\\mathrm{exp}} = I_A + I_B - I_A I_B$$ 在 $c_A = 2.00\\,\\mathrm{mg/L}$ 和 $c_B = 1.00\\,\\mathrm{mg/L}$ 时，此处得出 $I_{\\mathrm{exp}} \\approx 0.55 + 0.50 - (0.55)(0.50) = 0.775$，因此观察到的 $I_{AB} = 0.80$ 表明是拮抗作用。\n\nB. 在拖尾生长情况下，基于 MIC 的终点是有问题的，因为终点依赖于阈值且量化粗糙，违反了相加性分析所依据的固定效应假设。一个更合适的方法是在固定效应水平上操作，使用光密度定义的抑制分数，通过插值计算达到选定效应（例如，$80\\%$ 抑制）的单药浓度。在效应 $p$ 下的部分抑制指数（FII）为 $$\\mathrm{FII}_p = \\frac{c_A}{IC_{p,A}} + \\frac{c_B}{IC_{p,B}}$$, 其中 $IC_{p,\\cdot}$ 是达到抑制率 $p$ 的单药浓度。根据数据，$IC_{80,B} = 4.00\\,\\mathrm{mg/L}$，并且通过在 $4.00\\,\\mathrm{mg/L}$（$OD = 0.24$）和 $8.00\\,\\mathrm{mg/L}$（$OD = 0.12$）之间进行线性插值，$IC_{80,A} \\approx 6.67\\,\\mathrm{mg/L}$。因此在 $c_A = 2.00\\,\\mathrm{mg/L}$ 和 $c_B = 1.00\\,\\mathrm{mg/L}$ 时，$$\\mathrm{FII}_{80} \\approx \\frac{2.00}{6.67} + \\frac{1.00}{4.00} \\approx 0.30 + 0.25 = 0.55$$, 表明是协同作用（小于 $1$）。\n\nC. 由于时间依赖的残留效应，源自 MIC 的 FIC 指数在拖尾生长情况下会失效，因此正确的补救措施是整合 OD-浓度曲线并比较曲线下面积（AUC）；如果联合用药的 AUC 低于任一单药的 AUC，则相互作用是协同的。将此标准应用于所提供的数据，会将该联合作用分类为拮抗，因为单药的 AUC 更小。\n\nD. 在拖尾生长情况下，MIC 终点不可靠，因此最佳替代方法是在测试的联合用药点计算一个比率 $$R = \\frac{I_{AB}}{I_A + I_B}$$；当 $R  1$ 时，相互作用是协同的。使用 $I_A(2.00\\,\\mathrm{mg/L}) = 0.55$，$I_B(1.00\\,\\mathrm{mg/L}) = 0.50$ 和 $I_{AB} = 0.80$，可以得到 $R \\approx \\frac{0.80}{1.05} \\approx 0.76$，这表明是协同作用。\n\nE. 在拖尾生长情况下，MIC 终点具有误导性，但这可以通过将阈值降低到 $50\\%$ 抑制以减少模糊性来解决，并将分数指数定义为 $$\\frac{c_A + c_B}{IC_{50,A} + IC_{50,B}}$$。使用 $IC_{50,A} \\approx 1.00\\,\\mathrm{mg/L}$ 和 $IC_{50,B} = 1.00\\,\\mathrm{mg/L}$，在 $c_A = 2.00\\,\\mathrm{mg/L}$ 和 $c_B = 1.00\\,\\mathrm{mg/L}$ 的联合用药得到 $$\\frac{2.00 + 1.00}{1.00 + 1.00} = 1.50$$, 表明是拮抗作用。", "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取已知信息**\n- **微生物及条件**：一个已知具有拖尾生长现象的酵母菌种的临床分离株。\n- **实验方法**：肉汤微量稀释法，在 $24\\,\\mathrm{h}$ 后测量 $600\\,\\mathrm{nm}$ 处的光密度（OD）。\n- **对照组**：未经处理的对照组 $OD_0 = 0.80$。\n- **抑制作用的定义**：$I(c) = 1 - \\frac{OD(c)}{OD_0}$。\n- **MIC 的定义**：使 $I(c)$ 超过预选阈值的最小浓度 $c$。\n- **FIC 指数的定义**：使用 MIC 计算以对联合效应进行分类。\n- **单药数据（药物 $A$）**：\n  - $c_A = 0.00\\,\\mathrm{mg/L}$, $OD = 0.80$\n  - $c_A = 0.50\\,\\mathrm{mg/L}$, $OD = 0.64$\n  - $c_A = 1.00\\,\\mathrm{mg/L}$, $OD = 0.48$\n  - $c_A = 2.00\\,\\mathrm{mg/L}$, $OD = 0.36$\n  - $c_A = 4.00\\,\\mathrm{mg/L}$, $OD = 0.24$\n  - $c_A = 8.00\\,\\mathrm{mg/L}$, $OD = 0.12$\n- **单药数据（药物 $B$）**：\n  - $c_B = 0.00\\,\\mathrm{mg/L}$, $OD = 0.80$\n  - $c_B = 0.25\\,\\mathrm{mg/L}$, $OD = 0.72$\n  - $c_B = 0.50\\,\\mathrm{mg/L}$, $OD = 0.56$\n  - $c_B = 1.00\\,\\mathrm{mg/L}$, $OD = 0.40$\n  - $c_B = 2.00\\,\\mathrm{mg/L}$, $OD = 0.28$\n  - $c_B = 4.00\\,\\mathrm{mg/L}$, $OD = 0.16$\n- **联合用药数据**：\n  - $c_A = 2.00\\,\\mathrm{mg/L}$ 加上 $c_B = 1.00\\,\\mathrm{mg/L}$ 时，得到 $OD = 0.16$。\n- **假设**：剂量-反应是单调的，并且相邻测试浓度之间存在局部线性关系以进行插值。\n- **任务**：评判对于该分离株使用基于 MIC 的 FIC 指数的适用性，并选择一个提出了定量合理替代方案的选项。\n\n**步骤 2：使用提取的已知信息进行验证**\n- **科学依据**：该问题在定量药理学和临床微生物学的既定原则方面基础扎实。肉汤微量稀释法、拖尾生长、MIC、FIC 指数、Loewe 相加性（隐含在 FII 中）和 Bliss 独立模型等概念都是该领域的标准概念。\n- **问题的适定性**：该问题提供了所有必要的数据和清晰的插值指令（局部线性），使其完全指定且可解。问题没有歧义。\n- **客观性**：问题以精确、客观的语言陈述。数据内部一致（例如，零药物浓度下的 $OD$ 与 $OD_0$ 匹配；$OD$ 随浓度增加而减少）。\n- **结论**：问题陈述有效。检查清单中没有发现任何缺陷。它在科学上是合理的，适定的，并且是客观的。\n\n**步骤 3：结论与行动**\n- **结论**：问题有效。\n- **行动**：继续进行求解。\n\n**求解推导**\n\n首先，问题的核心要求对具有拖尾生长现象的微生物使用基于 MIC 的终点进行评判。拖尾生长的特点是剂量-反应曲线平缓，即药物浓度的显著增加仅导致抑制作用的微小增加。因此，测得的 MIC 对所选的具体抑制阈值（例如，$50\\%$，$80\\%$，$90\\%$）高度敏感。部分抑菌浓度（FIC）指数定义为 $\\mathrm{FIC} = \\frac{c_{A, \\text{combo}}}{\\mathrm{MIC}_A} + \\frac{c_{B, \\text{combo}}}{\\mathrm{MIC}_B}$。由于 $\\mathrm{MIC}_A$ 和 $\\mathrm{MIC}_B$ 不稳定且依赖于任意阈值，因此得出的 FIC 指数也不可靠。这违反了固定效应分析的原则，而该原则是 FIC 指数（等效线图分析的一种简化形式）的理论基础。因此，稳健的分析必须使用不依赖于单一、不明确终点的方法。\n\n接下来，我们使用公式 $I(c) = 1 - \\frac{OD(c)}{OD_0}$（其中 $OD_0 = 0.80$）为每个数据点计算抑制百分比。\n\n**药物 A 的抑制作用：**\n- $I_A(2.00\\,\\mathrm{mg/L}) = 1 - \\frac{0.36}{0.80} = 1 - 0.45 = 0.55$ (即 $55\\%$ 抑制)\n- $I_A(4.00\\,\\mathrm{mg/L}) = 1 - \\frac{0.24}{0.80} = 1 - 0.30 = 0.70$ (即 $70\\%$ 抑制)\n- $I_A(8.00\\,\\mathrm{mg/L}) = 1 - \\frac{0.12}{0.80} = 1 - 0.15 = 0.85$ (即 $85\\%$ 抑制)\n\n**药物 B 的抑制作用：**\n- $I_B(1.00\\,\\mathrm{mg/L}) = 1 - \\frac{0.40}{0.80} = 1 - 0.50 = 0.50$ (即 $50\\%$ 抑制)\n- $I_B(4.00\\,\\mathrm{mg/L}) = 1 - \\frac{0.16}{0.80} = 1 - 0.20 = 0.80$ (即 $80\\%$ 抑制)\n\n**联合用药的抑制作用：**\n- 对于 $c_A = 2.00\\,\\mathrm{mg/L}$ 和 $c_B = 1.00\\,\\mathrm{mg/L}$ 的联合用药，观察到的 $OD$ 为 $0.16$。\n- $I_{AB}(2.00, 1.00) = 1 - \\frac{0.16}{0.80} = 1 - 0.20 = 0.80$ (即 $80\\%$ 抑制)。\n\n现在我们评估每个选项。\n\n**选项 A 评估**\n如上所述，“基于 MIC 的终点在拖尾生长情况下仍然稳健”的说法根本上是错误的。提出的替代方法是 Bliss 独立模型，其预期的抑制作用为 $I_{\\mathrm{exp}} = I_A + I_B - I_A I_B$。\n在指定浓度 $c_A = 2.00\\,\\mathrm{mg/L}$ 和 $c_B = 1.00\\,\\mathrm{mg/L}$ 下，我们有 $I_A = 0.55$ 和 $I_B = 0.50$。\n在 Bliss 独立模型下，预期的抑制作用为 $I_{\\mathrm{exp}} = 0.55 + 0.50 - (0.55)(0.50) = 1.05 - 0.275 = 0.775$。\n观察到的抑制作用为 $I_{AB} = 0.80$。\n由于观察到的抑制作用（$0.80$）大于预期的抑制作用（$0.775$），在 Bliss 模型下，该相互作用被分类为协同作用。选项 A 声称这表明是拮抗作用。这是不正确的。初始前提和最终结论都有缺陷。\n**结论：不正确。**\n\n**选项 B 评估**\n该选项正确地指出“在拖尾生长情况下，基于 MIC 的终点是有问题的”。它提出了一个基于固定效应分析的替代方案，使用部分抑制指数（FII），这是等效线图分析（Loewe 相加模型）的正确应用。FII 分析必须在观察到联合用药所产生的效应水平上进行，即 $p = 0.80$ 或 $80\\%$ 抑制。\n公式为 $\\mathrm{FII}_p = \\frac{c_A}{IC_{p,A}} + \\frac{c_B}{IC_{p,B}}$，其中 $IC_{p,A}$ 和 $IC_{p,B}$ 是各自单独产生抑制率 $p$ 的药物浓度。\n我们需要找到 $IC_{80,A}$ 和 $IC_{80,B}$。\n- 对于药物 B，我们直接从数据中看到 $I_B(4.00\\,\\mathrm{mg/L}) = 0.80$。因此，$IC_{80,B} = 4.00\\,\\mathrm{mg/L}$。\n- 对于药物 A，$0.80$ 的抑制率位于 $I_A(4.00) = 0.70$ 和 $I_A(8.00) = 0.85$ 之间。我们使用指定的局部线性关系进行插值。这两个点是 $(c, I) = (4.00, 0.70)$ 和 $(8.00, 0.85)$。\n通过这两点的直线方程为：\n$$I(c) - 0.70 = \\frac{0.85 - 0.70}{8.00 - 4.00} (c - 4.00)$$\n$$I(c) - 0.70 = \\frac{0.15}{4.00} (c - 4.00) = 0.0375 (c - 4.00)$$\n为了找到 $IC_{80,A}$，我们设 $I(c) = 0.80$：\n$$0.80 - 0.70 = 0.0375 (IC_{80,A} - 4.00)$$\n$$0.10 = 0.0375 (IC_{80,A} - 4.00)$$\n$$IC_{80,A} - 4.00 = \\frac{0.10}{0.0375} = \\frac{8}{3} \\approx 2.667$$\n$$IC_{80,A} = 4.00 + \\frac{8}{3} = \\frac{12+8}{3} = \\frac{20}{3} \\approx 6.67\\,\\mathrm{mg/L}$$\n现在我们计算联合用药 $(c_A, c_B) = (2.00, 1.00)$ 的 FII，该组合产生了 $80\\%$ 的效应：\n$$\\mathrm{FII}_{80} = \\frac{2.00\\,\\mathrm{mg/L}}{IC_{80,A}} + \\frac{1.00\\,\\mathrm{mg/L}}{IC_{80,B}} = \\frac{2.00}{20/3} + \\frac{1.00}{4.00} = \\frac{6.00}{20} + 0.25 = 0.30 + 0.25 = 0.55$$\n解释是：FII $ 1$ 表示协同作用，FII $= 1$ 表示相加作用，FII $ 1$ 表示拮抗作用。此处，$\\mathrm{FII}_{80} = 0.55  1$，表明是协同作用。\n该选项中提出的评判、方法、计算和结论都是正确的。\n**结论：正确。**\n\n**选项 C 评估**\n该选项正确地批评了源自 MIC 的指数，但将失败归因于“时间依赖的残留效应”，这不如阈值依赖性问题精确。提出的补救措施是比较剂量-反应曲线的曲线下面积（AUC），这在协同作用评估方面存在概念性缺陷。没有一个标准的、普遍接受的方法来定义一个可以直接与单药 AUC 比较以确定协同作用的“联合用药 AUC”。所述的标准，“如果联合用药的 AUC 低于任一单药的 AUC，则相互作用是协同的”，是一个没有理论基础的临时规则。\n**结论：不正确。**\n\n**选项 D 评估**\n该选项正确地指出了 MIC 终点的不可靠性。然而，它提出了一个替代比率，$R = \\frac{I_{AB}}{I_A + I_B}$。这对应于一个朴素的相加模型，其中预期的抑制作用是单个抑制作用的简单总和。这个模型在物理上是无意义的，因为 $I_A + I_B$ 可能超过 $1$。在测试点，$I_A + I_B = 0.55 + 0.50 = 1.05$，这作为抑制百分比是不可能的。此外，该选项声称 $R  1$ 表示协同作用。在这个（有缺陷的）模型的框架中，协同作用意味着观察到的效果大于预期的总和，即 $I_{AB}  I_A + I_B$，这意味着 $R  1$。该选项的解释是相反的；$R \\approx 0.76$ 在这个模型中将意味着拮抗作用。\n**结论：不正确。**\n\n**选项 E 评估**\n该选项正确地指出了 MIC 终点的问题，但提出的“解决方案”是将阈值降低到 $50\\%$。这并不能解决根本问题，因为结果仍然依赖于任意阈值。更重要的是，它提出了一个分数指数 $\\frac{c_A + c_B}{IC_{50,A} + IC_{50,B}}$，这在药效学相互作用理论中没有依据。Loewe 相加模型要求对剂量分数（$\\frac{c}{IC}$）求和，而不是原始浓度。这个提议的指数是一个无意义的构造。此外，其对 $IC_{50,A}$ 的计算是错误的。在 $I_A(1.00)=0.40$ 和 $I_A(2.00)=0.55$ 之间插值，得到 $IC_{50,A} \\approx 1.67\\,\\mathrm{mg/L}$，而不是声称的 $1.00\\,\\mathrm{mg/L}$。\n**结论：不正确。**\n\n**结论**\n选项 B 提供了唯一科学上和定量上合理的分析。它正确地评判了在拖尾生长背景下标准 FIC 指数的问题，并应用了适当的替代方案——固定效应等效线图分析（FII），同时使用了基于所提供数据的正确计算。", "answer": "$$\\boxed{B}$$", "id": "4623412"}, {"introduction": "静态终点测定法无法捕捉药物与细菌在时间维度上的动态相互作用。本项高级实践 ([@problem_id:4623391]) 将您带入药代动力学/药效动力学 (PK/PD) 建模的世界，通过数值模拟来探索药物组合的动态效应。这项练习要求您编写代码求解微分方程，这反映了现代定量药理学在更真实的时间依赖性环境中理解和预测抗菌药物组合效果的前沿方法。", "problem": "考虑一个暴露于两种抗菌剂下的细菌种群，其药物浓度为随时间变化的游离浓度曲线。假设这是一个单一、充分混合的隔室，并且其动力学是确定性的。细菌密度由 $N(t)$ 表示，单位为集落形成单位/毫升 (cfu/mL)。在没有药物的情况下，种群遵循逻辑斯谛增长，其内禀增长率为 $r$ (单位 $\\mathrm{h}^{-1}$)，环境承载力为 $K$ (单位 cfu/mL)。当存在药物时，杀菌作用被建模为作用于 $N(t)$ 的一个风险 (hazard)。\n\n待使用的基本原理和定义：\n- 逻辑斯谛增长定律：在没有药物的情况下，净增殖与当前密度成正比并存在饱和，由 $r$ 和 $K$ 控制。\n- 每种药物都有一个单调递增的药效学 (PD) 暴露-反应关系（Hill 型 S 形曲线），该关系将浓度映射到杀菌风险，其参数为 $E_{\\max}$ (单位 $\\mathrm{h}^{-1}$)，$EC_{50}$ (单位 $\\mathrm{mg/L}$)，以及 Hill 系数 $h$ (无量纲)。\n- 独立风险的可加性：在零相互作用基线下，两种药物的瞬时风险相加。\n\n给定每种药物的模拟游离浓度-时间曲线，其形式为指数衰减剂量的总和。对于在时间 $t_{d}$ (单位 h) 给药、初始游离浓度为 $C_{0}$ (单位 mg/L)、消除半衰期为 $t_{1/2}$ (单位 h) 的一次给药，其在时间 $t$ 对浓度的贡献为 $C_{0}\\,2^{-(t-t_{d})/t_{1/2}}$ (当 $t \\ge t_{d}$) ，否则为 $0$。在时间 $t$ 时一种药物的总游离浓度是其所有剂量贡献的总和。\n\n对于药物 $i \\in \\{A,B\\}$，其作为瞬时浓度 $C_{i}(t)$ 函数的 PD 风险是一个 Hill 型函数，它随 $C_{i}(t)$ 增加而增加，并以 $E_{\\max,i}$ 为上界。在可加性（零相互作用）基线下，联合风险是各个风险之和。观测到的联合效应通过在可加性风险上增加一个相互作用项来建模，该项与两种药物归一化的 PD 效应的乘积以及一个相互作用缩放参数成正比。相互作用项可以为正（协同作用）或为负（拮抗作用），但总风险在任何时候都不能为负。\n\n你的任务：\n- 对于每个提供的测试用例，在两种条件下对细菌密度 $N(t)$ 进行 $48\\,\\mathrm{h}$ 的数值积分：可加性基线条件和包含相互作用项的观测联合作用条件。使用 $N(0)=N_{0}$ 作为初始条件。时间单位为 $\\mathrm{h}$，浓度单位为 $\\mathrm{mg/L}$，密度单位为 cfu/mL。\n- 判断在 $t=48\\,\\mathrm{h}$ 时，观测到的联合作用相较于可加性基线是否将最终密度降低了至少一个阈值 $\\Delta=0.05$ ($\\log_{10}$ 单位)，即，如果 $\\log_{10}(N_{\\text{add}}(48))-\\log_{10}(N_{\\text{obs}}(48)) \\ge \\Delta$，则判定为协同作用，否则为无协同作用。不进行任何中间值的四舍五入；比较应在全精度浮点值上进行。\n\n待实现的数学规范：\n- 带有药物风险 $k(t)$ 的种群动力学：\n$$\n\\frac{dN}{dt} \\;=\\; r\\,N\\left(1 - \\frac{N}{K}\\right) \\;-\\; k(t)\\,N,\n$$\n其中 $N(t)$ 不应变为负数。\n- 在时间 $t$ 时，药物 $i \\in \\{A,B\\}$ 的单个 PD 风险：\n$$\nk_{i}(t) \\;=\\; E_{\\max,i}\\,\\frac{C_{i}(t)^{h_{i}}}{EC_{50,i}^{h_{i}} + C_{i}(t)^{h_{i}}}.\n$$\n- 可加性基线风险：\n$$\nk_{\\text{add}}(t) \\;=\\; k_{A}(t) + k_{B}(t).\n$$\n- 包含相互作用的观测联合风险：\n$$\n\\sigma(t) \\;=\\; \\eta\\,E_{\\max,\\sigma}\\,\\left(\\frac{C_{A}(t)^{h_{A}}}{EC_{50,A}^{h_{A}} + C_{A}(t)^{h_{A}}}\\right)\\left(\\frac{C_{B}(t)^{h_{B}}}{EC_{50,B}^{h_{B}} + C_{B}(t)^{h_{B}}}\\right),\n$$\n$$\nk_{\\text{obs}}(t) \\;=\\; \\max\\big(0,\\;k_{\\text{add}}(t) + \\sigma(t)\\big),\n$$\n其中 $E_{\\max,\\sigma}$ (单位 $\\mathrm{h}^{-1}$) 缩放相互作用的最大幅度，$\\eta$ (无量纲) 设定其符号和强度。\n\n测试套件：\n为以下 $4$ 个参数集提供结果。所有量均使用上述单位。\n\n- 情况 1 (一般协同作用情况)：\n  - $r=0.7$, $K=10^{9}$, $N_{0}=10^{6}$。\n  - 药物 A：$E_{\\max,A}=1.2$, $EC_{50,A}=1.5$, $h_{A}=1.2$，在 $t=\\{0,12,24,36\\}$ 时给药，$C_{0,A}=8.0$, $t_{1/2,A}=8.0$。\n  - 药物 B：$E_{\\max,B}=0.9$, $EC_{50,B}=1.0$, $h_{B}=1.0$，在 $t=\\{0,24\\}$ 时给药，$C_{0,B}=5.0$, $t_{1/2,B}=6.0$。\n  - 相互作用：$\\eta=0.6$, $E_{\\max,\\sigma}=0.8$。\n\n- 情况 2 (拮抗作用情况)：\n  - 与情况 1 相同，除了 $\\eta=-0.6$ 和 $E_{\\max,\\sigma}=0.8$。\n\n- 情况 3 (可加性基线情况)：\n  - 与情况 1 相同，除了 $\\eta=0.0$ 和 $E_{\\max,\\sigma}=0.8$。\n\n- 情况 4 (低暴露边缘情况)：\n  - $r=0.7$, $K=10^{9}$, $N_{0}=10^{6}$。\n  - 药物 A：$E_{\\max,A}=1.2$, $EC_{50,A}=1.5$, $h_{A}=1.2$，在 $t=\\{0,12,24,36\\}$ 时给药，$C_{0,A}=0.5$, $t_{1/2,A}=8.0$。\n  - 药物 B：$E_{\\max,B}=0.9$, $EC_{50,B}=1.0$, $h_{B}=1.0$，在 $t=\\{0,24\\}$ 时给药，$C_{0,B}=0.4$, $t_{1/2,B}=6.0$。\n  - 相互作用：$\\eta=0.8$, $E_{\\max,\\sigma}=0.8$。\n\n你的程序应生成单行输出，其中包含这 $4$ 种情况的协同作用判定结果，形式为用方括号括起来的逗号分隔列表，例如 $[{\\tt True},{\\tt False},{\\tt False},{\\tt True}]$。每个元素是一个布尔值，表示在 $48\\,\\mathrm{h}$ 时，观测效应是否在 $\\log_{10}$ 单位上比可加性模型至少超出 $\\Delta=0.05$。", "solution": "用户提供了一个在定量系统药理学领域中定义明确的问题，需要对其进行验证和求解。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n-   **种群动力学**：细菌种群密度 $N(t)$ 遵循常微分方程 (ODE)：\n    $$ \\frac{dN}{dt} = r N \\left(1 - \\frac{N}{K}\\right) - k(t) N $$\n    初始条件为 $N(0) = N_0$。参数包括内禀增长率 $r$、环境承载力 $K$ 以及随时间变化的总药物杀伤风险 $k(t)$。\n\n-   **药物浓度**：在时间 $t$ 时，药物 $i \\in \\{A, B\\}$ 的浓度（表示为 $C_i(t)$）是多次给药贡献的总和。在时间 $t_d$ 单次给药，初始浓度为 $C_0$，半衰期为 $t_{1/2}$，其贡献为 $C_0 \\cdot 2^{-(t-t_d)/t_{1/2}}$ (当 $t \\ge t_d$ 时)。\n\n-   **药效学 (PD)**：药物 $i$ 产生的风险 $k_i(t)$ 遵循 Hill 型函数：\n    $$ k_i(t) = E_{\\max,i} \\frac{C_i(t)^{h_i}}{EC_{50,i}^{h_i} + C_i(t)^{h_i}} $$\n    参数包括最大效应 $E_{\\max,i}$、半数最大效应浓度 $EC_{50,i}$ 和 Hill 系数 $h_i$。\n\n-   **相互作用模型**：\n    -   **可加性基线**：$k_{\\text{add}}(t) = k_A(t) + k_B(t)$。\n    -   **观测到的相互作用**：$k_{\\text{obs}}(t) = \\max\\left(0, k_{\\text{add}}(t) + \\sigma(t)\\right)$，其中相互作用项 $\\sigma(t)$ 为：\n        $$ \\sigma(t) = \\eta E_{\\max,\\sigma} \\left(\\frac{C_A(t)^{h_A}}{EC_{50,A}^{h_A} + C_A(t)^{h_A}}\\right) \\left(\\frac{C_B(t)^{h_B}}{EC_{50,B}^{h_B} + C_B(t)^{h_B}}\\right) $$\n    参数 $\\eta$ 和 $E_{\\max,\\sigma}$ 控制相互作用的性质和大小。\n\n-   **任务**：\n    1.  使用 $k_{\\text{add}}(t)$ 和 $k_{\\text{obs}}(t)$ 分别对 $N(t)$ 的 ODE 进行从 $t=0$ 到 $t=48\\,\\mathrm{h}$ 的数值积分，以求得最终密度 $N_{\\text{add}}(48)$ 和 $N_{\\text{obs}}(48)$。\n    2.  如果 $\\log_{10}(N_{\\text{add}}(48)) - \\log_{10}(N_{\\text{obs}}(48)) \\ge \\Delta$（其中阈值 $\\Delta = 0.05$），则将相互作用分类为协同作用。\n\n-   **测试用例**：提供了四个具体的参数集。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题使用了药代动力学和药效学 (PK/PD) 的标准模型：逻辑斯谛增长、一级药物消除（由半衰期表示）以及用于剂量-反应关系的 Hill 方程。将药物相互作用表述为对可加性基线的修正，是药理学中一种常见且有效的方法。该模型在科学上是合理的。\n-   **适定性**：问题要求解一个一阶 ODE 的初值问题。ODE 的右侧对于 $N(t)$ 是连续可微的，这保证了局部解的存在性和唯一性。由于参数行为良好，在指定区间内存在唯一且稳定的解。该问题是适定的。\n-   **客观性**：所有定义、参数和标准都以精确的数学术语表述。针对此任务，协同作用的定义是客观且明确的。问题没有歧义。\n-   **缺陷核对清单**：问题未违反任何无效性标准。它在建模的背景下是完整的、一致的、现实的，并且需要非平凡的计算。$N(t)$ 的非负性由 ODE 结构自然处理，因为如果 $N=0$，则 $dN/dt=0$，从而防止解在 $N_0  0$ 时跨越到负值。\n\n**第 3 步：结论与行动**\n\n此问题是**有效的**。将提供一个解决方案。\n\n### 解决方案设计\n\n问题的核心是对一个非线性、非自治的常微分方程进行数值积分。解决方案通过一系列原则性步骤展开。\n\n**1. 为保证数值稳定性的对数变换**\n细菌密度 $N(t)$ 可能跨越多个数量级。直接对 $N(t)$ 的 ODE 进行积分容易出现数值不稳定性问题和浮点误差。一种标准方法是求解密度的自然对数 $y(t) = \\ln(N(t))$。这种变换将动力学中的指数增长部分线性化，压缩了动态范围，并自然地保证了 $N(t)$ 的正性。导数 $dy/dt$ 使用链式法则求得：\n$$ \\frac{dy}{dt} = \\frac{d(\\ln N)}{dt} = \\frac{1}{N} \\frac{dN}{dt} $$\n代入原始的 $dN/dt$ ODE：\n$$ \\frac{dy}{dt} = \\frac{1}{N} \\left[ r N \\left(1 - \\frac{N}{K}\\right) - k(t) N \\right] = r \\left(1 - \\frac{N}{K}\\right) - k(t) $$\n用 $e^y$ 替换 $N$，我们得到待求解的变换后的 ODE：\n$$ \\frac{dy}{dt} = r \\left(1 - \\frac{e^y}{K}\\right) - k(t) $$\n初始条件为 $y(0) = \\ln(N_0)$。\n\n**2. 时间依赖函数的实现**\n总杀伤率 $k(t)$ 是一个复杂的时间函数，必须在积分前构建。这包括三个阶段：\n-   **药物浓度曲线**：对于每种药物 $i \\in \\{A, B\\}$，总浓度 $C_i(t)$ 通过对所有已给药剂量的贡献求和来计算。设药物 $i$ 的剂量集合为 $D_i = \\{(C_{0,j}, t_{d,j})\\}$。那么：\n    $$ C_i(t) = \\sum_{(C_{0,j}, t_{d,j}) \\in D_i, t \\ge t_{d,j}} C_{0,j} \\cdot 2^{-(t-t_{d,j})/t_{1/2,i}} $$\n-   **单个风险和联合风险**：将随时间变化的浓度 $C_A(t)$ 和 $C_B(t)$ 输入到它们各自的 Hill 函数中，以计算单个风险 $k_A(t)$ 和 $k_B(t)$。然后根据问题规范，用它们来定义可加性风险 $k_{\\text{add}}(t)$ 和观测风险 $k_{\\text{obs}}(t)$。\n\n**3. 数值积分**\n问题需要求解两个不同的初值问题，一个用于可加性模型，另一个用于观测相互作用模型：\n-   **可加性模型**：$\\frac{dy_{\\text{add}}}{dt} = r(1 - e^{y_{\\text{add}}}/K) - k_{\\text{add}}(t)$，其中 $y_{\\text{add}}(0) = \\ln(N_0)$。\n-   **观测模型**：$\\frac{dy_{\\text{obs}}}{dt} = r(1 - e^{y_{\\text{obs}}}/K) - k_{\\text{obs}}(t)$，其中 $y_{\\text{obs}}(0) = \\ln(N_0)$。\n这些 ODE 将在时间区间 $[0, 48]\\,\\mathrm{h}$ 上求解。我们将使用一个稳健的、自适应步长的 ODE 求解器，具体来说是 Python 的 `scipy.integrate` 库中的 `solve_ivp` 函数，它实现了像 Dormand-Prince (RK45) 算法这样的方法。这通过调整步长以满足指定的误差容限来确保解的准确性。\n\n**4. 协同作用评估**\n在获得数值解 $y_{\\text{add}}(48)$ 和 $y_{\\text{obs}}(48)$ 后，最后一步是评估协同作用标准。在 $\\log_{10}$ 空间中的差异计算如下：\n$$ \\log_{10}(N_{\\text{add}}(48)) - \\log_{10}(N_{\\text{obs}}(48)) = \\frac{\\ln(N_{\\text{add}}(48))}{\\ln(10)} - \\frac{\\ln(N_{\\text{obs}}(48))}{\\ln(10)} = \\frac{y_{\\text{add}}(48) - y_{\\text{obs}}(48)}{\\ln(10)} $$\n然后将此计算出的差异与给定的阈值 $\\Delta = 0.05$进行比较。如果差异大于或等于 $\\Delta$，则结果为协同作用 (`True`)；否则，不是 (`False`)。此过程将应用于所有四个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general synergy case)\n        {\n            \"r\": 0.7, \"K\": 1e9, \"N0\": 1e6,\n            \"drug_A\": {\"Emax\": 1.2, \"EC50\": 1.5, \"h\": 1.2, \"doses\": [(8.0, 0), (8.0, 12), (8.0, 24), (8.0, 36)], \"t_half\": 8.0},\n            \"drug_B\": {\"Emax\": 0.9, \"EC50\": 1.0, \"h\": 1.0, \"doses\": [(5.0, 0), (5.0, 24)], \"t_half\": 6.0},\n            \"interaction\": {\"eta\": 0.6, \"Emax_sigma\": 0.8}\n        },\n        # Case 2 (antagonism case)\n        {\n            \"r\": 0.7, \"K\": 1e9, \"N0\": 1e6,\n            \"drug_A\": {\"Emax\": 1.2, \"EC50\": 1.5, \"h\": 1.2, \"doses\": [(8.0, 0), (8.0, 12), (8.0, 24), (8.0, 36)], \"t_half\": 8.0},\n            \"drug_B\": {\"Emax\": 0.9, \"EC50\": 1.0, \"h\": 1.0, \"doses\": [(5.0, 0), (5.0, 24)], \"t_half\": 6.0},\n            \"interaction\": {\"eta\": -0.6, \"Emax_sigma\": 0.8}\n        },\n        # Case 3 (additive baseline case)\n        {\n            \"r\": 0.7, \"K\": 1e9, \"N0\": 1e6,\n            \"drug_A\": {\"Emax\": 1.2, \"EC50\": 1.5, \"h\": 1.2, \"doses\": [(8.0, 0), (8.0, 12), (8.0, 24), (8.0, 36)], \"t_half\": 8.0},\n            \"drug_B\": {\"Emax\": 0.9, \"EC50\": 1.0, \"h\": 1.0, \"doses\": [(5.0, 0), (5.0, 24)], \"t_half\": 6.0},\n            \"interaction\": {\"eta\": 0.0, \"Emax_sigma\": 0.8}\n        },\n        # Case 4 (low-exposure edge case)\n        {\n            \"r\": 0.7, \"K\": 1e9, \"N0\": 1e6,\n            \"drug_A\": {\"Emax\": 1.2, \"EC50\": 1.5, \"h\": 1.2, \"doses\": [(0.5, 0), (0.5, 12), (0.5, 24), (0.5, 36)], \"t_half\": 8.0},\n            \"drug_B\": {\"Emax\": 0.9, \"EC50\": 1.0, \"h\": 1.0, \"doses\": [(0.4, 0), (0.4, 24)], \"t_half\": 6.0},\n            \"interaction\": {\"eta\": 0.8, \"Emax_sigma\": 0.8}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        synergy_result = analyze_case(case)\n        results.append(synergy_result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef analyze_case(params, t_final=48.0, delta=0.05):\n    \"\"\"\n    Analyzes a single test case to determine synergy.\n    \"\"\"\n    r, K, N0 = params[\"r\"], params[\"K\"], params[\"N0\"]\n    pA = params[\"drug_A\"]\n    pB = params[\"drug_B\"]\n    p_int = params[\"interaction\"]\n\n    # Define concentration functions\n    def concentration_function(t, doses, t_half):\n        conc = 0.0\n        for C0, td in doses:\n            if t >= td:\n                conc += C0 * (2.0**(-(t - td) / t_half))\n        return conc\n\n    C_A = lambda t: concentration_function(t, pA[\"doses\"], pA[\"t_half\"])\n    C_B = lambda t: concentration_function(t, pB[\"doses\"], pB[\"t_half\"])\n\n    # Define normalized Hill function component\n    def hill_normalized(C, EC50, h):\n        if C == 0.0:\n            return 0.0\n        C_pow_h = C**h\n        return C_pow_h / (EC50**h + C_pow_h)\n\n    # Define hazard functions\n    k_A = lambda t: pA[\"Emax\"] * hill_normalized(C_A(t), pA[\"EC50\"], pA[\"h\"])\n    k_B = lambda t: pB[\"Emax\"] * hill_normalized(C_B(t), pB[\"EC50\"], pB[\"h\"])\n\n    k_add = lambda t: k_A(t) + k_B(t)\n\n    def sigma(t):\n        norm_A = hill_normalized(C_A(t), pA[\"EC50\"], pA[\"h\"])\n        norm_B = hill_normalized(C_B(t), pB[\"EC50\"], pB[\"h\"])\n        return p_int[\"eta\"] * p_int[\"Emax_sigma\"] * norm_A * norm_B\n\n    k_obs = lambda t: max(0.0, k_add(t) + sigma(t))\n\n    # Define ODE systems in log-space (y = ln(N))\n    def dydt_add(t, y):\n        return r * (1 - np.exp(y) / K) - k_add(t)\n\n    def dydt_obs(t, y):\n        return r * (1 - np.exp(y) / K) - k_obs(t)\n\n    # Integrate ODEs\n    y0 = [np.log(N0)]\n    t_span = [0, t_final]\n    \n    # Using stricter tolerances for higher accuracy\n    atol, rtol = 1e-10, 1e-8\n\n    sol_add = solve_ivp(dydt_add, t_span, y0, method='RK45', t_eval=[t_final], atol=atol, rtol=rtol)\n    y_add_final = sol_add.y[0, -1]\n\n    sol_obs = solve_ivp(dydt_obs, t_span, y0, method='RK45', t_eval=[t_final], atol=atol, rtol=rtol)\n    y_obs_final = sol_obs.y[0, -1]\n\n    # Evaluate synergy criterion\n    log10_diff = (y_add_final - y_obs_final) / np.log(10)\n    \n    return log10_diff >= delta\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "4623391"}]}