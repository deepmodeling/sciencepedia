{"hands_on_practices": [{"introduction": "衡量新发疾病事件的发生率是流行病学的基石。第一个练习将指导您如何根据原始的队列数据计算发病率，这是量化风险的一项基本技能 [@problem_id:4547023]。您还将学习如何为该率构建置信区间，从而为您的估计提供关键的统计不确定性度量。", "problem": "一项在预防医学领域的前瞻性队列研究招募了四名参与者，以基于风险人时来量化疾病发生率作为发病率。每位参与者从进入队列开始被随访，直到他们首次发生事件或被删失为止，得到的随访时间分别为 $1.2$ 年、$0.8$ 年、$2.0$ 年和 $0.5$ 年。在这些随访期间，共观察到 $3$ 次首次事件。假设首次事件的发生是一个与罕见事件的泊松模型相符的计数过程，并且发病率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发病率的点估计值，单位为事件数/人年。\n- 计算 $95\\%$ 的泊松精确置信区间（首次事件率/人年），该区间是通过对观察到的人时内总事件数的泊松计数模型进行反演得到的。\n\n以“事件数/人年”为单位报告您的最终数值结果，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数字按 $(\\text{点估计值}, \\text{下限}, \\text{上限})$ 的顺序表示为单个行向量。最终答案中不得使用百分号；所有量均以小数表示。", "solution": "用户希望我解决以下问题：\n 一项在预防医学领域的前瞻性队列研究招募了四名参与者，以基于风险人时来量化疾病发生率作为发病率。每位参与者从进入队列开始被随访，直到他们首次发生事件或被删失为止，得到的随访时间分别为 $1.2$ 年、$0.8$ 年、$2.0$ 年和 $0.5$ 年。在这些随访期间，共观察到 $3$ 次首次事件。假设首次事件的发生是一个与罕见事件的泊松模型相符的计数过程，并且发病率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发病率的点估计值，单位为事件数/人年。\n- 计算 $95\\%$ 的泊松精确置信区间（首次事件率/人年），该区间是通过对观察到的人时内总事件数的泊松计数模型进行反演得到的。\n\n以“事件数/人年”为单位报告您的最终数值结果，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数字按 $(\\text{点估计值}, \\text{下限}, \\text{上限})$ 的顺序表示为单个行向量。最终答案中不得使用百分号；所有量均以小数表示。\n\n### 第1步：提取已知信息\n- 参与者人数：$4$\n- 个体随访时间：$1.2$ 年，$0.8$ 年，$2.0$ 年，$0.5$ 年。\n- 观察到的首次事件总数 $d$：$3$。\n- 统计模型：泊松过程。\n- 置信区间置信水平：$95\\%$。\n- 要求舍入：四位有效数字。\n- 要求输出格式：一个包含（点估计值，下限，上限）的行向量。\n\n### 第2步：使用提取的已知信息进行验证\n该问题具有科学依据，表述清晰且客观。它描述了根据队列研究数据计算发病率及其置信区间的标准流行病学方法。在这种情况下，使用人时和泊松模型是标准做法。所有必要数据均已提供，且无矛盾之处。该问题不违反任何无效性标准。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n该问题要求计算发病率的点估计值和一个 $95\\%$ 的精确置信区间。\n\n#### 第1部分：发病率的点估计\n\n发病率，用 $\\lambda$ 表示，定义为每单位风险人时内的新发事件数。其点估计值 $\\hat{\\lambda}$ 的计算方法是：观察到的总事件数 $d$ 除以总风险人时 $PT$。\n\n首先，我们通过将所有参与者的随访时间相加来计算总风险人时：\n$$\nPT = 1.2 \\text{ 年} + 0.8 \\text{ 年} + 2.0 \\text{ 年} + 0.5 \\text{ 年}\n$$\n$$\nPT = 4.5 \\text{ 人年}\n$$\n\n观察到的事件数为 $d = 3$。\n\n则发病率的点估计值为：\n$$\n\\hat{\\lambda} = \\frac{d}{PT} = \\frac{3}{4.5} = \\frac{2}{3} \\text{ 事件数/人年}\n$$\n将其转换为小数，我们得到：\n$$\n\\hat{\\lambda} \\approx 0.666666... \\text{ 事件数/人年}\n$$\n\n#### 第2部分：发病率的 $95\\%$ 精确置信区间\n\n问题指明事件数遵循泊松分布。总事件数 $d=3$ 是来自均值为 $\\mu$ 的泊松分布的单个观测值。均值 $\\mu$ 与发病率 $\\lambda$ 和总人时 $PT$ 之间的关系由方程 $\\mu = \\lambda \\times PT$ 给出。\n\n为了求出发病率 $\\lambda$ 的置信区间，我们首先计算均值计数 $\\mu$ 的置信区间，然后将其限值除以 $PT$。\n\n对于给定的观测计数 $d$，泊松均值 $\\mu$ 的精确置信区间基于泊松分布和卡方（$\\chi^2$）分布之间的关系。对于一个 $(1-\\alpha) \\times 100\\%$ 的置信区间，均值 $\\mu$ 的下限 $\\mu_L$ 和上限 $\\mu_U$ 由以下公式给出：\n$$\n\\mu_L = \\frac{1}{2} \\chi^2_{\\alpha/2, 2d}\n$$\n$$\n\\mu_U = \\frac{1}{2} \\chi^2_{1-\\alpha/2, 2(d+1)}\n$$\n其中 $\\chi^2_{p, \\nu}$ 是自由度为 $\\nu$、累积概率为 $p$ 的卡方分布的分位数。\n\n对于 $95\\%$ 的置信区间，$1-\\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。\n观察到的事件数为 $d=3$。\n\n下限的自由度为 $2d = 2 \\times 3 = 6$。\n上限的自由度为 $2(d+1) = 2 \\times (3+1) = 8$。\n\n我们需要以下卡方分位数：\n- 对于下限：$\\chi^2_{\\alpha/2, 2d} = \\chi^2_{0.025, 6}$\n- 对于上限：$\\chi^2_{1-\\alpha/2, 2(d+1)} = \\chi^2_{0.975, 8}$\n\n使用统计表或软件，我们找到这些值：\n$$\n\\chi^2_{0.025, 6} \\approx 1.237344\n$$\n$$\n\\chi^2_{0.975, 8} \\approx 17.534546\n$$\n\n现在，我们可以计算均值计数 $\\mu$ 的置信限：\n$$\n\\mu_L = \\frac{1}{2} \\times 1.237344 = 0.618672\n$$\n$$\n\\mu_U = \\frac{1}{2} \\times 17.534546 = 8.767273\n$$\n这些是在 $4.5$ 人年内预期事件数的下限和上限。\n\n为了求出发病率 $\\lambda$ 的置信区间，我们将这些限值除以总人时 $PT = 4.5$ 人年。\n$$\n\\lambda_L = \\frac{\\mu_L}{PT} = \\frac{0.618672}{4.5} \\approx 0.1374827 \\text{ 事件数/人年}\n$$\n$$\n\\lambda_U = \\frac{\\mu_U}{PT} = \\frac{8.767273}{4.5} \\approx 1.9482829 \\text{ 事件数/人年}\n$$\n\n#### 第3部分：最终结果和舍入\n\n问题要求将点估计值、下限和上限四舍五入到四位有效数字。\n\n- 点估计值：$\\hat{\\lambda} \\approx 0.666666... \\to 0.6667$\n- 置信下限：$\\lambda_L \\approx 0.1374827... \\to 0.1375$\n- 置信上限：$\\lambda_U \\approx 1.9482829... \\to 1.948$\n\n最终结果是有序三元组 $(\\hat{\\lambda}, \\lambda_L, \\lambda_U)$。\n这三个值是 $(0.6667, 0.1375, 1.948)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6667  0.1375  1.948\n\\end{pmatrix}\n}\n$$", "id": "4547023"}, {"introduction": "发病率和患病率是动态相关的；前者衡量进入疾病状态的“流量”，而后者衡量其“存量”。本练习探讨了它们在稳态条件下的基本关系，让您能够推导并应用连接患病率 ($P$)、发病率 ($\\lambda$) 和病程 ($D$) 的经典公式 [@problem_id:4546920]。理解这种联系对于解释疾病负担和干预措施的影响至关重要。", "problem": "一个规模为 $N$ 的封闭、稳定的人群正在经历一种疾病，该疾病使个体在非病例和病例这两种互斥状态之间转移。新发病例在非病例人群中以恒定的发病率（发病密度）$\\lambda = 0.02 \\text{ 人年}^{-1}$ 发生，而离开病例状态的速率也是恒定的，使得在病例状态的平均逗留时间为 $D = 5$ 年。假设处于稳态条件下，人群规模和所有转移率随时间保持不变，且流入和流出病例状态的人数平均达到平衡。仅使用发病率、患病率和平均病程的核心定义，以及两种状态之间的稳态流动平衡，从基本原理出发，推导出在这些假设下预期时点患病率 $P$ 的表达式，然后进行数值计算。将最终的数值患病率表示为无单位的小数，并将答案四舍五入到四位有效数字。此外，简要解释（无需计算）在该框架下，将退出过程解释为缓解与解释为死亡，如何改变了平均病程参数的含义，即使 $D$ 的数值相同。仅提供计算出的患病率数值作为最终答案。", "solution": "该问题被评估为有效，因为它在科学上基于既定的流行病学原理，问题设定良好、客观且内部一致。它代表了一个经典的稳态房室模型，存在唯一且有意义的解。\n\n设 $N$ 为封闭、稳定人群的总规模。人群被分为两个互斥的状态：病例（人数为 $C$）和非病例（人数为 $S$）。因此，在任何时候，我们都有以下关系：\n$$S + C = N$$\n时点患病率，记为 $P$，定义为在特定时间点人群中病例所占的比例。在稳态条件的假设下，患病率是恒定的，由下式给出：\n$$P = \\frac{C}{N}$$\n问题给出了发病率（也称为发病密度）$\\lambda$，即非病例成为新病例的速率。其值为 $\\lambda = 0.02 \\text{ 人年}^{-1}$。流入病例状态的总速率是该人均速率与风险人群（非病例人群，$S$）数量的乘积：\n$$ \\text{流入速率} = \\lambda S $$\n问题还给出了在病例状态的平均逗留时间，即疾病的平均病程，$D = 5$ 年。离开病例状态的速率，我们记为 $\\gamma$，是平均病程的倒数：\n$$ \\gamma = \\frac{1}{D} $$\n流出病例状态的总速率是该人均退出速率与病例人数 $C$ 的乘积：\n$$ \\text{流出速率} = \\gamma C = \\frac{1}{D} C $$\n问题的核心假设是系统处于稳态，这意味着流入病例状态的速率与流出病例状态的速率完全相等：\n$$ \\text{流入速率} = \\text{流出速率} $$\n$$ \\lambda S = \\frac{C}{D} $$\n为了推导患病率 $P$ 的表达式，我们必须将此方程中的变量与 $N$ 联系起来。我们可以将非病例人数 $S$ 表示为 $S = N - C$。将此代入稳态方程可得：\n$$ \\lambda (N - C) = \\frac{C}{D} $$\n目标是求出 $P = C/N$。我们可以重排方程以求解该比率。首先，将 $\\lambda$ 分配到左侧：\n$$ \\lambda N - \\lambda C = \\frac{C}{D} $$\n接下来，我们将所有包含 $C$ 的项移到等式的一侧：\n$$ \\lambda N = \\lambda C + \\frac{C}{D} $$\n从右侧提取公因子 $C$：\n$$ \\lambda N = C \\left( \\lambda + \\frac{1}{D} \\right) $$\n为了得到患病率 $P = C/N$，我们将等式两边同时除以 $N$：\n$$ \\lambda = \\frac{C}{N} \\left( \\lambda + \\frac{1}{D} \\right) $$\n$$ \\lambda = P \\left( \\lambda + \\frac{1}{D} \\right) $$\n解出 $P$ 可得：\n$$ P = \\frac{\\lambda}{\\lambda + \\frac{1}{D}} $$\n为简化此表达式，我们可以将分子和分母同时乘以 $D$：\n$$ P = \\frac{\\lambda D}{D \\left( \\lambda + \\frac{1}{D} \\right)} = \\frac{\\lambda D}{\\lambda D + 1} $$\n这就是根据基本原理在稳态条件下推导出的时点患病率的表达式。\n\n现在，我们将给定的数值 $\\lambda = 0.02 \\text{ 年}^{-1}$ 和 $D = 5 \\, \\text{年}$ 代入此表达式。首先，我们计算无量纲的乘积 $\\lambda D$：\n$$ \\lambda D = 0.02 \\times 5 = 0.1 $$\n使用这个值，我们计算患病率 $P$：\n$$ P = \\frac{0.1}{1 + 0.1} = \\frac{0.1}{1.1} = \\frac{1}{11} $$\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$ P = \\frac{1}{11} \\approx 0.09090909... $$\n四舍五入到四位有效数字，我们得到 $P \\approx 0.09091$。\n\n关于平均病程参数 $D$ 的解释，其含义取决于离开病例状态的性质。\n如果退出过程是缓解，离开病例状态的个体将返回非病例（易感）状态。在这种情况下，$D$ 代表康复前单次疾病发作的平均持续时间。\n如果退出过程是因病死亡，离开病例状态的个体将被永久移出人群。在这种情况下，$D$ 代表成为病例后的平均生存时间。它是衡量疾病致死率的一个指标。虽然基于流动平衡的患病率数值计算保持不变，但将 $D$ 解释为“病程”与“生存时间”在临床上是根本不同的。", "answer": "$$\\boxed{0.09091}$$", "id": "4546920"}, {"introduction": "我们对疾病频率的测量精度取决于我们使用的工具。本练习旨在解决诊断测试不完善这一关键问题，展示假阳性如何显著夸大观测患病率，尤其是在罕见疾病中 [@problem_id:4546955]。通过推导真实患病率与观测患病率之间的关系，您将对审慎解读筛查调查结果有更深刻的理解。", "problem": "一个公共卫生团队在一个稳定的人群中使用单一诊断检测方法，进行了一项针对罕见感染的大型横断面时点患病率调查。假设样本足够大，在计算期望值时可以忽略抽样变异性。设真实时点患病率为$P$，检测灵敏度为$Se$（sensitivity），检测特异性为$Sp$（specificity）。调查报告的观测时点患病率定义为检测结果呈阳性的个体所占的比例。\n\n从第一性原理出发，仅使用时点患病率、灵敏度和特异性的核心定义以及基本概率法则，推导出一个用$P$、$Se$和$Sp$表示的预期观测时点患病率的表达式。然后，为了分离出假阳性的作用，假设该检测具有近乎完美的灵敏度$Se=1.000$和高但非完美的特异性$Sp=0.995$，并且真实时点患病率非常低，$P=0.002$。简明解释为什么当$P$非常小时，假阳性可能在观测患病率中占主导地位，并根据这些数值计算预期的观测患病率。\n\n将最终数值答案表示为小数比例，并四舍五入到三位有效数字。", "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于流行病学和生物统计学的原理，问题提出得很好，提供了所有必要的信息，并且语言客观。该问题要求从第一性原理推导一个标准公式，并将其应用于一个现实场景，这是一项合适的任务。\n\n设$D^+$为个体患有该感染的事件，$D^-$为个体未患有该感染的事件。设$T^+$为个体检测结果呈阳性的事件，$T^-$为个体检测结果呈阴性的事件。\n\n根据问题陈述，我们已知：\n- 真实时点患病率$P$，即从人群中随机选择一个个体患有该感染的概率。因此，$P = P(D^+)$。所以，未患有该感染的概率是 $P(D^-) = 1 - P(D^+) = 1-P$。\n- 检测灵敏度$Se$，即患有该感染的个体检测结果呈阳性的条件概率。因此，$Se = P(T^+ | D^+)$。\n- 检测特异性$Sp$，即未患有该感染的个体检测结果呈阴性的条件概率。因此，$Sp = P(T^- | D^-)$。\n\n观测时点患病率，我们记为$P_{obs}$，定义为检测结果呈阳性的个体所占的比例。在概率术语中，这对应于检测结果呈阳性的总概率，$P(T^+)$。\n\n为了推导$P(T^+)$的表达式，我们使用全概率公式，以个体的疾病状态为条件：\n$$P(T^+) = P(T^+ | D^+) P(D^+) + P(T^+ | D^-) P(D^-)$$\n\n我们可以将已知项代入此方程。我们有$P(D^+) = P$和$P(T^+ | D^+) = Se$。我们还有$P(D^-) = 1-P$。项$P(T^+ | D^-)$表示在个体没有患病的情况下检测结果呈阳性的概率。这是假阳性率。因为一个没有患病的个体检测结果可以是阴性（真阴性）或阳性（假阳性），这两个结果是互补的。因此：\n$$P(T^+ | D^-) = 1 - P(T^- | D^-) = 1 - Sp$$\n\n将所有这些表达式代回到全概率公式方程中，我们得到预期观测患病率的表达式：\n$$P_{obs} = (Se) \\cdot P + (1 - Sp) \\cdot (1 - P)$$\n\n这个公式表明，观测患病率是两个组成部分的总和：人群中真阳性的比例$(Se \\cdot P)$，和人群中假阳性的比例$((1 - Sp) \\cdot (1 - P))$。\n\n接下来，我们解释为什么当真实患病率$P$非常小时，假阳性可能在观测患病率中占主导地位。阳性检测的总数来自真阳性（TP）和假阳性（FP）。对每种情况有贡献的人群比例是：\n- 真阳性：$P_{TP} = P(T^+ \\cap D^+) = Se \\cdot P$\n- 假阳性：$P_{FP} = P(T^+ \\cap D^-) = (1 - Sp) \\cdot (1 - P)$\n\n当真实患病率$P$非常小时，未患病个体的比例$1-P$非常接近于$1$。真阳性的数量是灵敏度（$Se$，通常很高）应用于一个非常小的基数（$P$）。假阳性的数量是假阳性率（$1-Sp$，通常很小）应用于一个非常大的基数（$1-P$）。如果$P$足够小，乘积$(1 - Sp) \\cdot (1 - P)$可能显著大于乘积$Se \\cdot P$。在这种情况下，调查中的大多数阳性检测结果并非来自真正被感染的个体，而是来自未被感染的个体。\n\n最后，我们根据给定的数值计算预期的观测患病率：\n- 真实患病率，$P = 0.002$\n- 灵敏度，$Se = 1.000$\n- 特异性，$Sp = 0.995$\n\n使用推导出的公式：\n$$P_{obs} = (Se) \\cdot P + (1 - Sp) \\cdot (1 - P)$$\n$$P_{obs} = (1.000) \\cdot (0.002) + (1 - 0.995) \\cdot (1 - 0.002)$$\n$$P_{obs} = 0.002 + (0.005) \\cdot (0.998)$$\n$$P_{obs} = 0.002 + 0.00499$$\n$$P_{obs} = 0.00699$$\n\n真阳性的比例是$0.002$，而假阳性的比例是$0.00499$。显然，假阳性对观测患病率的贡献大于真阳性。计算出的值$0.00699$有三位有效数字（$6$、$9$、$9$），因此不需要进一步四舍五入。", "answer": "$$\\boxed{0.00699}$$", "id": "4546955"}]}