{"hands_on_practices": [{"introduction": "在流行病学中，量化疫情的传播速度是一项首要任务。本练习聚焦于爆发初期的指数增长阶段，介绍两个基本指标：瞬时增长率 $r$ 和更直观的倍增时间 $T_d$。通过这个练习，你将巩固对它们之间数学关系的理解，并学会如何利用这些指标来描述一场流行（epidemic）的强度。[@problem_id:4638530]", "problem": "考虑一个在大型、充分混合人群中传播的传染病，其发病率为 $I(t)$。在传播的早期阶段，本地传播不受易感人群减少和公共卫生干预措施的限制，因此发病率呈现短期指数行为。在这种情况下，瞬时人均增长率 $r$ 定义为 $I(t)$ 的瞬时相对变化率，而倍增时间 $T_{d}$ 定义为在 $r$ 恒定时，发病率加倍所需的最小正时间间隔。在疾病发生模式的背景下，解释 $r$ 的符号和大小如何与地方性流行、流行病和大流行病的局部动态相关，并阐明 $r$ 和 $T_{d}$ 之间的概念区别。从基本定义和指数增长的控制微分方程出发，推导 $r$ 和 $T_{d}$ 之间的数学关系。然后，使用经验观察到的某种呼吸道病原体在早期的倍增时间 $T_{d} = 3$ 天，计算 $r$ 的精确解析表达式。请以 day$^{-1}$ 为单位表示增长率的最终数值，但需以精确的解析表达式形式报告，不得进行四舍五入或近似。您的最终答案必须是答案框中一个没有单位的封闭形式表达式。", "solution": "首先将对问题陈述的科学合理性、完整性和清晰度进行验证。\n\n### 步骤1：提取已知条件\n-   传染病的发病率用 $I(t)$ 表示。\n-   人群规模大且充分混合。\n-   分析涉及传播的早期阶段，此阶段发病率 $I(t)$ 呈现短期指数行为。\n-   瞬时人均增长率 $r$ 定义为 $I(t)$ 的瞬时相对变化率。\n-   倍增时间 $T_d$ 定义为在 $r$ 恒定时，发病率加倍所需的最小正时间间隔。\n-   给出了一个经验观察到的倍增时间值：$T_d = 3$ 天。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于流行病学的基本原理。疫情爆发早期的指数增长概念、瞬时增长率 $r$ 和倍增时间 $T_d$ 是传染病数学建模中的标准核心概念。\n-   **适定性**：该问题是适定的。它要求三个不同的部分：概念解释、数学推导和基于所提供数据的数值计算。问题清晰，能够得出一个唯一、稳定且有意义的解。\n-   **客观性**：语言客观，使用了流行病学和数学领域的精确标准术语。\n-   **完整性与一致性**：该问题是自洽的。它提供了进行所需推导和计算所必需的所有定义（$r$、$T_d$）和数据（$T_d=3$）。没有矛盾之处。\n-   **现实性与可行性**：早期阶段指数增长的假设是一个标准且有效的近似。给定的 $T_d = 3$ 天对于许多呼吸道病原体（包括早期流感或SARS-CoV-2爆发）来说是一个现实的倍增时间。\n\n### 步骤3：结论与行动\n该问题被认为是有效的，因为它科学合理、适定且完整。将制定完整的解决方案。\n\n### 解题过程\n\n问题要求对增长率 $r$ 进行概念性解释，推导其与倍增时间 $T_d$ 的关系，并根据给定的 $T_d$ 计算 $r$ 的值。\n\n首先，我们将建立概念框架。瞬时人均增长率 $r$ 定义为发病率 $I(t)$ 的瞬时相对变化率。这可以用数学方式写成：\n$$\nr = \\frac{1}{I(t)} \\frac{dI(t)}{dt}\n$$\n这个定义直接导出了指数增长的控制微分方程，假设在早期阶段 $r$ 是恒定的：\n$$\n\\frac{dI(t)}{dt} = r I(t)\n$$\n$r$ 的符号和大小直接表征了疾病在局部尺度上的动态：\n-   如果 $r > 0$，则 $\\frac{dI(t)}{dt} > 0$，意味着发病率正在增加。这种情况定义了**流行病 (epidemic)**：病例数正在活跃地呈指数级增长。$r$ 的大小量化了这种增长的速度；较大的 $r$ 对应于更具爆发性的流行病。\n-   如果 $r = 0$，则 $\\frac{dI(t)}{dt} = 0$，意味着发病率恒定。这对应于**地方性流行 (endemic)** 的稳态，此时新感染率与康复或移除率完全平衡，导致活跃病例数没有净变化。\n-   如果 $r  0$，则 $\\frac{dI(t)}{dt}  0$，意味着发病率正在下降。这表明流行病正在衰退，原因可能是成功的干预措施、易感人群的耗尽或其他因素。\n\n**大流行病 (pandemic)** 是地理上广泛传播的流行病。大流行病在任何特定地区的局部动态仍然由局部增长率 $r$ 描述。大流行病的特征是在多个国家或大洲持续存在 $r > 0$ 的情况。\n\n$r$ 和 $T_d$ 之间的概念区别至关重要。增长率 $r$ 是一个瞬时速率参数，单位为时间的倒数（例如，$\\text{day}^{-1}$）。它是控制指数过程的基本参数。相反，倍增时间 $T_d$ 是一个时间间隔，单位为时间（例如，天）。它是增长率 $r$ 的一个结果，并为衡量流行病速度提供了一个更直观但派生出的度量。$T_d$ 仅在 $r > 0$ 时有意义，因为它描述了发病率加倍所需的时间。如果 $r \\le 0$，发病率不会加倍，倍增时间的概念也就不适用。\n\n接下来，我们推导 $r$ 和 $T_d$ 之间的数学关系。我们从微分方程 $\\frac{dI(t)}{dt} = r I(t)$ 开始。这是一个可分离的一阶常微分方程。我们可以分离变量并积分：\n$$\n\\int_{I(t_0)}^{I(t_0+T_d)} \\frac{dI}{I} = \\int_{t_0}^{t_0+T_d} r \\, dt\n$$\n在这里，我们从任意初始时间 $t_0$ 积分到时间 $t_0 + T_d$，其中 $T_d$ 是倍增时间。根据定义，在此时间间隔内，发病率加倍，因此 $I(t_0+T_d) = 2 I(t_0)$。由于假设 $r$ 是恒定的：\n$$\n[\\ln(I)]_{I(t_0)}^{2I(t_0)} = r [t]_{t_0}^{t_0+T_d}\n$$\n计算积分限可得：\n$$\n\\ln(2 I(t_0)) - \\ln(I(t_0)) = r ((t_0+T_d) - t_0)\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\n\\ln\\left(\\frac{2 I(t_0)}{I(t_0)}\\right) = r T_d\n$$\n只要存在疫情，$I(t_0) > 0$，因此我们可以消去该项：\n$$\n\\ln(2) = r T_d\n$$\n这就是瞬时增长率 $r$ 和倍增时间 $T_d$ 之间的基本关系。整理可得 $r$：\n$$\nr = \\frac{\\ln(2)}{T_d}\n$$\n最后，我们根据给定的倍增时间 $T_d = 3$ 天计算 $r$ 的值。将此值代入推导出的公式中：\n$$\nr = \\frac{\\ln(2)}{3}\n$$\n$r$ 的单位是 $\\text{day}^{-1}$，因为 $\\ln(2)$ 是一个无量纲常数，而 $T_d$ 的单位是天。问题要求提供精确的解析表达式。因此，我们不用小数值近似 $\\ln(2)$。$r$ 的最终表达式就是 $\\frac{\\ln(2)}{3}$。", "answer": "$$\n\\boxed{\\frac{\\ln(2)}{3}}\n$$", "id": "4638530"}, {"introduction": "在衡量了早期增长之后，下一步是为整个疫情的轨迹建立模型。本练习将介绍经典的易感-感染-移除 (SIR) 模型，它是流行病学的基石。通过推导并求解最终规模方程，你将理解基本传染数 $R_0$ 不仅决定了流行（epidemic）是否会发生，还决定了其最终规模（即侵袭率 $z$）。这个练习将展示一个自限性流行的完整生命周期。[@problem_id:4638509]", "problem": "考虑易感-感染-移除（SIR）仓室模型，该模型在均匀质点作用混合且忽略人口动态变化的条件下运行。设人口比例分别由 $S(t)$（易感者）、$I(t)$（感染者）和 $R(t)$（移除者）表示，且在所有时间 $t$ 满足 $S(t)+I(t)+R(t)=1$。其控制常微分方程（ODEs）为：\n$$ \\frac{dS}{dt} = -\\beta S I $$\n$$ \\frac{dI}{dt} = \\beta S I - \\gamma I $$\n$$ \\frac{dR}{dt} = \\gamma I $$\n其中 $\\beta0$ 为传播率，$\\gamma0$ 为恢复率。在 $S(0)\\approx 1$ 的归一化条件和极小的感染种子 $I(0)\\to 0$ 的情况下，基本再生数（通常缩写为 $R_0$）在此定义为 $R_0=\\frac{\\beta}{\\gamma}$。\n\n从这些基本定义和常微分方程出发，推导出一个隐式关系，该关系在初始条件 $R(0)=0$、$S(0)\\approx 1$ 和 $I(0)\\to 0$ 下，确定了累积疫情侵袭率 $z$（在疫情过程中经历感染的人口最终比例）作为 $R_0$ 的函数。在您的推导中，请显式地消去时间，并仅使用守恒定律和模型所蕴含的风险结构。\n\n然后，设计并实现一个数值算法，在给定 $R_0$ 的情况下，返回与推导出的隐式关系一致的疫情侵袭率 $z$。您的算法必须：\n- 当在区间 $(0,1)$ 内没有非平凡（严格为正）的 $z$ 解时（如模型和初始条件所暗示），返回 $z=0$。\n- 对于存在非平凡解的情况，使用不依赖任何封闭形式解的鲁棒求根方案，计算 $z\\in(0,1)$，使其绝对误差不大于 $10^{-9}$。\n- 将 $z$ 表示为小数（不带百分号），并四舍五入到六位小数。\n\n通过解释 $R_0$ 所暗示的阈值行为以及非平凡 $z$ 的存在如何反映单个充分混合群体中的流行病（epidemic），为什么地方性流行（endemicity）需要当前模型之外的人口过程，以及全球大流行（pandemic）的发生如何与多个耦合群体间的同步流行病相关，而非单一群体最终规模关系的变化，将您的推导与地方性流行、流行病和全球大流行的概念联系起来。\n\n测试套件：\n- 情况 1：$R_0=0.5$（亚临界传播）\n- 情况 2：$R_0=1.0$（阈值）\n- 情况 3：$R_0=1.1$（近阈值超临界传播）\n- 情况 4：$R_0=2.5$（中等强度传播）\n- 情况 5：$R_0=8.0$（非常强的传播）\n\n您的程序应生成单行输出，其中包含一个逗号分隔的五个侵袭率结果列表，用方括号括起来，顺序如上（例如，$[z_1,z_2,z_3,z_4,z_5]$），其中每个 $z_i$ 是一个四舍五入到六位小数的浮点数。", "solution": "在尝试解决问题之前，对问题陈述的有效性进行评估。\n\n### 第一步：提取已知条件\n- **模型**：易感-感染-移除（SIR）仓室模型。\n- **假设**：均匀质点作用混合，可忽略的人口动态。\n- **状态变量**：$S(t)$（易感者比例），$I(t)$（感染者比例），$R(t)$（移除者比例）。\n- **守恒定律**：对所有时间 $t$，有 $S(t)+I(t)+R(t)=1$。\n- **控制常微分方程组**：\n    - $\\frac{dS}{dt}=-\\beta S I$\n    - $\\frac{dI}{dt}=\\beta S I-\\gamma I$\n    - $\\frac{dR}{dt}=\\gamma I$\n- **参数**：$\\beta  0$（传播率），$\\gamma  0$（恢复率）。\n- **定义**：基本再生数 $R_0 = \\frac{\\beta}{\\gamma}$。\n- **初始条件**：$S(0) \\approx 1$，$I(0) \\to 0$，$R(0)=0$。\n- **定义**：累积疫情侵袭率 $z$ 是经历感染的人口的最终比例。\n- **任务**：\n    1. 推导 $z$ 作为 $R_0$ 函数的隐式关系。\n    2. 设计并实现一个数值算法，根据给定的 $R_0$ 求解 $z$。\n    3. 对于在 $(0,1)$ 区间内没有非平凡解的情况，算法必须返回 $z=0$。\n    4. 算法必须计算非平凡解 $z$，使其绝对误差不大于 $10^{-9}$。\n    5. $z$ 的最终输出必须四舍五入到六位小数。\n    6. 解释模型结果与地方性流行、流行病和全球大流行概念的联系。\n- **测试套件**：\n    - 情况 1：$R_0=0.5$\n    - 情况 2：$R_0=1.0$\n    - 情况 3：$R_0=1.1$\n    - 情况 4：$R_0=2.5$\n    - 情况 5：$R_0=8.0$\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于经典的 SIR 模型，这是数理流行病学的基础元素。定义、方程和参数（$R_0$、$\\beta$、$\\gamma$）都是标准的且符合事实。该问题在科学上是合理的。\n2.  **适定性**：该问题要求推导和数值求解疫情的最终规模方程，这是该领域一个定义明确的标准问题。初始条件和约束导致一个唯一且有意义的解。\n3.  **客观性**：该问题以精确、形式化的数学语言陈述，没有任何主观性或偏见。\n4.  **完整且一致的设置**：模型通过常微分方程组、初始条件和参数定义得到了完全指定。没有信息缺失或矛盾之处。\n5.  **无其他缺陷**：该问题并非无关紧要、隐喻性的，或超出科学可验证范围。\n\n### 第三步：结论与行动\n该问题是**有效的**。将提供完整的解决方案。\n\n### 最终规模关系的推导\n\n目标是找到系统最终状态与初始参数（特别是 $R_0$）之间的关系，而不显式依赖于时间 $t$。我们可以通过将 $S$ 和 $I$ 的常微分方程相除以消去微分 $dt$ 来实现这一点。\n\n控制方程为：\n$$\n\\frac{dS}{dt} = -\\beta S(t) I(t)\n$$\n$$\n\\frac{dI}{dt} = \\beta S(t) I(t) - \\gamma I(t) = (\\beta S(t) - \\gamma) I(t)\n$$\n将第二个方程除以第一个方程得到：\n$$\n\\frac{dI}{dS} = \\frac{(\\beta S - \\gamma) I}{-\\beta S I} = \\frac{\\beta S - \\gamma}{-\\beta S} = -1 + \\frac{\\gamma}{\\beta S}\n$$\n根据定义，基本再生数是 $R_0 = \\frac{\\beta}{\\gamma}$。将其代入方程得到：\n$$\n\\frac{dI}{dS} = -1 + \\frac{1}{R_0 S}\n$$\n这个常微分方程将感染者比例与易感者比例联系起来。我们可以从疫情开始时（$t=0$）到其结束时（$t \\to \\infty$）对这个方程进行积分。设初始状态为 $(S_0, I_0)$，最终状态为 $(S_f, I_f)$。\n给定的初始条件是 $S(0) \\approx 1$，$I(0) \\to 0$ 和 $R(0)=0$。为了积分，我们取极限 $S_0=1$ 和 $I_0=0$。在疫情结束时，不再有感染者，所以 $I(\\infty)=I_f=0$。\n\n我们对 $dI = (-1 + \\frac{1}{R_0 S}) dS$ 进行积分：\n$$\n\\int_{I_0=0}^{I_f=0} dI = \\int_{S_0=1}^{S_f} \\left(-1 + \\frac{1}{R_0 S}\\right) dS\n$$\n左边就是 $0$。右边积分为：\n$$\n0 = \\left[ -S + \\frac{1}{R_0} \\ln(S) \\right]_{1}^{S_f}\n$$\n$$\n0 = \\left(-S_f + \\frac{1}{R_0} \\ln(S_f)\\right) - \\left(-1 + \\frac{1}{R_0} \\ln(1)\\right)\n$$\n因为 $\\ln(1)=0$，这简化为：\n$$\n0 = 1 - S_f + \\frac{1}{R_0} \\ln(S_f)\n$$\n这个方程将最终的易感者比例 $S_f$ 与 $R_0$ 联系起来。累积侵袭率 $z$ 被定义为在疫情过程中被感染的总人口比例。在这个模型中，任何在疫情结束时不再是易感者的人都必定曾被感染。因此，$z = S_0 - S_f$。当 $S_0=1$ 时，我们有 $z = 1 - S_f$，或者等价地，$S_f = 1 - z$。\n\n将 $S_f = 1-z$ 代入积分关系中：\n$$\n0 = 1 - (1-z) + \\frac{1}{R_0} \\ln(1-z)\n$$\n$$\n0 = z + \\frac{1}{R_0} \\ln(1-z)\n$$\n两边乘以 $R_0$（因为 $R_0  0$）得到侵袭率 $z$ 的最终隐式关系：\n$$\nR_0 z + \\ln(1-z) = 0\n$$\n\n### 分析与概念联系\n\n设 $f(z) = R_0 z + \\ln(1-z)$。我们寻求 $f(z)=0$ 在 $z \\in [0, 1)$ 范围内的根。\n- 一个平凡解总是存在的：$f(0) = R_0(0) + \\ln(1-0) = 0$。这对应于没有疫情发生的情况。\n- 为了确定是否存在一个非平凡解 $z \\in (0, 1)$，我们分析 $f(z)$ 在 $z=0$ 附近的行为。其导数为 $f'(z) = R_0 - \\frac{1}{1-z}$。\n- 在 $z=0$ 处，斜率为 $f'(0) = R_0 - 1$。\n- 二阶导数为 $f''(z) = -\\frac{1}{(1-z)^2}$，对于 $z \\in (0,1)$，它恒为负。这意味着 $f(z)$ 是一个严格的凹函数。\n\n**流行病阈值**：\n- 如果 $R_0 \\le 1$，那么 $f'(0) \\le 0$。由于函数从 $f(0)=0$ 开始，斜率为非正，且是向下凹的，它对于所有 $z \\in (0,1)$ 都将是严格为负的。因此，唯一的非负解是平凡解 $z=0$。这表明，如果一个感染者平均产生一个或更少的新感染，大规模的暴发就无法持续。\n- 如果 $R_0  1$，那么 $f'(0)  0$。函数从 $f(0)=0$ 开始，斜率为正。由于它是向下凹的并且 $\\lim_{z \\to 1^-} f(z) = -\\infty$，它必须在区间 $(0, 1)$ 内再次穿过z轴一次。这个唯一的非平凡根代表了疫情的最终侵袭率。$R_0  1$ 的条件是在此模型中发生流行病的基本阈值。\n\n**地方性流行（Endemic）与流行病（Epidemic）**：\n- 推导出的关系描述的是一场**流行病（epidemic）**：在一个封闭群体中的一次暴发，随着易感者池的耗尽而最终消失。该模型没有补充易感个体的机制。\n- **地方性流行（endemic）**状态，即疾病无限期地以非零水平持续存在，需要易感者的持续输入，通常是通过出生。一个带有人口动态（例如，出生率和死亡率 $\\mu$）的 SIR 模型，如 $\\frac{dS}{dt} = \\mu N - \\beta S I - \\mu S$，可以表现出非零的地方性平衡点，这与此处计算的单次暴发的最终规模有根本的不同。\n\n**全球大流行（Pandemic）背景**：\n- **全球大流行（pandemic）**是一场地理上广泛传播的流行病，影响多个国家或大洲。这里推导的最终规模关系适用于单个、充分混合的群体。全球大流行不是这个方程的属性，而是一个由耦合群体模型网络（例如，由迁移率连接的多个 SIR 模型）描述的大规模现象。每个子群体内的动态仍然可以用 SIR 模型来近似，但全球传播是一种网络效应。\n\n### 数值算法设计\n\n为了求解 $R_0 z + \\ln(1-z) = 0$ 中的 $z$：\n1.  **平凡情况**：如果 $R_0 \\le 1$，唯一有效的解是 $z=0$。算法返回 $0$。\n2.  **非平凡情况（$R_0  1$）**：存在一个唯一的根 $z \\in (0,1)$。我们需要一个数值求根方法。\n    - **函数**：$f(z) = R_0 z + \\ln(1-z)$。\n    - **方法**：Brent-Dekker 方法（在 SciPy 中为 `brentq`）是一个绝佳的选择。它是一种混合方法，结合了二分法的安全性与割线法和反二次插值法的速度。如果根被框定，它保证收敛。\n    - **确定根区间**：我们需要一个区间 $[a, b]$，使得 $f(a)$ 和 $f(b)$ 的符号相反。\n        - 对于一个很小的正数 $\\epsilon$，$f(\\epsilon) = R_0 \\epsilon + \\ln(1-\\epsilon) \\approx R_0 \\epsilon - \\epsilon = (R_0-1)\\epsilon  0$。所以我们可以选择 $a$ 为一个非常小的正数（例如，$10^{-12}$）。\n        - 当 $z \\to 1^-$ 时，$\\ln(1-z) \\to -\\infty$，所以 $f(z)$ 变为负数。我们可以选择 $b$ 为一个非常接近 $1$ 的数（例如，$1 - 10^{-12}$）。这确保了 $f(b)  0$。\n    - **容差**：问题要求 $z$ 的绝对误差不大于 $10^{-9}$。我们将 `brentq` 函数的 `xtol` 参数设置为 $10^{-9}$。\n    - **输出**：求解器的结果按照要求四舍_x_ 到六位小数。\n该实现将处理每个给定的 $R_0$ 值，应用此逻辑，并将结果格式化为指定的列表格式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Derives and numerically solves for the epidemic attack rate z in a standard\n    SIR model as a function of the basic reproduction number R0.\n    \"\"\"\n\n    test_cases = [0.5, 1.0, 1.1, 2.5, 8.0]\n    results = []\n\n    def calculate_attack_rate(R0):\n        \"\"\"\n        Calculates the SIR model attack rate (z) for a given R0.\n\n        The attack rate z is the non-trivial solution to the final size equation:\n        R0*z + ln(1-z) = 0 for z in (0, 1).\n\n        Args:\n            R0 (float): The basic reproduction number.\n\n        Returns:\n            float: The attack rate z. Returns 0 if R0 = 1, as no epidemic\n                   occurs. Otherwise, returns the numerically computed z.\n        \"\"\"\n        # For R0 = 1, the only non-negative solution is the trivial one, z=0,\n        # meaning no epidemic occurs.\n        if R0 = 1.0:\n            return 0.0\n\n        # For R0 > 1, a unique non-trivial solution for z in (0, 1) exists.\n        # We need to find the root of f(z) = R0*z + ln(1-z).\n        # We use a robust root-finding algorithm (Brent's method) on a\n        # bracketing interval.\n        \n        # The function whose root we want to find.\n        # It's passed as a lambda to brentq, which expects a function of one variable.\n        f = lambda z: R0 * z + np.log(1 - z)\n\n        # The bracketing interval [a, b] must satisfy f(a)*f(b)  0.\n        # For R0 > 1, f(z) is positive for z slightly > 0.\n        # Let's choose a as a very small positive number.\n        a = 1e-12\n        \n        # As z approaches 1, ln(1-z) approaches -infinity, so f(z) becomes negative.\n        # Let's choose b as a number very close to 1.\n        b = 1.0 - 1e-12\n        \n        # The required absolute tolerance on the solution z.\n        tolerance = 1e-9\n\n        # Use scipy.optimize.brentq to find the root.\n        # brentq is highly reliable for bracketed, single-variable functions.\n        try:\n            attack_rate_z = brentq(f, a, b, xtol=tolerance)\n        except ValueError:\n            # This should not happen with the chosen brackets and a valid R0 > 1.\n            # However, as a failsafe:\n            attack_rate_z = 0.0\n            \n        return attack_rate_z\n\n    for R0_value in test_cases:\n        z = calculate_attack_rate(R0_value)\n        # Round the result to six decimal places for the final output.\n        rounded_z = round(z, 6)\n        results.append(rounded_z)\n\n    # The final print statement must be in the exact required format.\n    # The format f-string with '.6f' ensures proper rounding and formatting.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4638509"}, {"introduction": "尽管 SIR 模型解释了那些会自行消退的流行（epidemic），但许多疾病却在人群中长期持续存在，形成地方性流行（endemic）。本练习通过将 SIR 模型扩展为包含免疫力减退的 SIRS 模型，来探讨地方性流行的持续机制。通过分析该模型的平衡点，你将推导出疾病能够成为地方性流行的条件，并计算其稳定状态下的发病率，从而突显再感染在维持疾病传播中的关键作用。[@problem_id:4638494]", "problem": "一个具有标准发生率、恢复和免疫力消退的易感-感染-康复-易感（SIRS）模型，应用于一个规模恒定为 $N$ 的封闭种群，由以下常微分方程（ODEs）给出：\n$$\n\\frac{dS}{dt} \\;=\\; -\\,\\beta\\,\\frac{S I}{N} \\;+\\; \\omega\\,R,\\qquad \n\\frac{dI}{dt} \\;=\\; \\beta\\,\\frac{S I}{N} \\;-\\; \\gamma\\,I,\\qquad\n\\frac{dR}{dt} \\;=\\; \\gamma\\,I \\;-\\; \\omega\\,R,\n$$\n其中 $S$、$I$ 和 $R$ 分别表示易感类、感染类和康复类的人数；$\\beta$ 是传播率；$\\gamma$ 是恢复率；$\\omega$ 是免疫力丧失（消退）率，该速率使个体从 $R$ 类返回到 $S$ 类。假设 $N$ 是恒定的，并且质量作用混合成立。基本再生数（首次出现）$R_0$ 定义为 $R_0 \\equiv \\beta/\\gamma$。\n\n- 仅使用模型结构、种群守恒以及地方性平衡的定义（时间导数为零且 $I^{\\ast} \\!\\! 0$），从第一性原理推导出地方性平衡发生率，其定义为平衡状态下单位时间内的新感染流量，即 $\\,\\mathcal{I}^{\\ast} \\equiv \\beta\\, S^{\\ast} I^{\\ast} / N$。证明再感染机制（速率为 $\\omega$ 的免疫力消退）如何在 $R_0 \\!\\! 1$ 时使得地方性发生率非零。\n\n- 然后，定义人均地方性平衡发生率为 $\\,\\lambda^{\\ast} \\equiv \\mathcal{I}^{\\ast} / N$。在 $\\omega \\,=\\, 0.02\\,\\text{day}^{-1}$ 且 $\\beta$ 和 $\\gamma$ 固定（视为符号常量）的情况下，计算 $\\,\\lambda^{\\ast}$ 作为 $\\beta$ 和 $\\gamma$ 的函数的闭式表达式。\n\n将最终量表示为关于 $\\beta$ 和 $\\gamma$ 的单一闭式解析表达式。以 $\\text{day}^{-1}$ 为单位报告结果。无需四舍五入。", "solution": "该问题要求基于所提供的易感-感染-康复-易感（SIRS）模型进行两个主要推导。首先，我们必须推导出地方性平衡发生率 $\\mathcal{I}^{\\ast}$，并解释免疫力消退的作用。其次，我们必须为一个特定的免疫力消退率 $\\omega$ 值，计算人均地方性平衡发生率 $\\lambda^{\\ast}$ 的闭式表达式。\n\nSIRS 模型由以下常微分方程组描述：\n$$\n\\frac{dS}{dt} = -\\beta \\frac{SI}{N} + \\omega R \\\\\n\\frac{dI}{dt} = \\beta \\frac{SI}{N} - \\gamma I \\\\\n\\frac{dR}{dt} = \\gamma I - \\omega R\n$$\n总人口 $N$ 是恒定的，因此对于所有时间 $t$ 都有 $S(t) + I(t) + R(t) = N$。\n\n**第一部分：地方性平衡发生率 $\\mathcal{I}^{\\ast}$ 的推导**\n\n地方性平衡是疾病在种群中持续存在的稳态。这对应于系统的一个不动点 $(S^{\\ast}, I^{\\ast}, R^{\\ast})$，在该点上所有时间导数都为零，并且感染者人数非零，即 $I^{\\ast}  0$。\n\n将导数设为零，得到平衡方程：\n$$\n(1) \\quad 0 = -\\beta \\frac{S^{\\ast}I^{\\ast}}{N} + \\omega R^{\\ast} \\\\\n(2) \\quad 0 = \\beta \\frac{S^{\\ast}I^{\\ast}}{N} - \\gamma I^{\\ast} \\\\\n(3) \\quad 0 = \\gamma I^{\\ast} - \\omega R^{\\ast}\n$$\n以及平衡状态下的人口守恒：\n$$\n(4) \\quad S^{\\ast} + I^{\\ast} + R^{\\ast} = N\n$$\n从方程 $(2)$ 出发，由于我们寻求的是 $I^{\\ast}  0$ 的地方性平衡，我们可以用 $I^{\\ast}$ 去除：\n$$\n\\beta \\frac{S^{\\ast}}{N} - \\gamma = 0 \\implies S^{\\ast} = \\frac{\\gamma N}{\\beta}\n$$\n使用基本再生数 $R_0 = \\beta/\\gamma$ 的定义，我们可以将平衡状态的易感人群表示为：\n$$\nS^{\\ast} = \\frac{N}{R_0}\n$$\n为了使地方性平衡具有物理意义，易感人群 $S^{\\ast}$ 必须是总人口 $N$ 的一部分。由于 $I^{\\ast}  0$ 且 $R^{\\ast} \\ge 0$，我们必须有 $S^{\\ast}  N$。条件 $S^{\\ast} = N/R_0  N$ 意味着 $R_0  1$。这证实了众所周知的疾病持续存在的阈值条件。\n\n接下来，我们使用方程 $(3)$ 求解 $R^{\\ast}$。假设免疫力消退率 $\\omega  0$：\n$$\n\\omega R^{\\ast} = \\gamma I^{\\ast} \\implies R^{\\ast} = \\frac{\\gamma}{\\omega} I^{\\ast}\n$$\n现在，我们可以将 $S^{\\ast}$ 和 $R^{\\ast}$ 的表达式代入人口守恒方程 $(4)$ 中求解 $I^{\\ast}$：\n$$\n\\frac{\\gamma N}{\\beta} + I^{\\ast} + \\frac{\\gamma}{\\omega} I^{\\ast} = N\n$$\n重新整理各项以求解 $I^{\\ast}$：\n$$\nI^{\\ast} \\left(1 + \\frac{\\gamma}{\\omega}\\right) = N - \\frac{\\gamma N}{\\beta} \\\\\nI^{\\ast} \\left(\\frac{\\omega + \\gamma}{\\omega}\\right) = N \\left(1 - \\frac{\\gamma}{\\beta}\\right) \\\\\nI^{\\ast} = N \\frac{\\omega}{\\omega + \\gamma} \\left(1 - \\frac{\\gamma}{\\beta}\\right)\n$$\n用 $R_0$ 表示，即为：\n$$\nI^{\\ast} = N \\frac{\\omega}{\\omega + \\gamma} \\left(1 - \\frac{1}{R_0}\\right)\n$$\n地方性平衡发生率 $\\mathcal{I}^{\\ast}$ 定义为平衡状态下单位时间内的新感染流量，即 $\\mathcal{I}^{\\ast} = \\beta S^{\\ast} I^{\\ast} / N$。从方程 $(2)$ 中，我们可以看到该量在平衡状态下的一个更简单的表达式：\n$$\n\\beta \\frac{S^{\\ast}I^{\\ast}}{N} = \\gamma I^{\\ast}\n$$\n因此，$\\mathcal{I}^{\\ast} = \\gamma I^{\\ast}$。代入我们推导出的 $I^{\\ast}$ 的表达式：\n$$\n\\mathcal{I}^{\\ast} = \\gamma \\left[ N \\frac{\\omega}{\\omega + \\gamma} \\left(1 - \\frac{\\gamma}{\\beta}\\right) \\right] = N \\frac{\\gamma \\omega}{\\omega + \\gamma} \\left(\\frac{\\beta - \\gamma}{\\beta}\\right)\n$$\n这就是地方性平衡发生率。由非零的免疫力消退率 $\\omega$ 所代表的再感染机制，对于这种地方性状态是至关重要的。如果 $\\omega = 0$（如在具有永久免疫力的标准 SIR 模型中），$I^{\\ast}$ 的表达式变为：\n$$\nI^{\\ast} = N \\frac{0}{0 + \\gamma} \\left(1 - \\frac{1}{R_0}\\right) = 0\n$$\n在这种情况下，$I^{\\ast} = 0$，意味着唯一可能的平衡是无病状态。第一个常微分方程中的项 $\\omega R$ 代表了从康复类对易感类的补充。如果没有这种补充（$\\omega=0$），个体的流动将是 $S \\to I \\to R$ 的单向流动，随着易感人群库的耗尽，疾病最终会消失。因此，当 $R_0  1$ 时，一个正的免疫力消退率 $\\omega  0$ 是允许持续的、非零的地方性发生率 $\\mathcal{I}^{\\ast}  0$ 的机制。\n\n**第二部分：人均地方性平衡发生率 $\\lambda^{\\ast}$ 的计算**\n\n人均地方性平衡发生率定义为 $\\lambda^{\\ast} = \\mathcal{I}^{\\ast} / N$。使用上面推导出的 $\\mathcal{I}^{\\ast}$ 表达式：\n$$\n\\lambda^{\\ast} = \\frac{1}{N} \\left[ N \\frac{\\gamma \\omega}{\\omega + \\gamma} \\left(\\frac{\\beta - \\gamma}{\\beta}\\right) \\right] = \\frac{\\gamma \\omega (\\beta - \\gamma)}{\\beta (\\omega + \\gamma)}\n$$\n问题指定了值 $\\omega = 0.02 \\, \\text{day}^{-1}$，并要求将 $\\lambda^{\\ast}$ 表示为符号常量 $\\beta$ 和 $\\gamma$ 的函数。将此值代入 $\\lambda^{\\ast}$ 的表达式中：\n$$\n\\lambda^{\\ast} = \\frac{\\gamma (0.02) (\\beta - \\gamma)}{\\beta (\\gamma + 0.02)}\n$$\n这可以写成：\n$$\n\\lambda^{\\ast} = \\frac{0.02 \\gamma (\\beta - \\gamma)}{\\beta (\\gamma + 0.02)}\n$$\n参数 $\\beta$、$\\gamma$ 和 $\\omega$ 的单位都是时间倒数（例如 $\\text{day}^{-1}$）。因此，$\\lambda^{\\ast}$ 的表达式的单位是 $\\frac{(\\text{day}^{-1})(\\text{day}^{-1})(\\text{day}^{-1})}{(\\text{day}^{-1})(\\text{day}^{-1})} = \\text{day}^{-1}$，这与人均率是一致的。这就是人均地方性平衡发生率的最终闭式表达式。", "answer": "$$\n\\boxed{\\frac{0.02 \\gamma (\\beta - \\gamma)}{\\beta (\\gamma + 0.02)}}\n$$", "id": "4638494"}]}