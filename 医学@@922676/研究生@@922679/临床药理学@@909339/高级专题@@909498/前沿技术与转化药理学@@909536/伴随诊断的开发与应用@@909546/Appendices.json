{"hands_on_practices": [{"introduction": "伴随诊断（CDx）的一个核心目标是有效地区分可能从特定治疗中受益的患者（响应者）和不太可能受益的患者（非响应者）。受试者工作特征曲线下面积（Area Under the ROC Curve, AUC）是评估一个连续生物标志物区分这两类群体的内在能力的一个基本且不依赖于阈值的指标。本练习通过一个常见的正态分布模型，从第一性原理出发，推导AUC的解析表达式，旨在加深对诊断测试性能量化方法的理解[@problem_id:4542008]。", "problem": "一款靶向肿瘤疗法需要一种伴随诊断来建立其临床有效性，以富集可能产生应答的患者。在治疗开始前，伴随诊断会为每位患者生成一个连续的生物标志物评分 $S$。在一项用于评估临床有效性的关键性试验中，二元临床结局 $Y$ 被定义为应答者 ($Y=1$) 与非应答者 ($Y=0$)。在大样本和检测性能稳定的情况下，可以合理地对条件分布进行建模：\n$$\nS \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2}), \\quad S \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2}),\n$$\n其中患者之间的抽样是独立的，并且两组之间的抽样也是独立的。检测阳性规则是，如果患者的评分 $S \\geq c$（对于某个阈值 $c \\in \\mathbb{R}$），则该患者被分类为适合治疗的阳性患者。\n\n仅从灵敏度、特异度和受试者工作特征（ROC）曲线的核心定义出发，推导由上述模型所蕴含的ROC曲线下面积（AUC）的解析表达式，该表达式应使用 $\\mu_{1}, \\mu_{0}, \\sigma_{1}, \\sigma_{0}$ 来表示。然后，使用参数值 $\\mu_{1}=2.0$, $\\sigma_{1}=0.6$, $\\mu_{0}=1.0$ 和 $\\sigma_{0}=0.5$，计算AUC的数值。将最终的AUC表示为一个无单位的数字，并将答案四舍五入到四位有效数字。", "solution": "该问题要求针对一个特定的概率模型，推导受试者工作特征（ROC）曲线下面积（AUC）的解析表达式，并随后计算其数值。\n\n首先，我们根据问题陈述建立基本定义。连续生物标志物评分 $S$ 基于二元临床结局 $Y$ 进行建模，其条件分布为正态分布，其中 $Y=1$ 表示应答者，$Y=0$ 表示非应答者。\n$$\nS \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2})\n$$\n$$\nS \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})\n$$\n如果患者的评分 $S$ 大于或等于给定的阈值 $c \\in \\mathbb{R}$，即 $S \\ge c$，则检测结果被视为阳性。\n\n在阈值为 $c$ 时，该诊断检测的性能由其灵敏度和特异度来量化。灵敏度，也称为真阳性率（TPR），是应答者被正确分类为阳性的概率。\n$$\n\\text{TPR}(c) = P(S \\ge c \\mid Y=1)\n$$\n特异度是非应答者被正确分类为阴性的概率。\n$$\n\\text{Specificity}(c) = P(S  c \\mid Y=0)\n$$\n假阳性率（FPR）定义为 $1 - \\text{特异度}$，即非应答者被错误分类为阳性的概率。\n$$\n\\text{FPR}(c) = 1 - P(S  c \\mid Y=0) = P(S \\ge c \\mid Y=0)\n$$\nROC曲线是当阈值 $c$ 在所有可能的实数值上变化时，$\\text{TPR}(c)$ 对 $\\text{FPR}(c)$ 的参数图。AUC是该曲线下的面积。\n\n统计理论中一个基本而优雅的结论指出，AUC等价于从阳性组（应答者, $Y=1$）中随机选择一个个体，其得分高于从阴性组（非应答者, $Y=0$）中随机选择一个个体的得分的概率。设 $S_1$ 表示随机选择的应答者的得分，$S_0$ 表示随机选择的非应答者的得分。那么，根据问题的设定，$S_1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma_{1}^{2})$ 且 $S_0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$，并且它们是独立的。因此，AUC可以表示为：\n$$\n\\text{AUC} = P(S_1 > S_0)\n$$\n这个恒等式可以通过对ROC曲线积分来严格证明。AUC为 $\\int_0^1 \\text{TPR} \\,d(\\text{FPR})$。对阈值 $c$ 进行变量替换，并注意到当 $c$ 从 $-\\infty$ 变化到 $+\\infty$ 时，FPR从 $1$ 变化到 $0$：\n$$\n\\text{AUC} = \\int_{\\text{FPR}=1}^{\\text{FPR}=0} \\text{TPR}(c) \\, d(\\text{FPR}(c)) = \\int_{-\\infty}^{\\infty} \\text{TPR}(c) \\left(-\\frac{d(\\text{FPR}(c))}{dc}\\right) dc\n$$\n其中 $\\text{FPR}(c) = \\int_c^\\infty f_0(s)ds$，而 $f_0$ 是 $S \\mid Y=0$ 的概率密度函数（PDF），我们有 $-\\frac{d(\\text{FPR}(c))}{dc} = f_0(c)$。所以，\n$$\n\\text{AUC} = \\int_{-\\infty}^{\\infty} P(S_1 \\ge c) f_0(c) dc = P(S_1 > S_0)\n$$\n为了计算这个概率，我们定义一个新的随机变量 $D = S_1 - S_0$。由于 $S_1$ 和 $S_0$ 是独立的服从正态分布的随机变量，它们的差 $D$ 也服从正态分布。\n$D$ 的均值是均值之差：\n$$\nE[D] = E[S_1] - E[S_0] = \\mu_{1} - \\mu_{0}\n$$\n$D$ 的方差，由于 $S_1$ 和 $S_0$ 的独立性，是方差之和：\n$$\n\\text{Var}(D) = \\text{Var}(S_1 - S_0) = \\text{Var}(S_1) + (-1)^{2}\\text{Var}(S_0) = \\sigma_{1}^{2} + \\sigma_{0}^{2}\n$$\n因此，差的分布为 $D \\sim \\mathcal{N}(\\mu_{1} - \\mu_{0}, \\sigma_{1}^{2} + \\sigma_{0}^{2})$。\n\nAUC是概率 $P(D > 0)$。为了求这个概率，我们将随机变量 $D$ 标准化为一个标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$：\n$$\nZ = \\frac{D - E[D]}{\\sqrt{\\text{Var}(D)}} = \\frac{D - (\\mu_{1} - \\mu_{0})}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\n$$\n不等式 $D > 0$ 可以用 $Z$ 来重写：\n$$\nZ > \\frac{0 - (\\mu_{1} - \\mu_{0})}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}} \\implies Z > -\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\n$$\n令 $\\Phi(z)$ 表示标准正态分布的累积分布函数（CDF），$\\Phi(z) = P(Z \\le z)$。利用性质 $P(Z > a) = 1 - \\Phi(a)$ 和对称性质 $\\Phi(-a) = 1 - \\Phi(a)$，可以得出 $P(Z > -a) = \\Phi(a)$。\n因此，AUC为：\n$$\n\\text{AUC} = P\\left(Z > -\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right) = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}}\\right)\n$$\n这就是所要求的用模型参数表示的AUC的解析表达式。\n\n接下来，我们代入给定的数值：$\\mu_{1}=2.0$, $\\sigma_{1}=0.6$, $\\mu_{0}=1.0$ 和 $\\sigma_{0}=0.5$。\nCDF $\\Phi$ 的自变量计算如下：\n$$\n\\frac{\\mu_{1} - \\mu_{0}}{\\sqrt{\\sigma_{1}^{2} + \\sigma_{0}^{2}}} = \\frac{2.0 - 1.0}{\\sqrt{(0.6)^{2} + (0.5)^{2}}} = \\frac{1.0}{\\sqrt{0.36 + 0.25}} = \\frac{1.0}{\\sqrt{0.61}}\n$$\n我们计算这个自变量的数值：\n$$\n\\frac{1.0}{\\sqrt{0.61}} \\approx \\frac{1.0}{0.78102497} \\approx 1.28037\n$$\n最后，我们计算该值处的标准正态CDF：\n$$\n\\text{AUC} = \\Phi(1.28037) \\approx 0.899797\n$$\n按照要求，将此结果四舍五入到四位有效数字，得到 $0.8998$。", "answer": "$$\n\\boxed{0.8998}\n$$", "id": "4542008"}, {"introduction": "一个诊断测试的理论性能在真实世界应用中会受到多种因素的挑战，其中“分析前变量”是至关重要的一个环节。本练习聚焦于一个具体的实际问题：血液样本从采集到处理之间的延迟，如何影响基于游离DNA（cfDNA）的检测结果[@problem_id:4542003]。通过建立一个量化模型，本练习旨在阐明分析前样本处理不当如何导致背景信号增加、稀释目标信号，从而增加假阴性结果的风险，这对于确保患者安全和临床试验的完整性至关重要。", "problem": "一项精准肿瘤学试验采用伴随诊断 (CDx) 检测，通过定量血浆中游离脱氧核糖核酸 (cfDNA) 的驱动突变，来确定患者是否符合使用激酶抑制剂的资格。该检测方法将样本分类为突变阳性，条件是测得的变异等位基因频率超过一个固定的判定阈值。请考虑以下科学上真实的分析前场景。\n\n将抽血后 $t$ 小时处理时的变异等位基因频率定义为 $f(t) = \\frac{c_t}{c_t + c_b(0) + r t}$，其中 $c_t$ 是抽血时肿瘤来源 cfDNA 的浓度，$c_b(0)$ 是抽血时背景基因组脱氧核糖核酸 (gDNA) 的初始浓度，而 $r$ 是在血浆分离前，室温下因白细胞裂解导致的背景 gDNA 累积速率。如果 $f(t) \\geq \\theta$，其中 $\\theta$ 是判定阈值，则 CDx 检测将样本判定为突变阳性。\n\n假设抽血和血浆分离之间的操作性分析前延迟 $t$ 是一个独立的随机变量，服从均值为 $\\tau$ 小时的指数分布，这与无记忆性的工作流程延迟相符。患者的生物学特性使得在分析前区间内 $c_t$ 和 $c_b(0)$ 是常数，并且在储存条件下速率 $r$ 是恒定的。\n\n从浓度、质量平衡和延迟的指数分布的核心定义出发，推导一个表达式，用于计算一个真实的突变阳性患者仅因分析前延迟而被错误分类为阴性的概率。然后，使用 $c_t = 12\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}$，$c_b(0) = 3\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}$，$r = 12\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}\\,\\mathrm{h}^{-1}$，$\\theta = 0.2$ (无单位分数)，以及 $\\tau = 2\\,\\mathrm{h}$，计算这个假阴性概率。将您的最终答案表示为小数，并四舍五入到四位有效数字。", "solution": "问题要求计算一个真实的突变阳性患者因分析前延迟而被错误分类为阴性的概率。这就是假阴性概率，我们将其表示为 $P_{FN}$。\n\n首先，我们必须验证患者是“真实的突变阳性”这一前提。这意味着在抽血时 ($t=0$)，其变异等位基因频率 $f(0)$ 必须大于或等于判定阈值 $\\theta$。变异等位基因频率由以下函数给出：\n$$f(t) = \\frac{c_t}{c_t + c_b(0) + r t}$$\n在 $t=0$ 时，该函数变为：\n$$f(0) = \\frac{c_t}{c_t + c_b(0)}$$\n使用给定的值，$c_t = 12\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}$ 和 $c_b(0) = 3\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}$：\n$$f(0) = \\frac{12}{12 + 3} = \\frac{12}{15} = 0.8$$\n给定的判定阈值为 $\\theta = 0.2$。由于 $f(0) = 0.8 \\geq 0.2$，患者是真实的突变阳性这一条件得到满足。\n\n当在处理时间 $t$ 测得的变异等位基因频率低于判定阈值时，即 $f(t)  \\theta$，就会出现假阴性结果。我们需要求出这个事件的概率，$P(f(t)  \\theta)$。让我们对随机变量 $t$ 求解这个不等式：\n$$\\frac{c_t}{c_t + c_b(0) + r t}  \\theta$$\n由于 $c_t$，$c_t + c_b(0) + rt$ 和 $\\theta$ 都是正数，我们可以将不等式两边都乘以分母而不改变不等号的方向：\n$$c_t  \\theta (c_t + c_b(0) + r t)$$\n$$c_t  \\theta c_t + \\theta c_b(0) + \\theta r t$$\n现在，我们分离含有 $t$ 的项：\n$$c_t - \\theta c_t - \\theta c_b(0)  \\theta r t$$\n$$c_t(1 - \\theta) - \\theta c_b(0)  \\theta r t$$\n因为我们已经确定 $f(0) > \\theta$，这等价于 $\\frac{c_t}{c_t+c_b(0)} > \\theta$ 或 $c_t > \\theta(c_t+c_b(0))$，所以可以得出 $c_t(1-\\theta) - \\theta c_b(0) > 0$。此外，$\\theta > 0$ 且 $r > 0$。因此，我们可以用 $\\theta r$ 来除不等式两边，而无需改变不等号的方向：\n$$t > \\frac{c_t(1 - \\theta) - \\theta c_b(0)}{\\theta r}$$\n这个不等式定义了导致假阴性结果的分析前延迟 $t$ 所需满足的条件。我们定义一个临界时间 $t_{crit}$，作为该延迟的阈值：\n$$t_{crit} = \\frac{c_t(1 - \\theta) - \\theta c_b(0)}{\\theta r}$$\n如果随机延迟 $t$ 大于这个临界时间，即 $t > t_{crit}$，就会出现假阴性结果。因此，所求的概率是 $P(t > t_{crit})$。\n\n题目说明延迟 $t$ 服从均值为 $\\tau$ 的指数分布。均值为 $\\tau$ 的指数分布的概率密度函数 (PDF) 为 $p(t) = \\frac{1}{\\tau} \\exp(-\\frac{t}{\\tau})$（对于 $t \\geq 0$）。概率 $P(t > t_{crit})$ 由指数分布的生存函数给出：\n$$P(t > t_{crit}) = \\int_{t_{crit}}^{\\infty} \\frac{1}{\\tau} \\exp\\left(-\\frac{t}{\\tau}\\right) dt$$\n计算该积分可得：\n$$P(t > t_{crit}) = \\left[ -\\exp\\left(-\\frac{t}{\\tau}\\right) \\right]_{t_{crit}}^{\\infty} = 0 - \\left(-\\exp\\left(-\\frac{t_{crit}}{\\tau}\\right)\\right) = \\exp\\left(-\\frac{t_{crit}}{\\tau}\\right)$$\n所以，假阴性概率为 $P_{FN} = \\exp\\left(-\\frac{t_{crit}}{\\tau}\\right)$。\n\n现在，我们代入给定的数值来计算结果。\n参数如下：\n$c_t = 12\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}$\n$c_b(0) = 3\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}$\n$r = 12\\,\\mathrm{ng}\\,\\mathrm{mL}^{-1}\\,\\mathrm{h}^{-1}$\n$\\theta = 0.2$\n$\\tau = 2\\,\\mathrm{h}$\n\n首先，我们计算 $t_{crit}$。各物理量的单位是一致的，因此我们可以直接使用数值进行计算：\n$$t_{crit} = \\frac{12(1 - 0.2) - 0.2(3)}{0.2(12)}$$\n$$t_{crit} = \\frac{12(0.8) - 0.6}{2.4}$$\n$$t_{crit} = \\frac{9.6 - 0.6}{2.4}$$\n$$t_{crit} = \\frac{9.0}{2.4} = \\frac{90}{24} = \\frac{15}{4} = 3.75\\,\\mathrm{h}$$\n\n接下来，我们使用这个 $t_{crit}$ 的值和平均延迟 $\\tau=2\\,\\mathrm{h}$ 来计算假阴性概率：\n$$P_{FN} = \\exp\\left(-\\frac{t_{crit}}{\\tau}\\right) = \\exp\\left(-\\frac{3.75}{2}\\right) = \\exp(-1.875)$$\n\n最后，我们计算其数值并四舍五入到四位有效数字：\n$$P_{FN} \\approx 0.15335606...$$\n四舍五入到四位有效数字，我们得到 $0.1534$。", "answer": "$$\\boxed{0.1534}$$", "id": "4542003"}, {"introduction": "伴随诊断的不完美性（即其灵敏度和特异性并非100%）将直接影响临床试验的最终结果。本练习旨在量化这种不完美性所带来的后果[@problem_id:4541995]。当我们将患者招募到基于“测试阳性”结果的临床试验中时，该人群实际上是真正生物标志物阳性（真阳性）和真正生物标志物阴性（假阳性）患者的混合体。本练习将通过计算证明，由于假阳性患者无法从靶向治疗中获益，试验中观察到的治疗效果（例如，相对风险）将被“稀释”，低于其在真正靶向人群中的真实效果。", "problem": "一项III期随机对照试验评估了一种靶向激酶抑制剂，该抑制剂被假设仅在携带特定致癌突变的患者中降低12个月的疾病进展风险。使用伴随诊断（CDx）来招募该突变检测呈阳性的患者。该伴随诊断并不完美，会导致错误分类。假设以下具有科学依据的量和关系。\n\n需采用的基本和核心定义：\n- 贝叶斯定理：对于事件 $A$ 和 $B$，当 $\\Pr(B) \\neq 0$ 时，$\\Pr(A \\mid B) = \\frac{\\Pr(B \\mid A)\\Pr(A)}{\\Pr(B)}$。\n- 诊断灵敏度和特异度：灵敏度 $\\mathrm{Se}$ 是 $\\Pr(\\text{检测阳性} \\mid \\text{真实生物标志物阳性})$，特异度 $\\mathrm{Sp}$ 是 $\\Pr(\\text{检测阴性} \\mid \\text{真实生物标志物阴性})$。\n- 阳性预测值（PPV）：$\\Pr(\\text{真实生物标志物阳性} \\mid \\text{检测阳性})$。\n- 相对风险（RR）：对于治疗组与对照组，$\\mathrm{RR} = \\frac{\\text{治疗组风险}}{\\text{对照组风险}}$。\n\n试验设计和参数：\n- 筛查人群中真实的生物标志物患病率为 $p = 0.3$。\n- 伴随诊断的灵敏度为 $\\mathrm{Se} = 0.85$，特异度为 $\\mathrm{Sp} = 0.90$。\n- 在真实生物标志物阳性的患者中，对照组的12个月疾病进展风险为 $r_{1} = 0.35$。\n- 在真实生物标志物阴性的患者中，对照组的12个月疾病进展风险为 $r_{0} = 0.12$。\n- 该激酶抑制剂仅在真实生物标志物阳性的患者中起作用，在该亚组中对风险产生恒定的乘性效应，治疗相对风险为 $\\mathrm{RR}_{t} = 0.55$；在真实生物标志物阴性的患者中无效果（该亚组的相对风险等于 $1$）。\n- 伴随诊断检测呈阳性的患者按1:1的比例随机分配至治疗组或对照组；风险评估期为12个月。\n\n从贝叶斯定理以及灵敏度、特异度、阳性预测值和相对风险的定义出发，推导在伴随诊断阳性层中观察到的相对风险 $\\mathrm{RR}_{\\text{obs}}$ 的闭式表达式，该表达式应考虑到由不完美的伴随诊断所引起的真实生物标志物阳性和假阳性患者的构成。然后，使用上述数值参数，计算 $\\mathrm{RR}_{\\text{obs}}$ 的数值。将您的答案表示为无量纲比率，并四舍五入至四位有效数字。", "solution": "问题陈述已经过严格验证，被认为是科学合理的、定义明确的、客观的且内部一致的。它提供了一套完整的、形式化定义的量和参数，从而能够得到一个唯一且有意义的解。所描述的情景是临床药理学和药物开发领域中的一个标准且现实的问题，特别是关于伴随诊断靶向治疗的评估。因此，我将进行完整的解答。\n\n目标是推导在伴随诊断（CDx）检测呈阳性的患者层中观察到的相对风险 $\\mathrm{RR}_{\\text{obs}}$ 的闭式表达式，然后计算其数值。\n\n让我们定义以下事件：\n- $M^{+}$: 患者为真实生物标志物阳性的事件。\n- $M^{-}$: 患者为真实生物标志物阴性的事件。\n- $T^{+}$: 患者伴随诊断检测呈阳性的事件。\n- $T^{-}$: 患者伴随诊断检测呈阴性的事件。\n- $D$: 患者在 $12$ 个月内经历疾病进展的事件。\n- $Tr$: 患者被随机分配到治疗组的事件。\n- $C$: 患者被随机分配到对照组的事件。\n\n问题提供了以下参数：\n- 真实生物标志物患病率：$\\Pr(M^{+}) = p = 0.3$。因此，$\\Pr(M^{-}) = 1 - p = 0.7$。\n- 伴随诊断灵敏度：$\\mathrm{Se} = \\Pr(T^{+} \\mid M^{+}) = 0.85$。\n- 伴随诊断特异度：$\\mathrm{Sp} = \\Pr(T^{-} \\mid M^{-}) = 0.90$。由此，我们可以推导出假阳性率：$\\Pr(T^{+} \\mid M^{-}) = 1 - \\mathrm{Sp} = 1 - 0.90 = 0.10$。\n- 真实阳性患者在对照组中的风险：$r_{1} = \\Pr(D \\mid M^{+}, C) = 0.35$。\n- 真实阴性患者在对照组中的风险：$r_{0} = \\Pr(D \\mid M^{-}, C) = 0.12$。\n- 真实阳性患者中治疗的相对风险：$\\mathrm{RR}_{t} = \\frac{\\Pr(D \\mid M^{+}, Tr)}{\\Pr(D \\mid M^{+}, C)} = 0.55$。\n- 真实阴性患者中治疗的相对风险：$\\frac{\\Pr(D \\mid M^{-}, Tr)}{\\Pr(D \\mid M^{-}, C)} = 1$。\n\n观察到的相对风险 $\\mathrm{RR}_{\\text{obs}}$ 是在伴随诊断阳性层 ($T^{+}$) 患者中，治疗组的疾病进展风险与对照组的疾病进展风险之比。\n$$\n\\mathrm{RR}_{\\text{obs}} = \\frac{\\Pr(D \\mid T^{+}, Tr)}{\\Pr(D \\mid T^{+}, C)}\n$$\n\n首先，我们必须描述伴随诊断阳性 ($T^{+}$) 人群的构成。这个人群是真实生物标志物阳性患者（真阳性）和真实生物标志物阴性患者（假阳性）的混合体。在检测呈阳性者中，真阳性的比例是阳性预测值（PPV），此处表示为 $\\pi_{\\text{PPV}}$。\n$$\n\\pi_{\\text{PPV}} = \\Pr(M^{+} \\mid T^{+})\n$$\n使用贝叶斯定理和全概率公式，我们可以用给定的参数来表示 $\\pi_{\\text{PPV}}$。分母 $\\Pr(T^{+})$ 计算如下：\n$$\n\\Pr(T^{+}) = \\Pr(T^{+} \\mid M^{+})\\Pr(M^{+}) + \\Pr(T^{+} \\mid M^{-})\\Pr(M^{-})\n$$\n代入给定的定义：\n$$\n\\Pr(T^{+}) = \\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp}) \\cdot (1 - p)\n$$\n那么PPV是：\n$$\n\\pi_{\\text{PPV}} = \\Pr(M^{+} \\mid T^{+}) = \\frac{\\Pr(T^{+} \\mid M^{+})\\Pr(M^{+})}{\\Pr(T^{+})} = \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\n$$\n在伴随诊断阳性组中，假阳性的比例是 $\\Pr(M^{-} \\mid T^{+}) = 1 - \\pi_{\\text{PPV}}$。\n\n接下来，我们推导对照组中观察到的风险的表达式，$R_{\\text{control, obs}} = \\Pr(D \\mid T^{+}, C)$。这是真阳性和假阳性亚组风险的加权平均值，权重是它们在 $T^{+}$ 队列中的各自比例。\n$$\nR_{\\text{control, obs}} = \\Pr(D \\mid M^{+}, C)\\Pr(M^{+} \\mid T^{+}) + \\Pr(D \\mid M^{-}, C)\\Pr(M^{-} \\mid T^{+})\n$$\n代入定义的项：\n$$\nR_{\\text{control, obs}} = r_{1} \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})\n$$\n\n类似地，我们推导治疗组中观察到的风险的表达式，$R_{\\text{treat, obs}} = \\Pr(D \\mid T^{+}, Tr)$。\n接受治疗的真实阳性患者的风险是 $\\Pr(D \\mid M^{+}, Tr) = \\mathrm{RR}_{t} \\cdot \\Pr(D \\mid M^{+}, C) = \\mathrm{RR}_{t} \\cdot r_{1}$。\n接受治疗的真实阴性患者的风险是 $\\Pr(D \\mid M^{-}, Tr) = 1 \\cdot \\Pr(D \\mid M^{-}, C) = r_{0}$。\n治疗组中观察到的风险是加权平均值：\n$$\nR_{\\text{treat, obs}} = \\Pr(D \\mid M^{+}, Tr)\\Pr(M^{+} \\mid T^{+}) + \\Pr(D \\mid M^{-}, Tr)\\Pr(M^{-} \\mid T^{+})\n$$\n代入定义的项：\n$$\nR_{\\text{treat, obs}} = (\\mathrm{RR}_{t} \\cdot r_{1}) \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})\n$$\n\n最后，我们可以写出观察到的相对风险 $\\mathrm{RR}_{\\text{obs}}$ 的闭式表达式：\n$$\n\\mathrm{RR}_{\\text{obs}} = \\frac{R_{\\text{treat, obs}}}{R_{\\text{control, obs}}} = \\frac{(\\mathrm{RR}_{t} \\cdot r_{1}) \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})}{r_{1} \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}})}\n$$\n代入 $\\pi_{\\text{PPV}}$ 的表达式，得到以基本参数表示的完整闭式表达式：\n$$\n\\mathrm{RR}_{\\text{obs}} = \\frac{(\\mathrm{RR}_{t} \\cdot r_{1}) \\left(\\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right) + r_{0} \\left(1 - \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right)}{r_{1} \\left(\\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right) + r_{0} \\left(1 - \\frac{\\mathrm{Se} \\cdot p}{\\mathrm{Se} \\cdot p + (1 - \\mathrm{Sp})(1 - p)}\\right)}\n$$\n这就是所要求的闭式表达式。\n\n现在，我们使用提供的参数计算数值：\n$p = 0.3$, $\\mathrm{Se} = 0.85$, $\\mathrm{Sp} = 0.90$, $r_{1} = 0.35$, $r_{0} = 0.12$, $\\mathrm{RR}_{t} = 0.55$。\n\n1.  计算检测呈阳性的概率 $\\Pr(T^{+})$：\n    $$\n    \\Pr(T^{+}) = (0.85)(0.3) + (1 - 0.90)(1 - 0.3) = 0.255 + (0.10)(0.7) = 0.255 + 0.070 = 0.325\n    $$\n\n2.  计算阳性预测值 $\\pi_{\\text{PPV}}$：\n    $$\n    \\pi_{\\text{PPV}} = \\Pr(M^{+} \\mid T^{+}) = \\frac{\\Pr(T^{+} \\mid M^{+})\\Pr(M^{+})}{\\Pr(T^{+})} = \\frac{0.255}{0.325} = \\frac{51}{65}\n    $$\n    因此，假阳性的比例是 $1 - \\pi_{\\text{PPV}} = 1 - \\frac{51}{65} = \\frac{14}{65}$。\n\n3.  计算对照组中观察到的风险 ($R_{\\text{control, obs}}$)：\n    $$\n    R_{\\text{control, obs}} = r_{1} \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}}) = (0.35)\\left(\\frac{51}{65}\\right) + (0.12)\\left(\\frac{14}{65}\\right)\n    $$\n    $$\n    R_{\\text{control, obs}} = \\frac{(0.35)(51) + (0.12)(14)}{65} = \\frac{17.85 + 1.68}{65} = \\frac{19.53}{65} \\approx 0.30046\n    $$\n\n4.  计算治疗组中观察到的风险 ($R_{\\text{treat, obs}}$)：\n    $$\n    R_{\\text{treat, obs}} = (\\mathrm{RR}_{t} \\cdot r_{1}) \\cdot \\pi_{\\text{PPV}} + r_{0} \\cdot (1 - \\pi_{\\text{PPV}}) = ((0.55)(0.35))\\left(\\frac{51}{65}\\right) + (0.12)\\left(\\frac{14}{65}\\right)\n    $$\n    $$\n    R_{\\text{treat, obs}} = \\frac{(0.55)(0.35)(51) + (0.12)(14)}{65} = \\frac{(0.1925)(51) + 1.68}{65} = \\frac{9.8175 + 1.68}{65} = \\frac{11.4975}{65} \\approx 0.17688\n    $$\n\n5.  计算观察到的相对风险 ($\\mathrm{RR}_{\\text{obs}}$)：\n    $$\n    \\mathrm{RR}_{\\text{obs}} = \\frac{R_{\\text{treat, obs}}}{R_{\\text{control, obs}}} = \\frac{11.4975/65}{19.53/65} = \\frac{11.4975}{19.53} \\approx 0.5886994367...\n    $$\n四舍五入至四位有效数字，观察到的相对风险为 $0.5887$。这个值大于生物标志物阳性亚组中的真实相对风险 ($\\mathrm{RR}_{t} = 0.55$)，这是因为包含了未从治疗中受益的假阳性患者，从而稀释了观察到的治疗效果。", "answer": "$$\n\\boxed{0.5887}\n$$", "id": "4541995"}]}