{"hands_on_practices": [{"introduction": "这项练习是连接群体遗传学与临床流行病学的基础。通过应用哈迪-温伯格平衡原理，您将估算 HLA-B*58:01 等位基因的基因型频率，并计算在一个大型队列中预期出现的严重药物不良反应病例数。该实践将巩固您对一个等位基因在人群中的流行率如何转化为可量化的公共卫生负担的理解，这是评估任何潜在药物基因组学干预措施的关键第一步 [@problem_id:4558958]。", "problem": "一个临床药理学项目正在评估对别嘌醇进行预防性药物基因组学筛查，以减少严重皮肤不良反应（SCAR）。研究重点是人类白细胞抗原（HLA）基因座 $HLA\\text{-}B$，将 HLA-B*58:01 建模为单个等位基因，其群体等位基因频率为 $p = 0.10$，并将所有其他 $HLA\\text{-}B$ 等位基因聚合为一个互补类别，其频率为 $q$，其中 $p + q = 1$。假设该群体处于哈迪-温伯格平衡（HWE）状态，并且对于该基因座满足随机交配，无选择、迁移或突变。\n\n一个来自该群体的 $N = 10000$ 名个体组成的队列将全部开始使用别嘌醇。假设基因型与药物暴露之间相互独立，并且在初始暴露期间SCAR的流行病学参数如下：非携带者的基线绝对风险为 $r_{0} = 1.5 \\times 10^{-4}$，携带者（HLA-B*58:01 的杂合子或纯合子）的基因型特异性相对风险为 $\\mathrm{RR} = 100$。\n\n仅从HWE的基本定义和基础概率论出发，推导预期的基因型频率和数量、携带者频率，然后计算该队列中SCAR病例的总预期数量。将您的最终答案四舍五入至三位有效数字。将您的最终答案表示为个体数量（最终数值答案中不带单位）。", "solution": "该问题被认为是有效的，因为它在群体遗传学和流行病学方面有科学依据，问题提出得当，数据充分且一致，并且陈述客观。我们将进行逐步推导。\n\n该问题要求我们计算在一个由 $N=10000$ 名接受别嘌醇治疗的个体组成的队列中，严重皮肤不良反应（SCAR）病例的总预期数量。解决方案源自哈迪-温伯格平衡（HWE）原理以及流行病学风险的定义。\n\n设风险等位基因为 HLA-B*58:01，我们将其表示为 $A$。其在群体中的频率给定为 $p = 0.10$。所有其他 $HLA\\text{-}B$ 等位基因被聚合为单个类别，我们将其表示为 $a$。该类别的频率为 $q$。根据问题陈述，等位基因频率之和为1：\n$$p + q = 1$$\n由此，我们可以计算非风险等位基因类别 $a$ 的频率：\n$$q = 1 - p = 1 - 0.10 = 0.90$$\n\n假设群体处于哈迪-温伯格平衡状态。在HWE条件下，对于一个双等位基因座，预期的基因型频率由二项式展开 $(p+q)^2 = p^2 + 2pq + q^2 = 1$ 的各项给出。\n三种可能的基因型是：\n1.  风险等位基因纯合子（$AA$）：频率 $f(AA) = p^2$\n2.  杂合子（$Aa$）：频率 $f(Aa) = 2pq$\n3.  非风险等位基因类别纯合子（$aa$）：频率 $f(aa) = q^2$\n\n我们可以使用 $p$ 和 $q$ 的值来计算这些频率：\n$$f(AA) = p^2 = (0.10)^2 = 0.01$$\n$$f(Aa) = 2pq = 2(0.10)(0.90) = 0.18$$\n$$f(aa) = q^2 = (0.90)^2 = 0.81$$\n作为检验，这些频率的总和是 $0.01 + 0.18 + 0.81 = 1.00$。\n\n问题将“携带者”定义为 HLA-B*58:01 等位基因的杂合子（$Aa$）或纯合子（$AA$）的个体。“非携带者”是非风险等位基因类别（$aa$）的纯合子个体。\n\n携带者的频率 $f_{\\text{carrier}}$ 是 $AA$ 和 $Aa$ 基因型频率的总和：\n$$f_{\\text{carrier}} = f(AA) + f(Aa) = p^2 + 2pq$$\n$$f_{\\text{carrier}} = 0.01 + 0.18 = 0.19$$\n或者，携带者频率可以计算为1减去非携带者频率：\n$$f_{\\text{carrier}} = 1 - f(aa) = 1 - q^2 = 1 - (0.90)^2 = 1 - 0.81 = 0.19$$\n\n非携带者的频率 $f_{\\text{non-carrier}}$ 是 $aa$ 基因型的频率：\n$$f_{\\text{non-carrier}} = f(aa) = q^2 = 0.81$$\n\n接下来，我们确定在大小为 $N = 10000$ 的队列中每个类别中的预期个体数量。\n预期携带者数量 $N_{\\text{carrier}}$ 是：\n$$N_{\\text{carrier}} = N \\times f_{\\text{carrier}} = 10000 \\times 0.19 = 1900$$\n预期非携带者数量 $N_{\\text{non-carrier}}$ 是：\n$$N_{\\text{non-carrier}} = N \\times f_{\\text{non-carrier}} = 10000 \\times 0.81 = 8100$$\n总和 $N_{\\text{carrier}} + N_{\\text{non-carrier}} = 1900 + 8100 = 10000$，即为总队列大小 $N$。\n\n现在，我们引入流行病学风险参数。SCAR病例的总预期数量 $C_{\\text{total}}$ 是携带者组和非携带者组中预期病例数的总和。\n一个组中的预期病例数是该组中的个体数量与他们发生该状况的绝对风险的乘积。\n\n非携带者的基线绝对风险给定为 $r_0 = 1.5 \\times 10^{-4}$。\n非携带者组中的预期病例数 $C_{\\text{non-carrier}}$ 是：\n$$C_{\\text{non-carrier}} = N_{\\text{non-carrier}} \\times r_0$$\n\n携带者的相对风险给定为 $\\mathrm{RR} = 100$。因此，携带者的绝对风险 $r_1$ 是：\n$$r_1 = r_0 \\times \\mathrm{RR}$$\n携带者组中的预期病例数 $C_{\\text{carrier}}$ 是：\n$$C_{\\text{carrier}} = N_{\\text{carrier}} \\times r_1 = N_{\\text{carrier}} \\times (r_0 \\times \\mathrm{RR})$$\n\n预期病例总数是其和：\n$$C_{\\text{total}} = C_{\\text{non-carrier}} + C_{\\text{carrier}}$$\n代入上面推导出的表达式：\n$$C_{\\text{total}} = (N_{\\text{non-carrier}} \\times r_0) + (N_{\\text{carrier}} \\times r_0 \\times \\mathrm{RR})$$\n在用频率表示各组大小后，我们可以提取公因式 $N$ 和 $r_0$：\n$$C_{\\text{total}} = (N \\times q^2 \\times r_0) + (N \\times (p^2+2pq) \\times r_0 \\times \\mathrm{RR})$$\n$$C_{\\text{total}} = N r_0 [q^2 + (p^2+2pq) \\mathrm{RR}]$$\n\n现在，我们将数值代入 $C_{\\text{non-carrier}}$ 和 $C_{\\text{carrier}}$ 的表达式中：\n$$r_1 = (1.5 \\times 10^{-4}) \\times 100 = 1.5 \\times 10^{-2} = 0.015$$\n$$C_{\\text{non-carrier}} = 8100 \\times (1.5 \\times 10^{-4}) = 1.215$$\n$$C_{\\text{carrier}} = 1900 \\times 0.015 = 28.5$$\n\n最后，我们将这些值相加以求得预期病例总数：\n$$C_{\\text{total}} = 1.215 + 28.5 = 29.715$$\n\n问题要求将最终答案四舍五入到三位有效数字。数字 $29.715$ 四舍五入到三位有效数字是 $29.7$。", "answer": "$$\\boxed{29.7}$$", "id": "4558958"}, {"introduction": "从群体层面的负担转向临床干预，这项练习要求您评估一项药物基因组学筛查测试的性能。您将计算并解释在别嘌醇引起的严重皮肤不良反应（SCAR）背景下的关键诊断指标，例如敏感性、特异性、阳性预测值（PPV）、阴性预测值（NPV）以及需要进行基因分型的人数（NNG）。掌握这些概念对于批判性地评估基因测试的效用，以及理解测试的分析性能与其在真实临床环境中的预测能力之间的显著差异至关重要 [@problem_id:4559001]。", "problem": "一个卫生系统正在评估在开始使用别嘌醇时，采用预防性人类白细胞抗原（HLA）基因分型以预防严重皮肤不良反应（SCAR）的效果。SCAR包括史蒂文斯-约翰逊综合征和中毒性表皮坏死松解症。如果存在高风险等位基因HLA-B*58:01，则该检测会将患者标记为阳性。在不进行基因筛查即开始使用别嘌醇的策略下，请考虑以下经验性的、特定于人群的性能特征和基线风险：在治疗的前$2$个月内，由别嘌醇诱导的SCAR发生率为$0.05\\%$（即每次用药发生$0.0005$次）。在如果暴露（暴露下的反事实风险）就会发生SCAR的患者中，$85\\%$的人携带HLA-B*58:01。在如果暴露也不会发生SCAR的患者中，$10\\%$的人携带HLA-B*58:01。假设基因分型检测在等位基因存在时能完美检测到它，并且如果所有检测呈阳性的患者完全避免使用别嘌醇，他们当中所有由等位基因介导的SCAR病例都将被预防，而不会影响检测呈阴性患者的剩余SCAR风险。阳性预测值（PPV）定义为在基因分型检测呈阳性的情况下，患者如果暴露会发生SCAR的概率；阴性预测值（NPV）定义为在基因分型检测呈阴性的情况下，患者如果暴露不会发生SCAR的概率。\n\n对于这个人群和检测策略，以下哪些陈述是正确的？\n\nA. 在此背景下，敏感性是指在如果暴露就会发生由别嘌醇诱导的SCAR的患者中，基因分型检测呈阳性的概率。\n\nB. 特异性是指在基因分型检测呈阴性的情况下，患者不会发生SCAR的概率。\n\nC. 该人群的PPV约为$0.4\\%$，意味着在检测呈阳性的患者中，如果他们暴露于别嘌醇，大约每$1000$人中有$4$人会发生SCAR。\n\nD. NPV约为$99.99\\%$，这意味着在检测呈阴性的患者中，如果暴露，其剩余SCAR风险约为$12{,}000$分之$1$。\n\nE. 如果所有检测呈阳性的患者都避免使用别嘌醇，在那些本应暴露的患者中，被预防的SCAR病例比例将约等于该检测的特异性。\n\nF. 假设检测呈阳性的个体完全依从并完全避免使用别嘌醇，为预防一例SCAR病例所需的预期基因分型检测人数约为$2350$。", "solution": "首先验证问题陈述的科学合理性、清晰度和完整性。\n\n### 第1步：提取已知条件\n\n设$D$为患者在暴露于药物后会发生由别嘌醇诱导的严重皮肤不良反应（SCAR）的事件。\n设$D^c$为患者在暴露后不会发生SCAR的事件。\n设$T$为患者$HLA-B^*58{:}01$等位基因检测呈阳性的事件。\n设$T^c$为患者该等位基因检测呈阴性的事件。\n\n问题提供了以下数据和定义：\n1. SCAR的基线发生率：这是发生SCAR的先验概率，$P(D) = 0.05\\% = 0.0005$。\n2. 在会发生SCAR的患者中该等位基因的患病率：这是给定条件下检测呈阳性的概率，$P(T|D) = 85\\% = 0.85$。\n3. 在不会发生SCAR的患者中该等位基因的患病率：这是在没有该病症的情况下检测呈阳性的概率，$P(T|D^c) = 10\\% = 0.10$。\n4. 基因分型检测是完美的，意味着检测结果完美反映了等位基因的存在与否。\n5. 所有检测呈阳性的患者都避免使用别嘌醇，从而预防所有等位基因介导的SCAR病例。检测呈阴性患者的剩余SCAR风险不受影响。\n6. 阳性预测值（PPV）的定义：$P(D|T)$。\n7. 阴性预测值（NPV）的定义：$P(D^c|T^c)$。\n\n### 第2步：使用提取的已知条件进行验证\n\n- **科学依据**：该问题设置在药物基因组学这一成熟领域，具体涉及$HLA-B^*58{:}01$等位基因与别嘌醇诱导的SCAR之间广为人知的关联。使用敏感性、特异性、PPV和NPV等概念是评估诊断和筛查测试的标准方法。所提供的发生率和患病率数据在流行病学上是合理的。该问题在科学上和事实上都是合理的。\n- **良态问题**：该问题提供了计算所需指标（PPV、NPV、NNG等）的所有必要数据。问题的结构确保了每个部分都有唯一且稳定的解集。\n- **客观性**：语言精确且量化，没有主观论断或模糊不清之处。\n\n### 第3步：结论与行动\n\n问题陈述是有效的。它在科学上是合理的、良态的且客观的。我将继续进行完整的解答和分析。\n\n### 推导过程\n\n首先，我们从已知条件中推导出关键概率。\n不发生SCAR的先验概率是：\n$P(D^c) = 1 - P(D) = 1 - 0.0005 = 0.9995$。\n\n给出的信息对应于标准的测试性能指标：\n- 测试的敏感性（等位基因作为疾病的标志物）是$P(T|D) = 0.85$。\n- 非患病者检测呈阳性的概率是$P(T|D^c) = 0.10$。\n- 测试的特异性是非患病者检测呈阴性的概率：$P(T^c|D^c) = 1 - P(T|D^c) = 1 - 0.10 = 0.90$。\n\n为了計算PPV和NPV，我们首先需要使用全概率定律计算出检测呈阳性的总概率$P(T)$：\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\n$$P(T) = (0.85)(0.0005) + (0.10)(0.9995)$$\n$$P(T) = 0.000425 + 0.09995 = 0.100375$$\n检测呈阴性的概率是：\n$P(T^c) = 1 - P(T) = 1 - 0.100375 = 0.899625$。\n\n现在我们可以计算PPV和NPV。\n**阳性预测值 (PPV):**\n$$PPV = P(D|T) = \\frac{P(T|D)P(D)}{P(T)} = \\frac{0.000425}{0.100375} \\approx 0.004234$$\n\n**阴性预测值 (NPV):**\n$$NPV = P(D^c|T^c) = \\frac{P(T^c|D^c)P(D^c)}{P(T^c)} = \\frac{(0.90)(0.9995)}{0.899625} = \\frac{0.89955}{0.899625} \\approx 0.9999166$$\n\n### 逐项分析\n\n**A. 在此背景下，敏感性是指在如果暴露就会发生由别嘌醇诱导的SCAR的患者中，基因分型检测呈阳性的概率。**\n\n诊断测试敏感性的定义是，在个体患有疾病（$D$）的情况下，测试结果呈阳性（$T$）的概率，记为$P(T|D)$。该陈述正确地将“基因分型检测呈阳性”映射到测试结果，将“如果暴露就会发生...SCAR”映射到疾病状态。这与敏感性的定义相符。\n**结论：正确。**\n\n**B. 特异性是指在基因分型检测呈阴性的情况下，患者不会发生SCAR的概率。**\n\n特异性的定义是，在个体未患病（$D^c$）的情况下，测试结果呈阴性（$T^c$）的概率，记为$P(T^c|D^c)$。该陈述描述的是“在基因分型检测呈阴性[$T^c$]的情况下，患者不会发生SCAR[$D^c$]的概率”。这是概率$P(D^c|T^c)$，是阴性预测值（NPV）的定义，而不是特异性。\n**结论：错误。**\n\n**C. 该人群的PPV约为$0.4\\%$，意味着在检测呈阳性的患者中，如果他们暴露于别嘌醇，大约每$1000$人中有$4$人会发生SCAR。**\n\n根据我们的计算，$PPV \\approx 0.004234$。换算成百分比是$0.004234 \\times 100\\% = 0.4234\\%$，约等于$0.4\\%$。换算成比率是每$1000$人中有$0.004234 \\times 1000 = 4.234$人，约等于$1000$人中有$4$人。选项中提供的PPV解释也是正确的。\n**结论：正确。**\n\n**D. NPV约为$99.99\\%$，这意味着在检测呈阴性的患者中，如果暴露，其剩余SCAR风险约为$12{,}000$分之$1$。**\n\n根据我们的计算，$NPV \\approx 0.9999166$。换算成百分比是$99.99166\\%$，约等于$99.99\\%$。检测呈阴性患者的剩余SCAR风险是在检测结果呈阴性（$T^c$）的情况下发生SCAR（$D$）的概率，即$P(D|T^c)$。$P(D|T^c) = 1 - P(D^c|T^c) = 1 - NPV \\approx 1 - 0.9999166 = 0.0000834$。为了将其表示为“X分之一”的形式，我们计算$X = 1 / 0.0000834 \\approx 11990$。这个值约等于$12{,}000$。该陈述的两个部分都准确。\n**结论：正确。**\n\n**E. 如果所有检测呈阳性的患者都避免使用别嘌醇，在那些本应暴露的患者中，被预防的SCAR病例比例将约等于该检测的特异性。**\n\n在没有筛查的人群中，会发生的SCAR病例总数与总体风险$P(D)$成正比。筛查策略预防了本应在检测呈阳性的患者中发生的SCAR病例。此类病例的数量与$P(D \\cap T)$成正比。被预防的病例比例是预防的病例数与总病例数之比：\n$$\\text{被预防的比例} = \\frac{P(D \\cap T)}{P(D)}$$\n使用条件概率的定义，$P(D \\cap T) = P(T|D)P(D)$。\n$$\\text{被预防的比例} = \\frac{P(T|D)P(D)}{P(D)} = P(T|D)$$\n$P(T|D)$是测试的**敏感性**。在本问题中，敏感性是$0.85$。特异性是$P(T^c|D^c) = 0.90$。该陈述错误地宣称被预防的病例比例等于特异性。\n**结论：错误。**\n\n**F. 假设检测呈阳性的个体完全依从并完全避免使用别嘌醇，为预防一例SCAR病例所需的预期基因分型检测人数约为$2350$。**\n\n为预防一例不良事件所需的基因分型检测人数（Number Needed to Genotype, NNG）是筛查策略实现的绝对风险降低（Absolute Risk Reduction, ARR）的倒数。\nARR是基线风险与干预后风险之差。\n基线风险 = $P(D) = 0.0005$。\n在筛查干预下，只有检测呈阴性的患者才服用别嘌醇。发生的SCAR病例是那些检测呈阴性的患者。因此，筛查后的人群层面风险为$P(D \\cap T^c)$。\n$ARR = P(\\text{无筛查风险}) - P(\\text{有筛查风险}) = P(D) - P(D \\cap T^c)$。\n由于$P(D) = P(D \\cap T) + P(D \\cap T^c)$，ARR简化为成功筛查出的群体的风险：\n$ARR = P(D \\cap T)$。\n我们可以计算出$P(D \\cap T) = P(T|D)P(D) = (0.85)(0.0005) = 0.000425$。\nNNG是ARR的倒数：\n$$NNG = \\frac{1}{ARR} = \\frac{1}{0.000425} = 2352.94...$$\n这个值非常接近$2350$。\n**结论：正确。**", "answer": "$$\\boxed{ACDF}$$", "id": "4559001"}, {"introduction": "这最后一项实践将分析提升到个性化医疗的层面，将遗传数据与多个临床风险因素相结合。您将构建并评估一个用于预测别嘌醇引起的严重皮肤不良反应（SCAR）的多变量风险模型，学习肾功能、剂量和年龄等因素如何与 HLA-B*58:01 等位基因相互作用。该练习强调了稳健统计建模和风险分层的原则，使您具备超越单标记关联、发展更全面、以患者为中心的药物超敏反应预测方法的能力 [@problem_id:4559022]。", "problem": "一位临床医生计划根据四个预设的风险因素来估计开始使用 allopurinol 后发生严重皮肤不良反应 (SCAR) 的 $8$ 周概率：人类白细胞抗原 B 等位基因 HLA-B*58:01 ($\\text{HLA}$) 的存在、慢性肾脏病 (CKD) 分期、起始剂量和年龄。目标量是患者在 $8$ 周内发生 SCAR 的概率 $p$。假设在固定时间窗内对罕见二元结局进行临床风险建模时，以下经验证、充分检验的基础成立：概率 $p$ 与优势 $\\dfrac{p}{1-p}$ 相关联，且对 $p$ 的优势有近似乘性作用的风险因素可以在对数优势尺度上加性组合。该临床医生选择了一位临床定义的参照患者：HLA-B*58:01 阴性，CKD $1$ 期或 $2$ 期，起始剂量 $100$ 毫克/天，年龄 $40$ 岁，其基线 $8$ 周 SCAR 概率为 $p_0 = 10^{-4}$。对于与此参照的偏离，使用以下先前证据支持的优势乘性变化：HLA-B*58:01 阳性使优势乘以 $80$，CKD 分期 $\\ge 3$ 使优势乘以 $3$，起始剂量在 $100$ 毫克/天的基础上每增加 $100$ 毫克/天，优势乘以 $1.5$，年龄在 $40$ 岁的基础上每增加十岁，优势乘以 $1.2$，并且存在一个生物学上合理的剂量与 CKD 的交互作用，即当 CKD 分期 $\\ge 3$ 时，每增加 $100$ 毫克/天的剂量增量，优势会额外乘以 $1.3$。定义协变量如下：$X_1$ 是 HLA-B*58:01 阳性的指示变量（阳性为 $1$，否则为 $0$），$X_2$ 是 CKD 分期 $\\ge 3$ 的指示变量，$X_3$ 是高于 $100$ 毫克/天的 $100$ 毫克/天增量数，$X_4$ 是高于 $40$ 岁的十年数，$X_5 = X_2 \\times X_3$ 编码了预设的交互作用。考虑一个新患者：HLA-B*58:01 阳性，患有 CKD $3$ 期，起始剂量为 $200$ 毫克/天，年龄为 $70$ 岁。\n\n哪个选项最好地构建了在这些假设下的 allopurinol SCAR 多变量风险模型，给出了所述患者正确的患者级风险计算，并正确地证明了变量选择策略的合理性？\n\nA. 为 $8$ 周 SCAR 概率指定一个适合罕见事件的、惩罚性的逻辑斯蒂回归，其对数优势线性预测器包含 $X_1, X_2, X_3, X_4$ 和预设的交互作用 $X_5$，将 CKD 编码为分期 $\\ge 3$ 的二元指示变量，保留年龄和剂量为参照 $40$ 岁和 $100$ 毫克/天的连续尺度以避免信息丢失，并基于药物遗传学和病理生理学证据先验地选择变量，而不是基于单变量显著性。使用与乘性效应一致的基于优势的组合来推导患者风险。对于所述患者（$X_1=1, X_2=1, X_3=1, X_4=3, X_5=1$），预测概率约为 $p \\approx 0.075$。通过使用 Firth 惩罚来稳定系数估计，以应对 SCAR 的预期稀疏性，从而证明罕见事件偏差的减少是合理的。\n\nB. 在 $8$ 周窗口期内拟合一个 Cox 比例风险模型，在 $p0.05$ 时通过向后逐步法选择变量，将年龄在 $65$ 岁和剂量在 $200$ 毫克/天处二分化，包含用药开始后的实验室值以改善拟合，并通过将风险比的乘积解释为概率来计算患者的风险。这得出的患者风险接近 $p \\approx 0.29$。\n\nC. 构建一个朴素贝叶斯分类器，将 HLA-B*58:01、CKD、剂量和年龄视为独立的似然贡献者，在 $p0.05$ 时进行单变量筛选选择变量，并将给定的优势比相加作为对风险（而不是优势）的加性效应。这得出的患者风险约为 $p \\approx 0.13$。\n\nD. 使用逻辑斯蒂回归，但将年龄在 $65$ 岁和剂量在 $200$ 毫克/天处二分化，舍弃 CKD 以避免与剂量的多重共线性，将 HLA-B*58:01 编码为等位基因拷贝数的三水平有序变量且不考虑显性，禁止交互作用以限制复杂性，并通过交叉验证的逐步程序选择变量。估计患者的风险为 $p \\approx 0.03$。\n\n选择唯一的最佳选项。", "solution": "首先将验证问题陈述，然后对选项进行全面推导和评估。\n\n### 问题验证\n\n**第 1 步：提取给定信息**\n\n- **目标：** 估计开始使用 allopurinol 后发生严重皮肤不良反应 (SCAR) 的 $8$ 周概率 ($p$)。\n- **风险因素：** HLA-B*58:01 ($\\text{HLA}$)、慢性肾脏病 (CKD) 分期、起始剂量和年龄。\n- **建模框架：** 概率 $p$ 与优势 $\\dfrac{p}{1-p}$ 相关联。风险因素对优势有乘性作用，这等同于在对数优势尺度上具有加性作用。\n- **参照患者：** HLA-B*58:01 阴性，CKD $1$ 期或 $2$ 期，起始剂量 $100$ 毫克/天，年龄 $40$ 岁。\n- **基线风险：** 对于参照患者，$8$ 周 SCAR 概率为 $p_0 = 10^{-4}$。\n- **乘性优势比 (ORs)：**\n    - HLA-B*58:01 阳性：优势乘以 $80$。\n    - CKD 分期 $\\ge 3$：优势乘以 $3$。\n    - 起始剂量在 $100$ 毫克/天的基础上每增加 $100$ 毫克/天：优势乘以 $1.5$。\n    - 年龄在 $40$ 岁的基础上每增加十岁：优势乘以 $1.2$。\n    - 剂量与 CKD 的交互作用：当 CKD 分期 $\\ge 3$ 时，每增加 $100$ 毫克/天的剂量增量，优势会额外乘以 $1.3$。\n- **协变量定义：**\n    - $X_1$：HLA-B*58:01 阳性的指示变量（阳性为 $1$，阴性为 $0$）。\n    - $X_2$：CKD 分期 $\\ge 3$ 的指示变量（分期 $\\ge 3$ 为 $1$，分期 $1-2$ 为 $0$）。\n    - $X_3$：高于 $100$ 毫克/天的 $100$ 毫克/天增量数。\n    - $X_4$：高于 $40$ 岁的十年数。\n    - $X_5$：交互项，定义为 $X_5 = X_2 \\times X_3$。\n- **待评估患者：** HLA-B*58:01 阳性，CKD $3$ 期，起始剂量 $200$ 毫克/天，年龄 $70$ 岁。\n\n**第 2 步：使用提取的给定信息进行验证**\n\n- **科学依据：** 该问题牢固地植根于临床药理学和生物统计学的既定原则。HLA-B*58:01 与 allopurinol 诱导的 SCAR 之间的关联是已有充分文献记载的药物遗传学发现。其他风险因素（CKD、剂量、年龄）也具有临床相关性。对于固定时间段内的二元结局，使用逻辑斯蒂回归模型（一种在对数优势尺度上的加性模型）是一种标准且合适的统计方法。\n- **良构的：** 该问题是良构的。它提供了一个基线概率和一套完整的指定风险因素的乘性因子（优势比），从而可以唯一地计算新患者的风险。协变量的定义是精确的。\n- **客观性：** 语言是客观的，并使用了流行病学和生物统计学的标准术语（例如，优势、优势比、交互作用、参照患者）。\n\n**第 3 步：结论与行动**\n\n问题陈述内部一致、科学合理，并为唯一解提供了所有必要信息。因此，它是**有效的**。现在开始求解。\n\n### 解的推导\n\n问题描述了一个逻辑斯蒂回归模型。给定患者结局的优势是基线优势与该患者风险因素对应的优势比的乘积。\n\nSCAR 优势的模型可以写成：\n$$ \\text{Odds}(p) = \\frac{p}{1-p} = \\text{Odds}_0 \\times (OR_1)^{X_1} \\times (OR_2)^{X_2} \\times (OR_3)^{X_3} \\times (OR_4)^{X_4} \\times (OR_{\\text{int}})^{X_5} $$\n其中 $\\text{Odds}_0$ 是参照患者的优势，而 $OR$ 项是给定的乘性因子。\n\n**1. 计算基线优势 ($\\text{Odds}_0$)**\n基线概率为 $p_0 = 10^{-4}$。\n$$ \\text{Odds}_0 = \\frac{p_0}{1-p_0} = \\frac{10^{-4}}{1 - 10^{-4}} = \\frac{10^{-4}}{0.9999} $$\n对于像 $10^{-4}$ 这样的小概率，分母 $1 - p_0$ 非常接近 $1$，因此 $\\text{Odds}_0 \\approx p_0 = 10^{-4}$。为了准确起见，我们将使用精确值。\n\n**2. 从问题陈述中识别优势比**\n- $X_1$ (HLA-B*58:01+) 的 $OR_1$：$80$\n- $X_2$ (CKD $\\ge 3$) 的 $OR_2$：$3$\n- $X_3$ (每 $100$ 毫克/天剂量增量) 的 $OR_3$：$1.5$\n- $X_4$ (每十年年龄) 的 $OR_4$：$1.2$\n- 交互作用被描述为“当 CKD 分期 $\\ge 3$ ($X_2=1$) 时，每增加 $100$ 毫克/天的剂量增量，优势会*额外*乘以 $1.3$”。这意味着当 $X_2=1$ 时，剂量增量的总乘性效应是 $1.5 \\times 1.3$。这对应于一个交互项 $X_5 = X_2 \\times X_3$，其优势比为 $OR_{\\text{int}} = 1.3$。\n\n**3. 确定新患者的协变量值**\n- **HLA 状态：** HLA-B*58:01 阳性 $\\implies X_1 = 1$。\n- **CKD 状态：** CKD $3$ 期 $\\implies X_2 = 1$。\n- **剂量：** 起始剂量为 $200$ 毫克/天。参照剂量为 $100$ 毫克/天。高于参照的 $100$ 毫克/天增量数是 $X_3 = \\frac{200 - 100}{100} = 1$。\n- **年龄：** 年龄为 $70$ 岁。参照年龄为 $40$ 岁。高于参照的十年数是 $X_4 = \\frac{70 - 40}{10} = 3$。\n- **交互项：** $X_5 = X_2 \\times X_3 = 1 \\times 1 = 1$。\n\n**4. 计算新患者的优势 ($\\text{Odds}_{\\text{new}}$)**\n我们将基线优势乘以患者协变量值对应的优势比。\n$$ \\text{Odds}_{\\text{new}} = \\text{Odds}_0 \\times (80)^{X_1} \\times (3)^{X_2} \\times (1.5)^{X_3} \\times (1.2)^{X_4} \\times (1.3)^{X_5} $$\n代入患者的值：\n$$ \\text{Odds}_{\\text{new}} = \\left(\\frac{10^{-4}}{0.9999}\\right) \\times (80)^1 \\times (3)^1 \\times (1.5)^1 \\times (1.2)^3 \\times (1.3)^1 $$\n$$ \\text{Odds}_{\\text{new}} = \\left(\\frac{10^{-4}}{0.9999}\\right) \\times 80 \\times 3 \\times 1.5 \\times 1.728 \\times 1.3 $$\n$$ \\text{Odds}_{\\text{new}} = \\left(\\frac{10^{-4}}{0.9999}\\right) \\times (240 \\times 1.5 \\times 1.728 \\times 1.3) $$\n$$ \\text{Odds}_{\\text{new}} = \\left(\\frac{10^{-4}}{0.9999}\\right) \\times (360 \\times 1.728 \\times 1.3) $$\n$$ \\text{Odds}_{\\text{new}} = \\left(\\frac{10^{-4}}{0.9999}\\right) \\times (622.08 \\times 1.3) $$\n$$ \\text{Odds}_{\\text{new}} = \\left(\\frac{10^{-4}}{0.9999}\\right) \\times 808.704 $$\n$$ \\text{Odds}_{\\text{new}} \\approx 0.00010001 \\times 808.704 \\approx 0.080878 $$\n\n**5. 将新优势转换回概率 ($p_{\\text{new}}$)**\n关联概率和优势的公式是 $p = \\frac{\\text{Odds}}{1 + \\text{Odds}}$。\n$$ p_{\\text{new}} = \\frac{0.080878}{1 + 0.080878} = \\frac{0.080878}{1.080878} \\approx 0.074826 $$\n该概率约为 $0.075$，即 $7.5\\%$。\n\n### 逐项分析\n\n**A. 为 $8$ 周 SCAR 概率指定一个适合罕见事件的、惩罚性的逻辑斯蒂回归，其对数优势线性预测器包含 $X_1, X_2, X_3, X_4$ 和预设的交互作用 $X_5$，将 CKD 编码为分期 $\\ge 3$ 的二元指示变量，保留年龄和剂量为参照 $40$ 岁和 $100$ 毫克/天的连续尺度以避免信息丢失，并基于药物遗传学和病理生理学证据先验地选择变量，而不是基于单变量显著性。使用与乘性效应一致的基于优势的组合来推导患者风险。对于所述患者（$X_1=1, X_2=1, X_3=1, X_4=3, X_5=1$），预测概率约为 $p \\approx 0.075$。通过使用 Firth 惩罚来稳定系数估计，以应对 SCAR 的预期稀疏性，从而证明罕见事件偏差的减少是合理的。**\n\n- **模型与变量：** 正确地识别出这是一个逻辑斯蒂回归，其加性对数优势预测器包含了所有指定的主效应和交互作用。\n- **变量处理：** 正确地主张保留剂量和年龄在其定义的尺度上，避免了二分化带来的信息丢失。\n- **变量选择：** 正确地支持了基于领域知识的*先验*选择这一优越策略，而非依赖步进法或单变量筛选等数据驱动方法。\n- **计算：** 计算出的概率 $p \\approx 0.075$ 与我们的推导相符。患者的协变量向量也被正确识别。\n- **方法论：** 提及惩罚性逻辑斯蒂回归（特别是 Firth 方法）与像 SCAR 这样的罕见事件结局高度相关，因为它能纠正小样本偏差和分离问题。这表明了对统计挑战的深入理解。\n- **结论：** 该选项在方法论上是合理的，在各方面都与问题陈述一致，并得出了正确的数值结果。**正确**。\n\n**B. 在 $8$ 周窗口期内拟合一个 Cox 比例风险模型，在 $p0.05$ 时通过向后逐步法选择变量，将年龄在 $65$ 岁和剂量在 $200$ 毫克/天处二分化，包含用药开始后的实验室值以改善拟合，并通过将风险比的乘积解释为概率来计算患者的风险。这得出的患者风险接近 $p \\approx 0.29$。**\n\n- **模型选择：** Cox 模型用于生存时间分析。虽然相关，但逻辑斯蒂回归对于估计固定区间内的累积概率更为直接。\n- **统计实践：** 向后逐步选择和连续预测变量的二分化都是不良的统计实践，可能导致模型不稳定和信息丢失。\n- **预测变量：** 在治疗前风险预测模型中包含用药开始后的数据是不合适的。\n- **计算：** 存在根本性缺陷。风险比的乘积不是概率。这个概念性错误导致了不正确的风险估计。\n- **结论：** 该选项在多个方面都是错误的：模型选择、统计方法以及对模型输出的基本解释。**不正确**。\n\n**C. 构建一个朴素贝叶斯分类器，将 HLA-B*58:01、CKD、剂量和年龄视为独立的似然贡献者，在 $p0.05$ 时进行单变量筛选选择变量，并将给定的优势比相加作为对风险（而不是优势）的加性效应。这得出的患者风险约为 $p \\approx 0.13$。**\n\n- **模型选择：** 朴素贝叶斯分类器假设预测变量条件独立，这与预设的剂量-CKD交互作用明确相悖。\n- **统计实践：** 单变量筛选是一种次优的变量选择方法。\n- **计算：** 存在根本性缺陷。优势比在优势尺度上是乘性的，而不是在风险（概率）尺度上是加性的。将优势比相加在数学上是无稽之谈。这个错误导致了不正确的风险估计。\n- **结论：** 该选项提出了一个不正确的模型，它违反了问题的假设，并使用了无效的方法来组合风险因素。**不正确**。\n\n**D. 使用逻辑斯蒂回归，但将年龄在 $65$ 岁和剂量在 $200$ 毫克/天处二分化，舍弃 CKD 以避免与剂量的多重共线性，将 HLA-B*58:01 编码为等位基因拷贝数的三水平有序变量且不考虑显性，禁止交互作用以限制复杂性，并通过交叉验证的逐步程序选择变量。估计患者的风险为 $p \\approx 0.03$。**\n\n- **模型设定：** 该选项犯了几个与问题设定相矛盾的错误。它将变量二分化，丢弃了一个关键预测变量 (CKD)，改变了主要遗传标记的编码，并错误地禁止了指定的交互作用。丢弃 CKD 尤其严重，因为它的效应是明确给出的。\n- **变量处理：** 如前所述，二分化是不良实践。重新编码 HLA 变量与问题陈述相悖。\n- **变量选择：** 虽然交叉验证的步进法比简单的步进法有所改进，但它仍然是一个自动化程序，对于此类模型，通常不如基于理论的*先验*选择。\n- **计算：** 由此产生的模型被严重错误设定，导致了不正确的风险估计。\n- **结论：** 该选项展示了与所提供信息和既定最佳实践不一致的不良建模选择。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "4559022"}]}