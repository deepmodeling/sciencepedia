{"hands_on_practices": [{"introduction": "在系统药理学中，将复杂的生物化学途径转化为精确的数学语言是进行任何计算分析的第一步。本练习将引导您完成一个基础但至关重要的任务：从一组药物代谢反应的化学计量关系出发，构建代表网络结构的邻接矩阵和化学计量矩阵[@problem_id:4594957]。掌握这项技能是后续进行动态模拟、通量平衡分析或网络拓扑研究的基石，它能让您学会如何将生物直觉系统地编码为可计算的对象。", "problem": "一种假设的异源药物 $X$ 在临床药理学中常见的内源性辅因子影响下，在肝细胞中进行生物转化。考虑物种集合 $\\{D, M_{1}, M_{2}, \\mathrm{NADPH}, \\mathrm{NADP}^{+}, \\mathrm{GSH}\\}$，其中 $D$ 表示母体药物，$M_{1}$ 表示一级代谢物，$M_{2}$ 表示结合代谢物，烟酰胺腺嘌呤二核苷酸磷酸（还原型）（$\\mathrm{NADPH}$），烟酰胺腺嘌呤二核苷酸磷酸（氧化型）（$\\mathrm{NADP}^{+}$）和谷胱甘肽（$\\mathrm{GSH}$）。该途径由以下反应化学计量式给出：\n$$\nR_{1}:\\quad D + \\mathrm{NADPH} \\longrightarrow M_{1} + \\mathrm{NADP}^{+},\n$$\n$$\nR_{2}:\\quad M_{1} + \\mathrm{GSH} \\longrightarrow M_{2},\n$$\n$$\nR_{3}:\\quad M_{2} \\longrightarrow M_{1},\n$$\n$$\nR_{4}:\\quad M_{1} \\longrightarrow D.\n$$\n将该途径建模为：\n- 一个关于物种的有向图，其中每当一个反应使用某个反应物物种来生成某个产物物种时，就存在一条从反应物到产物的有向边。\n- 一个反应超图，其关联关系由从物种到反应的化学计量映射给出，其中反应物的条目为负，产物的条目为正，其他情况为零。\n\n任务：\n- 推导有向图的邻接矩阵 $A \\in \\mathbb{R}^{6 \\times 6}$，其中物种排序为 $(D, M_{1}, M_{2}, \\mathrm{NADPH}, \\mathrm{NADP}^{+}, \\mathrm{GSH})$。\n- 推导化学计量关联矩阵 $S \\in \\mathbb{R}^{6 \\times 4}$，其中反应排序为 $(R_{1}, R_{2}, R_{3}, R_{4})$，物种的行顺序与上述相同。\n- 计算化学计量关联矩阵 $S$ 的秩。\n\n将最终答案表示为单个整数。无需四舍五入，也无需单位。", "solution": "我们从系统药理学中使用的基础网络定义和化学计量记录开始。生化反应由化学计量系数表示，这些系数计算每个反应事件中消耗或产生的各物种的分子数量。对于每个反应，我们为每个反应物分配一个负系数，为每个产物分配一个正系数。化学计量关联矩阵 $S$ 的行由物种索引，列由反应索引，其元素等于这些带符号的化学计量系数。\n\n另外，关于物种的有向图有一个邻接矩阵 $A$，其元素 $A_{ij}$ 的值为1，如果存在至少一个反应，其中物种 $i$ 是反应物而物种 $j$ 是产物；否则为0。这构建了底物-产物图，常用于分析分子实体之间的可达性和连通性。\n\n步骤1：构建有向图邻接矩阵 $A$。\n\n我们列出有序物种：$(D, M_{1}, M_{2}, \\mathrm{NADPH}, \\mathrm{NADP}^{+}, \\mathrm{GSH})$，并检查每个反应以确定从反应物到产物的有向边。\n\n- 反应 $R_{1}: D + \\mathrm{NADPH} \\longrightarrow M_{1} + \\mathrm{NADP}^{+}$ 产生以下边：\n  - $D \\rightarrow M_{1}$,\n  - $D \\rightarrow \\mathrm{NADP}^{+}$,\n  - $\\mathrm{NADPH} \\rightarrow M_{1}$,\n  - $\\mathrm{NADPH} \\rightarrow \\mathrm{NADP}^{+}$.\n- 反应 $R_{2}: M_{1} + \\mathrm{GSH} \\longrightarrow M_{2}$ 产生以下边：\n  - $M_{1} \\rightarrow M_{2}$,\n  - $\\mathrm{GSH} \\rightarrow M_{2}$.\n- 反应 $R_{3}: M_{2} \\longrightarrow M_{1}$ 产生以下边：\n  - $M_{2} \\rightarrow M_{1}$.\n- 反应 $R_{4}: M_{1} \\longrightarrow D$ 产生以下边：\n  - $M_{1} \\rightarrow D$.\n\n不存在其他边。因此，我们按照 $(D, M_{1}, M_{2}, \\mathrm{NADPH}, \\mathrm{NADP}^{+}, \\mathrm{GSH})$ 的顺序，逐行（从源到目标）填充 $A$：\n\n- 第 $D$ 行：到 $M_{1}$ 和 $\\mathrm{NADP}^{+}$ 的边，所以\n  $$\n  [0,\\,1,\\,0,\\,0,\\,1,\\,0].\n  $$\n- 第 $M_{1}$ 行：到 $M_{2}$ 和 $D$ 的边，所以\n  $$\n  [1,\\,0,\\,1,\\,0,\\,0,\\,0].\n  $$\n- 第 $M_{2}$ 行：到 $M_{1}$ 的边，所以\n  $$\n  [0,\\,1,\\,0,\\,0,\\,0,\\,0].\n  $$\n- 第 $\\mathrm{NADPH}$ 行：到 $M_{1}$ 和 $\\mathrm{NADP}^{+}$ 的边，所以\n  $$\n  [0,\\,1,\\,0,\\,0,\\,1,\\,0].\n  $$\n- 第 $\\mathrm{NADP}^{+}$ 行：没有出边，所以\n  $$\n  [0,\\,0,\\,0,\\,0,\\,0,\\,0].\n  $$\n- 第 $\\mathrm{GSH}$ 行：到 $M_{2}$ 的边，所以\n  $$\n  [0,\\,0,\\,1,\\,0,\\,0,\\,0].\n  $$\n\n因此，\n$$\nA = \\begin{pmatrix}\n0  & 1 & 0 & 0 & 1 & 0 \\\\\n1  & 0 & 1 & 0 & 0 & 0 \\\\\n0  & 1 & 0 & 0 & 0 & 0 \\\\\n0  & 1 & 0 & 0 & 1 & 0 \\\\\n0  & 0 & 0 & 0 & 0 & 0 \\\\\n0  & 0 & 1 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n步骤2：构建化学计量关联矩阵 $S$。\n\n我们按照 $(D, M_{1}, M_{2}, \\mathrm{NADPH}, \\mathrm{NADP}^{+}, \\mathrm{GSH})$ 的顺序分配行，按照 $(R_{1}, R_{2}, R_{3}, R_{4})$ 的顺序分配列。\n\n- 对于 $R_{1}: D + \\mathrm{NADPH} \\longrightarrow M_{1} + \\mathrm{NADP}^{+}$：\n  - $D$: $-1$,\n  - $M_{1}$: $+1$,\n  - $M_{2}$: $0$,\n  - $\\mathrm{NADPH}$: $-1$,\n  - $\\mathrm{NADP}^{+}$: $+1$,\n  - $\\mathrm{GSH}$: $0$.\n\n所以第一列是\n$$\n\\begin{pmatrix}\n-1 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 1 \\\\ 0\n\\end{pmatrix}.\n$$\n\n- 对于 $R_{2}: M_{1} + \\mathrm{GSH} \\longrightarrow M_{2}$：\n  - $D$: $0$,\n  - $M_{1}$: $-1$,\n  - $M_{2}$: $+1$,\n  - $\\mathrm{NADPH}$: $0$,\n  - $\\mathrm{NADP}^{+}$: $0$,\n  - $\\mathrm{GSH}$: $-1$.\n\n所以第二列是\n$$\n\\begin{pmatrix}\n0 \\\\ -1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ -1\n\\end{pmatrix}.\n$$\n\n- 对于 $R_{3}: M_{2} \\longrightarrow M_{1}$：\n  - $D$: $0$,\n  - $M_{1}$: $+1$,\n  - $M_{2}$: $-1$,\n  - $\\mathrm{NADPH}$: $0$,\n  - $\\mathrm{NADP}^{+}$: $0$,\n  - $\\mathrm{GSH}$: $0$.\n\n所以第三列是\n$$\n\\begin{pmatrix}\n0 \\\\ 1 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}.\n$$\n\n- 对于 $R_{4}: M_{1} \\longrightarrow D$：\n  - $D$: $+1$,\n  - $M_{1}$: $-1$,\n  - $M_{2}$: $0$,\n  - $\\mathrm{NADPH}$: $0$,\n  - $\\mathrm{NADP}^{+}$: $0$,\n  - $\\mathrm{GSH}$: $0$.\n\n所以第四列是\n$$\n\\begin{pmatrix}\n1 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}.\n$$\n\n汇总各列，我们得到\n$$\nS = \\begin{pmatrix}\n-1 &  0 &  0 &  1 \\\\\n 1 & -1 &  1 & -1 \\\\\n 0 &  1 & -1 &  0 \\\\\n-1 &  0 &  0 &  0 \\\\\n 1 &  0 &  0 &  0 \\\\\n 0 & -1 &  0 &  0\n\\end{pmatrix}.\n$$\n\n步骤3：计算 $S$ 的秩。\n\n由于 $S \\in \\mathbb{R}^{6 \\times 4}$，其秩最多为4。为了判断这4列是否线性无关，我们检验线性组合 $\\alpha \\mathbf{c}_{1} + \\beta \\mathbf{c}_{2} + \\gamma \\mathbf{c}_{3} + \\delta \\mathbf{c}_{4} = \\mathbf{0}$ 是否能推导出 $\\alpha = \\beta = \\gamma = \\delta = 0$，其中 $\\mathbf{c}_{k}$ 表示 $S$ 的第 $k$ 列。\n\n明确写出各列：\n$$\n\\mathbf{c}_{1} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 1 \\\\ 0 \\end{pmatrix},\\quad\n\\mathbf{c}_{2} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ -1 \\end{pmatrix},\\quad\n\\mathbf{c}_{3} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix},\\quad\n\\mathbf{c}_{4} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n\n设 $\\alpha \\mathbf{c}_{1} + \\beta \\mathbf{c}_{2} + \\gamma \\mathbf{c}_{3} + \\delta \\mathbf{c}_{4} = \\mathbf{0}$ 并对各行进行等式变换：\n\n- 第 $D$ 行：$- \\alpha + 0 + 0 + \\delta = 0 \\implies \\delta = \\alpha$。\n- 第 $M_{1}$ 行：$\\alpha - \\beta + \\gamma - \\delta = 0$。使用 $\\delta = \\alpha$，我们得到 $- \\beta + \\gamma = 0 \\implies \\gamma = \\beta$。\n- 第 $M_{2}$ 行：$0 + \\beta - \\gamma + 0 = 0 \\implies \\beta - \\gamma = 0$，与 $\\gamma = \\beta$ 一致。\n- 第 $\\mathrm{NADPH}$ 行：$- \\alpha + 0 + 0 + 0 = 0 \\implies \\alpha = 0$。因此 $\\delta = 0$。\n- 第 $\\mathrm{NADP}^{+}$ 行：$\\alpha + 0 + 0 + 0 = 0 \\implies \\alpha = 0$，已被强制。\n- 第 $\\mathrm{GSH}$ 行：$0 - \\beta + 0 + 0 = 0 \\implies \\beta = 0$。因此 $\\gamma = 0$。\n\n因此，唯一的解是 $\\alpha = \\beta = \\gamma = \\delta = 0$，这意味着这些列是线性无关的。因此，$S$ 的秩是\n$$\n\\mathrm{rank}(S) = 4.\n$$\n\n这就完成了 $A$ 和 $S$ 的推导，以及所要求的标量网络属性（化学计量关联矩阵的秩）的计算。", "answer": "$$\\boxed{4}$$", "id": "4594957"}, {"introduction": "生物网络不仅仅是静态的连接图，其动态行为，尤其是对药物等扰动的稳定性，是系统药理学关注的核心。本练习将控制理论中的经典工具——劳斯-赫尔维茨稳定性判据（Routh–Hurwitz stability criterion）应用于一个带有负反馈的信号级联模型[@problem_id:4594941]。通过这项实践，您将学会如何从系统的特征方程出发，推导出维持系统稳态的参数条件，并定量评估药物抑制作用对恢复系统稳定性的最低要求。", "problem": "在临床药理学背景下，一个三级信号级联被建模为三个串联的、线性化的一阶模块，其时间常数 $\\tau_1$、$\\tau_2$ 和 $\\tau_3$ 均为严格正值（单位：分钟），静态增益 $K_1$、$K_2$ 和 $K_3$ 均为无量纲。该级联通过从输出到输入的负反馈进行闭环，反馈强度为 $F$（无量纲），代表稳态调节。一种作用于第二级的药物使其增益降低了比例 $\\alpha \\in [0,1]$，因此 $K_2$ 被替换为 $K_2(1-\\alpha)$。\n\n在标准的线性时不变（LTI）假设下，该级联的闭环特征方程可以写成一个关于复频率 $s$ 的三次方程，其系数取决于 $\\tau_1$、$\\tau_2$、$\\tau_3$、$F$、$K_1$、$K_2$、$K_3$ 和 $\\alpha$。从LTI稳定性的定义（即所有特征根的实部都严格为负）出发，并仅使用劳斯阵列的构建及其符号变化准则，推导该三次方程系数所必须满足的充要不等式（3阶系统的劳斯-赫尔维茨判据）。然后，通过将三次方程的系数用 $\\tau_1$、$\\tau_2$、$\\tau_3$、$F$、$K_1$、$K_2$、$K_3$ 和 $\\alpha$ 表示，确定为确保以下生理学上合理的参数集的闭环稳定性所需的最小抑制比例 $\\alpha_{\\min}$：\n- $\\tau_1 = 20\\ \\mathrm{min}$，$\\tau_2 = 5\\ \\mathrm{min}$，$\\tau_3 = 2\\ \\mathrm{min}$，\n- $K_1 = 3$，$K_2 = 2$，$K_3 = 5$，\n- $F = 1$。\n\n将你的最终答案 $\\alpha_{\\min}$ 表示为一个无量纲小数，并四舍五入到四位有效数字。", "solution": "本题要求分析一个闭环信号级联的稳定性，该级联被建模为一个线性时不变（LTI）系统。LTI系统的稳定性由其特征方程的根在复频率平面上的位置决定。为了使系统稳定，所有根（闭环传递函数的极点）必须位于复平面的左半部分，即它们都必须具有严格为负的实部。劳斯-赫尔维茨判据提供了一种无需显式计算根即可确定是否满足此条件的方法。\n\n首先，我们建立给定系统的特征方程。该系统由一个包含三个串联一阶模块的前向通路和一个负反馈回路组成。增益为 $K$、时间常数为 $\\tau$ 的一阶模块的传递函数为 $G(s) = \\frac{K}{1+\\tau s}$。\n\n前向通路是三个层级传递函数的乘积。第二级的增益被药物改变，变为 $K_2(1-\\alpha)$。因此，前向通路传递函数 $G_F(s)$ 为：\n$$G_F(s) = \\left(\\frac{K_1}{1+\\tau_1 s}\\right) \\left(\\frac{K_2(1-\\alpha)}{1+\\tau_2 s}\\right) \\left(\\frac{K_3}{1+\\tau_3 s}\\right) = \\frac{K_1 K_2 K_3 (1-\\alpha)}{(1+\\tau_1 s)(1+\\tau_2 s)(1+\\tau_3 s)}$$\n反馈通路的传递函数为 $H(s) = F$。对于一个负反馈系统，闭环传递函数为 $G_{CL}(s) = \\frac{G_F(s)}{1+G_F(s)H(s)}$。特征方程是令 $G_{CL}(s)$ 的分母为零：\n$$1 + G_F(s)H(s) = 0$$\n代入 $G_F(s)$ 和 $H(s)$ 的表达式：\n$$1 + \\frac{K_1 K_2 K_3 F (1-\\alpha)}{(1+\\tau_1 s)(1+\\tau_2 s)(1+\\tau_3 s)} = 0$$\n为了得到多项式形式，我们乘以分母：\n$$(1+\\tau_1 s)(1+\\tau_2 s)(1+\\tau_3 s) + K_1 K_2 K_3 F (1-\\alpha) = 0$$\n展开一阶项的乘积：\n$$(\\tau_1\\tau_2\\tau_3)s^3 + (\\tau_1\\tau_2 + \\tau_1\\tau_3 + \\tau_2\\tau_3)s^2 + (\\tau_1+\\tau_2+\\tau_3)s + 1 + K_1 K_2 K_3 F (1-\\alpha) = 0$$\n这是一个关于 $s$ 的三阶多项式，其一般形式为 $a_3 s^3 + a_2 s^2 + a_1 s + a_0 = 0$，其中：\n$a_3 = \\tau_1\\tau_2\\tau_3$\n$a_2 = \\tau_1\\tau_2 + \\tau_1\\tau_3 + \\tau_2\\tau_3$\n$a_1 = \\tau_1+\\tau_2+\\tau_3$\n$a_0 = 1 + K_1 K_2 K_3 F (1-\\alpha)$\n\n接下来，根据题目的指示，我们使用劳斯阵列为这个三次多项式推导劳斯-赫尔维茨稳定性条件。阵列构建如下：\n$$\n\\begin{array}{c|cc}\ns^3 & a_3 & a_1 \\\\\ns^2 & a_2 & a_0 \\\\\ns^1 & b_1 & 0 \\\\\ns^0 & c_1 & 0\n\\end{array}\n$$\n元素 $b_1$ 和 $c_1$ 计算如下：\n$b_1 = \\frac{a_2 a_1 - a_3 a_0}{a_2}$\n$c_1 = \\frac{b_1 a_0 - a_2(0)}{b_1} = a_0$\n\n为了使系统稳定，所有根的实部必须为负。劳斯-赫尔维茨判据指出，当且仅当劳斯阵列第一列的所有元素（$a_3, a_2, b_1, c_1$）符号相同时，该条件成立。由于时间常数 $\\tau_i$ 严格为正，所以 $a_3 = \\tau_1\\tau_2\\tau_3 > 0$。因此，为了保证稳定性，第一列的所有元素都必须为正。\n条件是：\n1. $a_2 > 0$\n2. $b_1 > 0$\n3. $c_1 > 0$\n\n让我们分析这些条件。\n1. $a_2 = \\tau_1\\tau_2 + \\tau_1\\tau_3 + \\tau_2\\tau_3$。因为所有 $\\tau_i > 0$，所以保证 $a_2$ 为正。\n2. $c_1 = a_0$。因此，我们必须有 $a_0 > 0$。\n3. $b_1 > 0 \\implies \\frac{a_2 a_1 - a_3 a_0}{a_2} > 0$。因为 $a_2 > 0$，这可以简化为关键条件：$a_2 a_1 - a_3 a_0 > 0$，或 $a_2 a_1 > a_3 a_0$。\n（注意：条件 $a_1 > 0$ 也是必要的，由于 $a_1=\\tau_1+\\tau_2+\\tau_3 > 0$，该条件成立）。\n因此，三次系统稳定的充要条件是 $a_0 > 0$ 和 $a_2 a_1 > a_3 a_0$。\n\n现在，我们使用给定的参数将这些条件应用于特定系统：\n$\\tau_1 = 20\\ \\mathrm{min}$，$\\tau_2 = 5\\ \\mathrm{min}$，$\\tau_3 = 2\\ \\mathrm{min}$\n$K_1 = 3$，$K_2 = 2$，$K_3 = 5$，$F = 1$\n$\\alpha \\in [0,1]$\n\n首先，我们计算系数的数值：\n$a_3 = 20 \\times 5 \\times 2 = 200$\n$a_2 = (20 \\times 5) + (20 \\times 2) + (5 \\times 2) = 100 + 40 + 10 = 150$\n$a_1 = 20 + 5 + 2 = 27$\n$a_0 = 1 + (3 \\times 2 \\times 5 \\times 1)(1-\\alpha) = 1 + 30(1-\\alpha) = 1 + 30 - 30\\alpha = 31 - 30\\alpha$\n\n让我们检查稳定性条件。\n第一个条件：$a_0 > 0$。\n$31 - 30\\alpha > 0 \\implies 31 > 30\\alpha \\implies \\alpha < \\frac{31}{30} \\approx 1.033$。\n由于题目规定 $\\alpha \\in [0,1]$，此条件总是满足的。\n\n第二个，也是更严格的条件：$a_2 a_1 > a_3 a_0$。\n$150 \\times 27 > 200 \\times (31 - 30\\alpha)$\n$4050 > 200 \\times (31 - 30\\alpha)$\n两边除以 $50$：\n$81 > 4 \\times (31 - 30\\alpha)$\n$81 > 124 - 120\\alpha$\n$120\\alpha > 124 - 81$\n$120\\alpha > 43$\n$\\alpha > \\frac{43}{120}$\n\n当且仅当 $\\alpha > \\frac{43}{120}$ 时，系统是稳定的。题目要求确保稳定性所需的最小抑制比例 $\\alpha_{\\min}$。这对应于稳定区域的边界。在此边界值上，系统处于临界稳定状态。因此，定义稳定性阈值的最小值是：\n$\\alpha_{\\min} = \\frac{43}{120}$\n\n最后，我们将这个分数转换为一个四舍五入到四位有效数字的小数：\n$\\alpha_{\\min} = \\frac{43}{120} \\approx 0.358333...$\n四舍五入到四位有效数字得到：\n$\\alpha_{\\min} \\approx 0.3583$\n这是将系统从不稳定或临界稳定状态（当 $\\alpha$ 很小时）带入稳定状态所需的最小抑制比例。", "answer": "$$\\boxed{0.3583}$$", "id": "4594941"}, {"introduction": "在许多研究场景中，我们并非分析一个已知的网络，而是需要从实验数据中“反向工程”出未知的调控关系。本练习介绍了一种强大的网络推断方法——LASSO（最小绝对收缩和选择算子）回归，它通过施加稀疏性惩罚，从高维的扰动-响应数据中识别出最关键的信号通路连接[@problem_id:4595013]。这项实践将使您接触到数据驱动的药物发现前沿技术，学会如何利用统计学习方法揭示复杂网络中的药物靶点特异性和潜在的脱靶效应。", "problem": "给定一个线性化的系统药理学设定，其中小的实验性扰动会在测量的节点活性中产生等比例的变化。在线性响应近似下，扰动与响应之间的关系被建模为$$\\mathbf{R} = \\mathbf{W}\\mathbf{P},$$，其中 $\\mathbf{R}\\in\\mathbb{R}^{m\\times n}$ 是在 $n$ 次实验中测得的 $m$ 个节点的响应矩阵，$\\mathbf{P}\\in\\mathbb{R}^{m\\times n}$ 是在相同的 $n$ 次实验中应用于 $m$ 个通路对齐输入的扰动强度矩阵，而 $\\mathbf{W}\\in\\mathbb{R}^{m\\times m}$ 编码了从扰动通道到测量节点的边权重。对于单个节点 $i$（$\\mathbf{R}$ 的一行），其在所有实验中的响应向量，记为 $\\mathbf{y}\\in\\mathbb{R}^{n}$，通过以下方式与扰动设计矩阵（转置后）$\\mathbf{X}=\\mathbf{P}^\\top\\in\\mathbb{R}^{n\\times m}$ 和未知的边权重向量 $\\mathbf{w}\\in\\mathbb{R}^{m}$ 相关联：$$\\mathbf{y}=\\mathbf{X}\\mathbf{w}.$$为了强制实现生物学上合理的稀疏性和通路特异性，通过求解最小绝对收缩和选择算子（LASSO）优化问题来估计 $\\mathbf{w}$，该问题旨在寻求$$\\underset{\\mathbf{w}\\in\\mathbb{R}^{m}}{\\min}\\;\\frac{1}{2n}\\left\\lVert\\mathbf{y}-\\mathbf{X}\\mathbf{w}\\right\\rVert_2^2+\\lambda\\left\\lVert\\mathbf{w}\\right\\rVert_1,$$其中 $\\lambda>0$ 是控制稀疏性的正则化参数。\n\n在估计出 $\\mathbf{w}$ 后，根据通路特异性来解释其稀疏性。每个扰动特征（$\\mathbf{P}$ 的一列）都属于集合 $\\{\\text{A},\\text{B}\\}$ 中的一个通路组标签。将非零边的数量定义为$$N_{\\text{nz}}=\\left|\\left\\{j\\in\\{1,\\dots,m\\}\\;:\\;\\left|w_j\\right|>\\tau\\right\\}\\right|,$$其中 $\\tau$ 是用于判断实际零值的数值阈值，且必须设置为 $\\tau=10^{-6}$。将通路特异性指数（PSI）定义为一个小数分数$$\\text{PSI}=\\begin{cases}\\displaystyle\\frac{\\max\\left\\{c_{\\text{A}},c_{\\text{B}}\\right\\}}{N_{\\text{nz}}}, & \\text{如果 } N_{\\text{nz}}>0, \\\\[6pt] 0, & \\text{如果 } N_{\\text{nz}}=0, \\end{cases}$$其中 $c_{\\text{A}}$（以及 $c_{\\text{B}}$）分别统计了指向通路 $\\text{A}$（以及通路 $\\text{B}$）中特征的非零边的数量。较大的 $\\text{PSI}$ 值表示非零边集中在单个通路组内，这与通路特异性靶向一致。\n\n实现一个程序，对每个给定的测试用例，使用坐标下降法和软阈值法从 $\\mathbf{y}$ 和 $\\mathbf{X}$ 执行 LASSO 回归来估计 $\\mathbf{w}$，然后计算 $N_{\\text{nz}}$ 和 $\\text{PSI}$。为保证数值稳定性，请使用给定的特征，不要对其进行缩放，并使用精确阈值 $\\tau=10^{-6}$ 来计算非零系数。将 $\\text{PSI}$ 表示为小数（而非百分比），并四舍五入到三位小数。\n\n测试套件和数据：\n- 案例1（正常路径，混合特异性）：\n  - $m=3$, $n=6$\n  - $$\\mathbf{P}_1=\\begin{bmatrix}\n  1.0 & 0.0 & 2.0 & 0.0 & 1.0 & 0.0\\\\\n  0.0 & 1.0 & 0.0 & 2.0 & 0.5 & 1.5\\\\\n  1.0 & 1.0 & 1.0 & 1.0 & -1.0 & -1.0\n  \\end{bmatrix}$$\n  - 目标节点的真实权重：$$\\mathbf{w}^{\\star}_1=\\begin{bmatrix}1.5 \\\\ 0.0 \\\\ -0.5\\end{bmatrix}$$\n  - 通路组：$[\\text{A},\\text{A},\\text{B}]$\n  - 正则化参数：$\\lambda=0.3$\n  - 响应：$\\mathbf{y}_1=\\mathbf{P}_1^\\top\\mathbf{w}^{\\star}_1$\n- 案例2（低正则化，同通路集中）：\n  - $m=3$, $n=5$\n  - $$\\mathbf{P}_2=\\begin{bmatrix}\n  1 & 2 & 1 & 0 & 0\\\\\n  0 & 1 & 2 & 1 & 0\\\\\n  0 & 0 & 0 & 1 & 1\n  \\end{bmatrix}$$\n  - 真实权重：$$\\mathbf{w}^{\\star}_2=\\begin{bmatrix}0.8 \\\\ 0.6 \\\\ 0.0\\end{bmatrix}$$\n  - 通路组：$[\\text{A},\\text{A},\\text{B}]$\n  - 正则化参数：$\\lambda=0.05$\n  - 响应：$\\mathbf{y}_2=\\mathbf{P}_2^\\top\\mathbf{w}^{\\star}_2$\n- 案例3（边界情况，零响应）：\n  - $m=3$, $n=4$\n  - $$\\mathbf{P}_3=\\begin{bmatrix}\n  1 & 0 & 1 & 0\\\\\n  0 & 1 & 0 & 1\\\\\n  1 & 1 & 0 & 0\n  \\end{bmatrix}$$\n  - 真实权重：$$\\mathbf{w}^{\\star}_3=\\begin{bmatrix}0 \\\\ 0 \\\\ 0\\end{bmatrix}$$\n  - 通路组：$[\\text{A},\\text{B},\\text{B}]$\n  - 正则化参数：$\\lambda=0.1$\n  - 响应：$\\mathbf{y}_3=\\begin{bmatrix}0 & 0 & 0 & 0\\end{bmatrix}^\\top$\n- 案例4（共线性挑战）：\n  - $m=3$, $n=6$\n  - $$\\mathbf{P}_4=\\begin{bmatrix}\n  1 & 2 & 1 & 2 & 1 & 2\\\\\n  1 & 2 & 1 & 2 & 1 & 2\\\\\n  0 & 0 & 1 & 1 & 0 & 0\n  \\end{bmatrix}$$\n  - 真实权重：$$\\mathbf{w}^{\\star}_4=\\begin{bmatrix}1.0 \\\\ 0.0 \\\\ 0.5\\end{bmatrix}$$\n  - 通路组：$[\\text{A},\\text{B},\\text{B}]$\n  - 正则化参数：$\\lambda=0.3$\n  - 响应：$\\mathbf{y}_4=\\mathbf{P}_4^\\top\\mathbf{w}^{\\star}_4$\n\n你的程序应该生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。具体来说，输出 $$[N_{\\text{nz},1},\\text{PSI}_1,N_{\\text{nz},2},\\text{PSI}_2,N_{\\text{nz},3},\\text{PSI}_3,N_{\\text{nz},4},\\text{PSI}_4],$$ 其中 $N_{\\text{nz},k}$ 是案例 $k$ 的非零系数的整数数量，$\\text{PSI}_k$ 是案例 $k$ 的通路特异性指数，四舍五入到三位小数（以小数分数形式）。", "solution": "该问题要求使用最小绝对收缩和选择算子（LASSO）方法，在线性模型 $\\mathbf{y} = \\mathbf{X}\\mathbf{w}$ 中估计一个稀疏权重向量 $\\mathbf{w}$。随后，分析估计出的向量 $\\mathbf{w}$ 的稀疏性和通路特异性。\n\nLASSO 优化问题被表述为寻找向量 $\\mathbf{w} \\in \\mathbb{R}^{m}$ 以最小化以下目标函数：\n$$\nL(\\mathbf{w}) = \\frac{1}{2n} \\left\\lVert \\mathbf{y} - \\mathbf{X}\\mathbf{w} \\right\\rVert_2^2 + \\lambda \\left\\lVert \\mathbf{w} \\right\\rVert_1\n$$\n其中 $\\mathbf{y} \\in \\mathbb{R}^n$ 是响应向量，$\\mathbf{X} \\in \\mathbb{R}^{n \\times m}$ 是设计矩阵，$n$ 是实验次数，$m$ 是特征（扰动输入）数量，$\\lambda > 0$ 是正则化参数。$\\frac{1}{2n}\\left\\lVert \\mathbf{y} - \\mathbf{X}\\mathbf{w} \\right\\rVert_2^2$ 项是均方误差，它衡量模型对数据的拟合程度。$\\lambda \\left\\lVert \\mathbf{w} \\right\\rVert_1$ 项是 $L_1$范数惩罚项，它通过将 $\\mathbf{w}$ 的某些分量驱动至恰好为零来鼓励稀疏性。\n\n为了解决这个优化问题，我们采用循环坐标下降法。这种迭代算法一次只对单个系数 $w_j$ 优化目标函数，同时保持所有其他系数 $w_k$（对于 $k \\neq j$）恒定。每个系数的更新在所有系数 $j=1, \\dots, m$ 中循环进行。\n\n对于单个系数 $w_j$，目标函数可以仅写为 $w_j$ 的函数：\n$$\nL(w_j) = \\frac{1}{2n} \\sum_{i=1}^{n} \\left( y_i - \\sum_{k \\neq j} X_{ik}w_k - X_{ij}w_j \\right)^2 + \\lambda \\sum_{k \\neq j} |w_k| + \\lambda |w_j|\n$$\n这是一个一维 LASSO 问题。为了找到最优的 $w_j$，我们可以找到使其目标函数关于 $w_j$ 的次梯度为零的值。解由软阈值算子给出。令 $\\rho_j = \\sum_{i=1}^n X_{ij} (y_i - \\sum_{k \\neq j} X_{ik}w_k)$ 为第 $j$ 个特征与部分残差的点积，令 $a_j = \\sum_{i=1}^n X_{ij}^2$ 为第 $j$ 个特征的平方和。$w_j$ 的更新规则是：\n$$\nw_j \\leftarrow \\frac{S(\\rho_j, n\\lambda)}{a_j}\n$$\n其中 $S(\\alpha, \\gamma)$ 是软阈值函数，定义为：\n$$\nS(\\alpha, \\gamma) = \\operatorname{sign}(\\alpha) \\max(0, |\\alpha| - \\gamma) = \\begin{cases} \\alpha - \\gamma & \\text{如果 } \\alpha > \\gamma \\\\ \\alpha + \\gamma & \\text{如果 } \\alpha < -\\gamma \\\\ 0 & \\text{如果 } |\\alpha| \\le \\gamma \\end{cases}\n$$\n坐标下降算法的步骤如下：\n1. 初始化权重向量 $\\mathbf{w} = \\mathbf{0}$。\n2. 对每个特征 $j=1, \\dots, m$ 预计算 $a_j = \\mathbf{X}_{:,j}^\\top\\mathbf{X}_{:,j}$。\n3. 重复固定次数的迭代，或直到 $\\mathbf{w}$ 的变化量低于一个容差为止：\n   对于 $j = 1, \\dots, m$：\n     a. 计算 $\\rho_j = \\mathbf{X}_{:,j}^\\top (\\mathbf{y} - \\sum_{k \\neq j} \\mathbf{X}_{:,k}w_k)$，其中使用 $w_k$ 最新更新的值。\n     b. 使用软阈值规则更新 $w_j$：$w_j \\leftarrow S(\\rho_j, n\\lambda) / a_j$。\n\n在算法收敛到估计向量 $\\mathbf{\\hat{w}}$ 后，我们分析其结构。非零边的数量 $N_{\\text{nz}}$ 通过计算绝对值超过一个小数阈值 $\\tau = 10^{-6}$ 的系数个数来得到：\n$$\nN_{\\text{nz}} = \\left| \\left\\{ j \\in \\{1, \\dots, m\\} \\,:\\, |\\hat{w}_j| > \\tau \\right\\} \\right|\n$$\n通路特异性指数（PSI）衡量这些非零边在预定义的通路组 $\\{\\text{A}, \\text{B}\\}$ 内的集中程度。设 $c_{\\text{A}}$ 和 $c_{\\text{B}}$ 分别是对应于通路 A 和通路 B 中特征的非零边的数量。PSI 定义为：\n$$\n\\text{PSI} = \\begin{cases} \\displaystyle\\frac{\\max\\{c_{\\text{A}}, c_{\\text{B}}\\}}{N_{\\text{nz}}}, & \\text{如果 } N_{\\text{nz}} > 0, \\\\ 0, & \\text{如果 } N_{\\text{nz}} = 0. \\end{cases}\n$$\n将此过程应用于所提供的四个测试用例中的每一个。对于每个案例，设计矩阵 $\\mathbf{X}$ 由给定的扰动矩阵 $\\mathbf{P}$ 转置构成，响应向量 $\\mathbf{y}$ 通过 $\\mathbf{y} = \\mathbf{X}\\mathbf{w}^{\\star}$ 从真实权重 $\\mathbf{w}^{\\star}$ 生成。执行 LASSO 估计，并报告所得的 $N_{\\text{nz}}$ 和 PSI（四舍五入到三位小数）。", "answer": "[2,1.000,2,1.000,0,0.000,1,1.000]", "id": "4595013"}]}