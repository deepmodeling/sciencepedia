{"hands_on_practices": [{"introduction": "偏向性激动作用的量化，是通过比较某配体在不同信号通路中的活性与参照激动剂的差异来实现的。此练习提供了一个基础的实践机会，让您能够应用偏向性激动作用的标准定量分析框架。通过计算相对偏向性指标 $\\Delta\\Delta \\log(\\tau/K_{A})$，您将掌握药理学中基于实验数据对偏向性配体进行分类和比较的核心方法。[@problem_id:4524316]", "problem": "一项关于血管紧张素II 1型受体 (AT1R) 的药理学研究评估了两种信号通路：异源三聚体G蛋白$Gq$介导的信号传导和arrestin募集。对于每种配体和通路，使用激动作用的操作模型对浓度-效应数据进行拟合，得到以10为底的转导系数$\\log_{10}\\!\\left(\\tau/K_{A}\\right)$，其中$\\tau$是效应参数，$K_{A}$是功能性平衡解离常数。内源性配体血管紧张素II (AngII) 是参考配体，$Gq$通路是参考通路。拟合得到的转导系数如下：\n- AngII: $Gq = 0.8$, arrestin $= 0.6$。\n- TRV027: $Gq = 0.2$, arrestin $= 0.7$。\n\n仅使用转导系数的定义和基于转导系数差异的标准相对偏向性激动作用度量，计算TRV027相对于AngII的arrestin-over-$Gq$偏向性，表示为$\\Delta\\Delta \\log\\!\\left(\\tau/K_{A}\\right)$，其中以AngII为参考配体，以$Gq$为参考通路。报告$\\Delta\\Delta \\log\\!\\left(\\tau/K_{A}\\right)$的单一数值，不带单位。无需四舍五入；报告精确的小数值。此外，根据该值的符号，推断TRV027相对于AngII是否具有arrestin偏向性，但不要将此推断包含在您最终报告的数值中。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 第1步：提取已知条件\n- **受体**：血管紧张素II 1型受体 (AT1R)\n- **信号通路**：异源三聚体G蛋白$Gq$介导的信号传导（表示为$Gq$）和arrestin募集（表示为arrestin）。\n- **参数**：以10为底的转导系数，$\\log_{10}(\\tau/K_{A})$。\n- **参考配体**：血管紧张素II (AngII)。\n- **参考通路**：$Gq$通路。\n- **数据（转导系数）**：\n  - 对于AngII：$\\log_{10}(\\tau/K_{A})_{\\text{AngII, Gq}} = 0.8$。\n  - 对于AngII：$\\log_{10}(\\tau/K_{A})_{\\text{AngII, arrestin}} = 0.6$。\n  - 对于TRV027：$\\log_{10}(\\tau/K_{A})_{\\text{TRV027, Gq}} = 0.2$。\n  - 对于TRV027：$\\log_{10}(\\tau/K_{A})_{\\text{TRV027, arrestin}} = 0.7$。\n- **目标计算**：TRV027相对于AngII的arrestin-over-$Gq$偏向性，表示为$\\Delta\\Delta \\log(\\tau/K_{A})$。\n- **定义**：该计算基于“基于转导系数差异的标准相对偏向性激动作用度量”。\n\n### 第2步：使用提取的已知条件进行验证\n问题被认定为有效。\n- **科学依据充分**：该问题设置在定量药理学和受体理论的既定框架内。偏向性激动作用、操作模型、AT1R受体、其与$Gq$和arrestin通路的耦合，以及转导系数（$\\log_{10}(\\tau/K_{A})$）的使用都是该领域中标准且有据可查的概念。数值对于实验数据来说是合理的。\n- **提法明确**：问题提供了所有必要的数值数据和对所求量的清晰（尽管是文字形式的）定义。术语“基于转导系数差异的标准相对偏向性激动作用度量”明确指向文献中广泛使用的双重差值计算方法，这确保了存在唯一且有意义的解。\n- **客观性**：问题陈述使用精确、定量和不偏不倚的语言表达，不含主观论断。\n\n该问题不存在科学上不健全、不完整、矛盾或模棱两可等缺陷。这是一个基于标准药理学原理的直接计算。\n\n### 第3步：结论与行动\n问题有效。将提供解答。\n\n### 解答\n目标是计算配体TRV027相对于参考配体AngII的arrestin-over-$Gq$偏向性。该量表示为$\\Delta\\Delta \\log(\\tau/K_{A})$。这种偏向性激动作用的标准度量是根据以10为底的转导系数的差值的差值来计算的。\n\n设给定配体$L$和通路$P$的转导系数表示为$\\log_{10}(\\tau/K_{A})_{L,P}$。所提供的数据如下：\n- $\\log_{10}(\\tau/K_{A})_{\\text{AngII, Gq}} = 0.8$\n- $\\log_{10}(\\tau/K_{A})_{\\text{AngII, arrestin}} = 0.6$\n- $\\log_{10}(\\tau/K_{A})_{\\text{TRV027, Gq}} = 0.2$\n- $\\log_{10}(\\tau/K_{A})_{\\text{TRV027, arrestin}} = 0.7$\n\n计算分两步进行。\n\n首先，对于每种配体，我们计算两条通路（arrestin和$Gq$）之间转导系数的差异。这代表了每种配体对一条通路相对于另一条通路的内在偏向性。参考通路是$Gq$，所以我们从arrestin的值中减去$Gq$的值。这个差值表示为$\\Delta \\log(\\tau/K_{A})_{L}$。\n\n对于测试配体TRV027：\n$$ \\Delta \\log(\\tau/K_{A})_{\\text{TRV027}} = \\log_{10}(\\tau/K_{A})_{\\text{TRV027, arrestin}} - \\log_{10}(\\tau/K_{A})_{\\text{TRV027, Gq}} $$\n代入给定值：\n$$ \\Delta \\log(\\tau/K_{A})_{\\text{TRV027}} = 0.7 - 0.2 = 0.5 $$\n\n对于参考配体AngII：\n$$ \\Delta \\log(\\tau/K_{A})_{\\text{AngII}} = \\log_{10}(\\tau/K_{A})_{\\text{AngII, arrestin}} - \\log_{10}(\\tau/K_{A})_{\\text{AngII, Gq}} $$\n代入给定值：\n$$ \\Delta \\log(\\tau/K_{A})_{\\text{AngII}} = 0.6 - 0.8 = -0.2 $$\n\n其次，我们计算TRV027相对于AngII的相对偏向性。这是通过从测试配体的偏向性中减去参考配体的偏向性得到的双重差值$\\Delta\\Delta \\log(\\tau/K_{A})$。\n$$ \\Delta\\Delta \\log(\\tau/K_{A}) = \\Delta \\log(\\tau/K_{A})_{\\text{TRV027}} - \\Delta \\log(\\tau/K_{A})_{\\text{AngII}} $$\n代入第一步计算出的值：\n$$ \\Delta\\Delta \\log(\\tau/K_{A}) = 0.5 - (-0.2) $$\n$$ \\Delta\\Delta \\log(\\tau/K_{A}) = 0.5 + 0.2 = 0.7 $$\n\n$\\Delta\\Delta \\log(\\tau/K_{A})$的正值表明，与参考配体(AngII)相比，测试配体(TRV027)对arrestin通路的偏好性大于对$Gq$通路。因此，TRV027被认为相对于AngII具有arrestin偏向性。题目只要求提供最终的数值。", "answer": "$$\\boxed{0.7}$$", "id": "4524316"}, {"introduction": "配体测得的偏向性并非总是其固有属性，它可能受到特定细胞环境的影响，这一现象被称为“情境依赖性偏向 (context-dependent bias)”。本练习旨在探讨同一配体如何在不同组织中表现出不同的通路偏好性。此问题将要求您计算和比较跨越不同生物情境的偏向性因子，从而加深您对药物在体内作用复杂性的理解。[@problem_id:4524288]", "problem": "评估一个作用于G蛋白偶联受体（GPCR）的配体在两种不同组织中的通路选择性效能。对于组织A，该配体对G蛋白通路的转导系数$\\log_{10}\\!\\left(\\tau/K_{A}\\right)$为$0.5$，对β-arrestin通路的转导系数为$0.1$。对于组织B，该配体对G蛋白通路的转导系数$\\log_{10}\\!\\left(\\tau/K_{A}\\right)$为$0.1$，对β-arrestin通路的转导系数为$0.3$。一种用于标准化各组织内通路活性的单一参考激动剂，在两种组织中对G蛋白通路和β-arrestin通路的$\\log_{10}\\!\\left(\\tau/K_{A}\\right)$均为$0.2$。\n\n从偏向性激动是通过比较通路选择性转导相对于参考激动剂进行量化的核心定义出发，推导在每种组织中该配体偏向于G蛋白通路（相对于β-arrestin通路）的背景依赖性通路偏向，然后计算比较组织A相对于组织B中此偏向的标量商。将最终的商四舍五入至四位有效数字，并以无单位小数形式表示。", "solution": "首先验证问题陈述，以确保其科学和逻辑上的完整性。\n\n### 步骤1：提取已知条件\n设转导系数为$\\tau$，平衡解离常数为$K_A$。激动剂效能的度量由$\\log_{10}(\\tau/K_A)$给出。设配体表示为$L$，参考激动剂表示为$ref$。设G蛋白通路表示为$G$，$\\beta$-arrestin通路表示为$\\beta arr$。\n\n- **组织A：**\n  - 配体对G蛋白通路的效能：$(\\log_{10}(\\tau/K_A))_{L,G,A} = 0.5$\n  - 配体对$\\beta$-arrestin通路的效能：$(\\log_{10}(\\tau/K_A))_{L,\\beta arr,A} = 0.1$\n- **组织B：**\n  - 配体对G蛋白通路的效能：$(\\log_{10}(\\tau/K_A))_{L,G,B} = 0.1$\n  - 配体对$\\beta$-arrestin通路的效能：$(\\log_{10}(\\tau/K_A))_{L,\\beta arr,B} = 0.3$\n- **参考激动剂（在组织A和B中）：**\n  - 参考激动剂对G蛋白通路的效能：$(\\log_{10}(\\tau/K_A))_{ref,G} = 0.2$\n  - 参考激动剂对$\\beta$-arrestin通路的效能：$(\\log_{10}(\\tau/K_A))_{ref,\\beta arr} = 0.2$\n\n问题要求推导每种组织中的通路偏向，然后计算组织A相对于组织B中偏向的商。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于已建立的激动作用操作模型（Black & Leff）的原理及其在G蛋白偶联受体（GPCRs）偏向性激动中的应用。量$\\log_{10}(\\tau/K_A)$是衡量激动剂效能的标准指标。相对于参考激动剂比较通路选择性的概念是偏向性激动现代定义的核心。所提供的数值对于实验数据是合理的。\n- **问题明确**：问题陈述清晰，提供了所有必要的数据，并要求一个特定的、可计算的量。\n- **客观性**：问题完全以客观、定量的术语表达。\n\n### 步骤3：结论与行动\n该问题在科学上有效，内容自洽且表述明确。可以推导出解。\n\n### 求解推导\n偏向性激动的核心概念是，相对于参考激动剂，配体可能优先激活一个信号通路而不是另一个。这种通路偏向通过比较配体对两个通路的相对效能来量化。标准方法是计算对数尺度效能的差异。\n\n设$\\Delta\\log_{10}(\\text{Efficacy})$表示给定激动剂在G蛋白通路和$\\beta$-arrestin通路之间的对数效能差异。\n对于给定组织中的测试配体（$L$）：\n$$ \\Delta\\log_{10}(\\text{Efficacy})_L = (\\log_{10}(\\tau/K_A))_{L,G} - (\\log_{10}(\\tau/K_A))_{L,\\beta arr} $$\n对于参考激动剂（$ref$）：\n$$ \\Delta\\log_{10}(\\text{Efficacy})_{ref} = (\\log_{10}(\\tau/K_A))_{ref,G} - (\\log_{10}(\\tau/K_A))_{ref,\\beta arr} $$\n\n标准化的相对通路偏向，通常称为对数偏向因子或$\\Delta\\Delta\\log_{10}(\\tau/K_A)$，是配体的通路偏好与参考激动剂的通路偏好之间的差异。参考激动剂通常被选择为“无偏向的”，意味着它对两个通路的偏好相等，导致$\\Delta\\log_{10}(\\text{Efficacy})_{ref} = 0$，本题中正是这种情况。\n\n配体在特定组织（背景）中的对数偏向因子为：\n$$ \\Delta\\log_{10}(\\text{Bias}) = \\Delta\\log_{10}(\\text{Efficacy})_L - \\Delta\\log_{10}(\\text{Efficacy})_{ref} $$\n\n首先，我们计算配体在组织A中的对数偏向因子，记为$\\Delta\\log_{10}(\\text{Bias}_A)$。\n使用组织A的给定数据：\n$$ \\Delta\\log_{10}(\\text{Bias}_A) = \\left[ (\\log_{10}(\\tau/K_A))_{L,G,A} - (\\log_{10}(\\tau/K_A))_{L,\\beta arr,A} \\right] - \\left[ (\\log_{10}(\\tau/K_A))_{ref,G} - (\\log_{10}(\\tau/K_A))_{ref,\\beta arr} \\right] $$\n$$ \\Delta\\log_{10}(\\text{Bias}_A) = (0.5 - 0.1) - (0.2 - 0.2) = 0.4 - 0 = 0.4 $$\n这个正值表明，在组织A中，相对于参考激动剂，该配体偏向于G蛋白通路。\n\n接下来，我们计算配体在组织B中的对数偏向因子，记为$\\Delta\\log_{10}(\\text{Bias}_B)$。\n使用组织B的给定数据：\n$$ \\Delta\\log_{10}(\\text{Bias}_B) = \\left[ (\\log_{10}(\\tau/K_A))_{L,G,B} - (\\log_{10}(\\tau/K_A))_{L,\\beta arr,B} \\right] - \\left[ (\\log_{10}(\\tau/K_A))_{ref,G} - (\\log_{10}(\\tau/K_A))_{ref,\\beta arr} \\right] $$\n$$ \\Delta\\log_{10}(\\text{Bias}_B) = (0.1 - 0.3) - (0.2 - 0.2) = -0.2 - 0 = -0.2 $$\n这个负值表明，在组织B中，相对于参考激动剂，该配体偏离G蛋白通路而偏向于$\\beta$-arrestin通路。\n\n问题要求一个“比较此偏向的标量商”。对数偏向因子是一个对数量。线性尺度上相应的“偏向因子”通过取反对数（以$10$为底）获得。偏向因子$B$定义为：\n$$ B = 10^{\\Delta\\log_{10}(\\text{Bias})} $$\n该值表示对G蛋白通路相对于$\\beta$-arrestin通路的倍数偏好，并已对参考激动剂进行了标准化。\n\n对于组织A，偏向因子为：\n$$ B_A = 10^{\\Delta\\log_{10}(\\text{Bias}_A)} = 10^{0.4} $$\n对于组织B，偏向因子为：\n$$ B_B = 10^{\\Delta\\log_{10}(\\text{Bias}_B)} = 10^{-0.2} $$\n\n比较组织A相对于组织B中偏向的标量商$Q$是它们各自偏向因子的比率：\n$$ Q = \\frac{B_A}{B_B} $$\n代入$B_A$和$B_B$的表达式：\n$$ Q = \\frac{10^{0.4}}{10^{-0.2}} = 10^{0.4 - (-0.2)} = 10^{0.6} $$\n\n最后，我们计算$Q$的数值并四舍五入至四位有效数字。\n$$ Q = 10^{0.6} \\approx 3.9810717... $$\n四舍五入至四位有效数字得到：\n$$ Q \\approx 3.981 $$\n此结果表明，该配体对G蛋白通路的偏向（相对于β-arrestin通路）在组织A中比在组织B中大约强$3.981$倍。", "answer": "$$\\boxed{3.981}$$", "id": "4524288"}, {"introduction": "药理学的最终目标是预测药物在生命系统中的时效关系。这项高级实践通过将偏向性激动作用整合到药代动力学-药效动力学 (PK-PD) 模型中，弥合了静态体外测量与动态体内响应之间的鸿沟。通过构建并运行此模拟，您将获得模拟通路特异性效应时间进程的实践经验，这是转化药物开发和给药方案优化的关键技能。[@problem_id:4524345]", "problem": "您需要形式化并模拟一个药代动力学-药效动力学模型，该模型通过两个通路特异性的可饱和响应模型来捕捉偏向性激动现象。该模型必须从第一性原理的质量平衡和标准的药效动力学关联推导得出，其中效应室（生物相）浓度驱动两种不同的通路效应。您的程序必须计算多个给药方案的指定摘要指标，并在单个聚合输出中返回它们。\n\n使用的基本原理和定义：\n- 具有线性消除和外部输入的单室模型的药代动力学遵循质量平衡。设 $C(t)$ 表示中央室浓度（单位 $\\mathrm{mg/L}$），$V$ 表示表观分布容积（单位 $\\mathrm{L}$），$CL$ 表示清除率（单位 $\\mathrm{L/h}$），$R_{\\text{in}}(t)$ 表示零级输入速率（单位 $\\mathrm{mg/h}$）。质量平衡方程为\n$$\n\\frac{dC(t)}{dt} \\;=\\; -\\frac{CL}{V}\\,C(t) \\;+\\; \\frac{R_{\\text{in}}(t)}{V}.\n$$\n在时间 $t_k$ 给予的大小为 $D_k$ 的瞬时推注剂量，被建模为浓度的跳跃 $C(t_k^+) = C(t_k^-) + \\frac{D_k}{V}$。\n- 效应室（生物相）浓度关联由标准效应室模型给出，其速率常数为 $k_{e0}$（单位 $\\mathrm{h^{-1}}$）：\n$$\n\\frac{dC_e(t)}{dt} \\;=\\; k_{e0}\\,\\big(C(t) - C_e(t)\\big).\n$$\n- 两种通路特异性的药效动力学响应由可饱和的Hill方程描述，其中通路特异性参数反映了偏向性。对于通路 $\\mathcal{G}$ 和通路 $\\mathcal{B}$，瞬时效应 $E_{\\mathcal{G}}(t)$ 和 $E_{\\mathcal{B}}(t)$（以任意效应单位计）为：\n$$\nE_{\\mathcal{G}}(t) \\;=\\; E_{\\max,\\mathcal{G}} \\;\\frac{C_e(t)^{n_{\\mathcal{G}}}}{EC_{50,\\mathcal{G}}^{n_{\\mathcal{G}}} + C_e(t)^{n_{\\mathcal{G}}}}, \n\\qquad\nE_{\\mathcal{B}}(t) \\;=\\; E_{\\max,\\mathcal{B}} \\;\\frac{C_e(t)^{n_{\\mathcal{B}}}}{EC_{50,\\mathcal{B}}^{n_{\\mathcal{B}}} + C_e(t)^{n_{\\mathcal{B}}}},\n$$\n其中 $E_{\\max,\\mathcal{G}}, E_{\\max,\\mathcal{B}}$ 是最大效应，$EC_{50,\\mathcal{G}}, EC_{50,\\mathcal{B}}$ 是半数最大效应浓度（单位 $\\mathrm{mg/L}$），$n_{\\mathcal{G}}, n_{\\mathcal{B}}$ 是Hill系数。通路特异性参数在 $\\mathcal{G}$ 和 $\\mathcal{B}$ 之间的差异反映了偏向性激动。\n\n模拟要求：\n- 在有限时间范围 $[0, T_{\\text{end}}]$（其中 $T_{\\text{end}}$ 由每个测试用例指定）上，使用固定的步长 $\\Delta t$（单位 $\\mathrm{h}$）在均匀时间网格上对上述常微分方程进行数值积分。您可以使用与方程和给药事件一致的显式时间步进格式。确保在每个步骤内进行导数评估之前，在预定时间将推注事件作为瞬时跳跃应用。\n- 为每个测试用例计算：\n    - 峰效应 $E_{\\mathcal{G},\\max} = \\max_t E_{\\mathcal{G}}(t)$。\n    - 峰效应 $E_{\\mathcal{B},\\max} = \\max_t E_{\\mathcal{B}}(t)$。\n    - 效应-时间曲线下面积比值 $\\mathrm{AUEC\\_ratio} = \\dfrac{\\int_0^{T_{\\text{end}}} E_{\\mathcal{G}}(t)\\,dt}{\\int_0^{T_{\\text{end}}} E_{\\mathcal{B}}(t)\\,dt}$；在模拟网格上使用梯形法则。\n- 所有计算量 $E_{\\mathcal{G},\\max}$ 和 $E_{\\mathcal{B},\\max}$ 的单位为效应单位，而 $\\mathrm{AUEC\\_ratio}$ 是无量纲的（无单位）。报告每个浮点数时，四舍五入到 $6$ 位小数。\n\n测试套件：\n精确实现以下三个测试用例。对于每个用例，使用指定的参数，在 $[0, T_{\\text{end}}]$ 上以给定的均匀步长 $\\Delta t$ 进行模拟。浓度单位为 $\\mathrm{mg/L}$，剂量单位为 $\\mathrm{mg}$，容积单位为 $\\mathrm{L}$，清除率单位为 $\\mathrm{L/h}$，速率单位为 $\\mathrm{mg/h}$，时间单位为 $\\mathrm{h}$。\n\n- 测试用例 #1（单次推注）：\n    - $V = 20$ $\\mathrm{L}$, $CL = 3$ $\\mathrm{L/h}$, $k_{e0} = 1.5$ $\\mathrm{h^{-1}}$。\n    - 推注剂量：在 $t = 0$ $\\mathrm{h}$ 时推注一次 $100$ $\\mathrm{mg}$。\n    - 零级输注：无，即对于所有 $t$，$R_{\\text{in}}(t) = 0$。\n    - 药效动力学：$E_{\\max,\\mathcal{G}} = 100$, $EC_{50,\\mathcal{G}} = 1$ $\\mathrm{mg/L}$, $n_{\\mathcal{G}} = 1$；$E_{\\max,\\mathcal{B}} = 60$, $EC_{50,\\mathcal{B}} = 3$ $\\mathrm{mg/L}$, $n_{\\mathcal{B}} = 1$。\n    - 时间范围和步长：$T_{\\text{end}} = 24$ $\\mathrm{h}$，$\\Delta t = 0.01$ $\\mathrm{h}$。\n\n- 测试用例 #2（多次推注）：\n    - $V = 40$ $\\mathrm{L}$, $CL = 2$ $\\mathrm{L/h}$, $k_{e0} = 0.5$ $\\mathrm{h^{-1}}$。\n    - 推注剂量：在 $t \\in \\{0, 6, 12, 18\\}$ $\\mathrm{h}$ 时给予 $50$ $\\mathrm{mg}$。\n    - 零级输注：无，即对于所有 $t$，$R_{\\text{in}}(t) = 0$。\n    - 药效动力学：$E_{\\max,\\mathcal{G}} = 120$, $EC_{50,\\mathcal{G}} = 2$ $\\mathrm{mg/L}$, $n_{\\mathcal{G}} = 1.5$；$E_{\\max,\\mathcal{B}} = 80$, $EC_{50,\\mathcal{B}} = 1.8$ $\\mathrm{mg/L}$, $n_{\\mathcal{B}} = 1$。\n    - 时间范围和步长：$T_{\\text{end}} = 24$ $\\mathrm{h}$，$\\Delta t = 0.01$ $\\mathrm{h}$。\n\n- 测试用例 #3（有限时长输注）：\n    - $V = 25$ $\\mathrm{L}$, $CL = 5$ $\\mathrm{L/h}$, $k_{e0} = 2$ $\\mathrm{h^{-1}}$。\n    - 推注剂量：无。\n    - 零级输注：当 $t \\in [0, 8)$ $\\mathrm{h}$ 时 $R_{\\text{in}}(t) = 20$ $\\mathrm{mg/h}$，否则 $R_{\\text{in}}(t) = 0$。\n    - 药效动力学：$E_{\\max,\\mathcal{G}} = 90$, $EC_{50,\\mathcal{G}} = 1.5$ $\\mathrm{mg/L}$, $n_{\\mathcal{G}} = 1$；$E_{\\max,\\mathcal{B}} = 90$, $EC_{50,\\mathcal{B}} = 4$ $\\mathrm{mg/L}$, $n_{\\mathcal{B}} = 1.2$。\n    - 时间范围和步长：$T_{\\text{end}} = 24$ $\\mathrm{h}$，$\\Delta t = 0.01$ $\\mathrm{h}$。\n\n最终输出格式：\n- 按顺序为上述每个测试用例计算三元组 $\\left[E_{\\mathcal{G},\\max}, E_{\\mathcal{B},\\max}, \\mathrm{AUEC\\_ratio}\\right]$，每个浮点数四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含按顺序串联的所有结果，形式为逗号分隔的列表并用方括号括起，即一个长度为 $9$ 的扁平列表，顺序为 $\\left[E_{\\mathcal{G},\\max}^{(1)}, E_{\\mathcal{B},\\max}^{(1)}, \\mathrm{AUEC\\_ratio}^{(1)}, E_{\\mathcal{G},\\max}^{(2)}, \\dots, \\mathrm{AUEC\\_ratio}^{(3)}\\right]$。", "solution": "用户的请求是一个在定量系统药理学中明确定义的问题，要求模拟一个药代动力学-药效动力学（PK/PD）模型。该模型捕捉了偏向性激动现象，即药物分子通过不同的信号通路引发不同的响应。该问题具有科学依据，数学上一致，并为获得唯一解提供了所有必要的参数和条件。因此，它被认为是一个有效的问题。\n\n### **1. 问题形式化与控制方程**\n\n该系统由一组耦合的常微分方程（ODEs）描述。药代动力学遵循单室模型，其中中央室药物浓度 $C(t)$ 的变化速率由线性消除和外部输入速率 $R_{\\text{in}}(t)$ 控制。质量平衡方程为：\n\n$$\n\\frac{dC(t)}{dt} \\;=\\; -k_{el}\\,C(t) \\;+\\; \\frac{R_{\\text{in}}(t)}{V}\n$$\n\n其中 $V$ 是分布容积，$CL$ 是清除率，$k_{el} = \\frac{CL}{V}$ 是一级消除速率常数。\n\n中央室浓度 $C(t)$ 驱动一个假设的效应室中的浓度 $C_e(t)$，该效应室代表药物作用的生物相。其关联描述为：\n\n$$\n\\frac{dC_e(t)}{dt} \\;=\\; k_{e0}\\,\\big(C(t) - C_e(t)\\big)\n$$\n\n其中 $k_{e0}$ 是中央室和效应室之间平衡的速率常数。\n\n药效动力学响应针对两个独立的通路进行建模，表示为 $\\mathcal{G}$ 和 $\\mathcal{B}$。效应室浓度 $C_e(t)$ 刺激两个通路，但具有不同的特性，这反映了偏向性激动。瞬时效应 $E_{\\mathcal{G}}(t)$ 和 $E_{\\mathcal{B}}(t)$ 由可饱和的Hill方程描述：\n\n$$\nE_{\\mathcal{G}}(t) \\;=\\; E_{\\max,\\mathcal{G}} \\;\\frac{C_e(t)^{n_{\\mathcal{G}}}}{EC_{50,\\mathcal{G}}^{n_{\\mathcal{G}}} + C_e(t)^{n_{\\mathcal{G}}}}, \n\\qquad\nE_{\\mathcal{B}}(t) \\;=\\; E_{\\max,\\mathcal{B}} \\;\\frac{C_e(t)^{n_{\\mathcal{B}}}}{EC_{50,\\mathcal{B}}^{n_{\\mathcal{B}}} + C_e(t)^{n_{\\mathcal{B}}}}\n$$\n\n参数 $E_{\\max}$、$EC_{50}$ 和 $n$ 是通路特异性的，允许差异性激活。\n\n### **2. 数值模拟策略**\n\n该常微分方程组通常没有简单的解析解，特别是在复杂的给药方案下。因此，需要采用数值方法。问题指定使用显式的、固定步长的时间步进格式。前向欧拉法是此类格式中最简单的，并且考虑到所指定的小步长 $\\Delta t$，该方法是合适的，因为它能确保在给定参数下的数值稳定性。\n\n系统在任意时间 $t$ 的状态由向量 $[C(t), C_e(t)]$ 给出。我们将时间范围 $[0, T_{\\text{end}}]$ 离散化为大小为 $\\Delta t$ 的均匀步长，其中 $t_i = i \\cdot \\Delta t$。时间 $t_{i+1}$ 的状态可由时间 $t_i$ 的状态近似如下：\n\n$$\nC(t_{i+1}) \\approx C(t_i) + \\Delta t \\left( -k_{el}\\,C(t_i) + \\frac{R_{\\text{in}}(t_i)}{V} \\right)\n$$\n$$\nC_e(t_{i+1}) \\approx C_e(t_i) + \\Delta t \\left( k_{e0}\\,\\big(C(t_i) - C_e(t_i)\\big) \\right)\n$$\n\n初始条件取为 $C(0) = 0$ 和 $C_e(0) = 0$，表示给药前无药物的状态。\n\n### **3. 给药事件的实现**\n\n给药事件通过以下方式并入数值模拟：\n\n-   **推注剂量**：在时间 $t_k$ 进行的静脉推注剂量 $D_k$ 被建模为中央室浓度的瞬时增加。如果 $t_k$ 对应于第 $j$ 个时间步（即 $t_k = j \\cdot \\Delta t$），则浓度 $C(t_j)$ 更新为 $C(t_j^+) = C(t_j^-) + D_k/V$。在算法中，这是通过在计算该步骤的导数*之前*，将项 $D_k/V$ 加到索引 $j$ 处的浓度值上来实现的。\n\n-   **零级输注**：在特定持续时间内以速率 $R_{\\text{in}}$ 进行的连续输注，通过在欧拉更新步骤中，将所有在输注区间内的时间点 $t_i$ 的 $R_{\\text{in}}(t_i)$ 项设置为指定速率，而在其他时间点设置为0来建模。\n\n### **4. 摘要指标的计算**\n\n在时间网格上模拟浓度曲线 $C(t)$ 和 $C_e(t)$ 后，计算以下指标：\n\n1.  **通路效应**：使用模拟的 $C_e(t_i)$ 值和各自的Hill方程，为时间网格上的每个点计算效应时间序列 $E_{\\mathcal{G}}(t_i)$ 和 $E_{\\mathcal{B}}(t_i)$。\n\n2.  **峰效应**：通过从各自的效应时间序列数组中取最大值，来找到每个通路的最大值 $E_{\\mathcal{G},\\max}$ 和 $E_{\\mathcal{B},\\max}$。\n    $$\n    E_{\\mathcal{G},\\max} = \\max_{i} E_{\\mathcal{G}}(t_i), \\qquad E_{\\mathcal{B},\\max} = \\max_{i} E_{\\mathcal{B}}(t_i)\n    $$\n\n3.  **效应-时间曲线下面积（AUEC）比值**：根据要求，使用数值梯形法则计算每个效应曲线下的总面积。\n    $$\n    \\text{AUEC}_{\\mathcal{G}} = \\int_0^{T_{\\text{end}}} E_{\\mathcal{G}}(t)\\,dt \\approx \\sum_{i=0}^{N-1} \\frac{E_{\\mathcal{G}}(t_i) + E_{\\mathcal{G}}(t_{i+1})}{2} \\Delta t\n    $$\n    对 $\\text{AUEC}_{\\mathcal{B}}$ 进行类似的计算。然后计算最终的比值：\n    $$\n    \\mathrm{AUEC\\_ratio} = \\frac{\\mathrm{AUEC}_{\\mathcal{G}}}{\\mathrm{AUEC}_{\\mathcal{B}}}\n    $$\nNumPy函数 `numpy.trapz` 非常适合此计算。最终的量值按要求四舍五入到 $6$ 位小数。对所提供的三个测试用例中的每一个都重复整个过程。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(params):\n    \"\"\"\n    Simulates a PK/PD model for biased agonism for a single test case.\n    \n    Args:\n        params (dict): A dictionary containing all parameters for the simulation.\n    \n    Returns:\n        tuple: A tuple containing (E_g_max, E_b_max, auec_ratio) rounded to 6 decimals.\n    \"\"\"\n    # Unpack parameters\n    V, CL, k_e0 = params['pk']\n    bolus_doses = params['bolus']  # format: {time: dose}\n    infusion_rate, infusion_duration = params['infusion']\n    pd_g = params['pd_g']\n    pd_b = params['pd_b']\n    T_end, dt = params['sim']\n\n    # Simulation setup\n    num_steps = int(round(T_end / dt))\n    t_grid = np.linspace(0, T_end, num_steps + 1)\n    \n    C = np.zeros(num_steps + 1)\n    Ce = np.zeros(num_steps + 1)\n    \n    # Pre-calculate indices for bolus doses for efficiency\n    bolus_indices = {int(round(t / dt)): dose for t, dose in bolus_doses.items()}\n    \n    # Elimination rate constant\n    k_el = CL / V\n\n    # Simulation loop using Forward Euler method\n    for i in range(num_steps):\n        # 1. Apply instantaneous bolus dose at time t_grid[i]\n        # This models C(t_k^+) = C(t_k^-) + D/V\n        if i in bolus_indices:\n            C[i] += bolus_indices[i] / V\n            \n        # 2. Determine infusion rate R_in at the current time step\n        current_t = t_grid[i]\n        R_in = infusion_rate if current_t < infusion_duration else 0\n        \n        # 3. Calculate derivatives based on the state at time t_i\n        dC_dt = -k_el * C[i] + R_in / V\n        dCe_dt = k_e0 * (C[i] - Ce[i])\n        \n        # 4. Update concentrations for the next time step t_{i+1}\n        C[i+1] = C[i] + dC_dt * dt\n        Ce[i+1] = Ce[i] + dCe_dt * dt\n\n    # Calculate PD responses from the simulated effect-site concentration profile\n    E_max_g, EC50_g, n_g = pd_g\n    E_max_b, EC50_b, n_b = pd_b\n    \n    # Using np.maximum to ensure non-negative concentrations for Hill equation,\n    # though with this model they should not become negative with stable time steps.\n    Ce_safe = np.maximum(0, Ce)\n    \n    # Calculate effect for pathway G\n    numerator_g = E_max_g * (Ce_safe ** n_g)\n    denominator_g = EC50_g ** n_g + Ce_safe ** n_g\n    E_g = np.divide(numerator_g, denominator_g, out=np.zeros_like(numerator_g), where=denominator_g!=0)\n\n    # Calculate effect for pathway B\n    numerator_b = E_max_b * (Ce_safe ** n_b)\n    denominator_b = EC50_b ** n_b + Ce_safe ** n_b\n    E_b = np.divide(numerator_b, denominator_b, out=np.zeros_like(numerator_b), where=denominator_b!=0)\n\n    # Calculate summary metrics\n    E_g_max = np.max(E_g)\n    E_b_max = np.max(E_b)\n\n    AUEC_g = np.trapz(E_g, t_grid)\n    AUEC_b = np.trapz(E_b, t_grid)\n    \n    # Handle potential division by zero for the ratio\n    if AUEC_b == 0:\n        auec_ratio = np.inf if AUEC_g > 0 else 0.0\n    else:\n        auec_ratio = AUEC_g / AUEC_b\n\n    return round(E_g_max, 6), round(E_b_max, 6), round(auec_ratio, 6)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case #1 (single bolus)\n        {\n            'pk': (20, 3, 1.5),  # V (L), CL (L/h), k_e0 (h^-1)\n            'bolus': {0: 100},  # {time (h): dose (mg)}\n            'infusion': (0, 0), # rate (mg/h), duration (h)\n            'pd_g': (100, 1, 1), # E_max, EC_50 (mg/L), n\n            'pd_b': (60, 3, 1),\n            'sim': (24, 0.01) # T_end (h), dt (h)\n        },\n        # Test case #2 (multiple boluses)\n        {\n            'pk': (40, 2, 0.5),\n            'bolus': {0: 50, 6: 50, 12: 50, 18: 50},\n            'infusion': (0, 0),\n            'pd_g': (120, 2, 1.5),\n            'pd_b': (80, 1.8, 1),\n            'sim': (24, 0.01)\n        },\n        # Test case #3 (finite-duration infusion)\n        {\n            'pk': (25, 5, 2),\n            'bolus': {},\n            'infusion': (20, 8),\n            'pd_g': (90, 1.5, 1),\n            'pd_b': (90, 4, 1.2),\n            'sim': (24, 0.01)\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        # Run simulation for one case and get the three summary metrics.\n        result_tuple = run_simulation(params)\n        results.extend(result_tuple)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# The following call is for local execution and is commented out \n# to meet the platform's execution context.\n# solve()\n```", "answer": "[83.333333,42.857143,1.385735,76.62148,65.81196,1.442299,57.170668,36.568285,1.758416]", "id": "4524345"}]}