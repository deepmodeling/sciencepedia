{"hands_on_practices": [{"introduction": "为了精确地模拟药物处置过程，我们首先必须理解并量化我们测量中的噪声。本练习探讨了广泛用于描述残差变异的组合误差模型，该模型同时考虑了浓度依赖和浓度独立的误差来源。通过推导这两种误差来源对总方差贡献相等的临界浓度，您将对残差误差在整个浓度范围内的行为获得更深刻的直觉，并理解为何该模型如此灵活。[@problem_id:4592593]", "problem": "在群体药代动力学 (PopPK) 中，药物实测浓度的残余未知变异通常由一个复合误差模型来表示，该模型包括一个加性成分和一个比例成分。考虑一个单一的浓度后验预测值，记为 $C$，以及一个由下式定义的观测模型\n$$\nY \\;=\\; C\\,(1 + \\epsilon_{\\text{prop}}) + \\epsilon_{\\text{add}},\n$$\n其中 $\\epsilon_{\\text{add}} \\sim \\mathcal{N}(0,\\sigma_{\\text{add}}^{2})$ 和 $\\epsilon_{\\text{prop}} \\sim \\mathcal{N}(0,\\sigma_{\\text{prop}}^{2})$ 是独立的随机变量。仅使用方差、独立性和线性的统计学定义，推导出使得加性成分和比例成分对给定 $C$ 时 $Y$ 的条件方差贡献相等的浓度 $C^{\\ast}$。然后，对于具体的参数值 $\\sigma_{\\text{add}} = 0.137\\,\\text{mg}\\,\\text{L}^{-1}$ 和 $\\sigma_{\\text{prop}} = 0.215$ (无量纲)，计算 $C^{\\ast}$ 的数值。将您的最终数值答案四舍五入至四位有效数字，并以 $\\text{mg}\\,\\text{L}^{-1}$ 为单位表示最终浓度。", "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、良定且客观的。它提出了一个群体药代动力学中的标准问题，可以使用统计学的基本原理来解决。\n\n药物实测浓度 $Y$ 的观测模型由下式给出\n$$\nY = C(1 + \\epsilon_{\\text{prop}}) + \\epsilon_{\\text{add}}\n$$\n其中 $C$ 是预测浓度，而 $\\epsilon_{\\text{prop}}$ 和 $\\epsilon_{\\text{add}}$ 分别是代表比例误差和加性误差的独立随机变量。这些误差被指定为服从均值为零、方差分别为 $\\sigma_{\\text{prop}}^2$ 和 $\\sigma_{\\text{add}}^2$ 的正态分布：\n$$\n\\epsilon_{\\text{add}} \\sim \\mathcal{N}(0, \\sigma_{\\text{add}}^2)\n$$\n$$\n\\epsilon_{\\text{prop}} \\sim \\mathcal{N}(0, \\sigma_{\\text{prop}}^2)\n$$\n我们的目标是推导在给定预测浓度 $C$ 的条件下 $Y$ 的条件方差，记作 $\\text{Var}(Y|C)$。在这种情况下，$C$ 被视为一个已知常数。我们可以将模型方程重写为：\n$$\nY = C + C\\epsilon_{\\text{prop}} + \\epsilon_{\\text{add}}\n$$\n为了求方差，我们应用方差算子的基本性质。\n\n$1$. 一个随机变量加上一个常数后的方差等于该随机变量本身的方差。由于 $C$ 被视为常数，我们有：\n$$\n\\text{Var}(Y|C) = \\text{Var}(C + C\\epsilon_{\\text{prop}} + \\epsilon_{\\text{add}}) = \\text{Var}(C\\epsilon_{\\text{prop}} + \\epsilon_{\\text{add}})\n$$\n\n$2$. 对于两个独立的随机变量 $X$ 和 $Z$，它们和的方差等于它们方差的和：$\\text{Var}(X+Z) = \\text{Var}(X) + \\text{Var}(Z)$。题目说明 $\\epsilon_{\\text{prop}}$ 和 $\\epsilon_{\\text{add}}$ 是独立的。因此，随机变量 $C\\epsilon_{\\text{prop}}$ 和 $\\epsilon_{\\text{add}}$ 也是独立的。所以，\n$$\n\\text{Var}(Y|C) = \\text{Var}(C\\epsilon_{\\text{prop}}) + \\text{Var}(\\epsilon_{\\text{add}})\n$$\n\n$3$. 一个随机变量乘以一个常数 $a$ 后的方差等于原方差乘以 $a$ 的平方：$\\text{Var}(aX) = a^2\\text{Var}(X)$。将此性质应用于项 $\\text{Var}(C\\epsilon_{\\text{prop}})$：\n$$\n\\text{Var}(C\\epsilon_{\\text{prop}}) = C^2 \\text{Var}(\\epsilon_{\\text{prop}})\n$$\n\n综合这些性质，我们得到 $Y$ 的条件方差的表达式：\n$$\n\\text{Var}(Y|C) = C^2 \\text{Var}(\\epsilon_{\\text{prop}}) + \\text{Var}(\\epsilon_{\\text{add}})\n$$\n代入给定的方差 $\\text{Var}(\\epsilon_{\\text{prop}}) = \\sigma_{\\text{prop}}^2$ 和 $\\text{Var}(\\epsilon_{\\text{add}}) = \\sigma_{\\text{add}}^2$，我们得到：\n$$\n\\text{Var}(Y|C) = C^2 \\sigma_{\\text{prop}}^2 + \\sigma_{\\text{add}}^2\n$$\n在这个复合误差模型中，项 $C^2 \\sigma_{\\text{prop}}^2$ 代表比例误差成分对总方差的贡献，而项 $\\sigma_{\\text{add}}^2$ 代表加性误差成分的贡献。\n\n问题要求的是使这两个成分对总方差贡献相等的浓度 $C^{\\ast}$。我们令这两项相等：\n$$\n(C^{\\ast})^2 \\sigma_{\\text{prop}}^2 = \\sigma_{\\text{add}}^2\n$$\n解出 $(C^{\\ast})^2$：\n$$\n(C^{\\ast})^2 = \\frac{\\sigma_{\\text{add}}^2}{\\sigma_{\\text{prop}}^2}\n$$\n由于浓度必须是一个非负的物理量，我们取正平方根：\n$$\nC^{\\ast} = \\sqrt{\\frac{\\sigma_{\\text{add}}^2}{\\sigma_{\\text{prop}}^2}} = \\frac{\\sigma_{\\text{add}}}{\\sigma_{\\text{prop}}}\n$$\n这个表达式给出了这样一个浓度，在该浓度下，比例误差成分的标准差 $C^{\\ast}\\sigma_{\\text{prop}}$ 等于加性误差成分的标准差 $\\sigma_{\\text{add}}$。\n\n我们已知数值为 $\\sigma_{\\text{add}} = 0.137\\,\\text{mg}\\,\\text{L}^{-1}$ 和 $\\sigma_{\\text{prop}} = 0.215$ (无量纲)。将这些值代入推导出的 $C^{\\ast}$ 表达式中：\n$$\nC^{\\ast} = \\frac{0.137\\,\\text{mg}\\,\\text{L}^{-1}}{0.215} \\approx 0.637209302\\,\\text{mg}\\,\\text{L}^{-1}\n$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$\nC^{\\ast} \\approx 0.6372\\,\\text{mg}\\,\\text{L}^{-1}\n$$", "answer": "$$\\boxed{0.6372}$$", "id": "4592593"}, {"introduction": "群体药代动力学模型中变异的各个来源并非相互孤立，它们会以微妙的方式相互影响。本练习展示了一个关键场景：错误设定残差误差模型会导致对个体间变异（IIV）的估计产生偏差。解决这个问题将揭示未解释的方差如何被错误地归因于患者间的差异，从而强调了仔细进行模型诊断以确保所有模型组成部分都被正确设定的极端重要性。[@problem_id:4592580]", "problem": "在群体药代动力学 (PopPK) 分析中，考虑清除率上的单个随机效应，该效应在浓度上产生乘性个体间变异 (IIV)。设每个受试者 $i$ 在对数尺度的清除率上有一个随机效应 $\\eta_{i} \\sim \\mathcal{N}(0, \\omega_{\\text{true}})$，因此在典型预测浓度为 $f_{j} > 0$ 的固定设计点 $j$ 上，原始浓度尺度上的真实观测模型为\n$$\ny_{ij} \\;=\\; f_{j} \\,\\exp(\\eta_{i})\\,\\big(1 + \\varepsilon_{p,ij}\\big),\n$$\n其中残差是比例（乘性）的，$\\varepsilon_{p,ij} \\sim \\mathcal{N}(0, \\sigma_{p}^{2})$。假设对于所有 $i, j$，$\\eta_{i}$ 和 $\\varepsilon_{p,ij}$ 都是独立的，并且该设计包含两个不同的设计点 $j \\in \\{1,2\\}$，其中 $f_{1} = 8$ 和 $f_{2} = 20$（单位：毫克/升），且每个设计点的受试者数量相等。每个受试者在其设计点上提供一个观测值。\n\n一位分析师拟合了一个设定错误的模型，该模型在原始尺度上具有加性残差：\n$$\ny_{ij} \\;=\\; f_{j} \\,\\exp(\\eta_{i}) \\;+\\; \\varepsilon_{a,ij},\n$$\n其中 $\\eta_{i} \\sim \\mathcal{N}(0, \\omega)$，$\\varepsilon_{a,ij} \\sim \\mathcal{N}(0, \\sigma^{2})$，且所有随机项均独立。此处 $\\omega$ 是待估计的个体间方差矩阵 $\\Omega$ 的标量元素，而 $\\sigma^{2}$ 是（设定错误的）加性残差方差，对所有 $j$ 均为常数。\n\n从第一性原理出发——即正态分布的性质、针对小随机扰动的一阶泰勒展开，以及 Kullback–Leibler 散度的定义（等价于在真实数据生成过程下最大化期望对数似然）——推导当真实残差为比例性时，设定错误的加性残差模型导致对 $\\Omega$ 中 IIV 方差 $\\omega$ 高估的条件。\n\n在由 $\\eta_{i}$ 和 $\\varepsilon_{p,ij}$ 在 0 附近的一阶泰勒展开所隐含的正态近似下，确定伪真值 $\\omega^{\\star}$，该值使得设定错误的模型在两个设计点上的期望对数似然最大化。然后，对于 $\\,\\omega_{\\text{true}} = 0.05\\,$ 和 $\\,\\sigma_{p}^{2} = 0.07\\,$，数值计算 $\\omega^{\\star}$。将最终数值答案四舍五入至四位有效数字。最终答案不带单位。", "solution": "问题要求推导在何种条件下，一个设定错误的加性残差模型会导致对个体间变异 (IIV) 方差的高估，并计算该方差的伪真值 $\\omega^{\\star}$。分析将基于一阶泰勒展开和最大化期望对数似然的原理。\n\n首先，我们定义真实数据生成过程和设定错误的模型，以及它们在一阶近似下的性质。\n\n真实观测模型由下式给出：\n$$\ny_{ij} \\;=\\; f_{j} \\,\\exp(\\eta_{i})\\,\\big(1 + \\varepsilon_{p,ij}\\big)\n$$\n其中 $\\eta_{i} \\sim \\mathcal{N}(0, \\omega_{\\text{true}})$ 且 $\\varepsilon_{p,ij} \\sim \\mathcal{N}(0, \\sigma_{p}^{2})$。假定量 $\\eta_{i}$ 和 $\\varepsilon_{p,ij}$ 很小。我们可以在 $\\eta_i = 0$ 和 $\\varepsilon_{p,ij} = 0$ 附近应用一阶泰勒展开：\n$\\exp(\\eta_i) \\approx 1 + \\eta_i$。\n因此，模型变为：\n$$\ny_{ij} \\approx f_{j} (1 + \\eta_i)(1 + \\varepsilon_{p,ij}) = f_{j} (1 + \\eta_i + \\varepsilon_{p,ij} + \\eta_i \\varepsilon_{p,ij})\n$$\n忽略二阶项 $\\eta_i \\varepsilon_{p,ij}$，线性化的真实模型为：\n$$\ny_{ij} \\approx f_{j} + f_{j}\\eta_{i} + f_{j}\\varepsilon_{p,ij}\n$$\n在此近似下，$y_{ij}$ 服从正态分布。其在真实过程下（用下标 'true' 表示）的期望值和方差为：\n$$\nE_{\\text{true}}[y_{ij}] = E[f_{j} + f_{j}\\eta_{i} + f_{j}\\varepsilon_{p,ij}] = f_{j} + f_{j}E[\\eta_{i}] + f_{j}E[\\varepsilon_{p,ij}] = f_{j}\n$$\n$$\n\\text{Var}_{\\text{true}}(y_{ij}) = \\text{Var}(f_{j}\\eta_{i} + f_{j}\\varepsilon_{p,ij}) = f_{j}^{2}\\text{Var}(\\eta_{i}) + f_{j}^{2}\\text{Var}(\\varepsilon_{p,ij}) = f_{j}^{2}(\\omega_{\\text{true}} + \\sigma_{p}^{2})\n$$\n方差的第二个等式由于 $\\eta_i$ 和 $\\varepsilon_{p,ij}$ 的独立性而成立。让我们将这个真实方差表示为 $V_{\\text{true}, j} = f_{j}^{2}(\\omega_{\\text{true}} + \\sigma_{p}^{2})$。\n\n分析师拟合的设定错误的模型是：\n$$\ny_{ij} \\;=\\; f_{j} \\,\\exp(\\eta_{i}) \\;+\\; \\varepsilon_{a,ij}\n$$\n其中 $\\eta_{i} \\sim \\mathcal{N}(0, \\omega)$ 且 $\\varepsilon_{a,ij} \\sim \\mathcal{N}(0, \\sigma^{2})$。对 $\\exp(\\eta_i)$ 应用相同的一阶泰勒展开：\n$$\ny_{ij} \\approx f_{j} (1 + \\eta_i) + \\varepsilon_{a,ij} = f_{j} + f_{j}\\eta_{i} + \\varepsilon_{a,ij}\n$$\n在设定错误的模型下（用 $M$ 表示），$y_{ij}$ 被假定服从正态分布，其期望和方差为：\n$$\nE_{M}[y_{ij}] = E[f_{j} + f_{j}\\eta_{i} + \\varepsilon_{a,ij}] = f_{j}\n$$\n$$\n\\text{Var}_{M}(y_{ij}) = \\text{Var}(f_{j}\\eta_{i} + \\varepsilon_{a,ij}) = f_{j}^{2}\\text{Var}(\\eta_{i}) + \\text{Var}(\\varepsilon_{a,ij}) = f_{j}^{2}\\omega + \\sigma^{2}\n$$\n让我们将这个模型预测的方差表示为 $V_{M, j}(\\omega, \\sigma^2) = f_{j}^{2}\\omega + \\sigma^{2}$。\n\n伪真参数 $(\\omega^{\\star}, \\sigma^{2\\star})$ 是使真实分布与设定错误的分布之间的 Kullback-Leibler 散度最小化的 $(\\omega, \\sigma^2)$ 的值。这等价于最大化设定错误模型的期望对数似然，其中期望是针对真实数据生成分布计算的。\n\n在设定错误的模型下，单个观测值 $y_{ij}$ 的对数似然是正态分布的对数似然：\n$$\n\\log L(y_{ij}; \\omega, \\sigma^{2}) = -\\frac{1}{2}\\log(2\\pi) - \\frac{1}{2}\\log(V_{M, j}) - \\frac{(y_{ij} - f_{j})^{2}}{2V_{M, j}}\n$$\n我们针对真实分布计算此量的期望：\n$$\nQ_j(\\omega, \\sigma^{2}) = E_{\\text{true}}[\\log L(y_{ij}; \\omega, \\sigma^{2})] = -\\frac{1}{2}\\log(2\\pi) - \\frac{1}{2}\\log(V_{M, j}) - \\frac{E_{\\text{true}}[(y_{ij} - f_{j})^{2}]}{2V_{M, j}}\n$$\n我们知道 $E_{\\text{true}}[(y_{ij} - f_{j})^{2}] = \\text{Var}_{\\text{true}}(y_{ij}) = V_{\\text{true}, j}$。\n$$\nQ_j(\\omega, \\sigma^{2}) = -\\frac{1}{2}\\log(2\\pi) - \\frac{1}{2}\\log(V_{M, j}) - \\frac{V_{\\text{true}, j}}{2V_{M, j}}\n$$\n我们希望最大化在两个设计点 $j \\in \\{1, 2\\}$ 上的总期望对数似然。假设每个设计点的受试者数量相等，忽略常数项，待最大化的目标函数为：\n$$\nQ(\\omega, \\sigma^{2}) = Q_1 + Q_2 = -\\frac{1}{2} \\sum_{j=1}^{2} \\left[ \\log(V_{M, j}) + \\frac{V_{\\text{true}, j}}{V_{M, j}} \\right]\n$$\n为了找到最大值，我们将关于 $\\omega$ 和 $\\sigma^2$ 的偏导数设为零。\n$$\n\\frac{\\partial Q}{\\partial \\omega} = -\\frac{1}{2} \\sum_{j=1}^{2} \\left[ \\frac{1}{V_{M, j}}\\frac{\\partial V_{M, j}}{\\partial \\omega} - \\frac{V_{\\text{true}, j}}{V_{M, j}^{2}}\\frac{\\partial V_{M, j}}{\\partial \\omega} \\right] = 0\n$$\n由于 $\\frac{\\partial V_{M, j}}{\\partial \\omega} = f_{j}^{2}$，上式变为：\n$$\n\\sum_{j=1}^{2} f_{j}^{2} \\left( \\frac{1}{V_{M, j}} - \\frac{V_{\\text{true}, j}}{V_{M, j}^{2}} \\right) = \\sum_{j=1}^{2} f_{j}^{2} \\frac{V_{M, j} - V_{\\text{true}, j}}{V_{M, j}^{2}} = 0\n$$\n类似地，对于关于 $\\sigma^2$ 的偏导数：\n$$\n\\frac{\\partial Q}{\\partial \\sigma^2} = -\\frac{1}{2} \\sum_{j=1}^{2} \\left[ \\frac{1}{V_{M, j}}\\frac{\\partial V_{M, j}}{\\partial \\sigma^2} - \\frac{V_{\\text{true}, j}}{V_{M, j}^{2}}\\frac{\\partial V_{M, j}}{\\partial \\sigma^2} \\right] = 0\n$$\n由于 $\\frac{\\partial V_{M, j}}{\\partial \\sigma^2} = 1$，上式变为：\n$$\n\\sum_{j=1}^{2} \\left( \\frac{1}{V_{M, j}} - \\frac{V_{\\text{true}, j}}{V_{M, j}^{2}} \\right) = \\sum_{j=1}^{2} \\frac{V_{M, j} - V_{\\text{true}, j}}{V_{M, j}^{2}} = 0\n$$\n让我们定义 $X_j = \\frac{V_{M, j} - V_{\\text{true}, j}}{V_{M, j}^{2}}$。最优参数 $(\\omega^{\\star}, \\sigma^{2\\star})$ 的方程组是：\n1. $f_{1}^{2}X_1 + f_{2}^{2}X_2 = 0$\n2. $X_1 + X_2 = 0$\n\n从方程(2)我们得到 $X_2 = -X_1$。将其代入方程(1)：\n$f_{1}^{2}X_1 - f_{2}^{2}X_1 = 0 \\implies (f_{1}^{2} - f_{2}^{2})X_1 = 0$。\n已知 $f_1 = 8$ 且 $f_2 = 20$，因此 $f_1^2 \\neq f_2^2$，所以 $f_1^2 - f_2^2 \\neq 0$。这迫使 $X_1 = 0$，从而 $X_2 = 0$。\n\n条件 $X_j = 0$ 意味着 $V_{M, j} - V_{\\text{true}, j} = 0$，即对于 $j=1$ 和 $j=2$，$V_{M, j} = V_{\\text{true}, j}$。这意味着伪真参数是通过在每个设计点上令两个模型的方差表达式相等来找到的：\n$$\nf_{1}^{2}\\omega^{\\star} + \\sigma^{2\\star} = f_{1}^{2}(\\omega_{\\text{true}} + \\sigma_{p}^{2})\n$$\n$$\nf_{2}^{2}\\omega^{\\star} + \\sigma^{2\\star} = f_{2}^{2}(\\omega_{\\text{true}} + \\sigma_{p}^{2})\n$$\n这是一个关于 $\\omega^{\\star}$ 和 $\\sigma^{2\\star}$ 的二元线性方程组。用第二个方程减去第一个方程得到：\n$$\n(f_{2}^{2} - f_{1}^{2})\\omega^{\\star} = (f_{2}^{2} - f_{1}^{2})(\\omega_{\\text{true}} + \\sigma_{p}^{2})\n$$\n由于 $f_2^2 - f_1^2 \\neq 0$，我们可以除以这一项来求得 $\\omega^{\\star}$：\n$$\n\\omega^{\\star} = \\omega_{\\text{true}} + \\sigma_{p}^{2}\n$$\n这个结果提供了高估 IIV 方差的条件。如果 $\\sigma_{p}^{2} > 0$，估计的 IIV $\\omega^\\star$ 将大于真实的 IIV $\\omega_{\\text{true}}$。由于 $\\sigma_{p}^{2}$ 是一个方差，它总是非负的。因此，当加性残差模型被设定错误时，真实数据生成过程中的任何非零比例残差（$\\sigma_p^2 > 0$）都将导致对 IIV 方差的高估。比例误差的方差被混淆进了 IIV 参数中。\n\n我们也可以通过将 $\\omega^{\\star}$ 的表达式代回第一个方程来求解 $\\sigma^{2\\star}$：\n$$\n\\sigma^{2\\star} = f_{1}^{2}(\\omega_{\\text{true}} + \\sigma_{p}^{2}) - f_{1}^{2}\\omega^{\\star} = f_{1}^{2}(\\omega_{\\text{true}} + \\sigma_{p}^{2}) - f_{1}^{2}(\\omega_{\\text{true}} + \\sigma_{p}^{2}) = 0\n$$\n设定错误的模型将所有方差归因于 IIV 部分，因为真实的方差结构随 $f_j^2$ 缩放，这与设定错误模型中的 IIV 项相匹配，而不是加性误差项。\n\n最后，我们使用给定的值 $\\omega_{\\text{true}} = 0.05$ 和 $\\sigma_{p}^{2} = 0.07$ 来数值计算 $\\omega^{\\star}$：\n$$\n\\omega^{\\star} = 0.05 + 0.07 = 0.12\n$$\n问题要求答案四舍五入到四位有效数字。因此，$\\omega^{\\star} = 0.1200$。", "answer": "$$\\boxed{0.1200}$$", "id": "4592580"}, {"introduction": "虽然对数正态分布是个体间变异（IIV）建模中一个常用且方便的假设，但现实世界中的生物过程并非总是遵循此规律。本项高级练习将介绍Box-Cox变换，它是一种强大而灵活的工具，用于模拟非对称或非正态分布的随机效应。通过推导其实现所需的关键数学组成部分，您将学会如何构建更稳健的模型，以更好地捕捉群体参数真实的潜在分布。[@problem_id:4592488]", "problem": "一个临床药理学团队正在为一个具有一级消除特征的单室药物拟合群体药代动力学（PopPK）模型。个体间变异通过对每个个体 $i \\in \\{1,\\dots,n\\}$ 的分布容积 $V_{i}$（$V_{i} > 0$）设置随机效应来表示。探索性诊断显示，与 $V$ 随机效应相关的残差呈非对称的右偏态，这表明通常的对数正态假设可能无法充分捕捉变异的来源。\n\n为解决此问题，该团队考虑对由 $u_{i} = V_{i} / V_{\\text{pop}}$ 定义的无量纲正值随机效应尺度进行 Box–Cox 变换，其中 $V_{\\text{pop}}$ 是典型的群体容积值。他们将变换后的变量 $z_{i}$ 定义为\n$$\nz_{i} =\n\\begin{cases}\n\\dfrac{u_{i}^{\\lambda} - 1}{\\lambda}, & \\lambda \\neq 0, \\\\\n\\ln(u_{i}), & \\lambda = 0,\n\\end{cases}\n$$\n并计划假设 $z_{i}$ 服从高斯分布，以更好地反映随机效应中的对称性。\n\n使用概率密度的变量替换原理和独立随机效应的标准似然构建方法，完成以下任务：\n\n1. 当残差显示不对称时，从第一性原理出发，严格评估在此 PopPK 背景下对 $u_{i}$ 应用 Box–Cox 变换的适当性。您的评估应基于 $u_i$ 的正性、变换的单调性和可逆性，以及变换后尺度上的对称性如何与 $V$ 的变异来源相关联等性质。\n2. 当将 $z_i$ 上的高斯模型用原始参数 $V_i$ 重新表示时，推导对于一般的 $n$ 和一般的 $\\lambda$，必须乘入随机效应似然的精确雅可比行列式项。\n\n以 $V_{\\text{pop}}$、$\\lambda$ 和 $\\{V_{i}\\}_{i=1}^{n}$ 表示的单一闭式解析表达式的形式给出最终的雅可比行列式。无需进行数值计算，也不应进行舍入。以无单位形式表示最终答案。", "solution": "所提出的问题陈述是有效的。它在科学上基于药代动力学和统计建模的原理，问题提法得当，目标明确，信息充分，并使用了客观、明确的语言。这些任务是将统计理论应用于药理计量模型的标准练习。我们将继续进行解答。\n\n问题要求分为两部分：严格评估在此背景下 Box-Cox 变换的适当性，以及推导与变量替换相关的雅可比行列式。\n\n### 第 1 部分：Box-Cox 变换的严格评估\n\n基于多种原因，使用 Box-Cox 变换是解决随机效应模型残差不对称性的一种在统计上合理且适当的方法。我们将从第一性原理出发进行评估。\n\n1.  **变换的定义域**：个体 $i$ 的分布容积 $V_i$ 必须是正量，即 $V_i > 0$。典型的群体值 $V_{\\text{pop}}$ 也是一个正的容积。因此，无量纲的随机效应尺度变量 $u_i = V_i / V_{\\text{pop}}$ 是严格为正的，即 $u_i > 0$。Box-Cox 变换是为正变量定义的，因此这个基本先决条件得到了满足。\n\n2.  **单调性和可逆性**：要使一个变换成为有效的重新参数化，它必须是一一映射，这意味着它必须是严格单调的。这确保了对于变换后变量 $z_i$ 的每一个值，都有一个唯一对应的原始变量 $u_i$ 的值，反之亦然。我们可以通过检查变换的导数 $\\frac{dz_i}{du_i}$ 来检验其单调性。\n\n    该变换由下式给出：\n    $$\n    z_i(u_i) =\n    \\begin{cases}\n    \\dfrac{u_i^{\\lambda} - 1}{\\lambda}, & \\lambda \\neq 0, \\\\\n    \\ln(u_i), & \\lambda = 0.\n    \\end{cases}\n    $$\n    对于 $\\lambda \\neq 0$ 的情况，其导数为：\n    $$\n    \\frac{dz_i}{du_i} = \\frac{d}{du_i} \\left( \\frac{u_i^{\\lambda} - 1}{\\lambda} \\right) = \\frac{1}{\\lambda} \\left( \\lambda u_i^{\\lambda-1} \\right) = u_i^{\\lambda-1}.\n    $$\n    由于 $u_i > 0$，无论 $\\lambda$ 的值如何，$u_i^{\\lambda-1}$ 始终为正。\n\n    对于 $\\lambda = 0$ 的情况，其导数为：\n    $$\n    \\frac{dz_i}{du_i} = \\frac{d}{du_i} \\ln(u_i) = \\frac{1}{u_i}.\n    $$\n    同样，由于 $u_i > 0$，导数 $\\frac{1}{u_i}$ 始终为正。\n\n    在两种情况下，导数 $\\frac{dz_i}{du_i}$ 在其定义域内的所有 $u_i$ 上都为正。这证明了对于任何 $\\lambda$ 值，Box-Cox 变换都是严格单调递增的。这种可逆性对于将概率密度正确地变换回原始参数空间至关重要。\n\n3.  **不对称性（偏度）的校正**：问题陈述指出，与 $V$ 的随机效应相关的残差是右偏的。这意味着 $u_i$ 的分布也是右偏的。Box-Cox 变换的主要目的是找到一个参数 $\\lambda$，将非正态分布的数据转换为一组更接近服从正态分布的数据。这个过程的一个关键特征是减小偏度。\n    - 如果 $\\lambda = 1$，变换变为 $z_i = u_i - 1$，这是一个简单的线性平移，不会改变分布的偏度。\n    - 如果 $\\lambda < 1$，变换是凹的，它会相对于左尾压缩 $u_i$ 分布的右尾。这正是校正右偏度所需的操作。常见的例子是平方根变换（$\\lambda = 0.5$）和对数变换（$\\lambda = 0$）。\n    - 如果 $\\lambda > 1$，变换是凸的，会加剧右偏度。\n\n    观察到的残差呈右偏态这一事实表明，使用此变换拟合的模型很可能会得出一个估计值 $\\lambda < 1$。药代动力学参数的标准对数正态假设（$V_i = V_{\\text{pop}} \\exp(\\eta_i)$，其中 $\\eta_i \\sim \\mathcal{N}(0, \\omega^2)$）是 Box-Cox 变换在 $\\lambda = 0$ 时的特例。通过允许 $\\lambda$ 成为一个从数据中估计的参数，Box-Cox 方法提供了一个比僵化的对数正态假设更灵活的框架，可能能够更好地表征个体间变异，并在变换后的尺度上得到更对称的残差。\n\n总之，Box-Cox 变换在此 PopPK 背景下非常合适。它定义在正确的正值域上，是可逆的，并且专门设计用于校正数据中观察到的那种不对称性，从而提供了标准对数正态模型的一种数据驱动的推广。\n\n### 第 2 部分：雅可比行列式的推导\n\n随机效应的似然是基于变换后的变量 $\\{z_i\\}_{i=1}^n$ 独立同分布于高斯（正态）分布的假设构建的。设单个 $z_i$ 的概率密度函数（PDF）为 $p_Z(z_i)$。由于独立性，联合概率密度函数为 $p_{\\mathbf{Z}}(z_1, \\dots, z_n) = \\prod_{i=1}^n p_Z(z_i)$。\n\n为了用原始参数 $\\{V_i\\}_{i=1}^n$ 表示此似然，我们必须使用概率密度的变量替换定理。$\\mathbf{V} = (V_1, \\dots, V_n)$ 的概率密度函数由下式给出：\n$$\np_{\\mathbf{V}}(V_1, \\dots, V_n) = p_{\\mathbf{Z}}(z_1(V_1), \\dots, z_n(V_n)) \\cdot \\left| J \\right|\n$$\n其中 $J$ 是从 $\\mathbf{V}$到 $\\mathbf{Z}$ 变换的雅可比行列式：\n$$\nJ = \\det\\left(\\frac{\\partial(z_1, \\dots, z_n)}{\\partial(V_1, \\dots, V_n)}\\right).\n$$\n必须乘入似然的项是 $|J|$。\n\n对于每个个体 $i$ 的变换是 $V_i \\to u_i \\to z_i$，其中 $u_i = V_i / V_{\\text{pop}}$ 且 $z_i$ 由 Box-Cox 变换定义。由于 $z_i$ 仅依赖于 $V_i$（这是随机效应独立性的一个结果），雅可比矩阵是一个对角矩阵：\n$$\n\\frac{\\partial(z_1, \\dots, z_n)}{\\partial(V_1, \\dots, V_n)} =\n\\begin{pmatrix}\n\\frac{dz_1}{dV_1} & 0 & \\cdots & 0 \\\\\n0 & \\frac{dz_2}{dV_2} & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\cdots & \\frac{dz_n}{dV_n}\n\\end{pmatrix}.\n$$\n对角矩阵的行列式是其对角元素的乘积：\n$$\nJ = \\prod_{i=1}^{n} \\frac{dz_i}{dV_i}.\n$$\n我们使用链式法则计算导数 $\\frac{dz_i}{dV_i}$：$\\frac{dz_i}{dV_i} = \\frac{dz_i}{du_i} \\cdot \\frac{du_i}{dV_i}$。\n\n首先，我们求 $\\frac{du_i}{dV_i}$：\n$$\nu_i = \\frac{V_i}{V_{\\text{pop}}} \\implies \\frac{du_i}{dV_i} = \\frac{1}{V_{\\text{pop}}}.\n$$\n其次，我们使用在第 1 部分中推导的导数 $\\frac{dz_i}{du_i}$。我们证明了对于 $\\lambda \\neq 0$ 时 $\\frac{dz_i}{du_i} = u_i^{\\lambda-1}$，对于 $\\lambda = 0$ 时 $\\frac{dz_i}{du_i} = \\frac{1}{u_i}$。注意到当 $\\lambda=0$ 时，$u_i^{\\lambda-1}$ 为 $u_i^{-1} = \\frac{1}{u_i}$。因此，表达式 $\\frac{dz_i}{du_i} = u_i^{\\lambda-1}$ 对于 Box-Cox 定义中所有相关的 $\\lambda$ 都是通用的。\n\n结合这些结果：\n$$\n\\frac{dz_i}{dV_i} = \\frac{dz_i}{du_i} \\cdot \\frac{du_i}{dV_i} = u_i^{\\lambda-1} \\cdot \\frac{1}{V_{\\text{pop}}}.\n$$\n代入 $u_i = V_i / V_{\\text{pop}}$：\n$$\n\\frac{dz_i}{dV_i} = \\left(\\frac{V_i}{V_{\\text{pop}}}\\right)^{\\lambda-1} \\cdot \\frac{1}{V_{\\text{pop}}} = \\frac{V_i^{\\lambda-1}}{V_{\\text{pop}}^{\\lambda-1}} \\cdot \\frac{1}{V_{\\text{pop}}} = \\frac{V_i^{\\lambda-1}}{V_{\\text{pop}}^{\\lambda}}.\n$$\n现在我们计算行列式 $J$：\n$$\nJ = \\prod_{i=1}^{n} \\frac{dz_i}{dV_i} = \\prod_{i=1}^{n} \\left( \\frac{V_i^{\\lambda-1}}{V_{\\text{pop}}^{\\lambda}} \\right).\n$$\n我们可以将涉及 $V_i$ 的项和常数 $V_{\\text{pop}}$ 分开：\n$$\nJ = \\left( \\prod_{i=1}^{n} V_i^{\\lambda-1} \\right) \\cdot \\left( \\prod_{i=1}^{n} \\frac{1}{V_{\\text{pop}}^{\\lambda}} \\right).\n$$\n第二项是 $n$ 个相同常数的乘积：\n$$\nJ = \\left( \\prod_{i=1}^{n} V_i^{\\lambda-1} \\right) \\cdot \\left( \\frac{1}{V_{\\text{pop}}^{\\lambda}} \\right)^n = \\left( \\prod_{i=1}^{n} V_i^{\\lambda-1} \\right) \\cdot V_{\\text{pop}}^{-n\\lambda}.\n$$\n这就给出了雅可比行列式的最终表达式：\n$$\nJ = V_{\\text{pop}}^{-n\\lambda} \\prod_{i=1}^{n} V_i^{\\lambda-1}.\n$$\n似然项需要取绝对值 $|J|$。由于对所有 $i$ 都有 $V_i > 0$ 和 $V_{\\text{pop}} > 0$，这些项的任何实数次幂都保持为正。因此，每一项 $\\frac{dz_i}{dV_i}$ 都是正的，它们的乘积 $J$ 也是正的，所以 $|J| = J$。\n\n因此，雅可比行列式的最终表达式是 $V_{\\text{pop}}^{-n\\lambda} \\prod_{i=1}^{n} V_i^{\\lambda-1}$。", "answer": "$$\n\\boxed{V_{\\text{pop}}^{-n\\lambda} \\prod_{i=1}^{n} V_i^{\\lambda-1}}\n$$", "id": "4592488"}]}