{"hands_on_practices": [{"introduction": "理解生物系统如何对药物产生初始响应，是药效学建模的基础。此练习 [@problem_id:4519797] 要求您运用周转模型的基本原理，推导在生产突然受抑制后生物标志物的瞬时变化率。这项分析技能对于解读早期临床数据和验证药物的拟议作用机制至关重要。", "problem": "考虑一个内源性生物标志物响应 $R(t)$，其受标准间接响应更新模型控制，其中生成（零级输入）速率为 $k_{in}$，消除（一级输出）速率常数为 $k_{out}$。该模型的基本基础是充分混合房室的质量平衡：$R(t)$ 的随时间变化率等于输入减去输出，因此 $dR/dt = k_{in} - k_{out} R(t)$。假设在 $t0$ 时系统处于稳态，基线响应为 $R(t)=R_{0}$，满足 $dR/dt=0$ 且不存在药物。在时间 $t=0$ 时，一项干预瞬时将生成速率降低至 $k_{in}(1-\\alpha)$，其中 $0  \\alpha  1$，并且不直接改变消除过程。\n\n仅使用质量平衡和稳态定义，计算扰动发生后瞬间的初始斜率 $dR/dt|_{t=0^{+}}$，并用 $\\alpha$、$k_{out}$ 和 $R_{0}$ 表示。然后，根据能产生此类响应的潜在机制（生成抑制与消除刺激），解释该初始斜率的符号。您的最终答案必须是关于 $dR/dt|_{t=0^{+}}$ 的、用 $\\alpha$、$k_{out}$ 和 $R_{0}$ 表示的单个闭式解析表达式；最终表达式中不应包含任何单位，且不要四舍五入。", "solution": "问题陈述经评估是有效的。它在科学上基于药效动力学建模的既定原则，特别是间接响应模型。该问题是适定的，提供了推导唯一解所需的所有必要信息。定义和约束清晰、一致，且不违反任何物理或数学原理。\n\n出发点是控制响应 $R(t)$ 的质量平衡微分方程：\n$$\n\\frac{dR}{dt} = k_{in} - k_{out} R(t)\n$$\n其中 $k_{in}$ 是零级生成速率，$k_{out}$ 是一级消除速率常数。\n\n对于时间 $t0$，系统处于干预前的稳态。根据定义，在稳态下，响应的变化率为零，即 $\\frac{dR}{dt}=0$。响应处于其基线水平 $R(t)=R_{0}$。将这些条件代入控制方程，得到：\n$$\n0 = k_{in} - k_{out} R_{0}\n$$\n这使我们能够用基线响应和消除速率常数来表示生成速率 $k_{in}$：\n$$\nk_{in} = k_{out} R_{0}\n$$\n这种关系是基础性的，因为它连接了基线条件下的模型参数。\n\n在时间 $t=0$ 时，发生了一项干预。问题陈述指出，生成速率瞬时降低至 $k_{in}(1-\\alpha)$，而以 $k_{out}$ 为特征的消除过程保持不变。因此，对于所有时间 $t \\ge 0$，控制微分方程变为：\n$$\n\\frac{dR}{dt} = k_{in}(1-\\alpha) - k_{out} R(t)\n$$\n我们被要求计算初始斜率，即扰动发生后瞬间（记为 $t=0^{+}$）的导数 $\\frac{dR}{dt}$ 的值。为此，我们在 $t=0^{+}$ 处计算新微分方程的值：\n$$\n\\left. \\frac{dR}{dt} \\right|_{t=0^{+}} = k_{in}(1-\\alpha) - k_{out} R(0^{+})\n$$\n响应 $R(t)$ 代表一个物理或生物量，例如生物标志物的浓度。在充分混合房室模型中，此类量不能瞬时改变。因此，响应的值在扰动点 $t=0$ 处必须是连续的。这意味着扰动发生后瞬间的 $R(t)$ 值与其发生前瞬间的值相同：\n$$\nR(0^{+}) = R(0^{-}) = R_{0}\n$$\n将 $R(0^{+}) = R_{0}$ 代入初始斜率的表达式，得到：\n$$\n\\left. \\frac{dR}{dt} \\right|_{t=0^{+}} = k_{in}(1-\\alpha) - k_{out} R_{0}\n$$\n问题要求最终答案用 $\\alpha$、$k_{out}$ 和 $R_{0}$ 表示。为实现这一点，我们必须从表达式中消除 $k_{in}$。我们使用从稳态条件推导出的关系 $k_{in} = k_{out} R_{0}$：\n$$\n\\left. \\frac{dR}{dt} \\right|_{t=0^{+}} = (k_{out} R_{0})(1-\\alpha) - k_{out} R_{0}\n$$\n现在，我们简化这个代数表达式：\n$$\n\\left. \\frac{dR}{dt} \\right|_{t=0^{+}} = k_{out} R_{0} - \\alpha k_{out} R_{0} - k_{out} R_{0}\n$$\n项 $k_{out} R_{0}$ 被消掉，剩下：\n$$\n\\left. \\frac{dR}{dt} \\right|_{t=0^{+}} = -\\alpha k_{out} R_{0}\n$$\n这就是初始斜率的最终解析表达式。\n\n为了进行解释，我们分析该斜率的符号。问题陈述 $0  \\alpha  1$。消除速率常数 $k_{out}$ 必须为正（$k_{out} > 0$），因为它表征一个移除过程。基线响应 $R_{0}$ 代表内源性物质的浓度或数量，要存在更新过程，它必须为正（$R_{0} > 0$）。因此，乘积 $\\alpha k_{out} R_{0}$ 是正的。所以，整个斜率表达式 $-\\alpha k_{out} R_{0}$ 必然是负的。\n\n一个负的初始斜率，$\\frac{dR}{dt}|_{t=0^{+}}  0$，意味着响应 $R(t)$ 在药物效应开始后立即开始下降。这与规定的生成抑制机制完全一致。在稳态时，生成（$k_{in}$）和消除（$k_{out} R_{0}$）是平衡的。干预将生成速率降低到 $k_{in}(1-\\alpha)$，而那一瞬间的消除速率仍为 $k_{out} R_{0} = k_{in}$。由于 $\\alpha > 0$，新的生成速率严格小于消除速率。这种不平衡（$rate_{in}  rate_{out}$）导致响应变量的总量净减少，因此斜率为负。", "answer": "$$\n\\boxed{-\\alpha k_{out} R_{0}}\n$$", "id": "4519797"}, {"introduction": "模型拟合中的一个常见陷阱是参数共线性，即有限的数据无法区分不同的参数值组合，当实验局限于药物剂量-效应曲线的低浓度线性范围时尤其如此。本练习 [@problem_id:4519783] 以最大抑制参数 $I_{\\max}$ 和半数抑制浓度 $IC_{50}$ 为例阐释了此问题，并要求您设计能有效分离这些混淆参数的信息化实验方案。掌握这项技能对于设计能够可靠表征药物药效学特征的临床研究至关重要。", "problem": "一种小分子药物在经典的间接响应模型（结构上等同于模型I，即药物抑制输入）中抑制了循环生物标志物的零级生成速率。该生物标志物的转换由一个生成速率常数 $k_{\\mathrm{in}}$ 和一个一级消除速率常数 $k_{\\mathrm{out}}$ 描述，因此在基线时 $R_{0} = k_{\\mathrm{in}}/k_{\\mathrm{out}}$。药物效应由浓度 $C$ 的一个可饱和、单调的抑制函数 $I(C)$ 介导，该函数有两个未知的药效学参数：满足 $0  I_{\\max}  1$ 的最大抑制率 $I_{\\max}$，以及一个效价参数 $IC_{50}$（单位为浓度），其定义为当 $C = IC_{50}$ 时产生半数最大抑制。在一项使用恒定给药方案的预试验中，平均浓度范围为 $C \\in [0.05,\\,0.5]\\ \\mathrm{mg\\cdot L^{-1}}$。外部的体外数据表明，$IC_{50}$ 约为 $5\\ \\mathrm{mg\\cdot L^{-1}}$，$k_{\\mathrm{out}}$ 约为 $0.1\\ \\mathrm{h^{-1}}$。\n\n仅使用基本的质量作用定律思想和上述定义，推导在预试验的浓度范围内，能否从稳态生物标志物测量值中单独辨识出 $I_{\\max}$ 和 $IC_{50}$，并解释原因。然后，你需要计划一项后续研究，以消除 $I_{\\max}$ 和 $IC_{50}$ 之间的相关性。\n\n选择所有在预试验基础上增加后，能通过可行且科学合理的临床采样可靠地消除 $I_{\\max}$ 和 $IC_{50}$ 之间相关性的设计选项。\n\nA. 每名受试者进行两周期交叉设计：一个周期中，采用静脉给药方案，使平均浓度近似恒定在 $C \\approx 0.1\\times IC_{50}$；另一周期中，使 $C \\approx 10\\times IC_{50}$。在两个周期中，均在数个 $k_{\\mathrm{out}}^{-1}$ 的时间跨度内密集采集浓度和生物标志物数据，以表征达到稳态和药物清除的过程。\n\nB. 在相同的低剂量下增加预试验的样本量以减小标准误，同时保持浓度范围 $C \\in [0.05,\\,0.5]\\ \\mathrm{mg\\cdot L^{-1}}$ 和同样的稀疏稳态采样。\n\nC. 增加一个高剂量组，使其在稳态时达到 $C \\gg IC_{50}$，并采集足够的稳态生物标志物和浓度样本，以量化相对于基线的平台期效应降低程度。\n\nD. 在受试者内实施跨越 $C \\in [0.05,\\,0.5]\\ \\mathrm{mg\\cdot L^{-1}}$ 范围的剂量滴定，并进行非常频繁的生物标志物采样，但浓度不超过此范围。\n\nE. 在一部分受试者中，给予单次静脉推注，设计使浓度 $C(t)$ 从高于 $IC_{50}$ 开始，经过 $IC_{50}$，衰减至 $C \\ll IC_{50}$，并在数个 $k_{\\mathrm{out}}^{-1}$ 的时间窗内联合采集浓度和生物标志物样本，以在同一个体中追踪整个浓度范围内的动态响应。", "solution": "经严格审阅，该问题陈述是有效的。它基于临床药理学和药效学的既定原则，具有科学依据，在数学上是适定的，且没有歧义或矛盾。因此，我们可以进行正式的推导和分析。\n\n问题的核心在于，在给定来自特定、有限实验条件范围的数据情况下，非线性药效学模型中的参数可辨识性概念。\n\n**第一部分：预试验中参数可辨识性分析**\n\n药物浓度 $C$ 与生物标志物响应 $R$ 之间的动态关系由间接响应模型（模型 I）给出，其中药物抑制生物标志物的零级生成：\n$$ \\frac{dR(t)}{dt} = k_{\\mathrm{in}} \\cdot (1 - I(C(t))) - k_{\\mathrm{out}} \\cdot R(t) $$\n此处，$k_{\\mathrm{in}}$ 是零级生成速率常数，$k_{\\mathrm{out}}$ 是生物标志物的一级消除速率常数，$I(C)$ 是药物浓度 $C$ 的抑制函数。\n\n在基线（给药前），$C=0$，因此 $I(0)=0$。在稳态时，$\\frac{dR}{dt}=0$，得到基线生物标志物水平 $R_0$：\n$$ 0 = k_{\\mathrm{in}} - k_{\\mathrm{out}} \\cdot R_0 \\implies R_0 = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} $$\n在恒定药物浓度 $C_{ss}$（如预试验中）存在下，系统达到一个新的稳态 $R_{ss}$，此时 $\\frac{dR}{dt}=0$：\n$$ 0 = k_{\\mathrm{in}} \\cdot (1 - I(C_{ss})) - k_{\\mathrm{out}} \\cdot R_{ss} $$\n解出 $R_{ss}$ 并代入 $k_{\\mathrm{in}} = R_0 \\cdot k_{\\mathrm{out}}$：\n$$ R_{ss} = \\frac{k_{\\mathrm{in}}}{k_{\\mathrm{out}}} \\cdot (1 - I(C_{ss})) = R_0 \\cdot (1 - I(C_{ss})) $$\n问题将 $I(C)$ 描述为一个标准的可饱和抑制函数。满足给定性质的最常见形式是 Michaelis-Menten 或 Emax 型模型（假设希尔系数为 $1$）：\n$$ I(C) = \\frac{I_{\\max} \\cdot C}{IC_{50} + C} $$\n其中 $I_{\\max}$ 是最大分数抑制率（$0  I_{\\max}  1$），$IC_{50}$ 是产生半数最大效应时的浓度。\n\n预试验在浓度范围 $C \\in [0.05,\\,0.5]\\ \\mathrm{mg\\cdot L^{-1}}$ 内进行。外部数据表明 $IC_{50}$ 约为 $5\\ \\mathrm{mg\\cdot L^{-1}}$。这意味着在预试验中达到的所有浓度 $C$ 都满足条件 $C \\ll IC_{50}$。使用的最高浓度（$0.5\\ \\mathrm{mg\\cdot L^{-1}}$）仅为预期 $IC_{50}$ 的 $10\\%$。\n\n在 $C \\ll IC_{50}$ 的条件下，$I(C)$ 函数的分母可以近似为：$IC_{50} + C \\approx IC_{50}$。这将抑制函数简化为一个线性关系：\n$$ I(C) \\approx \\frac{I_{\\max} \\cdot C}{IC_{50}} $$\n将此线性近似代入稳态响应方程，得到：\n$$ R_{ss}(C_{ss}) \\approx R_0 \\left( 1 - \\left(\\frac{I_{\\max}}{IC_{50}}\\right) C_{ss} \\right) $$\n该方程表明，对于预试验中使用的低浓度，稳态生物标志物响应 $R_{ss}$ 近似为稳态药物浓度 $C_{ss}$ 的线性函数。研究数据由数据对 $(C_{ss}, R_{ss})$ 组成，这些数据点将落在一条截距为 $R_0$、斜率为 $-R_0 \\cdot \\frac{I_{\\max}}{IC_{50}}$ 的直线上。从这些数据中，可以估计基线响应 $R_0$ 和代表抑制曲线初始斜率的复合参数，即比值 $\\frac{I_{\\max}}{IC_{50}}$。然而，无法从这个比值中分解出 $I_{\\max}$ 和 $IC_{50}$ 的单独值并唯一确定它们。无数对 $(I_{\\max}, IC_{50})$ 都能产生相同的比值。例如，$(I_{\\max}=0.8, IC_{50}=8)$ 和 $(I_{\\max}=0.4, IC_{50}=4)$ 产生的比值都是 $0.1$。\n\n因此，仅根据预试验的稳态数据，$I_{\\max}$ 和 $IC_{50}$ 这两个参数是不可单独辨识的。它们在低浓度区间内存在结构性混淆。为了消除它们的相关性，后续研究必须生成能够揭示 $I(C)$ 函数非线性的数据。这要求药物浓度与 $IC_{50}$ 相比不可忽略。\n\n**第二部分：对提议的后续研究设计的评估**\n\n目标是选择能够生成数据从而允许单独估计 $I_{\\max}$ 和 $IC_{50}$ 的研究设计。这需要观察系统在足够高的浓度下的响应，以揭示剂量-效应关系的曲率和/或平台期。\n\n**A. 每名受试者进行两周期交叉设计：一个周期中，采用静脉给药方案，使平均浓度近似恒定在 $C \\approx 0.1\\times IC_{50}$；另一周期中，使 $C \\approx 10\\times IC_{50}$。在两个周期中，均在数个 $k_{\\mathrm{out}}^{-1}$ 的时间跨度内密集采集浓度和生物标志物数据，以表征达到稳态和药物清除的过程。**\n该设计是稳健的。低剂量组（$C \\approx 0.1 \\times IC_{50}$）锚定了剂量-效应曲线的初始线性斜率，该斜率对比值 $I_{\\max}/IC_{50}$ 敏感。高剂量组（$C \\approx 10 \\times IC_{50}$）将系统推向接近其最大响应。在 $C = 10 \\times IC_{50}$ 时，$I(C) = \\frac{I_{\\max} \\cdot 10 \\cdot IC_{50}}{IC_{50} + 10 \\cdot IC_{50}} = \\frac{10}{11} I_{\\max} \\approx 0.91 \\cdot I_{\\max}$。这为估计 $I_{\\max}$ 提供了强有力的信号。结合来自线性和平台期区域的数据，$I_{\\max}$ 和 $IC_{50}$ 参数可以被消除相关性并单独估计。采集密集的动态数据进一步增强了所有模型参数（包括 $k_{\\mathrm{in}}$ 和 $k_{\\mathrm{out}}$）的可辨识性。\n**结论：正确。**\n\n**B. 在相同的低剂量下增加预试验的样本量以减小标准误，同时保持浓度范围 $C \\in [0.05,\\,0.5]\\ \\mathrm{mg\\cdot L^{-1}}$ 和同样的稀疏稳态采样。**\n该策略解决的是精度问题，而不是可辨识性问题。增加受试者数量将得到对复合参数（斜率 $\\frac{I_{\\max}}{IC_{50}}$）更精确的估计。然而，由于实验仍处于低浓度的线性区间，它没有提供任何新信息来打破 $I_{\\max}$ 和 $IC_{50}$ 之间的混淆。这个问题是实验设计中的结构性模糊问题，而不是随机误差问题，不能通过简单地收集更多相同的无信息量数据来解决。\n**结论：不正确。**\n\n**C. 增加一个高剂量组，使其在稳态时达到 $C \\gg IC_{50}$，并采集足够的稳态生物标志物和浓度样本，以量化相对于基线的平台期效应降低程度。**\n这是一个直接且有效的策略。当 $C \\gg IC_{50}$ 时，抑制函数 $I(C)$ 趋近其渐近线：$I(C) = \\frac{I_{\\max} \\cdot C}{IC_{50} + C} \\approx \\frac{I_{\\max} \\cdot C}{C} = I_{\\max}$。在该剂量下的稳态生物标志物水平将为 $R_{ss} \\approx R_0 (1-I_{\\max})$。通过测量 $R_0$（基线）和在此高浓度下的 $R_{ss}$，可以直接计算出 $I_{\\max}$。一旦 $I_{\\max}$ 已知，就可以利用从预试验数据中确定的比值 $\\frac{I_{\\max}}{IC_{50}}$ 来求解 $IC_{50}$。该设计有效地消除了参数间的相关性。\n**结论：正确。**\n\n**D. 在受试者内实施跨越 $C \\in [0.05,\\,0.5]\\ \\mathrm{mg\\cdot L^{-1}}$ 范围的剂量滴定，并进行非常频繁的生物标志物采样，但浓度不超过此范围。**\n与选项B类似，此设计局限于剂量-效应关系呈线性的低浓度范围。虽然剂量滴定和频繁采样是描绘剂量-效应关系的有效方法，但如果整个实验都在线性范围内进行，它将只能非常精确地定义一条直线，其斜率取决于比值 $\\frac{I_{\\max}}{IC_{50}}$。它不能提供分离这些参数所需的关于曲线非线性的信息。\n**结论：不正确。**\n\n**E. 在一部分受试者中，给予单次静脉推注，设计使浓度 $C(t)$ 从高于 $IC_{50}$ 开始，经过 $IC_{50}$，衰减至 $C \\ll IC_{50}$，并在数个 $k_{\\mathrm{out}}^{-1}$ 的时间窗内联合采集浓度和生物标志物样本，以在同一个体中追踪整个浓度范围内的动态响应。**\n这是一个信息量非常高的设计。单次静脉推注会产生一个连续变化的浓度曲线 $C(t)$，它可以扫过整个相关范围：从提供 $I_{\\max}$ 信息的高浓度（$C > IC_{50}$），经过提供曲率和 $IC_{50}$ 本身信息的中等浓度（$C \\approx IC_{50}$），直到提供比值 $\\frac{I_{\\max}}{IC_{50}}$ 信息的低浓度（$C \\ll IC_{50}$）。联合建模浓度的时间过程 $C(t)$ 和生物标志物的动态响应 $R(t)$，为估计包括 $I_{\\max}$ 和 $IC_{50}$ 在内的所有参数提供了丰富的信息，并能在每个受试者的单次实验中有效地打破它们的相关性。\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "4519783"}, {"introduction": "灵敏度分析是一种强大的计算方法，用于确定哪些模型参数对系统输出的影响最大。这些知识对于指导参数估计、简化模型和设计更高效的实验至关重要。在此练习 [@problem_id:4519754] 中，您将推导并实现一个间接响应模型的灵敏度方程。通过分析灵敏度随时间的变化，您将更深入地洞察模型的动态特性，并学会在响应的不同阶段识别最关键的待测参数。", "problem": "您的任务是推导并计算一个生理介质的间接响应药效动力学模型中的局部参数敏感性。设响应由 $R(t)$ 表示，单位为任意响应单位。该介质以零级速率产生，并以一级速率被清除。一种药物根据最大抑制效应 (Imax) 模型抑制其产生过程。该控制系统由以下基本速率定律构建：\n\n1. 零级产生和一级消除意味着没有药物时的基线动力学为 $$\\frac{dR}{dt} = k_{in} - k_{out} \\, R,$$ 其中 $k_{in}$ 是零级产生速率，单位为 $R$ 单位/小时，$k_{out}$ 是一级清除速率，单位为 1/小时。\n2. 在药物抑制产生的情况下，产生项被 $$1 - I(C(t))$$ 调节，其中抑制作用由最大抑制效应 (Imax) 模型描述：$$I(C(t)) = \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)},$$ 其中 $I_{max}$ 是最大分数抑制（无单位），$IC_{50}$ 是半最大抑制浓度，单位为毫克/升。\n3. 药物浓度遵循一个在时间 $t=0$ 时进行静脉推注的单室消除模型，$$C(t) = C_0 \\, e^{-k_{el} t},$$ 其中 $C_0$ 是初始浓度，单位为毫克/升，$k_{el}$ 是消除速率常数，单位为 1/小时。\n\n综合以上各项，响应动力学为\n$$\\frac{dR}{dt} = k_{in}\\left(1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)}\\right) - k_{out} \\, R(t)。$$\n假设在 $t=0$ 时的初始条件由给药前的稳态给出：$R(0) = \\frac{k_{in}}{k_{out}}$。\n\n定义响应对于参数 $\\theta$ 的局部敏感性为 $$S_{\\theta}(t) = \\frac{\\partial R(t)}{\\partial \\theta},$$ 其中 $\\theta \\in \\{k_{in}, k_{out}, I_{max}, IC_{50}\\}$。\n\n您的任务是：\n- 从上述基本速率定律和定义出发，使用链式法则和响应微分方程的右侧项 $f(R,t)$，推导出 $S_{k_{in}}(t)$、$S_{k_{out}}(t)$、$S_{I_{max}}(t)$ 和 $S_{IC_{50}}(t)$ 的前向敏感性微分方程。\n- 实现一个数值求解器，用于从 $t=0$ 到指定的较晚时间积分 $R(t)$ 和敏感性方程，并在一个较早时间 $t_{early}$ 和一个较晚时间 $t_{late}$ 评估敏感性。\n- 对于测试套件中的每个指定参数集，计算在 $t_{early}$ 和 $t_{late}$ 时的局部敏感性集合 $\\left\\{S_{k_{in}}(t), S_{k_{out}}(t), S_{I_{max}}(t), S_{IC_{50}}(t)\\right\\}$，并确定在 $t_{early}$ 和 $t_{late}$ 时哪个参数具有最大的绝对局部敏感性。\n\n物理单位和数值规范：\n- 时间必须以小时表示。\n- 浓度必须以毫克/升表示。\n- 响应必须以任意响应单位表示。\n- 程序必须以整数形式输出分析结果，这些整数按顺序 $\\left[k_{in}, k_{out}, I_{max}, IC_{50}\\right] \\equiv [0,1,2,3]$ 对参数进行索引。对于每个测试用例，返回一个对 $\\left[i_{early}, i_{late}\\right]$，其中 $i_{early}$ 是在 $t_{early}$ 时具有最大绝对局部敏感性的参数索引，$i_{late}$ 是在 $t_{late}$ 时对应的索引。\n\n测试套件：\n使用以下五个参数集，所有参数集的 $t_{early} = 1$ 小时，$t_{late} = 24$ 小时。每个用例均以 $\\left(k_{in}, k_{out}, I_{max}, IC_{50}, C_0, k_{el}\\right)$ 的形式给出，单位和约束如上所述。\n- 用例 $1$ (一般情况): $\\left(100, 0.5, 0.9, 2, 5, 0.3\\right)$。\n- 用例 $2$ (低初始浓度): $\\left(100, 0.5, 0.9, 2, 0.5, 0.3\\right)$。\n- 用例 $3$ (快速周转且基线匹配): $\\left(400, 2.0, 0.9, 2, 5, 0.3\\right)$。\n- 用例 $4$ (弱抑制): $\\left(100, 0.5, 0.2, 2, 5, 0.3\\right)$。\n- 用例 $5$ (高效价): $\\left(100, 0.5, 0.9, 0.2, 5, 0.3\\right)$。\n\n答案规范：\n- 对于每个测试用例，计算如上定义的索引 $\\left[i_{early}, i_{late}\\right]$，其中 $i_{early}$ 和 $i_{late}$ 是 $\\{0,1,2,3\\}$ 中的整数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个包含两个整数的列表。例如：$\\left[\\left[i_{early,1},i_{late,1}\\right],\\left[i_{early,2},i_{late,2}\\right],\\ldots,\\left[i_{early,5},i_{late,5}\\right]\\right]$。\n\n不允许用户输入；所有常量必须从上面的测试套件中硬编码，程序必须自主运行。", "solution": "该问题要求推导并数值求解一个间接响应药效动力学模型的局部参数敏感性方程。此过程涉及两个主要阶段：首先，敏感性方程的解析推导；其次，实现一个数值求解器，为一组给定的参数测试用例计算敏感性。\n\n设生理响应的状态为 $R(t)$。其动力学由以下微分方程控制：\n$$ \\frac{dR}{dt} = k_{in}\\left(1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)}\\right) - k_{out} \\, R(t) $$\n该方程可以写成 $\\frac{dR}{dt} = f(R, t, \\boldsymbol{\\theta})$，其中 $\\boldsymbol{\\theta}$ 是参数向量 $\\boldsymbol{\\theta} = [k_{in}, k_{out}, I_{max}, IC_{50}]$。药物浓度 $C(t)$ 是时间的显式函数：\n$$ C(t) = C_0 \\, e^{-k_{el} t} $$\n初始条件是给药前的稳态，$R(0) = R_0 = \\frac{k_{in}}{k_{out}}$。\n\n响应 $R(t)$ 对参数 $\\theta_j$ 的局部敏感性定义为 $S_{\\theta_j}(t) = \\frac{\\partial R(t)}{\\partial \\theta_j}$。控制该敏感性的微分方程，即前向敏感性方程，是通过对主常微分方程 (ODE) 对参数 $\\theta_j$ 求导得到的。应用链式法则，我们有：\n$$ \\frac{d S_{\\theta_j}}{dt} = \\frac{d}{dt}\\left(\\frac{\\partial R}{\\partial \\theta_j}\\right) = \\frac{\\partial}{\\partial \\theta_j}\\left(\\frac{dR}{dt}\\right) = \\frac{\\partial f(R, t, \\boldsymbol{\\theta})}{\\partial \\theta_j} $$\n$$ \\frac{\\partial f}{\\partial \\theta_j} = \\frac{\\partial f}{\\partial R} \\frac{\\partial R}{\\partial \\theta_j} + \\frac{\\partial f}{\\partial t} \\frac{\\partial t}{\\partial \\theta_j} + \\frac{\\partial f}{\\partial \\boldsymbol{\\theta}} \\frac{\\partial \\boldsymbol{\\theta}}{\\partial \\theta_j} $$\n由于 $t$ 和 $\\theta_j$ 是自变量，$\\frac{\\partial t}{\\partial \\theta_j}=0$。最后一项简化为 $f$ 对 $\\theta_j$ 的偏导数，同时保持其他变量不变。使用 $S_{\\theta_j}$ 的定义，我们得到敏感性方程的一般形式：\n$$ \\frac{d S_{\\theta_j}}{dt} = \\frac{\\partial f}{\\partial R} S_{\\theta_j} + \\frac{\\partial f}{\\partial \\theta_j} $$\n首先，我们计算 $f$ 对 $R$ 的偏导数，这对所有敏感性方程都是公共的：\n$$ \\frac{\\partial f}{\\partial R} = \\frac{\\partial}{\\partial R} \\left[ k_{in}\\left(1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)}\\right) - k_{out} \\, R(t) \\right] = -k_{out} $$\n因此，对于任何参数 $\\theta_j$ 的敏感性方程是：\n$$ \\frac{d S_{\\theta_j}}{dt} = -k_{out} S_{\\theta_j} + \\frac{\\partial f}{\\partial \\theta_j} $$\n我们现在为每个参数 $\\theta_j \\in \\{k_{in}, k_{out}, I_{max}, IC_{50}\\}$ 推导特定的强迫项 $\\frac{\\partial f}{\\partial \\theta_j}$。\n\n1.  **关于 $k_{in}$ 的敏感性**：\n    $$ \\frac{\\partial f}{\\partial k_{in}} = \\frac{\\partial}{\\partial k_{in}} \\left[ k_{in}\\left(1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)}\\right) - k_{out} R \\right] = 1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)} $$\n    敏感性 ODE 是：\n    $$ \\frac{d S_{k_{in}}}{dt} = -k_{out} S_{k_{in}} + 1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)} $$\n\n2.  **关于 $k_{out}$ 的敏感性**：\n    $$ \\frac{\\partial f}{\\partial k_{out}} = \\frac{\\partial}{\\partial k_{out}} \\left[ k_{in}\\left(\\dots\\right) - k_{out} R \\right] = -R $$\n    敏感性 ODE 是：\n    $$ \\frac{d S_{k_{out}}}{dt} = -k_{out} S_{k_{out}} - R(t) $$\n\n3.  **关于 $I_{max}$ 的敏感性**：\n    $$ \\frac{\\partial f}{\\partial I_{max}} = \\frac{\\partial}{\\partial I_{max}} \\left[ k_{in}\\left(1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)}\\right) - k_{out} R \\right] = -k_{in} \\frac{C(t)}{IC_{50} + C(t)} $$\n    敏感性 ODE 是：\n    $$ \\frac{d S_{I_{max}}}{dt} = -k_{out} S_{I_{max}} - k_{in} \\frac{C(t)}{IC_{50} + C(t)} $$\n\n4.  **关于 $IC_{50}$ 的敏感性**：\n    $$ \\frac{\\partial f}{\\partial IC_{50}} = \\frac{\\partial}{\\partial IC_{50}} \\left[ k_{in}\\left(1 - \\frac{I_{max} \\, C(t)}{IC_{50} + C(t)}\\right) - k_{out} R \\right] = -k_{in} I_{max} C(t) \\frac{\\partial}{\\partial IC_{50}} (IC_{50} + C(t))^{-1} $$\n    $$ \\frac{\\partial f}{\\partial IC_{50}} = -k_{in} I_{max} C(t) \\left( -1 \\cdot (IC_{50} + C(t))^{-2} \\cdot 1 \\right) = k_{in} \\frac{I_{max} \\, C(t)}{(IC_{50} + C(t))^2} $$\n    敏感性 ODE 是：\n    $$ \\frac{d S_{IC_{50}}}{dt} = -k_{out} S_{IC_{50}} + k_{in} \\frac{I_{max} \\, C(t)}{(IC_{50} + C(t))^2} $$\n\n敏感性的初始条件 $S_{\\theta_j}(0) = \\frac{\\partial R(0)}{\\partial \\theta_j}$ 是通过对初始响应 $R(0) = k_{in}/k_{out}$ 求导得出的：\n\n1.  $S_{k_{in}}(0) = \\frac{\\partial}{\\partial k_{in}} \\left(\\frac{k_{in}}{k_{out}}\\right) = \\frac{1}{k_{out}}$\n2.  $S_{k_{out}}(0) = \\frac{\\partial}{\\partial k_{out}} \\left(\\frac{k_{in}}{k_{out}}\\right) = -\\frac{k_{in}}{k_{out}^2}$\n3.  $S_{I_{max}}(0) = \\frac{\\partial}{\\partial I_{max}} \\left(\\frac{k_{in}}{k_{out}}\\right) = 0$\n4.  $S_{IC_{50}}(0) = \\frac{\\partial}{\\partial IC_{50}} \\left(\\frac{k_{in}}{k_{out}}\\right) = 0$\n\n为了求解敏感性，我们构成一个包含 5 个 ODE 的耦合系统。设状态向量为 $\\mathbf{y}(t) = [R(t), S_{k_{in}}(t), S_{k_{out}}(t), S_{I_{max}}(t), S_{IC_{50}}(t)]^T$。该系统从 $t=0$ 到 $t_{late}=24$ 小时进行数值积分。状态向量在 $t_{early}=1$ 小时和 $t_{late}=24$ 小时进行评估。对于每个评估时间，计算四个敏感性的绝对值 $\\{|S_{k_{in}}(t)|, |S_{k_{out}}(t)|, |S_{I_{max}}(t)|, |S_{IC_{50}}(t)|\\}$。确定对应于最大绝对敏感性的参数索引，其中参数索引为 $[k_{in}, k_{out}, I_{max}, IC_{50}] \\equiv [0,1,2,3]$。对所提供的 5 个测试用例中的每一个重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives, solves, and analyzes local parameter sensitivities for an indirect\n    response pharmacodynamic model.\n    \"\"\"\n\n    def system_ode(t, y, params):\n        \"\"\"\n        Defines the coupled system of ODEs for the response R(t) and its\n        four local parameter sensitivities.\n\n        Args:\n            t (float): Time.\n            y (list or np.ndarray): State vector [R, S_kin, S_kout, S_Imax, S_IC50].\n            params (tuple): Model parameters (k_in, k_out, I_max, IC_50, C_0, k_el).\n\n        Returns:\n            list: The derivatives of the state vector dy/dt.\n        \"\"\"\n        # Unpack parameters\n        k_in, k_out, I_max, IC_50, C_0, k_el = params\n        \n        # State variables\n        R, S_kin, S_kout, S_Imax, S_IC50 = y\n        \n        # Exogenous input: drug concentration C(t)\n        C_t = C_0 * np.exp(-k_el * t)\n        \n        # Common terms for efficiency\n        denom = IC_50 + C_t\n        inhibition_num = I_max * C_t\n        inhibition_factor = inhibition_num / denom\n\n        # ODE for the response R(t)\n        # dR/dt = k_in * (1 - I(C(t))) - k_out * R\n        dR_dt = k_in * (1 - inhibition_factor) - k_out * R\n        \n        # ODE for sensitivity to k_in\n        # dS_kin/dt = -k_out * S_kin + (1 - I(C(t)))\n        dS_kin_dt = -k_out * S_kin + (1 - inhibition_factor)\n        \n        # ODE for sensitivity to k_out\n        # dS_kout/dt = -k_out * S_kout - R\n        dS_kout_dt = -k_out * S_kout - R\n        \n        # ODE for sensitivity to I_max\n        # dS_Imax/dt = -k_out * S_Imax - k_in * C(t) / (IC_50 + C(t))\n        dS_Imax_dt = -k_out * S_Imax - k_in * C_t / denom\n\n        # ODE for sensitivity to IC_50\n        # dS_IC50/dt = -k_out * S_IC50 + k_in * I_max * C(t) / (IC_50 + C(t))^2\n        dS_IC50_dt = -k_out * S_IC50 + k_in * inhibition_num / (denom**2)\n        \n        return [dR_dt, dS_kin_dt, dS_kout_dt, dS_Imax_dt, dS_IC50_dt]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k_in, k_out, I_max, IC_50, C_0, k_el)\n        (100.0, 0.5, 0.9, 2.0, 5.0, 0.3),  # Case 1\n        (100.0, 0.5, 0.9, 2.0, 0.5, 0.3),  # Case 2\n        (400.0, 2.0, 0.9, 2.0, 5.0, 0.3),  # Case 3\n        (100.0, 0.5, 0.2, 2.0, 5.0, 0.3),  # Case 4\n        (100.0, 0.5, 0.9, 0.2, 5.0, 0.3),  # Case 5\n    ]\n    \n    t_early = 1.0\n    t_late = 24.0\n    t_span = (0.0, t_late)\n    t_eval = [t_early, t_late]\n    \n    all_results = []\n    for params in test_cases:\n        k_in, k_out, _, _, _, _ = params\n        \n        # Initial conditions for the ODE system\n        R0 = k_in / k_out\n        S_kin_0 = 1.0 / k_out\n        S_kout_0 = -k_in / (k_out**2)\n        S_Imax_0 = 0.0\n        S_IC50_0 = 0.0\n        y0 = [R0, S_kin_0, S_kout_0, S_Imax_0, S_IC50_0]\n        \n        # Numerically integrate the system of ODEs\n        sol = solve_ivp(\n            system_ode, \n            t_span, \n            y0, \n            args=(params,), \n            t_eval=t_eval, \n            method='Radau'  # A robust solver for potentially stiff problems\n        )\n        \n        # Extract sensitivities (state variables 1 through 4)\n        # sol.y has shape (num_states, num_t_eval_points) which is (5, 2)\n        sensitivities_early = sol.y[1:, 0]\n        sensitivities_late = sol.y[1:, 1]\n        \n        # Determine the index of the parameter with the largest absolute sensitivity\n        i_early = np.argmax(np.abs(sensitivities_early))\n        i_late = np.argmax(np.abs(sensitivities_late))\n        \n        all_results.append([int(i_early), int(i_late)])\n\n    # Format the final output string exactly as specified, without spaces.\n    inner_strings = [f\"[{res[0]},{res[1]}]\" for res in all_results]\n    print(f\"[[{all_results[0][0]},{all_results[0][1]}],[{all_results[1][0]},{all_results[1][1]}],[{all_results[2][0]},{all_results[2][1]}],[{all_results[3][0]},{all_results[3][1]}],[{all_results[4][0]},{all_results[4][1]}]]\")\n\nsolve()\n```", "id": "4519754"}]}