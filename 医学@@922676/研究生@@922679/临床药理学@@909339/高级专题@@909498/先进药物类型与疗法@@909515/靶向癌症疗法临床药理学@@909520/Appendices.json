{"hands_on_practices": [{"introduction": "要为靶向治疗药物设计合理的给药方案，我们必须首先理解其基本的动力学行为。本练习要求您从基本原理出发，推导并应用核心的药代动力学参数——半衰期、达到稳态的时间以及蓄积指数，为您预测药物在体内随时间变化的行为提供必要的工具。[@problem_id:4575193]", "problem": "一名患者被处方了一种口服酪氨酸激酶抑制剂（TKI；tyrosine kinase inhibitor），每日一次（QD；once daily）给药。其药代动力学可以通过一个线性单室模型很好地描述，该模型具有一级消除特性，且相对于消除过程，其吸收时间可以忽略不计。您应使用的基本药代动力学基础包括：(i) 单个充分混合房室中的质量平衡，其中浓度的变化率与浓度成正比；(ii) 清除率的定义，即关联消除速率与浓度的比例常数；以及 (iii) 分布容积的定义，即关联体内药量与浓度的比例常数。根据这些原理，推导以分布容积和清除率表示的消除半衰期的表达式，然后对一种分布容积 $V_{d}=200$ L、清除率 $CL=10$ L/h 的 TKI 进行计算。接下来，使用相同的基础，确定在重复给药下达到渐近稳态 $95\\%$ 所需的时间，操作上定义为达到稳态的分数（仅由消除速率常数决定）等于 $0.95$ 时的时间 $t$。最后，推导每日一次给药（给药间隔 $\\tau=24$ h）的蓄积指数，该指数定义为在线性动力学下，稳态浓度曲线与单次给药浓度曲线在相同给药后时间的比值，并根据给定参数进行数值计算。将所有数值答案四舍五入至四位有效数字。时间量以小时为单位，蓄积指数报告为无量纲量。按顺序提供您的三个数值结果：半衰期、达到 $95\\%$ 稳态的时间、蓄积指数。", "solution": "问题陈述经评估具有科学依据、提法明确且客观。它基于药代动力学的基本和标准原理。所有必要的参数和定义均已提供，不存在内部矛盾或不切实际的假设。该问题可以求解。\n\n解答按要求分为三个部分：消除半衰期（$t_{1/2}$）的推导与计算、达到 $95\\%$ 稳态所需的时间（$t_{95\\%SS}$）以及蓄积指数（$R_{ac}$）。\n\n**第一部分：消除半衰期 ($t_{1/2}$)**\n\n推导从所提供的基本原理开始。\n(i) 单个充分混合房室中药物的质量平衡表明，体内药物量 $A(t)$ 的变化率等于药物进入速率减去药物排出速率。对于吸收后阶段，进入速率为零，排出速率即为消除速率。\n(ii) 消除速率由清除率 $CL$ 与血浆浓度 $C(t)$ 的乘积给出。\n结合这些，体内药物量的微分方程为：\n$$\n\\frac{dA(t)}{dt} = - \\text{Rate of Elimination} = -CL \\cdot C(t)\n$$\n(iii) 分布容积 $V_d$ 将体内药物量与其浓度关联起来：\n$$\nA(t) = V_d \\cdot C(t)\n$$\n对该关系式关于时间 $t$ 求导，得到：\n$$\n\\frac{dA(t)}{dt} = V_d \\frac{dC(t)}{dt}\n$$\n将此式代入质量平衡方程，我们得到一个关于浓度的微分方程：\n$$\nV_d \\frac{dC(t)}{dt} = -CL \\cdot C(t)\n$$\n整理此方程表明，浓度的变化率与浓度成正比，正如原理 (i) 所述：\n$$\n\\frac{dC(t)}{dt} = -\\left(\\frac{CL}{V_d}\\right) C(t)\n$$\n此方程描述了一级消除。比例常数是一级消除速率常数 $k_e$：\n$$\nk_e = \\frac{CL}{V_d}\n$$\n微分方程为 $\\frac{dC(t)}{dt} = -k_e C(t)$。这是一个可分离微分方程。设 $C(0) = C_0$ 为时间 $t=0$ 时的初始浓度。\n$$\n\\int_{C_0}^{C(t)} \\frac{dC}{C} = \\int_{0}^{t} -k_e dt\n$$\n$$\n\\ln(C(t)) - \\ln(C_0) = -k_e t\n$$\n$$\n\\ln\\left(\\frac{C(t)}{C_0}\\right) = -k_e t\n$$\n$$\nC(t) = C_0 \\exp(-k_e t)\n$$\n消除半衰期 $t_{1/2}$ 是浓度降至其初始值一半所需的时间，即 $C(t_{1/2}) = \\frac{1}{2}C_0$。\n$$\n\\frac{1}{2}C_0 = C_0 \\exp(-k_e t_{1/2})\n$$\n$$\n\\frac{1}{2} = \\exp(-k_e t_{1/2})\n$$\n取等式两边的自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k_e t_{1/2}\n$$\n$$\n-\\ln(2) = -k_e t_{1/2}\n$$\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_e}\n$$\n将以 $V_d$ 和 $CL$ 表示的 $k_e$ 表达式代入：\n$$\nt_{1/2} = \\frac{\\ln(2)}{CL / V_d} = \\frac{V_d \\ln(2)}{CL}\n$$\n现在，我们使用给定的数值 $V_d = 200$ L 和 $CL = 10$ L/h 来计算该表达式。\n$$\nt_{1/2} = \\frac{200~\\text{L} \\cdot \\ln(2)}{10~\\text{L/h}} = 20 \\ln(2)~\\text{h} \\approx 13.8629~\\text{h}\n$$\n四舍五入至四位有效数字，$t_{1/2} = 13.86$ h。\n\n**第二部分：达到 $95\\%$ 稳态的时间 ($t_{95\\%SS}$)**\n\n在多次给药方案中，稳态的达成是一个由消除速率常数 $k_e$ 控制的渐近过程。问题将时间 $t$ 时达到稳态的分数定义为 $1 - \\exp(-k_e t)$。我们需要找到使该分数等于 $0.95$ 的时间 $t_{95\\%SS}$。\n$$\n1 - \\exp(-k_e t_{95\\%SS}) = 0.95\n$$\n求解 $t_{95\\%SS}$：\n$$\n\\exp(-k_e t_{95\\%SS}) = 1 - 0.95 = 0.05\n$$\n取等式两边的自然对数：\n$$\n-k_e t_{95\\%SS} = \\ln(0.05)\n$$\n$$\nt_{95\\%SS} = \\frac{-\\ln(0.05)}{k_e} = \\frac{\\ln\\left(\\frac{1}{0.05}\\right)}{k_e} = \\frac{\\ln(20)}{k_e}\n$$\n首先，我们计算 $k_e$：\n$$\nk_e = \\frac{CL}{V_d} = \\frac{10~\\text{L/h}}{200~\\text{L}} = 0.05~\\text{h}^{-1}\n$$\n现在我们可以计算 $t_{95\\%SS}$：\n$$\nt_{95\\%SS} = \\frac{\\ln(20)}{0.05~\\text{h}^{-1}} \\approx \\frac{2.995732}{0.05}~\\text{h} \\approx 59.9146~\\text{h}\n$$\n四舍五入至四位有效数字，$t_{95\\%SS} = 59.91$ h。这大约相当于 $4.32$ 个半衰期，是达到临床稳态的一个常用经验法则时间。\n\n**第三部分：蓄积指数 ($R_{ac}$)**\n\n蓄积指数 $R_{ac}$ 定义为稳态浓度曲线与单次给药浓度曲线的比值。对于线性系统，在给药间隔内（$0 \\le t  \\tau$），该比值对于所有时间 $t$ 都是恒定的。\n$$\nR_{ac} = \\frac{C_{SS}(t)}{C_1(t)}\n$$\n假设剂量 $D$ 以静脉推注（吸收时间可忽略）方式给药，单次给药后的浓度为：\n$$\nC_1(t) = C_0 \\exp(-k_e t) = \\frac{D}{V_d} \\exp(-k_e t)\n$$\n在每隔时间 $\\tau$ 重复给药达到稳态时，最近一次给药后时间 $t$ 的浓度是无限次先前给药所剩余药物的总和：\n$$\nC_{SS}(t) = \\frac{D}{V_d} \\exp(-k_e t) + \\frac{D}{V_d} \\exp(-k_e (t+\\tau)) + \\frac{D}{V_d} \\exp(-k_e (t+2\\tau)) + \\dots\n$$\n提取公因式：\n$$\nC_{SS}(t) = \\frac{D}{V_d} \\exp(-k_e t) \\left[ 1 + \\exp(-k_e \\tau) + \\exp(-2k_e \\tau) + \\dots \\right]\n$$\n方括号中的项是一个无穷几何级数 $\\sum_{n=0}^{\\infty} r^n$，其公比为 $r = \\exp(-k_e \\tau)$。由于 $k_e > 0$ 且 $\\tau > 0$，公比 $r$ 介于 $0$ 和 $1$ 之间，级数收敛于 $\\frac{1}{1-r}$。\n$$\n\\sum_{n=0}^{\\infty} (\\exp(-k_e \\tau))^n = \\frac{1}{1 - \\exp(-k_e \\tau)}\n$$\n因此，稳态浓度曲线为：\n$$\nC_{SS}(t) = \\left( \\frac{D}{V_d} \\exp(-k_e t) \\right) \\left( \\frac{1}{1 - \\exp(-k_e \\tau)} \\right)\n$$\n我们现在可以计算 $R_{ac}$：\n$$\nR_{ac} = \\frac{C_{SS}(t)}{C_1(t)} = \\frac{\\left( \\frac{D}{V_d} \\exp(-k_e t) \\right) \\left( \\frac{1}{1 - \\exp(-k_e \\tau)} \\right)}{\\frac{D}{V_d} \\exp(-k_e t)} = \\frac{1}{1 - \\exp(-k_e \\tau)}\n$$\n这证实了对于线性系统，蓄积指数与剂量 $D$、分布容积 $V_d$ 以及给药后时间 $t$ 无关。它仅取决于消除速率常数 $k_e$ 和给药间隔 $\\tau$。\n我们现在用 $k_e = 0.05~\\text{h}^{-1}$ 和 $\\tau = 24$ h 进行数值计算。\n乘积 $k_e \\tau$ 为：\n$$\nk_e \\tau = (0.05~\\text{h}^{-1})(24~\\text{h}) = 1.2\n$$\n蓄积指数则为：\n$$\nR_{ac} = \\frac{1}{1 - \\exp(-1.2)} \\approx \\frac{1}{1 - 0.3011942} = \\frac{1}{0.6988058} \\approx 1.430999\n$$\n四舍五入至四位有效数字，$R_{ac} = 1.431$。这是一个无量纲量。\n\n按顺序，所要求的三个数值结果是：\n1.  半衰期：$13.86$ h\n2.  达到 $95\\%$ 稳态的时间：$59.91$ h\n3.  蓄积指数：$1.431$", "answer": "$$\n\\boxed{\\begin{pmatrix} 13.86  59.91  1.431 \\end{pmatrix}}\n$$", "id": "4575193"}, {"introduction": "治疗药物监测（TDM）是个体化医疗的基石，它允许我们根据患者个体数据调整剂量。在这个实践场景中，您将应用剂量正比原则——这是线性药代动力学的一个关键特征——来计算一个新剂量，以达到目标谷浓度。这项练习将药代动力学理论概念与直接的临床决策联系起来。[@problem_id:4575225]", "problem": "一名患有转移性疾病的患者正在接受一种酪氨酸激酶抑制剂（TKI；tyrosine kinase inhibitor）治疗，已知该药物在治疗范围内表现出线性、时不变的药代动力学（PK；pharmacokinetics）特性。在每日一次、$400$ mg的给药方案（给药间隔 $\\tau = 24$ 小时）达到稳态后，测得其给药前（谷）血浆浓度为 $600$ ng/mL。该TKI的治疗谷浓度目标范围为 $1000$ 至 $1500$ ng/mL。假设在生物利用度和表观清除率保持不变的情况下，稳态谷浓度与维持剂量成正比，请计算能够达到治疗范围中点的新的单次每日总剂量。将您的答案四舍五入至三位有效数字。最终剂量以mg表示。\n\n此外，请简要讨论限制仅基于谷浓度对TKI进行按比例剂量调整的关键注意事项，包括生理学、药理学和测量相关的考量。请勿在问题陈述中提供任何公式；您的推理应基于经过充分验证的药代动力学原理。", "solution": "相关的基本依据是药代动力学中稳态的定义和线性原理。对于具有线性、时不变PK特性的药物，在重复给药下达到稳態时的浓度-时间曲线与输入（剂量或给药速率）成线性比例关系。具体而言，对于口服给药，在生物利用度 $F$ 和表观清除率 $CL$ 恒定的情况下，给药间隔内的任意时间点的浓度可以表示为\n$$\nC(t) = \\frac{F \\cdot D}{CL} \\cdot h(t;\\tau,k,V),\n$$\n其中 $D$ 是每个间隔的剂量，$\\tau$ 是给药间隔， $k$ 是消除速率常数，$V$ 是表观分布容积，$h(t;\\tau,k,V)$ 是一个由系统参数和给药方案决定的无量纲函数。在稳态下，对于固定的 $\\tau$、$k$ 和 $V$，$h(t;\\tau,k,V)$不依赖于$D$；因此浓度与 $D$ 成正比。\n\n因此，谷浓度 $C_{\\min}$ 与 $D$ 成正比：\n$$\n\\frac{C_{\\min,2}}{C_{\\min,1}} = \\frac{D_{2}}{D_{1}},\n$$\n前提是 $F$ 和 $CL$ 保持不变，且患者处于稳态，并且采样时间相对于给药时间点相同。\n\n我们已知：\n- 当前剂量 $D_{1} = 400$ mg，每日一次。\n- 测得的稳态谷浓度 $C_{\\min,1} = 600$ ng/mL。\n- 目标谷浓度范围 $1000$至$1500$ ng/mL。为了在对称范围内最小化超出或低于目标的概率，一个合理的单点目标是其中点，\n$$\nC_{\\text{target}} = \\frac{1000 + 1500}{2} = 1250 \\text{ ng/mL}。\n$$\n\n利用比例关系，\n$$\n\\frac{C_{\\text{target}}}{C_{\\min,1}} = \\frac{D_{2}}{D_{1}} \\quad \\Rightarrow \\quad D_{2} = D_{1} \\cdot \\frac{C_{\\text{target}}}{C_{\\min,1}}。\n$$\n代入数值：\n$$\n\\frac{C_{\\text{target}}}{C_{\\min,1}} = \\frac{1250}{600} = \\frac{25}{12} \\approx 2.083333\\ldots,\n$$\n以及\n$$\nD_{2} = 400 \\times \\frac{25}{12} = \\frac{10000}{12} \\approx 833.333\\ldots \\text{ mg}。\n$$\n四舍五入到三位有效数字，新的每日总剂量为 $833$ mg。\n\n在TKI治疗中基于谷浓度进行比例调整的注意事项：\n- 线性PK的假设在较高暴露量下可能不成立，原因包括饱和性吸收、转运体介导的外排或浓度依赖性蛋白结合。如果 $F$ 或 $CL$ 随剂量变化，则 $C \\propto D$ 的关系不再成立。\n- 时变动力学（代谢的自身诱导或自身抑制）可以在剂量改变后改变 $CL$，使得比例关系变为暂时的或不准确的。\n- 药物-药物相互作用在TKI中很常见（许多是细胞色素P450 $3A4$ 和转运体的底物）。伴随使用的抑制剂或诱导剂可以改变 $CL$ 或 $F$，使谷浓度与剂量脱钩。\n- 谷浓度采样必须真正在稳态下的给药前进行。相对于给药时间的过早或过晚采样、近期漏服剂量或依从性不佳都可能使 $C_{\\min}$ 产生偏差。\n- 治疗药物监测（TDM；therapeutic drug monitoring）检测中的分析变异和次间变异会引入测量误差；在进行大的剂量调整前，重复测量可能是审慎的做法。\n- 活性代謝物和药效学：一些TKI具有活性代謝物，或其靶点结合与曲线下面积（AUC）的相关性优于谷浓度；以 $C_{\\min}$ 为目标可能无法完全捕捉暴露-反应关系。\n- 安全性考量：约 $2.08$ 倍的倍数增加可能会增加毒性风险。临床实践中常在可用片剂规格范围内进行增量滴定，同时密切监测不良事件并重新检查浓度。\n\n鉴于题目要求忽略剂型限制并提供一个单一的计算剂量，在所述假设下，比例计算得出 $833$ mg作为目标每日总剂量，以达到 $1250$ ng/mL的目标浓度。", "answer": "$$\\boxed{833}$$", "id": "4575225"}, {"introduction": "量化药物暴露与临床结局之间的关系是现代药物开发中的一项关键任务。这项高级实践将指导您从零开始构建一个暴露-反应模型，使用逻辑回归将谷浓度与毒性概率联系起来。掌握这项技术为您在群体水平上定义治疗窗和优化治疗策略提供了一种强有力的方法。[@problem_id:4575252]", "problem": "给定一组患者的酪氨酸激酶抑制剂 (TKI) 稳态谷浓度（通常表示为最低浓度 $C_{\\min}$），以及每位患者是否经历了根据《不良事件通用术语标准》(CTCAE) 定义的 $\\ge 2$ 级毒性。假设毒性由药物暴露引起，其对数几率随浓度增加而单调递增。请通过逻辑回归将 $\\ge 2$ 级毒性的概率建模为 $C_{\\min}$ 的函数，并从第一性原理出发，使用最大似然估计法进行求解。\n\n从临床药理学和生物统计学的以下基础概念开始：\n\n- 药代动力学-药效学暴露-反应原理：对于许多抑制剂，暴露水平越高，发生毒性的机会以单调方式增加。\n- 毒性的二元结果模型：每位患者 $i$ 有一个二元结果 $y_i \\in \\{0,1\\}$，其中 $y_i = 1$ 表示发生 $\\ge 2$ 级毒性，$y_i = 0$ 表示未发生。该结果被建模为一个参数为 $p_i$ 的独立伯努利随机变量。\n- 伯努利似然：其概率质量函数为 $f(y_i \\mid p_i) = p_i^{y_i} (1 - p_i)^{1 - y_i}$。\n- Logit 连接函数：对数几率与暴露呈线性关系，$\\operatorname{logit}(p_i) = \\ln\\left(\\frac{p_i}{1 - p_i}\\right) = \\beta_0 + \\beta_1 x_i$，其中 $x_i$ 是患者 $i$ 的 $C_{\\min}$，$\\beta_0$ 是截距，$\\beta_1$ 是斜率参数，描述单位浓度变化引起的对数几率变化。\n\n你必须使用牛顿-拉弗森法（迭代重加权最小二乘法）推导并实现 $\\beta_0$ 和 $\\beta_1$ 的最大似然估计量，期间不得调用任何现成的分类例程。使用自然对数。然后，为指定的测试浓度计算预测概率 $p(x) = \\frac{1}{1 + e^{-(\\beta_0 + \\beta_1 x)}}$。\n\n训练数据（所有 $C_{\\min}$ 值的单位均为 $\\mathrm{ng/mL}$）：\n- 浓度 $x$（单位：$\\mathrm{ng/mL}$）：$[8, 15, 22, 29, 36, 44, 52, 60, 68, 76, 84, 92, 105, 120, 135, 150, 170, 190, 210, 230]$。\n- 毒性指标 $y$：$[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1]$。\n\n数学和算法要求：\n- 定义对数似然 $\\ell(\\beta_0, \\beta_1) = \\sum_{i=1}^{n} \\left( y_i (\\beta_0 + \\beta_1 x_i) - \\ln\\left(1 + e^{\\beta_0 + \\beta_1 x_i}\\right) \\right)$。\n- 推导梯度 $\\nabla \\ell(\\boldsymbol{\\beta}) = \\mathbf{X}^\\top (\\mathbf{y} - \\mathbf{p})$，其中 $\\mathbf{X}$ 是一个 $n \\times 2$ 的设计矩阵，第一列全为 1，第二列为 $x_i$；$\\mathbf{y}$ 是结果向量；$\\mathbf{p}$ 的元素为 $p_i = \\frac{1}{1 + e^{-(\\beta_0 + \\beta_1 x_i)}}$。\n- 推导海森矩阵 $\\mathbf{H}(\\boldsymbol{\\beta}) = -\\mathbf{X}^\\top \\mathbf{W} \\mathbf{X}$，其中 $\\mathbf{W}$ 是对角矩阵，其对角元素为 $p_i (1 - p_i)$。\n- 通过求解 $\\mathbf{X}^\\top \\mathbf{W} \\mathbf{X} \\, \\Delta \\boldsymbol{\\beta} = \\mathbf{X}^\\top (\\mathbf{y} - \\mathbf{p})$ 并更新 $\\boldsymbol{\\beta} \\leftarrow \\boldsymbol{\\beta} + \\Delta \\boldsymbol{\\beta}$ 直至收敛，来实现牛顿步。\n\n科学真实性约束：\n- 将 $C_{\\min}$ 视为单位为 $\\mathrm{ng/mL}$ 的稳态谷浓度。\n- 概率必须以 $[0,1]$ 范围内的小数形式报告（不带百分号）。\n\n测试集：\n- 计算 $x$（单位：$\\mathrm{ng/mL}$）的预测概率：$[0, 25, 75, 120, 180, 300]$。\n\n答案规范：\n- 你的程序必须使用上述方法，将 $\\beta_0$ 和 $\\beta_1$ 拟合到训练数据上，然后为六个测试浓度计算 $p(x)$。\n- 将最终结果表示为六个四舍五入到小数点后四位的小数，并以逗号分隔的列表形式，单行呈现在方括号内。\n- 最终输出格式必须严格如下：例如，$[0.1234,0.5678,0.9012,0.3456,0.7890,0.2345]$。\n\n不允许任何外部输入。程序必须完全自包含，并根据内嵌的训练集和测试集生成指定输出。", "solution": "我们的目标是建立一个逻辑回归模型，将酪氨酸激酶抑制剂的谷浓度 $C_{\\min}$ 与发生 $\\ge 2$ 级毒性的概率关联起来。此过程将从基本定义出发，采用最大似然估计法。我们首先对二元结果模型和似然函数进行形式化。\n\n每位患者 $i$ 提供一个暴露水平 $x_i$（单位：$\\mathrm{ng/mL}$）和一个二元毒性指标 $y_i \\in \\{0,1\\}$。伯努利模型假定 $y_i \\sim \\operatorname{Bernoulli}(p_i)$，其中 $p_i$ 是在暴露水平 $x_i$ 下发生毒性的概率。似然函数为 $L(\\boldsymbol{\\beta}) = \\prod_{i=1}^{n} p_i^{y_i} (1 - p_i)^{1 - y_i}$，其中 $p_i$ 通过 Logit 连接函数进行建模，\n$$\n\\operatorname{logit}(p_i) = \\ln\\left(\\frac{p_i}{1-p_i}\\right) = \\beta_0 + \\beta_1 x_i,\n$$\n因此\n$$\np_i = \\frac{1}{1 + e^{-(\\beta_0 + \\beta_1 x_i)}}.\n$$\n该连接函数的建立基于一个假设：毒性的对数几率随暴露水平线性增加。这是一个在临床上合理的简化，与靶向抑制剂药理学中的单调暴露-反应关系相符。\n\n对数似然函数为\n$$\n\\ell(\\boldsymbol{\\beta}) = \\sum_{i=1}^{n} \\left[ y_i (\\beta_0 + \\beta_1 x_i) - \\ln\\left(1 + e^{\\beta_0 + \\beta_1 x_i}\\right) \\right],\n$$\n其中 $\\boldsymbol{\\beta} = (\\beta_0, \\beta_1)^\\top$。为了最大化 $\\ell(\\boldsymbol{\\beta})$，我们计算用于牛顿-拉弗森更新的梯度和海森矩阵。设 $\\mathbf{X}$ 为 $n \\times 2$ 的设计矩阵，其第一列为 $\\mathbf{1}$，第二列为暴露水平 $(x_i)$；设 $\\mathbf{y}$ 为观测结果向量；设 $\\mathbf{p}$ 为元素是如上定义的 $p_i$ 的向量。梯度为\n$$\n\\nabla \\ell(\\boldsymbol{\\beta}) = \\mathbf{X}^\\top (\\mathbf{y} - \\mathbf{p}),\n$$\n海森矩阵为\n$$\n\\mathbf{H}(\\boldsymbol{\\beta}) = -\\mathbf{X}^\\top \\mathbf{W} \\mathbf{X}, \\quad \\text{其中} \\quad \\mathbf{W} = \\operatorname{diag}\\left(p_i (1 - p_i)\\right).\n$$\n牛顿步通过求解\n$$\n\\mathbf{X}^\\top \\mathbf{W} \\mathbf{X} \\, \\Delta \\boldsymbol{\\beta} = \\mathbf{X}^\\top (\\mathbf{y} - \\mathbf{p}),\n$$\n并更新\n$$\n\\boldsymbol{\\beta} \\leftarrow \\boldsymbol{\\beta} + \\Delta \\boldsymbol{\\beta}.\n$$\n这等价于迭代重加权最小二乘法 (IRLS)，其中权重为 $p_i (1 - p_i)$，工作响应则反映了当前的残差 $(y_i - p_i)$。\n\n算法设计：\n- 初始化 $\\boldsymbol{\\beta}^{(0)} = (0, 0)^\\top$。\n- 对于迭代 $t = 0, 1, \\dots$：\n  1. 对所有 $i$ 计算 $p_i^{(t)} = \\frac{1}{1 + e^{-(\\beta_0^{(t)} + \\beta_1^{(t)} x_i)}}$。\n  2. 构造 $\\mathbf{W}^{(t)} = \\operatorname{diag}\\left(p_i^{(t)} (1 - p_i^{(t)})\\right)$。\n  3. 计算右侧项 $\\mathbf{X}^\\top (\\mathbf{y} - \\mathbf{p}^{(t)})$。\n  4. 求解 $(\\mathbf{X}^\\top \\mathbf{W}^{(t)} \\mathbf{X}) \\, \\Delta \\boldsymbol{\\beta}^{(t)} = \\mathbf{X}^\\top (\\mathbf{y} - \\mathbf{p}^{(t)})$ 以得到 $\\Delta \\boldsymbol{\\beta}^{(t)}$。\n  5. 更新 $\\boldsymbol{\\beta}^{(t+1)} = \\boldsymbol{\\beta}^{(t)} + \\Delta \\boldsymbol{\\beta}^{(t)}$。\n  6. 当 $\\|\\Delta \\boldsymbol{\\beta}^{(t)}\\|_2$ 低于一个小的容差（例如 $10^{-10}$）或达到最大迭代次数上限时停止。\n- 为了确保数值稳定性，在 $\\mathbf{X}^\\top \\mathbf{W} \\mathbf{X}$ 接近奇异（例如，准分离现象）的罕见情况下，向系统中添加一个非常小的岭项 $\\lambda \\mathbf{I}$，其中 $\\lambda$ 是一个微小的正常数（例如 $\\lambda = 10^{-8}$）。这不会实质性地改变最大似然估计结果，但能确保方程组的可解性。\n\n一旦求得 $\\widehat{\\boldsymbol{\\beta}} = (\\widehat{\\beta}_0, \\widehat{\\beta}_1)^\\top$，即可通过以下公式计算任何新浓度 $x$ 的预测概率：\n$$\n\\widehat{p}(x) = \\frac{1}{1 + e^{-(\\widehat{\\beta}_0 + \\widehat{\\beta}_1 x)}}.\n$$\n将此公式应用于指定的测试集浓度 $[0, 25, 75, 120, 180, 300]$（单位：$\\mathrm{ng/mL}$）。输出是无量纲的概率，必须表示为四舍五入到四位小数的小数。\n\n这种方法将药理学的暴露-反应基本原理（较高的 $C_{\\min}$ 通常会增加毒性风险）与一个仅使用基本定义和优化方法的严谨统计模型联系起来，确保得到一个可解释的斜率 $\\widehat{\\beta}_1$。该斜率量化了 $C_{\\min}$ 每增加一个 $\\mathrm{ng/mL}$ 单位，$\\ge 2$ 级毒性的对数几率会如何变化。该算法通过一个自包含的 Python 程序实现，该程序在内嵌的训练数据上拟合模型，并以严格要求的格式打印出所要求的六个概率值。\n\n```python\nimport numpy as np\n\ndef irls_logistic_regression(X, y, max_iter=1000, tol=1e-10, ridge=1e-8):\n    \"\"\"\n    Fit logistic regression via Iteratively Reweighted Least Squares (Newton-Raphson).\n\n    Parameters:\n        X: Design matrix of shape (n_samples, n_features), with intercept column included.\n        y: Binary response vector of shape (n_samples,).\n        max_iter: Maximum number of iterations.\n        tol: Convergence tolerance on parameter update norm.\n        ridge: Small diagonal ridge added to X^T W X for numerical stability.\n\n    Returns:\n        beta: Estimated parameter vector of shape (n_features,).\n    \"\"\"\n    n_features = X.shape[1]\n    beta = np.zeros(n_features)\n\n    for _ in range(max_iter):\n        z = X @ beta\n        # Sigmoid probabilities\n        p = 1.0 / (1.0 + np.exp(-z))\n\n        # Weights: p * (1 - p)\n        w = p * (1.0 - p)\n\n        # Guard against zero weights by adding a tiny floor\n        w = np.maximum(w, 1e-12)\n\n        # Compute gradient: X^T (y - p)\n        grad = X.T @ (y - p)\n\n        # Hessian (negative of second derivative of log-likelihood): X^T W X\n        # Build W as diagonal efficiently via multiplying columns\n        WX = X * w[:, None]\n        H = X.T @ WX\n\n        # Add small ridge for numerical stability\n        H += ridge * np.eye(n_features)\n\n        # Solve H * delta = grad for Newton step\n        try:\n            delta = np.linalg.solve(H, grad)\n        except np.linalg.LinAlgError:\n            # Fallback to least-squares solution if singular\n            delta, *_ = np.linalg.lstsq(H, grad, rcond=None)\n\n        beta_new = beta + delta\n\n        # Check convergence\n        if np.linalg.norm(delta)  tol:\n            beta = beta_new\n            break\n\n        beta = beta_new\n\n    return beta\n\ndef predict_prob(beta, x):\n    \"\"\"Predict probability for a scalar or array x given beta = [beta0, beta1].\"\"\"\n    x = np.asarray(x, dtype=float)\n    z = beta[0] + beta[1] * x\n    return 1.0 / (1.0 + np.exp(-z))\n\ndef solve():\n    # Training data: Cmin (ng/mL) and toxicity indicator (grade = 2 as 1, else 0)\n    x_train = np.array([8, 15, 22, 29, 36, 44, 52, 60, 68, 76, 84, 92, 105, 120, 135, 150, 170, 190, 210, 230], dtype=float)\n    y_train = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1], dtype=float)\n\n    # Design matrix with intercept\n    X = np.column_stack([np.ones_like(x_train), x_train])\n\n    # Fit logistic regression via IRLS\n    beta_hat = irls_logistic_regression(X, y_train, max_iter=1000, tol=1e-10, ridge=1e-8)\n\n    # Test suite concentrations (ng/mL)\n    test_cases = [0.0, 25.0, 75.0, 120.0, 180.0, 300.0]\n\n    # Predict probabilities\n    probs = predict_prob(beta_hat, np.array(test_cases))\n\n    # Round to 4 decimal places and format\n    results_str = [f\"{p:.4f}\" for p in probs]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\n# solve() is commented out because the final answer is static text.\n# The following answer is the output of running the corrected solve() function.\n```", "answer": "[0.0257,0.0787,0.4707,0.8804,0.9925,1.0000]", "id": "4575252"}]}