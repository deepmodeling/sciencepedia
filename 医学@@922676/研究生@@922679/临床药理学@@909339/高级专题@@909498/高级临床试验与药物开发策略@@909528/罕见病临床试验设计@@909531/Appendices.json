{"hands_on_practices": [{"introduction": "在罕见病药物开发的早期阶段，确定既安全又可能有效的最佳剂量至关重要。由于患者人数极少，传统的剂量递增方案效率低下。本练习旨在介绍一种强大且高效的适应性设计——持续重新评估方法（CRM），它利用贝叶斯原理，根据累积的毒性数据动态更新对剂量-毒性关系的认识。通过这项实践 [@problem_id:4541009]，您将深入了解CRM的核心机制，包括如何根据实际观察到的数据推导和应用其更新规则，从而为下一队列患者做出更明智的剂量决策。", "problem": "一项针对罕见病的I期剂量探索研究使用连续重新评估法 (Continual Reassessment Method, CRM) 来确定目标剂量限制性毒性 (dose-limiting toxicity, DLT) 概率为 $\\theta^{*}=0.25$。CRM采用单参数幂模型，通过 $p_{j}(\\alpha)=p_{0j}^{\\exp(\\alpha)}$ 将每个剂量水平的真实DLT概率与一个固定的骨架 $\\{p_{0j}\\}$ 联系起来，其中 $\\alpha$ 是一个未知的校准参数。假设有 $J=5$ 个有序剂量水平，其骨架为 $\\{p_{0j}\\}_{j=1}^{5}=\\{0.05,0.10,0.20,0.35,0.50\\}$。假设 $\\alpha$ 的离散先验分布，其支撑集为 $\\{\\alpha_{1},\\alpha_{2},\\alpha_{3}\\}=\\{-0.5,0,0.5\\}$，先验概率为 $\\{\\pi_{1},\\pi_{2},\\pi_{3}\\}=\\{\\tfrac{1}{3},\\tfrac{1}{3},\\tfrac{1}{3}\\}$。\n\n在一次期中分析中，剂量水平 $j=1$ 有 $n_{1}=2$ 名患者接受治疗，出现 $y_{1}=0$ 例DLT；剂量水平 $j=2$ 有 $n_{2}=2$ 名患者接受治疗，出现 $y_{2}=0$ 例DLT；剂量水平 $j=3$ 有 $n_{3}=3$ 名患者接受治疗，出现 $y_{3}=1$ 例DLT。更高剂量水平没有患者接受过治疗 ($n_{4}=n_{5}=0$)。假设在给定 $\\alpha$ 和剂量的情况下，DLT结果是独立的伯努利事件。\n\n任务：\n- 从伯努利似然和贝叶斯定理的定义出发，推导在具有 $\\alpha$ 离散先验的单参数幂模型下的CRM更新规则。你的推导必须明确给出给定数据 $\\{(n_{j},y_{j})\\}_{j=1}^{J}$ 时 $\\alpha$ 的后验分布，以及选择下一个剂量的规则，即选择其后验均值DLT概率 $\\mathbb{E}[p_{j}(\\alpha)\\mid\\text{data}]$ 与目标 $\\theta^{*}$ 最接近（绝对差值）的剂量指数 $j$。\n- 使用提供的骨架、先验和观测数据，计算下一个推荐剂量。如果出现平局，选择较低的剂量指数。应用常见的安全性约束，即下一个推荐剂量不能跳过未尝试过的水平（也就是说，它不能比迄今为止尝试过的最高剂量水平高出超过1个水平）。将你的最终答案表示为整数值的剂量指数 $j\\in\\{1,2,3,4,5\\}$。", "solution": "该问题要求推导连续重新评估法 (CRM) 的更新规则，并应用该规则来推荐I期临床试验中的下一个剂量水平。\n\n首先，我们推导通用更新规则。\nCRM的核心是一个贝叶斯框架，用于在数据累积时更新我们对剂量-毒性关系的信念。令 $\\alpha$ 为剂量-毒性模型中的未知参数。我们给定一个 $\\alpha$ 的离散先验分布，其支撑集为 $\\{\\alpha_k\\}_{k=1}^K$，先验概率为 $\\mathbb{P}(\\alpha = \\alpha_k) = \\pi_k$。\n\n数据 $D$ 包括来自 $J$ 个剂量水平的观测值，$D = \\{(n_j, y_j)\\}_{j=1}^J$，其中 $n_j$ 是在剂量水平 $j$ 接受治疗的患者数量，而 $y_j$ 是这些患者中经历剂量限制性毒性 (DLT) 的数量。每位患者的结果是一个伯努利试验，在剂量 $j$ 发生DLT的概率是 $p_j(\\alpha)$。问题陈述，在给定 $\\alpha$ 和剂量的情况下，DLT结果是独立的。\n\n在剂量 $j$ 的 $n_j$ 名患者中观测到 $y_j$ 例DLT的似然服从二项分布：\n$$ \\mathbb{P}(y_j \\mid n_j, \\alpha) = \\binom{n_j}{y_j} [p_j(\\alpha)]^{y_j} [1 - p_j(\\alpha)]^{n_j - y_j} $$\n由于（在给定 $\\alpha$ 的条件下）各剂量水平的结果是独立的，给定参数 $\\alpha$ 时观测数据 $D$ 的总似然是每个剂量水平似然的乘积：\n$$ L(\\alpha \\mid D) = \\mathbb{P}(D \\mid \\alpha) = \\prod_{j=1}^{J} \\binom{n_j}{y_j} [p_j(\\alpha)]^{y_j} [1 - p_j(\\alpha)]^{n_j - y_j} $$\n将DLT概率 $p_j$ 与参数 $\\alpha$ 联系起来的模型是单参数幂模型：$p_j(\\alpha) = p_{0j}^{\\exp(\\alpha)}$，其中 $\\{p_{0j}\\}$ 是先验DLT概率的固定骨架。\n\n根据离散参数的贝叶斯定理，给定数据 $D$ 时 $\\alpha_k$ 的后验概率是：\n$$ \\mathbb{P}(\\alpha = \\alpha_k \\mid D) = \\frac{\\mathbb{P}(D \\mid \\alpha = \\alpha_k) \\mathbb{P}(\\alpha = \\alpha_k)}{\\sum_{m=1}^{K} \\mathbb{P}(D \\mid \\alpha = \\alpha_m) \\mathbb{P}(\\alpha = \\alpha_m)} $$\n代入似然 $L(\\alpha_k \\mid D)$ 和先验概率 $\\pi_k$：\n$$ \\mathbb{P}(\\alpha = \\alpha_k \\mid D) = \\frac{L(\\alpha_k \\mid D) \\pi_k}{\\sum_{m=1}^{K} L(\\alpha_m \\mid D) \\pi_m} $$\n由于二项式系数 $\\binom{n_j}{y_j}$ 不依赖于 $\\alpha$，它们在分子和分母中都是常数因子，可以消去。因此，我们可以使用一个与似然成正比的函数：\n$$ L^*(\\alpha_k \\mid D) = \\prod_{j=1}^{J} [p_j(\\alpha_k)]^{y_j} [1 - p_j(\\alpha_k)]^{n_j - y_j} $$\n于是后验概率为：\n$$ \\mathbb{P}(\\alpha = \\alpha_k \\mid D) = \\frac{L^*(\\alpha_k \\mid D) \\pi_k}{\\sum_{m=1}^{K} L^*(\\alpha_m \\mid D) \\pi_m} $$\n这就是 $\\alpha$ 后验分布的CRM更新规则。\n\n更新 $\\alpha$ 的分布后，每个剂量 $j$ 的DLT概率通过其后验均值来估计：\n$$ \\mathbb{E}[p_j(\\alpha) \\mid D] = \\sum_{k=1}^{K} p_j(\\alpha_k) \\mathbb{P}(\\alpha = \\alpha_k \\mid D) $$\n选择下一个剂量 $j_{\\text{next}}$ 的规则是，选择其估计的DLT概率与目标毒性 $\\theta^*$ 最接近的剂量水平。这由以下公式给出：\n$$ j_{\\text{next}} = \\arg\\min_{j \\in S} |\\mathbb{E}[p_j(\\alpha) \\mid D] - \\theta^*| $$\n其中 $S$ 是下一个队列允许的剂量水平集合，包含了任何安全性约束。\n\n现在，我们将此框架应用于具体问题。\n\n给定的值为：\n目标DLT概率：$\\theta^* = 0.25$。\n剂量水平：$J=5$。\n骨架：$\\{p_{0j}\\}_{j=1}^{5}=\\{0.05, 0.10, 0.20, 0.35, 0.50\\}$。\n参数支撑集：$\\{\\alpha_1, \\alpha_2, \\alpha_3\\} = \\{-0.5, 0, 0.5\\}$。\n先验概率：$\\{\\pi_1, \\pi_2, \\pi_3\\} = \\{\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\}$。\n数据：$(n_1=2, y_1=0)$、$(n_2=2, y_2=0)$、$(n_3=3, y_3=1)$、$(n_4=0, y_4=0)$、$(n_5=0, y_5=0)$。\n\n步骤1：对于每个剂量 $j$ 和参数值 $\\alpha_k$，计算 $p_j(\\alpha_k) = p_{0j}^{\\exp(\\alpha_k)}$。\n对于 $\\alpha_1 = -0.5$，$\\exp(\\alpha_1) \\approx 0.60653$。\n对于 $\\alpha_2 = 0$，$\\exp(\\alpha_2) = 1$。\n对于 $\\alpha_3 = 0.5$，$\\exp(\\alpha_3) \\approx 1.64872$。\n\n$p_1(-0.5) = 0.05^{0.60653} \\approx 0.1625$, $p_1(0) = 0.05$, $p_1(0.5) = 0.05^{1.64872} \\approx 0.0038$。\n$p_2(-0.5) = 0.10^{0.60653} \\approx 0.2474$, $p_2(0) = 0.10$, $p_2(0.5) = 0.10^{1.64872} \\approx 0.0224$。\n$p_3(-0.5) = 0.20^{0.60653} \\approx 0.3767$, $p_3(0) = 0.20$, $p_3(0.5) = 0.20^{1.64872} \\approx 0.0863$。\n$p_4(-0.5) = 0.35^{0.60653} \\approx 0.5290$, $p_4(0) = 0.35$, $p_4(0.5) = 0.35^{1.64872} \\approx 0.2104$。\n$p_5(-0.5) = 0.50^{0.60653} \\approx 0.6568$, $p_5(0) = 0.50$, $p_5(0.5) = 0.50^{1.64872} \\approx 0.3183$。\n\n步骤2：为每个 $\\alpha_k$ 计算似然函数值 $L^*(\\alpha_k \\mid D)$。观测数据只涉及剂量1、2和3。\n$L^*(\\alpha \\mid D) = [p_1(\\alpha)]^{0} [1-p_1(\\alpha)]^{2-0} \\times [p_2(\\alpha)]^{0} [1-p_2(\\alpha)]^{2-0} \\times [p_3(\\alpha)]^{1} [1-p_3(\\alpha)]^{3-1}$\n$L^*(\\alpha \\mid D) = [1-p_1(\\alpha)]^2 [1-p_2(\\alpha)]^2 p_3(\\alpha) [1-p_3(\\alpha)]^2$。\n\n对于 $\\alpha_1 = -0.5$：\n$L^*_1 = (1-0.1625)^2 (1-0.2474)^2 (0.3767) (1-0.3767)^2 \\approx 0.05814$。\n\n对于 $\\alpha_2 = 0$：\n$L^*_2 = (1-0.05)^2 (1-0.10)^2 (0.20) (1-0.20)^2 = (0.95)^2 (0.9)^2 (0.2) (0.8)^2 \\approx 0.09344$。\n\n对于 $\\alpha_3 = 0.5$：\n$L^*_3 = (1-0.0038)^2 (1-0.0224)^2 (0.0863) (1-0.0863)^2 \\approx 0.06825$。\n\n步骤3：计算后验概率 $\\mathbb{P}(\\alpha_k \\mid D)$。由于先验是均匀的（$\\pi_k = 1/3$），后验概率与似然值成正比。\n令 $S = L^*_1 + L^*_2 + L^*_3 \\approx 0.05814 + 0.09344 + 0.06825 = 0.21983$。\n后验概率为：\n$\\mathbb{P}(\\alpha_1 \\mid D) = L^*_1 / S \\approx 0.05814 / 0.21983 \\approx 0.2645$。\n$\\mathbb{P}(\\alpha_2 \\mid D) = L^*_2 / S \\approx 0.09344 / 0.21983 \\approx 0.4251$。\n$\\mathbb{P}(\\alpha_3 \\mid D) = L^*_3 / S \\approx 0.06825 / 0.21983 \\approx 0.3105$。\n\n步骤4：计算DLT概率的后验均值 $\\hat{p}_j = \\mathbb{E}[p_j(\\alpha) \\mid D]$。\n$\\hat{p}_j = p_j(\\alpha_1)\\mathbb{P}(\\alpha_1 \\mid D) + p_j(\\alpha_2)\\mathbb{P}(\\alpha_2 \\mid D) + p_j(\\alpha_3)\\mathbb{P}(\\alpha_3 \\mid D)$。\n\n$\\hat{p}_1 \\approx (0.1625)(0.2645) + (0.05)(0.4251) + (0.0038)(0.3105) \\approx 0.0655$。\n$\\hat{p}_2 \\approx (0.2474)(0.2645) + (0.10)(0.4251) + (0.0224)(0.3105) \\approx 0.1149$。\n$\\hat{p}_3 \\approx (0.3767)(0.2645) + (0.20)(0.4251) + (0.0863)(0.3105) \\approx 0.2115$。\n$\\hat{p}_4 \\approx (0.5290)(0.2645) + (0.35)(0.4251) + (0.2104)(0.3105) \\approx 0.3540$。\n$\\hat{p}_5 \\approx (0.6568)(0.2645) + (0.50)(0.4251) + (0.3183)(0.3105) \\approx 0.4851$。\n\n步骤5：选择下一个剂量。\n到目前为止，已给药的最高剂量水平是 $j=3$。安全性约束规定，下一个剂量不能超过此水平1级以上。因此，候选剂量集为 $S = \\{1, 2, 3, 4\\}$。\n我们必须找到剂量 $j \\in S$ 使得 $|\\hat{p}_j - \\theta^*| = |\\hat{p}_j - 0.25|$ 最小化。\n\n$j=1: |\\hat{p}_1 - 0.25| = |0.0655 - 0.25| = 0.1845$。\n$j=2: |\\hat{p}_2 - 0.25| = |0.1149 - 0.25| = 0.1351$。\n$j=3: |\\hat{p}_3 - 0.25| = |0.2115 - 0.25| = 0.0385$。\n$j=4: |\\hat{p}_4 - 0.25| = |0.3540 - 0.25| = 0.1040$。\n\n最小绝对差为 $0.0385$，对应于剂量水平 $j=3$。没有平局，因此不启用平局打破规则。\n\n下一个推荐的剂量指数是 $3$。", "answer": "$$\\boxed{3}$$", "id": "4541009"}, {"introduction": "一项临床试验的科学严谨性取决于其所有组成部分之间的一致性，特别是科学问题（即“estimand”或“目标估计量”）、终点定义和统计分析方法之间必须精确对齐。在罕见病试验中，由于样本量小，任何设计上的偏差都可能严重影响试验结果的可解释性。这项练习 [@problem_id:4541039] 提供了一个复杂的、贴近现实的交叉试验方案，其中包含了多种潜在的不一致性。您的任务是运用国际协调理事会（ICH）E9(R1)附录中关于目标估计量的框架，识别设计中的关键缺陷，并提出能维护原始科学目标和统计有效性的最佳修正方案，这是临床试验设计者必须具备的一项核心技能。", "problem": "一家申办方设计了一项在罕见病中进行的随机、双盲、$2$-周期、$2$-序列交叉试验，以比较研究性疗法 $A$ 与对照 $B$。序列为 $AB$ 和 $BA$，并设有一个根据药物消除半衰期判断在药理学上充分的计划性清洗期。令 $i \\in \\{1,\\dots,N\\}$ 为参与者索引，$j \\in \\{1,2\\}$ 为周期索引。令 $T_{ij} \\in \\{A,B\\}$ 表示参与者 $i$ 在周期 $j$ 接受的随机分配治疗，令 $Y_{ij}$ 表示在周期 $j$ 结束时按固定时间表测量的连续性主要终点。在周期内的任何时间，允许因症状恶化而使用挽救性药物；令 $R_{ij} \\in \\{0,1\\}$ 表示参与者 $i$ 是否在周期 $j$ 期间使用了挽救性药物。参与者也可能提前中止研究；令 $M_{ij} \\in \\{0,1\\}$ 表示 $Y_{ij}$ 在预定时间是否缺失（如果缺失，则 $M_{ij}=1$）。\n\n方案中的目标估计量声明为：目标人群是所有符合入选标准的随机化参与者；关注的治疗条件是随机分配的治疗 $A$ 与 $B$；变量是周期结束时的终点 $Y_{ij}$；伴随事件，包括使用挽救性药物和中止研究，通过治疗策略进行处理（即，科学问题是比较 $A$ 与 $B$ 时 $Y_{ij}$ 的平均差异，无论是否使用挽救性药物或中止研究）；汇总指标是预定周期结束时参与者内的均值差异，该差异在所有序列和周期上进行汇总，对应于边际治疗效应。\n\n然而，终点部分将用于分析的主要终点定义为“将使用挽救药物前的最后一次观测值结转至预定周期结束时点”，并且分析集排除了任何有使用挽救药物或提前中止研究的参与者-周期。主要分析是治疗周期间的参与者内配对比较，未对周期或序列进行显式调整。间断性缺失数据使用末次观测值结转法进行插补，并且不使用在使用挽救药物后获得的 $Y_{ij}$ 值。\n\n使用国际人用药品注册技术协调会 (ICH) E9(R1) 关于目标估计量和敏感性分析的附录作为基本框架，并结合交叉设计的基本属性（固定周期和序列效应、随机受试者效应以及潜在的延滞效应），评估所述目标估计量、终点定义和分析之间的一致性。假设随机化有效，清洗期在药理学上合理但并非无限长。找出任何主要的不一致之处，并选择在小样本罕见病环境下既能最好地保留原始目标估计量，又能保持科学和统计有效性的纠正措施。哪个选项最合适？\n\nA. 存在根本性错位：治疗策略目标估计量要求无论是否使用挽救药物，都使用预定时间的 $Y_{ij}$，但终点定义在使用挽救药物时进行了删失，且分析排除了使用挽救药物者和中止研究者。纠正措施：将终点重新定义为不考虑 $R_{ij}$ 的预定时间的 $Y_{ij}$，使用包含治疗、周期和序列的固定效应以及随机受试者效应的交叉设计线性混合效应模型进行分析，使用随机缺失 (MAR) 一致性方法（如重复测量混合模型 (MMRM) 或逆概率加权 (IPW)）来处理 $M_{ij}=1$ 的情况，并进行预先设定的非随机缺失 (MNAR) 敏感性分析（例如，delta 调整或基于参照的插补）；保留治疗策略目标估计量。\n\nB. 不存在错位：结转使用挽救药物前的最后一次观测值并排除使用挽救药物者，可以消除挽救药物带来的混杂并针对期望的效应。纠正措施：保留符合方案分析，并增加一个在常规显著性水平上的延滞效应检验以确保有效性。\n\nC. 唯一的问题是排除使用挽救药物者造成的效率损失；目标估计量和终点是一致的。纠正措施：继续排除使用挽救药物者和中止研究者，但增加样本量或借用外部对照进行补偿。\n\nD. 存在错位，因为该分析实际上针对的是一个没有使用挽救药物的假设情景。纠正措施：将目标估计量更改为一个在 $R_{ij}=1$ 时进行删失的假设策略，在无挽救药物模型下使用临界点敏感性分析来插补缺失的使用挽救药物后的值，并保留不考虑周期或序列效应的参与者内配对比较。\n\nE. 错位源于挽救药物是治疗效应的中介变量。纠正措施：仅纳入使用挽救药物后的数据，并将 $R_{ij}$ 作为协变量进行调整以估计直接效应，同时继续排除中止研究者并对间断性缺失使用末次观测值结转法。", "solution": "在进行解答之前，首先对问题陈述的有效性进行严格评估。\n\n### 步骤1：提取已知信息\n- **试验设计**：随机、双盲、$2$-周期、$2$-序列交叉试验。\n- **治疗**：研究性疗法 $A$ 与对照 $B$。\n- **序列**：$AB$ 和 $BA$。\n- **清洗期**：被判断为药理学上充分。\n- **人群**：罕见病，$N$ 名参与者，索引为 $i \\in \\{1,\\dots,N\\}$。\n- **周期**：$2$ 个周期，索引为 $j \\in \\{1,2\\}$。\n- **随机分配的治疗**：$T_{ij} \\in \\{A,B\\}$ 是参与者 $i$ 在周期 $j$ 的治疗。\n- **主要终点**：$Y_{ij}$ 是在周期 $j$ 结束时测量的连续变量。\n- **伴随事件 (ICEs)**：\n    - **挽救性药物**：$R_{ij} \\in \\{0,1\\}$，其中 $R_{ij}=1$ 表示参与者 $i$ 在周期 $j$ 使用了挽救性药物。\n    - **提前中止**：$M_{ij} \\in \\{0,1\\}$，其中 $M_{ij}=1$ 表示 $Y_{ij}$ 在预定时间缺失。\n- **声明的目标估计量**：\n    - **人群**：所有随机化的参与者。\n    - **治疗**：随机分配的治疗 $A$ 与 $B$。\n    - **变量**：周期结束时的终点 $Y_{ij}$。\n    - **ICE 处理**：治疗策略（无论是否使用挽救药物或中止研究，均评估效应）。\n    - **汇总指标**：在预定周期结束时，跨序列和周期汇总的参与者内均值差异（边际治疗效应）。\n- **用于分析的终点定义**：“将使用挽救药物前的最后一次观测值结转至预定周期结束时点。”\n- **分析计划**：\n    - **分析集**：排除任何使用了挽救药物 ($R_{ij}=1$) 或提前中止 ($M_{ij}=1$) 的参与者-周期。\n    - **主要分析方法**：参与者内治疗周期的配对比较。\n    - **模型调整**：未对周期或序列进行显式调整。\n    - **缺失数据处理**：间断性缺失数据使用末次观测值结转法 (LOCF) 进行插补。不使用在使用挽救药物后获得的 $Y_{ij}$ 值。\n\n### 步骤2：使用提取的已知信息进行验证\n问题陈述描述了一个包含多个组成部分的临床试验方案：设计、科学问题（目标估计量）、终点定义和分析计划。任务是评估这些组成部分之间的一致性。该问题在科学上基于临床试验方法学和生物统计学，特别引用了 ICH E9(R1) 框架。这是一个定义明确的问题，因为它要求识别不一致之处并提出有效的纠正措施。其语言客观而精确。\n\n验证的核心是检查内部一致性。仔细检查后发现几个主要矛盾：\n\n1.  **目标估计量与分析集之间的矛盾**：目标估计量指定了“治疗策略”和“所有随机化参与者”的目标人群。这对应于意向性治疗 (ITT) 原则，即在所有随机化人群中评估治疗效果，而不考虑依从性或其他随机化后事件。然而，分析计划指出“分析集排除了任何有使用挽救药物或提前中止研究的参与者-周期”。这定义了一种符合方案或完成者分析，它仅在遵守方案且未经历这些伴随事件的参与者亚群中估计治疗效果。基于随机化后事件来分析一个亚组会引入很高的选择偏倚风险，并且没有解决治疗策略目标估计量所提出的科学问题。\n\n2.  **目标估计量与终点定义之间的矛盾**：目标估计量的变量是在预定周期结束时测量的终点 $Y_{ij}$。治疗策略意味着无论是否使用了挽救性药物，都应按计划进行此测量。然而，方案的终点定义是“将使用挽救药物前的最后一次观测值结转”。这从根本上改变了终点变量。它测量的不是治疗在周期结束时对结局的影响，而是在一个更早的、可变的时间点（恰好在使用挽救药物之前）的结局，或使用一个插补值。这与目标估计量指定的变量不一致。\n\n3.  **挽救药物处理方式的矛盾**：“终点定义”建议对使用挽救药物者采用类似 LOCF 的方法（“结转”），这意味着这些参与者的数据被修改并包含在内。而“分析计划”则指出完全排除有使用挽救药物的参与者-周期。这些是相互排斥的操作。\n\n4.  **有缺陷的统计方法**：指定的分析是“参与者内配对比较……未对周期或序列进行显式调整”。交叉设计容易受到周期效应（随时间发生的、与治疗无关的系统性变化）和序列（或延滞）效应（第1周期的治疗效果延续到第2周期）的影响。未能对这些效应进行建模可能导致治疗效果估计值有偏和标准误不正确。对于 $2 \\times 2$ 交叉试验，标准且适当的分析是包含治疗、周期和序列的固定效应以及参与者的随机效应的混合效应模型。\n\n问题本身并非无效；相反，它描述了一个在科学和统计上有缺陷的试验方案。识别并纠正这些缺陷的任务是生物统计学中一个有效且定义明确的问题。\n\n### 步骤3：结论与行动\n问题有效。它所描述的方案内部不一致且在科学上有缺陷。任务是找出最佳的纠正措施。我将继续进行逐项选项分析。\n\n### 推导与选项分析\n\n主要的不一致在于科学问题（**目标估计量**）与计划的分析之间的脱节。目标估计量要求在**治疗策略**下获得边际治疗效应，即评估在所有随机化患者中被分配到治疗 $A$ 与 $B$ 的效果，无论他们后续是否使用挽救药物或中止研究。这是一个关于治疗策略整体有效性的实际问题。而计划的分析通过排除使用挽救药物或中止研究的参与者，试图估计一个不同的量：在被选定的“良好依从者”亚组中的治疗效果。这是一种符合方案分析的形式，众所周知容易受到选择偏倚的影响，因为需要挽救性药物通常与治疗效果相关。\n\n此外，指定的统计方法（简单的配对比较）对于交叉设计是不充分的，因为它忽略了潜在的周期和序列效应，而这些是已知的偏倚来源。通过 LOCF 处理缺失数据也是一种过时且不被推荐的方法，已知会产生有偏的结果，尤其是在中止研究与治疗结局相关时。\n\n一个有效的纠正措施必须使分析与声明的目标估计量保持一致，并采用统计上稳健的方法。\n\n**选项 A 评估**：\n- **诊断**：该选项正确地指出了“根本性错位”，即“治疗策略目标估计量要求无论是否使用挽救药物，都使用预定时间的 $Y_{ij}$，但终点定义在使用挽救药物时进行了删失，且分析排除了使用挽救药物者和中止研究者”。这是对核心问题的精确和准确的诊断。\n- **纠正措施**：\n    1.  它建议将终点重新定义为“不考虑 $R_{ij}$ 的预定时间的 $Y_{ij}$”。这正确地使测量与目标估计量的变量保持一致。\n    2.  它建议使用“包含治疗、周期和序列的固定效应以及随机受试者效应的交叉设计线性混合效应模型”。这是分析交叉试验数据的金标准统计模型，正确地考虑了数据结构和潜在的混杂因素。\n    3.  它建议使用“随机缺失 (MAR) 一致性方法（如重复测量混合模型 (MMRM) 或逆概率加权 (IPW)）来处理 $M_{ij}=1$ 的情况”。这是处理缺失数据的现代、有原则的方法，远优于 LOCF 或完整病例分析（排除法）。MMRM 特别适用，因为它是混合效应模型的自然扩展。\n    4.  它建议进行“预先设定的非随机缺失 (MNAR) 敏感性分析”。这是现代监管指南（ICH E9(R1)）所要求的关键步骤，用以评估结论对于不可检验的 MAR 假设的稳健性。\n    5.  它最后建议“保留治疗策略目标估计量”。这满足了问题中寻找保留原始科学问题的纠正措施的约束。\n- **结论**：**正确**。该选项提供了一个全面且方法学上严谨的解决方案，纠正了所有已识别的缺陷，并使分析与既定的科学目标和现代统计实践保持一致。\n\n**选项 B 评估**：\n- **诊断**：该选项声称“不存在错位”。这在事实上是错误的，正如目标估计量和分析计划之间的多个矛盾所证明的那样。\n- **纠正措施**：它建议保留有缺陷的符合方案分析。该分析不能估计目标估计量，并且存在偏倚。增加一个延滞效应检验虽然通常是好的做法，但并不能纠正因排除使用挽救药物者而产生的根本性选择偏倚。\n- **结论**：**不正确**。诊断错误，纠正措施不充分。\n\n**选项 C 评估**：\n- **诊断**：该选项声称唯一的问题是“效率损失”。这从根本上误解了问题。基于随机化后结局（$R_{ij}=1$）排除参与者会引入系统性偏倚，这是一个有效性问题，而不仅仅是效率（统计功效）问题。增加样本量无法纠正偏倚。\n- **纠正措施**：增加样本量或借用外部对照并不能解决偏倚问题。更大的样本量只会提供一个更精确但仍然错误的答案。\n- **结论**：**不正确**。它将偏倚误诊为仅仅是效率损失。\n\n**选项 D 评估**：\n- **诊断**：它正确地指出该分析“实际上针对的是一个没有使用挽救药物的假设情景”。在 ICH E9(R1) 框架中，这类目标估计量被称为“假设目标估计量”。\n- **纠正措施**：它建议更改目标估计量以匹配分析。虽然这在现实世界场景中是一个可能的选择，但问题要求“保留原始声明的目标估计量”。此纠正措施违反了该约束。此外，它建议“保留不考虑周期或序列效应的参与者内配对比较”，这是一个统计上有缺陷的模型。\n- **结论**：**不正确**。纠正措施违反了问题的一个关键约束，并保留了一个有缺陷的统计模型。\n\n**选项 E 评估**：\n- **诊断**：它将挽救药物识别为中介变量，这在因果路径中是一个正确的观察。然而，错位并非因为它*是*一个中介变量，而是因为目标估计量和分析对其作用的处理方式不一致。\n- **纠正措施**：提议的纠正措施是“仅纳入使用挽救药物后的数据”并“将 $R_{ij}$ 作为协变量进行调整”。这毫无道理。它将丢弃所有不需要挽救药物的参与者的数据，而他们可能占大多数并代表了治疗成功。在回归模型中将像 $R_{ij}$ 这样的随机化后中介/碰撞变量作为标准协变量进行调整，已知会引入偏倚，并且在没有专门的因果中介技术的情况下，无法估计有意义的因果效应（如直接效应），而所描述的并非这些技术。既定目标是总效应（治疗策略），而不是直接效应。\n- **结论**：**不正确**。该纠正措施在统计上和逻辑上都有缺陷，并且会估计一个既非目标估计量的目标，也非有效因果效应的量。\n\n基于这一全面分析，选项 A 是唯一一个正确识别了错位的所有方面，并提出了一个完整、现代且统计上有效的纠正措施，使分析与原始科学问题保持一致的选项。", "answer": "$$\\boxed{A}$$", "id": "4541039"}, {"introduction": "罕见病通常表现复杂，因此临床试验常需评估多个终点以全面捕捉治疗的潜在获益。然而，检验多个假设会增加犯第一类错误的概率（即错误地宣称治疗有效），这一问题被称为“多重性”问题。为了在评估多个终点时保持统计学上的严谨性，必须对多重性进行控制。本练习 [@problem_id:4541012] 将带您实践一种经典且重要的方法——Holm–Bonferroni程序，以控制总体错误率（FWER）。通过计算调整后的$p$值，您将学会如何在多终点的情景下做出审慎的统计推断，确保研究结论的可靠性。", "problem": "一项针对某种罕见单基因疾病的II期临床研究，使用四个预先指定的、具有临床意义的共同主要终点来评估一种新型小分子疗法的药效学影响。由于小样本量和多终点是罕见病试验的特征，该设计使用Holm–Bonferroni降步法将四个终点假设的总体错误率（Family-Wise Error Rate, FWER）控制在$\\alpha = 0.05$的水平。Holm–Bonferroni降步法能在终点之间存在任意依赖关系的情况下强力控制FWER。假设对四个终点的独立分析得到观测的$p$值，按照原始终点顺序1到4分别为$(0.01, 0.03, 0.04, 0.20)$。从FWER控制的基本定义以及将$p$值解释为其各自零假设下的尾部概率出发，推导这四个终点的Holm–Bonferroni校正$p$值，并确定当在$\\alpha = 0.05$的水平上评估校正$p$值时，有多少个终点仍然显著。将每个校正$p$值四舍五入至四位有效数字。以一个包含五个条目的单行矩阵形式呈现你的最终答案：前四个条目是按照原始终点顺序$(1,2,3,4)$排列的Holm–Bonferroni校正$p$值，第五个条目是在$\\alpha = 0.05$水平上仍然显著的终点数量。无需单位。", "solution": "用户提供了一个问题陈述，需要对其进行验证，如果有效，则需要提供一个完整的解决方案。\n\n### 步骤1：提取已知信息\n- 共同主要终点数量，$m$：$4$。\n- 显著性水平（总体错误率，FWER），$\\alpha$：$0.05$。\n- 多重检验校正程序：Holm–Bonferroni降步法。\n- 终点1, 2, 3, 4的观测未校正$p$值：$(p_1, p_2, p_3, p_4) = (0.01, 0.03, 0.04, 0.20)$。\n- 校正$p$值要求的舍入：四位有效数字。\n- 要求输出：一个行矩阵，包含按原始顺序排列的四个校正$p$值，以及在$\\alpha = 0.05$水平下仍显著的终点数量。\n\n### 步骤2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于成熟的多重假设检验统计学学科，这是临床试验设计和分析的核心组成部分。总体错误率（FWER）、$p$值和Holm–Bonferroni程序是标准的、定义明确的概念。所描述的场景是罕见病临床药理学中的一个现实应用。\n- **适定性**：该问题是适定的。它提供了所有必要的数据（$p$值集合、检验次数、显著性水平$\\alpha$），并指定了一个确定性算法（Holm–Bonferroni）以得到唯一解。\n- **客观性**：问题陈述使用了精确、客观和定量的语言。它没有歧义、主观性或个人观点。\n- **完整性和一致性**：问题是自洽且内部一致的。终点数量与提供的$p$值数量相匹配。任务定义清晰，并且从前提出发逻辑上是连贯的。\n- **无其他缺陷**：该问题没有违反任何其他验证标准。它并非不切实际、不适定、微不足道或无法验证。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将推导解决方案。\n\n### 解决方案推导\n该问题要求计算四个共同主要终点的Holm–Bonferroni校正$p$值，并随后确定其统计显著性。\n\n总体错误率（FWER）是在一系列假设检验中犯至少一次I类错误（即错误地拒绝一个为真的零假设）的概率。Holm–Bonferroni方法在预先指定的水平$\\alpha$上提供了对FWER的强力控制。对于给定的假设$H_i$，其校正$p$值$\\tilde{p}_i$被定义为能使该假设$H_i$被此程序拒绝的最小FWER水平$\\alpha$。如果一个终点的校正$p$值小于或等于期望的FWER水平$\\alpha$，则该终点被认为是统计显著的。\n\nHolm–Bonferroni程序的执行步骤如下：\n1.  设有$m$个零假设，$H_1, \\dots, H_m$，及其对应的未校正$p$值，$p_1, \\dots, p_m$。在本题中，$m=4$。\n2.  将$p$值从小到大排序：$p_{(1)} \\leq p_{(2)} \\leq \\dots \\leq p_{(m)}$。令对应的假设为$H_{(1)}, \\dots, H_{(m)}$。\n3.  第$k$个有序假设的Holm–Bonferroni校正$p$值$\\tilde{p}_{(k)}$通过递归计算以确保单调性。公式为：\n    $$ \\tilde{p}_{(k)} = \\max \\left\\{ \\tilde{p}_{(k-1)}, (m-k+1)p_{(k)} \\right\\} \\quad \\text{for } k > 1 $$\n    基础情况为：\n    $$ \\tilde{p}_{(1)} = (m-1+1)p_{(1)} = m \\cdot p_{(1)} $$\n    这等价于紧凑定义：\n    $$ \\tilde{p}_{(k)} = \\max_{j=1, \\dots, k} \\left\\{ (m-j+1) p_{(j)} \\right\\} $$\n\n让我们将此程序应用于给定数据。\n假设数量为$m=4$。\n未校正的$p$值按原始顺序给出为$(p_1, p_2, p_3, p_4) = (0.01, 0.03, 0.04, 0.20)$。\n\n首先，我们对$p$值进行排序。在本例中，给出的$p$值已经按非递减顺序排好：\n$$ p_{(1)} = 0.01, \\quad p_{(2)} = 0.03, \\quad p_{(3)} = 0.04, \\quad p_{(4)} = 0.20 $$\n排序后的假设$H_{(k)}$与原始假设$H_k$直接对应，即$H_{(1)}=H_1, H_{(2)}=H_2$，依此类推。\n\n现在，我们为每个有序假设计算校正$p$值$\\tilde{p}_{(k)}$。如果任何计算结果超过1.0，我们会将其限制在1.0，因为$p$值不能大于1。\n\n对于$k=1$：\n$$ \\tilde{p}_{(1)} = m \\cdot p_{(1)} = 4 \\times 0.01 = 0.04 $$\n\n对于$k=2$：\n中间值为 $(m-2+1)p_{(2)} = 3 \\times 0.03 = 0.09$。\n$$ \\tilde{p}_{(2)} = \\max(\\tilde{p}_{(1)}, 0.09) = \\max(0.04, 0.09) = 0.09 $$\n\n对于$k=3$：\n中间值为 $(m-3+1)p_{(3)} = 2 \\times 0.04 = 0.08$。\n$$ \\tilde{p}_{(3)} = \\max(\\tilde{p}_{(2)}, 0.08) = \\max(0.09, 0.08) = 0.09 $$\n\n对于$k=4$：\n中间值为 $(m-4+1)p_{(4)} = 1 \\times 0.20 = 0.20$。\n$$ \\tilde{p}_{(4)} = \\max(\\tilde{p}_{(3)}, 0.20) = \\max(0.09, 0.20) = 0.20 $$\n\n计算得出的有序假设的校正$p$值为$(0.04, 0.09, 0.09, 0.20)$。由于原始顺序与排序后的顺序相同，这些分别是终点1、2、3和4的校正$p$值：\n$$ (\\tilde{p}_1, \\tilde{p}_2, \\tilde{p}_3, \\tilde{p}_4) = (0.04, 0.09, 0.09, 0.20) $$\n\n问题要求将每个值四舍五入到四位有效数字：\n- $\\tilde{p}_1 = 0.04 \\rightarrow 0.04000$\n- $\\tilde{p}_2 = 0.09 \\rightarrow 0.09000$\n- $\\tilde{p}_3 = 0.09 \\rightarrow 0.09000$\n- $\\tilde{p}_4 = 0.20 \\rightarrow 0.2000$\n\n接下来，我们确定在FWER水平$\\alpha = 0.05$下有多少个终点仍然显著。如果一个终点的校正$p$值小于或等于$\\alpha$，则该终点是显著的。\n- 终点1：$\\tilde{p}_1 = 0.04000 \\leq 0.05$。该终点是显著的。\n- 终点2：$\\tilde{p}_2 = 0.09000 > 0.05$。该终点不显著。\n- 终点3：$\\tilde{p}_3 = 0.09000 > 0.05$。该终点不显著。\n- 终点4：$\\tilde{p}_4 = 0.2000 > 0.05$。该终点不显著。\n\n因此，在使用Holm–Bonferroni程序控制FWER后，只有一个终点保持统计显著性。显著终点的数量为$1$。\n\n最终答案要求一个单行矩阵，其中包含按原始顺序排列的四个校正$p$值（四舍五入至四位有效数字）以及显著终点的数量。该矩阵为$(0.04000, 0.09000, 0.09000, 0.2000, 1)$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.04000  0.09000  0.09000  0.2000  1 \\end{pmatrix} } $$", "id": "4541012"}]}