{"hands_on_practices": [{"introduction": "药物警戒的第一步通常是分析自发报告系统 (Spontaneous Reporting Systems, SRS) 中的海量数据，以识别潜在的药物安全信号。此练习将引导您使用经典的 $2 \\times 2$ 列联表，这是信号检测的基石。您将亲手计算不成比例报告分析中的关键指标，如比例报告比 (Proportional Reporting Ratio, PRR)，并应用统计检验来评估信号的强度，这是从庞杂数据中筛选出需进一步研究的药物-事件关联的核心技能[@problem_id:4581807]。", "problem": "一家制药公司正在使用自发报告数据库进行常规的上市后监测，以监控药物不良反应。考虑一个特定药物-事件对的标准 $2 \\times 2$ 计数表，其中 $a$ 表示同时包含该药物和该事件的报告数，$b$ 表示包含该药物但不包含该事件的报告数，$c$ 表示包含其他药物和该事件的报告数，$d$ 表示包含其他药物但不包含该事件的报告数。观测到的计数为 $a=40$，$b=960$，$c=100$ 和 $d=4900$。\n\n仅使用药物警戒学中的基本定义和经过充分检验的统计近似方法：\n\n- 定义并计算比例报告比（Proportional Reporting Ratio, PRR），其定义为涉及该药物的报告中事件的报告比例与涉及所有其他药物的报告中事件的报告比例之比。\n- 通过对比例之比的对数应用大样本正态近似，然后取指数返回到原始尺度，为PRR构建一个双侧 $95\\%$ 置信区间（CI）。\n- 计算 $2 \\times 2$ 表中独立性的皮尔逊卡方检验统计量。\n\n假设信号检测遵循广泛使用的 Evans 法则：当且仅当 $\\mathrm{PRR} \\ge 2$，自由度为 $1$ 的皮尔逊卡方统计量满足 $\\chi^{2} \\ge 4$，并且共现计数满足 $a \\ge 3$ 时，标记一个信号。\n\n报告以下内容：\n1. $\\mathrm{PRR}$ 值，四舍五入到四位有效数字。\n2. $\\mathrm{PRR}$ 的 $95\\%$ $\\mathrm{CI}$ 的下限和上限，均四舍五入到四位有效数字。\n3. 皮尔逊 $\\chi^{2}$ 值，四舍五入到四位有效数字。\n4. 最后，定义决策指标 $S$，如果所有三个 Evans 标准都满足，则 $S=1$，否则 $S=0$。提供 $S$ 的单个数值作为最终答案。最终答案应表示为一个没有单位的纯数字。", "solution": "首先验证问题，以确保其具有科学依据、提法明确且客观。\n\n**第 1 步：提取已知信息**\n提供了关于自发报告数据库中一个药物-事件对的 $2 \\times 2$ 列联表的以下数据：\n- $a = 40$：包含特定药物和事件的报告数。\n- $b = 960$：包含特定药物但不包含事件的报告数。\n- $c = 100$：包含其他药物和事件的报告数。\n- $d = 4900$：包含其他药物但不包含事件的报告数。\n- 任务要求计算比例报告比（$\\mathrm{PRR}$）、其双侧 $95\\%$ 置信区间（$\\mathrm{CI}$）以及皮尔逊卡方（$\\chi^2$）统计量。\n- 一个信号检测规则，即 Evans 法则，由三个条件定义：\n    1. $\\mathrm{PRR} \\ge 2$\n    2. $\\chi^2 \\ge 4$ (自由度为 $1$)\n    3. $a \\ge 3$\n- 最终输出是一个决策指标 $S$，如果所有三个条件都满足，则 $S=1$，否则 $S=0$。\n\n**第 2 步：使用提取的已知信息进行验证**\n该问题定义明确且科学上合理。它采用了药物警戒学（临床药理学的一个分支学科）中使用的标准统计方法（$\\mathrm{PRR}$、$\\chi^2$ 检验、置信区间）。所有必要数据（$a、b、c、d$）均已提供，待计算的指标有明确定义或是标准指标。Evans 法则的标准也已清楚说明。该问题是自洽的、一致的，并直接对应于一个形式化且可解的统计程序。没有科学缺陷、歧义或信息缺失。\n\n**第 3 步：结论与行动**\n该问题有效。将提供完整的解答。\n\n**求解过程**\n\n我们将给定的计数整理成一个标准的 $2 \\times 2$ 表：\n\n|              | 事件 | 无事件 | 合计     |\n|--------------|-------|----------|-----------|\n| 药物         | $a=40$  | $b=960$    | $a+b=1000$  |\n| 其他药物  | $c=100$ | $d=4900$   | $c+d=5000$  |\n| 合计        | $a+c=140$ | $b+d=5860$ | $N=6000$    |\n\n**1. 比例报告比 (PRR)**\n\n$\\mathrm{PRR}$ 定义为目标药物的事件报告比例与所有其他药物的事件报告比例之比。\n\n特定药物的事件报告比例为：\n$$P_1 = \\frac{a}{a+b}$$\n其他药物的事件报告比例为：\n$$P_2 = \\frac{c}{c+d}$$\n$\\mathrm{PRR}$ 由下式给出：\n$$\\mathrm{PRR} = \\frac{P_1}{P_2} = \\frac{a / (a+b)}{c / (c+d)}$$\n代入给定值：\n$$a+b = 40 + 960 = 1000$$\n$$c+d = 100 + 4900 = 5000$$\n$$P_1 = \\frac{40}{1000} = 0.04$$\n$$P_2 = \\frac{100}{5000} = 0.02$$\n$$\\mathrm{PRR} = \\frac{0.04}{0.02} = 2$$\n四舍五入到四位有效数字，$\\mathrm{PRR}$ 为 $2.000$。\n\n**2. PRR 的 $95\\%$ 置信区间**\n\n$95\\%$ $\\mathrm{CI}$ 是通过对 $\\mathrm{PRR}$ 的自然对数应用大样本正态近似来构建的。$\\ln(\\mathrm{PRR})$ 的标准误（$\\mathrm{SE}$）由下式给出：\n$$\\mathrm{SE}(\\ln(\\mathrm{PRR})) = \\sqrt{\\frac{1-P_1}{a} + \\frac{1-P_2}{c}} = \\sqrt{\\frac{b}{a(a+b)} + \\frac{d}{c(c+d)}}$$\n代入数值：\n$$\\mathrm{SE}(\\ln(\\mathrm{PRR})) = \\sqrt{\\frac{960}{40(1000)} + \\frac{4900}{100(5000)}} = \\sqrt{\\frac{960}{40000} + \\frac{4900}{500000}}$$\n$$\\mathrm{SE}(\\ln(\\mathrm{PRR})) = \\sqrt{0.024 + 0.0098} = \\sqrt{0.0338} \\approx 0.18384776$$\n计算出的 $\\mathrm{PRR}$ 的自然对数为：\n$$\\ln(\\mathrm{PRR}) = \\ln(2) \\approx 0.69314718$$\n$\\ln(\\mathrm{PRR})$ 的双侧 $95\\%$ $\\mathrm{CI}$ 构建为 $\\ln(\\mathrm{PRR}) \\pm Z_{1-\\alpha/2} \\times \\mathrm{SE}(\\ln(\\mathrm{PRR}))$。对于 $95\\%$ $\\mathrm{CI}$，$\\alpha=0.05$，来自标准正态分布的临界值为 $Z_{0.975} \\approx 1.96$。\n误差范围是：\n$$ME = 1.96 \\times \\sqrt{0.0338} \\approx 1.96 \\times 0.18384776 \\approx 0.3603416$$\n$\\ln(\\mathrm{PRR})$ 的置信区间为：\n$$CI_{\\ln(\\mathrm{PRR})} = [0.69314718 - 0.3603416, \\ 0.69314718 + 0.3603416]$$\n$$CI_{\\ln(\\mathrm{PRR})} = [0.33280558, \\ 1.05348878]$$\n为了得到 $\\mathrm{PRR}$ 的 $\\mathrm{CI}$，我们对上下限取指数：\n$$CI_{\\mathrm{PRR}} = [\\exp(0.33280558), \\ \\exp(1.05348878)]$$\n$$CI_{\\mathrm{PRR}} = [1.39487, \\ 2.86765]$$\n将下限和上限四舍五入到四位有效数字，得到 $[1.395, 2.868]$。\n\n**3. 皮尔逊卡方检验统计量 ($\\chi^2$)**\n\n不带连续性校正的 $2 \\times 2$ 表的皮尔逊 $\\chi^2$ 统计量由以下公式给出：\n$$\\chi^2 = \\frac{N(ad-bc)^2}{(a+b)(c+d)(a+c)(b+d)}$$\n其中 $N=a+b+c+d$ 是报告总数。\n首先，我们计算必要的总和与项：\n$$N = 6000$$\n$$a+b = 1000$$\n$$c+d = 5000$$\n$$a+c = 140$$\n$$b+d = 5860$$\n$$ad-bc = (40)(4900) - (960)(100) = 196000 - 96000 = 100000$$\n现在，将这些值代入 $\\chi^2$ 公式：\n$$\\chi^2 = \\frac{6000 \\times (100000)^2}{1000 \\times 5000 \\times 140 \\times 5860} = \\frac{6 \\times 10^3 \\times 10^{10}}{ (10^3) \\times (5 \\times 10^3) \\times (1.4 \\times 10^2) \\times (5.86 \\times 10^3)}$$\n$$\\chi^2 = \\frac{6 \\times 10^{13}}{4.102 \\times 10^{12}} = \\frac{60}{4.102} \\approx 14.627011$$\n四舍五入到四位有效数字，$\\chi^2$ 值为 $14.63$。\n\n**4. 决策指标 ($S$)**\n\n决策指标 $S$ 通过应用 Evans 法则的标准来确定：\n1.  **$\\mathrm{PRR} \\ge 2$ 是否成立？**\n    我们计算出的 $\\mathrm{PRR}$ 为 $2.000$。因为 $2.000 \\ge 2$，此条件满足。\n2.  **$\\chi^2 \\ge 4$ 是否成立？**\n    我们计算出的 $\\chi^2$ 约等于 $14.63$。因为 $14.63 \\ge 4$，此条件满足。\n3.  **$a \\ge 3$ 是否成立？**\n    给定计数为 $a=40$。因为 $40 \\ge 3$，此条件满足。\n\n由于 Evans 法则的所有三个条件都得到满足，因此标记一个信号。所以，决策指标 $S$ 等于 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "4581807"}, {"introduction": "在自发报告系统中检测到安全信号仅仅是开始，并不能证明因果关系。下一步关键步骤是设计严谨的流行病学研究（如队列研究）来对该信号进行评估和验证。本练习聚焦于研究设计中的一个核心环节：样本量估算，您将学习如何计算所需的研究观察人时，以确保研究有足够的统计效力 (power) 来检测到预设的风险差异，这是将信号侦测转化为严谨科学验证的关键桥梁[@problem_id:4581790]。", "problem": "一个国家级上市后（IV期）主动安全性监测项目正计划进行一项平行组队列研究，旨在评估启用一种新的抗高血压药物是否会相对于活性对照药增加某一特定罕見不良事件的发生率。假设遵循以下具有科学依据的设计和建模假设，这些假设在罕见事件的药物警戒中是标准做法：\n\n- 在每个暴露组（新药组和对照药组）中，不良事件源于一个独立的、齐次的泊松过程，其恒定风险率为每人年 $\\lambda$，并且删失为非信息性删失。\n- 对照药组的基线风险率为 $\\lambda_{0} = 1/10{,}000$ 人年$^{-1}$。\n- 该研究旨在检测出为 $\\theta = 1.5$ 的率比（IRR），该率比定义为 $\\theta = \\lambda_{1}/\\lambda_{0}$。\n- 设计上为每个组分配相等的人时，即 $T_{0} = T_{1} = T$ 人年。\n- 不存在超出泊松方差的过度离散，且事件足够罕见，使得泊松近似有效。\n- 分析将采用基于率比对数的大样本Wald检验，检验原假设 $H_{0}: \\theta = 1$ 与双侧备择假设 $H_{1}: \\theta \\neq 1$。\n- 要求的操作特征为：双侧显著性水平 $\\alpha = 0.05$，以及在备择假设 $\\theta = 1.5$ 下的检验效能 $1-\\beta = 0.80$。\n\n从泊松模型和通过delta方法得到的率比对数最大似然估计量（MLE）的渐近正态性出发，推导出每组所需的最少人时 $T$，以使Wald检验在备择假设下达到所述的检验效能。然后计算两个暴露组总共需要的人时 $2T$（以人年为单位）。将最终答案表示为两个暴露组总共需要的人年数，并将最终答案四舍五入至三位有效数字。", "solution": "本问题要求计算一项比较泊松发生率的双组队列研究所需的样本量（以总人时表示）。目标是推导出每组所需人时 $T$ 的公式，然后计算两组总人时 $2T$，以满足指定的统计检验效能和显著性水平。\n\n设 $N_0$ 和 $N_1$ 分别为在对照药组（组0）和新药组（组1）中观测到的不良事件数。组0的随访人时为 $T_0$，组1的随访人时为 $T_1$。根据问题陈述，研究设计分配了相等的人时，因此 $T_0 = T_1 = T$。\n\n每组的事件数被建模为独立的泊松过程。因此，随机变量 $N_0$ 和 $N_1$ 服从泊松分布：\n$$ N_0 \\sim \\text{Poisson}(\\lambda_0 T) $$\n$$ N_1 \\sim \\text{Poisson}(\\lambda_1 T) $$\n其中 $\\lambda_0$ 和 $\\lambda_1$ 分别是对照药组和新药组的恒定风险率（事件/人年）。预期事件数分别为 $E[N_0] = \\lambda_0 T$ 和 $E[N_1] = \\lambda_1 T$。\n\n率比（IRR）定义为 $\\theta = \\lambda_1 / \\lambda_0$。发生率的最大似然估计量（MLEs）为 $\\hat{\\lambda}_0 = N_0/T$ 和 $\\hat{\\lambda}_1 = N_1/T$。根据最大似然估计量的不变性，IRR的MLE为 $\\hat{\\theta} = \\hat{\\lambda}_1 / \\hat{\\lambda}_0 = N_1/N_0$。分析在对数尺度上进行，因此我们感兴趣的估计量是 $\\ln(\\hat{\\theta})$。\n\n对于大样本Wald检验，我们需要 $\\ln(\\hat{\\theta})$ 的渐近分布。这可以通过delta方法得到。该估计量是 $\\hat{\\lambda}_0$ 和 $\\hat{\\lambda}_1$ 的函数，具体为 $g(\\hat{\\lambda}_0, \\hat{\\lambda}_1) = \\ln(\\hat{\\lambda}_1) - \\ln(\\hat{\\lambda}_0)$。$\\ln(\\hat{\\theta})$ 的渐近方差由下式给出：\n$$ \\text{Var}(\\ln(\\hat{\\theta})) \\approx \\left(\\frac{\\partial g}{\\partial \\lambda_1}\\right)^2 \\text{Var}(\\hat{\\lambda}_1) + \\left(\\frac{\\partial g}{\\partial \\lambda_0}\\right)^2 \\text{Var}(\\hat{\\lambda}_0) $$\n均值为 $\\mu$ 的泊松分布随机变量 $N$ 的方差为 $\\text{Var}(N) = \\mu$。因此，率估计量的方差为：\n$$ \\text{Var}(\\hat{\\lambda}_0) = \\text{Var}(N_0/T) = \\frac{1}{T^2}\\text{Var}(N_0) = \\frac{\\lambda_0 T}{T^2} = \\frac{\\lambda_0}{T} $$\n$$ \\text{Var}(\\hat{\\lambda}_1) = \\text{Var}(N_1/T) = \\frac{1}{T^2}\\text{Var}(N_1) = \\frac{\\lambda_1 T}{T^2} = \\frac{\\lambda_1}{T} $$\n在真实率 $(\\lambda_0, \\lambda_1)$ 处求得的 g 的偏导数为：\n$$ \\frac{\\partial g}{\\partial \\lambda_1} = \\frac{1}{\\lambda_1} \\quad \\text{和} \\quad \\frac{\\partial g}{\\partial \\lambda_0} = -\\frac{1}{\\lambda_0} $$\n将这些代入方差公式：\n$$ \\text{Var}(\\ln(\\hat{\\theta})) \\approx \\left(\\frac{1}{\\lambda_1}\\right)^2 \\left(\\frac{\\lambda_1}{T}\\right) + \\left(-\\frac{1}{\\lambda_0}\\right)^2 \\left(\\frac{\\lambda_0}{T}\\right) = \\frac{1}{\\lambda_1 T} + \\frac{1}{\\lambda_0 T} $$\n这个方差等于预期事件数倒数之和：$\\frac{1}{E[N_1]} + \\frac{1}{E[N_0]}$。\n\n假设检验为原假设 $H_0: \\theta = 1$ 对双侧备择假设 $H_1: \\theta \\neq 1$。在对数尺度上，这便是 $H_0: \\ln(\\theta) = 0$ 对 $H_1: \\ln(\\theta) \\neq 0$。对于显著性水平为 $\\alpha$、检验效能为 $1-\\beta$ 的双侧检验，其样本量公式通过标准正态分位数 $z_{1-\\alpha/2}$ 和 $z_{1-\\beta}$ 将效应量与其方差联系起来：\n$$ (\\ln(\\theta))^2 = (z_{1-\\alpha/2} + z_{1-\\beta})^2 \\cdot \\text{Var}(\\ln(\\hat{\\theta})) $$\n方差项在备择假设（即 $\\lambda_1 = \\theta \\lambda_0$）下进行评估。\n$$ (\\ln(\\theta))^2 = (z_{1-\\alpha/2} + z_{1-\\beta})^2 \\left( \\frac{1}{\\lambda_0 T} + \\frac{1}{\\lambda_1 T} \\right) $$\n现在我们可以解出每组的人时 $T$：\n$$ T (\\ln(\\theta))^2 = (z_{1-\\alpha/2} + z_{1-\\beta})^2 \\left( \\frac{1}{\\lambda_0} + \\frac{1}{\\lambda_1} \\right) $$\n$$ T = \\frac{(z_{1-\\alpha/2} + z_{1-\\beta})^2}{(\\ln(\\theta))^2} \\left( \\frac{1}{\\lambda_0} + \\frac{1}{\\lambda_1} \\right) $$\n\n现在我们将给定值代入此公式：\n- 显著性水平：$\\alpha = 0.05$（双侧），因此 $z_{1-\\alpha/2} = z_{0.975} \\approx 1.95996$。\n- 检验效能：$1-\\beta = 0.80$，因此 $z_{1-\\beta} = z_{0.80} \\approx 0.84162$。\n- 基线风险率：$\\lambda_0 = 1/10{,}000 = 10^{-4}$ 人年$^{-1}$。\n- 备择假设下的率比：$\\theta = 1.5$。\n- 备择假设下新药组的风险率：$\\lambda_1 = \\theta \\lambda_0 = 1.5 \\times 10^{-4}$ 人年$^{-1}$。\n\n我们来计算公式的各个组成部分：\n$$ z_{1-\\alpha/2} + z_{1-\\beta} \\approx 1.95996 + 0.84162 = 2.80158 $$\n$$ (\\ln(\\theta))^2 = (\\ln(1.5))^2 \\approx (0.405465)^2 \\approx 0.164402 $$\n$$ \\frac{1}{\\lambda_0} + \\frac{1}{\\lambda_1} = \\frac{1}{10^{-4}} + \\frac{1}{1.5 \\times 10^{-4}} = 10000 + \\frac{10000}{1.5} = 10000 \\left(1 + \\frac{2}{3}\\right) = 10000 \\left(\\frac{5}{3}\\right) = \\frac{50000}{3} $$\n将这些值代回 T 的表达式中：\n$$ T \\approx \\frac{(2.80158)^2}{0.164402} \\left( \\frac{50000}{3} \\right) \\approx \\frac{7.84885}{0.164402} \\times \\frac{50000}{3} \\approx 47.7418 \\times 16666.67 \\approx 795697 \\text{ 人年} $$\n这是单组所需的人时。问题要求的是两个暴露组总共需要的人时，即 $2T$。\n$$ 2T \\approx 2 \\times 795697 = 1591394 \\text{ 人年} $$\n最后，我们必须将此结果四舍五入至三位有效数字。\n$$ 1591394 \\approx 1590000 $$\n用科学记数法表示，即 $1.59 \\times 10^6$ 人年。\n每组的预期事件数将是 $E[N_0] = \\lambda_0 T \\approx 10^{-4} \\times 795697 \\approx 79.6$ 和 $E[N_1] = \\lambda_1 T \\approx 1.5 \\times 10^{-4} \\times 795697 \\approx 119.4$。这些计数足够大，证明使用大样本正态近似是合理的。", "answer": "$$\\boxed{1.59 \\times 10^{6}}$$", "id": "4581790"}, {"introduction": "观察性研究是上市后药物警戒的支柱，但它们极易受到各种偏倚的影响，尤其是混杂偏倚。因此，仅仅报告观察到的风险比 (Risk Ratio, RR) 是不够的，我们必须审慎评估并量化潜在偏倚的影响。这项高级练习将向您介绍一种重要的工具——定量偏倚分析 (Quantitative Bias Analysis, QBA)，它能够帮助我们估计未测量的混杂因素如何扭曲了观察结果，并据此计算出经偏倚校正后的真实效应估计值[@problem_id:4581818]。", "problem": "一项在临床药理学中进行的多国上市后监测（IV期）队列研究，在常规药物警戒期间，评估了一种新上市的抗心律失常药物与一种严重药物不良反应（ADR）——室性心律失常——的发生之间的关联。观察到的关联以风险比（RR）量化，报告为 $RR_{\\text{obs}}=1.5$。研究人员怀疑，由于同时使用其他已知具有QT间期延长潜力的药物而存在未测量的混杂因素，该混杂因素被记作一个二元未测量混杂因素（U），它独立于新药增加了室性心律失常的风险。\n\n假设在定量偏倚分析（QBA）框架内，通过外部数据源和专家启发获得了以下科学上合理的偏倚参数：\n- 在暴露于新药的个体中，$U$ 的患病率为 $P(U=1 \\mid A=1)=p_{1}=0.35$。\n- 在未暴露于新药的个体中，$U$ 的患病率为 $P(U=1 \\mid A=0)=p_{0}=0.20$。\n- 混杂因素-结局风险比，假设在各暴露分层中恒定（无暴露导致的效应修饰），为 $RR_{UY}=2.4$，其中 $RR_{UY}=\\frac{R(Y=1 \\mid U=1, A=a)}{R(Y=1 \\mid U=0, A=a)}$ 对于 $a \\in \\{0,1\\}$。\n\n从风险的基本定义和全概率定律出发，且不使用任何预先指定的快捷公式，推导出一个表达式，该表达式用 $p_{1}$、$p_{0}$ 和 $RR_{UY}$ 来关联观察到的风险比 $RR_{\\text{obs}}$ 与无混杂时的因果风险比 $RR_{\\text{true}}$。使用此表达式，在给定 $RR_{\\text{obs}}=1.5$、$p_{1}=0.35$、$p_{0}=0.20$ 和 $RR_{UY}=2.4$ 的情况下，计算经偏倚校正的估计值 $RR_{\\text{true}}$。最终答案以纯数字形式表示，并四舍五入到四位有效数字。", "solution": "该问题要求从一个被未测量混杂因素扭曲的观察风险比 $RR_{\\text{obs}}$ 中，推导出经偏倚校正的因果风险比 $RR_{\\text{true}}$。推导过程必须从第一性原理出发，特别是全概率定律，然后将所得公式应用于所提供的数值数据。\n\n首先，我们定义所涉及的变量：\n- $A$：暴露于新的抗心律失常药物，其中 $A=1$ 表示暴露，$A=0$ 表示未暴露。\n- $Y$：不良结局（室性心律失常）的发生，其中 $Y=1$ 表示事件发生，$Y=0$ 表示未发生。\n- $U$：未测量的混杂因素（同时使用QT间期延长药物），其中 $U=1$ 表示存在，$U=0$ 表示不存在。\n\n观察风险比 $RR_{\\text{obs}}$ 定义为暴露组中结局风险与非暴露组中结局风险之比。\n$$\nRR_{\\text{obs}} = \\frac{P(Y=1 \\mid A=1)}{P(Y=1 \\mid A=0)}\n$$\n我们将暴露组中的观察风险记为 $R_1^{\\text{obs}} = P(Y=1 \\mid A=1)$，非暴露组中的观察风险记为 $R_0^{\\text{obs}} = P(Y=1 \\mid A=0)$。\n\n为了考虑二元混杂因素 $U$，我们可以通过对 $U$ 的分层进行条件化并应用全概率定律来表达这些观察风险。\n\n对于暴露组（$A=1$）：\n$$\nR_1^{\\text{obs}} = P(Y=1 \\mid A=1) = P(Y=1 \\mid A=1, U=1)P(U=1 \\mid A=1) + P(Y=1 \\mid A=1, U=0)P(U=0 \\mid A=1)\n$$\n\n对于非暴露组（$A=0$）：\n$$\nR_0^{\\text{obs}} = P(Y=1 \\mid A=0) = P(Y=1 \\mid A=0, U=1)P(U=1 \\mid A=0) + P(Y=1 \\mid A=0, U=0)P(U=0 \\mid A=0)\n$$\n\n现在，我们引入问题陈述中提供的参数：\n- 暴露组中混杂因素的患病率：$p_1 = P(U=1 \\mid A=1)$。因此，$P(U=0 \\mid A=1) = 1 - p_1$。\n- 非暴露组中混杂因素的患病率：$p_0 = P(U=1 \\mid A=0)$。因此，$P(U=0 \\mid A=0) = 1 - p_0$。\n- 混杂因素-结局风险比，在各暴露分层中恒定：$RR_{UY} = \\frac{P(Y=1 \\mid U=1, A=a)}{P(Y=1 \\mid U=0, A=a)}$ 对于 $a \\in \\{0, 1\\}$。\n\n根据 $RR_{UY}$ 的定义，我们可以将 $U=1$ 分层中的风险用 $U=0$ 分层中的风险来表示，对于每个暴露水平 $A$：\n$$\nP(Y=1 \\mid U=1, A=1) = RR_{UY} \\cdot P(Y=1 \\mid U=0, A=1)\n$$\n$$\nP(Y=1 \\mid U=1, A=0) = RR_{UY} \\cdot P(Y=1 \\mid U=0, A=0)\n$$\n问题要求的是“无混杂时的因果风险比”，即 $RR_{\\text{true}}$。这是在混杂因素的各分层内观察到的风险比，假设它在这些分层中是恒定的（即，不存在由 $U$ 引起的效应修饰）。我们将这个真实风险比定义为：\n$$\nRR_{\\text{true}} = \\frac{P(Y=1 \\mid A=1, U=0)}{P(Y=1 \\mid A=0, U=0)} = \\frac{P(Y=1 \\mid A=1, U=1)}{P(Y=1 \\mid A=0, U=1)}\n$$\n第二个等式成立是因为如果 $RR_{AY|U=0} \\neq RR_{AY|U=1}$，则该问题将无法明确定义。用于此类偏倚分析的标准模型假设了这种同质性。我们将基线风险，即没有混杂因素的非暴露个体的风险，记为 $R_{00} = P(Y=1 \\mid A=0, U=0)$。那么，没有混杂因素的暴露个体的风险是 $R_{10} = P(Y=1 \\mid A=1, U=0) = RR_{\\text{true}} \\cdot R_{00}$。\n\n现在，我们将这些表达式代回到观察风险的方程中。\n\n对于 $R_1^{\\text{obs}}$：\n$$\nR_1^{\\text{obs}} = (RR_{UY} \\cdot P(Y=1 \\mid U=0, A=1)) \\cdot p_1 + P(Y=1 \\mid U=0, A=1) \\cdot (1 - p_1)\n$$\n$$\nR_1^{\\text{obs}} = P(Y=1 \\mid A=1, U=0) \\left[ p_1 \\cdot RR_{UY} + (1 - p_1) \\right]\n$$\n$$\nR_1^{\\text{obs}} = R_{10} \\left[ 1 + p_1(RR_{UY} - 1) \\right]\n$$\n\n对于 $R_0^{\\text{obs}}$：\n$$\nR_0^{\\text{obs}} = (RR_{UY} \\cdot P(Y=1 \\mid U=0, A=0)) \\cdot p_0 + P(Y=1 \\mid U=0, A=0) \\cdot (1 - p_0)\n$$\n$$\nR_0^{\\text{obs}} = P(Y=1 \\mid A=0, U=0) \\left[ p_0 \\cdot RR_{UY} + (1 - p_0) \\right]\n$$\n$$\nR_0^{\\text{obs}} = R_{00} \\left[ 1 + p_0(RR_{UY} - 1) \\right]\n$$\n\n现在我们可以构建观察风险比 $RR_{\\text{obs}}$：\n$$\nRR_{\\text{obs}} = \\frac{R_1^{\\text{obs}}}{R_0^{\\text{obs}}} = \\frac{R_{10} \\left[ 1 + p_1(RR_{UY} - 1) \\right]}{R_{00} \\left[ 1 + p_0(RR_{UY} - 1) \\right]}\n$$\n认识到 $\\frac{R_{10}}{R_{00}} = \\frac{P(Y=1 \\mid A=1, U=0)}{P(Y=1 \\mid A=0, U=0)} = RR_{\\text{true}}$，我们得到所求的表达式：\n$$\nRR_{\\text{obs}} = RR_{\\text{true}} \\cdot \\frac{1 + p_1(RR_{UY} - 1)}{1 + p_0(RR_{UY} - 1)}\n$$\n乘以 $RR_{\\text{true}}$ 的项是由混杂引起的偏倚因子。\n\n为了找到经偏倚校正的估计值 $RR_{\\text{true}}$，我们重新整理公式：\n$$\nRR_{\\text{true}} = RR_{\\text{obs}} \\cdot \\frac{1 + p_0(RR_{UY} - 1)}{1 + p_1(RR_{UY} - 1)}\n$$\n我们已知以下数值：\n- $RR_{\\text{obs}} = 1.5$\n- $p_1 = P(U=1 \\mid A=1) = 0.35$\n- $p_0 = P(U=1 \\mid A=0) = 0.20$\n- $RR_{UY} = 2.4$\n\n我们现在可以将这些值代入推导出的方程中来计算 $RR_{\\text{true}}$。\n首先，让我们计算偏倚因子的组成部分。项 $(RR_{UY} - 1)$ 为：\n$$\nRR_{UY} - 1 = 2.4 - 1 = 1.4\n$$\n现在，我们计算校正分数的分子和分母：\n$$\n\\text{分子（校正项）} = 1 + p_0(RR_{UY} - 1) = 1 + (0.20)(1.4) = 1 + 0.28 = 1.28\n$$\n$$\n\\text{分母（校正项）} = 1 + p_1(RR_{UY} - 1) = 1 + (0.35)(1.4) = 1 + 0.49 = 1.49\n$$\n最后，我们计算 $RR_{\\text{true}}$：\n$$\nRR_{\\text{true}} = 1.5 \\cdot \\frac{1.28}{1.49}\n$$\n$$\nRR_{\\text{true}} = 1.5 \\cdot 0.85906040268...\n$$\n$$\nRR_{\\text{true}} = 1.28859060402...\n$$\n按照要求，将结果四舍五入到四位有效数字，我们得到：\n$$\nRR_{\\text{true}} \\approx 1.289\n$$\n该混杂是正向的，因为混杂因素（$U$）既是结局的风险因素（$RR_{UY} > 1$），又在暴露组中更为普遍（$p_1 > p_0$）。这夸大了观察到的关联，因此经校正的真实风险比小于观察风险比，这与我们的结果（$1.289  1.5$）一致。", "answer": "$$\n\\boxed{1.289}\n$$", "id": "4581818"}]}