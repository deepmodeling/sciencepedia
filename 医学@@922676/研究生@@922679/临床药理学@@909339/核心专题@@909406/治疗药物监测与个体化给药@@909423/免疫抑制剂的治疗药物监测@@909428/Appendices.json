{"hands_on_practices": [{"introduction": "本练习旨在解决临床实践中的一个常见挑战：管理药物-药物相互作用。我们将运用线性药代动力学的基本原理，预测强效酶诱导剂对环孢素浓度的影响，并计算必要的剂量调整。这项实践强化了药物清除率、暴露量和给药方案之间的关键联系[@problem_id:4596666]。", "problem": "一名肾移植受者正在使用钙调磷酸酶抑制剂 cyclosporine 维持治疗，并通过治疗药物监测 (TDM) 将稳态给药前谷浓度（记为 $C_{0}$）作为目标。该患者在固定给药方案下已稳定数周，cyclosporine 总日剂量为 $250$ mg/day（每 $12$ 小时给药 $125$ mg），测得的 $C_{0}$ 等于个体化目标值。现开始使用强效细胞色素 P450 3A (CYP3A) 诱导剂 rifampicin。假设诱导达到稳态后，表观口服清除率 $CL/F$ 增加一个乘法因子 $\\alpha$，并且口服给药间隔保持不变，患者依从性完美，且 cyclosporine 的药代动力学在治疗范围内呈线性。再假设吸收和分布速率常数不随时间变化，并且根据经验建立的 $C_{0}$ 与给药间隔内暴露量之间的线性关系对钙调磷酸酶抑制剂成立。\n\n任务1. 从核心定义和经过充分检验的事实（清除率、暴露量以及钙调磷酸酶抑制剂的 $C_{0}$ 与暴露量之间的线性关系）出发，推导当 cyclosporine 剂量不变时，rifampicin 诱导后稳态 $C_{0}$ 的预期乘法变化。用符号 $C_{0,\\text{pre}}$（使用 rifampicin 前的稳态谷浓度）、$\\alpha$ 和任何必要的常数来表示你的结果。\n\n任务2. 利用线性药代动力学和固定给药间隔下 cyclosporine 剂量与 $C_{0}$ 之间的比例关系，计算在 $\\alpha = 2.7$ 且使用 rifampicin 前的总日剂量为 $250$ mg/day 的情况下，维持原始目标 $C_{0}$ 所需的新总日剂量。将你的最终数值答案四舍五入至三位有效数字，并以 mg/day 为单位表示。", "solution": "首先将对问题陈述的科学合理性、一致性和完整性进行验证。\n\n### 步骤1：提取已知条件\n-   **药物与监测：** Cyclosporine（钙调磷酸酶抑制剂），通过治疗药物监测 (TDM) 以稳态给药前谷浓度 $C_{0}$ 为目标。\n-   **初始状态：**\n    -   总日剂量：$250$ mg/day。\n    -   给药方案：每 $12$ 小时 $125$ mg。\n    -   药代动力学状态：患者处于稳态，病情稳定，测得的 $C_{0}$ 等于目标值。\n-   **干预措施：** 开始使用 rifampicin，它是一种强效细胞色素 P450 3A (CYP3A) 诱导剂。\n-   **药代动力学变化：**\n    -   rifampicin 诱导达到稳态后，表观口服清除率 $CL/F$ 增加一个乘法因子 $\\alpha$。\n-   **假设：**\n    1.  口服给药间隔 $\\tau$ 保持不变。\n    2.  依从性完美。\n    3.  cyclosporine 的药代动力学在治疗范围内呈线性。\n    4.  吸收和分布速率常数不随时间变化。\n    5.  经验建立的 $C_{0}$ 与给药间隔内暴露量之间的线性关系成立。\n-   **任务1：** 推导当剂量不变时，rifampicin 诱导后稳态 $C_{0}$ 的预期乘法变化。用符号 $C_{0,\\text{pre}}$ 和 $\\alpha$ 表示新的 $C_0$ 的结果。\n-   **任务2：**\n    -   计算维持原始目标 $C_{0}$ 所需的新总日剂量。\n    -   已知：$\\alpha = 2.7$。\n    -   已知：使用 rifampicin 前的总日剂量为 $250$ mg/day。\n    -   要求：将最终数值答案四舍五入至三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题牢固地基于临床药理学和药代动力学的原理。所描述的 cyclosporine（一种 CYP3A 底物）和 rifampicin（一种强效 CYP3A 诱导剂）之间的相互作用是经典的、具有临床意义的药物-药物相互作用。表观口服清除率 ($CL/F$)、稳态谷浓度 ($C_{0}$)、给药间隔 ($\\tau$)、药物暴露量（曲线下面积，AUC）和线性药代动力学等概念是该领域的基础。对于钙调磷酸酶抑制剂，$C_0$ 和 AUC 之间存在线性关系的假设是临床实践中 TDM 的一个公认的经验基础。$\\alpha = 2.7$ 的值对于此类酶诱导来说是一个现实的量级。\n-   **提法恰当：** 该问题提法恰当。它提供了所有必要的数据和一组清晰、简化的假设（例如，线性药代动力学、恒定的 $\\tau$、不随时间变化的速率常数），这些假设允许得出唯一的、确定性的解。任务被明确定义。\n-   **客观性：** 问题以精确、客观和定量的语言陈述，没有任何主观或模棱两可的术语。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。它在科学上是合理的，提法恰当，客观，并且不包含内部矛盾或缺失信息。可以继续求解过程。\n\n### 解题推导\n\n**任务1：稳态谷浓度 ($C_{0}$) 变化的推导**\n\n该分析的基础在于稳态下给药、清除率和药物暴露量之间的关系。对于线性药代动力学下的口服药物，在稳态下一个给药间隔 ($\\tau$) 内的平均药物暴露量，通过浓度-时间曲线下面积 ($AUC_{\\tau,ss}$) 衡量，由该间隔内给予的剂量与表观口服清除率 ($CL/F$) 的比值给出。\n\n设 `Dose` 为每个间隔 $\\tau$ 的剂量。\n$$AUC_{\\tau,ss} = \\frac{\\text{Dose}}{CL/F}$$\n\n设 rifampicin 诱导前的状态用下标 'pre' 表示，诱导后的状态用 'post' 表示。\n\n诱导前，暴露量为：\n$$AUC_{\\tau, \\text{pre}} = \\frac{\\text{Dose}}{(CL/F)_{\\text{pre}}}$$\n\n在任务1中，剂量保持不变。rifampicin 诱导后，新的表观口服清除率由 $(CL/F)_{\\text{post}} = \\alpha \\cdot (CL/F)_{\\text{pre}}$ 给出。新的暴露量为：\n$$AUC_{\\tau, \\text{post}} = \\frac{\\text{Dose}}{(CL/F)_{\\text{post}}} = \\frac{\\text{Dose}}{\\alpha \\cdot (CL/F)_{\\text{pre}}}$$\n\n通过代入 $AUC_{\\tau, \\text{pre}}$ 的表达式，我们可以将诱导后暴露量与诱导前暴露量联系起来：\n$$AUC_{\\tau, \\text{post}} = \\frac{1}{\\alpha} \\left( \\frac{\\text{Dose}}{(CL/F)_{\\text{pre}}} \\right) = \\frac{1}{\\alpha} \\cdot AUC_{\\tau, \\text{pre}}$$\n\n问题陈述指出，谷浓度 $C_{0}$ 和暴露量 $AUC_{\\tau,ss}$ 之间存在经验建立的线性关系。这可以形式化为：\n$$C_{0} = k \\cdot AUC_{\\tau,ss}$$\n其中 $k$ 是一个比例常数。问题的假设——吸收和分布速率常数不随时间变化且给药间隔 $\\tau$ 恒定——确保了 $k$ 在诱导事件前后保持不变。\n\n将此关系应用于诱导前和诱导后状态：\n$$C_{0, \\text{pre}} = k \\cdot AUC_{\\tau, \\text{pre}}$$\n$$C_{0, \\text{post}} = k \\cdot AUC_{\\tau, \\text{post}}$$\n\n代入我们找到的 $AUC_{\\tau, \\text{post}}$ 和 $AUC_{\\tau, \\text{pre}}$ 之间的关系：\n$$C_{0, \\text{post}} = k \\cdot \\left( \\frac{1}{\\alpha} \\cdot AUC_{\\tau, \\text{pre}} \\right) = \\frac{1}{\\alpha} \\cdot (k \\cdot AUC_{\\tau, \\text{pre}})$$\n\n最后，将 $C_{0, \\text{pre}}$ 代入方程，得出新谷浓度的表达式：\n$$C_{0, \\text{post}} = \\frac{1}{\\alpha} \\cdot C_{0, \\text{pre}}$$\n此结果表明，新的稳态谷浓度与清除率增加的因子成反比。\n\n**任务2：新剂量的计算**\n\n任务2的目标是调整 cyclosporine 剂量，以抵消 rifampicin 诱导的影响，并维持原始的目标谷浓度。设所需的新剂量为 $\\text{Dose}_{\\text{new}}$，原始剂量为 $\\text{Dose}_{\\text{pre}}$。目标是实现 $C_{0, \\text{new}} = C_{0, \\text{pre}}$。\n\n使用前面推导出的连接浓度、剂量和清除率的一般关系：\n$$C_{0} = k \\cdot \\frac{\\text{Dose}}{CL/F}$$\n\n我们可以写出诱导前状态和期望的新状态的表达式：\n$$C_{0, \\text{pre}} = k \\cdot \\frac{\\text{Dose}_{\\text{pre}}}{(CL/F)_{\\text{pre}}}$$\n$$C_{0, \\text{new}} = k \\cdot \\frac{\\text{Dose}_{\\text{new}}}{(CL/F)_{\\text{post}}}$$\n\n令 $C_{0, \\text{new}} = C_{0, \\text{pre}}$：\n$$k \\cdot \\frac{\\text{Dose}_{\\text{new}}}{(CL/F)_{\\text{post}}} = k \\cdot \\frac{\\text{Dose}_{\\text{pre}}}{(CL/F)_{\\text{pre}}}$$\n\n比例常数 $k$ 消去。求解 $\\text{Dose}_{\\text{new}}$：\n$$\\text{Dose}_{\\text{new}} = \\text{Dose}_{\\text{pre}} \\cdot \\frac{(CL/F)_{\\text{post}}}{(CL/F)_{\\text{pre}}}$$\n\n代入给定的关系 $(CL/F)_{\\text{post}} = \\alpha \\cdot (CL/F)_{\\text{pre}}$：\n$$\\text{Dose}_{\\text{new}} = \\text{Dose}_{\\text{pre}} \\cdot \\frac{\\alpha \\cdot (CL/F)_{\\text{pre}}}{(CL/F)_{\\text{pre}}} = \\alpha \\cdot \\text{Dose}_{\\text{pre}}$$\n\n这表明，在清除率增加的情况下，要维持相同的谷浓度，剂量必须增加相同的乘法因子 $\\alpha$。此关系对每个间隔的剂量成立，并且由于给药间隔是恒定的，它也对总日剂量成立。\n\n设 $D_{\\text{total, pre}}$ 为使用 rifampicin 前的总日剂量，$D_{\\text{total, new}}$ 为所需的新总日剂量。\n$$D_{\\text{total, new}} = \\alpha \\cdot D_{\\text{total, pre}}$$\n\n我们已知 $D_{\\text{total, pre}} = 250$ mg/day 且 $\\alpha = 2.7$。\n$$D_{\\text{total, new}} = 2.7 \\cdot 250 \\, \\text{mg/day}$$\n$$D_{\\text{total, new}} = 675 \\, \\text{mg/day}$$\n\n结果 $675$ 有三位有效数字，符合要求。", "answer": "$$\\boxed{\\begin{array}{c} \\frac{C_{0, \\text{pre}}}{\\alpha} \\\\ 675 \\end{array}}$", "id": "4596666"}, {"introduction": "患者依从性是治疗中的一个主要变量。此问题模拟了漏服一次药物的常见情景，并要求您在单室模型中应用叠加原理。我们的目标是计算一个一次性的校正剂量，以安全、迅速地引导患者回到其治疗目标，这是个体化治疗药物监测中的一项关键技能[@problem_id:4596688]。", "problem": "一名肾移植受者正在服用速释他克莫司，给药间隔为 $\\tau = 12\\,\\mathrm{h}$，并通过治疗药物监测 (TDM) 进行管理。假设采用具有一级吸收和一级消除的单室模型。该患者的特异性药代动力学参数为：吸收速率常数 $k_{a} = 2.0\\,\\mathrm{h}^{-1}$，消除半衰期 $t_{1/2} = 10\\,\\mathrm{h}$（因此消除速率常数 $k = (\\ln 2)/t_{1/2}$）。在发生下述事件之前，患者按每 $12\\,\\mathrm{h}$ 服用 $D = 3.0\\,\\mathrm{mg}$ 的稳定方案已达到稳态，实现了稳定的给药前他克莫司全血谷浓度 $7.0\\,\\mathrm{ng/mL}$。\n\n在计划的早晨谷浓度采血前一天晚上，患者漏服了原定于计划采样时间前 $12\\,\\mathrm{h}$ 服用的那次药物。您可以假设药代动力学为线性过程，生物利用度和分布不变，为血管外给药和一级过程。使用多次给药的叠加原理和标准的单室模型口服给药解作为您的基本依据。\n\n基于这些假设，从第一性原理推导出多次口服给药后任意时间的浓度表达式，应用该表达式计算预定采样时间的残余浓度，然后确定在就诊时（预定采样时间）给予的一次性调整剂量，使得 $12\\,\\mathrm{h}$ 后的下一个给药前谷浓度恰好回到 $7.0\\,\\mathrm{ng/mL}$。以 $\\mathrm{mg}$ 为单位表示最终的调整剂量，并将您的答案四舍五入至三位有效数字。说明您基于给定参数值所做的任何合理近似。", "solution": "该问题是有效的，因为它在科学上基于已确立的药代动力学原理，问题设置合理、信息充分，并且陈述客观。\n\n在单室模型中，单次口服剂量 $D$ 后时间 $t$ 的药物浓度由下式给出：\n$$C(t) = \\frac{F D k_{a}}{V(k_{a} - k)} (\\exp(-kt) - \\exp(-k_{a}t))$$\n其中 $F$ 是生物利用度，$V$ 是表观分布容积，$k_{a}$ 是吸收速率常数，$k$ 是消除速率常数。\n\n对于以恒定给药间隔 $\\tau$ 进行的多次给药，末次给药后时间 $t$ 的稳态浓度 $C_{ss}(t)$ 可以使用叠加原理推导得出：\n$$C_{ss}(t) = \\sum_{n=0}^{\\infty} C_{1,D}(t+n\\tau) = \\frac{F D k_{a}}{V(k_{a} - k)} \\left( \\frac{\\exp(-kt)}{1 - \\exp(-k\\tau)} - \\frac{\\exp(-k_a t)}{1 - \\exp(-k_a \\tau)} \\right)$$\n稳态给药前谷浓度 $C_{ss,min}$ 出现在 $t=\\tau$ 时：\n$$C_{ss,min} = \\frac{F D k_{a}}{V(k_{a} - k)} \\left( \\frac{\\exp(-k\\tau)}{1 - \\exp(-k\\tau)} - \\frac{\\exp(-k_a \\tau)}{1 - \\exp(-k_a \\tau)} \\right)$$\n\n首先，我们根据给定的半衰期 $t_{1/2}$ 计算消除速率常数 $k$：\n$$k = \\frac{\\ln(2)}{t_{1/2}} = \\frac{\\ln(2)}{10\\,\\mathrm{h}} \\approx 0.06931\\,\\mathrm{h}^{-1}$$\n给定的参数是：\n- 剂量 $D = 3.0\\,\\mathrm{mg}$\n- 给药间隔 $\\tau = 12\\,\\mathrm{h}$\n- 吸收速率常数 $k_{a} = 2.0\\,\\mathrm{h}^{-1}$\n- 稳定谷浓度 $C_{ss,min} = 7.0\\,\\mathrm{ng/mL}$\n\n患者漏服了计划在采样时间前 $12\\,\\mathrm{h}$ 服用的药物。这意味着最后一次服药是在采样前 $24\\,\\mathrm{h}$。在漏服药物时（采样前12小时），浓度为稳态谷浓度 $C_{ss,min}$。在接下来的 $12\\,\\mathrm{h}$ 内，该浓度仅根据一级消除进行衰减。因此，采样时间的残余浓度 $C_{sample}$ 为：\n$$C_{sample} = C_{ss,min} \\cdot \\exp(-k\\tau)$$\n代入数值：\n$$k\\tau = \\left(\\frac{\\ln(2)}{10}\\right) \\times 12 = 1.2 \\ln(2) \\approx 0.83178$$\n$$C_{sample} = 7.0\\,\\mathrm{ng/mL} \\cdot \\exp(-1.2 \\ln(2)) = 7.0 \\cdot 2^{-1.2} \\approx 7.0 \\times 0.435255 = 3.0468\\,\\mathrm{ng/mL}$$\n这是预定采样时间的残余浓度。\n\n目标是在采样时间给予一个调整剂量 $D_{adj}$，使得 $12\\,\\mathrm{h}$ 后出现的下一个给药前谷浓度回到目标值 $C_{target} = 7.0\\,\\mathrm{ng/mL}$。\n\n使用叠加原理，下一个谷浓度将是两个组分之和：\n1.  在下一个给药间隔 $\\tau$ 内，残余浓度 $C_{sample}$ 的衰减。\n2.  新的单次剂量 $D_{adj}$ 在时间 $\\tau$ 后产生的浓度。\n\n设 $C_{next\\_trough}$ 为给予 $D_{adj}$ 后时间 $\\tau$ 时的浓度。\n$$C_{next\\_trough} = (C_{sample} \\cdot \\exp(-k\\tau)) + C_{1, D_{adj}}(\\tau)$$\n其中 $C_{1, D_{adj}}(\\tau)$ 是在时间 $\\tau$ 时单次调整剂量带来的浓度贡献。\n由于 $C_{sample} = C_{ss,min} \\cdot \\exp(-k\\tau)$，第一项是 $C_{ss,min} \\cdot \\exp(-2k\\tau)$。\n我们要求 $C_{next\\_trough} = C_{target} = C_{ss,min}$。\n$$C_{ss,min} = C_{ss,min} \\cdot \\exp(-2k\\tau) + C_{1, D_{adj}}(\\tau)$$\n求解调整剂量所需的浓度贡献：\n$$C_{1, D_{adj}}(\\tau) = C_{ss,min} - C_{ss,min} \\cdot \\exp(-2k\\tau) = C_{ss,min}(1 - \\exp(-2k\\tau))$$\n\n单次剂量的贡献与剂量大小成线性关系。因此，我们可以写出：\n$$\\frac{C_{1, D_{adj}}(\\tau)}{C_{1, D}(\\tau)} = \\frac{D_{adj}}{D}$$\n其中 $C_{1, D}(\\tau)$ 是标准剂量 $D = 3.0\\,\\mathrm{mg}$ 在时间 $\\tau$ 时的浓度贡献。\n单次剂量在时间 $\\tau$ 时的贡献 $C_{1, D}(\\tau)$ 与稳态谷浓度 $C_{ss,min}$ 之间的关系可以推导出来。根据定义：\n$$C_{1, D}(\\tau) = \\frac{F D k_{a}}{V(k_{a} - k)} (\\exp(-k\\tau) - \\exp(-k_{a}\\tau))$$\n$$C_{ss,min} = C_{1, D}(\\tau) \\left( \\frac{\\frac{\\exp(-k\\tau)}{1 - \\exp(-k\\tau)} - \\frac{\\exp(-k_a \\tau)}{1 - \\exp(-k_a \\tau)}}{\\exp(-k\\tau) - \\exp(-k_{a}\\tau)} \\right)$$\n对括号中的项进行代数简化，表明它等于 $\\frac{1}{(1 - \\exp(-k\\tau))(1 - \\exp(-k_{a}\\tau))}$。\n因此，精确的关系是：\n$$C_{1, D}(\\tau) = C_{ss,min} (1 - \\exp(-k\\tau))(1 - \\exp(-k_{a}\\tau))$$\n\n现在我们将 $C_{1, D_{adj}}(\\tau)$ 和 $C_{1, D}(\\tau)$ 的表达式代入剂量比率方程：\n$$\\frac{D_{adj}}{D} = \\frac{C_{ss,min}(1 - \\exp(-2k\\tau))}{C_{ss,min} (1 - \\exp(-k\\tau))(1 - \\exp(-k_{a}\\tau))}$$\n$C_{ss,min}$ 项被消去。分子是一个平方差，$1 - \\exp(-2k\\tau) = (1 - \\exp(-k\\tau))(1 + \\exp(-k\\tau))$。\n$$\\frac{D_{adj}}{D} = \\frac{(1 - \\exp(-k\\tau))(1 + \\exp(-k\\tau))}{(1 - \\exp(-k\\tau))(1 - \\exp(-k_{a}\\tau))} = \\frac{1 + \\exp(-k\\tau)}{1 - \\exp(-k_{a}\\tau)}$$\n这就得到了调整剂量的最终表达式：\n$$D_{adj} = D \\left( \\frac{1 + \\exp(-k\\tau)}{1 - \\exp(-k_{a}\\tau)} \\right)$$\n\n现在我们可以计算数值。我们有 $k_{a} = 2.0\\,\\mathrm{h}^{-1}$ 和 $\\tau = 12\\,\\mathrm{h}$，所以 $k_a\\tau = 24$。\n项 $\\exp(-k_{a}\\tau) = \\exp(-24) \\approx 3.78 \\times 10^{-11}$。这个值与 $1$ 相比极小。因此，我们可以做出合理的近似，即 $1 - \\exp(-k_{a}\\tau) \\approx 1$。这个近似是有效的，因为吸收远快于消除（$k_a \\gg k$），并且给药间隔足够长，以至于吸收几乎已经完成。\n$$D_{adj} \\approx D (1 + \\exp(-k\\tau))$$\n使用 $D = 3.0\\,\\mathrm{mg}$ 和 $\\exp(-k\\tau) = 2^{-1.2} \\approx 0.435255$：\n$$D_{adj} \\approx 3.0 \\cdot (1 + 0.435255) = 3.0 \\cdot (1.435255) = 4.305765\\,\\mathrm{mg}$$\n将结果四舍五入到三位有效数字，我们得到：\n$$D_{adj} \\approx 4.31\\,\\mathrm{mg}$$\n在就诊时给予的这个一次性调整剂量，将在下一次计划测量时将患者的给药前谷浓度恢复到 $7.0\\,\\mathrm{ng/mL}$ 的目标水平。", "answer": "$$\\boxed{4.31}$$", "id": "4596688"}, {"introduction": "现代治疗药物监测越来越依赖于使用贝叶斯预测的模型引导下精准给药 (MIPD)。这项高级练习将带您深入了解其“幕后原理”，推导用于最大后验 (MAP) 估计的数学目标函数。理解这一推导过程，能够让您深刻洞察群体模型和个体患者数据是如何结合起来，以生成个性化剂量建议的[@problem_id:4596634]。", "problem": "一名肾移植受者正在开始使用钙调神经磷酸酶抑制剂他克莫司进行治疗。治疗药物监测 (TDM) 用于个体化给药方案。考虑在时间 $t=0$ 时给予一次已知的口服剂量 $D$，其口服生物利用度为 $F$，吸收为一级过程，吸收速率常数为 $k_{a}$，消除也为一级过程，消除速率常数为 $k$。中央室容积为 $V$，清除率为 $CL$，且 $k = CL/V$。胃肠道中药物量 $A_{g}(t)$ 和中央室中药物量 $A_{c}(t)$ 的结构模型由常微分方程 (ODE) $dA_{g}/dt = -k_{a}A_{g}$ 和 $dA_{c}/dt = k_{a}A_{g} - k A_{c}$ 定义，初始条件为 $A_{g}(0) = F D$ 和 $A_{c}(0) = 0$。在时间点 $t_{1},\\dots,t_{n}$ 测量全血浓度，观测值为 $y_{1},\\dots,y_{n}$。\n\n残差变异遵循一个组合的比例加加性高斯模型：对于每次观测 $i$，有 $y_{i} = C(t_{i};\\boldsymbol{\\phi})(1 + \\varepsilon_{p,i}) + \\varepsilon_{a,i}$，其中 $C(t;\\boldsymbol{\\phi})$ 是在给定个体参数 $\\boldsymbol{\\phi}$ 时，模型在时间 $t$ 预测的浓度，$\\varepsilon_{p,i} \\sim \\mathcal{N}(0,\\sigma_{p}^{2})$，$\\varepsilon_{a,i} \\sim \\mathcal{N}(0,\\sigma_{a}^{2})$，并且所有残差误差在时间上相互独立。个体间变异在对数尺度上建模：个体参数为 $\\boldsymbol{\\phi} = (CL, V, k_{a})$，其中 $CL = CL_{\\text{pop}}\\exp(\\eta_{CL})$，$V = V_{\\text{pop}}\\exp(\\eta_{V})$，$k_{a} = k_{a,\\text{pop}}\\exp(\\eta_{k_{a}})$。随机效应向量为 $\\boldsymbol{\\eta} = (\\eta_{CL},\\eta_{V},\\eta_{k_{a}})^{\\top} \\sim \\mathcal{N}(\\boldsymbol{0},\\boldsymbol{\\Omega})$，其中协方差矩阵 $\\boldsymbol{\\Omega}$ 是已知的正定矩阵。\n\n从常微分方程和独立高斯随机变量的规则出发，完成以下任务：\n\n1. 在一级吸收和一级消除的条件下，推导 $t>0$ 时的闭合形式结构浓度函数 $C(t;\\boldsymbol{\\phi})$，并用 $F$、$D$、$V$、$k_{a}$ 和 $k$ 表示。\n2. 利用独立性和高斯假设，推导在给定 $\\boldsymbol{\\eta}$ 的条件下数据 $(y_{1},\\dots,y_{n})$ 的似然函数，并明确展示组合残差误差如何引出一个异方差高斯观测模型。\n3. 利用 Bayes 定理和关于 $\\boldsymbol{\\eta}$ 的正态先验，推导需要最小化以获得 $\\boldsymbol{\\eta}$ 的最大后验 (MAP) 估计的负对数后验函数（可忽略一个与 $\\boldsymbol{\\eta}$ 无关的加法常数）。\n\n将您的最终答案表示为该负对数后验函数的单个闭合形式解析表达式，形式为对观测时间的求和，并用 $y_{i}$、$t_{i}$、$C(t_{i};\\boldsymbol{\\phi}(\\boldsymbol{\\eta}))$、$\\sigma_{a}$、$\\sigma_{p}$ 和 $\\boldsymbol{\\Omega}$ 表示。最终答案中不要包含等号。不需要进行数值计算，也不需要在最终答案中报告单位。", "solution": "所述问题具有科学依据，提法明确，客观且内部一致。它描述了非线性混合效应模型在临床药理学（也称为药代动力学/药效学计量学）中的一个标准应用。该结构模型是一个带一级吸收的单室模型，统计模型包含了个体间变异和残差变异的标准形式，其目标是推导最大后验 (MAP) 目标函数。所有必要信息均已提供。因此，我将开始推导。\n\n推导分为所要求的三个部分。\n\n### 第1部分：结构浓度函数 $C(t;\\boldsymbol{\\phi})$ 的推导\n\n结构模型描述了药物在胃肠道中的量 $A_g(t)$ 和在中央室中的量 $A_c(t)$ 随时间变化的过程。\n\n胃肠道中的药物量由以下一阶微分方程控制：\n$$\n\\frac{dA_g}{dt} = -k_a A_g(t)\n$$\n初始条件为 $A_g(0) = FD$，其中 $F$ 是生物利用度，$D$ 是剂量。这是一个可分离的线性常微分方程 (ODE)，其解为：\n$$\nA_g(t) = A_g(0) \\exp(-k_a t) = FD \\exp(-k_a t)\n$$\n\n中央室中的药物量由以下常微分方程控制：\n$$\n\\frac{dA_c}{dt} = k_a A_g(t) - k A_c(t)\n$$\n初始条件为 $A_c(0) = 0$。代入 $A_g(t)$ 的解可得：\n$$\n\\frac{dA_c}{dt} = k_a FD \\exp(-k_a t) - k A_c(t)\n$$\n这可以重写为一个一阶线性非齐次常微分方程：\n$$\n\\frac{dA_c}{dt} + k A_c(t) = k_a FD \\exp(-k_a t)\n$$\n为了求解该方程，我们使用积分因子 $\\mu(t) = \\exp\\left(\\int k \\, dt\\right) = \\exp(kt)$。将该常微分方程两边乘以 $\\mu(t)$：\n$$\n\\exp(kt) \\frac{dA_c}{dt} + k \\exp(kt) A_c(t) = k_a FD \\exp(-k_a t) \\exp(kt)\n$$\n左边是一个乘积的导数：\n$$\n\\frac{d}{dt} \\left( A_c(t) \\exp(kt) \\right) = k_a FD \\exp((k - k_a)t)\n$$\n假设 $k_a \\neq k$ 的一般情况，对两边关于时间 $t$ 积分：\n$$\nA_c(t) \\exp(kt) = \\int k_a FD \\exp((k - k_a)t) \\, dt = \\frac{k_a FD}{k - k_a} \\exp((k - k_a)t) + C_{int}\n$$\n其中 $C_{int}$ 是积分常数。求解 $A_c(t)$：\n$$\nA_c(t) = \\frac{k_a FD}{k - k_a} \\exp(-k_a t) + C_{int} \\exp(-kt)\n$$\n我们应用初始条件 $A_c(0) = 0$：\n$$\n0 = \\frac{k_a FD}{k - k_a} \\exp(0) + C_{int} \\exp(0) = \\frac{k_a FD}{k - k_a} + C_{int}\n$$\n这得出 $C_{int} = -\\frac{k_a FD}{k - k_a}$。将其代回 $A_c(t)$ 的表达式中：\n$$\nA_c(t) = \\frac{k_a FD}{k - k_a} \\exp(-k_a t) - \\frac{k_a FD}{k - k_a} \\exp(-kt)\n$$\n提出公因子，得到 Bateman 函数：\n$$\nA_c(t) = \\frac{FD k_a}{k_a - k} \\left( \\exp(-kt) - \\exp(-k_a t) \\right)\n$$\n中央室的浓度 $C(t)$ 是药物量除以分布容积 $V$：\n$$\nC(t;\\boldsymbol{\\phi}) = \\frac{A_c(t)}{V} = \\frac{FD k_a}{V(k_a - k)} \\left( \\exp(-kt) - \\exp(-k_a t) \\right)\n$$\n参数向量为 $\\boldsymbol{\\phi} = (CL, V, k_a)$，消除速率常数 $k$ 定义为 $k = CL/V$。\n\n### 第2部分：条件似然的推导\n\n在时间 $t_i$ 的第 $i$ 次观测 $y_i$ 的模型由下式给出：\n$$\ny_i = C(t_i; \\boldsymbol{\\phi})(1 + \\varepsilon_{p,i}) + \\varepsilon_{a,i}\n$$\n其中 $C(t_i; \\boldsymbol{\\phi})$ 是模型预测的浓度，$\\varepsilon_{p,i} \\sim \\mathcal{N}(0, \\sigma_p^2)$ 是比例误差，$\\varepsilon_{a,i} \\sim \\mathcal{N}(0, \\sigma_a^2)$ 是加性误差。我们可以重写观测模型以直接描述 $y_i$ 的分布。设 $C_i = C(t_i; \\boldsymbol{\\phi})$。$y_i$ 的期望值为：\n$$\nE[y_i] = E[C_i(1 + \\varepsilon_{p,i}) + \\varepsilon_{a,i}] = C_i E[1 + \\varepsilon_{p,i}] + E[\\varepsilon_{a,i}] = C_i(1 + 0) + 0 = C_i\n$$\n利用 $\\varepsilon_{p,i}$ 和 $\\varepsilon_{a,i}$ 的独立性，$y_i$ 的方差为：\n$$\n\\text{Var}(y_i) = \\text{Var}(C_i(1 + \\varepsilon_{p,i}) + \\varepsilon_{a,i}) = \\text{Var}(C_i + C_i \\varepsilon_{p,i} + \\varepsilon_{a,i}) = \\text{Var}(C_i \\varepsilon_{p,i}) + \\text{Var}(\\varepsilon_{a,i})\n$$\n$$\n\\text{Var}(y_i) = C_i^2 \\text{Var}(\\varepsilon_{p,i}) + \\sigma_a^2 = C_i^2 \\sigma_p^2 + \\sigma_a^2\n$$\n由于 $\\varepsilon_{p,i}$ 和 $\\varepsilon_{a,i}$ 是高斯分布的，它们的线性组合也是高斯分布的。因此，在给定参数 $\\boldsymbol{\\phi}$ 的条件下，每次观测 $y_i$ 服从正态分布：\n$$\ny_i | \\boldsymbol{\\phi} \\sim \\mathcal{N}\\left( C(t_i; \\boldsymbol{\\phi}),\\; C(t_i; \\boldsymbol{\\phi})^2 \\sigma_p^2 + \\sigma_a^2 \\right)\n$$\n这表明组合误差模型引出了一个异方差高斯观测模型，其中方差是预测平均浓度的函数。单次观测 $y_i$ 的概率密度函数 (PDF) 为：\n$$\np(y_i | \\boldsymbol{\\phi}) = \\frac{1}{\\sqrt{2\\pi (C_i^2 \\sigma_p^2 + \\sigma_a^2)}} \\exp\\left( - \\frac{(y_i - C_i)^2}{2(C_i^2 \\sigma_p^2 + \\sigma_a^2)} \\right)\n$$\n由于参数 $\\boldsymbol{\\phi}$ 是随机效应向量 $\\boldsymbol{\\eta}$ 的确定性函数，因此以 $\\boldsymbol{\\phi}$ 为条件等价于以 $\\boldsymbol{\\eta}$ 为条件。残差误差在各次观测之间是独立的，因此整个数据向量 $\\mathbf{y} = (y_1, \\dots, y_n)$ 在给定 $\\boldsymbol{\\eta}$ 条件下的似然函数是各个独立 PDF 的乘积：\n$$\nL(\\mathbf{y} | \\boldsymbol{\\eta}) = p(\\mathbf{y} | \\boldsymbol{\\eta}) = \\prod_{i=1}^{n} p(y_i | \\boldsymbol{\\eta}) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi (C(t_i; \\boldsymbol{\\phi}(\\boldsymbol{\\eta}))^2 \\sigma_p^2 + \\sigma_a^2)}} \\exp\\left( - \\frac{(y_i - C(t_i; \\boldsymbol{\\phi}(\\boldsymbol{\\eta})))^2}{2(C(t_i; \\boldsymbol{\\phi}(\\boldsymbol{\\eta}))^2 \\sigma_p^2 + \\sigma_a^2)} \\right)\n$$\n\n### 第3部分：负对数后验函数的推导\n\n$\\boldsymbol{\\eta}$ 的最大后验 (MAP) 估计是通过最大化后验分布 $p(\\boldsymbol{\\eta} | \\mathbf{y})$ 来找到的。根据 Bayes 定理，后验分布正比于似然函数乘以先验分布：\n$$\np(\\boldsymbol{\\eta} | \\mathbf{y}) \\propto p(\\mathbf{y} | \\boldsymbol{\\eta}) p(\\boldsymbol{\\eta})\n$$\n最大化后验分布等价于最大化其对数，或者最小化其负对数。负对数后验函数，我们记为 $f_{MAP}(\\boldsymbol{\\eta})$，在忽略一个加法常数的情况下为：\n$$\nf_{MAP}(\\boldsymbol{\\eta}) = - \\ln(p(\\mathbf{y} | \\boldsymbol{\\eta})) - \\ln(p(\\boldsymbol{\\eta}))\n$$\n首先，我们求负对数似然函数 $-\\ln(p(\\mathbf{y} | \\boldsymbol{\\eta}))$。令 $C_i(\\boldsymbol{\\eta}) = C(t_i;\\boldsymbol{\\phi}(\\boldsymbol{\\eta}))$，并令第 $i$ 个残差的方差为 $\\text{Var}_i = C_i(\\boldsymbol{\\eta})^2 \\sigma_p^2 + \\sigma_a^2$。\n$$\n- \\ln(p(\\mathbf{y} | \\boldsymbol{\\eta})) = - \\ln \\left( \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi \\text{Var}_i}} \\exp\\left( - \\frac{(y_i - C_i(\\boldsymbol{\\eta}))^2}{2 \\text{Var}_i} \\right) \\right)\n$$\n$$\n= - \\sum_{i=1}^{n} \\left( - \\frac{1}{2} \\ln(2\\pi) - \\frac{1}{2} \\ln(\\text{Var}_i) - \\frac{(y_i - C_i(\\boldsymbol{\\eta}))^2}{2 \\text{Var}_i} \\right)\n$$\n$$\n= \\sum_{i=1}^{n} \\left( \\frac{1}{2}\\ln(2\\pi) + \\frac{1}{2}\\ln(\\text{Var}_i) + \\frac{(y_i - C_i(\\boldsymbol{\\eta}))^2}{2 \\text{Var}_i} \\right)\n$$\n忽略常数项 $\\frac{n}{2}\\ln(2\\pi)$，上式简化为：\n$$\n-\\ln(p(\\mathbf{y} | \\boldsymbol{\\eta})) \\propto \\sum_{i=1}^{n} \\left( \\frac{(y_i - C_i(\\boldsymbol{\\eta}))^2}{2 \\text{Var}_i} + \\frac{1}{2} \\ln(\\text{Var}_i) \\right)\n$$\n接下来，我们求负对数先验 $-\\ln(p(\\boldsymbol{\\eta}))$。$\\boldsymbol{\\eta}$ 的先验分布是一个多元正态分布 $\\boldsymbol{\\eta} \\sim \\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{\\Omega})$。其 PDF 为：\n$$\np(\\boldsymbol{\\eta}) = \\frac{1}{(2\\pi)^{d/2} |\\boldsymbol{\\Omega}|^{1/2}} \\exp\\left( - \\frac{1}{2} \\boldsymbol{\\eta}^{\\top} \\boldsymbol{\\Omega}^{-1} \\boldsymbol{\\eta} \\right)\n$$\n其中 $d=3$ 是 $\\boldsymbol{\\eta}$ 的维度。负对数先验为：\n$$\n-\\ln(p(\\boldsymbol{\\eta})) = \\frac{d}{2}\\ln(2\\pi) + \\frac{1}{2}\\ln|\\boldsymbol{\\Omega}| + \\frac{1}{2} \\boldsymbol{\\eta}^{\\top} \\boldsymbol{\\Omega}^{-1} \\boldsymbol{\\eta}\n$$\n忽略与 $\\boldsymbol{\\eta}$ 无关的常数项（因为 $\\boldsymbol{\\Omega}$ 是已知的），我们得到：\n$$\n-\\ln(p(\\boldsymbol{\\eta})) \\propto \\frac{1}{2} \\boldsymbol{\\eta}^{\\top} \\boldsymbol{\\Omega}^{-1} \\boldsymbol{\\eta}\n$$\n最后，结合负对数似然项和负对数先验项，我们得到为求得 $\\boldsymbol{\\eta}$ 的 MAP 估计而需要最小化的负对数后验函数：\n$$\nf_{MAP}(\\boldsymbol{\\eta}) = \\frac{1}{2} \\boldsymbol{\\eta}^{\\top} \\boldsymbol{\\Omega}^{-1} \\boldsymbol{\\eta} + \\sum_{i=1}^{n} \\left[ \\frac{(y_i - C(t_i;\\boldsymbol{\\phi}(\\boldsymbol{\\eta})))^2}{2(C(t_i;\\boldsymbol{\\phi}(\\boldsymbol{\\eta}))^2\\sigma_p^2 + \\sigma_a^2)} + \\frac{1}{2}\\ln(C(t_i;\\boldsymbol{\\phi}(\\boldsymbol{\\eta}))^2\\sigma_p^2 + \\sigma_a^2) \\right]\n$$\n这就是所要求的最终表达式。", "answer": "$$\\boxed{\\frac{1}{2} \\boldsymbol{\\eta}^{\\top} \\boldsymbol{\\Omega}^{-1} \\boldsymbol{\\eta} + \\sum_{i=1}^{n} \\left[ \\frac{\\left(y_i - C(t_i;\\boldsymbol{\\phi}(\\boldsymbol{\\eta}))\\right)^2}{2\\left(C(t_i;\\boldsymbol{\\phi}(\\boldsymbol{\\eta}))^2\\sigma_{p}^{2} + \\sigma_{a}^{2}\\right)} + \\frac{1}{2}\\ln\\left(C(t_i;\\boldsymbol{\\phi}(\\boldsymbol{\\eta}))^2\\sigma_{p}^{2} + \\sigma_{a}^{2}\\right) \\right]}$$", "id": "4596634"}]}