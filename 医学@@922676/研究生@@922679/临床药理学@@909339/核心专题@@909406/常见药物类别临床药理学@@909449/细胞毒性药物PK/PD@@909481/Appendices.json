{"hands_on_practices": [{"introduction": "对于细胞毒性药物，将血药浓度精确控制在治疗窗内是安全有效治疗的关键。本练习将从基本质量平衡原理出发，构建设计给药方案的核心技能。你将推导并计算为达到目标稳态浓度所需的持续输注速率，并分析间歇输注中输注时长对峰浓度的影响，这对于管理与峰浓度相关的毒性至关重要 ([@problem_id:4579827])。", "problem": "一名成年患者将要接受一种细胞毒性药物，该药物遵循单室模型，在输注期间为零级输入，并以线性（一级）方式消除。该药物治疗指数窄，存在与峰浓度相关的毒性问题。患者的全身清除率为 $CL = 4.200 \\ \\mathrm{L \\cdot h^{-1}}$，在持续静脉输注下，目标稳态血浆浓度为 $C_{ss,\\mathrm{target}} = 2.700 \\ \\mathrm{mg \\cdot L^{-1}}$。假设分布容积 $V$ 不随时间变化，且等于 $V = 40.0 \\ \\mathrm{L}$。\n\n使用质量平衡第一性原理：\n1) 从体内药物量的控制微分方程出发，推导出在持续输注下达到目标稳态浓度所需的恒定输注速率 $R_{0}$ 的表达式，然后根据所提供的数据计算其数值。答案保留四位有效数字，并以 $\\mathrm{mg \\cdot h^{-1}}$ 为单位表示。\n\n2) 现在考虑一种间歇给药方案，在稳态下，每隔 $\\tau$ 小时通过零级输注给予固定剂量 $D$，输注持续时间为 $T_{\\mathrm{inf}}$。从相同的质量平衡基础出发，推导出输注结束时稳态峰浓度 $C_{\\max,\\mathrm{ss}}$ 作为 $D$、$T_{\\mathrm{inf}}$、$\\tau$、$CL$ 和 $V$ 的函数的表达式。使用你推导的表达式，简洁地从机理上解释，在保持 $D$、$\\tau$ 和 $CL$ 不变的情况下，改变 $T_{\\mathrm{inf}}$ 如何影响 $C_{\\max,\\mathrm{ss}}$，并明确指出消除速率常数 $k$ 的作用以及控制函数的任何单调性。此部分不需计算任何数值。清楚地说明所有符号。\n\n最终评分仅需要 $R_{0}$ 的数值。", "solution": "经评估，该问题是有效的，因为它在科学上基于已建立的药代动力学原理，问题设置良好，有明确的路径导向唯一解，并且其语言和参数是客观的。所有指定任务所需的数据均已提供，且前提条件一致且符合实际。\n\n在单室模型中，控制体内药物量 $A(t)$ 的基本原理是质量平衡方程。药物量的变化速率是给药速率（输入速率）与消除速率（输出速率）之差：\n$$\n\\frac{dA(t)}{dt} = \\text{Rate In} - \\text{Rate Out}\n$$\n输入速率由输注速率决定，我们将其表示为 $R(t)$。消除过程被规定为一级过程，意味着消除速率与当前体内的药物量成正比：$\\text{Rate Out} = k \\cdot A(t)$，其中 $k$ 是一级消除速率常数。因此，控制微分方程为：\n$$\n\\frac{dA(t)}{dt} = R(t) - k \\cdot A(t)\n$$\n血浆浓度 $C(t)$ 通过分布容积 $V$ 与药物量相关，即 $C(t) = A(t)/V$。系统的清除率 $CL$ 根据定义 $CL = k \\cdot V$ 与消除速率常数和分布容积相关。由此，我们可以将消除速率常数表示为 $k = \\frac{CL}{V}$。\n\n**第1部分：恒定输注速率 $R_0$ 的推导与计算**\n\n对于持续静脉输注，给药速率是恒定的，即 $R(t) = R_0$。体内药物量的微分方程为：\n$$\n\\frac{dA(t)}{dt} = R_0 - k \\cdot A(t)\n$$\n根据定义，在稳态下，体内的药物量是恒定的，我们将其表示为 $A_{ss}$。这意味着其随时间的变化率为零：\n$$\n\\frac{dA_{ss}}{dt} = 0\n$$\n将此条件代入微分方程，得到：\n$$\n0 = R_0 - k \\cdot A_{ss}\n$$\n这就得出了基本的稳态关系：输入速率等于输出速率。\n$$\nR_0 = k \\cdot A_{ss}\n$$\n问题指定了目标稳态*浓度* $C_{ss, \\mathrm{target}}$。我们可以用这个浓度来表示稳态药物量 $A_{ss}$：$A_{ss} = C_{ss, \\mathrm{target}} \\cdot V$。将此代入 $R_0$ 的方程：\n$$\nR_0 = k \\cdot (C_{ss, \\mathrm{target}} \\cdot V)\n$$\n回顾清除率的定义 $CL = k \\cdot V$，我们可以将其代入 $R_0$ 的表达式：\n$$\nR_0 = C_{ss, \\mathrm{target}} \\cdot CL\n$$\n这就是达到目标稳态浓度所需的恒定输注速率的推导表达式。\n\n现在，我们使用所提供的数据计算 $R_0$ 的数值：\n全身清除率，$CL = 4.200 \\ \\mathrm{L \\cdot h^{-1}}$。\n目标稳态浓度，$C_{ss, \\mathrm{target}} = 2.700 \\ \\mathrm{mg \\cdot L^{-1}}$。\n\n$$\nR_0 = (2.700 \\ \\mathrm{mg \\cdot L^{-1}}) \\cdot (4.200 \\ \\mathrm{L \\cdot h^{-1}})\n$$\n$$\nR_0 = 11.34 \\ \\mathrm{mg \\cdot h^{-1}}\n$$\n结果 $11.34$ 符合要求的四位有效数字。\n\n**第2部分：间歇输注下 $C_{\\max,ss}$ 的推导与分析**\n\n对于间歇给药方案，固定剂量 $D$ 以恒定速率 $R' = D/T_{\\mathrm{inf}}$ 通过零级输注给药，输注持续时间为 $T_{\\mathrm{inf}}$。此循环每 $\\tau$ 小时重复一次。在稳态下，一个给药间隔 $t \\in [0, \\tau]$ 内的浓度曲线可由两个阶段描述。\n\n阶段一：输注期 ($0 \\le t \\le T_{\\mathrm{inf}}$)\n控制微分方程为 $\\frac{dA(t)}{dt} = R' - k \\cdot A(t)$。设 $A_{\\min,ss}$ 为输注开始时的药物量。输注期间药物量的解为：\n$$\nA(t) = \\frac{R'}{k} + \\left(A_{\\min,ss} - \\frac{R'}{k}\\right) \\exp(-kt)\n$$\n峰值药物量 $A_{\\max,ss}$ 出现在输注结束时，即 $t = T_{\\mathrm{inf}}$：\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\left(1 - \\exp(-k T_{\\mathrm{inf}})\\right) + A_{\\min,ss} \\exp(-k T_{\\mathrm{inf}})\n$$\n\n阶段二：输注后期 ($T_{\\mathrm{inf}}  t \\le \\tau$)\n输注已停止 ($R'=0$)，控制方程为 $\\frac{dA(t)}{dt} = -k \\cdot A(t)$。药物量从峰值开始呈指数衰减：\n$$\nA(t) = A_{\\max,ss} \\exp(-k(t - T_{\\mathrm{inf}}))\n$$\n在给药间隔结束时，即 $t=\\tau$，药物量回到下一个周期的谷值水平：\n$$\nA_{\\min,ss} = A_{\\max,ss} \\exp(-k(\\tau - T_{\\mathrm{inf}}))\n$$\n我们将 $A_{\\min,ss}$ 的表达式代入 $A_{\\max,ss}$ 的方程：\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\left(1 - \\exp(-k T_{\\mathrm{inf}})\\right) + \\left( A_{\\max,ss} \\exp(-k(\\tau - T_{\\mathrm{inf}})) \\right) \\exp(-k T_{\\mathrm{inf}})\n$$\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\left(1 - \\exp(-k T_{\\mathrm{inf}})\\right) + A_{\\max,ss} \\exp(-k\\tau)\n$$\n求解 $A_{\\max,ss}$：\n$$\nA_{\\max,ss} (1 - \\exp(-k\\tau)) = \\frac{R'}{k} (1 - \\exp(-k T_{\\mathrm{inf}}))\n$$\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\frac{1 - \\exp(-k T_{\\mathrm{inf}})}{1 - \\exp(-k\\tau)}\n$$\n为了得到峰浓度 $C_{\\max,ss}$，我们除以 $V$ 并代入 $R' = D/T_{\\mathrm{inf}}$ 和 $k=CL/V$：\n$$\nC_{\\max,ss} = \\frac{A_{\\max,ss}}{V} = \\frac{D/T_{\\mathrm{inf}}}{k \\cdot V} \\frac{1 - \\exp(-k T_{\\mathrm{inf}})}{1 - \\exp(-k\\tau)}\n$$\n使用 $CL = k \\cdot V$，最终表达式为：\n$$\nC_{\\max,ss} = \\frac{D}{CL \\cdot T_{\\mathrm{inf}}} \\frac{1 - \\exp\\left(-\\frac{CL}{V} T_{\\mathrm{inf}}\\right)}{1 - \\exp\\left(-\\frac{CL}{V} \\tau\\right)}\n$$\n该表达式给出了 $C_{\\max,ss}$ 作为 $D$、$T_{\\mathrm{inf}}$、$\\tau$、$CL$ 和 $V$ 的函数。\n\n为了解释 $T_{\\mathrm{inf}}$ 的影响，我们保持 $D$、$\\tau$、$CL$ 和 $V$ 不变。消除速率常数 $k = CL/V$ 也为常数。那么 $C_{\\max,ss}$ 的行为由依赖于 $T_{\\mathrm{inf}}$ 的项决定：\n$$\nf(T_{\\mathrm{inf}}) = \\frac{1 - \\exp(-k T_{\\mathrm{inf}})}{T_{\\mathrm{inf}}}\n$$\n为了确定该函数的单调性，我们考察其关于 $T_{\\mathrm{inf}}$ 的导数：\n$$\n\\frac{df}{dT_{\\mathrm{inf}}} = \\frac{T_{\\mathrm{inf}} \\cdot (k \\exp(-k T_{\\mathrm{inf}})) - (1 - \\exp(-k T_{\\mathrm{inf}})) \\cdot 1}{T_{\\mathrm{inf}}^2} = \\frac{\\exp(-k T_{\\mathrm{inf}})(k T_{\\mathrm{inf}} + 1) - 1}{T_{\\mathrm{inf}}^2}\n$$\n对于 $T_{\\mathrm{inf}} > 0$，分母总是正的。可以证明，对于 $T_{\\mathrm{inf}} > 0$，分子总是负的。函数 $g(x) = \\exp(-ax)(ax+1)-1$ 满足 $g(0)=0$，其导数 $g'(x) = -a^2x\\exp(-ax)$ 在 $a,x>0$ 时为负。因此，$g(x)$ 从 $0$ 开始严格递减，意味着对于 $x>0$，有 $g(x)0$。因此，对于所有 $T_{\\mathrm{inf}} > 0$，都有 $\\frac{df}{dT_{\\mathrm{inf}}}  0$。\n\n这证明了 $f(T_{\\mathrm{inf}})$ 是一个严格单调递减的函数。因此，当输注持续时间 $T_{\\mathrm{inf}}$ 增加时（同时保持总剂量 $D$ 不变），稳态峰浓度 $C_{\\max,ss}$ 会降低。\n\n从机理上讲，这是因为较长的输注持续时间意味着较低的药物输入速率 ($R' = D/T_{\\mathrm{inf}}$)。药物消除以与体内药物量成正比的速率进行（由 $k$ 控制），在输注期间有更多时间来抵消较慢的药物给药。这导致在输注结束时净累积量减少，从而产生较低的峰浓度。消除速率常数 $k$ 决定了消除过程的“强度”；较高的 $k$ 意味着消除在抵消药物输入方面更有效，使得随着 $T_{\\mathrm{inf}}$ 的增加，$C_{\\max,ss}$ 的降低更为显著。对于有峰浓度相关毒性问题的药物，延长输注时间是一种标准策略，用于在维持给药间隔内总药物暴露量不变的情况下降低峰浓度。", "answer": "$$\\boxed{11.34}$$", "id": "4579827"}, {"introduction": "许多细胞毒性药物的消除过程并非简单的线性关系，当药物浓度较高时，代谢或转运系统可能达到饱和。本练习将带你从线性动力学模型过渡到非线性动力学模型，通过分析经典的米氏动力学（Michaelis-Menten kinetics），你将学会计算饱和状态下药物浓度的下降时间，并深入理解何时可以使用更简单的一级动力学近似及其局限性 ([@problem_id:4579785])。", "problem": "将一种细胞毒性抗代谢药物以单次快速静脉推注的方式给予一名成年患者。其药代动力学特征符合单室模型，消除过程为可饱和的，遵循米氏动力学（Michaelis–Menten kinetics）。假设药物瞬间混合均匀，表观分布容积恒定，且无持续给药。设体内药物总量为 $A(t)$，血浆药物浓度为 $C(t)$，且满足 $A(t) = V\\,C(t)$，其中 $V$ 是表观分布容积。消除速率由一个能力有限的代谢过程决定，该过程的特征为最大代谢能力 $V_{\\max}$ 和米氏常数 $K_{m}$。\n\n已知 $V_{\\max} = 50$ mg/h，$K_{m} = 2$ mg/L，$V = 20$ L，推注后瞬时初始浓度 $C_{1} = 10$ mg/L，目标较低浓度 $C_{2} = 1$ mg/L，计算浓度从 $C_{1}$ 下降到 $C_{2}$ 所需的时间。将时间以小时为单位表示，并将答案四舍五入至四位有效数字。\n\n此外，基于药代动力学和酶动力学的基本原理，讨论对于此类细胞毒性药物，在何种参数范围内，对 $C(t)$ 的下降进行对数线性（一级）近似是可接受的。", "solution": "本题要求计算在米氏动力学控制下，药物浓度从一个指定的初始值下降到一个最终值所需的时间，并讨论一级近似在何种条件下有效。\n\n首先，我们建立控制微分方程。体内药物总量 $A(t)$ 的变化率等于消除速率的负值。消除过程遵循米氏动力学，因此消除速率由 $\\frac{V_{\\max} C(t)}{K_{m} + C(t)}$ 给出。\n\n药物总量 $A(t)$ 的微分方程为：\n$$ \\frac{dA(t)}{dt} = - \\frac{V_{\\max} C(t)}{K_{m} + C(t)} $$\n我们已知体内药物总量与血浆浓度之间的关系为 $A(t) = V C(t)$，其中 $V$ 是恒定的表观分布容积。对该关系式关于时间 $t$ 求导，得到：\n$$ \\frac{dA(t)}{dt} = V \\frac{dC(t)}{dt} $$\n将此式代入速率方程，得到关于浓度 $C(t)$ 的微分方程：\n$$ V \\frac{dC(t)}{dt} = - \\frac{V_{\\max} C(t)}{K_{m} + C(t)} $$\n$$ \\frac{dC(t)}{dt} = - \\frac{V_{\\max}}{V} \\frac{C(t)}{K_{m} + C(t)} $$\n这是一个可分离的一阶常微分方程。为了求出浓度从初始值 $C_{1}$ 下降到最终值 $C_{2}$ 所需的时间 $t$，我们分离变量并积分。设浓度为 $C_{1}$ 时的时间为 $t=0$，浓度为 $C_{2}$ 时的时间为 $t$。\n$$ \\frac{K_{m} + C}{C} dC = - \\frac{V_{\\max}}{V} dt $$\n$$ \\left( \\frac{K_{m}}{C} + 1 \\right) dC = - \\frac{V_{\\max}}{V} dt $$\n我们将左侧从 $C_{1}$ 到 $C_{2}$ 积分，右侧从 $0$ 到 $t$ 积分：\n$$ \\int_{C_{1}}^{C_{2}} \\left( \\frac{K_{m}}{C} + 1 \\right) dC = \\int_{0}^{t} - \\frac{V_{\\max}}{V} d\\tau $$\n计算积分得到：\n$$ \\left[ K_{m} \\ln(C) + C \\right]_{C_{1}}^{C_{2}} = \\left[ - \\frac{V_{\\max}}{V} \\tau \\right]_{0}^{t} $$\n$$ (K_{m} \\ln(C_{2}) + C_{2}) - (K_{m} \\ln(C_{1}) + C_{1}) = - \\frac{V_{\\max}}{V} t $$\n$$ K_{m} \\left( \\ln(C_{2}) - \\ln(C_{1}) \\right) + (C_{2} - C_{1}) = - \\frac{V_{\\max}}{V} t $$\n$$ K_{m} \\ln\\left(\\frac{C_{2}}{C_{1}}\\right) + (C_{2} - C_{1}) = - \\frac{V_{\\max}}{V} t $$\n求解时间间隔 $t$：\n$$ t = - \\frac{V}{V_{\\max}} \\left[ K_{m} \\ln\\left(\\frac{C_{2}}{C_{1}}\\right) + (C_{2} - C_{1}) \\right] $$\n利用对数性质 $\\ln(x/y) = -\\ln(y/x)$，我们可以将表达式写成更方便的形式：\n$$ t = \\frac{V}{V_{\\max}} \\left[ K_{m} \\ln\\left(\\frac{C_{1}}{C_{2}}\\right) + (C_{1} - C_{2}) \\right] $$\n现在，我们代入给定的数值：$V_{\\max} = 50$ mg/h，$K_{m} = 2$ mg/L，$V = 20$ L，$C_{1} = 10$ mg/L，$C_{2} = 1$ mg/L。\n$$ t = \\frac{20 \\text{ L}}{50 \\text{ mg/h}} \\left[ (2 \\text{ mg/L}) \\ln\\left(\\frac{10 \\text{ mg/L}}{1 \\text{ mg/L}}\\right) + (10 \\text{ mg/L} - 1 \\text{ mg/L}) \\right] $$\n$$ t = 0.4 \\frac{\\text{L} \\cdot \\text{h}}{\\text{mg}} \\left[ 2 \\ln(10) + 9 \\right] \\frac{\\text{mg}}{\\text{L}} $$\n$$ t = 0.4 \\left( 2 \\ln(10) + 9 \\right) \\text{h} $$\n使用 $\\ln(10) \\approx 2.302585$：\n$$ t \\approx 0.4 \\left( 2 \\times 2.302585 + 9 \\right) \\text{h} $$\n$$ t \\approx 0.4 \\left( 4.60517 + 9 \\right) \\text{h} $$\n$$ t \\approx 0.4 \\left( 13.60517 \\right) \\text{h} $$\n$$ t \\approx 5.442068 \\text{ h} $$\n四舍五入至四位有效数字，所需时间为 $t = 5.442$ 小时。\n\n对于问题的第二部分，我们讨论在何种参数范围内，对数线性（一级）近似是可接受的。消除速率由米氏表达式给出：\n$$ \\text{消除速率} = \\frac{V_{\\max} C}{K_{m} + C} $$\n一级过程的特征是消除速率与浓度成正比，即 $\\text{消除速率} = k_{el} V C$，其中 $k_{el}$ 是一级消除速率常数。要使米氏模型能近似为一级过程，其速率表达式必须能简化为与 $C$ 成正比的形式。\n\n当药物浓度相对于米氏常数很低时，即 $C \\ll K_{m}$ 时，该近似是有效的。在这种情况下，米氏方程的分母可以近似为 $K_{m} + C \\approx K_{m}$。消除速率变为：\n$$ \\text{消除速率} \\approx \\frac{V_{\\max} C}{K_{m}} = \\left(\\frac{V_{\\max}}{K_{m}}\\right) C $$\n项 $\\frac{V_{\\max}}{K_{m}}$ 是一个常数，代表消除过程未饱和时的药物清除率 ($CL$)。浓度的微分方程变为：\n$$ V \\frac{dC}{dt} = - \\left(\\frac{V_{\\max}}{K_{m}}\\right) C $$\n$$ \\frac{dC}{dt} = - \\left(\\frac{V_{\\max}}{V K_{m}}\\right) C = -k_{el} C $$\n这是一级消除的微分方程，其中一级消除速率常数为 $k_{el} = \\frac{V_{\\max}}{V K_{m}}$。该方程的解为 $C(t) = C(0) \\exp(-k_{el} t)$，这对应于半对数坐标图上的线性下降（对数线性动力学）。\n\n相反，当药物浓度远高于米氏常数时 ($C \\gg K_{m}$)，分母变为 $K_{m} + C \\approx C$。消除速率接近其最大值：\n$$ \\text{消除速率} \\approx \\frac{V_{\\max} C}{C} = V_{\\max} $$\n这对应于零级动力学，即药物以恒定速率被消除，与浓度无关。此时浓度随时间呈线性变化，而非对数线性。\n\n对于细胞毒性药物，其治疗窗通常很窄，治疗浓度很容易达到或超过其代谢途径的 $K_{m}$ 值。在这种情况下，消除是能力有限的（可饱和的），不能用简单的一级模型准确描述。当实际过程已饱和（零级或混合级）时，若假设为一级动力学，将导致低估药物暴露量（曲线下面积，AUC），并可能导致意外的药物蓄积和毒性。因此，对于此类药物，只有当其血浆浓度持续且显著低于其 $K_{m}$ 值时，对数线性近似才是可接受的。在本题给出的具体案例中，初始浓度 $C_{1}=10$ mg/L 是 $K_{m}=2$ mg/L 的五倍，表明系统开始时处于接近饱和（零级）的状态，并随着浓度下降至 $C_{2}=1$ mg/L 而过渡到混合级阶段。在此浓度范围内，一级模型将非常不准确。", "answer": "$$\\boxed{5.442}$$", "id": "4579785"}, {"introduction": "将药代动力学理论应用于临床实践是高级药理学家的核心能力，尤其是在处理特殊人群（如肥胖患者）的给药问题时。本练习将通过一个计算模拟任务，让你评估在肿瘤治疗中对基于体表面积（BSA）的给药进行“剂量封顶”的临床策略。通过比较不同给药方案下的药物暴露（如 $C_{\\max}$ 和 AUC），你将学会如何定量分析临床决策的风险与获益 ([@problem_id:4579812])。", "problem": "要求您实现一个模拟，通过比较两种给药策略（全BSA给药与BSA封顶给药）下的暴露指标，来评估对肥胖患者使用按体表面积（BSA）给药的细胞毒性药物时，剂量封顶所产生的影响。该药代动力学模型为具有一级消除的单室静脉（IV）输注模型。您的程序必须针对每个指定的测试用例，计算两种给药策略下的最大浓度（Cmax）和浓度-时间曲线下面积（AUC），并以严格定义的输出格式返回这些值。\n\n遵循以下原则和核心定义开始：\n- 体内药物量的质量平衡：在输注期间，药物量 $A(t)$ 根据 $dA/dt = R_0 - \\text{CL} \\cdot C(t)$ 演变，其中 $C(t) = A(t)/V$。\n- 输注为零级过程，在有限的持续时间内以恒定速率 $R_0$ 进行。\n- 应用线性动力学，具有一级消除以及不随时间变化的清除率和分布容积。\n- 对于单次给药，浓度-时间曲线下面积满足线性动力学的清除率恒等式。\n\n使用以下经过充分检验的公式和事实作为您推导和程序设计的基础：\n- 使用Mosteller公式计算体表面积（BSA）：$\\text{BSA} = \\sqrt{\\dfrac{H \\cdot W}{3600}}$，其中 $H$ 是身高（单位：厘米），$W$ 是体重（单位：公斤）。\n- 清除率和分布容积的异速生长标度关系：$\\text{CL}(W) = \\text{CL}_{\\text{std}} \\cdot \\left(\\dfrac{W}{70}\\right)^{0.75}$ 和 $V(W) = V_{\\text{std}} \\cdot \\left(\\dfrac{W}{70}\\right)^{1.0}$。\n- 零级输注在时间 $t_{\\text{inf}}$ 结束，之后在没有进一步药物输入的情况下进行消除。\n- 在线性动力学条件下，单次给药的总AUC由清除率和给药总剂量决定。\n\n给药策略：\n- 全BSA给药：$\\text{Dose}_{\\text{full}} = D_{\\text{m2}} \\cdot \\text{BSA}$。\n- 带封顶值 $B_{\\max}$ 的BSA封顶给药：$\\text{Dose}_{\\text{capped}} = D_{\\text{m2}} \\cdot \\min(\\text{BSA}, B_{\\max})$。\n\n药代动力学模型规格：\n- 单室模型，零级输注，持续时间 $t_{\\text{inf}}$ 小时。\n- 线性一级消除，$\\text{CL}$ 和 $V$ 的异速生长标度关系如上所述。\n\n要求的输出和单位：\n- 计算每种给药策略下输注结束时的Cmax，以 $\\mathrm{mg/L}$ 为单位，四舍五入到小数点后四位。\n- 计算每种给药策略下从时间零到无穷大的AUC，以 $\\mathrm{mg \\cdot h/L}$ 为单位，四舍五入到小数点后四位。\n\n角度单位：不适用。百分比：不适用。\n\n所有测试用例使用的参数：\n- 每平方米剂量 $D_{\\text{m2}} = 75\\,\\mathrm{mg/m^2}$。\n- BSA封顶值 $B_{\\max} = 2.0\\,\\mathrm{m^2}$。\n- 输注持续时间 $t_{\\text{inf}} = 1.0\\,\\mathrm{h}$。\n- 标准清除率 $\\text{CL}_{\\text{std}} = 30\\,\\mathrm{L/h}$。\n- 标准容积 $V_{\\text{std}} = 150\\,\\mathrm{L}$。\n\n测试套件（每个用例是一对 $(W, H)$，其中W为体重（公斤），H为身高（厘米）），旨在覆盖一个无封顶效应的非肥胖案例、一个处于封顶边界的案例，以及多个因封顶而减少剂量的肥胖案例：\n- 用例1（无封顶效应）：$(W,H) = (70, 175)$。\n- 用例2（恰好在封顶值）：$(W,H) = (80, 180)$。\n- 用例3（中度肥胖）：$(W,H) = (110, 175)$。\n- 用例4（重度肥胖，较矮）：$(W,H) = (140, 165)$。\n- 用例5（高个，肥胖）：$(W,H) = (95, 200)$。\n\n对于每个用例，您必须：\n- 使用给定公式计算 $\\text{BSA}$。\n- 计算 $\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$。\n- 使用异速生长关系计算 $\\text{CL}$ 和 $V$。\n- 确定每种给药策略下输注结束时的Cmax（整个过程中的最大浓度），单位为 $\\mathrm{mg/L}$，四舍五入到小数点后四位。\n- 确定每种给药策略下从 $0$ 到 $\\infty$ 的AUC，单位为 $\\mathrm{mg \\cdot h/L}$，四舍五入到小数点后四位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个结果列表，每个结果按上述顺​​序对应一个测试用例，并且本身是一个包含四个浮点数的列表，顺序为 $[\\text{Cmax}_{\\text{full}}, \\text{Cmax}_{\\text{capped}}, \\text{AUC}_{\\text{full}}, \\text{AUC}_{\\text{capped}}]$，数值四舍五入到小数点后四位，单位如前所述。\n- 格式示例（仅供说明）：$[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\dots]$。\n\n您的任务：\n- 实现一个完整、可运行的程序，该程序完全按照规定执行这些计算，使用给定的参数和测试套件，并以指定的最终输出格式将结果打印为单行。", "solution": "该问题是有效的。它提出了一个在临床药理学领域中定义明确的计算任务，该任务基于已建立的科学原理和模型。所有必需的参数和公式都已提供，设置在内部是一致的，并且所要求的输出也已明确指定。\n\n该解决方案是通过将基本药代动力学原理应用于具有零级静脉输注的单室模型而得出的。每个测试用例的过程包括确定患者特异性参数，计算两种不同策略下的剂量，然后计算最大浓度（$C_{\\text{max}}$）和浓度-时间曲线下面积（AUC）这些药代动力学指标。\n\n### 1. 患者特异性药代动力学参数\n\n对于每个由体重（$W$，单位：公斤）和身高（$H$，单位：厘米）定义的患者，我们首先计算其个体药代动力学参数：体表面积（BSA）、清除率（CL）和分布容积（$V$）。\n\n- **体表面积（BSA）**：使用Mosteller公式计算，这是一种广为接受的经验关系式。\n$$\n\\text{BSA} = \\sqrt{\\frac{H \\cdot W}{3600}}\n$$\n当 $H$ 的单位为 $\\text{cm}$ 且 $W$ 的单位为 $\\text{kg}$ 时，BSA的单位为 $\\text{m}^2$。\n\n- **清除率（CL）和分布容积（V）**：这些参数使用异速生长标度法确定，该方法将生理变量与体重联系起来。该标度是相对于体重为 $70\\,\\text{kg}$ 的标准受试者而言的。\n$$\n\\text{CL}(W) = \\text{CL}_{\\text{std}} \\cdot \\left(\\frac{W}{70}\\right)^{0.75}\n$$\n$$\nV(W) = V_{\\text{std}} \\cdot \\left(\\frac{W}{70}\\right)^{1.0}\n$$\n给定 $\\text{CL}_{\\text{std}} = 30\\,\\text{L/h}$ 和 $V_{\\text{std}} = 150\\,\\text{L}$，患者特异性的CL单位将是 $\\text{L/h}$，V的单位将是 $\\text{L}$。\n\n### 2. 给药策略\n\n细胞毒性药物的总剂量基于两种不同的策略计算，两者都使用每平方米的标称剂量 $D_{\\text{m2}} = 75\\,\\text{mg/m}^2$。\n\n- **全BSA给药（$\\text{Dose}_{\\text{full}}$）**：剂量与患者计算出的BSA成正比。\n$$\n\\text{Dose}_{\\text{full}} = D_{\\text{m2}} \\cdot \\text{BSA}\n$$\n\n- **BSA封顶给药（$\\text{Dose}_{\\text{capped}}$）**：用于剂量计算的BSA值被限制在最大值 $B_{\\max} = 2.0\\,\\text{m}^2$。这种做法在肥胖患者中很常见，用以减轻毒性。\n$$\n\\text{Dose}_{\\text{capped}} = D_{\\text{m2}} \\cdot \\min(\\text{BSA}, B_{\\max})\n$$\n如果患者的BSA小于或等于 $B_{\\max}$，两种给药策略将产生相同的剂量。\n\n### 3. 药代动力学指标计算\n\n对于每种剂量（$\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$），我们计算AUC和 $C_{\\text{max}}$。\n\n- **曲线下面积（AUC）**：对于具有线性和一级消除的系统，从时间零到无穷大的总暴露量 $\\text{AUC}_{0-\\infty}$，与给药总剂量和药物清除率有根本性的关系。这是药代动力学的核心原则。\n$$\n\\text{AUC}_{0-\\infty} = \\frac{\\text{Dose}}{\\text{CL}}\n$$\n此公式分别应用于 $\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$ 来计算 $\\text{AUC}_{\\text{full}}$ 和 $\\text{AUC}_{\\text{capped}}$。单位是 $\\text{mg} \\cdot \\text{h/L}$。\n\n- **最大浓度（$C_{\\text{max}}$）**：在输注期间（$0 \\le t \\le t_{\\text{inf}}$），体内药物浓度 $C(t)$ 由单室模型质量平衡方程 $V \\frac{dC}{dt} = R_0 - \\text{CL} \\cdot C(t)$ 的解来描述，其中 $R_0 = \\text{Dose}/t_{\\text{inf}}$ 是恒定输注速率。当 $C(0)=0$ 时，解为：\n$$\nC(t) = \\frac{R_0}{\\text{CL}} \\left(1 - e^{-k_e t}\\right)\n$$\n其中 $k_e = \\text{CL}/V$ 是一级消除速率常数。\n对于零级输注，浓度在输注期间单调增加。因此，最大浓度 $C_{\\text{max}}$ 出现在输注停止的瞬间，即 $t = t_{\\text{inf}}$。\n$$\nC_{\\text{max}} = C(t_{\\text{inf}}) = \\frac{R_0}{\\text{CL}} \\left(1 - e^{-k_e t_{\\text{inf}}}\\right) = \\frac{\\text{Dose}/t_{\\text{inf}}}{\\text{CL}} \\left(1 - e^{-(\\text{CL}/V) t_{\\text{inf}}}\\right)\n$$\n此公式应用于每种剂量，以计算单位为 $\\text{mg/L}$ 的 $C_{\\text{max,full}}$ 和 $C_{\\text{max,capped}}$。\n\n### 4. 计算算法\n\n该实现对每个测试用例 $(W, H)$ 遵循一个系统化的步骤：\n1. 计算患者特异性参数：$\\text{BSA}$、$\\text{CL}$ 和 $V$。\n2. 计算 $\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$。\n3. 使用推导出的公式计算 $\\text{AUC}_{\\text{full}} = \\text{Dose}_{\\text{full}} / \\text{CL}$ 和 $C_{\\text{max,full}}$。\n4. 由于AUC和 $C_{\\text{max}}$ 都与剂量成正比，因此可以通过缩放全剂量结果来高效地计算封顶情景下的指标：\n   $$\n   \\text{DoseRatio} = \\frac{\\text{Dose}_{\\text{capped}}}{\\text{Dose}_{\\text{full}}} = \\frac{\\min(\\text{BSA}, B_{\\max})}{\\text{BSA}}\n   $$\n   $$\n   \\text{AUC}_{\\text{capped}} = \\text{AUC}_{\\text{full}} \\cdot \\text{DoseRatio}\n   $$\n   $$\n   C_{\\text{max,capped}} = C_{\\text{max,full}} \\cdot \\text{DoseRatio}\n   $$\n5. 将四个结果指标 $[\\text{Cmax}_{\\text{full}}, \\text{Cmax}_{\\text{capped}}, \\text{AUC}_{\\text{full}}, \\text{AUC}_{\\text{capped}}]$ 四舍五入到小数点后四位，并收集起来用于最终输出。\n\n对所有指定的测试用例重复此过程，以生成最终结果集。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates Cmax and AUC for cytotoxic agents under full vs. capped BSA dosing.\n    \"\"\"\n    # Define problem parameters\n    D_m2 = 75.0      # Dose per square meter (mg/m^2)\n    B_max = 2.0      # BSA cap (m^2)\n    t_inf = 1.0      # Infusion duration (h)\n    CL_std = 30.0    # Standard clearance (L/h)\n    V_std = 150.0    # Standard volume of distribution (L)\n    W_std = 70.0     # Standard weight (kg)\n\n    # Define the test suite: (Weight in kg, Height in cm)\n    test_cases = [\n        (70, 175),\n        (80, 180),\n        (110, 175),\n        (140, 165),\n        (95, 200),\n    ]\n\n    all_results = []\n\n    for W, H in test_cases:\n        # Step 1: Calculate patient-specific parameters\n        # Mosteller formula for Body Surface Area (BSA)\n        bsa = np.sqrt((H * W) / 3600.0)\n\n        # Allometric scaling for Clearance (CL) and Volume (V)\n        cl = CL_std * np.power(W / W_std, 0.75)\n        v = V_std * np.power(W / W_std, 1.0)\n        \n        # Elimination rate constant\n        k_e = cl / v\n\n        # Step 2: Calculate doses for both strategies\n        dose_full = D_m2 * bsa\n        capped_bsa = min(bsa, B_max)\n        dose_capped = D_m2 * capped_bsa\n\n        # Step 3: Calculate pharmacokinetic metrics for the full dose\n        # Handle the edge case of zero dose to avoid division by zero\n        if dose_full == 0:\n            cmax_full = 0.0\n            auc_full = 0.0\n        else:\n            # Infusion rate for full dose\n            R0_full = dose_full / t_inf\n            \n            # Cmax at the end of infusion for full dose\n            cmax_full = (R0_full / cl) * (1.0 - np.exp(-k_e * t_inf))\n            \n            # AUC from 0 to infinity for full dose\n            auc_full = dose_full / cl\n\n        # Step 4: Calculate metrics for the capped dose by scaling\n        # The relationship between metrics and dose is linear\n        if dose_full == 0:\n            dose_ratio = 0.0\n        else:\n            dose_ratio = dose_capped / dose_full\n        \n        cmax_capped = cmax_full * dose_ratio\n        auc_capped = auc_full * dose_ratio\n\n        # Collect the results for the current case\n        case_results = [cmax_full, cmax_capped, auc_full, auc_capped]\n        all_results.append(case_results)\n\n    # Step 5: Format the final output string exactly as required\n    # List of strings, where each string is a formatted inner list\n    # e.g., '[0.1234, 5.6789, ...]'\n    list_of_list_strings = []\n    for result_list in all_results:\n        # Format each number to 4 decimal places, creating a list of strings\n        # e.g., ['0.1234', '5.6789', ...]\n        formatted_numbers = [f\"{val:.4f}\" for val in result_list]\n        \n        # Join with \", \" to get a space after the comma, and add brackets\n        # e.g., '[0.1234, 5.6789]'\n        inner_list_str = '[' + ', '.join(formatted_numbers) + ']'\n        list_of_list_strings.append(inner_list_str)\n\n    # Join the outer list elements with a comma (no space) and add brackets\n    # e.g., '[[...],[...]]'\n    final_output_str = '[' + ','.join(list_of_list_strings) + ']'\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "4579812"}]}