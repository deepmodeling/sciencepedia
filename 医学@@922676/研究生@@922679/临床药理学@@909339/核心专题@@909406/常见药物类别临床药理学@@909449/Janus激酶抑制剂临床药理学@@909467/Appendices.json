{"hands_on_practices": [{"introduction": "要评估一种JAK抑制剂的有效性与安全性，首先必须量化其在体内的药物暴露水平。通过本练习，您将从质量平衡等基本原理出发，为托法替尼（tofacitinib）建立一个单室模型，并计算其稳态平均浓度与浓度波动。这项基础实践有助于我们深刻理解给药方案如何影响药物在体内的动态过程。[@problem_id:4536912]", "problem": "一名患有中度溃疡性结肠炎的成年患者开始接受Janus激酶（JAK）抑制剂托法替布速释剂治疗，方案为每$12\\,\\mathrm{h}$口服$10\\,\\mathrm{mg}$。假设药物在体内符合一级消除的单室线性药代动力学模型，其绝对口服生物利用度 $F = 0.74$，系统清除率 $\\mathrm{CL} = 24\\,\\mathrm{L\\,h}^{-1}$，消除半衰期 $t_{1/2} = 3.0\\,\\mathrm{h}$，吸收速率常数 $k_{a} = 2.0\\,\\mathrm{h}^{-1}$，且满足 $k_{a} \\gg k_{el}$。\n\n从基本质量平衡和核心药代动力学定义出发，推导给药间隔内的稳态平均血浆浓度 $C_{ss,\\mathrm{avg}}$ 的表达式，并计算该给药方案下的具体数值。将最终的 $C_{ss,\\mathrm{avg}}$ 以 $\\mathrm{ng\\,mL}^{-1}$ 为单位表示，并四舍五入至三位有效数字。\n\n接下来，将稳态波动定义为一个给药间隔内的峰谷浓度比 $C_{\\max}/C_{\\min}$，并利用一级消除单室模型以及所述条件 $k_{a} \\gg k_{el}$，推导 $C_{\\max}/C_{\\min}$ 以 $k_{el}$ 和 $\\tau$ 表示的闭式表达式，然后计算该给药方案下的数值。将该比值以纯数字形式报告，并四舍五入至三位有效数字。\n\n使用给药间隔 $\\tau = 12\\,\\mathrm{h}$。除线性药代动力学和所给定的量之外，不要做任何额外假设。", "solution": "该问题基于已确立的药代动力学原理，其科学基础可靠，问题表述清晰，数据充分且一致，语言客观正式，因此被认为是有效的。我们可以开始求解。\n\n该问题要求基于口服给药药物的一级吸收和一级消除单室药代动力学模型，进行两项独立的推导和计算。\n\n第1部分：稳态平均血浆浓度 $C_{ss,\\mathrm{avg}}$ 的推导和计算。\n\n稳态药代动力学的基本原理是，在一个给药间隔 $\\tau$ 内，平均给药速率等于平均消除速率。这是质量平衡的一种体现。\n\n给药剂量为 $D$。进入体循环的剂量分数是绝对口服生物利用度 $F$。因此，在一个给药间隔内进入体循环的总药量为 $F \\cdot D$。平均给药速率为该药量除以给药间隔 $\\tau$。\n$$ \\text{平均进入速率} = \\frac{F \\cdot D}{\\tau} $$\n在任意时间 $t$，药物从体内的消除速率由系统清除率 $\\mathrm{CL}$ 和血浆药物浓度 $C(t)$ 的乘积给出。\n$$ \\text{消除速率}(t) = \\mathrm{CL} \\cdot C(t) $$\n在稳态下，一个给药间隔内的平均消除速率是清除率与稳态平均浓度 $C_{ss,\\mathrm{avg}}$ 的乘积。\n$$ \\text{平均排出速率} = \\mathrm{CL} \\cdot C_{ss,\\mathrm{avg}} $$\n通过令平均进入速率等于平均排出速率，我们得到：\n$$ \\frac{F \\cdot D}{\\tau} = \\mathrm{CL} \\cdot C_{ss,\\mathrm{avg}} $$\n求解 $C_{ss,\\mathrm{avg}}$ 可得表达式：\n$$ C_{ss,\\mathrm{avg}} = \\frac{F \\cdot D}{\\mathrm{CL} \\cdot \\tau} $$\n无论房室数量或给药途径如何，该关系式对任何线性药代动力学模型都普遍适用。\n\n给定以下数值：\n剂量, $D = 10\\,\\mathrm{mg}$\n生物利用度, $F = 0.74$\n系统清除率, $\\mathrm{CL} = 24\\,\\mathrm{L\\,h}^{-1}$\n给药间隔, $\\tau = 12\\,\\mathrm{h}$\n\n将这些值代入推导出的表达式：\n$$ C_{ss,\\mathrm{avg}} = \\frac{0.74 \\cdot 10\\,\\mathrm{mg}}{\\left(24\\,\\mathrm{L\\,h}^{-1}\\right) \\cdot \\left(12\\,\\mathrm{h}\\right)} = \\frac{7.4\\,\\mathrm{mg}}{288\\,\\mathrm{L}} \\approx 0.025694\\,\\mathrm{mg\\,L}^{-1} $$\n问题要求答案以 $\\mathrm{ng\\,mL}^{-1}$ 为单位。我们进行单位换算：\n$$ 1\\,\\mathrm{mg\\,L}^{-1} = \\frac{1 \\times 10^{6}\\,\\mathrm{ng}}{1 \\times 10^{3}\\,\\mathrm{mL}} = 1000\\,\\mathrm{ng\\,mL}^{-1} $$\n因此：\n$$ C_{ss,\\mathrm{avg}} \\approx 0.025694\\,\\mathrm{mg\\,L}^{-1} \\times 1000\\,\\frac{\\mathrm{ng\\,mL}^{-1}}{\\mathrm{mg\\,L}^{-1}} \\approx 25.694\\,\\mathrm{ng\\,mL}^{-1} $$\n四舍五入至三位有效数字，我们得到 $C_{ss,\\mathrm{avg}} = 25.7\\,\\mathrm{ng\\,mL}^{-1}$。\n\n第2部分：稳态波动 $C_{\\max}/C_{\\min}$ 的推导和计算。\n\n波动定义为在单个给药间隔内，稳态下的峰浓度 ($C_{\\max}$) 与谷浓度 ($C_{\\min}$) 之比。问题指定使用一级消除单室模型，并满足吸收速率常数远大于消除速率常数的条件，$k_{a} \\gg k_{el}$。\n\n条件 $k_{a} \\gg k_{el}$ 意味着与消除过程相比，药物吸收过程非常迅速。在这种情况下，吸收阶段很短，为了分析浓度衰减阶段，口服给药可以近似为静脉推注给药。达到峰浓度 $C_{\\max}$ 后，血浆浓度在给药间隔剩余时间内的后续下降完全由一级消除决定。\n达到峰值后 $t$ 时间的浓度 $C(t)$ 由下式给出：\n$$ C(t) = C_{\\max} \\cdot \\exp(-k_{el} t) $$\n在稳态下，谷浓度 $C_{\\min}$ 是在下一次给药前（即达到峰值后，在给药间隔 $\\tau$ 结束时）的残余浓度。因此，我们可以设 $t = \\tau$（近似认为 $t_{\\max}$ 非常接近于 $0$，且衰减阶段几乎持续整个间隔 $\\tau$）。\n$$ C_{\\min} = C_{\\max} \\cdot \\exp(-k_{el} \\tau) $$\n重新整理此方程以求出比值 $C_{\\max}/C_{\\min}$，得到所需的波动表达式：\n$$ \\frac{C_{\\max}}{C_{\\min}} = \\frac{1}{\\exp(-k_{el} \\tau)} = \\exp(k_{el} \\tau) $$\n为了计算该比值的数值，我们首先需要根据给定的消除半衰期 $t_{1/2} = 3.0\\,\\mathrm{h}$ 来确定消除速率常数 $k_{el}$。它们的关系是：\n$$ k_{el} = \\frac{\\ln(2)}{t_{1/2}} $$\n代入 $t_{1/2}$ 的值：\n$$ k_{el} = \\frac{\\ln(2)}{3.0\\,\\mathrm{h}} $$\n现在，我们可以计算指数 $k_{el}\\tau$：\n$$ k_{el}\\tau = \\left(\\frac{\\ln(2)}{3.0\\,\\mathrm{h}}\\right) \\cdot (12\\,\\mathrm{h}) = 4\\ln(2) = \\ln(2^4) = \\ln(16) $$\n最后，我们计算波动比：\n$$ \\frac{C_{\\max}}{C_{\\min}} = \\exp(k_{el}\\tau) = \\exp(\\ln(16)) = 16 $$\n四舍五入至三位有效数字，该比值为 $16.0$。\n条件 $k_{a} \\gg k_{el}$ 是满足的，因为 $k_a = 2.0\\,\\mathrm{h}^{-1}$ 且 $k_{el} = \\frac{\\ln(2)}{3.0} \\approx 0.231\\,\\mathrm{h}^{-1}$。", "answer": "$$\\boxed{\\begin{pmatrix} 25.7  16.0 \\end{pmatrix}}$$", "id": "4536912"}, {"introduction": "在临床实践中，患者常常需要同时服用多种药物，这使得药物-药物相互作用（DDI）成为临床药理学的一个核心议题。本练习模拟了一个常见场景：当与一种强效CYP3A4抑制剂合用时，托法替尼的暴露水平会如何变化。您将运用竞争性抑制原理来预测新的药物清除率，并计算出为维持疗效所需的剂量调整方案，这是确保联合用药安全性的关键技能。[@problem_id:4536889]", "problem": "一种雅努斯激酶 (Janus kinase, JAK) 抑制剂托法替布 (tofacitinib)，通过并行途径清除，这些途径包括细胞色素P450 3A4 (CYP3A4) 代谢和非CYP3A4途径。考虑一名服用托法替布达到稳态的患者，其基线表观口服清除率为 $CL$，其中一部分 $f_{m}$ 由CYP3A4介导，剩余部分 $(1 - f_{m})$ 代表所有其他不受CYP3A4抑制影响的清除途径。开始使用一种强效CYP3A4抑制剂。其未结合的肝入口浓度为 $I$，其对CYP3A4的竞争性抑制常数为 $K_{i}$。假设药代动力学为线性，消除为一级，且口服生物利用度 $F$ 和给药间隔不受抑制剂影响。同时假设抑制剂不影响非CYP3A4清除或药物转运。\n\n给定以下托法替布和抑制剂的临床合理值：\n- 基线表观口服清除率 $CL = 24\\,\\mathrm{L\\,h^{-1}}$，\n- CYP3A4代谢分数 $f_{m} = 0.53$，\n- 酶位点处的抑制剂未结合浓度 $I = 1.2\\,\\mu\\mathrm{M}$，\n- 竞争性抑制常数 $K_{i} = 0.030\\,\\mu\\mathrm{M}$，\n\n使用竞争性Michaelis–Menten抑制和并行途径清除率相加的第一性原理，推导出与抑制剂联合用药后新的总清除率 $CL'$ 的表达式，该表达式用 $CL$、$f_{m}$、$I$ 和 $K_{i}$ 表示。然后，假设给药间隔不变，计算在开始使用抑制剂后维持相同平均稳态浓度 $C_{\\mathrm{ss,avg}}$ 所需的剂量比例减少因子。将剂量减少因子报告为无单位小数，并四舍五入到四位有效数字。", "solution": "该问题要求在存在竞争性CYP3A4抑制剂的情况下，推导托法替布的新表观口服清除率（$CL'$）的表达式，然后计算剂量减少因子。解决方案基于并行清除途径和竞争性酶抑制的原理。\n\n首先，我们验证问题陈述。\n\n**第1步：提取已知条件**\n-   基线表观口服清除率：$CL = 24\\,\\mathrm{L\\,h^{-1}}$\n-   由CYP3A4介导的$CL$分数：$f_{m} = 0.53$\n-   抑制剂未结合浓度：$I = 1.2\\,\\mu\\mathrm{M}$\n-   竞争性抑制常数：$K_{i} = 0.030\\,\\mu\\mathrm{M}$\n-   假设：线性药代动力学，一级消除，口服生物利用度$F$不变，给药间隔$\\tau$不变，抑制剂对非CYP3A4清除或药物转运无影响。\n\n**第2步：使用提取的已知条件进行验证**\n该问题在科学上基于已建立的药物-药物相互作用的药代动力学原理，特别是主要代谢途径（CYP3A4）的竞争性抑制。该情景设定良好，提供了所有必要的参数和假设以得出一个唯一的解。给定的数值对于涉及托法替布的强药物-药物相互作用是临床上合理的。该问题是客观的、可形式化的，并且不包含矛盾或模糊之处。\n\n**第3步：结论与行动**\n问题被认为是有效的。我们继续进行求解。\n\n**新总清除率（$CL'$）的推导**\n\n基线表观口服清除率$CL$由两个并行途径组成：CYP3A4代谢和所有其他清除途径。设$CL_{CYP3A4}$为通过CYP3A4的清除率，$CL_{other}$为通过其他途径的清除率。总清除率是这些并行途径清除率的总和：\n$$CL = CL_{CYP3A4} + CL_{other}$$\n根据问题陈述，总清除率的一部分$f_m$归因于CYP3A4。因此，我们可以用$CL$和$f_m$来表示这些组分清除率：\n$$CL_{CYP3A4} = f_m \\cdot CL$$\n$$CL_{other} = (1 - f_m) \\cdot CL$$\n问题陈述，使用了一种CYP3A4的竞争性抑制剂。该抑制剂不影响非CYP3A4清除途径，因此该途径的新清除率$CL'_{other}$保持不变：\n$$CL'_{other} = CL_{other} = (1 - f_m) \\cdot CL$$\n对于表现出一级动力学的代谢途径（由线性药代动力学假设所暗示，其中底物浓度远低于Michaelis常数$K_m$），其清除率由最大速度$V_{max}$与$K_m$之比给出。竞争性抑制使表观$K_m$增加一个因子$(1 + I/K_i)$，其中$I$是酶位点处的抑制剂浓度，$K_i$是抑制常数。因此，被抑制途径的新清除率$CL'_{CYP3A4}$为：\n$$CL'_{CYP3A4} = \\frac{CL_{CYP3A4}}{1 + \\frac{I}{K_i}}$$\n代入$CL_{CYP3A4}$的表达式：\n$$CL'_{CYP3A4} = \\frac{f_m \\cdot CL}{1 + \\frac{I}{K_i}}$$\n新的总表观口服清除率$CL'$是新组分清除率的总和：\n$$CL' = CL'_{CYP3A4} + CL'_{other}$$\n代入每个组分的表达式：\n$$CL' = \\frac{f_m \\cdot CL}{1 + \\frac{I}{K_i}} + (1 - f_m) \\cdot CL$$\n这就是根据给定参数推导出的新总清除率$CL'$的表达式。\n\n**剂量减少因子的推导与计算**\n\n平均稳态药物浓度$C_{\\mathrm{ss,avg}}$由以下关系式给出：\n$$C_{\\mathrm{ss,avg}} = \\frac{\\text{给药速率}}{CL} = \\frac{D/\\tau}{CL}$$\n其中$D$是剂量，$\\tau$是给药间隔。\n\n设原始剂量为$D_{0}$，维持相同稳态浓度所需的新剂量为$D_{new}$。原始稳态浓度为 $C_{\\mathrm{ss,avg},0} = \\frac{D_0/\\tau}{CL}$。新的稳态浓度为 $C_{\\mathrm{ss,avg},new} = \\frac{D_{new}/\\tau}{CL'}$。\n问题要求$C_{\\mathrm{ss,avg},new} = C_{\\mathrm{ss,avg},0}$。由于给药间隔$\\tau$保持不变：\n$$\\frac{D_{new}}{CL'} = \\frac{D_0}{CL}$$\n重新整理以求新剂量，可得：\n$$D_{new} = D_0 \\cdot \\frac{CL'}{CL}$$\n剂量比例减少因子，我们记为$R_D$，是新剂量与原始剂量的比值：\n$$R_D = \\frac{D_{new}}{D_0} = \\frac{CL'}{CL}$$\n代入推导出的$CL'$表达式：\n$$R_D = \\frac{1}{CL} \\left( \\frac{f_m \\cdot CL}{1 + \\frac{I}{K_i}} + (1 - f_m) \\cdot CL \\right)$$\n$CL$项消去：\n$$R_D = \\frac{f_m}{1 + \\frac{I}{K_i}} + (1 - f_m)$$\n现在，我们将给定的数值代入$R_D$的表达式中：\n-   $f_{m} = 0.53$\n-   $I = 1.2\\,\\mu\\mathrm{M}$\n-   $K_{i} = 0.030\\,\\mu\\mathrm{M}$\n\n首先，计算抑制项的比率：\n$$\\frac{I}{K_i} = \\frac{1.2}{0.030} = 40$$\n现在，将此值代入$R_D$的表达式中：\n$$R_D = \\frac{0.53}{1 + 40} + (1 - 0.53)$$\n$$R_D = \\frac{0.53}{41} + 0.47$$\n$$R_D \\approx 0.0129268... + 0.47$$\n$$R_D \\approx 0.4829268...$$\n问题要求将结果四舍五入到四位有效数字。\n$$R_D \\approx 0.4829$$\n\n这个0.4829的剂量减少因子意味着，新剂量应约为原始剂量的$48.29\\%$，以维持相同的平均稳态浓度。", "answer": "$$\\boxed{0.4829}$$", "id": "4536889"}, {"introduction": "临床药理学的最终目标是将药物暴露（PK）与临床效应（PD）联系起来，这需要通过分析临床试验数据来构建暴露-反应（E-R）模型。这项高级实践将指导您完成现代药物开发中的一项核心任务：您需要推导一个S型Emax模型，并利用非线性最小二乘法来拟合（假设的）临床数据，从而量化JAK抑制剂的效能（$EC_{50}$）和最大效应（$E_{max}$）。通过这个计算实践，您将掌握从临床观察中提炼关键药效学参数的核心方法。[@problem_id:4536862]", "problem": "一种如乌帕替尼（upadacitinib）的雅努斯激酶（JAK）抑制剂可调节特应性皮炎中的炎症信号，其临床反应可通过湿疹面积和严重程度指数（EASI）进行总结。令 $C$ 表示稳态时的平均血浆浓度，单位为 $\\mathrm{ng/mL}$。令 $E(C)$ 表示 EASI 相对于基线的相对改善率，它是一个在 $[0,1]$ 范围内的无量纲数。从以下基本原理出发：\n- 适用于配体-靶点结合和受体占有率的质量作用定律。\n- 药效学效应是将占有率转导为具有最大可实现效应的有界响应的概念。\n- 效应的非药物基线组分和药物介导组分的可加性。\n\n从第一性原理出发，推导一个参数函数 $E(C)$，该函数将浓度 $C$ 映射到预期的平均相对改善率，使用以下参数：\n- 一个基线组分 $E_{0}$（无量纲），可归因于非特异性效应和安慰剂效应。\n- 一个最大药物介导组分 $E_{\\max}$（无量纲），表示在非常高的 $C$ 值下，超出基线的渐进增量效应。\n- 一个效价参数 $\\mathrm{EC}_{50}$（单位为 $\\mathrm{ng/mL}$），用于量化在模型的占有率-效应假设下，达到最大药物介导组分一半时的浓度。\n- 一个 Hill（S型）系数 $n$（无量纲），反映协同性或净转导陡度。\n\n使用推导出的函数，为给定的观测对 $\\{(C_{i}, y_{i})\\}$ 构建 $(\\mathrm{EC}_{50}, E_{\\max})$ 的普通最小二乘估计量，其中 $y_{i}$ 是 $E(C_{i})$ 的样本均值。强制执行约束条件 $E_{\\max} \\ge 0$ 和 $\\mathrm{EC}_{50} > 0$。不要估计 $E_{0}$ 或 $n$；它们在每个数据集中都是已知常数。\n\n实现一个程序，对下面的每个数据集，通过最小化观测值 $y_{i}$ 与使用推导函数在 $C_{i}$ 处的模型预测值之间的残差平方和来估计 $(\\mathrm{EC}_{50}, E_{\\max})$。报告 $\\mathrm{EC}_{50}$（单位为 $\\mathrm{ng/mL}$）和 $E_{\\max}$（以小数形式表示）。程序必须处理一个包含三个数据集的测试套件，这些数据集用于探测不同的 S 型性状和饱和度范围。\n\n测试套件（每个 $C$ 列表的单位为 $\\mathrm{ng/mL}$；每个 $y$ 列表为无量纲的相对改善率）：\n- 数据集 A（中等 S 型性状，$n=1$）：\n  - 已知：$E_{0} = 0.10$（无量纲），$n = 1.0$（无量纲）。\n  - 浓度：$C = [0.0, 10.0, 25.0, 50.0, 100.0]$。\n  - 观测均值：$y = [0.10, 0.30, 0.45, 0.5666666667, 0.66]$。\n- 数据集 B（更陡的 S 型性状，$n=2$）：\n  - 已知：$E_{0} = 0.15$（无量纲），$n = 2.0$（无量纲）。\n  - 浓度：$C = [0.0, 15.0, 30.0, 60.0, 120.0]$。\n  - 观测均值：$y = [0.15, 0.28, 0.475, 0.67, 0.7617647058823529]$。\n- 数据集 C（最大效应较低，包含强饱和点）：\n  - 已知：$E_{0} = 0.05$（无量纲），$n = 1.0$（无量纲）。\n  - 浓度：$C = [0.0, 5.0, 10.0, 20.0, 200.0]$。\n  - 观测均值：$y = [0.05, 0.11666666666666667, 0.15, 0.18333333333333335, 0.24047619047619047]$。\n\n要求：\n- 使用您从上述基本原理推导出的函数 $E(C)$。\n- 通过非线性最小二乘法估计 $(\\mathrm{EC}_{50}, E_{\\max})$，并施加指定的非负性/正性约束。\n- 以单行形式返回结果，格式为：一个包含三个列表的列表，每个数据集对应一个，每个内部列表包含 $[\\mathrm{EC}_{50}, E_{\\max}]$。\n- 四舍五入和单位：打印 $\\mathrm{EC}_{50}$（单位为 $\\mathrm{ng/mL}$），保留两位小数；打印 $E_{\\max}$（以小数形式表示），保留四位小数。\n- 最终输出格式：您的程序应生成单行输出，包含以逗号分隔的列表形式的结果，并用方括号括起来，例如 $[[x_{1},y_{1}],[x_{2},y_{2}],[x_{3},y_{3}]]$, 不含多余的空格或文本。\n- 程序必须是自包含的，无需输入。它应使用确定性优化来为测试套件中的所有数据集生成估计值。", "solution": "该问题要求推导药效学响应的参数函数，然后实现一个带约束的非线性最小二乘参数估计程序。\n\n### 第一部分：药效学模型 $E(C)$ 的推导\n\n推导过程基于问题陈述中提供的三个基本原理。\n\n**1. 基线效应和药物介导效应的可加性**\n观察到的总临床响应，记为 $E(C)$，被建模为两个组分的和：一个与药物浓度无关的基线效应 $E_{0}$，以及一个依赖于浓度 $C$ 的药物介导效应 $E_{drug}(C)$。\n$$E(C) = E_{0} + E_{drug}(C)$$\n在这里，$E_{0}$ 代表在没有药物（$C=0$）时观察到的响应，例如安慰剂效应或疾病的自然病程。\n\n**2. 占有率与效应之间的关系**\n质量作用定律控制着药物（配体，$L$）与其靶点（受体，$R$）的结合。被药物占据的受体分数 $\\Theta$ 是药物浓度 $C$ 的函数。药效学效应是这种占有率的转导。药物介导的效应 $E_{drug}(C)$ 被建模为与此占有率的某个函数成正比，当占有率达到饱和（$\\Theta=1$）时，达到最大增量值 $E_{\\max}$。\n\n**3. S 型 $E_{\\max}$ 模型**\n问题规定使用 Hill 系数 $n$，它将简单的 1:1 结合模型推广，以解释协同性或复杂的信号转导通路。这直接导出了 Hill 方程，这是药理学中一个标准的 S 型模型，用于关联浓度与效应。药物介导的效应表示为：\n$$E_{drug}(C) = E_{\\max} \\frac{C^n}{C^n + (\\mathrm{EC}_{50})^n}$$\n在此公式中：\n- $E_{\\max}$ 是最大的药物归因效应，是基线 $E_{0}$ 之上的一个增量效应。\n- $\\mathrm{EC}_{50}$ 是产生最大药物介导效应 $E_{\\max}$ 的 $50\\%$ 时药物的浓度。\n- $n$ 是 Hill 系数，它决定了浓度-响应曲线的陡度（S 型性状）。\n\n将可加性原理与药物效应的 S 型模型相结合，得到总响应 $E(C)$ 的最终参数函数：\n$$E(C) = E_{0} + E_{\\max} \\frac{C^n}{C^n + (\\mathrm{EC}_{50})^n}$$\n该模型与所提供的定义一致。当 $C=0$ 时，$E(0) = E_{0}$。当 $C \\to \\infty$ 时，$E(C) \\to E_{0} + E_{\\max}$。当 $C=\\mathrm{EC}_{50}$ 时，效应的药物介导部分为 $E_{\\max} \\frac{(\\mathrm{EC}_{50})^n}{(\\mathrm{EC}_{50})^n + (\\mathrm{EC}_{50})^n} = \\frac{1}{2}E_{\\max}$，符合要求。\n\n### 第二部分：普通最小二乘（OLS）估计\n\n我们的任务是从一组观测数据点 $\\{(C_{i}, y_{i})\\}_{i=1}^{N}$ 中估计参数 $\\theta = (\\mathrm{EC}_{50}, E_{\\max})$，其中 $y_i$ 是在浓度 $C_i$ 处观测到的平均响应。参数 $E_{0}$ 和 $n$ 在每个数据集中都被视为已知常数。\n\nOLS 方法旨在找到使残差平方和（SSR）最小化的参数值。第 $i$ 个观测值的残差 $r_i$ 是观测响应 $y_i$ 与模型预测响应 $\\hat{y}_i = E(C_i; \\mathrm{EC}_{50}, E_{\\max})$ 之间的差值。\n$$r_i = y_i - \\hat{y}_i = y_i - \\left( E_{0} + E_{\\max} \\frac{C_i^n}{(\\mathrm{EC}_{50})^n + C_i^n} \\right)$$\nSSR 是需要最小化的目标函数：\n$$\\mathrm{SSR}(\\mathrm{EC}_{50}, E_{\\max}) = \\sum_{i=1}^{N} r_i^2 = \\sum_{i=1}^{N} \\left( y_i - E_{0} - E_{\\max} \\frac{C_i^n}{(\\mathrm{EC}_{50})^n + C_i^n} \\right)^2$$\n该最小化过程必须在具有科学动机的约束条件下进行：$\\mathrm{EC}_{50} > 0$ 和 $E_{\\max} \\ge 0$。\n\n### 第三部分：数值实现策略\n\nSSR 的最小化是一个非线性的、带约束的优化问题。我们将使用数值求解器来找到最优参数 $\\widehat{\\theta} = (\\widehat{\\mathrm{EC}}_{50}, \\widehat{E}_{\\max})$。SciPy 库中的 `scipy.optimize.minimize` 函数非常适合此任务。\n\n对于每个数据集，实现将按以下步骤进行：\n1.  定义一个目标函数，该函数为给定的参数集 $(\\mathrm{EC}_{50}, E_{\\max})$、浓度-响应数据 $(C, y)$ 和已知常数 $(E_0, n)$ 计算 SSR。\n2.  为 $\\mathrm{EC}_{50}$ 和 $E_{\\max}$ 提供合理的初始猜测值。\n3.  指定参数边界：$\\mathrm{EC}_{50}$ 的边界为 $(\\epsilon, \\infty)$（其中 $\\epsilon$ 是一个小的正数以强制严格为正），$E_{\\max}$ 的边界为 $[0, \\infty)$。\n4.  使用 `L-BFGS-B` 方法调用 `scipy.optimize.minimize`，该方法对于有界约束问题是高效的。\n5.  从结果中提取优化后的参数。\n6.  根据指定的舍入规则（$\\mathrm{EC}_{50}$ 保留两位小数，$E_{\\max}$ 保留四位小数）格式化结果，并将其收集以用于最终输出。对所有三个数据集重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Derives a pharmacodynamic model, fits it to data using nonlinear least squares,\n    and reports the estimated parameters for three datasets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"E0\": 0.10,\n            \"n\": 1.0,\n            \"C\": np.array([0.0, 10.0, 25.0, 50.0, 100.0]),\n            \"y\": np.array([0.10, 0.30, 0.45, 0.5666666667, 0.66]),\n            \"x0\": [30.0, 0.6]  # Initial guess for [EC50, Emax]\n        },\n        {\n            \"E0\": 0.15,\n            \"n\": 2.0,\n            \"C\": np.array([0.0, 15.0, 30.0, 60.0, 120.0]),\n            \"y\": np.array([0.15, 0.28, 0.475, 0.67, 0.7617647058823529]),\n            \"x0\": [40.0, 0.7]  # Initial guess for [EC50, Emax]\n        },\n        {\n            \"E0\": 0.05,\n            \"n\": 1.0,\n            \"C\": np.array([0.0, 5.0, 10.0, 20.0, 200.0]),\n            \"y\": np.array([0.05, 0.11666666666666667, 0.15, 0.18333333333333335, 0.24047619047619047]),\n            \"x0\": [15.0, 0.2]  # Initial guess for [EC50, Emax]\n        }\n    ]\n\n    def model_func(C_data, params, E0, n):\n        \"\"\"\n        Calculates the predicted effect E(C) using the sigmoidal Emax model.\n        E(C) = E0 + Emax * C^n / (EC50^n + C^n)\n        \"\"\"\n        EC50, Emax = params\n        \n        # Power terms\n        C_pow_n = np.power(C_data, n)\n        EC50_pow_n = np.power(EC50, n)\n        \n        # Calculate drug effect. Denominator is safe due to EC50 > 0 bound.\n        # For C=0, C_pow_n=0, so drug_effect is 0.\n        drug_effect = Emax * C_pow_n / (EC50_pow_n + C_pow_n)\n        \n        return E0 + drug_effect\n\n    def objective_func(params, C_data, y_data, E0, n):\n        \"\"\"\n        Objective function for OLS: calculates the sum of squared residuals (SSR).\n        \"\"\"\n        y_predicted = model_func(C_data, params, E0, n)\n        residuals = y_data - y_predicted\n        return np.sum(residuals**2)\n\n    results = []\n    for case in test_cases:\n        # Extract data for the current case\n        C_data = case[\"C\"]\n        y_data = case[\"y\"]\n        E0 = case[\"E0\"]\n        n = case[\"n\"]\n        initial_guess = case[\"x0\"]\n\n        # Define parameter bounds: EC50 > 0, Emax >= 0.\n        # Use a small positive number for the lower bound of EC50.\n        bounds = [(1e-9, None), (0, None)]\n\n        # Perform the constrained nonlinear optimization\n        opt_result = minimize(\n            fun=objective_func,\n            x0=initial_guess,\n            args=(C_data, y_data, E0, n),\n            method='L-BFGS-B',\n            bounds=bounds\n        )\n\n        # Extract optimal parameters\n        EC50_opt, Emax_opt = opt_result.x\n\n        # Format results as per problem specification and append\n        formatted_result = [\n            round(EC50_opt, 2),\n            round(Emax_opt, 4)\n        ]\n        results.append(formatted_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'[{res[0]},{res[1]}]' for res in results])}]\")\n\nsolve()\n```", "id": "4536862"}]}