{"hands_on_practices": [{"introduction": "要设计有效的多剂量给药方案，理解稳态概念至关重要。本实践练习侧重于推导和计算稳态平均浓度 ($C_{avg,ss}$)，这是表示给药间隔期间总体药物暴露水平的关键指标。通过从清除率和生物利用度的基本原理出发，您将巩固对这些基本参数如何共同决定体内药物水平的理解 [@problem_id:4576899]。", "problem": "一种具有线性和时不变药代动力学特征的药物，在多次给药方案下口服给药并达到稳态。进入体循环的给药剂量分数（口服生物利用度）为 $F=0.6$。每次口服剂量为 $D=200\\ \\text{mg}$。体清除率，定义为消除速率与浓度之间的比例系数，其值为 $CL=10\\ \\text{L/h}$。给药间隔为 $\\tau=12\\ \\text{h}$。假设药代动力学为线性，并且在该给药方案下已达到稳态。使用清除率和暴露量的核心定义，以及浓度的时间平均定义，推导稳态时一个给药间隔内的平均血浆浓度，并计算其数值。最终浓度以 $\\text{mg/L}$ 为单位表示，并将答案四舍五入至四位有效数字。定义并使用任何必要的量，包括血浆浓度-时间曲线下面积（AUC）和时间平均的数学定义，但除了基本的药代动力学定义外，不要假设任何针对该药物的快捷公式。为清楚起见，回顾一下，药代动力学（PK）指药物的浓度-时间行为，而药效动力学（PD）指药物的效果；此处的重点是药代动力学（PK）。", "solution": "在尝试给出解答之前，首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 药物具有线性和时不变的药代动力学特征。\n- 给药方式：在多次给药方案下口服给药，已达稳态。\n- 口服生物利用度：$F = 0.6$。\n- 口服剂量：$D = 200\\ \\text{mg}$。\n- 体清除率：$CL = 10\\ \\text{L/h}$。\n- 给药间隔：$\\tau = 12\\ \\text{h}$。\n- 假设：已达到稳态。\n- 任务：推导稳态平均血浆浓度 $C_{ss,avg}$，并计算其数值。\n- 方法论：使用清除率和暴露量的核心定义，以及浓度的时间平均定义。需要定义和使用的量是血浆浓度-时间曲线下面积（$AUC$）和时间平均的数学定义。不得假定任何快捷公式。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行评估。\n- **科学依据：** 该问题是临床药代动力学（药理学的一个分支学科）中的一个标准练习。它依赖于基本且普遍接受的原理，如清除率、生物利用度和稳态的定义。所有概念都具有科学合理性。\n- **良定性：** 问题提供了确定所求量（$C_{ss,avg}$）所需的完整参数集（$F$、$D$、$CL$、$\\tau$）。从第一性原理推导结果的说明清晰，能够得出一个唯一、稳定且有意义的解。\n- **客观性：** 问题使用药代动力学领域中常见的精确技术语言进行陈述。它没有歧义、主观性或观点性。\n- **其他缺陷：** 该问题没有违反任何其他标准。它内部一致，参数在物理和生物学上是现实的，并且它是一个可形式化且非平凡的问题，用以检验概念理解。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供解答。\n\n### 解答推导\n目标是从基本原理出发，推导稳态时一个给药间隔内的平均血浆浓度 $C_{ss,avg}$ 的表达式。\n\n出发点是时间平均函数的数学定义。一个给药间隔 $\\tau$ 内的平均浓度，是该间隔内的总浓度-时间曲线下面积（$AUC$）除以该间隔的持续时间。在稳态下，这表示为：\n$$\nC_{ss,avg} = \\frac{AUC_{ss,\\tau}}{\\tau}\n$$\n其中，$AUC_{ss,\\tau}$ 是在稳态下从时间 $t$ 到 $t+\\tau$ 的浓度-时间曲线下面积。在数学上，如果 $C(t)$ 是时间 $t$ 时的血浆浓度，那么：\n$$\nAUC_{ss,\\tau} = \\int_{t_{ss}}^{t_{ss}+\\tau} C(t) dt\n$$\n其中，$t_{ss}$ 是达到稳态后的任意时间点。\n\n接下来，我们引入体清除率 $CL$ 的定义。清除率定义为单位时间内从血浆中清除药物的体积。它将药物从体内的消除速率与其血浆浓度联系起来：\n$$\n\\text{消除速率}(t) = CL \\cdot C(t)\n$$\n这个关系成立，因为问题说明了药代动力学是线性的。\n\n在稳态下一个给药间隔内从体内消除的药物总量，记为 $Amount_{elim,ss,\\tau}$，可以通过对消除速率在间隔 $\\tau$ 上积分得到：\n$$\nAmount_{elim,ss,\\tau} = \\int_{t_{ss}}^{t_{ss}+\\tau} \\text{Rate of elimination}(t) dt = \\int_{t_{ss}}^{t_{ss}+\\tau} CL \\cdot C(t) dt\n$$\n由于清除率 $CL$ 是一个常数（因为药代动力学是时不变的），它可以从积分中提出来：\n$$\nAmount_{elim,ss,\\tau} = CL \\cdot \\int_{t_{ss}}^{t_{ss}+\\tau} C(t) dt\n$$\n根据定义，此表达式中的积分就是 $AUC_{ss,\\tau}$。因此，我们在消除量、清除率和 AUC 之间建立了一个关键联系：\n$$\nAmount_{elim,ss,\\tau} = CL \\cdot AUC_{ss,\\tau}\n$$\n\n要应用的最后一个原理是稳态的定义。在稳态下，平均到一个给药间隔，药物的给药速率等于药物的消除速率。这意味着在一个给药间隔内进入体循环的药物总量必须等于在同一间隔内被消除的药物总量。\n\n给药量为剂量 $D$。该剂量中进入体循环的分数是生物利用度 $F$。因此，每个给药间隔内进入体循环的药量是生物利用剂量 $F \\cdot D$。\n$$\n\\text{每个间隔内体循环吸收量} = F \\cdot D\n$$\n在稳态下，这必须等于每个间隔的消除量：\n$$\nAmount_{elim,ss,\\tau} = F \\cdot D\n$$\n\n我们现在有两个关于 $Amount_{elim,ss,\\tau}$ 的表达式：\n1.  $Amount_{elim,ss,\\tau} = CL \\cdot AUC_{ss,\\tau}$\n2.  $Amount_{elim,ss,\\tau} = F \\cdot D$\n\n令这两个表达式相等，得到：\n$$\nCL \\cdot AUC_{ss,\\tau} = F \\cdot D\n$$\n这个方程可以重排以求解 $AUC_{ss,\\tau}$：\n$$\nAUC_{ss,\\tau} = \\frac{F \\cdot D}{CL}\n$$\n\n最后，我们将这个推导出的 $AUC_{ss,\\tau}$ 表达式代回到我们最初对 $C_{ss,avg}$ 的定义中：\n$$\nC_{ss,avg} = \\frac{AUC_{ss,\\tau}}{\\tau} = \\frac{\\left(\\frac{F \\cdot D}{CL}\\right)}{\\tau}\n$$\n这简化为稳态平均浓度的最终推导公式：\n$$\nC_{ss,avg} = \\frac{F \\cdot D}{CL \\cdot \\tau}\n$$\n\n现在，我们可以将给定的数值代入此公式来计算结果。\n已知：\n- $F = 0.6$ (无量纲)\n- $D = 200\\ \\text{mg}$\n- $CL = 10\\ \\text{L/h}$\n- $\\tau = 12\\ \\text{h}$\n\n$$\nC_{ss,avg} = \\frac{0.6 \\cdot 200\\ \\text{mg}}{(10\\ \\text{L/h}) \\cdot (12\\ \\text{h})}\n$$\n$$\nC_{ss,avg} = \\frac{120\\ \\text{mg}}{120\\ \\text{L}}\n$$\n$$\nC_{ss,avg} = 1.0\\ \\text{mg/L}\n$$\n\n问题要求答案四舍五入到四位有效数字。\n$$\nC_{ss,avg} = 1.000\\ \\text{mg/L}\n$$", "answer": "$$\n\\boxed{1.000}\n$$", "id": "4576899"}, {"introduction": "虽然药代动力学模型可以预测药物浓度，但治疗的最终目标是达到预期的药效学效应。本练习将带您更进一步，将药代动力学（PK）与药效学（PD）联系起来，要求您确定一个剂量，以满足抗生素的特定治疗靶标——游离药物浓度高于最低抑菌浓度的时间百分比 ($fT\\gt MIC$)。这项实践展示了 PK/PD 模型如何在临床关键情况下直接指导合理的剂量选择 [@problem_id:4576855]。", "problem": "一名疑似革兰氏阴性败血症的成年患者将接受静脉注射β-内酰胺类抗生素。假设采用单室模型，具有线性动力学、每次给药后瞬时分布和一级消除的特点。时间依赖性杀菌的药效学靶标是每个给药间隔内超出最低抑菌浓度的时间分数（表示为 $fTMIC$）为 $0.60$。药物的游离（未结合）分数为 $f=0.70$，最低抑菌浓度 (MIC) 为 $1$ mg/L，消除半衰期为 $t_{1/2}=2$ 小时，给药间隔为 $\\tau=8$ 小时（即每 $8$ 小时一次），稳态时的表观分布容积为 $V_d=25$ L（反映了细胞外液容量的扩大）。假设处于稳态，并忽略任何时变性蛋白结合。\n\n使用一级消除和多次给药叠加的基本原理，确定以每8小时（q8h）一次的给药方案达到 $fTMIC=0.60$ 所需的每次给药剂量（以毫克为单位）。\n\n- 以毫克为单位表示最终的每次给药剂量。\n- 将您的答案四舍五入至三位有效数字。", "solution": "我们从单室模型中一级消除和稳态叠加的核心定义开始。\n\n1. 将消除速率常数与半衰期联系起来：\n$$\nk \\;=\\; \\frac{\\ln 2}{t_{1/2}}.\n$$\n\n2. 对于瞬时分布和线性动力学的静脉推注剂量，单次给药后的浓度衰减如下：\n$$\nC(t) \\;=\\; C_{0}\\,\\exp(-k t), \\quad t \\ge 0,\n$$\n其中 $C_{0}$ 是给药后瞬间的浓度。对于每隔 $\\tau$ 小时给予的多次相同剂量，一个给药间隔内的稳态浓度曲线是周期性的，等于从稳态峰浓度 $C_{\\max,\\text{ss}}$ 开始的指数衰减：\n$$\nC_{\\text{ss}}(t) \\;=\\; C_{\\max,\\text{ss}}\\,\\exp(-k t), \\quad 0 \\le t \\le \\tau.\n$$\n通过重复推注的几何级数叠加，稳态峰浓度与剂量和分布容积的关系为：\n$$\nC_{\\max,\\text{ss}} \\;=\\; \\frac{\\text{Dose}/V_d}{1 - \\exp(-k\\tau)}.\n$$\n\n3. 药效学靶标以游离（未结合）浓度 $f\\,C_{\\text{ss}}(t)$ 表示。定义 $t_M$ 为一个给药间隔内 $f\\,C_{\\text{ss}}(t)$ 超过最低抑菌浓度 (MIC) 的持续时间。在边界时间 $t_M$ 时，\n$$\nf\\,C_{\\text{ss}}(t_M) \\;=\\; \\text{MIC}.\n$$\n使用 $C_{\\text{ss}}(t)=C_{\\max,\\text{ss}}\\,\\exp(-k t)$，求解 $t_M$：\n$$\nf\\,C_{\\max,\\text{ss}}\\,\\exp(-k t_M) \\;=\\; \\text{MIC}\n\\;\\;\\Rightarrow\\;\\;\n\\exp(-k t_M) \\;=\\; \\frac{\\text{MIC}}{f\\,C_{\\max,\\text{ss}}}\n\\;\\;\\Rightarrow\\;\\;\nt_M \\;=\\; \\frac{1}{k}\\,\\ln\\!\\left(\\frac{f\\,C_{\\max,\\text{ss}}}{\\text{MIC}}\\right).\n$$\n\n4. 靶标 $fTMIC = 0.60$ 意味着游离浓度应在每个给药间隔的 $0.60$ 的时间分数内超过 MIC，因此：\n$$\n\\frac{t_M}{\\tau} \\;=\\; 0.60\n\\;\\;\\Rightarrow\\;\\;\nt_M \\;=\\; 0.60\\,\\tau.\n$$\n将此式与上面的表达式相等，得到对稳态峰浓度的要求：\n$$\n\\frac{1}{k}\\,\\ln\\!\\left(\\frac{f\\,C_{\\max,\\text{ss}}}{\\text{MIC}}\\right) \\;=\\; 0.60\\,\\tau\n\\;\\;\\Rightarrow\\;\\;\n\\ln\\!\\left(\\frac{f\\,C_{\\max,\\text{ss}}}{\\text{MIC}}\\right) \\;=\\; 0.60\\,k\\,\\tau\n\\;\\;\\Rightarrow\\;\\;\nC_{\\max,\\text{ss}} \\;=\\; \\frac{\\text{MIC}}{f}\\,\\exp\\!\\big(0.60\\,k\\,\\tau\\big).\n$$\n\n5. 将此要求代入稳态峰浓度-剂量关系式，以求解所需剂量：\n$$\n\\frac{\\text{Dose}}{V_d}\\,\\frac{1}{1-\\exp(-k\\tau)} \\;=\\; \\frac{\\text{MIC}}{f}\\,\\exp\\!\\big(0.60\\,k\\,\\tau\\big)\n\\;\\;\\Rightarrow\\;\\;\n\\text{Dose} \\;=\\; V_d\\,\\big[1-\\exp(-k\\tau)\\big]\\;\\frac{\\text{MIC}}{f}\\,\\exp\\!\\big(0.60\\,k\\,\\tau\\big).\n$$\n\n6. 先以符号形式，然后以数值形式代入给定参数：\n- $t_{1/2} = 2$ 小时，所以\n$$\nk \\;=\\; \\frac{\\ln 2}{2} \\;\\text{h}^{-1}.\n$$\n- $\\tau = 8$ 小时，所以\n$$\nk\\,\\tau \\;=\\; \\frac{\\ln 2}{2}\\times 8 \\;=\\; 4\\,\\ln 2 \\;=\\; \\ln(2^{4}) \\;=\\; \\ln(16).\n$$\n因此\n$$\n\\exp(-k\\tau) \\;=\\; \\exp\\!\\big(-\\ln 16\\big) \\;=\\; \\frac{1}{16}\n\\quad\\text{and}\\quad\n1-\\exp(-k\\tau) \\;=\\; 1-\\frac{1}{16} \\;=\\; \\frac{15}{16}.\n$$\n同样地，\n$$\n0.60\\,k\\,\\tau \\;=\\; 0.60 \\times \\ln(16) \\;=\\; \\ln\\!\\big(16^{0.60}\\big) \\;=\\; \\ln\\!\\big(2^{4\\times 0.60}\\big) \\;=\\; \\ln\\!\\big(2^{2.4}\\big),\n$$\n所以\n$$\n\\exp\\!\\big(0.60\\,k\\,\\tau\\big) \\;=\\; 2^{2.4}.\n$$\n将这些代入剂量表达式中：\n$$\n\\text{Dose} \\;=\\; V_d \\left(\\frac{15}{16}\\right)\\,\\frac{\\text{MIC}}{f}\\,2^{2.4}.\n$$\n\n7. 使用 $V_d=25$ L，$\\text{MIC}=1$ mg/L 和 $f=0.70$ 计算数值：\n- $2^{2.4} \\approx 5.278031643$，\n- $\\frac{15}{16} = 0.9375$，\n- $\\frac{\\text{MIC}}{f} = \\frac{1}{0.70} \\approx 1.428571429$。\n因此\n$$\n\\text{Dose} \\;\\approx\\; 25 \\times 0.9375 \\times 1.428571429 \\times 5.278031643 \\;\\text{mg}\n\\;\\approx\\; 176.7198095 \\;\\text{mg}.\n$$\n\n四舍五入到三位有效数字，每次给药所需的剂量为 $177$ mg。\n\n因此，在所述假设下，要通过每8小时给药一次的方案达到 $fTMIC=0.60$ 的目标，每次给药剂量应为 $177$ mg。", "answer": "$$\\boxed{177}$$", "id": "4576855"}, {"introduction": "前面的练习侧重于“典型”个体，但药物反应在人群中可能存在显著差异。最后一个实践将向您介绍一种现代药理计量学技术：蒙特卡洛模拟，用于评估一个给药方案在具有个体间差异的虚拟人群中的表现。通过模拟成千上万个个体，您可以估算达到治疗目标的概率，并评估所提出方案的稳健性，这是模型引导的药物开发（MIDD）的基石 [@problem_id:4576837]。", "problem": "要求您设计并实现一个基于仿真的程序，用于量化在单室、线性药代动力学模型中稳态谷浓度的给药方案性能，该程序适用于临床药理学中的剂量和给药方案选择。该模型考虑血管外给药且药物瞬间进入、一级消除以及清除率的个体间变异。您的实现必须遵循基本的质量平衡定律以及清除率和体积的定义，而不依赖任何预封装的药理计量学快捷方式。\n\n起点和待使用的定义：\n- 药代动力学/药效动力学 (PK/PD) 指的是剂量、药物浓度随时间的变化以及效应之间的定量关系；在此任务中，仅关注药代动力学。\n- 清除率 $CL$ 定义为消除速率等于 $CL \\cdot C$，其中 $C$ 是浓度，而分布容积 $V$ 通过 $C = A/V$ 将药物量 $A$ 与浓度相关联。对于单室模型和一级消除，消除速率常数为 $k = CL/V$。在血管外瞬时输入和线性动力学的情况下，两次给药之间的浓度根据质量平衡呈指数衰减。\n- 在线性动力学和固定给药间隔的多次给药下，达到稳态时，总浓度是先前剂量的指数衰减贡献的叠加。\n\n个体间变异 (IIV) 模型：\n- 假设 $CL$ 存在对数正态的个体间变异：对于个体 $i$，其 $CL_i = CL_{typ} \\exp(\\eta_i)$，其中 $\\eta_i$ 服从均值为 $0$、方差为 $\\omega^2$ 的正态分布。将给定的自然标度上的变异系数（表示为 $\\omega_{CL}$）解释为在对数正态模型下 $CL_i$ 分布所期望的变异系数。您必须校准 $\\omega$，使得 $CL_i$ 在自然标度上的变异系数等于 $\\omega_{CL}$。典型值 $CL_{typ}$ 是对数正态分布的几何平均值。对于所有个体，体积 $V$ 固定为其典型值。在所有情况下，生物利用度 $F=1$。\n\n目标：\n- 对每个测试案例，模拟一个包含 $N$ 个个体的虚拟队列，根据上述 IIV 模型抽取 $CL_i$ 值，为每个个体计算在指定剂量 $D$ 和给药间隔 $\\tau$ 下的精确稳态谷浓度 $C_{min,ss}$（即下一次给药前的瞬间浓度），并估计 $C_{min,ss}  C_{min,target}$ 的个体比例。\n- 稳态谷浓度的计算必须遵循第一性原理：单室模型中的质量平衡和一级消除，使用先前剂量的衰减贡献的叠加，以及定义 $k = CL/V$。\n\n仿真要求：\n- 使用固定的随机数生成器种子 $20231111$ 以确保可复现性。\n- 所有浓度单位必须为 $\\text{mg/L}$，清除率单位为 $\\text{L/h}$，体积单位为 $\\text{L}$，时间单位为 $\\text{h}$，剂量单位为 $\\text{mg}$。\n- 估计的比例必须以小数形式打印（不带百分号），每个值四舍五入到 $6$ 位小数。\n\n测试套件：\n对于以下每个参数集，按照上述说明计算所需比例。在所有情况下，使用 $F=1$。\n\n1. 基线变异性与给药方案：\n   - $CL_{typ} = 6\\,\\text{L/h}$, $V_{typ} = 60\\,\\text{L}$, $\\omega_{CL} = 0.30$ (变异系数), $D = 100\\,\\text{mg}$, $\\tau = 12\\,\\text{h}$, $N=100000$, $C_{min,target} = 2\\,\\text{mg/L}$。\n\n2. 零变异性边界情况：\n   - $CL_{typ} = 6\\,\\text{L/h}$, $V_{typ} = 60\\,\\text{L}$, $\\omega_{CL} = 0.00$ (变异系数), $D = 100\\,\\text{mg}$, $\\tau = 12\\,\\text{h}$, $N=1000$, $C_{min,target} = 2\\,\\text{mg/L}$。\n\n3. 较高剂量下的变异性：\n   - $CL_{typ} = 6\\,\\text{L/h}$, $V_{typ} = 60\\,\\text{L}$, $\\omega_{CL} = 0.30$ (变异系数), $D = 500\\,\\text{mg}$, $\\tau = 12\\,\\text{h}$, $N=100000$, $C_{min,target} = 2\\,\\text{mg/L}$。\n\n4. 较长给药间隔与较慢的典型清除率：\n   - $CL_{typ} = 3\\,\\text{L/h}$, $V_{typ} = 60\\,\\text{L}$, $\\omega_{CL} = 0.30$ (变异系数), $D = 100\\,\\text{mg}$, $\\tau = 24\\,\\text{h}$, $N=100000$, $C_{min,target} = 2\\,\\text{mg/L}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述测试案例的顺序排列结果，不含空格。每个值必须四舍五入到 $6$ 位小数。例如：$\\texttt{[0.123456,0.000000,0.987654,0.555000]}$。", "solution": "该问题是有效的，因为它基于基本的药代动力学原理，问题陈述清晰，并且包含了推导唯一解所需的所有信息。\n\n该问题要求设计一个仿真程序，以估计虚拟患者队列中稳态谷浓度（$C_{min,ss}$）低于目标阈值（$C_{min,target}$）的比例。该仿真基于一个单室药代动力学模型，该模型具有血管外瞬时给药、一级消除以及清除率的个体间变异。\n\n在此，我们将首先从第一性原理推导必要的方程，然后概述仿真算法。\n\n**1. 稳态谷浓度 ($C_{min,ss}$) 的推导**\n\n该模型由单室内的质量平衡定义。设 $A(t)$ 为时刻 $t$ 体内的药物量，$V$ 为分布容积，$CL$ 为清除率。浓度为 $C(t) = A(t)/V$。消除速率定义为 $CL \\cdot C(t)$。\n\n在两次给药之间，体内药物量的变化率由以下微分方程控制：\n$$\n\\frac{dA(t)}{dt} = - (\\text{消除速率}) = -CL \\cdot C(t)\n$$\n代入 $C(t) = A(t)/V$ 并定义一级消除速率常数 $k = CL/V$，我们得到：\n$$\n\\frac{dA(t)}{dt} = -\\frac{CL}{V} A(t) = -k A(t)\n$$\n这是一个一阶线性常微分方程。其解描述了药物量随时间的指数衰减：\n$$\nA(t) = A_0 e^{-kt}\n$$\n其中 $A_0$ 是时刻 $t=0$ 时的初始药物量。用浓度表示为：\n$$\nC(t) = C_0 e^{-kt}\n$$\n其中 $C_0 = A_0/V$。\n\n问题指定了一个多次给药方案，其中剂量 $D$ 以固定间隔 $\\tau$ 给药。生物利用度 $F$ 假定为 $1$。“瞬时输入”意味着在每个给药间隔开始时，体内的药物量瞬间增加剂量 $D$。\n\n设 $C_{min,ss}$ 为稳态时的谷浓度（一次给药前的瞬间浓度），$C_{max,ss}$ 为稳态时的峰浓度（一次给药后的瞬间浓度）。\n在稳态时，给药前的瞬间浓度为 $C_{min,ss}$。\n给药后，浓度立即增加 $D/V$：\n$$\nC_{max,ss} = C_{min,ss} + \\frac{D \\cdot F}{V} = C_{min,ss} + \\frac{D}{V}\n$$\n在给药间隔 $\\tau$ 内，该峰浓度呈指数衰减。下一次给药前的瞬间浓度（在稳态时，再次为 $C_{min,ss}$）是：\n$$\nC_{min,ss} = C_{max,ss} \\cdot e^{-k\\tau}\n$$\n我们现在有一个包含两个未知数 $C_{min,ss}$ 和 $C_{max,ss}$ 的方程组。将第一个方程代入第二个方程：\n$$\nC_{min,ss} = \\left( C_{min,ss} + \\frac{D}{V} \\right) e^{-k\\tau}\n$$\n$$\nC_{min,ss} = C_{min,ss} e^{-k\\tau} + \\frac{D}{V} e^{-k\\tau}\n$$\n$$\nC_{min,ss} (1 - e^{-k\\tau}) = \\frac{D}{V} e^{-k\\tau}\n$$\n解出 $C_{min,ss}$，得到稳态谷浓度的公式：\n$$\nC_{min,ss} = \\frac{D}{V} \\cdot \\frac{e^{-k\\tau}}{1 - e^{-k\\tau}}\n$$\n该公式是按要求从第一性原理推导出来的。\n\n**2. 建模个体间变异 (IIV)**\n\n问题指定了清除率（$CL$）的对数正态变异。对于个体 $i$，其清除率 $CL_i$ 由下式给出：\n$$\nCL_i = CL_{typ} \\exp(\\eta_i)\n$$\n其中 $CL_{typ}$ 是群体中的典型（几何平均）清除率，$\\eta_i$ 是从均值为 $0$、方差为 $\\omega^2$ 的正态分布中抽取的随机变量，即 $\\eta_i \\sim N(0, \\omega^2)$。\n\n我们必须根据给定的自然标度上的清除率变异系数（CV），表示为 $\\omega_{CL}$，来校准参数 $\\omega$。对于一个对数正态分布变量 $X = \\exp(Y)$，其中 $Y \\sim N(\\mu, \\sigma^2)$，其 CV 的平方与方差 $\\sigma^2$ 的关系为：\n$$\nCV^2 = \\frac{\\text{Var}(X)}{(E[X])^2} = \\exp(\\sigma^2) - 1\n$$\n在我们的案例中，$X$ 是 $CL_i$，$\\ln(CL_i) = \\ln(CL_{typ}) + \\eta_i$，因此 $\\ln(CL_i)$ 服从均值为 $\\mu = \\ln(CL_{typ})$、方差为 $\\sigma^2 = \\omega^2$ 的正态分布。给定 $CV = \\omega_{CL}$。因此：\n$$\n\\omega_{CL}^2 = \\exp(\\omega^2) - 1\n$$\n解出 $\\omega^2$，我们得到 $\\omega^2 = \\ln(\\omega_{CL}^2 + 1)$。因此，用于生成 $\\eta_i$ 值的标准差 $\\omega$ 是：\n$$\n\\omega = \\sqrt{\\ln(\\omega_{CL}^2 + 1)}\n$$\n如果 $\\omega_{CL} = 0$，则 $\\omega=0$，表示没有变异性。分布容积 $V$ 对所有个体都固定为其典型值 $V_{typ}$。\n\n**3. 仿真算法**\n\n对每个测试案例，我们执行以下步骤：\n1.  **初始化**：将随机数生成器种子设置为 $20231111$ 以确保可复现性。\n2.  **参数**：提取当前测试案例的参数：$CL_{typ}$、$V_{typ}$、$\\omega_{CL}$、$D$、$\\tau$、$N$ 和 $C_{min,target}$。\n3.  **变异性设置**：计算对数空间变异性的标准差 $\\omega = \\sqrt{\\ln(\\omega_{CL}^2 + 1)}$。如果 $\\omega_{CL}=0$，则 $\\omega=0$。\n4.  **生成队列**：\n    a. 从分布 $N(0, \\omega^2)$ 中生成 $N$ 个随机变量 $\\eta_i$。\n    b. 对于每个 $\\eta_i$，计算个体的清除率：$CL_i = CL_{typ} \\exp(\\eta_i)$。\n5.  **计算个体药代动力学参数**：对于 $N$ 个个体中的每一个：\n    a. 计算个体消除速率常数：$k_i = CL_i / V_{typ}$。\n    b. 使用推导出的公式计算个体稳态谷浓度：\n       $$\n       C_{min,ss,i} = \\frac{D}{V_{typ}} \\cdot \\frac{e^{-k_i \\tau}}{1 - e^{-k_i \\tau}}\n       $$\n6.  **估计比例**：计算 $C_{min,ss,i}  C_{min,target}$ 的个体数量。所需比例是该计数除以总个体数 $N$。\n7.  **格式化输出**：将最终比例四舍五入到 $6$ 位小数。\n\n对问题陈述中提供的四个测试案例中的每一个都执行此过程。在实现中使用向量化将确保计算效率。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates steady-state trough concentrations for a virtual cohort based on\n    a one-compartment PK model and estimates the proportion of individuals\n    below a target concentration.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"CL_typ\": 6.0, \"V_typ\": 60.0, \"omega_CL\": 0.30, \n            \"D\": 100.0, \"tau\": 12.0, \"N\": 100000, \"C_min_target\": 2.0\n        },\n        {\n            \"CL_typ\": 6.0, \"V_typ\": 60.0, \"omega_CL\": 0.00, \n            \"D\": 100.0, \"tau\": 12.0, \"N\": 1000, \"C_min_target\": 2.0\n        },\n        {\n            \"CL_typ\": 6.0, \"V_typ\": 60.0, \"omega_CL\": 0.30, \n            \"D\": 500.0, \"tau\": 12.0, \"N\": 100000, \"C_min_target\": 2.0\n        },\n        {\n            \"CL_typ\": 3.0, \"V_typ\": 60.0, \"omega_CL\": 0.30, \n            \"D\": 100.0, \"tau\": 24.0, \"N\": 100000, \"C_min_target\": 2.0\n        },\n    ]\n\n    # Initialize the random number generator with a fixed seed for reproducibility.\n    # The generator is initialized once to ensure the sequence of random numbers\n    # is a single stream across all test cases that require it.\n    rng = np.random.default_rng(seed=20231111)\n\n    results = []\n    \n    for params in test_cases:\n        # Extract parameters for the current test case.\n        CL_typ = params[\"CL_typ\"]\n        V_typ = params[\"V_typ\"]\n        omega_CL = params[\"omega_CL\"]\n        D = params[\"D\"]\n        tau = params[\"tau\"]\n        N = params[\"N\"]\n        C_min_target = params[\"C_min_target\"]\n        F = 1.0  # Bioavailability is fixed at 1.\n\n        # Generate a cohort of N individuals with variability on clearance.\n        if omega_CL > 0.0:\n            # Calibrate omega (std. dev. in log space) from the given\n            # coefficient of variation (omega_CL) in natural space.\n            # The relationship is omega^2 = ln(CV^2 + 1).\n            omega = np.sqrt(np.log(omega_CL**2 + 1))\n            \n            # Generate random effects for N individuals from N(0, omega^2).\n            eta_i = rng.normal(loc=0.0, scale=omega, size=N)\n            \n            # Calculate individual clearance values based on the log-normal model.\n            CL_i = CL_typ * np.exp(eta_i)\n        else:\n            # For the zero variability case, all individuals have the typical clearance.\n            CL_i = np.full(N, CL_typ)\n\n        # Calculate individual elimination rate constants (k = CL/V).\n        k_i = CL_i / V_typ\n\n        # Calculate steady-state trough concentration (Cmin,ss) for each individual.\n        # Formula: Cmin_ss = (D*F/V) * exp(-k*tau) / (1 - exp(-k*tau))\n        # Since F=1, we use D directly.\n        exp_term = np.exp(-k_i * tau)\n        C_min_ss_i = (D / V_typ) * exp_term / (1 - exp_term)\n\n        # Estimate the proportion of individuals with Cmin,ss below the target.\n        proportion = np.sum(C_min_ss_i  C_min_target) / N\n        \n        # Append the formatted result to the list.\n        # The f-string format specifier .6f handles rounding to 6 decimal places.\n        results.append(f\"{proportion:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4576837"}]}