{"hands_on_practices": [{"introduction": "我们实践的第一步是探索变异的最根本来源之一：我们的基因构成。本练习将应用群体遗传学的核心原理——哈迪-温伯格平衡，来量化药物代谢酶基因的变异如何在群体层面转化为不同的代谢表型。通过这个计算，你将能够把等位基因频率这一微观遗传信息与群体中“慢代谢者”的预期比例联系起来。[@problem_id:4592054]", "problem": "一个影响肝脏药物清除的双等位基因药物基因在单个常染色体基因座上表现出两个等位基因：一个由 $A$ 表示的功能性等位基因和一个由 $a$ 表示的功能丧失性等位基因。在一个大型随机交配种群中，配子的等位基因频率为 $A$ 的频率 $p=0.8$，$a$ 的频率 $q=0.2$，且 $p+q=1$。弱代谢者表型在操作上被定义为具有纯合功能丧失性基因型 $aa$（无功能性酶活性）的个体。假设Hardy–Weinberg平衡（HWE），这要求随机交配、无选择、无突变、无迁移和足够大的种群，并将从交配配子中抽样的等位基因视为从配子库中的独立抽取。\n\n从HWE作为独立配子等位基因抽取乘积的概率解释出发，推导出种群中弱代谢者的预期比例（用 $p$ 和 $q$ 表示），然后使用 $p=0.8$ 和 $q=0.2$ 计算其值。将最终结果表示为无量纲小数。无需四舍五入。", "solution": "该问题已经过验证，被认为是具有科学依据、提法恰当且客观的。它代表了Hardy-Weinberg原理的一个标准应用，这是群体遗传学及其在药物遗传学中应用的一个基本概念。所有必要信息均已提供，且前提条件一致并符合科学现实。\n\n该问题要求计算一个种群中弱代谢者的预期比例，这些弱代谢者被定义为基因型为 $aa$ 的个体。推导必须从Hardy-Weinberg平衡（HWE）的概率解释开始。\n\n设在一个大型随机交配种群的配子库中，$p$ 是功能性等位基因 $A$ 的频率，$q$ 是功能丧失性等位基因 $a$ 的频率。给定值为 $p = 0.8$ 和 $q = 0.2$。条件 $p + q = 0.8 + 0.2 = 1$ 得到满足。\n\n在HWE条件下，二倍体合子基因型的形成被建模为从种群配子库中进行两次独立随机抽取的结果。一次抽取代表父方配子，另一次代表母方配子。\n\n抽取一个携带等位基因 $A$ 的配子的概率等于其频率，$P(A) = p$。\n抽取一个携带等位基因 $a$ 的配子的概率等于其频率，$P(a) = q$。\n\n如果个体的基因型是 $aa$，那么他就是一个弱代谢者。为了形成这种基因型，该个体必须从第一个配子（例如，父方）遗传一个等位基因 $a$ 并且从第二个配子（例如，母方）遗传一个等位基因 $a$。\n\n设 $E_1$ 为第一个随机选择的配子携带等位基因 $a$ 的事件。该事件的概率是 $P(E_1) = q$。\n设 $E_2$ 为第二个随机选择的配子携带等位基因 $a$ 的事件。该事件的概率是 $P(E_2) = q$。\n\n因为根据HWE假设，这两次抽取是独立事件，所以两个事件同时发生的概率是它们各自概率的乘积。这个联合概率对应于种群中 $aa$ 基因型的预期频率，我们将其记为 $f(aa)$。\n\n$$f(aa) = P(E_1 \\cap E_2) = P(E_1) \\times P(E_2)$$\n将概率用等位基因频率 $q$ 代入：\n$$f(aa) = q \\times q = q^2$$\n这个表达式 $f(aa) = q^2$ 就是用等位基因频率 $q$ 表示的种群中弱代谢者的推导比例。由于 $q = 1-p$，它也可以用 $p$ 表示为 $f(aa) = (1-p)^2$。问题要求用 $p$ 和 $q$ 进行推导，而 $q^2$ 是最直接的形式。\n\n现在，我们使用给定的等位基因频率 $q = 0.2$ 来计算其数值。\n$$f(aa) = (0.2)^2$$\n$$f(aa) = 0.04$$\n结果是一个无量纲小数，符合要求。该种群中弱代谢者的预期比例为 $0.04$。", "answer": "$$\\boxed{0.04}$$", "id": "4592054"}, {"introduction": "在遗传背景之外，个体的生理状态，特别是器官功能，是决定药物处置的关键动态因素。本练习将你置于临床药理学家的角色，要求你根据患者的肾功能调整给药方案。你将使用一个标准的临床估算方法来量化肾功能，并据此推导出一个剂量调整系数，以确保药物暴露的个体化和安全性。[@problem_id:4592068]", "problem": "一名$65$岁、体重$70$ $\\mathrm{kg}$的男性，其血清肌酐稳定在$1.6$ $\\mathrm{mg}/\\mathrm{dL}$。考虑一种维持剂量药物，该药物表现出线性药代动力学特征，主要以原型形式通过肾脏消除，并且在不同个体间的非肾脏消除是恒定的。假设以下有科学依据的原则：(i) 总清除率等于肾脏清除率和非肾脏清除率之和，(ii) 为维持相同的稳态浓度，维持给药速率与总清除率成正比，(iii) 对于通过肾小球滤过以原型消除的药物，肾脏清除率与肌酐清除率成比例缩放，而成年男性的肌酐清除率可以使用一种广泛接受的、依赖于年龄、体重和血清肌酐浓度的估算方法来估算。已知该药物在肾功能正常的个体中，$80$％以原型形式经肾脏清除，其余$20$％通过不受肾功能影响的非肾脏途径清除。设典型健康成年人的参考肌酐清除率为$100$ $\\mathrm{mL}/\\mathrm{min}$。\n\n基于这些前提，首先估算该患者的肌酐清除率（单位为 $\\mathrm{mL}/\\mathrm{min}$），然后推导出维持剂量的推荐乘法调整因子（表示为单个无量纲小数），以使其相对于肌酐清除率为$100$ $\\mathrm{mL}/\\mathrm{min}$的典型健康成年人，能够保持相同的稳态暴露量。将最终的调整因子四舍五入至四位有效数字。最终答案以纯数字形式表示（无单位）。", "solution": "用户提供了一个临床药理学问题，要求为一名肾功能不全的患者计算剂量调整因子。我将首先验证问题陈述，如果问题有效，则继续提供完整解答。\n\n### 步骤1：提取已知条件\n- 患者：$65$岁男性\n- 体重：$70$ $\\mathrm{kg}$\n- 血清肌酐（$SCr$）：$1.6$ $\\mathrm{mg}/\\mathrm{dL}$\n- 药物特性：\n    - 线性药代动力学\n    - 以原型形式消除，主要通过肾脏\n    - 不同个体间非肾脏消除恒定\n- 原则：\n    - (i) 总清除率（$CL_T$）= 肾脏清除率（$CL_R$）+ 非肾脏清除率（$CL_{NR}$）\n    - (ii) 维持给药速率（$R_{maint}$）与总清除率（$CL_T$）成正比，以维持恒定的稳态浓度（$C_{ss}$）。\n    - (iii) 对于通过肾小球滤过消除的药物，$CL_R$与肌酐清除率（$CL_{Cr}$）成正比。\n- 肌酐清除率估算：一种广泛接受的、使用年龄、体重和血清肌酐的方法。\n- 参考个体（肾功能正常）：\n    - $CL_{Cr, ref} = 100$ $\\mathrm{mL}/\\mathrm{min}$\n    - 药物经肾脏清除的分数：$f_R = 0.80$\n    - 药物经非肾脏清除的分数：$f_{NR} = 0.20$\n- 任务：\n    - 估算患者的肌酐清除率（$CL_{Cr, patient}$）。\n    - 推导乘法剂量调整因子。\n    - 将最终因子四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学性**：该问题建立在药代动力学的基础原则之上，即清除率、给药速率和清除途径可加性之间的关系。假设药物的肾脏清除率与肌酐清除率成正比，是处理通过肾小球滤过消除的药物的标准有效方法。使用估算方程计算肌酐清除率是常规临床实践。\n- **适定性**：该问题提供了确定所需剂量调整所需的所有必要患者数据和药物特性。参考案例定义明确，为比较建立了基线。通往唯一解的路径清晰。\n- **客观性**：该问题使用精确的定量语言和客观的临床参数进行陈述。没有主观或含糊的陈述。\n- **缺陷检查**：该问题未违反任何指定的无效标准。“广泛接受的肌酐清除率估算方法”这一短语是标准的学术提示，暗示使用最常见的、与给定参数相符的公式，即Cockcroft-Gault方程。这不是使问题无效的模糊之处，而是该领域的标准惯例。\n\n### 步骤3：结论与行动\n问题有效。下面是完整的、有理有据的解答。\n\n### 解答推导\n目标是为特定患者相对于肾功能正常的参考个体，找到药物维持剂量的乘法调整因子 $F_{adj}$。该因子确保两个个体达到相同的平均稳态药物浓度 $C_{ss}$。\n\n根据所提供的原则，维持给药速率 $R_{maint}$ 与总药物清除率 $CL_T$ 和期望的稳态浓度 $C_{ss}$ 的关系如下式所示：\n$$R_{maint} = C_{ss} \\times CL_T$$\n剂量调整因子 $F_{adj}$ 是患者所需给药速率与参考个体给药速率之比：\n$$F_{adj} = \\frac{R_{maint, patient}}{R_{maint, ref}} = \\frac{C_{ss} \\times CL_{T, patient}}{C_{ss} \\times CL_{T, ref}} = \\frac{CL_{T, patient}}{CL_{T, ref}}$$\n这表明调整因子等于患者的总清除率与参考总清除率之比。\n\n总清除率是肾脏清除率（$CL_R$）和非肾脏清除率（$CL_{NR}$）之和：\n$$CL_T = CL_R + CL_{NR}$$\n对于参考个体，其总清除率为 $CL_{T, ref}$，各清除组分由每条途径消除的药物分数给出：\n$$CL_{R, ref} = 0.80 \\times CL_{T, ref}$$\n$$CL_{NR, ref} = 0.20 \\times CL_{T, ref}$$\n问题指出，非肾脏清除率在不同个体间是恒定的。因此，患者的非肾脏清除率等于参考个体的非肾脏清除率：\n$$CL_{NR, patient} = CL_{NR, ref} = 0.20 \\times CL_{T, ref}$$\n问题还指出，肾脏清除率与肌酐清除率（$CL_{Cr}$）成正比，我们可以用一个比例常数 $k$ 来表示：\n$$CL_R = k \\times CL_{Cr}$$\n对于参考个体，我们知道 $CL_{Cr, ref} = 100$ $\\mathrm{mL}/\\mathrm{min}$。我们可以解出 $k$：\n$$CL_{R, ref} = k \\times CL_{Cr, ref} \\implies 0.80 \\times CL_{T, ref} = k \\times 100 \\ \\mathrm{mL}/\\mathrm{min}$$\n$$k = \\frac{0.80 \\times CL_{T, ref}}{100 \\ \\mathrm{mL}/\\mathrm{min}}$$\n现在我们可以利用患者特定的肌酐清除率 $CL_{Cr, patient}$ 来确定其肾脏清除率 $CL_{R, patient}$：\n$$CL_{R, patient} = k \\times CL_{Cr, patient} = \\left( \\frac{0.80 \\times CL_{T, ref}}{100 \\ \\mathrm{mL}/\\mathrm{min}} \\right) \\times CL_{Cr, patient}$$\n患者的总清除率是其肾脏和非肾脏清除组分之和：\n$$CL_{T, patient} = CL_{R, patient} + CL_{NR, patient} = \\left( \\frac{0.80 \\times CL_{T, ref}}{100 \\ \\mathrm{mL}/\\mathrm{min}} \\times CL_{Cr, patient} \\right) + (0.20 \\times CL_{T, ref})$$\n现在我们可以计算调整因子 $F_{adj}$：\n$$F_{adj} = \\frac{CL_{T, patient}}{CL_{T, ref}} = \\frac{\\left( \\frac{0.80 \\times CL_{T, ref}}{100} \\times CL_{Cr, patient} \\right) + (0.20 \\times CL_{T, ref})}{CL_{T, ref}}$$\n项 $CL_{T, ref}$ 被消去，得到调整因子的通用公式：\n$$F_{adj} = \\left( \\frac{0.80}{100 \\ \\mathrm{mL}/\\mathrm{min}} \\times CL_{Cr, patient} \\right) + 0.20$$\n下一步是估算患者的肌酐清除率。对于给定的成年男性年龄、体重和血清肌酐输入值，Cockcroft-Gault方程是为此目的广泛接受的方法：\n$$CL_{Cr} \\ (\\mathrm{in \\ mL/min}) = \\frac{(140 - \\text{Age in years}) \\times \\text{Body Weight in kg}}{72 \\times \\text{Serum Creatinine in mg/dL}}$$\n代入患者数据：年龄 = $65$，体重 = $70$ $\\mathrm{kg}$，$SCr = 1.6$ $\\mathrm{mg}/\\mathrm{dL}$。\n$$CL_{Cr, patient} = \\frac{(140 - 65) \\times 70}{72 \\times 1.6} = \\frac{75 \\times 70}{115.2} = \\frac{5250}{115.2} \\ \\mathrm{mL}/\\mathrm{min}$$\n现在，我们将此值代回 $F_{adj}$ 的方程中：\n$$F_{adj} = \\left( \\frac{0.80}{100} \\times \\frac{5250}{115.2} \\right) + 0.20$$\n$$F_{adj} = (0.008 \\times 45.572916...) + 0.20$$\n$$F_{adj} = 0.3645833... + 0.20 = 0.5645833...$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$F_{adj} \\approx 0.5646$$\n这就是推荐的维持剂量乘法调整因子。", "answer": "$$\n\\boxed{0.5646}\n$$", "id": "4592068"}, {"introduction": "药物反应的变异性不仅源于生物学，还受到患者行为的深刻影响，其中依从性是最重要的因素之一。这个前沿的计算练习旨在揭示一个常见的临床难题：不佳的依从性如何“伪装”成异常高的药物清除率。通过编程模拟，你将量化因漏服药物导致的低药物浓度如何被错误地归因于个体的药代动力学特征，从而加深对解读临床数据复杂性的理解。[@problem_id:4592100]", "problem": "设计并实现一个程序，在一个一级消除和瞬时输入的单室模型中，通过比较完美依从性和不完美依从性下的谷浓度，量化依从性不佳（漏服）如何被误解为异常高的清除率。\n\n使用的基本原理：\n- 在给药事件之间，浓度 $C(t)$ 服从常微分方程 $dC/dt = -k \\, C$，其中 $k$ 是一级消除速率常数。\n- 在给药事件中，给予一次剂量为 $D$（单位 mg）、绝对生物利用度为 $F$（无单位）的药物，会产生一个瞬时浓度增量 $\\Delta C = F \\, D / V_{\\mathrm{d}}$，其中 $V_{\\mathrm{d}}$（单位 L）是表观分布容积。\n- 清除率与 $k$ 和 $V_{\\mathrm{d}}$ 的关系为 $CL = k \\, V_{\\mathrm{d}}$。\n- 每隔 $\\tau$ 小时给药一次。谷浓度定义为下一次计划给药前瞬间的浓度。\n\n在指定依从性模式下计算观测谷浓度的模拟方案：\n- 将给药方案表示为一个序列 $\\{s_i\\}_{i=1}^N$，包含 $N$ 个给药间隔，其中 $s_i \\in \\{0,1\\}$，$s_i = 1$ 表示在第 $i$ 个间隔结束时服用了计划的剂量，$s_i = 0$ 表示错过了。\n- 令 $A = F \\, D / V_{\\mathrm{d}}$。令 $r = \\exp(-k \\, \\tau)$。将时间 $0$ 时的给药后浓度初始化为 $C^{+}_0 = 0$。\n- 对于每个间隔 $i = 1,2,\\dots,N$，计算在该间隔结束时计划给药时间点之前的给药前（谷）浓度为 $C^{-}_i = C^{+}_{i-1} \\, r$。然后，如果 $s_i = 1$，更新给药后浓度为 $C^{+}_i = C^{-}_i + A$；如果 $s_i = 0$，更新为 $C^{+}_i = C^{-}_i$。模拟结束时的观测谷浓度为 $C^{-}_N$（单位 mg/L）。\n\n朴素推断步骤（需要在您的解决方案中从第一性原理推导）：\n- 一位朴素的研究者，未意识到漏服的存在，假设在稳态下是完美依从性，并使用观测到的谷浓度 $C^{-}_N$ 以及已知的 $D$、$F$、$V_{\\mathrm{d}}$ 和 $\\tau$，根据完美依从性稳态谷浓度的逻辑，反向计算出一个表观消除速率常数 $k_{\\mathrm{app}}$。由此，表观清除率为 $CL_{\\mathrm{app}} = k_{\\mathrm{app}} \\, V_{\\mathrm{d}}$。\n- 您的任务是为每个测试用例计算比率 $R = CL_{\\mathrm{app}} / CL$（无量纲），其中 $CL$ 是真实清除率。该比率量化了由于依从性不佳被错误归因于药代动力学而导致的清除率膨胀（值大于 1）或紧缩（值小于 1）。\n\n物理和数值单位：\n- 使用 mg 作为剂量单位，L 作为容积单位，小时作为时间单位，L/h 作为清除率单位，mg/L 作为浓度单位。输出的比率为无单位。\n- 此处不涉及任何角度，即使出现也无关紧要。\n- 不要将任何值表示为百分比；请使用小数。\n\n测试套件：\n对于每个测试用例，给定 $(CL, V_{\\mathrm{d}}, D, F, \\tau, \\{s_i\\}_{i=1}^N)$。\n\n1) 完美依从性，相对于给药间隔为中等半衰期：\n- $CL = 5$ L/h, $V_{\\mathrm{d}} = 50$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h。\n- 方案：$N = 80$ 且对于所有 $i = 1,\\dots,80$，$s_i = 1$。\n\n2) 在测定谷浓度前立即漏服单次剂量（此前长期依从）：\n- $CL = 5$ L/h, $V_{\\mathrm{d}} = 50$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h。\n- 方案：$N = 62$，其中对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$，$s_{62} = 1$。\n\n3) 在测定谷浓度前立即连续漏服两次剂量（此前长期依从）：\n- $CL = 5$ L/h, $V_{\\mathrm{d}} = 50$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h。\n- 方案：$N = 63$，其中对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$，$s_{62} = 0$，$s_{63} = 1$。\n\n4) 单次漏服，长半衰期（相对于给药频率，$k$ 值较小）：\n- $CL = 1$ L/h, $V_{\\mathrm{d}} = 100$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h。\n- 方案：$N = 62$，其中对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$，$s_{62} = 1$。\n\n5) 单次漏服，短半衰期（相对于给药频率，$k$ 值较大）：\n- $CL = 20$ L/h, $V_{\\mathrm{d}} = 40$ L, $D = 500$ mg, $F = 1$, $\\tau = 12$ h。\n- 方案：$N = 62$，其中对于 $i = 1,\\dots,60$，$s_i = 1$，然后 $s_{61} = 0$，$s_{62} = 1$。\n\n程序要求：\n- 根据上述递推关系，为每个测试用例实现 $C^{-}_N$ 的模拟。\n- 推导并实现朴素的完美依从性反演，从观测谷浓度 $C^{-}_N$ 中获得 $k_{\\mathrm{app}}$，然后计算 $CL_{\\mathrm{app}} = k_{\\mathrm{app}} \\, V_{\\mathrm{d}}$ 和比率 $R = CL_{\\mathrm{app}} / CL$。\n- 您的程序应生成单行输出，其中包含五个比率，按测试用例的顺序排列，形式为用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_j$ 是一个四舍五入到小数点后六位的小数。", "solution": "我们从一级消除和瞬时输入的单室线性药代动力学的第一性原理开始构建解决方案。\n\n1. 给药间的动态。在给药事件之间，浓度 $C(t)$ 服从 $dC/dt = -k \\, C$。在长度为 $\\tau$ 的固定给药间隔内，解为 $C(t+\\tau) = C(t)\\, \\exp(-k \\, \\tau)$。定义 $r = \\exp(-k \\, \\tau)$ 表示一个给药间隔内的衰减因子。\n\n2. 给药时的瞬时变化。剂量为 $D$（单位 mg）、绝对生物利用度为 $F$ 的药物使浓度瞬时增加 $\\Delta C = A$，其中 $A = F \\, D / V_{\\mathrm{d}}$（单位 mg/L），$V_{\\mathrm{d}}$（单位 L）是表观分布容积。因此，如果 $C^{-}_i$ 表示在第 $i$ 个间隔结束时计划给药前的瞬间浓度（谷浓度），$C^{+}_i$ 表示该时间点计划给药后的瞬间浓度，那么如果服用了剂量，则 $C^{+}_i = C^{-}_i + A$，如果错过了剂量，则 $C^{+}_i = C^{-}_i$。\n\n3. 跨给药方案的递推关系。设 $\\{s_i\\}_{i=1}^N$ 是一个序列，其中 $s_i \\in \\{0,1\\}$ 表示在第 $i$ 个间隔结束时错过（0）或服用（1）剂量。初始化 $C^{+}_0 = 0$。对于每个间隔 $i = 1,2,\\dots,N$：\n- 通过消除过程传播至给药前谷浓度：$C^{-}_i = C^{+}_{i-1} \\, r$，其中 $r = \\exp(-k \\, \\tau)$。\n- 如果服药，则应用瞬时剂量：$C^{+}_i = C^{-}_i + s_i \\, A$。\n模拟结束时的观测谷浓度为 $C^{-}_N$。\n\n4. 完美依从性稳态。在完美依从性（所有 $i$ 的 $s_i = 1$）且经过多个间隔后，过程达到稳态，此时每个间隔的给药前谷浓度 $C^{-}$ 和给药后浓度 $C^{+}$ 重复出现。设 $C^{-}_{\\mathrm{ss}}$ 和 $C^{+}_{\\mathrm{ss}}$ 分别为稳态谷浓度和给药后浓度值。它们的关系是 $C^{-}_{\\mathrm{ss}} = C^{+}_{\\mathrm{ss}} \\, r$ 和 $C^{+}_{\\mathrm{ss}} = C^{-}_{\\mathrm{ss}} + A$。消去 $C^{+}_{\\mathrm{ss}}$ 可得\n$$\nC^{-}_{\\mathrm{ss}} = (C^{-}_{\\mathrm{ss}} + A)\\, r \\quad \\Rightarrow \\quad C^{-}_{\\mathrm{ss}} (1 - r) = A \\, r \\quad \\Rightarrow \\quad C^{-}_{\\mathrm{ss}} = \\frac{A \\, r}{1 - r}.\n$$\n\n5. 在完美依从性假设下的朴素反演。假设一位研究者观测到一个谷浓度 $C_{\\mathrm{obs}}$，并假设它是在完美依从性稳态下产生的。然后，使用稳态关系式，\n$$\nC_{\\mathrm{obs}} = \\frac{A \\, r}{1 - r},\n$$\n其中 $A = F \\, D / V_{\\mathrm{d}}$ 已知，研究者在没有任何关于 $k$ 的先验知识的情况下求解 $r$。整理得，\n$$\nC_{\\mathrm{obs}} (1 - r) = A \\, r \\quad \\Rightarrow \\quad C_{\\mathrm{obs}} = r (C_{\\mathrm{obs}} + A) \\quad \\Rightarrow \\quad r = \\frac{C_{\\mathrm{obs}}}{C_{\\mathrm{obs}} + A}.\n$$\n然后，由于 $r = \\exp(-k_{\\mathrm{app}} \\, \\tau)$，表观消除速率常数为\n$$\nk_{\\mathrm{app}} = -\\frac{1}{\\tau} \\ln r = -\\frac{1}{\\tau} \\ln\\left(\\frac{C_{\\mathrm{obs}}}{C_{\\mathrm{obs}} + A}\\right).\n$$\n最终，表观清除率为 $CL_{\\mathrm{app}} = k_{\\mathrm{app}} \\, V_{\\mathrm{d}}$，表观清除率与真实清除率之比为\n$$\nR = \\frac{CL_{\\mathrm{app}}}{CL} = \\frac{k_{\\mathrm{app}} \\, V_{\\mathrm{d}}}{CL}.\n$$\n\n6. 每个测试用例的算法实现：\n- 输入：$CL$ (L/h)，$V_{\\mathrm{d}}$ (L)，$D$ (mg)，$F$ (无单位)，$\\tau$ (h)，以及方案 $\\{s_i\\}_{i=1}^N$。\n- 计算 $k = CL / V_{\\mathrm{d}}$ (h$^{-1}$)，$A = F \\, D / V_{\\mathrm{d}}$ (mg/L)，以及 $r = \\exp(-k \\, \\tau)$。\n- 初始化 $C^{+}_0 = 0$。\n- 对于 $i = 1$ 到 $N$：计算 $C^{-}_i = C^{+}_{i-1} \\, r$，然后设置 $C^{+}_i = C^{-}_i + s_i \\, A$。\n- 设置 $C_{\\mathrm{obs}} = C^{-}_N$ (mg/L)。\n- 计算 $r_{\\mathrm{app}} = C_{\\mathrm{obs}} / (C_{\\mathrm{obs}} + A)$，然后 $k_{\\mathrm{app}} = - \\ln(r_{\\mathrm{app}}) / \\tau$，$CL_{\\mathrm{app}} = k_{\\mathrm{app}} \\, V_{\\mathrm{d}}$，以及 $R = CL_{\\mathrm{app}} / CL$。\n- 报告 $R$ 值，四舍五入到小数点后六位。\n\n7. 测试套件覆盖范围。第一个用例验证了在完美依从性下，$C_{\\mathrm{obs}}$ 与完美依从性稳态谷浓度相匹配，因此 $R$ 应约等于 $1$。第二个和第三个用例分别显示了，对于中等半衰期，在谷浓度之前立即有一次和两次连续漏服时，表观清除率的膨胀。第四个用例显示，当半衰期相对于给药间隔较长时，膨胀较小，因为 $r$ 接近 $1$，所以系统在间隔之间保留了药物。第五个用例显示，当半衰期较短时，单次漏服几乎可以使表观清除率加倍（这与小 $r$ 极限一致，其中一次漏服导致 $R \\approx 2$），说明了依从性变异性如何伪装成药代动力学变异性。\n\n程序实现了这一逻辑，并以方括号括起来的单个逗号分隔列表的形式输出五个比率，每个比率四舍五入到小数点后六位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_trough(CL, Vd, D, F, tau, schedule):\n    \"\"\"\n    Simulate the observed trough concentration C_obs (mg/L) given:\n    - CL: clearance (L/h)\n    - Vd: volume of distribution (L)\n    - D: dose (mg)\n    - F: absolute bioavailability (unitless)\n    - tau: dosing interval (h)\n    - schedule: list of integers 0/1 indicating missed/taken doses per interval\n    \"\"\"\n    k = CL / Vd  # h^-1\n    A = F * D / Vd  # mg/L\n    r = np.exp(-k * tau)\n\n    C_post = 0.0  # C^+_0\n    last_trough = 0.0\n    for s in schedule:\n        C_pre = C_post * r  # trough before scheduled dose at end of interval\n        last_trough = C_pre\n        # apply dose if taken\n        if s == 1:\n            C_post = C_pre + A\n        else:\n            C_post = C_pre\n    return last_trough  # mg/L\n\ndef apparent_clearance_ratio(CL, Vd, D, F, tau, schedule):\n    \"\"\"\n    Compute the ratio R = CL_app / CL using the naive perfect-adherence inversion\n    from the observed trough simulated under the given schedule.\n    \"\"\"\n    C_obs = simulate_trough(CL, Vd, D, F, tau, schedule)\n    A = F * D / Vd\n    # Guard against degenerate zero (should not occur with schedules chosen here)\n    # r_app = C_obs / (C_obs + A)\n    r_app = C_obs / (C_obs + A)\n    # Numerical safety: clip r_app to (0, 1) open interval\n    r_app = min(max(r_app, np.finfo(float).tiny), 1.0 - 1e-15)\n    k_app = -np.log(r_app) / tau\n    CL_app = k_app * Vd\n    return CL_app / CL\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1) Perfect adherence, moderate half-life\n        {\n            \"CL\": 5.0, \"Vd\": 50.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*80\n        },\n        # 2) Single missed dose immediately before measured trough\n        {\n            \"CL\": 5.0, \"Vd\": 50.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 1]\n        },\n        # 3) Two consecutive missed doses immediately before measured trough\n        {\n            \"CL\": 5.0, \"Vd\": 50.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 0, 1]\n        },\n        # 4) Single missed dose, long half-life\n        {\n            \"CL\": 1.0, \"Vd\": 100.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 1]\n        },\n        # 5) Single missed dose, short half-life\n        {\n            \"CL\": 20.0, \"Vd\": 40.0, \"D\": 500.0, \"F\": 1.0, \"tau\": 12.0,\n            \"schedule\": [1]*60 + [0, 1]\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        ratio = apparent_clearance_ratio(\n            case[\"CL\"], case[\"Vd\"], case[\"D\"], case[\"F\"], case[\"tau\"], case[\"schedule\"]\n        )\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "4592100"}]}