{"hands_on_practices": [{"introduction": "这项首要练习是量效关系分析的基石。我们将利用一个假设性剂量范围研究的原始数据，并逐步完成拟合逻辑斯谛剂量效应模型的过程。这项练习将巩固您对如何从数据中估计模型参数，并用其计算效价的基本指标——半数有效剂量（$ED_{50}$）的理解 [@problem_id:4586965]。", "problem": "一种新型镇痛剂在平行组剂量范围探索实验中表现出量性治疗反应。在三个剂量水平 $d_{1} = 15$ mg、$d_{2} = 30$ mg 和 $d_{3} = 60$ mg，每个剂量组随机分配了 $n_{i} = 50$ 名受试者。出现治疗反应（是/否）的受试者人数分别为 $y_{1} = 10$、$y_{2} = 25$ 和 $y_{3} = 40$。假设在剂量 $d$ 下的反应概率服从一个以剂量的自然对数作为预测变量的逻辑斯谛模型：$p(d) = \\frac{1}{1 + \\exp\\!\\big(-\\alpha - \\beta \\ln d\\big)}$，其中 $\\alpha$ 和 $\\beta$ 是待通过最大似然估计（MLE）进行估计的未知参数。\n\n从量性结局的二项似然和标准 logit 连接函数出发，建立最大似然估计问题并推导得分方程。使用所提供的数据，计算参数估计值 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$，过程中不使用任何快捷公式。然后，使用半数有效剂量（ED$_{50}$）的定义（即能使反应概率 $p(d) = 0.5$ 的剂量 $d$），推导用 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 表示的 ED$_{50}$ 表达式，并计算其在此数据集上的数值。\n\n最终的 ED$_{50}$ 以 mg 为单位表示。如果最终答案是精确值，请勿四舍五入。", "solution": "### 步骤 1：提取已知条件\n- 剂量水平：$d_{1} = 15$ mg，$d_{2} = 30$ mg，$d_{3} = 60$ mg。\n- 每个剂量水平的受试者人数：$n_{1} = n_{2} = n_{3} = 50$。\n- 出现治疗反应的受试者人数：$y_{1} = 10$，$y_{2} = 25$，$y_{3} = 40$。\n- 反应概率 $p(d)$ 的模型：$p(d) = \\frac{1}{1 + \\exp(-\\alpha - \\beta \\ln d)}$。\n- 半数有效剂量 ED$_{50}$ 的定义：使 $p(d) = 0.5$ 的剂量 $d$。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述具有科学依据，提法得当且客观。它提供了一个使用逻辑斯谛回归建模的标准量性剂量-反应场景，这是生物统计学和药理学的基石。数据是完整的、一致的，并且足以估计两个模型参数 $\\alpha$ 和 $\\beta$。目标是求出这些参数的最大似然估计（MLEs）以及一个衍生量，即 ED$_{50}$。该问题是一个正式的、可解的统计估计练习。没有违反科学原则，没有歧义，也没有缺失信息。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n\n每个剂量水平 $d_i$ 的反应是一个二项结局。在 $n_i$ 名受试者中，出现反应的人数 $y_i$ 服从二项分布 $Y_i \\sim \\text{Binomial}(n_i, p_i)$，其中 $p_i = p(d_i)$ 是该剂量下的反应概率。单个剂量组的概率质量函数为：\n$$ L_i(\\alpha, \\beta | y_i, n_i, d_i) = \\binom{n_i}{y_i} p_i^{y_i} (1 - p_i)^{n_i - y_i} $$\n其中 $p_i = \\frac{1}{1 + \\exp(-\\alpha - \\beta \\ln d_i)}$。\n\n假设三个独立剂量组的结局是相互独立的，总似然函数 $L(\\alpha, \\beta)$ 是各自似然函数的乘积：\n$$ L(\\alpha, \\beta) = \\prod_{i=1}^{3} L_i = \\prod_{i=1}^{3} \\binom{n_i}{y_i} p_i^{y_i} (1 - p_i)^{n_i - y_i} $$\n\n对于最大似然估计，处理对数似然函数 $\\ell(\\alpha, \\beta) = \\ln L(\\alpha, \\beta)$ 更为方便：\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ \\ln\\binom{n_i}{y_i} + y_i \\ln(p_i) + (n_i - y_i) \\ln(1 - p_i) \\right] $$\n为了找到使该函数最大化的参数 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$，我们可以忽略常数项 $\\sum \\ln\\binom{n_i}{y_i}$。令 $\\eta_i = \\alpha + \\beta \\ln d_i$。逻辑斯谛函数可以写成 $p_i = \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)}$，且 $1 - p_i = \\frac{1}{1 + \\exp(\\eta_i)}$。\n将这些代入对数似然函数（忽略常数项）得到：\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i \\ln\\left(\\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)}\\right) + (n_i - y_i) \\ln\\left(\\frac{1}{1 + \\exp(\\eta_i)}\\right) \\right] $$\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i (\\eta_i - \\ln(1 + \\exp(\\eta_i))) - (n_i - y_i) \\ln(1 + \\exp(\\eta_i)) \\right] $$\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i \\eta_i - n_i \\ln(1 + \\exp(\\eta_i)) \\right] $$\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i (\\alpha + \\beta \\ln d_i) - n_i \\ln(1 + \\exp(\\alpha + \\beta \\ln d_i)) \\right] $$\n\n通过将对数似然函数关于 $\\alpha$ 和 $\\beta$ 的偏导数设为零，可以得到得分方程。\n第二项关于 $\\alpha$ 的导数是：\n$$ \\frac{\\partial}{\\partial \\alpha} \\left[ n_i \\ln(1 + \\exp(\\eta_i)) \\right] = n_i \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)} \\cdot \\frac{\\partial \\eta_i}{\\partial \\alpha} = n_i p_i \\cdot 1 = n_i p_i $$\n关于 $\\beta$ 的导数是：\n$$ \\frac{\\partial}{\\partial \\beta} \\left[ n_i \\ln(1 + \\exp(\\eta_i)) \\right] = n_i \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)} \\cdot \\frac{\\partial \\eta_i}{\\partial \\beta} = n_i p_i \\cdot \\ln d_i $$\n\n得分方程 $U_{\\alpha} = \\frac{\\partial \\ell}{\\partial \\alpha} = 0$ 和 $U_{\\beta} = \\frac{\\partial \\ell}{\\partial \\beta} = 0$ 为：\n$$ U_{\\alpha} = \\sum_{i=1}^{3} \\left( y_i - n_i p_i \\right) = 0 $$\n$$ U_{\\beta} = \\sum_{i=1}^{3} \\left( y_i \\ln d_i - n_i p_i \\ln d_i \\right) = \\sum_{i=1}^{3} (y_i - n_i p_i) \\ln d_i = 0 $$\n这些方程是关于 $\\alpha$ 和 $\\beta$ 的非线性方程，通常需要数值求解。然而，所提供的数据表现出一种特殊的结构。观察到的反应比例如下：\n$p_{\\text{obs},1} = y_1/n_1 = 10/50 = 0.2$\n$p_{\\text{obs},2} = y_2/n_2 = 25/50 = 0.5$\n$p_{\\text{obs},3} = y_3/n_3 = 40/50 = 0.8$\n\n模型为 $\\text{logit}(p(d)) = \\ln\\left(\\frac{p(d)}{1-p(d)}\\right) = \\alpha + \\beta \\ln d$。\n让我们看看是否存在参数 $\\alpha$ 和 $\\beta$，使得拟合概率 $\\hat{p}_i$ 与观察比例 $p_{\\text{obs},i}$ 完全匹配。这要求观察比例的 logit 是对数剂量的线性函数。\n$$ \\text{logit}(p_{\\text{obs},1}) = \\ln\\left(\\frac{0.2}{1-0.2}\\right) = \\ln(0.25) = -\\ln(4) $$\n$$ \\text{logit}(p_{\\text{obs},2}) = \\ln\\left(\\frac{0.5}{1-0.5}\\right) = \\ln(1) = 0 $$\n$$ \\text{logit}(p_{\\text{obs},3}) = \\ln\\left(\\frac{0.8}{1-0.8}\\right) = \\ln(4) $$\n我们得到了一个关于 $\\alpha$ 和 $\\beta$ 的线性方程组：\n1. $\\alpha + \\beta \\ln(15) = -\\ln(4)$\n2. $\\alpha + \\beta \\ln(30) = 0$\n3. $\\alpha + \\beta \\ln(60) = \\ln(4)$\n\n从方程（2）中，我们找到 $\\alpha$ 和 $\\beta$ 之间的关系：\n$$ \\alpha = -\\beta \\ln(30) $$\n将此代入方程（1）：\n$$ -\\beta \\ln(30) + \\beta \\ln(15) = -\\ln(4) $$\n$$ \\beta (\\ln(15) - \\ln(30)) = -\\ln(4) $$\n$$ \\beta \\ln\\left(\\frac{15}{30}\\right) = -\\ln(4) $$\n$$ \\beta \\ln(0.5) = -\\ln(4) $$\n$$ -\\beta \\ln(2) = -2\\ln(2) $$\n$$ \\hat{\\beta} = 2 $$\n现在我们求 $\\alpha$ 的估计值：\n$$ \\hat{\\alpha} = -2 \\ln(30) $$\n我们必须验证这些估计值是否满足方程（3）：\n$$ \\hat{\\alpha} + \\hat{\\beta} \\ln(60) = -2\\ln(30) + 2\\ln(60) = 2(\\ln(60) - \\ln(30)) = 2\\ln\\left(\\frac{60}{30}\\right) = 2\\ln(2) = \\ln(4) $$\n方程成立。数据点在 logit-对数剂量空间中完美地落在一条直线上。在这种特殊情况下，最大似然估计值就是这条直线的参数。最大似然估计值为 $\\hat{\\alpha} = -2\\ln(30)$ 和 $\\hat{\\beta} = 2$。\n\n接下来，我们推导 ED$_{50}$ 的表达式。根据定义，这是使反应概率为 $0.5$ 的剂量 $d$：\n$$ p(\\text{ED}_{50}) = \\frac{1}{1 + \\exp(-\\alpha - \\beta \\ln(\\text{ED}_{50}))} = 0.5 $$\n$$ 1 + \\exp(-\\alpha - \\beta \\ln(\\text{ED}_{50})) = 2 $$\n$$ \\exp(-\\alpha - \\beta \\ln(\\text{ED}_{50})) = 1 $$\n对两边取自然对数：\n$$ -\\alpha - \\beta \\ln(\\text{ED}_{50}) = 0 $$\n$$ \\beta \\ln(\\text{ED}_{50}) = -\\alpha $$\n$$ \\ln(\\text{ED}_{50}) = -\\frac{\\alpha}{\\beta} $$\n$$ \\text{ED}_{50} = \\exp\\left(-\\frac{\\alpha}{\\beta}\\right) $$\n\n最后，我们使用估计的参数 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 计算 ED$_{50}$ 的数值：\n$$ \\widehat{\\text{ED}}_{50} = \\exp\\left(-\\frac{\\hat{\\alpha}}{\\hat{\\beta}}\\right) = \\exp\\left(-\\frac{-2\\ln(30)}{2}\\right) $$\n$$ \\widehat{\\text{ED}}_{50} = \\exp\\left(\\ln(30)\\right) $$\n$$ \\widehat{\\text{ED}}_{50} = 30 $$\n估计的半数有效剂量是 $30$ mg。这个结果与输入数据一致，在输入数据中，$30$ mg 的剂量恰好在 $50$ 名受试者中产生了 $25$ 例反应，反应率为 $50\\%$。", "answer": "$$\\boxed{30}$$", "id": "4586965"}, {"introduction": "一旦模型拟合完成，下一步就是解释其参数以表征药物特性。本练习使用另一种常见的选择——概率单位模型（probit model），并要求您不仅计算 $ED_{50}$，还要计算剂量的四分位距（IQR）。这将深化您将抽象的模型参数转化为具有临床意义的效价和效应曲线陡峭度指标的能力 [@problem_id:4586928]。", "problem": "一种新的抗惊厥药在平行分组、单剂量研究中进行评估，其二元终点定义为在固定观察窗内实现完全性癫痫抑制。设剂量为 $D$（单位为 $\\mathrm{mg}\\cdot\\mathrm{kg}^{-1}$）时的响应概率为 $p(D)$。对剂量的自然对数数据拟合一个带有概率单位链接的标准量反应剂量-效应模型，得到如下关系\n$\\Phi^{-1}\\!\\big(p(D)\\big)=\\alpha+\\beta\\ln(D)$，\n其中 $\\Phi^{-1}$ 表示标准正态分布的分位数函数，拟合参数为 $\\alpha=-1.2$ 和 $\\beta=0.8$。50%群体有效剂量（ED；半数有效剂量，$ED_{50}$）被定义为使 $p(D)=0.5$ 的唯一剂量 $D$。药效的剂量四分位距（IQR）定义为分别使 $p(D)=0.75$ 和 $p(D)=0.25$ 时的剂量之差。\n\n仅从该模型以及概率单位链接、$ED_{50}$ 和 IQR 的定义出发，推导达到任意响应概率 $p\\in(0,1)$ 的剂量的闭式表达式，然后将其特化以确定 $ED_{50}$ 和剂量的 IQR。最后，将剂量的 IQR 与 $ED_{50}$ 的比率报告为一个实数。为进行数值计算，您可以使用 $\\Phi^{-1}(0.25)=-0.67448975$ 和 $\\Phi^{-1}(0.75)=+0.67448975$。将最终比率四舍五入到四位有效数字，并以普通小数形式报告（无单位），因为它是无量纲的。", "solution": "首先根据要求验证问题陈述。\n\n### 第1步：提取已知条件\n-   剂量-效应模型由以下方程给出：$\\Phi^{-1}(p(D)) = \\alpha + \\beta \\ln(D)$，其中 $\\Phi^{-1}$ 是标准正态分布的分位数函数（逆累积分布函数），$p(D)$ 是剂量 $D$ 时的响应概率，$\\ln(D)$ 是剂量的自然对数。\n-   拟合参数为 $\\alpha = -1.2$ 和 $\\beta = 0.8$。\n-   半数有效剂量 $ED_{50}$ 定义为使 $p(D) = 0.5$ 的剂量 $D$。\n-   剂量的四分位距 (IQR) 定义为对应于响应概率为 0.75 和 0.25 的剂量之差，即 $D_{0.75} - D_{0.25}$。\n-   提供了标准正态分位数的数值：$\\Phi^{-1}(0.25) = -0.67448975$ 和 $\\Phi^{-1}(0.75) = 0.67448975$。\n-   目标是计算无量纲比率 $\\frac{\\text{IQR}}{ED_{50}}$ 并将其四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题在对数剂量尺度上使用了一个 probit 模型，这是药理学和毒理学中分析量反应剂量-效应数据的标准、有科学依据的方法。$ED_{50}$ 和 IQR 的概念是该领域的基本度量。该问题具有科学合理性。\n-   **适定性：** 该问题是适定的。它提供了一个具体的模型、所有必要的参数值和清晰的定义，从而可以为所要求的比率导出一个唯一且有意义的解。\n-   **客观性：** 该问题以精确、客观和正式的科学语言陈述。\n\n### 第3步：结论与行动\n该问题被认为是**有效的**，因为它是自洽的、有科学依据且适定的。将推导完整的解答。\n\n### 解答推导\n\n问题的核心是量反应剂量-效应关系：\n$$ \\Phi^{-1}(p) = \\alpha + \\beta \\ln(D) $$\n其中 $p$ 是响应概率 $p(D)$。\n\n首先，我们推导达到任意响应概率 $p \\in (0, 1)$ 的剂量 $D$ 的通用闭式表达式。我们重排模型方程以求解 $D$：\n$$ \\beta \\ln(D) = \\Phi^{-1}(p) - \\alpha $$\n$$ \\ln(D) = \\frac{\\Phi^{-1}(p) - \\alpha}{\\beta} $$\n对两边取指数，得到剂量 $D$ 作为概率 $p$ 的函数：\n$$ D(p) = \\exp\\left(\\frac{\\Phi^{-1}(p) - \\alpha}{\\beta}\\right) $$\n这是在比例为 $p$ 的群体中产生响应所需剂量的通用表达式。\n\n接下来，我们将此表达式特化以求出 $ED_{50}$。根据定义，$ED_{50}$ 是 $p = 0.5$ 时的剂量 $D$。对于标准正态分布，中位数（第50百分位数）位于 $z=0$。因此，分位数函数在 $p=0.5$ 处的值为 $\\Phi^{-1}(0.5) = 0$。将此代入我们的通用剂量表达式可得：\n$$ ED_{50} = D(0.5) = \\exp\\left(\\frac{\\Phi^{-1}(0.5) - \\alpha}{\\beta}\\right) = \\exp\\left(\\frac{0 - \\alpha}{\\beta}\\right) = \\exp\\left(-\\frac{\\alpha}{\\beta}\\right) $$\n\n现在，我们确定四分位距（IQR）。IQR 是 $p=0.75$ 时的剂量（$D_{0.75}$）与 $p=0.25$ 时的剂量（$D_{0.25}$）之差。使用我们的通用剂量公式：\n$$ D_{0.75} = D(0.75) = \\exp\\left(\\frac{\\Phi^{-1}(0.75) - \\alpha}{\\beta}\\right) $$\n$$ D_{0.25} = D(0.25) = \\exp\\left(\\frac{\\Phi^{-1}(0.25) - \\alpha}{\\beta}\\right) $$\n因此，IQR 为：\n$$ \\text{IQR} = D_{0.75} - D_{0.25} = \\exp\\left(\\frac{\\Phi^{-1}(0.75) - \\alpha}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25) - \\alpha}{\\beta}\\right) $$\n\n最后一步是求出 IQR 与 $ED_{50}$ 的比率：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\frac{\\exp\\left(\\frac{\\Phi^{-1}(0.75) - \\alpha}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25) - \\alpha}{\\beta}\\right)}{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)} $$\n我们可以利用指数性质 $\\exp(a-b) = \\exp(a)\\exp(-b)$ 来简化分子：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\frac{\\exp\\left(\\frac{\\Phi^{-1}(0.75)}{\\beta}\\right)\\exp\\left(-\\frac{\\alpha}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25)}{\\beta}\\right)\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)}{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)} $$\n提取分子中的公因式 $\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)$：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\frac{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right) \\left[ \\exp\\left(\\frac{\\Phi^{-1}(0.75)}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25)}{\\beta}\\right) \\right]}{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)} $$\n项 $\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)$ 被消去，表明该比率与参数 $\\alpha$ 无关：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp\\left(\\frac{\\Phi^{-1}(0.75)}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25)}{\\beta}\\right) $$\n由于标准正态分布的对称性，$\\Phi^{-1}(0.25) = -\\Phi^{-1}(0.75)$。令 $z_q = \\Phi^{-1}(0.75)$。表达式变为：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp\\left(\\frac{z_q}{\\beta}\\right) - \\exp\\left(-\\frac{z_q}{\\beta}\\right) = 2\\sinh\\left(\\frac{z_q}{\\beta}\\right) $$\n这个简洁的形式突出了其对斜率参数 $\\beta$ 和分布离散程度（由 $z_q$ 量化）的依赖性。\n\n现在，我们代入给定的数值：$\\beta = 0.8$，$\\Phi^{-1}(0.75) = 0.67448975$ 和 $\\Phi^{-1}(0.25) = -0.67448975$。\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp\\left(\\frac{0.67448975}{0.8}\\right) - \\exp\\left(\\frac{-0.67448975}{0.8}\\right) $$\n首先，计算指数的参数：\n$$ \\frac{0.67448975}{0.8} = 0.8431121875 $$\n比率为：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp(0.8431121875) - \\exp(-0.8431121875) $$\n$$ \\frac{\\text{IQR}}{ED_{50}} \\approx 2.32353033 - 0.43037922 \\approx 1.89315111 $$\n问题要求将最终结果四舍五入到四位有效数字。前四位有效数字是 $1$、$8$、$9$ 和 $3$。第五位有效数字是 $1$，所以向下取整。\n$$ \\frac{\\text{IQR}}{ED_{50}} \\approx 1.893 $$\n这个无量纲比率量化了剂量-效应曲线的相对离散程度，值越大表示曲线越平缓（即，相对于半数有效剂量，从 25% 响应到 75% 响应需要更宽的剂量范围）。", "answer": "$$\n\\boxed{1.893}\n$$", "id": "4586928"}, {"introduction": "建模的最终目的通常是为未来的实验做出更好的决策。最后的这项练习将让您扮演研究设计者的角色，任务是利用先验知识来确定新研究的最佳剂量和样本量。通过应用费雪信息（Fisher information）和德尔塔方法（delta method），您将学习如何设计一个高效的实验，以便以期望的精度水平估计 $ED_{50}$ [@problem_id:4586905]。", "problem": "一种在研镇痛药表现出二元治疗反应（在固定评估窗口内缓解），该反应在剂量域中可以很好地用一个标准广义线性模型来描述。假设量反应的剂量-反应关系采用 logit 链接函数，在剂量 $d$ 下的反应概率由下式给出\n$$\np(d) = \\frac{1}{1 + \\exp\\!\\big(-(\\alpha + \\beta d)\\big)} ,\n$$\n其中 $\\alpha$ 是截距，$\\beta$ 是相对于剂量 $d$ 的斜率。中位有效剂量（$ED_{50}$）是治疗反应概率为 $0.5$ 时的剂量，在 logit 模型下满足 $ED_{50} = -\\alpha/\\beta$。为使上下文完整，请注意，中位中毒剂量（$TD_{50}$）和中位致死剂量（$LD_{50}$）分别针对毒性和致死性终点有类似的定义，但在本设计问题中不作进一步考虑。\n\n一项对早期研究的先前荟萃分析提供了一个局部有效的参数猜测值：$ED_{50}$ 接近 $12\\,\\mathrm{mg}$，斜率接近 $\\beta = 0.25\\,\\mathrm{mg}^{-1}$，这意味着 $\\alpha = -\\beta \\times ED_{50} = -3.0$。申办方寻求一种设计，使得 $ED_{50}$ 估计量的双侧 Wald 型 $95\\%$ 置信区间半宽不大于 $h = 1.0\\,\\mathrm{mg}$。\n\n生产和操作限制规定：\n- 必须在单一制剂批次上围绕假定的 $ED_{50}$ 对称地选择剂量，与 $ED_{50}$ 的最小间隔为 $2\\,\\mathrm{mg}$，即 $d_1 = ED_{50} - s$ 和 $d_2 = ED_{50} + s$，其中 $s \\ge 2\\,\\mathrm{mg}$。\n- 为确保安全性和可行性，所选的两个剂量必须在 $[6\\,\\mathrm{mg}, 18\\,\\mathrm{mg}]$ 范围内。\n\n你将使用 logit 模型下的基于信息的计算和 delta 方法来设计一个双剂量、平行组、各剂量组等量分配的研究。确定：\n1. 两个剂量水平 $d_1$ 和 $d_2$（单位为 $\\mathrm{mg}$），\n2. 分配比例 $n_1/N$ 和 $n_2/N$，\n3. 满足目标精度标准所需的总样本量 $N$。\n\n你的推导应基于 logit 链接下独立伯努利结果的 Fisher 信息的基本定义，以及用于变换方差的 delta 方法。将剂量水平以 $\\mathrm{mg}$ 表示，总样本量以受试者人数表示。将剂量水平和分配比例四舍五入到四位有效数字。将总样本量报告为达到或超过目标半宽要求的最小整数。", "solution": "该问题要求确定一个双剂量临床研究的最优设计。需要确定的设计参数是剂量水平 $d_1$ 和 $d_2$ 以及总样本量 $N$。分配比例指定为相等。目标是在遵守一系列约束的同时，为中位有效剂量 $ED_{50}$ 的估计量达到指定的精度。解决方案将使用 Fisher 信息原理和 delta 方法推导得出。\n\n在剂量 $d$ 下的反应概率由 logit 模型给出：\n$$\np(d) = \\frac{1}{1 + \\exp(-(\\alpha + \\beta d))}\n$$\n接受剂量 $d_i$ 的受试者的反应 $Y_i$ 是一个参数为 $p(d_i)$ 的伯努利随机变量。对于参数 $\\theta = (\\alpha, \\beta)^T$，单个受试者在剂量 $d$ 下的 Fisher 信息是一个 $2 \\times 2$ 矩阵，由下式给出：\n$$\nI(d) = p(d)(1-p(d)) \\begin{pmatrix} 1 & d \\\\ d & d^2 \\end{pmatrix}\n$$\n研究设计包括两个剂量组 $d_1$ 和 $d_2$，样本量分别为 $n_1$ 和 $n_2$，其中 $N = n_1 + n_2$。总 Fisher 信息矩阵是单个信息贡献的总和：$I_{\\text{total}} = n_1 I(d_1) + n_2 I(d_2)$。\n问题指定了等量分配，因此 $n_1 = n_2 = N/2$。总信息矩阵变为：\n$$\nI_{\\text{total}} = \\frac{N}{2} \\left[ p(d_1)(1-p(d_1)) \\begin{pmatrix} 1 & d_1 \\\\ d_1 & d_1^2 \\end{pmatrix} + p(d_2)(1-p(d_2)) \\begin{pmatrix} 1 & d_2 \\\\ d_2 & d_2^2 \\end{pmatrix} \\right]\n$$\n剂量围绕假定的 $ED_{50} = 12 \\, \\mathrm{mg}$ 对称选择。令 $d_1 = ED_{50} - s$ 和 $d_2 = ED_{50} + s$。线性预测器为 $\\eta(d) = \\alpha + \\beta d$。由于 $ED_{50} = -\\alpha/\\beta$，我们可以写成 $\\alpha = -\\beta ED_{50}$。因此，$\\eta(d) = \\beta(d-ED_{50})$。\n对于所选剂量：\n$\\eta(d_1) = \\beta(d_1 - ED_{50}) = \\beta(-s) = -\\beta s$\n$\\eta(d_2) = \\beta(d_2 - ED_{50}) = \\beta(s) = \\beta s$\n反应概率为 $p(d_1) = \\frac{1}{1+\\exp(\\beta s)}$ 和 $p(d_2) = \\frac{1}{1+\\exp(-\\beta s)}$。一个有用的性质是 $p(d_1) + p(d_2) = 1$。这意味着信息权重项 $p(d)(1-p(d))$ 对两个剂量是相同的：\n$W = p(d_1)(1-p(d_1)) = p(d_1)p(d_2) = p(d_2)(1-p(d_2))$。\n$W = \\frac{\\exp(\\beta s)}{(1+\\exp(\\beta s))^2}$。\n\n总信息矩阵简化为：\n$$\nI_{\\text{total}} = \\frac{N}{2} W \\left[ \\begin{pmatrix} 1 & d_1 \\\\ d_1 & d_1^2 \\end{pmatrix} + \\begin{pmatrix} 1 & d_2 \\\\ d_2 & d_2^2 \\end{pmatrix} \\right] = \\frac{N}{2} W \\begin{pmatrix} 2 & d_1+d_2 \\\\ d_1+d_2 & d_1^2+d_2^2 \\end{pmatrix}\n$$\n代入 $d_1 = ED_{50}-s$ 和 $d_2 = ED_{50}+s$：\n$d_1+d_2 = 2ED_{50}$\n$d_1^2+d_2^2 = (ED_{50}-s)^2 + (ED_{50}+s)^2 = 2ED_{50}^2 + 2s^2$\n因此，\n$$\nI_{\\text{total}} = N W \\begin{pmatrix} 1 & ED_{50} \\\\ ED_{50} & ED_{50}^2+s^2 \\end{pmatrix}\n$$\n估计量 $(\\hat{\\alpha}, \\hat{\\beta})$ 的渐近方差-协方差矩阵是 $I_{\\text{total}}^{-1}$：\n$$\n\\text{Var}(\\hat{\\alpha}, \\hat{\\beta}) = I_{\\text{total}}^{-1} = \\frac{1}{N W \\det\\begin{pmatrix} 1 & ED_{50} \\\\ ED_{50} & ED_{50}^2+s^2 \\end{pmatrix}} \\begin{pmatrix} ED_{50}^2+s^2 & -ED_{50} \\\\ -ED_{50} & 1 \\end{pmatrix}\n$$\n行列式为 $(ED_{50}^2+s^2) - ED_{50}^2 = s^2$。\n$$\n\\text{Var}(\\hat{\\alpha}, \\hat{\\beta}) = \\frac{1}{N W s^2} \\begin{pmatrix} ED_{50}^2+s^2 & -ED_{50} \\\\ -ED_{50} & 1 \\end{pmatrix}\n$$\n中位有效剂量的估计量是 $\\widehat{ED}_{50} = -\\hat{\\alpha}/\\hat{\\beta}$。令 $g(\\alpha, \\beta) = -\\alpha/\\beta$。根据 delta 方法，$\\widehat{ED}_{50}$ 的渐近方差为 $\\text{Var}(\\widehat{ED}_{50}) \\approx (\\nabla g)^T \\text{Var}(\\hat{\\alpha}, \\hat{\\beta}) (\\nabla g)$。\n$g$ 的梯度是 $\\nabla g = (\\frac{\\partial g}{\\partial \\alpha}, \\frac{\\partial g}{\\partial \\beta})^T = (-\\frac{1}{\\beta}, \\frac{\\alpha}{\\beta^2})^T$。在真实参数处求值，得到 $\\nabla g = (-\\frac{1}{\\beta}, -\\frac{ED_{50}}{\\beta})^T = -\\frac{1}{\\beta}(1, ED_{50})^T$。\n$$\n\\text{Var}(\\widehat{ED}_{50}) = \\left(-\\frac{1}{\\beta}\\right)^2 (1, ED_{50}) \\left( \\frac{1}{N W s^2} \\begin{pmatrix} ED_{50}^2+s^2 & -ED_{50} \\\\ -ED_{50} & 1 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ ED_{50} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{N \\beta^2 W s^2} (1, ED_{50}) \\begin{pmatrix} (ED_{50}^2+s^2) - ED_{50}^2 \\\\ -ED_{50} + ED_{50} \\end{pmatrix} = \\frac{1}{N \\beta^2 W s^2} (1, ED_{50}) \\begin{pmatrix} s^2 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\text{Var}(\\widehat{ED}_{50}) = \\frac{s^2}{N \\beta^2 W s^2} = \\frac{1}{N \\beta^2 W}\n$$\n设计目标是 95% 置信区间半宽 $h$ 不大于 $h_{\\text{max}} = 1.0 \\, \\mathrm{mg}$。Wald 型区间的半宽为 $h = z_{0.975} \\sqrt{\\text{Var}(\\widehat{ED}_{50})}$。使用 $z_{0.975} \\approx 1.96$：\n$$\n1.96 \\sqrt{\\frac{1}{N \\beta^2 W}} \\le 1.0 \\implies N \\ge \\frac{1.96^2}{\\beta^2 W}\n$$\n为了最小化所需的样本量 $N$，我们必须相对于剂量间隔参数 $s$ 来最大化信息项 $W = \\frac{\\exp(\\beta s)}{(1+\\exp(\\beta s))^2}$。\n函数 $f(x) = \\frac{\\exp(x)}{(1+\\exp(x))^2}$ 在 $x=0$ 处取得最大值。对于 $x>0$，该函数是严格递减的。这里，$x=\\beta s$。由于 $\\beta=0.25>0$ 且 $s \\ge 2 > 0$，我们处于 $W$ 是 $s$ 的递减函数的区域。为了最大化 $W$（从而最小化 $N$），我们必须选择 $s$ 的最小可能值。\n\n对 $s$ 的约束是：\n1. 最小间隔：$s \\ge 2 \\, \\mathrm{mg}$。\n2. 剂量范围 $[6 \\, \\mathrm{mg}, 18 \\, \\mathrm{mg}]$：\n   - $d_1 = ED_{50} - s = 12 - s \\ge 6 \\implies s \\le 6 \\, \\mathrm{mg}$。\n   - $d_2 = ED_{50} + s = 12 + s \\le 18 \\implies s \\le 6 \\, \\mathrm{mg}$。\n综合这些，$s$ 的允许范围是 $[2, 6]$。使 $N$ 最小化的最优值是 $s = 2 \\, \\mathrm{mg}$。\n\n根据这个最优选择，我们可以确定设计参数。\n1. **剂量水平：**\n   $d_1 = 12 - 2 = 10 \\, \\mathrm{mg}$。\n   $d_2 = 12 + 2 = 14 \\, \\mathrm{mg}$。\n   四舍五入到四位有效数字，剂量为 $10.00 \\, \\mathrm{mg}$ 和 $14.00 \\, \\mathrm{mg}$。\n\n2. **分配比例：**\n   问题指定了等量分配。\n   $n_1/N = 0.5$。\n   $n_2/N = 0.5$。\n   四舍五入到四位有效数字，它们是 $0.5000$ 和 $0.5000$。\n\n3. **总样本量：**\n   我们使用 $N$ 的公式，以及先前的参数猜测值 $\\beta = 0.25 \\, \\mathrm{mg}^{-1}$ 和最优间隔 $s=2 \\, \\mathrm{mg}$。\n   自变量为 $\\beta s = 0.25 \\times 2 = 0.5$。\n   信息项为 $W = \\frac{\\exp(0.5)}{(1+\\exp(0.5))^2}$。\n   $W \\approx \\frac{1.64872127}{(1+1.64872127)^2} \\approx \\frac{1.64872127}{2.64872127^2} \\approx \\frac{1.64872127}{7.0157238} \\approx 0.2350037$。\n   所需的样本量为：\n   $$\n   N \\ge \\frac{1.96^2}{1.0^2 \\times (0.25)^2 \\times W} \\approx \\frac{3.8416}{0.0625 \\times 0.2350037} \\approx \\frac{3.8416}{0.01468773} \\approx 261.551\n   $$\n   总样本量必须是满足此标准的最小整数。因此，我们必须选择 $N=262$。这允许等量分配，即 $n_1=n_2=131$。\n\n最终的设计参数是 $d_1=10.00\\,\\mathrm{mg}$，$d_2=14.00\\,\\mathrm{mg}$，分配比例各为 $0.5000$，总样本量为 $N=262$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10.00 & 14.00 & 0.5000 & 0.5000 & 262\n\\end{pmatrix}\n}\n$$", "id": "4586905"}]}