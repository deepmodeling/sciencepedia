{"hands_on_practices": [{"introduction": "理解拮抗剂的量化效应始于基本原理。本练习将指导您直接从质量作用定律推导竞争性拮抗剂的剂量-比率关系，为理解这些药物如何改变激动剂效价提供坚实的理论基础。通过这个推导，您将能够量化拮抗剂存在时激动剂浓度-效应曲线的移动程度。[@problem_id:4542832]", "problem": "一种完全激动剂 $A$ 在没有备用受体的组织中产生反应，并且从占用（occupancy）到反应的转导是线性的，使得反应 $E$ 与激动剂 $A$ 占据的受体分数成正比。该激动剂可逆地结合到单一类型的非相互作用受体上，希尔（Hill）系数 $n_{H}=1$。在没有任何拮抗剂的情况下，半数有效浓度（EC50）$EC_{50,0}$ 等于激动剂的平衡解离常数 $K_{A}$。现加入平衡解离常数为 $K_{B}$ 的可逆竞争性拮抗剂 $B$，其浓度固定为 $[B]$。假设质量作用定律适用于 $A$ 和 $B$ 与同一位点的结合，并且没有变构效应。\n\n已知 $K_{B} = 10$ nM 且 $[B] = 30$ nM，请使用平衡时受体占用的第一性原理，推导在拮抗剂存在下的表观半数有效浓度 $EC_{50,\\mathrm{app}}$（以 $EC_{50,0}$、$K_{B}$ 和 $[B]$ 表示）。然后，根据给定的 $K_{B}$ 和 $[B]$ 计算倍移（fold-shift）$r \\equiv \\dfrac{EC_{50,\\mathrm{app}}}{EC_{50,0}}$ 的数值。最后，通过计算比率 $\\rho \\equiv \\dfrac{E_{\\max,\\mathrm{app}}}{E_{\\max,0}}$ 来判断在这些假设下最大效应是否改变。\n\n请提供精确值，无需四舍五入。将最终答案以包含两个条目的行矩阵形式报告 $\\big(r,\\ \\rho\\big)$，两个条目均为无单位的无量纲数。", "solution": "经评估，问题陈述有效。其科学依据在于受体药理学的既定原理，特别是可逆竞争性拮抗作用模型。问题提法明确，具有推导唯一解所需的完整且一致的定义、假设和数据。语言客观，没有歧义。\n\n推导从平衡状态下受体-配体结合的第一性原理开始。设 $[R]$ 为游离受体的浓度，$[A]$ 为激动剂 $A$ 的浓度，$[B]$ 为竞争性拮抗剂 $B$ 的浓度。激动剂和拮抗剂结合到同一受体位点。\n\n结合反应为：\n$R + A \\rightleftharpoons RA$\n$R + B \\rightleftharpoons RB$\n\n激动剂的平衡解离常数（$K_A$）和拮抗剂的平衡解离常数（$K_B$）由质量作用定律定义：\n$$K_A = \\frac{[R][A]}{[RA]}$$\n$$K_B = \\frac{[R][B]}{[RB]}$$\n\n受体总浓度 $[R_T]$ 是游离受体 $[R]$、激动剂结合的受体 $[RA]$ 和拮抗剂结合的受体 $[RB]$ 的浓度之和：\n$$[R_T] = [R] + [RA] + [RB]$$\n\n根据题意，反应 $E$ 与激动剂对受体的分数占用率 $p_A$ 成正比。分数占用率定义为：\n$$p_A = \\frac{[RA]}{[R_T]}$$\n\n为了推导 $p_A$ 的表达式，我们首先用 $[RA]$ 和常数来表示 $[R]$ 和 $[RB]$。根据 $K_A$ 的定义，我们有 $[R] = \\frac{K_A [RA]}{[A]}$。根据 $K_B$ 的定义，我们有 $[RB] = \\frac{[R][B]}{K_B}$。将 $[R]$ 的表达式代入 $[RB]$ 的表达式中，得到：\n$$[RB] = \\frac{\\left(\\frac{K_A [RA]}{[A]}\\right)[B]}{K_B} = [RA]\\frac{K_A [B]}{K_B [A]}$$\n\n现在我们将 $[R]$ 和 $[RB]$ 的表达式代入受体总数守恒方程：\n$$[R_T] = \\frac{K_A [RA]}{[A]} + [RA] + [RA]\\frac{K_A [B]}{K_B [A]}$$\n\n提出公因子 $[RA]$：\n$$[R_T] = [RA] \\left( 1 + \\frac{K_A}{[A]} + \\frac{K_A [B]}{K_B [A]} \\right)$$\n\n因此，分数占用率 $p_A$ 为：\n$$p_A = \\frac{[RA]}{[R_T]} = \\frac{1}{1 + \\frac{K_A}{[A]} + \\frac{K_A [B]}{K_B [A]}}$$\n\n为简化此表达式，将分子和分母同乘以 $[A]$：\n$$p_A = \\frac{[A]}{[A] + K_A + \\frac{K_A [B]}{K_B}}$$\n\n这可以重排为更标准的形式：\n$$p_A = \\frac{[A]}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + [A]}$$\n\n药理反应 $E$ 与 $p_A$ 成正比。设 $E_{\\max}$ 为最大可能反应，这在 $p_A = 1$ 时发生。考虑到线性转导，我们有 $E = E_{\\max} \\cdot p_A$。\n$$E = E_{\\max} \\frac{[A]}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + [A]}$$\n\n在没有拮抗剂时，$[B]=0$。反应为 $E_0$：\n$$E_0 = E_{\\max,0} \\frac{[A]}{K_A + [A]}$$\n在没有拮抗剂时的半数有效浓度 $EC_{50,0}$，是使 $E_0 = \\frac{1}{2} E_{\\max,0}$ 时的浓度 $[A]$。\n$$\\frac{1}{2} E_{\\max,0} = E_{\\max,0} \\frac{EC_{50,0}}{K_A + EC_{50,0}} \\implies \\frac{1}{2} = \\frac{EC_{50,0}}{K_A + EC_{50,0}}$$\n$$K_A + EC_{50,0} = 2 \\cdot EC_{50,0} \\implies K_A = EC_{50,0}$$\n这证实了问题陈述中给出的条件。\n\n现在我们确定在拮抗剂存在下的表观最大效应 $E_{\\max,\\mathrm{app}}$。这是当 $[A] \\rightarrow \\infty$ 时反应 $E$ 的极限：\n$$E_{\\max,\\mathrm{app}} = \\lim_{[A] \\to \\infty} E_{\\max} \\frac{[A]}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + [A]}$$\n将分子和分母同除以 $[A]$：\n$$E_{\\max,\\mathrm{app}} = E_{\\max} \\lim_{[A] \\to \\infty} \\frac{1}{\\frac{K_A}{[A]} \\left(1 + \\frac{[B]}{K_B}\\right) + 1} = E_{\\max} \\left(\\frac{1}{0 + 1}\\right) = E_{\\max}$$\n由于内在最大反应 $E_{\\max}$ 是激动剂-受体系统的一个属性，它与 $E_{\\max,0}$ 相同。因此，$E_{\\max,\\mathrm{app}} = E_{\\max,0}$。可逆竞争性拮抗剂不改变最大效应。因此，比率 $\\rho$ 为：\n$$\\rho \\equiv \\frac{E_{\\max,\\mathrm{app}}}{E_{\\max,0}} = \\frac{E_{\\max,0}}{E_{\\max,0}} = 1$$\n\n接下来，我们推导表观半数有效浓度 $EC_{50,\\mathrm{app}}$。这是在拮抗剂存在下，产生最大反应 $E_{\\max,\\mathrm{app}}$ 一半时的激动剂浓度 $[A]$。\n$$E = \\frac{1}{2} E_{\\max,\\mathrm{app}} = \\frac{1}{2} E_{\\max}$$\n将此代入含拮抗剂的反应方程中：\n$$\\frac{1}{2} E_{\\max} = E_{\\max} \\frac{EC_{50,\\mathrm{app}}}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + EC_{50,\\mathrm{app}}}$$\n$$\\frac{1}{2} = \\frac{EC_{50,\\mathrm{app}}}{K_A \\left(1 + \\frac{[B]}{K_B}\\right) + EC_{50,\\mathrm{app}}}$$\n$$K_A \\left(1 + \\frac{[B]}{K_B}\\right) + EC_{50,\\mathrm{app}} = 2 \\cdot EC_{50,\\mathrm{app}}$$\n$$EC_{50,\\mathrm{app}} = K_A \\left(1 + \\frac{[B]}{K_B}\\right)$$\n用 $EC_{50,0}$ 代替 $K_A$，我们得到所需的表达式：\n$$EC_{50,\\mathrm{app}} = EC_{50,0} \\left(1 + \\frac{[B]}{K_B}\\right)$$\n这是 Gaddum-Schild 方程的一种形式。\n\n倍移 $r$ 定义为比率 $\\frac{EC_{50,\\mathrm{app}}}{EC_{50,0}}$。\n$$r \\equiv \\frac{EC_{50,\\mathrm{app}}}{EC_{50,0}} = \\frac{EC_{50,0} \\left(1 + \\frac{[B]}{K_B}\\right)}{EC_{50,0}} = 1 + \\frac{[B]}{K_B}$$\n\n给定 $K_B = 10$ nM 和 $[B] = 30$ nM。我们现在可以计算 $r$ 的数值。单位（nM）会抵消。\n$$r = 1 + \\frac{30}{10} = 1 + 3 = 4$$\n\n所要求的两个无量纲数是 $r = 4$ 和 $\\rho = 1$。", "answer": "$$\\boxed{\\begin{pmatrix} 4  1 \\end{pmatrix}}$$", "id": "4542832"}, {"introduction": "药理学数据分析不仅仅是将数字代入公式，更涉及假设检验。在这个实际场景中，您将分析一组剂量-反应数据，以确定一种拮抗剂是否表现出竞争性行为。这项练习的核心是检验竞争性拮抗作用的一个关键特征——在不同效应水平上剂量比（dose ratio）的恒定性，并利用此信息来量化拮抗剂的效价。[@problem_id:4542830]", "problem": "一个完全激动剂 $A$ 作用于单一受体群体，其希尔系数约为 $1$（单位斜率），并产生最大效应 $E_{\\max}$。在没有拮抗剂的情况下，产生分数效应 $E/E_{\\max} \\in \\{0.2, 0.5, 0.8\\}$ 所需的 $A$ 的浓度分别为 $[A]_{0.2} = 2.5\\,\\text{nM}$、$[A]_{0.5} = 10\\,\\text{nM}$ 和 $[A]_{0.8} = 40\\,\\text{nM}$。在固定浓度的可逆拮抗剂 $B$（浓度为 $[B] = 64\\,\\text{nM}$）存在的情况下，达到相同分数效应所需的 $A$ 的浓度为 $[A]'_{0.2} = 16\\,\\text{nM}$、$[A]'_{0.5} = 64\\,\\text{nM}$ 和 $[A]'_{0.8} = 256\\,\\text{nM}$。假设质量作用平衡结合、单一均质受体类别、无备用受体，并且在这些条件下观察到的效应与激动剂受体占有率成正比。\n\n仅使用基本定义和平衡推理：\n- 计算每个效应水平下的剂量比，定义为 $\\text{DR}(E) = \\dfrac{[A]'_{E}}{[A]_{E}}$。\n- 根据您的计算和假设的机制，评估右移是否平行且与竞争性拮抗作用一致。\n- 在相互作用为纯粹竞争性的假设下，估算拮抗剂的平衡解离常数 $K_{B}$。\n\n将最终答案表示为 $K_{B}$ 的单一数值（单位为 $\\text{nM}$），并四舍五入到三位有效数字。", "solution": "在尝试求解之前，将根据所需标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 激动剂：$A$，一种完全激动剂。\n- 受体特性：单一群体，希尔系数约为 $1$。\n- 最大效应：$E_{\\max}$。\n- 无拮抗剂时的数据：\n  - 对于分数效应 $E/E_{\\max} = 0.2$，激动剂浓度为 $[A]_{0.2} = 2.5\\,\\text{nM}$。\n  - 对于分数效应 $E/E_{\\max} = 0.5$，激动剂浓度为 $[A]_{0.5} = 10\\,\\text{nM}$。\n  - 对于分数效应 $E/E_{\\max} = 0.8$，激动剂浓度为 $[A]_{0.8} = 40\\,\\text{nM}$。\n- 拮抗剂：$B$，一种可逆拮抗剂。\n- 拮抗剂浓度：$[B] = 64\\,\\text{nM}$（固定）。\n- 有拮抗剂时的数据：\n  - 对于分数效应 $E/E_{\\max} = 0.2$，激动剂浓度为 $[A]'_{0.2} = 16\\,\\text{nM}$。\n  - 对于分数效应 $E/E_{\\max} = 0.5$，激动剂浓度为 $[A]'_{0.5} = 64\\,\\text{nM}$。\n  - 对于分数效应 $E/E_{\\max} = 0.8$，激动剂浓度为 $[A]'_{0.8} = 256\\,\\text{nM}$。\n- 假设：\n  - 质量作用平衡结合。\n  - 单一均质受体类别。\n  - 无备用受体。\n  - 观察到的效应与激动剂受体占有率成正比。\n- 要求计算：\n  1. 计算每个效应水平下的剂量比 $\\text{DR}(E) = \\dfrac{[A]'_{E}}{[A]_{E}}$。\n  2. 评估曲线的平移是否平行且与竞争性拮抗作用一致。\n  3. 在竞争性拮抗作用的假设下，估算拮抗剂的平衡解离常数 $K_{B}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上基于经典的受体理论和药理学。所提供的数据和假设是分析*in vitro*激动剂-拮抗剂相互作用的标准方法。我们首先验证在没有拮抗剂的情况下数据的内部一致性。\n\n这些假设（希尔系数 $\\approx 1$、无备用受体、效应与占有率成正比）意味着分数效应 $f_E = E/E_{\\max}$ 遵循希尔-朗缪尔方程，其中分数效应等于受体分数占有率 $p_A$：\n$$f_E = p_A = \\frac{[A]}{[A] + K_A}$$\n其中 $K_A$ 是激动剂 $A$ 的平衡解离常数。根据定义，产生 $50\\%$ 最大效应的激动剂浓度是 $EC_{50}$。在给定假设下，$EC_{50} = K_A$。从数据中可知 $[A]_{0.5} = 10\\,\\text{nM}$，因此我们推断 $K_A = 10\\,\\text{nM}$。\n\n我们来检查另外两个数据点是否与这个 $K_A$ 值一致。该关系式可以重新排列以求解 $[A]$：\n$$[A] = K_A \\left( \\frac{f_E}{1 - f_E} \\right)$$\n对于 $f_E = 0.2$：$[A]_{0.2} = (10\\,\\text{nM}) \\left( \\frac{0.2}{1 - 0.2} \\right) = (10\\,\\text{nM}) \\left( \\frac{0.2}{0.8} \\right) = 2.5\\,\\text{nM}$。这与提供的数据相符。\n对于 $f_E = 0.8$：$[A]_{0.8} = (10\\,\\text{nM}) \\left( \\frac{0.8}{1 - 0.8} \\right) = (10\\,\\text{nM}) \\left( \\frac{0.8}{0.2} \\right) = 40\\,\\text{nM}$。这也与提供的数据相符。\n\n数据内部一致，并符合指定的理论模型。该问题提法恰当、客观且完整。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答\n该问题要求分析在有和没有拮抗剂情况下的激动剂剂量-效应数据，以表征拮抗作用的性质并确定拮抗剂的解离常数 $K_B$。\n\n将依次完成这三项任务。\n\n**1. 计算每个效应水平下的剂量比。**\n\n剂量比 $\\text{DR}$ 定义为：在拮抗剂存在下产生某一效应所需的激动剂浓度 $[A]'_{E}$，与在没有拮抗剂情况下产生相同效应所需的激动剂浓度 $[A]_{E}$ 之比。\n$$\\text{DR}(E) = \\frac{[A]'_{E}}{[A]_{E}}$$\n\n我们获得了三个分数效应水平 $f_E = E/E_{\\max} \\in \\{0.2, 0.5, 0.8\\}$ 的数据。我们计算每个水平的剂量比。\n\n对于 $f_E = 0.2$：\n$$\\text{DR}(0.2) = \\frac{[A]'_{0.2}}{[A]_{0.2}} = \\frac{16\\,\\text{nM}}{2.5\\,\\text{nM}} = 6.4$$\n\n对于 $f_E = 0.5$：\n$$\\text{DR}(0.5) = \\frac{[A]'_{0.5}}{[A]_{0.5}} = \\frac{64\\,\\text{nM}}{10\\,\\text{nM}} = 6.4$$\n\n对于 $f_E = 0.8$：\n$$\\text{DR}(0.8) = \\frac{[A]'_{0.8}}{[A]_{0.8}} = \\frac{256\\,\\text{nM}}{40\\,\\text{nM}} = 6.4$$\n\n**2. 评估曲线平移是否与竞争性拮抗作用一致。**\n\n计算结果表明，在所有测量的效应水平上，剂量比是恒定的：$\\text{DR}(0.2) = \\text{DR}(0.5) = \\text{DR}(0.8) = 6.4$。剂量比不依赖于效应水平是简单竞争性拮抗作用的决定性特征。这表明，在效应-对数激动剂浓度（$\\log([\\text{Agonist}])$）图上，与没有拮抗剂时的曲线相比，有拮抗剂时的剂量-效应曲线向右平行移动。最大效应 $E_{\\max}$ 未改变。因此，数据完全符合竞争性拮抗作用的机制。\n\n**3. 估算拮抗剂的平衡解离常数 $K_B$。**\n\n对于一个简单的竞争性拮抗剂 $B$，其与激动剂 $A$ 在受体上的相互作用由 Schild 方程描述：\n$$\\text{DR} = 1 + \\frac{[B]}{K_B}$$\n其中 $[B]$ 是拮抗剂的浓度，$K_B$ 是其平衡解离常数。该方程将经验测定的剂量比与拮抗剂对受体的亲和力直接联系起来。\n\n我们已经确定，在固定拮抗剂浓度为 $[B] = 64\\,\\text{nM}$ 时，剂量比为 $\\text{DR} = 6.4$。现在我们可以求解 $K_B$。\n$$6.4 = 1 + \\frac{64\\,\\text{nM}}{K_B}$$\n两边同时减去 $1$ 得：\n$$5.4 = \\frac{64\\,\\text{nM}}{K_B}$$\n重新整理方程以求解 $K_B$：\n$$K_B = \\frac{64\\,\\text{nM}}{5.4}$$\n$$K_B = 11.85185... \\,\\text{nM}$$\n问题要求答案四舍五入到三位有效数字。\n$$K_B \\approx 11.9\\,\\text{nM}$$\n拮抗剂 $B$ 的平衡解离常数估计为 $11.9\\,\\text{nM}$。", "answer": "$$\n\\boxed{11.9}\n$$", "id": "4542830"}, {"introduction": "现代药理学依赖稳健的计算方法来分析实验数据。这项高级练习将挑战您实现一个完整的Schild分析流程，从数据转换、线性回归到关键效价参数（如 $pA_2$ 和 $K_B$）的计算。完成此练习将使您掌握解释理想和非理想拮抗行为的技能，这是药物研发和临床前研究中的一项核心能力。[@problem_id:4542753]", "problem": "您的任务是构建一个程序，用于在高级研究生水平上使用 Schild 方法对竞争性和非竞争性拮抗作用进行定量分析。该分析必须基于质量作用定律的第一性原理以及激动剂效价移动（剂量比）的定义，并且必须适用于拮抗剂浓度和实验观测剂量比的通用输入。对于每个提供的测试用例，您的程序必须构建 Schild 图，使用普通最小二乘法 (OLS) 估计斜率，并计算拮抗剂的平衡解离常数 $K_B$ 以及 $pA_2 = -\\log_{10} K_B$。此过程需遵循一个科学上合理的操作性定义，该定义在斜率等于 $1$（纯粹竞争性拮抗作用）或偏离 $1$（非竞争性或不可逾越性行为）时均保持有效。\n\n使用的基本原理：\n- 平衡状态下的质量作用定律将配体浓度与受体占有率联系起来。\n- 剂量比 $DR$ 定义为：在有拮抗剂存在时产生特定效应水平（例如，半最大效应）所需的激动剂浓度，与在无拮抗剂时产生相同效应所需的激动剂浓度之比。\n- 对于可逾越性竞争性拮抗作用，质量作用定律意味着激动剂浓度-效应曲线会发生可预测的移动，这可以通过由 $DR$ 和拮抗剂浓度构建的 Schild 图进行分析。\n- Schild 分析使用以 10 为底的对数和对转换后的变量进行的线性回归。\n\n程序要求：\n1. 对于每个测试用例，您将获得一个以纳摩尔 ($\\mathrm{nM}$) 为单位的拮抗剂浓度列表和相应的实验观测剂量比 $DR$。您的程序必须使用 $1\\,\\mathrm{nM} = 10^{-9}\\,\\mathrm{M}$ 将拮抗剂浓度转换为摩尔单位 ($\\mathrm{M}$)。\n2. 通过对每个数据点进行转换，构建 Schild 图：$x = \\log_{10}([B]\\,\\mathrm{in}\\,\\mathrm{M})$ 和 $y = \\log_{10}(DR - 1)$，其中 $[B]$ 是拮抗剂浓度。\n3. 通过普通最小二乘法 (OLS) 估计线性关系 $y = m\\,x + c$ 的斜率 $m$ 和 y 轴截距 $c$。\n4. 计算与 $K_B$ 和 $pA_2$ 相关的两个估计值：\n   - 一个基于 y 轴截距的估计值 $K_B^{(y)}$，由单位斜率下的竞争性拮抗特性定义：如果 $m \\approx 1$，则 y 轴截距等于 $-\\log_{10} K_B$，因此 $K_B^{(y)} = 10^{-c}$（单位为 $\\mathrm{M}$）。为了报告目的，您的程序必须计算 $K_B^{(y)}$，无论斜率如何。\n   - 一个基于 $y=0$ 时（即 $DR = 2$ 的点）的 x 轴截距的操作性估计值，该值对斜率偏差具有稳健性：由于 $y=0$ 意味着 $x_0 = -c/m$，定义 $K_B^{(x)} = 10^{x_0}$（单位为 $\\mathrm{M}$）和 $pA_2 = -\\log_{10} K_B^{(x)} = -x_0 = c/m$。\n5. 数值必须使用以 10 为底的对数计算。所有 $K_B$ 的输出必须以 $\\mathrm{M}$ 表示，$pA_2$ 必须表示为小数（不带百分号）。\n\n测试套件：\n使用以下三个科学上合理的案例。每个列表以有序元组 $\\{[B]\\,\\mathrm{in}\\,\\mathrm{nM}, DR\\}$ 的形式给出，所有数字都应按给定的精确值使用。\n\n- 案例 1（典型的类竞争性数据）：$\\{[10, 30, 100, 300], [1.2, 1.6, 3.0, 7.0]\\}$\n- 案例 2（斜率小于 1 的不可逾越性/类非竞争性行为）：$\\{[10, 30, 100, 300], [2.0, 3.16, 6.01, 13.82]\\}$\n- 案例 3（在低拮抗剂浓度下剂量比接近 1 的边界情况）：$\\{[1, 3, 10, 30], [1.001, 1.003, 1.01, 1.03]\\}$\n\n最终输出格式：\n- 对于每个案例，生成列表 $[m, K_B^{(y)}, K_B^{(x)}, pA_2]$，其中 $m$ 是 OLS 斜率（无单位），$K_B^{(y)}$ 和 $K_B^{(x)}$ 的单位是 $\\mathrm{M}$，$pA_2$ 是无单位的小数。\n- 您的程序应生成单行输出，其中包含所有案例的结果，形式为一个用方括号括起来的逗号分隔列表，每个案例的列表也用其自己的方括号括起来，且没有空格。例如：$[[m_1,K_{B,1}^{(y)},K_{B,1}^{(x)},pA_{2,1}],[m_2,K_{B,2}^{(y)},K_{B,2}^{(x)},pA_{2,2}],[m_3,K_{B,3}^{(y)},K_{B,3}^{(x)},pA_{2,3}]]$。", "solution": "使用 Schild 分析量化拮抗剂亲和力是经典药理学的一个基石。要求是基于第一性原理实现一个用于此分析的计算程序，该程序既适用于理想拮抗作用也适用于非理想拮抗作用，并将其应用于一组给定的测试用例。该问题科学上有效、定义明确，并提供了解决问题所需的所有信息。\n\n**理论基础：质量作用定律与受体占有率**\n\n药物与其受体在平衡状态下的相互作用由质量作用定律支配。让我们考虑一个激动剂 $A$ 和一个竞争性拮抗剂 $B$，它们可逆地结合到同一个受体位点 $R$。它们各自的解离常数是 $K_A$ 和 $K_B$。\n\n平衡关系为：\n$$ A + R \\rightleftharpoons AR \\quad \\text{with} \\quad K_A = \\frac{[A][R]}{[AR]} $$\n$$ B + R \\rightleftharpoons BR \\quad \\text{with} \\quad K_B = \\frac{[B][R]}{[BR]} $$\n\n此处，$[A]$、$[B]$ 和 $[R]$ 分别代表游离激动剂、游离拮抗剂和游离受体的摩尔浓度。$[AR]$ 和 $[BR]$ 是激动剂-受体复合物和拮抗剂-受体复合物的浓度。总受体浓度 $[R]_T$ 是所有受体状态的总和：\n$$ [R]_T = [R] + [AR] + [BR] $$\n\n生理或药理效应通常被认为是激动剂-受体占有率 $p_{AR} = \\frac{[AR]}{[R]_T}$ 的函数。我们可以用配体浓度和解离常数来表示 $p_{AR}$。通过重排平衡方程，我们得到 $[R] = K_A \\frac{[AR]}{[A]}$ 和 $[BR] = \\frac{[B][R]}{K_B} = \\frac{[B]}{K_B} K_A \\frac{[AR]}{[A]}$。将这些代入 $[R]_T$ 的表达式中：\n$$ [R]_T = K_A \\frac{[AR]}{[A]} + [AR] + \\frac{[B]}{K_B} K_A \\frac{[AR]}{[A]} = [AR] \\left( 1 + \\frac{K_A}{[A]} \\left( 1 + \\frac{[B]}{K_B} \\right) \\right) $$\n因此，激动剂的分数占有率为：\n$$ p_{AR} = \\frac{[AR]}{[R]_T} = \\frac{1}{1 + \\frac{K_A}{[A]} \\left( 1 + \\frac{[B]}{K_B} \\right)} = \\frac{[A]}{[A] + K_A \\left( 1 + \\frac{[B]}{K_B} \\right)} $$\n\n**Schild 方程的推导**\n\n剂量比 $DR$ 定义为在拮抗剂存在（$[A]''$）和不存在（$[A]'$）的情况下，产生相同效应所需的激动剂浓度之比。由于假定效应相同，因此两种情况下的受体占有率 $p_{AR}$ 也必须相同。\n\n在没有拮抗剂（$[B] = 0$）的情况下，占有率为：\n$$ p_{AR} = \\frac{[A]'}{[A]' + K_A} $$\n在拮抗剂浓度为 $[B]$ 的情况下，占有率为：\n$$ p_{AR} = \\frac{[A]''}{[A]'' + K_A \\left( 1 + \\frac{[B]}{K_B} \\right)} $$\n令 $p_{AR}$ 的两个表达式相等并求解激动剂浓度之比，可得：\n$$ \\frac{[A]' + K_A}{[A]'} = \\frac{[A]'' + K_A \\left( 1 + \\frac{[B]}{K_B} \\right)}{[A]''} $$\n$$ 1 + \\frac{K_A}{[A]'} = 1 + \\frac{K_A}{[A]''} \\left( 1 + \\frac{[B]}{K_B} \\right) $$\n$$ \\frac{[A]''}{[A]'} = 1 + \\frac{[B]}{K_B} $$\n根据定义，$DR = \\frac{[A]''}{[A]'}$，这导出了理想竞争性拮抗作用的 Gaddum-Schild 方程：\n$$ DR = 1 + \\frac{[B]}{K_B} $$\n\n**Schild 图及其解释**\n\n为了进行分析，该方程通过重排和应用以 10 为底的对数进行转换。此转换的一个先决条件是 $DR > 1$，这在有拮抗剂存在时是预期的。\n$$ DR - 1 = \\frac{[B]}{K_B} $$\n$$ \\log_{10}(DR - 1) = \\log_{10}([B]) - \\log_{10}(K_B) $$\n这个方程是直线方程 $y = m\\,x + c$ 的形式，其中：\n-   自变量是 $x = \\log_{10}([B])$，其中 $[B]$ 以摩尔单位（$\\mathrm{M}$）表示。\n-   因变量是 $y = \\log_{10}(DR - 1)$。\n-   理论斜率为 $m = 1$。\n-   理论 y 轴截距为 $c = -\\log_{10}(K_B)$。\n\ny 对 x 的图就是 Schild 图。斜率为 1 ($m=1$) 是简单、可逆、竞争性拮抗作用的一个定义性特征。斜率偏离 1 表明存在更复杂的机制，例如非竞争性拮抗作用、变构调节或实验假象。\n\n**拮抗剂效价的操作性定义**\n\n该问题要求使用对理想模型偏差具有稳健性的定义来计算拮抗剂效价。\n\n1.  **斜率 ($m$) 和截距 ($c$)**：这些是通过使用普通最小二乘法 (OLS) 线性回归，从实验数据点 $(\\log_{10}([B]_i), \\log_{10}(DR_i - 1))$ 估计得出的。\n\n2.  **基于 Y 轴截距的亲和力估计 ($K_B^{(y)}$)**：该估计是在假定理想竞争模型成立（$m=1$）的情况下推导出来的，此时 $c = -\\log_{10}(K_B)$。因此，$K_B^{(y)}$ 是根据实验确定的截距 $c$ 计算得出，即 $K_B^{(y)} = 10^{-c}$。这个值代表了*如果*拮抗作用是纯粹竞争性时，拮抗剂的解离常数。\n\n3.  **基于 X 轴截距的亲和力估计 ($pA_2$ 和 $K_B^{(x)}$)**：一个更通用、操作性更强的拮抗剂效价度量是 $pA_2$ 值。$pA_2$ 定义为能产生剂量比为 2 的拮抗剂摩尔浓度的负常用对数。\n    -   当 $DR = 2$ 时，转换后的变量 $y = \\log_{10}(2-1) = \\log_{10}(1) = 0$。\n    -   我们通过在回归线方程中设置 $y=0$ 来找到相应的 x 值，记为 $x_0$：$0 = m\\,x_0 + c$，得出 $x_0 = -c/m$。\n    -   根据定义，$pA_2 = -x_0$，所以 $pA_2 = c/m$。这个值在量纲上是一致的（它是一个浓度的负对数），并且代表了拮抗剂产生两倍移动的效价，而与斜率无关。\n    -   相应的摩尔浓度是操作性解离常数，$K_B^{(x)} = 10^{x_0} = 10^{-c/m}$。这是实验确定的产生 $DR = 2$ 的拮抗剂浓度。对于理想竞争性拮抗作用，其中 $m=1$，则 $pA_2 = c$ 且 $K_B^{(x)} = 10^{-c} = K_B^{(y)}$，意味着两种估计值收敛。\n\n**计算方法：普通最小二乘法 (OLS)**\n\n给定一组 $N$ 个数据点 $(x_i, y_i)$，OLS 回归找到能最小化纵向误差平方和的斜率 $m$ 和截距 $c$。$m$ 和 $c$ 的解析解是：\n$$ m = \\frac{N \\sum_{i=1}^{N} x_i y_i - (\\sum_{i=1}^{N} x_i)(\\sum_{i=1}^{N} y_i)}{N \\sum_{i=1}^{N} x_i^2 - (\\sum_{i=1}^{N} x_i)^2} $$\n$$ c = \\bar{y} - m \\bar{x} \\quad \\text{where} \\quad \\bar{x} = \\frac{1}{N}\\sum_{i=1}^{N} x_i \\quad \\text{and} \\quad \\bar{y} = \\frac{1}{N}\\sum_{i=1}^{N} y_i $$\n这些公式将应用于每个测试用例的对数转换数据，以推导出所需的参数。拮抗剂浓度 $[B]$ 必须首先通过乘以 $10^{-9}$ 从纳摩尔 ($\\mathrm{nM}$) 转换为摩尔 ($\\mathrm{M}$)。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_antagonism(B_nM, DR):\n    \"\"\"\n    Performs Schild analysis on a set of antagonist concentrations and dose ratios.\n\n    Args:\n        B_nM (list or np.ndarray): List of antagonist concentrations in nanomolar (nM).\n        DR (list or np.ndarray): List of corresponding dose ratios.\n\n    Returns:\n        list: A list containing [m, K_B_y, K_B_x, pA2], where:\n              - m: OLS slope of the Schild plot.\n              - K_B_y: Intercept-based estimate of K_B in Molar.\n              - K_B_x: Intercept-based estimate of K_B in Molar.\n              - pA2: Operational pA2 value.\n    \"\"\"\n    # 1. Convert antagonist concentration from nM to M.\n    B_M = np.array(B_nM) * 1e-9\n\n    # 2. Construct the Schild plot a, i.e., transform data.\n    # x = log10([B] in M)\n    # y = log10(DR - 1)\n    # The problem guarantees DR > 1 for all test cases.\n    x = np.log10(B_M)\n    y = np.log10(np.array(DR) - 1.0)\n\n    # 3. Estimate slope (m) and intercept (c) using OLS.\n    N = len(x)\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n\n    # OLS formulas:\n    # m = sum((xi - x_mean) * (yi - y_mean)) / sum((xi - x_mean)^2)\n    # c = y_mean - m * x_mean\n    numerator = np.sum((x - x_mean) * (y - y_mean))\n    denominator = np.sum((x - x_mean)**2)\n    \n    # Check for denominator being zero, although unlikely with given data.\n    if denominator == 0:\n        # Undefined slope, cannot proceed. Handle as an error case.\n        return [np.nan, np.nan, np.nan, np.nan]\n        \n    m = numerator / denominator\n    c = y_mean - m * x_mean\n\n    # 4. Compute the required estimates for K_B and pA2.\n    \n    # Y-intercept-based estimate for K_B (assumes slope = 1)\n    # K_B = 10^(-c)\n    K_B_y = 10**(-c)\n\n    # Check for slope being zero to avoid division by zero in the next step.\n    # With the given data where DR increases with [B], m will be positive.\n    if m == 0:\n        K_B_x = np.nan\n        pA2 = np.nan\n    else:\n        # Operational estimate based on x-intercept (robust to slope deviations)\n        # pA2 is the x-value where y=0 (DR=2), but with the sign flipped.\n        # y = m*x + c => x_intercept = -c/m\n        # pA2 = -x_intercept = c/m\n        pA2 = c / m\n        \n        # K_B_x is the molar concentration corresponding to pA2.\n        # K_B_x = 10^(-pA2) = 10^(-c/m)\n        K_B_x = 10**(-pA2)\n\n    return [m, K_B_y, K_B_x, pA2]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: tuple of ([B] in nM, [DR])\n    test_cases = [\n        # Case 1 (canonical competitive-like data)\n        ([10, 30, 100, 300], [1.2, 1.6, 3.0, 7.0]),\n        # Case 2 (insurmountable/non-competitive-like behavior)\n        ([10, 30, 100, 300], [2.0, 3.16, 6.01, 13.82]),\n        # Case 3 (boundary case with DRs close to 1)\n        ([1, 3, 10, 30], [1.001, 1.003, 1.01, 1.03])\n    ]\n\n    all_results = []\n    for B_nM, DR in test_cases:\n        result = analyze_antagonism(B_nM, DR)\n        all_results.append(result)\n\n    # Format the final output string as specified: no spaces between list elements.\n    case_strings = []\n    for res in all_results:\n        # Format each number to avoid excessively long representations.\n        # This part is for clean output; standard float conversion is also fine.\n        inner_str = '[' + ','.join(f'{v:.7g}' for v in res) + ']'\n        case_strings.append(inner_str)\n    \n    final_output = '[' + ','.join(case_strings) + ']'\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "4542753"}]}