{"hands_on_practices": [{"introduction": "药理学中的一项基本技能是将原始实验数据转化为定量的药效学参数。本练习将指导您如何将希尔（Hill）方程拟合到浓度-效应数据，从而确定最大效应（$E_{\\max}$）、半数效应浓度（$EC_{50}$）和希尔系数（$n$）。这些参数是表征药物效力、最大效应和协同性的基石。[@problem_id:4584147]", "problem": "您的任务是使用临床药理学和药效学（PD）的适当原理，根据效应与浓度的测量数据估算关键的药效学参数。该情景植根于受体理论和质量作用定律，其中药物的效应源于其与有限数量靶标的结合，当可用靶标被完全占据时效应达到饱和，而浓度-效应关系的陡峭程度反映了结合或信号传导中的协同相互作用。从这些基本思想出发，构建一个非线性最小二乘估计器，用于估算表征可饱和、单调、S型浓度-效应关系的三个参数：最大效应 $E_{\\max}$、半数有效浓度 $EC_{50}$，以及通常称为希尔系数的斜率参数 $n$。量 $E_{\\max}$ 和 $EC_{50}$ 必须为严格正值，并具有物理单位，$E_{\\max}$ 的效应单位为任意单位（a.u.），$EC_{50}$ 的单位为 $\\mathrm{mg}/\\mathrm{L}$，而希尔系数 $n$ 必须为严格正值且无量纲。以下数据提供了测量的药物浓度（单位：$\\mathrm{mg}/\\mathrm{L}$）和观察到的效应（单位：a.u.），您的程序必须拟合一个源自质量作用定律以及效应与分数占据率之间比例关系的三参数受体占据一致性模型，不得对测量数据进行任何线性化或变换处理。\n\n您的估计器必须：\n1. 在每个给定浓度下，最小化观察效应与模型预测效应之间的残差平方和。\n2. 在优化过程中强制执行约束条件 $E_{\\max} \\gt 0$、$EC_{50} \\gt 0$ 和 $n \\gt 0$。\n3. 仅根据数据本身提供稳健的初始猜测值，不使用任何基准真实参数。\n4. 返回拟合参数 $E_{\\max}$（单位：a.u.）、$EC_{50}$（单位：$\\mathrm{mg}/\\mathrm{L}$）和 $n$（无量纲），每个参数四舍五入到3位小数。\n\n此外，使用以下分类规则，并设容差 $\\tau = 0.05$，对希尔系数 $n$ 关于协同行为的解释进行量化编码：如果 $n \\lt 1 - \\tau$（负协同性），则输出 $-1$；如果 $|n - 1| \\le \\tau$（非协同性），则输出 $0$；如果 $n \\gt 1 + \\tau$（正协同性），则输出 $+1$。分类代码必须为整数。\n\n使用以下包含四个独立数据集的测试套件。对于每个数据集，浓度单位为 $\\mathrm{mg}/\\mathrm{L}$，效应单位为 a.u。请分别为每个数据集提供估计值。\n\n数据集A（宽范围，中等斜率）：\n- 浓度：$\\{0.25, 0.5, 1, 2, 4, 8, 16\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{3.828, 9.520, 21.710, 42.270, 65.880, 83.580, 93.070\\}$ a.u.\n\n数据集B（边界接近非协同性）：\n- 浓度：$\\{0.05, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{4.545, 8.333, 14.286, 25.000, 33.333, 40.000, 45.455\\}$ a.u.\n\n数据集C（高协同性，陡峭过渡）：\n- 浓度：$\\{0.10, 0.20, 0.50, 1.00, 2.00, 3.00, 5.00, 10.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{0.008, 0.128, 4.706, 40.000, 75.294, 79.024, 79.872, 79.992\\}$ a.u.\n\n数据集D（观察范围内饱和度差）：\n- 浓度：$\\{1.00, 2.00, 5.00, 10.00, 20.00, 50.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{0.891, 1.765, 4.286, 8.182, 15.000, 30.000\\}$ a.u.\n\n角度单位不适用。最终输出必须严格使用上述指定的单位。\n\n您的程序必须生成单行输出，其中包含一个嵌套的逗号分隔四元组列表形式的结果，每个数据集对应一个四元组，格式为 $[E_{\\max}, EC_{50}, n, \\text{coop\\_code}]$。整个输出必须用方括号括起来，并且每个浮点数值都必须四舍五入到3位小数。例如，两个数据集的输出将类似于 $[[e_{1},c_{1},n_{1},k_{1}],[e_{2},c_{2},n_{2},k_{2}]]$，其中 $e_{i}$、$c_{i}$ 和 $n_{i}$ 是浮点数，$k_{i}$ 是整数。\n\n您的程序必须确定性地运行，并且不得读取任何外部输入。", "solution": "问题是从药物测量的浓度-效应关系中估算其药效学参数。问题陈述在科学上是合理的、适定的且内部一致的。它准确地描述了临床药理学中的一项标准任务，即对S型剂量-反应曲线进行参数化。\n\n基本原理是应用于药物-受体结合的质量作用定律。药物浓度 $C$ 与产生的生理效应 $E$ 之间的关系由希尔-朗缪尔方程描述。该模型假设效应与药物占据的受体分数成正比。对于一个涉及 $n$ 个结合位点的系统，效应 $E$ 作为浓度 $C$ 的函数由下式给出：\n$$\nE(C) = \\frac{E_{\\max} \\cdot C^n}{EC_{50}^n + C^n}\n$$\n需要确定的三个参数是：\n1.  $E_{\\max}$：最大效应，表示在饱和药物浓度下的效应。它必须为正值 ($E_{\\max} > 0$)，单位为效应单位（a.u.）。\n2.  $EC_{50}$：半数有效浓度，即产生最大效应 $50\\%$ 的药物浓度。它必须为正值 ($EC_{50} > 0$)，单位为浓度单位 ($\\mathrm{mg}/\\mathrm{L}$)。\n3.  $n$：希尔系数，一个无量纲参数，描述曲线的陡峭程度并反映药物-受体相互作用的协同性。它必须为正值 ($n > 0$)。\n\n这些参数的估计，统称为向量 $\\theta = [E_{\\max}, EC_{50}, n]$，是使用非线性最小二乘法进行的。这涉及找到使观察效应数据 $E_{\\text{obs},i}$ 与在每个相应浓度 $C_i$ 下的模型预测效应 $E(C_i, \\theta)$ 之间的残差平方和（SSR）最小化的参数值。要最小化的目标函数是：\n$$\n\\text{SSR}(\\theta) = \\sum_{i=1}^{N} \\left[E_{\\text{obs},i} - E(C_i, \\theta)\\right]^2 = \\sum_{i=1}^{N} \\left[E_{\\text{obs},i} - \\frac{E_{\\max} \\cdot C_i^n}{EC_{50}^n + C_i^n}\\right]^2\n$$\n这个优化问题需要数值求解。`scipy.optimize.curve_fit` 函数实现了Levenberg-Marquardt算法，是完成此任务的合适且稳健的工具。\n\n非线性优化的一个关键方面是为参数提供良好的初始猜测值。基于希尔方程的性质，我们可以直接从数据中推导出这些猜测值：\n-   **$E_{\\max}$ 的初始猜测值 ($E_{\\max,0}$)**：一个合理的起点是数据集中的最大观察效应，$E_{\\max,0} = \\max(E_{\\text{obs}})$。这是一个稳健的选择，尽管如果数据未显示完全饱和，它可能是一个低估值。\n-   **$EC_{50}$ 的初始猜测值 ($EC_{50,0}$)**：根据定义，$EC_{50}$ 是效应达到半数最大值时的浓度。因此，一个合乎逻辑的猜测是数据集中，其对应观察效应 $E_{\\text{obs},i}$ 最接近 $E_{\\max,0} / 2$ 的浓度 $C_i$。\n-   **$n$ 的初始猜测值 ($n_0$)**：希尔系数的一个中性且常用的起始值是 $n_0 = 1$，这对应于非协同性的 Michaelis-Menten 模型。\n\n问题要求物理约束条件为 $E_{\\max} > 0$、$EC_{50} > 0$ 和 $n > 0$。通过为 `curve_fit` 函数的所有三个参数提供 0 的下界来强制执行这些约束。\n\n最后，根据结合协同性来解释拟合的希尔系数 $n$。使用指定的容差 $\\tau = 0.05$，分类如下：\n-   负协同性（代码 $-1$）：$n < 1 - \\tau = 0.95$。\n-   非协同性（代码 $0$）：$|n - 1| \\le \\tau$，即 $0.95 \\le n \\le 1.05$。\n-   正协同性（代码 $+1$）：$n > 1 + \\tau = 1.05$。\n\n该程序独立应用于所提供的四个数据集中的每一个。对于每个数据集，算法将：\n1.  定义浓度和效应数据数组。\n2.  计算初始参数猜测值 ($p_0 = [E_{\\max,0}, EC_{50,0}, n_0]$)。\n3.  使用 `curve_fit` 执行约束非线性最小二乘拟合，以找到最优参数。\n4.  对得出的希尔系数 $n$ 进行分类，以确定协同性代码。\n5.  将最终参数（$E_{\\max}$、$EC_{50}$、$n$）四舍五入到3位小数，连同整数协同性代码一起，格式化为指定的输出结构。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits a three-parameter Hill equation to pharmacodynamic data and classifies cooperativity.\n    \"\"\"\n    \n    # Define the Hill equation model for the concentration-effect relationship.\n    # The parameters are E_max, EC50, and n (Hill coefficient).\n    # Using np.asarray ensures inputs are arrays and handles C_safe**n correctly for scalars.\n    def hill_equation(C, E_max, EC50, n):\n        C_safe = np.asarray(C, dtype=float)\n        # To prevent 0**n issues for n0 (though n is constrained >0),\n        # we add a small epsilon. Since concentrations are positive, this has no effect.\n        # This also guards against potential warnings or DomainErrors in some math libraries.\n        numerator = E_max * (C_safe**n)\n        denominator = EC50**n + C_safe**n\n        # Avoid division by zero, although denominator is always > 0 \n        # due to the bounds EC50 > 0.\n        return np.divide(numerator, denominator, out=np.zeros_like(numerator), where=denominator!=0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C\": np.array([0.25, 0.5, 1, 2, 4, 8, 16]),\n            \"E\": np.array([3.828, 9.520, 21.710, 42.270, 65.880, 83.580, 93.070])\n        },\n        {\n            \"C\": np.array([0.05, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00]),\n            \"E\": np.array([4.545, 8.333, 14.286, 25.000, 33.333, 40.000, 45.455])\n        },\n        {\n            \"C\": np.array([0.10, 0.20, 0.50, 1.00, 2.00, 3.00, 5.00, 10.00]),\n            \"E\": np.array([0.008, 0.128, 4.706, 40.000, 75.294, 79.024, 79.872, 79.992])\n        },\n        {\n            \"C\": np.array([1.00, 2.00, 5.00, 10.00, 20.00, 50.00]),\n            \"E\": np.array([0.891, 1.765, 4.286, 8.182, 15.000, 30.000])\n        }\n    ]\n\n    all_results = []\n    \n    # Process each dataset\n    for case in test_cases:\n        C_data = case[\"C\"]\n        E_data = case[\"E\"]\n\n        # 1. Generate robust initial guesses from the data.\n        #    - E_max_0: Maximum observed effect.\n        #    - EC50_0: Concentration where effect is closest to half of E_max_0.\n        #    - n_0: Neutral guess of 1.0 (non-cooperative).\n        E_max_0 = np.max(E_data)\n        if E_max_0 == 0: E_max_0 = 1.0 # Fallback for pathological data\n        \n        half_max_effect = E_max_0 / 2.0\n        # Find index of the effect value closest to half_max_effect\n        idx = np.argmin(np.abs(E_data - half_max_effect))\n        EC50_0 = C_data[idx]\n        if EC50_0 == 0: EC50_0 = np.mean(C_data) # Fallback\n\n        n_0 = 1.0\n        \n        p0 = [E_max_0, EC50_0, n_0]\n\n        # 2. Define the bounds for the parameters (Emax > 0, EC50 > 0, n > 0).\n        bounds = ([0, 0, 0], [np.inf, np.inf, np.inf])\n\n        # 3. Perform nonlinear least-squares fitting.\n        try:\n            popt, _ = curve_fit(hill_equation, C_data, E_data, p0=p0, bounds=bounds, maxfev=10000)\n            E_max_fit, EC50_fit, n_fit = popt\n        except RuntimeError:\n            # In case the fit fails, though it shouldn't for these datasets.\n            E_max_fit, EC50_fit, n_fit = np.nan, np.nan, np.nan\n\n        # 4. Classify the Hill coefficient for cooperativity.\n        tau = 0.05\n        if n_fit  1 - tau:\n            coop_code = -1\n        elif n_fit > 1 + tau:\n            coop_code = 1\n        else:\n            coop_code = 0\n            \n        # 5. Store the formatted result quadruple.\n        # The formatting to 3 decimal places happens during string creation.\n        result_quad = [E_max_fit, EC50_fit, n_fit, coop_code]\n        all_results.append(result_quad)\n\n    # 6. Format the final output string as specified.\n    # Each sublist is formatted as a string with no spaces, e.g., '[1.234,5.678,9.012,1]'\n    # Then these strings are joined by commas and enclosed in outer brackets.\n    list_of_quad_strings = []\n    for quad in all_results:\n        # Format floats to 3 decimal places exactly for the output.\n        quad_str = f\"[{quad[0]:.3f},{quad[1]:.3f},{quad[2]:.3f},{quad[3]}]\"\n        list_of_quad_strings.append(quad_str)\n    \n    final_output_string = f\"[{','.join(list_of_quad_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n\n```", "id": "4584147"}, {"introduction": "在理解了单一药物效应的基础上，本实践将探讨在受体水平上更为复杂的药物相互作用情景。您将应用质量作用定律来分析一个包含完全激动剂和竞争性部分激动剂的系统。通过此练习，您将学会如何预测一种药物的存在如何改变另一种药物的效应，这在多重用药和拮抗剂药物开发中是一个至关重要的概念。[@problem_id:4584191]", "problem": "考虑一个处于平衡状态的充分混合系统中的单一受体群体，其总受体浓度为 $R_T$。两种配体结合到同一个正构位点并竞争占据：完全激动剂 $A$ 的平衡解离常数为 $K_A$，部分激动剂 $P$ 的平衡解离常数为 $K_P$。假设结合遵循质量作用定律，并设每个被占据受体的效能（内在效能）对于完全激动剂 $A$ 为 $\\varepsilon_A$，对于部分激动剂 $P$ 为 $\\varepsilon_P$。可观察到的效应 $E$ 来自于一个与效能加权的分数受体占有率成正比的刺激，因此效应与 $\\varepsilon_A$ 乘以 $A$ 占据的受体分数加上 $\\varepsilon_P$ 乘以 $P$ 占据的受体分数成正比。当下游信号传导未饱和且受体储备可忽略不计时，此线性转导假设成立。药效学 (PD) 旨在通过这些受体水平的过程将配体浓度与效应联系起来。\n\n将一个制剂暴露于固定浓度的完全激动剂 $A$，其浓度为 $[A] = 10 \\ \\mathrm{nM}$，且 $K_A = 5 \\ \\mathrm{nM}$。部分激动剂 $P$ 的 $K_P = 20 \\ \\mathrm{nM}$。内在效能分别为 $\\varepsilon_A = 1.00$ 和 $\\varepsilon_P = 0.30$。确定所需部分激动剂的浓度 $[P]$，以将在 $A$ 存在下的效应降低至相同 $[A]$ 浓度下（且无 $P$ 存在时）单独由 $A$ 产生的效应的 $0.60$ 倍。\n\n以纳摩尔 ($\\mathrm{nM}$) 为单位表示 $[P]$ 的最终答案。将您的答案四舍五入到三位有效数字。", "solution": "用户希望我验证并解决一个涉及竞争性受体结合的定量药效学问题。\n\n### 步骤 1：提取已知条件\n-   总受体浓度：$R_T$\n-   系统是充分混合且处于平衡状态。\n-   配体 1：完全激动剂 $A$。\n-   配体 2：部分激动剂 $P$。\n-   结合位点：两种配体竞争同一个正构位点。\n-   $A$ 的平衡解离常数：$K_A = 5 \\ \\mathrm{nM}$\n-   $P$ 的平衡解离常数：$K_P = 20 \\ \\mathrm{nM}$\n-   $A$ 的浓度：$[A] = 10 \\ \\mathrm{nM}$ (固定的)\n-   $A$ 的内在效能：$\\varepsilon_A = 1.00$\n-   $P$ 的内在效能：$\\varepsilon_P = 0.30$\n-   可观察到的效应 $E$ 与效能加权的分数受体占有率成正比。\n-   目标是找到浓度 $[P]$，使得同时存在 $A$ 和 $P$ 时的效应（记作 $E_{A+P}$）等于单独由 $A$ 产生的效应（记作 $E_A$）的 $0.60$ 倍。即，$E_{A+P} = 0.60 \\cdot E_A$。\n-   $[P]$ 的最终答案应以纳摩尔 ($\\mathrm{nM}$) 为单位，并四舍五入到三位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于质量作用定律和 Clark 受体占有模型，并扩展到两种竞争性配体的情况。内在效能、解离常数和线性刺激-效应关系等概念是经典药效学中的基本和标准原理。所有前提都具有科学合理性。\n-   **良态问题**：该问题是自洽的。它提供了所有必要的参数（$K_A$、$K_P$、$\\varepsilon_A$、$\\varepsilon_P$、$[A]$）和一个明确的目标条件（$E_{A+P} = 0.60 \\cdot E_A$），从而可以为一个未知数 $[P]$ 建立一个可解的代数方程。预期会有一个唯一解。\n-   **客观性**：该问题以精确、定量和无偏见的专业语言陈述。没有主观因素。\n-   **其他缺陷**：该问题没有违反任何其他验证标准。它不是不完整的、矛盾的、不切实际的或病态的。数值对于药物-受体相互作用是合理的。\n\n### 步骤 3：结论与行动\n该问题是有效的。我将进行完整解答。\n\n解答首先推导竞争性结合场景下受体占有的表达式。在平衡状态下，配体 $A$ 和 $P$ 与受体 $R$ 的结合过程描述如下：\n$R + A \\rightleftharpoons RA$\n$R + P \\rightleftharpoons RP$\n\n解离常数定义为：\n$$K_A = \\frac{[R][A]}{[RA]}$$\n$$K_P = \\frac{[R][P]}{[RP]}$$\n其中 $[R]$、$[A]$、$[P]$、$[RA]$ 和 $[RP]$ 分别代表游离受体、游离配体 $A$、游离配体 $P$、激动剂-受体复合物和部分激动剂-受体复合物的摩尔浓度。\n\n总受体浓度 $R_T$ 是游离受体和结合受体之和：\n$$[R_T] = [R] + [RA] + [RP]$$\n根据解离常数的定义，我们可以用游离受体浓度 $[R]$ 来表示结合受体的浓度：\n$$[RA] = \\frac{[R][A]}{K_A}$$\n$$[RP] = \\frac{[R][P]}{K_P}$$\n将这些代入受体的守恒方程中，得到：\n$$[R_T] = [R] + \\frac{[R][A]}{K_A} + \\frac{[R][P]}{K_P} = [R] \\left( 1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P} \\right)$$\n完全激动剂 $A$ 的分数受体占有率（记作 $f_A$）是 $[RA]$ 与 $[R_T]$ 的比值：\n$$f_A = \\frac{[RA]}{[R_T]} = \\frac{\\frac{[R][A]}{K_A}}{[R] \\left( 1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P} \\right)} = \\frac{\\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}}$$\n同样，部分激动剂 $P$ 的分数占有率（记作 $f_P$）是：\n$$f_P = \\frac{[RP]}{[R_T]} = \\frac{\\frac{[R][P]}{K_P}}{[R] \\left( 1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P} \\right)} = \\frac{\\frac{[P]}{K_P}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}}$$\n问题指出，效应 $E$ 与效能加权的分数占有率之和成正比。设 $k$ 为比例常数。同时存在两种配体时的总效应 $E_{A+P}$ 为：\n$$E_{A+P} = k (\\varepsilon_A f_A + \\varepsilon_P f_P) = k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A} + \\varepsilon_P \\frac{[P]}{K_P}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}} \\right)$$\n单独激动剂 $A$ 的效应 $E_A$ 可通过在上述表达式中设置 $[P]=0$ 得到：\n$$f_{A, \\text{alone}} = \\frac{\\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A}}$$\n$$E_A = k (\\varepsilon_A f_{A, \\text{alone}}) = k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A}} \\right)$$\n问题要求我们找到浓度 $[P]$，使得 $E_{A+P} = 0.60 \\cdot E_A$：\n$$k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A} + \\varepsilon_P \\frac{[P]}{K_P}}{1 + \\frac{[A]}{K_A} + \\frac{[P]}{K_P}} \\right) = 0.60 \\cdot k \\left( \\frac{\\varepsilon_A \\frac{[A]}{K_A}}{1 + \\frac{[A]}{K_A}} \\right)$$\n比例常数 $k$ 从两侧消去。为简化方程，我们定义归一化浓度：$a = \\frac{[A]}{K_A}$ 和 $p = \\frac{[P]}{K_P}$。方程变为：\n$$\\frac{\\varepsilon_A a + \\varepsilon_P p}{1 + a + p} = 0.60 \\left( \\frac{\\varepsilon_A a}{1 + a} \\right)$$\n现在我们可以代入给定值。首先，我们计算 $a$ 和方程右侧的值。\n给定 $[A] = 10 \\ \\mathrm{nM}$ 和 $K_A = 5 \\ \\mathrm{nM}$：\n$$a = \\frac{10}{5} = 2$$\n给定 $\\varepsilon_A = 1.00$：\n$$\\text{方程右侧} = 0.60 \\left( \\frac{1.00 \\cdot 2}{1 + 2} \\right) = 0.60 \\left( \\frac{2}{3} \\right) = 0.40$$\n现在，我们将方程左侧设为该值：\n$$\\frac{\\varepsilon_A a + \\varepsilon_P p}{1 + a + p} = 0.40$$\n代入已知的 $\\varepsilon_A$、$\\varepsilon_P$ 和 $a$ 的值：$\\varepsilon_A=1.00$、$\\varepsilon_P=0.30$ 和 $a=2$。\n$$\\frac{(1.00)(2) + (0.30)p}{1 + 2 + p} = 0.40$$\n$$\\frac{2 + 0.30 p}{3 + p} = 0.40$$\n现在，我们求解这个关于 $p$ 的代数方程：\n$$2 + 0.30 p = 0.40(3 + p)$$\n$$2 + 0.30 p = 1.2 + 0.40 p$$\n整理各项以分离出 $p$：\n$$2 - 1.2 = 0.40 p - 0.30 p$$\n$$0.8 = 0.10 p$$\n$$p = \\frac{0.8}{0.10} = 8$$\n最后，我们使用 $p$ 的定义和给定的 $K_P = 20 \\ \\mathrm{nM}$ 值来求得浓度 $[P]$：\n$$p = \\frac{[P]}{K_P} \\implies [P] = p \\cdot K_P$$\n$$[P] = 8 \\cdot 20 \\ \\mathrm{nM} = 160 \\ \\mathrm{nM}$$\n结果是一个整数，因此四舍五入到三位有效数字得到 $160$。这相当于 $1.60 \\times 10^2$。", "answer": "$$\n\\boxed{160}\n$$", "id": "4584191"}, {"introduction": "许多药物效应并非瞬时发生，而是随着对生理通路的调节而随时间演变。最后的这个实践将超越简单的平衡假设，探索间接效应模型。通过对效应介质产生的抑制过程进行建模，您将学习预测药物作用的时间依赖性，包括达到新稳态所需的时间，这对于临床给药方案的设计至关重要。[@problem_id:4584200]", "problem": "考虑一个药效学（PD）间接响应模型，在该模型中，药物抑制响应介质的零级生成。介质的量用 $R(t)$ 表示，零级生成速率常数为 $k_{\\text{in}}$，一级消除速率常数为 $k_{\\text{out}}$。在给药前，系统处于基线水平，因此 $R(0^{-})$ 等于无药物时的稳态。在时间 $t=0$ 时，建立并维持恒定的药物浓度 $C$。药物对生成过程的影响遵循最大抑制效应模型，其抑制函数为 $I(C)$，该函数依赖于最大抑制效应 $I_{\\max}$ 和产生半数最大抑制时的浓度 $IC_{50}$。\n\n从输入抑制的间接响应和响应介质质量平衡的基本定义出发，推导在恒定浓度 $C$ 下 $t \\ge 0$ 时的时间进程 $R(t)$，并用它计算以下两个量：\n- 在恒定浓度 $C$ 下，介质达到其相对于基线的总渐近变化的 $95\\%$ 所需的时间（将其定义为操作上的“达到稳态的时间”）。以小时为单位表示该时间。\n- 在恒定浓度 $C$ 下，稳态时 $R$ 相对于基线的分数抑制（以小数形式表示，而不是百分比）。\n\n使用以下参数值：$k_{\\text{in}} = 50$ units$\\cdot$h$^{-1}$，$k_{\\text{out}} = 0.2$ h$^{-1}$，$I_{\\max} = 0.9$，$IC_{50} = 2$ mg$\\cdot$L$^{-1}$ 以及 $C = 4$ mg$\\cdot$L$^{-1}$。将最终数值结果四舍五入至四位有效数字。在最终答案中，按以下顺序将两个值作为单个 $1 \\times 2$ 的行向量报告：时间（小时）、分数抑制。最终答案框中不要包含单位。", "solution": "本题要求推导并分析一个药效学（PD）间接响应模型，其中药物抑制响应介质的生成。\n\n首先，我们建立控制响应介质量 $R(t)$ 的常微分方程（ODE）。$R(t)$ 的变化率，记为 $\\frac{dR}{dt}$，是生成速率（输入）与消除速率（输出）之差。\n\n生成速率是一个零级过程，其速率常数为 $k_{\\text{in}}$。该生成过程被一个恒定浓度为 $C$ 的药物所抑制。抑制效应由最大抑制效应（$I_{\\max}$）模型描述，其中分数抑制由函数 $I(C)$ 给出：\n$$I(C) = \\frac{I_{\\max} \\cdot C}{IC_{50} + C}$$\n因此，被抑制的生成速率为 $k_{\\text{in}} \\cdot (1 - I(C))$。\n\n消除速率是一个一级过程，其速率常数为 $k_{\\text{out}}$。该速率与当前介质的量成正比，因此消除速率为 $k_{\\text{out}} \\cdot R(t)$。\n\n综合以上两点，质量平衡常微分方程为：\n$$\\frac{dR(t)}{dt} = k_{\\text{in}} \\cdot (1 - I(C)) - k_{\\text{out}} \\cdot R(t)$$\n\n接下来，我们确定初始条件 $R(0)$。题目指出，在给药前（$t  0$），系统处于无药物的稳态（基线）。在此状态下，$C=0$，因此 $I(C) = I(0) = 0$。在稳态时，$\\frac{dR}{dt} = 0$。设基线响应为 $R_{base}$。常微分方程变为：\n$$0 = k_{\\text{in}} \\cdot (1 - 0) - k_{\\text{out}} \\cdot R_{base}$$\n解出 $R_{base}$ 得：\n$$R_{base} = \\frac{k_{\\text{in}}}{k_{\\text{out}}}$$\n由于介质的量 $R$ 不能瞬时改变，因此在 $t=0$ 时的初始条件为 $R(0) = R_{base}$。\n\n现在我们求解在恒定药物浓度 $C$ 下 $t \\ge 0$ 时的常微分方程。该常微分方程可以重排为一阶线性常微分方程的标准形式：\n$$\\frac{dR(t)}{dt} + k_{\\text{out}} \\cdot R(t) = k_{\\text{in}} \\cdot (1 - I(C))$$\n对于给定的 $C$，方程右侧为常数。这类方程的通解是特解与齐次解之和。\n特解是药物影响下的新稳态，我们将其记为 $R_{ss,C}$。在这个新稳态下，$\\frac{dR}{dt} = 0$：\n$$0 = k_{\\text{in}} \\cdot (1 - I(C)) - k_{\\text{out}} \\cdot R_{ss,C}$$\n解出 $R_{ss,C}$ 得：\n$$R_{ss,C} = \\frac{k_{\\text{in}} \\cdot (1 - I(C))}{k_{\\text{out}}} = R_{base} \\cdot (1 - I(C))$$\n齐次方程为 $\\frac{dR}{dt} + k_{\\text{out}} \\cdot R(t) = 0$，其解为 $A\\exp(-k_{\\text{out}}t)$，其中 $A$ 为某个常数。\n因此，完整解为：\n$$R(t) = R_{ss,C} + A \\exp(-k_{\\text{out}}t)$$\n我们使用初始条件 $R(0) = R_{base}$ 来求常数 $A$：\n$$R(0) = R_{ss,C} + A \\exp(0) = R_{ss,C} + A$$\n$$A = R(0) - R_{ss,C} = R_{base} - R_{ss,C}$$\n将 $A$ 代回通解，得到响应介质的显式时间进程：\n$$R(t) = R_{ss,C} + (R_{base} - R_{ss,C}) \\exp(-k_{\\text{out}}t)$$\n\n现在我们可以使用给定的参数值计算所要求的两个量：$k_{\\text{in}} = 50$ units$\\cdot$h$^{-1}$，$k_{\\text{out}} = 0.2$ h$^{-1}$，$I_{\\max} = 0.9$，$IC_{50} = 2$ mg$\\cdot$L$^{-1}$ 以及 $C = 4$ mg$\\cdot$L$^{-1}$。\n\n首先，我们计算必要的中间值：\n$$R_{base} = \\frac{k_{\\text{in}}}{k_{\\text{out}}} = \\frac{50}{0.2} = 250 \\text{ units}$$\n$$I(C) = \\frac{I_{\\max} \\cdot C}{IC_{50} + C} = \\frac{0.9 \\cdot 4}{2 + 4} = \\frac{3.6}{6} = 0.6$$\n$$R_{ss,C} = R_{base} \\cdot (1 - I(C)) = 250 \\cdot (1 - 0.6) = 250 \\cdot 0.4 = 100 \\text{ units}$$\n\n第一个量是介质达到其总渐近变化的 $95\\%$ 所需的时间。总变化是从 $R_{base}$ 到 $R_{ss,C}$。在时间 $t$ 时的变化是 $R(t) - R_{base}$。总渐近变化是 $R_{ss,C} - R_{base}$。我们寻求时间 $t_{95\\%}$ 使得：\n$$R(t_{95\\%}) - R_{base} = 0.95 \\cdot (R_{ss,C} - R_{base})$$\n根据我们对 $R(t)$ 的解，可以写出：\n$$R(t) - R_{base} = (R_{ss,C} - R_{base}) - (R_{ss,C} - R_{base})\\exp(-k_{\\text{out}}t) = (R_{ss,C} - R_{base})(1 - \\exp(-k_{\\text{out}}t))$$\n令 $t_{95\\%}$ 时变化的两个表达式相等：\n$$(R_{ss,C} - R_{base})(1 - \\exp(-k_{\\text{out}}t_{95\\%})) = 0.95 \\cdot (R_{ss,C} - R_{base})$$\n假设 $R_{ss,C} \\neq R_{base}$，我们可以除以该项：\n$$1 - \\exp(-k_{\\text{out}}t_{95\\%}) = 0.95$$\n$$\\exp(-k_{\\text{out}}t_{95\\%}) = 0.05$$\n对两边取自然对数：\n$$-k_{\\text{out}}t_{95\\%} = \\ln(0.05)$$\n$$t_{95\\%} = -\\frac{\\ln(0.05)}{k_{\\text{out}}}$$\n代入 $k_{\\text{out}}$ 的值：\n$$t_{95\\%} = -\\frac{\\ln(0.05)}{0.2} = \\frac{\\ln(20)}{0.2} \\approx \\frac{2.99573227}{0.2} \\approx 14.978661 \\text{ h}$$\n四舍五入到四位有效数字，时间为 $14.98$ 小时。\n\n第二个量是稳态时 $R$ 相对于基线的分数抑制。这被定义为 $R$ 从基线的减少量除以基线值。\n$$\\text{Fractional Suppression} = \\frac{R_{base} - R_{ss,C}}{R_{base}} = 1 - \\frac{R_{ss,C}}{R_{base}}$$\n使用我们对 $R_{base}$ 和 $R_{ss,C}$ 的表达式：\n$$\\text{Fractional Suppression} = 1 - \\frac{R_{base} \\cdot (1 - I(C))}{R_{base}} = 1 - (1 - I(C)) = I(C)$$\n因此，稳态时的分数抑制就等于生成速率的分数抑制，即 $I(C)$。\n使用我们之前计算的 $I(C)$ 值：\n$$\\text{Fractional Suppression} = 0.6$$\n以表示为四位有效数字的小数形式，该值为 $0.6000$。\n\n最终的两个值是达到 $95\\%$ 稳态效应的时间，$14.98$ 小时，以及稳态时的分数抑制，$0.6000$。", "answer": "$$\\boxed{\\begin{pmatrix} 14.98  0.6000 \\end{pmatrix}}$$", "id": "4584200"}]}