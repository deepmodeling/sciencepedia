{"hands_on_practices": [{"introduction": "掌握消除半衰期的第一步是理解其最基本的形式。本练习从一级消除动力学的第一性原理出发，推导单室模型中半衰期、清除率（$CL$）和分布容积（$V_d$）之间的基本关系。通过这个实践，你将不仅仅是计算一个数值，更是要深入理解半衰期如何决定给药间隔，从而为制定合理的临床给药方案奠定理论基础。[@problem_id:4552116]", "problem": "将一种新型小分子药物的单次静脉（IV）推注剂量给予一名健康的成年志愿者。假设采用单室模型，该模型具有线性、时不变的药代动力学特征，药物在分布容积中瞬时分布，并由清除率驱动一级消除。该药物的分布容积（$V_{d}$）测得为 $200\\ \\text{L}$，其全身清除率（$CL$）测得为 $10\\ \\text{L/h}$。从质量平衡和第一性原理出发，描述一级消除条件下体内药物量随时间变化的规律，推导出药物量（及浓度）降至其初始值一半所需时间的表达式，然后使用所提供的参数计算其数值。将您的答案四舍五入至四位有效数字。最终答案以小时为单位表示。最后，简要解释计算出的半衰期在多次给药达到稳态时对选择合理给药间隔的临床意义，明确说明半衰期与峰谷波动和蓄积的关系，且不使用问题陈述中给出的任何快捷公式。", "solution": "该问题是有效的，因为它在科学上基于标准的药代动力学原理，问题阐述清晰，数据充分且一致，并以客观、明确的语言表达。我们将按要求分三部分进行解答：从第一性原理推导半衰期表达式，计算其数值，并解释其对给药方案的临床意义。\n\n**第1部分：消除半衰期（$t_{1/2}$）的推导**\n\n我们从单室模型中药物在单次静脉（IV）推注给药后的质量平衡原理开始。体内药物量的变化速率（我们表示为 $A(t)$）等于药物的给药速率减去药物的消除速率。\n\n对于静脉推注剂量，全部剂量在时间 $t=0$ 时给药。对于任何时间 $t > 0$，给药速率为零。问题陈述消除是由全身清除率 $CL$ 驱动的一级过程。因此，消除速率是清除率与血浆药物浓度 $C(t)$ 的乘积。\n质量平衡关系因此表示为以下微分方程：\n$$\n\\frac{dA(t)}{dt} = -CL \\cdot C(t)\n$$\n分布容积 $V_d$ 定义为关联体内药物量与其血浆浓度的比例常数：\n$$\nC(t) = \\frac{A(t)}{V_d}\n$$\n将 $C(t)$ 的表达式代入质量平衡方程，我们可以用 $A(t)$ 单独表示 $A(t)$ 的变化速率：\n$$\n\\frac{dA(t)}{dt} = -CL \\cdot \\frac{A(t)}{V_d}\n$$\n我们可以将一级消除速率常数 $k_e$ 定义为清除率与分布容积之比：\n$$\nk_e = \\frac{CL}{V_d}\n$$\n微分方程随后简化为一级衰减的标准形式：\n$$\n\\frac{dA(t)}{dt} = -k_e \\cdot A(t)\n$$\n这是一个一阶、线性、齐次常微分方程，可以用分离变量法求解。假设 $t=0$ 时体内的初始药物量为 $A_0$：\n$$\n\\int_{A_0}^{A(t)} \\frac{dA'}{A'} = \\int_0^t -k_e \\, dt'\n$$\n对两边进行积分可得：\n$$\n[\\ln(A')]_{A_0}^{A(t)} = [-k_e t']_0^t\n$$\n$$\n\\ln(A(t)) - \\ln(A_0) = -k_e t\n$$\n$$\n\\ln\\left(\\frac{A(t)}{A_0}\\right) = -k_e t\n$$\n对两边取指数，得到体内药物量随时间变化的函数解：\n$$\nA(t) = A_0 \\exp(-k_e t)\n$$\n由于 $C(t) = A(t)/V_d$ 且初始浓度为 $C_0 = A_0/V_d$，因此浓度遵循相同的指数衰减规律：\n$$\nC(t) = C_0 \\exp(-k_e t)\n$$\n消除半衰期 $t_{1/2}$ 定义为药物量（或浓度）降至其初始值一半所需的时间。我们设 $A(t_{1/2}) = \\frac{1}{2} A_0$：\n$$\n\\frac{1}{2} A_0 = A_0 \\exp(-k_e t_{1/2})\n$$\n两边除以 $A_0$（非零），我们得到：\n$$\n\\frac{1}{2} = \\exp(-k_e t_{1/2})\n$$\n为了求解 $t_{1/2}$，我们对两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = \\ln\\left(\\exp(-k_e t_{1/2})\\right)\n$$\n$$\n-\\ln(2) = -k_e t_{1/2}\n$$\n这就得出了用消除速率常数表示的半衰期表达式：\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_e}\n$$\n最后，将 $k_e = \\frac{CL}{V_d}$ 的定义代入此表达式，我们得到了半衰期、分布容积和清除率之间的期望关系：\n$$\nt_{1/2} = \\frac{\\ln(2) \\cdot V_d}{CL}\n$$\n至此，从第一性原理的推导完成。\n\n**第2部分：数值计算**\n\n我们已知以下参数值：\n- 分布容积, $V_d = 200\\ \\text{L}$\n- 全身清除率, $CL = 10\\ \\text{L/h}$\n\n我们将这些值代入推导出的 $t_{1/2}$ 表达式中：\n$$\nt_{1/2} = \\frac{\\ln(2) \\cdot (200\\ \\text{L})}{10\\ \\text{L/h}}\n$$\n$$\nt_{1/2} = \\ln(2) \\cdot 20\\ \\text{h}\n$$\n使用 $\\ln(2) \\approx 0.693147...$ 的值，我们计算其数值：\n$$\nt_{1/2} \\approx 0.693147 \\times 20\\ \\text{h} \\approx 13.86294\\ \\text{h}\n$$\n按照要求，将结果四舍五入至四位有效数字，我们得到：\n$$\nt_{1/2} = 13.86\\ \\text{h}\n$$\n\n**第3部分：临床解释**\n\n$13.86\\ \\text{h}$ 的消除半衰期是设计多次给药方案的关键参数。它的值决定了达到稳态浓度所需的时间以及两次给药之间药物水平的波动幅度。\n\n首先，稳态，即在一个给药间隔内药物给药速率等于消除速率的状态，通常在约 $4$ 到 $5$ 个半衰期后达到。对于这种药物，这将是 $4 \\times 13.86\\ \\text{h} \\approx 55.4\\ \\text{h}$ 到 $5 \\times 13.86\\ \\text{h} \\approx 69.3\\ \\text{h}$。这告知临床医生药物需要多长时间才能展现其稳定、长期的治疗效果。\n\n其次，半衰期与稳态时的药物蓄积和峰谷波动有根本性的联系。合理的给药间隔 $\\tau$ 是根据半衰期和药物的治疗窗来选择的。\n- **蓄积：** 当药物以间隔 $\\tau$ 重复给药时，它会在体内蓄积，直到达到稳态。当给药间隔 $\\tau$相对于半衰期 $t_{1/2}$ 较短时，蓄积程度更大。\n- **波动：** 半衰期决定了在一个给药间隔内药物浓度的下降程度。如果给药间隔设定为等于半衰期（$\\tau = t_{1/2} \\approx 13.86\\ \\text{h}$），血浆浓度将在峰值（刚给药后）和谷值（下次给药前）之间恰好下降 $50\\%$。这对应于 $2:1$ 的峰谷比。\n\n对于半衰期为 $13.86\\ \\text{h}$ 的药物：\n- **每日两次**的给药方案（$\\tau = 12\\ \\text{h}$）是一个合乎逻辑的选择。由于 $\\tau < t_{1/2}$，两次给药之间药物浓度的下降将少于 $50\\%$。给药间隔末端的浓度与起始浓度的比值为 $\\exp(-k_e \\tau) = \\exp(-(\\ln(2)/t_{1/2})\\tau) = \\exp(-(\\ln(2)/13.86) \\cdot 12) \\approx 0.549$。这意味着谷浓度约为峰浓度的 $55\\%$，导致中等程度的波动，这通常对于将药物水平维持在治疗窗内是理想的。\n- 为了患者方便，也可以考虑**每日一次**的方案（$\\tau = 24\\ \\text{h}$）。然而，由于 $\\tau > t_{1/2}$，波动将显著增大。谷浓度将降至峰浓度的约 $30\\%$（$\\exp(-(\\ln(2)/13.86) \\cdot 24) \\approx 0.301$）。对于治疗指数窄的药物，如此大的波动可能会有问题，因为谷浓度可能低于最小有效浓度，而峰浓度可能接近毒性水平。\n\n总之，计算出的 $13.86\\ \\text{h}$ 的半衰期表明，为了通过最小化峰谷波动来平衡疗效和安全性，可能首选每日两次的给药方案，而每日一次的方案可能只有在药物具有非常宽的治疗范围时才可接受。", "answer": "$$\\boxed{13.86}$$", "id": "4552116"}, {"introduction": "在临床实践中，我们观察到的表观半衰期并不总等于药物固有的消除半衰期。本练习引入了一个重要的药代动力学现象——“翻转动力学”（flip-flop kinetics），这种情况在缓释或控释制剂中尤为常见。通过对比同一药物在静脉注射和口服给药后的血药浓度数据，你将学会如何区分真正的消除半衰期与由吸收速率限制的表观半衰期，这对于正确解读药代动力学参数和评估药物制剂至关重要。[@problem_id:4552277]", "problem": "一名成年志愿者接受了$100$毫克药物的静脉（IV）推注剂量，该药物遵循一级消除的单室分布。在终末相测得的血浆浓度如下：$2$小时为$14.0$毫克/升；$6$小时为$7.07$毫克/升；$10$小时为$3.50$毫克/升。在另一次实验中，同一名志愿者接受了$100$毫克控释制剂的单次口服剂量，该制剂导致药物以延长的一级吸收方式进入相同的单室系统，并进行一级消除。口服给药后，观察到血浆浓度的终末对数线性下降（远超过峰值浓度后），得到以下浓度：$24$小时为$1.20$毫克/升；$48$小时为$0.300$毫克/升。\n\n请仅根据一级消除和吸收的定义，以及半衰期是浓度降至其先前值一半所需时间的定义，完成以下任务：从静脉注射数据中推断消除半衰期，从这种翻转现象案例的口服数据中推断表观终末半衰期，并对它们进行定量比较。作为您的最终数值答案，请报告比率$\\dfrac{t_{1/2,\\text{oral,app}}}{t_{1/2,\\text{IV}}}$。将您的答案四舍五入至四位有效数字。将此比率报告为无单位的无量纲数。", "solution": "该问题被认为是有效的，因为它科学地基于药代动力学的既定原理，提法得当，数据充分且内部一致，并使用客观、明确的语言进行表述。\n\n分析从一级动力学的基本定义开始，一级动力学描述了物质浓度$C$的变化率与浓度本身成正比的过程。这由以下微分方程表示：\n$$\n\\frac{dC}{dt} = -kC\n$$\n其中$k$是一级速率常数。将此方程对时间从初始时间$t_1$到最终时间$t_2$进行积分，得到相应浓度$C_1$和$C_2$之间的关系：\n$$\n\\ln(C_2) - \\ln(C_1) = -k(t_2 - t_1)\n$$\n该方程可以重新整理以求解速率常数$k$：\n$$\nk = \\frac{\\ln(C_1) - \\ln(C_2)}{t_2 - t_1} = \\frac{\\ln\\left(\\frac{C_1}{C_2}\\right)}{t_2 - t_1}\n$$\n半衰期$t_{1/2}$定义为浓度降低到其值一半所需的时间。通过将$C_2 = \\frac{C_1}{2}$和$t_2 - t_1 = t_{1/2}$代入整理后的方程，我们推导出半衰期和速率常数之间的关系：\n$$\nk = \\frac{\\ln\\left(\\frac{C_1}{C_1/2}\\right)}{t_{1/2}} = \\frac{\\ln(2)}{t_{1/2}}\n$$\n因此，半衰期可以计算为：\n$$\nt_{1/2} = \\frac{\\ln(2)}{k}\n$$\n\n首先，我们根据静脉（IV）推注$100$毫克剂量后的数据确定消除半衰期，记为$t_{1/2,\\text{IV}}$。在这种情况下，终末相血浆浓度的下降完全由消除过程决定。由此数据得出的速率常数是一级消除速率常数$k_e$。使用指定时间区间的起始和结束血浆浓度数据点可确保最稳健的估计。\n设$t_1 = 2$小时，此时浓度为$C_1 = 14.0$毫克/升。\n设$t_2 = 10$小时，此时浓度为$C_2 = 3.50$毫克/升。\n\n消除速率常数$k_e$计算如下：\n$$\nk_e = \\frac{\\ln\\left(\\frac{14.0}{3.50}\\right)}{10 \\text{ h} - 2 \\text{ h}} = \\frac{\\ln(4.00)}{8 \\text{ h}}\n$$\n注意到$\\ln(4.00) = \\ln(2^2) = 2\\ln(2)$，表达式简化为：\n$$\nk_e = \\frac{2\\ln(2)}{8 \\text{ h}} = \\frac{\\ln(2)}{4} \\text{ h}^{-1}\n$$\n因此，消除半衰期为：\n$$\nt_{1/2,\\text{IV}} = \\frac{\\ln(2)}{k_e} = \\frac{\\ln(2)}{\\frac{\\ln(2)}{4} \\text{ h}^{-1}} = 4.00 \\text{ h}\n$$\n\n接下来，我们根据单次口服$100$毫克剂量后的数据确定表观终末半衰期$t_{1/2,\\text{oral,app}}$。对于表现出一级吸收（速率常数$k_a$）和一级消除（速率常数$k_e$）的药物，浓度下降的终末相由两个过程中较慢的一个决定。此终末相斜率的速率常数记为$\\lambda_z$，其中$\\lambda_z = \\min(k_a, k_e)$。问题指出这是一个“翻转现象”案例，这是吸收是限速步骤（即$k_a \\ll k_e$）时的标准术语。在这种情况下，观察到的终末相反映了吸收过程，因此$\\lambda_z = k_a$。我们从口服数据中计算这个表观速率常数$\\lambda_z$：\n设$t_1 = 24$小时，此时浓度为$C_1 = 1.20$毫克/升。\n设$t_2 = 48$小时，此时浓度为$C_2 = 0.300$毫克/升。\n\n表观终末速率常数$\\lambda_z$为：\n$$\n\\lambda_z = \\frac{\\ln\\left(\\frac{1.20}{0.300}\\right)}{48 \\text{ h} - 24 \\text{ h}} = \\frac{\\ln(4.00)}{24 \\text{ h}} = \\frac{2\\ln(2)}{24 \\text{ h}} = \\frac{\\ln(2)}{12} \\text{ h}^{-1}\n$$\n表观终末半衰期由$\\lambda_z$计算得出：\n$$\nt_{1/2,\\text{oral,app}} = \\frac{\\ln(2)}{\\lambda_z} = \\frac{\\ln(2)}{\\frac{\\ln(2)}{12} \\text{ h}^{-1}} = 12.0 \\text{ h}\n$$\n这一结果与翻转动力学的前提一致，因为真实消除半衰期（$4.00$小时）显著短于表观终末半衰期（$12.0$小时），后者由控释制剂的延长吸收所控制。\n\n最后，我们计算表观口服半衰期与静脉注射消除半衰期的定量比率：\n$$\n\\text{Ratio} = \\frac{t_{1/2,\\text{oral,app}}}{t_{1/2,\\text{IV}}} = \\frac{12.0 \\text{ h}}{4.00 \\text{ h}} = 3.00\n$$\n问题指明最终答案应四舍五入至四位有效数字。因此，无量纲比率为$3.000$。", "answer": "$$\n\\boxed{3.000}\n$$", "id": "4552277"}, {"introduction": "对于在重症监护或麻醉中持续输注的药物，单一的消除半衰期概念往往不足以预测停药后血药浓度的下降速度。本练习将引导你探索一个更为高级和动态的概念：“情境依赖性半时”（context-sensitive half-time）。你将通过编程实践，为多室模型药物计算在不同输注时长（即“背景”）后，血药浓度下降一半所需的时间，从而深刻理解为何停药后的效应消除时间会依赖于给药的持续时间。[@problem_id:4552117]", "problem": "考虑一个用于静脉输注药物的线性二室药代动力学系统，该系统包含一个中央室和一个外周室。中央室中的药量为 $A_1(t)$，容积为 $V_1$（单位为升），外周室中的药量为 $A_2(t)$。药物以恒定速率 $R$（单位为毫克/小时）输注，持续整整 $4$ 小时后停止。该系统由以下微观速率常数表征：$k_{10}$（从中央室消除，单位为 $\\text{hour}^{-1}$）、$k_{12}$（从中央室转运至外周室，单位为 $\\text{hour}^{-1}$）和 $k_{21}$（从外周室转运至中央室，单位为 $\\text{hour}^{-1}$）。在 $t = 4$ 小时输注停止后，系统在没有进一步输入的情况下继续演变。\n\n基本原理：\n- 系统动力学由线性质量平衡常微分方程（ODE）控制：药物通过输注进入中央室，通过消除排出体外，并根据微观速率常数在房室之间交换。\n- 该系统是线性时不变的，适用叠加原理。中央室的浓度为 $C_1(t) = A_1(t)/V_1$。\n\n计算定义：\n- 此处的情境依赖性半时定义为：从输注停止后（即，相对于停止时刻 $t \\ge 0$）开始测量的时间 $\\tau$（单位为小时），使得中央室浓度等于输注结束时浓度的一半。用符号表示，如果 $C_{\\text{end}}$ 表示 $t=4$ 小时时的中央室浓度，$C_{\\text{post}}(t)$ 表示停止后 $t$ 时刻的中央室浓度，则情境依赖性半时 $\\tau$ 满足 $C_{\\text{post}}(\\tau) = \\tfrac{1}{2} C_{\\text{end}}$。\n\n你的任务：\n- 编写一个程序，对于下面测试套件中的每一组参数，使用由质量平衡常微分方程所蕴含的精确二室动力学模型，计算 $4$ 小时输注后的情境依赖性半时 $\\tau$（单位为小时）。\n- 计算必须从所述的基本原理出发，并且不得假定任何不能从这些原理推导出的快捷公式。\n- 你必须通过使用数学上可靠的数值方法，求解模型所蕴含的相应方程来获得 $\\tau$。\n\n要求的单位和输出舍入：\n- 将每个计算出的情境依赖性半时 $\\tau$ 以小时为单位表示，并四舍五入到四位小数的浮点数。\n\n测试套件：\n- 使用以下参数集，每组参数以 $(k_{10}, k_{12}, k_{21}, V_1, R)$ 的形式给出，单位如上所述，输注持续时间固定为 $4$ 小时：\n    1. $(0.2, 0.5, 0.3, 10.0, 50.0)$\n    2. $(0.25, 0.001, 0.001, 20.0, 100.0)$\n    3. $(0.15, 0.7, 0.07, 15.0, 80.0)$\n    4. $(1.2, 1.5, 1.0, 12.0, 30.0)$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序与测试套件的顺序相同。例如，输出行必须类似于 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是以小时为单位、四舍五入到四位小数的计算浮点数。", "solution": "我们从描述一个二室药代动力学模型的线性质量平衡常微分方程（ODE）开始。该模型中，药物以恒定速率输注至中央室，并在 $t = 4$ 小时停止。设 $A_1(t)$ 表示中央室中的药量，$A_2(t)$ 表示外周室中的药量。微观速率常数分别为 $k_{10}$（从中央室向外消除）、$k_{12}$（从中央室至外周室）和 $k_{21}$（从外周室至中央室），单位均为 $\\text{hour}^{-1}$。当输注以速率 $R$（单位为毫克/小时）进行时，中央室接收输入 $R$。控制药量的常微分方程为\n$$\n\\frac{dA_1}{dt} = -\\left(k_{10} + k_{12}\\right) A_1(t) + k_{21} A_2(t) + R \\cdot u(t),\n$$\n$$\n\\frac{dA_2}{dt} = k_{12} A_1(t) - k_{21} A_2(t),\n$$\n其中 $u(t)$ 表示单位阶跃函数，代表输注在 $0 \\le t \\le 4$ 小时期间开启，此后关闭。中央室浓度为 $C_1(t) = \\frac{A_1(t)}{V_1}$，其中 $V_1$ 是中央室容积，单位为升。\n\n由于该系统是线性时不变（LTI）的，我们可以分析其对中央室单位推注的脉冲响应，然后使用卷积来处理恒定速率输注。考虑在 $t=0$ 时向中央室给予一单位推注剂量，初始条件为 $A_1(0) = 1$ 毫克和 $A_2(0) = 0$。求解齐次系统可得出中央室药量的双指数动力学行为，\n$$\nA_1^{\\text{bolus}}(t) = \\left(\\frac{\\alpha - k_{21}}{\\alpha - \\beta}\\right) e^{-\\alpha t} + \\left(\\frac{k_{21} - \\beta}{\\alpha - \\beta}\\right) e^{-\\beta t},\n$$\n其中 $\\alpha$ 和 $\\beta$ 是由系统矩阵的特征值产生的正宏观速率常数（单位为 $\\text{hour}^{-1}$）。这些宏观速率常数遵循由线性ODE系统矩阵构成的特征方程。设 $s$ 表示一个正衰减率；写出关于 $s$ 的特征多项式可得\n$$\ns^2 - s\\left(k_{10} + k_{12} + k_{21}\\right) + k_{10} k_{21} = 0.\n$$\n两个正根为\n$$\n\\alpha = \\frac{ \\left(k_{10} + k_{12} + k_{21}\\right) + \\sqrt{ \\left(k_{10} + k_{12} + k_{21}\\right)^2 - 4 k_{10} k_{21} } }{2}, \\quad\n\\beta  = \\frac{ \\left(k_{10} + k_{12} + k_{21}\\right) - \\sqrt{ \\left(k_{10} + k_{12} + k_{21}\\right)^2 - 4 k_{10} k_{21} } }{2}.\n$$\n对于生理学上合理的微观速率常数（$k_{10} > 0$, $k_{12} > 0$, $k_{21} > 0$），$\\alpha$ 和 $\\beta$ 均为严格正值。单位推注后中央室的浓度为\n$$\nh(t) = \\frac{A_1^{\\text{bolus}}(t)}{V_1}\n= \\frac{1}{V_1} \\left[\\left(\\frac{\\alpha - k_{21}}{\\alpha - \\beta}\\right) e^{-\\alpha t} + \\left(\\frac{k_{21} - \\beta}{\\alpha - \\beta}\\right) e^{-\\beta t}\\right].\n$$\n此处 $h(t)$ 是脉冲响应，单位为每毫克剂量的浓度单位。对于从 $t = 0$ 到 $t = T$ 以速率 $R$（单位为毫克/小时）进行的恒定输注，输注结束时的中央室浓度是卷积积分\n$$\nC_{\\text{end}} = C_1(T) = R \\int_0^T h(u)\\, du.\n$$\n输注停止后，在停止后 $t \\ge 0$ 时刻的浓度为\n$$\nC_{\\text{post}}(t) = R \\int_0^T h(t+u)\\, du.\n$$\n根据线性性质，比率\n$$\n\\frac{C_{\\text{post}}(t)}{C_{\\text{end}}} = \\frac{\\int_0^T h(t+u)\\, du}{\\int_0^T h(u)\\, du}\n$$\n与 $R$ 和 $V_1$ 均无关，因为 $h(\\cdot)$ 与 $1/V_1$ 成线性比例，而 $C_{\\text{end}}$ 和 $C_{\\text{post}}(t)$ 带有相同的乘法因子。因此，情境依赖性半时仅取决于微观速率常数和输注持续时间 $T$。\n\n将双指数脉冲响应代入积分并求值可得\n$$\n\\int_0^T h(u)\\,du = \\frac{1}{V_1}\\left[ \\left(\\frac{\\alpha - k_{21}}{\\alpha - \\beta}\\right) \\frac{1 - e^{-\\alpha T}}{\\alpha} + \\left(\\frac{k_{21} - \\beta}{\\alpha - \\beta}\\right) \\frac{1 - e^{-\\beta T}}{\\beta} \\right],\n$$\n$$\n\\int_0^T h(t+u)\\,du = \\frac{1}{V_1}\\left[ \\left(\\frac{\\alpha - k_{21}}{\\alpha - \\beta}\\right) \\frac{e^{-\\alpha t}\\left(1 - e^{-\\alpha T}\\right)}{\\alpha} + \\left(\\frac{k_{21} - \\beta}{\\alpha - \\beta}\\right) \\frac{e^{-\\beta t}\\left(1 - e^{-\\beta T}\\right)}{\\beta} \\right].\n$$\n构建归一化权重\n$$\nW_\\alpha = \\left(\\frac{\\alpha - k_{21}}{\\alpha - \\beta}\\right) \\frac{1 - e^{-\\alpha T}}{\\alpha}, \\quad\nW_\\beta  = \\left(\\frac{k_{21} - \\beta}{\\alpha - \\beta}\\right) \\frac{1 - e^{-\\beta T}}{\\beta},\n$$\n且 $W = W_\\alpha + W_\\beta$。该比率简化为\n$$\n\\frac{C_{\\text{post}}(t)}{C_{\\text{end}}} = \\frac{ W_\\alpha e^{-\\alpha t} + W_\\beta e^{-\\beta t} }{ W } = w_\\alpha e^{-\\alpha t} + w_\\beta e^{-\\beta t},\n$$\n其中 $w_\\alpha = W_\\alpha/W$ 且 $w_\\beta = W_\\beta/W$，并且 $w_\\alpha + w_\\beta = 1$。情境依赖性半时 $\\tau$ 是以下方程的唯一解\n$$\nw_\\alpha e^{-\\alpha \\tau} + w_\\beta e^{-\\beta \\tau} = \\tfrac{1}{2}.\n$$\n方程左侧是 $\\tau$ 在 $[0,\\infty)$ 上的严格递减连续函数，在 $\\tau = 0$ 时取值为 $1$，当 $\\tau \\to \\infty$ 时趋近于 $0$。因此，根据介值定理，存在一个唯一的 $\\tau > 0$ 满足该方程，可以通过稳健的一维求根方法（例如，二分法或 Brent 方法）找到。\n\n对于每个测试用例 $(k_{10}, k_{12}, k_{21}, V_1, R)$ 及 $T = 4$ 的算法步骤：\n1. 计算 $s^2 - s\\left(k_{10} + k_{12} + k_{21}\\right) + k_{10} k_{21} = 0$ 的正根 $\\alpha$ 和 $\\beta$，通过将任何微小的负判别式视为零来确保数值稳定性。\n2. 计算 $W_\\alpha$ 和 $W_\\beta$，然后计算 $w_\\alpha = \\frac{W_\\alpha}{W_\\alpha + W_\\beta}$ 和 $w_\\beta = \\frac{W_\\beta}{W_\\alpha + W_\\beta}$。\n3. 定义 $f(t) = w_\\alpha e^{-\\alpha t} + w_\\beta e^{-\\beta t} - \\tfrac{1}{2}$，并使用区间法（例如，根据 $\\max\\{\\ln(2)/\\alpha,\\ \\ln(2)/\\beta\\}$ 选择一个上界）找到 $t \\ge 0$ 时 $f(t) = 0$ 的唯一根 $\\tau$。\n4. 以小时为单位报告 $\\tau$，并四舍五入到四位小数。\n\n请注意，$V_1$ 和 $R$ 不会改变 $\\tau$，因为定义情境依赖性半时的比率通过以 $C_{\\text{end}}$ 进行归一化消除了尺度因子。尽管如此，将它们包含在参数集中是为了保持输注场景的物理完整性。程序实现了上述步骤，并为指定的测试套件以要求的格式输出了 $\\tau$值的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef compute_macro_rates(k10, k12, k21):\n    \"\"\"\n    Compute the macro-rate constants alpha and beta from microconstants\n    using the characteristic equation:\n        s^2 - s*(k10 + k12 + k21) + k10*k21 = 0\n    Returns (alpha, beta) with alpha >= beta > 0.\n    \"\"\"\n    S = k10 + k12 + k21\n    disc = S * S - 4.0 * k10 * k21\n    # Numerical guard: if tiny negative due to rounding, clamp to zero.\n    if disc < 0 and abs(disc) < 1e-14:\n        disc = 0.0\n    if disc < 0:\n        # Physically implausible; fallback to non-negative discriminant\n        disc = 0.0\n    sqrt_disc = np.sqrt(disc)\n    alpha = 0.5 * (S + sqrt_disc)\n    beta = 0.5 * (S - sqrt_disc)\n    # Ensure ordering alpha >= beta\n    if beta > alpha:\n        alpha, beta = beta, alpha\n    # Guard against non-positive results (should not occur for positive microconstants)\n    if alpha <= 0 or beta <= 0:\n        raise ValueError(\"Computed non-positive macro rate constants.\")\n    return alpha, beta\n\ndef context_sensitive_half_life(k10, k12, k21, V1, R, T=4.0):\n    \"\"\"\n    Compute the context-sensitive half-life (in hours) after a T-hour infusion\n    for a two-compartment model characterized by microconstants k10, k12, k21.\n    V1 and R are included for completeness but cancel from the ratio.\n    \"\"\"\n    alpha, beta = compute_macro_rates(k10, k12, k21)\n\n    # Coefficients for unit bolus central amount (per mg dose), scaling by 1/V1 would cancel in ratio\n    # A_bar and B_bar represent the amount coefficients without 1/V1.\n    A_bar = (alpha - k21) / (alpha - beta)\n    B_bar = (k21 - beta) / (alpha - beta)\n\n    # Precompute weights W_alpha and W_beta for the convolution integrals\n    W_alpha = A_bar * (1.0 - np.exp(-alpha * T)) / alpha\n    W_beta  = B_bar * (1.0 - np.exp(-beta * T)) / beta\n    W_total = W_alpha + W_beta\n\n    # Normalize to get convex weights\n    w_alpha = W_alpha / W_total\n    w_beta  = W_beta  / W_total\n\n    # Define the function whose root gives the context-sensitive half-life\n    def f(t):\n        return w_alpha * np.exp(-alpha * t) + w_beta * np.exp(-beta * t) - 0.5\n\n    # Bracket the root: f(0) = 0.5 > 0 and as t -> inf, f(t) -> -0.5 < 0\n    # Choose an upper bound informed by the slower decay component\n    # Add margin to ensure bracketing in extreme cases.\n    upper_guess = 10.0 * max(np.log(2.0) / alpha, np.log(2.0) / beta)\n    upper = min(1e6, upper_guess + 100.0)\n\n    # Find the root in [0, upper]\n    tau = brentq(f, 0.0, upper)\n    return tau\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (k10, k12, k21, V1, R)\n    test_cases = [\n        (0.2, 0.5, 0.3, 10.0, 50.0),\n        (0.25, 0.001, 0.001, 20.0, 100.0),\n        (0.15, 0.7, 0.07, 15.0, 80.0),\n        (1.2, 1.5, 1.0, 12.0, 30.0),\n    ]\n\n    results = []\n    for k10, k12, k21, V1, R in test_cases:\n        tau = context_sensitive_half_life(k10, k12, k21, V1, R, T=4.0)\n        results.append(f\"{tau:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4552117"}]}