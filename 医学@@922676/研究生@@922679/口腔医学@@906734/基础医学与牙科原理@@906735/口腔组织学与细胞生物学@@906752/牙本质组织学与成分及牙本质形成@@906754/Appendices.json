{"hands_on_practices": [{"introduction": "牙本质是一种天然的生物复合材料，其卓越的力学性能源于其独特的纳米级结构——由羟基磷灰石晶体增强的胶原纤维网络。为了从工程和材料科学的角度理解牙本质如何承受咀嚼力，我们可以将其简化为两相复合材料。这项练习 [@problem_id:4723660] 将引导你应用复合材料力学的基本模型（Voigt 和 Reuss 模型）来估算牙本质有效弹性模量的理论边界，从而深入理解其成分、结构和宏观刚度之间的关系。", "problem": "牙本质是一种分级结构的生物复合材料，其承载刚度源于其矿化基质。该基质由散布在胶原-水网络中的碳酸羟基磷灰石微晶组成。在连续介质尺度和小应变条件下，将牙本质视为一种两相线性弹性复合材料，其中矿物相和胶原-水相在代表性体积单元上均表现为各向同性。设矿物相的体积分数为 $v_m = 0.45$，胶原-水相的体积分数为 $v_c = 0.55$，两相的杨氏模量分别为 $E_m = 110$ 吉帕斯卡 (GPa) 和 $E_c = 2$ GPa。\n\n从各相的线性应力-应变关系 $\\sigma = E\\,\\epsilon$、等应变和等应力加载的定义，以及与力学平衡和运动协调性一致的体平均方法出发，推导牙本质有效杨氏模量的Voigt（等应变）界限和Reuss（等应力）界限。然后，利用给定的 $v_m$、$v_c$、$E_m$ 和 $E_c$ 对这些界限进行数值计算。\n\n请以吉帕斯卡 (GPa) 为单位表示您的两个数值答案。将每个界限四舍五入至四位有效数字。最终答案以行向量的形式给出，其中首先是Reuss下界，然后是Voigt上界。", "solution": "问题陈述经评估有效。其科学依据扎根于连续介质力学和材料科学的原理，特别是复合材料理论。该问题是适定的，为获得唯一解提供了所有必要的数据和定义。语言客观，参数对于牙本质而言具有物理真实性。我们现在开始进行推导和计算。\n\n目标是推导一种两相复合材料的有效杨氏模量 $E_{eff}$ 的Voigt界限和Reuss界限。该复合材料由矿物相（下标 $m$）和胶原-水相（下标 $c$）组成。\n\n给定参数如下：\n矿物相体积分数：$v_m = 0.45$\n胶原-水相体积分数：$v_c = 0.55$\n矿物相杨氏模量：$E_m = 110 \\text{ GPa}$\n胶原-水相杨氏模量：$E_c = 2 \\text{ GPa}$\n\n每个各向同性、线性弹性相的本构关系由一维胡克定律给出：\n$\\sigma_i = E_i \\epsilon_i$，其中 $i \\in \\{m, c\\}$。\n复合材料的有效应力 $\\sigma_{eff}$ 和有效应变 $\\epsilon_{eff}$ 通过有效杨氏模量 $E_{eff}$ 相关联：\n$\\sigma_{eff} = E_{eff} \\epsilon_{eff}$。\n\n体积分数之和为1：$v_m + v_c = 0.45 + 0.55 = 1$。\n\n**Voigt（等应变）上界的推导**\n\nVoigt模型假设复合材料内的应变是均匀的。这对应于一个物理模型，其中各相平行于施加载荷的方向排列。\n等应变条件为：\n$$ \\epsilon_{eff} = \\epsilon_m = \\epsilon_c = \\epsilon $$\n复合材料上的总力是各相上力的总和。对于一个具有均匀横截面的代表性体积单元，有效应力是各相应力的体积分数加权平均值。这是力学平衡的表述。\n$$ \\sigma_{eff} = v_m \\sigma_m + v_c \\sigma_c $$\n将各相的本构关系代入平衡方程：\n$$ \\sigma_{eff} = v_m (E_m \\epsilon_m) + v_c (E_c \\epsilon_c) $$\n应用等应变条件：\n$$ \\sigma_{eff} = v_m E_m \\epsilon + v_c E_c \\epsilon = (v_m E_m + v_c E_c) \\epsilon $$\n通过将其与有效本构关系 $\\sigma_{eff} = E_{Voigt} \\epsilon_{eff}$ 进行比较，并注意到 $\\epsilon = \\epsilon_{eff}$，我们将Voigt模量 $E_{Voigt}$ 确定为混合律：\n$$ E_{Voigt} = v_m E_m + v_c E_c $$\n\n**Reuss（等应力）下界的推导**\n\nReuss模型假设复合材料内的应力是均匀的。这对应于一个物理模型，其中各相相对于施加载荷的方向串联排列。\n等应力条件为：\n$$ \\sigma_{eff} = \\sigma_m = \\sigma_c = \\sigma $$\n复合材料的总变形是各相变形的总和。因此，有效应变是各相应变的体积分数加权平均值。这是运动协调性的表述。\n$$ \\epsilon_{eff} = v_m \\epsilon_m + v_c \\epsilon_c $$\n从本构关系中，我们将应变表示为应力的函数：$\\epsilon_i = \\sigma_i / E_i$。将这些代入协调方程：\n$$ \\epsilon_{eff} = v_m \\frac{\\sigma_m}{E_m} + v_c \\frac{\\sigma_c}{E_c} $$\n应用等应力条件：\n$$ \\epsilon_{eff} = v_m \\frac{\\sigma}{E_m} + v_c \\frac{\\sigma}{E_c} = \\sigma \\left( \\frac{v_m}{E_m} + \\frac{v_c}{E_c} \\right) $$\n通过将其与写为 $\\epsilon_{eff} = \\sigma_{eff} / E_{Reuss}$ 的有效本构关系进行比较，并注意到 $\\sigma = \\sigma_{eff}$，我们发现：\n$$ \\frac{1}{E_{Reuss}} = \\frac{v_m}{E_m} + \\frac{v_c}{E_c} $$\n这是反混合律。因此，Reuss模量 $E_{Reuss}$ 为：\n$$ E_{Reuss} = \\left( \\frac{v_m}{E_m} + \\frac{v_c}{E_c} \\right)^{-1} $$\n对于任何两相复合材料，$E_{Reuss} \\le E_{eff} \\le E_{Voigt}$ 是复合材料力学的一个基本结果。\n\n**数值计算**\n\n我们现在将给定的数值代入推导出的表达式。结果的单位将是吉帕斯卡 (GPa)。\n\nVoigt上界：\n$$ E_{Voigt} = (0.45)(110) + (0.55)(2) $$\n$$ E_{Voigt} = 49.5 + 1.1 = 50.6 $$\n四舍五入至四位有效数字，得到 $E_{Voigt} = 50.60 \\text{ GPa}$。\n\nReuss下界：\n$$ E_{Reuss} = \\left( \\frac{0.45}{110} + \\frac{0.55}{2} \\right)^{-1} $$\n$$ E_{Reuss} = \\left( 0.00409090... + 0.275 \\right)^{-1} $$\n$$ E_{Reuss} = \\left( 0.27909090... \\right)^{-1} $$\n$$ E_{Reuss} = 3.5829787... $$\n四舍五入至四位有效数字，得到 $E_{Reuss} = 3.583 \\text{ GPa}$。\n\n最终答案要求以行向量的形式给出，其中包含Reuss界限，然后是Voigt界限。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.583  50.60\n\\end{pmatrix}\n}\n$$", "id": "4723660"}, {"introduction": "除了其作为复合材料的实体部分，牙本质的微观结构以其贯穿全层的牙本质小管为特征。这些小管不仅是牙髓-牙本质复合体活力的通道，也决定了其渗透性，这与牙齿敏感和牙髓反应等临床现象密切相关。通过这项练习 [@problem_id:4723677]，你将学习如何从组织学切片上的显微结构参数（如小管密度和半径）出发，定量计算牙本质的孔隙率，并将其与描述流体输送能力的宏观属性——渗透率联系起来。", "problem": "牙本质组织学横截面中的面积孔隙率是牙本质小管管腔所占的平面面积分数。考虑中层牙本质，其中牙本质小管可理想化为具有圆形横截面和均匀半径的直圆柱形孔隙，并假设小管在横截面上没有明显的重叠。设小管数量密度为每单位面积 $N$ 个小管，平均小管半径为 $r$。仅使用面积孔隙率作为孔隙面积与总面积之比的几何定义，推导出一个用 $N$ 和 $r$ 表示面积孔隙率的表达式。然后，对于中层牙本质，$N = 2.0 \\times 10^{4}~\\mathrm{mm}^{-2}$ 且 $r = 0.7~\\mu\\mathrm{m}$，计算其面积孔隙率。将您的数值答案四舍五入至三位有效数字，并以小数形式表示。最后，阐明通过圆柱形孔隙的层流标度关系如何揭示牙本质中此面积孔隙率与水力渗透率之间的定性关系。", "solution": "该问题陈述被评估为具有科学依据、提法恰当且客观。它为生物物理学和牙科材料科学领域的计算提供了清晰的定义、标准的物理模型和切合实际的参数。该问题是有效的，将提供解答。\n\n该问题分三部分解决：首先，推导面积孔隙率的表达式；其次，根据给定参数计算其数值；第三，阐明孔隙率与水力渗透率之间的关系。\n\n第 1 部分：推导面积孔隙率的表达式。\n\n面积孔隙率，用 $\\phi_A$ 表示，定义为总平面面积 $A_{total}$ 中由孔隙空间占据的分数。在此背景下，孔隙空间是牙本质小管的横截面。\n$$\n\\phi_A = \\frac{A_{void}}{A_{total}}\n$$\n给定小管数量密度为 $N$，表示单位面积的小管数量。对于总面积 $A_{total}$，该面积内包含的小管数量由乘积 $N \\times A_{total}$ 给出。\n\n问题陈述指出，小管可以理想化为具有均匀半径 $r$ 的圆形横截面。因此，单个小管横截面的面积 $A_{tubule}$ 为：\n$$\nA_{tubule} = \\pi r^2\n$$\n总孔隙面积 $A_{void}$ 是 $A_{total}$ 内所有小管面积的总和。基于小管不重叠的假设，我们可以通过将小管数量乘以单个小管的面积来求得总孔隙面积：\n$$\nA_{void} = (\\text{Number of tubules}) \\times A_{tubule} = (N \\times A_{total}) \\times (\\pi r^2)\n$$\n将 $A_{void}$ 的这个表达式代回面积孔隙率的定义中：\n$$\n\\phi_A = \\frac{(N \\times A_{total}) \\times (\\pi r^2)}{A_{total}}\n$$\n分子和分母中的项 $A_{total}$ 可以消去，从而得到用小管数量密度和半径表示的面积孔隙率的通用表达式：\n$$\n\\phi_A = N \\pi r^2\n$$\n\n第 2 部分：面积孔隙率的数值计算。\n\n给定中层牙本质的以下数值：\n小管数量密度, $N = 2.0 \\times 10^{4}~\\mathrm{mm}^{-2}$。\n平均小管半径, $r = 0.7~\\mu\\mathrm{m}$。\n\n为了计算无量纲量 $\\phi_A$，$N$ 和 $r$ 的单位必须一致。我们将半径 $r$ 的单位从微米 ($\\mu\\mathrm{m}$) 转换为毫米 ($\\mathrm{mm}$)。转换因子是 $1~\\mathrm{mm} = 1000~\\mu\\mathrm{m}$，或者 $1~\\mu\\mathrm{m} = 10^{-3}~\\mathrm{mm}$。\n$$\nr = 0.7~\\mu\\mathrm{m} = 0.7 \\times 10^{-3}~\\mathrm{mm}\n$$\n现在，将 $N$ 和 $r$ 的数值代入推导出的 $\\phi_A$ 表达式中：\n$$\n\\phi_A = (2.0 \\times 10^{4}~\\mathrm{mm}^{-2}) \\times \\pi \\times (0.7 \\times 10^{-3}~\\mathrm{mm})^2\n$$\n$$\n\\phi_A = (2.0 \\times 10^{4}) \\times \\pi \\times (0.7^2) \\times (10^{-3})^2~\\mathrm{mm}^{-2} \\cdot \\mathrm{mm}^2\n$$\n$$\n\\phi_A = (2.0 \\times 10^{4}) \\times \\pi \\times (0.49) \\times 10^{-6}\n$$\n$$\n\\phi_A = (2.0 \\times 0.49) \\times \\pi \\times 10^{4-6}\n$$\n$$\n\\phi_A = 0.98 \\times \\pi \\times 10^{-2}\n$$\n使用 $\\pi \\approx 3.14159$ 的值，我们计算最终值：\n$$\n\\phi_A \\approx 0.98 \\times 3.14159 \\times 10^{-2} \\approx 0.0307876\n$$\n问题要求答案四舍五入至三位有效数字。\n$$\n\\phi_A \\approx 0.0308\n$$\n\n第 3 部分：面积孔隙率与水力渗透率之间的关系。\n\n多孔介质的水力渗透率 $K$ 是衡量其在压力梯度下传输流体能力的一个指标。对于牙本质，当其被建模为一组平行的圆柱形小管时，该性质受层流原理支配。\n\n粘性流体通过单个圆柱形管的流动由 Hagen-Poiseuille 方程描述。在压降 $\\Delta P$ 下，通过半径为 $r$、长度为 $L$ 的一个单一小管的体积流量 $Q_{single}$ 为：\n$$\nQ_{single} = \\frac{\\pi r^4}{8\\mu} \\frac{\\Delta P}{L}\n$$\n其中 $\\mu$ 是流体的动力粘度。\n\n通过面积为 $A_{total}$ 的牙本质横截面的总流量 $Q_{total}$ 是该区域内所有单个小管流量的总和。小管的数量是 $N \\times A_{total}$。\n$$\nQ_{total} = (N \\times A_{total}) \\times Q_{single} = N A_{total} \\frac{\\pi r^4}{8\\mu} \\frac{\\Delta P}{L}\n$$\nDarcy's Law 提供了多孔介质中流动的宏观描述：\n$$\nQ_{total} = \\frac{K A_{total}}{\\mu} \\frac{\\Delta P}{L}\n$$\n通过将基于 Hagen-Poiseuille 的总流量表达式与 Darcy's Law 进行比较，我们可以推导出渗透率 $K$ 的表达式：\n$$\n\\frac{K A_{total}}{\\mu} \\frac{\\Delta P}{L} = N A_{total} \\frac{\\pi r^4}{8\\mu} \\frac{\\Delta P}{L}\n$$\n$$\nK = \\frac{N \\pi r^4}{8}\n$$\n现在我们可以将渗透率 $K$ 与面积孔隙率 $\\phi_A = N \\pi r^2$ 联系起来。我们可以用 $\\phi_A$ 来表示 $K$：\n$$\nK = \\frac{(N \\pi r^2) r^2}{8} = \\frac{\\phi_A r^2}{8}\n$$\n这个表达式揭示了定性关系。水力渗透率 $K$ 与面积孔隙率 $\\phi_A$ 成正比。然而，从层流的标度关系（Hagen-Poiseuille 方程中的 $r^4$ 项）中得到的关键见解是小管半径的深远影响。关系式 $K \\propto \\phi_A r^2$ 表明，渗透率不仅取决于孔隙空间的数量（孔隙率），还取决于单个孔隙的大小。对于恒定的孔隙率，具有较少、较大孔隙的组织的渗透率将远高于具有较多、较小孔隙的组织。具体来说，由于 $K \\propto N r^4$ 和 $\\phi_A \\propto N r^2$，将小管半径 $r$ 加倍（同时保持 $N$ 不变）会使孔隙率增加 4 倍，但会使渗透率增加 16 倍。这表明水力渗透率对小管半径的变化比对小管密度的变化要敏感得多。", "answer": "$$\n\\boxed{0.0308}\n$$", "id": "4723677"}, {"introduction": "掌握了牙本质的静态力学和流体动力学特性后，我们转向一个更为复杂的动态过程：龋病导致的脱矿。理解龋损的进展对于预防和治疗至关重要，而这需要整合化学、物理和生物学原理。这项高级实践 [@problem_id:4723654] 将向你介绍一种强大的计算方法，通过建立一个反应-扩散模型来模拟酸在牙本质中的渗透以及矿物质的溶解，让你能够预测不同条件下龋损的深度和发展。", "problem": "您需要使用基于 Fick 定律和一级反应动力学的一维反应-扩散系统来模拟牙本质脱矿前沿的进展。将牙本质视为厚度为 $L$ 的均匀板，其表面位于 $x=0$ 处暴露于酸，内边界位于 $x=L$ 处代表牙髓侧。令 $c(x,t)$ 表示氢离子浓度（单位：$\\mathrm{mol}\\,\\mathrm{m}^{-3}$），$M(x,t)$ 表示局部矿物质分数（无量纲），在 $t=0$ 时归一化为 $M=1$。矿物质主要是羟基磷灰石（HAp），其溶解模型是关于 $c$ 和 $M$ 的一级反应。\n\n基本原理：\n- 带有源汇项的 Fick 第二扩散定律：$$\\frac{\\partial c}{\\partial t} = D_{\\mathrm{eff}} \\frac{\\partial^2 c}{\\partial x^2} - \\beta\\,k\\,c\\,M,$$ 其中 $D_{\\mathrm{eff}}$ 是有效扩散系数（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-1}$），$k$ 是反应速率常数（单位：$\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$），$\\beta$ 是一个无量纲的源汇强度参数。\n- 一级矿物质损失动力学：$$\\frac{\\partial M}{\\partial t} = -\\alpha\\,k\\,c\\,M,$$ 其中 $\\alpha$ 是一个无量纲的化学计量因子。\n- 源于微观结构的有效扩散系数：$$D_{\\mathrm{eff}} = D_{\\mathrm{water}}\\,\\frac{p}{\\tau^2},$$ 其中 $D_{\\mathrm{water}}$ 是氢离子在水中的扩散系数，$p$ 是与牙本质小管密度相关的孔隙度代表值，$\\tau$ 是说明路径复杂性的曲折度。\n\n边界与初始条件：\n- $x=0$ 处的 Dirichlet 边界：$$c(0,t) = c_0,$$ 其中 $c_0$ 是恒定的表面酸浓度（单位：$\\mathrm{mol}\\,\\mathrm{m}^{-3}$）。\n- $x=L$ 处的 Neumann 边界：$$\\frac{\\partial c}{\\partial x}(L,t) = 0.$$\n- $t=0$ 时的初始条件：$$M(x,0) = 1,\\quad c(x,0)=0.$$\n\n定义在时间 $T$ 的脱矿前沿为满足 $$M(x^*,T) \\le M_{\\mathrm{th}}$$ 的最深位置 $x^*$，其中 $M_{\\mathrm{th}}$ 是一个指定的阈值。病损深度为 $x^*$，以微米表示。\n\n算法设计要求：\n- 对 $c(x,t)$ 使用准稳态近似，因为扩散平衡时间尺度 $$t_{\\mathrm{diff}} \\approx \\frac{L^2}{D_{\\mathrm{eff}}}$$ 相对于在 $T$ 期间的矿物质损失时间尺度而言较短。在每个离散时间步，求解稳态反应-扩散方程 $$0 = D_{\\mathrm{eff}} \\frac{\\partial^2 c}{\\partial x^2} - \\beta\\,k\\,c\\,M$$，该方程受所述边界条件约束，且在该步中 $M$ 保持不变。\n- 通过在时间步 $\\Delta t$ 内对一级动力学进行积分来更新 $M$，其中 $c$ 从稳态解中求得。这得到逐点更新公式 $$M^{n+1}(x) = M^n(x)\\,\\exp\\!\\left(-\\alpha\\,k\\,c^n(x)\\,\\Delta t\\right)$$。\n- 使用均匀网格间距 $\\Delta x$ 对空间域 $[0,L]$ 进行离散，并通过有限差分施加边界条件。内部 Neumann 条件通过在虚拟节点处设置 $c_N=c_{N-1}$ 来实现，外部 Dirichlet 条件在第一个节点处为 $c_0=c_0$。\n\n所有模拟中使用的物理和数值参数：\n- $L = 10^{-3}\\,\\mathrm{m}$。\n- $\\Delta x = 5\\times 10^{-6}\\,\\mathrm{m}$。\n- $\\Delta t = 6\\times 3600\\,\\mathrm{s}$（即 $6$ 小时）。\n- $T = 30\\times 24\\times 3600\\,\\mathrm{s}$（即 $30$ 天）。\n- $D_{\\mathrm{water}} = 9.3\\times 10^{-9}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$。\n- $\\alpha = 1$ 且 $\\beta = 1$（无量纲）。\n- $M_{\\mathrm{th}} = 0.8$（无量纲）。\n\n测试套件：\n使用以下参数集提供 $T$ 之后的病损深度预测，每个参数集由 $(p,\\ \\tau,\\ k,\\ c_0)$ 指定：\n1. 基线牙本质：$(p=\\;0.07,\\ \\tau=\\;3,\\ k=\\;1.0\\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1},\\ c_0=\\;0.1\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})$。\n2. 硬化性牙本质（孔隙度降低，曲折度增加）：$(p=\\;0.04,\\ \\tau=\\;6,\\ k=\\;1.0\\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1},\\ c_0=\\;0.1\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})$。\n3. 高酸暴露与较高反应性：$(p=\\;0.10,\\ \\tau=\\;2,\\ k=\\;2.0\\times 10^{-6}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1},\\ c_0=\\;0.3\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})$。\n4. 低酸供应，较慢动力学：$(p=\\;0.05,\\ \\tau=\\;3,\\ k=\\;5.0\\times 10^{-7}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1},\\ c_0=\\;0.02\\,\\mathrm{mol}\\,\\mathrm{m}^{-3})$。\n\n所需单位和输出规范：\n- 将每个病损深度以微米表示，四舍五入到最接近的整数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[d_1,d_2,d_3,d_4]$），其中每个 $d_i$ 是一个整数。\n\n程序必须在每个时间步通过有限差分法离散化实现用于求解 $c$ 的准稳态反应-扩散求解器，并使用指数一级动力学更新 $M$，然后针对每个测试用例，在 $T$ 时间后，将病损深度评估为 $M \\le M_{\\mathrm{th}}$ 的最深网格点。", "solution": "问题陈述已经过分析，并被认为是有效的。它提出了一个有科学依据、适定且计算上可行的牙本质脱矿模型。所有必需的物理常数、模型参数和算法规范都已提供，从而能够得出唯一且有意义的解。\n\n该问题要求对控制牙本质脱矿的一维反应-扩散过程进行数值模拟。该模型由两个耦合的偏微分方程组成，分别描述氢离子浓度 $c(x,t)$ 和矿物质分数 $M(x,t)$。\n\n控制方程为：\n1.  **酸的扩散-反应**：Fick 第二定律，带有代表矿物质溶解的一级源汇项：\n    $$\n    \\frac{\\partial c}{\\partial t} = D_{\\mathrm{eff}} \\frac{\\partial^2 c}{\\partial x^2} - \\beta\\,k\\,c\\,M\n    $$\n2.  **矿物质溶解动力学**：矿物质含量的一级损失：\n    $$\n    \\frac{\\partial M}{\\partial t} = -\\alpha\\,k\\,c\\,M\n    $$\n\n有效扩散系数 $D_{\\mathrm{eff}}$ 根据牙本质微观结构定义：\n$$\nD_{\\mathrm{eff}} = D_{\\mathrm{water}}\\,\\frac{p}{\\tau^2}\n$$\n其中 $p$ 是孔隙度，$\\tau$ 是曲折度。\n\n模拟域是一个厚度为 $L$ 的板，从 $x=0$ 到 $x=L$。边界和初始条件为：\n-   表面处的 Dirichlet 条件：$c(0,t) = c_0$\n-   牙髓侧的 Neumann 条件：$\\frac{\\partial c}{\\partial x}(L,t) = 0$\n-   初始条件：$M(x,0) = 1$ 且 $c(x,0) = 0$（对于 $x \\in [0,L]$）。\n\n该问题指定了一种基于浓度分布 $c(x,t)$ 的准稳态近似的数值解法策略。这是合理的，因为扩散的特征时间 $t_{\\mathrm{diff}} \\approx L^2/D_{\\mathrm{eff}}$ 远小于矿物质损失的特征时间 $t_{\\mathrm{loss}} \\approx (\\alpha k c)^{-1}$。这允许采用算子分裂法，即在每个时间步 $\\Delta t$ 内，我们首先求解稳态浓度分布，然后更新矿物质分数。\n\n**第1步：求解准稳态浓度分布**\n\n在每个时间步 $n$，我们假设矿物质分布 $M^n(x)$ 是固定的。浓度 $c^n(x)$ 迅速达到由以下常微分方程描述的稳态：\n$$\nD_{\\mathrm{eff}} \\frac{d^2 c}{d x^2} - \\beta\\,k\\,c\\,M^n(x) = 0\n$$\n满足 $c(0)=c_0$ 和 $\\frac{dc}{dx}(L)=0$。\n\n我们将空间域 $[0,L]$ 离散为 $N_{pts}$ 个点 $x_i = i\\Delta x$（$i=0, 1, \\dots, N_{pts}-1$），其中 $\\Delta x = L/(N_{pts}-1)$。令 $c_i$ 和 $M_i$ 为在 $x_i$ 处的值。对二阶导数使用中心差分近似，内部节点 $x_i$ 处的常微分方程变为：\n$$\nD_{\\mathrm{eff}} \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta x)^2} - \\beta\\,k\\,c_i\\,M_i = 0\n$$\n重新整理得到一个线性方程：\n$$\nc_{i-1} - \\left(2 + \\frac{\\beta\\,k\\,M_i\\,(\\Delta x)^2}{D_{\\mathrm{eff}}}\\right)c_i + c_{i+1} = 0\n$$\n这组关于未知浓度 $c_1, \\dots, c_{N_{pts}-1}$（因为 $c_0$ 已知）的方程构成了一个线性系统 $A\\mathbf{c} = \\mathbf{b}$。\n\n-   **$x=0$ 处的边界条件**：$c_0$ 是给定的。该值用于 $c_1$ 的方程中，这将 $-c_0$ 移到系统的右侧。\n\n-   **$x=L$ 处的边界条件**：零通量 Neumann 条件在 $x_{N_{pts}-1}=L$ 处按规定实现。引入一个虚拟点 $x_{N_{pts}} = L+\\Delta x$。在 $i=N_{pts}-1$ 处的有限差分方程为：\n$$\nD_{\\mathrm{eff}} \\frac{c_{N_{pts}} - 2c_{N_{pts}-1} + c_{N_{pts}-2}}{(\\Delta x)^2} - \\beta\\,k\\,c_{N_{pts}-1}\\,M_{N_{pts}-1} = 0\n$$\n问题指定使用条件 $c_{N_{pts}} = c_{N_{pts}-1}$。将其代入方程得到：\n$$\nD_{\\mathrm{eff}} \\frac{c_{N_{pts}-1} - 2c_{N_{pts}-1} + c_{N_{pts}-2}}{(\\Delta x)^2} - \\beta\\,k\\,c_{N_{pts}-1}\\,M_{N_{pts}-1} = 0\n$$\n$$\nc_{N_{pts}-2} - \\left(1 + \\frac{\\beta\\,k\\,M_{N_{pts}-1}\\,(\\Delta x)^2}{D_{\\mathrm{eff}}}\\right)c_{N_{pts}-1} = 0\n$$\n这个关于最终节点 $c_{N_{pts}-1}$ 的方程完成了该系统，该系统构成一个三对角矩阵 $A$。该系统可以被高效地求解以得到浓度向量 $\\mathbf{c}$。\n\n**第2步：更新矿物质分数**\n\n确定了浓度分布 $c^n(x)$ 后，我们在时间间隔 $\\Delta t$ 内更新矿物质分数 $M(x)$。动力学方程 $\\frac{\\partial M}{\\partial t} = -\\alpha\\,k\\,c\\,M$ 在假设 $c$ 在 $\\Delta t$ 内为常数的条件下求解。从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 积分得到：\n$$\nM^{n+1}(x) = M^n(x) \\exp\\left(-\\alpha\\,k\\,c^n(x)\\,\\Delta t\\right)\n$$\n此更新在每个网格位置 $x_i$ 处逐点应用。\n\n**第3步：算法流程与病损深度评估**\n\n完整的算法流程如下：\n1.  初始化参数（$L, \\Delta x, \\Delta t, T, \\dots$）和网格。对于每个测试用例，计算 $D_{\\mathrm{eff}}$。\n2.  初始化矿物质分布 $M(x, 0) = 1$（对所有 $x$）。\n3.  开始时间步循环，从 $t=0$ 到 $T$，步长为 $\\Delta t$。\n    a. 在每个时间步 $n$，根据当前的矿物质分布 $M^n(x)$ 构建三对角矩阵 $A$ 和右侧向量 $\\mathbf{b}$。\n    b. 求解线性系统 $A\\mathbf{c}^n = \\mathbf{b}$ 以找到准稳态浓度分布 $c^n(x)$。\n    c. 使用指数更新公式将矿物质分布更新为 $M^{n+1}(x)$。\n4.  在最后一个时间步之后，分析最终的矿物质分布 $M(x, T)$。病损深度 $x^*$ 定义为矿物质分数低于阈值的最深位置（最大的 $x$）：$M(x^*, T) \\le M_{\\mathrm{th}}$。\n5.  通过识别所有满足 $M_i \\le M_{\\mathrm{th}}$ 的网格索引 $i$ 并取其中最大的索引 $i_{max}$ 来找到该深度。深度即为 $x^* = i_{max} \\Delta x$。结果将转换为微米并四舍五入到最接近的整数。\n\n对测试套件中提供的四个参数集中的每一个重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(p, tau, k, c0_val):\n    \"\"\"\n    Runs a single simulation for a given set of physical parameters.\n\n    Args:\n        p (float): Porosity proxy.\n        tau (float): Tortuosity.\n        k (float): Reaction rate constant.\n        c0_val (float): Surface acid concentration.\n\n    Returns:\n        int: The calculated lesion depth in micrometers, rounded to the nearest integer.\n    \"\"\"\n    # Physical and numerical parameters\n    L = 1.0e-3  # m, dentin thickness\n    dx = 5.0e-6  # m, grid spacing\n    dt = 6 * 3600  # s, time step (6 hours)\n    T = 30 * 24 * 3600  # s, total time (30 days)\n    D_water = 9.3e-9  # m^2/s, H+ diffusion in water\n    alpha = 1.0  # dimensionless stoichiometric factor\n    beta = 1.0  # dimensionless sink strength\n    M_th = 0.8  # dimensionless mineral threshold\n\n    # Grid setup\n    num_pts = int(L / dx) + 1\n    x_grid = np.linspace(0, L, num_pts)\n    num_t_steps = int(T / dt)\n\n    # Calculate derived parameters\n    D_eff = D_water * p / (tau**2)\n\n    # Initialization of state variables\n    M = np.ones(num_pts)  # M(x, 0) = 1\n    c = np.zeros(num_pts)  # Placeholder for c(x, t)\n    c[0] = c0_val         # Dirichlet boundary condition at x=0\n\n    # Number of unknowns in the linear system for concentration\n    num_unknowns = num_pts - 1\n\n    # Time-stepping loop\n    for _ in range(num_t_steps):\n        # Step 1: Solve for the quasi-steady-state concentration profile c(x)\n        # The governing equation is D_eff * d^2c/dx^2 - beta*k*c*M = 0.\n        # Discretization leads to a tridiagonal linear system Ac = b.\n\n        # Define the reaction term coefficient for each grid point\n        # gamma_i = beta * k * M_i * dx^2 / D_eff\n        gamma = (beta * k * M * dx**2) / D_eff\n\n        # Construct the tridiagonal matrix A\n        A = np.zeros((num_unknowns, num_unknowns))\n\n        # Main diagonal: A[i, i]\n        # This corresponds to unknowns c_1, c_2, ..., c_{num_pts-1}\n        diag_main = -(2.0 + gamma[1:])\n        # Modify the last element for the Neumann boundary condition\n        diag_main[-1] = -(1.0 + gamma[-1])\n        np.fill_diagonal(A, diag_main)\n\n        # Upper diagonal: A[i, i+1]\n        diag_upper = np.ones(num_unknowns - 1)\n        np.fill_diagonal(A[0:, 1:], diag_upper)\n\n        # Lower diagonal: A[i, i-1]\n        diag_lower = np.ones(num_unknowns - 1)\n        np.fill_diagonal(A[1:, 0:], diag_lower)\n\n        # Construct the right-hand side vector b\n        b = np.zeros(num_unknowns)\n        # From the Dirichlet BC at x=0: c_0 is known\n        b[0] = -c0_val\n\n        # Solve the linear system for the unknown concentrations\n        c_unknowns = np.linalg.solve(A, b)\n        c[1:] = c_unknowns\n\n        # Step 2: Update the mineral fraction M(x)\n        # M(t+dt) = M(t) * exp(-alpha * k * c(t) * dt)\n        M = M * np.exp(-alpha * k * c * dt)\n\n    # Step 3: Determine the lesion depth\n    lesion_indices = np.where(M = M_th)[0]\n\n    if len(lesion_indices) == 0:\n        lesion_depth_m = 0.0\n    else:\n        # Depth is determined by the deepest point meeting the criterion\n        max_index = np.max(lesion_indices)\n        lesion_depth_m = x_grid[max_index]\n\n    # Convert depth to micrometers and round\n    lesion_depth_microns = lesion_depth_m * 1e6\n    return int(round(lesion_depth_microns))\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Test suite: each tuple is (p, tau, k, c0)\n    test_cases = [\n        (0.07, 3, 1.0e-6, 0.1),  # 1. Baseline dentin\n        (0.04, 6, 1.0e-6, 0.1),  # 2. Sclerotic dentin\n        (0.10, 2, 2.0e-6, 0.3),  # 3. High acid exposure, high reactivity\n        (0.05, 3, 5.0e-7, 0.02)  # 4. Low acid supply, slow kinetics\n    ]\n\n    results = []\n    for case in test_cases:\n        p, tau, k, c0_val = case\n        depth = run_simulation(p, tau, k, c0_val)\n        results.append(depth)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4723654"}]}