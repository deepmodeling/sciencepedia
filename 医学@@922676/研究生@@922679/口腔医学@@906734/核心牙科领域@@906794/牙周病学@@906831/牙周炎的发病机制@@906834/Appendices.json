{"hands_on_practices": [{"introduction": "临床上一个常见的难题是，即使实验室药敏测试显示细菌是“敏感”的，抗生素在治疗生物膜相关感染时也常常失败。这项练习旨在挑战您剖析这一复杂现象背后的原因，超越简单的耐药性概念，深入探讨生物膜“耐受性”的理念。通过分析，您将理解生物膜独特的物理化学微环境（如扩散限制和局部$pH$值变化）是如何保护内部细菌，从而导致治疗失效的 [@problem_id:4748222]。", "problem": "一位临床医生使用局部给药的多西环素凝胶和重复的氯己定冲洗液治疗一名慢性牙周炎患者。对来自深牙周袋的龈下菌斑进行了分析。在标准的浮游菌检测中，该患者分离株的最低抑菌浓度（MIC）相对于参考菌株没有变化，但在远高于MIC的浓度下进行的时间-杀菌曲线测定显示，在出现明显的杀菌效果之前，存在长达数小时的存活平台期。对牙周袋生物膜的微电极分析揭示了一个厌氧核心、一个$pH \\approx 6.2$的弱酸性微环境以及缓慢的生长指数。基质分析显示存在大量阴离子型细胞外聚合物（EPS），包括细胞外脱氧核糖核酸（DNA）和硫酸化多糖。生物膜外层含有分泌$\\beta$-内酰胺酶的微生物。假设以下基本原理：(i) Fick第一定律，$J=-D \\nabla C$，以及具有一级消耗项$k\\,C$的稳态反应-扩散；(ii) 弱电解质的分配遵循Henderson–Hasselbalch关系；(iii) 氨基糖苷类抗生素的摄取依赖于质子动能势；(iv) MIC反映了在平衡状态下抑制净增长的浓度，而最低杀菌持续时间（MDK）则反映了在固定浓度下实现特定对数杀灭所需的时间。\n\n以下哪项陈述最好地定义了龈下菌群中的抗生素耐药性与生物膜耐受性，并正确解释了导致药物渗透减少和保护龈下生物膜的表型改变的物理化学基础？选择所有适用选项。\n\nA. 在此背景下，抗生素耐药性指在平衡状态下MIC发生可遗传的升高，而生物膜耐受性指由于表型状态导致MDK增加但MIC不变的存活；因此，观察到的在高于MIC浓度下的缓慢杀菌现象与由缓慢生长和有限渗透驱动的耐受性相符。\n\nB. 阴离子型EPS通过静电吸引增加了阳离子抗菌剂的有效扩散系数，从而加速了氯己定的深层渗透，并确保了尽管代谢活性低也能快速杀菌。\n\nC. 当药物在生物膜外围被消耗或失活时（例如，被$\\beta$-内酰胺酶降解），稳态反应-扩散模型预测存在一个衰减长度$L$，其标度关系为$L=(D_{\\text{eff}}/k)^{1/2}$，导致药物浓度随深度呈指数衰减，从而保护内部细菌免受药物影响。\n\nD. 酸性、缺氧的微环境改变了药物的物理化学性质和细胞生理学：弱碱性抗生素的质子化减少了可用于被动吸收的非带电部分，而厌氧条件下的膜电位降低损害了氨基糖苷类抗生素的摄取；这两种机制都增加了生物膜中的MDK，而不必改变浮游菌的MIC。\n\nE. 生物膜内的水通道保证了任何局部抗菌剂都能均匀、快速地递送到所有深度，因此治疗失败必然只表明存在可遗传的耐药突变。\n\nF. 生物膜中外排泵的上调总是在浮游菌检测中产生更高的MIC值，因此仅测量MIC就足以识别与生物膜相关的耐受机制。", "solution": "用户提供了一个关于牙科生物膜背景下抗生素耐药性和耐受性的详细问题陈述。任务是验证此问题陈述，如果有效，则通过评估每个选项（A-F）来得出正确答案。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **临床情景**：一名慢性牙周炎患者接受局部给药的多西环素凝胶和重复的氯己定冲洗液治疗。\n- **样本来源**：来自深牙周袋的龈下菌斑。\n- **微生物学数据**：\n    - 浮游菌分离株的最低抑菌浓度（MIC）相对于参考菌株没有变化。\n    - 在远高于MIC的浓度下进行的时间-杀菌曲线测定显示，在显著杀菌前存在长达数小时的存活平台期。\n- **生物膜微环境**：\n    - 一个厌氧核心。\n    - 一个弱酸性微环境，$pH \\approx 6.2$。\n    - 缓慢的生长指数。\n- **生物膜基质特性**：\n    - 大量阴离子型细胞外聚合物（EPS），包括细胞外脱氧核糖核酸（DNA）和硫酸化多糖。\n    - 生物膜外层含有分泌$\\beta$-内酰胺酶的微生物。\n- **假设的基本原理**：\n    - (i) Fick第一定律，$J=-D\\nabla C$，以及具有一级消耗项$kC$的稳态反应-扩散。\n    - (ii) 弱电解质的分配遵循Henderson–Hasselbalch关系。\n    - (iii) 氨基糖苷类抗生素的摄取依赖于质子动能势。\n    - (iv) MIC反映了在平衡状态下抑制净增长的浓度；最低杀菌持续时间（MDK）反映了在固定浓度下实现特定对数杀灭所需的时间。\n- **问题**：识别在此背景下最好地定义抗生素耐药性与生物膜耐受性，并正确解释导致药物渗透减少和保护龈下生物膜的表型改变的物理化学基础的陈述。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：问题陈述坚实地基于微生物学、药理学和生物物理运输现象的既定原则。耐药性（基因型，MIC变化）和耐受性（表型，MDK变化）之间的区别，牙菌斑生物膜的特性（缺氧、酸性pH、EPS），以及物理化学原理（反应-扩散，pH依赖性分配）都是该领域中标准且广为接受的概念。\n- **问题明确**：这个问题是明确的。它提供了一套详细、一致的观察结果和理论基础，并要求在此框架下对陈述进行评估。通过逻辑应用所提供的原则，可以确定一组唯一的正确陈述。\n- **客观性**：语言精确、技术性强，没有主观性或非科学性主张。\n- **关于缺陷的结论**：问题陈述没有表现出任何指定的缺陷。它在科学上是合理的、内部一致的、客观的和可检验的。所呈现的数据（MIC不变但杀菌缓慢）经典地说明了生物膜耐受性的概念，为严格检验其潜在机制奠定了基础。\n\n**步骤3：结论与行动**\n- 问题是**有效的**。现在将通过分析每个选项来继续解答过程。\n\n### 解答推导与选项分析\n\n问题的核心在于区分抗生素耐药性和耐受性，并理解导致生物膜中耐受性产生的物理化学机制。\n- **耐药性**是MIC的可遗传性增加。问题陈述MIC没有变化，排除了经典耐药性作为主要问题。\n- **耐受性**是在MIC不变的情况下，在致死浓度的抗生素中存活较长时间的能力，表现为MDK增加。“长达数小时的存活平台期”的观察结果是耐受性的直接体现。\n该问题的耐受性机制在问题中已给出：由于生物膜微环境导致的药物渗透减少和细胞生理学改变。\n\n**选项A分析：**\n该陈述提供了耐药性和耐受性的定义。它将耐药性定义为“MIC发生可遗传的升高”，将耐受性定义为“由于表型状态导致MDK增加但MIC不变的存活”。这些是微生物学中标准、公认的定义。然后该陈述将这些定义应用于当前案例：“因此，观察到的在高于MIC浓度下的缓慢杀菌现象与由缓慢生长和有限渗透驱动的耐受性相符。” 这是一个正确的应用。问题描述了缓慢的生长指数并为有限渗透提供了基础，这两者都是生物膜耐受性的关键驱动因素。在患者分离株中观察到的MIC不变和缓慢的杀菌动力学是耐受性的标志。\n**结论：正确。**\n\n**选项B分析：**\n该陈述声称阴离子型EPS通过静电吸引“增加了”阳离子抗菌剂（如氯己定）的“有效扩散系数”，从而“加速了深层渗透”。这在根本上是错误的。虽然阳离子药物和阴离子基质之间存在静电吸引，但这会导致结合和隔离。这个结合过程会*延缓*自由药物的移动，实际上*降低*了有效扩散系数（$D_{\\text{eff}}$）。这种现象被称为反应-扩散限制，它减缓了渗透速度，保护了生物膜的内层。该陈述提出了一个与之相反的、物理上不正确的说法。\n**结论：不正确。**\n\n**选项C分析：**\n该陈述使用反应-扩散模型描述了生物膜内药物消耗或失活的后果。问题为该模型提供了基础：具有一级消耗项$kC$的稳态扩散。对于一维系统，控制方程为$D_{\\text{eff}} \\frac{d^2C}{dx^2} - kC = 0$。对于半无限介质，该微分方程的解是浓度随深度$x$呈指数衰减：$C(x) = C_0 \\exp(-x/L)$，其中特征衰减长度$L$由$L = (D_{\\text{eff}}/k)^{1/2}$给出。该数学关系在选项中陈述正确。其物理学解释，即这会产生一个浓度梯度，从而保护内部细菌免受药物影响，也是正确的。这是生物膜中抗生素功效降低的一个主要机制。\n**结论：正确。**\n\n**选项D分析：**\n该陈述讨论了由特定生物膜微环境产生的两种不同的耐受机制。1. **酸性**：问题指出微环境是酸性的（$pH \\approx 6.2$）。对于弱碱性抗生素（例如多西环素），Henderson-Hasselbalch原理规定，在酸性环境（$pH  pK_a$）中，药物将主要以其质子化的带电形式存在。因为带电分子不像非带电分子那样容易被动扩散穿过脂质膜，所以药物摄取受损。这是一个正确的物理化学原理。2. **缺氧**：问题指出生物膜有一个厌氧核心，并提供了氨基糖苷类抗生素的摄取依赖于质子动能势（PMF）的基础。PMF由有氧呼吸产生。在厌氧条件下，PMF大大减弱，这严重损害了氨基糖苷类抗生素的摄取。这是一个经典、公认的抗生素耐受机制。最终结论，即这些机制增加了生物膜内的MDK，而不必改变浮游菌的MIC（该MIC是在标准、有氧、中性pH条件下测量的），是完全正确的。这些是依赖于环境的表型适应。\n**结论：正确。**\n\n**选项E分析：**\n该陈述假设“生物膜内的水通道保证了任何局部抗菌剂都能均匀、快速地递送到所有深度”。这个前提是错误的。虽然生物膜是水合的，但通过致密、曲折的EPS基质的扩散路径受到显著阻碍。如选项B和C的分析中所解释，扩散受到结合（静电相互作用）和消耗/失活的限制。因此，递送既不均匀也不快速。从这个错误前提得出的结论，即治疗失败“必然只表明存在可遗传的耐药突变”，因此是无效的。整个问题设置都指向多种非遗传性的耐受机制。\n**结论：不正确。**\n\n**选项F分析：**\n该陈述声称生物膜中外排泵的上调“总是在浮游菌检测中产生更高的MIC值”。副词“总是”（invariably）使得这个陈述不正确。外排泵的表达通常是对生物膜内特定化学环境的一种瞬时、可诱导的反应。当细菌从生物膜中取出并在标准实验室培养基中进行MIC测试时，诱导物可能不存在，外排泵可能不会高水平表达。在这种常见情况下，外排泵作为一种耐受机制（有助于*原位*存活），而不会导致浮游菌MIC的增加。结论“仅测量MIC就足以”是一种严重的过度简化，并且与整个问题情景直接矛盾。\n**结论：不正确。**", "answer": "$$\\boxed{ACD}$$", "id": "4748222"}, {"introduction": "在理解了微生物的挑战之后，我们将注意力转向宿主的破坏性反应。这项练习聚焦于牙周炎牙槽骨吸收的最终共同通路——$RANKL/OPG$信号轴。您将学习如何将从龈沟液中获得的临床测量数据，通过一个量化模型，转化为对破骨细胞活性的预测，从而搭建起从分子标志物到病理过程的桥梁 [@problem_id:4748214]。", "problem": "一名患有广泛性III期牙周炎的患者，其牙龈沟液（GCF）中的可溶性核因子κB受体激活剂配体（RANKL）和骨保护素（OPG）被检测。测得的浓度为 $[\\mathrm{RANKL}] = 180 \\,\\mathrm{pg/mL}$ 和 $[\\mathrm{OPG}] = 60 \\,\\mathrm{pg/mL}$。在牙周炎的发病机制中，RANKL–OPG轴调控破骨细胞生成：RANKL通过RANK受体刺激破骨细胞前体细胞的分化，而OPG作为一种诱饵受体，能够隔离RANKL并减弱信号传导。\n\n基于以下基本原则：\n- 在受体介导的信号传导中，当一种激动剂受到一种诱饵受体的竞争性拮抗，导致游离激动剂可用性降低时，对下游通路的净刺激可以通过一个与局部微环境中$[\\mathrm{RANKL}]/[\\mathrm{OPG}]$比率成正比的无量纲刺激变量来表征。\n- 对于具有$n$个有效协同步骤、并在刺激水平为$EC_{50}$时达到半数最大激活的协同、可饱和信号转导级联反应，其响应函数的最小形式必须满足以下条件：对刺激单调递增，界于$0$和$1$之间，当刺激等于$EC_{50}$时其值为$1/2$，且随着$n$的增大，响应曲线变得更陡峭。\n- 从牙周炎患病组织的离体破骨细胞生成实验中校准得到的局部破骨细胞形成响应参数如下：希尔系数$n = 2$（无量纲），半数最大激活时的RANKL与OPG比率$EC_{50} = 2$（无量纲），以及最大破骨细胞形成速率$V_{\\max} = 120$ 个细胞·天$^{-1}$·毫米$^{-2}$。\n\n仅使用这些基本原则，首先计算由$[\\mathrm{RANKL}]/[\\mathrm{OPG}]$比率给出的无量纲刺激。然后，推导一个符合上述约束条件的协同、可饱和的剂量-效应关系，并用它来预测该患者的破骨细胞形成速率。报告最终的破骨细胞形成速率，单位为个细胞·天$^{-1}$·毫米$^{-2}$，并将您的最终数值答案四舍五入至四位有效数字。", "solution": "在尝试任何解答之前，首先对问题陈述进行严格的验证程序。\n\n逐字提取已知条件：\n- 患者病理：广泛性III期牙周炎。\n- 牙龈沟液(GCF)中的分析物浓度：可溶性核因子κB受体激活剂配体，$[\\mathrm{RANKL}] = 180 \\,\\mathrm{pg/mL}$，和骨保护素，$[\\mathrm{OPG}] = 60 \\,\\mathrm{pg/mL}$。\n- 刺激的基本原则：净刺激是一个与$[\\mathrm{RANKL}]/[\\mathrm{OPG}]$比率成正比的无量纲变量。\n- 响应函数的基本原则：响应函数的最小形式必须是单调递增的，界于0和1之间，具有$n$个有效协同步骤，当刺激等于$EC_{50}$时其值为1/2，且随着$n$的增大而变得更陡峭。\n- 离体实验的校准参数：希尔系数$n = 2$（无量纲），半数最大激活$EC_{50} = 2$（无量纲），以及最大破骨细胞形成速率$V_{\\max} = 120$ 个细胞·天$^{-1}$·毫米$^{-2}$。\n\n根据既定标准对问题进行有效性评估。该问题被判定为**有效**。\n1.  **科学依据**：该问题基于已被广泛证实的RANKL-OPG信号轴，它是骨代谢的关键调节因子，也是诸如牙周炎等骨吸收性疾病发病机制中的一个关键因素。建模方法采用了剂量-效应关系，这是药理学和系统生物学中的标准且适用的方法论。\n2.  **良定性**：该问题是良定的。它提供了所有必要的定量数据（$[\\mathrm{RANKL}]$、$[\\mathrm{OPG}]$、$n$、$EC_{50}$、$V_{\\max}$）以及对所需模型属性的清晰描述，从而能够得到唯一且稳定的解。\n3.  **客观性与一致性**：该问题以客观、定量的术语陈述，没有歧义或主观论断。所有提供的单位和数值彼此一致。\n\n问题经验证后，分步骤进行求解。\n\n首先，我们计算无量纲刺激变量，记为$S$。根据问题的基本原则规定，该刺激是RANKL与其竞争性诱饵受体OPG的浓度之比。\n$$S = \\frac{[\\mathrm{RANKL}]}{[\\mathrm{OPG}]}$$\n代入该患者的测量浓度：\n$$S = \\frac{180 \\,\\mathrm{pg/mL}}{60 \\,\\mathrm{pg/mL}} = 3$$\n刺激$S$是一个无量纲量，这与半数最大激活常数$EC_{50}$的无量纲性质一致。\n\n第二，我们必须根据所提供的约束条件，推导协同、可饱和的剂量-效应函数的数学形式。这组约束条件——单调递增、界于$0$和$1$之间、在$S=EC_{50}$时值为$1/2$、以及由指数$n$决定的协同性——唯一地确定了希尔-朗缪尔方程，通常称为希尔方程。归一化响应函数$f(S)$代表下游通路的激活分数，其表达式为：\n$$f(S) = \\frac{S^n}{EC_{50}^n + S^n}$$\n该方程严格遵守所有指定的约束条件。\n\n第三，我们使用此函数来预测破骨细胞形成速率。实际速率（我们记为$V$）是最大可能速率$V_{\\max}$与激活分数$f(S)$的乘积。\n$$V = V_{\\max} \\cdot f(S) = V_{\\max} \\left( \\frac{S^n}{EC_{50}^n + S^n} \\right)$$\n该方程给出了破骨细胞形成速率作为刺激和系统参数的函数。\n\n最后，我们将问题陈述中提供的数值代入该方程，以计算该患者的具体速率。\n参数如下：\n- 刺激：$S = 3$\n- 希尔系数：$n = 2$\n- 半数最大激活比率：$EC_{50} = 2$\n- 最大形成速率：$V_{\\max} = 120 \\,\\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$\n\n代入过程如下：\n$$V = 120 \\cdot \\frac{3^2}{2^2 + 3^2}$$\n$$V = 120 \\cdot \\frac{9}{4 + 9}$$\n$$V = 120 \\cdot \\frac{9}{13}$$\n$$V = \\frac{1080}{13} \\,\\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$$\n\n为了得到最终的数值答案，我们进行除法运算：\n$$V \\approx 83.076923... \\,\\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$V \\approx 83.08 \\,\\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$$", "answer": "$$\\boxed{83.08}$$", "id": "4748214"}, {"introduction": "牙周炎是一种多因素疾病，其发生发展是多种风险因素共同作用的结果。这项最终练习将您的视角从单一的分子通路提升到整个疾病系统。通过构建和分析一个计算模型，您将运用敏感性分析这一强大的现代技术，来识别哪些风险因素（如牙菌斑、吸烟或宿主易感性）对疾病进展的影响最大，这展示了建模如何指导临床重点和研究方向 [@problem_id:4748237]。", "problem": "您的任务是实施一个基于特定原理的敏感性分析程序，使用一个基于广为接受的骨免疫学原理的最小机理模型，来识别在牙周炎发病机制中，哪些生物驱动因素对牙槽骨流失的影响最强。目标是结合一个简化的骨重塑模型和一个全局敏感性方法，并为每个测试场景报告影响最大的单个参数，以一个基于1的索引形式表示。\n\n建模假设与基本原理：\n- 牙槽骨量 $B(t)$ 代表基线骨量的分数，其中 $B(t) \\in [0,1]$，其演变是成骨细胞形成和破骨细胞吸收的净结果。骨形成受到一个稳态目标的限制，而骨吸收则由破骨细胞生成信号驱动。\n- 速率方程为：\n  $$\\frac{dB}{dt} = k_f \\,(1 - B) - k_r \\,A(R,I)\\,B,$$\n  其中 $k_f > 0$ 是基线形成常数，$k_r > 0$ 是吸收转换常数。这两个常数都是固定的，在同一测试用例的样本中不发生变化。除时间单位为天外，所有量均为无量纲，但您只需处理稳态，并报告一个无量纲的分数作为结果。不涉及角度。\n- 破骨细胞生成活性建模为：\n  $$A(R,I) = R \\, h(I), \\quad h(I) = \\frac{I^{n}}{K^{n} + I^{n}},$$\n  其中 $R$ 是核因子κB受体激活剂配体与骨保护素 (RANKL/OPG) 的比率，$h(I)$ 是复合炎症驱动 $I$ 的饱和希尔函数，其希尔系数为 $n$，半激活常数为 $K$。\n- 复合炎症驱动 $I$ 是归一化决定因素的加权和：\n  $$I = w_P P + w_V V + w_S S + w_{Smk} Smk + w_{Hg} Hg,$$\n  其中：\n  - $P$ 是牙菌斑生物量（归一化），\n  - $V$ 是细菌毒力（归一化），\n  - $S$ 是宿主免疫敏感性（归一化），\n  - $Smk$ 是吸烟暴露（归一化），\n  - $Hg$ 是高血糖严重程度（归一化）。\n  权重固定为 $w_P = 0.40$，$w_V = 0.15$，$w_S = 0.15$，$w_{Smk} = 0.15$ 和 $w_{Hg} = 0.15$，总和为 $1.00$。比率 $R$ 和每个决定因素在敏感性分析中被视为独立输入。\n\n固定参数值：\n- $k_f = 0.02$，\n- $k_r = 0.05$，\n- $n = 2$，\n- $K = 0.5$。\n\n结果定义：\n- 将稳态骨分数 $B^\\ast$ 定义为在恒定输入 $(P,V,S,Smk,Hg,R)$ 下 $\\frac{dB}{dt} = 0$ 的稳定解。关注的量是稳态骨流失分数：\n  $$L^\\ast = 1 - B^\\ast,$$\n  该值必须以 $\\left[0,1\\right]$ 范围的小数形式报告。您不会直接输出 $L^\\ast$；它在内部用于敏感性分析。\n\n全局敏感性分析规范：\n- 使用偏秩相关系数 (PRCC) 来量化每个输入参数对 $L^\\ast$ 的单调影响，同时控制其他参数的影响。偏秩相关系数 (PRCC) 的计算方法如下：\n  - 对每个输入和输出进行秩变换，\n  - 对于每个输入 $X_i$，将其秩对剩余输入的秩进行回归以获得残差 $e_{X_i}$，\n  - 将输出的秩对剩余输入的秩进行回归以获得残差 $e_{Y}$，\n  - 计算 $e_{X_i}$ 和 $e_{Y}$ 之间的皮尔逊相关性，从而得出 $X_i$ 的PRCC。\n- 对于跨参数范围的抽样，使用拉丁超立方抽样 (LHS)，每个测试用例 $N = 1000$ 个样本。必须固定随机种子以确保可复现性。\n\n敏感性分析的输入：\n- 待分析的参数排序如下：\n  $$[P, V, S, Smk, Hg, R],$$\n  您的程序必须在每个测试场景中报告绝对PRCC值最大的参数的索引（基于1）。\n\n测试套件：\n- 使用以下三个测试用例，每个用例都由输入的均匀抽样范围定义：\n  1. 一般环境：\n     - $P \\in [0,1]$, $V \\in [0,1]$, $S \\in [0,1]$, $Smk \\in [0,1]$, $Hg \\in [0,1]$, $R \\in [0.5,2.0]$。\n  2. 低菌斑环境：\n     - $P \\in [0,0.2]$, $V \\in [0,1]$, $S \\in [0,1]$, $Smk \\in [0,1]$, $Hg \\in [0,1]$, $R \\in [0.5,2.0]$。\n  3. 高风险暴露偏斜：\n     - $P \\in [0.3,0.7]$, $V \\in [0,1]$, $S \\in [0,1]$, $Smk \\in [0.6,1.0]$, $Hg \\in [0.6,1.0]$, $R \\in [0.5,2.0]$。\n\n算法要求：\n- 从模型中推导出 $B^\\ast$ 并为每个样本计算 $L^\\ast$。\n- 使用固定的随机种子，为每个测试用例实现 $N = 1000$ 的拉丁超立方抽样。\n- 计算 $6$ 个输入的PRCC，并为每个测试用例识别出绝对PRCC值最大的参数的索引（基于1）。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_1,r_2,r_3]$，其中 $r_j$ 是测试用例 $j$ 中最具影响力的参数的基于1的索引。\n- 输出类型必须是整数列表。\n\n注：\n- 仅使用指定的模型和敏感性方法以及给定的常数。不要引入额外的参数或修改基础方程。\n- 缩写定义：RANK配体 (RANKL)，骨保护素 (OPG)，偏秩相关系数 (PRCC)。", "solution": "本问题要求对牙周炎发病机制的一个机理模型进行全局敏感性分析，以确定在不同环境场景下牙槽骨流失的最主要驱动因素。解决方案包括三个主要阶段：推导稳态模型输出、实施拉丁超立方抽样 (LHS) 方案以生成输入参数集、以及计算偏秩相关系数 (PRCC) 以量化敏感性。\n\n牙槽骨量 $B(t)$ 的模型由以下常微分方程给出：\n$$\n\\frac{dB}{dt} = k_f \\,(1 - B) - k_r \\,A(R,I)\\,B\n$$\n其中 $B$ 是基线骨量的比例，$k_f = 0.02$ 是形成常数，$k_r = 0.05$ 是吸收转换常数。破骨细胞生成活性 $A(R,I)$ 取决于RANKL/OPG比率 $R$ 和炎症驱动 $I$。\n\n首先，我们确定稳态骨流失 $L^\\ast$ 的解析表达式。稳态由条件 $\\frac{dB}{dt} = 0$ 定义。设 $B^\\ast$ 为稳态骨量。\n$$\nk_f (1 - B^\\ast) - k_r A(R,I) B^\\ast = 0\n$$\n整理各项以求解 $B^\\ast$：\n$$\nk_f = k_f B^\\ast + k_r A(R,I) B^\\ast\n$$\n$$\nk_f = B^\\ast (k_f + k_r A(R,I))\n$$\n$$\nB^\\ast = \\frac{k_f}{k_f + k_r A(R,I)}\n$$\n我们关注的结果是稳态骨流失分数 $L^\\ast$，定义为 $L^\\ast = 1 - B^\\ast$。\n$$\nL^\\ast = 1 - \\frac{k_f}{k_f + k_r A(R,I)} = \\frac{(k_f + k_r A(R,I)) - k_f}{k_f + k_r A(R,I)}\n$$\n简化后得到：\n$$\nL^\\ast = \\frac{k_r A(R,I)}{k_f + k_r A(R,I)}\n$$\n函数 $A(R,I)$ 定义为 $A(R,I) = R \\cdot h(I)$，其中 $h(I)$ 是一个希尔函数，系数为 $n=2$，半激活常数为 $K=0.5$：\n$$\nh(I) = \\frac{I^n}{K^n + I^n} = \\frac{I^2}{0.5^2 + I^2} = \\frac{I^2}{0.25 + I^2}\n$$\n复合炎症驱动 $I$ 是 $5$ 个归一化决定因素 $[P, V, S, Smk, Hg]$ 的加权和。\n$$\nI = w_P P + w_V V + w_S S + w_{Smk} Smk + w_{Hg} Hg\n$$\n权重为 $w_P = 0.40$，$w_V = 0.15$，$w_S = 0.15$，$w_{Smk} = 0.15$ 和 $w_{Hg} = 0.15$。敏感性分析将对 $6$ 个输入参数执行：$[P, V, S, Smk, Hg, R]$。\n\n敏感性分析使用偏秩相关系数 (PRCC) 方法。该技术在控制其他输入影响的同时，衡量一个输入与一个输出之间的单调关系。实施步骤如下：\n1.  **抽样**：对于 $3$ 个测试用例中的每一个，我们使用拉丁超立方抽样 (LHS) 为 $6$ 个输入参数生成 $N=1000$ 个样本。样本从每个测试用例中指定的范围所定义的均匀分布中抽取。固定的随机种子确保了可复现性。\n2.  **模型评估**：对于 $N=1000$ 个输入样本集中的每一个，使用推导出的解析表达式计算模型输出 $L^\\ast$。\n3.  **秩变换**：将 $6$ 个输入参数的 $N$ 个值以及输出 $L^\\ast$ 的 $N$ 个值转换为它们的秩。\n4.  **PRCC 计算**：对于每个输入参数 $X_i$（其中 $i$ 从 $1$ 到 $6$）：\n    a. 将 $X_i$ 的秩（记为 $r(X_i)$）对其他 $5$ 个输入（$j \\neq i$ 时的 $r(X_j)$）的秩进行回归。计算此次线性回归的残差 $e_{X_i}$。此步骤从 $r(X_i)$ 中移除了其他输入的线性影响。\n    b. 同样将输出 $L^\\ast$ 的秩（记为 $r(L^\\ast)$）对相同的 $5$ 个输入（$j \\neq i$ 时的 $r(X_j)$）的秩进行回归。计算此次回归的残差 $e_{L^\\ast}$。\n    c. 输入 $X_i$ 的 PRCC 是两组残差 $e_{X_i}$ 和 $e_{L^\\ast}$ 之间的皮尔逊相关系数。\n5.  **识别最具影响力的参数**：对于每个测试用例，比较计算出的 $6$ 个 PRCC 的绝对值。将与最大绝对PRCC对应的参数识别为最具影响力的参数。结果以一个基于1的索引报告，该索引对应于 $[P, V, S, Smk, Hg, R]$ 的顺序。\n\n对三个测试场景中的每一个重复此过程，得出一个包含三个索引的列表，这就是最终答案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import qmc, rankdata\n\ndef solve():\n    \"\"\"\n    Implements a sensitivity analysis to identify the most influential biological\n    drivers of alveolar bone loss in a model of periodontitis pathogenesis.\n    \"\"\"\n\n    # --- Fixed parameter values ---\n    k_f = 0.02  # Formation constant\n    k_r = 0.05  # Resorptive turnover constant\n    n = 2       # Hill coefficient\n    K = 0.5     # Half-activation constant\n\n    # Weights for the composite inflammatory drive\n    weights = np.array([0.40, 0.15, 0.15, 0.15, 0.15])  # P, V, S, Smk, Hg\n\n    # --- Sensitivity analysis specification ---\n    N = 1000       # Number of samples for LHS\n    SEED = 123     # Fixed random seed for reproducibility\n    NUM_PARAMS = 6 # Number of input parameters: P, V, S, Smk, Hg, R\n\n    # --- Test suite: parameter ranges ---\n    # Each tuple contains lower and upper bounds for the 6 parameters.\n    test_cases = [\n        # 1. General environment\n        (np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.5]), np.array([1.0, 1.0, 1.0, 1.0, 1.0, 2.0])),\n        # 2. Low-plaque environment\n        (np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.5]), np.array([0.2, 1.0, 1.0, 1.0, 1.0, 2.0])),\n        # 3. High-risk exposure skew\n        (np.array([0.3, 0.0, 0.0, 0.6, 0.6, 0.5]), np.array([0.7, 1.0, 1.0, 1.0, 1.0, 2.0])),\n    ]\n\n    def model(P, V, S, Smk, Hg, R):\n        \"\"\"\n        Calculates the steady-state bone loss L_star based on input parameters.\n        \"\"\"\n        # Composite inflammatory drive\n        I_components = np.array([P, V, S, Smk, Hg])\n        I = np.dot(weights, I_components)\n        \n        # Hill function for inflammatory signaling\n        h_I = (I**n) / (K**n + I**n)\n        \n        # Osteoclastogenic activity\n        A_RI = R * h_I\n        \n        # Steady-state bone loss L_star\n        L_star = (k_r * A_RI) / (k_f + k_r * A_RI)\n        return L_star\n\n    def calculate_prcc(l_bounds, u_bounds):\n        \"\"\"\n        Performs LHS and calculates PRCC for all input parameters.\n        \"\"\"\n        # 1. Latin Hypercube Sampling\n        sampler = qmc.LatinHypercube(d=NUM_PARAMS, seed=SEED)\n        samples_01 = sampler.random(n=N)\n        scaled_samples = qmc.scale(samples_01, l_bounds, u_bounds)\n        \n        # 2. Model Evaluation\n        # The model function expects separate arguments, but scaled_samples is a (N, 6) array.\n        # We can either loop or transpose and unpack. Transposing is more efficient.\n        output_L_star = model(*scaled_samples.T)\n        \n        # 3. Rank Transformation\n        ranked_inputs = np.empty_like(scaled_samples)\n        for i in range(NUM_PARAMS):\n            ranked_inputs[:, i] = rankdata(scaled_samples[:, i])\n        \n        ranked_output = rankdata(output_L_star)\n\n        # 4. PRCC Calculation\n        prcc_values = np.zeros(NUM_PARAMS)\n        \n        # Add intercept term for linear regression\n        ranked_output_with_intercept = np.c_[np.ones(N), ranked_output.reshape(-1, 1)]\n\n        for i in range(NUM_PARAMS):\n            # Get ranks of input X_i\n            r_Xi = ranked_inputs[:, i]\n            \n            # Get ranks of other inputs X_{-i}\n            r_X_others = np.delete(ranked_inputs, i, axis=1)\n            \n            # Add intercept term for regression\n            X_reg = np.c_[np.ones(N), r_X_others]\n            \n            # a. Regress r(X_i) on r(X_{-i}) and get residuals\n            beta_i, _, _, _ = np.linalg.lstsq(X_reg, r_Xi, rcond=None)\n            residuals_Xi = r_Xi - X_reg @ beta_i\n            \n            # b. Regress r(L*) on r(X_{-i}) and get residuals\n            beta_L, _, _, _ = np.linalg.lstsq(X_reg, ranked_output, rcond=None)\n            residuals_L = ranked_output - X_reg @ beta_L\n            \n            # c. Compute Pearson correlation of residuals\n            prcc_values[i] = np.corrcoef(residuals_Xi, residuals_L)[0, 1]\n            \n        return prcc_values\n\n    final_results = []\n    for l_bounds, u_bounds in test_cases:\n        prccs = calculate_prcc(l_bounds, u_bounds)\n        # 5. Identify the most influential parameter (1-based index)\n        most_influential_idx = np.argmax(np.abs(prccs)) + 1\n        final_results.append(most_influential_idx)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```", "id": "4748237"}]}