{"hands_on_practices": [{"introduction": "当一条主要脑动脉发生闭塞时，侧支循环作为一种天然的“备用通道”至关重要。这些微小血管扩张以增加血流量的能力，直接决定了缺血区域能否存活。本练习将运用流体动力学的基本原理——哈根-泊肃叶定律，来精确计算血管半径的微小变化如何对血流量产生巨大影响[@problem_id:5095705]。通过这个计算，你将深刻理解为何血管舒张是应对急性缺血的关键生理反应。", "problem": "大脑中动脉（MCA）供血区的一条皮质支在MCA近端闭塞后，转而依赖来自大脑前动脉（ACA）的软脑膜侧支循环供血。假设为该分支供血的主要侧支段是一段直的圆柱形血管，其中流体为牛顿流体且呈层流状态，并假设全身性自动调节机制在侧支两端维持恒定的压降。在一次急性血管舒张反应中，血管长度和血液粘度保持不变，因此唯一可以改变的参数是血管半径。请从圆柱形管中层流的Hagen–Poiseuille定律出发，并利用所述的生理学约束条件，确定为使流向受影响的MCA皮质支的体积流量加倍，所需的侧支血管半径的最小分数增加量是多少。\n\n最终答案以小数形式表示，不带百分号，并四舍五入到四位有效数字。", "solution": "该皮质支由软脑膜侧支循环供血，这些侧支循环可以通过扩张来增加血流量。根据所给的假设，适用的基本定律是关于牛顿流体在刚性圆柱形管中层流的Hagen–Poiseuille定律。通过半径为$r$、长度为$L$的血管，在压降为$\\Delta P$、动力粘度为$\\mu$的条件下，其体积流量$Q$为\n$$\nQ \\;=\\; \\frac{\\pi \\,\\Delta P\\, r^{4}}{8\\, \\mu\\, L}.\n$$\n在该生理情景中，压降$\\Delta P$由全身性自动调节机制和Willis环维持恒定，血液粘度$\\mu$在反应的时间尺度上被视为常数，血管长度$L$是固定的。因此，唯一变化的参数是半径$r$。\n\n设$Q_{\\text{old}}$和$r_{\\text{old}}$表示初始流量和半径，$Q_{\\text{new}}$和$r_{\\text{new}}$表示扩张后的流量和半径。当$\\Delta P$、$\\mu$和$L$保持不变时，对Hagen–Poiseuille表达式取比值，可得\n$$\n\\frac{Q_{\\text{new}}}{Q_{\\text{old}}}\n\\;=\\;\n\\left( \\frac{r_{\\text{new}}}{r_{\\text{old}}} \\right)^{4}.\n$$\n我们需要求出使流量加倍（即达到$Q_{\\text{new}}/Q_{\\text{old}} = 2$）所需的半径的最小分数增加量。令\n$$\n2 \\;=\\; \\left( \\frac{r_{\\text{new}}}{r_{\\text{old}}} \\right)^{4}.\n$$\n解出半径比，可得\n$$\n\\frac{r_{\\text{new}}}{r_{\\text{old}}} \\;=\\; 2^{1/4}.\n$$\n半径的分数增加量$\\delta$定义为\n$$\n\\delta \\;=\\; \\frac{r_{\\text{new}} - r_{\\text{old}}}{r_{\\text{old}}}\n\\;=\\;\n\\frac{r_{\\text{new}}}{r_{\\text{old}}} - 1\n\\;=\\;\n2^{1/4} - 1.\n$$\n这是一个无量纲的量。为了提供所要求的数值，计算$2^{1/4}$并将最终的小数结果四舍五入到四位有效数字：\n$$\n2^{1/4} \\approx 1.189207115\\quad \\Rightarrow \\quad \\delta \\approx 1.189207115 - 1 = 0.189207115.\n$$\n四舍五入到四位有效数字，最小分数增加量为\n$$\n0.1892.\n$$", "answer": "$$\\boxed{0.1892}$$", "id": "5095705"}, {"introduction": "神经系统疾病的诊断过程如同侦探工作，医生需要根据患者的临床症状（证据）来推断病变的精确位置。了解不同血管供应区域的功能解剖是这项工作的基石。本练习将引导你运用贝叶斯定理，将关于特定中风类型发生率的先验知识与患者的具体症状相结合，从而计算出最可能的病变部位[@problem_id:5095773]。这不仅是对解剖知识的考验，更是对临床决策中概率思维能力的锻炼。", "problem": "一名患者表现出一系列与脑干定位一致的体征：对侧纯运动性偏瘫且无感觉丧失、与外展神经核受累一致的同侧水平凝视麻痹，以及构音障碍。由基底动脉旁正中穿支供血的脑桥内侧（旁正中）区域包含皮质脊髓束和外展神经核，通常被认为与这种模式有关；而由环状分支供血的脑桥外侧区域更常影响脊髓丘脑束和三叉神经系统，导致感觉缺陷而非孤立的运动体征。\n\n根据一个精心整理的基底动脉区域缺血事件登记库，脑桥分支的先验闭塞率如下：旁正中脑桥穿支，每$1000$次事件中$14$次；环状脑桥分支，每$1000$次事件中$26$次。在一项将血管区域与床旁检查相关联的高阶临床系列研究中，若病灶位于旁正中脑桥，观察到所述体征模式的概率为$0.76$；而若病灶位于外侧脑桥，观察到相同模式的概率为$0.10$。\n\n假设病灶局限于脑桥，并且上述两个区域穷尽了脑桥的所有可能性，请使用适当的贝叶斯推理，计算在给定观察到的体征和陈述的先验概率的情况下，病灶定位于旁正中脑桥的后验概率。将最终答案表示为四舍五入到四位有效数字的小数。", "solution": "此问题要求应用贝叶斯定理，根据临床证据更新病灶位置的概率。\n\n我们定义以下事件：\n-   $M$：缺血性病灶位于旁正中脑桥的事件。\n-   $L$：缺血性病灶位于外侧脑桥的事件。\n-   $D$：患者表现出所述体征（数据）的事件。\n\n我们需要求解的是后验概率 $P(M|D)$，即在观察到所述体征的情况下，病灶位于旁正中区域的概率。\n\n第一步，我们确定病灶位置的先验概率，$P(M)$ 和 $P(L)$。问题陈述了旁正中和外侧脑桥分支的闭塞率分别为每$1000$次基底动脉区域事件中的$14$次和$26$次。由于假设病灶局限于脑桥，并且这两个区域是穷尽的，我们需要将这些比率归一化。\n\n脑桥事件的总相对频率为 $14 + 26 = 40$。\n因此，旁正中病灶的先验概率为：\n$$P(M) = \\frac{14}{14+26} = \\frac{14}{40} = 0.35$$\n外侧病灶的先验概率为：\n$$P(L) = \\frac{26}{14+26} = \\frac{26}{40} = 0.65$$\n作为检验，$P(M) + P(L) = 0.35 + 0.65 = 1.0$。\n\n第二步，我们识别问题中给出的条件概率（似然）：\n-   给定旁正中病灶，观察到体征的概率：$P(D|M) = 0.76$。\n-   给定外侧病灶，观察到体征的概率：$P(D|L) = 0.10$。\n\n第三步，应用贝叶斯定理来求解后验概率 $P(M|D)$：\n$$P(M|D) = \\frac{P(D|M)P(M)}{P(D)}$$\n其中，分母 $P(D)$ 是观察到该体征的总概率，可使用全概率定律计算：\n$$P(D) = P(D|M)P(M) + P(D|L)P(L)$$\n将数值代入公式：\n$$P(M|D) = \\frac{P(D|M)P(M)}{P(D|M)P(M) + P(D|L)P(L)}$$\n$$P(M|D) = \\frac{(0.76)(0.35)}{(0.76)(0.35) + (0.10)(0.65)}$$\n计算各项乘积：\n$$P(M|D) = \\frac{0.266}{0.266 + 0.065} = \\frac{0.266}{0.331}$$\n进行最后的除法运算：\n$$P(M|D) \\approx 0.80362537764...$$\n根据要求，将结果四舍五入到四位有效数字，得到：\n$$P(M|D) \\approx 0.8036$$\n因此，在给定临床表现的情况下，病灶位于旁正中脑桥的后验概率约为$0.8036$。", "answer": "$$\\boxed{0.8036}$$", "id": "5095773"}, {"introduction": "在现代神经病学中，评估中风损伤不仅要定位病变，还需要精确量化其范围，这对判断预后和指导治疗至关重要。脑灌注成像等先进技术可以测量脑血流量（CBF），为我们提供了量化缺血损伤的工具。本练习模拟了神经放射学中的一项核心任务：根据三维脑血流量数据计算梗死组织的体积[@problem_id:5095706]。你需要将一个临床定义（梗死组织是指CBF低于特定阈值的区域）转化为一个具体的计算步骤，从而将解剖区域、生理阈值和定量分析联系起来。", "problem": "一个三维脑图像被离散化为边长为 $2\\,\\mathrm{mm}$ 的全等体素，每个体素代表一个长方体，其体积遵循立方体的几何体积公式。大脑中动脉（MCA）的皮质区域由同一网格上的一个二值掩码表示，其中掩码值为 $1$ 表示属于 MCA 皮质区域，值为 $0$ 表示不属于。在同一网格上定义了一个相应的脑血流量（CBF）值数组，单位为 $\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$。使用离散空间中集合体积的定义（即其组成体素的体积之和），从第一性原理推导一个算法，用于计算 MCA 皮质区域内的梗死体积。该梗死体积定义为同时满足以下两个条件的体素的总体积：属于 MCA 皮质区域，且满足血流动力学阈值 $CBF < 18\\,\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$。使用以下基本事实：(i) 边长为 $a$ 的立方体体积是 $a^3$，以及 (ii) $1\\,\\mathrm{cm}^3=1\\,\\mathrm{mL}$ 且 $1\\,\\mathrm{cm}=10\\,\\mathrm{mm}$。最终梗死体积以 $\\mathrm{mL}$ 为单位表示，并四舍五入到三位小数。\n\n您的程序必须为以下测试套件实现此计算。每个测试用例包含一个 CBF 数组和一个二值 MCA 掩码数组，两者形状相同，并沿第三维度以切片形式给出。所有与阈值的比较必须是严格小于（恰好等于阈值的值不应被计算在内）。\n\n测试用例 $1$（形状 $2\\times 2\\times 2$）：\n- CBF 切片（单位：$\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$）：\n  - $z=0$: $\\begin{bmatrix}25  12 \\\\ 30  17\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}40  22 \\\\ 15  10\\end{bmatrix}$\n- MCA 掩码切片：\n  - $z=0$: $\\begin{bmatrix}1  1 \\\\ 0  1\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}1  0 \\\\ 1  1\\end{bmatrix}$\n\n测试用例 $2$（形状 $2\\times 2\\times 2$；阈值 $18$ 附近的边界值）：\n- CBF 切片（单位：$\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$）：\n  - $z=0$: $\\begin{bmatrix}18  18 \\\\ 17.9  18.1\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}5  50 \\\\ 18  17.999\\end{bmatrix}$\n- MCA 掩码切片：\n  - $z=0$: $\\begin{bmatrix}1  1 \\\\ 1  1\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}1  1 \\\\ 1  1\\end{bmatrix}$\n\n测试用例 $3$（形状 $2\\times 2\\times 2$；存在低 CBF 值，但位于 MCA 掩码之外）：\n- CBF 切片（单位：$\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$）：\n  - $z=0$: $\\begin{bmatrix}10  16 \\\\ 12  14\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}7  9 \\\\ 19  20\\end{bmatrix}$\n- MCA 掩码切片：\n  - $z=0$: $\\begin{bmatrix}0  0 \\\\ 0  0\\end{bmatrix}$\n  - $z=1$: $\\begin{bmatrix}0  0 \\\\ 1  1\\end{bmatrix}$\n\n测试用例 $4$（形状 $3\\times 3\\times 1$）：\n- 在 $z=0$ 处的 CBF 切片（单位：$\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$）：\n  $\\begin{bmatrix}10  20  17 \\\\ 18  18.0  16 \\\\ 30  12  22\\end{bmatrix}$\n- 在 $z=0$ 处的 MCA 掩码切片：\n  $\\begin{bmatrix}1  1  1 \\\\ 1  0  1 \\\\ 1  1  0\\end{bmatrix}$\n\n要求：\n- 使用严格阈值 $CBF < 18$；不包括 $CBF=18$ 的体素。\n- 每个体素的边长为 $2\\,\\mathrm{mm}$。\n- 将每个计算出的梗死体积以 $\\mathrm{mL}$ 为单位表示，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含四个测试用例的结果，格式为方括号内的逗号分隔列表，例如 $[v_1,v_2,v_3,v_4]$，其中每个 $v_i$ 是以 $\\mathrm{mL}$ 为单位且四舍五入到三位小数的浮点数。", "solution": "该问题是有效的。它在科学上基于神经影像分析的原理，问题陈述清晰，提供了所有必要的数据和明确的客观标准，并且内部一致。\n\n主要目标是计算大脑中动脉（MCA）皮质区域内的梗死组织总体积。该体积定义为满足两个并行条件的所有体素的体积之和：\n1. 体素必须属于 MCA 皮质区域，即其掩码值为 $1$。\n2. 体素的脑血流量（CBF）必须低于一个关键的血流动力学阈值，具体为 $CBF < 18\\,\\mathrm{mL}/100\\mathrm{g}/\\mathrm{min}$。\n\n我们首先确定单个体素的体积。问题陈述中说明，每个体素是一个全等的长方体，边长为 $a = 2\\,\\mathrm{mm}$。其体积使用立方体公式 $v_{voxel} = a^3$ 计算。\n$$v_{voxel} = (2\\,\\mathrm{mm})^3 = 8\\,\\mathrm{mm}^3$$\n\n最终结果必须以毫升（$\\mathrm{mL}$）表示。我们已知基本换算关系 $1\\,\\mathrm{cm} = 10\\,\\mathrm{mm}$ 和 $1\\,\\mathrm{cm}^3 = 1\\,\\mathrm{mL}$。由此，我们推导出立方毫米和毫升之间的换算因子。\n$$1\\,\\mathrm{cm} = 10\\,\\mathrm{mm}$$\n将方程两边同时立方，得到体积关系：\n$$(1\\,\\mathrm{cm})^3 = (10\\,\\mathrm{mm})^3$$\n$$1\\,\\mathrm{cm}^3 = 1000\\,\\mathrm{mm}^3$$\n鉴于 $1\\,\\mathrm{cm}^3 = 1\\,\\mathrm{mL}$，可直接得出：\n$$1\\,\\mathrm{mL} = 1000\\,\\mathrm{mm}^3$$\n因此，单个体素的体积（以毫升为单位）是：\n$$v_{voxel} (\\mathrm{in~mL}) = 8\\,\\mathrm{mm}^3 \\times \\frac{1\\,\\mathrm{mL}}{1000\\,\\mathrm{mm}^3} = 0.008\\,\\mathrm{mL}$$\n\n一个用于计算总梗死体积 $V_{infarct}$ 的算法可以从这些第一性原理推导出来。设三维体素网格的索引为 $(i, j, k)$。设 $C_{ijk}$ 为位于 $(i, j, k)$ 的体素的 CBF 值，$M_{ijk}$ 为其 MCA 掩码值。一个体素对梗死体积有贡献，当且仅当 $C_{ijk} < 18$ 且 $M_{ijk} = 1$。\n\n我们可以为每个体素定义一个二值指示函数 $\\mathbb{I}_{infarct}(i, j, k)$：\n$$\n\\mathbb{I}_{infarct}(i, j, k) =\n\\begin{cases}\n1  \\text{若 } C_{ijk} < 18 \\text{ 且 } M_{ijk} = 1 \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n梗死体素的总数 $N_{infarct}$ 是该指示函数在网格中所有体素上的总和：\n$$N_{infarct} = \\sum_{i,j,k} \\mathbb{I}_{infarct}(i,j,k)$$\n总梗死体积即为梗死体素数量与单个体素体积的乘积：\n$$V_{infarct} = N_{infarct} \\times v_{voxel} = N_{infarct} \\times 0.008\\,\\mathrm{mL}$$\n\n现在我们将此算法应用于每个测试用例。\n\n**测试用例 1：**\n-   我们找出 MCA 掩码为 $1$ 且 CBF 小于 $18$ 的体素。\n-   在 $z=0$ 时：CBF 值为 $\\begin{bmatrix}25  12 \\\\ 30  17\\end{bmatrix}$，MCA 掩码为 $\\begin{bmatrix}1  1 \\\\ 0  1\\end{bmatrix}$。满足标准的体素位于位置 $(0,1)$（CBF $12$）和 $(1,1)$（CBF $17$）。这得到 $2$ 个体素。\n-   在 $z=1$ 时：CBF 值为 $\\begin{bmatrix}40  22 \\\\ 15  10\\end{bmatrix}$，MCA 掩码为 $\\begin{bmatrix}1  0 \\\\ 1  1\\end{bmatrix}$。满足标准的体素位于位置 $(1,0)$（CBF $15$）和 $(1,1)$（CBF $10$）。这得到 $2$ 个体素。\n-   $N_{infarct} = 2 + 2 = 4$。\n-   $V_{infarct} = 4 \\times 0.008\\,\\mathrm{mL} = 0.032\\,\\mathrm{mL}$。\n\n**测试用例 2：**\n-   所有体素的 MCA 掩码均为 $1$，因此我们只需计算 $CBF < 18$ 的体素数量。\n-   CBF 值为 $18, 18, 17.9, 18.1, 5, 50, 18, 17.999$。\n-   严格小于 $18$ 的值是 $17.9$、$5$ 和 $17.999$。\n-   $N_{infarct} = 3$。\n-   $V_{infarct} = 3 \\times 0.008\\,\\mathrm{mL} = 0.024\\,\\mathrm{mL}$。\n\n**测试用例 3：**\n-   我们找出 MCA 掩码为 $1$ 且 CBF 小于 $18$ 的体素。\n-   在 $z=0$ 时：MCA 掩码全为 $0$，因此无论 CBF 值如何，都没有体素满足标准。这得到 $0$ 个体素。\n-   在 $z=1$ 时：MCA 掩码为 $\\begin{bmatrix}0  0 \\\\ 1  1\\end{bmatrix}$。我们只考虑底部的两个体素。它们的 CBF 值是 $19$ 和 $20$。两者都不小于 $18$。这得到 $0$ 个体素。\n-   $N_{infarct} = 0 + 0 = 0$。\n-   $V_{infarct} = 0 \\times 0.008\\,\\mathrm{mL} = 0.000\\,\\mathrm{mL}$。\n\n**测试用例 4：**\n-   网格在 $z=0$ 处只有一个切片。CBF 为 $\\begin{bmatrix}10  20  17 \\\\ 18  18.0  16 \\\\ 30  12  22\\end{bmatrix}$，MCA 掩码为 $\\begin{bmatrix}1  1  1 \\\\ 1  0  1 \\\\ 1  1  0\\end{bmatrix}$。\n-   我们检查每个掩码为 $1$ 的元素：\n    -   (0,0): CBF $10 < 18$，掩码 $1$。是。\n    -   (0,1): CBF $20 \\not 18$。否。\n    -   (0,2): CBF $17  18$，掩码 $1$。是。\n    -   (1,0): CBF $18 \\not 18$。否。\n    -   (1,1): 掩码为 $0$。否。\n    -   (1,2): CBF $16  18$，掩码 $1$。是。\n    -   (2,0): CBF $30 \\not 18$。否。\n    -   (2,1): CBF $12  18$，掩码 $1$。是。\n    -   (2,2): 掩码为 $0$。否。\n-   $N_{infarct} = 4$。\n-   $V_{infarct} = 4 \\times 0.008\\,\\mathrm{mL} = 0.032\\,\\mathrm{mL}$。\n\n最终结果四舍五入到三位小数后为 $0.032$、$0.024$、$0.000$ 和 $0.032$。请注意，将 $0.000$ 四舍五入到三位小数在标准浮点表示中仅得出 $0.0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes infarct volume for a set of test cases based on CBF and MCA mask data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (shape 2x2x2)\n        (\n            np.array([[[25, 12], [30, 17]], [[40, 22], [15, 10]]]), # CBF\n            np.array([[[1, 1], [0, 1]], [[1, 0], [1, 1]]])  # MCA mask\n        ),\n        # Test case 2 (shape 2x2x2)\n        (\n            np.array([[[18, 18], [17.9, 18.1]], [[5, 50], [18, 17.999]]]), # CBF\n            np.array([[[1, 1], [1, 1]], [[1, 1], [1, 1]]])  # MCA mask\n        ),\n        # Test case 3 (shape 2x2x2)\n        (\n            np.array([[[10, 16], [12, 14]], [[7, 9], [19, 20]]]), # CBF\n            np.array([[[0, 0], [0, 0]], [[0, 0], [1, 1]]])  # MCA mask\n        ),\n        # Test case 4 (shape 3x3x1)\n        (\n            np.array([[[10, 20, 17], [18, 18.0, 16], [30, 12, 22]]]), # CBF\n            np.array([[[1, 1, 1], [1, 0, 1], [1, 1, 0]]])  # MCA mask\n        ),\n    ]\n\n    # --- Calculation based on first principles ---\n\n    # 1. Voxel volume calculation\n    # Voxel edge length in millimeters, as given.\n    voxel_edge_mm = 2\n    # Volume of a single voxel in cubic millimeters (a^3).\n    voxel_vol_mm3 = voxel_edge_mm ** 3  # (2 mm)^3 = 8 mm^3\n\n    # 2. Unit conversion\n    # Conversion from cubic millimeters to milliliters.\n    # 1 cm = 10 mm = 1 cm^3 = 1000 mm^3.\n    # 1 cm^3 = 1 mL.\n    # Therefore, 1 mL = 1000 mm^3.\n    voxel_vol_ml = voxel_vol_mm3 / 1000.0  # 8 / 1000 = 0.008 mL\n\n    # 3. CBF threshold\n    # The hemodynamic threshold for infarct, as defined in the problem.\n    cbf_threshold = 18.0\n\n    results = []\n    for cbf_data, mca_mask in test_cases:\n        # --- Algorithm for Infarct Volume Computation ---\n\n        # Create a boolean mask for voxels with CBF below the threshold.\n        # The comparison must be strictly less than.\n        is_low_cbf = cbf_data  cbf_threshold\n\n        # Create a boolean mask for voxels within the MCA territory.\n        # The input MCA mask is already binary (0 or 1).\n        is_in_mca = mca_mask.astype(bool)\n\n        # Combine the two conditions using a logical AND operation.\n        # A voxel is considered part of the infarct if it is in the MCA\n        # territory AND has a low CBF value.\n        infarct_mask = np.logical_and(is_low_cbf, is_in_mca)\n\n        # Count the total number of voxels that satisfy both conditions.\n        infarct_voxel_count = np.sum(infarct_mask)\n\n        # Calculate the total infarct volume by multiplying the count by\n        # the volume of a single voxel.\n        total_infarct_volume_ml = infarct_voxel_count * voxel_vol_ml\n        \n        # Round the final volume to three decimal places as required.\n        rounded_volume = round(total_infarct_volume_ml, 3)\n        results.append(rounded_volume)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) handles cases like 0.0 correctly.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "5095706"}]}