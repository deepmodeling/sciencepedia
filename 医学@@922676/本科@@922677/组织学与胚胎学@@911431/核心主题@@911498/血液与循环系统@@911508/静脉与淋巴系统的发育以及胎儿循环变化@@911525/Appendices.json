{"hands_on_practices": [{"introduction": "在胎儿循环中，静脉导管扮演着至关重要的角色，它将来自脐静脉的富氧血液直接分流至心脏，从而绕过肝脏的代谢。理解血液如何在这条“捷径”与肝脏血窦之间分配，是掌握胎儿生理学的关键。本练习将复杂的生物系统简化为一个并联电阻电路模型 [@problem_id:4881700]，旨在阐明血流动力学阻力如何决定血液在平行通路中的分布，这是生物物理学中一个强有力的分析工具。", "problem": "在胎儿循环中，含氧血通过脐静脉回流，在到达下腔静脉和右心房之前，分流至两条并联通路：(i) 直接通过静脉导管（一条绕过肝血窦的血管分流），以及 (ii) 通过肝脏内的肝血窦。在一个稳态血流动力学模型中，每条通路都由一个纯阻力表示。假设流动为层流、不可压缩流，且顺应性和惯性效应可忽略不计。设脐静脉入口处的压力为 $P_{u}$，两条通路下游汇合处的压力为 $P_{d}$，因此两条通路都承受相同的压降 $\\Delta P = P_{u} - P_{d}$。通过阻力通路的体积流量遵循血流动力学中的欧姆定律类似物，$Q = \\Delta P / R$，并且在交汇处流量守恒。\n\n假设静脉导管通路的阻力为 $R_{\\mathrm{DV}} = 0.4 R$，肝血窦通路的阻力为 $R_{\\mathrm{hepatic}} = 0.6 R$，其中 $R > 0$ 是一个任意的正参考阻力。仅使用这些假设，并从给定的基本关系出发，推导通过静脉导管分流的总脐静脉血流分数与灌注肝血窦的分数。\n\n请将最终答案表示为一个无量纲分数的行矩阵 $\\begin{pmatrix} f_{\\mathrm{DV}}  f_{\\mathrm{hepatic}} \\end{pmatrix}$，其中 $f_{\\mathrm{DV}}$ 是通过静脉导管的分数，$f_{\\mathrm{hepatic}}$ 是通过肝血窦的分数。无需四舍五入。", "solution": "该问题具有科学依据，提法恰当且客观。它提出了一个标准的流体动力学问题，类似于并联电路，并应用于一个简化但生理上正确的胎儿循环模型。所有必要的数据和控制原理都已提供，不存在矛盾之处。因此，该问题是有效的，并将推导求解。\n\n问题描述了两条并联的血流动力学通路：静脉导管 (DV) 和肝血窦。来自脐静脉的总体积流量，记为 $Q_{\\mathrm{total}}$，在这两条通路之间分流。设 $Q_{\\mathrm{DV}}$ 为通过静脉导管的流量，$Q_{\\mathrm{hepatic}}$ 为通过肝血窦的流量。根据流量守恒原理（对于不可压缩流体即质量守恒），进入交汇处的总流量必须等于流出的总流量。\n$$Q_{\\mathrm{total}} = Q_{\\mathrm{DV}} + Q_{\\mathrm{hepatic}}$$\n问题指出，两条通路都承受相同的压降 $\\Delta P = P_{u} - P_{d}$。通过每个阻力通路的流量遵循血流动力学中的欧姆定律类似物，$Q = \\Delta P / R$。将此关系应用于每条通路可得：\n$$Q_{\\mathrm{DV}} = \\frac{\\Delta P}{R_{\\mathrm{DV}}}$$\n$$Q_{\\mathrm{hepatic}} = \\frac{\\Delta P}{R_{\\mathrm{hepatic}}}$$\n其中 $R_{\\mathrm{DV}}$ 和 $R_{\\mathrm{hepatic}}$ 分别是静脉导管通路和肝脏通路的阻力。\n\n我们可以用共同的压降 $\\Delta P$ 和各自的阻力来表示总流量 $Q_{\\mathrm{total}}$：\n$$Q_{\\mathrm{total}} = \\frac{\\Delta P}{R_{\\mathrm{DV}}} + \\frac{\\Delta P}{R_{\\mathrm{hepatic}}} = \\Delta P \\left( \\frac{1}{R_{\\mathrm{DV}}} + \\frac{1}{R_{\\mathrm{hepatic}}} \\right)$$\n这可以通过通分来简化：\n$$Q_{\\mathrm{total}} = \\Delta P \\left( \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}} \\right)$$\n该关系表明，总流量通过并联组合的等效阻力 $R_{\\mathrm{eq}} = \\frac{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$ 与压降相关。\n\n目标是求出通过每条通路的总流量分数。通过静脉导管的流量分数 $f_{\\mathrm{DV}}$ 是通过静脉导管的流量与总流量之比：\n$$f_{\\mathrm{DV}} = \\frac{Q_{\\mathrm{DV}}}{Q_{\\mathrm{total}}}$$\n代入 $Q_{\\mathrm{DV}}$ 和 $Q_{\\mathrm{total}}$ 的表达式：\n$$f_{\\mathrm{DV}} = \\frac{\\frac{\\Delta P}{R_{\\mathrm{DV}}}}{\\Delta P \\left( \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}} \\right)} = \\frac{1}{R_{\\mathrm{DV}}} \\cdot \\frac{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\n简化此表达式可得到两条并联阻力通路中一条的流量分数通用公式：\n$$f_{\\mathrm{DV}} = \\frac{R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\n类似地，通过肝脏通路的流量分数 $f_{\\mathrm{hepatic}}$ 为：\n$$f_{\\mathrm{hepatic}} = \\frac{Q_{\\mathrm{hepatic}}}{Q_{\\mathrm{total}}} = \\frac{\\frac{\\Delta P}{R_{\\mathrm{hepatic}}}}{\\Delta P \\left( \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}} \\right)} = \\frac{1}{R_{\\mathrm{hepatic}}} \\cdot \\frac{R_{\\mathrm{DV}} R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\n$$f_{\\mathrm{hepatic}} = \\frac{R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}}$$\n注意，$f_{\\mathrm{DV}} + f_{\\mathrm{hepatic}} = \\frac{R_{\\mathrm{hepatic}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}} + \\frac{R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}} = \\frac{R_{\\mathrm{hepatic}} + R_{\\mathrm{DV}}}{R_{\\mathrm{DV}} + R_{\\mathrm{hepatic}}} = 1$，这符合流量守恒的要求。\n\n问题提供了具体的阻力值：$R_{\\mathrm{DV}} = 0.4 R$ 和 $R_{\\mathrm{hepatic}} = 0.6 R$，其中 $R$ 是一个正的参考阻力。我们将这些值代入推导出的分数表达式中。\n\n对于静脉导管的分数：\n$$f_{\\mathrm{DV}} = \\frac{0.6 R}{0.4 R + 0.6 R} = \\frac{0.6 R}{1.0 R} = 0.6$$\n这可以表示为精确分数 $\\frac{3}{5}$。\n\n对于肝血窦的分数：\n$$f_{\\mathrm{hepatic}} = \\frac{0.4 R}{0.4 R + 0.6 R} = \\frac{0.4 R}{1.0 R} = 0.4$$\n这可以表示为精确分数 $\\frac{2}{5}$。\n\n因此，$60\\%$ 的脐静脉血流通过阻力较低的静脉导管分流，而 $40\\%$ 则灌注阻力较高的肝血窦。最终答案应表示为行矩阵 $\\begin{pmatrix} f_{\\mathrm{DV}}  f_{\\mathrm{hepatic}} \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6  0.4 \\end{pmatrix}}$$", "id": "4881700"}, {"introduction": "从静态模型转向动态的临床评估，多普勒超声技术使我们能够无创地测量血流速度，从而窥探胎儿的心血管健康状况。静脉导管内的血流模式是反映胎儿心脏功能的敏感指标。本练习要求您运用血流动力学的基本原理——即压力梯度驱动血流——来解读真实的临床波形 [@problem_id:4881865]。掌握这项技能有助于连接教科书中的生理学知识与临床诊断推理，是理论联系实际的重要一步。", "problem": "一名妊娠 $30$ 周的胎儿因疑似充血性心力衰竭（CHF）接受评估。胎儿超声心动图（FE）显示中度三尖瓣反流和右心房压力（RAP）升高。超声医师获取了高质量的静脉导管（DV）多普勒图谱，采样容积置于静脉导管的狭窄部，声束入射角保持在接近 $0^{\\circ}$，以最大程度地保证测量保真度。静脉导管（DV）是一个胚胎期形成的分流通道，在妊娠早期形成，将含氧的脐静脉血直接引入下腔静脉（IVC），绕过肝窦。它通常表现出与心动周期同步的三相前向血流模式，包括 $S$ 波（心室收缩期）、$D$ 波（舒张早期）和 $a$ 波（心房收缩期）。\n\n运用血液动力学和多普勒测量的基本原理，预测 RAP 升高会如何改变 DV 多普勒波形，并识别在这种情况下最能特异性地指示胎儿心脏功能障碍的模式。\n\n您可以使用的基本原理：\n- 在通过柔顺血管的低雷诺数层流中，容积流量 $Q$ 由压力梯度 $\\Delta P$ 驱动，并且在短时间尺度内对于固定的几何形状，平均速度 $v$ 通过 $v = Q/A$ 和 $Q \\propto \\Delta P$ 与 $\\Delta P$ 成比例，其中 $A$ 是横截面积。\n- 多普勒频移 $f_D$ 与血流速度 $v$ 成正比，其关系为 $f_D = \\dfrac{2 f_0 v \\cos\\theta}{c}$，其中 $f_0$ 是发射频率，$\\theta$ 是声束入射角， $c$ 是组织中的声速。\n- 流入右心房的静脉血流时相性变化反映了下游压力的周期性变化：在心室收缩期和舒张早期，右心房压力下降，增加了 $\\Delta P$ 和前向血流（$S$ 波和 $D$ 波）；而在心房收缩期，右心房压力上升，减小了 $\\Delta P$ 并削弱了 $a$ 波。\n\n哪个选项最能描述 RAP 升高时预期的 DV 波形变化及其解释？\n\nA. DV 波形搏动性增强，$a$ 波振幅减小，可能缺失或短暂反向，同时 $S$ 波和 $D$ 波的前向血流速度减慢；这种模式表明前向静脉回流受损，是胎儿心脏功能障碍（如三尖瓣反流）的特征。\n\nB. DV 波形搏动性减弱，$a$ 波因心房收缩增强而前向血流增加，同时 $S$ 波和 $D$ 波的速度增加；这种模式表明尽管 RAP 升高，但前负荷和心脏性能得到改善。\n\nC. DV 波形保持不变，因为肝窦和 DV 括约肌完全缓冲了右心房压力的变化，使 DV 血流与中心静脉动力学隔离。\n\nD. DV 波形在所有时相都变得连续、无搏动且高速，因为下游右心房压力升高会一致地增加通过 DV 的血流，这是心输出量代偿的指标。\n\nE. DV 波形表现为 $S$ 波反向，而 $a$ 波保持正常；这种模式特异性地表示孤立的收缩功能障碍，而不影响心房收缩。", "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n\n1.  **对象：** 一名妊娠 $30$ 周的胎儿。\n2.  **临床背景：** 疑似充血性心力衰竭（CHF）。\n3.  **具体发现：** 胎儿超声心动图（FE）显示中度三尖瓣反流和右心房压力（RAP）升高。\n4.  **测量：** 静脉导管（DV）多普勒图谱。\n5.  **测量技术：** 采样容积置于 DV 的狭窄部；声束入射角接近 $0^{\\circ}$。\n6.  **DV 定义：** 一个胚胎期形成的分流通道，将含氧的脐静脉血引入下腔静脉（IVC），绕过肝窦。\n7.  **正常 DV 血流：** 具有 $S$ 波（心室收缩期）、$D$ 波（舒张早期）和 $a$ 波（心房收缩期）的三相前向血流模式。\n8.  **问题：** 预测 RAP 升高引起的 DV 多普勒波形改变，并识别最能特异性指示胎儿心脏功能障碍的模式。\n9.  **提供的基本原理：**\n    *   容积流量 $Q$ 由压力梯度 $\\Delta P$ 驱动。对于固定的几何形状，平均速度 $v$ 与 $\\Delta P$ 成比例（$v = Q/A$ 且 $Q \\propto \\Delta P$）。\n    *   多普勒频移 $f_D$ 通过 $f_D = \\dfrac{2 f_0 v \\cos\\theta}{c}$ 与血流速度 $v$ 成正比。\n    *   流入右心房的静脉血流时相性变化由 RAP 的周期性变化解释：\n        *   在心室收缩期（$S$ 波）和舒张早期（$D$ 波）期间，RAP 下降，增加 $\\Delta P$ 和前向血流。\n        *   在心房收缩期（$a$ 波）期间，RAP 上升，减小 $\\Delta P$ 并削弱前向血流。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n1.  **科学依据：** 该问题牢固地植根于胎儿心血管生理学、血液动力学和多普勒超声物理学的既定原理。所有概念，包括充血性心力衰竭、三尖瓣反流、静脉导管以及心动周期对静脉血流的影响，在心脏病学和产科学领域都是标准且符合事实的。\n2.  **问题定义明确：** 该问题提供了一个清晰的初始状态（正常的 DV 血流动力学），引入了一个特定的病理变化（RAP 升高），并要求根据所提供的基本原理预测其后果。这种结构允许推导出一个唯一且有意义的解决方案。\n3.  **客观性：** 语言技术性强、精确，没有主观或含糊的术语。“右心房压力升高”是一个可量化的临床发现。\n4.  **完整性与一致性：** 该问题是自洽的。提供的“基本原理”足以从逻辑上解决问题。没有内部矛盾。\n5.  **现实性：** 临床场景——通过 DV 多普勒评估伴有三尖瓣反流和 RAP 升高的胎儿 CHF——是产前超声的一个现实且重要的应用。\n\n### 步骤 3：结论与行动\n\n问题陈述在科学上是合理的，问题定义明确，客观且完整。这是一个可以使用所提供原理解决的有效问题。\n\n## 解题推导\n\n分析将从提供的基本原理出发。\n\n1.  **速度与压力的关系：** 多普勒波形显示了血流速度（$v$）随时间的变化。根据所提供的原理，速度与容积流速成正比（$v = Q/A$），而流速与压力梯度成正比（$Q \\propto \\Delta P$）。因此，静脉导管中的血流速度与脐静脉（上游）和右心房（下游）之间的压力梯度成正比。设 $P_{UV}$ 为脐静脉压力，$\\text{RAP}(t)$ 为随时间变化的右心房压力。\n    $$v(t) \\propto \\Delta P(t) = P_{UV} - \\text{RAP}(t)$$\n    我们假设与心动周期中 $\\text{RAP}(t)$ 的快速时相性变化相比，$P_{UV}$ 相对稳定。因此，速度波形 $v(t)$ 本质上是右心房压力波形 $\\text{RAP}(t)$ 的一个反向和缩放的表示。\n\n2.  **正常 DV 波形的产生：** 我们将上述原理应用于正常的心动周期。\n    *   **S 波和 D 波（收缩期和舒张早期）：** 在这些时相，右心房舒张和充盈。$\\text{RAP}(t)$ 较低。这使得压力梯度 $\\Delta P = P_{UV} - \\text{RAP}(t)$ 最大化，从而产生高速的前向血流峰值，即 $S$ 波和 $D$ 波。\n    *   **a 波（心房收缩期）：** 在舒张晚期，心房收缩（“心房搏”）。这导致 $\\text{RAP}(t)$ 的短暂飙升。$\\text{RAP}(t)$ 的升高减小了压力梯度 $\\Delta P$，导致前向血流速度出现一个最低点。这个最低点就是 $a$ 波。在健康的胎儿中，即使在峰值时，$\\text{RAP}(t)$ 仍低于 $P_{UV}$，所以 $a$ 波代表前向血流减少，但血流仍为正向（即 $v > 0$）。\n\n3.  **病理状态：右心房压力升高：** 问题陈述“右心房压力（RAP）升高”。这意味着整个 $\\text{RAP}(t)$ 波形向上平移到一个更高的基线压力。设 $\\text{RAP}_{elevated}(t) = \\text{RAP}_{normal}(t) + \\Delta P_{base}$，其中 $\\Delta P_{base}$ 是病理性增加的压力。\n\n4.  **预测改变后的波形：** 我们根据新的、升高的 $\\text{RAP}_{elevated}(t)$ 重新评估血流。\n    *   **对 S 波和 D 波的影响：** 由于整个周期内的平均 RAP 更高，平均压力梯度 $\\Delta P = P_{UV} - \\text{RAP}(t)$ 减小。较小的压力梯度导致较低的流速，从而导致较低的峰值速度。因此，$S$ 波和 $D$ 波的速度将会减小或“变钝”。这表示回心静脉血流受损。\n    *   **对 a 波的影响：** 这是最关键的部分。$a$ 波对应于心房收缩期间右心房的压力峰值。在正常状态下，$\\text{RAP}_{peak}  P_{UV}$。在病理性升高的基线压力下，心房收缩期间的压力峰值更有可能接近甚至超过上游的脐静脉压力 $P_{UV}$。\n        *   如果 $\\text{RAP}_{peak}$ 上升到等于 $P_{UV}$，压力梯度 $\\Delta P$ 变为零，血流短暂停止。这导致 **a 波缺失**（速度降至 $0$）。\n        *   如果 $\\text{RAP}_{peak}$ 上升到超过 $P_{UV}$，压力梯度 $\\Delta P = P_{UV} - \\text{RAP}_{peak}$ 变为负值。负的压力梯度驱动血流反向——从右心房回到静脉导管。这导致 **a 波反向**（速度变为负值）。\n    *   **对搏动性的影响：** 在此背景下，搏动性指的是心动周期内速度的变化。通常使用像 $(S-a)/S$ 或 $(S-a)/D$ 这样的指数。当 $a$ 波速度减小、变为零或变为负值时，分子 $(S-a)$ 会显著增加。因此，波形变得更具搏动性。\n\n5.  **结论：** 在因心脏功能障碍（如所述的三尖瓣反流）导致 RAP 升高的胎儿中，DV 多普勒波形预计会显示变钝的 $S$ 波和 $D$ 波，以及减弱、缺失或反向的 $a$ 波。这种模式直接反映了心脏充盈受损和舒张末期压力过高。\n\n## 逐项分析\n\n**A. DV 波形搏动性增强，$a$ 波振幅减小，可能缺失或短暂反向，同时 $S$ 波和 $D$ 波的前向血流速度减慢；这种模式表明前向静脉回流受损，是胎儿心脏功能障碍（如三尖瓣反流）的特征。**\n-   **分析：** 该陈述准确描述了从基本原理推导出的所有后果：搏动性增强、病理性的 $a$ 波（减弱、缺失或反向）以及变钝的 $S$ 波和 $D$ 波。它正确地将此模式解释为静脉回流受损，并正确地将其与导致 RAP 升高的胎儿心脏功能障碍和三尖瓣反流联系起来。\n-   **结论：** **正确**。\n\n**B. DV 波形搏动性减弱，$a$ 波因心房收缩增强而前向血流增加，同时 $S$ 波和 $D$ 波的速度增加；这种模式表明尽管 RAP 升高，但前负荷和心脏性能得到改善。**\n-   **分析：** 这与推导出的结果相反。RAP 升高会阻碍血流，而不是增加血流。增加的 $S$ 波和 $D$ 波速度需要更低的 RAP，而不是更高的。对抗高压心室的更强心房收缩只会进一步增加 RAP 峰值，使 $a$ 波更可能反向，而不是“前向增加”。\n-   **结论：** **错误**。\n\n**C. DV 波形保持不变，因为肝窦和 DV 括约肌完全缓冲了右心房压力的变化，使 DV 血流与中心静脉动力学隔离。**\n-   **分析：** 这与使用 DV 多普勒进行心脏评估的基本前提相矛盾。问题指出 DV 绕过了肝窦，因此它们不是主要的缓冲器。更重要的是，这项测量的全部临床效用在于 DV 血流*并未*与中心静脉动力学隔离，而是可靠地反映了 RAP 的变化。提供的基本原理也明确地将静脉血流与 RAP 的变化联系起来。\n-   **结论：** **错误**。\n\n**D. DV 波形在所有时相都变得连续、无搏动且高速，因为下游右心房压力升高会一致地增加通过 DV 的血流，这是心输出量代偿的指标。**\n-   **分析：** 该陈述违反了基本的流体动力学。血流由压力*梯度*（$P_{上游} - P_{下游}$）驱动。增加下游压力（RAP）会*减小*这个梯度，从而*减少*血流和速度，而不是增加它们。此外，心功能的时相性确保了血流总是搏动性的，而不是连续的。\n-   **结论：** **错误**。\n\n**E. DV 波形表现为 $S$ 波反向，而 $a$ 波保持正常；这种模式特异性地表示孤立的收缩功能障碍，而不影响心房收缩。**\n-   **分析：** 这错误地识别了周期的各个部分。$S$ 波对应于心室收缩期，这是一个心房*充盈*和低 RAP 的时期。此处的反向是严重三尖瓣反流的迹象，但不是舒张末期压力升高的主要发现。对应于心房收缩的 $a$ 波是对基线和舒张末期压力升高最敏感的阶段。当 RAP 显著升高时，$a$ 波保持正常在生理上是不可能的。\n-   **结论：** **错误**。", "answer": "$$\\boxed{A}$$", "id": "4881865"}, {"introduction": "胎儿的循环系统在出生后会经历剧烈的重塑，其中静脉导管等胎儿特有分流通道会逐渐关闭并退化。这一过程并非被动发生，而是受到“力学生物学”原理的调控，即血流等物理力会影响组织的生长与退化。本计算练习将模拟出生后血流变化如何基于壁面切应力原理，导致不再需要的血管被“修剪”掉 [@problem_id:4881757]。通过这个实践，您将深入了解血管系统在适应新环境时的动态性与适应性。", "problem": "你的任务是建立一个基于层流血液动力学的最小化机械生物学剪枝模型，用于推断从胎儿循环过渡到新生儿循环过程中的血管退化。生物学观察发现，长期承受低壁面剪切应力的血管会趋于退化。你将使用一个时间平均壁面剪切应力阈值来决定一个小的、预定义的网络集合中的哪些血管段会发生退化。你的程序必须是完全确定性的，并生成一行输出，汇总所有测试用例的结果。\n\n需要使用的基本核心定义：\n- 在半径为 $R$、长度为 $L$ 的圆柱形血管中，对于稳态、充分发展、不可压缩的层流（Poiseuille 流），体积流率 $Q$ 和压降 $\\Delta P$ 遵循 $Q = \\dfrac{\\pi R^{4}}{8\\mu L}\\Delta P$，其中 $\\mu$ 是动力粘度。\n- 壁面剪切应力 (WSS) 定义为 $\\tau = \\mu \\left.\\dfrac{dv}{dr}\\right|_{r=R}$，其中 $v(r)$ 是轴向速度剖面。对于 Poiseuille 流，这得出了经过充分验证的公式 $\\tau = \\dfrac{4\\mu Q}{\\pi R^{3}}$。\n- 在均匀采样的时间序列 $\\{\\tau(t_{k})\\}_{k=1}^{K}$ 上的时间平均 WSS 为 $\\overline{\\tau} = \\dfrac{1}{K}\\sum_{k=1}^{K}\\tau(t_{k})$。\n- 剪枝标准：当且仅当一个血管段的时间平均 WSS 严格小于剪枝阈值 $\\tau_{\\mathrm{th}}$ (单位：帕斯卡) 时，该血管段被宣告退化。为确保数值鲁棒性，请使用绝对容差 $\\varepsilon = 10^{-12}$ 帕斯卡，即如果 $\\overline{\\tau}  \\tau_{\\mathrm{th}} - \\varepsilon$，则宣告退化。\n\n需严格遵循的实现细节：\n- 每个测试用例的输入被指定为一组索引为 $0,1,\\dots,N-1$ 的血管段，每个段都有一个半径 $r_{i}$（单位：米），一个共同的动力粘度 $\\mu$（单位：帕斯卡-秒），以及在一个由 $K$ 个均匀间隔的时刻 $t_{1},\\dots,t_{K}$ 采样的离散时间流序列 $Q_{i}(t_{k})$（单位：立方米/秒）。你必须在每个时间样本上计算 $\\tau_{i}(t_{k}) = \\dfrac{4\\mu Q_{i}(t_{k})}{\\pi r_{i}^{3}}$（单位：帕斯卡），然后计算 $\\overline{\\tau}_{i}$，最后对每个血管段应用剪枝规则。\n- 所有中间计算的剪切应力均以帕斯卡表示，尽管最终输出不需要单位。\n- 不涉及角度。不涉及百分比；任何比例都应作为小数处理。\n- 输出格式：对于每个测试用例，计算所有退化血管段的索引，并将其作为一个排序后的列表。你的程序应生成一行输出，其中包含一个由这些列表组成的逗号分隔列表，并用方括号括起来，例如 \"[[0,2],[1],[]]\"。\n\n测试套件：\n你必须在以下三个测试用例上运行你的程序。这些测试用例旨在反映从胎儿到新生儿状态的流量重新分配和边界条件，同时保持纯粹的数学性和可复现性。\n\n- 测试用例 1 (从胎儿到新生儿的重新分配，部分血管段失去流量)：\n  - 粘度：$\\mu = 0.0035$ 帕斯卡-秒。\n  - 剪枝阈值：$\\tau_{\\mathrm{th}} = 3.0$ 帕斯卡。\n  - 血管段半径（单位：米）：$\\big[r_{0}, r_{1}, r_{2}, r_{3}\\big] = \\big[0.0015, 0.0010, 0.0010, 0.0012\\big]$。\n  - 在 $K=4$ 个等间隔时间点的离散时间流量（单位：立方米/秒）（两个类似产前的样本后跟两个类似产后的样本）：\n    - 血管段 $0$：$Q_{0}(t) = \\big[5\\times 10^{-6}, 4\\times 10^{-6}, 0, 0\\big]$。\n    - 血管段 $1$：$Q_{1}(t) = \\big[2.5\\times 10^{-6}, 2.0\\times 10^{-6}, 0, 0\\big]$。\n    - 血管段 $2$：$Q_{2}(t) = \\big[1\\times 10^{-6}, 2\\times 10^{-6}, 4\\times 10^{-6}, 5\\times 10^{-6}\\big]$。\n    - 血管段 $3$：$Q_{3}(t) = \\big[3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}\\big]$。\n\n- 测试用例 2 (在阈值处的边界行为)：\n  - 粘度：$\\mu = 0.0035$ 帕斯卡-秒。\n  - 剪枝阈值：$\\tau_{\\mathrm{th}} = 3.0$ 帕斯卡。\n  - 血管段半径（单位：米）：$\\big[r_{0}, r_{1}, r_{2}\\big] = \\big[0.0010, 0.0010, 0.0010\\big]$。\n  - 对于半径为 $r = 0.0010$ 米的血管，通过恒等式 $\\tau_{\\mathrm{th}} = \\dfrac{4\\mu Q_{\\mathrm{th}}}{\\pi r^{3}}$ 定义 $Q_{\\mathrm{th}}$，即\n    $$Q_{\\mathrm{th}} = \\dfrac{\\tau_{\\mathrm{th}}\\pi r^{3}}{4\\mu}。$$\n    现在设置 $K=2$ 和流量：\n    - 血管段 $0$：$Q_{0}(t) = \\big[Q_{\\mathrm{th}}, Q_{\\mathrm{th}}\\big]$。\n    - 血管段 $1$：$Q_{1}(t) = \\big[0.9\\,Q_{\\mathrm{th}}, 0.9\\,Q_{\\mathrm{th}}\\big]$。\n    - 血管段 $2$：$Q_{2}(t) = \\big[1.1\\,Q_{\\mathrm{th}}, 0.9\\,Q_{\\mathrm{th}}\\big]$。\n  - 根据构造，血管段 $0$ 的 $\\overline{\\tau} = \\tau_{\\mathrm{th}}$，血管段 $1$ 的 $\\overline{\\tau}  \\tau_{\\mathrm{th}}$，血管段 $2$ 的 $\\overline{\\tau} = \\tau_{\\mathrm{th}}$。\n\n- 测试用例 3 (边界情况：零流量和大半径效应)：\n  - 粘度：$\\mu = 0.0035$ 帕斯卡-秒。\n  - 剪枝阈值：$\\tau_{\\mathrm{th}} = 3.0$ 帕斯卡。\n  - 血管段半径（单位：米）：$\\big[r_{0}, r_{1}, r_{2}\\big] = \\big[0.0010, 0.0020, 0.0005\\big]$。\n  - 在 $K=4$ 时的离散时间流量：\n    - 血管段 $0$：$Q_{0}(t) = \\big[0, 0, 0, 0\\big]$。\n    - 血管段 $1$：$Q_{1}(t) = \\big[3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}, 3\\times 10^{-6}\\big]$。\n    - 血管段 $2$：$Q_{2}(t) = \\big[1\\times 10^{-6}, 1\\times 10^{-6}, 1\\times 10^{-6}, 1\\times 10^{-6}\\big]$。\n\n你的程序必须为每个测试用例计算退化血管段的索引，并将其作为一个排序后的整数列表，然后将所有三个列表汇总为单个列表在一行中输出，例如：\n- 如果第一个用例产生血管段 $\\big[0,2\\big]$，第二个用例产生 $\\big[1\\big]$，第三个用例产生 $\\big[0\\big]$，那么程序必须打印 \"[[0,2],[1],[0]]\" 并且不打印任何其他内容。", "solution": "该问题是有效的，因为它在科学上基于流体动力学的基本原理，具有完整且一致的定义和数据，是一个适定的问题，并以客观、正式的语言表述。一个唯一的解可以被确定性地计算出来。\n\n该解源于一个机械生物学模型，其中血管退化是由低壁面剪切应力（WSS）驱动的。该模型基于圆柱形血管内稳态、层流、不可压缩流动（Poiseuille 流）的原理。\n\n在半径为 $R$、承受体积流率 $Q$ 的血管中，壁面剪切应力 $\\tau$ 的控制方程由下式给出：\n$$ \\tau = \\dfrac{4\\mu Q}{\\pi R^{3}} $$\n其中 $\\mu$ 是流体的动力粘度。\n\n生物学假说是，如果时间平均壁面剪切应力 $\\overline{\\tau}$ 降至临界阈值 $\\tau_{\\mathrm{th}}$ 以下，血管就会退化。对于一个包含 $K$ 个流量测量值 $Q(t_k)$ 的离散时间序列，时间平均 WSS 计算如下：\n$$ \\overline{\\tau} = \\dfrac{1}{K}\\sum_{k=1}^{K}\\tau(t_{k}) = \\dfrac{1}{K}\\sum_{k=1}^{K} \\dfrac{4\\mu Q(t_{k})}{\\pi R^{3}} $$\n这个表达式可以通过提出常数项并识别出流量的平均值 $\\overline{Q}$ 来简化：\n$$ \\overline{\\tau} = \\dfrac{4\\mu}{\\pi R^{3}} \\left( \\dfrac{1}{K}\\sum_{k=1}^{K} Q(t_{k}) \\right) = \\dfrac{4\\mu \\overline{Q}}{\\pi R^{3}} $$\n这种形式比对单个应力值求和计算效率更高，并且更不容易出现浮点误差累积。\n\n剪枝标准应用于每个半径为 $r_i$、时间平均 WSS 为 $\\overline{\\tau}_i$ 的血管段 $i$。如果其平均 WSS 严格小于阈值 $\\tau_{\\mathrm{th}}$，则该段退化。为了稳健地处理浮点数比较，我们规定当 $\\overline{\\tau}_i  \\tau_{\\mathrm{th}} - \\varepsilon$ 时宣告退化，其中 $\\varepsilon = 10^{-12} \\, \\text{帕斯卡}$。每个测试用例中所有退化血管段的索引被收集到一个排序后的列表中。\n\n现在我们将此程序应用于每个测试用例。\n\n**测试用例 1**\n参数：$\\mu = 0.0035 \\, \\text{Pa}\\cdot\\text{s}$，$\\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$，$K=4$。\n半径为 $[r_0, r_1, r_2, r_3] = [0.0015, 0.0010, 0.0010, 0.0012] \\, \\text{m}$。\n\n- **血管段 0**：$r_0 = 0.0015 \\, \\text{m}$。\n  流量：$Q_0(t) = [5 \\times 10^{-6}, 4 \\times 10^{-6}, 0, 0] \\, \\text{m}^3/\\text{s}$。\n  平均流量：$\\overline{Q}_0 = \\frac{1}{4}(5+4+0+0) \\times 10^{-6} = 2.25 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$。\n  平均 WSS：$\\overline{\\tau}_0 = \\dfrac{4(0.0035)(2.25 \\times 10^{-6})}{\\pi (0.0015)^3} \\approx 2.97089 \\, \\text{Pa}$。\n  由于 $2.97089  3.0 - 10^{-12}$，血管段 0 退化。\n\n- **血管段 1**：$r_1 = 0.0010 \\, \\text{m}$。\n  流量：$Q_1(t) = [2.5 \\times 10^{-6}, 2.0 \\times 10^{-6}, 0, 0] \\, \\text{m}^3/\\text{s}$。\n  平均流量：$\\overline{Q}_1 = \\frac{1}{4}(2.5+2.0+0+0) \\times 10^{-6} = 1.125 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$。\n  平均 WSS：$\\overline{\\tau}_1 = \\dfrac{4(0.0035)(1.125 \\times 10^{-6})}{\\pi (0.0010)^3} \\approx 5.01338 \\, \\text{Pa}$。\n  由于 $5.01338 \\not 3.0 - 10^{-12}$，血管段 1 不退化。\n\n- **血管段 2**：$r_2 = 0.0010 \\, \\text{m}$。\n  流量：$Q_2(t) = [1 \\times 10^{-6}, 2 \\times 10^{-6}, 4 \\times 10^{-6}, 5 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$。\n  平均流量：$\\overline{Q}_2 = \\frac{1}{4}(1+2+4+5) \\times 10^{-6} = 3.0 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$。\n  平均 WSS：$\\overline{\\tau}_2 = \\dfrac{4(0.0035)(3.0 \\times 10^{-6})}{\\pi (0.0010)^3} \\approx 13.369 \\, \\text{Pa}$。\n  由于 $13.369 \\not 3.0 - 10^{-12}$，血管段 2 不退化。\n\n- **血管段 3**：$r_3 = 0.0012 \\, \\text{m}$。\n  流量：$Q_3(t) = [3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$。\n  平均流量：$\\overline{Q}_3 = 3.0 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$。\n  平均 WSS：$\\overline{\\tau}_3 = \\dfrac{4(0.0035)(3.0 \\times 10^{-6})}{\\pi (0.0012)^3} \\approx 7.7367 \\, \\text{Pa}$。\n  由于 $7.7367 \\not 3.0 - 10^{-12}$，血管段 3 不退化。\n\n测试用例 1 的结果：$[0]$。\n\n**测试用例 2**\n参数：$\\mu = 0.0035 \\, \\text{Pa}\\cdot\\text{s}$，$\\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$，$K=2$。\n所有血管段的半径均为 $r = 0.0010 \\, \\text{m}$。流量是相对于 $Q_{\\mathrm{th}}$ 定义的，$Q_{\\mathrm{th}}$ 是恰好产生 $\\tau_{\\mathrm{th}}$ 的流量：\n$$ Q_{\\mathrm{th}} = \\dfrac{\\tau_{\\mathrm{th}}\\pi r^{3}}{4\\mu} = \\dfrac{3.0 \\cdot \\pi \\cdot (0.0010)^3}{4 \\cdot 0.0035} \\approx 6.73198 \\times 10^{-7} \\, \\text{m}^3/\\text{s} $$\n对于流量 $Q = c \\cdot Q_{\\mathrm{th}}$，WSS 为 $\\tau = c \\cdot \\tau_{\\mathrm{th}}$。因此，平均 WSS $\\overline{\\tau}$ 只是 $\\overline{c} \\cdot \\tau_{\\mathrm{th}}$，其中 $\\overline{c}$ 是流量系数的平均值。\n\n- **血管段 0**：流量 $Q_0(t) = [1.0 \\cdot Q_{\\mathrm{th}}, 1.0 \\cdot Q_{\\mathrm{th}}]$。平均系数 $\\overline{c}_0 = 1.0$。\n  平均 WSS：$\\overline{\\tau}_0 = 1.0 \\cdot \\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$。\n  由于 $3.0 \\not 3.0 - 10^{-12}$，血管段 0 不退化。\n\n- **血管段 1**：流量 $Q_1(t) = [0.9 \\cdot Q_{\\mathrm{th}}, 0.9 \\cdot Q_{\\mathrm{th}}]$。平均系数 $\\overline{c}_1 = 0.9$。\n  平均 WSS：$\\overline{\\tau}_1 = 0.9 \\cdot \\tau_{\\mathrm{th}} = 2.7 \\, \\text{Pa}$。\n  由于 $2.7  3.0 - 10^{-12}$，血管段 1 退化。\n\n- **血管段 2**：流量 $Q_2(t) = [1.1 \\cdot Q_{\\mathrm{th}}, 0.9 \\cdot Q_{\\mathrm{th}}]$。平均系数 $\\overline{c}_2 = \\frac{1.1+0.9}{2} = 1.0$。\n  平均 WSS：$\\overline{\\tau}_2 = 1.0 \\cdot \\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$。\n  由于 $3.0 \\not 3.0 - 10^{-12}$，血管段 2 不退化。\n\n测试用例 2 的结果：$[1]$。\n\n**测试用例 3**\n参数：$\\mu = 0.0035 \\, \\text{Pa}\\cdot\\text{s}$，$\\tau_{\\mathrm{th}} = 3.0 \\, \\text{Pa}$，$K=4$。\n半径为 $[r_0, r_1, r_2] = [0.0010, 0.0020, 0.0005] \\, \\text{m}$。\n\n- **血管段 0**：$r_0 = 0.0010 \\, \\text{m}$。\n  流量：$Q_0(t) = [0, 0, 0, 0] \\, \\text{m}^3/\\text{s}$。\n  平均流量：$\\overline{Q}_0 = 0 \\, \\text{m}^3/\\text{s}$。\n  平均 WSS：$\\overline{\\tau}_0 = 0 \\, \\text{Pa}$。\n  由于 $0  3.0 - 10^{-12}$，血管段 0 退化。\n\n- **血管段 1**：$r_1 = 0.0020 \\, \\text{m}$。\n  流量：$Q_1(t) = [3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}, 3 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$。\n  平均流量：$\\overline{Q}_1 = 3 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$。\n  平均 WSS：$\\overline{\\tau}_1 = \\dfrac{4(0.0035)(3 \\times 10^{-6})}{\\pi (0.0020)^3} \\approx 1.67113 \\, \\text{Pa}$。\n  由于 $1.67113  3.0 - 10^{-12}$，血管段 1 退化。\n\n- **血管段 2**：$r_2 = 0.0005 \\, \\text{m}$。\n  流量：$Q_2(t) = [1 \\times 10^{-6}, 1 \\times 10^{-6}, 1 \\times 10^{-6}, 1 \\times 10^{-6}] \\, \\text{m}^3/\\text{s}$。\n  平均流量：$\\overline{Q}_2 = 1 \\times 10^{-6} \\, \\text{m}^3/\\text{s}$。\n  平均 WSS：$\\overline{\\tau}_2 = \\dfrac{4(0.0035)(1 \\times 10^{-6})}{\\pi (0.0005)^3} \\approx 35.6507 \\, \\text{Pa}$。\n  由于 $35.6507 \\not 3.0 - 10^{-12}$，血管段 2 不退化。\n\n测试用例 3 的结果：$[0, 1]$。\n\n汇总所有测试用例的结果，得出最终输出。", "answer": "$$\\boxed{\\texttt{[[0],[1],[0,1]]}}$$", "id": "4881757"}]}