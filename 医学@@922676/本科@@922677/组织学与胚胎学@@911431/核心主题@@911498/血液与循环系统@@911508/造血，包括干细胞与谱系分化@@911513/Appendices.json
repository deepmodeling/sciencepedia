{"hands_on_practices": [{"introduction": "在临床实践中，造血干细胞移植的成功与否取决于植入足够数量的功能性干细胞。然而，移植过程并非百分之百确定，而是充满了随机性，单个细胞能否成功植入并重建造血功能是一个概率事件。本练习将引导你应用基本的概率论知识，计算为达到预期的移植成功率所需的最小细胞剂量，这是移植医学中的一个关键问题 [@problem_id:4898888]。", "problem": "在异基因造血干细胞 (HSC) 移植中，临床目标是通过确保至少一个真正的、具有自我更新和多能分化潜能的造血干细胞在骨髓微环境中成功植入，以实现持久的造血功能。此处的造血干细胞 (HSC) 植入定义为：一个有活力的移植细胞归巢至一个适宜的微环境，并建立长期的自我更新和多谱系输出。请考虑以下基于科学依据的假设和参数：\n- 待输注的产品由CD34阳性细胞组成，其中只有一小部分是真正的长期HSC，这体现在单细胞成功植入的概率很低。\n- 在关键的早期归巢窗口期，每个有活力的输注细胞的植入过程可视为一次独立的伯努利试验，其单细胞成功植入的概率为 $p$；由于潜在微环境数量巨大且时间尺度短，失败的试验不会影响后续试验。\n- 细胞处理过程会将细胞活力降低，使得输注时仅有比例为 $v$ 的输注细胞是存活且有功能的。\n- 输注细胞总数是每公斤剂量 $d_k$ (单位：细胞/公斤) 乘以患者体重 $W$ (单位：公斤)，有效试验次数即为有活力的细胞数 $v \\, d_k \\, W$。\n- 实现至少一次成功植入事件的概率等于1减去所有有活力的细胞均植入失败的概率。\n\n对于一个体重 $W = 70$ 公斤的成人，细胞活力分数为 $v = 0.85$，单细胞植入概率为 $p = 3 \\times 10^{-8}$，请确定所需的最小每公斤剂量 $d_k$ (单位：细胞/公斤)，以使至少一次成功植入的概率不低于 $0.99$。请用细胞/公斤作为单位表达最终答案，并四舍五入至三位有效数字。", "solution": "我们的目标是求出为使至少一次成功植入事件的概率不低于 $0.99$ 所需的每公斤患者体重的造血干细胞最小剂量 $d_k$。\n\n设输注细胞总数为 $N_{total}$。它由每公斤剂量 $d_k$ 与患者体重 $W$ 的乘积给出。\n$$N_{total} = d_k \\cdot W$$\n\n问题陈述指出，这些细胞中只有一部分（比例为 $v$）是存活且有功能的。因此，可被视为独立试验次数的有活力细胞数量 $N_{viable}$ 为：\n$$N_{viable} = v \\cdot N_{total} = v \\cdot d_k \\cdot W$$\n\n每个有活力细胞的植入被建模为一次独立的伯努利试验，成功概率为 $p$。因此，单次试验失败的概率为 $(1-p)$。\n\n所有 $N_{viable}$ 次独立试验均失败的概率是它们各自失败概率的乘积：\n$$P(\\text{all fail}) = (1-p)^{N_{viable}}$$\n\n实现至少一次成功植入的概率 $P_{success}$ 是所有细胞均植入失败这一事件的补集：\n$$P_{success} = 1 - P(\\text{all fail}) = 1 - (1-p)^{N_{viable}}$$\n\n代入 $N_{viable}$ 的表达式，我们得到：\n$$P_{success} = 1 - (1-p)^{v \\cdot d_k \\cdot W}$$\n\n临床要求是这个概率必须至少为 $0.99$：\n$$1 - (1-p)^{v \\cdot d_k \\cdot W} \\ge 0.99$$\n\n我们求解这个关于 $d_k$ 的不等式。首先，我们整理不等式：\n$$0.01 \\ge (1-p)^{v \\cdot d_k \\cdot W}$$\n$$(1-p)^{v \\cdot d_k \\cdot W} \\le 0.01$$\n\n为了解出包含 $d_k$ 的指数，我们对两边取自然对数。由于自然对数函数 $\\ln(x)$ 是单调递增的，不等式的方向保持不变。\n$$\\ln\\left((1-p)^{v \\cdot d_k \\cdot W}\\right) \\le \\ln(0.01)$$\n\n使用对数恒等式 $\\ln(a^b) = b \\ln(a)$：\n$$(v \\cdot d_k \\cdot W) \\cdot \\ln(1-p) \\le \\ln(0.01)$$\n\n为了分离出 $d_k$，我们必须除以 $v$、$W$ 和 $\\ln(1-p)$。关键是要注意 $\\ln(1-p)$ 的符号。因为 $p$ 是一个概率，所以 $0  p  1$，这意味着 $0  (1-p)  1$。任何介于 $0$ 和 $1$ 之间的数的自然对数都是负数。因此，$\\ln(1-p)  0$。不等式两边同时除以一个负数会改变不等号的方向。\n$$d_k \\ge \\frac{\\ln(0.01)}{v \\cdot W \\cdot \\ln(1-p)}$$\n这个表达式给出了所需最小剂量 $d_k$ 的条件。\n\n现在我们代入给定值：\n- 患者体重, $W = 70$ kg\n- 活力分数, $v = 0.85$\n- 单细胞植入概率, $p = 3 \\times 10^{-8}$\n\n$$d_k \\ge \\frac{\\ln(0.01)}{(0.85) \\cdot (70) \\cdot \\ln(1 - 3 \\times 10^{-8})}$$\n$$d_k \\ge \\frac{\\ln(10^{-2})}{59.5 \\cdot \\ln(1 - 3 \\times 10^{-8})}$$\n$$d_k \\ge \\frac{-2 \\ln(10)}{59.5 \\cdot \\ln(1 - 3 \\times 10^{-8})}$$\n\n对于非常小的 $x$ 值，自然对数的泰勒级数近似为 $\\ln(1-x) \\approx -x$。鉴于 $p = 3 \\times 10^{-8}$ 极小，这个近似非常精确。\n$$\\ln(1 - 3 \\times 10^{-8}) \\approx -3 \\times 10^{-8}$$\n\n将此近似代入我们的不等式：\n$$d_k \\ge \\frac{-2 \\ln(10)}{59.5 \\cdot (-3 \\times 10^{-8})}$$\n$$d_k \\ge \\frac{2 \\ln(10)}{178.5 \\times 10^{-8}}$$\n$$d_k \\ge \\frac{2 \\ln(10)}{1.785 \\times 10^{-6}}$$\n\n使用 $\\ln(10) \\approx 2.302585$ 的值：\n$$d_k \\ge \\frac{2 \\cdot (2.302585)}{1.785 \\times 10^{-6}}$$\n$$d_k \\ge \\frac{4.60517}{1.785 \\times 10^{-6}}$$\n$$d_k \\ge 2579927.17...$$\n\n因此，所需的最小剂量约为 $2.579927 \\times 10^6$ 细胞/公斤。问题要求答案四舍五入到三位有效数字。\n$$d_k \\approx 2.58 \\times 10^6 \\text{ 细胞/公斤}$$", "answer": "$$\\boxed{2.58 \\times 10^{6}}$$", "id": "4898888"}, {"introduction": "确定了需要足够数量的造血干细胞后，一个核心问题随之而来：我们如何精确地计数这些功能性细胞？本练习将向你介绍极限稀释分析（LDA），这是定量检测功能性细胞（如此处的HSC）的黄金标准方法，它依据细胞的功能而非表面标志物来定义细胞。你将学习使用泊松分布统计模型，从模拟的移植实验数据中推断出真正HSC的频率 [@problem_id:4898981]。", "problem": "您正在设计一个极限稀释移植实验，以操作性地定义造血干细胞（HSC），并估计其在候选骨髓亚群中的频率。HSC的操作性定义是：当单个细胞与辐射防护支持细胞一同移植到致死剂量辐照的同源受体中时，能够在髓系（例如，CD11b/Gr-1）、B淋巴系（例如，B220）和T淋巴系（例如，CD3）等多个谱系中，实现长期（$\\geq 16$周）的高水平、多谱系重建。假设每个受体都被移植了指定数量的候选细胞，外加$2 \\times 10^{5}$个未分离的辅助骨髓细胞，并且各受体之间是独立的。候选细胞群被假定含有一类稀有的、作为单次命中单位起作用的真HSC，因此每个受体中真HSC的数量遵循泊松分布，其均值为$\\lambda = f N$，其中$f$是HSC频率（单位为HSC/候选细胞），$N$是移植到该受体中的候选细胞数量。在此“单次命中”泊松模型下，一个受体未表现出长期多谱系植入（即零类）的概率为$P_{0} = \\exp(-\\lambda)$。\n\n您进行了三组极限稀释移植，剂量方案如下：第1组接受$N_{1} = 1000$个候选细胞，第2组接受$N_{2} = 500$个候选细胞，第3组接受$N_{3} = 250$个候选细胞。每组包含$m_{i} = 12$个受体（$i = 1,2,3$）。16周后，您将每个受体分类为“阳性”（有长期多谱系重建）或“阴性”（无长期多谱系重建）。您观察到第1组中有$k_{1} = 0$个阴性受体，第2组中有$k_{2} = 2$个阴性受体，第3组中有$k_{3} = 5$个阴性受体。\n\n从泊松单次命中模型和受体独立性的假设出发，通过写出各组中观察到的阴性与阳性计数的相应似然，并求解似然方程，来推导HSC频率$f$的最大似然估计（MLE）。然后，使用给定数据计算MLE $\\hat{f}$的数值，并以每百万移植候选细胞中的HSC数量报告HSC频率。\n\n将您的最终数值答案表示为每百万候选细胞中的HSC数量，并四舍五入到三位有效数字。不要以百分比报告；请给出每$10^{6}$个候选细胞中的HSC数量。", "solution": "该问题要求找到HSC频率$f$的最大似然估计（MLE）。实验设置包括三个独立的组。对于每个受体，结果是二元的：“阳性”（植入成功）或“阴性”（无植入）。这构成了一系列的伯努利试验。\n\n让我们考虑单个组$i$，其中$N_i$个细胞被移植到$m_i$个受体中的每一个。根据泊松单次命中模型，一次$N_i$个细胞的移植中所含HSC的数量遵循泊松分布，其均值为$\\lambda_i = f N_i$。如果一个受体接收到零个HSC，则被分类为“阴性”。此事件的概率由泊松概率质量函数在0个事件处给出：\n$$ P(\\text{阴性}) = p_i = \\frac{\\lambda_i^0 \\exp(-\\lambda_i)}{0!} = \\exp(-\\lambda_i) = \\exp(-fN_i) $$\n因此，一个受体为“阳性”的概率是$1-p_i = 1 - \\exp(-fN_i)$。\n\n在第$i$组内，我们在总共$m_i$个独立受体中观察到$k_i$个阴性受体。阴性受体的数量$k_i$遵循参数为$m_i$和$p_i$的二项分布。对于第$i$组，似然函数$L_i(f)$是在给定$f$的情况下观察到$k_i$个阴性结果的概率：\n$$ L_i(f) = \\binom{m_i}{k_i} p_i^{k_i} (1-p_i)^{m_i-k_i} = \\binom{m_i}{k_i} (\\exp(-fN_i))^{k_i} (1 - \\exp(-fN_i))^{m_i - k_i} $$\n\n由于三个组是独立的，整个实验的总似然函数$L(f)$是每个组似然函数的乘积：\n$$ L(f) = \\prod_{i=1}^{3} L_i(f) $$\n为了找到MLE，使用对数似然函数$\\ell(f) = \\ln(L(f))$更为方便：\n$$ \\ell(f) = \\sum_{i=1}^{3} \\ln(L_i(f)) = \\sum_{i=1}^{3} \\left[ \\ln\\binom{m_i}{k_i} + k_i \\ln(\\exp(-fN_i)) + (m_i - k_i) \\ln(1 - \\exp(-fN_i)) \\right] $$\n$$ \\ell(f) = C - f \\sum_{i=1}^{3} k_i N_i + \\sum_{i=1}^{3} (m_i - k_i) \\ln(1 - \\exp(-fN_i)) $$\n其中$C = \\sum_{i=1}^{3} \\ln\\binom{m_i}{k_i}$是一个不依赖于$f$的常数。\n\n为了最大化$\\ell(f)$，我们对其关于$f$求导并令其为零。这个导数就是得分函数$S(f)$：\n$$ S(f) = \\frac{d\\ell}{df} = -\\sum_{i=1}^{3} k_i N_i + \\sum_{i=1}^{3} (m_i - k_i) \\frac{N_i \\exp(-fN_i)}{1 - \\exp(-fN_i)} $$\n令$S(f)=0$得到MLE $\\hat{f}$的似然方程：\n$$ \\sum_{i=1}^{3} (m_i - k_i) \\frac{N_i \\exp(-\\hat{f}N_i)}{1 - \\exp(-\\hat{f}N_i)} = \\sum_{i=1}^{3} k_i N_i $$\n该方程可以重写为更结构化的形式：\n$$ \\sum_{i=1}^{3} \\frac{N_i(m_i \\exp(-fN_i) - k_i)}{1 - \\exp(-fN_i)} = 0 $$\n这是一个关于$f$的超越方程，必须通过数值方法求解。我们现在代入给定的数据：\n- 第1组: $N_1 = 1000$, $m_1 = 12$, $k_1 = 0$\n- 第2组: $N_2 = 500$, $m_2 = 12$, $k_2 = 2$\n- 第3组: $N_3 = 250$, $m_3 = 12$, $k_3 = 5$\n\n方程变为：\n$$ \\frac{1000(12 \\exp(-1000f) - 0)}{1 - \\exp(-1000f)} + \\frac{500(12 \\exp(-500f) - 2)}{1 - \\exp(-500f)} + \\frac{250(12 \\exp(-250f) - 5)}{1 - \\exp(-250f)} = 0 $$\n使用数值求根算法（如牛顿法或二分法）求解此方程，可以得到HSC频率$f$的解。\n数值求解得到频率的最大似然估计为 $\\hat{f} \\approx 0.003806$ HSC/候选细胞。\n\n问题要求以每百万（$10^6$）移植候选细胞中的HSC数量来表示频率。\n$$ \\text{每百万细胞中的频率} = \\hat{f} \\times 10^6 = 0.003806 \\times 10^6 = 3806 $$\n最后，我们必须将此结果四舍五入到三位有效数字。\n$$ 3806 \\approx 3810 $$\n估计的频率是每百万候选细胞中含有3810个HSC。", "answer": "$$\\boxed{3810}$$", "id": "4898981"}, {"introduction": "本章的最后一个练习将我们的视角从干细胞库转移到特定细胞谱系的生产输出上，重点关注红细胞的生成过程。你将学习计算和解读网织红细胞生成指数（RPI），这是一个重要的临床诊断工具，它动态地反映了骨髓对贫血的反应能力。通过这个练习，你将理解如何校正原始的临床数据，以更准确地评估造血系统的真实功能状态 [@problem_id:4898949]。", "problem": "稳态下的造血系统可以通过阶段通量和细胞池平衡来建模：在红细胞系中，网织红细胞是成熟红细胞的直接前体，它们在外周循环中停留一段有限的成熟时间，然后失去残留的核糖核酸（RNA）成为成熟的红细胞。设 $N$ 表示循环红细胞总数，$R$ 表示循环网织红细胞数，$H$ 表示血细胞比容（红细胞压积），$H_0$ 表示用于标准化的正常血细胞比容。设 $t_m(H)$ 表示在血细胞比容为 $H$ 的情况下，一个网织红细胞在循环中成熟所需的平均时间（单位：天）。假设从骨髓到网织红细胞室有每日稳定的红细胞生成输出（通量）$F$，并且在平均细胞体积固定的情况下，$N$ 与 $H$ 成正比。\n\n基本事实：\n- 在一个具有恒定通量 $F$ 输入的稳态室中，平均停留时间为 $t_m$，则该室的大小是通量和停留时间的乘积：$R = F \\, t_m(H)$。\n- 循环红细胞池中网织红细胞的比例为 $r = R/N$。\n- 当前红细胞池大小与正常红细胞池大小之比为 $N/N_0 = H/H_0$，其中 $N_0$ 是血细胞比容为 $H_0$ 时的正常循环红细胞数。\n\n定义网织红细胞生成指数（RPI）$I$ 为每日红细胞生成输出相对于正常循环红细胞池的标准化值，即 $I = F/N_0$。仅使用上述定义，推导出用 $r$、$H$、$H_0$ 和 $t_m(H)$ 表示 $I$ 的表达式，然后计算以下两种临床上不同情景下的 $I$：\n\n情景 A（急性失血，第3天）：\n- 外周血计数：$N_A = 4.0 \\times 10^{12}\\ \\text{cells/L}$，$R_A = 1.6 \\times 10^{11}\\ \\text{cells/L}$。\n- 血细胞比容：$H_A = 0.32$。\n- 用于标准化的正常血细胞比容：$H_0 = 0.45$。\n- 贫血状态下的成熟时间模型（天）：$t_m(H) = 1 + 5\\,(0.45 - H)$。\n\n情景 B（慢性缺铁性贫血）：\n- 外周血计数：$N_B = 4.8 \\times 10^{12}\\ \\text{cells/L}$，$R_B = 9.6 \\times 10^{10}\\ \\text{cells/L}$。\n- 血细胞比容：$H_B = 0.24$。\n- 用于标准化的正常血细胞比容：$H_0 = 0.45$（与上同）。\n- 成熟时间模型：$t_m(H) = 1 + 5\\,(0.45 - H)$。\n\n分别计算情景 A 和 B 的 $I_A$ 和 $I_B$，并报告单个量 $I_A/I_B$。以精确分数形式提供您的最终答案。在您的解题过程中，简要解释计算出的指数如何反映骨髓在急性失血与慢性贫血下反应的差异。由于所求的最终比率是无量纲的，因此最终数值结果不需要单位。", "solution": "首先，我们推导网织红细胞生成指数 $I$ 的通用表达式。$I$ 的定义是红细胞生成通量 $F$ 相对于正常循环红细胞池 $N_0$ 的标准化值。\n$$\nI = \\frac{F}{N_0}\n$$\n根据稳态假设，网织红细胞室的大小 $R$ 是流入通量 $F$ 和平均停留时间 $t_m(H)$ 的乘积。\n$$\nR = F \\cdot t_m(H)\n$$\n我们可以重新整理这个方程来解出通量 $F$：\n$$\nF = \\frac{R}{t_m(H)}\n$$\n将这个 $F$ 的表达式代入 $I$ 的定义中，得到：\n$$\nI = \\frac{R / t_m(H)}{N_0} = \\frac{R}{t_m(H) N_0}\n$$\n接下来，我们使用网织红细胞比例 $r$ 的定义，$r = R/N$。这使我们可以将 $R$ 表示为 $R = rN$。将此代入我们关于 $I$ 的表达式中：\n$$\nI = \\frac{rN}{t_m(H) N_0} = \\frac{r}{t_m(H)} \\cdot \\frac{N}{N_0}\n$$\n最后，我们使用给定的红细胞池大小和血细胞比容之间的关系：$\\frac{N}{N_0} = \\frac{H}{H_0}$。将此代入我们关于 $I$ 的方程，得到最终所需的用 $r$、$H$、$H_0$ 和 $t_m(H)$ 表示的表达式：\n$$\nI = \\frac{r}{t_m(H)} \\frac{H}{H_0}\n$$\n这个公式通常被称为校正的网织红细胞计数或 RPI。\n\n现在，我们将此公式应用于所提供的两种情景。\n\n对于情景 A（急性失血）：\n首先，我们计算网织红细胞比例 $r_A$：\n$$\nr_A = \\frac{R_A}{N_A} = \\frac{1.6 \\times 10^{11}}{4.0 \\times 10^{12}} = \\frac{1.6}{40} = 0.04\n$$\n接下来，我们计算网织红细胞成熟时间 $t_{m,A}$：\n$$\nt_{m,A} = t_m(H_A) = 1 + 5(0.45 - 0.32) = 1 + 5(0.13) = 1 + 0.65 = 1.65\n$$\n\n对于情景 B（慢性缺铁性贫血）：\n首先，我们计算网织红细胞比例 $r_B$：\n$$\nr_B = \\frac{R_B}{N_B} = \\frac{9.6 \\times 10^{10}}{4.8 \\times 10^{12}} = \\frac{9.6}{480} = 0.02\n$$\n接下来，我们计算网织红细胞成熟时间 $t_{m,B}$：\n$$\nt_{m,B} = t_m(H_B) = 1 + 5(0.45 - 0.24) = 1 + 5(0.21) = 1 + 1.05 = 2.05\n$$\n\n题目要求我们计算比率 $I_A/I_B$。使用推导出的 $I$ 的表达式：\n$$\n\\frac{I_A}{I_B} = \\frac{\\frac{r_A}{t_{m,A}} \\frac{H_A}{H_0}}{\\frac{r_B}{t_{m,B}} \\frac{H_B}{H_0}}\n$$\n标准化因子 $H_0$ 被消去，我们可以重新整理各项：\n$$\n\\frac{I_A}{I_B} = \\left(\\frac{r_A}{r_B}\\right) \\left(\\frac{t_{m,B}}{t_{m,A}}\\right) \\left(\\frac{H_A}{H_B}\\right)\n$$\n现在我们代入每个比率的计算值：\n$$\n\\frac{r_A}{r_B} = \\frac{0.04}{0.02} = 2\n$$\n$$\n\\frac{t_{m,B}}{t_{m,A}} = \\frac{2.05}{1.65} = \\frac{205}{165} = \\frac{41}{33}\n$$\n$$\n\\frac{H_A}{H_B} = \\frac{0.32}{0.24} = \\frac{32}{24} = \\frac{4}{3}\n$$\n将这些比率相乘得到最终结果：\n$$\n\\frac{I_A}{I_B} = 2 \\times \\frac{41}{33} \\times \\frac{4}{3} = \\frac{2 \\times 41 \\times 4}{33 \\times 3} = \\frac{8 \\times 41}{99} = \\frac{328}{99}\n$$\n这些指数的生物学解释反映了骨髓的潜在状态。RPI对原始的网织红细胞百分比进行了校正，既考虑了贫血的稀释效应（$H/H_0$项），也考虑了未成熟网织红细胞从骨髓过早释放的效应（$t_m(H)$项）。高RPI（>2-3）表明骨髓是健康的，对失血或溶血做出了适当的增生反应。低RPI（2）则提示存在增生低下状态，即由于营养缺乏（如铁）、骨髓衰竭或刺激不足，骨髓无法做出有效反应。在情景A中，骨髓反应强劲，导致高$I_A$。在情景B中，缺铁损害了红细胞生成，导致反应不足和低$I_B$。比率$I_A/I_B = 328/99 \\approx 3.31$量化了这一差异，表明在急性失血情景中的有效骨髓输出是慢性缺铁情景中的三倍多。", "answer": "$$\n\\boxed{\\frac{328}{99}}\n$$", "id": "4898949"}]}