{"hands_on_practices": [{"introduction": "在我们讨论像素之前，显微图像的质量从根本上就受到光的波动性和显微镜光学的限制。这项练习将指导您计算显微镜物镜的理论性能。通过使用调制传递函数（Modulation Transfer Function, MTF），您不仅能确定一个微小结构是否可分辨，还能量化其对比度的保留程度，从而将抽象的物理原理与切实的图像质量联系起来。[@problem_id:4949025]", "problem": "在数字病理学的虚拟显微镜技术中，染色组织的明场成像可以很好地近似为通过衍射受限的圆形孔径物镜进行的非相干强度成像。考虑一个组织区域，其呈现一维正弦强度变化，空间周期为 $p = 0.8\\,\\mu\\mathrm{m}$。显微镜使用波长为 $\\lambda = 550\\,\\mathrm{nm}$ 的绿色照明，以及数值孔径（Numerical Aperture, NA）为 $\\mathrm{NA} = 0.75$ 的物镜。假设系统是衍射受限的，像差可忽略不计，并且适用非相干圆形光瞳的调制传递函数（Modulation Transfer Function, MTF）。\n\n仅使用衍射受限显微镜中非相干成像的基本定义和经过充分验证的公式，判断该正弦特征是否可分辨，并计算其在特征空间频率下的预期调制传递。将最终的调制传递表示为一个无量纲数，并将答案四舍五入到四位有效数字。", "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 第1步：提取已知条件\n- 成像模型：非相干强度成像。\n- 光学系统：衍射受限的圆形孔径物镜。\n- 物体特征：一维正弦强度变化。\n- 特征的空间周期：$p = 0.8\\,\\mu\\mathrm{m}$。\n- 照明波长：$\\lambda = 550\\,\\mathrm{nm}$。\n- 物镜数值孔径：$\\mathrm{NA} = 0.75$。\n- 假设：系统是衍射受限的，像差可忽略不计；适用非相干圆形光瞳的调制传递函数（MTF）。\n- 任务：判断可分辨性并计算特征空间频率下的调制传递。\n- 精度要求：将最终答案四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n根据既定标准对问题进行评估。\n- **科学依据**：该问题基于应用于显微镜学的傅里叶光学的基本原理。数值孔径（NA）、波长（$\\lambda$）、空间频率、阿贝衍射极限以及非相干衍射受限系统的调制传递函数（MTF）等概念，在物理学和工程学中都是标准且公认的。给定值（$\\lambda = 550\\,\\mathrm{nm}$，$\\mathrm{NA} = 0.75$，$p = 0.8\\,\\mu\\mathrm{m}$）对于高分辨率光学显微镜是物理上现实的。\n- **适定性**：该问题提供了所有必要的参数（$\\lambda$, $\\mathrm{NA}$, $p$），以唯一确定特征的空间频率、光学系统的截止频率以及对应的MTF值。目标陈述清晰。\n- **客观性**：问题使用精确的技术术语陈述，没有歧义或主观性陈述。\n\n### 第3步：结论与行动\n该问题被判定为**有效**，因为它科学合理、适定且客观。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n问题要求我们判断一个正弦强度图样是否能被给定的显微镜物镜分辨，并计算它在图像中呈现的对比度（调制）。这可以通过计算该图样对应空间频率处的调制传递函数（MTF）值来实现。\n\n首先，我们确定正弦特征的空间频率 $\\nu$。空间频率是空间周期 $p$ 的倒数。\n$$\n\\nu = \\frac{1}{p}\n$$\n给定的单位必须一致。波长 $\\lambda = 550\\,\\mathrm{nm}$ 转换为微米：$\\lambda = 0.55\\,\\mu\\mathrm{m}$。空间周期为 $p = 0.8\\,\\mu\\mathrm{m}$。\n$$\n\\nu = \\frac{1}{0.8\\,\\mu\\mathrm{m}} = 1.25\\,\\mu\\mathrm{m}^{-1}\n$$\n\n接下来，我们确定光学系统的分辨率极限。对于非相干成像系统，能够传输的最高空间频率是非相干截止频率 $\\nu_c$。该频率由物镜的数值孔径（$\\mathrm{NA}$）和光的波长（$\\lambda$）决定。\n$$\n\\nu_c = \\frac{2 \\times \\mathrm{NA}}{\\lambda}\n$$\n使用给定值：\n$$\n\\nu_c = \\frac{2 \\times 0.75}{0.55\\,\\mu\\mathrm{m}} = \\frac{1.5}{0.55}\\,\\mu\\mathrm{m}^{-1} \\approx 2.727\\,\\mu\\mathrm{m}^{-1}\n$$\n\n为了判断该特征是否可分辨，我们将其空间频率 $\\nu$ 与系统的截止频率 $\\nu_c$ 进行比较。如果一个特征的空间频率小于截止频率（$\\nu  \\nu_c$），则该特征是可分辨的。\n$$\n\\nu = 1.25\\,\\mu\\mathrm{m}^{-1} \\quad \\text{and} \\quad \\nu_c \\approx 2.727\\,\\mu\\mathrm{m}^{-1}\n$$\n由于 $\\nu  \\nu_c$，该正弦特征可以被显微镜系统分辨。其调制将大于零。\n\n调制传递由特征空间频率处的MTF值给出。对于具有圆形孔径的衍射受限非相干系统，MTF是归一化空间频率 $\\nu_n$ 的函数，$\\nu_n$ 定义为特征的空间频率与截止频率之比。\n$$\n\\nu_n = \\frac{\\nu}{\\nu_c}\n$$\n代入 $\\nu$ 和 $\\nu_c$ 的表达式：\n$$\n\\nu_n = \\frac{1/p}{2 \\times \\mathrm{NA}/\\lambda} = \\frac{\\lambda}{2 \\times \\mathrm{NA} \\times p}\n$$\n数值上：\n$$\n\\nu_n = \\frac{1.25}{1.5/0.55} = \\frac{1.25 \\times 0.55}{1.5} = \\frac{0.6875}{1.5} = \\frac{11}{24} \\approx 0.45833\n$$\n\n此类系统的MTF解析公式由圆形光瞳函数的自相关给出，结果为：\n$$\n\\mathrm{MTF}(\\nu_n) = \\frac{2}{\\pi} \\left( \\arccos(\\nu_n) - \\nu_n \\sqrt{1 - \\nu_n^2} \\right) \\quad \\text{for } 0 \\le |\\nu_n| \\le 1\n$$\narccosine函数的值必须是弧度。现在我们将计算出的 $\\nu_n = 11/24$ 代入此公式。\n\n让我们计算括号内的各项：\n第一项是：\n$$\n\\arccos(\\nu_n) = \\arccos\\left(\\frac{11}{24}\\right)\n$$\n第二项是：\n$$\n\\nu_n \\sqrt{1 - \\nu_n^2} = \\frac{11}{24} \\sqrt{1 - \\left(\\frac{11}{24}\\right)^2} = \\frac{11}{24} \\sqrt{1 - \\frac{121}{576}} = \\frac{11}{24} \\sqrt{\\frac{576 - 121}{576}} = \\frac{11}{24} \\sqrt{\\frac{455}{576}} = \\frac{11 \\sqrt{455}}{24 \\times 24} = \\frac{11 \\sqrt{455}}{576}\n$$\n现在，将所有部分组合起来：\n$$\n\\mathrm{MTF}\\left(\\frac{11}{24}\\right) = \\frac{2}{\\pi} \\left( \\arccos\\left(\\frac{11}{24}\\right) - \\frac{11 \\sqrt{455}}{576} \\right)\n$$\n我们进行数值计算，以获得四舍五入到四位有效数字的最终答案。\n$$\n\\nu_n = \\frac{11}{24} \\approx 0.458333...\n$$\n$$\n\\arccos(0.458333...) \\approx 1.094553\\,\\text{rad}\n$$\n$$\n\\sqrt{1 - (0.458333...)^2} \\approx \\sqrt{1 - 0.210069...} \\approx \\sqrt{0.789930...} \\approx 0.888780...\n$$\n$$\n\\nu_n \\sqrt{1 - \\nu_n^2} \\approx 0.458333... \\times 0.888780... \\approx 0.407334...\n$$\n$$\n\\mathrm{MTF}(\\nu_n) \\approx \\frac{2}{\\pi} (1.094553 - 0.407334) = \\frac{2}{\\pi} (0.687219) \\approx 0.63662 \\times 0.687219 \\approx 0.437553...\n$$\n四舍五入到四位有效数字，调制传递为 $0.4376$。该值表示图像中的调制与物体中的调制之比。例如，如果原始正弦图样的调制为 $100\\%$，则图像将显示约 $43.76\\%$ 的调制。", "answer": "$$ \\boxed{0.4376} $$", "id": "4949025"}, {"introduction": "捕获高质量的光学图像只是成功的一半；还必须在不丢失关键信息的前提下将其转换为数字格式。本练习将探讨您希望看到的最小结构尺寸与所需数字传感器像素大小之间的关键联系。通过应用奈奎斯特-香农采样定理（Nyquist-Shannon sampling theorem），您将学习如何计算忠实再现微观细节所需的最低扫描仪分辨率，这是设计和选择数字病理系统时的一项核心原则。[@problem_id:4949003]", "problem": "在用于组织病理学的虚拟载玻片显微技术中，需要采集的具有诊断意义的最小核特征是样本平面上直径为 $1.5\\,\\mu\\mathrm{m}$ 的微核样核碎片。扫描仪以物方像素尺寸（单位为 $\\mu\\mathrm{m}/\\mathrm{pixel}$）来报告采样密度。请利用针对带限信号的奈奎斯特-香农采样定理，以及“对一个空间特征的忠实数字采集要求在最小特征宽度上至少有 $2$ 个样本”的定义，推导出所需的物方像素尺寸与最小特征宽度之间的关系。然后，计算在每个最小特征宽度 $2$ 个样本的条件下，为忠实采集一个直径为 $1.5\\,\\mu\\mathrm{m}$ 的特征所需的物方像素尺寸。最后，根据您的推导，判断 $0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$ 的物方像素尺寸是否足以完成此任务，并用文字说明您的结论。\n\n请以 $\\mu\\mathrm{m}/\\mathrm{pixel}$ 为单位表示计算出的物方像素尺寸，并将您的数值答案四舍五入到三位有效数字。", "solution": "该问题被评估为有效，因为它在科学上基于应用于数字成像的信号处理原理（奈奎斯特-香农采样定理），问题提法得当，数据充分且一致，并以客观、精确的语言表述。\n\n该问题要求推导采样像素尺寸与最小特征尺寸之间的关系，基于此关系进行计算，并评估给定扫描仪的充分性。我们将按顺序解决这些问题。\n\n此问题的基础是奈奎斯特-香农采样定理，该定理规定了从离散样本集中无损重建连续带限信号所必需的条件。对于空间信号（例如显微图像），该定理可以用空间频率来表示。\n\n设 $d_{min}$ 为必须解析的最小特征尺寸（直径）。这对应于我们希望采集的信号中存在的最高空间频率 $k_{max}$，其关系近似为 $k_{max} \\approx \\frac{1}{d_{min}}$。该定理指出，采样频率 $k_s$ 必须至少是信号最高频率分量的两倍。\n$$k_s \\ge 2k_{max}$$\n空间采样频率 $k_s$ 由物方像素尺寸 $p_s$ 决定。采样频率是单位距离内的样本数，因此它是像素尺寸的倒数。\n$$k_s = \\frac{1}{p_s}$$\n将 $k_s$ 和 $k_{max}$ 的表达式代入奈奎斯特准则，得到：\n$$\\frac{1}{p_s} \\ge 2 \\left( \\frac{1}{d_{min}} \\right)$$\n对物方像素尺寸 $p_s$ 求解此不等式，得出所需的关系：\n$$p_s \\le \\frac{d_{min}}{2}$$\n该关系表明，为了实现忠实采集，相邻采样点之间的中心距（即像素尺寸）必须小于或等于感兴趣的最小特征宽度的一半。这直接对应于问题中“要求在最小特征宽度上至少有 $N_{samples} = 2$ 个样本”的定义。我将表示为 $p_{s,max}$ 的最大允许像素尺寸出现在该不等式的极限处。\n\n接下来，我们使用每个特征宽度恰好 $2$ 个样本的临界采样条件，计算为忠实采集直径为 $d_{min} = 1.5\\,\\mu\\mathrm{m}$ 的特征所需的最大允许物方像素尺寸。\n$$p_{s,max} = \\frac{d_{min}}{2} = \\frac{1.5\\,\\mu\\mathrm{m}}{2} = 0.75\\,\\mu\\mathrm{m}$$\n根据问题对物方像素尺寸的定义，单位默认为 $\\mu\\mathrm{m}/\\mathrm{pixel}$。问题要求将此值四舍五入到三位有效数字。\n$$p_{s,max} = 0.750\\,\\mu\\mathrm{m}/\\mathrm{pixel}$$\n\n最后，我们必须确定物方像素尺寸为 $p_{s,actual} = 0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$ 的扫描仪是否足以完成此任务。充分性的条件是，实际像素尺寸必须小于或等于从奈奎斯特准则推导出的最大允许像素尺寸。\n$$p_{s,actual} \\le p_{s,max}$$\n将数值代入：\n$$0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel} \\le 0.750\\,\\mu\\mathrm{m}/\\mathrm{pixel}$$\n此不等式成立。\n\n理由：$0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$ 的物方像素尺寸是足够的。为满足奈奎斯特准则对 $1.5\\,\\mu\\mathrm{m}$ 特征的要求而推导出的最大允许像素尺寸为 $0.750\\,\\mu\\mathrm{m}/\\mathrm{pixel}$。由于扫描仪的实际像素尺寸（$0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$）小于此最大限制，因此采样率高于所需的最低速率。具体来说，跨越 $1.5\\,\\mu\\mathrm{m}$ 特征的样本数将是：\n$$N_{samples} = \\frac{d_{min}}{p_{s,actual}} = \\frac{1.5\\,\\mu\\mathrm{m}}{0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}} = 6\\,\\mathrm{pixels}$$\n由于 $6$ 个样本大于所要求的最小 $2$ 个样本，扫描仪提供了绰绰有余的采样密度来忠实采集 $1.5\\,\\mu\\mathrm{m}$ 的核碎片。这代表过采样，它有利于图像质量和后续分析。", "answer": "$$\\boxed{0.750}$$", "id": "4949003"}, {"introduction": "全切片图像（Whole Slide Images, WSI）非常庞大，通常包含数十亿像素。为了使其能够方便地导航浏览，它们被存储在一种多分辨率的“金字塔”结构中。这项练习提供了对这种数据结构基础数学的动手实践，要求您为一个给定的组织样本计算每个金字塔层级的尺寸。对于任何使用或开发虚拟显微镜软件的人来说，掌握这一概念至关重要。[@problem_id:4948984]", "problem": "在虚拟显微技术和数字病理学中，全切片图像 (WSI) 以分辨率金字塔的形式存储，以实现快速的多尺度导航。考虑一个在 $40\\times$ 光学放大倍率下采集的 WSI，其空间采样率为 $0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$。此切片上的一个连续正方形组织区域在物理空间中的尺寸为 $15\\,\\mathrm{mm}\\times 15\\,\\mathrm{mm}$。该金字塔包含 $4$ 个层级，索引为 $\\ell=0,1,2,3$，其中每个后续层级相对于前一个层级都按因子 $2$ 进行下采样。假设每个轴上的像素尺寸仅由该层级的物理尺寸和采样率决定，并且下采样产生精确的整数像素数，无需填充或裁剪。\n\n使用物理长度和采样之间的基本关系，以及标准量纲转换 $1\\,\\mathrm{mm}=1000\\,\\mu\\mathrm{m}$，计算每个金字塔层级的像素尺寸（宽度和高度）。将您的最终答案报告为一个包含 $(w_0,h_0,w_1,h_1,w_2,h_2,w_3,h_3)$ 的单行矩阵，其中 $w_\\ell$ 和 $h_\\ell$ 是层级 $\\ell$ 的宽度和高度（以像素为单位）。最终答案中不要包含单位。", "solution": "全切片图像 (WSI) 金字塔依赖于将物理长度与离散样本（像素）数量联系起来的采样关系。基本定义是，如果一个一维范围的物理长度为 $L$，采样间隔为 $s$（单位为 $\\mu\\mathrm{m}/\\mathrm{pixel}$），那么该轴上的像素数 $N$ 为\n$$\nN = \\frac{L}{s}.\n$$\n对于一个正方形区域，其宽度和高度（以像素为单位）相等，并且均由该关系给出，独立应用于每个轴。\n\n首先，使用经过充分验证的量纲恒等式 $1\\,\\mathrm{mm}=1000\\,\\mu\\mathrm{m}$，将给定的物理尺寸从毫米转换为微米。组织区域为 $15\\,\\mathrm{mm}\\times 15\\,\\mathrm{mm}$，因此每条边的长度为\n$$\nL = 15\\,\\mathrm{mm} \\times 1000\\,\\frac{\\mu\\mathrm{m}}{\\mathrm{mm}} = 15000\\,\\mu\\mathrm{m}.\n$$\n在基础层级（层级 $\\ell=0$），采样间隔是原始扫描采样率 $s_0 = 0.25\\,\\mu\\mathrm{m}/\\mathrm{pixel}$。因此，层级 $0$ 上一个轴的像素数为\n$$\nN_0 = \\frac{L}{s_0} = \\frac{15000}{0.25} = 60000.\n$$\n由于该区域是正方形，层级 $0$ 的宽度和高度为\n$$\nw_0 = 60000, \\quad h_0 = 60000.\n$$\n\n每个后续的金字塔层级都相对于前一个层级按因子 $2$ 进行下采样。沿每个轴按因子 $2$ 进行下采样，会使像素数减少相同的因子。因此，对于层级 $\\ell$ 的一般关系是\n$$\nN_{\\ell} = \\frac{N_0}{2^{\\ell}},\n$$\n并且由于该区域在每个层级都保持正方形，\n$$\nw_{\\ell} = N_{\\ell}, \\quad h_{\\ell} = N_{\\ell}.\n$$\n计算 $\\ell=1,2,3$ 的情况：\n- 对于 $\\ell=1$：\n$$\nN_1 = \\frac{60000}{2^{1}} = 30000, \\quad w_1 = 30000, \\quad h_1 = 30000.\n$$\n- 对于 $\\ell=2$：\n$$\nN_2 = \\frac{60000}{2^{2}} = 15000, \\quad w_2 = 15000, \\quad h_2 = 15000.\n$$\n- 对于 $\\ell=3$：\n$$\nN_3 = \\frac{60000}{2^{3}} = 7500, \\quad w_3 = 7500, \\quad h_3 = 7500.\n$$\n\n按要求收集有序序列 $(w_0,h_0,w_1,h_1,w_2,h_2,w_3,h_3)$ 得到\n$$\n(60000,\\,60000,\\,30000,\\,30000,\\,15000,\\,15000,\\,7500,\\,7500).\n$$\n所有条目都是整数，这与下采样产生精确整数像素数的假设一致。", "answer": "$$\\boxed{\\begin{pmatrix}60000  60000  30000  30000  15000  15000  7500  7500\\end{pmatrix}}$$", "id": "4948984"}]}