{"hands_on_practices": [{"introduction": "在生物学中，像细胞命运和潜能这样的复杂概念，可以通过数学工具进行严格的定义。本练习将细胞谱系抽象地表示为一个有向图，其中节点代表细胞状态，边代表分化路径。这种方法让我们可以用计算的思维，将“多能性”这一生物学定义——即分化成三个胚层（外胚层、中胚层、内胚层）的能力——转化为一个明确的图论问题。通过这个实践，你将学习如何运用这种强大的抽象思维来分析细胞潜能，这是系统生物学中的一项基本技能 [@problem_id:4931821]。", "problem": "您的任务是在一个干细胞分化的有向状态转换模型中将多能性形式化，并实现一个算法来测试指定起始状态的多能性。其生物学基础是，多能性是能够分化成所有三个胚层（外胚层、中胚层和内胚层）衍生物的能力。在谱系图中，一个节点代表一个细胞状态。一条有向边代表一个从一个状态到另一个状态的允许的分化转换。如果一个节点在允许的转换下可以到达所有三个胚层的终端节点，那么该节点就是多能性的。\n\n基本基础：\n- 发育生物学中的多能性定义：一个多能性细胞可以分化为所有三个胚层（ectoderm、mesoderm、endoderm）的衍生物。\n- 有向图的可达性：在有向图 $G=(V,E)$ 中，如果存在一条从节点 $s$ 到节点 $t$ 的长度 $\\ge 0$ 的有向路径，则称节点 $t$ 是从节点 $s$ 可达的。\n\n形式上，令 $G=(V,E)$ 为一个有向图，其中 $V$ 是谱系状态的集合，$E \\subseteq V \\times V$ 编码了允许的转换。令 $T=\\{\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$ 表示终端胚层节点的集合。定义可达性谓词 $R_G(s,t)$ 为真，当且仅当在 $G$ 中存在一条从 $s$ 到 $t$ 的长度 $\\ge 0$ 的有向路径。定义多能性谓词：\n$$\nP_G(s) = \\bigwedge_{t \\in T} R_G(s,t),\n$$\n也就是说，$P_G(s)$ 为真，当且仅当 $s$ 可以到达 $T$ 中的所有三个胚层终端节点。\n\n您的程序必须实现一个图搜索算法，以评估给定测试用例的 $P_G(s)$。该程序应是确定性的，并且不得需要任何外部输入。它必须生成单行输出，其格式应严格为方括号内由逗号分隔的布尔结果列表（例如，$[\\mathrm{True},\\mathrm{False}]$）。\n\n测试套件：\n为以下8个有向图和查询节点提供结果，这些测试旨在探查“理想路径”、受限的多能性、终端定型、循环和缺失目标。对于每个图 $G_i=(V_i,E_i)$，集合 $T$ 均假定为相同的 $\\{\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$。\n\n- 测试用例 1：$G_1$ 模拟一个胚胎干细胞（ESC）。\n  $V_1=\\{\\mathrm{ESC},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$，\n  $E_1=\\{(\\mathrm{ESC},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$。\n  查询 $s_1=\\mathrm{ESC}$。预期生物学行为：多能性。\n\n- 测试用例 2：$G_2$ 模拟一个被重编程为类似ESC状态的诱导性多能干细胞（iPSC）。\n  $V_2=\\{\\mathrm{iPSC},\\mathrm{ESC\\_like},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$，\n  $E_2=\\{(\\mathrm{iPSC},\\mathrm{ESC\\_like}),(\\mathrm{ESC\\_like},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$。\n  查询 $s_2=\\mathrm{iPSC}$。预期生物学行为：多能性。\n\n- 测试用例 3：$G_3$ 模拟一个造血干细胞（HSC），它是一种成体干细胞（ASC），对中胚层衍生物具有多能性。\n  $V_3=\\{\\mathrm{HSC},\\mathrm{Mesoderm},\\mathrm{Ectoderm},\\mathrm{Endoderm}\\}$，\n  $E_3=\\{(\\mathrm{HSC},\\mathrm{Mesoderm})\\}$。\n  查询 $s_3=\\mathrm{HSC}$。预期生物学行为：非多能性。\n\n- 测试用例 4：$G_4$ 模拟一个神经干细胞（NSC），它是一种仅限于外胚层的祖细胞。\n  $V_4=\\{\\mathrm{NSC},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$，\n  $E_4=\\{(\\mathrm{NSC},\\mathrm{Ectoderm})\\}$。\n  查询 $s_4=\\mathrm{NSC}$。预期生物学行为：非多能性。\n\n- 测试用例 5：$G_5$ 模拟上胚层（Epiblast），它可以生成所有三个胚层。\n  $V_5=\\{\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$，\n  $E_5=\\{(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$。\n  查询 $s_5=\\mathrm{Epiblast}$。预期生物学行为：多能性。\n\n- 测试用例 6：$G_6$ 模拟一个缺少向内胚层转换的ESC图。\n  $V_6=\\{\\mathrm{ESC},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm}\\}$，\n  $E_6=\\{(\\mathrm{ESC},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm})\\}$。\n  查询 $s_6=\\mathrm{ESC}$。预期生物学行为：非多能性，因为内胚层不可达。\n\n- 测试用例 7：$G_7$ 包含一个在始发态多能性状态和上胚层之间的循环，但保留了通往所有三个胚层的路径。\n  $V_7=\\{\\mathrm{Primed\\_ESC},\\mathrm{Epiblast},\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$，\n  $E_7=\\{(\\mathrm{Primed\\_ESC},\\mathrm{Epiblast}),(\\mathrm{Epiblast},\\mathrm{Primed\\_ESC}),(\\mathrm{Epiblast},\\mathrm{Ectoderm}),(\\mathrm{Epiblast},\\mathrm{Mesoderm}),(\\mathrm{Epiblast},\\mathrm{Endoderm})\\}$。\n  查询 $s_7=\\mathrm{Primed\\_ESC}$。预期生物学行为：多能性。\n\n- 测试用例 8：$G_8$ 直接查询一个终端节点。\n  $V_8=\\{\\mathrm{Ectoderm},\\mathrm{Mesoderm},\\mathrm{Endoderm}\\}$，\n  $E_8=\\varnothing$。\n  查询 $s_8=\\mathrm{Ectoderm}$。预期生物学行为：非多能性，因为它无法到达另外两个胚层。\n\n输出规范：\n- 您的程序应生成单行输出，其中按顺序包含测试用例1到8的结果，格式为方括号内由逗号分隔的列表，例如 $[\\mathrm{True},\\mathrm{False},\\dots]$。\n- 不涉及物理单位、角度单位或百分比；输出为布尔值。", "solution": "该问题要求我们使用有向图模型来形式化并测试多能性这一生物学概念。所提供的多能性定义基于发育生物学和图论的基本原理，使得该问题在科学上和数学上都是合理的。\n\n如果一个细胞状态可以分化为所有三个主要胚层（外胚层、中胚层和内胚层）的细胞，则该状态被认为是多能性的。在给定模型中，这被转化为一个图论中的可达性问题。使用一个有向图 $G=(V,E)$，其中 $V$ 代表细胞状态（节点）的集合，$E$ 代表允许的分化转换（有向边）的集合。三个胚层由一个固定的终端节点集合 $T=\\{\\mathrm{Ectoderm}, \\mathrm{Mesoderm}, \\mathrm{Endoderm}\\}$ 表示。\n\n状态 $s \\in V$ 的多能性通过谓词 $P_G(s)$ 进行评估，其定义如下：\n$$\nP_G(s) = \\bigwedge_{t \\in T} R_G(s,t)\n$$\n这里，$R_G(s,t)$ 是一个可达性谓词，它为真当且仅当存在一条从状态 $s$ 到状态 $t$ 的长度大于或等于 $0$ 的有向路径。长度为 $0$ 的路径意味着任何节点都可以从其自身到达。逻辑合取（$\\bigwedge$）表示，要使 $s$ 具有多能性，它必须能够到达集合 $T$ 中的*每一个*终端节点。\n\n为了实现一个解决方案，我们必须设计一个算法来为8个给定的测试用例中的每一个检查谓词 $P_G(s)$。这涉及到在每个图 $G_i$ 内，验证从给定的起始节点 $s_i$ 到 $T$ 中所有三个目标节点的可达性。\n\n问题的核心是解决可达性谓词 $R_G(s,t)$。在有向图中确定可达性的一个标准且高效的算法是广度优先搜索（BFS）。对于给定的起始节点 $s$ 和目标节点 $t$，BFS系统地逐层探索图，保证如果存在到 $t$ 的路径，它就能找到。该算法维护一个待访问节点的队列和一个已访问节点的集合，以避免冗余探索并正确处理带循环的图（如测试用例7）。\n\n评估 $P_G(s)$ 的总体算法如下：\n1. 对于给定的图 $G=(V,E)$ 和查询节点 $s$，遍历集合 $T=\\{\\mathrm{Ectoderm}, \\mathrm{Mesoderm}, \\mathrm{Endoderm}\\}$ 中的每个目标节点 $t$。\n2. 对于每个 $t$，确定它是否可以从 $s$ 到达。这通过从 $s$ 开始执行BFS遍历来完成。\n   a. 一个重要的初始检查是目标节点 $t$ 是否存在于图的顶点集 $V$ 中。如果 $t \\notin V$，则从任何 $s \\in V$ 到 $t$ 的路径都不可能存在，因此 $R_G(s,t)$ 为假。这与测试用例6相关，其中图 $G_6$ 缺少 $\\mathrm{Endoderm}$ 节点。\n   b. BFS遍历首先将 $s$ 放入一个队列中。然后它重复地从队列中取出一个节点，并对于其每个未访问的邻居，将其标记为已访问并添加到队列中。如果遇到 $t$，则搜索成功终止。如果队列变空而 $t$ 仍未被找到，则 $t$ 从 $s$ 是不可达的。\n3. 如果发现 $T$ 中的任何目标 $t$ 从 $s$ 是不可达的，则合取式 $P_G(s)$ 变为假。该测试用例的算法可以提前终止并报告结果为 `False`。\n4. 如果算法成功验证了 $T$ 中的所有三个节点都可以从 $s$ 到达，则 $P_G(s)$ 为真。\n\n此过程应用于所提供的8个测试用例中的每一个。每个测试用例的图都构建为邻接表，这是从每个节点到其直接后继节点列表的映射，由边集 $E_i$ 定义。这种数据结构对于像BFS这样的图遍历算法非常高效。最终输出是 $P_{G_1}(s_1), P_{G_2}(s_2), \\dots, P_{G_8}(s_8)$ 的布尔评估结果的有序列表。", "answer": "```python\nimport numpy as np\nfrom collections import deque\n\ndef solve():\n    \"\"\"\n    Solves the pluripotency evaluation problem for a series of test cases.\n    \"\"\"\n    \n    # The fixed set of terminal germ layer nodes.\n    T = {\"Ectoderm\", \"Mesoderm\", \"Endoderm\"}\n\n    # Define the 8 test cases as specified in the problem.\n    # Each case is a tuple: (Vertex set V, Edge set E, start node s).\n    test_cases = [\n        # Test case 1: ESC\n        (\n            {\"ESC\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"ESC\", \"Epiblast\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"ESC\"\n        ),\n        # Test case 2: iPSC\n        (\n            {\"iPSC\", \"ESC_like\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"iPSC\", \"ESC_like\"), (\"ESC_like\", \"Epiblast\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"iPSC\"\n        ),\n        # Test case 3: HSC (multipotent, not pluripotent)\n        (\n            {\"HSC\", \"Mesoderm\", \"Ectoderm\", \"Endoderm\"},\n            {(\"HSC\", \"Mesoderm\")},\n            \"HSC\"\n        ),\n        # Test case 4: NSC (unipotent/multipotent, not pluripotent)\n        (\n            {\"NSC\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"NSC\", \"Ectoderm\")},\n            \"NSC\"\n        ),\n        # Test case 5: Epiblast\n        (\n            {\"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"Epiblast\"\n        ),\n        # Test case 6: Missing Endoderm target node\n        (\n            {\"ESC\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\"},\n            {(\"ESC\", \"Epiblast\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\")},\n            \"ESC\"\n        ),\n        # Test case 7: Graph with a cycle\n        (\n            {\"Primed_ESC\", \"Epiblast\", \"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            {(\"Primed_ESC\", \"Epiblast\"), (\"Epiblast\", \"Primed_ESC\"), (\"Epiblast\", \"Ectoderm\"), (\"Epiblast\", \"Mesoderm\"), (\"Epiblast\", \"Endoderm\")},\n            \"Primed_ESC\"\n        ),\n        # Test case 8: Querying a terminal node\n        (\n            {\"Ectoderm\", \"Mesoderm\", \"Endoderm\"},\n            set(), # Empty edge set\n            \"Ectoderm\"\n        )\n    ]\n\n    def is_reachable(adj_list, vertex_set, start_node, target_node):\n        \"\"\"\n        Determines if a target_node is reachable from a start_node using BFS.\n        A path of length >= 0 is considered.\n        \"\"\"\n        # A node is not reachable if it's not part of the graph's vertex set.\n        if target_node not in vertex_set:\n            return False\n\n        # A node is always reachable from itself (path of length 0).\n        if start_node == target_node:\n            return True\n\n        q = deque([start_node])\n        visited = {start_node}\n\n        while q:\n            current_node = q.popleft()\n            \n            # Get neighbors from adjacency list\n            neighbors = adj_list.get(current_node, [])\n            \n            for neighbor in neighbors:\n                if neighbor == target_node:\n                    return True\n                if neighbor not in visited:\n                    visited.add(neighbor)\n                    q.append(neighbor)\n        \n        return False\n\n    def check_pluripotency(V, E, s, T_targets):\n        \"\"\"\n        Evaluates the pluripotency predicate P_G(s).\n        \"\"\"\n        # Build adjacency list from the edge set for efficient traversal.\n        adj_list = {}\n        for u, v in E:\n            if u not in adj_list:\n                adj_list[u] = []\n            adj_list[u].append(v)\n            \n        # Check reachability for every target in T.\n        for target in T_targets:\n            if not is_reachable(adj_list, V, s, target):\n                return False # If any target is not reachable, P_G(s) is false.\n        \n        # If all targets were reachable, P_G(s) is true.\n        return True\n\n    results = []\n    for V_i, E_i, s_i in test_cases:\n        result = check_pluripotency(V_i, E_i, s_i, T)\n        results.append(result)\n\n    # Format the output as a comma-separated list of booleans in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "4931821"}, {"introduction": "在理解了如何定义细胞潜能之后，下一步是探究干细胞群体如何随时间维持其数量，这对于组织稳态至关重要。本练习引入了概率论中的一个经典工具——分支过程，来模拟造血干细胞（HSC）随机的命运选择。通过推导群体数量保持稳定所需的数学条件，你将深入理解自我更新、分化和细胞凋亡之间必须维持的精妙平衡，而这正是生命组织维持功能的基石 [@problem_id:4931794]。", "problem": "一个造血干细胞（HSC）以离散的代际进行随机分裂，其命运选择如下：以概率 $p_{s}$ 进行对称性自我更新，产生两个HSC；以概率 $p_{a}$ 进行不对称分裂，产生一个HSC和一个定型祖细胞；以概率 $p_{d}$ 进行对称性分化，产生两个定型祖细胞（因此没有HSC）。假设 $p_{s}+p_{a}+p_{d}=1$，并且每个新产生的HSC子细胞独立存活到下一代的概率为 $1-\\alpha$，其中 $\\alpha \\in [0,1)$ 代表微环境介导的损耗或细胞凋亡。使用这些后代概率和存活率，将HSC的数量建模为一个Galton–Watson分支过程。\n\n令 $\\Delta N$ 表示由单个分裂的HSC从一代到下一代所贡献的HSC数量变化，即 $\\Delta N = N_{t+1}-N_{t}$，其中对于被追踪的亲代细胞，$N_{t}=1$。使用概率论中期望的基本定义和上述后代分布，推导出期望净变化 $\\mathbb{E}[\\Delta N]$（用 $p_{s}$、$p_{a}$、$p_{d}$ 和 $\\alpha$ 表示）。然后施加稳态条件 $\\mathbb{E}[\\Delta N]=0$，并求解维持稳定HSC种群所需的自我更新概率 $p_{s}$，将其表示为 $p_{d}$ 和 $\\alpha$ 的函数。请给出稳态自我更新概率 $p_{s}^{*}$ 的闭式表达式作为最终答案，该表达式仅含 $p_{d}$ 和 $\\alpha$。不需要进行数值近似或四舍五入。", "solution": "### 步骤1：提取已知条件\n-   单个造血干细胞（HSC）进行随机分裂。\n-   命运选择及其概率：\n    -   对称性自我更新（产生2个HSC）：概率 $p_{s}$。\n    -   不对称分裂（产生1个HSC）：概率 $p_{a}$。\n    -   对称性分化（产生0个HSC）：概率 $p_{d}$。\n-   概率约束：$p_{s}+p_{a}+p_{d}=1$。\n-   每个新产生的HSC子细胞存活到下一代的概率为 $1-\\alpha$。\n-   $\\alpha \\in [0,1)$ 是损耗或细胞凋亡的概率。\n-   HSC的数量被建模为一个Galton–Watson分支过程。\n-   $\\Delta N$ 是由单个亲代HSC产生的HSC数量变化，即 $\\Delta N = N_{t+1}-N_{t}$，其中 $N_{t}=1$。\n-   目标是推导期望净变化 $\\mathbb{E}[\\Delta N]$，然后求解稳态自我更新概率 $p_{s}^{*}$（其中 $\\mathbb{E}[\\Delta N]=0$），将其表示为 $p_{d}$ 和 $\\alpha$ 的函数。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题使用标准的Galton-Watson分支过程来模拟干细胞种群动态。对称/不对称分裂、自我更新、分化和细胞凋亡等概念在干细胞生物学和组织学中是基础且公认的。该模型是一个简化模型，但具有科学合理性。\n-   **良态问题**：该问题在数学上是良定义的。概率有适当的约束，变量描述清晰。任务是推导一个表达式并求解一个方程，这是一个标准的数学过程。存在唯一且有意义的解。\n-   **客观性**：问题以精确、客观的语言陈述，没有歧义或主观性陈述。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n问题要求计算从单个造血干细胞（HSC）开始，从一代到下一代HSC数量的期望净变化。令 $N_t$ 为第 $t$ 代的HSC数量。我们从单个亲代细胞开始，因此 $N_t = 1$。令 $N_{t+1}$ 为源于此单个亲代细胞且在下一代存活的HSC数量。\n\n该过程可分为两个阶段：分裂和存活。\n\n首先，亲代HSC进行分裂。令 $D$ 为代表此次分裂产生的HSC子细胞数量的随机变量。$D$ 的概率分布由问题陈述给出：\n-   $P(D=2) = p_{s}$（对称性自我更新）\n-   $P(D=1) = p_{a}$（不对称分裂）\n-   $P(D=0) = p_{d}$（对称性分化）\n\n紧随分裂后产生的HSC子细胞的期望数量 $\\mathbb{E}[D]$ 为：\n$$\n\\mathbb{E}[D] = (2 \\times P(D=2)) + (1 \\times P(D=1)) + (0 \\times P(D=0))\n$$\n$$\n\\mathbb{E}[D] = 2p_{s} + p_{a}\n$$\n\n其次，这 $D$ 个子细胞中的每一个都必须存活下来才能计入下一代。每个子细胞独立存活的概率为 $1-\\alpha$。令 $N_{t+1}$ 为存活的HSC数量。存活细胞的期望数量 $\\mathbb{E}[N_{t+1}]$ 可以使用全期望定律求得：$\\mathbb{E}[N_{t+1}] = \\mathbb{E}[\\mathbb{E}[N_{t+1}|D]]$。\n\n给定产生了 $D=k$ 个子细胞，存活数量服从试验次数为 $k$、成功概率为 $1-\\alpha$ 的二项分布。该二项分布的期望为 $k(1-\\alpha)$。因此，$\\mathbb{E}[N_{t+1}|D=k] = k(1-\\alpha)$。\n现在，我们可以计算无条件期望 $\\mathbb{E}[N_{t+1}]$：\n$$\n\\mathbb{E}[N_{t+1}] = [2(1-\\alpha)]p_{s} + [1(1-\\alpha)]p_{a} + [0(1-\\alpha)]p_{d}\n$$\n$$\n\\mathbb{E}[N_{t+1}] = (1-\\alpha)(2p_{s} + p_{a})\n$$\n或者，期望存活数量等于期望产生的子细胞数量乘以单个细胞的存活概率：$\\mathbb{E}[N_{t+1}] = \\mathbb{E}[D] \\times (1-\\alpha) = (2p_{s} + p_{a})(1-\\alpha)$。\n\n由这单个亲代细胞产生的HSC数量净变化为 $\\Delta N = N_{t+1} - N_{t}$。由于我们从一个细胞开始，所以 $N_t=1$。\n期望净变化为：\n$$\n\\mathbb{E}[\\Delta N] = \\mathbb{E}[N_{t+1} - 1] = \\mathbb{E}[N_{t+1}] - 1\n$$\n$$\n\\mathbb{E}[\\Delta N] = (1-\\alpha)(2p_{s} + p_{a}) - 1\n$$\n这就是期望净变化的表达式。\n\n接下来，我们施加稳态条件，该条件要求HSC的期望数量保持不变。这意味着期望净变化必须为零：$\\mathbb{E}[\\Delta N] = 0$。\n$$\n(1-\\alpha)(2p_{s} + p_{a}) - 1 = 0\n$$\n问题要求解出稳态自我更新概率，记为 $p_{s}^{*}$，并将其表示为仅含 $p_{d}$ 和 $\\alpha$ 的函数。为此，我们必须从方程中消去 $p_{a}$。我们使用给定的约束条件 $p_{s} + p_{a} + p_{d} = 1$，这意味着 $p_{a} = 1 - p_{s} - p_{d}$。\n\n将这个 $p_{a}$ 的表达式代入稳态方程：\n$$\n(1-\\alpha)(2p_{s} + (1 - p_{s} - p_{d})) - 1 = 0\n$$\n现在，我们简化括号内的项：\n$$\n(1-\\alpha)(p_{s} + 1 - p_{d}) - 1 = 0\n$$\n我们现在求解 $p_{s}$，在此条件下即为 $p_{s}^{*}$：\n$$\n(1-\\alpha)(p_{s}^{*} + 1 - p_{d}) = 1\n$$\n因为 $\\alpha \\in [0, 1)$，所以项 $1-\\alpha$ 非零，我们可以用它来除：\n$$\np_{s}^{*} + 1 - p_{d} = \\frac{1}{1-\\alpha}\n$$\n分离出 $p_{s}^{*}$：\n$$\np_{s}^{*} = \\frac{1}{1-\\alpha} - 1 + p_{d}\n$$\n为简化表达式的第一部分，我们通分：\n$$\np_{s}^{*} = \\frac{1 - (1-\\alpha)}{1-\\alpha} + p_{d}\n$$\n$$\np_{s}^{*} = \\frac{1 - 1 + \\alpha}{1-\\alpha} + p_{d}\n$$\n$$\np_{s}^{*} = \\frac{\\alpha}{1-\\alpha} + p_{d}\n$$\n这就是稳态自我更新概率 $p_{s}^{*}$ 的最终闭式表达式，用损耗概率 $\\alpha$ 和对称性分化概率 $p_{d}$ 表示。", "answer": "$$\\boxed{\\frac{\\alpha}{1-\\alpha} + p_{d}}$$", "id": "4931794"}, {"introduction": "为了将理论与现实世界的实验联系起来，最后一个练习聚焦于实验生物学中的实际挑战。嵌合体实验是检验细胞多能性的“金标准”，但它很容易出现假阴性结果，即有潜能的细胞未能被成功检出。本练习要求你像一名真正的实验科学家一样思考，分析导致实验失败的生物学原因（如发育阶段不匹配或遗传背景不相容），并结合生物学知识和简单的概率计算，设计出一个更灵敏、更可靠的实验方案。这个实践旨在锻炼你在实验室研究中必不可少的批判性思维和解决问题的能力 [@problem_id:4931773]。", "problem": "一个实验室使用嵌合体贡献分析来测试一个多能干细胞 (PSC) 系是否真正能够贡献于胚胎组织。在基线方案中，始发态小鼠外胚层样干细胞被注射入来自非同源宿主品系的 $E3.5$ 囊胚中，并在 $E10.5$ 时通过荧光报告基因对贡献进行量化。该团队怀疑许多表观阴性结果是假阴性，由两种独立的生物学限制因素导致：\n\n- 时期不匹配：供体 PSC 处于一种与植入前宿主环境严重不匹配的细胞状态，导致每个胚胎的失败概率为 $p_s$。\n- 宿主-PSC不相容性：遗传背景依赖的细胞竞争和粘附不匹配降低了整合成功率，导致每个胚胎的失败概率为 $p_i$。\n\n假设当一个 PSC 系是真正多能的时，该分析的灵敏度（真阳性率）是 PSC 在给定宿主胚胎中成功产生可检测贡献的概率。同时假设时期不匹配和宿主-PSC不相容性是独立的失败模式。在基线方案中，$p_s = 0.35$ 且 $p_i = 0.25$。\n\n该团队考虑了以下方案调整，每种调整都附有基于先前初步数据的预期单胚胎失败概率：\n\nA. 使用 $2i$/白血病抑制因子 (LIF) 将 PSC 转化为初始态，并在 $E2.5$ 桑椹胚阶段进行聚集；此外，使用同源宿主品系并进行短暂的细胞周期同步化至 $G1$ 期。预期 $p_s' = 0.15$，$p_i' = 0.15$。\n\nB. 在不改变培养条件的情况下，将更多的始发态 PSC（$n = 20$ 个细胞）注射到远交宿主的 $E3.5$ 囊胚中。由于细胞竞争加剧，预期 $p_s' = 0.40$，$p_i' = 0.25$。\n\nC. 改用四倍体补偿法以“提高灵敏度”，由供体 PSC 提供所有胚胎组织，而宿主细胞则贡献于胚外组织。由于严格的要求和发育停滞的风险，预期 $p_s' = 0.50$，$p_i' = 0.10$。\n\nD. 使用 $2i$/LIF 将 PSC 转化为初始态，但保留原有的非同源宿主品系和囊胚阶段注射。预期 $p_s' = 0.15$，$p_i' = 0.25$。\n\nE. 在保持相同宿主品系和阶段的同时，在始发态 PSC 中瞬时上调 E-钙粘蛋白以改善粘附相容性；预期 $p_s' = 0.25$，$p_i' = 0.20$。\n\n哪个选项既能正确解决导致假阴性的生物学限制因素，又能将预期的分析灵敏度提高到 $S = 0.65$ 以上？\n\n选择一项：\n\nA. 实施初始态转化、桑椹胚聚集、使用同源宿主和细胞周期同步化。\n\nB. 在不改变细胞状态或宿主的情况下，增加注射的始发态供体细胞数量。\n\nC. 使用四倍体补偿法以“提高灵敏度”。\n\nD. 仅实施初始态转化，保留非同源宿主和囊胚阶段注射。\n\nE. 在保持宿主和阶段不变的情况下，在始发态 PSC 中上调 E-钙粘蛋白。", "solution": "该问题陈述被评估为有效。它在科学上基于干细胞生物学和胚胎学的既定原则，问题设置良好，信息充足，可得出唯一解，并以客观、技术性的语言表述。其中没有矛盾、歧义或事实错误。\n\n该问题要求对每个选项进行两部分评估：\n1.  定性评估：所提出的实验设计是否正确解决了所述的两个生物学限制因素，即时期不匹配和宿主-PSC不相容性？\n2.  定量评估：所提出的设计是否将分析的灵敏度 $S$ 提高到阈值 $S = 0.65$ 以上？\n\n分析的灵敏度 $S$ 定义为真阳性率，即成功贡献的概率。问题陈述了两种独立的失败模式：时期不匹配（失败概率为 $p_s$）和宿主-PSC不相容性（失败概率为 $p_i$）。\n\n由于失败模式是独立的，成功的概率要求同时避免两种失败模式。\n不因时期不匹配而失败的概率是 $(1 - p_s)$。\n不因宿主-PSC不相容性而失败的概率是 $(1 - p_i)$。\n\n总的成功概率，即灵敏度 $S$，是这两个独立成功事件概率的乘积：\n$$S = (1 - p_s)(1 - p_i)$$\n\n首先，我们计算基线方案的灵敏度，其中 $p_s = 0.35$ 且 $p_i = 0.25$：\n$$S_{baseline} = (1 - 0.35)(1 - 0.25) = (0.65)(0.75) = 0.4875$$\n这个基线灵敏度远低于 $S = 0.65$ 的目标。\n\n现在，我们将根据这两个标准评估每个选项。\n\n**选项 A 的评估：**\n- **生物学原理：** 此选项建议使用 $2i$/LIF 将 PSC 转化为初始态，与 $E2.5$ 桑椹胚进行聚集，使用同源宿主，并将细胞周期同步化至 G1 期。\n    - *解决时期不匹配：* 将始发态 PSC（类似于植入后外胚层）转化为初始态，使其更类似于植入前囊胚的内细胞团细胞。将其与桑椹胚（$E2.5$）聚集而非注射入囊胚（$E3.5$），对于初始态细胞也是更好的时期匹配。将细胞周期同步化至 G1 期进一步增强了整合。这全面地解决了时期不匹配的限制。\n    - *解决宿主-PSC不相容性：* 使用同源宿主品系意味着供体细胞和宿主胚胎的遗传背景是匹配的。这直接消除了遗传背景依赖的细胞竞争和粘附不匹配的主要原因。\n    - 该选项正确地解决了所述的两个生物学限制因素。\n\n- **定量分析：** 预期的失败概率为 $p_s' = 0.15$ 和 $p_i' = 0.15$。新的灵敏度 $S_A'$ 为：\n$$S_A' = (1 - 0.15)(1 - 0.15) = (0.85)(0.85) = 0.7225$$\n该值满足条件 $S_A' > 0.65$。\n\n- **结论：** 正确。该选项解决了两个生物学限制因素，并达到了所需的灵敏度阈值。\n\n**选项 B 的评估：**\n- **生物学原理：** 此选项建议将更多数量的始发态细胞（$n = 20$）注射到远交宿主中。\n    - *解决时期不匹配：* 细胞状态（始发态）和宿主阶段（$E3.5$）未改变，因此基本的时期不匹配问题未得到解决。问题指出，这实际上使与时期相关的失败概率恶化为 $p_s' = 0.40$。\n    - *解决宿主-PSC不相容性：* 使用远交宿主可能会增加遗传变异性，从而可能加剧不相容性。虽然注射更多细胞有时是为了增加获得嵌合体的机会，但它也可能增加细胞竞争，这是不相容性的一个组成部分。问题指出 $p_i'$ 未改变。\n    - 该选项未能正确解决生物学限制因素。\n\n- **定量分析：** 预期的失败概率为 $p_s' = 0.40$ 和 $p_i' = 0.25$。新的灵敏度 $S_B'$ 为：\n$$S_B' = (1 - 0.40)(1 - 0.25) = (0.60)(0.75) = 0.4500$$\n该值不满足条件 $S_B' > 0.65$。它甚至低于基线水平。\n\n- **结论：** 错误。该选项在生物学原理和定量分析上均不成立。\n\n**选项 C 的评估：**\n- **生物学原理：** 此选项建议改用四倍体补偿法。在该分析中，宿主胚胎是四倍体，只能形成胚外组织，迫使二倍体的供体 PSC 形成整个胚胎本身。\n    - *解决限制因素：* 这种方法规避了宿主与 PSC 对胚胎生态位的竞争（因为没有宿主胚胎细胞），这反映在较低的 $p_i' = 0.10$ 上。然而，这是一个极其严苛的分析，由于对供体细胞施加了沉重负担，其完全发育失败的几率很高。这代表了一种新的、更严重的“时期不匹配”或发育不相容性，反映在非常高的 $p_s' = 0.50$ 上。“提高灵敏度”一词带有引号，很可能表明虽然它是一种更严格（敏感）的多能性*测试*，但其成功率很低（统计灵敏度低）。\n    - 此选项并未“修复”原始问题，而是用一个不同的、更具挑战性的范式取而代之。它不是一种可靠提高成功率的方法。\n\n- **定量分析：** 预期的失败概率为 $p_s' = 0.50$ 和 $p_i' = 0.10$。新的灵敏度 $S_C'$ 为：\n$$S_C' = (1 - 0.50)(1 - 0.10) = (0.50)(0.90) = 0.4500$$\n该值不满足条件 $S_C' > 0.65$。\n\n- **结论：** 错误。该选项未通过定量标准，且其生物学原理与提高成功率的目标不一致。\n\n**选项 D 的评估：**\n- **生物学原理：** 此选项建议将 PSC 转化为初始态，但保留非同源宿主和囊胚注射。\n    - *解决时期不匹配：* 转化为初始态正确地解决了时期不匹配问题，这反映在改善的 $p_s' = 0.15$ 上。\n    - *解决宿主-PSC不相容性：* 保留非同源宿主意味着遗传不相容性问题未得到解决。这反映在未改变的 $p_i' = 0.25$ 上。\n    - 该选项仅正确解决了两个生物学限制因素中的一个。\n\n- **定量分析：** 预期的失败概率为 $p_s' = 0.15$ 和 $p_i' = 0.25$。新的灵敏度 $S_D'$ 为：\n$$S_D' = (1 - 0.15)(1 - 0.25) = (0.85)(0.75) = 0.6375$$\n该值不满足条件 $S_D' > 0.65$。虽然很接近，但未能达到阈值。\n\n- **结论：** 错误。该选项未通过定量标准，并且只部分解决了生物学问题。\n\n**选项 E 的评估：**\n- **生物学原理：** 此选项建议在始发态 PSC 中瞬时上调 E-钙粘蛋白。\n    - *解决时期不匹配：* 这并未改变基本的始发态细胞状态，因此核心的时期不匹配问题未得到解决，尽管改善的粘附可能部分减轻其影响。这反映在 $p_s'$ 适度改善至 $0.25$。\n    - *解决宿主-PSC不相容性：* 上调 E-钙粘蛋白可以改善细胞间粘附，直接针对宿主-PSC不相容性的一个方面（“粘附不匹配”）。这反映在 $p_i'$ 适度改善至 $0.20$。\n    - 该选项部分解决了与两个限制相关的机制，但没有像选项 A 那样全面地解决根本原因。\n\n- **定量分析：** 预期的失败概率为 $p_s' = 0.25$ 和 $p_i' = 0.20$。新的灵敏度 $S_E'$ 为：\n$$S_E' = (1 - 0.25)(1 - 0.20) = (0.75)(0.80) = 0.6000$$\n该值不满足条件 $S_E' > 0.65$。\n\n- **结论：** 错误。该选项未通过定量标准。\n\n**总结：**\n只有选项 A 成功满足了两个要求。它提出了一个生物学上合理的策略，全面解决了假阴性的两个来源（时期不匹配和宿主不相容性），并且计算出的灵敏度（$0.7225$）超过了 $0.65$ 的要求阈值。", "answer": "$$\\boxed{A}$$", "id": "4931773"}]}