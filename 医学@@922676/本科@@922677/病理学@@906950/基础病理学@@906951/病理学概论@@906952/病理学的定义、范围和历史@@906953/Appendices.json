{"hands_on_practices": [{"introduction": "本练习将演示诊断测试开发中的一个关键步骤，即如何选择一个最佳的诊断阈值。通过分析受试者工作特征（ROC）曲线数据并计算约登指数（Youden's index），您将学会如何在灵敏度（$Se$）和特异性（$Sp$）之间进行权衡，以确定一个能最大限度发挥测试诊断效能的临界值[@problem_id:4352837]。", "problem": "病理学被定义为研究疾病的科学，其范围包括开发、验证和解读用于区分疾病与健康的诊断测试。历史上，在受试者工作特征（ROC）分析的辅助下，病理学家们从定性的形态学判断转向了定量的决策制定，ROC分析将灵敏度与特异性之间的权衡进行了形式化。考虑一项用于某种疾病的生物标志物检测，单位为纳克/毫升（ng/mL），该检测应用于一个包含$200$名个体的队列，其中$100$人患有该疾病，另外$100$人未患病。对于给定的决策阈值$T$（单位 ng/mL），如果生物标志物水平$\\geq T$，则测试将个体判定为阳性，否则为阴性。对于以下阈值，观察到的真阳性（$\\text{TP}$）、假阴性（$\\text{FN}$）、真阴性（$\\text{TN}$）和假阳性（$\\text{FP}$）计数如下：\n\n$T=1.5$ ng/mL: $\\text{TP}=95$, $\\text{FN}=5$, $\\text{TN}=20$, $\\text{FP}=80$.\n\n$T=2.0$ ng/mL: $\\text{TP}=92$, $\\text{FN}=8$, $\\text{TN}=30$, $\\text{FP}=70$.\n\n$T=2.8$ ng/mL: $\\text{TP}=88$, $\\text{FN}=12$, $\\text{TN}=45$, $\\text{FP}=55$.\n\n$T=3.6$ ng/mL: $\\text{TP}=82$, $\\text{FN}=18$, $\\text{TN}=65$, $\\text{FP}=35$.\n\n$T=4.5$ ng/mL: $\\text{TP}=75$, $\\text{FN}=25$, $\\text{TN}=78$, $\\text{FP}=22$.\n\n$T=5.2$ ng/mL: $\\text{TP}=68$, $\\text{FN}=32$, $\\text{TN}=85$, $\\text{FP}=15$.\n\n$T=6.0$ ng/mL: $\\text{TP}=60$, $\\text{FN}=40$, $\\text{TN}=90$, $\\text{FP}=10$.\n\n$T=7.5$ ng/mL: $\\text{TP}=50$, $\\text{FN}=50$, $\\text{TN}=95$, $\\text{FP}=5$.\n\n运用病理学中关于测试性能的基本原理，简要解释在ROC框架内如何通过平衡灵敏度与特异性来选择诊断阈值，并由此推导出选择最佳阈值的常用标准。然后，计算对于上述数据集，哪个阈值$T$能使该标准最大化。如果多个阈值并列，选择最低的$T$。以 ng/mL 为单位表示最终阈值，并将您的数值答案四舍五入到两位有效数字。最终答案必须是单个实数值。", "solution": "该问题要求利用所提供的数据集，通过平衡灵敏度和特异性，来确定一个生物标志物的最佳诊断阈值。\n\n首先，需要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 队列总人数：$200$人。\n- 患病个体数：$N_D = 100$。\n- 未患病个体数：$N_{ND} = 100$。\n- 测试条件：若生物标志物水平$\\geq T$则为阳性，若生物标志物水平$ T$则为阴性。\n- 不同阈值$T$（单位 ng/mL）的观测数据：\n  - $T=1.5$: $\\text{TP}=95$, $\\text{FN}=5$, $\\text{TN}=20$, $\\text{FP}=80$.\n  - $T=2.0$: $\\text{TP}=92$, $\\text{FN}=8$, $\\text{TN}=30$, $\\text{FP}=70$.\n  - $T=2.8$: $\\text{TP}=88$, $\\text{FN}=12$, $\\text{TN}=45$, $\\text{FP}=55$.\n  - $T=3.6$: $\\text{TP}=82$, $\\text{FN}=18$, $\\text{TN}=65$, $\\text{FP}=35$.\n  - $T=4.5$: $\\text{TP}=75$, $\\text{FN}=25$, $\\text{TN}=78$, $\\text{FP}=22$.\n  - $T=5.2$: $\\text{TP}=68$, $\\text{FN}=32$, $\\text{TN}=85$, $\\text{FP}=15$.\n  - $T=6.0$: $\\text{TP}=60$, $\\text{FN}=40$, $\\text{TN}=90$, $\\text{FP}=10$.\n  - $T=7.5$: $\\text{TP}=50$, $\\text{FN}=50$, $\\text{TN}=95$, $\\text{FP}=5$.\n\n**步骤2：使用提取的已知条件进行验证**\n- 该问题在科学上基于生物统计学和诊断测试评估的原理。\n- 数据内部一致。对于每个阈值$T$，真阳性（$\\text{TP}$）和假阴性（$\\text{FN}$）之和必须等于患病个体总数（$N_D$），而真阴性（$\\text{TN}$）和假阳性（$\\text{FP}$）之和必须等于未患病个体总数（$N_{ND}$）。\n- 一致性检查：对于每个给定的阈值，都有$\\text{TP} + \\text{FN} = 100$以及$\\text{TN} + \\text{FP} = 100$。例如，当$T=1.5$时，$95 + 5 = 100$且$20 + 80 = 100$。这对所有数据点都成立。\n- 数据也遵循预期的单调趋势：随着阈值$T$的增加，灵敏度下降而特异性上升。这可以从数据中观察到，$\\text{TP}$值是非递增的（$95, 92, 88, ...$），而$\\text{TN}$值是非递减的（$20, 30, 45, ...$）。\n- 该问题提法得当、客观，并且不包含科学缺陷或矛盾。\n\n**步骤3：结论与行动**\n该问题有效。将提供解答。\n\n**求解过程**\n\n在诊断医学中，一项测试的性能由其正确分类个体的能力来表征。两个主要指标是灵敏度和特异性。\n\n灵敏度，也称为真阳性率（$\\text{TPR}$），衡量实际阳性样本中被正确识别为阳性的比例。\n$$ \\text{Sensitivity (TPR)} = \\frac{\\text{TP}}{\\text{TP} + \\text{FN}} = \\frac{\\text{Number of correctly identified diseased individuals}}{\\text{Total number of diseased individuals}} $$\n\n特异性，也称为真阴性率（$\\text{TNR}$），衡量实际阴性样本中被正确识别为阴性的比例。\n$$ \\text{Specificity (TNR)} = \\frac{\\text{TN}}{\\text{TN} + \\text{FP}} = \\frac{\\text{Number of correctly identified non-diseased individuals}}{\\text{Total number of non-diseased individuals}} $$\n\n受试者工作特征（ROC）曲线通过绘制不同阈值设置下的灵敏度（$\\text{TPR}$）与$1 - \\text{特异性}$（假阳性率，$\\text{FPR}$）的对应关系，来可视化这两个指标之间的权衡。\n一个理想的测试将具有$1$的灵敏度和$1$的特异性，对应于ROC图上的点$(0, 1)$（其中x轴是$1 - \\text{特异性}$）。随机猜测的测试对应于对角线$\\text{TPR} = \\text{FPR}$。\n\n选择“最佳”阈值涉及在ROC曲线上找到一个代表灵敏度与特异性之间最佳平衡的点。“最佳”的具体定义取决于临床背景（例如，假阳性与假阴性的相对成本）。然而，在没有给出具体成本时，一个通用且客观的标准是最大化测试性能与随机猜测之间的差距。这可以通过找到使约登指数（Youden's J statistic 或 Youden's index）$J$最大化的阈值来实现。\n\n约登指数J的定义为：\n$$ J = \\text{Sensitivity} + \\text{Specificity} - 1 $$\n该值表示ROC曲线到无差别线（对角线）的最大垂直距离。最大化$J$等同于最大化灵敏度与特异性之和，从而为它们之间的平衡提供了一个定量度量。\n\n对于给定的问题，患病个体数为$N_D = 100$，未患病个体数为$N_{ND} = 100$。对于每个阈值$T$，灵敏度和特异性的公式简化为：\n$$ \\text{Sensitivity} = \\frac{\\text{TP}}{100} $$\n$$ \\text{Specificity} = \\frac{\\text{TN}}{100} $$\n因此，约登指数J为：\n$$ J(T) = \\frac{\\text{TP} + \\text{TN} - 100}{100} $$\n\n我们现在为每个给定的阈值计算$J$：\n- 对于 $T=1.5$：$J = \\frac{95 + 20 - 100}{100} = \\frac{15}{100} = 0.15$\n- 对于 $T=2.0$：$J = \\frac{92 + 30 - 100}{100} = \\frac{22}{100} = 0.22$\n- 对于 $T=2.8$：$J = \\frac{88 + 45 - 100}{100} = \\frac{33}{100} = 0.33$\n- 对于 $T=3.6$：$J = \\frac{82 + 65 - 100}{100} = \\frac{47}{100} = 0.47$\n- 对于 $T=4.5$：$J = \\frac{75 + 78 - 100}{100} = \\frac{53}{100} = 0.53$\n- 对于 $T=5.2$：$J = \\frac{68 + 85 - 100}{100} = \\frac{53}{100} = 0.53$\n- 对于 $T=6.0$：$J = \\frac{60 + 90 - 100}{100} = \\frac{50}{100} = 0.50$\n- 对于 $T=7.5$：$J = \\frac{50 + 95 - 100}{100} = \\frac{45}{100} = 0.45$\n\n约登指数J的最大值为$0.53$。这个最大值出现在两个阈值处：$T=4.5$ ng/mL 和 $T=5.2$ ng/mL。问题规定，在出现并列的情况下，应选择最低的阈值。\n\n因此，根据指定的打破并列规则，使约登指数J最大化的最佳阈值是$T = 4.5$ ng/mL。问题要求将答案四舍五入到两位有效数字。数值$4.5$已经有两位有效数字。", "answer": "$$\\boxed{4.5}$$", "id": "4352837"}, {"introduction": "评估诊断测试的性能是循证病理学的基础。本练习将指导您如何根据原始分类数据计算灵敏度（$Se$）、特异性（$Sp$）和准确率（accuracy）等核心性能指标。您还将计算阳性似然比（$LR^{+}$）和阴性似然比（$LR^{-}$），这些指标量化了测试结果在多大程度上改变了对疾病可能性的判断[@problem_id:4352884]。", "problem": "自从病理学通过细胞病理学得以正式确立以及循证检验医学兴起以来，其核心职能之一便是利用源于观测结果的、定义明确的概率度量来定量评估诊断测试。考虑一个由病理学实验室评估的二元诊断分析，其计数如下：真阳性 $TP = 80$，假阳性 $FP = 20$，真阴性 $TN = 180$，以及假阴性 $FN = 20$。仅使用概率论和诊断测试中的基本定义，计算以下量：\n- 灵敏度 $Se$，\n- 特异度 $Sp$，\n- 准确度，\n- 阳性似然比 $LR^{+}$，以及\n- 阴性似然比 $LR^{-}$。\n\n从基本原理出发：将每个量定义为基于“患病”和“测试阳性”事件及其对立事件的适当条件概率或频率比，然后用这些定义来表示 $LR^{+}$ 和 $LR^{-}$。在计算出数值后，简要解释在病理学决策框架内，当从测试前概率更新到测试后概率时，$LR^{+}$ 和 $LR^{-}$ 的大小将如何影响临床决策阈值。\n\n将每个最终数值四舍五入到三位有效数字，并将所有量表示为无量纲小数（不要使用百分比表示法）。在您的最终答案中，请按 $Se$、$Sp$、准确度、$LR^{+}$、$LR^{-}$ 的顺序报告这五个结果。", "solution": "该问题是有效的，因为它具有科学依据、适定且客观。它为诊断病理学中的一项标准定量分析任务提供了一套完整且一致的数据（$TP, FP, TN, FN$），该任务是计算二元分析的基本性能指标。所有术语均为标准术语，所需的计算直接遵循概率论和统计学的既定原则。\n\n我们首先正式定义事件以及从所提供数据中导出的量。\n设 $D^{+}$ 为受试者患有该疾病（病情阳性）的事件， $D^{-}$ 为受试者未患该疾病（病情阴性）的事件。\n设 $T^{+}$ 为测试结果为阳性的事件， $T^{-}$ 为测试结果为阴性的事件。\n\n提供的计数如下：\n- 真阳性（$TP$）：患病且测试结果为阳性的受试者数量。$N(D^{+} \\cap T^{+}) = TP = 80$。\n- 假阳性（$FP$）：未患病但测试结果为阳性的受试者数量。$N(D^{-} \\cap T^{+}) = FP = 20$。\n- 真阴性（$TN$）：未患病且测试结果为阴性的受试者数量。$N(D^{-} \\cap T^{-}) = TN = 180$。\n- 假阴性（$FN$）：患病但测试结果为阴性的受试者数量。$N(D^{+} \\cap T^{-}) = FN = 20$。\n\n根据这些计数，我们可以计算出边际总数：\n- 患病受试者总数为 $N(D^{+}) = TP + FN = 80 + 20 = 100$。\n- 未患病受试者总数为 $N(D^{-}) = FP + TN = 20 + 180 = 200$。\n- 研究中受试者总数为 $N_{total} = TP + FP + TN + FN = 80 + 20 + 180 + 20 = 300$。\n\n现在，我们从这些基本原理出发计算所需的量。\n\n1.  **灵敏度 ($Se$)**:\n    灵敏度是受试者患病条件下测试结果为阳性的概率。它是真阳性率。\n    $$Se = P(T^{+} | D^{+}) = \\frac{N(T^{+} \\cap D^{+})}{N(D^{+})} = \\frac{TP}{TP + FN}$$\n    代入给定值：\n    $$Se = \\frac{80}{80 + 20} = \\frac{80}{100} = 0.8$$\n    四舍五入到三位有效数字，$Se = 0.800$。\n\n2.  **特异度 ($Sp$)**:\n    特异度是受试者未患病条件下测试结果为阴性的概率。它是真阴性率。\n    $$Sp = P(T^{-} | D^{-}) = \\frac{N(T^{-} \\cap D^{-})}{N(D^{-})} = \\frac{TN}{FP + TN}$$\n    代入给定值：\n    $$Sp = \\frac{180}{20 + 180} = \\frac{180}{200} = 0.9$$\n    四舍五入到三位有效数字，$Sp = 0.900$。\n\n3.  **准确度**:\n    准确度是在所有进行的测试中，得出正确结果（真阳性和真阴性）的测试所占的比例。\n    $$Accuracy = \\frac{N(TP) + N(TN)}{N_{total}} = \\frac{TP + TN}{TP + FP + TN + FN}$$\n    代入给定值：\n    $$Accuracy = \\frac{80 + 180}{80 + 20 + 180 + 20} = \\frac{260}{300} = \\frac{13}{15} \\approx 0.8666...$$\n    四舍五入到三位有效数字，准确度 = 0.867。\n\n4.  **阳性似然比 ($LR^{+}$)**:\n    阳性似然比是患病个体测试结果为阳性的概率与未患病个体测试结果为阳性的概率之比。它是真阳性率（$Se$）与假阳性率（$FPR$）之比。\n    $$LR^{+} = \\frac{P(T^{+} | D^{+})}{P(T^{+} | D^{-})}$$\n    分子是灵敏度，$P(T^{+} | D^{+}) = Se$。\n    分母是假阳性率，即 $1 - Sp$，因为 $P(T^{+} | D^{-}) + P(T^{-} | D^{-}) = 1$ 且 $P(T^{-} | D^{-}) = Sp$。\n    因此，$P(T^{+} | D^{-}) = 1 - Sp = 1 - 0.900 = 0.100$。\n    公式为：\n    $$LR^{+} = \\frac{Se}{1 - Sp}$$\n    代入计算出的值：\n    $$LR^{+} = \\frac{0.800}{1 - 0.900} = \\frac{0.800}{0.100} = 8$$\n    四舍五入到三位有效数字，$LR^{+} = 8.00$。\n\n5.  **阴性似然比 ($LR^{-}$)**:\n    阴性似然比是患病个体测试结果为阴性的概率与未患病个体测试结果为阴性的概率之比。它是假阴性率（$FNR$）与真阴性率（$Sp$）之比。\n    $$LR^{-} = \\frac{P(T^{-} | D^{+})}{P(T^{-} | D^{-})}$$\n    分子是假阴性率，即 $1 - Se$，因为 $P(T^{-} | D^{+}) + P(T^{+} | D^{+}) = 1$ 且 $P(T^{+} | D^{+}) = Se$。\n    因此，$P(T^{-} | D^{+}) = 1 - Se = 1 - 0.800 = 0.200$。\n    分母是特异度，$P(T^{-} | D^{-}) = Sp$。\n    公式为：\n    $$LR^{-} = \\frac{1 - Se}{Sp}$$\n    代入计算出的值：\n    $$LR^{-} = \\frac{1 - 0.800}{0.900} = \\frac{0.200}{0.900} = \\frac{2}{9} \\approx 0.2222...$$\n    四舍五入到三位有效数字，$LR^{-} = 0.222$。\n\n**临床决策中似然比的解释：**\n似然比用于使用贝叶斯关系将疾病的测试前概率更新为测试后概率：测试后优势 = 测试前优势 $\\times$ 似然比。\n阳性似然比的大小，$LR^{+} = 8.00$，表明阳性测试结果在患病者中出现的可能性是在未患病者中的$8$倍。在病理学中，一个中等偏高的 $LR^{+}$（通常 $LR^{+}  5$）为增加疾病概率提供了充分的证据，从而加强了诊断结论，并可能降低开始治疗或进一步检查的决策阈值。\n阴性似然比的大小，$LR^{-} = 0.222$，表明阴性测试结果显著降低了估计的疾病概率。一个介于 $0.1$ 和 $0.2$ 之间的 $LR^{-}$ 值被认为对于排除某种疾病具有中等程度的效用。对于这项测试，阴性结果使得修正后的疾病优势约为原始优势的五分之一（$0.222$），这为病理学家提供了相当大的信心来排除该疾病，并建议不要进行进一步的、可能有潜在危害或成本高昂的干预。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.800  0.900  0.867  8.00  0.222\n\\end{pmatrix}\n}\n$$", "id": "4352884"}, {"introduction": "一项测试的临床效用不仅取决于其固有的准确性，还取决于疾病在目标人群中的患病率。在这个问题中，您将运用贝叶斯定理（Bayes' theorem）来计算阳性预测值（$PPV$）和阴性预测值（$NPV$）。本练习旨在强调测试的性能特征（如灵敏度和特异性）与其在真实临床环境中的预测能力之间的关键区别[@problem_id:4352900]。", "problem": "自 Rudolf Virchow 阐明细胞病理学时代以来，病理学的一个核心目标就是将组织和实验室检测中观察到的现象与潜在的疾病状态联系起来。在现代诊断病理学中，实验室检测的性能由其灵敏度和特异度来表征，这两个指标均植根于概率论：灵敏度反映了在患有疾病的情况下检测结果为阳性的条件概率，而特异度则反映了在未患疾病的情况下检测结果为阴性的条件概率。人群中的疾病负担由疾病患病率反映。这些指标共同决定了在一个真实的临床人群中，检测结果正确指示疾病状态的概率，这与病理学将测量结果转化为对患者护理有意义的信息这一范畴相符。\n\n考虑一个用于诊断病理学的单一二元实验室检测。该检测的灵敏度为 $0.90$，特异度为 $0.95$，并应用于疾病患病率为 $0.10$ 的人群。计算由这些参数所隐含的阳性预测值 ($PPV$) 和阴性预测值 ($NPV$)。将每个结果表示为最简分数。不要四舍五入。", "solution": "该问题是有效的，因为它在科学上基于应用于医学诊断的概率论原理，是良定的、客观的，并包含了得出唯一解所需的所有信息。\n\n让我们定义以下事件：\n- $D$：某人患有该疾病的事件。\n- $D^c$：某人未患该疾病的事件。\n- $T^+$：检测结果为阳性的事件。\n- $T^-$：检测结果为阴性的事件。\n\n问题提供了以下参数：\n1.  **患病率**：人群中患有该疾病的概率。\n    $P(D) = 0.10 = \\frac{1}{10}$\n2.  **灵敏度**：在患有疾病的情况下检测结果为阳性的条件概率。\n    $P(T^+ | D) = 0.90 = \\frac{9}{10}$\n3.  **特异度**：在未患疾病的情况下检测结果为阴性的条件概率。\n    $P(T^- | D^c) = 0.95 = \\frac{95}{100} = \\frac{19}{20}$\n\n从这些给定值，我们可以推导出其他基本概率：\n- 未患疾病的概率是患病率的补集：\n  $P(D^c) = 1 - P(D) = 1 - 0.10 = 0.90 = \\frac{9}{10}$\n- 假阴性（尽管患有疾病但检测结果为阴性）的概率是灵敏度的补集：\n  $P(T^- | D) = 1 - P(T^+ | D) = 1 - 0.90 = 0.10 = \\frac{1}{10}$\n- 假阳性（尽管未患疾病但检测结果为阳性）的概率是特异度的补集：\n  $P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - 0.95 = 0.05 = \\frac{5}{100} = \\frac{1}{20}$\n\n我们的目标是计算阳性预测值 ($PPV$) 和阴性预测值 ($NPV$)。\n\n**1. 计算阳性预测值 ($PPV$)**\n\n$PPV$ 是在检测结果为阳性的条件下某人患有该疾病的条件概率，记为 $P(D | T^+)$。我们使用贝叶斯定理进行计算：\n$$ PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)} $$\n为了求得 $P(T^+)$，即检测结果为阳性的总概率，我们使用全概率公式：\n$$ P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c) $$\n代入已知值：\n$$ P(T^+) = \\left(\\frac{9}{10}\\right) \\left(\\frac{1}{10}\\right) + \\left(\\frac{1}{20}\\right) \\left(\\frac{9}{10}\\right) $$\n$$ P(T^+) = \\frac{9}{100} + \\frac{9}{200} $$\n为了將這些分数相加，我们找到一个公分母，即 $200$：\n$$ P(T^+) = \\frac{18}{200} + \\frac{9}{200} = \\frac{27}{200} $$\n现在我们可以计算 $PPV$：\n$$ PPV = \\frac{P(T^+ | D) P(D)}{P(T^+)} = \\frac{\\frac{9}{100}}{\\frac{27}{200}} $$\n$$ PPV = \\frac{9}{100} \\times \\frac{200}{27} = \\frac{9 \\times 2}{27} = \\frac{18}{27} $$\n通过将分子和分母同除以它们的最大公约数 $9$ 来化简分数：\n$$ PPV = \\frac{2}{3} $$\n\n**2. 计算阴性预测值 ($NPV$)**\n\n$NPV$ 是在检测结果为阴性的条件下某人未患该疾病的条件概率，记为 $P(D^c | T^-)$。我们再次使用贝叶斯定理：\n$$ NPV = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)} $$\n为了求得 $P(T^-)$，即检测结果为阴性的总概率，我们使用全概率公式：\n$$ P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D) $$\n代入已知值：\n$$ P(T^-) = \\left(\\frac{19}{20}\\right) \\left(\\frac{9}{10}\\right) + \\left(\\frac{1}{10}\\right) \\left(\\frac{1}{10}\\right) $$\n$$ P(T^-) = \\frac{171}{200} + \\frac{1}{100} $$\n为了将这些分数相加，我们使用公分母 $200$：\n$$ P(T^-) = \\frac{171}{200} + \\frac{2}{200} = \\frac{173}{200} $$\n现在我们可以计算 $NPV$：\n$$ NPV = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)} = \\frac{\\frac{171}{200}}{\\frac{173}{200}} $$\n$$ NPV = \\frac{171}{173} $$\n数字 $173$ 是一个质数，所以这个分数已经是其最简形式。\n\n结果是 $PPV = \\frac{2}{3}$ 和 $NPV = \\frac{171}{173}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{2}{3}  \\frac{171}{173} \\end{pmatrix} } $$", "id": "4352900"}]}