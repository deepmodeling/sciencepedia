{"hands_on_practices": [{"introduction": "为了确保免疫系统能够识别“异己”同时不攻击“自身”，T细胞在胸腺中必须经过一个严格的筛选过程。这个练习将免疫学中的核心概念——中枢耐受的形成——转化为一个概率问题。通过计算胸腺细胞在阳性选择和阴性选择这两个连续过滤器中的存活率，我们可以直观地理解为什么只有一小部分细胞能够最终成熟，从而形成一个既有效又安全的T细胞库。[@problem_id:4372189]", "problem": "一个在胸腺中发育的胸腺细胞会经过两个连续的选择筛选过程，以确保其具有主要组织相容性复合体（MHC）限制性和自身耐受性。在第一个称为阳性选择的筛选过程中，T细胞受体（TCR; T Cell Receptor）能以适当亲和力结合自身主要组织相容性复合体（MHC; Major Histocompatibility Complex）的胸腺细胞被保留下来；未能结合的胸腺细胞则因“忽视”而死亡。在第二个称为阴性选择的筛选过程中，与自身肽-MHC结合过强的胸腺细胞被清除，以建立中枢耐受。\n\n假设有一大群胸腺细胞，因此其个体结局可以进行概率处理。设一个随机选择的胸腺细胞被阳性选择的概率为 $p_{+}$，一个被阳性选择的胸腺细胞被阴性选择清除的概率为 $p_{-}$。那么，在已被阳性选择的条件下，通过阴性选择存活的概率是 $1 - p_{-}$。假设选择事件如上所述按顺序发生，并且没有其他改变命运的过程发生。\n\n已知 $p_{+} = 0.05$ 和 $p_{-} = 0.60$，请根据序贯筛选的基本概率法则，推导出胸腺细胞作为成熟T细胞离开胸腺的总存活概率表达式。然后计算初始胸腺细胞群体中作为成熟T细胞离开的相应比例。将最终答案表示为不带单位的单个十进制数，并且除了给定值所隐含的四舍五入外，不要进行任何额外的四舍五入。", "solution": "这个问题是将条件概率应用于一个简化但概念上准确的胸腺T细胞发育模型。所描述的过程——序贯的阳性选择和阴性选择——是免疫学中的一个基本概念。给定的概率 $p_{+}$ 和 $p_{-}$ 定义明确，任务是计算一个结果概率，这使得问题自成体系、有科学依据且表述清晰。所有需要的数据都已提供，且没有矛盾之处。因此，该问题是有效的，可以构建解决方案。\n\n让我们为一个随机选择的胸腺细胞定义以下事件：\n- 设 $S_{+}$ 为胸腺细胞通过阳性选择的事件。\n- 设 $S_{N}$ 为胸腺细胞通过阴性选择的事件。\n\n问题要求的是总存活概率，即一个胸腺细胞既通过阳性选择又通过随后的阴性选择的概率。这对应于事件 $S_{+}$ 和 $S_{N}$ 同时发生的联合概率，记为 $P(S_{+} \\cap S_{N})$。\n\n根据问题陈述，一个胸腺细胞被阳性选择的概率为 $p_{+}$。因此，我们可以写出：\n$$P(S_{+}) = p_{+}$$\n\n接下来，问题指出 $p_{-}$ 是一个*被阳性选择*的胸腺细胞被阴性选择*清除*的概率。这是一个条件概率。设 $E_{N}$ 为被阴性选择清除的事件。那么，在胸腺细胞已通过阳性选择的条件下，被阴性选择清除的概率是：\n$$P(E_{N} | S_{+}) = p_{-}$$\n\n通过阴性选择存活的事件 $S_{N}$ 是被阴性选择清除的事件 $E_{N}$ 的补集。因此，在已通过阳性选择的条件下，通过阴性选择存活的概率是：\n$$P(S_{N} | S_{+}) = 1 - P(E_{N} | S_{+})$$\n代入给定的变量，我们得到：\n$$P(S_{N} | S_{+}) = 1 - p_{-}$$\n\n选择事件是按顺序发生的。一个胸腺细胞必须首先通过阳性选择，然后通过阴性选择。总存活概率 $P_{survival}$ 是这两个事件交集 $P(S_{+} \\cap S_{N})$ 的概率。利用条件概率的定义，我们可以将这个联合概率表示为：\n$$P_{survival} = P(S_{+} \\cap S_{N}) = P(S_{N} | S_{+}) \\times P(S_{+})$$\n\n代入右侧各项概率的表达式，我们推导出总存活概率的一般表达式：\n$$P_{survival} = p_{+} \\times (1 - p_{-})$$\n\n现在，我们可以使用给定的数据计算数值：$p_{+} = 0.05$ 和 $p_{-} = 0.60$。\n$$P_{survival} = 0.05 \\times (1 - 0.60)$$\n$$P_{survival} = 0.05 \\times 0.40$$\n$$P_{survival} = 0.02$$\n\n这个计算出的概率 $0.02$ 代表了初始胸腺细胞群体中成功完成两个选择过程并作为成熟T细胞离开胸腺的比例。", "answer": "$$\\boxed{0.02}$$", "id": "4372189"}, {"introduction": "免疫细胞的效应功能，例如巨噬细胞的吞噬作用，是清除病原体的关键。这个过程的效率不是恒定的，而是受到适应性免疫应答产生的调理素（如抗体）浓度的影响。本练习利用经典的米氏方程（Michaelis-Menten equation）来量化这种关系，揭示调理作用如何增强吞噬速率。通过这个假设的计算，我们可以探索先天免疫和适应性免疫之间的协同作用，并理解受体介导过程所固有的饱和现象。[@problem_id:4372143]", "problem": "一个巨噬细胞与被源自先天性和适应性免疫反应的调理素标记的病原体结合。诸如补体成分3b (C3b) 和免疫球蛋白G (IgG) 之类的调理素通过促进受体介导的结合来增强吞噬作用。从第一性原理出发，受体介导的摄取是可饱和的，因为表面受体的数量是有限的，且配体结合是可逆的；在准稳态近似下，这种可饱和过程可以很好地由米氏-孟顿型关系描述，其中摄取速率 $v$ 随着调理素密度 $C$ 的增加而增加，但随着受体被占据而趋于一个最大值。\n\n假设吞噬速率遵循可饱和摄取模型\n$$v = \\frac{V_{\\max} C}{K_{m} + C},$$\n其中 $V_{\\max}$ 是最大摄取速率，$K_{m}$ 是速率达到最大值一半时的调理素密度。考虑一个情景，其中由于适应性免疫反应，调理素密度加倍，从 $C=25$ 任意单位变为 $C=50$ 任意单位。设 $V_{\\max} = 100$ 且 $K_{m} = 50$（单位与 $C$ 相同，为任意单位）。\n\n从上述可饱和摄取框架出发，推导当 $C$ 从 $25$ 加倍到 $50$ 时，吞噬速率的绝对变化量 $\\Delta v$ 的表达式，并使用所提供的参数计算其值。将您的最终答案表示为一个无单位的精确分数。", "solution": "首先将对问题陈述的科学性和逻辑完整性进行验证。\n\n**步骤1：提取已知条件**\n-   吞噬速率模型：$v = \\frac{V_{\\max} C}{K_{m} + C}$\n-   $v$：吞噬速率\n-   $V_{\\max}$：最大摄取速率\n-   $K_{m}$：速率达到最大值一半时的调理素密度\n-   $C$：调理素密度\n-   初始调理素密度：$C_1 = 25$（任意单位）\n-   最终调理素密度：$C_2 = 50$（任意单位）\n-   $V_{\\max}$ 的值：$V_{\\max} = 100$（任意单位）\n-   $K_{m}$ 的值：$K_{m} = 50$（与 $C$ 的单位相同，为任意单位）\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于基础免疫学和细胞生物学。像C3b（先天性）和IgG（适应性）这样的调理素在增强吞噬作用中的作用是一个核心概念。使用可饱和的米氏-孟顿型动力学方程来模拟这一过程是系统生物学中描述受体介导现象（其特征是受体数量有限）的一种标准且被广泛接受的方法。其前提在事实上和科学上都是合理的。\n-   **适定性**：该问题是适定的。它提供了一个清晰的数学模型、所有必需的参数（$V_{\\max}$，$K_{m}$），以及自变量（$C$）的特定初始和最终条件。目标是计算一个单一、明确定义的量，即速率的绝对变化量 $\\Delta v$。存在唯一且稳定的解。\n-   **客观性**：问题以精确、客观的语言陈述，没有主观或含糊的术语。\n-   **完整性与一致性**：问题是自洽的，提供了求解所需的所有信息。给定数据中没有矛盾。单位被描述为“任意”，但在整个问题中是一致的。\n-   **现实性**：对生物速率过程使用动力学模型是一种标准的简化，在数学生物学的框架内是科学上可信的。\n\n**步骤3：结论与行动**\n该问题是有效的。它在科学上合理、适定、客观且完整。我现在将继续进行求解。\n\n吞噬速率 $v$ 是调理素密度 $C$ 的函数，由可饱和摄取模型描述：\n$$v(C) = \\frac{V_{\\max} C}{K_{m} + C}$$\n我们被要求计算当调理素密度 $C$ 从初始值 $C_1$ 变为最终值 $C_2$ 时，吞噬速率的绝对变化量 $\\Delta v$。绝对变化量定义为：\n$$\\Delta v = v(C_2) - v(C_1)$$\n给定的值为：\n-   初始密度，$C_1 = 25$\n-   最终密度，$C_2 = 50$\n-   最大速率，$V_{\\max} = 100$\n-   半最大速率密度常数，$K_{m} = 50$\n\n首先，我们推导 $\\Delta v$ 的通用符号表达式。\n$$ \\Delta v = \\frac{V_{\\max} C_2}{K_{m} + C_2} - \\frac{V_{\\max} C_1}{K_{m} + C_1} $$\n我们可以提出公因子 $V_{\\max}$：\n$$ \\Delta v = V_{\\max} \\left( \\frac{C_2}{K_{m} + C_2} - \\frac{C_1}{K_{m} + C_1} \\right) $$\n为了合并分数，我们找到一个公分母：\n$$ \\Delta v = V_{\\max} \\left( \\frac{C_2(K_{m} + C_1) - C_1(K_{m} + C_2)}{(K_{m} + C_1)(K_{m} + C_2)} \\right) $$\n展开分子中的各项：\n$$ \\Delta v = V_{\\max} \\left( \\frac{C_2 K_{m} + C_1 C_2 - C_1 K_{m} - C_1 C_2}{(K_{m} + C_1)(K_{m} + C_2)} \\right) $$\n项 $C_1 C_2$ 被消掉：\n$$ \\Delta v = V_{\\max} \\left( \\frac{C_2 K_{m} - C_1 K_{m}}{(K_{m} + C_1)(K_{m} + C_2)} \\right) $$\n从分子中提出公因子 $K_{m}$，得到速率变化的最终推导表达式：\n$$ \\Delta v = \\frac{V_{\\max} K_{m} (C_2 - C_1)}{(K_{m} + C_1)(K_{m} + C_2)} $$\n现在，我们可以通过将给定的数值代入此表达式来计算 $\\Delta v$ 的值。或者，也许更直接地，我们可以分别计算 $v(C_1)$ 和 $v(C_2)$，然后求它们的差。\n\n我们来计算初始速率 $v_1 = v(C_1)$，其中 $C_1 = 25$：\n$$ v_1 = v(25) = \\frac{V_{\\max} \\cdot 25}{K_{m} + 25} = \\frac{100 \\cdot 25}{50 + 25} = \\frac{2500}{75} $$\n为了简化分数，我们可以将分子和分母除以它们的最大公约数 $25$：\n$$ v_1 = \\frac{2500 \\div 25}{75 \\div 25} = \\frac{100}{3} $$\n接下来，我们计算最终速率 $v_2 = v(C_2)$，其中 $C_2 = 50$。请注意，$C_2 = K_m$。根据 $K_m$ 的定义，此浓度下的速率应为最大速率的一半，即 $V_{\\max}/2$。我们来验证一下。\n$$ v_2 = v(50) = \\frac{V_{\\max} \\cdot 50}{K_{m} + 50} = \\frac{100 \\cdot 50}{50 + 50} = \\frac{5000}{100} = 50 $$\n这证实了 $v_2 = \\frac{V_{\\max}}{2} = \\frac{100}{2} = 50$。\n\n最后，我们计算绝对变化量 $\\Delta v$：\n$$ \\Delta v = v_2 - v_1 = 50 - \\frac{100}{3} $$\n为了进行减法，我们将 $50$ 表示为分母为 $3$ 的分数：\n$$ \\Delta v = \\frac{50 \\cdot 3}{3} - \\frac{100}{3} = \\frac{150}{3} - \\frac{100}{3} = \\frac{150 - 100}{3} = \\frac{50}{3} $$\n吞噬速率的绝对变化量是 $\\frac{50}{3}$。题目要求答案为一个精确分数，这符合要求。", "answer": "$$\\boxed{\\frac{50}{3}}$$", "id": "4372143"}, {"introduction": "真实的免疫应答是一个动态系统，病原体与免疫细胞群体的数量随时间相互影响，不断变化。这个综合性练习将引导我们使用常微分方程（Ordinary Differential Equations, ODEs）来构建一个宿主-病原体相互作用的简化数学模型。通过从基本原理出发推导方程、分析系统的稳态并评估其稳定性，我们能够模拟感染过程，并探索病原体被清除或持续存在的条件。这项实践虽然更具挑战性，但它为我们打开了系统免疫学和计算建模的大门，这些是理解和预测免疫应答行为的前沿工具。[@problem_id:4372188]", "problem": "要求您形式化、分析和计算一个基于标准病理学推理和质量作用动力学的最小宿主体内免疫反应模型的特性。目标是从第一性原理出发，推导出一个常微分方程（ODE）系统，而不使用任何预先设定的快捷公式，然后确定其稳态及其局部稳定性，最后实现一个程序，用提供的参数集测试套件来评估这些特性。\n\n出发点与科学基础：\n- 在没有免疫反应的情况下，病原体载量以人均复制率 $r$ 增加，这与微生物种群的指数增长模型一致。\n- 由于模式识别受体的激活和细胞因子信号传导，先天性免疫效应物水平与病原体载量成比例增加，速率参数为 $\\alpha$；并由于自然更新和消退机制，以速率 $\\delta_I$ 衰减。\n- 适应性免疫效应物水平与先天性效应物水平成比例增加（因为先天性信号会启动适应性反应），速率参数为 $\\beta$；并在刺激后由于收缩而以速率 $\\delta_A$ 衰减。\n- 先天性和适应性效应物对病原体的清除遵循质量作用动力学，其中清除项与病原体载量和效应物水平的乘积成正比，清除系数分别为 $k_I$ 和 $k_A$。\n\n任务：\n1. 基于上述科学基础，使用质量作用推理和线性产生-衰减假设，为病原体载量 $P(t)$、先天性效应物 $I(t)$ 和适应性效应物 $A(t)$ 推导出一个常微分方程（ODE）系统。不要假设或使用任何预给定的公式；从上述定义中推导出所有项。\n2. 通过将时间导数设为零来定义稳态。求解所有稳态 $(P^\\star, I^\\star, A^\\star)$ 并确定存在 $P^\\star > 0$ 的非平凡稳态的条件。当这种稳态存在时，用参数 $r$, $k_I$, $k_A$, $\\alpha$, $\\delta_I$, $\\beta$, $\\delta_A$ 给出 $(P^\\star, I^\\star, A^\\star)$ 的表达式。\n3. 构建所推导系统的雅可比矩阵，并通过分析特征值来确定每个稳态的局部稳定性。使用的判据是：一个稳态是局部渐近稳定的，当且仅当在该稳态处计算的雅可比矩阵的所有特征值都具有严格为负的实部。\n4. 实现一个程序，对于每个参数集，执行以下操作：\n   - 如果 $P^\\star > 0$，则计算非平凡稳态 $(P^\\star, I^\\star, A^\\star)$；否则，对于非平凡稳态返回 $(0,0,0)$。\n   - 在无病稳态 $(0,0,0)$ 和非平凡稳态（仅当 $P^\\star > 0$ 时）处评估雅可比矩阵，计算特征值，并确定每个稳态的局部渐近稳定性（以布尔值表示）。\n   - 将 $(P^\\star, I^\\star, A^\\star)$ 的每个分量四舍五入到 $6$ 位小数。\n   - 对于每个测试用例，输出一个形式为 $[P^\\star, I^\\star, A^\\star, \\text{stable\\_df}, \\text{stable\\_endemic}]$ 的列表，其中 $\\text{stable\\_df}$ 和 $\\text{stable\\_endemic}$ 是分别指示无病稳态和地方性稳态局部渐近稳定性的布尔值。如果不存在 $P^\\star > 0$ 的地方性稳态，则输出 $(0,0,0)$ 并将 $\\text{stable\\_endemic}$ 设为 False。\n\n测试套件：\n使用以下五个参数集，每个参数集由 $(r, k_I, k_A, \\alpha, \\delta_I, \\beta, \\delta_A)$ 给出：\n- 情况 $1$ (一般正常路径): $(r=\\;1.2,\\; k_I=\\;0.3,\\; k_A=\\;0.4,\\; \\alpha=\\;0.5,\\; \\delta_I=\\;0.6,\\; \\beta=\\;0.7,\\; \\delta_A=\\;0.8)$。\n- 情况 $2$ (边界复制): $(r=\\;0.0,\\; k_I=\\;0.4,\\; k_A=\\;0.5,\\; \\alpha=\\;0.7,\\; \\delta_I=\\;0.3,\\; \\beta=\\;0.6,\\; \\delta_A=\\;0.4)$。\n- 情况 $3$ (无先天性清除): $(r=\\;0.9,\\; k_I=\\;0.0,\\; k_A=\\;0.8,\\; \\alpha=\\;0.5,\\; \\delta_I=\\;0.5,\\; \\beta=\\;1.0,\\; \\delta_A=\\;0.4)$。\n- 情况 $4$ (强适应性诱导，可能不稳定): $(r=\\;5.0,\\; k_I=\\;0.1,\\; k_A=\\;2.0,\\; \\alpha=\\;0.3,\\; \\delta_I=\\;0.2,\\; \\beta=\\;2.0,\\; \\delta_A=\\;0.5)$。\n- 情况 $5$ (高衰减率): $(r=\\;1.0,\\; k_I=\\;0.5,\\; k_A=\\;0.5,\\; \\alpha=\\;0.6,\\; \\delta_I=\\;1.2,\\; \\beta=\\;0.8,\\; \\delta_A=\\;1.4)$。\n\n输出规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应于上面列出的一个测试用例，并且每个测试用例的结果都是 $[P^\\star,I^\\star,A^\\star,\\text{stable\\_df},\\text{stable\\_endemic}]$ 的精确格式。示例格式（非实际值）：$[[p_1,i_1,a_1,\\text{True},\\text{False}],\\,[p_2,i_2,a_2,\\text{False},\\text{False}],\\,\\dots]$。", "solution": "用户提供了一个要求对宿主体内免疫模型进行形式化和分析的问题。其验证和后续解决方案均以 STEM 教授所期望的严谨性进行。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n\n问题陈述提供了以下信息和任务：\n\n**模型原理：**\n- 变量：病原体载量 $P(t)$、先天性效应物 $I(t)$ 和适应性效应物 $A(t)$。\n- 病原体生长：人均复制率 $r$。\n- 先天性免疫反应：\n    - 产生：与病原体载量 $P(t)$ 成正比，速率参数为 $\\alpha$。\n    - 衰减：速率为 $\\delta_I$。\n- 适应性免疫反应：\n    - 产生：与先天性效应物水平 $I(t)$ 成正比，速率参数为 $\\beta$。\n    - 衰减：速率为 $\\delta_A$。\n- 病原体清除：\n    - 通过先天性效应物：质量作用动力学，系数为 $k_I$。项与 $P \\times I$ 成正比。\n    - 通过适应性效应物：质量作用动力学，系数为 $k_A$。项与 $P \\times A$ 成正比。\n\n**任务：**\n1. 根据给定原理推导 $P(t)$、$I(t)$ 和 $A(t)$ 的常微分方程（ODE）系统。\n2. 确定所有稳态 $(P^\\star, I^\\star, A^\\star)$ 以及存在非平凡稳态（$P^\\star > 0$）的条件。提供该稳态的表达式。\n3. 构建雅可比矩阵，并通过分析特征值确定每个稳态的局部渐近稳定性。如果所有特征值的实部都严格为负，则稳态是稳定的。\n4. 实现一个 Python 程序，为给定的测试套件计算非平凡稳态，确定无病稳态和非平凡稳态的稳定性，并以指定格式输出结果。\n\n**测试套件参数 ($r, k_I, k_A, \\alpha, \\delta_I, \\beta, \\delta_A$):**\n- 情况 $1$: $(1.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8)$\n- 情况 $2$: $(0.0, 0.4, 0.5, 0.7, 0.3, 0.6, 0.4)$\n- 情况 $3$: $(0.9, 0.0, 0.8, 0.5, 0.5, 1.0, 0.4)$\n- 情况 $4$: $(5.0, 0.1, 2.0, 0.3, 0.2, 2.0, 0.5)$\n- 情况 $5$: $(1.0, 0.5, 0.5, 0.6, 1.2, 0.8, 1.4)$\n\n**步骤 2：使用提取的给定信息进行验证**\n\n根据验证标准评估问题。\n- **科学依据：** 该问题使用质量作用动力学和线性产生/衰减项来模拟种群动态。这是数学-生物学和免疫学中构建简化概念模型的标准、广为接受的方法。该模型是研究病原体与免疫系统之间类似捕食者-猎物相互作用的公认范式。作为一个建模练习，它在科学上是合理的。\n- **适定性：** 问题结构清晰。它要求推导模型、分析其稳态并进行稳定性分析，这些都是动力系统研究中的标准程序。提供的参数集是完整的，可以为每种情况提供唯一解。\n- **客观性：** 问题使用精确的数学和科学语言陈述，没有歧义或主观声明。\n\n该问题没有表现出任何列出的无效性缺陷。它是一个在应用数学和理论病理学中可形式化、非平凡且可验证的问题。\n\n**步骤 3：结论与行动**\n\n问题是**有效的**。将提供完整解决方案。\n\n### 解决方案\n\n**1. 常微分方程系统的推导**\n\n我们通过考虑每个种群的变化率来推导病原体载量 $P(t)$、先天性效应物水平 $I(t)$ 和适应性效应物水平 $A(t)$ 的常微分方程系统。如指定的那样，变化率是产生/增长项和移除/衰减项的总和。\n\n对于病原体载量 $P(t)$：\n- **增长：** 病原体以人均速率 $r$ 复制。这贡献了一个项 $+rP$。\n- **先天性清除：** 病原体通过质量作用动力学被先天性效应物清除。相互作用的速率与其浓度乘积 $P \\times I$ 成正比，速率常数为 $k_I$。这贡献了一个项 $-k_I P I$。\n- **适应性清除：** 类似地，病原体被适应性效应物清除，速率常数为 $k_A$。这贡献了一个项 $-k_A P A$。\n结合这些项，$P(t)$ 的常微分方程是：\n$$ \\frac{dP}{dt} = rP - k_I P I - k_A P A = P(r - k_I I - k_A A) $$\n\n对于先天性效应物水平 $I(t)$：\n- **产生：** 先天性效应物为响应病原体载量而产生，其速率与 $P$ 成正比，参数为 $\\alpha$。这贡献了一个项 $+\\alpha P$。\n- **衰减：** 先天性效应物以速率 $\\delta_I$ 自然衰减。这贡献了一个项 $-\\delta_I I$。\n$I(t)$ 的常微分方程是：\n$$ \\frac{dI}{dt} = \\alpha P - \\delta_I I $$\n\n对于适应性效应物水平 $A(t)$：\n- **产生：** 适应性效应物被激活并与先天性效应物水平成比例地扩增，速率参数为 $\\beta$。这贡献了一个项 $+\\beta I$。\n- **衰减：** 适应性效应物以速率 $\\delta_A$ 收缩或衰减。这贡献了一个项 $-\\delta_A A$。\n$A(t)$ 的常微分方程是：\n$$ \\frac{dA}{dt} = \\beta I - \\delta_A A $$\n\n完整的常微分方程系统是：\n$$\n\\begin{cases}\n\\frac{dP}{dt} = P(r - k_I I - k_A A) \\\\\n\\frac{dI}{dt} = \\alpha P - \\delta_I I \\\\\n\\frac{dA}{dt} = \\beta I - \\delta_A A\n\\end{cases}\n$$\n\n**2. 稳态分析**\n\n稳态 $(P^\\star, I^\\star, A^\\star)$ 是通过将所有时间导数设为零来找到的：\n$$ P^\\star(r - k_I I^\\star - k_A A^\\star) = 0 $$\n$$ \\alpha P^\\star - \\delta_I I^\\star = 0 $$\n$$ \\beta I^\\star - \\delta_A A^\\star = 0 $$\n从这些方程中，我们可以确定两种可能类型的稳态。\n\n**无病平衡点 (DFE)：**\n假设 $P^\\star = 0$。\n第二个方程变为 $0 - \\delta_I I^\\star = 0$，这意味着 $I^\\star = 0$。\n第三个方程变为 $\\beta(0) - \\delta_A A^\\star = 0$，这意味着 $A^\\star = 0$。\n因此，DFE 是 $(P^\\star, I^\\star, A^\\star) = (0, 0, 0)$。这个稳态总是存在的。\n\n**非平凡（地方性）平衡点：**\n假设 $P^\\star > 0$。第一个方程要求 $r - k_I I^\\star - k_A A^\\star = 0$。\n从第二个方程，我们求解 $I^\\star$ 关于 $P^\\star$ 的表达式：\n$$ I^\\star = \\frac{\\alpha}{\\delta_I} P^\\star $$\n从第三个方程，我们求解 $A^\\star$ 关于 $I^\\star$ 的表达式：\n$$ A^\\star = \\frac{\\beta}{\\delta_A} I^\\star = \\frac{\\beta}{\\delta_A} \\left(\\frac{\\alpha}{\\delta_I} P^\\star\\right) = \\frac{\\alpha \\beta}{\\delta_I \\delta_A} P^\\star $$\n现在，我们将 $I^\\star$ 和 $A^\\star$ 的这些表达式代入方程 $r - k_I I^\\star - k_A A^\\star = 0$：\n$$ r - k_I \\left(\\frac{\\alpha}{\\delta_I} P^\\star\\right) - k_A \\left(\\frac{\\alpha \\beta}{\\delta_I \\delta_A} P^\\star\\right) = 0 $$\n求解 $P^\\star$：\n$$ r = P^\\star \\left( \\frac{k_I \\alpha}{\\delta_I} + \\frac{k_A \\alpha \\beta}{\\delta_I \\delta_A} \\right) = P^\\star \\frac{\\alpha}{\\delta_I \\delta_A} (k_I \\delta_A + k_A \\beta) $$\n$$ P^\\star = \\frac{r \\delta_I \\delta_A}{\\alpha(k_I \\delta_A + k_A \\beta)} $$\n为了使这个稳态是非平凡且具有生物学意义的 ($P^\\star > 0$)，我们需要 $P^\\star$ 是正的。假设所有参数 $k_I, k_A, \\alpha, \\delta_I, \\beta, \\delta_A$ 都是非负的，分母是正的（除非所有活动都停止）。如果 $r > 0$，则分子是正的。因此，当且仅当 $r > 0$ 且分母不为零时，存在一个 $P^\\star > 0$ 的非平凡地方性平衡点。\n如果此条件成立，则地方性稳态是：\n$$ P^\\star = \\frac{r \\delta_I \\delta_A}{\\alpha(k_I \\delta_A + k_A \\beta)} $$\n$$ I^\\star = \\frac{\\alpha}{\\delta_I} P^\\star = \\frac{\\alpha}{\\delta_I} \\frac{r \\delta_I \\delta_A}{\\alpha(k_I \\delta_A + k_A \\beta)} = \\frac{r \\delta_A}{k_I \\delta_A + k_A \\beta} $$\n$$ A^\\star = \\frac{\\beta}{\\delta_A} I^\\star = \\frac{\\beta}{\\delta_A} \\frac{r \\delta_A}{k_I \\delta_A + k_A \\beta} = \\frac{r \\beta}{k_I \\delta_A + k_A \\beta} $$\n\n**3. 局部稳定性分析**\n\n一个稳态的稳定性由系统在该状态下评估的雅可比矩阵的特征值决定。设系统为 $\\frac{d\\vec{x}}{dt} = \\vec{F}(\\vec{x})$，其中 $\\vec{x} = (P, I, A)$。雅可比矩阵 $J$ 是：\n$$ J = \\begin{pmatrix} \\frac{\\partial F_1}{\\partial P} & \\frac{\\partial F_1}{\\partial I} & \\frac{\\partial F_1}{\\partial A} \\\\ \\frac{\\partial F_2}{\\partial P} & \\frac{\\partial F_2}{\\partial I} & \\frac{\\partial F_2}{\\partial A} \\\\ \\frac{\\partial F_3}{\\partial P} & \\frac{\\partial F_3}{\\partial I} & \\frac{\\partial F_3}{\\partial A} \\end{pmatrix} = \\begin{pmatrix} r - k_I I - k_A A & -k_I P & -k_A P \\\\ \\alpha & -\\delta_I & 0 \\\\ 0 & \\beta & -\\delta_A \\end{pmatrix} $$\n\n**DFE $(0,0,0)$ 的稳定性：**\n我们在 $(P, I, A) = (0, 0, 0)$ 处评估雅可比矩阵：\n$$ J_{DFE} = \\begin{pmatrix} r & 0 & 0 \\\\ \\alpha & -\\delta_I & 0 \\\\ 0 & \\beta & -\\delta_A \\end{pmatrix} $$\n这是一个下三角矩阵，所以它的特征值是其对角线元素：$\\lambda_1 = r$, $\\lambda_2 = -\\delta_I$, 和 $\\lambda_3 = -\\delta_A$。\n对于局部渐近稳定性，所有特征值的实部必须严格为负。由于衰减率 $\\delta_I$ 和 $\\delta_A$ 是正的，所以 $-\\delta_I  0$ 和 $-\\delta_A  0$。因此，稳定性由 $r$ 的符号决定。DFE 是局部渐近稳定的，当且仅当 $r  0$。如果 $r \\ge 0$，它不是严格稳定的。\n\n**地方性平衡点 $(P^\\star, I^\\star, A^\\star)$ 的稳定性：**\n这个平衡点在 $r  0$ 时存在。我们在 $(P^\\star, I^\\star, A^\\star)$ 处评估雅可比矩阵。在该点， $r - k_I I^\\star - k_A A^\\star = 0$。\n$$ J_{Endemic} = \\begin{pmatrix} 0  -k_I P^\\star  -k_A P^\\star \\\\ \\alpha  -\\delta_I  0 \\\\ 0  \\beta  -\\delta_A \\end{pmatrix} $$\n特征方程是 $\\det(J_{Endemic} - \\lambda I) = 0$，其中 $I$ 是单位矩阵。\n$$ \\begin{vmatrix} -\\lambda  -k_I P^\\star  -k_A P^\\star \\\\ \\alpha  -\\delta_I - \\lambda  0 \\\\ 0  \\beta  -\\delta_A - \\lambda \\end{vmatrix} = 0 $$\n展开行列式得到特征多项式：\n$$ -\\lambda((-\\delta_I - \\lambda)(-\\delta_A - \\lambda)) - \\alpha(-k_I P^\\star(-\\delta_A - \\lambda)) = 0 $$\n为了清晰起见，让我们从我的草稿推导中重新展开。行列式展开为：\n$-\\lambda((-\\delta_I-\\lambda)(-\\delta_A-\\lambda)) - (-k_I P^\\star)(\\alpha(-\\delta_A-\\lambda)) + (-k_A P^\\star)(\\alpha \\beta) = 0$\n$\\lambda(\\lambda+\\delta_I)(\\lambda+\\delta_A) + \\alpha k_I P^\\star(\\lambda+\\delta_A) + \\alpha k_A P^\\star \\beta = 0$\n$\\lambda(\\lambda^2 + (\\delta_I+\\delta_A)\\lambda + \\delta_I\\delta_A) + \\alpha k_I P^\\star\\lambda + \\alpha k_I P^\\star\\delta_A + \\alpha k_A P^\\star \\beta = 0$\n$\\lambda^3 + (\\delta_I+\\delta_A)\\lambda^2 + (\\delta_I\\delta_A + \\alpha k_I P^\\star)\\lambda + \\alpha P^\\star (k_I \\delta_A + k_A \\beta) = 0$\n使用 $P^\\star$ 的表达式，常数项简化为 $\\alpha \\frac{r \\delta_I \\delta_A}{\\alpha(k_I \\delta_A + k_A \\beta)} (k_I \\delta_A + k_A \\beta) = r\\delta_I\\delta_A$。\n多项式是：\n$$ \\lambda^3 + (\\delta_I+\\delta_A)\\lambda^2 + (\\delta_I\\delta_A + \\alpha k_I P^\\star)\\lambda + r\\delta_I\\delta_A = 0 $$\n为了保证局部渐近稳定性，该多项式的所有根 $\\lambda$ 的实部必须严格为负。这可以使用劳斯-赫尔维茨稳定性判据（Routh-Hurwitz stability criterion）来检验。对于三次多项式 $\\lambda^3+a_2\\lambda^2+a_1\\lambda+a_0=0$，条件是 $a_2 > 0$, $a_1 > 0$, $a_0 > 0$, 和 $a_2 a_1 > a_0$。在这里，$a_2 = \\delta_I+\\delta_A$，$a_1 = \\delta_I\\delta_A + \\alpha k_I P^\\star$，以及 $a_0 = r\\delta_I\\delta_A$。由于地方性稳态在 $r0$ 时存在且所有参数都为正，因此 $a_2, a_1, a_0$ 都为正。因此，稳定性取决于条件 $(\\delta_I+\\delta_A)(\\delta_I\\delta_A + \\alpha k_I P^\\star) > r\\delta_I\\delta_A$。在实现中，我们将数值计算 $J_{Endemic}$ 的特征值，并检查所有实部是否严格为负。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes a within-host immune response model for various parameter sets.\n\n    The model is a system of ODEs for pathogen (P), innate (I), and adaptive (A)\n    components:\n    dP/dt = P * (r - k_I*I - k_A*A)\n    dI/dt = alpha*P - delta_I*I\n    dA/dt = beta*I - delta_A*A\n\n    For each parameter set, the function calculates:\n    1. The nontrivial (endemic) steady state (P*, I*, A*). If it doesn't exist\n       with P*  0, it is reported as (0,0,0).\n    2. The local asymptotic stability of the disease-free equilibrium (0,0,0).\n    3. The local asymptotic stability of the endemic equilibrium.\n    \"\"\"\n    \n    # Test cases: (r, k_I, k_A, alpha, delta_I, beta, delta_A)\n    test_cases = [\n        (1.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),  # Case 1 (general happy path)\n        (0.0, 0.4, 0.5, 0.7, 0.3, 0.6, 0.4),  # Case 2 (boundary replication)\n        (0.9, 0.0, 0.8, 0.5, 0.5, 1.0, 0.4),  # Case 3 (no innate clearance)\n        (5.0, 0.1, 2.0, 0.3, 0.2, 2.0, 0.5),  # Case 4 (strong adaptive induction, possible instability)\n        (1.0, 0.5, 0.5, 0.6, 1.2, 0.8, 1.4),  # Case 5 (high decay rates)\n    ]\n\n    results = []\n\n    for params in test_cases:\n        r, k_I, k_A, alpha, delta_I, beta, delta_A = params\n\n        # --- 1. Stability of Disease-Free Equilibrium (DFE) ---\n        # Eigenvalues are r, -delta_I, -delta_A.\n        # For stability, all must have strictly negative real parts.\n        # Since delta_I  0 and delta_A  0, stability depends on r  0.\n        stable_df = r  0\n\n        # --- 2. Nontrivial (Endemic) Steady State calculation ---\n        P_star, I_star, A_star = 0.0, 0.0, 0.0\n        \n        # Denominator for steady state expressions\n        denom_ss = alpha * (k_I * delta_A + k_A * beta)\n        \n        # A nontrivial steady state with P*  0 exists if r  0 and the\n        # denominator is positive. All parameters are non-negative, so we check\n        # if r  0 and the denominator is non-zero.\n        if r  0 and denom_ss  0:\n            P_star = (r * delta_I * delta_A) / denom_ss\n            I_star = (r * delta_A) / (k_I * delta_A + k_A * beta)\n            A_star = (r * beta) / (k_I * delta_A + k_A * beta)\n            \n        steady_state_nontrivial = [\n            np.round(P_star, 6),\n            np.round(I_star, 6),\n            np.round(A_star, 6)\n        ]\n\n        # --- 3. Stability of Endemic Equilibrium ---\n        stable_endemic = False\n        if P_star  0:\n            # Construct the Jacobian matrix at the endemic steady state\n            J_endemic = np.array([\n                [0, -k_I * P_star, -k_A * P_star],\n                [alpha, -delta_I, 0],\n                [0, beta, -delta_A]\n            ])\n            \n            # Compute eigenvalues\n            eigenvalues = np.linalg.eigvals(J_endemic)\n            \n            # Check if all eigenvalues have strictly negative real parts\n            if np.all(np.real(eigenvalues)  0):\n                stable_endemic = True\n        \n        # Assemble the result for this test case\n        case_result = steady_state_nontrivial + [stable_df, stable_endemic]\n        results.append(case_result)\n\n    # --- 4. Final Output Formatting ---\n    # The map(str, results) converts each inner list to its string representation.\n    # e.g., [2.215385, 1.846154, 1.615385, False, True] - '[2.215385, 1.846154, 1.615385, False, True]'\n    output_str = ', '.join(map(str, results))\n    print(f\"[{output_str}]\")\n\nsolve()\n\n```", "id": "4372188"}]}