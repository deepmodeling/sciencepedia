{"hands_on_practices": [{"introduction": "在非酒精性脂肪性肝病（NAFLD）的管理中，首要步骤通常是无创地评估患者发生晚期肝纤维化的风险。本练习将向您介绍NAFLD纤维化评分（NFS），这是一个广泛应用的临床工具，它将常规的实验室检测值和患者的人体测量学特征结合起来，形成一个单一的预测分数。通过为一个假设的患者计算NFS，您将亲身体验这些多变量风险模型在临床环境中的具体应用和运作方式。[@problem_id:4414239]", "problem": "非酒精性脂肪性肝病 (NAFLD) 可进展为纤维化，目前已开发出临床指标，用于通过常规测量的变量来评估纤维化风险。这些指标源于多变量回归模型，该模型根据预测因子与纤维化的关联性为其分配权重，这些预测因子包括年龄、身体质量指数 (BMI)、是否存在空腹血糖受损或2型糖尿病 (IFG/T2DM)、天冬氨酸转氨酶 (AST) 与丙氨酸转氨酶 (ALT) 的比值、血小板计数和血清白蛋白。假设一位患有 NAFLD 的成年患者，其测量数据如下：年龄 $58$ 岁，BMI $34.7$ $\\mathrm{kg}/\\mathrm{m}^{2}$，存在 IFG/T2DM，AST $72$ $\\mathrm{U}/\\mathrm{L}$，ALT $85$ $\\mathrm{U}/\\mathrm{L}$，血小板计数 $178 \\times 10^{9}/\\mathrm{L}$，以及白蛋白 $3.8$ $\\mathrm{g}/\\mathrm{dL}$。使用经过验证的 NAFLD 纤维化评分 (NFS)，其定义为加权和\n$$NFS=-1.675+0.037\\times \\mathrm{age}+0.094\\times \\mathrm{BMI}+1.13\\times \\mathrm{D}+0.99\\times \\frac{\\mathrm{AST}}{\\mathrm{ALT}}-0.013\\times \\mathrm{platelets}-0.66\\times \\mathrm{albumin},$$\n其中，如果存在 IFG/T2DM，则 $D=1$，否则 $D=0$。计算该患者的 NFS。将最终得分表示为一个无单位的数字，并将您的答案四舍五入到四位有效数字。", "solution": "问题陈述经过严格评估并被确定为有效。它具有科学依据，表述清晰，客观，并为得出唯一解提供了所有必要数据。非酒精性脂肪性肝病 (NAFLD) 纤维化评分 (NFS) 是一种经过验证且广泛使用的临床工具，所提供的公式和患者数据与既有的医学文献和临床实践相符。\n\n该问题要求根据一组特定的临床测量数据计算患者的 NFS。NFS 的计算公式如下：\n$$NFS = -1.675 + 0.037 \\times \\mathrm{age} + 0.094 \\times \\mathrm{BMI} + 1.13 \\times \\mathrm{D} + 0.99 \\times \\frac{\\mathrm{AST}}{\\mathrm{ALT}} - 0.013 \\times \\mathrm{platelets} - 0.66 \\times \\mathrm{albumin}$$\n\n该患者的给定数据如下：\n- $\\mathrm{age} = 58$ 岁\n- $\\mathrm{BMI} = 34.7$ $\\mathrm{kg}/\\mathrm{m}^2$\n- 存在空腹血糖受损或2型糖尿病 (IFG/T2DM)，对应于变量 $\\mathrm{D}=1$。\n- 天冬氨酸转氨酶, $\\mathrm{AST} = 72$ $\\mathrm{U}/\\mathrm{L}$\n- 丙氨酸转氨酶, $\\mathrm{ALT} = 85$ $\\mathrm{U}/\\mathrm{L}$\n- 血小板计数 = $178 \\times 10^9/\\mathrm{L}$。在此公式的上下文中，变量 `platelets` 代表以 $10^9/\\mathrm{L}$ 为单位的计数，因此我们使用值 $\\mathrm{platelets} = 178$。\n- 血清白蛋白 = $3.8$ $\\mathrm{g}/\\mathrm{dL}$\n\n我们将这些值代入 NFS 公式：\n$$NFS = -1.675 + 0.037 \\times (58) + 0.094 \\times (34.7) + 1.13 \\times (1) + 0.99 \\times \\frac{72}{85} - 0.013 \\times (178) - 0.66 \\times (3.8)$$\n\n为确保精度，我们在求和前分别计算每一项：\n- 年龄项为 $0.037 \\times 58 = 2.146$。\n- BMI 项为 $0.094 \\times 34.7 = 3.2618$。\n- 糖尿病项为 $1.13 \\times 1 = 1.13$。\n- AST/ALT 比值项为 $0.99 \\times \\frac{72}{85} \\approx 0.99 \\times 0.8470588... \\approx 0.8385882...$。\n- 血小板项为 $0.013 \\times 178 = 2.314$。\n- 白蛋白项为 $0.66 \\times 3.8 = 2.508$。\n\n现在，我们将这些计算出的值代回方程中：\n$$NFS \\approx -1.675 + 2.146 + 3.2618 + 1.13 + 0.8385882 - 2.314 - 2.508$$\n\n将正数项相加：\n$$2.146 + 3.2618 + 1.13 + 0.8385882 = 7.3763882$$\n\n将负数项（的绝对值）相加：\n$$1.675 + 2.314 + 2.508 = 6.497$$\n\n因此，NFS 是差值：\n$$NFS \\approx 7.3763882 - 6.497 = 0.8793882$$\n\n问题要求将最终答案四舍五入到四位有效数字。计算值为 $0.8793882...$。前四位有效数字是 $8$、$7$、$9$ 和 $3$。第五位有效数字是 $8$，大于或等于 $5$，因此我们将第四位有效数字向上取整。数字 $3$ 向上取整为 $4$。\n\n因此，最终四舍五入的 NFS 值为 $0.8794$。", "answer": "$$\\boxed{0.8794}$$", "id": "4414239"}, {"introduction": "虽然像FIB-4这样的评分系统很有价值，但它们的临床效用取决于其诊断的准确性，而这种准确性并非一成不变。本练习将引导您从简单的计算转向批判性的评估，要求您应用贝叶斯定理来确定FIB-4指数在特定疾病患病率下的阳性预测值（PPV）和阴性预测值（NPV）。这个过程将揭示一个在医学诊断中至关重要的原则：一项检测在真实世界中的表现，与其在特定筛查人群中的疾病流行程度密不可分。[@problem_id:4414206]", "problem": "一位临床医生正在评估使用纤维化四项指数（FIB-4）对非酒精性脂肪性肝病（NAFLD）患者进行分诊，以筛查进展期肝纤维化（Metavir分期 $F \\geq 3$）的效用。对于年龄小于 $65$ 岁的患者，实践中通常使用两个决策阈值：排除阈值为FIB-4  1.3，纳入阈值为FIB-4 > 2.67。假设在这些阈值下，针对目标状况（进展期肝纤维化）的二元分类特性如下：对于排除阈值，敏感性 $= 0.88$，特异性 $= 0.45$；对于纳入阈值，敏感性 $= 0.45$，特异性 $= 0.92$。在所考虑的实践人群中，NAFLD患者中进展期肝纤维化的患病率为 $0.25$。\n\n从敏感性、特异性和患病率的定义出发，应用贝叶斯定理和全概率定律，推导二元检验的阳性预测值（PPV）和阴性预测值（NPV）的表达式。然后，使用这些表达式，计算在给定患病率下，上述纳入阈值和排除阈值的PPV和NPV。\n\n按以下顺序报告这四个值：纳入阈值的PPV，纳入阈值的NPV，排除阈值的PPV，排除阈值的NPV。将每个值表示为小数（而非百分比），并将答案四舍五入至四位有效数字。", "solution": "用户希望我验证并解决一个关于FIB-4指数诊断特性的问题。\n\n**1. 问题验证**\n\n**步骤1：提取已知条件**\n-   目标状况：非酒精性脂肪性肝病（NAFLD）患者的进展期肝纤维化（Metavir分期 $F \\geq 3$）。\n-   检验：用于年龄小于 $65$ 岁的患者的纤维化四项指数（FIB-4）。\n-   排除阈值：FIB-4  1.3。如果FIB-4  1.3 则检验为‘阴性’，如果FIB-4 $\\geq 1.3$ 则为‘阳性’。\n-   排除阈值（在 $1.3$ 处）的二元分类特性：\n    -   敏感性 $= 0.88$\n    -   特异性 $= 0.45$\n-   纳入阈值：FIB-4 > 2.67。如果FIB-4 > 2.67 则检验为‘阳性’，如果FIB-4 $\\leq 2.67$ 则为‘阴性’。\n-   纳入阈值（在 $2.67$ 处）的二元分类特性：\n    -   敏感性 $= 0.45$\n    -   特异性 $= 0.92$\n-   人群中进展期肝纤维化的患病率：$0.25$。\n-   任务：\n    1.  推导阳性预测值（PPV）和阴性预测值（NPV）的表达式。\n    2.  计算纳入阈值和排除阈值的PPV和NPV。\n    3.  按顺序报告四个值：PPV(纳入), NPV(纳入), PPV(排除), NPV(排除)。\n    4.  将答案四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学性：**该问题使用了生物统计学和流行病学中标准的、定义明确的概念（敏感性、特异性、患病率、PPV、NPV），并将其应用于一个真实的临床场景（使用FIB-4指数于NAFLD）。给定的数值是合理的。前提是科学合理的。\n-   **良构性：**该问题提供了计算所需值的所有必要信息。“纳入”和“排除”阈值的定义界定了两种不同的二元分类检验，其性能指标可以唯一地计算出来。\n-   **客观性：**问题以精确、客观的语言陈述，没有主观性断言。\n-   **其他缺陷：**该问题没有违反任何其他无效性标准。它不是不完整的、矛盾的、不切实际的、不适定的、琐碎的或无法验证的。\n\n**步骤3：结论与行动**\n-   **结论：**问题有效。\n-   **行动：**继续进行解答。\n\n**2. 解答**\n\n设 $D$ 为患者患有进展期肝纤维化的事件， $D^c$ 为患者没有患进展期肝纤维化的事件。设 $T^+$ 表示阳性检验结果，$T^-$ 表示阴性检验结果。\n\n问题提供了以下量：\n-   患病率 ($P_{\\text{prev}}$): 患有该疾病的概率。$P_{\\text{prev}} = P(D)$。\n-   敏感性 ($Se$): 在患有疾病的情况下，检验结果为阳性的概率。$Se = P(T^+ | D)$。\n-   特异性 ($Sp$): 在没有患疾病的情况下，检验结果为阴性的概率。$Sp = P(T^- | D^c)$。\n\n我们需要推导以下表达式：\n-   阳性预测值 ($PPV$): 在检验结果为阳性的情况下，患有该疾病的概率。$PPV = P(D | T^+)$。\n-   阴性预测值 ($NPV$): 在检验结果为阴性的情况下，没有患该疾病的概率。$NPV = P(D^c | T^-)$。\n\n**PPV和NPV的推导**\n\n根据贝叶斯定理，$PPV$ 由下式给出：\n$$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n分母 $P(T^+)$ 是检验结果为阳性的总概率。使用全概率定律，我们可以将其表示为：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n我们知道 $P(T^+ | D) = Se$ 且 $P(D) = P_{\\text{prev}}$。不患病的概率为 $P(D^c) = 1 - P(D) = 1 - P_{\\text{prev}}$。$P(T^+ | D^c)$ 项是在非患病个体中检验结果为阳性的概率，即假阳性率。它可以从特异性推导出来：$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp$。\n将这些代入 $P(T^+)$ 的表达式中：\n$$P(T^+) = (Se \\times P_{\\text{prev}}) + ((1 - Sp) \\times (1 - P_{\\text{prev}}))$$\n最后，将此代回 $PPV$ 的公式中：\n$$PPV = \\frac{Se \\times P_{\\text{prev}}}{(Se \\times P_{\\text{prev}}) + (1 - Sp)(1 - P_{\\text{prev}})}$$\n\n类似地，对于 $NPV$，贝叶斯定理给出：\n$$NPV = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}$$\n分母 $P(T^-)$ 是检验结果为阴性的总概率，由全概率定律给出：\n$$P(T^-) = P(T^- | D) P(D) + P(T^- | D^c) P(D^c)$$\n我们知道 $P(T^- | D^c) = Sp$ 且 $P(D^c) = 1 - P_{\\text{prev}}$。$P(T^- | D)$ 项是在患病个体中检验结果为阴性的概率，称为假阴性率。它与敏感性相关：$P(T^- | D) = 1 - P(T^+ | D) = 1 - Se$。\n将这些代入 $P(T^-)$ 的表达式中：\n$$P(T^-) = ((1 - Se) \\times P_{\\text{prev}}) + (Sp \\times (1 - P_{\\text{prev}}))$$\n将此代入 $NPV$ 的公式中：\n$$NPV = \\frac{Sp \\times (1 - P_{\\text{prev}})}{(1 - Se)(P_{\\text{prev}}) + Sp(1 - P_{\\text{prev}})}$$\n\n**计算**\n给定的患病率为 $P_{\\text{prev}} = 0.25$。因此，$1 - P_{\\text{prev}} = 0.75$。我们现在将为两个指定的阈值计算 $PPV$ 和 $NPV$。\n\n**情况1：纳入阈值 (FIB-4 > 2.67)**\n如果FIB-4 > 2.67，则检验为阳性。\n给定的参数是 $Se_{\\text{in}} = 0.45$ 和 $Sp_{\\text{in}} = 0.92$。\n\n-   纳入阈值的 $PPV$：\n    $$PPV_{\\text{in}} = \\frac{0.45 \\times 0.25}{(0.45 \\times 0.25) + (1 - 0.92)(1 - 0.25)} = \\frac{0.1125}{0.1125 + (0.08)(0.75)} = \\frac{0.1125}{0.1125 + 0.06} = \\frac{0.1125}{0.1725} \\approx 0.6521739$$\n    四舍五入到四位有效数字，$PPV_{\\text{in}} = 0.6522$。\n\n-   纳入阈值的 $NPV$：\n    $$NPV_{\\text{in}} = \\frac{0.92 \\times (1 - 0.25)}{(1 - 0.45)(0.25) + 0.92(1 - 0.25)} = \\frac{0.92 \\times 0.75}{(0.55)(0.25) + 0.92(0.75)} = \\frac{0.69}{0.1375 + 0.69} = \\frac{0.69}{0.8275} \\approx 0.8338368$$\n    四舍五入到四位有效数字，$NPV_{\\text{in}} = 0.8338$。\n\n**情况2：排除阈值 (FIB-4  1.3)**\n检验定义为：如果FIB-4  1.3则为阴性，如果FIB-4 $\\geq 1.3$则为阳性。\n给定的参数是 $Se_{\\text{out}} = 0.88$ 和 $Sp_{\\text{out}} = 0.45$。\n\n-   排除阈值的 $PPV$：\n    $$PPV_{\\text{out}} = \\frac{0.88 \\times 0.25}{(0.88 \\times 0.25) + (1 - 0.45)(1 - 0.25)} = \\frac{0.22}{0.22 + (0.55)(0.75)} = \\frac{0.22}{0.22 + 0.4125} = \\frac{0.22}{0.6325} \\approx 0.3478260$$\n    四舍五入到四位有效数字，$PPV_{\\text{out}} = 0.3478$。\n\n-   排除阈值的 $NPV$：\n    $$NPV_{\\text{out}} = \\frac{0.45 \\times (1 - 0.25)}{(1 - 0.88)(0.25) + 0.45(1 - 0.25)} = \\frac{0.45 \\times 0.75}{(0.12)(0.25) + 0.45(0.75)} = \\frac{0.3375}{0.03 + 0.3375} = \\frac{0.3375}{0.3675} \\approx 0.9183673$$\n    四舍五入到四位有效数字，$NPV_{\\text{out}} = 0.9184$。\n\n按顺序要求的四个值是：\n$1$. 纳入阈值的 $PPV$：$0.6522$\n$2$. 纳入阈值的 $NPV$：$0.8338$\n$3$. 排除阈值的 $PPV$：$0.3478$\n$4$. 排除阈值的 $NPV$：$0.9184$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6522  0.8338  0.3478  0.9184\n\\end{pmatrix}\n}\n$$", "id": "4414206"}, {"introduction": "对NAFLD的临床管理不仅需要评估当前的疾病状态，更需要有能力预测其未来的演变轨迹。这项高级练习将向您介绍马尔可夫链这一强大的数学工具，用以模拟肝纤维化在不同分期之间的逐年动态进展。通过构建状态转移矩阵并模拟疾病在十年间的演变过程，您将学习如何运用定量模型来预测长期风险，并深入理解各种风险因素对患者预后的深远影响。[@problem_id:4414228]", "problem": "您正在将非酒精性脂肪性肝病 (NAFLD) 的纤维化进展建模为一个离散时间、有限状态的马尔可夫链，其中时间步长为年，状态为纤维化分期。纤维化分期标记为 $F0, F1, F2, F3, F4$，其中 $F4$ 代表肝硬化，并且是一个吸收态。该模型满足马尔可夫性质：即 $t+1$ 年的状态仅取决于 $t$ 年的状态。转移概率矩阵的每一行之和为 $1$。基线年度转移反映了 NAFLD 中广泛观察到的模式：缓慢的逐级进展，可能发生单级逆转，且不会跳过任何分期。具体来说，对于基线动态：\n- 从 $F0$：以 $0.05$ 的概率转移到 $F1$；否则停留在 $F0$。\n- 从 $F1$：以 $0.02$ 的概率逆转到 $F0$；以 $0.04$ 的概率进展到 $F2$；否则停留在 $F1$。\n- 从 $F2$：以 $0.03$ 的概率逆转到 $F1$；以 $0.05$ 的概率进展到 $F3$；否则停留在 $F2$。\n- 从 $F3$：以 $0.03$ 的概率逆转到 $F2$；以 $0.06$ 的概率进展到 $F4$；否则停留在 $F3$。\n- 从 $F4$：以 $1.00$ 的概率停留在 $F4$。\n\n您将引入风险修正因子作为乘法因子，应用于基线的非停留转移概率：\n- 进展乘数 $m$ 乘以所有向上的单级转移 $Fi \\rightarrow F(i+1)$（其中 $i \\in \\{0,1,2,3\\}$）。\n- 逆转乘数 $d$ 乘以所有向下的单级转移 $Fi \\rightarrow F(i-1)$（其中 $i \\in \\{1,2,3\\}$）。\n\n在应用 $m$ 和 $d$ 之后，对于每个非吸收态 $Fi$，将停留概率重新计算为 $1$ 减去该行所有非对角线概率之和。假设 $F4$ 仍然是吸收态。如果任何一行的非对角线概率之和超过 $1$，则该情景无效；但是，提供的测试用例避免了此类情况。\n\n您的任务是在指定的修正因子下构建年度转移矩阵，并在 $F4$ 是吸收态的假设下，为给定的起始分期估算 $10$ 年肝硬化风险。将 $10$ 年肝硬化风险解释为在第 $10$ 年或之前曾经处于 $F4$ 状态的累积概率；由于 $F4$ 是吸收态，这等于经过 $10$ 次年度转移后处于 $F4$ 状态的概率质量。时间 $0$ 计入在内，因此如果起始分期已经是 $F4$，则 $10$ 年风险为 $1$。\n\n为了便于实现，用整数索引表示状态：$F0 \\mapsto 0$, $F1 \\mapsto 1$, $F2 \\mapsto 2$, $F3 \\mapsto 3$, $F4 \\mapsto 4$。\n\n实现一个程序，对于每个测试用例，构建修正后的转移矩阵，将初始状态分布演化 $10$ 步，并以 $[0,1]$ 范围内的浮点数形式报告 $10$ 年肝硬化风险，四舍五入到 $6$ 位小数。不涉及物理单位。不要使用百分号；以小数形式表示输出。\n\n测试用例（每个用例是一个元组 $(\\text{start\\_stage}, m, d)$）：\n- 案例 1：$(0, 1.0, 1.0)$\n- 案例 2：$(2, 1.5, 1.0)$\n- 案例 3：$(1, 0.5, 1.2)$\n- 案例 4：$(3, 0.0, 1.0)$\n- 案例 5：$(4, 2.0, 0.5)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，不含空格，每个条目精确到 $6$ 位小数，例如：$[0.123456,0.000000,1.000000]$。", "solution": "该问题要求计算非酒精性脂肪性肝病 (NAFLD) 的 $10$ 年肝硬化风险，该疾病被建模为离散时间、有限状态的马尔可夫链。对问题陈述的验证证实了其具有科学依据、问题是良定的且内容是自洽的。因此，我们可以进行形式化的求解。\n\n该系统由一组状态、一个转移概率矩阵和一个初始状态定义。\n\n**1. 状态空间定义**\n纤维化分期表示为一个有限状态集 $S = \\{0, 1, 2, 3, 4\\}$，分别对应病理分期 $F0, F1, F2, F3$ 和 $F4$（肝硬化）。状态 $F4$（索引 $4$）被定义为吸收态。\n\n**2. 转移概率矩阵**\n系统的动态由一个 $5 \\times 5$ 的年度转移概率矩阵 $P$ 决定，其中元素 $P_{ij}$ 表示在一年内从状态 $i$ 转移到状态 $j$ 的概率。根据定义，对于任意行 $i$，其元素之和必须为 $1$：$\\sum_{j=0}^{4} P_{ij} = 1$。\n\n**2.1. 基线转移矩阵 ($P_{\\text{base}}$)**\n问题提供了基线年度转移概率。这些概率用于构建基线矩阵 $P_{\\text{base}}$。非零的非对角线元素如下：\n- $P_{0,1} = 0.05$ (进展 $F0 \\rightarrow F1$)\n- $P_{1,0} = 0.02$ (逆转 $F1 \\rightarrow F0$)\n- $P_{1,2} = 0.04$ (进展 $F1 \\rightarrow F2$)\n- $P_{2,1} = 0.03$ (逆转 $F2 \\rightarrow F1$)\n- $P_{2,3} = 0.05$ (进展 $F2 \\rightarrow F3$)\n- $P_{3,2} = 0.03$ (逆转 $F3 \\rightarrow F2$)\n- $P_{3,4} = 0.06$ (进展 $F3 \\rightarrow F4$)\n\n对角线元素 $P_{ii}$ 表示停留在状态 $i$ 的概率。它们的计算公式为 $P_{ii} = 1 - \\sum_{j \\neq i} P_{ij}$。状态 $F4$ 是吸收态，因此 $P_{4,4} = 1$。\n\n由此得到基线矩阵：\n$$\nP_{\\text{base}} = \\begin{pmatrix}\n0.95  0.05  0.00  0.00  0.00 \\\\\n0.02  0.94  0.04  0.00  0.00 \\\\\n0.00  0.03  0.92  0.05  0.00 \\\\\n0.00  0.00  0.03  0.91  0.06 \\\\\n0.00  0.00  0.00  0.00  1.00\n\\end{pmatrix}\n$$\n\n**2.2. 修正后的转移矩阵 ($P_{\\text{mod}}$)**\n引入风险修正因子作为乘法因子：进展乘数 $m$ 和逆转乘数 $d$。这些因子应用于 $P_{\\text{base}}$ 的非零、非对角线转移概率，以创建修正后的矩阵 $P_{\\text{mod}}(m, d)$。\n\n设 $P'_{ij}$ 为 $P_{\\text{mod}}$ 的元素。修改如下：\n- 进展概率：$P'_{i, i+1} = m \\cdot P_{i, i+1}$，其中 $i \\in \\{0, 1, 2, 3\\}$。\n- 逆转概率：$P'_{i, i-1} = d \\cdot P_{i, i-1}$，其中 $i \\in \\{1, 2, 3\\}$。\n- 所有其他非对角线概率保持为 $0$。\n\n对于非吸收态（$i \\in \\{0, 1, 2, 3\\}$）的对角线（停留）概率需要重新计算，以确保每行之和为 $1$：\n$$P'_{ii} = 1 - \\sum_{j \\neq i} P'_{ij}$$\n吸收态 $F4$ 保持不变：$P'_{4,4} = 1$ 且对于 $j \\neq 4$，$P'_{4,j} = 0$。\n\n**3. 状态演化与风险计算**\n马尔可夫性质意味着 $n$ 年后的状态概率分布可以由初始状态分布和 $n$ 步转移矩阵 $P^n$ 确定。\n设 $\\pi_0$ 为表示时间 $t=0$ 时状态分布的初始行向量。第 $n$ 年的状态分布由 $\\pi_n = \\pi_0 P_{\\text{mod}}^n$ 给出。\n\n对于从特定分期 $s \\in S$ 开始的患者，初始状态分布是一个标准基向量 $\\pi_0 = e_s$，其中当 $j=s$ 时 $(e_s)_j = 1$，否则为 $0$。\n在从状态 $s$ 开始的情况下，经过 $n$ 年后处于状态 $j$ 的概率是 $n$ 步转移矩阵的第 $(s, j)$ 个元素，即 $(P_{\\text{mod}}^n)_{s,j}$。\n\n任务是计算 $10$ 年肝硬化风险。这被定义为在第 $10$ 年或之前处于状态 $4$ 的累积概率。因为状态 $4$ 是吸收态，一旦进入，便永不离开。因此，“在第 $10$ 年或之前处于状态 $4$”这一事件等同于“在第 $10$ 年时处于状态 $4$”这一事件。\n\n对于起始分期 $s$，所要求的风险是在 $10$ 步内从状态 $s$ 转移到状态 $4$ 的概率。这恰好是矩阵 $P_{\\text{mod}}^{10}$ 的第 $(s, 4)$ 个元素。\n\n**4. 算法**\n对于每个测试用例 $(\\text{start\\_stage}, m, d)$：\n1. 根据上述规则构建 $5 \\times 5$ 的修正转移矩阵 $P_{\\text{mod}}(m, d)$。\n2. 使用高效的矩阵幂运算算法（例如，平方求幂）计算 $10$ 步转移矩阵 $P_{10} = P_{\\text{mod}}^{10}$。\n3. $10$ 年肝硬化风险是矩阵 $P_{10}$ 的第 $(s, 4)$ 个元素，其中 $s = \\text{start\\_stage}$。\n4. 结果四舍五入到 $6$ 位小数。\n\n将对每个提供的测试用例实施此过程。", "answer": "[0.013580,0.342674,0.003957,0.000000,1.000000]", "id": "4414228"}]}