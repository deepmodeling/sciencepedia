{"hands_on_practices": [{"introduction": "在肝硬化背景下，通过小份的穿刺活检样本诊断肝细胞癌 (HCC) 是一项挑战，这需要病理医生具备系统性的思维。这项练习旨在引导你将细胞学异型性和结构紊乱这两个核心病理学特征，整合成一个形式化的诊断标准 [@problem_id:4380843]。通过设定明确的阈值并构建逻辑规则，你将学习如何像病理学家一样确保诊断的准确性和一致性，特别是理解为何必须优先考虑结构性异常，以避免将良性的反应性增生误判为癌症。", "problem": "您的任务是使用三种可在常规染色中测量的组织学特征——核浆比 (N:C) 增高、核仁突出和肝细胞板（小梁）增厚——来形式化一个基于规则的诊断算法，用于诊断肝硬化肝脏核心穿刺活检中的肝细胞癌 (HCC)。您的构建应基于以下肝脏病理学中的基本定义和经过充分验证的观察结果：(i) 恶性肿瘤的推断依据是细胞学异型性与结构紊乱的结合；(ii) 肝硬化中的反应性肝细胞可能表现出细胞学异型性，但没有明显的结构破坏；(iii) 比正常厚的肝细胞板反映了结构错乱，其中超过$3$个细胞厚的肝细胞板与肿瘤形成密切相关；(iv) 正常或再生肝细胞的N:C中位数通常接近$0.3$至$0.4$，而恶性肝细胞的N:C中位数通常超过$0.5$至$0.6$；(v) 突出的核仁在少数良性再生环境中出现，但在恶性肿瘤中更为常见。您必须为每个特征设定明确的决策阈值，并指定触发HCC诊断的逻辑组合。\n\n您有以下来自文献质量观察结果的经验基线来指导阈值选择：在肝硬化再生结节中，超过3个细胞厚的肝细胞板在低倍镜视野中几乎不存在（通常少于$1\\%$的视野），N:C中位数很少超过$0.45$，具有突出核仁的细胞占肝细胞的比例低于$5\\%$；在确诊的肝细胞癌中，超过3个细胞厚的肝细胞板在大多数病例中占据至少$15\\%$至$20\\%$的低倍镜视野，N:C中位数通常大于$0.6$，并且在相当一部分病例中，具有突出核仁的细胞至少占肿瘤细胞的$20\\%$。\n\n对一份新的肝硬化核心穿刺活检进行如下评估：检查了$20$个不重叠的低倍镜视野；在$20$个视野中的$6$个（$30\\%$）中，肝细胞板厚度超过$3$个细胞。对$200$个病变区域的肝细胞进行计数，得出N:C中位数为$0.55$，并且$25\\%$的细胞显示出突出、易于观察的核仁。\n\n您的目标是从以下选项中选择唯一最佳的算法，该算法：(a) 为三个特征编码了明确的阈值；(b) 通过优先考虑结构异常而非纯粹的细胞学异型性，对再生结节达到至少$95\\%$的特异性；以及 (c) 将当前活检分类为HCC。哪个算法最能满足这些目标？\n\nA. 如果以下$3$个标准中的任意$2$个得到满足，则诊断为HCC：N:C中位数 $\\ge 0.50$；核仁突出的细胞比例 $\\ge 15\\%$；超过3个细胞厚的肝细胞板存在于 $\\ge 20\\%$ 的低倍镜视野中。否则，不诊断为HCC。\n\nB. 如果在 $\\ge 15\\%$ 的低倍镜视野中存在超过$3$个细胞厚的肝细胞板，并且满足以下至少$1$个条件：N:C中位数 $\\ge 0.55$ 或核仁突出的细胞比例 $\\ge 20\\%$。则诊断为HCC。否则，不诊断为HCC。\n\nC. 如果满足以下任意$1$个条件，则诊断为HCC：N:C中位数 $\\ge 0.55$ 或核仁突出的细胞比例 $\\ge 20\\%$ 或超过3个细胞厚的肝细胞板存在于 $\\ge 10\\%$ 的低倍镜视野中。否则，不诊断为HCC。\n\nD. 仅当以下所有$3$个更严格的阈值都得到满足时，才诊断为HCC：N:C中位数 $\\ge 0.60$；核仁突出的细胞比例 $\\ge 25\\%$；超过3个细胞厚的肝细胞板存在于 $\\ge 30\\%$ 的低倍镜视野中。否则，不诊断为HCC。", "solution": "问题陈述被评估为有效。它在科学上基于组织病理学原理，作为一个逻辑选择任务，其提法是恰当的，并且其语言和数据是客观的。所有提供的信息都是自洽且充分的，足以根据既定标准评估所提出的算法。\n\n任务是根据三个特定目标，从给定选项中选择最佳诊断算法。该算法必须使用三个特征来形式化肝细胞癌（HCC）的诊断：增厚的肝细胞板（$P_{\\text{thick}}$）、增高的核浆比（$N:C$）和突出的核仁（$N_{\\text{prom}}$）。\n\n算法的目标是：\n(a) 它必须有明确的、定量的阈值。\n(b) 它必须通过优先考虑结构异常而非纯粹的细胞学异型性，对再生结节达到至少$95\\%$的特异性。这是一个关键约束，基于所提供的原则，即肝硬化中的反应性肝细胞可以表现出细胞学异型性（增高的$N:C$比、突出的核仁）但并非恶性。因此，结构紊乱（增厚的肝细胞板）应成为一个主要或强制性的发现。\n(c) 它必须将所提供的病例活检分类为HCC。\n\n病例活检的数据如下：\n- 增厚的肝细胞板 ($P_{\\text{thick}}$)：在$20$个低倍镜视野中有$6$个视野（即$30\\%$）发现厚度超过$3$个细胞的肝细胞板。\n- 核浆比 ($N:C$)：N:C中位数为$0.55$。\n- 核仁突出 ($N_{\\text{prom}}$)：在$25\\%$的细胞中观察到突出的核仁。\n\n算法不应误分类为HCC的良性再生结节的经验基线是：\n- $P_{\\text{thick}}  1\\%$的视野。\n- N:C中位数很少超过$0.45$。\n- $N_{\\text{prom}}  5\\%$的肝细胞。\n\n我们现在将根据这三个目标评估每个选项。\n\n**选项 A：**\n- **算法：** 如果以下$3$个标准中的任意$2$个得到满足，则诊断为HCC：N:C中位数 $\\ge 0.50$；$N_{\\text{prom}} \\ge 15\\%$；$P_{\\text{thick}} \\ge 20\\%$。\n- **评估：**\n    1. **目标 (a) - 明确的阈值：** 此目标已满足。阈值为$0.50$、$15\\%$和$20\\%$。\n    2. **目标 (c) - 将病例分类为HCC：**\n        - N:C中位数是否 $\\ge 0.50$？是，$0.55 \\ge 0.50$。\n        - $N_{\\text{prom}}$ 是否 $\\ge 15\\%$？是，$25\\% \\ge 15\\%$。\n        - $P_{\\text{thick}}$ 是否 $\\ge 20\\%$？是，$30\\% \\ge 20\\%$。\n        所有三个标准都满足了。由于只需要满足$2$个，该算法将此病例诊断为HCC。此目标已满足。\n    3. **目标 (b) - 特异性与优先考虑结构：** 该算法允许在两个细胞学标准（N:C中位数 $\\ge 0.50$ 和 $N_{\\text{prom}} \\ge 15\\%$）满足的情况下诊断HCC，即使结构标准（$P_{\\text{thick}} \\ge 20\\%$）不满足。这直接违反了优先考虑结构的要求，因为它将允许仅基于细胞学异型性进行诊断，而这在非恶性的反应性状态中也可能出现。这导致特异性差。此目标未满足。\n- **结论：** 不正确。该算法未能满足目标(b)，因为它没有优先考虑结构异常，从而可能导致特异性降低。\n\n**选项 B：**\n- **算法：** 如果 $P_{\\text{thick}} \\ge 15\\%$ 并且满足以下至少一个条件：N:C中位数 $\\ge 0.55$ 或 $N_{\\text{prom}} \\ge 20\\%$，则诊断为HCC。\n- **评估：**\n    1. **目标 (a) - 明确的阈值：** 此目标已满足。阈值为$15\\%$、$0.55$和$20\\%$。\n    2. **目标 (c) - 将病例分类为HCC：**\n        - 首先，检查强制性的结构标准：$P_{\\text{thick}}$ 是否 $\\ge 15\\%$？是，$30\\% \\ge 15\\%$。\n        - 其次，检查细胞学标准（至少满足一个）：N:C中位数是否 $\\ge 0.55$？是，$0.55 \\ge 0.55$。$N_{\\text{prom}}$ 是否 $\\ge 20\\%$？是，$25\\% \\ge 20\\%$。\n        由于强制性的结构标准和两个细胞学标准都满足，该算法将此病例诊断为HCC。此目标已满足。\n    3. **目标 (b) - 特异性与优先考虑结构：** 该规则的逻辑结构是`(结构标准) 与 (至少一个细胞学标准)`。这明确地将结构异常作为诊断的先决条件，从而满足了优先考虑它的指令。仅有细胞学异型性的病例不会被诊断为HCC。此外，阈值（$P_{\\text{thick}}$ 为$15\\%$，$N:C$ 为$0.55$，$N_{\\text{prom}}$ 为$20\\%$）设置得远高于再生结节的上限（分别为$1\\%$、$0.45$、$5\\%$），确保了高特异性。此目标已满足。\n- **结论：** 正确。该算法满足所有三个目标。它正确地对病例进行分类，通过将结构异常作为强制性要求来确保高特异性，并使用了明确的阈值。\n\n**选项 C：**\n- **算法：** 如果满足以下任意$1$个条件，则诊断为HCC：N:C中位数 $\\ge 0.55$ 或 $N_{\\text{prom}} \\ge 20\\%$ 或 $P_{\\text{thick}} \\ge 10\\%$。\n- **评估：**\n    1. **目标 (a) - 明确的阈值：** 此目标已满足。阈值为$0.55$、$20\\%$和$10\\%$。\n    2. **目标 (c) - 将病例分类为HCC：**\n        - N:C中位数是否 $\\ge 0.55$？是，$0.55 \\ge 0.55$。\n        由于只需要一个标准，该算法将此病例诊断为HCC。此目标已满足。\n    3. **目标 (b) - 特异性与优先考虑结构：** “任意1个”（逻辑或）结构是一个主要缺陷。它允许基于任何单个特征（包括单独的细胞学特征）诊断HCC。这直接违背了优先考虑结构以与反应性异型性区分的原则。例如，一个N:C中位数为$0.56$但没有其他异常的反应性结节会被错误地诊断为HCC。此目标未满足。\n- **结论：** 不正确。由于其“或”逻辑导致低特异性，该算法未能满足目标(b)。\n\n**选项 D：**\n- **算法：** 仅当以下所有$3$个更严格的阈值都得到满足时，才诊断为HCC：N:C中位数 $\\ge 0.60$；$N_{\\text{prom}} \\ge 25\\%$；$P_{\\text{thick}} \\ge 30\\%$。\n- **评估：**\n    1. **目标 (a) - 明确的阈值：** 此目标已满足。阈值为$0.60$、$25\\%$和$30\\%$。\n    2. **目标 (c) - 将病例分类为HCC：**\n        - N:C中位数是否 $\\ge 0.60$？否，$0.55  0.60$。\n        - $N_{\\text{prom}}$ 是否 $\\ge 25\\%$？是，$25\\% \\ge 25\\%$。\n        - $P_{\\text{thick}}$ 是否 $\\ge 30\\%$？是，$30\\% \\ge 30\\%$。\n        由于该算法要求所有三个标准都得到满足，而N:C标准未满足，因此该算法不会将此病例诊断为HCC。此目标未满足。\n    3. **目标 (b) - 特异性与优先考虑结构：** 该算法需要所有三个特征，包括结构特征，并设置了非常高的阈值。它将具有出色的特异性。此目标已满足。然而，未能满足目标(c)使其不合格。\n- **结论：** 不正确。该算法过于严格，未能将给定病例分类为HCC，因此未能满足目标(c)。\n\n**总结：**\n只有选项B成功满足所有三个要求的目标：它使用明确的阈值，优先考虑结构错乱以确保对良性模仿物的高特异性，并正确地将指定的活检分类为HCC。", "answer": "$$\\boxed{B}$$", "id": "4380843"}, {"introduction": "一个肿瘤标志物的临床价值不仅取决于其生物学特性，还依赖于它在特定人群中的实际表现。这项练习将让你亲手应用生物统计学的基本概念——如灵敏度 ($\\text{Se}$)、特异度 ($\\text{Sp}$) 和患病率 ($P_{\\text{prev}}$)——来计算甲胎蛋白 (AFP) 作为筛查工具的预测价值 [@problem_id:4380795]。理解这些计算对于在临床实践中准确解读筛查结果、评估其对患者的真实意义至关重要。", "problem": "某医院对一组肝硬化患者实施肝细胞癌（HCC）监测计划。甲胎蛋白（AFP）被用作具有固定阈值的二元筛查测试。在该队列中，根据先前的验证工作，以下性能特征和疾病频率已得到充分证实：灵敏度为 $0.60$，特异性为 $0.90$，疾病患病率为 $0.20$。仅使用诊断测试评估中的核心概率定义和贝叶斯定理，推导阳性预测值（PPV）（定义为 $P(\\text{Disease} \\mid \\text{Test positive})$）和阴性预测值（NPV）（定义为 $P(\\text{No disease} \\mid \\text{Test negative})$）关于灵敏度、特异性和患病率的表达式。然后计算该队列的 PPV 和 NPV 的数值。\n\n将您的最终答案以行向量 $[PPV \\; NPV]$ 的形式报告，四舍五入到三位有效数字，并以小数表示（不要使用百分号）。", "solution": "该问题陈述被评估为有效，因为它在科学上基于概率论，问题提出得当且信息充分，语言客观。因此，我们可以进行正式求解。\n\n让我们根据提供的信息来定义事件和概率。\n设 $D$ 为患者患有肝细胞癌（疾病）的事件。\n设 $D^c$ 为患者未患该疾病的事件。\n设 $T^+$ 为甲胎蛋白（AFP）测试结果为阳性的事件。\n设 $T^-$ 为测试结果为阴性的事件。\n\n问题提供了以下概率：\n测试的灵敏度 $\\text{Se}$ 是指在患者患有该疾病的情况下，测试结果为阳性的概率：\n$$P(T^+ \\mid D) = \\text{Se} = 0.60$$\n测试的特异性 $\\text{Sp}$ 是指在患者未患该疾病的情况下，测试结果为阴性的概率：\n$$P(T^- \\mid D^c) = \\text{Sp} = 0.90$$\n疾病的患病率 $P_{\\text{prev}}$ 是指在该队列中患者患有该疾病的先验概率：\n$$P(D) = P_{\\text{prev}} = 0.20$$\n\n由此，我们可以推导出互补概率：\n患者未患该疾病的概率为：\n$$P(D^c) = 1 - P(D) = 1 - P_{\\text{prev}} = 1 - 0.20 = 0.80$$\n假阳性率是在患者未患该疾病的情况下，测试结果为阳性的概率：\n$$P(T^+ \\mid D^c) = 1 - P(T^- \\mid D^c) = 1 - \\text{Sp} = 1 - 0.90 = 0.10$$\n假阴性率是在患者患有该疾病的情况下，测试结果为阴性的概率：\n$$P(T^- \\mid D) = 1 - P(T^+ \\mid D) = 1 - \\text{Se} = 1 - 0.60 = 0.40$$\n\n任务的第一部分是推导阳性预测值（$\\text{PPV}$）（定义为 $P(D \\mid T^+)$）关于灵敏度、特异性和患病率的表达式。我们应用贝叶斯定理：\n$$\\text{PPV} = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)}$$\n分母 $P(T^+)$ 是测试结果为阳性的总概率。我们可以使用全概率公式将其展开：\n$$P(T^+) = P(T^+ \\mid D) P(D) + P(T^+ \\mid D^c) P(D^c)$$\n代入灵敏度、特异性和患病率的定义：\n$$P(T^+) = (\\text{Se} \\times P_{\\text{prev}}) + ((1 - \\text{Sp}) \\times (1 - P_{\\text{prev}}))$$\n将此表达式代回 $\\text{PPV}$ 的公式，我们得到通用表达式：\n$$\\text{PPV} = \\frac{\\text{Se} \\times P_{\\text{prev}}}{(\\text{Se} \\times P_{\\text{prev}}) + (1 - \\text{Sp})(1 - P_{\\text{prev}})}$$\n\n任务的第二部分是推导阴性预测值（$\\text{NPV}$）（定义为 $P(D^c \\mid T^-)$）关于相同参数的表达式。我们再次应用贝叶斯定理：\n$$\\text{NPV} = P(D^c \\mid T^-) = \\frac{P(T^- \\mid D^c) P(D^c)}{P(T^-)}$$\n分母 $P(T^-)$ 是测试结果为阴性的总概率，可以使用全概率公式将其展开：\n$$P(T^-) = P(T^- \\mid D) P(D) + P(T^- \\mid D^c) P(D^c)$$\n代入灵敏度、特异性和患病率的定义：\n$$P(T^-) = ((1 - \\text{Se}) \\times P_{\\text{prev}}) + (\\text{Sp} \\times (1 - P_{\\text{prev}}))$$\n将此代入 $\\text{NPV}$ 的公式，我们得到通用表达式：\n$$\\text{NPV} = \\frac{\\text{Sp} \\times (1 - P_{\\text{prev}})}{((1 - \\text{Se}) \\times P_{\\text{prev}}) + \\text{Sp}(1 - P_{\\text{prev}})}$$\n\n现在，我们使用给定的数据计算 $\\text{PPV}$ 和 $\\text{NPV}$ 的数值：$\\text{Se} = 0.60$，$\\text{Sp} = 0.90$ 和 $P_{\\text{prev}} = 0.20$。\n\n对于 $\\text{PPV}$：\n$$\\text{PPV} = \\frac{0.60 \\times 0.20}{(0.60 \\times 0.20) + (1 - 0.90)(1 - 0.20)}$$\n$$\\text{PPV} = \\frac{0.12}{0.12 + (0.10)(0.80)}$$\n$$\\text{PPV} = \\frac{0.12}{0.12 + 0.08}$$\n$$\\text{PPV} = \\frac{0.12}{0.20} = 0.60$$\n\n对于 $\\text{NPV}$：\n$$\\text{NPV} = \\frac{0.90 \\times (1 - 0.20)}{((1 - 0.60) \\times 0.20) + 0.90(1 - 0.20)}$$\n$$\\text{NPV} = \\frac{0.90 \\times 0.80}{(0.40 \\times 0.20) + (0.90 \\times 0.80)}$$\n$$\\text{NPV} = \\frac{0.72}{0.08 + 0.72}$$\n$$\\text{NPV} = \\frac{0.72}{0.80} = 0.90$$\n\n问题要求最终答案四舍五入到三位有效数字。计算出的值为 $\\text{PPV} = 0.60$ 和 $\\text{NPV} = 0.90$。为了用三位有效数字表示它们，我们分别写作 $0.600$ 和 $0.900$。最终答案要求以行向量的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.600  0.900\n\\end{pmatrix}\n}\n$$", "id": "4380795"}]}