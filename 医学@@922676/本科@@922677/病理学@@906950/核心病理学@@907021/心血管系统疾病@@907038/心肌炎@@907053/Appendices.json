{"hands_on_practices": [{"introduction": "心肌炎的诊断在病理学上依赖于在心肌组织中发现炎症浸润。然而，由于炎症通常呈斑片状分布，单次心内膜心肌活检（EMB）可能无法取到病变组织，导致假阴性结果。本练习通过应用基础概率论，探讨了为达到所需的诊断置信度，需要进行多少次独立的活检取样。这个计算阐明了在面对诊断不确定性时，如何从数学上优化临床操作策略 [@problem_id:4412283]。", "problem": "在心肌炎等局灶性炎性疾病中，诊断性病变可能呈斑片状分布。为了增加捕获到诊断性病灶的机会，会从右心室的不同部位采集心内膜心肌活检（EMB）样本。假设每个EMB样本独立地有 $p = 0.2$ 的概率含有组织学上可诊断心肌炎的病变。由于取样点在空间上分离且随机选择，因此假设样本之间相互独立。请仅使用概率论中的补集法则和独立伯努利试验的性质，推导出 $n$ 个独立样本中至少有一个具有诊断性的概率的通用表达式。然后，确定为使检测到心肌炎的总概率至少为 $0.95$ 所需的最小整数样本数 $n$。将目标概率表示为 $0.95$（不使用百分号），并报告达到或超过此阈值的最小整数 $n$。无需单位。", "solution": "问题陈述在科学上是合理的，内容自洽，且提法妥当。它展示了概率论在医学诊断现实问题中的一个标准应用，没有任何事实错误、歧义或矛盾。因此，该问题被视为有效。\n\n该问题需要分两部分解答：首先，推导一个通用表达式；其次，基于该表达式计算一个具体值。\n\n第1部分：推导通用表达式。\n\n设 $n$ 为采集的独立心内膜心肌活检（EMB）样本的总数。\n设 $p$ 为单个样本对心肌炎具有诊断性的概率。已知 $p = 0.2$。\n设 $A_i$ 为第 $i$ 个样本具有诊断性的事件，其中 $i = 1, 2, \\ldots, n$。我们有 $P(A_i) = p$。\n题目说明样本是独立的。\n目标是求 $n$ 个样本中至少有一个具有诊断性的概率。设此事件为 $D$。\n事件 $D$ 可表示为各个独立事件的并集：$D = A_1 \\cup A_2 \\cup \\ldots \\cup A_n$。\n\n按照题目要求，我们使用补集法则。事件 $D$ 的补集，记作 $D^c$，是指*没有*样本具有诊断性的事件。这意味着对于所有从 $1$ 到 $n$ 的 $i$，第 $i$ 个样本都*不*具有诊断性。\n设 $A_i^c$ 为 $A_i$ 的补集，即第 $i$ 个样本不具有诊断性的事件。\n对单个事件使用补集法则，单个样本不具有诊断性的概率为：\n$$P(A_i^c) = 1 - P(A_i) = 1 - p$$\n事件 $D^c$ 是所有样本都不具有诊断性，可以写成各个非诊断性事件的交集：\n$$D^c = A_1^c \\cap A_2^c \\cap \\ldots \\cap A_n^c$$\n问题陈述样本是独立的。因此，事件 $A_i^c$ 也是独立的。独立事件交集的概率是它们各自概率的乘积：\n$$P(D^c) = P(A_1^c \\cap A_2^c \\cap \\ldots \\cap A_n^c) = \\prod_{i=1}^{n} P(A_i^c)$$\n由于对所有 $i$ 都有 $P(A_i^c) = 1-p$，上式变为：\n$$P(D^c) = (1-p)^n$$\n最后，我们再次应用补集法则来求事件 $D$ 的概率：\n$$P(D) = 1 - P(D^c)$$\n代入 $P(D^c)$ 的表达式，我们得到 $n$ 个独立样本中至少有一个具有诊断性的概率的通用表达式：\n$$P(D) = 1 - (1-p)^n$$\n这就完成了问题的第一部分。\n\n第2部分：计算所需的最少样本数。\n\n我们已知单次成功的概率 $p=0.2$ 以及检测到心肌炎的总概率必须至少为 $0.95$ 的要求。使用推导出的公式：\n$$1 - (1-p)^n \\ge 0.95$$\n代入给定的 $p=0.2$ 值：\n$$1 - (1-0.2)^n \\ge 0.95$$\n$$1 - (0.8)^n \\ge 0.95$$\n为求解 $n$，我们整理不等式：\n$$-(0.8)^n \\ge 0.95 - 1$$\n$$-(0.8)^n \\ge -0.05$$\n两边同乘以 $-1$，不等号方向反转：\n$$(0.8)^n \\le 0.05$$\n为了分离出指数 $n$，我们对不等式两边取自然对数($\\ln$)。由于自然对数函数是严格递增函数，不等号的方向保持不变。\n$$\\ln((0.8)^n) \\le \\ln(0.05)$$\n使用对数性质 $\\ln(a^b) = b \\ln(a)$：\n$$n \\ln(0.8) \\le \\ln(0.05)$$\n为了解出 $n$，我们必须除以 $\\ln(0.8)$。关键要注意，对于任何满足 $0  x  1$ 的数 $x$，其自然对数 $\\ln(x)$ 是负数。由于 $\\ln(0.8)$ 是负数，用它相除会再次反转不等号的方向：\n$$n \\ge \\frac{\\ln(0.05)}{\\ln(0.8)}$$\n现在，我们可以计算右侧的值：\n$$\\frac{\\ln(0.05)}{\\ln(0.8)} \\approx \\frac{-2.99573}{-0.22314} \\approx 13.425$$\n所以，不等式为：\n$$n \\ge 13.425$$\n由于样本数 $n$ 必须是整数，满足此条件的最小整数值是 $14$。\n\n因此，至少需要 $14$ 个样本才能确保检测到心肌炎的概率至少为 $0.95$。", "answer": "$$\n\\boxed{14}\n$$", "id": "4412283"}, {"introduction": "在临床实践中，诊断很少依赖于单一的检测结果，而是综合多方面信息的系统过程。本练习模拟了一位临床医生如何整合来自不同来源的证据——包括血清生物标志物（肌钙蛋白）、心电图（ECG）和影像学检查（CCTA）——来评估疑似心肌炎的患者。通过应用贝叶斯定理和似然比，我们可以量化每个新证据如何更新我们对疾病可能性的判断，从而将诊断从一个模糊的猜测转变为一个有数据支持的概率评估 [@problem_id:4412401]。", "problem": "一位临床医生正在评估一名患有急性胸痛的患者，并考虑心肌炎作为目标疾病。请根据病理学和临床流行病学，使用贝叶斯定理和似然比的定义，从第一性原理出发，在整合三个独立的发现后，推导出心肌炎的后验概率。该患者的数据如下：血清肌钙蛋白I为 $2.0$ ng/mL（高于实验室参考上限），冠状动脉计算机断层扫描血管造影（CCTA；冠状动脉的计算机断层扫描血管造影）显示无阻塞性冠状动脉疾病（CAD；冠状动脉疾病），12导联心电图（ECG；心电图）显示弥漫性ST段抬高，无对应导联ST段压低。假设在急诊科急性胸痛患者群体中，心肌炎（患病）与非心肌炎（未患病）的先验概率和似然比如下：\n- 心肌炎的先验概率 $p_{0} = 0.10$。\n- 肌钙蛋白I升高的似然比 $\\text{LR}_{\\text{TnI}} = 2.0$。\n- 弥漫性ST段抬高而无对应改变的似然比 $\\text{LR}_{\\text{ECG}} = 6.0$。\n- CCTA正常（无阻塞性CAD）的似然比 $\\text{LR}_{\\text{CCTA}} = 8.0$。\n\n假设在给定疾病状态的情况下，这些检测结果是条件独立的。从概率、优势比和似然比的标准定义出发，推导出后验概率的表达式，并根据所提供的数据计算其值。将最终概率表示为小数，并四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题要求从第一性原理出发，推导在给定三个独立的临床发现的情况下，心肌炎的后验概率。我们将使用以优势比和似然比表示的贝叶斯定理。\n\n设 $D$ 为患者患有心肌炎的事件，$\\neg D$ 为患者未患心肌炎的事件。给定的心肌炎先验概率为 $P(D) = p_0 = 0.10$。因此，未患该病的概率为 $P(\\neg D) = 1 - P(D) = 1 - 0.10 = 0.90$。\n\n事件 $A$ 的优势比定义为该事件发生的概率与不发生的概率之比，$O(A) = \\frac{P(A)}{1-P(A)}$。患心肌炎的先验优势比为：\n$$\nO_{\\text{pre}} = \\frac{P(D)}{P(\\neg D)} = \\frac{p_0}{1-p_0}\n$$\n\n设三个独立的发现分别表示为 $E_1$、$E_2$ 和 $E_3$：\n- $E_1$：血清肌钙蛋白I升高。\n- $E_2$：心电图显示弥漫性ST段抬高而无对应改变。\n- $E_3$：CCTA正常（无阻塞性CAD）。\n\n组合证据是事件 $E = E_1 \\cap E_2 \\cap E_3$。我们希望找到后验概率 $P(D|E)$，即在给定证据 $E$ 的情况下患有心肌炎的概率。后验优势比由下式给出：\n$$\nO_{\\text{post}} = \\frac{P(D|E)}{P(\\neg D|E)}\n$$\n\n根据贝叶斯定理，后验概率为 $P(D|E) = \\frac{P(E|D)P(D)}{P(E)}$。同样地，$P(\\neg D|E) = \\frac{P(E|\\neg D)P(\\neg D)}{P(E)}$。\n将这些代入后验优势比的表达式中：\n$$\nO_{\\text{post}} = \\frac{\\frac{P(E|D)P(D)}{P(E)}}{\\frac{P(E|\\neg D)P(\\neg D)}{P(E)}} = \\frac{P(E|D)}{P(E|\\neg D)} \\times \\frac{P(D)}{P(\\neg D)}\n$$\n\n$\\frac{P(E|D)}{P(E|\\neg D)}$ 这一项是证据 $E$ 的似然比，记为 $\\text{LR}_E$。$\\frac{P(D)}{P(\\neg D)}$ 这一项是先验优势比，记为 $O_{\\text{pre}}$。这就建立了基本关系：\n$$\nO_{\\text{post}} = \\text{LR}_E \\times O_{\\text{pre}}\n$$\n\n问题陈述，这三个发现在给定疾病状态下是条件独立的。这意味着，在给定疾病存在（或不存在）的情况下，观察到所有三个发现的概率是各个独立概率的乘积。\n对于 $\\text{LR}_E$ 的分子：\n$$\nP(E|D) = P(E_1 \\cap E_2 \\cap E_3 | D) = P(E_1|D) \\times P(E_2|D) \\times P(E_3|D)\n$$\n对于 $\\text{LR}_E$ 的分母：\n$$\nP(E|\\neg D) = P(E_1 \\cap E_2 \\cap E_3 | \\neg D) = P(E_1|\\neg D) \\times P(E_2|\\neg D) \\times P(E_3|\\neg D)\n$$\n\n将这些代入 $\\text{LR}_E$ 的表达式中：\n$$\n\\text{LR}_E = \\frac{P(E_1|D)P(E_2|D)P(E_3|D)}{P(E_1|\\neg D)P(E_2|\\neg D)P(E_3|\\neg D)} = \\left(\\frac{P(E_1|D)}{P(E_1|\\neg D)}\\right) \\times \\left(\\frac{P(E_2|D)}{P(E_2|\\neg D)}\\right) \\times \\left(\\frac{P(E_3|D)}{P(E_3|\\neg D)}\\right)\n$$\n乘积中的每一项都是单个发现的似然比：\n- $\\text{LR}_{\\text{TnI}} = \\frac{P(E_1|D)}{P(E_1|\\neg D)}$\n- $\\text{LR}_{\\text{ECG}} = \\frac{P(E_2|D)}{P(E_2|\\neg D)}$\n- $\\text{LR}_{\\text{CCTA}} = \\frac{P(E_3|D)}{P(E_3|\\neg D)}$\n\n因此，组合似然比是各个似然比的乘积：\n$$\n\\text{LR}_{\\text{combined}} = \\text{LR}_{\\text{TnI}} \\times \\text{LR}_{\\text{ECG}} \\times \\text{LR}_{\\text{CCTA}}\n$$\n我们的后验优势比表达式变为：\n$$\nO_{\\text{post}} = (\\text{LR}_{\\text{TnI}} \\times \\text{LR}_{\\text{ECG}} \\times \\text{LR}_{\\text{CCTA}}) \\times O_{\\text{pre}}\n$$\n\n最后，我们需要将后验优势比转换回概率。根据优势比的定义 $O = \\frac{P}{1-P}$，我们可以解出 $P$：\n$O(1-P) = P \\implies O-OP = P \\implies O = P(1+O) \\implies P = \\frac{O}{1+O}$。\n因此，后验概率 $P_{\\text{post}} \\equiv P(D|E)$ 是：\n$$\nP_{\\text{post}} = \\frac{O_{\\text{post}}}{1 + O_{\\text{post}}}\n$$\n\n现在，我们将给定的值代入这个推导出的框架中。\n给定：\n- 先验概率 $p_0 = 0.10$。\n- $\\text{LR}_{\\text{TnI}} = 2.0$。\n- $\\text{LR}_{\\text{ECG}} = 6.0$。\n- $\\text{LR}_{\\text{CCTA}} = 8.0$。\n\n步骤1：计算先验优势比。\n$$\nO_{\\text{pre}} = \\frac{p_0}{1 - p_0} = \\frac{0.10}{1 - 0.10} = \\frac{0.10}{0.90} = \\frac{1}{9}\n$$\n\n步骤2：计算组合似然比。\n$$\n\\text{LR}_{\\text{combined}} = 2.0 \\times 6.0 \\times 8.0 = 12.0 \\times 8.0 = 96.0\n$$\n\n步骤3：计算后验优势比。\n$$\nO_{\\text{post}} = \\text{LR}_{\\text{combined}} \\times O_{\\text{pre}} = 96.0 \\times \\frac{1}{9} = \\frac{96}{9} = \\frac{32}{3}\n$$\n\n步骤4：计算后验概率。\n$$\nP_{\\text{post}} = \\frac{O_{\\text{post}}}{1 + O_{\\text{post}}} = \\frac{32/3}{1 + 32/3} = \\frac{32/3}{(3+32)/3} = \\frac{32/3}{35/3} = \\frac{32}{35}\n$$\n\n步骤5：将分数转换为小数，并四舍五入到四位有效数字。\n$$\nP_{\\text{post}} = \\frac{32}{35} \\approx 0.9142857...\n$$\n四舍五入到四位有效数字，我们得到 $0.9143$。\n\n后验概率 $P_{\\text{post}}$ 用先验概率 $p_0$ 和似然比 $\\text{LR}_i$ 表示的最终表达式为：\n$$\nP_{\\text{post}} = \\frac{\\left(\\prod_{i} \\text{LR}_i\\right) \\frac{p_0}{1-p_0}}{1 + \\left(\\prod_{i} \\text{LR}_i\\right) \\frac{p_0}{1-p_0}}\n$$\n对于本问题中的具体数值，计算出的后验概率约为 $0.9143$。", "answer": "$$\n\\boxed{0.9143}\n$$", "id": "4412401"}, {"introduction": "诊断心肌炎后，评估其对心脏功能的实际影响至关重要，因为炎症可能损害心肌的泵血能力。本练习运用生理学中的一个基石——菲克原理（Fick's principle），来计算心输出量，这是衡量心脏整体泵血效率的关键指标。通过这个练习，我们可以将病理学上的发现（心肌炎症）与病人生理上的表现（心功能状态）直接联系起来，深刻理解疾病的临床后果 [@problem_id:4412354]。", "problem": "一位患有急性病毒性心肌炎的患者在静息状态下接受评估。通过间接量热法测得其耗氧量（定义为身体吸收氧气的速率）为 $250$ $\\mathrm{mL}$ $\\mathrm{min}^{-1}$。测得动脉血氧含量为 $190$ $\\mathrm{mL}$ $\\mathrm{L}^{-1}$，混合静脉血氧含量为 $140$ $\\mathrm{mL}$ $\\mathrm{L}^{-1}$。利用氧气在体循环中的质量守恒定律和 Fick 原理的概念基础，推导出心输出量的表达式，并计算该患者的心输出量数值。\n\n将耗氧量定义为 $\\mathrm{VO_2}$，心输出量定义为 $Q$，动脉血氧含量定义为 $C_{\\mathrm{aO_2}}$，静脉血氧含量定义为 $C_{\\mathrm{vO_2}}$。\n\n以 $\\mathrm{L \\, min^{-1}}$ 为单位表示最终的心输出量，并将答案四舍五入至三位有效数字。", "solution": "该问题要求基于所提供的生理测量数据，推导心输出量的表达式并进行计算。验证过程证实了该问题具有科学依据、提法明确且客观。它基于 Fick 原理，这是心血管生理学的一个基石。\n\nFick 原理是质量守恒定律的一个应用。该原理指出，某一器官对某种物质的总摄取量或释放量，等于流经该器官的血流量与该物质的动静脉浓度差的乘积。当应用于整个体循环的氧气时，它将耗氧量（$\\mathrm{VO_2}$）、心输出量（$Q$）以及动脉和混合静脉血的氧含量联系起来。\n\n设 $C_{\\mathrm{aO_2}}$ 为动脉血氧含量，单位为毫升氧气每升血液（$\\mathrm{mL \\, L^{-1}}$）。\n设 $C_{\\mathrm{vO_2}}$ 为混合静脉血氧含量，单位也为 $\\mathrm{mL \\, L^{-1}}$。\n设 $Q$ 为心输出量，即心脏单位时间内泵出的血量，单位为升每分钟（$\\mathrm{L \\, min^{-1}}$）。\n设 $\\mathrm{VO_2}$ 为全身的耗氧速率，单位为毫升每分钟（$\\mathrm{mL \\, min^{-1}}$）。\n\n输送至体循环组织的氧气速率是心输出量与动脉血氧含量的乘积：\n$$ \\text{氧气输送速率} = Q \\times C_{\\mathrm{aO_2}} $$\n该速率的单位为 $(\\mathrm{L \\, min^{-1}}) \\times (\\mathrm{mL \\, L^{-1}}) = \\mathrm{mL \\, min^{-1}}$。\n\n从体循环组织经静脉血返回的氧气速率是心输出量与混合静脉血氧含量的乘积：\n$$ \\text{氧气返回速率} = Q \\times C_{\\mathrm{vO_2}} $$\n\n根据质量守恒原理，组织的耗氧速率（$\\mathrm{VO_2}$）必须等于输送至组织的氧气速率减去从组织返回的氧气速率。因此：\n$$ \\mathrm{VO_2} = (\\text{氧气输送速率}) - (\\text{氧气返回速率}) $$\n$$ \\mathrm{VO_2} = (Q \\times C_{\\mathrm{aO_2}}) - (Q \\times C_{\\mathrm{vO_2}}) $$\n\n为了推导心输出量 $Q$ 的表达式，我们可以从方程右侧提出公因子 $Q$：\n$$ \\mathrm{VO_2} = Q (C_{\\mathrm{aO_2}} - C_{\\mathrm{vO_2}}) $$\n该方程是 Fick 原理的数学表达式。\n\n分离出 $Q$ 即可得到所需的心输出量表达式：\n$$ Q = \\frac{\\mathrm{VO_2}}{C_{\\mathrm{aO_2}} - C_{\\mathrm{vO_2}}} $$\n\n现在，我们将给定的数值代入这个推导出的表达式中。\n给定的值为：\n$\\mathrm{VO_2} = 250$ $\\mathrm{mL}$ $\\mathrm{min}^{-1}$\n$C_{\\mathrm{aO_2}} = 190$ $\\mathrm{mL}$ $\\mathrm{L}^{-1}$\n$C_{\\mathrm{vO_2}} = 140$ $\\mathrm{mL}$ $\\mathrm{L}^{-1}$\n\n首先，我们计算动静脉血氧差：\n$$ C_{\\mathrm{aO_2}} - C_{\\mathrm{vO_2}} = 190 \\, \\mathrm{mL \\, L^{-1}} - 140 \\, \\mathrm{mL \\, L^{-1}} = 50 \\, \\mathrm{mL \\, L^{-1}} $$\n\n接下来，我们将这个差值和耗氧量代入 $Q$ 的表达式中：\n$$ Q = \\frac{250 \\, \\mathrm{mL \\, min^{-1}}}{50 \\, \\mathrm{mL \\, L^{-1}}} $$\n单位处理如下：\n$$ \\frac{\\mathrm{mL}}{\\mathrm{min}} \\div \\frac{\\mathrm{mL}}{\\mathrm{L}} = \\frac{\\mathrm{mL}}{\\mathrm{min}} \\times \\frac{\\mathrm{L}}{\\mathrm{mL}} = \\frac{\\mathrm{L}}{\\mathrm{min}} $$\n单位是一致的，并得出了心输出量所需的单位 $\\mathrm{L \\, min^{-1}}$。\n\n进行数值计算：\n$$ Q = \\frac{250}{50} \\, \\mathrm{L \\, min^{-1}} = 5 \\, \\mathrm{L \\, min^{-1}} $$\n\n问题要求最终答案四舍五入至三位有效数字。计算值 $5$ 必须表示为三位有效数字。\n$$ Q = 5.00 \\, \\mathrm{L \\, min^{-1}} $$\n该值代表了患者在静息状态下的心输出量，这是心血管功能的一个关键指标，在心肌炎可能损害心脏泵血能力的背景下尤其具有相关性。健康成年人的典型静息心输出量在 $4$ 到 $8$ $\\mathrm{L \\, min^{-1}}$ 的范围内，因此对于患有此种疾病的患者来说，计算出的值在生理上是合理的。", "answer": "$$\\boxed{5.00}$$", "id": "4412354"}]}