{"hands_on_practices": [{"introduction": "检测微小残留病（MRD）就像大海捞针。本练习旨在探讨发现稀有细胞所面临的基本统计学挑战。通过应用泊松分布这一稀有事件模型，您将量化分析的细胞总数如何直接影响检测到至少一个白血病细胞的概率，从而对MRD检测的灵敏度极限建立关键的理解。[@problem_id:4408089]", "problem": "在通过流式细胞术进行白血病微小残留病（MRD）监测时，临床问题是治疗后是否仍有任何残留的白血病细胞。假设血液或骨髓标本被充分混合，并且细胞由细胞仪独立取样。设真实的MRD细胞频率为 $p$，这意味着每个采集到的细胞是白血病细胞的概率为 $p$，且与其他细胞独立。采集的细胞事件总数为 $N$。在这些假设下，采集中观察到的MRD细胞计数可以被建模为一个稀有事件过程。\n\n请从基于概率和抽样的第一性原理出发，解释增加样本量和总采集事件数 $N$ 如何影响检测到至少一个MRD细胞的概率。您的解释应从独立伯努利抽样的定义和典型的稀有事件极限开始，并应证明为什么当 $p$ 很小且 $N$ 很大时，这个极限适用于流式细胞术的MRD检测。然后，在一个适用于稀有事件极限的泊松抽样模型下，计算当真实MRD频率为 $p = 10^{-5}$ 且仪器采集了 $N = 10^{6}$ 个总细胞时，观察到至少一个MRD细胞的概率。将您的最终概率四舍五入到 $5$ 位有效数字，并以无单位小数形式表示。", "solution": "该问题陈述经评估是科学上合理、表述清晰且客观的。它描述了概率论在一个现实世界生物医学问题——微小残留病（MRD）监测中的一个标准应用，使用了成熟的统计模型。所有必要的参数都已提供，可得唯一解。\n\n该问题要求解释样本量如何影响检测概率，并进行一次具体计算。解释将从独立伯努利试验的基础模型开始，到其在稀有事件极限下的泊松分布近似。\n\n设 $p$ 为标本中MRD细胞的真实频率。这代表任何单个被抽样的细胞是白血病细胞的概率。设 $N$ 为流式细胞仪采集和分析的总细胞数。我们假设细胞是独立抽样的。\n\n设 $K$ 为在大小为 $N$ 的样本中观察到的MRD细胞总数的随机变量。采集的 $N$ 个细胞中的每一个都可以被视为一次独立的伯努利试验，其中“成功”（观察到一个MRD细胞）发生的概率为 $p$。$N$ 次试验中的总成功次数 $K$ 服从二项分布，记作 $K \\sim \\text{Binomial}(N, p)$。\n\n二项分布的概率质量函数（PMF）给出了观察到恰好 $k$ 个MRD细胞的概率：\n$$P(K=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n\n临床问题是是否检测到*任何*残留细胞，这对应于事件 $K \\ge 1$。计算其互补事件 $K=0$（观察到零个MRD细胞）的概率，然后用 $1$ 减去该概率，在计算上更简单。\n使用二项分布的PMF，观察到零个MRD细胞的概率是：\n$$P(K=0) = \\binom{N}{0} p^0 (1-p)^{N-0} = (1-p)^N$$\n因此，检测到至少一个MRD细胞的精确概率是：\n$$P(K \\ge 1) = 1 - P(K=0) = 1 - (1-p)^N$$\n\n为了理解增加总采集事件数 $N$ 如何影响这个概率，我们来考察 $(1-p)^N$ 这一项。因为 $p$ 是一个概率，所以 $0  p  1$，这意味着 $0  (1-p)  1$。对于此范围内的底数，函数 $f(N) = (1-p)^N$ 是一个关于 $N$ 的严格递减函数。因此，随着 $N$ 的增加，$(1-p)^N$ 减小并趋近于 $0$。这意味着 $P(K \\ge 1) = 1 - (1-p)^N$ 随着 $N$ 严格增加，并趋近于 $1$。因此，如果疾病存在，增加样本量会提高检测到疾病的概率。\n\n问题陈述指出MRD监测涉及一个稀有事件过程，这为使用极限提供了理由。这指的是二项分布的泊松近似。当 $N$ 很大且 $p$ 很小时，该近似有效，此时它们的乘积 $\\lambda = Np$ 是一个有限的、大小适中的值。在MRD检测中，情况正是如此：白血病细胞的频率 $p$ 非常低（例如，$10^{-4}$ 到 $10^{-6}$），而分析的细胞数量 $N$ 非常大（例如，$10^5$ 到 $10^7$）。乘积 $\\lambda = Np$ 代表样本中MRD细胞的期望数。\n\n为了从第一性原理推导这个极限，我们从二项分布的PMF开始，在保持 $\\lambda=Np$ 恒定的同时，取 $N \\to \\infty$ 和 $p \\to 0$ 的极限。\n$$P(K=k) = \\frac{N!}{k!(N-k)!} p^k (1-p)^{N-k}$$\n代入 $p = \\lambda/N$：\n$$P(K=k) = \\frac{N(N-1)\\cdots(N-k+1)}{k!} \\left(\\frac{\\lambda}{N}\\right)^k \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n整理各项：\n$$P(K=k) = \\frac{\\lambda^k}{k!} \\left(\\frac{N}{N} \\cdot \\frac{N-1}{N} \\cdots \\frac{N-k+1}{N}\\right) \\left(1-\\frac{\\lambda}{N}\\right)^N \\left(1-\\frac{\\lambda}{N}\\right)^{-k}$$\n现在我们评估当 $N \\to \\infty$ 时每一部分的极限：\n1. 乘积 $\\left(1 \\cdot \\left(1-\\frac{1}{N}\\right) \\cdots \\left(1-\\frac{k-1}{N}\\right)\\right) \\to 1$，因为 $k$ 是一个固定的有限数。\n2. 项 $\\left(1-\\frac{\\lambda}{N}\\right)^N \\to \\exp(-\\lambda)$，这源于指数函数的基本极限定义。\n3. 项 $\\left(1-\\frac{\\lambda}{N}\\right)^{-k} \\to (1-0)^{-k} = 1$。\n\n结合这些结果，二项概率收敛于泊松概率：\n$$\\lim_{N\\to\\infty, p\\to 0, Np=\\lambda} P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n这是均值为 $\\lambda$ 的泊松分布的PMF。因此，在指定条件下，MRD细胞的计数 $K$ 可以被建模为 $K \\sim \\text{Poisson}(\\lambda=Np)$。\n\n使用这个泊松模型，我们可以再次计算检测到至少一个MRD细胞的概率。\n$$P(K \\ge 1) = 1 - P(K=0)$$\n对于泊松分布，零事件的概率是：\n$$P(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n因此，检测概率为：\n$$P(K \\ge 1) = 1 - \\exp(-\\lambda) = 1 - \\exp(-Np)$$\n这个表达式再次表明，随着 $N$ 的增加，指数 $-Np$ 变得更负，$\\exp(-Np)$ 减小，而检测概率 $1 - \\exp(-Np)$ 增加，这证实了更大样本采集量能提高检测灵敏度的原理。\n\n我们被要求在真实MRD频率为 $p = 10^{-5}$ 且仪器采集了 $N = 10^6$ 个总细胞的特定情况下计算这个概率。\n\n首先，我们计算泊松参数 $\\lambda$：\n$$\\lambda = Np = (10^6)(10^{-5}) = 10$$\n这个值代表样本中MRD细胞的期望数。\n\n接下来，我们使用泊松近似计算观察到至少一个MRD细胞的概率：\n$$P(K \\ge 1) = 1 - \\exp(-\\lambda) = 1 - \\exp(-10)$$\n现在，我们计算数值：\n$$\\exp(-10) \\approx 0.00004539992976$$\n$$P(K \\ge 1) \\approx 1 - 0.00004539992976 = 0.99995460007023$$\n问题要求将最终概率四舍五入到 $5$ 位有效数字。前五位有效数字是 $9$、$9$、$9$、$9$ 和 $5$。随后的数字是 $4$，小于 $5$，因此我们不对第五位数字进行进位。\n最终概率是 $0.99995$。", "answer": "$$\\boxed{0.99995}$$", "id": "4408089"}, {"introduction": "一项统计学上强大的检测，其准确性取决于所分析样本的质量。在骨髓穿刺抽吸中，样本被外周血污染（即血液稀释现象）是一个常见问题，可能导致MRD结果假性偏低或假阴性。本练习将指导您对这种稀释效应进行建模，揭示分析前因素如何显著改变MRD测量的定量准确性。[@problem_id:4408082]", "problem": "为通过多参数流式细胞术（MFC）监测微小残留病（MRD），从一名急性淋巴细胞白血病患者身上获取了一份骨髓抽吸物。在骨髓抽吸过程中，第一次抽吸的样本富含骨髓颗粒，而随后的抽吸物会逐渐被外周血稀释。假设存在以下科学上合理且内部一致的情景。\n\n- 第一次抽吸的样本代表纯骨髓，其中有核细胞中真正的白血病细胞分数（即MRD）为 $f_{\\mathrm{marrow}} = 0.0037$。\n- 用于MRD分析的第二次抽吸样本是骨髓和外周血的混合物，其体积比为 $1\\!:\\!4$（一份骨髓对四份外周血）。\n- 骨髓中的有核细胞浓度为 $C_{\\mathrm{marrow}} = 40 \\times 10^{6}$ 细胞/毫升，外周血中的有核细胞（白细胞）浓度为 $C_{\\mathrm{blood}} = 5 \\times 10^{6}$ 细胞/毫升。\n- 在此时间点，外周血中检测不到白血病原始细胞；假设 $f_{\\mathrm{blood}} = 0$。\n\n仅使用MRD的定义（白血病细胞在总有核细胞中的分数）和混合时细胞计数守恒的原理，通过推导混合样本（第二次抽吸）中预期的MRD测量分数，来模拟血液稀释效应。然后，根据上述参数计算其数值。将最终结果四舍五入至四位有效数字，并以小数形式表示（不要使用百分号）。", "solution": "我们将使用的基本定义和事实是：\n\n- 通过流式细胞术检测的微小残留病（MRD）定义为白血病细胞在总有核细胞中所占的分数，我们将其表示为 $f = \\dfrac{\\text{leukemic nucleated cells}}{\\text{total nucleated cells}}$。\n- 在混合物中，每种类型细胞的总数是各组分贡献之和，这反映了细胞计数的守恒。\n\n设 $V_{\\mathrm{marrow}}$ 和 $V_{\\mathrm{blood}}$ 分别表示构成第二次抽吸样本的骨髓和外周血的体积。题目说明体积比为 $1\\!:\\!4$，因此我们可以设定 $V_{\\mathrm{marrow}} = 1$（任意体积单位）和 $V_{\\mathrm{blood}} = 4$（相同单位）。设 $C_{\\mathrm{marrow}}$ 和 $C_{\\mathrm{blood}}$ 分别为骨髓和血液中的有核细胞浓度（单位体积内的细胞数）。设 $f_{\\mathrm{marrow}}$ 和 $f_{\\mathrm{blood}}$ 分别为骨髓和血液中有核细胞中的白血病细胞分数。\n\n混合的第二次抽吸样本中白血病有核细胞的数量为\n$$\nL = f_{\\mathrm{marrow}} \\, C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; f_{\\mathrm{blood}} \\, C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}.\n$$\n混合样本中有核细胞的总数为\n$$\nT = C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}.\n$$\n因此，根据MRD作为分数的定义，\n$$\nf_{\\mathrm{measured}} \\;=\\; \\frac{L}{T} \\;=\\; \\frac{f_{\\mathrm{marrow}} \\, C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; f_{\\mathrm{blood}} \\, C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}.\n$$\n\n在本例中，题目说明 $f_{\\mathrm{blood}} = 0$，因此表达式简化为\n$$\nf_{\\mathrm{measured}} \\;=\\; f_{\\mathrm{marrow}} \\, \\frac{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}}}{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}.\n$$\n\n现在代入给定的数值：\n- $f_{\\mathrm{marrow}} = 0.0037$，\n- $C_{\\mathrm{marrow}} = 40 \\times 10^{6}$ 细胞/毫升，\n- $C_{\\mathrm{blood}} = 5 \\times 10^{6}$ 细胞/毫升，\n- $V_{\\mathrm{marrow}} = 1$，\n- $V_{\\mathrm{blood}} = 4$。\n\n计算由骨髓有核细胞贡献的稀释因子：\n$$\n\\frac{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}}}{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} + C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}\n\\;=\\;\n\\frac{\\left(40 \\times 10^{6}\\right)\\cdot 1}{\\left(40 \\times 10^{6}\\right)\\cdot 1 + \\left(5 \\times 10^{6}\\right)\\cdot 4}\n\\;=\\;\n\\frac{40}{40 + 20}\n\\;=\\;\n\\frac{2}{3}.\n$$\n\n因此，\n$$\nf_{\\mathrm{measured}} \\;=\\; 0.0037 \\times \\frac{2}{3} \\;=\\; 0.0024666\\ldots\n$$\n四舍五入到四位有效数字并以小数形式表示（不加百分号），结果是\n$$\n0.002467.\n$$", "answer": "$$\\boxed{0.002467}$$", "id": "4408082"}, {"introduction": "收到阳性或阴性的MRD检测结果是一个关键时刻，但其真正含义取决于检测的性能特征和患者的先验风险。本练习通过应用贝叶斯定理计算阳性预测值（PPV）和阴性预测值（NPV），深入探讨了诊断解读的核心。您将学习如何将检测的灵敏度和特异性转化为具有临床意义的复发概率，这是循证决策的一项关键技能。[@problem_id:4408098]", "problem": "一家血液病理学实验室采用多参数流式细胞术检测法，对急性白血病患者在诱导化疗后随访期间的微小残留病（MRD）进行监测。为了在十二个月的固定时间范围内进行预后分类，根据临床结局将患者分为复发或不复发两类。当检测到残留的白血病原始细胞时，MRD检测结果为阳性；未检测到时，结果为阴性。在此时间范围内，该检测法对复发分类的灵敏度为 $0.95$，对不复发分类的特异度为 $0.99$。受监测队列最终复发的检验前概率为 $0.20$。\n\n请仅使用灵敏度、特异度、阳性预测值（PPV）和阴性预测值（NPV）的基本概率定义，从基本原理出发，推导PPV和NPV关于灵敏度、特异度和检验前复发概率的表达式。然后，在给定灵敏度为 $0.95$、特异度为 $0.99$、检验前复发概率为 $0.20$ 的条件下，计算此MRD检测法的PPV和NPV。\n\n将PPV和NPV以小数形式表示，并各四舍五入到四位有效数字。您的最终答案必须是一个单独的有序对，以行矩阵的形式写出，按顺序包含PPV和NPV，不带单位。", "solution": "此问题具有科学依据，提法明确且客观。所有必要数据均已提供，且与概率论和医学诊断学的既定原则一致。我现在开始解答。\n\n我们定义以下事件：\n$R$: 患者在十二个月的时间范围内会复发。\n$R^c$: 患者在十二个月的时间范围内不会复发。\n$T^+$: MRD检测结果为阳性。\n$T^-$: MRD检测结果为阴性。\n\n问题陈述中提供的信息可以转化为概率术语：\n复发的检验前概率，或称患病率，为 $P(R) = 0.20$。\n因此，不复发的概率为 $P(R^c) = 1 - P(R) = 1 - 0.20 = 0.80$。\n该检测的灵敏度是指在患者将复发的情况下，检测结果为阳性的概率：$P(T^+ | R) = 0.95$。\n该检测的特异度是指在患者不会复发的情况下，检测结果为阴性的概率：$P(T^- | R^c) = 0.99$。\n\n从这些定义中，我们还可以确定互补事件的概率：\n假阴性（即对将复发的患者检测结果为阴性）的概率是 $P(T^- | R) = 1 - P(T^+ | R) = 1 - 0.95 = 0.05$。\n假阳性（即对不会复发的患者检测结果为阳性）的概率是 $P(T^+ | R^c) = 1 - P(T^- | R^c) = 1 - 0.99 = 0.01$。\n\n需要推导和计算的量是：\n阳性预测值 (PPV): 在检测结果为阳性的情况下，患者将复发的概率，即 $PPV = P(R | T^+)$。\n阴性预测值 (NPV): 在检测结果为阴性的情况下，患者不会复发的概率，即 $NPV = P(R^c | T^-)$。\n\n我们将从基本原理（即条件概率的基本定义和全概率定律）出发推导PPV和NPV的表达式。这种方法等同于应用贝叶斯定理。\n\n阳性预测值 (PPV) 的推导：\n根据条件概率的定义，\n$$ PPV = P(R | T^+) = \\frac{P(R \\cap T^+)}{P(T^+)} $$\n分子 $P(R \\cap T^+)$ 是复发和阳性检测结果的联合概率。它可以使用条件概率的定义表示为 $P(R \\cap T^+) = P(T^+ | R) P(R)$。该项代表真阳性。\n分母 $P(T^+)$ 是阳性检测结果的全概率。使用全概率定律，我们可以通过对所有可能的疾病状态（复发或不复发）求和来表示它：\n$$ P(T^+) = P(T^+ \\cap R) + P(T^+ \\cap R^c) $$\n$$ P(T^+) = P(T^+|R)P(R) + P(T^+|R^c)P(R^c) $$\n第一项是真阳性的概率，第二项是假阳性的概率。\n将这些表达式代回PPV的公式，我们得到：\n$$ PPV = \\frac{P(T^+|R)P(R)}{P(T^+|R)P(R) + P(T^+|R^c)P(R^c)} $$\n用灵敏度 ($S_e$)、特异度 ($S_p$) 和检验前概率 ($P_{pre}$) 表示：\n$$ PPV = \\frac{S_e \\cdot P_{pre}}{S_e \\cdot P_{pre} + (1 - S_p) \\cdot (1 - P_{pre})} $$\n\n阴性预测值 (NPV) 的推导：\n根据条件概率的定义，\n$$ NPV = P(R^c | T^-) = \\frac{P(R^c \\cap T^-)}{P(T^-)} $$\n分子 $P(R^c \\cap T^-)$ 是不复发和阴性检测结果的联合概率，可以表示为 $P(R^c \\cap T^-) = P(T^- | R^c) P(R^c)$。该项代表真阴性。\n分母 $P(T^-)$ 是阴性检测结果的全概率。使用全概率定律：\n$$ P(T^-) = P(T^- \\cap R^c) + P(T^- \\cap R) $$\n$$ P(T^-) = P(T^-|R^c)P(R^c) + P(T^-|R)P(R) $$\n第一项是真阴性的概率，第二项是假阴性的概率。\n将这些表达式代回NPV的公式，我们得到：\n$$ NPV = \\frac{P(T^-|R^c)P(R^c)}{P(T^-|R^c)P(R^c) + P(T^-|R)P(R)} $$\n用灵敏度 ($S_e$)、特异度 ($S_p$) 和检验前概率 ($P_{pre}$) 表示：\n$$ NPV = \\frac{S_p \\cdot (1 - P_{pre})}{S_p \\cdot (1 - P_{pre}) + (1 - S_e) \\cdot P_{pre}} $$\n\n现在，我们使用给定的数据计算数值：\n$S_e = 0.95$\n$S_p = 0.99$\n$P_{pre} = P(R) = 0.20$\n$1 - P_{pre} = P(R^c) = 0.80$\n$1 - S_e = 0.05$\n$1 - S_p = 0.01$\n\nPPV的计算：\n$$ PPV = \\frac{(0.95) \\cdot (0.20)}{(0.95) \\cdot (0.20) + (1 - 0.99) \\cdot (1 - 0.20)} $$\n$$ PPV = \\frac{0.19}{0.19 + (0.01) \\cdot (0.80)} $$\n$$ PPV = \\frac{0.19}{0.19 + 0.008} $$\n$$ PPV = \\frac{0.19}{0.198} \\approx 0.959595... $$\n四舍五入到四位有效数字，$PPV = 0.9596$。\n\nNPV的计算：\n$$ NPV = \\frac{(0.99) \\cdot (1 - 0.20)}{(0.99) \\cdot (1 - 0.20) + (1 - 0.95) \\cdot (0.20)} $$\n$$ NPV = \\frac{(0.99) \\cdot (0.80)}{(0.99) \\cdot (0.80) + (0.05) \\cdot (0.20)} $$\n$$ NPV = \\frac{0.792}{0.792 + 0.01} $$\n$$ NPV = \\frac{0.792}{0.802} \\approx 0.987531... $$\n四舍五入到四位有效数字，$NPV = 0.9875$。\n\n计算出的PPV和NPV值分别为 $0.9596$ 和 $0.9875$。", "answer": "$$ \\boxed{\\begin{pmatrix} 0.9596  0.9875 \\end{pmatrix}} $$", "id": "4408098"}]}