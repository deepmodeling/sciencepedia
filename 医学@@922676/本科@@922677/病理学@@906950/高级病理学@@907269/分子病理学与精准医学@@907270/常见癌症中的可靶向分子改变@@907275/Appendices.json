{"hands_on_practices": [{"introduction": "在靶向治疗时代，准确评估基因扩增状态至关重要，荧光原位杂交（FISH）是检测像HER2这样的关键癌基因拷贝数变异的金标准技术之一。本练习将指导您完成一个核心的病理学任务：根据原始信号计数计算HER2/CEP17比率和平均HER2拷贝数，并依据美国临床肿瘤学会/美国病理学家学会（ASCO/CAP）的指南对病例进行分类。通过这个实践[@problem_id:4314087]，您将学会如何将定量数据转化为临床上可操作的分类，这是现代分子病理学的一项基本技能。", "problem": "对一例浸润性癌进行了一项针对人表皮生长因子受体2 (HER2) 的双探针荧光原位杂交 (FISH) 检测。根据标准的美国临床肿瘤学会/美国病理学家学会 (ASCO/CAP) 双探针原位杂交 (ISH) 方法学，HER2/CEP17 比值定义为在同一组细胞核中计算出的每个细胞核的平均HER2信号数与每个细胞核的平均17号染色体计数探针 (CEP17) 信号数的比值。总共对 20 个浸润性肿瘤细胞核进行了评分，在这 20 个细胞核中总共得到 112 个HER2信号和 58 个CEP17信号。\n\n仅使用上述核心定义和广泛接受的双探針HER2 ISH分组指南类别，完成以下任务：\n\n1. 根据双探针ISH方法学的定义，由这些计数计算HER2/CEP17比值。\n2. 计算每个细胞核的平均HER2基因拷贝数。\n3. 仅根据计算出的HER2/CEP17比值和平均HER2拷贝数，将该病例归入相应的ASCO/CAP双探针HER2 ISH组别（从 1 到 5），不使用免疫组织化学方法。\n\n报告HER2/CEP17比值和平均HER2拷贝数，保留三位有效数字。对于分组，请将指南阈值应用于精确（未四舍五入）的计算值。您提供的最终答案必须是仅等于ISH组别号的单个整数（没有文字、没有单位、没有附加符号）。", "solution": "评估问题的有效性。\n\n**步骤1：提取已知条件**\n- 检测：针对人表皮生长因子受体2 (HER2) 的双探针荧光原位杂交 (FISH)。\n- 方法学：美国临床肿瘤学会/美国病理学家学会 (ASCO/CAP) 双探针原位杂交 (ISH)。\n- HER2/CEP17 比值定义：每个细胞核的平均HER2信号数与每个细胞核的平均17号染色体计数探针 (CEP17) 信号数的比值。\n- 计数的细胞核数量, $N$: 20。\n- 所有计数细胞核中的总HER2信号数, $S_{HER2}$: 112。\n- 所有计数细胞核中的总CEP17信号数, $S_{CEP17}$: 58。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题描述了一项标准的、经过验证的临床实验室检测（HER2 FISH），该检测用于肿瘤学，特别是乳腺癌和胃食管癌。参数（$HER2$ 基因、17号染色体着丝粒探针 $CEP17$、细胞核数量、信号计数）以及ASCO/CAP指南是现代病理学实践中既定且符合事实的组成部分。\n- **定义明确：** 提供了计算所需的所有数据。定义是明确的。问题要求基于“广泛接受的指南类别”进行分类，这指的是已发布的、有数值定义的ASCO/CAP标准。这使得分类明確无误。\n- **客观性：** 该问题使用精确、客观和技术性的语言陈述，不含主观或基于意见的内容。\n\n**步骤3：结论与行动**\n该问题科学合理、定义明确且客观。判定为**有效**。将提供解答。\n\n解答过程首先根据所提供的数据计算必要的指标，然后应用标准的ASCO/CAP分类标准。\n\n**1. 计算每个细胞核的平均HER2基因拷贝数**\n设 $\\bar{N}_{HER2}$ 表示每个细胞核的平均HER2信号数。其计算方法是用总HER2信号数除以计数的细胞核总数。\n$$ \\bar{N}_{HER2} = \\frac{\\text{总HER2信号数}}{\\text{计数的细胞核数量}} = \\frac{S_{HER2}}{N} $$\n代入给定值：\n$$ \\bar{N}_{HER2} = \\frac{112}{20} = 5.6 $$\n每个细胞核的平均HER2基因拷贝数恰好为 $5.6$。保留三位有效数字，结果为 $5.60$。\n\n**2. 计算每个细胞核的平均CEP17信号数**\n设 $\\bar{N}_{CEP17}$ 表示每个细胞核的平均CEP17信号数。其计算方法是用总CEP17信号数除以计数的细胞核总数。\n$$ \\bar{N}_{CEP17} = \\frac{\\text{总CEP17信号数}}{\\text{计数的细胞核数量}} = \\frac{S_{CEP17}}{N} $$\n代入给定值：\n$$ \\bar{N}_{CEP17} = \\frac{58}{20} = 2.9 $$\n\n**3. 计算HER2/CEP17比值**\nHER2/CEP17比值，记为 $R$，定义为平均HER2信号数与平均CEP17信号数的比值。\n$$ R = \\frac{\\bar{N}_{HER2}}{\\bar{N}_{CEP17}} $$\n使用计算出的平均值：\n$$ R = \\frac{5.6}{2.9} = \\frac{112/20}{58/20} = \\frac{112}{58} \\approx 1.931034... $$\nHER2/CEP17比值，保留三位有效数字，为 $1.93$。\n\n**4. 基于ASCO/CAP 2018年双探针ISH指南的分类**\n问题要求仅根据ISH结果将病例分为五个ISH组别之一，不考虑同期的免疫组织化学 (IHC) 结果。分类使用 $\\bar{N}_{HER2}$ 和 $R$ 的精确（未四舍五入）计算值。2018年ASCO/CAP指南对各组的定义如下：\n\n- **第1组 (阳性):** $R \\ge 2.0$ 且 $\\bar{N}_{HER2} \\ge 4.0$\n- **第2组 (阳性):** $R \\ge 2.0$ 且 $\\bar{N}_{HER2}  4.0$\n- **第3组 (阳性):** $R  2.0$ 且 $\\bar{N}_{HER2} \\ge 6.0$\n- **第4组 (不确定):** $R  2.0$ 且 $4.0 \\le \\bar{N}_{HER2}  6.0$\n- **第5组 (阴性):** $R  2.0$ 且 $\\bar{N}_{HER2}  4.0$\n\n现在我们将计算值与这些标准进行对照：\n- 计算出的 $\\bar{N}_{HER2} = 5.6$\n- 计算出的 $R = \\frac{112}{58} \\approx 1.931$\n\n我们评估每个组的条件：\n- **第1组：** 条件 $R \\ge 2.0$ 未满足，因为 $1.931  2.0$。\n- **第2组：** 条件 $R \\ge 2.0$ 未满足。\n- **第3组：** 条件 $R  2.0$ 满足。然而，条件 $\\bar{N}_{HER2} \\ge 6.0$ 未满足，因为 $5.6  6.0$。\n- **第4组：** 条件 $R  2.0$ 满足 ($1.931  2.0$)。条件 $4.0 \\le \\bar{N}_{HER2}  6.0$ 也满足，因为 $4.0 \\le 5.6  6.0$。第 $4$ 组的两个条件都得到满足。\n- **第5组：** 条件 $R  2.0$ 满足。然而，条件 $\\bar{N}_{HER2}  4.0$ 未满足，因为 $5.6 > 4.0$。\n\n基于对指南的严格应用，该病例属于第4组。在临床上，第4组（不确定）的结果会促使进行额外的检查，例如进行IHC或扩大细胞核计数范围重新计数，但基于初始数据的分类明确为第4组。该问题只要求进行此初始分类。\n\n最终要求的答案是代表ISH组别的整数。", "answer": "$$\\boxed{4}$$", "id": "4314087"}, {"introduction": "新一代测序（NGS）产生的变异等位基因频率（VAF）是一个强大的指标，但它反映的是肿瘤细胞和正常细胞混合样本的平均信号。为了揭示真实的肿瘤生物学特性，我们必须利用肿瘤纯度等信息来“解构”VAF，以推断突变在癌细胞群体中的真实分布情况。在这个练习[@problem_id:4314141]中，您将通过一个关于胶质瘤中IDH1突变的典型临床场景，推导出并计算携带特定突变的肿瘤细胞比例，从而深入理解克隆性这一核心概念。", "problem": "一份弥漫性胶质瘤样本通过新一代测序 (NGS) 进行了分析。观察到异柠檬酸脱氢酶 1 (IDH1) p.R132H 替代的变异等位基因频率 (VAF) 为 $v=0.32$。组织病理学和计算解卷积估计肿瘤纯度为 $p=0.80$，意味着样本中 $0.80$ 的有核细胞是肿瘤细胞。拷贝数分析显示，IDH1 基因座位于一个拷贝数中性的二倍体片段中，没有杂合性丢失 (LOH)，因此肿瘤细胞中的总拷贝数为 $2$，正常细胞为二倍体。在胶质瘤中，携带 IDH1 p.R132H 突变的细胞通常是杂合的。\n\n从 VAF 的明确定义（即肿瘤和正常细胞混合群体中突变等位基因计数与总等位基因计数的比率）和给定的拷贝数状态出发，推导出一个表达式，用于表示携带杂合 IDH1 p.R132H 突变的肿瘤细胞的比例 $f$。然后，使用提供的 $v$ 和 $p$ 值计算 $f$。将最终数值答案表示为保留三位有效数字的小数。不需要单位。", "solution": "问题要求我们基于观察到的变异等位基因频率 ($v$) 和肿瘤纯度 ($p$)，推导携带杂合突变的肿瘤细胞比例 $f$ 的表达式，然后计算其值。\n\n我们首先精确定义所涉及的量。变异等位基因频率 $v$ 定义为对应于突变等位基因的测序读数数量与覆盖该基因组位点的总读数数量的比率。在一个理想化的模型中，这对应于细胞样本中突变等位基因数量与总等位基因数量的比率。\n$$v = \\frac{\\text{突变等位基因数}}{\\text{总等位基因数}}$$\n\n设 $N$ 为样本中有核细胞的总数。该样本是肿瘤细胞和非肿瘤（正常）细胞的混合物。\n肿瘤纯度 $p$ 被定义为肿瘤细胞在有核细胞中所占的比例。\n- 肿瘤细胞数, $N_T = pN$\n- 正常细胞数, $N_N = (1-p)N$\n\n问题指出，对于肿瘤细胞和正常细胞，IDH1 基因座都位于一个拷贝数中性的二倍体片段中。这意味着样本中的每个细胞都含有恰好 $2$ 个 IDH1 基因座的拷贝。\n因此，整个样本中的总等位基因数是：\n$$N_{\\text{total_alleles}} = 2 \\times N_T + 2 \\times N_N = 2(pN) + 2(1-p)N = 2pN + 2N - 2pN = 2N$$\n\n接下来，我们确定突变等位基因的数量。该突变是 IDH1 p.R132H 替代。\n- 正常细胞 ($N_N$) 不携带该突变。它们在该基因座上是遗传野生型的。因此，正常细胞群体中的突变等位基因数为 $0$。\n- 肿瘤细胞群体 ($N_T$) 本身是一个混合体。设 $f$ 为携带该突变的肿瘤细胞的比例。\n  - 发生突变的肿瘤细胞数为 $f \\times N_T = f p N$。问题指出，在携带此突变的细胞中，该突变是杂合的。这意味着每个突变细胞含有 $1$ 个突变等位基因和 $1$ 个野生型等位基因。\n  - 未发生突变的肿瘤细胞数为 $(1-f) \\times N_T = (1-f) p N$。这些细胞含有 $2$ 个野生型等位基因和 $0$ 个突变等位基因。\n\n样本中突变等位基因的总数 $N_{\\text{mutant_alleles}}$ 完全由发生突变的肿瘤细胞贡献。\n$$N_{\\text{mutant_alleles}} = (\\text{突变肿瘤细胞数}) \\times (\\text{每个突变细胞的突变等位基因数})$$\n$$N_{\\text{mutant_alleles}} = (f p N) \\times 1 = fpN$$\n\n现在，我们可以将突变等位基因数和总等位基因数的表达式代入 VAF 的定义中：\n$$v = \\frac{N_{\\text{mutant_alleles}}}{N_{\\text{total_alleles}}} = \\frac{fpN}{2N}$$\n\n总细胞数 $N$ 在分子和分母中被消去，从而得出 $v$、$f$ 和 $p$ 之间的关系：\n$$v = \\frac{fp}{2}$$\n\n问题的第一部分要求得出 $f$ 的表达式。我们可以重新整理上述方程以解出 $f$：\n$$2v = fp$$\n$$f = \\frac{2v}{p}$$\n这就是推导出的携带杂合突变的肿瘤细胞比例的表达式。\n\n问题的第二部分是使用所提供的数据计算 $f$ 的值：$v = 0.32$ 和 $p = 0.80$。\n将这些值代入我们推导出的公式中：\n$$f = \\frac{2 \\times 0.32}{0.80}$$\n$$f = \\frac{0.64}{0.80}$$\n$$f = 0.8$$\n\n问题要求最终答案表示为保留三位有效数字的小数。\n$$f = 0.800$$\n这个结果表明，样本中估计有 $80.0\\%$ 的肿瘤细胞携带杂合的 IDH1 p.R132H 突变。", "answer": "$$\\boxed{0.800}$$", "id": "4314141"}, {"introduction": "癌症在治疗压力下是一个动态演化的系统，耐药亚克隆的出现和生长是靶向治疗失败的主要原因。通过建立数学模型，我们可以模拟药物敏感细胞和耐药细胞之间的竞争，从而预测耐药性何时会成为主导。本练习[@problem_id:4314128]要求您应用指数增长模型，通过编程计算在不同临床情境下，从治疗开始到耐药亚克隆占据主导地位所需的时间，将分子病理学的概念与计算生物学方法相结合。", "problem": "一家精准肿瘤学实验室正在对具有可靶向分子改变的实体瘤和血液系统恶性肿瘤进行靶向治疗期间，药物敏感亚克隆与药物抵抗亚克隆之间的竞争进行建模。假设以下基本前提：对于在相关时间窗口内处于恒定治疗压力下的每个亚克隆，其克隆群体大小遵循由常微分方程 $dX/dt = r X$ 定义的指数定律，其中 $X$ 是群体大小，$r$ 是人均净增长率。令 $S(t)$ 表示敏感亚克隆的大小，$R(t)$ 表示抵抗亚克隆的大小，其初始大小分别为 $S(0) = S_{0}$ 和 $R(0) = R_{0}$。假设 $S(t) = S_{0} e^{r_{S} t}$ 且 $R(t) = R_{0} e^{r_{R} t}$，其中 $r_{S}$ 和 $r_{R}$ 是由治疗和生物学决定的常数。在实践中，只需要初始比例，因为任何共同的初始总量在比率中都会被抵消；因此定义 $f_{S0} = S_{0}/(S_{0}+R_{0})$ 和 $f_{R0} = R_{0}/(S_{0}+R_{0})$，且 $f_{S0} + f_{R0} = 1$。将“抵抗性优势”定义为满足 $R(t) \\ge S(t)$ 的最早时间 $t \\ge 0$。您的任务是实现一个程序，根据 $(f_{R0}, f_{S0}, r_{R}, r_{S})$ 计算达到抵抗性优势的时间。如果根据给定的初始条件和增长率，在数学上不可能达到优势（例如，当 $f_{R0}  f_{S0}$ 时，$f_{R0} = 0$ 或 $r_{R} \\le r_{S}$），程序必须返回一个哨兵值。所有时间必须以天为单位表示，并四舍五入到三位小数。如果不可能达到优势，则输出哨兵值 $-1.000$。\n\n使用以下测试用例套件，每个用例对应一个涉及可靶向分子改变的临床情景。参数以 $(f_{R0}, f_{S0}, r_{R}, r_{S})$ 的形式提供，其中所有增长率均以“每天”为单位：\n\n- 案例1（接受第一代EGFR酪氨酸激酶抑制剂治疗的表皮生长因子受体（EGFR）L858R肺腺癌；抵抗性亚克隆为EGFR T790M）：$(0.01, 0.99, 0.01, -0.02)$。\n- 案例2（接受imatinib治疗的断裂点簇集区-ABL激酶（BCR-ABL）慢性粒细胞白血病；抵抗性亚克隆为T315I）：$(0.001, 0.999, 0.02, -0.05)$。\n- 案例3（接受基于trastuzumab的治疗的人类表皮生长因子受体2（HER2）扩增乳腺癌；抵抗性亚克隆携带磷脂酰肌醇-4,5-二磷酸3-激酶催化亚基α（PIK3CA）突变）：$(0.05, 0.95, 0.005, -0.03)$。\n- 案例4（接受BRAF抑制剂治疗的v-Raf鼠类肉瘤病毒癌基因同源体B1（BRAF）V600E黑色素瘤；抵抗性亚克隆获得神经母细胞瘤RAS病毒癌基因同源体（NRAS）Q61突变）：$(0.02, 0.98, 0.015, -0.04)$。\n- 案例5（结直肠癌中的抗EGFR治疗，预先存在Kirsten大鼠肉瘤病毒癌基因同源体（KRAS）突变亚克隆；治疗下净增长率相等的边界条件）：$(0.2, 0.8, -0.01, -0.01)$。\n- 案例6（IDH1突变型神经胶质瘤中的异柠檬酸脱氢酶1（IDH1）抑制剂，基线时无可检测到的抵抗性种子）：$(0.0, 1.0, 0.005, -0.01)$。\n- 案例7（EGFR突变型肺腺癌，基线时已存在占优势的EGFR T790M抵抗性亚克隆）：$(0.6, 0.4, 0.01, -0.02)$。\n\n要求和约束：\n- 输入隐含在上述测试套件中；无需用户输入。\n- 对于每个案例，计算满足 $R(t) \\ge S(t)$ 的最早时间 $t$（以天为单位），并四舍五入到三位小数。\n- 如果在所述假设和参数下不可能达到抵抗性优势，则为该案例输出 $-1.000$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_{1},x_{2},\\dots]$），每个条目按所列顺序对应于相应案例的结果。\n\n交付成果：\n- 一个单一程序，该程序计算所有案例所需的时间，并以上述确切的最终输出格式打印它们。", "solution": "该问题要求确定药物抵抗性癌症亚克隆群体 $R(t)$ 大于或等于药物敏感性亚克隆群体 $S(t)$ 的最早时间 $t \\ge 0$。这个时间点被定义为“抵抗性优势”点。\n\n敏感亚克隆和抵抗性亚克隆的群体遵循指数增长定律：\n$$S(t) = S_{0} e^{r_{S} t}$$\n$$R(t) = R_{0} e^{r_{R} t}$$\n其中 $S_0$ 和 $R_0$ 是 $t=0$ 时的初始群体大小，$r_S$ 和 $r_R$ 是治疗下各自的人均净增长率。\n\n抵抗性优势在满足以下不等式的最早时间 $t \\ge 0$ 时实现：\n$$R(t) \\ge S(t)$$\n将群体模型代入此不等式可得：\n$$R_{0} e^{r_{R} t} \\ge S_{0} e^{r_{S} t}$$\n初始群体大小可以用初始比例 $f_{R0} = R_{0}/(S_{0}+R_{0})$ 和 $f_{S0} = S_{0}/(S_{0}+R_{0})$ 来表示。比率 $S_0/R_0$ 等同于 $f_{S0}/f_{R0}$。现在我们根据初始条件和增长率参数来分析这个不等式。\n\n**情况1：初始即为优势**\n如果抵抗性亚克隆在基线时（$t=0$）已经占优势或大小相等，那么 $R_0 \\ge S_0$。这对应于初始抵抗性比例 $f_{R0} \\ge 0.5$。在这种情况下，达到优势的条件在可能的最早时间，即 $t=0$ 时满足。\n\n**情况2：基线时无抵抗性亚克隆**\n如果最初没有抵抗性亚克隆，那么 $R_0 = 0$（因此 $f_{R0} = 0$）。群体 $R(t)$ 将在所有时间 $t$ 内保持为 0。假设 $S_0 > 0$（即 $f_{S0} > 0$），则条件 $R(t) \\ge S(t)$ 永远无法满足。因此，不可能达到优势。\n\n**情况3：基线时抵抗性亚克隆非优势**\n这是最一般的情况，其中 $0  R_0  S_0$（意味着 $0  f_{R0}  0.5$）。为了解出 $t$，我们对不等式进行变换。由于 $S_0$ 和 $R_0$ 均为正数，我们可以无歧义地重新排列各项：\n$$\\frac{e^{r_{R} t}}{e^{r_{S} t}} \\ge \\frac{S_{0}}{R_{0}}$$\n$$e^{(r_{R} - r_{S})t} \\ge \\frac{S_{0}}{R_{0}}$$\n对两边取自然对数，由于自然对数是单调递增函数，不等式得以保持：\n$$\\ln(e^{(r_{R} - r_{S})t}) \\ge \\ln\\left(\\frac{S_{0}}{R_{0}}\\right)$$\n$$(r_{R} - r_{S})t \\ge \\ln\\left(\\frac{S_{0}}{R_{0}}\\right)$$\n$t$ 的解现在取决于差异增长率 $\\Delta r = r_R - r_S$ 的符号。\n\n**子情况3a：正差异增长（$r_R > r_S$）**\n如果抵抗性亚克隆具有增长优势（$r_R - r_S > 0$），我们可以用这个正项相除来分离出 $t$：\n$$t \\ge \\frac{\\ln(S_{0}/R_{0})}{r_{R} - r_{S}}$$\n因为我们处于 $S_0 > R_0$ 的情况，比率 $S_0/R_0 > 1$，因此其对数 $\\ln(S_0/R_0)$ 为正。分母 $r_R - r_S$ 也为正。因此，得到的时间是正数。满足此条件的最早时间 $t$ 是等式成立时：\n$$t = \\frac{\\ln(S_{0}/R_{0})}{r_{R} - r_{S}} = \\frac{\\ln(f_{S0}/f_{R0})}{r_{R} - r_{S}}$$\n\n**子情况3b：非正差异增长（$r_R \\le r_S$）**\n如果抵抗性亚克隆没有增长优势（$r_R - r_S \\le 0$），则出现两种可能性：\n- 如果 $r_R  r_S$，那么 $r_R - r_S$ 为负。用这个负项来除不等式会使其方向反转：\n$$t \\le \\frac{\\ln(S_{0}/R_{0})}{r_{R} - r_{S}}$$\n分子 $\\ln(S_0/R_0)$ 为正，而分母 $r_R - r_S$ 为负。因此，右侧是一个负值。该不等式要求 $t$ 小于或等于一个负数。由于我们寻求 $t \\ge 0$ 的解，因此不存在这样的解。\n- 如果 $r_R = r_S$，不等式变为 $0 \\cdot t \\ge \\ln(S_0/R_0)$。由于 $S_0 > R_0$，右侧为正数。不等式 $0 \\ge (\\text{正数})$ 对所有 $t$ 都不成立。\n在 $r_R \\le r_S$ 的两种情况下（给定一个初始非优势的抵抗性克隆），从数学上讲，达到优势是不可能的。\n\n**算法总结：**\n给定参数 $(f_{R0}, f_{S0}, r_{R}, r_{S})$：\n1.  如果 $f_{R0} \\ge 0.5$，抵抗性优势在 $t = 0$ 时发生。\n2.  如果 $f_{R0} = 0$，不可能达到抵抗性优势。结果是哨兵值 $-1.0$。\n3.  如果 $0  f_{R0}  0.5$：\n    a. 如果 $r_R \\le r_S$，不可能达到抵抗性优势。结果是 $-1.0$。\n    b. 如果 $r_R > r_S$，达到优势的时间是 $t = \\frac{\\ln(f_{S0}/f_{R0})}{r_R - r_S}$。\n\n此逻辑应用于每个测试案例，以计算达到优势的时间，然后将其四舍五入到三位小数。对于不可能的案例，使用指定的哨兵值 $-1.000$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the time to resistant dominance for a set of predefined clinical scenarios.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (f_R0, f_S0, r_R, r_S)\n    # f_R0: initial fraction of resistant subclone\n    # f_S0: initial fraction of sensitive subclone\n    # r_R: net per-capita growth rate of resistant subclone (per day)\n    # r_S: net per-capita growth rate of sensitive subclone (per day)\n    test_cases = [\n        (0.01, 0.99, 0.01, -0.02),    # Case 1: EGFR L858R Lung Adenocarcinoma\n        (0.001, 0.999, 0.02, -0.05),  # Case 2: BCR-ABL CML\n        (0.05, 0.95, 0.005, -0.03),   # Case 3: HER2+ Breast Carcinoma\n        (0.02, 0.98, 0.015, -0.04),   # Case 4: BRAF V600E Melanoma\n        (0.2, 0.8, -0.01, -0.01),     # Case 5: KRAS-mutant Colorectal Carcinoma\n        (0.0, 1.0, 0.005, -0.01),     # Case 6: IDH1-mutant Glioma\n        (0.6, 0.4, 0.01, -0.02)      # Case 7: Pre-dominant resistant EGFR T790M\n    ]\n\n    results = []\n    for case in test_cases:\n        f_R0, f_S0, r_R, r_S = case\n        \n        # Case: Resistant subclone is already dominant or of equal size at t=0.\n        if f_R0 >= f_S0:\n            time = 0.0\n        # Case: Dominance is impossible.\n        # This occurs if no resistant cells exist initially (f_R0 = 0),\n        # or if the resistant cells have no growth advantage (r_R = r_S).\n        elif f_R0 == 0.0 or r_R = r_S:\n            time = -1.0\n        # Case: General case for calculating time to dominance.\n        # This applies when 0  f_R0  f_S0 and r_R > r_S.\n        # We solve R(t) >= S(t) for t: t = ln(S0/R0) / (r_R - r_S).\n        else:\n            time = np.log(f_S0 / f_R0) / (r_R - r_S)\n        \n        # Format the result to three decimal places.\n        results.append(f\"{time:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4314128"}]}