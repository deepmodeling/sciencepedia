{"hands_on_practices": [{"introduction": "流行病学调查的第一步是量化疑似暴露与疾病结果之间的关联强度。本练习将让你扮演流行病学家的角色，计算相对风险（$RR$），这是一个关键的关联性衡量指标。通过处理来自索霍区爆发的假设数据[@problem_id:4753216]，你将量化宽街水泵与其他水源相比究竟危险多少，这是任何公共卫生分析的基础技能。", "problem": "在John Snow所分析的$1854$年Soho区霍乱爆发的历史背景下，请考虑以下重建的家庭层面数据，这些数据来自以Broad Street水泵疫情高峰期为中心的一周时间窗口。在此期间，家庭根据其主要饮用水源以及是否出现至少一例霍乱病例进行分类。\n\n- 暴露组（主要水源为Broad Street水泵的家庭）：$a$户家庭有至少一例霍乱病例，$b$户家庭在该周内没有霍乱病例，其中$a = 75$，$b = 375$。\n- 非暴露组（主要水源为其他水泵或输送水的家庭）：$c$户家庭有至少一例霍乱病例，$d$户家庭在该周内没有霍乱病例，其中$c = 10$，$d = 590$。\n\n仅使用以下核心流行病学定义：(i) 风险是在特定人群和时间段内，事件数与风险人群数之比；(ii) 相对风险(RR)是暴露组风险与非暴露组风险之比。请计算暴露组相对于非暴露组，成为霍乱受影响家庭的相对风险。将最终答案四舍五入至三位有效数字，并以不带单位的小数形式表示。然后，用文字简要解释其关联强度的大小（不要在数值答案中包含解释）。", "solution": "该问题是有效的。它以既定的流行病学原理为科学依据，提供了所有必要的数据，问题表述清晰，并且其表述是客观的。我们可以进行求解。\n\n目标是计算成为霍乱受影响家庭的相对风险(RR)，即比较暴露于Broad Street水泵水源的家庭与未暴露的家庭。问题为此计算提供了必要的数据和定义。\n\n所提供的数据可以整理成一个$2 \\times 2$列联表，其中行代表暴露状态，列代表结局状态（家庭中是否存在霍乱病例）。\n\n- **暴露组（Broad Street水泵）：**\n  - 有霍乱病例的家庭数（事件数）：$a = 75$\n  - 没有霍乱病例的家庭数：$b = 375$\n- **非暴露组（其他水源）：**\n  - 有霍乱病例的家庭数（事件数）：$c = 10$\n  - 没有霍乱病例的家庭数：$d = 590$\n\n首先，我们确定每个组中的风险家庭总数。\n暴露组中的家庭总数为 $N_{exp} = a + b$。\n$$N_{exp} = 75 + 375 = 450$$\n非暴露组中的家庭总数为 $N_{unexp} = c + d$。\n$$N_{unexp} = 10 + 590 = 600$$\n\n接下来，我们应用所提供的风险定义：特定组内事件数与风险人群数之比。\n\n暴露组的风险 $Risk_{exp}$ 是使用Broad Street水泵的家庭中出现至少一例霍乱病例的比例。\n$$Risk_{exp} = \\frac{a}{N_{exp}} = \\frac{a}{a+b}$$\n代入给定值：\n$$Risk_{exp} = \\frac{75}{450} = \\frac{1}{6}$$\n\n非暴露组的风险 $Risk_{unexp}$ 是使用其他水源的家庭中出现至少一例霍乱病例的比例。\n$$Risk_{unexp} = \\frac{c}{N_{unexp}} = \\frac{c}{c+d}$$\n代入给定值：\n$$Risk_{unexp} = \\frac{10}{600} = \\frac{1}{60}$$\n\n最后，我们根据相对风险(RR)的定义（即暴露组风险与非暴露组风险之比）来计算它。\n$$RR = \\frac{Risk_{exp}}{Risk_{unexp}}$$\n代入计算出的风险值：\n$$RR = \\frac{1/6}{1/60} = \\frac{1}{6} \\times \\frac{60}{1} = 10$$\n\n问题要求将最终答案四舍五入至三位有效数字。计算出的确切值为$10$。为了用三位有效数字表示，我们将其写为$10.0$。\n\n按照简要解释的要求，$10.0$的相对风险表明暴露与结局之间存在非常强的关联。具体来说，这意味着在$1854$年疫情爆发的特定一周内，主要水源为Broad Street水泵的家庭出现霍乱病例的可能性是使用其他水源家庭的$10$倍。", "answer": "$$\\boxed{10.0}$$", "id": "4753216"}, {"introduction": "在斯诺的论证中，一个关键证据是在宽街水泵把手被拆除后，霍乱病例数急剧下降。这个练习要求你使用干预前后的数据来分析这个“自然实验”[@problem_id:4753217]。更重要的是，它引入了潜伏期的概念，迫使你仔细思考从暴露到发病之间的时间延迟，以便准确评估干预措施的真实效果。", "problem": "John Snow 对于伦敦霍乱爆发中布罗德街水泵作用的推断，关键在于在现实的潜伏期假设下，将水源暴露与病例在时间上联系起来。考虑一个假设数据集，代表了在布罗德街水泵手柄被拆除前一周和后一周，苏豪区每日的霍乱病例计数。假设拆除发生在干预前后的交界时间点，并且在这两周内，风险人群和病例确认率保持稳定。霍乱的潜伏期很短；使用一个保守的中位潜伏期延迟 $L=2$ 天来推断哪些拆除后的日期反映了拆除前的暴露。\n\n拆除前一周（第 $t=-7$ 天到第 $t=-1$ 天）的每日计数如下：\n$C_{-7}=3$, $C_{-6}=5$, $C_{-5}=12$, $C_{-4}=28$, $C_{-3}=45$, $C_{-2}=52$, $C_{-1}=40$。\n\n拆除后一周（第 $t=+1$ 天到第 $t=+7$ 天）的每日计数如下：\n$C_{+1}=38$, $C_{+2}=30$, $C_{+3}=20$, $C_{+4}=12$, $C_{+5}=8$, $C_{+6}=5$, $C_{+7}=3$。\n\n从流行病学的第一性原理出发，定义一个简单的干预前后因果估计量来评估干预效果，该估计量使用拆除后与拆除前平均每日发病率的比率，并说明如何根据潜伏期延迟 $L$ 调整干预后时期。使用所有 $7$ 个拆除后的天数计算朴素的干预后-干预前比率，然后仅使用拆除后的第 $t=+3$ 天到第 $t=+7$ 天计算延迟调整后的干预后-干预前比率。你最终报告的量必须是延迟调整后的比率。将最终答案表示为一个无单位的十进制数，并四舍五入到四位有效数字。", "solution": "问题陈述经过验证。\n\n### 步骤 1：提取已知信息\n-   **干预**：在时间 $t=0$ 拆除布罗德街水泵手柄。\n-   **潜伏期**：中位潜伏期延迟为 $L=2$ 天。\n-   **假设**：风险人群和病例确认率保持稳定。\n-   **干预前数据**：第 $t=-7$ 天至第 $t=-1$ 天的每日霍乱病例计数。\n    -   $C_{-7}=3$\n    -   $C_{-6}=5$\n    -   $C_{-5}=12$\n    -   $C_{-4}=28$\n    -   $C_{-3}=45$\n    -   $C_{-2}=52$\n    -   $C_{-1}=40$\n-   **干预后数据**：第 $t=+1$ 天至第 $t=+7$ 天的每日霍乱病例计数。\n    -   $C_{+1}=38$\n    -   $C_{+2}=30$\n    -   $C_{+3}=20$\n    -   $C_{+4}=12$\n    -   $C_{+5}=8$\n    -   $C_{+6}=5$\n    -   $C_{+7}=3$\n-   **任务要求**：\n    1.  定义一个基于平均每日发病率比率的干预前后因果估计量。\n    2.  说明根据潜伏期延迟 $L$ 调整干预后时期的理由。\n    3.  使用所有 $7$ 个拆除后的天数计算朴素的干预后-干预前比率。\n    4.  使用拆除后的第 $t=+3$ 天到第 $t=+7$ 天计算延迟调整后的干预后-干预前比率。\n    5.  最终答案是延迟调整后的比率，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知信息进行验证\n-   **科学依据**：该问题是流行病学中一个简化但标准的练习，基于 John Snow 工作的历史背景。潜伏期、发病率和干预前后分析等概念是该领域的基础。没有违反任何科学原理。\n-   **适定性**：该问题提供了所有必要的数据，并定义了所需的计算和输出格式。问题清晰无歧义，可得出一个唯一的、稳定的数值解。\n-   **客观性**：问题陈述使用客观、定量的语言，不包含任何主观或基于意见的论断。\n\n所有其他验证标准均已满足。该问题是自洽、一致且可行的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解\n目标是估计拆除布罗德街水泵手柄对霍乱发病率的因果效应。对于这种干预前后的研究设计，一个简单且常用的估计量是干预后时期与干预前时期的平均每日发病率之比。设 $I_{pre}$ 和 $I_{post}$ 分别为干预前和干预后时期的平均每日发病率。估计量为比率 $R = \\frac{I_{post}}{I_{pre}}$。\n\n鉴于问题陈述风险人群保持稳定，每日病例计数 $C_t$ 与每日发病率成正比。因此，平均每日病例计数的比率可以作为平均每日发病率比率的有效代理指标。设 $\\bar{C}_{pre}$ 和 $\\bar{C}_{post}$ 为平均每日病例计数。则估计量计算为 $R = \\frac{\\bar{C}_{post}}{\\bar{C}_{pre}}$。\n\n首先，我们计算干预前时期的平均每日病例计数，该时期跨度为从 $t=-7$ 到 $t=-1$ 的 $7$ 天。\n干预前时期的总病例数是：\n$$ \\sum_{t=-7}^{-1} C_t = C_{-7} + C_{-6} + C_{-5} + C_{-4} + C_{-3} + C_{-2} + C_{-1} $$\n$$ \\sum_{t=-7}^{-1} C_t = 3 + 5 + 12 + 28 + 45 + 52 + 40 = 185 $$\n这 $7$ 天的平均每日病例计数是：\n$$ \\bar{C}_{pre} = \\frac{1}{7} \\sum_{t=-7}^{-1} C_t = \\frac{185}{7} $$\n\n接下来，我们必须定义干预后时期。一种朴素的方法是使用所有可用的拆除后数据，即从 $t=+1$ 到 $t=+7$。在这个朴素的干预后时期，总病例数是：\n$$ \\sum_{t=1}^{7} C_t = 38 + 30 + 20 + 12 + 8 + 5 + 3 = 116 $$\n这 $7$ 天的朴素平均每日病例计数是：\n$$ \\bar{C}_{post, naive} = \\frac{1}{7} \\sum_{t=1}^{7} C_t = \\frac{116}{7} $$\n朴素比率将是 $R_{naive} = \\frac{\\bar{C}_{post, naive}}{\\bar{C}_{pre}} = \\frac{116/7}{185/7} = \\frac{116}{185} \\approx 0.6270$。\n\n然而，这种朴素的方法是有缺陷的，因为它忽略了疾病的潜伏期。潜伏期是指从接触病原体到出现症状之间的时间延迟。对于霍乱，其中位潜伏期延迟为 $L=2$ 天，一个在第 $t_{case}$ 天成为病例的人，最有可能是在第 $t_{infection} = t_{case} - L = t_{case} - 2$ 天左右被感染的。干预措施——在 $t=0$ 时拆除水泵手柄——阻止了来自该源头的新暴露。因此，在 $t=0$ 之后不久观察到的病例可归因于干预*之前*发生的感染。具体来说：\n-   第 $t=+1$ 天的病例很可能源于 $t = +1 - 2 = -1$ 左右的感染。\n-   第 $t=+2$ 天的病例很可能源于 $t = +2 - 2 = 0$ 左右的感染。\n\n由于这些病例源于干预前或干预期间的暴露，它们并不能反映干预本身（即没有了受污染的水）的效果。为了正确估计干预的效果，我们必须分析一个干预后时期，其中观察到的病例对应于完全处于干预后的感染时间窗口。在第 $t=+3$ 天观察到的病例对应于第 $t=+1$ 天左右的感染，这已经是在水泵被停用之后了。因此，为了分离出干预效果，对干预后时期的分析应该在潜伏期延迟过去之后开始。\n\n按照规定，我们使用从 $t=+3$ 到 $t=+7$ 的延迟调整后干预时期。该时期包括 $5$ 天。我们计算这个调整后时期的平均每日病例计数 $\\bar{C}_{post, adj}$。\n延迟调整后干预时期的总病例数是：\n$$ \\sum_{t=3}^{7} C_t = C_{+3} + C_{+4} + C_{+5} + C_{+6} + C_{+7} $$\n$$ \\sum_{t=3}^{7} C_t = 20 + 12 + 8 + 5 + 3 = 48 $$\n这 $5$ 天的平均每日病例计数是：\n$$ \\bar{C}_{post, adj} = \\frac{1}{5} \\sum_{t=3}^{7} C_t = \\frac{48}{5} $$\n\n现在，我们可以计算延迟调整后的干预后-干预前比率 $R_{adj}$，这是所要求的最终量。\n$$ R_{adj} = \\frac{\\bar{C}_{post, adj}}{\\bar{C}_{pre}} = \\frac{48/5}{185/7} $$\n$$ R_{adj} = \\frac{48 \\times 7}{5 \\times 185} = \\frac{336}{925} $$\n为了得到最终的数值答案，我们进行除法运算并四舍五入到四位有效数字。\n$$ R_{adj} \\approx 0.36324324... $$\n四舍五入到四位有效数字，我们得到 $0.3632$。这个值远低于朴素估计值，表明在拆除水泵手柄后霍乱发病率出现了更显著的下降，这正确地考虑了潜伏期的生物学现实。", "answer": "$$\n\\boxed{0.3632}\n$$", "id": "4753217"}, {"introduction": "斯诺理论的批评者可能会辩称，贫困而非水源才是霍乱的真正原因，这就是经典的混杂问题。这个高级练习展示了流行病学家如何通过对数据进行分层，并使用Mantel-Haenszel方法计算调整后的相对风险来应对此类挑战[@problem_id:4753196]。你将学会如何将供水的影响与社会经济地位的影响区分开来，这是从观察数据中得出稳健因果结论的一项至关重要的技能。", "problem": "在 John Snow 调查的十九世纪中叶苏豪区（Soho）霍乱爆发事件中，我们考虑一项旨在反映按社会经济地位（Socioeconomic Status, SES）分层的回顾性队列分析。将任何组的风险定义为该组中霍乱病例数与总人数的比率，并将相对风险（Relative Risk, RR）定义为饮用宽街（Broad Street）水泵水的暴露人群的风险与非暴露人群风险的比率。为解决 SES 造成的混杂，您将使用 Mantel–Haenszel 方法合并各分层的特定信息。\n\n根据教区记录构建了两个 SES 分层：\n\n- 较低 SES 分层：在主要饮用宽街水泵水的家庭中，有 $a_{1} = 90$ 例霍乱病例，共 $N_{1,1} = 180$ 个暴露家庭；在不饮用宽街水泵水的家庭中，有 $c_{1} = 12$ 例霍乱病例，共 $N_{0,1} = 120$ 个非暴露家庭。\n- 较高 SES 分层：在主要饮用宽街水泵水的家庭中，有 $a_{2} = 18$ 例霍乱病例，共 $N_{1,2} = 60$ 个暴露家庭；在不饮用宽街水泵水的家庭中，有 $c_{2} = 12$ 例霍乱病例，共 $N_{0,2} = 240$ 个非暴露家庭。\n\n使用 Mantel–Haenszel 方法对这两个 SES 分层进行合并，计算因暴露于宽街水泵水而调整后的 RR。将最终调整后的 RR 作为无量纲量报告，并四舍五入至三位有效数字。然后，根据您计算的各分层特异性 RR，评论合并估计值对于 SES 分层是否稳健，以及 SES 是否可能存在效应修饰，并定性解释您的理由。最终答案只应给出调整后的 RR（一个实数值）。", "solution": "该问题要求在控制社会经济地位（SES）的混杂效应的同时，计算因暴露于宽街水泵水而导致的霍乱的调整后相对风险（$RR$）。指定的方法是用于分层队列数据的 Mantel-Haenszel 方法。\n\n首先，我们必须验证问题陈述。\n**步骤 1：提取已知条件**\n- 分析类型：回顾性队列分析。\n- 分层变量：社会经济地位（SES），分为两个分层（较低和较高）。\n- 暴露：主要饮用宽街水泵的水。\n- 结局：霍乱病例。\n- 风险定义：一组中霍乱病例数与总人数的比率。\n- 相对风险（RR）定义：暴露组风险与非暴露组风险的比率。\n- 合并方法：Mantel-Haenszel 方法。\n- 较低 SES 分层（$i=1$）的数据：\n  - 暴露组：$a_{1} = 90$ 例，$N_{1,1} = 180$ 总数。\n  - 非暴露组：$c_{1} = 12$ 例，$N_{0,1} = 120$ 总数。\n- 较高 SES 分层（$i=2$）的数据：\n  - 暴露组：$a_{2} = 18$ 例，$N_{1,2} = 60$ 总数。\n  - 非暴露组：$c_{2} = 12$ 例，$N_{0,2} = 240$ 总数。\n- 要求输出：\n  1. Mantel-Haenszel 调整后的 RR（$RR_{MH}$），四舍五入至三位有效数字。\n  2. 对 SES 效应修饰的定性评估。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，使用了标准的流行病学概念和方法（$RR$、混杂、分层、Mantel-Haenszel 估计）。问题陈述清晰，为计算提供了所有必要数据（两个分层的 $a_i, c_i, N_{1,i}, N_{0,i}$）。语言客观、精确。数据内部一致（例如，任何组的病例数都不超过总人口数）。该问题并非无足轻重，需要进行特定、正式的计算。它不违反任何无效性标准。\n\n**步骤 3：结论与行动**\n问题有效。将提供解答。\n\n在队列研究中，跨 $k$ 个分层的调整后相对风险（$RR_{MH}$）的 Mantel-Haenszel 估计量是一个加权平均值，由以下公式给出：\n$$ RR_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{a_i N_{0,i}}{T_i}}{\\sum_{i=1}^{k} \\frac{c_i N_{1,i}}{T_i}} $$\n其中对于每个分层 $i$：\n- $a_i$ 是暴露组中的病例数。\n- $c_i$ 是非暴露组中的病例数。\n- $N_{1,i}$ 是暴露组中的总人数。\n- $N_{0,i}$ 是非暴露组中的总人数。\n- $T_i = N_{1,i} + N_{0,i}$ 是该分层中的总人数。\n\n我们有两个分层（$k=2$）。\n\n**分层 1（较低 SES）：**\n- 暴露组病例数，$a_1 = 90$\n- 暴露组总人数，$N_{1,1} = 180$\n- 非暴露组病例数，$c_1 = 12$\n- 非暴露组总人数，$N_{0,1} = 120$\n- 分层 1 总人数，$T_1 = N_{1,1} + N_{0,1} = 180 + 120 = 300$\n\n**分层 2（较高 SES）：**\n- 暴露组病例数，$a_2 = 18$\n- 暴露组总人数，$N_{1,2} = 60$\n- 非暴露组病例数，$c_2 = 12$\n- 非暴露组总人数，$N_{0,2} = 240$\n- 分层 2 总人数，$T_2 = N_{1,2} + N_{0,2} = 60 + 240 = 300$\n\n现在，我们计算 $RR_{MH}$ 公式的分子和分母的各项。\n\n分层 1 对分子的贡献：\n$$ \\frac{a_1 N_{0,1}}{T_1} = \\frac{90 \\times 120}{300} = \\frac{10800}{300} = 36 $$\n分层 2 对分子的贡献：\n$$ \\frac{a_2 N_{0,2}}{T_2} = \\frac{18 \\times 240}{300} = \\frac{4320}{300} = 14.4 $$\n分子总计：\n$$ \\sum_{i=1}^{2} \\frac{a_i N_{0,i}}{T_i} = 36 + 14.4 = 50.4 $$\n\n分层 1 对分母的贡献：\n$$ \\frac{c_1 N_{1,1}}{T_1} = \\frac{12 \\times 180}{300} = \\frac{2160}{300} = 7.2 $$\n分层 2 对分母的贡献：\n$$ \\frac{c_2 N_{1,2}}{T_2} = \\frac{12 \\times 60}{300} = \\frac{720}{300} = 2.4 $$\n分母总计：\n$$ \\sum_{i=1}^{2} \\frac{c_i N_{1,i}}{T_i} = 7.2 + 2.4 = 9.6 $$\n\n最后，我们计算 Mantel-Haenszel 调整后的相对风险：\n$$ RR_{MH} = \\frac{50.4}{9.6} = 5.25 $$\n问题要求结果四舍五入至三位有效数字。数值 $5.25$ 已有三位有效数字。\n\n为评论合并估计值的稳健性以及效应修饰的可能性，我们计算各分层特异性相对风险（$RR_i$）。\n风险定义为病例数除以总人数。\n$RR_i = \\frac{\\text{Risk in exposed}}{\\text{Risk in unexposed}} = \\frac{a_i/N_{1,i}}{c_i/N_{0,i}}$\n\n对于分层 1（较低 SES）：\n- 暴露组风险：$R_{1,1} = \\frac{a_1}{N_{1,1}} = \\frac{90}{180} = 0.5$\n- 非暴露组风险：$R_{0,1} = \\frac{c_1}{N_{0,1}} = \\frac{12}{120} = 0.1$\n- 分层特异性 RR：$RR_1 = \\frac{R_{1,1}}{R_{0,1}} = \\frac{0.5}{0.1} = 5.0$\n\n对于分层 2（较高 SES）：\n- 暴露组风险：$R_{1,2} = \\frac{a_2}{N_{1,2}} = \\frac{18}{60} = 0.3$\n- 非暴露组风险：$R_{0,2} = \\frac{c_2}{N_{0,2}} = \\frac{12}{240} = 0.05$\n- 分层特异性 RR：$RR_2 = \\frac{R_{1,2}}{R_{0,2}} = \\frac{0.3}{0.05} = 6.0$\n\n各分层特异性 RR 分别为 $RR_1 = 5.0$ 和 $RR_2 = 6.0$。\n当效应度量（此处为 RR）在第三方变量（此处为 SES）的不同分层中存在差异时，即存在效应修饰（或交互作用）。RR 不相同（$5.0$ 对 $6.0$），这表明存在一定程度的效应修饰。宽街水泵水的影响在较高 SES 分层中似乎稍强。然而，这种差异不大。在没有进行同质性形式统计检验（例如适用于 RR 的 Breslow-Day 检验）的情况下，我们只能做出定性判断。鉴于这些值相当接近，通常认为可以呈现一个单一的合并估计值。\n\n调整后的估计值 $RR_{MH} = 5.25$ 位于两个分层特异性 RR（$5.0$ 和 $6.0$）之间。这是 Mantel-Haenszel 估计量的一个必要属性，它是一个加权平均值。由于各分层特异性 RR 没有显著差异，因此在调整 SES 这一混杂因素后，合并估计值 $5.25$ 可以被视为饮用宽街水泵水与霍乱之间关联的一个稳健的汇总度量。\n\n最终需要的数值答案是调整后的 RR。", "answer": "$$\n\\boxed{5.25}\n$$", "id": "4753196"}]}