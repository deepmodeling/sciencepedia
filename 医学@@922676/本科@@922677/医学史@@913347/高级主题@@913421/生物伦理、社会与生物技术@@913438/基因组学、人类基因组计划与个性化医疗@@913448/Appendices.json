{"hands_on_practices": [{"introduction": "任何基因组学项目的起点都是制定一个清晰的计算策略。高通量测序技术产生的是数百万个短的DNA序列片段，称为“读段”(reads)，我们必须将这些碎片化的信息拼凑成有意义的生物学图景。这个实践练习探讨了两种基本的生物信息学工作流程——“从头组装”(de novo assembly)和“参考基因组比对”(reference alignment)——阐明了在后人类基因组计划时代，研究人员如何根据是否存在一个高质量的参考“地图”来选择正确的分析路径。[@problem_id:4747025]", "problem": "一家临床基因组学实验室在 $2020$ 年受托分析一名患者的全基因组测序读段（reads），以鉴定用于个性化医疗的临床相关变异。另外，一个历史方法学小组试图从 $1995$ 年的数据中重建一个非模式生物的基因组，该生物没有可靠的参考基因组。基于对脱氧核糖核酸（DNA）储存遗传信息、高通量测序产生称为读段（reads）的短序列片段、以及参考基因组作为序列比对的坐标系等基本概念的理解，请选择一个选项，该选项正确定义了基因组组装、与参考基因组比对和变异检测，并正确描述了在标准的后人类基因组计划时代的人类基因组分析工作流程中这些步骤之间的逻辑依赖关系，同时还指出了在没有参考基因组的情况下操作顺序会如何改变。\n\n哪个选项是正确的？\n\nA. 基因组组装是根据重叠的读段重建更长的连续序列（重叠群/contigs 和支架/scaffolds），无需预先存在参考基因组，主要在没有可靠参考基因组或需要解析新序列时使用；与参考基因组比对是利用序列相似性将单个读段映射到现有参考基因组上的位置；变异检测是通过在每个位置比较比对上的读段证据与参考基因组，来推断诸如单核苷酸多态性（SNPs）和插入或缺失（indels）之类的差异。因此，在人类基因组计划之后的标准人类重测序中，逻辑顺序是：读段 $\\rightarrow$ 质量控制 $\\rightarrow$ 与人类参考基因组比对 $\\rightarrow$ 变异检测（组装是可选的，非必需）。在 $1995$ 年没有参考基因组的从头（de novo）组装情境下，组装必须在任何全基因组比较分析之前进行；比对（如果使用）会将读段映射回组装结果以进行校正；在获得合适的参考基因组之前，相对于已知参考的变异检测是不可能的。\n\nB. 基因组组装是利用一个已知的参考基因组并将读段映射到其上，以重建基因组的顺序；与参考基因组比对是沿着染色体对已组装的重叠群进行排序；变异检测与功能注释是同一回事。因此，在标准实践中，首先进行变异检测以识别重要区域，然后进行比对以排列重叠群，最后进行组装以完成基因组。\n\nC. 与参考基因组比对可以在没有任何参考基因组的情况下通过将读段聚类成组来执行，而基因组组装则需要一个完整的参考基因组来指导构建；变异检测是一个可选的下游步骤，不依赖于比对。因此，无论是在人类基因组计划之后还是之前的环境中，正确的顺序都是比对 $\\rightarrow$ 组装 $\\rightarrow$ 变异检测。\n\nD. 为避免偏倚，变异检测最好在任何比对之前，使用 k-mer 计数直接对原始读段进行；即使存在高质量的人类参考基因组，基因组组装也是强制性的；与参考基因组比对仅用于可视化。因此，在所有情况下，正确的顺序都是组装 $\\rightarrow$ 变异检测 $\\rightarrow$ 比对。", "solution": "将首先提取给定信息，然后根据有效科学问题的标准对其进行评估，从而验证问题陈述。\n\n### 步骤 1：提取已知信息\n- **情景 1：** 一家临床基因组学实验室在 $2020$ 年分析一名人类患者的全基因组测序读段，用于个性化医疗。\n- **情景 2：** 一个历史方法学小组在 $1995$ 年试图重建一个非模式生物的基因组，该生物没有可靠的参考基因组。\n- **基本概念：**\n    1. 脱氧核糖核酸（DNA）储存遗传信息。\n    2. 高通量测序产生称为“读段”（reads）的短 DNA 片段。\n    3. 参考基因组作为序列比较的坐标系。\n- **任务：** 选择一个选项，该选项能正确地：\n    1. 定义基因组组装、与参考基因组比对和变异检测。\n    2. 描绘在标准的后人类基因组计划时代的人类基因组分析工作流程中（情景 1），这些步骤之间的逻辑依赖关系。\n    3. 指出在没有参考基因组的情况下（情景 2），操作顺序会如何改变。\n\n### 步骤 2：使用提取的已知信息进行验证\n- **科学依据：** 该问题牢固地基于基因组学和生物信息学的既定原则和标准实践。DNA、测序读段、参考基因组、组装、比对和变异检测等概念是该领域的核心。所提出的两种情景（人类重测序 vs. 非模式生物的*从头*组装）代表了全基因组测序的两种主要应用，并且在科学上是现实的。\n- **适定性：** 这是一个适定问题。它要求在两种不同且常见的条件下（有或没有参考基因组），为特定、明确的生物信息学过程提供正确的定义和逻辑工作流程。应该存在一个描述这些标准操作程序的唯一正确答案。\n- **客观性：** 问题陈述使用了基因组学领域精确、客观和标准的术语，没有主观或模棱两可的语言。\n- **完整性和一致性：** 提供的信息是充分且自洽的。两种情景之间的区别（存在 vs. 缺失参考基因组）是评估工作流程所需的关键信息，并且已明确说明。\n- **结论：** 该问题是有效的。这是一个精心设计的问题，用以测试生物信息学工作流程的基础知识。\n\n### 步骤 3：推导与选项分析\n\n该问题要求理解基因组学分析流程中数据的逻辑流。核心区别在于是否存在高质量的参考基因组。\n\n**基本定义：**\n1.  **基因组组装：** 指的是从大量短测序读段中重建基因组的计算过程。在没有指导的情况下，这被称为*从头*（de novo）组装。该过程涉及寻找读段之间的重叠，以构建更长的连续序列（重叠群/contigs）。在后续步骤中，可以利用来自读段对（双末端或配对末端读段）的信息，将这些重叠群排序和定向，形成称为支架（scaffolds）的更大结构。当生物体没有可用的参考基因组时，此过程至关重要。\n2.  **比对（或映射）：** 这是将单个测序读段与其在预先存在的参考基因组上的起源位置进行确定的过程。算法使用序列相似性为每个读段找到最佳匹配位置。这是任何“重测序”项目中的第一个主要计算步骤，其目标是将个体基因组与物种的标准参考基因组进行比较。\n3.  **变异检测：** 比对之后，来自单个个体的读段会堆叠在参考基因组上。变异检测是系统性地扫描这些比对上的读段，以识别个体基因组序列与参考序列不同的位置的过程。这些差异或“变异”包括单核苷酸多态性（SNPs）、小的插入和缺失（indels）以及更大的结构变异。这个过程严重依赖于之前的比对步骤。\n\n**情景分析：**\n- **情景 1：$2020$ 年的人类患者（基于参考的分析）：** 由于人类基因组计划已经完成，因此有高质量的人类参考基因组可用。目标是个性化医疗，这需要识别患者的遗传变异。标准工作流程是：\n    1.  从患者的 DNA 生成原始读段。\n    2.  对读段进行质量控制（QC）。\n    3.  将经过质控的读段**比对**到人类参考基因组上。\n    4.  通过将比对上的读段与参考基因组进行比较来**检测变异**。\n    在这个工作流程中，*从头*基因组组装不是必需的主要步骤。它计算成本高昂，仅在特殊情况下使用，例如，用于表征参考基因组中未体现的非常大、复杂的结构变异或新的序列插入。\n\n- **情景 2：$1995$ 年的非模式生物（*从头*分析）：** 没有参考基因组存在。因此，首要目标必须是创建一个。\n    1.  从该生物的 DNA 生成原始读段。\n    2.  对读段进行质量控制（QC）。\n    3.  进行*从头***基因组组装**，从读段构建重叠群（contigs）和支架（scaffolds）。这个组装好的序列成为该生物参考基因组的初稿。\n    4.  后续步骤可能包括通过将读段**比对**回组装结果来“校正”组装以修正错误，或进行基因注释。在创建一个组装体作为参考之前，与标准参考进行比较意义上的**变异检测**是不可能的。\n\n有了这些既定原则，我们来评估各个选项。\n\n**逐项选项分析：**\n\n**A.**\n- **定义：** 将组装定义为*不*使用参考基因组从读段中重建序列。将比对定义为将读段映射*到*参考基因组。将变异检测定义为通过比较比对上的读段*与*参考基因组来推断差异。这些定义都是正确的。\n- **人类工作流程：** 指出顺序是读段 $\\rightarrow$ 质量控制 $\\rightarrow$ 比对 $\\rightarrow$ 变异检测，并且组装是可选的。这对于标准的人类重测序是正确的。\n- **无参考工作流程：** 指出组装必须先行，并且相对于已知参考的变异检测是不可能的。这也是正确的。\n- **结论：****正确**。该选项准确地描述了两种情景下的定义和逻辑依赖关系。\n\n**B.**\n- **定义：** 声称组装是“利用一个已知的参考基因组并将读段映射到其上”，这是对比对的描述，而不是组装。它声称比对是“对已组装的重叠群进行排序”，这是支架构建（scaffolding，组装的一部分）。它声称变异检测“与功能注释是同一回事”，这是错误的；它们是不同的过程。\n- **工作流程：** 提议的顺序“变异检测 $\\rightarrow$ 比对 $\\rightarrow$ 组装”是荒谬的，并且与这些过程的基本逻辑相矛盾。\n- **结论：****错误**。定义和工作流程描述都存在根本性缺陷。\n\n**C.**\n- **定义：** 声称比对可以通过聚类读段来*在没有参考基因组的情况下*完成；这描述的是组装中的一个步骤。它声称组装*需要一个参考基因组*，这与*从头*组装的主要目的相反。它声称变异检测不依赖于比对，这对于标准的基于参考的变异检测是错误的。\n- **工作流程：** 提议的顺序是错误的，并且声称在两种情况下顺序相同是一个关键错误。\n- **结论：****错误**。该选项显示出对核心概念的完全误解。\n\n**D.**\n- **定义：** 声称变异检测是在比对*之前*对原始读段进行的；虽然存在一些专门的基于 k-mer 的方法，但这并不是在重测序项目中生成全面变异列表的标准或最佳方法。它声称即使有高质量的人类参考基因组，组装也是*强制性*的；这是错误的。它声称比对*仅用于可视化*；这是错误的，因为比对是变异检测和其他下游分析的关键先决条件。\n- **工作流程：** 提议的顺序“组装 $\\rightarrow$ 变异检测 $\\rightarrow$ 比对”是不合逻辑的。在与参考基因组比对之前，无法对其进行变异检测。\n- **结论：****错误**。关于这些过程及其顺序的说法是不准确的。\n\n基于此全面分析，选项 A 是唯一一个提供了科学上正确的定义，并准确描述了问题所规定的两种情景下的工作流程的选项。", "answer": "$$\\boxed{A}$$", "id": "4747025"}, {"introduction": "在通过比对等流程获得个体的基因型数据（例如，单核苷酸多态性SNP）后，关键的下一步是评估这些数据的质量并理解其在群体中的背景。这个实践练习将群体遗传学的基石——哈迪-温伯格平衡（Hardy–Weinberg Equilibrium, HWE）——作为一个强大的质量控制工具。通过将观察到的基因型频率与HWE预测的期望频率进行比较，我们可以识别出可能由技术错误（如基因分型错误）或未知的群体结构导致的显著偏差，这在药物基因组学和个性化医疗的数据验证中至关重要。[@problem_id:4747024]", "problem": "继人类基因组计划（HGP）之后，群体等位基因频率变得广泛可用，从而能够在药物基因组学和个性化医疗中对基因分型数据进行质量评估。考虑一个与药物代谢相关的药物基因中的单核苷酸多态性（SNP），它有两个等位基因 $A$ 和 $a$。在一个由 $N=1000$ 名血统匹配的个体组成的队列中，基因分型得出的观测计数为 $O_{AA}=120$、$O_{Aa}=460$ 和 $O_{aa}=420$。假设从一个针对相同血统的、源自HGP的外部参考面板中得知，基础群体中等位基因 $A$ 的频率为 $p=0.35$。在Hardy–Weinberg平衡（HWE）条件下，使用 $p$ 计算预期的基因型频率，并用它们推导出预期计数。然后，通过计算以下公式，使用卡方检验来评估与HWE的偏离程度\n$$\\chi^{2}=\\sum_{g \\in \\{AA,Aa,aa\\}} \\frac{(O_{g}-E_{g})^{2}}{E_{g}},$$\n其中 $E_{g}$ 是HWE预期计数。请清楚地陈述在此情境下使用HWE和卡方检验的生物学及统计学假设，包括 $p$ 是被视为已知还是估计值，以及这对自由度的影响。仅报告卡方统计量的值，四舍五入至 $4$ 位有效数字，作为一个无单位的纯数。", "solution": "该问题被评估为有效。它在科学上基于群体遗传学和生物统计学的原理，特别是Hardy–Weinberg平衡（HWE）模型和卡方拟合优度检验。问题陈述清晰、客观，并为得出唯一解提供了所有必要数据。\n\n首先，我们讨论应用HWE原理和卡方检验所依据的生物学和统计学假设。\n\n一个群体处于Hardy–Weinberg平衡状态的生物学假设是：\n1.  该生物体是二倍体。\n2.  进行有性生殖。\n3.  世代不重叠。\n4.  就所讨论的基因座而言，交配是随机的（随机交配）。\n5.  种群大小是无限大的，意味着遗传漂变可以忽略不计。\n6.  没有基因流（迁移）进出该种群。\n7.  该基因座上没有发生突变。\n8.  没有自然选择；所有基因型具有相同的生存能力和繁殖能力。\n在药物基因组学质量控制的背景下，一个血统匹配的对照群体中若出现与HWE的显著偏离，可能暗示存在基因分型错误（如杂合子的错误分类），或“血统匹配”这一描述未能涵盖的群体分层。\n\nPearson卡方（$\\chi^2$）拟合优度检验的统计学假设是：\n1.  数据是原始计数，被组织成离散的、不重叠的类别（在此案例中，即基因型 $AA$、$Aa$ 和 $aa$）。\n2.  观测值是独立的。队列中一个个体的基因型不影响另一个个体的基因型。\n3.  样本量足够大，以至于每个类别中的预期计数（$E_g$）不会太小。一个通用的准则是，所有预期计数都应大于 $5$。\n\n此问题中的一个关键点是等位基因频率 $p$ 的来源。问题说明等位基因 $A$ 的频率 $p=0.35$ 来自一个外部的、源自HGP的参考面板，而不是从 $N=1000$ 个个体的样本队列中估计出来的。这对 $\\chi^2$ 检验的自由度（$df$）有直接影响。自由度的计算公式是 $df = k - 1 - m$，其中 $k$ 是类别数量，$m$ 是为生成预期频率而从数据中估计的参数数量。在这里，我们有 $k=3$ 个基因型类别（$AA$、$Aa$、$aa$）。由于等位基因频率 $p$ 被视为一个已知常数，没有参数是从样本数据中估计的，因此 $m=0$。所以，本次检验的正确自由度是 $df = 3 - 1 - 0 = 2$。\n\n现在，我们进行 $\\chi^2$ 统计量的计算。\n\n给定的数据是：\n-   总样本量：$N = 1000$\n-   观测基因型计数：$O_{AA} = 120$，$O_{Aa} = 460$，$O_{aa} = 420$。总和为 $120 + 460 + 420 = 1000$，与 $N$ 相符。\n-   等位基因 $A$ 的群体频率：$p = 0.35$。\n\n等位基因 $a$ 的频率必然是 $q = 1 - p$。\n$$q = 1 - 0.35 = 0.65$$\n\n在HWE条件下，$AA$ 的预期基因型频率为 $p^2$，$Aa$ 为 $2pq$，$aa$ 为 $q^2$。\n-   $AA$ 的预期频率：$f_{AA} = p^2 = (0.35)^2 = 0.1225$。\n-   $Aa$ 的预期频率：$f_{Aa} = 2pq = 2 \\times 0.35 \\times 0.65 = 0.455$。\n-   $aa$ 的预期频率：$f_{aa} = q^2 = (0.65)^2 = 0.4225$。\n我们可以检验这些频率之和为 $1$：$0.1225 + 0.455 + 0.4225 = 1$。\n\n接下来，我们在一个大小为 $N=1000$ 的样本中计算每种基因型的预期计数（$E_g$）。\n-   $AA$ 的预期计数：$E_{AA} = N \\times f_{AA} = 1000 \\times 0.1225 = 122.5$。\n-   $Aa$ 的预期计数：$E_{Aa} = N \\times f_{Aa} = 1000 \\times 0.455 = 455$。\n-   $aa$ 的预期计数：$E_{aa} = N \\times f_{aa} = 1000 \\times 0.4225 = 422.5$。\n预期计数的总和为 $122.5 + 455 + 422.5 = 1000$，与 $N$ 相符。所有预期计数均远大于 $5$，满足 $\\chi^2$ 检验的假设。\n\n现在我们可以使用以下公式计算 $\\chi^2$ 统计量：\n$$\\chi^{2}=\\sum_{g \\in \\{AA,Aa,aa\\}} \\frac{(O_{g}-E_{g})^{2}}{E_{g}}$$\n\n代入观测值（$O_g$）和预期值（$E_g$）：\n$$\\chi^{2} = \\frac{(120 - 122.5)^{2}}{122.5} + \\frac{(460 - 455)^{2}}{455} + \\frac{(420 - 422.5)^{2}}{422.5}$$\n$$\\chi^{2} = \\frac{(-2.5)^{2}}{122.5} + \\frac{(5)^{2}}{455} + \\frac{(-2.5)^{2}}{422.5}$$\n$$\\chi^{2} = \\frac{6.25}{122.5} + \\frac{25}{455} + \\frac{6.25}{422.5}$$\n\n现在我们计算每一项的值：\n-   第一项：$\\frac{6.25}{122.5} \\approx 0.0510204$\n-   第二项：$\\frac{25}{455} \\approx 0.0549451$\n-   第三项：$\\frac{6.25}{422.5} \\approx 0.0147929$\n\n将各项相加得出 $\\chi^2$ 值：\n$$\\chi^{2} \\approx 0.0510204 + 0.0549451 + 0.0147929 = 0.1207584$$\n\n问题要求将答案四舍五入至 $4$ 位有效数字。\n$$\\chi^{2} \\approx 0.1208$$", "answer": "$$\\boxed{0.1208}$$", "id": "4747024"}]}