{"hands_on_practices": [{"introduction": "临床算法，即医生用来辅助决策的数学公式，并非天生中立。本练习将探讨肾功能评估中的“种族校正”问题，通过计算揭示这种做法如何具体地导致非裔患者获得专科转诊的延迟，从而量化算法偏见对医疗保健的实际影响。[@problem_id:4763904] 该计算将帮助我们理解，一个看似微小的数学调整如何能在现实世界中产生重大的健康不平等后果。", "problem": "医学史学家分析了临床方程中嵌入的种族调整如何影响诊断阈值和医疗服务的可及性。以历史上在估算肾小球滤过率 (eGFR) 中使用的种族系数为例，实验室对被归类为黑人的患者，将其 eGFR 乘以一个 $1.16$ 的系数。$3$ 期慢性肾脏病 (CKD) 被广泛定义为 eGFR 阈值低于每分钟每 $1.73$ m$^{2}$ $60$ 毫升。假设在时间 $t=0$ 时，两个医疗系统对两名其他方面完全相同的成年患者（年龄、性别、体型和血清肌酐水平相同）进行评估：一个系统报告的是不区分种族的 eGFR，另一个系统则因为患者被记录为黑人而应用了 $1.16$ 的乘数。在 $t=0$ 时，不区分种族的 eGFR（即在没有任何种族乘数的系统中会报告的数值）为每分钟每 $1.73$ m$^{2}$ $59$ 毫升。一个广泛使用的操作策略是，当报告的 eGFR 首次降至每分钟每 $1.73$ m$^{2}$ $60$ 毫升以下时，自动触发肾脏病专科转诊。假设潜在的不区分种族的 eGFR 随时间线性下降，其函数为 $E_{\\mathrm{neutral}}(t)=E_{0}-r t$，其中在 $t=0$ 时 $E_{0}=59$（单位：毫升/分钟/$1.73$ m$^{2}$），恒定下降率为每年 $r=3$（单位：毫升/分钟/$1.73$ m$^{2}$）。经过种族调整的系统报告的 eGFR 为 $E_{\\mathrm{race}}(t)=k\\,E_{\\mathrm{neutral}}(t)$，其中 $k=1.16$。请仅使用这些定义和假设，从第一性原理出发，推导并计算不区分种族的系统触发转诊和经过种族调整的系统触发转诊之间的时间延迟 $\\Delta t$（以年为单位）。将您的答案四舍五入至四位有效数字。用年作单位表达您的答案。", "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 用于估算肾小球滤过率 (eGFR) 的种族系数，对于被归类为黑人的患者，该系数因子为 $k = 1.16$。\n- $3$ 期慢性肾脏病 (CKD) 的定义是 eGFR 阈值低于每分钟每 $1.73$ m$^{2}$ $60$ 毫升。\n- 当报告的 eGFR 首次降至每分钟每 $1.73$ m$^{2}$ $60$ 毫升以下时，会自动触发肾脏病专科转诊。\n- 在时间 $t=0$ 时，不区分种族的 eGFR 为 $E_0 = 59$ 毫升/分钟/$1.73$ m$^{2}$。\n- 潜在的不区分种族的 eGFR 随时间线性下降，函数为 $E_{\\mathrm{neutral}}(t) = E_0 - r t$。\n- 恒定下降率为每年 $r=3$（单位：毫升/分钟/$1.73$ m$^{2}$）。\n- 经过种族调整的系统报告的 eGFR 为 $E_{\\mathrm{race}}(t) = k \\, E_{\\mathrm{neutral}}(t)$，其中 $k=1.16$。\n- 目标是计算两个系统触发转诊时间之间的时间延迟 $\\Delta t$（以年为单位）。\n- 最终答案必须四舍五入到四位有效数字。\n\n### 步骤 2：使用已知条件进行验证\n1.  **科学基础**：该问题基于在临床算法中使用基于种族的调整这一真实世界的医疗实践。eGFR 阈值 ($60$) 和用于 MDRD 及 CKD-EPI 方程的种族乘数 ($1.16$) 的具体数值在历史上是准确的。eGFR 的线性下降是为模拟慢性病随时间进展而采用的一种有效且常见的简化模型。该问题不违反任何科学或数学原理。\n2.  **适定性**：该问题提供了确定唯一解所需的所有必要定义、变量和常数。描述 eGFR 下降的函数以及转诊阈值均已明确给出。\n3.  **客观性**：问题陈述以定量和客观的方式呈现，描述了一个历史和临床情景，不含主观性语言或偏见。\n\n### 步骤 3：结论与措施\n该问题是有效的，因为它具有科学基础、适定性和客观性。将按照指定要求，从第一性原理推导解答。\n\n### 解题推导\n该问题要求计算两个不同系统触发肾脏病专科转诊之间的时间延迟 $\\Delta t$：一个系统使用不区分种族的 eGFR，另一个使用经过种族调整的 eGFR。\n\n设 eGFR 的转诊阈值为 $E_{\\mathrm{threshold}} = 60$ 毫升/分钟/$1.73$ m$^{2}$。当报告的 eGFR 首次降至此值以下时，触发转诊。\n\n首先，考虑不区分种族的系统。在时间 $t$ 报告的 eGFR 由以下函数给出：\n$$E_{\\mathrm{neutral}}(t) = E_0 - rt$$\n给定值为 $E_0 = 59$ 和每年 $r = 3$ 个单位。在初始时间 $t=0$ 时，eGFR 为：\n$$E_{\\mathrm{neutral}}(0) = E_0 - r(0) = 59$$\n由于 $E_{\\mathrm{neutral}}(0) = 59  E_{\\mathrm{threshold}} = 60$，转诊条件在观察期一开始就已满足。因此，不区分种族的系统的转诊时间 $t_1$ 为：\n$$t_1 = 0 \\text{ years}$$\n\n接下来，考虑经过种族调整的系统。对于被归类为黑人的患者，报告的 eGFR 由以下公式给出：\n$$E_{\\mathrm{race}}(t) = k \\cdot E_{\\mathrm{neutral}}(t)$$\n其中 $k = 1.16$。代入 $E_{\\mathrm{neutral}}(t)$ 的表达式，我们得到：\n$$E_{\\mathrm{race}}(t) = k(E_0 - rt)$$\n在初始时间 $t=0$ 时，经过种族调整的 eGFR 为：\n$$E_{\\mathrm{race}}(0) = k \\cdot E_0 = 1.16 \\times 59 = 68.44$$\n由于 $E_{\\mathrm{race}}(0) = 68.44 > E_{\\mathrm{threshold}} = 60$，在 $t=0$ 时不会触发转诊。转诊将在稍后的时间 $t_2$ 触发，即当 eGFR 首次降至阈值以下时。由于 $E_{\\mathrm{race}}(t)$ 是一个关于时间的连续递减函数，这恰好发生在 $E_{\\mathrm{race}}(t_2) = E_{\\mathrm{threshold}}$ 的时刻。\n$$k(E_0 - rt_2) = E_{\\mathrm{threshold}}$$\n我们现在求解该方程以得出 $t_2$。\n$$E_0 - rt_2 = \\frac{E_{\\mathrm{threshold}}}{k}$$\n$$rt_2 = E_0 - \\frac{E_{\\mathrm{threshold}}}{k}$$\n$$t_2 = \\frac{1}{r} \\left( E_0 - \\frac{E_{\\mathrm{threshold}}}{k} \\right)$$\n\n转诊的延迟时间 $\\Delta t$ 是两个转诊时间之差：\n$$\\Delta t = t_2 - t_1$$\n由于 $t_1 = 0$，延迟时间即为：\n$$\\Delta t = t_2 = \\frac{1}{r} \\left( E_0 - \\frac{E_{\\mathrm{threshold}}}{k} \\right)$$\n现在，我们代入问题陈述中提供的数值：$E_0 = 59$， $r=3$， $E_{\\mathrm{threshold}}=60$ 和 $k=1.16$。\n$$\\Delta t = \\frac{1}{3} \\left( 59 - \\frac{60}{1.16} \\right)$$\n首先，我们计算商：\n$$\\frac{60}{1.16} \\approx 51.7241379...$$\n接下来，我们进行括号内的减法运算：\n$$59 - 51.7241379... \\approx 7.2758620...$$\n最后，我们除以 $r=3$：\n$$\\Delta t = \\frac{7.2758620...}{3} \\approx 2.4252873... \\text{ years}$$\n问题要求答案四舍五入到四位有效数字。\n$$\\Delta t \\approx 2.425 \\text{ years}$$", "answer": "$$\n\\boxed{2.425}\n$$", "id": "4763904"}, {"introduction": "在分析医学数据时，忽视如社会隔离等结构性因素，可能导致错误的结论。本练习将利用一个经典的统计学悖论——辛普森悖论——来说明，汇总数据表面上可能显示出不同族裔间治疗效果的差异，但一旦我们考虑到不同医院的治疗质量和病例严重程度等混杂变量，这种差异便会消失。[@problem_id:4763912] 这个练习旨在培养批判性分析数据的能力，理解社会背景如何扭曲统计结果。", "problem": "在医学史上，汇总的管理数据有时被用来论证某种疗法在某个社会定义的种族群体中不如在另一个群体中有效，这些说法后来被批评为病例组合和制度性隔离造成的人为结果，而非生物学原因。考虑一个历史上可能发生的情景：所有因社区获得性肺炎住院的患者都统一使用同一种抗生素治疗。有两家医院：A医院，通常收治病情较轻的病例，治愈比例较高；B医院，通常收治病情较重的病例，治愈比例较低。由于隔离时代的转诊模式，社会定义的白人患者和黑人患者在两家医院的分布不均。\n\n假设在相同抗生素治疗下，记录了以下治愈（定义为三十天内出院存活且未复发）的计数：\n\n- A医院（病情较轻的病例组合）：白人患者：$100$名接受治疗的患者中有$90$名治愈；黑人患者：$50$名接受治疗的患者中有$45$名治愈。\n- B医院（病情较重的病例组合）：白人患者：$50$名接受治疗的患者中有$30$名治愈；黑人患者：$100$名接受治疗的患者中有$60$名治愈。\n\n任务：\n1) 仅使用风险（治愈比例）和风险差（风险之差）的基本定义，计算治愈比例的粗略（跨医院合并）风险差，定义为 $p_{\\text{White, pooled}} - p_{\\text{Black, pooled}}$。用小数表示。\n\n2) 使用Mantel–Haenszel (MH) 方法计算跨层（医院）的共同风险差，将风险差的分层估计值 $RD_{\\text{MH}}$ 计算为单个层内合并估计值。用小数表示。\n\n将最终答案以一个行矩阵的形式报告，包含两个条目，顺序为：（粗略风险差，MH共同风险差）。如果结果为精确小数，则无需四舍五入。不需要单位。", "solution": "首先根据所需标准对问题进行验证。\n\n### 第1步：提取已知信息\n- A医院数据（病情较轻的病例组合）：\n  - 白人患者：$100$名接受治疗的患者中有$90$名治愈。\n  - 黑人患者：$50$名接受治疗的患者中有$45$名治愈。\n- B医院数据（病情较重的病例组合）：\n  - 白人患者：$50$名接受治疗的患者中有$30$名治愈。\n  - 黑人患者：$100$名接受治疗的患者中有$60$名治愈。\n- 风险的定义：治愈比例。\n- 风险差（$RD$）的定义：风险之差。\n- 任务1：计算粗略风险差，$p_{\\text{White, pooled}} - p_{\\text{Black, pooled}}$。\n- 任务2：计算跨层（医院）的Mantel–Haenszel共同风险差，$RD_{\\text{MH}}$。\n- 最终答案的格式要求：一个包含两个条目的行矩阵：（粗略风险差，MH共同风险差）。\n\n### 第2步：使用提取的已知信息进行验证\n- **科学依据**：该问题呈现了流行病学和生物统计学中的一个经典情景，即辛普森悖论。所要求的方法——计算粗略风险差和Mantel–Haenszel分层风险差——是用于分析存在潜在混杂因素数据的标准、成熟的统计技术。该情景在历史上是合理的，并可作为统计学原理的有效例证。\n- **问题明确**：该问题提供了进行所需计算的所有必要数值数据和清晰定义。问题具体，可得出唯一的、可验证的解。\n- **客观性**：问题以精确、定量的术语陈述，没有主观性语言或偏见。\n\n### 第3步：结论与行动\n该问题具有科学依据、问题明确、客观，并包含完整解答所需的所有信息。因此，该问题被视为**有效**。我们继续进行解答。\n\n### 任务1：粗略（合并）风险差\n\n为计算粗略风险差，我们首先将两家医院中每个组（白人患者和黑人患者）的数据合并。\n\n对于白人患者组：\n- 接受治疗的总患者数：$N_{\\text{White, pooled}} = 100 (\\text{A医院}) + 50 (\\text{B医院}) = 150$。\n- 治愈的总患者数：$C_{\\text{White, pooled}} = 90 (\\text{A医院}) + 30 (\\text{B医院}) = 120$。\n\n白人患者的粗略治愈比例（风险）为：\n$$p_{\\text{White, pooled}} = \\frac{C_{\\text{White, pooled}}}{N_{\\text{White, pooled}}} = \\frac{120}{150} = \\frac{4}{5} = 0.8$$\n\n对于黑人患者组：\n- 接受治疗的总患者数：$N_{\\text{Black, pooled}} = 50 (\\text{A医院}) + 100 (\\text{B医院}) = 150$。\n- 治愈的总患者数：$C_{\\text{Black, pooled}} = 45 (\\text{A医院}) + 60 (\\text{B医院}) = 105$。\n\n黑人患者的粗略治愈比例（风险）为：\n$$p_{\\text{Black, pooled}} = \\frac{C_{\\text{Black, pooled}}}{N_{\\text{Black, pooled}}} = \\frac{105}{150} = \\frac{7}{10} = 0.7$$\n\n粗略风险差是这两个合并比例之差：\n$$RD_{\\text{crude}} = p_{\\text{White, pooled}} - p_{\\text{Black, pooled}} = 0.8 - 0.7 = 0.1$$\n这个粗略分析表明，白人患者的治愈比例高出$10$个百分点。\n\n### 任务2：Mantel–Haenszel (MH) 共同风险差\n\nMantel–Haenszel方法在调整了混杂变量（本例中为医院）后，提供了一个关联度量（本例中为风险差）的合并估计值。数据按医院分层。设第1组为白人患者，第0组为黑人患者。\n\n**第1层：A医院**\n- 接受治疗的白人患者数 ($n_{1A}$)：$100$。\n- 治愈的白人患者数 ($a_A$)：$90$。\n- 白人患者的治愈比例：$p_{1A} = \\frac{a_A}{n_{1A}} = \\frac{90}{100} = 0.9$。\n- 接受治疗的黑人患者数 ($n_{0A}$)：$50$。\n- 治愈的黑人患者数 ($c_A$)：$45$。\n- 黑人患者的治愈比例：$p_{0A} = \\frac{c_A}{n_{0A}} = \\frac{45}{50} = 0.9$。\n\nA医院的层特异性风险差为：\n$$RD_{A} = p_{1A} - p_{0A} = 0.9 - 0.9 = 0$$\n\n**第2层：B医院**\n- 接受治疗的白人患者数 ($n_{1B}$)：$50$。\n- 治愈的白人患者数 ($a_B$)：$30$。\n- 白人患者的治愈比例：$p_{1B} = \\frac{a_B}{n_{1B}} = \\frac{30}{50} = 0.6$。\n- 接受治疗的黑人患者数 ($n_{0B}$)：$100$。\n- 治愈的黑人患者数 ($c_B$)：$60$。\n- 黑人患者的治愈比例：$p_{0B} = \\frac{c_B}{n_{0B}} = \\frac{60}{100} = 0.6$。\n\nB医院的层特异性风险差为：\n$$RD_{B} = p_{1B} - p_{0B} = 0.6 - 0.6 = 0$$\n\nMantel–Haenszel共同风险差估计值 $RD_{\\text{MH}}$ 是层特异性风险差的加权平均值：\n$$RD_{\\text{MH}} = \\frac{\\sum_{i} w_i RD_i}{\\sum_{i} w_i}$$\n其中，索引 $i$ 代表层（A医院或B医院），$RD_i$ 是第 $i$ 层的风险差，$w_i$ 是第 $i$ 层的权重。标准权重为 $w_i = \\frac{n_{1i} n_{0i}}{N_i}$，其中 $N_i = n_{1i} + n_{0i}$ 是第 $i$ 层的总患者数。\n\nA医院的权重：\n$$w_A = \\frac{n_{1A}n_{0A}}{N_A} = \\frac{100 \\times 50}{100 + 50} = \\frac{5000}{150} = \\frac{100}{3}$$\n\nB医院的权重：\n$$w_B = \\frac{n_{1B}n_{0B}}{N_B} = \\frac{50 \\times 100}{50 + 100} = \\frac{5000}{150} = \\frac{100}{3}$$\n\n现在，我们计算Mantel–Haenszel共同风险差：\n$$RD_{\\text{MH}} = \\frac{w_A RD_A + w_B RD_B}{w_A + w_B} = \\frac{(\\frac{100}{3})(0) + (\\frac{100}{3})(0)}{\\frac{100}{3} + \\frac{100}{3}} = \\frac{0}{\\frac{200}{3}} = 0$$\n\n在调整了医院的混杂效应（该效应解释了病例组合严重程度和患者人口统计学上的差异）后，估计的共同风险差为 $0$。这表明，一旦考虑到医院因素，两组之间的治愈比例没有差异。粗略结果 ($0.1$) 与分层结果 ($0$) 之间的差异是辛普森悖论的一个明显实例。\n\n需要报告的两个结果是粗略风险差 ($0.1$) 和Mantel-Haenszel共同风险差 ($0$)。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1  0 \\end{pmatrix} } $$", "id": "4763912"}, {"introduction": "基因关联研究是强大的科学工具，但如果不恰当地考虑人群历史，其结果很容易被误读。本练习将深入探讨“人群分层”这一核心统计学问题，通过数学方法揭示一个非致病性的基因标记如何因与祖源相关的混杂因素而看似与某种疾病相关联。[@problem_id:4763896] 通过这个练习，我们将学会如何识别并校正这种统计学假象，从而理解为何将复杂的健康结果简单归因于遗传是存在问题的。", "problem": "医学史的一个主要教训是，通过科学种族主义的视角来解释的基因标记与疾病之间的粗略关联，常常被误读为先天生物学差异的证据，而非环境和社会因素的后果。在基因关联研究中，这种误读背后的一个机制是群体分层，即祖源差异同时影响了等位基因频率和疾病风险。考虑一个简化的双祖源混合模型，以说明祖源混杂如何能在基因标记和疾病结果之间引起虚假关联。\n\n令 $A \\in \\{0,1\\}$ 表示祖源，其中 $A=1$ 代表历史上曾遭受与较高疾病风险相关的歧视性条件影响的祖源，而 $A=0$ 代表另一个祖源。假设 $P(A=1)=P(A=0)=0.5$。令 $G \\in \\{0,1\\}$ 表示是否携带某个基因标记。令 $Y \\in \\{0,1\\}$ 表示是否患有某种疾病。假设由于非遗传因素，疾病风险因祖源而异，但在每个祖源内部，该基因标记与疾病并无因果关系。形式上，假设条件独立性 $Y \\perp G \\,|\\, A$。假设有以下经验上合理的量：\n- $P(G=1 \\mid A=1) = 0.8$ 且 $P(G=1 \\mid A=0) = 0.2$，\n- $P(Y=1 \\mid A=1) = 0.30$ 且 $P(Y=1 \\mid A=0) = 0.10$。\n\n第一部分：使用全期望定律和协方差的定义，从忽略祖源的线性概率模型 $Y = \\alpha + \\beta G + \\varepsilon$ 中计算朴素线性回归系数 $\\beta_{\\text{naive}}$。具体来说，从第一性原理推导 $\\operatorname{Cov}(Y,G)$ 和 $\\operatorname{Var}(G)$，并计算 $\\beta_{\\text{naive}} = \\operatorname{Cov}(Y,G)/\\operatorname{Var}(G)$。\n\n第二部分：用一两句话解释为什么第一部分中得到的关联是群体分层的体现，而不是 $G$ 对 $Y$ 的因果效应，并将其与医学史上科学种族主义对这类关联的历史性滥用联系起来。你的解释应引用假设 $Y \\perp G \\,|\\, A$ 以及祖源在构建 $P(G=1 \\mid A)$ 和 $P(Y=1 \\mid A)$ 中的作用。\n\n第三部分：为了校正分层效应，使用主成分分析（PCA; principal component analysis）将祖源的第一个主成分 $PC$ 定义为标准化的祖源指示变量 $PC = (A - \\mathbb{E}[A])/\\sqrt{\\operatorname{Var}(A)}$。证明 $PC \\in \\{-1,+1\\}$，且 $\\mathbb{E}[PC]=0$ 和 $\\operatorname{Var}(PC)=1$。考虑多元线性回归 $Y = \\alpha + \\beta_G G + \\beta_{PC} PC + \\varepsilon$。使用普通最小二乘法的正规方程以及方差和协方差的定义，推导出 $\\beta_G$ 关于 $\\operatorname{Cov}(Y,G)$、$\\operatorname{Cov}(Y,PC)$、$\\operatorname{Cov}(G,PC)$、$\\operatorname{Var}(G)$ 和 $\\operatorname{Var}(PC)$ 的闭式表达式。然后，根据给定参数计算 $\\beta_G$。提供 $\\beta_G$ 的最终数值。如果任何中间量需要数值计算，请提供精确的算术结果；最终答案无需四舍五入。", "solution": "该问题要求在一个简化的基因关联研究中对群体分层进行三部分分析。我们首先验证问题陈述。\n\n### 问题验证\n**步骤1：提取已知条件**\n-   变量：$A \\in \\{0,1\\}$ (祖源)，$G \\in \\{0,1\\}$ (基因标记)，$Y \\in \\{0,1\\}$ (疾病结果)。\n-   概率：\n    -   $P(A=1) = 0.5$, $P(A=0) = 0.5$。\n    -   $P(G=1 \\mid A=1) = 0.8$。\n    -   $P(G=1 \\mid A=0) = 0.2$。\n    -   $P(Y=1 \\mid A=1) = 0.30$。\n    -   $P(Y=1 \\mid A=0) = 0.10$。\n-   条件独立性假设：$Y \\perp G \\,|\\, A$。\n-   第一部分任务：对于模型 $Y = \\alpha + \\beta G + \\varepsilon$，计算 $\\beta_{\\text{naive}} = \\operatorname{Cov}(Y,G)/\\operatorname{Var}(G)$。\n-   第二部分任务：解释为何该关联是群体分层的体现。\n-   第三部分任务：定义 $PC = (A - \\mathbb{E}[A])/\\sqrt{\\operatorname{Var}(A)}$。证明 $PC \\in \\{-1,+1\\}$，$\\mathbb{E}[PC]=0$，$\\operatorname{Var}(PC)=1$。然后，在多元回归 $Y = \\alpha + \\beta_G G + \\beta_{PC} PC + \\varepsilon$ 中，推导 $\\beta_G$ 的公式并计算其值。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题使用了一个简化但标准且有效的统计模型来说明群体分层混杂的概念，这是统计遗传学和流行病学中一个公认的现象。其前提是科学合理的。\n-   **适定性：** 提供了所有必要的定义和概率。任务以数学精度进行规定，能够导出一个唯一且有意义的解。\n-   **客观性：** 问题以正式、客观的语言陈述。它在事实背景下引用了一个历史问题（科学种族主义），以此作为理解偏差的量化机制的动机。\n\n**步骤3：结论与行动**\n该问题是有效的。它具有科学依据，是适定的，完全指定且客观的。我们继续进行解答。\n\n### 第一部分：朴素回归系数\n朴素线性回归系数 $\\beta_{\\text{naive}}$ 由 $\\beta_{\\text{naive}} = \\frac{\\operatorname{Cov}(Y,G)}{\\operatorname{Var}(G)}$ 给出。我们必须计算协方差 $\\operatorname{Cov}(Y,G)$ 和方差 $\\operatorname{Var}(G)$。\n\n协方差定义为 $\\operatorname{Cov}(Y,G) = \\mathbb{E}[YG] - \\mathbb{E}[Y]\\mathbb{E}[G]$。变量 $Y$ 和 $G$ 是伯努利变量，因此它们的期望是它们取值为1的概率。我们使用全期望定律，以祖源 $A$ 为条件。\n\n首先，我们求 $G$ 的边际期望：\n$\\mathbb{E}[G] = P(G=1) = \\sum_{a \\in \\{0,1\\}} P(G=1 \\mid A=a) P(A=a)$\n$\\mathbb{E}[G] = P(G=1 \\mid A=1)P(A=1) + P(G=1 \\mid A=0)P(A=0)$\n$\\mathbb{E}[G] = (0.8)(0.5) + (0.2)(0.5) = 0.4 + 0.1 = 0.5$\n\n均值为 $p_G = \\mathbb{E}[G]$ 的伯努利变量 $G$ 的方差为 $p_G(1-p_G)$。\n$\\operatorname{Var}(G) = \\mathbb{E}[G](1-\\mathbb{E}[G]) = (0.5)(1 - 0.5) = 0.25$\n\n接着，我们求 $Y$ 的边际期望：\n$\\mathbb{E}[Y] = P(Y=1) = \\sum_{a \\in \\{0,1\\}} P(Y=1 \\mid A=a) P(A=a)$\n$\\mathbb{E}[Y] = P(Y=1 \\mid A=1)P(A=1) + P(Y=1 \\mid A=0)P(A=0)$\n$\\mathbb{E}[Y] = (0.30)(0.5) + (0.10)(0.5) = 0.15 + 0.05 = 0.20$\n\n现在，我们计算 $\\mathbb{E}[YG]$。由于 $Y$ 和 $G$ 是二元变量，$YG$ 也是二元变量，且 $\\mathbb{E}[YG] = P(Y=1, G=1)$。我们使用全概率定律，以 $A$ 为条件：\n$\\mathbb{E}[YG] = P(Y=1, G=1) = \\sum_{a \\in \\{0,1\\}} P(Y=1, G=1 \\mid A=a) P(A=a)$\n使用条件独立性假设 $Y \\perp G \\,|\\, A$，我们有 $P(Y=1, G=1 \\mid A=a) = P(Y=1 \\mid A=a) P(G=1 \\mid A=a)$。\n$\\mathbb{E}[YG] = P(Y=1 \\mid A=1)P(G=1 \\mid A=1)P(A=1) + P(Y=1 \\mid A=0)P(G=1 \\mid A=0)P(A=0)$\n$\\mathbb{E}[YG] = (0.30)(0.8)(0.5) + (0.10)(0.2)(0.5) = (0.24)(0.5) + (0.02)(0.5) = 0.12 + 0.01 = 0.13$\n\n最后，我们计算协方差：\n$\\operatorname{Cov}(Y,G) = \\mathbb{E}[YG] - \\mathbb{E}[Y]\\mathbb{E}[G] = 0.13 - (0.20)(0.5) = 0.13 - 0.10 = 0.03$\n\n现在我们可以计算朴素回归系数：\n$\\beta_{\\text{naive}} = \\frac{\\operatorname{Cov}(Y,G)}{\\operatorname{Var}(G)} = \\frac{0.03}{0.25} = \\frac{3/100}{25/100} = \\frac{3}{25} = 0.12$\n\n### 第二部分：虚假关联的解释\n非零系数 $\\beta_{\\text{naive}} = 0.12$ 是一个由群体分层混杂引起的虚假关联，并非基因标记 $G$ 对疾病 $Y$ 的因果效应。这是因为祖源变量 $A$ 是标记频率和疾病风险的共同原因，当 $A=1$ 时，$P(G=1|A)$ 和 $P(Y=1|A)$ 都更高，这导致了边际相关性，尽管问题明确假设了条件独立性（$Y \\perp G \\,|\\, A$）。历史上，在科学种族主义的框架下，这类虚假发现被误解为健康结果中存在先天遗传差异的“证据”，而忽略了作为差异真正驱动因素的潜在社会环境因素（在此由祖源 $A$ 代表）。\n\n### 第三部分：校正后的回归系数\n首先，我们分析主成分变量 $PC = (A - \\mathbb{E}[A])/\\sqrt{\\operatorname{Var}(A)}$。祖源变量 $A$ 是一个伯努利变量，其中 $P(A=1)=0.5$。\n$\\mathbb{E}[A] = 0.5$\n$\\operatorname{Var}(A) = P(A=1)(1-P(A=1)) = 0.5(1-0.5) = 0.25$\n$\\sqrt{\\operatorname{Var}(A)} = \\sqrt{0.25} = 0.5$\n因此，$PC = \\frac{A - 0.5}{0.5} = 2A - 1$。\n- 若 $A=0$，则 $PC = 2(0)-1 = -1$。\n- 若 $A=1$，则 $PC = 2(1)-1 = 1$。\n所以，$PC$ 的定义域确实是 $\\{-1, +1\\}$。\n期望为 $\\mathbb{E}[PC] = \\mathbb{E}[2A-1] = 2\\mathbb{E}[A]-1 = 2(0.5)-1 = 0$。\n方差为 $\\operatorname{Var}(PC) = \\operatorname{Var}(2A-1) = 2^2 \\operatorname{Var}(A) = 4(0.25) = 1$。\n\n对于多元线性回归模型 $Y = \\alpha + \\beta_G G + \\beta_{PC} PC + \\varepsilon$，普通最小二乘估计量 $\\beta_G$ 的闭式表达式为：\n$$ \\beta_G = \\frac{\\operatorname{Cov}(Y,G)\\operatorname{Var}(PC) - \\operatorname{Cov}(Y,PC)\\operatorname{Cov}(G,PC)}{\\operatorname{Var}(G)\\operatorname{Var}(PC) - [\\operatorname{Cov}(G,PC)]^2} $$\n因为我们已经证明 $\\operatorname{Var}(PC)=1$，这可以简化为：\n$$ \\beta_G = \\frac{\\operatorname{Cov}(Y,G) - \\operatorname{Cov}(Y,PC)\\operatorname{Cov}(G,PC)}{\\operatorname{Var}(G) - [\\operatorname{Cov}(G,PC)]^2} $$\n我们已经计算出 $\\operatorname{Cov}(Y,G) = 0.03$ 和 $\\operatorname{Var}(G) = 0.25$。我们需要计算 $\\operatorname{Cov}(Y,PC)$ 和 $\\operatorname{Cov}(G,PC)$。\n由于 $\\mathbb{E}[PC]=0$，协方差简化为：\n$\\operatorname{Cov}(Y,PC) = \\mathbb{E}[Y \\cdot PC] - \\mathbb{E}[Y]\\mathbb{E}[PC] = \\mathbb{E}[Y \\cdot PC]$。\n$\\operatorname{Cov}(G,PC) = \\mathbb{E}[G \\cdot PC] - \\mathbb{E}[G]\\mathbb{E}[PC] = \\mathbb{E}[G \\cdot PC]$。\n\n我们使用全期望定律计算 $\\mathbb{E}[Y \\cdot PC]$：\n$\\mathbb{E}[Y \\cdot PC] = \\mathbb{E}[\\mathbb{E}[Y \\cdot PC \\mid A]] = \\sum_{a \\in \\{0,1\\}} \\mathbb{E}[Y \\cdot (2a-1) \\mid A=a] P(A=a)$\n$\\mathbb{E}[Y \\cdot PC] = \\mathbb{E}[Y \\cdot (2(1)-1) \\mid A=1]P(A=1) + \\mathbb{E}[Y \\cdot (2(0)-1) \\mid A=0]P(A=0)$\n$\\mathbb{E}[Y \\cdot PC] = \\mathbb{E}[Y \\mid A=1]P(A=1) - \\mathbb{E}[Y \\mid A=0]P(A=0)$\n$\\mathbb{E}[Y \\cdot PC] = P(Y=1 \\mid A=1)P(A=1) - P(Y=1 \\mid A=0)P(A=0)$\n$\\mathbb{E}[Y \\cdot PC] = (0.30)(0.5) - (0.10)(0.5) = 0.15 - 0.05 = 0.10$。\n所以，$\\operatorname{Cov}(Y,PC) = 0.10$。\n\n我们用类似的方法计算 $\\mathbb{E}[G \\cdot PC]$：\n$\\mathbb{E}[G \\cdot PC] = \\mathbb{E}[G \\mid A=1]P(A=1) - \\mathbb{E}[G \\mid A=0]P(A=0)$\n$\\mathbb{E}[G \\cdot PC] = P(G=1 \\mid A=1)P(A=1) - P(G=1 \\mid A=0)P(A=0)$\n$\\mathbb{E}[G \\cdot PC] = (0.8)(0.5) - (0.2)(0.5) = 0.4 - 0.1 = 0.30$。\n所以，$\\operatorname{Cov}(G,PC) = 0.30$。\n\n现在我们将这些值代入 $\\beta_G$ 的公式中：\n$$ \\beta_G = \\frac{0.03 - (0.10)(0.30)}{0.25 - (0.30)^2} = \\frac{0.03 - 0.03}{0.25 - 0.09} = \\frac{0}{0.16} = 0 $$\n系数 $\\beta_G$ 恰好为零。这是预期的结果，因为在回归模型中包含主成分 $PC$（它是祖源 $A$ 的一个完美代理变量）正确地控制了混杂效应，从而揭示了在给定祖源条件下，基因标记 $G$ 与疾病 $Y$ 之间真实的零关联。", "answer": "$$\\boxed{0}$$", "id": "4763896"}]}