{"hands_on_practices": [{"introduction": "医疗保健领域中的算法和临床决策支持工具旨在提高效率和准确性。然而，如果不在设计和评估中仔细考虑公平性，这些工具可能会无意中延续甚至加剧现有的不平等。本练习将通过一个具体案例，教您如何使用混淆矩阵中的数据来计算关键的公平性指标（如假阴性率），从而量化算法在不同人群之间可能产生的不公平结果。[@problem_id:4866404]", "problem": "一个区域性卫生系统部署了一个二元临床决策支持工具，用于标记需要紧急随访的患者，这些患者所患的疾病如果漏诊会导致严重的发病。该工具在两个因社会经济背景而异的患者队列中分别进行评估：$G_1$ 组（来自历史上资源匮乏社区的患者）和 $G_2$ 组（来自资源充足社区的患者）。其伦理关切在于，该工具是否会因差异化的错误率而产生结构性不公平的结果，从而可能导致对 $G_1$ 组的治疗不足。\n\n您获得了在同一评估期内每个组的混淆矩阵计数如下：\n- 对于 $G_1$ 组：真阳性 $TP_1 = 186$，假阴性 $FN_1 = 54$，真阴性 $TN_1 = 672$，假阳性 $FP_1 = 88$。\n- 对于 $G_2$ 组：真阳性 $TP_2 = 205$，假阴性 $FN_2 = 35$，真阴性 $TN_2 = 701$，假阳性 $FP_2 = 59$。\n\n在算法公平性中，机会均等（Equal Opportunity, EO）要求真阳性率（True Positive Rate, TPR）在受保护的群体中相等。假阴性率（False Negative Rate, FNR）是分类器未能识别的实际阳性病例所占的比例。请使用这些定义和给定的计数，计算假阴性率之差，定义为 $FNR_{G_1} - FNR_{G_2}$。将您的最终数值答案四舍五入至四位有效数字。然后，基于基本原则，评估机会均等（EO）标准是否被违反，并结合此情境下 TPR 和 FNR 之间的关系简要说明您的评估理由。您最终方框内的答案必须是对应于 $FNR_{G_1} - FNR_{G_2}$ 的单一实数值，并按要求进行四舍五入。", "solution": "该问题要求计算两个患者组 $G_1$ 和 $G_2$ 之间假阴性率（$FNR$）的差异，并评估机会均等（EO）公平性标准是否被违反。\n\n首先，我们必须根据提供的混淆矩阵计数来定义相关指标：真阳性（$TP$）、假阴性（$FN$）、真阴性（$TN$）和假阳性（$FP$）。\n\n一个组中实际患有该病的个体总数（实际阳性病例）是真阳性和假阴性的总和。对于组 $i$，这表示为 $P_i$。\n$$P_i = TP_i + FN_i$$\n\n假阴性率（$FNR$）是被错误分类为阴性的实际阳性病例的比例。其定义为：\n$$FNR_i = \\frac{FN_i}{P_i} = \\frac{FN_i}{TP_i + FN_i}$$\n该指标量化了对于确实患有该疾病的患者的“漏诊”率。\n\n真阳性率（$TPR$），也称为灵敏度或召回率，是被正确分类为阳性的实际阳性病例的比例。其定义为：\n$$TPR_i = \\frac{TP_i}{P_i} = \\frac{TP_i}{TP_i + FN_i}$$\n该指标量化了对于确实患有该疾病的患者的“命中”率。\n\n$TPR$ 和 $FNR$ 之间存在一个基本关系：\n$$TPR_i + FNR_i = \\frac{TP_i}{TP_i + FN_i} + \\frac{FN_i}{TP_i + FN_i} = \\frac{TP_i + FN_i}{TP_i + FN_i} = 1$$\n因此，$FNR_i = 1 - TPR_i$。\n\n现在，我们将这些定义应用于 $G_1$ 组和 $G_2$ 组的给定数据。\n\n对于 $G_1$ 组：\n- $TP_1 = 186$\n- $FN_1 = 54$\n\n$G_1$ 组中的实际阳性病例数为：\n$$P_1 = TP_1 + FN_1 = 186 + 54 = 240$$\n$G_1$ 组的假阴性率为：\n$$FNR_{G_1} = \\frac{FN_1}{P_1} = \\frac{54}{240}$$\n\n对于 $G_2$ 组：\n- $TP_2 = 205$\n- $FN_2 = 35$\n\n$G_2$ 组中的实际阳性病例数为：\n$$P_2 = TP_2 + FN_2 = 205 + 35 = 240$$\n$G_2$ 组的假阴性率为：\n$$FNR_{G_2} = \\frac{FN_2}{P_2} = \\frac{35}{240}$$\n\n问题要求计算假阴性率之差，$FNR_{G_1} - FNR_{G_2}$。\n$$FNR_{G_1} - FNR_{G_2} = \\frac{54}{240} - \\frac{35}{240} = \\frac{54 - 35}{240} = \\frac{19}{240}$$\n\n为了得到数值，我们进行除法运算：\n$$\\frac{19}{240} \\approx 0.0791666...$$\n将此结果四舍五入至四位有效数字，得到：\n$$FNR_{G_1} - FNR_{G_2} \\approx 0.07917$$\n\n接下来，我们必须评估机会均等（EO）标准是否被违反。EO标准要求真阳性率（$TPR$）在受保护的群体之间相等。在本例中，它要求：\n$$TPR_{G_1} = TPR_{G_2}$$\n使用关系式 $TPR_i = 1 - FNR_i$，EO 条件可以等价地用假阴性率表示：\n$$1 - FNR_{G_1} = 1 - FNR_{G_2}$$\n这可以简化为：\n$$FNR_{G_1} = FNR_{G_2}$$\n让我们比较计算出的 FNR 值：\n$$FNR_{G_1} = \\frac{54}{240} = 0.225$$\n$$FNR_{G_2} = \\frac{35}{240} \\approx 0.14583$$\n由于 $0.225 \\neq 0.14583...$，我们有 $FNR_{G_1} \\neq FNR_{G_2}$。由此直接得出 $TPR_{G_1} \\neq TPR_{G_2}$，因此机会均等标准被违反。\n\n其理由植根于恒等式 $TPR + FNR = 1$。群体之间假阴性率的差异在数学上必然导致真阳性率的差异，这正是违反机会均等的定义。正的差值 $FNR_{G_1} - FNR_{G_2} > 0$ 表明，该临床决策支持工具对资源匮乏群体（$G_1$）的假阴性率高于资源充足群体（$G_2$）。这意味着，与来自 $G_2$ 的类似患者相比，一名来自 $G_1$ 且确实患有该疾病的患者更有可能被该工具漏诊，从而导致资源匮乏人群面临更高的治疗不足风险。这是该算法产生结构性不公平结果的一个明显例子。", "answer": "$$\\boxed{0.07917}$$", "id": "4866404"}, {"introduction": "隐性偏见通常在无意识的情况下影响决策，其在临床诊断中的作用尤其值得关注。信号检测理论（Signal Detection Theory, SDT）为我们提供了一个强大的数学框架，用以分析在不确定性下的决策过程。本练习将引导您运用 SDT 模型，将隐性偏见概念化为诊断阈值的偏移，并精确推导这种偏移如何导致对不同患者群体的假阳性和假阴性诊断率发生变化，从而揭示偏见在认知层面的作用机制。[@problem_id:4866513]", "problem": "一家医院使用标准化的诊断评分来决定是否对疑似脓毒症患者启动资源密集型干预。假设没有脓毒症的患者（“噪声”条件）的评分服从均值为$0$、方差为$1$的正态分布，而患有脓毒症的患者（“信号”条件）的评分服从均值为$d'$、方差为$1$的正态分布。如果评分至少达到决策标准$c$，临床医生就诊断为脓毒症（并启动干预）。在无偏倚的实践中，临床医生使用基线标准$c_{0}$。内隐偏见被建模为决策标准$c$的移动，且不伴随敏感性$d'$的任何变化。\n\n使用信号检测论（SDT），并从正态分布和决策规则的定义出发，完成以下任务：\n\n1. 根据上述等方差高斯模型，推导出假阳性率$\\mathrm{FPR}(c)$和假阴性率$\\mathrm{FNR}(c)$作为标准$c$和敏感性$d'$的函数。\n\n2. 考虑两个患者群体 A 和 B，他们的潜在评分分布相同（因此$d'$在各群体间相同），但经历不同的有偏倚的标准。设$d' = 1.0$和$c_{0} = 0.0$。由于内隐偏见和结构性不平等，A 群体的标准增加到$c_{A} = c_{0} + 0.5$，而 B 群体的标准减少到$c_{B} = c_{0} - 0.3$。对每个群体，计算假阳性率的变化$\\Delta \\mathrm{FPR} = \\mathrm{FPR}(c_{\\text{group}}) - \\mathrm{FPR}(c_{0})$和假阴性率的变化$\\Delta \\mathrm{FNR} = \\mathrm{FNR}(c_{\\text{group}}) - \\mathrm{FNR}(c_{0})$。\n\n3. 定义一个综合不平等指数\n$$\nS \\equiv \\left|\\Delta \\mathrm{FPR}_{A}\\right| + \\left|\\Delta \\mathrm{FNR}_{A}\\right| + \\left|\\Delta \\mathrm{FPR}_{B}\\right| + \\left|\\Delta \\mathrm{FNR}_{B}\\right| ,\n$$\n该指数总结了由于有偏倚的标准导致两个群体错误率变化的总幅度。数值计算$S$并将最终答案四舍五入到四位有效数字。所有率值和最终的$S$都以小数形式表示，不带任何百分号。", "solution": "问题陈述已经过验证，被认为是科学合理的、定义明确的且客观的。我们可以开始求解。\n\n该问题要求使用信号检测论（SDT）的框架来分析诊断错误率。我们面临一个有两种基本状态的场景：“噪声”（患者没有脓毒症）和“信号”（患者患有脓毒症）。这些状态的诊断评分由等方差的高斯分布建模。\n\n对于没有脓毒症的患者，其噪声分布是一个标准正态分布，其概率密度函数（PDF）表示为$f_N(x)$。\n$$\nf_N(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right)\n$$\n这对应于均值为$\\mu_N = 0$、方差为$\\sigma^2_N = 1$的正态分布，我们记为$\\mathcal{N}(0, 1)$。\n\n对于患有脓毒症的患者，其信号分布是一个均值为$d'$、方差为$1$的正态分布，其概率密度函数（PDF）表示为$f_S(x)$。\n$$\nf_S(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - d')^2}{2}\\right)\n$$\n这对应于正态分布$\\mathcal{N}(d', 1)$。参数$d'$表示敏感性或信号与噪声分布之间的分离度。\n\n如果观察到的评分$x$达到或超过决策标准$c$（即$x \\ge c$），则诊断为脓毒症。\n\n**1. 假阳性率和假阴性率的推导**\n\n假阳性率$\\mathrm{FPR}(c)$是在患者没有脓毒症（噪声条件）的情况下，被诊断为脓毒症（$x \\ge c$）的概率。这是噪声分布的概率密度函数从$c$到无穷大的曲线下面积。\n$$\n\\mathrm{FPR}(c) = P(x \\ge c \\,|\\, \\text{Noise}) = \\int_{c}^{\\infty} f_N(u) \\, du = \\int_{c}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) \\, du\n$$\n令$\\Phi(z)$为标准正态分布的累积分布函数（CDF），定义为$\\Phi(z) = \\int_{-\\infty}^{z} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2}\\right) \\, du$。$\\mathrm{FPR}(c)$的积分表示上尾概率，可以用CDF表示为：\n$$\n\\mathrm{FPR}(c) = 1 - \\Phi(c)\n$$\n\n假阴性率$\\mathrm{FNR}(c)$是在患者确实患有脓毒症（信号条件）的情况下，未被诊断为脓毒症（$x  c$）的概率。这是信号分布的概率密度函数从$-\\infty$到$c$的曲线下面积。\n$$\n\\mathrm{FNR}(c) = P(x  c \\,|\\, \\text{Signal}) = \\int_{-\\infty}^{c} f_S(u) \\, du = \\int_{-\\infty}^{c} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(u-d')^2}{2}\\right) \\, du\n$$\n为了计算这个积分，我们进行变量替换。令$z = u - d'$，这意味着$u = z + d'$且$du = dz$。积分的下限保持为$-\\infty$，上限变为$c - d'$。\n$$\n\\mathrm{FNR}(c) = \\int_{-\\infty}^{c-d'} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) \\, dz\n$$\n根据定义，这是在$c - d'$处求值的标准正态分布的累积分布函数。\n$$\n\\mathrm{FNR}(c) = \\Phi(c - d')\n$$\n\n**2. 错误率变化的计算**\n\n我们给定的参数是：敏感性$d' = 1.0$和基线标准$c_{0} = 0.0$。对于A群体，标准是$c_{A} = c_{0} + 0.5 = 0.5$。对于B群体，标准是$c_{B} = c_{0} - 0.3 = -0.3$。\n\n我们需要标准正态分布CDF $\\Phi(z)$的数值。我们将使用足够精度的值进行计算。\n$\\Phi(0.0) = 0.50000$\n$\\Phi(0.3) = 0.61791$\n$\\Phi(0.5) = 0.69146$\n$\\Phi(1.0) = 0.84134$\n$\\Phi(1.3) = 0.90320$\n\n利用属性$\\Phi(-z) = 1 - \\Phi(z)$，我们发现：\n$\\Phi(-0.3) = 1 - \\Phi(0.3) = 1 - 0.61791 = 0.38209$\n$\\Phi(-0.5) = 1 - \\Phi(0.5) = 1 - 0.69146 = 0.30854$\n$\\Phi(-1.0) = 1 - \\Phi(1.0) = 1 - 0.84134 = 0.15866$\n$\\Phi(-1.3) = 1 - \\Phi(1.3) = 1 - 0.90320 = 0.09680$\n\n首先，我们计算在$c_{0} = 0.0$时的基线错误率：\n$\\mathrm{FPR}(c_0) = 1 - \\Phi(0.0) = 1 - 0.50000 = 0.50000$\n$\\mathrm{FNR}(c_0) = \\Phi(c_0 - d') = \\Phi(0.0 - 1.0) = \\Phi(-1.0) = 0.15866$\n\n接下来，我们计算A群体在$c_{A} = 0.5$时的错误率：\n$\\mathrm{FPR}(c_A) = 1 - \\Phi(0.5) = 1 - 0.69146 = 0.30854$\n$\\mathrm{FNR}(c_A) = \\Phi(c_A - d') = \\Phi(0.5 - 1.0) = \\Phi(-0.5) = 0.30854$\n\n然后，我们计算B群体在$c_{B} = -0.3$时的错误率：\n$\\mathrm{FPR}(c_B) = 1 - \\Phi(-0.3) = 1 - (1 - \\Phi(0.3)) = \\Phi(0.3) = 0.61791$\n$\\mathrm{FNR}(c_B) = \\Phi(c_B - d') = \\Phi(-0.3 - 1.0) = \\Phi(-1.3) = 0.09680$\n\n现在，我们计算每个群体相对于基线的错误率变化（$\\Delta$）。\n对于A群体：\n$\\Delta \\mathrm{FPR}_{A} = \\mathrm{FPR}(c_A) - \\mathrm{FPR}(c_0) = 0.30854 - 0.50000 = -0.19146$\n$\\Delta \\mathrm{FNR}_{A} = \\mathrm{FNR}(c_A) - \\mathrm{FNR}(c_0) = 0.30854 - 0.15866 = 0.14988$\n\n对于B群体：\n$\\Delta \\mathrm{FPR}_{B} = \\mathrm{FPR}(c_B) - \\mathrm{FPR}(c_0) = 0.61791 - 0.50000 = 0.11791$\n$\\Delta \\mathrm{FNR}_{B} = \\mathrm{FNR}(c_B) - \\mathrm{FNR}(c_0) = 0.09680 - 0.15866 = -0.06186$\n\n**3. 综合不平等指数S的计算**\n\n综合不平等指数$S$定义为这些变化的绝对值之和。\n$$\nS \\equiv |\\Delta \\mathrm{FPR}_{A}| + |\\Delta \\mathrm{FNR}_{A}| + |\\Delta \\mathrm{FPR}_{B}| + |\\Delta \\mathrm{FNR}_{B}|\n$$\n代入计算出的值：\n$$\nS = |-0.19146| + |0.14988| + |0.11791| + |-0.06186|\n$$\n$$\nS = 0.19146 + 0.14988 + 0.11791 + 0.06186\n$$\n进行求和：\n$$\nS = 0.52111\n$$\n题目要求将最终答案四舍五入到四位有效数字。\n$$\nS \\approx 0.5211\n$$", "answer": "$$\n\\boxed{0.5211}\n$$", "id": "4866513"}]}