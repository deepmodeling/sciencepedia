{"hands_on_practices": [{"introduction": "基因的调控始于转录因子对顺式调控元件的识别，而这种识别是基于特定的DNA序列。为了量化这种相互作用，生物信息学中常用位置权重矩阵（PWM）来描述转录因子的结合偏好。通过这个练习[@problem_id:5034599]，您将亲手使用PWM计算一个候选DNA序列的对数奇比分（log-odds score），这是预测调控位点功能的一项核心技能。", "problem": "一个脱氧核糖核酸（DNA）顺式调控位点被假设与一个特定的转录因子（TF）结合，其结合特异性由一个位置权重矩阵（PWM）总结。该PWM编码了当TF结合时，在一个长度为$10$的模体（motif）的每个位置上，观察到每种核苷酸$\\{A, C, G, T\\}$的概率。假设各个位置之间符合标准的独立性近似。背景（非模体）核苷酸分布是均匀的，每种核苷酸的概率为$0.25$。\n\n该PWM（行代表核苷酸$A$、$C$、$G$和$T$；列代表位置$1$到$10$）如下：\n$$\n\\begin{pmatrix}\n0.65  0.15  0.10  0.10  0.55  0.25  0.20  0.25  0.60  0.70 \\\\\n0.15  0.60  0.10  0.15  0.20  0.50  0.10  0.10  0.20  0.10 \\\\\n0.10  0.15  0.70  0.10  0.15  0.15  0.60  0.10  0.10  0.10 \\\\\n0.10  0.10  0.10  0.65  0.10  0.10  0.10  0.55  0.10  0.10 \\\\\n\\end{pmatrix}\n$$\n\n一个来自基因启动子区域的候选$10$碱基位点是：\n$$\n\\text{ACGTACGTAA}.\n$$\n\n使用自然对数$\\ln$，计算该位点在PWM下相对于均匀背景模型的对数优势分（log-odds score）。将最终数值分数四舍五入到四位有效数字。然后，基于第一性原理，简要论证在顺式调控架构的背景下，该位点是否可能是一个功能性的TF结合位点。", "solution": "该问题是有效的，因为它科学地基于生物信息学和计算遗传学的原理，问题陈述清晰且提供了所有必要信息，并且表述客观。位置权重矩阵（PWM）的定义是正确的，每个位置的概率总和为$1.0$。\n\n对于一个长度为$L$的DNA序列$S = s_1s_2\\dots s_L$，其对数优势分是衡量该序列相对于背景核苷酸分布与一个模体匹配程度的指标。它通过计算每个位置的对数似然比之和得出。使用自然对数（$\\ln$），该分数由以下公式给出：\n$$ \\text{Score}(S) = \\sum_{j=1}^{L} \\ln\\left( \\frac{P(s_j | j, \\text{motif})}{P(s_j | \\text{background})} \\right) $$\n在这个问题中，序列长度为$L=10$。候选序列是$S = \\text{ACGTACGTAA}$。背景概率$P(s_j | \\text{background})$是均匀的，对于任何核苷酸其值均为$0.25$。模体概率$P(s_j | j, \\text{motif})$从给定的PWM中提取。\n\n让我们从PWM中找出序列$S = \\text{ACGTACGTAA}$中每个核苷酸的具体概率：\n对于位置$j=1$的$s_1 = A$：$P(A|1) = 0.65$\n对于位置$j=2$的$s_2 = C$：$P(C|2) = 0.60$\n对于位置$j=3$的$s_3 = G$：$P(G|3) = 0.70$\n对于位置$j=4$的$s_4 = T$：$P(T|4) = 0.65$\n对于位置$j=5$的$s_5 = A$：$P(A|5) = 0.55$\n对于位置$j=6$的$s_6 = C$：$P(C|6) = 0.50$\n对于位置$j=7$的$s_7 = G$：$P(G|7) = 0.60$\n对于位置$j=8$的$s_8 = T$：$P(T|8) = 0.55$\n对于位置$j=9$的$s_9 = A$：$P(A|9) = 0.60$\n对于位置$j=10$的$s_{10} = A$：$P(A|10) = 0.70$\n\n对数优势分是这些概率与背景概率$0.25$之比的自然对数之和：\n$$\n\\text{Score}(S) = \\ln\\left(\\frac{0.65}{0.25}\\right) + \\ln\\left(\\frac{0.60}{0.25}\\right) + \\ln\\left(\\frac{0.70}{0.25}\\right) + \\ln\\left(\\frac{0.65}{0.25}\\right) + \\ln\\left(\\frac{0.55}{0.25}\\right) + \\ln\\left(\\frac{0.50}{0.25}\\right) + \\ln\\left(\\frac{0.60}{0.25}\\right) + \\ln\\left(\\frac{0.55}{0.25}\\right) + \\ln\\left(\\frac{0.60}{0.25}\\right) + \\ln\\left(\\frac{0.70}{0.25}\\right)\n$$\n这可以简化并计算如下：\n$$\n\\text{Score}(S) = \\ln(2.6) + \\ln(2.4) + \\ln(2.8) + \\ln(2.6) + \\ln(2.2) + \\ln(2.0) + \\ln(2.4) + \\ln(2.2) + \\ln(2.4) + \\ln(2.8)\n$$\n利用属性$\\ln(a) + \\ln(b) = \\ln(ab)$，我们也可以将分数写为：\n$$\n\\text{Score}(S) = \\ln\\left( \\frac{0.65 \\cdot 0.60 \\cdot 0.70 \\cdot 0.65 \\cdot 0.55 \\cdot 0.50 \\cdot 0.60 \\cdot 0.55 \\cdot 0.60 \\cdot 0.70}{0.25^{10}} \\right)\n$$\n通过将各个对数比率项相加来进行计算：\n$$\n\\text{Score}(S) \\approx 0.95551 + 0.87547 + 1.02962 + 0.95551 + 0.78846 + 0.69315 + 0.87547 + 0.78846 + 0.87547 + 1.02962\n$$\n$$\n\\text{Score}(S) \\approx 8.86674\n$$\n四舍五入到四位有效数字，对数优势分为$8.867$。\n\n为了论证该位点是否可能具有功能性，我们来解释这个分数。一个正的对数优势分表明，该序列在模体模型下比在背景模型下更有可能出现。分数$8.867$是一个很大的正值。这意味着该序列由TF结合的模体模型产生的概率比由随机背景模型产生的概率大约$\\exp(8.867) \\approx 7100$倍。如此高的似然比强烈表明该序列是一个功能性结合位点的良好候选者。\n\n此外，通过检查PWM，我们可以发现共有序列（由每个位置上最可能的核苷酸构成的序列）是：位置1为A（$0.65$），位置2为C（$0.60$），位置3为G（$0.70$），位置4为T（$0.65$），位置5为A（$0.55$），位置6为C（$0.50$），位置7为G（$0.60$），位置8为T（$0.55$），位置9为A（$0.60$），位置10为A（$0.70$）。因此，共有序列是ACGTACGTAA，这与提供的候选序列完全相同。这意味着计算出的分数是该PWM可能得到的最高分。一个与共有模体完美匹配的序列，仅从序列分析的角度看，是功能性位点的最强候选者。虽然体内的功能还取决于其他因素，如染色质可及性以及与其他蛋白质的组合相互作用，但该序列本身与TF的特异性是理想匹配。因此，该位点非常有可能是一个功能性的TF结合位点。", "answer": "$$\\boxed{8.867}$$", "id": "5034599"}, {"introduction": "位于非编码区的单核苷酸多态性（SNP）并非总是“沉默”的，特别是当它们出现在增强子等关键调控区域时，可能显著影响基因表达水平。我们可以构建一个整合了信息论和生物物理学的模型，将DNA序列的改变（通过PWM分数衡量）与结合亲和力的变化乃至最终的转录输出水平联系起来。这个问题[@problem_id:5034611]将引导您完成这样一个多步推理过程，定量预测一个增强子SNP对基因表达的最终影响。", "problem": "增强子中的单核苷酸多态性（SNP）使转录因子（TF）的位置权重矩阵（PWM）得分降低了 $3$ bit。在序列特异性蛋白质-DNA 结合的信息论生物物理模型中，1 bit 对应于结合自由能 $k_{B}T \\ln 2$ 的变化，这意味着平衡缔合常数每 bit 变化一个因子 $2$。考虑一个处于平衡状态的单一 TF 结合位点，并为一个与医学相关的基因增强子假设以下有实验依据的条件：\n\n- 野生型 TF-增强子解离常数为 $5$ nM。\n- 游离核内 TF 浓度为 $20$ nM。\n- 该增强子的转录输出与其结合位点上 TF 的占据分数成线性比例。\n\n在这些假设下，将 PWM 得分降低 $3$ bit 视为与上述生物物理解释一致的平衡结合亲和力变化。使用质量作用平衡作为计算占据分数并将占据率与转录输出联系起来的基础，确定由 SNP 引起的转录速率的预测倍数变化（突变型相对于野生型）。将你的答案四舍五入到四位有效数字，并以不带单位的小数表示。", "solution": "该问题要求计算由于增强子元件中的单核苷酸多态性（SNP）导致的基因转录速率的预测倍数变化。解决方案需要应用生物物理化学和分子生物学的概念，特别是蛋白质-DNA 结合的质量作用模型及其与转录调控的关系。\n\n首先，我们建立转录因子（TF）在其 DNA 結合位点上的占据分数的模型。TF与单个位点的结合可以用平衡反应表示：\n$$\n\\text{TF} + \\text{DNA} \\rightleftharpoons \\text{TF-DNA}\n$$\n该反应的解离常数 $K_D$ 由下式给出：\n$$\nK_D = \\frac{[\\text{TF}][\\text{DNA}]}{[\\text{TF-DNA}]}\n$$\n其中 $[\\text{TF}]$ 是游离转录因子的浓度，$[\\text{DNA}]$ 是游离结合位点的浓度，$[\\text{TF-DNA}]$ 是结合复合物的浓度。\n\n占据分数 $\\theta$ 定义为被 TF 占据的总 DNA 結合位点的分数。它可以表示为：\n$$\n\\theta = \\frac{[\\text{TF-DNA}]}{[\\text{DNA}]_{\\text{total}}} = \\frac{[\\text{TF-DNA}]}{[\\text{DNA}] + [\\text{TF-DNA}]}\n$$\n通过将 $K_D$ 表达式重新排列为 $[\\text{DNA}] = \\frac{K_D [\\text{TF-DNA}]}{[\\text{TF}]}$ 并代入 $\\theta$ 的方程，或者更简单地通过代入 $[\\text{TF-DNA}] = \\frac{[\\text{TF}][\\text{DNA}]}{K_D}$，我们可以推导出占据分数的标准 Langmuir 等温线形式：\n$$\n\\theta = \\frac{[\\text{TF}]}{K_D + [\\text{TF}]}\n$$\n问题陈述转录输出（我们表示为 $T$）与占据分数成线性正比，$T \\propto \\theta$。因此，我们可以写成 $T = c \\cdot \\theta$，其中 $c$ 是比例常数。突变型相对于野生型的转录速率的倍数变化是它们各自占据分数的比率：\n$$\n\\text{倍数变化} = \\frac{T_{\\text{mut}}}{T_{\\text{wt}}} = \\frac{c \\cdot \\theta_{\\text{mut}}}{c \\cdot \\theta_{\\text{wt}}} = \\frac{\\theta_{\\text{mut}}}{\\theta_{\\text{wt}}}\n$$\n\n接下来，我们计算野生型（wt）情况下的占据分数。给定的值为：\n- 野生型解离常数，$K_{D,wt} = 5$ nM。\n- 游离核内 TF 浓度，$[\\text{TF}] = 20$ nM。\n\n使用占据分数的公式：\n$$\n\\theta_{\\text{wt}} = \\frac{[\\text{TF}]}{K_{D,wt} + [\\text{TF}]} = \\frac{20 \\text{ nM}}{5 \\text{ nM} + 20 \\text{ nM}} = \\frac{20}{25} = 0.8\n$$\n\n现在，我们必须确定突变（mut）等位基因的解离常数。问题陈述 SNP 导致位置权重矩阵（PWM）得分降低了 $3$ bit。在所描述的信息论模型中，结合亲和力变化 $1$ bit 对应于平衡缔合常数 $K_A$ 变化一个因子 $2$。缔合常数是解离常数的倒数，$K_A = 1/K_D$。\n\nPWM 得分的降低意味着结合更弱。更弱的结合对应于更小的缔合常数（$K_A$）和更大的解離常数（$K_D$）。降低 $3$ bit 意味着缔合常数降低了 $2^3 = 8$ 倍。\n$$\nK_{A,mut} = \\frac{K_{A,wt}}{2^3} = \\frac{K_{A,wt}}{8}\n$$\n我们可以用解离常数来表示这一点：\n$$\n\\frac{1}{K_{D,mut}} = \\frac{1}{8 \\cdot K_{D,wt}}\n$$\n因此，突变型解离常数是野生型的 $8$ 倍：\n$$\nK_{D,mut} = 8 \\cdot K_{D,wt} = 8 \\cdot (5 \\text{ nM}) = 40 \\text{ nM}\n$$\n\n有了突变型解离常数，我们现在可以计算突变型情况下的占据分数，使用相同的游离 TF 浓度 $[\\text{TF}] = 20$ nM：\n$$\n\\theta_{\\text{mut}} = \\frac{[\\text{TF}]}{K_{D,mut} + [\\text{TF}]} = \\frac{20 \\text{ nM}}{40 \\text{ nM} + 20 \\text{ nM}} = \\frac{20}{60} = \\frac{1}{3}\n$$\n\n最后，我们将突变型与野生型占据分数的比率计算为转录速率的预测倍数变化：\n$$\n\\text{倍数变化} = \\frac{\\theta_{\\text{mut}}}{\\theta_{\\text{wt}}} = \\frac{1/3}{0.8} = \\frac{1/3}{4/5} = \\frac{1}{3} \\cdot \\frac{5}{4} = \\frac{5}{12}\n$$\n为了以四舍五入到四位有效数字的小数形式提供答案，我们进行除法运算：\n$$\n\\frac{5}{12} \\approx 0.416666...\n$$\n四舍五入到四位有效数字得到 $0.4167$。", "answer": "$$\\boxed{0.4167}$$", "id": "5034611"}, {"introduction": "基因表达的精确性不仅体现在转录的启动上，还体现在前体mRNA（pre-mRNA）的加工过程中，尤其是剪接过程的精确性。剪接体通过识别外显子与内含子边界的共有序列来保证外显子的正确连接。这个问题[@problem_id:5034577]模拟了一个影响剪接位点分数的单核苷酸变异，并要求您使用逻辑斯谛模型来预测其导致外显子跳跃的可能性，这有助于理解遗传性疾病中常见的分子机制。", "problem": "一个编码蛋白质的基因包含一个外显子，其$5^{\\prime}$供体剪接位点通过共有序列与U1小核核糖核蛋白复合物（U1 snRNP）的互补性被剪接体识别。供体位点识别强度由一个无量纲的剪接位点得分 $S$（例如，来自基于基序的模型的对数奇数比得分）来量化，该得分与外显子在前信使核糖核酸（pre-mRNA）剪接过程中被正确包含的概率单调相关。考虑一个位于供体位点$+5$位置的单核苷酸变异，该变异使野生型得分 $S_{\\mathrm{WT}}$ 减少其值的 $0.20$，因此变异型得分为 $S_{\\mathrm{VAR}} = (1 - 0.20) S_{\\mathrm{WT}}$。假设剪接保真度（正确包含外显子的概率）遵循一个饱和的S型关系，该关系与得分的逻辑斯蒂依赖性一致，并由一个斜率参数 $k$ 和一个阈值得分 $S_{0}$ 表征，在阈值得分 $S_{0}$ 处，外显子包含和跳跃的可能性相等。\n\n给定 $S_{\\mathrm{WT}} = 9.0$，$k = 1.2$（每得分单位），以及 $S_{0} = 8.5$，计算引入变异后外显子跳跃的可能性，以小数形式表示。将您的答案四舍五入到四位有效数字。不需要单位。", "solution": "用户提供的问题已经过评估并被确定为有效。该问题在科学上基于分子生物学和医学遗传学的原理，特别是关于pre-mRNA剪接以及遗传变异对此过程的影响。使用逻辑斯蒂函数来模拟剪接保真度是一种标准且适当的定量方法。该问题提法明确，提供了所有必要的参数和清晰的目标。没有内部矛盾、歧义或事实不准确之处。\n\n问题要求计算一个基因变异的外显子跳跃的可能性。我们已知正确包含外显子的概率 $P_{\\text{incl}}$ 遵循剪接位点得分 $S$ 的逻辑斯蒂依赖关系。逻辑斯蒂函数由一个斜率参数 $k$ 和一个阈值得分 $S_0$ 表征。对于一个范围从0到1的概率，该函数的一般形式是：\n$$\nP_{\\text{incl}}(S) = \\frac{1}{1 + \\exp(-k(S - S_{0}))}\n$$\n问题指明，$S_0$ 是外显子包含和跳跃可能性相等的得分，意味着 $P_{\\text{incl}}(S_0) = 0.5$。我们选择的函数满足这个条件：\n$$\nP_{\\text{incl}}(S_0) = \\frac{1}{1 + \\exp(-k(S_0 - S_0))} = \\frac{1}{1 + \\exp(0)} = \\frac{1}{1+1} = \\frac{1}{2} = 0.5\n$$\n提供的参数是：\n- 野生型得分，$S_{\\mathrm{WT}} = 9.0$。\n- 斜率参数，$k = 1.2$。\n- 阈值得分，$S_{0} = 8.5$。\n\n首先，我们必须计算变异型的得分 $S_{\\mathrm{VAR}}$。问题陈述该变异使野生型得分减少了其值的 $0.20$。\n$$\nS_{\\mathrm{VAR}} = S_{\\mathrm{WT}} \\times (1 - 0.20) = S_{\\mathrm{WT}} \\times 0.80\n$$\n代入 $S_{\\mathrm{WT}}$ 的值：\n$$\nS_{\\mathrm{VAR}} = 9.0 \\times 0.80 = 7.2\n$$\n接下来，我们将 $S = S_{\\mathrm{VAR}}$ 代入逻辑斯蒂函数，计算该变异得分的外显子包含概率 $P_{\\mathrm{VAR}}(\\text{incl})$：\n$$\nP_{\\mathrm{VAR}}(\\text{incl}) = \\frac{1}{1 + \\exp(-k(S_{\\mathrm{VAR}} - S_{0}))}\n$$\n所求的量是外显子跳跃的可能性 $P_{\\mathrm{VAR}}(\\text{skip})$。假设外显子包含和外显子跳跃是该外显子剪接事件仅有的两种可能结果，它们的概率之和必须为1。\n$$\nP_{\\mathrm{VAR}}(\\text{incl}) + P_{\\mathrm{VAR}}(\\text{skip}) = 1\n$$\n因此，外显子跳跃的可能性是：\n$$\nP_{\\mathrm{VAR}}(\\text{skip}) = 1 - P_{\\mathrm{VAR}}(\\text{incl})\n$$\n代入 $P_{\\mathrm{VAR}}(\\text{incl})$ 的表达式：\n$$\nP_{\\mathrm{VAR}}(\\text{skip}) = 1 - \\frac{1}{1 + \\exp(-k(S_{\\mathrm{VAR}} - S_{0}))} = \\frac{(1 + \\exp(-k(S_{\\mathrm{VAR}} - S_{0}))) - 1}{1 + \\exp(-k(S_{\\mathrm{VAR}} - S_{0}))} = \\frac{\\exp(-k(S_{\\mathrm{VAR}} - S_{0}))}{1 + \\exp(-k(S_{\\mathrm{VAR}} - S_{0}))}\n$$\n现在我们代入数值：$k=1.2$，$S_{\\mathrm{VAR}}=7.2$，以及 $S_0=8.5$。首先，我们计算指数项：\n$$\n-k(S_{\\mathrm{VAR}} - S_{0}) = -1.2 \\times (7.2 - 8.5) = -1.2 \\times (-1.3) = 1.56\n$$\n现在，我们将这个值代回 $P_{\\mathrm{VAR}}(\\text{skip})$ 的表达式中：\n$$\nP_{\\mathrm{VAR}}(\\text{skip}) = \\frac{\\exp(1.56)}{1 + \\exp(1.56)}\n$$\n我们计算其数值：\n$$\n\\exp(1.56) \\approx 4.7588301\n$$\n$$\nP_{\\mathrm{VAR}}(\\text{skip}) \\approx \\frac{4.7588301}{1 + 4.7588301} = \\frac{4.7588301}{5.7588301} \\approx 0.8263560\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nP_{\\mathrm{VAR}}(\\text{skip}) \\approx 0.8264\n$$\n这就是引入变异后外显子跳跃的可能性。", "answer": "$$\\boxed{0.8264}$$", "id": "5034577"}]}