{"hands_on_practices": [{"introduction": "理解ctDNA检测的临床效用，并不仅仅取决于其灵敏度和特异性。本练习将引导你从第一性原理出发，推导阳性预测值（PPV），揭示疾病患病率如何深刻影响检测在真实世界中的表现。通过这个计算[@problem_id:5053056]，你将对为何在无症状人群中筛查罕见癌症是一个重大的统计学挑战，获得一个批判性的视角。", "problem": "一家医院采用基于循环肿瘤脱氧核糖核酸 (ctDNA) 的液体活检技术，对无症状人群进行筛查，以检测与某种早期癌症相关的特定、可操作的驱动突变。假设检测结果为二元分类（阳性或阴性），疾病状态也为二元（存在或不存在携带突变的癌症）。设 $s$ 表示检测的灵敏度，定义为在疾病存在的情况下检测结果为阳性的概率；设 $c$ 表示检测的特异度，定义为在疾病不存在的情况下检测结果为阴性的概率；设 $\\pi$ 表示患病率，定义为在该筛查人群中检测前疾病存在的概率。\n\n从灵敏度、特异度和患病率的核心定义出发，并结合使用全概率公式和贝叶斯定理，推导出阳性预测值 (PPV) $P(\\text{疾病} \\mid \\text{检测阳性})$ 和阴性预测值 (NPV) $P(\\text{无疾病} \\mid \\text{检测阴性})$ 作为 $s$、$c$ 和 $\\pi$ 的函数的解析表达式。然后，对于一个 ctDNA 检测，其特征为灵敏度 $s=0.75$，特异度 $c=0.99$，在筛查人群中的患病率 $\\pi=0.005$，计算其 PPV。将 PPV 以小数形式表示，并四舍五入至四位有效数字。", "solution": "该问题是有效的。它在科学上基于概率论原理及其在医学诊断中的应用，这是流行病学和医学遗传学的核心概念。该问题提法得当，提供了推导所需表达式和计算最终值所需的所有必要定义（$s$, $c$, $\\pi$）和数据。其语言客观，参数对于所描述的场景是现实的。\n\n我们首先根据问题陈述正式定义事件。\n设 $D$ 为疾病（携带突变的癌症）存在的事件。\n设 $D^c$ 为疾病不存在的事件。\n设 $T^+$ 为检测结果为阳性的事件。\n设 $T^-$ 为检测结果为阴性的事件。\n\n问题以条件概率的语言提供了以下定义：\n患病率 $\\pi$ 是患有该疾病的先验概率：\n$$ \\pi = P(D) $$\n由此，不患该疾病的概率为：\n$$ P(D^c) = 1 - P(D) = 1 - \\pi $$\n灵敏度 $s$ 是在疾病存在的情况下检测为阳性的概率：\n$$ s = P(T^+ \\mid D) $$\n这意味着在疾病存在的情况下检测为阴性（假阴性）的概率是：\n$$ P(T^- \\mid D) = 1 - P(T^+ \\mid D) = 1 - s $$\n特异度 $c$ 是在疾病不存在的情况下检测为阴性的概率：\n$$ c = P(T^- \\mid D^c) $$\n这意味着在疾病不存在的情况下检测为阳性（假阳性）的概率是：\n$$ P(T^+ \\mid D^c) = 1 - P(T^- \\mid D^c) = 1 - c $$\n\n任务是推导阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式。\n\n**阳性预测值 (PPV) 的推导**\nPPV 定义为在检测结果为阳性的情况下疾病存在的概率，即 $P(D \\mid T^+)$。我们应用贝叶斯定理：\n$$ \\text{PPV} = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)} $$\n分子是灵敏度与患病率的乘积，即 $s \\pi$。分母 $P(T^+)$ 是检测结果为阳性的总概率。我们可以使用全概率公式，通过以疾病存在或不存在为条件来展开 $P(T^+)$：\n$$ P(T^+) = P(T^+ \\mid D) P(D) + P(T^+ \\mid D^c) P(D^c) $$\n将定义的术语代入此展开式可得：\n$$ P(T^+) = s \\pi + (1 - c)(1 - \\pi) $$\n这个分母表示真阳性 $P(T^+ \\mid D) P(D)$ 和假阳性 $P(T^+ \\mid D^c) P(D^c)$ 的总和。\n将这个 $P(T^+)$ 的表达式代回 PPV 的贝叶斯定理公式，得到最终的解析表达式：\n$$ \\text{PPV} = \\frac{s \\pi}{s \\pi + (1 - c)(1 - \\pi)} $$\n\n**阴性预测值 (NPV) 的推导**\nNPV 定义为在检测结果为阴性的情况下疾病不存在的概率，即 $P(D^c \\mid T^-)$。我们再次应用贝叶斯定理：\n$$ \\text{NPV} = P(D^c \\mid T^-) = \\frac{P(T^- \\mid D^c) P(D^c)}{P(T^-)} $$\n分子是特异度与无病概率的乘积，即 $c(1 - \\pi)$。分母 $P(T^-)$ 是检测结果为阴性的总概率。我们使用全概率公式展开 $P(T^-)$：\n$$ P(T^-) = P(T^- \\mid D^c) P(D^c) + P(T^- \\mid D) P(D) $$\n代入定义的术语可得：\n$$ P(T^-) = c(1 - \\pi) + (1 - s)\\pi $$\n这个分母表示真阴性 $P(T^- \\mid D^c) P(D^c)$ 和假阴性 $P(T^- \\mid D) P(D)$ 的总和。\n将这个 $P(T^-)$ 的表达式代回 NPV 的公式，得到最终的解析表达式：\n$$ \\text{NPV} = \\frac{c(1 - \\pi)}{c(1 - \\pi) + (1 - s)\\pi} $$\n\n**PPV 的计算**\n问题要求根据给定参数计算 PPV：\n灵敏度, $s = 0.75$\n特异度, $c = 0.99$\n患病率, $\\pi = 0.005$\n\n我们使用推导出的 PPV 公式：\n$$ \\text{PPV} = \\frac{s \\pi}{s \\pi + (1 - c)(1 - \\pi)} $$\n将数值代入表达式：\n$$ \\text{PPV} = \\frac{(0.75)(0.005)}{(0.75)(0.005) + (1 - 0.99)(1 - 0.005)} $$\n首先，计算各个项：\n人群中真阳性结果的概率是分子：\n$$ s \\pi = 0.75 \\times 0.005 = 0.00375 $$\n人群中假阳性结果的概率是分母中求和的第二项：\n$$ (1 - c)(1 - \\pi) = (0.01)(0.995) = 0.00995 $$\n现在，将这些值代回 PPV 公式：\n$$ \\text{PPV} = \\frac{0.00375}{0.00375 + 0.00995} $$\n$$ \\text{PPV} = \\frac{0.00375}{0.0137} $$\n进行除法运算：\n$$ \\text{PPV} \\approx 0.2737226277... $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\text{PPV} \\approx 0.2737 $$\n这个结果表明，对于该人群中收到阳性检测结果的个体，他们实际携带与癌症相关的突变的概率约为 $27.37\\%$。尽管特异度很高，但 PPV 较低，这是筛查罕见病症时的典型结果。", "answer": "$$ \\boxed{0.2737} $$", "id": "5053056"}, {"introduction": "循环肿瘤DNA并非一个静态的生物标志物；其在血液中的浓度反映了肿瘤脱落与身体清除之间的动态平衡。本练习将指导你建立一个简单的药代动力学模型，来描述ctDNA水平如何随时间变化，例如在外科手术等干预措施之后。掌握这一概念[@problem_id:5053009]对于理解如何利用液体活检监测治疗反应和检测疾病复发至关重要。", "problem": "在液体活检的背景下，循环肿瘤脱氧核糖核酸 (ctDNA) 是存在于血浆中的游离脱氧核糖核酸 (cfDNA) 的一个亚群。根据经验，cfDNA 通过一级动力学从血浆中清除，其典型半衰期在 $0.5$ 到 $2$ 小时之间。考虑一个单室、充分混合的血浆模型，其中 ctDNA 浓度（记为 $C(t)$）受肿瘤细胞死亡产生的输入与一级动力学清除之间的平衡所控制。设输入（来源）项为分段常数：在 $t=0$ 时刻进行手术干预之前，ctDNA 的输入速率为 $S_{0}$；手术后（$t \\geq 0$），输入速率突然降至一个更低的恒定值 $S_{1}$，其中 $S_1  S_0$，这反映了肿瘤细胞死亡的减少。假设系统在手术前处于稳态，并且在所考虑的时间范围内血浆体积是恒定的。\n\n从单室质量平衡的第一性原理以及半衰期为 $t_{1/2}$ 的一级清除过程的定义出发，推导 $t \\geq 0$ 时 $C(t)$ 的时间变化曲线的闭式解析表达式。最终答案仅用 $S_{0}$、$S_{1}$、$t_{1/2}$ 和 $t$ 表示。无需进行数值评估，最终表达式中不应包含任何单位。", "solution": "在单个充分混合的室中，ctDNA浓度 $C(t)$ 的时间演变由一个质量平衡常微分方程（ODE）描述，该方程表示浓度的变化率是输入速率 $S(t)$ 与清除速率之差。由于清除过程遵循一级动力学，其速率与浓度成正比，即 $kC(t)$，其中 $k$ 是一级速率常数。\n$$\n\\frac{dC(t)}{dt} = S(t) - kC(t)\n$$\n速率常数 $k$ 与半衰期 $t_{1/2}$ 之间的关系由一级衰减过程的定义给出：\n$$\nk = \\frac{\\ln(2)}{t_{1/2}}\n$$\n在手术干预之前（$t  0$），系统处于稳态，即 $\\frac{dC}{dt} = 0$，输入速率为 $S(t) = S_0$。因此，术前的稳态浓度 $C(0)$ 为：\n$$\n0 = S_0 - kC(0) \\implies C(0) = \\frac{S_0}{k}\n$$\n这是我们求解 $t \\geq 0$ 时段的初始条件。在手术后（$t \\geq 0$），输入速率变为 $S(t) = S_1$，常微分方程为：\n$$\n\\frac{dC(t)}{dt} = S_1 - kC(t)\n$$\n这是一个一阶线性非齐次常微分方程，可以整理为标准形式：\n$$\n\\frac{dC(t)}{dt} + kC(t) = S_1\n$$\n该方程的通解形式为瞬态解（齐次方程的解）和稳态解（特解）之和。齐次方程 $\\frac{dC_h}{dt} + kC_h = 0$ 的解是 $C_h(t) = A\\exp(-kt)$，其中 $A$ 是一个常数。特解是当 $t \\to \\infty$ 时的新的稳态浓度，即 $\\frac{S_1}{k}$。因此，通解为：\n$$\nC(t) = \\frac{S_1}{k} + A\\exp(-kt)\n$$\n我们使用初始条件 $C(0) = S_0/k$ 来确定常数 $A$：\n$$\nC(0) = \\frac{S_0}{k} = \\frac{S_1}{k} + A\\exp(0) \\implies A = \\frac{S_0}{k} - \\frac{S_1}{k} = \\frac{S_0 - S_1}{k}\n$$\n将 $A$ 的表达式代回通解，我们得到 $t \\geq 0$ 时的特定解：\n$$\nC(t) = \\frac{S_1}{k} + \\left(\\frac{S_0 - S_1}{k}\\right) \\exp(-kt)\n$$\n最后，我们将 $k = \\frac{\\ln(2)}{t_{1/2}}$ 代入，以得到仅用给定参数表示的最终表达式：\n$$\nC(t) = \\frac{S_1}{\\frac{\\ln(2)}{t_{1/2}}} + \\left(\\frac{S_0 - S_1}{\\frac{\\ln(2)}{t_{1/2}}}\\right) \\exp\\left(-\\frac{\\ln(2)}{t_{1/2}}t\\right)\n$$\n通过提出公因式 $\\frac{t_{1/2}}{\\ln(2)}$ 来简化：\n$$\nC(t) = \\frac{t_{1/2}}{\\ln(2)} \\left[ S_1 + (S_0 - S_1) \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right) \\right]\n$$\n这个表达式描述了 ctDNA 浓度如何从术前稳态水平 $S_0/k$ 指数衰减到新的术后稳态水平 $S_1/k$。", "answer": "$$\n\\boxed{\\frac{t_{1/2}}{\\ln(2)} \\left( S_1 + (S_0 - S_1) \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right) \\right)}\n$$", "id": "5053009"}, {"introduction": "检测微小残留病（MRD）的微弱信号是ctDNA最强大的应用之一，但它也挑战了分析灵敏度的极限。本练习探讨了应对这一挑战的统计学解决方案：多位点组合检测（panel-based testing）。你将推导出[@problem_id:5053050]，即便单个突变的等位基因频率极低，联合多个独立的肿瘤特异性突变信号也能显著提高检测出癌症的总体概率。", "problem": "一种基于循环肿瘤脱氧核糖核酸（ctDNA）液体活检的微小残留病（MRD）检测方法，追踪一组单核苷酸变异（SNV）。假设监测 $m$ 个独立的基因座，每个基因座的去重后独特分子标识符（UMI）深度为 $N$，真实变异等位基因频率（VAF）为 $p$。如果在某个基因座上观测到的突变分子数（记为 $X$）满足 $X \\geq t$，则该基因座被称为阳性，其中 $t$ 是一个固定的检测阈值。\n\n将单个基因座的读数抽样建模为 $X \\sim \\mathrm{Binomial}(N,p)$。对于小的 $p$ 和大的 $N$，使用泊松近似 $X \\approx \\mathrm{Poisson}(\\lambda)$，其中 $\\lambda = Np$。假设各个基因座的检测事件是独立的。\n\n从这些假设出发，推导每个基因座的检测概率 $q$（用 $\\lambda$ 和 $t$ 表示）的表达式，然后推导当追踪 $m$ 个基因座时，该检测组合检测到MRD（即至少一个基因座为阳性）的总体概率。最后，使用参数 $m = 8$、$N = 10{,}000$、$p = 2.0 \\times 10^{-4}$ 和 $t = 3$ 对此总体检测概率进行数值计算。将最终的灵敏度表示为不带单位的小数，并将答案四舍五入到四位有效数字。", "solution": "首先，我们推导在单个基因座上检测到信号的概率 $q$。\n一个基因座被视为阳性，如果观察到的突变分子数 $X$ 大于或等于阈值 $t$。根据泊松近似，$X \\sim \\mathrm{Poisson}(\\lambda)$，其中 $\\lambda = Np$。泊松分布的概率质量函数为 $P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$。\n检测概率 $q$ 是 $P(X \\geq t)$。计算其补集，即 $P(X  t)$，会更简单。\n$$\nP(X  t) = P(X=0) + P(X=1) + \\dots + P(X=t-1) = \\sum_{k=0}^{t-1} \\frac{\\lambda^k \\exp(-\\lambda)}{k!}\n$$\n因此，单个基因座的检测概率 $q$ 为：\n$$\nq = P(X \\geq t) = 1 - P(X  t) = 1 - \\exp(-\\lambda) \\sum_{k=0}^{t-1} \\frac{\\lambda^k}{k!}\n$$\n接下来，我们推导组合检测的总体概率 $P_{\\text{overall}}$。如果 $m$ 个独立基因座中至少有一个是阳性的，则发生检测。计算其补集，即所有 $m$ 个基因座均为阴性，会更方便。\n单个基因座为阴性的概率是 $1 - q$。由于各个基因座是独立的，所有 $m$ 个基因座均为阴性的概率是 $(1-q)^m$。\n因此，总体检测概率（至少一个为阳性）为：\n$$\nP_{\\text{overall}} = 1 - (1-q)^m\n$$\n最后，我们使用给定参数进行数值计算：$m = 8$, $N = 10,000$, $p = 2.0 \\times 10^{-4}$, $t = 3$。\n\n首先计算泊松参数 $\\lambda$：\n$$\n\\lambda = Np = (10,000) \\times (2.0 \\times 10^{-4}) = 2.0\n$$\n然后，用 $\\lambda = 2$ 和 $t=3$ 计算单个基因座的检测概率 $q$：\n$$\nq = 1 - \\exp(-2) \\sum_{k=0}^{3-1} \\frac{2^k}{k!} = 1 - \\exp(-2) \\left( \\frac{2^0}{0!} + \\frac{2^1}{1!} + \\frac{2^2}{2!} \\right)\n$$\n$$\nq = 1 - \\exp(-2) \\left( 1 + 2 + 2 \\right) = 1 - 5\\exp(-2)\n$$\n现在，计算总体检测概率 $P_{\\text{overall}}$：\n$$\nP_{\\text{overall}} = 1 - (1-q)^m = 1 - \\left(1 - (1 - 5\\exp(-2))\\right)^8 = 1 - (5\\exp(-2))^8\n$$\n$$\nP_{\\text{overall}} = 1 - 5^8 \\exp(-16)\n$$\n进行数值计算：\n$$\nP_{\\text{overall}} = 1 - 390625 \\times \\exp(-16) \\approx 1 - 390625 \\times (1.1253514 \\times 10^{-7})\n$$\n$$\nP_{\\text{overall}} \\approx 1 - 0.043959039...\n$$\n$$\nP_{\\text{overall}} \\approx 0.95604096...\n$$\n将结果四舍五入到四位有效数字，得到 $0.9560$。", "answer": "$$\n\\boxed{0.9560}\n$$", "id": "5053050"}]}