## 引言
许多常见疾病和人类性状，如身高、血压和精神分裂症，并非由单个基因决定，而是呈现出复杂的[遗传模式](@entry_id:137802)。这些[数量性状](@entry_id:144946)的变异为何在人群中呈[连续分布](@entry_id:264735)，而非孟德尔性状的离散类别？我们又该如何量化遗传和环境因素各自的贡献，并利用这些知识预测疾病风险、推断因果关系？这些是现代医学遗传学面临的核心问题。本文旨在系统性地回答这些问题，为读者构建一个关于多[基因结构](@entry_id:190285)与[数量遗传学](@entry_id:154685)的全面知识框架。

在接下来的内容中，我们将分三步深入探索这一领域。第一章 **“原理与机制”** 将从基础的加性模型出发，详细拆解[表型方差](@entry_id:274482)的组成部分，阐明[遗传力](@entry_id:151095)的核心概念，并介绍如何利用[连锁不平衡](@entry_id:146203)等原理从全基因组数据中剖析遗传结构。第二章 **“应用与跨学科交叉”** 将理论付诸实践，展示[数量遗传学](@entry_id:154685)原理如何在临床诊断（如责任[阈值模型](@entry_id:172428)）、流行病学因果推断（如孟德尔随机化）以及进化生物学中发挥作用，同时探讨多基因风险评分（PRS）面临的可移植性挑战与健康公平伦理问题。最后，第三章 **“动手实践”** 将通过具体的计算练习，帮助读者亲手操作，巩固从[双生子研究](@entry_id:263760)估计遗传力到构建和评估PRS的各项关键技能。

## 原理与机制

本章旨在阐述控制复杂[数量性状](@entry_id:144946)的[遗传原理](@entry_id:164016)和分子机制。我们将从最基本的模型出发，逐步构建一个全面的框架，用以理解遗传变异如何转化为我们在人群中观察到的连续[表型变异](@entry_id:163153)。我们将探讨如何量化遗传和环境因素对性状的贡献，如何从[全基因组](@entry_id:195052)数据中估计这些贡献，以及如何解释这些研究所揭示的复杂遗传结构。

### 数量性状的遗传结构

与遵循孟德尔遗传规律、通常表现为离散表型类别的单基因性状不同，大多数常见的医学性状，如身高、血压或血糖水平，都表现为**[数量性状](@entry_id:144946)**（quantitative traits）。这些性状在人群中呈连续或准[连续分布](@entry_id:264735)，其变异受到众多遗传位点（多基因）和环境因素的共同影响。

为了理解这种多[基因结构](@entry_id:190285)，我们可以从一个简单的**加性模型**（additive model）入手。假设一个数量性状 $y$ 的值由 $L$ 个遗传位点上的等位基因效应以及一个残余项 $e$ 线性叠加而成 [@problem_id:5071851]。对于一个个体，其表型值可以表示为：

$$y = \sum_{i=1}^{L} a_i x_i + e$$

在这个模型中：
- $i$ 代表从 $1$ 到 $L$ 的每一个双等位基因位点。
- $x_i$ 是在位点 $i$ 处次要等位基因的**基因型剂量**（genotype dosage），取值为 $\{0, 1, 2\}$，分别代表个体携带 0 个、1 个或 2 个次要等位基因。
- $a_i$ 是位点 $i$ 处每个次要等位基因的**加性效应**（additive effect），即每增加一个次要等位基因对表型值的平均贡献。
- $e$ 是一个**残余项**（residual），它捕捉了所有非遗传因素（[环境影响](@entry_id:161306)）、非加性遗传效应以及模型未能解释的其他随机变异。我们通常假设 $e$ 的[期望值](@entry_id:150961)为零，即 $\mathbb{E}[e] = 0$。

为了推导该性状在群体中的统计特性，我们需要引入一些标准假设。假设在一个大群体中，每个遗传位点都处于**哈迪-温伯格平衡**（Hardy-Weinberg Equilibrium, HWE），且各个位点之间不存在**[连锁不平衡](@entry_id:146203)**（Linkage Disequilibrium, LD），即它们是独立遗传的。如果位点 $i$ 的次要[等位基因频率](@entry_id:146872)为 $p_i$，那么根据 HWE，基因型剂量 $x_i$ 服从参数为 $n=2$ 和成功概率为 $p_i$ 的二项分布。

基于这些假设，我们可以计算群体中该性状的平均值和方差 [@problem_id:5071851]。

首先，性状的[期望值](@entry_id:150961)（群体均值）$\mathbb{E}[y]$ 为：
$$\mathbb{E}[y] = \mathbb{E}\left[\sum_{i=1}^{L} a_i x_i + e\right] = \sum_{i=1}^{L} a_i \mathbb{E}[x_i] + \mathbb{E}[e]$$
由于 $x_i$ 服从[二项分布](@entry_id:141181) $\text{Bin}(2, p_i)$，其[期望值](@entry_id:150961) $\mathbb{E}[x_i] = 2p_i$。又因为 $\mathbb{E}[e]=0$，我们得到：
$$\mathbb{E}[y] = \sum_{i=1}^{L} 2 p_i a_i$$

其次，性状的方差 $\operatorname{Var}(y)$ 为：由于各遗传位点和残余项 $e$ 相互独立，总方差等于各项方差之和：
$$\operatorname{Var}(y) = \operatorname{Var}\left(\sum_{i=1}^{L} a_i x_i + e\right) = \sum_{i=1}^{L} \operatorname{Var}(a_i x_i) + \operatorname{Var}(e) = \sum_{i=1}^{L} a_i^2 \operatorname{Var}(x_i) + \operatorname{Var}(e)$$
二项分布 $\text{Bin}(2, p_i)$ 的方差为 $2p_i(1-p_i)$。设残余方差 $\operatorname{Var}(e) = \sigma_e^2$，则总的[表型方差](@entry_id:274482)为：
$$\operatorname{Var}(y) = \sum_{i=1}^{L} 2 p_i (1-p_i) a_i^2 + \sigma_e^2$$
这一表达式明确显示，每个位点对总遗传方差的贡献取决于其[等位基因频率](@entry_id:146872)（通过 $2p_i(1-p_i)$ 项）和效应大小的平方（$a_i^2$）。

当影响性状的位点数量 $L$ 非常大，且每个位点的效应 $a_i$ 相对较小时，根据**中心极限定理**（Central Limit Theorem, CLT），遗传部分 $\sum a_i x_i$ 的分布将趋近于正态分布。因此，性状 $y$（一个近似正态分布的遗传组分与一个残[余项](@entry_id:159839)之和）在群体中的分布也近似为正态分布，呈现出经典的“钟形曲线”。这正是多基因数量性状区别于仅有两三个离散类别的单基因孟德尔性状的根本原因。

### 剖析[表型方差](@entry_id:274482)

上述加性模型为我们理解复杂性状提供了一个起点。然而，遗传的贡献并非总是简单的线性叠加。为了更精细地描述遗传结构，数量遗传学将观察到的总[表型方差](@entry_id:274482)（$V_P$）剖析为不同的组成部分。

最基本的剖分是将表型值 $P$ 分为遗传值 $G$ 和环境偏差 $E$ 两部分：

$$P = G + E$$

在理想情况下，即遗传与环境相互独立（不存在基因-环境相关性）且无相互作用时，总[表型方差](@entry_id:274482)可以简单地分解为遗传方差（$V_G$）和环境方差（$V_E$）之和 [@problem_id:5071852]：

$$V_P = V_G + V_E$$

这里的 $V_E$ 涵盖了所有非遗传因素的贡献，包括可改变的暴露（如饮食、药物）、不可测量的随机[发育噪音](@entry_id:169534)以及测量误差。

遗传方差 $V_G$ 本身还可以进一步细分。遗传值 $G$ 并非完全由等位基因的平均效应决定，它还包括了等位基因间的相互作用。标准的分解将 $V_G$ 分为三个部分：

$$V_G = V_A + V_D + V_I$$

- **[加性遗传方差](@entry_id:154158) ($V_A$)**：源于等位基因的**加性效应**（average effects），是能够稳定地从亲代传递给子代的遗传变异部分。它决定了亲子间的表型相似度以及群体对选择的响应。
- **[显性遗传方差](@entry_id:197376) ($V_D$)**：源于同一基因座上等位基因间的相互作用，即**显性**（dominance）。例如，杂合子（Aa）的表型值不完[全等](@entry_id:194418)于两个纯合子（AA 和 aa）表型值的平均数。这种偏离产生了[显性方差](@entry_id:184256)。
- **[上位性](@entry_id:136574)遗传方差 ($V_I$)**：源于不同基因座之间等位基因的相互作用，即**上位性**（epistasis）。这意味着一个基因座的效应依赖于另一个基因座的基因型。

为了更具体地理解上位性，我们可以考虑一个双位点模型 [@problem_id:5071841]。在一个包含 $3 \times 3$ 共九种基因型组合的表格中，[上位性](@entry_id:136574)被定义为不能由单个位点的主效应（加性效应和显性效应）之和来解释的基因型值偏差。通过特定的正交编码，可以将[上位性](@entry_id:136574)分解为更精细的成分，如**加性×加性互作** ($I_{AA}$)、**加性×显性互作** ($I_{AD}$) 和**显性×显性互作** ($I_{DD}$)。例如，$I_{AA}$ 反映了一个位点上纯合子之间的差异如何受另一个位点上纯合子状态的影响。这些统计上的互作项捕捉了基因调控网络中复杂的非线性关系，构成了[上位性方差](@entry_id:263723) $V_I$ 的基础。

### [遗传力](@entry_id:151095)的概念

有了[方差分解](@entry_id:272134)的框架，我们便可以定义**遗传力**（heritability），这是衡量遗传因素对[表型变异](@entry_id:163153)贡献程度的核心指标。遗传力分为两种主要类型：[广义遗传力](@entry_id:267885)和[狭义遗传力](@entry_id:262760) [@problem_id:5071830]。

**[广义遗传力](@entry_id:267885) ($H^2$)** 定义为总遗传方差 $V_G$ 占总[表型方差](@entry_id:274482) $V_P$ 的比例：

$$H^2 = \frac{V_G}{V_P} = \frac{V_A + V_D + V_I}{V_P}$$

$H^2$ 代表了所有形式的遗传差异（加性、显性和上位性）对人群中[表型变异](@entry_id:163153)的总体贡献。它衡量了遗传对性状变异影响的上限。在实践中，$H^2$ 通常通过比较同卵双生子（MZ, 共享100%基因）和异卵双生子（DZ, 平均共享50%基因）的表型相似性来估计。

**[狭义遗传力](@entry_id:262760) ($h^2$)** 定义为加性遗传方差 $V_A$ 占总[表型方差](@entry_id:274482) $V_P$ 的比例：

$$h^2 = \frac{V_A}{V_P}$$

$h^2$ 的意义尤为重要，因为它量化的是能够稳定传递给后代的遗传变异部分。非加性效应（显性和上位性）依赖于特定的等位基因组合，这些组合在[减数分裂](@entry_id:140281)和重组过程中会被打散，因此不能稳定地从亲代传给子代。正因为如此，$h^2$ 决定了亲代和子代之间的表型相似程度（例如，子代表型对亲代中值的回归斜率等于 $h^2$），并且是预测群体对人工或自然[选择响应](@entry_id:267049)的关键参数。

在医学遗传学中，$h^2$ 至关重要。**多基因风险评分**（Polygenic Risk Score, PRS）旨在通过汇总个体携带的众多风险等位基因的加性效应来预测疾病风险。因此，PRS的预测准确性的理论上限是由性状的 $h^2$ 决定的，而非 $H^2$。

### 从基因组数据估计[遗传力](@entry_id:151095)

传统的遗传力估计依赖于家族或[双生子研究](@entry_id:263760)。随着[全基因组测序](@entry_id:169777)和芯片技术的发展，我们现在可以直接从大量无亲缘关系个体的基因组数据中估计遗传力，这种方法被称为**[SNP遗传力](@entry_id:148453)**（SNP-based heritability）估计。其核心思想是，即使在名义上“无亲缘关系”的个体之间，也存在着由[共同祖先](@entry_id:175919)遗传下来的微小共享基因组片段，导致他们之间存在不同程度的遗传相似性。如果一个性状是可遗传的，那么遗传上更相似的个体，其表型也应该更相似。

为了量化个体间的遗传相似性，我们构建**基因组关系矩阵**（Genomic Relationship Matrix, GRM），记为 $G$ [@problem_id:5071877]。这是一个 $N \times N$ 的矩阵（$N$为样本量），其中元素 $G_{ik}$ 度量了个体 $i$ 和个体 $k$ 之间的遗传相似度。$G$ 通常由一个标准化后的基因型矩阵 $X$ 计算得出：

$$G = \frac{1}{M} X X^\top$$

这里，$M$ 是用于计算的[单核苷酸多态性](@entry_id:173601)（SNP）数量。构建 $X$ 的关键步骤是**标准化**。对于每个SNP $j$，其原始基因型剂量 $g_{ij}$ （值为0, 1, 2）需要根据其在群体中的[等位基因频率](@entry_id:146872) $p_j$ 进行中心化和缩放：

$$x_{ij} = \frac{g_{ij} - 2p_j}{\sqrt{2p_j(1-p_j)}}$$

分子 $g_{ij} - 2p_j$ 进行了中心化，使得每个SNP的均值为0。分母 $\sqrt{2p_j(1-p_j)}$ 是基因型剂量的标准差，用它进行缩放可以使每个SNP的方差为1。这一标准化步骤至关重要，因为它消除了[等位基因频率](@entry_id:146872)对SNP贡献的影响。若不进行标准化，频率较高的常见变异（其方差 $2p_j(1-p_j)$ 更大）将在关系估计中占据过大的权重，而标准化确保了每个SNP在计算总体遗传相似性时贡献均等。

有了GRM，我们就可以使用一种称为**基于基因组关系的最佳线性无偏预测**（Genomic-Relatedness-based Restricted Maximum Likelihood, GREML）的线性混合模型来估计[遗传力](@entry_id:151095) [@problem_id:5071826]。模型形式如下：

$$y = W\alpha + u + e$$

其中：
- $y$ 是 $N$ 个个体的表型向量。
- $W$ 是一个[设计矩阵](@entry_id:165826)，包含了需要校正的**固定效应**（fixed covariates），如年龄、性别、研究批次以及用于校正[群体结构](@entry_id:148599)的主成分（PCs）。$\alpha$是这些固定效应的系数。
- $u$ 是一个 $N \times 1$ 的随机效应向量，代表每个个体的总加性遗传效应。其分布假设为 $u \sim \mathcal{N}(0, \sigma_g^2 G)$，即个体间的[遗传协方差](@entry_id:174971)由其基因组关系 $G$ 和待估计的遗传方差 $\sigma_g^2$ 决定。
- $e$ 是[残差向量](@entry_id:165091)，假设为 $e \sim \mathcal{N}(0, \sigma_e^2 I)$，代表环境和未被模型捕获的其他方差。

该模型的核心思想是，表型向量 $y$ 的协方差结构由基因组关系矩阵 $G$ 和一个[单位矩阵](@entry_id:156724) $I$ 共同塑造：$\operatorname{Var}(y) = \sigma_g^2 G + \sigma_e^2 I$。通过限制性最大似然法（REML），可以同时估计出遗传方差 $\sigma_g^2$ 和残差方差 $\sigma_e^2$。[SNP遗传力](@entry_id:148453)即为 $h^2_{SNP} = \frac{\sigma_g^2}{\sigma_g^2 + \sigma_e^2}$。

在此模型中，纳入固定效应协变量 $W$ 是为了避免**混杂**（confounding）。例如，**[群体分层](@entry_id:175542)**（population stratification）是指不同祖先亚群在[等位基因频率](@entry_id:146872)和平均表型上均存在系统性差异。如果不加校正，源于共同亚群身份的表型相似性可能被错误地归因于由GRM捕获的因果遗传效应，从而导致 $\sigma_g^2$ 的估计值被抬高。通过将代表祖先信息的遗传主成分（PCs）作为固定效应包含在 $W$ 中，模型可以首先移除这些系统性的均值差异，从而更准确地剖分剩余的方差。

### 连锁不平衡与[全基因组](@entry_id:195052)关联分析的解读

**[连锁不平衡](@entry_id:146203)**（Linkage Disequilibrium, LD）是指在群体中，不同位点上的等位基因的非随机关联。如果两个位点完全独立，那么包含特定等位基因组合的单倍型频率应等于各自等位基因频率的乘积。当实际观测到的单倍型频率偏离这一期望时，就存在LD。

LD的强度通常用两个指标来衡量：$D$ 和 $r^2$ [@problem_id:5071843]。对于两个位点（等位基因为 A/a 和 B/b），$D$ 值定义为：

$$D = h_{AB} - p_A p_B$$

其中 $h_{AB}$ 是AB单倍型的频率，$p_A$ 和 $p_B$ 分别是A和B等位基因的频率。$D$ 的值域受等位基因频率的限制，不便于比较。因此，更常用的是标准化的指标 $r^2$：

$$r^2 = \frac{D^2}{p_A(1-p_A)p_B(1-p_B)}$$

$r^2$ 的取值范围在 $0$（完全独立）到 $1$（完全相关）之间，它衡量了一个位点的等位基因能够多大程度上预测另一个位点上的等位基因。

LD是解读**全基因组关联研究**（Genome-Wide Association Study, GWAS）结果的关键。GWAS通过[检验数](@entry_id:173345)百万个SNP与性状的关联来寻找遗传位点。然而，由于LD的存在，一个被检测到的显著关联SNP（称为“标签SNP”）本身可能并非真正的因果变异，它可能只是与某个未被直接检测的因果变异处于高度LD关系中。关联信号会从因果变异“传播”到其LD伙伴上。

这一现象引出了**LD分数**（LD Score, $\ell_j$）的概念。一个SNP $j$ 的LD分数定义为其与基因组中（通常是其邻近区域内）所有其他SNP $k$ 的 $r^2$ 值的总和（包括其自身，$r_{jj}^2 = 1$）：

$$\ell_j = \sum_k r_{jk}^2$$

LD分数衡量了一个SNP所“标记”的遗传变异总量。在一个高度多基因的性状中，许多变异都是因果的。因此，一个具有高LD分数的SNP，即使它本身不是因果的，也更有可能与许多微小的因果变异存在LD，从而“汇集”这些微弱的信号，导致其在GWAS中表现出更强的关联统计量（如$\chi^2$统计量）。

**LD分数回归**（LD Score Regression, LDSC）正是利用了这一原理 [@problem_id:5071829]。通过将每个SNP的$\chi^2$统计量对其LD分数进行回归，LDSC可以将GWAS结果中的统计量膨胀区分为两部分：
1.  **真正的多基因信号**：这部分膨胀与LD分数成正比，体现在回归线的斜率上。
2.  **混杂因素**：如未校正的群体分层或隐性亲缘关系，这类因素会普遍抬高所有SNP的[检验统计量](@entry_id:167372)，而与它们的LD分数无关。这部分膨胀体现在回归线的截距上。

在零假设下（无关联），$\chi^2$统计量的[期望值](@entry_id:150961)为1。因此，如果LDSC回归的截距显著大于1，则表明存在混杂因素导致的膨胀。我们可以用**衰减比**（attenuation ratio）来量化混杂的贡献：

$$\text{attenuation ratio} = \frac{\text{intercept} - 1}{\overline{\chi^2} - 1}$$

其中 $\overline{\chi^2}$ 是所有SNP的平均$\chi^2$值。这个比率表示在总的统计量膨胀（超出1的部分）中，有多大比例可归因于混杂因素。

### 扩展模型：基因-环境互作与全基因组模型

我们最初的方差分解模型 $V_P = V_G + V_E$ 是一个简化的理想情况。在现实世界中，遗传和环境的关系更为复杂，主要体现在两个方面：**基因-环境互作**（Gene-environment interaction, $G \times E$）和**基因-环境相关**（Gene-environment correlation, $r_{GE}$）[@problem_id:5071874]。

**基因-环境互作 ($G \times E$)** 指的是基因型对表型的影响依赖于特定的环境暴露。例如，某个基因型可能只在吸烟者中增加肺癌风险，而在非吸烟者中则无影响。在[统计模型](@entry_id:755400)中，这通常通过引入一个基因型与环境暴露的乘积项来表示。当存在 $G \times E$ 时，[表型方差](@entry_id:274482) $V_P$ 中会增加一个互作方差项 $V_{G \times E}$。

**基因-环境相关 ($r_{GE}$)** 指的是携带特定基因型的个体更可能暴露于特定环境中。例如，具有寻求刺激行为遗传倾向的个体可能更倾向于从事高风险活动。当存在 $r_{GE}$ 时，$G$ 和 $E$ 不再独立，它们的协方差 $2\operatorname{Cov}(G,E)$ 会成为 $V_P$ 的一个组成部分。

将这些复杂性纳入考量后，[表型方差](@entry_id:274482)的完整分解变得更加复杂，强调了遗传和环境因素之间相互交织的本质。

最后，综合以上所有概念，现代[复杂性状遗传学](@entry_id:202938)提出了**全基因组模型**（omnigenic model）[@problem_id:5071846]。这一模型试图回答一个核心问题：为何对于大多数[复杂性状](@entry_id:265688)，GWAS发现的关联位点如此广泛地分布于整个基因组，远超出生理学上直接相关的少数“核心”基因？

全基因组模型提出，对于任何一个[复杂性状](@entry_id:265688)：
- 存在少数**核心基因**（core genes），其产物直接参与决定性状的生物学通路。
- 同时存在数以万计的**外周基因**（peripheral genes），它们在细胞的基因调控网络中表达。这些外周基因中的变异虽然效应微小，但它们通过复杂的调控网络（如反式调控）影响核心基因的表达或功能，从而间接地影响最终的表型。

这个模型的关键推论是，由于外周基因的数量极其庞大，它们对性状总遗传方差的集体贡献可能远大于少数核心基因。一个简单的计算可以说明这一点：假设有50个核心基因，每个变异的效应为0.05；同时有20000个外周基因，每个变异的效应仅为0.005（前者的十分之一）。由于方差贡献与效应的平方和数量成正比，外周基因的总贡献可能是核心基因的数倍。

[全基因组](@entry_id:195052)模型完美地解释了为何[复杂性状](@entry_id:265688)的遗传力是如此“弥散”的——它并非集中在少数几个关键基因上，而是分布在基因组的广阔区域，通过一张巨大的、相互连接的[调控网络](@entry_id:754215)汇聚到核心的生物学功能上。这也意味着，要构建准确的疾病风险预测模型，仅仅关注已知的核心基因是远远不够的，必须整合来自全基因组的成千上万个微小效应。