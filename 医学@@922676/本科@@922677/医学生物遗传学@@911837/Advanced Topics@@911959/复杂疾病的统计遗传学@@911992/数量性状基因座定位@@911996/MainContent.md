## 引言
与由单一基因决定的孟德尔性状不同，人类的许多重要特征和疾病风险，如身高、血压和糖尿病易感性，都表现为连续变化的[数量性状](@entry_id:144946)。这些复杂性状是由多个基因与环境因素共同作用的结果。然而，我们如何从庞大的基因组中精确找到那些对性状有贡献的遗传区域呢？这正是数量性状位点（QTL）定位旨在解决的核心科学问题。QTL定位是连接基因型与复杂表型的桥梁，是现代遗传学、医学和农业育种研究的基石。

本文将系统性地引导您进入QTL定位的世界。在第一章“原理与机制”中，我们将奠定理论基础，学习如何从数学上分解[表型变异](@entry_id:163153)，并掌握[连锁分析](@entry_id:262737)与关联分析这两种核心的定位方法，以及如何应对群体分层等统计挑战。接下来的“应用与跨学科连接”一章，将展示QTL定位在农业育种、进化研究、分子生物学和人类医学中的广泛应用，揭示其如何帮助我们理解从生长发育到疾病发生的复杂生物学过程。最后，通过“动手实践”部分，您将有机会将理论知识应用于具体问题，加深对关键概念的理解。让我们首先深入探讨支撑QTL定位的遗传学原理与核心统计机制。

## 原理与机制

### 定量性状的遗传基础

在[医学遗传学](@entry_id:262833)中，表型性状根据其在群体中的分布模式可分为两大类。**分类性状 (categorical traits)** 将个体划分到有限的离散类别中，例如[ABO血型](@entry_id:151435)或某种疾病的“患病”与“未患病”状态。与之相对，**[数量性状](@entry_id:144946) (quantitative traits)** 是指那些可以在连续或精细分级的数值尺度上测量的表型，例如身高、体重或血压。这些性状的变异通常受到多个基因（多基因性）和环境因素的共同影响，其在群体中的分布常常近似于正态分布。

为了从数学上解构这些复杂性状的变异来源，[数量遗传学](@entry_id:154685)建立了一个基础模型。该模型假定个体的表型值 ($P$) 是其基因型值 ($G$) 和环境离差 ($E$) 的总和：

$$P = G + E$$

在理想情况下，我们假设基因型与环境之间没有协方差（即 $\text{Cov}(G, E) \approx 0$），这意味着特定基因型的个体并非系统性地暴露于特定环境中。在此假设下，群体中的总[表型方差](@entry_id:274482) ($V_P$) 可以分解为遗传方差 ($V_G$) 和环境方差 ($V_E$) 之和：

$$V_P = V_G + V_E$$

然而，遗传贡献本身是复杂的。基因型值 ($G$) 并非简单地由等位基因累加而成，它包含了等位基因之间以及不同基因座之间的相互作用。因此，遗传方差 ($V_G$) 可以进一步被细分为三个核心组分：**加性遗传方差 ($V_A$)**、**[显性遗传方差](@entry_id:197376) ($V_D$)** 和 **[上位性](@entry_id:136574)遗传方差 ($V_I$)**。由此，[表型方差](@entry_id:274482)的完整分解形式为 [@problem_id:5076726]：

$$V_P = V_A + V_D + V_I + V_E$$

这四个方差组分各自具有明确的生物学意义：

- **[加性遗传方差](@entry_id:154158) ($V_A$)**：这部分方差源于等位基因的 **加性效应 (additive effects)**。所谓加性效应，是指每个等位基因对其所影响的性状都有一个独立的、可累加的贡献。例如，如果等位基因‘A’使血压升高1单位，而等位基因‘a’使其降低1单位，则在一个加性模型中，基因型为‘AA’、‘Aa’和‘aa’的个体其基因型值将分别为+2、0和-2。$V_A$ 是群体中所有这些加性效应的总和所产生的方差。它是亲代可以传递给子代并决定亲缘关系间表型相似度的核心遗传组分，也是群体响应自然选择或[人工选择](@entry_id:269785)的遗传基础。

- **[显性遗传方差](@entry_id:197376) ($V_D$)**：这部分方差源于同一基因座上等位基因之间的相互作用，即 **显性效应 (dominance effects)**。当杂合子（如‘Aa’）的表型值不完[全等](@entry_id:194418)于两个纯合子（‘AA’和‘aa’）表型值的平均数时，就产生了显性离差。例如，如果‘AA’和‘aa’的表型值分别为+2和-2，而‘Aa’的表型值不是0而是+1，那么这个+1的离差就是显性效应。$V_D$ 是群体中所有这些显性离差导致的方差。它影响个体自身的表型，但不以简单的方式遗传给后代，因为它依赖于特定的等位基因组合（基因型），而亲代只传递等位基因。

- **上位性遗传方差 ($V_I$)**：这部分方差源于不同基因座上等位基因之间的相互作用，即 **上位性效应 (epistatic effects)**。例如，一个基因座上的等位基因可能会抑制或增强另一个完全不同基因座上等位基因的表达效果。这种跨基因座的非加性相互作用（如加性×加性、加性×显性等）贡献了[上位性方差](@entry_id:263723)。[上位性](@entry_id:136574)是复杂的遗传结构，其分析极具挑战性。

理解这一[方差分解](@entry_id:272134)是QTL定位的基石，因为它将观察到的复杂[表型变异](@entry_id:163153)归因于可追溯的遗传和环境来源，为后续的定位分析提供了理论框架。

### 定量性状位点（QTL）的定位方法

QTL定位旨在识别基因组中对特定数量性状有贡献的区域。其核心方法主要分为两大类：[连锁分析](@entry_id:262737)和关联分析。

#### [连锁分析](@entry_id:262737)

**[连锁分析](@entry_id:262737) (Linkage analysis)** 在家系数据中进行，通过追踪标记基因和性状在代际间的共分离模式来定位基因。其基本原理是，如果一个[遗传标记](@entry_id:202466)和一个影响性状的QTL在染色体上的物理位置非常接近，那么它们在[减数分裂](@entry_id:140281)中一同被遗传给后代的概率就很高，表现为低的 **重组率 ($\theta$)**。完全不连锁的基因（位于不同染色体或同一染色体上相距很远）其重组率为 $\theta = 0.5$，遵循孟德尔的[独立分配定律](@entry_id:272450)。

[连锁分析](@entry_id:262737)的证据强度通常用 **LOD得分 (Logarithm of the Odds score)** 来衡量。LOD得分定义为在给定[重组率](@entry_id:203271) $\theta$ 下观察到数据的似然（$L(\theta)$）与在无连锁（$\theta=0.5$）假设下数据似然（$L(0.5)$）之比的以10为底的对数 [@problem_id:5076711]：

$$\text{LOD} = \log_{10}\left(\frac{L(\theta)}{L(0.5)}\right)$$

例如，在一个大家系研究中，[假设检验](@entry_id:142556)某个标记与一个QTL之间存在连锁（如 $\theta=0.1$）的模型所得似然值为 $L(\theta=0.1) = 2.5 \times 10^{-3}$，而在无连锁假设（$\theta=0.5$）下的似然值为 $L(0.5) = 1.0 \times 10^{-3}$。那么，支持连锁的LOD得分为：

$$\text{LOD} = \log_{10}\left(\frac{2.5 \times 10^{-3}}{1.0 \times 10^{-3}}\right) = \log_{10}(2.5) \approx 0.40$$

正的LOD得分表示连[锁模](@entry_id:266596)型比无连[锁模](@entry_id:266596)型能更好地解释观测数据。历史上，LOD得分大于3.0（即[似然比](@entry_id:170863)为1000:1）被认为是支持连锁的显著证据。

[连锁分析](@entry_id:262737)方法本身也分为两种主要类型：

- **参数[连锁分析](@entry_id:262737) (Parametric linkage analysis)**：这种“经典”的LOD得分法是[参数化](@entry_id:265163)的，因为它要求研究者预先指定一个明确的[遗传模型](@entry_id:750230)，包括遗传模式（如显性或隐性）、外显率（即特定基因型个体表现出相应性状的概率）和致病等位基因频率。该方法对于遵循孟德尔遗传规律的单基因病非常有效，但对于[遗传模式](@entry_id:137802)未知的复杂数量性状则难以适用。

- **方差组分[连锁分析](@entry_id:262737) (Variance-component linkage analysis)**：为解决[复杂性状](@entry_id:265688)的难题，研究者开发了这种更灵活的方法。它不要求指定固定的[遗传模型](@entry_id:750230)，而是将性状的总[方差分解](@entry_id:272134)为多个组分，包括特定QTL的方差贡献、多基因背景方差和环境方差。其核心思想是，在家系中，在某个QTL附近共享更多“同源”等位基因（Identical-By-Descent, IBD）的亲属，其表型值也应更相似。通过检验与特定标记连锁的QTL方差组分是否显著大于零，来判断连锁是否存在。这种方法更适用于高血压等复杂[数量性状](@entry_id:144946)的研究 [@problem_id:5076711]。

#### 关联分析

与在家族内追踪遗传的[连锁分析](@entry_id:262737)不同，**关联分析 (Association analysis)** 通常在“不相关”的群体样本中进行，其原理是利用群体水平的 **连锁不平衡 (Linkage Disequilibrium, LD)**。LD是指在群体中，不同基因座上的等位基因以非随机的组合形式共同出现的现象。如果一个标记和一个致病QTL在历史上长期紧密连锁，那么在群体中，该标记的某个等位基因就会与致病等位基因高度相关。因此，我们只需检测该标记与性状的关联，就能[间接推断](@entry_id:140485)附近是否存在一个QTL。

LD的强度通常用三个指标来衡量 [@problem_id:5076731]：

- **$D$**：这是最基本的LD度量，定义为两个等位基因（例如，位点1的等位基因$A$和位点2的等位基因$B$）同时出现的单倍型频率 ($f_{AB}$) 与它们在连锁平衡时（即独立出现时）预期频率 ($p_A p_B$) 之差：
  $$D = f_{AB} - p_A p_B$$

- **$D'$**：$D$的值受到等位基因频率的限制。为了进行标准化比较，$D'$ 将 $D$ 的值归一化到其理论最大值 ($D_{\max}$) 或最小值 ($D_{\min}$) 的范围内，其取值在-1到1之间。$|D'|=1$ 表示两个位点间没有发生过重组，而$D'=0$表示完全连锁平衡。

- **$r^2$**：该指标衡量了两个位点等位基因状态的 **相关系数的平方**。其计算公式为：
  $$r^2 = \frac{D^2}{p_A(1-p_A)p_B(1-p_B)}$$
  $r^2$ 的取值范围为0到1。它有一个非常直观且重要的解释：$r^2$ 值表示一个位点（标记）的基因型能在多大程度上预测另一个位点（如未观测到的致病QTL）的基因型。

在关联研究中，$r^2$ 是衡量 **标签SNP (tag SNP)** 效用的关键指标。标签SNP是指我们实际检测的[遗传标记](@entry_id:202466)，我们希望它能作为附近未检测致病变异的代理。一个标签SNP的检测效力约等于直接检测致病变异的效力乘以两者之间的$r^2$值。例如，如果一个标签SNP与一个致病变异之间的 $f_{AB}=0.30$，$p_A=0.6$，$p_B=0.4$，我们可以计算出 $D=0.06$ 和 $r^2=0.0625$ [@problem_id:5076731]。$r^2=0.0625$ 意味着该标签SNP仅能解释致病变异6.25%的变异。要达到与直接检测致病变异相同的统计功效，使用该标签SNP的研究需要的样本量大约是前者的 $1/r^2 = 16$ 倍。因此，在[全基因组](@entry_id:195052)关联研究（GWAS）中，通常选择与邻近区域有高 $r^2$ 值（如 $>0.8$）的标签SNP，以确保对基因组的有效覆盖。

关联分析最常用的统计工具是 **线性回归**。对于一个[数量性状](@entry_id:144946) $Y_i$ 和一个以等位[基因剂量](@entry_id:141444)（如次要等位基因计数）编码的SNP基因型 $G_i \in \{0, 1, 2\}$，我们可以构建一个简单的加性模型 [@problem_id:5076740]：

$$Y_i = \mu + \beta G_i + \varepsilon_i$$

其中，$\mu$ 是基线平均表型值，$\beta$ 是每个等位基因拷贝对表型的平均加性效应，$\varepsilon_i$ 是服从正态分布 $N(0, \sigma^2)$ 的随机误差。检验该SNP是否与性状关联，等价于检验原假设 $H_0: \beta = 0$。通过普通最小二乘法（OLS）估计出 $\hat{\beta}$ 及其[标准误](@entry_id:635378) $\widehat{\text{SE}}(\hat{\beta})$，可以构建一个 $t$ 统计量：

$$t = \frac{\hat{\beta}}{\widehat{\text{SE}}(\hat{\beta})}$$

在原假设成立的条件下，该统计量服从自由度为 $n-2$ 的 $t$ 分布（$n$为样本量）。如果计算出的 $p$ 值足够小（例如，小于预设的显著性水平），我们则拒绝原假设，认为该SNP与性状存在显著关联。

### 关联分析中的挑战与高级模型

尽管简单线性回归是QTL关联分析的基础，但在实际应用中，研究者必须应对一系列挑战，其中最突出的是由样本异质性引起的混杂。

#### 群体分层的混杂效应

**群体分层 (Population stratification)** 是指研究样本由多个具有不同遗传背景的亚群构成。如果这些亚群在等位基因频率和性状均值上都存在系统性差异，就会导致虚假的关联。

考虑一个假设情景 [@problem_id:5076719]：一个样本由两个祖源群体构成，群体1的等位基因A频率为0.8，群体2为0.2。同时，由于饮食等环境因素，群体1的平均血[压比](@entry_id:137698)群体2高2个单位。即使等位基因A本身对血压没有任何直接影响，但在混合样本中，携带更多A等位基因的个体更有可能来自群体1，因此他们的血压也倾向于更高。当研究者简单地将血压对基因型进行回归时，会观察到一个显著的、但完全是虚假的“遗传效应”。这种由共同的祖源（一个[混杂变量](@entry_id:199777)）同时影响基因型频率和表型而产生的非因果关联，是典型的 **混杂偏倚 (confounding bias)**。

#### 控制混杂的方法

为了克服[群体分层](@entry_id:175542)的挑战，研究者开发了多种先进的统计方法。

**1. 线性混合模型 (Linear Mixed Models, LMMs)**

LMM是当前QTL定位和GWAS中的标准工具。与假定所有样本观测相互独立的普通最小二乘法（OLS）不同，LMM能够对样本间的相关性进行建模。其通用形式为 [@problem_id:5076708]：

$$Y = \mathbf{X}\beta + \mathbf{Z}u + \varepsilon$$

- $\mathbf{X}\beta$ 代表 **固定效应 (fixed effects)**，包括我们感兴趣的待测SNP、年龄、性别等协变量。
- $\mathbf{Z}u + \varepsilon$ 代表 **随机效应 (random effects)**。其中，$\varepsilon \sim \mathcal{N}(0, \sigma_e^2 \mathbf{I})$ 是独立的残差，而 $u \sim \mathcal{N}(0, \sigma_g^2 \mathbf{K})$ 是核心。$u$ 代表了个体间由多基因背景效应引起的相关性，其协方差结构由一个 **基因组亲缘关系矩阵 (Genomic Relationship Matrix, GRM)** $\mathbf{K}$ 来定义。$\mathbf{K}$ 矩阵是通过全基因组的SNP数据计算得出的，$K_{ij}$ 衡量了个体 $i$ 和 $j$ 之间的遗传相似度。

通过引入这个随机效应项，LMM将总[表型方差](@entry_id:274482)明确地划分为由待测SNP解释的方差、由总体遗传背景（包括[群体结构](@entry_id:148599)和近亲关系）解释的方差（$\sigma_g^2$），以及由环境和未解释因素解释的方差（$\sigma_e^2$）。这使得模型能够“吸收”掉由[群体分层](@entry_id:175542)和亲缘关系引起的背景噪声，从而对特定SNP的固定效应 $\beta$ 给出更准确、无偏的估计，有效控制了[I型错误](@entry_id:163360)（[假阳性](@entry_id:635878)）的膨胀。

LMM框架还带来一个重要的副产品：**基因组遗传力 (genomic heritability)** 的估计。SNP所能解释的[遗传力](@entry_id:151095)，记为 $h^2_{SNP}$，可以通过模型估计出的方差组分计算得到 [@problem_id:5076716]：

$$\hat{h}^2 = \frac{\hat{\sigma}_g^2}{\hat{\sigma}_g^2 + \hat{\sigma}_e^2}$$

这个值反映了在样本中由所有已测SNP共同解释的[表型变异](@entry_id:163153)比例。一个性状的遗传力越高，意味着其背后的遗传信号越强，通常也预示着检测到单个QTL的统计功效会更高。例如，在一个包含3个个体的微型研究中，通过特定的数学方法可以从表型向量 $\mathbf{Y}$ 和亲缘关系矩阵 $\mathbf{K}$ 中估算出 $\hat{\sigma}_g^2$ 和 $\hat{\sigma}_e^2$，进而得到[遗传力](@entry_id:151095)估计值，如0.3012 [@problem_id:5076716]。

**2. 基于家系的关联检验 (Family-Based Association Tests)**

另一种有效控制群体分层的策略是使用家系数据。**定量传递不平衡检验 (Quantitative Transmission Disequilibrium Test, QTDT)** 就是一个典型代表 [@problem_id:5076735]。

QTDT的核心思想是利用孟德尔遗传的随机性。在一个家系内部，父母将哪个等位基因传递给子女是随机的，这个过程不受父母所属的祖源亚群影响。QTDT将一个子女的基因型分解为两个正交的部分：
- **族内 (within-family) 组分**：该组分反映的是子女从父母那里实际遗传到的等位基因与基于孟德尔定律的期望之差。它完全由[减数分裂](@entry_id:140281)的[随机过程](@entry_id:268487)决定，因此对[群体分层](@entry_id:175542)免疫。
- **族间 (between-family) 组分**：该组分反映的是父母基因型的均值，它可能与祖源背景相关，因此容易受到群体分层的影响。

通过将子女的表型对这两个组分同时进行回归，QTDT可以分离出真实的[遗传关联](@entry_id:195051)（由族内组分系数反映）和可能由分层引起的虚假关联（由族间组分系数反映）。对族内组分系数进行显著性检验，就提供了一个对[群体分层](@entry_id:175542)稳健的关联检验。

### 超越加性模型：遗传结构与[交互作用](@entry_id:164533)

基础的QTL定位模型往往假设所有位点独立地、加性地影响性状。然而，真实的生物学过程远比这复杂。

#### 遗传结构：多基因 vs. 少基因

一个性状的 **遗传结构 (genetic architecture)** 是指其背后因果变异的数量、频率和效应大小的分布。谱系的两端是 **少基因 (oligogenic)** 和 **多基因 (polygenic)** 结构。

- **少基因性状**：由少数几个具有中到大效应的基因决定。
- **多基因性状**：由成百上千个效应微小的基因共同决定。

这个概念可以通过一个贝叶斯模型来形式化 [@problem_id:5076724]。假设一个性状的总遗传力 $h^2$ 是固定的，它由 $K$ 个独立的因果位点贡献。每个位点的效应大小 $\beta_j$ 可以被看作是从一个均值为0、方差为 $\tau^2$ 的正态分布中抽取的随机变量，即 $\beta_j \sim N(0, \tau^2)$。为了使这 $K$ 个位点共同解释的期望遗传方差恰好等于 $h^2$，效应大小的先验方差 $\tau^2$ 必须与因果位点的数量 $K$ 成反比：

$$\tau^2 = \frac{h^2}{K}$$

这个简单的关系清晰地揭示了遗传结构的本质：
- 如果性状是高度多基因的（$K$ 很大），那么每个位点的效应方差 $\tau^2$ 必然很小，意味着绝大多数因果位点的效应都接近于零。
- 如果性状是少基因的（$K$ 很小），那么 $\tau^2$ 就会很大，允许出现一些效应非常显著的位点。

理解一个性状的遗传结构对于选择合适的[统计模型](@entry_id:755400)和预测QTL定位的成功率至关重要。

#### [基因-环境交互作用](@entry_id:138514)

基因的效应并非总是一成不变的，它们可能受到环境因素的调节。这种现象被称为 **[基因-环境交互作用](@entry_id:138514) ($G \times E$ interaction)**。在统计学上，[交互作用](@entry_id:164533)意味着基因和环境对表型的联合效应不能被它们各自独立效应的简单加和所解释。

我们可以通过在线性模型中引入一个乘积项来检验和估计 $G \times E$ [交互作用](@entry_id:164533) [@problem_id:5076743]。假设 $G$ 是基因型（等位基因计数），$E$ 是一个标准化的环境暴露度量（如平均值为0的钠摄入量），模型可以写为：

$$Y = \mu + \beta_G G + \beta_E E + \beta_{GE} (G \times E) + \varepsilon$$

- $\beta_G$ 是 **主基因效应**，代表在平均环境水平（$E=0$）下，每增加一个效应等位基因所带来的表型变化。
- $\beta_E$ 是 **主环境效应**，代表在参考基因型（$G=0$）下，环境暴露每增加一个单位所带来的表型变化。
- $\beta_{GE}$ 是 **[交互效应](@entry_id:164533)**。它的值[表示环](@entry_id:136421)境水平每改变一个单位，基因的效应（即回归斜率）会相应改变多少。检验[交互作用](@entry_id:164533)是否存在，就等价于检验 $H_0: \beta_{GE} = 0$。

例如，一项关于血压的研究可能得到如下估计值：$\hat{\beta}_G=2.0$ mmHg/allele，$\hat{\beta}_{GE}=1.0$。这意味着，在平均钠摄入量水平下，每个效应等位基因使血压升高2.0 mmHg。然而，这个遗传效应受钠摄入量调节。当钠摄入量比平均水平低一个标准差（$E=-1$）时，基因型G=2和G=0的个体间预期血压差异为 $2 \times (\hat{\beta}_G + \hat{\beta}_{GE} \times (-1)) = 2 \times (2.0 - 1.0) = 2$ mmHg。而当钠摄入量高一个标准差（$E=+1$）时，这个差异增大到 $2 \times (2.0 + 1.0) = 6$ mmHg。这表明该基因位点对血压的影响在高钠环境中被放大了，是一个典型的$G \times E$[交互作用](@entry_id:164533)的例子。

### 全基因组扫描中的[多重检验问题](@entry_id:165508)

QTL定位的目标通常是在全基因组范围内进行探索，即所谓的 **[全基因组](@entry_id:195052)关联研究 (GWAS)**。这涉及对数十万到数百万个SNP标记逐一进行关联检验。如此大规模的检验带来了一个严峻的统计挑战：**多重检验 (multiple testing)**。

当进行单次[假设检验](@entry_id:142556)时，我们将I型错误（错误地拒绝了真实的零假设，即[假阳性](@entry_id:635878)）的概率控制在[显著性水平](@entry_id:170793) $\alpha$（通常为0.05）。但如果进行 $m$ 次独立的检验，那么至少出现一次[假阳性](@entry_id:635878)的概率（即 **族系错误率, Family-Wise Error Rate, FWER**）会急剧膨胀，约为 $1 - (1-\alpha)^m$。对于GWAS，$m$ 极大，这个概率几乎为1，意味着几乎肯定会出现[假阳性](@entry_id:635878)结果。

为了解决这个问题，必须对显著性阈值进行校正。主要有两种控制整体错误率的策略 [@problem_id:5076721]：

- **控制族系错误率 (FWER)**：FWER定义为在所有检验中至少犯一次[I型错误](@entry_id:163360)的概率，即 $\text{FWER} = P(V \ge 1)$，其中 $V$ 是[假阳性](@entry_id:635878)的数量。这是一种非常严格的控制方式。
  - **[Bonferroni校正](@entry_id:261239)**：最简单的方法，将单次检验的显著性水平调整为 $\alpha/m$。例如，对于 $m=8$ 次检验和 $\alpha=0.05$，Bonferroni阈值为 $0.05/8 = 0.00625$。任何 $p$ 值小于此阈值的检验被视为显著。这能有效控制FWER，但通常过于保守，可能导致大量真阳性结果被忽略。
  - **Holm-Bonferroni方法**：这是一种逐步递减的程序，比Bonferroni更强大（即检出率更高），同时同样严格地控制FWER。它通过对 $p$ 值排序并与一系列递减的阈值 $\alpha/m, \alpha/(m-1), \dots$ 进行比较。

- **控制[错误发现率](@entry_id:270240) (FDR)**：在探索性研究中，我们或许可以容忍少数[假阳性](@entry_id:635878)，只要它们在所有阳性发现中所占的比例很小。**错误发现率 (False Discovery Rate, FDR)** 定义为所有被拒绝的零假设中，实际上为真的那部分所占比例的[期望值](@entry_id:150961)，即 $\text{FDR} = E[V/R]$ (当 $R>0$ 时，R为阳性发现总数)。
  - **[Benjamini-Hochberg](@entry_id:269887) (BH) 程序**：这是控制FDR最常用的方法。它将所有 $p$ 值从小到大排序 ($p_{(1)}, p_{(2)}, \dots, p_{(m)}$)，然后寻找最大的 $k$ 使得 $p_{(k)} \le \frac{k}{m}\alpha$。所有排名前 $k$ 的检验都被视为显著。

为了具体说明这几种方法的差异，考虑一个包含 $m=8$ 个独立检验的研究，其排序后的 $p$ 值分别为 $0.001, 0.007, 0.012, 0.023, 0.041, 0.080, \dots$。在 $\alpha=0.05$ 的水平下 [@problem_id:5076721]：
- **[Bonferroni校正](@entry_id:261239)**：阈值为 $0.00625$。只有 $p_{(1)}=0.001$ 小于该阈值，因此 **拒绝1个假设**。
- **Holm方法**：$p_{(1)}=0.001 \le 0.05/8$, $p_{(2)}=0.007 \le 0.05/7 \approx 0.00714$，但 $p_{(3)}=0.012 > 0.05/6 \approx 0.00833$。因此 **拒绝2个假设**。
- **[Benjamini-Hochberg程序](@entry_id:171997)**：通过比较 $p_{(k)}$ 和 $\frac{k}{8} \times 0.05$，可以发现当 $k=4$ 时，$p_{(4)}=0.023 \le \frac{4}{8} \times 0.05 = 0.025$，但当 $k=5$ 时，$p_{(5)}=0.041 > \frac{5}{8} \times 0.05 = 0.03125$。因此 **拒绝4个假设**。

这个例子清晰地表明，从Bonferroni到Holm再到BH，方法的[统计功效](@entry_id:197129)依次增强，但代价是错误控制的定义从最严格的FWER放宽到了相对宽松的FDR。在QTL定位的实践中，选择哪种校正方法取决于研究的目标是避免任何[假阳性](@entry_id:635878)，还是最大化发现数量。