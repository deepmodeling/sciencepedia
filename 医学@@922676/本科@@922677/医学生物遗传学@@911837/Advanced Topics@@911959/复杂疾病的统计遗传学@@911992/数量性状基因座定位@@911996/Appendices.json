{"hands_on_practices": [{"introduction": "在数量性状基因座（QTL）定位中，第一步是将遗传效应的生物学概念转化为数学语言。本练习探讨了在线性回归中如何使用特定的基因型编码方案来表示不同的遗传效应（加性效应和显性效应），这对于理解关联研究的内在机制至关重要。掌握这些模型参数化方法 [@problem_id:5076734] 是正确解释关联分析结果的基础。", "problem": "一个具有等位基因 $A$ 和 $a$ 的双等位基因单核苷酸多态性 (SNP) 具有三种基因型 $AA$、$Aa$ 和 $aa$。在数量性状位点 (QTL) 定位中，对数量性状 $Y$ 的关联检验通常使用将基因型与预期性状值相关联的线性模型。根据第一性原理，将加性效应定义为纯合子均值之间差值的一半，将显性离差定义为杂合子均值与纯合子均值中点的偏离。具体来说，设特定基因型的期望值为 $\\mu_{AA}$、$\\mu_{Aa}$ 和 $\\mu_{aa}$。加性效应 $a$ 定义为 $a = \\left(\\mu_{AA} - \\mu_{aa}\\right)/2$，显性离差 $d$ 定义为 $d = \\mu_{Aa} - \\left(\\mu_{AA} + \\mu_{aa}\\right)/2$。在纯加性（无显性离差）的情况下，杂合子均值等于纯合子均值的中点，此时可以拟合一个带有单个加性预测变量的广义线性模型 (GLM)。为了考虑可能的显性离差，可以在模型中增加一个额外的预测变量，其作用是捕捉杂合子与加性中点的偏离。\n\n考虑针对 $Y$ 的三种建模策略：(i) 仅含加性效应的 GLM，使用单个基因型编码的预测变量 $G_A$；(ii) 加性-显性 GLM，使用两个预测变量 $G_A$ 和 $G_D$；以及 (iii) 完全基因型 GLM，使用两个指示变量并将一种基因型作为基线。哪个选项正确地指定了 $G_A$ 和 $G_D$ 的基因型编码，并阐明了合适的原假设（线性对比），以便在模型 (ii) 中通过额外的 $G_D$ 项以及在模型 (iii) 中通过基因型系数间的对比来检验显性离差？\n\nA. 在模型 (i) 中，通过等位基因剂量编码 $G_A$：$aa \\mapsto $ $0$，$Aa \\mapsto $ $1$，$AA \\mapsto $ $2$。在模型 (ii) 中，添加编码为杂合子指示变量的 $G_D$：$aa \\mapsto $ $0$，$Aa \\mapsto $ $1$，$AA \\mapsto $ $0$，并通过 $H_0\\!:\\,\\beta_D = 0$ 在 $Y = \\mu + \\beta_A G_A + \\beta_D G_D + \\varepsilon$ 中检验显性离差。在模型 (iii) 中，以 $aa$ 为基线，使用两个指示变量 $I_{Aa}$ 和 $I_{AA}$，使得 $Y = \\mu + \\gamma_{Aa} I_{Aa} + \\gamma_{AA} I_{AA} + \\varepsilon$，并通过线性对比 $H_0\\!:\\,2\\gamma_{Aa} - \\gamma_{AA} = 0$ 检验显性离差。\n\nB. 在模型 (i) 中，编码 $G_A$ 为 $aa \\mapsto $ $-1$，$Aa \\mapsto $ $0$，$AA \\mapsto $ $1$。在模型 (ii) 中，将 $G_D$ 编码为 $AA$ 的指示变量：$aa \\mapsto $ $0$，$Aa \\mapsto $ $0$，$AA \\mapsto $ $1$，并通过 $H_0\\!:\\,\\beta_D = 0$ 检验显性离差。在模型 (iii) 中，以 $Aa$ 为基线，使用 $I_{aa}$ 和 $I_{AA}$，使得 $Y = \\mu + \\gamma_{aa} I_{aa} + \\gamma_{AA} I_{AA} + \\varepsilon$，并通过 $H_0\\!:\\,\\gamma_{AA} - \\gamma_{aa} = 0$ 检验显性离差。\n\nC. 在模型 (i) 中，通过等位基因剂量编码 $G_A$：$aa \\mapsto $ $0$，$Aa \\mapsto $ $1$，$AA \\mapsto $ $2$。在模型 (ii) 中，编码 $G_D$ 为 $aa \\mapsto $ $-1$，$Aa \\mapsto $ $0$，$AA \\mapsto $ $1$，并通过 $H_0\\!:\\,\\beta_D = 0$ 检验显性离差。在模型 (iii) 中，以 $aa$ 为基线，使用 $I_{Aa}$ 和 $I_{AA}$，并通过 $H_0\\!:\\,\\gamma_{Aa} = \\gamma_{AA}/2$ 检验显性离差。\n\nD. 在模型 (i) 中，通过等位基因剂量编码 $G_A$：$aa \\mapsto $ $0$，$Aa \\mapsto $ $1$，$AA \\mapsto $ $2$。在模型 (ii) 中，将 $G_D$ 编码为纯合子指示变量：$aa \\mapsto $ $1$，$Aa \\mapsto $ $0$，$AA \\mapsto $ $1$，并通过 $H_0\\!:\\,\\beta_D = 0$ 检验显性离差。在模型 (iii) 中，使用单个指示变量 $I_{AA}$，使得 $Y = \\mu + \\gamma_{AA} I_{AA} + \\varepsilon$，无需进一步的对比。", "solution": "### 步骤 1：提取已知信息\n\n问题陈述为与一个具有等位基因 $A$ 和 $a$、基因型为 $AA$、$Aa$ 和 $aa$ 的双等位基因单核苷酸多态性 (SNP) 相关的数量性状 $Y$ 的数量性状位点 (QTL) 定位提供了以下定义和模型。\n\n1.  **特定基因型期望值**：基因型的预期性状值表示为 $\\mu_{AA}$、$\\mu_{Aa}$ 和 $\\mu_{aa}$。\n2.  **加性效应定义**：加性效应 $a$ 根据第一性原理定义为 $a = (\\mu_{AA} - \\mu_{aa})/2$。这表示两个纯合子基因型均值之差的一半。\n3.  **显性离差定义**：显性离差 $d$ 定义为 $d = \\mu_{Aa} - (\\mu_{AA} + \\mu_{aa})/2$。这表示杂合子均值与两个纯合子均值中点的偏离。\n4.  **纯加性条件**：纯加性模型对应于无显性离差，即 $d=0$。\n5.  **建模策略**：\n    *   (i) **仅加性效应 GLM**：使用单个预测变量 $G_A$ 的广义线性模型。\n    *   (ii) **加性-显性 GLM**：使用两个预测变量 $G_A$ 和 $G_D$ 的广义线性模型。\n    *   (iii) **完全基因型 GLM**：使用两个指示变量，并将一个基因型作为基线的广义线性模型。\n\n### 步骤 2：使用提取的已知信息进行验证\n\n*   **科学依据**：该问题牢固地植根于统计遗传学和数量遗传学领域。加性效应 ($a$) 和显性离差 ($d$) 的定义是文献中的标准定义（例如，Falconer  Mackay 的模型）。使用线性模型检验遗传关联是 QTL 定位和全基因组关联研究 (GWAS) 的基石。该问题在科学上是合理的。\n*   **问题明确**：问题要求在不同但相关的线性模型框架下，确定预测变量（基因型编码）的正确设定以及检验显性效应的相应原假设。这是一个关于模型参数化和假设检验的明确问题，基于线性模型原理和所提供的定义，有唯一正确的答案。\n*   **客观性**：问题以精确、客观的数学和统计语言陈述。它定义了所有必要的术语，并提出了一个可以通过逻辑推导来回答的问题，没有主观解释的余地。\n*   **完整性和一致性**：问题提供了评估选项所需的所有定义和背景。这些概念在内部是一致的。\n\n### 步骤 3：判断与行动\n\n问题陈述是有效的。它在科学上合理、问题明确、客观且自成体系。可以进行求解过程。\n\n### 推导与选项评估\n\n核心任务是将所提出的线性模型（回归系数）的统计参数与遗传参数（$a$ 和 $d$）联系起来，并为检验不存在显性效应（$d=0$）构建正确的原假设。无显性效应的条件是 $d=0$，根据其定义，这意味着 $\\mu_{Aa} = (\\mu_{AA} + \\mu_{aa})/2$。\n\n我们将分析每个选项提出的模型和检验。\n\n#### 选项 A 分析\n\n*   **模型 (i) - 仅加性效应 GLM**：为基因型 $(aa, Aa, AA)$ 提出的 $G_A$ 编码是 $(0, 1, 2)$。这是一种等位基因剂量编码（计算 `$A$` 等位基因的数量）。模型是 $E[Y] = \\mu_{model} + \\beta_A G_A$。\n    *   对于基因型 $aa$ ($G_A=0$)：$E[Y|aa] = \\mu_{aa} = \\mu_{model}$。\n    *   对于基因型 $Aa$ ($G_A=1$)：$E[Y|Aa] = \\mu_{Aa} = \\mu_{model} + \\beta_A$。\n    *   对于基因型 $AA$ ($G_A=2$)：$E[Y|AA] = \\mu_{AA} = \\mu_{model} + 2\\beta_A$。\n    该模型对均值施加了线性关系：$\\mu_{Aa} - \\mu_{aa} = \\beta_A$ 和 $\\mu_{AA} - \\mu_{Aa} = \\beta_A$。这意味着 $\\mu_{Aa} = (\\mu_{AA} + \\mu_{aa})/2$，这正是纯加性 ($d=0$) 的定义。系数 $\\beta_A$ 可以用加性效应 $a$ 来解释：$a = (\\mu_{AA} - \\mu_{aa})/2 = ((\\mu_{model} + 2\\beta_A) - \\mu_{model})/2 = \\beta_A$。这种编码对于加性模型是正确的。\n\n*   **模型 (ii) - 加性-显性 GLM**：模型是 $E[Y] = \\mu + \\beta_A G_A + \\beta_D G_D$，其中 $G_A=(0, 1, 2)$，$G_D=(0, 1, 0)$（杂合子的指示变量）。\n    *   对于基因型 $aa$：$E[Y|aa] = \\mu_{aa} = \\mu + \\beta_A(0) + \\beta_D(0) = \\mu$。\n    *   对于基因型 $Aa$：$E[Y|Aa] = \\mu_{Aa} = \\mu + \\beta_A(1) + \\beta_D(1) = \\mu + \\beta_A + \\beta_D$。\n    *   对于基因型 $AA$：$E[Y|AA] = \\mu_{AA} = \\mu + \\beta_A(2) + \\beta_D(0) = \\mu + 2\\beta_A$。\n    该模型有三个参数（$\\mu$、$\\beta_A$、$\\beta_D$）来拟合三个均值，因此可以完美地表示任何一组基因型均值。让我们将这些系数与 $a$ 和 $d$ 联系起来：\n    *   $a = (\\mu_{AA} - \\mu_{aa})/2 = ((\\mu + 2\\beta_A) - \\mu)/2 = 2\\beta_A/2 = \\beta_A$。\n    *   $d = \\mu_{Aa} - (\\mu_{AA} + \\mu_{aa})/2 = (\\mu + \\beta_A + \\beta_D) - ((\\mu + 2\\beta_A) + \\mu)/2 = \\mu + \\beta_A + \\beta_D - (\\mu + \\beta_A) = \\beta_D$。\n    因此，$\\beta_A$ 直接估计加性效应 $a$，而 $\\beta_D$ 直接估计显性离差 $d$。要检验无显性效应 ($d=0$)，必须检验原假设 $H_0: \\beta_D = 0$。这是正确的。\n\n*   **模型 (iii) - 完全基因型 GLM**：该模型使用 $aa$ 作为基线，并使用指示变量 $I_{Aa}$（用于基因型 $Aa$）和 $I_{AA}$（用于基因型 $AA$）。模型是 $E[Y] = \\mu + \\gamma_{Aa} I_{Aa} + \\gamma_{AA} I_{AA}$。\n    *   对于基因型 $aa$：$E[Y|aa] = \\mu_{aa} = \\mu$。\n    *   对于基因型 $Aa$：$E[Y|Aa] = \\mu_{Aa} = \\mu + \\gamma_{Aa}$。所以，$\\gamma_{Aa} = \\mu_{Aa} - \\mu_{aa}$。\n    *   对于基因型 $AA$：$E[Y|AA] = \\mu_{AA} = \\mu + \\gamma_{AA}$。所以，$\\gamma_{AA} = \\mu_{AA} - \\mu_{aa}$。\n    为了检验无显性效应 ($d=0$)，我们使用条件 $\\mu_{Aa} = (\\mu_{AA} + \\mu_{aa})/2$。我们代入模型参数表达式：\n    *   $\\mu + \\gamma_{Aa} = ((\\mu + \\gamma_{AA}) + \\mu)/2$。\n    *   $\\mu + \\gamma_{Aa} = (2\\mu + \\gamma_{AA})/2 = \\mu + \\gamma_{AA}/2$。\n    *   $\\gamma_{Aa} = \\gamma_{AA}/2$。\n    这个条件可以写成一个用于假设检验的线性对比：$H_0: \\gamma_{Aa} - \\gamma_{AA}/2 = 0$，或等效地，$H_0: 2\\gamma_{Aa} - \\gamma_{AA} = 0$。这是正确的。\n\n*   **结论**：选项 A 在所有三个部分都是正确的。\n\n#### 选项 B 分析\n\n*   **模型 (i)**：将 $G_A$ 编码为 $(-1, 0, 1)$ 是加性模型的有效替代方案，因为它以不同方式对均值进行中心化，但 $\\beta_A$ 仍然代表加性效应 $a$。\n*   **模型 (ii)**：在模型 $E[Y] = \\mu + \\beta_A G_A + \\beta_D G_D$ 中，将 $G_D$ 编码为 $(0, 0, 1)$，同时 $G_A = (-1, 0, 1)$，得到：\n    *   $\\mu_{aa} = \\mu - \\beta_A$。\n    *   $\\mu_{Aa} = \\mu$。\n    *   $\\mu_{AA} = \\mu + \\beta_A + \\beta_D$。\n    遗传参数变为：\n    *   $a = (\\mu_{AA} - \\mu_{aa})/2 = ((\\mu+\\beta_A+\\beta_D) - (\\mu-\\beta_A))/2 = (2\\beta_A+\\beta_D)/2 = \\beta_A + \\beta_D/2$。\n    *   $d = \\mu_{Aa} - (\\mu_{AA} + \\mu_{aa})/2 = \\mu - ((\\mu+\\beta_A+\\beta_D) + (\\mu-\\beta_A))/2 = \\mu - (2\\mu+\\beta_D)/2 = -\\beta_D/2$。\n    系数 $\\beta_A$ 和 $\\beta_D$ 并不直接对应 $a$ 和 $d$。这种编码不适用于此目的，并使解释复杂化。更重要的是...\n*   **模型 (iii)**：使用 $Aa$ 作为基线，均值为 $\\mu_{aa} = \\mu + \\gamma_{aa}$，$\\mu_{Aa} = \\mu$，$\\mu_{AA} = \\mu + \\gamma_{AA}$。无显性效应的条件 $\\mu_{Aa} = (\\mu_{AA} + \\mu_{aa})/2$ 变为 $\\mu = ((\\mu + \\gamma_{AA}) + (\\mu + \\gamma_{aa}))/2 = \\mu + (\\gamma_{AA} + \\gamma_{aa})/2$。这意味着原假设应该是 $H_0: \\gamma_{AA} + \\gamma_{aa} = 0$。该选项提出 $H_0: \\gamma_{AA} - \\gamma_{aa} = 0$，这是不正确的。\n\n*   **结论**：选项 B 是不正确的。\n\n#### 选项 C 分析\n\n*   **模型 (ii)**：该模型使用 $G_A=(0, 1, 2)$ 和 $G_D=(-1, 0, 1)$。让我们分析来自 $E[Y] = \\mu + \\beta_A G_A + \\beta_D G_D$ 的均值：\n    *   $\\mu_{aa} = \\mu - \\beta_D$。\n    *   $\\mu_{Aa} = \\mu + \\beta_A$。\n    *   $\\mu_{AA} = \\mu + 2\\beta_A + \\beta_D$。\n    现在让我们检查显性离差：\n    *   $d = \\mu_{Aa} - (\\mu_{AA} + \\mu_{aa})/2 = (\\mu + \\beta_A) - ((\\mu + 2\\beta_A + \\beta_D) + (\\mu - \\beta_D))/2$。\n    *   $d = (\\mu + \\beta_A) - (2\\mu + 2\\beta_A)/2 = (\\mu + \\beta_A) - (\\mu + \\beta_A) = 0$。\n    这种编码在结构上强制 $d=0$，无论数据如何。使用这种设置不可能对显性进行建模或检验。该模型为其既定目的被错误指定。\n*   **模型 (iii)**：检验 $H_0: \\gamma_{Aa} = \\gamma_{AA}/2$ 是正确的，如对选项 A 的分析所示。然而，模型 (ii) 中的缺陷使得整个选项不正确。\n\n*   **结论**：选项 C 是不正确的。\n\n#### 选项 D 分析\n\n*   **模型 (ii)**：该模型使用 $G_A=(0, 1, 2)$ 和 $G_D=(1, 0, 1)$（纯合子指示变量）。让我们分析来自 $E[Y] = \\mu + \\beta_A G_A + \\beta_D G_D$ 的均值：\n    *   $\\mu_{aa} = \\mu + \\beta_D$。\n    *   $\\mu_{Aa} = \\mu + \\beta_A$。\n    *   $\\mu_{AA} = \\mu + 2\\beta_A + \\beta_D$。\n    让我们检查参数解释：\n    *   $a = (\\mu_{AA} - \\mu_{aa})/2 = ((\\mu + 2\\beta_A + \\beta_D) - (\\mu + \\beta_D))/2 = 2\\beta_A/2 = \\beta_A$。\n    *   $d = \\mu_{Aa} - (\\mu_{AA} + \\mu_{aa})/2 = (\\mu + \\beta_A) - ((\\mu + 2\\beta_A + \\beta_D) + (\\mu + \\beta_D))/2 = (\\mu + \\beta_A) - (2\\mu + 2\\beta_A + 2\\beta_D)/2 = (\\mu + \\beta_A) - (\\mu + \\beta_A + \\beta_D) = -\\beta_D$。\n    在这种参数化中，$\\beta_A$ 是加性效应 $a$，而 $\\beta_D$ 是显性离差的负值，即 $-d$。因此，检验 $H_0: \\beta_D=0$ 是检验 $d=0$ 的有效方法。所以这部分在技术上是正确的，尽管选项 A 中 $\\beta_D=d$ 的编码更常见。\n*   **模型 (iii)**：该选项声称“使用单个指示变量 $I_{AA}$，使得 $Y = \\mu + \\gamma_{AA} I_{AA} + \\varepsilon$”。这个模型不是问题设置中描述的“具有两个指示变量的完全基因型 GLM”。该模型只有两个不同的均值，一个用于基因型 $aa$ 和 $Aa$（$\\mu$），另一个用于基因型 $AA$（$\\mu + \\gamma_{AA}$）。它不能模拟三个任意的基因型均值，因此不能用于在一般情况下检验显性。这个陈述是根本不正确的。\n\n*   **结论**：选项 D 由于对模型 (iii) 的描述有误而不正确。\n\n### 结论\n\n基于逐步的推导和评估，只有选项 A 根据问题中阐述的第一性原理，为所有三种建模策略正确地指定了编码和假设检验。", "answer": "$$\\boxed{A}$$", "id": "5076734"}, {"introduction": "理解模型后，下一步是将其付诸实践。本练习 [@problem_id:5076754] 要求您设计一个模拟蓝图，从零开始构建一个具有特定遗传结构和遗传力的数量性状。通过这种构建过程，您将深入理解单个基因座如何共同作用，形成我们观察到的表型变异，并体会遗传力 $h^2$ 的实际意义。", "problem": "您需要设计并实现一个程序化模拟蓝图，用于在与医学遗传学中的数量性状基因座 (QTL) 定位一致的多基因模型下，构建一个加性数量性状。该性状针对 $M$ 个双等位基因座进行建模，其次要等位基因频率为 $p_i$，在哈迪-温伯格平衡 (HWE) 和连锁平衡 (LE) 条件下，各基因座之间相互独立。令 $X_i$ 表示基因座 $i$ 上的次要等位基因计数，其中 $X_i \\sim \\mathrm{Binomial}(2,p_i)$。定义中心化基因型 $G_i = X_i - 2p_i$。对于效应 $\\beta_i$，加性遗传值为 $A = \\sum_{i=1}^M \\beta_i G_i$。环境贡献 $E$ 假定独立于 $A$，其均值为 $0$，方差为 $V_E$。观测到的表型为 $Y = A + E$。狭义遗传力 $h^2$ 定义为 $h^2 = V_A / V_P$，其中 $V_A = \\mathrm{Var}(A)$ 是加性遗传方差，$V_P = \\mathrm{Var}(Y)$ 是表型方差。\n\n仅从以下基本原则出发：\n- 在 HWE 和 LE 条件下，对于双等位基因座，如果 $X_i \\sim \\mathrm{Binomial}(2,p_i)$，则 $\\mathrm{Var}(X_i) = 2p_i(1-p_i)$ 且 $\\mathrm{Var}(G_i) = \\mathrm{Var}(X_i)$。\n- 独立变量总和的方差相加：如果 $Z = \\sum_j Z_j$ 且 $Z_j$ 相互独立，则 $\\mathrm{Var}(Z) = \\sum_j \\mathrm{Var}(Z_j)$。\n- 对于 $Y = A + E$，其中 $A$ 独立于 $E$，则 $\\mathrm{Var}(Y) = \\mathrm{Var}(A) + \\mathrm{Var}(E)$。\n- 狭义遗传力为 $h^2 = V_A / V_P$。\n\n您的任务是实现以下蓝图：\n1. 给定一个未缩放的效应向量 $\\alpha = (\\alpha_1,\\dots,\\alpha_M)$ 和次要等位基因频率 $p = (p_1,\\dots,p_M)$。计算一个单一的缩放因子 $s$，并为所有 $i$ 设置 $\\beta_i = s \\alpha_i$，使得最终的加性遗传方差等于指定的目标 $V_A$。\n2. 使用目标狭义遗传力 $h^2 = 0.5$，计算环境方差 $V_E$，使最终的遗传力等于目标值。\n3. 通过计算由缩放效应得到的实现 $V_A$、由目标值推断出的 $V_E$ 以及从这些值获得的实现 $h^2$ 来验证构建过程。\n\n输入由下面的测试套件固定；没有用户输入。对于每个测试用例 $k$，您将获得：\n- $M^{(k)}$，\n- $p^{(k)} = (p^{(k)}_1,\\dots,p^{(k)}_{M^{(k)}})$，其中每个 $p^{(k)}_i \\in (0,1)$，\n- 未缩放的效应 $\\alpha^{(k)} = (\\alpha^{(k)}_1,\\dots,\\alpha^{(k)}_{M^{(k)}})$，\n- 目标加性遗传方差 $V_A^{(k)}$，\n- 目标狭义遗传力 $h^{2\\,(k)} = 0.5$。\n\n您的程序必须为每个测试用例 $k$ 计算：\n- 应用于 $\\alpha^{(k)}$ 以产生 $\\beta^{(k)}$ 从而实现 $V_A^{(k)}$ 的缩放因子 $s^{(k)}$，\n- 根据 $\\beta^{(k)}$ 和 $p^{(k)}$ 计算出的实现加性遗传方差 $\\widehat{V}_A^{(k)}$，\n- 实现 $h^{2\\,(k)}$ 所需的环境方差 $V_E^{(k)}$，\n- 根据 $\\widehat{V}_A^{(k)}$ 和 $V_E^{(k)}$ 计算出的实现遗传力 $\\widehat{h}^{2\\,(k)}$。\n\n严格按照上述基本原则设计您的算法。不要使用任何不能直接从这些原则推导出来的公式。将所有返回的数值表示为小数。\n\n需要实现和评估的测试套件：\n- 用例 1：$M=3$, $p=(0.1,\\,0.3,\\,0.5)$, $\\alpha=(0.5,\\,-0.2,\\,0.1)$, $V_A=2.0$, $h^2=0.5$。\n- 用例 2：$M=4$, $p=(0.01,\\,0.05,\\,0.2,\\,0.4)$, $\\alpha=(1.0,\\,0.2,\\,-0.3,\\,0.5)$, $V_A=0.5$, $h^2=0.5$。\n- 用例 3：$M=1$, $p=(0.5)$, $\\alpha=(2.0)$, $V_A=1.5$, $h^2=0.5$。\n- 用例 4：$M=2$, $p=(0.001,\\,0.499)$, $\\alpha=(0.05,\\,-1.0)$, $V_A=0.8$, $h^2=0.5$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 每个测试用例的结果本身必须是包含四个十进制数的列表，顺序为 $[s,\\,\\widehat{V}_A,\\,V_E,\\,\\widehat{h}^2]$，每个数打印时小数点后精确到 $6$ 位。\n- 总体而言，输出必须在一行上显示为 $[[s^{(1)},\\widehat{V}_A^{(1)},V_E^{(1)},\\widehat{h}^{2\\,(1)}],\\dots,[s^{(4)},\\widehat{V}_A^{(4)},V_E^{(4)},\\widehat{h}^{2\\,(4)}]]$ 的形式，不含任何额外文本。", "solution": "该问题论述了数量遗传学中的一套既定原则，并要求设计一个程序化模拟蓝图。有效性检查确认了该问题具有科学依据、提法明确且客观。所提供的原则足以推导出完成计算任务所需的公式。任务是确定遗传效应的缩放因子以达到目标遗传方差，然后确定达到目标遗传力所需的环境方差。\n\n所需参数的推导过程是通过逐步应用给定的基本原则来进行的。\n\n1.  **遗传效应缩放因子 $s$ 的推导**\n\n    加性遗传值 $A$ 定义为来自 $M$ 个独立基因座的效应总和：\n    $$A = \\sum_{i=1}^M \\beta_i G_i$$\n    其中 $\\beta_i$ 是效应大小，$G_i$ 是基因座 $i$ 的中心化基因型。\n\n    加性遗传方差 $V_A$ 是 $A$ 的方差。鉴于基因座处于连锁平衡 (LE) 状态，不同基因座的中心化基因型 $G_i$ 是独立的随机变量。\n    \n    应用原则 2（独立变量总和的方差）：\n    $$V_A = \\mathrm{Var}(A) = \\mathrm{Var}\\left(\\sum_{i=1}^M \\beta_i G_i\\right) = \\sum_{i=1}^M \\mathrm{Var}(\\beta_i G_i)$$\n    \n    使用方差的性质 $\\mathrm{Var}(cZ) = c^2 \\mathrm{Var}(Z)$，其中 $c$ 是一个常数，我们得到：\n    $$V_A = \\sum_{i=1}^M \\beta_i^2 \\mathrm{Var}(G_i)$$\n    \n    原则 1 指出，对于一个次要等位基因频率为 $p_i$ 且处于哈迪-温伯格平衡 (HWE) 的双等位基因座 $i$，其中心化基因型的方差为 $\\mathrm{Var}(G_i) = 2p_i(1-p_i)$。将此代入 $V_A$ 的表达式中：\n    $$V_A = \\sum_{i=1}^M \\beta_i^2 [2p_i(1-p_i)]$$\n    \n    问题规定，最终的效应大小 $\\beta_i$ 是通过将给定的未缩放效应向量 $\\alpha = (\\alpha_1, \\dots, \\alpha_M)$ 乘以一个单一因子 $s$ 得到的，即 $\\beta_i = s \\alpha_i$。代入这个关系：\n    $$V_A = \\sum_{i=1}^M (s\\alpha_i)^2 [2p_i(1-p_i)]$$\n    \n    由于 $s$ 对所有基因座都是一个常数，我们可以将 $s^2$ 从求和中提取出来：\n    $$V_A = s^2 \\left( \\sum_{i=1}^M \\alpha_i^2 [2p_i(1-p_i)] \\right)$$\n    \n    让我们定义未缩放的遗传方差 $V_{A, \\text{unscaled}}$，作为由效应 $\\alpha_i$ 直接产生的方差：\n    $$V_{A, \\text{unscaled}} = \\sum_{i=1}^M \\alpha_i^2 [2p_i(1-p_i)]$$\n    这个值可以从给定的输入 $p$ 和 $\\alpha$ 计算得出。目标遗传方差 $V_A^{\\text{target}}$ 的方程变为：\n    $$V_A^{\\text{target}} = s^2 V_{A, \\text{unscaled}}$$\n    \n    求解缩放因子 $s$，我们得到：\n    $$s = \\sqrt{\\frac{V_A^{\\text{target}}}{V_{A, \\text{unscaled}}}}$$\n    按照惯例，为 $s$ 选择正平方根。只要 $V_{A, \\text{unscaled}} > 0$，这就提供了一个唯一的正缩放因子。鉴于输入指定 $p_i \\in (0,1)$ 且至少有一个 $\\alpha_i \\neq 0$，此条件对所有测试用例都成立。\n\n2.  **环境方差 $V_E$ 的推导**\n\n    根据原则 4，狭义遗传力 $h^2$ 定义为加性遗传方差与总表型方差之比：\n    $$h^2 = \\frac{V_A}{V_P}$$\n    \n    总表型方差 $V_P$ 是表型 $Y = A + E$ 的方差。由于 $A$ 和 $E$ 是独立的，原则 3 给出：\n    $$V_P = V_A + V_E$$\n    \n    将其代入 $h^2$ 的定义中：\n    $$h^2 = \\frac{V_A}{V_A + V_E}$$\n    \n    目标是找出在给定 $V_A$ 的情况下，能实现目标遗传力 $h^2$ 的环境方差 $V_E$。我们重新整理方程以求解 $V_E$：\n    $$h^2(V_A + V_E) = V_A$$\n    $$h^2 V_A + h^2 V_E = V_A$$\n    $$h^2 V_E = V_A - h^2 V_A = V_A(1 - h^2)$$\n    $$V_E = V_A \\left( \\frac{1 - h^2}{h^2} \\right)$$\n    \n    对于问题中给出的特定目标值 $h^2 = 0.5$，这个公式大大简化：\n    $$V_E = V_A \\left( \\frac{1 - 0.5}{0.5} \\right) = V_A \\left( \\frac{0.5}{0.5} \\right) = V_A$$\n    因此，要实现 $50\\%$ 的遗传力，环境方差必须等于加性遗传方差。\n\n3.  **算法蓝图与验证**\n\n    对于每个测试用例，该算法按以下步骤进行，提供 $p^{(k)}$、$\\alpha^{(k)}$ 和 $V_A^{(k)}$：\n    \n    a. 计算每个基因座 $i$ 的基因型方差：$v_i = 2p_i^{(k)}(1-p_i^{(k)})$。\n    b. 计算未缩放的加性遗传方差：$V_{A, \\text{unscaled}}^{(k)} = \\sum_{i=1}^{M^{(k)}} (\\alpha_i^{(k)})^2 v_i$。\n    c. 计算缩放因子：$s^{(k)} = \\sqrt{V_A^{(k)} / V_{A, \\text{unscaled}}^{(k)}}$。\n    d. 计算实现的加性遗传方差 $\\widehat{V}_A^{(k)}$。这是一个验证步骤。使用计算出的 $s^{(k)}$，我们有 $\\widehat{V}_A^{(k)} = (s^{(k)})^2 V_{A, \\text{unscaled}}^{(k)}$，根据构造，它将等于目标 $V_A^{(k)}$。\n    e. 使用实现的 $\\widehat{V}_A^{(k)}$ 和目标遗传力 $h^{2\\,(k)} = 0.5$ 计算所需的环境方差 $V_E^{(k)}$：$V_E^{(k)} = \\widehat{V}_A^{(k)} (1-0.5)/0.5 = \\widehat{V}_A^{(k)}$。\n    f. 计算实现的遗传力 $\\widehat{h}^{2\\,(k)}$，作为最终的验证步骤：$\\widehat{h}^{2\\,(k)} = \\widehat{V}_A^{(k)} / (\\widehat{V}_A^{(k)} + V_E^{(k)})$。根据构造，这将等于目标 $h^{2\\,(k)} = 0.5$。\n    \n    程序将为每个测试用例实现这些步骤，并按规定格式化输出 $(s^{(k)}, \\widehat{V}_A^{(k)}, V_E^{(k)}, \\widehat{h}^{2\\,(k)})$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and evaluates a polygenic quantitative trait model for given test cases.\n\n    For each case, it calculates:\n    1. A scale factor 's' to achieve a target additive genetic variance (VA).\n    2. The realized additive genetic variance (realized_VA) using 's'.\n    3. The environmental variance (V_E) to achieve a target heritability (h^2).\n    4. The realized heritability (realized_h2) from the calculated variances.\n    \"\"\"\n    # Test suite as specified in the problem statement.\n    # Each case: (p_vector, alpha_vector, target_VA)\n    test_cases = [\n        # Case 1\n        (np.array([0.1, 0.3, 0.5]), np.array([0.5, -0.2, 0.1]), 2.0),\n        # Case 2\n        (np.array([0.01, 0.05, 0.2, 0.4]), np.array([1.0, 0.2, -0.3, 0.5]), 0.5),\n        # Case 3\n        (np.array([0.5]), np.array([2.0]), 1.5),\n        # Case 4\n        (np.array([0.001, 0.499]), np.array([0.05, -1.0]), 0.8),\n    ]\n\n    target_h2 = 0.5\n    all_results = []\n\n    for p, alpha, target_VA in test_cases:\n        # Step a  b: Compute unscaled additive genetic variance\n        # Var(G_i) = 2 * p_i * (1 - p_i)\n        # V_A_unscaled = sum(alpha_i^2 * Var(G_i))\n        genotypic_variances = 2 * p * (1 - p)\n        va_unscaled = np.sum(alpha**2 * genotypic_variances)\n\n        # Step c: Compute the scale factor 's'\n        # s = sqrt(target_VA / va_unscaled)\n        s = np.sqrt(target_VA / va_unscaled)\n\n        # Step d: Compute realized additive genetic variance\n        # This serves as a verification of the scaling.\n        realized_VA = (s**2) * va_unscaled\n\n        # Step e: Compute environmental variance V_E for target h^2\n        # V_E = V_A * (1 - h^2) / h^2\n        V_E = realized_VA * (1 - target_h2) / target_h2\n\n        # Step f: Compute realized heritability h^2\n        # h^2 = V_A / (V_A + V_E)\n        realized_h2 = realized_VA / (realized_VA + V_E)\n\n        # Store results for the current case\n        case_result = (s, realized_VA, V_E, realized_h2)\n        \n        # Format the results for this case into the required string format\n        # e.g., \"[s,VA,VE,h2]\" with 6 decimal places each\n        formatted_case_result = f\"[{','.join(f'{val:.6f}' for val in case_result)}]\"\n        all_results.append(formatted_case_result)\n\n    # Final print statement must match the exact required format:\n    # [[...],[...],...]\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "5076754"}, {"introduction": "最后，我们将模型与现实世界中基因效应的可检测性联系起来。本练习 [@problem_id:5076742] 模拟了研究设计者的视角，要求您为一个特定的遗传变异计算预期的统计信号强度（$t$-统计量）。这揭示了样本量、等位基因频率和效应大小如何相互作用，最终决定一个QTL能否在全基因组关联研究（GWAS）中被成功识别。", "problem": "一项关于某数量医学性状的全基因组关联研究（Genome-Wide Association Study (GWAS)）采用加性遗传模型进行。对于一个次要等位基因频率为 $p=0.3$ 的单核苷酸多态性（Single Nucleotide Polymorphism (SNP)），基因型 $G \\in \\{0,1,2\\}$ 被编码为次要等位基因的计数，并假设其遵循哈迪-温伯格平衡。性状 $Y$ 通过简单线性回归建模，\n$$\nY = \\mu + \\beta G + \\varepsilon,\n$$\n其中 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^{2})$，且 $\\sigma^{2}=1$。样本包含 $n=5000$ 名无亲缘关系的个体，真实的加性效应为 $\\beta=0.1$。加性关联检验使用来自普通最小二乘法的常用 $t$-统计量来评估原假设 $H_{0}:\\beta=0$。\n\n请仅使用基本定义和经过充分检验的结果，推导在备择假设下的期望 $t$-统计量以及相应的双边 $p$-值，检验采用自由度为 $n-2$ 的 $t$-分布。请使用哈迪-温伯格平衡下基因型的二项方差和斜率估计量的普通最小二乘方差。评估该关联是否达到标准的 GWAS 全基因组显著性阈值 $\\alpha=5\\times 10^{-8}$。\n\n将您的最终数值结果报告为一个 $1\\times 3$ 的行矩阵 $\\big[t_{\\mathrm{exp}} \\;\\; p_{\\mathrm{two\\text{-}sided}} \\;\\; I\\big]$，其中 $t_{\\mathrm{exp}}$ 是期望的 $t$-统计量，$p_{\\mathrm{two\\text{-}sided}}$ 是双边 $p$-值，$I$ 是一个指示符，如果 $p_{\\mathrm{two\\text{-}sided}}  \\alpha$ 则等于 $1$，否则等于 $0$。将 $t_{\\mathrm{exp}}$ 和 $p_{\\mathrm{two\\text{-}sided}}$ 四舍五入到四位有效数字。指示符 $I$ 必须精确地报告为 $0$ 或 $1$，无需四舍五入。", "solution": "用户希望我解决一个数量遗传学中的问题，具体涉及全基因组关联研究 (GWAS)。\n\n我需要扮演一位一丝不苟、要求严格的STEM教授。我的第一步是验证问题陈述。\n\n**问题验证 - 第1步：提取已知条件**\n\n1.  **研究类型：** 数量性状的全基因组关联研究 (GWAS)。\n2.  **遗传模型：** 加性遗传模型。\n3.  **SNP信息：**\n    *   单核苷酸多态性 (SNP)。\n    *   次要等位基因频率 (MAF)：$p = 0.3$。\n    *   基因型 $G \\in \\{0, 1, 2\\}$，编码为次要等位基因的数量。\n    *   假设基因型遵循哈迪-温伯格平衡 (HWE)。\n4.  **性状模型：**\n    *   性状 $Y$。\n    *   简单线性回归模型：$Y = \\mu + \\beta G + \\varepsilon$。\n    *   误差项：$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。\n    *   误差方差：$\\sigma^2 = 1$。\n5.  **研究样本：**\n    *   样本量：$n = 5000$ 名无亲缘关系的个体。\n6.  **效应大小：**\n    *   真实加性效应：$\\beta = 0.1$。\n7.  **假设检验：**\n    *   原假设：$H_0: \\beta = 0$。\n    *   检验统计量：来自普通最小二乘法 (OLS) 的 $t$-统计量。\n8.  **检验统计量的分布：**\n    *   自由度为 $n-2$ 的 $t$-分布。\n9.  **需使用的假设：**\n    *   HWE下基因型的二项方差。\n    *   斜率估计量的普通最小二乘方差。\n10. **显著性阈值：**\n    *   全基因组显著性阈值：$\\alpha = 5 \\times 10^{-8}$。\n11. **任务：**\n    *   推导备择假设下的期望 $t$-统计量 ($t_{\\mathrm{exp}}$)。\n    *   推导相应的双边 $p$-值 ($p_{\\text{two-sided}}$)。\n    *   评估关联是否显著 ($p_{\\text{two-sided}}  \\alpha$)。\n12. **报告格式：**\n    *   一个 $1 \\times 3$ 的行矩阵：$[t_{\\mathrm{exp}} \\;\\; p_{\\text{two-sided}} \\;\\; I]$。\n    *   $I$ 是一个指示符：如果显著则 $I=1$，否则 $I=0$。\n    *   将 $t_{\\mathrm{exp}}$ 和 $p_{\\text{two-sided}}$ 四舍五入到四位有效数字。\n    *   $I$ 必须是精确的 $0$ 或 $1$。\n\n**问题验证 - 第2步：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题使用了数量遗传学和统计学中的标准概念。用于GWAS的线性回归模型是一个基础工具。哈迪-温伯格平衡是一个标准假设。使用 $t$-检验来判断回归系数的显著性是标准的统计实践。$5 \\times 10^{-8}$ 的显著性阈值是人类遗传学中GWAS的常规阈值。该模型在科学上是合理的。\n*   **良态问题：** 所有必要的参数都已提供（$p$, $n$, $\\beta$, $\\sigma^2$, $\\alpha$）。问题要求推导期望值并进行比较，这是一个明确定义的任务。结构清晰，应该存在唯一解。\n*   **客观性：** 问题以精确的量化术语陈述。没有主观或基于观点的陈述。\n*   **科学或事实上的不健全：** 无。模型和参数在该领域是标准的。\n*   **非形式化或不相关：** 该问题是高度形式化的，并与医学遗传学中的数量性状基因座定位直接相关。\n*   **不完整或矛盾的设置：** 设置是完整的。它指定了模型、参数、样本量和假设。没有矛盾之处。\n*   **不切实际或不可行：** 参数是现实的。$n=5000$ 对于GWAS来说是一个合理的样本量。$\\beta=0.1$ 对于一个数量性状来说是一个合理的效应大小（因为它代表每个等位基因使性状改变 $0.1$ 个标准差，因为残差方差为 $1$）。$p=0.3$ 是一个常见的MAF。\n*   **病态或结构不良：** 该问题结构良好。它要求根据给定信息计算特定量。\n*   **伪深刻、琐碎或同义反复：** 该问题需要应用统计学和遗传学的基本公式来计算结果。它并不琐碎，因为它需要了解OLS估计量的属性和非中心 $t$-分布（或大样本近似）。它不是伪深刻或同义反复的。\n*   **超出科学可验证性范围：** 计算可通过标准统计理论进行验证。\n\n**问题验证 - 第3步：结论与行动**\n\n问题是有效的。我将开始解答。\n\n**解题计划**\n\n1.  **陈述 $\\beta$ 的OLS估计量：** $\\hat{\\beta}$。\n2.  **计算HWE下基因型 $G$ 的方差。** 基因型 $G$ 是次要等位基因的计数。设次要等位基因频率为 $p$。假设等位基因是独立抽取的。一个二倍体个体有两个等位基因。次要等位基因的数量 $G$ 遵循二项分布 $B(2, p)$。\n    *   $P(G=0) = (1-p)^2$\n    *   $P(G=1) = 2p(1-p)$\n    *   $P(G=2) = p^2$\n    *   $G$ 的均值是 $\\mathbb{E}[G] = 2p$。\n    *   $G$ 的方差是 $\\text{Var}(G) = 2p(1-p)$。\n3.  **陈述OLS估计量 $\\hat{\\beta}$ 的方差公式。**\n    *   $\\text{Var}(\\hat{\\beta}) = \\frac{\\sigma^2}{\\sum_{i=1}^n (G_i - \\bar{G})^2}$。\n    *   分母与 $G$ 的样本方差有关。对于大样本 $n$，$\\frac{1}{n-1}\\sum_{i=1}^n(G_i - \\bar{G})^2 \\approx \\text{Var}(G)$。\n    *   所以，$\\sum_{i=1}^n (G_i - \\bar{G})^2 \\approx (n-1) \\text{Var}(G) \\approx n \\text{Var}(G)$。\n    *   因此，$\\text{Var}(\\hat{\\beta}) \\approx \\frac{\\sigma^2}{n \\text{Var}(G)}$。\n4.  **定义 $t$-统计量。**\n    *   $t = \\frac{\\hat{\\beta} - \\beta_0}{SE(\\hat{\\beta})}$，其中 $\\beta_0$ 是原假设下的值，所以 $\\beta_0=0$。\n    *   $t = \\frac{\\hat{\\beta}}{SE(\\hat{\\beta})}$。\n    *   $SE(\\hat{\\beta})$ 是 $\\hat{\\beta}$ 的标准误，即 $\\hat{\\beta}$ 的估计方差的平方根。\n    *   估计方差为 $\\widehat{\\text{Var}}(\\hat{\\beta}) = \\frac{\\hat{\\sigma}^2}{\\sum (G_i - \\bar{G})^2}$，其中 $\\hat{\\sigma}^2$ 是残差方差的估计量。\n5.  **求 $t$-统计量的期望值。**\n    *   这是棘手的部分。在备择假设下，$t$-统计量遵循非中心 $t$-分布。\n    *   $t = \\frac{\\hat{\\beta}}{SE(\\hat{\\beta})} = \\frac{\\hat{\\beta}}{\\sqrt{\\frac{\\hat{\\sigma}^2}{\\sum(G_i-\\bar{G})^2}}}$。\n    *   让我们分析 $\\hat{\\beta}$ 的分布。由于 $Y_i = \\mu + \\beta G_i + \\varepsilon_i$，OLS估计量为 $\\hat{\\beta} = \\frac{\\sum(G_i-\\bar{G})(Y_i-\\bar{Y})}{\\sum(G_i-\\bar{G})^2}$。\n    *   $\\mathbb{E}[\\hat{\\beta}] = \\beta$（它是无偏的）。\n    *   $\\text{Var}(\\hat{\\beta}) = \\frac{\\sigma^2}{\\sum(G_i-\\bar{G})^2}$。\n    *   所以，$\\hat{\\beta} \\sim \\mathcal{N}(\\beta, \\frac{\\sigma^2}{\\sum(G_i-\\bar{G})^2})$。\n    *   检验统计量是 $t = \\frac{\\hat{\\beta}}{SE(\\hat{\\beta})}$。\n    *   在备择假设（$\\beta \\neq 0$）下，量 $\\frac{\\hat{\\beta}}{\\sqrt{\\text{Var}(\\hat{\\beta})}} = \\frac{\\hat{\\beta}}{\\sigma/\\sqrt{\\sum(G_i-\\bar{G})^2}}$ 服从正态分布 $\\mathcal{N}(\\frac{\\beta}{\\sigma/\\sqrt{\\sum(G_i-\\bar{G})^2}}, 1)$。\n    *   $t$-统计量用其估计值 $\\hat{\\sigma}$ 替换了真实的 $\\sigma$。统计量 $\\frac{(n-2)\\hat{\\sigma}^2}{\\sigma^2}$ 服从自由度为 $n-2$ 的 $\\chi^2$ 分布。\n    *   $t$-统计量 $t = \\frac{\\hat{\\beta}}{SE(\\hat{\\beta})} = \\frac{\\hat{\\beta}}{\\hat{\\sigma}/\\sqrt{\\sum(G_i-\\bar{G})^2}}$ 服从自由度为 $n-2$、非中心参数 (NCP) 为 $\\lambda = \\frac{\\beta}{\\sigma/\\sqrt{\\sum(G_i-\\bar{G})^2}}$ 的非中心 $t$-分布。\n    *   对于大自由度 $\\nu$，自由度为 $\\nu$、非中心参数为 $\\lambda$ 的非中心 $t$-分布变量的期望值约等于 $\\lambda$。对于 $\\nu  1$，精确公式为 $\\mathbb{E}[T_{\\nu, \\lambda}] = \\lambda \\sqrt{\\frac{\\nu}{2}} \\frac{\\Gamma((\\nu-1)/2)}{\\Gamma(\\nu/2)}$。\n    *   对于大的 $\\nu$，$\\sqrt{\\frac{\\nu}{2}} \\frac{\\Gamma((\\nu-1)/2)}{\\Gamma(\\nu/2)} \\approx 1$。让我们用斯特林近似 $\\Gamma(z) \\approx \\sqrt{2\\pi} z^{z-1/2} e^{-z}$ 来检验一下。\n    *   $\\frac{\\Gamma((\\nu-1)/2)}{\\Gamma(\\nu/2)} \\approx \\frac{((\\nu-1)/2)^{(\\nu-2)/2} e^{-(\\nu-1)/2}}{((\\nu)/2)^{(\\nu-1)/2} e^{-\\nu/2}} \\approx \\frac{(\\nu/2)^{(\\nu-2)/2}}{(\\nu/2)^{(\\nu-1)/2}} e^{1/2} = \\frac{e^{1/2}}{\\sqrt{\\nu/2}}$。\n    *   等等，这似乎不对。让我们使用性质：对于大的 $x$，$\\Gamma(x+a)/\\Gamma(x) \\approx x^a$。这里 $x = \\nu/2$ 且 $a = -1/2$。所以 $\\Gamma(\\nu/2-1/2)/\\Gamma(\\nu/2) \\approx (\\nu/2)^{-1/2} = \\sqrt{2/\\nu}$。\n    *   那么 $\\mathbb{E}[T_{\\nu, \\lambda}] \\approx \\lambda \\sqrt{\\frac{\\nu}{2}} \\sqrt{\\frac{2}{\\nu}} = \\lambda$。\n    *   所以，\n        $t_{\\mathrm{exp}} \\approx \\lambda = \\frac{\\beta}{\\sigma/\\sqrt{\\sum(G_i-\\bar{G})^2}} = \\frac{\\beta \\sqrt{\\sum(G_i-\\bar{G})^2}}{\\sigma}$。\n    *   我们可以近似 $\\sum(G_i-\\bar{G})^2 \\approx n \\text{Var}(G)$。\n    *   $t_{\\mathrm{exp}} \\approx \\frac{\\beta \\sqrt{n \\text{Var}(G)}}{\\sigma}$。\n6.  **计算 $t_{\\mathrm{exp}}$ 的数值。**\n    *   $p = 0.3$。\n    *   $\\text{Var}(G) = 2p(1-p) = 2(0.3)(1-0.3) = 2(0.3)(0.7) = 0.42$。\n    *   $n = 5000$。\n    *   $\\beta = 0.1$。\n    *   $\\sigma^2 = 1 \\implies \\sigma = 1$。\n    *   $t_{\\mathrm{exp}} \\approx \\frac{0.1 \\sqrt{5000 \\times 0.42}}{1} = 0.1 \\sqrt{2100}$。\n    *   $\\sqrt{2100} = \\sqrt{100 \\times 21} = 10 \\sqrt{21}$。\n    *   $\\sqrt{21} \\approx 4.58257569$。\n    *   $t_{\\mathrm{exp}} \\approx 0.1 \\times 10 \\sqrt{21} = \\sqrt{21} \\approx 4.5826$。\n    *   让我们检查期望值的近似。$\\nu = n-2 = 4998$。\n        $C = \\sqrt{\\frac{\\nu}{2}} \\frac{\\Gamma((\\nu-1)/2)}{\\Gamma(\\nu/2)} = \\sqrt{2499} \\frac{\\Gamma(2498.5)}{\\Gamma(2499)}$。\n        使用计算器 `scipy.special.gamma`：\n        `sqrt(2499) * gamma(2498.5) / gamma(2499)`\n        这个值会非常接近1。\n        让我们使用近似 $\\frac{\\Gamma(x-1/2)}{\\Gamma(x)} \\approx \\frac{1}{\\sqrt{x}}(1 - \\frac{1}{8x})$。\n        对于 $x=2499$: $\\frac{\\Gamma(2498.5)}{\\Gamma(2499)} \\approx \\frac{1}{\\sqrt{2499}}(1 - \\frac{1}{8 \\times 2499})$。\n        所以 $C = \\sqrt{2499} \\frac{1}{\\sqrt{2499}}(1 - \\frac{1}{19992}) = 1 - 1/19992 \\approx 0.99995$。\n        差异可以忽略不计。所以 $t_{\\mathrm{exp}} \\approx \\lambda$ 是一个极好的近似。\n    *   所以，$t_{\\mathrm{exp}} \\approx \\sqrt{21} \\approx 4.58257...$。四舍五入到四位有效数字：$4.583$。\n\n7.  **计算双边 $p$-值。**\n    *   问题要求的是对应于*期望* $t$-统计量的 $p$-值。这意味着我们应该为一个检验统计量值 $t = t_{\\mathrm{exp}} = \\sqrt{21}$ 计算 $p$-值。\n    *   检验是针对原假设 $H_0: \\beta=0$。在 $H_0$ 下，$t$-统计量服从自由度为 $n-2 = 4998$ 的中心 $t$-分布。\n    *   对于如此大的自由度， $t$-分布与标准正态分布 $\\mathcal{N}(0,1)$ 几乎没有区别。\n    *   双边 $p$-值为 $P(|T|  t_{\\mathrm{exp}})$，其中 $T \\sim t_{n-2}$。\n    *   $p_{\\text{two-sided}} \\approx P(|Z|  \\sqrt{21})$，其中 $Z \\sim \\mathcal{N}(0,1)$。\n    *   $p_{\\text{two-sided}} \\approx 2 \\times P(Z  \\sqrt{21})$。\n    *   $\\sqrt{21} \\approx 4.5826$。\n    *   我们需要计算 $2 \\times \\Phi(-\\sqrt{21})$，其中 $\\Phi$ 是标准正态累积分布函数。\n    *   使用计算器或软件：\n        $p_{\\text{two-sided}} = 2 \\times \\Phi(-4.58257569)$。\n        `2 * scipy.stats.norm.cdf(-4.58257569)` 给出 `4.5911e-06`。\n    *   让我们用 $t$-分布 `2 * scipy.stats.t.sf(4.58257569, df=4998)` 来更精确地计算，这也给出 `4.686e-06`。让我重新计算我的数字。\n        `2 * (1 - scipy.stats.norm.cdf(4.58257569))` 给出 `4.5911e-06`。\n        好的，让我们使用t分布的值来更精确。\n        `2 * scipy.stats.t.sf(np.sqrt(21), df=4998)` 给出 `4.6860...e-06`。\n    *   $p_{\\text{two-sided}} \\approx 4.686 \\times 10^{-6}$。这是需要四舍五入到四位有效数字的值。\n    *   将 $4.686 \\times 10^{-6}$ 四舍五入到四位有效数字是 $4.686 \\times 10^{-6}$。\n\n8.  **评估显著性。**\n    *   将计算出的 $p$-值与显著性阈值 $\\alpha = 5 \\times 10^{-8}$进行比较。\n    *   $p_{\\text{two-sided}} \\approx 4.686 \\times 10^{-6}$。\n    *   $\\alpha = 0.05 \\times 10^{-6}$。\n    *   由于 $4.686 \\times 10^{-6}  0.05 \\times 10^{-6}$，该关联在全基因组水平上不显著。\n    *   因此，指示符为 $I=0$。\n\n9.  **最终整理解决方案。**\n    *   解决方案应结构逻辑清晰，从基本定义开始。\n    *   每个数学实体都必须使用 LaTeX。\n    *   没有 markdown 标题。\n    *   最终答案必须采用指定的矩阵格式。\n\n我已经有了所有组件。现在我将以要求的格式写出完整的解决方案。我需要小心处理每个数字和变量的LaTeX语法。问题陈述本身包含LaTeX，我应该遵循那种风格。我必须精确地使用 `$n=5000$` 而不仅仅是 `5000`。这个严格的规则是这个角色的关键部分。再次检查提示。...最终答案必须在 `\\boxed{...}` 中。...单个值或多个值使用 `pmatrix`。我的答案有3个部分，所以我将使用 `pmatrix`。解释应该是一个连续的文本块。我将用段落分隔来组织它。我会小心地在使用所有术语之前定义它们。逻辑应如要求的那样从第一性原理出发。问题陈述说“仅使用基本定义和经过充分检验的结果，推导...”。我的推导似乎很好地遵循了这一指示。对于大自由度，非中心t统计量期望值的近似是标准结果，样本平方和的近似对于大 $n$ 也是标准的。使用正态近似计算t分布的p值对于大自由度也是标准的。让我们再次进行最终计算以确保数字无误。...结果看起来正确且稳健。推理是合理的。我准备好编写最终输出了。", "answer": "$$\n\\boxed{\\begin{pmatrix} 4.583  4.686 \\times 10^{-6}  0 \\end{pmatrix}}\n$$", "id": "5076742"}]}