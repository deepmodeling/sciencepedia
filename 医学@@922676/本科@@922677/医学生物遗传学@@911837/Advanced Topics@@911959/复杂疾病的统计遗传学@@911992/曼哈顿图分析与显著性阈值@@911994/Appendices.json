{"hands_on_practices": [{"introduction": "要熟练解读曼哈顿图，第一步是掌握其纵坐标的含义。这项练习将带你实践一项基本技能：将图上的一个数据点从其纵坐标值（$-\\log_{10}(p)$）转换回其对应的P值。通过这个过程，你将深刻理解为何对数尺度是表示统计显著性的强大工具，以及为何坐标轴上数值的微小变化代表着证据强度的巨大差异 [@problem_id:5056435]。", "problem": "在医学遗传学中，全基因组关联分析（Genome-Wide Association Studies, GWAS）通常使用曼哈顿图（Manhattan plot）来可视化整个基因组的统计显著性。在一个标准的曼哈顿图中，每个被测试的单核苷酸多态性（SNP）的纵轴坐标被定义为其关联检验p值的以10为底的负对数。考虑一个在此类图上纵坐标为 $y=12$ 的SNP。请仅使用曼哈顿图坐标轴的定义和对数的性质，计算该SNP对应的p值 $p$。然后，从相同的基本定义出发，严格证明纵轴上1个单位的差异为何对应于p值的十倍变化。最终p值需用科学计数法表示。无需四舍五入。", "solution": "该问题提问清晰且科学合理，其依据是全基因组关联分析（GWAS）中所使用的曼哈顿图纵轴的标准定义。我们按顺序解决问题陈述中的两个部分。\n\n第一部分：p值的计算。\n\n问题陈述指出，曼哈顿图上的纵坐标 $y$ 定义为关联检验p值 $p$ 的以10为底的负对数。这个关系可以用以下方程表示：\n$$y = -\\log_{10}(p)$$\n我们已知一个特定的单核苷酸多态性（SNP）的纵坐标为 $y = 12$。将此值代入定义方程，得到：\n$$12 = -\\log_{10}(p)$$\n为了求解p值 $p$，我们首先将方程两边同乘以-1以分离对数项：\n$$-12 = \\log_{10}(p)$$\n根据对数的定义，方程 $\\log_b(x) = a$ 等价于 $b^a = x$。将此原理应用于我们的方程，其中底为 $b=10$，真数为 $x=p$，值为 $a=-12$，我们可以将对数方程改写为其指数形式：\n$$p = 10^{-12}$$\n问题要求答案以科学计数法表示。$10^{-12}$ 等同于 $1 \\times 10^{-12}$。因此，该SNP的p值为 $1 \\times 10^{-12}$。\n\n第二部分：p值十倍变化的证明。\n\n我们被要求严格证明为什么纵轴上1个单位的差异对应于p值的十倍变化。让我们考虑纵轴上的两个不同点 $y_1$ 和 $y_2$，以及它们对应的p值 $p_1$ 和 $p_2$。根据定义：\n$$y_1 = -\\log_{10}(p_1)$$\n$$y_2 = -\\log_{10}(p_2)$$\n我们设定这两个纵坐标之间的差为1：\n$$y_2 - y_1 = 1$$\n现在，将 $y_1$ 和 $y_2$ 的表达式代入这个差分方程：\n$$(-\\log_{10}(p_2)) - (-\\log_{10}(p_1)) = 1$$\n整理各项得到：\n$$\\log_{10}(p_1) - \\log_{10}(p_2) = 1$$\n我们现在应用对数的商法则，即 $\\log_b(u) - \\log_b(v) = \\log_b(\\frac{u}{v})$。将此法则应用于我们的方程，得出：\n$$\\log_{10}\\left(\\frac{p_1}{p_2}\\right) = 1$$\n为了找到 $p_1$ 和 $p_2$ 之间的关系，我们将此对数方程转换回其指数形式：\n$$\\frac{p_1}{p_2} = 10^1$$\n$$\\frac{p_1}{p_2} = 10$$\n这个结果表明 $p_1 = 10 \\times p_2$。由于我们定义了 $y_2 - y_1 = 1$，即 $y_2  y_1$，这意味着p值 $p_2$（对应于更高、更显著的y值）是p值 $p_1$（对应于较低的y值）的十分之一。反之，将p值增加10倍（一次十倍的增长）会导致y值减少1。将p值减少为原来的十分之一（一次十倍的降低）会导致y值增加1。因此，$y$轴上1个单位的变化精确地对应于p值 $p$ 的十倍变化。这就完成了严格的证明。", "answer": "$$\\boxed{1 \\times 10^{-12}}$$", "id": "5056435"}, {"introduction": "曼哈顿图的一个关键特征是那条标志着全基因组显著性水平的水平线。这项练习将深入探讨该阈值背后的统计学原理，引导你从第一性原理出发推导邦费罗尼校正（Bonferroni correction）。通过这项实践，你将理解在进行全基因组关联研究（GWAS）中的海量检验时，我们是如何控制总体错误率的 [@problem_id:5056489]。", "problem": "全基因组关联研究（GWAS）检验的是表型与全基因组遗传变异之间的关联。考虑一项检验 $m=8{,}000{,}000$ 个变异的插补GWAS，并假设为了校准的目的，各个变异的检验统计量是相互独立的。曼哈顿图上需要标注一条水平线，表示用于将总体错误率（FWER）控制在 $\\alpha=0.05$ 水平的单位点显著性阈值。\n\n从第一性原理出发，使用 FWER 的定义和布尔不等式（联合界），在除了有效的 $p$ 值之外没有任何假设的情况下，推导出保证 $\\mathrm{FWER} \\leq \\alpha$ 的单位点显著性阈值。然后，将此推导出的阈值与曼哈顿图上传统的 $5\\times 10^{-8}$ 水平线进行比较，这条线在历史上近似于对大约 $10^{6}$ 个有效独立检验的控制。\n\n令 $t_{\\mathrm{Bonf}}$ 表示您推导出的 Bonferroni 单位点阈值。计算比率\n$$\nR \\;=\\; \\frac{5\\times 10^{-8}}{t_{\\mathrm{Bonf}}}.\n$$\n以精确形式（不进行四舍五入）报告 $R$ 作为您的最终答案。在您的推理中，判断对于 $m=8{,}000{,}000$ 个独立检验，传统的 $5 \\times 10^{-8}$ 水平线是过于保守还是过于宽松。$R$ 不需要单位。", "solution": "水平为 $\\alpha$ 的总体错误率（FWER）是在 $m$ 个原假设以共同的单位检验阈值 $t$ 进行检验时，做出至少一次错误拒绝的概率。形式上，如果 $V$ 表示假阳性的数量，那么\n$$\n\\mathrm{FWER} \\;=\\; \\Pr(V \\ge 1) \\;=\\; \\Pr\\Big(\\bigcup_{i=1}^{m}\\{\\text{检验 } i \\text{ 为假阳性}\\}\\Big).\n$$\n根据布尔不等式（联合界），对于真实原假设下的有效 $p$ 值，\n$$\n\\Pr\\Big(\\bigcup_{i=1}^{m} A_i\\Big) \\;\\le\\; \\sum_{i=1}^{m} \\Pr(A_i),\n$$\n其中 $A_i$ 是检验 $i$ 为假阳性的事件。如果每个假设都以单位检验阈值 $t$ 进行检验，那么在原假设下 $\\Pr(A_i) \\le t$，因此联合界意味着\n$$\n\\mathrm{FWER} \\;\\le\\; m\\,t.\n$$\n为了保证 $\\mathrm{FWER} \\le \\alpha$，只需选择 $t$ 使得 $m\\,t \\le \\alpha$。满足此条件的最大选择是 Bonferroni 阈值\n$$\nt_{\\mathrm{Bonf}} \\;=\\; \\frac{\\alpha}{m}.\n$$\n对于给定的研究，其中 $m=8{,}000{,}000$ 且 $\\alpha=0.05$，我们有\n$$\nt_{\\mathrm{Bonf}} \\;=\\; \\frac{0.05}{8{,}000{,}000} \\;=\\; 6.25 \\times 10^{-9}.\n$$\n传统的曼哈顿图水平线位于 $t_{\\mathrm{conv}} = 5 \\times 10^{-8}$。所要求的比率为\n$$\nR \\;=\\; \\frac{t_{\\mathrm{conv}}}{t_{\\mathrm{Bonf}}}\n\\;=\\; \\frac{5 \\times 10^{-8}}{6.25 \\times 10^{-9}}\n\\;=\\; 8.\n$$\n在独立性假设下的解释：因为 $t_{\\mathrm{conv}}  t_{\\mathrm{Bonf}}$，所以传统的水平线没有适用于 $m=8{,}000{,}000$ 个检验的 Bonferroni 控制那么严格。在独立性假设下，当使用共同阈值 $t$ 时，精确的 FWER 为\n$$\n\\mathrm{FWER}_{\\mathrm{indep}} \\;=\\; 1 - (1 - t)^{m},\n$$\n该值随 $t$ 严格递增。因此，使用 $t_{\\mathrm{conv}}$ 而非 $t_{\\mathrm{Bonf}}$ 会导致 $\\mathrm{FWER}_{\\mathrm{indep}}  0.05$。因此，对于 $m=8{,}000{,}000$ 个独立检验，传统的 $5 \\times 10^{-8}$ 水平线是宽松的（过于宽容），相对于在 $\\alpha=0.05$ 水平下的 Bonferroni 控制，其宽松因子为 $R=8$。", "answer": "$$\\boxed{8}$$", "id": "5056489"}, {"introduction": "曼哈顿图不仅能帮助我们识别跨过显著性阈值的信号，还能让我们比较不同信号的相对强度。这项练习将挑战你利用对数尺度，来量化两个高度显著的单核苷酸多态性（SNP）之间证据强度的差异。这将加深你对图中视觉距离如何转化为P值数量级差异的理解 [@problem_id:5056459]。", "problem": "在医学遗传学中，一项全基因组关联研究 (GWAS) 使用曼哈顿图，其纵轴定义为单核苷酸多态性 (SNP) 关联$p$值的负常用对数，记作 $-\\log_{10}(p)$。两个独立的SNP具有关联$p$值 $p_{1} = 2 \\times 10^{-9}$ 和 $p_{2} = 8 \\times 10^{-9}$。使用曼哈顿图纵轴的定义，计算这两个SNP之间的纵向距离，该距离定义为绝对差值 $\\left|-\\log_{10}(p_{1}) - \\left(-\\log_{10}(p_{2})\\right)\\right|$。将您的答案四舍五入到四位有效数字。在您的推理中，使用$p$值和曼哈顿图的基本定义，结合医学遗传学中常用的全基因组显著性阈值，评论这种视觉差异在证据强度方面是否有意义。最终报告的值必须仅为数值上的距离。", "solution": "该问题要求完成两项任务：首先，计算两个具有特定$p$值的单核苷酸多态性 (SNP) 在曼哈顿图上的纵向距离；其次，在医学遗传学和全基因组关联研究 (GWAS) 的背景下，评论此距离的意义。\n\n首先，我将验证问题陈述。\n已知条件如下：\n1. 曼哈顿图的纵轴定义为 $-\\log_{10}(p)$，其中 $p$ 是关联$p$值。\n2. 第一个SNP的$p$值为 $p_{1} = 2 \\times 10^{-9}$。\n3. 第二个SNP的$p$值为 $p_{2} = 8 \\times 10^{-9}$。\n4. 纵向距离定义为绝对差值 $\\left|-\\log_{10}(p_{1}) - \\left(-\\log_{10}(p_{2})\\right)\\right|$。\n5. 最终数值答案必须四舍五入到四位有效数字。\n\n这个问题具有科学依据。曼哈顿图y轴的定义、遗传关联的$p$值概念以及给定的数值在统计遗传学领域都是标准且符合实际的。在人类遗传学中，常规的全基因组显著性阈值为 $p  5 \\times 10^{-8}$，而所提供的$p$值远低于此阈值，代表了强关联信号，正如曼哈顿图上显著峰值所预期的那样。这个问题是适定的，为获得唯一解提供了所有必要信息。语言客观明确。因此，该问题被认为是有效的。\n\n我现在开始求解。\n\n这两个SNP在曼哈顿图上的纵坐标（分别表示为 $y_1$ 和 $y_2$）由它们各自$p$值的负常用对数给出：\n$$y_{1} = -\\log_{10}(p_{1})$$\n$$y_{2} = -\\log_{10}(p_{2})$$\n\n纵向距离 $S$ 定义为这两个坐标之差的绝对值：\n$$S = |y_{1} - y_{2}| = \\left|-\\log_{10}(p_{1}) - (-\\log_{10}(p_{2}))\\right|$$\n\n简化绝对值内的表达式：\n$$S = \\left|-\\log_{10}(p_{1}) + \\log_{10}(p_{2})\\right| = \\left|\\log_{10}(p_{2}) - \\log_{10}(p_{1})\\right|$$\n\n使用对数恒等式 $\\log(a) - \\log(b) = \\log\\left(\\frac{a}{b}\\right)$，距离的表达式变为：\n$$S = \\left|\\log_{10}\\left(\\frac{p_{2}}{p_{1}}\\right)\\right|$$\n\n现在，我将代入 $p_{1}$ 和 $p_{2}$ 的给定数值：\n$$p_{1} = 2 \\times 10^{-9}$$\n$$p_{2} = 8 \\times 10^{-9}$$\n\n这两个$p$值的比率为：\n$$\\frac{p_{2}}{p_{1}} = \\frac{8 \\times 10^{-9}}{2 \\times 10^{-9}} = 4$$\n\n将该比率代回 $S$ 的方程中：\n$$S = |\\log_{10}(4)|$$\n因为 $4  1$，其常用对数为正，所以绝对值是多余的。\n$$S = \\log_{10}(4)$$\n\n为了获得数值，我们计算对数：\n$$S \\approx 0.60205999...$$\n\n问题要求答案四舍五入到四位有效数字。\n$$S \\approx 0.6021$$\n\n至此，完成了问题的第一部分。\n\n对于第二部分，我将评论这种视觉差异在GWAS背景下的意义。\n在GWAS中，$p$值表示在SNP与性状之间没有真实关联的原假设下，观察到等于或强于所测关联强度的概率。较小的$p$值提供了更强的证据来反对原假设。\n\n全基因组显著性的常规阈值是 $p  5 \\times 10^{-8}$。该阈值考虑了同时检验数百万个SNP所带来的多重检验负担。曼哈顿图y轴上对应的数值是：\n$$y_{threshold} = -\\log_{10}(5 \\times 10^{-8}) = -(\\log_{10}(5) + \\log_{10}(10^{-8})) = 8 - \\log_{10}(5) \\approx 8 - 0.6990 = 7.301$$\ny值超过 $\\approx 7.3$ 的SNP被认为是“命中”(hits)。\n\n让我们计算这两个给定SNP的y坐标：\n$$y_{1} = -\\log_{10}(2 \\times 10^{-9}) = 9 - \\log_{10}(2) \\approx 9 - 0.3010 = 8.699$$\n$$y_{2} = -\\log_{10}(8 \\times 10^{-9}) = 9 - \\log_{10}(8) \\approx 9 - 0.9031 = 8.097$$\n\n$y_1$ 和 $y_2$ 都远大于约7.3的显著性阈值。因此，这两个SNP都代表了高度显著的关联。\n\n在对数尺度上，约0.6021的视觉距离确实是有意义的。对数尺度的使用将统计证据上的乘性差异（即$p$值的比率）转化为图上的加性线性距离。在本例中，距离 $S = \\log_{10}(4)$ 直接反映了SNP2的$p$值是SNP1的四倍这一事实。这意味着SNP1的关联证据强度要强于SNP2。尽管两个发现都具有稳健的显著性，但具有较小$p$值（因此在图上位置更高）的SNP通常被认为是给定基因组位点中的“领头”(lead) SNP，并在后续的功能验证和精细定位研究中被优先考虑。图上的视觉差异提供了对两个信号之间证据相对强度的直接、量化的比较。", "answer": "$$\\boxed{0.6021}$$", "id": "5056459"}]}