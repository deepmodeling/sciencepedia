## 引言
在遗传学研究中，我们不仅关注单个基因的效应，更需要理解基因组上不同位点的等位基因是如何协同遗传并共同影响性状的。单倍型（Haplotype）与[连锁不平衡](@entry_id:146203)（Linkage Disequilibrium, LD）正是从群体层面破解这种复杂[遗传模式](@entry_id:137802)的核心概念，它们是连接基因组结构与疾病、进化的桥梁。然而，从个体的双倍体基因型转向确定单条染色体上的等位基因组合（即单倍型），并量化这些组合在群体中的非随机关联，构成了[群体遗传学](@entry_id:146344)的一个关键挑战。理解了这一挑战，我们才能揭示复杂疾病背后的遗传奥秘。

本文旨在系统性地引导读者深入这一领域。在第一章“原理与机制”中，我们将奠定理论基础，阐明单倍型、染色体时相以及连锁不平衡的定义与核心度量方法。随后，在第二章“应用与跨学科关联”中，我们将探索这些理论如何在全基因组关联研究（GWAS）、临床诊断、[精准医疗](@entry_id:152668)和人类[进化史](@entry_id:178692)追溯中大放异彩。最后，通过第三章“动手实践”，读者将有机会运用所学知识，亲手解决具体问题，从而将理论转化为可应用的技能。

## 原理与机制

本章深入探讨单倍型（haplotype）和连锁不平衡（linkage disequilibrium）的核心原理。我们将从最基本的定义开始，阐明基因型、单倍型与染色体时相（phase）之间的关系，然后引入[连锁不平衡](@entry_id:146203)的定量度量，并剖析其背后的进化动力学机制。最后，我们将讨论在[群体遗传学](@entry_id:146344)和精准医学中用于评估连锁不平衡的多种高级统计量及其应用。

### 从基因型到单倍型：时相的定义

在[二倍体](@entry_id:268054)生物中，每个常染色体基因座都存在两个等位基因，它们分别位于一对同源染色体上。**基因型（genotype）** 指的是一个个体在特定基因座上所拥有的等位基因组合。例如，对于一个具有等位基因 $A$ 和 $a$ 的基因座，一个个体可以是纯合子（$A/A$ 或 $a/a$）或杂合子（$A/a$）。然而，当我们同时考虑多个基因座时，情况变得更加复杂。

**单倍型（haplotype）** 是指在单条染色体上共同存在的一组等位基因的特定组合。它代表了等位基因在物理上的共遗传单元。为了理解基因型和单倍型之间的区别，我们必须引入**染色体时相（chromosomal phase）**的概念，即确定特定等位基因具体位于哪一条同源染色体上。

考虑一个在两个双等位基因[单核苷酸多态性](@entry_id:173601)（SNP）位点上均为杂合的二倍体个体，其基因型为 $A/a$ 和 $B/b$。仅从这一基因型信息出发，我们无法确定这些等位基因在两条同源染色体上的具体排列方式。存在两种可能性 [@problem_id:5042930]：

1.  **耦合相（Coupling Phase）或顺式（Cis）**：等位基因 $A$ 和 $B$ 位于同一条染色体上，而等位基因 $a$ 和 $b$ 位于其同源染色体上。此时，该个体的单倍型对为 $\{AB, ab\}$。

2.  **相斥相（Repulsion Phase）或反式（Trans）**：等位基因 $A$ 和 $b$ 位于同一条染色体上，而等位基因 $a$ 和 $B$ 位于其同源染色体上。此时，该个体的单倍型对为 $\{Ab, aB\}$。

对于一个双重杂合子，仅凭标准的基因分型技术通常无法区分这两种时相。这种不确定性被称为**时相模糊（phase ambiguity）**。然而，如果个体在至少一个位点上是纯合的，时相就是确定的。例如，一个基因型为 $A/A$ 和 $B/b$ 的个体，其两条同源染色体都必须携带等位基因 $A$。因此，其单倍型对只能是 $\{AB, Ab\}$，时相是明确的。

明确单倍型和时相在医学遗传学中至关重要，因为致病突变往往与特定的单倍型相关联，而单倍型结构本身也影响着疾病[基因定位](@entry_id:138023)和个体化用药指导。

### 连锁不平衡：量化非随机关联

当等位基因在群体中的传递是[独立事件](@entry_id:275822)时，我们预期一个特定单倍型的频率等于其所包含的各个[等位基因频率](@entry_id:146872)的乘积。例如，如果位点 A 和位点 B 之间是独立的，那么 $AB$ 单倍型的频率 $p_{AB}$ 应等于等位基因 $A$ 的频率 $p_A$ 与等位基因 $B$ 的频率 $p_B$ 之积，即 $p_{AB} = p_A p_B$。这种等位基因间的统计独立状态被称为**连锁平衡（linkage equilibrium, LE）**。

然而，在真实群体中，位于同一染色体上的等位基因往往并非独立遗传。**[连锁不平衡](@entry_id:146203)（linkage disequilibrium, LD）** 指的是在群体水平上，观察到的单倍型频率偏离连锁平衡[期望值](@entry_id:150961)的现象。

衡量连锁不平衡的主要指标是 **LD 系数 $D$**。它被定义为观察到的特定单倍型频率与期望频率之差。以 $A$ 和 $B$ 两个等位基因为参照，其定义为：

$D = p_{AB} - p_A p_B$

当 $D \neq 0$ 时，表明位点 A 和 B 之间存在[连锁不平衡](@entry_id:146203)。一个正值的 $D$ 意味着 $AB$ 单倍型的频率高于预期，这通常也伴随着其互补单倍型 $ab$ 的频率高于预期。这种情况表明耦合相单倍型（$AB$ 和 $ab$）在群体中过量存在。相反，一个负值的 $D$ 则意味着相斥相单倍型（$Ab$ 和 $aB$）的频率高于预期 [@problem_id:4355693]。

基于 $D$ 的定义，我们可以推导出所有四种单倍型频率与等位基因频率之间的关系 [@problem_id:1501138]：
- $p_{AB} = p_A p_B + D$
- $p_{Ab} = p_A p_b - D$
- $p_{aB} = p_a p_B - D$
- $p_{ab} = p_a p_b + D$
（其中 $p_a = 1 - p_A$ 且 $p_b = 1 - p_B$）

例如，在一个群体中，SNP 等位基因 C 和 T 的频率分别为 $p_C = 0.65$ 和 $p_T = 0.35$，另一基因座等位基因 H 和 L 的频率分别为 $p_H = 0.32$ 和 $p_L = 0.68$。如果测得 $D = -0.035$，我们可以计算出 $TL$ 单倍型的频率为 $p_{TL} = p_T p_L + D = (0.35)(0.68) + (-0.035) = 0.203$ [@problem_id:1501138]。

同样，我们可以通过群体的单倍型计数来计算 $D$ 值。在一个包含 1000 条染色体的样本中，如果 CG, CA, TG, TA 单倍型的计数分别为 600, 50, 150, 200，则单倍型频率 $p_{CG} = 0.6$。等位基因频率为 $p_C = (600+50)/1000 = 0.65$ 和 $p_G = (600+150)/1000 = 0.75$。因此，$D = p_{CG} - p_C p_G = 0.6 - (0.65 \times 0.75) = 0.1125$ [@problem_id:1944761]。

值得注意的是，[连锁不平衡](@entry_id:146203)（LD）与**哈迪-温伯格平衡（Hardy-Weinberg equilibrium, HWE）**是两个独立的概念。HWE 描述的是在一个大的[随机交配](@entry_id:149892)群体中，单个基因座的[基因型频率](@entry_id:141286)与其等位基因频率之间的关系。而 LD 描述的是不同基因座的等位基因在单倍型水平上的关联。一个群体可以在每个基因座上都满足 HWE，但同时在这些基因座之间表现出强烈的 LD。例如，一个由 $p_{AB}=0.4, p_{Ab}=0.1, p_{aB}=0.1, p_{ab}=0.4$ 组成的配子池，其等位基因频率 $p_A=0.5, p_B=0.5$。[随机交配](@entry_id:149892)产生的合子在 A 和 B 两个基因座上都将符合 HWE [基因型频率](@entry_id:141286)（$P(AA)=0.25, P(Aa)=0.5, P(aa)=0.25$）。然而，配子池本身存在显著的 LD，因为 $D = 0.4 - (0.5 \times 0.5) = 0.15 \neq 0$ [@problem_id:2728637]。

理解了单倍型频率和 LD，我们就可以计算群体中特定基因型的频率。例如，双重杂合子（基因型为 A/G 和 C/T）的个体必须携带 $\{AC, GT\}$ 或 $\{AT, GC\}$ 两种单倍型组合。因此，其期望频率为 $2(p_{AC}p_{GT} + p_{AT}p_{GC})$ [@problem_id:1944753]。

### 塑造[连锁不平衡](@entry_id:146203)的进化力量

[连锁不平衡](@entry_id:146203)的状态并非静止不变，它受到多种进化力量的共同作用。这些力量共同决定了在一个特定基因组区域内 LD 的强度和模式。

#### 重组：LD的衰减者

**[基因重组](@entry_id:143132)（recombination）** 是[减数分裂](@entry_id:140281)过程中同源染色体间交换遗传物质的过程，它是打破等位基因间物理关联、从而削弱 LD 的主要力量。两个基因座在染色体上的物理距离越远，它们之间发生重组的概率（重组率，$c$）就越高。

在没有其他进化力量干扰的情况下，LD 会随世代的推移而指数衰减。下一代的 LD 系数 $D_{t+1}$ 与当前世代的 $D_t$ 之间的关系为：

$D_{t+1} = (1-c) D_t$

这一简单关系表明，每一代，LD 的值都会因重组而减少一个比例 $c$ [@problem_id:1501152]。经过 $t$ 代后，LD 的值为：

$D_t = (1-c)^t D_0$

这个公式揭示了一个核心原则：物理上紧密连锁的位点（$c$ 值小）其 LD 衰减得非常缓慢，而物理距离较远或位于不同染色体上的位点（$c$ 值大，最大为 $0.5$）其 LD 衰减得非常快。例如，如果初始 LD 值相同，但 A-B 位点对的重组率 $c_{AB}=0.02$，而 A-C 位点对的重组率 $c_{AC}=0.20$，经过 5 代后，A-C 对的 LD 将比 A-B 对的 LD 衰减得快得多 [@problem_id:1944727]。

正是由于[重组率](@entry_id:203271)与物理距离的这种关系，基因组中常常观察到**单倍型块（haplotype blocks）**。这些区域内的[重组率](@entry_id:203271)极低，导致内部的多个 SNP 之间表现出强烈的 LD，并作为一个遗传单元被整体继承 [@problem_id:1944761]。

#### 创造和维持LD的力量

虽然重组不断地瓦解 LD，但其他进化力量会创造和维持它。

1.  **突变（Mutation）**：当一个新的突变在一个特定个体的某条染色体上产生时，这个新的等位基因最初与该染色体背景上的所有其他等位基因处于完全的[连锁不平衡](@entry_id:146203)状态。这是 LD 产生的最根本来源。

2.  **[遗传漂变](@entry_id:145594)（Genetic Drift）**：在有限的群体中，由于[随机抽样](@entry_id:175193)效应，单倍型的频率会发生偶然波动。这种[随机过程](@entry_id:268487)可以偶然地创造出 LD，即使对于完全不连锁的位点也是如此。一个经典的例子是**[奠基者效应](@entry_id:146976)（founder effect）**，一个[小群](@entry_id:198763)体从一个大的连锁平衡的群体中分离出来，仅仅因为创始个体携带的单倍型组合是随机的，就可能在新群体中产生显著的 LD [@problem_id:1501157]。

3.  **群体混合（Population Admixture）**：当两个或多个原先隔离、且等位基因频率不同的群体混合时，即使每个源群体内部都处于连锁平衡，混合后的新群体也[几乎必然](@entry_id:262518)会产生 LD。这是因为源群体中[等位基因频率](@entry_id:146872)的差异导致混合群体中某些单倍型组合的频率偏离了基于混合后平均等位基因频率计算出的[期望值](@entry_id:150961)。例如，将一个高频 $A$ (0.8) 和低频 $B$ (0.3) 的群体与一个低频 $A$ (0.1) 和高频 $B$ (0.6) 的群体以相等比例混合，混合群体中会立即出现负的 $D$ 值（$D = -0.0525$），显示 $A$ 和 $B$ 倾向于不出现在同一条染色体上 [@problem_id:1501182]。

4.  **自然选择（Natural Selection）**：当选择作用于特定的等位基因组合（即特定的单倍型）时，LD 也会被改变。如果某个单倍型比其他单倍型具有更高的适应性（上位效应选择），其频率将在群体中增加，从而产生或增强 LD。

### 高级度量及其在精准医学中的应用

尽管 $D$ 在理论上很基础，但它有一个主要缺点：其取值范围受到等位基因频率的严重制约。$D$ 的最大值 $D_{\max}$ 和最小值 $D_{\min}$ 由以下公式（即 Lewontin's bounds）给出 [@problem_id:4355693]：

$D_{\max} = \min\{p_A(1-p_B), p_B(1-p_A)\}$
$D_{\min} = -\min\{p_A p_B, (1-p_A)(1-p_B)\}$

这种对[等位基因频率](@entry_id:146872)的依赖性使得直接比较不同位点对之间的 $D$ 值变得困难。为了克服这一限制，研究人员开发了标准化的 LD 度量。

#### 标准化LD系数 $D'$

$D'$ 是将 $D$ 按其在给定等位基因频率下的最大可[能值](@entry_id:187992)进行标准化后的度量：

$D' = \frac{D}{D_{\max}}$  (如果 $D > 0$) 或  $D' = \frac{D}{|D_{\min}|}$ (如果 $D  0$)

$D'$ 的取值范围是 $[-1, 1]$。$|D'|=1$ 的状态被称为**完全连锁不平衡**，它意味着在群体中，四个可能的单倍型中至少有一个不存在。这通常被解释为在这两个位点之间没有发生过历史性的重组事件。因此，$D'$ 对于推断重组历史和界定单倍型块非常有用。

#### 平方[相关系数](@entry_id:147037) $r^2$

另一个重要的标准化度量是**平方[相关系数](@entry_id:147037) $r^2$**，它等同于两个位点等位基因指示变量之间的皮尔逊相关系数的平方：

$r^2 = \frac{D^2}{p_A(1-p_A)p_B(1-p_B)}$

$r^2$ 的取值范围是 $[0, 1]$。它的统计学意义非常明确：$r^2$ 表示一个位点的基因型信息能在多大程度上预测另一个位点的基因型信息。$r^2=1$ 意味着两个位点携带完全相同的信息，知道一个位点的基因型就可以完美预测另一个。

在基因组学和精准医学应用中，$r^2$ 是一个极其重要的指标。在全基因组关联研究（GWAS）中，它被用于**标签SNP（tag SNP）选择**，即用一个 SNP 来代表整个高 LD 区域（由高 $r^2$ 值定义）的遗传变异。它也是**基因型插补（genotype imputation）** 准确性的核心预测因子，该技术利用高 $r^2$ 关系，通过参考面板来推断未被直接分型的 SNP 的基因型 [@problem_id:4355693]。

#### 不同度量的比较与选择

$D'$ 和 $r^2$ 提供了互补的信息，有时甚至会对 LD 的“强度”给出不同的排序。考虑一个场景，我们比较两个 SNP 对 (X-Y 和 X-Z) 的 LD [@problem_id:4355727]。

-   **X-Y 对**: $p_X = 0.05, p_Y = 0.50$。由于一个单倍型缺失，计算得出 $D'_{XY}=1.0$，表明没有历史重组。但由于[等位基因频率](@entry_id:146872)差异巨大，一个位点对另一个的预测能力很弱，导致 $r^2_{XY} \approx 0.053$。
-   **X-Z 对**: $p_X = 0.05, p_Z = 0.10$。计算得出 $D'_{XZ} \approx 0.956$，表明可能存在少量历史重组。但由于等位基因频率更为匹配，两个位点间的预测能力强得多，导致 $r^2_{XZ} \approx 0.433$。

在这个例子中，$D'$ 会认为 X-Y 对的 LD 更“强”（因为 $D'=1$），而 $r^2$ 则认为 X-Z 对的 LD 更强（因为它有更好的预测能力）。对于需要选择标签 SNP 或评估[插补](@entry_id:270805)质量的精准医学应用来说，$r^2$ 是更相关的指标。而对于研究群体历史和重组事件的研究者来说，$D'$ 可能提供更直接的洞见。因此，对 LD 指标的正确选择和解释取决于具体的科学问题。