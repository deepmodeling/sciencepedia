{"hands_on_practices": [{"introduction": "在进行全基因组关联研究（GWAS）时，数据质量控制是确保结果可靠性的第一步。哈迪-温伯格平衡（HWE）原则是群体遗传学的基石，也为我们提供了一个强有力的质控工具。本练习旨在通过从基本定义出发，推导和计算等位基因频率及预期的基因型频率，来巩固您对HWE核心概念的理解，并为您在实际研究中识别可能由技术误差引起的异常数据打下坚实基础 [@problem_id:5041680]。", "problem": "一个全基因组关联研究（GWAS）的质量控制流程要求计算次要等位基因频率，并检验其与哈迪-温伯格平衡（HWE）期望值的一致性。考虑一个具有两个等位基因（表示为 $A$ 和 $a$）的单核苷酸多态性，在一个从大型随机交配群体中抽取的 $N$ 个无亲缘关系个体中进行了基因分型。在一个 $N = 1000$ 个个体的样本中，观察到的基因型计数为 $n_{AA} = 540$，$n_{Aa} = 420$ 和 $n_{aa} = 40$。\n\n仅使用群体遗传学和孟德尔分离定律的核心定义，按以下步骤进行：\n\n1. 从等位基因频率的定义（即一个等位基因的拷贝数除以样本中等位基因的总拷贝数）出发，用 $n_{AA}$、$n_{Aa}$、$n_{aa}$ 和 $N$ 表示样本中等位基因 $a$ 的次要等位基因频率 $p$。\n\n2. 利用哈迪-温伯格平衡的基本假设（随机交配、无选择、无突变、无迁移、以及足够大的群体），从第一性原理出发，推导出基因型 $AA$、$Aa$ 和 $aa$ 的期望频率，用等位基因频率表示，其中 $p$ 表示等位基因 $a$ 的频率，$q$ 表示等位基因 $A$ 的频率。\n\n3. 使用从观察计数中得到的 $p$ 值，计算 $AA$、$Aa$ 和 $aa$ 在哈迪-温伯格平衡下的期望基因型频率的数值。将你的概率值四舍五入到 $4$ 位有效数字，并以小数形式表示。\n\n以单行矩阵的形式提供你的最终答案，顺序为 $\\big(P(AA),\\,P(Aa),\\,P(aa)\\big)$，不带单位。", "solution": "该问题要求基于群体遗传学原理，特别是哈迪-温伯格平衡（HWE）原则，对来自单核苷酸多态性（SNP）的基因型数据进行三部分分析。分析过程首先是推导等位基因频率的公式，然后推导HWE下的基因型频率原则，最后将这些原则应用于所提供的数据。\n\n### 第1部分：次要等位基因频率表达式的推导\n\n第一个任务是用观察到的基因型计数 $n_{AA}$、$n_{Aa}$、$n_{aa}$ 和总样本量 $N$ 来表示样本中等位基因 $a$ 的次要等位基因频率 $p$。\n\n等位基因频率的定义是，在一个群体样本中，该等位基因的总拷贝数除以该基因所有等位基因的总拷贝数。由于人类是二倍体生物，每个个体对任何常染色体基因都携带两个等位基因。\n\n给定一个 $N$ 个个体的样本，样本中等位基因的总数为 $2N$。问题陈述基因型计数为：基因型 $AA$ 有 $n_{AA}$ 个，基因型 $Aa$ 有 $n_{Aa}$ 个，基因型 $aa$ 有 $n_{aa}$ 个。个体总数是这些计数的总和：\n$$N = n_{AA} + n_{Aa} + n_{aa}$$\n\n等位基因 $a$ 由基因型为 $Aa$ 和 $aa$ 的个体携带。\n- 每个基因型为 $Aa$ 的个体携带一个等位基因 $a$ 的拷贝。因此，来自杂合子的 $a$ 等位基因总数为 $1 \\times n_{Aa} = n_{Aa}$。\n- 每个基因型为 $aa$ 的个体携带两个等位基因 $a$ 的拷贝。因此，来自纯合子的 $a$ 等位基因总数为 $2 \\times n_{aa}$。\n\n样本中等位基因 $a$ 的总计数（我们称之为 $C_a$）是来自这两个基因型群体的拷贝数之和：\n$$C_a = n_{Aa} + 2n_{aa}$$\n\n因此，等位基因 $a$ 的频率（用 $p$ 表示）是等位基因 $a$ 的总计数与样本中所有等位基因总数 ($2N$) 的比值：\n$$p = \\frac{C_a}{2N} = \\frac{n_{Aa} + 2n_{aa}}{2N}$$\n将 $N$ 用基因型计数表示的表达式代入，得到所要求的完整表达式：\n$$p = \\frac{n_{Aa} + 2n_{aa}}{2(n_{AA} + n_{Aa} + n_{aa})}$$\n这完成了问题的第一部分。\n\n### 第2部分：HWE下期望基因型频率的推导\n\n第二个任务是在哈迪-温伯格平衡的假设下，推导出基因型 $AA$、$Aa$ 和 $aa$ 的期望频率。核心假设是一个大型、随机交配的群体，没有突变、迁移或自然选择等进化影响。\n\n设 $p$ 为群体基因库中等位基因 $a$ 的频率，$q$ 为等位基因 $A$ 的频率。由于这是该位点上仅有的两个等位基因，它们的频率之和必须为1：\n$$p + q = 1$$\n在随机交配的假设下，下一代基因型的形成可以被建模为从这个基因库中抽取的配子（精子和卵子）的随机结合。携带等位基因 $a$ 的配子频率为 $p$，携带等位基因 $A$ 的配子频率为 $q$。\n\n后代获得特定基因型的概率是由形成合子的两个配子所贡献的等位基因的频率乘积决定的。\n\n- 纯合基因型 $AA$ 的期望频率（表示为 $P(AA)$）是携带 $A$ 的配子与另一个携带 $A$ 的配子结合的概率。这个概率是：\n  $$P(AA) = q \\times q = q^2$$\n\n- 纯合基因型 $aa$ 的期望频率（表示为 $P(aa)$）是携带 $a$ 的配子与另一个携带 $a$ 的配子结合的概率。这个概率是：\n  $$P(aa) = p \\times p = p^2$$\n\n- 杂合基因型 $Aa$ 的期望频率（表示为 $P(Aa)$）可以通过两种互斥的方式发生：\n  1. 携带 $A$ 的配子与携带 $a$ 的配子结合。其概率为 $q \\times p$。\n  2. 携带 $a$ 的配子与携带 $A$ 的配子结合。其概率为 $p \\times q$。\n  杂合基因型的总概率是这两个概率之和：\n  $$P(Aa) = (q \\times p) + (p \\times q) = 2pq$$\n\n因此，在HWE下的期望基因型频率为：\n$$P(AA) = q^2$$\n$$P(Aa) = 2pq$$\n$$P(aa) = p^2$$\n作为验证，这些频率的总和为 $(q+p)^2 = 1^2 = 1$，符合预期。这完成了第二部分。\n\n### 第3部分：期望频率的数值计算\n\n最后一个任务是使用所提供的数据计算这些期望频率的数值，并将它们四舍五入到 $4$ 位有效数字。\n\n首先，我们必须根据观察到的基因型计数计算样本等位基因频率 $p$ 和 $q$：$N = 1000$，$n_{AA} = 540$，$n_{Aa} = 420$，以及 $n_{aa} = 40$。注意 $540+420+40 = 1000$，因此计数是一致的。\n\n使用第1部分中等位基因 $a$ 的频率公式：\n$$p = \\frac{n_{Aa} + 2n_{aa}}{2N} = \\frac{420 + 2(40)}{2(1000)} = \\frac{420 + 80}{2000} = \\frac{500}{2000} = 0.25$$\n等位基因 $A$ 的频率（用 $q$ 表示）可以类似地计算：\n$$q = \\frac{2n_{AA} + n_{Aa}}{2N} = \\frac{2(540) + 420}{2(1000)} = \\frac{1080 + 420}{2000} = \\frac{1500}{2000} = 0.75$$\n或者，由于 $p+q=1$，我们有 $q = 1 - p = 1 - 0.25 = 0.75$。因为 $p  q$，所以等位基因 $a$ 确实是次要等位基因。\n\n现在，我们使用这些等位基因频率和第2部分的公式来计算HWE期望的基因型频率。\n\n- $AA$ 的期望频率：\n  $$P(AA) = q^2 = (0.75)^2 = 0.5625$$\n\n- $Aa$ 的期望频率：\n  $$P(Aa) = 2pq = 2 \\times 0.25 \\times 0.75 = 0.5 \\times 0.75 = 0.375$$\n\n- $aa$ 的期望频率：\n  $$P(aa) = p^2 = (0.25)^2 = 0.0625$$\n\n问题要求将这些概率四舍五入到 $4$ 位有效数字。\n- $P(AA) = 0.5625$。这个数字已经有恰好 $4$ 位有效数字。\n- $P(Aa) = 0.375$。为了用 $4$ 位有效数字表示，我们添加一个末尾的零：$0.3750$。\n- $P(aa) = 0.0625$。首个非零数字前的零不是有效数字。数字 $6$、$2$、$5$ 是有效数字。为了显示 $4$ 位有效数字，我们在末尾添加一个零：$0.06250$。\n\n因此，基因型 $AA$、$Aa$ 和 $aa$ 的期望频率的最终结果分别为 $0.5625$、$0.3750$ 和 $0.06250$。按要求，这些结果以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5625  0.3750  0.06250 \\end{pmatrix}}\n$$", "id": "5041680"}, {"introduction": "在确保数据质量后，GWAS的核心任务是检验每个遗传变异与目标性状之间的统计学关联。对于定量性状，线性回归模型是检验关联的标准方法。本练习将让您亲手实践GWAS中的核心统计计算，通过对已经校正过混杂因素的性状数据（残差）进行回归分析，来估算遗传变异的效应大小（$\\beta$）及其统计不确定性（标准误），这是理解关联信号强度和显著性的关键一步 [@problem_id:5041695]。", "problem": "在一项针对 $n=10$ 个无亲缘关系个体的队列进行的加性单核苷酸多态性 (SNP) 的全基因组关联研究 (GWAS) 中，使用一个包含截距项和协变量（年龄、性别以及通过前五个主成分 (PC) 表示的祖源信息）的线性模型来模拟一个连续数量性状 $y$。该性状已通过使用普通最小二乘法 (OLS) 将 $y$ 对截距项和这些协变量进行回归而被残差化，得到的残差 $r_i = y_i - \\hat{y}_i$ 与协变量正交。考虑同一 SNP 的加性基因型 $g_i \\in \\{0,1,2\\}$，编码为效应等位基因的计数。假设误差是独立的、同方差的，这与标准的 OLS 假设一致。\n\n现提供个体 $i=1,\\dots,10$ 的残差和基因型：\n$$\nr = (-0.4,\\ 0.1,\\ 0.2,\\ -0.1,\\ 0.3,\\ 0.5,\\ 0.4,\\ -0.2,\\ -0.3,\\ -0.5), \\quad\ng = (0,\\ 0,\\ 1,\\ 1,\\ 1,\\ 2,\\ 2,\\ 0,\\ 1,\\ 2).\n$$\n使用带有截距项的 OLS，将残差化性状 $r$ 对 SNP 基因型 $g$ 进行回归，以获得估计的 SNP 效应（斜率）及其标准误。请从包含协变量的 GWAS 线性模型定义出发，并使用已有的结论来证明先进行残差化再进行单预测变量 OLS 的合理性。\n\n计算 SNP 效应估计值及其标准误，并提供这两个数值。将您的数值答案四舍五入到四位有效数字。", "solution": "该问题要求在全基因组关联研究 (GWAS) 的背景下，计算单核苷酸多态性 (SNP) 效应的普通最小二乘法 (OLS) 估计值及其标准误。该分析采用两步法：首先，将数量性状相对于一组协变量进行残差化；其次，将这些残差对 SNP 基因型进行回归。\n\nGWAS 的完整线性模型指定为：\n$$y_i = \\mathbf{x}_i^T \\boldsymbol{\\gamma} + \\beta g_i + \\epsilon_i$$\n其中 $y_i$ 是个体 $i$ 的性状值，$\\mathbf{x}_i$ 是包含截距项的协变量向量，$\\boldsymbol{\\gamma}$ 是协变量效应的向量，$g_i$ 是 SNP 基因型，$\\beta$ 是 SNP 的效应量，$\\epsilon_i$ 是误差项。\n\nFrisch-Waugh-Lovell (FWL) 定理指出，在上述完整模型中，$\\beta$ 的 OLS 估计值与将 $y$ 的残差对 $g$ 的残差进行简单回归得到的斜率系数在数值上是完全相同的，其中 $y$ 和 $g$ 都是相对于协变量 $\\mathbf{x}$ 进行残差化处理的。令 $M_X = I - X(X^T X)^{-1} X^T$ 为协变量矩阵 $X$ 的残差生成矩阵。精确的 OLS 估计值为 $\\hat{\\beta} = (g^T M_X g)^{-1} g^T M_X y$。本题提供了性状的残差 $r = M_X y$，但要求将 $r$ 对原始基因型向量 $g$ 进行回归，而不是对残差化的基因型向量 $M_X g$ 进行回归。这是 GWAS 中为提高计算速度而常用的一种近似方法，其结果与完整模型的结果非常相似，但并非完全相同，尤其是当 SNP 基因型 $g$ 与协变量 $X$ 弱相关时。\n\n按照题目的明确指示，我们拟合线性模型：\n$$r_i = \\alpha + \\beta g_i + \\varepsilon_i$$\n其中 $r_i$ 是所提供的性状残差，$g_i$ 是基因型，我们使用 OLS 估计截距项 $\\alpha$ 和斜率 $\\beta$。样本量为 $n=10$。\n\n所提供的数据为：\n$$r = (-0.4,\\ 0.1,\\ 0.2,\\ -0.1,\\ 0.3,\\ 0.5,\\ 0.4,\\ -0.2,\\ -0.3,\\ -0.5)$$\n$$g = (0,\\ 0,\\ 1,\\ 1,\\ 1,\\ 2,\\ 2,\\ 0,\\ 1,\\ 2)$$\n\n首先，我们计算样本均值 $\\bar{r}$ 和 $\\bar{g}$：\n$$\\bar{r} = \\frac{1}{n} \\sum_{i=1}^{n} r_i = \\frac{1}{10} (-0.4 + 0.1 + 0.2 - 0.1 + 0.3 + 0.5 + 0.4 - 0.2 - 0.3 - 0.5) = \\frac{0}{10} = 0$$\n残差的均值为 $0$，这与预期相符，因为产生这些残差的原始回归模型包含了截距项。\n$$\\bar{g} = \\frac{1}{n} \\sum_{i=1}^{n} g_i = \\frac{1}{10} (0+0+1+1+1+2+2+0+1+2) = \\frac{10}{10} = 1$$\n\n斜率 $\\beta$（SNP 效应）的 OLS 估计值由下式给出：\n$$\\hat{\\beta} = \\frac{\\sum_{i=1}^{n} (g_i - \\bar{g})(r_i - \\bar{r})}{\\sum_{i=1}^{n} (g_i - \\bar{g})^2}$$\n由于 $\\bar{r}=0$，该式可简化为：\n$$\\hat{\\beta} = \\frac{\\sum_{i=1}^{n} (g_i - \\bar{g})r_i}{\\sum_{i=1}^{n} (g_i - \\bar{g})^2} = \\frac{S_{gr}}{S_{gg}}$$\n\n我们计算 $g$ 的离差平方和 $S_{gg}$：\n$$S_{gg} = \\sum_{i=1}^{n} (g_i - 1)^2 = (0-1)^2 + (0-1)^2 + (1-1)^2 + (1-1)^2 + (1-1)^2 + (2-1)^2 + (2-1)^2 + (0-1)^2 + (1-1)^2 + (2-1)^2$$\n$$S_{gg} = (-1)^2 + (-1)^2 + 0^2 + 0^2 + 0^2 + 1^2 + 1^2 + (-1)^2 + 0^2 + 1^2 = 1 + 1 + 0 + 0 + 0 + 1 + 1 + 1 + 0 + 1 = 6$$\n\n接下来，我们计算交叉乘积和 $S_{gr}$：\n$$S_{gr} = \\sum_{i=1}^{n} (g_i - 1)r_i = (-1)(-0.4) + (-1)(0.1) + (0)(0.2) + (0)(-0.1) + (0)(0.3) + (1)(0.5) + (1)(0.4) + (-1)(-0.2) + (0)(-0.3) + (1)(-0.5)$$\n$$S_{gr} = 0.4 - 0.1 + 0 + 0 + 0 + 0.5 + 0.4 + 0.2 + 0 - 0.5 = 0.9$$\n\n现在，我们可以计算 SNP 效应估计值 $\\hat{\\beta}$：\n$$\\hat{\\beta} = \\frac{S_{gr}}{S_{gg}} = \\frac{0.9}{6} = 0.15$$\n\n为了求出 $\\hat{\\beta}$ 的标准误，我们首先需要估计误差项的方差 $\\sigma^2$。其估计量为 $\\hat{\\sigma}^2$，即均方误差：\n$$\\hat{\\sigma}^2 = \\frac{SSR}{n-k}$$\n其中 $SSR$ 是我们当前将 $r$ 对 $g$ 进行回归所得到的残差平方和，$k$ 是估计的参数数量（对于 $\\alpha$ 和 $\\beta$，$k=2$）。误差项的自由度为 $n-k = 10 - 2 = 8$。\n\n$SSR$ 可以计算如下：\n$$SSR = S_{rr} - \\frac{S_{gr}^2}{S_{gg}}$$\n其中 $S_{rr} = \\sum (r_i - \\bar{r})^2 = \\sum r_i^2$ (因为 $\\bar{r}=0$)。\n$$S_{rr} = (-0.4)^2 + (0.1)^2 + (0.2)^2 + (-0.1)^2 + (0.3)^2 + (0.5)^2 + (0.4)^2 + (-0.2)^2 + (-0.3)^2 + (-0.5)^2$$\n$$S_{rr} = 0.16 + 0.01 + 0.04 + 0.01 + 0.09 + 0.25 + 0.16 + 0.04 + 0.09 + 0.25 = 1.1$$\n\n现在我们计算 $SSR$：\n$$SSR = 1.1 - \\frac{(0.9)^2}{6} = 1.1 - \\frac{0.81}{6} = 1.1 - 0.135 = 0.965$$\n估计的误差方差为：\n$$\\hat{\\sigma}^2 = \\frac{SSR}{n-2} = \\frac{0.965}{8} = 0.120625$$\n\n斜率估计值的标准误 $SE(\\hat{\\beta})$ 由下式给出：\n$$SE(\\hat{\\beta}) = \\sqrt{\\frac{\\hat{\\sigma}^2}{S_{gg}}}$$\n$$SE(\\hat{\\beta}) = \\sqrt{\\frac{0.120625}{6}} = \\sqrt{0.020104166...} \\approx 0.14178916$$\n\n题目要求将结果四舍五入到四位有效数字。\nSNP 效应估计值为 $\\hat{\\beta}=0.15$。保留四位有效数字，即为 $0.1500$。\nSNP 效应的标准误为 $SE(\\hat{\\beta}) \\approx 0.14178916$。保留四位有效数字，即为 $0.1418$。\n\nSNP 效应估计值为 $\\hat{\\beta} = 0.1500$，其标准误为 $SE(\\hat{\\beta}) = 0.1418$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.1500  0.1418 \\end{pmatrix}}$$", "id": "5041695"}, {"introduction": "在GWAS中发现的显著信号通常指向一个基因组区域，而非单个致病变异。这是因为位于同一染色体上邻近位置的等位基因倾向于“捆绑”在一起遗传，这种现象被称为连锁不平衡（LD）。本练习将向您介绍衡量LD强度的关键指标——$r^2$。通过从原始的单倍型数据出发计算$r^2$，您将掌握评估两个变异之间关联强弱的实践技能，并理解为何一个显著的SNP可能仅仅是其附近一个真正致病变异的“标签”，这对于解读GWAS结果和进行后续的精细定位至关重要 [@problem_id:5041677]。", "problem": "一项全基因组关联研究（GWAS）旨在通过量化双等位基因单核苷酸变异对之间的连锁不平衡来选择标签变异。考虑同一条染色体上的两个变异，每个变异有两个等位基因：变异$1$有等位基因$A$和$a$，变异$2$有等位基因$B$和$b$。在一个包含$n=200$个具有定相数据的无亲缘关系个体的样本中，共观测到$2n=400$条染色体。在这$400$条染色体上观测到的双位点单倍型计数为：$AB:160$，$Ab:40$，$aB:40$，$ab:160$。\n\n从随机抽样染色体上等位基因存在的指示随机变量之间的相关性定义出发，推导一个用单倍型频率和边际等位基因频率表示的、在变异$1$上存在等位基因$A$与在变异$2$上存在等位基因$B$之间的相关性平方$r^2$的表达式。然后，使用给定的单倍型计数作为经验频率，计算这对变异的$r^2$。\n\n将最终的$r^2$值以小数形式报告，保留四位有效数字。不需要单位。", "solution": "该问题要求推导两个变异之间的相关系数平方$r^2$，然后根据提供的单倍型计数进行计算。连锁不平衡（LD）是指不同位点上等位基因的非随机关联。相关性平方$r^2$是LD的一个常用度量。\n\n首先，我们推导$r^2$的一般表达式。让我们为从群体样本中随机选择的一条染色体定义两个指示随机变量$X_A$和$X_B$。\n$X_A = 1$如果变异$1$处的等位基因是$A$，否则$X_A=0$如果等位基因是$a$。\n$X_B = 1$如果变异$2$处的等位基因是$B$，否则$X_B=0$如果等位基因是$b$。\n\n这些事件的概率由边际等位基因频率给出。设$p_A$为等位基因$A$的频率，$p_a$为等位基因$a$的频率，$p_B$为等位基因$B$的频率，$p_b$为等位基因$b$的频率。根据定义，$p_a = 1 - p_A$且$p_b = 1 - p_B$。\n指示变量的期望是它所指示事件的概率。\n$$E[X_A] = 1 \\cdot P(X_A=1) + 0 \\cdot P(X_A=0) = P(X_A=1) = p_A$$\n$$E[X_B] = P(X_B=1) = p_B$$\n指示变量$X$的方差是$\\text{Var}(X) = E[X^2] - (E[X])^2$。由于$X_A^2 = X_A$（因为$1^2=1$且$0^2=0$），我们有$E[X_A^2] = E[X_A] = p_A$。\n$$\\text{Var}(X_A) = E[X_A] - (E[X_A])^2 = p_A - p_A^2 = p_A(1-p_A) = p_A p_a$$\n$$\\text{Var}(X_B) = p_B(1-p_B) = p_B p_b$$\n$X_A$和$X_B$之间的相关系数$r$定义为：\n$$r = \\frac{\\text{Cov}(X_A, X_B)}{\\sqrt{\\text{Var}(X_A) \\text{Var}(X_B)}}$$\n协方差为$\\text{Cov}(X_A, X_B) = E[X_A X_B] - E[X_A] E[X_B]$。\n乘积$X_A X_B$为$1$当且仅当$X_A=1$且$X_B=1$，这对应于染色体是$AB$单倍型。因此，该乘积的期望是$AB$单倍型的频率，记为$p_{AB}$。\n$$E[X_A X_B] = P(X_A=1 \\text{ and } X_B=1) = p_{AB}$$\n将此代入协方差公式：\n$$\\text{Cov}(X_A, X_B) = p_{AB} - p_A p_B$$\n这个协方差项是连锁不平衡系数$D$的标准定义。\n$$D = p_{AB} - p_A p_B$$\n现在我们可以用$D$和等位基因频率来表示相关系数$r$：\n$$r = \\frac{D}{\\sqrt{p_A p_a p_B p_b}}$$\n问题要求的是相关性平方，$r^2$：\n$$r^2 = \\frac{D^2}{p_A p_a p_B p_b} = \\frac{(p_{AB} - p_A p_B)^2}{p_A(1-p_A)p_B(1-p_B)}$$\n推导到此完成。\n\n接下来，我们使用给定的数据计算$r^2$的值。观测到的染色体总数为$N_{total} = 400$。观测到的单倍型计数为：\n$n_{AB} = 160$\n$n_{Ab} = 40$\n$n_{aB} = 40$\n$n_{ab} = 160$\n\n我们使用样本的经验频率来估计群体频率。\n单倍型频率：\n$p_{AB} = \\frac{n_{AB}}{N_{total}} = \\frac{160}{400} = 0.4$\n$p_{Ab} = \\frac{n_{Ab}}{N_{total}} = \\frac{40}{400} = 0.1$\n$p_{aB} = \\frac{n_{aB}}{N_{total}} = \\frac{40}{400} = 0.1$\n$p_{ab} = \\frac{n_{ab}}{N_{total}} = \\frac{160}{400} = 0.4$\n\n边际等位基因频率通过将包含相应等位基因的单倍型频率相加来计算：\n$p_A = p_{AB} + p_{Ab} = 0.4 + 0.1 = 0.5$\n$p_a = p_{aB} + p_{ab} = 0.1 + 0.4 = 0.5$\n（作为核对，$p_A+p_a = 0.5+0.5=1.0$）\n$p_B = p_{AB} + p_{aB} = 0.4 + 0.1 = 0.5$\n$p_b = p_{Ab} + p_{ab} = 0.1 + 0.4 = 0.5$\n（作为核对，$p_B+p_b = 0.5+0.5=1.0$）\n\n现在，我们计算连锁不平衡系数$D$：\n$$D = p_{AB} - p_A p_B = 0.4 - (0.5 \\times 0.5) = 0.4 - 0.25 = 0.15$$\n最后，我们计算$r^2$：\n$$r^2 = \\frac{D^2}{p_A p_a p_B p_b} = \\frac{(0.15)^2}{(0.5)(0.5)(0.5)(0.5)} = \\frac{0.0225}{(0.5)^4} = \\frac{0.0225}{0.0625}$$\n$$r^2 = \\frac{225}{625} = \\frac{9 \\times 25}{25 \\times 25} = \\frac{9}{25} = 0.36$$\n问题要求答案以小数形式表示，并保留四位有效数字。精确值$0.36$写作$0.3600$以满足此要求。", "answer": "$$\\boxed{0.3600}$$", "id": "5041677"}]}