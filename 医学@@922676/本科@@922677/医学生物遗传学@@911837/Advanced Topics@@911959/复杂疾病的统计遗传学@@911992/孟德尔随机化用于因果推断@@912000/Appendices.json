{"hands_on_practices": [{"introduction": "在使用一个遗传变异作为工具变量之前，我们必须首先确保它与暴露因素有足够强的关联。这是孟德尔随机化（MR）的“关联性”假设。本练习将指导您计算 $F$ 统计量，这是一个量化工具变量强度的关键指标，可以帮助您避免弱工具变量偏倚的陷阱。[@problem_id:4358043]", "problem": "在用于精准医疗和基因组诊断学中因果推断的孟德尔随机化 (MR) 分析中，通常会评估第一阶段回归中的工具变量强度，以防范弱工具变量偏倚。考虑一个线性两阶段最小二乘法框架，其中单个遗传变异（例如，一个作为顺式表达数量性状位点的单核苷酸多态性 (SNP)）被用作工具变量 (IV) 来预测一个连续性生物标志物暴露。将暴露对工具变量进行的第一阶段普通最小二乘法 (OLS) 回归仅包含一个截距和该工具变量，没有其他协变量。设样本量为 $n = 10{,}000$，工具变量数量为 $k = 1$，第一阶段决定系数为 $R^{2} = 0.01$。\n\n从解释平方和与残差平方和的标准 OLS 定义，以及用于检验第一阶段模型中工具变量系数均为零的联合原假设的 F-统计量定义出发，推导出以 $R^{2}$、$n$ 和 $k$ 表示的第一阶段条件 F-统计量。然后，使用给定的数值计算其值。最后，根据计算出的值，说明该工具变量是否超过了为避免弱工具变量问题而设定的常用经验法则阈值 $10$。请以单个精确值的形式给出 F-统计量（不要四舍五入），并注意该量是无量纲的。", "solution": "我们首先正式定义第一阶段普通最小二乘法 (OLS) 回归的组成部分。该模型将我们表示为 $Y$ 的暴露对一组 $k$ 个工具变量（表示为 $X_1, \\dots, X_k$）和一个截距进行回归。模型如下：\n$$\nY_i = \\beta_0 + \\beta_1 X_{i1} + \\dots + \\beta_k X_{ik} + u_i\n$$\n其中 $i$ 为观测值索引，从 $1$ 到 $n$；$\\beta_0$ 是截距；$\\beta_1, \\dots, \\beta_k$ 是工具变量的系数；$u_i$ 是误差项。\n\n推导过程从 OLS 回归中平方和的基本定义开始。设 $\\bar{Y}$ 为暴露的样本均值，$\\hat{Y}_i$ 为 OLS 回归得到的 $Y_i$ 的拟合值。\n\n1.  总平方和 ($SST$) 衡量因变量 $Y$ 的总方差：\n    $$\n    SST = \\sum_{i=1}^{n} (Y_i - \\bar{Y})^2\n    $$\n2.  解释平方和 ($ESS$)，也称为回归平方和，衡量由回归模型解释的 $Y$ 的变异：\n    $$\n    ESS = \\sum_{i=1}^{n} (\\hat{Y}_i - \\bar{Y})^2\n    $$\n3.  残差平方和 ($RSS$)，也称为误差平方和，衡量模型未解释的 $Y$ 的变异：\n    $$\n    RSS = \\sum_{i=1}^{n} (Y_i - \\hat{Y}_i)^2 = \\sum_{i=1}^{n} \\hat{u}_i^2\n    $$\n这些量通过恒等式 $SST = ESS + RSS$ 相关联。\n\n决定系数 $R^2$ 定义为模型所解释的总平方和的比例：\n$$\nR^2 = \\frac{ESS}{SST}\n$$\n根据这个定义，我们可以用 $R^2$ 和 $SST$ 来表示 $ESS$ 和 $RSS$：\n$$\nESS = R^2 \\cdot SST\n$$\n$$\nRSS = SST - ESS = SST - R^2 \\cdot SST = (1 - R^2) \\cdot SST\n$$\n\n用于检验所有工具变量系数均为零的联合原假设（$H_0: \\beta_1 = \\beta_2 = \\dots = \\beta_k = 0$）的 F-统计量定义为回归均方 ($MSR$) 与误差均方 ($MSE$) 的比值。\n\n$MSR$ 是解释平方和除以其自由度，即被检验的预测变量数量 $k$：\n$$\nMSR = \\frac{ESS}{k}\n$$\n$MSE$ 是残差平方和除以其自由度。残差的自由度是样本量 $n$ 减去模型中估计的参数总数。由于模型包含一个截距和 $k$ 个工具变量系数，参数总数为 $k+1$。因此，分母的自由度是 $n - k - 1$。\n$$\nMSE = \\frac{RSS}{n - k - 1}\n$$\n那么，F-统计量为：\n$$\nF = \\frac{MSR}{MSE} = \\frac{ESS/k}{RSS/(n - k - 1)}\n$$\n\n现在，我们将用 $R^2$ 和 $SST$ 表示的 $ESS$ 和 $RSS$ 的表达式代入 F-统计量的公式中：\n$$\nF = \\frac{(R^2 \\cdot SST) / k}{((1 - R^2) \\cdot SST) / (n - k - 1)}\n$$\n$SST$ 项同时出现在分子和分母中，因此可以消掉。这一消去也证实了 F-统计量是一个无量纲的量，因为它最终是两个方差部分的比例。这样我们就得到了以 $R^2$、$n$ 和 $k$ 表示的 F-统计量的期望表达式：\n$$\nF = \\frac{R^2 / k}{(1 - R^2) / (n - k - 1)} = \\frac{R^2}{1 - R^2} \\cdot \\frac{n - k - 1}{k}\n$$\n推导至此完成。\n\n接下来，我们使用问题陈述中提供的数值来计算这个表达式的值：\n- 样本量，$n = 10{,}000$\n- 工具变量数量，$k = 1$\n- 第一阶段决定系数，$R^2 = 0.01$\n\n将这些值代入推导出的公式：\n$$\nF = \\frac{0.01}{1 - 0.01} \\cdot \\frac{10{,}000 - 1 - 1}{1}\n$$\n$$\nF = \\frac{0.01}{0.99} \\cdot \\frac{9998}{1}\n$$\n$$\nF = \\frac{1}{99} \\cdot 9998\n$$\n$$\nF = \\frac{9998}{99}\n$$\n这就是 F-统计量的精确值。为了将此值与经验法则阈值进行比较，我们可以对其进行近似计算。\n$F = \\frac{9998}{99} \\approx 100.9898...$\n\n最后，我们必须说明该工具变量是否超过了为避免弱工具变量问题而设定的常用经验法则阈值 $10$。计算出的 F-统计量是 $\\frac{9998}{99}$，约等于 $100.99$。由于 $100.99 > 10$，该工具变量的强度显著超过了常用阈值。因此，根据此指标，该遗传变异不被认为是弱工具变量。", "answer": "$$\n\\boxed{\\frac{9998}{99}}\n$$", "id": "4358043"}, {"introduction": "一旦确定了一个强有力的遗传工具变量，我们就可以估计暴露对结局的因果效应。最简单的方法是 Wald 比率估计，它构成了更复杂的孟德尔随机化技术的基础。本练习提供了一个计算这种基本因果效应估计值及其统计不确定性的具体例子。[@problem_id:4357996]", "problem": "一项基因组诊断学中的精准医疗研究旨在使用孟德尔随机化（MR；Mendelian Randomization）来估计标准化血浆生物标志物 $X$ 对标准化疾病性状 $Y$ 的因果效应。使用单个遗传变异 $G$（一个单核苷酸多态性，SNP）作为工具变量。假设以下核心工具变量假设成立：相关性（$G$ 与 $X$ 相关），独立性（$G$ 独立于 $X$ 和 $Y$ 的混杂因素），以及排他性限制（$G$ 仅通过 $X$ 影响 $Y$）。这些关联在具有独立抽样误差和大样本正态性的双样本设置中进行估计。令 $\\hat{\\beta}_{GX}$ 表示 $G$ 与 $X$ 的估计关联，$\\hat{\\beta}_{GY}$ 表示 $G$ 与 $Y$ 的估计关联。给定 $\\hat{\\beta}_{GX} = 0.08$（每个等位基因的标准差单位），$\\hat{\\beta}_{GY} = -0.016$（每个等位基因的标准差单位），$\\text{SE}(\\hat{\\beta}_{GX}) = 0.01$ 以及 $\\text{SE}(\\hat{\\beta}_{GY}) = 0.005$，其中 $\\text{SE}$ 表示标准误（Standard Error, SE）。\n\n在与上述假设一致的线性结构模型下，假设 $\\hat{\\beta}_{GX}$ 和 $\\hat{\\beta}_{GY}$ 相互独立，使用一阶多元delta方法计算 $X$ 对 $Y$ 的因果效应的Wald估计量及其标准误。将估计量及其标准误均四舍五入至四位有效数字。将最终答案表示为一个不带单位的双元素行向量 $\\begin{pmatrix}\\text{estimate}  \\text{standard error}\\end{pmatrix}$。", "solution": "目标是使用单个工具变量 $G$，通过孟德尔随机化（MR）来估计 $X$ 对 $Y$ 的因果效应。在工具变量假设（相关性、独立性和排他性限制）以及线性结构模型下，总体水平的因果效应可以通过工具变量-结果关联与工具变量-暴露关联的比率来识别。相应的样本估计量是Wald估计量，即估计关联的比率。\n\n令 $\\hat{\\beta}_{GX}$ 表示 $G$ 与 $X$ 的估计关联，$\\hat{\\beta}_{GY}$ 表示 $G$ 与 $Y$ 的估计关联。Wald估计量为\n$$\n\\hat{\\beta}_{YX}^{\\text{Wald}} = \\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}}.\n$$\n给定 $\\hat{\\beta}_{GX} = 0.08$ 和 $\\hat{\\beta}_{GY} = -0.016$，我们计算\n$$\n\\hat{\\beta}_{YX}^{\\text{Wald}} = \\frac{-0.016}{0.08} = -0.2.\n$$\n\n接下来，我们使用一阶多元delta方法计算比率估计量的标准误。定义函数 $g(a,b) = \\frac{a}{b}$，其中 $(a,b)$ 对应于 $(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX})$。$g$ 在 $(a,b)$ 处的梯度为\n$$\n\\nabla g(a,b) = \\left( \\frac{\\partial g}{\\partial a}, \\frac{\\partial g}{\\partial b} \\right) = \\left( \\frac{1}{b}, -\\frac{a}{b^{2}} \\right).\n$$\n假设在双样本设置中抽样误差独立，因此 $\\operatorname{Cov}(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX}) = 0$，并记 $\\operatorname{Var}(\\hat{\\beta}_{GY}) = \\text{SE}(\\hat{\\beta}_{GY})^{2}$ 和 $\\operatorname{Var}(\\hat{\\beta}_{GX}) = \\text{SE}(\\hat{\\beta}_{GX})^{2}$，则 $g(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX})$ 方差的delta方法近似为\n$$\n\\operatorname{Var}\\!\\left(\\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}}\\right) \\approx \\left(\\frac{1}{\\hat{\\beta}_{GX}}\\right)^{2} \\operatorname{Var}(\\hat{\\beta}_{GY}) + \\left(\\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}^{2}}\\right)^{2} \\operatorname{Var}(\\hat{\\beta}_{GX}).\n$$\n代入给定值 $\\hat{\\beta}_{GX} = 0.08$、$\\hat{\\beta}_{GY} = -0.016$、$\\text{SE}(\\hat{\\beta}_{GX}) = 0.01$ 和 $\\text{SE}(\\hat{\\beta}_{GY}) = 0.005$：\n$$\n\\operatorname{Var}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx \\frac{(0.005)^{2}}{(0.08)^{2}} + \\frac{(-0.016)^{2} (0.01)^{2}}{(0.08)^{4}}.\n$$\n分别计算各项：\n- 第一项：\n$$\n\\frac{(0.005)^{2}}{(0.08)^{2}} = \\frac{0.000025}{0.0064} = 0.00390625.\n$$\n- 第二项：\n$$\n\\frac{(-0.016)^{2} (0.01)^{2}}{(0.08)^{4}} = \\frac{0.000256 \\times 0.0001}{0.00004096} = \\frac{2.56 \\times 10^{-8}}{4.096 \\times 10^{-5}} = 6.25 \\times 10^{-4} = 0.000625.\n$$\n将两项相加，\n$$\n\\operatorname{Var}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx 0.00390625 + 0.000625 = 0.00453125.\n$$\n因此，标准误为\n$$\n\\text{SE}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx \\sqrt{0.00453125} \\approx 0.06731,\n$$\n四舍五入至四位有效数字。\n\nWald估计值本身恰好是 $-0.2$，四舍五入至四位有效数字为 $-0.2000$。要求的最终答案是包含估计值及其标准误的双元素行向量，两者均四舍五入至四位有效数字且不带单位：\n$$\n\\begin{pmatrix}\n-0.2000  0.06731\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-0.2000  0.06731\\end{pmatrix}}$$", "id": "4357996"}, {"introduction": "为了提高统计功效并获得更稳健的因果估计，研究人员通常会结合来自多个遗传工具变量的信息。逆方差加权（IVW）方法是整合各个工具变量效应最常用的方法。本练习将演示如何综合来自多个遗传变异的数据，以得出一个更精确的因果效应估计值。[@problem_id:4358027]", "problem": "一个精准医学研究团队试图使用孟德尔随机化（Mendelian Randomization, MR）来估计一个连续性生物标志物暴露对一个二元疾病结局的因果效应。该团队已确定了四个与暴露强烈相关的独立单核苷酸多态性（Single-Nucleotide Polymorphism, SNP）工具变量，并收集了双样本汇总关联估计值。对于每个 SNP $j \\in \\{1,2,3,4\\}$，他们报告了与暴露的遗传关联 $\\hat{\\beta}_{GX,j}$ 和与结局的遗传关联 $\\hat{\\beta}_{GY,j}$，以及相应的标准误 $\\mathrm{SE}(\\hat{\\beta}_{GX,j})$ 和 $\\mathrm{SE}(\\hat{\\beta}_{GY,j})$。MR 的相关性、独立性和排他性限制假设被判定为合理，并且用于暴露关联和结局关联的样本是独立的。\n\n可用的汇总数据如下：\n- SNP $1$：$\\hat{\\beta}_{GX,1} = 0.08$，$\\mathrm{SE}(\\hat{\\beta}_{GX,1}) = 0.004$；$\\hat{\\beta}_{GY,1} = 0.032$，$\\mathrm{SE}(\\hat{\\beta}_{GY,1}) = 0.015$。\n- SNP $2$：$\\hat{\\beta}_{GX,2} = 0.12$，$\\mathrm{SE}(\\hat{\\beta}_{GX,2}) = 0.005$；$\\hat{\\beta}_{GY,2} = 0.050$，$\\mathrm{SE}(\\hat{\\beta}_{GY,2}) = 0.020$。\n- SNP $3$：$\\hat{\\beta}_{GX,3} = 0.05$，$\\mathrm{SE}(\\hat{\\beta}_{GX,3}) = 0.003$；$\\hat{\\beta}_{GY,3} = 0.020$，$\\mathrm{SE}(\\hat{\\beta}_{GY,3}) = 0.012$。\n- SNP $4$：$\\hat{\\beta}_{GX,4} = 0.10$，$\\mathrm{SE}(\\hat{\\beta}_{GX,4}) = 0.004$；$\\hat{\\beta}_{GY,4} = 0.036$，$\\mathrm{SE}(\\hat{\\beta}_{GY,4}) = 0.018$。\n\n假设一个线性因果模型将 SNP-结局关联与 SNP-暴露关联和单一因果效应参数的乘积联系起来，加上随机误差，其方差在报告的结局标准误内已知，并假设暴露关联的无测量误差（No Measurement Error, NOME）近似成立，即 $\\hat{\\beta}_{GX,j}$ 的不确定性在加权时可以忽略不计。在这些假设下，使用反方差加权（Inverse-Variance Weighted, IVW）方法（通过原点的加权最小二乘法，权重与结局关联方差的倒数成正比）来计算：\n- 因果效应的 IVW 点估计值，以及\n- 使用正态近似计算的相应 $95\\%$ 置信区间。\n\n将这三个数字（点估计值、置信区间下限和置信区间上限）中的每一个都四舍五入到四位有效数字。最终数值答案以小数形式表示，不带单位。", "solution": "该问题要求基于一项双样本孟德尔随机化（MR）研究的汇总数据，计算一个因果效应的反方差加权（IVW）点估计值及其相应的 $95\\%$ 置信区间。\n\nIVW 方法的核心原理是，对 SNP-结局关联（$\\hat{\\beta}_{GY,j}$）关于 SNP-暴露关联（$\\hat{\\beta}_{GX,j}$）进行加权线性回归，并约束其通过原点。每个 SNP $j$ 的模型为：\n$$ \\hat{\\beta}_{GY,j} = \\beta_{IVW} \\hat{\\beta}_{GX,j} + \\epsilon_j $$\n其中 $\\beta_{IVW}$ 是我们试图找到的因果效应估计值。\n\n问题指明权重与结局关联方差的倒数成正比。这与无测量误差（NOME）假设（即，将 $\\hat{\\beta}_{GX,j}$ 视为固定的已知值）相结合，得到了标准的 IVW 估计量。第 $j$ 个工具变量的权重为 $w_j = 1 / \\mathrm{SE}(\\hat{\\beta}_{GY,j})^2$。\n\nIVW 点估计值 $\\hat{\\beta}_{IVW}$ 的公式是加权最小二乘问题的解：\n$$ \\hat{\\beta}_{IVW} = \\frac{\\sum_{j=1}^{J} w_j \\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\sum_{j=1}^{J} w_j \\hat{\\beta}_{GX,j}^2} = \\frac{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}}{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}} $$\n其中 $J=4$ 是 SNP 的数量。\n\n假设工具变量是独立的且 NOME 假设成立，IVW 估计值的标准误由以下公式给出：\n$$ \\mathrm{SE}(\\hat{\\beta}_{IVW}) = \\sqrt{\\frac{1}{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}}} $$\n\n我们将为 $J=4$ 个 SNP中的每一个计算 $\\hat{\\beta}_{IVW}$ 公式中的分子项和分母项。令 $N_j = \\frac{\\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}$ 和 $D_j = \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}$。\n\n对于 SNP $1$：\n$\\hat{\\beta}_{GX,1} = 0.08$，$\\hat{\\beta}_{GY,1} = 0.032$，$\\mathrm{SE}(\\hat{\\beta}_{GY,1}) = 0.015$。\n$N_1 = \\frac{0.08 \\times 0.032}{0.015^2} = \\frac{0.00256}{0.000225} = \\frac{512}{45}$\n$D_1 = \\frac{0.08^2}{0.015^2} = \\frac{0.0064}{0.000225} = \\frac{256}{9}$\n\n对于 SNP $2$：\n$\\hat{\\beta}_{GX,2} = 0.12$，$\\hat{\\beta}_{GY,2} = 0.050$，$\\mathrm{SE}(\\hat{\\beta}_{GY,2}) = 0.020$。\n$N_2 = \\frac{0.12 \\times 0.050}{0.020^2} = \\frac{0.006}{0.0004} = 15$\n$D_2 = \\frac{0.12^2}{0.020^2} = \\frac{0.0144}{0.0004} = 36$\n\n对于 SNP $3$：\n$\\hat{\\beta}_{GX,3} = 0.05$，$\\hat{\\beta}_{GY,3} = 0.020$，$\\mathrm{SE}(\\hat{\\beta}_{GY,3}) = 0.012$。\n$N_3 = \\frac{0.05 \\times 0.020}{0.012^2} = \\frac{0.001}{0.000144} = \\frac{125}{18}$\n$D_3 = \\frac{0.05^2}{0.012^2} = \\frac{0.0025}{0.000144} = \\frac{625}{36}$\n\n对于 SNP $4$：\n$\\hat{\\beta}_{GX,4} = 0.10$，$\\hat{\\beta}_{GY,4} = 0.036$，$\\mathrm{SE}(\\hat{\\beta}_{GY,4}) = 0.018$。\n$N_4 = \\frac{0.10 \\times 0.036}{0.018^2} = \\frac{0.0036}{0.000324} = \\frac{100}{9}$\n$D_4 = \\frac{0.10^2}{0.018^2} = \\frac{0.01}{0.000324} = \\frac{2500}{81}$\n\n现在，我们对这些项求和：\n$$ \\sum_{j=1}^{4} N_j = \\frac{512}{45} + 15 + \\frac{125}{18} + \\frac{100}{9} = \\frac{1024 + 1350 + 625 + 1000}{90} = \\frac{3999}{90} $$\n$$ \\sum_{j=1}^{4} D_j = \\frac{256}{9} + 36 + \\frac{625}{36} + \\frac{2500}{81} = \\frac{9216 + 11664 + 5625 + 10000}{324} = \\frac{36505}{324} $$\n\nIVW 点估计值为：\n$$ \\hat{\\beta}_{IVW} = \\frac{\\sum N_j}{\\sum D_j} = \\frac{3999/90}{36505/324} = \\frac{3999}{90} \\times \\frac{324}{36505} \\approx 0.3943673 $$\n四舍五入到四位有效数字，点估计值为 $0.3944$。\n\n估计值的标准误为：\n$$ \\mathrm{SE}(\\hat{\\beta}_{IVW}) = \\frac{1}{\\sqrt{\\sum D_j}} = \\frac{1}{\\sqrt{36505/324}} = \\sqrt{\\frac{324}{36505}} \\approx 0.0942103 $$\n\n为了计算 $95\\%$ 置信区间，我们使用正态近似：\n$$ CI_{95\\%} = \\hat{\\beta}_{IVW} \\pm z_{0.975} \\times \\mathrm{SE}(\\hat{\\beta}_{IVW}) $$\n对于 $95\\%$ 置信水平，标准正态分布的临界值为 $z_{0.975} \\approx 1.96$。\n\n误差范围是：\n$$ ME = 1.96 \\times 0.0942103 \\approx 0.1846522 $$\n\n置信区间的下限和上限为：\n下限: $LB = 0.3943673 - 0.1846522 = 0.2097151$\n上限: $UB = 0.3943673 + 0.1846522 = 0.5790195$\n\n将这些界限四舍五入到四位有效数字：\n下限 $\\approx 0.2097$\n上限 $\\approx 0.5790$（末尾的零是有效数字）\n\n最终结果，四舍五入到四位有效数字，为：\n-   IVW 点估计值: $0.3944$\n-   $95\\%$ 置信区间下限: $0.2097$\n-   $95\\%$ 置信区间上限: $0.5790$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3944  0.2097  0.5790 \\end{pmatrix}}\n$$", "id": "4358027"}]}