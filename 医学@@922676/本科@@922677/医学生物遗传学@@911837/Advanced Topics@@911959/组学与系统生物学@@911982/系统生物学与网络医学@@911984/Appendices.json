{"hands_on_practices": [{"introduction": "在一个复杂的生物网络中，我们如何精确地找出最具影响力的基因？中心性指标为此提供了一个定量的答案。Katz中心性是一种精密的度量标准，它不仅考虑直接连接，还通过对所有源自该节点的路径进行加权求和（对较长路径施加衰减），来评估一个节点的总体影响力。这项动手练习 [@problem_id:5084478] 将指导你为一个简单网络计算Katz中心性，帮助你理解该分数如何反映基因的拓扑重要性，并辅助确定需要优先研究的候选基因。", "problem": "在一个蛋白质-蛋白质相互作用网络中，一个疾病模块可近似为一个由四个基因 $\\mathrm{G1}$、$\\mathrm{G2}$、$\\mathrm{G3}$ 和 $\\mathrm{G4}$ 构成的小型无向图。在有序基 $(\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4})$ 下，其邻接矩阵 $\\mathbf{A}$ 为\n$$\n\\mathbf{A} \\;=\\; \\begin{pmatrix}\n0  1  1  1\\\\\n1  0  0  0\\\\\n1  0  0  0\\\\\n1  0  0  0\n\\end{pmatrix}.\n$$\n使用卡茨中心性的标准定义，即收敛级数\n$$\n\\mathbf{x} \\;=\\; \\sum_{k=1}^{\\infty} \\alpha^{k}\\,\\mathbf{A}^{k}\\,\\mathbf{1},\n$$\n其中 $\\mathbf{1}$ 是全1列向量，$\\alpha$ 是为确保收敛而选择的衰减参数，请计算当 $\\alpha = \\tfrac{1}{2}$ 时的卡茨中心性向量 $\\mathbf{x}$。请基于 $\\mathbf{A}$ 的谱性质，证明 $\\alpha$ 的选择能够使级数收敛。然后，使用网络医学的推理方法，从医学遗传学中后续实验的基因优先级排序角度，简要解释计算出的各项的相对大小将如何指导首先研究哪些基因，并说明原因。请以行矩阵的形式，按 $(\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4})$ 的顺序给出最终的卡茨中心性向量。无需四舍五入；请报告精确值。", "solution": "该问题要求计算给定基因网络的卡茨中心性向量，证明定义中所用级数的收敛性，并在医学遗传学的背景下解释结果。\n\n首先，必须确定卡茨中心性级数的有效性和收敛性。卡茨中心性向量 $\\mathbf{x}$ 由以下级数定义：\n$$\n\\mathbf{x} \\;=\\; \\sum_{k=1}^{\\infty} \\alpha^{k}\\,\\mathbf{A}^{k}\\,\\mathbf{1}\n$$\n这是一个矩阵的几何级数，其收敛的充要条件是衰减参数 $\\alpha$ 小于邻接矩阵 $\\mathbf{A}$ 的谱半径 $\\rho(\\mathbf{A})$ 的倒数。谱半径是 $\\mathbf{A}$ 的特征值中绝对值的最大值。\n\n$\\mathbf{A}$ 的特征值 $\\lambda$ 通过求解特征方程 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 得到。为了计算其行列式，我们利用 $\\mathbf{A}$ 的特定分块结构性质。对于形如 $\\begin{pmatrix} 0  \\mathbf{w}^T \\\\ \\mathbf{w}  \\mathbf{0} \\end{pmatrix}$ 的矩阵，其中 $\\mathbf{w}$ 是一个维度为 $n-1$ 的列向量，其特征多项式为 $\\lambda^{n-2}(\\lambda^2 - \\mathbf{w}^T \\mathbf{w})$。此处，$n=4$ 且 $\\mathbf{w} = (1, 1, 1)^T$。因此 $\\mathbf{w}^T\\mathbf{w}=1^2+1^2+1^2 = 3$。特征多项式为 $\\lambda^{4-2}(\\lambda^2 - 3) = \\lambda^2(\\lambda^2-3)$。\n令其为 $0$：\n$$\n\\lambda^{2}(\\lambda^{2} - 3) = 0\n$$\n特征值为 $\\lambda_{1} = \\sqrt{3}$，$\\lambda_{2} = -\\sqrt{3}$，以及 $\\lambda_{3,4} = 0$（重数为2）。\n谱半径为 $\\rho(\\mathbf{A}) = \\max(|\\sqrt{3}|, |-\\sqrt{3}|, |0|) = \\sqrt{3}$。\n卡茨中心性级数的收敛条件是 $\\alpha  \\frac{1}{\\rho(\\mathbf{A})}$。\n$$\n\\alpha  \\frac{1}{\\sqrt{3}}\n$$\n问题指定 $\\alpha = \\frac{1}{2}$。我们必须检查此条件是否满足：\n$$\n\\frac{1}{2}  \\frac{1}{\\sqrt{3}} \\iff \\sqrt{3}  2 \\iff 3  4\n$$\n此不等式成立。因此，选择 $\\alpha = \\frac{1}{2}$ 可确保级数收敛。\n\n接下来，我们计算卡茨中心性向量 $\\mathbf{x}$。该级数的和可以用闭合形式表示：\n$$\n\\mathbf{x} = \\sum_{k=1}^{\\infty} (\\alpha\\mathbf{A})^{k} \\mathbf{1} = \\left(\\left(\\sum_{k=0}^{\\infty} (\\alpha\\mathbf{A})^{k}\\right) - \\mathbf{I}\\right) \\mathbf{1} = ((\\mathbf{I} - \\alpha\\mathbf{A})^{-1} - \\mathbf{I})\\mathbf{1}\n$$\n首先，我们构造矩阵 $\\mathbf{M} = \\mathbf{I} - \\alpha\\mathbf{A}$，其中 $\\alpha = \\frac{1}{2}$：\n$$\n\\mathbf{M} = \\mathbf{I} - \\frac{1}{2}\\mathbf{A} = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} - \\frac{1}{2}\\begin{pmatrix} 0  1  1  1 \\\\ 1  0  0  0 \\\\ 1  0  0  0 \\\\ 1  0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  -\\frac{1}{2}  -\\frac{1}{2}  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1  0  0 \\\\ -\\frac{1}{2}  0  1  0 \\\\ -\\frac{1}{2}  0  0  1 \\end{pmatrix}\n$$\n接下来，我们计算逆矩阵 $\\mathbf{M}^{-1} = (\\mathbf{I} - \\frac{1}{2}\\mathbf{A})^{-1}$。通过使用高斯消元法或利用矩阵的结构，可以得到：\n$$\n(\\mathbf{I} - \\frac{1}{2}\\mathbf{A})^{-1} = \\begin{pmatrix}\n4  2  2  2 \\\\\n2  2  1  1 \\\\\n2  1  2  1 \\\\\n2  1  1  2\n\\end{pmatrix}\n$$\n现在我们可以计算向量 $\\mathbf{x}$：\n$$\n\\mathbf{x} = \\left( \\begin{pmatrix}\n4  2  2  2 \\\\\n2  2  1  1 \\\\\n2  1  2  1 \\\\\n2  1  1  2\n\\end{pmatrix} - \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{x} = \\begin{pmatrix}\n3  2  2  2 \\\\\n2  1  1  1 \\\\\n2  1  1  1 \\\\\n2  1  1  1\n\\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix}\n3+2+2+2 \\\\\n2+1+1+1 \\\\\n2+1+1+1 \\\\\n2+1+1+1\n\\end{pmatrix} = \\begin{pmatrix}\n9 \\\\ 5 \\\\ 5 \\\\ 5\n\\end{pmatrix}\n$$\n基因 $(\\mathrm{G1}, \\mathrm{G2}, \\mathrm{G3}, \\mathrm{G4})$ 的卡茨中心性得分是 $(9, 5, 5, 5)$。\n\n最后，我们解释这些结果。在网络医学中，中心性度量用于识别疾病模块内的有影响力的节点，疾病模块代表一组与特定疾病有关的相互作用的基因或蛋白质。“关联负罪”原则假设，高度中心的节点在功能上更可能很重要，因此在疾病机理中起关键作用。卡茨中心性通过对从一个节点出发的所有路径求和来量化其影响力，其中较长的路径会受到指数级的惩罚。该网络结构是一个星形图，基因 $\\mathrm{G1}$ 位于中心，连接着三个外围基因 $\\mathrm{G2}$、$\\mathrm{G3}$ 和 $\\mathrm{G4}$。\n计算出的中心性得分反映了这种拓扑结构：\n- 基因 $\\mathrm{G1}$ 的中心性得分最高（$9$）。这是因为它是中心节点，拥有最多的直接连接，并参与网络中所有长度路径中的最多数目。它介导了外围基因之间的所有通信。\n- 基因 $\\mathrm{G2}$、$\\mathrm{G3}$ 和 $\\mathrm{G4}$ 的中心性得分相同且较低（$5$）。这是由于它们在网络中的对称位置。它们的影响力小于中心节点，因为它们的连接较少，并且它们出发的路径主要通过 $\\mathrm{G1}$ 传导。\n从基因优先级排序的角度来看，$\\mathrm{G1}$ 显著更高的中心性标志着它是该疾病模块中最具影响力的组成部分。因此，根据网络医学原理，$\\mathrm{G1}$ 应被优先进行进一步的实验研究。它是作为与该疾病相关的驱动基因或有效治疗靶点的首要候选者。其余基因（$\\mathrm{G2}$、$\\mathrm{G3}$、$\\mathrm{G4}$）则处于次要优先级。", "answer": "$$\n\\boxed{\\begin{pmatrix} 9  5  5  5 \\end{pmatrix}}\n$$", "id": "5084478"}, {"introduction": "基因并非独立工作；它们通过形成功能性的“社群”或模块来执行生物过程。网络医学的一个关键任务就是从庞大的相互作用网络中识别这些模块。Louvain方法是完成此任务的流行算法，它通过迭代地合并节点来最大化一个名为模块度（$Q$）的质量分数。通过这项实践 [@problem_id:5084453]，你将计算一个给定网络划分的模块度，并分析一个合并步骤所带来的模块度增益（$\\Delta Q$），从而具体地理解社群发现算法背后的核心机制。", "problem": "考虑一个代表六个基因 $G_1, G_2, G_3, G_4, G_5, G_6$ 的小型无向、无权基因相互作用网络。该网络由对称邻接矩阵 $A$ 指定（如果 $G_i$ 和 $G_j$ 之间存在相互作用，则 $A_{ij} = 1$，否则 $A_{ij} = 0$）：\n$$\nA =\n\\begin{pmatrix}\n0  1  1  0  0  0 \\\\\n1  0  1  1  0  0 \\\\\n1  1  0  1  0  0 \\\\\n0  1  1  0  1  0 \\\\\n0  0  0  1  0  1 \\\\\n0  0  0  0  1  0\n\\end{pmatrix}.\n$$\n在系统生物学和网络医学中，Louvain 社区检测方法通过贪婪地合并社区来最大化网络模块度。使用无向、无权网络的模块度 $Q$ 的标准定义，以及以下节点到社区的初始划分：\n- $\\mathcal{C}_1 = \\{G_1, G_2\\}$，\n- $\\mathcal{C}_2 = \\{G_3, G_4\\}$，\n- $\\mathcal{C}_3 = \\{G_5, G_6\\}$。\n\n你的任务是：\n- 计算给定初始划分的模块度 $Q$。\n- 考虑一个 Louvain 合并步骤，将 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 合并成一个单一社区 $\\mathcal{C}_{12} = \\{G_1, G_2, G_3, G_4\\}$（保持 $\\mathcal{C}_3$ 不变），并计算合并后的新模块度 $Q$。\n- 从第一性原理出发，推导此次合并引起的模块度增益 $\\Delta Q$。\n\n将最终的模块度增益 $\\Delta Q$ 表示为单个最简分数。无需四舍五入，也不涉及单位。清楚地说明你计算的任何量（例如节点度数和边的总数），并在整个推导过程中遵循标准的无向模块度定义。", "solution": "问题陈述已经过验证，被认为是有效的。它在网络理论中具有科学依据，提法明确，目标清晰，数据充分，语言客观，并且属于指定的系统生物学领域。\n\n解决过程如下。首先，我们定义网络模块度并计算给定基因相互作用网络的基本属性。其次，我们计算初始划分的模块度 $Q$。第三，我们计算指定合并后划分的模块度。最后，我们从第一性原理推导模块度增益 $\\Delta Q$ 并计算其在给定合并下的值。\n\n网络划分为社区后的模块度 $Q$ 定义为：\n$$Q = \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - \\frac{k_i k_j}{2m} \\right] \\delta(c_i, c_j)$$\n其中 $m$ 是边的总数，$A_{ij}$ 是邻接矩阵中节点 $i$ 和 $j$ 对应的元素，$k_i$ 是节点 $i$ 的度数，$c_i$ 是节点 $i$ 所属的社区，而 $\\delta(c_i, c_j)$ 是克罗内克 δ 函数，如果 $c_i=c_j$ 则为 $1$，否则为 $0$。\n\n一个等效且更便于计算的公式是：\n$$Q = \\sum_{c \\in \\mathcal{C}} \\left[ \\frac{l_c}{m} - \\left(\\frac{d_c}{2m}\\right)^2 \\right]$$\n其中 $\\mathcal{C}$ 是所有社区的集合，$l_c$ 是完全在社区 $c$ 内部的边数，$d_c$ 是社区 $c$ 中所有节点的度数之和。\n\n首先，我们从邻接矩阵 $A$ 计算网络的基本属性：\n$$A =\n\\begin{pmatrix}\n0  1  1  0  0  0 \\\\\n1  0  1  1  0  0 \\\\\n1  1  0  1  0  0 \\\\\n0  1  1  0  1  0 \\\\\n0  0  0  1  0  1 \\\\\n0  0  0  0  1  0\n\\end{pmatrix}\n$$\n边的总数 $m$ 是邻接矩阵中所有元素之和的一半（或所有节点度数之和的一半）：\n$$m = \\frac{1}{2} \\sum_{i,j} A_{ij} = \\frac{14}{2} = 7$$\n节点（基因）的度数是 $A$ 的行（或列）的和：\n$k_1 = 1+1 = 2$\n$k_2 = 1+1+1 = 3$\n$k_3 = 1+1+1 = 3$\n$k_4 = 1+1+1 = 3$\n$k_5 = 1+1 = 2$\n$k_6 = 1 = 1$\n度数之和为 $\\sum k_i = 2+3+3+3+2+1=14$，这正确地等于 $2m$。\n\n现在，我们计算初始划分 $\\mathcal{C}_1 = \\{G_1, G_2\\}$，$\\mathcal{C}_2 = \\{G_3, G_4\\}$，$\\mathcal{C}_3 = \\{G_5, G_6\\}$ 的模块度 $Q_{\\text{initial}}$。\n\n对于社区 $\\mathcal{C}_1$：\n- 内部边 $l_1$：$G_1$ 和 $G_2$ 之间的边（$A_{12}=1$）。所以，$l_1 = 1$。\n- 度数和 $d_1$：$k_1 + k_2 = 2 + 3 = 5$。\n\n对于社区 $\\mathcal{C}_2$：\n- 内部边 $l_2$：$G_3$ 和 $G_4$ 之间的边（$A_{34}=1$）。所以，$l_2 = 1$。\n- 度数和 $d_2$：$k_3 + k_4 = 3 + 3 = 6$。\n\n对于社区 $\\mathcal{C}_3$：\n- 内部边 $l_3$：$G_5$ 和 $G_6$ 之间的边（$A_{56}=1$）。所以，$l_3 = 1$。\n- 度数和 $d_3$：$k_5 + k_6 = 2 + 1 = 3$。\n\n初始模块度为：\n$$Q_{\\text{initial}} = \\left[ \\frac{l_1}{m} - \\left(\\frac{d_1}{2m}\\right)^2 \\right] + \\left[ \\frac{l_2}{m} - \\left(\\frac{d_2}{2m}\\right)^2 \\right] + \\left[ \\frac{l_3}{m} - \\left(\\frac{d_3}{2m}\\right)^2 \\right]$$\n$$Q_{\\text{initial}} = \\left[ \\frac{1}{7} - \\left(\\frac{5}{14}\\right)^2 \\right] + \\left[ \\frac{1}{7} - \\left(\\frac{6}{14}\\right)^2 \\right] + \\left[ \\frac{1}{7} - \\left(\\frac{3}{14}\\right)^2 \\right]$$\n$$Q_{\\text{initial}} = \\frac{3}{7} - \\frac{5^2 + 6^2 + 3^2}{14^2} = \\frac{3}{7} - \\frac{25 + 36 + 9}{196} = \\frac{3}{7} - \\frac{70}{196}$$\n$$Q_{\\text{initial}} = \\frac{3 \\times 28}{196} - \\frac{70}{196} = \\frac{84 - 70}{196} = \\frac{14}{196} = \\frac{1}{14}$$\n\n接下来，我们计算将 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 合并为 $\\mathcal{C}_{12} = \\{G_1, G_2, G_3, G_4\\}$ 后的模块度 $Q_{\\text{merged}}$。新的划分是 $\\{\\mathcal{C}_{12}, \\mathcal{C}_3\\}$。\n\n对于新社区 $\\mathcal{C}_{12}$：\n- 内部边 $l_{12}$：这些是 $\\mathcal{C}_1$ 内部的边（$l_1$）、$\\mathcal{C}_2$ 内部的边（$l_2$）以及 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 之间的边。\n  - $\\{G_1, G_2\\}$ 和 $\\{G_3, G_4\\}$ 之间的边是 $(G_1, G_3)$、$(G_2, G_3)$ 和 $(G_2, G_4)$，因为 $A_{13}=1$，$A_{23}=1$ 并且 $A_{24}=1$。共有 $3$ 条这样的边。\n  - $l_{12} = l_1 + l_2 + (\\text{edges between } \\mathcal{C}_1, \\mathcal{C}_2) = 1 + 1 + 3 = 5$。\n- 度数和 $d_{12}$：$d_1 + d_2 = 5 + 6 = 11$。\n\n社区 $\\mathcal{C}_3$ 不变。\n\n新的模块度为：\n$$Q_{\\text{merged}} = \\left[ \\frac{l_{12}}{m} - \\left(\\frac{d_{12}}{2m}\\right)^2 \\right] + \\left[ \\frac{l_3}{m} - \\left(\\frac{d_3}{2m}\\right)^2 \\right]$$\n$$Q_{\\text{merged}} = \\left[ \\frac{5}{7} - \\left(\\frac{11}{14}\\right)^2 \\right] + \\left[ \\frac{1}{7} - \\left(\\frac{3}{14}\\right)^2 \\right]$$\n$$Q_{\\text{merged}} = \\frac{6}{7} - \\frac{11^2 + 3^2}{14^2} = \\frac{6}{7} - \\frac{121 + 9}{196} = \\frac{6}{7} - \\frac{130}{196}$$\n$$Q_{\\text{merged}} = \\frac{6 \\times 28}{196} - \\frac{130}{196} = \\frac{168 - 130}{196} = \\frac{38}{196} = \\frac{19}{98}$$\n\n最后，我们从第一性原理推导模块度增益 $\\Delta Q$。将两个社区（例如 $\\mathcal{C}_i$ 和 $\\mathcal{C}_j$）合并成一个新社区 $\\mathcal{C}_{ij}$ 所带来的模块度变化是：\n$$\\Delta Q = Q_{\\text{new}} - Q_{\\text{old}}$$\n模块度总和中对应于 $\\mathcal{C}_i$ 和 $\\mathcal{C}_j$ 的项被移除，并被一个对应于 $\\mathcal{C}_{ij}$ 的单项所取代。\n$$Q_{\\text{old\\_terms}} = \\left[ \\frac{l_i}{m} - \\left(\\frac{d_i}{2m}\\right)^2 \\right] + \\left[ \\frac{l_j}{m} - \\left(\\frac{d_j}{2m}\\right)^2 \\right]$$\n$$Q_{\\text{new\\_term}} = \\left[ \\frac{l_{ij}}{m} - \\left(\\frac{d_{ij}}{2m}\\right)^2 \\right]$$\n新社区的参数是 $d_{ij} = d_i + d_j$ 和 $l_{ij} = l_i + l_j + l_{i,j}^{\\text{between}}$，其中 $l_{i,j}^{\\text{between}}$ 是社区 $\\mathcal{C}_i$ 中的节点与社区 $\\mathcal{C}_j$ 中的节点之间的边数。\n$$\\Delta Q = Q_{\\text{new\\_term}} - Q_{\\text{old\\_terms}}$$\n$$\\Delta Q = \\left[ \\frac{l_i + l_j + l_{i,j}^{\\text{between}}}{m} - \\left(\\frac{d_i + d_j}{2m}\\right)^2 \\right] - \\left[ \\frac{l_i}{m} - \\left(\\frac{d_i}{2m}\\right)^2 + \\frac{l_j}{m} - \\left(\\frac{d_j}{2m}\\right)^2 \\right]$$\n$$\\Delta Q = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{1}{(2m)^2} \\left[ (d_i + d_j)^2 - d_i^2 - d_j^2 \\right]$$\n$$\\Delta Q = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{1}{4m^2} \\left[ d_i^2 + 2d_i d_j + d_j^2 - d_i^2 - d_j^2 \\right]$$\n$$\\Delta Q = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{2d_i d_j}{4m^2} = \\frac{l_{i,j}^{\\text{between}}}{m} - \\frac{d_i d_j}{2m^2}$$\n这是合并两个社区时模块度增益的通用公式。\n\n将此公式应用于 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 的合并：\n- $i=1$, $j=2$\n- $m = 7$\n- $d_1 = 5$\n- $d_2 = 6$\n- $l_{1,2}^{\\text{between}} = 3$ （如前所计算）\n\n$$\\Delta Q = \\frac{3}{7} - \\frac{5 \\times 6}{2 \\times 7^2} = \\frac{3}{7} - \\frac{30}{2 \\times 49} = \\frac{3}{7} - \\frac{15}{49}$$\n为了合并分数，我们使用公分母 $49$：\n$$\\Delta Q = \\frac{3 \\times 7}{49} - \\frac{15}{49} = \\frac{21 - 15}{49} = \\frac{6}{49}$$\n\n作为检验，我们可以计算 $\\Delta Q = Q_{\\text{merged}} - Q_{\\text{initial}}$：\n$$\\Delta Q = \\frac{19}{98} - \\frac{1}{14} = \\frac{19}{98} - \\frac{7}{98} = \\frac{12}{98} = \\frac{6}{49}$$\n结果一致。推导出的模块度增益为 $\\frac{6}{49}$。\n\n总结：\n- 初始模块度 $Q_{\\text{initial}} = \\frac{1}{14}$。\n- 合并后模块度 $Q_{\\text{merged}} = \\frac{19}{98}$。\n- 模块度增益 $\\Delta Q = \\frac{6}{49}$。", "answer": "$$\\boxed{\\frac{6}{49}}$$", "id": "5084453"}, {"introduction": "网络医学为理解为何某些疾病（如糖尿病和心脏病）经常同时发生提供了强有力的框架。这种“共病性”可以在人类蛋白质相互作用网络中，通过它们各自相关基因模块的邻近性反映出来。我们可以通过定义一个网络分离度分数来量化两个基因集之间的关系，该分数将不同基因集之间的平均距离与每个基因集内部的平均距离进行比较。这项练习 [@problem_id:5084477] 将让你为两个假设的基因模块计算这个分离度分数，从而阐明网络拓扑如何揭示生物过程或疾病之间不那么明显的联系。", "problem": "在网络医学中，嵌入在蛋白质-蛋白质相互作用网络中的两个疾病相关基因模块之间的邻近性，可以通过一个源自网络上最短路径距离的分离分数来量化。考虑一个具有以下边的无向、无权基因-基因相互作用网络：\n$$\n\\{\\ (\\text{TP53},\\text{MDM2}),\\ (\\text{TP53},\\text{ATM}),\\ (\\text{ATM},\\text{CHEK2}),\\ (\\text{ATM},\\text{BRCA1}),\\ (\\text{BRCA1},\\text{BRCA2}),\\ (\\text{CHEK2},\\text{BRCA1}),\\ (\\text{EGFR},\\text{PIK3CA}),\\ (\\text{PIK3CA},\\text{AKT1}),\\ (\\text{AKT1},\\text{MDM2})\\ \\}.\n$$\n设两个基因集为\n$$\nA=\\{\\text{BRCA1},\\ \\text{BRCA2},\\ \\text{CHEK2}\\},\\qquad B=\\{\\text{EGFR},\\ \\text{PIK3CA},\\ \\text{AKT1}\\}.\n$$\n使用以下基于最短路径距离 $d(x,y)$ 的定义，该距离衡量为上述网络中节点 $x$ 和 $y$ 之间最短路径上的边数：\n- 对于不同的集合 $X$ 和 $Y$，定义平均集间距离\n$$\n\\overline{d}_{XY}=\\frac{1}{|X|\\,|Y|}\\sum_{x\\in X}\\sum_{y\\in Y} d(x,y).\n$$\n- 对于单个集合 $X$，定义基于无序不同对的平均集内距离\n$$\n\\overline{d}_{XX}=\\frac{2}{|X|\\,(|X|-1)}\\sum_{\\{x,x'\\}\\subset X} d(x,x').\n$$\n$A$ 和 $B$ 之间的网络分离分数定义为\n$$\ns(A,B)=\\overline{d}_{AB}-\\frac{1}{2}\\left(\\overline{d}_{AA}+\\overline{d}_{BB}\\right).\n$$\n计算指定网络和基因集的 $s(A,B)$。将您的最终答案表示为一个精确的实数；无需四舍五入。不要包含单位。", "solution": "该问题要求在给定的蛋白质-蛋白质相互作用网络中，计算两个基因集 $A$ 和 $B$ 之间的网络分离分数 $s(A,B)$。该分数定义为 $s(A,B)=\\overline{d}_{AB}-\\frac{1}{2}\\left(\\overline{d}_{AA}+\\overline{d}_{BB}\\right)$。此计算需要确定三个初步量：集合 $A$ 的平均集内距离（$\\overline{d}_{AA}$）、集合 $B$ 的平均集内距离（$\\overline{d}_{BB}$）以及 $A$ 和 $B$ 之间的平均集间距离（$\\overline{d}_{AB}$）。所有这些量都基于网络中节点之间的最短路径距离 $d(x,y)$。\n\n首先，我们表示网络图并确定集合 $A$ 和 $B$ 的成员。\n基因（节点）集为 $V = \\{\\text{TP53}, \\text{MDM2}, \\text{ATM}, \\text{CHEK2}, \\text{BRCA1}, \\text{BRCA2}, \\text{EGFR}, \\text{PIK3CA}, \\text{AKT1}\\}$。\n相互作用（边）集为 $E = \\{\\{\\text{TP53},\\text{MDM2}\\}, \\{\\text{TP53},\\text{ATM}\\}, \\{\\text{ATM},\\text{CHEK2}\\}, \\{\\text{ATM},\\text{BRCA1}\\}, \\{\\text{BRCA1},\\text{BRCA2}\\}, \\{\\text{CHEK2},\\text{BRCA1}\\}, \\{\\text{EGFR},\\text{PIK3CA}\\}, \\{\\text{PIK3CA},\\text{AKT1}\\}, \\{\\text{AKT1},\\text{MDM2}\\}\\}$。\n基因集为 $A=\\{\\text{BRCA1}, \\text{BRCA2}, \\text{CHEK2}\\}$ 和 $B=\\{\\text{EGFR}, \\text{PIK3CA}, \\text{AKT1}\\}$。\n集合的大小为 $|A|=3$ 和 $|B|=3$。\n\n接下来，我们必须计算集合 $A$ 内部、集合 $B$ 内部以及集合 $A$ 和 $B$ 之间所有节点对的最短路径距离 $d(x,y)$。距离是最短路径中的边数。\n\n集合 $A$ 内部的距离：$\\{\\text{BRCA1}, \\text{BRCA2}, \\text{CHEK2}\\}$\n- $d(\\text{BRCA1}, \\text{BRCA2})$：存在一条边 $(\\text{BRCA1}, \\text{BRCA2})$。因此，$d(\\text{BRCA1}, \\text{BRCA2}) = 1$。\n- $d(\\text{BRCA1}, \\text{CHEK2})$：存在一条边 $(\\text{CHEK2}, \\text{BRCA1})$。因此，$d(\\text{BRCA1}, \\text{CHEK2}) = 1$。\n- $d(\\text{BRCA2}, \\text{CHEK2})$：最短路径为 $\\text{BRCA2} \\to \\text{BRCA1} \\to \\text{CHEK2}$。因此，$d(\\text{BRCA2}, \\text{CHEK2}) = 2$。\n\n集合 $B$ 内部的距离：$\\{\\text{EGFR}, \\text{PIK3CA}, \\text{AKT1}\\}$\n- $d(\\text{EGFR}, \\text{PIK3CA})$：存在一条边 $(\\text{EGFR}, \\text{PIK3CA})$。因此，$d(\\text{EGFR}, \\text{PIK3CA}) = 1$。\n- $d(\\text{PIK3CA}, \\text{AKT1})$：存在一条边 $(\\text{PIK3CA}, \\text{AKT1})$。因此，$d(\\text{PIK3CA}, \\text{AKT1}) = 1$。\n- $d(\\text{EGFR}, \\text{AKT1})$：最短路径为 $\\text{EGFR} \\to \\text{PIK3CA} \\to \\text{AKT1}$。因此，$d(\\text{EGFR}, \\text{AKT1}) = 2$。\n\n集合 $A$ 和集合 $B$ 之间的距离：\n连接 $A$ 的邻域和 $B$ 的邻域的核心路径是 $\\text{ATM} \\to \\text{TP53} \\to \\text{MDM2} \\to \\text{AKT1}$。\n从节点 $\\text{ATM}$（与 $A$ 中的节点相邻）到 $B$ 中节点的距离为：\n- $d(\\text{ATM}, \\text{AKT1})$：路径为 $\\text{ATM} \\to \\text{TP53} \\to \\text{MDM2} \\to \\text{AKT1}$。$d(\\text{ATM}, \\text{AKT1}) = 3$。\n- $d(\\text{ATM}, \\text{PIK3CA})$：路径为 $\\text{ATM} \\to \\dots \\to \\text{AKT1} \\to \\text{PIK3CA}$。$d(\\text{ATM}, \\text{PIK3CA}) = d(\\text{ATM}, \\text{AKT1}) + 1 = 4$。\n- $d(\\text{ATM}, \\text{EGFR})$：路径为 $\\text{ATM} \\to \\dots \\to \\text{PIK3CA} \\to \\text{EGFR}$。$d(\\text{ATM}, \\text{EGFR}) = d(\\text{ATM}, \\text{PIK3CA}) + 1 = 5$。\n\n现在我们计算从 $A$ 中的每个基因到 $B$ 中的每个基因的距离：\n从 $\\text{BRCA1} \\in A$：\n- $d(\\text{BRCA1}, \\text{AKT1}) = d(\\text{BRCA1}, \\text{ATM}) + d(\\text{ATM}, \\text{AKT1}) = 1 + 3 = 4$。\n- $d(\\text{BRCA1}, \\text{PIK3CA}) = d(\\text{BRCA1}, \\text{ATM}) + d(\\text{ATM}, \\text{PIK3CA}) = 1 + 4 = 5$。\n- $d(\\text{BRCA1}, \\text{EGFR}) = d(\\text{BRCA1}, \\text{ATM}) + d(\\text{ATM}, \\text{EGFR}) = 1 + 5 = 6$。\n\n从 $\\text{BRCA2} \\in A$：\n- $d(\\text{BRCA2}, \\text{AKT1}) = d(\\text{BRCA2}, \\text{BRCA1}) + d(\\text{BRCA1}, \\text{AKT1}) = 1 + 4 = 5$。\n- $d(\\text{BRCA2}, \\text{PIK3CA}) = d(\\text{BRCA2}, \\text{BRCA1}) + d(\\text{BRCA1}, \\text{PIK3CA}) = 1 + 5 = 6$。\n- $d(\\text{BRCA2}, \\text{EGFR}) = d(\\text{BRCA2}, \\text{BRCA1}) + d(\\text{BRCA1}, \\text{EGFR}) = 1 + 6 = 7$。\n\n从 $\\text{CHEK2} \\in A$：从 $\\text{CHEK2}$ 到集合 $B$ 的最短路径是经由 $\\text{ATM}$，因为 $d(\\text{CHEK2}, \\text{ATM})=1$，而通过 $\\text{BRCA1}$ 的路径 $\\text{CHEK2} \\to \\text{BRCA1} \\to \\text{ATM}$ 则更长。\n- $d(\\text{CHEK2}, \\text{AKT1}) = d(\\text{CHEK2}, \\text{ATM}) + d(\\text{ATM}, \\text{AKT1}) = 1 + 3 = 4$。\n- $d(\\text{CHEK2}, \\text{PIK3CA}) = d(\\text{CHEK2}, \\text{ATM}) + d(\\text{ATM}, \\text{PIK3CA}) = 1 + 4 = 5$。\n- $d(\\text{CHEK2}, \\text{EGFR}) = d(\\text{CHEK2}, \\text{ATM}) + d(\\text{ATM}, \\text{EGFR}) = 1 + 5 = 6$。\n\n现在我们计算平均距离。\n1. $A$ 的平均集内距离, $\\overline{d}_{AA}$：\n$$ \\overline{d}_{AA}=\\frac{2}{|A|\\,(|A|-1)}\\sum_{\\{a,a'\\}\\subset A} d(a,a') = \\frac{2}{3(2)} \\left( d(\\text{BRCA1}, \\text{BRCA2}) + d(\\text{BRCA1}, \\text{CHEK2}) + d(\\text{BRCA2}, \\text{CHEK2}) \\right) $$\n$$ \\overline{d}_{AA} = \\frac{1}{3} (1 + 1 + 2) = \\frac{4}{3} $$\n\n2. $B$ 的平均集内距离, $\\overline{d}_{BB}$：\n$$ \\overline{d}_{BB}=\\frac{2}{|B|\\,(|B|-1)}\\sum_{\\{b,b'\\}\\subset B} d(b,b') = \\frac{2}{3(2)} \\left( d(\\text{EGFR}, \\text{PIK3CA}) + d(\\text{EGFR}, \\text{AKT1}) + d(\\text{PIK3CA}, \\text{AKT1}) \\right) $$\n$$ \\overline{d}_{BB} = \\frac{1}{3} (1 + 2 + 1) = \\frac{4}{3} $$\n\n3. $A$ 和 $B$ 之间的平均集间距离, $\\overline{d}_{AB}$：\n$$ \\overline{d}_{AB}=\\frac{1}{|A|\\,|B|}\\sum_{a\\in A}\\sum_{b\\in B} d(a,b) = \\frac{1}{3 \\times 3} \\sum_{a\\in A}\\sum_{b\\in B} d(a,b) $$\n距离之和为：\n$$ \\sum_{a\\in A}\\sum_{b\\in B} d(a,b) = (4+5+6) + (5+6+7) + (4+5+6) = 15 + 18 + 15 = 48 $$\n$$ \\overline{d}_{AB} = \\frac{1}{9} (48) = \\frac{16}{3} $$\n\n最后，我们计算网络分离分数 $s(A,B)$：\n$$ s(A,B) = \\overline{d}_{AB} - \\frac{1}{2}\\left(\\overline{d}_{AA} + \\overline{d}_{BB}\\right) $$\n$$ s(A,B) = \\frac{16}{3} - \\frac{1}{2}\\left(\\frac{4}{3} + \\frac{4}{3}\\right) = \\frac{16}{3} - \\frac{1}{2}\\left(\\frac{8}{3}\\right) = \\frac{16}{3} - \\frac{4}{3} = \\frac{12}{3} = 4 $$\n网络分离分数为 $4$。", "answer": "$$\n\\boxed{4}\n$$", "id": "5084477"}]}