{"hands_on_practices": [{"introduction": "一项成功的RNA-seq研究并非始于实验室，而是始于周密的规划。本练习将引导您完成实验设计的关键过程，您必须在预算限制、样本数量和测序深度之间做出权衡。通过这个场景，您将学习如何做出明智的决策以最大化实验的统计功效，确保您有最大的机会检测到有意义的生物学差异。[@problem_id:5088477]", "problem": "您正在设计一个病例-对照的核糖核酸测序 (RNA-seq) 实验，以在医学遗传学中检测差异表达基因。您必须在预算约束下，将测序读数分配给来自两个组（对照组和病例组）的固定数量的样本，以最大化达到目标统计功效的真实差异表达基因的比例。您的程序必须实现以下建模假设，使用指定的测试套件，并生成所需的输出格式。\n\n基本和建模假设：\n- 中心法则和基于测序的定量：通过测序读数对信使核糖核酸 (mRNA) 的丰度进行抽样，从而产生每个基因的计数。\n- 计数模型：对于一个在文库中真实比例为 $p$ 的基因，每个样本的观测计数被建模为负二项 (NB) 分布，其均值为 $\\mu$，离散度为 $\\phi$，其中 $\\mathrm{Var}(K) = \\mu + \\phi \\mu^2$。均值 $\\mu$ 随每个样本的测序深度 $r$ 线性变化，即 $\\mu = r \\, p$。\n- 差异表达参数化：在 A 组（对照组）和 B 组（病例组）之间，效应大小是对数倍数变化 $\\delta$（自然对数），因此组均值满足 $\\mu_B = \\mu_A \\, e^{\\delta}$。\n- 功效近似：使用 delta 方法处理对数转换后的均值，并通过对数均值的双样本比较，估计的对数倍数变化的方差近似为\n  $$\n  \\mathrm{Var}(\\widehat{\\delta}) \\approx \\frac{1}{n_A}\\left(\\frac{1}{\\mu_A} + \\phi\\right) + \\frac{1}{n_B}\\left(\\frac{1}{\\mu_B} + \\phi\\right),\n  $$\n  其中 $n_A$ 和 $n_B$ 分别是 A 组和 B 组的样本数量，且 $\\mu_A = r \\, p$，$\\mu_B = r \\, p \\, e^{\\delta}$。在显著性水平为 $\\alpha$ 的双侧检验下，使用来自标准正态分布的临界值 $z_{\\alpha/2}$，检测比例为 $p$ 的基因的效应 $\\delta$ 的功效为\n  $$\n  \\text{Power}(p; r) = \\Phi\\!\\left(-z_{\\alpha/2} - \\frac{\\delta}{\\sqrt{\\mathrm{Var}(\\widehat{\\delta})}}\\right) + 1 - \\Phi\\!\\left(z_{\\alpha/2} - \\frac{\\delta}{\\sqrt{\\mathrm{Var}(\\widehat{\\delta})}}\\right),\n  $$\n  其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。\n\n设计变量和约束条件：\n- 有 $n_A$ 个对照组样本和 $n_B$ 个病例组样本，总共 $m = n_A + n_B$ 个样本。\n- 预算 $B$（单位：美元）必须覆盖每个样本的文库制备成本 $c_{\\text{prep}}$ 和每 $10^6$ 个读数的测序成本 $c_{\\text{read}}$。可负担的总读数（整数）为\n  $$\n  R_{\\text{budget}} = \\left\\lfloor \\max\\{0, B - c_{\\text{prep}} \\, m\\} \\, / \\, c_{\\text{read}} \\right\\rfloor \\times 10^6.\n  $$\n- 每个样本的读数 $r_i$ 必须满足 $r_{\\min} \\le r_i \\le r_{\\max}$ 且 $\\sum_{i=1}^{m} r_i \\le R_{\\text{budget}}$。\n- 基因丰度由一个涵盖从低到高表达的给定比例 $p$ 列表表示。\n\n目标：\n- 给定一个每个基因的目标功效阈值 $\\tau$（以小数表示），将“达到功效的比例”定义为，在提供的 $p$ 值中，其 $\\text{Power}(p; r)$ 至少为 $\\tau$ 的 $p$ 值所占的比例。您的任务是选择每个样本的读数分配 $\\{r_i\\}_{i=1}^m$，以在满足约束条件的前提下最大化这个比例。当均等分配在给定假设下为最优时，您必须返回该均等分配方案。\n\n必需的算法规范：\n- 您必须确定可行性。如果 $m \\, r_{\\min} > R_{\\text{budget}}$，则该分配不可行。\n- 如果可行，在上述 NB-delta 方法模型下，达到功效的比例作为每个样本测序深度的函数是严格递增的，并且随 $r$ 呈现收益递减；在总读数固定的约束下，最优分配是为所有样本分配相等的读数。因此，设置 $r^\\star = \\min\\left\\{ r_{\\max}, \\left\\lfloor \\frac{R_{\\text{budget}}}{m} \\right\\rfloor \\right\\}$ 并使用 $r = r^\\star$ 为所有样本计算达到功效的比例。\n- 报告每个样本的分配 $r^\\star$（一个整数读数）和达到功效的比例 $f$（一个四舍五入到 $6$ 位小数的浮点数）。如果不可行，则报告布尔值 false。\n\n单位和数值约定：\n- 以读数为单位报告读数（作为整数）。\n- 以小数形式报告达到功效的比例（不带百分号），四舍五入到 $6$ 位小数。\n- 不涉及角度。\n- 所有货币值均以美元为单位。\n\n测试套件：\n实现您的程序以评估以下 $5$ 个测试用例。每个测试用例是一个元组\n$$\n(B, c_{\\text{prep}}, c_{\\text{read}}, n_A, n_B, r_{\\min}, r_{\\max}, \\alpha, \\tau, \\delta, \\phi, \\mathcal{P}),\n$$\n其中 $\\mathcal{P}$ 是基因比例列表：\n$$\n\\mathcal{P} = [10^{-6}, 2\\cdot 10^{-6}, 5\\cdot 10^{-6}, 10^{-5}, 2\\cdot 10^{-5}, 5\\cdot 10^{-5}, 10^{-4}, 2\\cdot 10^{-4}, 5\\cdot 10^{-4}, 10^{-3}].\n$$\n\n使用以下参数：\n- 用例 $1$：$(B=\\$4800,\\, c_{\\text{prep}}=\\$300,\\, c_{\\text{read}}=\\$15,\\, n_A=4,\\, n_B=4,\\, r_{\\min}=5\\cdot 10^6,\\, r_{\\max}=4\\cdot 10^7,\\, \\alpha=0.05,\\, \\tau=0.8,\\, \\delta=\\ln(1.5),\\, \\phi=0.04,\\, \\mathcal{P})$。\n- 用例 $2$：$(B=\\$3000,\\, c_{\\text{prep}}=\\$300,\\, c_{\\text{read}}=\\$15,\\, n_A=4,\\, n_B=4,\\, r_{\\min}=5\\cdot 10^6,\\, r_{\\max}=4\\cdot 10^7,\\, \\alpha=0.05,\\, \\tau=0.8,\\, \\delta=\\ln(1.5),\\, \\phi=0.04,\\, \\mathcal{P})$。\n- 用例 $3$：$(B=\\$9600,\\, c_{\\text{prep}}=\\$300,\\, c_{\\text{read}}=\\$15,\\, n_A=4,\\, n_B=4,\\, r_{\\min}=5\\cdot 10^6,\\, r_{\\max}=4\\cdot 10^7,\\, \\alpha=0.05,\\, \\tau=0.8,\\, \\delta=\\ln(1.5),\\, \\phi=0.04,\\, \\mathcal{P})$。\n- 用例 $4$：$(B=\\$2880,\\, c_{\\text{prep}}=\\$300,\\, c_{\\text{read}}=\\$15,\\, n_A=4,\\, n_B=4,\\, r_{\\min}=5\\cdot 10^6,\\, r_{\\max}=4\\cdot 10^7,\\, \\alpha=0.05,\\, \\tau=0.8,\\, \\delta=\\ln(1.5),\\, \\phi=0.04,\\, \\mathcal{P})$。\n- 用例 $5$：$(B=\\$4800,\\, c_{\\text{prep}}=\\$300,\\, c_{\\text{read}}=\\$15,\\, n_A=4,\\, n_B=4,\\, r_{\\min}=5\\cdot 10^6,\\, r_{\\max}=4\\cdot 10^7,\\, \\alpha=0.05,\\, \\tau=0.8,\\, \\delta=0.2,\\, \\phi=0.04,\\, \\mathcal{P})$。\n\n最终输出格式：\n- 对于每个测试用例，如果不可行，则输出布尔值 false，否则输出列表 $[r^\\star, f]$，其中 $r^\\star$ 是均分的每个样本的读数深度（整数），$f$ 是达到功效的比例（四舍五入到 $6$ 位小数的浮点数）。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。例如，输出应类似于 $[\\,[r_1, f_1],\\,[r_2, f_2],\\,\\mathrm{false},\\,[r_4, f_4],\\,[r_5, f_5]\\,]$，不需要额外的空格。", "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于已建立的 RNA-seq 数据模型（负二项分布），采用标准的统计框架进行功效分析（基于 delta 方法推导的对数倍数变化的 Wald 检验），并且问题定义良好，提供了所有必要的参数和确定性算法。其前提内部一致，指定的任务在计算上是可行的。因此，可以推导出解决方案。\n\n该解决方案实现了规定的算法，以确定每个样本的最优测序深度以及达到目标统计功效的基因所占的比例。其核心逻辑取决于问题的规定，即在给定模型下，将测序读数均等分配给所有样本是最大化目标函数的最优策略。\n\n每个测试用例的处理过程如下：\n\n1.  **总样本和预算计算**：首先，计算总样本数 $m$，即病例组和对照组样本数之和，$m = n_A + n_B$。总预算 $B$ 被划分为所有样本的文库制备固定成本 $C_{\\text{prep\\_total}} = c_{\\text{prep}} \\cdot m$ 和剩余的测序预算 $B_{\\text{seq}} = \\max\\{0, B - C_{\\text{prep\\_total}}\\}$。然后，通过将测序预算除以每百万读数的成本并进行适当缩放，得到可测序的总读数 $R_{\\text{budget}}$：\n    $$\n    R_{\\text{budget}} = \\left\\lfloor \\frac{B_{\\text{seq}}}{c_{\\text{read}}} \\right\\rfloor \\times 10^6\n    $$\n\n2.  **可行性检查**：只有当可负担的总读数能够满足所有样本的最低要求时，实验设计才是可行的。所需的最小总读数为 $m \\cdot r_{\\min}$。如果 $m \\cdot r_{\\min} > R_{\\text{budget}}$，则设计不可行，该用例的评估终止。\n\n3.  **每个样本的最优读数深度 ($r^\\star$)**：如果设计可行，算法将基于均等读数分配的原则继续进行。可负担的总读数 $R_{\\text{budget}}$ 被均匀分配给 $m$ 个样本。然后，该深度受每个样本允许的最大深度 $r_{\\max}$ 的限制。每个样本的最优读数深度 $r^\\star$ 是一个整数值，由下式给出：\n    $$\n    r^\\star = \\min\\left( r_{\\max}, \\left\\lfloor \\frac{R_{\\text{budget}}}{m} \\right\\rfloor \\right)\n    $$\n    上一步的可行性检查确保了 $r^\\star \\ge r_{\\min}$。\n\n4.  **统计功效计算**：对于由提供的列表 $\\mathcal{P}$ 中的表达比例 $p$ 所表征的每个基因，我们计算检测对数倍数变化 $\\delta$ 的统计功效。此计算对所有样本使用确定的最优读数深度 $r=r^\\star$。\n    a.  对照组 (A) 和病例组 (B) 的平均读数计数计算为 $\\mu_A = r^\\star \\cdot p$ 和 $\\mu_B = r^\\star \\cdot p \\cdot e^{\\delta}$。\n    b.  估计的对数倍数变化 $\\widehat{\\delta}$ 的方差使用提供的公式近似计算：\n        $$\n        \\mathrm{Var}(\\widehat{\\delta}) \\approx \\frac{1}{n_A}\\left(\\frac{1}{\\mu_A} + \\phi\\right) + \\frac{1}{n_B}\\left(\\frac{1}{\\mu_B} + \\phi\\right)\n        $$\n    c.  在显著性水平 $\\alpha$ 下进行双侧检验的统计功效由下式给出：\n        $$\n        \\text{Power}(p; r^\\star) = \\Phi\\!\\left(-z_{\\alpha/2} - \\frac{\\delta}{\\sqrt{\\mathrm{Var}(\\widehat{\\delta})}}\\right) + 1 - \\Phi\\!\\left(z_{\\alpha/2} - \\frac{\\delta}{\\sqrt{\\mathrm{Var}(\\widehat{\\delta})}}\\right)\n        $$\n        其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数 (CDF)，$z_{\\alpha/2}$ 是其上临界值（例如，对于 $\\alpha=0.05$，$z_{0.025} \\approx 1.96$）。\n\n5.  **达到功效的比例计算**：在为每个基因比例 $p \\in \\mathcal{P}$ 计算功效后，我们统计功效达到或超过目标阈值 $\\tau$ 的基因数量 $N_{\\text{powered}}$，即 $\\text{Power}(p; r^\\star) \\ge \\tau$。达到功效的比例 $f$ 是该计数与列表中基因总数的比率：\n    $$\n    f = \\frac{N_{\\text{powered}}}{|\\mathcal{P}|}\n    $$\n\n6.  **最终输出**：对于每个测试用例，如果不可行，输出为布尔值 `false`。否则，输出是一个列表，包含整数最优读数深度 $r^\\star$ 和达到功效的比例 $f$（四舍五入到 6 位小数）。然后将所有测试用例的结果汇总到一个以逗号分隔的列表中。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the RNA-seq experimental design problem.\n    \"\"\"\n\n    # List of gene proportions, common to all test cases.\n    P_list = [1e-6, 2e-6, 5e-6, 1e-5, 2e-5, 5e-5, 1e-4, 2e-4, 5e-4, 1e-3]\n\n    # Test suite parameters:\n    # (B, c_prep, c_read, n_A, n_B, r_min, r_max, alpha, tau, delta, phi, P)\n    test_cases = [\n        (4800, 300, 15, 4, 4, 5e6, 4e7, 0.05, 0.8, np.log(1.5), 0.04, P_list),\n        (3000, 300, 15, 4, 4, 5e6, 4e7, 0.05, 0.8, np.log(1.5), 0.04, P_list),\n        (9600, 300, 15, 4, 4, 5e6, 4e7, 0.05, 0.8, np.log(1.5), 0.04, P_list),\n        (2880, 300, 15, 4, 4, 5e6, 4e7, 0.05, 0.8, np.log(1.5), 0.04, P_list),\n        (4800, 300, 15, 4, 4, 5e6, 4e7, 0.05, 0.8, 0.2, 0.04, P_list),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _calculate_design(*case)\n        results.append(result)\n\n    # Format the final output string as per the problem specification.\n    output_parts = []\n    for result in results:\n        if isinstance(result, bool) and not result:\n            output_parts.append(\"false\")\n        else:\n            # result is a list [r_star, fraction]\n            output_parts.append(f\"[{result[0]},{result[1]}]\")\n            \n    print(f\"[{','.join(output_parts)}]\")\n\n\ndef _calculate_design(B, c_prep, c_read, n_A, n_B, r_min, r_max, alpha, tau, delta, phi, P_list):\n    \"\"\"\n    Calculates the optimal read allocation and achieved fraction for a single case.\n    \"\"\"\n    # 1. Total Sample and Budget Calculation\n    m = n_A + n_B\n    budget_for_reads = B - c_prep * m\n    if budget_for_reads  0:\n        budget_for_reads = 0\n    \n    # Total affordable reads (integer)\n    R_budget = np.floor(budget_for_reads / c_read) * 1e6\n\n    # 2. Feasibility Check\n    if m * r_min > R_budget:\n        return False\n\n    # 3. Optimal Per-Sample Read Depth\n    r_equal = np.floor(R_budget / m)\n    r_star = int(min(r_max, r_equal))\n\n    # 4. Statistical Power Calculation\n    z_crit = norm.ppf(1 - alpha / 2.0)\n    \n    powerful_genes_count = 0\n    for p in P_list:\n        mu_A = r_star * p\n        mu_B = r_star * p * np.exp(delta)\n        \n        power = 0.0\n        # Ensure mean counts are positive to avoid division by zero\n        if mu_A > 0 and mu_B > 0:\n            var_term_A = (1 / n_A) * (1 / mu_A + phi)\n            var_term_B = (1 / n_B) * (1 / mu_B + phi)\n            var_log_fold_change = var_term_A + var_term_B\n            \n            if var_log_fold_change > 0:\n                se_log_fold_change = np.sqrt(var_log_fold_change)\n                z_eff = delta / se_log_fold_change\n                \n                # Power formula from problem statement\n                power = norm.cdf(-z_crit - z_eff) + \\\n                        (1 - norm.cdf(z_crit - z_eff))\n        \n        if power >= tau:\n            powerful_genes_count += 1\n            \n    # 5. Achieved Fraction Calculation\n    achieved_fraction = powerful_genes_count / len(P_list)\n    \n    return [r_star, round(achieved_fraction, 6)]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "5088477"}, {"introduction": "测序完成后，首要步骤是确保数据质量。本练习聚焦于一个关键的质量控制指标：文库的链特异性，它反映了在文库构建过程中RNA分子的原始方向是否被保留。您将使用一个基础的统计工具——二项检验，来根据经验验证数据集的链特异性，这是进行下游分析前一个至关重要的检查步骤。[@problem_id:5088488]", "problem": "一个医学遗传学领域的临床转录组分析项目使用核糖核酸测序（RNA-seq）来量化患者样本中的信使核糖核酸（mRNA）丰度。其基本生物学原理是，脱氧核糖核酸（DNA）以链特异性的方式转录成RNA，然后从RNA分子构建用于测序的互补DNA（cDNA）文库。在某些链特异性方案中，第二链cDNA的合成会掺入脱氧尿苷三磷酸（dUTP），随后dUTP被选择性降解，从而使得测序读段（read）的方向与原始转录本链之间产生可预测的关系。假设参考基因注释指明了每个基因的转录链。\n\n利用这些基本原理，请从宏观层面论证为何链特异性文库制备能够产生相对于注释基因链方向可重复的读段方向，以及为何在统计读段方向时，基于独立伯努利试验的统计检验适用于评估链特异性。\n\n为了从观测数据中经验性地推断链特异性，我们考虑一组经过筛选的、注释在DNA正链上且没有重叠反义转录本的基因。您将来自单个链特异性RNA-seq文库的读段1（read $1$）比对到这些基因上，并记录每个读段相对于基因注释的方向。假设在与这些基因比对的 $n=20$ 个读段中，有 $k=17$ 个读段以相对于基因注释的反义方向进行映射，其余 $n-k$ 个读段以正义方向映射。\n\n在文库非链特异性（即读段方向对称，反义与正义的概率均为 $p=\\frac{1}{2}$）的原假设下，将每个读段的方向视为一次独立的伯努利试验，并进行单边二项检验，以检验反义方向是否存在富集。请计算在原假设下，从 $n$ 个读段中观测到 $k$ 个或更多反义读段的精确单边 $p$ 值，并以小数形式表示。将您的最终数值答案四舍五入至四位有效数字。该量无需物理单位。", "solution": "该问题陈述在科学上是合理的，在计算上是适定的。它准确地描述了基于dUTP的链特异性RNA-seq文库制备方案的原理，并提出了一个生物信息学中用于质量控制的标准统计问题。计算所需的所有数据均已提供。\n\n首先，我们阐述文库链特异性的定性理由以及伯努利试验模型的适用性。\n\n在链特异性方案（如所述的dUTP方法）中，读段方向的可预测性直接源于互补DNA（cDNA）合成和选择的分子生物学过程。该过程可总结如下：\n$1$. **第一链合成**：信使RNA（mRNA）分子作为模板。反转录酶合成一条与mRNA互补的单链cDNA。这就是“第一链”。该链的序列是原始RNA的反向互补序列。\n$2$. **第二链合成**：然后，第一链cDNA作为模板，合成第二条互补的DNA链。在dUTP方案中，该合成反应在一种特殊的反应混合物中进行，其中脱氧胸苷三磷酸（dTTP）被脱氧尿苷三磷酸（dUTP）所取代。因此，新合成的“第二链”在正常情况下应为胸腺嘧啶（T）的位置掺入了尿嘧啶（U）。\n$3$. **链选择**：由此产生的双链cDNA-DNA杂合体包含一条“正常”链（第一链）和一条含尿嘧啶的链（第二链）。用尿嘧啶-DNA糖基化酶（Uracil-DNA Glycosylase, UDG）处理，可特异性地从第二链上切除尿嘧啶碱基。随后用核酸内切酶（如APE $1$）处理，该酶在这些无碱基位点切断磷酸二酯骨架，从而有效降解第二链。\n$4$. **测序**：因此，只有第一链cDNA分子（或其扩增产物）被连接到测序接头上并进行测序。由于所有测序片段都源于第一链，而第一链与原始RNA转录本有固定的关系（即为其反向互补序列），因此得到的测序读段相对于其转录来源的基因将具有一致的、非随机的方向。例如，如果测序过程直接读取第一链，所有读段将映射到基因编码序列的反义链上。这就解释了为何链特异性文库制备能产生可重复的读段方向。\n\n接下来，我们论证使用基于独立伯努利试验的统计检验的合理性。在原假设（$H_0$）下，文库被假定为*非链特异性*。在非链特异性方案中，第一链和第二链cDNA被连接并测序的概率相等。这意味着对于任何给定的转录本，源自它的读段有 $p = \\frac{1}{2}$ 的概率来自第一链（例如，映射为反义），有 $1-p = \\frac{1}{2}$ 的概率来自第二链（映射为正义）。因此，每个测序读段的方向可以被建模为一次只有两个结果（“反义”或“正义”）的伯努利试验，其中成功（例如，“反义”）的概率为 $p = \\frac{1}{2}$。假设RNA分子的片段化和测序是独立事件，那么 $n$ 个不同读段的方向就构成了一系列 $n$ 次独立的伯努利试验。因此，在大小为 $n$ 的样本中，具有特定方向（例如，反义）的读段总数将遵循二项分布。这使得二项检验成为评估链特异性的合适统计框架。\n\n现在，我们进行题目要求的定量分析。我们被要求在文库非链特异性的原假设下，计算从总共 $n$ 个读段中观测到 $k$ 个或更多反义读段的精确单边 $p$ 值。\n\n设 $X$ 为映射到反义方向的读段数量的随机变量。\n试验总数（比对上的读段数）为 $n=20$。\n观测到的反义读段数为 $k=17$。\n\n原假设 $H_0$ 是文库非链特异性，这意味着一个读段映射到反义方向的概率为 $p = \\frac{1}{2}$。\n备择假设 $H_a$ 是反义方向存在富集，即 $p > \\frac{1}{2}$。\n\n在 $H_0$ 下，随机变量 $X$ 服从二项分布，$X \\sim B(n, p)$，参数为 $n=20$ 和 $p=\\frac{1}{2}$。其概率质量函数为：\n$$P(X=j) = \\binom{n}{j} p^j (1-p)^{n-j}$$\n对于本例，该函数变为：\n$$P(X=j) = \\binom{20}{j} \\left(\\frac{1}{2}\\right)^j \\left(1-\\frac{1}{2}\\right)^{20-j} = \\binom{20}{j} \\left(\\frac{1}{2}\\right)^{20}$$\n单边 $p$ 值是假设 $H_0$ 为真时，观测到至少与测量结果一样极端的结果的概率。我们正在检验反义读段的富集情况，因此我们计算 $P(X \\ge k)$。\n$$p\\text{-值} = P(X \\ge 17) = \\sum_{j=17}^{20} P(X=j)$$\n$$p\\text{-值} = P(X=17) + P(X=18) + P(X=19) + P(X=20)$$\n$$p\\text{-值} = \\binom{20}{17}\\left(\\frac{1}{2}\\right)^{20} + \\binom{20}{18}\\left(\\frac{1}{2}\\right)^{20} + \\binom{20}{19}\\left(\\frac{1}{2}\\right)^{20} + \\binom{20}{20}\\left(\\frac{1}{2}\\right)^{20}$$\n我们可以将概率项提取出来：\n$$p\\text{-值} = \\left(\\frac{1}{2}\\right)^{20} \\left[ \\binom{20}{17} + \\binom{20}{18} + \\binom{20}{19} + \\binom{20}{20} \\right]$$\n现在，我们计算二项式系数：\n$$\\binom{20}{17} = \\frac{20!}{17!(20-17)!} = \\frac{20!}{17!3!} = \\frac{20 \\times 19 \\times 18}{3 \\times 2 \\times 1} = 20 \\times 19 \\times 3 = 1140$$\n$$\\binom{20}{18} = \\frac{20!}{18!(20-18)!} = \\frac{20!}{18!2!} = \\frac{20 \\times 19}{2 \\times 1} = 10 \\times 19 = 190$$\n$$\\binom{20}{19} = \\frac{20!}{19!(20-19)!} = \\frac{20!}{19!1!} = 20$$\n$$\\binom{20}{20} = \\frac{20!}{20!(20-20)!} = \\frac{20!}{20!0!} = 1$$\n将这些系数相加：\n$$1140 + 190 + 20 + 1 = 1351$$\n概率项为：\n$$\\left(\\frac{1}{2}\\right)^{20} = \\frac{1}{2^{20}} = \\frac{1}{1048576}$$\n现在，我们计算 $p$ 值：\n$$p\\text{-值} = \\frac{1351}{1048576} \\approx 0.0012883944699...$$\n题目要求将最终数值答案四舍五入至四位有效数字。第一个非零数字是千分位的 $1$。第四位有效数字是第二个 $8$。下一位数字是 $3$，小于 $5$，因此我们向下舍入（即，我们不改变第四位数字）。\n$$p\\text{-值} \\approx 0.001288$$\n这个极小的 $p$ 值为拒绝原假设提供了强有力的证据，从而得出结论：该文库确实是链特异性的，并且反义读段存在富集。", "answer": "$$\\boxed{0.001288}$$", "id": "5088488"}, {"introduction": "在医学遗传学中，RNA-seq的最终目标通常是理解遗传变异的功能性影响。这个问题呈现了一个真实的临床场景，涉及一个预计会引发无义介导的mRNA降解（Nonsense-Mediated Decay, NMD）的变异。您将学习如何综合RNA-seq数据中的多条证据线索——包括等位基因特异性表达和总基因丰度——从而为特定突变如何在转录本水平上影响基因功能构建一个有说服力的论证。[@problem_id:5088382]", "problem": "一名杂合子患者携带基因 $G$ 中的一个截短变异，该变异引入了一个提前终止密码子（PTC），位于最后一个外显子-外显子连接点上游 $80$ 个核苷酸处。根据无义介导的mRNA降解（NMD）的外显子连接复合物（EJC）规则，位于最后一个外显子-外显子连接点上游大约 $55$ 个核苷酸以上的PTC预计会触发NMD。您拥有来自该患者骨骼肌和 $10$ 个匹配对照组的大量核糖核酸测序（RNA-seq；核糖核酸测序）数据。在位于PTC上游的一个杂合单核苷酸多态性（SNP）位点上，患者的等位基因特异性计数为携带参考等位基因的读数 $n_R = 100$ 和携带备择（突变）等位基因的读数 $n_A = 20$，而匹配的对照组则表现出接近 $n_R \\approx n_A$ 的大致平衡的等位基因计数。基因 $G$ 的基因水平归一化计数在患者中为 $c_P = 600$，在对照组中平均为 $c_C = 1100$。在PTC上游，患者的聚合外显子水平覆盖度为 $u_P = 400$，对照组为 $u_C = 720$；在PTC下游，患者为 $d_P = 200$，对照组为 $d_C = 380$。假设RNA-seq读数计数是对潜在的稳态转录本丰度的抽样，并且在没有等位基因偏倚的情况下，杂合位点的等位基因特异性读数遵循二项式抽样模型，其中任一等位基因的零假设比例为 $p = 0.5$。同时假设标准的差异表达推断模型将总表达量建模为与真实丰度成正比。\n\n哪个选项最好地描述了触发NMD的截短变异在等位基因特异性表达和总表达中预期会如何表现，并概述了一个有原则的RNA-seq分析方法来证实该患者中的NMD？\n\nA. 在NMD下，来自突变等位基因的转录本被选择性降解，导致等位基因不平衡，整个基因中突变等位基因被耗尽，并导致总基因表达量全面下降。一个有原则的分析包括：(i) 使用零假设 $p = 0.5$ 的二项式检验在杂合位点上测试等位基因特异性不平衡，并评估观察到的 $n_A$ 与 $n_R$ 的尾部概率；(ii) 量化基因水平的对数倍数变化 $\\log_2(c_P / c_C)$ 以评估总表达量的减少；(iii) 使用EJC规则（$80 > 55$ 个核苷酸）确认位置上的合理性；以及 (iv) 检查上游和下游外显子的减少因子是否相似，这与全局转录本耗尽而非局部覆盖度下降一致。\n\nB. 在NMD下，只有PTC下游的外显子受到影响，且等位基因特异性表达保持在 $p = 0.5$ 的平衡状态。一个有原则的分析专注于使用简单的t检验检测PTC紧下游的急剧 $3'$ 覆盖度下降，并且预期总基因表达量没有变化。\n\nC. 在NMD下，由于反馈补偿，参考等位基因被优先降解，从而增加了突变等位基因的比例。一个有原则的分析使用哈迪-温伯格平衡来检验等位基因比率，并预期基因 $G$ 的总表达量会增加，因为提前终止密码子会上调转录。\n\nD. 在NMD下，等位基因不平衡预计仅在位于PTC下游的SNP处出现；上游的SNP保持平衡。一个有原则的分析使用零假设 $p = 0.33$ 的卡方拟合优度检验来反映三种可能的等位基因状态，并专注于非翻译区的覆盖度比较，因为编码区的读数对于NMD不提供信息。", "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知信息\n- **患者状况**：基因 $G$ 中一个截短变异的杂合子。\n- **变异类型**：引入一个提前终止密码子（PTC）。\n- **PTC位置**：最后一个外显子-外显子连接点上游 $80$ 个核苷酸。\n- **NMD规则**：位于最后一个外显子-外显子连接点上游超过约 $55$ 个核苷酸的PTC预计会触发无义介导的mRNA降解（NMD）。\n- **数据来源**：来自患者骨骼肌和 $10$ 个匹配对照组的大量核糖核酸测序（RNA-seq）数据。\n- **等位基因特异性计数（患者）**：在PTC上游的一个杂合单核苷酸多态性（SNP）位点上，读数 $n_R = 100$（参考等位基因）和 $n_A = 20$（备择/突变等位基因）。\n- **等位基因特异性计数（对照组）**：大致平衡的等位基因计数，$n_R \\approx n_A$。\n- **基因水平计数**：患者归一化计数 $c_P = 600$；对照组平均归一化计数 $c_C = 1100$。\n- **外显子水平覆盖度（PTC上游）**：患者 $u_P = 400$；对照组 $u_C = 720$。\n- **外显子水平覆盖度（PTC下游）**：患者 $d_P = 200$；对照组 $d_C = 380$。\n- **假设1**：RNA-seq读数计数是对稳态转录本丰度的抽样。\n- **假设2**：对于杂合位点的等位基因特异性读数，零模型（无偏倚）是比例为 $p = 0.5$ 的二项分布。\n- **假设3**：标准的差异表达模型将总表达量与真实丰度关联起来。\n- **问题**：描述NMD在RNA-seq数据中的预期表现，并概述一个有原则的分析方法来证实它。\n\n### 步骤2：使用提取的已知信息进行验证\n评估问题陈述的有效性。\n\n- **科学依据**：该问题牢固地建立在已知的分子生物学和遗传学基础上。无义介导的mRNA降解（NMD）是一个特征明确的细胞监视途径。“EJC规则”（也称为“50-55核苷酸规则”）是NMD的一个核心且经过经验验证的原则，指出位于最后一个外显子-外显子连接点上游超过 $50-55$ 个核苷酸的PTC通常会触发mRNA降解。使用RNA-seq查询等位基因特异性表达（ASE）和总基因表达是功能性验证此类变异影响的标准、最先进的方法。所有概念在科学上都是合理的。\n- **问题的适定性**：该问题提供了一个清晰的生物学情景、与该情景一致的定量数据，以及一个关于预期效应和正确分析方法的具体问题。可以根据第一性原理从提供的选项中确定一个唯一的最佳答案。\n- **客观性**：问题陈述使用了精确、客观和定量的语言。没有提出主观或基于意见的主张。\n- **一致性和完整性**：所提供的数据内部一致并支持前提。PTC位于最后一个外显子-外显子连接点上游 $80$ 个核苷酸，满足了预期NMD的条件（$80  55$）。患者的等位基因计数（$n_R=100, n_A=20$）显示出强烈的等位基因不平衡，突变等位基因被耗尽。患者的总基因表达（$c_P=600$）与对照组（$c_C=1100$）相比有所降低。这些数据点都与NMD对杂合变异的预期分子后果一致。问题是自洽的，并提供了所有必要的信息和假设。\n- **无其他缺陷**：该问题没有违反任何其他有效性标准。它不是微不足道的、隐喻性的或不可证伪的。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将推导解决方案。\n\n### 原理与解决方案的推导\n\n无义介导的mRNA降解（NMD）是一种关键的mRNA质量控制机制，它靶向并降解含有提前终止密码子（PTC）的转录本，以防止合成潜在有害的截短蛋白。\n\n1.  **机制与等位基因特异性**：在杂合个体中，基因 $G$ 有两个等位基因：一个参考（野生型）等位基因和一个携带PTC的突变等位基因。NMD机制特异性地识别并降解源自突变等位基因的mRNA转录本。来自参考等位基因的转录本不受影响。\n2.  **对等位基因特异性表达（ASE）的影响**：由于NMD选择性地减少了突变等位基因转录本的丰度，稳态的mRNA池中这些转录本将被耗尽。进行RNA-seq时，读数从这个池中抽样。在一个可以区分两个等位基因的杂合SNP位点上，我们预计观察到的对应于突变等位基因的读数会显著少于参考等位基因。这种现象被称为等位基因不平衡。无不平衡的零假设是，来自任一等位基因的读数应以相等的概率被观察到，即 $p=0.5$。所提供的数据 $n_R = 100$ 和 $n_A = 20$ 清楚地显示了有利于参考等位基因的不平衡。可以使用二项式检验来正式评估这种偏离预期 $1:1$ 比例的统计显著性。\n3.  **对总基因表达的影响**：如果两个等位基因中一个的转录本被大量降解，那么患者体内基因 $G$ 的总稳态mRNA丰度应该低于拥有两个功能性等位基因的对照个体。假设两个等位基因的转录速率相等且NMD效率完美，人们会预期总表达量减少约 $50\\%$。数据显示患者表达量为 $c_P = 600$，对照组平均表达量为 $c_C = 1100$。比率为 $c_P/c_C = 600/1100 \\approx 0.545$，减少了约 $45.5\\%$，这与NMD的预期效应一致。这种变化可以用对数倍数变化 $\\log_2(c_P/c_C)$ 来量化。\n4.  **对转录本覆盖度分布的影响**：NMD导致含有PTC的*整个*mRNA分子的降解。它不仅仅是截断转录本或只降解PTC下游的部分。因此，转录本丰度的减少应该在整个基因的长度上都是明显的。对RNA-seq覆盖度的分析应该显示，与对照组相比，患者的上游和下游外显子的读数深度都有成比例的下降。这将NMD与产生稳定、截短转录本的情景区分开来，后者可能只在PTC下游引起覆盖度的急剧下降。让我们检查一下减少因子：\n    -   上游：患者/对照组 = $u_P/u_C = 400/720 \\approx 0.556$。\n    -   下游：患者/对照组 = $d_P/d_C = 200/380 \\approx 0.526$。\n    减少因子相似（$\\approx 53-56\\%$），支持了整个转录本降解的模型。\n5.  **有原则的分析工作流程**：一个严谨的、用于证实NMD的分析应整合这些不同的证据线索：\n    *   (i) 检查位置合理性：PTC的位置是否满足EJC规则？（是，$80  55$ 个核苷酸）。\n    *   (ii) 测试显著的等位基因不平衡：在ASE计数（$n_A, n_R$）上使用零假设为 $p=0.5$ 的二项式检验。\n    *   (iii) 测试总基因表达量是否降低：将患者表达量与对照组表达量进行比较（例如，计算对数倍数变化）。\n    *   (iv) 检查覆盖度分布：确保表达量的减少在整个转录本主体上是一致的，比较患者与对照组。\n\n### 逐项分析选项\n\n**A. 在NMD下，来自突变等位基因的转录本被选择性降解，导致等位基因不平衡，整个基因中突变等位基因被耗尽，并导致总基因表达量全面下降。一个有原则的分析包括：(i) 使用零假设 $p = 0.5$ 的二项式检验在杂合位点上测试等位基因特异性不平衡，并评估观察到的 $n_A$ 与 $n_R$ 的尾部概率；(ii) 量化基因水平的对数倍数变化 $\\log_2(c_P / c_C)$ 以评估总表达量的减少；(iii) 使用EJC规则（$80 > 55$ 个核苷酸）确认位置上的合理性；以及 (iv) 检查上游和下游外显子的减少因子是否相似，这与全局转录本耗尽而非局部覆盖度下降一致。**\n\n此选项准确描述了NMD的关键分子后果：突变等位基因转录本的选择性降解，导致等位基因不平衡和总基因表达量降低。所提出的四部分分析是全面且方法学上合理的。它正确地指明了使用二项式检验进行ASE分析、使用对数倍数变化评估总表达量、将EJC位置规则作为先验证据，以及检查覆盖度分布以确认全转录本降解。这与有原则的推导完全一致。\n**结论：正确。**\n\n**B. 在NMD下，只有PTC下游的外显子受到影响，且等位基因特异性表达保持在 $p = 0.5$ 的平衡状态。一个有原则的分析专注于使用简单的t检验检测PTC紧下游的急剧 $3'$ 覆盖度下降，并且预期总基因表达量没有变化。**\n\n此选项存在根本性错误。首先，NMD降解整个转录本，而不仅仅是下游部分。其次，突变等位基因的选择性降解正是等位基因不平衡的原因；表达不会保持平衡。第三，由于一整个转录本群体被移除，总基因表达量预计会显著下降。急剧的 $3'$ 下降是稳定截短蛋白的特征，而不是NMD。\n**结论：错误。**\n\n**C. 在NMD下，由于反馈补偿，参考等位基因被优先降解，从而增加了突变等位基因的比例。一个有原则的分析使用哈迪-温伯格平衡来检验等位基因比率，并预期基因 $G$ 的总表达量会增加，因为提前终止密码子会上调转录。**\n\n此选项包含多个严重的科学错误。NMD靶向的是含有PTC的转录本，也就是*突变*等位基因，而不是参考等位基因。哈迪-温伯格平衡是群体遗传学的一个原则，涉及群体中DNA水平的基因型频率；它与单个个体内的RNA表达分析完全无关。PTC通常会上调转录的前提是错误的；对稳态mRNA水平的主要影响是因降解而减少。\n**结论：错误。**\n\n**D. 在NMD下，等位基因不平衡预计仅在位于PTC下游的SNP处出现；上游的SNP保持平衡。一个有原则的分析使用零假设 $p = 0.33$ 的卡方拟合优度检验来反映三种可能的等位基因状态，并专注于非翻译区的覆盖度比较，因为编码区的读数对于NMD不提供信息。**\n\n此选项在多个方面都是错误的。整个转录本的降解意味着该转录本上的任何杂合SNP，无论其相对于PTC的位置如何，都可以用来测量等位基因不平衡。所提出的统计检验是无稽之谈；一个杂合SNP有两种等位基因状态，因此二项式或卡方检验的零假设应基于 $1:1$ 的比例（$p=0.5$），而不是 $p=0.33$ 或三种状态。最后，来自转录本所有部分的读数，包括编码区（CDS）和非翻译区（UTR），都是有信息的，因为整个分子是降解的单位。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "5088382"}]}