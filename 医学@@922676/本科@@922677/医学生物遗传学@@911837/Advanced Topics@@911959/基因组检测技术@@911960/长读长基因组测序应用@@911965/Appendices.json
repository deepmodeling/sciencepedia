{"hands_on_practices": [{"introduction": "在基因组测序中，我们得到的原始数据是数以百万计的、包含随机错误的测序读长。为了构建一个准确可靠的参考基因组序列，我们必须将这些读长“堆叠”起来，并通过多数投票原则来纠正单个读长中的错误。这个练习将带你亲手计算，在给定的测序读长错误率下，需要多大的测序深度（覆盖度）才能达到临床级别的高精度一致性序列，这对于确保下游遗传分析的准确性至关重要。[@problem_id:5053428]", "problem": "一个临床基因组学实验室希望使用 Pacific Biosciences (PacBio) 高保真 (HiFi) 读长，为一个长度为 $3$ Gb 的人类大小的二倍体基因组组装一个高准确度的一致性序列。每个读长的 Phred 质量分数 (Q) 为 $Q30$。每个碱基的目标一致性准确率为 $Q40$。假设以下模型和约束条件，以保持分析的原则性和机理性：\n\n- Phred 质量分数 $Q$ 与碱基错误概率 $p$ 的关系为 $Q = -10 \\log_{10}(p)$，因此 $p = 10^{-Q/10}$。\n- 读长错误在所有读长和位点上是独立同分布的，每个读长的错误概率为 $p$，且没有系统性偏差。\n- 某个位点上的错误被视为相对于真实碱基的二元结果（正确与不正确），这与二项式错误模型一致。\n- 读长可以按单倍型完美划分（完美分相），因此每个单倍型的深度恰好是总覆盖度的一半。\n- 每个单倍型上的一致性碱基是通过对来自该单倍型的读长进行严格多数投票来独立确定的；为确保每个位点都能确定碱基且没有平局，要求每个单倍型的深度 $n$ 是一个奇数。根据此规则，当且仅当错误读长的数量至少为 $\\lfloor n/2 \\rfloor + 1$ 时，一致性序列才是不正确的。\n- 忽略整个基因组的覆盖度变异（将每个位点的深度视为与平均值完全相等）。\n\n基于这些假设，从第一性原理推导出二倍体基因组所需的最小总覆盖度 $C$（以X为单位），使得每个单倍型上每个碱基的一致性错误概率最多为 $10^{-4}$（即一致性准确率至少为 $Q40$）。请以X为单位的单个整数形式报告您的最终答案。除了报告整数外，不需要进行四舍五入。以X为单位表示最终覆盖度，但不要在最终的方框答案中包含单位。", "solution": "### 步骤 1：提取已知条件\n-   **基因组长度：** $3$ Gb（二倍体）\n-   **测序数据：** Pacific Biosciences (PacBio) 高保真 (HiFi) 读长\n-   **单个读长质量：** Phred 质量分数 $Q_{read} = 30$\n-   **目标一致性质量：** 每碱基一致性准确率 $Q_{consensus} = 40$\n-   **Phred 分数公式：** $Q = -10 \\log_{10}(p)$，这意味着每碱基错误概率为 $p = 10^{-Q/10}$\n-   **错误模型：** 读长错误是独立同分布的 (i.i.d.)，具有二元结果（正确 vs. 不正确）。错误数量遵循二项分布。\n-   **分相与覆盖度：** 读长按单倍型完美划分。单倍型深度，记为 $n$，恰好是总覆盖度 $C$ 的一半。因此，$n = C/2$。\n-   **一致性判定：** 在每个单倍型上通过严格多数投票独立进行。\n-   **深度约束：** 单倍型深度 $n$ 必须是奇数以避免平局。\n-   **一致性错误条件：** 如果错误读长的数量至少为 $\\lfloor n/2 \\rfloor + 1$，则一致性碱基不正确。\n-   **覆盖度均匀性：** 覆盖度在整个基因组中是恒定的。\n-   **目标：** 找到最小的总覆盖度 $C$（一个整数，以X为单位），使得每个单倍型上每碱基的一致性错误概率最多为 $10^{-4}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，定义明确且客观。它提供了一个简化但机理上合理的模型，用于根据读长数据计算一致性准确率，这是生物信息学中的一个标准问题。\n-   **科学依据：** 使用 Phred 分数、二项错误模型和多数投票生成一致性序列都是成熟的概念。参数（HiFi 读长的 $Q30$，目标为 $Q40$ 一致性）是现实的。简化（均匀覆盖、完美分相、独立同分布的二元错误）被明确说明，以创建一个可解的第一性原理问题，并且不会使科学或数学逻辑失效。\n-   **问题的适定性：** 问题是自洽的，具有明确的目标（最小化 $C$）和定义明确的数学约束。所有变量和关系都已指定，从而导出一个唯一的整数解。\n-   **客观性：** 问题以精确、定量的术语陈述，没有歧义或主观声明。\n\n### 步骤 3：结论与行动\n问题有效。将推导出一个合理的解决方案。\n\n### 解题推导\n问题要求我们找到达到指定一致性质量所需的最小总测序覆盖度 $C$。推导过程从第一性原理出发，如下所示。\n\n1.  **将质量分数转换为概率：**\n    Phred 质量分数 $Q$ 与错误概率 $p$ 的关系为 $p = 10^{-Q/10}$。\n    -   对于 $Q_{read} = 30$ 的单个读长，其每碱基错误概率为：\n        $$ p = 10^{-30/10} = 10^{-3} $$\n    -   对应于 $Q_{consensus} = 40$ 的一致性碱基的目标最大错误概率为：\n        $$ P_{target} = 10^{-40/10} = 10^{-4} $$\n\n2.  **为一致性错误建模：**\n    令 $n$ 为每个单倍型的覆盖深度。问题规定 $n$ 必须是一个奇数。在某个单倍型上的任意给定碱基处，有 $n$ 个读长。令 $k$ 为在这一碱基上包含错误的读长数量。由于假设错误是独立同分布的，随机变量 $k$ 遵循参数为 $n$ 和 $p$ 的二项分布：\n    $$ k \\sim B(n, p) $$\n    在 $n$ 个读长中观察到恰好 $k$ 个错误读长的概率由二项概率质量函数给出：\n    $$ P(k) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n    在多数投票规则下，如果错误读长的数量 $k$ 大于正确读长的数量 $n-k$，则发生一致性错误。这意味着 $k > n-k$，即 $2k > n$，等价于 $k > n/2$。由于 $n$ 是一个奇数，我们可以写成 $n = 2j+1$，其中 $j \\ge 0$ 是某个整数。对于整数 $k$，条件 $k > (2j+1)/2 = j+0.5$ 等价于 $k \\ge j+1$。注意 $j+1 = (n-1)/2 + 1 = (n+1)/2$。这与问题中定义的当 $k \\ge \\lfloor n/2 \\rfloor + 1$ 时发生错误的条件相符。\n\n3.  **建立不等式：**\n    对于给定的深度 $n$，一致性错误的概率（我们称之为 $P_{E,n}$）是错误读长数量 $k$ 至少为 $(n+1)/2$ 的概率。这可以通过对分布的上尾部求和二项概率来计算：\n    $$ P_{E,n} = P(k \\ge \\frac{n+1}{2}) = \\sum_{k=(n+1)/2}^{n} \\binom{n}{k} p^k (1-p)^{n-k} $$\n    我们的目标是找到满足以下条件的最小奇数 $n$：\n    $$ P_{E,n} \\le P_{target} \\implies \\sum_{k=(n+1)/2}^{n} \\binom{n}{k} p^k (1-p)^{n-k} \\le 10^{-4} $$\n\n4.  **通过测试最小的奇数 $n$ 值来解不等式：**\n    我们必须找到满足该不等式的最小奇数 $n$。我们从最小可能的值 $n=1$ 开始。\n\n    -   **情况 $n=1$**：\n        一致性错误的条件是 $k \\ge (1+1)/2 = 1$。\n        错误概率为：\n        $$ P_{E,1} = P(k \\ge 1) = P(k=1) = \\binom{1}{1} p^1 (1-p)^0 = p = 10^{-3} $$\n        我们检查条件：$10^{-3} \\le 10^{-4}$。这是不成立的。因此，单倍型深度 $n=1$ 是不足的。\n\n    -   **情况 $n=3$**：\n        一致性错误的条件是 $k \\ge (3+1)/2 = 2$。\n        错误概率是 $k=2$ 和 $k=3$ 的概率之和：\n        $$ P_{E,3} = P(k \\ge 2) = P(k=2) + P(k=3) $$\n        $$ P_{E,3} = \\binom{3}{2} p^2 (1-p)^{3-2} + \\binom{3}{3} p^3 (1-p)^{3-3} $$\n        $$ P_{E,3} = 3 p^2 (1-p) + 1 p^3 $$\n        代入 $p=10^{-3}$：\n        $$ P_{E,3} = 3(10^{-3})^2 (1 - 10^{-3}) + (10^{-3})^3 $$\n        $$ P_{E,3} = 3 \\times 10^{-6} (0.999) + 10^{-9} $$\n        $$ P_{E,3} = 2.997 \\times 10^{-6} + 0.001 \\times 10^{-6} = 2.998 \\times 10^{-6} $$\n        让我们精确计算：$P_{E,3} = 2.997 \\times 10^{-6} + 1 \\times 10^{-9} = 2.997001 \\times 10^{-6}$。\n        我们检查条件：$2.997001 \\times 10^{-6} \\le 10^{-4}$。这是成立的，因为 $10^{-4} = 100 \\times 10^{-6}$。\n        由于 $n=1$ 不足而 $n=3$ 足够，所需的最小奇数单倍型深度为 $n=3$。\n\n5.  **计算总覆盖度：**\n    问题要求的是最小的*总*覆盖度 $C$。二倍体基因组的总覆盖度与单倍型深度 $n$ 的关系为 $C=2n$。\n    使用所需的最小单倍型深度 $n=3$：\n    $$ C = 2 \\times n = 2 \\times 3 = 6 $$\n    所需的最小总覆盖度是 $6$X。这是一个整数，符合要求。\n\n$3$ Gb 的基因组长度是无关信息，因为计算是在均匀覆盖假设下针对每碱基准确率进行的。", "answer": "$$\n\\boxed{6}\n$$", "id": "5053428"}, {"introduction": "长读长测序技术最显著的优势之一是其检测大型结构性变异（SV）的能力，例如大片段的基因组缺失，这些变异往往是许多遗传病的根源。成功检测一个杂合缺失不仅需要找到跨越缺失断裂点的“分裂读长”，还需要找到能够完整跨越整个缺失区域的“跨越读长”以确认杂合状态。这个练习模拟了一个真实的临床场景，要求你计算检测一个50 kb大小的杂合缺失所需的最小读长和测序深度，让你深入理解检测结构性变异背后的统计学原理和证据要求。[@problem_id:5053450]", "problem": "一个二倍体人类样本在一个嵌入独特序列的位点上携带一个大小为 $L_{d} = 50$ 千碱基 (kb) 的杂合性缺失。您的任务是，在以下假设下，确定使用长读长测序技术检测此缺失时，达到 $95\\%$ 效能所需的最小读长跨度和测序覆盖度（深度）。\n\n基本假设：\n1. 读长在基因组上的起始位置遵循 Lander-Waterman 模型：读长起始位点形成一个强度为 $r$（每个碱基的起始数）的泊松过程，单碱基覆盖度（平均深度）为 $\\lambda = r \\,\\bar{\\ell}$，其中 $\\bar{\\ell}$ 是平均读长长度。\n2. 读长长度是独立同分布的，并服从平均值为 $\\bar{\\ell} = 30$ kb 的指数分布。\n3. 由于该缺失是杂合的，两条同源染色体中只有一条携带该缺失。因此，在感兴趣的区域，恰好有一半的读长来源于缺失单倍型，另一半来源于完整单倍型。\n4. 检测标准：如果以下两个条件都得到满足，则认为该缺失已被检测到：\n   (i) 至少有一条来自缺失单倍型的分裂读长，它跨越了新的邻接点（由缺失产生的断点连接处），并且在读长内部断点的两侧各自包含至少 $b = 1$ kb 的可唯一比对序列。\n   (ii) 至少有一条来自完整单倍型的读长，它跨越了整个缺失区间，并在每个侧翼包含至少 $b = 1$ kb 的可唯一比对序列。这可以防止错误的纯合检出，并支持杂合性。\n\n将这两个证据类别的合格读长数量建模为由泊松起始过程和读长长度分布决定的独立泊松计数。使用这些模型来计算观察到每个类别中至少有一个合格读长的概率。在这些假设下，计算：\n\n- 完整单倍型读长满足标准 (ii) 所需的最小读长跨度（单位kb）。\n- 检测杂合性缺失达到 $95\\%$ 总体效能所需的最小单碱基覆盖度 $\\lambda$（作为一个纯数，即倍数覆盖度）。该总体效能定义为观察到至少一个合格的分裂读长和至少一个合格的完整跨越读长的概率的乘积。\n\n将最小读长跨度和所需覆盖度都四舍五入到三位有效数字。最小读长跨度以千碱基（kb）为单位表示，覆盖度以纯数（倍数覆盖度）表示。", "solution": "该问题陈述已经过验证，被认为是具有科学依据、提法得当、客观且内部一致的。它提出了一个基因组生物信息学中标准的、尽管是简化的定量问题，使用了诸如用于读长分布的 Lander-Waterman 模型和用于事件计数的泊松统计等已建立的模型。所有必要的参数都已提供，且假设陈述清晰。该问题是可解的。\n\n问题要求计算两个量：识别支持杂合性缺失的完整读长所需的最小读长跨度，以及以 $95\\%$ 的效能检测该缺失所需的测序覆盖度。\n\n**第1部分：完整单倍型读长的最小读长跨度**\n\n问题定义了检测完整单倍型读长的要求（标准 ii）。该读长必须跨越整个缺失区间，并在每个侧翼包含至少 $b$ 的可唯一比对序列。\n\n杂合性缺失的大小给出为 $L_{d} = 50$ kb。\n每个侧翼所需的可唯一比对序列长度为 $b = 1$ kb。\n\n在完整染色体上，与缺失相对应的区域长度为 $L_d$。要使一个读长被视为完整单倍型的证据，它必须覆盖这个长度为 $L_d$ 的区域，以及 5' 侧翼上额外长度为 $b$ 的序列和 3' 侧翼上额外长度为 $b$ 的序列。因此，单个读长在完整染色体上必须跨越的总连续基因组区间是这些长度的总和。\n\n设 $S_{intact}$ 为此最小所需跨度。\n$$S_{intact} = b + L_{d} + b = L_{d} + 2b$$\n代入给定值：\n$$S_{intact} = 50 \\, \\text{kb} + 2 \\times (1 \\, \\text{kb}) = 52 \\, \\text{kb}$$\n四舍五入到三位有效数字，最小读长跨度为 $52.0$ kb。\n\n**第2部分：达到 95% 效能的最小单碱基覆盖度 ($\\lambda$)**\n\n检测杂合性缺失的总体效能定义为满足标准 (i) 和 (ii) 的概率的乘积。\n设 $P_{detect}$ 为总效能。设 $P_{split}$ 为观察到至少一个合格分裂读长的概率（标准 i）。设 $P_{intact}$ 为观察到至少一个合格完整读长的概率（标准 ii）。\n$$P_{detect} = P_{split} \\times P_{intact}$$\n问题陈述指出，每种类型的合格读长数量服从独立的泊松分布。设 $N_{split}$ 和 $N_{intact}$ 分别为合格分裂读长和完整读长计数的随机变量，其平均值分别为 $\\mu_{split}$ 和 $\\mu_{intact}$。\n$$N_{split} \\sim \\text{Poisson}(\\mu_{split})$$\n$$N_{intact} \\sim \\text{Poisson}(\\mu_{intact})$$\n在平均值为 $\\mu$ 的泊松过程中观察到至少一个事件的概率是 $1 - P(N=0) = 1 - e^{-\\mu}$。因此：\n$$P_{split} = 1 - e^{-\\mu_{split}}$$\n$$P_{intact} = 1 - e^{-\\mu_{intact}}$$\n我们要求 $P_{detect} = (1 - e^{-\\mu_{split}})(1 - e^{-\\mu_{intact}}) = 0.95$。\n\n为了找到平均值 $\\mu_{split}$ 和 $\\mu_{intact}$，我们使用提供的模型。对于长度服从平均值为 $\\bar{\\ell}$ 的指数分布的读长，跨越长度为 $S$ 的基因组区间的预期读长数由 $\\lambda_{eff} \\exp(-S/\\bar{\\ell})$ 给出，其中 $\\lambda_{eff}$ 是来源单倍型的有效覆盖度。\n\n总单碱基覆盖度为 $\\lambda$。由于缺失是杂合的，读长以相等的比例来源于缺失单倍型和完整单倍型。因此，每个单倍型的有效覆盖度为 $\\lambda_{del} = \\lambda_{intact} = \\lambda/2$。\n\n对于合格的完整读长（标准 ii），所需跨度为 $S_{intact} = L_d + 2b = 52$ kb。此类读长的平均数量为：\n$$\\mu_{intact} = \\lambda_{intact} \\exp\\left(-\\frac{S_{intact}}{\\bar{\\ell}}\\right) = \\frac{\\lambda}{2} \\exp\\left(-\\frac{L_d + 2b}{\\bar{\\ell}}\\right)$$\n\n对于合格的分裂读长（标准 i），读长必须跨越断点连接处，并在两侧各包含至少 $b$ kb 的可比对序列。读长中必须包含的来自参考序列的总长度为 $b+b=2b$。这构成了分裂读长的最小跨度 $S_{split}$。\n$$S_{split} = 2b = 2 \\times (1 \\, \\text{kb}) = 2 \\, \\text{kb}$$\n此类读长的平均数量为：\n$$\\mu_{split} = \\lambda_{del} \\exp\\left(-\\frac{S_{split}}{\\bar{\\ell}}\\right) = \\frac{\\lambda}{2} \\exp\\left(-\\frac{2b}{\\bar{\\ell}}\\right)$$\n\n现在，我们可以用 $\\lambda$ 写出完整的效能方程：\n$$ \\left(1 - \\exp\\left[-\\frac{\\lambda}{2} \\exp\\left(-\\frac{2b}{\\bar{\\ell}}\\right)\\right]\\right) \\left(1 - \\exp\\left[-\\frac{\\lambda}{2} \\exp\\left(-\\frac{L_d + 2b}{\\bar{\\ell}}\\right)\\right]\\right) = 0.95 $$\n给定参数为 $\\bar{\\ell} = 30$ kb, $L_d = 50$ kb, 以及 $b=1$ kb。让我们计算指数部分：\n$$\\frac{2b}{\\bar{\\ell}} = \\frac{2}{30} = \\frac{1}{15}$$\n$$\\frac{L_d + 2b}{\\bar{\\ell}} = \\frac{50 + 2}{30} = \\frac{52}{30} = \\frac{26}{15}$$\n由于 $26/15 \\gg 1/15$，我们有 $\\exp(-26/15) \\ll \\exp(-1/15)$。因此，对于任何给定的 $\\lambda$，$\\mu_{intact} \\ll \\mu_{split}$。这意味着 $P_{intact}$ 将远小于 $P_{split}$，并将成为达到期望总体效能的限制因素。\n\n项 $P_{split} = 1 - e^{-\\mu_{split}}$ 将非常接近于 1。因此我们可以通过设 $P_{split} \\approx 1$ 来近似效能方程：\n$$1 \\times P_{intact} \\approx 0.95$$\n$$1 - \\exp(-\\mu_{intact}) \\approx 0.95$$\n这可以简化为：\n$$\\exp(-\\mu_{intact}) \\approx 0.05$$\n$$-\\mu_{intact} \\approx \\ln(0.05) = -\\ln(20)$$\n$$\\mu_{intact} \\approx \\ln(20)$$\n现在，我们代入 $\\mu_{intact}$ 的表达式：\n$$\\frac{\\lambda}{2} \\exp\\left(-\\frac{L_d + 2b}{\\bar{\\ell}}\\right) = \\ln(20)$$\n我们现在可以解出所需的覆盖度 $\\lambda$：\n$$\\lambda = 2 \\ln(20) \\exp\\left(\\frac{L_d + 2b}{\\bar{\\ell}}\\right)$$\n代入数值：\n$$\\lambda = 2 \\ln(20) \\exp\\left(\\frac{52}{30}\\right)$$\n使用计算器：\n$\\ln(20) \\approx 2.995732$\n$\\exp(52/30) = \\exp(26/15) \\approx 5.65958$\n$$\\lambda \\approx 2 \\times 2.995732 \\times 5.65958 \\approx 33.909$$\n我们必须验证对于这个 $\\lambda$ 值，$P_{split} \\approx 1$ 的近似是否合理。当 $\\lambda \\approx 33.909$ 时：\n$$\\mu_{split} = \\frac{33.909}{2} \\exp\\left(-\\frac{2}{30}\\right) \\approx 16.9545 \\times \\exp(-0.06667) \\approx 16.9545 \\times 0.93551 \\approx 15.862$$\n$$P_{split} = 1 - \\exp(-15.862) \\approx 1 - 1.29 \\times 10^{-7}$$\n这个值极度接近 1，所以该近似是有效的。总体效能为 $P_{detect} \\approx (1 - 1.29 \\times 10^{-7}) \\times 0.95 \\approx 0.95$。\n\n将 $\\lambda$ 的值四舍五入到三位有效数字，我们得到 $\\lambda = 33.9$。\n所需的最小单碱基覆盖度为 33.9 倍。", "answer": "$$\\boxed{\\begin{pmatrix} 52.0  33.9 \\end{pmatrix}}$$", "id": "5053450"}, {"introduction": "基因通过选择性剪接可以产生多种不同的转录本（亚型），这些亚型在功能上可能有巨大差异。长读长转录组测序能够捕获完整的转录本序列，为我们揭示这种复杂性提供了前所未有的机会。然而，在实验设计中，一个核心问题是：我们需要多大的测序通量才能有足够高的置信度检测到一个稀有的、但可能具有重要生物学功能的亚型？本练习将指导你使用泊松分布模型来回答这个问题，帮助你掌握在转录组学研究中平衡测序成本和检测灵敏度的关键计算。[@problem_id:5053439]", "problem": "一个临床研究团队使用长读长转录组测序来解析一个疾病相关基因的全长亚型。假设每个测序的互补DNA（cDNA）分子对应来自目标基因的一个全长读长，并且在所有亚型中的抽样是独立且无偏的。在抽样组织中，该基因的所有亚型中，一个稀有亚型的真实丰度比例为 $p = 0.01$。该团队对 $N$ 个全长读长中来自此稀有亚型的读长计数 $X$ 采用泊松抽样模型，将 $X$ 视为以 $N$ 和 $p$ 为条件的泊松随机变量。他们将“检测”定义为观察到至少一个来自该稀有亚型的读长，并要求在单次实验中检测的置信水平为 $0.95$。\n\n从二项分布和泊松分布的标准定义以及抽样独立性出发，推导在泊松模型下，为使检测到稀有亚型的概率（即事件 $X \\geq 1$）至少为 $0.95$ 所需的最小全长读长数 $N$。报告满足此标准的最小整数 $N$。无需四舍五入到有效数字；请提供确切的最小整数值。", "solution": "问题要求计算为了以至少 $0.95$ 的概率检测到一个稀有亚型，所需的最小全长读长数 $N$。该亚型的先验丰度以比例 $p = 0.01$ 给出。观测到的该亚型的读长数 $X$ 将被建模为一个泊松随机变量。\n\n首先，我们将问题形式化。抽样 $N$ 个读长的过程可以看作是一系列 $N$ 次独立的伯努利试验，其中如果读长对应于稀有亚型，则该试验为一次“成功”。任何一次试验的成功概率为 $p = 0.01$。因此，来自稀有亚型的读长的确切数量 $X$ 服从二项分布，$X \\sim \\text{Bin}(N, p)$。\n\n问题陈述明确指示我们对计数 $X$ 使用泊松模型。在试验次数 $N$ 很大且成功概率 $p$ 很小的情况下，泊松分布是二项分布的一个公认的近似。泊松分布的参数 $\\lambda$ 是成功次数的期望值，由试验次数和成功概率的乘积给出：\n$$ \\lambda = Np $$\n因此，我们将 $X$ 建模为泊松随机变量，$X \\sim \\text{Pois}(\\lambda)$，其概率质量函数（PMF）由下式给出：\n$$ P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!} $$\n对于 $k \\in \\{0, 1, 2, \\dots\\}$。\n\n“检测”被定义为观察到至少一个来自稀有亚型的读长，这对应于事件 $X \\geq 1$。问题要求此事件的概率至少为 $0.95$。我们将其表示为一个不等式：\n$$ P(X \\geq 1) \\geq 0.95 $$\n事件 $X \\geq 1$ 是事件 $X=0$（未观察到来自稀有亚型的读长）的补集。因此，该概率可以重写为：\n$$ P(X \\geq 1) = 1 - P(X=0) $$\n将此代入我们的不等式中，得到：\n$$ 1 - P(X=0) \\geq 0.95 $$\n重新整理各项，我们得到关于 $P(X=0)$ 的条件：\n$$ P(X=0) \\leq 1 - 0.95 $$\n$$ P(X=0) \\leq 0.05 $$\n现在，我们通过设置 $k=0$ 使用泊松概率质量函数来找到 $P(X=0)$ 的表达式：\n$$ P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\frac{1 \\cdot \\exp(-\\lambda)}{1} = \\exp(-\\lambda) $$\n不等式变为：\n$$ \\exp(-\\lambda) \\leq 0.05 $$\n为了求解 $\\lambda$，我们对两边取自然对数。由于自然对数函数 $\\ln(x)$ 是单调递增的，不等号的方向保持不变：\n$$ \\ln(\\exp(-\\lambda)) \\leq \\ln(0.05) $$\n$$ -\\lambda \\leq \\ln(0.05) $$\n为了分离出 $\\lambda$，我们将两边乘以 $-1$，这会反转不等号的方向：\n$$ \\lambda \\geq -\\ln(0.05) $$\n使用对数恒等式 $-\\ln(a) = \\ln(1/a)$，我们可以简化右侧：\n$$ \\lambda \\geq \\ln\\left(\\frac{1}{0.05}\\right) = \\ln(20) $$\n现在，我们将 $\\lambda = Np$ 代回不等式中：\n$$ Np \\geq \\ln(20) $$\n我们被要求找到最小读长数 $N$。我们可以通过除以 $p$ 来分离出 $N$（因为 $p > 0$，不等号方向不变）：\n$$ N \\geq \\frac{\\ln(20)}{p} $$\n给定值 $p = 0.01$。将此值代入不等式：\n$$ N \\geq \\frac{\\ln(20)}{0.01} $$\n为了找到最小整数 $N$，我们必须计算右侧的数值。$\\ln(20)$ 的值约等于 $2.99573227$。\n$$ N \\geq \\frac{2.99573227}{0.01} $$\n$$ N \\geq 299.573227 $$\n因为 $N$ 必须是代表读长数量的整数，我们必须选择满足此条件的最小整数。大于或等于 $299.573227$ 的最小整数是 $300$。\n因此，必须测序至少 $300$ 个全长读长，以确保检测到稀有亚型的概率至少为 $0.95$。", "answer": "$$ \\boxed{300} $$", "id": "5053439"}]}