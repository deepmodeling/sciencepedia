{"hands_on_practices": [{"introduction": "为了真正理解直接面向消费者（DTC）的基因检测，我们首先需要揭开多基因风险评分（PRS）的神秘面纱，了解它是如何从基础的基因数据构建而成的。这项练习将带领我们“深入后台”，通过一个简化的模型，从零开始计算一个标准化的PRS。这个过程将阐明基因型数据和全基因组关联研究（GWAS）的效应值是如何结合起来，量化个人遗传易感性的。 [@problem_id:5024243]", "problem": "一家直接面向消费者（DTC）的基因检测公司，根据一组有限的单核苷酸多态性（SNPs），提供一种复杂性状的多基因风险评分（PRS）。在复杂性状的加性遗传模型下，每个SNP对一个未标准化的遗传易感性指数的贡献，与其源自全基因组关联研究（GWAS）的每个等位基因的效应大小，以及个体基因型中风险等位基因的数量成正比。该公司随后通过使用群体均值对未标准化的指数进行中心化，并按群体标准差进行缩放，来报告一个标准化的值。考虑一个个体，其有$3$个SNP，每个等位基因的效应大小为$\\beta = [0.1, 0.05, -0.02]$，其基因型中风险等位基因的数量为$x = [2, 1, 0]$。用于标准化的参考群体分布的均值为$0$，标准差为$0.2$。从加性模型和标准化的定义出发，计算该个体的标准化PRS，以$z$-分数的形式表示。将您的最终$z$-分数四舍五入到四位有效数字。将最终结果表示为一个无单位的纯数。然后，用文字简要解释在所述模型下，这个$z$-分数对于该个体在参考群体的遗传易感性分布中的相对位置意味着什么。", "solution": "该问题要求基于一个简化的加性遗传模型，计算并解释一个个体的标准化多基因风险评分（PRS）。\n\n首先，有必要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **模型：** 复杂性状的加性遗传模型。\n- **SNP数量（$N$）：** $3$。\n- **每个等位基因的效应大小（$\\beta$）：** 一个向量，$\\beta = [0.1, 0.05, -0.02]$。\n- **个体基因型风险等位基因计数（$x$）：** 一个向量，$x = [2, 1, 0]$。\n- **未标准化分数的参考群体均值（$\\mu$）：** $0$。\n- **未标准化分数的参考群体标准差（$\\sigma$）：** $0.2$。\n- **任务1：** 计算个体的标准化PRS作为$z$-分数。\n- **任务2：** 将最终的$z$-分数四舍五入到四位有效数字。\n- **任务3：** 用文字简要解释$z$-分数。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。使用加性模型根据单核苷酸多态性（SNPs）及其来自全基因组关联研究（GWAS）的相关效应大小来计算PRS是统计遗传学中的一种标准方法。效应大小的值很小，这对于单个SNP效应微弱的复杂性状来说是现实的。等位基因计数（$0$、$1$或$2$）对于二倍体生物在生物学上是正确的。使用参考群体的均值和标准差将原始分数标准化为$z$-分数是一个基本的统计程序。该问题提法明确，为获得唯一解提供了所有必要的参数。语言客观而精确。因此，该问题是有效的。\n\n**步骤3：进行求解**\n加性模型假定，我们记为$S_{raw}$的总未标准化遗传易感性指数是每个SNP贡献的总和。每个SNP的贡献是其每个等位基因效应大小（$\\beta_i$）与个体在该SNP位点上拥有的风险等位基因数量（$x_i$）的乘积。\n\n未标准化遗传易感性指数的公式为：\n$$S_{raw} = \\sum_{i=1}^{N} \\beta_i x_i$$\n在向量表示法中，这是效应大小向量和等位基因计数向量的点积：\n$$S_{raw} = \\beta \\cdot x = \\beta^T x$$\n问题提供了$N=3$个SNP，其效应大小为$\\beta = [0.1, 0.05, -0.02]$，等位基因计数为$x = [2, 1, 0]$。我们可以将这些值代入公式：\n$$S_{raw} = (0.1 \\times 2) + (0.05 \\times 1) + (-0.02 \\times 0)$$\n计算各个项：\n$$S_{raw} = 0.2 + 0.05 + 0$$\n将各项相加得出未标准化的分数：\n$$S_{raw} = 0.25$$\n接下来，必须使用提供的参考群体参数将此未标准化的分数标准化为$z$-分数。$z$-分数的公式为：\n$$Z = \\frac{\\text{值} - \\text{均值}}{\\text{标准差}}$$\n在此背景下，“值”是个体的未标准化分数$S_{raw}$，而均值和标准差分别是参考群体的$\\mu$和$\\sigma$。\n$$Z = \\frac{S_{raw} - \\mu}{\\sigma}$$\n问题说明参考群体的均值为$\\mu = 0$，标准差为$\\sigma = 0.2$。代入计算出的$S_{raw}$和给定的群体参数：\n$$Z = \\frac{0.25 - 0}{0.2}$$\n这可以简化为：\n$$Z = \\frac{0.25}{0.2} = 1.25$$\n问题要求最终答案四舍五入到四位有效数字。计算值$1.25$有三位有效数字。为了用四位表示，我们追加一个零：\n$$Z = 1.250$$\n最后，问题要求对这个$z$-分数进行简要解释。$z$-分数用标准差的倍数量化了一个数据点与其分布均值的偏离程度。在本例中，$z$-分数为$1.250$意味着该个体计算出的遗传易感性比参考群体的平均遗传易感性高出$1.250$个标准差。这使该个体处于分布的大约第$89.4$个百分位（假设群体中的分数呈正态分布），表明根据此模型中包含的有限SNP集合，该个体对该性状具有高于平均水平的遗传易感性。", "answer": "$$\\boxed{1.250}$$", "id": "5024243"}, {"introduction": "直接面向消费者的基因检测报告常常以相对风险的形式呈现结果，例如“您的风险是普通人群的$1.5$倍”，这种表述可能令人困惑或警觉。这项练习旨在教授一项关键技能：将抽象的相对风险转化为更直观、更有意义的绝对风险。掌握这项技能对于临床医生和消费者进行有效、清晰的风险沟通至关重要。 [@problem_id:5024286]", "problem": "一位患者带着一份直达消费者（DTC）基因检测报告来到诊所，报告中称：“与普通人群相比，您患上X病症的相对风险为$1.5$倍。”临床医生知道，根据当地人口登记处的数据，与年龄和性别匹配的人群中，X病症的$10$年基线发病率为$0.05$。运用流行病学和风险沟通中的基本定义，按以下步骤操作：\n\n- 从相对风险的定义（概率之比）和基线发病率的定义（在指定时间范围内，平均风险组中个体患上该病的概率）出发。\n- 假设直达消费者（DTC）基因检测报告的相对风险乘以平均风险个体在相同$10$年时间范围内的基线概率，并且此计算无需对竞争风险或人口结构变化进行建模。\n\n任务：\n1) 以概率形式计算患者的$10$年绝对风险。\n2) 然后，用通俗易懂的语言写一句话，使用自然频率来传达$10$年绝对风险，避免仅仅依赖相对风险，这句话应适合非专业人士。\n\n答案规格：\n- 以不带百分号的小数形式表示$10$年绝对风险。\n- 将$10$年绝对风险四舍五入至三位有效数字。\n- 最终方框内的答案应只包含$10$年绝对风险的数值。通俗易懂的句子不应出现在最终方框内的答案中。", "solution": "在进行解答之前，首先评估问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- X病症的相对风险：$RR = 1.5$\n- X病症的$10$年基线发病率：$0.05$\n- 相对风险的定义：概率之比。\n- 基线发病率的定义：在指定时间范围内，平均风险组中个体患上该病的概率。\n- 假设1：相对风险乘以基线概率。\n- 假设2：无需对竞争风险或人口结构变化进行建模。\n- 任务1：计算患者的$10$年绝对风险。\n- 任务2：撰写一句用于风险沟通的通俗易懂的句子。\n- 答案规格1：以小数形式表示绝对风险。\n- 答案规格2：将绝对风险四舍五入至三位有效数字。\n- 答案规格3：最终方框内的答案应只包含绝对风险的数值。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准评估该问题。\n\n- **有科学依据**：该问题基于流行病学的基本和标准原则，特别是相对风险、基线发病率和绝对风险之间的定义和关系。所提供的值（$RR = 1.5$，基线风险 = $0.05$）对于一种常见的复杂遗传病是合理的。\n- **定义明确**：该问题定义明确。它提供了所有必要的数据（$RR$和基线风险）和清晰的计算说明。简化的假设（乘法模型，无竞争风险）确保可以确定唯一的解。\n- **客观性**：该问题使用精确、客观和定量的语言陈述，没有歧义或主观性陈述。\n\n该问题没有科学上不健全、信息缺失或条件不切实际等缺陷。这是一个与医学遗传学和风险沟通领域相关的标准、可形式化的计算。\n\n### 步骤3：结论和行动\n该问题被认定为**有效**。将推导解答。\n\n### 解答推导\n该问题要求根据报告的相对风险和已知的基线人群风险，计算患者患某种病症的绝对风险。\n\n设$P_{base}$表示在普通人群或平均风险人群中，在$10$年内患上X病症的基线概率。这被作为基线发病率给出。\n$$P_{base} = 0.05$$\n\n设$RR$为与患者基因档案相关的相对风险，如直达消费者（DTC）检测报告所示。\n$$RR = 1.5$$\n\n设$P_{abs}$为患者在相同$10$年内患上X病症的绝对概率。这是需要计算的量。\n\n问题陈述相对风险被定义为概率之比。形式上，它是暴露组（携带基因变异的患者）的绝对风险与非暴露组（普通人群）的基线风险之比。\n$$RR = \\frac{P_{abs}}{P_{base}}$$\n\n问题还明确假设相对风险乘以基线概率，这是对上述正式定义的直接重新排列。为了求出患者的绝对风险，我们解出$P_{abs}$：\n$$P_{abs} = RR \\times P_{base}$$\n\n将给定值代入方程：\n$$P_{abs} = 1.5 \\times 0.05$$\n\n进行乘法运算：\n$$P_{abs} = 0.075$$\n\n问题规定答案必须四舍五入至三位有效数字。计算出的值$0.075$有两位有效数字（数字$7$和$5$）。为了将此结果表示为三位有效数字，我们必须添加一个末尾的零，在这种情况下它是有效的。\n$$P_{abs} = 0.0750$$\n\n第二个任务是撰写一句通俗易懂的句子来沟通这一风险。这句话是所需推理的一部分，但不会包含在最终的方框答案中。$0.0750$的绝对风险对应于每$1000$人中有$75$人的自然频率。一个合适的句子是：“根据这项检测，每$1000$名基因档案与您相似的人中，我们预计大约有$75$人在未来$10$年内会患上X病症。”这将抽象的概率转换为非专业人士更容易理解的具体频率。", "answer": "$$\\boxed{0.0750}$$", "id": "5024286"}, {"introduction": "在解读基因筛查结果时，存在一个重要的统计陷阱，尤其是在筛查罕见疾病时。即使一个检测工具在技术上非常精确（即具有高灵敏度和特异性），其预测能力也可能因疾病的罕见性而大打折扣。这项练习将运用贝叶斯定理来计算阳性预测值（PPV），揭示为何一个“阳性”结果的实际意义可能远没有看上去那么确定，这对于培养批判性思维和避免常见误读至关重要。 [@problem_id:5024280]", "problem": "一份直接面向消费者 (DTC) 的单基因风险报告在普通成年人群中筛查与一种罕见的常染色体显性遗传病相关的单一致病性变异。该公司报告称，其经过临床金标准的独立验证，表明该检测对这种变异的分析灵敏度为 $0.95$，分析特异性为 $0.99$。在目标人群中，真实变异携带者的患病率为千分之一 ($1$ in $1000$)。请仅使用条件概率和贝叶斯定理的基本定义，计算阳性预测值 (PPV)，其定义为在DTC检测结果为阳性的条件下，个体确实携带该致病性变异的概率。使用以下定义：灵敏度 $=$ $P(\\text{test}+\\mid \\text{carrier})$，特异性 $=$ $P(\\text{test}-\\mid \\text{non\\mbox{-}carrier})$，患病率 $\\pi = P(\\text{carrier})$，以及PPV $=$ $P(\\text{carrier}\\mid \\text{test}+)$。请将您的最终PPV以小数形式（而非百分比）报告，并四舍五入到四位有效数字。", "solution": "本题要求计算一种针对特定致病性变异的直接面向消费者 (DTC) 基因检测的阳性预测值 (PPV)。解题过程将使用条件概率和贝叶斯定理的基本定义来推导。\n\n首先，我们使用标准概率符号来形式化给定的信息。设 $C$ 为个体是致病性变异的真实携带者的事件，设 $C^c$ 为其互补事件，即个体为非携带者。设 $T+$ 为检测结果为阳性的事件，设 $T-$ 为检测结果为阴性的事件。\n\n问题提供了以下数据：\n1.  人群中真实变异携带者的患病率：$\\pi = P(C) = \\frac{1}{1000} = 0.001$。\n2.  检测的分析灵敏度，即在个体是携带者的条件下，检测结果为阳性的概率：$P(T+ \\mid C) = 0.95$。这对应于真阳性率。\n3.  检测的分析特异性，即在个体是非携带者的条件下，检测结果为阴性的概率：$P(T- \\mid C^c) = 0.99$。这对应于真阴性率。\n\n目标是计算阳性预测值 (PPV)，其定义为在检测结果为阳性的条件下，个体是真实携带者的概率：$\\text{PPV} = P(C \\mid T+)$。\n\n根据贝叶斯定理，条件概率 $P(C \\mid T+)$ 可以表示为：\n$$\nP(C \\mid T+) = \\frac{P(T+ \\mid C) P(C)}{P(T+)}\n$$\n\n分子中的项是已知的：$P(T+ \\mid C) = 0.95$ 和 $P(C) = 0.001$。\n\n分母 $P(T+)$ 代表在给定人群中获得阳性检测结果的总概率。这可以使用全概率定律计算，该定律对携带者状态进行边缘化：\n$$\nP(T+) = P(T+ \\mid C) P(C) + P(T+ \\mid C^c) P(C^c)\n$$\n为了计算这个表达式，我们需要确定 $P(C^c)$ 和 $P(T+ \\mid C^c)$ 的值。\n\n个体为非携带者的概率 $P(C^c)$，是患病率的补集：\n$$\nP(C^c) = 1 - P(C) = 1 - 0.001 = 0.999\n$$\n\n在个体为非携带者的条件下，检测结果为阳性的概率 $P(T+ \\mid C^c)$，被称为假阳性率。它是特异性 $P(T- \\mid C^c)$ 的补集：\n$$\nP(T+ \\mid C^c) = 1 - P(T- \\mid C^c) = 1 - 0.99 = 0.01\n$$\n\n现在我们可以将这些值代回阳性检测总概率 $P(T+)$ 的公式中：\n$$\nP(T+) = (0.95)(0.001) + (0.01)(0.999)\n$$\n$$\nP(T+) = 0.00095 + 0.00999\n$$\n$$\nP(T+) = 0.01094\n$$\n这个值 $P(T+)$ 是人群中检测结果为阳性的总比例，其中包括真阳性和假阳性。\n\n最后，我们将所有计算出的和给定的值代入PPV的贝叶斯定理表达式中：\n$$\n\\text{PPV} = P(C \\mid T+) = \\frac{P(T+ \\mid C) P(C)}{P(T+)} = \\frac{(0.95)(0.001)}{0.01094}\n$$\n$$\n\\text{PPV} = \\frac{0.00095}{0.01094}\n$$\n执行除法运算得出PPV的数值：\n$$\n\\text{PPV} \\approx 0.08683729433...\n$$\n问题要求最终答案以小数形式报告，并四舍五入到四位有效数字。第一位有效数字是 $8$，后面是 $6$、$8$ 和 $3$。第五位有效数字是 $7$，它大于或等于 $5$，所以我们将第四位有效数字向上取整。\n$$\n\\text{PPV} \\approx 0.08684\n$$\n这个结果表明，即使分析灵敏度和特异性很高，当在普通人群中筛查一种罕见病时，阳性检测的预测值也可能相当低。", "answer": "$$\\boxed{0.08684}$$", "id": "5024280"}]}