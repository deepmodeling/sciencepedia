{"hands_on_practices": [{"introduction": "为了解决健康差异问题，我们首先需要精确地衡量它们。本练习介绍了一些基本的流行病学指标，用于量化不同人群在获取基因组医学服务方面存在的差距。掌握这些计算方法，将为您在研究和公共卫生领域识别和报告健康不平等问题提供一套基础工具。[@problem_id:5027556]", "problem": "在一项关于遗传性癌症基因胚系检测的社区实施研究中，研究人员评估了两个人口规模相等的、按收入定义的群体之间的可及性差异。设二元可及性指标为 $A \\in \\{0,1\\}$，其中 $A=1$ 表示个人在定义的观察窗口内获得了胚系检测。在高收入群体中观察到的接受概率为 $p_{H} = 0.70$，在低收入群体中为 $p_{L} = 0.30$。使用基于二元变量的概率和方差的定义，计算以下可及性差异的度量：\n- 绝对风险差（高收入群体和低收入群体之间的概率差）。\n- 相对风险（RR），即高收入群体与低收入群体的可及性概率之比。\n- 标准化均数差（SMD），用于比较两组间的 $A$。此处的标准化使用了适用于二元变量和相等组大小的合并标准差。\n\n将每个量四舍五入至四位有效数字。将每个结果报告为纯数字（无单位，无百分号），并按 $(\\text{绝对风险差}, \\text{RR}, \\text{SMD})$ 的顺序列出 $1 \\times 3$ 的行矩阵作为最终答案。", "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n**步骤1：提取已知条件**\n- 两个按收入定义的群体，人口规模相等。\n- 一个二元可及性指标 $A \\in \\{0, 1\\}$，其中 $A=1$ 表示获得了胚系检测。\n- 高收入群体的可及性概率为 $p_{H} = 0.70$。\n- 低收入群体的可及性概率为 $p_{L} = 0.30$。\n- 要求的输出是三种差异度量：\n    1. 绝对风险差（概率差）。\n    2. 相对风险（RR），即概率之比。\n    3. 标准化均数差（SMD），使用适用于二元变量和相等组大小的合并标准差。\n- 每个输出必须四舍五入到四位有效数字。\n- 最终答案必须是按 $(\\text{绝对风险差}, \\text{RR}, \\text{SMD})$ 顺序列出的 $1 \\times 3$ 行矩阵。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据充分**：该问题在一个现实的公共卫生研究背景下（基因组医学可及性差异），使用了流行病学和生物统计学中的标准、明确定义的概念（风险差、相对风险、标准化均数差）。该框架基于既定的统计学原理。\n- **问题定义良好**：所有必要的数据（$p_H$、$p_L$）和条件（相等的组大小）均已提供。待计算量的定义明确无歧义。问题结构清晰，可得出唯一、稳定的解。\n- **客观性**：问题陈述使用精确、定量且无偏见的语言表达。\n\n**步骤3：结论与行动**\n该问题具有科学依据、定义良好、客观且自成体系。因此，判定其为**有效**问题。将提供解答。\n\n该问题要求计算高收入群体（H）和低收入群体（L）在胚系检测可及性方面的三种不同差异度量。可及性是一个二元事件，因此变量 $A$ 在每个群体中都遵循伯努利分布。\n\n给定的概率为：\n$p_{H} = 0.70$ （高收入群体的可及性概率）\n$p_{L} = 0.30$ （低收入群体的可及性概率）\n\n1.  **绝对风险差 (ARD)**\n    绝对风险差是两个概率之间的简单算术差。\n    $$ARD = p_{H} - p_{L}$$\n    代入给定值：\n    $$ARD = 0.70 - 0.30 = 0.40$$\n    四舍五入到四位有效数字，得到 $0.4000$。\n\n2.  **相对风险 (RR)**\n    相对风险是暴露组（此处为高收入组）结果概率与非暴露组（低收入组）结果概率之比。\n    $$RR = \\frac{p_{H}}{p_{L}}$$\n    代入给定值：\n    $$RR = \\frac{0.70}{0.30} = \\frac{7}{3} \\approx 2.3333...$$\n    四舍五入到四位有效数字，得到 $2.333$。\n\n3.  **标准化均数差 (SMD)**\n    SMD，通常表示为 Cohen's $d$，是两组均值之差除以合并标准差。对于成功概率为 $p$ 的二元变量 $A$，其均值为 $\\mu = p$，方差为 $\\sigma^2 = p(1-p)$。\n    两组的均值为：\n    $\\mu_{H} = p_{H} = 0.70$\n    $\\mu_{L} = p_{L} = 0.30$\n    均值之差为 $\\mu_{H} - \\mu_{L} = p_{H} - p_{L} = 0.40$。\n\n    两组的方差为：\n    $\\sigma_{H}^2 = p_{H}(1 - p_{H}) = 0.70(1 - 0.70) = 0.70 \\times 0.30 = 0.21$\n    $\\sigma_{L}^2 = p_{L}(1 - p_{L}) = 0.30(1 - 0.30) = 0.30 \\times 0.70 = 0.21$\n\n    问题指定在组大小相等（$n_H = n_L$）的情况下使用合并标准差。合并方差的公式是各组方差的平均值：\n    $$\\sigma_{pooled}^2 = \\frac{\\sigma_{H}^2 + \\sigma_{L}^2}{2}$$\n    合并标准差是该值的平方根：\n    $$\\sigma_{pooled} = \\sqrt{\\frac{\\sigma_{H}^2 + \\sigma_{L}^2}{2}}$$\n    代入计算出的方差：\n    $$\\sigma_{pooled} = \\sqrt{\\frac{0.21 + 0.21}{2}} = \\sqrt{\\frac{0.42}{2}} = \\sqrt{0.21}$$\n    现在，我们计算 SMD：\n    $$SMD = \\frac{\\mu_{H} - \\mu_{L}}{\\sigma_{pooled}} = \\frac{p_{H} - p_{L}}{\\sigma_{pooled}}$$\n    代入数值：\n    $$SMD = \\frac{0.40}{\\sqrt{0.21}}$$\n    计算数值：\n    $$SMD \\approx \\frac{0.40}{0.458257569...} \\approx 0.87287156...$$\n    四舍五入到四位有效数字，得到 $0.8729$。\n\n所要求的三个度量，四舍五入到四位有效数字，分别是：\n- 绝对风险差 = $0.4000$\n- 相对风险 = $2.333$\n- 标准化均数差 = $0.8729$\n这些将以 $1 \\times 3$ 行矩阵的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.4000  2.333  0.8729 \\end{pmatrix}}$$", "id": "5027556"}, {"introduction": "基因组数据中的差异对临床实践具有深远的影响。本练习将展示由于“意义不明确的变异”（VUS）在不同人群中的患病率不同，基因检测的性能（如灵敏度和特异性）如何可能存在差异。通过应用贝叶斯定理，您将量化数据偏倚如何直接影响诊断的后验概率 $P(D \\mid +)$，从而揭示潜在的健康不平等问题。[@problem_id:5027562]", "problem": "一个临床基因组合（gene panel）被用来检测与单基因病相关的致病性变异。该组合会输出一个二元判断：“致病性变异阳性”，如果变异被实验室流程分类为致病性；否则为“致病性变异阴性”。由于在变异数据库中的代表性差异，来自代表性不足族裔的个体中，“意义不明确的变异”（Variant of Uncertain Significance, VUS）的出现率更高，这既影响了真实致病性变异被正确标记的概率，也影响了良性变异被错误标记的概率。假设以下是科学上已确立的基本定义和观察结果：\n\n- 灵敏度定义为 $P(+ \\mid D)$，即在患病情况下检测结果为阳性的概率。\n- 特异性定义为 $P(- \\mid \\neg D)$，即在未患病情况下检测结果为阴性的概率。\n- 检测前风险为 $P(D)$，即检测前的先验患病概率。\n- 全概率定律和贝叶斯定理将 $P(D \\mid +)$ 与 $P(+ \\mid D)$、$P(+ \\mid \\neg D)$ 和 $P(D)$ 联系起来。\n\n考虑两个族裔群体，他们表现出相同的临床特征和家族史，因此具有相同的检测前风险 $P(D) = 0.05$。然而，检测性能在不同群体中存在差异：\n\n- A 组（在数据库中代表性良好）：灵敏度 $0.94$，特异性 $0.99$。\n- B 组（在数据库中代表性不足，VUS 较多）：灵敏度 $0.85$，特异性 $0.97$。\n\n仅使用上述核心定义和第一性原理，计算当基因组合返回致病性变异阳性结果时，每个群体的后验患病概率 $P(D \\mid +)$。请按 A 组、B 组的顺序，以小数形式表示两个答案，并各保留四位有效数字。", "solution": "所述问题具有科学依据，提法严谨且客观。它基于概率论的基本原理，特别是贝叶斯定理，并应用于一个关于医学遗传学中诊断测试性能和健康差异的现实场景。所有必需的参数均已提供，目标也已明确定义。因此，该问题被认为是有效的，并将提供解答。\n\n目标是计算在检测结果为阳性的情况下，两个不同群体（A 组和 B 组）的后验患病概率，记为 $P(D \\mid +)$。我们已知检测前的患病概率 $P(D)$，以及检测对每个群体的灵敏度和特异性。设 $D$ 表示个体患病（即携带真正的致病性变异）的事件，$\\neg D$ 表示不患病的互补事件。设 $+$ 表示检测结果为阳性的事件，$-$ 表示检测结果为阴性的事件。\n\n此计算所需的核心关系是贝叶斯定理：\n$$ P(D \\mid +) = \\frac{P(+ \\mid D) P(D)}{P(+)} $$\n分子中的项 $P(+ \\mid D)$ 是检测的灵敏度，已为每个群体提供。项 $P(D)$ 是检测前的概率，或称患病率，也已给出。分母 $P(+)$ 是获得阳性检测结果的总概率。它可以使用全概率定律，通过对患病或不患病的互斥状态求和来计算：\n$$ P(+) = P(+ \\mid D) P(D) + P(+ \\mid \\neg D) P(\\neg D) $$\n我们已知特异性，即 $P(- \\mid \\neg D)$。项 $P(+ \\mid \\neg D)$ 代表假阳性率，即未患病个体检测结果为阳性的概率。由于对未患病个体的检测结果必须是阳性或阴性，我们有以下关系：\n$$ P(+ \\mid \\neg D) + P(- \\mid \\neg D) = 1 $$\n因此，假阳性率可以计算为：\n$$ P(+ \\mid \\neg D) = 1 - P(- \\mid \\neg D) = 1 - \\text{specificity} $$\n不患病的概率 $P(\\neg D)$ 简直就是：\n$$ P(\\neg D) = 1 - P(D) $$\n对于两个群体，检测前风险均给定为 $P(D) = 0.05$。因此，对于两个群体，$P(\\neg D) = 1 - 0.05 = 0.95$。\n\n我们现在将分别为每个群体计算后验概率。\n\n**对于 A 组（代表性良好）：**\n给定参数为：\n-   灵敏度：$P_A(+ \\mid D) = 0.94$\n-   特异性：$P_A(- \\mid \\neg D) = 0.99$\n-   检测前风险：$P(D) = 0.05$\n\n首先，我们计算 A 组的假阳性率：\n$$ P_A(+ \\mid \\neg D) = 1 - P_A(- \\mid \\neg D) = 1 - 0.99 = 0.01 $$\n接下来，我们计算阳性检测的总概率 $P_A(+)$：\n$$ P_A(+) = P_A(+ \\mid D) P(D) + P_A(+ \\mid \\neg D) P(\\neg D) $$\n$$ P_A(+) = (0.94)(0.05) + (0.01)(0.95) $$\n$$ P_A(+) = 0.047 + 0.0095 = 0.0565 $$\n现在，我们应用贝叶斯定理来找到后验概率 $P_A(D \\mid +)$：\n$$ P_A(D \\mid +) = \\frac{P_A(+ \\mid D) P(D)}{P_A(+)} = \\frac{(0.94)(0.05)}{0.0565} = \\frac{0.047}{0.0565} \\approx 0.8318584... $$\n保留四位有效数字，A 组个体的后验概率为 $0.8319$。\n\n**对于 B 组（代表性不足）：**\n给定参数为：\n-   灵敏度：$P_B(+ \\mid D) = 0.85$\n-   特异性：$P_B(- \\mid \\neg D) = 0.97$\n-   检测前风险：$P(D) = 0.05$\n\n首先，我们计算 B 组的假阳性率：\n$$ P_B(+ \\mid \\neg D) = 1 - P_B(- \\mid \\neg D) = 1 - 0.97 = 0.03 $$\n接下来，我们计算阳性检测的总概率 $P_B(+)$：\n$$ P_B(+) = P_B(+ \\mid D) P(D) + P_B(+ \\mid \\neg D) P(\\neg D) $$\n$$ P_B(+) = (0.85)(0.05) + (0.03)(0.95) $$\n$$ P_B(+) = 0.0425 + 0.0285 = 0.0710 $$\n现在，我们应用贝叶斯定理来找到后验概率 $P_B(D \\mid +)$：\n$$ P_B(D \\mid +) = \\frac{P_B(+ \\mid D) P(D)}{P_B(+)} = \\frac{(0.85)(0.05)}{0.0710} = \\frac{0.0425}{0.0710} \\approx 0.5985915... $$\n保留四位有效数字，B 组个体的后验概率为 $0.5986$。\n\n总而言之，对于 A 组，给定阳性检测结果的后验患病概率约为 $0.8319$；对于 B 组，约为 $0.5986$。这表明，尽管检测前风险相同，但对于代表性不足的群体，检测的灵敏度和特异性较低，导致对阳性结果的置信度显著降低，这凸显了由数据偏见驱动的严重健康不平等。", "answer": "$$ \\boxed{\\begin{pmatrix} 0.8319  0.5986 \\end{pmatrix}} $$", "id": "5027562"}, {"introduction": "建立公平的基因组资源（如生物样本库）需要我们有能力校正数据收集中固有的偏倚。这项动手实践将指导您使用逆概率加权法，这是一种强大的统计技术，可以从有偏倚的样本中生成无偏的群体水平估计值，例如等位基因频率。对于旨在得出能真实代表其所服务的不同人群的研究结果的科研人员来说，这项技能至关重要。[@problem_id:5027498]", "problem": "一个医院系统运营着一个生物样本库，并试图估计其服务区域人口中某个单核苷酸多态性（SNP）的次要等位基因频率，同时解决人口各分层间的公平可及性问题和参与偏倚。该人口根据自我认同的血统被划分为三个分层。由于准入障碍导致参与不平等，每个分层的生物样本库参与率不同。生物样本库拥有已注册参与者的基因型数据。目标是以一种相对于这些不平等参与率而言无偏的方式，估计总体人口的次要等位基因频率。\n\n仅使用核心定义和经过充分检验的原则：等位基因频率的定义为次要等位基因总数除以个体数量的两倍，以及来自不等概率抽样的原则，即可以使用逆包含概率构建无偏的总体总和。在这些基础之外，不要假定任何简化公式。\n\n数据：\n- 按分层的人口规模：\n  - 分层 1：$N_{1} = 120000$\n  - 分层 2：$N_{2} = 80000$\n  - 分层 3：$N_{3} = 100000$\n- 按分层的生物样本库参与者：\n  - 分层 1：$n_{1} = 3000$\n  - 分层 2：$n_{2} = 800$\n  - 分层 3：$n_{3} = 1200$\n- 在生物样本库参与者中，按分层的SNP（次要等位基因 $a$）基因型计数：\n  - 分层 1：$\\text{AA} = 2100$，$\\text{Aa} = 780$，$\\text{aa} = 120$\n  - 分层 2：$\\text{AA} = 480$，$\\text{Aa} = 280$，$\\text{aa} = 40$\n  - 分层 3：$\\text{AA} = 780$，$\\text{Aa} = 360$，$\\text{aa} = 60$\n\n任务：\n1. 根据提供的数据计算每个分层的参与率（每个人的参与概率）。\n2. 从基本原理出发，利用基于等位基因频率核心定义和总体总和无偏估计的逆概率加权法，推导在不等参与概率下该SNP的总体人口次要等位基因频率的无偏估计量。\n3. 使用提供的数据计算无偏的总体人口次要等位基因频率的最终数值估计。\n\n将最终的次要等位基因频率表示为小数。将最终答案四舍五入到四位有效数字。", "solution": "该问题要求根据分层的生物样本库数据估计总体人口的次要等位基因频率（MAF），其中各分层的参与率不同。解决方案必须从基本原理推导得出，具体而言，使用等位基因频率的定义和逆概率加权来纠正参与偏倚。\n\n首先，我将验证问题陈述。\n\n### 第1步：提取已知条件\n问题提供了以下数据：\n- 按分层的人口规模：\n  - 分层 1：$N_{1} = 120000$\n  - 分层 2：$N_{2} = 80000$\n  - 分层 3：$N_{3} = 100000$\n- 按分层的生物样本库参与者（样本量）：\n  - 分层 1：$n_{1} = 3000$\n  - 分层 2：$n_{2} = 800$\n  - 分层 3：$n_{3} = 1200$\n- 参与者中次要等位基因 '$a$' 的基因型计数：\n  - 分层 1：count(AA) = $2100$，count(Aa) = $780$，count(aa) = $120$\n  - 分层 2：count(AA) = $480$，count(Aa) = $280$，count(aa) = $40$\n  - 分层 3：count(AA) = $780$，count(Aa) = $360$，count(aa) = $60$\n\n### 第2步：使用提取的已知条件进行验证\n问题提法得当且具有科学依据。\n- **科学依据**：次要等位基因频率、分层抽样和逆概率加权（Horvitz-Thompson估计）等概念是群体遗传学和统计学中的标准概念。生物样本库中存在参与偏倚的情景反映了基因组医学研究中的现实挑战。\n- **提法得当**：计算所需的所有数据均已提供。每个分层中的基因型计数之和等于相应的样本量：\n  - 分层 1：$2100 + 780 + 120 = 3000 = n_1$\n  - 分层 2：$480 + 280 + 40 = 800 = n_2$\n  - 分层 3：$780 + 360 + 60 = 1200 = n_3$\n  数据内部一致。任务定义清晰，并能导出一个唯一解。\n- **客观性**：问题以精确、客观的语言陈述，不含主观因素。\n- **不切实际/不可行性检查**：对于一个大型医院系统来说，人口和样本规模是现实的。等位基因频率在合理范围内。\n\n### 第3步：结论与行动\n问题是有效的。我现在将继续进行求解。\n\n### 解答推导与计算\n\n总体人口的次要等位基因频率 $p$ 定义为整个群体中次要等位基因的总数除以可用的等位基因位点总数（即总人口规模的两倍）。设 $N_{\\text{total}}$ 为总人口规模，$C_{a, \\text{total}}$ 为该群体中次要等位基因 '$a$' 的总数。\n$$p = \\frac{C_{a, \\text{total}}}{2 N_{\\text{total}}}$$\n总人口规模是已知的：$N_{\\text{total}} = N_1 + N_2 + N_3$。主要任务是找到 $C_{a, \\text{total}}$ 的一个无偏估计量。\n\n总体人口的等位基因总数是各分层计数之和：$C_{a, \\text{total}} = \\sum_{i=1}^3 C_{a,i}$，其中 $C_{a,i}$ 是分层 $i$ 的整个群体中等位基因 '$a$' 的真实（未知）计数。\n\n#### 任务1：计算参与率\n分层 $i$ 中个体的参与率（记为 $\\pi_i$）是指被纳入生物样本库样本的概率。假设在每个分层内进行简单随机抽样，该率是该分层的样本量与人口规模之比。\n- 分层 1：$\\pi_1 = \\frac{n_1}{N_1} = \\frac{3000}{120000} = \\frac{1}{40} = 0.025$\n- 分层 2：$\\pi_2 = \\frac{n_2}{N_2} = \\frac{800}{80000} = \\frac{1}{100} = 0.01$\n- 分层 3：$\\pi_3 = \\frac{n_3}{N_3} = \\frac{1200}{100000} = \\frac{12}{1000} = 0.012$\n各分层的参与率不相等，这证实了进行调整的必要性。\n\n#### 任务2：推导无偏估计量\n为了估计群体中的次要等位基因总数 $C_{a, \\text{total}}$，我们首先估计每个分层的总数 $C_{a,i}$，然后将这些估计值相加。逆概率加权（如Horvitz-Thompson估计量中所使用的）原则指出，可以通过对样本中的值求和来获得总体总和的无偏估计，其中每个抽样单位都按其包含概率的倒数进行加权。\n\n设 $c_{a,i}$ 是从分层 $i$ 的样本中观察到的次要等位基因 '$a$' 的计数。分层 $i$ 样本中的个体是该分层群体 $N_i$ 个个体的一个子集。量 $c_{a,i}$ 是样本中 $n_i$ 个个体上次要等位基因的总和。为了估计整个分层 $i$ 的次要等位基因总数 $C_{a,i}$，我们用抽样率的倒数 $1/\\pi_i$ 来按比例放大样本计数 $c_{a,i}$。\n分层 $i$ 中次要等位基因总数的无偏估计量是：\n$$\\hat{C}_{a,i} = \\frac{1}{\\pi_i} c_{a,i} = \\frac{1}{n_i / N_i} c_{a,i} = N_i \\frac{c_{a,i}}{n_i}$$\n该估计量有效地计算了样本中每个个体的平均次要等位基因数（$\\frac{c_{a,i}}{n_i}$），并将其外推到整个分层的人口规模 $N_i$。\n\n整个群体中次要等位基因总数的无偏估计量 $\\hat{C}_{a, \\text{total}}$ 是各分层特定估计值的总和：\n$$\\hat{C}_{a, \\text{total}} = \\sum_{i=1}^{3} \\hat{C}_{a,i} = \\sum_{i=1}^{3} N_i \\frac{c_{a,i}}{n_i}$$\n最后，通过将 $\\hat{C}_{a, \\text{total}}$ 代入 $p$ 的定义，得到总体人口次要等位基因频率的无偏估计量 $\\hat{p}$：\n$$\\hat{p} = \\frac{\\hat{C}_{a, \\text{total}}}{2 N_{\\text{total}}} = \\frac{\\sum_{i=1}^{3} N_i \\frac{c_{a,i}}{n_i}}{2 \\sum_{i=1}^{3} N_i}$$\n这就是所要求推导的估计量。\n\n#### 任务3：计算数值估计\n首先，我们根据每个样本分层的基因型数据计算观察到的次要等位基因计数 $c_{a,i}$。每个杂合子(Aa)计数为1，每个次要等位基因纯合子(aa)计数为2。\n- 分层 1：$c_{a,1} = (1 \\times 780) + (2 \\times 120) = 780 + 240 = 1020$\n- 分层 2：$c_{a,2} = (1 \\times 280) + (2 \\times 40) = 280 + 80 = 360$\n- 分层 3：$c_{a,3} = (1 \\times 360) + (2 \\times 60) = 360 + 120 = 480$\n\n接下来，我们计算总人口规模：\n$$N_{\\text{total}} = N_1 + N_2 + N_3 = 120000 + 80000 + 100000 = 300000$$\n群体中的等位基因位点总数为 $2 N_{\\text{total}} = 600000$。\n\n现在，我们计算估计的次要等位基因总数 $\\hat{C}_{a, \\text{total}}$：\n\\begin{align*} \\hat{C}_{a, \\text{total}} = \\sum_{i=1}^{3} N_i \\frac{c_{a,i}}{n_i} \\\\ = N_1 \\frac{c_{a,1}}{n_1} + N_2 \\frac{c_{a,2}}{n_2} + N_3 \\frac{c_{a,3}}{n_3} \\\\ = 120000 \\times \\frac{1020}{3000} + 80000 \\times \\frac{360}{800} + 100000 \\times \\frac{480}{1200} \\\\ = 40 \\times 1020 + 100 \\times 360 + \\frac{1000}{12} \\times 480 \\\\ = 40800 + 36000 + 40000 \\\\ = 116800 \\end{align*}\n这是整个服务区域人口中次要等位基因总数的无偏估计。\n\n最后，我们计算估计的人口次要等位基因频率 $\\hat{p}$：\n$$\\hat{p} = \\frac{\\hat{C}_{a, \\text{total}}}{2 N_{\\text{total}}} = \\frac{116800}{2 \\times 300000} = \\frac{116800}{600000} = \\frac{1168}{6000} = \\frac{73}{375}$$\n作为小数，其值为：\n$$\\hat{p} = 0.194666...$$\n四舍五入到四位有效数字，最终估计值为 $0.1947$。", "answer": "$$\\boxed{0.1947}$$", "id": "5027498"}]}