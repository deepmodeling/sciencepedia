{"hands_on_practices": [{"introduction": "要理解遗传性癌症综合征的公共卫生影响，我们首先需要估算致病等位基因在人群中的普遍程度。哈代-温伯格平衡（Hardy-Weinberg equilibrium）是群体遗传学的基石，它提供了一个强大的理论框架，让我们能够基于等位基因频率估算出携带者的频率。这项练习 [@problem_id:5045356] 将指导您从基本原理出发，应用该定律来计算一个隐性遗传癌症易感基因在人群中的携带者频率，这是理解遗传病负担的第一步。", "problem": "在遗传性癌症综合征的背景下，考虑一个常染色体基因座，其上有两个等位基因：一个野生型等位基因 $A$ 和一个致病性等位基因 $a$。等位基因 $a$ 仅在纯合状态 $aa$ 下导致癌症易感性增加（例如，在MUTYH相关性息肉病中，双等位基因携带者所见的隐性易感性）。假设有一个大的、随机交配的种群，在繁殖前，$AA$ 或 $Aa$ 相对于彼此没有选择压力，没有迁移，新突变可忽略不计，因此哈代-温伯格平衡（HWE）成立。致病性等位基因的种群频率为 $q = 0.005$。设 $p$ 表示野生型等位基因 $A$ 的频率。\n\n仅使用二倍体种群中等位基因频率的核心定义、$p + q = 1$ 定律以及随机交配下基因型形成的哈代-温伯格平衡（HWE）原理，从第一性原理推导出杂合子携带者 $Aa$ 个体的预期比例，并计算当 $q = 0.005$ 时的数值。将最终结果表示为小数，并四舍五入至四位有效数字。", "solution": "该问题是有效的，因为它科学地基于群体遗传学原理，特别是哈代-温伯格平衡（HWE），并且问题提法得当，提供了所有必要的信息。\n\n该问题要求从第一性原理出发，在一个处于HWE的种群中推导杂合子携带者（$Aa$）的预期比例，然后进行数值计算。\n\n设 $p$ 为种群基因库中野生型等位基因 $A$ 的频率，$q$ 为致病性等位基因 $a$ 的频率。问题陈述在该常染色体基因座上只有两个等位基因。因此，它们的频率之和必须等于 $1$。\n$$p + q = 1$$\n问题指定该种群是大的且进行随机交配。在这些条件下，下一代基因型的频率可以被预测。一个二倍体合子的形成涉及两个配子的随机结合，每个配子分别来自双亲之一。在一个随机交配的种群中，这等同于从基因库中独立抽取两个等位基因。\n\n抽取到等位基因 $A$ 的概率是 $p$。\n抽取到等位基因 $a$ 的概率是 $q$。\n\n我们可以按如下方式推导三种可能基因型（$AA$、$Aa$ 和 $aa$）的预期频率：\n\n1.  纯合野生型基因型 $AA$ 的频率，是个体从母亲处遗传一个 $A$ 等位基因且从父亲处遗传一个 $A$ 等位基因的概率。假设独立性，此概率为：\n    $$\\text{Freq}(AA) = p \\times p = p^2$$\n2.  纯合致病性基因型 $aa$ 的频率，是个体从母亲处遗传一个 $a$ 等位基因且从父亲处遗传一个 $a$ 等位基因的概率。此概率为：\n    $$\\text{Freq}(aa) = q \\times q = q^2$$\n3.  杂合子基因型 $Aa$ 可以通过两种互斥的方式形成：\n    -   从母亲处遗传等位基因 $A$，从父亲处遗传等位基因 $a$。此事件的概率为 $p \\times q$。\n    -   从母亲处遗传等位基因 $a$，从父亲处遗传等位基因 $A$。此事件的概率为 $q \\times p$。\n    杂合子携带者的总预期频率是这两个事件概率的总和：\n    $$\\text{Freq}(Aa) = (p \\times q) + (q \\times p) = 2pq$$\n\n这个从第一性原理的推导表明，杂合子携带者个体的预期比例由项 $2pq$ 给出。基因型频率的总和必须等于 $1$，这与我们的推导一致：\n$$p^2 + 2pq + q^2 = (p+q)^2 = 1^2 = 1$$\n\n现在，我们可以计算数值。给定致病性等位基因 $a$ 的频率为：\n$$q = 0.005$$\n使用关系式 $p + q = 1$，我们可以求出野生型等位基因 $A$ 的频率：\n$$p = 1 - q = 1 - 0.005 = 0.995$$\n使用推导出的公式 $2pq$ 计算杂合子携带者（$Aa$）的预期比例：\n$$\\text{Freq}(Aa) = 2pq = 2 \\times 0.995 \\times 0.005$$\n进行乘法运算：\n$$2 \\times 0.995 \\times 0.005 = 1.99 \\times 0.005 = 0.00995$$\n问题要求最终结果表示为小数，并四舍五入到四位有效数字。计算出的值 $0.00995$ 有三位有效数字（数字 $9, 9, 5$）。要用四位有效数字表示，我们必须在末尾加一个零。\n$$0.009950$$\n因此，该种群中杂合子携带者的预期比例是 $0.009950$。", "answer": "$$\\boxed{0.009950}$$", "id": "5045356"}, {"introduction": "从群体转向个体，基因检测是诊断遗传性癌症综合征的核心工具。然而，解读检测结果需要严谨的概率思维，因为检测本身存在灵敏度（sensitivity）和特异性（specificity）的限制。本练习 [@problem_id:5045261] 运用贝叶斯定理（Bayes' theorem），演示了如何根据一个阳性检测结果来更新患者携带致病变异的概率（即后验概率），这项技能对于将实验室数据转化为有临床意义的风险评估至关重要。", "problem": "一名正在接受乳腺癌1号基因（BRCA1）致病性变异种系检测的患者，其携带致病性变异的检验前概率或先验概率 $ \\pi $ 等于 $ 0.10 $。所使用的临床检测的灵敏度 $ s = 0.95 $，特异度 $ c = 0.99 $。检测返回阳性结果。从条件概率和全概率定律的公理化定义出发，并使用标准的临床定义，即灵敏度是在真正携带变异的情况下得到阳性结果的概率，特异度是在真正不携带变异的情况下得到阴性结果的概率，推导出一个表达式，用于计算在观察到阳性结果后，患者携带BRCA1致病性变异的后验概率。然后，使用给定的 $ \\pi $、$ s $ 和 $ c $ 对该表达式进行数值计算。最终答案以小数形式表示，并四舍五入到四位有效数字。", "solution": "该问题陈述有效。它在科学上基于概率论原理及其在医学诊断中的应用，这是医学遗传学的核心课题。该问题提法明确，提供了计算唯一后验概率所需的所有数据——先验概率、灵敏度和特异度。定义和数值在临床遗传学背景下是标准且符合实际的。语言客观而精确。因此，我们可以着手求解。\n\n我们的目标是推导出一个表达式，用于计算在给定阳性检测结果的情况下，患者携带致病性变异的后验概率，然后对该表达式进行数值评估。我们将首先正式定义事件，并将给定信息转化为概率论的语言。\n\n设 `$V$` 为患者携带 `$BRCA1$` 基因致病性变异的事件。\n设 `$V^c$` 为患者不携带此类变异的互补事件。\n设 `$T^+$` 为临床检测返回阳性结果的事件。\n设 `$T^-$` 为检测返回阴性结果的事件。\n\n问题提供了以下信息：\n1.  携带变异的检验前概率或先验概率：`$P(V) = \\pi = 0.10$`。\n2.  检测的灵敏度，定义为在患者携带变异的情况下得到阳性结果的概率：`$P(T^+ | V) = s = 0.95$`。这是真阳性率。\n3.  检测的特异度，定义为在患者不携带变异的情况下得到阴性结果的概率：`$P(T^- | V^c) = c = 0.99$`。这是真阴性率。\n\n根据这些给定信息，我们可以推断出另外两个概率：\n- 不携带变异的先验概率是 `$P(V^c) = 1 - P(V) = 1 - \\pi = 1 - 0.10 = 0.90$`。\n- 在患者不携带变异的情况下得到阳性结果的概率（假阳性率）是 `$P(T^+ | V^c) = 1 - P(T^- | V^c) = 1 - c = 1 - 0.99 = 0.01$`。\n\n我们的目标是计算后验概率 `$P(V | T^+)$`，即在检测结果为阳性的情况下，携带变异的概率。\n\n根据问题的指示，我们从条件概率的公理化定义开始：\n$$P(A|B) = \\frac{P(A \\cap B)}{P(B)}$$\n将此定义应用于我们的特定事件，我们得到：\n$$P(V | T^+) = \\frac{P(V \\cap T^+)}{P(T^+)}$$\n分子 `$P(V \\cap T^+)$` 是携带变异且检测结果为阳性的联合概率。我们可以再次使用条件概率的定义来重新表示这一项：`$P(T^+ | V) = \\frac{P(V \\cap T^+)}{P(V)}$`，整理后得到 `$P(V \\cap T^+) = P(T^+ | V) P(V)$`。代入我们的符号，分子为 `$s\\pi$`。\n\n分母 `$P(T^+)$` 是获得阳性检测结果的总概率。问题要求我们使用全概率定律。阳性结果可以通过两种互斥的路径发生：\n1.  患者携带变异且检测呈阳性（真阳性）。其概率为 `$P(T^+ \\cap V) = P(T^+ | V) P(V) = s\\pi$`。\n2.  患者不携带变异但检测呈阳性（假阳性）。其概率为 `$P(T^+ \\cap V^c) = P(T^+ | V^c) P(V^c) = (1-c)(1-\\pi)$`。\n\n根据全概率定律，阳性检测的总概率 `$P(T^+)$` 是这两条路径概率的总和：\n$$P(T^+) = P(T^+ | V) P(V) + P(T^+ | V^c) P(V^c)$$\n代入我们的符号表示：\n$$P(T^+) = s\\pi + (1 - c)(1 - \\pi)$$\n现在，我们结合分子和分母的表达式，得到后验概率的最终推导表达式，这是贝叶斯定理的一种形式：\n$$P(V | T^+) = \\frac{P(T^+ | V) P(V)}{P(T^+ | V) P(V) + P(T^+ | V^c) P(V^c)} = \\frac{s\\pi}{s\\pi + (1 - c)(1 - \\pi)}$$\n这就完成了通用表达式的推导。\n\n接下来，我们使用给定的数值 `$\\pi = 0.10$`、`$s = 0.95$` 和 `$c = 0.99$` 对此表达式进行数值计算。\n\n首先，计算分子的值：\n$$s\\pi = (0.95)(0.10) = 0.095$$\n接下来，计算分母的值：\n$$s\\pi + (1 - c)(1 - \\pi) = (0.95)(0.10) + (1 - 0.99)(1 - 0.10)$$\n$$= 0.095 + (0.01)(0.90)$$\n$$= 0.095 + 0.009$$\n$$= 0.104$$\n最后，通过将分子除以分母来计算后验概率：\n$$P(V | T^+) = \\frac{0.095}{0.104} \\approx 0.913461538...$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 `$9$`、`$1$`、`$3$` 和 `$4$`。第五位有效数字是 `$6$`，由于 `$\\ge 5$`，所以我们将第四位数字向上取整。\n$$P(V | T^+) \\approx 0.9135$$\n因此，在得到阳性检测结果后，患者携带 `$BRCA1$` 致病性变异的概率从 `$10\\%$` 的先验概率增加到约 `$91.35\\%$` 的后验概率。", "answer": "$$\\boxed{0.9135}$$", "id": "5045261"}, {"introduction": "对于一位已确诊的致病变异携带者，最关键的问题是：“我未来的患癌风险有多大？”以及“我能做些什么来降低风险？”。本练习 [@problem_id:5045365] 引入了生存分析中的风险函数（hazard function）概念，以量化风险如何随年龄动态变化，并模拟了降低风险的手术（如预防性输卵管卵巢切除术）对未来患癌风险的实际影响。通过这项实践，您将学会如何运用数学模型来评估临床干预措施的有效性，从而为个体化医疗决策提供数据支持。", "problem": "由乳腺癌1号基因（Breast Cancer 1, BRCA1）的致病性变异引起的遗传性乳腺癌和卵巢癌综合征，与升高的、依年龄而定的乳腺癌风险相关。对于一名在 $40$ 岁时未发生事件的 BRCA1 携带者，考虑其在 $40$ 至 $80$ 岁年龄段（$t \\in [40,80]$）的特定年龄乳腺癌风险函数 $h(t)$（单位：每年），该函数由一个科学上合理的分段形式给出：\n- 当 $40 \\leq t  50$ 时：$h(t) = 0.025 + 0.002\\,(t - 40)$。\n- 当 $50 \\leq t \\leq 80$ 时：$h(t) = 0.045\\,\\exp\\!\\big(-0.05\\,(t - 50)\\big)$。\n\n假设：\n- 风险函数 $h(t)$ 指的是在年龄 $t$ 时未发生事件的条件下，发生首次乳腺癌事件的瞬时率。\n- 不存在竞争风险，并且在 $40$ 岁之前没有乳腺癌病史。\n- 事件最多发生一次。\n\n作为一项降低风险的干预措施，考虑在 $45$ 岁时进行风险降低性输卵管卵巢切除术 (RRSO)，该手术使得对于所有 $t \\geq 45$ 的年龄，乳腺癌风险率通过一个因子 $\\rho = 0.6$ 产生恒定的乘法性降低（即，RRSO 术后的风险率为 $\\rho\\,h(t)$，适用于 $t \\geq 45$；RRSO 术前的风险率对于 $40 \\leq t  45$ 保持为 $h(t)$）。\n\n使用事件发生时间分析中风险函数和生存函数的基本定义，推导该 BRCA1 携带者在 $40$ 岁至 $80$ 岁之间发生乳腺癌的条件剩余终生风险：\n1. 不进行 RRSO。\n2. 按规定在 $45$ 岁时进行 RRSO。\n\n以小数形式报告两个答案。将您的答案四舍五入到四位有效数字。最终的数值答案不需要单位。", "solution": "该问题要求计算一名 BRCA1 携带者在 $40$ 岁至 $80$ 岁之间发生乳腺癌的累积风险，考虑两种情景：不进行和进行降低风险的干预措施。问题的核心在于应用生存分析原理，特别是风险函数 $h(t)$、累积风险函数 $H(t_1, t_2)$、条件生存函数 $S(t_2 | t_1)$ 以及风险 $R(t_2 | t_1)$ 之间的关系。\n\n基本定义如下：\n- 从时间 $t_1$ 到 $t_2$ 的累积风险函数是风险函数 $h(t)$ 在此区间上的积分：\n$$H(t_1, t_2) = \\int_{t_1}^{t_2} h(u) \\, du$$\n- 条件生存概率，即在时间 $t_1$ 时未发生事件的条件下，到时间 $t_2$ 仍然未发生事件的概率，与累积风险的关系如下：\n$$S(t_2 | t_1) = \\exp\\left( -H(t_1, t_2) \\right)$$\n- 在时间 $t_1$ 时未发生事件的条件下，在 $t_1$ 和 $t_2$ 之间发生事件的条件风险是生存概率的补集：\n$$R(t_1, t_2) = 1 - S(t_2 | t_1) = 1 - \\exp\\left( -H(t_1, t_2) \\right)$$\n\n问题为一名女性在年龄 $t=40$ 到 $t=80$ 期间指定了一个分段风险函数 $h(t)$：\n- 当 $40 \\leq t  50$ 时：$h(t) = 0.025 + 0.002(t - 40)$\n- 当 $50 \\leq t \\leq 80$ 时：$h(t) = 0.045\\exp(-0.05(t - 50))$\n\n我们现在将为这两种情况分别计算所需的风险。\n\n**1. 不进行 RRSO 的风险**\n\n我们需要计算在 $40$ 岁至 $80$ 岁之间发生乳腺癌的风险，即 $R(40, 80)$。这需要计算累积风险 $H(40, 80)$。由于 $h(t)$ 的分段性质，积分必须在 $t=50$ 处分开。\n\n$$H(40, 80) = \\int_{40}^{80} h(t) \\, dt = \\int_{40}^{50} h(t) \\, dt + \\int_{50}^{80} h(t) \\, dt$$\n\n让我们分别计算每个积分。\n\n第一个积分（从 $t=40$ 到 $t=50$）：\n$$H_1 = \\int_{40}^{50} [0.025 + 0.002(t - 40)] \\, dt$$\n令 $u = t - 40$，则 $du = dt$。当 $t=40$ 时，$u=0$。当 $t=50$ 时，$u=10$。\n$$H_1 = \\int_{0}^{10} (0.025 + 0.002u) \\, du = \\left[ 0.025u + 0.001u^2 \\right]_{0}^{10}$$\n$$H_1 = (0.025 \\times 10 + 0.001 \\times 10^2) - 0 = 0.25 + 0.1 = 0.35$$\n\n第二个积分（从 $t=50$ 到 $t=80$）：\n$$H_2 = \\int_{50}^{80} 0.045\\exp(-0.05(t - 50)) \\, dt$$\n令 $v = -0.05(t - 50)$，则 $dv = -0.05 \\, dt$，即 $dt = -20 \\, dv$。当 $t=50$ 时，$v=0$。当 $t=80$ 时，$v = -0.05(30) = -1.5$。\n$$H_2 = \\int_{0}^{-1.5} 0.045 \\exp(v) (-20 \\, dv) = -0.9 \\int_{0}^{-1.5} \\exp(v) \\, dv$$\n$$H_2 = -0.9 [\\exp(v)]_{0}^{-1.5} = -0.9 (\\exp(-1.5) - \\exp(0)) = 0.9(1 - \\exp(-1.5))$$\n\n总累积风险为 $H(40, 80) = H_1 + H_2 = 0.35 + 0.9(1 - \\exp(-1.5))$。\n那么风险为：\n$$R_{\\text{no RRSO}} = 1 - \\exp(-H(40, 80)) = 1 - \\exp\\left( -[0.35 + 0.9(1 - \\exp(-1.5))] \\right)$$\n数值计算如下：\n$$H(40, 80) \\approx 0.35 + 0.9(1 - 0.22313) = 0.35 + 0.9(0.77687) = 0.35 + 0.699183 = 1.049183$$\n$$R_{\\text{no RRSO}} = 1 - \\exp(-1.049183) \\approx 1 - 0.350224 = 0.649776$$\n四舍五入到四位有效数字，风险为 $0.6498$。\n\n**2. 在 45 岁时进行 RRSO 的风险**\n\n在年龄 $t=45$ 时的干预措施对所有 $t \\ge 45$ 的风险函数引入了一个乘法性降低因子 $\\rho = 0.6$。新的风险函数 $h^*(t)$ 为：\n- 当 $40 \\leq t  45$ 时：$h^*(t) = h(t) = 0.025 + 0.002(t - 40)$\n- 当 $45 \\leq t \\leq 80$ 时：$h^*(t) = \\rho \\cdot h(t) = 0.6 \\cdot h(t)$\n\n由于在 $t=45$ 处的变化以及在 $t=50$ 处基线风险的变化，累积风险 $H^*(40, 80)$ 现在需要分三个区间计算：\n$$H^*(40, 80) = \\int_{40}^{45} h(t) \\, dt + \\int_{45}^{80} \\rho \\cdot h(t) \\, dt$$\n$$H^*(40, 80) = \\int_{40}^{45} h(t) \\, dt + \\rho \\left( \\int_{45}^{50} h(t) \\, dt + \\int_{50}^{80} h(t) \\, dt \\right)$$\n\n让我们为新的划分计算积分。从 $50$ 到 $80$ 的积分与之前的 $H_2$ 相同。我们需要将原来的 $H_1$ 分成两部分。\n\n从 $t=40$ 到 $t=45$ 的积分：\n$$H^*_{1a} = \\int_{40}^{45} [0.025 + 0.002(t-40)] \\, dt = \\left[ 0.025(t-40) + 0.001(t-40)^2 \\right]_{40}^{45}$$\n$$H^*_{1a} = (0.025 \\times 5 + 0.001 \\times 5^2) - 0 = 0.125 + 0.025 = 0.15$$\n\n从 $t=45$ 到 $t=50$ 的积分：\n这可以计算为 $H_1 - H^*_{1a}$。\n$$H^*_{1b} = \\int_{45}^{50} [0.025 + 0.002(t-40)] \\, dt = H_1 - H^*_{1a} = 0.35 - 0.15 = 0.20$$\n\n现在，我们组合计算总累积风险 $H^*(40, 80)$：\n$$H^*(40, 80) = H^*_{1a} + \\rho(H^*_{1b} + H_2)$$\n$$H^*(40, 80) = 0.15 + 0.6 \\left( 0.20 + 0.9(1 - \\exp(-1.5)) \\right)$$\n\n数值计算如下：\n$$H^*(40, 80) \\approx 0.15 + 0.6 (0.20 + 0.699183) = 0.15 + 0.6 (0.899183) = 0.15 + 0.539510 = 0.689510$$\n\n进行 RRSO 的风险是：\n$$R_{\\text{RRSO}} = 1 - \\exp(-H^*(40, 80)) \\approx 1 - \\exp(-0.689510)$$\n$$R_{\\text{RRSO}} \\approx 1 - 0.501815 = 0.498185$$\n四舍五入到四位有效数字，风险为 $0.4982$。\n\n两个结果是：\n1. 不进行 RRSO 的风险：$0.6498$\n2. 在 45 岁时进行 RRSO 的风险：$0.4982$", "answer": "$$\\boxed{\\begin{pmatrix} 0.6498  0.4982 \\end{pmatrix}}$$", "id": "5045365"}]}