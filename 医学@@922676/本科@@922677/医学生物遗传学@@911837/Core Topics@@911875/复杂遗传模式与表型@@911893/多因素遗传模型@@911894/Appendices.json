{"hands_on_practices": [{"introduction": "多基因遗传模型的核心思想是，复杂性状是众多基因微小效应累积的结果。本练习将问题分解至最基本的单元——单个基因座，旨在通过第一性原理推导出它对群体性状均值和方差的贡献。这个基础性的推导是理解所有定量遗传学模型的基石。", "problem": "在医学遗传学中，考虑一个多基因性状，其表型值被建模为许多基因座上加性贡献的总和。我们关注一个单一的双等位基因座，其效应等位基因的群体频率为 $p \\in (0,1)$。假设基因型以加性方式编码为 $x \\in \\{0,1,2\\}$，其中 $x$ 表示个体携带的效应等位基因的拷贝数。假设群体处于哈代-温伯格平衡（HWE）状态，该基因座不存在显性或上位性，并且该基因座对性状的加性贡献为 $a x$，其中 $a \\in \\mathbb{R}$ 是单个等位基因对性状的加性效应。\n\n从离散随机变量的概率、期望和方差的基本定义出发，并以哈代-温伯格原理作为群体遗传学基础，推导该基因座对群体性状均值和方差贡献的闭合式表达式（以 $p$ 和 $a$ 表示）。将您的最终结果表示为一个双元素行矩阵 $\\left(\\mu_{\\text{locus}}, \\sigma_{\\text{locus}}^{2}\\right)$，其中 $\\mu_{\\text{locus}}$ 是均值贡献，$\\sigma_{\\text{locus}}^{2}$ 是方差贡献。无需进行四舍五入。", "solution": "问题陈述已经过验证，被认为是合理的。这是一个数量遗传学中的标准、适定问题，具有科学依据和客观性，并包含得出唯一解所需的所有必要信息。我们可以开始推导。\n\n该问题要求计算单个双等位基因座对多基因性状的群体均值和方差的贡献。设此基因座上的两个等位基因为“效应”等位基因（表示为 $A_1$），其群体频率为 $p$，以及“非效应”等位基因 $A_2$，其频率为 $q = 1-p$。基因型由随机变量 $X$ 表示，它计算个体携带的效应等位基因的数量。因此，$X$ 可以在集合 $\\{0, 1, 2\\}$ 中取值。\n\n假设群体处于哈代-温伯格平衡（HWE）状态。在HWE下，三种可能的基因型（$A_2A_2$、$A_1A_2$、$A_1A_1$）的频率由二项式展开 $(p+q)^2 = p^2 + 2pq + q^2$ 的各项给出。这些频率可以解释为随机变量 $X$ 的概率：\n-   拥有 $0$ 个效应等位基因（基因型 $A_2A_2$）的概率为 $P(X=0) = q^2 = (1-p)^2$。\n-   拥有 $1$ 个效应等位基因（基因型 $A_1A_2$）的概率为 $P(X=1) = 2pq = 2p(1-p)$。\n-   拥有 $2$ 个效应等位基因（基因型 $A_1A_1$）的概率为 $P(X=2) = p^2$。\n\n我们可以验证这些概率之和为 $1$：\n$$P(X=0) + P(X=1) + P(X=2) = (1-p)^2 + 2p(1-p) + p^2 = (1 - 2p + p^2) + (2p - 2p^2) + p^2 = 1$$\n\n问题陈述指出，该基因座对性状的贡献是纯加性的，由 $Y = aX$ 给出，其中 $a \\in \\mathbb{R}$ 是单个等位基因的加性效应。随机变量 $Y$ 代表该基因座的基因型值。我们需要求出 $Y$ 的均值（期望）和方差。\n\n**1. 均值贡献的推导 ($\\mu_{\\text{locus}}$)**\n\n该基因座的均值贡献 $\\mu_{\\text{locus}}$ 是随机变量 $Y$ 的期望值，记作 $E[Y]$。利用期望的线性性质，我们有：\n$$\\mu_{\\text{locus}} = E[Y] = E[aX] = aE[X]$$\n\n我们首先使用离散随机变量的基本定义 $E[X] = \\sum_i x_i P(X=x_i)$ 计算 $X$ 的期望值：\n$$E[X] = (0) \\cdot P(X=0) + (1) \\cdot P(X=1) + (2) \\cdot P(X=2)$$\n代入 HWE 概率：\n$$E[X] = (0) \\cdot (1-p)^2 + (1) \\cdot 2p(1-p) + (2) \\cdot p^2$$\n$$E[X] = 0 + 2p - 2p^2 + 2p^2 = 2p$$\n该结果表明，群体中每个个体的平均效应等位基因数量为 $2p$。\n\n现在，我们可以求出对性状的均值贡献：\n$$\\mu_{\\text{locus}} = aE[X] = a(2p) = 2ap$$\n\n**2. 方差贡献的推导 ($\\sigma_{\\text{locus}}^{2}$)**\n\n该基因座的方差贡献 $\\sigma_{\\text{locus}}^{2}$ 是随机变量 $Y$ 的方差，记作 $\\text{Var}(Y)$。利用方差的性质，我们有：\n$$\\sigma_{\\text{locus}}^{2} = \\text{Var}(Y) = \\text{Var}(aX) = a^2 \\text{Var}(X)$$\n\n$X$ 的方差定义为 $\\text{Var}(X) = E[X^2] - (E[X])^2$。我们已经计算出 $E[X] = 2p$，所以 $(E[X])^2 = (2p)^2 = 4p^2$。\n接下来，我们必须使用定义 $E[X^2] = \\sum_i x_i^2 P(X=x_i)$ 来计算 $X^2$ 的期望值 $E[X^2]$：\n$$E[X^2] = (0^2) \\cdot P(X=0) + (1^2) \\cdot P(X=1) + (2^2) \\cdot P(X=2)$$\n代入 HWE 概率：\n$$E[X^2] = (0) \\cdot (1-p)^2 + (1) \\cdot 2p(1-p) + (4) \\cdot p^2$$\n$$E[X^2] = 0 + 2p - 2p^2 + 4p^2 = 2p + 2p^2$$\n\n现在我们可以计算 $X$ 的方差：\n$$\\text{Var}(X) = E[X^2] - (E[X])^2 = (2p + 2p^2) - (2p)^2$$\n$$\\text{Var}(X) = 2p + 2p^2 - 4p^2 = 2p - 2p^2$$\n对此表达式进行因式分解得到：\n$$\\text{Var}(X) = 2p(1-p)$$\n\n最后，我们确定对性状的方差贡献，这被称为该基因座的加性遗传方差：\n$$\\sigma_{\\text{locus}}^{2} = a^2 \\text{Var}(X) = a^2 [2p(1-p)] = 2a^2p(1-p)$$\n\n该基因座的均值贡献为 $\\mu_{\\text{locus}} = 2ap$，方差贡献为 $\\sigma_{\\text{locus}}^{2} = 2a^2p(1-p)$。问题要求将结果表示为一个双元素行矩阵 $\\left(\\mu_{\\text{locus}}, \\sigma_{\\text{locus}}^{2}\\right)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2ap & 2a^{2}p(1-p) \\end{pmatrix}}\n$$", "id": "5062899"}, {"introduction": "在理解了单个基因的贡献之后，我们需要从宏观视角审视性状的总变异。本练习要求你将观察到的表型总方差分解为其遗传和环境组分，并计算窄义遗传力（$h^2$）这一关键指标。通过这个过程，你将体会到模型中的不同方差组分（如共享环境方差）如何影响我们对遗传贡献的评估。[@problem_id:5062911]", "problem": "在医学遗传学中，一个多基因性状在数量遗传学中通过将观察到的表型分解为可归因于遗传和环境来源的潜在组分来建模，在独立性假设下，每个组分都对总方差有加性贡献。考虑在一种群体中测量的某个性状，其观察到的表型方差为 $V_{P}=10$，估计的加性遗传方差为 $V_{A}=4$。\n\n首先，在这种共享环境方差被假定为可忽略不计的基线情景下，推导狭义遗传力，记作 $h^{2}$。接下来，假设新证据表明存在一个非零的共享环境（家庭内部的共同环境）组分，其方差为 $V_{C}=2$，并且该组分独立于加性遗传贡献和其他变异来源。将此共享环境纳入方差模型，并重新计算 $h^{2}$。\n\n明确说明您用于从多基因遗传中方差分解的第一性原理来论证每次 $h^{2}$ 计算所使用的假设。然后，简要解释 $h^{2}$ 的变化对于家庭共享条件下预期的家庭相似性意味着什么，并区分遗传贡献和环境贡献。\n\n将两个遗传力值表示为无单位的小数，并各自四舍五入到三位有效数字。最终答案只提供数值。", "solution": "该问题要求在两种不同的表型方差分解模型下计算狭义遗传力 $h^2$。首先，我们概述基本原理。\n\n对于一个多基因性状，观察到的总表型方差 $V_P$ 可以分解为遗传（$V_G$）和环境（$V_E$）组分。假设遗传与环境因素之间相互独立（即没有基因型-环境相关性），则模型是加性的：\n$$V_P = V_G + V_E$$\n遗传方差可以进一步划分为加性遗传方差（$V_A$）、显性方差（$V_D$）和上位性（交互作用）方差（$V_I$）：\n$$V_G = V_A + V_D + V_I$$\n环境方差可以划分为共享（或共同）环境方差（$V_C$）和非共享（或特定）环境方差（$V_S$）：\n$$V_E = V_C + V_S$$\n结合这些，我们得到完整的方差分解模型：\n$$V_P = V_A + V_D + V_I + V_C + V_S$$\n狭义遗传力 $h^2$ 定义为总表型方差中由加性遗传方差贡献的比例：\n$$h^2 = \\frac{V_A}{V_P}$$\n这个量在遗传学中至关重要，因为它能预测选择反应以及由于加性遗传效应导致的亲属间的相似程度。\n\n**第一部分：基线遗传力计算**\n\n在初始的基线情景中，我们已知：\n- 总表型方差，$V_P = 10$。\n- 加性遗传方差，$V_A = 4$。\n- 一个明确的假设，即共享环境方差可忽略不计，形式上表示为 $V_C = 0$。\n\n此计算的假设是，对于一个没有明确划分出共享环境组分的模型，所提供的 $V_P = 10$ 是正确的总表型方差。使用狭义遗传力的定义，我们计算基线值，记作 $h_1^2$：\n$$h_1^2 = \\frac{V_A}{V_P} = \\frac{4}{10} = 0.4$$\n\n**第二部分：考虑共享环境后重新计算遗传力**\n\n接下来，我们得到新的证据，表明存在一个不可忽略的共享环境组分，其方差为 $V_C = 2$。我们需要将此组分纳入模型。问题陈述该组分独立于其他变异来源。\n\n这里的关键假设是如何“纳入”这个新组分。独立组分的方差可加性原理意味着总方差是其所有构成部分之和。初始模型在当时已知或假设的组分（$V_A = 4$ 以及其他残差方差总和为 $V_P - V_A = 10 - 4 = 6$）下，得出的总方差为 $V_P = 10$。发现一个新的、独立的方差来源 $V_C = 2$，意味着之前的总表型方差是一个低估值，因为它基于一个不完整的模型。新的、更完整的模型必须包含这个额外的方差。\n\n因此，更新后的总表型方差，记作 $V_{P'}$，是原始表型方差与新识别的共享环境方差组分之和：\n$$V_{P'} = V_P + V_C = 10 + 2 = 12$$\n我们假设加性遗传方差的估计值 $V_A = 4$ 保持不变。重新计算的狭义遗传力，记作 $h_2^2$，则为：\n$$h_2^2 = \\frac{V_A}{V_{P'}} = \\frac{4}{12} = \\frac{1}{3}$$\n\n**第三部分：数值与解释**\n\n我们被要求将两个遗传力值表示为无单位的小数，并四舍五入到三位有效数字。\n对于基线情景：\n$$h_1^2 = 0.400$$\n对于包含共享环境的情景：\n$$h_2^2 = \\frac{1}{3} \\approx 0.33333... \\approx 0.333$$\n\n**对变化的解释：**\n狭义遗传力从 $h_1^2 = 0.400$ 下降到 $h_2^2 = 0.333$。这一变化对于家庭相似性有明确的解释。遗传力（$h^2$）量化了性状变异中可归因于加性遗传效应的比例。较低的 $h^2$ 意味着在解释群体中个体间观察到的差异时，遗传所起的作用相对较小。\n\n共享环境方差组分（$V_C$）的引入，迫使我们重新评估家庭相似性的来源。最初，当假定 $V_C$ 为零时，亲属间所有的相似性（超出偶然预期的部分）都被归因于遗传来源。通过认识到共享环境对总方差贡献了 $V_C=2$，我们承认共享一个家庭的个体之所以相似，部分是由于那个共享的环境（例如，饮食、社会经济地位、父母习惯）。因此，共享基因的相对贡献比之前认为的要低。$h^2$ 从 $0.400$ 下降到 $0.333$ 表明，一旦我们恰当地考虑了共享环境，加性遗传效应在总表型方差中解释的比例就变小了（从 $40\\%$ 降至 $33.3\\%$）。这意味着对于共享一个家庭的个体，他们表型的相似性更大部分是由于环境因素，而较小部分是由于他们的遗传关系。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.400 & 0.333\n\\end{pmatrix}\n}\n$$", "id": "5062911"}, {"introduction": "遗传学模型的最终目标之一是预测疾病风险。本练习将应用经典的易感性-阈值模型于一个前沿领域：多基因风险评分（PRS）。你将亲手计算一个特定的PRS如何改变群体的平均易感性水平，并由此精确量化其疾病患病率的变化，从而将抽象的理论模型与实际的风险预测联系起来。[@problem_id:5062941]", "problem": "一种复杂疾病在多因素遗传的易感性-阈值模型下进行建模。在该模型中，基线人群中个体的疾病易感性 $L$ 被假定为服从均值为 $0$、方差为 $1$ 的正态分布，记作 $L \\sim \\mathcal{N}(0,1)$。如果易感性超过一个固定的阈值 $T$，则疾病存在，因此基线患病率 $K$ 满足 $K = \\mathbb{P}(L > T)$。构建一个多基因风险评分 (PRS)，它将一个特定亚群的平均易感性移动一个常数 $\\Delta\\mu$ 而不改变方差，因此该亚群中的易感性为 $L' \\sim \\mathcal{N}(\\Delta\\mu, 1)$，并且如果 $L' > T$ 则发生疾病。假设基线患病率为 $K = 0.05$。\n\n仅从上述定义以及正态分布及其累积分布函数 (CDF) 的标准性质出发，推导亚群患病率 $K'$ 关于 $T$ 和 $\\Delta\\mu$ 的表达式，然后计算当 $\\Delta\\mu = 0.4$ 时 $K'$ 的数值。将 $K'$ 的最终结果表示为小数，并四舍五入到四位有效数字。", "solution": "首先验证问题陈述的科学合理性、自洽性和清晰度。\n\n### 步骤 1：提取已知条件\n- 基线人群易感性：$L \\sim \\mathcal{N}(0,1)$ (标准正态分布)。\n- 疾病存在条件：易感性超过阈值 $T$。\n- 基线患病率：$K = \\mathbb{P}(L > T)$。\n- 亚群易感性：$L' \\sim \\mathcal{N}(\\Delta\\mu, 1)$。均值移动了 $\\Delta\\mu$，方差不变。\n- 亚群疾病条件：$L' > T$。\n- 亚群患病率：$K' = \\mathbb{P}(L' > T)$。\n- 基线患病率数值：$K = 0.05$。\n- 平均易感性移动数值：$\\Delta\\mu = 0.4$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。易感性-阈值模型是数量遗传学和医学遗传学中分析复杂多基因性状的基石。易感性服从正态分布的假设，以及多基因风险评分 (PRS) 效应表现为该分布均值移动的假设，都是此框架内标准且被广泛接受的构念。该问题是适定的，提供了推导唯一解所需的所有信息（$K$ 允许确定 $T$，而 $T$ 和 $\\Delta\\mu$ 一起决定了 $K'$）。语言客观而精确。该问题不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n设 $\\Phi(z)$ 为标准正态分布 $\\mathcal{N}(0,1)$ 的累积分布函数 (CDF)。根据定义，对于标准正态随机变量 $Z$，有 $\\Phi(z) = \\mathbb{P}(Z \\le z)$。标准正态变量超过某个值 $z$ 的概率由其互补累积分布函数或生存函数给出，即 $\\mathbb{P}(Z > z) = 1 - \\Phi(z)$。\n\n基线人群的易感性由 $L \\sim \\mathcal{N}(0,1)$ 给出。该人群的疾病患病率 $K$ 是易感性 $L$ 超过阈值 $T$ 的概率：\n$$K = \\mathbb{P}(L > T)$$\n由于 $L$ 服从标准正态分布，这可以用标准正态 CDF 表示：\n$$K = 1 - \\Phi(T)$$\n\n亚群中的易感性 $L'$ 服从分布 $L' \\sim \\mathcal{N}(\\Delta\\mu, 1)$。该亚群的患病率 $K'$ 是 $L'$ 超过同一阈值 $T$ 的概率：\n$$K' = \\mathbb{P}(L' > T)$$\n为计算此概率，我们对随机变量 $L'$ 进行标准化。令 $Z = \\frac{L' - \\Delta\\mu}{1}$。变量 $Z$ 服从标准正态分布，$Z \\sim \\mathcal{N}(0,1)$。我们可以用 $Z$ 来表示 $L'$，即 $L' = Z + \\Delta\\mu$。疾病条件的不等式变为：\n$$Z + \\Delta\\mu > T$$\n$$Z > T - \\Delta\\mu$$\n因此，概率 $K'$ 是标准正态变量 $Z$ 超过值 $T - \\Delta\\mu$ 的概率：\n$$K' = \\mathbb{P}(Z > T - \\Delta\\mu)$$\n使用标准正态 CDF，我们得到 $K'$ 关于 $T$ 和 $\\Delta\\mu$ 的表达式：\n$$K' = 1 - \\Phi(T - \\Delta\\mu)$$\n这就完成了推导的第一部分。\n\n接下来，我们根据给定的 $K = 0.05$ 和 $\\Delta\\mu = 0.4$ 计算 $K'$ 的数值。\n首先，我们必须从基线患病率 $K$ 中确定阈值 $T$ 的值。我们有关系式：\n$$K = 1 - \\Phi(T) = 0.05$$\n这意味着 $\\Phi(T) = 1 - 0.05 = 0.95$。\n阈值 $T$ 是使标准正态分布的累积概率为 $0.95$ 的值。这是标准正态分布的第 $95$ 百分位数。我们可以使用逆 CDF $\\Phi^{-1}$ 来表示：\n$$T = \\Phi^{-1}(0.95)$$\n使用标准统计表或计算工具，该值约为：\n$$T \\approx 1.6448536$$\n现在，我们将 $T$ 和 $\\Delta\\mu$ 的值代入 $K'$ 的表达式中：\n$$K' = 1 - \\Phi(T - \\Delta\\mu) \\approx 1 - \\Phi(1.6448536 - 0.4)$$\n$$K' \\approx 1 - \\Phi(1.2448536)$$\n我们现在计算标准正态 CDF 在 $1.2448536$ 处的值：\n$$\\Phi(1.2448536) \\approx 0.8933535$$\n将此值代回 $K'$ 的表达式：\n$$K' \\approx 1 - 0.8933535 = 0.1066465$$\n题目要求将最终答案四舍五入到四位有效数字。这个数是 $0.1066465...$。前四位有效数字是 $1$、$0$、$6$、$6$。第五位有效数字是 $4$。由于 $4  5$，我们向下取整（即，不改变第四位有效数字）。\n$$K' \\approx 0.1066$$\n因此，具有给定多基因风险评分的亚群的患病率约为 $10.66\\%$。", "answer": "$$\\boxed{0.1066}$$", "id": "5062941"}]}