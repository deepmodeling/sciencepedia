{"hands_on_practices": [{"introduction": "一项基因检测的灵敏度（$Se$）和特异度（$Sp$）是其固有的性能指标，但患者和临床医生更关心的是具体测试结果的意义。这就需要计算阳性预测值（$PPV$）和阴性预测值（$NPV$），而这两个值都严重依赖于测试前概率（即群体中的患病率）。本练习将指导您如何仅使用贝叶斯定理和概率的基本定律来推导这些关键值，并计算在一个特定场景下的数值，从而揭示为何即使是高准确度的测试，在低患病率人群中也可能产生令人惊讶的结果。[@problem_id:5079098]", "problem": "一位遗传咨询师正准备向高风险临床人群通报一项特定致病性变异筛查检测的结果。该检测的性能已经过验证，其特征为灵敏度（Se）、特异度（Sp），并且该临床人群中该变异的估计先验概率（患病率）用 $p$ 表示。定义如下：灵敏度（Se）是 $P(\\text{测试阳性} \\mid \\text{存在变异})$，特异度（Sp）是 $P(\\text{测试阴性} \\mid \\text{不存在变异})$，阳性预测值（PPV）是 $P(\\text{存在变异} \\mid \\text{测试阳性})$，而阴性预测值（NPV）是 $P(\\text{不存在变异} \\mid \\text{测试阴性})$。仅使用这些定义、全概率公式和贝叶斯定理，首先推导 $PPV$ 和 $NPV$ 关于 $Se$、$Sp$ 和 $p$ 的表达式。然后，用 $Se=0.95$，$Sp=0.98$ 和 $p=0.01$ 对它们求值。按 $PPV$、$NPV$ 的顺序，以不带百分号的小数形式报告这两个值，并将数值结果四舍五入到四位有效数字。", "solution": "该问题陈述已经过严格验证，并被视为有效。其科学依据是概率论原理及其在医学诊断（贝叶斯推断）中的应用。该问题提法恰当、客观，并包含得出唯一且有意义解所需的所有必要信息。\n\n我们定义事件如下：\n$V$：存在致病性变异的事件。\n$V^c$：不存在致病性变异的事件。\n$T^+$：检测结果为阳性的事件。\n$T^-$：检测结果为阴性的事件。\n\n问题陈述中给出的信息可用这些事件表示：\n先验概率，即患病率，为 $p = P(V) = 0.01$。\n因此，不存在该变异的概率为 $P(V^c) = 1 - P(V) = 1 - p$。\n\n检测的灵敏度为 $Se = P(T^+ \\mid V) = 0.95$。\n这意味着假阴性率为 $P(T^- \\mid V) = 1 - P(T^+ \\mid V) = 1 - Se$。\n\n检测的特异度为 $Sp = P(T^- \\mid V^c) = 0.98$。\n这意味着假阳性率为 $P(T^+ \\mid V^c) = 1 - P(T^- \\mid V^c) = 1 - Sp$。\n\n需要推导的量是阳性预测值（$PPV$）和阴性预测值（$NPV$）：\n$PPV = P(V \\mid T^+)$\n$NPV = P(V^c \\mid T^-)$\n\n我们首先使用贝叶斯定理推导 $PPV$ 的表达式：\n$$PPV = P(V \\mid T^+) = \\frac{P(T^+ \\mid V) P(V)}{P(T^+)}$$\n\n分母 $P(T^+)$ 是检测结果为阳性的总概率。根据全概率公式可将其展开：\n$$P(T^+) = P(T^+ \\mid V) P(V) + P(T^+ \\mid V^c) P(V^c)$$\n代入已定义的术语（$Se$、$Sp$、$p$）：\n$$P(T^+) = (Se)(p) + (1 - Sp)(1 - p)$$\n\n现在，将此展开式代回 $PPV$ 的表达式中：\n$$PPV = \\frac{(Se)(p)}{(Se)(p) + (1 - Sp)(1 - p)}$$\n这是 $PPV$ 关于 $Se$、$Sp$ 和 $p$ 的通用表达式。\n\n接下来，我们推导 $NPV$ 的表达式。根据其定义和贝叶斯定理：\n$$NPV = P(V^c \\mid T^-) = \\frac{P(T^- \\mid V^c) P(V^c)}{P(T^-)}$$\n\n分母 $P(T^-)$ 是检测结果为阴性的总概率。根据全概率公式可将其展开：\n$$P(T^-) = P(T^- \\mid V^c) P(V^c) + P(T^- \\mid V) P(V)$$\n代入已定义的术语（$Se$、$Sp$、$p$）：\n$$P(T^-) = (Sp)(1 - p) + (1 - Se)(p)$$\n\n现在，将此展开式代回 $NPV$ 的表达式中：\n$$NPV = \\frac{(Sp)(1 - p)}{(Sp)(1 - p) + (1 - Se)(p)}$$\n这是 $NPV$ 关于 $Se$、$Sp$ 和 $p$ 的通用表达式。\n\n现在我们使用给定的数值计算这些表达式的值：$Se=0.95$，$Sp=0.98$ 和 $p=0.01$。\n\n对于阳性预测值（$PPV$）：\n$$PPV = \\frac{(0.95)(0.01)}{(0.95)(0.01) + (1 - 0.98)(1 - 0.01)}$$\n$$PPV = \\frac{0.0095}{0.0095 + (0.02)(0.99)}$$\n$$PPV = \\frac{0.0095}{0.0095 + 0.0198}$$\n$$PPV = \\frac{0.0095}{0.0293} \\approx 0.32423208...$$\n四舍五入到四位有效数字，得到 $PPV = 0.3242$。\n\n对于阴性预测值（$NPV$）：\n$$NPV = \\frac{(0.98)(1 - 0.01)}{(0.98)(1 - 0.01) + (1 - 0.95)(0.01)}$$\n$$NPV = \\frac{(0.98)(0.99)}{(0.98)(0.99) + (0.05)(0.01)}$$\n$$NPV = \\frac{0.9702}{0.9702 + 0.0005}$$\n$$NPV = \\frac{0.9702}{0.9707} \\approx 0.9994849...$$\n四舍五入到四位有效数字，得到 $NPV = 0.9995$。\n\n计算出的值为 $PPV=0.3242$ 和 $NPV=0.9995$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.3242  0.9995 \\end{pmatrix}}$$", "id": "5079098"}, {"introduction": "在遗传咨询中，一个核心任务是根据新的信息（如基因检测结果）更新个体的风险评估。这个练习建立在前一个练习的贝叶斯推理基础上，聚焦于一个常见的临床情景：来自特定族裔背景的患者因其较高的常染色体隐性遗传病携带率而接受筛查，并得到了阴性结果。本练习应用贝叶斯定理来量化其“残留风险”，即更新后的携带者概率，这是为患者提供准确的生育计划和家庭决策支持的关键信息。[@problem_id:5079091]", "problem": "一名北欧血统的患者正在为一种具有已知群体携带者频率的常染色体隐性遗传病进行孕前咨询。设身为真正携带者的事件表示为 $C$，收到阴性筛查结果的事件表示为 $N$。根据经过验证的流行病学数据，该患者的携带者身份先验概率为 $P(C)=0.02$。所使用的单基因携带者筛查的分析灵敏度为 $s=0.95$，定义为 $P(\\text{阳性} \\mid C)=0.95$。在带有验证性测试的临床携带者筛查工作流程中，通常的做法是，假设该测试的分析特异性实际为 $1.00$，因此 $P(\\text{阴性} \\mid \\neg C)=1$，其中 $\\neg C$ 表示为真正的非携带者。\n\n使用贝叶斯定理以及灵敏度和特异性的核心定义，推导并计算患者在收到阴性筛查结果后的残留携带者风险 $P(C \\mid N)$。请将最终答案以小数形式表示，并四舍五入到四位有效数字。不要使用百分号。", "solution": "用户提供了一个在医学遗传学和概率论中明确定义的定量问题。我将首先验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   身为真正携带者的事件：$C$\n-   收到阴性筛查结果的事件：$N$\n-   携带者身份的先验概率：$P(C) = 0.02$\n-   筛查的分析灵敏度：$s = P(\\text{阳性} \\mid C) = 0.95$\n-   筛查的分析特异性：$P(\\text{阴性} \\mid \\neg C) = 1.00$，其中 $\\neg C$ 表示为真正的非携带者。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它利用了概率论的基本原理，特别是贝叶斯定理，并将其应用于医学遗传学中的一个标准场景：计算筛查测试后的残留风险。给定的概率，如 $2\\%$ 的携带者频率和 $95\\%$ 的测试灵敏度，对于特定人群中的常染色体隐性遗传病是符合实际的。假设 $100\\%$ 的特异性是一种理想化情况，但为了简化问题而明确说明，这是教科书练习中的常见做法。该问题是自洽的，提供了获得唯一解所需的所有信息。它没有歧义、矛盾和事实错误。\n\n### 步骤 3：结论和行动\n问题有效。我现在将进行求解。\n\n目标是计算患者的残留携带者风险，即在给定阴性测试结果的情况下，身为携带者的后验概率，表示为 $P(C \\mid N)$。这需要应用贝叶斯定理。\n\n贝叶斯定理陈述如下：\n$$ P(C \\mid N) = \\frac{P(N \\mid C) P(C)}{P(N)} $$\n\n分母中的项 $P(N)$ 是收到阴性结果的总概率。它可以根据全概率公式展开，考虑两种互斥状态：身为携带者 ($C$) 或非携带者 ($\\neg C$)。\n$$ P(N) = P(N \\mid C) P(C) + P(N \\mid \\neg C) P(\\neg C) $$\n\n将此展开式代入贝叶斯定理，得到我们将用于计算的完整形式：\n$$ P(C \\mid N) = \\frac{P(N \\mid C) P(C)}{P(N \\mid C) P(C) + P(N \\mid \\neg C) P(\\neg C)} $$\n\n接下来，我们必须根据已知条件确定此表达式中每一项的值。\n1.  身为携带者的先验概率给定为 $P(C) = 0.02$。\n2.  身为非携带者的概率 $P(\\neg C)$ 是身为携带者概率的补集：\n    $$ P(\\neg C) = 1 - P(C) = 1 - 0.02 = 0.98 $$\n3.  在患者是携带者的情况下，得到阴性结果的概率 $P(N \\mid C)$ 是测试灵敏度的补集。灵敏度是在患者是携带者的情况下，得到阳性结果的概率，即 $P(\\text{阳性} \\mid C) = 0.95$。因此，携带者得到阴性结果的概率（假阴性率）为：\n    $$ P(N \\mid C) = 1 - P(\\text{阳性} \\mid C) = 1 - 0.95 = 0.05 $$\n4.  在患者是非携带者的情况下，得到阴性结果的概率 $P(N \\mid \\neg C)$ 是测试的特异性，给定为 $1.00$。\n    $$ P(N \\mid \\neg C) = 1.00 $$\n\n现在，我们将这些值代入完整的贝叶斯定理公式中：\n$$ P(C \\mid N) = \\frac{(0.05)(0.02)}{(0.05)(0.02) + (1.00)(0.98)} $$\n\n我们分别计算分子和分母。\n分子：\n$$ P(N \\mid C) P(C) = 0.05 \\times 0.02 = 0.001 $$\n\n分母：\n$$ P(N) = (0.05)(0.02) + (1.00)(0.98) = 0.001 + 0.98 = 0.981 $$\n\n最后，我们计算比率以求得后验概率：\n$$ P(C \\mid N) = \\frac{0.001}{0.981} $$\n\n进行除法运算：\n$$ P(C \\mid N) \\approx 0.00101936799... $$\n\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。第一位有效数字是第一个非零数字，即千分位上的 $1$。我们保留它以及接下来的三位数字，即 $0$、$1$ 和 $9$。$9$ 后面的数字是 $3$，小于 $5$，因此我们不向上取整。\n\n因此，残留携带者风险约为 $0.001019$。", "answer": "$$\n\\boxed{0.001019}\n$$", "id": "5079091"}, {"introduction": "遗传风险信息通常来自报告比值比（$OR$）的流行病学研究，该指标衡量的是携带某个基因变异的个体相对于非携带者发生某种疾病的几率。虽然比值比在统计学上非常有用，但它是一个相对风险度量，可能具有误导性，并且对患者而言不够直观。本练习旨在教授一项至关重要的技能：如何将研究文献中的比值比（$OR$）转换为对患者更有意义的绝对风险概率，这是实现有效、循证的风险沟通的基石。[@problem_id:5079076]", "problem": "一位遗传咨询师正准备向一位携带与复杂疾病相关的致病性变异的患者传达风险信息。与普通人群相比，该变异的疾病比值比（OR）为 $OR=3$。普通人群的基线绝对风险（在固定时间范围内患病的概率）为 $p_{0}=0.05$。在循证医学遗传学风险沟通中，临床医生在为患者提供咨询时，应以绝对概率而非比值比来表达风险。\n\n从基本定义出发，通过以下步骤推导携带者的绝对风险 $p'$：\n- 使用几率（odds）的定义，即概率与其补数之比。\n- 使用比值比（OR）的定义，即变异后几率与基线几率之比。\n- 将几率转换回概率。\n\n在给定 $OR=3$ 和 $p_{0}=0.05$ 的情况下，计算患者的 $p'$ 的数值。将最终答案四舍五入至四位有效数字，并以小数形式表示（不要使用百分号）。", "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于流行病学和医学统计学的原理，问题提出得当，提供了所有必要的数据，并且语言客观。该问题要求进行风险评估中使用的标准、可形式化的计算。\n\n设 $p_0$ 代表普通人群的基线绝对风险（概率），$p'$ 代表携带者的绝对风险。问题给出了比值比 $OR=3$ 和基线风险 $p_0 = 0.05$。任务是推导并计算 $p'$。\n\n推导过程遵循问题中概述的三个步骤。\n\n首先，我们将概率为 $P$ 的事件的几率（odds）定义为事件发生的概率与事件不发生的概率之比。普通人群的基线几率，我们记为 $\\text{odds}_0$，由基线概率 $p_0$ 计算得出：\n$$\n\\text{odds}_0 = \\frac{p_0}{1 - p_0}\n$$\n代入给定值 $p_0 = 0.05$：\n$$\n\\text{odds}_0 = \\frac{0.05}{1 - 0.05} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}\n$$\n\n其次，比值比（$OR$）定义为携带变异组（携带者）的几率与基线组（普通人群）的几率之比。设 $\\text{odds}'$ 为携带者的几率。其关系为：\n$$\nOR = \\frac{\\text{odds}'}{\\text{odds}_0}\n$$\n我们可以重新整理这个公式来求解携带者的几率：\n$$\n\\text{odds}' = OR \\times \\text{odds}_0\n$$\n代入给定的值 $OR = 3$ 和计算出的 $\\text{odds}_0$ 的值：\n$$\n\\text{odds}' = 3 \\times \\frac{1}{19} = \\frac{3}{19}\n$$\n\n第三，我们将携带者的几率 $\\text{odds}'$ 转换回携带者的绝对风险 $p'$。概率和几率之间的关系是可逆的。给定几率，概率 $p'$ 的计算公式为：\n$$\np' = \\frac{\\text{odds}'}{1 + \\text{odds}'}\n$$\n代入 $\\text{odds}'$ 的值：\n$$\np' = \\frac{\\frac{3}{19}}{1 + \\frac{3}{19}} = \\frac{\\frac{3}{19}}{\\frac{19}{19} + \\frac{3}{19}} = \\frac{\\frac{3}{19}}{\\frac{22}{19}} = \\frac{3}{22}\n$$\n\n为了推导出一个用 $p_0$ 和 $OR$ 表示 $p'$ 的通用公式，我们可以代入符号表达式：\n$$\np' = \\frac{\\text{odds}'}{1 + \\text{odds}'} = \\frac{OR \\times \\frac{p_0}{1-p_0}}{1 + OR \\times \\frac{p_0}{1-p_0}}\n$$\n为了简化这个繁分数，我们将分子和分母同乘以 $(1 - p_0)$：\n$$\np' = \\frac{OR \\times p_0}{(1 - p_0) + (OR \\times p_0)} = \\frac{OR \\cdot p_0}{1 - p_0 + OR \\cdot p_0}\n$$\n使用这个通用公式和给定的值 $OR=3$ 和 $p_0=0.05$ 来验证我们的结果：\n$$\np' = \\frac{3 \\times 0.05}{1 - 0.05 + (3 \\times 0.05)} = \\frac{0.15}{0.95 + 0.15} = \\frac{0.15}{1.10} = \\frac{15}{110} = \\frac{3}{22}\n$$\n\n最后，我们计算 $p'$ 的数值，并按要求将其四舍五入到四位有效数字。\n$$\np' = \\frac{3}{22} \\approx 0.13636363...\n$$\n前四位有效数字是 $1$、$3$、$6$ 和 $3$。第五位有效数字是 $6$，大于或等于 $5$，所以我们将第四位有效数字向上取整。\n$$\np' \\approx 0.1364\n$$\n因此，携带者患上该疾病的绝对风险约为 $0.1364$。", "answer": "$$\\boxed{0.1364}$$", "id": "5079076"}]}