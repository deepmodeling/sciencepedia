{"hands_on_practices": [{"introduction": "奠基者效应最直接的后果是等位基因频率的随机波动。本练习将指导您使用基本的 Wright-Fisher 模型，通过一个具体的计算来量化这一随机性，即计算在一个小规模的奠基群体中，仅一代之内，一个罕见致病等位基因频率显著增加的概率。这个实践将帮助您直观地理解遗传漂变在奠基事件中的核心作用 ([@problem_id:5037061])。", "problem": "一个小型的奠基者群体从一个大型的泛交群体中迁出，建立了一个新的隔离社区。考虑一个携带隐性致病等位基因的常染色体基因座，在源群体中该等位基因的初始频率为 $p=0.01$。奠基者群体大小为 $N=25$ 个二倍体个体，隔离社区中的下一代是在经典的 Wright–Fisher 假设下形成的（恒定群体大小 $N$、不重叠的世代、随机的配子结合、无选择、无突变、无迁移）。在这些假设下，子代中的每个基因拷贝（共 $2N$ 个）都是从亲代基因库中独立抽取的，其中任何一个被抽取的基因拷贝是致病等位基因的概率等于亲代的等位基因频率 $p$。\n\n从这些核心假设和定义出发，推导该基因座下一代等位基因拷贝数 $K$ 的抽样分布，并用它来计算仅由于遗传漂变，致病等位基因在子代中达到至少 $0.05$ 频率的概率。将最终概率表示为十进制数，并将答案四舍五入到四位有效数字。", "solution": "用户提供了一个来自群体遗传学领域的问题，具体涉及遗传漂变和奠基者效应。\n\n### 步骤1：问题验证\n\n第一步是仔细验证问题陈述。\n\n#### 提取的已知条件\n-   一个小型的奠基者群体建立了一个新的隔离社区。\n-   源群体是大型、泛交的，并且在一个常染色体基因座上，致病隐性等位基因的频率为 $p = 0.01$。\n-   奠基者群体大小为 $N = 25$ 个二倍体个体。\n-   下一代是在经典的 Wright–Fisher 假设下形成的：恒定群体大小 $N$、不重叠的世代、随机交配、无选择、无突变、无迁移。\n-   群体中的基因拷贝总数为 $2N$。\n-   子代中的每个基因拷贝（共 $2N$ 个）都是从亲代基因库中独立抽取的。\n-   任何一个被抽取的基因拷贝是致病等位基因的概率被明确设定为亲代（奠基者群体）的等位基因频率，给定为 $p = 0.01$。\n\n#### 使用提取的已知条件进行验证\n-   **科学依据**：该问题牢固地植根于群体遗传学。Wright-Fisher 模型是研究遗传漂变效应的经典基础模型。所描述的情景（奠基者事件导致等位基因频率改变）是这一过程的经典例子。\n-   **适定性**：该问题是适定的。它提供了所有必要的参数（$N$，$p$）和一个清晰的模型（Wright-Fisher）来定义一个概率分布。问题要求从这个分布中导出一个特定的概率，这是一个数学上明确无误的任务。\n-   **客观性**：语言精确、量化，并且没有主观或基于观点的陈述。\n\n该问题没有表现出验证标准中列出的任何缺陷。这个设定是一个奠基者事件的标准（尽管简化了）表示，其中假设小型奠基者群体的等位基因频率与大型源群体的等位基因频率相同。这是一个明确的建模选择，而不是一个矛盾。因此，该问题被认为是有效的。\n\n### 步骤2：求解推导\n\n问题要求下一代等位基因数量的抽样分布，以及由此导出的一个特定概率。\n\n下一代基因库的形成由 Wright-Fisher 模型描述。在此模型中，下一代的 $2N$ 个等位基因是从当前一代（奠基者）的基因库中有放回地抽取的。这个过程等同于一系列独立的伯努利试验。\n\n设 $K$ 为表示子代中致病等位基因数量的随机变量。\n试验次数 $n$ 对应于子代群体中的等位基因总数，即 $n = 2N$。\n给定 $N = 25$，我们有 $n = 2 \\times 25 = 50$。\n\n每次试验中“成功”的概率（即抽到致病等位基因的概率）是亲代的等位基因频率，即 $p = 0.01$。\n\n在 $n$ 次独立的伯努利试验中，成功概率恒为 $p$ 的成功次数 $K$ 服从二项分布。因此，下一代等位基因拷贝数 $K$ 的抽样分布为：\n$$\nK \\sim \\text{Binomial}(n, p)\n$$\n参数为 $n = 50$ 和 $p = 0.01$。\n\n该分布的概率质量函数（PMF）给出了观察到恰好 $k$ 个致病等位基因的概率，其表达式为：\n$$\nP(K=k) = \\binom{n}{k} p^k (1-p)^{n-k} = \\binom{50}{k} (0.01)^k (1 - 0.01)^{50-k}\n$$\n$$\nP(K=k) = \\binom{50}{k} (0.01)^k (0.99)^{50-k}\n$$\n这就是 $K$ 的抽样分布。\n\n问题接着要求我们计算子代中致病等位基因频率至少为 $0.05$ 的概率。子代中的等位基因频率为 $\\frac{K}{2N} = \\frac{K}{50}$。我们需要计算以下概率：\n$$\nP\\left(\\frac{K}{50} \\ge 0.05\\right)\n$$\n为了找到整数计数 $K$ 的条件，我们将不等式两边乘以 $50$：\n$$\nP(K \\ge 50 \\times 0.05) = P(K \\ge 2.5)\n$$\n由于 $K$ 必须是整数（它是等位基因的计数），条件 $K \\ge 2.5$ 等价于 $K \\ge 3$。因此，我们需要计算 $P(K \\ge 3)$。\n\n计算其互补事件 $P(K  3)$ 的概率，然后用 1 减去它，在计算上更为方便。\n$$\nP(K \\ge 3) = 1 - P(K  3) = 1 - [P(K=0) + P(K=1) + P(K=2)]\n$$\n我们现在使用概率质量函数计算每一项：\n对于 $k=0$：\n$$\nP(K=0) = \\binom{50}{0} (0.01)^0 (0.99)^{50} = 1 \\times 1 \\times (0.99)^{50} = (0.99)^{50}\n$$\n对于 $k=1$：\n$$\nP(K=1) = \\binom{50}{1} (0.01)^1 (0.99)^{49} = 50 \\times 0.01 \\times (0.99)^{49} = 0.5 \\times (0.99)^{49}\n$$\n对于 $k=2$：\n$$\nP(K=2) = \\binom{50}{2} (0.01)^2 (0.99)^{48} = \\frac{50 \\times 49}{2} \\times (0.01)^2 \\times (0.99)^{48} = 1225 \\times (0.0001) \\times (0.99)^{48} = 0.1225 \\times (0.99)^{48}\n$$\n现在，我们计算数值：\n$$\nP(K=0) \\approx 0.60500606\n$$\n$$\nP(K=1) \\approx 0.5 \\times \\frac{(0.99)^{50}}{0.99} \\approx 0.5 \\times \\frac{0.60500606}{0.99} \\approx 0.30555862\n$$\n$$\nP(K=2) \\approx 0.1225 \\times \\frac{(0.99)^{50}}{(0.99)^2} \\approx 0.1225 \\times \\frac{0.60500606}{0.9801} \\approx 0.07561502\n$$\n将这些概率相加：\n$$\nP(K  3) \\approx 0.60500606 + 0.30555862 + 0.07561502 \\approx 0.9861797\n$$\n最后，我们计算所求的概率：\n$$\nP(K \\ge 3) = 1 - P(K  3) \\approx 1 - 0.9861797 = 0.0138203\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n0.0138203 \\approx 0.01382\n$$\n这个结果表明，在一个小群体中，遗传漂变可以在一代之内导致一个稀有等位基因的频率大幅增加。频率从 $1\\%$ 增加到 $5\\%$ 或更多的概率约为 $1.4\\%$。", "answer": "$$\n\\boxed{0.01382}\n$$", "id": "5037061"}, {"introduction": "遗传漂变的影响是随时间累积的，它会持续不断地侵蚀群体的遗传多样性。本练习要求您从第一性原理出发，推导杂合度随时间衰减的数学关系，并用它来计算遗传多样性降低特定幅度所需的时间。通过这个推导，您将深入理解有效群体大小（$N_e$）是如何量化遗传漂变强度并决定遗传变异丢失速度的 ([@problem_id:5037145])。", "problem": "一个临床分离株由少数个体建立，此后发展成为一个庞大的、人口统计学上稳定的群体。假设在奠基者事件之后，该群体每代保持恒定的有效群体大小 $N_e = 1000$。考虑一个单一的中性双等位基因座。设 $H_t$ 表示奠基者事件后第 $t$ 代的期望杂合度（从群体中随机抽取的两个等位基因状态不同的概率），设 $H_0$ 表示奠基后瞬间的初始杂合度。假设世代离散不重叠、随机交配，且突变、迁移和选择可忽略不计。\n\n仅使用 Wright-Fisher 抽样下随机遗传漂变的基本定义以及杂合度作为抽样概率的含义，从第一性原理推导出一个关于 $t$ 和 $N_e$ 的 $H_t$ 离散时间表达式。然后使用此表达式确定期望杂合度相对于 $H_0$ 减少 $0.10$（即达到 $H_t = 0.90\\,H_0$）所需的世代数 $t$。将最终数值答案四舍五入至四位有效数字，并以世代数为单位报告。在最终的方框答案中不要包含任何单位。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要进行验证。\n\n### 第1步：提取已知条件\n- 一个临床分离株由少数个体建立。\n- 奠基者事件后，群体大小恒定，有效群体大小为 $N_e = 1000$。\n- $H_t$ 是第 $t$ 代的期望杂合度。\n- $H_0$ 是奠基后瞬间的初始杂合度。\n- 考虑一个单一的中性双等位基因座。\n- 模型假设世代离散不重叠、随机交配，且突变、迁移和选择可忽略不计。\n- 任务是从第一性原理推导 $H_t$ 的表达式，然后计算使 $H_t = 0.90\\,H_0$ 成立的世代数 $t$。\n- 最终数值答案必须四舍五入至四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题牢固地植根于群体遗传学的原理，特别是关于遗传漂变的 Wright-Fisher 模型。有效群体大小、杂合度及其因漂变而衰减的概念是该领域的核心。假设（无突变、选择等）是分离漂变效应的标准做法。\n2.  **适定性**：该问题是适定的。它要求进行推导和后续计算，并提供了所有必要信息。初始杂合度 $H_0$ 没有给出具体数值，但最终计算中它会被消去，因此不需要。\n3.  **客观性**：语言精确客观。\n4.  **完整性与一致性**：问题是自洽且一致的。不存在矛盾的约束条件。\n5.  **现实性与可行性**：该模型是一种理想化情况，但它是遗传学中一个基础且广泛使用的模型。$N_e = 1000$ 的值是一个现实的参数。\n6.  **非平凡性**：该问题要求从第一性原理进行推导，考验了对基本概念的理解，然后进行直接的计算。它不是平凡的或同义反复的。\n\n### 第3步：结论与行动\n该问题是有效的。这是一个标准的、表述清晰的群体遗传学问题。我将继续进行解答。\n\n### $H_t$ 表达式的推导\n问题要求基于随机遗传漂变的 Wright-Fisher 模型从第一性原理进行推导。在此模型中，一个恒定有效大小为 $N_e$ 的群体在一个二倍体基因座上包含 $2N_e$ 个等位基因。第 $t+1$ 代的等位基因是通过从第 $t$ 代的基因库中有放回地抽样 $2N_e$ 次得到的。\n\n期望杂合度 $H_t$ 定义为在第 $t$ 代从群体中随机抽取的两个等位基因状态不同的概率。设 $I_t$ 为两个随机抽取的等位基因状态相同的概率。根据定义，$H_t = 1 - I_t$。我们将首先找到 $I_t$ 的递推关系。\n\n考虑在第 $t+1$ 代从群体中随机抽取的两个等位基因。我们追溯它们的祖先到第 $t$ 代。它们在第 $t$ 代的亲本等位基因有两种可能性：\n1.  这两个等位基因是*同一个*亲本等位基因的拷贝。在一个大小为 $2N_e$ 的基因库中，抽取一个等位基因，然后再次抽取到该等位基因的拷贝（有放回抽样）的概率是 $\\frac{1}{2N_e}$。如果这两个等位基因源自同一个亲本等位基因，它们的状态必然相同。\n2.  这两个等位基因是*不同*亲本等位基因的拷贝。此事件的概率是 $1 - \\frac{1}{2N_e}$。如果它们源自两个不同的亲本等位基因，它们状态相同的概率就是第 $t$ 代中任意两个随机等位基因状态相同的概率，即 $I_t$。\n\n结合这两种互斥情况，第 $t+1$ 代状态相同的总概率（记为 $I_{t+1}$）由这两种情况的概率之和给出：\n$$ I_{t+1} = (1) \\cdot \\left(\\frac{1}{2N_e}\\right) + (I_t) \\cdot \\left(1 - \\frac{1}{2N_e}\\right) $$\n$$ I_{t+1} = \\frac{1}{2N_e} + I_t - \\frac{I_t}{2N_e} $$\n\n现在，我们使用 $I_t = 1 - H_t$ 和 $I_{t+1} = 1 - H_{t+1}$ 将此关系从相同性（$I_t$）转换为杂合度（$H_t$）：\n$$ 1 - H_{t+1} = \\frac{1}{2N_e} + (1 - H_t) \\left(1 - \\frac{1}{2N_e}\\right) $$\n$$ 1 - H_{t+1} = \\frac{1}{2N_e} + 1 - \\frac{1}{2N_e} - H_t + \\frac{H_t}{2N_e} $$\n$$ 1 - H_{t+1} = 1 - H_t \\left(1 - \\frac{1}{2N_e}\\right) $$\n$$ H_{t+1} = H_t \\left(1 - \\frac{1}{2N_e}\\right) $$\n\n这是一个描述杂合度在单代内变化的递归公式。为了找到 $H_t$ 作为初始杂合度 $H_0$ 和时间 $t$ 的函数表达式，我们可以通过迭代求解这个递推关系：\n$$ H_1 = H_0 \\left(1 - \\frac{1}{2N_e}\\right) $$\n$$ H_2 = H_1 \\left(1 - \\frac{1}{2N_e}\\right) = H_0 \\left(1 - \\frac{1}{2N_e}\\right)^2 $$\n通过归纳法，$t$ 代后 $H_t$ 的表达式为：\n$$ H_t = H_0 \\left(1 - \\frac{1}{2N_e}\\right)^t $$\n这就是从第一性原理推导出的 $H_t$ 的离散时间表达式。\n\n### 计算时间 $t$\n问题的第二部分要求计算期望杂合度相对于 $H_0$ 减少 $0.10$ 所需的世代数 $t$。这对应于条件 $H_t = (1 - 0.10)H_0 = 0.90\\,H_0$。\n\n我们将此条件代入推导出的 $H_t$ 表达式中：\n$$ 0.90\\,H_0 = H_0 \\left(1 - \\frac{1}{2N_e}\\right)^t $$\n假设 $H_0 > 0$（一个非单态的初始群体），我们可以将两边同时除以 $H_0$：\n$$ 0.90 = \\left(1 - \\frac{1}{2N_e}\\right)^t $$\n为了求解 $t$，我们对两边取自然对数：\n$$ \\ln(0.90) = \\ln\\left[\\left(1 - \\frac{1}{2N_e}\\right)^t\\right] $$\n$$ \\ln(0.90) = t \\cdot \\ln\\left(1 - \\frac{1}{2N_e}\\right) $$\n$$ t = \\frac{\\ln(0.90)}{\\ln\\left(1 - \\frac{1}{2N_e}\\right)} $$\n\n现在，我们代入给定的有效群体大小 $N_e = 1000$：\n$$ t = \\frac{\\ln(0.90)}{\\ln\\left(1 - \\frac{1}{2 \\cdot 1000}\\right)} $$\n$$ t = \\frac{\\ln(0.90)}{\\ln\\left(1 - \\frac{1}{2000}\\right)} $$\n$$ t = \\frac{\\ln(0.90)}{\\ln(0.9995)} $$\n\n我们现在计算数值：\n$$ \\ln(0.90) \\approx -0.10536051565 $$\n$$ \\ln(0.9995) \\approx -0.00050012502 $$\n$$ t \\approx \\frac{-0.10536051565}{-0.00050012502} \\approx 210.66801 $$\n\n问题要求将最终数值答案四舍五入至四位有效数字。\n$$ t \\approx 210.7 $$\n因此，期望杂合度降低到其初始值的 $90\\%$ 大约需要 $210.7$ 代。", "answer": "$$\\boxed{210.7}$$", "id": "5037145"}, {"introduction": "遗传漂变的最终结局是等位基因的固定或丢失，这导致了不同隔离群体间的遗传分化。本练习探讨了一个极为重要的理论问题：两个具有相同初始等位基因频率的独立奠基者群体，最终固定不同等位基因的概率是多少？解决这个问题将揭示一个简洁而深刻的原理，即遗传漂变是如何驱动群体走向不同进化轨迹的 ([@problem_id:5037091])。", "problem": "在医学遗传学中，当新的、孤立的亚群从一个更大的祖先群体中产生时，奠基者效应可以放大遗传漂变的作用。考虑两个大小相同的奠基者亚群，它们同时形成，然后保持完全隔离。在祖先群体中，一个与疾病相关的中性等位基因 $A$ 的频率为 $p_0$（其替代等位基因 $a$ 的频率为 $1 - p_0$）。假设每个亚群都是有限的，在没有选择、突变可忽略不计、没有迁移的 Wright-Fisher (WF) 中性遗传漂变模型下演化，并最终纯粹由于漂变而达到 $A$ 或 $a$ 的固定。\n\n仅使用中性漂变的基本原理（具体来说，在一个没有突变的有限 WF 群体中，该过程在 $0$ 和 $1$ 处是吸收的，并且在中性条件下演化），从第一性原理推导两个亚群最终固定不同等位基因（一个亚群固定 $A$，另一个亚群固定 $a$）的概率。请用一个关于 $p_0$ 的封闭形式解析表达式来表示你的答案。无需四舍五入，也不涉及单位。", "solution": "在具有限群体和可忽略突变的 Wright-Fisher (WF) 中性遗传漂变模型下，等位基因频率过程在 $0$（$A$ 丢失）或 $1$（$A$ 固定）处被吸收。设 $X_t$ 表示在第 $t$ 代时等位基因 $A$ 的频率，其中 $X_0 = p_0$。在中性条件下，期望等位基因频率随时间在期望意义上是守恒的。形式上，$\\{X_t\\}$ 是关于 WF 过程中性条件下的自然滤的一个鞅，因此\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}[X_0] = p_0 \\quad \\text{for all } t \\geq 0.\n$$\n因为状态空间是有限的且突变可忽略不计，该过程几乎必然被吸收：存在一个随机时间 $T$，使得 $X_T \\in \\{0,1\\}$ 且对于所有 $t \\geq T$ 都有 $X_t = X_T$。定义 $X_{\\infty} := \\lim_{t \\to \\infty} X_t \\in \\{0,1\\}$。那么\n$$\n\\mathbb{E}[X_{\\infty}] = \\mathbb{E}[X_0] = p_0.\n$$\n由于 $X_{\\infty}$ 是 $A$ 固定的指示变量（如果 $A$ 固定则等于 $1$，如果 $A$ 丢失则等于 $0$），我们有\n$$\n\\mathbb{E}[X_{\\infty}] = \\mathbb{P}\\!\\left(X_{\\infty} = 1\\right) = \\mathbb{P}\\!\\left(\\text{$A$ fixes}\\right).\n$$\n因此，等位基因 $A$ 在单个亚群中最终固定的概率是\n$$\n\\mathbb{P}\\!\\left(\\text{$A$ fixes in one deme}\\right) = p_0,\n$$\n而等位基因 $a$ 在单个亚群中固定的概率是\n$$\n\\mathbb{P}\\!\\left(\\text{$a$ fixes in one deme}\\right) = 1 - p_0.\n$$\n\n现在考虑两个在奠基后独立演化的亚群。设事件为：\n- $F_1^A$：亚群 $1$ 固定等位基因 $A$，\n- $F_1^a$：亚群 $1$ 固定等位基因 $a$，\n- $F_2^A$：亚群 $2$ 固定等位基因 $A$，\n- $F_2^a$：亚群 $2$ 固定等位基因 $a$。\n根据独立性以及单个亚群的固定概率，\n$$\n\\mathbb{P}(F_1^A) = p_0, \\quad \\mathbb{P}(F_1^a) = 1 - p_0, \\quad \\mathbb{P}(F_2^A) = p_0, \\quad \\mathbb{P}(F_2^a) = 1 - p_0.\n$$\n两个亚群固定不同等位基因的事件是\n$$\n\\left(F_1^A \\cap F_2^a\\right) \\cup \\left(F_1^a \\cap F_2^A\\right),\n$$\n这两个事件是不相交的。因此，利用独立性，\n$$\n\\mathbb{P}\\!\\left(\\text{different alleles fixed}\\right) = \\mathbb{P}(F_1^A \\cap F_2^a) + \\mathbb{P}(F_1^a \\cap F_2^A)\n= \\mathbb{P}(F_1^A)\\,\\mathbb{P}(F_2^a) + \\mathbb{P}(F_1^a)\\,\\mathbb{P}(F_2^A).\n$$\n代入概率，\n$$\n\\mathbb{P}\\!\\left(\\text{different alleles fixed}\\right) = p_0(1 - p_0) + (1 - p_0)p_0 = 2 p_0 (1 - p_0).\n$$\n\n因此，两个大小相同、初始等位基因频率为 $p_0$ 的奠基者亚群纯粹由于漂变而固定不同等位基因的概率是封闭形式表达式 $2 p_0 (1 - p_0)$。", "answer": "$$\\boxed{2 p_0 (1 - p_0)}$$", "id": "5037091"}]}