## 引言
[群体遗传学](@entry_id:146344)是连接[孟德尔遗传学](@entry_id:142603)与宏观演化理论的桥梁，它研究群体内部的遗传变异以及塑造这些变异的演化力量。从理解为何某些[遗传病](@entry_id:273195)在特定人群中高发，到追溯人类迁徙的古老足迹，群体遗传学的视角无处不在。然而，对于许多学习者而言，从个体层面的基因传递到群体层面的频率动态变化，存在着一个概念上的鸿沟。我们如何量化群体中的[遗传多样性](@entry_id:201444)？等位基因的命运究竟由哪些力量掌控？这些理论又如何应用于解决实际的医学和生物学问题？

本文旨在系统性地解答这些问题，为读者构建一个坚实的群体遗传学知识体系。我们将通过三个循序渐进的章节来展开：

在**第一章：原理与机制**中，我们将首先建立描述群体遗传构成的定量语言，引入作为基本[零模型](@entry_id:181842)的哈迪-温伯格平衡。随后，我们将深入剖析驱动演化变化的四大核心力量——[遗传漂变](@entry_id:145594)、自然选择、突变和迁移——的数学模型和生物学意义，并探讨种群结构与[连锁不平衡](@entry_id:146203)等重要概念。

在**第二章：应用与跨学科联系**中，我们将展示这些抽象原理如何转化为强大的分析工具。您将看到[群体遗传学](@entry_id:146344)在临床遗传咨询、复杂疾病的风险预测、全基因组关联研究（GWAS）的数据解读、宿主-病原体协同演化以及公共卫生策略制定等领域的广泛应用。

最后，在**第三章：动手实践**中，您将有机会通过解决一系列精心设计的问题，亲手应用所学知识，从而加深对核心概念的理解并锻炼解决实际问题的能力。

通过这一结构化的学习路径，本文将带领您从最基本的数学原理出发，逐步领略群体遗传学在现代医学和生命科学研究中的深刻影响与广阔前景。让我们首先从构建这门学科的基石——其核心原理与机制——开始。

## 原理与机制

### 描述群体中的遗传变异

群体遗传学的核心任务是描述和解释群体内部及群体之间遗传变异的模式。为了实现这一目标，我们需要一个定量的框架来描述[基因库](@entry_id:267957)（gene pool）的构成，即一个群体中所有等位基因的总和。

#### [等位基因频率](@entry_id:146872)和[基因型频率](@entry_id:141286)

最基本的描述符是**[等位基因频率](@entry_id:146872)（allele frequency）**和**[基因型频率](@entry_id:141286)（genotype frequency）**。考虑一个[二倍体](@entry_id:268054)群体中单个常染色体上的位点，存在两个等位基因，记为 $A$ 和 $a$。如果我们从该群体中抽取一个大小为 $N$ 的样本，并观察到三种基因型 $AA$、$Aa$ 和 $aa$ 的个体数分别为 $n_{AA}$、$n_{Aa}$ 和 $n_{aa}$，那么基因型频率就是每种基因型的个体数占总样本数的比例。

然而，从演化的角度来看，[等位基因频率](@entry_id:146872)更为根本，因为它衡量了[基因库](@entry_id:267957)中不同等位基因的相对普遍程度。由于每个[二倍体](@entry_id:268054)个体携带两个等位基因，一个大小为 $N$ 的群体的[基因库](@entry_id:267957)在該位点上包含 $2N$ 个等位基因拷贝。等位基因 $A$ 的频率，通常用 $p$ 表示，可以从观测到的基因型计数中直接推导出来。[@problem_id:5032319]

$AA$ 型个体携带两个 $A$ 等位基因，$Aa$ 型个体携带一个 $A$ 等位基因，而 $aa$ 型个体不携带 $A$ 等位基因。因此，样本中 $A$ 等位基因的总数是 $2n_{AA} + n_{Aa}$。等位基因 $A$ 的频率 $p$ 就是其总数与基因库中等位基因总数的比值：

$$p = \frac{2n_{AA} + n_{Aa}}{2N}$$

同样地，等位基因 $a$ 的频率 $q$ 可以计算为 $q = \frac{2n_{aa} + n_{Aa}}{2N}$。由于该位点只有这两个等位基因，它们的频率之和必须为 1，即 $p + q = 1$。因此，一旦计算出 $p$，就可以立即得到 $q = 1 - p$。

例如，在一个 $1000$ 人的样本中，如果观测到 $n_{AA}=360$，$n_{Aa}=540$ 和 $n_{aa}=100$，则 $A$ 等位基因的频率为：

$$p = \frac{2 \times 360 + 540}{2 \times 1000} = \frac{720 + 540}{2000} = \frac{1260}{2000} = 0.63$$

这表明在该样本的基因库中，有 $63\%$ 的等位基因是 $A$。

#### 哈迪-温伯格平衡：群体遗传学的[零模型](@entry_id:181842)

知道了等位基因频率，我们能否预测下一代的[基因型频率](@entry_id:141286)？G. H. Hardy 和 Wilhelm Weinberg 在 20 世纪初独立地解决了这个问题，提出了[群体遗传学](@entry_id:146344)的基石——**哈迪-温伯格平衡（Hardy-Weinberg Equilibrium, HWE）**。它描述了一个在没有演化力量作用下的理想群体的遗传构成。

HWE 模型基于几个关键假设：
1.  群体极大（无[遗传漂变](@entry_id:145594)）。
2.  [随机交配](@entry_id:149892)（Random mating）。
3.  没有选择（No selection）。
4.  没有突变（No mutation）。
5.  没有迁移（No migration）。

在这些条件下，如果亲代产生配子时，携带等位基因 $A$ 的配子频率为 $p$，携带等位基因 $a$ 的配子频率为 $q$，那么子代的[基因型频率](@entry_id:141286)可以通过将配子的随机结合视为两个[独立事件](@entry_id:275822)的概率来预测。[@problem_id:5032323]

一个子代个体从母亲和父亲那里各继承一个配子。
-   形成 $AA$ 基因型的概率是，父方配子和母方配子都携带 $A$。由于事件是独立的，其概率为 $p \times p = p^2$。
-   形成 $aa$ 基因型的概率是，父方和母方配子都携带 $a$。其概率为 $q \times q = q^2$。
-   形成 $Aa$ 基因型的途径有两种：父方提供 $A$ 而母方提供 $a$（概率为 $p \times q$），或者父方提供 $a$ 而母方提供 $A$（概率为 $q \times p$）。由于这两种方式是互斥的，总概率为 $pq + qp = 2pq$。

因此，经过一代[随机交配](@entry_id:149892)后，[基因型频率](@entry_id:141286)将达到并维持在如下比例：

$$f(AA) = p^2$$
$$f(Aa) = 2pq$$
$$f(aa) = q^2$$

这些频率之和为 $p^2 + 2pq + q^2 = (p+q)^2 = 1^2 = 1$，正如预期。更重要的是，只要 HWE 的假设得到满足，无论初始[基因型频率](@entry_id:141286)如何，只要[等位基因频率](@entry_id:146872)为 $p$ 和 $q$，群体在经过一代[随机交配](@entry_id:149892)后就会达到这个平衡状态，并且此后各代将保持不变。HWE 因此成为一个“零假设”或“[零模型](@entry_id:181842)”，如果一个真实群体的基因型频率偏离了 HWE 预测值，那就意味着至少有一个演化假设被违背了，从而促使我们去探究是哪种演化力量在起作用。

#### 衡量遗传多样性：杂合度

遗传变异是演化的原材料，也是群体适应潜力的体现。一个衡量群体遗传变异水平的关键指标是**杂合度（heterozygosity）**。在 HWE 条件下，一个二倍体座位上的预期杂合度（Expected Heterozygosity, $H_e$）即为杂合[子基](@entry_id:152709)因型 $Aa$ 的频率，即 $H_e = 2pq$。这个值可以表示为仅关于 $p$ 的函数：$H_e = 2p(1-p)$。当 $p=q=0.5$ 时，[杂合度](@entry_id:166208)达到最大值 $0.5$，此时[遗传多样性](@entry_id:201444)最高。

这个概念可以推广到具有多个（$k$ 个）等位基因的座位。假设等位基因 $A_1, A_2, \dots, A_k$ 的频率分别为 $p_1, p_2, \dots, p_k$（其中 $\sum_{i=1}^{k} p_i = 1$）。在一个处于 HWE 的群体中，一个个体是杂合的，意味着它携带两个不同的等位基因。计算所有杂合子频率之和可能很繁琐。一个更简洁的方法是先计算纯合子的总频率，然后从 1 中减去它。[@problem_id:5032379]

任何特定纯合[子基](@entry_id:152709)因型 $A_iA_i$ 的频率是 $p_i \times p_i = p_i^2$。所有纯合[子基](@entry_id:152709)因型的总频率 $G$ 就是各项之和：

$$G = \sum_{i=1}^{k} f(A_iA_i) = \sum_{i=1}^{k} p_i^2$$

因此，杂合子的总频率 $H$ 就是：

$$H = 1 - G = 1 - \sum_{i=1}^{k} p_i^2$$

这个量，通常被称为**基因多样性（gene diversity）**，它代表了从群体中随机抽取的两个等位基因不相同的概率。在 HWE 条件下，它恰好等于群体中杂合个体的预期比例。例如，对于两个等位基因的情况（$k=2$），$H = 1 - (p^2 + q^2)$。由于 $(p+q)^2 = p^2 + 2pq + q^2 = 1$，我们可以推出 $1 - (p^2 + q^2) = 2pq$，这与我们之前的结论完全一致。

### 演化变化的机制

哈迪-温伯格平衡描述了一个静态的画面。然而，在现实世界中，群体是动态演化的。等位基因频率的变化是演化的核心。导致这种变化的四个主要机制是：遗传漂变、自然选择、突变和迁移。

#### [遗传漂变](@entry_id:145594)：机遇的角色

与 HWE 假设的无限大群体相反，所有真实群体的规模都是有限的。这意味着从一代到下一代，等位基因的传递过程会受到抽样误差的影响。这种由于机遇导致的等位基因频率的随机波动被称为**[遗传漂变](@entry_id:145594)（genetic drift）**。

理解[遗传漂变](@entry_id:145594)的标准模型是 **Wright-Fisher 模型**。该模型设想一个大小恒定为 $N$ 的二倍体群体。为了构成下一代，我们从当前代的基因库（包含 $2N$ 个等位基因）中，进行 $2N$ 次有放回的随机抽样。这就像从一个装有不同颜色珠子的罐子里[重复抽样](@entry_id:274194)一样。

假设在 $t$ 代，等位基因 $A$ 的频率是 $p$。那么，在形成 $t+1$ 代的 $2N$ 个等位基因的过程中，抽到 $A$ 等位基因的次数 $X$ 是一个服从二项分布的随机变量，其参数为试验次数 $n=2N$ 和单次成功概率 $p$。即 $X \sim \text{Binomial}(2N, p)$。

下一代的等位基因频率 $p_{t+1}$ 就是 $X/(2N)$。由于抽样的随机性，$p_{t+1}$ 很可能不完[全等](@entry_id:194418)于 $p$。我们关心的漂变效应大小，可以用每一代等位基因频率变化的方差 $\operatorname{Var}(\Delta p)$ 来衡量，其中 $\Delta p = p_{t+1} - p$。[@problem_id:5032291]

由于在给定 $p$ 的条件下，$p$ 是一个常数，所以 $\operatorname{Var}(\Delta p) = \operatorname{Var}(p_{t+1} - p) = \operatorname{Var}(p_{t+1})$。利用[方差的性质](@entry_id:185416) $\operatorname{Var}(cX) = c^2 \operatorname{Var}(X)$ 和二项分布的方差公式 $\operatorname{Var}(X) = np(1-p)$，我们可以推导出：

$$\operatorname{Var}(\Delta p) = \operatorname{Var}\left(\frac{X}{2N}\right) = \frac{1}{(2N)^2} \operatorname{Var}(X) = \frac{1}{4N^2} [2Np(1-p)]$$

简化后得到：

$$\operatorname{Var}(\Delta p) = \frac{p(1-p)}{2N}$$

这个简洁而深刻的公式揭示了[遗传漂变](@entry_id:145594)的两个关键特征：
1.  漂变的强度与群体大小成反比。在小群体中（$N$ 小），每一代的频率波动更大，等位基因更容易快速地走向丢失（频率变为 0）或固定（频率变为 1）。
2.  对于给定的群体大小，当等位基因频率为 $p=0.5$ 时，漂变效应最强，因为此时 $p(1-p)$ 取最大值。

#### 自然选择：差异适应度的原理

**自然选择（Natural selection）**是唯一能够导致适应性演化的机制。它源于不同基因型的个体在生存和繁殖能力上的差异。我们将这种差异量化为**适应度（fitness）**。在群体遗传学模型中，我们通常使用**[相对适应度](@entry_id:153028)（relative fitness）**，用 $w$ 表示，它将每种基因型的适应度相对于一个参考基因型（通常是适应度最高的基因型，其适应度设为 1）进行标准化。

考虑一个简单的选择模型，其中选择仅作用于从合子到成年阶段的存活率（即可行性选择）。假设在合子形成时，基因型频率遵循 HWE 比例 $p^2, 2pq, q^2$。如果基因型 $AA, Aa, aa$ 的[相对适应度](@entry_id:153028)分别为 $w_{AA}, w_{Aa}, w_{aa}$，那么经过选择后，存活到成年的个体中，各种基因型的频率将与其初始频率和适应度的乘积成正比。[@problem_id:5032329]

为了得到存活下来成年个体的实际频率，我们需要用一个标准化常数——群体的**平均适应度（mean fitness, $\bar{w}$）**——来除。平均适应度是群体中所有[个体适应](@entry_id:190630)度的加权平均值：

$$\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa}$$

选择后，等位基因 $A$ 的频率 $p'$ 将由成年个体的基因型频率决定。$A$ 的新频率是存活的 $AA$ 个体频率加上存活的 $Aa$ 个体频率的一半：

$$p' = \frac{p^2 w_{AA} + \frac{1}{2}(2pq w_{Aa})}{\bar{w}} = \frac{p(p w_{AA} + q w_{Aa})}{\bar{w}}$$

一代之内等位基因频率的变化 $\Delta p = p' - p$ 是：

$$\Delta p = \frac{p(p w_{AA} + q w_{Aa})}{\bar{w}} - p = \frac{p(p w_{AA} + q w_{Aa}) - p\bar{w}}{\bar{w}}$$

代入 $\bar{w}$ 的表达式并经过一系列代数化简，我们得到一个普适的方程：

$$\Delta p = \frac{pq}{\bar{w}} [p(w_{AA} - w_{Aa}) + q(w_{Aa} - w_{aa})]$$

这个方程是理解选择动力学的核心。$\Delta p$ 的符号（即频率是增加还是减少）取决于方括号内的项。这一项是等位基因 $A$ 和 $a$ 的“平均效应”之差。$p(w_{AA} - w_{Aa})$ 反映了在 $A$ 背景下用一个 $A$ 替换一个 $a$ 的适应度效应，而 $q(w_{Aa} - w_{aa})$ 则反映了在 $a$ 背景下这样做的效应。方程表明，选择的效率与遗传变异的存在（$pq>0$）成正比。如果一个等位基因是固定的（$p=0$ 或 $q=0$），选择就无从谈起。

#### [突变-选择平衡](@entry_id:138540)

**突变（Mutation）**是产生新等位基因的最终来源，它以一个缓慢但持续的速率将一种等位基因转变为另一种。虽然突变本身作为一种演化力量通常很弱，但它与选择的相互作用在[医学遗传学](@entry_id:262833)中至关重要，特别是在解释有害[遗传病](@entry_id:273195)为何能在群体中持续存在。

考虑一种常见情况：一个功能正常的等位基因 $A$ 以一个很低的速率 $\mu$ 突变为一个有害的[隐性等位基因](@entry_id:274167) $a$。这意味着 $aa$ 基因型的个体具有较低的适应度，为 $w_{aa} = 1-s$（其中 $s$ 是**[选择系数](@entry_id:155033)**，表示适应度降低的程度），而 $AA$ 和 $Aa$ 个体的适应度均为 1。

突变不断地向[基因库](@entry_id:267957)中引入 $a$ 等位基因，而选择则通过淘汰适应度较低的 $aa$ 个体来清除它。最终，这两种力量会达到一个平衡，使得 $a$ 等位基因的频率稳定在一个较低的水平。这个状态被称为**[突变-选择平衡](@entry_id:138540)（mutation-selection balance）**。

我们可以推导出这个[平衡频率](@entry_id:275072) $q^*$。在一个世代中，选择导致 $a$ 频率的降低量近似为 $-sq^2$ (在 $q$ 很小时)。而突变导致 $a$ 频率的增加量近似为 $\mu p \approx \mu$ (因为 $p \approx 1$）。在平衡状态下，这两种变化相互抵消。更精确的推导需要考虑完整的演化周期。[@problem_id:5032330]

在平衡状态下，$q_{t+1} = q_t = q^*$。选择后的[等位基因频率](@entry_id:146872)为 $q' = \frac{q(1-sq)}{1-sq^2}$。之后，突变将 $A$ 变为 $a$，使得最终的频率为 $q_{t+1} = q'(1-\mu) + \mu$。令 $q_{t+1}=q_t=q^*$ 并求解，在 $q$ 和 $\mu$ 很小（这是现实情况）的合理近似下，该方程简化为：

$$s(q^*)^2 \approx \mu$$

由此得到有害[隐性等位基因](@entry_id:274167)的[平衡频率](@entry_id:275072)：

$$q^* \approx \sqrt{\frac{\mu}{s}}$$

这个结果非常直观：[有害等位基因](@entry_id:271628)的频率取决于其产生速率（$\mu$）和清除速率（$s$）之间的博弈。如果突变率更高或选择作用更弱，该[有害等位基因](@entry_id:271628)在群体中的频率就会更高。这个简单的[模型解释](@entry_id:637866)了许多隐性[遗传病](@entry_id:273195)（如[苯丙酮尿症](@entry_id:202323)或[囊性纤维化](@entry_id:171338)）为何能在人[类群](@entry_id:182524)体中维持一个稳定但较低的发病率。

### 种群结构的遗传后果

HWE模型假设了一个单一的、[随机交配](@entry_id:149892)的群体。然而，许多物种，包括人类，都具有**群体结构（population structure）**，即个体被划分为多个地理上或社会上隔离的亚群体（或称**dame**）。这种结构会深刻影响遗传变异的分布。

#### 迁移与基因流

**迁移（Migration）**，在群体遗传学中更准确地称为**[基因流](@entry_id:140922)（gene flow）**，是等位基因在亚群体之间的移动。它是一种强大的演化力量，倾向于减少亚群体之间的遗传差异。

一个经典的迁移模型是 Sewall Wright 提出的**岛屿模型（island model）**。该模型设想了多个亚群体（岛屿），每一代都有一定比例 $m$ 的个体从一个由所有岛屿共同构成的“大陆”（即整个元群体）迁移而来，取代本地个体。[@problem_id:5032293]

假设在 $i$ 号岛屿上，等位基因 $A$ 的频率是 $p_i$，而在整个元群体中（所有岛屿的平均），该等位基因的频率是 $\bar{p}$。经过一代迁移后， $i$ 号岛屿的新群体将由两部分组成：比例为 $1-m$ 的本地留存者（其[等位基因频率](@entry_id:146872)仍为 $p_i$）和比例为 $m$ 的外来迁移者（其[等位基因频率](@entry_id:146872)为元群体的平均频率 $\bar{p}$）。

因此，$i$ 号岛屿下一代的[等位基因频率](@entry_id:146872) $p_i'$ 是这两部分的加权平均：

$$p_i' = (1-m) p_i + m \bar{p}$$

这个递归关系清晰地表明，迁移会把每个亚群体的[等位基因频率](@entry_id:146872)“拉向”元群体的平均频率。迁移率 $m$ 越大，这种均质化效应就越强。如果没有任何其他演化力量的作用，迁移最终将使所有亚群体的等位基因频率都等于 $\bar{p}$，从而消除所有群体间的[遗传分化](@entry_id:163113)。

#### 种群细分与[瓦伦德效应](@entry_id:151966)

当一个群体实际上是由多个具有不同[等位基因频率](@entry_id:146872)的亚群体构成时，如果不加区分地将它们混合在一起进行分析，就会产生一种系统性的偏差，称为**[瓦伦德效应](@entry_id:151966)（Wahlund effect）**。这种效应表现为，在混合样本中观察到的杂合子频率低于基于混合样本的平均[等位基因频率](@entry_id:146872)所计算出的哈迪-温伯格预期值。[@problem_id:5032362]

假设我们有两个亚群体，等位基因 $A$ 的频率分别为 $p_1$ 和 $p_2$。我们在每个亚群体内观察到的杂合子频率（假设它们内部处于HWE）分别为 $2p_1(1-p_1)$ 和 $2p_2(1-p_2)$。如果我们将两个亚群体以 $w_1$ 和 $w_2$ 的权重混合，观察到的总杂合度 $H_{obs}$ 是各亚群体[杂合度](@entry_id:166208)的加权平均：

$$H_{obs} = w_1(2p_1(1-p_1)) + w_2(2p_2(1-p_2))$$

而混合群体的平均等位基因频率是 $\bar{p} = w_1 p_1 + w_2 p_2$。根据这个平均频率计算出的哈迪-温伯格预期[杂合度](@entry_id:166208)是 $H_{exp} = 2\bar{p}(1-\bar{p})$。

可以证明，$H_{obs} \le H_{exp}$，等号仅在所有亚群体[等位基因频率](@entry_id:146872)都相同时（$p_1=p_2$）成立。[杂合子缺失](@entry_id:200653)量 $D = H_{exp} - H_{obs}$ 可以表示为亚群体间等位基因频率方差的两倍：

$$D = 2 \left( \sum_{i=1}^{K} w_i p_i^2 - \left(\sum_{i=1}^{K} w_i p_i\right)^2 \right) = 2 \operatorname{Var}(p)$$

这意味着，只要亚群体之间存在[等位基因频率](@entry_id:146872)的差异（$\operatorname{Var}(p) > 0$），混合分析就必然导致杂合子“看起来”比预期的要少。在医学遗传学研究中，未考虑群体结构可能会导致对[基因型频率](@entry_id:141286)的错误推断，甚至错误地将[瓦伦德效应](@entry_id:151966)解释为近亲繁殖或其他[非随机交配](@entry_id:184998)模式的结果。

#### 量化[群体分化](@entry_id:188346)：[固定指数](@entry_id:170530) $F_{ST}$

我们需要一个标准化的度量来量化群体结构导致的[遗传分化](@entry_id:163113)程度。Sewall Wright 提出的**[固定指数](@entry_id:170530)（fixation index）$F_{ST}$** 就是这样一个工具。$F_{ST}$ 衡量了由于亚群体间[等位基因频率](@entry_id:146872)差异所导致的杂合度降低。

其定义基于三种不同层次的杂合度：
-   $H_S$：亚群体内部的平均预期[杂合度](@entry_id:166208)。这是各亚群体预期杂合度 $H_i = 2p_i(1-p_i)$ 的平均值。
-   $H_T$：整个元群体的总预期杂合度。这是基于元群体的平均[等位基因频率](@entry_id:146872) $\bar{p}$ 计算的[杂合度](@entry_id:166208)，即 $H_T = 2\bar{p}(1-\bar{p})$。

$F_{ST}$ 被定义为总杂合度中由群体间差异造成的部分所占的比例：

$$F_{ST} = \frac{H_T - H_S}{H_T}$$

$F_{ST}$ 的取值范围是 0 到 1。$F_{ST}=0$ 意味着所有亚群体具有相同的[等位基因频率](@entry_id:146872)（$H_S = H_T$），不存在[群体分化](@entry_id:188346)。$F_{ST}=1$ 则表示亚群体之间完全分化，每个亚群体内都是纯合的，没有任何共同的[多态性](@entry_id:159475)。

$F_{ST}$ 与亚群体间[等位基因频率](@entry_id:146872)的方差之间存在一个直接而优雅的联系。从 $F_{ST}$ 的定义出发，结合我们之前关于[瓦伦德效应](@entry_id:151966)的发现（$H_T - H_S = 2\operatorname{Var}(p)$），我们可以推导出：[@problem_id:5032373]

$$\operatorname{Var}(p) = F_{ST} H_T / 2 = F_{ST} [2\bar{p}(1-\bar{p})] / 2$$
$$\operatorname{Var}(p) = F_{ST} \bar{p}(1-\bar{p})$$

这个关系式为 $F_{ST}$ 提供了一个强大的统计学解释：$F_{ST}$ 是亚群体间[等位基因频率](@entry_id:146872)的实际方差与其在给定平均频率 $\bar{p}$ 下可能达到的最大方差 $\bar{p}(1-\bar{p})$ 的比值。它量化了总遗传变异中，可以归因于群体间差异的部分。

### 等位基因的非随机关联：[连锁不平衡](@entry_id:146203)

到目前为止，我们的讨论都集中在单个基因座上。然而，基因组上的基因并非孤立存在。位于同一条染色体上的不同位点的等位基因可能表现出非随机的关联，这种现象被称为**连锁不平衡（Linkage Disequilibrium, LD）**。

#### 单倍型与连锁不平衡系数 $D$

考虑两个二等位基因座位，位点 A（等位基因为 $A/a$）和位点 B（等位基因为 $B/b$）。在一条染色体上，这两个位点的等位基因组合构成一个**单倍型（haplotype）**。存在四种可能的单倍型：$AB$, $Ab$, $aB$, 和 $ab$。它们的频率分别记为 $f_{AB}, f_{Ab}, f_{aB}, f_{ab}$。

如果两个位点的等位基因是随机组合的，即处于**连锁平衡（linkage equilibrium）**状态，那么一个单倍型的频率应该等于其组成等位基因频率的乘积。例如，$f_{AB}$ 应该等于 $p_A \times p_B$，其中 $p_A = f_{AB} + f_{Ab}$ 是 $A$ 的频率，$p_B = f_{AB} + f_{aB}$ 是 $B$ 的频率。

连锁不平衡就是对这种随机关联的偏离。最常用的度量是**[连锁不平衡](@entry_id:146203)系数 $D$**，定义为：

$$D = f_{AB} - p_A p_B$$

如果 $D>0$，意味着 $AB$ 单倍型比预期的更常见（同时 $ab$ 单倍型也更常见）；如果 $D0$，意味着 $AB$ 单倍型比预期的更少（而重组型单倍型 $Ab$ 和 $aB$ 更常见）；如果 $D=0$，则表示连锁平衡。

#### 标准化连锁不平衡：相关系数 $r^2$

系数 $D$ 的一个缺点是其取值范围依赖于相关位点的[等位基因频率](@entry_id:146872)，这使得在不同位点对之间比较 LD 的强度变得困难。因此，需要使用标准化的度量。其中最重要和最常用的是**平方[相关系数](@entry_id:147037) $r^2$**。

$r^2$ 将 LD 视为两个位点等位基因状态之间的[统计相关性](@entry_id:267552)。我们可以定义两个指示变量：$X$ 在位点 A 为 $A$ 时取 1，否则为 0；$Y$ 在位点 B 为 $B$ 时取 1，否则为 0。$r^2$ 就是这两个伯努利随机变量之间皮尔逊相关系数的平方。[@problem_id:5032344]

[相关系数](@entry_id:147037)的平方定义为 $r^2 = \frac{\operatorname{Cov}(X,Y)^2}{\operatorname{Var}(X)\operatorname{Var}(Y)}$。我们可以推导出这些统计量与群体遗传学参数的关系：
-   $X$ 和 $Y$ 是伯努利变量，其方差分别为 $\operatorname{Var}(X) = p_A(1-p_A) = p_A q_A$ 和 $\operatorname{Var}(Y) = p_B(1-p_B) = p_B q_B$。
-   协方差 $\operatorname{Cov}(X,Y) = E[XY] - E[X]E[Y]$。$E[XY]$ 是 $X=1$ 且 $Y=1$ 的概率，这正是单倍型 $AB$ 的频率 $f_{AB}$。$E[X]$ 和 $E[Y]$ 分别是 $p_A$ 和 $p_B$。因此，$\operatorname{Cov}(X,Y) = f_{AB} - p_A p_B = D$。

将这些结果代入 $r^2$ 的定义，我们得到：

$$r^2 = \frac{D^2}{p_A q_A p_B q_B}$$

$r^2$ 的取值范围是 0 到 1。$r^2=1$ 表示完全连锁，知道一个位点的等位基因就可以完美预测另一个位点的等位基因。$r^2=0$ 表示连锁平衡。$r^2$ 不仅衡量了 LD 的强度，而且在[全基因组](@entry_id:195052)关联研究（GWAS）中具有重要意义：如果一个未测序的致病变异与一个已测序的标记（如 SNP）处于强 LD（高 $r^2$）状态，那么对该标记的分析就可以有效地“捕捉”到致病变异的遗传信号。