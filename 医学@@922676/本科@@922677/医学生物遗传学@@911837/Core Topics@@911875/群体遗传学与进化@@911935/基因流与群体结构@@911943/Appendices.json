{"hands_on_practices": [{"introduction": "当一个大群体实际上是由多个隔离的亚群体组成时，将其简单地混合在一起进行分析可能会产生误导。这种群体结构的一个基本遗传学后果是，与整个群体随机交配的预期相比，杂合子会表现出亏缺，这种现象被称为瓦伦德效应（Wahlund effect）。这个练习 [@problem_id:2800679] 提供了一个基础的、动手计算的机会，让您亲手验证这一效应，并理解为什么识别群体亚结构是任何群体遗传学分析的关键第一步。", "problem": "在一个由2个普查规模相等的亚群组成的复合种群中，研究了一个具有等位基因 $A$ 和 $a$ 的双等位基因座。在每个亚群内部，交配是随机的（哈代-温伯格平衡），并且在所研究的世代中没有选择、突变或迁移。亚群1的等位基因 $A$ 频率为 $p_1=0.2$，亚群2的等位基因 $A$ 频率为 $p_2=0.8$。将预期杂合度定义为从相关基因库中随机（有放回地）抽取的两个等位基因为不同等位基因类型的概率。\n\n仅使用上述基本定义和假设，确定：\n- 如果忽略种群结构并将合并样本视为泛交群体，其预期杂合度，\n- 亚群内的平均预期杂合度，以及\n- 由种群结构引起的杂合子缺失，表示为因亚结构而缺失的合并预期杂合度的比例（即，以无量纲的小数形式报告该缺失，而不是百分比）。\n\n仅报告最后一项中描述的最终比例作为您的答案，四舍五入到 $4$ 位有效数字。无需单位。", "solution": "首先将验证问题的科学性和逻辑完整性。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 一个具有等位基因 $A$ 和 $a$ 的双等位基因座。\n- 一个由2个亚群组成的复合种群。\n- 亚群具有相等的普查规模。\n- 在每个亚群内部：随机交配（哈代-温伯格平衡），无选择，无突变，无迁移。\n- 亚群1的等位基因 $A$ 频率为 $p_1=0.2$。\n- 亚群2的等位基因 $A$ 频率为 $p_2=0.8$。\n- 预期杂合度的定义：从相关基因库中随机（有放回地）抽取的两个等位基㸸为不同等位基因类型的概率。\n- 任务：确定由种群结构引起的杂合子缺失，表示为因亚结构而缺失的合并预期杂合度的比例。\n- 将最终比例四舍五入到 $4$ 位有效数字后报告。\n\n**步骤2：使用提取的已知条件进行验证**\n根据既定标准评估问题陈述。\n- **科学依据：**该问题是群体遗传学中的一个经典练习，涉及等位基因频率、哈代-温伯格平衡和瓦伦德效应（Wahlund effect）等标准概念，瓦伦德效应描述了结构化种群中杂合度的降低。其前提在根本上是合理的。\n- **适定性：**问题定义清晰，提供了计算唯一且有意义答案所需的所有数值（$p_1$, $p_2$）和条件（亚群规模相等，代内无进化力）。术语“预期杂合度”得到了明确且正确的定义。\n- **客观性：**语言是定量的、精确的，没有任何主观性或模糊性。\n- **完整性和一致性：**问题是自洽的。关于2个亚群规模相等的信息至关重要且已提供。没有内部矛盾。\n- **现实性：**给定的等位基因频率在生物学上是合理的，而细分种群模型是群体遗传学理论的基石。\n\n**步骤3：结论与行动**\n问题有效。这是一个在定量生物学中适定且标准的问题。将提供完整解答。\n\n### 解题推导\n\n分析过程是通过计算三个所需量：一个假想的泛交总群体的预期杂合度（$H_T$），实际亚群内的平均预期杂合度（$H_S$），以及最后的相对缺失。\n\n首先，我们确定整个复合种群中等位基因 $A$ 的平均频率，记为 $\\bar{p}$。由于两个亚群的普查规模相等，平均频率是各个亚群频率 $p_1$ 和 $p_2$ 的算术平均值：\n$$\n\\bar{p} = \\frac{p_1 + p_2}{2}\n$$\n代入给定值 $p_1 = 0.2$ 和 $p_2 = 0.8$：\n$$\n\\bar{p} = \\frac{0.2 + 0.8}{2} = \\frac{1.0}{2} = 0.5\n$$\n相应的等位基因 $a$ 的平均频率为 $\\bar{q} = 1 - \\bar{p} = 1 - 0.5 = 0.5$。\n\n接下来，我们计算总群体的预期杂合度 $H_T$。这是在假设亚群合并并且整个复合种群中随机交配（泛交）的情况下。在处于哈代-温伯格平衡的种群中，预期杂合度由 $2\\bar{p}\\bar{q}$ 给出。\n$$\nH_T = 2\\bar{p}\\bar{q} = 2(0.5)(0.5) = 0.5\n$$\n这个值 $H_T$ 代表了如果忽略种群结构时，预期杂合子的比例。\n\n现在，我们计算每个亚群内部的预期杂合度。由于每个亚群内部交配是随机的，所以哈代-温伯格原理在局部适用。\n对于亚群1，等位基因 $a$ 的频率是 $q_1 = 1 - p_1 = 1 - 0.2 = 0.8$。其预期杂合度 $H_1$ 是：\n$$\nH_1 = 2p_1q_1 = 2(0.2)(0.8) = 0.32\n$$\n对于亚群2，等位基因 $a$ 的频率是 $q_2 = 1 - p_2 = 1 - 0.8 = 0.2$。其预期杂合度 $H_2$ 是：\n$$\nH_2 = 2p_2q_2 = 2(0.8)(0.2) = 0.32\n$$\n亚群内的平均预期杂合度 $H_S$ 是各个杂合度的加权平均值。由于亚群大小相等，这即是 $H_1$ 和 $H_2$ 的简单算术平均值。\n$$\nH_S = \\frac{H_1 + H_2}{2} = \\frac{0.32 + 0.32}{2} = 0.32\n$$\n这个值 $H_S$ 代表了在结构化种群中实际的平均杂合子比例。\n\n由种群细分（瓦伦德效应）引起的杂合度缺失是差值 $H_T - H_S$。\n$$\n\\text{Deficit} = H_T - H_S = 0.5 - 0.32 = 0.18\n$$\n问题要求将此缺失表示为合并预期杂合度 $H_T$ 的一个分数。这是一个衡量种群分化程度的指标，通常称为固定指数 $F_{ST}$。\n$$\nF_{ST} = \\frac{H_T - H_S}{H_T}\n$$\n代入计算出的值：\n$$\nF_{ST} = \\frac{0.5 - 0.32}{0.5} = \\frac{0.18}{0.5} = 0.36\n$$\n问题要求答案四舍五入到 $4$ 位有效数字。精确值为 $0.36$。为了用 $4$ 位有效数字表示，我们写作 $0.3600$。", "answer": "$$\n\\boxed{0.3600}\n$$", "id": "2800679"}, {"introduction": "在认识到群体结构的存在后，我们需要一种方法来量化其程度。固定指数 $F_{ST}$ 是衡量群体分化的标准指标，它通过比较亚群体内部的遗传多样性与总群体的遗传多样性来实现。本练习 [@problem_id:5034251] 将指导您如何从实际样本数据中计算 $F_{ST}$，并引入一个在处理有限样本时至关重要的统计学校正，即无偏估计。掌握这一计算方法，能让您准确解读在医学和进化遗传学中广泛用于描述群体分化程度的关键指标。", "problem": "一项临床遗传学研究正在评估一个可能与差异性疾病风险相关的单个双等位基因座（例如，单核苷酸多态性 (SNP)）的群体结构。对两个亚群体进行了等量抽样。亚群体 $1$ 的样本等位基因频率为 $p_{1} = 0.2$，亚群体 $2$ 的样本等位基因频率为 $p_{2} = 0.5$。每个亚群体贡献了 $n = 40$ 个二倍体个体，因此每个亚群体抽样了 $m = 80$ 个基因拷贝，合并样本中共有 $M = 160$ 个基因拷贝。\n\n假设亚群体内部满足哈代-温伯格平衡 (HWE)，并且等位基因频率的估计值来自于无放回的基因拷贝抽样。从基因多样性（杂合度）的概率定义（即随机抽取的两个基因拷贝属于不同等位基因类型的概率）出发，并利用朴素样本估计量 $2\\hat{p}(1-\\hat{p})$ 在有限样本中存在向下偏差这一事实，推导出亚群体内基因多样性 $H_{S}$ 和总（合并）基因多样性 $H_{T}$ 的无偏估计量，然后计算由总多样性超出亚群体内多样性的部分与总多样性之比定义的固定指数 (FST)，即 $F_{ST} = \\dfrac{H_{T} - H_{S}}{H_{T}}$。在需要进行有限样本偏差校正时，将样本量视为基因拷贝数（亚群体为 $m$，合并样本为 $M$）。\n\n精确计算 $H_{S}$、$H_{T}$ 和 $F_{ST}$，并将最终值表示为分数（不要四舍五入）。你的最终答案必须是一个单行矩阵，其中按顺序包含 $H_{S}$、$H_{T}$、$F_{ST}$ 这三个量。", "solution": "我们关注的基本量是基因多样性（杂合度），对于一个等位基因频率为 $p$ 的双等位基因座，其定义为两个独立随机抽样的基因拷贝具有不同等位基因状态的概率，在群体水平上这等于 $2p(1-p)$。在有限样本中，朴素估计量 $2\\hat{p}(1-\\hat{p})$ 是有偏的，因为 $\\hat{p}$ 是一个具有非零方差的随机变量。\n\n我们从等位基因频率的二项估计量的、经过充分检验的抽样性质开始。如果 $\\hat{p}$ 是从 $m$ 个抽样基因拷贝中估计出来的，那么\n$$\n\\mathbb{E}[\\hat{p}] = p, \\quad \\mathrm{Var}(\\hat{p}) = \\frac{p(1-p)}{m}.\n$$\n利用这些性质，我们推导朴素杂合度估计量的期望值：\n$$\n\\mathbb{E}\\left[2\\hat{p}(1-\\hat{p})\\right] = 2\\mathbb{E}[\\hat{p}] - 2\\mathbb{E}[\\hat{p}^{2}] = 2p - 2\\left(p^{2} + \\mathrm{Var}(\\hat{p})\\right) = 2p(1-p) - 2\\frac{p(1-p)}{m} = 2p(1-p)\\left(1 - \\frac{1}{m}\\right).\n$$\n因此，为了得到 $2p(1-p)$ 的无偏估计量，我们将朴素估计量乘以因子 $\\dfrac{m}{m-1}$：\n$$\n\\widehat{H}^{\\,u} = \\frac{m}{m-1}\\,2\\hat{p}(1-\\hat{p}).\n$$\n\n对于每个拥有 $m_{i}$ 个基因拷贝和样本等位基因频率为 $p_{i}$ 的亚群体 $i$，其基因多样性的无偏估计量为\n$$\n\\widehat{H}_{i}^{\\,u} = \\frac{m_{i}}{m_{i}-1}\\,2 p_{i}(1-p_{i}).\n$$\n亚群体内基因多样性 $H_{S}$ 是这些无偏估计值在各亚群体间的平均值：\n$$\nH_{S} = \\frac{1}{r}\\sum_{i=1}^{r} \\widehat{H}_{i}^{\\,u},\n$$\n其中 $r$ 是亚群体的数量（这里 $r=2$）。总（合并）基因多样性 $H_{T}$ 是根据合并样本等位基因频率 $\\bar{p}$ 和合并基因拷贝样本量 $M$ 构建的，使用相同的无偏校正：\n$$\n\\bar{p} = \\frac{1}{r}\\sum_{i=1}^{r} p_{i} \\quad \\text{(等基因拷贝样本量)}, \\qquad \\widehat{H}_{T} = \\frac{M}{M-1}\\,2\\bar{p}(1-\\bar{p}).\n$$\n最后，固定指数 (FST) 定义为\n$$\nF_{ST} = \\frac{H_{T}-H_{S}}{H_{T}}.\n$$\n\n现在我们根据给定的 $p_{1} = 0.2 = \\frac{1}{5}$，$p_{2} = 0.5 = \\frac{1}{2}$，$m_{1} = m_{2} = 80$ 和 $M = 160$ 精确计算每个量。\n\n步骤 1：计算 $\\widehat{H}_{1}^{\\,u}$ 和 $\\widehat{H}_{2}^{\\,u}$。\n对于亚群体 1，\n$$\n\\widehat{H}_{1}^{\\,u} = \\frac{80}{79}\\,2\\left(\\frac{1}{5}\\right)\\left(\\frac{4}{5}\\right) = \\frac{80}{79}\\cdot\\frac{8}{25} = \\frac{640}{1975} = \\frac{128}{395}.\n$$\n对于亚群体 2，\n$$\n\\widehat{H}_{2}^{\\,u} = \\frac{80}{79}\\,2\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = \\frac{80}{79}\\cdot\\frac{1}{2} = \\frac{40}{79}.\n$$\n\n步骤 2：计算 $H_{S}$，即 $\\widehat{H}_{1}^{\\,u}$ 和 $\\widehat{H}_{2}^{\\,u}$ 的平均值。\n进行通分。注意到 $395 = 5\\cdot 79$，所以\n$$\n\\frac{40}{79} = \\frac{200}{395}.\n$$\n那么\n$$\nH_{S} = \\frac{1}{2}\\left(\\frac{128}{395} + \\frac{200}{395}\\right) = \\frac{1}{2}\\cdot\\frac{328}{395} = \\frac{164}{395}.\n$$\n\n步骤 3：计算合并频率 $\\bar{p}$ 和 $\\widehat{H}_{T}$。\n在基因拷贝样本量相等的情况下，\n$$\n\\bar{p} = \\frac{p_{1} + p_{2}}{2} = \\frac{1}{2}\\left(\\frac{1}{5} + \\frac{1}{2}\\right) = \\frac{1}{2}\\cdot\\frac{7}{10} = \\frac{7}{20}.\n$$\n因此，\n$$\n2\\bar{p}(1-\\bar{p}) = 2\\left(\\frac{7}{20}\\right)\\left(\\frac{13}{20}\\right) = \\frac{182}{400} = \\frac{91}{200}.\n$$\n使用 $M=160$ 应用无偏校正：\n$$\nH_{T} = \\frac{160}{159}\\cdot\\frac{91}{200} = \\frac{4}{5}\\cdot\\frac{91}{159} = \\frac{364}{795}.\n$$\n\n步骤 4：计算 $F_{ST}$。\n$$\nF_{ST} = \\frac{H_{T}-H_{S}}{H_{T}} = \\frac{\\frac{364}{795} - \\frac{164}{395}}{\\frac{364}{795}}.\n$$\n对分子中的差值使用公分母 $62805$（因为 $795\\cdot 79 = 395\\cdot 159 = 62805$）：\n$$\n\\frac{364}{795} = \\frac{364\\cdot 79}{62805} = \\frac{28756}{62805}, \\qquad \\frac{164}{395} = \\frac{164\\cdot 159}{62805} = \\frac{26076}{62805}.\n$$\n因此，\n$$\nH_{T}-H_{S} = \\frac{28756 - 26076}{62805} = \\frac{2680}{62805}.\n$$\n除以 $H_{T} = \\frac{364}{795}$：\n$$\nF_{ST} = \\left(\\frac{2680}{62805}\\right)\\left(\\frac{795}{364}\\right) = \\frac{2680}{79\\cdot 364} = \\frac{2680}{28756} = \\frac{670}{7189}.\n$$\n分数 $\\frac{670}{7189}$ 是最简分数。\n\n因此，精确值为\n$$\nH_{S} = \\frac{164}{395}, \\quad H_{T} = \\frac{364}{795}, \\quad F_{ST} = \\frac{670}{7189}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{164}{395}  \\frac{364}{795}  \\frac{670}{7189}\\end{pmatrix}}$$", "id": "5034251"}, {"introduction": "除了衡量现存的群体结构，我们还可以利用基因组数据揭示其背后的历史动态过程，例如古老的基因流。ABBA-BABA 测试（或称 D-统计量）是一种强大的工具，它通过检验四个群体间共享等位基因的特定模式是否失衡，来推断是否存在古老的基因渗入。通过这个练习 [@problem_id:5034281]，您将接触到现代群体基因组学的前沿方法，了解如何通过简单的全基因组等位基因计数来检验关于人类历史的重大假说，例如现代人与尼安德特人等古人类之间的基因交流。", "problem": "一个医学遗传学小组使用一种四分类群等位基因共享检验来评估人类群体间的历史基因流。设 $P_1$、$P_2$ 和 $P_3$ 表示三个人类群体，设 $O$ 表示一个外群。在 $L$ 个不重叠的基因组块中，根据假定的物种树拓扑，双等位基因位点被归纳为两种不一致的位点模式计数：$ABBA$ 和 $BABA$。在没有基因流且存在不完全谱系分选（ILS）的情况下，这两种不一致的模式预计以相等的比例出现。\n\n为了检测与此零期望的偏差，该小组定义了一个检验统计量 $D$，作为观测到的不一致模式计数的归一化对比。$D$ 在整个基因组中的变异性通过对 $L$ 个块进行块刀切法（block jackknife）来估计，从而得出 $D$ 的块刀切法标准误（SE），记为 $\\widehat{\\sigma}_D$。\n\n现给出在整个基因组中凭经验观察到的总数：$ABBA = 1200$ 和 $BABA = 900$。块刀切法估计的标准误为 $\\widehat{\\sigma}_D = 0.05$。从在 ILS 条件下 $ABBA$ 和 $BABA$ 出现可能性相等的零期望出发，并使用 $D$ 作为这些计数的归一化对比的定义，计算：\n1. 根据给定计数计算 $D$ 的值。\n2. 通过用 $\\widehat{\\sigma}_D$ 标准化 $D$ 来定义的 $Z$ 分数。\n\n使用广泛采用的显著性标准 $|Z|  3$ 来判断结果是否为基因渗入提供了证据。将 $D$ 和 $Z$ 的数值四舍五入到三位有效数字。以数对 $[D, Z]$ 的形式报告最终数值答案，顺序如此；这两个量都是无量纲的。", "solution": "该问题要求计算 D 统计量及其相关的 Z 分数，以检验人类群体间的基因流（基因渗入）。这个问题提法恰当且科学合理，其依据是群体遗传学中已确立的 ABBA-BABA 检验的原理。\n\nD 统计量是一种检验统计量，旨在检测源于特定四分类群系统发育的两种不一致位点模式（记为 $ABBA$ 和 $BABA$）频率的不平衡。零假设假定没有基因流，且不一致性仅由不完全谱系分选（ILS）引起，并断定这两种模式应以相等的频率出现。D 统计量被定义为这些模式计数的归一化对比，它量化了与此零期望的偏差。\n\n设 $n_{ABBA}$ 和 $n_{BABA}$ 分别是 $ABBA$ 和 $BABA$ 位点模式的观测计数。D 统计量的公式为：\n$$ D = \\frac{n_{ABBA} - n_{BABA}}{n_{ABBA} + n_{BABA}} $$\n\n问题提供了以下经验观测计数：\n$n_{ABBA} = 1200$\n$n_{BABA} = 900$\n\n将这些值代入 $D$ 的公式中：\n$$ D = \\frac{1200 - 900}{1200 + 900} = \\frac{300}{2100} = \\frac{1}{7} $$\n\n为按要求提供数值，我们将分数转换为小数并四舍五入到三位有效数字：\n$$ D = \\frac{1}{7} \\approx 0.142857... $$\n四舍五入到三位有效数字，我们得到：\n$$ D \\approx 0.143 $$\n\n接下来，我们计算 $Z$ 分数以评估观测到的 $D$ 值的统计显著性。$Z$ 分数通过将 D 统计量除以其标准误 $\\widehat{\\sigma}_D$ 来进行标准化。因此，$Z$ 分数的公式为：\n$$ Z = \\frac{D}{\\widehat{\\sigma}_D} $$\n问题提供了块刀切法估计的标准误为 $\\widehat{\\sigma}_D = 0.05$。为了保持精度，我们使用 $D$ 的精确值 $\\frac{1}{7}$ 进行计算：\n$$ Z = \\frac{1/7}{0.05} = \\frac{1/7}{1/20} = \\frac{20}{7} $$\n\n将此分数转换为小数并四舍五入到三位有效数字：\n$$ Z = \\frac{20}{7} \\approx 2.85714... $$\n四舍五入到三位有效数字，我们得到：\n$$ Z \\approx 2.86 $$\n\n最后，我们需要判断这个结果是否为基因渗入提供了证据。指定的统计显著性标准是 $|Z|  3$。我们计算出的 $Z$ 分数约为 $2.86$。我们检查其绝对值是否满足该标准：\n$$ |Z| \\approx |2.86| = 2.86 $$\n比较结果是：\n$$ 2.86  3 $$\n这个不等式不成立。计算出的 $|Z|$ 值 $2.86$ 未超过阈值 $3$。因此，根据所提供的数据和指定的显著性标准，正式的结论是：不拒绝无基因流的零假设。观测到的 $ABBA$ 模式的超额在 $|Z|  3$ 的水平上不具有统计显著性。\n\n最终，$D$ 和 $Z$ 的数值答案（四舍五入到三位有效数字）分别为 $0.143$ 和 $2.86$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.143  2.86\n\\end{pmatrix}\n}\n$$", "id": "5034281"}]}