{"hands_on_practices": [{"introduction": "在古DNA研究领域，最大的挑战莫过于现代DNA的污染。古DNA信号极其微弱且已降解，而现代DNA则完整且无处不在，即使是极微量的污染也足以“淹没”真实的古代信号，这好比在暴雨中分辨一滴特定的雨水。这项练习 [@problem_id:1468888] 将你置于一个经典的古DNA实验室困境中，要求你运用科学推理和简约性原则（即奥卡姆剃刀），来判断一个令人困惑的基因测序结果最可能的来源。", "problem": "一个古遗传学团队正在分析一颗在西伯利亚一个洞穴中发现的、有5万年历史的尼安德特人臼齿。他们的目标是对线粒体DNA（mtDNA）进行测序。mtDNA是一种母系遗传的小型环状基因组，在细胞中以高拷贝数存在，因此非常适合古代DNA（aDNA）研究。该团队在一个超净设施中从牙齿粉末中提取DNA。然后，他们使用聚合酶链式反应（PCR）来扩增mtDNA的一个特定的高变区，该区域通常用于识别母系谱系或单倍型。\n\n对扩增后的DNA片段进行测序后，分析揭示了两种不同且数量丰富的单倍型。单倍型N是新的，但与其他已发表的尼安德特人mtDNA序列高度相似。然而，单倍型M与进行DNA提取的首席研究员的mtDNA单倍型完全匹配。根据这些信息，以下哪项是对样本中存在单倍型M的最科学合理的解释？\n\nA. 该尼安德特人个体是异质性的，这意味着他们天生拥有两种不同的mtDNA谱系，其中一种恰好与现代人相匹配。\n\nB. 这一发现为该特定尼安德特人的母系祖先与解剖学上的现代人之间的直接杂交提供了确凿的证据。\n\nC. 单倍型M的序列是在PCR扩增过程中引入的随机突变的结果，这些突变偶然累积以匹配研究员的序列。\n\nD. 尼安德特人和现代研究员的母系谱系都经历了趋同进化，独立地演化出了相同的mtDNA序列。\n\nE. 样本在处理或实验室操作过程中被首席研究员的现代DNA污染了。", "solution": "我们首先确定与古代DNA（aDNA）研究相关的生物学和方法学原理：\n- 线粒体DNA（mtDNA）是母系遗传的，通常每个个体只存在一个单倍型，除了在罕见的异质性（heteroplasmy）情况下，个体内部可能共存两种密切相关的mtDNA变体。异质性通常只涉及少数几个变异位点，而不是两个完全不同的单倍型。\n- aDNA高度片段化且有化学损伤（例如，胞嘧啶脱氨），这种损伤会降低扩增效率。\n- PCR会指数级扩增任何存在的模板；即使是微量的现代污染DNA（其完整且未受损），在扩增过程中也能胜过真实的aDNA。\n- 现代人类DNA污染是aDNA工作流程中一个普遍存在的风险，通常通过出现与实验室人员mtDNA紧密或完全匹配的序列来诊断。\n\n我们分析观察结果：\n- 样本产生了两种不同且数量丰富的mtDNA单倍型：N（新的但类似尼安德特人）和M（与首席研究员完全匹配）。\n- 存在与某个特定现代人（特别是操作者）的mtDNA完全匹配的序列，是污染的标志。\n\n我们根据既定原则和观察结果评估每个选项：\n- 选项A（异质性）：虽然异质性存在，但它通常表现为密切相关的变体，而不是两个完全不同的单倍型，其中一个还与现代操作者完全匹配。一个尼安德特人的次要异质性单倍型在一个高变区上与特定现代人的mtDNA完全匹配的概率小到可以忽略不计。这与观察到的与研究员完全匹配的情况不符。\n- 选项B（杂交）：mtDNA是严格的母系遗传；要让一个尼安德特人携带现代人类的mtDNA，其母系祖先必须是现代人。即使发生了这样的基因流，该mtDNA序列与当代研究员的单倍型（而不是一个相关的现代单倍型）完全匹配的几率也极小。此外，鉴于污染这一更简约的解释以及aDNA研究中污染的普遍性，称其为“确凿证据”在科学上是不合理的。\n- 选项C（PCR错误）：随机的PCR错配错误发生率很低，并且会产生零散的错配，而不是一个与研究员序列完全匹配的连贯单倍型。累积的随机错误将一个类似尼安德特人的单倍型转变为在整个扩增区域上与现代人完全匹配的概率小得几乎为零。\n- 选项D（趋同进化）：在一个高变区上，独立进化导致产生相同的mtDNA序列是极其不可能的，特别是要精确匹配操作研究员的序列。趋同进化无法合理解释在这种分辨率下完美的单倍型一致性。\n- 选项E（污染）：现代人类污染，特别是来自参与提取和PCR设置的人员的污染，是aDNA研究中一个众所周知且频繁出现的问题。单倍型M与首席研究员的mtDNA完全一致，这是指向在处理或操作过程中发生污染的直接、具体的证据。在同一次扩增中，一个类似尼安德特人的单倍型（N）和一个现代人类单倍型（M）共存，这正是污染会产生的结果。\n\n根据简约性原则和标准的aDNA质量控制逻辑，选项E是最科学合理的解释。", "answer": "$$\\boxed{E}$$", "id": "1468888"}, {"introduction": "仅仅怀疑污染的存在是不够的，古DNA科学家必须像侦探一样，利用证据来证实或排除它。幸运的是，古DNA携带了独特的“分子指纹”——因长期降解而产生的死后损伤（Post-Mortem Damage, PMD），这是现代DNA污染物所不具备的。这项练习 [@problem_id:5011615] 提供了一个真实的分析场景，你将学会如何综合利用PMD特征、线粒体与核DNA信息，来剖析复杂的混合信号，并就是否采纳这份宝贵的古代样本做出符合科学标准的判断。", "problem": "一份旧石器时代晚期的骨骼样本，使用标准的古DNA协议进行测序。线粒体DNA（mtDNA；线粒体脱氧核糖核酸）的平均覆盖深度约为$100\\times$，而核DNA的覆盖深度约为$0.8\\times$。死后损伤（Post-Mortem Damage, PMD）通过末端胞嘧啶到胸腺嘧啶的错配比例进行评估。许多研究表明，真正古老分子中的典型PMD比例相对于现代污染显著升高；对于此样本，你可以将末端位置的特征性损伤概率近似视为古代分子的$\\delta_{\\text{ancient}} \\approx 0.20$和现代分子的$\\delta_{\\text{modern}} \\approx 0.01$。\n\n对定义单倍群的mtDNA位点进行了探查。支持单倍群U诊断性等位基因的读段总数为$N_U = 1700$，其中$k_U = 425$个显示出末端PMD；而支持单倍群H诊断性等位基因的读段总数为$N_H = 1000$，其中$k_H = 10$个显示出末端PMD。在不进行损伤过滤的情况下构建的mtDNA共有序列判定为单倍群H，因为在所有诊断性位点上，支持H相容替换的总读段数更多。\n\n独立的核污染通过以下方式进行估计。遗传性别鉴定表明该个体为男性（$XY$），且根据X染色体表观杂合性得出的核污染估计值为$\\hat{c}_{\\text{nuc}} = 0.03$，其95%置信区间为$[0.01, 0.05]$。你可以假设污染分子主要是现代的，并且相对于内源性古分子，其PMD水平没有升高。\n\n仅从以下基本原理出发：\n- mtDNA是克隆性母系遗传的，单个个体应只携带一个mtDNA单倍群；在定义位点上出现不一致的单倍群信号意味着混合。\n- 古分子相对于现代污染表现出更高的PMD。\n- 在男性个体中，X染色体上的杂合性主要源于污染，因为内源性X染色体是半合子的。\n- 污染的作用相当于混合：观测到的等位基因频率反映了$(1 - c) \\times$内源性贡献加上$c \\times$污染性贡献。\n\n使用第一性原理进行推理，以调和不一致的mtDNA单倍群信号，并决定是否应将该样本从后续的群体遗传学分析中排除。选择唯一的最佳选项。\n\nA. 接受未经过损伤过滤的mtDNA共有序列为单倍群H，并将样本纳入所有后续分析，因为核污染估计值$\\hat{c}_{\\text{nuc}}$低于$0.05$。\n\nB. 根据损伤模式推断单倍群U代表内源性mtDNA，将单倍群H的读段视为现代污染，并保留该个体用于核DNA分析（最好使用经过PMD过滤的读段）。在报告前，排除或仅使用富含损伤的分子重新鉴定mtDNA单倍群。\n\nC. 将样本完全从所有分析中排除，因为mtDNA显示出污染证据，这使得mtDNA和核DNA信号都无效。\n\nD. 将单倍群U和H之间的不一致解释为个体内的异质性，并将两个mtDNA单倍群和所有核数据纳入后续分析，不进行特殊过滤。", "solution": "**推导过程**\n\n核心问题是存在支持两种不同线粒体DNA（mtDNA）单倍群（U和H）的读段。根据提供的第一个原则，单个个体应该只拥有一个mtDNA单倍群。因此，观察到两种单倍群是DNA来自至少两个不同个体混合的有力证据。问题要求我们确定这种混合的来源——具体来说，哪个信号是古代样本的内源信号，哪个来自污染。\n\n第二个原则指出，古分子相对于现代污染表现出更高的PMD。我们已知末端胞嘧啶到胸腺嘧啶错配的特征概率：古代DNA为$\\delta_{\\text{ancient}} \\approx 0.20$，现代DNA为$\\delta_{\\text{modern}} \\approx 0.01$。我们可以计算支持每个单倍群的读段的经验PMD比例。\n\n对于支持单倍群U等位基因的读段：\n- 总读段数：$N_U = 1700$。\n- 带有末端PMD的读段数：$k_U = 425$。\n- 经验PMD比例为 $\\hat{\\delta}_U = \\frac{k_U}{N_U} = \\frac{425}{1700} = 0.25$。\n\n对于支持单倍群H等位基因的读段：\n- 总读段数：$N_H = 1000$。\n- 带有末端PMD的读段数：$k_H = 10$。\n- 经验PMD比例为 $\\hat{\\delta}_H = \\frac{k_H}{N_H} = \\frac{10}{1000} = 0.01$。\n\n我们现在将这些经验比例与特征概率进行比较：\n- 支持U的读段的PMD比例 $\\hat{\\delta}_U = 0.25$，与古代DNA的期望值 $\\delta_{\\text{ancient}} \\approx 0.20$ 高度一致。\n- 支持H的读段的PMD比例 $\\hat{\\delta}_H = 0.01$，与现代DNA的期望值 $\\delta_{\\text{modern}} = 0.01$ 完全相同。\n\n这项分析提供了压倒性的证据，表明单倍群U的信号源自内源性的古代个体，而单倍群H的信号源自现代污染。因此，未经过损伤过滤的mtDNA共有序列判定为单倍群H是这种污染造成的人为结果，是错误的。\n\n接下来，我们考虑核DNA。问题提供了一个独立的核污染估计值，$\\hat{c}_{\\text{nuc}} = 0.03$（即$3\\%$），该值是根据该男性个体X染色体上的表观杂合性得出的。这是一种标准且可靠的方法。$3\\%$的污染水平被认为是低的，对于后续的群体遗传学分析通常是可以接受的，特别是对于来自旧石器时代晚期的稀有而珍贵的样本。mtDNA污染的存在并不会自动使核分析无效；事实上，由于各自基因组的拷贝数差异巨大，mtDNA污染水平与核污染水平不同，并且通常更高，这是很常见的。\n\n适当的做法是根据PMD证据修正mtDNA单倍群的判定，并在考虑已量化的低水平污染的情况下，继续进行核基因组的分析。\n\n**逐项分析选项**\n\nA. 接受未经过损伤过滤的mtDNA共有序列为单倍群H，并将样本纳入所有后续分析，因为核污染估计值$\\hat{c}_{\\text{nuc}}$低于$0.05$。\n这个选项存在根本性缺陷。它忽略了确凿的PMD证据，该证据明确将单倍群H信号识别为现代污染。接受未经过滤的共有序列判定是不严谨的科学实践。低的核污染估计值证明了使用核数据的合理性，而不是接受一个明显错误的mtDNA结果。\n**结论：不正确。**\n\nB. 根据损伤模式推断单倍群U代表内源性mtDNA，将单倍群H的读段视为现代污染，并保留该个体用于核DNA分析（最好使用经过PMD过滤的读段）。在报告前，排除或仅使用富含损伤的分子重新鉴定mtDNA单倍群。\n这个选项与我们的推导完全一致。它正确地使用PMD将单倍群U识别为内源性，将H识别为污染物。它正确地得出结论，即核DNA的污染率低且已量化为$\\hat{c}_{\\text{nuc}} = 0.03$，因此具有价值，应保留用于分析。建议对核分析使用经过PMD过滤的读段，并使用富含损伤的读段重新评估mtDNA单倍群，这两种做法都是古基因组学中减轻污染的标准最佳实践。\n**结论：正确。**\n\nC. 将样本完全从所有分析中排除，因为mtDNA显示出污染证据，这使得mtDNA和核DNA信号都无效。\n这个选项过于保守，表明对aDNA数据分析存在误解。虽然mtDNA信号受到污染，但核DNA的污染已被独立量化为低水平（$3\\%$）。存在处理这类数据的方法，不必要地丢弃一个稀有的旧石器时代晚期基因组将是重大损失。数据一部分（mtDNA）的污染不会自动使所有其他部分（核DNA）都变得无用，特别是当污染可以被表征和减轻时。\n**结论：不正确。**\n\nD. 将单倍群U和H之间的不一致解释为个体内的异质性，并将两个mtDNA单倍群和所有核数据纳入后续分析，不进行特殊过滤。\n这个选项提出了一个生物学上难以置信的解释。涉及两个系统发育上相距甚远的单倍群（U和H）以高比例（在此子集中，支持H的读段占总数的$\\frac{1000}{1700+1000} \\approx 37\\%$）共存的异质性，并非已知的生物学现象。真正的异质性通常是次要变异。关键的是，这种解释完全忽略了PMD模式的显著差异。如果真的是异质性，那么两个mtDNA谱系都应同样古老，并应表现出相似的高PMD率。数据明确驳斥了这一点。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "5011615"}, {"introduction": "除了污染，古DNA研究的另一项固有挑战是其信号微弱且高度片段化，导致测序深度通常很低。在数据稀疏的情况下，要准确判断一个个体的二倍体基因型（即究竟是纯合子还是杂合子）在统计上变得极为困难。这项练习 [@problem_id:5011595] 将引导你从第一性原理出发，推导这一不确定性背后的数学逻辑，并理解为何“伪单倍体”分型策略是处理低深度数据、确保群体遗传学推断稳健性的关键方法。", "problem": "古脱氧核糖核酸（aDNA）研究经常面临单个基因组位点测序覆盖度低的问题，这给二倍体基因型推断带来了挑战。考虑一个古人类基因组中真正杂合的单个双等位基因位点。假设覆盖该位点的 $c$ 条独立测序读段中的每一条都以 $1/2$ 的等概率抽样到两个等位基因中的一个，并且读段错误和比对偏差可以忽略不计，因此每条读段报告任一等位基因的概率恰好为 $1/2$。一个标准的杂合子检测规则是：如果观测到的次要等位基因频率位于区间 $\\left[\\tau, 1 - \\tau\\right]$（其中 $0  \\tau \\leq \\frac{1}{2}$）内，则将该位点判定为杂合；否则，判定为纯合。等价地，如果 $X$ 是支持某个任意标记的等位基因的读段数，则仅当 $X \\in \\{t, t+1, \\dots, c - t\\}$ 时，该位点才被判定为杂合，其中 $t = \\lceil \\tau c \\rceil$ 是所需的最小次要等位基因计数。\n\n从二项抽样模型和上述决策规则的定义出发，推导预期错误率的闭式表达式（用 $c$ 和 $\\tau$ 表示）。此处的预期错误率定义为：在该规则下一个真正的杂合位点被错误判定为纯合的概率。请将你的最终答案表示为仅包含 $c$ 和 $\\tau$ 的单个解析表达式。无需进行数值计算。\n\n然后，利用推导出的表达式并从第一性原理进行推理，解释为什么在低覆盖度的古基因组中，伪单倍体判定（每个位点随机选择一条读段来代表等位基因状态）是下游群体遗传学分析的首选方法。你的解释必须基于在上述二倍体判定规则下，低 $c$ 值对杂合子错判概率造成的影响。除已推导的表达式外，不应引入其他公式。", "solution": "该问题要求完成两部分：首先，推导一个真正的杂合位点被错误判定为纯合的概率的闭式表达式；其次，基于此表达式解释在低覆盖度古DNA（aDNA）研究中使用伪单倍体判定的基本原理。\n\n设真正的杂合位点上的两个等位基因为 $A_1$ 和 $A_2$。我们已知有 $c$ 条独立的测序读段覆盖此位点。对于每条读段，抽样到等位基因 $A_1$ 的概率为 $1/2$，抽样到等位基因 $A_2$ 的概率也为 $1/2$，因为错误和偏差被认为可以忽略不计。\n\n设 $X$ 为代表支持等位基因 $A_1$ 的读段数的随机变量。剩下的 $c-X$ 条读段将支持等位基因 $A_2$。在给定假设下，$X$ 服从试验次数为 $c$、成功概率为 $p=1/2$ 的二项分布。$X$ 的概率质量函数（PMF）由下式给出：\n$$P(X=k) = \\binom{c}{k} \\left(\\frac{1}{2}\\right)^k \\left(1-\\frac{1}{2}\\right)^{c-k} = \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c$$\n对于 $k \\in \\{0, 1, 2, \\dots, c\\}$。\n\n决策规则规定，如果一个等位基因的读段数 $X$ 落在 $\\{t, t+1, \\dots, c-t\\}$ 范围内，则该位点被判定为杂合，其中 $t = \\lceil \\tau c \\rceil$。参数 $\\tau$ 是最小次要等位基因频率阈值，满足 $0  \\tau \\leq 1/2$。\n\n如问题中所定义，当一个真正的杂合位点被错误判定为纯合时，就会发生错误。这种情况发生在不满足杂合子判定的条件时。因此，错误判定的事件对应于 $X$ 落在指定范围之外。导致纯合判定的 $X$ 的结果集合为 $\\{0, 1, \\dots, t-1\\} \\cup \\{c-t+1, c-t+2, \\dots, c\\}$。\n\n这个错误事件的概率，我们记为 $P(\\text{error})$，是这些结果概率的总和：\n$$P(\\text{error}) = P(X \\leq t-1) + P(X \\geq c-t+1)$$\n我们可以将这些概率表示为PMF的和：\n$$P(\\text{error}) = \\sum_{k=0}^{t-1} P(X=k) + \\sum_{k=c-t+1}^{c} P(X=k)$$\n代入二项PMF：\n$$P(\\text{error}) = \\sum_{k=0}^{t-1} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c + \\sum_{k=c-t+1}^{c} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c$$\n当 $p=1/2$ 时，二项分布是对称的，这意味着 $P(X=k) = P(X=c-k)$，因为 $\\binom{c}{k} = \\binom{c}{c-k}$。我们可以证明这两个和的对称性。让我们在第二个和中进行索引变换。令 $j = c-k$。当 $k$ 从 $c-t+1$ 变到 $c$ 时，新索引 $j$ 从 $c-(c-t+1) = t-1$ 降到 $c-c = 0$。\n$$\\sum_{k=c-t+1}^{c} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c = \\sum_{j=0}^{t-1} \\binom{c}{c-j} \\left(\\frac{1}{2}\\right)^c = \\sum_{j=0}^{t-1} \\binom{c}{j} \\left(\\frac{1}{2}\\right)^c$$\n这表明第二个和等于第一个和，即 $P(X \\geq c-t+1) = P(X \\leq t-1)$。\n因此，总错误概率可以简化为：\n$$P(\\text{error}) = 2 \\times P(X \\leq t-1) = 2 \\sum_{k=0}^{t-1} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c$$\n我们可以将常数项 $(1/2)^c$ 从求和中提取出来：\n$$P(\\text{error}) = 2 \\left(\\frac{1}{2}\\right)^c \\sum_{k=0}^{t-1} \\binom{c}{k} = 2^{1-c} \\sum_{k=0}^{t-1} \\binom{c}{k}$$\n用 $c$ 和 $\\tau$ 的定义替换 $t$，我们得到错误率的最终闭式表达式：\n$$P(\\text{error}) = 2^{1-c} \\sum_{k=0}^{\\lceil \\tau c \\rceil - 1} \\binom{c}{k}$$\n该表达式表示观测到的次要等位基因读段数小于阈值 $t$ 的概率，乘以2是为了说明两个等位基因都可能成为次要等位基因。\n\n对于任务的第二部分，我们必须使用此表达式来解释在低覆盖度aDNA中偏好使用伪单倍体判定的原因。\n\naDNA研究中的低覆盖度意味着覆盖任何给定基因位点的读段数 $c$ 很小。推导出的表达式 $P(\\text{error}) = 2^{1-c} \\sum_{k=0}^{\\lceil \\tau c \\rceil - 1} \\binom{c}{k}$ 揭示了小 $c$ 值的后果。该求和项代表了二项抽样分布极端尾部的累积概率。当 $c$ 很小时，随机抽样方差很大。这意味着即使在一个真正的杂合位点，也很可能随机抽样到仅代表两个等位基因之一的读段（例如 $X=0$ 或 $X=c$），或者等位基因的比例高度偏斜。\n\n二倍体判定规则要求观测到最小数量的次要等位基因，即 $t = \\lceil \\tau c \\rceil$。对于低 $c$ 值，很难满足这个标准。例如，如果覆盖度 $c=2$ 且阈值 $\\tau=1/3$，则 $t = \\lceil 2/3 \\rceil = 1$。如果 $X=0$ 或 $X=2$，该位点就被判定为纯合。错误概率为 $P(\\text{error}) = 2^{1-2}\\sum_{k=0}^{0} \\binom{2}{k} = (1/2)\\binom{2}{0} = 1/2$。50%的错误率是极高的。如果覆盖度为 $c=1$，则不可能满足任何 $t \\ge 1$ 的次要等位基因阈值，因此错误率为1，意味着所有杂合子都被错误判定。\n\n推导出的表达式将这种直觉形式化：对于小的 $c$，求和项 $\\sum_{k=0}^{t-1} \\binom{c}{k}$ 与前置因子 $2^{1-c}$ 相结合，导致 $P(\\text{error})$ 的值很大。这种将真正的杂合子系统性地错判为纯合子的情况，会给下游分析带来严重的偏差。它会导致对杂合度和遗传多样性的显著低估，进而使群体分化、亲缘关系和其他关键群体遗传学统计量的估计产生偏差。\n\n伪单倍体判定是减轻这种偏差的一种策略。该方法不是尝试进行二倍体基因型判定（这在低覆盖度下极易出错），而是在每个位点随机选择一条读段来代表等位基因。在一个真正的杂合位点，此过程以各 $1/2$ 的概率正确地抽样到两个等位基因中的一个。虽然这种方法舍弃了关于个体在特定位点杂合性的信息，但它提供了来自该个体基因组的无偏的等位基因样本。当来自许多位点或许多个体的数据被汇总时，得到的等位基因频率不会系统性地偏向纯合性。这使得数据对于群体水平的推断更加可靠，因为在这些推断中，准确的等位基因频率估计比准确的个体二倍体基因分型更为关键。因此，由我们推导的表达式量化的、在低 $c$ 值下很高的杂合子错判概率，是低覆盖度aDNA研究中偏好使用偏差较小的伪单倍体方法的根本原因。", "answer": "$$\n\\boxed{2^{1-c} \\sum_{k=0}^{\\lceil \\tau c \\rceil - 1} \\binom{c}{k}}\n$$", "id": "5011595"}]}