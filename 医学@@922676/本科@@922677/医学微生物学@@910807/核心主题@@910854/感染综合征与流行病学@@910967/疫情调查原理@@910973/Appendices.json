{"hands_on_practices": [{"introduction": "调查的第一步是确定病例的异常增加是否构成真正的暴发，或者仅仅是随机波动。公共卫生机构使用统计过程控制图等工具进行常规监测。本练习 [@problem_id:4667641] 将让你实践应用一个简单而强大的阈值规则，来判断病例数是否已超过临界值。", "problem": "在一个监测肠道沙门氏菌（*Salmonella enterica*）的市政公共卫生实验室监测项目中，每周的确诊病例数被用来检测与疾病暴发相符的异常情况。考虑一个系统稳定的基线期：每周的计数是独立的，并且来自一个具有恒定均值和方差的平稳过程。对足够长的基线期的历史分析表明，平均每周计数为 $\\mu = 12$ 例，方差为 $\\sigma^{2} = 25$ 例²。最近三周期间观测到的每周病例数分别为 $20$、$28$ 和 $31$ 例。假设在这几周内没有季节性或报告漂移，并且病例数围绕基线均值近似服从正态分布，其方差等于历史方差。\n\n应用于暴发调查中的统计过程控制原理，采用一种单边 Shewhart 型决策规则，当某一周的观测计数超过一个由基线均值加上三倍基线标准差定义的上控制阈值时，该周被分类为一个信号。如果在这三周的窗口期内至少发生一个周信号，则将这三周期间归类为一次暴发。\n\n计算并将此决策规则应用于上述数据。如果根据此规则，该三周期间符合暴发条件，则用数字 $1$ 表示最终决策，否则用 $0$ 表示。最终答案仅提供这一个数字。", "solution": "该问题要求将一个指定的统计过程控制规则应用于一系列每周病例数，以确定是否发生了暴发。该决策将用一个数字指标表示。\n\n首先，我们根据问题陈述确定统计过程控制模型的参数。基线过程的特征是平均每周计数 $\\mu$ 和方差 $\\sigma^2$。\n给定值为：\n-   均值：$\\mu = 12$\n-   方差：$\\sigma^2 = 25$\n\n从方差我们可以计算出标准差 $\\sigma$，即方差的平方根。\n$$\n\\sigma = \\sqrt{\\sigma^2} = \\sqrt{25} = 5\n$$\n\n问题定义了一个单边 Shewhart 型决策规则。如果某一周的观测计数超过一个上控制阈值（也称为上控制限，UCL），则该周被归类为一个“信号”。该阈值定义为基线均值加上三倍的基线标准差。\n$$\n\\text{UCL} = \\mu + 3\\sigma\n$$\n\n代入给定的 $\\mu$ 值和计算出的 $\\sigma$ 值：\n$$\n\\text{UCL} = 12 + 3(5) = 12 + 15 = 27\n$$\n因此，任何大于 $27$ 的周计数都构成一个潜在异常的信号。\n\n接下来，我们检查最近三周期间的观测数据。设第1周、第2周和第3周的观测计数分别用 $X_1$、$X_2$ 和 $X_3$ 表示。\n-   $X_1 = 20$\n-   $X_2 = 28$\n-   $X_3 = 31$\n\n我们将这些观测值逐个与计算出的UCL值 $27$进行比较，以应用决策规则。\n-   对于第1周：$X_1 = 20$。由于 $20 \\le 27$，该观测值未超过UCL。本周未产生信号。\n-   对于第2周：$X_2 = 28$。由于 $28 > 27$，该观测值超过了UCL。本周产生了一个信号。\n-   对于第3周：$X_3 = 31$。由于 $31 > 27$，该观测值超过了UCL。本周也产生了一个信号。\n\n问题规定，如果在这三周窗口期内至少出现一个周信号，则整个三周期间被归类为一次暴发。在我们的分析中，我们在第2周和第3周发现了信号。由于“至少一个”信号的条件得到满足，因此该三周期间被归类为一次暴发。\n\n最后，问题要求用数字来表达此决策，其中 $1$ 表示暴发，$0$ 表示无暴发。根据我们的分析，该期间符合暴发条件。因此，对应的数值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "4667641"}, {"introduction": "一旦宣布暴发，调查人员必须找出源头。这通常涉及比较接触过可疑源头的人与未接触过的人之间的发病率。本练习 [@problem_id:4667575] 模拟了一项队列研究，这是在固定人群中进行暴发调查的常用设计，并让你练习计算相对风险。它还探讨了一个重要的现实挑战：如何校正因回忆偏差等造成的数据不准确性。", "problem": "在一个高级本科医学微生物学研讨会上，100名与会者中爆发了急性肠胃炎。为了评估午餐中提供的两种可疑食物暴露——暴露 $A$（鸡肉沙拉）和暴露 $B$（奶油甜点），进行了一项快速队列研究。病例名单被整理和统计如下。\n\n对于暴露 $A$：在报告食用了鸡肉沙拉的 $60$ 人中，有 $24$ 人在餐后 $48$ 小时内符合暴发病例定义；在未食用鸡肉沙拉的 $40$ 人中，有 $8$ 人符合病例定义。对于暴露 $B$：在报告食用了奶油甜点的 $30$ 人中，有 $15$ 人符合病例定义；在未食用奶油甜点的 $70$ 人中，有 $17$ 人符合病例定义。\n\n一项使用直接厨房供应记录的验证性子研究表明，对于暴露 $A$，自我报告的食物消费情况存在非差异性错分，其灵敏度为 $0.85$，特异度为 $0.90$，且与疾病状态无关。假设上述报告的队列计数是内部一致的，并且没有失访。\n\n使用医学微生物学中暴发调查和队列分析的基本原则——即风险（罹患率）、相对风险和归因风险的定义——执行以下操作：\n\n1. 对于每种暴露（$A$ 和 $B$），计算暴露组和非暴露组的罹患率、相对风险和归因风险（风险差）。\n2. 在给定的非差异性错分参数下，对暴露 $A$ 进行敏感性分析以校正相对风险，将观察到的自我报告暴露视为真实暴露的一种错分测量。使用按疾病状态分层的队列来估计真实暴露和真实非暴露的校正计数，然后重新计算校正后的罹患率和校正后的相对风险。\n\n仅报告步骤 $2$ 中暴露 $A$ 的校正后相对风险作为你的最终答案。将最终数值答案四舍五入至四位有效数字，并以无单位数的形式表示。", "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 队列总人数：$N = 100$。\n- 暴露 $A$（鸡肉沙拉）：\n  - 食用：$60$ 人。\n  - 食用者中患病：$24$ 人。\n  - 未食用：$40$ 人。\n  - 未食用者中患病：$8$ 人。\n- 暴露 $B$（奶油甜点）：\n  - 食用：$30$ 人。\n  - 食用者中患病：$15$ 人。\n  - 未食用：$70$ 人。\n  - 未食用者中患病：$17$ 人。\n- 暴露 $A$ 的错分参数（非差异性）：\n  - 自我报告的灵敏度（$Se$）：$0.85$。这是在真实暴露的情况下报告暴露的概率，$P(\\text{报告暴露} | \\text{真实暴露}) = 0.85$。\n  - 自我报告的特异度（$Sp$）：$0.90$。这是在真实未暴露的情况下报告未暴露的概率，$P(\\text{报告未暴露} | \\text{真实未暴露}) = 0.90$。\n- 任务是：\n  1. 计算两种暴露的粗罹患率、相对风险和归因风险。\n  2. 在考虑错分后，计算暴露 $A$ 的校正后相对风险。\n  3. 仅报告暴露 $A$ 的校正后相对风险，四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于队列研究、暴发调查和暴露错分定量校正的标准流行病学原理。这些是医学微生物学和公共卫生领域的成熟方法。\n- **适定性**：该问题提供了计算粗关联度量和校正后关联度量的所有必要数据。按疾病状态分层进行校正的指令是一种标准且有效的方法。只要错分不是极端到使校正矩阵奇异（即 $Se + Sp - 1 \\neq 0$），问题的代数结构保证了唯一、稳定解的存在。这里，$Se+Sp-1 = 0.85+0.90-1 = 0.75 \\neq 0$。\n- **客观性**：问题以精确、定量的术语陈述。没有主观或模棱两可的陈述。\n- **内部一致性**：队列总规模为 $100$。对于暴露 A，$60+40=100$。总病例数为 $24+8=32$。对于暴露 B，$30+70=100$。总病例数为 $15+17=32$。计数是内部一致的。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供完整的解答。\n\n### 解答\n\n按要求，分析分两部分进行。首先，对两种暴露基于自我报告的数据进行粗分析。其次，进行敏感性分析以校正暴露 A 的暴露错分。\n\n队列研究的基本度量是：\n- **罹患率 (AR)**：一组人中患病个体的比例。它是一种风险度量。$AR = \\frac{\\text{患病人数}}{\\text{组内总人数}}$。\n- **相对风险 (RR)**：暴露组的罹患率（$AR_{exp}$）与非暴露组的罹患率（$AR_{unexp}$）之比。$RR = \\frac{AR_{exp}}{AR_{unexp}}$。\n- **归因风险 (AR_diff)**：也称为风险差，是暴露组和非暴露组之间罹患率的差异。$AR_{diff} = AR_{exp} - AR_{unexp}$。\n\n**第 1 部分：基于自我报告数据的粗分析**\n\n我们根据报告的暴露和结局构建 $2 \\times 2$ 四格表。让撇号（例如，$AR'$）表示基于观察到的（有错分的）数据的度量。\n\n**对于暴露 A（鸡肉沙拉）：**\n观察数据可列表如下：\n| | 患病 | 未患病 | 总计 |\n| :--- | :---: | :---: | :---: |\n| **报告暴露** | $24$ | $60-24=36$ | $60$ |\n| **报告未暴露** | $8$ | $40-8=32$ | $40$ |\n| **总计** | $32$ | $68$ | $100$ |\n\n- 报告暴露组的罹患率（$AR'_{A,exp}$）：\n$$ AR'_{A,exp} = \\frac{24}{60} = 0.4 $$\n- 报告未暴露组的罹患率（$AR'_{A,unexp}$）：\n$$ AR'_{A,unexp} = \\frac{8}{40} = 0.2 $$\n- 粗相对风险（$RR'_A$）：\n$$ RR'_A = \\frac{AR'_{A,exp}}{AR'_{A,unexp}} = \\frac{0.4}{0.2} = 2.0 $$\n- 粗归因风险（$AR'_{diff,A}$）：\n$$ AR'_{diff,A} = AR'_{A,exp} - AR'_{A,unexp} = 0.4 - 0.2 = 0.2 $$\n\n**对于暴露 B（奶油甜点）：**\n观察数据可列表如下：\n| | 患病 | 未患病 | 总计 |\n| :--- | :---: | :---: | :---: |\n| **报告暴露** | $15$ | $30-15=15$ | $30$ |\n| **报告未暴露** | $17$ | $70-17=53$ | $70$ |\n| **总计** | $32$ | $68$ | $100$ |\n\n- 报告暴露组的罹患率（$AR'_{B,exp}$）：\n$$ AR'_{B,exp} = \\frac{15}{30} = 0.5 $$\n- 报告未暴露组的罹患率（$AR'_{B,unexp}$）：\n$$ AR'_{B,unexp} = \\frac{17}{70} \\approx 0.2429 $$\n- 粗相对风险（$RR'_B$）：\n$$ RR'_B = \\frac{AR'_{B,exp}}{AR'_{B,unexp}} = \\frac{15/30}{17/70} = \\frac{1}{2} \\cdot \\frac{70}{17} = \\frac{35}{17} \\approx 2.059 $$\n- 粗归因风险（$AR'_{diff,B}$）：\n$$ AR'_{diff,B} = AR'_{B,exp} - AR'_{B,unexp} = \\frac{1}{2} - \\frac{17}{70} = \\frac{35-17}{70} = \\frac{18}{70} = \\frac{9}{35} \\approx 0.2571 $$\n\n**第 2 部分：对暴露 A 的校正分析**\n\n我们使用给定的暴露报告灵敏度（$Se=0.85$）和特异度（$Sp=0.90$）来校正暴露 A 的计数。非差异性错分意味着这些参数在不同疾病状态分层中是恒定的。让撇号表示观察计数（例如，$a'$），无符号表示真实计数（例如，$a$）。\n\n观察计数为：\n- $a'$（患病，报告暴露）= $24$\n- $b'$（未患病，报告暴露）= $36$\n- $c'$（患病，报告未暴露）= $8$\n- $d'$（未患病，报告未暴露）= $32$\n\n按疾病状态分层后，观察计数与真实计数之间的关系如下：\n$a' = a \\cdot Se + c \\cdot (1-Sp)$\n$c' = a \\cdot (1-Se) + c \\cdot Sp$\n对于非病例：\n$b' = b \\cdot Se + d \\cdot (1-Sp)$\n$d' = b \\cdot (1-Se) + d \\cdot Sp$\n\n**分层 1：患病个体（病例）**\n总病例数 = $a'+c' = 24+8=32$。真实患病人数 $a+c$ 也必须等于 $32$。我们有以下方程组：\n$$ 24 = a \\cdot (0.85) + c \\cdot (1-0.90) = 0.85a + 0.10c $$\n$$ 8 = a \\cdot (1-0.85) + c \\cdot (0.90) = 0.15a + 0.90c $$\n这是一个关于两个变量 $a$ 和 $c$ 的二元一次方程组。我们可以解这个方程组。例如，使用从矩阵求逆导出的公式：\n$$ a = \\frac{a'Sp - c'(1-Sp)}{Se+Sp-1} = \\frac{24(0.90) - 8(0.10)}{0.85+0.90-1} = \\frac{21.6 - 0.8}{0.75} = \\frac{20.8}{0.75} = \\frac{83.2}{3} \\approx 27.733 $$\n真实患病且未暴露的人数 $c$ 是：\n$$ c = 32 - a = 32 - \\frac{83.2}{3} = \\frac{96 - 83.2}{3} = \\frac{12.8}{3} \\approx 4.267 $$\n\n**分层 2：未患病个体（非病例）**\n非病例总数 = $b'+d' = 36+32=68$。真实未患病人数 $b+d$ 也必须等于 $68$。\n$$ 36 = b \\cdot (0.85) + d \\cdot (0.10) = 0.85b + 0.10d $$\n$$ 32 = b \\cdot (0.15) + d \\cdot (0.90) = 0.15b + 0.90d $$\n求解 $b$：\n$$ b = \\frac{b'Sp - d'(1-Sp)}{Se+Sp-1} = \\frac{36(0.90) - 32(0.10)}{0.75} = \\frac{32.4 - 3.2}{0.75} = \\frac{29.2}{0.75} = \\frac{116.8}{3} \\approx 38.933 $$\n真实未患病且未暴露的人数 $d$ 是：\n$$ d = 68 - b = 68 - \\frac{116.8}{3} = \\frac{204 - 116.8}{3} = \\frac{87.2}{3} \\approx 29.067 $$\n\n现在，我们用真实计数构建校正后的 $2 \\times 2$ 四格表：\n| | 真实暴露 ($E_1$) | 真实未暴露 ($E_0$) | 总计 |\n| :--- | :---: | :---: | :---: |\n| **患病 ($D_1$)** | $a = 27.733...$ | $c = 4.267...$ | $32$ |\n| **未患病 ($D_0$)** | $b = 38.933...$ | $d = 29.067...$ | $68$ |\n| **总计** | $N_{E1} = 66.667...$ | $N_{E0} = 33.333...$ | $100$ |\n\n真实暴露总数：$N_{E1} = a+b = \\frac{83.2}{3} + \\frac{116.8}{3} = \\frac{200}{3}$。\n真实未暴露总数：$N_{E0} = c+d = \\frac{12.8}{3} + \\frac{87.2}{3} = \\frac{100}{3}$。\n\n现在我们可以计算校正后的罹患率和相对风险。\n- 暴露组的校正后罹患率（$AR_{A,exp}$）：\n$$ AR_{A,exp} = \\frac{a}{N_{E1}} = \\frac{83.2/3}{200/3} = \\frac{83.2}{200} = 0.416 $$\n- 未暴露组的校正后罹患率（$AR_{A,unexp}$）：\n$$ AR_{A,unexp} = \\frac{c}{N_{E0}} = \\frac{12.8/3}{100/3} = \\frac{12.8}{100} = 0.128 $$\n- 暴露 A 的校正后相对风险（$RR_{A,corr}$）：\n$$ RR_{A,corr} = \\frac{AR_{A,exp}}{AR_{A,unexp}} = \\frac{0.416}{0.128} = 3.25 $$\n暴露 A 的校正后相对风险为 $3.25$。正如非差异性错分的典型情况一样，粗相对风险 $2.0$ 偏向于无效值 $1.0$。\n\n最终答案必须报告为四位有效数字。数值 $3.25$ 是精确值，可以写成 $3.250$ 以满足要求。", "answer": "$$\n\\boxed{3.250}\n$$", "id": "4667575"}, {"introduction": "有时，确定整个受影响人群（队列）很困难，调查人员会转而使用病例对照研究，比较患病者（病例）和未患病者（对照）的暴露情况。为提高准确性，病例和对照通常会根据关键特征进行匹配。本练习 [@problem_id:4667601] 演示了如何计算匹配比值比，这是这种强大研究设计中的关键关联性度量，其计算巧妙地仅利用了能提供信息的研究配对。", "problem": "在一次侵袭性单核细胞增生李斯特菌（Listeria monocytogenes）感染群集的调查中，流行病学家进行了一项一对一匹配的病例-对照研究，采用家庭匹配以控制共用食品储藏室和备餐习惯。针对一个假定的传播媒介——某特定品牌的新鲜软奶酪，每个家庭都提供了一名实验室确诊的病例和一名按家庭匹配的未患病对照。设二元暴露为在病例病症发作前一周内食用该特定品牌的奶酪。在这些匹配对中，获得了以下计数：在 $22$ 对中，病例暴露而对照未暴露；在 $5$ 对中，病例未暴露而对照暴露；在 $15$ 对中，两者均暴露；在 $16$ 对中，两者均未暴露。假设各对之间独立，对内的暴露分类准确，且标准的大样本近似适用。仅使用比值（odds）和比值比（odds ratio）的核心定义以及适用于一对一匹配病例-对照数据的条件方法，计算特定品牌奶酪消费与李斯特菌病之间关联的匹配比值比，然后使用对数匹配比值比的正态近似，在比值比尺度上推导置信水平为 $0.95$ 的双侧置信区间。在您自己的计算中，仅在完成代数运算后对所有报告的中间结果进行四舍五入；对于最终提交的结果，请四舍五入至三位有效数字。为便于评分，仅提交置信水平为 $0.95$ 的置信区间的下限，形式为无单位的纯小数。", "solution": "该调查旨在通过一对一匹配的病例-对照研究设计来量化二元暴露与疾病之间的关联。在匹配设计下，合适的估计量是匹配比值比，它通过条件似然来定义。条件似然以匹配集为条件，并消除了与每对特定基线风险相关的滋扰参数。设真实的匹配比值比为 $\\psi$。根据定义，对于只有一个成员暴露的不一致对，病例是暴露成员的条件概率为\n$$\nP(\\text{case is exposed} \\mid \\text{discordant pair}) \\;=\\; \\frac{\\psi}{1+\\psi}.\n$$\n如果有 $b$ 对结构为（病例暴露，对照未暴露）的不一致对，以及 $c$ 对结构为（病例未暴露，对照暴露）的不一致对，那么在总不一致对数 $b+c$ 的条件下，计数 $b$ 服从成功概率为 $\\psi/(1+\\psi)$ 的二项分布。条件对数似然在以下情况时最大化\n$$\n\\frac{b}{b+c} \\;=\\; \\frac{\\psi}{1+\\psi},\n$$\n由此可得匹配比值比的最大似然估计量，\n$$\n\\hat{\\psi} \\;=\\; \\frac{b}{c}.\n$$\n只有不一致对才提供关于 $\\psi$ 的信息；两者都暴露或都未暴露的一致对对条件似然不提供任何信息。\n\n根据所提供的数据，病例暴露的不一致对数量为 $b=22$，病例未暴露的不一致对数量为 $c=5$。因此，估计的匹配比值比为\n$$\n\\hat{\\psi} \\;=\\; \\frac{22}{5} \\;=\\; 4.4.\n$$\n\n为了在比值比尺度上构建置信水平为 $0.95$ 的双侧置信区间，一种标准的大样本方法是利用估计量对数的近似正态性。具体来说，在条件似然下，$\\ln(\\hat{\\psi})$ 的渐近标准误是\n$$\n\\operatorname{SE}\\big(\\ln(\\hat{\\psi})\\big) \\;=\\; \\sqrt{\\frac{1}{b}+\\frac{1}{c}}.\n$$\n在对数尺度上的 $0.95$ 置信区间由下式给出\n$$\n\\ln(\\hat{\\psi}) \\;\\pm\\; z_{1-0.05/2}\\,\\operatorname{SE}\\big(\\ln(\\hat{\\psi})\\big),\n$$\n其中 $z_{1-0.05/2}=1.96$ 是双侧 $0.95$ 置信水平的标准正态分位数。对端点取指数可将区间转换回比值比尺度。\n\n我们现在逐步计算所需的量，在代入数值前保持计算的符号形式：\n\n1. 计算点估计：\n$$\n\\hat{\\psi} \\;=\\; \\frac{b}{c} \\;=\\; \\frac{22}{5} \\;=\\; 4.4.\n$$\n\n2. 计算点估计的对数：\n$$\n\\ln(\\hat{\\psi}) \\;=\\; \\ln\\!\\left(\\frac{22}{5}\\right) \\;=\\; \\ln(22) - \\ln(5).\n$$\n数值上，这等于\n$$\n\\ln(\\hat{\\psi}) \\approx 1.481604540.\n$$\n\n3. 计算对数尺度上的标准误：\n$$\n\\operatorname{SE}\\big(\\ln(\\hat{\\psi})\\big) \\;=\\; \\sqrt{\\frac{1}{22}+\\frac{1}{5}} \\;=\\; \\sqrt{\\frac{5+22}{110}} \\;=\\; \\sqrt{\\frac{27}{110}} \\;=\\; \\sqrt{0.245454545\\ldots}.\n$$\n数值上，\n$$\n\\operatorname{SE}\\big(\\ln(\\hat{\\psi})\\big) \\approx 0.495434028.\n$$\n\n4. 使用 $z=1.96$ 构成对数尺度上的 $0.95$ 置信区间：\n$$\n\\text{Lower log bound} \\;=\\; \\ln(\\hat{\\psi}) - 1.96 \\times \\operatorname{SE}\\big(\\ln(\\hat{\\psi})\\big)\n\\\\\n\\text{Upper log bound} \\;=\\; \\ln(\\hat{\\psi}) + 1.96 \\times \\operatorname{SE}\\big(\\ln(\\hat{\\psi})\\big).\n$$\n计算边际误差：\n$$\n1.96 \\times 0.495434028 \\approx 0.971050640.\n$$\n因此，\n$$\n\\text{Lower log bound} \\approx 1.481604540 - 0.971050640 \\approx 0.510553900,\n$$\n$$\n\\text{Upper log bound} \\approx 1.481604540 + 0.971050640 \\approx 2.452655180.\n$$\n\n5. 取指数以返回到比值比尺度：\n$$\n\\text{Lower bound} \\;=\\; \\exp(0.510553900) \\approx 1.666216,\n$$\n$$\n\\text{Upper bound} \\;=\\; \\exp(2.452655180) \\approx 11.6206.\n$$\n\n因此，匹配比值比为 $\\hat{\\psi}=4.4$，在比值比尺度上的近似 $0.95$ 置信区间约为 $(1.666216,\\;11.6206)$。按要求，我们仅提交置信水平为 $0.95$ 的置信区间的下限，四舍五入至三位有效数字：\n$$\n1.67.\n$$", "answer": "$$\\boxed{1.67}$$", "id": "4667601"}]}