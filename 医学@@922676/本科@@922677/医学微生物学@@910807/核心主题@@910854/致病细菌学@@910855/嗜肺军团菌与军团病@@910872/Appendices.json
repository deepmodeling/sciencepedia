{"hands_on_practices": [{"introduction": "军团菌致病能力的一个关键特征是其在宿主肺泡巨噬细胞内生存和繁殖的能力。通过对这种指数级增长进行建模，我们可以理解为何即使最初的感染菌量很小，疾病也能迅速发展。这个练习将让您亲手应用细菌生长的数学原理来分析这一重要的致病过程，并计算细菌数量达到裂解宿主细胞的临界值所需的时间 [@problem_id:4644982]。", "problem": "一个实验室用 Legionella pneumophila 感染人单核细胞衍生的巨噬细胞。在时间 $t=0$ (小时)，每个巨噬细胞含有 $N_{0}=10$ 个胞内细菌。在营养充足的 $37\\,\\mathrm{^\\circ C}$ 培养条件下，胞内复制通过二分裂方式进行，其代时（倍增时间）恒定为 $g=4$ 小时。假设胞内环境是一个封闭的隔室，没有细菌的流入或流出，没有免疫杀伤，并且在宿主细胞破裂前代时不变。定义宿主细胞裂解的起始时间为胞内细菌数量首次达到阈值 $N_{\\mathrm{lysis}}=1000$ 个细菌/巨噬细胞的时刻。\n\n从二分裂和指数增长的核心定义出发，并且不使用任何预先给出的增长公式，完成以下任务：\n- 推导胞内细菌数量 $N(t)$ 作为时间 $t$ 的函数表达式，该表达式应包含 $N_{0}$ 和 $g$。\n- 使用你的表达式，计算 $t=24$ 小时时的胞内细菌数量 $N(24)$。\n- 求解达到裂解起始点的时间 $t_{\\mathrm{lysis}}$，该时间由 $N(t_{\\mathrm{lysis}})=N_{\\mathrm{lysis}}$ 定义。\n\n将最终数值答案表示为以小时 (h) 为单位的 $t_{\\mathrm{lysis}}$ 值，并四舍五入到四位有效数字。在最终的方框答案中不要包含单位。你可以在计算过程中将 $N(24)$ 表示为一个精确整数，但为了评分，仅报告以小时为单位且四舍五入到四位有效数字的 $t_{\\mathrm{lysis}}$。", "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n问题陈述中提供了以下数据和条件：\n- 宿主细胞：人单核细胞衍生的巨噬细胞\n- 细菌：*Legionella pneumophila*\n- 初始胞内细菌数量（时间 $t=0$ 时）：$N_{0}=10$\n- 生长机制：二分裂\n- 代时（倍增时间）：$g=4$ 小时\n- 培养温度：$37\\,\\mathrm{^\\circ C}$\n- 系统假设：封闭的胞内隔室，无细菌流入或流出，无免疫杀伤，代时恒定。\n- 裂解阈值：每个巨噬细胞 $N_{\\mathrm{lysis}}=1000$ 个细菌\n- 任务 1：推导 $N(t)$ 关于 $N_0$ 和 $g$ 的表达式。\n- 任务 2：计算 $t=24$ 小时时的胞内细菌数量 $N(24)$。\n- 任务 3：求解达到裂解起始点的时间 $t_{\\mathrm{lysis}}$，其中 $N(t_{\\mathrm{lysis}})=N_{\\mathrm{lysis}}$。\n- 最终答案要求：报告四舍五入到四位有效数字的 $t_{\\mathrm{lysis}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据**：该问题基于已确立的微生物生长原理，特别是 *Legionella pneumophila* 在宿主巨噬细胞内的指数增长。给定的参数（$N_0=10$，$g=4$ 小时，$N_{\\mathrm{lysis}}=1000$）对于这类胞内感染模型在生物学上是合理的。该情景是医学微生物学和传染病模型中使用的标准表示。\n- **适定性**：该问题是适定的。它提供了清晰的初始条件、明确的增长规律和特定的终点。这些要素足以确定所求量的一个唯一、稳定且有意义的解。\n- **客观性**：问题以精确、定量和客观的语言陈述，没有歧义或主观论断。\n\n基于此分析，该问题在科学上是合理的，内容是自洽的，并且定义明确。它不违反任何无效标准。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将推导解答。\n\n### 解答推导\n\n**第 1 部分：推导胞内细菌数量 $N(t)$**\n\n问题要求从二分裂的核心定义推导增长方程。在二分裂中，一个细菌分裂成两个。代时 $g$ 是指整个种群数量翻倍所需的时间。\n\n设 $N(t)$ 为时间 $t$ 时的细菌数量。\n在初始时间 $t=0$，细菌数量为 $N(0) = N_0$。\n\n经过一个代时，$t=g$，初始的 $N_0$ 个细菌中的每一个都已经分裂一次。种群数量将是：\n$$N(g) = N_0 \\times 2 = N_0 \\times 2^1$$\n\n经过第二个代时，$t=2g$，种群数量将再次翻倍：\n$$N(2g) = N(g) \\times 2 = (N_0 \\times 2) \\times 2 = N_0 \\times 2^2$$\n\n遵循此模式，经过 $k$ 个代时，在时间 $t=kg$ 时，种群数量将为：\n$$N(kg) = N_0 \\times 2^k$$\n\n为了找到任意时间 $t$ 的表达式，我们可以将代数 $k$ 表示为 $t$ 和 $g$ 的函数。到时间 $t$ 为止所经过的代数为 $k = \\frac{t}{g}$。\n\n将 $k$ 的这个表达式代入上面的方程，我们得到时间 $t$ 时细菌数量的通用公式：\n$$N(t) = N_0 \\cdot 2^{t/g}$$\n这就是所要求的 $N(t)$ 关于 $N_0$ 和 $g$ 的表达式。通常使用自然底数 $e$ 来表示这种指数增长会很有用。因为 $2 = \\exp(\\ln(2))$，该方程可以重写为：\n$$N(t) = N_0 \\cdot (\\exp(\\ln(2)))^{t/g} = N_0 \\exp\\left(\\frac{\\ln(2)}{g}t\\right)$$\n\n**第 2 部分：计算 $t=24$ 小时时的细菌数量**\n\n我们被要求使用给定值计算 $N(24)$：$N_0 = 10$，$g = 4$ 小时，以及 $t = 24$ 小时。\n使用推导出的公式：\n$$N(24) = N_0 \\cdot 2^{24/g}$$\n代入数值：\n$$N(24) = 10 \\cdot 2^{24/4} = 10 \\cdot 2^6$$\n计算 $2$ 的幂：\n$$2^6 = 64$$\n因此，$t=24$ 小时时的胞内数量为：\n$$N(24) = 10 \\times 64 = 640$$\n\n**第 3 部分：计算达到裂解的时间 $t_{\\mathrm{lysis}}$**\n\n裂解的起始点被定义为当细菌数量达到 $N_{\\mathrm{lysis}} = 1000$ 时。我们必须求解使 $N(t_{\\mathrm{lysis}}) = N_{\\mathrm{lysis}}$ 成立的时间 $t_{\\mathrm{lysis}}$。\n\n使用增长方程：\n$$N(t_{\\mathrm{lysis}}) = N_0 \\cdot 2^{t_{\\mathrm{lysis}}/g} = N_{\\mathrm{lysis}}$$\n代入已知值：$N_0 = 10$，$g = 4$ 小时，以及 $N_{\\mathrm{lysis}} = 1000$。\n$$10 \\cdot 2^{t_{\\mathrm{lysis}}/4} = 1000$$\n为了求解 $t_{\\mathrm{lysis}}$，我们首先通过将两边同时除以 $10$ 来分离指数项：\n$$2^{t_{\\mathrm{lysis}}/4} = \\frac{1000}{10} = 100$$\n接下来，我们对两边取自然对数 ($\\ln$) 来求解指数：\n$$\\ln\\left(2^{t_{\\mathrm{lysis}}/4}\\right) = \\ln(100)$$\n使用对数性质 $\\ln(a^b) = b \\ln(a)$：\n$$\\left(\\frac{t_{\\mathrm{lysis}}}{4}\\right) \\ln(2) = \\ln(100)$$\n现在，我们通过乘以 $4$ 并除以 $\\ln(2)$ 来分离 $t_{\\mathrm{lysis}}$：\n$$t_{\\mathrm{lysis}} = \\frac{4 \\cdot \\ln(100)}{\\ln(2)}$$\n这是 $t_{\\mathrm{lysis}}$ 的精确解析解。现在，我们计算其数值。\n使用数值 $\\ln(100) \\approx 4.605170$ 和 $\\ln(2) \\approx 0.693147$：\n$$t_{\\mathrm{lysis}} = \\frac{4 \\times 4.605170}{0.693147} \\approx \\frac{18.42068}{0.693147} \\approx 26.57542 \\text{ hours}$$\n问题要求答案四舍五入到四位有效数字。第五位有效数字是 $5$，所以我们将第四位数字向上取整。\n$$t_{\\mathrm{lysis}} \\approx 26.58 \\text{ hours}$$", "answer": "$$\\boxed{26.58}$$", "id": "4644982"}, {"introduction": "在临床实践中，快速准确的诊断对改善军团病患者的预后至关重要，但诊断测试很少是完美的。本练习将运用循证医学的基石——贝叶斯定理，来量化一个阳性的尿抗原测试（$UAT$）结果如何修正医生对疾病可能性的判断。通过计算后验概率，您将学会如何将临床怀疑转化为指导治疗决策的量化依据 [@problem_id:4645001]。", "problem": "一名住院的成年患者在夏季高峰期出现严重社区获得性肺炎，曾接触过近期维修过的酒店冷却塔产生的气溶胶水雾。传染病团队根据流行病学和临床特征，估计由嗜肺军团菌（Legionella pneumophila）引起的军团病（Legionnaires’ disease）的检验前概率为 $0.3$。一项针对嗜肺军团菌1型血清群的尿抗原检测（UAT）结果为阳性。所使用的UAT灵敏度为 $0.75$，特异性为 $0.98$。使用贝叶斯定理（Bayes’ theorem），结合灵敏度、特异性的定义以及作为先验概率的检验前概率，计算在UAT阳性的情况下患病的检验后概率。将最终答案以小数形式（无单位）表示，并四舍五入到 $4$ 位有效数字。然后，在您的推理中，根据计算出的概率，解释最合适的即时临床措施。", "solution": "该问题陈述被评估为具有科学依据、提法恰当、客观且完整。提供了唯一解所需的所有数据，并且该场景呈现了贝叶斯推断在临床诊断背景下的一个标准、有效的应用。所提供的灵敏度和特异性值对于*军团菌*尿抗原检测是符合实际的。\n\n令 $D$ 表示患者患有军团病的事件，令 $D^c$ 表示患者未患该病的互补事件。令 $T^+$ 表示尿抗原检测（UAT）结果为阳性的事件。\n\n问题提供了以下信息：\n1.  疾病的检验前概率，即先验概率：$P(D) = 0.3$。\n2.  UAT的灵敏度，即在患者患有该病的情况下，检测结果为阳性的概率：$P(T^+ | D) = 0.75$。\n3.  UAT的特异性，即在患者未患该病的情况下，检测结果为阴性的概率：$P(T^- | D^c) = 0.98$。\n\n我们的目标是计算在检测结果为阳性的情况下，患者患病的检验后概率，记为 $P(D | T^+)$。我们将使用贝叶斯定理进行此计算：\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n分子是两个给定量的乘积。分母 $P(T^+)$ 是获得阳性检测结果的总概率。这可以使用全概率公式计算，该公式将阳性检测的概率在所有可能的疾病状态（患病或未患病）上求和：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n要使用此公式，我们需要 $P(D^c)$ 和 $P(T^+ | D^c)$。\n\n未患病的概率是患病概率的补集：\n$$P(D^c) = 1 - P(D) = 1 - 0.3 = 0.7$$\n项 $P(T^+ | D^c)$ 是在没有疾病的情况下检测结果为阳性的概率。这是假阳性率。它是特异性 $P(T^- | D^c)$ 的补集：\n$$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - 0.98 = 0.02$$\n现在，我们可以计算阳性检测的总概率 $P(T^+)$：\n$$P(T^+) = (0.75)(0.3) + (0.02)(0.7)$$\n$$P(T^+) = 0.225 + 0.014 = 0.239$$\n最后，我们将分子和分母的值代入贝叶斯定理，以求得检验后概率：\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)} = \\frac{(0.75)(0.3)}{0.239} = \\frac{0.225}{0.239}$$\n$$P(D | T^+) \\approx 0.941422594...$$\n问题要求答案四舍五入到 $4$ 位有效数字。\n$$P(D | T^+) \\approx 0.9414$$\n这个结果是患者患有军团病的检验后概率。\n\n关于临床解释，一个 $0.9414$ 或 $94.14\\%$ 的检验后概率是极高的，并为临床决策提供了坚实的基础。$30\\%$ 的检验前概率已经很高，表明根据患者的临床表现和接触史，临床上已有高度怀疑。阳性的UAT结果显著增加了诊断的确定性。鉴于肺炎的严重性，如此高的概率证明有必要立即开始针对*Legionella pneumophila*的靶向抗菌治疗，例如使用大环内酯类药物（如阿奇霉素）或呼吸系统氟喹诺酮类药物（如左氧氟沙星）。等待确诊的培养结果在临床上是不合适的，可能会导致患者预后更差，因为培养需要数天时间且其灵敏度低于UAT。计算出的概率为确定性治疗提供了正当理由。", "answer": "$$\n\\boxed{0.9414}\n$$", "id": "4645001"}, {"introduction": "当军团病暴发时，公共卫生官员的首要任务是确定并控制环境中的感染源，以防止更多病例的出现。本练习将向您介绍一项前沿技术：全基因组测序（$WGS$）及其单核苷酸多态性（$SNP$）分析。您将学习如何利用基因组数据，通过设定阈值和考虑测序错误等不确定性，以高置信度建立患者与环境污染源之间的联系 [@problem_id:4645024]。", "problem": "一次关于军团病的暴发调查从六名患者身上鉴别出了临床分离株，并从一个可疑的医院冷却塔系统中培养出了环境分离株。通过全基因组测序来推导分离株之间的核心基因组单核苷酸多态性（SNP；Single Nucleotide Polymorphism）距离。此处的成对核心基因组SNP距离定义为两个分离株在共享核心基因组上的单核苷酸差异计数。从流行病学角度看，局部源头内的短时间尺度传播通常会导致相关分离株之间的核心基因组SNP距离较小。\n\n给定六个临床分离株 $C_1, C_2, C_3, C_4, C_5, C_6$ 和四个环境分离株 $E_1, E_2, E_3, E_4$。它们之间的成对核心基因组SNP距离 $d(C_i,E_j)$ 如下：\n- $d(C_1,E_1)=3$, $d(C_1,E_2)=48$, $d(C_1,E_3)=12$, $d(C_1,E_4)=7$。\n- $d(C_2,E_1)=9$, $d(C_2,E_2)=85$, $d(C_2,E_3)=14$, $d(C_2,E_4)=11$。\n- $d(C_3,E_1)=52$, $d(C_3,E_2)=6$, $d(C_3,E_3)=8$, $d(C_3,E_4)=60$。\n- $d(C_4,E_1)=15$, $d(C_4,E_2)=79$, $d(C_4,E_3)=9$, $d(C_4,E_4)=13$。\n- $d(C_5,E_1)=10$, $d(C_5,E_2)=90$, $d(C_5,E_3)=25$, $d(C_5,E_4)=16$。\n- $d(C_6,E_1)=4$, $d(C_6,E_2)=44$, $d(C_6,E_3)=11$, $d(C_6,E_4)=5$。\n\n在操作上，使用 $\\tau=10$ 个SNP的阈值来识别可能的病例-源头关联：如果 $d(C_i,E_j)\\leq \\tau$，则认为临床分离株 $C_i$ 与环境分离株 $E_j$ 相关联。为处理由测序错误、同源重组以及嗜肺军团菌（*Legionella pneumophila*）的背景基因组多样性引起的不确定性，假设对于任何仅由阈值标记为关联的一对分离株，该关联是伪关联的假阳性概率 $p_{\\mathrm{fp}}$ 取决于观测到的距离 $d$，具体如下：\n- 如果 $d\\leq 5$，则 $p_{\\mathrm{fp}}=0.05$。\n- 如果 $6\\leq d\\leq 8$，则 $p_{\\mathrm{fp}}=0.12$。\n- 如果 $9\\leq d\\leq 10$，则 $p_{\\mathrm{fp}}=0.25$。\n\n假设涉及同一临床分离株的多个关联之间的假阳性事件是相互独立的。在采样的源头中，真正关联的临床病例的期望数是每个病例至少有一个真实关联的概率之和。\n\n为了校正环境采样偏差，请注意，环境样本中仅代表了流行源谱系的一小部分 $s$。根据本次调查中的培养阳性率和空间覆盖范围，取 $s=0.90$。通过将采样源头中的期望数除以 $s$，使用逆概率加权来获得所有源头的无偏期望。\n\n使用上述数据和假设，计算所有源头中真正关联的临床病例的期望数。将最终答案四舍五入到四位有效数字。最终值以无量纲计数表示（无单位）。", "solution": "目标是计算在所有潜在源头中真正关联的临床病例的期望数，并校正环境采样偏差。解决方案分为四个主要步骤：首先，根据基因组距离阈值识别潜在的病例-源头关联；其次，对于每个临床病例，计算其与采样的环境源头至少有一个真实关联的概率；第三，将这些概率相加，以确定来自采样源头的关联病例的期望数；最后，应用逆概率加权来解释源环境采样不完全的情况。\n\n令 $C_i$（其中 $i \\in \\{1, 2, 3, 4, 5, 6\\}$）为临床分离株，令 $E_j$（其中 $j \\in \\{1, 2, 3, 4\\}$）为环境分离株。它们之间的核心基因组单核苷酸多态性（SNP）距离记为 $d(C_i, E_j)$。如果 $d(C_i, E_j) \\leq \\tau$，则初步确定存在关联，其中阈值给定为 $\\tau=10$。\n\n对于每个由阈值识别出的关联，都存在一个假阳性概率 $p_{\\mathrm{fp}}$，该概率取决于SNP距离 $d$：\n- 如果 $d \\leq 5$，则 $p_{\\mathrm{fp}} = 0.05$。\n- 如果 $6 \\leq d \\leq 8$，则 $p_{\\mathrm{fp}} = 0.12$。\n- 如果 $9 \\leq d \\leq 10$，则 $p_{\\mathrm{fp}} = 0.25$。\n\n对于一个给定的临床病例 $C_i$，令 $L_i$ 为与其相关联的环境分离株 $E_j$ 的集合（即 $d(C_i, E_j) \\leq 10$）。问题假设对于一个给定的病例，假阳性事件是相互独立的。因此，病例 $C_i$ 的所有关联均为假阳性的概率是它们各自假阳性概率的乘积。病例 $C_i$ 至少有一个真实关联的概率，我们记为 $P_i$，是该事件的补集：\n$$P_i = 1 - \\prod_{E_j \\in L_i} p_{\\mathrm{fp}}(d(C_i, E_j))$$\n如果一个病例 $C_i$ 没有关联（即 $L_i$ 是一个空集），则乘积取为 $1$，所以 $P_i = 1 - 1 = 0$。\n\n我们现在为 6 个临床病例中的每一个计算 $P_i$。\n\n对于病例 $C_1$：\n距离为 $d(C_1,E_1)=3$、$d(C_1,E_2)=48$、$d(C_1,E_3)=12$ 和 $d(C_1,E_4)=7$。\n关联对象是 $E_1$（$d=3 \\leq 10$）和 $E_4$（$d=7 \\leq 10$）。相应的假阳性概率为 $p_{\\mathrm{fp}}(3) = 0.05$ 和 $p_{\\mathrm{fp}}(7) = 0.12$。\n$$P_1 = 1 - (p_{\\mathrm{fp}}(3) \\times p_{\\mathrm{fp}}(7)) = 1 - (0.05 \\times 0.12) = 1 - 0.006 = 0.994$$\n\n对于病例 $C_2$：\n距离为 $d(C_2,E_1)=9$、$d(C_2,E_2)=85$、$d(C_2,E_3)=14$ 和 $d(C_2,E_4)=11$。\n只有一个与 $E_1$ 的关联（$d=9 \\leq 10$）。假阳性概率为 $p_{\\mathrm{fp}}(9) = 0.25$。\n$$P_2 = 1 - p_{\\mathrm{fp}}(9) = 1 - 0.25 = 0.75$$\n\n对于病例 $C_3$：\n距离为 $d(C_3,E_1)=52$、$d(C_3,E_2)=6$、$d(C_3,E_3)=8$ 和 $d(C_3,E_4)=60$。\n关联对象是 $E_2$（$d=6 \\leq 10$）和 $E_3$（$d=8 \\leq 10$）。假阳性概率为 $p_{\\mathrm{fp}}(6) = 0.12$ 和 $p_{\\mathrm{fp}}(8) = 0.12$。\n$$P_3 = 1 - (p_{\\mathrm{fp}}(6) \\times p_{\\mathrm{fp}}(8)) = 1 - (0.12 \\times 0.12) = 1 - 0.0144 = 0.9856$$\n\n对于病例 $C_4$：\n距离为 $d(C_4,E_1)=15$、$d(C_4,E_2)=79$、$d(C_4,E_3)=9$ 和 $d(C_4,E_4)=13$。\n只有一个与 $E_3$ 的关联（$d=9 \\leq 10$）。假阳性概率为 $p_{\\mathrm{fp}}(9) = 0.25$。\n$$P_4 = 1 - p_{\\mathrm{fp}}(9) = 1 - 0.25 = 0.75$$\n\n对于病例 $C_5$：\n距离为 $d(C_5,E_1)=10$、$d(C_5,E_2)=90$、$d(C_5,E_3)=25$ 和 $d(C_5,E_4)=16$。\n只有一个与 $E_1$ 的关联（$d=10 \\leq 10$）。假阳性概率为 $p_{\\mathrm{fp}}(10) = 0.25$。\n$$P_5 = 1 - p_{\\mathrm{fp}}(10) = 1 - 0.25 = 0.75$$\n\n对于病例 $C_6$：\n距离为 $d(C_6,E_1)=4$、$d(C_6,E_2)=44$、$d(C_6,E_3)=11$ 和 $d(C_6,E_4)=5$。\n关联对象是 $E_1$（$d=4 \\leq 10$）和 $E_4$（$d=5 \\leq 10$）。假阳性概率为 $p_{\\mathrm{fp}}(4) = 0.05$ 和 $p_{\\mathrm{fp}}(5) = 0.05$。\n$$P_6 = 1 - (p_{\\mathrm{fp}}(4) \\times p_{\\mathrm{fp}}(5)) = 1 - (0.05 \\times 0.05) = 1 - 0.0025 = 0.9975$$\n\n在采样的源头中，真正关联的临床病例的期望数 $N_{\\text{linked, sampled}}$ 定义为这些概率的总和：\n$$N_{\\text{linked, sampled}} = \\sum_{i=1}^{6} P_i = P_1 + P_2 + P_3 + P_4 + P_5 + P_6$$\n$$N_{\\text{linked, sampled}} = 0.994 + 0.75 + 0.9856 + 0.75 + 0.75 + 0.9975 = 5.2271$$\n\n最后，这个值必须进行环境采样偏差校正。鉴于样本中只代表了源谱系的一小部分 $s=0.90$，通过逆概率加权得到所有源头的无偏期望 $N_{\\text{linked, total}}$：\n$$N_{\\text{linked, total}} = \\frac{N_{\\text{linked, sampled}}}{s} = \\frac{5.2271}{0.90} \\approx 5.807888...$$\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$N_{\\text{linked, total}} \\approx 5.808$$\n这代表了在考虑测量不确定性和采样限制后，与暴发源头真正关联的临床病例的期望数。", "answer": "$$\\boxed{5.808}$$", "id": "4645024"}]}