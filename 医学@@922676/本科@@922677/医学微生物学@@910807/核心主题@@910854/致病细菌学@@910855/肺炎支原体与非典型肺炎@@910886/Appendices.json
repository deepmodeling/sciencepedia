{"hands_on_practices": [{"introduction": "临床诊断的精髓在于根据新信息不断更新我们的判断。本练习将介绍一个强大工具——似然比 (Likelihood Ratio, LR)，它能量化一项检测结果在多大程度上改变我们对疾病的怀疑程度。通过这个实践，你将学会使用贝叶斯定理的赔率形式，这是在床边快速评估检测价值的高效方法。[@problem_id:4671271]", "problem": "一名具有非典型肺炎临床特征的患者被怀疑感染了肺炎支原体(Mycoplasma pneumoniae)。在检测前，临床医生根据流行病学、临床表现（包括干咳和肺外表现）及季节性，估计肺炎支原体感染的检验前概率为 $0.25$。针对肺炎支原体的核酸扩增检测（使用聚合酶链式反应，PCR）结果为阳性。在该临床医生的执业环境中，对于相似的患者，此PCR检测的阳性似然比 $LR^{+}$ 为 $18$。\n\n从贝叶斯(Bayes)定理和似然比的定义出发，使用优势比形式的证据更新来推导在PCR结果为阳性的情况下，该患者感染肺炎支原体的检验后概率。将最终的后验概率表示为小数，并四舍五入至 $4$ 位有效数字。请勿使用百分号。\n\n然后，简要讨论治疗决策阈值是如何根据预期伤害和收益的第一性原理推导出来的，并解释在假定治疗伤害为低至中度且具有临床意义的益处的情况下，所计算出的检验后概率是否通常会超过一个合理的治疗阈值，以决定是否对疑似肺炎支原体感染的成年患者启动大环内酯类药物治疗。你的最终数值答案应仅为按上述说明计算的检验后概率。", "solution": "目标是计算在检测结果为阳性的情况下，感染*肺炎支原体*(Mycoplasma pneumoniae)的检验后概率，并在临床决策的背景下讨论这一结果。问题指定使用贝叶斯定理的优势比形式。\n\n设 $D$ 为患者感染*肺炎支原体*的事件，设 $T^+$ 为聚合酶链式反应（PCR）检测结果为阳性的事件。\n\n给定信息如下：\n检验前感染概率，$P(D) = 0.25$。\nPCR检测的阳性似然比，$LR^{+} = 18$。\n\n问题要求从贝叶斯定理出发推导优势比形式。贝叶斯定理将后验概率 $P(D|T^+)$ 表述为：\n$$ P(D|T^+) = \\frac{P(T^+|D) P(D)}{P(T^+)} $$\n类似地，在检测结果为阳性的情况下，未患病的后验概率为：\n$$ P(D^c|T^+) = \\frac{P(T^+|D^c) P(D^c)}{P(T^+)} $$\n其中 $D^c$ 是 $D$ 的补集。\n\n事件 $A$ 的优势比（Odds）定义为该事件发生的概率与不发生的概率之比，即 $\\text{Odds}(A) = \\frac{P(A)}{1-P(A)}$。\n患病的检验后优势比是 $P(D|T^+)$ 与 $P(D^c|T^+)$ 的比值：\n$$ \\text{Odds}(D|T^+) = \\frac{P(D|T^+)}{P(D^c|T^+)} = \\frac{\\frac{P(T^+|D) P(D)}{P(T^+)}}{\\frac{P(T^+|D^c) P(D^c)}{P(T^+)}} $$\n项 $P(T^+)$ 被消去，得到：\n$$ \\text{Odds}(D|T^+) = \\left(\\frac{P(T^+|D)}{P(T^+|D^c)}\\right) \\times \\left(\\frac{P(D)}{P(D^c)}\\right) $$\n乘积中的第一项是阳性似然比的定义，$LR^{+} = \\frac{P(T^+|D)}{P(T^+|D^c)}$。第二项是检验前优势比的定义，$\\text{Odds}(D) = \\frac{P(D)}{P(D^c)}$。\n这就得到了用于更新证据的期望优势比形式：\n$$ \\text{Posttest Odds} = LR^{+} \\times \\text{Pretest Odds} $$\n\n现在，我们使用给定值应用此公式。\n首先，我们根据检验前概率 $P(D)=0.25$ 计算检验前优势比：\n$$ \\text{Pretest Odds} = \\frac{P(D)}{1-P(D)} = \\frac{0.25}{1-0.25} = \\frac{0.25}{0.75} = \\frac{1}{3} $$\n接下来，我们使用给定的 $LR^{+} = 18$ 计算检验后优势比：\n$$ \\text{Posttest Odds} = LR^{+} \\times \\text{Pretest Odds} = 18 \\times \\frac{1}{3} = 6 $$\n最后，我们将检验后优势比转换回概率。概率 $P$ 和优势比之间的关系是 $P = \\frac{\\text{Odds}}{1+\\text{Odds}}$。\n检验后概率 $P(D|T^+)$ 为：\n$$ P(D|T^+) = \\frac{\\text{Posttest Odds}}{1+\\text{Posttest Odds}} = \\frac{6}{1+6} = \\frac{6}{7} $$\n将此表示为四舍五入至 $4$ 位有效数字的小数：\n$$ P(D|T^+) = \\frac{6}{7} \\approx 0.857142857... \\approx 0.8571 $$\n\n问题的第二部分要求讨论治疗决策阈值。\n根据第一性原理，一个理性的治疗阈值是这样一个疾病概率（我们称之为 $P_t$），在此概率下，治疗患者的预期效用等于不治疗的预期效用。一个简化但常见的模型是平衡治疗的预期伤害与不治疗的预期伤害。设 $B$ 为治疗患病者的净收益，设 $H$ 为治疗未患病者的净伤害（即不必要治疗的伤害）。\n在阈值概率 $P_t$ 下，实施治疗的预期收益必须等于其预期伤害。\n预期收益 = $P_t \\times B$\n预期伤害 = $(1-P_t) \\times H$\n令二者相等，即可定义阈值：\n$$ P_t \\times B = (1-P_t) \\times H $$\n$$ P_t \\times B = H - P_t \\times H $$\n$$ P_t(B+H) = H $$\n$$ P_t = \\frac{H}{B+H} = \\frac{H/B}{1+H/B} $$\n这个方程表明，治疗阈值由伤害-收益比 $\\frac{H}{B}$ 决定。\n在给定的情景中，感染的是*肺炎支原体*，对其进行治疗具有“临床意义上的益处”（例如，缩短病程、预防并发症）。这意味着 $B$ 的值很大。大环内酯类药物治疗具有“低至中度的治疗伤害”（例如，副作用、成本、助长抗生素耐药性），这意味着 $H$ 的值相对较小。因此，伤害-收益比 $\\frac{H}{B}$ 预计会很小。较小的 $\\frac{H}{B}$ 比值会导致较低的治疗阈值 $P_t$。例如，如果不必要使用抗生素的伤害被认为比治疗肺炎的益处小 $9$ 倍（即 $\\frac{H}{B} = \\frac{1}{9}$），则阈值将为 $P_t = \\frac{1/9}{1+1/9} = 0.1$，即 $10\\%$。更一般地，对于像肺炎这样的病症，治疗阈值通常在 $0.1$ 到 $0.3$（$10\\%$到$30\\%$）的范围内。\n\n我们计算出的检验后概率是 $P(D|T^+) \\approx 0.8571$。由于 $0.8571$ 远高于此临床情况下任何合理的治疗阈值（例如，$0.8571 \\gg 0.3$），因此阳性的PCR结果提供了高度的确定性。这将有力地支持启动大环内酯类药物治疗的临床决策。", "answer": "$$ \\boxed{0.8571} $$", "id": "4671271"}, {"introduction": "临床诊断并非依赖单一信息，而是综合分析病史、体征和多项检测结果的过程。本练习模拟了这一真实场景，教你如何将模糊的临床线索（如持续干咳）和精确的实验室数据（如PCR检测）进行数学整合。掌握这项技能可以让你更系统地结合不同来源的证据，以修正诊断概率。[@problem_id:4656410]", "problem": "一名年轻成年患者于深秋因疑似非典型肺炎就诊于门诊。临床医生注意到患者有持续一周以上的干咳，以及与多形性红斑相符的肺外斑丘疹。在该诊所和年龄组中，对于因社区获得性肺炎接受评估且总体严重程度相似的患者，肺炎支原体 (Mycoplasma pneumoniae) 感染的基线患病率为 $p_{0} = 0.12$。为进行临床预测，假设以下指标在该队列中经过充分检验且适用：持续性干咳的似然比 (LR) 为 $\\text{LR}_{\\text{cough}} = 2.0$，肺外皮疹的似然比为 $\\text{LR}_{\\text{rash}} = 3.5$。假设这些发现在疾病状态方面是条件独立的，因此它们对优势比的影响是乘法性的。对患者进行了一次针对肺炎支原体的鼻咽聚合酶链式反应 (PCR) 检测，结果为阳性；在该情境下，该检测经证实的性能为：灵敏度 $= 0.92$，特异度 $= 0.96$。\n\n从患病率与优势比相关的基本定义、使用似然比更新优势比的方法出发，并利用灵敏度、特异度与阳性检测结果的似然比之间已科学确立的关系，计算：\n- 检验前概率（综合两项临床发现后，但在PCR结果出来前），以及\n- 检验后概率（综合阳性PCR结果后）。\n\n将两个概率均以小数形式表示，并各自四舍五入至四位有效数字。仅按顺序提供您的最终数值结果，不带任何单位。", "solution": "本题要求计算在综合临床发现后，以及随后再综合聚合酶链式反应 (PCR) 阳性结果后，患者感染肺炎支原体的概率。其基本原理是优势比形式的贝叶斯定理，以及灵敏度、特异度和似然比 (LR) 的定义。\n\n定义基线患病率为 $p_{0} = 0.12$。使用以下定义将其转换为基线优势比 $o_{0}$\n$$\no = \\frac{p}{1 - p}.\n$$\n因此，\n$$\no_{0} = \\frac{0.12}{1 - 0.12} = \\frac{0.12}{0.88} = \\frac{12}{88} = \\frac{3}{22}.\n$$\n在条件独立的假设下，通过在优势比尺度上乘以似然比来整合临床发现。总的临床似然比为\n$$\n\\text{LR}_{\\text{clinical}} = \\text{LR}_{\\text{cough}} \\times \\text{LR}_{\\text{rash}} = 2.0 \\times 3.5 = 7.0.\n$$\n更新优势比以获得检验前优势比（在临床评估之后，实验室检测之前）：\n$$\no_{\\text{pre}} = o_{0} \\times \\text{LR}_{\\text{clinical}} = \\frac{3}{22} \\times 7 = \\frac{21}{22}.\n$$\n使用以下公式将检验前优势比转换为检验前概率\n$$\np = \\frac{o}{1 + o}.\n$$\n因此，\n$$\np_{\\text{pre}} = \\frac{\\frac{21}{22}}{1 + \\frac{21}{22}} = \\frac{\\frac{21}{22}}{\\frac{43}{22}} = \\frac{21}{43}.\n$$\n数值上，\n$$\n\\frac{21}{43} \\approx 0.488372093.\n$$\n\n接下来，整合阳性PCR结果。阳性检测结果的似然比 $\\text{LR}_{+}$ 由灵敏度和特异度定义为\n$$\n\\text{LR}_{+} = \\frac{\\text{sensitivity}}{1 - \\text{specificity}}.\n$$\n给定灵敏度 $= 0.92$ 和特异度 $= 0.96$，我们得到\n$$\n\\text{LR}_{+} = \\frac{0.92}{1 - 0.96} = \\frac{0.92}{0.04} = 23.\n$$\n用阳性检测结果更新优势比：\n$$\no_{\\text{post}} = o_{\\text{pre}} \\times \\text{LR}_{+} = \\frac{21}{22} \\times 23 = \\frac{483}{22}.\n$$\n将检验后优势比转换为检验后概率：\n$$\np_{\\text{post}} = \\frac{\\frac{483}{22}}{1 + \\frac{483}{22}} = \\frac{\\frac{483}{22}}{\\frac{505}{22}} = \\frac{483}{505}.\n$$\n数值上，\n$$\n\\frac{483}{505} \\approx 0.956435644.\n$$\n\n最后，根据要求将每个概率四舍五入到四位有效数字。对于检验前概率，\n$$\n0.488372093 \\to 0.4884 \\text{ (four significant figures)}.\n$$\n对于检验后概率，\n$$\n0.956435644 \\to 0.9564 \\text{ (four significant figures)}.\n$$\n按指定顺序提供结果：先是检验前概率，然后是检验后概率。", "answer": "$$\\boxed{\\begin{pmatrix} 0.4884  0.9564 \\end{pmatrix}}$$", "id": "4656410"}, {"introduction": "计算出一个概率只是第一步，更关键的是如何利用这个概率来做决策。本练习引入了“治疗阈值”这一核心概念，并探讨一个诊断检测的真正价值：它是否能改变我们的治疗方案。通过分析，你将学会评估一项检测在特定临床情境下是否具有实用价值，从而避免不必要的检测。[@problem_id:4656409]", "problem": "一名临床医生正在评估一位其他方面健康的$25$岁门诊患者，该患者患有社区获得性肺炎，表现为干咳、低烧，胸部X光片显示弥漫性间质浸润。该临床医生怀疑是由Mycoplasma pneumoniae引起的非典型肺炎。她考虑为患者开具一项针对Mycoplasma pneumoniae的多重聚合酶链式反应（PCR）核酸扩增测试（NAAT）。根据当地监测数据，检验前概率（相似患者中的患病率）为$p = 0.15$。该NAAT的灵敏度为$Se = 0.92$，特异度为$Sp = 0.97$。\n\n该临床医生使用一个基于概率的治疗阈值：当且仅当她估计的患者患有Mycoplasma pneumoniae的概率超过$\\tau = 0.25$时，她才会开具大环内酯类抗生素。在不进行检测的情况下，她会将检验前概率$p$与$\\tau$进行比较。在进行检测的情况下，她会根据NAAT的阳性或阴性结果，将相应的检验后概率与$\\tau$进行比较。\n\n仅使用灵敏度（$Se$）、特异度（$Sp$）、患病率（$p$）、阳性预测值（PPV）、阴性预测值（NPV）的基本定义，以及关联检验前和检验后概率的贝叶斯定理，完成以下任务：\n\n1. 计算阳性预测值$PPV = P(\\text{disease} \\mid \\text{test} +)$和阴性预测值$NPV = P(\\text{no disease} \\mid \\text{test} -)$。将$PPV$和$NPV$四舍五入到四位有效数字。\n2. 判断在此阈值策略下，相对于不进行检测，进行检测是否能改变治疗决策。具体来说，因为在不检测的情况下，是将$p$与$\\tau$进行比较，如果检测结果会使（概率）相对于检验前决策跨越阈值$\\tau$，则检测改变了治疗决策。\n3. 设$\\Pi$表示在检测时开具NAAT检测改变了对该患者的治疗决策的概率（也就是说，实际的检测结果导致了与检验前决策不同的决策的概率）。将$\\Pi$计算为单个概率值，并将其四舍五入到四位有效数字。将$\\Pi$表示为小数（而非百分比）。\n\n报告你的最终答案时，仅报告$\\Pi$的值，四舍五入到四位有效数字。", "solution": "在进行解答之前，对问题进行验证。\n\n### 第1步：提取已知条件\n- 检验前概率（患病率）：$p = P(\\text{disease}) = 0.15$\n- 检测灵敏度：$Se = P(\\text{test} + \\mid \\text{disease}) = 0.92$\n- 检测特异度：$Sp = P(\\text{test} - \\mid \\text{no disease}) = 0.97$\n- 治疗阈值：$\\tau = 0.25$\n- 治疗规则：当且仅当 $P(\\text{disease})  \\tau$ 时开具抗生素处方。\n- 任务1：计算阳性预测值（$PPV$）和阴性预测值（$NPV$）。四舍五入到四位有效数字。\n- 任务2：判断检测是否能改变治疗决策。\n- 任务3：计算$\\Pi$，即开具检测改变治疗决策的概率。四舍五入到四位有效数字。\n- 最终答案：报告$\\Pi$的值。\n\n### 第2步：使用提取的已知条件进行验证\n该问题有科学依据，使用了应用于医学诊断的贝叶斯推断和决策理论的标准原理。该场景是现实的，为所描述的检测和临床背景提供的灵敏度、特异度和患病率值是合理的。该问题提法得当，提供了回答所提出问题所需的所有必要数据（$p, Se, Sp, \\tau$）。语言客观且明确。该问题在数学上和逻辑上是自洽且一致的。\n\n### 第3步：结论与行动\n该问题有效。将提供完整的解法。\n\n设$D$为患者患有疾病（*Mycoplasma pneumoniae*）的事件，设$D^c$为患者未患该疾病的事件。设$T+$和$T-$分别为检测结果为阳性和阴性的事件。\n\n已知条件如下：\n- 检验前概率：$P(D) = p = 0.15$\n- 灵敏度：$P(T+ \\mid D) = Se = 0.92$\n- 特异度：$P(T- \\mid D^c) = Sp = 0.97$\n- 治疗阈值：$\\tau = 0.25$\n\n由此，我们可以推导出互补概率：\n- 未患病的概率：$P(D^c) = 1 - P(D) = 1 - 0.15 = 0.85$\n- 假阴性率：$P(T- \\mid D) = 1 - P(T+ \\mid D) = 1 - Se = 1 - 0.92 = 0.08$\n- 假阳性率：$P(T+ \\mid D^c) = 1 - P(T- \\mid D^c) = 1 - Sp = 1 - 0.97 = 0.03$\n\n为了找到预测值并分析决策，我们首先需要使用全概率公式计算阳性和阴性检测结果的总概率，$P(T+)$和$P(T-)$。\n\n阳性检测结果的概率为：\n$$ P(T+) = P(T+ \\mid D)P(D) + P(T+ \\mid D^c)P(D^c) $$\n$$ P(T+) = (Se)(p) + (1-Sp)(1-p) $$\n$$ P(T+) = (0.92)(0.15) + (0.03)(0.85) = 0.138 + 0.0255 = 0.1635 $$\n\n阴性检测结果的概率为：\n$$ P(T-) = P(T- \\mid D)P(D) + P(T- \\mid D^c)P(D^c) $$\n$$ P(T-) = (1-Se)(p) + (Sp)(1-p) $$\n$$ P(T-) = (0.08)(0.15) + (0.97)(0.85) = 0.012 + 0.8245 = 0.8365 $$\n作为检验，$P(T+) + P(T-) = 0.1635 + 0.8365 = 1.0000$。\n\n### 第1部分：计算PPV和NPV\n\n阳性预测值（$PPV$）是在检测结果为阳性的条件下患有该疾病的概率，$P(D \\mid T+)$。使用贝叶斯定理：\n$$ PPV = P(D \\mid T+) = \\frac{P(T+ \\mid D)P(D)}{P(T+)} = \\frac{(Se)(p)}{P(T+)} $$\n$$ PPV = \\frac{(0.92)(0.15)}{0.1635} = \\frac{0.138}{0.1635} \\approx 0.844036697... $$\n四舍五入到四位有效数字，$PPV \\approx 0.8440$。\n\n阴性预测值（$NPV$）在问题中定义为在检测结果为阴性的条件下未患该疾病的概率，$P(D^c \\mid T-)$。使用贝叶斯定理：\n$$ NPV = P(D^c \\mid T-) = \\frac{P(T- \\mid D^c)P(D^c)}{P(T-)} = \\frac{(Sp)(1-p)}{P(T-)} $$\n$$ NPV = \\frac{(0.97)(0.85)}{0.8365} = \\frac{0.8245}{0.8365} \\approx 0.985654512... $$\n四舍五入到四位有效数字，$NPV \\approx 0.9857$。\n\n### 第2部分：判断检测是否改变治疗决策\n\n决策规则是，如果患病概率大于阈值$\\tau = 0.25$，则进行治疗。\n\n- **不进行检测的决策**：将检验前概率$p$与$\\tau$进行比较。\n  由于$p = 0.15 \\le \\tau = 0.25$，不进行检测的决策是**不治疗**。\n\n- **进行检测的决策**：\n  - 如果检测结果为阳性，患病概率为$P(D \\mid T+) = PPV \\approx 0.8440$。由于$0.8440  \\tau = 0.25$，决策是**治疗**。这表示相对于检验前决策，治疗决策发生了改变。\n  - 如果检测结果为阴性，患病概率为$P(D \\mid T-)$。我们可以通过$1 - P(D^c \\mid T-) = 1 - NPV$来计算这个值。\n  $$ P(D \\mid T-) = 1 - NPV \\approx 1 - 0.98565... \\approx 0.01435 $$\n  由于$P(D \\mid T-) \\approx 0.01435 \\le \\tau = 0.25$，决策是**不治疗**。这表示相对于检验前决策，治疗决策没有改变。\n\n结论：检测可以改变治疗决策。具体而言，阳性检测结果将决策从“不治疗”变为“治疗”，而阴性检测结果不改变决策。\n\n### 第3部分：计算$\\Pi$，即治疗决策改变的概率\n\n量$\\Pi$是开具检测导致了与检验前决策不同的决策的概率。\n\n根据第2部分，我们确定：\n- 检验前决策：不治疗。\n- 检验后决策（如果阳性）：治疗。（改变）\n- 检验后决策（如果阴性）：不治疗。（无改变）\n\n当且仅当检测结果为阳性时，治疗决策才会改变。因此，治疗决策改变的概率$\\Pi$，等于获得阳性检测结果的概率$P(T+)$。\n\n$$ \\Pi = P(\\text{management changes}) = P(T+) $$\n我们之前计算了$P(T+)$：\n$$ \\Pi = P(T+) = 0.1635 $$\n\n问题要求将此值四舍五入到四位有效数字。计算出的值$0.1635$已经有四位有效数字。\n因此，最终答案是$0.1635$。", "answer": "$$\\boxed{0.1635}$$", "id": "4656409"}]}