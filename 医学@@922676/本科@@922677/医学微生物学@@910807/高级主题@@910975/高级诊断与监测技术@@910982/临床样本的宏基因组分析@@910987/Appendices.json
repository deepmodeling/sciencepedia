{"hands_on_practices": [{"introduction": "临床样本，如血液或组织，通常包含大量的宿主（例如人类）DNA，而病原微生物的DNA含量则微乎其微。这给宏基因组测序带来了巨大挑战，因为测序资源会被大量消耗在对诊断无益的宿主遗传物质上。本练习旨在通过一个实际计算，帮助你理解宿主DNA去除这一关键预处理步骤的重要性，并量化其对提高微生物读段（reads）比例的决定性影响。[@problem_id:4651340]", "problem": "一份临床粪便样本使用新一代测序（NGS）技术进行宏基因组测序处理。在文库制备之前，进行了宿主 DNA 去除。在去除前，该样本含有质量为 $10\\ \\mathrm{ng}$ 的微生物脱氧核糖核酸（DNA）和质量为 $1\\ \\mathrm{\\mu g}$ 的人类 DNA。该去除方案去除了 $90\\%$ 的人类 DNA 质量，而微生物 DNA 的质量保持不变。假设文库制备和测序相对于来源（微生物与人类）是无偏的，并且片段大小分布和转化为可测序分子的效率在不同来源之间是相似的，因此，源自某一来源的测序读段的期望比例等于该来源在文库中总 DNA 质量中所占的比例。\n\n在这些假设下，计算去除后文库中微生物读段的期望比例。将您的答案表示为一个无单位的小数，并四舍五入至四位有效数字。", "solution": "设 $m_{M,0}$ 为样本中微生物脱氧核糖核酸（DNA）的初始质量，$m_{H,0}$ 为人类 DNA 的初始质量。根据问题陈述，我们有：\n$$ m_{M,0} = 10\\ \\mathrm{ng} $$\n$$ m_{H,0} = 1\\ \\mathrm{\\mu g} $$\n\n为确保单位一致性，我们必须用相同的单位表示两种质量。我们使用转换因子 $1\\ \\mathrm{\\mu g} = 1000\\ \\mathrm{ng}$ 将微克（$\\mathrm{\\mu g}$）转换为纳克（$\\mathrm{ng}$）。\n$$ m_{H,0} = 1\\ \\mathrm{\\mu g} \\times \\frac{1000\\ \\mathrm{ng}}{1\\ \\mathrm{\\mu g}} = 1000\\ \\mathrm{ng} $$\n\n问题陈述指出应用了宿主去除方案。设 $m_{M,f}$ 和 $m_{H,f}$ 分别为去除过程后微生物和人类 DNA 的最终质量。\n\n微生物 DNA 质量不变：\n$$ m_{M,f} = m_{M,0} = 10\\ \\mathrm{ng} $$\n\n该去除方案去除了 $90\\%$ 的人类 DNA 质量。这对应于 $0.9$ 的去除比例。剩余的人类 DNA 比例为 $1 - 0.9 = 0.1$。因此，人类 DNA 的最终质量为：\n$$ m_{H,f} = m_{H,0} \\times (1 - 0.90) = m_{H,0} \\times 0.10 $$\n代入 $m_{H,0}$ 的值：\n$$ m_{H,f} = 1000\\ \\mathrm{ng} \\times 0.10 = 100\\ \\mathrm{ng} $$\n\n去除后文库中 DNA 的总质量 $m_{T,f}$ 是最终微生物和人类 DNA 质量之和：\n$$ m_{T,f} = m_{M,f} + m_{H,f} $$\n$$ m_{T,f} = 10\\ \\mathrm{ng} + 100\\ \\mathrm{ng} = 110\\ \\mathrm{ng} $$\n\n问题假设，源自某一来源的测序读段的期望比例等于该来源在文库中总 DNA 质量中所占的比例。我们被要求计算微生物读段的期望比例，我们将其表示为 $F_M$。根据该假设：\n$$ F_M = \\frac{m_{M,f}}{m_{T,f}} $$\n代入计算出的值：\n$$ F_M = \\frac{10\\ \\mathrm{ng}}{110\\ \\mathrm{ng}} = \\frac{10}{110} = \\frac{1}{11} $$\n\n为将此分数表示为无单位小数，我们进行除法运算：\n$$ F_M = \\frac{1}{11} \\approx 0.09090909... $$\n\n问题要求答案四舍五入至四位有效数字。第一位有效数字是第一个非零数字，即 $9$。接下来的三位有效数字是 $0, 9, 0$。第四位有效数字后面的数字是 $9$。因为 $9 \\ge 5$，我们将最后一位有效数字向上取整。\n$$ F_M \\approx 0.09091 $$", "answer": "$$\\boxed{0.09091}$$", "id": "4651340"}, {"introduction": "在获得测序数据后，一个核心问题是：我们是否获得了足够的数据来可靠地检测或组装病原体的基因组？“测序深度”（coverage）是回答这个问题的关键指标，它衡量了基因组中每个碱基被测序读段覆盖的平均次数。本练习将指导你计算一个病原体的预期平均测序深度，并进一步探讨像PCR扩增偏好（PCR amplification bias）这样的常见技术因素如何引入冗余信息，从而影响有效的测序深度。[@problem_id:4651408]", "problem": "从一份血液样本中生成了一个临床鸟枪法宏基因组数据集。经过宿主去除和物种分类，推断出一种疑似病原体贡献了 $N=1\\times 10^{5}$ 条读段，平均长度为 $L=150$ 个碱基对 (bp)。该病原体的基因组大约为 $G=5\\times 10^{6}$ bp。从平均测序深度的基本定义（即在对碱基进行均匀随机抽样的情况下，基因组中每个碱基被抽样到的期望次数）出发，计算该病原体的预期平均深度。然后，考虑到聚合酶链式反应 (PCR) 会引入不增加新独特分子信息的重复读段，如果 PCR 重复率为 $10\\%$（即，有 $p=0.10$ 的比例是重复读段），估计其有效深度。假设重复读段相对于基因组均匀分布，并且在其原始读段之外不贡献额外的唯一碱基。报告预期的平均深度和考虑重复率后的有效深度，结果为无单位的覆盖倍数。提供精确值，不要四舍五入。", "solution": "解答分为两部分：计算预期平均深度和考虑PCR重复率后的有效深度。\n\n**第1部分：预期平均深度**\n\n平均测序深度（$C$）定义为测序总碱基数与基因组大小的比率。\n测序总碱基数 = 读段数量 ($N$) × 平均读段长度 ($L$) = $(1 \\times 10^{5}) \\times 150 = 1.5 \\times 10^{7}$ bp。\n基因组大小 ($G$) = $5 \\times 10^{6}$ bp。\n\n因此，预期平均深度为：\n$$ C = \\frac{N \\times L}{G} = \\frac{1.5 \\times 10^{7}\\ \\text{bp}}{5 \\times 10^{6}\\ \\text{bp}} = 3 $$\n预期的平均深度为 $3\\text{X}$。\n\n**第2部分：考虑重复率后的有效深度**\n\nPCR重复读段不提供新的序列信息。有效深度（$C_{\\text{eff}}$）应基于唯一的、非重复的读段计算。\nPCR重复率为 $p = 0.10$，因此唯一读段的比例为 $1 - p = 0.90$。\n\n有效深度是预期平均深度乘以唯一读段的比例：\n$$ C_{\\text{eff}} = C \\times (1 - p) = 3 \\times (1 - 0.10) = 3 \\times 0.90 = 2.7 $$\n考虑重复率后，有效深度为 $2.7\\text{X}$。\n\n因此，所要求的两个值分别是预期深度（3）和有效深度（2.7）。", "answer": "$$\n\\boxed{\\begin{pmatrix} 3  2.7 \\end{pmatrix}}\n$$", "id": "4651408"}, {"introduction": "一项检测技术的实验室性能（如灵敏度 $Se$ 和特异性 $Sp$）与其在特定临床情境下的实际应用价值不完全等同。本练习将引导你运用贝叶斯定理，计算阳性预测值（PPV）和阴性预测值（NPV），从而理解疾病患病率（prevalence）如何深刻影响检测结果的解释。通过这个例子，你将明白为何一个高精度的检测在低患病率人群中进行筛查时，其阳性结果的可靠性可能会出人意料地低。[@problem_id:4651397]", "problem": "一家医院正在评估一种应用于脑脊液 (CSF) 的宏基因组下一代测序 (mNGS) 检测，用于在表现为未分化脑病的患者中筛查病毒性脑炎。在一个确定的临床人群中，独立验证已估算出该检测的灵敏度和特异性如下：灵敏度 $\\left(\\mathrm{Se}\\right)=0.95$，特异性 $\\left(\\mathrm{Sp}\\right)=0.98$。在筛查人群中，该疾病的患病率为 $\\pi=0.01$。请仅使用灵敏度、特异性和患病率的基本定义，以及将它们与验后概率联系起来的条件概率法则，推导出阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式，然后根据给定的参数计算它们的数值。将PPV和NPV均表示为不带百分号的小数，并以有序对 $\\left(\\mathrm{PPV},\\mathrm{NPV}\\right)$ 的形式报告结果，四舍五入到四位有效数字。最后，根据您的计算结果和所使用的定义，用一两句话说明这些值如何影响mNGS作为一种在该人群中用于脑脊液病毒性脑炎筛查的检测方法的临床效用。", "solution": "设 D 为患病事件，T+ 为检测结果阳性事件。已知参数为：\n- 灵敏度 $\\mathrm{Se} = P(T^+ | D) = 0.95$\n- 特异性 $\\mathrm{Sp} = P(T^- | D^c) = 0.98$\n- 患病率 $\\pi = P(D) = 0.01$\n\n**阳性预测值 (PPV) 推导与计算**\nPPV 是检测结果为阳性的条件下，患者确实患病的概率，即 $P(D | T^+)$。根据贝叶斯定理：\n$$\n\\mathrm{PPV} = \\frac{P(T^+ | D) P(D)}{P(T^+)} = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp}) \\cdot (1 - \\pi)}\n$$\n代入数值：\n$$\n\\mathrm{PPV} = \\frac{0.95 \\cdot 0.01}{0.95 \\cdot 0.01 + (1 - 0.98) \\cdot (1 - 0.01)} = \\frac{0.0095}{0.0095 + 0.0198} = \\frac{0.0095}{0.0293} \\approx 0.32423...\n$$\n四舍五入至四位有效数字，$\\mathrm{PPV} \\approx 0.3242$。\n\n**阴性预测值 (NPV) 推导与计算**\nNPV 是检测结果为阴性的条件下，患者确实未患病的概率，即 $P(D^c | T^-)$。根据贝叶斯定理：\n$$\n\\mathrm{NPV} = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)} = \\frac{\\mathrm{Sp} \\cdot (1 - \\pi)}{\\mathrm{Sp} \\cdot (1 - \\pi) + (1 - \\mathrm{Se}) \\cdot \\pi}\n$$\n代入数值：\n$$\n\\mathrm{NPV} = \\frac{0.98 \\cdot (1 - 0.01)}{0.98 \\cdot (1 - 0.01) + (1 - 0.95) \\cdot 0.01} = \\frac{0.9702}{0.9702 + 0.0005} = \\frac{0.9702}{0.9707} \\approx 0.99948...\n$$\n四舍五入至四位有效数字，$\\mathrm{NPV} \\approx 0.9995$。\n\n**临床效用说明**\n极高的NPV ($0.9995$) 意味着阴性结果非常可靠，使该检测成为一个优秀的排除性工具。然而，相对较低的PPV ($0.3242$) 表明，在此低患病率人群中，约68%的阳性结果是假阳性，因此所有阳性结果都必须通过其他方法进行验证。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3242  0.9995 \\end{pmatrix}}\n$$", "id": "4651397"}]}