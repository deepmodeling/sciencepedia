{"hands_on_practices": [{"introduction": "粪菌移植（FMT）的一个主要目标是恢复肠道菌群失调时损失的微生物多样性。为了量化这一变化，生态学家使用香农指数等多样性指数，该指数同时考虑了物种数量（丰富度）和它们的相对丰度（均匀度）。通过这项练习 [@problem_id:4630352]，你将计算并比较FMT前后微生物群落的多样性，从而为评估治疗效果提供一个定量的衡量标准。", "problem": "一家临床研究实验室正在评估粪便微生物群移植（FMT）对一名患有复发性 Clostridioides difficile 感染的患者肠道微生物多样性的影响。他们获得了两个粪便菌群的高质量扩增子测序计数：一个在 FMT 之前（菌群 A），一个在 FMT 之后（菌群 B）。对于每个菌群，其分类单元和读数计数如下，其中每个菌群的总计数是其所列计数的总和。\n\n菌群 A（FMT 前）计数：\n- Bacteroides：$2800$\n- Prevotella：$2200$\n- Faecalibacterium：$1500$\n- Clostridium sensu stricto：$1200$\n- Escherichia/Shigella：$800$\n- 其他专性厌氧菌：$500$\n\n菌群 B（FMT 后）计数：\n- Bacteroides：$1700$\n- Prevotella：$1600$\n- Faecalibacterium：$1500$\n- Clostridium sensu stricto：$1400$\n- Escherichia/Shigella：$1400$\n- 其他专性厌氧菌：$1400$\n\n根据香农多样性的核心生态学定义，对于一个物种水平相对丰度为 $\\{p_i\\}$ 的群落，其香non指数 $H$ 为\n$$\nH \\;=\\; -\\sum_{i} p_i \\,\\ln(p_i),\n$$\n其中 $\\ln$ 表示自然对数，且 $p_i = n_i/N$，其中 $n_i$ 是物种 $i$ 的计数，$N$ 是群落总数。\n\n任务：\n1. 使用以上计数，计算菌群 A 的香non指数 $H_A$ 和菌群 B 的香non指数 $H_B$。\n2. 根据香non指数，说明哪个菌群更多样化。\n3. 定义差值 $\\Delta H = H_B - H_A$，并将这个数值作为您的最终答案。\n\n使用 $\\ln$（自然对数）。将所有报告的中间香non指数和最终的 $\\Delta H$ 四舍五入到四位有效数字。最终答案以十进制数表示（单位：奈特）。最终方框内的答案必须仅为 $\\Delta H$ 的单个值。", "solution": "该问题要求计算和比较两个微生物菌群 A（FMT 前）和 B（FMT 后）的香农多样性指数。香农指数 $H$ 是生态学中用于量化群落内多样性的一个指标。它同时考虑了不同物种的数量（丰富度）及其相对丰度（均匀度）。其公式如下：\n$$\nH = -\\sum_{i=1}^{S} p_i \\ln(p_i)\n$$\n其中 $S$ 是物种（分类单元）的数量，$p_i$ 是物种 $i$ 的相对丰度，$\\ln$ 是自然对数。相对丰度 $p_i$ 的计算方式为 $p_i = n_i / N$，其中 $n_i$ 是物种 $i$ 的个体数（读数计数），$N$ 是群落中的个体总数。使用自然对数时，$H$ 的单位是奈特。\n\n首先，我们计算每个菌群的总计数 $N_A$ 和 $N_B$。\n\n对于菌群 A（FMT 前），计数如下：\n- Bacteroides：$n_{A,1} = 2800$\n- Prevotella：$n_{A,2} = 2200$\n- Faecalibacterium：$n_{A,3} = 1500$\n- Clostridium sensu stricto：$n_{A,4} = 1200$\n- Escherichia/Shigella：$n_{A,5} = 800$\n- 其他专性厌氧菌：$n_{A,6} = 500$\n\n菌群 A 的总计数为：\n$$\nN_A = 2800 + 2200 + 1500 + 1200 + 800 + 500 = 9000\n$$\n\n对于菌群 B（FMT 后），计数如下：\n- Bacteroides：$n_{B,1} = 1700$\n- Prevotella：$n_{B,2} = 1600$\n- Faecalibacterium：$n_{B,3} = 1500$\n- Clostridium sensu stricto：$n_{B,4} = 1400$\n- Escherichia/Shigella：$n_{B,5} = 1400$\n- 其他专性厌氧菌：$n_{B,6} = 1400$\n\n菌群 B 的总计数为：\n$$\nN_B = 1700 + 1600 + 1500 + 1400 + 1400 + 1400 = 9000\n$$\n两个菌群具有相同的总计数 $N = 9000$ 和相同的丰富度 $S=6$。\n\n接下来，我们计算每个菌群的香农指数。\n\n**任务1：计算菌群 A 的香农指数 $H_A$**\n菌群 A 的相对丰度 $p_{A,i}$ 为：\n$p_{A,1} = 2800/9000 \\approx 0.3111$\n$p_{A,2} = 2200/9000 \\approx 0.2444$\n$p_{A,3} = 1500/9000 \\approx 0.1667$\n$p_{A,4} = 1200/9000 \\approx 0.1333$\n$p_{A,5} = 800/9000 \\approx 0.0889$\n$p_{A,6} = 500/9000 \\approx 0.0556$\n\n现在，我们计算 $H_A$：\n$$\nH_A = -\\left( \\frac{2800}{9000}\\ln\\left(\\frac{2800}{9000}\\right) + \\frac{2200}{9000}\\ln\\left(\\frac{2200}{9000}\\right) + \\frac{1500}{9000}\\ln\\left(\\frac{1500}{9000}\\right) + \\frac{1200}{9000}\\ln\\left(\\frac{1200}{9000}\\right) + \\frac{800}{9000}\\ln\\left(\\frac{800}{9000}\\right) + \\frac{500}{9000}\\ln\\left(\\frac{500}{9000}\\right) \\right)\n$$\n进行计算：\n$H_A \\approx 1.650625$。\n四舍五入到四位有效数字，菌群 A 的香农指数为 $H_A \\approx 1.651$ 奈特。\n\n**任务1：计算菌群 B 的香农指数 $H_B$**\n菌群 B 的相对丰度 $p_{B,i}$ 为：\n$p_{B,1} = 1700/9000 \\approx 0.1889$\n$p_{B,2} = 1600/9000 \\approx 0.1778$\n$p_{B,3} = 1500/9000 \\approx 0.1667$\n$p_{B,4} = 1400/9000 \\approx 0.1556$\n$p_{B,5} = 1400/9000 \\approx 0.1556$\n$p_{B,6} = 1400/9000 \\approx 0.1556$\n\n现在，我们计算 $H_B$：\n$$\nH_B = -\\left( \\frac{1700}{9000}\\ln\\left(\\frac{1700}{9000}\\right) + \\frac{1600}{9000}\\ln\\left(\\frac{1600}{9000}\\right) + \\frac{1500}{9000}\\ln\\left(\\frac{1500}{9000}\\right) + 3 \\times \\frac{1400}{9000}\\ln\\left(\\frac{1400}{9000}\\right) \\right)\n$$\n进行计算：\n$H_B \\approx 1.788841$。\n四舍五入到四位有效数字，菌群 B 的香农指数为 $H_B \\approx 1.789$ 奈特。\n\n**任务2：说明哪个菌群更多样化**\n比较两个指数：\n$H_B \\approx 1.789$ 和 $H_A \\approx 1.651$。\n由于 $H_B > H_A$，菌群 B（FMT 后）比菌群 A（FMT 前）更多样化。这与成功的 FMT 结果一致，FMT 的目的就是恢复健康、多样化的肠道微生物群。在这种情况下，多样性的增加是由于更高的均匀度，因为菌群 B 中各分类单元的相对丰度比菌群 A 中的更相似，而在菌群 A 中，少数几个分类单元占主导地位。\n\n**任务3：定义并计算差值 $\\Delta H = H_B - H_A$**\n香农多样性的差值定义为 $\\Delta H = H_B - H_A$。为避免舍入误差，我们使用未舍入的值进行计算。\n$$\n\\Delta H = 1.788841... - 1.650625... = 0.138216...\n$$\n按要求将最终答案四舍五入到四位有效数字：\n$$\n\\Delta H \\approx 0.1382\n$$\n这个正值证实了粪便微生物群移植后微生物多样性的增加。", "answer": "$$\\boxed{0.1382}$$", "id": "4630352"}, {"introduction": "与任何药物治疗类似，粪菌移植的疗效也可能取决于所移植微生物的“剂量”。我们可以借鉴药理学中的概念来模拟这种关系，例如$E_{\\max}$模型，它描述了生物学效应如何随着剂量的增加而达到饱和。这项练习 [@problem_id:4630387] 将指导你应用剂量效应模型来预测FMT的预期疗效，展示如何将微生物疗法进行量化分析。", "problem": "在用于治疗复发性艰难梭菌感染 (CDI) 的粪菌群移植中，临床医生通常以菌落形成单位 (CFU) 来量化所施用的活体供体菌群。考虑一个概念模型，其中临床疗效（用 $E$ 表示，并解释为 $0$ 到 $1$ 之间的无量纲分数）随剂量 $D$（以 CFU 衡量）单调增加，并在最大疗效 $E_{\\max}$ 处达到饱和。假设一个简单的质量作用定律框架，用于菌群植入一组有限的、相同的、独立的生态位，并具有以下基本定义和约束：(i) 疗效与平衡时已占据生态位的比例成正比，(ii) 半数有效剂量 $ED_{50}$ 定义为当 $D=ED_{50}$ 时 $E$ 等于 $\\frac{E_{\\max}}{2}$，以及 (iii) 当 $D \\to \\infty$ 时响应饱和至 $E_{\\max}$，当 $D=0$ 时响应为 $0$。使用这些假设，推导出一个关于 $D$、$E_{\\max}$ 和 $ED_{50}$ 的 $E$ 的解析表达式。然后，评估当 $E_{\\max}=0.9$，$ED_{50}=5\\times 10^{10}$ CFU 和 $D=1\\times 10^{11}$ CFU 时的预期疗效。将最终疗效表示为不带百分号的小数。无需四舍五入。", "solution": "该问题要求基于质量作用定律模型推导剂量-反应关系，该模型描述了供体菌群植入有限数量的生态位。此过程类似于配体与一组独立受体的结合。\n\n设 $N$ 为可用生态位的总数。设 $N_{occ}$ 为平衡时被供体菌群占据的生态位数，设 $N_{unocc}$ 为未被占据的生态位数。生态位总数是恒定的：\n$$N = N_{occ} + N_{unocc}$$\n\n植入过程可以建模为一个可逆反应，其中来自剂量 $D$ 的一个菌群单位与一个未占据的生态位 $U$ 结合，形成一个已占据的生态位 $O$：\n$$D + U \\underset{k_{off}}{\\stackrel{k_{on}}{\\rightleftharpoons}} O$$\n这里，$k_{on}$ 是结合速率常数，$k_{off}$ 是解离速率常数。\n\n根据质量作用定律，生态位占据的速率与剂量 $D$ 和未占据生态位的数量 $N_{unocc}$ 成正比：\n$$Rate_{occupation} = k_{on} D N_{unocc}$$\n生态位空出（解离）的速率与已占据生态位的数量 $N_{occ}$ 成正比：\n$$Rate_{vacation} = k_{off} N_{occ}$$\n\n在平衡状态下，这两个速率相等：\n$$k_{on} D N_{unocc} = k_{off} N_{occ}$$\n代入 $N_{unocc} = N - N_{occ}$：\n$$k_{on} D (N - N_{occ}) = k_{off} N_{occ}$$\n我们可以解出 $N_{occ}$：\n$$k_{on} D N - k_{on} D N_{occ} = k_{off} N_{occ}$$\n$$k_{on} D N = (k_{off} + k_{on} D) N_{occ}$$\n$$N_{occ} = \\frac{k_{on} D N}{k_{off} + k_{on} D}$$\n\n已占据生态位的比例 $f$ 由 $\\frac{N_{occ}}{N}$ 给出：\n$$f = \\frac{N_{occ}}{N} = \\frac{k_{on} D}{k_{off} + k_{on} D}$$\n分子和分母同除以 $k_{on}$ 得：\n$$f = \\frac{D}{\\frac{k_{off}}{k_{on}} + D}$$\n我们定义解离常数 $K_D = \\frac{k_{off}}{k_{on}}$，它代表一半生态位被占据时的剂量。已占据生态位比例的方程变为：\n$$f(D) = \\frac{D}{K_D + D}$$\n\n根据约束 (i)，疗效 $E$ 与已占据生态位的比例 $f$ 成正比。设 $c$ 为比例常数：\n$$E(D) = c \\cdot f(D) = c \\frac{D}{K_D + D}$$\n\n现在我们使用给定的边界条件来确定常数 $c$ 和 $K_D$（用 $E_{\\max}$ 和 $ED_{50}$ 表示）。\n\n根据约束 (iii)，当剂量 $D$ 趋于无穷大时，疗效 $E$ 饱和于 $E_{\\max}$：\n$$E_{\\max} = \\lim_{D \\to \\infty} E(D) = \\lim_{D \\to \\infty} c \\frac{D}{K_D + D} = c \\lim_{D \\to \\infty} \\frac{1}{\\frac{K_D}{D} + 1} = c \\cdot 1 = c$$\n因此，比例常数 $c$ 等于最大疗效 $E_{\\max}$。现在的模型是：\n$$E(D) = E_{\\max} \\frac{D}{K_D + D}$$\n\n根据约束 (ii)，当剂量为 $D=ED_{50}$ 时，疗效为 $E = \\frac{E_{\\max}}{2}$：\n$$\\frac{E_{\\max}}{2} = E_{\\max} \\frac{ED_{50}}{K_D + ED_{50}}$$\n两边同除以 $E_{\\max}$（假设 $E_{\\max} \\neq 0$）：\n$$\\frac{1}{2} = \\frac{ED_{50}}{K_D + ED_{50}}$$\n$$K_D + ED_{50} = 2 \\cdot ED_{50}$$\n$$K_D = ED_{50}$$\n这个结果证实了基础结合模型的解离常数 $K_D$ 等同于唯象参数 $ED_{50}$。\n\n将 $K_D = ED_{50}$ 代入疗效方程，得到 $E$ 作为 $D$、$E_{\\max}$ 和 $ED_{50}$ 函数的最终解析表达式：\n$$E(D) = E_{\\max} \\frac{D}{ED_{50} + D}$$\n这是解的第一部分。\n\n对于第二部分，我们评估一个具体案例。给定的值为：\n$E_{\\max} = 0.9$\n$ED_{50} = 5 \\times 10^{10}$ CFU\n$D = 1 \\times 10^{11}$ CFU\n\n将这些值代入推导出的表达式：\n$$E = 0.9 \\cdot \\frac{1 \\times 10^{11}}{5 \\times 10^{10} + 1 \\times 10^{11}}$$\n计算可以通过提取因子 $10^{10}$ 来简化：\n$$E = 0.9 \\cdot \\frac{10 \\times 10^{10}}{5 \\times 10^{10} + 10 \\times 10^{10}} = 0.9 \\cdot \\frac{10 \\times 10^{10}}{(5 + 10) \\times 10^{10}} = 0.9 \\cdot \\frac{10}{15}$$\n化简分数：\n$$E = 0.9 \\cdot \\frac{2}{3}$$\n$$E = \\frac{9}{10} \\cdot \\frac{2}{3} = \\frac{18}{30} = \\frac{3}{5}$$\n以小数表示，疗效为：\n$$E = 0.6$$\n这就是给定条件下的预期疗效。", "answer": "$$\n\\boxed{0.6}\n$$", "id": "4630387"}, {"introduction": "确保粪菌移植的安全性需要对供体进行严格的病原体筛查，但没有哪种检测是完美无缺的。贝叶斯定理提供了一个强大的框架，用于理解出现假阴性结果的概率，其中考虑了检测的准确性和病原体的患病率。通过解决这个问题 [@problem_id:4630418]，你将学会计算在获得阴性检测结果后病原体仍然存在的后验概率，这是评估医疗筛查中真实风险的一项关键技能。", "problem": "一项用于粪便微生物群移植 (FMT) 的临床粪便捐赠者计划，使用单次核酸扩增检测来筛查潜在捐赠者是否携带某种特定的肠道病原体。该检测的灵敏度为 $99.5\\%$，特异性为 $99.9\\%$。在经过初步非实验室筛选的预合格捐赠者中，该病原体的检测前患病率为 $1$ / $10{,}000$。某位捐赠者的实验室筛查结果为阴性。使用贝叶斯定理以及灵敏度和特异性的标准定义，从第一性原理推导出一个解析表达式，表示尽管检测结果为阴性，捐赠者仍然携带病原体的检测后概率，然后对其进行数值计算。将最终概率以小数形式表示（而非百分比），并将答案四舍五入至四位有效数字。", "solution": "该问题要求计算在检测结果为阴性的情况下，捐赠者携带特定病原体的检测后概率。这是贝叶斯定理在医学诊断背景下的一个经典应用。\n\n首先，我们必须根据问题陈述来正式定义事件和概率。\n设 $D$ 表示捐赠者携带病原体的事件。\n设 $D^c$ 表示捐赠者不携带病原体的事件。\n设 $T^-$ 表示实验室筛查结果为阴性的事件。\n设 $T^+$ 表示实验室筛查结果为阳性的事件。\n\n已知条件可以转化为概率术语如下：\n病原体的检测前患病率为 $1$ / $10{,}000$。这是捐赠者携带病原体的先验概率，即 $P(D)$。\n$$P(D) = \\frac{1}{10{,}000} = 0.0001$$\n因此，捐赠者不携带病原体的概率为：\n$$P(D^c) = 1 - P(D) = 1 - 0.0001 = 0.9999$$\n\n检测的灵敏度为 $99.5\\%$。灵敏度是指在个体确实携带病原体的情况下，检测结果为阳性的概率。\n$$\\text{Sensitivity} = P(T^+ | D) = 0.995$$\n\n检测的特异性为 $99.9\\%$。特异性是指在个体确实不携带病原体的情况下，检测结果为阴性的概率。\n$$\\text{Specificity} = P(T^- | D^c) = 0.999$$\n\n我们被要求计算尽管检测结果为阴性，捐赠者仍然携带病原体的检测后概率。这就是条件概率 $P(D | T^-)$。\n\n我们将使用贝叶斯定理来推导这个概率，其公式如下：\n$$P(D | T^-) = \\frac{P(T^- | D) \\cdot P(D)}{P(T^-)}$$\n\n为了使用这个公式，我们需要确定等式右边各项的值。\n项 $P(D)$ 是患病率，已知为 $0.0001$。\n项 $P(T^- | D)$ 是在捐赠者携带病原体的情况下检测结果为阴性的概率。这是灵敏度的补集。因为携带病原体的捐赠者检测结果要么为阳性，要么为阴性，所以这些概率之和为 $1$。\n$$P(T^- | D) = 1 - P(T^+ | D) = 1 - \\text{Sensitivity} = 1 - 0.995 = 0.005$$\n这个值也被称为检测的假阴性率。\n\n项 $P(T^-)$ 是无论捐赠者真实患病状态如何，获得阴性检测结果的总概率。我们可以使用全概率定律来计算它：\n$$P(T^-) = P(T^- | D) \\cdot P(D) + P(T^- | D^c) \\cdot P(D^c)$$\n我们有进行此计算所需的所有要素：\n- $P(T^- | D) = 0.005$\n- $P(D) = 0.0001$\n- $P(T^- | D^c) = \\text{Specificity} = 0.999$\n- $P(D^c) = 0.9999$\n\n将这些值代入全概率定律：\n$$P(T^-) = (0.005)(0.0001) + (0.999)(0.9999)$$\n\n现在，我们可以构建 $P(D | T^-)$ 的完整解析表达式。设 $p = P(D)$ 为患病率，$\\text{Sens} = P(T^+|D)$ 为灵敏度，$\\text{Spec} = P(T^-|D^c)$ 为特异性。该表达式为：\n$$P(D | T^-) = \\frac{P(T^- | D) \\cdot P(D)}{P(T^- | D) \\cdot P(D) + P(T^- | D^c) \\cdot P(D^c)}$$\n$$P(D | T^-) = \\frac{(1 - \\text{Sens}) \\cdot p}{(1 - \\text{Sens}) \\cdot p + \\text{Spec} \\cdot (1 - p)}$$\n这就是从第一性原理推导出的解析表达式。\n\n接下来，我们使用给定值对该表达式进行数值计算：\n$p = 0.0001$，$\\text{Sens} = 0.995$，$\\text{Spec} = 0.999$。\n$$P(D | T^-) = \\frac{(1 - 0.995) \\cdot 0.0001}{(1 - 0.995) \\cdot 0.0001 + 0.999 \\cdot (1 - 0.0001)}$$\n$$P(D | T^-) = \\frac{0.005 \\cdot 0.0001}{0.005 \\cdot 0.0001 + 0.999 \\cdot 0.9999}$$\n首先，我们计算分子：\n$$\\text{Numerator} = 0.005 \\times 0.0001 = 0.0000005 = 5 \\times 10^{-7}$$\n接下来，我们计算分母：\n$$\\text{Denominator} = (0.0000005) + (0.999 \\times 0.9999)$$\n$$0.999 \\times 0.9999 = 0.9989001$$\n$$\\text{Denominator} = 0.0000005 + 0.9989001 = 0.9989006$$\n最后，我们计算概率：\n$$P(D | T^-) = \\frac{0.0000005}{0.9989006} \\approx 0.0000005005501$$\n问题要求最终概率以小数形式表示，并四舍五入至四位有效数字。结果的前四位有效数字是 $5$、$0$、$0$ 和 $5$。第五位有效数字是 $5$，这意味着我们必须将第四位有效数字向上取整。\n$$0.0000005005501 \\approx 0.0000005006$$\n这就是在检测结果为阴性的情况下，捐赠者携带病原体的检测后概率。", "answer": "$$\\boxed{0.0000005006}$$", "id": "4630418"}]}