{"hands_on_practices": [{"introduction": "在临床实践中，一个阳性的检测结果并不总是意味着患者确实患有该疾病，尤其是在疾病患病率较低的情况下。这个练习将帮助你理解先验概率（患病率）、检测的准确性（灵敏度和特异性）以及启动治疗所需的置信度（后验概率）之间的重要关系。通过计算达到治疗决策阈值所需的最低先天性巨细胞病毒（CMV）患病率，你将学会如何应用贝叶斯定理来指导临床决策 [@problem_id:4622561]。", "problem": "一个针对先天性巨细胞病毒 (CMV) 的新生儿筛查项目使用在出生后头 $21$ 天内获取的唾液聚合酶链式反应 (PCR)。设二元条件为“患有先天性CMV”，并用 $p$ 表示先验概率（在被筛查的新生儿中的患病率）。该检测的灵敏度为 $S_{e} = 0.97$，特异性为 $S_{p} = 0.99$。医院政策规定，仅当单次筛查呈阳性的新生儿确实患有先天性CMV的后验概率至少达到决策阈值 $T = 0.30$ 时，才会在出生后 $30$ 天内启动口服valganciclovir疗法。该项目旨在确定最小的先验概率 $p^{\\ast}$，使得当观察到筛查结果为阳性时，真正患有先天性CMV的后验概率达到治疗阈值。\n\n从灵敏度和特异性的核心定义以及二元条件下的全概率定律出发，推导出一个关于 $S_{e}$、$S_{p}$ 和 $T$ 的 $p^{\\ast}$ 的解析表达式，该 $p^{\\ast}$ 对应于满足治疗决策的最小 $p$。然后，使用给定值对该表达式进行数值计算。将最终答案表示为小数（不带百分号），并四舍五入到四位有效数字。", "solution": "问题要求解最小的先验概率（患病率），记为 $p^{\\ast}$，使得在单次筛查结果为阳性的条件下，患有先天性巨细胞病毒 (CMV) 感染的后验概率达到或超过指定的决策阈值 $T$。\n\n首先，我们建立概率框架。设 $D$ 为新生儿患有该疾病（先天性CMV）的事件，设 $+$ 为筛查检测结果为阳性的事件。给定条件可以表示为以下概率：\n-   患病的先验概率为 $P(D) = p$。\n-   不患病的概率为 $P(D^c) = 1 - P(D) = 1 - p$。\n-   检测的灵敏度是在患病条件下结果为阳性的概率：$S_e = P(+|D) = 0.97$。\n-   检测的特异性是在未患病条件下结果为阴性的概率：$S_p = P(-|D^c) = 0.99$。\n\n根据特异性的定义，我们可以确定假阳性概率，即在未患病条件下检测结果为阳性的概率：\n$$P(+|D^c) = 1 - P(-|D^c) = 1 - S_p$$\n\n关键的目标量是新生儿在筛查结果为阳性的条件下患有先天性CMV的后验概率，记为 $P(D|+)$。这也被称为阳性预测值 (PPV)。根据贝叶斯定理，其表达式为：\n$$P(D|+) = \\frac{P(+|D) P(D)}{P(+)}$$\n\n分母 $P(+)$ 是检测结果为阳性的总概率。我们可以使用全概率定律计算它，即对两种可能的状态（患病或不患病）求和：\n$$P(+) = P(+|D) P(D) + P(+|D^c) P(D^c)$$\n代入我们已定义的项：\n$$P(+) = S_e \\cdot p + (1 - S_p) \\cdot (1 - p)$$\n\n现在我们可以写出后验概率 $P(D|+)$ 关于先验概率 $p$、灵敏度 $S_e$ 和特异性 $S_p$ 的完整表达式：\n$$P(D|+) = \\frac{S_e \\cdot p}{S_e \\cdot p + (1 - S_p) \\cdot (1 - p)}$$\n\n医院政策要求该后验概率至少为决策阈值 $T = 0.30$。这给了我们以下不等式：\n$$\\frac{S_e \\cdot p}{S_e \\cdot p + (1 - S_p) \\cdot (1 - p)} \\ge T$$\n\n我们需要找到满足此条件的最小先验概率 $p^{\\ast}$。对于固定的 $S_e$ 和 $S_p$（其中 $0  S_e  1$ 且 $0  S_p  1$），后验概率 $P(D|+)$ 是先验概率 $p$ 的单调递增函数。因此，最小值 $p^{\\ast}$ 将是满足以下等式的值：\n$$\\frac{S_e \\cdot p^{\\ast}}{S_e \\cdot p^{\\ast} + (1 - S_p) \\cdot (1 - p^{\\ast})} = T$$\n\n现在我们求解这个方程以得到 $p^{\\ast}$ 的解析表达式。\n$$S_e \\cdot p^{\\ast} = T \\cdot [S_e \\cdot p^{\\ast} + (1 - S_p)(1 - p^{\\ast})]$$\n$$S_e \\cdot p^{\\ast} = T S_e p^{\\ast} + T(1 - S_p) - T(1 - S_p)p^{\\ast}$$\n接下来，我们将所有包含 $p^{\\ast}$ 的项移到等式的一边：\n$$S_e \\cdot p^{\\ast} - T S_e p^{\\ast} + T(1 - S_p)p^{\\ast} = T(1 - S_p)$$\n提出因子 $p^{\\ast}$：\n$$p^{\\ast} [S_e - T S_e + T(1 - S_p)] = T(1 - S_p)$$\n$$p^{\\ast} [S_e(1 - T) + T(1 - S_p)] = T(1 - S_p)$$\n最后，我们分离出 $p^{\\ast}$ 以获得所需的解析表达式：\n$$p^{\\ast} = \\frac{T(1 - S_p)}{S_e(1 - T) + T(1 - S_p)}$$\n\n现在，我们代入问题中提供的数值：\n-   $S_e = 0.97$\n-   $S_p = 0.99$\n-   $T = 0.30$\n\n我们计算表达式中的各项：\n-   $1 - S_p = 1 - 0.99 = 0.01$\n-   $1 - T = 1 - 0.30 = 0.70$\n\n将这些值代入 $p^{\\ast}$ 的表达式中：\n$$p^{\\ast} = \\frac{0.30 \\cdot (0.01)}{0.97 \\cdot (0.70) + 0.30 \\cdot (0.01)}$$\n计算分子和分母：\n$$p^{\\ast} = \\frac{0.003}{0.679 + 0.003}$$\n$$p^{\\ast} = \\frac{0.003}{0.682}$$\n进行除法运算：\n$$p^{\\ast} \\approx 0.004398826979...$$\n问题要求答案四舍五入到四位有效数字。第一位有效数字是千分位的 $4$。四位有效数字是 $4, 3, 9, 8$。第五位有效数字是 $8$，所以我们将第四位向上取整。\n$$p^{\\ast} \\approx 0.004399$$\n因此，在筛查结果为阳性的情况下，达到治疗阈值所需的最小先验概率约为 $0.004399$。", "answer": "$$\\boxed{0.004399}$$", "id": "4622561"}, {"introduction": "为了提高诊断的准确性并克服单一检测的局限性，临床上常常采用多种独立的检测方法。这项练习将向你展示如何量化地结合来自多个来源的证据。通过计算一名新生儿在唾液和尿液核酸扩增检测（NAATs）均为阳性的情况下，确实患有先天性巨细胞病毒（CMV）感染的后验概率，你将亲身体会到联合检测如何显著提高诊断的确定性 [@problem_id:4622562]。", "problem": "一项针对弓形虫（Toxoplasma gondii）、其他病原体（Other）、风疹病毒（Rubella virus）、巨细胞病毒（Cytomegalovirus）和单纯疱疹病毒（Herpes simplex viruses）（TORCH）感染组的新生儿先天性感染筛查项目，通过两种独立的核酸扩增测试（NAATs）来评估先天性巨细胞病毒（CMV）感染：一项唾液测试和一项尿液测试，样本在出生后的前 $21$ 天内采集。在该项目所服务的地区，活产婴儿中先天性CMV的患病率估计为 $0.006$。唾液NAAT的灵敏度为 $0.93$，特异度为 $0.985$。尿液NAAT的灵敏度为 $0.97$，特异度为 $0.995$。假设在给定真实感染状态的情况下，两种NAAT的结果是条件独立的，并且测试性能特征在整个筛查人群中是稳定的。一名新生儿的唾液和尿液NAATs筛查结果均为阳性。\n\n仅使用灵敏度、特异度、患病率（作为先验概率）、条件概率和全概率定律的基本定义，从第一性原理出发，推导在两次测试均为阳性的条件下，该新生儿确实患有先天性CMV感染的精确后验概率。将您的最终答案表示为小数，并四舍五入到四位有效数字。请勿使用百分号。", "solution": "设 $D$ 为新生儿患有先天性巨细胞病毒（CMV）感染的事件。\n设 $D^c$ 为新生儿未患有先天性巨细胞病毒（CMV）感染的事件。\n设 $S^+$ 为唾液核酸扩增测试（NAAT）结果为阳性的事件。\n设 $U^+$ 为尿液NAAT结果为阳性的事件。\n\n问题提供了以下诊断测试的概率和性能特征：\n\n1.  先天性CMV的患病率，即疾病的先验概率：\n    $$P(D) = 0.006$$\n    由此，未患病的概率为：\n    $$P(D^c) = 1 - P(D) = 1 - 0.006 = 0.994$$\n\n2.  唾液测试的灵敏度，即在存在疾病的情况下测试结果为阳性的概率：\n    $$Se_S = P(S^+ | D) = 0.93$$\n\n3.  唾液测试的特异度，即在不存在疾病的情况下测试结果为阴性的概率：\n    $$Sp_S = P(S^- | D^c) = 0.985$$\n    因此，唾液测试的假阳性概率为：\n    $$P(S^+ | D^c) = 1 - Sp_S = 1 - 0.985 = 0.015$$\n\n4.  尿液测试的灵敏度：\n    $$Se_U = P(U^+ | D) = 0.97$$\n\n5.  尿液测试的特异度：\n    $$Sp_U = P(U^- | D^c) = 0.995$$\n    因此，尿液测试的假阳性概率为：\n    $$P(U^+ | D^c) = 1 - Sp_U = 1 - 0.995 = 0.005$$\n\n问题要求的是在唾液和尿液测试均为阳性的条件下，新生儿确实患有先天性CMV感染的后验概率。这就是条件概率 $P(D | S^+ \\cap U^+)$。\n\n我们从条件概率的基本定义开始：\n$$P(D | S^+ \\cap U^+) = \\frac{P(D \\cap (S^+ \\cap U^+))}{P(S^+ \\cap U^+)}$$\n\n我们分别分析分子和分母。\n\n分子 $P(D \\cap S^+ \\cap U^+)$ 可以使用条件概率的定义 $P(A \\cap B) = P(A|B)P(B)$ 重新表示：\n$$P(D \\cap S^+ \\cap U^+) = P(S^+ \\cap U^+ | D) P(D)$$\n问题陈述，两种测试在给定真实感染状态的情况下是条件独立的。这意味着在给定疾病状态下，两个测试都为阳性的概率是它们各自概率的乘积。因此，对于分子：\n$$P(S^+ \\cap U^+ | D) = P(S^+ | D) \\times P(U^+ | D)$$\n代入给定的灵敏度值：\n$$P(S^+ \\cap U^+ | D) = Se_S \\times Se_U = 0.93 \\times 0.97 = 0.9021$$\n因此，分子是：\n$$P(D \\cap S^+ \\cap U^+) = (0.93 \\times 0.97) \\times 0.006 = 0.9021 \\times 0.006 = 0.0054126$$\n\n分母 $P(S^+ \\cap U^+)$ 是观察到两个阳性测试的总概率。我们使用全概率定律来计算它，通过事件 $D$（存在疾病）和 $D^c$（不存在疾病）来划分样本空间：\n$$P(S^+ \\cap U^+) = P(S^+ \\cap U^+ | D) P(D) + P(S^+ \\cap U^+ | D^c) P(D^c)$$\n第一项 $P(S^+ \\cap U^+ | D) P(D)$ 与我们刚刚计算的分子相同，即 $0.0054126$。\n\n对于第二项 $P(S^+ \\cap U^+ | D^c) P(D^c)$，我们再次使用测试的条件独立性：\n$$P(S^+ \\cap U^+ | D^c) = P(S^+ | D^c) \\times P(U^+ | D^c)$$\n这些分别是唾液和尿液测试的假阳性率：\n$$P(S^+ | D^c) = 1 - Sp_S = 0.015$$\n$$P(U^+ | D^c) = 1 - Sp_U = 0.005$$\n所以，两个假阳性的联合概率是：\n$$P(S^+ \\cap U^+ | D^c) = 0.015 \\times 0.005 = 0.000075$$\n现在我们可以计算分母的第二项：\n$$P(S^+ \\cap U^+ | D^c) P(D^c) = 0.000075 \\times 0.994 = 0.00007455$$\n\n分母中的总概率是这两项的和：\n$$P(S^+ \\cap U^+) = 0.0054126 + 0.00007455 = 0.00548715$$\n\n最后，我们可以通过将分子除以分母来计算所需的后验概率：\n$$P(D | S^+ \\cap U^+) = \\frac{0.0054126}{0.00548715} \\approx 0.986411499$$\n\n问题要求答案表示为小数并四舍五入到四位有效数字。\n第五位有效数字是 $1$，所以我们向下舍入。\n$$P(D | S^+ \\cap U^+) \\approx 0.9864$$\n这就是两次NAAT结果均为阳性的新生儿确实患有先天性CMV感染的后验概率。", "answer": "$$\\boxed{0.9864}$$", "id": "4622562"}, {"introduction": "诊断检测的最终目标是改善患者预后并降低人群的疾病负担。这项综合性练习将引导你从个体诊断的层面，跃升至评估公共卫生干预措施有效性的层面。通过模拟一个真实的产前梅毒筛查与治疗项目，你将整合检测性能、疾病分期、治疗效果和传播风险等多个概率因素，以计算预期的新生儿先天性梅毒病例数，从而评估整个方案的公共卫生影响 [@problem_id:4622569]。", "problem": "先天性TORCH感染是指在宫内获得的垂直传播感染，经典上包括弓形虫病（Toxoplasmosis）、其他（包括梅毒，syphilis）、风疹（Rubella）、巨细胞病毒（Cytomegalovirus）和单纯疱疹病毒（Herpes simplex virus）（TORCH）。考虑该组中的梅毒。一个产前筛查项目采用两步算法：首先通过快速血浆反应素试验（Rapid Plasma Reagin, RPR）进行初步的非梅毒螺旋体筛查，然后通过梅毒螺旋体颗粒凝集试验（Treponema pallidum particle agglutination, TP-PA）进行梅毒螺旋体确诊试验。只有两项检测结果均为阳性的孕妇才会被提供治疗。假设以下有科学依据的基本事实和参数：\n- 该队列有 $10{,}000$ 名孕妇；首次产前检查时孕妇梅毒的患病率为 $0.02$。在受感染的女性中，筛查时有 $0.30$ 处于一期或二期梅毒，$0.50$ 处于早期潜伏期梅毒，$0.20$ 处于晚期潜伏期梅毒。\n- 对于真正受感染的女性，RPR试验在一期/二期梅毒中的灵敏度为 $0.90$，在早期潜伏期梅毒中为 $0.80$，在晚期潜伏期梅毒中为 $0.70$。在未受感染的女性中，RPR的特异度为 $0.98$。对于TP-PA试验，其在受感染女性中的灵敏度为 $0.98$（无论处于哪个分期），在未受感染女性中的特异度为 $0.99$。\n- 只有RPR和TP-PA检测均呈阳性的女性才被视为已识别并获得治疗。在被识别出的受感染女性中，$0.90$ 的人接受了适当的苄星青霉素G（benzathine penicillin G）治疗，并在分娩前至少30天完成。所有其他人都未接受能有效预防先天性梅毒的治疗。\n- 在没有有效母体治疗的情况下，分娩时按疾病分期划分的垂直传播概率为：一期/二期梅毒为 $0.70$，早期潜伏期梅毒为 $0.40$，晚期潜伏期梅毒为 $0.10$。若在分娩前至少30天完成了适当的母体治疗，则无论处于哪个分期，残余传播概率均为 $0.02$。\n- 假设所有怀孕都以活产告终，并且未受感染女性的假阳性检测结果不会带来先天性梅毒的风险。\n\n仅使用灵敏度、特异度、条件概率和期望值的核心定义，计算在该队列中实施上述诊断和治疗算法后，患有先天性梅毒的新生儿的期望数量。将最终答案四舍五入到三位有效数字。以纯数字形式表示答案，不带单位。", "solution": "目标是计算给定队列中患有先天性梅毒（CS）的新生儿的期望总数。根据问题陈述，先天性梅毒的风险仅限于由受感染母亲所生的婴儿。未受感染的母亲，即使其检测结果为假阳性，也不会计入先天性梅毒病例的数量。\n\n设队列中孕妇总数为 $N$，即 $N = 10,000$。\n设孕妇梅毒的患病率为 $P(I)$，给定值为 $P(I) = 0.02$。\n受感染女性的总数 $N_I$ 为：\n$$N_I = N \\times P(I) = 10,000 \\times 0.02 = 200$$\n\n受感染人群按疾病分期进行分层：一期/二期 ($S_1$)、早期潜伏期 ($S_2$) 和晚期潜伏期 ($S_3$)。每个分期的女性人数为：\n一期/二期梅毒人数：$N_{S_1} = N_I \\times P(S_1|I) = 200 \\times 0.30 = 60$。\n早期潜伏期梅毒人数：$N_{S_2} = N_I \\times P(S_2|I) = 200 \\times 0.50 = 100$。\n晚期潜伏期梅毒人数：$N_{S_3} = N_I \\times P(S_3|I) = 200 \\times 0.20 = 40$。\n总和为 $60 + 100 + 40 = 200$，数据一致。\n\n先天性梅毒病例的期望数量是每个子群体期望数量的总和。一名女性可能得到有效治疗（$Tx$），也可能未得到有效治疗（$\\neg Tx$），而传播概率取决于这一状态。先天性梅毒病例的期望数量 $E[N_{CS}]$ 是各分期期望数量的总和：\n$$E[N_{CS}] = \\sum_{j=1}^{3} N_{S_j} \\times P(CS | I, S_j)$$\n其中 $P(CS | I, S_j)$ 是处于 $S_j$ 分期的女性的总体传播概率。根据全概率公式，这可以展开为：\n$$P(CS | I, S_j) = P(CS | Tx, S_j) P(Tx | I, S_j) + P(CS | \\neg Tx, S_j) P(\\neg Tx | I, S_j)$$\n\n首先，我们必须求出在给定分期 $S_j$ 的受感染女性获得治疗的概率 $P(Tx | I, S_j)$。治疗取决于是否通过筛查算法被识别（$Id$）。识别要求RPR和TP-PA两项检测结果均为阳性。我们假设在给定真实疾病状态的情况下，这两项检测的结果是条件独立的。\n处于 $S_j$ 分期的受感染女性被识别的概率为：\n$$P(Id | I, S_j) = P(\\text{RPR}^+ | I, S_j) \\times P(\\text{TP-PA}^+ | I, S_j)$$\n给定的灵敏度为：\n$P(\\text{RPR}^+ | I, S_1) = 0.90$\n$P(\\text{RPR}^+ | I, S_2) = 0.80$\n$P(\\text{RPR}^+ | I, S_3) = 0.70$\n$P(\\text{TP-PA}^+ | I, S_j) = 0.98$ for all stages $j$.\n\n因此，识别的概率为：\n对于 $S_1$：$P(Id | I, S_1) = 0.90 \\times 0.98 = 0.882$\n对于 $S_2$：$P(Id | I, S_2) = 0.80 \\times 0.98 = 0.784$\n对于 $S_3$：$P(Id | I, S_3) = 0.70 \\times 0.98 = 0.686$\n\n被识别出的受感染女性中有 $f_{Tx} = 0.90$ 的比例接受了有效治疗。未被识别出的女性则不接受治疗。因此，处于 $S_j$ 分期的受感染女性接受有效治疗的概率为：\n$$P(Tx | I, S_j) = P(Id | I, S_j) \\times f_{Tx}$$\n未接受有效治疗的概率为 $P(\\neg Tx | I, S_j) = 1 - P(Tx | I, S_j)$。\n\n给定的垂直传播概率如下：\n接受治疗的情况下：$P(CS | Tx, S_j) = P_{CS|Tx} = 0.02$（与分期无关）。\n未接受治疗的情况下：$P(CS | \\neg Tx, S_1) = 0.70$，$P(CS | \\neg Tx, S_2) = 0.40$，$P(CS | \\neg Tx, S_3) = 0.10$。\n\n现在我们可以计算每个分期的先天性梅毒病例的期望数量。\n\n对于分期 $S_1$（一期/二期，$N_{S_1} = 60$）：\n$P(Tx | I, S_1) = 0.882 \\times 0.90 = 0.7938$\n$P(\\neg Tx | I, S_1) = 1 - 0.7938 = 0.2062$\n来自 $S_1$ 的期望病例数：\n$E_1 = N_{S_1} \\times [P(CS | Tx, S_1)P(Tx | I, S_1) + P(CS | \\neg Tx, S_1)P(\\neg Tx | I, S_1)]$\n$E_1 = 60 \\times [ (0.02 \\times 0.7938) + (0.70 \\times 0.2062) ]$\n$E_1 = 60 \\times [ 0.015876 + 0.14434 ] = 60 \\times 0.160216 = 9.61296$\n\n对于分期 $S_2$（早期潜伏期，$N_{S_2} = 100$）：\n$P(Tx | I, S_2) = 0.784 \\times 0.90 = 0.7056$\n$P(\\neg Tx | I, S_2) = 1 - 0.7056 = 0.2944$\n来自 $S_2$ 的期望病例数：\n$E_2 = N_{S_2} \\times [P(CS | Tx, S_2)P(Tx | I, S_2) + P(CS | \\neg Tx, S_2)P(\\neg Tx | I, S_2)]$\n$E_2 = 100 \\times [ (0.02 \\times 0.7056) + (0.40 \\times 0.2944) ]$\n$E_2 = 100 \\times [ 0.014112 + 0.11776 ] = 100 \\times 0.131872 = 13.1872$\n\n对于分期 $S_3$（晚期潜伏期，$N_{S_3} = 40$）：\n$P(Tx | I, S_3) = 0.686 \\times 0.90 = 0.6174$\n$P(\\neg Tx | I, S_3) = 1 - 0.6174 = 0.3826$\n来自 $S_3$ 的期望病例数：\n$E_3 = N_{S_3} \\times [P(CS | Tx, S_3)P(Tx | I, S_3) + P(CS | \\neg Tx, S_3)P(\\neg Tx | I, S_3)]$\n$E_3 = 40 \\times [ (0.02 \\times 0.6174) + (0.10 \\times 0.3826) ]$\n$E_3 = 40 \\times [ 0.012348 + 0.03826 ] = 40 \\times 0.050608 = 2.02432$\n\n先天性梅毒病例的总期望数量是各分期期望病例数之和：\n$E[N_{CS}] = E_1 + E_2 + E_3 = 9.61296 + 13.1872 + 2.02432 = 24.82448$\n\n题目要求答案四舍五入到三位有效数字。\n$E[N_{CS}] \\approx 24.8$", "answer": "$$\\boxed{24.8}$$", "id": "4622569"}]}