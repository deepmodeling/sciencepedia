## 引言
在现代医学影像中，磁共振成像（MRI）以其卓越的软组织对比度和无电离辐射的优势占据着核心地位。然而，其相对较长的扫描时间不仅限制了临床通量，也使得成像过程易受患者运动的影响，从而导致图像质量下降。因此，提升成像速度一直是MRI技术发展的关键驱动力。[并行成像](@entry_id:753125)（Parallel Imaging, PI）正是应对这一挑战的革命性技术，它通过巧妙地利用多通道接收线圈阵列提供的额外空间信息，实现了在不严重牺牲图像质量的前提下大幅缩短扫描时间。

本文旨在系统性地介绍[并行成像](@entry_id:753125)方法。我们将首先直面加速成像所带来的核心问题——因数据[欠采样](@entry_id:272871)而产生的混叠伪影。随后，文章将分章节深入探讨如何解决这一难题。在“原理与机制”一章中，您将学习两大主流[并行成像](@entry_id:753125)技术——SENSE和GRAPPA的数学基础和工作流程，并理解评估其性能的关键指标。接着，在“应用与跨学科交叉”一章中，我们将展示[并行成像](@entry_id:753125)如何在临床实践中大显身手，从改善快速序列的[图像质量](@entry_id:176544)，到与多频带成像、[压缩感知](@entry_id:197903)等前沿技术融合，催生出强大的新应用。最后，“动手实践”部分将通过具体问题，帮助您巩固对核心概念的理解。通过本次学习，您将掌握[并行成像](@entry_id:753125)的理论精髓与应用价值，为未来在[医学影像](@entry_id:269649)领域的深入探索奠定坚实基础。

## 原理与机制

在磁共振成像（MRI）中，对速度的追求是永恒的主题。更快的成像速度不仅能提升患者的舒适度、减少运动伪影，还能实现以往无法企及的动态成像和功能成像应用。[并行成像](@entry_id:753125)（Parallel Imaging, PI）是实现这一目标的核心技术之一。它通过使用多个接收线圈阵列来采集数据，利用这些线圈在空间上不同的灵敏度分布来弥补因加速采集而丢失的[空间编码](@entry_id:755143)信息，从而在不显著牺牲[图像质量](@entry_id:176544)的前提下，大幅缩短扫描时间。本章将深入探讨[并行成像](@entry_id:753125)的基本原理与核心机制，从[欠采样](@entry_id:272871)引入的混叠问题出发，系统阐述两大主流重建方法——基于图像域的SENSE和基于k空间的GRAPPA——的数学模型、性能评估及其内在联系。

### 加速成像的挑战：混叠伪影

在傅里叶成像方法（如MRI）中，图像的空间分辨率由k空间（[空间频率](@entry_id:270500)域）的覆盖范围决定，而视野（Field of View, FOV）则由[k空间](@entry_id:142033)的采样密度决定。具体来说，沿着相位编码方向（我们称之为 $y$ 方向），k空间采样点之间的间隔 $\Delta k_y$ 与该方向的FOV大小 $\mathrm{FOV}_y$ 之间存在倒数关系：$\mathrm{FOV}_y = 1/\Delta k_y$。为了无失真地重建整个FOV内的物体，必须满足[奈奎斯特-香农采样定理](@entry_id:262499)。

[并行成像](@entry_id:753125)的核心思想是通过减少[相位编码](@entry_id:753388)的步数来加速[数据采集](@entry_id:273490)。如果我们跳过一些[k空间](@entry_id:142033)数据线，例如每隔 $R$ 条线才采集一条，采集速度便能提高 $R$ 倍，这个 $R$ 称作**加速因子**（acceleration factor）。这种均匀[欠采样](@entry_id:272871)使得k空间的有效采样间隔增大为 $\Delta k_y' = R \cdot \Delta k_y$。根据[傅里叶变换的性质](@entry_id:265641)，[k空间](@entry_id:142033)采样变稀疏，直接导致了图像域的[周期延拓](@entry_id:176490)收缩。重建出的图像FOV也相应减小为 $\mathrm{FOV}_y' = 1/\Delta k_y' = \mathrm{FOV}_y/R$。

这一后果是灾难性的。原始FOV中位于新的、缩小的FOV之外的物体部分，其信号会“折叠”或“卷曲”（wrap-around）回来，与小FOV内的[信号叠加](@entry_id:276221)在一起，形成所谓的**混叠伪影**（aliasing artifact）。我们可以通过数学推导精确地描述这一现象。假设原始物体的真实[自旋密度](@entry_id:267742)分布为 $f(y)$，在加速因子为 $R$ 的[欠采样](@entry_id:272871)下，进行朴素的[傅里叶逆变换](@entry_id:178300)后得到的混叠图像 $g_R(y)$ 在其有效FOV（即 $y \in [0, \mathrm{FOV}_y/R)$）内的任意一点，其信号值是[原始图](@entry_id:262918)像 $f(y)$ 在 $R$ 个不同空间位置信号的总和 [@problem_id:4904181]：

$$
g_R(y) = \sum_{k=0}^{R-1} f\left(y + k \frac{\mathrm{FOV}_y}{R}\right)
$$

这个公式清晰地表明，在重建图像中的一个像素点，其信号强度不再是对应空间位置的真实信号，而是 $R$ 个相隔一个折叠FOV（$\mathrm{FOV}_y/R$）的真实像素信号的线性叠加。例如，当 $R=2$ 时，位于 $y_A$ 和 $y_B = y_A + \mathrm{FOV}_y/2$ 处的两个体素的信号会混叠到同一点。如果只有一个接收线圈，我们只得到一个测量值，却有两个未知的真实信号值，这是一个欠定问题（underdetermined problem），无法唯一求解。这便是加速成像所面临的基本挑战 [@problem_id:4904154]。

### 图像域解决方案：SENSE方法

如何解开这个混叠的“结”？答案在于引入新的[信息维度](@entry_id:275194)。[并行成像](@entry_id:753125)的精妙之处在于利用了多通道接收线圈阵列。阵列中的每一个线圈都具有其独特的空间灵敏度分布，即它对空间中不同位置的信号有着不同的接收效率。这种**线圈灵敏度**（coil sensitivity）的空间依赖性，为我们提供了区分混叠信号所需的额外[空间编码](@entry_id:755143)信息。基于图像域的**灵敏度编码**（**SENSE**, SENSitivity Encoding）方法正是利用了这一原理。

让我们回到 $R=2$ 的例子。假设我们有两个接收线圈（Coil 1 和 Coil 2），它们的灵敏度在混叠的两个位置 $y_A$ 和 $y_B$ 处各不相同。令 $s_c(y)$ 表示线圈 $c$ 在位置 $y$ 处的复数灵敏度，$\rho_A$ 和 $\rho_B$ 分别为 $y_A$ 和 $y_B$ 处的真实信号（[自旋密度](@entry_id:267742)）。在经过[傅里叶逆变换](@entry_id:178300)后，两个线圈得到的混叠图像中，对应像素的测量值 $m_1$ 和 $m_2$ 分别是：

$$
m_1 = s_1(y_A)\rho_A + s_1(y_B)\rho_B
$$
$$
m_2 = s_2(y_A)\rho_A + s_2(y_B)\rho_B
$$

这是一个包含两个未知数（$\rho_A, \rho_B$）的[二元一次方程](@entry_id:172877)组。只要线圈灵敏度在 $y_A$ 和 $y_B$ 这两个位置的响应向量 $[s_1(y_A), s_2(y_A)]^T$ 和 $[s_1(y_B), s_2(y_B)]^T$ 是线性无关的，这个方程组就有唯一解。

我们可以将此问题推广到更一般的情形。对于一个加速因子为 $R$、拥有 $C$ 个线圈的系统，在图像中每一个发生混叠的像素位置 $\mathbf{r}$，我们都可以建立一个[线性方程组](@entry_id:140416) [@problem_id:4904227]。令 $\mathbf{g}(\mathbf{r}) \in \mathbb{C}^{C}$ 是一个列向量，包含了 $C$ 个线圈在该混叠像素处的测量值；令 $\mathbf{x}(\mathbf{r}) \in \mathbb{C}^{R}$ 是一个列向量，包含了 $R$ 个发生混叠的原始体素的未知真实信号值。它们之间的关系可以表示为：

$$
\mathbf{g}(\mathbf{r}) = \mathbf{S}(\mathbf{r}) \mathbf{x}(\mathbf{r}) + \boldsymbol{\eta}(\mathbf{r})
$$

其中，$\boldsymbol{\eta}(\mathbf{r})$ 是噪声向量，而 $\mathbf{S}(\mathbf{r}) \in \mathbb{C}^{C \times R}$ 是一个至关重要的矩阵，称为**灵敏度编码矩阵**（sensitivity encoding matrix）。该矩阵的第 $(c, p)$ 个元素是第 $c$ 个线圈在第 $p$ 个混叠位置的复数灵敏度值。这个方程在SENSE方法中逐个像素（或逐个混叠像素组）进行求解。

为了能够唯一地求解出真实信号 $\mathbf{x}(\mathbf{r})$，必须满足两个条件：
1.  **方程数量充足**：线圈数量必须至少等于加速因子，即 $C \ge R$。这确保了我们拥有的测量值（方程数）不少于未知数。
2.  **信息有效性**：灵敏度编码矩阵 $\mathbf{S}(\mathbf{r})$ 必须是列满秩的。这意味着它的 $R$ 个列向量（每个列向量代表一个混叠位置在所有线圈上的灵敏度“指纹”）必须是[线性无关](@entry_id:148207)的。只有当线圈阵列能在不同的混叠位置提供足够多样化的灵敏度编码时，这个条件才能满足。

在满足这些条件时，我们可以求解上述[线性系统](@entry_id:163135)。在实际应用中，由于噪声的存在以及当 $C > R$ 时系统是超定的，我们通常寻求一个最小二乘解。假设噪声是复高斯分布，其协方差矩阵为 $\mathbf{\Psi}$，通过[最大似然估计](@entry_id:142509)可以导出广义最小二乘解 [@problem_id:4904156]：

$$
\hat{\mathbf{x}}(\mathbf{r}) = (\mathbf{S}(\mathbf{r})^H\mathbf{\Psi}^{-1}\mathbf{S}(\mathbf{r}))^{-1} \mathbf{S}(\mathbf{r})^H\mathbf{\Psi}^{-1} \mathbf{g}(\mathbf{r})
$$

其中，$H$ 表示[共轭转置](@entry_id:147909)。如果噪声在各线圈间不相关且方差相同（即[白噪声](@entry_id:145248)），则 $\mathbf{\Psi} = \sigma^2\mathbf{I}$，上式简化为普通的[最小二乘解](@entry_id:152054)：

$$
\hat{\mathbf{x}}(\mathbf{r}) = (\mathbf{S}(\mathbf{r})^H\mathbf{S}(\mathbf{r}))^{-1} \mathbf{S}(\mathbf{r})^H \mathbf{g}(\mathbf{r})
$$

这个过程被称为“展开”（unfolding），它将混叠的测量值分解为各个原始位置的真实信号，从而恢复出无混叠的全FOV图像。例如，在一个 $R=2, C=3$ 的案例中，我们可以用具体的数值演示这一展开过程，从测量的混叠向量 $\mathbf{y}(\mathbf{r})$ 和已知的编码矩阵 $\mathbf{E}(\mathbf{r})$（即 $\mathbf{S}(\mathbf{r})$），精确计算出原始的信号向量 $\hat{\mathbf{x}}_{\text{fold}}(\mathbf{r})$ [@problem_id:4904156]。

### SENSE的性能与局限：几何因子

SENSE方法的成功不仅取决于能否求解方程，还取决于求解过程的**数值稳定性**。上述解中的[矩阵求逆](@entry_id:636005)过程 $(\mathbf{S}^H\mathbf{\Psi}^{-1}\mathbf{S})^{-1}$ 对噪声非常敏感。如果编码矩阵 $\mathbf{S}$ 的列向量近乎线性相关（例如线圈灵敏度分布差异不大），那么矩阵 $\mathbf{S}^H\mathbf{\Psi}^{-1}\mathbf{S}$ 就会是**病态的**（ill-conditioned），其逆矩阵的元素值会非常大。这意味着测量数据中的微小噪声会在重建过程中被急剧放大，导致最终图像的[信噪比](@entry_id:271196)（Signal-to-Noise Ratio, SNR）严重下降。

为了量化这种噪声放大效应，我们引入了**几何因子**（**g-factor**）的概念 [@problem_id:4904179] [@problem_id:4904208]。g-factor定义为[并行成像](@entry_id:753125)重建后某个像素的噪声标准差与在同样条件下进行全采样、最优线圈组合后得到的图像在该像素处的噪声标准差之比。它是一个大于等于1的无量纲数，其精确表达式为：

$$
g_j = \sqrt{ [(\mathbf{S}^H \mathbf{\Psi}^{-1} \mathbf{S})^{-1}]_{jj} \cdot [\mathbf{s}_j^H \mathbf{\Psi}^{-1} \mathbf{s}_j] }
$$

其中，下标 $j$ 表示混叠组中的第 $j$ 个体素，$[ \cdot ]_{jj}$ 表示矩阵的第 $j$ 个对角元素，$\mathbf{s}_j$ 是编码矩阵 $\mathbf{S}$ 的第 $j$ 列。g-factor完全由线圈几何布局（体现在 $\mathbf{S}$ 中）和线圈间的噪声相关性（体现在 $\mathbf{\Psi}$ 中）决定，而与实际信号强度无关。$g=1$ 是理想情况，表示没有额外的噪声放大。$g > 1$ 则表示由于解码几何不佳而导致的噪声放大。

g-factor是评估[并行成像](@entry_id:753125)性能的核心指标。在扫描时间因加速而缩短为 $1/R$ 的情况下，重建图像的[信噪比](@entry_id:271196)与全采样图像[信噪比](@entry_id:271196)的关系可以近似表示为 [@problem_id:4904208]：

$$
\mathrm{SNR}_{\mathrm{PI}} \approx \frac{\mathrm{SNR}_{\mathrm{full}}}{g \sqrt{R}}
$$

这个公式揭示了[并行成像](@entry_id:753125)的[基本权](@entry_id:200855)衡：我们通过加速因子 $R$ 获得了速度（扫描时间缩短），但代价是[信噪比](@entry_id:271196)的损失。一部分损失来源于采集的样本数减少（$\sqrt{R}$ 因子），另一部分则来源于重建过程的几何不稳定性（$g$ 因子）。如果保持总扫描时间不变，通过[信号平均](@entry_id:270779)来提升[信噪比](@entry_id:271196)，则关系变为 $\mathrm{SNR}_{\mathrm{PI}} \approx \mathrm{SNR}_{\mathrm{full}} \frac{\sqrt{R}}{g}$ [@problem_id:4904179]。

SENSE方法的性能高度依赖于线圈灵敏度图的准确性。灵敏度图中的任何误差，特别是[相位误差](@entry_id:162993)，都会直接传递到编码矩阵 $\mathbf{S}$ 中，影响其条件数，进而恶化g-factor和最终的[图像质量](@entry_id:176544)。通过分析g-factor对灵敏度图[相位误差](@entry_id:162993)的敏感性，可以发现即使微小的相位错误也可能导致g-factor显著增加，这凸显了精确灵敏度校准的重要性 [@problem_id:4904169]。

### k空间解决方案：GRAPPA方法

除了在图像域进行解混叠，还存在另一种主流的[并行成像](@entry_id:753125)策略，它直接在[k空间](@entry_id:142033)对缺失的数据进行重建。这类方法中最具代表性的是**广义自动校准部分并行采集**（**GRAPPA**, GeneRalized Autocalibrating Partially Parallel Acquisitions）。

GRAPPA的物理基础同样源于多线圈采集，但其利用信息的方式与SENSE不同。根据傅里叶变换的卷积定理，每个线圈 $c$ 采集到的[k空间](@entry_id:142033)数据 $D_c(\mathbf{k})$，可以看作是真实物体k空间信号 $\hat{m}(\mathbf{k})$ 与该线圈灵敏度函数的傅里叶变换 $\hat{s}_c(\mathbf{k})$ 进行卷积的结果 [@problem_id:4904182]：

$$
D_c(\mathbf{k}) = (\hat{m} * \hat{s}_c)(\mathbf{k})
$$

由于线圈[灵敏度函数](@entry_id:271212) $s_c(\mathbf{r})$ 通常是平滑的空间函数，其傅里叶变换 $\hat{s}_c(\mathbf{k})$ 会集中在[k空间](@entry_id:142033)的原点附近。这意味着卷积是一个局部操作：在[k空间](@entry_id:142033)任意位置 $\mathbf{k}$ 的线圈信号 $D_c(\mathbf{k})$，主要由真实物体[k空间](@entry_id:142033)信号 $\hat{m}(\mathbf{k})$ 在 $\mathbf{k}$ 附近一个小邻域内的值加权平均得到。

关键在于，所有线圈的信号都是由**同一个**未知的 $\hat{m}(\mathbf{k})$ 卷积而成，只是卷积核（$\hat{s}_c(\mathbf{k})$）不同。这导致在任意一个k空间局部邻域内，不同线圈的信号之间存在着固有的[线性依赖](@entry_id:185830)关系。GRAPPA正是利用了这种局部相关性。它假设，一条缺失的[k空间](@entry_id:142033)数据线上的某个采样点，可以由其周围已采集到的、来自**所有**线圈的采样点[线性组合](@entry_id:155091)而成。

这种[线性组合](@entry_id:155091)的权重系数（称为GRAPPA权重或核）是未知的，并且被假设在k空间中具有空间不变性（至少是局域不变）。为了求解这些权重，GRAPPA采用了一种“自校准”策略。在实际扫描中，除了按加速因子 $R$ 跳采大部分k空间数据外，还需要额外采集k空间中心的一个小范围的、完全采样的区域，这个区域被称为**自动校准信号**（**ACS**）。由于ACS区域是全采样的，它提供了大量的“输入-输出”样本对：利用其中的已采集数据模式去拟合同样位于该区域的“缺失”数据。通过求解一个大型的超定[线性方程组](@entry_id:140416)，就可以稳健地估计出GRAPPA权重 [@problem_id:4904213]。

一旦权重被确定，就可以应用到整个[欠采样](@entry_id:272871)的[k空间](@entry_id:142033)区域。对于每一条缺失的数据线，利用其周围已采集数据线上的邻近点和学习到的权重，逐点合成出缺失的信号。这个过程对每个线圈独立进行，最终得到一组完整的、用于傅里叶变换的多线圈k空间数据，从而重建出无混叠的图像。

从代数角度看，ACS数据定义了一个校准矩阵，其[列空间](@entry_id:156444)近似地描述了由物体结构和线圈灵敏度共同决定的、所有可能的多线圈[k空间](@entry_id:142033)邻域信号所处的低维子空间。GRAPPA学习到的权重系数，实际上是学习到了如何将缺失的采样点[信息投影](@entry_id:265841)到这个可行的[信号子空间](@entry_id:185227)上，从而保证了数据的一致性 [@problem_id:4904182]。增加ACS区域的大小，可以提供更多的校准方程，通常能改善权重估计的稳定性和重建的噪声性能，但这种改善并非无止境，因为该子空间的内在维度受限于线[圈数](@entry_id:267135)量和核的大小 [@problem_id:4904182]。

### 统一的视角与实践考量

尽管SENSE和GRAPPA在算法实现上截然不同——一个在图像域进行[矩阵求逆](@entry_id:636005)解混叠，一个在k空间进行卷积插值——但它们都根植于同一个物理基础：利用空间变化的线圈灵敏度来提供额外的[空间编码](@entry_id:755143)。因此，它们的性能极限本质上是相似的 [@problem_id:4904213]。

*   **SENSE** 的解混叠问题可以表示为一系列局部的[线性系统](@entry_id:163135) $\mathbf{g}(\mathbf{r}) = \mathbf{S}(\mathbf{r}) \mathbf{x}(\mathbf{r})$，其条件数和噪声放大由局部的灵敏度矩阵 $\mathbf{S}(\mathbf{r})$ 决定。
*   **GRAPPA** 的权重拟合问题则是一个全局的校准系统 $\mathbf{A} \mathbf{w} = \mathbf{b}$，其条件数取决于由ACS数据构成的“块”矩阵 $\mathbf{A}$ 的[奇异值](@entry_id:171660)分布。

当线圈灵敏度高度相关（即线圈几何布局不佳）时，SENSE的编码矩阵 $\mathbf{S}(\mathbf{r})$ 会变得病态，导致g-factor飙升。在同样情况下，GRAPPA的校准矩阵 $\mathbf{A}$ 也会变得[秩亏](@entry_id:754065)损或病态，因为不同线圈提供的邻域信息变得冗余，导致权重求解不稳定，同样会放大噪声。因此，无论是哪种方法，一个精心设计的、能够提供多样化灵敏度分布的线圈阵列都是实现高性能[并行成像](@entry_id:753125)的前提。可用信息的上限，即可以唯一恢复的独立体素值的数量，始终受限于线圈数量 $C$ 和加速因子 $R$，即 $\min(C, R)$ [@problem_id:4904180]。

在实践中，SENSE和GRAPPA各有优劣。SENSE如果拥有完美的线圈灵敏度图，其重建在理论上更精确，但它对灵敏度图的测量误差和扫描过程中的患者运动非常敏感。GRAPPA作为一种自校准方法，对这些动态变化具有更强的鲁棒性，因为它直接从数据中学习重建关系。然而，GRAPPA基于权重在k空间中移位不变的假设，这在k空间边缘或物体结构剧烈变化的区域可能不成立，从而可能引入一些残留的伪影。

总之，[并行成像](@entry_id:753125)是现代MRI技术不可或缺的组成部分。通过深刻理解其背后的数学原理、物理机制以及性能权衡，研究人员和临床医生可以更有效地利用这项强大的技术，推动[磁共振成像](@entry_id:153995)向着更快、更准、更广阔的应用领域迈进。