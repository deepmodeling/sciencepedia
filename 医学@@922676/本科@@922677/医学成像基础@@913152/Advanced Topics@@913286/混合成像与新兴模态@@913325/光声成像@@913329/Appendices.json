{"hands_on_practices": [{"introduction": "光声效应的核心在于光能到声能的转换。当短激光脉冲照射生物组织时，被吸收的光能导致局部快速温升和热弹性膨胀，从而产生超声波。这个练习将引导你从物理第一性原理出发，推导并计算这个初始光声压力，让你对信号的产生机制和数量级有更深刻的理解。[@problem_id:4909951]", "problem": "在热和应力约束条件下，一个纳秒光脉冲在光声成像（PAI）实验中被传递到均匀的软组织中。该组织可以被建模为线性、各向同性、热弹性介质。单位体积吸收的能量密度由光吸收系数和光通量的乘积决定。压力升高由对热弹性体积应变的弹性响应所主导。使用这些基本原理来推导初始光声压力升高。\n\n给定组织属性和光照条件：\n- 光吸收系数 $\\mu_{a} = 0.5\\,\\mathrm{cm^{-1}}$，\n- 光通量 $\\Phi = 10\\,\\mathrm{mJ/cm^{2}}$，\n- 体积热膨胀系数 $\\beta = 4 \\times 10^{-4}\\,\\mathrm{K^{-1}}$，\n- 声速 $c = 1540\\,\\mathrm{m/s}$，\n- 恒压比热容（单位质量） $C_{p} = 4\\,\\mathrm{kJ/(kg\\,K)}$。\n\n从第一性原理出发：\n- 将单位体积吸收的能量密度与 $\\mu_{a}$ 和 $\\Phi$ 联系起来。\n- 将温度升高与吸收的能量密度和 $C_{p}$ 联系起来。\n- 通过体积模量将初始压力升高与体积应变联系起来，并通过 $\\beta$ 将其与温度联系起来。\n- 使用以 $c$ 和质量密度表示的体积模量定义。\n- 结合这些关系，得到以给定物理量表示的初始光声压力 $p_{0}$ 的闭合形式表达式。\n\n计算 $p_{0}$ 的数值（以帕斯卡为单位），并将答案四舍五入到四位有效数字。以 $\\mathrm{Pa}$ 表示最终压力。", "solution": "初始光声压力 $p_0$ 的推导如前所述，从第一性原理出发。核心物理过程涉及光脉冲对组织的快速、局域加热，随后发生热弹性膨胀，从而产生压力波。热和应力约束的条件是关键假设。\n\n1.  **热约束**：假设激光脉冲持续时间 $\\tau_p$ 远小于热扩散时间 $\\tau_{th}$。这意味着在脉冲期间，热量没有时间从吸收体积中传导出去。加热过程可以有效地视为绝热过程。\n2.  **应力约束**：假设 $\\tau_p$ 远小于声学渡越时间 $\\tau_s$。这意味着在脉冲期间，机械应力没有时间从吸收体积中传播出去。加热过程在恒定体积下发生（即等容过程）。\n\n这两个条件确保了吸收的光能瞬时且局域地转化为压力升高。\n\n推导过程遵循以下步骤：\n\n**步骤1：吸收能量密度**\n单位体积吸收的能量密度 $H$（单位为 $\\mathrm{J/m^3}$）是光吸收系数 $\\mu_a$ 与局部光通量 $\\Phi$ 的乘积。\n$$H = \\mu_a \\Phi$$\n\n**步骤2：温度升高**\n在指定的约束条件下，吸收的能量 $H$ 导致温度快速升高 $\\Delta T$。此关系由介质的体积热容决定。单位体积的热容是质量密度 $\\rho$ 和恒压比热容 $C_p$ 的乘积。我们用 $C_p$ 来近似恒容比热 $C_v$，这对于像软组织这样的凝聚态物质是一个有效的近似。\n$$H = \\rho C_p \\Delta T$$\n因此，温度升高为：\n$$\\Delta T = \\frac{H}{\\rho C_p} = \\frac{\\mu_a \\Phi}{\\rho C_p}$$\n\n**步骤3：热弹性压力产生**\n温度升高 $\\Delta T$ 引起瞬时的各向同性热膨胀。对于线性、各向同性的热弹性介质，由热膨胀引起的体积应变 $\\epsilon_{th}$ 由下式给出：\n$$\\epsilon_{th} = \\beta \\Delta T$$\n其中 $\\beta$ 是体积热膨胀系数。\n\n在应力约束下，介质没有时间膨胀。会产生一个内部应力或压力 $p_0$ 来抵抗这种热膨胀，从而保持净应变为零。这个初始压力通过胡克定律与热致应变和介质的体积模量 $K$ 相关：\n$$p_0 = K \\epsilon_{th} = K \\beta \\Delta T$$\n体积模量 $K$ 通过基本声学关系与声速 $c$ 和质量密度 $\\rho$ 相关：\n$$K = \\rho c^2$$\n将此代入 $p_0$ 的表达式中：\n$$p_0 = (\\rho c^2) \\beta \\Delta T$$\n\n**步骤4：初始压力的组合表达式**\n我们将前面步骤中的方程组合起来，推导出 $p_0$ 的单一表达式。将步骤2中 $\\Delta T$ 的表达式代入步骤3中 $p_0$ 的表达式：\n$$p_0 = (\\rho c^2) \\beta \\left( \\frac{\\mu_a \\Phi}{\\rho C_p} \\right)$$\n质量密度 $\\rho$ 从分子和分母中消去。这是一个关键步骤，证实了在没有 $\\rho$ 的明确值的情况下该问题是可解的。\n$$p_0 = \\frac{\\beta c^2 \\mu_a \\Phi}{C_p}$$\n这就是所求的初始光声压力的闭合形式表达式。无量纲量 $\\Gamma = \\frac{\\beta c^2}{C_p}$ 被称为格林爱森参数，它量化了从热到压力的转换效率。该方程可以简洁地写为 $p_0 = \\Gamma \\mu_a \\Phi$。\n\n**步骤5：数值计算**\n为了计算 $p_0$ 的数值，所有给定的量都必须转换为一致的单位制，最好是国际单位制（SI）基本单位（米、千克、秒、开尔文、焦耳）。\n\n给定的值为：\n-   $\\mu_{a} = 0.5\\,\\mathrm{cm^{-1}}$\n-   $\\Phi = 10\\,\\mathrm{mJ/cm^{2}}$\n-   $\\beta = 4 \\times 10^{-4}\\,\\mathrm{K^{-1}}$\n-   $c = 1540\\,\\mathrm{m/s}$\n-   $C_{p} = 4\\,\\mathrm{kJ/(kg\\,K)}$\n\n单位转换为SI单位：\n-   $\\mu_{a} = 0.5\\,\\mathrm{cm^{-1}} = 0.5 \\times (10^{-2}\\,\\mathrm{m})^{-1} = 0.5 \\times 100\\,\\mathrm{m^{-1}} = 50\\,\\mathrm{m^{-1}}$\n-   $\\Phi = 10\\,\\mathrm{mJ/cm^{2}} = 10 \\times 10^{-3}\\,\\mathrm{J} / (10^{-2}\\,\\mathrm{m})^2 = 10 \\times 10^{-3}\\,\\mathrm{J} / 10^{-4}\\,\\mathrm{m^2} = 100\\,\\mathrm{J/m^2}$\n-   $\\beta = 4 \\times 10^{-4}\\,\\mathrm{K^{-1}}$ （这已经是SI单位）\n-   $c = 1540\\,\\mathrm{m/s}$ （这已经是SI单位）\n-   $C_{p} = 4\\,\\mathrm{kJ/(kg\\,K)} = 4 \\times 10^3\\,\\mathrm{J/(kg\\,K)}$\n\n现在，我们将这些SI单位的值代入推导出的 $p_0$ 公式中：\n$$p_0 = \\frac{(4 \\times 10^{-4}\\,\\mathrm{K^{-1}}) \\times (1540\\,\\mathrm{m/s})^2 \\times (50\\,\\mathrm{m^{-1}}) \\times (100\\,\\mathrm{J/m^2})}{4000\\,\\mathrm{J/(kg\\,K)}}$$\n$$p_0 = \\frac{(4 \\times 10^{-4}) \\times (2371600) \\times (50) \\times (100)}{4000} \\,\\, \\mathrm{Pa}$$\n$$p_0 = \\frac{4 \\times 10^{-4} \\times 2.3716 \\times 10^6 \\times 5 \\times 10^3}{4 \\times 10^3} \\,\\, \\mathrm{Pa}$$\n从分子和分母中消去 $4 \\times 10^3$ 项可以简化表达式：\n$$p_0 = 10^{-4} \\times 2.3716 \\times 10^6 \\times 5 \\,\\, \\mathrm{Pa}$$\n$$p_0 = (2.3716 \\times 5) \\times 10^{2} \\,\\, \\mathrm{Pa}$$\n$$p_0 = 11.858 \\times 10^{2} \\,\\, \\mathrm{Pa}$$\n$$p_0 = 1185.8 \\,\\, \\mathrm{Pa}$$\n\n问题要求答案四舍五入到四位有效数字。计算出的值为 $1185.8$。第五位有效数字是 $8$，所以我们将第四位数字向上取整。\n$$p_0 \\approx 1186\\,\\mathrm{Pa}$$\n初始光声压力升高为 $1186$ 帕斯卡。", "answer": "$$\\boxed{1186}$$", "id": "4909951"}, {"introduction": "为了实现高效的光声信号转换，激光脉冲加热产生的热量必须在脉冲持续时间内“锁定”在吸收体内，而不能扩散出去。这个练习将探讨实现这一点的关键条件——热限制。通过分析热扩散与激光脉冲宽度的关系，你将能够量化在给定条件下可分辨的最小吸收体尺寸，从而将基础物理原理与成像系统的性能联系起来。[@problem_id:4909957]", "problem": "在光声成像 (PAI) 中，实现激光（受激辐射光放大）脉冲期间的热限制，可以确保在脉冲持续期间热量不会显著地从光吸收体中扩散出去，从而使初始压力升高与吸收的光能成正比。考虑一个均匀、各向同性的组织，其模型为一个热扩散率为 $\\kappa$ 的有效无限介质。一个特征尺寸为 $a$ 的光吸收体在持续时间为 $\\tau_{p}$ 的脉冲期间被均匀加热。从热扩散方程及其格林函数解的物理上合理的标度分析出发，通过比较时间 $\\tau_{p}$ 内的特征热扩散长度与尺寸 $a$，来构建关联 $\\tau_{p}$、$a$ 和 $\\kappa$ 的热限制条件。然后，使用临界限制标准，量化在热扩散率为 $\\kappa = 1.4 \\times 10^{-7}\\,\\mathrm{m^2/s}$ 的组织中，对于持续时间为 $\\tau_{p} = 10\\,\\mathrm{ns}$ 的脉冲，可以实现热限制的最小吸收体尺寸 $a_{\\min}$。将最终的 $a_{\\min}$ 以微米为单位表示，并四舍五入到三位有效数字。", "solution": "光声产生中热限制的物理基础是热扩散方程。在均匀介质中，温度场 $T(\\mathbf{r},t)$ 服从\n$$\n\\frac{\\partial T(\\mathbf{r},t)}{\\partial t} = \\kappa \\nabla^{2} T(\\mathbf{r},t) + \\frac{S(\\mathbf{r},t)}{\\rho C_{p}},\n$$\n其中 $\\kappa$ 是热扩散率，$S(\\mathbf{r},t)$ 是热源密度，$\\rho$ 是质量密度，$C_{p}$ 是恒压比热容。关键问题是，在时间 $\\tau_{p}$ 内，相对于吸收体尺寸 $a$，热量扩散了多远。\n\n扩散算子在空间中产生扩散，这可以从均匀扩散方程（$S=0$）的格林函数（基本解）中理解。在无限介质中，对于点状初始温度扰动，格林函数是高斯函数，\n$$\nG(\\mathbf{r},t) = \\frac{1}{(4\\pi \\kappa t)^{3/2}} \\exp\\!\\left(-\\frac{|\\mathbf{r}|^{2}}{4\\kappa t}\\right),\n$$\n这表明温度分布的宽度随时间的增加而增长。指数因子包含组合 $|\\mathbf{r}|^{2}/(4\\kappa t)$，因此在时间 $t$ 的特征热扩散长度标度为\n$$\n\\ell_{\\mathrm{th}}(t) \\sim \\sqrt{4 \\kappa t}.\n$$\n只要介质是均匀的且扩散主导空间扩展，这种标度分析就与源的细节无关。\n\n脉冲期间的热限制要求在脉冲持续时热量不会明显地从吸收体中扩散出去，这在脉冲期间的扩散长度远小于吸收体尺寸时可以实现：\n$$\n\\ell_{\\mathrm{th}}(\\tau_{p}) \\ll a.\n$$\n使用 $\\ell_{\\mathrm{th}}$ 的表达式，该标准变为\n$$\n\\sqrt{4 \\kappa \\tau_{p}} \\ll a,\n$$\n或者，等效地，一个基于时间的不等式\n$$\n\\tau_{p} \\ll \\frac{a^{2}}{4 \\kappa}.\n$$\n在临界限制的阈值上，可以取等号来估计仍然可以被视为热限制的最小吸收体尺寸：\n$$\na_{\\min} = \\sqrt{4 \\kappa \\tau_{p}}.\n$$\n\n我们现在根据给定参数计算 $a_{\\min}$。当 $\\tau_{p} = 10\\,\\mathrm{ns} = 10 \\times 10^{-9}\\,\\mathrm{s} = 1.0 \\times 10^{-8}\\,\\mathrm{s}$ 且 $\\kappa = 1.4 \\times 10^{-7}\\,\\mathrm{m^{2}/s}$ 时，\n$$\na_{\\min} = \\sqrt{4 \\kappa \\tau_{p}} = \\sqrt{4 \\times \\left(1.4 \\times 10^{-7}\\,\\mathrm{m^{2}/s}\\right) \\times \\left(1.0 \\times 10^{-8}\\,\\mathrm{s}\\right)}.\n$$\n计算平方根内的乘积：\n$$\n4 \\times \\left(1.4 \\times 10^{-7}\\right) \\times \\left(1.0 \\times 10^{-8}\\right) = 5.6 \\times 10^{-15}.\n$$\n因此，\n$$\na_{\\min} = \\sqrt{5.6 \\times 10^{-15}\\,\\mathrm{m^{2}}} = \\sqrt{56 \\times 10^{-16}\\,\\mathrm{m^{2}}} = \\sqrt{56} \\times 10^{-8}\\,\\mathrm{m}.\n$$\n使用 $\\sqrt{56} \\approx 7.483$，\n$$\na_{\\min} \\approx 7.483 \\times 10^{-8}\\,\\mathrm{m}.\n$$\n使用 $1\\,\\mu\\mathrm{m} = 10^{-6}\\,\\mathrm{m}$ 将其转换为微米：\n$$\na_{\\min} \\approx 7.483 \\times 10^{-8}\\,\\mathrm{m} = 0.07483\\,\\mu\\mathrm{m}.\n$$\n四舍五入到三位有效数字，最小吸收体尺寸为\n$$\na_{\\min} = 0.0748\\,\\mu\\mathrm{m}.\n$$", "answer": "$$\\boxed{0.0748}$$", "id": "4909957"}, {"introduction": "光声信号产生后，必须被精确地探测和数字化，才能重建出高质量的图像。这个练习通过一个假设的“故障”场景——信号采样不足——来挑战你。你需要分析这种不完美的采集过程将如何在最终图像中产生可预测的伪影，这对于理解信号处理与最终成像质量之间的重要联系至关重要。[@problem_id:4910064]", "problem": "一个光声成像系统使用宽带压电换能器检测由单个亚分辨率点吸收体产生的压力波形。假设探测器处的连续时间压力信号，表示为 $p(t)$，是实值的，并且其频谱幅度 $|P(f)|$ 在 $0 \\le f \\le f_{\\max}$（其中 $f_{\\max} = 20\\,\\text{MHz}$）范围内近似平坦，在此频带之外可以忽略不计。介质中的声速为 $c = 1500\\,\\text{m/s}$。该系统本应以奈奎斯特频率 $f_{\\text{Nyquist}} = 2 f_{\\max} = 40\\,\\text{MHz}$ 进行采样，但由于限制，它实际以 $f_s = 20\\,\\text{MHz}$ 的频率进行采样（即，采样频率相对于奈奎斯特要求欠采样了2倍）。在采样之前没有模拟抗混叠滤波器。图像通过标准的滤波反投影算法进行重建，其中飞行时间样本通过 $r = c t$ 映射到半径。\n\n从采样理论的基本原理以及光声层析成像中飞行时间与空间位置之间的关系出发，确定哪个陈述最能量化采样基带中的混叠贡献，并预测点吸收体重建图像中的主要伪影形态及其特征径向间距。\n\n选项：\n- A. 出现在离散时间基带中的信号能量恰好有一半是由原始频带上半部分的混叠分量贡献的，并且重建在点吸收体周围呈现出同心环状伪影，其径向过零点间距为 $\\Delta r \\approx \\dfrac{2 c}{f_s} \\approx 0.15\\,\\text{mm}$。\n\n- B. 四分之一的能量混叠到基带中，并且主要伪影是在两倍真实半径处的一个重复点，其间距为 $\\Delta r \\approx \\dfrac{c}{2 f_s} \\approx 0.0375\\,\\text{mm}$。\n\n- C. 在欠采样下，所有高频能量都折叠成直流分量，不产生空间伪影，仅在重建图像中产生恒定的偏置。\n\n- D. 真实信号频谱的厄米对称性在重建中抵消了混叠，因此没有伪影，只发生均匀的幅度缩放。", "solution": "本题旨在分析数字信号采集中一个经典问题——欠采样——对光声成像结果的影响。我们将基于采样理论来量化混叠效应，并预测其在重建图像中产生的伪影。\n\n**1. 混叠与能量分析**\n\n信号的频谱带宽为 $[-f_{\\max}, f_{\\max}] = [-20\\,\\text{MHz}, 20\\,\\text{MHz}]$。根据奈奎斯特-香农采样定理，为避免混叠，所需的最小采样频率为 $f_{\\text{Nyquist}} = 2 f_{\\max} = 40\\,\\text{MHz}$。然而，系统实际的采样频率为 $f_s = 20\\,\\text{MHz}$，这低于奈奎斯特频率，因此会发生混叠。\n\n采样后，信号频谱会以 $f_s$ 为周期进行延拓。离散时间信号的基带范围为 $[-f_s/2, f_s/2] = [-10\\,\\text{MHz}, 10\\,\\text{MHz}]$。原始频谱中位于此范围外的部分将被“折叠”进这个基带。\n\n- **真实分量**: 原始频谱中 $[-10\\,\\text{MHz}, 10\\,\\text{MHz}]$ 的部分。\n- **混叠分量**: 原始频谱中 $[-20\\,\\text{MHz}, -10\\,\\text{MHz}]$ 和 $[10\\,\\text{MHz}, 20\\,\\text{MHz}]$ 的部分。\n\n假设原始频谱 $|P(f)|$ 在 $[-20\\,\\text{MHz}, 20\\,\\text{MHz}]$ 内是平坦的（幅度恒定），则信号能量与频带宽度成正比。\n\n- 真实分量的能量对应于 $10 - (-10) = 20\\,\\text{MHz}$ 的带宽。\n- 混叠分量的能量对应于 $(-10 - (-20)) + (20 - 10) = 10 + 10 = 20\\,\\text{MHz}$ 的带宽。\n\n因此，在采样后的基带中，混叠分量贡献的能量与真实分量贡献的能量相等。这意味着基带中的总能量恰好有一半来自混叠。\n\n**2. 伪影形态与间距分析**\n\n图像重建算法处理的是采样后的信号，其有效频谱被限制在 $[-f_s/2, f_s/2] = [-10\\,\\text{MHz}, 10\\,\\text{MHz}]$ 内。这种频域上的硬截断（相当于乘以一个矩形窗）在时域（或通过 $r=ct$ 转换的空间域）中会引起振铃伪影，即吉布斯现象。\n\n伪影的特征振荡周期由截断频率，即最大可表示频率 $B = f_s/2 = 10\\,\\text{MHz}$ 决定。振铃的时间周期 $\\Delta t$ 约为：\n$$\\Delta t \\approx \\frac{1}{B} = \\frac{1}{f_s/2} = \\frac{2}{f_s}$$\n\n将这个时间周期转换为空间上的径向间距 $\\Delta r$：\n$$\\Delta r = c \\cdot \\Delta t = \\frac{2c}{f_s}$$\n\n代入数值进行计算：\n$$\\Delta r = \\frac{2 \\times 1500\\,\\text{m/s}}{20 \\times 10^6\\,\\text{Hz}} = \\frac{3000}{20 \\times 10^6}\\,\\text{m} = 1.5 \\times 10^{-4}\\,\\text{m} = 0.15\\,\\text{mm}$$\n\n这表明重建图像中，点状吸收体周围会产生同心环状伪影，其特征间距约为 $0.15\\,\\text{mm}$。\n\n**3. 选项评估**\n\n- **A**: 描述了有一半能量来自混叠，并预测了间距为 $\\Delta r \\approx \\frac{2c}{f_s} \\approx 0.15\\,\\text{mm}$ 的环状伪影。这与我们的分析完全吻合。\n- **B**: 能量分数（四分之一）和间距公式（$c/(2f_s)$）均不正确。\n- **C**: 能量不会全部折叠到直流分量。\n- **D**: 厄米对称性保证信号是实数，但不能消除混叠。\n\n综上所述，选项A最准确地描述了欠采样所导致的后果。", "answer": "$$\\boxed{A}$$", "id": "4910064"}]}