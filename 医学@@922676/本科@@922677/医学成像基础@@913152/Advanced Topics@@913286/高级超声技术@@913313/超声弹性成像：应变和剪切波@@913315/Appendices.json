{"hands_on_practices": [{"introduction": "在应变弹性成像中，我们看到的表观硬度有时会产生误导。本练习探讨一个经典的难题：当一个软性病变隐藏在一个硬性浅表组织的下方时会发生什么。我们将通过一个思想实验来定量地展示，在特定的边界条件下，应变成像会产生“对比度反转”的伪影，使得软组织看起来比硬组织更硬。这个练习揭示了准静态应变成像的一个关键局限性，并强调了为何需要像剪切波弹性成像这样对边界条件不敏感的先进技术 [@problem_id:4940413]。", "problem": "给定一个合成的一维分层弹性介质，旨在探究当软夹杂物位于硬质浅表层之下时，在超声弹性成像 (UE) 中出现的对比度模糊性问题。您的目标是构建一个定量演示，在该演示中，表观应变对比度在特定边界条件下会发生符号反转，然后设计能够恢复正确对比度符号的边界条件。请在小形变、线性、各向同性弹性体系下，并使用第一性原理进行分析。\n\n从以下基础出发：\n- 令 $E$ 表示杨氏模量，$\\nu$ 表示泊松比，$\\mu$ 表示剪切模量，$\\rho$ 表示质量密度，$\\boldsymbol{\\sigma}$ 表示 Cauchy 应力，$\\boldsymbol{\\epsilon}$ 表示应变。对于各向同性线性弹性，使用 Lamé 参数 $\\lambda$ 和 $\\mu$ 的 Hooke 定律形式 $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I}$，以及 $(E,\\nu)$ 和 $(\\lambda,\\mu)$ 之间的已知关系。\n- 对于剪切波，使用剪切波速度公式 $c_s = \\sqrt{\\mu / \\rho}$。\n\n考虑一个沿轴向 $z$ 串联的两层堆叠结构：一个顶部的硬壳层，其参数为 $(E_h,\\nu_h,\\rho_h)$，以及一个更深的软夹杂物，其参数为 $(E_s,\\nu_s,\\rho_s)$。在顶表面施加一个均匀的压缩压力 $p$，从而在各处产生轴向应力 $\\sigma_z = p$（串联静力平衡）。假设两层的横截面积相等，并忽略体力。\n\n定义了两种测量边界条件模式：\n1. 自由模式（平面应力，侧向无应力）：侧向应力消失，各处 $\\sigma_x = \\sigma_y = 0$。\n2. 约束模式（混合模式）：浅表壳层保持平面应力状态（$\\sigma_x = \\sigma_y = 0$），而软夹杂物则受到侧向约束（平面应变），在夹杂物中 $\\epsilon_x = \\epsilon_y = 0$。\n\n对于每个测试用例，您的程序必须仅基于上述基础知识执行以下步骤：\n1. 从 $E$、$\\nu$ 和 $\\mu$ 之间的定义和关系出发，根据 Hooke 定律和各向同性假设，推导在自由模式和约束模式下各层中的轴向应变 $\\epsilon_z$。\n2. 在平面应力解释下，为任何测得的轴向应变 $\\epsilon_z$ 定义一个朴素的表观模量 $E_{\\text{app}} = p / \\epsilon_z$（这模拟了在平面应力假设下将应变图像解释为与刚度成反比的情况）。\n3. 在约束模式下，将硬壳层的测量视为平面应力（与其边界条件一致），将软夹杂物的测量视为平面应变（与其边界条件一致）。相应地计算 $E_{\\text{app},h}$ 和 $E_{\\text{app},s}$，并以布尔值的形式确定模糊性：如果朴素分类会将夹杂物标记为比壳层更硬，即当真实情况为 $E_s  E_h$ 时，出现 $E_{\\text{app},s} > E_{\\text{app},h}$，则 ambiguous 为真。\n4. 在自由模式下，两层均处于平面应力状态。计算 $E_{\\text{app},h}$ 和 $E_{\\text{app},s}$，并以布尔值的形式报告此边界条件是否解决了对比度符号问题：只要 $E_s  E_h$，就有 $E_{\\text{app},s}  E_{\\text{app},h}$，则 resolved 为真。\n5. 独立地，计算各层中的剪切波速度 $c_{s,h} = \\sqrt{\\mu_h / \\rho_h}$ 和 $c_{s,s} = \\sqrt{\\mu_s / \\rho_s}$，其中 $\\mu = E/(2(1+\\nu))$，以展示一种与边界条件无关的对比度模式（剪切波弹性成像 (SWE)）。报告一个整数 shear_sign，定义为：如果 $c_{s,h} > c_{s,s}$ 则为 $+1$，否则为 $-1$。\n\n以指定的物理单位表示所有输入，并以数值方式计算输出：\n- 杨氏模量 $E_h$, $E_s$，单位为千帕（$\\mathrm{kPa}$）。\n- 压力 $p$，单位为千帕（$\\mathrm{kPa}$）。\n- 密度 $\\rho_h$, $\\rho_s$，单位为千克每立方米（$\\mathrm{kg}\\,\\mathrm{m}^{-3}$）。\n- 泊松比 $\\nu_h$, $\\nu_s$ 为无量纲。\n- 轴向应变 $\\epsilon_z$ 为无量纲。\n- 剪切波速度 $c_s$，单位为米每秒（$\\mathrm{m}\\,\\mathrm{s}^{-1}$），但您只需按所述进行符号比较。\n\n测试套件：\n- 案例 $1$（典型模糊路径）：$E_h = 100\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.49$, $\\nu_s = 0.49$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 2\\,\\mathrm{kPa}$。\n- 案例 $2$（边界条件边缘，更具可压缩性）：$E_h = 100\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.30$, $\\nu_s = 0.30$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 2\\,\\mathrm{kPa}$。\n- 案例 $3$（接近模量边界，类不可压缩）：$E_h = 12\\,\\mathrm{kPa}$, $E_s = 10\\,\\mathrm{kPa}$, $\\nu_h = 0.49$, $\\nu_s = 0.49$, $\\rho_h = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_s = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $p = 1\\,\\mathrm{kPa}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的三元素列表的列表，每个测试用例一个，并用方括号括起来。每个内部列表必须为 $[\\text{ambiguous}, \\text{resolved}, \\text{shear\\_sign}]$ 的形式，其中 ambiguous 和 resolved 是布尔值，shear_sign 是一个整数。例如，对于两个案例，输出应类似于 $[[\\text{True},\\text{False},1],[\\text{False},\\text{True},-1]]$。", "solution": "该问题被认为是有效的，因为它科学地基于线性弹性原理，是适定的、客观的，并且在正压缩约定的合理解释下内部一致。\n\n分析过程从连续介质力学的第一性原理出发，推导不同边界条件下的轴向应变。我们考虑一个两层介质，一个硬质浅表壳层 (h) 和一个软质深部夹杂物 (s)，在均匀的轴向压缩应力 $\\sigma_z = p$ 下。我们采用压缩应力和应变为正的约定。所有材料属性均假定为各向同性和线性弹性的。\n\n基本本构关系是 Hooke 定律，以 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 和无穷小应变张量 $\\boldsymbol{\\epsilon}$ 表示：\n$$ \\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I} $$\n其中 $\\mu$ 是剪切模量，$\\lambda$ 是第一个 Lamé 参数，$\\operatorname{tr}(\\cdot)$ 是迹算子，$\\mathbf{I}$ 是单位张量。弹性参数 $(\\lambda, \\mu)$ 通过以下公式与杨氏模量 $E$ 和泊松比 $\\nu$ 相关联：\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\nHooke 定律的逆形式，用应力表示应变，通常更方便：\n$$ \\epsilon_{ij} = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_{ij} - \\nu \\operatorname{tr}(\\boldsymbol{\\sigma}) \\delta_{ij} \\right] $$\n其中 $\\delta_{ij}$ 是 Kronecker delta。\n\n**1. 轴向应变 $\\epsilon_z$ 的推导**\n\n我们为两种指定的边界条件模式推导轴向应变 $\\epsilon_z$。\n\n**自由模式（平面应力）：**\n该条件由 $\\sigma_x = \\sigma_y = 0$ 定义。在“自由模式”情况下，它应用于两层；在“约束模式”情况下，它应用于硬壳层。对轴向分量 $\\epsilon_z = \\epsilon_{zz}$ 使用逆 Hooke 定律：\n$$ \\epsilon_z = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_z - \\nu (\\sigma_x + \\sigma_y + \\sigma_z) \\right] $$\n代入 $\\sigma_x = 0$、$\\sigma_y = 0$ 以及施加的轴向应力 $\\sigma_z = p$：\n$$ \\epsilon_{z, \\text{stress}} = \\frac{1}{E} \\left[ (1+\\nu)p - \\nu (0 + 0 + p) \\right] = \\frac{1}{E} [p + \\nu p - \\nu p] = \\frac{p}{E} $$\n因此，对于任何处于平面应力条件下的层，其轴向应变为 $\\epsilon_z = p/E$。\n\n**约束模式（夹杂物中的平面应变）：**\n该条件由 $\\epsilon_x = \\epsilon_y = 0$ 定义，并适用于“约束模式”下的软夹杂物。我们使用原始形式的 Hooke 定律。轴向应力分量 $\\sigma_z$ 为：\n$$ \\sigma_z = \\lambda(\\epsilon_x + \\epsilon_y + \\epsilon_z) + 2\\mu\\epsilon_z $$\n代入 $\\epsilon_x = 0$ 和 $\\epsilon_y = 0$：\n$$ \\sigma_z = \\lambda \\epsilon_z + 2\\mu \\epsilon_z = (\\lambda + 2\\mu) \\epsilon_z $$\n给定 $\\sigma_z = p$，轴向应变为：\n$$ \\epsilon_{z, \\text{strain}} = \\frac{p}{\\lambda + 2\\mu} $$\n量 $M = \\lambda + 2\\mu$ 是纵波模量或 P 波模量。我们用 $E$ 和 $\\nu$ 来表示它：\n$$ M = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + 2 \\frac{E}{2(1+\\nu)} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} $$\n$$ M = \\frac{E}{1+\\nu} \\left( \\frac{\\nu}{1-2\\nu} + 1 \\right) = \\frac{E}{1+\\nu} \\left( \\frac{\\nu + 1 - 2\\nu}{1-2\\nu} \\right) = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\n因此，对于处于平面应变状态的层，其轴向应变为：\n$$ \\epsilon_{z, \\text{strain}} = p \\frac{(1+\\nu)(1-2\\nu)}{E(1-\\nu)} $$\n\n**2. 表观模量和对比度模糊性（约束模式）**\n\n问题将“朴素表观模量”定义为 $E_{\\text{app}} = p / \\epsilon_z$。这模拟了一种成像场景，其中所有测量的应变都通过简单的平面应力关系 $E = p/\\epsilon_z$ 来解释。\n\n在“约束模式”下：\n- 硬壳层处于平面应力状态，因此 $\\epsilon_{z,h} = p/E_h$。其表观模量为 $E_{\\text{app},h} = p / \\epsilon_{z,h} = E_h$。朴素测量是正确的。\n- 软夹杂物处于平面应变状态，因此 $\\epsilon_{z,s} = p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}$。其朴素表观模量为：\n  $$ E_{\\text{app},s} = \\frac{p}{\\epsilon_{z,s}} = \\frac{p}{p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}} = E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} $$\n当软夹杂物被测量为比硬壳层更硬时，即尽管真实情况是 $E_s  E_h$，但测量结果为 $E_{\\text{app},s} > E_{\\text{app},h}$，就会出现模糊性或对比度反转。模糊性的条件是：\n$$ E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} > E_h $$\n这个不等式表明，模糊性高度依赖于泊松比 $\\nu_s$。当 $\\nu_s$ 趋近于 0.5（不可压缩极限）时，分母 $(1-2\\nu_s)$ 趋近于零，导致 $E_{\\text{app},s}$ 变得非常大，即使 $E_s$ 远小于 $E_h$，也可能轻易超过 $E_h$。\n\n**3. 对比度解决（自由模式）**\n\n在“自由模式”下，两层都处于平面应力状态。\n- 硬壳层：$\\epsilon_{z,h} = p/E_h$，所以 $E_{\\text{app},h} = p/\\epsilon_{z,h} = E_h$。\n- 软夹杂物：$\\epsilon_{z,s} = p/E_s$，所以 $E_{\\text{app},s} = p/\\epsilon_{z,s} = E_s$。\n在此模式下，表观模量等于真实的杨氏模量。“解决”条件是在真实情况为 $E_s  E_h$ 时，有 $E_{\\text{app},s}  E_{\\text{app},h}$。这可以简化为 $E_s  E_h$，根据构造这是成立的。因此，平面应力边界条件正确地反映了刚度对比度。\n\n**4. 剪切波弹性成像 (SWE)**\n\nSWE 提供了一种独立于压缩边界条件的刚度测量方法。它测量剪切波速度 $c_s = \\sqrt{\\mu/\\rho}$。剪切模量 $\\mu$ 与 $E$ 和 $\\nu$ 的关系为 $\\mu = E/(2(1+\\nu))$。\n- 硬壳层：$c_{s,h} = \\sqrt{\\frac{\\mu_h}{\\rho_h}} = \\sqrt{\\frac{E_h}{2(1+\\nu_h)\\rho_h}}$。\n- 软夹杂物：$c_{s,s} = \\sqrt{\\frac{\\mu_s}{\\rho_s}} = \\sqrt{\\frac{E_s}{2(1+\\nu_s)\\rho_s}}$。\n刚度对比度的符号通过比较 $c_{s,h}$ 和 $c_{s,s}$ 来确定。如果 $c_{s,h} > c_{s,s}$，则 `shear_sign` 为 $+1$，否则为 $-1$。这种比较等同于检查 $(\\mu_h/\\rho_h) - (\\mu_s/\\rho_s)$ 的符号。由于剪切特性仅取决于 $\\mu$ 和 $\\rho$，它们不受轴向加载条件（$\\sigma_z, \\epsilon_x, \\epsilon_y$）的影响。\n\n现在将这个全面的理论框架应用于具体的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ultrasound elastography contrast ambiguity problem\n    for the given test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Eh, Es, nu_h, nu_s, rho_h, rho_s, p)\n    # Units: E in kPa, rho in kg/m^3, p in kPa, nu is dimensionless.\n    test_cases = [\n        (100.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 2.0),\n        (100.0, 10.0, 0.30, 0.30, 1000.0, 1000.0, 2.0),\n        (12.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Eh, Es, nu_h, nu_s, rho_h, rho_s, p = case\n        \n        # Ground truth: The soft inclusion is indeed softer than the hard shell.\n        ground_truth_softness = Es  Eh\n\n        # --- Task 3: Mode Constrained Analysis ---\n        \n        # The hard shell is in plane stress. Its naive apparent modulus measurement\n        # is correct and equals its true Young's modulus.\n        E_app_h_constrained = Eh\n        \n        # The soft inclusion is in plane strain, but its strain is naively interpreted\n        # using the plane stress formula E_app = p / epsilon_z.\n        # From first principles, the axial strain in plane strain is:\n        # epsilon_z_s = p * (1+nu_s)(1-2*nu_s) / (Es * (1-nu_s))\n        # The naive apparent modulus is therefore:\n        # E_app_s = p / epsilon_z_s = Es * (1-nu_s) / ((1+nu_s)*(1-2*nu_s))\n        \n        # Handle the near-incompressible case to avoid division by zero.\n        if nu_s >= 0.5:\n            # For a perfectly incompressible material (nu=0.5), a plane strain\n            # compression is impossible, and the apparent modulus is infinite.\n            E_app_s_constrained = float('inf')\n        else:\n            E_app_s_constrained = Es * (1.0 - nu_s) / ((1.0 + nu_s) * (1.0 - 2.0 * nu_s))\n        \n        # Ambiguity is true if the naive measurement makes the soft layer appear harder,\n        # reversing the true stiffness contrast.\n        ambiguous = (E_app_s_constrained > E_app_h_constrained) and ground_truth_softness\n\n        # --- Task 4: Mode Free Analysis ---\n        \n        # In this mode, both layers are in plane stress. The naive apparent modulus\n        # measurement is correct for both.\n        E_app_h_free = Eh\n        E_app_s_free = Es\n        \n        # Resolved is true if the measurement correctly shows the soft layer is softer.\n        resolved = (E_app_s_free  E_app_h_free) and ground_truth_softness\n        \n        # --- Task 5: Shear Wave Elastography Analysis ---\n        \n        # Shear modulus is defined as mu = E / (2*(1+nu)).\n        mu_h = Eh / (2.0 * (1.0 + nu_h))\n        mu_s = Es / (2.0 * (1.0 + nu_s))\n        \n        # Shear wave speed squared is proportional to mu/rho. We only need to compare\n        # this ratio. Unit conversions for E (kPa to Pa) cancel out.\n        cs_sq_h = mu_h / rho_h\n        cs_sq_s = mu_s / rho_s\n        \n        # The shear_sign indicates the stiffness contrast measured by SWE.\n        shear_sign = 1 if cs_sq_h > cs_sq_s else -1\n        \n        results.append([ambiguous, resolved, shear_sign])\n\n    # Final print statement must produce the single-line format specified.\n    # The str() of a Python list is '[item1, item2, ...]' which matches the required\n    # inner list format. The f-string constructs the final outer list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4940413"}, {"introduction": "在前一个练习的基础上，本题将深入探讨如何结合不同测量方法以实现更强大的定量分析。通过同时测量剪切波速度（一种组织的内在属性）和在特定约束条件下的应力-应变响应，我们可以联立求解多个基本的弹性常数，例如剪切模量 $\\mu$ 和泊松比 $\\nu$。本练习不仅将引导你完成这一推导过程，还将分析计算结果对测量误差的敏感性，这是实验科学中至关重要的一环 [@problem_id:4940402]。", "problem": "在小形变、线性、各向同性弹性条件下，使用应变成像和剪切波弹性成像技术对一个均匀的软组织体模进行检测。沿轴向 $z$ 施加一个垂直的准静态压缩，同时侧面受到约束以抑制横向形变（横向约束）。通过力传感和超声散斑跟踪分别测量了稳态轴向柯西应力 $\\sigma_{zz}$ 和轴向工程应变 $\\epsilon_{zz}$。在使用声辐射力脉冲（ARFI）剪切波弹性成像的另一次采集中，在同一感兴趣区域测量了剪切波速 $c_{s}$。组织质量密度是已知的。\n\n假设以下实验测定值：\n- $\\rho = 1000\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $c_{s} = 3.00\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $\\sigma_{zz} = -2.25\\ \\mathrm{kPa}$ 在 $\\epsilon_{zz} = -0.010$\n\n假设在真实状态下，横向约束意味着 $\\epsilon_{xx} = \\epsilon_{yy} = 0$。然而，横向应变跟踪算法可能会报告一个小的伪横向应变 $\\epsilon_{xx} = e$（根据对称性有 $\\epsilon_{yy}=e$），分析师可能会错误地在三维各向同性本构律的直接反演中使用该值来估计泊松比。\n\n仅从线性各向同性弹性的基本本构关系和线性弹性固体中剪切波速的定义出发，完成以下任务：\n1) 根据 $\\rho$ 和 $c_{s}$ 确定剪切模量 $\\mu$。\n2) 使用在横向约束下测得的 $\\sigma_{zz}$ 和 $\\epsilon_{zz}$ 以及你计算出的 $\\mu$ 值，确定泊松比 $\\nu$。\n3) 如果分析师改为通过将测得的 $\\epsilon_{xx}=e$（以及 $\\epsilon_{yy}=e$）代入 $\\sigma_{zz}$ 的三维各向同性应力-应变关系来估计 $\\nu$，计算在 $e=0$ 时，估计的泊松比对该横向应变测量的的一阶灵敏度；即，计算 $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0}$。\n\n将你的最终答案以行向量的形式报告，按顺序包含：以 $\\mathrm{kPa}$ 为单位的 $\\mu$，$\\nu$（无量纲），以及 $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0}$（无量纲）。将每个条目四舍五入到四位有效数字。在最终的方框答案中不要包含单位；仅在文中按要求说明单位。", "solution": "该问题经验证具有科学依据，提法恰当且客观。所有提供的数据对于软组织都是物理上现实的，任务基于连续介质力学和波传播的基本原理。问题是自洽的，没有矛盾。\n\n根据题目要求，解答分为三个部分。\n\n**第一部分：确定剪切模量 $\\mu$**\n\n在线性、各向同性、弹性固体中，剪切波的传播由波动方程决定。这些波的速度 $c_s$ 与材料的剪切模量 $\\mu$ 及其质量密度 $\\rho$ 通过以下基本关系相关联：\n$$c_s = \\sqrt{\\frac{\\mu}{\\rho}}$$\n为了确定剪切模量 $\\mu$，我们可以重排这个方程：\n$$\\mu = \\rho c_s^2$$\n题目提供了以下值：\n-   质量密度, $\\rho = 1000 \\ \\mathrm{kg\\ m^{-3}}$\n-   剪切波速, $c_s = 3.00 \\ \\mathrm{m\\ s^{-1}}$\n\n将这些值代入 $\\mu$ 的方程中：\n$$\\mu = (1000 \\ \\mathrm{kg\\ m^{-3}}) \\times (3.00 \\ \\mathrm{m\\ s^{-1}})^2$$\n$$\\mu = 1000 \\times 9.00 \\ \\mathrm{kg\\ m^{-1}\\ s^{-2}}$$\n$$\\mu = 9000 \\ \\mathrm{Pa}$$\n题目要求将 $\\mu$ 的值以千帕（$\\mathrm{kPa}$）表示。由于 $1 \\ \\mathrm{kPa} = 1000 \\ \\mathrm{Pa}$，我们得到：\n$$\\mu = 9.000 \\ \\mathrm{kPa}$$\n\n**第二部分：确定泊松比 $\\nu$**\n\n线性、各向同性弹性材料的本构关系，也称为广义胡克定律，将柯西应力张量 $\\sigma_{ij}$ 与工程应变张量 $\\epsilon_{ij}$ 关联如下：\n$$\\sigma_{ij} = \\lambda \\delta_{ij} \\epsilon_{kk} + 2\\mu \\epsilon_{ij}$$\n这里，$\\lambda$ 是Lamé第一参数，$\\mu$ 是剪切模量，$\\delta_{ij}$ 是克罗内克δ函数，而 $\\epsilon_{kk} = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}$ 是应变张量的迹，代表体积应变。\n\n实验在横向约束的条件下进行，这意味着横向（$x$ 和 $y$ 方向）的应变为零：\n$$\\epsilon_{xx} = 0, \\quad \\epsilon_{yy} = 0$$\n对于轴向应力分量 $\\sigma_{zz}$（其中 $i=j=z$），本构关系变为：\n$$\\sigma_{zz} = \\lambda(\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n代入横向约束条件：\n$$\\sigma_{zz} = \\lambda(0 + 0 + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n$$\\sigma_{zz} = (\\lambda + 2\\mu) \\epsilon_{zz}$$\nLamé参数 $\\lambda$ 和 $\\mu$ 与泊松比 $\\nu$ 通过以下表达式相关联：\n$$\\lambda = \\frac{2\\mu\\nu}{1 - 2\\nu}$$\n将此代入 $\\sigma_{zz}$ 的方程中：\n$$\\sigma_{zz} = \\left(\\frac{2\\mu\\nu}{1 - 2\\nu} + 2\\mu\\right) \\epsilon_{zz}$$\n提出因子 $2\\mu$：\n$$\\sigma_{zz} = 2\\mu \\left(\\frac{\\nu}{1 - 2\\nu} + 1\\right) \\epsilon_{zz} = 2\\mu \\left(\\frac{\\nu + 1 - 2\\nu}{1 - 2\\nu}\\right) \\epsilon_{zz}$$\n$$\\sigma_{zz} = 2\\mu \\left(\\frac{1 - \\nu}{1 - 2\\nu}\\right) \\epsilon_{zz}$$\n为了求出 $\\nu$，我们重排这个方程。让我们定义一个无量纲量 $K$：\n$$K = \\frac{\\sigma_{zz}}{2\\mu \\epsilon_{zz}}$$\n然后，我们有：\n$$K = \\frac{1 - \\nu}{1 - 2\\nu}$$\n$$K(1 - 2\\nu) = 1 - \\nu$$\n$$K - 2K\\nu = 1 - \\nu$$\n$$K - 1 = 2K\\nu - \\nu = \\nu(2K - 1)$$\n$$\\nu = \\frac{K - 1}{2K - 1}$$\n我们已知实验值：\n-   $\\sigma_{zz} = -2.25 \\ \\mathrm{kPa} = -2250 \\ \\mathrm{Pa}$\n-   $\\epsilon_{zz} = -0.010$\n-   $\\mu = 9000 \\ \\mathrm{Pa}$ （来自第一部分）\n\n首先，我们计算 $K$：\n$$K = \\frac{-2250 \\ \\mathrm{Pa}}{2 \\times (9000 \\ \\mathrm{Pa}) \\times (-0.010)} = \\frac{-2250}{-180} = 12.5$$\n现在，我们计算 $\\nu$：\n$$\\nu = \\frac{12.5 - 1}{2(12.5) - 1} = \\frac{11.5}{25 - 1} = \\frac{11.5}{24} = \\frac{23}{48}$$\n以小数表示，$\\nu \\approx 0.479166...$。\n\n**第三部分：估计泊松比的灵敏度**\n\n一位分析师在成本构关系中错误地使用了伪横向应变测量值 $\\epsilon_{xx} = e$ 和 $\\epsilon_{yy} = e$。相关的应力分量仍然是 $\\sigma_{zz}$：\n$$\\sigma_{zz} = \\lambda(\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n代入伪应变：\n$$\\sigma_{zz} = \\lambda(e + e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz} = \\lambda(2e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n我们再次代入 $\\lambda = \\frac{2\\mu\\nu}{1 - 2\\nu}$。这里，$\\nu$ 是估计的泊松比，它现在是 $e$ 的函数。\n$$\\sigma_{zz} = \\frac{2\\mu\\nu(e)}{1 - 2\\nu(e)}(2e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n为了找到灵敏度 $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\left.\\frac{d\\nu}{de}\\right|_{e=0}$，我们可以对 $e$ 使用隐式微分法。量 $\\sigma_{zz}$、$\\epsilon_{zz}$ 和 $\\mu$ 被视为常数。\n$$0 = \\frac{d}{de} \\left[ \\frac{2\\mu\\nu(e)}{1-2\\nu(e)}(2e + \\epsilon_{zz}) \\right] + 0$$\n应用乘法法则和链式法则：\n$$0 = 2\\mu \\left[ \\frac{d}{de}\\left(\\frac{\\nu}{1-2\\nu}\\right) (2e + \\epsilon_{zz}) + \\frac{\\nu}{1-2\\nu} \\frac{d}{de}(2e+\\epsilon_{zz}) \\right]$$\n$\\frac{\\nu}{1-2\\nu}$ 对 $\\nu$ 的导数是 $\\frac{1}{(1-2\\nu)^2}$。$(2e+\\epsilon_{zz})$ 对 $e$ 的导数是 $2$。\n$$0 = \\frac{1}{(1-2\\nu)^2} \\frac{d\\nu}{de} (2e + \\epsilon_{zz}) + \\frac{\\nu}{1-2\\nu} (2)$$\n我们想在 $e=0$ 处计算这个值。在 $e=0$ 时，估计的泊松比 $\\nu$ 必须等于在第二部分中计算的真实值，我们将其表示为 $\\nu_0 = 23/48$。\n$$0 = \\frac{1}{(1-2\\nu_0)^2} \\left.\\frac{d\\nu}{de}\\right|_{e=0} (\\epsilon_{zz}) + \\frac{2\\nu_0}{1-2\\nu_0}$$\n求解导数：\n$$\\frac{1}{(1-2\\nu_0)^2} \\left.\\frac{d\\nu}{de}\\right|_{e=0} \\epsilon_{zz} = -\\frac{2\\nu_0}{1-2\\nu_0}$$\n$$\\left.\\frac{d\\nu}{de}\\right|_{e=0} = -\\frac{2\\nu_0}{1-2\\nu_0} \\cdot (1-2\\nu_0)^2 \\cdot \\frac{1}{\\epsilon_{zz}}$$\n$$\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\frac{-2\\nu_0(1-2\\nu_0)}{\\epsilon_{zz}}$$\n我们有 $\\nu_0 = 23/48$ 和 $\\epsilon_{zz} = -0.010$。\n首先，计算 $1-2\\nu_0$：\n$$1 - 2\\nu_0 = 1 - 2\\left(\\frac{23}{48}\\right) = 1 - \\frac{23}{24} = \\frac{1}{24}$$\n现在，将这些值代入导数表达式中：\n$$\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\frac{-2 \\left(\\frac{23}{48}\\right) \\left(\\frac{1}{24}\\right)}{-0.010} = \\frac{2 \\cdot \\frac{23}{48 \\cdot 24}}{0.01} = \\frac{\\frac{46}{1152}}{\\frac{1}{100}} = \\frac{4600}{1152}$$\n化简分数：\n$$\\frac{4600}{1152} = \\frac{2300}{576} = \\frac{1150}{288} = \\frac{575}{144}$$\n以小数表示，这大约是 $3.993055...$。\n\n**最终答案总结：**\n\n题目要求以行向量的形式报告这三个计算值，并四舍五入到四位有效数字。\n1.  $\\mu = 9.00 \\ \\mathrm{kPa}$。四舍五入到四位有效数字，为 $9.000 \\ \\mathrm{kPa}$。\n2.  $\\nu = 23/48 \\approx 0.479166...$。四舍五入到四位有效数字，为 $0.4792$。\n3.  $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = 575/144 \\approx 3.993055...$。四舍五入到四位有效数字，为 $3.993$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9.000  0.4792  3.993\n\\end{pmatrix}\n}\n$$", "id": "4940402"}, {"introduction": "最后的练习将视角转向超声系统本身的工程设计。产生剪切波需要一个聚焦的声辐射力“推”脉冲，但为了患者安全，这种能量的沉积必须被严格控制。本练习提出了一个实际的设计挑战：在不超过声强度的安全监管限制的前提下，如何确定最佳的推压参数以获得清晰的剪切波信号（高信噪比）。这个练习将波产生的物理学原理与医疗设备工程的现实约束联系起来 [@problem_id:4940426]。", "problem": "一个剪切波弹性成像系统通过发射聚焦声脉冲推力波束来产生剪切波，其空间峰值脉冲平均强度 (SPPA) 记为 $I_{\\mathrm{SPPA}}$，推送持续时间为 $ \\tau_{\\mathrm{push}}$，推送重复频率为 $ f_{\\mathrm{rep}}$。该成像序列还包括持续的诊断成像，其贡献了一个恒定的基线空间峰值时间平均强度 (SPTA)，记为 $I_{\\mathrm{SPTA,base}}$。总SPTA的法规限制为 $I_{\\mathrm{SPTA,lim}}$。\n\n假设存在以下基本关系：\n- 空间峰值时间平均强度是空间峰值强度在一个周期内的时间平均值，因此推送对SPTA的贡献为 $I_{\\mathrm{SPPA}} \\times (\\tau_{\\mathrm{push}} f_{\\mathrm{rep}})$，总SPTA为 $I_{\\mathrm{SPTA,tot}} = I_{\\mathrm{SPPA}} \\tau_{\\mathrm{push}} f_{\\mathrm{rep}} + I_{\\mathrm{SPTA,base}}$。\n- 根据先前在均匀软组织仿体上的校准，剪切波信噪比 (SNR)（记为 $\\mathrm{SNR}$）与推送强度-时间乘积成线性关系，即 $\\mathrm{SNR} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}$，其中 $k$ 是一个由系统和待测组织类别决定的已知比例常数。\n\n给定以下参数：\n- $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}$，\n- $k = 5.0 \\times 10^{-3} \\ \\mathrm{m}^{2}\\,\\mathrm{W}^{-1}\\,\\mathrm{s}^{-1}$，\n- 目标剪切波 $\\mathrm{SNR}_{\\mathrm{target}} = 12$，\n- $I_{\\mathrm{SPTA,base}} = 1.2 \\times 10^{3} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}$，\n- $I_{\\mathrm{SPTA,lim}} = 7.2 \\times 10^{3} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}$，\n\n设计推送参数，以在满足目标剪切波 $\\mathrm{SNR}_{\\mathrm{target}}$ 的同时，最小化推送开启时间，然后计算仍然满足SPTA法规限制的最大允许推送重复频率 $ f_{\\mathrm{rep}} $。具体要求如下：\n1. 选择能达到 $ \\mathrm{SNR}_{\\mathrm{target}} $ 的最小 $ \\tau_{\\mathrm{push}} $ 值。\n2. 使用该 $ \\tau_{\\mathrm{push}} $ 值，确定最大允许推送重复频率 $ f_{\\mathrm{rep,max}} $，使得 $ I_{\\mathrm{SPTA,tot}} \\le I_{\\mathrm{SPTA,lim}} $。\n\n以 $\\mathrm{Hz}$ 为单位表示 $ f_{\\mathrm{rep,max}} $ 的最终数值答案，并将其四舍五入至四位有效数字。", "solution": "该问题要求我们确定超声弹性成像序列的最佳推送参数（$\\tau_{\\mathrm{push}}$ 和 $f_{\\mathrm{rep}}$），以在满足目标信噪比（SNR）的同时，遵守声强度的安全法规限制（SPTA）。此过程分为两个连续的步骤。\n\n**第1部分：确定最小推送持续时间 $\\tau_{\\mathrm{push}}$**\n\n信噪比（$\\mathrm{SNR}$）与推送强度 $I_{\\mathrm{SPPA}}$ 和推送持续时间 $\\tau_{\\mathrm{push}}$ 之间的关系由以下线性模型给出：\n$$\n\\mathrm{SNR} = k \\, I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}\n$$\n为了以最小的推送持续时间达到目标信噪比 $\\mathrm{SNR}_{\\mathrm{target}}$，我们求解 $\\tau_{\\mathrm{push}}$：\n$$\n\\tau_{\\mathrm{push}} = \\frac{\\mathrm{SNR}_{\\mathrm{target}}}{k \\, I_{\\mathrm{SPPA}}}\n$$\n代入给定值：\n- $\\mathrm{SNR}_{\\mathrm{target}} = 12$\n- $k = 5.0 \\times 10^{-3} \\ \\mathrm{m}^{2} \\, \\mathrm{W}^{-1} \\, \\mathrm{s}^{-1}$\n- $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$\n\n首先计算分母中的乘积：\n$$\nk \\, I_{\\mathrm{SPPA}} = (5.0 \\times 10^{-3}) \\times (4.0 \\times 10^{5}) = 20.0 \\times 10^{2} \\ \\mathrm{s}^{-1} = 2000 \\ \\mathrm{s}^{-1}\n$$\n然后计算 $\\tau_{\\mathrm{push}}$：\n$$\n\\tau_{\\mathrm{push}} = \\frac{12}{2000 \\ \\mathrm{s}^{-1}} = 0.006 \\ \\mathrm{s} = 6.0 \\times 10^{-3} \\ \\mathrm{s}\n$$\n这是满足目标信噪比所需的最小推送持续时间。\n\n**第2部分：确定最大推送重复频率 $f_{\\mathrm{rep,max}}$**\n\n总空间峰值时间平均强度 $I_{\\mathrm{SPTA,tot}}$ 是由推送脉冲和基线诊断成像共同贡献的：\n$$\nI_{\\mathrm{SPTA,tot}} = I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep}} + I_{\\mathrm{SPTA,base}}\n$$\n法规要求该总强度不得超过限制值 $I_{\\mathrm{SPTA,lim}}$：\n$$\nI_{\\mathrm{SPTA,tot}} \\le I_{\\mathrm{SPTA,lim}}\n$$\n为求得最大允许推送重复频率 $f_{\\mathrm{rep,max}}$，我们将总强度设为其上限值，并代入第一部分计算出的 $\\tau_{\\mathrm{push}}$：\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} \\, f_{\\mathrm{rep,max}} + I_{\\mathrm{SPTA,base}} = I_{\\mathrm{SPTA,lim}}\n$$\n求解 $f_{\\mathrm{rep,max}}$：\n$$\nf_{\\mathrm{rep,max}} = \\frac{I_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}}}{I_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}}}\n$$\n代入已知值：\n- $I_{\\mathrm{SPTA,lim}} = 7.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$\n- $I_{\\mathrm{SPTA,base}} = 1.2 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$\n- $I_{\\mathrm{SPPA}} = 4.0 \\times 10^{5} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}$\n- $\\tau_{\\mathrm{push}} = 6.0 \\times 10^{-3} \\ \\mathrm{s}$\n\n首先，计算分子，即留给推送脉冲的强度预算：\n$$\nI_{\\mathrm{SPTA,lim}} - I_{\\mathrm{SPTA,base}} = (7.2 \\times 10^{3}) - (1.2 \\times 10^{3}) = 6.0 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}\n$$\n接下来，计算分母，即单个推送脉冲的强度-时间乘积：\n$$\nI_{\\mathrm{SPPA}} \\, \\tau_{\\mathrm{push}} = (4.0 \\times 10^{5}) \\times (6.0 \\times 10^{-3}) = 24 \\times 10^{2} = 2.4 \\times 10^{3} \\ \\mathrm{W \\cdot s \\cdot m^{-2}}\n$$\n最后，计算 $f_{\\mathrm{rep,max}}$：\n$$\nf_{\\mathrm{rep,max}} = \\frac{6.0 \\times 10^{3} \\ \\mathrm{W} \\, \\mathrm{m}^{-2}}{2.4 \\times 10^{3} \\ \\mathrm{W \\cdot s \\cdot m^{-2}}} = \\frac{6.0}{2.4} \\ \\mathrm{s}^{-1} = 2.5 \\ \\mathrm{Hz}\n$$\n问题要求答案四舍五入到四位有效数字，因此最终答案为 $2.500 \\ \\mathrm{Hz}$。", "answer": "$$\n\\boxed{2.500}\n$$", "id": "4940426"}]}