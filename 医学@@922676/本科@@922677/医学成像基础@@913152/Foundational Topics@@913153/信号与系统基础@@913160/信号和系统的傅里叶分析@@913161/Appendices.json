{"hands_on_practices": [{"introduction": "在许多医学成像模式中，例如磁共振成像（MRI）中的射频脉冲或超声中的激励脉冲，信号通常被理想化为持续时间有限的事件。这个练习将引导你从第一性原理出发，推导一个基本矩形脉冲的傅里叶变换。掌握这种基础变换是理解信号频率内容如何分析，以及像狄拉克$ \\delta $函数这样的理想化概念如何在系统建模中出现的关键第一步 [@problem_id:4886099]。", "problem": "在磁共振成像（MRI）、超声成像以及其他医学成像模态的信号采集中，通常会使用短激励脉冲。考虑由函数 $x_{T}(t) = \\operatorname{rect}\\!\\left(\\frac{t}{T}\\right)$ 建模的时域矩形脉冲，其中 $\\operatorname{rect}(u)$ 定义为：当 $|u|\\leq \\frac{1}{2}$ 时 $\\operatorname{rect}(u)=1$，其他情况下 $\\operatorname{rect}(u)=0$，并且 $T0$ 是脉冲持续时间。使用角频率傅里叶变换的定义\n$$\n\\mathcal{F}\\{x(t)\\}(\\omega) = \\int_{-\\infty}^{\\infty} x(t)\\,\\exp(-j\\,\\omega t)\\,\\mathrm{d}t,\n$$\n从第一性原理出发，仅根据 $\\operatorname{rect}(\\cdot)$ 的定义和傅里叶变换积分，推导 $x_{T}(t)$ 的变换。\n\n为了将其与 Dirac δ函数联系起来，考虑缩放函数族 $y_{T}(t)=\\frac{1}{T}\\,\\operatorname{rect}\\!\\left(\\frac{t}{T}\\right)$，对于任意 $T0$，该函数族下的函数面积均为单位1。使用上述傅里叶变换的定义以及 Dirac δ函数的广义函数表征，计算极限\n$$\nL(\\omega) = \\lim_{T\\to 0^{+}} \\frac{1}{T}\\,\\mathcal{F}\\left\\{\\operatorname{rect}\\!\\left(\\frac{t}{T}\\right)\\right\\}(\\omega).\n$$\n请将 $L(\\omega)$ 表示为单一的闭式解析表达式。无需进行数值舍入。最终答案请勿包含单位。", "solution": "这个问题分为两部分。第一部分是推导矩形脉冲的傅里叶变换，第二部分是计算一个涉及该变换的特定极限。\n\n首先，我们分析函数 $x_T(t) = \\operatorname{rect}\\left(\\frac{t}{T}\\right)$。矩形函数 $\\operatorname{rect}(u)$ 定义为：当 $|u| \\le \\frac{1}{2}$ 时为 $1$，其他情况下为 $0$。代入 $u = \\frac{t}{T}$，我们发现当 $|\\frac{t}{T}| \\le \\frac{1}{2}$ 时，$x_T(t)$ 等于 $1$，这可以化简为 $|t| \\le \\frac{T}{2}$ 或 $-\\frac{T}{2} \\le t \\le \\frac{T}{2}$。对于所有其他 $t$ 值，$x_T(t)$ 等于 $0$。\n\n角频率傅里叶变换定义为：\n$$\nX_T(\\omega) = \\mathcal{F}\\{x_T(t)\\}(\\omega) = \\int_{-\\infty}^{\\infty} x_T(t)\\,\\exp(-j\\,\\omega t)\\,\\mathrm{d}t\n$$\n由于 $x_T(t)$ 仅在区间 $[-\\frac{T}{2}, \\frac{T}{2}]$ 上非零，我们可以改变积分限：\n$$\nX_T(\\omega) = \\int_{-T/2}^{T/2} 1 \\cdot \\exp(-j\\,\\omega t)\\,\\mathrm{d}t\n$$\n为了计算这个积分，我们对频率 $\\omega$ 分两种情况讨论。\n\n情况1：$\\omega = 0$。\n在这种情况下，被积函数变为 $\\exp(0) = 1$。\n$$\nX_T(0) = \\int_{-T/2}^{T/2} 1\\,\\mathrm{d}t = [t]_{-T/2}^{T/2} = \\frac{T}{2} - \\left(-\\frac{T}{2}\\right) = T\n$$\n\n情况2：$\\omega \\neq 0$。\n我们对指数函数进行积分：\n$$\nX_T(\\omega) = \\left[ \\frac{\\exp(-j\\,\\omega t)}{-j\\,\\omega} \\right]_{-T/2}^{T/2} = \\frac{1}{-j\\,\\omega} \\left( \\exp\\left(-j\\,\\omega \\frac{T}{2}\\right) - \\exp\\left(j\\,\\omega \\frac{T}{2}\\right) \\right)\n$$\n我们可以通过交换括号中的项来去掉分母中的负号：\n$$\nX_T(\\omega) = \\frac{1}{j\\,\\omega} \\left( \\exp\\left(j\\,\\omega \\frac{T}{2}\\right) - \\exp\\left(-j\\,\\omega \\frac{T}{2}\\right) \\right)\n$$\n使用欧拉公式 $\\sin(z) = \\frac{\\exp(jz) - \\exp(-jz)}{2j}$，我们可以识别出括号中的项。令 $z = \\frac{\\omega T}{2}$，则 $\\exp(j\\frac{\\omega T}{2}) - \\exp(-j\\frac{\\omega T}{2}) = 2j\\sin(\\frac{\\omega T}{2})$。将此代入我们关于 $X_T(\\omega)$ 的表达式中：\n$$\nX_T(\\omega) = \\frac{1}{j\\,\\omega} \\left( 2j\\sin\\left(\\frac{\\omega T}{2}\\right) \\right) = \\frac{2}{\\omega}\\sin\\left(\\frac{\\omega T}{2}\\right)\n$$\n为了以更紧凑的形式表示，我们可以使用非归一化 sinc 函数，其定义为 $\\operatorname{sinc}(z) = \\frac{\\sin(z)}{z}$。我们可以将结果重写为：\n$$\nX_T(\\omega) = T \\cdot \\frac{\\sin\\left(\\frac{\\omega T}{2}\\right)}{\\frac{\\omega T}{2}} = T \\operatorname{sinc}\\left(\\frac{\\omega T}{2}\\right)\n$$\n这种形式对于 $\\omega = 0$ 也成立，因为 $\\lim_{z\\to 0} \\operatorname{sinc}(z) = 1$。因此，$\\lim_{\\omega\\to 0} X_T(\\omega) = T \\operatorname{sinc}(0) = T \\cdot 1 = T$，这与我们情况1的结果相符。矩形脉冲的傅里叶变换的完整表达式是 $\\mathcal{F}\\{\\operatorname{rect}(t/T)\\}(\\omega) = T \\operatorname{sinc}(\\omega T/2)$。\n\n现在，我们进行问题的第二部分：计算极限 $L(\\omega)$。\n题目要求我们求：\n$$\nL(\\omega) = \\lim_{T\\to 0^{+}} \\frac{1}{T}\\,\\mathcal{F}\\left\\{\\operatorname{rect}\\!\\left(\\frac{t}{T}\\right)\\right\\}(\\omega)\n$$\n代入我们刚刚推导出的傅里叶变换表达式：\n$$\nL(\\omega) = \\lim_{T\\to 0^{+}} \\frac{1}{T} \\left( T \\operatorname{sinc}\\left(\\frac{\\omega T}{2}\\right) \\right)\n$$\n分子中的因子 $T$ 和因子 $\\frac{1}{T}$ 相互抵消，表达式化简为：\n$$\nL(\\omega) = \\lim_{T\\to 0^{+}} \\operatorname{sinc}\\left(\\frac{\\omega T}{2}\\right)\n$$\n当 $T$ 从正方向趋近于 $0$ 时，对于任意有限的 $\\omega$ 值，sinc 函数的自变量 $\\frac{\\omega T}{2}$ 也趋近于 $0$。sinc 函数在其自变量趋近于零时的极限是众所周知的：\n$$\n\\lim_{z \\to 0} \\operatorname{sinc}(z) = \\lim_{z \\to 0} \\frac{\\sin(z)}{z} = 1\n$$\n因此，极限 $L(\\omega)$ 为：\n$$\nL(\\omega) = 1\n$$\n这个结果与广义函数的分布理论是一致的。函数 $y_T(t) = \\frac{1}{T}\\operatorname{rect}(\\frac{t}{T})$ 是一个函数序列，在极限 $T \\to 0^{+}$ 的情况下，它可作为 Dirac δ函数 $\\delta(t)$ 的一种表示。具体来说，$\\lim_{T \\to 0^{+}} y_T(t) = \\delta(t)$。我们计算的极限 $L(\\omega)$ 等价于 $\\lim_{T \\to 0^{+}} \\mathcal{F}\\{y_T(t)\\}(\\omega)$。在适当的条件下，这等于 $\\mathcal{F}\\{\\lim_{T \\to 0^{+}} y_T(t)\\}(\\omega) = \\mathcal{F}\\{\\delta(t)\\}(\\omega)$。Dirac δ函数的傅里叶变换是 $\\int_{-\\infty}^{\\infty} \\delta(t) \\exp(-j\\omega t) \\mathrm{d}t = \\exp(-j\\omega \\cdot 0) = 1$。我们的直接计算证实了这一基本结果。\n$L(\\omega)$ 的最终闭式解析表达式为常数 $1$。", "answer": "$$\\boxed{1}$$", "id": "4886099"}, {"introduction": "在数字成像系统（如MRI）中，我们在频率域（$k$空间）中采集有限数量的数据点。一个常见的处理步骤是在执行傅里叶变换以重建图像之前对这些数据进行零填充。本练习将通过数学证明，零填充并不会创造新的信息，而是对底层的连续频谱进行插值，从而在重建域中获得更高的采样密度 [@problem_id:4886159]。理解这一原理有助于揭示为什么零填充的图像看起来更“平滑”或像素密度更高，但实际上并未提高真实的空间分辨率，这对于正确解读重建的医学图像至关重要。", "problem": "单线磁共振成像 (MRI) 读出由于在短窗口内的均匀线圈灵敏度而产生一个离散时间信号。设采集到的序列为有限长度，定义为 $x[n]$ 在 $0 \\leq n \\leq N-1$ 范围内，而在其他地方为零。从离散时间傅里叶变换 (DTFT) 和离散傅里叶变换 (DFT) 的定义出发，证明通过在时间上补零（零填充）形成一个长度为 $M  N$ 的更长序列 $x_{\\text{pad}}[n]$，并不会改变原始有限长度序列的 DTFT，并且计算 $M$ 点 DFT 对应于在更密的频率网格上对相同的 DTFT 进行采样。明确说明 $N$ 点和 $M$ 点 DFT 的频率采样间隔（以弧度为单位），并解释为什么这会增加频率上的采样密度而不增加新的信息。对所有频率变量使用弧度。\n\n然后，考虑特定序列 $x[n] = 1$ (对于 $n = 0, 1, 2, 3, 4$) 且在其他情况下 $x[n] = 0$，其中 $N=5$。将此序列零填充至长度 $M=20$。仅使用定义和第一性原理，计算在索引 $k=3$ 处的 $M$ 点 DFT 的幅值，即计算当 $M=20$ 和 $k=3$ 时的 $\\left|X_{M}[k]\\right|$。将您的最终数值答案四舍五入到四位有效数字。将最终结果表示为无量纲量。", "solution": "这个问题的基础是一个序列的离散时间傅里叶变换 (DTFT) 的定义，以及离散傅里叶变换 (DFT) 作为在均匀间隔的频率网格上对 DTFT 的采样的定义。\n\n对于一个定义在 $0 \\leq n \\leq N-1$ 上的有限长度序列 $x[n]$，其离散时间傅里叶变换 (DTFT) 定义为\n$$\nX(\\omega) = \\sum_{n=0}^{N-1} x[n] \\exp(-\\mathrm{j}\\,\\omega n),\n$$\n其中 $\\omega$ 是以弧度为单位测量的连续频率变量。一个序列 $x[n]$（在 $0 \\leq n \\leq L-1$ 范围内解释）的 $L$ 点离散傅里叶变换 (DFT) 对整数 $k$ 定义为\n$$\nX_{L}[k] = \\sum_{n=0}^{L-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{L}\\,n\\right).\n$$\n当序列 $x[n]$ 在 $0 \\leq n \\leq N-1$ 范围外为零时，将求和的上限从 $N-1$ 扩展到任何 $M-1$（其中 $M  N$）并不会改变求和结果，因为所有增加的项都为零。因此，定义一个零填充序列\n$$\nx_{\\text{pad}}[n] = \\begin{cases}\nx[n],  0 \\leq n \\leq N-1,\\\\\n0,  N \\leq n \\leq M-1,\n\\end{cases}\n$$\n其 DTFT 为\n$$\nX_{\\text{pad}}(\\omega) = \\sum_{n=0}^{M-1} x_{\\text{pad}}[n] \\exp(-\\mathrm{j}\\,\\omega n) = \\sum_{n=0}^{N-1} x[n] \\exp(-\\mathrm{j}\\,\\omega n) = X(\\omega).\n$$\n因此，零填充不会改变原始有限长度序列的 DTFT。\n\n$L$ 点 DFT 在离散频率 $\\omega_{k}^{(L)} = \\frac{2\\pi k}{L}$ 处对 DTFT 进行采样，因为\n$$\nX_{L}[k] = \\sum_{n=0}^{L-1} x[n] \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi k}{L}\\,n\\right) = X\\!\\left(\\frac{2\\pi k}{L}\\right)\\quad \\text{当 } x[n]=0 \\text{ 对于 } n \\geq L.\n$$\n对于一个定义在 $0 \\leq n \\leq N-1$ 上的有限长度序列 $x[n]$，当序列被零填充时，这个关系不仅适用于 $L=N$，也适用于任何更大的 $L=M$，因为 DTFT 没有改变。$N$ 点 DFT 的频率采样间隔（网格间距）是\n$$\n\\Delta \\omega_{N} = \\frac{2\\pi}{N},\n$$\n而 $M$ 点 DFT 的是\n$$\n\\Delta \\omega_{M} = \\frac{2\\pi}{M}.\n$$\n由于 $M  N$，我们有 $\\Delta \\omega_{M}  \\Delta \\omega_{N}$，这意味着 $M$ 点 DFT 在更密的频率集合上对 $X(\\omega)$ 进行采样。这增加了频域的采样密度，但没有改变 $X(\\omega)$，因此不引入新信息；它仅仅是在更多的点上对相同的底层 DTFT 进行内插。\n\n现在，对于特定序列 $x[n] = 1$（对于 $n = 0,1,2,3,4$）且在其他情况下为零，其中 $N=5$，我们零填充到 $M=20$。我们计算在索引 $k=3$ 处的 $M$ 点 DFT：\n$$\nX_{M}[3] = \\sum_{n=0}^{M-1} x_{\\text{pad}}[n] \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi \\cdot 3}{M}\\,n\\right) = \\sum_{n=0}^{4} 1 \\cdot \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi \\cdot 3}{20}\\,n\\right).\n$$\n定义 $\\alpha = \\frac{2\\pi \\cdot 3}{20} = \\frac{3\\pi}{10}$。那么\n$$\nX_{M}[3] = \\sum_{n=0}^{4} \\exp(-\\mathrm{j}\\,\\alpha n).\n$$\n这是一个公比为 $r = \\exp(-\\mathrm{j}\\,\\alpha)$ 的有限几何级数。使用求和公式，\n$$\n\\sum_{n=0}^{N-1} r^{n} = \\frac{1 - r^{N}}{1 - r}, \\quad \\text{其中 } N=5,\n$$\n我们得到\n$$\nX_{M}[3] = \\frac{1 - \\exp(-\\mathrm{j}\\,5\\alpha)}{1 - \\exp(-\\mathrm{j}\\,\\alpha)}.\n$$\n为了计算幅值，我们使用将此比率与正弦函数联系起来的恒等式。从\n$$\n\\left|\\sum_{n=0}^{N-1} \\exp(-\\mathrm{j}\\,\\alpha n)\\right| = \\left|\\exp\\!\\left(-\\mathrm{j}\\,\\frac{\\alpha (N-1)}{2}\\right)\\right| \\cdot \\left|\\frac{\\sin\\!\\left(\\frac{N\\alpha}{2}\\right)}{\\sin\\!\\left(\\frac{\\alpha}{2}\\right)}\\right| = \\left|\\frac{\\sin\\!\\left(\\frac{N\\alpha}{2}\\right)}{\\sin\\!\\left(\\frac{\\alpha}{2}\\right)}\\right|,\n$$\n开始，因为对于任意实数 $\\theta$，都有 $\\left|\\exp(\\mathrm{j}\\,\\theta)\\right| = 1$。\n\n当 $N=5$ 且 $\\alpha = \\frac{3\\pi}{10}$ 时，\n$$\n\\left|X_{M}[3]\\right| = \\left|\\frac{\\sin\\!\\left(\\frac{5\\alpha}{2}\\right)}{\\sin\\!\\left(\\frac{\\alpha}{2}\\right)}\\right| = \\left|\\frac{\\sin\\!\\left(\\frac{5 \\cdot 3\\pi}{20}\\right)}{\\sin\\!\\left(\\frac{3\\pi}{20}\\right)}\\right| = \\left|\\frac{\\sin\\!\\left(\\frac{15\\pi}{20}\\right)}{\\sin\\!\\left(\\frac{3\\pi}{20}\\right)}\\right| = \\left|\\frac{\\sin\\!\\left(\\frac{3\\pi}{4}\\right)}{\\sin\\!\\left(\\frac{3\\pi}{20}\\right)}\\right|.\n$$\n我们简化 $\\sin\\!\\left(\\frac{3\\pi}{4}\\right) = \\frac{\\sqrt{2}}{2}$，得到\n$$\n\\left|X_{M}[3]\\right| = \\frac{\\frac{\\sqrt{2}}{2}}{\\sin\\!\\left(\\frac{3\\pi}{20}\\right)}.\n$$\n我们现在对 $\\sin\\!\\left(\\frac{3\\pi}{20}\\right)$ 进行数值计算，并将最终幅值四舍五入到四位有效数字。角度 $\\frac{3\\pi}{20}$ 等于 $27^\\circ$ 度，且\n$$\n\\sin\\!\\left(\\frac{3\\pi}{20}\\right) \\approx 0.45399049973954675.\n$$\n因此，\n$$\n\\left|X_{M}[3]\\right| \\approx \\frac{0.7071067811865476}{0.45399049973954675} \\approx 1.557536515.\n$$\n四舍五入到四位有效数字，\n$$\n\\left|X_{M}[3]\\right| \\approx 1.558.\n$$\n此结果为无量纲，符合要求。该推导证实了从 $N=5$ 到 $M=20$ 的零填充不会改变 DTFT $X(\\omega)$，并且 $M$ 点 DFT 在间隔为 $\\Delta \\omega_{M} = \\frac{2\\pi}{20}$ 的更密频率网格上对 $X(\\omega)$ 进行采样，而 $N$ 点 DFT 的间隔为 $\\Delta \\omega_{N} = \\frac{2\\pi}{5}$，从而在不增加新信息的情况下提高了频域采样密度。", "answer": "$$\\boxed{1.558}$$", "id": "4886159"}, {"introduction": "医学图像通常包含不同组织之间的清晰边缘。由于我们只能采集有限的频率数据（如MRI中的$k$空间），重建过程等效于对傅里叶级数进行截断。这个练习使用经典的阶跃函数来模拟一个锐利边缘，并要求你计算和可视化其傅里叶级数截断后的结果 [@problem_id:4886101]。这项动手计算实践使你能够直接观察和量化吉布斯现象（Gibbs phenomenon）——即在锐利不连续点附近出现的特征性振铃伪影——从而具体理解重建图像中的一种常见伪影。", "problem": "考虑在区间 $[-\\pi,\\pi]$ 上的单位阶跃函数的周期延拓，定义为当 $-\\pix0$ 时 $f(x)=0$，当 $0x\\pi$ 时 $f(x)=1$，以及 $f(0)=\\frac{1}{2}$，周期为 $2\\pi$。在医学影像基础的背景下，该信号模拟了一个理想化的分段常数物体函数。信号与系统的傅里叶分析解释了截断高频分量如何导致重建图像中出现吉布斯振铃（Gibbs ringing），这在磁共振成像（MRI）中当 $k$ 空间数据被有限采样时会遇到。\n\n从一个 $2\\pi$ 周期、分段平滑函数的傅里叶级数定义以及三角基的正交性这些基本原理出发，推导 $f(x)$ 的三角傅里叶级数。从第一性原理出发，构建 $N$ 项部分和 $S_N(x)$，并用它来量化 $x=0$ 处不连续点附近的吉布斯现象。\n\n用作基础的定义：\n- 一个实值的 $2\\pi$ 周期函数 $f(x)$ 具有傅里叶级数 $f(x)\\sim \\frac{a_0}{2}+\\sum_{n=1}^\\infty \\left(a_n\\cos(nx)+b_n\\sin(nx)\\right)$，其系数为\n$$\na_n=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\cos(nx)\\,dx,\\quad\nb_n=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\sin(nx)\\,dx,\\quad\na_0=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\,dx.\n$$\n- $N$ 项部分和为 $S_N(x)=\\frac{a_0}{2}+\\sum_{n=1}^{N} \\left(a_n\\cos(nx)+b_n\\sin(nx)\\right)$。\n\n你的任务是：\n1. 在不使用任何快捷公式的情况下，为上述函数 $f(x)$ 推导傅里叶系数 $\\{a_0,a_n,b_n\\}$。\n2. 实现一个程序，给定正弦项数 $N_{\\text{odd}}$（解释为保留的非零奇数索引正弦谐波的数量）和窗口半宽 $w$（以弧度为单位），从 $S_N(x)$ 计算以下三个量化指标：\n    - 过冲分数 $\\Delta^+$ 定义为\n    $$\n    \\Delta^+ = \\max_{x\\in[0,\\pi]} \\left(S_N(x)-1\\right),\n    $$\n    它衡量了超过上平台 $f(x)=1$ 的峰值偏移，并已通过跳变高度（为 1）进行归一化。以小数形式报告 $\\Delta^+$。\n    - 下冲分数 $\\Delta^-$ 定义为\n    $$\n    \\Delta^- = \\max\\left(0,-\\min_{x\\in[-\\pi,0]} S_N(x)\\right),\n    $$\n    它衡量了低于下平台 $f(x)=0$ 的最深偏移，并已通过跳变高度进行归一化。以小数形式报告 $\\Delta^-$。\n    - 在 $x=0$ 附近的对称窗口 $[-w,w]$ 内的均方振铃能量 $E(w)$，定义为\n    $$\n    E(w)=\\frac{1}{2w}\\left(\\int_{-w}^{0} \\left(S_N(x)-0\\right)^2\\,dx+\\int_{0}^{w} \\left(S_N(x)-1\\right)^2\\,dx\\right).\n    $$\n    以小数形式报告 $E(w)$。所有角度必须以弧度为单位。\n\n3. 使用均匀数值采样来评估 $S_N(x)$，并使用复合梯形法则来近似积分。确保采样密度在科学上是现实的，以使数值结果稳定。\n\n设计你的程序以运行以下参数对 $(N_{\\text{odd}},w)$ 的测试套件：\n- $(1,\\,0.50)$：边界情况，单个奇次谐波，中等窗口。\n- $(9,\\,0.50)$：理想情况，多个谐波，中等窗口。\n- $(49,\\,0.50)$：多个谐波，中等窗口。\n- $(9,\\,0.10)$：多个谐波，小窗口，聚焦于不连续点附近。\n- $(1,\\,0.10)$：边界情况，最少谐波，小窗口。\n- $(99,\\,0.10)$：多个谐波，小窗口。\n- $(99,\\,0.01)$：多个谐波，极小窗口，探测不连续点紧邻区域。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，其中每个条目对应一个测试用例，并且本身是一个三元素列表 $[\\Delta^+,\\Delta^-,E(w)]$，每个数字四舍五入到六位小数，例如：\n$[[\\Delta^+_1,\\Delta^-_1,E(w)_1],[\\Delta^+_2,\\Delta^-_2,E(w)_2],\\ldots]$。\n所有角度均以弧度为单位，所有报告的量均为无单位小数，四舍五入到六位小数。", "solution": "该问题是有效的，因为它在科学上基于傅里叶分析，问题设定良好且客观。它提出了信号处理中的一个标准的、不平凡的任务，与医学成像原理直接相关。问题陈述是自洽的，没有矛盾。\n\n在此，我们为给定函数推导傅里叶级数，并为所需的数值计算建立方法。\n\n### 第1部分：傅里叶系数的推导\n\n函数 $f(x)$ 在区间 $[-\\pi, \\pi]$ 上定义，周期为 $2\\pi$，具体如下：\n$$\nf(x) = \\begin{cases}\n    0  \\text{if } -\\pi  x  0 \\\\\n    1/2  \\text{if } x = 0 \\\\\n    1  \\text{if } 0  x  \\pi\n\\end{cases}\n$$\n\n我们使用提供的积分定义来计算傅里叶系数。\n\n**1. 直流分量系数 $a_0$ 的计算：**\n$$\na_0 = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\, dx\n$$\n根据 $f(x)$ 的分段定义拆分积分：\n$$\na_0 = \\frac{1}{\\pi} \\left( \\int_{-\\pi}^{0} 0 \\, dx + \\int_{0}^{\\pi} 1 \\, dx \\right) = \\frac{1}{\\pi} \\left( 0 + [x]_0^{\\pi} \\right) = \\frac{1}{\\pi} (\\pi - 0) = 1\n$$\n因此，傅里叶级数中的常数项是 $\\frac{a_0}{2} = \\frac{1}{2}$。\n\n**2. 余弦系数 $a_n$ 的计算（对于 $n \\ge 1$）：**\n$$\na_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\cos(nx) \\, dx\n$$\n拆分积分：\n$$\na_n = \\frac{1}{\\pi} \\left( \\int_{-\\pi}^{0} 0 \\cdot \\cos(nx) \\, dx + \\int_{0}^{\\pi} 1 \\cdot \\cos(nx) \\, dx \\right) = \\frac{1}{\\pi} \\int_{0}^{\\pi} \\cos(nx) \\, dx\n$$\n$$\na_n = \\frac{1}{\\pi} \\left[ \\frac{\\sin(nx)}{n} \\right]_0^{\\pi} = \\frac{1}{n\\pi} (\\sin(n\\pi) - \\sin(0)) = \\frac{1}{n\\pi} (0 - 0) = 0\n$$\n对于 $n \\ge 1$ 的所有余弦系数 $a_n$ 均为零。这是预料之中的，因为函数 $g(x) = f(x) - \\frac{1}{2}$ 是一个奇函数。\n\n**3. 正弦系数 $b_n$ 的计算（对于 $n \\ge 1$）：**\n$$\nb_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\sin(nx) \\, dx\n$$\n拆分积分：\n$$\nb_n = \\frac{1}{\\pi} \\left( \\int_{-\\pi}^{0} 0 \\cdot \\sin(nx) \\, dx + \\int_{0}^{\\pi} 1 \\cdot \\sin(nx) \\, dx \\right) = \\frac{1}{\\pi} \\int_{0}^{\\pi} \\sin(nx) \\, dx\n$$\n$$\nb_n = \\frac{1}{\\pi} \\left[ -\\frac{\\cos(nx)}{n} \\right]_0^{\\pi} = -\\frac{1}{n\\pi} (\\cos(n\\pi) - \\cos(0))\n$$\n由于 $\\cos(0)=1$ 和 $\\cos(n\\pi) = (-1)^n$，我们有：\n$$\nb_n = -\\frac{1}{n\\pi} ((-1)^n - 1)\n$$\n我们根据 $n$ 的奇偶性来评估此式：\n- 如果 $n$ 是偶数，$n=2k$（对于某个整数 $k \\ge 1$），则 $(-1)^n = 1$，且 $b_n = -\\frac{1}{n\\pi}(1-1) = 0$。\n- 如果 $n$ 是奇数，$n=2k-1$（对于某个整数 $k \\ge 1$），则 $(-1)^n = -1$，且 $b_n = -\\frac{1}{n\\pi}(-1-1) = \\frac{2}{n\\pi}$。\n\n**系数总结：**\n- $a_0 = 1$\n- $a_n = 0$ 对于 $n \\ge 1$\n- $b_n = 0$ 对于偶数 $n$ 且 $n \\ge 1$\n- $b_n = \\frac{2}{n\\pi}$ 对于奇数 $n$ ($n=1, 3, 5, \\ldots$)\n\n因此，$f(x)$ 的三角傅里叶级数为：\n$$\nf(x) \\sim \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} (a_n \\cos(nx) + b_n \\sin(nx)) = \\frac{1}{2} + \\sum_{n=1, \\text{odd}}^{\\infty} \\frac{2}{n\\pi} \\sin(nx)\n$$\n这可以通过令 $n=2k-1$ 来重写：\n$$\nf(x) \\sim \\frac{1}{2} + \\frac{2}{\\pi} \\sum_{k=1}^{\\infty} \\frac{\\sin((2k-1)x)}{2k-1}\n$$\n\n### 第2部分：部分和的公式化与计算方法\n\n问题根据 $N_{\\text{odd}}$（保留的非零奇数索引正弦谐波的数量）来定义部分和。这对应于在 $N_{\\text{odd}}$ 项后截断级数展开。问题中称为 $S_N(x)$ 的部分和，在这里更精确地表示为 $S_{N_{\\text{odd}}}(x)$：\n$$\nS_{N_{\\text{odd}}}(x) = \\frac{1}{2} + \\frac{2}{\\pi} \\sum_{k=1}^{N_{\\text{odd}}} \\frac{\\sin((2k-1)x)}{2k-1}\n$$\n这是要为计算而实现的函数。\n\n**1. 过冲 $\\Delta^+$ 与下冲 $\\Delta^-$ 的计算**\n\n过冲 $\\Delta^+$ 是 $S_{N_{\\text{odd}}}(x) - 1$ 在 $[0, \\pi]$ 上的最大值。为了找到这个最大值，我们首先通过对 $S_{N_{\\text{odd}}}(x)$ 求导来找到临界点：\n$$\nS'_{N_{\\text{odd}}}(x) = \\frac{d}{dx} \\left( \\frac{1}{2} + \\frac{2}{\\pi} \\sum_{k=1}^{N_{\\text{odd}}} \\frac{\\sin((2k-1)x)}{2k-1} \\right) = \\frac{2}{\\pi} \\sum_{k=1}^{N_{\\text{odd}}} \\cos((2k-1)x)\n$$\n使用恒等式 $\\sum_{k=1}^{m} \\cos((2k-1)\\theta) = \\frac{\\sin(2m\\theta)}{2\\sin(\\theta)}$，其中 $m=N_{\\text{odd}}$ 且 $\\theta=x$：\n$$\nS'_{N_{\\text{odd}}}(x) = \\frac{2}{\\pi} \\frac{\\sin(2N_{\\text{odd}}x)}{2\\sin(x)} = \\frac{\\sin(2N_{\\text{odd}}x)}{\\pi\\sin(x)}\n$$\n当 $S'_{N_{\\text{odd}}}(x) = 0$ 时出现极值，这意味着对于 $x \\neq 0, \\pm\\pi, \\ldots$，有 $\\sin(2N_{\\text{odd}}x) = 0$。这得出 $2N_{\\text{odd}}x = m\\pi$（对于整数 $m$）。在区间 $(0, \\pi)$ 内的第一个极值点位于 $x_1 = \\frac{\\pi}{2N_{\\text{odd}}}$。二阶导数检验确认这是一个最大值。因此，峰值过冲发生在此位置。\n$$\n\\Delta^+ = S_{N_{\\text{odd}}}\\left(\\frac{\\pi}{2N_{\\text{odd}}}\\right) - 1\n$$\n由于信号的奇分量 $S_{N_{\\text{odd}}}(x) - 1/2$ 的对称性，在 $[-\\pi, 0]$ 上的下冲与在 $[0, \\pi]$ 上的过冲成镜像关系。具体来说，$S_{N_{\\text{odd}}}(-x) = 1 - S_{N_{\\text{odd}}}(x)$。\n在 $[-\\pi, 0]$ 上的最小值位于 $x = -\\frac{\\pi}{2N_{\\text{odd}}}$。\n$$\n\\min_{x \\in [-\\pi,0]} S_{N_{\\text{odd}}}(x) = S_{N_{\\text{odd}}}\\left(-\\frac{\\pi}{2N_{\\text{odd}}}\\right) = 1 - S_{N_{\\text{odd}}}\\left(\\frac{\\pi}{2N_{\\text{odd}}}\\right)\n$$\n因此，下冲分数为：\n$$\n\\Delta^- = -\\min_{x \\in [-\\pi,0]} S_{N_{\\text{odd}}}(x) = S_{N_{\\text{odd}}}\\left(\\frac{\\pi}{2N_{\\text{odd}}}\\right) - 1 = \\Delta^+\n$$\n这两个量都将通过在 $x = \\frac{\\pi}{2N_{\\text{odd}}}$ 处评估 $S_{N_{\\text{odd}}}(x)$ 来计算。\n\n**2. 均方振铃能量 $E(w)$ 的计算**\n\n能量 $E(w)$ 定义为：\n$$\nE(w)=\\frac{1}{2w}\\left(\\int_{-w}^{0} \\left(S_{N_{\\text{odd}}}(x)\\right)^2\\,dx+\\int_{0}^{w} \\left(S_{N_{\\text{odd}}}(x)-1\\right)^2\\,dx\\right)\n$$\n该表达式需要进行数值积分。被积函数在 $x=0$ 处是连续的，因为 $S_{N_{\\text{odd}}}(0) = 1/2$，所以 $(1/2)^2 = (1/2-1)^2 = 1/4$。我们可以定义一个单一的组合被积函数 $g(x)$：\n$$\ng(x) = \\begin{cases} (S_{N_{\\text{odd}}}(x))^2  \\text{if } x  0 \\\\ (S_{N_{\\text{odd}}}(x)-1)^2  \\text{if } x \\ge 0 \\end{cases}\n$$\n那么 $E(w)$ 计算如下：\n$$\nE(w) = \\frac{1}{2w} \\int_{-w}^{w} g(x) \\,dx\n$$\n该积分将使用复合梯形法则进行近似。将在区间 $[-w, w]$ 上创建一个均匀的点网格。为确保数值稳定性和准确性，使用了高采样密度，采用一个固定的大的点数（$20001$），足以解析任何测试用例中的最高频率分量（$2N_{\\text{odd}}-1$）。\n\n实现将遵循这些推导出的公式和数值策略。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of quantifying the Gibbs phenomenon for a periodic step function.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1, 0.50),\n        (9, 0.50),\n        (49, 0.50),\n        (9, 0.10),\n        (1, 0.10),\n        (99, 0.10),\n        (99, 0.01),\n    ]\n\n    results = []\n    \n    # Use a large number of points for the numerical integration to ensure accuracy.\n    # This choice provides high sampling density for all test cases.\n    NUM_INTEGRATION_POINTS = 20001\n\n    for N_odd, w in test_cases:\n        # Define the partial sum function S_N(x)\n        def s_n(x, n_odd):\n            \"\"\"\n            Computes the partial sum of the Fourier series with n_odd sine terms.\n            \"\"\"\n            # Vectorized implementation for efficiency.\n            # Create an array of odd harmonic indices: 1, 3, 5, ...\n            # The shape of k is (1, n_odd)\n            k = np.arange(1, n_odd + 1).reshape(1, -1)\n            harmonics = 2 * k - 1\n            \n            # If x is a scalar, convert to a 1-element array for broadcasting\n            if np.isscalar(x):\n                x = np.array([x])\n\n            # Use broadcasting to compute sin((2k-1)x) for all x and k simultaneously.\n            # x is shaped as (len(x), 1), harmonics as (1, n_odd).\n            # The result of the term inside sin() is a matrix of shape (len(x), n_odd).\n            x_col = x.reshape(-1, 1)\n            sin_matrix = np.sin(harmonics * x_col)\n            \n            # The sum is over the harmonics (axis=1).\n            series_sum = np.sum(sin_matrix / harmonics, axis=1)\n            \n            return 0.5 + (2 / np.pi) * series_sum\n\n        # ---- 1. Calculate Overshoot (Delta+) and Undershoot (Delta-) ----\n        # The maximum overshoot occurs at x = pi / (2 * N_odd).\n        x_max_overshoot = np.pi / (2 * N_odd)\n        s_max = s_n(x_max_overshoot, N_odd)[0]\n        \n        # As derived, delta_plus and delta_minus are equal due to symmetry.\n        delta_plus = s_max - 1.0\n        delta_minus = delta_plus\n        \n        # The problem asks for undershoot as a positive value.\n        # delta_minus = max(0, -min(S(x))) on [-pi, 0].\n        # min(S(x)) on [-pi, 0] = S(-pi/(2*N_odd)) = 1 - S(pi/(2*N_odd)).\n        # So -min(S(x)) = S(pi/(2*N_odd)) - 1 = delta_plus.\n        # Our calculation is consistent with the definition.\n\n        # ---- 2. Calculate Mean-Squared Ringing Energy E(w) ----\n        # Create a uniform grid for numerical integration over [-w, w].\n        x_grid = np.linspace(-w, w, NUM_INTEGRATION_POINTS)\n        \n        # Evaluate the partial sum on the grid.\n        y_values = s_n(x_grid, N_odd)\n        \n        # Define the integrand for the energy calculation.\n        # For x  0, integrand is (S_N(x) - 0)^2\n        # For x = 0, integrand is (S_N(x) - 1)^2\n        integrand = np.where(x_grid  0, y_values**2, (y_values - 1)**2)\n        \n        # Compute the integral using the composite trapezoidal rule.\n        integral_val = np.trapz(integrand, x_grid)\n        \n        # Calculate the mean-squared energy E(w).\n        e_w = integral_val / (2 * w)\n        \n        # Append the formatted results for the current test case.\n        results.append([delta_plus, delta_minus, e_w])\n\n    # ---- 3. Format the final output string ----\n    # Each sub-list is formatted as a string \"[num1,num2,num3]\".\n    formatted_sublists = []\n    for sublist in results:\n        formatted_nums = [f\"{num:.6f}\" for num in sublist]\n        formatted_sublists.append(f\"[{','.join(formatted_nums)}]\")\n    \n    # The final output is a comma-separated list of these sub-list strings.\n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "4886101"}]}