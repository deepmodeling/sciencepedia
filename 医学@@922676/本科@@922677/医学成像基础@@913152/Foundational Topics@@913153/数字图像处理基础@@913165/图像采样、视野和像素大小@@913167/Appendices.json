{"hands_on_practices": [{"introduction": "在任何成像系统中，理解探测器上的像素与我们所关心物体本身细节之间的关系至关重要。此练习将带您从第一性原理出发，通过基本的几何放大原理，推导在投影成像中物体平面的有效像素大小。掌握这个关系[@problem_id:4893202]是连接硬件规格与最终图像分辨率的第一步。", "problem": "在投影放射成像中，一个平面成像系统将物体的放大图像形成在一个离散探测器上。该探测器在一个横向轴上具有间距为 $p_{d}$ 的均匀正方形像素。光学几何结构产生一个几何放大倍率 $M$，该放大倍率在视场的一个小的中心区域内是均匀的。放大倍率 $M$ 定义为沿主光线测量的像（探测器）平面上的微小线性距离与物平面上相应线性距离之比。探测器以 $p_{d}$ 的间隔对像平面进行采样，而物平面上的有效采样是映射到探测器上单个像素间隔的最小物平面间距。\n\n仅使用几何放大倍率的基本原理和采样间隔（定义为相邻采样点之间的距离）的定义，推导用 $M$ 和 $p_{d}$ 表示的物平面有效像素尺寸 $p_{\\text{obj}}$ 的解析表达式。以单个闭式符号表达式的形式给出答案。不要进行任何数值代入。无需四舍五入。如果引入任何首字母缩略词，请在首次使用时定义它们；例如，视场 (Field of View, FOV)。", "solution": "该问题要求基于投影成像系统中的几何放大倍率原理，推导物平面上有效像素尺寸（记为 $p_{\\text{obj}}$）的解析表达式。给定的量是探测器像素间距 $p_{d}$ 和几何放大倍率 $M$。\n\n分析从问题陈述中提供的几何放大倍率 $M$ 的定义开始。它被定义为像平面上的微小线性距离（我们称之为 $\\Delta L_{\\text{image}}$）与物平面上相应的线性距离 $\\Delta L_{\\text{obj}}$ 之比。这可以用数学公式表示为：\n$$M = \\frac{\\Delta L_{\\text{image}}}{\\Delta L_{\\text{obj}}}$$\n问题假设该放大倍率 $M$ 在感兴趣区域内是均匀的。\n\n探测器被描述为具有间距为 $p_{d}$ 的均匀正方形像素。像素间距是相邻像素中心之间的距离。因此，像（探测器）平面上的采样间隔等于像素间距。这代表了探测器离散采样的最小线性距离。因此，我们可以将像平面上的微小线性距离设为等于一个像素间距：\n$$\\Delta L_{\\text{image}} = p_{d}$$\n\n问题将“物平面上的有效像素尺寸” $p_{\\text{obj}}$ 定义为“映射到探测器上单个像素间隔的最小物平面间距”。这意味着 $p_{\\text{obj}}$ 正是物平面中的线性距离 $\\Delta L_{\\text{obj}}$，它对应于像平面上一个像素间距 $p_{d}$ 的线性距离。因此，我们可以设定：\n$$\\Delta L_{\\text{obj}} = p_{\\text{obj}}$$\n\n现在，我们将这些特定的物理量代入放大倍率的一般定义中：\n$$M = \\frac{p_{d}}{p_{\\text{obj}}}$$\n\n最后一步是对此方程求解所需量 $p_{\\text{obj}}$。通过对表达式进行代数重排，我们可以用探测器像素间距和放大倍率来表示物平面上的有效像素尺寸：\n$$M \\cdot p_{\\text{obj}} = p_{d}$$\n$$p_{\\text{obj}} = \\frac{p_{d}}{M}$$\n这个表达式表明，物平面上的有效像素尺寸等于探测器像素尺寸除以放大系数。这个结果与成像几何的基本原理一致，即更大的放大倍率 ($M > 1$) 意味着物体中一个更小的特征被放大以跨越探测器上的一个给定距离。", "answer": "$$\\boxed{\\frac{p_{d}}{M}}$$", "id": "4893202"}, {"introduction": "数字成像的基石是采样，但如果采样不够密集，图像就会产生误导性的伪影。这个练习[@problem_id:4893285]通过一个具体的计算案例，揭示了当采样频率不满足奈奎斯特采样准则时发生的混叠（aliasing）现象。通过量化这种“折叠”频率，您将深刻理解为什么选择合适的像素大小对于忠实地呈现物体细节至关重要。", "problem": "一个平面X射线成像系统使用一个宽度（视场，FOV）为 $W = 256\\,\\text{mm}$ 的探测器，沿一个空间维度对物体进行数字化，采样为 $N = 1024$ 个像素。物体包含一个连续空间频率为 $f = 3.2\\,\\text{cycles/mm}$、振幅为 $A$ 的一维正弦图案，因此该物体可以建模为 $s(x) = A \\cos(2\\pi f x)$。探测器以均匀间距 $\\Delta x = W/N$ 进行点采样。假设为理想点采样，且没有预采样光学模糊。\n\n仅使用基本采样原理（通过采样对物体频谱进行周期性复制，并将离散时间频谱限制在基带内），确定在采样图像中将观察到的正弦图案的表观空间频率，即当采样频率不足以满足采样准则时，图案折叠回的基带频率。将污染采样图像的这个表观基带空间频率定义为“混叠误差”。\n\n最终答案以单个数字表示，单位为每毫米周期数（cycles/mm），并四舍五入到四位有效数字。", "solution": "该问题要求确定采样图像中正弦图案的表观空间频率，这是一种称为混叠的现象。当采样率不足以无歧义地捕获原始信号的频率内容时，就会发生这种情况，正如奈奎斯特-香农采样定理所规定的那样。\n\n首先，我们必须确定采样过程的参数。探测器的视场（FOV）宽度为 $W = 256\\,\\text{mm}$，并被分为 $N = 1024$ 个像素。假设均匀点采样，相邻采样点之间的距离，即采样间距或像素间距，由下式给出：\n$$\n\\Delta x = \\frac{W}{N}\n$$\n代入给定值，我们得到：\n$$\n\\Delta x = \\frac{256\\,\\text{mm}}{1024} = 0.25\\,\\text{mm}\n$$\n采样频率 $f_s$ 是采样间距的倒数。它表示每单位长度所采集的样本数。\n$$\nf_s = \\frac{1}{\\Delta x} = \\frac{1}{0.25\\,\\text{mm}} = 4.0\\,\\text{cycles/mm}\n$$\n奈奎斯特-香农采样定理指出，要从样本中完美重建一个连续时间信号，采样频率 $f_s$ 必须严格大于信号中最大频率 $f_{max}$ 的两倍。这个临界频率 $f_s/2$ 被称为奈奎斯特频率 $f_{Nyquist}$。\n$$\nf_{Nyquist} = \\frac{f_s}{2} = \\frac{4.0\\,\\text{cycles/mm}}{2} = 2.0\\,\\text{cycles/mm}\n$$\n该定理避免混叠的条件是 $f_{max} < f_{Nyquist}$。\n\n被成像的物体是一个一维正弦图案 $s(x) = A \\cos(2\\pi f x)$，其单一空间频率为 $f = 3.2\\,\\text{cycles/mm}$。我们将此频率与成像系统的奈奎斯特频率进行比较：\n$$\nf = 3.2\\,\\text{cycles/mm} > f_{Nyquist} = 2.0\\,\\text{cycles/mm}\n$$\n由于信号的频率超过了奈奎斯特频率，采样准则未被满足，将会发生混叠。\n\n混叠现象可以通过检查采样信号的频谱来理解。原始连续信号 $s(x)$ 的频谱由位于频率 $\\pm f$ 处的两个狄拉克δ函数组成。在空间域进行采样的过程，对应于在频域中创建原始信号频谱的周期性副本。这些副本以采样频率 $k f_s$ 的整数倍为中心，其中 $k$ 是任意整数。因此，对于所有 $k \\in \\mathbb{Z}$，采样信号的频谱包含位于 $\\pm f + k f_s$ 的频率分量。\n\n当采样信号被重建或解释时，假定其所有频率内容都位于基带内，即区间 $[-f_{Nyquist}, f_{Nyquist}]$ 或 $[-f_s/2, f_s/2]$ 内。原始信号中任何位于该基带之外的频率分量都将被“折叠”回该基带，表现为一个频率较低的混叠分量。\n\n表观频率 $f_{app}$ 是在主范围 $[0, f_{Nyquist}]$ 内，与原始频率 $f$ 无法区分的频率。这个表观频率可以通过取原始频率 $f$ 并在基带中找到其混叠分量来确定。在数学上，这是原始频率与采样频率的最近整数倍之间的绝对差。这可以表示为找到一个整数 $k$，使得混叠频率 $f_{app} = |f - k f_s|$ 落在范围 $[0, f_{Nyquist}]$ 内。\n\n给定 $f = 3.2\\,\\text{cycles/mm}$ 和 $f_s = 4.0\\,\\text{cycles/mm}$，我们测试 $k$ 的整数值：\n- 对于 $k=0$，频率为 $|3.2 - 0 \\times 4.0| = 3.2\\,\\text{cycles/mm}$。此频率大于 $f_{Nyquist} = 2.0\\,\\text{cycles/mm}$，因此在基带之外。\n- 对于 $k=1$，频率为 $|3.2 - 1 \\times 4.0| = |-0.8| = 0.8\\,\\text{cycles/mm}$。此频率满足条件 $0 \\le 0.8 \\le 2.0$，因此位于基带内。\n\n这就是混叠频率。更大的 $|k|$ 值将产生基带外的频率。例如，对于 $k=-1$，频率为 $|3.2 - (-1) \\times 4.0| = 7.2\\,\\text{cycles/mm}$；对于 $k=2$，频率为 $|3.2 - 2 \\times 4.0| = |-4.8| = 4.8\\,\\text{cycles/mm}$。\n\n因此，频率为 $3.2\\,\\text{cycles/mm}$ 的原始正弦图案在采样图像中将表现为一个频率为 $0.8\\,\\text{cycles/mm}$ 的图案。问题将“混叠误差”定义为这个表观基带空间频率。\n\n表观空间频率为 $f_{app} = 0.8\\,\\text{cycles/mm}$。问题要求答案四舍五入到四位有效数字。\n\n因此，表观空间频率为 $0.8000\\,\\text{cycles/mm}$。", "answer": "$$\\boxed{0.8000}$$", "id": "4893285"}, {"introduction": "理论概念的最终检验在于实际测量。本练习将您置于一个真实的校准场景中：使用一个标准模体（phantom）来精确测定成像系统的像素大小[@problem_id:4893212]。您不仅需要应用几何学来解释模体的微小倾斜，还需运用不确定性传播的基本原理来评估测量结果的可靠性，这是所有严谨科学测量的核心技能。", "problem": "一个具有已知物理间距的规则垂直线的平面网格体模，被用于校准医学图像水平轴上的像素大小。该校准依赖于采样原理，即固定的像素大小通过线性比例将像素计数映射到物理距离；同时也依赖于当体模轻微旋转时，其间距在图像轴上的几何投影。在此背景下，您将设计校准方法，并从第一性原理出发，推导估计像素大小的不确定度。\n\n采集了一个网格体模的计算机断层扫描（CT）图像，其制造商规定的相邻垂直线之间的物理间距为 $s = 10.000$ 毫米，标准不确定度为 $u_{s} = 0.050$ 毫米。在图像中，两条相邻垂直线的质心之间的水平像素距离测量为 $\\Delta n_{x} = 19.86$ 像素，由于质心定位和有限采样，其标准不确定度为 $u_{n} = 0.20$ 像素。体模的垂直线相对于图像的垂直轴倾斜了一个小角度 $\\theta = 0.50$ 度，标准不确定度为 $u_{\\theta} = 0.10$ 度。假设成像系统中的几何失真可忽略不计，图像平面内采样是各向同性的，且各不确定度是独立（不相关）的。进一步假设不确定度很小，因此线性化有效，高阶项可以忽略。\n\n仅使用采样和几何投影的基本定义（其中，像素大小是连接像素数和物理距离的比例因子，而倾斜的体模线之间的水平物理距离可以通过几何关系从其垂直间距推导出来），推导估计的水平像素大小的表达式，然后通过传播 $s$、$\\Delta n_{x}$ 和 $\\theta$ 的不确定度，获得该估计值的一阶标准不确定度。注意在对角度求导时使用弧度。最后，计算像素大小标准不确定度的数值，并以微米表示。将您的答案四舍五入到三位有效数字，并以微米（µm）表示最终结果。", "solution": "### 像素大小的推导\n水平像素大小，我们表示为 $p_x$，是沿水平轴对应于单个像素的物理距离。问题陈述物理距离通过一个线性比例因子与像素计数相关，该比例因子即为 $p_x$。测得的像素距离是 $\\Delta n_x$，因此沿水平轴对应的物理距离是：\n$$ \\Delta x_{\\text{phys}} = p_x \\Delta n_x $$\n这个物理距离 $\\Delta x_{\\text{phys}}$ 必须与已知的体模间距 $s$ 相关联。体模由一组线组成，其垂直间距为 $s$，相对于图像的垂直轴倾斜角度为 $\\theta$。为了找到这些倾斜线之间的水平距离，我们需要考虑其几何关系。\n\n让我们画两条与垂直方向成 $\\theta$ 角的平行线。它们之间的垂直距离是 $s$。水平距离 $\\Delta x_{\\text{phys}}$ 是连接这两条倾斜线的水平线段的长度。该线段构成一个直角三角形的斜边，其中另一条边是垂直间距 $s$。水平线段 ($\\Delta x_{\\text{phys}}$) 和垂直间距线段 ($s$) 之间的夹角等于倾斜角 $\\theta$。在这个直角三角形中，邻边 ($s$)、斜边 ($\\Delta x_{\\text{phys}}$) 和角 $\\theta$ 之间的关系由下式给出：\n$$ \\cos(\\theta) = \\frac{s}{\\Delta x_{\\text{phys}}} $$\n根据这个几何关系，我们将水平物理间距表示为：\n$$ \\Delta x_{\\text{phys}} = \\frac{s}{\\cos(\\theta)} $$\n令 $\\Delta x_{\\text{phys}}$ 的两个表达式相等，得到：\n$$ p_x \\Delta n_x = \\frac{s}{\\cos(\\theta)} $$\n求解水平像素大小 $p_x$，我们得到估计公式：\n$$ p_x = \\frac{s}{\\Delta n_x \\cos(\\theta)} $$\n\n### 不确定度传播\n估计像素大小的标准不确定度 $u_{p}$ 是通过传播自变量 $s$、$\\Delta n_x$ 和 $\\theta$ 的不确定度来找到的。对于函数 $p_x(s, \\Delta n_x, \\theta)$，组合方差 $u_p^2$ 由一阶近似给出：\n$$ u_p^2 = \\left(\\frac{\\partial p_x}{\\partial s}\\right)^2 u_s^2 + \\left(\\frac{\\partial p_x}{\\partial \\Delta n_x}\\right)^2 u_n^2 + \\left(\\frac{\\partial p_x}{\\partial \\theta}\\right)^2 u_{\\theta}^2 $$\n必须计算偏导数。对于关于 $\\theta$ 的微分，角度必须以弧度为单位。\n$$ \\frac{\\partial p_x}{\\partial s} = \\frac{1}{\\Delta n_x \\cos(\\theta)} $$\n$$ \\frac{\\partial p_x}{\\partial \\Delta n_x} = -\\frac{s}{(\\Delta n_x)^2 \\cos(\\theta)} $$\n$$ \\frac{\\partial p_x}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\frac{s}{\\Delta n_x} (\\cos(\\theta))^{-1} \\right) = \\frac{s}{\\Delta n_x} \\left( -(\\cos(\\theta))^{-2} (-\\sin(\\theta)) \\right) = \\frac{s \\sin(\\theta)}{\\Delta n_x \\cos^2(\\theta)} $$\n为了方便，可以通过将方差方程除以 $p_x^2 = \\left(\\frac{s}{\\Delta n_x \\cos(\\theta)}\\right)^2$ 来用相对项表示不确定度：\n$$ \\left(\\frac{u_p}{p_x}\\right)^2 = \\left(\\frac{1}{p_x}\\frac{\\partial p_x}{\\partial s}\\right)^2 u_s^2 + \\left(\\frac{1}{p_x}\\frac{\\partial p_x}{\\partial \\Delta n_x}\\right)^2 u_n^2 + \\left(\\frac{1}{p_x}\\frac{\\partial p_x}{\\partial \\theta}\\right)^2 u_{\\theta}^2 $$\n代入导数并化简得到：\n$$ \\left(\\frac{u_p}{p_x}\\right)^2 = \\left(\\frac{1}{s}\\right)^2 u_s^2 + \\left(-\\frac{1}{\\Delta n_x}\\right)^2 u_n^2 + \\left(\\frac{\\sin(\\theta)}{\\cos(\\theta)}\\right)^2 u_{\\theta}^2 $$\n$$ \\left(\\frac{u_p}{p_x}\\right)^2 = \\left(\\frac{u_s}{s}\\right)^2 + \\left(\\frac{u_n}{\\Delta n_x}\\right)^2 + (\\tan(\\theta) u_{\\theta})^2 $$\n这是 $p_x$ 的相对不确定度平方的符号表达式。不确定度 $u_p$ 则是 $p_x$ 乘以该总和的平方根。在此公式中，角度的不确定度 $u_{\\theta}$ 必须以弧度表示。\n\n### 数值计算\n我们已知：\n- $s = 10.000$ 毫米\n- $u_s = 0.050$ 毫米\n- $\\Delta n_x = 19.86$\n- $u_n = 0.20$\n- $\\theta = 0.50^{\\circ}$\n- $u_{\\theta} = 0.10^{\\circ}$\n\n首先，将角度不确定度转换为弧度：\n$$ u_{\\theta, \\text{rad}} = 0.10^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} \\approx 0.0017453 \\text{ rad} $$\n现在，我们计算相对不确定度总和的各个项：\n1.  来自 $s$ 的贡献：\n    $$ \\left(\\frac{u_s}{s}\\right)^2 = \\left(\\frac{0.050}{10.000}\\right)^2 = (0.005)^2 = 2.5 \\times 10^{-5} $$\n2.  来自 $\\Delta n_x$ 的贡献：\n    $$ \\left(\\frac{u_n}{\\Delta n_x}\\right)^2 = \\left(\\frac{0.20}{19.86}\\right)^2 \\approx (0.0100705)^2 \\approx 1.01419 \\times 10^{-4} $$\n3.  来自 $\\theta$ 的贡献：\n    $$ (\\tan(\\theta) u_{\\theta, \\text{rad}})^2 = (\\tan(0.50^{\\circ}) \\times 0.0017453)^2 \\approx (0.00872686 \\times 0.0017453)^2 \\approx (1.5228 \\times 10^{-5})^2 \\approx 2.319 \\times 10^{-10} $$\n总的相对不确定度平方是这些分量的总和：\n$$ \\left(\\frac{u_p}{p_x}\\right)^2 \\approx 2.5 \\times 10^{-5} + 1.01419 \\times 10^{-4} + 2.319 \\times 10^{-10} \\approx 1.26419 \\times 10^{-4} $$\n接下来，我们计算像素大小 $p_x$ 的值：\n$$ p_x = \\frac{10.000}{\\cos(0.50^{\\circ}) \\times 19.86} \\approx \\frac{10.000}{0.9999619 \\times 19.86} \\approx 0.503543 \\text{ 毫米} $$\n那么标准不确定度 $u_p$ 是：\n$$ u_p = p_x \\sqrt{\\left(\\frac{u_p}{p_x}\\right)^2} \\approx 0.503543 \\text{ 毫米} \\times \\sqrt{1.26419 \\times 10^{-4}} \\approx 0.503543 \\times 0.0112436 \\approx 0.0056618 \\text{ 毫米} $$\n问题要求结果以微米（$\\mu$m）表示。\n$$ u_p \\approx 0.0056618 \\text{ 毫米} \\times \\frac{1000 \\text{ } \\mu\\text{m}}{1 \\text{ 毫米}} \\approx 5.6618 \\text{ } \\mu\\text{m} $$\n四舍五入到三位有效数字，我们得到：\n$$ u_p = 5.66 \\text{ } \\mu\\text{m} $$", "answer": "$$\\boxed{5.66}$$", "id": "4893212"}]}