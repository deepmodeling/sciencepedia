## 引言
单光子发射[计算机断层扫描](@entry_id:747638)（SPECT）是核医学中的核心成像技术，其通过测绘体内放射性示踪剂的分布，为疾病诊断和治疗评估提供关键的功能信息。然而，要从探测到的单个光子中重建出高质量、高精度的三维图像，其第一步——[数据采集](@entry_id:273490)——至关重要。这一过程面临着诸多挑战，包括物理效应（如衰减和散射）导致的信号退化、硬件限制（如准直器特性）引发的分辨率与灵敏度之间的矛盾，以及患者生理运动带来的伪影。如何设计并执行一套最优的数据采集策略，以克服这些挑战并满足特定的临床需求，是决定SPECT成像成败的关键。

本文将系统地引导读者深入理解SPECT数据采集的科学与艺术。在“原理与机制”一章中，我们将剖析从光子发射到探测的完整信号链，阐明准直器、采集轨道和数据模式等核心概念。接下来，在“应用与跨学科联系”一章中，我们将探讨这些原理如何在多样的临床场景中应用，从质量控制到针对特定疾病（如心脏病）和患者（如肥胖患者）的方案设计，再到与CT融合带来的新机遇与挑战。最后，“动手实践”部分将提供具体的计算问题，以巩固您对关键理论的理解。通过本次学习，您将掌握优化SPECT采集方案、提升最终[图像质量](@entry_id:176544)的理论基础和实践智慧。

## 原理与机制

本章旨在深入阐述单光子发射[计算机断层扫描](@entry_id:747638)（SPECT）数据采集背后的核心原理与关键机制。我们将从单个光子事件的产生与探测出发，系统地剖析影响图像质量与定量准确性的各种物理因素、[硬件设计](@entry_id:170759)以及采集策略。本章的目标是为后续章节中关于[图像重建](@entry_id:166790)和临床应用等高级主题的学习奠定坚实的理论基础。

### SPECT信号：从光子发射到探测

SPECT成像的根本任务是测绘注入体内的放射性示踪剂的三维[空间分布](@entry_id:188271)。与[正电子发射断层扫描](@entry_id:165099)（PET）依赖于正负电子湮灭产生的一对背向光子的符合探测不同，SPECT系统探测的是由放射性核素直接发射的单个伽马光子。这一根本差异决定了两种成像模式在[硬件设计](@entry_id:170759)和数据处理上的诸多不同。

由于单个光子不携带其发射方向的固有信息，SPECT系统必须依赖一种称为**准直器（collimator）**的物理设备来强制进行角度选择。准直器通常由高原子序数材料（如铅）制成，其内部包含大量精确排列的孔道或隔板（septa）。只有那些传播方向与孔道轴线近似平行的光子才能穿过准直器并到达探测器，而被斜向入射的光子则会被隔板吸收。通过这种方式，准直器为每个探测器单元定义了一个特定的[视场](@entry_id:175690)，从而将空间信息编码到探测到的信号中。[@problem_id:4927032]

一个探测器单元在给定时间内记录的预期光子计数率（即系统的**灵敏度**）取决于一系列物理过程。我们可以建立一个简化模型来量化这些因素。考虑一个活度为 $A$（单位：贝克勒尔，Bq，即衰变/秒）的点源，位于深度为 $L$ 的均匀组织内。其预期计数率 $C$ 可以表示为：

$C = A \cdot p \cdot \exp(-\mu L) \cdot \eta_{g} \cdot \eta_{d}$

让我们逐一解析这个公式中的每个因子[@problem_id:4926974]：
*   **活度 $A$**：源的放射性活度，代表每秒的[核衰变](@entry_id:140740)次数。
*   **光子产额 $p$**：每次衰变产生可探测伽马光子的概率，也称为分支比。
*   **衰减因子 $\exp(-\mu L)$**：描述光子穿过组织的存活概率，遵循[比尔-朗伯定律](@entry_id:192870)（Beer-Lambert law）。其中 $\mu$ 是组织的线性衰减系数，它取决于光子能量和组织介质。光子在组织内的穿行路径越长（即深度 $L$ 越大），被吸收或散射的概率就越高，到达探测器的光子就越少。
*   **几何效率 $\eta_{g}$**：指在没有衰减的情况下，从源发射的光子中能够穿过准直器并到达探测器[晶体表面](@entry_id:195760)的光子所占的比例。这个效率主要由准直器的几何结构（孔的尺寸、长度等）决定，通常是一个非常小的值（例如，$10^{-4}$ 级别），是导致SPECT灵敏度相对较低的主要原因。
*   **本征效率 $\eta_{d}$**：指到达探测器[晶体表面](@entry_id:195760)的光子中，能够被晶体成功探测并记录为一个有效事件的概率。它主要取决于探测器晶体材料（如NaI(Tl)）的厚度和光子能量。

例如，假设某SPECT系统探测一个活度为 $A = 20\,\text{MBq}$ 的点源，其光子产额 $p = 0.89$。点源位于深度 $L = 8\,\text{cm}$ 的组织中，该组织的线性衰减系数为 $\mu = 0.15\,\text{cm}^{-1}$。若准直器的几何效率 $\eta_{g} = 3.0 \times 10^{-4}$，探测器的本征效率 $\eta_{d} = 0.85$，则预期的计数率约为 $C \approx (20 \times 10^6) \cdot 0.89 \cdot \exp(-0.15 \times 8) \cdot (3.0 \times 10^{-4}) \cdot 0.85 \approx 1.37 \times 10^{3}\,\text{counts/s}$。这个计算过程清晰地展示了从光子产生到最终被记录的整个信号链中的各个环节是如何共同决定系统灵敏度的。[@problem_id:4926974]

### 准直：分辨率与灵敏度的权衡

如前所述，准直器是SPECT成像的基石，它通过限制光子的[入射角](@entry_id:192705)度来形成投影。准直器的设计直接决定了系统的两个核心性能指标：**空间分辨率（spatial resolution）**和**灵敏度（sensitivity）**，而这两者之间存在着一种固有的、不可避免的权衡。

让我们以最常见的**平行孔准直器**为例，来深入理解这一权衡。平行孔准直器由一系列相互平行的直孔构成。我们可以从几何光学的角度分析单个孔的性能。假设一个孔的直径为 $d$，长度为 $l$。一个光子要穿过这个孔，其入射方向与孔轴线的夹角 $\theta$ 必须足够小。其最大可接受半角 $\theta_{\max}$ 可由下式近似给出：

$\theta_{\max} \approx \arctan\left(\frac{d}{2l}\right)$

对于典型的准直器设计（$l \gg d$），这个角度非常小，因此只有近乎平行的光子束才能被探测到，从而形成平行束投影。[@problem_id:4927032]

基于这个几何模型，我们可以推导出分辨率和灵敏度的近似[标度关系](@entry_id:273705)[@problem_id:4926976]：
*   **几何分辨率 ($R_g$)**：准直器引入的模糊程度，通常定义为一个[点源](@entry_id:196698)在探测器上成像的模糊斑的尺寸。对于距离准直器表面为 $b$ 的[点源](@entry_id:196698)，其几何分辨率（例如，模糊斑的半高全宽 FWHM）近似为：
    $R_g \approx d \left(1 + \frac{b}{l}\right)$
    这个公式揭示了两个重要特性：首先，分辨率随着[孔径](@entry_id:172936) $d$ 的增大而变差（模糊更严重）；其次，分辨率随着源到准直器距离 $b$ 的增加而线性下降。这解释了为什么在SPECT采集中让探测器尽可能贴近患者至关重要。

*   **灵敏度 ($S$)**：系统的计数效率。对于平行孔准直器，其灵敏度主要由孔的几何形状决定，近似标度关系为：
    $S \propto \frac{d^2}{l^2}$
    这个关系表明，灵敏度与孔径 $d$ 的平方成正比，与孔长度 $l$ 的平方成反比。

将这两个关系放在一起，**分辨率-灵敏度权衡**就变得一目了然：
*   若要**提高分辨率**（减小 $R_g$），可以减小孔径 $d$ 或增加孔长 $l$。然而，这两种做法都会导致灵敏度 $S$ 的急剧下降（分别按 $d^2$ 和 $l^2$ 关系）。
*   若要**提高灵敏度**（增加 $S$），可以增加[孔径](@entry_id:172936) $d$ 或减小孔长 $l$。但这两种做法都会使分辨率 $R_g$ 变差。

这种权衡在临床实践中至关重要，尤其是在低计数研究中。例如，为追求高分辨率而选择一个低灵敏度的准直器，可能会因为采集到的光子数过少，导致图像[信噪比](@entry_id:271196)极低，最终图像无法用于诊断。因此，准直器的选择必须根据具体的临床任务（例如，需要高分辨率的骨显像 vs. 需要高灵敏度的动态肾图）来优化。[@problem_id:4926976]

除了平行孔准直器，还有**扇束（fan-beam）**和**锥束（cone-beam）**等聚焦型准直器，它们的孔道朝向一个焦点或焦线汇聚。这些设计可以通过放大投影来提高特定区域（如头部或心脏）的灵敏度和分辨率，但代价是视野（Field of View, FOV）变小。它们形成的投影数据也需要采用与之匹配的扇束或锥束重建算法。[@problem_id:4927032]

### [断层扫描](@entry_id:756051)采集：对放射性示踪剂分布的采样

SPECT的目标是从一系列二维投影中重建出三维的放射性分布。这个过程要求我们从足够多的不同角度来“观察”目标物体。

**角度采样**是指探测器围绕患者旋转时，采集投影的角度位置。根据**[傅里叶切片定理](@entry_id:192235)（Fourier Slice Theorem）**，一个特定角度的投影数据的一维傅里叶变换，对应于被测物体[二维傅里叶变换](@entry_id:273583)空间中穿过原点的一个切片（slice）。为了无失真地重建图像，我们必须在傅里叶空间中进行充分的采样。这意味着角度采样的密度必须足以避免在角度方向上产生混叠（aliasing）伪影。

对于平行束采集，一个重要的特性是，在 $\theta$ 角度采集的投影与在 $\theta + 180^{\circ}$ 采集的投影是冗余的（仅仅是沿探测器坐标翻转）。因此，仅需在 $180^{\circ}$ 范围内采集数据即可。[@problem_id:4927000]

那么，需要采集多少个投影视图（views）呢？一个广泛使用的采样准则指出，为了重建一个直径为 $N$ 个像素的物体，所需的最小视图数 $M$ 应满足：

$M \ge \frac{\pi N}{2}$

这个公式直观地说明了角度采样的要求：物体在空间上越精细（即 $N$ 越大，或者说像素尺寸越小），就需要越密集的角度采样（即越多的视图 $M$）来捕捉其高频细节。例如，对于一个 $128 \times 128$ 像素的图像矩阵，理论上至少需要 $M \ge \frac{\pi \times 128}{2} \approx 201.06$ 个视图，即最少需要202个视图，才能避免角度采样不足导致的条纹状伪影。[@problem_id:4927000]

### 优化采集轨道

我们已经知道，几何分辨率会随着源与准直器之间的距离增大而降低。因此，在整个采集过程中，始终保持探测器与患者表面之间的距离最小化，是提高最终[图像分辨率](@entry_id:165161)的有效策略。

标准的采集轨道是**[圆形轨道](@entry_id:178728)**，即探测器在一个固定的半径上围绕旋转中心运动。然而，由于人体横断面通常呈椭圆形或不规则形状，[圆形轨道](@entry_id:178728)会在某些角度（例如，人体的侧面）造成探测器与患者之间存在较大的空隙。

为了解决这个问题，更先进的采集策略被开发出来[@problem_id:4926984]：
*   **[椭圆轨道](@entry_id:160366)**：探测器遵循一个固定的椭圆路径，该椭圆路径能更好地拟合患者的平均轮廓。相比圆形轨道，这能减小平均的探测器-患者距离。
*   **体廓形（body-contoured）轨道**：这是一种更高级的策略，探测器在每个采集角度都会主动调整其半径，以保持与患者皮肤表面一个极小且恒定的安全间隙。

通过最小化平均探测器-患者距离 $\langle z \rangle$，体廓形轨道能够显著改善整个采集过程的平均空间分辨率。例如，在一项模拟研究中，对于一个椭圆形人体模型，圆形、椭圆和体廓形轨道的平均间隙距离可能分别为 $8.75\,\text{cm}$、$4.75\,\text{cm}$ 和 $3.00\,\text{cm}$。由于分辨率与距离相关，采用体廓形轨道相比[圆形轨道](@entry_id:178728)可以获得显著的分辨率提升。[@problem_id:4926984]

### 数据采集模式与动态过程

探测器记录下的光子事件信息可以以两种主要方式进行存储：**[直方图](@entry_id:178776)模式（histogram mode）**和**列表模式（list-mode）**。

**[直方图](@entry_id:178776)模式**，也称为帧模式（frame mode），是传统且最常见的采集方式。在这种模式下，光子事件在采集过程中被实时地累积到预先定义好的存储单元（bins）中。这些存储单元通常是根据探测器位置、投影角度和能量窗口来划分的。最终得到的数据是一系列投影图像（每个角度一张），信息（如每个光子的精确到达时间和能量）在累积过程中丢失了。

**列表模式**则是一种更为灵活和强大的采集方式。在这种模式下，系统为每一个被探测到的有效光子事件记录一个包含多个信息的数据包，通常包括：事件的精确到达时间 $t_i$、探测器上的位置坐标 $\mathbf{x}_i$ 以及测得的[光子能量](@entry_id:139314) $E_i$。整个采集过程最终生成一个长长的事件列表 $(t_i, \mathbf{x}_i, E_i)$。[@problem_id:4926956]

列表模式的核心优势在于其**回顾性处理（retrospective processing）**的能力。由于每个事件的完整信息都被保留，研究人员可以在数据采集完成后，根据需要对数据进行任意的筛选和重组。这为许多高级应用打开了大门：
*   **生理门控（Physiological Gating）**：通过同步记录患者的[心电图](@entry_id:153078)（ECG）或呼吸信号，可以在后处理中只挑选出心动周期或呼吸周期的特定相位（例如，心脏舒张末期）的事件来重建图像，从而“冻结”生理运动，获得更清晰的图像。
*   **动态成像（Dynamic Studies）**：可以回顾性地将采集数据划分为任意长度和数量的时间帧，以研究示踪剂在体内的动态摄取和清除过程，获得药代动力学参数。
*   **运动校正（Motion Correction）**：如果同时有运动追踪数据，可以根据患者在每个时间点的具体位置，对事件进行重新定位，从而校正运动伪影。

从理论上讲，这种回顾性处理的有效性基于泊松过程的**稀疏化（thinning）**特性。对列表模式数据应用一个回顾性门控（filter），在理想条件下（如不考虑死时间变化），其统计结果与在采集时就使用同样门控（prospective gating）所获得的结果是等价的。列表模式通过保存最原始的信息，为数据分析提供了最大的灵活性。[@problem_id:4926956]

### 物理缺陷与患者因素的考量

理想的SPECT采集模型是一个有用的理论起点，但在实际应用中，我们必须面对并校正各种物理不完美性和患者相关因素，以获得定性和定量准确的图像。现代采集策略的设计与这些校正方法紧密相连。

#### 探测器死时间

探测器系统在探测到一个光子事件后，需要一小段固定的时间来处理该事件（例如，光闪烁、信号放大、能量甄别等），在这段时间内它无法响应新的入射光子。这段时间被称为**[死时间](@entry_id:273487)（dead time）** $\tau$。在高计数率的情况下，[死时间](@entry_id:273487)会导致相当一部分真实事件的丢失，从而使得测量到的计数率低于真实计数率。

主要有两种理想化的[死时间](@entry_id:273487)模型[@problem_id:4926959]：
1.  **非瘫痪型（Non-paralyzable）模型**：在一个被记录事件后的[死时间](@entry_id:273487) $\tau$ 内到达的任何事件都会被忽略，且不会延长死时间。在这种模型下，测量计数率 $m$ 与真实计数率 $n$ 的关系为：
    $m = \frac{n}{1 + n\tau}$
    随着真实计数率 $n$ 的增加，$m$ 会逐渐趋于一个饱和值 $1/\tau$。

2.  **瘫痪型（Paralyzable）模型**：任何到达的事件（无论是否被记录）都会触发一个持续时间为 $\tau$ 的死时间。如果在一个[死时间](@entry_id:273487)段内有新的事件到达，[死时间](@entry_id:273487)会从那个新事件的时刻起重新开始计算。这导致了更为复杂的行为，其关系式为：
    $m = n \exp(-n\tau)$
    在这种模型下，当 $n$ 增加时，$m$ 会先达到一个峰值（在 $n = 1/\tau$ 时），然后随着 $n$ 的进一步增加反而下降，甚至趋近于零。这是因为极高的事件[到达率](@entry_id:271803)会使得探测器几乎永久地处于“瘫痪”状态。

在低计数率（$n\tau \ll 1$）的情况下，两种模型的行为近似一致，可用 $m \approx n - n^2\tau$ 来描述。理解并校正[死时间](@entry_id:273487)对于需要精确定量的研究（如药物[剂量学](@entry_id:158757)评估）至关重要。[@problem_id:4926959]

#### 光子衰减

光子在穿行人体组织时，会因光电吸收或康普顿散射而被衰减。如前所述，这是一个距离依赖的过程，是SPECT图像中最主要的物理退化因素之一。如果不进行**衰减校正（attenuation correction）**，重建图像会出现严重的伪影和定量偏差，例如，身体深处的活度会被严重低估。

衰减校正策略主要分为两类[@problem_id:4926957]：
*   **近似的预校正方法**：这类方法在图像重建之前，试图通过对原始投影数据进行修正来补偿衰减。一个常见（但有缺陷）的方法是，为每个投影仓（bin）乘以一个基于CT图像计算出的衰减校正因子，如 $\exp(\int \mu ds)$。然而，这种方法的根本问题在于，一个投影仓中的计数来自于沿该投影线不同深度的放射源的贡献，而每个源点的光子经历的衰减路径都不同。因此，没有任何一个单一的乘法因子能够同时为所有源点做出精确的校正。这种方法本质上是一种近似，并且还会破坏原始数据的泊松噪声特性。

*   **基于模型的校正方法**：这是目前公认的最准确的方法，它在**迭代重建（iterative reconstruction）**算法（如MLEM或OSEM）中实现。该方法不是去“修正”原始数据，而是在重建算法的正向投影模型中，精确地模拟衰减过程。即在计算每个图像体素（voxel）对每个探测器仓的贡献时，就乘以相应的衰减因子 $\exp(-\int \mu ds)$。这样，重建算法就能够在“知晓”衰减存在的情况下，求解出最符合实际测量数据的真实放射性分布。这种方法在物理上和统计上都更为严谨。

#### 患者运动

SPECT采集通常需要数分钟到数十分钟，在此期间患者的自主或不自主运动（如呼吸、身体移动等）是一个常见的问题。患者运动会导致不同角度采集的投影之间出现不一致性，即投影数据不再满足单一静态物体投影的约束条件。

我们可以将刚体运动建模为与角度相关的物体平移 $\Delta \mathbf{r}(\theta)$。根据[Radon变换](@entry_id:754021)的性质，物体空间中的平移 $\Delta \mathbf{r}(\theta)$ 会导致投影空间（即[弦图](@entry_id:275709)，sinogram）中对应角度的投影轮廓沿着探测器[坐标轴平移](@entry_id:168475)一个量 $\Delta s(\theta) = \Delta \mathbf{r}(\theta) \cdot \mathbf{n}(\theta)$，其中 $\mathbf{n}(\theta)$ 是投影方向的[法向量](@entry_id:264185)。[@problem_id:4926961]

当重建算法（如滤波[反投影](@entry_id:746638) FBP）处理这些相互错位的投影数据时，就会产生伪影。如果运动是随机的、零均值的，其累积效应通常表现为最终重建图像的**模糊（blurring）**。例如，对于在各个方向上具有相同方差 $\sigma^2$ 的随机平移，其最终效果等同于将真实图像与一个协方差为 $\sigma^2 \mathbf{I}$ 的各项同性高斯核进行卷积，从而导致[图像分辨率](@entry_id:165161)下降。[@problem_id:4926961]

#### [系统矩阵](@entry_id:172230)：一个统一的物理模型

在本章的最后，我们将所有这些物理机制和效应整合到一个统一的数学框架中，即**系统矩阵（system matrix）** $\mathbf{A}$。在现代迭代重建算法中，SPECT成像过程被建模为一个[线性系统](@entry_id:163135)：

$\boldsymbol{\lambda} = \mathbf{A}\mathbf{x}$

其中：
*   $\mathbf{x}$ 是一个向量，表示待求的图像体素活度分布。
*   $\boldsymbol{\lambda}$ 是一个向量，表示所有探测器仓中的预期光子计数值。
*   $\mathbf{A}$ 就是系统矩阵，它的每一个元素 $a_{ij}$ 代表了从图像中第 $j$ 个体素发射的光子，最终被第 $i$ 个探测器仓探测到的概率。

[系统矩阵](@entry_id:172230)的强大之处在于，它可以将我们在本章中讨论的几乎所有关键物理机制都精确地包含在内。一个精确的系统矩阵元素 $a_{ij}$ 会模拟[@problem_id:4927015] [@problem_id:4926957]：
1.  **几何投影**：体素 $j$ 到探测器仓 $i$ 的基本投影路径。
2.  **准直器-探测器响应**：考虑准直器几何、光子穿透和探测器本征分辨率等因素造成的距离依赖性模糊（即深度相关的点扩展函数 $h(\boldsymbol{\rho}; z)$）。
3.  **光子衰减**：沿体素 $j$ 到探测器仓 $i$ 路径的衰减因子 $\exp(-\int \mu ds)$。
4.  （在更复杂的模型中）**散射响应**：从体素 $j$ 发射后经散射进入探测器仓 $i$ 的概率。

通过构建这样一个全面的物理模型，迭代重建算法能够更准确地从受各种物理因素退化的测量数据中，反演出真实的示踪剂分布。因此，理解数据采集的原理与机制，其最终目的不仅在于优化采集过程本身，更在于为构建精确的系统模型、实现高质量的图像重建提供坚实的基础。