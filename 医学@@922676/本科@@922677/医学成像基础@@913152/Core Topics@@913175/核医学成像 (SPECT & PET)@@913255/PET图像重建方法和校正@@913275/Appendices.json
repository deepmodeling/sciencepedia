{"hands_on_practices": [{"introduction": "在我们深入研究如何从PET数据重建图像之前，首先理解这些数据是如何产生的至关重要。这个练习将带你完成“正向问题”的建模过程，即如何从一个已知的放射性分布（一个均匀的圆柱体模型）预测PET扫描仪测得的正弦图数据。通过这个实践，你将亲手推导正弦图信号如何依赖于物体的几何形状和各种物理效应，例如真实的符合事件、散射和随机符合。[@problem_id:4907970]", "problem": "一个直径为 $D$、活度浓度为 $x_{0}$ 的均匀圆柱体模体通过正电子发射断层扫描（PET）进行成像。考虑在穿过圆柱体中心的单个轴向切片上进行二维平行束采集。设正弦图坐标为 $(p,\\varphi)$，其中 $p$ 是从原点到响应线的带符号垂直距离，$\\varphi$ 是视角。假设期望正弦图具有以下物理上合理的前向模型：\n- 沿偏移量为 $p$ 的射线的期望真符合计数与沿该射线的活度浓度的线积分成正比，其有效常数为 $\\gamma$，该常数集总了采集时间、几何灵敏度和探测效率，因此真符合项为 $\\gamma \\int x(\\boldsymbol{r})\\,\\mathrm{d}\\ell$。\n- 随机符合 $r$ 和散射符合 $s$ 的贡献在 $(p,\\varphi)$ 上是均匀的，并线性地加到每个正弦图仓元的期望值上。\n- 模体以原点为中心，半径为 $R = D/2$，且当 $|\\boldsymbol{r}| \\le R$ 时 $x(\\boldsymbol{r}) = x_{0}$，否则 $x(\\boldsymbol{r}) = 0$。\n- 您可以假设均匀圆柱体具有旋转不变性，因此期望计数仅依赖于 $p$。\n\n从发射断层扫描的基本前向模型和平面几何出发，推导对于满足 $|p| \\le R$ 的偏移量，其期望正弦图值 $\\bar{y}(p)$，并明确指出其与射线和圆柱体相交的弦长之间的依赖关系。然后，对于以下特定值\n- $D = 24\\,\\text{cm}$,\n- $x_{0} = 4.0 \\times 10^{3}\\,\\text{Bq}\\cdot\\text{cm}^{-3}$,\n- $\\gamma = 7.5 \\times 10^{-2}\\,\\text{counts}\\cdot\\text{Bq}^{-1}\\cdot\\text{cm}^2$,\n- $r = 120\\,\\text{counts}$,\n- $s = 80\\,\\text{counts}$,\n提供当 $|p| \\le R$ 时，$\\bar{y}(p)$ 作为 $p$ 的函数的闭式表达式。\n\n以计数为单位表示您的最终表达式。无需四舍五入。", "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n- 模体：直径为 $D$ 的均匀圆柱体。\n- 活度浓度：$x_0$。\n- 正弦图坐标：$(p, \\varphi)$，其中 $p$ 是从原点到响应线（LOR）的带符号垂直距离，$\\varphi$ 是视角。\n- 期望真符合计数：与活度线积分成正比，由 $\\gamma \\int x(\\boldsymbol{r})\\,\\mathrm{d}\\ell$ 给出。\n- 比例常数：$\\gamma$。\n- 随机符合贡献：$r$，在 $(p,\\varphi)$ 上均匀分布。\n- 散射符合贡献：$s$，在 $(p,\\varphi)$ 上均匀分布。\n- 加性模型：真符合、随机符合和散射符合线性相加。\n- 模体几何：以原点为中心，半径 $R = D/2$。\n- 活度分布：当 $|\\boldsymbol{r}| \\le R$ 时 $x(\\boldsymbol{r}) = x_0$，否则 $x(\\boldsymbol{r}) = 0$。\n- 假设旋转不变性，因此期望计数仅依赖于 $p$。\n- 特定值：\n  - $D = 24\\,\\text{cm}$\n  - $x_0 = 4.0 \\times 10^3\\,\\text{Bq}\\cdot\\text{cm}^{-3}$\n  - $\\gamma = 7.5 \\times 10^{-2}\\,\\text{counts}\\cdot\\text{Bq}^{-1}\\cdot\\text{cm}^2$\n  - $r = 120\\,\\text{counts}$\n  - $s = 80\\,\\text{counts}$\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行评估。\n\n- **科学基础（关键）**：该问题坚实地建立在正电子发射断层扫描（PET）的基本原理之上。其前向模型将期望正弦图数据描述为真符合（通过活度分布的Radon变换建模）、散射符合和随机符合的总和，这是发射断层扫描中一个标准且被广泛接受的模型。均匀圆柱体模体的几何形状是PET扫描仪中用于质量控制和校准的标准对象。该问题的所有方面在科学上都是合理的。\n- **适定性**：该问题是适定的。它提供了一套完整的参数和一个清晰的物理模型。任务是基于这些输入推导出一个特定的函数 $\\bar{y}(p)$。所提供的信息是充分和一致的，确保了唯一解的存在。\n- **客观性（关键）**：该问题使用标准的数学和物理术语以精确、客观的语言陈述。没有主观或模棱两可的陈述。\n\n该问题没有表现出验证清单中列出的任何缺陷（例如，科学上不合理、不完整、不切实际等）。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n## 解答\n\n该问题要求推导均匀圆柱体模体的期望正弦图值 $\\bar{y}(p)$。\n\n一个正弦图仓元 $(p, \\varphi)$ 中期望计数的前向模型由真符合、随机符合和散射符合的总和给出。\n$$\n\\bar{y}(p, \\varphi) = \\bar{t}(p, \\varphi) + r + s\n$$\n其中 $\\bar{t}(p, \\varphi)$ 是期望真符合计数，$r$ 和 $s$ 分别是随机符合和散射符合的贡献。问题陈述说明 $r$ 和 $s$ 是均匀常数。\n\n真符合项 $\\bar{t}(p, \\varphi)$ 被建模为活度分布 $x(\\boldsymbol{r})$ 的Radon变换，并按比例因子 $\\gamma$ 进行缩放。\n$$\n\\bar{t}(p, \\varphi) = \\gamma \\int_{\\text{LOR}(p, \\varphi)} x(\\boldsymbol{r})\\,\\mathrm{d}\\ell\n$$\n积分是沿着由坐标 $(p, \\varphi)$ 定义的响应线（LOR）进行的。\n\n该模体是一个以原点为中心、半径为 $R$ 的均匀圆柱体，其内部活度浓度为常数 $x_0$，外部为零。\n$$\nx(\\boldsymbol{r}) =\n\\begin{cases}\nx_0  \\text{if } |\\boldsymbol{r}| \\le R \\\\\n0  \\text{if } |\\boldsymbol{r}| > R\n\\end{cases}\n$$\n由于活度分布 $x(\\boldsymbol{r})$ 是径向对称的，其Radon变换也是径向对称的，这意味着它仅依赖于距原点的距离 $p$，而不依赖于角度 $\\varphi$。因此，我们可以写作 $\\bar{t}(p, \\varphi) = \\bar{t}(p)$ 和 $\\bar{y}(p, \\varphi) = \\bar{y}(p)$。\n\n对于给定的 $p$，真符合的积分变为：\n$$\n\\bar{t}(p) = \\gamma \\int_{\\text{LOR}(p)} x_0 \\,\\mathrm{d}\\ell\n$$\n由于 $x_0$ 是一个常数，可以将其移到积分符号外。\n$$\n\\bar{t}(p) = \\gamma x_0 \\int_{\\text{LOR}(p) \\cap \\text{Cylinder}} \\mathrm{d}\\ell\n$$\n积分 $\\int_{\\text{LOR}(p) \\cap \\text{Cylinder}} \\mathrm{d}\\ell$ 就是偏移量为 $p$ 的响应线与圆柱体模体相交所形成的弦的长度 $L(p)$。因此，真符合计数明确地依赖于这个弦长：\n$$\n\\bar{t}(p) = \\gamma x_0 L(p)\n$$\n我们需要找到当 $|p| \\le R$ 时 $L(p)$ 的表达式。考虑圆柱体的横截面，它是一个以原点为中心、半径为 $R$ 的圆，其方程为 $u^2 + v^2 = R^2$。由于旋转对称性，我们可以调整坐标系，使响应线是一条垂直线 $u=p$。这条线与圆的交点坐标为 $(p, v)$，其中 $p^2 + v^2 = R^2$。求解 $v$ 可得 $v = \\pm\\sqrt{R^2 - p^2}$。两个交点分别是 $(p, -\\sqrt{R^2-p^2})$ 和 $(p, \\sqrt{R^2-p^2})$。这两点之间的距离，即弦长 $L(p)$，为：\n$$\nL(p) = \\sqrt{(p-p)^2 + (\\sqrt{R^2-p^2} - (-\\sqrt{R^2-p^2}))^2} = \\sqrt{0 + (2\\sqrt{R^2-p^2})^2} = 2\\sqrt{R^2-p^2}\n$$\n此表达式在 $|p| \\le R$ 时有效。对于 $|p| > R$，响应线不与模体相交，$L(p)=0$。\n\n将 $L(p)$ 的表达式代回到 $\\bar{t}(p)$ 的方程中：\n$$\n\\bar{t}(p) = 2 \\gamma x_0 \\sqrt{R^2 - p^2}\n$$\n那么，总的期望正弦图值 $\\bar{y}(p)$ 为：\n$$\n\\bar{y}(p) = \\bar{t}(p) + r + s = 2 \\gamma x_0 \\sqrt{R^2 - p^2} + r + s\n$$\n这就是当 $|p| \\le R$ 时期望正弦图的通用闭式表达式。\n\n现在，我们代入给定的数值：\n- $D = 24\\,\\text{cm}$，这意味着半径为 $R = D/2 = 12\\,\\text{cm}$。\n- $x_0 = 4.0 \\times 10^3\\,\\text{Bq}\\cdot\\text{cm}^{-3}$。\n- $\\gamma = 7.5 \\times 10^{-2}\\,\\text{counts}\\cdot\\text{Bq}^{-1}\\cdot\\text{cm}^2$。\n- $r = 120\\,\\text{counts}$。\n- $s = 80\\,\\text{counts}$。\n\n首先，我们计算真符合项的系数 $2 \\gamma x_0$：\n$$\n2 \\gamma x_0 = 2 \\times (7.5 \\times 10^{-2}\\,\\text{counts}\\cdot\\text{Bq}^{-1}\\cdot\\text{cm}^2) \\times (4.0 \\times 10^3\\,\\text{Bq}\\cdot\\text{cm}^{-3})\n$$\n$$\n2 \\gamma x_0 = (15.0 \\times 10^{-2}) \\times (4.0 \\times 10^3) \\,\\text{counts}\\cdot\\text{cm}^{-1} = 60.0 \\times 10^1 \\,\\text{counts}\\cdot\\text{cm}^{-1} = 600 \\,\\text{counts}\\cdot\\text{cm}^{-1}\n$$\n项 $\\sqrt{R^2 - p^2}$ 的单位是 cm，因此真符合计数项 $2 \\gamma x_0 \\sqrt{R^2 - p^2}$ 的单位是计数，这是一致的。\n\n接下来，我们计算恒定背景项的总和：\n$$\nr + s = 120\\,\\text{counts} + 80\\,\\text{counts} = 200\\,\\text{counts}\n$$\n\n最后，我们使用数值（其中 $R=12\\,\\text{cm}$）来组装 $\\bar{y}(p)$ 的完整表达式：\n$$\n\\bar{y}(p) = 600 \\sqrt{(12)^2 - p^2} + 200\n$$\n$$\n\\bar{y}(p) = 600 \\sqrt{144 - p^2} + 200\n$$\n这是期望正弦图值的最终闭式表达式，以计数为单位，是偏移量 $p$（单位为 cm）的函数，在 $|p| \\le 12$ 时有效。", "answer": "$$\n\\boxed{600 \\sqrt{144 - p^2} + 200}\n$$", "id": "4907970"}, {"introduction": "理解了正向模型后，我们现在来解决核心的“逆问题”：如何从测量的正弦图数据中重建出放射性活度图像。最大似然期望最大化（ML-EM）算法是解决这个问题的关键。这个练习将让你通过一个简化的系统，一步步地计算ML-EM算法的一次迭代，从而揭开这个迭代过程的神秘面纱，让你直观地看到初始图像是如何根据测量数据进行更新和优化的。[@problem_id:4907890]", "problem": "在正电子发射断层扫描（PET）中，假设一个离散正向模型，其中测量的弦图计数被建模为独立的泊松随机变量，其均值由未知体素活度的线性变换给出。设测量模型为 $y_{i} \\sim \\text{Poisson}(\\lambda_{i})$，其中 $\\lambda_{i} = \\sum_{j} a_{ij} x_{j} + r_{i} + s_{i}$，$x_{j}$ 是未知体素活度，$a_{ij}$ 是系统矩阵的元素，$r_{i}$ 是随机事件，$s_{i}$ 是散射事件。考虑没有随机事件和散射事件的情况，即对于所有 $i$，$r_{i} = 0$ 且 $s_{i} = 0$。\n\n从该模型下数据的泊松似然和期望最大化（EM）原理出发，推导将 $x^{k}$ 映射到 $x^{k+1}$ 的一次迭代的最大似然期望最大化（ML-EM）不动点更新公式，用 $A$、$y$ 和 $x^{k}$ 表示。然后，应用你推导的表达式，对以下示例系统从初始估计 $x^{0}$ 开始计算一次迭代：\n- 系统矩阵 $A = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix}$。\n- 测量计数 $y = \\begin{bmatrix} 10 \\\\ 6 \\end{bmatrix}$。\n- 随机事件和散射事件 $r = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$ 和 $s = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n- 初始活度估计 $x^{0} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n\n将更新后的活度估计 $x^{1}$ 表示为任意单位下的精确数值（无四舍五入）。以双元素行向量的形式提供最终答案。最终答案中不要包含单位。", "solution": "根据验证标准评估用户提供的问题。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- **模型**：测量的弦图计数 $y_{i}$ 是独立的泊松随机变量，$y_{i} \\sim \\text{Poisson}(\\lambda_{i})$。\n- **泊松分布的均值**：$\\lambda_{i} = \\sum_{j} a_{ij} x_{j} + r_{i} + s_{i}$。\n- **变量**：\n    - $x_{j}$：未知体素活度。\n    - $a_{ij}$：系统矩阵 $A$ 的元素。\n    - $r_{i}$：随机事件。\n    - $s_{i}$：散射事件。\n- **条件**：无随机事件和散射事件，因此对所有 $i$，$r_{i} = 0$ 且 $s_{i} = 0$。模型简化为 $\\lambda_{i} = \\sum_{j} a_{ij} x_{j}$。\n- **任务 1**：推导最大似然期望最大化（ML-EM）的一次迭代不动点更新公式，将估计值 $x^{k}$ 映射到 $x^{k+1}$。\n- **任务 2**：应用推导出的表达式，对一个特定的示例系统计算一次迭代，$x^{1}$。\n- **示例系统数据**：\n    - 系统矩阵：$A = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix}$。\n    - 测量计数：$y = \\begin{bmatrix} 10 \\\\ 6 \\end{bmatrix}$。\n    - 随机事件和散射事件：$r = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$ 和 $s = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n    - 初始活度估计：$x^{0} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n- **输出要求**：$x^{1}$ 为一个包含精确数值的双元素行向量。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在根本上是合理的。PET中光子计数事件的泊松模型是统计图像重建的基石。期望最大化算法是寻找该模型最大似然估计的标准方法。该问题在科学上是正确的，并与医学影像领域相关。\n- **适定性**：该问题是适定的。ML-EM算法的推导是文献中的标准程序，所提供的数值示例是完整的且内部一致的，保证了一次迭代的唯一解。\n- **客观性**：该问题使用精确且无歧义的数学语言陈述。\n- **结论**：没有科学或逻辑上的缺陷，没有缺失的信息，也没有歧义。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将提供完整解答。\n\n### 解答推导与计算\n\n该问题要求推导用于正电子发射断层扫描（PET）的最大似然期望最大化（ML-EM）更新方程，并将其应用于一个示例问题。\n\n**第 1 部分：ML-EM 更新方程的推导**\n\n在没有随机事件和散射事件的情况下，PET 的测量模型由一组独立的泊松随机变量 $y_i$ 给出，其中 $i$ 索引探测器对（响应线，LORs）：\n$$y_i \\sim \\text{Poisson}(\\lambda_i)$$\n平均计数 $\\lambda_i$ 通过系统矩阵 $A$（其元素为 $a_{ij}$）与未知体素活度 $x_j$（其中 $j$ 索引体素）相关联：\n$$\\lambda_i = \\sum_{j=1}^{N} a_{ij} x_j$$\n此处，$N$ 是体素总数，$M$ 是 LORs 的总数。\n\n在给定活度分布 $x = (x_1, ..., x_N)$ 的情况下，观测到测量向量 $y = (y_1, ..., y_M)$ 的似然是各个泊松概率的乘积：\n$$L(x) = P(y|x) = \\prod_{i=1}^{M} \\frac{\\lambda_i^{y_i} \\exp(-\\lambda_i)}{y_i!} = \\prod_{i=1}^{M} \\frac{\\left(\\sum_{j=1}^{N} a_{ij} x_j\\right)^{y_i} \\exp\\left(-\\sum_{j=1}^{N} a_{ij} x_j\\right)}{y_i!}$$\n对数似然函数 $\\mathcal{L}(x) = \\ln(L(x))$ 为：\n$$\\mathcal{L}(x) = \\sum_{i=1}^{M} \\left( y_i \\ln\\left(\\sum_{j=1}^{N} a_{ij} x_j\\right) - \\sum_{j=1}^{N} a_{ij} x_j \\right) - \\sum_{i=1}^{M} \\ln(y_i!)$$\n由于和的对数存在，直接最大化此对数似然函数很困难。EM 算法通过引入“完整”但未观测到的（隐藏）数据来规避这个问题。\n\n设完整数据为 $Z_{ij}$，表示从体素 $j$ 发出并在 LOR $i$ 中检测到的发射次数。这些被建模为独立的泊松变量：\n$$Z_{ij} \\sim \\text{Poisson}(a_{ij} x_j)$$\n观测数据 $y_i$ 是这些隐藏变量在所有体素上的总和：\n$$y_i = \\sum_{j=1}^{N} Z_{ij}$$\n完整数据 $Z = \\{Z_{ij}\\}$ 的对数似然要简单得多：\n$$\\mathcal{L}_C(x; Z) = \\ln(P(Z|x)) = \\sum_{i=1}^{M} \\sum_{j=1}^{N} \\left( Z_{ij} \\ln(a_{ij} x_j) - a_{ij} x_j - \\ln(Z_{ij}!) \\right)$$\n\nEM 算法是一个迭代的两步过程：\n1.  **E-步（期望）：** 计算完整数据对数似然的期望值，条件是观测数据 $y$ 和当前参数估计 $x^k$。设此函数为 $Q(x|x^k)$。\n    $$Q(x|x^k) = E[\\mathcal{L}_C(x; Z) | y, x^k]$$\n    这需要找到隐藏数据的条件期望，$\\hat{Z}_{ij}^k = E[Z_{ij} | y, x^k]$。对于固定的 LOR $i$，给定总计数 $y_i = \\sum_j Z_{ij}$，$\\{Z_{ij}\\}_{j=1,...,N}$ 的条件分布是多项分布。$Z_{ij}$ 的条件期望是：\n    $$\\hat{Z}_{ij}^k = E[Z_{ij} | y_i, x^k] = y_i \\frac{a_{ij} x_j^k}{\\sum_{l=1}^{N} a_{il} x_l^k}$$\n    将此代入 $Q(x|x^k)$ 的表达式中，并舍去与 $x$ 无关的项：\n    $$Q(x|x^k) = \\sum_{i=1}^{M} \\sum_{j=1}^{N} \\left( \\hat{Z}_{ij}^k \\ln(a_{ij} x_j) - a_{ij} x_j \\right) + \\text{const.}$$\n\n2.  **M-步（最大化）：** 找到最大化 $Q(x|x^k)$ 的新估计 $x^{k+1}$。我们可以通过对每个 $x_j$ 求偏导数并将其设为零来实现。\n    $$\\frac{\\partial Q(x|x^k)}{\\partial x_j} = \\sum_{i=1}^{M} \\left( \\frac{\\hat{Z}_{ij}^k}{x_j} - a_{ij} \\right) = 0$$\n    求解 $x_j$ 得到更新后的估计 $x_j^{k+1}$：\n    $$x_j^{k+1} \\sum_{i=1}^{M} a_{ij} = \\sum_{i=1}^{M} \\hat{Z}_{ij}^k$$\n    $$x_j^{k+1} = \\frac{\\sum_{i=1}^{M} \\hat{Z}_{ij}^k}{\\sum_{i=1}^{M} a_{ij}}$$\n    代入 $\\hat{Z}_{ij}^k$ 的表达式：\n    $$x_j^{k+1} = \\frac{\\sum_{i=1}^{M} y_i \\frac{a_{ij} x_j^k}{\\sum_{l=1}^{N} a_{il} x_l^k}}{\\sum_{i=1}^{M} a_{ij}}$$\n    整理各项，得到最终的 ML-EM 更新方程：\n    $$x_j^{k+1} = \\frac{x_j^k}{\\sum_{i=1}^{M} a_{ij}} \\sum_{i=1}^{M} \\frac{a_{ij} y_i}{\\sum_{l=1}^{N} a_{il} x_l^k}$$\n这就是所要求的不动点更新表达式。\n\n**第 2 部分：应用于示例系统**\n\n我们应用推导出的公式进行一次迭代，从 $x^0$ 计算 $x^1$。\n给定数据为：\n- 系统矩阵 $A = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix}$\n- 测量计数 $y = \\begin{bmatrix} 10 \\\\ 6 \\end{bmatrix}$\n- 初始估计 $x^0 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n\n该系统有 $N=2$ 个体素和 $M=2$ 个 LOR。各分量为 $x_1^0 = 1$, $x_2^0 = 1$, $y_1=10$, $y_2=6$，矩阵元素为 $a_{11}=1, a_{12}=1, a_{21}=0, a_{22}=1$。\n\n首先，我们计算更新方程中的分母。\n对于 $i=1, 2$ 的前向投影估计 $\\sum_{l=1}^2 a_{il} x_l^0$：\n- 对于 $i=1$：$\\sum_{l=1}^2 a_{1l} x_l^0 = a_{11} x_1^0 + a_{12} x_2^0 = (1)(1) + (1)(1) = 2$。\n- 对于 $i=2$：$\\sum_{l=1}^2 a_{2l} x_l^0 = a_{21} x_1^0 + a_{22} x_2^0 = (0)(1) + (1)(1) = 1$。\n\n对于 $j=1, 2$ 的灵敏度因子（$A$ 的列和）$\\sum_{i=1}^2 a_{ij}$：\n- 对于 $j=1$：$\\sum_{i=1}^2 a_{i1} = a_{11} + a_{21} = 1 + 0 = 1$。\n- 对于 $j=2$：$\\sum_{i=1}^2 a_{i2} = a_{12} + a_{22} = 1 + 1 = 2$。\n\n现在，我们计算更新后的体素活度 $x_1^1$ 和 $x_2^1$。\n\n对于体素 $j=1$：\n$$x_1^{1} = \\frac{x_1^0}{\\sum_{i=1}^{2} a_{i1}} \\sum_{i=1}^{2} \\frac{a_{i1} y_i}{\\sum_{l=1}^{2} a_{il} x_l^0} = \\frac{1}{1} \\left( \\frac{a_{11} y_1}{\\sum_{l} a_{1l} x_l^0} + \\frac{a_{21} y_2}{\\sum_{l} a_{2l} x_l^0} \\right)$$\n$$x_1^{1} = 1 \\cdot \\left( \\frac{1 \\cdot 10}{2} + \\frac{0 \\cdot 6}{1} \\right) = \\frac{10}{2} + 0 = 5$$\n\n对于体素 $j=2$：\n$$x_2^{1} = \\frac{x_2^0}{\\sum_{i=1}^{2} a_{i2}} \\sum_{i=1}^{2} \\frac{a_{i2} y_i}{\\sum_{l=1}^{2} a_{il} x_l^0} = \\frac{1}{2} \\left( \\frac{a_{12} y_1}{\\sum_{l} a_{1l} x_l^0} + \\frac{a_{22} y_2}{\\sum_{l} a_{2l} x_l^0} \\right)$$\n$$x_2^{1} = \\frac{1}{2} \\left( \\frac{1 \\cdot 10}{2} + \\frac{1 \\cdot 6}{1} \\right) = \\frac{1}{2} \\left( 5 + 6 \\right) = \\frac{11}{2}$$\n\n经过一次迭代后更新的活度估计是 $x^1 = \\begin{bmatrix} 5 \\\\ \\frac{11}{2} \\end{bmatrix}$。问题要求以双元素行向量的形式给出答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5  & \\frac{11}{2}\n\\end{pmatrix}\n}\n$$", "id": "4907890"}, {"introduction": "理想的重建模型在现实世界中会遇到各种挑战，因此精确的校正是获得准确定量PET图像的基石，其中衰减校正尤为关键。本练习探讨了当衰减校正出现偏差时（例如由金属伪影引起）会产生什么后果。通过应用Beer-Lambert定律，你将量化衰减图中的一个局部误差如何通过重建过程传播，并最终导致图像活度值和临床指标（如SUV）产生偏差。[@problem_id:4907936]", "problem": "一台正电子发射断层扫描 (PET) 系统使用从计算机断层扫描 (CT) 导出并缩放到 $511\\,\\text{keV}$ 的线性衰减系数图（通常称为 $\\mu$-图）来进行衰减校正。考虑一个活度浓度均匀的小球形病灶。所有对该病灶重建有贡献的响应线 (LOR) 都穿过 $\\mu$-图中的一个局部金属伪影区域，在该区域，线性衰减系数相对于其真实的 $511\\,\\text{keV}$ 值被高估了。沿着每条这样的 LOR，伪影区域的厚度为 $L_{\\text{art}} = 1.8\\,\\text{cm}$。伪影区域内的真实系数为 $\\mu_{\\text{true}} = 0.18\\,\\text{cm}^{-1}$，而用于该区域衰减校正的 $\\mu$-图值为 $\\mu_{\\text{est}} = 0.28\\,\\text{cm}^{-1}$。在每条 LOR 的其他所有地方，$\\mu$-图等于真实系数。\n\n假设以下理想化条件：\n- 湮没光子输运沿每条 LOR 遵循比尔-朗伯定律。\n- 测量的正弦图值通过根据 $\\mu$-图计算的乘性衰减校正因子进行校正。\n- 归一化校正、刻度校正、散射校正、随机校正和死时间校正是完美的。\n- 重建算法相对于校正后的正弦图是无偏的且局部线性的，因此沿与病灶相交的 LOR 的衰减校正中的任何乘性误差都会以乘性方式传播到重建的病灶活度浓度中。\n- 标准化摄取值 (SUV) 定义为 $\\text{SUV} = c/A_{\\text{norm}}$，其中 $c$ 是重建的活度浓度，$A_{\\text{norm}}$ 是按体重归一化的注射活度。在上述假设下，$A_{\\text{norm}}$ 不受伪影影响。\n\n从比尔-朗伯定律和 PET 重建中衰减校正因子的操作性定义出发，推导一个由伪影区域中被高估的 $\\mu$ 引起的重建病灶活度浓度上的乘性偏倚因子的表达式，并由此确定病灶局部 SUV 的最终分数偏倚，以小数（无量纲）形式表示。使用上面提供的数值。将您的最终答案四舍五入到四位有效数字，并以无单位的小数形式表示。", "solution": "该问题要求计算由于 PET 图像重建中使用的衰减图存在误差而导致的病灶标准化摄取值 (SUV) 的分数偏倚。解题过程从光子衰减和 PET 数据校正的基本原理开始。\n\n让一条 LOR（响应线）穿过患者。根据比尔-朗伯定律，如果沿这条 LOR 发射了 $N_0$ 个光子对，则探测到的光子对数量 $m$（对应于一个正弦图值）会因衰减因子 $A_{\\text{true}}$ 而减少。\n真实衰减因子由真实线性衰减系数 $\\mu_{\\text{true}}(l)$ 沿 LOR 路径 $L$ 的线积分确定：\n$$A_{\\text{true}} = \\exp\\left(-\\int_L \\mu_{\\text{true}}(l) \\, dl\\right)$$\n因此，测量的正弦图值 $m$ 与未衰减信号 $p_0$（其与活度浓度的线积分成正比）的关系如下：\n$$m = p_0 \\cdot A_{\\text{true}} = p_0 \\exp\\left(-\\int_L \\mu_{\\text{true}}(l) \\, dl\\right)$$\n\n在 PET 重建中，测量数据 $m$ 通过乘以一个衰减校正因子 (ACF) 来进行衰减校正。ACF 被计算为衰减因子的倒数，但它是使用从 CT 导出的估计衰减图 $\\mu_{\\text{est}}(l)$ 计算的。\n$$\\text{ACF}_{\\text{est}} = \\frac{1}{\\exp\\left(-\\int_L \\mu_{\\text{est}}(l) \\, dl\\right)} = \\exp\\left(\\int_L \\mu_{\\text{est}}(l) \\, dl\\right)$$\n输入到重建算法的校正后正弦图值 $p_{\\text{est}}$ 是测量数据和估计的 ACF 的乘积：\n$$p_{\\text{est}} = m \\cdot \\text{ACF}_{\\text{est}}$$\n代入 $m$ 和 $\\text{ACF}_{\\text{est}}$ 的表达式：\n$$p_{\\text{est}} = \\left[p_0 \\exp\\left(-\\int_L \\mu_{\\text{true}}(l) \\, dl\\right)\\right] \\cdot \\left[\\exp\\left(\\int_L \\mu_{\\text{est}}(l) \\, dl\\right)\\right]$$\n$$p_{\\text{est}} = p_0 \\exp\\left(\\int_L \\mu_{\\text{est}}(l) \\, dl - \\int_L \\mu_{\\text{true}}(l) \\, dl\\right) = p_0 \\exp\\left(\\int_L \\left[\\mu_{\\text{est}}(l) - \\mu_{\\text{true}}(l)\\right] \\, dl\\right)$$\n\n问题陈述，估计的衰减系数 $\\mu_{\\text{est}}$ 仅在厚度为 $L_{\\text{art}}$ 的特定伪影区域内不正确，而在其他地方都是正确的。因此，差值 $\\mu_{\\text{est}}(l) - \\mu_{\\text{true}}(l)$ 在该区域之外处处为零。积分简化为仅对伪影区域的积分：\n$$\\int_L \\left[\\mu_{\\text{est}}(l) - \\mu_{\\text{true}}(l)\\right] \\, dl = \\int_{\\text{artifact}} (\\mu_{\\text{est}} - \\mu_{\\text{true}}) \\, dl$$\n在该区域内，系数是恒定的。设其值分别为给定的 $\\mu_{\\text{est}}$ 和 $\\mu_{\\text{true}}$。积分变为：\n$$\\int_{\\text{artifact}} (\\mu_{\\text{est}} - \\mu_{\\text{true}}) \\, dl = (\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}$$\n所以，校正后的正弦图数据为：\n$$p_{\\text{est}} = p_0 \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right)$$\n\n理想情况下，如果衰减图是完美的（$\\mu_{\\text{est}}(l) = \\mu_{\\text{true}}(l)$），校正后的数据 $p_{\\text{true}}$ 将是：\n$$p_{\\text{true}} = p_0 \\exp\\left(\\int_L \\left[\\mu_{\\text{true}}(l) - \\mu_{\\text{true}}(l)\\right] \\, dl\\right) = p_0 \\exp(0) = p_0$$\n这证实了完美的校正可以恢复原始的未衰减信号。\n\n校正后正弦图数据上的乘性偏倚因子 $B$ 是估计的校正数据与理想校正数据的比率：\n$$B = \\frac{p_{\\text{est}}}{p_{\\text{true}}} = \\frac{p_0 \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right)}{p_0} = \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right)$$\n\n问题陈述重建算法是线性的，因此正弦图数据上的这种乘性偏倚直接作为乘性偏倚传播到重建的活度浓度 $c$ 上。如果 $c_{\\text{true}}$ 是真实浓度，$c_{\\text{est}}$ 是带伪影重建的浓度，那么：\n$$c_{\\text{est}} = B \\cdot c_{\\text{true}}$$\nSUV 定义为 $\\text{SUV} = c/A_{\\text{norm}}$。由于 $A_{\\text{norm}}$ 不受影响，SUV 也受到相同因子的偏倚影响：\n$$\\text{SUV}_{\\text{est}} = \\frac{c_{\\text{est}}}{A_{\\text{norm}}} = \\frac{B \\cdot c_{\\text{true}}}{A_{\\text{norm}}} = B \\cdot \\text{SUV}_{\\text{true}}$$\n\nSUV 中的分数偏倚 $F$ 定义为相对于真实值的变化：\n$$F = \\frac{\\text{SUV}_{\\text{est}} - \\text{SUV}_{\\text{true}}}{\\text{SUV}_{\\text{true}}} = \\frac{B \\cdot \\text{SUV}_{\\text{true}} - \\text{SUV}_{\\text{true}}}{\\text{SUV}_{\\text{true}}} = B - 1$$\n代入 $B$ 的表达式，分数偏倚为：\n$$F = \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right) - 1$$\n\n现在，我们代入提供的数值：\n$L_{\\text{art}} = 1.8\\,\\text{cm}$\n$\\mu_{\\text{true}} = 0.18\\,\\text{cm}^{-1}$\n$\\mu_{\\text{est}} = 0.28\\,\\text{cm}^{-1}$\n\n衰减系数的差值为：\n$$\\Delta\\mu = \\mu_{\\text{est}} - \\mu_{\\text{true}} = 0.28\\,\\text{cm}^{-1} - 0.18\\,\\text{cm}^{-1} = 0.10\\,\\text{cm}^{-1}$$\n$F$ 表达式中的指数为：\n$$(\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}} = (0.10\\,\\text{cm}^{-1}) \\cdot (1.8\\,\\text{cm}) = 0.18$$\n如预期，该量是无量纲的。\n\n分数偏倚 $F$ 为：\n$$F = \\exp(0.18) - 1$$\n计算其数值：\n$$F \\approx 1.19721736 - 1 = 0.19721736$$\n按要求四舍五入到四位有效数字，我们得到：\n$$F \\approx 0.1972$$\n这个正值表明 SUV 被高估了大约 $19.72\\%$。", "answer": "$$\\boxed{0.1972}$$", "id": "4907936"}]}