{"hands_on_practices": [{"introduction": "能量分辨率的根本来源是什么？本练习将带你追溯到问题的核心：信号产生的统计物理过程。闪烁体探测器将入射伽马光子的能量转化为离散的光学光子，其数量遵循泊松分布，这种固有的统计波动构成了能量分辨率的理论极限。通过本练习 [@problem_id:4883258]，你将学会如何从第一性原理出发，计算不同闪烁体材料（如$\\text{NaI(Tl)}$、$\\text{LYSO}$和$\\text{LaBr}_3$）的“光子统计极限”分辨率，并理解为何材料的光产额和衰减时间是决定探测器性能的关键因素。", "problem": "考虑三种用于医学成像中测量湮没光子能量的无机闪烁体：铊激活的碘化钠 $\\mathrm{NaI(Tl)}$、铈掺杂的镥-钇氧正硅酸盐 $\\mathrm{LYSO:Ce}$ 和铈掺杂的溴化镧 $\\mathrm{LaBr_3:Ce}$。每种闪烁体产生闪烁光子，其表格列出的光产额 $Y$（单位为光子/兆电子伏）和带有衰减常数 $\\tau$ 的指数发射时间分布均已制表。一个能量为 $E = 0.511~\\mathrm{MeV}$ 的伽马射线将其全部能量沉积在每种晶体中。假设所有三种晶体具有相同的光学耦合，并使用一个共同的光电传感器，其光子探测效率 (PDE) 为 $\\eta = 0.25$。电荷积分器使用一个从闪烁开始、持续时间为 $T = 100~\\mathrm{ns}$ 的固定矩形门。\n\n表格列出的性质：\n- $\\mathrm{NaI(Tl)}$: $Y_{\\mathrm{NaI}} = 3.8 \\times 10^{4}~\\text{光子/MeV}$，$\\tau_{\\mathrm{NaI}} = 230~\\mathrm{ns}$。\n- $\\mathrm{LYSO:Ce}$: $Y_{\\mathrm{LYSO}} = 3.0 \\times 10^{4}~\\text{光子/MeV}$，$\\tau_{\\mathrm{LYSO}} = 40~\\mathrm{ns}$。\n- $\\mathrm{LaBr_3:Ce}$: $Y_{\\mathrm{LaBr_3}} = 6.3 \\times 10^{4}~\\text{光子/MeV}$，$\\tau_{\\mathrm{LaBr_3}} = 16~\\mathrm{ns}$。\n\n从第一性原理出发：\n1. 使用光电子计数的泊松统计，将探测到的光电子数的方差与测得脉冲高度的分数展宽联系起来。\n2. 对于高斯峰，使用半高全宽 (FWHM) 与标准差之间的关系。\n3. 将闪烁光子发射建模为 $I(t) \\propto \\exp(-t/\\tau)$，并计算在门宽 $T$ 内收集到的光子分数。\n4. 推导由光子统计极限决定的能量分辨率 $R$（定义为 $\\mathrm{FWHM}/E$）的表达式，该表达式用 $Y$、$\\eta$、$E$、$\\tau$ 和 $T$ 表示。\n5. 使用表格中的值，在线性探测器响应、无电子学噪声和无增益起伏的假设下，对这三种材料的 $R$ 进行数值计算。\n\n然后，简要说明光产额非线性（能量相关的闪烁产额和径迹结构效应）将如何改变测得的 $R$ 值（相对于光子统计极限），无需进行额外计算。\n\n将每个 $R$ 表示为无量纲小数，并四舍五入到三位有效数字。", "solution": "问题陈述经评估是科学合理的、提法恰当且客观的。计算光子统计极限能量分辨率所需的所有数据和条件都已提供，所涉及的物理原理——闪烁、泊松统计和高斯峰分析——在辐射探测领域都是标准内容。所提供的材料性质和实验参数是符合实际的。因此，该问题是有效的，我将进行完整解答。\n\n推导过程遵循问题陈述中概述的步骤。\n\n闪烁探测器的能量分辨率 $R$ 从根本上受限于信号载流子数量的统计起伏，在本例中即为光电传感器探测到的光电子。我们假设测量的脉冲高度 $H$ 与探测到的光电子数 $N_{pe}$ 成正比。\n\n步骤1：泊松统计与脉冲高度展宽之间的联系。\n过程始于伽马射线沉积能量 $E$。这会产生平均数量为 $N_{photons}$ 的闪烁光子，由下式给出：\n$$\n\\bar{N}_{photons} = Y \\cdot E\n$$\n其中 $Y$ 是闪烁体的光产额，单位为每单位能量的光子数。这些光子随后被光子探测效率为 $\\eta$ 的光电传感器探测到。每个光子的探测是一个伯努利试验。对于大量的初始光子和恒定的探测概率，探测到的光电子数 $N_{pe}$ 服从泊松分布。探测到的光电子的平均数 $\\bar{N}_{pe}$ 为：\n$$\n\\bar{N}_{pe} = \\eta \\cdot \\bar{N}_{photons} = \\eta \\cdot Y \\cdot E\n$$\n泊松分布的一个关键性质是其方差等于其均值：\n$$\n\\sigma^2_{N_{pe}} = \\bar{N}_{pe}\n$$\n因此，光电子数的标准差为 $\\sigma_{N_{pe}} = \\sqrt{\\bar{N}_{pe}}$。\n测量的脉冲高度 $H$ 与 $N_{pe}$ 成正比，因此对于某个恒定增益 $k$，有 $H = k N_{pe}$。平均脉冲高度为 $\\bar{H} = k \\bar{N}_{pe}$，其标准差为 $\\sigma_H = k \\sigma_{N_{pe}}$。测得脉冲高度的分数展宽是其标准差与均值的比率：\n$$\n\\frac{\\sigma_H}{\\bar{H}} = \\frac{k \\sigma_{N_{pe}}}{k \\bar{N}_{pe}} = \\frac{\\sqrt{\\bar{N}_{pe}}}{\\bar{N}_{pe}} = \\frac{1}{\\sqrt{\\bar{N}_{pe}}}\n$$\n\n步骤2：高斯峰的半高全宽 (FWHM) 与标准差之间的关系。\n对于较大的均值， $N_{pe}$ 的泊松分布可以被高斯分布精确近似。高斯分布的半高全宽 (FWHM) 与标准差 ($\\sigma$) 之间的关系是：\n$$\n\\mathrm{FWHM} = 2\\sqrt{2\\ln(2)} \\sigma\n$$\n能量分辨率 $R$ 定义为能谱中全能峰的半高全宽 (FWHM) 除以峰质心的位置（平均能量 $E$）。由于能量与脉冲高度成正比，这等价于脉冲高度分布的 FWHM 除以平均脉冲高度：\n$$\nR = \\frac{\\mathrm{FWHM}_H}{\\bar{H}} = \\frac{2\\sqrt{2\\ln(2)} \\sigma_H}{\\bar{H}}\n$$\n代入步骤1的结果，我们得到：\n$$\nR = 2\\sqrt{2\\ln(2)} \\left(\\frac{1}{\\sqrt{\\bar{N}_{pe}}}\\right) = \\frac{2\\sqrt{2\\ln(2)}}{\\sqrt{\\bar{N}_{pe}}}\n$$\n\n步骤3：在积分门内收集的光子分数。\n闪烁光发射遵循时间常数为 $\\tau$ 的指数衰减。对于 $t \\ge 0$，归一化的强度分布为 $I(t) = \\frac{1}{\\tau}\\exp(-t/\\tau)$。电荷积分器仅在从 $t=0$ 开始的有限持续时间 $T$ 内收集光子。收集到的总光子分数 $f_c$ 是强度分布从 $t=0$ 到 $t=T$ 的积分：\n$$\nf_c = \\int_{0}^{T} \\frac{1}{\\tau} \\exp(-t/\\tau) \\,dt = \\left[ -\\exp(-t/\\tau) \\right]_{0}^{T} = -\\exp(-T/\\tau) - (-1) = 1 - \\exp(-T/\\tau)\n$$\n\n步骤4：推导能量分辨率 $R$ 的完整表达式。\n我们必须修改 $\\bar{N}_{pe}$ 的表达式，以考虑不完全的光收集。现在，平均光电子数仅基于在门宽 $T$ 内收集到的光子分数。\n$$\n\\bar{N}_{pe} = \\eta \\cdot f_c \\cdot \\bar{N}_{photons} = \\eta \\cdot (1 - \\exp(-T/\\tau)) \\cdot Y \\cdot E\n$$\n将这个修正后的 $\\bar{N}_{pe}$ 代入步骤2中的 $R$ 表达式，得到光子统计极限能量分辨率的最终表达式：\n$$\nR(Y, \\eta, E, \\tau, T) = \\frac{2\\sqrt{2\\ln(2)}}{\\sqrt{\\eta \\cdot E \\cdot Y \\cdot (1 - \\exp(-T/\\tau))}}\n$$\n\n步骤5：对三种闪烁体进行数值计算。\n给定 $E = 0.511~\\mathrm{MeV}$，$\\eta = 0.25$ 和 $T = 100~\\mathrm{ns}$。数值因子为 $2\\sqrt{2\\ln(2)} \\approx 2.355$。\n\n对于 $\\mathrm{NaI(Tl)}$：\n$Y_{\\mathrm{NaI}} = 3.8 \\times 10^{4}~\\mathrm{MeV}^{-1}$，$\\tau_{\\mathrm{NaI}} = 230~\\mathrm{ns}$。\n收集分数为 $f_{c, \\mathrm{NaI}} = 1 - \\exp(-100/230) \\approx 0.3528$。\n平均光电子数为 $\\bar{N}_{pe, \\mathrm{NaI}} = (0.25) \\cdot (0.511) \\cdot (3.8 \\times 10^4) \\cdot (0.3528) \\approx 1711.6$。\n能量分辨率为 $R_{\\mathrm{NaI}} = \\frac{2.355}{\\sqrt{1711.6}} \\approx \\frac{2.355}{41.37} \\approx 0.05692$。\n四舍五入到三位有效数字， $R_{\\mathrm{NaI}} = 0.0569$。\n\n对于 $\\mathrm{LYSO:Ce}$：\n$Y_{\\mathrm{LYSO}} = 3.0 \\times 10^{4}~\\mathrm{MeV}^{-1}$，$\\tau_{\\mathrm{LYSO}} = 40~\\mathrm{ns}$。\n收集分数为 $f_{c, \\mathrm{LYSO}} = 1 - \\exp(-100/40) = 1 - \\exp(-2.5) \\approx 0.9179$。\n平均光电子数为 $\\bar{N}_{pe, \\mathrm{LYSO}} = (0.25) \\cdot (0.511) \\cdot (3.0 \\times 10^4) \\cdot (0.9179) \\approx 3517.8$。\n能量分辨率为 $R_{\\mathrm{LYSO}} = \\frac{2.355}{\\sqrt{3517.8}} \\approx \\frac{2.355}{59.31} \\approx 0.03971$。\n四舍五入到三位有效数字， $R_{\\mathrm{LYSO}} = 0.0397$。\n\n对于 $\\mathrm{LaBr_3:Ce}$：\n$Y_{\\mathrm{LaBr_3}} = 6.3 \\times 10^{4}~\\mathrm{MeV}^{-1}$，$\\tau_{\\mathrm{LaBr_3}} = 16~\\mathrm{ns}$。\n收集分数为 $f_{c, \\mathrm{LaBr_3}} = 1 - \\exp(-100/16) = 1 - \\exp(-6.25) \\approx 0.9981$。\n平均光电子数为 $\\bar{N}_{pe, \\mathrm{LaBr_3}} = (0.25) \\cdot (0.511) \\cdot (6.3 \\times 10^4) \\cdot (0.9981) \\approx 8033.4$。\n能量分辨率为 $R_{\\mathrm{LaBr_3}} = \\frac{2.355}{\\sqrt{8033.4}} \\approx \\frac{2.355}{89.63} \\approx 0.02627$。\n四舍五入到三位有效数字， $R_{\\mathrm{LaBr_3}} = 0.0263$。\n\n关于光产额非线性的简要说明：\n前述计算假设光产额 $Y$ 是一个常数，意味着闪烁光子的数量与沉积能量 $E$ 严格成正比。实际上，闪烁体表现出非线性，即每单位能量的光产额 $dL/dE$ 取决于电离粒子的能量。伽马射线通过产生具有一定能量分布的次级电子级联来沉积其能量。由于每个次级电子的光产额不同，对于固定的总沉积能量 $E$，总光输出将存在统计起伏，这取决于电子级联的具体历史过程。这种效应在信号中引入了一个额外的方差来源，称为闪烁体的内禀分辨率。该方差与光子统计方差正交相加。因此，测得的能量分辨率 $R_{measured}$ 将总是比上面计算的理想光子统计极限分辨率 $R$ 更差（即值更大）。", "answer": "$$\\boxed{\\begin{pmatrix} 0.0569  0.0397  0.0263 \\end{pmatrix}}$$", "id": "4883258"}, {"introduction": "理解了理想探测器的性能极限后，我们必须面对现实世界中的一个关键挑战：高计数率下的系统行为。每个探测器在记录一个事件后都会经历一段“死时间”，在此期间它无法响应新的事件，这会导致测量到的事件率低于真实事件率。本练习 [@problem_id:4883310] 将引导你从泊松过程的基本特性出发，推导两种经典的死时间模型（非瘫痪型和瘫痪型），并学习如何利用实验数据来辨别一个真实系统的行为更符合哪种模型，这是进行精确定量测量的关键一步。", "problem": "一个基于碘化钠闪烁体、光电倍增管 (PMT) 和脉冲高度分析器 (PHA) 的伽马能谱系统，记录来自均匀泊松过程的光子相互作用脉冲，其真实到达率为 $\\lambda$ (单位为 $\\text{s}^{-1}$)。成形放大器和甄别器链在每个记录到的脉冲后施加一个固定的死时间 $\\tau$。考虑两种标准的死时间模型：非瘫痪型（当事件在死时间段内到达时，死时间间隔不延长）和瘫痪型（任何在死时间段内到达的事件都会将其到达时刻之后的死时间间隔延长 $\\tau$）。这些机制通过脉冲堆积和基线漂移，不仅影响计数率，还影响脉冲高度分析中的有效能量分辨率。\n\n仅使用泊松过程的基本定义以及非瘫痪型和瘫痪型死时间的操作定义，完成以下任务：\n\n1. 对于非瘫痪型死时间模型，推导测量计数率 $m$ 和真实计数率 $\\lambda$ 之间的函数关系，用 $\\lambda$ 和 $\\tau$ 表示。\n2. 对于瘫痪型死时间模型，推导测量计数率 $m$ 和真实计数率 $\\lambda$ 之间的函数关系，用 $\\lambda$ 和 $\\tau$ 表示。\n3. 通过调整源的活度以产生两种不同的真实率（使用一个死时间可忽略的快速参考计数器独立验证），进行了一次校准实验。被测系统报告的测量率如下：\n   - 在真实率 $\\lambda_1 = 4.00\\times 10^{4}\\ \\text{s}^{-1}$ 时，测量率为 $m_1 = 2.20\\times 10^{4}\\ \\text{s}^{-1}$。\n   - 在真实率 $\\lambda_2 = 8.00\\times 10^{4}\\ \\text{s}^{-1}$ 时，测量率为 $m_2 = 2.41\\times 10^{4}\\ \\text{s}^{-1}$。\n   使用第一对数据 $(\\lambda_1, m_1)$，计算每个模型所隐含的死时间 $\\tau$。然后，使用每个 $\\tau$ 的估计值，预测在 $\\lambda_2$ 时的测量率，并与 $m_2$ 进行比较，以确定哪个死时间模型更被这些数据所支持。\n4. 报告所选模型的估计死时间 $\\tau$ 作为最终答案。将您的答案四舍五入到四位有效数字。以微秒为单位表示最终的死时间。\n\n您的推导必须从死时间的定义和泊松过程的性质（到达间隔时间和无记忆性）开始，不得直接引用目标公式。您的推理应清楚地阐明为什么最终的吞吐量函数是从这些基础中得出的，以及数据如何支持模型识别。", "solution": "问题要求推导两种死时间模型的测量计数率，然后使用提供的实验数据进行模型选择和参数估计。推导将基于泊松过程的基本性质和每种死时间模型的定义。\n\n**1. 非瘫痪型死时间模型的推导**\n\n在一个非瘫痪型系统中，一个事件被成功记录后，探测系统在固定的时间段 $\\tau$ 内变得不灵敏（死时间）。在此死时间段内到达的事件被忽略，并且不影响死时间段的持续时间。\n\n设 $\\lambda$ 是遵循均匀泊松过程的输入事件的真实率。设 $m$ 是记录到的事件的测量率。\n考虑一个长的观测时间 $T$。记录到的事件总数为 $N_{meas} = m T$。\n每个记录到的事件引入一个持续时间为 $\\tau$ 的死时间。因此，在观测周期 $T$ 内，系统处于死时间状态的总时间为 $T_{dead} = N_{meas} \\times \\tau = m T \\tau$。\n系统只有在“活”（live）状态下才能记录新事件。在观测周期内，总的活时间是总时间减去总的死时间：\n$$T_{live} = T - T_{dead} = T - m T \\tau = T(1 - m \\tau)$$\n记录到的事件就是那些恰好在系统处于活时间状态时到达的真实事件。由于底层过程是泊松过程，活时间段内的事件率仍然是 $\\lambda$。因此，记录到的事件总数 $N_{meas}$ 必须等于真实率 $\\lambda$ 乘以总活时间 $T_{live}$。\n$$N_{meas} = \\lambda T_{live}$$\n代入 $N_{meas}$ 和 $T_{live}$ 的表达式：\n$$m T = \\lambda [T(1 - m \\tau)]$$\n两边同时除以总观测时间 $T$（非零），我们得到 $m$ 和 $\\lambda$ 之间的关系：\n$$m = \\lambda(1 - m \\tau)$$\n这是一个关于 $m$ 的隐式方程。为了找到函数关系，我们解出 $m$：\n$$m = \\lambda - \\lambda m \\tau$$\n$$m + \\lambda m \\tau = \\lambda$$\n$$m(1 + \\lambda \\tau) = \\lambda$$\n$$m = \\frac{\\lambda}{1 + \\lambda \\tau}$$\n这就是非瘫痪型模型所要求的函数关系。\n\n**2. 瘫痪型死时间模型的推导**\n\n在一个瘫痪型系统中，任何到达探测器的事件，无论是否被记录，都会引发一个新的持续时间为 $\\tau$ 的死时间。这意味着在现有死时间段内到达的事件会延长该死时间段。\n一个输入事件只有在它之前至少 $\\tau$ 的时间内没有任何其他事件时，才能被成功记录。\n让我们考虑来自泊松过程的输入事件流。连续事件之间的时间间隔，即到达间隔时间，是独立同分布的，遵循速率参数为 $\\lambda$ 的指数概率分布。到达间隔时间 $t$ 的概率密度函数为 $p(t) = \\lambda \\exp(-\\lambda t)$ (当 $t \\geq 0$)。\n\n一个事件被记录的充要条件是，它与前一个事件之间的时间间隔大于 $\\tau$。因此，任何给定事件被记录的概率就是其到达间隔时间 $t$ 大于 $\\tau$ 的概率。\n$$P(\\text{event recorded}) = P(t > \\tau)$$\n我们通过对概率密度函数从 $\\tau$ 到无穷大进行积分来计算这个概率：\n$$P(t > \\tau) = \\int_{\\tau}^{\\infty} \\lambda \\exp(-\\lambda t) dt$$\n$$P(t > \\tau) = \\left[ -\\exp(-\\lambda t) \\right]_{\\tau}^{\\infty}$$\n$$P(t > \\tau) = \\lim_{t \\to \\infty} (-\\exp(-\\lambda t)) - (-\\exp(-\\lambda \\tau))$$\n$$P(t > \\tau) = 0 + \\exp(-\\lambda \\tau) = \\exp(-\\lambda \\tau)$$\n这个概率代表了被成功记录的真实事件的比例。因此，测量率 $m$ 是真实率 $\\lambda$ 乘以这个概率：\n$$m = \\lambda \\times P(\\text{event recorded})$$\n$$m = \\lambda \\exp(-\\lambda \\tau)$$\n这就是瘫痪型模型所要求的函数关系。值得注意的是，对于这个模型，测量率 $m$ 并不随 $\\lambda$ 单调增加。它会达到一个最大值然后下降，这种现象被称为瘫痪。\n\n**3. 模型选择和参数估计**\n\n我们得到两组数据点：\n- $(\\lambda_1, m_1) = (4.00 \\times 10^4 \\text{ s}^{-1}, 2.20 \\times 10^4 \\text{ s}^{-1})$\n- $(\\lambda_2, m_2) = (8.00 \\times 10^4 \\text{ s}^{-1}, 2.41 \\times 10^4 \\text{ s}^{-1})$\n\n我们将使用第一个数据点 $(\\lambda_1, m_1)$ 来估计每个模型的死时间 $\\tau$。\n\n**非瘫痪型模型估计：**\n使用公式 $m = \\frac{\\lambda}{1 + \\lambda \\tau}$，我们解出 $\\tau$：\n$$m(1 + \\lambda \\tau) = \\lambda \\implies 1 + \\lambda \\tau = \\frac{\\lambda}{m} \\implies \\lambda \\tau = \\frac{\\lambda}{m} - 1 = \\frac{\\lambda - m}{m}$$\n$$\\tau = \\frac{\\lambda - m}{m \\lambda}$$\n代入第一个数据点的值：\n$$\\tau_{np} = \\frac{4.00 \\times 10^4 - 2.20 \\times 10^4}{(2.20 \\times 10^4)(4.00 \\times 10^4)} = \\frac{1.80 \\times 10^4}{8.80 \\times 10^8} \\text{ s} \\approx 2.045 \\times 10^{-5} \\text{ s}$$\n现在，我们使用这个 $\\tau_{np}$ 的值来预测真实率 $\\lambda_2$ 对应的测量率 $m_2$：\n$$m_{2, \\text{pred, np}} = \\frac{\\lambda_2}{1 + \\lambda_2 \\tau_{np}} = \\frac{8.00 \\times 10^4}{1 + (8.00 \\times 10^4)(2.045\\dots \\times 10^{-5})} = \\frac{8.00 \\times 10^4}{1 + 1.636\\dots} = \\frac{8.00 \\times 10^4}{2.636\\dots} \\approx 3.03 \\times 10^4 \\text{ s}^{-1}$$\n\n**瘫痪型模型估计：**\n使用公式 $m = \\lambda \\exp(-\\lambda \\tau)$，我们解出 $\\tau$：\n$$\\frac{m}{\\lambda} = \\exp(-\\lambda \\tau) \\implies \\ln\\left(\\frac{m}{\\lambda}\\right) = -\\lambda \\tau$$\n$$\\tau = -\\frac{1}{\\lambda} \\ln\\left(\\frac{m}{\\lambda}\\right)$$\n代入第一个数据点的值：\n$$\\tau_p = -\\frac{1}{4.00 \\times 10^4} \\ln\\left(\\frac{2.20 \\times 10^4}{4.00 \\times 10^4}\\right) = -\\frac{1}{4.00 \\times 10^4} \\ln(0.55)$$\n$$\\tau_p \\approx -\\frac{1}{4.00 \\times 10^4} (-0.597837) \\approx 1.4946 \\times 10^{-5} \\text{ s}$$\n现在，我们使用这个 $\\tau_p$ 的值来预测真实率 $\\lambda_2$ 对应的测量率 $m_2$：\n$$m_{2, \\text{pred, p}} = \\lambda_2 \\exp(-\\lambda_2 \\tau_p) = (8.00 \\times 10^4) \\exp\\left(-(8.00 \\times 10^4)(1.4946 \\times 10^{-5})\\right)$$\n$$m_{2, \\text{pred, p}} = (8.00 \\times 10^4) \\exp(-1.19567) \\approx (8.00 \\times 10^4)(0.3025) \\approx 2.42 \\times 10^4 \\text{ s}^{-1}$$\n\n**比较和模型选择：**\n我们将预测的率与实验测量的率 $m_2 = 2.41 \\times 10^4 \\text{ s}^{-1}$ 进行比较：\n- 非瘫痪型模型预测值：$m_{2, \\text{pred, np}} \\approx 3.03 \\times 10^4 \\text{ s}^{-1}$。\n- 瘫痪型模型预测值：$m_{2, \\text{pred, p}} \\approx 2.42 \\times 10^4 \\text{ s}^{-1}$。\n\n瘫痪型模型的预测值 ($2.42 \\times 10^4 \\text{ s}^{-1}$) 比非瘫痪型模型的预测值 ($3.03 \\times 10^4 \\text{ s}^{-1}$) 更接近测量值 ($2.41 \\times 10^4 \\text{ s}^{-1}$)。瘫痪型模型的相对误差约为 $\\frac{|2.42 - 2.41|}{2.41} \\approx 0.4\\%$，而非瘫痪型模型的相对误差约为 $\\frac{|3.03 - 2.41|}{2.41} \\approx 25.7\\%$。\n因此，瘫痪型死时间模型更被数据所支持。数据也表现出瘫痪型系统的典型行为，即在较高的真实率下，测量率的增长变得不那么陡峭，甚至可能下降。在这里，将真实率从 $4.00 \\times 10^4$ 翻倍到 $8.00 \\times 10^4 \\text{ s}^{-1}$，测量率仅从 $2.20 \\times 10^4$ 轻微增加到 $2.41 \\times 10^4 \\text{ s}^{-1}$，这表明系统正在其最大吞吐量附近或之外运行。\n\n**4. 最终答案计算**\n\n所选模型是瘫痪型模型。估计的死时间是为此模型计算出的值：\n$$\\tau = \\tau_p \\approx 1.49459 \\times 10^{-5} \\text{ s}$$\n问题要求以微秒 ($\\mu\\text{s}$) 为单位报告此值，并四舍五入到四位有效数字。\n$$1 \\text{ s} = 10^6 \\mu\\text{s}$$\n$$\\tau = 1.49459 \\times 10^{-5} \\text{ s} \\times \\frac{10^6 \\mu\\text{s}}{1 \\text{ s}} = 14.9459 \\mu\\text{s}$$\n四舍五入到四位有效数字，我们得到：\n$$\\tau \\approx 14.95 \\mu\\text{s}$$\n这是最终答案。", "answer": "$$\n\\boxed{14.95}\n$$", "id": "4883310"}, {"introduction": "本章的最后一个练习将理论与实际测量工作流程联系起来。在真实实验中，探测器系统（如多道分析器，MCA）输出的数据是以“道”为单位的，这并非物理单位。为了得到有意义的能谱，我们必须首先使用已知能量的放射源进行能量刻度，建立“道”与能量（如 $\\text{keV}$）之间的转换关系。通过这个练习 [@problem_id:4883305]，你将实践从原始道址数据出发，执行能量刻度，并最终计算一个未知光电峰的能量分辨率的全过程，从而掌握将仪器读数转化为精确物理量的核心技能。", "problem": "一个闪烁探测器与一个多道分析器（MCA）耦合，后者沿道址坐标 $C$ 记录脉冲高度谱。已知能量与道址之间的关系是线性的。在道址 $C_1$ 和 $C_2$ 处分别观测到两个已知光子能量的校准峰，用于确定线性校准关系。然后测量一个感兴趣的未知峰。\n\n校准数据如下：\n- 已知能量 $E_1 = 511 \\text{ keV}$，位于道址 $C_1 = 420.0$。\n- 已知能量 $E_2 = 1274.5 \\text{ keV}$，位于道址 $C_2 = 1030.0$。\n\n假设线性校准关系为 $E = a + b\\,C$，其中 $a$ 和 $b$ 是待由校准数据确定的常数。\n\n一个未知峰的质心被测得位于 $C_0 = 600.0$。能谱已被重新分箱，使得每个直方图的箱（bin）沿 $C$ 轴跨越 $\\Delta C = 2.0$ 个道址。对重新分箱后的峰进行高斯模型拟合，得到以箱数为单位的标准差 $\\sigma_C = 1.8$。\n\n从能量分辨率是半高全宽除以峰能量的基本定义出发，并利用高斯分布的半高全宽是其标准差的 $2\\sqrt{2\\ln 2}$ 倍这一性质，完成以下任务：\n1. 确定校准参数 $a$ 和 $b$，并计算 $C_0$ 处的峰能量 $E$。\n2. 将拟合得到的宽度转换到能量域的标准差，并仔细考虑箱宽 $\\Delta C$。\n3. 推导并计算能量分辨率 $R$，其定义为 $R = \\text{FWHM} / E$，其中 FWHM 是能量的半高全宽。\n\n将 $R$ 的最终值表示为纯小数（无单位），并四舍五入到四位有效数字。能量应以 $\\text{keV}$ 为单位处理。", "solution": "首先验证问题陈述，以确保其科学上合理、提法得当且客观。\n\n### 步骤1：提取给定条件\n- 能量-道址关系：$E = a + b\\,C$（线性）\n- 校准点1：能量 $E_1 = 511 \\text{ keV}$，位于道址 $C_1 = 420.0$。\n- 校准点2：能量 $E_2 = 1274.5 \\text{ keV}$，位于道址 $C_2 = 1030.0$。\n- 未知峰质心：$C_0 = 600.0$。\n- 直方图箱宽：$\\Delta C = 2.0$ 道址。\n- 拟合的高斯标准差：$\\sigma_C = 1.8$ 箱。\n- 高斯分布的半高全宽：$\\text{FWHM} = (2\\sqrt{2\\ln 2}) \\times (\\text{标准差})$。\n- 能量分辨率的定义：$R = \\text{FWHM} / E$。\n\n### 步骤2：使用提取的条件进行验证\n- **科学基础**：该问题使用了核谱学的标准原理，包括线性探测器校准、高斯峰建模和能量分辨率的定义。能量值（$511 \\text{ keV}$ 和 $1274.5 \\text{ keV}$）是符合实际的，对应于常见的校准源（正电子湮灭和 $^{60}\\text{Co}$）。整个设置在科学上是正确的。\n- **提法得当性**：该问题提供了两个不同的校准点来确定一个线性方程的两个参数，从而确保了校准的唯一解。计算能量和分辨率所需的所有后续数据均已提供。\n- **客观性和完整性**：该问题的陈述包含了精确的、定量的数据和定义，没有歧义或主观解释的余地。它是自洽且完整的。\n\n### 步骤3：结论与行动\n该问题是有效的。将构建解答。\n\n解答按要求分为三部分进行。\n\n**1. 确定校准参数和峰能量**\n\n线性校准模型由 $E = a + bC$ 给出，其中 $E$ 是以 $\\text{keV}$ 为单位的能量，$C$ 是道址数。我们有两个数据点 $(C_1, E_1)$ 和 $(C_2, E_2)$，可以用它们构成一个二元一次方程组：\n$$E_1 = a + bC_1$$\n$$E_2 = a + bC_2$$\n用第二个方程减去第一个方程，得到：\n$$E_2 - E_1 = b(C_2 - C_1)$$\n求解斜率 $b$，它代表每个道址的能量（增益）：\n$$b = \\frac{E_2 - E_1}{C_2 - C_1}$$\n代入给定值：\n$$b = \\frac{1274.5 \\text{ keV} - 511 \\text{ keV}}{1030.0 - 420.0} = \\frac{763.5 \\text{ keV}}{610.0} \\approx 1.25164 \\text{ keV/channel}$$\n现在，我们可以使用第一个方程求解截距 $a$：\n$$a = E_1 - bC_1$$\n代入 $b$ 的值和第一个数据点：\n$$a = 511 - (1.251639344...) \\times 420.0 \\approx 511 - 525.68852 \\approx -14.68852 \\text{ keV}$$\n因此，完整的校准方程为 $E(C) = -14.68852 + 1.25164 C$。\n\n对应于道址 $C_0 = 600.0$ 处未知峰的能量 $E_0$ 为：\n$$E_0 = a + bC_0 \\approx -14.68852 + (1.251639344...) \\times 600.0 \\approx -14.68852 + 750.98361 \\approx 736.295 \\text{ keV}$$\n\n**2. 将拟合宽度转换为能量域的标准差**\n\n高斯拟合得到的标准差为 $\\sigma_C = 1.8$ 箱。必须先将其转换为道址域。箱宽为 $\\Delta C = 2.0$ 道址/箱。以道址为单位的标准差，记为 $\\sigma_{\\text{ch}}$，是：\n$$\\sigma_{\\text{ch}} = \\sigma_C \\times \\Delta C = 1.8 \\text{ bins} \\times 2.0 \\frac{\\text{channels}}{\\text{bin}} = 3.6 \\text{ channels}$$\n由于能量校准是线性的，道址域中的宽度可以通过乘以校准线的斜率 $b$ 转换为能量域中的宽度。能量的标准差 $\\sigma_E$ 是：\n$$\\sigma_E = b \\times \\sigma_{\\text{ch}} \\approx 1.25164 \\frac{\\text{keV}}{\\text{channel}} \\times 3.6 \\text{ channels} \\approx 4.5059 \\text{ keV}$$\n\n**3. 推导并计算能量分辨率**\n\n能量分辨率 $R$ 定义为能量的半高全宽（$\\text{FWHM}_E$）与峰能量 $E_0$ 的比值：\n$$R = \\frac{\\text{FWHM}_E}{E_0}$$\n问题陈述指出，对于高斯分布，半高全宽（FWHM）与标准差 $\\sigma_E$ 的关系为：\n$$\\text{FWHM}_E = (2\\sqrt{2\\ln 2}) \\sigma_E$$\n常数因子约为 $2\\sqrt{2\\ln 2} \\approx 2.35482$。\n首先，我们计算 $\\text{FWHM}_E$：\n$$\\text{FWHM}_E \\approx 2.35482 \\times \\sigma_E \\approx 2.35482 \\times 4.5059 \\text{ keV} \\approx 10.610 \\text{ keV}$$\n现在，我们可以计算能量分辨率 $R$：\n$$R = \\frac{\\text{FWHM}_E}{E_0} \\approx \\frac{10.610 \\text{ keV}}{736.295 \\text{ keV}} \\approx 0.014410$$\n根据要求将结果四舍五入到四位有效数字，我们得到 $R = 0.01441$。\n$R$ 用初始参数表示的表达式为：\n$$R = \\frac{(2\\sqrt{2\\ln 2}) \\times (\\sigma_C \\times \\Delta C) \\times b}{a + bC_0} = \\frac{(2\\sqrt{2\\ln 2}) \\times (\\sigma_C \\times \\Delta C) \\times \\frac{E_2 - E_1}{C_2 - C_1}}{(E_1 - bC_1) + bC_0} = \\frac{(2\\sqrt{2\\ln 2})(\\sigma_C \\Delta C) \\frac{E_2 - E_1}{C_2 - C_1}}{E_1 + \\frac{E_2 - E_1}{C_2 - C_1}(C_0 - C_1)}$$", "answer": "$$\\boxed{0.01441}$$", "id": "4883305"}]}