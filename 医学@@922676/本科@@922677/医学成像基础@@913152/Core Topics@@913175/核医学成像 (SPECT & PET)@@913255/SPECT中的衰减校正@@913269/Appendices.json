{"hands_on_practices": [{"introduction": "准确的衰减校正始于对线性衰减系数 $\\mu$ 的精确测量。本练习提供了一个动手实践的机会，您将利用原始的透射扫描数据来计算 $\\mu$ 值及其统计不确定性。通过这个过程，您将加深对 Beer-Lambert 定律与实际实验物理之间联系的理解，并掌握评估衰减图质量的基础技能 [@problem_id:4863704]。", "problem": "为进行单光子发射计算机断层成像 (SPECT) 中的衰减校正，执行了一次透射测量来估计线性衰减系数。一束能量为 $140~\\mathrm{keV}$ 的单能 Technetium-99m 光子束入射到一个均匀的水等效板上。假设采用窄束几何，因此只探测到一次光子，散射可以忽略不计。测得板厚为 $x = 8.0~\\mathrm{cm}$，其不确定度相对于计数统计可以忽略。使用已校准的伽马相机进行了两次等时长的独立采集：一次没有放置板，另一次放置了板。测得的总计数分别为：无板时 $N_{0} = 2.5 \\times 10^{6}$ 计数，有板时 $N = 7.8 \\times 10^{5}$ 计数。\n\n从单能光子的指数衰减定律出发，并假设独立测量遵循泊松计数统计，推导线性衰减系数 $\\mu$ 的估计量（用 $N_{0}$、$N$ 和 $x$ 表示）的表达式，然后使用一阶不确定度传播法求出 $\\mu$ 的标准不确定度（一个标准差）。使用所提供的测量值计算数值结果。\n\n将估计的 $\\mu$ 及其标准不确定度均四舍五入至四位有效数字。最终值以 $\\mathrm{cm}^{-1}$ 为单位表示。请将您的最终答案以单行两个数字的形式给出，第一个数字是估计的 $\\mu$，第二个数字是其标准不确定度。", "solution": "用户希望我解决以下问题：\n为进行单光子发射计算机断层成像 (SPECT) 中的衰减校正，执行了一次透射测量来估计线性衰减系数。一束能量为 $140~\\mathrm{keV}$ 的单能 Technetium-99m 光子束入射到一个均匀的水等效板上。假设采用窄束几何，因此只探测到一次光子，散射可以忽略不计。测得板厚为 $x = 8.0~\\mathrm{cm}$，其不确定度相对于计数统计可以忽略。使用已校准的伽马相机进行了两次等时长的独立采集：一次没有放置板，另一次放置了板。测得的总计数分别为：无板时 $N_{0} = 2.5 \\times 10^{6}$ 计数，有板时 $N = 7.8 \\times 10^{5}$ 计数。\n\n从单能光子的指数衰减定律出发，并假设独立测量遵循泊松计数统计，推导线性衰减系数 $\\mu$ 的估计量（用 $N_{0}$、$N$ 和 $x$ 表示）的表达式，然后使用一阶不确定度传播法求出 $\\mu$ 的标准不确定度（一个标准差）。使用所提供的测量值计算数值结果。\n\n将估计的 $\\mu$ 及其标准不确定度均四舍五入至四位有效数字。最终值以 $\\mathrm{cm}^{-1}$ 为单位表示。请将您的最终答案以单行两个数字的形式给出，第一个数字是估计的 $\\mu$，第二个数字是其标准不确定度。\n\n### 步骤1：提取已知条件\n- 光子能量：$140~\\mathrm{keV}$（来自 Technetium-99m）\n- 几何结构：窄束\n- 板厚：$x = 8.0~\\mathrm{cm}$（不确定度可忽略）\n- 无板时计数：$N_{0} = 2.5 \\times 10^{6}$\n- 有板时计数：$N = 7.8 \\times 10^{5}$\n- 统计模型：遵循泊松计数统计的独立测量。\n- 任务：推导线性衰减系数 $\\mu$ 的估计量及其标准不确定度 $\\sigma_{\\mu}$。计算它们的数值。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于指数光子衰减的基本原理（比尔-朗伯定律），这是医学物理学和成像的基石。在 SPECT 中使用常见的医用同位素 Tc-99m 及其 $140~\\mathrm{keV}$ 的光子是标准做法。对光子计数采用泊松统计的假设是对此类量子探测过程的标准且准确的模型。所提供的数值对于典型的透射扫描是切合实际的。该问题在科学上是合理的。\n2.  **良态问题**：该问题提供了所有必要信息（$N_0$, $N$, $x$）以确定估计量 $\\hat{\\mu}$ 及其不确定度 $\\sigma_{\\mu}$ 的唯一值。指令清晰。\n3.  **客观性**：该问题以精确、客观的语言陈述，没有歧义或主观性陈述。\n4.  **完整性与一致性**：该问题是自洽的。给定的数据是一致的，并且足以求解。假设 $x$ 的不确定度可忽略，对该难度级别的问题进行了适当的简化分析。\n5.  **未检测到其他缺陷**：该问题并非无关紧要、比喻性或超出科学验证范围。\n\n### 步骤3：结论与行动\n问题有效。我将继续进行解答。\n\n### 第1部分：$\\mu$ 的估计量的推导\n\n单能窄束光子穿过均匀材料时的衰减由比尔-朗伯定律描述：\n$$I = I_0 \\exp(-\\mu x)$$\n其中 $I_0$ 是入射光子强度，$I$ 是透射光子强度，$x$ 是材料厚度，$\\mu$ 是线性衰减系数。\n\n在光子计数实验中，假设探测器面积和计数时间恒定，探测到的计数值与光子强度成正比。设 $N_0$ 为无板时的计数（与 $I_0$ 成正比），$N$ 为有板时的计数（与 $I$ 成正比）。我们可以写出：\n$$N_0 = k I_0$$\n$$N = k I$$\n其中 $k$ 是一个比例常数，取决于探测器效率、几何结构和采集时间。由于两次测量的这些条件相同，我们可以建立计数之间的关系：\n$$N = N_0 \\exp(-\\mu x)$$\n为求解 $\\mu$ 的估计量（我们记为 $\\hat{\\mu}$），我们对此方程求解 $\\mu$：\n$$\\frac{N}{N_0} = \\exp(-\\hat{\\mu} x)$$\n两边取自然对数：\n$$\\ln\\left(\\frac{N}{N_0}\\right) = -\\hat{\\mu} x$$\n整理各项，得到估计量 $\\hat{\\mu}$ 的表达式：\n$$\\hat{\\mu} = -\\frac{1}{x} \\ln\\left(\\frac{N}{N_0}\\right) = \\frac{1}{x} \\ln\\left(\\frac{N_0}{N}\\right)$$\n\n### 第2部分：$\\mu$ 的标准不确定度的推导\n\n我们使用一阶不确定度传播公式。对于函数 $f(y_1, y_2, \\dots)$，其方差 $\\sigma_f^2$ 近似为：\n$$\\sigma_f^2 \\approx \\sum_i \\left(\\frac{\\partial f}{\\partial y_i}\\right)^2 \\sigma_{y_i}^2 + \\sum_{i \\neq j} \\frac{\\partial f}{\\partial y_i} \\frac{\\partial f}{\\partial y_j} \\sigma_{y_i y_j}$$\n其中 $\\sigma_{y_i}^2$ 是变量 $y_i$ 的方差，$\\sigma_{y_i y_j}$ 是 $y_i$ 和 $y_j$ 之间的协方差。\n\n在本例中，估计量 $\\hat{\\mu}$ 是 $N_0$、$N$ 和 $x$ 的函数。题目说明 $x$ 的不确定度可以忽略，因此我们将其视为常数。测量值 $N_0$ 和 $N$ 是独立的，所以它们的协方差为零（$\\sigma_{N_0 N} = 0$）。$\\hat{\\mu}$ 的不确定度传播公式简化为：\n$$\\sigma_{\\mu}^2 \\approx \\left(\\frac{\\partial \\hat{\\mu}}{\\partial N_0}\\right)^2 \\sigma_{N_0}^2 + \\left(\\frac{\\partial \\hat{\\mu}}{\\partial N}\\right)^2 \\sigma_N^2$$\n题目指明计数遵循泊松统计。对于泊松分布，测量值的方差等于其平均值。平均计数的最佳估计就是测量到的计数值本身。因此：\n$$\\sigma_{N_0}^2 = N_0$$\n$$\\sigma_{N}^2 = N$$\n\n接下来，我们计算 $\\hat{\\mu} = \\frac{1}{x}(\\ln(N_0) - \\ln(N))$ 的偏导数：\n$$\\frac{\\partial \\hat{\\mu}}{\\partial N_0} = \\frac{\\partial}{\\partial N_0} \\left[\\frac{1}{x}(\\ln(N_0) - \\ln(N))\\right] = \\frac{1}{x N_0}$$\n$$\\frac{\\partial \\hat{\\mu}}{\\partial N} = \\frac{\\partial}{\\partial N} \\left[\\frac{1}{x}(\\ln(N_0) - \\ln(N))\\right] = -\\frac{1}{x N}$$\n\n将导数和方差代入不确定度公式：\n$$\\sigma_{\\mu}^2 \\approx \\left(\\frac{1}{x N_0}\\right)^2 (N_0) + \\left(-\\frac{1}{x N}\\right)^2 (N)$$\n$$\\sigma_{\\mu}^2 \\approx \\frac{1}{x^2 N_0^2} N_0 + \\frac{1}{x^2 N^2} N$$\n$$\\sigma_{\\mu}^2 \\approx \\frac{1}{x^2 N_0} + \\frac{1}{x^2 N}$$\n$$\\sigma_{\\mu}^2 \\approx \\frac{1}{x^2} \\left(\\frac{1}{N_0} + \\frac{1}{N}\\right)$$\n标准不确定度 $\\sigma_{\\mu}$ 是方差的平方根：\n$$\\sigma_{\\mu} = \\sqrt{\\frac{1}{x^2} \\left(\\frac{1}{N_0} + \\frac{1}{N}\\right)} = \\frac{1}{|x|} \\sqrt{\\frac{1}{N_0} + \\frac{1}{N}}$$\n由于厚度 $x$ 是正数，我们可以写成：\n$$\\sigma_{\\mu} = \\frac{1}{x} \\sqrt{\\frac{1}{N_0} + \\frac{1}{N}}$$\n\n### 第3部分：数值计算\n\n我们已知以下数值：\n$x = 8.0~\\mathrm{cm}$\n$N_0 = 2.5 \\times 10^6$\n$N = 7.8 \\times 10^5$\n\n首先，我们计算估计量 $\\hat{\\mu}$ 的值：\n$$\\hat{\\mu} = \\frac{1}{8.0~\\mathrm{cm}} \\ln\\left(\\frac{2.5 \\times 10^6}{7.8 \\times 10^5}\\right)$$\n$$\\hat{\\mu} = \\frac{1}{8.0} \\ln\\left(\\frac{250}{78}\\right) \\approx \\frac{1}{8.0} \\ln(3.205128)$$\n$$\\hat{\\mu} \\approx \\frac{1.16478}{8.0} \\approx 0.1455975~\\mathrm{cm}^{-1}$$\n四舍五入到四位有效数字，我们得到：\n$$\\hat{\\mu} \\approx 0.1456~\\mathrm{cm}^{-1}$$\n\n接下来，我们计算标准不确定度 $\\sigma_{\\mu}$：\n$$\\sigma_{\\mu} = \\frac{1}{8.0~\\mathrm{cm}} \\sqrt{\\frac{1}{2.5 \\times 10^6} + \\frac{1}{7.8 \\times 10^5}}$$\n$$\\sigma_{\\mu} = \\frac{1}{8.0} \\sqrt{4.0 \\times 10^{-7} + 1.282051 \\times 10^{-6}}~\\mathrm{cm}^{-1}$$\n$$\\sigma_{\\mu} = \\frac{1}{8.0} \\sqrt{1.682051 \\times 10^{-6}}~\\mathrm{cm}^{-1}$$\n$$\\sigma_{\\mu} \\approx \\frac{1}{8.0} (1.296939 \\times 10^{-3})~\\mathrm{cm}^{-1}$$\n$$\\sigma_{\\mu} \\approx 0.000162117~\\mathrm{cm}^{-1}$$\n四舍五入到四位有效数字，我们得到：\n$$\\sigma_{\\mu} \\approx 0.0001621~\\mathrm{cm}^{-1}$$\n\n估计的线性衰减系数为 $0.1456~\\mathrm{cm}^{-1}$，其标准不确定度为 $0.0001621~\\mathrm{cm}^{-1}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1456 & 0.0001621\n\\end{pmatrix}\n}\n$$", "id": "4863704"}, {"introduction": "虽然测量 $\\mu$ 是第一步，但理解其不准确性对定量成像造成的后果也同样至关重要。本练习 [@problem_id:4863672] 是一个思想实验，它引导您推导出一个解析表达式，用以量化当对非均匀组织使用简化的均匀衰减图时，重建活度产生的偏差。这清晰地揭示了为何在临床实践中，获取并使用针对每位患者的具体衰减图是必不可少的。", "problem": "单光子发射计算机断层成像 (SPECT) 的一次投影是从一个小的体素采集的。该体素以真实活度率 $A_{0}$ 向探测器发射单能光子，光子沿穿过物体的直线路径传播，总路径长度为 $L$。在此路径上，射线穿过两个组织区域：软组织和肺。设光子能量下软组织和肺的线性衰减系数分别为 $\\mu_{\\mathrm{soft}}$ 和 $\\mu_{\\mathrm{lung}}$。定义路径分数 $f_{\\mathrm{soft}}$ 和 $f_{\\mathrm{lung}}$ 分别为总路径长度 $L$ 中位于软组织和肺内的部分所占的比例，且 $f_{\\mathrm{soft}} + f_{\\mathrm{lung}} = 1$。沿路径的光子通量衰减遵循比尔-朗伯定律，系统通过将测量的投影值乘以一个在均匀衰减假设 $\\mu_{\\mathrm{u}}$（在整个路径上为常数）下计算的衰减校正因子来重建体素的活度。\n\n从光子衰减的基本比尔-朗伯定律和分段恒定线性衰减的路径积分定义出发，推导并简化重建活度中相对偏差（无量纲）$B$ 的闭式表达式，\n$$\nB \\equiv \\frac{\\hat{A} - A_{0}}{A_{0}},\n$$\n该偏差是由于重建假设了均匀衰减系数 $\\mu_{\\mathrm{u}}$ 而非真实的两区域衰减而引入的。将 $B$ 表示为 $f_{\\mathrm{soft}}$、$f_{\\mathrm{lung}}$、$L$、$\\mu_{\\mathrm{soft}}$、$\\mu_{\\mathrm{lung}}$ 和 $\\mu_{\\mathrm{u}}$ 的函数。请以单个解析表达式的形式给出最终答案。不需要进行数值计算，并且由于 $B$ 是无量纲的，最终表达式中不应包含单位。", "solution": "对问题陈述进行了严格评估，认定其有效。该问题在科学上基于医学物理学原理，特别是作为单光子发射计算机断层成像 (SPECT) 核心的光子衰减比尔-朗伯定律。问题提法恰当，所有必要的变量和条件都已定义，没有歧义或矛盾。其目标是基于这些原理推导一个数学表达式，这是物理学和工程学中的一项标准且可形式化的任务。因此，将提供一个合理的解答。\n\n推导从比尔-朗伯定律开始，该定律描述了光子通量穿过介质时的衰减。对于初始强度或活度率为 $A_0$ 的光子通量，穿过路径后测得的活度率 $A_{\\text{meas}}$ 由下式给出：\n$$\nA_{\\text{meas}} = A_0 \\exp\\left(-\\int_{\\text{path}} \\mu(l) \\, dl\\right)\n$$\n其中 $\\mu(l)$ 是沿路径位置 $l$ 处的线性衰减系数。\n\n在本问题中，总长度为 $L$ 的路径由两段具有恒定衰减系数的路径组成：穿过软组织的长度为 $L_{\\text{soft}} = f_{\\text{soft}}L$，其系数为 $\\mu_{\\text{soft}}$；穿过肺组织的长度为 $L_{\\text{lung}} = f_{\\text{lung}}L$，其系数为 $\\mu_{\\text{lung}}$。路径积分可以表示为和的形式：\n$$\n\\int_{\\text{path}} \\mu(l) \\, dl = \\mu_{\\text{soft}} L_{\\text{soft}} + \\mu_{\\text{lung}} L_{\\text{lung}}\n$$\n代入各段长度的表达式，我们得到沿路径的真实总衰减：\n$$\n\\int_{\\text{path}} \\mu(l) \\, dl = \\mu_{\\text{soft}} (f_{\\text{soft}}L) + \\mu_{\\text{lung}} (f_{\\text{lung}}L) = L(\\mu_{\\text{soft}}f_{\\text{soft}} + \\mu_{\\text{lung}}f_{\\text{lung}})\n$$\n因此，真实的测量投影值 $A_{\\text{meas}}$ 为：\n$$\nA_{\\text{meas}} = A_0 \\exp\\left(-L(\\mu_{\\text{soft}}f_{\\text{soft}} + \\mu_{\\text{lung}}f_{\\text{lung}})\\right)\n$$\n\n然而，重建过程并未使用真实的非均匀衰减系数。相反，它假设在整个路径长度 $L$ 上有一个均匀的衰减系数 $\\mu_{\\text{u}}$。基于这个不正确的假设，系统计算一个衰减校正因子 (ACF) 来估计原始活度。假设的衰减将是 $\\exp(-\\mu_{\\text{u}}L)$。ACF 是这个假设衰减因子的乘法逆元：\n$$\n\\text{ACF} = \\frac{1}{\\exp(-\\mu_{\\text{u}}L)} = \\exp(\\mu_{\\text{u}}L)\n$$\n重建活度 $\\hat{A}$ 是通过将此 ACF 应用于实际测量的活度 $A_{\\text{meas}}$ 得到的：\n$$\n\\hat{A} = A_{\\text{meas}} \\times \\text{ACF}\n$$\n代入 $A_{\\text{meas}}$ 和 ACF 的表达式：\n$$\n\\hat{A} = \\left( A_0 \\exp\\left(-L(\\mu_{\\text{soft}}f_{\\text{soft}} + \\mu_{\\text{lung}}f_{\\text{lung}})\\right) \\right) \\cdot \\exp(\\mu_{\\text{u}}L)\n$$\n合并指数项，我们得到重建活度的表达式：\n$$\n\\hat{A} = A_0 \\exp\\left( -L(\\mu_{\\text{soft}}f_{\\text{soft}} + \\mu_{\\text{lung}}f_{\\text{lung}}) + \\mu_{\\text{u}}L \\right)\n$$\n从指数中提出路径长度 $L$ 可得：\n$$\n\\hat{A} = A_0 \\exp\\left( L(\\mu_{\\text{u}} - \\mu_{\\text{soft}}f_{\\text{soft}} - \\mu_{\\text{lung}}f_{\\text{lung}}) \\right)\n$$\n\n问题要求的是重建活度的相对偏差 $B$，其定义为：\n$$\nB \\equiv \\frac{\\hat{A} - A_0}{A_0} = \\frac{\\hat{A}}{A_0} - 1\n$$\n为了求出 $B$，我们将 $\\hat{A}$ 的表达式除以真实活度 $A_0$：\n$$\n\\frac{\\hat{A}}{A_0} = \\frac{A_0 \\exp\\left( L(\\mu_{\\text{u}} - \\mu_{\\text{soft}}f_{\\text{soft}} - \\mu_{\\text{lung}}f_{\\text{lung}}) \\right)}{A_0} = \\exp\\left( L(\\mu_{\\text{u}} - \\mu_{\\text{soft}}f_{\\text{soft}} - \\mu_{\\text{lung}}f_{\\text{lung}}) \\right)\n$$\n最后，将此结果代回相对偏差 $B$ 的定义中：\n$$\nB = \\exp\\left( L(\\mu_{\\text{u}} - \\mu_{\\text{soft}}f_{\\text{soft}} - \\mu_{\\text{lung}}f_{\\text{lung}}) \\right) - 1\n$$\n这个闭式表达式按要求将相对偏差表示为给定参数 $f_{\\mathrm{soft}}$、$f_{\\mathrm{lung}}$、$L$、$\\mu_{\\mathrm{soft}}$、$\\mu_{\\mathrm{lung}}$ 和 $\\mu_{\\mathrm{u}}$ 的函数。约束条件 $f_{\\text{soft}} + f_{\\text{lung}} = 1$ 在问题设定中已隐含使用，但最终表达式要求以两个路径分数来表示，因此无需进一步代换。", "answer": "$$\n\\boxed{\\exp\\left(L\\left(\\mu_{\\mathrm{u}} - \\mu_{\\mathrm{soft}} f_{\\mathrm{soft}} - \\mu_{\\mathrm{lung}} f_{\\mathrm{lung}}\\right)\\right) - 1}\n$$", "id": "4863672"}, {"introduction": "在获得准确的衰减图后，必须将这些信息整合到图像重建算法中。本练习 [@problem_id:4863718] 深入探讨了广泛使用的最大似然期望最大化 (ML-EM) 算法。通过一个简化的模型，您将亲手构建包含衰减因子的系统矩阵，并执行一次迭代计算，从而直观地理解衰减信息是如何在重建过程中直接影响体素活度值的恢复。", "problem": "一个单光子发射计算机断层成像（SPECT）系统从一个由两个体素组成的简单一维物体中采集了两个射束的投影数据。其正向模型假设计数是独立泊松分布的，其均值由发射活度的线积分给出，该线积分受到系统几何结构和沿路径的光子衰减的调制。具体来说，每个系统矩阵元素都编码了几何灵敏度和一个基于比尔-朗伯定律的衰减因子。考虑以下旨在为两个体素沿两个不同射束产生不同衰减的简化配置，其中距离是在均匀介质内沿每条射线路径测量的：\n- 线性衰减系数：$\\mu = 0.15\\,\\mathrm{cm}^{-1}$。\n- 射束 $i$ 和体素 $j$ 的路径长度：$L_{11} = 22\\,\\mathrm{cm}$，$L_{12} = 6\\,\\mathrm{cm}$，$L_{21} = 8\\,\\mathrm{cm}$，$L_{22} = 24\\,\\mathrm{cm}$。\n- 几何探测因子被视为相等并已归一化，因此几何结构对每个 $H_{ij}$ 的贡献是一个乘法因子 $1$。\n测得的投影计数为 $y_{1} = 1200$ 和 $y_{2} = 900$。用于最大似然期望最大化（ML-EM）的初始体素活度为 $x_{1}^{(0)} = 1000$ 和 $x_{2}^{(0)} = 1000$（任意活度单位）。\n\n从衰减的比尔-朗伯定律和发射断层成像的泊松测量模型出发，为此配置构建二乘二的系统矩阵元素 $H_{ij}$。然后，从泊松对数似然函数推导出发射断层成像（无背景项）的单次迭代 ML-EM 更新公式。最后，使用您推导的更新公式，计算一次迭代后的更新值 $x_{1}^{(1)}$。以任意活度单位表示您的最终数值，并将答案四舍五入到四位有效数字。", "solution": "用户希望我解决一个关于使用 ML-EM 算法进行 SPECT 重建的问题。\n\n这是我的计划：\n1.  **验证问题陈述**：我将仔细检查问题是否自洽、科学上合理且适定。\n2.  **步骤 1：提取已知条件**：我将逐字列出所有提供的数据点和参数。\n3.  **步骤 2：使用提取的已知条件进行验证**：我将检查是否存在任何科学缺陷、不一致或信息缺失。\n    - 问题描述了发射断层成像中的一个标准设置。\n    - 它提供了一个线性衰减系数 $\\mu$。\n    - 它给出了每个体素 $j$ 和投影射束 $i$ 的路径长度 $L_{ij}$。\n    - 它指明几何因子被归一化为 $1$。\n    - 它提供了测量计数 $y_i$。\n    - 它给出了体素活度的初始估计值 $x_j^{(0)}$。\n    - 任务是构建系统矩阵 $H$，推导 ML-EM 更新方程，并计算 $x_1^{(1)}$ 的一次迭代。\n    - 其基础物理学（比尔-朗伯定律，泊松统计）是该领域的标准。\n    - 问题似乎是适定的。它有明确的输入集，并要求一个特定的、可计算的输出。\n    - 语言客观而精确。\n    - 没有明显的缺陷。问题是有效的。\n\n4.  **如果有效（看起来是这样），则进行求解**：\n    - **第 1 部分：构建系统矩阵 H**。\n        - 问题陈述，系统矩阵元素 $H_{ij}$ 编码了几何灵敏度和一个衰减因子。\n        - 几何灵敏度作为一个因子 $1$ 给出。\n        - 衰减因子由比尔-朗伯定律导出：$A = \\exp(-\\mu L)$。\n        - 所以，$H_{ij} = (\\text{几何因子}) \\times (\\text{衰减因子}) = 1 \\times \\exp(-\\mu L_{ij})$。\n        - 我需要使用给定的 $\\mu$ 和 $L_{ij}$ 值计算四个元素 $H_{11}$、$H_{12}$、$H_{21}$ 和 $H_{22}$。\n        - $\\mu = 0.15\\,\\mathrm{cm}^{-1}$。\n        - $L_{11} = 22\\,\\mathrm{cm} \\implies H_{11} = \\exp(-0.15 \\times 22) = \\exp(-3.3)$。\n        - $L_{12} = 6\\,\\mathrm{cm} \\implies H_{12} = \\exp(-0.15 \\times 6) = \\exp(-0.9)$。\n        - $L_{21} = 8\\,\\mathrm{cm} \\implies H_{21} = \\exp(-0.15 \\times 8) = \\exp(-1.2)$。\n        - $L_{22} = 24\\,\\mathrm{cm} \\implies H_{22} = \\exp(-0.15 \\times 24) = \\exp(-3.6)$。\n\n    - **第 2 部分：推导 ML-EM 更新方程**。\n        - 正向模型由射束 $i$ 中的期望计数给出：$\\bar{y}_i = \\sum_{j} H_{ij} x_j$。\n        - 测量值 $y_i$ 被假定为均值为 $\\bar{y}_i$ 的独立泊松随机变量。\n        - 似然函数是 $L(x) = P(y|x) = \\prod_{i} \\frac{(\\bar{y}_i)^{y_i} \\exp(-\\bar{y}_i)}{y_i!}$。\n        - 对数似然函数是 $\\mathcal{L}(x) = \\ln(L(x)) = \\sum_{i} [y_i \\ln(\\bar{y}_i) - \\bar{y}_i - \\ln(y_i!)]$。\n        - 代入 $\\bar{y}_i = \\sum_{j} H_{ij} x_j$：\n          $\\mathcal{L}(x) = \\sum_{i} [y_i \\ln(\\sum_{j} H_{ij} x_j) - \\sum_{j} H_{ij} x_j] - \\sum_i \\ln(y_i!)$。\n        - 为了最大化此函数，我们将关于每个 $x_k$ 的偏导数设为零：\n          $\\frac{\\partial \\mathcal{L}}{\\partial x_k} = \\sum_{i} [y_i \\frac{H_{ik}}{\\sum_{j} H_{ij} x_j} - H_{ik}] = 0$。\n        - 这得到 $\\sum_{i} H_{ik} = \\sum_{i} \\frac{y_i H_{ik}}{\\sum_{j} H_{ij} x_j}$。\n        - 这是一个非线性方程组。ML-EM 算法提供了一个迭代解。\n        - ML-EM 更新规则的推导是一个标准结果。它来自于将期望最大化框架应用于这个“不完全数据”问题。\n        - 完全数据是从体素 $j$ 发射并在射束 $i$ 中检测到的光子数 $z_{ij}$。\n        - 更新规则是：\n          $x_j^{(k+1)} = \\frac{x_j^{(k)}}{\\sum_{i} H_{ij}} \\sum_{i} H_{ij} \\frac{y_i}{\\sum_{l} H_{il} x_l^{(k)}}$。\n        - 我应该清楚地陈述这个推导过程。\n          - 从对数似然函数开始：$\\mathcal{L}(x) = \\sum_i \\left( y_i \\ln(\\sum_j H_{ij} x_j) - \\sum_j H_{ij} x_j \\right)$（忽略常数项）。\n          - 对 $x_k$ 求导：$\\frac{\\partial \\mathcal{L}}{\\partial x_k} = \\sum_i \\left( \\frac{y_i H_{ik}}{\\sum_j H_{ij} x_j} - H_{ik} \\right)$。\n          - 设为零得到：$\\sum_i H_{ik} = \\sum_i \\frac{y_i H_{ik}}{\\sum_j H_{ij} x_j}$。\n          - ML-EM 算法提供了一个不动点迭代来解决这个问题。重排方程：\n            $1 = \\frac{1}{\\sum_i H_{ik}} \\sum_i \\frac{y_i H_{ik}}{\\sum_j H_{ij} x_j}$。\n            两边乘以 $x_k$：\n            $x_k = x_k \\frac{1}{\\sum_i H_{ik}} \\sum_i \\frac{y_i H_{ik}}{\\sum_j H_{ij} x_j}$。\n          - 这启发了迭代方案：\n            $x_k^{(k+1)} = \\frac{x_k^{(k)}}{\\sum_i H_{ik}} \\sum_i \\frac{y_i H_{ik}}{\\sum_j H_{ij} x_j^{(k)}}$。\n          - 这就是我需要使用的公式。\n\n    - **第 3 部分：计算更新值 $x_{1}^{(1)}$**。\n        - 问题要求计算 $x_{1}^{(1)}$。公式是：\n          $x_{1}^{(1)} = \\frac{x_{1}^{(0)}}{\\sum_{i=1}^{2} H_{i1}} \\sum_{i=1}^{2} H_{i1} \\frac{y_i}{\\sum_{j=1}^{2} H_{ij} x_j^{(0)}}$。\n        - 我拥有所有组件：\n            - $x_1^{(0)} = 1000$\n            - $x_2^{(0)} = 1000$\n            - $y_1 = 1200$\n            - $y_2 = 900$\n            - $H_{11} = \\exp(-3.3)$\n            - $H_{12} = \\exp(-0.9)$\n            - $H_{21} = \\exp(-1.2)$\n            - $H_{22} = \\exp(-3.6)$\n        - 让我们组合这些项。\n        - 外层求和的分母是体素 1 的灵敏度：$S_1 = \\sum_{i} H_{i1} = H_{11} + H_{21} = \\exp(-3.3) + \\exp(-1.2)$。\n        - 内层求和是当前估计值 $x^{(0)}$ 的正向投影：\n            - $\\bar{y}_1^{(0)} = \\sum_{j} H_{1j} x_j^{(0)} = H_{11} x_1^{(0)} + H_{12} x_2^{(0)} = 1000(\\exp(-3.3) + \\exp(-0.9))$。\n            - $\\bar{y}_2^{(0)} = \\sum_{j} H_{2j} x_j^{(0)} = H_{21} x_1^{(0)} + H_{22} x_2^{(0)} = 1000(\\exp(-1.2) + \\exp(-3.6))$。\n        - 现在把所有东西代入 $x_1^{(1)}$ 的公式中：\n          $x_{1}^{(1)} = \\frac{x_{1}^{(0)}}{S_1} \\left( H_{11} \\frac{y_1}{\\bar{y}_1^{(0)}} + H_{21} \\frac{y_2}{\\bar{y}_2^{(0)}} \\right)$\n          $x_{1}^{(1)} = \\frac{1000}{\\exp(-3.3) + \\exp(-1.2)} \\left( H_{11} \\frac{1200}{1000(\\exp(-3.3) + \\exp(-0.9))} + H_{21} \\frac{900}{1000(\\exp(-1.2) + \\exp(-3.6))} \\right)$\n          $x_{1}^{(1)} = \\frac{1000}{\\exp(-3.3) + \\exp(-1.2)} \\left( \\frac{1.2 \\exp(-3.3)}{\\exp(-3.3) + \\exp(-0.9)} + \\frac{0.9 \\exp(-1.2)}{\\exp(-1.2) + \\exp(-3.6)} \\right)$\n\n    - **第 4 部分：数值计算**。\n        - 我需要计算指数函数的值。\n        - $\\exp(-3.3) \\approx 0.036883$\n        - $\\exp(-0.9) \\approx 0.406570$\n        - $\\exp(-1.2) \\approx 0.301194$\n        - $\\exp(-3.6) \\approx 0.027324$\n        - 让我们用计算器检查这些值以获得更高精度。\n        - `exp(-3.3)` = 0.0368831671\n        - `exp(-0.9)` = 0.4065696597\n        - `exp(-1.2)` = 0.3011942119\n        - `exp(-3.6)` = 0.0273237224\n        - 现在，计算中间项：\n        - $S_1 = H_{11} + H_{21} = 0.0368831671 + 0.3011942119 = 0.338077379$\n        - $\\bar{y}_1^{(0)} = 1000 \\times (H_{11} + H_{12}) = 1000 \\times (0.0368831671 + 0.4065696597) = 1000 \\times 0.4434528268 = 443.4528268$\n        - $\\bar{y}_2^{(0)} = 1000 \\times (H_{21} + H_{22}) = 1000 \\times (0.3011942119 + 0.0273237224) = 1000 \\times 0.3285179343 = 328.5179343$\n        - 现在是括号内的两项：\n          - 第 1 项: $H_{11} \\frac{y_1}{\\bar{y}_1^{(0)}} = 0.0368831671 \\times \\frac{1200}{443.4528268} = 0.0368831671 \\times 2.7060375 = 0.0997972$\n          - 第 2 项: $H_{21} \\frac{y_2}{\\bar{y}_2^{(0)}} = 0.3011942119 \\times \\frac{900}{328.5179343} = 0.3011942119 \\times 2.7395698 = 0.8251578$\n          - 各项之和 = $0.0997972 + 0.8251578 = 0.924955$\n        - $x_1^{(1)}$ 的最终计算：\n          $x_1^{(1)} = \\frac{x_1^{(0)}}{S_1} \\times (\\text{各项之和}) = \\frac{1000}{0.338077379} \\times 0.924955$\n          $x_1^{(1)} = 2957.751 \\times 0.924955 = 2735.808...$\n\n        让我使用符号形式再次检查计算，以避免中间的舍入误差。\n        $x_{1}^{(1)} = \\frac{1000}{\\exp(-3.3) + \\exp(-1.2)} \\left( \\frac{1.2 \\exp(-3.3)}{\\exp(-3.3) + \\exp(-0.9)} + \\frac{0.9 \\exp(-1.2)}{\\exp(-1.2) + \\exp(-3.6)} \\right)$\n        设 $H_{11} = \\exp(-3.3)$，$H_{12} = \\exp(-0.9)$，$H_{21} = \\exp(-1.2)$，$H_{22} = \\exp(-3.6)$。\n        $x_1^{(0)} = 1000, x_2^{(0)}=1000$。$y_1=1200, y_2=900$。\n        $x_1^{(1)} = \\frac{x_1^{(0)}}{H_{11}+H_{21}} \\left( H_{11} \\frac{y_1}{H_{11}x_1^{(0)} + H_{12}x_2^{(0)}} + H_{21} \\frac{y_2}{H_{21}x_1^{(0)} + H_{22}x_2^{(0)}} \\right)$\n        因为 $x_1^{(0)} = x_2^{(0)} = 1000$：\n        $x_1^{(1)} = \\frac{1000}{H_{11} + H_{21}} \\left[ H_{11} \\frac{1200}{1000(H_{11} + H_{12})} + H_{21} \\frac{900}{1000(H_{21} + H_{22})} \\right]$\n        $x_1^{(1)} = \\frac{1000}{1000} \\frac{1}{H_{11} + H_{21}} \\left[ H_{11} \\frac{1200}{H_{11} + H_{12}} + H_{21} \\frac{900}{H_{21} + H_{22}} \\right]$\n        $x_1^{(1)} = \\frac{1}{H_{11} + H_{21}} \\left[ \\frac{1200 H_{11}}{H_{11} + H_{12}} + \\frac{900 H_{21}}{H_{21} + H_{22}} \\right]$。\n        在我的步骤3中，我错误地写出了 `$x_1^{(1)} = \\frac{1}{H_{11} + H_{21}} \\left[ H_{11} \\frac{1200}{H_{11} + H_{12}} + H_{21} \\frac{900}{H_{21} + H_{22}} \\right]$`，这遗漏了`1000`的乘积。\n        正确的推导是:\n        $x_1^{(1)} = \\frac{x_1^{(0)}}{S_1} \\sum_i H_{i1} \\frac{y_i}{\\bar{y}_i^{(0)}} = \\frac{1000}{S_1} \\left( H_{11}\\frac{1200}{1000(H_{11}+H_{12})} + H_{21}\\frac{900}{1000(H_{21}+H_{22})} \\right)$\n        $x_1^{(1)} = \\frac{1}{S_1} \\left( \\frac{1200 H_{11}}{H_{11}+H_{12}} + \\frac{900 H_{21}}{H_{21}+H_{22}} \\right)$\n        所以，我的简化 `$x_1^{(1)} = \\frac{1}{H_{11} + H_{21}} \\left[ H_{11} \\frac{1200}{H_{11} + H_{12}} + H_{21} \\frac{900}{H_{21} + H_{22}} \\right]$` 是正确的。\n        我将纠正我的解决方案文本，删除那个多余的步骤。\n\n        用这个确认过的表达式重新计算：\n          $H_{11} = \\exp(-3.3) \\approx 0.036883167$\n          $H_{12} = \\exp(-0.9) \\approx 0.406569660$\n          $H_{21} = \\exp(-1.2) \\approx 0.301194212$\n          $H_{22} = \\exp(-3.6) \\approx 0.027323722$\n          和 $H_{11}+H_{12} = 0.443452827$\n          和 $H_{21}+H_{22} = 0.328517934$\n          和 $H_{11}+H_{21} = 0.338077379$\n\n          第 1 项: $\\frac{1200 \\times H_{11}}{H_{11} + H_{12}} = \\frac{1200 \\times 0.036883167}{0.443452827} = \\frac{44.2598004}{0.443452827} = 99.79820$\n          第 2 项: $\\frac{900 \\times H_{21}}{H_{21} + H_{22}} = \\frac{900 \\times 0.301194212}{0.328517934} = \\frac{271.0747908}{0.328517934} = 825.14304$\n\n          分子中的各项之和 = $99.79820 + 825.14304 = 924.94124$\n\n          $x_1^{(1)} = \\frac{\\text{分子中的各项之和}}{H_{11} + H_{21}} = \\frac{924.94124}{0.338077379} = 2735.87...$\n\n          值为 2735.87。\n          问题要求四舍五入到四位有效数字。数字是 2、7、3、5。下一位是 8，所以我需要将 5 向上取整。它变成 2736。\n          \n          在解决方案文本中，我应该纠正这个部分：\n          `$x_1^{(1)} = \\frac{1}{H_{11} + H_{21}} \\left[ H_{11} \\frac{1200}{H_{11} + H_{12}} + H_{21} \\frac{900}{H_{21} + H_{22}} \\right]$`\n          `来自 $x_1^{(0)}$ 的因子 $1000$ 与来自正向投影项的因子 $1/1000$ 相抵消。这是因为初始估计是均匀的。`\n          `这个简化后的表达式就是我将用于最终计算的。`\n          这是错误的。`$x_1^{(0)}$` 的 `1000` 是在 `ML-EM` 更新方程中的。我的推导在第3部分是正确的，但在第4部分中试图简化时出错了。\n          让我重新审视`ML-EM`方程：`$x_j^{(k+1)} = \\frac{x_j^{(k)}}{\\sum_{i} H_{ij}} \\sum_{i} H_{ij} \\frac{y_i}{\\sum_{l} H_{il} x_l^{(k)}}$`\n          所以 `$x_1^{(1)} = \\frac{x_1^{(0)}}{\\sum_{i} H_{i1}} \\sum_{i} H_{i1} \\frac{y_i}{\\sum_{l} H_{il} x_l^{(0)}}$`\n          `$x_1^{(1)} = \\frac{1000}{H_{11}+H_{21}} \\left( H_{11} \\frac{1200}{1000(H_{11}+H_{12})} + H_{21} \\frac{900}{1000(H_{21}+H_{22})} \\right)$`\n          `$x_1^{(1)} = \\frac{1000}{1000} \\frac{1}{H_{11}+H_{21}} \\left( \\frac{1200 H_{11}}{H_{11}+H_{12}} + \\frac{900 H_{21}}{H_{21}+H_{22}} \\right)$`\n          `$x_1^{(1)} = \\frac{1}{H_{11}+H_{21}} \\left( \\frac{1200 H_{11}}{H_{11}+H_{12}} + \\frac{900 H_{21}}{H_{21}+H_{22}} \\right)$`\n          啊，是的，这个简化是正确的，因为`$x_1^{(0)}=x_2^{(0)}=1000$`。我的解决方案文本是正确的。我只是在复核时把自己弄糊涂了。没问题。\n          最终结果 2736 是正确的。\n          \n          因此，我不需要修改问题3的解决方案。", "answer": "$$\n\\boxed{2736}\n$$", "id": "4863718"}]}