{"hands_on_practices": [{"introduction": "平面闪烁成像的图像质量在很大程度上取决于其空间分辨率，即系统区分两个邻近放射源的能力。这个分辨率不是一成不变的，它由探测器固有的分辨能力和准直器的几何特性共同决定。本练习将引导您推导并计算系统分辨率如何随源与准直器距离的增加而下降，这是理解平行孔准直器成像局限性的一个关键实践。[@problem_id:4912264]", "problem": "一项平面闪烁显像研究使用配备了平行孔准直器的伽马相机进行。准直器的孔洞无角度且为直线，隔片足够厚以忽略隔片穿透，测得的点扩散函数主要由几何因素和探测器固有模糊决定。探测器的固有分辨率，以半高全宽（FWHM）表示，为 $R_{\\text{int}} = 3.5 \\text{ mm}$。准直器的孔径为 $d = 1.5 \\text{ mm}$，孔长为 $L = 25 \\text{ mm}$。考虑点源放置在距准直器表面轴向距离为 $z = 0 \\text{ cm}$、$z = 5 \\text{ cm}$ 和 $z = 10 \\text{ cm}$ 的位置。\n\n从平行孔准直器射线接收的基本几何考虑、小角度近似以及独立类高斯模糊的半高全宽（FWHM）以正交方式组合的定义出发，推导在每个指定距离 $z$ 处的准直器分辨率 $R_{\\text{col}}(z)$ 的表达式，然后推导系统分辨率 $R_{\\text{sys}}(z)$ 的表达式。计算在 $z = 0 \\text{ cm}$、$z = 5 \\text{ cm}$ 和 $z = 10 \\text{ cm}$ 时 $R_{\\text{sys}}(z)$ 的数值。最终答案以毫米为单位表示，并四舍五入至三位有效数字。按 $z = 0 \\text{ cm}$、$z = 5 \\text{ cm}$、$z = 10 \\text{ cm}$ 的顺序提供最终的三个值。", "solution": "该问题是有效的，因为它基于医学成像的科学原理，给出了所有必要信息，问题表述清晰，并以客观、正式的语言表达。它没有科学上的不健全、模糊或矛盾之处。因此，我们可以进行完整解答。\n\n该问题要求推导伽马相机系统的系统分辨率 $R_{\\text{sys}}(z)$，并在三个指定距离处计算其数值。总系统分辨率由准直器的几何分辨率 $R_{\\text{col}}(z)$ 和探测器的固有分辨率 $R_{\\text{int}}$ 组合决定。\n\n首先，我们推导平行孔准直器的几何分辨率 $R_{\\text{col}}(z)$ 的表达式。问题陈述我们应从基本几何考虑出发。距准直器表面距离为 $z$ 处的几何分辨率定义为点扩散函数（PSF）几何分量的半高全宽（FWHM）。根据互易原理，这等效于源平面上（距离为 $z$）某一区域的直径，从该区域发出的光子可以穿过单个准直器孔到达探测器晶体上的一个点。\n\n让我们考虑探测器晶体上位于单个准直器孔中心轴上的一个点。该孔的直径为 $d$，长度为 $L$。探测器点位于孔的一端（出口），孔的入口距离探测器为 $L$。源平面距离孔入口为 $z$。\n\n我们可以利用相似三角形来确定视场直径，该直径对应于 $R_{\\text{col}}(z)$。一个三角形的顶点在探测器点，其高为准直器长度 $L$，其底为孔入口的直径 $d$。第二个更大的三角形共享同一顶点。其高为从探测器到源平面的距离，即 $L+z$。其底为源平面上可以被探测器点“看到”的区域的直径，我们将其定义为 $R_{\\text{col}}(z)$。\n\n根据相似三角形的性质，底与高的比值是恒定的。因此，我们可以写出：\n$$\n\\frac{R_{\\text{col}}(z)}{L+z} = \\frac{d}{L}\n$$\n解出 $R_{\\text{col}}(z)$，我们得到准直器几何分辨率的表达式：\n$$\nR_{\\text{col}}(z) = d \\frac{L+z}{L} = d \\left(1 + \\frac{z}{L}\\right)\n$$\n该表达式表明，几何分辨率随着与准直器表面距离 $z$ 的增加而线性下降。在准直器表面处，即 $z=0$ 时，几何分辨率就是孔的直径，$R_{\\text{col}}(0) = d$。\n\n接下来，我们确定总系统分辨率 $R_{\\text{sys}}(z)$。问题陈述中提到，测得的点扩散函数主要由几何因素和探测器固有模糊决定，并且这些独立的类高斯模糊的半高全宽以正交方式组合。因此，总系统分辨率是各分量分辨率平方和的平方根：\n$$\nR_{\\text{sys}}(z) = \\sqrt{R_{\\text{col}}(z)^2 + R_{\\text{int}}^2}\n$$\n代入我们推导出的 $R_{\\text{col}}(z)$ 表达式：\n$$\nR_{\\text{sys}}(z) = \\sqrt{\\left(d \\frac{L+z}{L}\\right)^2 + R_{\\text{int}}^2}\n$$\n这就是系统分辨率作为距离 $z$ 的函数的一般表达式。\n\n现在，我们可以根据给定的参数计算数值：\n固有分辨率: $R_{\\text{int}} = 3.5 \\text{ mm}$\n准直器孔径: $d = 1.5 \\text{ mm}$\n准直器孔长: $L = 25 \\text{ mm}$\n\n距离单位必须一致。我们将给定的距离 $z$ 从厘米转换为毫米：\n$z_1 = 0 \\text{ cm} = 0 \\text{ mm}$\n$z_2 = 5 \\text{ cm} = 50 \\text{ mm}$\n$z_3 = 10 \\text{ cm} = 100 \\text{ mm}$\n\n我们现在为每个距离计算 $R_{\\text{sys}}(z)$。\n\n对于 $z = 0 \\text{ mm}$:\n首先，计算准直器分辨率 $R_{\\text{col}}(0)$:\n$$\nR_{\\text{col}}(0) = 1.5 \\text{ mm} \\times \\frac{25 \\text{ mm} + 0 \\text{ mm}}{25 \\text{ mm}} = 1.5 \\text{ mm}\n$$\n然后，计算系统分辨率 $R_{\\text{sys}}(0)$:\n$$\nR_{\\text{sys}}(0) = \\sqrt{(1.5 \\text{ mm})^2 + (3.5 \\text{ mm})^2} = \\sqrt{2.25 + 12.25} \\text{ mm} = \\sqrt{14.5} \\text{ mm} \\approx 3.807886... \\text{ mm}\n$$\n四舍五入到三位有效数字，我们得到 $R_{\\text{sys}}(0) = 3.81 \\text{ mm}$。\n\n对于 $z = 50 \\text{ mm}$:\n首先，计算准直器分辨率 $R_{\\text{col}}(50)$:\n$$\nR_{\\text{col}}(50) = 1.5 \\text{ mm} \\times \\frac{25 \\text{ mm} + 50 \\text{ mm}}{25 \\text{ mm}} = 1.5 \\text{ mm} \\times \\frac{75}{25} = 1.5 \\times 3 = 4.5 \\text{ mm}\n$$\n然后，计算系统分辨率 $R_{\\text{sys}}(50)$:\n$$\nR_{\\text{sys}}(50) = \\sqrt{(4.5 \\text{ mm})^2 + (3.5 \\text{ mm})^2} = \\sqrt{20.25 + 12.25} \\text{ mm} = \\sqrt{32.5} \\text{ mm} \\approx 5.700877... \\text{ mm}\n$$\n四舍五入到三位有效数字，我们得到 $R_{\\text{sys}}(50) = 5.70 \\text{ mm}$。\n\n对于 $z = 100 \\text{ mm}$:\n首先，计算准直器分辨率 $R_{\\text{col}}(100)$:\n$$\nR_{\\text{col}}(100) = 1.5 \\text{ mm} \\times \\frac{25 \\text{ mm} + 100 \\text{ mm}}{25 \\text{ mm}} = 1.5 \\text{ mm} \\times \\frac{125}{25} = 1.5 \\times 5 = 7.5 \\text{ mm}\n$$\n然后，计算系统分辨率 $R_{\\text{sys}}(100)$:\n$$\nR_{\\text{sys}}(100) = \\sqrt{(7.5 \\text{ mm})^2 + (3.5 \\text{ mm})^2} = \\sqrt{56.25 + 12.25} \\text{ mm} = \\sqrt{68.5} \\text{ mm} \\approx 8.276472... \\text{ mm}\n$$\n四舍五入到三位有效数字，我们得到 $R_{\\text{sys}}(100) = 8.28 \\text{ mm}$。\n\n在距离 $z=0 \\text{ cm}$、$z=5 \\text{ cm}$ 和 $z=10 \\text{ cm}$ 处，系统分辨率的最终计算值分别为 $3.81 \\text{ mm}$、$5.70 \\text{ mm}$ 和 $8.28 \\text{ mm}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 3.81  5.70  8.28 \\end{pmatrix}}\n$$", "id": "4912264"}, {"introduction": "在了解了成像系统的物理分辨率后，我们必须确保数字采集过程能够忠实地记录这些细节。如果像素过大，图像细节将会丢失，这种现象称为混叠。本练习将奈奎斯特-香农采样定理应用于闪烁成像，通过计算像素大小并评估其是否满足采样要求，来实践如何设置合适的采集矩阵以避免信息损失。[@problem_id:4912223]", "problem": "使用伽马相机进行平面闪烁显像采集，其方形视野（FOV）的一维尺寸为 $40\\,\\mathrm{cm}$。采集使用 $256\\times 256$ 的矩阵。伽马相机和准直器组件的系统空间分辨率（半高全宽）为 $R_{\\mathrm{sys}}=8\\,\\mathrm{mm}$。从奈奎斯特采样定理以及采样频率和像素大小的定义出发，推导为保证充分采样，连接像素大小 $p$ 和系统分辨率 $R_{\\mathrm{sys}}$ 的条件。然后计算像素大小 $p$（以 $\\mathrm{mm}$ 为单位表示 $p$）。最后，定义一个无量纲的充分性因子 $A$，在您推导的条件所隐含的充分性边界处该因子等于 $1$，并根据给定参数计算 $A$。仅报告 $A$ 的值作为最终数值答案，四舍五入到三位有效数字。最终数值答案必须是无量纲的。", "solution": "本问题将通过首先验证其前提，然后按照逻辑顺序步骤进行解决：1. 从奈奎斯特-香农定理推导采样充分性条件，2. 根据给定的采集系统参数计算像素大小，3. 定义一个无量纲的充分性因子，以及 4. 计算该因子的值。\n\n### 步骤1：问题验证\n\n问题陈述的验证如下：\n**逐字提取的已知条件：**\n- 伽马相机FOV尺寸：$40\\,\\mathrm{cm}$\n- 采集矩阵大小：$256\\times 256$\n- 系统空间分辨率（FWHM）：$R_{\\mathrm{sys}}=8\\,\\mathrm{mm}$\n- 任务1：从奈奎斯特采样定理出发，推导为保证充分采样，连接像素大小 $p$ 和系统分辨率 $R_{\\mathrm{sys}}$ 的条件。\n- 任务2：计算像素大小 $p$（以 $\\mathrm{mm}$ 为单位）。\n- 任务3：定义一个无量纲的充分性因子 $A$，在充分性边界处该因子等于 $1$。\n- 任务4：根据给定参数计算 $A$ 并四舍五入到三位有效数字。\n- 最终答案必须是无量纲的数值。\n\n**根据标准进行验证：**\n- **科学依据：** 该问题牢固地植根于数字信号处理应用于医学成像（特别是核医学）的原理。空间分辨率（FWHM）、像素大小和奈奎斯特采样定理等概念是该领域的标准。所提供的值对于临床伽马相机是现实的。该问题在科学上是合理的。\n- **适定性：** 问题陈述清晰，提供了推导条件和计算所需值的所有必要信息。任务是顺序性的且逻辑上相互关联，从而导出一个唯一且有意义的解。\n- **客观性：** 问题以精确、定量和无偏见的语言表述。没有主观或模棱两可的术语。\n- **完整性和一致性：** 已知条件（FOV、矩阵大小、分辨率）是充分且一致的。没有矛盾之处。\n- **可行性：** 参数描述了一个物理上现实的成像场景。\n\n**结论：**\n该问题被认为是有效的。将提供解答。\n\n### 步骤2：充分性条件的推导\n\n奈奎斯特-香农采样定理指出，为了无信息损失（即无混叠）地重构一个带限信号，采样频率 $f_s$ 必须至少是信号最大频率分量 $f_{\\text{max}}$ 的两倍。这表示为奈奎斯特准则：\n$$f_s \\ge 2 f_{\\text{max}}$$\n在空间成像的背景下，我们考虑空间频率，通常用 $k$ 表示。采样间隔是像素大小 $p$。空间采样频率 $k_s$ 是像素大小的倒数：\n$$k_s = \\frac{1}{p}$$\n因此，空间域中的奈奎斯特准则是：\n$$\\frac{1}{p} \\ge 2 k_{\\text{max}}$$\n这可以重新排列以定义无混叠采样的最大允许像素大小：\n$$p \\le \\frac{1}{2 k_{\\text{max}}}$$\n下一步是将信号的最大空间频率 $k_{\\text{max}}$ 与系统的空间分辨率 $R_{\\mathrm{sys}}$ 联系起来。系统分辨率，以点扩散函数（PSF）的半高全宽（FWHM）给出，会使图像模糊，因此起到低通滤波器的作用，限制了最终图像的高频内容。一个分辨率为 $R_{\\mathrm{sys}}$ 的系统无法解析远小于此尺寸的细节。\n\n虽然具有类高斯PSF的成像系统在技术上会通过所有频率（其调制传递函数，或MTF，也是一个从不为零的高斯函数），但我们必须定义一个有效的最大频率 $k_{\\text{max}}$，它包含了系统传递的重要信息。在医学成像中，一个标准的惯例是将 $k_{\\text{max}}$ 与空间分辨率的倒数联系起来。我们将待采样信号的有效最大频率定义为：\n$$k_{\\text{max}} = \\frac{1}{R_{\\mathrm{sys}}}$$\n这个惯例将最高相关频率与等于系统FWHM的空间周期联系起来。将这个 $k_{\\text{max}}$ 的表达式代入像素大小的奈奎斯特条件中，得到：\n$$p \\le \\frac{1}{2 \\left(\\frac{1}{R_{\\mathrm{sys}}}\\right)}$$\n$$p \\le \\frac{R_{\\mathrm{sys}}}{2}$$\n这就是推导出的充分采样条件。它表明像素大小 $p$ 必须小于或等于系统空间分辨率 $R_{\\mathrm{sys}}$ 的一半。这等效于要求至少有两个像素跨越系统分辨率的FWHM。\n\n### 步骤3：像素大小 $p$ 的计算\n\n像素大小 $p$ 由视野（FOV）和采集矩阵的大小决定。已知条件是：\n- FOV尺寸 $L = 40\\,\\mathrm{cm} = 400\\,\\mathrm{mm}$\n- 沿一维的像素数 $N = 256$\n\n像素大小 $p$ 计算为FOV长度与像素数的比值：\n$$p = \\frac{L}{N} = \\frac{400\\,\\mathrm{mm}}{256}$$\n$$p = \\frac{100}{64}\\,\\mathrm{mm} = \\frac{25}{16}\\,\\mathrm{mm} = 1.5625\\,\\mathrm{mm}$$\n\n### 步骤4：充分性因子 $A$ 的定义和计算\n\n问题要求一个无量纲的充分性因子 $A$，在充分性边界处等于 $1$。在步骤2中推导的边界条件是：\n$$p = \\frac{R_{\\mathrm{sys}}}{2}$$\n为了定义一个在此边界处等于 $1$ 的因子 $A$，我们可以将方程重新排列为：\n$$1 = \\frac{R_{\\mathrm{sys}}}{2p}$$\n因此，我们将充分性因子 $A$ 定义为：\n$$A = \\frac{R_{\\mathrm{sys}}}{2p}$$\n该因子是无量纲的，因为它是两个长度的比值。对于充分采样（$p \\le R_{\\mathrm{sys}}/2$），该因子 $A \\ge 1$。对于不充分采样（$p  R_{\\mathrm{sys}}/2$），$A  1$。\n\n现在，我们使用给定参数计算 $A$ 的值：\n- 系统分辨率 $R_{\\mathrm{sys}} = 8\\,\\mathrm{mm}$\n- 计算出的像素大小 $p = 1.5625\\,\\mathrm{mm}$\n\n将这些值代入 $A$ 的定义中：\n$$A = \\frac{8\\,\\mathrm{mm}}{2 \\times 1.5625\\,\\mathrm{mm}}$$\n$$A = \\frac{8}{3.125}$$\n$$A = 2.56$$\n问题要求答案四舍五入到三位有效数字。计算值 $2.56$ 已经恰好是三位有效数字。", "answer": "$$\\boxed{2.56}$$", "id": "4912223"}, {"introduction": "从采集到的图像中获得准确的定量信息是核医学诊断的核心目标之一。然而，原始图像数据中包含了由光子散射等物理过程产生的非目标计数，必须予以校正。本练习将带您实践一种常用的散射校正技术——双能窗法，并进一步探讨如何评估校正后数据的统计不确定性，这对于理解最终测量结果的可靠性至关重要。[@problem_id:4912245]", "problem": "使用一台伽马相机进行平面闪烁显像采集，该相机使用一个以主伽马射线发射为中心的光峰能量窗和一个低能散射窗。在一个均匀的感兴趣区域 (ROI) 中，测得的光峰窗计数为 $C_{p}$，测得的低能窗计数为 $L$。一项独立的能量校准研究提供了一个经验确定的比例常数 $k$，它将光峰窗中的散射与低能窗的活度关联起来，同时还给出了与 $k$ 相关的标准不确定度 $u_{k}$。假设单次静态采集的测量数据如下：$C_{p} = 64{,}000$ 计数，$L = 18{,}000$ 计数，$k = 0.45$，$u_{k} = 0.02$ (无量纲)。\n\n从计数统计和采集方案的基础出发，使用以下原理：\n- 在光子计数中，稳态条件下，固定时间间隔内探测到的事件数服从泊松分布，其均值等于其方差。\n- 当脉冲堆积和串扰可忽略不计时，在不重叠能量窗中记录的计数可被建模为独立的泊松随机变量。\n- 通过减去从低能窗推断出的散射贡献的比例估计，构建真实光峰计数的线性估计量。\n\n使用这些原理，首先构建校正后光峰计数的估计量，然后在独立性假设下，通过一阶泰勒展开（不确定度传播定律）推导校正后计数的组合标准不确定度。将 $C_{p}$ 和 $L$ 视为泊松随机变量，将 $k$ 视为具有不确定度 $u_{k}$ 的独立校准参数。\n\n计算校正后计数的组合标准不确定度，并以计数为单位表示您的答案。将最终数值结果四舍五入至四位有效数字。仅报告以计数为单位的组合标准不确定度值作为最终答案。", "solution": "该问题具有科学依据，提法恰当，并包含足够的信息以获得唯一解。它描述了核医学成像中的一种标准散射校正技术（双能量窗法），并正确地援引了泊松计数统计和不确定度传播的原理。因此，该问题是有效的，并将推导求解。\n\n目标是计算经过散射校正的光峰计数的组合标准不确定度。首先，我们构建这些校正后计数的估计量。设 $C_{true}$ 为真实（原始）光峰计数的估计量。测得的光峰窗计数 $C_p$ 包含真实计数和散射光子的贡献。问题陈述，使用一个线性估计量来校正这种散射，其中散射贡献是根据低能散射窗中的计数 $L$ 估计的。该关系由比例常数 $k$ 定义。\n\n光峰窗中散射计数的估计值由乘积 $kL$ 给出。因此，真实计数的估计量是测得的光峰计数减去估计的散射计数：\n$$ C_{true} = C_p - kL $$\n量 $C_{true}$ 是三个测量或校准量（$C_p$，$L$ 和 $k$）的函数。这些量中的每一个都有相关的不确定度。问题要求我们将 $C_p$ 和 $L$ 视为独立的泊松随机变量，将 $k$ 视为具有给定标准不确定度 $u_k$ 的独立校准参数。\n\n为了求出 $C_{true}$ 的组合标准不确定度，我们使用从一阶泰勒级数展开推导出的不确定度传播定律。对于一个由独立随机变量 $X_i$ 构成的函数 $f(X_1, X_2, \\ldots, X_n)$，其方差（表示为 $\\sigma_f^2$）可近似为：\n$$ \\sigma_f^2 \\approx \\sum_{i=1}^{n} \\left( \\frac{\\partial f}{\\partial X_i} \\right)^2 \\sigma_{X_i}^2 $$\n其中 $\\sigma_{X_i}^2$ 是变量 $X_i$ 的方差。\n\n在我们的例子中，函数是 $C_{true}(C_p, L, k)$，变量是 $C_p$、$L$ 和 $k$。我们必须首先确定每个变量的方差：\n1. 对于光峰计数 $C_p$：问题陈述光子计数服从泊松分布，其方差等于均值。计数均值的最佳估计是测量值本身。因此，$C_p$ 的方差为 $\\sigma_{C_p}^2 = C_p$。\n2. 对于低能窗计数 $L$：同样，$L$ 是一个泊松随机变量，所以其方差为 $\\sigma_L^2 = L$。\n3. 对于散射常数 $k$：这是一个给定的参数，具有指定的标准不确定度 $u_k$。因此，其方差为 $\\sigma_k^2 = u_k^2$。\n\n接下来，我们计算 $C_{true}$ 对每个变量的偏导数：\n$$ \\frac{\\partial C_{true}}{\\partial C_p} = \\frac{\\partial}{\\partial C_p}(C_p - kL) = 1 $$\n$$ \\frac{\\partial C_{true}}{\\partial L} = \\frac{\\partial}{\\partial L}(C_p - kL) = -k $$\n$$ \\frac{\\partial C_{true}}{\\partial k} = \\frac{\\partial}{\\partial k}(C_p - kL) = -L $$\n\n现在我们将这些导数和方差代入不确定度传播公式，以求出 $C_{true}$ 的方差，记为 $\\sigma_{C_{true}}^2$：\n$$ \\sigma_{C_{true}}^2 = \\left(\\frac{\\partial C_{true}}{\\partial C_p}\\right)^2 \\sigma_{C_p}^2 + \\left(\\frac{\\partial C_{true}}{\\partial L}\\right)^2 \\sigma_L^2 + \\left(\\frac{\\partial C_{true}}{\\partial k}\\right)^2 \\sigma_k^2 $$\n$$ \\sigma_{C_{true}}^2 = (1)^2 (C_p) + (-k)^2 (L) + (-L)^2 (u_k^2) $$\n$$ \\sigma_{C_{true}}^2 = C_p + k^2 L + L^2 u_k^2 $$\n\n校正后计数的组合标准不确定度 $u_c(C_{true})$ 是方差的平方根：\n$$ u_c(C_{true}) = \\sqrt{C_p + k^2 L + L^2 u_k^2} $$\n\n我们已知以下数值：\n$C_{p} = 64000$ 计数\n$L = 18000$ 计数\n$k = 0.45$ (无量纲)\n$u_{k} = 0.02$ (无量纲)\n\n将这些值代入不确定度方程：\n$$ u_c(C_{true}) = \\sqrt{64000 + (0.45)^2(18000) + (18000)^2(0.02)^2} $$\n\n让我们计算平方根内的各项：\n来自光峰计数方差的贡献是 $C_p = 64000$。\n来自低能窗计数方差、通过 $k$ 传播的贡献是 $k^2 L = (0.2025)(18000) = 3645$。\n来自散射常数 $k$ 不确定度的贡献是 $L^2 u_k^2 = (18000)^2(0.02)^2 = (324 \\times 10^6)(0.0004) = 129600$。\n\n将这些项相加得到总方差：\n$$ \\sigma_{C_{true}}^2 = 64000 + 3645 + 129600 = 197245 $$\n\n组合标准不确定度是该值的平方根：\n$$ u_c(C_{true}) = \\sqrt{197245} \\approx 444.12273 \\text{ 计数} $$\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$ u_c(C_{true}) \\approx 444.1 \\text{ 计数} $$\n该值表示校正后光峰计数的组合标准不确定度。", "answer": "$$\n\\boxed{444.1}\n$$", "id": "4912245"}]}