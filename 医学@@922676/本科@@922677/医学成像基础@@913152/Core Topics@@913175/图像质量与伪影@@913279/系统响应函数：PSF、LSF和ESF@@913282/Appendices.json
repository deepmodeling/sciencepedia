{"hands_on_practices": [{"introduction": "本练习将作为您理解系统响应函数的基础。您将学习如何从一个二维的点扩散函数 (PSF) 出发，通过积分运算得到其一维的线扩散函数 (LSF)。通过进一步计算 LSF 的半峰全宽 (FWHM)，您将掌握一种量化图像分辨率的关键方法，并直观地理解系统模糊的物理意义 [@problem_id:4929894]。", "problem": "一个平面成像系统可以局部地建模为移位不变系统，其二维点扩展函数 (PSF) 定义为一个非负可积函数 $h(x,y)$，它描述了一个理想点源的图像。沿 $x$ 轴的线扩展函数 (LSF) 定义为 $l(x)=\\int_{-\\infty}^{\\infty} h(x,y)\\,dy$，沿 $x$ 轴的边扩展函数 (ESF) 定义为 $e(x)=\\int_{-\\infty}^{x} l(u)\\,du$。在本问题中，PSF是各向同性且呈高斯分布，具有未知的尺度参数 $s>0$，具体为\n$$\nh(x,y)=\\frac{1}{2\\pi s^{2}}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2s^{2}}\\right).\n$$\n假设 $h$ 是归一化的，使得 $\\int_{\\mathbb{R}^{2}} h(x,y)\\,dx\\,dy=1$。使用一维模糊的二阶矩定义，\n$$\n\\sigma_{x}^{2}=\\frac{\\int_{-\\infty}^{\\infty} x^{2}\\,l(x)\\,dx}{\\int_{-\\infty}^{\\infty} l(x)\\,dx},\n$$\n推导与给定PSF相对应的$x$轴LSF的模糊标准差 $\\sigma_{x}$ 的显式表达式。然后，推导该LSF的半峰全宽 (FWHM) 并将其明确地表示为 $\\sigma_{x}$ 的函数。以闭式形式提供你的最终答案，即序对 $\\left(\\sigma_{x},\\mathrm{FWHM}\\right)$。不需要数值近似，也不应包含单位。", "solution": "用户希望我解决以下问题：\n 一个平面成像系统可以局部地建模为移位不变系统，其二维点扩展函数 (PSF) 定义为一个非负可积函数 $h(x,y)$，它描述了一个理想点源的图像。沿 $x$ 轴的线扩展函数 (LSF) 定义为 $l(x)=\\int_{-\\infty}^{\\infty} h(x,y)\\,dy$，沿 $x$ 轴的边扩展函数 (ESF) 定义为 $e(x)=\\int_{-\\infty}^{x} l(u)\\,du$。在本问题中，PSF是各向同性且呈高斯分布，具有未知的尺度参数 $s>0$，具体为\n$$\nh(x,y)=\\frac{1}{2\\pi s^{2}}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2s^{2}}\\right).\n$$\n假设 $h$ 是归一化的，使得 $\\int_{\\mathbb{R}^{2}} h(x,y)\\,dx\\,dy=1$。使用一维模糊的二阶矩定义，\n$$\n\\sigma_{x}^{2}=\\frac{\\int_{-\\infty}^{\\infty} x^{2}\\,l(x)\\,dx}{\\int_{-\\infty}^{\\infty} l(x)\\,dx},\n$$\n推导与给定PSF相对应的$x$轴LSF的模糊标准差 $\\sigma_{x}$ 的显式表达式。然后，推导该LSF的半峰全宽 (FWHM) 并将其明确地表示为 $\\sigma_{x}$ 的函数。以闭式形式提供你的最终答案，即序对 $\\left(\\sigma_{x},\\mathrm{FWHM}\\right)$。不需要数值近似，也不应包含单位。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 点扩展函数 (PSF): $h(x,y)=\\frac{1}{2\\pi s^{2}}\\exp\\left(-\\frac{x^{2}+y^{2}}{2s^{2}}\\right)$, 其中 $s>0$。\n- 线扩展函数 (LSF) 定义: $l(x)=\\int_{-\\infty}^{\\infty} h(x,y)\\,dy$。\n- 边扩展函数 (ESF) 定义: $e(x)=\\int_{-\\infty}^{x} l(u)\\,du$。\n- 归一化条件: $\\int_{\\mathbb{R}^{2}} h(x,y)\\,dx\\,dy=1$。\n- 模糊方差定义: $\\sigma_{x}^{2}=\\frac{\\int_{-\\infty}^{\\infty} x^{2}\\,l(x)\\,dx}{\\int_{-\\infty}^{\\infty} l(x)\\,dx}$。\n- 任务：推导 $l(x)$ 的 $\\sigma_x$ 和半峰全宽 (FWHM) 的表达式，并提供序对 $(\\sigma_x, \\text{FWHM})$作为最终答案。在推导过程中，FWHM 也应表示为 $\\sigma_x$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：**该问题使用了应用于医学成像的线性系统理论中的点扩展函数 (PSF)、线扩展函数 (LSF) 和边扩展函数 (ESF) 的标准定义。高斯函数是PSF的一个常见且有效的模型。模糊的二阶矩定义是色散的标准度量。\n- **适定性：**所有必要的函数和定义都已明确给出。问题要求推导可以从给定信息中得出的特定量（$\\sigma_x$ 和 FWHM）。\n- **客观性：**问题以精确的数学语言陈述，没有任何主观性。\n- **一致性检查：**归一化条件 $\\int_{\\mathbb{R}^{2}} h(x,y)\\,dx\\,dy=1$ 与给定的PSF一致。我们可以使用标准高斯积分 $\\int_{-\\infty}^{\\infty} \\exp(-au^2) du = \\sqrt{\\pi/a}$ 来验证这一点。\n$$\n\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\frac{1}{2\\pi s^{2}}\\exp\\left(-\\frac{x^{2}+y^{2}}{2s^{2}}\\right)\\,dx\\,dy = \\frac{1}{2\\pi s^{2}} \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2s^2}\\right) dx \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{y^2}{2s^2}\\right) dy \\right)\n$$\n对于每个积分，$a = 1/(2s^2)$，所以积分的计算结果为 $\\sqrt{\\pi/(1/2s^2)} = \\sqrt{2\\pi s^2} = s\\sqrt{2\\pi}$。\n$$\n\\int_{\\mathbb{R}^{2}} h(x,y)\\,dx\\,dy = \\frac{1}{2\\pi s^{2}} (s\\sqrt{2\\pi})(s\\sqrt{2\\pi}) = \\frac{2\\pi s^2}{2\\pi s^2} = 1\n$$\n归一化是正确的。问题是自洽且一致的。\n\n### 步骤 3：结论与行动\n问题是有效的。我将继续进行解答。\n\n求解过程需要三个主要步骤：\n1. 推导线扩展函数 $l(x)$。\n2. 使用 $l(x)$ 计算模糊标准差 $\\sigma_x$。\n3. 使用 $l(x)$ 计算半峰全宽 (FWHM) 并将其表示为 $\\sigma_x$ 的函数。\n\n**1. 线扩展函数 (LSF) 的推导**\n\nLSF, $l(x)$, 被定义为PSF, $h(x,y)$, 对 $y$ 维度的积分。\n$$\nl(x) = \\int_{-\\infty}^{\\infty} h(x,y) \\, dy = \\int_{-\\infty}^{\\infty} \\frac{1}{2\\pi s^{2}}\\exp\\left(-\\frac{x^{2}+y^{2}}{2s^{2}}\\right) \\, dy\n$$\n我们可以分离指数项，并提出不依赖于 $y$ 的部分：\n$$\nl(x) = \\frac{1}{2\\pi s^{2}} \\exp\\left(-\\frac{x^{2}}{2s^{2}}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{y^{2}}{2s^{2}}\\right) \\, dy\n$$\n关于 $y$ 的积分是一个标准高斯积分。如在验证步骤中计算的，其值为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{y^{2}}{2s^{2}}\\right) \\, dy = s\\sqrt{2\\pi}\n$$\n将此结果代回 $l(x)$ 的表达式：\n$$\nl(x) = \\frac{1}{2\\pi s^{2}} \\exp\\left(-\\frac{x^{2}}{2s^{2}}\\right) (s\\sqrt{2\\pi}) = \\frac{s\\sqrt{2\\pi}}{2\\pi s^2} \\exp\\left(-\\frac{x^{2}}{2s^{2}}\\right)\n$$\n简化前置因子得到LSF的最终形式：\n$$\nl(x) = \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^{2}}{2s^{2}}\\right)\n$$\n这是一维高斯（或正态）分布的概率密度函数 (PDF)，其均值为 $\\mu=0$，标准差为 $s$。\n\n**2. 模糊标准差 ($\\sigma_x$) 的推导**\n\n模糊方差 $\\sigma_x^2$ 定义为：\n$$\n\\sigma_{x}^{2}=\\frac{\\int_{-\\infty}^{\\infty} x^{2}\\,l(x)\\,dx}{\\int_{-\\infty}^{\\infty} l(x)\\,dx}\n$$\n首先，我们计算分母，即LSF在其定义域上的积分。由于 $l(x)$ 是一个正确归一化的高斯PDF，其积分必须为 $1$。我们来验证一下：\n$$\n\\int_{-\\infty}^{\\infty} l(x)\\,dx = \\int_{-\\infty}^{\\infty} \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^{2}}{2s^{2}}\\right) \\, dx = \\frac{1}{s\\sqrt{2\\pi}} (s\\sqrt{2\\pi}) = 1\n$$\n分母等于 $1$，方差的表达式简化为：\n$$\n\\sigma_{x}^{2} = \\int_{-\\infty}^{\\infty} x^{2}\\,l(x)\\,dx\n$$\n根据定义，该积分是由 $l(x)$ 描述的概率分布的二阶中心矩（即方差）。对于一个一般的正态分布 $N(\\mu, \\sigma^2)$，方差是 $\\sigma^2$。我们的LSF, $l(x)$, 是一个均值为 $\\mu=0$、方差为 $s^2$ 的正态分布 $N(0, s^2)$。因此，积分的计算结果为 $s^2$。\n$$\n\\sigma_{x}^{2} = s^2\n$$\n取平方根，并注意到给定条件 $s>0$，我们得到模糊标准差：\n$$\n\\sigma_x = s\n$$\n\n**3. 半峰全宽 (FWHM) 的推导**\n\nFWHM是函数 $l(x)$ 在其最大值一半处的宽度。\n首先，找到 $l(x)$ 的最大值，该值出现在 $x=0$ 处：\n$$\nl_{\\max} = l(0) = \\frac{1}{s\\sqrt{2\\pi}} \\exp(0) = \\frac{1}{s\\sqrt{2\\pi}}\n$$\n接下来，我们找到使 $l(x)$ 等于此最大值一半的 $x$ 值：\n$$\nl(x) = \\frac{1}{2} l_{\\max} \\implies \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^{2}}{2s^{2}}\\right) = \\frac{1}{2} \\left( \\frac{1}{s\\sqrt{2\\pi}} \\right)\n$$\n简化此方程得到：\n$$\n\\exp\\left(-\\frac{x^{2}}{2s^{2}}\\right) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-\\frac{x^{2}}{2s^{2}} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n解出 $x^2$：\n$$\nx^2 = 2s^2 \\ln(2)\n$$\n这给出了 $x$ 的两个解：\n$$\nx = \\pm \\sqrt{2s^2 \\ln(2)} = \\pm s\\sqrt{2\\ln(2)}\n$$\nFWHM是这两点之间的距离：\n$$\n\\mathrm{FWHM} = \\left(s\\sqrt{2\\ln(2)}\\right) - \\left(-s\\sqrt{2\\ln(2)}\\right) = 2s\\sqrt{2\\ln(2)}\n$$\n问题还要求将FWHM明确表示为 $\\sigma_x$ 的函数。从我们之前的推导可知，$\\sigma_x = s$。将此代入FWHM表达式：\n$$\n\\mathrm{FWHM} = 2\\sigma_x\\sqrt{2\\ln(2)}\n$$\n这是任何高斯函数的一个众所周知的通用关系。\n\n**结论**\n\n我们已经推导出模糊标准差 $\\sigma_x = s$ 和半峰全宽 $\\mathrm{FWHM} = 2s\\sqrt{2\\ln(2)}$。最终答案是使用给定参数 $s$ 以闭式形式表示的序对 $(\\sigma_x, \\mathrm{FWHM})$。\n\n该序对是 $(\\sigma_x, \\mathrm{FWHM}) = (s, 2s\\sqrt{2\\ln(2)})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} s & 2s\\sqrt{2\\ln(2)} \\end{pmatrix}}\n$$", "id": "4929894"}, {"introduction": "理论与实践在此交汇，本题将引导您从成像物理的第一性原理出发，理解边缘扩散函数 (ESF) 是如何通过理想物体与系统点扩散函数 (PSF) 的卷积而产生的。您将通过对推导出的 ESF 进行微分，来获得线扩散函数 (LSF)，从而验证这两个关键函数之间的微积分关系。这个练习将加深您对三维成像系统中，从物体到最终响应函数之间完整链条的认识 [@problem_id:4929904]。", "problem": "一个用于医学成像的成像系统被建模为一个线性移不变系统。物体 $f(x,y,z)$ 的测量图像 $g(x,y,z)$ 通过三维卷积与点扩散函数 (PSF) $h(x,y,z)$ 相关\n$$\ng(x,y,z) = \\iiint f(x',y',z')\\, h(x - x', y - y', z - z')\\, dx' \\, dy' \\, dz'.\n$$\n点扩散函数 (PSF) 被定义为一个可分离的、各向异性的、归一化的三维高斯函数，\n$$\nh(x,y,z) = \\frac{1}{(2\\pi)^{3/2}\\, \\sigma_x \\sigma_y \\sigma_z} \\exp\\!\\left(-\\frac{x^{2}}{2\\sigma_x^{2}} - \\frac{y^{2}}{2\\sigma_y^{2}} - \\frac{z^{2}}{2\\sigma_z^{2}}\\right),\n$$\n其中 $\\sigma_x$、$\\sigma_y$ 和 $\\sigma_z$ 是描述平面内和穿透平面模糊宽度的正常数，且归一化确保 $\\iiint h(x,y,z)\\, dx\\, dy\\, dz = 1$。考虑一个物体 $f(x,y,z)$，它是在穿透平面方向 $z$ 上的一个均匀半空间“阶跃”，定义为\n$$\nf(x,y,z) = I_0\\, H(z),\n$$\n其中 $I_0 > 0$ 是一个恒定的物体强度，$H(z)$ 是 Heaviside 阶跃函数，当 $z \\ge 0$ 时 $H(z) = 1$，当 $z  0$ 时 $H(z) = 0$。仅使用卷积和PSF的定义，推导穿透平面边缘扩散函数 (ESF) $E(z)$，该函数定义为系统对该阶跃物体沿 $z$ 方向的响应。然后通过对 $E(z)$ 关于 $z$求导，计算穿透平面线扩散函数 (LSF) $L(z)$。将 $L(z)$ 的最终结果表示为包含 $I_0$ 和 $\\sigma_z$ 的单个闭合形式解析表达式。不需要进行数值计算。", "solution": "首先对问题进行验证，以确保其科学性、适定性和客观性。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 系统是线性移不变 (LSI) 的。\n- 物体 $f(x,y,z)$ 的测量图像 $g(x,y,z)$ 是其与点扩散函数 (PSF) $h(x,y,z)$ 的三维卷积：\n$g(x,y,z) = \\iiint f(x',y',z')\\, h(x - x', y - y', z - z')\\, dx' \\, dy' \\, dz'$.\n- PSF 是一个可分离的、各向异性的、归一化的三维高斯函数：\n$h(x,y,z) = \\frac{1}{(2\\pi)^{3/2}\\, \\sigma_x \\sigma_y \\sigma_z} \\exp\\!\\left(-\\frac{x^{2}}{2\\sigma_x^{2}} - \\frac{y^{2}}{2\\sigma_y^{2}} - \\frac{z^{2}}{2\\sigma_z^{2}}\\right)$，其中 $\\sigma_x, \\sigma_y, \\sigma_z$ 是正常数。归一化确保 $\\iiint h(x,y,z)\\, dx\\, dy\\, dz = 1$。\n- 物体是一个均匀半空间：$f(x,y,z) = I_0\\, H(z)$，其中 $I_0  0$ 是一个常数，$H(z)$ 是 Heaviside 阶跃函数（当 $z \\ge 0$ 时 $H(z) = 1$，当 $z  0$ 时 $H(z) = 0$）。\n- 穿透平面边缘扩散函数 (ESF) $E(z)$ 定义为系统对该阶跃物体沿 $z$ 方向的响应。\n- 穿透平面线扩散函数 (LSF) $L(z)$ 通过对 ESF 求导得到: $L(z) = \\frac{dE(z)}{dz}$。\n- $L(z)$ 的最终表达式必须用 $I_0$ 和 $\\sigma_z$ 表示。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题很好地基于应用于医学成像的线性系统理论原理。PSF、LSI 系统、卷积、ESF 和 LSF 的概念及其相互关系是该领域的基础。使用高斯 PSF 和阶跃函数物体是系统表征的标准模型。\n- **适定性**：该问题提供了执行所需推导的所有必要定义和函数。任务规定明确，可导出一个唯一的解析解。\n- **客观性**：该问题使用精确的数学语言陈述，没有任何主观或模糊的术语。\n\n**步骤3：结论与行动**\n- **结论**：该问题有效。它是医学成像基础中的一个标准且定义明確的问题。\n- **行动**：继续进行详细求解。\n\n**边缘扩散函数 (ESF) 的推导**\n\n测量图像 $g(x,y,z)$ 由物体 $f(x,y,z)$ 和 PSF $h(x,y,z)$ 的卷积给出：\n$$\ng(x,y,z) = \\iiint_{-\\infty}^{\\infty} f(x',y',z') h(x - x', y - y', z - z')\\, dx' \\, dy' \\, dz'\n$$\n代入 $f(x,y,z)$ 和 $h(x,y,z)$ 的给定表达式：\n$$\ng(x,y,z) = \\iiint_{-\\infty}^{\\infty} I_0 H(z') \\frac{1}{(2\\pi)^{3/2} \\sigma_x \\sigma_y \\sigma_z} \\exp\\left(-\\frac{(x-x')^{2}}{2\\sigma_x^{2}} - \\frac{(y-y')^{2}}{2\\sigma_y^{2}} - \\frac{(z-z')^{2}}{2\\sigma_z^{2}}\\right) dx' dy' dz'\n$$\n由于函数是可分离的，我们可以将积分重排为三个一维积分的乘积：\n$$\ng(x,y,z) = \\frac{I_0}{(2\\pi)^{3/2} \\sigma_x \\sigma_y \\sigma_z} \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x-x')^{2}}{2\\sigma_x^{2}}\\right) dx' \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(y-y')^{2}}{2\\sigma_y^{2}}\\right) dy' \\right) \\left( \\int_{-\\infty}^{\\infty} H(z') \\exp\\left(-\\frac{(z-z')^{2}}{2\\sigma_z^{2}}\\right) dz' \\right)\n$$\n前两个积分是标准高斯积分：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(u-u_0)^{2}}{2\\sigma^{2}}\\right) du = \\sqrt{2\\pi} \\sigma\n$$\n将此应用于关于 $x'$ 和 $y'$ 的积分：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x-x')^{2}}{2\\sigma_x^{2}}\\right) dx' = \\sqrt{2\\pi} \\sigma_x\n$$\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(y-y')^{2}}{2\\sigma_y^{2}}\\right) dy' = \\sqrt{2\\pi} \\sigma_y\n$$\n将这些结果代回 $g(x,y,z)$ 的表达式中：\n$$\ng(x,y,z) = \\frac{I_0}{(2\\pi)^{3/2} \\sigma_x \\sigma_y \\sigma_z} (\\sqrt{2\\pi} \\sigma_x) (\\sqrt{2\\pi} \\sigma_y) \\int_{-\\infty}^{\\infty} H(z') \\exp\\left(-\\frac{(z-z')^{2}}{2\\sigma_z^{2}}\\right) dz'\n$$\n简化前面的系数：\n$$\ng(x,y,z) = I_0 \\frac{1}{\\sqrt{2\\pi} \\sigma_z} \\int_{-\\infty}^{\\infty} H(z') \\exp\\left(-\\frac{(z-z')^{2}}{2\\sigma_z^{2}}\\right) dz'\n$$\nHeaviside 函数 $H(z')$ 将 $z'$ 积分的下限限制为 $0$：\n$$\ng(x,y,z) = I_0 \\int_{0}^{\\infty} \\frac{1}{\\sqrt{2\\pi} \\sigma_z} \\exp\\left(-\\frac{(z-z')^{2}}{2\\sigma_z^{2}}\\right) dz'\n$$\n结果与 $x$ 和 $y$ 无关，这对于在 $xy$ 平面内均匀的物体是符合预期的。穿透平面 ESF，$E(z)$，即是此响应：\n$$\nE(z) = I_0 \\int_{0}^{\\infty} \\frac{1}{\\sqrt{2\\pi} \\sigma_z} \\exp\\left(-\\frac{(z-z')^{2}}{2\\sigma_z^{2}}\\right) dz'\n$$\n为计算此积分，我们使用变量替换。令 $u = \\frac{z' - z}{\\sigma_z}$，则 $dz' = \\sigma_z du$。$u$ 的积分限变为：\n- 当 $z' = 0$ 时，$u = \\frac{0 - z}{\\sigma_z} = -\\frac{z}{\\sigma_z}$。\n- 当 $z' \\to \\infty$ 时，$u \\to \\infty$。\n$E(z)$ 的积分变为：\n$$\nE(z) = I_0 \\int_{-z/\\sigma_z}^{\\infty} \\frac{1}{\\sqrt{2\\pi} \\sigma_z} \\exp\\left(-\\frac{u^{2}}{2}\\right) (\\sigma_z du) = I_0 \\int_{-z/\\sigma_z}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{u^{2}}{2}\\right) du\n$$\n此积分与标准正态分布的累积分布函数 (CDF) 相关，$\\Phi(x) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{x} \\exp(-\\frac{t^2}{2}) dt$。\n对于概率分布，使用性质 $\\int_{a}^{\\infty} g(u)\\,du = 1 - \\int_{-\\infty}^{a} g(u)\\,du$，我们得到：\n$$\nE(z) = I_0 \\left(1 - \\Phi\\left(-\\frac{z}{\\sigma_z}\\right)\\right)\n$$\n由于高斯分布的对称性，$\\Phi(-x) = 1 - \\Phi(x)$。因此：\n$$\nE(z) = I_0 \\left(1 - \\left[1 - \\Phi\\left(\\frac{z}{\\sigma_z}\\right)\\right]\\right) = I_0 \\Phi\\left(\\frac{z}{\\sigma_z}\\right)\n$$\n用误差函数 $\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}}\\int_{0}^{x}\\exp(-t^2)dt$ 表示，其中 $\\Phi(x) = \\frac{1}{2}\\left[1 + \\text{erf}\\left(\\frac{x}{\\sqrt{2}}\\right)\\right]$，ESF 为：\n$$\nE(z) = \\frac{I_0}{2} \\left[1 + \\text{erf}\\left(\\frac{z}{\\sqrt{2}\\sigma_z}\\right)\\right]\n$$\n\n**线扩散函数 (LSF) 的推导**\n\n穿透平面 LSF，$L(z)$，定义为 ESF 对 $z$ 的导数：\n$$\nL(z) = \\frac{dE(z)}{dz} = \\frac{d}{dz} \\left( \\frac{I_0}{2} \\left[1 + \\text{erf}\\left(\\frac{z}{\\sqrt{2}\\sigma_z}\\right)\\right] \\right)\n$$\n导数为：\n$$\nL(z) = \\frac{I_0}{2} \\frac{d}{dz} \\left[ \\text{erf}\\left(\\frac{z}{\\sqrt{2}\\sigma_z}\\right) \\right]\n$$\n使用链式法则和误差函数的导数 $\\frac{d}{dx}\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}}\\exp(-x^2)$：\n$$\nL(z) = \\frac{I_0}{2} \\left[ \\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(\\frac{z}{\\sqrt{2}\\sigma_z}\\right)^2\\right) \\right] \\cdot \\frac{d}{dz}\\left(\\frac{z}{\\sqrt{2}\\sigma_z}\\right)\n$$\n参数的导数为 $\\frac{d}{dz}\\left(\\frac{z}{\\sqrt{2}\\sigma_z}\\right) = \\frac{1}{\\sqrt{2}\\sigma_z}$。\n将其代回：\n$$\nL(z) = \\frac{I_0}{2} \\left[ \\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) \\right] \\cdot \\left( \\frac{1}{\\sqrt{2}\\sigma_z} \\right)\n$$\n简化表达式：\n$$\nL(z) = \\frac{I_0}{\\sqrt{\\pi}} \\exp\\left(-\\frac{z^{2}}{2\\sigma_z^{2}}\\right) \\frac{1}{\\sqrt{2}\\sigma_z}\n$$\n$$\nL(z) = \\frac{I_0}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{z^{2}}{2\\sigma_z^{2}}\\right)\n$$\n这是穿透平面线扩散函数的最终表达式。它是一个一维高斯函数，振幅为 $\\frac{I_0}{\\sqrt{2\\pi}\\sigma_z}$，标准差为 $\\sigma_z$，这与 LSF 作为系统对理想线源（或片源）响应的物理解释是一致的。", "answer": "$$\\boxed{\\frac{I_0}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{z^{2}}{2\\sigma_z^{2}}\\right)}$$", "id": "4929904"}, {"introduction": "在掌握了 ESF 与 LSF 之间的理论关系后，我们必须面对一个现实挑战：测量数据中不可避免的噪声。本练习将深入探讨为何通过微分从 ESF 计算 LSF 的过程会放大高频噪声，其本质上是一种高通滤波行为。通过推导方差膨胀因子，您不仅能从数学上量化这种噪声放大效应，更能深刻体会到在处理真实成像数据时，理论模型与实际应用之间的重要差异 [@problem_id:4929943]。", "problem": "在一维成像系统中，测得的边缘扩散函数 (ESF) 是由理想单位阶跃边缘与系统的点扩散函数 (PSF) 卷积，然后以均匀间距采样形成的。设在空间采样点 $x = n \\Delta$ 处的采样 ESF 表示为 $e[n]$，其中 $\\Delta$ 是采样间距。假设测得的 ESF 包含方差为 $\\sigma_w^{2}$ 的加性、零均值、独立白噪声 $w[n]$，因此 $e[n] = s[n] + w[n]$，其中 $s[n]$ 是由理想边缘与 PSF 卷积形成的无噪声 ESF。线扩散函数 (LSF) 是通过对 ESF 在空间坐标上求导得到的。\n\n从傅里叶变换和线性时不变系统的基本定义出发，并且除了这些基础知识外不引用任何专门的公式，解释为什么通过对 ESF 求导以获得 LSF 的过程会对噪声起到高通滤波器的作用。然后，通过中心差分算子对用于计算离散 LSF 的数值微分进行建模\n$$\nD_{\\Delta}\\{e\\}[n] = \\frac{e[n+1] - e[n-1]}{2 \\Delta}.\n$$\n将白噪声 $w[n]$ 视为在各样本间独立同分布，其方差为 $\\sigma_w^{2}$。将方差膨胀因子 (VIF) 定义为比率\n$$\n\\text{VIF} = \\frac{\\operatorname{Var}\\left(D_{\\Delta}\\{w\\}[n]\\right)}{\\operatorname{Var}\\left(w[n]\\right)}.\n$$\n推导出仅用 $\\Delta$ 表示的 $\\text{VIF}$ 的精确解析表达式。设采样间距 $\\Delta$ 的单位为毫米，并注意方差膨胀因子的单位是 $\\text{mm}^{-2}$；但是，最终的框内答案请以仅包含 $\\Delta$ 的符号表达式形式给出，不带单位。", "solution": "该问题提法恰当，具有科学依据且内部一致。解决该问题所需的所有信息均已提供。我们将继续进行解答，解答分为两部分：首先，解释为什么微分起到高通滤波器的作用；其次，推导方差膨胀因子 (VIF)。\n\n**第一部分：微分的高通滤波效应**\n\n一个在给定域（例如空间域 $x$）中的函数与其在频域（例如空间频率域 $k$）中的表示之间的关系由傅里叶变换给出。对边缘扩散函数 (ESF)（我们称之为 $e(x)$）进行微分以获得线扩散函数 (LSF) $l(x)$ 的操作定义为 $l(x) = \\frac{d}{dx}e(x)$。\n\n我们在频域中分析此操作的效果。设 $E(k)$ 和 $L(k)$ 分别是 $e(x)$ 和 $l(x)$ 的傅里叶变换。傅里叶变换的一个基本性质是微分性质，该性质指出如果 $\\mathcal{F}\\{f(x)\\} = F(k)$，那么\n$$\n\\mathcal{F}\\left\\{\\frac{d^n f(x)}{dx^n}\\right\\} = (i 2 \\pi k)^n F(k)\n$$\n对于一阶导数（$n=1$），LSF 和 ESF 的傅里叶变换之间的关系是：\n$$\nL(k) = (i 2 \\pi k) E(k)\n$$\n这意味着空间域中的微分操作等效于在频域中乘以一个传递函数 $H(k) = i 2 \\pi k$。\n\n此传递函数的幅度 $|H(k)|$ 决定了每个频率分量的振幅如何被缩放。我们有：\n$$\n|H(k)| = |i 2 \\pi k| = 2 \\pi |k|\n$$\n函数 $|H(k)|$ 是一个线性斜坡，对于直流分量（$k=0$）从 $0$ 开始，并随着空间频率的绝对值 $|k|$ 线性增加。根据定义，一个衰减低频并放大高频的操作是高通滤波器。因此，理想微分是一种高通滤波操作。\n\n在离散情况下，我们得到了导数的一个数值近似，即中心差分算子：\n$$\nD_{\\Delta}\\{e\\}[n] = \\frac{e[n+1] - e[n-1]}{2 \\Delta}\n$$\n此操作可以看作是输入信号 $e[n]$ 与一个离散滤波器核 $h[n]$ 的卷积。在索引 $n$ 处的输出是 $n$ 周围输入样本的加权和。滤波器核由 $h[n] = \\frac{1}{2\\Delta}\\delta[n+1] - \\frac{1}{2\\Delta}\\delta[n-1]$ 给出。更精确地说，设 $y[n] = D_{\\Delta}\\{e\\}[n]$，则 $y[n] = \\sum_{m=-\\infty}^{\\infty} h[m] e[n-m]$。滤波器系数为 $h[-1] = \\frac{1}{2\\Delta}$，$h[1] = -\\frac{1}{2\\Delta}$，且对于所有其他 $m$，$h[m]=0$。\n\n这个离散滤波器的频率响应由其离散时间傅里叶变换 (DTFT) 给出：\n$$\nH(\\omega) = \\sum_{n=-\\infty}^{\\infty} h[n] e^{-i \\omega n} = h[-1]e^{i\\omega} + h[1]e^{-i\\omega}\n$$\n代入系数：\n$$\nH(\\omega) = \\frac{1}{2\\Delta}e^{i\\omega} - \\frac{1}{2\\Delta}e^{-i\\omega} = \\frac{1}{2\\Delta}(e^{i\\omega} - e^{-i\\omega})\n$$\n使用欧拉恒等式 $\\sin(\\omega) = \\frac{e^{i\\omega} - e^{-i\\omega}}{2i}$，我们可以写出：\n$$\nH(\\omega) = \\frac{1}{2\\Delta}(2i \\sin(\\omega)) = \\frac{i}{\\Delta}\\sin(\\omega)\n$$\n其中 $\\omega = 2\\pi k \\Delta$ 是归一化角频率。中心差分算子的幅度响应是：\n$$\n|H(\\omega)| = \\left|\\frac{i}{\\Delta}\\sin(\\omega)\\right| = \\frac{1}{\\Delta}|\\sin(\\omega)|\n$$\n对于低频，$\\omega \\to 0$，我们可以使用近似 $\\sin(\\omega) \\approx \\omega$。因此，$|H(\\omega)| \\approx \\frac{|\\omega|}{\\Delta} = \\frac{2\\pi|k|\\Delta}{\\Delta} = 2\\pi|k|$，这与理想连续域微分器的行为相匹配。响应在 $\\omega=0$（直流）处为零，并随着 $|\\omega|$ 的增加而增加，在 $|\\omega| = \\pi/2$ 处达到最大值。这证实了中心差分算子，像理想导数一样，起到高通滤波器的作用。\n\n白噪声 $w[n]$ 的特点是其功率谱是平坦的，意味着其能量均匀分布在所有频率上。当此噪声通过微分滤波器时，输出噪声功率谱由 $|H(\\omega)|^2 = \\frac{1}{\\Delta^2}\\sin^2(\\omega)$ 塑造。最终得到的谱在低频处功率较低，在高频处功率较高。高频分量的这种放大，就是为什么微分使得 LSF 中的噪声比 ESF 中的噪声更显著的原因。\n\n**第二部分：方差膨胀因子的推导**\n\n方差膨胀因子 (VIF) 定义为：\n$$\n\\text{VIF} = \\frac{\\operatorname{Var}\\left(D_{\\Delta}\\{w\\}[n]\\right)}{\\operatorname{Var}\\left(w[n]\\right)}\n$$\n分母已知为 $\\operatorname{Var}\\left(w[n]\\right) = \\sigma_w^2$。我们需要计算分子 $\\operatorname{Var}\\left(D_{\\Delta}\\{w\\}[n]\\right)$。\n\n微分后的噪声为：\n$$\nD_{\\Delta}\\{w\\}[n] = \\frac{w[n+1] - w[n-1]}{2 \\Delta}\n$$\n我们计算其方差：\n$$\n\\operatorname{Var}\\left(D_{\\Delta}\\{w\\}[n]\\right) = \\operatorname{Var}\\left(\\frac{w[n+1] - w[n-1]}{2 \\Delta}\\right)\n$$\n利用方差的性质 $\\operatorname{Var}(aX) = a^2 \\operatorname{Var}(X)$，其中 $a$ 是一个常数，我们有 $a = \\frac{1}{2\\Delta}$：\n$$\n\\operatorname{Var}\\left(D_{\\Delta}\\{w\\}[n]\\right) = \\left(\\frac{1}{2\\Delta}\\right)^2 \\operatorname{Var}\\left(w[n+1] - w[n-1]\\right) = \\frac{1}{4\\Delta^2} \\operatorname{Var}\\left(w[n+1] - w[n-1]\\right)\n$$\n对于两个随机变量 $A$ 和 $B$ 之差的方差，公式为 $\\operatorname{Var}(A - B) = \\operatorname{Var}(A) + \\operatorname{Var}(B) - 2\\operatorname{Cov}(A, B)$。令 $A = w[n+1]$ 和 $B = w[n-1]$。所以，\n$$\n\\operatorname{Var}\\left(w[n+1] - w[n-1]\\right) = \\operatorname{Var}\\left(w[n+1]\\right) + \\operatorname{Var}\\left(w[n-1]\\right) - 2\\operatorname{Cov}\\left(w[n+1], w[n-1]\\right)\n$$\n问题陈述噪声 $w[n]$ 是一个*独立*且*同分布*（i.i.d.）的随机变量序列。\n1.  因为随机变量是*同分布*的，方差为 $\\sigma_w^2$，所以我们有 $\\operatorname{Var}(w[n+1]) = \\sigma_w^2$ 和 $\\operatorname{Var}(w[n-1]) = \\sigma_w^2$。\n2.  因为不同样本的随机变量是*独立*的，它们的协方差为零。由于 $n+1 \\neq n-1$，随机变量 $w[n+1]$ 和 $w[n-1]$ 是独立的，因此 $\\operatorname{Cov}(w[n+1], w[n-1]) = 0$。\n\n将这些代入表达式中：\n$$\n\\operatorname{Var}\\left(w[n+1] - w[n-1]\\right) = \\sigma_w^2 + \\sigma_w^2 - 2(0) = 2\\sigma_w^2\n$$\n现在我们可以完成微分后噪声方差的计算：\n$$\n\\operatorname{Var}\\left(D_{\\Delta}\\{w\\}[n]\\right) = \\frac{1}{4\\Delta^2} (2\\sigma_w^2) = \\frac{\\sigma_w^2}{2\\Delta^2}\n$$\n最后，我们将此结果和给定的输入方差代入 VIF 的定义中进行计算：\n$$\n\\text{VIF} = \\frac{\\frac{\\sigma_w^2}{2\\Delta^2}}{\\sigma_w^2} = \\frac{1}{2\\Delta^2}\n$$\n该表达式给出了 VIF 仅用采样间距 $\\Delta$ 表示的精确解析形式。该结果量化了由于数值微分过程导致的噪声方差的放大。对于更小的采样间距 $\\Delta$，VIF 会变得更大，这表明更精细的采样使得微分过程更容易受到噪声放大的影响。", "answer": "$$\\boxed{\\frac{1}{2\\Delta^{2}}}$$", "id": "4929943"}]}