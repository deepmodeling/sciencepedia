{"hands_on_practices": [{"introduction": "脉冲回波原理是所有超声成像系统的基石。本练习将带您从第一性原理出发，推导如何利用测量到的回波时间延迟来计算目标的距离 [@problem_id:4935238]。通过进一步分析时间测量的不确定性如何转化为距离的不确定性，您将深刻理解决定系统轴向分辨率的关键因素。", "problem": "一个在均匀软组织中工作的单元超声换能器，沿声束方向探测一个未知轴向距离的平面反射体。发射的压力脉冲以速度 $c$ 在组织中传播，其回波经过测得的往返延迟 $\\Delta t$ 后返回换能器。时间拾取（回波到达时间的估计）由于噪声和接收链路的有限带宽，存在一个标准不确定度 $\\sigma_{t}$。\n\n仅从速度是路径长度与传播时间之比的定义，以及在脉冲回波测量中回波会两次穿过该路径这一事实出发，推导轴向距离 $r$ 关于 $c$ 和 $\\Delta t$ 的表达式，并推导由 $\\sigma_{t}$ 引起的相应轴向距离不确定度 $\\sigma_{r}$。假设 $c$ 是常数，介质是静止的，并且可以忽略折射、色散和脉冲压缩效应。将 $\\sigma_{t}$ 视为远小于 $\\Delta t$，并使用一阶不确定度传播方法。\n\n使用数值 $\\Delta t = 130\\ \\mu\\mathrm{s}$、 $c = 1540\\ \\mathrm{m/s}$ 和 $\\sigma_{t} = 50\\ \\mathrm{ns}$。计算目标距离和轴向距离不确定度。简要评论 $\\sigma_{t}$ 如何影响脉冲回波测距中的轴向分辨率。将你的最终数值答案报告为轴向距离不确定度，四舍五入到四位有效数字并以微米表示。", "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 一个单元超声换能器在均匀软组织中工作。\n- 它探测一个未知轴向距离 $r$ 的平面反射体。\n- 发射的压力脉冲以速度 $c$ 传播。\n- 测得的往返延迟为 $\\Delta t$。\n- 回波到达时间的标准不确定度为 $\\sigma_t$。\n- 速度的定义是路径长度与传播时间之比。\n- 回波两次穿过路径（脉冲回波测量）。\n- 假设：$c$ 是常数，介质是静止的，折射、色散和脉冲压缩效应可以忽略。\n- $\\sigma_t$ 远小于 $\\Delta t$。\n- 必须使用一阶不确定度传播方法。\n- 数值：$\\Delta t = 130\\ \\mu\\mathrm{s}$， $c = 1540\\ \\mathrm{m/s}$， $\\sigma_{t} = 50\\ \\mathrm{ns}$。\n- 要求输出：\n  1. 轴向距离 $r$ 关于 $c$ 和 $\\Delta t$ 的表达式。\n  2. 由 $\\sigma_t$ 引起的相应轴向距离不确定度 $\\sigma_r$ 的表达式。\n  3. 目标距离 $r$ 和轴向距离不确定度 $\\sigma_r$ 的数值。\n  4. 关于 $\\sigma_t$ 如何影响轴向分辨率的简要评论。\n  5. $\\sigma_r$ 的最终答案必须四舍五入到四位有效数字，并以微米表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证清单评估问题。\n- **科学依据**：该问题基于脉冲回波系统（如超声、声纳和雷达）中使用的基本飞行时间原理。软组织中的声速值 $c = 1540\\ \\mathrm{m/s}$ 是标准的、临床公认的平均值。不确定度传播的使用是实验物理学和工程学中进行误差分析的标准方法。该问题在科学上是合理的。\n- **适定性**：该问题提供了所有必要信息和一组明确的假设，以推导出唯一且有意义的解。问题具体，可直接从已知条件中得到答案。\n- **客观性**：问题以精确、定量且无偏见的技术语言陈述。\n- **缺陷分析**：\n  1. 不存在科学上或事实上的不合理之处。\n  2. 该问题是医学成像物理学中一个可形式化的经典例子。\n  3. 设置是完整且一致的。\n  4. 物理条件和数据值对于医用超声是现实的。\n  5. 问题结构良好，可导出一个唯一的解。\n  6. 该问题是一个标准的、非平凡的练习，旨在测试基本理解。\n  7. 结果是科学可验证的。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 求解推导\n\n分析过程首先推导距离及其不确定度的表达式，然后进行数值计算。\n\n首先，我们推导轴向距离 $r$ 的表达式。问题陈述，速度 $c$ 定义为路径长度 $d$ 与传播时间 $t$ 之比。对于脉冲回波测量，超声脉冲从换能器传播到反射体，然后再返回。到反射体的距离是 $r$。因此，脉冲走过的总路径长度是 $d = 2r$。这次往返的总时间是测得的延迟 $\\Delta t$。根据速度的定义：\n$$c = \\frac{\\text{total path length}}{\\text{total travel time}} = \\frac{2r}{\\Delta t}$$\n对该方程求解轴向距离 $r$ 可得所需表达式：\n$$r = \\frac{c \\Delta t}{2}$$\n\n接下来，我们推导轴向距离不确定度 $\\sigma_r$ 的表达式。问题指定使用一阶不确定度传播方法。距离 $r$ 是测量的时间延迟 $\\Delta t$ 的函数，而声速 $c$ 被假定为一个没有不确定度的已知常数。关系式为 $r(\\Delta t) = \\frac{c \\Delta t}{2}$。\n对于函数 $y = f(x)$，不确定度传播的通用公式为 $\\sigma_y^2 \\approx \\left(\\frac{df}{dx}\\right)^2 \\sigma_x^2$，其中 $\\sigma_x$ 是 $x$ 的不确定度，$\\sigma_y$ 是由此产生的 $y$ 的不确定度。在这里，我们的函数是 $r(\\Delta t)$，具有不确定度的变量是 $\\Delta t$（标准不确定度为 $\\sigma_t$），产生的不确定度是 $\\sigma_r$。\n应用该公式，我们有：\n$$\\sigma_r^2 = \\left(\\frac{dr}{d(\\Delta t)}\\right)^2 \\sigma_t^2$$\n我们计算 $r$ 对 $\\Delta t$ 的导数：\n$$\\frac{dr}{d(\\Delta t)} = \\frac{d}{d(\\Delta t)} \\left(\\frac{c \\Delta t}{2}\\right) = \\frac{c}{2}$$\n将此导数代回不确定度传播方程：\n$$\\sigma_r^2 = \\left(\\frac{c}{2}\\right)^2 \\sigma_t^2$$\n对两边取平方根，得到轴向距离的标准不确定度：\n$$\\sigma_r = \\sqrt{\\left(\\frac{c}{2}\\right)^2 \\sigma_t^2} = \\frac{c}{2} \\sigma_t$$\n这就是所要求的轴向距离不确定度的表达式。\n\n现在，我们使用所提供的数据计算 $r$ 和 $\\sigma_r$ 的数值：\n$c = 1540\\ \\mathrm{m/s}$\n$\\Delta t = 130\\ \\mu\\mathrm{s} = 130 \\times 10^{-6}\\ \\mathrm{s}$\n$\\sigma_t = 50\\ \\mathrm{ns} = 50 \\times 10^{-9}\\ \\mathrm{s}$\n\n轴向距离 $r$ 为：\n$$r = \\frac{(1540\\ \\mathrm{m/s}) \\times (130 \\times 10^{-6}\\ \\mathrm{s})}{2} = \\frac{200200 \\times 10^{-6}\\ \\mathrm{m}}{2} = 100100 \\times 10^{-6}\\ \\mathrm{m} = 0.1001\\ \\mathrm{m}$$\n这等价于 $10.01\\ \\mathrm{cm}$。\n\n轴向距离不确定度 $\\sigma_r$ 为：\n$$\\sigma_r = \\frac{1540\\ \\mathrm{m/s}}{2} \\times (50 \\times 10^{-9}\\ \\mathrm{s}) = (770\\ \\mathrm{m/s}) \\times (50 \\times 10^{-9}\\ \\mathrm{s}) = 38500 \\times 10^{-9}\\ \\mathrm{m} = 3.85 \\times 10^{-5}\\ \\mathrm{m}$$\n问题要求将此值以微米（$\\mu\\mathrm{m}$）表示。因为 $1\\ \\mathrm{m} = 10^6\\ \\mu\\mathrm{m}$，我们有：\n$$\\sigma_r = 3.85 \\times 10^{-5}\\ \\mathrm{m} \\times \\frac{10^6\\ \\mu\\mathrm{m}}{1\\ \\mathrm{m}} = 38.5\\ \\mu\\mathrm{m}$$\n按要求四舍五入到四位有效数字，得到 $38.50\\ \\mu\\mathrm{m}$。\n\n最后，评论一下 $\\sigma_t$ 对轴向分辨率的影响。轴向分辨率指的是沿声束轴线，能将两个反射体分辨为独立对象的最小间距。回波到达时间的不确定度 $\\sigma_t$ 会导致计算出的反射体位置存在不确定度 $\\sigma_r = \\frac{c\\sigma_t}{2}$。这个距离不确定度 $\\sigma_r$ 代表了定位任何单个目标的精度的基本限制。因此，如果两个目标之间的距离与 $\\sigma_r$ 相当或更小，它们估计的位置将会被“模糊”到一定程度，以至于它们的表征会合并，从而无法区分。因此，更小的时间不确定度 $\\sigma_t$（可通过更短的脉冲和更高带宽的电子设备实现）直接导致更小的距离不确定度 $\\sigma_r$，从而改善（即减小最小分辨距离）轴向分辨率。", "answer": "$$\n\\boxed{38.50}\n$$", "id": "4935238"}, {"introduction": "在理想模型之外，真实的生物组织通常具有分层结构，这会导致复杂的多次反射，即“混响”伪影。本练习模拟了超声脉冲在软组织和骨骼界面间的混响过程，要求您分析回波序列的幅度和时序 [@problem_id:4935269]。通过计算这种混响如何系统性地偏移基于能量的飞行时间估计值，您将了解伪影如何导致深度测量的偏差。", "problem": "一个非聚焦、垂直入射的超声脉冲被发射到一个覆盖在半无限皮质骨上、厚度为 $d$ 的平面均匀软组织层中。该脉冲回波系统以中心频率 $f$ 工作，并在换能器表面检测返回的压力波。假设平面波传播、线性声学，并且所有界面都是平行的且为垂直入射。软组织的声阻抗为 $Z_{\\mathrm{t}}$，骨骼的声阻抗为 $Z_{\\mathrm{b}}$。软组织表现出频率相关的振幅衰减，其特征为 $0.5\\,\\mathrm{dB/cm/MHz}$，并假定其与频率成线性关系。由于强反射意味着穿透深度很小，因此骨骼在此范围内被视为无损耗。由于不完美匹配，换能器-组织边界处的压力反射系数幅值为 $r_{\\mathrm{T}}$ (非零)，并且换能器发射到组织中的振幅是一个固定的参考值，因此所有计算出的回波振幅都可以相对于该发射振幅来表示。\n\n使用以下参数值：$d = 3.0\\,\\mathrm{mm}$，$f = 5.0\\,\\mathrm{MHz}$，$Z_{\\mathrm{t}} = 1.6\\times 10^{6}\\,\\mathrm{kg/(m^{2}\\,s)}$，$Z_{\\mathrm{b}} = 7.8\\times 10^{6}\\,\\mathrm{kg/(m^{2}\\,s)}$，$r_{\\mathrm{T}} = 0.20$，软组织声速 $c_{\\mathrm{t}} = 1540\\,\\mathrm{m/s}$。\n\n任务：\n1) 从声阻抗和飞行时间 (ToF) 的定义，以及垂直入射平面波的边界条件出发，推导由软组织-骨骼界面和换能器-层内混响产生的一系列回波在换能器处的到达时间 $t_{n}$ 和相对压力振幅 $p_{n}$ 的表达式，其中 $n = 1, 2, 3, \\dots$。\n\n2) 定义能量质心ToF估计器 $T_{\\mathrm{c}}$ 为\n$$\nT_{\\mathrm{c}} \\equiv \\frac{\\sum_{n=1}^{\\infty} I_{n}\\, t_{n}}{\\sum_{n=1}^{\\infty} I_{n}},\n$$\n其中 $I_{n}$ 与 $|p_{n}|^{2}$ 成正比。使用第1部分的表达式，计算表观深度估计 $d_{\\mathrm{app}} \\equiv \\frac{c_{\\mathrm{t}}\\,T_{\\mathrm{c}}}{2}$ 的数值。\n\n根据你推导的振幅序列，定性讨论在各种ToF估计（首个超阈值拾取器、最大振幅拾取器以及上面定义的能量质心）中，哪些回波占主导地位。\n\n将你最终报告的 $d_{\\mathrm{app}}$ 四舍五入到四位有效数字，并以毫米表示。", "solution": "用户希望我扮演一名STEM教授，解决一个医学影像领域的问题。\n\n**1. 问题验证**\n\n首先根据指定标准对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   层厚度: $d = 3.0\\,\\mathrm{mm}$\n-   中心频率: $f = 5.0\\,\\mathrm{MHz}$\n-   软组织声阻抗: $Z_{\\mathrm{t}} = 1.6\\times 10^{6}\\,\\mathrm{kg/(m^{2}\\,s)}$\n-   皮质骨声阻抗: $Z_{\\mathrm{b}} = 7.8\\times 10^{6}\\,\\mathrm{kg/(m^{2}\\,s)}$\n-   换能器-组织边界处的压力反射系数幅值: $r_{\\mathrm{T}} = 0.20$\n-   软组织声速: $c_{\\mathrm{t}} = 1540\\,\\mathrm{m/s}$\n-   软组织振幅衰减系数: $0.5\\,\\mathrm{dB/cm/MHz}$\n-   假设条件: 垂直入射、平面波、线性声学、平面均匀层、半无限无损耗骨骼、发射到组织中的换能器振幅为固定参考值。\n-   能量质心ToF估计器的定义: $T_{\\mathrm{c}} \\equiv \\frac{\\sum_{n=1}^{\\infty} I_{n}\\, t_{n}}{\\sum_{n=1}^{\\infty} I_{n}}$\n-   强度-压力关系: $I_{n} \\propto |p_{n}|^{2}$\n-   表观深度的定义: $d_{\\mathrm{app}} \\equiv \\frac{c_{\\mathrm{t}}\\,T_{\\mathrm{c}}}{2}$\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于波动声学的基本原理，特别是医学超声中使用的脉冲回波技术。所有概念，如声阻抗、反射、透射、衰减和飞行时间，都是物理学和工程学中的标准概念。所提供的物理参数对于指定的生物组织是符合实际的。\n-   **适定性**：问题定义清晰，有足够的数据来推导所要求的表达式并计算数值结果。衰减的存在确保了用于质心计算的无穷级数收敛，保证了唯一、稳定的解。\n-   **客观性**：问题以精确、客观、技术性的语言陈述，没有任何主观或模糊的术语。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。这是一个定量超声领域的标准、适定的问题，具有科学合理性和客观性。可以继续进行求解。\n\n**2. 求解推导**\n\n**任务1：推导到达时间 $t_{n}$ 和相对压力振幅 $p_{n}$ 的表达式**\n\n该问题描述了在厚度为 $d$ 的软组织层内由混响产生的一系列回波。我们假设刚进入组织、朝向骨骼传播的初始脉冲振幅为参考值1。回波在换能器表面的组织中被检测为压力波。\n\n**到达时间 $t_{n}$**\n\n波的飞行时间 (ToF) 是传播距离除以传播速度。第一个回波 ($n=1$) 对应于从换能器到组织-骨骼界面再返回的单次往返。路径长度为 $2d$。\n$$t_{1} = \\frac{2d}{c_{\\mathrm{t}}}$$\n第二个回波 ($n=2$) 是第一个回波从换能器-组织界面反射，传播回骨骼，再次反射，然后返回到换能器所产生的结果。这在层内增加了一次完整的往返。第二个回波的总路径长度为 $2d + 2d = 4d$。\n$$t_{2} = \\frac{4d}{c_{\\mathrm{t}}}$$\n通常，第 $n$ 个回波对应于在组织层内完成了 $n$ 次往返的波。总路径长度为 $2nd$。因此，第 $n$ 个回波的到达时间为：\n$$t_{n} = \\frac{2nd}{c_{\\mathrm{t}}} = n \\cdot t_{1}$$\n\n**相对压力振幅 $p_{n}$**\n\n每个回波的振幅由衰减和反射的累积效应决定。我们必须首先定义相关的物理量。\n\n对于一个从阻抗为 $Z_1$ 的介质垂直入射到阻抗为 $Z_2$ 的介质的波，其压力反射系数为 $R = (Z_2 - Z_1)/(Z_2 + Z_1)$。\n组织中波在组织-骨骼界面的反射系数为：\n$$R_{\\mathrm{tb}} = \\frac{Z_{\\mathrm{b}} - Z_{\\mathrm{t}}}{Z_{\\mathrm{b}} + Z_{\\mathrm{t}}}$$\n令 $r_{\\mathrm{tb}} = |R_{\\mathrm{tb}}|$。\n\n组织中波在换能器-组织界面的反射系数记为 $R_{\\mathrm{tT}}$。问题给出其幅值为 $r_{\\mathrm{T}} = |R_{\\mathrm{tT}}| = 0.20$。\n\n软组织中与频率相关的衰减给定为 $0.5\\,\\mathrm{dB/cm/MHz}$。在工作频率 $f = 5.0\\,\\mathrm{MHz}$ 下，衰减率为：\n$$\\alpha_{\\mathrm{dB/cm}} = (0.5\\,\\mathrm{dB/cm/MHz}) \\times (5.0\\,\\mathrm{MHz}) = 2.5\\,\\mathrm{dB/cm}$$\n为了进行解析表达式的推导，我们需要单位为奈培/米 (Np/m) 的衰减系数 $\\alpha$。转换公式为：\n$$\\alpha \\, [\\mathrm{Np/m}] = \\alpha_{\\mathrm{dB/cm}} \\, [\\mathrm{dB/cm}] \\times \\frac{\\ln(10)}{20} \\times 100 \\, \\frac{\\mathrm{cm}}{\\mathrm{m}} = 100 \\times 2.5 \\times \\frac{\\ln(10)}{20} = 12.5\\ln(10)\\,\\mathrm{Np/m}$$\n平面波在传播距离 $x$ 后，其振幅会减小一个因子 $\\exp(-\\alpha x)$。单程穿过厚度为 $d$ 的组织层的衰减因子为 $A = \\exp(-\\alpha d)$。\n\n现在我们追踪每个回波的振幅，其中 $p_n$ 表示第 $n$ 个回波的压力振幅大小。\n\n-   **回波 1 ($p_1$)**: 波传播到骨骼（衰减 $A$），反射（$r_{\\mathrm{tb}}$），然后传播回换能器（衰减 $A$）。\n    $$p_1 = (1) \\cdot A \\cdot r_{\\mathrm{tb}} \\cdot A = r_{\\mathrm{tb}} A^2 = r_{\\mathrm{tb}} \\exp(-2\\alpha d)$$\n\n-   **回波 2 ($p_2$)**: 该回波遵循第一个回波的路径，然后在换能器-组织界面反射（$r_{\\mathrm{T}}$），传播回骨骼（衰减 $A$），再次反射（$r_{\\mathrm{tb}}$），并返回换能器（衰减 $A$）。与 $p_1$ 相比，额外的乘法因子是 $r_{\\mathrm{T}} \\cdot A \\cdot r_{\\mathrm{tb}} \\cdot A = r_{\\mathrm{T}} r_{\\mathrm{tb}} A^2$。\n    $$p_2 = p_1 \\cdot (r_{\\mathrm{T}} r_{\\mathrm{tb}} A^2) = (r_{\\mathrm{tb}} A^2) \\cdot (r_{\\mathrm{T}} r_{\\mathrm{tb}} A^2) = r_{\\mathrm{T}} r_{\\mathrm{tb}}^2 A^4 = r_{\\mathrm{T}} r_{\\mathrm{tb}}^2 \\exp(-4\\alpha d)$$\n\n-   **回波 n ($p_n$)**: 每个后续回波都是由在层内多一次混响循环形成的。因此，振幅被相同的因子 $r_{\\mathrm{T}} r_{\\mathrm{tb}} A^2$ 缩放。我们可以建立一个递归关系：$p_n = p_{n-1} \\cdot (r_{\\mathrm{T}} r_{\\mathrm{tb}} A^2)$。\n    这形成了一个等比数列。第 $n$ 个回波振幅的通用表达式为：\n    $$p_n = p_1 \\cdot (r_{\\mathrm{T}} r_{\\mathrm{tb}} A^2)^{n-1} = (r_{\\mathrm{tb}} A^2) \\cdot (r_{\\mathrm{T}} r_{\\mathrm{tb}} A^2)^{n-1} = r_{\\mathrm{T}}^{n-1} r_{\\mathrm{tb}}^{n} A^{2n}$$\n    代入 $A$ 的显式形式：\n    $$p_n = r_{\\mathrm{T}}^{n-1} r_{\\mathrm{tb}}^{n} \\exp(-2n\\alpha d)$$\n\n**任务2：计算表观深度 $d_{\\mathrm{app}}$ 的数值**\n\n能量质心ToF估计器为 $T_{\\mathrm{c}} = (\\sum I_{n} t_{n}) / (\\sum I_{n})$，其中 $I_n$ 是第 $n$ 个回波的强度，与 $p_n^2$ 成正比。我们可以将比例常数设为1。\n$$I_n = p_n^2 = (r_{\\mathrm{T}}^{n-1} r_{\\mathrm{tb}}^{n} \\exp(-2n\\alpha d))^2 = r_{\\mathrm{T}}^{2(n-1)} r_{\\mathrm{tb}}^{2n} \\exp(-4n\\alpha d)$$\n连续回波的强度比是恒定的：\n$$\\frac{I_{n+1}}{I_n} = \\frac{r_{\\mathrm{T}}^{2n} r_{\\mathrm{tb}}^{2(n+1)} \\exp(-4(n+1)\\alpha d)}{r_{\\mathrm{T}}^{2(n-1)} r_{\\mathrm{tb}}^{2n} \\exp(-4n\\alpha d)} = r_{\\mathrm{T}}^2 r_{\\mathrm{tb}}^2 \\exp(-4\\alpha d)$$\n设这个恒定比值为 $K = r_{\\mathrm{T}}^2 r_{\\mathrm{tb}}^2 \\exp(-4\\alpha d)$。由于 $r_{\\mathrm{T}}  1$，$r_{\\mathrm{tb}}  1$，且指数项小于1，我们有 $0  K  1$。\n强度序列是一个等比数列：$I_n = I_1 K^{n-1}$，其中 $I_1 = r_{\\mathrm{tb}}^2 \\exp(-4\\alpha d)$。\n\n$T_{\\mathrm{c}}$ 的分母是一个等比数列的和：\n$$\\sum_{n=1}^{\\infty} I_n = \\sum_{n=1}^{\\infty} I_1 K^{n-1} = \\frac{I_1}{1-K}$$\n分子是：\n$$\\sum_{n=1}^{\\infty} I_n t_n = \\sum_{n=1}^{\\infty} (I_1 K^{n-1}) (n t_1) = I_1 t_1 \\sum_{n=1}^{\\infty} n K^{n-1}$$\n这个和是一个已知的级数结果，与等比数列公式的导数有关：$\\sum_{n=1}^{\\infty} n x^{n-1} = \\frac{1}{(1-x)^2}$。\n$$\\sum_{n=1}^{\\infty} I_n t_n = I_1 t_1 \\frac{1}{(1-K)^2}$$\n现在，我们可以计算 $T_{\\mathrm{c}}$：\n$$T_{\\mathrm{c}} = \\frac{I_1 t_1 / (1-K)^2}{I_1 / (1-K)} = \\frac{t_1}{1-K}$$\n代入 $t_1 = 2d/c_{\\mathrm{t}}$：\n$$T_{\\mathrm{c}} = \\frac{2d}{c_{\\mathrm{t}}(1-K)}$$\n最后，我们求出表观深度 $d_{\\mathrm{app}}$：\n$$d_{\\mathrm{app}} = \\frac{c_{\\mathrm{t}} T_{\\mathrm{c}}}{2} = \\frac{c_{\\mathrm{t}}}{2} \\left( \\frac{2d}{c_{\\mathrm{t}}(1-K)} \\right) = \\frac{d}{1-K}$$\n$$d_{\\mathrm{app}} = \\frac{d}{1 - r_{\\mathrm{T}}^2 r_{\\mathrm{tb}}^2 \\exp(-4\\alpha d)}$$\n现在，我们代入数值：\n-   $d = 3.0 \\times 10^{-3}\\,\\mathrm{m}$\n-   $r_{\\mathrm{T}} = 0.20$\n-   $r_{\\mathrm{tb}} = \\left| \\frac{Z_{\\mathrm{b}} - Z_{\\mathrm{t}}}{Z_{\\mathrm{b}} + Z_{\\mathrm{t}}} \\right| = \\frac{7.8 \\times 10^6 - 1.6 \\times 10^6}{7.8 \\times 10^6 + 1.6 \\times 10^6} = \\frac{6.2 \\times 10^6}{9.4 \\times 10^6} = \\frac{6.2}{9.4}$\n-   $\\alpha = 12.5\\ln(10)\\,\\mathrm{Np/m}$\n\n首先，计算 $K$ 项：\n$$K = \\left(0.20\\right)^2 \\left(\\frac{6.2}{9.4}\\right)^2 \\exp\\left(-4 \\cdot (12.5\\ln(10)) \\cdot (3.0 \\times 10^{-3})\\right)$$\n$$K = 0.04 \\left(\\frac{6.2}{9.4}\\right)^2 \\exp(-0.15\\ln(10))$$\n由于 $\\exp(-x\\ln(10)) = 10^{-x}$：\n$$K = 0.04 \\left(\\frac{6.2}{9.4}\\right)^2 10^{-0.15}$$\n$K \\approx 0.04 \\times (0.659574)^2 \\times 10^{-0.15} \\approx 0.04 \\times 0.435038 \\times 0.707946 \\approx 0.0123014$\n\n现在，计算 $d_{\\mathrm{app}}$：\n$$d_{\\mathrm{app}} = \\frac{3.0\\,\\mathrm{mm}}{1 - 0.0123014} = \\frac{3.0\\,\\mathrm{mm}}{0.9876986} \\approx 3.03746\\,\\mathrm{mm}$$\n四舍五入到四位有效数字，我们得到 $d_{\\mathrm{app}} = 3.037\\,\\mathrm{mm}$。\n\n**ToF估计器的定性讨论**\n\n为讨论不同估计器的行为，我们比较前几个回波的相对振幅。\n-   $r_{\\mathrm{tb}} \\approx 0.6596$\n-   $\\exp(-2\\alpha d) = \\exp(-0.075\\ln(10)) = 10^{-0.075} \\approx 0.8414$\n-   $p_1 = r_{\\mathrm{tb}} \\exp(-2\\alpha d) \\approx 0.6596 \\times 0.8414 \\approx 0.555$\n-   $K \\approx 0.0123$ 是强度比 $I_2/I_1$。振幅比为 $\\sqrt{K} = p_2/p_1 \\approx \\sqrt{0.0123} \\approx 0.111$。\n-   $p_2 = p_1 \\sqrt{K} \\approx 0.555 \\times 0.111 \\approx 0.0616$\n-   $p_3 = p_2 \\sqrt{K} \\approx 0.0616 \\times 0.111 \\approx 0.0068$\n\n回波振幅约为 $p_1 \\approx 0.555$，$p_2 \\approx 0.062$，$p_3 \\approx 0.007$。\n第一个回波 ($p_1$) 的强度比第二个回波 ($p_2$) 大将近一个数量级，并且后续回波迅速衰减。\n\n-   **首个超阈值拾取器**：该估计器识别第一个超过预定义噪声阈值的信号的到达时间。鉴于第一个回波的振幅很大，该拾取器将可靠地选择 $t_1$。这将导致一个无偏的深度估计 $d = c_{\\mathrm{t}} t_1 / 2$。\n\n-   **最大振幅拾取器**：该估计器找到接收信号中最大振幅峰值对应的时间。由于 $p_1 \\gg p_2 > p_3 > \\dots$，最大振幅将是第一个回波的振幅。该估计器也将选择 $t_1$ 并产生一个无偏的深度估计 $d$。\n\n-   **能量质心ToF估计器 ($T_{\\mathrm{c}}$)**：该估计器计算到达时间 $t_n$ 的加权平均值，权重为回波强度 $I_n = p_n^2$。表达式 $T_{\\mathrm{c}} = t_1 / (1-K)$ 表明 $T_{\\mathrm{c}} > t_1$，因为 $0  K  1$。尽管第一个回波的强度 $I_1$ 占主导地位，但该估计器包含了所有后续回波（$I_2, I_3, \\dots$）的贡献，这些回波在更晚的时间（$t_2, t_3, \\dots$）到达。这系统地将质心时间“拉”向一个比 $t_1$ 更晚的值。结果是，质心估计器虽然由第一个回波主导，但受到混响尾部的偏置影响，导致对飞行时间的高估，从而使表观深度 $d_{\\mathrm{app}}$ 大于真实深度 $d$。我们的数值结果证实了这一点（$3.037\\,\\mathrm{mm} > 3.0\\,\\mathrm{mm}$）。", "answer": "$$\\boxed{3.037}$$", "id": "4935269"}, {"introduction": "从接收到的回波波形中精确地确定其“到达时间”是飞行时间测距中的一个关键信号处理挑战。本练习探讨了三种标准的时间拾取算法，并分析当回波信号幅度波动时，这些算法的准确性会受到怎样的影响 [@problem_id:4935181]。通过对比这些方法的优劣，您将理解为何稳健的测时方法对于克服信号强度变化、保证成像精度至关重要。", "problem": "一个在均匀介质中工作的脉冲超声系统进行一维脉冲回波测量。换能器发射一个短波形，其归一化形状 $p(t)$ 具有单位峰值（即 $\\max_{t} p(t) = 1$）和一个单调上升的前沿。在噪声和色散可忽略不计的情况下，来自飞行时间为 $t_0$ 的平面反射体的接收回波可以建模为 $s(t) = A\\,p(t - t_0)$，其中振幅 $A  0$ 由于反射率和衰减的变化而在重复测量中波动，但波形形状 $p(t)$ 是不变的。考虑密集采样，因此时间可以被视为连续的。使用三种标准的时间拾取方法来估计到达时间 $\\hat t$：\n- 固定电压阈值交叉法：选择满足 $s(\\hat t) = V_{\\mathrm{th}}$ 的最早时间 $\\hat t$，其中 $V_{\\mathrm{th}}$ 是一个固定的阈值，满足 $0  V_{\\mathrm{th}}  A$。\n- 恒定分数甄别器 (CFD)：选择满足 $s(\\hat t) = f \\cdot \\max_{\\tau} s(\\tau)$ 的最早时间 $\\hat t$，其中分数 $f$ 满足 $0  f  1$。\n- 基于相关的拾取法：选择使 $r(\\tau) = \\int_{-\\infty}^{\\infty} s(t)\\,p(t - \\tau)\\,\\mathrm{d}t$ 最大化的 $\\hat t$。\n\n假设 $A$ 的变化与 $t_0$ 和 $p(t)$ 无关，并定义偏差为 $b = \\mathbb{E}[\\hat t - t_0]$（相对于振幅波动）。在上述假设下，关于振幅波动下的偏差，哪些陈述是正确的？\n\nA. 在单调上升沿上使用固定电压阈值交叉法时，较大的 $A$ 会产生较早的交叉点，导致与振幅相关的时间漂移；除非 $V_{\\mathrm{th}}$ 随 $A$ 缩放，否则由振幅波动引起的偏差通常不为零。\n\nB. 在使用固定分数 $f$ 和形状不变的 $p(t)$ 的恒定分数甄别器 (CFD) 下，仅振幅波动不会使估计产生偏差，即时间拾取与 $A$ 无关。\n\nC. 在使用模板 $p(t)$ 的基于相关的拾取法下，振幅缩放会使相关结果乘以一个因子，但不会移动其最大值的位置，因此仅振幅波动不会使估计产生偏差。\n\nD. 在振幅波动下，所有三种方法都具有相同的偏差，因为标量 $A$ 在时间比较中被抵消了。\n\nE. 对于阈值交叉法，选择一个足够小的固定阈值 $V_{\\mathrm{th}}$ 可以完全消除振幅引起的偏差。", "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **系统**：在均匀介质中的一维脉冲回波测量。\n- **换能器输出**：具有归一化形状 $p(t)$ 的短波形。\n- **脉冲特性**：\n    - 单位峰值：$\\max_{t} p(t) = 1$。\n    - 单调上升的前沿。\n- **接收回波模型**：$s(t) = A\\,p(t - t_0)$。\n- **参数**：\n    - $A  0$：振幅，在重复测量中波动。\n    - $t_0$：真实飞行时间。\n- **假设**：\n    - 介质是均匀的。\n    - 噪声和色散可忽略不计。\n    - 时间被视为连续的（密集采样）。\n    - 脉冲形状 $p(t)$ 是不变的。\n    - 振幅 $A$ 的变化与 $t_0$ 和 $p(t)$ 无关。\n- **时间拾取方法（$\\hat t$ 估计）**：\n    1.  **固定电压阈值交叉法**：满足 $s(\\hat t) = V_{\\mathrm{th}}$ 的最早时间 $\\hat t$，其中 $V_{\\mathrm{th}}$ 是一个固定的阈值，满足 $0  V_{\\mathrm{th}}  A$。\n    2.  **恒定分数甄别器 (CFD)**：满足 $s(\\hat t) = f \\cdot \\max_{\\tau} s(\\tau)$ 的最早时间 $\\hat t$，其中 $f$ 是一个固定的分数，满足 $0  f  1$。\n    3.  **基于相关的拾取法**：使相关函数 $r(\\tau) = \\int_{-\\infty}^{\\infty} s(t)\\,p(t - \\tau)\\,\\mathrm{d}t$ 最大化的时间 $\\hat t$。\n- **要分析的量**：偏差，定义为 $b = \\mathbb{E}[\\hat t - t_0]$，相对于振幅波动。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题牢固地植根于超声成像和信号处理的原理。脉冲回波模型 $s(t) = A\\,p(t - t_0)$ 是对来自简单反射体的回波的标准一阶近似，三种计时方法（阈值法、CFD 和匹配滤波/相关法）是到达时间估计的经典技术。“时间漂移”(time walk)这一概念是计时系统中由振幅变化引起的众所周知的伪影。\n- **适定性**：问题是适定的。先验信息和估计器的定义足以唯一确定每种方法中估计时间 $\\hat t$ 和振幅 $A$ 之间的关系，从而可以分析偏差。\n- **客观性**：问题使用精确、客观和数学的语言陈述。没有主观或基于意见的元素。\n- **一致性和完整性**：设置是内部一致的。假设（例如，可忽略的噪声，不变的脉冲形状）简化了分析，使其专注于振幅相关偏差的核心概念问题，这也是问题的意图。对 $0  V_{\\mathrm{th}}  A$ 和 $0  f  1$ 等参数的约束在物理上是必要的，并确保估计器是明确定义的。\n- **现实性**：虽然是理想化的（真实系统存在噪声、色散和一些脉冲形状变化），但该模型是用于教学和理解这些计时方法的基本局限性和特性的标准而有效的工具。它在科学上并非不合理。\n\n**步骤 3：结论和行动**\n问题陈述是有效的。这是一个在医学成像物理和信号处理领域中表述良好、科学合理的问题。现在可以进行分析。\n\n### 解题与选项分析\n\n问题的核心是分析每种方法的估计到达时间 $\\hat t$ 如何依赖于波动的信号振幅 $A$。偏差定义为 $b = \\mathbb{E}[\\hat t - t_0]$。我们特别关注由波动的 $A$ 引起的偏差贡献。如果误差项 $\\hat t - t_0$ 是 $A$ 的函数，那么振幅波动通常会引起非零偏差。\n\n**方法 1 分析：固定电压阈值交叉法**\n估计值 $\\hat t$ 是满足 $s(\\hat t) = V_{\\mathrm{th}}$ 的最早时间。\n代入信号模型 $s(t) = A\\,p(t - t_0)$：\n$$A\\,p(\\hat t - t_0) = V_{\\mathrm{th}}$$\n由于 $A  0$，我们可以写成：\n$$p(\\hat t - t_0) = \\frac{V_{\\mathrm{th}}}{A}$$\n脉冲形状 $p(t)$ 有一个单调上升的前沿。设此前沿的反函数为 $p_{\\text{edge}}^{-1}(\\cdot)$。将此反函数应用于两边，得到时间差：\n$$\\hat t - t_0 = p_{\\text{edge}}^{-1}\\left(\\frac{V_{\\mathrm{th}}}{A}\\right)$$\n这个方程明确显示了计时误差 $\\hat t - t_0$ 是振幅 $A$ 的函数。随着 $A$ 增大，比率 $V_{\\mathrm{th}}/A$ 减小。由于前沿是上升的，其反函数 $p_{\\text{edge}}^{-1}$ 必须是其自变量的单调递增函数。因此，随着 $A$ 增大，$\\hat t - t_0$ 减小，意味着估计的到达时间 $\\hat t$ 变得更早。这种效应被称为“时间漂移”。\n由振幅波动引起的偏差是 $b = \\mathbb{E}[p_{\\text{edge}}^{-1}(V_{\\mathrm{th}}/A)]$。由于 $p_{\\text{edge}}^{-1}$ 是一个非线性函数，且 $A$ 是一个随机变量，根据琴生不等式，通常情况下 $\\mathbb{E}[p_{\\text{edge}}^{-1}(V_{\\mathrm{th}}/A)] \\neq p_{\\text{edge}}^{-1}(V_{\\mathrm{th}}/\\mathbb{E}[A])$。偏差不为零，并且取决于 $A$ 的概率分布。\n\n**方法 2 分析：恒定分数甄别器 (CFD)**\n估计值 $\\hat t$ 是满足 $s(\\hat t) = f \\cdot \\max_{\\tau} s(\\tau)$ 的最早时间。\n首先，我们确定信号的峰值：\n$$\\max_{\\tau} s(\\tau) = \\max_{\\tau} [A\\,p(\\tau - t_0)] = A \\cdot \\max_{\\tau} p(\\tau - t_0)$$\n已知 $\\max_{t} p(t) = 1$，峰值就是 $A$。\nCFD 条件变为：\n$$s(\\hat t) = f \\cdot A$$\n代入信号模型 $s(\\hat t) = A\\,p(\\hat t - t_0)$：\n$$A\\,p(\\hat t - t_0) = f \\cdot A$$\n由于 $A  0$，我们可以用 $A$ 去除：\n$$p(\\hat t - t_0) = f$$\n对上升沿应用反函数 $p_{\\text{edge}}^{-1}$：\n$$\\hat t - t_0 = p_{\\text{edge}}^{-1}(f)$$\n计时误差 $\\hat t - t_0$ 等于常数 $p_{\\text{edge}}^{-1}(f)$，因为 $p(t)$ 和 $f$ 都是固定的。误差与振幅 $A$ 无关。因此，$A$ 的波动不会导致估计时间 $\\hat t$ 相对于真实时间 $t_0$ 的变化。偏差为 $b = \\mathbb{E}[\\hat t - t_0] = \\mathbb{E}[p_{\\text{edge}}^{-1}(f)] = p_{\\text{edge}}^{-1}(f)$。这个偏差是一个恒定的偏移量，不受 $A$ 的统计波动影响。\n\n**方法 3 分析：基于相关的拾取法**\n估计值 $\\hat t$ 是使相关函数 $r(\\tau) = \\int_{-\\infty}^{\\infty} s(t)\\,p(t - \\tau)\\,\\mathrm{d}t$ 最大化的 $\\tau$ 值。\n代入信号模型 $s(t) = A\\,p(t - t_0)$：\n$$r(\\tau) = \\int_{-\\infty}^{\\infty} [A\\,p(t - t_0)]\\,p(t - \\tau)\\,\\mathrm{d}t$$\n由于 $A$ 与积分变量 $t$ 无关，我们可以将其提出来：\n$$r(\\tau) = A \\int_{-\\infty}^{\\infty} p(t - t_0)\\,p(t - \\tau)\\,\\mathrm{d}t$$\n该积分表示 $p(t)$ 的一个移位版本与另一个不同移位版本的 $p(t)$ 的互相关。这等价于在延迟为 $\\tau - t_0$ 处计算 $p(t)$ 的自相关。设 $R_{pp}(\\Delta t) = \\int_{-\\infty}^{\\infty} p(u)p(u-\\Delta t)\\mathrm{d}u$ 是 $p(t)$ 的自相关函数。那么：\n$$r(\\tau) = A \\cdot R_{pp}(\\tau - t_0)$$\n估计值 $\\hat t$ 是使 $r(\\tau)$ 最大化的 $\\tau$ 值。由于 $A  0$，最大化 $r(\\tau)$ 等价于最大化自相关函数 $R_{pp}(\\tau - t_0)$。实值函数的自相关的一个基本性质是它在延迟为零时达到最大值。因此，$R_{pp}(\\tau - t_0)$ 的最大值出现在 $\\tau - t_0 = 0$ 时，这意味着 $\\tau = t_0$。\n因此，估计的时间是 $\\hat t = t_0$。\n计时误差为 $\\hat t - t_0 = 0$。这个结果完全与振幅 $A$ 无关。偏差为 $b = \\mathbb{E}[0] = 0$。在这种理想化的情况下，相关法是完全无偏的，其估计不受振幅波动的影响。\n\n### 逐项选项评估\n\n**A. 在单调上升沿上使用固定电压阈值交叉法时，较大的 $A$ 会产生较早的交叉点，导致与振幅相关的时间漂移；除非 $V_{\\mathrm{th}}$ 随 $A$ 缩放，否则由振幅波动引起的偏差通常不为零。**\n我们的分析表明 $\\hat t - t_0 = p_{\\text{edge}}^{-1}(V_{\\mathrm{th}}/A)$。随着 $A$ 增大，$\\hat t$ 减小，这正是时间漂移。由此产生的误差取决于 $A$，因此其期望值（偏差）将取决于 $A$ 的波动。该陈述与推导完全一致。\n**结论：正确。**\n\n**B. 在使用固定分数 $f$ 和形状不变的 $p(t)$ 的恒定分数甄别器 (CFD) 下，仅振幅波动不会使估计产生偏差，即时间拾取与 $A$ 无关。**\n我们对 CFD 的分析得出 $\\hat t - t_0 = p_{\\text{edge}}^{-1}(f)$，这是一个常数。估计值 $\\hat t$ 与 $A$ 无关。因此，振幅波动不会给估计带来任何可变性或相关的偏差。\n**结论：正确。**\n\n**C. 在使用模板 $p(t)$ 的基于相关的拾取法下，振幅缩放会使相关结果乘以一个因子，但不会移动其最大值的位置，因此仅振幅波动不会使估计产生偏差。**\n我们的分析表明 $r(\\tau) = A \\cdot R_{pp}(\\tau - t_0)$。振幅 $A$ 作为一个正的缩放因子，它不会改变 $R_{pp}(\\tau - t_0)$ 最大值的位置。最大值总是出现在 $\\hat t = t_0$ 处，与 $A$ 无关。因此，振幅波动不会引入偏差。\n**结论：正确。**\n\n**D. 在振幅波动下，所有三种方法都具有相同的偏差，因为标量 $A$ 在时间比较中被抵消了。**\n这显然是错误的。方法 1 的偏差与振幅有关。方法 2 有一个恒定的、通常非零的偏差，该偏差与振幅波动无关。方法 3 在这个理想模型中偏差为零。这些偏差是不同的。对于固定阈值法，标量 $A$ 不会被抵消。\n**结论：不正确。**\n\n**E. 对于阈值交叉法，选择一个足够小的固定阈值 $V_{\\mathrm{th}}$ 可以完全消除振幅引起的偏差。**\n阈值法的误差为 $\\hat t - t_0 = p_{\\text{edge}}^{-1}(V_{\\mathrm{th}}/A)$。只要 $V_{\\mathrm{th}} > 0$，这个误差项就会依赖于 $A$。减小 $V_{\\mathrm{th}}$ 会改变偏差的大小，但不能消除其对 $A$ 的依赖性。\n**结论：不正确。**", "answer": "$$\\boxed{ABC}$$", "id": "4935181"}]}