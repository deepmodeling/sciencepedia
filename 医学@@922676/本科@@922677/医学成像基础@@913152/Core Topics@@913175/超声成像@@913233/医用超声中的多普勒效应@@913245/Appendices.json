{"hands_on_practices": [{"introduction": "多普勒超声的核心临床应用是测量血流速度。本练习聚焦于其基本的逆问题：如何使用多普勒方程，将测得的多普勒频移转换回具有临床意义的血流速度值。通过完成这个计算 [@problem_id:4828959]，您不仅能掌握核心公式，还将探索最终结果的准确性如何严重依赖于超声波束与血流方向之间的夹角——这是在任何临床操作中都必须严格考虑的关键因素。", "problem": "对肾动脉进行脉冲多普勒超声检查。发射中心频率为 $f_{0} = 5\\,\\mathrm{MHz}$，软组织中的声速为 $c = 1540\\,\\mathrm{m\\,s^{-1}}$，测得的平均多普勒频移为 $\\Delta f = 3.00\\,\\mathrm{kHz}$，超声波束与血流方向之间的夹角（声束角）为 $\\theta = 60^{\\circ}$。\n\n从经典的波的多普勒效应出发，将红细胞视为移动的反射体，使得反向散射的回波经历两步多普勒频移，推导出一个表达式，该表达式在血流速度远小于声速的假设下，将测得的多普勒频移与血流速度、波束-血流夹角、发射频率和波速联系起来。然后，使用此表达式计算给定参数下的血流速度。\n\n最后，使用一阶不确定性传播，确定速度估计值的相对误差如何依赖于声束角的微小误差，并根据临床测量中角度的选择对这种依赖性进行定性解释。最后的解释部分不需要数值输出。\n\n将您的速度值四舍五入到四位有效数字。以 $\\mathrm{m\\,s^{-1}}$ 为单位表示最终速度。", "solution": "题目陈述经评估有效。它科学地基于波动物理学原理（多普勒效应），问题设定良好，信息充分且一致，并以客观、正式的语言表达。所有提供的参数对于临床超声检查都是物理上现实的。\n\n解答按要求分三部分进行：多普勒频移方程的推导，血流速度的计算，以及不确定性传播的分析。\n\n第1部分：多普勒频移方程的推导\n\n我们将此过程建模为两步多普勒频移。一个静止的超声探头发射频率为 $f_0$ 的波。这个波入射到红细胞上，红细胞被视为移动的反射体。血液以速度 $v$ 流动，与超声波束成夹角 $\\theta$。血流速度沿波束方向的分量为 $v_{\\parallel} = v \\cos(\\theta)$。测得一个正的多普勒频移 $\\Delta f$，这意味着频率增加。这发生在反射体朝向声源移动时。因此，我们将对血液流向换能器的情况进行建模。\n\n步骤1：从探头到红细胞的波。\n静止的探头作为频率为 $f_0$ 的声源。红细胞作为移动的观察者，以速度 $v_{\\parallel} = v \\cos(\\theta)$ 接近声源。红细胞感知到的频率 $f_r$ 由移动观察者的经典多普勒效应给出：\n$$f_r = f_0 \\left( \\frac{c + v_{\\parallel}}{c} \\right) = f_0 \\left( 1 + \\frac{v \\cos(\\theta)}{c} \\right)$$\n其中 $c$ 是波在介质中的速度。\n\n步骤2：从红细胞散射回探头的波。\n红细胞现在作为移动的声源，以它感知到的频率 $f_r$ 发射波。这个声源以速度 $v_{\\parallel} = v \\cos(\\theta)$ 朝向静止的探头（观察者）移动。探头探测到的频率 $f_d$ 由移动声源的多普勒效应给出：\n$$f_d = f_r \\left( \\frac{c}{c - v_{\\parallel}} \\right) = f_r \\left( \\frac{1}{1 - \\frac{v \\cos(\\theta)}{c}} \\right)$$\n\n结合这两个步骤，我们将步骤1中 $f_r$ 的表达式代入 $f_d$ 的方程：\n$$f_d = f_0 \\left( 1 + \\frac{v \\cos(\\theta)}{c} \\right) \\left( \\frac{1}{1 - \\frac{v \\cos(\\theta)}{c}} \\right) = f_0 \\left( \\frac{1 + \\frac{v \\cos(\\theta)}{c}}{1 - \\frac{v \\cos(\\theta)}{c}} \\right)$$\n多普勒频移 $\\Delta f$ 是探测到的频率与发射频率之差：$\\Delta f = f_d - f_0$。\n$$\\Delta f = f_0 \\left( \\frac{1 + \\frac{v \\cos(\\theta)}{c}}{1 - \\frac{v \\cos(\\theta)}{c}} - 1 \\right) = f_0 \\left( \\frac{1 + \\frac{v \\cos(\\theta)}{c} - \\left(1 - \\frac{v \\cos(\\theta)}{c}\\right)}{1 - \\frac{v \\cos(\\theta)}{c}} \\right)$$\n$$\\Delta f = f_0 \\left( \\frac{2 \\frac{v \\cos(\\theta)}{c}}{1 - \\frac{v \\cos(\\theta)}{c}} \\right) = \\frac{2 f_0 v \\cos(\\theta)}{c - v \\cos(\\theta)}$$\n题目要求使用血流速度远小于声速的假设，即 $v \\ll c$。由于 $|\\cos(\\theta)| \\le 1$，这意味着 $v \\cos(\\theta) \\ll c$。因此，分母可以近似为 $c - v \\cos(\\theta) \\approx c$。\n应用此近似，我们得到医学超声中使用的标准多普勒频移方程：\n$$\\Delta f \\approx \\frac{2 f_0 v \\cos(\\theta)}{c}$$\n该表达式将测得的多普勒频移 $\\Delta f$ 与血流速度 $v$、声束角 $\\theta$、发射频率 $f_0$ 和声速 $c$ 联系起来。\n\n第2部分：血流速度的计算\n\n我们重新整理推导出的表达式以求解血流速度 $v$：\n$$v = \\frac{\\Delta f \\cdot c}{2 f_0 \\cos(\\theta)}$$\n给定参数如下：\n发射频率，$f_0 = 5\\,\\mathrm{MHz} = 5 \\times 10^6\\,\\mathrm{Hz}$。\n声速，$c = 1540\\,\\mathrm{m\\,s^{-1}}$。\n多普勒频移，$\\Delta f = 3.00\\,\\mathrm{kHz} = 3.00 \\times 10^3\\,\\mathrm{Hz}$。\n声束角，$\\theta = 60^{\\circ}$。\n\n我们首先计算角度的余弦值：$\\cos(60^{\\circ}) = 0.5$。\n将数值代入 $v$ 的方程：\n$$v = \\frac{(3.00 \\times 10^3\\,\\mathrm{s^{-1}}) \\cdot (1540\\,\\mathrm{m\\,s^{-1}})}{2 \\cdot (5 \\times 10^6\\,\\mathrm{s^{-1}}) \\cdot (0.5)}$$\n$$v = \\frac{4.62 \\times 10^6\\,\\mathrm{m\\,s^{-1}}}{5 \\times 10^6} = 0.924\\,\\mathrm{m\\,s^{-1}}$$\n题目要求答案四舍五入到四位有效数字。\n$$v = 0.9240\\,\\mathrm{m\\,s^{-1}}$$\n\n第3部分：不确定性分析与解释\n\n我们想确定速度估计值的相对误差 $\\frac{\\delta v}{v}$ 如何依赖于声束角的微小误差 $\\delta \\theta$。我们的速度表达式为：\n$$v = \\frac{\\Delta f \\cdot c}{2 f_0} \\frac{1}{\\cos(\\theta)}$$\n在此分析中，我们将 $f_0$、$\\Delta f$ 和 $c$ 视为常数，并考察 $v$ 随 $\\theta$ 的变化。设 $K = \\frac{\\Delta f \\cdot c}{2 f_0}$，因此 $v = K (\\cos(\\theta))^{-1}$。\n使用单变量函数的不确定性传播方法，由不确定性 $\\delta \\theta$ 引起的不确定性 $\\delta v$ 由 $\\delta v \\approx |\\frac{dv}{d\\theta}| \\delta \\theta$ 给出。\n首先，我们求 $v$ 关于 $\\theta$ 的导数：\n$$\\frac{dv}{d\\theta} = \\frac{d}{d\\theta} \\left[ K (\\cos(\\theta))^{-1} \\right] = K \\left[ -1 (\\cos(\\theta))^{-2} (-\\sin(\\theta)) \\right] = K \\frac{\\sin(\\theta)}{\\cos^2(\\theta)}$$\n$v$ 的相对误差为 $\\frac{\\delta v}{v}$：\n$$\\frac{\\delta v}{v} \\approx \\frac{|K \\frac{\\sin(\\theta)}{\\cos^2(\\theta)} \\delta \\theta|}{|K (\\cos(\\theta))^{-1}|} = \\frac{\\frac{|\\sin(\\theta)|}{\\cos^2(\\theta)}}{ \\frac{1}{|\\cos(\\theta)|}} |\\delta \\theta|$$\n在临床应用中，角度 $\\theta$通常是銳角，所以 $0^{\\circ} \\le \\theta  90^{\\circ}$，这意味着 $\\sin(\\theta) \\ge 0$ 且 $\\cos(\\theta) > 0$。因此我们可以去掉绝对值符号。\n$$\\frac{\\delta v}{v} \\approx \\frac{\\sin(\\theta)}{\\cos(\\theta)} \\delta \\theta = \\tan(\\theta) \\delta \\theta$$\n注意，为使此关系在量纲上正确，角度误差 $\\delta \\theta$ 必须以弧度表示。\n\n定性解释：\n计算出的速度的相对误差 $\\frac{\\delta v}{v}$ 与 $\\tan(\\theta)$ 以及角度误差的大小 $\\delta \\theta$ 成正比。函数 $\\tan(\\theta)$ 随 $\\theta$ 非线性增长。\n-   对于小角度（即 $\\theta \\to 0^{\\circ}$），$\\tan(\\theta) \\to 0$。在这种情况下，即使存在非零的角度误差 $\\delta \\theta$，速度的相对误差也非常小。这意味着当超声波束与血流近乎平行时进行的测量，对于角度估计的微小误差具有鲁棒性。\n-   随着角度 $\\theta$ 增大，$\\tan(\\theta)$ 也增大。在 $\\theta=45^{\\circ}$ 时，$\\tan(45^{\\circ})=1$，意味着速度的相对误差等于角度误差（以弧度为单位）。\n-   在 $\\theta=60^{\\circ}$ 时，$\\tan(60^{\\circ}) = \\sqrt{3} \\approx 1.732$。此时速度的相对误差是角度误差的 $1.732$ 倍。\n-   当角度接近垂直时（即 $\\theta \\to 90^{\\circ}$），$\\tan(\\theta) \\to \\infty$。在此区域，相对误差的表达式发散。这意味着任何在测量角度 $\\theta$ 时的微小、不可避免的误差都将被极大地放大，导致计算出的速度 $v$ 出现巨大且不可靠的误差。\n因此，为了准确可靠地进行临床血流速度测量，避免使用大的声束角至关重要。接近 $90^{\\circ}$ 的角度是不可接受的。通常的临床实践是保持声束角低于 $60^{\\circ}$，以便将传播误差限制在可控范围内。", "answer": "$$\\boxed{0.9240}$$", "id": "4828959"}, {"introduction": "虽然多普勒方程看似简单直接，但脉冲超声系统存在一个固有的局限性，即“混叠”现象，它会导致高速血流被错误地解读为低速甚至反向血流。本练习 [@problem_id:4932493] 提出了一个真实的难题：您将获得两个因混叠而变得模糊的测量值。您将学习如何运用一种称为双脉冲重复频率 (dual-PRF) 分析的巧妙技术来消除这种模糊性，从而揭示真实的血流速度，这项技能对于解读复杂的多普勒信号至关重要。", "problem": "一套医用超声系统使用脉冲回波多普勒技术来评估浅表动脉中的血流。发射中心频率为 $f_{0}$ 的平面波，回波由红细胞反向散射回来，红细胞以速度 $v$ 运动，其速度矢量与超声波束形成多普勒角 $\\theta$。接收到的回波被解调以估计多普勒频率，但由于系统工作在脉冲模式下，该估计会受到由脉冲重复频率 (PRF) 决定的混叠效应的影响。在一次双 PRF 采集中，系统报告了以下基带多普勒频率估计值（每个值都已映射到主区间 $\\left[-\\tfrac{\\text{PRF}}{2}, \\tfrac{\\text{PRF}}{2}\\right)$ 内）：当 $\\text{PRF}_{1} = 5.0\\times 10^{3}\\,\\text{Hz}$ 时，测量值为 $f_{m1} = -1.2\\times 10^{3}\\,\\text{Hz}$；当 $\\text{PRF}_{2} = 6.0\\times 10^{3}\\,\\text{Hz}$ 时，测量值为 $f_{m2} = -2.2\\times 10^{3}\\,\\text{Hz}$。假设软组织中的声速为 $c = 1.540\\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$，发射中心频率为 $f_{0} = 4.0\\times 10^{6}\\,\\text{Hz}$，多普勒角为 $\\theta = 60^{\\circ}$。进一步假设，生理上合理的血流速度满足 $|v|  2.5\\,\\text{m}\\,\\text{s}^{-1}$。采用符号约定，正的 $v$ 表示流向换能器的血流。\n\n仅从基本波动运动学和采样引起的混叠的定义出发，确定与两个混叠测量值一致的真实血流速度 $v$。将您的答案四舍五入至四位有效数字，并以 $\\text{m}\\,\\text{s}^{-1}$ 为单位表示。", "solution": "首先根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n-   脉冲重复频率 1：$\\text{PRF}_{1} = 5.0\\times 10^{3}\\,\\text{Hz}$\n-   测量多普勒频率 1：$f_{m1} = -1.2\\times 10^{3}\\,\\text{Hz}$\n-   脉冲重复频率 2：$\\text{PRF}_{2} = 6.0\\times 10^{3}\\,\\text{Hz}$\n-   测量多普勒频率 2：$f_{m2} = -2.2\\times 10^{3}\\,\\text{Hz}$\n-   测量频率的主区间：$\\left[-\\tfrac{\\text{PRF}}{2}, \\tfrac{\\text{PRF}}{2}\\right)$\n-   软组织中的声速：$c = 1.540\\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}$\n-   发射中心频率：$f_{0} = 4.0\\times 10^{6}\\,\\text{Hz}$\n-   多普勒角：$\\theta = 60^{\\circ}$\n-   血流速度的生理约束：$|v|  2.5\\,\\text{m}\\,\\text{s}^{-1}$\n-   符号约定：正的 $v$ 表示流向换能器的血流。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于多普勒效应和信号混叠的公认原理，这些是脉冲多普勒超声（一种标准的医学成像模式）的基础。所有给定的物理量（$c$、$f_0$、PRF 值、血流速度范围）在此应用中都是符合实际的。\n2.  **适定性：** 该问题提供了足够的信息来确定唯一解。使用双 PRF 测量是解决混叠模糊性的标准技术，而速度的生理约束为从一组数学可能性中选择正确解提供了必要条件。\n3.  **客观性：** 该问题使用精确、定量和客观的语言陈述，没有任何主观或基于意见的主张。\n\n### 第3步：结论与行动\n该问题是有效的，因为它具有科学合理性、适定性和客观性。将推导求解。\n\n求解过程首先建立真实多普勒频率 $f_D$ 与血流速度 $v$ 之间的关系，以及 $f_D$ 与测量的混叠频率 $f_{m1}$ 和 $f_{m2}$ 之间的关系。\n\n**脉冲回波超声中的多普勒效应**\n在此情境下，多普勒效应涉及一个固定的源/观察者（换能器）和一个移动的反射体（红细胞）。沿超声波束的血流速度的轴向分量为 $v_{axial} = v \\cos\\theta$。对于远小于声速的速度（$|v| \\ll c$），如此处的情况，多普勒频移 $f_D$ 可通过线性化方程精确近似：\n$$f_D = \\frac{2 f_{0} v_{axial}}{c} = \\frac{2 f_{0} v \\cos\\theta}{c}$$\n问题定义了 $v > 0$ 为流向换能器的血流。这对应于正的多普勒频移（$f_D > 0$），这与公式一致，因为 $\\theta = 60^{\\circ}$ 意味着 $\\cos\\theta > 0$。\n\n**脉冲多普勒中的混叠**\n在脉冲系统中，多普勒信号以脉冲重复频率 (PRF) 进行采样。此采样过程可能导致混叠。真实多普勒频率 $f_D$ 通过混叠方程与测量频率 $f_m$ 相关联：\n$$f_D = f_m + k \\cdot \\text{PRF}$$\n其中 $k$ 是一个称为混叠数的整数。系统报告的 $f_m$ 位于主奈奎斯特区间 $\\left[-\\tfrac{\\text{PRF}}{2}, \\tfrac{\\text{PRF}}{2}\\right)$ 内。\n\n**使用双 PRF 解决混叠**\n我们得到了在两个不同 PRF 下的两次测量。设真实（但未知）的多普勒频率为 $f_D$。我们可以写出两个方程：\n$$(1) \\quad f_D = f_{m1} + k_1 \\cdot \\text{PRF}_1$$\n$$(2) \\quad f_D = f_{m2} + k_2 \\cdot \\text{PRF}_2$$\n其中 $k_1$ 和 $k_2$ 是未知整数。\n\n代入给定值：\n$f_{m1} = -1.2\\times 10^{3}\\,\\text{Hz}$, $\\text{PRF}_{1} = 5.0\\times 10^{3}\\,\\text{Hz}$\n$f_{m2} = -2.2\\times 10^{3}\\,\\text{Hz}$, $\\text{PRF}_{2} = 6.0\\times 10^{3}\\,\\text{Hz}$\n\n$$f_D = -1.2\\times 10^{3} + k_1 (5.0\\times 10^{3})$$\n$$f_D = -2.2\\times 10^{3} + k_2 (6.0\\times 10^{3})$$\n\n通过令 $f_D$ 的两个表达式相等，我们可以解出整数 $k_1$ 和 $k_2$：\n$$-1.2\\times 10^{3} + 5.0\\times 10^{3} k_1 = -2.2\\times 10^{3} + 6.0\\times 10^{3} k_2$$\n两边同除以 $10^{3}$：\n$$-1.2 + 5 k_1 = -2.2 + 6 k_2$$\n$$5 k_1 - 6 k_2 = -2.2 + 1.2$$\n$$5 k_1 - 6 k_2 = -1$$\n这是一个线性丢番图方程。我们可以通过观察找到一个特解。当 $k_1 = 1$ 时，我们有 $5(1) - 6 k_2 = -1$，这得到 $6 k_2 = 6$，所以 $k_2 = 1$。因此，$(k_1, k_2) = (1, 1)$ 是一个解。\n\n通解的形式为：\n$$k_1 = 1 + 6n$$\n$$k_2 = 1 + 5n$$\n其中 $n$ 为任意整数。\n\n我们可以将 $k_1$ 的这个通解形式代回到第一个关于 $f_D$ 的方程中，以找到真实多普勒频率的所有可能值：\n$$f_D = -1.2\\times 10^{3} + (1 + 6n) (5.0\\times 10^{3})$$\n$$f_D = -1.2\\times 10^{3} + 5.0\\times 10^{3} + 30.0\\times 10^{3} n$$\n$$f_D = 3.8\\times 10^{3} + n \\cdot (30.0\\times 10^{3})$$\n可能的真实多普勒频率是一组值，它们之间的间隔是两个 PRF 的最小公倍数，即 $\\text{lcm}(5000, 6000) = 30000\\,\\text{Hz}$。\n\n**应用生理约束**\n问题陈述，合理的血流速度满足 $|v|  2.5\\,\\text{m}\\,\\text{s}^{-1}$。我们可以使用多普勒方程将其转换为对 $|f_D|$ 的约束：\n$$|f_D| = \\left| \\frac{2 f_{0} v \\cos\\theta}{c} \\right| = \\frac{2 f_{0} |v| |\\cos\\theta|}{c}$$\n多普勒频率的最大可能幅值 $|f_D|_{\\text{max}}$ 为：\n$$|f_D|_{\\text{max}}  \\frac{2 f_{0} (2.5\\,\\text{m}\\,\\text{s}^{-1}) |\\cos(60^{\\circ})|}{c}$$\n代入 $f_0$、$c$ 和 $\\theta$ 的值：\n$$|f_D|_{\\text{max}}  \\frac{2 \\cdot (4.0\\times 10^{6}\\,\\text{Hz}) \\cdot 2.5 \\cdot 0.5}{1.540\\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1}}$$\n$$|f_D|_{\\text{max}}  \\frac{10.0\\times 10^{6}}{1.540\\times 10^{3}} \\,\\text{Hz} \\approx 6493.5\\,\\text{Hz}$$\n因此，真实多普勒频率必须位于区间 $(-6493.5, 6493.5)\\,\\text{Hz}$ 内。\n\n现在我们根据这个约束来检验 $f_D = (3.8 + n \\cdot 30.0)\\times 10^{3}\\,\\text{Hz}$ 的可能值：\n-   当 $n=0$ 时：$f_D = 3.8\\times 10^{3}\\,\\text{Hz} = 3800\\,\\text{Hz}$。该值在允许范围内，因为 $|3800|  6493.5$。\n-   当 $n=1$ 时：$f_D = (3.8 + 30.0)\\times 10^{3}\\,\\text{Hz} = 33800\\,\\text{Hz}$。这超出了范围。\n-   当 $n=-1$ 时：$f_D = (3.8 - 30.0)\\times 10^{3}\\,\\text{Hz} = -26200\\,\\text{Hz}$。这也超出了范围。\n\n唯一符合生理条件的真实多普勒频率是 $f_D = 3800\\,\\text{Hz}$。\n\n**计算血流速度**\n最后，我们通过重新排列多普勒方程来计算血流速度 $v$：\n$$v = \\frac{f_D c}{2 f_{0} \\cos\\theta}$$\n$$v = \\frac{(3800\\,\\text{Hz}) \\cdot (1.540\\times 10^{3}\\,\\text{m}\\,\\text{s}^{-1})}{2 \\cdot (4.0\\times 10^{6}\\,\\text{Hz}) \\cdot \\cos(60^{\\circ})}$$\n$$v = \\frac{3800 \\cdot 1540}{2 \\cdot (4.0\\times 10^{6}) \\cdot 0.5}\\,\\text{m}\\,\\text{s}^{-1}$$\n$$v = \\frac{5852000}{4.0\\times 10^{6}}\\,\\text{m}\\,\\text{s}^{-1}$$\n$$v = 1.463\\,\\text{m}\\,\\text{s}^{-1}$$\n正号表示血流方向朝向换能器，这与正的多普勒频率一致。结果需要四舍五入到四位有效数字，目前已经满足要求。", "answer": "$$\\boxed{1.463}$$", "id": "4932493"}, {"introduction": "医学测量的准确性至关重要，理解所有误差来源是其中的关键。这个高级练习 [@problem_id:4932470] 将超越简单的读数错误，探索一个更微妙的问题：在估计多普勒角度时存在的微小、随机的误差，如何导致计算出的速度出现系统性的、非零的偏差。通过本练习，您将运用数学分析来理解为什么我们的速度估算值倾向于被系统性地高估，以及这种效应如何随所选角度而变化。", "problem": "一个脉冲医疗超声系统将频率为 $f_{0}$ 的平面波发射到声速为 $c$ 的软组织中，并接收来自沿直线血管以速度 $v$ 流动的血液的回波。超声波束与血管的真实夹角为 $\\theta_{\\text{true}}$（在波束方向和血流方向之间测量）。该系统通过首先测量返回回波的多普勒频移，然后使用一个估计角度 $\\theta_{\\text{est}}$ 进行角度校正来估计 $v$。角度估计误差 $\\delta$ 定义为 $\\theta_{\\text{est}} = \\theta_{\\text{true}} + \\delta$，并被建模为一个均值为零、方差为 $\\sigma^{2}$ 的正态随机变量，且与所有其他量无关。假设血流是稳定的，散射体在其静止坐标系中仅反射入射压力波而不发生频率转换，并且流速满足 $v \\ll c$。\n\n仅从经典波动运动学（相速为 $c$ 的传播）和移动反射体的多普勒效应定义出发，推导速度估计中仅由角度校正不确定性引起的预期乘法偏差的表达式，该偏差定义为 $\\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right]$，推导到并包括 $\\sigma$ 的二阶项。然后，使用以下参数评估预期分数偏差 $\\mathbb{E}\\!\\left[\\frac{\\hat{v}-v}{v}\\right]$：\n- $c = 1540~\\text{m/s}$，\n- $f_{0} = 5.0 \\times 10^{6}~\\text{Hz}$，\n- $\\theta_{\\text{true}} = 60^{\\circ}$，\n- $\\sigma = 3^{\\circ}$，\n\n并假设多普勒频移本身没有测量噪声。在所有计算中，角度均以弧度处理（将角度明确转换为弧度）。将最终的分数偏差表示为小数，并将答案四舍五入到四位有效数字。", "solution": "首先验证问题，以确保其具有科学依据、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n- 发射频率: $f_{0}$\n- 软组织中声速: $c$\n- 血流速度: $v$\n- 超声波束与血流方向之间的真实角度: $\\theta_{\\text{true}}$\n- 估计速度: $\\hat{v}$\n- 估计角度: $\\theta_{\\text{est}} = \\theta_{\\text{true}} + \\delta$\n- 角度估计误差: $\\delta$，一个均值为零、方差为 $\\sigma^{2}$ 的正态随机变量。\n- 假设: $v \\ll c$，稳定血流，散射体在其静止坐标系中完美反射，多普勒频移无测量噪声。\n- 目标 1: 推导 $\\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right]$，直到并包括 $\\sigma$ 的二阶项。\n- 目标 2: 评估预期分数偏差 $\\mathbb{E}\\!\\left[\\frac{\\hat{v}-v}{v}\\right]$。\n- 评估参数: $c = 1540~\\text{m/s}$, $f_{0} = 5.0 \\times 10^{6}~\\text{Hz}$, $\\theta_{\\text{true}} = 60^{\\circ}$, $\\sigma = 3^{\\circ}$。\n- 计算规则: 涉及泰勒级数的计算，角度必须使用弧度。最终答案以小数形式表示，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了多普勒效应在医疗超声中的一个标准应用。其物理模型，包括 $v \\ll c$ 的假设，以及角度不确定性的统计模型，在医学成像领域是恰当且公认的。问题提法恰当，提供了所有必要信息和明确的目标。所用语言精确且客观。提供的数值对于临床超声是符合物理实际的。因此，该问题被认为是有效的。\n\n### 步骤 3：推导与求解\n求解过程首先建立真实速度 $v$ 和估计速度 $\\hat{v}$ 之间的关系，然后使用泰勒级数展开来计算它们比值的期望，以考虑角度不确定性。\n\n对于源和接收器位于同一位置的移动反射体，多普勒频移 $\\Delta f$ 由标准公式给出，该公式在 $v \\ll c$ 时有效：\n$$ \\Delta f = \\frac{2 f_{0} v \\cos(\\theta_{\\text{true}})}{c} $$\n这里，$v \\cos(\\theta_{\\text{true}})$ 是血液速度沿超声波束方向的分量。问题陈述中说明多普勒频移没有测量噪声，因此测量值 $\\Delta f_{\\text{meas}}$ 精确等于这个真实频移：\n$$ \\Delta f_{\\text{meas}} = \\frac{2 f_{0} v \\cos(\\theta_{\\text{true}})}{c} $$\n然而，系统使用相同的公式但采用估计角度 $\\theta_{\\text{est}}$ 来计算估计速度 $\\hat{v}$：\n$$ \\Delta f_{\\text{meas}} = \\frac{2 f_{0} \\hat{v} \\cos(\\theta_{\\text{est}})}{c} $$\n通过令 $\\Delta f_{\\text{meas}}$ 的两个表达式相等，我们可以将 $\\hat{v}$ 与 $v$ 联系起来：\n$$ \\frac{2 f_{0} \\hat{v} \\cos(\\theta_{\\text{est}})}{c} = \\frac{2 f_{0} v \\cos(\\theta_{\\text{true}})}{c} $$\n$$ \\hat{v} \\cos(\\theta_{\\text{est}}) = v \\cos(\\theta_{\\text{true}}) $$\n这给出了估计速度的关系式：\n$$ \\hat{v} = v \\frac{\\cos(\\theta_{\\text{true}})}{\\cos(\\theta_{\\text{est}})} $$\n乘法偏差是比率 $\\frac{\\hat{v}}{v}$。代入关系式 $\\theta_{\\text{est}} = \\theta_{\\text{true}} + \\delta$：\n$$ \\frac{\\hat{v}}{v} = \\frac{\\cos(\\theta_{\\text{true}})}{\\cos(\\theta_{\\text{true}} + \\delta)} $$\n我们需要求这个比率的期望值 $\\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right]$。由于 $\\theta_{\\text{true}}$ 是一个常数，我们有：\n$$ \\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right] = \\cos(\\theta_{\\text{true}}) \\mathbb{E}\\!\\left[\\frac{1}{\\cos(\\theta_{\\text{true}} + \\delta)}\\right] $$\n期望内的项涉及随机变量 $\\delta$。为了计算这个期望到 $\\sigma$ 的二阶，我们对函数 $g(\\delta) = \\frac{1}{\\cos(\\theta_{\\text{true}} + \\delta)} = \\sec(\\theta_{\\text{true}} + \\delta)$ 在 $\\delta = 0$ 附近进行泰勒级数展开。\n展开的一般形式是 $g(\\delta) \\approx g(0) + g'(0)\\delta + \\frac{g''(0)}{2!}\\delta^2$。\n$g(\\delta)$ 的导数是：\n$g'( \\delta ) = \\sec(\\theta_{\\text{true}} + \\delta) \\tan(\\theta_{\\text{true}} + \\delta)$\n$g''( \\delta ) = \\sec(\\theta_{\\text{true}} + \\delta)\\tan^2(\\theta_{\\text{true}} + \\delta) + \\sec^3(\\theta_{\\text{true}} + \\delta)$\n在 $\\delta = 0$ 处计算这些导数：\n$g(0) = \\sec(\\theta_{\\text{true}})$\n$g'(0) = \\sec(\\theta_{\\text{true}}) \\tan(\\theta_{\\text{true}})$\n$g''(0) = \\sec(\\theta_{\\text{true}})\\tan^2(\\theta_{\\text{true}}) + \\sec^3(\\theta_{\\text{true}})$\n\n二阶泰勒展开式为：\n$$ g(\\delta) \\approx \\sec(\\theta_{\\text{true}}) + \\left(\\sec(\\theta_{\\text{true}})\\tan(\\theta_{\\text{true}})\\right)\\delta + \\frac{1}{2}\\left(\\sec(\\theta_{\\text{true}})\\tan^2(\\theta_{\\text{true}}) + \\sec^3(\\theta_{\\text{true}})\\right)\\delta^2 $$\n现在我们求 $g(\\delta)$ 的期望。我们使用误差 $\\delta$ 的给定属性：$\\mathbb{E}[\\delta] = 0$ 和 $\\mathbb{E}[\\delta^2] = \\text{Var}(\\delta) + (\\mathbb{E}[\\delta])^2 = \\sigma^2 + 0^2 = \\sigma^2$。\n$$ \\mathbb{E}[g(\\delta)] \\approx \\sec(\\theta_{\\text{true}}) + \\left(\\sec(\\theta_{\\text{true}})\\tan(\\theta_{\\text{true}})\\right)\\mathbb{E}[\\delta] + \\frac{1}{2}\\left(\\sec(\\theta_{\\text{true}})\\tan^2(\\theta_{\\text{true}}) + \\sec^3(\\theta_{\\text{true}})\\right)\\mathbb{E}[\\delta^2] $$\n$$ \\mathbb{E}[g(\\delta)] \\approx \\sec(\\theta_{\\text{true}}) + \\frac{\\sigma^2}{2}\\left(\\sec(\\theta_{\\text{true}})\\tan^2(\\theta_{\\text{true}}) + \\sec^3(\\theta_{\\text{true}})\\right) $$\n将此结果代回预期乘法偏差的表达式中：\n$$ \\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right] \\approx \\cos(\\theta_{\\text{true}}) \\left[ \\sec(\\theta_{\\text{true}}) + \\frac{\\sigma^2}{2}\\left(\\sec(\\theta_{\\text{true}})\\tan^2(\\theta_{\\text{true}}) + \\sec^3(\\theta_{\\text{true}})\\right) \\right] $$\n分配 $\\cos(\\theta_{\\text{true}})$ 项：\n$$ \\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right] \\approx \\cos(\\theta_{\\text{true}})\\sec(\\theta_{\\text{true}}) + \\frac{\\sigma^2}{2}\\left(\\cos(\\theta_{\\text{true}})\\sec(\\theta_{\\text{true}})\\tan^2(\\theta_{\\text{true}}) + \\cos(\\theta_{\\text{true}})\\sec^3(\\theta_{\\text{true}})\\right) $$\n使用 $\\cos(x)\\sec(x) = 1$ 和 $\\cos(x)\\sec^3(x) = \\sec^2(x)$：\n$$ \\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right] \\approx 1 + \\frac{\\sigma^2}{2}\\left(\\tan^2(\\theta_{\\text{true}}) + \\sec^2(\\theta_{\\text{true}})\\right) $$\n这就是预期乘法偏差的符号表达式。\n\n要求的是预期分数偏差，即 $\\mathbb{E}\\!\\left[\\frac{\\hat{v}-v}{v}\\right] = \\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v} - 1\\right] = \\mathbb{E}\\!\\left[\\frac{\\hat{v}}{v}\\right] - 1$。\n$$ \\mathbb{E}\\!\\left[\\frac{\\hat{v}-v}{v}\\right] \\approx \\left[1 + \\frac{\\sigma^2}{2}\\left(\\tan^2(\\theta_{\\text{true}}) + \\sec^2(\\theta_{\\text{true}})\\right)\\right] - 1 = \\frac{\\sigma^2}{2}\\left(\\tan^2(\\theta_{\\text{true}}) + \\sec^2(\\theta_{\\text{true}})\\right) $$\n现在，我们使用给定的参数来评估这个表达式。为了使泰勒级数分析有效，角度必须以弧度为单位。\n$\\theta_{\\text{true}} = 60^{\\circ} = 60 \\times \\frac{\\pi}{180} = \\frac{\\pi}{3}$ 弧度。\n$\\sigma = 3^{\\circ} = 3 \\times \\frac{\\pi}{180} = \\frac{\\pi}{60}$ 弧度。\n\n我们计算 $\\theta_{\\text{true}} = \\frac{\\pi}{3}$ 的三角函数项：\n$\\tan(\\frac{\\pi}{3}) = \\sqrt{3}$，所以 $\\tan^2(\\frac{\\pi}{3}) = 3$。\n$\\cos(\\frac{\\pi}{3}) = \\frac{1}{2}$，所以 $\\sec(\\frac{\\pi}{3}) = 2$，并且 $\\sec^2(\\frac{\\pi}{3}) = 4$。\n\n方差是 $\\sigma^2 = \\left(\\frac{\\pi}{60}\\right)^2 = \\frac{\\pi^2}{3600}$。\n\n将这些值代入分数偏差表达式中：\n$$ \\mathbb{E}\\!\\left[\\frac{\\hat{v}-v}{v}\\right] \\approx \\frac{1}{2}\\left(\\frac{\\pi^2}{3600}\\right) \\left(3 + 4\\right) = \\frac{7\\pi^2}{7200} $$\n计算数值：\n$$ \\frac{7\\pi^2}{7200} \\approx \\frac{7 \\times (3.14159265...)^2}{7200} \\approx \\frac{7 \\times 9.8696044...}{7200} \\approx \\frac{69.08723...}{7200} \\approx 0.0095954486... $$\n将结果四舍五入到四位有效数字，得到 $0.009595$。\n其他给定的参数 $c$ 和 $f_0$ 在此特定计算中不需要，因为它们被消掉了，但它们的存在对于建立物理背景和多普勒方程的形式是必要的。", "answer": "$$\\boxed{0.009595}$$", "id": "4932470"}]}