{"hands_on_practices": [{"introduction": "连续波多普勒技术的核心是超声波在移动目标上反射时经历的频率偏移。本练习提供了一个基础实践，引导您从第一性原理出发，推导经典的多普勒频移方程，其中考虑了波的双程传播[@problem_id:4872517]。通过将此公式应用于一个典型的临床场景，您将巩固对速度和角度等物理参数如何转化为可测量的电信号的理解。", "problem": "一个连续波 (CW) 多普勒超声系统发射频率为 $f_0$ 的单色平面波，该波穿过声速为 $c$ 的软组织。一股血流以恒定速度 $v$、与超声波束方向成 $\\theta$ 角运动。对于连续波多普勒，移动的红细胞作为点散射体，在接收到入射波时首先经历一次多普勒频移，然后在将波反向辐射回静止的换能器时产生第二次多普勒频移。\n\n从基本的波动力学（平面波的相位为 $\\phi(t) = 2\\pi f\\,t - \\mathbf{k}\\cdot\\mathbf{r}(t)$，其中 $|\\mathbf{k}| = 2\\pi f/c$）出发，并使用在 $v \\ll c$ 时有效的一阶展开，推导在接收器处观察到的连续波多普勒频移大小的表达式，用 $f_0$、$v$、$\\theta$ 和 $c$ 表示。然后，使用推导出的表达式，计算当 $f_0=5\\ \\mathrm{MHz}$、$v=1.2\\ \\mathrm{m/s}$、$\\theta=30^\\circ$ 和 $c=1540\\ \\mathrm{m/s}$ 时的多普勒频移。\n\n讨论在连续波多普勒接收器的基带解调带宽为 $20\\ \\mathrm{kHz}$ 的情况下，该频移是否可检测，并明确说明您对相对于波束的速度分量所做的任何假设。以 $\\mathrm{Hz}$ 为单位表示多普勒频移，并将最终数值结果四舍五入到四位有效数字。", "solution": "该问题陈述经评估是有效的，因为它科学地基于波物理学和多普勒效应的原理，问题提出得很好，有足够的信息得到唯一解，并且用客观、精确的语言表达。所有提供的值对于医学超声应用都是物理上现实的。\n\n按照要求，解答过程分为三部分：多普勒频移公式的推导，给定参数下频移的数值计算，以及对其可检测性的讨论。\n\n**1. 连续波 (CW) 多普勒频移的推导**\n\n该推导考虑了两个连续的多普勒频移。我们采用一个统一的约定，即速度分量 $v \\cos\\theta$ 表示目标远离换能器的运动。\n\n1.  **第一阶段：换能器到散射体**。散射体作为“移动的观察者”远离静止的声源，它感知到的频率 $f_1$ 为：\n    $$f_1 = f_0 \\left(1 - \\frac{v \\cos\\theta}{c}\\right)$$\n2.  **第二阶段：散射体到换能器**。散射体作为“移动的声源”以频率 $f_1$ 再辐射，并以分量 $v \\cos\\theta$ 远离换能器。静止的换能器接收到的频率 $f_2$ 为：\n    $$f_2 = \\frac{f_1}{1 + \\frac{v \\cos\\theta}{c}}$$\n\n将两个阶段结合起来：\n$$ f_2 = f_0 \\frac{1 - \\frac{v \\cos\\theta}{c}}{1 + \\frac{v \\cos\\theta}{c}} $$\n这是精确的非相对论性表达式。对于 $v \\ll c$ 的一阶展开，令 $x = \\frac{v \\cos\\theta}{c}$。我们使用近似 $(1+x)^{-1} \\approx 1-x$（当 $|x| \\ll 1$ 时）。\n$$ f_2 \\approx f_0 (1-x)(1-x) = f_0 (1-x)^2 = f_0 (1 - 2x + x^2) $$\n忽略二阶项 $x^2 = (\\frac{v \\cos\\theta}{c})^2$，因为它在 $v \\ll c$ 时可以忽略不计：\n$$ f_2 \\approx f_0 (1 - 2x) = f_0 \\left( 1 - \\frac{2v \\cos\\theta}{c} \\right) $$\n多普勒频移 $\\Delta f$ 是接收频率 $f_2$ 与发射频率 $f_0$ 之间的差值：\n$$ \\Delta f = f_2 - f_0 \\approx f_0 \\left( 1 - \\frac{2v \\cos\\theta}{c} \\right) - f_0 = - \\frac{2 f_0 v \\cos\\theta}{c} $$\n问题要求的是这个频移的大小，我们记为 $f_D$：\n$$ f_D = |\\Delta f| = \\frac{2 f_0 v |\\cos\\theta|}{c} $$\n这就是所要求的表达式。频移的符号表示方向：负号（如此处推导，对应于远离换能器的运动）表示频率降低。正频移则对应于朝向换能器的运动。\n\n**2. 数值计算**\n\n给定以下数值：\n发射频率, $f_0 = 5 \\ \\mathrm{MHz} = 5 \\times 10^6 \\ \\mathrm{Hz}$\n血流速度, $v = 1.2 \\ \\mathrm{m/s}$\n多普勒角, $\\theta = 30^\\circ$\n软组织中的声速, $c = 1540 \\ \\mathrm{m/s}$\n\n角度 $\\theta = 30^\\circ$ 是锐角，所以 $|\\cos\\theta| = \\cos\\theta$。\n$$ \\cos(30^\\circ) = \\frac{\\sqrt{3}}{2} $$\n将这些数值代入导出的多普勒频移大小公式中：\n$$ f_D = \\frac{2 f_0 v \\cos\\theta}{c} = \\frac{2 \\times (5 \\times 10^6 \\ \\mathrm{Hz}) \\times (1.2 \\ \\mathrm{m/s}) \\times \\cos(30^\\circ)}{1540 \\ \\mathrm{m/s}} $$\n$$ f_D = \\frac{2 \\times 5 \\times 1.2 \\times \\frac{\\sqrt{3}}{2}}{1540} \\times 10^6 \\ \\mathrm{Hz} = \\frac{5 \\times 1.2 \\times \\sqrt{3}}{1540} \\times 10^6 \\ \\mathrm{Hz} $$\n$$ f_D = \\frac{6 \\sqrt{3}}{1540} \\times 10^6 \\ \\mathrm{Hz} \\approx \\frac{6 \\times 1.73205}{1540} \\times 10^6 \\ \\mathrm{Hz} $$\n$$ f_D \\approx \\frac{10.3923}{1540} \\times 10^6 \\ \\mathrm{Hz} \\approx 0.00674825 \\times 10^6 \\ \\mathrm{Hz} $$\n$$ f_D \\approx 6748.25 \\ \\mathrm{Hz} $$\n按要求四舍五入到四位有效数字，多普勒频移为：\n$$ f_D = 6748 \\ \\mathrm{Hz} $$\n\n**3. 可检测性讨论**\n\n计算出的多普勒频移为 $f_D \\approx 6.748 \\ \\mathrm{kHz}$。指定的连续波多普勒接收器的基带解调带宽为 $20 \\ \\mathrm{kHz}$。\n\n由于计算出的频移 $f_D$ 必须在系统的通带内才能被检测到，我们将它的大小与可用带宽进行比较。\n$$ 6.748 \\ \\mathrm{kHz}  20 \\ \\mathrm{kHz} $$\n多普勒频移完全落在接收器的解调带宽之内。因此，该频移很容易被检测到。\n\n本分析中所做的主要假设（这也是这种简化模型的标准假设）是，多普勒频移是由以单一恒定速度 $v$ 运动的散射体产生的。该公式特别依赖于该速度在超声波束轴上的投影分量，即 $v \\cos\\theta$。在真实的生理情景中，血流不是均匀的；它在血管中表现出速度剖面（层流或湍流），并且通常是搏动性的（随心动周期变化）。因此，一个真实的连续波多普勒系统会接收到一个频率谱，而不是单一频率。我们计算出的 $6748 \\ \\mathrm{Hz}$ 将对应于以精确 $v=1.2 \\ \\mathrm{m/s}$ 的速度、在 $\\theta=30^\\circ$ 的角度运动的散射体所产生的频移。在一个更复杂、更现实的多普勒频谱中，这个值可能代表峰值频率或平均频率。", "answer": "$$\n\\boxed{6748}\n$$", "id": "4872517"}, {"introduction": "任何基于多普勒的速度测量的准确性都依赖于组织中声速 $c$ 的假定值。本实践探讨了不准确假设所带来的后果，这是一个常见问题，因为实际声速在不同组织中会有所不同[@problem_id:4872483]。您将推导声速 $c$ 的误差与估计速度误差之间的关系，揭示一个简单但重要的测量偏差来源。", "problem": "一个连续波（CW）多普勒超声系统以中心频率 $f_{0}$ 向软组织发射声波，软组织中的声速为 $c$。以速度 $v$ 沿与超声波束成 $\\theta$ 角方向移动的血液产生反向散射回波，并被换能器接收。假设经典声学多普勒效应用于前向（发射器到散射体）和返回（散射体到接收器）路径，并且小速度近似 $|v| \\ll c$ 有效，因此 $v/c$ 的一阶项占主导地位。该系统从接收到的信号中精确测量多普勒频移 $f_{D}$，但通过使用一个假定的声速 $c_{\\text{assumed}}$ 来反演多普勒关系，将此频移转换为速度估计值。该假定声速可能与真实声速 $c$ 相差 $\\Delta c$，即 $c_{\\text{assumed}} = c + \\Delta c$。\n\n从运动接收器和运动源的一维经典多普勒关系出发，仅使用第一性原理（波以速度 $c$ 传播、相对运动引起的频移以及对 $|v| \\ll c$ 的线性化），推导仅由假定声速误差引起的速度估计值中的分数偏差 $\\Delta v / v$，并用 $\\Delta c$ 和 $c$ 表示。然后，当真实软组织声速为 $c = 1,\\!540\\ \\mathrm{m/s}$ 时，对 $\\Delta c = 20\\ \\mathrm{m/s}$ 的情况量化此分数偏差。将最终的分数偏差表示为一个无量纲的十进制数，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求推导由假定声速误差引起的多普勒速度估计中的分数偏差。推导必须从运动散射体的经典声学多普勒效应的第一性原理出发，该过程包括两个步骤：波从静止源传播到运动散射体，以及波从运动散射体散射回静止源。\n\n设 $f_0$ 是静止超声换能器发射的频率。设 $c$ 是介质（软组织）中的真实声速。设 $v$ 是血细胞（散射体）的速度，$\\theta$ 是血流方向与超声波束之间的夹角。散射体速度沿波束轴的分量是 $v \\cos\\theta$。我们采用惯例，朝向换能器的运动速度为正。\n\n步骤1：前向传播（换能器到散射体）\n血细胞充当运动的接收器。血细胞感知到的频率 $f'$ 由运动接收器接近静止源的多普勒公式给出：\n$$ f' = f_0 \\left( 1 + \\frac{v \\cos\\theta}{c} \\right) $$\n\n步骤2：后向传播（散射体到换能器）\n血细胞立即以其感知到的频率 $f'$ 重新辐射（散射）声波。它们现在充当一个频率为 $f'$ 的运动源，朝向静止的换能器（接收器）移动。换能器接收到的频率 $f_r$ 由运动源接近静止接收器的多普勒公式给出：\n$$ f_r = f' \\left( \\frac{1}{1 - \\frac{v \\cos\\theta}{c}} \\right) $$\n将 $f'$ 的表达式代入此方程，得到接收频率的完整表达式：\n$$ f_r = f_0 \\left( 1 + \\frac{v \\cos\\theta}{c} \\right) \\left( \\frac{1}{1 - \\frac{v \\cos\\theta}{c}} \\right) $$\n\n步骤3：线性化\n问题指明小速度近似 $|v| \\ll c$ 是有效的。这意味着项 $x = \\frac{v \\cos\\theta}{c}$ 远小于1。因此，对于小的 $x$，我们可以使用一阶泰勒级数近似 $(1-x)^{-1} \\approx 1+x$。将此应用于我们的 $f_r$ 表达式：\n$$ f_r \\approx f_0 \\left( 1 + \\frac{v \\cos\\theta}{c} \\right) \\left( 1 + \\frac{v \\cos\\theta}{c} \\right) = f_0 \\left( 1 + \\frac{v \\cos\\theta}{c} \\right)^2 $$\n展开平方项得到：\n$$ f_r \\approx f_0 \\left( 1 + 2\\frac{v \\cos\\theta}{c} + \\left(\\frac{v \\cos\\theta}{c}\\right)^2 \\right) $$\n按照指示，我们只保留 $v/c$ 的一阶项。这意味着我们忽略二阶项 $(\\frac{v \\cos\\theta}{c})^2$。接收频率的线性化表达式变为：\n$$ f_r \\approx f_0 \\left( 1 + 2\\frac{v \\cos\\theta}{c} \\right) $$\n\n步骤4：多普勒频移和速度估计\n多普勒频移 $f_D$ 是接收频率 $f_r$ 和发射频率 $f_0$ 之间的差值。\n$$ f_D = f_r - f_0 \\approx f_0 \\left( 1 + 2\\frac{v \\cos\\theta}{c} \\right) - f_0 = \\frac{2 f_0 v \\cos\\theta}{c} $$\n该方程代表了真实的物理关系。超声系统测量 $f_D$ 并通过反演此公式来计算估计速度 $v_{\\text{est}}$。然而，它使用了一个假定的声速 $c_{\\text{assumed}}$。因此，机器的内部计算是：\n$$ v_{\\text{est}} = \\frac{f_D c_{\\text{assumed}}}{2 f_0 \\cos\\theta} $$\n为了将估计速度与真实速度联系起来，我们可以将单个测量量 $f_D$ 的两个表达式相等。\n$$ f_D = \\frac{2 f_0 v \\cos\\theta}{c} \\quad \\text{和} \\quad f_D = \\frac{2 f_0 v_{\\text{est}} \\cos\\theta}{c_{\\text{assumed}}} $$\n令它们相等，得到：\n$$ \\frac{2 f_0 v \\cos\\theta}{c} = \\frac{2 f_0 v_{\\text{est}} \\cos\\theta}{c_{\\text{assumed}}} $$\n假设 $\\cos\\theta \\neq 0$，则项 $2$、$f_0$ 和 $\\cos\\theta$ 可以消掉，剩下：\n$$ \\frac{v}{c} = \\frac{v_{\\text{est}}}{c_{\\text{assumed}}} $$\n这就建立了估计速度和真实速度之间的关系：\n$$ v_{\\text{est}} = v \\left( \\frac{c_{\\text{assumed}}}{c} \\right) $$\n\n步骤5：分数偏差推导\n速度估计中的偏差是 $\\Delta v = v_{\\text{est}} - v$。分数偏差是 $\\frac{\\Delta v}{v}$。\n$$ \\frac{\\Delta v}{v} = \\frac{v_{\\text{est}} - v}{v} = \\frac{v_{\\text{est}}}{v} - 1 $$\n代入比率 $\\frac{v_{\\text{est}}}{v}$ 的表达式：\n$$ \\frac{\\Delta v}{v} = \\left( \\frac{c_{\\text{assumed}}}{c} \\right) - 1 $$\n我们已知 $c_{\\text{assumed}} = c + \\Delta c$，其中 $\\Delta c$ 是假定声速中的误差。\n$$ \\frac{\\Delta v}{v} = \\frac{c + \\Delta c}{c} - 1 = \\left(1 + \\frac{\\Delta c}{c}\\right) - 1 = \\frac{\\Delta c}{c} $$\n因此，速度估计中的分数偏差恰好等于假定声速中的分数误差。\n\n步骤6：数值计算\n我们已知真实声速 $c = 1,\\!540\\ \\mathrm{m/s}$ 以及假定声速中的误差 $\\Delta c = 20\\ \\mathrm{m/s}$。\n分数偏差为：\n$$ \\frac{\\Delta v}{v} = \\frac{\\Delta c}{c} = \\frac{20}{1540} $$\n化简分数：\n$$ \\frac{20}{1540} = \\frac{2}{154} = \\frac{1}{77} $$\n为了将其表示为四舍五入到四位有效数字的无量纲十进制数：\n$$ \\frac{1}{77} \\approx 0.0129870129... $$\n四舍五入到四位有效数字得到 $0.01299$。", "answer": "$$\\boxed{0.01299}$$", "id": "4872483"}, {"introduction": "在临床实践中，多普勒速度估计中最显著的误差来源通常是操作者对超声波束与血流之间角度 $\\theta$ 的估计。本实践展示了该角度对测量准确性的深远影响[@problem_id:4872505]。通过分析误差传播，您将发现为什么随着多普勒角的增大，测量变得越来越敏感和不可靠。", "problem": "一个连续波（CW）多普勒超声系统通过使用操作员输入的声束-血流夹角，将测得的多普勒频移转换为速度，从而估算血流速度。设真实流速为 $v$，真实声束-血流夹角为 $\\theta$，操作员输入的角度为 $\\hat{\\theta}$。仪器使用测得的多普勒频移和 $\\hat{\\theta}$ 来计算估算速度 $\\hat{v}$。从连续波超声中的多普勒频移源于与移动散射体的双向相互作用，并取决于沿声束方向的运动分量这一基本关系出发，推导一个仅用 $\\theta$ 和 $\\hat{\\theta}$ 表示的分数误差 $(\\hat{v}-v)/v$ 的表达式，并消除所有仪器参数。然后，当真实角度为 $\\theta=70^\\circ$ 且操作员高估了 $5^\\circ$ 以致于 $\\hat{\\theta}=75^\\circ$ 时，计算此分数误差的量值。所有三角函数参数均以度为单位处理。将分数误差的量值以无单位小数形式报告，并四舍五入至四位有效数字。最后，根据你的推导，简要说明为什么较大的声束-血流夹角会加剧速度估算对角度错误估计的敏感性。", "solution": "该问题陈述清晰，具有科学依据，并包含了推导出唯一解所需的所有信息。\n\n连续波（CW）多普勒超声的基本原理是，测得的多普勒频移 $f_D$ 与血流速度沿超声声束轴线的分量成正比。该关系由多普勒方程给出：\n$$f_D = \\frac{2 f_0 v \\cos(\\theta)}{c}$$\n其中 $f_0$ 是发射的超声频率，$c$ 是声波在介质（组织）中的速度，$v$ 是血流的真实速度，$\\theta$ 是超声声束与血流方向之间的真实夹角。因子 $2$ 源于超声波的双向路径（发射到散射体并接收回波）。\n\n超声系统测量多普勒频移的单个值 $f_D$。该测量值是真实物理参数 $v$ 和 $\\theta$ 的结果：\n$$f_{D, \\text{measured}} = \\frac{2 f_0 v \\cos(\\theta)}{c}$$\n\n然后，仪器通过重新排列多普勒方程来计算估算速度 $\\hat{v}$。然而，它使用的是操作员输入的声束-血流夹角 $\\hat{\\theta}$，而不是真实（且未知）的角度 $\\theta$。仪器使用的公式是：\n$$\\hat{v} = \\frac{f_{D, \\text{measured}} \\cdot c}{2 f_0 \\cos(\\hat{\\theta})}$$\n\n为了找出估算速度 $\\hat{v}$ 与真实速度 $v$ 之间的关系，我们将 $f_{D, \\text{measured}}$ 的表达式代入仪器的 $\\hat{v}$ 计算中：\n$$\\hat{v} = \\frac{\\left( \\frac{2 f_0 v \\cos(\\theta)}{c} \\right) \\cdot c}{2 f_0 \\cos(\\hat{\\theta})}$$\n\n仪器参数 $f_0$ 和 $c$ 以及因子 $2$ 被消掉，留下一个仅取决于真实角度和估算角度的关系：\n$$\\hat{v} = v \\frac{\\cos(\\theta)}{\\cos(\\hat{\\theta})}$$\n\n速度估算中的分数误差定义为 $\\frac{\\hat{v} - v}{v}$。我们现在可以推导一个仅用 $\\theta$ 和 $\\hat{\\theta}$ 表示的此误差的表达式：\n$$\\text{分数误差} = \\frac{\\hat{v} - v}{v} = \\frac{v \\frac{\\cos(\\theta)}{\\cos(\\hat{\\theta})} - v}{v}$$\n从分子中提出因子 $v$ 并与分母相消，得到分数误差的最终表达式：\n$$\\text{分数误差} = \\frac{\\cos(\\theta)}{\\cos(\\hat{\\theta})} - 1$$\n\n接下来，我们计算在给定情况下，当真实角度为 $\\theta = 70^\\circ$ 且操作员输入的角度为 $\\hat{\\theta} = 75^\\circ$ 时，此分数误差的量值。\n$$\\text{分数误差} = \\frac{\\cos(70^\\circ)}{\\cos(75^\\circ)} - 1$$\n使用三角函数的值（参数以度为单位处理）：\n$$\\cos(70^\\circ) \\approx 0.34202014$$\n$$\\cos(75^\\circ) \\approx 0.25881905$$\n将这些值代入误差表达式：\n$$\\text{分数误差} \\approx \\frac{0.34202014}{0.25881905} - 1 \\approx 1.321464 - 1 = 0.321464$$\n问题要求此误差的量值，即 $|0.321464| = 0.321464$。四舍五入到四位有效数字，分数误差的量值为 $0.3215$。\n\n最后，我们必须说明为什么较大的声束-血流夹角会加剧速度估算对角度错误估计的敏感性。推导出的关系 $\\hat{v} = v \\frac{\\cos(\\theta)}{\\cos(\\hat{\\theta})}$ 表明，估算速度 $\\hat{v}$ 与 $\\cos(\\hat{\\theta})$ 成反比。为了分析敏感性，我们可以考察分数误差相对于角度微小误差的变化率。设 $\\hat{\\theta} = \\theta + \\Delta\\theta$，其中 $\\Delta\\theta$ 是微小的角度估算误差。分数误差 $E$ 由下式给出：\n$$E = \\frac{\\cos(\\theta)}{\\cos(\\theta + \\Delta\\theta)} - 1$$\n对于一个微小的误差 $\\Delta\\theta$（以弧度为单位），我们可以对分母使用一阶泰勒近似：$\\cos(\\theta + \\Delta\\theta) \\approx \\cos(\\theta) - \\sin(\\theta)\\Delta\\theta$。\n$$E \\approx \\frac{\\cos(\\theta)}{\\cos(\\theta) - \\sin(\\theta)\\Delta\\theta} - 1 = \\frac{1}{1 - \\frac{\\sin(\\theta)}{\\cos(\\theta)}\\Delta\\theta} - 1 = \\frac{1}{1 - \\tan(\\theta)\\Delta\\theta} - 1$$\n对于小的 $x$，使用近似 $\\frac{1}{1-x} \\approx 1+x$，其中 $x = \\tan(\\theta)\\Delta\\theta$：\n$$E \\approx \\left(1 + \\tan(\\theta)\\Delta\\theta\\right) - 1 = \\tan(\\theta)\\Delta\\theta$$\n该近似表明，对于给定的微小角度误差 $\\Delta\\theta$，分数误差与 $\\tan(\\theta)$ 成正比。正切函数 $\\tan(\\theta)$ 呈非线性增长，并且当角度 $\\theta$ 接近 $90^\\circ$ 时增长得非常迅速。例如，$\\tan(60^\\circ) \\approx 1.73$，而 $\\tan(80^\\circ) \\approx 5.67$，$\\tan(85^\\circ) \\approx 11.43$。这意味着在较大的声束-血流夹角下，因子 $\\tan(\\theta)$ 变得非常大，会将角度估算中的一个微小误差（$\\Delta\\theta$）放大为计算速度中的一个巨大分数误差。这是速度估算公式分母中 $\\cos(\\hat{\\theta})$ 项的直接结果，因为当 $\\hat{\\theta}$ 接近 $90^\\circ$ 时，$\\cos(\\hat{\\theta})$ 接近 $0$ 且其斜率变得更陡。", "answer": "$$\\boxed{0.3215}$$", "id": "4872505"}]}