{"hands_on_practices": [{"introduction": "超声波在组织中传播时的衰减是理解声影和声增强等伪影的关键。本练习将通过一个基础计算，帮助你掌握如何计算以分贝 ($dB$) 为单位的总衰减，并将其与超声强度的物理衰减联系起来。这是理解所有基于衰减的伪影的第一步。[@problem_id:4860626]", "problem": "一个非聚焦的脉冲回波超声系统对一个具有频率相关衰减的均匀软组织区域进行成像。一个中心频率为 $f=5$ 兆赫兹的平面波脉冲从换能器传播到一个位于轴向深度 $6$ 厘米处的小型完美反射靶点，并沿原路返回。介质的衰减系数，以分贝表示，为 $\\alpha_{\\mathrm{dB}}=0.5$ 分贝/厘米/兆赫兹。假设衰减与传播距离和频率均呈线性关系，并忽略除传播损耗外的任何其他效应（例如，忽略靶点以外的散射、波束发散和界面损耗）。使用分贝（dB）关于强度比的定义，确定：\n- 以分贝为单位的总往返衰减，以及\n- 相应的强度衰减因子（返回强度与发射强度之比），表示为一个不带百分号的纯小数。\n\n将你的两个结果以单行向量 $\\big[$衰减（分贝），强度衰减因子$\\big]$ 的形式报告。如果需要四舍五入，则保留四位有效数字。衰减必须以分贝（dB）表示，而衰减因子是无量纲的。", "solution": "该问题要求计算与超声衰减相关的两个量：以分贝为单位的总往返衰减，以及相应的强度衰减因子。\n\n首先，我们计算总衰减。问题提供了一个频率相关的软组织衰减系数，我们记为 $\\alpha_c$。其值为 $\\alpha_c = 0.5 \\, \\text{dB} \\cdot \\text{cm}^{-1} \\cdot \\text{MHz}^{-1}$。问题指出，衰减与传播距离和频率均呈线性关系。\n\n以分贝为单位的总衰减，我们称之为 $A_{\\text{total, dB}}$，使用以下公式计算：\n$$ A_{\\text{total, dB}} = \\alpha_c \\times x \\times f $$\n其中 $x$ 是总传播距离，$f$ 是超声脉冲的中心频率。\n\n给定的参数是：\n- 中心频率, $f = 5 \\, \\text{MHz}$。\n- 衰减系数, $\\alpha_c = 0.5 \\, \\text{dB} \\cdot \\text{cm}^{-1} \\cdot \\text{MHz}^{-1}$。\n- 靶点的轴向深度, $d = 6 \\, \\text{cm}$。\n\n超声脉冲从换能器传播到靶点，然后反射回换能器。这是一个往返路径。因此，脉冲传播的总距离 $x$ 是轴向深度 $d$ 的两倍：\n$$ x = 2d = 2 \\times 6 \\, \\text{cm} = 12 \\, \\text{cm} $$\n\n现在我们可以将 $\\alpha_c$、$x$ 和 $f$ 的数值代入衰减公式：\n$$ A_{\\text{total, dB}} = (0.5 \\, \\text{dB} \\cdot \\text{cm}^{-1} \\cdot \\text{MHz}^{-1}) \\times (12 \\, \\text{cm}) \\times (5 \\, \\text{MHz}) $$\n单位相互抵消，结果以分贝表示：\n$$ A_{\\text{total, dB}} = (0.5 \\times 12 \\times 5) \\, \\text{dB} = 30 \\, \\text{dB} $$\n这就是第一个要求解的量，即总往返衰减。\n\n其次，我们确定强度衰减因子。该因子定义为返回强度 $I_r$ 与发射强度 $I_e$ 之比。分贝（dB）衰减的定义将强度比与 $A_{\\text{total, dB}}$ 相关联：\n$$ A_{\\text{total, dB}} = 10 \\log_{10} \\left( \\frac{I_e}{I_r} \\right) $$\n我们已经计算出 $A_{\\text{total, dB}} = 30 \\, \\text{dB}$。将此值代入方程得到：\n$$ 30 = 10 \\log_{10} \\left( \\frac{I_e}{I_r} \\right) $$\n为了分离对数项，我们将等式两边同时除以 $10$：\n$$ 3 = \\log_{10} \\left( \\frac{I_e}{I_r} \\right) $$\n为了求解强度比，我们对等式两边应用以 $10$ 为底的对数的反函数，即以 $10$ 为底的指数运算：\n$$ 10^3 = \\frac{I_e}{I_r} $$\n$$ 1000 = \\frac{I_e}{I_r} $$\n问题要求的是强度衰减因子，即返回强度与发射强度之比 $\\frac{I_r}{I_e}$。这是我们刚刚计算出的比值的倒数：\n$$ \\text{强度衰减因子} = \\frac{I_r}{I_e} = \\frac{1}{1000} = 0.001 $$\n这就是第二个要求解的量。\n\n问题指明，如果需要四舍五入，结果应保留四位有效数字。根据给定参数的计算得出了精确结果：$A_{\\text{total, dB}} = 30$ 且衰减因子为 $0.001$。提供四位有效数字的指令意味着答案需要达到一定的精度水平。为了将这些精确值表示为四位有效数字，我们将其写为 $30.00$ 和 $0.001000$。\n\n最终结果是 $30.00 \\, \\text{dB}$ 的衰减和一个无量纲的强度衰减因子 $0.001000$。这些结果需要以单行向量的形式报告。", "answer": "$$\n\\boxed{\\begin{pmatrix} 30.00  0.001000 \\end{pmatrix}}\n$$", "id": "4860626"}, {"introduction": "强衰减或强反射的结构会产生声影，但这两者的贡献孰轻孰重？本练习将引导你探究导致声影的两种主要物理机制：界面反射和介质吸收。通过计算并比较这两种机制造成的强度损失，你将更深刻地理解为何骨骼等结构会投下如此强烈的声影。[@problem_id:4860687]", "problem": "一束角频率为 $\\omega$ 的平面超声波从软组织介质垂直入射到一块皮质骨板上。软组织的声阻抗为 $Z_1=1.6\\,\\mathrm{MRayl}$，骨的声阻抗为 $Z_2=7.8\\,\\mathrm{MRayl}$。骨板的厚度为 $d=1.0\\,\\mathrm{cm}$，其频率相关的衰减系数为 $\\alpha_b=20\\,\\mathrm{dB/cm/MHz}$。超声波的中心频率为 $f=3.0\\,\\mathrm{MHz}$。忽略模式转换以及体衰减所表示范围之外的表面或体积散射。假设在界面本身是垂直入射，且行为是线性和无损的。\n\n仅从平面声波在平坦界面处的边界条件（声压和法向质点速度的连续性）以及声阻抗的定义出发，推导软组织-骨界面上的强度反射系数 $R$ 和强度透射系数 $T$（用 $Z_1$ 和 $Z_2$ 表示）。然后，使用强度的分贝衰减定义，计算首次穿过骨板时因吸收而损失的入射强度分数，其定义为 $L_{\\mathrm{abs}} = T\\left(1-10^{-\\alpha_b f d/10}\\right)$。\n\n最后，定义一个主导指标 $s$，如果 $R > L_{\\mathrm{abs}}$（反射主导的声影），则 $s=1$；否则（吸收主导的声影），$s=0$。对给定的数值，计算 $R$、$T$ 和 $s$ 的值。\n\n将你的最终答案以单行向量 $\\big[R,\\;T,\\;s\\big]$ 的形式报告。提供精确值，不要四舍五入。所有报告的量均为无量纲量。", "solution": "该问题要求从第一性原理推导强度反射和透射系数。设一平面声波垂直入射到位于 $x=0$ 处的平面界面上，该界面分隔了两种声阻抗分别为 $Z_1$ 和 $Z_2$ 的介质。\n\n介质 1 ($x < 0$) 和介质 2 ($x > 0$) 中的声压场由下式给出：\n$$p_1(x,t) = p_i(x,t) + p_r(x,t) = P_i e^{i(k_1x - \\omega t)} + P_r e^{i(-k_1x - \\omega t)}$$\n$$p_2(x,t) = p_t(x,t) = P_t e^{i(k_2x - \\omega t)}$$\n其中 $P_i$、$P_r$ 和 $P_t$ 分别是入射波、反射波和透射波的复压幅。\n\n声阻抗 $Z$ 关联了声压 $p$ 和质点速度 $v$。对于前向传播的波，$p=Zv$；对于后向传播的波，$p=-Zv$。相应的质点速度为：\n$$v_1(x,t) = v_i(x,t) + v_r(x,t) = \\frac{P_i}{Z_1} e^{i(k_1x - \\omega t)} - \\frac{P_r}{Z_1} e^{i(-k_1x - \\omega t)}$$\n$$v_2(x,t) = v_t(x,t) = \\frac{P_t}{Z_2} e^{i(k_2x - \\omega t)}$$\n\n在界面 $x=0$ 处的边界条件要求声压和法向质点速度的连续性：\n1.  声压连续性：$p_1(0,t) = p_2(0,t) \\implies P_i + P_r = P_t$\n2.  法向质点速度连续性：$v_1(0,t) = v_2(0,t) \\implies \\frac{P_i}{Z_1} - \\frac{P_r}{Z_1} = \\frac{P_t}{Z_2}$\n\n我们可以求解这个方程组，得到声压反射系数 $R_p = P_r/P_i$ 和声压透射系数 $T_p = P_t/P_i$。将 $P_t = P_i + P_r$ 代入第二个方程：\n$$\\frac{1}{Z_1}(P_i - P_r) = \\frac{1}{Z_2}(P_i + P_r)$$\n$$Z_2(P_i - P_r) = Z_1(P_i + P_r)$$\n$$(Z_2 - Z_1)P_i = (Z_1 + Z_2)P_r$$\n$$R_p = \\frac{P_r}{P_i} = \\frac{Z_2 - Z_1}{Z_1 + Z_2}$$\n\n问题要求的是*强度*反射系数 $R$。强度 $I$ 与 $|P|^2/Z$ 成正比。\n$$R = \\frac{I_r}{I_i} = \\frac{|P_r|^2 / (2Z_1)}{|P_i|^2 / (2Z_1)} = \\left| \\frac{P_r}{P_i} \\right|^2 = |R_p|^2 = \\left(\\frac{Z_2 - Z_1}{Z_1 + Z_2}\\right)^2$$\n*强度*透射系数 $T$ 由下式给出：\n$$T = \\frac{I_t}{I_i} = \\frac{|P_t|^2 / (2Z_2)}{|P_i|^2 / (2Z_1)} = \\left| \\frac{P_t}{P_i} \\right|^2 \\frac{Z_1}{Z_2}$$\n首先，求 $T_p = P_t/P_i = (P_i+P_r)/P_i = 1+R_p$：\n$$T_p = 1 + \\frac{Z_2 - Z_1}{Z_1 + Z_2} = \\frac{Z_1 + Z_2 + Z_2 - Z_1}{Z_1 + Z_2} = \\frac{2Z_2}{Z_1 + Z_2}$$\n现在将此代入 $T$ 的表达式中：\n$$T = \\left(\\frac{2Z_2}{Z_1 + Z_2}\\right)^2 \\frac{Z_1}{Z_2} = \\frac{4Z_2^2}{(Z_1 + Z_2)^2} \\frac{Z_1}{Z_2} = \\frac{4Z_1 Z_2}{(Z_1 + Z_2)^2}$$\n这就完成了所要求的推导。\n\n接下来，我们使用给定的数值计算 $R$、$T$、$L_{\\mathrm{abs}}$ 和 $s$：\n$Z_1 = 1.6\\,\\mathrm{MRayl}$\n$Z_2 = 7.8\\,\\mathrm{MRayl}$\n$d = 1.0\\,\\mathrm{cm}$\n$\\alpha_b = 20\\,\\mathrm{dB/cm/MHz}$\n$f = 3.0\\,\\mathrm{MHz}$\n\n计算 $R$：\n$$R = \\left(\\frac{7.8 - 1.6}{1.6 + 7.8}\\right)^2 = \\left(\\frac{6.2}{9.4}\\right)^2 = \\left(\\frac{62}{94}\\right)^2 = \\left(\\frac{31}{47}\\right)^2 = \\frac{31^2}{47^2} = \\frac{961}{2209}$$\n对于无损界面，能量守恒，因此 $T = 1-R$。\n$$T = 1 - R = 1 - \\frac{961}{2209} = \\frac{2209 - 961}{2209} = \\frac{1248}{2209}$$\n\n现在，我们计算因吸收而损失的入射强度分数 $L_{\\mathrm{abs}}$。公式为 $L_{\\mathrm{abs}} = T\\left(1-10^{-\\alpha_b f d/10}\\right)$。指数项表示总衰减（以分贝为单位）除以 10。\n以 $\\mathrm{dB}$ 为单位的总衰减为：\n$$\\alpha_{dB} = \\alpha_b \\times f \\times d = (20\\,\\mathrm{dB/cm/MHz}) \\times (3.0\\,\\mathrm{MHz}) \\times (1.0\\,\\mathrm{cm}) = 60\\,\\mathrm{dB}$$\n公式中的指数为 $-\\frac{\\alpha_b f d}{10} = -\\frac{60}{10} = -6$。\n现在，计算 $L_{\\mathrm{abs}}$：\n$$L_{\\mathrm{abs}} = T\\left(1 - 10^{-6}\\right) = \\frac{1248}{2209}\\left(1 - \\frac{1}{1000000}\\right) = \\frac{1248}{2209}\\left(\\frac{999999}{1000000}\\right)$$\n\n最后，我们必须通过比较 $R$ 和 $L_{\\mathrm{abs}}$ 来确定主导指标 $s$。\n$$R = \\frac{961}{2209}$$\n$$L_{\\mathrm{abs}} = \\frac{1248}{2209}\\left(1 - 10^{-6}\\right)$$\n我们检验条件 $R > L_{\\mathrm{abs}}$：\n$$\\frac{961}{2209} > \\frac{1248}{2209}\\left(1 - 10^{-6}\\right)$$\n由于分母 $2209$ 是正数，我们可以比较分子：\n$$961 > 1248\\left(1 - 10^{-6}\\right)$$\n$$961 > 1248 - 1248 \\times 10^{-6}$$\n$$961 > 1247.998752$$\n这个不等式是假的。因此，$R \\le L_{\\mathrm{abs}}$。根据问题定义，这意味着 $s=0$。\n声影是吸收主导的。\n\n需要报告的最终值为 $R=\\frac{961}{2209}$、$T=\\frac{1248}{2209}$ 和 $s=0$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{961}{2209}  \\frac{1248}{2209}  0\n\\end{pmatrix}\n}\n$$", "id": "4860687"}, {"introduction": "从理论走向实践，我们如何从图像数据中测量声影效应？这项高级练习让你扮演一名医学影像科学家的角色。你将建立一个同时包含反射和吸收的数学模型，并利用该模型分析模拟的超声数据，最终估算出两种效应对整体声影的各自贡献。[@problem_id:4860703]", "problem": "考虑一维超声波在软组织中沿直线声束路径传播，其中在一定深度嵌入了一个圆形的钙化包涵体。假设压力波为时间谐波，其衍射可忽略不计，因此沿每个声束的强度在介质中遵循指数衰减规律。将钙化包涵体建模为一个半径为 $r$、振幅吸收系数为 $\\alpha$（单位：奈培/厘米）的均匀圆盘，嵌入在软组织中。与包涵体相比，在所关注的短距离内，软组织的衰减可忽略不计。设软组织-钙化界面处的声阻抗失配产生一个功率（强度）反射系数 $R$（无量纲），并假设在回波的往返路径中，四次穿过包涵体边界时该系数为恒定且相同。\n\n基础原理和定义：\n- 在振幅吸收系数为 $\\alpha$ 的均匀吸收介质中，平面波在传播路径长度 $x$ 后衰减的强度 $I(x)$ 遵循 $I(x) = I_0 \\exp(-2 \\alpha x)$，其中 $I_0$ 是路径起点的入射强度。\n- 在不同阻抗介质之间的正入射界面上，入射强度的一部分 $R$ 被反射，一部分 $1 - R$ 被透射。忽略界面吸收。\n- 在脉冲回波超声亮度模式（B模式）中，由高衰减包涵体引起的远端亮度降低源于两种机制：界面反射降低了透射强度，以及在往返路径长度上包涵体内部的吸收。\n\n几何结构：\n- 对于相对于包涵体中心横向位置为 $x$ 的直线声束，穿过包涵体的弦长为 $L(x) = 2\\sqrt{r^2 - x^2}$（当 $\\lvert x \\rvert \\le r$ 时），否则 $L(x) = 0$。\n\n任务：\n1. 仅使用上述基本原理，推导与包涵体相交的声束的远端回波强度比 $I_{\\text{meas}}(x)/I_{\\text{base}}$ 的表达式，用 $R$、$\\alpha$ 和 $L(x)$ 表示，其中 $I_{\\text{base}}$ 是在没有包涵体时测得的基线强度。\n2. 展示如何将推导出的表达式转换为适合于从多个声束位置 $x$ 的测量值 $I_{\\text{meas}}(x)$ 对两个未知参数 $R$ 和 $\\alpha$ 进行线性最小二乘估计的形式。\n3. 实现一个程序，对于每个测试用例，根据给定的半径和横向位置计算 $L(x)$，仅选择那些 $L(x) > 0$ 的声束，并执行双参数拟合来估计 $R$ 和 $\\alpha$。您的程序应返回每个测试用例的 $R$（无量纲）和 $\\alpha$（单位：奈培/厘米）。\n\n假设：\n- 将 $I_{\\text{base}}$ 视为已知，并在所关注的横向位置上是均匀的。\n- 忽略散射各向异性和任何斑点统计特性的变化；将远端回波强度视为仅由包涵体引起的透射和返回平面波强度因子的比例。\n- 对于 $L(x) = 0$ 的声束，包涵体未被穿过，测量强度等于 $I_{\\text{base}}$；不要在参数拟合中使用这些声束。\n\n测试套件：\n使用以下测试用例。每个用例给出包涵体半径 $r$（厘米）、横向声束位置 $\\{x_i\\}$（厘米）和测量的远端强度 $\\{I_{\\text{meas}}(x_i)\\}$（任意单位，其中 $I_{\\text{base}} = 1.0$ 单位）。数据与钙化包涵体模型一致，并提供给您的程序直接使用。\n\n- 测试用例 A（高 $R$ 和高 $\\alpha$）：\n  - $r = 0.5$ 厘米\n  - $x$ 值：$[-0.5, -0.25, 0.0, 0.25, 0.5]$ 厘米\n  - $I_{\\text{meas}}$：$[1.0, 0.0064098, 0.0051687, 0.0064098, 1.0]$ 单位\n\n- 测试用例 B（中等 $R$ 和高 $\\alpha$）：\n  - $r = 0.4$ 厘米\n  - $x$ 值：$[-0.4, -0.2, 0.0, 0.2, 0.4]$ 厘米\n  - $I_{\\text{meas}}$：$[1.0, 0.1025, 0.0827, 0.1025, 1.0]$ 单位\n\n- 测试用例 C（高 $R$ 和低 $\\alpha$）：\n  - $r = 0.3$ 厘米\n  - $x$ 值：$[-0.3, -0.15, 0.0, 0.15, 0.3]$ 厘米\n  - $I_{\\text{meas}}$：$[1.0, 0.00731, 0.00719, 0.00731, 1.0]$ 单位\n\n答案规格和输出格式：\n- 通过对提供的测量强度进行拟合，估算每个测试用例的 $R$（无量纲）和 $\\alpha$（奈培/厘米）。\n- 您的程序应生成单行输出，其中包含三个测试用例的估计参数对，格式为逗号分隔的列表的列表，例如：`[[R_A,alpha_A],[R_B,alpha_B],[R_C,alpha_C]]`。不应打印任何附加文本。", "solution": "### 第1部分：强度比的推导\n分析遵循脉冲回波从换能器出发，穿过包涵体，到达远端反射体，然后返回的往返过程。强度比 $I_{\\text{meas}}(x)/I_{\\text{base}}$ 量化了包涵体的遮蔽效应。\n\n1.  **基线强度 ($I_{\\text{base}}$):** 在没有包涵体的情况下，一个脉冲被发射出去，从一个远端结构反射，然后返回到换能器。根据问题陈述，得到的测量强度是 $I_{\\text{base}}$。我们可以将其视为参考信号强度。\n\n2.  **有包涵体时的测量强度 ($I_{\\text{meas}}(x)$):** 我们追踪在横向位置 $x$ 处与包涵体相交的声束路径上衰减强度的因素。\n    -   **界面穿越：** 问题陈述有四次相同的界面穿越：在去程路径上进入包涵体，在去程路径上离开，在返回路径上重新进入，以及在返回路径上重新离开。在每次穿越时，强度乘以透射系数 $(1 - R)$。由于有四次这样的穿越，由界面反射引起的总强度降低因子是 $(1 - R)^4$。\n    -   **包涵体内部吸收：** 超声脉冲在去程路径上穿过包涵体的路径长度为 $L(x)$，在返回路径上再次穿过，因此在吸收介质中的总路径长度为 $2L(x)$。根据给定的衰减定律 $I(x) = I_0 \\exp(-2 \\alpha x)$，对于 $2L(x)$ 的路径长度，强度降低因子为 $\\exp(-2 \\alpha [2L(x)]) = \\exp(-4 \\alpha L(x))$。\n\n3.  **强度比：** 带有包涵体时的测量强度 $I_{\\text{meas}}(x)$ 是基线强度 $I_{\\text{base}}$ 乘以这两个降低因子。\n    $$\n    I_{\\text{meas}}(x) = I_{\\text{base}} \\cdot (1 - R)^4 \\cdot \\exp(-4 \\alpha L(x))\n    $$\n    所需的表达式是比率 $I_{\\text{meas}}(x) / I_{\\text{base}}$：\n    $$\n    \\frac{I_{\\text{meas}}(x)}{I_{\\text{base}}} = (1-R)^4 \\exp(-4 \\alpha L(x))\n    $$\n\n### 第2部分：为最小二乘估计进行线性化\n推导出的表达式是参数 $R$ 和 $\\alpha$ 的非线性函数。为了使用线性最小二乘法，我们必须将其转换为线性形式。对两边取自然对数可以实现这一点：\n$$\n\\ln\\left( \\frac{I_{\\text{meas}}(x)}{I_{\\text{base}}} \\right) = \\ln\\left( (1-R)^4 \\exp(-4 \\alpha L(x)) \\right)\n$$\n使用对数的性质 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(e^z) = z$：\n$$\n\\ln\\left( \\frac{I_{\\text{meas}}(x)}{I_{\\text{base}}} \\right) = \\ln((1-R)^4) + \\ln(\\exp(-4 \\alpha L(x)))\n$$\n$$\n\\ln\\left( \\frac{I_{\\text{meas}}(x)}{I_{\\text{base}}} \\right) = 4\\ln(1-R) - 4\\alpha L(x)\n$$\n这个方程是直线形式 $y = c + m \\cdot z$，其中：\n-   因变量是 $y_i = \\ln\\left( \\frac{I_{\\text{meas}}(x_i)}{I_{\\text{base}}} \\right)$。\n-   自变量是 $z_i = L(x_i) = 2\\sqrt{r^2 - x_i^2}$。\n-   y轴截距是 $c = 4\\ln(1-R)$。\n-   斜率是 $m = -4\\alpha$。\n\n通过对数据点 $(z_i, y_i)$ 进行线性回归，我们可以估计斜率 $m_{\\text{est}}$ 和截距 $c_{\\text{est}}$。然后可以通过反转这些关系来确定未知的物理参数 $R$ 和 $\\alpha$：\n$$\n\\alpha = -\\frac{m_{\\text{est}}}{4}\n$$\n$$\nc_{\\text{est}} = 4\\ln(1-R) \\implies \\frac{c_{\\text{est}}}{4} = \\ln(1-R) \\implies \\exp\\left(\\frac{c_{\\text{est}}}{4}\\right) = 1-R\n$$\n$$\nR = 1 - \\exp\\left(\\frac{c_{\\text{est}}}{4}\\right)\n$$\n\n### 第3部分：算法实现\n程序将为每个测试用例执行以下步骤：\n1.  接收半径 $r$、横向位置集合 $\\{x_i\\}$ 和相应的测量强度 $\\{I_{\\text{meas}}(x_i)\\}$。给定 $I_{\\text{base}} = 1.0$。\n2.  筛选数据。对于每对 $(x_i, I_{\\text{meas}}(x_i))$，计算弦长平方的四分之一 $L(x_i)^2/4 = r^2 - x_i^2$。如果该值为正，则继续。如果为零或负（即声束不穿过包涵体），则按规定丢弃该数据点。\n3.  对于每个有效数据点，计算自变量 $z_i = L(x_i) = 2\\sqrt{r^2 - x_i^2}$ 和因变量 $y_i = \\ln(I_{\\text{meas}}(x_i))$（因为 $I_{\\text{base}} = 1.0$）。\n4.  为最小二乘问题构建一个线性方程组 $A \\mathbf{p} = \\mathbf{b}$，其中 $\\mathbf{p} = [c, m]^T$ 是待估计的参数向量。\n    -   矩阵 $A$ 有两列：第一列是全为1的列（用于截距 $c$），第二列是 $z_i$ 值的向量。\n    -   向量 $\\mathbf{b}$ 是 $y_i$ 值的向量。\n5.  使用标准的线性最小二乘求解器（如 `numpy.linalg.lstsq`）求解 $\\mathbf{p}$。这将得到估计的截距 $c_{\\text{est}}$ 和斜率 $m_{\\text{est}}$。\n6.  使用第2部分中推导的公式计算物理参数 $R$ 和 $\\alpha$。\n7.  收集每个测试用例的参数对 $[R, \\alpha]$，并将最终输出格式化为列表的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the reflection coefficient (R) and absorption coefficient (alpha)\n    for a series of test cases modelling acoustic shadowing by a calcified inclusion.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # Each tuple contains:\n    # r (float): radius of the inclusion in cm.\n    # x_values (list of floats): lateral beam positions in cm.\n    # i_meas_values (list of floats): measured distal intensities in arbitrary units.\n    # I_base is assumed to be 1.0.\n    test_cases = [\n        (0.5, [-0.5, -0.25, 0.0, 0.25, 0.5], [1.0, 0.0064098, 0.0051687, 0.0064098, 1.0]),\n        (0.4, [-0.4, -0.2, 0.0, 0.2, 0.4], [1.0, 0.1025, 0.0827, 0.1025, 1.0]),\n        (0.3, [-0.3, -0.15, 0.0, 0.15, 0.3], [1.0, 0.00731, 0.00719, 0.00731, 1.0]),\n    ]\n\n    results = []\n    for r, x_values, i_meas_values in test_cases:\n        # The linearized model is y = c + m*z, where:\n        # y = ln(I_meas / I_base)\n        # z = L(x) = 2 * sqrt(r^2 - x^2)\n        # c = 4 * ln(1 - R)\n        # m = -4 * alpha\n        \n        z_coords = [] # Independent variable L(x)\n        y_coords = [] # Dependent variable ln(I_meas)\n        i_base = 1.0\n\n        for x, i_meas in zip(x_values, i_meas_values):\n            # Calculate chord length L(x).\n            # The problem states to only use beams with L(x) > 0.\n            # This is equivalent to r^2 - x^2 > 0.\n            if r**2 - x**2 > 1e-9: # Use a small tolerance for floating point comparison\n                L_x = 2.0 * np.sqrt(r**2 - x**2)\n                \n                # The intensity ratio must be positive for the logarithm.\n                if i_meas / i_base > 0:\n                    y = np.log(i_meas / i_base)\n                    z_coords.append(L_x)\n                    y_coords.append(y)\n\n        # Convert to numpy arrays for linear algebra operations.\n        z_coords = np.array(z_coords)\n        y_coords = np.array(y_coords)\n        \n        # Set up the matrix A for the least-squares problem A*p = b,\n        # where p = [c, m]^T.\n        # A will have a column of ones for the intercept 'c' and a column\n        # of z_coords for the slope 'm'.\n        A = np.vstack([np.ones(len(z_coords)), z_coords]).T\n        \n        # The vector b is the set of observed y_coords.\n        b = y_coords\n        \n        # Perform linear least-squares regression.\n        # It solves for p that minimizes the squared Euclidean 2-norm ||b - A*p||^2.\n        p, _, _, _ = np.linalg.lstsq(A, b, rcond=None)\n        c_est, m_est = p[0], p[1] # Estimated intercept and slope\n        \n        # Calculate R and alpha from the estimated intercept and slope.\n        # alpha = -m_est / 4\n        # R = 1 - exp(c_est / 4)\n        alpha = -m_est / 4.0\n        R = 1.0 - np.exp(c_est / 4.0)\n        \n        results.append([R, alpha])\n\n    # Format the final output string as specified.\n    # e.g., [[R_A,alpha_A],[R_B,alpha_B],[R_C,alpha_C]]\n    # Using a list comprehension and f-string for concise formatting.\n    output_str = f\"[{','.join([f'[{r_val},{a_val}]' for r_val, a_val in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "4860703"}]}