{"hands_on_practices": [{"introduction": "理解多普勒效应是基础，但实际的成像过程涉及到复杂的系统设置。第一个练习将探讨电子声束转向（线性阵列探头的一个共同特征）如何改变超声声束与血流之间的有效角度。通过推导多普勒频移作为血流方向和转向角度的函数，您将亲身体验操作者如何优化多普勒信号并正确解读其符号，这对于理解仪器控制如何直接影响物理测量和最终的彩色图谱至关重要 [@problem_id:4868781]。", "problem": "一个超声线阵探头用于在声速为 $c$ 的均匀介质中进行彩色血流多普勒成像 (CFD)。探头阵列表面被对齐，使得成像垂直轴与指向组织的阵列声学法线方向重合。声束在成像平面内相对于声学法线被电子偏转一个角度 $\\beta$，其中成像平面内的顺时针旋转定义为正 $\\beta$。一根直血管内血液以恒定速度大小 $v$ 流动，其在成像平面内的流动方向与声学法线形成一个角度 $\\varphi$，同样定义该平面内的顺时针旋转为正 $\\varphi$。发射中心频率为 $f_{0}$。假设存在随血液进行刚性运动的点状后向散射体，并忽略任何平面外的运动。\n\n从适用于脉冲回波系统的第一性原理出发，即瞬时频率定义为接收信号相位的时间导数，以及速度在传播方向上的投影，推导声束偏转如何改变传播方向与血流方向之间的有效角。然后，求出测得的脉冲回波多普勒频移 $f_{d}$ 作为 $\\beta$、$\\varphi$、$v$、$f_{0}$ 和 $c$ 的显式函数，并包括所选几何结构所隐含的符号。根据推导出的 $f_{d}$，明确说明相对于换能器的血流方向的符号约定。\n\n最后，计算以下两种偏转角情况下的 $f_{d}$：\n- 情况1：$c = 1540\\,\\text{m/s}$，$f_{0} = 5.0\\,\\text{MHz}$，$v = 0.40\\,\\text{m/s}$，$\\varphi = +30^{\\circ}$，$\\beta = +20^{\\circ}$。\n- 情况2：$c = 1540\\,\\text{m/s}$，$f_{0} = 5.0\\,\\text{MHz}$，$v = 0.40\\,\\text{m/s}$，$\\varphi = +30^{\\circ}$，$\\beta = -25^{\\circ}$。\n\n角度以度为单位给出；在计算三角函数时，需将角度转换为弧度。将每个数值结果四舍五入到四位有效数字。最终答案以 $\\text{Hz}$ 为单位表示。", "solution": "彩色血流多普勒成像的相关物理图像涉及一个发射的平面波，该平面波沿着由声束偏转设定的单位方向 $\\hat{\\boldsymbol{k}}$ 传播，与移动的点状散射体相互作用，并返回一个回波，其相位取决于散射体沿传播方向的位置。对于速度较小 ($|v| \\ll c$) 的脉冲回波超声，一个标准且经过充分验证的方法是将接收信号的相位建模为发射相位累积到散射体再返回的两倍，其中散射体的运动通过其位置 $\\boldsymbol{r}_{s}(t)$ 体现。\n\n设发射的平面波角频率为 $\\omega_{0} = 2\\pi f_{0}$，波数大小为 $k = \\omega_{0}/c$。散射体的位置为 $\\boldsymbol{r}_{s}(t)$，速度为 $\\boldsymbol{v}$。超声波束的传播方向为 $\\hat{\\boldsymbol{k}}$。信号从换能器传播到散射体再返回的总路径长度为 $2 (\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{r}_{s}(t))$。这导致接收信号的相位相对于发射信号有一个变化。接收信号的瞬时相位 $\\phi(t)$ 可以表示为：\n$$\n\\phi(t) = \\omega_{0}t - 2k(\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{r}_{s}(t))\n$$\n瞬时角频率是相位的导数 $\\omega_{\\text{inst}} = d\\phi(t)/dt$，因此瞬时频率为：\n$$\nf_{\\text{inst}}(t) = \\frac{1}{2\\pi}\\frac{d\\phi(t)}{dt} = \\frac{1}{2\\pi}\\left(\\omega_{0} - 2k(\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{v})\\right) = f_{0} - \\frac{k}{\\pi}(\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{v})\n$$\n多普勒频移 $f_{d}$ 定义为接收频率与发射频率之差：\n$$\nf_{d} = f_{\\text{inst}} - f_{0} = - \\frac{k}{\\pi}(\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{v})\n$$\n代入 $k = 2\\pi f_0 / c$，我们得到：\n$$\nf_{d} = - \\frac{2\\pi f_0 / c}{\\pi}(\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{v}) = -\\frac{2f_0}{c}(\\boldsymbol{v} \\cdot \\hat{\\boldsymbol{k}})\n$$\n等效地，如果我们将径向分量 $v_{r} = \\boldsymbol{v} \\cdot \\hat{\\boldsymbol{k}}$ 定义为沿传播方向（远离换能器）为正，那么：\n$$\nf_{d} = -\\,\\frac{2\\,f_{0}}{c}\\,v_{r}.\n$$\n这个符号约定意味着远离换能器的运动（正 $v_{r}$）产生负的多普勒频移，而朝向换能器的运动（负 $v_{r}$）产生正的多普勒频移。许多显示约定将正 $f_{d}$（朝向）和负 $f_{d}$（远离）映射到不同的颜色；例如，常用的“蓝离红朝”(Blue Away, Red Toward) 映射将负频移指定为蓝色，正频移指定为红色。\n\n我们现在用几何关系来表示 $v_{r}$。设成像垂直轴与指向组织的声学法线重合。声束偏转角 $\\beta$ 将传播方向 $\\hat{\\boldsymbol{k}}$ 从声学法线顺时针旋转 $\\beta$。同样，血流方向从声学法线顺时针旋转 $\\varphi$。在成像平面内，传播方向和血流方向的单位矢量分别为：\n$$\n\\hat{\\boldsymbol{k}} = \\begin{pmatrix}\\cos\\beta \\\\ \\sin\\beta\\end{pmatrix}, \\quad \\hat{\\boldsymbol{v}} = \\begin{pmatrix}\\cos\\varphi \\\\ \\sin\\varphi\\end{pmatrix},\n$$\n且 $\\boldsymbol{v} = v\\,\\hat{\\boldsymbol{v}}$。它们的点积为：\n$$\n\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{v} = v\\,\\left(\\cos\\beta\\,\\cos\\varphi + \\sin\\beta\\,\\sin\\varphi\\right) = v\\,\\cos\\left(\\varphi - \\beta\\right).\n$$\n因此，血流方向与声束传播方向之间的有效角为 $\\theta_{\\text{eff}} = \\varphi - \\beta$，测得的多普勒频移变为：\n$$\nf_{d}(\\beta,\\varphi) = -\\,\\frac{2\\,f_{0}}{c}\\,v\\,\\cos\\!\\left(\\varphi - \\beta\\right).\n$$\n从这个表达式可以看出，偏转通过改变 $\\beta$ 线性地改变 $\\theta_{\\text{eff}}$，这既通过余弦因子调制了频移的幅度，也可能在 $\\cos\\!\\left(\\varphi - \\beta\\right)$ 变号时（即 $\\theta_{\\text{eff}}$ 越过 $90^{\\circ}$ 时）改变 $f_{d}$ 的符号。此处采用的符号约定是：正 $f_{d}$ 表示朝向换能器的运动；负 $f_{d}$ 表示远离换能器的运动。\n\n我们现在对这两种情况进行数值计算。使用 $c = 1540\\,\\text{m/s}$，$f_{0} = 5.0 \\times 10^{6}\\,\\text{Hz}$，$v = 0.40\\,\\text{m/s}$，以及 $\\varphi = +30^{\\circ}$。角度以度为单位给出；在计算余弦时，将角度转换为弧度，或使用已知的角度参数的余弦值。\n\n首先计算公共比例因子：\n$$\nS = \\frac{2\\,f_{0}\\,v}{c} = \\frac{2 \\times (5.0 \\times 10^{6}) \\times 0.40}{1540} = \\frac{4.0 \\times 10^{6}}{1540} \\approx 2597.402597\\,.\n$$\n\n情况1中 $\\beta = +20^{\\circ}$，所以 $\\theta_{\\text{eff}} = \\varphi - \\beta = 30^{\\circ} - 20^{\\circ} = 10^{\\circ}$ 且 $\\cos(10^{\\circ}) \\approx 0.984807753$。因此，\n$$\nf_{d,1} = -\\,S\\,\\cos(10^{\\circ}) \\approx -\\,2597.402597 \\times 0.984807753 \\approx -\\,2557.942222\\,\\text{Hz}.\n$$\n四舍五入到四位有效数字：$-2558\\,\\text{Hz}$。\n\n情况2中 $\\beta = -25^{\\circ}$，所以 $\\theta_{\\text{eff}} = \\varphi - \\beta = 30^{\\circ} - (-25^{\\circ}) = 55^{\\circ}$ 且 $\\cos(55^{\\circ}) \\approx 0.573576436$。因此，\n$$\nf_{d,2} = -\\,S\\,\\cos(55^{\\circ}) \\approx -\\,2597.402597 \\times 0.573576436 \\approx -\\,1489.808929\\,\\text{Hz}.\n$$\n四舍五入到四位有效数字：$-1490\\,\\text{Hz}$。\n\n解释与引申：将偏转角 $\\beta$ 从 $+20^{\\circ}$ 变为 $-25^{\\circ}$ 会使有效角 $\\theta_{\\text{eff}}$ 从 $10^{\\circ}$ 增加到 $55^{\\circ}$，从而减小了 $|\\cos(\\theta_{\\text{eff}})|$ 的值，并因此显著减小了 $|f_{d}|$。在这两种情况下，符号都保持为负，因为 $\\theta_{\\text{eff}}$ 保持在 $90^{\\circ}$ 以下，这意味着速度的径向分量仍然指向远离换能器的方向。在实践中，此处推导的符号约定为颜色分配提供了依据：如果系统将正 $f_{d}$ 映射为“朝向”，那么这些负频移将被显示为“远离”。将 $\\theta_{\\text{eff}}$ 推过 $90^{\\circ}$ 的声束偏转会导致符号反转，但典型的线阵探头偏转极限（约 $\\pm 20^{\\circ}$ 到 $\\pm 30^{\\circ}$）通常会阻止在给定血管方向下发生此类反转。", "answer": "$$\\boxed{\\begin{pmatrix}-2558  -1490\\end{pmatrix}}$$", "id": "4868781"}, {"introduction": "虽然掌握多普勒角是关键，但理解其局限性也同样重要。本练习将深入探讨多普勒超声中的一个关键限制：当超声声束与血流方向接近垂直时，速度测量的不可靠性 [@problem_id:4868766]。您将不仅仅依赖于 $\\cos(90^\\circ)=0$ 这一简单事实，而是通过推导信号相位测量中的微小噪声与最终速度估计误差之间的关系，从而定量地解释为何当角度接近 $90^\\circ$ 时，测量结果会变得极其不稳定。", "problem": "一个超声彩色血流多普勒成像系统使用中心频率 $f_{0}$，以脉冲重复频率 (PRF) 发送脉冲序列，并利用复解调回波的滞后一自相关的相位来估计平均血流速度。考虑软组织中的声速为 $c$。一根血管中的血液以恒定速度 $v$ 流动，其方向与波束轴的夹角为 $\\theta$。假设测量的滞后一自相关相位带有一个加性零均值噪声，其标准差为 $\\sigma_{\\phi}$，并且在所考虑的工作条件下，该噪声近似独立于 $\\theta$。角度以度为单位。\n\n仅从反向散射多普勒频移的定义以及采样的复正弦信号的相位增量与其频率之间的关系出发，推导速度估计的标准差 $\\sigma_{v}$ 关于 $\\sigma_{\\phi}$、$f_{0}$、$\\text{PRF}$、$c$ 和 $\\theta$ 的表达式。利用此表达式，根据推导出的公式解释为什么当 $\\theta$ 接近 $90^{\\circ}$ 时，速度估计会变得不稳定。\n\n然后，对于一个系统，其参数为 $f_{0} = 4.0\\,\\text{MHz}$，$\\text{PRF} = 6.0 \\times 10^{3}\\,\\text{s}^{-1}$，$c = 1540\\,\\text{m}\\,\\text{s}^{-1}$，$v = 0.60\\,\\text{m}\\,\\text{s}^{-1}$，以及 $\\sigma_{\\phi} = 0.060\\,\\text{rad}$，计算在 $\\theta_{1} = 60^{\\circ}$ 和 $\\theta_{2} = 88^{\\circ}$ 之间的放大因子\n$$\nA \\equiv \\frac{\\sigma_{v}(\\theta_{2})}{\\sigma_{v}(\\theta_{1})}\n$$\n\n将 $A$ 以无量纲数的形式给出，并四舍五入到三位有效数字。", "solution": "彩色血流多普勒速度估计的基本依据包括两个经过充分验证的事实：\n\n1. 来自运动血液的超声反向散射多普勒频移由下式给出\n$$\nf_{D} = \\frac{2 f_{0}}{c}\\, v \\cos\\theta,\n$$\n其中 $f_{0}$ 是发射中心频率，$c$ 是声速，$v$ 是血流速度，$\\theta$ 是波束与血流方向的夹角。\n\n2. 对于一个在慢时间上以脉冲重复频率 (PRF) 采样的复正弦信号，每个序列样本的相位提前（即滞后一自相关的平均相位）与该正弦信号的频率关系如下：\n$$\n\\Delta\\phi = 2\\pi \\frac{f_{D}}{\\text{PRF}}.\n$$\n\n结合这两个关系式，可以得到期望的滞后一相位作为 $v$ 和 $\\theta$ 的函数：\n$$\n\\Delta\\phi = 2\\pi \\frac{1}{\\text{PRF}} \\left(\\frac{2 f_{0}}{c}\\, v \\cos\\theta\\right) = \\frac{4\\pi f_{0}}{c\\,\\text{PRF}}\\, v \\cos\\theta.\n$$\n\n对 $v$ 求解，用测得的相位 $\\Delta\\phi$ 表示，得到速度估计器\n$$\n\\hat{v} = \\frac{c\\,\\text{PRF}}{4\\pi f_{0}} \\frac{\\Delta\\phi}{\\cos\\theta}.\n$$\n\n现在将相位测量建模为 $\\Delta\\phi_{\\text{meas}} = \\Delta\\phi + \\eta$，其中 $\\eta$ 是零均值噪声，其标准差为 $\\sigma_{\\phi}$，且近似独立于 $\\theta$。对小的相位噪声使用一阶（线性）误差传播，速度估计的标准差为\n$$\n\\sigma_{v} = \\left|\\frac{\\partial \\hat{v}}{\\partial \\Delta\\phi}\\right| \\sigma_{\\phi} = \\left|\\frac{c\\,\\text{PRF}}{4\\pi f_{0}} \\frac{1}{\\cos\\theta}\\right| \\sigma_{\\phi} = \\frac{c\\,\\text{PRF}}{4\\pi f_{0}} \\frac{\\sigma_{\\phi}}{|\\cos\\theta|}.\n$$\n\n这个表达式明确地解释了为什么当 $\\theta \\to 90^{\\circ}$ 时估计会变得不稳定：因子 $1/|\\cos\\theta|$ 会发散，因为 $|\\cos\\theta| \\to 0$，所以任何固定的相位噪声 $\\sigma_{\\phi}$ 在速度域中都会被无限放大。此外，携带信号的相位本身，\n$$\n|\\Delta\\phi| = \\frac{4\\pi f_{0}}{c\\,\\text{PRF}}\\, v |\\cos\\theta|,\n$$\n会随着 $|\\cos\\theta|$ 线性减小，从而降低了有效相位信噪比。这些效应共同作用，使得速度估计在接近 $90^{\\circ}$ 时变得高度敏感和不稳定。\n\n对于所求的两个角度之间的放大因子，常数项会相互抵消：\n$$\nA \\equiv \\frac{\\sigma_{v}(\\theta_{2})}{\\sigma_{v}(\\theta_{1})} = \\frac{\\dfrac{c\\,\\text{PRF}}{4\\pi f_{0}} \\dfrac{\\sigma_{\\phi}}{|\\cos\\theta_{2}|}}{\\dfrac{c\\,\\text{PRF}}{4\\pi f_{0}} \\dfrac{\\sigma_{\\phi}}{|\\cos\\theta_{1}|}} = \\frac{|\\cos\\theta_{1}|}{|\\cos\\theta_{2}|}.\n$$\n\n代入 $\\theta_{1} = 60^{\\circ}$ 和 $\\theta_{2} = 88^{\\circ}$：\n$$\nA = \\frac{|\\cos 60^{\\circ}|}{|\\cos 88^{\\circ}|} = \\frac{0.5}{\\cos 88^{\\circ}}.\n$$\n\n注意到 $\\cos 88^{\\circ} = \\sin 2^{\\circ}$，而 $\\sin 2^{\\circ}$ 是\n$$\n\\sin 2^{\\circ} \\approx 0.0348994967.\n$$\n因此，\n$$\nA \\approx \\frac{0.5}{0.0348994967} \\approx 14.323944878.\n$$\n\n四舍五入到三位有效数字，放大因子为\n$$\nA \\approx 14.3.\n$$", "answer": "$$\\boxed{14.3}$$", "id": "4868766"}, {"introduction": "彩色多普勒成像提供了一幅速度图，但其最终的临床应用价值通常在于量化总血流量。这最后一个练习连接了流体动力学和多普勒成像的原理，用于计算容积流率这一关键的临床参数 [@problem_id:4868840]。通过对血管横截面上的速度分布进行积分，您不仅能计算出这个重要的指标，还将揭示仪器自身的处理过程（特别是时间平均）如何导致测量值与真实的瞬时生理状况之间产生微妙但重要的偏差。", "problem": "一个圆柱形血管具有圆形横截面，半径为 $R = 3.0\\,\\mathrm{mm}$。在以时间 $t_{0}$ 为中心的给定心动周期时相，血管内的瞬时轴向速度场是轴对称的，并且可以很好地用层流泊肃叶流（laminar Poiseuille flow）来近似，其表达式为 $v(r,t) = V_{\\max}(t)\\left(1 - \\left(\\frac{r}{R}\\right)^{2}\\right)$，适用于 $0 \\le r \\le R$，其中 $r$ 是横截面中的径向坐标。峰值中心线速度随时间变化，其关系为 $V_{\\max}(t) = V_{0} + V_{1}\\sin\\!\\left(2\\pi f t\\right)$，其中 $V_{0} = 0.40\\,\\mathrm{m/s}$，$V_{1} = 0.20\\,\\mathrm{m/s}$，$f = 4.0\\,\\mathrm{Hz}$。考虑 $t_{0} = \\frac{1}{4f}$。\n\n一个彩色多普勒血流（CFD）系统用超声束探测该血管，声束与血管轴线形成一个角度 $\\theta = 55^\\circ$。每个像素上测得的彩色速度是在以 $t_{0}$ 为中心的持续时间为 $\\Delta t = 12\\,\\mathrm{ms}$ 的矩形时间窗内，血液速度沿声束方向分量的系综时间平均值。假设没有混叠、没有壁滤波剪切，并且空间平均使用归一化核（因此其积分权重为一）。介质被假定为不可压缩，声速为 $c = 1540\\,\\mathrm{m/s}$；超声中心频率为 $f_{0} = 5.0\\,\\mathrm{MHz}$。\n\n从适用于医学超声和流体流动的基本原理出发，完成以下任务：\n1. 使用不可压缩流的质量守恒和轴向速度的定义，推导通过横截面的体积流量表达式，该表达式应以轴向速度场的横截面积分表示。\n2. 以多普勒频移关系式 $f_{D} = \\frac{2 f_{0} v \\cos\\theta}{c}$ 作为血流与测量的彩色速度之间的基本联系，解释CFD时间平均窗和声束角如何影响速度图，并因此影响体积流量的计算。\n3. 计算由物理速度场在 $t_{0}$ 时刻所隐含的瞬时体积流量。然后，通过对横截面上的角度校正、时间平均的彩色速度进行积分，计算由CFD得出的、经过角度校正的体积流量。简要评论角度依赖和平均引入的偏差。\n4. 将 $t_{0}$ 时刻的瞬时体积流量作为您的最终答案。将您的答案四舍五入到四位有效数字，并以 $\\mathrm{mL/s}$ 为单位表示。角度以度为单位给出。\n\n您最终报告的值必须是一个数字。不要在最终的方框答案中包含单位。", "solution": "按照问题陈述的要求，解答分为四个部分呈现。\n\n**1. 体积流量的推导**\n\n体积流量 $Q$ 定义为单位时间内通过给定横截面积 $A$ 的流体体积。从基本原理出发，对于速度场为 $\\mathbf{v}$ 的不可压缩流体，这等于速度场通过表面 $A$ 的通量：\n$$Q = \\iint_A \\mathbf{v} \\cdot d\\mathbf{A}$$\n在本问题中，血流在半径为 $R$ 的圆柱形血管内是轴向的。我们可以建立一个圆柱坐标系 $(r, \\phi, z)$，其中 $z$ 轴与血管轴线对齐。速度场被给定为纯轴向的，因此 $\\mathbf{v} = v(r,t) \\mathbf{\\hat{z}}$。横截面积是 $r-\\phi$ 平面上的一个圆盘，其面积微元为 $d\\mathbf{A} = r \\, dr \\, d\\phi \\, \\mathbf{\\hat{z}}$。因此，点积简化为 $\\mathbf{v} \\cdot d\\mathbf{A} = v(r,t) r \\, dr \\, d\\phi$。\n\n体积流量 $Q(t)$ 通过对整个横截面进行积分得到：\n$$Q(t) = \\int_0^{2\\pi} \\int_0^R v(r,t) \\, r \\, dr \\, d\\phi$$\n由于速度场 $v(r,t)$ 是轴对称的（即，它不依赖于方位角 $\\phi$），对 $\\phi$ 的积分产生一个因子 $2\\pi$：\n$$Q(t) = 2\\pi \\int_0^R v(r,t) \\, r \\, dr$$\n这个从流体通量的基本定义推导出的表达式，代表了以轴向速度场的横截面积分表示的体积流量。\n\n**2. CFD时间平均和声束角的影响**\n\n彩色多普勒血流（CFD）系统基于多普勒效应工作。测得的多普勒频移 $f_D$ 与散射体（红细胞）的速度以及探测的几何形状有关。其基本关系式为：\n$$f_D = \\frac{2 f_0 v_{\\text{beam}}}{c}$$\n其中 $f_0$ 是发射的超声频率，$c$ 是声速，$v_{\\text{beam}}$ 是血液速度矢量沿超声声束方向的分量。对于轴向速度 $v(r,t)$ 和相对于血管轴线的声束角 $\\theta$，该分量为 $v_{\\text{beam}} = v(r,t) \\cos\\theta$。\n\nCFD系统通过在有限的时间窗内处理一系列超声脉冲来估计速度。在特定空间位置报告的彩色速度代表了该时间间隔内的平均值。设平均窗的持续时间为 $\\Delta t$，以时间 $t_0$ 为中心。系统测量平均多普勒频移 $\\bar{f}_D(r,t_0)$ 并用它来计算沿声束的估计速度 $\\bar{v}_{\\text{est}}(r, t_0)$。\n$$\\bar{v}_{\\text{est}}(r,t_0) = \\frac{\\bar{f}_D(r,t_0) c}{2 f_0} = \\frac{c}{2 f_0} \\left( \\frac{1}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} \\frac{2 f_0 v(r,t) \\cos\\theta}{c} \\, dt \\right) = \\frac{\\cos\\theta}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} v(r,t) \\, dt$$\n为了提供有意义的血流速度表示，系统会应用“角度校正”，将此估计的声束方向速度除以 $\\cos\\theta$。得到的经过角度校正的CFD速度 $\\bar{v}_{\\text{CFD}}(r, t_0)$ 就是屏幕上显示的速度。\n$$\\bar{v}_{\\text{CFD}}(r, t_0) = \\frac{\\bar{v}_{\\text{est}}(r, t_0)}{\\cos\\theta} = \\frac{1}{\\cos\\theta} \\left( \\frac{\\cos\\theta}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} v(r,t) \\, dt \\right) = \\frac{1}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} v(r,t) \\, dt$$\n这表明，理想的、经过角度校正的CFD速度图代表了真实轴向速度场在时间窗 $\\Delta t$ 内的时间平均值。声束角 $\\theta$ 被明确地分离出来，前提是它已知并且被正确应用。\n\n因此，从CFD数据推导出的体积流量计算 $Q_{\\text{CFD}}(t_0)$ 将是这个时间平均速度图在横截面上的积分：\n$$Q_{\\text{CFD}}(t_0) = \\iint_A \\bar{v}_{\\text{CFD}}(r, t_0) \\, dA = \\iint_A \\left(\\frac{1}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} v(r,t) \\, dt\\right) dA$$\n通过改变积分顺序（富比尼定理 Fubini's theorem），这变为：\n$$Q_{\\text{CFD}}(t_0) = \\frac{1}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} \\left( \\iint_A v(r,t) \\, dA \\right) dt = \\frac{1}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} Q(t) \\, dt$$\n因此，CFD推导出的体积流量是真实瞬时体积流量的时间平均值。这种时间平均作用于血流波形，相当于一个低通滤波器。\n\n**3. 流量计算与偏差分析**\n\n首先，我们计算瞬时体积流量 $Q(t_0)$。我们将给定的泊肃叶速度剖面代入 $Q(t)$ 的表达式中：\n$$Q(t) = 2\\pi \\int_0^R V_{\\max}(t)\\left(1 - \\frac{r^2}{R^2}\\right) r \\, dr = 2\\pi V_{\\max}(t) \\left[ \\frac{r^2}{2} - \\frac{r^4}{4R^2} \\right]_0^R$$\n$$Q(t) = 2\\pi V_{\\max}(t) \\left( \\frac{R^2}{2} - \\frac{R^4}{4R^2} \\right) = 2\\pi V_{\\max}(t) \\left( \\frac{R^2}{4} \\right) = \\frac{\\pi R^2}{2} V_{\\max}(t)$$\n我们需要在 $t_0 = \\frac{1}{4f}$ 时的值。此时的峰值速度是：\n$$V_{\\max}(t_0) = V_0 + V_1\\sin(2\\pi f t_0) = V_0 + V_1\\sin\\left(2\\pi f \\cdot \\frac{1}{4f}\\right) = V_0 + V_1\\sin\\left(\\frac{\\pi}{2}\\right) = V_0 + V_1$$\n使用给定值 $V_0 = 0.40\\,\\mathrm{m/s}$ 和 $V_1 = 0.20\\,\\mathrm{m/s}$：\n$$V_{\\max}(t_0) = 0.40\\,\\mathrm{m/s} + 0.20\\,\\mathrm{m/s} = 0.60\\,\\mathrm{m/s}$$\n半径为 $R = 3.0\\,\\mathrm{mm} = 3.0 \\times 10^{-3}\\,\\mathrm{m}$。瞬时流量为：\n$$Q(t_0) = \\frac{\\pi (3.0 \\times 10^{-3}\\,\\mathrm{m})^2}{2} (0.60\\,\\mathrm{m/s}) = \\frac{\\pi (9.0 \\times 10^{-6}\\,\\mathrm{m}^2)}{2} (0.60\\,\\mathrm{m/s}) = 2.7\\pi \\times 10^{-6}\\,\\mathrm{m}^3/\\mathrm{s}$$\n为了转换为 $\\mathrm{mL/s}$，我们使用 $1\\,\\mathrm{m}^3 = 10^6\\,\\mathrm{mL}$：\n$$Q(t_0) = 2.7\\pi\\,\\mathrm{mL/s} \\approx 8.4823\\,\\mathrm{mL/s}$$\n\n接下来，我们计算由CFD推导的体积流量 $Q_{\\text{CFD}}(t_0)$。使用表达式 $Q(t) = \\frac{\\pi R^2}{2} (V_0 + V_1\\sin(2\\pi f t))$：\n$$Q_{\\text{CFD}}(t_0) = \\frac{1}{\\Delta t} \\int_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2} \\frac{\\pi R^2}{2} (V_0 + V_1\\sin(2\\pi f t)) \\, dt$$\n$$Q_{\\text{CFD}}(t_0) = \\frac{\\pi R^2}{2\\Delta t} \\left[ V_0 t - \\frac{V_1}{2\\pi f} \\cos(2\\pi f t) \\right]_{t_0 - \\Delta t/2}^{t_0 + \\Delta t/2}$$\n第一项得出 $\\frac{\\pi R^2}{2} V_0$。第二项得出：\n$$\\frac{\\pi R^2 V_1}{2\\Delta t} \\left(-\\frac{1}{2\\pi f}\\right) [\\cos(2\\pi f(t_0+\\Delta t/2)) - \\cos(2\\pi f(t_0-\\Delta t/2))]$$\n使用 $t_0=\\frac{1}{4f}$，余弦函数的参数是 $\\frac{\\pi}{2} + \\pi f \\Delta t$ 和 $\\frac{\\pi}{2} - \\pi f \\Delta t$。使用 $\\cos(\\frac{\\pi}{2}+x)=-\\sin(x)$ 和 $\\cos(\\frac{\\pi}{2}-x)=\\sin(x)$：\n$$-\\left[-\\sin(\\pi f \\Delta t) - \\sin(\\pi f \\Delta t)\\right] = 2\\sin(\\pi f \\Delta t)$$\n流量的第二部分是 $\\frac{\\pi R^2 V_1}{2\\Delta t (2\\pi f)} [2\\sin(\\pi f \\Delta t)] = \\frac{\\pi R^2 V_1}{2} \\cdot \\frac{\\sin(\\pi f \\Delta t)}{\\pi f \\Delta t}$。\n因此，\n$$Q_{\\text{CFD}}(t_0) = \\frac{\\pi R^2}{2} \\left[ V_0 + V_1 \\frac{\\sin(\\pi f \\Delta t)}{\\pi f \\Delta t} \\right]$$\n给定 $f = 4.0\\,\\mathrm{Hz}$ 和 $\\Delta t = 12\\,\\mathrm{ms} = 0.012\\,\\mathrm{s}$，参数为 $\\pi f \\Delta t = \\pi(4.0)(0.012) = 0.048\\pi$。\n$$\\frac{\\sin(0.048\\pi)}{0.048\\pi} \\approx \\frac{0.15016}{0.15080} \\approx 0.99576$$\n$$Q_{\\text{CFD}}(t_0) = \\frac{\\pi (3.0 \\times 10^{-3})^2}{2} \\left[ 0.40 + 0.20 \\cdot (0.99576) \\right] \\,\\mathrm{m}^3/\\mathrm{s}$$\n$$Q_{\\text{CFD}}(t_0) = 4.5\\pi \\times 10^{-6} [0.40 + 0.19915] = 4.5\\pi \\times 10^{-6} [0.59915] \\,\\mathrm{m}^3/\\mathrm{s} \\approx 8.4699\\,\\mathrm{mL/s}$$\n\n关于偏差的简要评论：\n瞬时峰值流量为 $Q(t_0) \\approx 8.482\\,\\mathrm{mL/s}$，而CFD推导的流量为 $Q_{\\text{CFD}}(t_0) \\approx 8.470\\,\\mathrm{mL/s}$。时间平均引入的偏差是对峰值流量的低估。这是因为平均窗 $\\Delta t$ 平滑了血流的搏动分量。由于 $t_0$ 是峰值流量的时刻，围绕该点的任何平均都必然包含低于峰值的值，导致平均值小于真实的瞬时峰值。这可以通过因子 $\\frac{\\sin(\\pi f \\Delta t)}{\\pi f \\Delta t}$ 小于1来量化。关于角度依赖性，尽管理想的角度校正可以消除偏差，但操作者在估计 $\\theta$ 时的任何误差都会引入显著的系统误差，因为校正因子 $1/\\cos\\theta$ 对 $\\theta$ 的变化非常敏感，尤其是在角度较大时。\n\n**4. 最终答案**\n\n问题要求给出在 $t_0$ 时刻的瞬时体积流量，四舍五入到四位有效数字，并以 $\\mathrm{mL/s}$ 为单位表示。根据第3部分的计算：\n$$Q(t_0) = 2.7\\pi\\,\\mathrm{mL/s} \\approx 8.482300... \\,\\mathrm{mL/s}$$\n四舍五入到四位有效数字得到 $8.482\\,\\mathrm{mL/s}$。", "answer": "$$\\boxed{8.482}$$", "id": "4868840"}]}