{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本节的练习旨在将K空间的核心概念应用于实际问题中。第一个练习将从磁共振成像（MRI）采集的基础参数入手。通过计算读出时间、采样点数和带宽之间的关系，你将深入理解时间域信号采样与K空间数据构建之间的基本联系，这是后续理解更复杂成像技术的基础。[@problem_id:4896641]", "problem": "在沿频率编码方向 $k_x$ 的笛卡尔磁共振成像 (MRI) 读出过程中，读出梯度保持恒定，信号在时间上被均匀采样。均匀采样在时间点 $t_n = n\\,T_{\\mathrm{dw}}$（对于跨越采集窗口的整数 $n$）上产生 $k$ 空间线的 $N_x$ 个复数数据点，其中 $T_{\\mathrm{dw}}$ 是驻留时间，采集的光谱带宽 $BW$ 由采样频率设定。模数转换器 (ADC) 门定义了总读出时间 $T_{\\mathrm{ro}}$。\n\n仅使用 MRI $k$ 空间采集中信号采样的基本定义，推导总读出时间 $T_{\\mathrm{ro}}$ 关于 $N_x$、$T_{\\mathrm{dw}}$ 和 $BW$ 的表达式。然后，当 $N_x = 1536$ 个样本且 $BW = 192 \\times 10^{3}$ $\\mathrm{Hz}$ 时，计算 $T_{\\mathrm{ro}}$ 的值。将您的最终数值答案以毫秒为单位表示，并四舍五入到四位有效数字。", "solution": "该问题要求在笛卡尔 MRI 采集中推导总读出时间 $T_{\\mathrm{ro}}$ 的表达式，并随后进行数值计算。推导将基于信号采样的基本定义。\n\n首先，我们建立所提供参数之间的关系。驻留时间 $T_{\\mathrm{dw}}$ 是在时域中采集连续样本之间的时间间隔。因此，采样频率 $f_s$ 是驻留时间的倒数：\n$$f_s = \\frac{1}{T_{\\mathrm{dw}}}$$\n问题指出，采集的光谱带宽 $BW$ 由采样频率设定。在 MRI 的数字信号处理中，为了根据奈奎斯特-香农采样定理避免在频率编码方向上发生混叠，采样频率被设定为等于光谱带宽。光谱带宽定义了要数字化的全部频率范围。因此，我们有：\n$$f_s = BW$$\n通过结合这两个基本方程，我们建立了驻留时间与光谱带宽之间的直接关系：\n$$BW = \\frac{1}{T_{\\mathrm{dw}}}$$\n这意味着 $T_{\\mathrm{dw}}$ 和 $BW$ 不是独立的变量，而是互为倒数。\n\n接下来，我们定义总读出时间 $T_{\\mathrm{ro}}$。这是信号采集窗口的总持续时间，也称为 ADC 门时间。在此期间，总共采集了 $N_x$ 个样本。由于采样是均匀的，间隔为 $T_{\\mathrm{dw}}$，因此总读出时间是样本数量与每个样本持续时间的乘积：\n$$T_{\\mathrm{ro}} = N_x T_{\\mathrm{dw}}$$\n问题要求一个关于 $N_x$、$T_{\\mathrm{dw}}$ 和 $BW$ 的 $T_{\\mathrm{ro}}$ 表达式。上面推导的一系列关系完全描述了这些参数之间的联系。具体来说，我们有两个关于 $T_{\\mathrm{ro}}$ 的主要表达式：\n1.  关于 $N_x$ 和 $T_{\\mathrm{dw}}$ 的表达式：$T_{\\mathrm{ro}} = N_x T_{\\mathrm{dw}}$\n2.  关于 $N_x$ 和 $BW$ 的表达式：将 $T_{\\mathrm{dw}} = 1/BW$ 代入第一个表达式，我们得到：\n    $$T_{\\mathrm{ro}} = N_x \\left(\\frac{1}{BW}\\right) = \\frac{N_x}{BW}$$\n这两个表达式共同代表了 $T_{\\mathrm{ro}}$、$N_x$、$T_{\\mathrm{dw}}$ 和 $BW$ 之间推导出的关系。对于问题的数值计算部分，第二个表达式是可操作的，因为给出了 $N_x$ 和 $BW$ 的值。\n\n我们被要求对以下值计算 $T_{\\mathrm{ro}}$：\n- 样本数，$N_x = 1536$\n- 光谱带宽，$BW = 192 \\times 10^{3} \\, \\mathrm{Hz}$\n\n带宽的单位赫兹（$\\mathrm{Hz}$）等同于秒的倒数（$\\mathrm{s}^{-1}$）。将给定值代入推导出的公式中：\n$$T_{\\mathrm{ro}} = \\frac{1536}{192 \\times 10^{3} \\, \\mathrm{s}^{-1}}$$\n我们首先计算数值的比率：\n$$\\frac{1536}{192} = 8$$\n因此，总读出时间（以秒为单位）是：\n$$T_{\\mathrm{ro}} = 8 \\times 10^{-3} \\, \\mathrm{s}$$\n问题要求最终答案以毫秒（$\\mathrm{ms}$）表示。我们使用转换因子 $1 \\, \\mathrm{s} = 1000 \\, \\mathrm{ms}$：\n$$T_{\\mathrm{ro}} = (8 \\times 10^{-3} \\, \\mathrm{s}) \\times \\left(\\frac{1000 \\, \\mathrm{ms}}{1 \\, \\mathrm{s}}\\right) = 8 \\, \\mathrm{ms}$$\n最后，我们必须将答案四舍五入到四位有效数字。确切值 $8$ 必须写上尾随的零以表示此精度。\n$$T_{\\mathrm{ro}} = 8.000 \\, \\mathrm{ms}$$", "answer": "$$\\boxed{8.000}$$", "id": "4896641"}, {"introduction": "在理想情况下，磁共振的空间编码是完美的，但现实世界中的磁场并非完全均匀。第二个练习将引导你探讨静态主磁场（$B_0$）的不均匀性如何导致图像产生几何畸变。通过从傅里叶变换的相移定理出发，推导像素位移的表达式，你将亲身体验物理原理如何直接转化为可见的图像伪影，从而加深对K空间与图像域之间傅里叶关系的理解。[@problem_id:4896651]", "problem": "考虑磁共振成像 (MRI) 中沿频率编码轴的一维读出，该轴的空间坐标表示为 $x \\in [-FOV_x/2,\\, FOV_x/2]$，其中 $FOV_x$ 是沿读出方向的视场 (FOV)。在采集过程中施加一个恒定的读出梯度 $G_x$，使得随时间变化的k空间坐标为 $k_x(t)$。数据以恒定速率 $BW$（接收机带宽）进行采样，产生 $N_x$ 个用于沿 $x$ 轴重建图像的均匀间隔的时间样本。\n\n假设横向磁化强度具有自旋密度 $\\rho(x)$，并且在读出期间弛豫和化学位移可以忽略不计。接收到的信号可以建模为来自所有位置 $x$ 的贡献的叠加，每个位置的信号都会累积相位，该相位由读出梯度（用于编码位置）和由背景静态磁场不均匀性 $\\Delta B_0(x)$ 产生的静态离共振角频率 $\\Delta \\omega(x)$ 引起。角频率和磁场之间的拉莫尔关系成立：$\\omega(x) = \\gamma B(x)$，其中 $\\gamma$ 是旋磁比。因此，由不均匀性引起的离共振角频率为 $\\Delta \\omega(x) = \\gamma \\Delta B_0(x)$。\n\n仅使用以下基本事实：(i) 读出通过时域信号和沿 $x$ 轴的图像域之间的傅里叶关系来编码位置；(ii) 根据傅里叶位移定理，时域中乘以一个复指数对应于重建图像域中的位移；以及 (iii) 采样带宽 $BW$ 和采样点数 $N_x$ 决定了每个像素的频率分辨率。请从第一性原理出发，推导沿频率编码轴的像素位移 $\\Delta n(x)$ 的解析表达式，该表达式是 $\\Delta \\omega(x)$、$BW$ 和 $N_x$ 的函数。\n\n然后，对于一个由下式给出的特定的、空间变化的背景不均匀性\n$$\n\\Delta B_0(x) = b\\, x^{2},\n$$\n其中 $b$ 是一个常数，单位为特斯拉/平方米，$x$ 的单位为米，请用 $b$、$\\gamma$、$BW$、$N_x$ 和 $x$ 表示空间变化的像素位移 $\\Delta n(x)$ 的闭式表达式。\n\n将您的最终答案以符号形式表示为 $\\Delta n(x)$ 的单一闭式表达式，单位为像素。不需要进行数值计算，也不需要四舍五入。在最终方框内的答案中不要包含物理单位。", "solution": "磁共振成像 (MRI) 中的频率编码读出在记录的时域信号和沿读出方向重建的空间图像之间建立了一种傅里叶关系。设沿空间轴 $x$ 的自旋密度为 $\\rho(x)$。在恒定读出梯度 $G_x$ 的作用下，随时间变化的k空间坐标与时间的关系为\n$$\nk_x(t) = \\frac{\\gamma G_x}{2\\pi}\\, t,\n$$\n因此梯度进行的空间编码在信号模型中产生项 $\\exp\\!\\big(i\\, 2\\pi\\, k_x(t)\\, x\\big)$。此外，静态磁场不均匀性 $\\Delta B_0(x)$ 产生一个离共振角频率\n$$\n\\Delta \\omega(x) = \\gamma\\, \\Delta B_0(x),\n$$\n它为来自位置 $x$ 的信号贡献了一个乘法因子 $\\exp\\!\\big(i\\, \\Delta \\omega(x)\\, t\\big)$。忽略弛豫，接收到的信号因此是\n$$\ns(t) = \\int_{-FOV_x/2}^{FOV_x/2} \\rho(x)\\, \\exp\\!\\big(i\\, 2\\pi\\, k_x(t)\\, x\\big)\\, \\exp\\!\\big(i\\, \\Delta \\omega(x)\\, t\\big)\\, dx.\n$$\n\n沿读出方向的重建是通过对以速率 $BW$ 采集的时间样本进行傅里叶逆变换来完成的。设第 $n$ 个时间样本为 $t_n = n\\, \\Delta t$，其中 $\\Delta t = \\frac{1}{BW}$，$n = 0,1,\\dots,N_x-1$。离散傅里叶逆变换将采样后的时域数据映射到沿 $x$ 轴的 $N_x$ 个空间像素。我们使用的关键傅里叶性质是傅里叶位移定理：在时域中乘以一个复指数 $\\exp\\!\\big(i\\, 2\\pi\\, \\Delta f\\, t\\big)$ 对应于图像域中相对于采样轴的一个位移，位移量与 $\\Delta f$ 成正比。这里，$\\Delta f$ 是普通频率（单位为赫兹），通过以下关系与角频率相关联\n$$\n\\Delta f(x) = \\frac{\\Delta \\omega(x)}{2\\pi}.\n$$\n\n为了量化像素位移，我们注意到在 $N_x$ 个点上的离散采样带宽 $BW$ 设定了每个像素的频率增量，\n$$\n\\Delta f_{\\text{per-pixel}} = \\frac{BW}{N_x}.\n$$\n因此，由普通频率为 $\\Delta f(x)$ 的时域调制产生的像素位移是该调制频率与每个像素的频率增量之比：\n$$\n\\Delta n(x) = \\frac{\\Delta f(x)}{\\Delta f_{\\text{per-pixel}}} = \\frac{\\Delta f(x)}{BW/N_x} = \\frac{N_x\\, \\Delta f(x)}{BW}.\n$$\n将 $\\Delta f(x)$ 替换为 $\\Delta \\omega(x)/(2\\pi)$ 可得\n$$\n\\Delta n(x) = \\frac{N_x}{BW}\\, \\frac{\\Delta \\omega(x)}{2\\pi}.\n$$\n\n这个表达式是通用的：它直接显示了离共振如何沿频率编码方向产生空间变化的像素位移，更大的 $\\Delta \\omega(x)$ 会导致成比例的更大位移。$\\Delta \\omega(x)$ 的空间变化（通过拉莫尔关系从 $\\Delta B_0(x)$ 继承而来）导致了整个图像的非均匀畸变。\n\n对于给定的不均匀性\n$$\n\\Delta B_0(x) = b\\, x^{2},\n$$\n离共振角频率为\n$$\n\\Delta \\omega(x) = \\gamma\\, \\Delta B_0(x) = \\gamma\\, b\\, x^{2}.\n$$\n代入通用的像素位移表达式，\n$$\n\\Delta n(x) = \\frac{N_x}{BW}\\, \\frac{\\gamma\\, b\\, x^{2}}{2\\pi} = \\frac{N_x\\, \\gamma\\, b}{2\\pi\\, BW}\\, x^{2}.\n$$\n\n这就是所要求的空间变化像素位移的闭式表达式，它表明畸变随 $|x|$ 的二次方增加，在等中心 $x=0$ 处为零，并且与读出点数 $N_x$ 成正比，与带宽 $BW$ 成反比。", "answer": "$$\\boxed{\\Delta n(x)=\\frac{N_x\\,\\gamma\\,b}{2\\pi\\,BW}\\,x^{2}}$$", "id": "4896651"}]}