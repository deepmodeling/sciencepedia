{"hands_on_practices": [{"introduction": "在深入研究复杂的图像重建过程之前，了解投影数据中直接包含哪些信息是非常有价值的。本练习将引导您探索投影矩定理，这是一个将物体的统计矩（如质心和协方差）与其Radon变换投影的矩优雅地联系在一起的定理。通过推导并应用该定理[@problem_id:4913422]，您将学会如何直接从投影数据中提取物体的全局属性，而无需进行完整的图像重建。", "problem": "一个空间分布为 $f(x,y)$ 的二维物体代表了与计算机断层扫描（CT）相关的归一化横截面属性。该物体是紧支撑且可积的，所有坐标均使用归一化单位（无物理单位）。考虑其由拉东变换表征的投影。设角度为 $\\theta$（以弧度为单位）的投影由拉东变换定义为\n$$\np(\\theta,s) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,\\delta\\!\\big(s - x\\cos(\\theta) - y\\sin(\\theta)\\big)\\,dx\\,dy,\n$$\n其中 $\\delta(\\cdot)$ 是狄拉克δ分布，$s$ 是沿投影线法线到原点的有符号距离。\n\n定义第 $n$ 阶投影矩为\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n}\\,p(\\theta,s)\\,ds.\n$$\n\n仅从这些定义以及物体质心和二阶矩的定义出发，\n$$\nM = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,dx\\,dy,\\quad\n\\boldsymbol{\\mu} = \\frac{1}{M}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\begin{pmatrix} x \\\\ y \\end{pmatrix} f(x,y)\\,dx\\,dy,\n$$\n$$\n\\mathbf{R} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\begin{pmatrix} x \\\\ y \\end{pmatrix}\\begin{pmatrix} x  y \\end{pmatrix} f(x,y)\\,dx\\,dy,\\quad\n\\mathbf{C} = \\frac{1}{M}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(\\begin{pmatrix} x \\\\ y \\end{pmatrix} - \\boldsymbol{\\mu}\\big)\\big(\\begin{pmatrix} x  y \\end{pmatrix} - \\boldsymbol{\\mu}^{\\top}\\big) f(x,y)\\,dx\\,dy,\n$$\n通过交换积分顺序并计算狄拉克δ积分，推导出前两个矩条件 $m_1(\\theta)$ 和 $m_2(\\theta)$。明确地将 $m_1(\\theta)$ 与质心 $\\boldsymbol{\\mu}$ 相关联，并将 $m_2(\\theta)$ 与原始二阶矩矩阵 $\\mathbf{R}$（或等效地，与协方差矩阵 $\\mathbf{C}$ 和质心 $\\boldsymbol{\\mu}$）相关联。\n\n然后，将您推导出的关系应用于总质量 $M = 1$、质心为\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix},\n$$\n且协方差矩阵为\n$$\n\\mathbf{C} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}.\n$$\n的特定归一化物体。将第一和第二投影矩 $m_1(\\theta)$ 和 $m_2(\\theta)$ 表示为关于 $\\theta$（以弧度为单位）的显式函数。无需四舍五入。将您的最终答案以单行矩阵的形式给出，按顺序包含 $m_1(\\theta)$ 和 $m_2(\\theta)$。", "solution": "问题陈述已经过验证，被认为是科学合理的、适定的、客观的和自洽的。所提供的拉东变换、投影矩和物体分布的统计矩的定义在计算机断层扫描和数学图像分析领域是标准的。特定物体的数值在物理上和数学上是一致的，因为给定的协方差矩阵是对称正定的。因此，该问题是有效的，可以推导出完整的解。\n\n主要任务是推导第一和第二投影矩 $m_1(\\theta)$ 和 $m_2(\\theta)$ 的表达式，然后将它们应用于一个具体案例。\n\n我们从第 $n$ 阶投影矩 $m_n(\\theta)$ 的定义开始：\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n}\\,p(\\theta,s)\\,ds\n$$\n我们代入拉东变换 $p(\\theta,s)$ 的定义：\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty} s^{n} \\left( \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y)\\,\\delta\\big(s - x\\cos(\\theta) - y\\sin(\\theta)\\big)\\,dx\\,dy \\right) ds\n$$\n按照建议，我们交换积分顺序。这是允许的，因为函数 $f(x,y)$ 是紧支撑且可积的。\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(x,y) \\left( \\int_{-\\infty}^{\\infty} s^{n}\\,\\delta\\big(s - (x\\cos(\\theta) + y\\sin(\\theta))\\big)\\,ds \\right) dx\\,dy\n$$\n关于 $s$ 的内层积分可以使用狄拉克δ分布的筛选性质 $\\int_{-\\infty}^{\\infty} g(t)\\delta(t-a)dt = g(a)$ 来计算。在本例中，积分变量是 $s$，函数是 $g(s) = s^n$，位移是 $a = x\\cos(\\theta) + y\\sin(\\theta)$。积分计算结果为：\n$$\n\\int_{-\\infty}^{\\infty} s^{n}\\,\\delta\\big(s - (x\\cos(\\theta) + y\\sin(\\theta))\\big)\\,ds = \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^n\n$$\n将此结果代回，得到第 $n$ 阶投影矩的一般表达式，这通常被称为矩的投影切片定理：\n$$\nm_n(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^n f(x,y) \\,dx\\,dy\n$$\n\n现在，我们推导 $m_1(\\theta)$ 和 $m_2(\\theta)$ 的表达式。\n\n对于一阶矩 ($n=1$)：\n$$\nm_1(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big) f(x,y) \\,dx\\,dy\n$$\n根据积分的线性性质，我们可以分离各项：\n$$\nm_1(\\theta) = \\cos(\\theta)\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} x f(x,y) \\,dx\\,dy + \\sin(\\theta)\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} y f(x,y) \\,dx\\,dy\n$$\n从质心 $\\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_x \\\\ \\mu_y \\end{pmatrix}$ 的定义，我们有一阶原始矩向量的分量 $\\int\\int \\begin{pmatrix} x \\\\ y \\end{pmatrix} f(x,y) \\,dx\\,dy = M\\boldsymbol{\\mu}$。具体来说：\n$$\n\\int\\int x f(x,y) \\,dx\\,dy = M\\mu_x \\quad \\text{和} \\quad \\int\\int y f(x,y) \\,dx\\,dy = M\\mu_y\n$$\n将这些代入 $m_1(\\theta)$ 的表达式中，得到：\n$$\nm_1(\\theta) = M(\\mu_x \\cos(\\theta) + \\mu_y \\sin(\\theta))\n$$\n这可以用向量符号紧凑地表示。设 $\\mathbf{u}(\\theta) = \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix}$。那么：\n$$\nm_1(\\theta) = M \\boldsymbol{\\mu}^{\\top} \\mathbf{u}(\\theta)\n$$\n这就是所要求的 $m_1(\\theta)$ 和质心 $\\boldsymbol{\\mu}$ 之间的关系。\n\n对于二阶矩 ($n=2$)：\n$$\nm_2(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x\\cos(\\theta) + y\\sin(\\theta)\\big)^2 f(x,y) \\,dx\\,dy\n$$\n展开平方项：\n$$\nm_2(\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\big(x^2\\cos^2(\\theta) + 2xy\\cos(\\theta)\\sin(\\theta) + y^2\\sin^2(\\theta)\\big) f(x,y) \\,dx\\,dy\n$$\n根据线性性质分离各项：\n$$\nm_2(\\theta) = \\cos^2(\\theta)\\int\\int x^2 f(x,y) dxdy + 2\\cos(\\theta)\\sin(\\theta)\\int\\int xy f(x,y) dxdy + \\sin^2(\\theta)\\int\\int y^2 f(x,y) dxdy\n$$\n这些积分是原始二阶矩矩阵 $\\mathbf{R}$ 的分量：\n$$\n\\mathbf{R} = \\int\\int \\begin{pmatrix} x^2  xy \\\\ yx  y^2 \\end{pmatrix} f(x,y)\\,dx\\,dy = \\begin{pmatrix} R_{xx}  R_{xy} \\\\ R_{yx}  R_{yy} \\end{pmatrix}\n$$\n所以，我们可以将 $m_2(\\theta)$ 写为：\n$$\nm_2(\\theta) = R_{xx}\\cos^2(\\theta) + 2R_{xy}\\cos(\\theta)\\sin(\\theta) + R_{yy}\\sin^2(\\theta)\n$$\n这个二次型可以使用向量 $\\mathbf{u}(\\theta)$ 紧凑地表示：\n$$\nm_2(\\theta) = \\mathbf{u}(\\theta)^{\\top} \\mathbf{R} \\mathbf{u}(\\theta)\n$$\n这就是所要求的 $m_2(\\theta)$ 和矩阵 $\\mathbf{R}$ 之间的关系。\n\n为了将 $m_2(\\theta)$ 与协方差矩阵 $\\mathbf{C}$ 和质心 $\\boldsymbol{\\mu}$ 联系起来，我们使用连接 $\\mathbf{R}$、$\\mathbf{C}$ 和 $\\boldsymbol{\\mu}$ 的平行轴定理。从 $\\mathbf{C}$ 的定义开始：\n$$\n\\mathbf{C} = \\frac{1}{M}\\int\\int \\big(\\begin{pmatrix} x \\\\ y \\end{pmatrix} - \\boldsymbol{\\mu}\\big)\\big(\\begin{pmatrix} x  y \\end{pmatrix} - \\boldsymbol{\\mu}^{\\top}\\big) f(x,y)\\,dx\\,dy\n$$\n展开积分内的乘积得到 $\\mathbf{R} = M\\mathbf{C} + M\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}$。将其代入我们 $m_2(\\theta)$ 的表达式中：\n$$\nm_2(\\theta) = \\mathbf{u}^{\\top} (M\\mathbf{C} + M\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}) \\mathbf{u} = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + M(\\mathbf{u}^{\\top}\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}\\mathbf{u})\n$$\n由于 $\\mathbf{u}^{\\top}\\boldsymbol{\\mu}$ 是一个标量，我们有 $\\mathbf{u}^{\\top}\\boldsymbol{\\mu}\\boldsymbol{\\mu}^{\\top}\\mathbf{u} = (\\mathbf{u}^{\\top}\\boldsymbol{\\mu})(\\boldsymbol{\\mu}^{\\top}\\mathbf{u}) = (\\boldsymbol{\\mu}^{\\top}\\mathbf{u})^2$。\n从 $m_1(\\theta)$ 的推导中，我们知道 $\\boldsymbol{\\mu}^{\\top}\\mathbf{u} = m_1(\\theta)/M$。因此：\n$$\nm_2(\\theta) = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + M\\left(\\frac{m_1(\\theta)}{M}\\right)^2 = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + \\frac{m_1(\\theta)^2}{M}\n$$\n这就是所期望的 $m_2(\\theta)$ 关于 $\\mathbf{C}$ 和 $\\boldsymbol{\\mu}$（通过 $m_1(\\theta)$）的关系。\n\n现在我们将这些推导出的关系应用于具有 $M=1$、$\\boldsymbol{\\mu} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$ 和 $\\mathbf{C} = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}$ 的特定物体。\n\n计算 $m_1(\\theta)$:\n$$\nm_1(\\theta) = M \\boldsymbol{\\mu}^{\\top} \\mathbf{u}(\\theta) = 1 \\times \\begin{pmatrix} 2  -1 \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix} = 2\\cos(\\theta) - \\sin(\\theta)\n$$\n\n计算 $m_2(\\theta)$:\n我们使用表达式 $m_2(\\theta) = M(\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}) + \\frac{m_1(\\theta)^2}{M}$。当 $M=1$ 时，这简化为 $m_2(\\theta) = \\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u} + m_1(\\theta)^2$。\n首先，我们计算二次型 $\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u}$:\n$$\n\\mathbf{u}^{\\top}\\mathbf{C}\\mathbf{u} = \\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta) \\end{pmatrix} \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{pmatrix}\n$$\n$$\n= 3\\cos^2(\\theta) + 2\\cos(\\theta)\\sin(\\theta) + 2\\sin^2(\\theta)\n$$\n接下来，我们计算 $m_1(\\theta)^2$:\n$$\nm_1(\\theta)^2 = (2\\cos(\\theta) - \\sin(\\theta))^2 = 4\\cos^2(\\theta) - 4\\cos(\\theta)\\sin(\\theta) + \\sin^2(\\theta)\n$$\n将这两部分相加：\n$$\nm_2(\\theta) = (3\\cos^2(\\theta) + 2\\cos(\\theta)\\sin(\\theta) + 2\\sin^2(\\theta)) + (4\\cos^2(\\theta) - 4\\cos(\\theta)\\sin(\\theta) + \\sin^2(\\theta))\n$$\n$$\nm_2(\\theta) = 7\\cos^2(\\theta) - 2\\cos(\\theta)\\sin(\\theta) + 3\\sin^2(\\theta)\n$$\n为了获得更紧凑的表达式，我们使用倍角公式：$\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$，$\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$，以及 $2\\cos(\\theta)\\sin(\\theta) = \\sin(2\\theta)$。\n$$\nm_2(\\theta) = 7\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) - \\sin(2\\theta) + 3\\left(\\frac{1-\\cos(2\\theta)}{2}\\right)\n$$\n$$\nm_2(\\theta) = \\frac{7}{2} + \\frac{7}{2}\\cos(2\\theta) - \\sin(2\\theta) + \\frac{3}{2} - \\frac{3}{2}\\cos(2\\theta)\n$$\n$$\nm_2(\\theta) = \\frac{10}{2} + \\left(\\frac{7-3}{2}\\right)\\cos(2\\theta) - \\sin(2\\theta) = 5 + 2\\cos(2\\theta) - \\sin(2\\theta)\n$$\n因此，第一和第二投影矩的表达式为：\n$m_1(\\theta) = 2\\cos(\\theta) - \\sin(\\theta)$\n$m_2(\\theta) = 5 + 2\\cos(2\\theta) - \\sin(2\\theta)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\cos(\\theta) - \\sin(\\theta)  5 + 2\\cos(2\\theta) - \\sin(2\\theta)\n\\end{pmatrix}\n}\n$$", "id": "4913422"}, {"introduction": "Radon变换反演的理论解包含一个在实践中会带来问题的斜坡滤波器。这个理想的滤波器会不成比例地放大高频噪声，从而降低图像质量。本练习将带您进入滤波反投影（FBP）算法的实际应用层面，通过分析几种常用的窗函数（如Ram–Lak、Shepp–Logan和Hamming）[@problem_id:4913443]，您将定量地计算出不同窗函数对最终图像中噪声水平的影响，从而深刻理解CT重建中分辨率与噪声之间不可避免的权衡。", "problem": "一个二维平行束断层成像系统采集一个空间分布为 $f(x,y)$ 的物体的投影，该过程通过 Radon 变换 $R f(\\theta,s)$ 建模，其中 $\\theta$ 是投影角度，$s$ 是探测器位置。重建通过滤波反投影（FBP）算法完成，该算法使用一个频率响应为 $H(\\omega)$ 的频域滤波器对每个投影进行线性滤波，然后进行反投影。在理想的无噪声极限下，标准的 FBP 滤波器包含斜坡函数 $|\\omega|$，但在实际应用中，会将 $|\\omega|$ 乘以一个窗函数 $W(\\omega)$，以在分辨率和噪声之间进行权衡。\n\n考虑三个截止频率为 $\\omega_{c}$ 的窗函数：\n- Ram–Lak 窗: 当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{RL}}(\\omega) = 1$，其他情况下 $W_{\\mathrm{RL}}(\\omega) = 0$。\n- Shepp–Logan 窗: 当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{SL}}(\\omega) = \\dfrac{\\sin\\!\\big(\\dfrac{\\pi\\,\\omega}{2\\,\\omega_{c}}\\big)}{\\dfrac{\\pi\\,\\omega}{2\\,\\omega_{c}}}$，其他情况下 $W_{\\mathrm{SL}}(\\omega) = 0$。\n- Hamming 窗: 当 $|\\omega| \\le \\omega_{c}$ 时，$W_{\\mathrm{H}}(\\omega) = 0.54 + 0.46 \\cos\\!\\big(\\dfrac{\\pi\\,\\omega}{\\omega_{c}}\\big)$，其他情况下 $W_{\\mathrm{H}}(\\omega) = 0$。\n\n假设对于每个角度 $\\theta$，投影测量值包含加性、零均值、白噪声，该噪声沿着探测器位置 $s$ 是广义平稳的，其双边功率谱密度为常数 $S_{0}$，且在不同角度之间是独立的。从线性系统的角度（即在频域中使用 $H(\\omega) = |\\omega|\\,W(\\omega)$ 进行滤波，然后进行反投影）以及滤波后白噪声的方差定义出发，推导频率响应 $H_{\\mathrm{RL}}(\\omega)$、$H_{\\mathrm{SL}}(\\omega)$ 和 $H_{\\mathrm{H}}(\\omega)$，并求出这三种窗函数在重建像素处的相对图像域噪声方差放大因子的解析表达式。“相对”是指将所有三个因子相对于 Ram–Lak 情况进行归一化，使得 Ram–Lak 因子的值为 $1$。将最终答案按 Ram–Lak、Shepp–Logan、Hamming 的顺序列在一个单行矩阵中。无需四舍五入。这些比值是无量纲的。", "solution": "用户希望求出在滤波反投影（FBP）中使用的三种不同窗函数的相对噪声方差放大因子。\n\n### 第1步：问题验证\n该问题描述了计算机断层扫描（CT）图像重建中的一个标准场景。\n- **已知条件**：\n    - 物体分布: $f(x,y)$\n    - 投影模型: Radon 变换 $R f(\\theta,s)$\n    - 重建算法: 滤波反投影 (FBP)\n    - 频域 FBP 滤波器: $H(\\omega) = |\\omega|\\,W(\\omega)$，其中 $\\omega$ 是空间频率。\n    - 截止频率为 $\\omega_c$ 的窗函数 $W(\\omega)$:\n        1. Ram–Lak: 当 $|\\omega| \\le \\omega_{c}$ 时为 $1$，其他情况下为 $0$。\n        2. Shepp–Logan: 当 $|\\omega| \\le \\omega_{c}$ 时为 $\\dfrac{\\sin(\\frac{\\pi\\,\\omega}{2\\,\\omega_{c}})}{\\frac{\\pi\\,\\omega}{2\\,\\omega_{c}}}$，其他情况下为 $0$。\n        3. Hamming: 当 $|\\omega| \\le \\omega_{c}$ 时为 $0.54 + 0.46 \\cos(\\frac{\\pi\\,\\omega}{\\omega_{c}})$，其他情况下为 $0$。\n    - 噪声模型: 沿着探测器位置 $s$ 的加性、零均值、白噪声、广义平稳（WSS）噪声，其双边功率谱密度（PSD）为常数 $S_{0}$，且在不同投影角度 $\\theta$ 之间独立。\n- **验证**：\n    - **科学依据**：该问题牢固地植根于线性系统理论和断层成像的数学基础（Radon 变换，FBP）。所有模型和定义都是该领域的标准。\n    - **适定性**：问题陈述清晰，提供了所有必要的定义。任务是为明确定义的物理量（相对噪声方差）推导解析表达式，从而得到唯一解。\n    - **客观性**：语言精确，没有主观性。\n- **结论**：该问题有效。\n\n### 第2步：噪声方差放大的推导\n\nFBP 过程包括两个线性操作：滤波和反投影。我们关心的是输入噪声如何传播到重建图像中。\n\n设角度 $\\theta$ 处投影中的噪声为 $n(\\theta, s)$。问题指出这是一个零均值、广义平稳的随机过程，具有恒定的功率谱密度 $S_{n}(\\omega) = S_{0}$。这就是白噪声的定义。\n\n**滤波阶段：**\n对于每个投影角度 $\\theta$，含噪投影被一个频率响应为 $H(\\omega) = |\\omega|W(\\omega)$ 的线性时不变（LTI）滤波器进行滤波。对于一个输入为功率谱密度为 $S_{in}(\\omega)$ 的随机过程，一个频率响应为 $H(\\omega)$ 的线性系统的输出是一个功率谱密度为 $S_{out}(\\omega) = S_{in}(\\omega) |H(\\omega)|^2$ 的随机过程。\n\n在我们的情况中，输入是噪声 $n(\\theta, s)$，其功率谱密度为 $S_{n}(\\omega) = S_0$。滤波后的噪声，我们称之为 $n_f(\\theta, s)$，其功率谱密度 $S_{n_f}(\\omega)$ 由下式给出：\n$$S_{n_f}(\\omega) = S_{0} |H(\\omega)|^2 = S_{0} \\big| |\\omega|W(\\omega) \\big|^2 = S_{0} \\omega^2 W(\\omega)^2$$\n窗函数 $W(\\omega)$ 是实值的，因此 $|W(\\omega)|^2 = W(\\omega)^2$。\n\n滤波后噪声的方差 $\\sigma_f^2$ 是其功率谱密度在所有频率上的积分。根据信号处理中角频率 $\\omega$ 的标准定义，这可以表示为：\n$$\\sigma_f^2 = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{n_f}(\\omega) \\,d\\omega = \\frac{S_{0}}{2\\pi} \\int_{-\\infty}^{\\infty} \\omega^2 W(\\omega)^2 \\,d\\omega$$\n\n**反投影阶段：**\n反投影操作将滤波后的投影 $n_f(\\theta, s)$ 在所有角度 $\\theta$（从 $0$ 到 $\\pi$）上进行求和（积分）。最终重建图像中给定像素点的噪声是这个积分的结果。由于假设噪声在不同角度之间是独立的，因此和的方差等于方差的和。更正式地说，反投影对滤波后的噪声过程进行积分。这个对 $\\theta$ 的积分得到的最终图像噪声方差 $\\sigma_{\\text{img}}^2$ 与滤波后投影的方差 $\\sigma_f^2$ 成正比。\n$$\\sigma_{\\text{img}}^2 \\propto \\sigma_f^2$$\n因此，最终图像中噪声方差的放大倍数与以下积分成正比：\n$$I_W = \\int_{-\\infty}^{\\infty} \\omega^2 W(\\omega)^2 \\,d\\omega$$\n由于所有窗函数在 $|\\omega|  \\omega_c$ 时均为零，该积分是有界的：\n$$I_W = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 W(\\omega)^2 \\,d\\omega$$\n我们需要为这三种窗函数分别计算这个积分，然后找出它们相对于 Ram-Lak 情况的比值。对于这三种窗函数，被积函数 $\\omega^2 W(\\omega)^2$ 都是 $\\omega$ 的偶函数，所以我们可以写成 $I_W = 2 \\int_{0}^{\\omega_c} \\omega^2 W(\\omega)^2 \\,d\\omega$。\n\n### 第3步：积分计算\n\n**1. Ram–Lak (RL) 窗**\n$W_{\\mathrm{RL}}(\\omega) = 1$ for $|\\omega| \\le \\omega_{c}$。\n$$I_{\\mathrm{RL}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 (1)^2 \\,d\\omega = 2 \\int_{0}^{\\omega_c} \\omega^2 \\,d\\omega = 2 \\left[ \\frac{\\omega^3}{3} \\right]_{0}^{\\omega_c} = \\frac{2}{3} \\omega_c^3$$\n这将作为我们的归一化常数。Ram-Lak 窗的相对放大因子是 $A_{\\mathrm{RL}} = I_{\\mathrm{RL}}/I_{\\mathrm{RL}} = 1$。\n\n**2. Shepp–Logan (SL) 窗**\n$W_{\\mathrm{SL}}(\\omega) = \\frac{\\sin(a\\omega)}{a\\omega}$，其中 $a = \\frac{\\pi}{2\\omega_c}$。\n$$I_{\\mathrm{SL}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\left( \\frac{\\sin(a\\omega)}{a\\omega} \\right)^2 \\,d\\omega = \\frac{1}{a^2} \\int_{-\\omega_c}^{\\omega_c} \\sin^2(a\\omega) \\,d\\omega$$\n使用恒等式 $\\sin^2(x) = \\frac{1 - \\cos(2x)}{2}$：\n$$I_{\\mathrm{SL}} = \\frac{2}{a^2} \\int_{0}^{\\omega_c} \\frac{1 - \\cos(2a\\omega)}{2} \\,d\\omega = \\frac{1}{a^2} \\left[ \\omega - \\frac{\\sin(2a\\omega)}{2a} \\right]_{0}^{\\omega_c}$$\n在积分上限 $\\omega = \\omega_c$ 处，正弦函数的参数为 $2a\\omega_c = 2(\\frac{\\pi}{2\\omega_c})\\omega_c = \\pi$。由于 $\\sin(\\pi) = 0$ 且 $\\sin(0) = 0$，正弦项消失。\n$$I_{\\mathrm{SL}} = \\frac{1}{a^2} (\\omega_c - 0) = \\frac{\\omega_c}{a^2} = \\frac{\\omega_c}{(\\pi/(2\\omega_c))^2} = \\frac{\\omega_c}{\\pi^2/(4\\omega_c^2)} = \\frac{4\\omega_c^3}{\\pi^2}$$\n相对放大因子为：\n$$A_{\\mathrm{SL}} = \\frac{I_{\\mathrm{SL}}}{I_{\\mathrm{RL}}} = \\frac{4\\omega_c^3/\\pi^2}{2\\omega_c^3/3} = \\frac{4}{\\pi^2} \\cdot \\frac{3}{2} = \\frac{6}{\\pi^2}$$\n\n**3. Hamming (H) 窗**\n$W_{\\mathrm{H}}(\\omega) = P + Q\\cos(b\\omega)$ for $|\\omega| \\le \\omega_{c}$，其中 $P = 0.54$，$Q = 0.46$，$b = \\frac{\\pi}{\\omega_c}$。\n$$I_{\\mathrm{H}} = \\int_{-\\omega_c}^{\\omega_c} \\omega^2 (P + Q\\cos(b\\omega))^2 \\,d\\omega$$\n展开平方项：\n$$I_{\\mathrm{H}} = \\int_{-\\omega_c}^{\\omega_c} \\left( P^2\\omega^2 + 2PQ\\omega^2\\cos(b\\omega) + Q^2\\omega^2\\cos^2(b\\omega) \\right) \\,d\\omega$$\n我们计算三个积分项：\n第1项: $\\int_{-\\omega_c}^{\\omega_c} P^2\\omega^2 \\,d\\omega = P^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\,d\\omega = P^2 \\left(\\frac{2}{3}\\omega_c^3\\right)$。\n第2项: $2PQ \\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(b\\omega) \\,d\\omega$。通过两次分部积分，可以得到 $\\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(b\\omega) \\,d\\omega = -\\frac{4\\omega_c^3}{\\pi^2}$。所以，该项为 $2PQ \\left(-\\frac{4\\omega_c^3}{\\pi^2}\\right) = -\\frac{8PQ\\omega_c^3}{\\pi^2}$。\n第3项: $Q^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos^2(b\\omega) \\,d\\omega = Q^2 \\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\frac{1+\\cos(2b\\omega)}{2} \\,d\\omega$。这可以分解为 $\\frac{Q^2}{2}\\int_{-\\omega_c}^{\\omega_c} \\omega^2 \\,d\\omega + \\frac{Q^2}{2}\\int_{-\\omega_c}^{\\omega_c} \\omega^2\\cos(2b\\omega) \\,d\\omega$。第一个积分为 $\\frac{2}{3}\\omega_c^3$。第二个积分，再次通过分部积分，得到 $\\frac{\\omega_c^3}{\\pi^2}$。所以，第3项为 $\\frac{Q^2}{2}\\left(\\frac{2}{3}\\omega_c^3 + \\frac{\\omega_c^3}{\\pi^2}\\right) = Q^2\\omega_c^3\\left(\\frac{1}{3} + \\frac{1}{2\\pi^2}\\right)$。\n\n将各项相加得到 $I_{\\mathrm{H}}$：\n$$I_{\\mathrm{H}} = \\omega_c^3 \\left[ \\frac{2}{3}P^2 - \\frac{8PQ}{\\pi^2} + \\frac{1}{3}Q^2 + \\frac{Q^2}{2\\pi^2} \\right]$$\n相对放大因子为 $A_{\\mathrm{H}} = I_{\\mathrm{H}}/I_{\\mathrm{RL}}$:\n$$A_{\\mathrm{H}} = \\frac{\\omega_c^3 \\left[ \\frac{2}{3}P^2 + \\frac{1}{3}Q^2 - \\frac{8PQ}{\\pi^2} + \\frac{Q^2}{2\\pi^2} \\right]}{\\frac{2}{3}\\omega_c^3} = \\frac{3}{2} \\left[ \\frac{1}{3}(2P^2+Q^2) + \\frac{1}{2\\pi^2}(Q^2 - 16PQ) \\right]$$\n$$A_{\\mathrm{H}} = \\frac{1}{2}(2P^2+Q^2) + \\frac{3}{4\\pi^2}(Q^2 - 16PQ)$$\n代入 $P = 0.54 = \\frac{27}{50}$ 和 $Q = 0.46 = \\frac{23}{50}$：\n$2P^2+Q^2 = 2\\left(\\frac{27}{50}\\right)^2 + \\left(\\frac{23}{50}\\right)^2 = \\frac{2 \\cdot 729 + 529}{2500} = \\frac{1458+529}{2500} = \\frac{1987}{2500}$。\n$Q^2-16PQ = \\left(\\frac{23}{50}\\right)^2 - 16\\left(\\frac{27}{50}\\right)\\left(\\frac{23}{50}\\right) = \\frac{529 - 16 \\cdot 621}{2500} = \\frac{529 - 9936}{2500} = -\\frac{9407}{2500}$。\n$$A_{\\mathrm{H}} = \\frac{1}{2}\\left(\\frac{1987}{2500}\\right) + \\frac{3}{4\\pi^2}\\left(-\\frac{9407}{2500}\\right) = \\frac{1987}{5000} - \\frac{28221}{10000\\pi^2}$$\n\n### 第4步：最终答案\nRam-Lak、Shepp-Logan 和 Hamming 窗的相对噪声方差放大因子分别为：\n1. $A_{\\mathrm{RL}} = 1$\n2. $A_{\\mathrm{SL}} = \\frac{6}{\\pi^2}$\n3. $A_{\\mathrm{H}} = \\frac{1987}{5000} - \\frac{28221}{10000\\pi^2}$\n\n我们按照要求将它们表示在一个单行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\frac{6}{\\pi^2}  \\frac{1987}{5000} - \\frac{28221}{10000 \\pi^2}\n\\end{pmatrix}\n}\n$$", "id": "4913443"}, {"introduction": "由于系统固有的限制，重建出的图像永远不可能是原始物体的完美复制品。一个关键的限制是任何成像系统的带宽都是有限的，这在频域上表现为一个低通滤波器。本练习旨在探索这种限制如何具体地表现为图像伪影，通过将CT系统建模为一个理想的带限系统，您将推导出一个尖锐边缘在重建后的形态，并量化由此产生的“吉布斯现象”或振铃伪影[@problem_id:4913446]。这个过程将帮助您理解图像伪影的物理来源，并将抽象的傅里叶域概念与可观察到的空间域特征联系起来。", "problem": "一个强度为单位1的均匀圆形圆盘体模，通过使用滤波反投影（FBP）的平行束计算机断层扫描（CT）进行重建。假设重建在图像平面上是线性移不变的，因此重建图像等于真实物体与点扩散函数（PSF）的卷积。重建的有效调制传递函数（MTF）被建模为一个理想的、圆形对称的、带限通带：\n$$\nM(\\mathbf{k}) = \\begin{cases}\n1,  |\\mathbf{k}| \\leq k_c, \\\\\n0,  |\\mathbf{k}|  k_c,\n\\end{cases}\n$$\n其中 $\\mathbf{k} = (k_x, k_y)$ 是空间频率矢量，而 $k_c  0$ 是截止空间频率。使用以下二维傅里叶变换约定\n$$\n\\mathcal{F}\\{f\\}(\\mathbf{k}) = \\int_{\\mathbb{R}^2} f(\\mathbf{x}) \\exp(-i\\,\\mathbf{k}\\cdot\\mathbf{x}) \\, d^2\\mathbf{x}, \\quad\n\\mathcal{F}^{-1}\\{F\\}(\\mathbf{x}) = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} F(\\mathbf{k}) \\exp(i\\,\\mathbf{k}\\cdot\\mathbf{x}) \\, d^2\\mathbf{k}.\n$$\n在圆盘边界的任意一点，考虑一个局部标准正交坐标系，其中 $x$ 表示指向边缘的内法线方向，理想内部为半平面 $x0$。将真实物体在局部建模为在边缘 $x=0$ 处的一个单位阶跃函数 $u(x)$。\n\n从上述定义出发，推导边缘扩散函数 $s(x)$，它被定义为跨越边缘的重建强度作为 $x$ 的函数，并用 PSF 和单位阶跃输入来表示。然后，使用 $s(x)$ 通过确定第一个超过渐近内部值的过冲的幅度来量化吉布斯现象。将此过冲表示为阶跃高度的无量纲分数。最终答案必须是一个四舍五入到五位有效数字的实数。不需要物理单位。", "solution": "题目要求计算CT重建中吉布斯现象过冲的幅度，并表示为边缘阶跃高度的一个分数。该系统被建模为在频域中具有理想、圆形对称低通滤波器的线性移不变（LSI）系统。\n\n重建图像，我们记为 $f_{rec}(\\mathbf{x})$，是真实物体 $f_{true}(\\mathbf{x})$ 与系统的点扩散函数（PSF） $h(\\mathbf{x})$ 的卷积：\n$$f_{rec}(\\mathbf{x}) = (f_{true} * h)(\\mathbf{x})$$\n题目指出，调制传递函数（MTF） $M(\\mathbf{k})$ 是指定的理想低通滤波器。在LSI系统中，PSF是光学传递函数（OTF）的傅里叶逆变换。MTF是OTF的模。由于给定的 $M(\\mathbf{k})$ 是实数且非负，我们可以令OTF等于MTF：\n$$OTF(\\mathbf{k}) = M(\\mathbf{k}) = \\begin{cases} 1,  |\\mathbf{k}| \\leq k_c \\\\ 0,  |\\mathbf{k}|  k_c \\end{cases}$$\n该问题通过考虑圆盘边缘的局部区域来简化分析。在该区域中，弯曲的边缘被近似为一条直线，真实物体被建模为沿 $x$ 轴方向的单位阶跃函数：\n$$f_{true}(\\mathbf{x}) = u(x) = \\begin{cases} 1,  x > 0 \\\\ 0,  x  0 \\end{cases}$$\n由于输入物体的一维特性，重建图像，称为边缘扩散函数（ESF） $s(x,y)$，仅取决于垂直于边缘的坐标 $x$。\n$$s(x) = \\int\\limits_{-\\infty}^{\\infty}\\int\\limits_{-\\infty}^{\\infty} u(x') h(x-x', y-y') \\, dx' \\, dy'$$\n这可以表示为输入 $u(x)$ 与线扩散函数（LSF） $L(x)$ 的一维卷积：\n$$s(x) = (u * L)(x)$$\n其中LSF是二维PSF沿着平行于边缘方向的积分：\n$$L(x) = \\int_{-\\infty}^{\\infty} h(x,y) \\, dy$$\n与傅里叶变换相关的一个基本性质（投影切片定理）指出，LSF的一维傅里叶变换 $\\mathcal{F}_1\\{L\\}(k_x)$ 等于二维OTF在 $k_y=0$ 处的中心切片：\n$$\\mathcal{F}_1\\{L\\}(k_x) = OTF(k_x, 0)$$\n根据 $OTF(\\mathbf{k})$ 的定义，我们有：\n$$\\mathcal{F}_1\\{L\\}(k_x) = \\begin{cases} 1,  |k_x| \\leq k_c \\\\ 0,  |k_x|  k_c \\end{cases}$$\n这是频域中的一个矩形函数。LSF可以通过进行一维傅里叶逆变换得到。使用指定的约定，即 $d$ 维函数的逆变换具有 $1/(2\\pi)^d$ 的前置因子，对于 $d=1$ 我们使用 $1/(2\\pi)$：\n$$L(x) = \\mathcal{F}_1^{-1}\\{\\mathcal{F}_1\\{L\\}\\}(x) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathcal{F}_1\\{L\\}(k_x) \\exp(i k_x x) \\, dk_x$$\n$$L(x) = \\frac{1}{2\\pi} \\int_{-k_c}^{k_c} (1) \\cdot \\exp(i k_x x) \\, dk_x$$\n计算该积分：\n$$L(x) = \\frac{1}{2\\pi} \\left[ \\frac{\\exp(i k_x x)}{ix} \\right]_{-k_c}^{k_c} = \\frac{1}{2\\pi ix} (\\exp(i k_c x) - \\exp(-i k_c x)) = \\frac{2i\\sin(k_c x)}{2\\pi ix} = \\frac{\\sin(k_c x)}{\\pi x}$$\nESF $s(x)$ 是 $u(x)$ 和 $L(x)$ 的卷积，这等价于LSF的积分：\n$$s(x) = (u * L)(x) = \\int_{-\\infty}^{x} L(\\tau) \\, d\\tau$$\n$$s(x) = \\int_{-\\infty}^{x} \\frac{\\sin(k_c \\tau)}{\\pi \\tau} \\, d\\tau$$\n为了计算这个积分，我们进行换元，$z = k_c \\tau$，因此 $d\\tau = dz/k_c$：\n$$s(x) = \\int_{-\\infty}^{k_c x} \\frac{\\sin(z)}{\\pi (z/k_c)} \\frac{dz}{k_c} = \\frac{1}{\\pi} \\int_{-\\infty}^{k_c x} \\frac{\\sin(z)}{z} \\, dz$$\n我们可以将积分拆分：\n$$s(x) = \\frac{1}{\\pi} \\left( \\int_{-\\infty}^{0} \\frac{\\sin(z)}{z} \\, dz + \\int_{0}^{k_c x} \\frac{\\sin(z)}{z} \\, dz \\right)$$\n第一个积分是一个已知的定积分，$\\int_0^{\\infty} \\frac{\\sin(z)}{z} dz = \\frac{\\pi}{2}$。根据对称性，$\\int_{-\\infty}^0 \\frac{\\sin(z)}{z} dz = \\frac{\\pi}{2}$。第二个积分是正弦积分函数的定义，$\\text{Si}(t) = \\int_0^t \\frac{\\sin(z)}{z} dz$。\n因此，ESF为：\n$$s(x) = \\frac{1}{\\pi} \\left( \\frac{\\pi}{2} + \\text{Si}(k_c x) \\right) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(k_c x)$$\n渐近内部值对应于 $x \\to \\infty$。当 $x \\to \\infty$ 时，$k_c x \\to \\infty$，且 $\\lim_{t\\to\\infty} \\text{Si}(t) = \\frac{\\pi}{2}$。\n$$s_{interior} = \\lim_{x\\to\\infty} s(x) = \\frac{1}{2} + \\frac{1}{\\pi} \\left(\\frac{\\pi}{2}\\right) = 1$$\n渐近外部值对应于 $x \\to -\\infty$，此时 $\\lim_{t\\to-\\infty} \\text{Si}(t) = -\\frac{\\pi}{2}$，得到 $s_{exterior} = 0$。阶跃高度为 $s_{interior} - s_{exterior} = 1 - 0 = 1$。\n\n吉布斯现象表现为不连续点周围的振铃。过冲可以通过找到 $s(x)$ 在 $x0$ 时的第一个最大值来确定。我们通过将 $s(x)$ 的导数设为零来找到极值点：\n$$\\frac{ds}{dx} = L(x) = \\frac{\\sin(k_c x)}{\\pi x} = 0$$\n这发生在 $\\sin(k_c x) = 0$ 时，这意味着对于任何非零整数 $n$，有 $k_c x = n\\pi$。极值点位于 $x_n = n\\pi/k_c$。在 $x0$ 区域的第一个极值点对应于 $n=1$，位于 $x_1 = \\pi/k_c$。这个位置对应一个最大值（第一个过冲）。\n在该点ESF的值为：\n$$s_{peak} = s(\\pi/k_c) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(k_c \\cdot \\frac{\\pi}{k_c}) = \\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(\\pi)$$\n超出渐近内部值的第一个过冲的幅度为：\n$$Overshoot = s_{peak} - s_{interior} = \\left(\\frac{1}{2} + \\frac{1}{\\pi} \\text{Si}(\\pi)\\right) - 1 = \\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}$$\n题目要求将此过冲表示为阶跃高度的无量纲分数。由于阶跃高度为 $1$，此分数就等于过冲幅度本身。\n$$Fractional \\ Overshoot = \\frac{Overshoot}{Step \\ Height} = \\frac{\\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}}{1} = \\frac{\\text{Si}(\\pi)}{\\pi} - \\frac{1}{2}$$\n为了求出数值，我们使用正弦积分在 $\\pi$ 处的值，即 $\\text{Si}(\\pi) \\approx 1.85193705$。\n$$Fractional \\ Overshoot \\approx \\frac{1.85193705}{3.14159265} - 0.5 \\approx 0.58949446 - 0.5 = 0.08949446$$\n四舍五入到五位有效数字，得到 $0.08949$。", "answer": "$$\\boxed{0.08949}$$", "id": "4913446"}]}