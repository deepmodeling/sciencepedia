## 引言
在医学成像领域，[断层扫描](@entry_id:756051)技术使我们能够无创地窥探人体内部的复杂结构。这一过程的核心挑战在于如何将从不同角度采集到的大量X射线投影数据，转化为一幅清晰的二维或三维图像。原始的探测器读数本身缺乏直接的几何意义，因此，我们需要一个强大的数学框架来组织和解读这些信息。[正弦图](@entry_id:754926)（sinogram）正是应对这一挑战而生的关键概念，它不仅是重建过程中的一个中间步骤，更是一个蕴含了关于被测物体和扫描系统丰富信息的[独立数](@entry_id:260943)据空间。

本文旨在系统性地介绍[正弦图](@entry_id:754926)这一核心表示方法。在第一章 **“原理与机制”** 中，我们将从雷登变换出发，深入探讨[正弦图](@entry_id:754926)的数学定义、几何特性以及它与图像傅里叶变换之间至关重要的联系——[傅里叶切片定理](@entry_id:192235)。接下来，在第二章 **“应用与跨学科联系”** 中，我们将把理论付诸实践，展示如何通过分析[正弦图](@entry_id:754926)来诊断和校正成像伪影，并探讨其在PET等其他成像模态中的应用。最后，通过第三章 **“动手实践”** 中的具体问题，您将有机会亲手计算和分析[正弦图](@entry_id:754926)，从而巩固所学知识。通过这一系列的学习，您将全面掌握[正弦图](@entry_id:754926)的理论、诊断价值和在现代成像技术中的核心作用。

## 原理与机制

在断层成像中，我们的目标是从一系列穿过物体的投影数据中重建出该物体的内部结构二维或三维图像。这些投影数据，当以一种特定的方式组织时，会形成一个称为 **[正弦图](@entry_id:754926) (sinogram)** 的强大表示。本章将深入探讨[正弦图](@entry_id:754926)的数学原理、内在属性及其在[图像重建](@entry_id:166790)过程中的核心作用。我们将从平行束几何的基础出发，逐步揭示[正弦图](@entry_id:754926)的结构、对称性，并最终扩展到更具实际意义的扇形束系统。

### [基本表示](@entry_id:157678)：平行束几何中的雷登变换

在二维平行束[计算机断层扫描 (CT)](@entry_id:747639) 中，我们想象一束平行的 X 射线穿过一个由函数 $f(x,y)$ 描述的物体，该函数代表物体在空间点 $(x,y)$ 处的[线性衰减](@entry_id:198935)系数。在任意给定的投影角度 $\theta$ 下，探测器测量到的是沿着一系列平行直线的[线积分](@entry_id:141417)。为了唯一地确定每一条积分路径，我们需要一个明确的[参数化](@entry_id:265163)方法。

描述平面中任意一条直线的最自然方式之一是使用其[法向量](@entry_id:264185)和它到原点的距离。我们定义一条直线由其[单位法向量](@entry_id:178851) $\mathbf{n}(\theta) = (\cos\theta, \sin\theta)$ 和它到原点的 **有符号垂直距离 (signed perpendicular distance)** $s$ 共同确定。其中，$\theta$ 是法向量与 $x$ 轴正方向的夹角。

根据矢量射影的定义，位于该直线上的任意点 $(x,y)$ 的位置矢量 $\mathbf{r}=(x,y)$ 在[法向量](@entry_id:264185) $\mathbf{n}(\theta)$ 上的投影都等于 $s$。这可以用点积形式表示为：
$$
\mathbf{r} \cdot \mathbf{n}(\theta) = s
$$
展开后，我们得到该直线的方程：
$$
x\cos\theta + y\sin\theta = s
$$
这条方程是理解[正弦图](@entry_id:754926)表示的基石。我们可以通过定义一个标量场 $g(x,y) = x\cos\theta + y\sin\theta$ 来从另一个角度理解它。该直线就是 $g(x,y)$ 的值为 $s$ 的等值线。根据多元微积分的基本定理，[标量场的梯度](@entry_id:270765) $\nabla g$ 垂直于其等值线。计算梯度我们得到 $\nabla g = (\cos\theta, \sin\theta)$，其模长 $\|\nabla g\| = \sqrt{\cos^2\theta + \sin^2\theta} = 1$。这再次证明了 $\mathbf{n}(\theta) = (\cos\theta, \sin\theta)$ 确实是该直线的[单位法向量](@entry_id:178851)，而参数 $s$ 则是从原点到该直线的有符号[垂直距离](@entry_id:176279) [@problem_id:4924314]。

因此，在给定角度 $\theta$ 和偏移量 $s$ 下的投影值 $p(s, \theta)$ 就是函数 $f(x,y)$ 沿上述直线的[线积分](@entry_id:141417)。这个数学操作被称为 **雷登变换 (Radon Transform)**。我们可以利用 **狄拉克 $\delta$ 函数** 将这个[线积分](@entry_id:141417)表示为一个在整个 $\mathbb{R}^2$ 平面上的面积分。$\delta$ 函数在此的作用是约束积分范围，只在满足 $x\cos\theta + y\sin\theta - s = 0$ 的点上取值：
$$
p(s,\theta) = \int_{\mathbb{R}^2} f(x,y)\,\delta(x\cos\theta + y\sin\theta - s)\,dx\,dy
$$
[@problem_id:4924317] 这种表示方式在理论推导中非常有用。为了进一步理解这个积分的几何意义，我们可以引入一个与投影方向对齐的[旋转坐标系](@entry_id:170324) $(s, t)$ [@problem_id:4924370]。该坐标系由法线方向 $s$ 和切线方向 $t$ 构成，变换关系为：
$$
s = x\cos\theta + y\sin\theta
$$
$$
t = -x\sin\theta + y\cos\theta
$$
这是一个纯[旋转变换](@entry_id:200017)，其[雅可比行列式](@entry_id:137120)的值为 $1$。这意味着[面积元](@entry_id:263205)在这种[坐标变换](@entry_id:138577)下保持不变，即 $dx\,dy = ds\,dt$。因此，雷登变换可以被等价地写为在固定 $s$ 值下，沿切线方向 $t$ 的一个简单的一维积分，而无需任何额外的缩放因子：
$$
p(s,\theta) = \int_{-\infty}^{\infty} f(x(s,t), y(s,t)) \,dt
$$

### [正弦图](@entry_id:754926)：结构与解读

将所有投影角度 $\theta \in [0, \pi)$ 和对应的探测器位置 $s$ 的投影值 $p(s, \theta)$ 组合在一起，就形成了一个二维图像，我们称之为 **[正弦图](@entry_id:754926) (sinogram)**。[正弦图](@entry_id:754926)的横轴通常是探测器位置 $s$，纵轴是投影角度 $\theta$。

“[正弦图](@entry_id:754926)”这个名字源于一个非常直观的特性：一个理想的点状物体在[正弦图](@entry_id:754926)上会产生一条完美的正弦曲线。为了理解这一点，我们考虑一个位于 $(x_0, y_0)$ 的点状物体，其密度可以表示为 $f(x,y) = \delta(x-x_0, y-y_0)$。将其代入雷登变换的定义中，利用 $\delta$ 函数的[筛选性质](@entry_id:265662)，我们得到：
$$
p(s,\theta) = \delta(s - (x_0\cos\theta + y_0\sin\theta))
$$
这意味着对于给定的角度 $\theta$，只有当 $s = x_0\cos\theta + y_0\sin\theta$ 时投影值才不为零。这条方程 $s(\theta) = x_0\cos\theta + y_0\sin\theta$ 描述了该点在 $(s, \theta)$ 坐标系（即[正弦图](@entry_id:754926)）中的轨迹。通过[三角函数](@entry_id:178918)恒等变换，它可以写成 $s(\theta) = R\cos(\theta - \phi_0)$ 的形式，其中 $R = \sqrt{x_0^2 + y_0^2}$ 是点到原点的距离，$\phi_0$ 是其极角。这正是一条振幅为 $R$、相位为 $\phi_0$ 的余弦（或正弦）曲线 [@problem_id:4924317]。

一个复杂的物体可以看作是无数个点的集合，因此其[正弦图](@entry_id:754926)就是对应无数条不同振幅和相位的正弦曲线的叠加。物体的空间位置、形状和内部结构都以这种独特的形式编码在[正弦图](@entry_id:754926)中。例如，物体越靠近中心，其在[正弦图](@entry_id:754926)上对应的正弦曲线振幅越小；物体越靠近边缘，振幅越大。

### [正弦图](@entry_id:754926)的核心对称性与属性

[正弦图](@entry_id:754926)具有一系列由其几何定义决定的内在属性和对称性。理解这些属性对于数据处理、伪影校正和算法设计至关重要。

#### 平移与旋转属性

物体的空间变换会在[正弦图](@entry_id:754926)上引起相应的、可预测的变化。
*   **平移属性 (Shift Property)**：如果物体在空间中平移了一个矢量 $(\Delta x, \Delta y)$，形成一个新的函数 $f_\Delta(x,y) = f(x-\Delta x, y-\Delta y)$，那么其对应的[正弦图](@entry_id:754926) $p_\Delta(s, \theta)$ 会发生一个随角度变化的位移。通过变量替换可以证明 [@problem_id:4924359]：
    $$
    p_\Delta(s, \theta) = p(s - (\Delta x\cos\theta + \Delta y\sin\theta), \theta)
    $$
    这意味着物体在空间中的平移会在[正弦图](@entry_id:754926)上产生一个沿着 $s$ 轴的正弦形位移。这个特性是运动伪影校正算法的理论基础。

*   **旋转属性 (Rotation Property)**：如果物体绕原点旋转了一个角度 $\phi$，形成 $f_\phi(\mathbf{x}) = f(R_{-\phi}\mathbf{x})$，其效果在[正弦图](@entry_id:754926)上则异常简洁。可以证明，这等价于将整个[正弦图](@entry_id:754926)沿着 $\theta$ 轴平移 $\phi$ [@problem_id:4924321]：
    $$
    p_\phi(s, \theta) = p(s, \theta - \phi)
    $$
    这个直观的属性使得在重建前对齐物体的角度变得非常容易。

#### 中心切片对称性及其拓扑学推论

[正弦图](@entry_id:754926)最基本的一个对称性源于一条直线可以被两个方向相反的法向量所描述。参数对 $(s, \theta)$ 和 $(-s, \theta+\pi)$ 定义的是同一条几何直线，因为将[法向量](@entry_id:264185)反向 $(\mathbf{n} \to -\mathbf{n})$ 并同时反转其到原点的有符号距离 $(s \to -s)$，描述的仍是原来的路径。因此，它们的线积分值必然相等：
$$
p(s, \theta) = p(-s, \theta+\pi)
$$
这个属性通常被称为 **中心切片对称性 (Central Slice Symmetry)** 或“对径对称性”。它揭示了投影数据中存在内在的冗余。

这一对称性具有深刻的拓扑学推论 [@problem_id:4924346]。
*   如果我们采集 $0$ 到 $2\pi$ 范围内的所有角度的投影，即 $\theta \in [0, 2\pi)$，那么上述对称性意味着在 $[0, \pi)$ 区间内的数据已经完全决定了 $[\pi, 2\pi)$ 区间内的数据。例如，$\theta = 30^\circ$ 的投影可以通过将 $\theta = 210^\circ$ 的投影沿 $s$ 轴翻转得到。因此，采集整个 $2\pi$ 角度的数据存在 **双重冗余 (twofold redundancy)**。在这种情况下，[正弦图](@entry_id:754926)的[参数空间](@entry_id:178581) $[-S, S] \times [0, 2\pi)$ 由于 $\theta=0$ 和 $\theta=2\pi$ 的周期性，在拓扑学上是一个 **圆柱体 (cylinder)**。

*   为了消除这种冗余，我们通常只采集 $\theta \in [0, \pi)$ 范围内的数据。在这个非冗余的参数空间 $[-S, S] \times [0, \pi)$ 中，对称性 $p(s, \theta) = p(-s, \theta+\pi)$ 体现为边界条件。在 $\theta=0$ 处，该对称性变为 $p(s, 0) = p(-s, \pi)$。这个边界条件意味着，要将这个矩形区域的边界“粘合”起来形成一个连续的曲面，我们必须将 $\theta=0$ 处的边与 $\theta=\pi$ 处的边进行一次 **半扭转 (half-twist)** 后再连接。这个经过扭转粘合的拓扑结构不再是简单的圆柱体，而是一个 **莫比乌斯带 (Möbius strip)**。因此，[正弦图](@entry_id:754926)的自然、非冗余的定义域是一个莫比乌斯带。这个认识对于开发高级重建算法和理解[数据一致性](@entry_id:748190)条件至关重要。

### 从[正弦图](@entry_id:754926)到图像：傅里叶空间的角色

[正弦图](@entry_id:754926)与[原始图](@entry_id:262918)像之间的桥梁是 **[傅里叶切片定理](@entry_id:192235) (Fourier Slice Theorem)**，也称为[中心切片定理](@entry_id:274881)。该定理指出：
> **一个投影 $p(s, \theta)$ 关于其空间变量 $s$ 的一维傅里叶变换，等于原始图像 $f(x,y)$ 的[二维傅里叶变换](@entry_id:273583) $F(k_x, k_y)$ 沿着穿过原点、与投影方向垂直（即角度为 $\theta$）的一条直线（一个“切片”）的值。**

数学上，如果 $P(\omega, \theta)$ 是 $p(s, \theta)$ 关于 $s$ 的一维傅里叶变换，那么：
$$
P(\omega, \theta) = F(\omega\cos\theta, \omega\sin\theta)
$$
其中 $\omega$ 是与 $s$ 共轭的频率变量。

这个定理是所有基于傅里叶变换的重建算法的基石，例如 **滤波反投影 (Filtered Back-Projection, FBP)**。它告诉我们，通过采集所有角度的投影，我们可以得到物体在傅里叶空间中一系列穿过原点的径向切片上的值。

要从这些采样的[傅里叶数](@entry_id:154618)据中重建图像 $f(x,y)$，我们需要执行二维[逆傅里叶变换](@entry_id:178300)。然而，直接在极坐标系下对这些径向样本进行积分是错误的。二维[逆傅里叶变换](@entry_id:178300)的[标准形式](@entry_id:153058)是 $\iint F(k_x, k_y) \, dk_x \, dk_y$，它假设了在笛卡尔坐标系 $(k_x, k_y)$ 下的均匀采样。当我们从[笛卡尔坐标](@entry_id:167698) $(k_x, k_y)$ 变换到极坐标 $(\omega, \theta)$ 时，[面积元](@entry_id:263205)会发生改变 [@problem_id:4924344]：
$$
dk_x \, dk_y = |\omega| \, d\omega \, d\theta
$$
这里的[雅可比行列式](@entry_id:137120) $|\omega|$ 是关键。它告诉我们，为了在极坐标下正确地计算积分，我们必须对每个傅里叶样本 $P(\omega, \theta)$ 进行加权，权重就是径向频率的大小 $|\omega|$。这个加权函数 $W(\omega) = |\omega|$ 就是所谓的 **[斜坡滤波器](@entry_id:754034) (ramp filter)**。它补偿了极坐标采样在傅里叶空间中固有的非均匀性（即样本在原点附近密集，在高频区域稀疏），通过增强高频分量来确保重建图像的准确性。

### 实际考虑：[正弦图](@entry_id:754926)的采样

在实际应用中，我们只能在离散的探测器位置 $s$ 和离散的投影角度 $\theta$ 上采集数据。采样间隔必须足够小以避免 **混叠 (aliasing)** 伪影。[傅里叶切片定理](@entry_id:192235)和[奈奎斯特-香农采样定理](@entry_id:262499)为我们提供了确定所需[采样率](@entry_id:264884)的理论依据 [@problem_id:4924364]。

假设物体在空间上被限制在一个半径为 $X$ 的圆内，并且其傅里叶变换在频率上被限制在一个半径为 $K$ 的圆内（这是一个在理论上很有用的理想化假设）。

*   **空间采样 ($\Delta s$)**：根据[傅里叶切片定理](@entry_id:192235)，每个投影 $p(s, \theta)$ 的一维傅里叶变换 $P(\omega, \theta)$ 的带宽也被限制在 $K$ 以内。根据[奈奎斯特采样定理](@entry_id:268107)，为了无混叠地采样这个一维信号，采样频率必须至少是其最高频率的两倍。因此，探测器的采样间隔 $\Delta s$ 必须满足：
    $$
    \Delta s \le \frac{1}{2K}
    $$

*   **角度采样 ($\Delta\theta$)**：角度采样的要求更为微妙。它取决于需要在傅里叶空间的外围（即半径为 $K$ 的圆周上）达到足够密集的采样。物体的空间范围 $X$ 决定了其傅里叶变换的“变化速率”，从而决定了频率域所需的采样密度。在半径为 $K$ 的频率处，相邻角度 $\theta$ 和 $\theta+\Delta\theta$ 的两个径向采样线之间的切向距离近似为 $K\Delta\theta$。为了避免混叠，这个距离不应超过由物体空间范围决定的采样间隔要求，即 $1/(2X)$。因此，角度采样间隔 $\Delta\theta$ (以[弧度](@entry_id:171693)为单位) 必须满足：
    $$
    K\Delta\theta \le \frac{1}{2X} \quad \implies \quad \Delta\theta \le \frac{1}{2KX}
    $$
这些关系式为CT扫描仪的设计和扫描参数的选择提供了基本的指导原则。

### 超越平行束：扇形束[正弦图](@entry_id:754926)

尽管平行束模型为理论分析提供了便利，但大多数现代[CT扫描](@entry_id:747639)仪采用 **扇形束 (fan-beam)** 几何结构，因为它可以更快地采集数据。在扇形束几何中，所有射线从单个[点源](@entry_id:196698)发出。

我们通常用以下参数来描述一个典型的扇形束系统：[X射线源](@entry_id:268482)位于一个以原点为中心、半径为 $R$ 的圆形轨迹上，其位置由源的角度 $\beta$ 决定。对于每一个源位置，一束扇形的射线发出，其中每一条射线由其与 **中心射线** (从源指向原点的射线) 的夹角 $\gamma$ 来标识。因此，扇形束[正弦图](@entry_id:754926)由数据 $g(\beta, \gamma)$ 构成。

一条由 $(\beta, \gamma)$ 定义的射线可以用路径长度参数 $s' \ge 0$ (从源点开始计算) 进行[参数化](@entry_id:265163) [@problem_id:4924320]。源的位置是 $(R\cos\beta, R\sin\beta)$。射线的[方向角](@entry_id:167868) $\phi_{ray}$ 可以通过将中心射线的方向 $(\beta+\pi)$ 旋转 $\gamma$ 得到，即 $\phi_{ray} = \beta+\pi+\gamma$。因此，射线的参数方程为：
$$
x(s') = R\cos\beta + s'\cos(\beta+\gamma+\pi) = R\cos\beta - s'\cos(\beta+\gamma)
$$
$$
y(s') = R\sin\beta + s'\sin(\beta+\gamma+\pi) = R\sin\beta - s'\sin(\beta+\gamma)
$$
虽然存在专门的扇形束重建算法，但一种常见且具有启发性的方法是 **重排 (rebinning)**，即将扇形束[数据转换](@entry_id:170268)为等效的平行束数据，然后使用成熟的平行束算法（如FBP）进行重建。

重排的核心是找到扇形束坐标 $(\beta, \gamma)$ 与平行束坐标 $(s, \theta)$ 之间的映射关系。通过[几何分析](@entry_id:157700)可以推导出 [@problem_id:4924353]：
$$
s = R\sin\gamma
$$
$$
\theta = \beta + \gamma + \pi/2
$$
在进行[坐标变换](@entry_id:138577)时，我们必须考虑数据点的“密度”变化。从 $(\beta, \gamma)$ 空间到 $(s, \theta)$ 空间的[微分](@entry_id:158422)[面积元](@entry_id:263205)变换由[雅可比行列式](@entry_id:137120)决定。为了保持积分守恒，即 $g(\beta,\gamma)\,d\beta\,d\gamma = p(s,\theta)\,ds\,d\theta$，需要对投影值进行加权。这个权重因子正是该[坐标变换](@entry_id:138577)的雅可比行列式。计算可得，从 $(\beta, \gamma)$ 到 $(s, \theta)$ 的雅可比行列式为：
$$
|J| = \left|\det\left(\frac{\partial(\beta, \gamma)}{\partial(s, \theta)}\right)\right| = \frac{1}{R\cos\gamma}
$$
利用 $s = R\sin\gamma$，我们可以将 $\cos\gamma$ 表示为 $s$ 和 $R$ 的函数：$\cos\gamma = \sqrt{R^2-s^2}/R$。因此，扇形束数据在重排时需要乘以一个与几何相关的校正因子：
$$
p(s, \theta) = \frac{1}{R\cos\gamma} g(\beta, \gamma) = \frac{g(\beta, \gamma)}{\sqrt{R^2-s^2}}
$$
这个过程清晰地展示了不同采集几何之间深刻的数学联系，并强调了在数据处理中进行精确几何校正的重要性。