{"hands_on_practices": [{"introduction": "在真实的CT扫描仪中，连续的物体和积分过程被离散化处理。物体被看作是由像素（或体素）组成的网格，而线积分则简化为加权和。本练习 [@problem_id:4924309] 提供了一个具体的例子，演示了如何计算这些权重——即射线与每个像素的相交长度——从而构建了用于图像重建的系统矩阵的基础。", "problem": "考虑一个二维平行束计算机断层扫描（CT）装置，其中投影数据（也称为正弦图）是为每个角度和探测器坐标定义的，即空间变化的线性衰减系数沿穿过物体的直线的线积分。设物体占据方形区域 $\\Omega = [0, 20] \\times [0, 20]$，单位为毫米，该区域被直线 $x = 10$ 和 $y = 10$ 划分为一个均匀的 $2 \\times 2$ 网格。假设一个分段常数衰减模型：左上方的体素 $(0 \\leq x \\leq 10, 10 \\leq y \\leq 20)$ 的衰减系数为 $\\mu_{1} = 2.0 \\times 10^{-2}\\ \\text{mm}^{-1}$，右下方的体素 $(10 \\leq x \\leq 20, 0 \\leq y \\leq 10)$ 的衰减系数为 $\\mu_{2} = 3.0 \\times 10^{-2}\\ \\text{mm}^{-1}$，另外两个体素的衰减系数为 $0$。\n\n考虑一条由角度 $\\theta = \\pi/4$（单位为弧度）和探测器坐标 $t = 10 \\sqrt{2}$（单位为毫米）表征的单一平行束射线，因此该射线由满足 $x \\cos \\theta + y \\sin \\theta = t$ 的点 $(x, y)$ 组成，并贯穿整个物体。从比尔-朗伯定律和正弦图定义为沿射线的衰减系数的线积分出发，并使用分段常数体素模型，推导测量-体素系数 $a_{ij}$（对于由 $i$ 索引的单个测量和由 $j$ 索引的每个体素），用在这个 $2 \\times 2$ 网格上通过几何射线-盒相交计算出的射线-体素相交长度来表示。\n\n然后，使用您为这条特定射线推导出的 $a_{ij}$ 值和给定的衰减系数，计算这条单一射线的投影 $p$ 的数值。将 $p$ 视为无量纲。将您的最终数值 $p$ 四舍五入到四位有效数字，并以无量纲数的形式报告结果。", "solution": "该问题定义明确，并以计算机断层扫描的原理为科学依据。我们可以开始求解。\n\n透射断层扫描的基本原理是比尔-朗伯定律，该定律描述了辐射穿过材料时的衰减。构成正弦图的投影数据 $p$，被定义为空间变化的线性衰减系数 $\\mu(x, y)$ 沿着给定X射线束路径的线积分。对于由其角度 $\\theta$ 和其到原点的垂直距离 $t$ 定义的单条射线 $L_i$，投影测量值 $p_i$ 由下式给出：\n$$ p_i = \\int_{L_i} \\mu(x, y) \\, ds $$\n其中 $ds$ 是沿射线路径的微分弧长。\n\n问题指定了一个分段常数衰减模型，其中物体区域被划分为有限数量的体素，每个体素具有恒定的衰减系数。设物体被分为 $N$ 个体素，并设 $\\mu_j$ 是第 $j$ 个体素的恒定衰减系数。该积分可以重写为对体素的求和：\n$$ p_i = \\sum_{j=1}^{N} \\int_{L_i \\cap V_j} \\mu_j \\, ds $$\n其中 $V_j$ 是第 $j$ 个体素的区域。由于 $\\mu_j$ 在每个体素内是常数，因此可以将其从积分中提出：\n$$ p_i = \\sum_{j=1}^{N} \\mu_j \\int_{L_i \\cap V_j} ds $$\n剩下的积分 $\\int_{L_i \\cap V_j} ds$ 就是射线 $L_i$ 与体素 $V_j$ 相交部分的长度。我们用 $a_{ij}$ 表示这个长度。\n$$ a_{ij} = \\text{length}(L_i \\cap V_j) $$\n因此，投影的方程呈现代数形式：\n$$ p_i = \\sum_{j=1}^{N} a_{ij} \\mu_j $$\n系数 $a_{ij}$ 是问题提示中要求的“测量-体素系数”。它表示体素 $j$ 对射线 $i$ 的测量的几何贡献。\n\n任务是首先为特定射线和给定的体素网格找到系数 $a_{ij}$，然后计算投影值 $p$。\n\n物体区域为 $\\Omega = [0, 20] \\times [0, 20]$，由直线 $x=10$ 和 $y=10$ 划分为一个 $2 \\times 2$ 网格。这定义了四个方形体素，每个尺寸为 $10 \\, \\text{mm} \\times 10 \\, \\text{mm}$。我们将这些体素标记如下：\n1.  体素 $1$（左上）：$V_1 = [0, 10] \\times [10, 20]$，其 $\\mu_1 = 2.0 \\times 10^{-2} \\, \\text{mm}^{-1}$。\n2.  体素 $2$（右下）：$V_2 = [10, 20] \\times [0, 10]$，其 $\\mu_2 = 3.0 \\times 10^{-2} \\, \\text{mm}^{-1}$。\n3.  体素 $3$（右上）：$V_3 = [10, 20] \\times [10, 20]$，其 $\\mu_3 = 0$。\n4.  体素 $4$（左下）：$V_4 = [0, 10] \\times [0, 10]$，其 $\\mu_4 = 0$。\n\n单条射线的特征是角度 $\\theta = \\pi/4$ 和探测器坐标 $t = 10\\sqrt{2}$。与该射线对应的直线方程为 $x \\cos\\theta + y \\sin\\theta = t$。\n代入给定值：\n$$ x \\cos(\\frac{\\pi}{4}) + y \\sin(\\frac{\\pi}{4}) = 10\\sqrt{2} $$\n$$ x \\left(\\frac{\\sqrt{2}}{2}\\right) + y \\left(\\frac{\\sqrt{2}}{2}\\right) = 10\\sqrt{2} $$\n两边同乘以 $2/\\sqrt{2}$，得到简化的直线方程：\n$$ x + y = 20 \\quad \\text{或} \\quad y = 20 - x $$\n\n现在，我们计算这条射线（我们将其索引为 $i=1$）与四个体素中每一个的相交长度。这些长度就是系数 $a_{1j}$。\n\n对于体素1（左上, $V_1 = [0, 10] \\times [10, 20]$）：\n该体素的边界为 $x=0$, $x=10$, $y=10$ 和 $y=20$。我们求射线 $y = 20 - x$ 与这些边界的交点。\n- 在 $x=0$ 处，$y=20$。该点是 $(0, 20)$。这是体素的一个角点。\n- 在 $x=10$ 处，$y=10$。该点是 $(10, 10)$。这是体素的另一个角点。\n该体素内的射线段经过这两个点。该线段的长度是：\n$$ a_{11} = \\sqrt{(10-0)^2 + (10-20)^2} = \\sqrt{10^2 + (-10)^2} = \\sqrt{100+100} = \\sqrt{200} = 10\\sqrt{2} \\, \\text{mm} $$\n\n对于体素2（右下, $V_2 = [10, 20] \\times [0, 10]$）：\n边界为 $x=10$, $x=20$, $y=0$ 和 $y=10$。\n- 在 $x=10$ 处，$y=20-10=10$。该点是 $(10, 10)$。\n- 在 $x=20$ 处，$y=20-20=0$。该点是 $(20, 0)$。\n该体素内的射线段经过 $(10, 10)$ 和 $(20, 0)$。其长度是：\n$$ a_{12} = \\sqrt{(20-10)^2 + (0-10)^2} = \\sqrt{10^2 + (-10)^2} = \\sqrt{100+100} = \\sqrt{200} = 10\\sqrt{2} \\, \\text{mm} $$\n\n对于体素3（右上, $V_3 = [10, 20] \\times [10, 20]$）：\n对于该体素 $x$ 范围内（$x \\in [10, 20]$）的射线上任意一点，对应的 $y$ 值为 $y = 20 - x$，其范围从 $y=10$（在 $x=10$ 处）到 $y=0$（在 $x=20$ 处）。该体素区域要求 $y \\in [10, 20]$。唯一的交点是 $(10, 10)$。由于交点是单个点，其长度为零。\n$$ a_{13} = 0 \\, \\text{mm} $$\n\n对于体素4（左下, $V_4 = [0, 10] \\times [0, 10]$）：\n对于该体素 $x$ 范围内（$x \\in [0, 10]$）的射线上任意一点，对应的 $y$ 值为 $y=20-x$，其范围从 $y=20$（在 $x=0$ 处）到 $y=10$（在 $x=10$ 处）。该体素区域要求 $y \\in [0, 10]$。唯一的交点是 $(10, 10)$。相交长度为零。\n$$ a_{14} = 0 \\, \\text{mm} $$\n\n推导出的测量-体素系数 $a_{1j}$ 为：\n$a_{11} = 10\\sqrt{2}$, $a_{12} = 10\\sqrt{2}$, $a_{13} = 0$, $a_{14} = 0$。\n\n现在我们计算这条单一射线的投影 $p$ 的数值。令 $p$ 表示 $p_1$。\n$$ p = a_{11}\\mu_1 + a_{12}\\mu_2 + a_{13}\\mu_3 + a_{14}\\mu_4 $$\n代入 $a_{1j}$ 和 $\\mu_j$ 的值：\n$$ p = (10\\sqrt{2} \\, \\text{mm})(2.0 \\times 10^{-2} \\, \\text{mm}^{-1}) + (10\\sqrt{2} \\, \\text{mm})(3.0 \\times 10^{-2} \\, \\text{mm}^{-1}) + (0)(0) + (0)(0) $$\n单位 $\\text{mm}$ 和 $\\text{mm}^{-1}$ 相消，得到一个无量纲的结果，符合要求。\n$$ p = 10\\sqrt{2} \\cdot (2.0 \\times 10^{-2} + 3.0 \\times 10^{-2}) $$\n$$ p = 10\\sqrt{2} \\cdot (5.0 \\times 10^{-2}) $$\n$$ p = 10\\sqrt{2} \\cdot (0.05) $$\n$$ p = 0.5\\sqrt{2} $$\n\n最后，我们计算数值并四舍五入到四位有效数字。\n$$ \\sqrt{2} \\approx 1.41421356... $$\n$$ p \\approx 0.5 \\times 1.41421356 = 0.70710678... $$\n四舍五入到四位有效数字，我们得到：\n$$ p \\approx 0.7071 $$", "answer": "$$\\boxed{0.7071}$$", "id": "4924309"}, {"introduction": "正弦图与其所代表的物体之间存在着一种迷人的几何关系。本练习 [@problem_id:4924358] 旨在探究其中最基本的一种关系：一个单独的点状物体如何在正弦图中被变换成一条完美的正弦曲线。理解这一原理对于直观地解读正弦图和掌握线性叠加的概念至关重要。", "problem": "在平行束计算机断层扫描（CT）系统中，角度为 $\\theta$ 时衰减分布 $\\mu(x,y)$ 的线积分投影由二维Radon变换表示\n$$\np(s,\\theta)=\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}\\mu(x,y)\\,\\delta\\!\\big(s - x\\cos\\theta - y\\sin\\theta\\big)\\,dx\\,dy,\n$$\n其中 $s$ 是线到原点的有符号距离，$\\delta(\\cdot)$ 是狄拉克δ函数。考虑一个物体，其包含两个相同的点吸收体，具有相等的衰减强度 $A>0$，分别位于 $(x,y)=(d,0)$ 和 $(x,y)=(-d,0)$，其中 $d>0$。将该物体建模为\n$$\n\\mu(x,y)=A\\,\\delta(x-d)\\,\\delta(y)+A\\,\\delta(x+d)\\,\\delta(y).\n$$\n从上面Radon变换的定义和狄拉克δ函数的基本性质出发，推导由这些吸收体在 $(s,\\theta)$ 平面上产生的两个正弦图轨迹的方程。然后，确定所有角度 $\\theta\\in[0,\\pi)$（以弧度为单位），在这些角度下，两个轨迹在相同的 $s$ 值处重合，从而它们对 $p(s,\\theta)$ 的贡献在相同的 $s$ 位置上重叠。说明当 $A>0$ 时，这种重叠是相加的还是抵消的，并根据Radon变换所蕴含的线性叠加原理解释原因。\n\n请提供两个轨迹重合时在 $[0,\\pi)$ 区间内的唯一角度（以弧度为单位）作为您的最终答案。无需四舍五入。", "solution": "该问题在科学上是合理的，因为它基于计算机断层扫描的标准原理，并且问题设定明确、客观。我们可以按要求进行推导。\n\n首先，雷登变换是一个线性积分变换。这意味着物体的雷登变换等于其各个组成部分雷登变换之和。因此，我们可以分别计算位于 $(d,0)$ 和 $(-d,0)$ 的两个点吸收体的投影，然后将它们相加。\n\n对于位于 $(d,0)$ 的第一个点吸收体，其衰减分布为 $\\mu_1(x,y) = A\\,\\delta(x-d)\\,\\delta(y)$。其投影 $p_1(s,\\theta)$ 为：\n$$\np_1(s,\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} A\\,\\delta(x-d)\\,\\delta(y)\\,\\delta(s - x\\cos\\theta - y\\sin\\theta)\\,dx\\,dy\n$$\n利用狄拉克δ函数的筛选性质，对 $x$ 和 $y$ 进行积分，我们得到：\n$$\np_1(s,\\theta) = A\\,\\delta(s - d\\cos\\theta - 0\\cdot\\sin\\theta) = A\\,\\delta(s - d\\cos\\theta)\n$$\n这个结果表明，对于给定的角度 $\\theta$，投影值只在 $s = d\\cos\\theta$ 处非零。因此，第一个点吸收体在正弦图上产生的轨迹方程是 $s = d\\cos\\theta$。\n\n类似地，对于位于 $(-d,0)$ 的第二个点吸收体，其衰减分布为 $\\mu_2(x,y) = A\\,\\delta(x+d)\\,\\delta(y)$。其投影 $p_2(s,\\theta)$ 为：\n$$\np_2(s,\\theta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} A\\,\\delta(x+d)\\,\\delta(y)\\,\\delta(s - x\\cos\\theta - y\\sin\\theta)\\,dx\\,dy\n$$\n积分后得到：\n$$\np_2(s,\\theta) = A\\,\\delta(s - (-d)\\cos\\theta - 0\\cdot\\sin\\theta) = A\\,\\delta(s + d\\cos\\theta)\n$$\n因此，第二个点吸收体产生的轨迹方程是 $s = -d\\cos\\theta$。\n\n两个轨迹在正弦图上重合，意味着在相同的角度 $\\theta$ 下，它们的 $s$ 值相等。因此，我们令两个轨迹方程相等：\n$$\nd\\cos\\theta = -d\\cos\\theta\n$$\n$$\n2d\\cos\\theta = 0\n$$\n因为题目给定 $d > 0$，所以必须有：\n$$\n\\cos\\theta = 0\n$$\n在区间 $\\theta \\in [0, \\pi)$ 内，满足此条件的唯一角度是 $\\theta = \\frac{\\pi}{2}$。\n\n为了理解重叠的性质，我们考察在 $\\theta = \\frac{\\pi}{2}$ 时的总投影 $p(s, \\theta) = p_1(s, \\theta) + p_2(s, \\theta)$。\n$$\np(s, \\frac{\\pi}{2}) = A\\,\\delta(s - d\\cos(\\frac{\\pi}{2})) + A\\,\\delta(s + d\\cos(\\frac{\\pi}{2}))\n$$\n$$\np(s, \\frac{\\pi}{2}) = A\\,\\delta(s - 0) + A\\,\\delta(s + 0) = A\\,\\delta(s) + A\\,\\delta(s) = 2A\\,\\delta(s)\n$$\n由于 $A > 0$，在 $\\theta = \\frac{\\pi}{2}$ 时，两个点吸收体的投影都在 $s=0$ 处产生一个强度为 $A$ 的脉冲。这两个脉冲在相同的位置重叠，它们的强度相加，产生一个强度为 $2A$ 的脉冲。因此，这种重叠是相加的（或称建设性的）。这直接体现了雷登变换的线性叠加原理：总投影是各个部分投影的和。", "answer": "$$\\boxed{\\frac{\\pi}{2}}$$", "id": "4924358"}, {"introduction": "CT扫描仪无法扫描无限大的物体，其物理尺寸决定了有限的扫描视场（Field of View, FOV）。这一实际限制直接转化为了对正弦图数据的约束。本练习 [@problem_id:4924319] 运用基本几何学原理，来确定物体尺寸如何限制正弦图空间坐标 $s$ 的范围，从而在物理扫描仪设计与采集数据的结构之间建立了关键的联系。", "problem": "考虑一个二维（2D）平行束X射线计算机断層扫描（CT）系统，该系统采集物体的线积分。物体支撑是一个以成像平面原点为中心、半径为 $R$ 的圆形视场（FOV）。在平行束正弦图表示中，每条射线都由一个方向角 $\\theta$（以弧度为单位）和距离原点的有符号距离 $s$ 来索引。积分线被定义为在偏移量为 $s$ 处，与方向 $(\\cos\\theta,\\sin\\theta)$ 正交的直线上所有点 $(x,y)$ 的集合。\n\n仅从基本几何定义出发，即角度为 $\\theta$、偏移量为 $s$ 的平行束投影射线是平面上的一条直线，且物体支撑是闭合圆盘 $\\{(x,y): x^{2}+y^{2}\\le R^{2}\\}$，请使用第一性原理来：\n\n- 推导该直线与圆盘相交的弦长关于 $R$ 和 $s$ 的表达式，并解释为什么存在实数且非负的弦长会对 $s$ 施加一个与 $\\theta$ 无关的界限。\n- 使用您的几何推导，确定能使相应射线与FOV相交的 $s$ 的最大允许幅值。\n\n将您的最终结果报告为仅含 $R$ 的单个闭式解析表达式，表示 $s$ 的最大允许幅值。将您的最终答案表示为 $R$ 的函数（单位与 $R$ 相同）。不需要进行数值四舍五入。", "solution": "该问题经验证具有科学依据、提法明确、客观且完整。这是计算机断层扫描（CT）背景下的一个基本几何问题，基于标准定义。可以按要求从第一性原理进行推导。\n\n物体支撑是一个以原点为中心、半径为 $R$ 的闭合圆盘。该圆盘的边界是一个圆，其方程为：\n$$x^2 + y^2 = R^2$$\n\n一条投影射线由其方向角 $\\theta$ 和距离原点的有符号距离 $s$ 定义。该射线是与单位向量 $\\hat{n} = (\\cos\\theta, \\sin\\theta)$ 正交的直线。对于该直线上的任意点 $(x,y)$，其位置向量 $\\vec{r} = (x,y)$ 在法向量 $\\hat{n}$ 上的投影等于有符号距离 $s$。这种几何关系通过点积表示为：\n$$\\vec{r} \\cdot \\hat{n} = s$$\n代入各分量，我们得到该直线的方程：\n$$x\\cos\\theta + y\\sin\\theta = s$$\n\n为了求出该直线与圆形视场（FOV）相交的弦长，我们必须找到该直线与圆 $x^2 + y^2 = R^2$ 之间的两个交点。直接的代数求解是可能的，但很繁琐。一种更优雅且富有洞察力的方法是旋转坐标系。\n\n由于圆的旋转对称性，相交弦的长度仅取决于直线到中心的距离 $s$，而与其方向 $\\theta$ 无关。我们可以通过将笛卡尔坐标系旋转 $-\\theta$ 角度来简化问题，定义一个新的坐标系 $(x', y')$。变换方程为：\n$$x' = x\\cos\\theta + y\\sin\\theta$$\n$$y' = -x\\sin\\theta + y\\cos\\theta$$\n\n在这个新的 $(x', y')$ 坐标系中：\n1.  直线方程 $x\\cos\\theta + y\\sin\\theta = s$ 简化为：\n    $$x' = s$$\n    这是 $(x', y')$ 平面中的一条垂直线。\n\n2.  圆的方程 $x^2 + y^2 = R^2$ 由于旋转不变性而保持不变：\n    $$(x')^2 + (y')^2 = R^2$$\n\n现在，我们将直线方程 $x' = s$ 代入圆的方程来求交点：\n$$s^2 + (y')^2 = R^2$$\n解出 $y'$，我们得到：\n$$(y')^2 = R^2 - s^2$$\n$$y' = \\pm\\sqrt{R^2 - s^2}$$\n\n在旋转坐标系中，这两个交点（我们称之为 $P'_1$ 和 $P'_2$）是：\n$$P'_1 = (s, \\sqrt{R^2 - s^2})$$\n$$P'_2 = (s, -\\sqrt{R^2 - s^2})$$\n\n弦长 $L$ 是这两点之间的欧几里得距离。由于这两点具有相同的 $x'$ 坐标，距离就是它们 $y'$ 坐标的差值：\n$$L = |y'_1 - y'_2| = |\\sqrt{R^2 - s^2} - (-\\sqrt{R^2 - s^2})|$$\n$$L = |2\\sqrt{R^2 - s^2}|$$\n由于平方根函数表示非负根，绝对值内的参数始终是非负的。因此，弦长的表达式为：\n$$L(R, s) = 2\\sqrt{R^2 - s^2}$$\n\n弦长 $L$ 的这个表达式仅取决于FOV半径 $R$ 和射线偏移量 $s$，并且显著地与角度 $\\theta$ 无关。这回答了问题的第一部分。\n\n接下来，我们必须解释为什么存在实数且非负的弦长会对 $s$ 施加一个与 $\\theta$ 无关的界限。\n为使弦长 $L$ 是一个实数，平方根内的量（被开方数）必须是非负的：\n$$R^2 - s^2 \\ge 0$$\n重新整理这个不等式得到：\n$$R^2 \\ge s^2$$\n对两边取平方根（并回顾 $\\sqrt{a^2} = |a|$），我们得到：\n$$|s| \\le R$$\n这个不等式是存在实数弦长的条件，几何上对应于直线必须与圆相交的条件。弦长根据定义是一个距离，因此它必须是非负的。表达式 $2\\sqrt{R^2 - s^2}$ 在为实数时总是非负的。因此，存在实数且非负弦长的唯一条件是 $|s| \\le R$。由于这个条件是从表达式 $L(R, s) = 2\\sqrt{R^2 - s^2}$ 推导出来的，而该表达式本身与 $\\theta$ 无关，因此 $s$ 的界限也与 $\\theta$ 无关。这是圆形FOV旋转对称性的直接结果。\n\n最后，我们确定使射线与FOV相交的 $s$ 的最大允许幅值。相交的条件是 $|s| \\le R$。$s$ 的幅值是 $|s|$。在满足此不等式的情况下，$|s|$ 能取到的最大值是 $R$。\n$$|s|_{max} = R$$\n当 $|s| = R$ 时，直线与圆形FOV相切，弦长 $L = 2\\sqrt{R^2 - R^2} = 0$，交点为一个点。如果 $|s| > R$，直线根本不与FOV相交，弦长变成一个虚数，这在这种情况下没有物理意义。\n\n因此，$s$ 的最大允许幅值等于FOV的半径 $R$。", "answer": "$$\\boxed{R}$$", "id": "4924319"}]}