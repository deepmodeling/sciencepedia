## 引言
在[计算机断层扫描](@entry_id:747638)（CT）成像中，束流硬化是一种源于其基本物理原理、影响最为普遍的伪影。尽管CT技术取得了巨大进步，但由[X射线源](@entry_id:268482)固有的多能谱特性所引起的[图像失真](@entry_id:171444)，始终是[医学物理学](@entry_id:158232)家和放射科医生面临的核心挑战。这种现象不仅会降低[图像质量](@entry_id:176544)，更重要的是，它会破坏亨氏单位（HU）的定量准确性，可能掩盖病变或产生误导性信息，从而影响临床诊断的可靠性。本文旨在系统性地剖析束流硬化伪影。在“原理与机制”一章中，我们将深入探讨其物理根源，解释多能谱X射线如何导致衰减数据的非线性，并由此产生典型的杯状和条状伪影。接下来，在“应用与交叉学科联系”一章中，我们将考察这些伪影在临床实践中的具体表现和诊断陷阱，并探讨其对金属植入物、多模态成像（如PET/CT）及人工智能应用的影响，同时介绍从硬件到软件的各类先进校正策略。最后，通过“实践练习”部分，读者将有机会通过解决具体问题来巩固所学知识。通过这一结构化的学习路径，本文将为您提供关于CT束流硬化伪影的全面理解。

## 原理与机制

在理想化的[计算机断层扫描](@entry_id:747638)（CT）中，我们假设X射[线束](@entry_id:167936)是**单能的**（monochromatic），即所有光子都具有完全相同的能量。在这种简化模型下，X射线穿过物体时的衰减遵循一个简单的指数关系，即**比尔-兰伯特定律**（Beer-Lambert law）。对于初始强度为 $I_0$ 的单能X射线束，穿过一种[线性衰减](@entry_id:198935)系数为 $\mu$ 的均匀材料，路径长度为 $L$ 后，其透射强度 $I$ 为：

$$I = I_0 \exp(-\mu L)$$

为了进行图像重建，我们首先对测量到的强度进行对数预处理，以计算**投影值**（projection）$p$：

$$p = -\ln\left(\frac{I}{I_0}\right) = -\ln\left(\frac{I_0 \exp(-\mu L)}{I_0}\right) = \mu L$$

这个结果至关重要：在单能假设下，投影值 $p$ 与路径长度 $L$ 和材料的衰减系数 $\mu$ 的乘积成正比。这种线性关系是**滤波反投影**（Filtered Backprojection, FBP）等标准重建算法的根本前提。这些算法旨在从一组线性的投影数据中重建出衰减系数图 $\mu(\mathbf{r})$。

然而，在实际的CT系统中，[X射线源](@entry_id:268482)（如[X射线管](@entry_id:266888)）产生的是**多能谱**（polychromatic spectrum）的X射[线束](@entry_id:167936)，其[光子能量](@entry_id:139314)分布在一个较宽的范围内，记为 $S(E)$。因此，描述透射强度的物理模型必须对所有能量进行积分。对于一种能量依赖性衰减系数为 $\mu(E)$ 的均匀材料，其真实的透射强度 $I(L)$ 为：

$$I(L) = \int S(E) \exp(-\mu(E) L) \, \mathrm{d}E$$

在这种多能谱情况下，对数预处理得到的投影值变为：

$$p(L) = -\ln\left(\frac{I(L)}{I_0}\right) = -\ln\left(\frac{\int S(E) \exp(-\mu(E) L) \, \mathrm{d}E}{\int S(E) \, \mathrm{d}E}\right)$$

由于对数函数和积分运算的顺序不能交换（即 $\ln(\int \cdot) \neq \int \ln(\cdot)$），$p(L)$ 不再是路径长度 $L$ 的线性函数 [@problem_id:4866174]。这种物理现实与重建算法的单能假设之间的根本性不匹配，是**束流硬化伪影**（beam hardening artifacts）的根源 [@problem_id:4866092]。

### 束流硬化的物理机制

在诊断成像所用的能量范围内，所有物质的X射线[线性衰减](@entry_id:198935)系数 $\mu(E)$ 都随光子能量 $E$ 的增加而减小。这意味着低能量光子比高能量光子更容易被吸收。当一束多能谱X射线穿过物体时，低能量光子被优先衰减，导致透射光束中高能量光子的相对比例增加。因此，透射光束的[平均能量](@entry_id:145892)随着穿透深度的增加而提高。这种现象被称为**束流硬化**（beam hardening）[@problem_id:4866125]。

一个“更硬”的光束穿透力更强，其整体衰减效应更弱。为了量化这一效应，我们可以定义一个**有效[线性衰减](@entry_id:198935)系数** $\mu_{\text{eff}}(L)$，使得投影值可以写作 $p(L) = \mu_{\text{eff}}(L) L$。根据 $p(L)$ 的表达式，我们有：

$$\mu_{\text{eff}}(L) = \frac{p(L)}{L} = -\frac{1}{L} \ln\left(\frac{\int S(E) \exp(-\mu(E) L) \, \mathrm{d}E}{\int S(E) \, \mathrm{d}E}\right)$$

由于束流硬化效应，随着路径长度 $L$ 的增加，$\mu_{\text{eff}}(L)$ 会单调递减。我们可以通过一个简化的双能量谱模型来清晰地说明这一点 [@problem_id:4866174]。假设入射谱由两个能量 $E_1$ 和 $E_2$ 组成，对应的光子权重为 $w_1$ 和 $w_2$，衰减系数为 $\mu_1$ 和 $\mu_2$。假设 $\mu_1 > \mu_2$（即 $E_1$ 是较低能量）。投影值 $p(L)$ 是一个关于 $L$ 的凹函数（concave function）[@problem_id:4866142]，其斜率（等效于瞬时衰减系数）随 $L$ 的增加而减小。这种投影数据的非线性直接导致了图像重建中的伪影。

### 束流硬化伪影的主要表现形式

束流硬化导致的投影数据非线性，在重建图像中会以几种典型的方式呈现。

#### 杯状伪影 (Cupping Artifact)

**杯状伪影**是扫描均匀密度物体（如水模）时最典型的束流硬化表现。在一个圆柱形水模中，穿过中心的X射线路径最长，而靠近边缘的路径较短。由于路径最长的中心射线经历了最显著的束流硬化，其有效衰减系数 $\mu_{\text{eff}}(L)$ 是最低的。相反，边缘处的射线路径短，束流硬化程度较轻，其有效衰减系数相对较高。

因此，当FBP算法重建图像时，它会错误地为模体中心赋予一个较低的衰减值，而为边缘赋予较高的衰减值。这导致在一个本应均匀的图像上，中心区域看起来比边缘区域“更暗”（即衰减值更低），在剖面图上呈现出“杯状”或“碟状”的凹陷形态 [@problem_id:4866146] [@problem_id:4866125]。

这种效应也直接影响了临床上广泛使用的**亨氏单位**（Hounsfield Units, HU）。HU的定义为 $HU = 1000 \times (\mu - \mu_w)/\mu_w$，其中 $\mu_w$ 是水的衰减系数。由于束流硬化，重建出的衰减系数 $\mu_{\text{rec}}$ 依赖于物体的尺寸和射线的路径长度。即使CT系统经过校准，使得特定尺寸的水模中心HU值为0，但对于不同尺寸的物体，或在同一物体的不同位置，水的H[U值](@entry_id:151629)也会偏离0。这导致了定量的HU值测量存在依赖于尺寸的偏差 [@problem_id:4866147]。

#### 高密度物质间的条状伪影 (Streak Artifacts)

当扫描区域中存在两种或多种高密度物质（如颅底的骨骼、金属植入物）时，束流硬化会引起它们之间出现暗色的**条状或带状伪影**。

其机制源于不同射线路径经历的**差异化束流硬化**（differential beam hardening）。考虑一组穿过两个高密度物体的射线 [@problem_id:4866151]：
1.  穿过两个物体的射线：这条射线的路径上有很长一段是高衰减物质，因此它经历了极端的束流硬化。其测量到的投影值 $p$ 会远低于一个线性模型所预测的值。
2.  仅穿过一个物体的射线：这条射线硬化程度中等。
3.  未穿过任何高密度物体的射线：这条射线硬化程度最轻。

这种情况下，投影数据集（即[正弦图](@entry_id:754926)）变得“不一致”（inconsistent），因为它不再能代表任何一个单一的物理衰减系数分布的线积分 [@problem_id:4866131]。特别是，穿过两个物体的射线的投影值相对于邻近射线来说显得异常低。在FBP的“反投影”步骤中，这个负向的误差会被涂抹回图像空间，沿着这条射线的路径形成一条暗带。同时，在这些高密度物体的边缘，那些“擦边而过”的射线由于其硬化程度与[校准模型](@entry_id:180554)不符，可能被过度校正，从而在暗带旁边形成明亮的条纹 [@problem_id:4866151]。

需要强调的是，束流硬化伪影的物理根源在于[X射线谱](@entry_id:169711)和物质的能量依赖性相互作用，这与**环状伪影**（ring artifacts，通常由探测器单元的标定错误引起）和**散射伪影**（scatter artifacts，由不符合直线路径假设的散射光子引起）有本质区别 [@problem_id:4866092]。

### 影响束流硬化严重程度的因素

#### 物质组分

束流硬化的严重程度与构成物体的材料的[原子序数](@entry_id:139400)和密度密切相关。X射线与物质的相互作用主要通过**光电效应**（photoelectric effect）和**[康普顿散射](@entry_id:150648)**（Compton scattering）发生。光电效应的发生概率与[原子序数](@entry_id:139400)的三次方 ($Z^3$) 和能量的负三次方 ($E^{-3}$) 近似成正比，具有极强的能量依赖性。而[康普顿散射](@entry_id:150648)的能量依赖性则弱得多。

因此，我们可以将任何材料的衰减系数模型化为这两个物理效应的[线性组合](@entry_id:155091) [@problem_id:4866179]：
$$\mu(E, \mathbf{r}) = a(\mathbf{r}) f_{\text{pe}}(E) + b(\mathbf{r}) f_{\text{Compton}}(E)$$
其中 $a(\mathbf{r})$ 和 $b(\mathbf{r})$ 分别代表[光电效应](@entry_id:162802)和[康普顿散射](@entry_id:150648)在空间位置 $\mathbf{r}$ 的贡献权重。

高[原子序数](@entry_id:139400)的材料（如骨骼中的钙、碘造影剂）具有显著的[光电效应](@entry_id:162802)贡献（即较大的 $a(\mathbf{r})$ 值）。当X射线穿过这些材料时，由于[光电效应](@entry_id:162802)的强烈能量选择性，会发生非常剧烈的束流硬化。这就是为什么束流硬化伪影在包含骨骼、金属或造影剂增强区域的扫描中尤为突出的原因 [@problem_id:4866179]。

#### 几何构型

与二维的扇束CT（fan-beam CT）相比，三维的锥形束CT（cone-beam CT, CBCT）会加剧束流硬化伪影 [@problem_id:4866142]。这是因为在CBCT中，偏离中心平面的“锥形”射线以一个倾斜的角度穿过物体。对于一个圆柱形物体，这些斜向射线的路径长度比中心平面内的射线更长。更长的路径意味着更严重的束流硬化。

由于路径长度和硬化程度在整个锥形束覆盖的二维探测器平面上（即同时依赖于探测器行列位置）都在变化，这导致了一个复杂的三维空间变化的[有效能](@entry_id:139794)量分布。标准的二维束流硬化校正算法往往难以完全处理这种复杂的空间不一致性，从而在CBCT图像中（尤其是在轴向）留下残余的杯状和条状伪影 [@problem_id:4866142]。

### 伪影的抑制与校正策略

鉴于束流硬化伪影的普遍性，多种技术被开发出来以减轻或校正其影响。这些方法可分为硬件抑制和软件校正两大类。

#### 硬件抑制方法

硬件层面的抑制策略旨在使入射的X射线束“行为”上更接近单能。

*   **增加管电压（kVp）**：提高[X射线管](@entry_id:266888)的电压会使整个能谱向更高能量移动，使得光束本身就“更硬”，相对能[谱宽](@entry_id:176022)度变窄，从而减轻束流硬化效应 [@problem_id:4866125]。

*   **滤过（Filtration）**：在[X射线源](@entry_id:268482)和患者之间放置一块金属薄片（通常是铝或铜），即**平板滤过板**（flat filter），可以“预硬化”（pre-harden）光束。滤过板会优先吸收低能量光子，使得进入患者的[X射线谱](@entry_id:169711)更窄、平均能量更高。这种预硬化的光束在穿过患者时，其平均能量的变化会减小，从而使投影数据的非线性程度降低，减轻杯状伪影。然而，这种方法的代价是总[光子通量](@entry_id:164816)的降低，在保持管电流不变的情况下会导致图像噪声增加 [@problem_id:4866156]。

*   **弓形滤过板（Bowtie Filter）**：这是一种形状特殊的滤过板，中心薄而边缘厚。其主要目的是根据人体[横截面](@entry_id:143872)（通常中间厚、两侧薄）的形状来预先调整[光子通量](@entry_id:164816)，使得到达探测器的光子分布更均匀，同时减少患者外周部位的辐射剂量。弓形滤过板通过在不同角度上施加不同的预硬化，也在一定程度上使穿过患者后的光束硬化程度更趋一致。但如果设计不当或与患者体型不匹配（例如，过度补偿），可能会与全局的软件校正算法相互作用，产生反向的“盖状伪影”（capping artifact），即图像边缘比中心显得更亮 [@problem_id:4866156]。

#### 软件校正方法

软件校正方法在数据处理层面解决问题。

*   **线性化校正**：这是最常见的方法之一，它基于对典型组织的测量数据，建立一个从测量的非线性投影值到理想化的线性投影值的映射（通常是一个多项式函数）。这种方法对于校正均匀组织中的杯状伪影效果较好，但对于处理由多种材料引起的复杂条状伪影能力有限。

*   **基于模型的迭代重建（Iterative Reconstruction）**：与依赖FBP的线性假设不同，先进的迭代重建算法可以在其系统模型中直接包含多能谱X射线衰减的物理过程。通过迭代优化，这些算法能够找到一个既符合测量数据（包括其非线性特性）又满足图像先验约束（如平滑度）的解，从而更有效地抑制伪影。

*   **双能/能谱CT（Dual-Energy/Spectral CT）**：这是从根本上解决束流硬化问题的最有效方法。通过使用两种不同的X射线能谱进行扫描，或者使用能够分辨光子能量的**光子计数探测器**（photon-counting detector），系统可以为每条射线路径获取至少两个独立的测量值。利用不同材料（如软组织和骨骼）的衰减特性在不同能量下有不同表现的特点，可以精确地将测量数据分解为一组基物质（如水和钙）的等效路径长度 [@problem_id:4866098] [@problem_id:4866179]。由于这些基物质的路径长度是线性可加的，因此可以重建出完全没有束流硬化伪影的基[物质密度](@entry_id:263043)图，并从中合成任意单能下的虚拟单能图像 [@problem_id:4866131]。