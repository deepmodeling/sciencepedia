{"hands_on_practices": [{"introduction": "生存分析的第一步通常是将生存数据可视化。Kaplan-Meier (K-M) 估计量是实现这一目标的标准非参数方法。本练习将引导您从原始数据集开始，一步步构建K-M曲线，从而深入理解如何处理删失数据以及如何计算生存概率[@problem_id:4562449]。", "problem": "一项放射组学研究调查了一个通过高风险影像学特征筛选出的队列的总生存期。对于每个个体，记录了以月为单位的观测时间，以及一个指示事件（死亡）是否发生或观测是否被删失的指示符。数据集（有序对 $\\left(t_i,\\delta_i\\right)$，其中 $t_i$ 以月为单位，$\\delta_i \\in \\{0,1\\}$，$\\delta_i=1$ 表示事件发生，$\\delta_i=0$ 表示删失）如下：\n- $(2,1)$，\n- $(3,0)$，\n- $(3,0)$，\n- $(4,1)$，\n- $(5,0)$，\n- $(6,1)$，\n- $(7,0)$，\n- $(8,1)$，\n- $(9,1)$，\n- $(10,0)$，\n- $(10,1)$，\n- $(12,0)$。\n\n从生存分析的基本原理出发——即生存函数 $S(t)=\\Pr(Tt)$ 的定义，以及将生存概率表示为按序排列的不同事件时间所定义的连续区间上的条件生存概率的乘积——请为该数据集逐步构建Kaplan-Meier（乘积极限）估计量。在您的构建过程中，请明确处理没有事件发生的时间（纯删失时间）以及事件和删失同时发生的时间。对生存阶梯函数使用右连续约定（即，在事件时间点发生骤降）。\n\n在右连续约定下，当 $t=9$ 个月时，Kaplan-Meier 估计值 $\\hat{S}(t)$ 的精确值是多少？请将您的最终答案表示为一个不带单位的最简分数，不要四舍五入。最终答案中只需提供最终数值，无需提供中间步骤。", "solution": "Kaplan-Meier估计量 $\\hat{S}(t)$ 是通过在每个事件时间点计算条件生存概率并将其连乘得到的。其公式为：\n$$ \\hat{S}(t) = \\prod_{i: t_i \\le t} \\left(1 - \\frac{d_i}{n_i}\\right) $$\n其中，$t_i$ 是不同的事件时间，$d_i$ 是在时间 $t_i$ 发生事件的个体数，$n_i$ 是在时间 $t_i$ 之前瞬间处于风险中的个体数。\n\n首先，我们按时间顺序整理所有观测数据，并识别出不同的事件时间点：$t=2, 4, 6, 8, 9, 10$。\n\n我们逐步计算生存概率：\n1.  **初始状态 ($t=0$)**: 研究开始时，所有12名个体都处于风险中，因此 $n=12$。$\\hat{S}(0)=1$。\n\n2.  **时间 $t=2$ (事件)**:\n    - 风险集 $n_1=12$。\n    - 事件数 $d_1=1$。\n    - 生存概率 $\\hat{S}(2) = \\hat{S}(0) \\times \\left(1 - \\frac{d_1}{n_1}\\right) = 1 \\times \\left(1 - \\frac{1}{12}\\right) = \\frac{11}{12}$。\n\n3.  **时间 $t=3$ (删失)**: 两个个体在时间3被删失。没有事件发生，因此生存曲线保持不变。但在计算下一个事件时间点的风险集时，需要将他们移除。\n\n4.  **时间 $t=4$ (事件)**:\n    - 风险集 $n_2 = 12 - 1 (\\text{事件于} t=2) - 2 (\\text{删失于} t=3) = 9$。\n    - 事件数 $d_2=1$。\n    - 生存概率 $\\hat{S}(4) = \\hat{S}(2) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = \\frac{11}{12} \\times \\left(1 - \\frac{1}{9}\\right) = \\frac{11}{12} \\times \\frac{8}{9} = \\frac{88}{108} = \\frac{22}{27}$。\n\n5.  **时间 $t=5$ (删失)**: 一个个体在时间5被删失。\n\n6.  **时间 $t=6$ (事件)**:\n    - 风险集 $n_3 = 9 - 1 (\\text{事件于} t=4) - 1 (\\text{删失于} t=5) = 7$。\n    - 事件数 $d_3=1$。\n    - 生存概率 $\\hat{S}(6) = \\hat{S}(4) \\times \\left(1 - \\frac{d_3}{n_3}\\right) = \\frac{22}{27} \\times \\left(1 - \\frac{1}{7}\\right) = \\frac{22}{27} \\times \\frac{6}{7} = \\frac{132}{189} = \\frac{44}{63}$。\n\n7.  **时间 $t=7$ (删失)**: 一个个体在时间7被删失。\n\n8.  **时间 $t=8$ (事件)**:\n    - 风险集 $n_4 = 7 - 1 (\\text{事件于} t=6) - 1 (\\text{删失于} t=7) = 5$。\n    - 事件数 $d_4=1$。\n    - 生存概率 $\\hat{S}(8) = \\hat{S}(6) \\times \\left(1 - \\frac{d_4}{n_4}\\right) = \\frac{44}{63} \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{44}{63} \\times \\frac{4}{5} = \\frac{176}{315}$。\n\n9.  **时间 $t=9$ (事件)**:\n    - 风险集 $n_5 = 5 - 1 (\\text{事件于} t=8) = 4$。\n    - 事件数 $d_5=1$。\n    - 生存概率 $\\hat{S}(9) = \\hat{S}(8) \\times \\left(1 - \\frac{d_5}{n_5}\\right) = \\frac{176}{315} \\times \\left(1 - \\frac{1}{4}\\right) = \\frac{176}{315} \\times \\frac{3}{4} = \\frac{44}{105}$。\n\n根据右连续约定，在时间 $t=9$ 个月时的Kaplan-Meier估计值 $\\hat{S}(9)$ 是在 $t=9$ 事件发生后的生存概率。因此，$\\hat{S}(9) = \\frac{44}{105}$。", "answer": "$$\\boxed{\\frac{44}{105}}$$", "id": "4562449"}, {"introduction": "学会了如何创建K-M曲线后，一个自然而然的问题是：两组或多组的生存经验是否存在统计学上的显著差异？本练习将介绍对数秩检验 (log-rank test)，这是进行此类比较最常用的方法。通过从第一性原理计算检验统计量，您将理解该检验如何在“无差异”的原假设下，比较每个事件时间点的观测事件数与期望事件数[@problem_id:4562464]。", "problem": "一项放射组学研究根据治疗前磁共振成像的放射组学特征，将胶质母细胞瘤患者分为两个队列：高风险组（第$1$组）和低风险组（第$2$组）。无进展生存时间以月为单位。事件为影像学进展；否则，观测值因失访或研究结束而右删失。假设删失是独立的、非信息性的，并且在任何同时发生事件和删失的日历时间点，该时间点的所有事件都恰好发生在该时间点的任何删失之前。数据如下：\n\n第$1$组（高风险）：$(2,1)$, $(3,1)$, $(4,0)$, $(5,1)$, $(6,0)$, $(7,1)$, $(8,0)$, $(9,1)$\n\n第$2$组（低风险）：$(2,0)$, $(3,1)$, $(4,1)$, $(5,0)$, $(6,1)$, $(7,0)$, $(8,1)$, $(10,0)$\n\n每对$(t, \\delta)$表示随访时间$t$和指示符$\\delta$，其中$\\delta=1$表示事件，$\\delta=0$表示右删失。\n\n在两组风险函数相等的零假设下，从生存分析的基本原理出发，按以下步骤进行。\n\n1) 在每个不同的事件时间$t_j$，将在$t_j$之前瞬间的风险集定义为第$1$组中有$n_{1j}$个个体处于风险中，第$2$组中有$n_{2j}$个个体处于风险中，其中$n_j=n_{1j}+n_{2j}$。令$d_j$为在$t_j$时事件的总数，$d_{1j}$为这些事件中发生在第$1$组的数量。利用置换零假设（风险相等），并以风险集和$t_j$时的事件总数为条件，建立$d_{1j}$的分布模型，并推导其在每个$t_j$时的期望和方差表达式。\n\n2) 使用这些结果，将对数秩得分统计量$U$构造为在所有不同事件时间上，观测到的第$1$组事件数与期望的第$1$组事件数之差的总和；并将其方差$V$构造为在所有事件时间上条件方差的总和，其中包括因无放回抽样而产生的有限总体校正。\n\n3) 使用你推导的表达式，为给定数据计算对数秩卡方统计量$X^2 = U^2/V$。将最终数值答案四舍五入至四位有效数字。不需要单位。\n\n4) 简要解释为什么方差中会出现小样本调整，以及它与基于独立抽样的大样本近似有何不同。\n\n仅提供$X^2$的单一数值作为最终答案，并按要求四舍五入。", "solution": "在零假设下，即第$1$组和第$2$组的风险函数在所有时间都相等，那么在任一不同事件时间$t_j$，任何给定事件发生在第$1$组的概率与第$1$组当前处于风险中的个体数量成正比。以$t_j$时处于风险中的总个体数和$t_j$时的事件总数$d_j$为条件，随机变量$d_{1j}$（即$t_j$时第$1$组的事件数）遵循超几何分布。具体来说，在$t_j$时，在一个大小为$n_j$的有限总体中，有$n_{1j}$个潜在的“成功”（第$1$组的个体），并且从中无放回地抽取$d_j$次（事件）。因此，\n$$\nd_{1j} \\sim \\text{Hypergeometric}\\left(N=n_j, K=n_{1j}, \\text{draws}=d_j\\right).\n$$\n对于具有上述参数的超几何随机变量，其条件期望和方差是众所周知的：\n$$\n\\mathbb{E}[d_{1j}\\mid n_{1j},n_{2j},d_j] = d_j \\frac{n_{1j}}{n_j},\n$$\n$$\n\\operatorname{Var}(d_{1j}\\mid n_{1j},n_{2j},d_j) = d_j \\frac{n_{1j}}{n_j}\\left(1-\\frac{n_{1j}}{n_j}\\right)\\frac{n_j-d_j}{n_j-1}\n= \\frac{n_{1j}n_{2j}d_j(n_j-d_j)}{n_j^2(n_j-1)}.\n$$\n\n对数秩得分统计量$U$通过对所有不同事件时间$\\{t_j\\}$求和来构造，求和项为观测到的第$1$组事件数减去期望的第$1$组事件数：\n$$\nU = \\sum_{j} \\left(d_{1j} - \\mathbb{E}[d_{1j}\\mid n_{1j},n_{2j},d_j]\\right)\n= \\sum_{j} \\left(d_{1j} - d_j \\frac{n_{1j}}{n_j}\\right).\n$$\n在零假设下，$\\mathbb{E}[U]=0$。其方差是条件方差之和：\n$$\nV = \\sum_{j} \\operatorname{Var}(d_{1j}\\mid n_{1j},n_{2j},d_j)\n= \\sum_{j} \\frac{n_{1j}n_{2j}d_j(n_j-d_j)}{n_j^2(n_j-1)}.\n$$\n在零假设下，比率$X^2 = U^2/V$渐近服从自由度为$1$的卡方分布。\n\n我们现在为给定数据计算$U$和$V$。首先列举出不同的事件时间以及相关的风险集计数。总共有$16$名患者，每组$8$名。合并两组后，不同的事件时间为$t \\in \\{2,3,4,5,6,7,8,9\\}$。根据在时间$t$的事件发生在该时间$t$的删失之前的规则，可以依次更新风险集。\n\n在$t=2$之前瞬间初始化：$n_{1}=8$, $n_{2}=8$, $n=16$。\n- 在$t=2$时：事件为第$1$组$1$个，第$2$组$0$个，因此$d_{1}=1$, $d_{2}=0$, $d=1$。对$U$的贡献为\n$$\n1 - 1 \\cdot \\frac{8}{16} = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n对$V$的贡献为\n$$\n\\frac{8\\cdot 8 \\cdot 1 \\cdot (16-1)}{16^2(16-1)} = \\frac{64}{256} = \\frac{1}{4}.\n$$\n在$t=2$时，第$2$组的删失发生在事件之后，并在此后将第$2$组的风险集减少$1$。\n\n更新：在$t=3$之前瞬间，$n_{1}=7$, $n_{2}=7$, $n=14$。\n- 在$t=3$时：事件为第$1$组$1$个，第$2$组$1$个，因此$d_{1}=1$, $d_{2}=1$, $d=2$。对$U$的贡献为\n$$\n1 - 2 \\cdot \\frac{7}{14} = 1 - 1 = 0.\n$$\n对$V$的贡献为\n$$\n\\frac{7\\cdot 7 \\cdot 2 \\cdot (14-2)}{14^2(14-1)}\n= \\frac{49 \\cdot 2 \\cdot 12}{196 \\cdot 13}\n= \\frac{6}{13}.\n$$\n\n在这些事件之后，在$t=4$之前瞬间，移除在$t=3$时发生的两个事件：$n_{1}=6$, $n_{2}=6$, $n=12$。\n- 在$t=4$时：事件为第$1$组$0$个，第$2$组$1$个，因此$d_{1}=0$, $d_{2}=1$, $d=1$。对$U$的贡献为\n$$\n0 - 1 \\cdot \\frac{6}{12} = -\\frac{1}{2}.\n$$\n对$V$的贡献为\n$$\n\\frac{6\\cdot 6 \\cdot 1 \\cdot (12-1)}{12^2(12-1)} = \\frac{36}{144} = \\frac{1}{4}.\n$$\n在$t=4$时，第$1$组的删失发生在事件之后，并在此后将第$1$组的风险集减少$1$。\n\n更新：在$t=5$之前瞬间，$n_{1}=5$, $n_{2}=5$, $n=10$。\n- 在$t=5$时：事件为第$1$组$1$个，第$2$组$0$个，因此$d_{1}=1$, $d=1$。对$U$的贡献：\n$$\n1 - 1 \\cdot \\frac{5}{10} = \\frac{1}{2}.\n$$\n对$V$的贡献：\n$$\n\\frac{5\\cdot 5 \\cdot 1 \\cdot (10-1)}{10^2(10-1)} = \\frac{25}{100} = \\frac{1}{4}.\n$$\n在$t=5$时，第$2$组的删失随之发生，并减少第$2$组的风险集。\n\n更新：在$t=6$之前瞬间，$n_{1}=4$, $n_{2}=4$, $n=8$。\n- 在$t=6$时：事件为第$1$组$0$个，第$2$组$1$个，因此$d_{1}=0$, $d=1$。对$U$的贡献：\n$$\n0 - 1 \\cdot \\frac{4}{8} = -\\frac{1}{2}.\n$$\n对$V$的贡献：\n$$\n\\frac{4\\cdot 4 \\cdot 1 \\cdot (8-1)}{8^2(8-1)} = \\frac{16}{64} = \\frac{1}{4}.\n$$\n在$t=6$时，第$1$组的删失随之发生，并减少第$1$组的风险集。\n\n更新：在$t=7$之前瞬间，$n_{1}=3$, $n_{2}=3$, $n=6$。\n- 在$t=7$时：事件为第$1$组$1$个，第$2$组$0$个，因此$d_{1}=1$, $d=1$。对$U$的贡献：\n$$\n1 - 1 \\cdot \\frac{3}{6} = \\frac{1}{2}.\n$$\n对$V$的贡献：\n$$\n\\frac{3\\cdot 3 \\cdot 1 \\cdot (6-1)}{6^2(6-1)} = \\frac{9}{36} = \\frac{1}{4}.\n$$\n在$t=7$时，第$2$组的删失随之发生。\n\n更新：在$t=8$之前瞬间，$n_{1}=2$, $n_{2}=2$, $n=4$。\n- 在$t=8$时：事件为第$1$组$0$个，第$2$组$1$个，因此$d_{1}=0$, $d=1$。对$U$的贡献：\n$$\n0 - 1 \\cdot \\frac{2}{4} = -\\frac{1}{2}.\n$$\n对$V$的贡献：\n$$\n\\frac{2\\cdot 2 \\cdot 1 \\cdot (4-1)}{4^2(4-1)} = \\frac{4}{16} = \\frac{1}{4}.\n$$\n在$t=8$时，第$1$组的删失随之发生。\n\n更新：在$t=9$之前瞬间，$n_{1}=1$, $n_{2}=1$, $n=2$。\n- 在$t=9$时：事件为第$1$组$1$个，第$2$组$0$个，因此$d_{1}=1$, $d=1$。对$U$的贡献：\n$$\n1 - 1 \\cdot \\frac{1}{2} = \\frac{1}{2}.\n$$\n对$V$的贡献：\n$$\n\\frac{1\\cdot 1 \\cdot 1 \\cdot (2-1)}{2^2(2-1)} = \\frac{1}{4}.\n$$\n\n将各项贡献相加，\n$$\nU = \\left(\\frac{1}{2}\\right) + 0 + \\left(-\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) + \\left(-\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) + \\left(-\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right) = \\frac{1}{2}.\n$$\n对于方差，\n$$\nV = \\left(\\frac{1}{4}\\right) + \\left(\\frac{6}{13}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right) + \\left(\\frac{1}{4}\\right).\n$$\n有七项等于$\\frac{1}{4}$，总和为$\\frac{7}{4}$，因此\n$$\nV = \\frac{7}{4} + \\frac{6}{13} = \\frac{91}{52} + \\frac{24}{52} = \\frac{115}{52}.\n$$\n\n对数秩卡方统计量为\n$$\nX^2 = \\frac{U^2}{V} = \\frac{\\left(\\frac{1}{2}\\right)^2}{\\frac{115}{52}} = \\frac{\\frac{1}{4}}{\\frac{115}{52}} = \\frac{52}{460} = \\frac{13}{115} \\approx 0.113043478.\n$$\n四舍五入到四位有效数字，结果是$0.1130$。\n\n关于小样本调整，$\\operatorname{Var}(d_{1j})$中的有限总体校正项$\\frac{n_j - d_j}{n_j - 1}$之所以出现，是因为在零假设下，在每个时间点，事件是从一个有限的风险集中无放回地分配给各组的。这相对于大样本的二项近似降低了方差，后者将$d_j$个事件的分配视为有放回的独立抽样，其方差为$\\operatorname{Var}(d_{1j}) \\approx d_j \\frac{n_{1j}}{n_j}\\left(1-\\frac{n_{1j}}{n_j}\\right)$。在我们的数据中，当$d_j=1$时，校正因子等于$1$，因此没有区别；当$t=3$时$d_j=2$且$n_j=14$，校正因子$\\frac{n_j-d_j}{n_j-1}=\\frac{12}{13}$与二项近似相比，将方差减少了约$\\frac{1}{13}$。这种校正在小样本或当多个事件同时发生时非常重要。", "answer": "$$\\boxed{0.1130}$$", "id": "4562464"}, {"introduction": "对数秩检验和标准的Cox模型都依赖于比例风险假设，但在真实的临床场景中，这一假设可能不成立。本练习探讨了一种非比例风险的情形，它会导致生存曲线交叉。通过分析一个分段常数风险模型，您将学会识别这种现象[@problem_id:4562455]，并理解其对选择合适统计模型的关键影响。", "problem": "在一项关于新放化疗方案的影像组学研究中，一个二元影像组学特征将患者分为两个亚组：$A$ 组（特征阳性）和 $B$ 组（特征阴性）。为了说明交叉的 Kaplan-Meier 生存曲线如何由非比例风险引起，我们考虑以下构建的、科学上合理的、分段恒定的风险函数（风险单位为每月），在 $t=\\tau$ 月时有一个单一的变化点：\n- 对于 $A$ 组：当 $0 \\le t  \\tau$ 时，$h_{A}(t)=\\lambda_{A,1}$，当 $t \\ge \\tau$ 时，$h_{A}(t)=\\lambda_{A,2}$。\n- 对于 $B$ 组：当 $0 \\le t  \\tau$ 时，$h_{B}(t)=\\lambda_{B,1}$，当 $t \\ge \\tau$ 时，$h_{B}(t)=\\lambda_{B,2}$。\n\n假设生存函数 $S(t)$ 满足基本关系 $S(t)=\\exp\\!\\big(-\\int_{0}^{t} h(u)\\,du\\big)$（对于非负风险 $h(t)$），并且没有删失。对于一个现实的放疗加化疗场景，其中 $B$ 组存在早期治疗毒性效应，$A$ 组存在晚期复发风险，设\n$\\tau=12$，$\\lambda_{A,1}=0.03$，$\\lambda_{A,2}=0.10$，$\\lambda_{B,1}=0.07$ 以及 $\\lambda_{B,2}=0.04$。\n\n任务：\n1) 从生存函数通过积分风险的定义出发，推导在给定的分段恒定风险下，对所有 $t \\ge 0$ 的 $S_{A}(t)$ 和 $S_{B}(t)$ 的闭式表达式。\n\n2) 使用你的表达式，验证生存曲线是否交叉，并确定唯一的交叉时间 $t_{\\mathrm{cross}}$，使得 $S_{A}(t_{\\mathrm{cross}})=S_{B}(t_{\\mathrm{cross}})$。以月为单位提供你的答案。\n\n3) 使用风险比的定义 $HR(t)=h_{A}(t)/h_{B}(t)$，确定风险是否随时间成比例。简要解释你的发现对于在分析具有潜在时变效应的影像组学衍生的风险组时选择合适的生存分析模型的意义。\n\n最终答案仅给出 $t_{\\mathrm{cross}}$ 的数值（单位：月）。无需四舍五入。", "solution": "### 解答\n\n**任务 1：生存函数的推导**\n\n生存函数 $S(t)$ 由 $S(t) = \\exp(-H(t))$ 给出，其中 $H(t) = \\int_{0}^{t} h(u)\\,du$ 是累积风险函数。我们必须为 $A$ 组和 $B$ 组的分段恒定风险函数推导此表达式。\n\n我们首先推导具有单一变化点 $\\tau$ 的分段恒定风险 $h(t)$ 的一般形式：\n$h(t) = \\begin{cases} \\lambda_1  \\text{若 } 0 \\le t  \\tau \\\\ \\lambda_2  \\text{若 } t \\ge \\tau \\end{cases}$\n\n对于区间 $0 \\le t  \\tau$：\n累积风险为 $H(t) = \\int_{0}^{t} h(u)\\,du = \\int_{0}^{t} \\lambda_1\\,du = \\lambda_1 t$。\n生存函数为 $S(t) = \\exp(-\\lambda_1 t)$。\n\n对于区间 $t \\ge \\tau$：\n累积风险通过在变化点 $\\tau$ 处分割积分来计算：\n$H(t) = \\int_{0}^{t} h(u)\\,du = \\int_{0}^{\\tau} h(u)\\,du + \\int_{\\tau}^{t} h(u)\\,du$\n$H(t) = \\int_{0}^{\\tau} \\lambda_1\\,du + \\int_{\\tau}^{t} \\lambda_2\\,du = \\lambda_1 \\tau + \\lambda_2 (t - \\tau)$。\n生存函数为 $S(t) = \\exp(-[\\lambda_1 \\tau + \\lambda_2 (t - \\tau)])$。\n\n现在，我们将此一般形式应用于 $A$ 组和 $B$ 组，并使用给定的参数。\n\n对于 $A$ 组，$\\lambda_{A,1}=0.03$，$\\lambda_{A,2}=0.10$ 且 $\\tau=12$：\n$S_A(t) = \\begin{cases} \\exp(-0.03 t)  \\text{若 } 0 \\le t  12 \\\\ \\exp(-[0.03 \\cdot 12 + 0.10(t - 12)])  \\text{若 } t \\ge 12 \\end{cases}$\n简化 $t \\ge 12$ 时的指数：$-(0.36 + 0.10t - 1.2) = -(0.10t - 0.84) = 0.84 - 0.10t$。\n因此，$S_A(t) = \\begin{cases} \\exp(-0.03 t)  \\text{若 } 0 \\le t  12 \\\\ \\exp(0.84 - 0.10t)  \\text{若 } t \\ge 12 \\end{cases}$\n\n对于 $B$ 组，$\\lambda_{B,1}=0.07$，$\\lambda_{B,2}=0.04$ 且 $\\tau=12$：\n$S_B(t) = \\begin{cases} \\exp(-0.07 t)  \\text{若 } 0 \\le t  12 \\\\ \\exp(-[0.07 \\cdot 12 + 0.04(t - 12)])  \\text{若 } t \\ge 12 \\end{cases}$\n简化 $t \\ge 12$ 时的指数：$-(0.84 + 0.04t - 0.48) = -(0.04t + 0.36)$。\n因此，$S_B(t) = \\begin{cases} \\exp(-0.07 t)  \\text{若 } 0 \\le t  12 \\\\ \\exp(-(0.04t + 0.36))  \\text{若 } t \\ge 12 \\end{cases}$\n\n**任务 2：交叉时间的确定**\n\n我们寻找一个时间 $t_{\\mathrm{cross}} > 0$ 使得 $S_A(t_{\\mathrm{cross}}) = S_B(t_{\\mathrm{cross}})$。由于指数函数是一一对应的，这等价于寻找 $t_{\\mathrm{cross}}$ 使得累积风险函数相等：$H_A(t_{\\mathrm{cross}}) = H_B(t_{\\mathrm{cross}})$。\n\n我们来检查两个时间区间。\n对于 $0 \\le t  12$：\n我们需要解 $H_A(t) = H_B(t)$，即 $\\lambda_{A,1} t = \\lambda_{B,1} t$。\n这得到 $(0.03 - 0.07)t = 0$，所以 $-0.04t = 0$，意味着 $t=0$。这是起点，此时 $S_A(0)=S_B(0)=1$，不是交叉点。对于 $t \\in (0, 12)$，由于 $\\lambda_{A,1}  \\lambda_{B,1}$，我们有 $H_A(t)  H_B(t)$，这意味着 $S_A(t) > S_B(t)$。因此，在 $t=12$ 之前没有交叉发生。\n\n对于 $t \\ge 12$：\n我们必须解 $H_A(t) = H_B(t)$。\n$\\lambda_{A,1} \\tau + \\lambda_{A,2} (t - \\tau) = \\lambda_{B,1} \\tau + \\lambda_{B,2} (t - \\tau)$\n我们重新整理方程以解出 $t$：\n$\\lambda_{A,2} (t - \\tau) - \\lambda_{B,2} (t - \\tau) = \\lambda_{B,1} \\tau - \\lambda_{A,1} \\tau$\n$(t - \\tau)(\\lambda_{A,2} - \\lambda_{B,2}) = \\tau(\\lambda_{B,1} - \\lambda_{A,1})$\n假定 $\\lambda_{A,2} \\neq \\lambda_{B,2}$，我们可以写出：\n$t - \\tau = \\frac{\\tau(\\lambda_{B,1} - \\lambda_{A,1})}{\\lambda_{A,2} - \\lambda_{B,2}}$\n$t_{\\mathrm{cross}} = \\tau + \\frac{\\tau(\\lambda_{B,1} - \\lambda_{A,1})}{\\lambda_{A,2} - \\lambda_{B,2}}$\n\n现在，我们代入给定的数值：\n$\\tau = 12$\n$\\lambda_{A,1} = 0.03$\n$\\lambda_{A,2} = 0.10$\n$\\lambda_{B,1} = 0.07$\n$\\lambda_{B,2} = 0.04$\n\n$t_{\\mathrm{cross}} = 12 + \\frac{12(0.07 - 0.03)}{0.10 - 0.04}$\n$t_{\\mathrm{cross}} = 12 + \\frac{12(0.04)}{0.06}$\n$t_{\\mathrm{cross}} = 12 + 12 \\left(\\frac{0.04}{0.06}\\right) = 12 + 12 \\left(\\frac{2}{3}\\right)$\n$t_{\\mathrm{cross}} = 12 + 8 = 20$\n\n解 $t_{\\mathrm{cross}} = 20$ 位于区间 $t \\ge 12$ 内，因此它是一个有效的交叉时间。Kaplan-Meier 曲线在 20 个月时交叉。\n\n**任务 3：风险的比例性**\n\n风险比定义为 $HR(t) = \\frac{h_A(t)}{h_B(t)}$。当且仅当对于所有 $t \\ge 0$，$HR(t)$ 为常数时，比例风险假设成立。\n\n对于 $0 \\le t  12$：\n$HR(t) = \\frac{\\lambda_{A,1}}{\\lambda_{B,1}} = \\frac{0.03}{0.07} = \\frac{3}{7} \\approx 0.429$\n\n对于 $t \\ge 12$：\n$HR(t) = \\frac{\\lambda_{A,2}}{\\lambda_{B,2}} = \\frac{0.10}{0.04} = \\frac{10}{4} = 2.5$\n\n由于 $HR(t)$ 不随时间恒定（在 $t=12$ 时从 $\\frac{3}{7}$ 变为 $2.5$），因此风险是**非比例的**。\n\n**对生存分析建模的启示：** 违反比例风险（PH）假设意味着，假定比例性的标准生存模型，特别是 Cox 比例风险模型，在不进行修改的情况下不适用于分析这些数据。一个标准的 Cox 模型会估计一个单一的、不随时间变化的风险比，这将平均化 $A$ 组相对于 $B$ 组的早期保护效应（$HR  1$）和晚期有害效应（$HR > 1$）。这会掩盖风险的真实、时变特性，并可能导致不正确的临床结论。适当的分析方法将包括时变 Cox 模型（例如，使用与时间的交互作用）、分层 Cox 模型，或明确考虑非比例性的参数模型，例如作为本问题基础的分段指数模型。", "answer": "$$\\boxed{20}$$", "id": "4562455"}]}