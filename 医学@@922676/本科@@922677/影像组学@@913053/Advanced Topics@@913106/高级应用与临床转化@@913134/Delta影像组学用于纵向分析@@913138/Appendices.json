{"hands_on_practices": [{"introduction": "当我们拥有多个时间点的测量数据时，简单地计算两点之差可能无法完全捕捉变化的趋势。本练习将介绍一种更稳健的方法：使用普通最小二乘法（OLS）来估计影像组学特征随时间变化的速率，即斜率。通过从两个时间点的情况推导至多个时间点，你将掌握将纵向数据拟合到线性模型的核心技能，从而更精确地量化动态变化 [@problem_id:4536757]。", "problem": "在用于纵向分析的 delta 放射组学中，一个放射组学特征被建模为随时间变化的量，以量化治疗引起的变化。考虑一名患者的单个感兴趣区域，在该区域中，使用磁共振成像 (MRI) 在整个治疗过程中测量同一个放射组学特征。设在时间 $t$（单位：周）观察到的特征值为 $f(t)$，并假设真实的时间演化是近似线性的，带有加性零均值噪声，即 $f(t) = \\beta_{0} + \\beta_{1} t + \\varepsilon(t)$，其中 $\\varepsilon(t)$ 的均值为 $0$ 且方差有限。斜率 $\\beta_{1}$ 代表变化率，是 delta 放射组学中感兴趣的量。\n\n从最小二乘法的定义和上述假设出发，完成以下任务：\n\n1. 使用普通最小二乘法 (OLS) 的基本原理，推导恰好有 $2$ 个时间点的特殊情况下的斜率估计量 $\\hat{\\beta}_{1}$。证明在这种情况下，最小化过程为何迫使拟合直线穿过两个观测点，并求出斜率作为两个观测对 $\\{(t_{1}, f(t_{1})), (t_{2}, f(t_{2}))\\}$ 的函数。\n\n2. 将推导推广到 $T > 2$ 个时间点。从残差平方和 $\\sum_{i=1}^{T} \\left(f(t_{i}) - \\beta_{0} - \\beta_{1} t_{i}\\right)^{2}$ 出发，仅用 $\\{t_{i}\\}$ 和 $\\{f(t_{i})\\}$ 推导出 OLS 斜率估计量 $\\hat{\\beta}_{1}$ 的闭式解，最终表达式中不留任何未知数。\n\n3. 将您的结果应用于以下在 $T = 5$ 个时间点测量的纵向数据集：$t \\in \\{0, 2, 4, 6, 8\\}$（周），测量的特征值为 $f(0) = 1.30$, $f(2) = 1.18$, $f(4) = 1.02$, $f(6) = 0.87$ 和 $f(8) = 0.80$（任意特征单位）。计算：\n   - 仅使用基线和最终随访测量值的两点斜率。\n   - 使用所有 $5$ 个时间点的 OLS 斜率。\n\n将两个斜率都以“特征单位/周”为单位表示。将每个结果四舍五入到四位有效数字。以行矩阵的形式报告您的最终答案，顺序为 $\\left[\\hat{\\beta}_{1,\\text{two-point}} \\ \\hat{\\beta}_{1,\\text{OLS}}\\right]$。最终的方框答案中不要包含单位。", "solution": "该问题被评估为有效，因为它在科学上基于标准统计理论（普通最小二乘法），问题陈述清晰且提供了所有必要信息，并以客观、正式的语言表述。解题过程按要求进行。\n\n放射组学特征 $f(t)$ 在时间 $t$ 的模型由一个简单线性回归模型给出：\n$$f(t) = \\beta_{0} + \\beta_{1} t + \\varepsilon(t)$$\n其中 $\\beta_{0}$ 是截距，$\\beta_{1}$ 是斜率，$\\varepsilon(t)$ 是一个零均值误差项。普通最小二乘法 (OLS) 旨在找到使残差平方和 (SSR) 最小化的估计量 $\\hat{\\beta}_{0}$ 和 $\\hat{\\beta}_{1}$，SSR 定义为观测值与模型预测值之差的平方和。\n\n### 1. 两个时间点（$T=2$）的推导\n\n对于恰好有两个测量对 $(t_{1}, f(t_{1}))$ 和 $(t_{2}, f(t_{2}))$ 的特殊情况，残差平方和为：\n$$SSR(\\beta_{0}, \\beta_{1}) = \\sum_{i=1}^{2} \\left(f(t_{i}) - (\\beta_{0} + \\beta_{1} t_{i})\\right)^{2} = \\left(f(t_{1}) - \\beta_{0} - \\beta_{1} t_{1}\\right)^{2} + \\left(f(t_{2}) - \\beta_{0} - \\beta_{1} t_{2}\\right)^{2}$$\n为了找到使该量最小化的 $\\beta_{0}$ 和 $\\beta_{1}$ 的值，我们可以使用两种方法：直接最小化或微积分。\n\n**通过最小化原理解释：**\n$SSR(\\beta_{0}, \\beta_{1})$ 是一个平方项之和，这意味着它的值总是非负的，即 $SSR \\ge 0$。$SSR$ 可能的绝对最小值为 $0$。当且仅当两个平方项同时为零时，才能达到这个最小值：\n\\begin{align*} f(t_{1}) - \\hat{\\beta}_{0} - \\hat{\\beta}_{1} t_{1} = 0 \\\\ f(t_{2}) - \\hat{\\beta}_{0} - \\hat{\\beta}_{1} t_{2} = 0 \\end{align*}\n这是一个包含两个未知数 $\\hat{\\beta}_{0}$ 和 $\\hat{\\beta}_{1}$ 的二元线性方程组。这些方程的几何解释是，拟合直线 $\\hat{f}(t) = \\hat{\\beta}_{0} + \\hat{\\beta}_{1} t$ 必须精确地穿过两个观测数据点 $(t_{1}, f(t_{1}))$ 和 $(t_{2}, f(t_{2}))$。由于可以找到这样一条直线（只要 $t_1 \\neq t_2$），OLS 估计量必须描述这条直线，因为它能得到最小可能为 $0$ 的 SSR。\n\n**斜率估计量的推导：**\n我们求解该方程组以得到 $\\hat{\\beta}_{1}$。重新整理方程：\n\\begin{align*} f(t_{1}) = \\hat{\\beta}_{0} + \\hat{\\beta}_{1} t_{1} \\\\ f(t_{2}) = \\hat{\\beta}_{0} + \\hat{\\beta}_{1} t_{2} \\end{align*}\n用第二个方程减去第一个方程，得到：\n$$f(t_{2}) - f(t_{1}) = (\\hat{\\beta}_{0} + \\hat{\\beta}_{1} t_{2}) - (\\hat{\\beta}_{0} + \\hat{\\beta}_{1} t_{1}) = \\hat{\\beta}_{1} (t_{2} - t_{1})$$\n假设 $t_{1} \\neq t_{2}$，我们可以分离出 $\\hat{\\beta}_{1}$：\n$$\\hat{\\beta}_{1} = \\frac{f(t_{2}) - f(t_{1})}{t_{2} - t_{1}}$$\n这就是我们熟悉的穿过两点的直线斜率公式。\n\n### 2. 推广到 $T > 2$ 个时间点\n\n对于一个包含 $T$ 个观测值的通用数据集 $\\{(t_{i}, f(t_{i}))\\}_{i=1}^{T}$，残差平方和为：\n$$SSR(\\beta_{0}, \\beta_{1}) = \\sum_{i=1}^{T} \\left(f(t_{i}) - \\beta_{0} - \\beta_{1} t_{i}\\right)^{2}$$\n为了找到使 $SSR$ 最小化的估计量 $\\hat{\\beta}_{0}$ 和 $\\hat{\\beta}_{1}$，我们对 $SSR$ 分别求关于 $\\beta_{0}$ 和 $\\beta_{1}$ 的偏导数，并令它们为零。\n\n求关于 $\\beta_{0}$ 的偏导数：\n$$\\frac{\\partial SSR}{\\partial \\beta_{0}} = \\sum_{i=1}^{T} 2 \\left(f(t_{i}) - \\hat{\\beta}_{0} - \\hat{\\beta}_{1} t_{i}\\right)(-1) = -2 \\sum_{i=1}^{T} \\left(f(t_{i}) - \\hat{\\beta}_{0} - \\hat{\\beta}_{1} t_{i}\\right)$$\n令其为零：\n$$\\sum_{i=1}^{T} f(t_{i}) - \\sum_{i=1}^{T} \\hat{\\beta}_{0} - \\sum_{i=1}^{T} \\hat{\\beta}_{1} t_{i} = 0 \\implies \\sum f(t_{i}) - T\\hat{\\beta}_{0} - \\hat{\\beta}_{1}\\sum t_{i} = 0$$\n这是第一个正规方程。\n\n求关于 $\\beta_{1}$ 的偏导数：\n$$\\frac{\\partial SSR}{\\partial \\beta_{1}} = \\sum_{i=1}^{T} 2 \\left(f(t_{i}) - \\hat{\\beta}_{0} - \\hat{\\beta}_{1} t_{i}\\right)(-t_{i}) = -2 \\sum_{i=1}^{T} t_{i}\\left(f(t_{i}) - \\hat{\\beta}_{0} - \\hat{\\beta}_{1} t_{i}\\right)$$\n令其为零：\n$$\\sum_{i=1}^{T} t_{i}f(t_{i}) - \\sum_{i=1}^{T} \\hat{\\beta}_{0}t_{i} - \\sum_{i=1}^{T} \\hat{\\beta}_{1}t_{i}^2 = 0 \\implies \\hat{\\beta}_{0}\\sum t_{i} + \\hat{\\beta}_{1}\\sum t_{i}^2 = \\sum t_{i}f(t_{i})$$\n这是第二个正规方程。\n\n从第一个正规方程，我们可以用 $\\hat{\\beta}_{1}$ 来表示 $\\hat{\\beta}_{0}$。设 $\\bar{t} = \\frac{1}{T}\\sum t_{i}$ 和 $\\bar{f} = \\frac{1}{T}\\sum f(t_{i})$ 为样本均值。\n$$T\\hat{\\beta}_{0} = \\sum f(t_{i}) - \\hat{\\beta}_{1}\\sum t_{i} \\implies \\hat{\\beta}_{0} = \\frac{1}{T}\\sum f(t_{i}) - \\hat{\\beta}_{1} \\frac{1}{T}\\sum t_{i} = \\bar{f} - \\hat{\\beta}_{1}\\bar{t}$$\n现在，将 $\\hat{\\beta}_{0}$ 的这个表达式代入第二个正规方程：\n$$(\\bar{f} - \\hat{\\beta}_{1}\\bar{t})\\sum t_{i} + \\hat{\\beta}_{1}\\sum t_{i}^2 = \\sum t_{i}f(t_{i})$$\n展开并合并含有 $\\hat{\\beta}_{1}$ 的项：\n$$\\bar{f}\\sum t_{i} - \\hat{\\beta}_{1}\\bar{t}\\sum t_{i} + \\hat{\\beta}_{1}\\sum t_{i}^2 = \\sum t_{i}f(t_{i})$$\n$$\\hat{\\beta}_{1}\\left(\\sum t_{i}^2 - \\bar{t}\\sum t_{i}\\right) = \\sum t_{i}f(t_{i}) - \\bar{f}\\sum t_{i}$$\n解出 $\\hat{\\beta}_{1}$：\n$$\\hat{\\beta}_{1} = \\frac{\\sum t_{i}f(t_{i}) - \\bar{f}\\sum t_{i}}{\\sum t_{i}^2 - \\bar{t}\\sum t_{i}}$$\n这是一个有效的闭式解。一个更常见且更有洞察力的形式是通过代入 $\\sum t_{i} = T\\bar{t}$ 和 $\\sum f(t_{i}) = T\\bar{f}$ 得到的：\n$$\\hat{\\beta}_{1} = \\frac{\\sum t_{i}f(t_{i}) - T\\bar{f}\\bar{t}}{\\sum t_{i}^2 - T\\bar{t}^2}$$\n这个表达式可以进一步证明等价于样本协方差与样本方差之比：\n$$\\hat{\\beta}_{1} = \\frac{\\sum_{i=1}^{T} (t_{i} - \\bar{t})(f(t_{i}) - \\bar{f})}{\\sum_{i=1}^{T} (t_{i} - \\bar{t})^2}$$\n\n### 3. 应用于纵向数据集\n\n给定数据集有 $T=5$ 个时间点：\n- 时间点 $t$: $\\{0, 2, 4, 6, 8\\}$ 周\n- 特征值 $f(t)$: $\\{1.30, 1.18, 1.02, 0.87, 0.80\\}$\n\n**两点斜率计算：**\n仅使用基线 ($t_{1}=0, f(t_{1})=1.30$) 和最终 ($t_{2}=8, f(t_{2})=0.80$) 测量值，我们应用第 1 部分的公式：\n$$\\hat{\\beta}_{1,\\text{two-point}} = \\frac{f(8) - f(0)}{8 - 0} = \\frac{0.80 - 1.30}{8} = \\frac{-0.50}{8} = -0.0625$$\n四舍五入到四位有效数字，结果是 $-0.06250$ 特征单位/周。\n\n**使用所有 5 个时间点计算 OLS 斜率：**\n我们使用公式 $\\hat{\\beta}_{1} = \\frac{\\sum (t_{i} - \\bar{t})(f(t_{i}) - \\bar{f})}{\\sum (t_{i} - \\bar{t})^2}$。\n首先，计算均值：\n$$\\bar{t} = \\frac{0+2+4+6+8}{5} = \\frac{20}{5} = 4$$\n$$\\bar{f} = \\frac{1.30 + 1.18 + 1.02 + 0.87 + 0.80}{5} = \\frac{5.17}{5} = 1.034$$\n现在，我们计算必要的总和。\n$t$ 的离差平方和：\n$$\\sum_{i=1}^{5} (t_{i} - \\bar{t})^2 = (0-4)^2 + (2-4)^2 + (4-4)^2 + (6-4)^2 + (8-4)^2$$\n$$= (-4)^2 + (-2)^2 + 0^2 + 2^2 + 4^2 = 16 + 4 + 0 + 4 + 16 = 40$$\n离差乘积之和：\n$$\\sum_{i=1}^{5} (t_{i} - \\bar{t})(f(t_{i}) - \\bar{f}) = (0-4)(1.30-1.034) + (2-4)(1.18-1.034) + (4-4)(1.02-1.034) + (6-4)(0.87-1.034) + (8-4)(0.80-1.034)$$\n$$= (-4)(0.266) + (-2)(0.146) + (0)(-0.014) + (2)(-0.164) + (4)(-0.234)$$\n$$= -1.064 - 0.292 + 0 - 0.328 - 0.936 = -2.620$$\n最后，我们计算 OLS 斜率估计量：\n$$\\hat{\\beta}_{1,\\text{OLS}} = \\frac{-2.620}{40} = -0.0655$$\n四舍五入到四位有效数字，结果是 $-0.06550$ 特征单位/周。\n\n两点斜率为 $\\hat{\\beta}_{1,\\text{two-point}} = -0.06250$，使用所有数据计算的 OLS 斜率为 $\\hat{\\beta}_{1,\\text{OLS}} = -0.06550$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.06250  -0.06550\n\\end{pmatrix}\n}\n$$", "id": "4536757"}, {"introduction": "计算出特征的变化量后，我们自然会问：这个测量结果有多可靠？本练习将探讨“delta特征”本身的不确定性，通过分析其方差来量化这种可靠性。你将推导在独立的和相关的测量噪声下，变化量方差的表达式，从而直观地理解噪声如何传播，以及不同时间点测量之间的相关性如何影响我们对变化量的置信度 [@problem_id:4536699]。", "problem": "在用于纵向分析的delta-radiomics中，一个影像组学特征在两个时间点被提取，记为 $t_1$ 和 $t_2$。设在时间 $t$ 观测到的特征值为 $Y_t = f(t) + \\epsilon_t$，其中 $f(t)$ 是真实的（无噪声的）特征值，而 $\\epsilon_t$ 是由分割和重建变异性引起的测量噪声。假设对于给定患者，量 $f(t_1)$ 和 $f(t_2)$ 是固定的（非随机的），并且 $\\epsilon_t \\sim \\mathcal{N}(0,\\sigma^2)$，在两个时间点具有相同的方差 $\\sigma^2$。定义delta-radiomics特征为 $\\Delta f = Y_{t_2} - Y_{t_1}$。仅使用随机变量线性组合的方差和协方差公理，首先在 $\\epsilon_{t_1}$ 和 $\\epsilon_{t_2}$ 独立的假设下计算 $\\mathrm{Var}(\\Delta f)$。然后考虑一个更现实的场景，其中存在共享的采集偏差，使得 $\\mathrm{Cov}(\\epsilon_{t_1},\\epsilon_{t_2}) = \\rho\\,\\sigma^2$，其中 $-1 \\le \\rho \\le 1$。在这种相关噪声模型下，用 $\\sigma^2$ 和 $\\rho$ 表示来推导 $\\mathrm{Var}(\\Delta f)$。请以关于 $\\sigma^2$ 和 $\\rho$ 的单一闭式解析表达式的形式给出你的最终答案。无需四舍五入。", "solution": "首先验证问题陈述的科学合理性、自我一致性和清晰度。\n\n**步骤 1：提取已知条件**\n- 在时间 $t$ 观测到的特征值为 $Y_t = f(t) + \\epsilon_t$。\n- $f(t)$ 是真实的、非随机的特征值。\n- $\\epsilon_t$ 是测量噪声，满足 $\\epsilon_t \\sim \\mathcal{N}(0, \\sigma^2)$。方差 $\\sigma^2$ 在两个时间点 $t_1$ 和 $t_2$ 相同。\n- delta-radiomics特征定义为 $\\Delta f = Y_{t_2} - Y_{t_1}$。\n- 情况 1（独立噪声）：$\\epsilon_{t_1}$ 和 $\\epsilon_{t_2}$ 是独立的。\n- 情况 2（相关噪声）：$\\mathrm{Cov}(\\epsilon_{t_1}, \\epsilon_{t_2}) = \\rho\\,\\sigma^2$，其中 $-1 \\le \\rho \\le 1$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据。加性噪声模型 $Y_t = f(t) + \\epsilon_t$ 是许多科学学科（包括影像组学）中测量误差的标准和基本模型。关于噪声分布为高斯分布以及不同时间点测量值之间可能存在相关性的假设是现实的，并且在统计理论中得到了很好的证实。该问题是适定的，提供了推导唯一解析解所需的所有必要定义和约束。语言客观且无歧义。该问题没有违反任何无效性标准。\n\n**结论：** 该问题是有效的。\n\n**求解推导**\n目标是计算delta-radiomics特征的方差 $\\mathrm{Var}(\\Delta f)$。我们首先用其组成部分来表示 $\\Delta f$。\n\ndelta-radiomics特征的定义是：\n$$ \\Delta f = Y_{t_2} - Y_{t_1} $$\n\n代入观测特征值的模型 $Y_t = f(t) + \\epsilon_t$：\n$$ \\Delta f = (f(t_2) + \\epsilon_{t_2}) - (f(t_1) + \\epsilon_{t_1}) $$\n\n重新排列各项以分离非随机和随机分量，得到：\n$$ \\Delta f = (f(t_2) - f(t_1)) + (\\epsilon_{t_2} - \\epsilon_{t_1}) $$\n\n我们现在计算 $\\Delta f$ 的方差。根据问题陈述，对于给定患者，真实特征值 $f(t_1)$ 和 $f(t_2)$ 是固定的、非随机的量。因此，它们的差 $f(t_2) - f(t_1)$ 是一个常数。方差的一个基本性质是，对于任何随机变量 $X$ 和常数 $c$，有 $\\mathrm{Var}(X+c) = \\mathrm{Var}(X)$。应用此性质，我们得到：\n$$ \\mathrm{Var}(\\Delta f) = \\mathrm{Var}((f(t_2) - f(t_1)) + (\\epsilon_{t_2} - \\epsilon_{t_1})) = \\mathrm{Var}(\\epsilon_{t_2} - \\epsilon_{t_1}) $$\n\n我们现在使用两个随机变量 $A$ 和 $B$ 的线性组合的方差公理：\n$$ \\mathrm{Var}(aA + bB) = a^2 \\mathrm{Var}(A) + b^2 \\mathrm{Var}(B) + 2ab \\mathrm{Cov}(A, B) $$\n\n在我们的例子中，$A = \\epsilon_{t_2}$，$B = \\epsilon_{t_1}$，$a = 1$，$b = -1$。将这些代入公式，得到：\n$$ \\mathrm{Var}(\\epsilon_{t_2} - \\epsilon_{t_1}) = (1)^2 \\mathrm{Var}(\\epsilon_{t_2}) + (-1)^2 \\mathrm{Var}(\\epsilon_{t_1}) + 2(1)(-1) \\mathrm{Cov}(\\epsilon_{t_2}, \\epsilon_{t_1}) $$\n$$ \\mathrm{Var}(\\Delta f) = \\mathrm{Var}(\\epsilon_{t_2}) + \\mathrm{Var}(\\epsilon_{t_1}) - 2 \\mathrm{Cov}(\\epsilon_{t_1}, \\epsilon_{t_2}) $$\n注意协方差是对称的，即 $\\mathrm{Cov}(\\epsilon_{t_2}, \\epsilon_{t_1}) = \\mathrm{Cov}(\\epsilon_{t_1}, \\epsilon_{t_2})$。\n\n从问题陈述中，我们已知 $\\mathrm{Var}(\\epsilon_{t_1}) = \\sigma^2$ 和 $\\mathrm{Var}(\\epsilon_{t_2}) = \\sigma^2$。将这些代入表达式，得到：\n$$ \\mathrm{Var}(\\Delta f) = \\sigma^2 + \\sigma^2 - 2 \\mathrm{Cov}(\\epsilon_{t_1}, \\epsilon_{t_2}) = 2\\sigma^2 - 2 \\mathrm{Cov}(\\epsilon_{t_1}, \\epsilon_{t_2}) $$\n\n现在我们针对两种指定情景评估此表达式。\n\n**情况 1：独立噪声**\n如果噪声项 $\\epsilon_{t_1}$ 和 $\\epsilon_{t_2}$ 是独立的，则它们的协方差为零：\n$$ \\mathrm{Cov}(\\epsilon_{t_1}, \\epsilon_{t_2}) = 0 $$\n将此代入我们关于 $\\mathrm{Var}(\\Delta f)$ 的一般表达式：\n$$ \\mathrm{Var}(\\Delta f) = 2\\sigma^2 - 2(0) = 2\\sigma^2 $$\n因此，在独立噪声的假设下，delta特征的方差是单个测量值方差的两倍。\n\n**情况 2：相关噪声**\n在更现实的场景中，我们给定一个非零协方差：\n$$ \\mathrm{Cov}(\\epsilon_{t_1}, \\epsilon_{t_2}) = \\rho\\,\\sigma^2 $$\n这里，$\\rho$ 是噪声项之间的相关系数。将此代入我们关于 $\\mathrm{Var}(\\Delta f)$ 的一般表达式：\n$$ \\mathrm{Var}(\\Delta f) = 2\\sigma^2 - 2(\\rho\\,\\sigma^2) $$\n\n提取公因式 $2\\sigma^2$，我们得到在相关噪声模型下delta-radiomics特征方差的最终表达式：\n$$ \\mathrm{Var}(\\Delta f) = 2\\sigma^2(1 - \\rho) $$\n\n该表达式是所要求的结果，用单次测量噪声方差 $\\sigma^2$ 和相关性 $\\rho$ 表示了delta特征的方差。这个结果表明，与独立情况相比，正相关（$\\rho > 0$）会减小差值的方差，而负相关（$\\rho < 0$）则会增大它。\n\n问题要求给出相关噪声模型的单一闭式解析表达式。", "answer": "$$ \\boxed{2\\sigma^2(1 - \\rho)} $$", "id": "4536699"}, {"introduction": "真实世界中的纵向研究常常面临数据缺失的挑战。本练习通过一个思想实验，探讨了一种常见的缺失数据处理方法——末次观测值结转（LOCF）——可能带来的后果。你将从数学上证明，这种看似简便的填补方法会如何系统性地低估真实的特征变化，这强调了在纵向分析中采用严谨方法处理缺失数据的重要性 [@problem_id:4536755]。", "problem": "一个影像组学队列在 $2$ 个时间点进行纵向监测：时间 $t=0$ 的基线和时间 $t=T$ 的随访。对于每个受试者 $i$，单个影像组学特征 $X_i(t)$ 根据一个简单的线性轨迹模型演变\n$$\nX_i(t) = X_{i0} + v_i t + \\varepsilon_i(t),\n$$\n其中 $X_{i0}$ 是受试者特定的基线截距，$v_i$ 是受试者特定的斜率，而 $\\varepsilon_i(t)$ 是一个零均值测量误差过程，对所有 $t$ 都有 $\\mathbb{E}[\\varepsilon_i(t)]=0$，且与 $v_i$ 不相关。假设随访测量的缺失是完全随机缺失 (MCAR)，这意味着随访时的缺失指示变量 $M_i \\in \\{0,1\\}$（其中 $M_i=1$ 表示缺失）满足 $\\mathbb{P}(M_i=1)=p$，并且独立于 $v_i$ 和 $\\varepsilon_i(t)$。基线测量值总是可以观测到。\n\n在 delta-影像组学中，受试者水平的 delta 特征被定义为随访和基线之间的变化量，\n$$\nD_i = X_i(T) - X_i(0).\n$$\n在实践中，当随访测量值缺失时，末次观测值结转 (LOCF) 的惯例将记录的随访值设为等于基线值，因此对于 $M_i=1$ 的情况，随访缺失下的估计 delta 变为 $\\hat{D}_i=0$，而对于 $M_i=0$ 的情况，则等于观测到的变化量。\n\n从上述定义和期望的性质出发，推导预期衰减因子\n$$\nA = \\frac{\\mathbb{E}[\\hat{D}_i]}{\\mathbb{E}[D_i]},\n$$\n该因子量化了在这种线性轨迹模型和 MCAR 缺失机制下，当随访数据缺失时采用基线值结转的做法如何削弱整个队列的预期 delta 值。将您的最终答案表示为一个仅含 $p$ 的闭式解析表达式。不需要数值近似，最终表达式中也不应包含任何单位。", "solution": "所述问题为推导所要求的量提供了一套完整且一致的定义和假设。它在科学上基于纵向数据的生物统计建模标准框架，问题提法恰当，并以客观、正式的语言表述。该模型是在特定数据缺失机制（完全随机缺失）下，为研究特定数据处理惯例（末次观测值结转）的影响而做出的一个有效简化。因此，该问题是有效的，并且可以推导出解决方案。\n\n目标是求出预期衰减因子 $A$，其定义为估计的 delta 特征的期望与真实的 delta 特征的期望之比：\n$$\nA = \\frac{\\mathbb{E}[\\hat{D}_i]}{\\mathbb{E}[D_i]}\n$$\n我们将分别推导分子和分母的表达式。\n\n首先，我们来确定真实的 delta 特征的期望 $\\mathbb{E}[D_i]$。受试者 $i$ 的真实 delta 特征定义为影像组学特征从基线 ($t=0$) 到随访 ($t=T$) 的变化量：\n$$\nD_i = X_i(T) - X_i(0)\n$$\n该特征的线性轨迹模型由 $X_i(t) = X_{i0} + v_i t + \\varepsilon_i(t)$ 给出。\n在这两个时间点，特征值为：\n$$\nX_i(0) = X_{i0} + v_i(0) + \\varepsilon_i(0) = X_{i0} + \\varepsilon_i(0)\n$$\n$$\nX_i(T) = X_{i0} + v_i T + \\varepsilon_i(T)\n$$\n将这些代入 $D_i$ 的表达式中：\n$$\nD_i = (X_{i0} + v_i T + \\varepsilon_i(T)) - (X_{i0} + \\varepsilon_i(0))\n$$\n$$\nD_i = v_i T + \\varepsilon_i(T) - \\varepsilon_i(0)\n$$\n现在，我们求 $D_i$ 的期望。根据期望算子的线性性质：\n$$\n\\mathbb{E}[D_i] = \\mathbb{E}[v_i T + \\varepsilon_i(T) - \\varepsilon_i(0)] = \\mathbb{E}[v_i T] + \\mathbb{E}[\\varepsilon_i(T)] - \\mathbb{E}[\\varepsilon_i(0)]\n$$\n由于 $T$ 是一个常数，所以 $\\mathbb{E}[v_i T] = T \\mathbb{E}[v_i]$。问题陈述，测量误差过程 $\\varepsilon_i(t)$ 的均值为零，因此 $\\mathbb{E}[\\varepsilon_i(T)] = 0$ 且 $\\mathbb{E}[\\varepsilon_i(0)] = 0$。\n因此，真实的 delta 的期望为：\n$$\n\\mathbb{E}[D_i] = T \\mathbb{E}[v_i]\n$$\n为使此量非平凡，我们假设平均而言随时间存在一些变化，即 $\\mathbb{E}[v_i] \\neq 0$，并且随访时间不为零，$T > 0$。\n\n接下来，我们确定估计的 delta 特征的期望 $\\mathbb{E}[\\hat{D}_i]$。估计的 delta $\\hat{D}_i$ 是根据随访测量的缺失状态 $M_i$ 来定义的。\n$$\n\\hat{D}_i =\n\\begin{cases}\nD_i  \\text{如果 } M_i = 0 \\text{ （观测到随访值）} \\\\\n0  \\text{如果 } M_i = 1 \\text{ （随访值缺失）}\n\\end{cases}\n$$\n这可以更紧凑地表示为：\n$$\n\\hat{D}_i = (1 - M_i) D_i\n$$\n为了求其期望，我们计算 $\\mathbb{E}[\\hat{D}_i] = \\mathbb{E}[(1-M_i) D_i]$。\n问题陈述，缺失是完全随机缺失 (MCAR)，这意味着缺失指示变量 $M_i$ 与其他变量独立，包括受试者特定的斜率 $v_i$ 和测量误差过程 $\\varepsilon_i(t)$。由于 $D_i$ 是 $v_i$、$\\varepsilon_i(0)$ 和 $\\varepsilon_i(T)$ 的函数，因此 $M_i$ 也与 $D_i$ 独立。\n对于两个独立的随机变量，例如 $Y$ 和 $Z$，它们乘积的期望等于它们各自期望的乘积：$\\mathbb{E}[YZ] = \\mathbb{E}[Y]\\mathbb{E}[Z]$。\n将此性质应用于 $Y = (1-M_i)$ 和 $Z = D_i$：\n$$\n\\mathbb{E}[\\hat{D}_i] = \\mathbb{E}[1-M_i] \\mathbb{E}[D_i]\n$$\n缺失指示变量 $M_i$ 是一个伯努利随机变量，其中 $M_i=1$ 的概率为 $p = \\mathbb{P}(M_i=1)$。伯努利变量的期望是其成功概率，所以 $\\mathbb{E}[M_i] = p$。\n$(1-M_i)$ 的期望是：\n$$\n\\mathbb{E}[1-M_i] = 1 - \\mathbb{E}[M_i] = 1 - p\n$$\n将此代回到 $\\mathbb{E}[\\hat{D}_i]$ 的表达式中：\n$$\n\\mathbb{E}[\\hat{D}_i] = (1 - p) \\mathbb{E}[D_i]\n$$\n现在我们可以计算衰减因子 $A$。\n$$\nA = \\frac{\\mathbb{E}[\\hat{D}_i]}{\\mathbb{E}[D_i]} = \\frac{(1 - p) \\mathbb{E}[D_i]}{\\mathbb{E}[D_i]}\n$$\n假设预期的真实变化不为零，即 $\\mathbb{E}[D_i] \\neq 0$，我们可以从分子和分母中消去这一项。这个假设在问题的表述中是隐含的，因为只有当存在一个可被衰减的非零信号时，“衰减”这个概念才有意义。\n$$\nA = 1 - p\n$$\n这个结果表明，在指定的线性模型和 MCAR 机制下，末次观测值结转的做法会引入一个系统性偏差，将预期的测量变化量进行衰减，其衰减因子与数据缺失的概率直接相关。", "answer": "$$\n\\boxed{1-p}\n$$", "id": "4536755"}]}