{"hands_on_practices": [{"introduction": "在多中心研究中，量化放射组学特征的变异在多大程度上源于成像设备和扫描协议，而非真实的生物学差异，是至关重要的一步。本练习将介绍一种基础的统计技术——方差分量分析，用于将总方差分解为不同的来源。通过这个计算，您将具体地理解如何衡量采集站点变异性带来的影响。[@problem_id:4545012]", "problem": "一项多中心影像组学研究评估了从计算机断层扫描（CT）图像中提取的标量影像组学纹理特征。对于在采集点 $j$ 进行扫描、重复测量索引为 $k$ 的受试者 $i$，其特征值被建模为\n$$Y_{ijk} = \\mu + S_{i} + A_{j} + \\varepsilon_{ijk},$$\n其中 $S_{i}$ 是一个随机效应，捕捉受试者之间的生物学变异性；$A_{j}$ 是一个随机效应，捕捉归因于采集点（扫描仪、方案差异）的变异性；$\\varepsilon_{ijk}$ 是一个残差，捕捉技术噪声以及受试者内部、采集点内部的变异。假设 $S_{i}$、$A_{j}$ 和 $\\varepsilon_{ijk}$ 相互独立，均值为零，方差分别为 $\\sigma^{2}_{\\text{subject}}$、$\\sigma^{2}_{\\text{site}}$ 和 $\\sigma^{2}_{\\text{residual}}$。\n\n使用方差的定义和独立随机变量的性质，推导 $Y_{ijk}$ 的边际方差，然后计算总变异中归因于采集点的部分所占的比例。取\n$$\\sigma^{2}_{\\text{subject}}=40,\\quad \\sigma^{2}_{\\text{site}}=15,\\quad \\sigma^{2}_{\\text{residual}}=20.$$\n请将最终答案表示为小数（无单位）。无需四舍五入。", "solution": "问题陈述经评估有效。这是一个应用统计学中定义明确的问题，具体涉及线性混合效应模型内的方差分量分析，这是影像组学等领域的标准方法。该问题具有科学依据，是客观的，并为其解决提供了完整且一致的给定条件。\n\n对于在采集点 $j$ 进行扫描、重复测量索引为 $k$ 的受试者 $i$，其影像组学特征值 $Y_{ijk}$ 的模型由下式给出：\n$$Y_{ijk} = \\mu + S_{i} + A_{j} + \\varepsilon_{ijk}$$\n在此模型中，$\\mu$ 是一个表示总体均值的常数。项 $S_{i}$、$A_{j}$ 和 $\\varepsilon_{ijk}$ 是随机变量，规定它们相互独立，且均值为零。它们各自的方差为 $\\mathrm{Var}(S_i) = \\sigma^{2}_{\\text{subject}}$、$\\mathrm{Var}(A_j) = \\sigma^{2}_{\\text{site}}$ 和 $\\mathrm{Var}(\\varepsilon_{ijk}) = \\sigma^{2}_{\\text{residual}}$。\n\n我们的第一个目标是推导观测值 $Y_{ijk}$ 的边际方差。随机变量（比如 $X$）的方差记为 $\\mathrm{Var}(X)$。方差的一个基本性质是，对于任何随机变量 $X$ 和任何常数 $c$，它们的和的方差不变：$\\mathrm{Var}(X+c) = \\mathrm{Var}(X)$。将此原理应用于 $Y_{ijk}$ 的模型，其中 $\\mu$ 是一个常数，我们得到：\n$$\\mathrm{Var}(Y_{ijk}) = \\mathrm{Var}(\\mu + S_{i} + A_{j} + \\varepsilon_{ijk}) = \\mathrm{Var}(S_{i} + A_{j} + \\varepsilon_{ijk})$$\n方差的另一个核心性质是，对于相互独立的随机变量之和，其和的方差等于它们各自方差的和。问题陈述明确指出 $S_i$、$A_j$ 和 $\\varepsilon_{ijk}$ 是相互独立的。因此，我们可以将方差分解如下：\n$$\\mathrm{Var}(Y_{ijk}) = \\mathrm{Var}(S_{i}) + \\mathrm{Var}(A_{j}) + \\mathrm{Var}(\\varepsilon_{ijk})$$\n这个表达式代表了测量特征的总方差，我们可以将其表示为 $\\sigma^{2}_{\\text{total}}$。将给定的方差分量符号代入，我们得到：\n$$\\sigma^{2}_{\\text{total}} = \\sigma^{2}_{\\text{subject}} + \\sigma^{2}_{\\text{site}} + \\sigma^{2}_{\\text{residual}}$$\n这个方程体现了方差分解的原理，这是统计分析中识别变异来源的基石。\n\n第二个目标是计算总变异中归因于采集点的部分所占的比例。这可以通过计算由采集点引起的方差分量 $\\sigma^{2}_{\\text{site}}$ 与总方差 $\\sigma^{2}_{\\text{total}}$ 的比率来得到。\n$$\\text{Fraction}_{\\text{site}} = \\frac{\\sigma^{2}_{\\text{site}}}{\\sigma^{2}_{\\text{total}}} = \\frac{\\sigma^{2}_{\\text{site}}}{\\sigma^{2}_{\\text{subject}} + \\sigma^{2}_{\\text{site}} + \\sigma^{2}_{\\text{residual}}}$$\n这个比例是组内相关系数（ICC）的一种形式，它量化了数据中总方差由特定分组或聚类因素（在本例中为采集点）所解释的比例。\n\n我们已知以下方差分量的数值：\n$$\\sigma^{2}_{\\text{subject}} = 40$$\n$$\\sigma^{2}_{\\text{site}} = 15$$\n$$\\sigma^{2}_{\\text{residual}} = 20$$\n首先，我们将这些值代入我们推导出的公式中，计算总方差 $\\sigma^{2}_{\\text{total}}$：\n$$\\sigma^{2}_{\\text{total}} = 40 + 15 + 20 = 75$$\n接下来，我们代入 $\\sigma^{2}_{\\text{site}}$ 的值和计算出的 $\\sigma^{2}_{\\text{total}}$ 的值，来计算所需的比例：\n$$\\text{Fraction}_{\\text{site}} = \\frac{15}{75}$$\n最后，我们简化这个分数，以得到所要求的小数表示形式：\n$$\\text{Fraction}_{\\text{site}} = \\frac{1}{5} = 0.2$$\n因此，影像组学特征测量总变异的 $20\\%$ 归因于采集点之间的差异。", "answer": "$$\\boxed{0.2}$$", "id": "4545012"}, {"introduction": "当我们认识到采集变异性是一个问题后，就需要一个标准化的度量指标来评估每个特征的可靠性。类内相关系数（ICC）正是用于此目的的最常用工具。本练习要求您从其底层的方差分量出发，推导并计算ICC，从而将可靠性这一抽象概念与一个具体的数值联系起来。理解ICC对于筛选出在临床模型中值得信赖的稳健特征至关重要。[@problem_id:4545040]", "problem": "一项放射组学研究评估了从计算机断层扫描 (CT) 图像的重复采集中提取的基于标量强度的特征的可重复性。对于每位受试者，在名义上相同的条件下采集多次扫描，并为每次扫描计算该特征。假设测量到的特征遵循一个单因素随机效应模型：\n$$\nY_{ij} = \\mu + S_{i} + \\varepsilon_{ij},\n$$\n其中 $Y_{ij}$ 是受试者 $i$ 在第 $j$ 次采集中的特征值，$\\mu$ 是一个固定的总体均值，$S_{i}$ 是一个受试者特异性随机效应，满足 $S_{i} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{between}})$，代表真实的受试者间变异性，而 $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{within}})$ 代表受试者内变异性，主要由图像采集变异和下游处理噪声引起。假设 $S_{i}$ 和 $\\varepsilon_{ij}$ 之间以及不同下标之间相互独立。在此模型下，组内相关系数 (ICC) 定义为同一受试者两次独立重复测量之间的相关性。\n\n假设对 $n=10$ 名受试者进行了重复扫描，并且在整个队列中汇总的方差分量估计值得出 $\\sigma^{2}_{\\text{between}}=25$ 和 $\\sigma^{2}_{\\text{within}}=10$（单位均为特征单位的平方）。\n\n任务：\n1. 从所述模型下同一受试者两次重复测量之间相关性的定义出发，推导组内相关系数 (ICC) 关于 $\\sigma^{2}_{\\text{between}}$ 和 $\\sigma^{2}_{\\text{within}}$ 的闭式表达式。\n2. 使用给定的方差分量，计算 ICC 的数值。\n3. 简要解释计算出的 ICC 对于该特征对采集变异性的稳健性意味着什么，以及这应如何影响放射组学中的特征选择。\n\n将 ICC 报告为四舍五入到四位有效数字的单个十进制数。最终报告的数字中不要包含单位。除了 ICC 值外，解释性讨论不需要数值输出。", "solution": "该场景由单因素随机效应模型建模：\n$$\nY_{ij} = \\mu + S_{i} + \\varepsilon_{ij},\n$$\n其中 $S_{i} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{between}})$ 代表真实的受试者间变异性，而 $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{within}})$ 代表与采集相关的和残余的受试者内变异性。我们假设不同下标之间以及 $S_{i}$ 和 $\\varepsilon_{ij}$ 之间相互独立。在此模型下，单次测量的组内相关系数 (ICC) 定义为来自同一受试者的两次独立重复测量之间的相关性：\n$$\n\\text{ICC} = \\operatorname{Corr}(Y_{i1}, Y_{i2}).\n$$\n\n为了用 $\\sigma^{2}_{\\text{between}}$ 和 $\\sigma^{2}_{\\text{within}}$ 推导 $\\text{ICC}$，我们计算同一受试者重复测量的协方差和方差。对于一个固定的受试者 $i$，\n$$\nY_{i1} = \\mu + S_{i} + \\varepsilon_{i1}, \\quad Y_{i2} = \\mu + S_{i} + \\varepsilon_{i2}.\n$$\n根据方差的性质和独立性，\n$$\n\\operatorname{Var}(Y_{i1}) = \\operatorname{Var}(S_{i}) + \\operatorname{Var}(\\varepsilon_{i1}) = \\sigma^{2}_{\\text{between}} + \\sigma^{2}_{\\text{within}},\n$$\n类似地\n$$\n\\operatorname{Var}(Y_{i2}) = \\sigma^{2}_{\\text{between}} + \\sigma^{2}_{\\text{within}}.\n$$\n同一受试者两次重复测量之间的协方差为\n$$\n\\operatorname{Cov}(Y_{i1}, Y_{i2}) = \\operatorname{Cov}(S_{i} + \\varepsilon_{i1}, S_{i} + \\varepsilon_{i2}) = \\operatorname{Cov}(S_{i}, S_{i}) + \\operatorname{Cov}(S_{i}, \\varepsilon_{i2}) + \\operatorname{Cov}(\\varepsilon_{i1}, S_{i}) + \\operatorname{Cov}(\\varepsilon_{i1}, \\varepsilon_{i2}).\n$$\n根据独立性，当 $1 \\neq 2$ 时，$\\operatorname{Cov}(S_{i}, \\varepsilon_{ij}) = 0$ 且 $\\operatorname{Cov}(\\varepsilon_{i1}, \\varepsilon_{i2}) = 0$，剩下\n$$\n\\operatorname{Cov}(Y_{i1}, Y_{i2}) = \\operatorname{Var}(S_{i}) = \\sigma^{2}_{\\text{between}}.\n$$\n因此，相关性为\n$$\n\\text{ICC} = \\frac{\\operatorname{Cov}(Y_{i1}, Y_{i2})}{\\sqrt{\\operatorname{Var}(Y_{i1})\\operatorname{Var}(Y_{i2})}} = \\frac{\\sigma^{2}_{\\text{between}}}{\\sigma^{2}_{\\text{between}} + \\sigma^{2}_{\\text{within}}}.\n$$\n\n现在代入给定的方差分量 $\\sigma^{2}_{\\text{between}} = 25$ 和 $\\sigma^{2}_{\\text{within}} = 10$：\n$$\n\\text{ICC} = \\frac{25}{25 + 10} = \\frac{25}{35} = \\frac{5}{7}.\n$$\n作为小数，其值为\n$$\n\\text{ICC} = \\frac{5}{7} \\approx 0.714285714\\ldots\n$$\n四舍五入到四位有效数字，ICC 为\n$$\n0.7143.\n$$\n\n对特征选择的解释和启示：约等于 $0.7143$ 的组内相关系数表明，该特征的总变异性大部分源于真实的受试者间差异，而不是与采集相关的受试者内变异性，但仍有不可忽略的一部分变异是由采集效应引起的。在放射组学流程中，通常优先选择具有更高可重复性的特征（通常使用 $\\text{ICC} \\geq 0.75$ 或 $\\text{ICC} \\geq 0.80$ 等阈值进行操作化），以确保其在不同扫描和扫描仪之间的稳健性。接近 $0.7143$ 的 ICC 表明该特征具有中等到良好的可重复性；对于高风险的预测建模，该特征可能被认为是临界的。这一结果可能会促使研究人员采取以下措施：应用协调或标准化程序以减少 $\\sigma^{2}_{\\text{within}}$，重新评估特征提取参数，或优先考虑将具有更高 ICC 的替代特征纳入最终模型。", "answer": "$$\\boxed{0.7143}$$", "id": "4545040"}, {"introduction": "构建一个有预测能力的放射组学特征模型，不仅仅是寻找与临床结果相关的特征，更关键的是要筛选出那些既稳定又信息不冗余的特征。这需要一个系统性的筛选策略。本练习模拟了一个真实世界的情景，您必须应用一个两阶段策略来构建一个稳健的特征集，平衡特征的稳定性（通过ICC衡量）和信息冗余度（通过相关性衡量）。这个综合性问题将前面所学的概念融入一个实际的工作流程中，锻炼您在放射组学模型工程中的决策能力。[@problem_id:4545050]", "problem": "一个研究团队正在基于多中心、不同采集参数下获取的计算机断层扫描（CT）图像构建一个放射组学特征。由于采集过程中的变异性会降低工程化图像特征的可重复性，该团队采用了一种基于可靠性和冗余度控制的两阶段筛选策略。目标是保留那些对采集变化稳定且彼此不冗余的特征。\n\n团队使用的基本原则：\n1. 组内相关系数（ICC）通过组间方差与总方差的比值来量化可靠性，其值越高表示特征在重复测量和不同采集条件下的稳定性越好。形式上，如果假设一个单因素随机效应模型，可靠性由ICC表征，其形式为 $ \\mathrm{ICC} = \\frac{\\sigma_{\\text{between}}^{2}}{\\sigma_{\\text{between}}^{2} + \\sigma_{\\text{within}}^{2}} $，其中 $ \\sigma_{\\text{between}}^{2} $ 和 $ \\sigma_{\\text{within}}^{2} $ 分别表示组间和组内方差分量。\n2. 皮尔逊相关系数（Pearson correlation coefficient）衡量了两个特征在不同受试者之间的线性依赖关系。高的绝对相关性表明编码信息存在冗余。\n\n筛选策略如下：\n- 第1阶段（可靠性筛选）：保留组内相关系数（ICC）至少为稳定性阈值 $ \\tau_{S} = 0.75 $ 的特征。\n- 第2阶段（冗余修剪）：在保留的特征中，构建一个无向图。如果两个特征之间的皮尔逊相关性绝对值至少为冗余阈值 $ \\tau_{R} = 0.80 $，则在这两个特征之间连接一条边。在该图的每个连通分量中，只保留ICC最高的特征，并丢弃其他特征。\n\n给定四个候选特征 $ F_{1}, F_{2}, F_{3}, F_{4} $，其ICC值为\n$$\n\\{ \\mathrm{ICC}(F_{1}), \\mathrm{ICC}(F_{2}), \\mathrm{ICC}(F_{3}), \\mathrm{ICC}(F_{4}) \\} = \\{ 0.85, 0.72, 0.45, 0.90 \\}.\n$$\n在一组受试者队列中，这些特征之间的经验皮尔逊相关矩阵 $ \\mathbf{R} $ 为\n$$\n\\mathbf{R} =\n\\begin{pmatrix}\n1  & 0.82 & 0.00 & 0.82 \\\\\n0.82 & 1 & 0.00 & 0.82 \\\\\n0.00 & 0.00 & 1 & 0.00 \\\\\n0.82 & 0.82 & 0.00 & 1\n\\end{pmatrix}.\n$$\n\n将上述两阶段筛选策略应用于这些特征。筛选后，计算所选特征集的平均组内相关系数（mean ICC）。将最终结果表示为一个无单位数，并四舍五入至四位有效数字。", "solution": "该问题要求对一组四个放射组学特征应用两阶段特征筛选策略，然后计算所选特征的平均组内相关系数（ICC）。整个过程将按照问题描述中定义的步骤逐步执行。\n\n首先，我们必须验证问题陈述的有效性。\n所有给定信息都已明确说明：\n1.  一组四个特征：$F_{1}, F_{2}, F_{3}, F_{4}$。\n2.  它们对应的ICC值：$\\{ \\mathrm{ICC}(F_{1}), \\mathrm{ICC}(F_{2}), \\mathrm{ICC}(F_{3}), \\mathrm{ICC}(F_{4}) \\} = \\{ 0.85, 0.72, 0.45, 0.90 \\}$。\n3.  特征之间的皮尔逊相关矩阵 $\\mathbf{R}$：\n    $$\n    \\mathbf{R} =\n    \\begin{pmatrix}\n    1  & 0.82 & 0.00 & 0.82 \\\\\n    0.82 & 1 & 0.00 & 0.82 \\\\\n    0.00 & 0.00 & 1 & 0.00 \\\\\n    0.82 & 0.82 & 0.00 & 1\n    \\end{pmatrix}\n    $$\n4.  两阶段筛选策略：\n    -   第1阶段（可靠性）：保留 $\\mathrm{ICC} \\geq \\tau_{S}$ 的特征，其中稳定性阈值为 $\\tau_{S} = 0.75$。\n    -   第2阶段（冗余）：对于保留的特征，构建一个图，如果两个特征之间的皮尔逊相关性绝对值 $\\geq \\tau_{R}$，则连接一条边，其中冗余阈值为 $\\tau_{R} = 0.80$。在每个连通分量中，只保留ICC最高的特征。\n5.  最终任务是计算所选特征的平均ICC，并四舍五入至四位有效数字。\n\n该问题具有科学依据，使用了放射组学和统计学中的标准方法（ICC，皮尔逊相关）。问题定义清晰，提供了所有必要的数据和明确的规则。语言客观、正式。因此，问题是有效的，我们可以继续进行求解。\n\n**第1阶段：可靠性筛选**\n\n此阶段根据特征的ICC值进行筛选。稳定性阈值为 $\\tau_{S} = 0.75$。如果一个特征的ICC大于或等于此阈值，则该特征被保留。我们对每个特征进行评估：\n\n-   对于特征 $F_{1}$：$\\mathrm{ICC}(F_{1}) = 0.85$。由于 $0.85 \\geq 0.75$，特征 $F_{1}$ 被保留。\n-   对于特征 $F_{2}$：$\\mathrm{ICC}(F_{2}) = 0.72$。由于 $0.72  0.75$，特征 $F_{2}$ 被丢弃。\n-   对于特征 $F_{3}$：$\\mathrm{ICC}(F_{3}) = 0.45$。由于 $0.45  0.75$，特征 $F_{3}$ 被丢弃。\n-   对于特征 $F_{4}$：$\\mathrm{ICC}(F_{4}) = 0.90$。由于 $0.90 \\geq 0.75$，特征 $F_{4}$ 被保留。\n\n经过第1阶段后，保留的特征集为 $\\{F_{1}, F_{4}\\}$。\n\n**第2阶段：冗余修剪**\n\n此阶段对通过第1阶段筛选的特征集 $\\{F_{1}, F_{4}\\}$ 进行操作。我们构建一个无向图，其中这些特征是节点。如果两个节点（特征）之间的皮尔逊相关系数的绝对值 $|\\rho|$ 大于或等于冗余阈值 $\\tau_{R} = 0.80$，则在它们之间画一条边。\n\n我们需要检查 $F_{1}$ 和 $F_{4}$ 之间的相关性。从给定的相关矩阵 $\\mathbf{R}$ 中，第1行第4列的元素是 $\\mathbf{R}_{14} = 0.82$。\n\n该相关性的绝对值为 $|\\mathbf{R}_{14}| = |0.82| = 0.82$。我们将其与阈值 $\\tau_{R}$ 进行比较：\n$$\n0.82 \\geq \\tau_{R} = 0.80\n$$\n条件满足。因此，在节点 $F_{1}$ 和 $F_{4}$ 之间放置一条边。生成的图有一个包含这两个特征的连通分量：$\\{F_{1}, F_{4}\\}$。\n\n根据策略，在每个连通分量内，只保留ICC最高的特征。我们比较该分量中特征的ICC值：\n-   $\\mathrm{ICC}(F_{1}) = 0.85$\n-   $\\mathrm{ICC}(F_{4}) = 0.90$\n\n由于 $\\mathrm{ICC}(F_{4})  \\mathrm{ICC}(F_{1})$，特征 $F_{4}$ 被保留，而特征 $F_{1}$ 被丢弃。\n\n经过两阶段筛选策略后，最终选定的特征集只包含一个特征：$\\{F_{4}\\}$。\n\n**最终计算**\n\n问题要求计算所选特征集的平均ICC。所选集合为 $\\{F_{4}\\}$。\n这个单一特征的ICC值为 $\\mathrm{ICC}(F_{4}) = 0.90$。\n包含单个元素的集合的平均ICC就是该元素自身的值。\n$$\n\\text{平均 ICC} = \\frac{\\mathrm{ICC}(F_{4})}{1} = 0.90\n$$\n问题规定结果必须四舍五入至四位有效数字。要将 $0.90$ 表示为四位有效数字，我们将其写为 $0.9000$。", "answer": "$$\\boxed{0.9000}$$", "id": "4545050"}]}