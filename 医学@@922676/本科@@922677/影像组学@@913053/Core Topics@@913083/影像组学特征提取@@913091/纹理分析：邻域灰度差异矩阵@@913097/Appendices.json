{"hands_on_practices": [{"introduction": "我们从最基本的情景开始：一个完全均匀的感兴趣区域（ROI）。这个练习旨在帮助你掌握邻域灰度差分矩阵（NGTDM）的基本计算，例如 $n_i$、$p_i$ 和 $s_i$。通过分析这个理想化的例子，你将建立一个重要的概念基准，理解在没有局部纹理变化时，NGTDM 特征会呈现怎样的极限值。[@problem_id:4566022]", "problem": "考虑一幅用于放射组学的二维离散采样医学图像。设感兴趣区域 (ROI) 是一个 $3 \\times 3$ 的体素网格，其中所有体素都被赋予相同的量化灰度级 $5$。在切比雪夫距离下，取邻域半径 $\\delta = 1$（即二维中的 8-连通邻域）。使用邻域灰度差分矩阵 (NGTDM) 框架及以下基本定义。\n\n对于每个灰度级 $i$，定义：\n- $n_i$ 为 ROI 中灰度级等于 $i$ 且在切比雪夫距离 $\\leq \\delta$ 范围内于 ROI 内部至少有一个邻居的体素数量（中心体素不被视为其自身邻域的一部分）。\n- 对于每个灰度级为 $i$ 的此类体素 $v$，令 $\\mathcal{N}(v)$ 为其在 ROI 内部且切比雪夫距离 $\\leq \\delta$ 的相邻体素集合，局部邻域平均值为 $a_v = \\frac{1}{|\\mathcal{N}(v)|} \\sum_{u \\in \\mathcal{N}(v)} g(u)$，其中 $g(u)$ 是体素 $u$ 的灰度级。\n- 灰度级 $i$ 的 NGTDM 差分聚合值为 $s_i = \\sum_{v:\\, g(v)=i} |\\, i - a_v \\,|$，其中求和遍及由 $n_i$ 计数的那些体素。\n- 令 $N = \\sum_{i} n_i$ 为所有灰度级计数的体素总数，并定义 $p_i = \\frac{n_i}{N}$。\n\n任务：\n1. 计算指定 ROI 的 $n_5$、$p_5$ 和 $s_5$。\n2. 计算 $\\sum_{i} p_i s_i$。\n3. 根据 NGTDM 粗糙度与聚合邻域差 $\\sum_{i} p_i s_i$ 成反比这一公认特征，就其极限值解释该 ROI 的粗糙度 $C$。\n\n将 $\\sum_{i} p_i s_i$ 的值作为您的最终数值答案报告。无需四舍五入，不涉及单位。", "solution": "问题陈述已经过验证，被认为是有效的。它在放射组学领域有科学依据，特别是关于使用邻域灰度差分矩阵（NGTDM）进行纹理分析。该问题是适定的、客观的，并包含推导出唯一解所需的所有信息。因此，我们可以开始求解。\n\n该问题要求计算指定感兴趣区域 (ROI) 的几个 NGTDM 相关量。ROI 是一个 $3 \\times 3$ 的体素网格，其中每个体素的量化灰度级都为 $5$。邻域由半径 $\\delta = 1$ 的切比雪夫距离定义，这对应于二维中的 8-连通邻域。\n\n首先，我们解决任务 1：计算 $n_5$、$p_5$ 和 $s_5$。\n\n量 $n_i$ 表示灰度级为 $i$ 且在 ROI 内至少有一个邻居的体素数量。在我们的案例中，唯一存在的灰度级是 $i=5$。ROI 是一个 $3 \\times 3$ 的网格。此网格中的每个体素，包括角落和边缘的体素，都至少有一个邻居也在此网格内。\n- 中心体素有 $8$ 个邻居。\n- 四个角落体素各有 $3$ 个邻居。\n- 四个边缘（非角落）体素各有 $5$ 个邻居。\n由于 ROI 中的所有 $9$ 个体素的灰度级都为 $5$，并且它们都在 ROI 内有邻居，因此所有 $9$ 个体素都计入灰度级 $i=5$。\n因此，$n_5 = 9$。对于任何其他灰度级 $j \\neq 5$，没有该灰度级的体素，所以 $n_j = 0$。\n\n所有灰度级计数的体素总数为 $N = \\sum_{i} n_i$。由于唯一的非零项是 $n_5$，我们有：\n$$\nN = n_5 = 9\n$$\n概率 $p_i$ 定义为 $p_i = \\frac{n_i}{N}$。对于灰度级 $i=5$，这是：\n$$\np_5 = \\frac{n_5}{N} = \\frac{9}{9} = 1\n$$\n对于任何其他灰度级 $j \\neq 5$，$p_j = \\frac{n_j}{N} = \\frac{0}{9} = 0$。\n\n接下来，我们计算 NGTDM 差分聚合值 $s_i = \\sum_{v:\\, g(v)=i} |i - a_v|$。对于我们的情况 $i=5$，这变成：\n$$\ns_5 = \\sum_{v:\\, g(v)=5} |5 - a_v|\n$$\n求和遍及 ROI 中的所有 $9$ 个体素，因为它们的灰度级都为 $5$。我们必须首先确定每个体素 $v$ 的局部邻域平均值 $a_v$。定义是 $a_v = \\frac{1}{|\\mathcal{N}(v)|} \\sum_{u \\in \\mathcal{N}(v)} g(u)$，其中 $\\mathcal{N}(v)$ 是 $v$ 在 ROI 内的邻居集合。\n一个关键的观察是，ROI 中的每个体素 $u$，因此也是每个体素 $v$ 的每个邻居，都具有相同的灰度级 $g(u) = 5$。因此，对于任何体素 $v$，其邻域平均值 $a_v$ 是：\n$$\na_v = \\frac{1}{|\\mathcal{N}(v)|} \\sum_{u \\in \\mathcal{N}(v)} 5 = \\frac{1}{|\\mathcal{N}(v)|} \\cdot |\\mathcal{N}(v)| \\cdot 5 = 5\n$$\n这意味着对于 ROI 中的每个体素 $v$，局部平均值 $a_v = 5$。现在我们可以计算 $s_5$：\n$$\ns_5 = \\sum_{v:\\, g(v)=5} |5 - 5| = \\sum_{v:\\, g(v)=5} 0\n$$\n该和包含 $9$ 个项，每一项都是 $0$。因此：\n$$\ns_5 = 0\n$$\n\n现在，我们解决任务 2：计算 $\\sum_{i} p_i s_i$。\n这个和是对所有可能的灰度级 $i$ 进行的。我们可以将这个和展开为：\n$$\n\\sum_{i} p_i s_i = p_5 s_5 + \\sum_{j \\neq 5} p_j s_j\n$$\n根据我们之前的计算，我们有 $p_5 = 1$ 和 $s_5 = 0$。对于任何灰度级 $j \\neq 5$，我们有 $p_j = 0$。因此，和中的每一项都为零：\n$$\n\\sum_{i} p_i s_i = (1)(0) + \\sum_{j \\neq 5} (0) s_j = 0 + 0 = 0\n$$\n聚合邻域差的数值为 $0$。\n\n最后，我们解决任务 3：解释粗糙度 $C$。\n问题陈述粗糙度与聚合邻域差成反比，我们刚刚计算出该值为 $0$。设此聚合差为 $D = \\sum_{i} p_i s_i$。NGTDM 特征“粗糙度”通常定义为 $C = (\\sum_i p_i s_i)^{-1}$（在实际实现中，通常会在分母上加一个很小的 epsilon 以防止除以零）。\n在我们的理想化情况下，$D=0$。这个值意味着，一个体素的灰度级与其邻居的平均灰度级之间平均差异为零。这种情况只在完全同质或空间均匀的区域中才会满足，即不存在任何局部变化。\n反比关系意味着当 $D \\to 0$ 时，粗糙度 $C \\to \\infty$。因此，对于这个 ROI，粗糙度取其理论最大值。这个无穷大粗糙度的极限值正确地表征了该纹理是完全不复杂和均匀的，这正是可能的最粗糙纹理的定义。一个所有体素共享相同强度的 ROI 代表了粗糙度的绝对极限。\n\n最终要求的数值答案是 $\\sum_{i} p_i s_i$ 的值。\n$$\n\\sum_{i} p_i s_i = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "4566022"}, {"introduction": "建立基本计算之后，我们来探讨一个核心问题：为什么我们需要纹理分析？本练习将通过对比两个在视觉和纹理上截然不同，但具有完全相同灰度直方图的 ROI 来回答这个问题。你将亲手验证并理解 NGTDM 如何通过其空间分析能力（特别是通过 $s_i$ 值）来区分这两种纹理，从而揭示其超越简单一阶统计的强大之处。[@problem_id:4565881]", "problem": "一位放射组学分析师正在研究邻域灰度差分矩阵 (NGTDM) 如何捕捉灰度直方图无法揭示的纹理信息。NGTDM 是在一个感兴趣区域 (ROI) 上使用指定的邻域来定义的。考虑一个离散化为两个灰度级的二维 ROI，其八连通邻域由 Chebyshev 距离 $1$ 定义（即，除了中心点外，所有偏移量在 $\\{-1,0,1\\}$ 内的邻居）。如果一个体素的完整 $3 \\times 3$ 邻域完全位于 ROI 内部，则该体素被认为是有效的。对于每个位置为 $\\mathbf{x}$、灰度级为 $g(\\mathbf{x})$ 的有效体素，定义局部邻域均值 $m(\\mathbf{x})$ 为其邻居灰度级的算术平均值。对于每个灰度级 $i$，定义 $n_{i}$ 为灰度级为 $i$ 的有效体素数量，经验分布为 $p_{i} = n_{i}/N_{v}$（其中 $N_{v}$ 是有效体素的总数），以及 NGTDM 差异累加值\n$$\ns_{i} = \\sum_{\\mathbf{x} \\,:\\, g(\\mathbf{x}) = i} \\left| i - m(\\mathbf{x}) \\right|.\n$$\n定义粗糙度特征为\n$$\nC = \\frac{1}{\\sum_{i} p_i s_{i}}.\n$$\n在一个 $4 \\times 4$ 的网格上构建并分析以下两个 ROI，两者均离散化为灰度级 $\\{0, 4\\}$：\n\nROI A（由两个大的均匀半区和一个清晰的垂直边界组成）：\n$$\n\\begin{pmatrix}\n0  0  4  4 \\\\\n0  0  4  4 \\\\\n0  0  4  4 \\\\\n0  0  4  4\n\\end{pmatrix}\n$$\n\nROI B（棋盘格排列的细粒度交替）：\n$$\n\\begin{pmatrix}\n0  4  0  4 \\\\\n4  0  4  0 \\\\\n0  4  0  4 \\\\\n4  0  4  0\n\\end{pmatrix}\n$$\n\n使用上述 NGTDM 定义和八连通邻域，对每个 ROI 执行以下操作：计算有效体素上的 $p_{i}$ 并验证直方图是否匹配，计算每个灰度级的 $s_{i}$，然后计算粗糙度 $C$。最后，报告比率 $R = C_{\\text{A}} / C_{\\text{B}}$。将您的最终比率四舍五入到四位有效数字。简要解释为什么尽管 $p_{i}$ 相同，$s_{i}$ 的值仍能区分这些纹理。评分的答案是单个无量纲数值 $R$。[@problem_id:48]", "solution": "用户提供了一个来自放射组学领域的有效问题陈述，具体涉及使用邻域灰度差分矩阵 (NGTDM) 进行纹理分析。该问题是自包含的，有科学依据且适定。我们将进行完整的解答。\n\n问题要求分析两个 $4 \\times 4$ 的感兴趣区域 (ROI)，记为 ROI A 和 ROI B，其灰度级取自集合 {$0, 4$}。\n\nROI A:\n$$\n\\begin{pmatrix}\n0  0  4  4 \\\\\n0  0  4  4 \\\\\n0  0  4  4 \\\\\n0  0  4  4\n\\end{pmatrix}\n$$\n\nROI B:\n$$\n\\begin{pmatrix}\n0  4  0  4 \\\\\n4  0  4  0 \\\\\n0  4  0  4 \\\\\n4  0  4  0\n\\end{pmatrix}\n$$\n\n如果一个体素的完整 $3 \\times 3$ 邻域位于 ROI 内部，则该体素被定义为有效的。对于一个 $4 \\times 4$ 的网格，这将有效体素限制在中心的 $2 \\times 2$ 块中。设体素的位置由 $(r, c)$ 索引，其中 $r$ 是行，$c$ 是列，二者范围都从 $1$ 到 $4$。有效的体素位置是 $(2,2)$、$(2,3)$、$(3,2)$ 和 $(3,3)$。\n\n**ROI A 的分析**\n\n首先，我们确定 ROI A 中有效体素的灰度级：\n- $g(2,2) = 0$\n- $g(2,3) = 4$\n- $g(3,2) = 0$\n- $g(3,3) = 4$\n\n有效体素的总数是 $N_{v} = 4$。\n灰度级为 $i=0$ 的有效体素数量是 $n_{0} = 2$。\n灰度级为 $i=4$ 的有效体素数量是 $n_{4} = 2$。\n\n经验分布（直方图）$p_{i} = n_{i}/N_{v}$ 为：\n$p_{0} = 2/4 = 1/2$\n$p_{4} = 2/4 = 1/2$\n\n接下来，我们计算 NGTDM 差异累加值 $s_{i} = \\sum_{\\mathbf{x} \\,:\\, g(\\mathbf{x}) = i} \\left| i - m(\\mathbf{x}) \\right|$。这需要为每个有效体素计算局部邻域均值 $m(\\mathbf{x})$。邻域由 8 个邻居组成。\n\n对于位置在 $(2,2)$ 且灰度级为 $g(2,2)=0$ 的体素：\n邻居的灰度级是 $\\{0, 0, 4, 0, 4, 0, 0, 4\\}$。\n邻居灰度级的总和是 $5 \\times 0 + 3 \\times 4 = 12$。\n均值是 $m(2,2) = 12/8 = 1.5$。\n\n对于位置在 $(3,2)$ 且灰度级为 $g(3,2)=0$ 的体素：\n其邻域与 $(2,2)$ 的邻域类似（邻居为 g(2,1)=0, g(2,2)=0, g(2,3)=4, g(3,1)=0, g(3,3)=4, g(4,1)=0, g(4,2)=0, g(4,3)=4）。\n总和是 $5 \\times 0 + 3 \\times 4 = 12$。均值是 $m(3,2) = 12/8 = 1.5$。\n\n对于位置在 $(2,3)$ 且灰度级为 $g(2,3)=4$ 的体素：\n邻居的灰度级是 $\\{0, 4, 4, 0, 4, 0, 4, 4\\}$。\n邻居灰度级的总和是 $3 \\times 0 + 5 \\times 4 = 20$。\n均值是 $m(2,3) = 20/8 = 2.5$。\n\n对于位置在 $(3,3)$ 且灰度级为 $g(3,3)=4$ 的体素：\n其邻域与 $(2,3)$ 的邻域类似。\n总和是 $3 \\times 0 + 5 \\times 4 = 20$。均值是 $m(3,3) = 20/8 = 2.5$。\n\n现在，我们计算 ROI A 的 $s_{i}$：\n$s_{0} = |0 - m(2,2)| + |0 - m(3,2)| = |0 - 1.5| + |0 - 1.5| = 1.5 + 1.5 = 3$。\n$s_{4} = |4 - m(2,3)| + |4 - m(3,3)| = |4 - 2.5| + |4 - 2.5| = 1.5 + 1.5 = 3$。\n\n粗糙度特征 $C_{\\text{A}}$ 是：\n$\\sum_i p_i s_i = p_0 s_0 + p_4 s_4 = (\\frac{1}{2})(3) + (\\frac{1}{2})(3) = 3$。\n$C_{\\text{A}} = \\frac{1}{\\sum_{i} p_i s_{i}} = \\frac{1}{3}$。\n\n**ROI B 的分析**\n\n接下来，我们确定 ROI B 中有效体素的灰度级：\n- $g(2,2) = 0$\n- $g(2,3) = 4$\n- $g(3,2) = 4$\n- $g(3,3) = 0$\n\n有效体素的总数是 $N_{v} = 4$。\n$n_{0} = 2$ 且 $n_{4} = 2$。\n直方图 $p_{i}$ 为 $p_{0} = 1/2$ 和 $p_{4} = 1/2$，与 ROI A 的直方图相同。\n\n现在我们计算 ROI B 中每个有效体素的 $m(\\mathbf{x})$。\n\n对于位置在 $(2,2)$ 且灰度级为 $g(2,2)=0$ 的体素：\n邻居的灰度级是 $\\{0, 4, 0, 4, 4, 0, 4, 0\\}$。\n总和是 $4 \\times 0 + 4 \\times 4 = 16$。\n均值是 $m(2,2) = 16/8 = 2$。\n\n对于位置在 $(3,3)$ 且灰度级为 $g(3,3)=0$ 的体素：\n由于棋盘格的对称性，其邻域与 $(2,2)$ 的邻域相同。\n均值是 $m(3,3) = 16/8 = 2$。\n\n对于位置在 $(2,3)$ 且灰度级为 $g(2,3)=4$ 的体素：\n邻居的灰度级是 $\\{4, 0, 4, 0, 0, 4, 0, 4\\}$。\n总和是 $4 \\times 0 + 4 \\times 4 = 16$。\n均值是 $m(2,3) = 16/8 = 2$。\n\n对于位置在 $(3,2)$ 且灰度级为 $g(3,2)=4$ 的体素：\n由于对称性，其邻域与 $(2,3)$ 的邻域相同。\n均值是 $m(3,2) = 16/8 = 2$。\n\n现在，我们计算 ROI B 的 $s_{i}$：\n$s_{0} = |0 - m(2,2)| + |0 - m(3,3)| = |0 - 2| + |0 - 2| = 2 + 2 = 4$。\n$s_{4} = |4 - m(2,3)| + |4 - m(3,2)| = |4 - 2| + |4 - 2| = 2 + 2 = 4$。\n\n粗糙度特征 $C_{\\text{B}}$ 是：\n$\\sum_i p_i s_i = p_0 s_0 + p_4 s_4 = (\\frac{1}{2})(4) + (\\frac{1}{2})(4) = 4$。\n$C_{\\text{B}} = \\frac{1}{\\sum_{i} p_i s_{i}} = \\frac{1}{4}$。\n\n**区分的解释**\n\n两个 ROI 的灰度直方图 $p_{i}$ 是相同的，因为它们对于每个灰度级都包含相同数量的有效体素（$n_0=2, n_4=2$）。直方图是对像素空间排列不敏感的一阶统计量。\n\nNGTDM 的量 $s_{i}$ 成功地区分了这些纹理，因为它们包含了二阶空间信息。项 $|i - m(\\mathbf{x})|$ 通过测量一个体素的灰度级与其直接邻居的平均值的差异来量化局部对比度。\n\n- 在 ROI A（粗糙纹理）中，有效体素位于两个大的均匀区域之间的单一边界上。邻域是异构的，其均值 $m(\\mathbf{x})$ 分别为 $1.5$ 和 $2.5$。总累积差异的加权和 $\\sum p_i s_i = 3$ 反映了沿这个单一边界的局部对比度。\n- 在 ROI B（精细纹理）中，有效体素是高频棋盘格图案的一部分。每个体素都与其直接周围环境差异最大。这种高的局部对比度导致所有有效体素的邻域均值都为 $m(\\mathbf{x})=2$，这恰好在两个灰度级 $0$ 和 $4$ 的中间。这导致每个体素都有更大的绝对差：$|0-2|=2$ 和 $|4-2|=2$。因此，总累积差异的加权和 $\\sum p_i s_i = 4$ 更高，表明纹理更精细、更复杂。\n\n粗糙度特征 $C = 1/\\sum p_i s_i$ 与这个加权累积差异成反比。ROI A 视觉上“更粗糙”，具有较小的 $\\sum p_i s_i$，从而导致较大的粗糙度值（$C_A = 1/3$）。ROI B 视觉上“更精细”，具有较大的 $\\sum p_i s_i$，从而产生较小的粗糙度值（$C_B = 1/4$）。这展示了 NGTDM 如何捕捉简单直方图所忽略的空间关系。\n\n**比率 R 的最终计算**\n\n比率 $R$ 定义为 $C_{\\text{A}} / C_{\\text{B}}$。\n$R = \\frac{C_{\\text{A}}}{C_{\\text{B}}} = \\frac{1/3}{1/4} = \\frac{4}{3}$。\n\n作为小数，$R = 1.3333...$。四舍五入到四位有效数字得到 $1.333$。", "answer": "$$\\boxed{1.333}$$", "id": "4565881"}, {"introduction": "在理解了 NGTDM 的“是什么”与“为什么”之后，你现在已经准备好处理一个更接近真实应用场景的计算任务。这个练习要求你为一个结构化但非均匀的 ROI 计算 NGTDM 特征，这将全面锻炼你的计算技能。此外，本练习还将引入另一个关键的 NGTDM 特征——“繁忙度”（Busyness），帮助你拓宽对纹理量化描述的理解。[@problem_id:4565911]", "problem": "考虑一个量化的二维图像感兴趣区域（ROI），大小为 $4 \\times 4$，其灰度级限制在集合 $\\{1,4\\}$ 中。灰度级为 $4$ 的体素占据了ROI中心一个连续的 $2 \\times 2$ 区域，其余所有体素的灰度级均为 $1$。使用邻域灰度差分矩阵（NGTDM）的定义，邻域半径 $\\delta=1$ 基于切比雪夫距离：一个体素的邻域由切比雪夫距离 $\\delta=1$ 内的所有体素组成，不包括中心体素本身，并且在ROI边界处，邻域均值是根据ROI内部所有可用邻居计算的。量 $p_i$ 定义为灰度级为 $i$ 的ROI体素的经验比例，量 $s_i$ 定义为对所有灰度级为 $i$ 的体素，其灰度级与邻域均值之差的绝对值求和。\n\n从这些核心定义出发，计算所述ROI的 $p_1$、$p_4$、$s_1$ 和 $s_4$。然后，使用NGTDM框架的基本原理和计算出的 $p_i$ 和 $s_i$，确定该ROI的忙碌度（busyness）特征 $B$。所有答案均为无量纲。请提供精确值，无需四舍五入。", "solution": "该问题经核实具有科学依据、提法明确且客观。计算邻域灰度差分矩阵（NGTDM）所需的所有参数均已提供，不存在矛盾或歧义。\n\n求解过程分以下几个步骤：\n1.  根据问题描述定义感兴趣区域（ROI）。\n2.  计算每个灰度级 $i$ 的经验比例 $p_i$。\n3.  计算每个灰度级 $i$ 的差值之和 $s_i$。\n4.  使用计算出的 $p_i$ 和 $s_i$ 计算忙碌度特征 $B$。\n\n**步骤 1：定义ROI**\n\nROI是一个 $4 \\times 4$ 的网格。灰度级限制在集合 $\\{1, 4\\}$ 中。一个连续的 $2 \\times 2$ 的灰度级为 $4$ 的区域位于ROI的中心。其余体素的灰度级为 $1$。该配置可用矩阵 $G$ 表示：\n$$\nG = \\begin{pmatrix}\n1  1  1  1 \\\\\n1  4  4  1 \\\\\n1  4  4  1 \\\\\n1  1  1  1\n\\end{pmatrix}\n$$\nROI中的体素总数为 $N_v = 4 \\times 4 = 16$。\n\n**步骤 2：计算比例 $p_i$**\n\n比例 $p_i$ 是灰度级为 $i$ 的体素数量（记为 $N_i$）除以体素总数 $N_v$。\n通过计算矩阵 $G$ 中的元素：\n-   灰度级为 $i=1$ 的体素数量为 $N_1 = 12$。\n-   灰度级为 $i=4$ 的体素数量为 $N_4 = 4$。\n\n比例为：\n$$ p_1 = \\frac{N_1}{N_v} = \\frac{12}{16} = \\frac{3}{4} $$\n$$ p_4 = \\frac{N_4}{N_v} = \\frac{4}{16} = \\frac{1}{4} $$\n\n**步骤 3：计算差值之和 $s_i$**\n\n量 $s_i$ 是对所有灰度级为 $i$ 的体素 $k$，其灰度级 $i$ 与其邻域的平均灰度级 $\\bar{A}_k$ 之差的绝对值的总和。邻域由切比雪夫距离 $\\delta=1$ 定义。\n$$ s_i = \\sum_{k: G(k)=i} |i - \\bar{A}_k| $$\n\n**$s_1$ 的计算：**\n我们分析 $N_1=12$ 个灰度级为 $1$ 的体素。根据它们的位置，可以分为两组：角点体素和边缘体素。\n\n1.  **角点体素：** 在位置 $(1,1), (1,4), (4,1), (4,4)$ 有 $4$ 个这样的体素。由于对称性，所有四个体素的计算都是相同的。我们以位置 $(1,1)$ 的体素为例。\n    -   其邻域由 $3$ 个体素组成：位于 $(1,2), (2,1)$ 和 $(2,2)$。\n    -   这些邻居的灰度级为 $1, 1, 4$。\n    -   邻域均值为 $\\bar{A}_{\\text{corner}} = \\frac{1+1+4}{3} = \\frac{6}{3} = 2$。\n    -   绝对差值为 $|1 - \\bar{A}_{\\text{corner}}| = |1 - 2| = 1$。\n    -   来自 $4$ 个角点体素的总贡献为 $4 \\times 1 = 4$。\n\n2.  **边缘体素（非角点）：** 有 $8$ 个这样的体素。由于对称性，它们的邻域构成都相同。我们以位置 $(1,2)$ 的体素为例。\n    -   其邻域由 $5$ 个体素组成：位于 $(1,1), (1,3), (2,1), (2,2), (2,3)$。\n    -   这些邻居的灰度级为 $1, 1, 1, 4, 4$。\n    -   邻域均值为 $\\bar{A}_{\\text{edge}} = \\frac{1+1+1+4+4}{5} = \\frac{11}{5}$。\n    -   绝对差值为 $|1 - \\bar{A}_{\\text{edge}}| = |1 - \\frac{11}{5}| = |-\\frac{6}{5}| = \\frac{6}{5}$。\n    -   来自 $8$ 个边缘体素的总贡献为 $8 \\times \\frac{6}{5} = \\frac{48}{5}$。\n\n对所有灰度级为 $1$ 的体素的贡献求和：\n$$ s_1 = 4 + \\frac{48}{5} = \\frac{20}{5} + \\frac{48}{5} = \\frac{68}{5} $$\n\n**$s_4$ 的计算：**\n我们分析 $N_4=4$ 个灰度级为 $4$ 的体素。它们位于位置 $(2,2), (2,3), (3,2), (3,3)$。所有这些体素都是对称等价的。我们以位置 $(2,2)$ 的体素为例。\n-   其邻域由 $8$ 个体素组成，因为它不在ROI边界上。这些邻居位于 $(1,1), (1,2), (1,3), (2,1), (2,3), (3,1), (3,2), (3,3)$。\n-   这些邻居的灰度级为 $1, 1, 1, 1, 4, 1, 4, 4$。\n-   邻域均值为 $\\bar{A}_{\\text{center}} = \\frac{1+1+1+1+4+1+4+4}{8} = \\frac{17}{8}$。\n-   绝对差值为 $|4 - \\bar{A}_{\\text{center}}| = |4 - \\frac{17}{8}| = |\\frac{32-17}{8}| = \\frac{15}{8}$。\n-   由于所有 $4$ 个灰度级为 $4$ 的体素在这方面都是相同的，总和 $s_4$ 为：\n$$ s_4 = 4 \\times \\frac{15}{8} = \\frac{60}{8} = \\frac{15}{2} $$\n\n**步骤 4：计算忙碌度 $B$**\n\n忙碌度特征 $B$ 是衡量强度空间变化率的指标。遵循 Amadasun 与 King 的原始定义（该定义代表了NGTDM的“第一性原理”），忙碌度的计算公式为：\n$$ B = \\frac{\\sum_{i=1}^{N_g} p_i s_i}{\\sum_{i=1}^{N_g} \\sum_{j \\neq i} p_i p_j |i - j|} $$\n其中 $N_g$ 是灰度级的数量，在本问题中为 $2$ ($i, j \\in \\{1, 4\\}$)。\n\n**分子计算：**\n$$ \\sum_{i=1}^{N_g} p_i s_i = p_1 s_1 + p_4 s_4 = \\left(\\frac{3}{4}\\right)\\left(\\frac{68}{5}\\right) + \\left(\\frac{1}{4}\\right)\\left(\\frac{15}{2}\\right) $$\n$$ = \\frac{204}{20} + \\frac{15}{8} = \\frac{51}{5} + \\frac{15}{8} = \\frac{51 \\times 8 + 15 \\times 5}{40} = \\frac{408 + 75}{40} = \\frac{483}{40} $$\n\n**分母计算：**\n$$ \\sum_{i=1}^{2} \\sum_{j \\neq i} p_i p_j |i - j| = p_1 p_4 |1-4| + p_4 p_1 |4-1| = 2 p_1 p_4 | -3 | = 6 p_1 p_4 $$\n$$ = 6 \\left(\\frac{3}{4}\\right)\\left(\\frac{1}{4}\\right) = \\frac{18}{16} = \\frac{9}{8} $$\n\n**最终忙碌度计算：**\n$$ B = \\frac{\\text{Numerator}}{\\text{Denominator}} = \\frac{483/40}{9/8} = \\frac{483}{40} \\times \\frac{8}{9} = \\frac{483}{5 \\times 9} = \\frac{483}{45} $$\n为简化分数，我们注意到 $483$ 的各位数字之和为 $4+8+3=15$，可以被 $3$ 整除。分母 $45$ 也可以被 $3$ 整除。\n$$ B = \\frac{483 \\div 3}{45 \\div 3} = \\frac{161}{15} $$\n数字 $161$ 不能被 $3$ 或 $5$ 整除。（它是 $7 \\times 23$）。该分数为最简形式。\n\n所求的值为：\n-   $p_1 = \\frac{3}{4}$\n-   $p_4 = \\frac{1}{4}$\n-   $s_1 = \\frac{68}{5}$\n-   $s_4 = \\frac{15}{2}$\n-   $B = \\frac{161}{15}$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3}{4}  \\frac{1}{4}  \\frac{68}{5}  \\frac{15}{2}  \\frac{161}{15} \\end{pmatrix}}$$", "id": "4565911"}]}