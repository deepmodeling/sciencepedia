{"hands_on_practices": [{"introduction": "要真正掌握局部二值模式（LBP），我们必须从其核心计算机制入手。这个练习将带你一步步地将一个像素邻域的强度值转化为一个十进制的LBP码及其旋转不变均匀等价形式。这项基础技能是后续所有使用LBP进行纹理分析的基石 [@problem_id:4612936]。", "problem": "在放射组学驱动的磁共振成像（MRI）纹理分析中，局部二值模式（LBP）提供了一种局部微观结构的紧凑表示，该表示对单调灰度变换具有鲁棒性。考虑一个从T$_2$加权MRI切片中提取的单通道灰度$3\\times 3$区域块。设中心强度为$g_c = 10$，在半径为$R=1$的圆上按顺时针顺序采样的$8$个邻域点（从角度为$0$的邻域点，即正$x$轴，“东方”开始）的强度序列为$[12, 9, 11, 8, 10, 13, 7, 10]$。使用具有$P=8$个邻域点和半径$R=1$的标准局部二值模式（LBP）算子，将每个邻域点强度$g_p$的阈值指示函数定义为$s(g_p - g_c)$，其中当$t \\ge 0$时$s(t)$等于$1$，否则等于$0$。按照给定的顺时针顺序形成环形二值模式，并将此模式解释为一个二进制整数，其中第一个邻域点（角度为$0$）分配给最低有效位，且位权重按顺时针方向增加。然后，根据规范法则确定旋转不变均匀模式标签：如果环形二值模式在$0$和$1$之间最多表现出两次跳变，则标签等于模式中$1$的个数；否则，标签等于$P+1$。计算得到的$LBP_{8,1}$码及其旋转不变均匀模式标签。报告这两个值，不带单位。最终答案必须是计算结果，并表示为单行矩阵。无需四舍五入。", "solution": "问题要求计算给定$3\\times3$图像区域块的局部二值模式（$LBP$）码以及相应的旋转不变均匀模式标签。\n\n首先对问题陈述进行验证。\n\n**步骤1：提取给定信息**\n- 图像区域块是一个$3 \\times 3$的单通道灰度区域。\n- 中心像素强度为$g_c = 10$。\n- 在半径为$R=1$的圆上有$P=8$个邻域点。\n- 从东方（$0$度）开始顺时针排列的$P=8$个邻域点强度序列为$[12, 9, 11, 8, 10, 13, 7, 10]$。我们用$\\{g_p\\}_{p=0}^{7}$表示该序列，因此$g_0=12$，$g_1=9$，依此类推。\n- 阈值函数定义为$s(t)$，其中当$t \\ge 0$时$s(t) = 1$，当$t  0$时$s(t) = 0$。\n- 二值模式由$p=0, 1, \\dots, 7$的阈值化差值序列$s(g_p - g_c)$构成。\n- $LBP$码是得到的$8$位二进制数的十进制值，其中来自第一个邻域点（$p=0$）的位是最低有效位（LSB），位权重按顺时针方向增加。\n- 旋转不变均匀模式标签由一个基于环形二值模式中空间跳变（从$0$到$1$或从$1$到$0$的位翻转）数量的规则确定。设此数量为$U(LBP)$。\n    - 如果$U(LBP) \\le 2$，则该模式为“均匀模式”，其标签是模式中“1”的数量。\n    - 如果$U(LBP)  2$，则该模式为“非均匀模式”，其标签是$P+1$。\n\n**步骤2：使用提取的信息进行验证**\n该问题具有科学依据，因为它涉及标准的局部二值模式算子，这是纹理分析和放射组学中的一项基本技术。问题是良态的，提供了所有必要的参数、数据和明确的计算规则。语言客观、正式。问题是完整的、一致的并且计算上是可行的。不存在违反科学原理、逻辑不一致或含糊不清之处。\n\n**步骤3：结论与行动**\n问题是有效的。将提供完整的解答。\n\n**求解过程**\n\n首先，我们通过将每个邻域点的强度$g_p$与中心强度$g_c=10$进行比较来计算二值模式。我们应用阈值函数$s(g_p - g_c)$。\n\n邻域点强度为$g_0=12, g_1=9, g_2=11, g_3=8, g_4=10, g_5=13, g_6=7, g_7=10$。\n\n构成模式的各位的阈值化值计算如下：\n- 对于 $p=0$: $s(g_0 - g_c) = s(12 - 10) = s(2) = 1$。\n- 对于 $p=1$: $s(g_1 - g_c) = s(9 - 10) = s(-1) = 0$。\n- 对于 $p=2$: $s(g_2 - g_c) = s(11 - 10) = s(1) = 1$。\n- 对于 $p=3$: $s(g_3 - g_c) = s(8 - 10) = s(-2) = 0$。\n- 对于 $p=4$: $s(g_4 - g_c) = s(10 - 10) = s(0) = 1$。\n- 对于 $p=5$: $s(g_5 - g_c) = s(13 - 10) = s(3) = 1$。\n- 对于 $p=6$: $s(g_6 - g_c) = s(7 - 10) = s(-3) = 0$。\n- 对于 $p=7$: $s(g_7 - g_c) = s(10 - 10) = s(0) = 1$。\n\n对应于邻域点$p=0, \\dots, 7$的位序列为$\\{s_p\\}_{p=0}^7 = \\{1, 0, 1, 0, 1, 1, 0, 1\\}$。\n\n接下来，我们计算$LBP_{8,1}$码。问题指定来自邻域点$p=0$的位是最低有效位（LSB）。$LBP$码的公式是：\n$$ LBP_{P,R} = \\sum_{p=0}^{P-1} s(g_p - g_c) \\cdot 2^p $$\n使用$P=8$和我们计算出的位：\n$$ LBP_{8,1} = s_0 \\cdot 2^0 + s_1 \\cdot 2^1 + s_2 \\cdot 2^2 + s_3 \\cdot 2^3 + s_4 \\cdot 2^4 + s_5 \\cdot 2^5 + s_6 \\cdot 2^6 + s_7 \\cdot 2^7 $$\n从$s_7$到$s_0$读取的二进制字符串为$10110101_2$。\n$$ LBP_{8,1} = 1 \\cdot 2^0 + 0 \\cdot 2^1 + 1 \\cdot 2^2 + 0 \\cdot 2^3 + 1 \\cdot 2^4 + 1 \\cdot 2^5 + 0 \\cdot 2^6 + 1 \\cdot 2^7 $$\n$$ LBP_{8,1} = 1 \\cdot 1 + 0 \\cdot 2 + 1 \\cdot 4 + 0 \\cdot 8 + 1 \\cdot 16 + 1 \\cdot 32 + 0 \\cdot 64 + 1 \\cdot 128 $$\n$$ LBP_{8,1} = 1 + 4 + 16 + 32 + 128 = 181 $$\n第一个要求的值，$LBP_{8,1}$码，是$181$。\n\n现在，我们确定旋转不变均匀模式标签，记为$LBP_{P,R}^{riu2}$。我们必须计算环形二值模式$(s_0, s_1, s_2, s_3, s_4, s_5, s_6, s_7)$中的跳变次数$U$。\n该模式是$(1, 0, 1, 0, 1, 1, 0, 1)$。\n跳变次数$U$由以下公式给出：\n$$ U = |s_{P-1} - s_0| + \\sum_{p=1}^{P-1} |s_p - s_{p-1}| $$\n当$P=8$时，模式为$(s_0, s_1, s_2, s_3, s_4, s_5, s_6, s_7) = (1, 0, 1, 0, 1, 1, 0, 1)$。\n让我们按顺序计算跳变：\n- $s_0 \\to s_1$：$1 \\to 0$，跳变。(1)\n- $s_1 \\to s_2$：$0 \\to 1$，跳变。(2)\n- $s_2 \\to s_3$：$1 \\to 0$，跳变。(3)\n- $s_3 \\to s_4$：$0 \\to 1$，跳变。(4)\n- $s_4 \\to s_5$：$1 \\to 1$，无跳变。\n- $s_5 \\to s_6$：$1 \\to 0$，跳变。(5)\n- $s_6 \\to s_7$：$0 \\to 1$，跳变。(6)\n- $s_7 \\to s_0$ (环形部分)：$1 \\to 1$，无跳变。\n总跳变次数为$U=6$。\n\n根据均匀模式的规则，如果$U \\le 2$，则模式是均匀的。因为$U=6$，大于$2$，所以该模式是非均匀的。\n对于非均匀模式，旋转不变均匀模式标签定义为$P+1$。\n给定$P=8$，标签为$8+1=9$。\n\n计算出的两个值是$LBP_{8,1}$码（为$181$）及其旋转不变均匀模式标签（为$9$）。最终答案应表示为单行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n181  9\n\\end{pmatrix}\n}\n$$", "id": "4612936"}, {"introduction": "在真实的医学图像中，LBP的圆形邻域采样点很少能完美地落在离散的像素网格上。这个实践探讨了插值这一关键步骤——即估算网格之外的邻域强度值，并比较了两种常见方法：最近邻插值和双线性插值。理解它们在准确性和潜在伪影（如混叠）方面的权衡，对于在实际的放射组学研究中稳健地应用LBP至关重要 [@problem_id:4565388]。", "problem": "在放射组学纹理分析中，局部二值模式 ($LBP_{P,R}$) 通过使用半径为 $R$ 的圆上的 $P$ 个等距邻域点来编码局部强度比较。给定一个在具有体素间距 $\\Delta_x$ 和 $\\Delta_y$ 的笛卡尔网格上采样的连续图像强度场 $I(x,y)$，一个中心强度为 $g_c$ 的像素的 $LBP_{P,R}$ 编码使用在圆上离网格位置评估的邻域点强度 $g_p$。这些离网格值需要通过离散样本 $I[i,j]$ 进行插值计算。两种常见的插值方案是最近邻（零阶保持）和双线性（一阶保持）。插值方法的选择会影响角度采样中的混叠和估计的邻域点强度的偏差。\n\n考虑一个二维切片的以下两种采集设置：\n- 设置 1：$\\Delta_x = 0.8$ mm，$\\Delta_y = 0.8$ mm，$R = 1.5$ mm，$P = 16$。\n- 设置 2：$\\Delta_x = 1.2$ mm，$\\Delta_y = 1.2$ mm，$R = 3.0$ mm，$P = 8$。\n\n哪个选项最准确地比较了最近邻插值与双线性插值在 $LBP_{P,R}$ 中关于混叠和偏差的影响，并提出了一个基于体素间距选择插值方法的、具有物理动机的标准，同时将其正确地应用于以上两种设置？\n\nA) 最近邻插值表现出更高的角度混叠，因为当周向间距小于网格间距时，多个相邻的角度样本可能被量化到同一个体素；并且相对于离网格位置的真实连续强度，它具有更大的插值偏差。双线性插值通过混合相邻样本来减少角度混叠，并且对于局部平滑的场具有较小的插值偏差。一个基于间距的选择标准是：当圆上相邻邻域点之间的周向间隔小于平面内最小的体素间距时（即 $s  \\min(\\Delta_x,\\Delta_y)$），使用双线性插值，否则倾向于使用最近邻插值。在此标准下，设置1选择双线性插值，设置2选择最近邻插值。\n\nB) 最近邻插值因避免了平均化而能最小化插值偏差并减少混叠，而双线性插值由于平滑作用会增加混叠。一个基于间距的选择标准是：当 $s  \\min(\\Delta_x,\\Delta_y)$ 时使用最近邻插值，否则使用双线性插值。在此标准下，设置1选择最近邻插值，设置2选择双线性插值。\n\nC) 混叠不受插值方法的影响，因为它仅由 $P$ 决定，并且最近邻和双线性都是离网格位置 $I(x,y)$ 的无偏估计量。该方法的选择应独立于体素间距，例如总是使用双线性插值，因此设置1和设置2都选择双线性插值。\n\nD) 最近邻插值通过将样本映射到整数网格位置来减少混叠，而双线性插值会引入偏差，除非 $R$ 是 $\\Delta_x$ 和 $\\Delta_y$ 的整数倍。选择标准是：仅当 $R/\\Delta_x$ 和 $R/\\Delta_y$ 都是整数时才使用双线性插值；否则使用最近邻插值。根据此规则，设置1和设置2都选择最近邻插值。", "solution": "问题要求在放射组学中，针对局部二值模式 ($LBP_{P,R}$) 特征提取，准确比较最近邻插值和双线性插值，并根据两种特定的成像设置，评估一个具有物理动机的选择标准。\n\n### 步骤1：问题陈述的验证\n\n问题陈述已经过验证，并被确定是合理的。\n\n**已知条件：**\n- 特征提取器：局部二值模式，$LBP_{P,R}$，在半径为 $R$ 的圆上有 $P$ 个邻域点。\n- 图像模型：在笛卡尔网格上采样的连续强度场 $I(x,y)$。\n- 体素间距：$\\Delta_x$ 和 $\\Delta_y$。\n- 中心像素强度：$g_c$。\n- 邻域点强度：$g_p$，在离网格位置进行评估。\n- 插值方法：最近邻（零阶保持）和双线性（一阶保持）。\n- 插值的关键影响：角度混叠和强度偏差。\n- 设置 1：$\\Delta_x = 0.8$ mm, $\\Delta_y = 0.8$ mm, $R = 1.5$ mm, $P = 16$。\n- 设置 2：$\\Delta_x = 1.2$ mm, $\\Delta_y = 1.2$ mm, $R = 3.0$ mm, $P = 8$。\n\n**结论：**\n问题陈述具有科学依据、适定且客观。它描述了医学图像分析（放射组学）中一个关于在离散网格上实现LBP算子的标准问题。插值、混叠和偏差的概念是数字信号处理的核心。所提供的参数是现实的。因此，该问题是有效的，并且可以推导出解答。\n\n### 步骤2：原理推导\n\n我们将分析两种插值方案的属性，然后推导并应用选择标准。\n\n**插值方法分析：**\n\n1.  **最近邻（NN）插值：**\n    - **方法：** 将最近的网格点（体素）的强度赋给离网格的采样位置。这是一种零阶保持方法，创建了图像的分段常数近似。\n    - **偏差：** 对于一个平滑变化的强度场 $I(x,y)$，NN插值会引入显著的偏差。某一点的误差取决于其在体素内的位置以及强度场的局部梯度。在所有可能的亚像素位置上平均的期望误差通常比双线性插值更大。\n    - **混叠：** 这是一个关键问题。LBP算子在圆上对图像进行 $P$ 点采样。如果两个相邻LBP邻域点之间的周向距离小于网格间距，那么这两个邻域点可能都最接近*同一个*体素。在这种情况下，即使这些点在圆上是不同的，也会有 $g_{p_1} = g_{p_2}$。这会导致角度轮廓的量化，实际上降低了角度分辨率并造成信息丢失，这是一种混叠形式。当LBP采样密度（$P/R$）相对于网格密度（$1/\\Delta_{x,y}$）增加时，这种效应会变得更加显著。\n\n2.  **双线性插值：**\n    - **方法：** 通过对周围四个网格点进行加权平均来计算离网格位置的强度。权重由亚像素坐标决定。这是一种一阶保持方法，创建了图像的分段双线性（线性斜率）近似。\n    - **偏差：** 对于平滑场，双线性插值通常比NN插值具有更低的偏差，因为它近似了强度的局部线性趋势。其误差与场的二阶导数有关，而NN插值的误差与一阶导数有关。\n    - **混叠：** 通过对值进行平均，双线性插值起到了低通滤波器的作用。这种平滑特性意味着当一个采样点连续移动时，其插值结果也连续变化。它避免了在体素边界处NN插值出现的突变。因此，两个不同但位置相近的LBP邻域点几乎总会产生略微不同的插值。这减轻了NN插值中出现的角度量化效应，从而减少了混叠。\n\n**选择标准的建立：**\n\n一个具有物理动机的标准应该比较LBP算子的采样率和图像网格的分辨率。\n\n- 相邻LBP邻域点之间的周向间隔（弧长）由 $s = \\frac{2\\pi R}{P}$ 给出。这代表了LBP采样的特征长度尺度。\n- 图像网格分辨率由体素间距 $\\Delta_x$ 和 $\\Delta_y$ 决定。最精细的可分辨细节在 $\\min(\\Delta_x, \\Delta_y)$ 的量级。\n\n当LBP采样比网格分辨率更精细时，即 $s  \\min(\\Delta_x, \\Delta_y)$，临界条件出现。\n\n- **情况1：$s  \\min(\\Delta_x, \\Delta_y)$**\n  LBP算子试图在比体素尺寸更小的尺度上探查细节。使用NN插值将导致严重角度混叠，因为多个LBP邻域点会映射到同一个体素。为了获得对邻域更稳定和有代表性的估计，最好使用一种能在体素之间提供平滑过渡的方法，例如双线性插值。\n\n- **情况2：$s \\ge \\min(\\Delta_x, \\Delta_y)$**\n  LBP采样比网格分辨率更粗糙或与之相当。每个LBP邻域点很可能对应一个不同的体素区域。来自NN插值的角度混叠风险较低。在这种情况下，人们可能更倾向于计算上更简单的NN方法，或者认为它避免了双线性插值的平滑效应，而这种效应可能会模糊相关的纹理信息。因此，倾向于NN插值是一个合理的选择。\n\n这就得出了标准：**如果 $s  \\min(\\Delta_x, \\Delta_y)$，使用双线性插值；否则，倾向于使用最近邻插值。**\n\n**对给定设置的应用：**\n\n- **设置1：**\n  - $\\Delta_x = 0.8$ mm, $\\Delta_y = 0.8$ mm $\\implies \\min(\\Delta_x, \\Delta_y) = 0.8$ mm。\n  - $R = 1.5$ mm, $P = 16$。\n  - 周向间隔：$s_1 = \\frac{2\\pi R}{P} = \\frac{2\\pi (1.5)}{16} = \\frac{3\\pi}{16} \\approx 0.589$ mm。\n  - 比较：$s_1 \\approx 0.589 \\text{ mm}  0.8 \\text{ mm}$。\n  - **结论：** 根据该标准，应选择**双线性插值**。\n\n- **设置2：**\n  - $\\Delta_x = 1.2$ mm, $\\Delta_y = 1.2$ mm $\\implies \\min(\\Delta_x, \\Delta_y) = 1.2$ mm。\n  - $R = 3.0$ mm, $P = 8$。\n  - 周向间隔：$s_2 = \\frac{2\\pi R}{P} = \\frac{2\\pi (3.0)}{8} = \\frac{3\\pi}{4} \\approx 2.356$ mm。\n  - 比较：$s_2 \\approx 2.356 \\text{ mm}  1.2 \\text{ mm}$。\n  - **结论：** 根据该标准，倾向于选择**最近邻插值**。\n\n### 步骤3：逐项分析\n\n**A) 最近邻插值表现出更高的角度混叠，因为当周向间距小于网格间距时，多个相邻的角度样本可能被量化到同一个体素；并且相对于离网格位置的真实连续强度，它具有更大的插值偏差。双线性插值通过混合相邻样本来减少角度混叠，并且对于局部平滑的场具有较小的插值偏差。一个基于间距的选择标准是：当圆上相邻邻域点之间的周向间隔小于平面内最小的体素间距时（即 $s  \\min(\\Delta_x,\\Delta_y)$），使用双线性插值，否则倾向于使用最近邻插值。在此标准下，设置1选择双线性插值，设置2选择最近邻插值。**\n- 对两种方法的混叠和偏差的描述是正确的。\n- 所提出的选择标准具有物理合理性，并与我们的推导相符。\n- 该标准在两种设置下的应用是正确的（$s_1  0.8 \\implies$ 双线性，$s_2  1.2 \\implies$ 最近邻）。\n- **结论：正确。**\n\n**B) 最近邻插值因避免了平均化而能最小化插值偏差并减少混叠，而双线性插值由于平滑作用会增加混叠。一个基于间距的选择标准是：当 $s  \\min(\\Delta_x,\\Delta_y)$ 时使用最近邻插值，否则使用双线性插值。在此标准下，设置1选择最近邻插值，设置2选择双线性插值。**\n- 关于偏差和混叠的说法是不正确的。NN具有更高的偏差并导致更多的角度混叠。双线性的平滑作用减少了混叠。\n- 选择标准与正确的逻辑相反。\n- **结论：不正确。**\n\n**C) 混叠不受插值方法的影响，因为它仅由 $P$ 决定，并且最近邻和双线性都是离网格位置 $I(x,y)$ 的无偏估计量。该方法的选择应独立于体素间距，例如总是使用双线性插值，因此设置1和设置2都选择双线性插值。**\n- 关于混叠不受插值影响的说法是错误的；采样方案与离散网格的相互作用正是插值起作用的地方。\n- 关于两种方法都是无偏的说法是错误的；两者都会引入偏差，对于平滑场，NN通常偏差更大。\n- 关于选择应独立于体素间距的说法是错误的；LBP参数和体素间距之间的关系是核心问题。\n- **结论：不正确。**\n\n**D) 最近邻插值通过将样本映射到整数网格位置来减少混叠，而双线性插值会引入偏差，除非 $R$ 是 $\\Delta_x$ 和 $\\Delta_y$ 的整数倍。选择标准是：仅当 $R/\\Delta_x$ 和 $R/\\Delta_y$ 都是整数时才使用双线性插值；否则使用最近邻插值。根据此规则，设置1和设置2都选择最近邻插值。**\n- 关于NN减少混叠的说法是错误的；映射到网格位置会导致量化，而量化是一种混叠形式。\n- 关于双线性偏差的条件是武断且不正确的。对于非线性场，双线性插值总是有一些偏差，并且所提出的条件不是一个最小化偏差的标准条件。\n- 该选择标准是临时的，没有物理动机。对于设置1，$R/\\Delta_x = 1.5/0.8 = 1.875$。对于设置2，$R/\\Delta_x = 3.0/1.2 = 2.5$。两者都不是整数，因此该规则会为两者都选择NN，但规则本身是有缺陷的。\n- **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "4565388"}, {"introduction": "当邻域像素的强度与中心像素完全相同时会发生什么？这个看似微不足道的“平局”情况，可能会给LBP特征带来系统性的偏差，尤其是在医学影像中常见的低对比度区域。本练习通过一个概率模型来分析这个问题，并引导我们得出一个有原则且无偏的平局处理规则，突显了创建可靠放射组学特征所需的统计严谨性 [@problem_id:4565424]。", "problem": "在放射组学流程中，局部二值模式（LBP）通过将每个邻域强度与中心强度进行阈值比较来概括局部纹理。设半径为 $R$ 的 $P$ 邻域LBP由阈值函数 $s(x)$ 定义，该函数应用于每个邻域 $n$ 的差值 $x = I_{n} - I_{c}$，其中 $I_{n}$ 和 $I_{c}$ 分别是邻域和中心的观测图像强度。假设在低对比度同质区域中存在以下基础模型：\n- 真实的基础强度是恒定的，因此 $T_{n} = T_{c} = T$。\n- 观测强度受到加性、独立、零均值高斯噪声的干扰：$I_{n} = T + \\varepsilon_{n}$ 和 $I_{c} = T + \\varepsilon_{c}$，其中 $\\varepsilon_{n}, \\varepsilon_{c} \\sim \\mathcal{N}(0,\\sigma^{2})$ 且相互独立。\n- 强度通过步长为 $\\Delta  0$ 的均匀标量量化进行离散化，即 $Q(x) = \\Delta \\left\\lfloor \\frac{x}{\\Delta} \\right\\rfloor$，LBP比较在量化后的强度上进行，因此可观测的决策变量为 $d_{q} = Q(I_{n}) - Q(I_{c})$。\n\n将二元阈值函数定义为\n$$\ns(x) = \n\\begin{cases}\n1,  x  0, \\\\\n0,  x  0,\n\\end{cases}\n$$\n并且需要一个针对 $x = 0$ 的平局约定。在低对比度同质区域中，当 $d_{q} = 0$ 时出现平局。设 $p_{t} = \\mathbb{P}(d_{q} = 0)$ 表示上述模型下的平局概率。\n\n利用模型假设以及关于独立性、对称性和量化的第一性原理，分析将 $s(0)$ 设置为 $1$ 与设置为 $0$ 对低对比度区域LBP编码中每个邻域为1的期望比例的影响。然后，提出一种基于噪声统计的有原则的平局打破规则，该规则能避免期望为1的比例出现偏差，并增强基于直方图的放射组学特征的可复现性。\n\n哪个选项是正确的？\n\nA. 在具有加性对称噪声和均匀量化的同质低对比度区域中，$\\mathbb{P}(d_{q}  0) = \\mathbb{P}(d_{q}  0)$ 且 $\\mathbb{P}(d_{q} = 0) = p_{t}$。每个邻域为1的期望比例是 $\\frac{1 - p_{t}}{2} + p_{t} s(0)$，因此 $s(0) = 1$ 产生一个相对于 $0.5$ 的 $\\frac{p_{t}}{2}$ 的上偏，而 $s(0) = 0$ 产生一个 $\\frac{p_{t}}{2}$ 的下偏。一种有原则的平局打破规则是使用后验概率 $w = \\mathbb{P}(I_{n} \\ge I_{c} \\mid d_{q} = 0)$ 来分配平局；在对称噪声模型下，$w = \\frac{1}{2}$，因此平局对结果为1和结果为0各贡献一半（软直方图加权），从而在不引入随机性的情况下消除偏差。\n\nB. 在同质低对比度区域中，设置 $s(0) = 0$ 是无偏的，因为 $\\mathbb{P}(d_{q} = 0)$ 可以忽略不计；因此，不需要特殊的平局打破规则。\n\nC. 只要 $p_{t}  0$，选择 $s(0) = 1$ 或 $s(0) = 0$ 是等效的。一种有原则的规则是，如果 $\\sigma  \\Delta$ 则设置 $s(0) = 1$，否则设置 $s(0) = 0$，因为当 $\\sigma  \\Delta$ 时，量化在噪声中占主导地位。\n\nD. 在低对比度区域中，设置 $s(0) = 1$ 会减少一致模式的数量并增加非一致模式的数量。一种有原则的平局打破规则是添加一个小的随机抖动 $\\eta \\sim \\mathcal{N}(0,\\sigma^{2})$ 通过采样来打破平局，这能确保跨图像的公平结果。", "solution": "该问题要求在放射组学的特定背景下，分析局部二值模式（LBP）计算中的平局打破问题。在此背景下，图像强度被建模为一个恒定的真实值，受到加性、独立、零均值高斯噪声的干扰，然后进行均匀标量量化。\n\n### 问题验证\n\n问题陈述已经过验证，被认为是**有效的**。它在统计信号处理和图像分析方面具有科学依据，是一个具有清晰概率模型的适定问题，并使用了客观、正式的语言。所有进行严谨推导所需的信息均已提供。\n\n### 推导\n\n**1. 强度差的分布**\n\n设邻域像素和中心像素的未量化强度分别为 $I_n$ 和 $I_c$。根据模型，我们有：\n$$I_n = T + \\varepsilon_n$$\n$$I_c = T + \\varepsilon_c$$\n其中 $T$ 是恒定的真实强度，$\\varepsilon_n, \\varepsilon_c$ 是来自正态分布 $\\mathcal{N}(0, \\sigma^2)$ 的独立同分布（i.i.d.）随机变量。\n\n未量化强度的差是一个随机变量 $X = I_n - I_c = (T + \\varepsilon_n) - (T + \\varepsilon_c) = \\varepsilon_n - \\varepsilon_c$。\n作为两个独立的零均值高斯随机变量之差，$X$ 也是一个高斯随机变量。\n- $X$ 的均值为 $\\mathbb{E}[X] = \\mathbb{E}[\\varepsilon_n] - \\mathbb{E}[\\varepsilon_c] = 0 - 0 = 0$。\n- 由于独立性，$X$ 的方差为 $\\text{Var}(X) = \\text{Var}(\\varepsilon_n - \\varepsilon_c) = \\text{Var}(\\varepsilon_n) + \\text{Var}(\\varepsilon_c) = \\sigma^2 + \\sigma^2 = 2\\sigma^2$。\n因此，$X \\sim \\mathcal{N}(0, 2\\sigma^2)$。$X$ 的概率密度函数（PDF）是连续的且关于0对称。这意味着 $\\mathbb{P}(X  0) = \\mathbb{P}(X  0) = 1/2$。\n\n**2. 量化差的分布**\n\nLBP比较在量化后的强度上进行。决策变量是 $d_q = Q(I_n) - Q(I_c)$，其中 $Q(x) = \\Delta \\lfloor \\frac{x}{\\Delta} \\rfloor$。\n$d_q$ 的可能值是量化步长 $\\Delta$ 的整数倍。$d_q$ 的分布是离散的。\n\n我们来分析 $d_q$ 分布的对称性。我们关心三个互斥事件的概率：$d_q  0$、$d_q  0$ 和 $d_q = 0$。\n$d_q=0$ 事件是平局事件，其概率为 $p_t = \\mathbb{P}(d_q=0)$。当 $Q(I_n) = Q(I_c)$ 时发生，这意味着 $I_n$ 和 $I_c$ 落入同一个量化区间。对于任何有限的 $\\Delta  0$ 和 $\\sigma  0$，此概率 $p_t$ 严格为正。\n\n考虑 $(I_n, I_c)$ 的联合概率密度函数，记为 $f(i_n, i_c)$。由于 $I_n$ 和 $I_c$ 是独立同分布的（减去均值 $T$ 后），它们的联合概率密度函数对其参数是对称的：$f(i_n, i_c) = f(i_c, i_n)$。\n\n概率 $\\mathbb{P}(d_q  0)$ 是所有整数 $k  0$ 的概率 $\\mathbb{P}(Q(I_n) - Q(I_c) = k\\Delta)$ 之和。\n概率 $\\mathbb{P}(d_q  0)$ 是所有整数 $k  0$ 的概率 $\\mathbb{P}(Q(I_n) - Q(I_c) = -k\\Delta)$ 之和。\n\n对于一个固定的 $k  0$，我们来比较 $\\mathbb{P}(Q(I_n) - Q(I_c) = k\\Delta)$ 和 $\\mathbb{P}(Q(I_n) - Q(I_c) = -k\\Delta)$。\n$\\mathbb{P}(Q(I_n) - Q(I_c) = -k\\Delta) = \\mathbb{P}(Q(I_c) - Q(I_n) = k\\Delta)$。\n因为对 $(I_n, I_c)$ 与对 $(I_c, I_n)$ 具有相同的联合分布，所以可以得出 $\\mathbb{P}(Q(I_c) - Q(I_n) = k\\Delta) = \\mathbb{P}(Q(I_n) - Q(I_c) = k\\Delta)$。\n因此，$d_q$ 的分布关于0对称。这意味着：\n$$\\mathbb{P}(d_q  0) = \\mathbb{P}(d_q  0)$$\n由于总概率为 $1$，我们有：\n$$\\mathbb{P}(d_q  0) + \\mathbb{P}(d_q  0) + \\mathbb{P}(d_q = 0) = 1$$\n代入对称性质和 $p_t = \\mathbb{P}(d_q=0)$：\n$$2 \\cdot \\mathbb{P}(d_q  0) + p_t = 1$$\n这得出：\n$$\\mathbb{P}(d_q  0) = \\mathbb{P}(d_q  0) = \\frac{1 - p_t}{2}$$\n\n**3. 期望为1的比例与偏差分析**\n\nLBP位由函数 $s(d_q)$ 决定。期望为1的比例是期望值 $\\mathbb{E}[s(d_q)]$。\n函数定义为当 $x0$ 时 $s(x)=1$，当 $x0$ 时 $s(x)=0$。$s(0)$ 的值是一个选定的约定。\n期望值为：\n$$\\mathbb{E}[s(d_q)] = 1 \\cdot \\mathbb{P}(s(d_q)=1) + 0 \\cdot \\mathbb{P}(s(d_q)=0) = \\mathbb{P}(s(d_q)=1)$$\n事件 $s(d_q)=1$ 发生在 $d_q  0$ 时，或者当 $d_q = 0$ 且我们定义 $s(0)=1$ 时。\n所以，$\\mathbb{P}(s(d_q)=1) = \\mathbb{P}(d_q  0) + \\mathbb{P}(d_q=0 \\text{ and } s(0)=1)$。\n假设 $s(0)$ 是一个固定值（例如0或1），我们可以将其写为：\n$$\\mathbb{E}[s(d_q)] = \\mathbb{P}(d_q  0) + s(0) \\cdot \\mathbb{P}(d_q=0)$$\n代入之前推导出的概率：\n$$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + s(0) \\cdot p_t$$\n在同质区域中，基础信号不提供方向信息，因此一个无偏的LBP算子应该以相等的概率产生'1'和'0'，即期望为1的比例应为 $1/2$。\n我们来分析两种常见的 $s(0)$ 约定的偏差（与 $1/2$ 的偏离）：\n\n- 如果 $s(0)=1$:\n  $$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + p_t = \\frac{1+p_t}{2} = \\frac{1}{2} + \\frac{p_t}{2}$$\n  这会引入一个 $\\frac{p_t}{2}$ 的正偏差。\n\n- 如果 $s(0)=0$:\n  $$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + 0 \\cdot p_t = \\frac{1 - p_t}{2} = \\frac{1}{2} - \\frac{p_t}{2}$$\n  这会引入一个 $-\\frac{p_t}{2}$ 的负偏差。\n\n由于 $p_t  0$，两种约定都会在同质区域中引入系统性偏差，这会破坏从LBP直方图派生出的纹理特征。\n\n**4. 有原则的平局打破规则**\n\n为了消除偏差，期望为1的比例必须是 $1/2$。这需要一个处理平局（$d_q=0$）的规则。一种有原则的方法是，在观测到 $d_q=0$ 的情况下，确定未量化差值 $I_n - I_c$ 的“真实”符号的最佳估计。这可以表述为找到后验概率 $w = \\mathbb{P}(I_n \\ge I_c \\mid d_q = 0)$。这个概率 $w$ 代表了 $s(0)$ 的理想“软”值。\n\n我们来计算 $w$。\n$$w = \\mathbb{P}(I_n \\ge I_c \\mid Q(I_n) = Q(I_c)) = \\frac{\\mathbb{P}(I_n \\ge I_c \\text{ and } Q(I_n) = Q(I_c))}{\\mathbb{P}(Q(I_n) = Q(I_c))}$$\n事件 $\\{I_n \\ge I_c\\}$ 可以分解为 $\\{I_n  I_c\\}$ 和 $\\{I_n=I_c\\}$。由于 $I_n-I_c$ 的基础分布是连续的，$\\mathbb{P}(I_n=I_c)=0$。因此，$\\mathbb{P}(I_n \\ge I_c) = \\mathbb{P}(I_n  I_c)$。\n\n如步骤2中所述，联合概率密度函数 $f(i_n, i_c)$ 是对称的。这种对称性意味着：\n$$\\mathbb{P}(I_n  I_c \\text{ and } Q(I_n) = Q(I_c)) = \\mathbb{P}(I_c  I_n \\text{ and } Q(I_c) = Q(I_n))$$\n分母是 $p_t = \\mathbb{P}(Q(I_n) = Q(I_c))$，它是三个不相交区域上的概率之和：\n$$p_t = \\mathbb{P}(I_n  I_c, Q(I_n)=Q(I_c)) + \\mathbb{P}(I_n  I_c, Q(I_n)=Q(I_c)) + \\mathbb{P}(I_n = I_c, Q(I_n)=Q(I_c))$$\n设 $P_{}$ 是第一项，$P_{}$ 是第二项。第三项为 $0$。\n根据对称性论证，$P_{} = P_{}$。因此，$p_t = 2 P_{}$。\n$w$ 的分子是 $\\mathbb{P}(I_n \\ge I_c \\text{ and } Q(I_n)=Q(I_c)) = P_{}$。\n因此，\n$$w = \\frac{P_{}}{p_t} = \\frac{P_{}}{2 P_{}} = \\frac{1}{2}$$\n这意味着在量化域中出现平局的情况下，真实的未量化邻域强度大于或小于中心强度的可能性是相等的。$s(0)$ 最有原则的值就是这个后验概率 $1/2$。\n\n使用 $s(0)=1/2$（概念上作为软权重），期望为1的比例变为：\n$$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + \\frac{1}{2} \\cdot p_t = \\frac{1 - p_t + p_t}{2} = \\frac{1}{2}$$\n这个选择消除了偏差。在实践中，可以通过为每个平局的LBP编码值增加 $1/2$ 或使用软直方图来确定性地实现。这种确定性方法避免了随机平局打破带来的可复现性问题。\n\n### 逐项分析\n\n**A. 在具有加性对称噪声和均匀量化的同质低对比度区域中，$\\mathbb{P}(d_{q}  0) = \\mathbb{P}(d_{q}  0)$ 且 $\\mathbb{P}(d_{q} = 0) = p_{t}$。每个邻域为1的期望比例是 $\\frac{1 - p_{t}}{2} + p_{t} s(0)$，因此 $s(0) = 1$ 产生一个相对于 $0.5$ 的 $\\frac{p_{t}}{2}$ 的上偏，而 $s(0) = 0$ 产生一个 $\\frac{p_{t}}{2}$ 的下偏。一种有原则的平局打破规则是使用后验概率 $w = \\mathbb{P}(I_{n} \\ge I_{c} \\mid d_{q} = 0)$ 来分配平局；在对称噪声模型下，$w = \\frac{1}{2}$，因此平局对结果为1和结果为0各贡献一半（软直方图加权），从而在不引入随机性的情况下消除偏差。**\n这个陈述与我们的推导完全一致。每个子论点——$d_q$ 分布的对称性、期望为1的比例的公式、$s(0)=1$ 和 $s(0)=0$ 导致的偏差，以及所提出的有原则的、无偏的、可复现的平局打破规则——都是正确的。\n**结论：正确。**\n\n**B. 在同质低对比度区域中，设置 $s(0) = 0$ 是无偏的，因为 $\\mathbb{P}(d_{q} = 0)$ 可以忽略不计；因此，不需要特殊的平局打破规则。**\n这是不正确的。如上所示，设置 $s(0)=0$ 会导致 $-\\frac{p_t}{2}$ 的偏差。声称 $p_t = \\mathbb{P}(d_q=0)$ 可以忽略不计是一个未经证实且通常是错误的假设。平局概率取决于噪声方差 $\\sigma^2$ 与量化步长 $\\Delta$ 的比率，并且可能相当大，特别是当噪声相对于量化步长较小时（$\\sigma \\ll \\Delta$）。\n**结论：不正确。**\n\n**C. 只要 $p_{t}  0$，选择 $s(0) = 1$ 或 $s(0) = 0$ 是等效的。一种有原则的规则是，如果 $\\sigma  \\Delta$ 则设置 $s(0) = 1$，否则设置 $s(0) = 0$，因为当 $\\sigma  \\Delta$ 时，量化在噪声中占主导地位。**\n这个陈述是不正确的。选择 $s(0)=1$ 和 $s(0)=0$ 并不等效；它们会导致符号相反的偏差。只有当 $p_t = 0$ 时它们才等效。所提出的规则是临时的，没有原则性；它没有消除偏差，只是基于一个关于 $\\sigma/\\Delta$ 的任意阈值在正负偏差之间切换。其推理是谬误的。\n**结论：不正确。**\n\n**D. 在低对比度区域中，设置 $s(0) = 1$ 会减少一致模式的数量并增加非一致模式的数量。一种有原则的平局打破规则是添加一个小的随机抖动 $\\eta \\sim \\mathcal{N}(0,\\sigma^{2})$ 通过采样来打破平局，这能确保跨图像的公平结果。**\n第一个论点值得怀疑。在具有高平局概率 $p_t$ 的低对比度区域中，设置 $s(0)=1$ 倾向于产生包含许多'1'的LBP编码（例如 `11111111`），而设置 $s(0)=0$ 则倾向于产生包含许多'0'的LBP编码（例如 `00000000`）。这两种都是一致模式。$s(0)$ 的选择影响了*哪种*一致模式占主导，但不一定会减少一致模式的总数。该陈述的第二部分建议使用随机化来打破平局。虽然这可以*在期望上*消除偏差，但它违背了增强可复现性的目标，而可复现性对于稳健的放射组学特征至关重要。选项A中提出的方法更优，因为它既是无偏的又是确定性的。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "4565424"}]}