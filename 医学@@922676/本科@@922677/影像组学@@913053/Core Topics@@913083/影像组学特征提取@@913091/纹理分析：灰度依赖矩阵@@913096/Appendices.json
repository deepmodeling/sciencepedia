{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。这个练习将带你从头开始，在一个小的感兴趣区域（ROI）上手动计算灰度依赖矩阵（GLDM）。通过这个过程，你将掌握计算每个像素的依赖大小、构建GLDM、以及计算像依赖熵这样的纹理特征的核心步骤。[@problem_id:4564097]", "problem": "一个图像的感兴趣区域（ROI）被离散化为整数灰度级，并由以下 $4 \\times 4$ 数组给出：\n$$\n\\begin{pmatrix}\n1  1  2  2 \\\\\n1  1  2  3 \\\\\n1  2  2  3 \\\\\n2  2  3  3\n\\end{pmatrix}.\n$$\n使用灰度依赖矩阵（GLDM）的纹理分析基于以下基本定义。对于每个灰度级为 $g$ 的像素，考虑其切比雪夫距离 $\\delta$ 内的邻居，即所有行和列偏移量绝对值的最大值等于 $\\delta$ 的像素。在强度容差为 $\\alpha$ 的情况下，如果邻居像素与中心像素之间的灰度级绝对差值小于或等于 $\\alpha$，则称该邻居依赖于中心像素。中心像素的依赖大小 $d$ 定义为 $1$ 加上此类依赖邻居的数量，其中 $1$ 代表中心像素本身。灰度依赖矩阵 $p(g,d)$ 统计了在 ROI 中所有像素里，灰度级为 $g$ 且依赖大小为 $d$ 的出现次数。\n\n使用这些定义，当 $\\delta = 1$ 和 $\\alpha = 0$ 时，为上述 ROI 构建联合分布 $p(g,d)$，然后计算依赖熵。依赖熵定义为通过将 $p(g,d)$ 除以 ROI 中的总像素数进行归一化后得到的联合概率质量函数的香农熵，计算中使用自然对数。以奈特（nats）为单位表示最终的熵，并将您的答案四舍五入到 $4$ 位有效数字。", "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它提供了计算指定纹理特征所需的一套完整且一致的定义和数据。所有术语和参数在放射组学和图像分析领域都是标准的。因此，我们可以开始解题。\n\n该问题要求使用灰度依赖矩阵（GLDM）方法，为一个给定的 $4 \\times 4$ 感兴趣区域（ROI）计算依赖熵。\n\nROI 由矩阵 $G$ 给出：\n$$\nG = \\begin{pmatrix}\n1  1  2  2 \\\\\n1  1  2  3 \\\\\n1  2  2  3 \\\\\n2  2  3  3\n\\end{pmatrix}\n$$\nGLDM 计算的参数为切比雪夫距离 $\\delta = 1$ 和强度容差 $\\alpha = 0$。\n\n第一步是计算 ROI 中每个像素的依赖大小 $d$。依赖大小定义为 $d = 1 + k$，其中 $k$ 是在指定距离 $\\delta$ 内满足依赖条件的邻居数量。当 $\\delta=1$ 时，一个像素的邻域由其 $8$ 个直接邻居组成。当 $\\alpha=0$ 时，只有当邻居的灰度级与中心像素相同时，才认为该邻居是依赖的。\n\n我们将遍历 ROI 中的每个像素（共 16 个），确定其灰度级 $g$，并计算其对应的依赖大小 $d$。\n\n1.  像素 $(1,1)$，$g=1$：邻居为 $(1,2), (2,1), (2,2)$，灰度级为 $1, 1, 1$。所有 $3$ 个都是依赖的。$d = 1+3=4$。\n2.  像素 $(1,2)$，$g=1$：邻居为 $(1,1), (2,1), (2,2), (1,3), (2,3)$，灰度级为 $1, 1, 1, 2, 2$。$3$ 个是依赖的。$d = 1+3=4$。\n3.  像素 $(1,3)$，$g=2$：邻居为 $(1,2), (1,4), (2,2), (2,3), (2,4)$，灰度级为 $1, 2, 1, 2, 3$。$2$ 个是依赖的。$d = 1+2=3$。\n4.  像素 $(1,4)$，$g=2$：邻居为 $(1,3), (2,3), (2,4)$，灰度级为 $2, 2, 3$。$2$ 个是依赖的。$d = 1+2=3$。\n5.  像素 $(2,1)$，$g=1$：邻居为 $(1,1), (1,2), (2,2), (3,1), (3,2)$，灰度级为 $1, 1, 1, 1, 2$。$4$ 个是依赖的。$d = 1+4=5$。\n6.  像素 $(2,2)$，$g=1$：邻居为 $(1,1), (1,2), (1,3), (2,1), (2,3), (3,1), (3,2), (3,3)$，灰度级为 $1, 1, 2, 1, 2, 1, 2, 2$。$4$ 个是依赖的。$d = 1+4=5$。\n7.  像素 $(2,3)$，$g=2$：邻居为 $(1,2), (1,3), (1,4), (2,2), (2,4), (3,2), (3,3), (3,4)$，灰度级为 $1, 2, 2, 1, 3, 2, 2, 3$。$4$ 个是依赖的。$d = 1+4=5$。\n8.  像素 $(2,4)$，$g=3$：邻居为 $(1,3), (1,4), (2,3), (3,3), (3,4)$，灰度级为 $2, 2, 2, 2, 3$。$1$ 个是依赖的。$d = 1+1=2$。\n9.  像素 $(3,1)$，$g=1$：邻居为 $(2,1), (2,2), (3,2), (4,1), (4,2)$，灰度级为 $1, 1, 2, 2, 2$。$2$ 个是依赖的。$d = 1+2=3$。\n10. 像素 $(3,2)$，$g=2$：邻居为 $(2,1), (2,2), (2,3), (3,1), (3,3), (4,1), (4,2), (4,3)$，灰度级为 $1, 1, 2, 1, 2, 2, 2, 3$。$4$ 个是依赖的。$d = 1+4=5$。\n11. 像素 $(3,3)$，$g=2$：邻居为 $(2,2), (2,3), (2,4), (3,2), (3,4), (4,2), (4,3), (4,4)$，灰度级为 $1, 2, 3, 2, 3, 2, 3, 3$。$3$ 个是依赖的。$d = 1+3=4$。\n12. 像素 $(3,4)$，$g=3$：邻居为 $(2,3), (2,4), (3,3), (4,3), (4,4)$，灰度级为 $2, 3, 2, 3, 3$。$3$ 个是依赖的。$d = 1+3=4$。\n13. 像素 $(4,1)$，$g=2$：邻居为 $(3,1), (3,2), (4,2)$，灰度级为 $1, 2, 2$。$2$ 个是依赖的。$d = 1+2=3$。\n14. 像素 $(4,2)$，$g=2$：邻居为 $(3,1), (3,2), (3,3), (4,1), (4,3)$，灰度级为 $1, 2, 2, 2, 3$。$3$ 个是依赖的。$d = 1+3=4$。\n15. 像素 $(4,3)$，$g=3$：邻居为 $(3,2), (3,3), (3,4), (4,2), (4,4)$，灰度级为 $2, 2, 3, 2, 3$。$2$ 个是依赖的。$d = 1+2=3$。\n16. 像素 $(4,4)$，$g=3$：邻居为 $(3,3), (3,4), (4,3)$，灰度级为 $2, 3, 3$。$2$ 个是依赖的。$d = 1+2=3$。\n\n下一步是构建灰度依赖矩阵 $p(g,d)$，该矩阵记录了每个 $(g,d)$ 对的计数。\n- 对于 $g=1$：我们有对 $(1,4), (1,4), (1,5), (1,5), (1,3)$。因此，$p(1,3)=1, p(1,4)=2, p(1,5)=2$。\n- 对于 $g=2$：我们有对 $(2,3), (2,3), (2,5), (2,5), (2,4), (2,3), (2,4)$。因此，$p(2,3)=3, p(2,4)=2, p(2,5)=2$。\n- 对于 $g=3$：我们有对 $(3,2), (3,4), (3,3), (3,3)$。因此，$p(3,2)=1, p(3,3)=2, p(3,4)=1$。\n\n所有其他条目 $p(g,d)$ 均为 $0$。所有条目的总和为 $1+2+2+3+2+2+1+2+1 = 16$，这与预期的总像素数相符。\n\n接下来，我们将 GLDM 除以总像素数 $N = 16$ 进行归一化，以获得联合概率质量函数 $P(g,d) = p(g,d)/N$。非零概率为：\n- $P(1,3) = \\frac{1}{16}$\n- $P(1,4) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(1,5) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(2,3) = \\frac{3}{16}$\n- $P(2,4) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(2,5) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(3,2) = \\frac{1}{16}$\n- $P(3,3) = \\frac{2}{16} = \\frac{1}{8}$\n- $P(3,4) = \\frac{1}{16}$\n\n最后，我们计算依赖熵 $H$，即联合分布 $P(g,d)$ 的香农熵。由于使用自然对数，单位是奈特（nats）。\n$$\nH = -\\sum_{g,d} P(g,d) \\ln(P(g,d))\n$$\n我们对非零概率进行求和。我们可以将具有相同概率值的项分组：\n- 有三项的 $P(g,d) = \\frac{1}{16}$。\n- 有五项的 $P(g,d) = \\frac{2}{16} = \\frac{1}{8}$。\n- 有一项的 $P(g,d) = \\frac{3}{16}$。\n\n熵的计算如下：\n$$\nH = - \\left[ 3 \\left(\\frac{1}{16}\\ln\\left(\\frac{1}{16}\\right)\\right) + 5 \\left(\\frac{2}{16}\\ln\\left(\\frac{2}{16}\\right)\\right) + 1 \\left(\\frac{3}{16}\\ln\\left(\\frac{3}{16}\\right)\\right) \\right]\n$$\n$$\nH = - \\frac{1}{16} \\left[ 3\\ln\\left(\\frac{1}{16}\\right) + 10\\ln\\left(\\frac{1}{8}\\right) + 3\\ln\\left(\\frac{3}{16}\\right) \\right]\n$$\n使用对数性质 $\\ln(a/b) = \\ln(a) - \\ln(b)$ 和 $\\ln(x^y) = y\\ln(x)$：\n$\\ln(\\frac{1}{16}) = -\\ln(16) = -\\ln(2^4) = -4\\ln(2)$\n$\\ln(\\frac{1}{8}) = -\\ln(8) = -\\ln(2^3) = -3\\ln(2)$\n$\\ln(\\frac{3}{16}) = \\ln(3) - \\ln(16) = \\ln(3) - 4\\ln(2)$\n将这些代入 $H$ 的表达式中：\n$$\nH = - \\frac{1}{16} \\left[ 3(-4\\ln(2)) + 10(-3\\ln(2)) + 3(\\ln(3) - 4\\ln(2)) \\right]\n$$\n$$\nH = - \\frac{1}{16} \\left[ -12\\ln(2) - 30\\ln(2) + 3\\ln(3) - 12\\ln(2) \\right]\n$$\n$$\nH = - \\frac{1}{16} \\left[ -54\\ln(2) + 3\\ln(3) \\right]\n$$\n$$\nH = \\frac{54\\ln(2) - 3\\ln(3)}{16}\n$$\n现在，我们代入数值 $\\ln(2) \\approx 0.693147$ 和 $\\ln(3) \\approx 1.098612$：\n$$\nH \\approx \\frac{54(0.693147) - 3(1.098612)}{16}\n$$\n$$\nH \\approx \\frac{37.429938 - 3.295836}{16} = \\frac{34.134102}{16} \\approx 2.133381\n$$\n将结果四舍五入到 $4$ 位有效数字，我们得到 $2.133$。", "answer": "$$\\boxed{2.133}$$", "id": "4564097"}, {"introduction": "掌握了GLDM的基本计算方法后，下一个关键是理解这些纹理特征如何反映图像的视觉特性。本练习通过对比两个极端的例子——一个完全均匀的图像和一个高度异质的棋盘状图像——来探索依赖大小与纹理同质性之间的关系。这将帮助你直观地理解GLDM特征的实际意义。[@problem_id:4564089]", "problem": "您将获得两幅用于放射组学纹理分析的离散化二维图像。所有灰度级都已量化到整数集 $\\{1,2,3,4\\}$。考虑八邻域（摩尔邻域）：如果两个像素的切比雪夫距离 $\\leq 1$，则它们是邻居。只考虑边界内的邻居；边界外的位置将被忽略。设容差参数为 $\\alpha=0$，这意味着当且仅当两个像素的灰度级相等时，它们才被认为是相关的。对于位于位置 $\\mathbf{p}$ 且灰度级为 $g$ 的像素，其相关大小 $d(\\mathbf{p})$ 定义为由中心像素 $\\mathbf{p}$ 及其所有灰度级等于 $g$ 的八邻域内邻居像素构成的像素总数。灰度级相关矩阵 (GLDM) $P(g,d)$ 统计对于每个灰度级 $g$ 和相关大小 $d$，图像中有多少像素的灰度级为 $g$ 且相关大小为 $d$。\n\n图像 $\\mathcal{I}_{A}$ 是均匀的：\n$$\n\\mathcal{I}_{A}=\\begin{pmatrix}\n2  2  2  2  2\\\\\n2  2  2  2  2\\\\\n2  2  2  2  2\\\\\n2  2  2  2  2\\\\\n2  2  2  2  2\n\\end{pmatrix}.\n$$\n\n图像 $\\mathcal{I}_{B}$ 是一个 $2\\times 2$ 平铺的四级模式：\n$$\n\\mathcal{I}_{B}=\\begin{pmatrix}\n1  2  1  2  1\\\\\n3  4  3  4  3\\\\\n1  2  1  2  1\\\\\n3  4  3  4  3\\\\\n1  2  1  2  1\n\\end{pmatrix}.\n$$\n\n对于每个图像 $\\mathcal{I}\\in\\{\\mathcal{I}_{A},\\mathcal{I}_{B}\\}$，定义平均相关大小\n$$\n\\bar{d}(\\mathcal{I})=\\frac{1}{N}\\sum_{\\mathbf{p}} d(\\mathbf{p}),\n$$\n其中 $N$ 是像素总数，求和遍历图像中所有的像素位置 $\\mathbf{p}$。\n\n从上述定义出发，并且不使用任何无法从这些定义中推导出的公式，确定比率\n$$\nR=\\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})}.\n$$\n\n将 $R$ 的最终值以小数形式给出，并四舍五入到四位有效数字。无需单位。", "solution": "### 第一步：提取已知条件\n- **图像**：两幅 $5 \\times 5$ 的离散化图像，$\\mathcal{I}_{A}$ 和 $\\mathcal{I}_{B}$。\n- **灰度级**：量化后的灰度级集合为 $\\{1, 2, 3, 4\\}$。\n- **邻域**：使用八邻域（摩尔邻域），其中邻居的切比雪夫距离 $\\leq 1$。只考虑边界内的邻居。\n- **相关条件**：如果两个像素的灰度级相等，则它们是相关的。这对应于容差参数 $\\alpha=0$。\n- **相关大小**：对于位于位置 $\\mathbf{p}$ 且灰度级为 $g$ 的像素，其相关大小 $d(\\mathbf{p})$ 是包括中心像素 $\\mathbf{p}$ 及其所有灰度级等于 $g$ 的八邻域内邻居像素的总数。\n- **图像 $\\mathcal{I}_{A}$**：\n$$\n\\mathcal{I}_{A}=\\begin{pmatrix}\n2  2  2  2  2\\\\\n2  2  2  2  2\\\\\n2  2  2  2  2\\\\\n2  2  2  2  2\\\\\n2  2  2  2  2\n\\end{pmatrix}\n$$\n- **图像 $\\mathcal{I}_{B}$**：\n$$\n\\mathcal{I}_{B}=\\begin{pmatrix}\n1  2  1  2  1\\\\\n3  4  3  4  3\\\\\n1  2  1  2  1\\\\\n3  4  3  4  3\\\\\n1  2  1  2  1\n\\end{pmatrix}\n$$\n- **平均相关大小**：\n$$\n\\bar{d}(\\mathcal{I})=\\frac{1}{N}\\sum_{\\mathbf{p}} d(\\mathbf{p})\n$$\n其中 $N$ 是像素总数，求和遍历所有的像素位置 $\\mathbf{p}$。\n- **目标**：确定比率 $R=\\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})}$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题定义明确，在放射组学和图像纹理分析领域有科学依据。所有术语，如摩尔邻域、相关大小和平均相关大小，都已明确定义。输入是简单的矩阵，目标是基于所提供定义的直接计算。该问题是自洽的、一致的，并且不违反任何科学或数学原理。它不模糊，不是病态问题，也不是微不足道的。\n\n### 第三步：结论与行动\n该问题有效。将推导解答。\n\n### 解题推导\n\n目标是计算比率 $R = \\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})}$。这需要为每个图像 $\\mathcal{I}_{A}$ 和 $\\mathcal{I}_{B}$ 计算平均相关大小 $\\bar{d}(\\mathcal{I})$。\n\n#### 图像 $\\mathcal{I}_{A}$ 的计算\n\n图像 $\\mathcal{I}_{A}$ 是一个 $5 \\times 5$ 的矩阵，其中每个像素的灰度级都为 2。像素总数为 $N_{A} = 5 \\times 5 = 25$。\n\n位于位置 $\\mathbf{p}$ 的像素的相关大小 $d(\\mathbf{p})$ 是该像素本身加上其灰度级相同的边界内邻居的数量。由于图像 $\\mathcal{I}_{A}$ 中所有像素的灰度级都相同（$g=2$），$d(\\mathbf{p})$ 就是 1 加上该像素的边界内邻居数。\n\n邻居的数量取决于像素的位置：\n1.  **角像素**：有 4 个角像素。每个有 3 个邻居。对于这些像素，相关大小为 $d(\\mathbf{p}) = 1 + 3 = 4$。\n2.  **边缘像素（非角点）**：有 $4 \\times (5-2) = 12$ 个边缘像素。每个有 5 个邻居。对于这些像素，相关大小为 $d(\\mathbf{p}) = 1 + 5 = 6$。\n3.  **内部像素**：有 $(5-2) \\times (5-2) = 9$ 个内部像素。每个有 8 个邻居。对于这些像素，相关大小为 $d(\\mathbf{p}) = 1 + 8 = 9$。\n\n图像 $\\mathcal{I}_{A}$ 中所有像素的相关大小之和为：\n$$\n\\sum_{\\mathbf{p} \\in \\mathcal{I}_{A}} d(\\mathbf{p}) = (4 \\times 4) + (12 \\times 6) + (9 \\times 9) = 16 + 72 + 81 = 169.\n$$\n\n图像 $\\mathcal{I}_{A}$ 的平均相关大小为：\n$$\n\\bar{d}(\\mathcal{I}_{A}) = \\frac{1}{N_{A}} \\sum_{\\mathbf{p} \\in \\mathcal{I}_{A}} d(\\mathbf{p}) = \\frac{169}{25}.\n$$\n\n#### 图像 $\\mathcal{I}_{B}$ 的计算\n\n图像 $\\mathcal{I}_{B}$ 是一个 $5 \\times 5$ 的矩阵，具有重复的 $2 \\times 2$ 灰度级模式。像素总数为 $N_{B} = 5 \\times 5 = 25$。设 $g(\\mathbf{p})$ 是像素位置 $\\mathbf{p}=(i,j)$ 的灰度级，其中 $i, j \\in \\{0, 1, 2, 3, 4\\}$。该模式基于索引的奇偶性：\n- 如果 $i$ 是偶数且 $j$ 是偶数，则 $g(i,j) = 1$。\n- 如果 $i$ 是偶数且 $j$ 是奇数，则 $g(i,j) = 2$。\n- 如果 $i$ 是奇数且 $j$ 是偶数，则 $g(i,j) = 3$。\n- 如果 $i$ 是奇数且 $j$ 是奇数，则 $g(i,j) = 4$。\n\n我们需要为每个像素计算 $d(\\mathbf{p})$。让我们考虑一个位于 $(i,j)$ 的任意像素 $\\mathbf{p}$ 及其位于 $(i',j')$ 的邻居 $\\mathbf{p}'$。要使 $\\mathbf{p}'$ 成为 $\\mathbf{p}$ 在八邻域中的邻居，必须有 $\\max(|i-i'|, |j-j'|) = 1$。这意味着条件 $i \\neq i'$ 或 $j \\neq j'$ 中至少有一个必须为真。\n\n如果 $i \\neq i'$，则 $i'$ 和 $i$ 的奇偶性不同。例如，如果 $i$ 是偶数，则 $i'$ 必须是奇数。\n如果 $j \\neq j'$，则 $j'$ 和 $j$ 的奇偶性不同。\n\n由于 $(i,j) \\neq (i',j')$，奇偶性对 $(i \\pmod 2, j \\pmod 2)$ 必须不同于 $(i' \\pmod 2, j' \\pmod 2)$。例如，如果 $i' = i+1$，则 $i' \\pmod 2 \\neq i \\pmod 2$。\n任何位置的灰度级都由其坐标的奇偶性对唯一确定。由于任何邻居 $\\mathbf{p}'$ 的奇偶性对都与中心像素 $\\mathbf{p}$ 的不同，它们的灰度级也必须不同：$g(\\mathbf{p}') \\neq g(\\mathbf{p})$。\n\n在容差 $\\alpha=0$ 的情况下，相关性要求灰度级完全相等。因此，对于图像 $\\mathcal{I}_{B}$ 中的任何像素 $\\mathbf{p}$，其所有邻居的灰度级都与它不同。任何像素的相关集仅包含该像素本身。\n\n因此，对于 $\\mathcal{I}_{B}$ 中的每个像素 $\\mathbf{p}$，相关大小为 $d(\\mathbf{p}) = 1$。\n\n图像 $\\mathcal{I}_{B}$ 中所有像素的相关大小之和为：\n$$\n\\sum_{\\mathbf{p} \\in \\mathcal{I}_{B}} d(\\mathbf{p}) = \\sum_{\\mathbf{p} \\in \\mathcal{I}_{B}} 1 = N_{B} = 25.\n$$\n\n图像 $\\mathcal{I}_{B}$ 的平均相关大小为：\n$$\n\\bar{d}(\\mathcal{I}_{B}) = \\frac{1}{N_{B}} \\sum_{\\mathbf{p} \\in \\mathcal{I}_{B}} d(\\mathbf{p}) = \\frac{25}{25} = 1.\n$$\n\n#### 比率 $R$ 的计算\n\n比率 $R$ 由以下公式给出：\n$$\nR = \\frac{\\bar{d}(\\mathcal{I}_{A})}{\\bar{d}(\\mathcal{I}_{B})} = \\frac{169/25}{1} = \\frac{169}{25} = 6.76.\n$$\n\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$\nR = 6.760.\n$$", "answer": "$$\n\\boxed{6.760}\n$$", "id": "4564089"}, {"introduction": "在实际应用中，我们不仅关心如何计算纹理特征，还关心这些特征对图像微小变化的敏感度。这个练习旨在探讨这个问题。通过比较两个仅有一个像素值差异的图像，你将计算并分析它们依赖熵的变化，从而理解GLDM特征如何量化图像纹理的细微差异。[@problem_id:4564095]", "problem": "灰度依赖矩阵 (GLDM) 的定义如下：对于图像中每个灰度级为 $g$ 的像素，其依赖计数 $d$ 等于 1 加上与其中心像素的灰度级绝对差值小于或等于给定容差 $\\alpha$ 的相邻像素的数量，其中邻域为 8-连通邻域（切比雪夫距离为 1）。GLDM $P(g,d)$ 记录了对于每个灰度级 $g$ 和依赖计数 $d$，具有该灰度级和依赖计数的像素数量。现有两个用于测试和调试 GLDM 实现的受控测试图像：\n$$\nI_{0} \\;=\\;\n\\begin{pmatrix}\n0  0  0 \\\\\n0  1  1 \\\\\n2  1  1\n\\end{pmatrix}\n\\qquad\\text{和}\\qquad\nI_{1} \\;=\\;\n\\begin{pmatrix}\n0  0  0 \\\\\n0  1  1 \\\\\n1  1  1\n\\end{pmatrix}.\n$$\n假设灰度容差 $\\alpha = 0$ 且使用 8-连通邻域。对于每幅图像，从基本定义出发构建 GLDM $P(g,d)$，将其除以总像素数 $N$ 进行归一化，得到联合概率分布 $p_{g,d}$，然后使用自然对数计算该联合分布的香农熵。令 $H(I_{0})$ 和 $H(I_{1})$ 表示这些熵。计算差值 $\\Delta H = H(I_{1}) - H(I_{0})$。将最终答案表示为十进制数，并四舍五入到四位有效数字。", "solution": "### 问题验证\n\n#### 步骤 1：提取已知信息\n问题提供了以下信息：\n1.  **灰度依赖矩阵 (GLDM) 的定义**：对于一个灰度级为 $g$ 的像素，其依赖计数 $d$ 等于 1 加上与其中心像素的灰度级绝对差值小于或等于容差 $\\alpha$ 的相邻像素的数量。GLDM $P(g,d)$ 是具有灰度级 $g$ 和依赖计数 $d$ 的像素数量的计数。\n2.  **邻域**：8-连通邻域（切比雪夫距离为 1）。\n3.  **灰度容差**：$\\alpha = 0$。\n4.  **图像 $I_0$**：\n    $$\n    I_{0} \\;=\\;\n    \\begin{pmatrix}\n    0  0  0 \\\\\n    0  1  1 \\\\\n    2  1  1\n    \\end{pmatrix}\n    $$\n5.  **图像 $I_1$**：\n    $$\n    I_{1} \\;=\\;\n    \\begin{pmatrix}\n    0  0  0 \\\\\n    0  1  1 \\\\\n    1  1  1\n    \\end{pmatrix}\n    $$\n6.  **任务**：\n    a. 为每幅图像构建 GLDM $P(g,d)$。\n    b. 将 $P(g,d)$ 除以总像素数 $N$ 进行归一化，得到联合概率分布 $p_{g,d} = P(g,d)/N$。\n    c. 使用公式 $H = - \\sum_{g,d} p_{g,d} \\ln(p_{g,d})$ 计算每个分布的香农熵 $H(I_0)$ 和 $H(I_1)$。\n    d. 计算差值 $\\Delta H = H(I_{1}) - H(I_{0})$。\n    e. 将最终答案表示为十进制数，并四舍五入到四位有效数字。\n\n#### 步骤 2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估：\n-   **科学依据**：该问题基于放射组学和纹理分析领域的标准定义，特别是灰度依赖矩阵。香农熵、图像邻域和灰度容差等概念在图像处理和信息论中都是公认的。该问题在科学上和数学上都是合理的。\n-   **适定性**：问题陈述清晰，包含了所有必要信息。图像、邻域、容差以及需要计算的量都已明确定义。存在唯一解，并且可以通过有限的计算步骤确定。\n-   **客观性**：语言精确且技术性强。所有术语都有正式定义或是该领域的标准术语。没有主观或基于观点的内容。\n-   该问题没有表现出任何列出的缺陷（例如，它不是不完整的、矛盾的、不切实际的或微不足道的）。计算过程虽然详细，但都直接源于定义。\n\n#### 步骤 3：结论与行动\n问题是**有效的**。将按要求推导解答。\n\n### 解答\n\n每幅图像的总像素数为 $N = 3 \\times 3 = 9$。对于一个灰度值为 $g_c$ 的像素，其依赖计数 $d$ 由公式 $d = 1 + \\sum_{i \\in \\mathcal{N}} \\delta(|g_i - g_c| \\le \\alpha)$ 给出，其中 $\\mathcal{N}$ 是 8 个邻居的集合，$\\delta(\\cdot)$ 是指示函数。给定 $\\alpha = 0$，该公式简化为 $d = 1 + (\\text{与 } g_c \\text{ 灰度级相等的邻居数量})$。\n\n#### 对图像 $I_0$ 的分析\n\n图像为 $I_{0} = \\begin{pmatrix} 0  0  0 \\\\ 0  1  1 \\\\ 2  1  1 \\end{pmatrix}$。我们为每个像素计算 $(g,d)$ 对，使用从 $(0,0)$ 到 $(2,2)$ 的 (行, 列) 索引。\n\n1.  像素 $(0,0)$, $g=0$。邻居: $\\{0, 0, 1\\}$。相同灰度级的邻居数: $2$。$d=1+2=3$。对: $(0,3)$。\n2.  像素 $(0,1)$, $g=0$。邻居: $\\{0, 0, 0, 1, 1\\}$。相同灰度级的邻居数: $3$。$d=1+3=4$。对: $(0,4)$。\n3.  像素 $(0,2)$, $g=0$。邻居: $\\{0, 1, 1\\}$。相同灰度级的邻居数: $1$。$d=1+1=2$。对: $(0,2)$。\n4.  像素 $(1,0)$, $g=0$。邻居: $\\{0, 0, 1, 1, 2\\}$。相同灰度级的邻居数: $2$。$d=1+2=3$。对: $(0,3)$。\n5.  像素 $(1,1)$, $g=1$。邻居: $\\{0,0,0,0,1,1,1,2\\}$。相同灰度级的邻居数: $3$。$d=1+3=4$。对: $(1,4)$。\n6.  像素 $(1,2)$, $g=1$。邻居: $\\{0,0,1,1,1\\}$。相同灰度级的邻居数: $3$。$d=1+3=4$。对: $(1,4)$。\n7.  像素 $(2,0)$, $g=2$。邻居: $\\{0, 1, 1\\}$。相同灰度级的邻居数: $0$。$d=1+0=1$。对: $(2,1)$。\n8.  像素 $(2,1)$, $g=1$。邻居: $\\{0,1,1,1,2\\}$。相同灰度级的邻居数: $3$。$d=1+3=4$。对: $(1,4)$。\n9.  像素 $(2,2)$, $g=1$。邻居: $\\{1, 1, 1\\}$。相同灰度级的邻居数: $3$。$d=1+3=4$。对: $(1,4)$。\n\n令 $P_0(g,d)$ 为 $I_0$ 的 GLDM。我们统计每个 $(g,d)$ 对出现的次数：\n-   $P_0(0,2)=1$\n-   $P_0(0,3)=2$\n-   $P_0(0,4)=1$\n-   $P_0(1,4)=4$\n-   $P_0(2,1)=1$\n所有其他的 $P_0(g,d)=0$。这些计数的总和为 $1+2+1+4+1=9=N$。\n\n归一化后的 GLDM 为 $p_{g,d}^{(0)} = P_0(g,d)/N$。非零概率为：\n$p^{(0)}(0,2)=\\frac{1}{9}$, $p^{(0)}(0,3)=\\frac{2}{9}$, $p^{(0)}(0,4)=\\frac{1}{9}$, $p^{(0)}(1,4)=\\frac{4}{9}$, $p^{(0)}(2,1)=\\frac{1}{9}$。\n\n熵 $H(I_0)$ 计算如下：\n$$H(I_0) = - \\sum_{g,d} p^{(0)}(g,d) \\ln(p^{(0)}(g,d))$$\n$$H(I_0) = - \\left[ \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{4}{9}\\ln\\left(\\frac{4}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) \\right]$$\n$$H(I_0) = - \\left[ 3 \\cdot \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{4}{9}\\ln\\left(\\frac{4}{9}\\right) \\right]$$\n$$H(I_0) = - \\frac{1}{9} \\left[ 3\\ln(1) - 3\\ln(9) + 2\\ln(2) - 2\\ln(9) + 4\\ln(4) - 4\\ln(9) \\right]$$\n因为 $\\ln(1)=0$ 且 $\\ln(4)=2\\ln(2)$：\n$$H(I_0) = - \\frac{1}{9} \\left[ -3\\ln(9) + 2\\ln(2) - 2\\ln(9) + 4(2\\ln(2)) - 4\\ln(9) \\right]$$\n$$H(I_0) = - \\frac{1}{9} \\left[ (2+8)\\ln(2) - (3+2+4)\\ln(9) \\right]$$\n$$H(I_0) = - \\frac{1}{9} \\left[ 10\\ln(2) - 9\\ln(9) \\right] = \\ln(9) - \\frac{10}{9}\\ln(2)$$\n\n#### 对图像 $I_1$ 的分析\n\n图像为 $I_{1} = \\begin{pmatrix} 0  0  0 \\\\ 0  1  1 \\\\ 1  1  1 \\end{pmatrix}$。我们为每个像素计算 $(g,d)$ 对。\n\n1.  像素 $(0,0)$, $g=0$。邻居: $\\{0,0,1\\}$。$d=1+2=3$。对: $(0,3)$。\n2.  像素 $(0,1)$, $g=0$。邻居: $\\{0,0,0,1,1\\}$。$d=1+3=4$。对: $(0,4)$。\n3.  像素 $(0,2)$, $g=0$。邻居: $\\{0,1,1\\}$。$d=1+1=2$。对: $(0,2)$。\n4.  像素 $(1,0)$, $g=0$。邻居: $\\{0,0,1,1,1\\}$。$d=1+2=3$。对: $(0,3)$。\n5.  像素 $(1,1)$, $g=1$。邻居: $\\{0,0,0,0,1,1,1,1\\}$。$d=1+4=5$。对: $(1,5)$。\n6.  像素 $(1,2)$, $g=1$。邻居: $\\{0,0,1,1,1\\}$。$d=1+3=4$。对: $(1,4)$。\n7.  像素 $(2,0)$, $g=1$。邻居: $\\{0,1,1\\}$。$d=1+2=3$。对: $(1,3)$。\n8.  像素 $(2,1)$, $g=1$。邻居: $\\{0,1,1,1,1\\}$。$d=1+4=5$。对: $(1,5)$。\n9.  像素 $(2,2)$, $g=1$。邻居: $\\{1,1,1\\}$。$d=1+3=4$。对: $(1,4)$。\n\n令 $P_1(g,d)$ 为 $I_1$ 的 GLDM。我们统计出现次数：\n-   $P_1(0,2)=1$\n-   $P_1(0,3)=2$\n-   $P_1(0,4)=1$\n-   $P_1(1,3)=1$\n-   $P_1(1,4)=2$\n-   $P_1(1,5)=2$\n总和为 $1+2+1+1+2+2=9=N$。\n\n归一化后的 GLDM 为 $p_{g,d}^{(1)} = P_1(g,d)/N$。非零概率为：\n$p^{(1)}(0,2)=\\frac{1}{9}$, $p^{(1)}(0,3)=\\frac{2}{9}$, $p^{(1)}(0,4)=\\frac{1}{9}$, $p^{(1)}(1,3)=\\frac{1}{9}$, $p^{(1)}(1,4)=\\frac{2}{9}$, $p^{(1)}(1,5)=\\frac{2}{9}$。\n\n熵 $H(I_1)$ 计算如下：\n$$H(I_1) = - \\sum_{g,d} p^{(1)}(g,d) \\ln(p^{(1)}(g,d))$$\n$$H(I_1) = - \\left[ \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) + \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) \\right]$$\n按概率值对各项进行分组：\n$$H(I_1) = - \\left[ 3 \\cdot \\frac{1}{9}\\ln\\left(\\frac{1}{9}\\right) + 3 \\cdot \\frac{2}{9}\\ln\\left(\\frac{2}{9}\\right) \\right]$$\n$$H(I_1) = - \\frac{1}{3} \\left[ \\ln\\left(\\frac{1}{9}\\right) + 2\\ln\\left(\\frac{2}{9}\\right) \\right]$$\n$$H(I_1) = - \\frac{1}{3} \\left[ -\\ln(9) + 2(\\ln(2) - \\ln(9)) \\right]$$\n$$H(I_1) = - \\frac{1}{3} \\left[ 2\\ln(2) - 3\\ln(9) \\right] = \\ln(9) - \\frac{2}{3}\\ln(2)$$\n\n#### $\\Delta H$ 的计算\n\n我们现在计算差值 $\\Delta H = H(I_1) - H(I_0)$。\n$$ \\Delta H = \\left(\\ln(9) - \\frac{2}{3}\\ln(2)\\right) - \\left(\\ln(9) - \\frac{10}{9}\\ln(2)\\right) $$\n$$ \\Delta H = \\ln(9) - \\frac{2}{3}\\ln(2) - \\ln(9) + \\frac{10}{9}\\ln(2) $$\n$$ \\Delta H = \\left(\\frac{10}{9} - \\frac{2}{3}\\right)\\ln(2) $$\n通分：\n$$ \\Delta H = \\left(\\frac{10}{9} - \\frac{6}{9}\\right)\\ln(2) = \\frac{4}{9}\\ln(2) $$\n\n#### 数值计算\n\n问题要求答案为四舍五入到四位有效数字的十进制数。使用 $\\ln(2) \\approx 0.693147$ 的值：\n$$ \\Delta H = \\frac{4}{9} \\times 0.693147 \\approx 0.444444 \\times 0.693147 \\approx 0.308065 $$\n四舍五入到四位有效数字，我们看前四个非零数字，即 $3, 0, 8, 0$。第五位有效数字是 $6$，大于或等于 $5$，所以我们将第四位数字向上取整。\n$$ \\Delta H \\approx 0.3081 $$", "answer": "$$\\boxed{0.3081}$$", "id": "4564095"}]}