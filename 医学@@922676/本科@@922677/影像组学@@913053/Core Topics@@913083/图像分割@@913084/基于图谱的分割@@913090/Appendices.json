{"hands_on_practices": [{"introduction": "对任何分割任务而言，首要步骤是学会如何评估其结果的准确性。本练习将引导你计算和比较两种关键的分割评估指标：戴斯相似系数（Dice similarity coefficient）和豪斯多夫距离（Hausdorff distance）。通过这个实践，你将亲身体会到不同的指标如何揭示不同类型的分割误差，这是解读和验证基于图谱的分割方法性能的一项核心技能 [@problem_id:4529150]。", "problem": "在放射组学中的基于图谱的分割中，通过配准将解剖标签的群体图谱形变到目标对象上，从而生成一个可以与手动标注的真实分割（ground-truth）进行比较的候选分割结果。考虑一个各向同性体素间距为 $1\\,\\mathrm{mm}$ 的二维切片，设真实分割掩模由前景体素坐标集合 $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$ 表示。得到一个图谱配准后的掩模 $T$，由于轻微的配准错误，除了预期的结构外，它还包含一个位于 $(10,10)$ 的伪影孤立标签体素，因此 $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$。使用体素坐标上的标准欧几里得度量，并将掩模视作前景体素集合，计算 $S$ 和 $T$ 之间的 Dice 相似系数以及 $S$ 和 $T$ 之间的对称豪斯多夫距离。以毫米为单位表示豪斯多夫距离。根据您在这些度量之间发现的任何差异，在您的推理中指出基于图谱的分割相对于真实分割存在的主要误差模式。无需四舍五入；请提供精确值。您的最终数值答案必须分别由 Dice 相似系数和豪斯多夫距离的值对组成。", "solution": "用户提供了一个来自放射组学领域的问题，具体涉及评估基于图谱的分割与真实分割（ground-truth）的对比。我将首先验证问题陈述，如果有效，则继续提供详细的解决方案。\n\n### 步骤 1：提取已知条件\n-   **领域**：放射组学中的基于图谱的分割。\n-   **图像空间**：二维切片。\n-   **体素间距**：各向同性，$1\\,\\mathrm{mm}$。\n-   **真实分割掩模**：前景体素坐标集合为 $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$。\n-   **图谱配准后掩模**：前景体素坐标集合为 $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$。\n-   **距离度量**：体素坐标上的标准欧几里得度量。\n-   **任务 1**：计算 $S$ 和 $T$ 之间的 Dice 相似系数。\n-   **任务 2**：计算 $S$ 和 $T$ 之间的对称豪斯多夫距离。\n-   **任务 3**：以毫米为单位表示豪斯多夫距离。\n-   **任务 4**：根据度量指标识别主要误差模式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，使用了在医学图像分析中作为基础的分割评估度量（Dice 相似系数和豪斯多夫距离）的标准定义。配准错误产生伪影孤立体素的场景是分割伪影的一个实际且现实的例子。该问题是适定的；集合 $S$ 和 $T$ 被明确定义，且度量具有无歧义的数学定义，确保了唯一解的存在。语言客观、精确。所有必要信息，包括用于单位转换的体素间距，均已提供。该问题并非微不足道，因为它需要正确应用两种不同的度量并解释其结果。\n\n### 步骤 3：结论与行动\n该问题有效。我现在开始解决它。\n\n### 解决方案\n该问题要求为给定的真实分割集合 $S$ 和图谱配准后集合 $T$ 计算两种用于比较分割掩模的标准度量：Dice 相似系数 (DSC) 和对称豪斯多夫距离。\n\n设真实分割集合为 $S = \\{(0,0),(0,1),(1,0),(1,1)\\}$，图谱配准后集合为 $T = \\{(0,0),(0,1),(1,0),(1,1),(10,10)\\}$。\n\n**1. Dice 相似系数 (DSC)**\n\nDice 相似系数衡量两个集合之间的重叠程度。其定义为：\n$$\n\\text{DSC}(S, T) = \\frac{2 |S \\cap T|}{|S| + |T|}\n$$\n其中 $|A|$ 表示集合 $A$ 的基数（元素数量）。\n\n首先，我们确定集合 $S$ 和 $T$ 的基数：\n$$\n|S| = 4\n$$\n$$\n|T| = 5\n$$\n\n接下来，我们求两个集合的交集 $S \\cap T$：\n$$\nS \\cap T = \\{(0,0),(0,1),(1,0),(1,1)\\}\n$$\n交集的基数为：\n$$\n|S \\cap T| = 4\n$$\n\n现在，我们可以计算 DSC：\n$$\n\\text{DSC}(S, T) = \\frac{2 \\times 4}{4 + 5} = \\frac{8}{9}\n$$\nDice 系数是一个介于 0 和 1 之间的值，其中 1 表示完全一致。值为 $\\frac{8}{9}$ 表示重叠度很高。\n\n**2. 对称豪斯多夫距离**\n\n对称豪斯多夫距离 $H(S,T)$ 量化了从一个集合中的一个点到另一个集合中最近点的最大距离。其定义为：\n$$\nH(S, T) = \\max \\left( h(S, T), h(T, S) \\right)\n$$\n其中 $h(S, T)$ 是从 $S$ 到 $T$ 的有向豪斯多夫距离：\n$$\nh(S, T) = \\max_{s \\in S} \\left( \\min_{t \\in T} d(s, t) \\right)\n$$\n且 $d(s, t)$ 是点（体素）$s$ 和 $t$ 之间的标准欧几里得距离。\n\n首先，我们计算有向豪斯多夫距离 $h(S, T)$。它衡量的是从 $S$ 中任意一点到 $T$ 中最近一点的最大距离。\n由于集合 $S$ 是 $T$ 的真子集（即 $S \\subset T$），对于每个点 $s \\in S$，该点 $s$ 也存在于 $T$ 中。因此，从任何 $s \\in S$ 到集合 $T$ 的最小距离为 $0$，因为 $d(s, s) = 0$。\n$$\n\\min_{t \\in T} d(s, t) = 0 \\quad \\forall s \\in S\n$$\n对所有 $s \\in S$ 取最大值：\n$$\nh(S, T) = \\max_{s \\in S} (0) = 0\n$$\n\n接下来，我们计算有向豪斯多夫距离 $h(T, S)$，它衡量的是从 $T$ 中任意一点到 $S$ 中最近一点的最大距离。\n$$\nh(T, S) = \\max_{t \\in T} \\left( \\min_{s \\in S} d(t, s) \\right)\n$$\n我们需要为 $T$ 中的每个点 $t$ 计算 $\\min_{s \\in S} d(t, s)$。\n集合 $T$ 由 $S$ 中的点加上离群点 $(10,10)$ 组成。\n对于任何同时存在于 $S$ 和 $T$ 中的点 $t$，到 $S$ 的最小距离为 $0$。这适用于点 $(0,0)$、$(0,1)$、$(1,0)$ 和 $(1,1)$。\n我们唯一需要考虑的点是 $t^* = (10,10)$，它在 $T$ 中但不在 $S$ 中。我们必须找到它到集合 $S$ 的最小距离。\n$$\n\\min_{s \\in S} d((10,10), s) = \\min \\left\\{ d((10,10),(0,0)), d((10,10),(0,1)), d((10,10),(1,0)), d((10,10),(1,1)) \\right\\}\n$$\n让我们计算各个欧几里得距离，$d((x_1,y_1),(x_2,y_2)) = \\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$：\n-   $d((10,10),(0,0)) = \\sqrt{(10-0)^2 + (10-0)^2} = \\sqrt{100+100} = \\sqrt{200} = 10\\sqrt{2}$\n-   $d((10,10),(0,1)) = \\sqrt{(10-0)^2 + (10-1)^2} = \\sqrt{100+81} = \\sqrt{181}$\n-   $d((10,10),(1,0)) = \\sqrt{(10-1)^2 + (10-0)^2} = \\sqrt{81+100} = \\sqrt{181}$\n-   $d((10,10),(1,1)) = \\sqrt{(10-1)^2 + (10-1)^2} = \\sqrt{81+81} = \\sqrt{162} = 9\\sqrt{2}$\n\n这些距离中的最小值为 $\\sqrt{162} = 9\\sqrt{2}$。\n因此，$h(T, S) = \\max(0, 0, 0, 0, 9\\sqrt{2}) = 9\\sqrt{2}$。\n\n对称豪斯多夫距离是两个有向距离中的最大值：\n$$\nH(S, T) = \\max(h(S, T), h(T, S)) = \\max(0, 9\\sqrt{2}) = 9\\sqrt{2}\n$$\n这个距离是以体素为单位的。问题指定了各向同性的体素间距为 $1\\,\\mathrm{mm}$。因此，以毫米为单位的豪斯多夫距离是：\n$$\nH(S, T) = 9\\sqrt{2}\\,\\mathrm{mm}\n$$\n\n**3. 误差模式解释**\n\n我们计算出 Dice 系数为 $\\text{DSC} = \\frac{8}{9} \\approx 0.889$，豪斯多夫距离为 $H = 9\\sqrt{2} \\approx 12.7\\,\\mathrm{mm}$。\n-   **Dice 系数**是一种体积重叠度量。它的值很高，因为分割不匹配仅涉及一个体素（$T$ 有 $5$ 个体素，$S$ 有 $4$ 个，其中 $4$ 个重叠）。该度量对不匹配区域的空间位置相对不敏感。\n-   **豪斯多夫距离**是一种基于边界的度量，是最坏情况误差的指标。它对离群点极其敏感。$9\\sqrt{2}\\,\\mathrm{mm}$ 这个较大的值完全是由位于 $(10,10)$ 的单个伪影体素造成的，该体素远离真实分割集合 $S$。\n\n高 Dice 系数值（表明总体分割效果良好）与大豪斯多夫距离（表明分割边界较差）之间的差异指向了一种特定类型的误差。主要误差模式是存在一个远离实际物体边界的**伪影孤立体素簇**（一个离群点）。分割的主体部分基本正确，但配准错误在一个相当远的距离上引入了一个假阳性元素。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{8}{9} & 9\\sqrt{2} \\end{pmatrix}}\n$$", "id": "4529150"}, {"introduction": "为了融合多个图谱的信息，我们需要超越简单的投票机制，转向更强大的概率模型。本练习将带你探索一种基于期望最大化（Expectation-Maximization, EM）算法的概率性标签融合方法。你将通过为每个图谱的敏感性（sensitivity）和特异性（specificity）建模来估计真实的组织标签，从而实现比简单加权平均更精细、更准确的分割结果 [@problem_id:4529145]。", "problem": "在用于放射组学的基于图谱的分割中，考虑一个二元组织分类问题，其中体素 $v$ 的潜在真实组织标签为 $T_v \\in \\{0,1\\}$，并且三个图谱提供了观测标签 $\\ell_{iv} \\in \\{0,1\\}$，其中 $i \\in \\{1,2,3\\}$。假设给定 $T_v$ 时，图谱的观测是条件独立的，并且每个图谱都遵循一个伯努利模型，其敏感性为 $s_i = \\mathbb{P}(\\ell_{iv} = 1 \\mid T_v = 1)$，特异性为 $c_i = \\mathbb{P}(\\ell_{iv} = 0 \\mid T_v = 0)$。设先验患病率为 $\\pi = \\mathbb{P}(T_v = 1)$，在所有体素中均相同。\n\n给定以下初始参数：$s_1 = 0.90$，$c_1 = 0.95$，$s_2 = 0.85$，$c_2 = 0.90$，$s_3 = 0.80$，$c_3 = 0.92$ 以及 $\\pi = 0.30$。对于四个体素 $v = 1,2,3,4$，观测到的图谱标签如下：\n- 体素 $1$：$\\ell_{1,1} = 1$，$\\ell_{2,1} = 1$，$\\ell_{3,1} = 1$。\n- 体素 $2$：$\\ell_{1,2} = 1$，$\\ell_{2,2} = 0$，$\\ell_{3,2} = 1$。\n- 体素 $3$：$\\ell_{1,3} = 0$，$\\ell_{2,3} = 0$，$\\ell_{3,3} = 1$。\n- 体素 $4$：$\\ell_{1,4} = 0$，$\\ell_{2,4} = 0$，$\\ell_{3,4} = 0$。\n\n执行一次期望最大化（EM）迭代，其中期望最大化（EM）指的是在期望步骤（E步骤）中计算后验概率，并根据期望充分统计量在最大化步骤（M步骤）中更新敏感性和特异性参数。具体来说：\n1. 在 E 步骤中，对每个体素 $v$，使用贝叶斯定理和条件独立性假设计算后验概率 $p_v = \\mathbb{P}(T_v = 1 \\mid \\ell_{1v}, \\ell_{2v}, \\ell_{3v})$。\n2. 在 M 步骤中，使用期望计数更新每个图谱的敏感性和特异性：\n   - $s_i^{(1)} = \\dfrac{\\sum_{v} p_v \\, \\ell_{iv}}{\\sum_{v} p_v}$，\n   - $c_i^{(1)} = \\dfrac{\\sum_{v} (1 - p_v) \\, (1 - \\ell_{iv})}{\\sum_{v} (1 - p_v)}$。\n\n请提供在 E 步骤中，根据给定的初始参数计算出的后验概率 $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$ 的数值。将您的答案表示为四舍五入到四位有效数字的小数。不需要单位。", "solution": "首先根据既定标准对问题进行验证。\n\n### 问题验证\n\n#### 第1步：提取已知条件\n- **模型**：一个二元组织分类问题，其中体素 $v$ 的潜在真实组织标签为 $T_v \\in \\{0,1\\}$。\n- **观测**：三个图谱提供了观测标签 $\\ell_{iv} \\in \\{0,1\\}$，其中 $i \\in \\{1,2,3\\}$。\n- **假设**：给定真实标签 $T_v$ 时，图谱观测是条件独立的。每个图谱遵循一个伯努利模型。\n- **定义**：\n    - 敏感性：$s_i = \\mathbb{P}(\\ell_{iv} = 1 \\mid T_v = 1)$\n    - 特异性：$c_i = \\mathbb{P}(\\ell_{iv} = 0 \\mid T_v = 0)$\n    - 先验患病率：$\\pi = \\mathbb{P}(T_v = 1)$\n- **初始参数**：\n    - $s_1 = 0.90$，$c_1 = 0.95$\n    - $s_2 = 0.85$，$c_2 = 0.90$\n    - $s_3 = 0.80$，$c_3 = 0.92$\n    - $\\pi = 0.30$\n- **观测数据**：\n    - 体素 $1$：$(\\ell_{1,1}, \\ell_{2,1}, \\ell_{3,1}) = (1, 1, 1)$\n    - 体素 $2$：$(\\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2}) = (1, 0, 1)$\n    - 体素 $3$：$(\\ell_{1,3}, \\ell_{2,3}, \\ell_{3,3}) = (0, 0, 1)$\n    - 体素 $4$：$(\\ell_{1,4}, \\ell_{2,4}, \\ell_{3,4}) = (0, 0, 0)$\n- **任务**：在 EM 算法第一次迭代的 E 步骤中，计算后验概率 $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$。\n\n#### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了用于医学图像分割的潜变量模型，这是期望最大化（EM）算法的一个标准应用。敏感性、特异性和贝叶斯推断的使用是统计建模和机器学习的基础。该设置在科学上是合理的。\n2.  **适定性**：该问题是适定的。它要求计算一个特定的后验概率 $p_2$，并提供了所有必要的数据、初始参数和一个明确定义的概率模型。可以确定一个唯一的、稳定的解。\n3.  **客观性**：所有术语都有数学定义，数据以数值形式提供。问题不含主观性语言。\n4.  **完整性和一致性**：该问题是自洽的。它提供了计算所需的所有模型假设、参数和数据。没有矛盾之处；所有概率都在 $[0, 1]$ 的有效范围内。\n5.  **真实性**：在医学成像和基于图谱的分割背景下，敏感性、特异性和患病率的数值是合理的。\n\n#### 第3步：结论与行动\n该问题有效。将推导解答。\n\n### 解答\n\n目标是计算体素 $v=2$ 的后验概率 $p_2 = \\mathbb{P}(T_2 = 1 \\mid \\ell_{1,2}, \\ell_{2,2}, \\ell_{3,2})$。设体素 $v$ 的观测标签向量表示为 $\\boldsymbol{\\ell}_v = (\\ell_{1v}, \\ell_{2v}, \\ell_{3v})$。对于体素2，观测标签为 $\\boldsymbol{\\ell}_2 = (1, 0, 1)$。\n\n我们应用贝叶斯定理来计算后验概率：\n$$ p_v = \\mathbb{P}(T_v=1 \\mid \\boldsymbol{\\ell}_v) = \\frac{\\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=1)\\mathbb{P}(T_v=1)}{\\mathbb{P}(\\boldsymbol{\\ell}_v)} $$\n分母 $\\mathbb{P}(\\boldsymbol{\\ell}_v)$ 是边际似然或证据，可以使用全概率定律展开：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_v) = \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=1)\\mathbb{P}(T_v=1) + \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v=0)\\mathbb{P}(T_v=0) $$\n先验概率给定为 $\\mathbb{P}(T_v=1) = \\pi = 0.30$，因此 $\\mathbb{P}(T_v=0) = 1 - \\pi = 1 - 0.30 = 0.70$。\n\n问题陈述，给定真实标签 $T_v$ 时，图谱的观测是条件独立的。这使我们能够将标签向量 $\\boldsymbol{\\ell}_v$ 的条件概率表示为单个概率的乘积：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_v \\mid T_v) = \\prod_{i=1}^{3} \\mathbb{P}(\\ell_{iv} \\mid T_v) $$\n现在我们可以使用给定的敏感性（$s_i$）和特异性（$c_i$）来计算体素 $v=2$ 的两个条件似然项。\n\n1.  **给定真实标签为 $1$ 时的似然（$T_2 = 1$）**：\n    我们使用敏感性 $s_i = \\mathbb{P}(\\ell_{iv}=1 \\mid T_v=1)$ 及其互补概率 $1-s_i = \\mathbb{P}(\\ell_{iv}=0 \\mid T_v=1)$。\n    对于 $\\boldsymbol{\\ell}_2 = (1, 0, 1)$:\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = \\mathbb{P}(\\ell_{1,2}=1 \\mid T_2=1) \\cdot \\mathbb{P}(\\ell_{2,2}=0 \\mid T_2=1) \\cdot \\mathbb{P}(\\ell_{3,2}=1 \\mid T_2=1) $$\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = s_1 \\cdot (1-s_2) \\cdot s_3 $$\n    代入给定值 $s_1 = 0.90$，$s_2 = 0.85$ 和 $s_3 = 0.80$：\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1) = (0.90) \\cdot (1 - 0.85) \\cdot (0.80) = 0.90 \\cdot 0.15 \\cdot 0.80 = 0.108 $$\n\n2.  **给定真实标签为 $0$ 时的似然（$T_2 = 0$）**：\n    我们使用特异性 $c_i = \\mathbb{P}(\\ell_{iv}=0 \\mid T_v=0)$ 及其互补概率 $1-c_i = \\mathbb{P}(\\ell_{iv}=1 \\mid T_v=0)$。\n    对于 $\\boldsymbol{\\ell}_2 = (1, 0, 1)$:\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = \\mathbb{P}(\\ell_{1,2}=1 \\mid T_2=0) \\cdot \\mathbb{P}(\\ell_{2,2}=0 \\mid T_2=0) \\cdot \\mathbb{P}(\\ell_{3,2}=1 \\mid T_2=0) $$\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = (1-c_1) \\cdot c_2 \\cdot (1-c_3) $$\n    代入给定值 $c_1 = 0.95$，$c_2 = 0.90$ 和 $c_3 = 0.92$：\n    $$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0) = (1 - 0.95) \\cdot (0.90) \\cdot (1 - 0.92) = 0.05 \\cdot 0.90 \\cdot 0.08 = 0.0036 $$\n\n现在我们将这些结果结合起来计算后验概率 $p_2$。\n贝叶斯定理的分子是：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1)\\mathbb{P}(T_2=1) = (0.108) \\cdot (0.30) = 0.0324 $$\n分母（证据）是：\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=1)\\mathbb{P}(T_2=1) + \\mathbb{P}(\\boldsymbol{\\ell}_2 \\mid T_2=0)\\mathbb{P}(T_2=0) $$\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = (0.108 \\cdot 0.30) + (0.0036 \\cdot 0.70) $$\n$$ \\mathbb{P}(\\boldsymbol{\\ell}_2) = 0.0324 + 0.00252 = 0.03492 $$\n最后，后验概率 $p_2$ 是分子与分母的比率：\n$$ p_2 = \\frac{0.0324}{0.03492} \\approx 0.92783505... $$\n按要求将结果四舍五入到四位有效数字，得到 $0.9278$。", "answer": "$$\\boxed{0.9278}$$", "id": "4529145"}, {"introduction": "在实际应用中，图谱数据集常常因为严重的配准错误而包含异常值（outliers）。本练习将向你展示如何构建一个稳健的融合模型，利用休伯M估计（Huber M-estimator）来自动降低不可靠图谱的权重。通过将结果与简单的多数投票法进行对比，你将理解为何稳健的方法在处理不完美数据时至关重要，并能获得更可靠的分割结果 [@problem_id:4529158]。", "problem": "在放射组学研究中，一个基于图谱的分割流程被用作预处理步骤，通过对 $K$ 个已配准图谱分割进行标签融合，来勾画目标图像中感兴趣的二元结构。给定 $K=5$ 个图谱。对于单个体素的标签融合，每个图谱贡献一个二元投票 $y_i \\in \\{0,1\\}$，表示前景（$1$）或背景（$0$）。为了降低存在严重配准错误的图谱的权重，使用戴斯相似系数（DSC）从一个小型验证集中估计图谱的可靠性。令 $s_i \\in [0,1]$ 表示图谱 $i$ 相对于预留验证标注的DSC，因此越大的 $s_i$ 表示越高的图谱可靠性。通过迭代重加权最小二乘法（IRLS）应用Huber M-估计量，为每个图谱分配一个稳健权重 $w_i$：定义残差 $r_i = 1 - s_i$ 和Huber调节常数 $c > 0$。相应的IRLS权重为 $w_i = \\psi(r_i)/r_i$，其中Huber得分函数为：如果 $|r| \\le c$，则 $\\psi(r) = r$；如果 $|r| > c$，则 $\\psi(r) = c \\,\\mathrm{sign}(r)$。这得出：如果 $|r_i| \\le c$，则 $w_i = 1$；如果 $|r_i| > c$，则 $w_i = c/|r_i|$。该体素处稳健融合的后验前景概率为\n$$\np_{\\mathrm{fused}} = \\frac{\\sum_{i=1}^{K} w_i \\, y_i}{\\sum_{i=1}^{K} w_i}.\n$$\n该体素处的多数投票分数为 $m = \\frac{1}{K}\\sum_{i=1}^{K} y_i$。假设图谱的DSC分别为 $s_1=0.90$，$s_2=0.88$，$s_3=0.86$，$s_4=0.85$ 和 $s_5=0.30$，且 $c=0.10$。假设体素级别的图谱投票为 $y_1=0$，$y_2=0$，$y_3=1$，$y_4=1$ 和 $y_5=1$，其中图谱5是存在严重配准错误的图谱。仅使用上述定义，计算稳健融合后验概率与多数投票分数之间的差值的精确值，即 $p_{\\mathrm{fused}} - m$。将您的最终答案表示为一个无单位的最简分数。不要四舍五入。", "solution": "首先对问题进行验证，以确保其科学基础扎实、提法恰当、客观且完整。\n\n### 第1步：提取已知条件\n- 图谱数量：$K=5$。\n- 单个图谱的体素投票：$y_i \\in \\{0, 1\\}$。\n- 图谱Dice相似系数 (DSC)：$s_i$。\n- 图谱 $i$ 的残差：$r_i = 1 - s_i$。\n- Huber M-估计量调节常数：$c > 0$。\n- 图谱 $i$ 的IRLS权重：$w_i = \\psi(r_i)/r_i$，其中 $\\psi(r)$ 是Huber得分函数。明确给出：如果 $|r_i| \\le c$，则 $w_i = 1$；如果 $|r_i| > c$，则 $w_i = c/|r_i|$。\n- 稳健融合的后验前景概率：$p_{\\mathrm{fused}} = \\frac{\\sum_{i=1}^{K} w_i \\, y_i}{\\sum_{i=1}^{K} w_i}$。\n- 多数投票分数：$m = \\frac{1}{K}\\sum_{i=1}^{K} y_i$。\n- 具体的DSC值：$s_1=0.90$，$s_2=0.88$，$s_3=0.86$，$s_4=0.85$，$s_5=0.30$。\n- 具体的调节常数：$c=0.10$。\n- 具体的图谱投票：$y_1=0$，$y_2=0$，$y_3=1$，$y_4=1$，$y_5=1$。\n- 目标：计算 $p_{\\mathrm{fused}} - m$ 的精确值。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在医学图像分析领域具有科学依据，特别涉及多图谱分割的标准技术（Dice系数、稳健标签融合、Huber M-估计）。定义精确且数学上合理。所有必要数据均已提供，没有矛盾或歧义。问题提法恰当且客观。\n\n### 第3步：结论与行动\n问题被视为有效。将提供完整的解答。\n\n目标是计算差值 $p_{\\mathrm{fused}} - m$。这需要计算两个量：多数投票分数 $m$ 和稳健融合的后验概率 $p_{\\mathrm{fused}}$。\n\n首先，我们计算多数投票分数 $m$。当 $K=5$ 且图谱投票为 $y_1=0$、$y_2=0$、$y_3=1$、$y_4=1$ 和 $y_5=1$ 时，投票总和为：\n$$\n\\sum_{i=1}^{5} y_i = 0 + 0 + 1 + 1 + 1 = 3\n$$\n因此，多数投票分数为：\n$$\nm = \\frac{1}{K}\\sum_{i=1}^{5} y_i = \\frac{3}{5}\n$$\n\n接下来，我们计算稳健融合的后验概率 $p_{\\mathrm{fused}}$。这首先需要计算每个图谱的权重 $w_i$。权重 $w_i$ 取决于残差 $r_i = 1 - s_i$。\n\n给定的图谱DSC值为：\n$s_1 = 0.90$\n$s_2 = 0.88$\n$s_3 = 0.86$\n$s_4 = 0.85$\n$s_5 = 0.30$\n\n相应的残差 $r_i = 1 - s_i$ 为：\n$r_1 = 1 - 0.90 = 0.10$\n$r_2 = 1 - 0.88 = 0.12$\n$r_3 = 1 - 0.86 = 0.14$\n$r_4 = 1 - 0.85 = 0.15$\n$r_5 = 1 - 0.30 = 0.70$\n\n权重 $w_i$ 是通过将残差的绝对值 $|r_i|$ 与Huber调节常数 $c=0.10$ 进行比较来确定的。由于所有的 $s_i \\in [0,1]$，残差 $r_i \\in [0,1]$，所以 $|r_i| = r_i$。权重的规则是：如果 $r_i \\le c$，则 $w_i = 1$；如果 $r_i > c$，则 $w_i = c/r_i$。\n\n我们计算每个图谱的权重：\n- 对于图谱1：$r_1 = 0.10$。由于 $r_1 \\le c$（即 $0.10 \\le 0.10$），权重为 $w_1 = 1$。\n- 对于图谱2：$r_2 = 0.12$。由于 $r_2 > c$（即 $0.12 > 0.10$），权重为 $w_2 = \\frac{c}{r_2} = \\frac{0.10}{0.12} = \\frac{10}{12} = \\frac{5}{6}$。\n- 对于图谱3：$r_3 = 0.14$。由于 $r_3 > c$（即 $0.14 > 0.10$），权重为 $w_3 = \\frac{c}{r_3} = \\frac{0.10}{0.14} = \\frac{10}{14} = \\frac{5}{7}$。\n- 对于图谱4：$r_4 = 0.15$。由于 $r_4 > c$（即 $0.15 > 0.10$），权重为 $w_4 = \\frac{c}{r_4} = \\frac{0.10}{0.15} = \\frac{10}{15} = \\frac{2}{3}$。\n- 对于图谱5：$r_5 = 0.70$。由于 $r_5 > c$（即 $0.70 > 0.10$），权重为 $w_5 = \\frac{c}{r_5} = \\frac{0.10}{0.70} = \\frac{10}{70} = \\frac{1}{7}$。\n\n现在我们可以计算 $p_{\\mathrm{fused}}$ 的组成部分。分子是加权投票的总和：\n$$\n\\sum_{i=1}^{5} w_i y_i = w_1 y_1 + w_2 y_2 + w_3 y_3 + w_4 y_4 + w_5 y_5\n$$\n代入 $w_i$ 和 $y_i$ 的值：\n$$\n\\sum_{i=1}^{5} w_i y_i = (1)(0) + \\left(\\frac{5}{6}\\right)(0) + \\left(\\frac{5}{7}\\right)(1) + \\left(\\frac{2}{3}\\right)(1) + \\left(\\frac{1}{7}\\right)(1)\n$$\n$$\n\\sum_{i=1}^{5} w_i y_i = \\frac{5}{7} + \\frac{2}{3} + \\frac{1}{7} = \\left(\\frac{5}{7} + \\frac{1}{7}\\right) + \\frac{2}{3} = \\frac{6}{7} + \\frac{2}{3}\n$$\n为了将这些分数相加，我们找到公分母，即 $21$：\n$$\n\\sum_{i=1}^{5} w_i y_i = \\frac{6 \\times 3}{7 \\times 3} + \\frac{2 \\times 7}{3 \\times 7} = \\frac{18}{21} + \\frac{14}{21} = \\frac{32}{21}\n$$\n$p_{\\mathrm{fused}}$ 的分母是所有权重的总和：\n$$\n\\sum_{i=1}^{5} w_i = w_1 + w_2 + w_3 + w_4 + w_5 = 1 + \\frac{5}{6} + \\frac{5}{7} + \\frac{2}{3} + \\frac{1}{7}\n$$\n我们对各项进行分组以便于求和：\n$$\n\\sum_{i=1}^{5} w_i = 1 + \\left(\\frac{5}{6} + \\frac{2}{3}\\right) + \\left(\\frac{5}{7} + \\frac{1}{7}\\right) = 1 + \\left(\\frac{5}{6} + \\frac{4}{6}\\right) + \\frac{6}{7} = 1 + \\frac{9}{6} + \\frac{6}{7} = 1 + \\frac{3}{2} + \\frac{6}{7}\n$$\n这些项的公分母是 $14$：\n$$\n\\sum_{i=1}^{5} w_i = \\frac{14}{14} + \\frac{3 \\times 7}{2 \\times 7} + \\frac{6 \\times 2}{7 \\times 2} = \\frac{14}{14} + \\frac{21}{14} + \\frac{12}{14} = \\frac{14 + 21 + 12}{14} = \\frac{47}{14}\n$$\n现在我们可以计算 $p_{\\mathrm{fused}}$：\n$$\np_{\\mathrm{fused}} = \\frac{\\sum_{i=1}^{5} w_i y_i}{\\sum_{i=1}^{5} w_i} = \\frac{32/21}{47/14} = \\frac{32}{21} \\times \\frac{14}{47} = \\frac{32 \\times (2 \\times 7)}{(3 \\times 7) \\times 47} = \\frac{32 \\times 2}{3 \\times 47} = \\frac{64}{141}\n$$\n最后，我们计算所需的差值 $p_{\\mathrm{fused}} - m$：\n$$\np_{\\mathrm{fused}} - m = \\frac{64}{141} - \\frac{3}{5}\n$$\n公分母是 $141 \\times 5 = (3 \\times 47) \\times 5 = 705$：\n$$\np_{\\mathrm{fused}} - m = \\frac{64 \\times 5}{141 \\times 5} - \\frac{3 \\times 141}{5 \\times 141} = \\frac{320}{705} - \\frac{423}{705} = \\frac{320 - 423}{705} = \\frac{-103}{705}\n$$\n分子 $103$ 是一个质数。分母是 $705 = 3 \\times 5 \\times 47$。由于 $103$ 不是 $705$ 的因子，该分数已是最简形式。\n最终结果是 $-\\frac{103}{705}$。", "answer": "$$\\boxed{-\\frac{103}{705}}$$", "id": "4529158"}]}