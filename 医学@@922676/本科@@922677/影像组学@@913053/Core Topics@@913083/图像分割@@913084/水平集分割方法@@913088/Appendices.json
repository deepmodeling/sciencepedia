{"hands_on_practices": [{"introduction": "在任何水平集方法应用中，第一步都是定义一个初始轮廓。本练习将指导您如何将一个简单的几何形状（一个圆）转化为像素网格上的离散水平集函数 $\\phi$ [@problem_id:4548887]。这个过程将帮助您理解连续的数学理想与数字图像的离散现实之间的重要联系，这是将理论应用于实践的基础。", "problem": "一个二维放射学切片被建模为一个大小为 $128 \\times 128$ 像素的离散图像网格。在水平集分割中，演化的轮廓被隐式地表示为一个嵌入函数 $\\phi$ 的零水平集，约定在分割的感兴趣区域 (ROI) 内部 $\\phi  0$，而在外部 $\\phi  0$。位于坐标 $(i_{1}, j_{1})$ 和 $(i_{2}, j_{2})$ 的两个像素中心之间的欧几里得距离定义为 $\\sqrt{(i_{1} - i_{2})^{2} + (j_{1} - j_{2})^{2}}$，并且像素中心位于整数坐标 $(i, j)$ 处，其中 $i, j \\in \\{0, 1, \\dots, 127\\}$。假设圆形种子区域的中心位于 $(i_{0}, j_{0}) = (64, 64)$，半径为 $r = 13$ 像素。\n\n仅使用水平集嵌入函数的零水平集编码目标轮廓这一核心定义，在此网格上构建一个初始的 $\\phi$，将给定的圆形种子区域编码为有向嵌入，然后计算离散像素坐标中的零水平集，即所有满足 $\\phi(i, j) = 0$ 的整数对 $(i, j)$ 的集合。将最终的 $(i, j)$ 对列表表示为一个单行矩阵，按 $i$ 然后按 $j$ 的升序字典序排序。无需舍入；坐标是精确的整数且无量纲。", "solution": "该问题要求为一个圆形区域构建一个水平集函数 $\\phi$，并在离散像素网格上确定其零水平集。水平集函数 $\\phi$ 隐式地将轮廓表示为满足 $\\phi=0$ 的点的集合。$\\phi$ 的符号表示一个点是在区域内部（$\\phi0$）还是外部（$\\phi0$）。\n\n对于一个几何形状，最自然的嵌入函数选择是有向距离函数 (SDF)。对于坐标为 $(i, j)$ 的点和一个以 $(i_0, j_0)$ 为中心、半径为 $r$ 的圆形轮廓，SDF 定义为该点到中心的欧几里得距离减去半径：\n$$\n\\phi(i, j) = \\sqrt{(i - i_{0})^{2} + (j - j_{0})^{2}} - r\n$$\n对于圆内的点（到中心的距离小于 $r$），此函数为负；对于圆外的点，此函数为正；对于恰好在圆上的点，此函数为零。\n\n问题指定圆形种子区域的中心为 $(i_0, j_0) = (64, 64)$，半径为 $r = 13$。像素坐标 $(i, j)$ 是整数。我们的任务是找到零水平集，即所有满足 $\\phi(i, j) = 0$ 的整数对 $(i, j)$ 的集合。\n将 $\\phi(i, j)$ 的表达式设为零，得到：\n$$\n\\sqrt{(i - 64)^{2} + (j - 64)^{2}} - 13 = 0\n$$\n$$\n\\sqrt{(i - 64)^{2} + (j - 64)^{2}} = 13\n$$\n将方程两边平方，我们得到：\n$$\n(i - 64)^{2} + (j - 64)^{2} = 13^{2} = 169\n$$\n这是一个丢番图方程，表示整数格点上的一个圆。我们需要找到所有的整数解。我们引入变量替换来简化问题：\n令 $x = i - 64$ 和 $y = j - 64$。方程变为：\n$$\nx^{2} + y^{2} = 169\n$$\n我们需要找到所有满足此方程的整数对 $(x, y)$。这些数对与勾股数有关。我们可以通过测试 $x$ 从 $0$ 到 $\\lfloor\\sqrt{169}\\rfloor = 13$ 的整数值来系统地找到整数解。\n\n- 如果 $x=0$，$y^2 = 169 \\implies y = \\pm 13$。这得到数对 $(0, 13)$ 和 $(0, -13)$。\n- 如果 $x=1$，$y^2 = 169 - 1 = 168$，不是完全平方数。\n- 如果 $x=2$，$y^2 = 169 - 4 = 165$，不是完全平方数。\n- 如果 $x=3$，$y^2 = 169 - 9 = 160$，不是完全平方数。\n- 如果 $x=4$，$y^2 = 169 - 16 = 153$，不是完全平方数。\n- 如果 $x=5$，$y^2 = 169 - 25 = 144 \\implies y = \\pm 12$。这得到数对 $(5, 12)$ 和 $(5, -12)$。\n- 如果 $x=6$，$y^2 = 169 - 36 = 133$，不是完全平方数。\n- 如果 $x=7$，$y^2 = 169 - 49 = 120$，不是完全平方数。\n- 如果 $x=8$，$y^2 = 169 - 64 = 105$，不是完全平方数。\n- 如果 $x=9$，$y^2 = 169 - 81 = 88$，不是完全平方数。\n- 如果 $x=10$，$y^2 = 169 - 100 = 69$，不是完全平方数。\n- 如果 $x=11$，$y^2 = 169 - 121 = 48$，不是完全平方数。\n- 如果 $x=12$，$y^2 = 169 - 144 = 25 \\implies y = \\pm 5$。这得到数对 $(12, 5)$ 和 $(12, -5)$。\n- 如果 $x=13$，$y^2 = 169 - 169 = 0 \\implies y = 0$。这得到数对 $(13, 0)$。\n\n根据对称性，如果 $(x, y)$ 是一个解，那么 $(-x, y)$, $(x, -y)$, $(-x, -y)$, $(y, x)$, $(-y, x)$, $(y, -x)$ 和 $(-y, -x)$ 也是解。整理所有唯一的整数对 $(x, y)$：\n1. 从基本对 $(0, 13)$ 得到：$(0, 13), (0, -13), (13, 0), (-13, 0)$。\n2. 从基本对 $(5, 12)$ 得到：$(5, 12), (5, -12), (-5, 12), (-5, -12), (12, 5), (12, -5), (-12, 5), (-12, -5)$。\n\n这总共给出了 $4 + 8 = 12$ 个关于 $(x, y)$ 的整数解。\n\n现在，我们使用 $i = x + 64$ 和 $j = y + 64$ 将这些解转换回原始的 $(i, j)$ 坐标系：\n- $(x,y) = (0, 13) \\implies (i,j) = (64, 77)$\n- $(x,y) = (0, -13) \\implies (i,j) = (64, 51)$\n- $(x,y) = (13, 0) \\implies (i,j) = (77, 64)$\n- $(x,y) = (-13, 0) \\implies (i,j) = (51, 64)$\n- $(x,y) = (5, 12) \\implies (i,j) = (69, 76)$\n- $(x,y) = (5, -12) \\implies (i,j) = (69, 52)$\n- $(x,y) = (-5, 12) \\implies (i,j) = (59, 76)$\n- $(x,y) = (-5, -12) \\implies (i,j) = (59, 52)$\n- $(x,y) = (12, 5) \\implies (i,j) = (76, 69)$\n- $(x,y) = (12, -5) \\implies (i,j) = (76, 59)$\n- $(x,y) = (-12, 5) \\implies (i,j) = (52, 69)$\n- $(x,y) = (-12, -5) \\implies (i,j) = (52, 59)$\n\n这 $12$ 个点构成了离散的零水平集。最后一步是按升序字典序（先按 $i$，再按 $j$）对这些数对进行排序：\n1. $i=51$：$(51, 64)$\n2. $i=52$：$(52, 59), (52, 69)$\n3. $i=59$：$(59, 52), (59, 76)$\n4. $i=64$：$(64, 51), (64, 77)$\n5. $i=69$：$(69, 52), (69, 76)$\n6. $i=76$：$(76, 59), (76, 69)$\n7. $i=77$：$(77, 64)$\n\n最终排序后的数对列表是：\n$(51, 64), (52, 59), (52, 69), (59, 52), (59, 76), (64, 51), (64, 77), (69, 52), (69, 76), (76, 59), (76, 69), (77, 64)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(51, 64)  (52, 59)  (52, 69)  (59, 52)  (59, 76)  (64, 51)  (64, 77)  (69, 52)  (69, 76)  (76, 59)  (76, 69)  (77, 64)\n\\end{pmatrix}\n}\n$$", "id": "4548887"}, {"introduction": "水平集的演化通常由其自身的几何特性驱动，尤其是曲率。本练习将挑战一项关键任务：使用有限差分法从离散的 $\\phi$ 场中计算曲率 [@problem_id:4548936]。此练习强调了数值近似和精度分析的重要性，这是科学计算中的一项核心技能，能让您深入了解理论公式在实际计算中是如何实现的。", "problem": "在影像组学分割中使用水平集方法时，界面被表示为一个标量场 $\\phi(x,y)$ 的零水平集，其对演化的几何影响由平均曲率 $\\kappa$ 决定。平均曲率 $\\kappa$ 定义为单位法向量场的散度，即 $\\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{\\left\\lvert \\nabla \\phi \\right\\rvert} \\right)$。考虑一个二维均匀采样网格，其网格间距为 $\\Delta x = \\Delta y = 1$ mm。设水平集函数为一个以原点为中心、半径为 $R$ 的圆的有符号距离函数，即 $\\phi(x,y) = \\sqrt{x^{2} + y^{2}} - R$，其中 $R = 2$ mm。您需要在网格节点 $(x_{0}, y_{0}) = (2\\ \\text{mm}, 0\\ \\text{mm})$ 处，在由点集 $(x, y) \\in \\{1, 2, 3\\}\\ \\text{mm} \\times \\{-1, 0, 1\\}\\ \\text{mm}$ 组成的局部 $3 \\times 3$ 模板上，对 $\\phi$ 应用二阶中心差分来近似计算 $\\kappa$。将网格节点上 $\\phi$ 的计算值视为精确值。将得到的离散曲率 $\\kappa_{\\text{FD}}$ 与零水平集上圆的解析曲率（等于 $1/R$）进行比较。计算绝对误差 $\\left\\lvert \\kappa_{\\text{FD}} - \\frac{1}{R} \\right\\rvert$ 并将其作为您的唯一最终答案。将最终答案四舍五入至四位有效数字。最终答案以 $\\mathrm{mm}^{-1}$ 为单位表示。", "solution": "任务是计算特定水平集函数的数值近似平均曲率与其解析值之间的绝对误差。平均曲率 $\\kappa$ 定义为水平集函数 $\\phi$ 的单位法向量场的散度。\n$$ \\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{\\left\\lvert \\nabla \\phi \\right\\rvert} \\right) $$\n在二维笛卡尔坐标系 $(x,y)$ 中，该表达式展开为：\n$$ \\kappa = \\frac{\\phi_{xx}\\phi_y^2 - 2\\phi_x\\phi_y\\phi_{xy} + \\phi_{yy}\\phi_x^2}{(\\phi_x^2 + \\phi_y^2)^{3/2}} $$\n其中下标表示偏导数（例如，$\\phi_x = \\frac{\\partial \\phi}{\\partial x}$，$\\phi_{xy} = \\frac{\\partial^2 \\phi}{\\partial x \\partial y}$）。\n\n给定水平集函数 $\\phi(x,y) = \\sqrt{x^2 + y^2} - R$，半径 $R=2$ mm。网格间距为 $\\Delta x = \\Delta y = 1$ mm。我们需要在点 $(x_0, y_0) = (2, 0)$ 处，使用在指定的 $3 \\times 3$ 模板上的二阶中心差分来近似计算 $\\kappa$。该模板由 $x \\in \\{1, 2, 3\\}$ 和 $y \\in \\{-1, 0, 1\\}$ 的网格节点 $(x,y)$ 组成。\n\n首先，我们在模板上的 9 个点处计算 $\\phi(x,y)$ 的值。\n$\\phi(x,y) = \\sqrt{x^2 + y^2} - 2$ 的值为：\n- $\\phi(1, -1) = \\sqrt{1^2 + (-1)^2} - 2 = \\sqrt{2} - 2$\n- $\\phi(1, 0) = \\sqrt{1^2 + 0^2} - 2 = 1 - 2 = -1$\n- $\\phi(1, 1) = \\sqrt{1^2 + 1^2} - 2 = \\sqrt{2} - 2$\n- $\\phi(2, -1) = \\sqrt{2^2 + (-1)^2} - 2 = \\sqrt{5} - 2$\n- $\\phi(2, 0) = \\sqrt{2^2 + 0^2} - 2 = 2 - 2 = 0$\n- $\\phi(2, 1) = \\sqrt{2^2 + 1^2} - 2 = \\sqrt{5} - 2$\n- $\\phi(3, -1) = \\sqrt{3^2 + (-1)^2} - 2 = \\sqrt{10} - 2$\n- $\\phi(3, 0) = \\sqrt{3^2 + 0^2} - 2 = 3 - 2 = 1$\n- $\\phi(3, 1) = \\sqrt{3^2 + 1^2} - 2 = \\sqrt{10} - 2$\n\n接下来，我们使用二阶中心差分公式来近似计算 $\\phi$ 在点 $(x_0, y_0) = (2, 0)$ 处的偏导数。当 $\\Delta x = \\Delta y = 1$ 时，这些公式为：\n- $\\phi_x \\approx \\frac{\\phi(x_0+\\Delta x, y_0) - \\phi(x_0-\\Delta x, y_0)}{2\\Delta x} = \\frac{\\phi(3,0) - \\phi(1,0)}{2(1)} = \\frac{1 - (-1)}{2} = 1$\n- $\\phi_y \\approx \\frac{\\phi(x_0, y_0+\\Delta y) - \\phi(x_0, y_0-\\Delta y)}{2\\Delta y} = \\frac{\\phi(2,1) - \\phi(2,-1)}{2(1)} = \\frac{(\\sqrt{5}-2) - (\\sqrt{5}-2)}{2} = 0$\n- $\\phi_{xx} \\approx \\frac{\\phi(x_0+\\Delta x, y_0) - 2\\phi(x_0, y_0) + \\phi(x_0-\\Delta x, y_0)}{(\\Delta x)^2} = \\frac{\\phi(3,0) - 2\\phi(2,0) + \\phi(1,0)}{1^2} = \\frac{1 - 2(0) + (-1)}{1} = 0$\n- $\\phi_{yy} \\approx \\frac{\\phi(x_0, y_0+\\Delta y) - 2\\phi(x_0, y_0) + \\phi(x_0, y_0-\\Delta y)}{(\\Delta y)^2} = \\frac{\\phi(2,1) - 2\\phi(2,0) + \\phi(2,-1)}{1^2} = \\frac{(\\sqrt{5}-2) - 2(0) + (\\sqrt{5}-2)}{1} = 2\\sqrt{5} - 4$\n- $\\phi_{xy} \\approx \\frac{\\phi(x_0+\\Delta x, y_0+\\Delta y) - \\phi(x_0+\\Delta x, y_0-\\Delta y) - \\phi(x_0-\\Delta x, y_0+\\Delta y) + \\phi(x_0-\\Delta x, y_0-\\Delta y)}{4\\Delta x \\Delta y} = \\frac{\\phi(3,1) - \\phi(3,-1) - \\phi(1,1) + \\phi(1,-1)}{4(1)(1)}$\n  代入数值：\n  $\\phi_{xy} \\approx \\frac{(\\sqrt{10}-2) - (\\sqrt{10}-2) - (\\sqrt{2}-2) + (\\sqrt{2}-2)}{4} = \\frac{0 - 0}{4} = 0$\n\n现在，我们将这些离散导数值代入 $\\kappa$ 的表达式中，以求得有限差分近似值 $\\kappa_{\\text{FD}}$：\n$$ \\kappa_{\\text{FD}} = \\frac{(0)(0)^2 - 2(1)(0)(0) + (2\\sqrt{5}-4)(1)^2}{((1)^2 + (0)^2)^{3/2}} = \\frac{2\\sqrt{5}-4}{1^{3/2}} = 2\\sqrt{5}-4 $$\n其数值为 $\\kappa_{\\text{FD}} \\approx 2(2.236068) - 4 = 4.472136 - 4 = 0.472136$ mm$^{-1}$。\n\n半径为 $R$ 的圆的解析曲率为 $\\kappa_{\\text{analytic}} = \\frac{1}{R}$。给定 $R=2$ mm，我们有：\n$$ \\kappa_{\\text{analytic}} = \\frac{1}{2} = 0.5 \\ \\mathrm{mm}^{-1} $$\n最后，我们计算离散值和解析值之间的绝对误差：\n$$ \\text{Error} = \\left\\lvert \\kappa_{\\text{FD}} - \\kappa_{\\text{analytic}} \\right\\rvert = \\left\\lvert (2\\sqrt{5}-4) - \\frac{1}{2} \\right\\rvert = \\left\\lvert 2\\sqrt{5} - 4.5 \\right\\rvert $$\n其数值为：\n$$ \\text{Error} \\approx |0.472135955 - 0.5| = |-0.027864045| = 0.027864045 $$\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $2$、$7$、$8$ 和 $6$。随后的数字是 $4$，因此我们舍去。\n$$ \\text{Error} \\approx 0.02786 $$\n用标准科学记数法表示，结果为 $2.786 \\times 10^{-2}$。单位是 $\\mathrm{mm}^{-1}$。", "answer": "$$\\boxed{2.786 \\times 10^{-2}}$$", "id": "4548936"}, {"introduction": "掌握了静态表示和属性计算后，最终的挑战是实现轮廓的动态演化。本练习将引导您为哈密顿-雅可比方程（许多水平集方法的核心）构建一个数值求解器 [@problem_id:4548852]。它聚焦于数值稳定性这一关键概念，特别是 Courant–Friedrichs–Lewy (CFL) 条件，这是任何成功模拟的基础，也是从理论模型走向可靠应用的必经之路。", "problem": "您将从基本定义出发，实现并分析一个用于放射组学导向分割的二维显式水平集方案，该方案求解哈密顿-雅可比方程。考虑一个标量场 $\\,\\phi(x,y,t)\\,$ 的演化，其受以下偏微分方程控制\n$$\n\\partial_t \\phi + F \\, \\lvert \\nabla \\phi \\rvert = 0,\n$$\n其中速度函数 $\\,F \\ge 0\\,$ 为常数，定义在一个周期性方形区域上。您的任务是推导、实现并凭经验验证一个一阶显式格式在库朗-弗里德里希斯-列维 (Courant–Friedrichs–Lewy, CFL) 条件下的稳定性。\n\n基本原理和数值设置：\n- 该方程是一个哈密顿-雅可比方程，其哈密顿量为 $\\,H(p_x,p_y) = F \\sqrt{p_x^2 + p_y^2}\\,$，是放射组学中许多水平集分割方法的数学核心。\n- 在区域 $[0,1) \\times [0,1)$ 上使用一个均匀的周期性网格，其中 $\\,x\\,$ 方向有 $\\,N_x\\,$ 个点，$\\,y\\,$ 方向有 $\\,N_y\\,$ 个点。令 $\\,\\Delta x = 1/N_x\\,$ 且 $\\,\\Delta y = 1/N_y\\,$。\n- 在网格节点上，将 $\\,\\phi(x,y,0)\\,$ 初始化为 $\\,\\sin(2\\pi x)\\sin(2\\pi y)\\,$。\n- 使用步长为 $\\,\\Delta t\\,$ 的前向欧拉格式对时间进行离散化。对于 $\\,\\lvert \\nabla \\phi \\rvert\\,$，使用由单边有限差分构造的一阶单调戈杜诺夫 (Godunov) 数值哈密顿量。令单边差分为\n$$\nD_x^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i-1,j}}{\\Delta x},\\quad\nD_x^+ \\phi_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x},\\quad\nD_y^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i,j-1}}{\\Delta y},\\quad\nD_y^+ \\phi_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j}}{\\Delta y},\n$$\n其中索引为周期性的。对于 $\\,F \\ge 0\\,$，使用单调戈杜诺夫 (Godunov) 近似\n$$\nG_{i,j} = \\sqrt{\n\\max\\!\\big( \\max(D_x^-\\phi_{i,j},0)^2,\\;\\min(D_x^+\\phi_{i,j},0)^2 \\big)\\;+\\;\n\\max\\!\\big( \\max(D_y^-\\phi_{i,j},0)^2,\\;\\min(D_y^+\\phi_{i,j},0)^2 \\big)\n},\n$$\n并通过以下方式更新\n$$\n\\phi_{i,j}^{n+1} = \\phi_{i,j}^{n} - \\Delta t \\, F \\, G_{i,j}.\n$$\n\n解析稳定性目标：\n- 从哈密顿-雅可比结构以及显式单调格式在一致范数下保持为压缩映射的要求出发，推导关于 $\\,F\\,$, $\\,\\Delta x\\,$ 和 $\\,\\Delta y\\,$ 的最严格 $\\,\\Delta t\\,$ 上界，使得前向欧拉更新在二维所有网格点上都是稳定的。\n- 您的推导应基于对哈密顿量关于每个空间导数的方向利普希茨常数进行界定，并遵循以下原则：前向欧拉法要求经过适当缩放的方向贡献之和不超过一来保持单调性。不要假定任何未说明的公式；从哈密顿-雅可比定义和数值哈密顿量的单调性出发。\n\n经验稳定性验证：\n- 对于 $\\,F \\ge 0\\,$，连续方程的一个必要性质是 $\\,\\partial_t \\phi \\le 0\\,$ 逐点成立，因此在一个有效的 CFL 约束下，对于一个稳定的单调格式，$\\,\\phi\\,$ 的离散最大值应随时间非增。\n- 对于每个测试用例，如果整个模拟过程中同时满足以下两个条件，则将数值演化分类为稳定：\n  1. $\\,\\phi\\,$ 中没有出现非数值（即，没有 $\\,\\mathrm{NaN}\\,$ 或 $\\,\\pm\\infty\\,$）。\n  2. 在任何时间步，离散最大值 $\\,\\max_{i,j} \\phi_{i,j}^n\\,$ 的增量相对于其初始值不超过 $\\,10^{-8}\\,$ 的容差。\n\n测试套件：\n- 使用以下四组参数。对于每一组，令 $\\,\\Delta t_{\\mathrm{theory}}\\,$ 为您分析得出的理论最大稳定时间步长。使用给定的因子 $\\,\\alpha\\,$，以 $\\,\\Delta t = \\alpha \\, \\Delta t_{\\mathrm{theory}}\\,$ 进行指定步数的演化。\n  - 用例 $\\,1\\,$ (理想情况): $\\,N_x = 64\\,$, $\\,N_y = 64\\,$, $\\,F = 1.0\\,$, 步数 $\\,= 200\\,$, $\\,\\alpha = 0.90\\,$.\n  - 用例 $\\,2\\,$ (边界情况): $\\,N_x = 64\\,$, $\\,N_y = 64\\,$, $\\,F = 1.0\\,$, 步数 $\\,= 200\\,$, $\\,\\alpha = 1.00\\,$.\n  - 用例 $\\,3\\,$ (违反 CFL): $\\,N_x = 64\\,$, $\\,N_y = 64\\,$, $\\,F = 1.0\\,$, 步数 $\\,= 200\\,$, $\\,\\alpha = 1.10\\,$.\n  - 用例 $\\,4\\,$ (各向异性网格, 接近违反): $\\,N_x = 128\\,$, $\\,N_y = 32\\,$, $\\,F = 0.5\\,$, 步数 $\\,= 300\\,$, $\\,\\alpha = 1.05\\,$.\n\n要求的最终输出格式：\n- 您的程序必须按顺序运行这四个用例，并生成一行输出，其中包含四个稳定性的分类，形式为方括号内以逗号分隔的布尔值列表，例如 $\\,\\big[$True,False,True,False$\\big]$（这只是格式示例；您的结果必须反映您的计算）。", "solution": "该问题要求为哈密顿-雅可比方程 $\\,\\partial_t \\phi + F \\, \\lvert \\nabla \\phi \\rvert = 0\\,$ 的一阶显式格式推导稳定性条件，并进行后续的数值实现和验证。\n\n### CFL 条件的解析推导\n\n任务是为给定的数值格式推导库朗-弗里德里希斯-列维 (CFL) 条件。该格式是一个显式时间前向方法：\n$$\n\\phi_{i,j}^{n+1} = \\phi_{i,j}^{n} - \\Delta t \\, F \\, G_{i,j}(\\phi^n)\n$$\n其中 $\\,G_{i,j}\\,$ 是在网格点 $\\,(i,j)\\,$ 处对 $\\,\\lvert \\nabla \\phi \\rvert\\,$ 的数值近似。对于一个用于双曲型偏微分方程的一阶、显式、单调格式，要使其稳定，时间步长 $\\,\\Delta t\\,$ 必须足够小，以确保信息在每个时间步内传播不超过一个网格单元。这被概括在 CFL 条件中。\n\n该推导基于一个原理：对于应用于双曲型方程的前向欧拉格式，其稳定性（特别是保持单调性并确保在最大范数下收敛）要求在所有空间维度上，经过缩放的最大特征速度之和不超过 1。问题陈述本身也提到了这一点：“经过适当缩放的方向贡献之和不超过一”。\n\n连续的哈密顿-雅可比方程是 $\\,\\partial_t \\phi + H(\\nabla \\phi) = 0\\,$，其哈密顿量为 $\\,H(p_x, p_y) = F \\sqrt{p_x^2 + p_y^2}\\,$。代表信息传播速度的特征速度由哈密顿量对其参数向量 $\\,p = \\nabla \\phi = (p_x, p_y)\\,$ 的分量的偏导数给出：\n$$\nv_x = \\frac{\\partial H}{\\partial p_x} = \\frac{F p_x}{\\sqrt{p_x^2 + p_y^2}}\n$$\n$$\nv_y = \\frac{\\partial H}{\\partial p_y} = \\frac{F p_y}{\\sqrt{p_x^2 + p_y^2}}\n$$\nCFL 条件要求基于每个方向上的最大可能速度来限制时间步长。我们必须找到在所有可能的梯度 $\\,(p_x, p_y) \\neq (0,0)\\,$ 上这些速度绝对值的上确界：\n$$\n\\max |v_x| = \\sup_{p_x, p_y} \\left| \\frac{F p_x}{\\sqrt{p_x^2 + p_y^2}} \\right| = \\sup_{p_x, p_y} F \\left| \\frac{p_x}{\\sqrt{p_x^2 + p_y^2}} \\right| = F\n$$\n当 $\\,p_y = 0\\,$ 且 $\\,p_x \\neq 0\\,$ 时，达到最大值 $\\,F\\,$，此时分数部分变为 $\\,\\pm 1\\,$。对称地，对于 $\\,y\\,$ 方向：\n$$\n\\max |v_y| = \\sup_{p_x, p_y} \\left| \\frac{F p_y}{\\sqrt{p_x^2 + p_y^2}} \\right| = F\n$$\n对于多维一阶显式格式，CFL 条件由这些最大速度之和给出，每个速度都按相应的网格间距进行缩放：\n$$\n\\Delta t \\left( \\frac{\\max |v_x|}{\\Delta x} + \\frac{\\max |v_y|}{\\Delta y} \\right) \\le 1\n$$\n代入我们求得的最大速度：\n$$\n\\Delta t \\left( \\frac{F}{\\Delta x} + \\frac{F}{\\Delta y} \\right) \\le 1\n$$\n求解 $\\,\\Delta t\\,$ 得到时间步长的最严格上界，我们将其定义为 $\\,\\Delta t_{\\mathrm{theory}}\\,$：\n$$\n\\Delta t \\le \\frac{1}{F \\left( \\frac{1}{\\Delta x} + \\frac{1}{\\Delta y} \\right)}\n$$\n因此，最大稳定时间步长为：\n$$\n\\Delta t_{\\mathrm{theory}} = \\frac{1}{F \\left( \\frac{1}{\\Delta x} + \\frac{1}{\\Delta y} \\right)} = \\frac{\\Delta x \\Delta y}{F(\\Delta x + \\Delta y)}\n$$\n这个推导满足了从哈密顿-雅可比结构和显式格式的稳定性原理出发的要求。\n\n### 实现与验证策略\n\n将使用 Python 的 `numpy` 库实现数值格式，从而进行经验验证。\n\n1.  **网格和初始状态**：对于每个测试用例，创建一个大小为 $\\,N_y \\times N_x\\,$ 的二维网格。使用坐标 $\\,x_i = i \\Delta x\\,$ 和 $\\,y_j = j \\Delta y\\,$ 根据 $\\,\\phi(x,y,0) = \\sin(2\\pi x)\\sin(2\\pi y)\\,$ 初始化场 $\\,\\phi\\,$。将此初始场的最大值存储为 $\\,\\max_{i,j} \\phi_{i,j}^0\\,$。\n\n2.  **时间循环**：模拟将 $\\,\\phi\\,$ 演化指定的步数。在每个步骤中：\n    a.  **有限差分**：为整个网格计算单边空间差分 $\\,D_x^-\\phi, D_x^+\\phi, D_y^-\\phi, D_y^+\\phi\\,$。使用 `numpy.roll` 高效处理周期性边界条件，该函数沿给定轴移动数组元素。\n    b.  **数值通量 (G)**：根据指定的公式，使用计算出的差分在每个网格点计算戈杜诺夫 (Godunov) 项 $\\,G_{i,j}\\,$。为提高效率，使用向量化的 `numpy` 操作（`numpy.maximum`, `numpy.minimum`, `numpy.sqrt`）。\n    c.  **更新**：使用前向欧拉规则将场 $\\,\\phi\\,$ 更新到下一个时间步 $\\,\\phi^{n+1}\\,$：$\\,\\phi_{i,j}^{n+1} = \\phi_{i,j}^{n} - \\Delta t F G_{i,j}\\,$。\n\n3.  **稳定性检查**：在每个时间步结束时，检查两个条件：\n    a.  数组 $\\,\\phi\\,$ 中是否存在任何非有限数（`NaN` 或 `inf`），这是数值爆炸的明确迹象。\n    b.  场的最大值是否已超过一个小的容差：$\\,\\max_{i,j} \\phi_{i,j}^{n+1}  \\max_{i,j} \\phi_{i,j}^0 + 10^{-8}\\,$。连续方程意味着最大值应该是非增的，因此任何显著增加都表明不稳定。\n\n如果在模拟过程中满足任一条件，则该测试用例的演化被分类为不稳定 (`False`)，并且该用例的循环终止。如果模拟在不触发这些条件的情况下完成所有步骤，则分类为稳定 (`True`)。收集所有四个测试用例的布尔结果，并以要求的格式打印。", "answer": "$$\\boxed{\\text{[True, True, False, False]}}$$", "id": "4548852"}]}