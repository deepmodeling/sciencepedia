{"hands_on_practices": [{"introduction": "在理想情况下，分割阈值的选择应能最大限度地减少将一个像素错误分类到另一个类别中的概率。本练习 [@problem_id:4560843] 将引导您应用贝叶斯决策理论，这是一个统计决策的基石，来从数学上推导出这样一个最优阈值。该场景模拟了医学物理学中常见的校准任务，即使用具有已知属性的体模来确定分割参数。", "problem": "一个放射组学团队旨在为计算机断层扫描 (CT) 中的一种种子区域生长分割算法校准强度阈值。他们使用一个具有两个均匀隔室的圆柱形体模：一个充满水的背景隔室和一个由组织模拟聚合物制成的插入物。扫描是采用与临床工作流程相同的协议进行的。在体模上手动绘制的感兴趣区域 (ROI) 内，由于扫描仪噪声的影响，每个隔室中观测到的体素强度（单位为亨斯菲尔德单位 (HU)）可以很好地用高斯概率密度函数 (PDF) 进行建模。重复测量证实，在所关注的协议下，各个隔室的噪声方差近似相等。该团队将在区域生长步骤中使用一个单一的全局阈值来进行基于强度的包含判断。\n\n从体模中获得了以下校准参数：\n- 背景隔室：平均强度 $\\mu_{b} = 0$ HU。\n- 插入物隔室：平均强度 $\\mu_{t} = 60$ HU。\n- 两个隔室的共同标准差：$\\sigma = 12$ HU。\n- ROI 面积分数，用于近似类别先验概率：背景为 $\\pi_{b} = 0.85$，插入物为 $\\pi_{t} = 0.15$。\n\n假设错分成本相等。从 Bayes 决策规则和高斯 PDF 定义出发，推导决策阈值 $T$（单位为 HU），该阈值在将强度为 $x$ 的体素分类为背景或插入物时，能够最小化总错分概率，并因此将用作种子区域生长中的包含阈值。您必须明确求出 $T$ 的闭式解，然后使用给定参数进行数值计算。以亨斯菲尔德单位 (HU) 表示最终阈值，并将您的数值答案四舍五入到四位有效数字。", "solution": "用户提供的问题经评估有效。其科学依据在于贝叶斯决策理论和医学影像中噪声的标准统计模型。该问题是适定的，提供了推导唯一解所需的所有参数。语言客观，在医学物理和放射组学的背景下，其设定是自洽且合理的。\n\n该问题要求确定一个最佳强度阈值 $T$，用于将强度为 $x$ 的体素分类为两类之一：背景 ($C_b$) 或组织插入物 ($C_t$)。最优性准则是最小化总错分概率，在错分成本相等的假设下，这通过应用 Bayes 决策规则来实现。决策阈值 $T$ 是两类后验概率相等的强度值。\n\n给定观测强度 $x$ 时，类别 $C_k$ 的后验概率由 Bayes 定理给出：\n$$P(C_k|x) = \\frac{p(x|C_k)P(C_k)}{p(x)}$$\n其中 $k \\in \\{b, t\\}$。此处，$P(C_k)$ 是类别 $C_k$ 的先验概率，由 $\\pi_k$ 给出。$p(x|C_k)$ 是类条件概率密度函数 (PDF) 或似然，表示在体素属于类别 $C_k$ 的条件下观测到强度 $x$ 的概率。$p(x)$ 是证据，是一个归一化常数。\n\n决策阈值 $T$ 是指体素等可能地属于任一类别时的 $x$ 值。这发生在后验概率相等时：\n$$P(C_b|T) = P(C_t|T)$$\n代入 Bayes 定理的表达式：\n$$\\frac{p(T|C_b)P(C_b)}{p(T)} = \\frac{p(T|C_t)P(C_t)}{p(T)}$$\n证据项 $p(T)$ 被消去，代入先验概率 $\\pi_b$ 和 $\\pi_t$，我们得到：\n$$p(T|C_b)\\pi_b = p(T|C_t)\\pi_t$$\n问题陈述，每个类别的体素强度都用高斯 PDF 建模。高斯 PDF 的一般形式是：\n$$f(x; \\mu, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$$\n对于我们的两个类别，似然函数为：\n$$p(x|C_b) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu_b)^2}{2\\sigma^2}\\right)$$\n$$p(x|C_t) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu_t)^2}{2\\sigma^2}\\right)$$\n注意，标准差 $\\sigma$ 对两个类别是共同的。\n\n将这些代入 $x=T$ 处的决策边界方程：\n$$\\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(T - \\mu_b)^2}{2\\sigma^2}\\right) \\pi_b = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(T - \\mu_t)^2}{2\\sigma^2}\\right) \\pi_t$$\n归一化因子 $\\frac{1}{\\sqrt{2\\pi}\\sigma}$ 从两侧消去：\n$$\\pi_b \\exp\\left(-\\frac{(T - \\mu_b)^2}{2\\sigma^2}\\right) = \\pi_t \\exp\\left(-\\frac{(T - \\mu_t)^2}{2\\sigma^2}\\right)$$\n为了解出 $T$，我们对两侧取自然对数：\n$$\\ln(\\pi_b) - \\frac{(T - \\mu_b)^2}{2\\sigma^2} = \\ln(\\pi_t) - \\frac{(T - \\mu_t)^2}{2\\sigma^2}$$\n重排各项以分离出对数项：\n$$\\frac{(T - \\mu_t)^2}{2\\sigma^2} - \\frac{(T - \\mu_b)^2}{2\\sigma^2} = \\ln(\\pi_t) - \\ln(\\pi_b)$$\n两侧同乘以 $2\\sigma^2$：\n$$(T - \\mu_t)^2 - (T - \\mu_b)^2 = 2\\sigma^2 (\\ln(\\pi_t) - \\ln(\\pi_b)) = -2\\sigma^2 (\\ln(\\pi_b) - \\ln(\\pi_t)) = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n展开平方项：\n$$(T^2 - 2T\\mu_t + \\mu_t^2) - (T^2 - 2T\\mu_b + \\mu_b^2) = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n$T^2$ 项消去：\n$$-2T\\mu_t + \\mu_t^2 + 2T\\mu_b - \\mu_b^2 = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n合并含有 $T$ 的项：\n$$2T(\\mu_b - \\mu_t) + (\\mu_t^2 - \\mu_b^2) = 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n分离出含有 $T$ 的项：\n$$2T(\\mu_b - \\mu_t) = (\\mu_b^2 - \\mu_t^2) + 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n$$2T(\\mu_b - \\mu_t) = (\\mu_b - \\mu_t)(\\mu_b + \\mu_t) + 2\\sigma^2 \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n假设 $\\mu_b \\neq \\mu_t$，我们可以用 $2(\\mu_b - \\mu_t)$ 除：\n$$T = \\frac{\\mu_b + \\mu_t}{2} + \\frac{\\sigma^2}{\\mu_b - \\mu_t} \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right)$$\n为了符合 $\\mu_t > \\mu_b$ 的惯例，我们可以将其重写为：\n$$T = \\frac{\\mu_b + \\mu_t}{2} - \\frac{\\sigma^2}{\\mu_t - \\mu_b} \\ln\\left(\\frac{\\pi_t}{\\pi_b}\\right) = \\frac{\\mu_b + \\mu_t}{2} + \\frac{\\sigma^2}{\\mu_t - \\mu_b} \\ln\\left(\\left(\\frac{\\pi_t}{\\pi_b}\\right)^{-1}\\right)$$\n$$T = \\frac{\\mu_b + \\mu_t}{2} + \\frac{\\sigma^2}{\\mu_t - \\mu_b} \\ln\\left(\\frac{\\pi_b}{\\pi_t}\\right)$$\n这就是最佳阈值 $T$ 的闭式表达式。第一项是类别均值之间的中点，第二项是考虑了不相等先验概率的校正因子。由于 $\\pi_b > \\pi_t$，对数项为正，这会将阈值从中点向概率较小的类别（插入物，$\\mu_t$）的均值方向移动。\n\n现在，我们代入给定的数值：\n- $\\mu_{b} = 0$ HU\n- $\\mu_{t} = 60$ HU\n- $\\sigma = 12$ HU\n- $\\pi_{b} = 0.85$\n- $\\pi_{t} = 0.15$\n\n$$T = \\frac{0 + 60}{2} + \\frac{12^2}{60 - 0} \\ln\\left(\\frac{0.85}{0.15}\\right)$$\n$$T = 30 + \\frac{144}{60} \\ln\\left(\\frac{17}{3}\\right)$$\n$$T = 30 + 2.4 \\ln\\left(\\frac{17}{3}\\right)$$\n计算数值：\n$$\\ln\\left(\\frac{17}{3}\\right) \\approx \\ln(5.66666...) \\approx 1.734601$$\n$$T \\approx 30 + 2.4 \\times 1.734601$$\n$$T \\approx 30 + 4.1630424$$\n$$T \\approx 34.1630424$$\n四舍五入到四位有效数字，最佳阈值为 $34.16$ HU。", "answer": "$$\\boxed{34.16}$$", "id": "4560843"}, {"introduction": "推导出理论上的最优阈值只是解决方案的一部分；我们还需要一种方法来量化和评估分割结果的质量。本练习 [@problem_id:4560855] 介绍了一种在医学图像分析中广泛使用的评估指标——戴斯相似系数（Dice Similarity Coefficient）。您将学习如何计算该系数，并利用它从多个候选阈值中凭经验选择出表现最佳的一个。", "problem": "一个放射组学流程通过首先应用全局强度阈值，然后使用一个从已知肿瘤种子点开始的连通分量区域生长步骤来约束结果，从而在二维医学图像中执行肿瘤分割。全局阈值产生一个掩模 $\\mathcal{M}_{t} = \\{ x \\,|\\, I(x) \\ge t \\}$，其中 $I(x)$ 是像素 $x$ 处的观测强度，$t$ 是一个无量纲的阈值。最终分割 $\\mathcal{S}_{t}$ 被定义为 $\\mathcal{M}_{t}$ 中包含该种子点的 4-连通分量。分割质量通过 Dice 相似系数与真实标准集 $\\mathcal{G}$ 进行评估，其定义为 $D(t) = \\dfrac{2|\\mathcal{S}_{t} \\cap \\mathcal{G}|}{|\\mathcal{S}_{t}| + |\\mathcal{G}|}$。\n\n给定真实标准肿瘤由 $|\\mathcal{G}| = 40$ 个像素组成。由于阈值化和区域生长连通性的综合作用，对于五个候选的无量纲阈值，以下测量计数成立：\n- 对于 $t = 5$：$|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 40$ 且 $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 12$。\n- 对于 $t = 6$：$|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 38$ 且 $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 8$。\n- 对于 $t = 7$：$|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 35$ 且 $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 4$。\n- 对于 $t = 8$：$|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 30$ 且 $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 2$。\n- 对于 $t = 9$：$|\\mathcal{S}_{t} \\cap \\mathcal{G}| = 20$ 且 $|\\mathcal{S}_{t} \\setminus \\mathcal{G}| = 0$。\n\n从上述形式化定义出发，确定使 Dice 相似系数 $D(t)$ 最大化的阈值 $t^{\\ast} \\in \\{5,6,7,8,9\\}$。将最终答案表示为单个无量纲数字 $t^{\\ast}$。无需四舍五入。", "solution": "问题陈述经评估有效。它具有科学依据、提法明确且客观。该问题描述了医学图像分割中的一个标准流程，使用了阈值化和区域生长方法，并通过 Dice 相似系数进行评估，这些都是放射组学领域中的成熟概念。解决问题所需的所有数据都已提供，并且没有内部矛盾或歧义。\n\n目标是从离散集 $\\{5, 6, 7, 8, 9\\}$ 中确定使 Dice 相似系数 $D(t)$ 最大化的阈值 $t^{\\ast}$。Dice 系数定义为：\n$$D(t) = \\frac{2|\\mathcal{S}_{t} \\cap \\mathcal{G}|}{|\\mathcal{S}_{t}| + |\\mathcal{G}|}$$\n其中 $\\mathcal{S}_{t}$ 是给定阈值 $t$ 的分割区域，$\\mathcal{G}$ 是真实标准区域。我们已知真实标准区域的大小为 $|\\mathcal{G}| = 40$。\n\n对于每个候选阈值 $t$，我们已知分割区域与真实标准区域的交集大小 $|\\mathcal{S}_{t} \\cap \\mathcal{G}|$（真阳性像素数），以及分割区域与真实标准区域的差集大小 $|\\mathcal{S}_{t} \\setminus \\mathcal{G}|$（假阳性像素数）。\n\n为了计算 $D(t)$，我们必须首先确定分割区域的大小 $|\\mathcal{S}_{t}|$。集合 $\\mathcal{S}_{t}$ 可以被分割成两个不相交的子集：与真实标准重叠的部分 $\\mathcal{S}_{t} \\cap \\mathcal{G}$，以及不重叠的部分 $\\mathcal{S}_{t} \\setminus \\mathcal{G}$。因此，分割区域的大小是这两部分大小之和：\n$$|\\mathcal{S}_{t}| = |\\mathcal{S}_{t} \\cap \\mathcal{G}| + |\\mathcal{S}_{t} \\setminus \\mathcal{G}|$$\n\n我们现在为五个给定的阈值分别计算 $|\\mathcal{S}_{t}|$ 并随后计算 $D(t)$。\n\n对于 $t = 5$：\n给定 $|\\mathcal{S}_{5} \\cap \\mathcal{G}| = 40$ 和 $|\\mathcal{S}_{5} \\setminus \\mathcal{G}| = 12$。\n分割区域的大小为 $|\\mathcal{S}_{5}| = 40 + 12 = 52$。\nDice 系数为 $D(5) = \\dfrac{2 \\times 40}{52 + 40} = \\dfrac{80}{92}$。\n\n对于 $t = 6$：\n给定 $|\\mathcal{S}_{6} \\cap \\mathcal{G}| = 38$ 和 $|\\mathcal{S}_{6} \\setminus \\mathcal{G}| = 8$。\n分割区域的大小为 $|\\mathcal{S}_{6}| = 38 + 8 = 46$。\nDice 系数为 $D(6) = \\dfrac{2 \\times 38}{46 + 40} = \\dfrac{76}{86}$。\n\n对于 $t = 7$：\n给定 $|\\mathcal{S}_{7} \\cap \\mathcal{G}| = 35$ 和 $|\\mathcal{S}_{7} \\setminus \\mathcal{G}| = 4$。\n分割区域的大小为 $|\\mathcal{S}_{7}| = 35 + 4 = 39$。\nDice 系数为 $D(7) = \\dfrac{2 \\times 35}{39 + 40} = \\dfrac{70}{79}$。\n\n对于 $t = 8$：\n给定 $|\\mathcal{S}_{8} \\cap \\mathcal{G}| = 30$ 和 $|\\mathcal{S}_{8} \\setminus \\mathcal{G}| = 2$。\n分割区域的大小为 $|\\mathcal{S}_{8}| = 30 + 2 = 32$。\nDice 系数为 $D(8) = \\dfrac{2 \\times 30}{32 + 40} = \\dfrac{60}{72}$。\n\n对于 $t = 9$：\n给定 $|\\mathcal{S}_{9} \\cap \\mathcal{G}| = 20$ 和 $|\\mathcal{S}_{9} \\setminus \\mathcal{G}| = 0$。\n分割区域的大小为 $|\\mathcal{S}_{9}| = 20 + 0 = 20$。\nDice 系数为 $D(9) = \\dfrac{2 \\times 20}{20 + 40} = \\dfrac{40}{60}$。\n\n最后一步是比较这五个值以找到最大值。我们可以为了比较而化简分数并转换为小数形式。\n$D(5) = \\dfrac{80}{92} = \\dfrac{20}{23} \\approx 0.8696$\n$D(6) = \\dfrac{76}{86} = \\dfrac{38}{43} \\approx 0.8837$\n$D(7) = \\dfrac{70}{79} \\approx 0.8861$\n$D(8) = \\dfrac{60}{72} = \\dfrac{5}{6} \\approx 0.8333$\n$D(9) = \\dfrac{40}{60} = \\dfrac{2}{3} \\approx 0.6667$\n\n比较这些值：\n$0.8861 > 0.8837 > 0.8696 > 0.8333 > 0.6667$。\n最大值是 $D(7) = \\dfrac{70}{79}$。\n因此，使 Dice 相似系数最大化的阈值是 $t^{\\ast} = 7$。", "answer": "$$\\boxed{7}$$", "id": "4560855"}, {"introduction": "真实的医学图像总是伴随着噪声，这会干扰阈值和区域生长算法的性能。虽然平滑（一种常见的预处理技术）可以有效抑制噪声，但它也可能模糊病灶与周围组织之间的重要边界。本练习 [@problem_id:4560842] 将您置于一个需要权衡利弊的真实场景中，要求您量化并平衡去噪与边缘保留这对核心矛盾，从而在一个集成了阈值和区域生长的流程中做出满足多重约束的最佳决策。", "problem": "在计算机断层扫描 (CT) 影像组学工作流程中，通过一个处理流程来分割病灶，该流程首先应用强度阈值法生成种子点，然后执行基于梯度的停止准则的区域生长算法。病灶和周围的实质组织可以被建模为由清晰边界分隔开的两个均匀区域。每个区域的强度值都受到每像素方差为 $\\sigma_n^2$ 的加性高斯白噪声的干扰。对于此切片，请考虑以下具有科学依据的建模假设：\n- 背景（实质组织）和病灶的平均亨斯菲尔德单位 (HU) 强度分别为 $\\mu_b = 130$ HU 和 $\\mu_\\ell = 90$ HU，因此边界对比度为 $C = |\\mu_b - \\mu_\\ell| = 40$ HU。\n- 噪声是零均值、空间白色的高斯噪声，每像素方差为 $\\sigma_n^2 = 25$ HU$^2$。\n- 种子点是通过在预处理后的图像上以 $\\tau = 110$ HU 进行全局阈值处理生成的。由单个背景像素形成假种子点（即背景像素值低于 $\\tau$）的可接受概率必须满足 $p_{\\text{seed}} \\leq p_{\\text{seed}}^{\\max} = 10^{-6}$。\n- 区域生长在同一预处理图像上进行，当垂直于边界的图像梯度幅值超过 $\\gamma_{\\min} = 12$ HU/pixel 时停止；这是为了防止算法泄漏越过病灶边界。\n- 边界在局部可以很好地近似为幅度为 $C$ 的一维阶跃边缘。\n- 预处理是各向同性的、单位归一化的二维高斯平滑，标准差为 $\\sigma$（单位为像素）。考虑四个候选选项：$\\sigma \\in \\{0, 0.5, 1.0, 2.0\\}$，其中 $\\sigma = 0$ 表示不进行平滑处理。\n\n在这些假设和要求下，哪种预处理选择能够最佳地平衡噪声抑制和边缘保留，即在同时满足假种子点约束和区域生长边界停止约束的条件下，最大化噪声抑制效果？\n\nA. 应用标准差为 $\\sigma = 2.0$ 的高斯平滑，然后以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。\n\nB. 应用标准差为 $\\sigma = 1.0$ 的高斯平滑，然后以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。\n\nC. 不进行平滑处理（$\\sigma = 0$）；以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。\n\nD. 应用标准差为 $\\sigma = 0.5$ 的高斯平滑，然后以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。", "solution": "用户提供了一个需要遵循一系列严格指令来解决的问题。第一步是验证问题陈述。\n\n**问题验证**\n\n**第1步：提取已知条件**\n-   **工作流程**：使用强度阈值法生成种子点，然后进行区域生长。\n-   **图像模型**：两个均匀区域（病灶、实质组织），边界清晰。\n-   **平均强度**：实质组织 $\\mu_b = 130$ HU，病灶 $\\mu_\\ell = 90$ HU。\n-   **边界对比度**：$C = |\\mu_b - \\mu_\\ell| = 40$ HU。\n-   **噪声模型**：加性、零均值、空间白色的高斯噪声，每像素方差为 $\\sigma_n^2 = 25$ HU$^2$。\n-   **种子点生成**：在 $\\tau = 110$ HU 处进行全局阈值处理。\n-   **约束1（假种子点）**：单个背景像素被误分类为种子点的概率 $p_{\\text{seed}}$ 必须满足 $p_{\\text{seed}} \\leq p_{\\text{seed}}^{\\max} = 10^{-6}$。\n-   **约束2（区域生长停止）**：当垂直于边界的梯度幅值超过 $\\gamma_{\\min} = 12$ HU/pixel 时，算法停止。这被解释为平滑后边界处的峰值梯度必须至少为 $\\gamma_{\\min}$，以确保边界被检测到并停止生长。\n-   **边界模型**：局部为幅度为 $C$ 的一维阶跃边缘。\n-   **预处理**：各向同性的、单位归一化的二维高斯平滑，标准差为 $\\sigma$。\n-   **候选预处理选项**：$\\sigma \\in \\{0, 0.5, 1.0, 2.0\\}$，其中 $\\sigma = 0$ 对应于不进行平滑处理。\n-   **目标**：找到能够最大化噪声抑制同时满足两个约束条件的 $\\sigma$ 选项。\n\n**第2步：使用提取的已知条件进行验证**\n-   **具有科学依据**：该问题很好地基于医学图像处理和信号分析的原理。一个由高斯噪声干扰的不同区域组成的图像模型、使用高斯平滑降低噪声以及阈值法和区域生长等分割技术都是标准且科学上有效的概念。物理单位 (HU) 及其数值对于 CT 成像是现实的。\n-   **良构性**：该问题是良构的。它指定了一个明确的目标（从一个离散集合中找到最大的 $\\sigma$），并受两个可数学形式化的约束。这种结构保证在给定选项中存在唯一解，或者如果所有选项都无效，则不存在解。\n-   **客观性**：问题以精确、客观和定量的语言陈述。所有参数都已定义，成功标准清晰。\n\n**第3步：结论和行动**\n问题陈述具有科学性、良构性和客观性。它不包含任何使其无效的缺陷。因此，该问题是**有效的**，我将继续推导解决方案。\n\n**解决方案推导**\n\n目标是从集合 $\\{0, 0.5, 1.0, 2.0\\}$ 中找到满足两个约束条件的最大 $\\sigma$ 值：一个关于假种子点生成概率，另一个关于病灶边界的梯度。最大化噪声抑制等同于最大化平滑参数 $\\sigma$，因为更强的平滑能更有效地降低噪声方差。\n\n**约束1：假种子点概率**\n\n如果一个背景像素的强度在平滑后低于阈值 $\\tau = 110$ HU，就会生成一个假种子点。原始背景像素的平均强度为 $\\mu_b = 130$ HU，并受到方差为 $\\sigma_n^2 = 25$ HU$^2$ 的噪声干扰。\n\n预处理步骤包括将图像与标准差为 $\\sigma$ 的二维高斯核进行卷积。对于位于均匀背景区域（远离边界）的像素，平均强度保持不变，为 $\\mu_b = 130$ HU。然而，噪声的方差会减小。对于方差为 $\\sigma_n^2$ 的输入白噪声，经过连续高斯滤波后，噪声的方差由下式给出：\n$$ \\sigma_s^2(\\sigma) = \\sigma_n^2 \\iint_{-\\infty}^{\\infty} \\left[ G(x,y;\\sigma) \\right]^2 dx dy $$\n对于单位归一化的二维高斯核 $G(x,y;\\sigma) = \\frac{1}{2\\pi\\sigma^2} e^{-(x^2+y^2)/(2\\sigma^2)}$，其计算结果为：\n$$ \\sigma_s^2(\\sigma) = \\frac{\\sigma_n^2}{4\\pi\\sigma^2} \\quad \\text{for } \\sigma > 0 $$\n对于不进行平滑处理的情况（$\\sigma = 0$），方差保持不变：$\\sigma_s^2(0) = \\sigma_n^2 = 25$ HU$^2$。\n\n平滑后背景像素的强度 $I_s$ 服从正态分布 $I_s \\sim \\mathcal{N}(\\mu_b, \\sigma_s^2(\\sigma))$。假种子点的概率为：\n$$ p_{\\text{seed}} = P(I_s  \\tau) = P\\left( \\frac{I_s - \\mu_b}{\\sigma_s(\\sigma)}  \\frac{\\tau - \\mu_b}{\\sigma_s(\\sigma)} \\right) $$\n令 $Z$ 为标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。\n$$ p_{\\text{seed}} = P\\left( Z  \\frac{110 - 130}{\\sigma_s(\\sigma)} \\right) = \\Phi\\left( -\\frac{20}{\\sigma_s(\\sigma)} \\right) $$\n其中 $\\Phi$ 是标准正态分布的累积分布函数 (CDF)。约束条件是 $p_{\\text{seed}} \\leq 10^{-6}$。\n$$ \\Phi\\left( -\\frac{20}{\\sigma_s(\\sigma)} \\right) \\leq 10^{-6} $$\n从统计表或逆 CDF 计算器可知，对应于累积概率 $10^{-6}$ 的 z-分数约为 $z_{\\text{crit}} \\approx -4.753$。因此，我们必须有：\n$$ -\\frac{20}{\\sigma_s(\\sigma)} \\leq -4.753 $$\n$$ \\frac{20}{\\sigma_s(\\sigma)} \\geq 4.753 \\implies \\sigma_s(\\sigma) \\leq \\frac{20}{4.753} \\approx 4.208 \\text{ HU} $$\n这意味着平滑后像素的方差必须满足：\n$$ \\sigma_s^2(\\sigma) \\leq (4.208)^2 \\approx 17.71 \\text{ HU}^2 $$\n我们使用 $\\sigma_n^2 = 25$ HU$^2$ 来测试每个候选 $\\sigma$：\n-   **对于 $\\sigma = 0$**：$\\sigma_s^2(0) = 25$ HU$^2$。这不满足 $25 \\leq 17.71$。因此，$\\sigma=0$ 无效。\n-   **对于 $\\sigma = 0.5$**：$\\sigma_s^2(0.5) = \\frac{25}{4\\pi(0.5)^2} = \\frac{25}{\\pi} \\approx 7.96$ HU$^2$。这满足 $7.96 \\leq 17.71$。因此，$\\sigma=0.5$ 是一个候选选项。\n-   **对于 $\\sigma = 1.0$**：$\\sigma_s^2(1.0) = \\frac{25}{4\\pi(1.0)^2} = \\frac{25}{4\\pi} \\approx 1.99$ HU$^2$。这满足 $1.99 \\leq 17.71$。因此，$\\sigma=1.0$ 是一个候选选项。\n-   **对于 $\\sigma = 2.0$**：$\\sigma_s^2(2.0) = \\frac{25}{4\\pi(2.0)^2} = \\frac{25}{16\\pi} \\approx 0.497$ HU$^2$。这满足 $0.497 \\leq 17.71$。因此，$\\sigma=2.0$ 是一个候选选项。\n\n**约束2：区域生长边界停止**\n\n为防止区域生长算法“泄漏”越过病灶边界，边界处的梯度必须足够强才能被检测到。当梯度幅值超过 $\\gamma_{\\min} = 12$ HU/pixel 时，停止准则被触发。这意味着平滑后边界处的峰值梯度 $g_{\\max}(\\sigma)$ 必须至少为 $\\gamma_{\\min}$。\n边界被建模为幅度为 $C = 40$ HU 的一维阶跃边缘。用标准差为 $\\sigma$ 的一维高斯函数平滑该边缘，得到的平滑轮廓的最大梯度（在边缘中心）为：\n$$ g_{\\max}(\\sigma) = \\frac{C}{\\sqrt{2\\pi}\\sigma} \\quad \\text{for } \\sigma  0 $$\n约束条件是 $g_{\\max}(\\sigma) \\geq \\gamma_{\\min}$。\n$$ \\frac{40}{\\sqrt{2\\pi}\\sigma} \\geq 12 $$\n解出 $\\sigma$：\n$$ \\sigma \\leq \\frac{40}{12\\sqrt{2\\pi}} = \\frac{10}{3\\sqrt{2\\pi}} \\approx \\frac{10}{3 \\times 2.5066} \\approx 1.33 \\text{ pixels} $$\n对于 $\\sigma = 0$ 的情况（不进行平滑），理想梯度是一个狄拉克δ函数。在离散图像中，跨越单个像素阶跃的梯度就是强度差，即 $C = 40$ HU/pixel。\n我们测试每个候选 $\\sigma$：\n-   **对于 $\\sigma = 0$**：梯度为 $40$ HU/pixel。这满足 $40 \\geq 12$。\n-   **对于 $\\sigma = 0.5$**：这满足 $0.5 \\leq 1.33$。\n-   **对于 $\\sigma = 1.0$**：这满足 $1.0 \\leq 1.33$。\n-   **对于 $\\sigma = 2.0$**：这不满足 $2.0 \\leq 1.33$。因此，$\\sigma=2.0$ 无效。\n\n**综合结果**\n\n我们寻找集合 $\\sigma \\in \\{0, 0.5, 1.0, 2.0\\}$ 中同时满足两个约束的最大值。\n-   $\\sigma = 0$：不满足约束1。\n-   $\\sigma = 0.5$：满足约束1和约束2。有效。\n-   $\\sigma = 1.0$：满足约束1和约束2。有效。\n-   $\\sigma = 2.0$：不满足约束2。\n\n有效平滑参数的集合是 $\\{0.5, 1.0\\}$。问题要求选择能最大化噪声抑制的选项，这对应于最大的有效 $\\sigma$。有效集合中的最大值是 $\\sigma = 1.0$。\n\n**逐项分析**\n\nA. 应用标准差为 $\\sigma = 2.0$ 的高斯平滑，然后以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。\n选择 $\\sigma = 2.0$ 提供了强大的噪声抑制，满足了假种子点约束。然而，它过度模糊了病灶边界。边界处的最大梯度变为 $g_{\\max}(2.0) = \\frac{40}{\\sqrt{2\\pi}(2.0)} \\approx 7.98$ HU/pixel，低于所需的停止准则 $\\gamma_{\\min} = 12$ HU/pixel。区域生长算法很可能无法在边界处停止。\n结论：**错误**。\n\nB. 应用标准差为 $\\sigma = 1.0$ 的高斯平滑，然后以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。\n选择 $\\sigma = 1.0$ 满足假种子点约束（$\\sigma_s^2(1.0) \\approx 1.99 \\text{ HU}^2 \\leq 17.71 \\text{ HU}^2$）。它也满足边界停止约束（$\\sigma = 1.0 \\leq 1.33$）。由于 $\\sigma = 2.0$ 无效，这是具有最大 $\\sigma$ 的有效选项，因此在有效选项中提供了最大的噪声抑制。\n结论：**正确**。\n\nC. 不进行平滑处理（$\\sigma = 0$）；以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。\n选择 $\\sigma = 0$ 保留了边缘梯度（$g_{\\max}(0) = 40 \\text{ HU/pixel} \\geq 12 \\text{ HU/pixel}$）。然而，不进行平滑时，噪声方差为 $\\sigma_s^2(0) = 25 \\text{ HU}^2$，超过了为满足假种子点概率约束所允许的最大方差 $17.71 \\text{ HU}^2$。这将导致不可接受的大量假种子点。\n结论：**错误**。\n\nD. 应用标准差为 $\\sigma = 0.5$ 的高斯平滑，然后以 $\\tau$ 进行阈值处理，并使用梯度停止准则 $\\gamma_{\\min}$ 进行区域生长。\n选择 $\\sigma = 0.5$ 同时满足假种子点约束（$\\sigma_s^2(0.5) \\approx 7.96 \\text{ HU}^2 \\leq 17.71 \\text{ HU}^2$）和边界停止约束（$\\sigma = 0.5 \\leq 1.33$）。这是一个有效的处理选项。然而，问题要求选择通过最大化噪声抑制来*最佳*平衡需求的选项。由于 $\\sigma = 1.0$ 也是一个有效选项，并且提供了更强的噪声抑制（因为 $\\sigma_{s}^2(1.0)  \\sigma_{s}^2(0.5)$），所以 $\\sigma = 0.5$ 不是最佳选择。\n结论：**错误**。", "answer": "$$\\boxed{B}$$", "id": "4560842"}]}