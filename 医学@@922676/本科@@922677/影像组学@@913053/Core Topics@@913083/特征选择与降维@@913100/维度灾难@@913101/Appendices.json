{"hands_on_practices": [{"introduction": "我们经常使用网格或直方图来理解数据分布。本练习旨在揭示当维度增加时，网格单元数量的指数级增长。通过一个简单的计算[@problem_id:2439690]，您将具体地感受到高维空间如何迅速变得“空旷”和数据稀疏，这是“维度灾难”的核心概念之一。", "problem": "在计算金融背景下，假设您正在构建一个用于$d=10$个风险因子状态向量的非参数直方图联合密度估计器，以研究投资组合风险价值（VaR）的动态。您将每个维度离散化为$b=3$个等宽区间，从而在联合状态空间上创建一个规则网格。如果要求数据集中平均每个网格单元恰好有$1$个观测值，那么需要多少个观测值？请以精确整数形式给出答案，不要四舍五入。", "solution": "首先对问题陈述进行验证。\n\n逐字提取已知条件如下：\n1.  领域：计算金融。\n2.  主题背景：状态向量的非参数直方图联合密度估计器。\n3.  维度数量（风险因子）：$d=10$。\n4.  每个维度的区间数：$b=3$。\n5.  网格结构：联合状态空间上的规则网格。\n6.  要求的数据密度：平均每个网格单元恰好有$1$个观测值。\n7.  问题：需要多少个观测值？\n8.  答案格式：精确整数，不四舍五入。\n\n根据验证标准对问题进行评估。\n-   **科学依据**：该问题在非参数统计学和计算金融的背景下被正确地构建。离散化多维空间的概念以及由此导致的数据需求指数级增长（维度灾难）是一个标准且基础的课题。该问题的前提在科学上是合理的。\n-   **适定性**：该问题是适定的。它提供了计算唯一解所需的所有参数（$d$、$b$以及目标数据密度）。问题表述明确无歧义。\n-   **客观性**：该问题以客观、正式的语言陈述，不含主观或推测性内容。\n\n该问题被认为是有效的，因为它没有违反任何指定的无效标准。这是一个直接、定义明确的定量问题。我们可以继续进行求解。\n\n设 $d$ 为状态向量的维度数，设 $b$ 为每个维度离散化成的区间数。根据问题陈述，我们有 $d=10$ 和 $b=3$。\n\n基于直方图的密度估计器是在一个$d$维空间中的规则网格上构建的。该网格中的单元（或超立方体）总数（我们记为$N_{cells}$）是$d$个维度上每个维度的区间数的乘积。由于每个维度被划分为$b$个区间，因此单元总数由下式给出：\n$$\nN_{cells} = \\underbrace{b \\times b \\times \\cdots \\times b}_{d \\text{ times}} = b^d\n$$\n问题规定数据集中平均每个网格单元必须恰好包含$1$个观测值。设$N_{obs}$为所需的观测值总数。每个单元的平均观测值数是观测值总数与单元总数的比率：\n$$\n\\text{Average observations per cell} = \\frac{N_{obs}}{N_{cells}}\n$$\n根据问题的要求，这个平均值必须等于$1$：\n$$\n\\frac{N_{obs}}{N_{cells}} = 1\n$$\n这意味着所需的观测值数量必须等于网格中的单元总数：\n$$\nN_{obs} = N_{cells}\n$$\n代入$N_{cells}$的表达式，我们得到所需观测值数量作为$d$和$b$的函数：\n$$\nN_{obs} = b^d\n$$\n现在，我们将给定的数值$d=10$和$b=3$代入此方程，以求出所需的具体观测值数量。\n$$\nN_{obs} = 3^{10}\n$$\n我们计算这个表达式的精确整数值：\n$$\n3^{10} = (3^2)^5 = 9^5 = 9 \\times 9 \\times 9 \\times 9 \\times 9 = 81 \\times 81 \\times 9 = 6561 \\times 9\n$$\n进行最后的乘法计算：\n$$\n6561 \\times 9 = 59049\n$$\n因此，总共需要$59049$个观测值。这个结果鲜明地展示了维度灾难：即使每个维度只使用$3$个区间的粗略离散化，覆盖一个$10$维空间所需的数据量也变得相当庞大。", "answer": "$$\n\\boxed{59049}\n$$", "id": "2439690"}, {"introduction": "我们在二维和三维空间中形成的几何直觉，在高维世界里往往会失效。本练习将引导您探索一个令人惊讶的几何现象：高维球体与其外接超立方体之间的体积关系。通过分析这个体积比率随维度增长的极限[@problem_id:2439712]，您将揭示高维空间的一个关键几何特性，并理解其为何对拒绝采样等计算方法的效率产生根本性影响。", "problem": "一位计量经济学家在一个高维结构模型的蒙特卡洛（MC）估计器中实现了一个拒绝抽样步骤。在每次抽样中，从超立方体 $\\left[-r, r\\right]^{d}$ 中均匀抽取一个点，当且仅当其欧几里得范数小于或等于 $r$ 时，该点被接受。接受概率等于半径为 $r$ 的 $d$ 维超球体的体积与边长为 $2 r$ 的 $d$ 维超立方体体积之比。对于固定的半径 $r>0$，确定当维度 $d \\to \\infty$ 时接受概率的极限。请以单一数字形式提供最终答案。无需四舍五入。", "solution": "第一步是验证问题陈述。该问题要求解一个高维空间中拒绝抽样方案的极限接受概率。\n\n给定条件如下：\n1.  从超立方体 $[-r, r]^d$ 中均匀抽取一个点。\n2.  如果该点的欧几里得范数小于或等于 $r$，则该点被接受。\n3.  接受概率 $P_d$ 是半径为 $r$ 的 $d$ 维超球体体积与边长为 $2r$ 的 $d$ 维超立方体体积之比。\n4.  半径 $r > 0$ 是一个固定的正常数。\n5.  目标是确定当维度 $d \\to \\infty$ 时 $P_d$ 的极限。\n\n该问题具有科学依据，因为它涉及概率论、高维几何和计算统计（蒙特卡洛方法）中的标准概念。其描述的现象是“维度灾难”的一个著名例子。该问题是适定的，提供了推导唯一解所需的所有必要信息。语言客观而精确。因此，该问题是有效的，我们可以继续进行求解。\n\n令 $V_{sphere}(d, r)$ 表示半径为 $r$ 的 $d$ 维超球体的体积。令 $V_{cube}(d, r)$ 表示顶点位于 $(\\pm r, \\pm r, \\dots, \\pm r)$ 的 $d$ 维超立方体的体积。\n\n超立方体 $[-r, r]^d$ 的边长为 $r - (-r) = 2r$。该超立方体的体积是其各边长度的乘积：\n$$ V_{cube}(d, r) = (2r)^d = 2^d r^d $$\n\n半径为 $r$ 的 $d$ 维超球体（或 $d$-球）的体积由以下公式给出：\n$$ V_{sphere}(d, r) = \\frac{\\pi^{d/2}}{\\Gamma\\left(\\frac{d}{2} + 1\\right)} r^d $$\n其中 $\\Gamma(z)$ 是伽马函数，阶乘函数的推广。\n\n接受概率 $P_d$ 是这两个体积之比：\n$$ P_d = \\frac{V_{sphere}(d, r)}{V_{cube}(d, r)} = \\frac{\\frac{\\pi^{d/2}}{\\Gamma\\left(\\frac{d}{2} + 1\\right)} r^d}{2^d r^d} $$\n$r^d$ 项被消去，这是预料之中的，因为在同一维度中相似缩放对象的体积之比与缩放因子 $r$ 无关。\n$$ P_d = \\frac{\\pi^{d/2}}{2^d \\Gamma\\left(\\frac{d}{2} + 1\\right)} $$\n为了分析当 $d \\to \\infty$ 时的极限，我们可以将表达式重写为：\n$$ P_d = \\frac{(\\sqrt{\\pi})^d}{2^d \\Gamma\\left(\\frac{d}{2} + 1\\right)} = \\frac{\\left(\\frac{\\sqrt{\\pi}}{2}\\right)^d}{\\Gamma\\left(\\frac{d}{2} + 1\\right)} $$\n我们现在必须评估当 $d \\to \\infty$ 时此表达式的极限。让我们分别考察分子和分母。\n\n对于分子，我们有 $\\left(\\frac{\\sqrt{\\pi}}{2}\\right)^d$ 项。由于 $\\pi$ 的值约为 $3.14159$，$\\sqrt{\\pi}$ 约为 $1.77245$。指数的底为 $\\frac{\\sqrt{\\pi}}{2} \\approx 0.88622$。由于这个底是一个严格小于 $1$ 的正常数，当指数趋于无穷大时，其极限为 $0$：\n$$ \\lim_{d \\to \\infty} \\left(\\frac{\\sqrt{\\pi}}{2}\\right)^d = 0 $$\n\n对于分母，我们有 $\\Gamma\\left(\\frac{d}{2} + 1\\right)$ 项。当 $d \\to \\infty$ 时，伽马函数的自变量 $\\frac{d}{2} + 1$ 也趋于无穷大。伽马函数 $\\Gamma(z)$ 具有性质 $\\lim_{z \\to \\infty} \\Gamma(z) = \\infty$。因此：\n$$ \\lim_{d \\to \\infty} \\Gamma\\left(\\frac{d}{2} + 1\\right) = \\infty $$\n\n我们现在正在评估一个分数的极限，其中分子趋于 $0$，分母趋于 $\\infty$。这样的极限明确地为 $0$。\n$$ \\lim_{d \\to \\infty} P_d = \\lim_{d \\to \\infty} \\frac{\\left(\\frac{\\sqrt{\\pi}}{2}\\right)^d}{\\Gamma\\left(\\frac{d}{2} + 1\\right)} = 0 $$\n这个结果表明，随着空间维度的增加，该拒绝抽样方案的接受概率收敛到零。这意味着对于高维度，必须从超立方体中抽取指数级数量的样本，才能找到一个位于内切超球体内的样本，这使得该方法在计算上是不可行的。这是维度灾难的一个典型表现。极限接受概率为 $0$。", "answer": "$$\\boxed{0}$$", "id": "2439712"}, {"introduction": "“维度灾难”不仅仅是一个几何上的奇特现象，它对统计模型的实际性能有着深远的影响。这个编程练习要求您实现一个核密度估计器（KDE），并凭经验测量其在不同维度下的收敛速度。通过编写代码和分析结果[@problem_id:2439662]，您将直接观察并量化非参数估计的准确性如何随着维度的增加而下降，从而将抽象的理论与计算统计的实践联系起来。", "problem": "本题要求您量化多元核密度估计 (KDE) 的收敛速度如何随着维度的增加而减慢，以说明计算经济学和金融学中的维度灾难。考虑从 $d$ 维标准正态分布中抽取的独立同分布样本 $X_1,\\dots,X_n \\in \\mathbb{R}^d$，其密度为\n$$\nf_d(x) = (2\\pi)^{-d/2}\\exp\\!\\left(-\\tfrac{1}{2}\\lVert x\\rVert_2^2\\right),\n$$\n其中 $\\lVert \\cdot \\rVert_2$ 表示欧几里得范数。定义高斯乘积核\n$$\nK_d(u) = (2\\pi)^{-d/2}\\exp\\!\\left(-\\tfrac{1}{2}\\lVert u\\rVert_2^2\\right),\n$$\n以及带宽为 $h>0$ 的核密度估计 (KDE)\n$$\n\\widehat{f}_{n,d,h}(x) = \\frac{1}{n h^d}\\sum_{i=1}^n K_d\\!\\left(\\frac{x - X_i}{h}\\right).\n$$\n对于样本大小 $n$ 和维度 $d$ 的每种组合，将带宽设置为\n$$\nh(n,d) = n^{-1/(d+4)}.\n$$\n定义关于真实分布（即在 $X\\sim f_d$ 下的均方误差）的平均积分平方误差的蒙特卡洛代理为\n$$\n\\operatorname{MSE}_{\\text{MC}}(n,d) = \\frac{1}{Q}\\sum_{j=1}^{Q}\\left(\\widehat{f}_{n,d,h(n,d)}(Z_j) - f_d(Z_j)\\right)^2,\n$$\n其中 $Z_1,\\dots,Z_Q$ 是从 $d$ 维标准正态分布中抽取的独立样本。\n\n请实现一个完整、可运行的程序，针对以下测试套件，计算 $\\operatorname{MSE}_{\\text{MC}}(n,d)$ 和对数-对数尺度下的经验收敛斜率：\n\n- 测试套件参数：\n  - 维度 $d \\in \\{\\,1,\\,3,\\,6\\,\\}$。\n  - 样本大小 $n \\in \\{\\,200,\\,800,\\,3200\\,\\}$。\n  - 蒙特卡洛评估点数量 $Q = 1024$。\n- 随机性与可复现性：\n  - 对于给定 $(n,d)$ 情况下的样本 $X_1,\\dots,X_n$，使用以整数\n    $$\n    s_{\\text{data}}(n,d) = 10^6 + 10^4 d + n.\n    $$\n    为种子的伪随机数生成器。\n  - 对于给定 $d$ 情况下的评估点 $Z_1,\\dots,Z_Q$，使用以整数\n    $$\n    s_{\\text{eval}}(d) = 2\\cdot 10^6 + 10^4 d.\n    $$\n    为种子的伪随机数生成器。\n  - 所有正态随机变量必须是每个坐标上均值为 $0$、方差为 $1$ 的标准正态随机变量，且相互独立。\n- 对于每个固定的 $d$，计算 $\\log \\operatorname{MSE}_{\\text{MC}}(n,d)$ 对 $\\log n$ 在测试套件中的三个 $n$ 值上进行回归的最小二乘斜率 $b_d$。也就是说，对于 $n\\in\\{200,800,3200\\}$，在普通最小二乘意义上拟合\n  $$\n  \\log \\operatorname{MSE}_{\\text{MC}}(n,d) \\approx a_d + b_d \\log n\n  $$\n  并返回估计的斜率 $b_d$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按此顺序包含：\n- 9 个 $\\operatorname{MSE}_{\\text{MC}}(n,d)$ 值，其中 $d=1,3,6$（升序），在每个 $d$ 内，$n=200,800,3200$（升序）。\n- 接着是 3 个斜率 $b_d$，其中 $d=1,3,6$（升序）。\n\n因此，输出必须总共包含十二个浮点数，顺序如下\n$$\n\\bigl[\\operatorname{MSE}_{\\text{MC}}(200,1),\\,\\operatorname{MSE}_{\\text{MC}}(800,1),\\,\\operatorname{MSE}_{\\text{MC}}(3200,1),\\,\\operatorname{MSE}_{\\text{MC}}(200,3),\\,\\operatorname{MSE}_{\\text{MC}}(800,3),\\,\\operatorname{MSE}_{\\text{MC}}(3200,3),\\,\\operatorname{MSE}_{\\text{MC}}(200,6),\\,\\operatorname{MSE}_{\\text{MC}}(800,6),\\,\\operatorname{MSE}_{\\text{MC}}(3200,6),\\,b_1,\\,b_3,\\,b_6\\bigr].\n$$\n不应打印任何其他文本。不涉及角度和物理单位；所有输出都必须是实数。", "solution": "问题陈述经过验证。\n\n**步骤1：提取已知条件**\n- **真实分布：** $d$ 维标准正态分布，$f_d(x) = (2\\pi)^{-d/2}\\exp(-\\frac{1}{2}\\lVert x\\rVert_2^2)$。\n- **数据样本：** $X_1,\\dots,X_n \\in \\mathbb{R}^d$ 是从 $f_d$ 中抽取的独立同分布样本。\n- **核函数：** 高斯乘积核，$K_d(u) = (2\\pi)^{-d/2}\\exp(-\\frac{1}{2}\\lVert u\\rVert_2^2)$。\n- **核密度估计 (KDE)：** $\\widehat{f}_{n,d,h}(x) = \\frac{1}{n h^d}\\sum_{i=1}^n K_d(\\frac{x - X_i}{h})$。\n- **带宽规则：** $h(n,d) = n^{-1/(d+4)}$。\n- **误差度量：** 蒙特卡洛均方误差，$\\operatorname{MSE}_{\\text{MC}}(n,d) = \\frac{1}{Q}\\sum_{j=1}^{Q}(\\widehat{f}_{n,d,h(n,d)}(Z_j) - f_d(Z_j))^2$。\n- **评估样本：** $Z_1,\\dots,Z_Q$ 是从 $f_d$ 中抽取的独立同分布样本。\n- **参数：**\n    - 维度：$d \\in \\{1, 3, 6\\}$。\n    - 样本大小：$n \\in \\{200, 800, 3200\\}$。\n    - 评估集大小：$Q = 1024$。\n- **随机种子：**\n    - 数据生成种子：$s_{\\text{data}}(n,d) = 10^6 + 10^4 d + n$。\n    - 评估数据种子：$s_{\\text{eval}}(d) = 2 \\cdot 10^6 + 10^4 d$。\n- **分析任务：** 对每个 $d$，计算 $\\log \\operatorname{MSE}_{\\text{MC}}(n,d)$ 对 $\\log n$ 进行普通最小二乘回归的斜率 $b_d$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据既定标准对问题进行评估。\n- **科学性：** 该问题是非参数统计中的一个标准练习，具体涉及核密度估计的收敛性质。“维度灾难”概念及其对收敛速度的影响是高维统计理论的基石。所有定义都是标准的，该设置是经典的教科书案例。\n- **良构性：** 所有必要的组成部分都已指定：分布、估计器形式、参数（$n, d, Q$）、确定性的带宽选择规则、精确的误差度量以及可复现的随机数生成方案。这确保了可以获得唯一的数值解。\n- **客观性：** 问题使用精确、明确的数学语言陈述。\n\n该问题没有指定的缺陷。它并非科学上不合理、不可形式化、不完整、不现实、不适定或不可验证。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将提供一个解决方案。\n\n**方法论**\n\n任务是计算在样本大小 $n$ 和维度 $d$ 的几种组合下的蒙特卡洛均方误差 $\\operatorname{MSE}_{\\text{MC}}(n,d)$，然后确定经验收敛率。程序如下。\n\n对于每个维度 $d \\in \\{1, 3, 6\\}$：\n1.  **生成评估点：** 我们首先从 $d$ 维标准正态分布 $f_d$ 中生成 $Q=1024$ 个评估点 $Z_1, \\dots, Z_Q$。伪随机数生成器使用种子 $s_{\\text{eval}}(d) = 2 \\cdot 10^6 + 10^4 d$ 以确保可复现性。这些点存储在一个 $Q \\times d$ 的矩阵 $Z$ 中。\n\n2.  **计算真实密度：** 使用公式 $f_d(x) = (2\\pi)^{-d/2}\\exp(-\\frac{1}{2}\\lVert x\\rVert_2^2)$ 计算 $j=1, \\dots, Q$ 的真实密度值 $f_d(Z_j)$。这涉及计算每个点的欧几里得范数平方 $\\lVert Z_j\\rVert_2^2$。\n\n3.  **遍历样本大小：** 对于每个样本大小 $n \\in \\{200, 800, 3200\\}$：\n    a.  **生成数据样本：** 从 $f_d$ 中抽取 $n$ 个数据点 $X_1, \\dots, X_n$。生成器使用种子 $s_{\\text{data}}(n,d) = 10^6 + 10^4 d + n$。这些点构成一个 $n \\times d$ 的矩阵 $X$。\n    b.  **确定带宽：** 根据规则 $h(n,d) = n^{-1/(d+4)}$ 计算带宽 $h$。\n    c.  **计算KDE：** 必须在每个点 $Z_j$ 处评估 KDE $\\widehat{f}_{n,d,h}(x)$。其定义为：\n    $$\n    \\widehat{f}_{n,d,h}(Z_j) = \\frac{1}{n h^d}\\sum_{i=1}^n K_d\\left(\\frac{Z_j - X_i}{h}\\right)\n    $$\n    代入高斯核 $K_d(u) = (2\\pi)^{-d/2}\\exp(-\\frac{1}{2}\\lVert u\\rVert_2^2)$ 可得：\n    $$\n    \\widehat{f}_{n,d,h}(Z_j) = \\frac{(2\\pi)^{-d/2}}{n h^d}\\sum_{i=1}^n \\exp\\left(-\\frac{1}{2h^2}\\lVert Z_j - X_i\\rVert_2^2\\right)\n    $$\n    为高效计算，我们首先构建一个 $Q \\times n$ 的欧几里得距离平方矩阵，其中条目 $(j,i)$ 是 $\\lVert Z_j - X_i\\rVert_2^2$。这可以通过使用 `scipy.spatial.distance.cdist` 函数完成。然后逐元素应用指数项，对每个 $j$ 将结果按索引 $i$ 求和，最后乘以常数前置因子 $\\frac{(2\\pi)^{-d/2}}{n h^d}$。\n    d.  **计算MSE：** $\\operatorname{MSE}_{\\text{MC}}(n,d)$ 是通过取评估点处估计密度与真实密度之间差的平方的均值来计算的：\n    $$\n    \\operatorname{MSE}_{\\text{MC}}(n,d) = \\frac{1}{Q}\\sum_{j=1}^{Q}\\left(\\widehat{f}_{n,d,h}(Z_j) - f_d(Z_j)\\right)^2\n    $$\n4.  **估计收敛斜率：** 在计算完固定 $d$ 的三个 $\\operatorname{MSE}_{\\text{MC}}$ 值之后，我们估计关系式 $\\log \\operatorname{MSE}_{\\text{MC}}(n,d) \\approx a_d + b_d \\log n$ 的斜率 $b_d$。这是一个标准的简单线性回归问题。我们定义因变量为 $y_k = \\log \\operatorname{MSE}_{\\text{MC}}(n_k, d)$，自变量为 $x_k = \\log n_k$，其中 $n_k \\in \\{200, 800, 3200\\}$。斜率 $b_d$ 是通过求解最小二乘问题得到的，为此我们使用 `numpy.linalg.lstsq` 函数。\n\n此设置下的理论渐近平均积分平方误差 (MISE) 以 $\\mathcal{O}(n^{-4/(d+4)})$ 的速率收敛。因此，MISE 的对数是 $\\log n$ 的线性函数，斜率为 $-\\frac{4}{d+4}$。计算出的经验斜率 $b_d$ 预期会逼近这个理论值。对于 $d=1, 3, 6$，理论斜率分别为 $-0.8$、$-4/7 \\approx -0.571$ 和 $-0.4$。随着 $d$ 的增加，斜率的绝对值减小，这是维度灾难的一种量化表现：估计器的收敛速度在更高维度下减慢。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.spatial.distance import cdist\n\ndef solve():\n    \"\"\"\n    Computes the Mean Squared Error of a Kernel Density Estimator for various\n    dimensions and sample sizes, and estimates the convergence slope to illustrate\n    the curse of dimensionality.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    dimensions = [1, 3, 6]\n    sample_sizes = [200, 800, 3200]\n    Q = 1024\n\n    all_mse_values = []\n    all_slopes = []\n\n    # Helper function for multivariate normal PDF\n    def true_density_f_d(x, d):\n        if x.ndim == 1:\n            x = x.reshape(1, -1)\n        norm_sq = np.sum(x**2, axis=1)\n        return (2 * np.pi)**(-d / 2) * np.exp(-0.5 * norm_sq)\n\n    for d in dimensions:\n        # Generate evaluation points Z for the current dimension d.\n        # This is done once per dimension.\n        s_eval = 2 * 10**6 + 10**4 * d\n        rng_eval = np.random.default_rng(s_eval)\n        Z = rng_eval.normal(loc=0, scale=1, size=(Q, d))\n\n        # Compute the true density values f_d(Z_j) at the evaluation points.\n        f_true_vals = true_density_f_d(Z, d)\n\n        mse_for_current_d = []\n        log_n_values = np.log(sample_sizes)\n\n        for n in sample_sizes:\n            # Main logic to calculate the result for one case (n, d)\n            \n            # 1. Generate data samples X\n            s_data = 10**6 + 10**4 * d + n\n            rng_data = np.random.default_rng(s_data)\n            X = rng_data.normal(loc=0, scale=1, size=(n, d))\n            \n            # 2. Calculate bandwidth h\n            h = n**(-1 / (d + 4))\n\n            # 3. Calculate KDE estimates f_hat(Z_j)\n            # Use scipy.spatial.distance.cdist for efficient computation of squared\n            # Euclidean distances between each Z_j and X_i.\n            sq_dists = cdist(Z, X, 'sqeuclidean')  # Shape (Q, n)\n            \n            # The argument to the exponential function in the kernel sum\n            kernel_exp_arg = -0.5 / (h**2) * sq_dists\n            \n            # Sum of kernel values over index i\n            sum_of_exponentials = np.sum(np.exp(kernel_exp_arg), axis=1)\n            \n            # Prefactor for the KDE formula\n            prefactor = (2 * np.pi)**(-d / 2) / (n * h**d)\n            \n            # KDE estimates at points Z_j\n            f_hat_vals = prefactor * sum_of_exponentials\n            \n            # 4. Compute the Monte Carlo proxy for MSE\n            mse = np.mean((f_hat_vals - f_true_vals)**2)\n            mse_for_current_d.append(mse)\n\n        # Append the 3 MSE values for the current dimension to the main list\n        all_mse_values.extend(mse_for_current_d)\n        \n        # 5. Compute the least-squares slope for the current dimension d\n        log_mse_values = np.log(mse_for_current_d)\n        \n        # Set up the linear system A*beta = y for regression\n        # y = log_mse_values\n        # beta = [a_d, b_d] (intercept, slope)\n        # A = [[1, log_n_1], [1, log_n_2], [1, log_n_3]]\n        A = np.vstack([np.ones_like(log_n_values), log_n_values]).T\n        \n        # Solve for the coefficients using least squares\n        coeffs = np.linalg.lstsq(A, log_mse_values, rcond=None)[0]\n        slope_b_d = coeffs[1]\n        all_slopes.append(slope_b_d)\n\n    # Combine all results into a single list for printing\n    results = all_mse_values + all_slopes\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2439662"}]}