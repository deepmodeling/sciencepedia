{"hands_on_practices": [{"introduction": "掌握ROC分析的第一步是理解其基本构建模块：真阳性率（TPR）和假阳性率（FPR）。本练习旨在让你通过一个模拟的筛选研究数据，为一个特定的决策阈值计算这些比率。更进一步，本练习将引导你探索这些点估计值的统计不确定性，这是循证医学中的一个核心概念，通过计算尤登指数（Youden Index）的置信区间来体现[@problem_id:4568431]。", "problem": "预防医学中的一项初步筛查研究评估了一种用于早期检测结直肠肿瘤的血液分类器。在固定的决策阈值 $\\tau$下，该分类器被应用于一个便利样本，该样本包含120名经活检确诊患有晚期肿瘤的个体和380名结肠镜检查未发现肿瘤的无症状对照者。在患病组中，84人筛查结果为阳性，36人筛查结果为阴性。在非患病组中，57人筛查结果为阳性，323人筛查结果为阴性。使用核心概率定义，即真阳性率（在真正患病者中检测结果为阳性的概率）和假阳性率（在真正非患病者中检测结果为阳性的概率）是由经验频率估计的条件概率，在阈值 $\\tau$下完成以下任务：\n- 以小数形式计算经验真阳性率和经验假阳性率。\n- 将每组内的测试结果视为独立同分布的伯努利随机变量，并将患病组和非患病组视为独立样本，从比例的二项方差出发，通过用经验率替代未知参数，推导Youden指数 $J = \\mathrm{TPR} - \\mathrm{FPR}$ 的标准误的大样本近似表达式。然后计算95%的Wald半宽 $h = z_{0.975}\\,\\widehat{\\mathrm{SE}}(J)$，其中 $z_{0.975} = 1.96$。\n将您计算出的 $h$ 的最终数值答案四舍五入至四位有效数字。所有比率均以小数表示（而非百分比）。最终答案只提供 $h$ 的值。", "solution": "该问题被评估为有效，因为它在生物统计学原理上具有科学依据，问题提出得当，数据完整且一致，并且陈述客观。\n\n该问题要求计算Youden指数 $J$ 的95% Wald半宽。我们首先根据所提供的数据定义并计算必要的经验量。\n\n患病组中的个体数量为 $N_D = 120$，非患病组中的个体数量为 $N_{ND} = 380$。\n患病组中的阳性筛查数（真阳性）为 $TP = 84$。\n非患病组中的阳性筛查数（假阳性）为 $FP = 57$。\n\n真阳性率（$\\mathrm{TPR}$）是在个体患病条件下检测结果为阳性的条件概率。其经验估计值，记为 $\\widehat{\\mathrm{TPR}}$，计算为筛查结果为阳性的患病个体所占的比例：\n$$\n\\widehat{\\mathrm{TPR}} = \\frac{TP}{N_D} = \\frac{84}{120} = 0.7\n$$\n假阳性率（$\\mathrm{FPR}$）是在个体未患病条件下检测结果为阳性的条件概率。其经验估计值，记为 $\\widehat{\\mathrm{FPR}}$，计算为筛查结果为阳性的非患病个体所占的比例：\n$$\n\\widehat{\\mathrm{FPR}} = \\frac{FP}{N_{ND}} = \\frac{57}{380} = 0.15\n$$\nYouden指数定义为 $J = \\mathrm{TPR} - \\mathrm{FPR}$。其经验估计值为 $\\widehat{J} = \\widehat{\\mathrm{TPR}} - \\widehat{\\mathrm{FPR}}$。\n\n为了求出 $\\widehat{J}$ 的标准误，我们首先推导其方差。问题陈述患病组和非患病组是独立样本。因此，它们各自的经验比例 $\\widehat{\\mathrm{TPR}}$ 和 $\\widehat{\\mathrm{FPR}}$ 是独立的随机变量。两个独立随机变量之差的方差是它们方差的和：\n$$\n\\mathrm{Var}(\\widehat{J}) = \\mathrm{Var}(\\widehat{\\mathrm{TPR}} - \\widehat{\\mathrm{FPR}}) = \\mathrm{Var}(\\widehat{\\mathrm{TPR}}) + \\mathrm{Var}(\\widehat{\\mathrm{FPR}})\n$$\n测试结果被视为独立同分布的伯努利试验。真阳性数 $TP$ 服从二项分布 $\\mathrm{Bin}(N_D, \\mathrm{TPR})$。估计量 $\\widehat{\\mathrm{TPR}} = \\frac{TP}{N_D}$ 是一个样本比例。对于来自 $n$ 次试验、真实概率为 $p$ 的样本比例 $\\hat{p}$，其方差为 $\\mathrm{Var}(\\hat{p}) = \\frac{p(1-p)}{n}$。应用此原理，$\\widehat{\\mathrm{TPR}}$ 和 $\\widehat{\\mathrm{FPR}}$ 的方差为：\n$$\n\\mathrm{Var}(\\widehat{\\mathrm{TPR}}) = \\frac{\\mathrm{TPR}(1 - \\mathrm{TPR})}{N_D}\n$$\n$$\n\\mathrm{Var}(\\widehat{\\mathrm{FPR}}) = \\frac{\\mathrm{FPR}(1 - \\mathrm{FPR})}{N_{ND}}\n$$\n将这些代入 $\\mathrm{Var}(\\widehat{J})$ 的表达式中，得到：\n$$\n\\mathrm{Var}(\\widehat{J}) = \\frac{\\mathrm{TPR}(1 - \\mathrm{TPR})}{N_D} + \\frac{\\mathrm{FPR}(1 - \\mathrm{FPR})}{N_{ND}}\n$$\n$\\widehat{J}$ 的标准误是其方差的平方根，即 $\\mathrm{SE}(\\widehat{J}) = \\sqrt{\\mathrm{Var}(\\widehat{J})}$。\n\n对于大样本近似，我们通过用经验估计值 $\\widehat{\\mathrm{TPR}}$ 和 $\\widehat{\\mathrm{FPR}}$ 替代未知的真实参数 $\\mathrm{TPR}$ 和 $\\mathrm{FPR}$ 来估计标准误。这就得到了估计的标准误 $\\widehat{\\mathrm{SE}}(\\widehat{J})$：\n$$\n\\widehat{\\mathrm{SE}}(\\widehat{J}) = \\sqrt{\\frac{\\widehat{\\mathrm{TPR}}(1 - \\widehat{\\mathrm{TPR}})}{N_D} + \\frac{\\widehat{\\mathrm{FPR}}(1 - \\widehat{\\mathrm{FPR}})}{N_{ND}}}\n$$\n现在，我们代入数值：$\\widehat{\\mathrm{TPR}}=0.7$, $\\widehat{\\mathrm{FPR}}=0.15$, $N_D=120$, and $N_{ND}=380$。\n$$\n\\widehat{\\mathrm{SE}}(\\widehat{J}) = \\sqrt{\\frac{0.7(1 - 0.7)}{120} + \\frac{0.15(1 - 0.15)}{380}}\n$$\n$$\n\\widehat{\\mathrm{SE}}(\\widehat{J}) = \\sqrt{\\frac{0.7(0.3)}{120} + \\frac{0.15(0.85)}{380}}\n$$\n$$\n\\widehat{\\mathrm{SE}}(\\widehat{J}) = \\sqrt{\\frac{0.21}{120} + \\frac{0.1275}{380}}\n$$\n为了保持精度，我们可以将各项表示为分数：\n$$\n\\frac{0.21}{120} = \\frac{21}{12000} = \\frac{7}{4000}\n$$\n$$\n\\frac{0.1275}{380} = \\frac{1275}{3800000} = \\frac{51}{152000}\n$$\n估计的方差是这些分数的和。我们找到一个公分母 $152000$：\n$$\n\\widehat{\\mathrm{Var}}(\\widehat{J}) = \\frac{7 \\times 38}{4000 \\times 38} + \\frac{51}{152000} = \\frac{266}{152000} + \\frac{51}{152000} = \\frac{317}{152000}\n$$\n因此，估计的标准误为：\n$$\n\\widehat{\\mathrm{SE}}(\\widehat{J}) = \\sqrt{\\frac{317}{152000}} \\approx \\sqrt{0.0020855263} \\approx 0.04566756\n$$\n最后一步是使用公式 $h = z_{0.975}\\,\\widehat{\\mathrm{SE}}(\\widehat{J})$ 和 $z_{0.975} = 1.96$ 来计算95%的Wald半宽 $h$。\n$$\nh = 1.96 \\times \\sqrt{\\frac{317}{152000}}\n$$\n$$\nh \\approx 1.96 \\times 0.04566756 \\approx 0.089508424\n$$\n问题要求将最终答案四舍五入到四位有效数字。$0.089508424$ 的前四位有效数字是 $8$, $9$, $5$, 和 $0$。后一位数字是 $8$，它大于或等于 $5$，所以我们将最后一位有效数字向上取整。\n$$\nh \\approx 0.08951\n$$", "answer": "$$\n\\boxed{0.08951}\n$$", "id": "4568431"}, {"introduction": "虽然ROC曲线上的单个点（即特定阈值下的TPR和FPR）提供了有价值的信息，但我们通常需要一个综合性指标来评估和比较不同诊断测试的整体区分能力。曲线下面积（AUC）正是这样一个最常用的概括性指标。本练习将带你超越简单地从软件输出中读取AUC值，而是通过一个小型数据集从头开始计算它，从而加深你对AUC概率意义的理解，即AUC等于从患病组和非患病组中各随机抽取一个个体，前者的测试得分高于后者的概率[@problem_id:4568374]。", "problem": "一个针对慢性病的预防性筛查项目评估由生物标志物检测产生的连续风险评分。对于每个个体，该检测返回一个标量分数 $S$。令 $Y \\in \\{0,1\\}$ 表示疾病状态，其中 $Y=1$ 表示病例（患病者），$Y=0$ 表示对照（非患病者）。受试者工作特征 (ROC) 曲线 (Receiver Operating Characteristic (ROC)) 绘制了当决策阈值在 $S$ 的支撑集上变化时，真阳性率相对于假阳性率的关系图，而 ROC 曲线下面积 (AUC) (Area Under the ROC Curve (AUC)) 则量化了总体的区分能力。\n\n从真阳性率和假阳性率在给定 $Y=1$ 和 $Y=0$ 时 $S$ 的条件分布的核心定义出发，推导 $\\mathrm{AUC}$ 的插件估计量，该估计量使用所有病例-对照评分对，并通过中阶秩次处理相同值（结）。然后，将您推导出的估计量应用于从一项筛查研究中获得的以下小型数据集，其中一些病例和对照的分数存在相同值：\n\n- 病例分数 ($m=4$)：$0.82$, $0.60$, $0.60$, $0.30$。\n- 对照分数 ($n=5$)：$0.75$, $0.60$, $0.40$, $0.30$, $0.10$。\n\n通过将病例和对照之间的相同值在成对比较中贡献 $0.5$ 来精确计算该估计量的值。将您的最终答案表示为精确分数，不进行四舍五入。", "solution": "目标是根据基本原理，使用经验数据来估计 ROC 曲线下面积 (AUC)，并一致地处理相同值。ROC 曲线是通过在水平 $\\tau$ 处对分数 $S$ 进行阈值处理，并绘制随 $\\tau$ 变化的真阳性率与假阳性率的关系图来定义的。\n\n令 $F_{1}$ 表示病例 ($Y=1$) 中分数 $S$ 的累积分布函数，令 $F_{0}$ 表示对照 ($Y=0$) 中分数 $S$ 的累积分布函数。对于一个决策阈值 $\\tau$，真阳性率为\n$$\n\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1) = 1 - F_{1}(\\tau),\n$$\n而假阳性率为\n$$\n\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=0) = 1 - F_{0}(\\tau).\n$$\nROC 曲线是当 $\\tau$ 在 $S$ 的支撑集上变化时，点集 $\\big(\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau)\\big)$。ROC 曲线下面积 (AUC) 是 $\\mathrm{TPR}$ 对 $\\mathrm{FPR}$ 的积分：\n$$\n\\mathrm{AUC} = \\int \\mathrm{TPR}(\\tau) \\, \\mathrm{d}\\mathrm{FPR}(\\tau).\n$$\n使用上述表达式以及 $\\mathrm{d}\\mathrm{FPR}(\\tau) = - \\mathrm{d}F_{0}(\\tau)$ 这一事实，我们得到\n$$\n\\mathrm{AUC} = \\int \\big(1 - F_{1}(\\tau)\\big) \\, \\mathrm{d}\\mathrm{FPR}(\\tau) = \\int \\big(1 - F_{1}(\\tau)\\big) \\, \\big(-\\mathrm{d}F_{0}(\\tau)\\big) = \\int \\big(1 - F_{1}(\\tau)\\big) \\, \\mathrm{d}F_{0}(\\tau).\n$$\n将最后一个积分识别为关于对照分数分布的期望，\n$$\n\\mathrm{AUC} = \\mathbb{E}_{S_{0} \\sim F_{0}}\\big[1 - F_{1}(S_{0})\\big] = \\mathbb{E}\\big[\\mathbb{P}(S_{1} > S_{0} \\mid S_{0})\\big] = \\mathbb{P}(S_{1} > S_{0}),\n$$\n其中 $S_{1} \\sim F_{1}$ 和 $S_{0} \\sim F_{0}$ 是独立的。当分数分布存在导致相同值（结）的原子时，标准的对称化处理得到\n$$\n\\mathrm{AUC} = \\mathbb{P}(S_{1} > S_{0}) + \\frac{1}{2} \\, \\mathbb{P}(S_{1} = S_{0}),\n$$\n这等价于使用中阶秩次处理相同值的 Wilcoxon–Mann–Whitney 优越性概率，并对应于阶梯状经验 ROC 曲线下的面积。\n\n为了推导插件估计量，我们将未知的分布 $F_{1}$ 和 $F_{0}$ 替换为它们的经验对应物。令 $s_{1}, \\dots, s_{m}$ 为病例分数，$t_{1}, \\dots, t_{n}$ 为对照分数，并假设它们在组间是独立的。使用所有病例-对照对并通过中阶秩次处理相同值的经验插件估计量是\n$$\n\\widehat{\\mathrm{AUC}} = \\frac{1}{m n} \\sum_{i=1}^{m} \\sum_{j=1}^{n} \\Big( \\mathbf{1}\\{ s_{i} > t_{j} \\} + \\frac{1}{2} \\, \\mathbf{1}\\{ s_{i} = t_{j} \\} \\Big),\n$$\n如果病例分数超过对照分数，则每对病例-对照对计为 $1$；如果小于，则计为 $0$；如果相等，则计为 $0.5$。\n\n我们现在为给定的数据集计算 $\\widehat{\\mathrm{AUC}}$。病例分数为 $m=4$ 个值，$s_{1}=0.82$, $s_{2}=0.60$, $s_{3}=0.60$, $s_{4}=0.30$。对照分数为 $n=5$ 个值，$t_{1}=0.75$, $t_{2}=0.60$, $t_{3}=0.40$, $t_{4}=0.30$, $t_{5}=0.10$。共有 $m n = 4 \\times 5 = 20$ 对病例-对照对。\n\n计算每个病例分数相对于所有对照分数的贡献：\n\n- 对于 $s_{1} = 0.82$：$0.82 > 0.75$ 贡献 $1$，$0.82 > 0.60$ 贡献 $1$，$0.82 > 0.40$ 贡献 $1$，$0.82 > 0.30$ 贡献 $1$，$0.82 > 0.10$ 贡献 $1$。$s_{1}$ 的总和为 $5$。\n\n- 对于 $s_{2} = 0.60$：$0.60  < 0.75$ 贡献 $0$，$0.60 = 0.60$ 贡献 $\\frac{1}{2}$，$0.60 > 0.40$ 贡献 $1$，$0.60 > 0.30$ 贡献 $1$，$0.60 > 0.10$ 贡献 $1$。$s_{2}$ 的总和为 $0 + \\frac{1}{2} + 1 + 1 + 1 = \\frac{7}{2} = 3.5$。\n\n- 对于 $s_{3} = 0.60$：与 $s_{2}$ 相同，总和为 $\\frac{7}{2} = 3.5$。\n\n- 对于 $s_{4} = 0.30$：$0.30  < 0.75$ 贡献 $0$，$0.30  < 0.60$ 贡献 $0$，$0.30  < 0.40$ 贡献 $0$，$0.30 = 0.30$ 贡献 $\\frac{1}{2}$，$0.30 > 0.10$ 贡献 $1$。$s_{4}$ 的总和为 $\\frac{3}{2} = 1.5$。\n\n对所有病例求和，总数为\n$$\n5 + \\frac{7}{2} + \\frac{7}{2} + \\frac{3}{2} = 5 + 3.5 + 3.5 + 1.5 = 13.5 = \\frac{27}{2}.\n$$\n除以 $m n = 20$ 得到\n$$\n\\widehat{\\mathrm{AUC}} = \\frac{13.5}{20} = \\frac{27}{40}.\n$$\n\n作为使用中阶秩次的交叉检验，合并所有 $m+n=9$ 个分数，并分配秩次，其中相同值获得其平均秩次（中阶秩次）。排序后的值（升序）为 $0.10$ ($Y=0$), $0.30$ ($Y=1$), $0.30$ ($Y=0$), $0.40$ ($Y=0$), $0.60$ ($Y=1$), $0.60$ ($Y=1$), $0.60$ ($Y=0$), $0.75$ ($Y=0$), $0.82$ ($Y=1$)。中阶秩次为：$0.10 \\to 1$，两个 $0.30 \\to 2.5$，$0.40 \\to 4$，三个 $0.60 \\to 6$，$0.75 \\to 8$，$0.82 \\to 9$。病例的秩次和为 $2.5 + 6 + 6 + 9 = 23.5$。病例的 Wilcoxon–Mann–Whitney 统计量为\n$$\nU = \\big(\\text{sum of case ranks}\\big) - \\frac{m(m+1)}{2} = 23.5 - \\frac{4 \\cdot 5}{2} = 23.5 - 10 = 13.5,\n$$\n并且 $\\widehat{\\mathrm{AUC}} = U / (m n) = 13.5 / 20 = 27/40$，与成对计算的结果一致。\n\n因此，对于给定的数据集，使用所有病例-对照对并采用中阶秩次处理相同值的插件估计量的值为精确分数 $\\frac{27}{40}$。", "answer": "$$\\boxed{\\frac{27}{40}}$$", "id": "4568374"}, {"introduction": "一个常见的误解是，拥有较高AUC的诊断测试在所有情况下都更优。本练习旨在挑战这一过度简化的观点，它构建了一个精巧的场景：两个测试具有完全相同的AUC值，但在不同的阈值范围内其性能表现各异，即它们的ROC曲线发生了交叉。这个练习旨在培养你的批判性思维，让你认识到“最佳”测试的选择往往取决于具体的临床情境，例如假阳性和假阴性所带来的不同成本和疾病的流行率[@problem_id:4568428]。", "problem": "一个公共卫生筛查项目正在比较两种用于检测目标疾病的实验室评分测试，即测试 A 和测试 B。每种测试都会产生一个序数分数 $s \\in \\{0,1,2\\}$。未患病人群的分数分布与使用哪种测试无关，均为：$\\mathbb{P}(s=0 \\mid \\text{non-diseased}) = 3/5$，$\\mathbb{P}(s=1 \\mid \\text{non-diseased}) = 3/10$，以及 $\\mathbb{P}(s=2 \\mid \\text{non-diseased}) = 1/10$。患病人群的分布则因测试而异，具体如下：\n- 对于测试 A：$\\mathbb{P}(s=0 \\mid \\text{diseased}) = 2/15$，$\\mathbb{P}(s=1 \\mid \\text{diseased}) = 17/30$，$\\mathbb{P}(s=2 \\mid \\text{diseased}) = 3/10$。\n- 对于测试 B：$\\mathbb{P}(s=0 \\mid \\text{diseased}) = 2/45$，$\\mathbb{P}(s=1 \\mid \\text{diseased}) = 77/90$，$\\mathbb{P}(s=2 \\mid \\text{diseased}) = 1/10$。\n\n使用一个决策阈值 $t \\in \\{1,2\\}$，当 $s \\ge t$ 时分类为测试阳性，否则为测试阴性。对于任何阈值 $t$，真阳性率（灵敏度）定义为 $\\mathbb{P}(s \\ge t \\mid \\text{diseased})$，假阳性率定义为 $\\mathbb{P}(s \\ge t \\mid \\text{non-diseased})$。受试者工作特征（ROC）曲线绘制了当阈值 $t$ 在 $\\{2,1\\}$ 上变化时，真阳性率相对于假阳性率的变化情况，并包括端点 $(0,0)$ 和 $(1,1)$。ROC 曲线下面积（AUC）概括了总体的区分能力。在临床应用中，选定阈值 $t$ 的预期损失模型为\n$$L(t) = (1 - \\pi)\\, C_{\\mathrm{FP}} \\times \\mathrm{FPR}(t) + \\pi\\, C_{\\mathrm{FN}} \\times \\bigl(1 - \\mathrm{TPR}(t)\\bigr),$$\n其中 $\\pi$ 是疾病患病率，$C_{\\mathrm{FP}}$ 是假阳性的成本，$C_{\\mathrm{FN}}$ 是假阴性的成本。\n\n仅使用上述定义和概率论的基本原理，判断下列哪些陈述是正确的。\n\nA. 测试 A 和测试 B 的曲线下面积相同，但它们的 ROC 曲线相交：在假阳性率为 $0.1$ 时，测试 A 的真阳性率高于测试 B，而在假阳性率为 $0.4$ 时，测试 B 的真阳性率高于测试 A。\n\nB. 当患病率 $\\pi = 0.05$，假阳性成本 $C_{\\mathrm{FP}} = 5$，假阴性成本 $C_{\\mathrm{FN}} = 1$ 时，两种测试的损失最小化阈值均为 $t=1$，并且在该阈值下，测试 B 产生的预期损失低于测试 A。\n\nC. 当患病率 $\\pi = 0.05$，假阳性成本 $C_{\\mathrm{FP}} = 5$，假阴性成本 $C_{\\mathrm{FN}} = 1$ 时，两种测试的损失最小化阈值均为 $t=2$，并且在该阈值下，测试 A 产生的预期损失低于测试 B。\n\nD. 当患病率 $\\pi = 0.3$，假阳性成本 $C_{\\mathrm{FP}} = 1$，假阴性成本 $C_{\\mathrm{FN}} = 10$ 时，应首选测试 A，因为它与测试 B 具有相同的曲线下面积，因此在所有临床相关阈值上都更优。\n\nE. 当患病率 $\\pi = 0.3$，假阳性成本 $C_{\\mathrm{FP}} = 1$，假阴性成本 $C_{\\mathrm{FN}} = 10$ 时，两种测试的损失最小化阈值均为 $t=1$，并且在该阈值下，测试 B 产生的预期损失低于测试 A。\n\n选择所有适用项。", "solution": "我们从定义出发。\n\n第1步：计算在两个阈值 $t \\in \\{2,1\\}$ 下的假阳性率和真阳性率。\n\n根据定义，对于任何阈值 $t$，$\\mathrm{FPR}(t) = \\mathbb{P}(s \\ge t \\mid \\text{non-diseased})$ 且 $\\mathrm{TPR}(t) = \\mathbb{P}(s \\ge t \\mid \\text{diseased})$。\n\n对于未患病人群（两种测试通用）：\n- 当 $t=2$ 时：$\\mathrm{FPR}(2) = \\mathbb{P}(s=2 \\mid \\text{non-diseased}) = 1/10 = 0.1$。\n- 当 $t=1$ 时：$\\mathrm{FPR}(1) = \\mathbb{P}(s \\in \\{1,2\\} \\mid \\text{non-diseased}) = 3/10 + 1/10 = 4/10 = 0.4$。\n\n对于测试 A（患病人群分布为 $(2/15, 17/30, 3/10)$）：\n- 当 $t=2$ 时：$\\mathrm{TPR}_A(2) = \\mathbb{P}(s=2 \\mid \\text{diseased, A}) = 3/10 = 0.3$。\n- 当 $t=1$ 时：$\\mathrm{TPR}_A(1) = \\mathbb{P}(s \\in \\{1,2\\} \\mid \\text{diseased, A}) = 17/30 + 3/10 = 17/30 + 9/30 = 26/30 = 13/15 \\approx 0.866\\overline{6}$。\n\n对于测试 B（患病人群分布为 $(2/45, 77/90, 1/10)$）：\n- 当 $t=2$ 时：$\\mathrm{TPR}_B(2) = \\mathbb{P}(s=2 \\mid \\text{diseased, B}) = 1/10 = 0.1$。\n- 当 $t=1$ 时：$\\mathrm{TPR}_B(1) = \\mathbb{P}(s \\in \\{1,2\\} \\mid \\text{diseased, B}) = 77/90 + 1/10 = 77/90 + 9/90 = 86/90 = 43/45 \\approx 0.955\\overline{5}$。\n\n因此，除了端点 $(0,0)$ 和 $(1,1)$ 外，ROC 点为：\n- 在 $\\mathrm{FPR} = 0.1$ 时：$\\mathrm{TPR}_A = 0.3$ 且 $\\mathrm{TPR}_B = 0.1$。\n- 在 $\\mathrm{FPR} = 0.4$ 时：$\\mathrm{TPR}_A = 13/15 \\approx 0.866\\overline{6}$ 且 $\\mathrm{TPR}_B = 43/45 \\approx 0.955\\overline{5}$。\n\n我们立即看到，在 $\\mathrm{FPR} = 0.1$ 时测试 A 占优，而在 $\\mathrm{FPR} = 0.4$ 时测试 B 占优，这意味着 ROC 曲线相交。\n\n第2步：计算每个测试的曲线下面积（AUC）。\n\n对于基于分数的测试，曲线下面积（AUC）的一个基本特征是，它等于随机选择的患病个体的分数高于随机选择的未患病个体分数的概率，加上分数相等概率的一半。也就是说，\n$$\\mathrm{AUC} = \\mathbb{P}(S_D > S_N) + \\tfrac{1}{2}\\mathbb{P}(S_D = S_N),$$\n其中 $S_D$ 和 $S_N$ 分别表示从患病和未患病个体中独立抽样的分数。\n\n设未患病人群在分数 $(0,1,2)$ 上的概率为 $(a,b,c) = (3/5, 3/10, 1/10)$，对于给定的测试，设患病人群在分数 $(0,1,2)$ 上的概率为 $(x,y,z)$。\n\n那么\n- $\\mathbb{P}(S_D > S_N) = y \\cdot a + z \\cdot (a + b)$，因为患病者分数为1胜过未患病者分数0的概率为 $a$，而患病者分数为2胜过未患病者分数 $\\{0,1\\}$ 的概率为 $a + b$。\n- $\\mathbb{P}(S_D = S_N) = x \\cdot a + y \\cdot b + z \\cdot c$。\n\n因此\n$$\\mathrm{AUC} = y a + z(a+b) + \\tfrac{1}{2}\\left(x a + y b + z c\\right).$$\n\n对于测试 A，$(x,y,z) = (2/15, 17/30, 3/10)$。计算\n- $y a = (17/30)\\cdot(3/5) = 51/150 = 17/50 = 0.34$,\n- $z(a+b) = (3/10)\\cdot(3/5 + 3/10) = (3/10)\\cdot(9/10) = 27/100 = 0.27$,\n- $x a + y b + z c = (2/15)\\cdot(3/5) + (17/30)\\cdot(3/10) + (3/10)\\cdot(1/10) = 2/25 + 17/100 + 3/100 = 8/100 + 20/100 = 28/100 = 0.28$,\n因此 $\\tfrac{1}{2}\\mathbb{P}(S_D = S_N) = 0.14$。求和得到 $\\mathrm{AUC}_A = 0.34 + 0.27 + 0.14 = 0.75 = 3/4$。\n\n对于测试 B，$(x,y,z) = (2/45, 77/90, 1/10)$。计算\n- $y a = (77/90)\\cdot(3/5) = 231/450 = 77/150 \\approx 0.513\\overline{3}$,\n- $z(a+b) = (1/10)\\cdot(3/5 + 3/10) = (1/10)\\cdot(9/10) = 9/100 = 0.09$,\n- $x a + y b + z c = (2/45)\\cdot(3/5) + (77/90)\\cdot(3/10) + (1/10)\\cdot(1/10) = 2/75 + 77/300 + 1/100 = 8/300 + 77/300 + 3/300 = 88/300 = 22/75 \\approx 0.293\\overline{3}$,\n因此 $\\tfrac{1}{2}\\mathbb{P}(S_D = S_N) \\approx 0.146\\overline{6}$。求和得到 $\\mathrm{AUC}_B \\approx 0.513\\overline{3} + 0.09 + 0.146\\overline{6} = 0.75 = 3/4$。\n\n因此 $\\mathrm{AUC}_A = \\mathrm{AUC}_B = 3/4$，尽管如第1步所示，ROC 曲线相交。\n\n第3步：在两种指定的临床情景下评估预期损失 $L(t)$，并为每种测试选择损失最小化的阈值。\n\n根据定义，\n$$L(t) = (1 - \\pi)\\, C_{\\mathrm{FP}} \\times \\mathrm{FPR}(t) + \\pi\\, C_{\\mathrm{FN}} \\times \\bigl(1 - \\mathrm{TPR}(t)\\bigr).$$\n\n情景1：$\\pi = 0.05$, $C_{\\mathrm{FP}} = 5$, $C_{\\mathrm{FN}} = 1$。\n\n共同的假阳性率：$\\mathrm{FPR}(2) = 0.1$, $\\mathrm{FPR}(1) = 0.4$。\n\n- 测试 A：\n  - $L_A(2) = (1 - 0.05)\\cdot 5 \\cdot 0.1 + 0.05 \\cdot 1 \\cdot (1 - 0.3) = 0.95 \\cdot 0.5 + 0.05 \\cdot 0.7 = 0.475 + 0.035 = 0.51$。\n  - $L_A(1) = 0.95 \\cdot 5 \\cdot 0.4 + 0.05 \\cdot 1 \\cdot (1 - 13/15) = 1.9 + 0.05 \\cdot (2/15) \\approx 1.9 + 0.006\\overline{6} \\approx 1.906\\overline{6}$。\n  测试 A 的损失最小化阈值为 $t=2$。\n\n- 测试 B：\n  - $L_B(2) = 0.95 \\cdot 5 \\cdot 0.1 + 0.05 \\cdot 1 \\cdot (1 - 0.1) = 0.475 + 0.05 \\cdot 0.9 = 0.475 + 0.045 = 0.52$。\n  - $L_B(1) = 0.95 \\cdot 5 \\cdot 0.4 + 0.05 \\cdot 1 \\cdot (1 - 43/45) = 1.9 + 0.05 \\cdot (2/45) \\approx 1.9 + 0.002\\overline{2} \\approx 1.902\\overline{2}$。\n  测试 B 的损失最小化阈值为 $t=2$。\n\n在最小化阈值处进行比较：$L_A(2) = 0.51 < L_B(2) = 0.52$，因此测试 A 产生的预期损失更低。\n\n情景2：$\\pi = 0.3$, $C_{\\mathrm{FP}} = 1$, $C_{\\mathrm{FN}} = 10$。\n\n- 测试 A：\n  - $L_A(2) = (1 - 0.3)\\cdot 1 \\cdot 0.1 + 0.3 \\cdot 10 \\cdot (1 - 0.3) = 0.7 \\cdot 0.1 + 3 \\cdot 0.7 = 0.07 + 2.1 = 2.17$。\n  - $L_A(1) = 0.7 \\cdot 0.4 + 3 \\cdot (1 - 13/15) = 0.28 + 3 \\cdot (2/15) = 0.28 + 0.4 = 0.68$ (使用 $2/15 \\approx 0.133\\overline{3}$ 产生 $0.679\\overline{9}$；精确值为 $0.68$ 因为 $3 \\cdot 2/15 = 6/15 = 2/5$)。\n  测试 A 的损失最小化阈值为 $t=1$。\n\n- 测试 B：\n  - $L_B(2) = 0.7 \\cdot 0.1 + 3 \\cdot (1 - 0.1) = 0.07 + 2.7 = 2.77$。\n  - $L_B(1) = 0.7 \\cdot 0.4 + 3 \\cdot (1 - 43/45) = 0.28 + 3 \\cdot (2/45) = 0.28 + 6/45 = 0.28 + 2/15 \\approx 0.28 + 0.133\\overline{3} \\approx 0.413\\overline{3}$。\n  测试 B 的损失最小化阈值为 $t=1$。\n\n在最小化阈值处进行比较：$L_A(1) \\approx 0.68$ 对比 $L_B(1) \\approx 0.413\\overline{3}$；因此测试 B 产生的预期损失更低。\n\n第4步：逐项分析。\n\n- 选项 A：我们已经证明 $\\mathrm{AUC}_A = \\mathrm{AUC}_B = 3/4$，并且在 $\\mathrm{FPR} = 0.1$ 和 $\\mathrm{FPR} = 0.4$ 处的 ROC 点满足 $\\mathrm{TPR}_A(0.1) = 0.3 > 0.1 = \\mathrm{TPR}_B(0.1)$ 和 $\\mathrm{TPR}_A(0.4) = 13/15 \\approx 0.866\\overline{6} < 43/45 \\approx 0.955\\overline{5} = \\mathrm{TPR}_B(0.4)$。因此 ROC 曲线相交，该陈述成立。结论：正确。\n\n- 选项 B：在 $\\pi = 0.05$，$C_{\\mathrm{FP}} = 5$，$C_{\\mathrm{FN}} = 1$ 的条件下，我们发现两种测试的损失最小化阈值均为 $t=2$，而不是 $t=1$，并且 $L_A(2) < L_B(2)$。结论：不正确。\n\n- 选项 C：在同样低患病率、高假阳性成本的情景下，两种测试都在 $t=2$ 时使损失最小化，并且测试 A 产生的预期损失低于测试 B。结论：正确。\n\n- 选项 D：相同的曲线下面积并不意味着在所有阈值上都更优；事实上，ROC 曲线相交，并且在 $\\pi = 0.3$，$C_{\\mathrm{FP}} = 1$，$C_{\\mathrm{FN}} = 10$ 的条件下，两种测试都在 $t=1$ 时使损失最小化，其中测试 B 的预期损失更低。结论：不正确。\n\n- 选项 E：在 $\\pi = 0.3$，$C_{\\mathrm{FP}} = 1$，$C_{\\mathrm{FN}} = 10$ 的条件下，两种测试都在 $t=1$ 时使损失最小化，并且测试 B 的预期损失低于测试 A。结论：正确。", "answer": "$$\\boxed{ACE}$$", "id": "4568428"}]}