{"hands_on_practices": [{"introduction": "计算研究所需的样本量是设计任何有效随机对照试验（RCT）的基石。第一个实践问题 [@problem_id:4579242] 提供了一个经典场景：确定需要多少参与者才能检测到两种率之间的有意义差异。掌握这种计算对于确保研究既可行又有很高的机会得出结论性结果至关重要。", "problem": "一个公共卫生团队计划进行一项双臂随机对照试验（RCT），以评估一项旨在降低大学一年级学生中某种可改变风险行为的$6$个月发生率的预防性咨询干预措施。在对照组中，他们预计发生率为$p_{2}=0.20$。他们希望能够在使用显著性水平 $\\alpha = 0.05$、检验效能 $1-\\beta = 0.90$ 的双边假设检验时，检测出 $\\Delta = p_{1}-p_{2} = -0.05$ 的降低（即干预组中的发生率为 $p_{1}=0.15$）。假设结果为独立的伯努利分布，两组样本量相等（每组 $n$ 人），并且样本比例之差的大样本正态近似法对于检验水准和检验效能评估均适用。\n\n在这些假设下，使用两个独立比例的双边检验，计算为达到这些设计目标每组所需的样本量 $n$。将您的答案四舍五入至4位有效数字。", "solution": "该问题是有效的，因为它代表了预防医学中一个标准的、定义明确的统计效能和样本量计算情景。所有必要的数据和条件（$p_1$、$p_2$、$\\alpha$、$1-\\beta$、双边检验、等量分配）都已提供，并且在科学上和事实上都是合理的。\n\n目标是计算RCT两组各自所需的样本量 $n$。该研究旨在检测两个独立比例 $p_1$ 和 $p_2$ 之间的差异。\n\n双边检验的假设如下：\n原假设 $H_0: p_1 = p_2$。\n备择假设 $H_a: p_1 \\neq p_2$。\n\n问题提供了以下参数：\n- 干预组的发生率，$p_1 = 0.15$。\n- 对照组的发生率，$p_2 = 0.20$。\n- 显著性水平，$\\alpha = 0.05$。\n- 期望效能，$1-\\beta = 0.90$，这意味着 $\\beta = 0.10$。\n- 分配是相等的，即 $n_1 = n_2 = n$。\n\n样本量计算必须基于大样本正态近似。对于两个比例的双边检验，检验统计量在原假设下服从标准正态分布。然而，效能计算是在备择假设下进行的。一个严谨的、考虑了原假设和备择假设下不同方差的每组样本量公式如下：\n$$n = \\frac{\\left(Z_{1-\\alpha/2} \\sqrt{2\\bar{p}(1-\\bar{p})} + Z_{1-\\beta} \\sqrt{p_1(1-p_1) + p_2(1-p_2)}\\right)^2}{(p_1-p_2)^2}$$\n此处，$\\bar{p}$ 是原假设下的合并比例，在本次计算中，我们将其估计为备择假设下两个比例的平均值，即 $\\bar{p} = \\frac{p_1+p_2}{2}$。$Z_{1-\\alpha/2}$ 是对应于上侧尾部概率为 $\\alpha/2$ 的标准正态分位数，$Z_{1-\\beta}$ 是对应于期望效能的标准正态分位数。\n\n首先，我们确定所需的 $Z$ 分数：\n- 对于双边检验且 $\\alpha = 0.05$，我们需要对应于 $1 - \\alpha/2 = 1 - 0.025 = 0.975$ 的分位数。\n  $$Z_{1-\\alpha/2} = Z_{0.975} \\approx 1.959964$$\n- 对于效能 $1-\\beta = 0.90$，我们需要对应于 $1 - \\beta = 0.90$ 的分位数。\n  $$Z_{1-\\beta} = Z_{0.90} \\approx 1.281552$$\n\n接下来，我们计算必要的比例和方差项：\n- 比例之差为 $p_1 - p_2 = 0.15 - 0.20 = -0.05$。该差值的平方为 $(p_1-p_2)^2 = (-0.05)^2 = 0.0025$。\n- 合并比例为 $\\bar{p} = \\frac{0.15 + 0.20}{2} = 0.175$。\n- 原假设部分的方差项为 $2\\bar{p}(1-\\bar{p}) = 2(0.175)(1-0.175) = 2(0.175)(0.825) = 0.28875$。\n- 备择假设部分的方差项为 $p_1(1-p_1) + p_2(1-p_2) = 0.15(1-0.15) + 0.20(1-0.20) = 0.15(0.85) + 0.20(0.80) = 0.1275 + 0.16 = 0.2875$。\n\n现在我们将这些值代入样本量公式中：\n$$n = \\frac{\\left(1.959964 \\sqrt{0.28875} + 1.281552 \\sqrt{0.2875}\\right)^2}{0.0025}$$\n计算分子中的各项：\n$$n = \\frac{\\left(1.959964 \\times 0.5373546 + 1.281552 \\times 0.5361903\\right)^2}{0.0025}$$\n$$n = \\frac{\\left(1.053201 + 0.687181\\right)^2}{0.0025}$$\n$$n = \\frac{(1.740382)^2}{0.0025}$$\n$$n = \\frac{3.02893}{0.0025}$$\n$$n \\approx 1211.572$$\n\n由于样本量必须是整数，我们必须将此值向上取整到下一个整数，以确保研究的效能至少为 $0.90$。\n所需的 $n = \\lceil 1211.572 \\rceil = 1212$\n问题要求最终答案四舍五入至4位有效数字。整数值 $1212$ 已经包含4位有效数字。因此，每组所需的样本量为 $1212$。", "answer": "$$\\boxed{1212}$$", "id": "4579242"}, {"introduction": "研究计划总是涉及假设，但当现实与我们最初的估计不同时会发生什么？本练习 [@problem_id:4579233] 探讨了样本量重新估计这一关键概念，这是适应性试验设计中的常见做法。你将计算在期中分析中发现的、高于预期的方差如何影响维持研究目标统计功效所需的样本量。", "problem": "一项基于社区的生活方式干预项目正在一项预防医学领域的双臂随机对照试验 (RCT) 中进行评估。主要结局指标是 $6$ 个月时干预组与对照组之间每周中到高强度体力活动 (MVPA) 分钟数的平均变化量。该设计旨在检测一个具有临床意义的差异，即每周 $\\Delta = 30$ 分钟（干预组减去对照组），采用等数分配，双侧 I 型错误率为 $\\alpha = 0.05$。检验效能设定为 $0.80$。\n\n预试验数据表明，公共标准差为每周 $100$ 分钟，初始样本量是在各组总体方差相等的假设下计划的。在一次用于样本量重新估计的预先计划的盲态期中分析中，发现合并方差估计值比预期高出 $25\\%$。也就是说，更新后的工作方差为 $\\hat{\\sigma}^{2} = 1.25 \\,\\sigma_{0}^{2}$，其中 $\\sigma_{0}^{2}$ 表示最初预期的方差。\n\n假设在组样本量相等和方差相等的条件下，对双样本均值比较使用大样本正态近似，并保持相同的假设、$\\alpha$ 和检验效能不变，请从第一性原理出发，推导在方差增大情况下所需的更新后的每组实值样本量 $n$，并使用标准正态分布的分位数计算其数值。将您的最终单个数值答案四舍五入至四位有效数字。不要进行任何离散化取整为整数的操作；报告进行任何向上取整操作之前的实值计划数量。", "solution": "该问题要求推导在更新方差估计后，为保持预设统计功效所需的每组样本量，并进行数值计算。这是一个典型的双样本均值比较的样本量计算问题。\n\n首先，我们从第一性原理出发推导样本量公式。设干预组和对照组的真实均值分别为 $\\mu_I$ 和 $\\mu_C$。双侧检验的假设为：\n- 虚无假设 $H_0: \\mu_I - \\mu_C = 0$\n- 备择假设 $H_A: \\mu_I - \\mu_C \\neq 0$\n\n设两组的样本均值分别为 $\\bar{X}_I$ 和 $\\bar{X}_C$，每组样本量为 $n$，共同的总体方差为 $\\hat{\\sigma}^2$。根据大样本理论，检验统计量为：\n$$ Z = \\frac{(\\bar{X}_I - \\bar{X}_C) - (\\mu_I - \\mu_C)}{\\sqrt{\\frac{\\hat{\\sigma}^2}{n} + \\frac{\\hat{\\sigma}^2}{n}}} = \\frac{(\\bar{X}_I - \\bar{X}_C) - (\\mu_I - \\mu_C)}{\\sqrt{\\frac{2\\hat{\\sigma}^2}{n}}} $$\n该统计量近似服从标准正态分布 $N(0,1)$。\n\n在虚无假设 $H_0$ 下，$\\mu_I - \\mu_C = 0$，检验统计量简化为 $Z_0 = \\frac{\\bar{X}_I - \\bar{X}_C}{\\sqrt{2\\hat{\\sigma}^2/n}}$。对于显著性水平为 $\\alpha$ 的双侧检验，当 $|Z_0| > z_{1-\\alpha/2}$ 时拒绝 $H_0$，其中 $z_{q}$ 是标准正态分布的第 $q$ 分位数。\n\n统计功效是在备择假设为真时正确拒绝 $H_0$ 的概率。我们关注的特定备择假设是 $\\mu_I - \\mu_C = \\Delta$。功效的表达式为：\n$$ 1 - \\beta = P(\\text{拒绝 } H_0 | \\mu_I - \\mu_C = \\Delta) = P\\left(|\\bar{X}_I - \\bar{X}_C| > z_{1-\\alpha/2} \\sqrt{\\frac{2\\hat{\\sigma}^2}{n}} \\;\\Bigg|\\; \\mu_I - \\mu_C = \\Delta \\right) $$\n由于我们预期的效应 $\\Delta > 0$，我们主要关心拒绝域的上尾，即 $\\bar{X}_I - \\bar{X}_C > z_{1-\\alpha/2} \\sqrt{\\frac{2\\hat{\\sigma}^2}{n}}$。\n在备择假设下，$\\bar{X}_I - \\bar{X}_C$ 近似服从均值为 $\\Delta$、方差为 $2\\hat{\\sigma}^2/n$ 的正态分布。为了计算功效，我们将上述不等式标准化：\n$$ \\frac{(\\bar{X}_I - \\bar{X}_C) - \\Delta}{\\sqrt{2\\hat{\\sigma}^2/n}} > \\frac{z_{1-\\alpha/2} \\sqrt{2\\hat{\\sigma}^2/n} - \\Delta}{\\sqrt{2\\hat{\\sigma}^2/n}} $$\n不等式左边是一个标准正态变量 $Z'$。因此：\n$$ P\\left(Z' > z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\hat{\\sigma}^2/n}}\\right) = 1-\\beta $$\n这意味着不等号右边的表达式必须等于标准正态分布的第 $\\beta$ 分位数，即 $-z_{1-\\beta}$。\n$$ -z_{1-\\beta} = z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\hat{\\sigma}^2/n}} $$\n整理此方程以求解 $n$：\n$$ \\frac{\\Delta}{\\sqrt{2\\hat{\\sigma}^2/n}} = z_{1-\\alpha/2} + z_{1-\\beta} $$\n$$ \\sqrt{n} = \\frac{(z_{1-\\alpha/2} + z_{1-\\beta}) \\sqrt{2\\hat{\\sigma}^2}}{\\Delta} $$\n两边平方，得到每组所需样本量的通用公式：\n$$ n = \\frac{2\\hat{\\sigma}^2(z_{1-\\alpha/2} + z_{1-\\beta})^2}{\\Delta^2} $$\n接下来，我们将问题中给出的数值代入此公式。\n- 临床意义差异：$\\Delta = 30$ 分钟。\n- 双侧 I 型错误率：$\\alpha = 0.05$，因此 $\\alpha/2 = 0.025$。对应的分位数为 $z_{1-0.025} = z_{0.975} \\approx 1.95996$。\n- 统计功效：$1-\\beta = 0.80$，因此 II 型错误率为 $\\beta = 0.20$。对应的分位数为 $z_{1-0.20} = z_{0.80} \\approx 0.84162$。\n- 原始标准差：$\\sigma_0 = 100$ 分钟，因此原始方差 $\\sigma_0^2 = 100^2 = 10000$。\n- 更新后的工作方差：$\\hat{\\sigma}^2 = 1.25 \\times \\sigma_0^2 = 1.25 \\times 10000 = 12500$。\n\n代入数值进行计算：\n$$ n = \\frac{2 \\times 12500 \\times (1.95996 + 0.84162)^2}{30^2} $$\n$$ n = \\frac{25000 \\times (2.80158)^2}{900} $$\n$$ n = \\frac{25000 \\times 7.84885}{900} $$\n$$ n = \\frac{196221.25}{900} $$\n$$ n \\approx 218.0236 $$\n根据题目要求，将最终的实值样本量四舍五入至四位有效数字，得到 $218.0$。", "answer": "$$\\boxed{218.0}$$", "id": "4579233"}, {"introduction": "现代临床试验通常会研究多个终点，以最大限度地获取知识。然而，检验多个假设会增加得出假阳性结论的风险。这个问题 [@problem_id:4579236] 深入探讨了这一挑战，要求你计算在样本量增加方面，为使用Bonferroni校正来控制总体错误率而增加次要终点所需付出的“代价”。", "problem": "一个预防医学研究团队正在计划一项双臂、平行组随机试验，旨在比较生活方式干预与常规护理对一个连续型主要终点（例如，$12$个月时的收缩压）的影响。假设等量分配，中心极限定理（CLT）的大样本有效性成立，因此在原假设下，均值差异的标准化检验统计量近似服从标准正态分布，并且所有假设检验均为双侧检验。\n\n最初，该团队计划研究在0.05的双侧显著性水平下，针对主要终点上的一个固定的标准化效应量（均值差异除以共同标准差）达到80%的检验效能。随后，他们决定纳入五个额外的、预先指定的次要终点，并使用简单的Bonferroni校正方法，将该校正平均应用于所有六个终点（一个主要终点和五个次要终点），以将总体错误率（FWER）控制在0.05。\n\n在这些假设下，并保持标准化效应量和所有其他设计特征不变，确定在应用Bonferroni校正后，为了保持主要终点的检验效能为80%，最初计划的总样本量必须增加的乘法膨胀因子。请将您的答案表示为一个无量纲因子，并将最终结果四舍五入到三位有效数字。", "solution": "我们从等量分配下均值差异的双样本$Z$检验的标准正态近似开始。设组均值的真实差异为$\\delta$，共同标准差为$\\sigma$，每组的样本量为$n$。标准化检验统计量可以写成\n$$\nT \\;=\\; \\frac{\\widehat{\\delta}}{\\sigma\\sqrt{2/n}}\\,,\n$$\n在原假设下，该统计量满足$T \\sim \\mathcal{N}(0,1)$；在备择假设下，满足$T \\sim \\mathcal{N}(\\mu,1)$，其中非中心参数为\n$$\n\\mu \\;=\\; \\frac{\\delta}{\\sigma}\\sqrt{\\frac{n}{2}} \\;=\\; d\\,\\sqrt{\\frac{n}{2}}\\,,\n$$\n这里 $d \\equiv \\delta/\\sigma$ 是标准化效应量。\n\n对于显著性水平为$\\alpha$的双侧检验，拒绝域为 $|T| \\ge z_{1-\\alpha/2}$，其中$z_{q}$表示标准正态分布的$q$-分位数。在每组样本量为$n$时，检验效能为\n$$\n\\Pr\\left(|T| \\ge z_{1-\\alpha/2}\\,\\big|\\,\\mu\\right)\n\\;=\\; \\Pr\\left(Z \\ge z_{1-\\alpha/2} - \\mu\\right) + \\Pr\\left(Z \\le -z_{1-\\alpha/2} - \\mu\\right),\n$$\n其中 $Z \\sim \\mathcal{N}(0,1)$。一个被广泛接受的标准设计方程，是在目标检验效能$1-\\beta$下求解$n$得到的：\n$$\n\\mu \\;=\\; z_{1-\\alpha/2} + z_{1-\\beta}\\,,\n$$\n这给出了每组的样本量\n$$\nn(\\alpha, \\beta, d) \\;=\\; \\frac{2\\left(z_{1-\\alpha/2} + z_{1-\\beta}\\right)^{2}}{d^{2}}\\,.\n$$\n这个表达式是在目标尾部概率下求解$\\mu$时，正态检验的检验效能定义和分位数加性性质的直接结果。\n\n题目要求我们计算从初始设计（双侧$\\alpha = 0.05$，检验效能$1-\\beta = 0.80$）转变为一个经过Bonferroni校正的设计时所需的乘法膨胀因子。该校正设计在$m=6$个终点（一个主要终点加五个次要终点）上将总体错误率（FWER）控制在0.05。在Bonferroni校正下，单次检验的显著性水平为\n$$\n\\alpha' \\;=\\; \\frac{0.05}{6}\\,.\n$$\n膨胀因子$F$是在相同的$d$和$1-\\beta$下，两种$\\alpha$水平所需的每组（或总）样本量之比：\n$$\nF \\;=\\; \\frac{n(\\alpha', \\beta, d)}{n(\\alpha, \\beta, d)}\n\\;=\\; \\left(\\frac{z_{1-\\alpha'/2} + z_{1-\\beta}}{z_{1-\\alpha/2} + z_{1-\\beta}}\\right)^{2}.\n$$\n注意，$d$和前面的因子$2$被消掉了，所以$F$与未知的标准化效应量无关。\n\n现在我们计算分位数：\n- 目标检验效能 $1-\\beta = 0.80$ 给出 $z_{1-\\beta} = z_{0.80} \\approx 0.841621$。\n- 对于未校正的双侧水平 $\\alpha = 0.05$，有 $z_{1-\\alpha/2} = z_{0.975} \\approx 1.959964$。\n- 对于Bonferroni校正后的双侧水平，$\\alpha' = 0.05/6 \\approx 0.008333\\ldots$，所以 $1 - \\alpha'/2 = 1 - 0.008333\\ldots/2 = 0.995833\\ldots$，因此 $z_{1-\\alpha'/2} = z_{0.995833\\ldots} \\approx 2.639$。\n\n使用这些数值，我们计算\n$$\nz_{1-\\alpha'/2} + z_{1-\\beta} \\approx 2.639 + 0.841621 = 3.480621,\n$$\n$$\nz_{1-\\alpha/2} + z_{1-\\beta} \\approx 1.959964 + 0.841621 = 2.801585.\n$$\n因此，\n$$\nF \\;=\\; \\left(\\frac{3.480621}{2.801585}\\right)^{2} \\;\\approx\\; (1.242)^{2} \\;\\approx\\; 1.543.\n$$\n\n将最终结果四舍五入到三位有效数字，所需的乘法膨胀因子为$1.54$。", "answer": "$$\\boxed{1.54}$$", "id": "4579236"}]}