{"hands_on_practices": [{"introduction": "在构建传染病模型时，首要决策之一是如何定义传播项。本练习将引导你探讨两种基本假设——密度依赖和频率依赖——并揭示它们对人口规模如何影响疫情风险的不同预测。通过推导和比较这两种情况下的流行阈值，你将理解模型假设与其预测之间的关键联系 [@problem_id:4544623]。", "problem": "一个人口规模固定为 $N$ 的封闭人群社区，引入了一种新的急性传染病原体，该病原体遵循易感-感染-移除 (SIR) 房室动力学。在此模型中，个体通过有效接触从易感状态转变为感染状态，并通过康复从感染状态转变为移除状态。假设在短暂的流行期间没有人口变化（没有出生或非疾病死亡）、个体均匀混合，并且平均感染期为 $1/\\gamma$，其中 $\\gamma > 0$。设传播参数为 $\\beta > 0$，并考虑预防医学和数学流行病学中使用的两种可能的发病率假设：\n\n- 密度依赖（质量作用）发病率：感染力与乘积 $S I$ 成正比。\n- 频率依赖（标准）发病率：感染力与 $S I / N$ 成正比。\n\n在病原体引入后，假设 $I(0) \\ll N$ 且 $S(0) \\approx N$。仅使用每种发病率假设下的 SIR 控制方程，推导感染初始增长的疫情阈值。该阈值定义为参数空间中区分 $I(t)$ 初始衰减与初始增长的边界。将您最终的疫情阈值表示为关于 $\\beta$、$\\gamma$ 和 $N$ 的闭式无量纲表达式，一个用于密度依赖发病率，另一个用于频率依赖发病率。无需进行数值评估。此外，在您的推理中，简要比较两种假设下阈值对 $N$ 的定性依赖关系。最终提交的答案必须只包含两个阈值表达式，以单行矩阵的形式并排呈现。最终的方框答案中不要包含单位。", "solution": "该问题要求在密度依赖和频率依赖这两种不同的发病率假设下，推导易感-感染-移除 (SIR) 模型的疫情阈值。该阈值条件决定了当传染病原体引入易感人群后，疫情是会增长还是会消亡。\n\n首先，我们建立关于感染者数量 $I(t)$ 的控制微分方程。状态变量为 $S(t)$、$I(t)$ 和 $R(t)$，分别代表易感、感染和移除房室中的个体数量。总人口规模 $N$ 是恒定的，因此 $N = S(t) + I(t) + R(t)$。感染者被移除的速率（例如，通过康复并获得免疫）由 $\\gamma I(t)$ 给出，其中 $\\gamma > 0$ 是移除率，$1/\\gamma$ 是平均感染期。\n\n新发疫情的初始条件是感染者数量非常少，$I(0) > 0$，而人口几乎完全是易感的，因此 $S(0) \\approx N$。疫情暴发的条件是感染者数量必须在初始阶段增加，即 $\\frac{dI}{dt}|_{t=0} > 0$。\n\n**情况1：密度依赖（质量作用）发病率**\n在此假设下，新感染的速率与易感者和感染者的密度乘积成正比。在以人口数量而非密度的模型中，这被形式化为与个体数量 $S$ 和 $I$ 的乘积成正比。新感染的速率是 $\\beta S I$，其中 $\\beta > 0$ 是传播参数。感染房室的微分方程为：\n$$ \\frac{dI}{dt} = \\text{感染率} - \\text{移除率} = \\beta S(t) I(t) - \\gamma I(t) $$\n我们可以提出公因子 $I(t)$：\n$$ \\frac{dI}{dt} = I(t) (\\beta S(t) - \\gamma) $$\n为了评估初始增长，我们在 $t=0$ 处计算该导数：\n$$ \\frac{dI}{dt}|_{t=0} = I(0) (\\beta S(0) - \\gamma) $$\n为了使疫情增长，我们要求 $\\frac{dI}{dt}|_{t=0} > 0$。由于根据定义 $I(0) > 0$（已引入感染），增长的条件是：\n$$ \\beta S(0) - \\gamma > 0 $$\n使用人口几乎完全易感的近似值 $S(0) \\approx N$，该条件变为：\n$$ \\beta N - \\gamma > 0 $$\n重新整理这个不等式，得到阈值条件：\n$$ \\frac{\\beta N}{\\gamma} > 1 $$\n因此，疫情阈值是无量纲表达式 $\\frac{\\beta N}{\\gamma}$。这个量通常被称为基本再生数，$R_0$。对于密度依赖模型，我们有：\n$$ R_{0, \\text{density}} = \\frac{\\beta N}{\\gamma} $$\n\n**情况2：频率依赖（标准）发病率**\n在此假设下，新感染的速率与易感者数量和感染者在总人口中所占的*比例* $I/N$ 的乘积成正比。新感染的速率是 $\\beta S \\frac{I}{N}$。感染房室的微分方程为：\n$$ \\frac{dI}{dt} = \\beta \\frac{S(t) I(t)}{N} - \\gamma I(t) $$\n提出公因子 $I(t)$：\n$$ \\frac{dI}{dt} = I(t) \\left( \\beta \\frac{S(t)}{N} - \\gamma \\right) $$\n在 $t=0$ 处，根据条件 $\\frac{dI}{dt}|_{t=0} > 0$ 且 $I(0) > 0$ 进行评估，我们得到：\n$$ \\beta \\frac{S(0)}{N} - \\gamma > 0 $$\n再次代入近似值 $S(0) \\approx N$：\n$$ \\beta \\frac{N}{N} - \\gamma > 0 \\implies \\beta - \\gamma > 0 $$\n重新整理得到阈值条件：\n$$ \\frac{\\beta}{\\gamma} > 1 $$\n因此，频率依赖模型的疫情阈值为：\n$$ R_{0, \\text{freq}} = \\frac{\\beta}{\\gamma} $$\n\n**关于对 $N$ 的依赖性的比较**\n推导出的疫情阈值在对总人口规模 $N$ 的依赖性上显示出关键差异。\n- 密度依赖阈值 $R_{0, \\text{density}} = \\frac{\\beta N}{\\gamma}$ 与 $N$ 成正比。这意味着，在其他条件相同的情况下，更大的人口规模本质上更容易受到疫情暴发的影响。该模型假设个体的接触数量随人口密度而变化。\n- 频率依赖阈值 $R_{0, \\text{freq}} = \\frac{\\beta}{\\gamma}$ 与 $N$ 无关。该模型假设无论总人口规模如何，个体的接触数量相对固定。疾病的传播取决于特定接触是与感染者接触的概率（$I/N$），而不是感染者的绝对数量。对于通过密切接触在人群中传播的疾病，这通常被认为是一个更现实的模型，因为在这些人群中，社会结构限制了接触率。\n\n所要求的两个表达式是：密度依赖发病率的 $\\frac{\\beta N}{\\gamma}$ 和频率依赖发病率的 $\\frac{\\beta}{\\gamma}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\beta N}{\\gamma} & \\frac{\\beta}{\\gamma} \\end{pmatrix}}$$", "id": "4544623"}, {"introduction": "在真实世界的疫情爆发初期，我们通常能观察到指数增长率（$r$），但需要推断出更根本的基本再生数（$R_0$）。本练习将展示更新方程如何为这两者提供理论联系。你将通过对比不同生成间隔分布的假设，揭示一个关键的细微之处：生成间隔分布的“形状”（而不仅仅是其均值）会如何影响$R_0$的估算 [@problem_id:4544603]。", "problem": "一种呼吸道病原体在一个庞大且充分混合的人群中出现。早期疫情数据显示，发病率以速率 $r$（每天）近似呈指数增长。预防医学团队还独立临床估算出恢复率为 $\\gamma$（每天），在无记忆（指数分布）传染期的假设下，该值等于平均代际间隔的倒数。\n\n使用关联基本再生数 $R_{0}$、早期指数增长率 $r$ 和代际间隔分布 $g(\\tau)$ 的更新方程框架，按以下步骤进行：\n\n- 在传染期为指数分布的假设下（因此代际间隔是均值为 $1/\\gamma$ 的指数分布），通过在 $r=0$ 附近进行线性化，得到 $R_{0}$ 关于 $r$ 和 $\\gamma$ 的一阶近似。然后对 $r=0.2$ 每天和 $\\gamma=0.25$ 每天的情况进行数值计算。\n\n- 现在假设详细的接触者追踪表明，代际间隔分布更适合用形状参数 $k=2$ 且均值为 $1/\\gamma$ 的伽马分布来描述。使用相同的更新框架，计算当 $r=0.2$ 每天、$\\gamma=0.25$ 每天和 $k=2$ 时的精确 $R_{0}$。\n\n- 将有符号相对近似误差定义为 $\\left(R_{0}^{\\text{approx}}-R_{0}^{\\text{exact}}\\right)/R_{0}^{\\text{exact}}$。使用上述结果计算该值。\n\n请以精确分数形式（不四舍五入）给出最终答案，该答案为一个无单位的数字。不要使用百分号。最终答案必须是如上定义的有符号相对误差。", "solution": "基本再生数 $R_{0}$、指数增长率 $r$ 和代际间隔分布 $g(\\tau)$ 之间的基本关系由更新方程（也称为欧拉-洛特卡方程）给出：\n$$1 = R_{0} \\int_{0}^{\\infty} \\exp(-r\\tau) g(\\tau) d\\tau$$\n该积分是 $g(\\tau)$ 的拉普拉斯变换（记作 $\\tilde{g}(s)$）在 $s=r$ 处的值。因此，该方程可以写成：\n$$1 = R_{0} \\tilde{g}(r)$$\n这使我们能够将 $R_{0}$ 表示为 $r$ 的函数：\n$$R_{0}(r) = \\frac{1}{\\tilde{g}(r)}$$\n\n**第1部分：指数代际间隔的一阶近似**\n\n首先，我们建立 $R_{0}(r)$ 在 $r=0$ 附近的一般一阶近似。这由 $R_{0}(r)$ 的泰勒展开式在一次项后截断给出：\n$$R_{0}(r) \\approx R_{0}(0) + R_{0}'(0)r$$\n我们计算各项。在 $r=0$ 时：\n$$R_{0}(0) = \\frac{1}{\\tilde{g}(0)} = \\frac{1}{\\int_{0}^{\\infty} g(\\tau) d\\tau} = \\frac{1}{1} = 1$$\n这是因为 $g(\\tau)$ 是一个概率密度函数。\n$R_{0}(r)$ 的导数是 $R_{0}'(r) = -(\\tilde{g}(r))^{-2} \\tilde{g}'(r)$。拉普拉斯变换的导数是：\n$$\\tilde{g}'(r) = \\frac{d}{dr} \\int_{0}^{\\infty} \\exp(-r\\tau) g(\\tau) d\\tau = \\int_{0}^{\\infty} (-\\tau) \\exp(-r\\tau) g(\\tau) d\\tau$$\n在 $r=0$ 时，这变为：\n$$\\tilde{g}'(0) = \\int_{0}^{\\infty} (-\\tau) g(\\tau) d\\tau = -T_{g}$$\n其中 $T_{g}$ 是平均代际间隔。\n代回后，$R_{0}(r)$ 在 $r=0$ 处的导数是：\n$$R_{0}'(0) = -(\\tilde{g}(0))^{-2} \\tilde{g}'(0) = -(1)^{-2} (-T_{g}) = T_{g}$$\n因此，一般的一阶近似是：\n$$R_{0}(r) \\approx 1 + rT_{g}$$\n对于第1部分给出的具体情况，假设代际间隔是均值为 $T_{g} = 1/\\gamma$ 的指数分布。将此代入一般近似中，得到该模型的近似值：\n$$R_{0}^{\\text{approx}} = 1 + r \\left(\\frac{1}{\\gamma}\\right) = 1 + \\frac{r}{\\gamma}$$\n我们现在对给定的值 $r=0.2$ 和 $\\gamma=0.25$ 计算此近似值：\n$$R_{0}^{\\text{approx}} = 1 + \\frac{0.2}{0.25} = 1 + \\frac{20}{25} = 1 + \\frac{4}{5} = \\frac{9}{5}$$\n\n**第2部分：伽马代际间隔的精确计算**\n\n在这一部分，代际间隔遵循形状参数为 $k=2$、均值为 $T_{g}=1/\\gamma$ 的伽马分布。伽马分布的均值是其形状参数 $k$ 和尺度参数 $\\theta$ 的乘积。因此，$T_{g} = k\\theta$，这意味着 $\\theta = T_{g}/k = (1/\\gamma)/2 = 1/(2\\gamma)$。\n形状为 $k$、尺度为 $\\theta$ 的伽马分布的拉普拉斯变换是 $\\tilde{g}(s) = (1+\\theta s)^{-k}$。对于我们的参数：\n$$\\tilde{g}(s) = \\left(1 + \\frac{1}{2\\gamma} s\\right)^{-2} = \\left(\\frac{2\\gamma+s}{2\\gamma}\\right)^{-2} = \\left(\\frac{2\\gamma}{s+2\\gamma}\\right)^2$$\n使用更新方程 $R_{0} = 1/\\tilde{g}(r)$，我们找到 $R_{0}$ 的精确表达式：\n$$R_{0}^{\\text{exact}} = \\frac{1}{\\left(\\frac{2\\gamma}{r+2\\gamma}\\right)^2} = \\left(\\frac{r+2\\gamma}{2\\gamma}\\right)^2 = \\left(1 + \\frac{r}{2\\gamma}\\right)^2$$\n我们对 $r=0.2$、$\\gamma=0.25$ 和 $k=2$ 计算此值：\n$$R_{0}^{\\text{exact}} = \\left(1 + \\frac{0.2}{2 \\times 0.25}\\right)^2 = \\left(1 + \\frac{0.2}{0.5}\\right)^2 = \\left(1 + \\frac{2}{5}\\right)^2 = \\left(\\frac{7}{5}\\right)^2 = \\frac{49}{25}$$\n\n**第3部分：有符号相对近似误差**\n\n最后，我们计算问题陈述中定义的有符号相对近似误差：\n$$\\text{Error} = \\frac{R_{0}^{\\text{approx}} - R_{0}^{\\text{exact}}}{R_{0}^{\\text{exact}}}$$\n代入我们计算出的值：\n$$R_{0}^{\\text{approx}} = \\frac{9}{5} = \\frac{45}{25}$$\n$$R_{0}^{\\text{exact}} = \\frac{49}{25}$$\n误差为：\n$$\\text{Error} = \\frac{\\frac{45}{25} - \\frac{49}{25}}{\\frac{49}{25}} = \\frac{-\\frac{4}{25}}{\\frac{49}{25}} = -\\frac{4}{49}$$\n这是作为精确分数的最终答案。", "answer": "$$\n\\boxed{-\\frac{4}{49}}\n$$", "id": "4544603"}, {"introduction": "将理论公式转化为动态仿真是建模者的核心技能。这项实践将指导你使用更新方程从头开始构建一个计算模型。通过亲手实现这个模型，你将直观地看到历史发病率、再生数和生成间隔如何相互作用，共同塑造随时间变化的流行曲线 [@problem_id:4990283]。", "problem": "实现一个程序，根据以下具有科学依据的原则，模拟传染病发病率的离散时间更新模型。该更新公式基于一个定义：第 $t$ 天的预期新增感染数源于过去的病例数，按代际间隔分布加权，并按一个恒定的再生数进行缩放。时间以天为单位。代际间隔由一个连续概率密度函数（PDF）建模，然后离散化为每日的概率质量。模型从第 $0$ 天的单个非零初始发病数开始；对于 $0$ 天之前的日子，发病数为零。数值输出是新增感染计数（无量纲），以小数值报告。\n\n您的程序必须：\n- 使用每日时间步长 $t = 0, 1, \\dots, T$。\n- 通过离散化一个连续伽马分布来表示离散的代际间隔权重 $g(\\tau)$（其中 $\\tau = 1, 2, \\dots, 14$）。该伽马分布具有指定的均值 $\\mu$（单位：天）和标准差 $\\sigma$（单位：天）。具体方法如下：根据连续伽马累积分布函数，计算 $\\tau = 1, 2, \\dots, 14$ 时每个单位长度区间 $[\\tau-1, \\tau)$ 内的概率质量，在 $\\tau = 14$ 处截断，并重新归一化，使得 $\\sum_{\\tau=1}^{14} g(\\tau) = 1$。对于给定的测试用例，此 $g(\\tau)$ 在所有天数中保持不变。\n- 使用更新推理来演化每日发病率：对于每一天 $t \\geq 1$，预期的发病率取决于前几天 $t-\\tau$ 的加权贡献（权重为 $g(\\tau)$）和一个恒定的再生数 $R$。初始条件为 $i(0) = i_0$，且对于所有 $t < 0$，有 $i(t) = 0$。\n- 对于每个测试用例，计算并返回完整的发病轨迹 $[i(0), i(1), \\dots, i(T)]$。\n\n离散化细节：\n- 伽马分布的参数由均值 $\\mu$ 和标准差 $\\sigma$ 指定。其尺度和形状应与这些矩相一致。\n- 离散化的 $g(\\tau)$ 必须按如下方式计算：首先计算连续代际间隔落在 $[\\tau-1, \\tau)$ 内的概率（对于 $\\tau = 1, 2, \\dots, 14$），然后除以这 $14$ 个概率的总和，以确保截断后它们的和为 $1$。\n\n初始条件和边界处理：\n- 使用 $i(0) = i_0$。\n- 对于 $t \\geq 1$，在对过去几天的贡献求和时，只包括 $t-\\tau \\geq 0$ 的项；这等价于第 $0$ 天之前的日子没有贡献。\n\n测试套件：\n- 案例 A（正常路径）：$i_0 = 50$, $R = 1.3$, $\\mu = 5.0$ 天, $\\sigma = 2.0$ 天, 模拟时长 $T = 30$ 天。\n- 案例 B（边界接近临界）：$i_0 = 50$, $R = 1.0$, $\\mu = 5.0$ 天, $\\sigma = 2.0$ 天, 模拟时长 $T = 30$ 天。\n- 案例 C（亚临界）：$i_0 = 50$, $R = 0.8$, $\\mu = 5.0$ 天, $\\sigma = 2.0$ 天, 模拟时长 $T = 30$ 天。\n- 案例 D（代际间隔分布离散度的敏感性）：$i_0 = 50$, $R = 1.3$, $\\mu = 5.0$ 天, $\\sigma = 3.5$ 天, 模拟时长 $T = 30$ 天。\n\n数值输出要求：\n- 对于每个测试用例，输出一个长度为 $T+1$ 的完整列表，其中包含 $t = 0, 1, \\dots, T$ 对应的 $i(t)$。\n- 将每个列表中的每个元素四舍五入到 $6$ 位小数。\n- 最终程序输出必须是单行文本，包含一个由四个列表组成的列表，顺序为 A、B、C、D，格式为用方括号括起来的逗号分隔列表，无空格（例如，\"[[...],[...],[...],[...]]\"）。\n\n不涉及角度单位。所有时间单位均为天。所有输出均为以小数值报告的计数（无百分比表示法）。", "solution": "该问题要求基于更新方程实现一个离散时间的传染病发病率模型。这是流行病学中一个科学成熟的方法，用于根据三个关键组成部分来预测发病率：再生数（$R$）、过去的发病趋势以及代际间隔分布。解决方案的结构是：首先从给定输入中推导出模型参数，然后指定用于模拟发病轨迹的迭代算法。\n\n### 1. 更新方程模型\n\n模型的核心是更新方程，该方程假设在给定时间 $t$ 的新增感染数（记作 $i(t)$）与过去被感染个体的总传染性成正比。这可以表述为：\n$$\ni(t) = R \\sum_{\\tau=1}^{\\infty} i(t-\\tau) g(\\tau)\n$$\n这里，$R$ 是有效再生数，代表单个感染者引起的平均二次感染数。项 $i(t-\\tau)$ 是 $\\tau$ 天前发生的新增感染数。函数 $g(\\tau)$ 是代际间隔的离散概率质量函数，代际间隔是指从一个个体被感染到他们感染另一个人的时间。乘积 $i(t-\\tau)g(\\tau)$ 代表在时间 $t$ 由那些在时间 $t-\\tau$ 被感染的个体引起的新增感染数。求和项将所有可能的代际间隔时长的贡献聚合起来。\n\n问题指定了一个离散时间模型，具有每日步长，初始发病率为 $i(0) = i_0$，并且对于任何时间 $t < 0$，发病率为零。代际间隔在 $14$ 天处截断。因此，对于 $t \\ge 1$ 的控制方程变为：\n$$\ni(t) = R \\sum_{\\tau=1}^{14} i(t-\\tau) g(\\tau)\n$$\n其边界条件是，任何 $t-\\tau < 0$ 的项 $i(t-\\tau)$ 均为零。\n\n### 2. 代际间隔的离散化\n\n代际间隔分布 $g(\\tau)$ 源于一个连续的伽马概率分布，这是捕捉此类生物学时间间隔形状灵活性的标准选择。伽马分布由一个形状参数 $k$ 和一个尺度参数 $\\theta$ 定义。问题提供了代际间隔的均值 $\\mu$ 和标准差 $\\sigma$，我们必须从中推导出 $k$ 和 $\\theta$。\n\n伽马分布的矩由以下公式给出：\n- 均值：$\\mu = k\\theta$\n- 方差：$\\sigma^2 = k\\theta^2$\n\n通过将方差除以均值，我们可以解出尺度参数 $\\theta$：\n$$\n\\frac{\\sigma^2}{\\mu} = \\frac{k\\theta^2}{k\\theta} \\implies \\theta = \\frac{\\sigma^2}{\\mu}\n$$\n将 $\\theta$ 代入均值方程，即可解出形状参数 $k$：\n$$\n\\mu = k \\left(\\frac{\\sigma^2}{\\mu}\\right) \\implies k = \\frac{\\mu^2}{\\sigma^2}\n$$\n一旦确定了 $k$ 和 $\\theta$，我们就可以定义连续累积分布函数（CDF）$F(x; k, \\theta)$。问题要求我们将此连续分布离散化为每日的概率质量 $g(\\tau)$，其中 $\\tau = 1, 2, \\dots, 14$。每天的未归一化权重 $w(\\tau)$ 是连续代际间隔落入该天区间 $[\\tau-1, \\tau)$ 的概率：\n$$\nw(\\tau) = P(\\tau-1 \\le X < \\tau) = F(\\tau; k, \\theta) - F(\\tau-1; k, \\theta)\n$$\n这些权重是为 $\\tau = 1, \\dots, 14$ 计算的。因为分布在 $14$ 天时被截断，这些权重的总和 $\\sum_{\\tau=1}^{14} w(\\tau)$ 将小于 $1$。为了形成一个有效的离散概率分布，我们必须对它们进行重新归一化：\n$$\ng(\\tau) = \\frac{w(\\tau)}{\\sum_{j=1}^{14} w(j)}\n$$\n这确保了 $\\sum_{\\tau=1}^{14} g(\\tau) = 1$。\n\n### 3. 模拟算法\n\n模拟从初始条件 $i(0) = i_0$ 开始迭代进行。完整的发病轨迹 $[i(0), i(1), \\dots, i(T)]$ 存储在一个数组中。\n\n算法如下：\n1.  **初始化**：\n    a. 给定一个包含参数 $i_0$、$R$、$\\mu$、$\\sigma$ 和 $T$ 的测试用例。\n    b. 计算伽马分布参数 $k = (\\mu/\\sigma)^2$ 和 $\\theta = \\sigma^2/\\mu$。\n    c. 使用上述累积分布函数的方法，计算离散且归一化的代际间隔分布 $g(\\tau)$，其中 $\\tau = 1, \\dots, 14$。\n    d. 初始化一个长度为 $T+1$ 的发病率数组 `incidence`。设置 `incidence[0]`$= i_0$。\n\n2.  **时间步进循环**：对于从 $1$ 到 $T$ 的每一天 $t$：\n    a. 计算总传染压力 $\\lambda(t)$，即过去病例贡献的总和：\n    $$\n    \\lambda(t) = \\sum_{\\tau=1}^{14} i(t-\\tau) g(\\tau-1)\n    $$\n    注意，数组索引通常是基于0的，所以 $g(\\tau)$ 对应于 `g[tau-1]`。该求和通过迭代 $\\tau$ 从 $1$ 到 $\\min(t, 14)$ 来实现，以确保索引 $t-\\tau$ 为非负数。\n    b. 计算第 $t$ 天的新增发病率：\n    $$\n    i(t) = R \\times \\lambda(t)\n    $$\n    c. 将此值存储在 `incidence[t]` 中。\n\n3.  **输出**：循环完成后，`incidence` 数组包含完整的轨迹 $[i(0), i(1), \\dots, i(T)]$。此数组中的每个值都按要求四舍五入到 $6$ 位小数。对每个测试用例重复此过程。\n\n此过程提供了一个确定性的、分步的方法，以根据更新模型的基本原理来模拟疾病轨迹。使用 `scipy.stats.gamma` 计算累积分布函数（CDF）以及使用 `numpy` 进行数组操作，使得该实现既准确又高效。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import gamma\n\ndef solve():\n    \"\"\"\n    Implements a discrete-time renewal model for infectious disease incidence.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (i_0, R, mu, sigma, T)\n        (50.0, 1.3, 5.0, 2.0, 30),  # Case A\n        (50.0, 1.0, 5.0, 2.0, 30),  # Case B\n        (50.0, 0.8, 5.0, 2.0, 30),  # Case C\n        (50.0, 1.3, 5.0, 3.5, 30),  # Case D\n    ]\n\n    all_results = []\n    for case in test_cases:\n        i0, R, mu, sigma, T = case\n        \n        # 1. Calculate Gamma distribution parameters (shape k, scale theta)\n        # Mean = k * theta, Variance = k * theta^2\n        # k = (mu / sigma)^2, theta = sigma^2 / mu\n        # scipy.stats.gamma uses 'a' for shape and 'scale' for scale.\n        if sigma == 0 or mu == 0:\n            # Handle edge case to avoid division by zero\n            # This case is not in the test suite but is good practice.\n            # A delta function would be appropriate, but we follow the formula.\n            # In this problem, mu and sigma are always positive.\n            pass\n        \n        k = (mu / sigma)**2\n        theta = sigma**2 / mu\n\n        # 2. Discretize the continuous Gamma distribution\n        # The generation interval is discretized for tau = 1, ..., 14\n        max_tau = 14\n        tau_values = np.arange(1, max_tau + 1)\n        \n        # Calculate unnormalized weights w(tau) = P(tau-1 = X  tau)\n        # which is F(tau) - F(tau-1)\n        cdf_at_tau = gamma.cdf(tau_values, a=k, scale=theta)\n        cdf_at_tau_minus_1 = gamma.cdf(tau_values - 1, a=k, scale=theta)\n        w = cdf_at_tau - cdf_at_tau_minus_1\n        \n        # Renormalize the weights so they sum to 1\n        sum_w = np.sum(w)\n        if sum_w == 0:\n            # Handle case where all probability mass is outside the [0, 14) window\n            # This shouldn't happen with the given parameters.\n            g = np.zeros(max_tau)\n        else:\n            g = w / sum_w\n\n        # 3. Evolve daily incidence using the renewal equation\n        incidence = np.zeros(T + 1)\n        incidence[0] = i0\n        \n        for t in range(1, T + 1):\n            # Calculate total infectious pressure from past cases\n            # lambda(t) = sum_{tau=1 to 14} i(t-tau) * g(tau)\n            infectious_pressure = 0.0\n            \n            # The sum is over tau from 1 up to min(t, max_tau)\n            # because for tau > t, i(t-tau) is 0.\n            for tau in range(1, min(t, max_tau) + 1):\n                infectious_pressure += incidence[t - tau] * g[tau - 1]\n            \n            incidence[t] = R * infectious_pressure\n            \n        # 4. Format the output\n        # Round every element to 6 decimal places\n        rounded_incidence = np.round(incidence, 6).tolist()\n        all_results.append(rounded_incidence)\n\n    # Final print statement in the exact required format: [[...],[...],...]\n    # Using a list comprehension to format each trajectory string\n    # and then joining them.\n    inner_lists_str = [f'[{\",\".join(map(str, traj))}]' for traj in all_results]\n    final_output_str = f'[{\",\".join(inner_lists_str)}]'\n    \n    print(final_output_str)\n\nsolve()\n\n```", "id": "4990283"}]}