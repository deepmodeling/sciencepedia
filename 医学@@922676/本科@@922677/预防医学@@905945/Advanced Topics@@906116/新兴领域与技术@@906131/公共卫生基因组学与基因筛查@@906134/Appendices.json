{"hands_on_practices": [{"introduction": "本练习将指导您完成基因组医学中的一项核心任务：在基因检测后更新个体的疾病风险。您将运用贝叶斯定理，通过先验几率和似然比的概念，来计算在多基因风险评分为阳性的情况下，个体患病的后验概率 ([@problem_id:4564872])。这项练习对于理解基因组筛查结果的临床意义至关重要。", "problem": "一个公共卫生基因组学项目正在评估一个二元多基因风险评分（Polygenic Risk Score (PRS)）阈值，用于识别在 $75$ 岁前患上某种常见复杂疾病的终生风险升高的个体。在目标人群中，$75$ 岁前患该疾病的基线终生风险为 $0.05$。在选定的阈值下，对代表目标人群的队列进行的验证性研究显示，真阳性率为 $0.40$，假阳性率为 $0.10$。从目标人群中随机选取的一名个体在此 PRS 阈值下的检测结果为阳性。\n\n仅使用条件概率、比值和似然比的定义，并假设验证指标适用于目标人群且无谱系偏倚，确定该个体在检测结果为阳性的条件下，$75$ 岁前患病的后验概率。将最终答案表示为小数，四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题要求计算在多基因风险评分（PRS）检测结果为阳性的条件下，个体患病的后验概率。这是贝叶斯推断的一个应用，解题过程将遵循使用比值和似然比定义的约束。\n\n设 $D$ 表示从目标人群中随机选取的个体在 $75$ 岁前患病的事件。其补集 $D^c$ 是该个体不患病的事件。设 $T^+$ 表示该个体检测结果为阳性的事件。\n\n题目提供了以下信息：\n1.  患病的先验概率（基线终生风险）：$P(D) = 0.05$。\n2.  真阳性率（灵敏度）：在个体将患病的条件下，检测结果为阳性的概率，$P(T^+|D) = 0.40$。\n3.  假阳性率：在个体将不会患病的条件下，检测结果为阳性的概率，$P(T^+|D^c) = 0.10$。\n\n我们的目标是计算后验概率 $P(D|T^+)$。\n\n首先，我们确定患病的先验比值。事件的比值定义为事件发生的概率与事件不发生的概率之比。不患病的先验概率为 $P(D^c) = 1 - P(D) = 1 - 0.05 = 0.95$。\n因此，先验比值为：\n$$Odds(D) = \\frac{P(D)}{P(D^c)} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}$$\n\n接下来，我们计算阳性检测结果的似然比，记为 $LR(+)$。似然比是在患病人群中出现某一检测结果的概率与在非患病人群中出现相同结果的概率之比。\n$$LR(+) = \\frac{P(T^+|D)}{P(T^+|D^c)}$$\n使用给定的真阳性率和假阳性率值：\n$$LR(+) = \\frac{0.40}{0.10} = 4$$\n对于将要患病的个体，其检测结果为阳性的可能性是不会患病个体的 $4$ 倍。\n\n先验比值、后验比值和似然比之间的关系是贝叶斯定理的一种表达形式：\n$$Posterior \\: Odds = Prior \\: Odds \\times Likelihood \\: Ratio$$\n用我们定义的事件来表示，即：\n$$Odds(D|T^+) = Odds(D) \\times LR(+)$$\n此处，$Odds(D|T^+)$ 表示在收到阳性检测结果后患病的比值。代入计算出的先验比值和似然比的值：\n$$Odds(D|T^+) = \\frac{1}{19} \\times 4 = \\frac{4}{19}$$\n\n最后，必须将后验比值转换回概率。事件 $A$ 的概率可以根据其比值 $Odds(A)$，使用公式 $P(A) = \\frac{Odds(A)}{1 + Odds(A)}$ 来计算。\n将此公式应用于后验比值：\n$$P(D|T^+) = \\frac{Odds(D|T^+)}{1 + Odds(D|T^+)} = \\frac{\\frac{4}{19}}{1 + \\frac{4}{19}}$$\n为了简化这个繁分数：\n$$P(D|T^+) = \\frac{\\frac{4}{19}}{\\frac{19}{19} + \\frac{4}{19}} = \\frac{\\frac{4}{19}}{\\frac{23}{19}} = \\frac{4}{23}$$\n\n问题要求将最终答案表示为小数，并四舍五入到四位有效数字。我们进行除法运算：\n$$P(D|T^+) = \\frac{4}{23} \\approx 0.17391304...$$\n四舍五入到四位有效数字得到最终值。", "answer": "$$\\boxed{0.1739}$$", "id": "4564872"}, {"introduction": "在个体风险评估的基础上，本练习将视角扩展到群体层面，旨在评估一个新生儿筛查项目。您将利用哈迪-温伯格平衡定律来确定基因型频率，并结合筛查试验的性能指标来计算其阳性预测值（PPV）([@problem_id:4564890])。这项实践揭示了群体遗传学特征和检测性能如何共同决定一个筛查项目在现实世界中的有效性。", "problem": "一个公共卫生项目评估一项用于筛查某种常染色体隐性遗传代谢病的新生儿检测方法。该疾病由一个双等位基因座上的致病等位基因 $a$ 引起，该基因座的等位基因为 $A$ 和 $a$。该种群数量庞大，进行随机交配，且没有选择、突变或迁移。在这些条件下，假设满足哈代-温伯格平衡。种群中等位基因 $A$ 的频率为 $p$，因此等位基因 $a$ 的频率为 $q=1-p$。根据随机交配条件下孟德尔遗传的基本原理，推导出基因型 $AA$、$Aa$ 和 $aa$ 的频率（用 $p$ 和 $q$ 表示）。\n\n对于基因型为 $aa$ 的真正患病新生儿，该筛查检测得出阳性结果的概率为 $s$；对于基因型为 $Aa$ 的携带者，得出阳性结果的概率为 $r$（由于偶尔出现的临界酶活性）；对于基因型为 $AA$ 的非携带者，得出阳性结果的概率为 $f$（假阳性）。该项目将此检测应用于整个新生儿群体。使用推导出的基因型频率，构建阳性预测值的表达式。阳性预测值定义为一个随机选择的阳性筛查结果确实是患病的概率，即阳性预测值 (PPV) 等于 $\\mathbb{P}(aa \\mid \\text{positive})$。\n\n计算当 $p=0.972$，$s=0.95$，$r=0.02$ 且 $f=0.001$ 时该 PPV 的值。将最终数值答案以小数形式表示，并四舍五入到四位有效数字。", "solution": "基本基础是哈代-温伯格平衡，它源于随机交配、大种群以及不存在选择、突变和迁移等进化力量的核心假设。在孟德尔遗传下，对于一个基因座上的两个等位基因 $A$ 和 $a$，配子中等位基因的频率等于种群中的等位基因频率。一个合子具有给定基因型的概率，是从两个亲本的配子库中抽取相应等位基因的概率的乘积。\n\n设等位基因 $A$ 的频率为 $p$，等位基因 $a$ 的频率为 $q$，且 $q=1-p$。那么：\n- 新生儿基因型为 $AA$ 的概率是从两个配子中都抽到 $A$ 的概率，即 $p \\times p = p^{2}$。\n- 新生儿基因型为 $Aa$ (或 $aA$) 的概率是以任意顺序抽到一个 $A$ 和一个 $a$ 的概率，即 $p \\times q + q \\times p = 2pq$。\n- 新生儿基因型为 $aa$ 的概率是从两个配子中都抽到 $a$ 的概率，即 $q \\times q = q^{2}$。\n\n因此，在哈代-温伯格平衡下，基因型 $AA$ 的频率为 $p^{2}$，$Aa$ 的频率为 $2pq$，$aa$ 的频率为 $q^{2}$。\n\n我们被要求计算阳性预测值 (PPV)，定义为条件概率 $\\mathbb{P}(aa \\mid \\text{positive})$。根据贝叶斯法则和关于基因型的全概率定律，\n$$\n\\mathbb{P}(aa \\mid \\text{positive}) \\;=\\; \\frac{\\mathbb{P}(\\text{positive} \\mid aa)\\,\\mathbb{P}(aa)}{\\mathbb{P}(\\text{positive})}\n\\;=\\; \\frac{s \\cdot q^{2}}{s \\cdot q^{2} + r \\cdot (2pq) + f \\cdot p^{2}}.\n$$\n该表达式使用了在给定基因型 $aa$ 时检测呈阳性的概率为 $s$，给定 $Aa$ 时为 $r$，给定 $AA$ 时为 $f$ 的事实，并通过基因型频率进行加权。\n\n现在我们用给定的参数值 $p=0.972$，$s=0.95$，$r=0.02$ 和 $f=0.001$ 来计算这个表达式的值。首先计算 $q$：\n$$\nq \\;=\\; 1 - p \\;=\\; 1 - 0.972 \\;=\\; 0.028.\n$$\n接着计算哈代-温伯格基因型频率：\n$$\np^{2} \\;=\\; (0.972)^{2} \\;=\\; 0.944784, \\quad\n2pq \\;=\\; 2 \\cdot 0.972 \\cdot 0.028 \\;=\\; 0.054432, \\quad\nq^{2} \\;=\\; (0.028)^{2} \\;=\\; 0.000784.\n$$\n计算对总体阳性概率的各项贡献：\n- 患病者 ($aa$): $s \\cdot q^{2} \\;=\\; 0.95 \\cdot 0.000784 \\;=\\; 0.0007448$.\n- 携带者 ($Aa$): $r \\cdot 2pq \\;=\\; 0.02 \\cdot 0.054432 \\;=\\; 0.00108864$.\n- 非携带者 ($AA$): $f \\cdot p^{2} \\;=\\; 0.001 \\cdot 0.944784 \\;=\\; 0.000944784$.\n\n求和以得到 $\\mathbb{P}(\\text{positive})$：\n$$\n\\mathbb{P}(\\text{positive}) \\;=\\; 0.0007448 + 0.00108864 + 0.000944784 \\;=\\; 0.002778224.\n$$\n因此，PPV 为\n$$\n\\text{PPV} \\;=\\; \\frac{0.0007448}{0.002778224} \\;\\approx\\; 0.2680849.\n$$\n四舍五入到四位有效数字并以小数表示，PPV 为 $0.2681$。", "answer": "$$\\boxed{0.2681}$$", "id": "4564890"}, {"introduction": "最后的这项实践将深入探讨一种名为“级联筛查”的靶向筛查策略的设计与评估。您将建立一个数学模型，来预测通过检测已知病例（即先证者）的亲属所能发现的新携带者的期望数量 ([@problem_id:4564863])。此练习展示了如何运用概率推理和孟德尔遗传学原理来规划和优化公共卫生基因组学干预措施。", "problem": "一个公共卫生基因组学项目对常染色体显性遗传病实施级联筛查，以在先证者（proband）的亲属中识别出更多的携带者。假设先证者在一个常染色体显性基因中携带一个杂合致病性变异。设先证者的变异为新发（de novo）的（即不是从任何一方父母遗传的）概率为 $d$，其中 $0 \\leq d \\leq 1$。级联筛查仅提供给一级亲属，并使用一种变异特异性基因检测，其分析灵敏度为 $s$，其中 $0 \\leq s \\leq 1$。\n\n定义家庭结构和接受度如下：\n- $N_{\\mathrm{par}}$: 有资格接受检测的在世父母人数。\n- $N_{\\mathrm{sib}}$: 有资格接受检测的在世同胞兄妹人数。\n- $N_{\\mathrm{child}}$: 有资格接受检测的在世亲生子女人数。\n- $u_{\\mathrm{par}}$: 任何一位指定父母被联系、同意并完成检测的净概率。\n- $u_{\\mathrm{sib}}$: 任何一位指定同胞兄妹被联系、同意并完成检测的净概率。\n- $u_{\\mathrm{child}}$: 任何一位指定子女被联系、同意并完成检测的净概率。\n\n假设：\n- 遵循常染色体显性杂合变异的孟德尔遗传规律，杂合携带者的每个子女有 $\\frac{1}{2}$ 的概率遗传该变异。\n- 如果先证者的变异是新发的（概率为 $d$），那么其父母均不携带该变异，且同胞兄妹的风险可忽略不计（视为 $0$）。如果先证者的变异是遗传的（概率为 $1-d$），那么其父母中恰好有一位携带该变异，且每个同胞兄妹有 $\\frac{1}{2}$ 的概率携带该变异。\n- 对于父母，在变异是遗传的情况下，每个父母个体有 $\\frac{1}{2}$ 的概率是传递该变异的亲本。\n- 亲属间的检测接受度和检测性能是相互独立的，并且接受度和检测灵敏度与携带者状态无关。\n\n仅使用这些假设和概率法则，推导出一个单一的闭式解析表达式，用于表示当向父母、同胞兄妹和子女提供级联筛查时，每位先证者新识别出的携带者期望数 $Y$。将 $Y$ 用 $N_{\\mathrm{par}}$、$N_{\\mathrm{sib}}$、$N_{\\mathrm{child}}$、$u_{\\mathrm{par}}$、$u_{\\mathrm{sib}}$、$u_{\\mathrm{child}}$、$s$ 和 $d$ 表示。无需进行数值计算或四舍五入。最终答案必须是一个无单位的单一解析表达式。", "solution": "问题要求推导一个闭式表达式，用于表示由级联筛查项目产生的新识别携带者期望数，记为 $Y$。识别出的携带者总期望数是来自每一组一级亲属（父母、同胞兄妹和子女）的期望数之和。根据期望的线性性质，我们可以写出：\n$$Y = E[\\text{total carriers}] = E[\\text{carriers from parents}] + E[\\text{carriers from siblings}] + E[\\text{carriers from children}]$$\n我们将分别计算每一组亲属的期望数。设 $Y_{\\mathrm{par}}$、$Y_{\\mathrm{sib}}$ 和 $Y_{\\mathrm{child}}$ 分别代表在各组中识别出的携带者数量的随机变量。我们的目标是求得 $Y = E[Y_{\\mathrm{par}}] + E[Y_{\\mathrm{sib}}] + E[Y_{\\mathrm{child}}]$。\n\n让我们首先确定在先证者子女中识别出的携带者期望数 $E[Y_{\\mathrm{child}}]$。先证者是已知的杂合携带者。根据常染色体显性遗传病的孟德尔遗传规律，先证者的每个亲生子女有 $\\frac{1}{2}$ 的概率遗传该致病性变异。识别出一个携带者子女需要三个独立事件同时发生：该子女必须是携带者，该子女必须接受检测，并且检测必须得出阳性结果。\n特定子女是携带者的概率是 $P(\\text{carrier}) = \\frac{1}{2}$。\n特定子女接受检测的概率由接受度概率 $u_{\\mathrm{child}}$ 给出。\n对于携带者，检测结果为阳性的概率是分析灵敏度 $s$。\n因此，将任何一个子女识别为携带者的概率是这些概率的乘积：\n$$P(\\text{child identified}) = P(\\text{carrier}) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{child}} \\cdot s$$\n共有 $N_{\\mathrm{child}}$ 个子女。由于识别每个子女是独立事件，子女中识别出的携带者总期望数是单个期望值之和。对于每个子女 $i$，设 $I_i$ 为该子女被识别的指示变量。$E[I_i] = P(\\text{child identified})$。\n$$E[Y_{\\mathrm{child}}] = \\sum_{i=1}^{N_{\\mathrm{child}}} E[I_i] = \\sum_{i=1}^{N_{\\mathrm{child}}} \\left(\\frac{1}{2} u_{\\mathrm{child}} s\\right) = N_{\\mathrm{child}} \\frac{1}{2} u_{\\mathrm{child}} s$$\n这个期望值与是否为新发变异无关，因为计算的起点是先证者的携带者状态。\n\n接下来，我们计算在父母中识别出的携带者期望数 $E[Y_{\\mathrm{par}}]$ 和在同胞兄妹中识别出的携带者期望数 $E[Y_{\\mathrm{sib}}]$。这些亲属的携带者状态取决于先证者的变异是遗传的还是新发的。我们使用全期望定律，以变异的来源为条件。设 $I$ 为变异是遗传的事件， $D$ 为变异是新发的事件。已知 $P(D) = d$ 和 $P(I) = 1-d$。\n\n对于父母，识别出的携带者期望数为：\n$$E[Y_{\\mathrm{par}}] = E[Y_{\\mathrm{par}} | I] P(I) + E[Y_{\\mathrm{par}} | D] P(D)$$\n如果变异是新发的（事件 $D$），则父母双方都不携带该变异。因此，在他们当中识别出的携带者数量为零：$E[Y_{\\mathrm{par}} | D] = 0$。\n如果变异是遗传的（事件 $I$），则恰好有一位父母是携带者。对于先证者的任何一位指定父母，其作为携带者亲本的概率是 $\\frac{1}{2}$。在变异是遗传的条件下，将特定父母识别为携带者的概率是：\n$$P(\\text{parent identified} | I) = P(\\text{parent is carrier} | I) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{par}} \\cdot s$$\n在遗传的情况下，在 $N_{\\mathrm{par}}$ 个父母中识别出的携带者总期望数是单个期望值之和：\n$$E[Y_{\\mathrm{par}} | I] = \\sum_{j=1}^{N_{\\mathrm{par}}} P(\\text{parent } j \\text{ identified} | I) = N_{\\mathrm{par}} \\frac{1}{2} u_{\\mathrm{par}} s$$\n代入父母的全期望定律公式中：\n$$E[Y_{\\mathrm{par}}] = \\left(N_{\\mathrm{par}} \\frac{1}{2} u_{\\mathrm{par}} s\\right)(1-d) + (0)(d) = \\frac{1}{2} N_{\\mathrm{par}} u_{\\mathrm{par}} s (1-d)$$\n\n对于同胞兄妹，我们遵循同样的逻辑：\n$$E[Y_{\\mathrm{sib}}] = E[Y_{\\mathrm{sib}} | I] P(I) + E[Y_{\\mathrm{sib}} | D] P(D)$$\n如果变异是新发的（事件 $D$），同胞兄妹不携带该变异，所以 $E[Y_{\\mathrm{sib}} | D] = 0$。\n如果变异是遗传的（事件 $I$），先证者是从一个携带者亲本那里遗传的。先证者的每个同胞兄妹都有相同的父母，因此有 $\\frac{1}{2}$ 的机会从那个携带者亲本那里遗传该变异。在先证者的变异是遗传的条件下，将特定同胞兄妹识别为携带者的概率是：\n$$P(\\text{sibling identified} | I) = P(\\text{sibling is carrier} | I) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{sib}} \\cdot s$$\n在遗传的情况下，在 $N_{\\mathrm{sib}}$ 个同胞兄妹中识别出的携带者总期望数是：\n$$E[Y_{\\mathrm{sib}} | I] = \\sum_{k=1}^{N_{\\mathrm{sib}}} P(\\text{sibling } k \\text{ identified} | I) = N_{\\mathrm{sib}} \\frac{1}{2} u_{\\mathrm{sib}} s$$\n代入同胞兄妹的全期望定律公式中：\n$$E[Y_{\\mathrm{sib}}] = \\left(N_{\\mathrm{sib}} \\frac{1}{2} u_{\\mathrm{sib}} s\\right)(1-d) + (0)(d) = \\frac{1}{2} N_{\\mathrm{sib}} u_{\\mathrm{sib}} s (1-d)$$\n\n最后，我们将所有三组亲属的期望值相加，以求得新识别出的携带者总期望数 $Y$：\n$$Y = E[Y_{\\mathrm{par}}] + E[Y_{\\mathrm{sib}}] + E[Y_{\\mathrm{child}}]$$\n$$Y = \\frac{1}{2} N_{\\mathrm{par}} u_{\\mathrm{par}} s (1-d) + \\frac{1}{2} N_{\\mathrm{sib}} u_{\\mathrm{sib}} s (1-d) + \\frac{1}{2} N_{\\mathrm{child}} u_{\\mathrm{child}} s$$\n为了将其表示为单个闭式表达式，我们可以提取公因式：\n$$Y = \\frac{1}{2}s \\left[ N_{\\mathrm{par}} u_{\\mathrm{par}} (1-d) + N_{\\mathrm{sib}} u_{\\mathrm{sib}} (1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]$$\n$$Y = \\frac{s}{2} \\left[ (N_{\\mathrm{par}} u_{\\mathrm{par}} + N_{\\mathrm{sib}} u_{\\mathrm{sib}})(1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]$$\n这个表达式代表了级联筛查项目对每位先证者的预期诊断产出。", "answer": "$$\\boxed{\\frac{s}{2} \\left[ (N_{\\mathrm{par}} u_{\\mathrm{par}} + N_{\\mathrm{sib}} u_{\\mathrm{sib}})(1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]}$$", "id": "4564863"}]}