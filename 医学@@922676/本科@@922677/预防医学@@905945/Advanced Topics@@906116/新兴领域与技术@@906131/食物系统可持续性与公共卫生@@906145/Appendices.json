{"hands_on_practices": [{"introduction": "我们的第一个练习聚焦于预防医学中的一项基本技能：定量风险评估。我们将通过应用公共卫生机构使用的标准模型，计算因暴露于常见食品污染物黄曲霉毒素而产生的终生癌症风险。这项实践 [@problem_id:4526583] 将巩固你对如何整合暴露、剂量和毒性数据以保护公众健康的理解。", "problem": "黄曲霉毒素是由特定曲霉菌属(Aspergillus)产生的具有肝致癌性的霉菌毒素，它们在许多地区污染主食。在预防医学和公共卫生风险评估中，慢性暴露和终生癌症风险是根据测得的食品污染、消费模式、体重以及一个既定的致癌效力因子来估算的。考虑一个监测数据集，该数据集针对一个主食为玉米粉、花生和高粱粉的成年人。测得这些食品中黄曲霉毒素B1的平均浓度为：玉米粉 $1.0\\ \\mathrm{\\mu g/kg}$，花生 $5.0\\ \\mathrm{\\mu g/kg}$，高粱粉 $2.0\\ \\mathrm{\\mu g/kg}$。该个体的平均每日消费率为：玉米粉 $0.20\\ \\mathrm{kg/day}$，花生 $0.020\\ \\mathrm{kg/day}$，高粱粉 $0.10\\ \\mathrm{kg/day}$。该个体的体重为 $70\\ \\mathrm{kg}$。假设在 $70$ 年的生命周期中，这种水平的暴露持续 $30$ 年。黄曲霉毒素B1的致癌效力因子（解释为单位终生平均日剂量的超额终生风险的斜率因子）为每 $\\mathrm{ng/kg\\text{-}day}$ $0.01$。使用单位换算 $1\\ \\mathrm{\\mu g} = 1000\\ \\mathrm{ng}$。\n\n从暴露的基本定义（单位时间内每单位体重摄入的污染物质量）和终生平均日剂量（LADD，即在参考生命周期内时间平均的日剂量）出发，使用所提供的效力因子，计算由此次黄曲霉毒素暴露引起的肝细胞癌（HCC）的终生超额风险。将最终风险表示为不带百分号的小数概率，并将您的最终答案四舍五入到四位有效数字。如果您引入了中间量（例如慢性日摄入量或LADD），请以 $\\mathrm{ng/kg\\text{-}day}$ 为单位表示。", "solution": "目标是根据所提供的暴露数据和效力因子，计算肝细胞癌的终生超额风险。此计算遵循定量癌症风险评估的标准方法。\n\n首先，我们根据给定信息定义变量：\n-   玉米粉中黄曲霉毒素的浓度， $C_m = 1.0\\ \\mathrm{\\mu g/kg}$\n-   花生中黄曲霉毒素的浓度， $C_g = 5.0\\ \\mathrm{\\mu g/kg}$\n-   高粱粉中黄曲霉毒素的浓度， $C_s = 2.0\\ \\mathrm{\\mu g/kg}$\n-   玉米粉的每日消费率， $I_m = 0.20\\ \\mathrm{kg/day}$\n-   花生的每日消费率， $I_g = 0.020\\ \\mathrm{kg/day}$\n-   高粱粉的每日消费率， $I_s = 0.10\\ \\mathrm{kg/day}$\n-   个体体重， $BW = 70\\ \\mathrm{kg}$\n-   暴露持续时间， $E_D = 30\\ \\text{years}$\n-   平均时间（生命周期）， $A_T = 70\\ \\text{years}$\n-   致癌效力因子， $CPF = 0.01\\ (\\mathrm{ng/kg\\text{-}day})^{-1}$\n-   单位转换因子， $U = 1000\\ \\mathrm{ng/\\mu g}$\n\n主要步骤是计算污染物的每日总摄入量，确定终生平均日剂量，然后使用效力因子估算风险。\n\n步骤1：计算黄曲霉毒素的每日总质量摄入量。\n来自单一食物来源 $i$ 的质量摄入量是其浓度 $C_i$ 和消耗率 $I_i$ 的乘积。每日总质量摄入量 $M_{total}$ 是来自所有食物来源的摄入量之和。\n$$ M_{total} = (C_m \\times I_m) + (C_g \\times I_g) + (C_s \\times I_s) $$\n代入给定值：\n$$ M_{total} = (1.0\\ \\mathrm{\\mu g/kg} \\times 0.20\\ \\mathrm{kg/day}) + (5.0\\ \\mathrm{\\mu g/kg} \\times 0.020\\ \\mathrm{kg/day}) + (2.0\\ \\mathrm{\\mu g/kg} \\times 0.10\\ \\mathrm{kg/day}) $$\n$$ M_{total} = (0.20 + 0.10 + 0.20)\\ \\mathrm{\\mu g/day} $$\n$$ M_{total} = 0.50\\ \\mathrm{\\mu g/day} $$\n\n步骤2：将每日总质量摄入量转换为纳克/天。\n效力因子是以涉及纳克（$ng$）的单位给出的，因此我们必须使用提供的转换因子 $U$ 将 $M_{total}$ 转换为这些单位。\n$$ M_{total, ng} = M_{total} \\times U $$\n$$ M_{total, ng} = 0.50\\ \\mathrm{\\mu g/day} \\times 1000\\ \\mathrm{ng/\\mu g} = 500\\ \\mathrm{ng/day} $$\n\n步骤3：计算慢性日摄入量（CDI）。\nCDI是按体重标准化的每日污染物摄入量。它代表在暴露期间每单位体重接受的剂量。\n$$ CDI = \\frac{M_{total, ng}}{BW} $$\n$$ CDI = \\frac{500\\ \\mathrm{ng/day}}{70\\ \\mathrm{kg}} = \\frac{50}{7}\\ \\mathrm{ng/kg\\text{-}day} $$\n作为一个中间值，这大约是 $7.14286\\ \\mathrm{ng/kg\\text{-}day}$。最好在后续计算中保留精确分数以避免舍入误差。\n\n步骤4：计算终生平均日剂量（LADD）。\nLADD将剂量在整个生命周期内进行平均。它是通过将CDI乘以暴露持续时间与平均时间（生命周期）的比率来计算的。这个因子 $\\frac{E_D}{A_T}$ 说明了暴露期相对于评估风险的总时期的比例。\n$$ LADD = CDI \\times \\frac{E_D}{A_T} $$\n$$ LADD = \\left(\\frac{50}{7}\\ \\mathrm{ng/kg\\text{-}day}\\right) \\times \\left(\\frac{30\\ \\text{years}}{70\\ \\text{years}}\\right) $$\n$$ LADD = \\frac{50}{7} \\times \\frac{3}{7}\\ \\mathrm{ng/kg\\text{-}day} $$\n$$ LADD = \\frac{150}{49}\\ \\mathrm{ng/kg\\text{-}day} $$\n作为一个中间值，这大约是 $3.06122\\ \\mathrm{ng/kg\\text{-}day}$。\n\n步骤5：计算终生超额癌症风险。\n终生超额癌症风险使用线性低剂量模型进行估算，其中风险是LADD与致癌效力因子（$CPF$）的乘积。\n$$ \\text{Risk} = LADD \\times CPF $$\n$LADD$ 的单位是 $\\mathrm{ng/kg\\text{-}day}$，$CPF$ 的单位是 $(\\mathrm{ng/kg\\text{-}day})^{-1}$，得出风险为一个无量纲的概率。\n$$ \\text{Risk} = \\left(\\frac{150}{49}\\ \\mathrm{ng/kg\\text{-}day}\\right) \\times \\left(0.01\\ (\\mathrm{ng/kg\\text{-}day})^{-1}\\right) $$\n$$ \\text{Risk} = \\frac{150}{49} \\times 0.01 = \\frac{1.5}{49} $$\n现在，我们进行最后的除法运算：\n$$ \\text{Risk} \\approx 0.03061224489... $$\n\n步骤6：对最终答案进行四舍五入。\n题目要求将最终答案四舍五入到四位有效数字。\n计算出的风险是 $0.03061224489...$。第一个有效数字是 $3$。数四位有效数字得到 $0.03061$。第五位有效数字是 $2$，所以我们向下舍入。\n$$ \\text{Risk} \\approx 0.03061 $$\n该值表示由于特定的膳食黄曲霉毒素暴露，个体在一生中患上肝细胞癌的估计超额概率。", "answer": "$$\n\\boxed{0.03061}\n$$", "id": "4526583"}, {"introduction": "公共卫生干预措施很少是简单的；它们常常涉及平衡相互竞争的风险。下一个问题探讨了一个经典的风险-风险权衡情景，其中改变烹饪方法以减少微生物病原体，可能会无意中增加对化学致癌物丙烯酰胺的暴露。通过分析这种权衡 [@problem_id:4526595]，你将学会使用定量模型，在一个问题的解决方案可能引发另一个问题时，做出更明智的决策。", "problem": "一个公共卫生团队正在更新一种土豆蔬菜饼的家庭烹饪指南。其目标是在降低急性微生物风险的同时，避免不可接受的慢性化学风险。正在考虑两种烤箱烹饪方案：\n\n- 方案L（较低温度）：烤箱设置为$180\\,^{\\circ}\\mathrm{C}$，加热$12\\,\\mathrm{min}$；饼的中心温度达到$65\\,^{\\circ}\\mathrm{C}$并保持$1\\,\\mathrm{min}$。\n- 方案H（较高温度）：烤箱设置为$200\\,^{\\circ}\\mathrm{C}$，加热$15\\,\\mathrm{min}$；饼的中心温度达到$68\\,^{\\circ}\\mathrm{C}$并保持$0.5\\,\\mathrm{min}$。\n\n假设以下经过充分测试的关系和参数：\n\n- 热灭活（沙门氏菌替代物）遵循一级动力学，其十分之一存活时间 $D(T)$ 由 $D(T) = D_{60}\\times 10^{-(T-60)/z}$ 给出，其中 $D_{60} = 2\\,\\mathrm{min}$，$z = 6\\,^{\\circ}\\mathrm{C}$。在温度 $T$ 下保持时间 $t$ 的$\\log_{10}$减少量为 $R = t/D(T)$。\n- 污染率为 $p = 0.01$；在受污染的份量中，初始平均载菌量为每份 $N_0 = 10^3\\,\\mathrm{CFU}$。\n- 在低剂量下，沙门氏菌的剂量-反应关系可由指数模型 $P_{\\mathrm{ill}|\\mathrm{dose}} \\approx r \\times d$ 近似，其中当摄入剂量 $d$ 很小时，$r = 0.0041\\,\\mathrm{CFU}^{-1}$；使用预期存活剂量作为剂量。\n- 饼表面的丙烯酰胺形成量与时间大致成比例，并具有温度系数 $Q_{10} = 2.5$；在这些短的烹饪时间内，当从 $(T_1,t_1)$ 变为 $(T_2,t_2)$ 时，每份形成的质量按 $\\text{mass} \\propto Q_{10}^{(T_2 - T_1)/10}\\times (t_2/t_1)$ 的比例变化。\n- 根据方案L进行的产品测试测得每份丙烯酰胺含量为 $5\\,\\mu\\mathrm{g}$。\n- 消费者：成人体重 $70\\,\\mathrm{kg}$；食用频率为每周$1$份。\n- 对于丙烯酰胺，使用针对肿瘤终点的$10\\%$反应的基准剂量可信下限 (BMDL10) $= 0.17\\,\\mathrm{mg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$；暴露边际 (MOE) 为 $\\mathrm{MOE} = \\mathrm{BMDL10}/\\text{慢性暴露量}$，对于遗传毒性致癌物，MOE $\\ge 10{,}000$ 通常被解释为低关注度。\n\n任务：仅使用上述原理和参数，确定从方案L转为方案H是否 (i) 实质性地降低了每份预期的沙门氏菌致病风险，以及 (ii) 是否增加了丙烯酰胺暴露量，导致MOE降至 $10{,}000$ 以下。选择以下最佳陈述。\n\nA. 改为方案H使沙门氏菌致病风险降低约一个数量级，并使丙烯酰胺MOE保持在 $10{,}000$ 以上（约 $16{,}000$），因此该更改在两方面都是可接受的。\n\nB. 与方案L相比，改为方案H使沙门氏菌致病风险降低了大约两个数量级，但将丙烯酰胺MOE从约 $16{,}700$ 降低到约 $2{,}100$，低于 $10{,}000$；因此，相对于基准，这引入了丙烯酰胺的担忧。\n\nC. 与方案L相比，改为方案H产生的额外沙门氏菌杀灭效果可以忽略不计，并且仅轻微降低了丙烯酰胺MOE，该值仍高于 $10{,}000$。\n\nD. 改为方案H增加了沙门氏菌风险（由于过度烹饪造成的损害）并增加了丙烯酰胺MOE；因此，在两方面都更差。", "solution": "从微生物风险开始。热灭活使用十分之一存活时间模型 $D(T) = D_{60}\\times 10^{-(T-60)/z}$，其中 $D_{60} = 2\\,\\mathrm{min}$，$z = 6\\,^{\\circ}\\mathrm{C}$。\n\n1) 计算 $D(65\\,^{\\circ}\\mathrm{C})$ 和 $D(68\\,^{\\circ}\\mathrm{C})$：\n- $D(65) = 2 \\times 10^{-(65-60)/6} = 2 \\times 10^{-5/6} \\approx 2 \\times 10^{-0.8333} \\approx 2 \\times 0.146 \\approx 0.292\\,\\mathrm{min}$。\n- $D(68) = 2 \\times 10^{-(68-60)/6} = 2 \\times 10^{-8/6} = 2 \\times 10^{-1.3333} \\approx 2 \\times 0.0468 \\approx 0.0936\\,\\mathrm{min}$。\n\n2) 在核心保持温度下的对数减少量 $R$：\n- 方案L：$R_L = t/D(65) = 1/0.292 \\approx 3.42\\,\\log_{10}$。\n- 方案H：$R_H = t/D(68) = 0.5/0.0936 \\approx 5.34\\,\\log_{10}$。\n\n3) 每份受污染份量中的预期存活菌数（初始为 $N_0 = 10^3\\,\\mathrm{CFU}$）：\n- $N_{L} = N_0 \\times 10^{-R_L} = 10^3 \\times 10^{-3.42} = 10^{3-3.42} = 10^{-0.42} \\approx 0.38\\,\\mathrm{CFU}$。\n- $N_{H} = 10^3 \\times 10^{-5.34} = 10^{-2.34} \\approx 0.00457\\,\\mathrm{CFU}$。\n\n4) 使用低剂量指数近似 $P_{\\mathrm{ill}|\\mathrm{contam}} \\approx r \\times d$ 计算每份受污染份量的致病概率，其中 $r = 0.0041\\,\\mathrm{CFU}^{-1}$：\n- $P_{L|\\mathrm{contam}} \\approx 0.0041 \\times 0.38 \\approx 0.001558$。\n- $P_{H|\\mathrm{contam}} \\approx 0.0041 \\times 0.00457 \\approx 0.0000187$。\n\n5) 考虑污染率 $p = 0.01$ 后的每份总致病概率：\n- $P_{L} = p \\times P_{L|\\mathrm{contam}} \\approx 0.01 \\times 0.001558 \\approx 1.558\\times 10^{-5}$。\n- $P_{H} = 0.01 \\times 0.0000187 \\approx 1.87\\times 10^{-7}$。\n\n6) 从方案L到H的风险降低因子：\n- 降低因子 $\\approx P_{L}/P_{H} \\approx (1.558\\times 10^{-5})/(1.87\\times 10^{-7}) \\approx 83$，即大约两个数量级。\n\n接下来，评估丙烯酰胺暴露量和暴露边际 (MOE)。根据方案L，测试发现每份含有 $5\\,\\mu\\mathrm{g}$。使用 $Q_{10} = 2.5$ 和与时间的比例关系来估计方案H中的质量：\n\n7) 方案H下每份的丙烯酰胺质量：\n- 温度从 $180\\,^{\\circ}\\mathrm{C}$ 变为 $200\\,^{\\circ}\\mathrm{C}$，$\\Delta T = 20\\,^{\\circ}\\mathrm{C}$；因子为 $Q_{10}^{\\Delta T/10} = 2.5^{2} = 6.25$。\n- 时间比为 $(t_2/t_1) = 15/12 = 1.25$。\n- $A_{H} = A_{L} \\times 6.25 \\times 1.25 = 5\\,\\mu\\mathrm{g} \\times 7.8125 \\approx 39.06\\,\\mu\\mathrm{g}$。\n\n8) 将其转换为一个体重 $70\\,\\mathrm{kg}$ 的成人每周食用$1$份（即每天 $1/7$ 份）的慢性每日暴露量。首先以 $\\mu\\mathrm{g}/\\text{天}$ 计算每日摄入量，然后表示为每公斤每日摄入量，再转换为 $\\mathrm{mg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$：\n\n- 方案L：\n  - 每人每日摄入量：$5\\,\\mu\\mathrm{g} \\times (1/7) \\approx 0.7143\\,\\mu\\mathrm{g/day}$。\n  - 每公斤摄入量：$0.7143/70 \\approx 0.0102\\,\\mu\\mathrm{g}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$。\n  - 以 $\\mathrm{mg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$ 为单位：$1.02\\times 10^{-5}\\,\\mathrm{mg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$。\n\n- 方案H：\n  - 每人每日摄入量：$39.06\\,\\mu\\mathrm{g} \\times (1/7) \\approx 5.58\\,\\mu\\mathrm{g/day}$。\n  - 每公斤摄入量：$5.58/70 \\approx 0.0797\\,\\mu\\mathrm{g}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$。\n  - 以 $\\mathrm{mg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$ 为单位：$7.97\\times 10^{-5}\\,\\mathrm{mg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$。\n\n9) 使用 $\\mathrm{BMDL10} = 0.17\\,\\mathrm{mg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{day}^{-1}$ 和 $\\mathrm{MOE} = \\mathrm{BMDL10}/\\text{暴露量}$ 计算 MOE 值：\n\n- 方案L：$\\mathrm{MOE}_L = 0.17 / (1.02\\times 10^{-5}) \\approx 1.6667\\times 10^{4} \\approx 16{,}700$。\n- 方案H：$\\mathrm{MOE}_H = 0.17 / (7.97\\times 10^{-5}) \\approx 2.13\\times 10^{3} \\approx 2{,}100$。\n\n结果解读：与方案L相比，方案H使每份预期的沙门氏菌致病风险降低了约80倍。然而，丙烯酰胺的MOE从约 $16{,}700$（高于 $10{,}000$ 的基准）降至约 $2{,}100$（低于 $10{,}000$ 的基准），这表明较高温度的方案使丙烯酰胺暴露量超过了通常用于遗传毒性致癌物的可接受暴露边际阈值。\n\n逐项分析选项：\n\n- 选项A：声称微生物风险仅降低约一个数量级，且方案H下的MOE仍高于 $10{,}000$（约 $16{,}000$）。微生物风险降低接近两个数量级，且 $\\mathrm{MOE}_H \\approx 2{,}100$，低于 $10{,}000$。不正确。\n\n- 选项B：指出沙门氏菌风险降低约两个数量级，MOE从约 $16{,}700$ 降至约 $2{,}100$，低于 $10{,}000$。这与计算结果相符。正确。\n\n- 选项C：断言杀灭效果的改善可以忽略不计，且MOE仍高于 $10{,}000$。杀灭效果的改善是显著的（约80倍），且 $\\mathrm{MOE}_H$ 远低于 $10{,}000$。不正确。\n\n- 选项D：声称在较高温度下沙门氏菌风险增加，MOE也增加。这两个方向都与计算结果相悖。不正确。", "answer": "$$\\boxed{B}$$", "id": "4526595"}, {"introduction": "除了评估风险，公共卫生的一个关键目标是为更健康、更可持续的人群设计前瞻性的解决方案。这最后一个练习使用线性优化这一强大的数学工具来构建一个“最优”饮食。你将设计一个既能满足所有营养需求，又能最小化其碳足迹的每日膳食计划 [@problem_id:4526640]，从而展示定量方法如何指导创建既健康又环境可持续的饮食模式。", "problem": "您将获得一个包含八种食物的小型食物系统，以及它们每 $100\\,\\mathrm{g}$ 的营养密度和温室气体排放量。温室气体排放量以 $\\mathrm{kg}\\,\\mathrm{CO_2e}$ 表示，其中二氧化碳当量 (CO2e) 将不同温室气体的气候影响汇总为单一指标。目标是计算满足四种营养素的每日推荐摄入量 (RDA) 并最小化每日总温室气体排放量的每日食物数量。将此问题表述并求解为一个线性优化问题，并得出在满足约束条件的同时实现最低排放量的每种食物的数量（单位为 $\\mathrm{g/day}$）。\n\n使用以下有序食物列表（索引顺序对输出很重要）：\n- $0$: 燕麦（压片）\n- $1$: 鹰嘴豆（熟）\n- $2$: 菠菜（生）\n- $3$: 牛奶（全脂）\n- $4$: 强化早餐麦片\n- $5$: 鸡蛋\n- $6$: 豆腐（老豆腐，钙凝固）\n- $7$: 沙丁鱼（水浸罐头）\n\n每 $100\\,\\mathrm{g}$ 的营养密度：\n- 纤维（单位 $\\mathrm{g}$）：燕麦 $10$，鹰嘴豆 $7.6$，菠菜 $2.2$，牛奶 $0$，麦片 $10$，鸡蛋 $0$，豆腐 $0.9$，沙丁鱼 $0$。\n- 钙（单位 $\\mathrm{mg}$）：燕麦 $54$，鹰嘴豆 $49$，菠菜 $99$，牛奶 $120$，麦片 $25$，鸡蛋 $50$，豆腐 $350$，沙丁鱼 $382$。\n- 铁（单位 $\\mathrm{mg}$）：燕麦 $4.3$，鹰嘴豆 $2.9$，菠菜 $2.7$，牛奶 $0.0$，麦片 $15.0$，鸡蛋 $1.8$，豆腐 $5.4$，沙丁鱼 $2.9$。\n- 维生素B12（单位 $\\mu\\mathrm{g}$）：燕麦 $0.0$，鹰嘴豆 $0.0$，菠菜 $0.0$，牛奶 $0.5$，麦片 $3.0$，鸡蛋 $1.1$，豆腐 $0.0$，沙丁鱼 $8.9$。\n\n每 $100\\,\\mathrm{g}$ 的温室气体排放量（单位 $\\mathrm{kg}\\,\\mathrm{CO_2e}$）：\n- 燕麦 $0.10$，鹰嘴豆 $0.09$，菠菜 $0.02$，牛奶 $0.12$，麦片 $0.08$，鸡蛋 $0.42$，豆腐 $0.20$，沙丁鱼 $0.15$。\n\n为保持饮食的现实性，每种食物的每日摄入量上限（单位 $\\mathrm{g/day}$）：\n- 燕麦 $500$，鹰嘴豆 $500$，菠菜 $300$，牛奶 $1000$，麦片 $400$，鸡蛋 $200$，豆腐 $300$，沙丁鱼 $200$。\n\n设决策变量为 $x_i$，表示食物 $i$ 的每日克数，其中 $i \\in \\{0,1,2,3,4,5,6,7\\}$。目标是最小化每日总排放量：\n$$\n\\min \\sum_{i=0}^{7} \\left(\\frac{\\mathrm{CO_2e}_i}{100}\\right) x_i\n$$\n约束条件为满足或超过纤维、钙、铁和维生素B12的RDA。营养贡献与质量成线性关系：\n$$\n\\sum_{i=0}^{7} \\left(\\frac{N_{i}}{100}\\right) x_i \\ge RDA_N\n$$\n对于每种营养素 $N \\in \\{\\text{纤维}, \\text{钙}, \\text{铁}, \\text{维生素B12}\\}$，且有界 $0 \\le x_i \\le UB_i$。\n\n使用以下三个测试用例（情景），每个用例定义了允许的食物和所需的RDA。被排除的食物必须通过将其上限设置为 $0$ 来使其 $x_i = 0$。\n\n- 测试用例 $1$ （杂食者，允许所有食物）：\n  - RDA：纤维 $30\\,\\mathrm{g/day}$，钙 $1000\\,\\mathrm{mg/day}$，铁 $10\\,\\mathrm{mg/day}$，维生素B12 $2.4\\,\\mu\\mathrm{g/day}$。\n  - 允许的食物：$\\{0,1,2,3,4,5,6,7\\}$。\n\n- 测试用例 $2$ （素食者，排除沙丁鱼）：\n  - RDA：纤维 $25\\,\\mathrm{g/day}$，钙 $1000\\,\\mathrm{mg/day}$，铁 $18\\,\\mathrm{mg/day}$，维生素B12 $2.4\\,\\mu\\mathrm{g/day}$。\n  - 允许的食物：$\\{0,1,2,3,4,5,6\\}$。\n\n- 测试用例 $3$ （纯素食者，排除牛奶、鸡蛋、沙丁鱼）：\n  - RDA：纤维 $30\\,\\mathrm{g/day}$，钙 $1000\\,\\mathrm{mg/day}$，铁 $18\\,\\mathrm{mg/day}$，维生素B12 $2.4\\,\\mu\\mathrm{g/day}$。\n  - 允许的食物：$\\{0,1,2,4,6\\}$。\n\n您的程序必须：\n- 为每个测试用例构建并求解线性规划问题，以找到最小化总 $\\mathrm{kg}\\,\\mathrm{CO_2e/day}$ 排放量同时满足所有营养约束和边界条件的 $x_i$（单位 $\\mathrm{g/day}$）。\n- 按照固定的索引顺序 $\\left[0,1,2,3,4,5,6,7\\right]$ 报告每日食物数量，对于被排除的食物用 $0$ 填充。\n- 将每个数量以 $\\mathrm{g/day}$ 为单位表示为浮点数，并四舍五入到一位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由三个列表组成的列表，每个测试用例对应一个列表。每个内部列表给出食物 $0$ 到 $7$ 的数量（单位 $\\mathrm{g/day}$），四舍五入到一位小数，例如 $[[q_{0}^{(1)},\\dots,q_{7}^{(1)}],[q_{0}^{(2)},\\dots,q_{7}^{(2)}],[q_{0}^{(3)},\\dots,q_{7}^{(3)}]]$。\n\n仅以指定的单行格式作答。", "solution": "该问题要求确定最佳的每日食物数量，以满足营养需求，同时最小化温室气体排放。这是一个经典的优化问题，可以严谨地表述并作为线性规划 (LP) 问题来求解。\n\n### 1. 数学公式\n\n问题在于找到8种不同食物的数量，以最小化一个线性目标函数（总排放量），同时满足一组线性约束（营养需求和消耗限制）。\n\n**决策变量**\n设决策变量向量为 $x = [x_0, x_1, x_2, x_3, x_4, x_5, x_6, x_7]^T$，其中 $x_i$ 表示食物 $i$ 的每日克数（$\\mathrm{g/day}$）。索引 $i$ 对应给定的食物列表，从 $i=0$（燕麦）到 $i=7$（沙丁鱼）。\n\n**目标函数**\n目标是最小化每日总温室气体排放量 $Z$，单位为 $\\mathrm{kg}\\,\\mathrm{CO_2e/day}$。排放量是按每 $100\\,\\mathrm{g}$ 食物给出的。目标函数是每克排放量与每种食物数量的线性组合：\n$$\n\\min Z = \\sum_{i=0}^{7} c_i x_i\n$$\n其中 $c_i$ 是食物 $i$ 每克的排放量。系数向量 $c$ 从每 $100\\,\\mathrm{g}$ 的数据中导出，为：\n$$\nc = \\left[ \\frac{0.10}{100}, \\frac{0.09}{100}, \\frac{0.02}{100}, \\frac{0.12}{100}, \\frac{0.08}{100}, \\frac{0.42}{100}, \\frac{0.20}{100}, \\frac{0.15}{100} \\right]^T\n$$\n$$\nc = [0.0010, 0.0009, 0.0002, 0.0012, 0.0008, 0.0042, 0.0020, 0.0015]^T\n$$\n\n**约束条件**\n饮食必须满足营养摄入和食物数量的约束。\n\n1.  **营养约束**：4种营养素中每一种的总摄入量必须达到或超过其每日推荐摄入量 (RDA)。这构成了一个包含4个线性不等式的系统。对于每种营养素 $j \\in \\{\\text{纤维, 钙, 铁, 维生素B12}\\}$，约束条件为：\n    $$\n    \\sum_{i=0}^{7} A_{ji} x_i \\ge b_j\n    $$\n    其中 $A_{ji}$ 是每克食物 $i$ 中营养素 $j$ 的含量，而 $b_j$ 是营养素 $j$ 的RDA。矩阵 $A$ 是通过将给定的每 $100\\,\\mathrm{g}$ 营养密度除以 $100$ 构建的。\n    \n    营养矩阵 $A$（其中营养素 $j$ 为行，食物 $i$ 为列）是：\n    $$\n    A = \\frac{1}{100} \\begin{pmatrix}\n    10.0   7.6   2.2   0.0   10.0   0.0   0.9   0.0 \\\\\n    54.0   49.0   99.0   120.0   25.0   50.0   350.0   382.0 \\\\\n    4.3   2.9   2.7   0.0   15.0   1.8   5.4   2.9 \\\\\n    0.0   0.0   0.0   0.5   3.0   1.1   0.0   8.9\n    \\end{pmatrix}\n    $$\n    向量 $b = [b_0, b_1, b_2, b_3]^T$ 分别包含纤维、钙、铁和维生素B12的RDA，并且在每个测试用例中都不同。\n\n2.  **变量边界**：每种食物的数量必须是非负的，并且受一个实际的上限 $UB_i$ 限制。\n    $$\n    0 \\le x_i \\le UB_i \\quad \\text{for } i \\in \\{0, 1, \\dots, 7\\}\n    $$\n    通用上限向量为 $UB = [500, 500, 300, 1000, 400, 200, 300, 200]^T$。对于在特定测试用例中被排除的食物，其上限被设为 $0$。\n\n### 2. 求解线性规划\n\n该问题使用数值优化方法求解。标准的LP求解器，例如 `scipy.optimize` 库中提供的那些，要求问题以规范形式陈述。我们使用以下形式：\n$$\n\\min c^T x \\quad \\text{subject to} \\quad A_{ub} x \\le b_{ub} \\quad \\text{and} \\quad l \\le x \\le u\n$$\n营养约束 $\\sum_{i=0}^{7} A_{ji} x_i \\ge b_j$ 通过乘以 $-1$ 转换为所需的 $\\le$ 形式：\n$$\n\\sum_{i=0}^{7} (-A_{ji}) x_i \\le -b_j\n$$\n因此，对于求解器，我们设置 $A_{ub} = -A$ 和 $b_{ub} = -b$。边界以 $l_i = 0$ 和 $u_i = UB_i$ 的形式提供。\n\n每个测试用例的具体参数如下：\n\n**测试用例 1 (杂食者)**\n-   RDA向量：$b^{(1)} = [30, 1000, 10, 2.4]^T$。\n-   上限：$UB^{(1)} = [500, 500, 300, 1000, 400, 200, 300, 200]^T$。\n\n**测试用例 2 (素食者)**\n-   RDA向量：$b^{(2)} = [25, 1000, 18, 2.4]^T$。\n-   上限：排除沙丁鱼（食物7）。$UB^{(2)} = [500, 500, 300, 1000, 400, 200, 300, 0]^T$。\n\n**测试用例 3 (纯素食者)**\n-   RDA向量：$b^{(3)} = [30, 1000, 18, 2.4]^T$。\n-   上限：排除牛奶（食物3）、鸡蛋（食物5）和沙丁鱼（食物7）。$UB^{(3)} = [500, 500, 300, 0, 400, 0, 300, 0]^T$。\n\n对于每种情况，使用 `scipy.optimize.linprog` 构建并求解相应的LP。得到的最优向量 $x$ 提供了每种食物的克数。然后按照规定将这些数量四舍五入到一位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Formulates and solves a series of linear programming problems\n    to find an optimal diet that minimizes GHG emissions while meeting\n    nutritional requirements.\n    \"\"\"\n    \n    # ------------------\n    # Data Definition\n    # ------------------\n    \n    # Objective function coefficients (emissions in kg CO2e per gram of food)\n    emissions_per_100g = np.array([0.10, 0.09, 0.02, 0.12, 0.08, 0.42, 0.20, 0.15])\n    c = emissions_per_100g / 100.0\n\n    # Nutrient matrix (nutrients per 100g). Rows: nutrients, Columns: foods.\n    # Nutrients are ordered: Fiber (g), Calcium (mg), Iron (mg), Vitamin B12 (μg)\n    nutrient_densities_per_100g = np.array([\n        [10.0, 7.6, 2.2, 0.0, 10.0, 0.0, 0.9, 0.0],      # Fiber\n        [54.0, 49.0, 99.0, 120.0, 25.0, 50.0, 350.0, 382.0], # Calcium\n        [4.3, 2.9, 2.7, 0.0, 15.0, 1.8, 5.4, 2.9],      # Iron\n        [0.0, 0.0, 0.0, 0.5, 3.0, 1.1, 0.0, 8.9]       # B12\n    ])\n    \n    # The constraint matrix A_ub for linprog A_ub @ x = b_ub\n    # The nutritional constraint is (Nutrient_Matrix / 100) @ x >= RDA\n    # which is equivalent to -(Nutrient_Matrix / 100) @ x = -RDA\n    A_ub = -(nutrient_densities_per_100g / 100.0)\n\n    # Base upper bounds for food quantities (g/day)\n    upper_bounds_base = np.array([500, 500, 300, 1000, 400, 200, 300, 200])\n\n    # Test cases definition\n    test_cases = [\n        {\n            # Test Case 1 (omnivore)\n            \"rda\": np.array([30, 1000, 10, 2.4]),\n            \"excluded_foods\": []\n        },\n        {\n            # Test Case 2 (vegetarian)\n            \"rda\": np.array([25, 1000, 18, 2.4]),\n            \"excluded_foods\": [7]  # Exclude sardines\n        },\n        {\n            # Test Case 3 (vegan)\n            \"rda\": np.array([30, 1000, 18, 2.4]),\n            \"excluded_foods\": [3, 5, 7]  # Exclude milk, eggs, sardines\n        }\n    ]\n\n    # ------------------\n    # Solving and Formatting\n    # ------------------\n    \n    all_results = []\n    \n    for case in test_cases:\n        # Set up the LP parameters for the current test case\n        \n        # b_ub vector for linprog\n        b_ub = -case[\"rda\"]\n        \n        # Set bounds for variables, setting upper bound to 0 for excluded foods\n        current_upper_bounds = upper_bounds_base.copy()\n        if case[\"excluded_foods\"]:\n            current_upper_bounds[case[\"excluded_foods\"]] = 0\n            \n        bounds = list(zip(np.zeros_like(current_upper_bounds), current_upper_bounds))\n        \n        # Solve the linear program\n        # The 'highs' method is the default and recommended solver in recent SciPy versions.\n        res = linprog(c=c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method='highs')\n        \n        if res.success:\n            # Clean up small negative values that may arise from floating-point errors\n            solution_quantities = np.maximum(0, res.x)\n            # Round the result to one decimal place\n            rounded_quantities = np.round(solution_quantities, 1).tolist()\n            all_results.append(rounded_quantities)\n        else:\n            # This case is not expected based on problem validation\n            # Append a list of zeros as a fallback\n            all_results.append([0.0] * len(c))\n            \n    # Format the final output string as a list of lists, with no spaces\n    output_str = str(all_results).replace(\" \", \"\")\n    \n    print(output_str)\n\nsolve()\n```", "id": "4526640"}]}