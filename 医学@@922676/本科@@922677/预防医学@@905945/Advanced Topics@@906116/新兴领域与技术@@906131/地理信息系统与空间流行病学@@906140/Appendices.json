{"hands_on_practices": [{"introduction": "在公共卫生规划中，我们经常需要为诊所或疫苗接种点等资源寻找“最佳”位置。简单地使用一个区域的地理中心（几何中心点）可能会产生误导，尤其是在人口分布不均的情况下。人口加权中心点提供了一种更公平的中心位置度量，它代表了人口的“重心”，是进行资源优化配置的关键。这项练习 [@problem_id:4528020] 将引导你计算并比较这两种类型的中心点，让你亲身体会“中心”的不同定义会如何影响公共卫生决策。", "problem": "一个公共卫生团队正在规划一个移动疫苗接种点，需要评估将其设置在一个不规则行政区域的几何质心与人口加权质心，对于可及性计算是否存在显著差异。在地理信息系统（GIS）中，计算是在一个投影坐标系中进行的，该坐标系在小区域内能保持距离不变。假设该区域已经被投影到一个以千米为单位的局部等距平面坐标系中，因此该坐标系中的直线欧几里得距离对应于实际地面距离。\n\n该区域由四个普查区组成。对于每个普查区，提供了其人口数量和质心坐标 $(x_i,y_i)$（单位：千米）：\n- 普查区 $A$：人口 $3000$，质心 $(500.2, 401.7)$。\n- 普查区 $B$：人口 $4500$，质心 $(503.8, 399.2)$。\n- 普查区 $C$：人口 $2000$，质心 $(498.9, 403.1)$。\n- 普查区 $D$：人口 $5500$，质心 $(506.1, 397.9)$。\n\n该行政区域多边形的几何质心（在同一投影下根据边界几何图形计算得出）为 $(502.10, 401.00)$。\n\n从适用于投影平面GIS环境的空间流行病学和欧几里得几何的核心定义出发：\n- 人口加权质心是使得到各普查区质心的加权（按人口）平方距离之和最小的点。\n- 平面坐标系中两点之间的直线距离由欧几里得范数给出。\n\n根据普查区数据计算该区域的人口加权质心，然后计算人口加权质心与几何质心之间的直线欧几里得距离。将您的最终距离四舍五入到四位有效数字。以千米（km）为单位表示您的答案。", "solution": "所述问题是有效的。它在科学上基于欧几里得几何和空间统计学的原理，特别是在地理信息系统（GIS）和空间流行病学中的应用。该问题是适定的，为得到唯一且有意义的解提供了所有必要的数据和定义。问题陈述是客观的，没有歧义或矛盾。\n\n第一步是计算人口加权质心的坐标，我们将其记为 $C_W = (x_W, y_W)$。问题将此点定义为使得到各普查区质心的加权（按人口）欧几里得平方距离之和最小的点。假设有 $n$ 个普查区，第 $i$ 个普查区的人口为 $p_i$，质心坐标为 $(x_i, y_i)$。需要最小化的函数是：\n$$S(x, y) = \\sum_{i=1}^{n} p_i \\left[ (x - x_i)^2 + (y - y_i)^2 \\right]$$\n为了找到最小化 $S$ 的坐标 $(x_W, y_W)$，我们必须找到 $S$ 的梯度为零的点。我们求 $S$ 关于 $x$ 和 $y$ 的偏导数，并令它们等于零：\n$$\\frac{\\partial S}{\\partial x} = \\sum_{i=1}^{n} p_i \\cdot 2(x - x_i) = 2 \\left( x \\sum_{i=1}^{n} p_i - \\sum_{i=1}^{n} p_i x_i \\right) = 0$$\n$$\\frac{\\partial S}{\\partial y} = \\sum_{i=1}^{n} p_i \\cdot 2(y - y_i) = 2 \\left( y \\sum_{i=1}^{n} p_i - \\sum_{i=1}^{n} p_i y_i \\right) = 0$$\n对 $x$ 和 $y$ 求解，得出人口加权质心的坐标：\n$$x_W = \\frac{\\sum_{i=1}^{n} p_i x_i}{\\sum_{i=1}^{n} p_i}$$\n$$y_W = \\frac{\\sum_{i=1}^{n} p_i y_i}{\\sum_{i=1}^{n} p_i}$$\n这些是质点系质心的公式。\n\n问题提供了4个普查区的数据：\n- 普查区 A: $p_A = 3000$, $(x_A, y_A) = (500.2, 401.7)$\n- 普查区 B: $p_B = 4500$, $(x_B, y_B) = (503.8, 399.2)$\n- 普查区 C: $p_C = 2000$, $(x_C, y_C) = (498.9, 403.1)$\n- 普查区 D: $p_D = 5500$, $(x_D, y_D) = (506.1, 397.9)$\n\n首先，我们计算总人口 $P_{total}$：\n$$P_{total} = \\sum_{i=1}^{4} p_i = p_A + p_B + p_C + p_D = 3000 + 4500 + 2000 + 5500 = 15000$$\n\n接下来，我们计算加权x坐标的总和：\n$$\\sum p_i x_i = (3000)(500.2) + (4500)(503.8) + (2000)(498.9) + (5500)(506.1)$$\n$$\\sum p_i x_i = 1500600 + 2267100 + 997800 + 2783550 = 7549050$$\n\n然后，我们计算加权y坐标的总和：\n$$\\sum p_i y_i = (3000)(401.7) + (4500)(399.2) + (2000)(403.1) + (5500)(397.9)$$\n$$\\sum p_i y_i = 1205100 + 1796400 + 806200 + 2188450 = 5996150$$\n\n现在我们可以计算人口加权质心 $C_W = (x_W, y_W)$ 的坐标：\n$$x_W = \\frac{7549050}{15000} = 503.27$$\n$$y_W = \\frac{5996150}{15000} = 399.74333...$$\n因此，人口加权质心为 $C_W = (503.27, 399.74\\overline{3})$。\n\n问题提供的几何质心为 $C_G = (502.10, 401.00)$。\n\n最后一步是计算人口加权质心 $C_W$ 和几何质心 $C_G$ 之间的直线欧几里得距离 $d$。两点 $(x_1, y_1)$ 和 $(x_2, y_2)$ 之间的距离公式为：\n$$d = \\sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}$$\n我们将此公式应用于 $C_W$ 和 $C_G$：\n$$d = \\sqrt{(x_W - x_G)^2 + (y_W - y_G)^2}$$\n坐标差为：\n$$\\Delta x = x_W - x_G = 503.27 - 502.10 = 1.17$$\n$$\\Delta y = y_W - y_G = 399.74333... - 401.00 = -1.25666...$$\n为保持精度，我们可以将 $\\Delta y$ 表示为分数：$\\Delta y = \\frac{5996150}{15000} - 401 = \\frac{599615}{1500} - \\frac{601500}{1500} = \\frac{-1885}{1500} = -\\frac{377}{300}$。\n\n现在我们计算距离 $d$：\n$$d = \\sqrt{(1.17)^2 + \\left(-\\frac{377}{300}\\right)^2}$$\n$$d = \\sqrt{1.3689 + (1.25666...)^2}$$\n$$d = \\sqrt{1.3689 + 1.5792111...}$$\n$$d = \\sqrt{2.9481111...}$$\n$$d \\approx 1.717006439 \\text{ km}$$\n\n问题要求最终答案四舍五入到四位有效数字。结果的前四位有效数字是 $1$、$7$、$1$ 和 $7$。第五位有效数字是 $0$，所以我们向下舍入（即截断）。\n$$d \\approx 1.717 \\text{ km}$$\n人口加权质心与几何质心之间的距离约为 $1.717$ 千米。", "answer": "$$\n\\boxed{1.717}\n$$", "id": "4528020"}, {"introduction": "为了评估环境危害对健康的影响，我们必须准确量化暴露水平，而这通常取决于与污染源的距离。在城市环境中，直线距离（欧几里得距离）往往不能很好地代表沿着路网的实际出行距离，因为路网会受到障碍物和单行道等限制。这项练习 [@problem_id:4527981] 要求你通过编程来模拟一个城市路网，并比较基于欧几里得距离和网络距离的暴露估算值，从而量化使用这种更简单但可能不准确的测量方法所带来的潜在偏差。", "problem": "在预防医学和空间流行病学中，地理信息系统（GIS）被用于量化基于邻近度的潜在危害（如工业排放源）暴露程度。一个关键的建模决策是，应采用直线欧几里得距离还是沿城市道路网络的最短路径网络距离来衡量居住邻近度。本问题要求您对这两种度量方法进行操作化定义，并量化在城市环境中使用欧几里得距离近似网络距离时所引入的偏差。\n\n从以下基本依据和经过充分检验的事实出发：平面中两点 $(x_1,y_1)$ 和 $(x_2,y_2)$ 之间的欧几里得距离定义为 $d_{\\text{euc}}=\\sqrt{(x_2-x_1)^2+(y_2-y_1)^2}$。加权图上的最短路径网络距离是连接两个节点的任何路径中边权重的最小总和。对点源的暴露程度随距离增加而衰减，可用指数距离衰减函数 $E(d)=E_0\\,\\exp(-\\lambda d)$ 进行建模，其中 $E_0$ 是源附近浓度，$\\lambda$ 是衰减率。这些是暴露评估中使用的标准定义和建模假设。\n\n考虑一个由方形网格图 $G=(V,E)$ 表示的合成城市道路网络，其中 $|V|=16$ 个节点排列在一个 $4 \\times 4$ 的格网中。节点由 $n=i+4j$ 索引，其中 $i\\in\\{0,1,2,3\\}$ 且 $j\\in\\{0,1,2,3\\}$，其平面坐标为 $(x,y)=(0.5\\,i,\\,0.5\\,j)$，单位为 $\\mathrm{km}$。水平和垂直边连接相邻节点，边权重为 $0.5\\,\\mathrm{km}$，但存在以下旨在模拟障碍物和单行道的城市约束：\n1. 一个障碍物移除了在 $j\\in\\{1,2\\}$ 时，$(i=1,j)$ 和 $(i=2,j)$ 之间的水平边；在 $j=0$ 和 $j=3$ 处的水平边保持不变，代表网络顶部和底部行的桥梁。\n2. 从 $(i=0,j=2)$到 $(i=0,j=3)$ 的垂直边上存在一个单向路段，只允许从 $(0,2)$ 到 $(0,3)$ 的通行，反之则不行。\n\n有两个工业场地，分别位于节点 $n=4$（坐标 $(0,0.5)\\,\\mathrm{km}$）和 $n=11$（坐标 $(1.5,1.0)\\,\\mathrm{km}$）。假设暴露模型为 $E(d)=E_0\\,\\exp(-\\lambda d)$，其中 $E_0=100\\,\\mathrm{\\mu g/m^3}$ 且 $\\lambda=1.0\\,\\mathrm{km^{-1}}$。距离必须以 $\\mathrm{km}$ 计算，暴露量以 $\\mathrm{\\mu g/m^3}$ 计算。最终的偏差度量必须表示为无量纲小数（不带百分号）。\n\n对每个居民，定义 $d_{\\text{net}}$ 为到最近工业场地的最短路径网络距离（在两个场地中取最小值），$d_{\\text{euc}}$ 为到最近工业场地的欧几里得距离（在两个场地中取最小值）。计算基于网络的暴露量 $E_{\\text{net}}=E_0\\,\\exp(-\\lambda\\,d_{\\text{net}})$ 和欧几里得近似暴露量 $E_{\\text{euc}}=E_0\\,\\exp(-\\lambda\\,d_{\\text{euc}})$，然后计算欧几里得近似的相对偏差，\n$$\nb=\\frac{E_{\\text{euc}}-E_{\\text{net}}}{E_{\\text{net}}}\n$$\n根据定义，$b$ 是无量纲的，应以小数形式报告。\n\n测试套件规范：\n- 使用位于节点 $n=5$、$n=6$、$n=11$、$n=9$ 和 $n=12$ 的居民。\n- 对于 $d_{\\text{net}}$，距离必须在给定的有向加权图上以 $\\mathrm{km}$ 计算；对于 $d_{\\text{euc}}$，距离必须在平面上使用节点坐标以 $\\mathrm{km}$ 计算。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[b_1,b_2,b_3,b_4,b_5]$），列表中的条目是按上述顺序排列的五个居民的相对偏差 $b$。输出必须是数值小数（浮点数）。", "solution": "用户提供了一个详细的问题陈述。我已经验证了该问题，并确认其为一个有效且定义明确的问题。现在我将提供一个完整的解决方案。\n\n该问题要求对空间流行病学中两种常用的邻近度度量方法——直线欧几里得距离和最短路径网络距离——进行定量比较。目标是计算在一个暴露评估场景中，使用较简单的欧几里得距离来近似更现实的网络距离时所引入的相对偏差。此分析在一个合成但受约束的城市道路网络上进行。\n\n解决方案分四个阶段进行：\n1.  将城市道路网络构建为有向加权图。\n2.  计算从每个居民位置到最近工业场地的欧几里得距离。\n3.  使用 Dijkstra 算法计算从每个居民位置到最近工业场地的最短路径网络距离。\n4.  使用提供的暴露模型为每个居民计算相对偏差。\n\n### 1. 城市网络的图表示\n\n城市环境被建模为一个图 $G=(V, E)$，其中 $V$ 是代表交叉口或关键位置的顶点（节点）集合，而 $E$ 是代表路段的边集合。\n\n**节点 ($V$)**：该网络由 $|V|=16$ 个节点组成，排列在一个 $4 \\times 4$ 的格网中。节点由 $n=i+4j$ 索引，其中 $i \\in \\{0, 1, 2, 3\\}$ 是列索引，$j \\in \\{0, 1, 2, 3\\}$ 是行索引。每个节点 $n$ 的平面坐标由 $(x,y)=(0.5 \\cdot i, 0.5 \\cdot j)$ 给出，单位为 $\\mathrm{km}$。\n\n**边 ($E$)**：最初，该图是一个无权、无向的网格图，其中每个节点都与其水平和垂直相邻节点相连。任意两个相邻节点之间的物理距离为 $0.5\\,\\mathrm{km}$，我们将其指定为每条边的权重。我们可以使用一个 $16 \\times 16$ 的邻接矩阵 $A$ 来表示图的连通性和权重，其中 $A_{uv}$ 是从节点 $u$到节点 $v$的边的权重。对于非相邻节点，此权重为无穷大。\n\n**城市约束**：这个理想化的网格经过修改以反映真实的城市特征。这些修改使图变为有向图。\n1.  **障碍物**：通过移除边来模拟物理障碍物，如河流或高速公路。问题指定移除列 $i=1$ 和 $i=2$ 之间，行 $j \\in \\{1, 2\\}$ 的水平边。\n    *   对于 $j=1$：移除节点 $n=1+4(1)=5$ 和节点 $n=2+4(1)=6$ 之间的边。这意味着权重 $A_{5,6}$ 和 $A_{6,5}$ 被设为 $\\infty$。\n    *   对于 $j=2$：移除节点 $n=1+4(2)=9$ 和节点 $n=2+4(2)=10$ 之间的边。权重 $A_{9,10}$ 和 $A_{10,9}$ 被设为 $\\infty$。\n2.  **单行道**：允许从节点 $n=0+4(2)=8$ 到节点 $n=0+4(3)=12$ 的通行，但反向不允许。这通过将反向边 $A_{12,8}$ 的权重设为 $\\infty$ 来实现，同时保持 $A_{8,12}=0.5\\,\\mathrm{km}$。\n\n应用这些约束后，该图成为一个有向加权图，这是对城市道路网络更现实的表示。\n\n### 2. 欧几里得距离计算 ($d_{\\text{euc}}$)\n\n两点 $(x_1, y_1)$ 和 $(x_2, y_2)$ 之间的欧几里得距离由标准公式 $d_{\\text{euc}}=\\sqrt{(x_2-x_1)^2+(y_2-y_1)^2}$ 给出。\n\n两个工业排放源位于节点 $n_1=4$ 和节点 $n_2=11$。\n*   源 1 (在 $n=4$)：$i=0, j=1$。坐标为 $(0, 0.5)\\,\\mathrm{km}$。\n*   源 2 (在 $n=11$)：$i=3, j=2$。坐标为 $(1.5, 1.0)\\,\\mathrm{km}$。\n\n对于位于节点 $n_r$ 坐标为 $(x_r, y_r)$ 的每个居民，我们计算其到两个源的欧几里得距离：\n$$d_{\\text{euc},1} = \\sqrt{(x_r - 0)^2 + (y_r - 0.5)^2}$$\n$$d_{\\text{euc},2} = \\sqrt{(x_r - 1.5)^2 + (y_r - 1.0)^2}$$\n\n问题将 $d_{\\text{euc}}$ 定义为到*最近*工业场地的距离。因此，对每个居民：\n$$d_{\\text{euc}} = \\min(d_{\\text{euc},1}, d_{\\text{euc},2})$$\n\n### 3. 网络距离计算 ($d_{\\text{net}}$)\n\n网络距离是沿所构建图的边的最短路径。由于该图具有非负边权重且为有向图，我们使用 Dijkstra 算法来计算所有节点对之间的最短路径距离。这将产生一个完整的距离矩阵 $D$，其中 $D_{uv}$ 是从节点 $u$ 到节点 $v$ 的最短路径长度。\n\n与欧几里得情况类似，对于位于节点 $n_r$ 的居民，我们使用预先计算的最短路径矩阵找到其到两个源的网络距离：\n$$d_{\\text{net},1} = D_{n_r, 4}$$\n$$d_{\\text{net},2} = D_{n_r, 11}$$\n\n到最近场地的网络距离则为：\n$$d_{\\text{net}} = \\min(d_{\\text{net},1}, d_{\\text{net},2})$$\n\n位于工业场地（例如节点 $n=11$）的居民，其到该场地的距离在两种度量下均为 $0$。\n\n### 4. 暴露与偏差计算\n\n暴露模型是一个指数衰减函数：$E(d)=E_0 \\exp(-\\lambda d)$。问题给出了参数 $E_0=100\\,\\mathrm{\\mu g/m^3}$ 和 $\\lambda=1.0\\,\\mathrm{km^{-1}}$。\n\n基于网络的暴露量（$E_{\\text{net}}$）和欧几里得近似暴露量（$E_{\\text{euc}}$）使用各自的距离计算得出：\n$$E_{\\text{net}} = E_0 \\exp(-\\lambda d_{\\text{net}})$$\n$$E_{\\text{euc}} = E_0 \\exp(-\\lambda d_{\\text{euc}})$$\n\n欧几里得近似的相对偏差 $b$ 定义为：\n$$b = \\frac{E_{\\text{euc}} - E_{\\text{net}}}{E_{\\text{net}}}$$\n代入暴露公式并简化，我们得到一个更直接的偏差计算方法：\n$$b = \\frac{E_0 \\exp(-\\lambda d_{\\text{euc}}) - E_0 \\exp(-\\lambda d_{\\text{net}})}{E_0 \\exp(-\\lambda d_{\\text{net}})} = \\frac{\\exp(-\\lambda d_{\\text{euc}})}{\\exp(-\\lambda d_{\\text{net}})} - 1 = \\exp(-\\lambda(d_{\\text{euc}} - d_{\\text{net}})) - 1$$\n给定 $\\lambda=1.0\\,\\mathrm{km^{-1}}$，公式进一步简化为：\n$$b = \\exp(d_{\\text{net}} - d_{\\text{euc}}) - 1$$\n\n将此公式应用于五个指定的居民位置（$n \\in \\{5, 6, 11, 9, 12\\}$）中的每一个，以获得最终结果。例如，对于位于节点 $n=6$ 的居民，手动计算表明 $d_{\\text{euc}} = \\sqrt{0.5}\\,\\mathrm{km}$ 且 $d_{\\text{net}} = 1.0\\,\\mathrm{km}$。偏差为 $b = \\exp(1.0 - \\sqrt{0.5}) - 1 \\approx 0.3403$。正偏差表示欧几里得近似高估了真实的基于网络的暴露量，这种情况在 $d_{\\text{euc}}  d_{\\text{net}}$ 时发生。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse.csgraph import dijkstra\n\ndef solve():\n    \"\"\"\n    Solves the spatial epidemiology bias problem by:\n    1. Constructing a graph model of the urban network.\n    2. Calculating Euclidean and network distances to the nearest hazard source.\n    3. Computing the relative bias of the Euclidean approximation.\n    \"\"\"\n    \n    # Define problem parameters\n    NUM_NODES = 16\n    GRID_SIZE = 4\n    EDGE_WEIGHT = 0.5  # in km\n    LAMBDA = 1.0       # decay rate in km^-1\n    \n    # Test cases: resident locations by node index\n    resident_nodes = [5, 6, 11, 9, 12]\n    \n    # Industrial site locations by node index\n    source_nodes = np.array([4, 11])\n\n    # 1. Construct the graph representation of the urban network\n    \n    # Generate coordinates for all 16 nodes\n    # n = i + 4*j, (x, y) = (0.5*i, 0.5*j)\n    coords = np.zeros((NUM_NODES, 2))\n    for n in range(NUM_NODES):\n        i = n % GRID_SIZE\n        j = n // GRID_SIZE\n        coords[n] = [0.5 * i, 0.5 * j]\n\n    # Create adjacency matrix for a 4x4 grid\n    adj_matrix = np.full((NUM_NODES, NUM_NODES), np.inf)\n    np.fill_diagonal(adj_matrix, 0)\n\n    for n in range(NUM_NODES):\n        i = n % GRID_SIZE\n        j = n // GRID_SIZE\n        \n        # Horizontal neighbor\n        if i + 1  GRID_SIZE:\n            neighbor_n = (i + 1) + GRID_SIZE * j\n            adj_matrix[n, neighbor_n] = EDGE_WEIGHT\n            adj_matrix[neighbor_n, n] = EDGE_WEIGHT\n            \n        # Vertical neighbor\n        if j + 1  GRID_SIZE:\n            neighbor_n = i + GRID_SIZE * (j + 1)\n            adj_matrix[n, neighbor_n] = EDGE_WEIGHT\n            adj_matrix[neighbor_n, n] = EDGE_WEIGHT\n\n    # Apply urban constraints to the adjacency matrix\n    # Constraint 1: Barrier\n    # Remove horizontal edges between (i=1,j) and (i=2,j) for j in {1,2}\n    # j=1: nodes 5 and 6\n    adj_matrix[5, 6] = adj_matrix[6, 5] = np.inf\n    # j=2: nodes 9 and 10\n    adj_matrix[9, 10] = adj_matrix[10, 9] = np.inf\n\n    # Constraint 2: One-way street\n    # From (i=0,j=2) to (i=0,j=3), i.e., from node 8 to 12.\n    # The reverse path from 12 to 8 is disallowed.\n    adj_matrix[12, 8] = np.inf\n    \n    # 2. Compute shortest-path network distances\n    # Use Dijkstra's algorithm on the directed graph\n    dist_net_matrix = dijkstra(csgraph=adj_matrix, directed=True)\n\n    results = []\n    # 3. Process each resident\n    for res_n in resident_nodes:\n        # Get resident's coordinates\n        res_coords = coords[res_n]\n        \n        # Get coordinates of the two sources\n        src_coords = coords[source_nodes]\n        \n        # Calculate Euclidean distance to the nearest source\n        euc_dists = np.sqrt(np.sum((res_coords - src_coords)**2, axis=1))\n        d_euc = np.min(euc_dists)\n        \n        # Get network distance to the nearest source from the pre-computed matrix\n        net_dists = dist_net_matrix[res_n, source_nodes]\n        d_net = np.min(net_dists)\n        \n        # 4. Calculate relative bias\n        bias = np.exp(LAMBDA * (d_net - d_euc)) - 1.0\n        results.append(bias)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4527981"}, {"introduction": "空间流行病学的一个核心问题是疾病病例是否存在地理聚集。要回答这个问题，我们需要使用空间权重来形式化地定义“邻近”关系。空间权重可以基于简单的邻接关系（如共享边界），也可以是距离的连续函数（如高斯核函数），而权重方案的选择会显著影响空间模式的分析结果。在本次练习 [@problem_id:4528018] 中，你将使用两种不同的权重方案来计算局部空间自相关，亲手验证我们对空间关系的定义如何从量化上影响我们对疾病聚集性的判断。", "problem": "一个公共卫生团队使用地理信息系统 (GIS) 来调查一种法定传染病在五个相邻的人口普查区 $T_1,\\dots,T_5$ 中可能存在的聚集性。在同一观测窗口内，每 $10{,}000$ 人的发病率分别为：$x_1=12$, $x_2=18$, $x_3=10$, $x_4=25$, $x_5=15$。从 $T_1$ 的质心到其他普查区质心的距离（单位：$\\mathrm{km}$）为：$d_{12}=1.0$, $d_{13}=2.0$, $d_{14}=3.5$, $d_{15}=4.0$。在邻接性方面，只有 $T_2$ 和 $T_3$ 与 $T_1$ 共享边界；$T_4$ 和 $T_5$ 则不共享。\n\n您将需要在两种空间权重方案下比较 $T_1$ 对局部空间自相关的贡献：\n- 一种高斯核方案，其带宽为 $b=2.0$，使得对于 $j\\in\\{2,3,4,5\\}$，权重为 $w_{1j}=\\exp\\!\\big(- (d_{1j}/b)^2\\big)$。\n- 一种二元邻接方案，其权重为 $w_{12}=1$, $w_{13}=1$, $w_{14}=0$, $w_{15}=0$。\n\n根据全局莫兰指数I (global Moran’s $I$) 可分解为各位置特定贡献之和的核心定义，请使用中心化值 $x_i-\\bar{x}$ 和权重 $\\{w_{1j}\\}$（不进行任何行标准化），计算 $T_1$ 在每种权重方案下的局部贡献。使用二阶中心矩 $m_2=\\frac{1}{n}\\sum_{k=1}^{n}(x_k-\\bar{x})^2$ 进行归一化，其中 $n=5$，$\\bar{x}$ 是五个普查区的平均发病率。\n\n报告一个数字，该数字等于 $T_1$ 在两种方案下的局部贡献之差（高斯核方案减去二元邻接方案）。将您的最终答案四舍五入到四位有效数字。不需要单位。", "solution": "用户希望计算在两种不同的空间权重方案下，普查区 $T_1$ 对空间自相关的局部贡献之差。\n\n首先，我将验证问题陈述。\n### 步骤1：提取已知条件\n-   人口普查区数量, $n=5$, 标记为 $T_1, \\dots, T_5$。\n-   每 $10,000$ 人的发病率: $x_1=12$, $x_2=18$, $x_3=10$, $x_4=25$, $x_5=15$。\n-   $T_1$ 到其他普查区的距离 (单位 km): $d_{12}=1.0$, $d_{13}=2.0$, $d_{14}=3.5$, $d_{15}=4.0$。\n-   $T_1$ 的邻接信息：与 $T_2$ 和 $T_3$ 邻接；与 $T_4$ 和 $T_5$ 不邻接。\n-   高斯核权重方案：$w_{1j,G}=\\exp(-(d_{1j}/b)^2)$，带宽 $b=2.0$。\n-   二元邻接权重方案：$w_{12,B}=1$, $w_{13,B}=1$, $w_{14,B}=0$, $w_{15,B}=0$。\n-   局部贡献的定义：普查区 $T_i$ 的局部贡献由中心化值 $x_k-\\bar{x}$ 和权重 $w_{ij}$ 计算得出，不进行行标准化，并使用二阶中心矩 $m_2=\\frac{1}{n}\\sum_{k=1}^{n}(x_k-\\bar{x})^2$ 进行归一化。\n-   任务：计算在高斯方案和二元方案下 $T_1$ 的局部贡献之差，并将结果四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于空间统计学中的既定概念（莫兰指数I，空间权重矩阵），并应用于空间流行病学中的一个标准问题。所有概念都属于主流科学范畴。\n-   **适定性**：所有必要的数据（$x_i$, $d_{1j}$, $b$，权重定义）都已提供。“局部贡献”的定义已足够明确，可以推導出唯一的计算公式。问题是自洽的，且结构清晰，可以得出唯一解。\n-   **客观性**：问题陈述使用了精确、定量且无偏见的语言。\n-   该问题没有表现出任何科学上不健全、不完整、矛盾或含糊不清的缺陷。局部贡献的定义，虽然不是LISA（局部空间自相关指数）统计量的最标准公式（因为它明确禁止了行标准化），但为了本问题的目的，其定义是清晰的。一个与全局莫兰指数I分解相一致的合理解释是，普查区 $i$ 的局部贡献为 $L_i = \\frac{(x_i - \\bar{x}) \\sum_{j \\neq i} w_{ij} (x_j - \\bar{x})}{\\sum_{k=1}^n (x_k - \\bar{x})^2} = \\frac{(x_i - \\bar{x})}{n \\cdot m_2} \\sum_{j \\neq i} w_{ij} (x_j - \\bar{x})$。然而，问题要求使用 $m_2$ 进行归一化。这表明公式应为 $L_i = \\frac{x_i - \\bar{x}}{m_2} \\sum_{j \\neq i} w_{ij}(x_j - \\bar{x})$。这是一个有效的、定义明确的待计算量。\n\n### 步骤3：结论与行动\n该问题有效。详细解答如下。\n\n根据问题陈述，普查区 $T_1$ 对空间自相关的局部贡献（记为 $L_1$）定义为：\n$$L_1 = \\frac{(x_1 - \\bar{x})}{m_2} \\sum_{j=2}^{5} w_{1j} (x_j - \\bar{x})$$\n其中 $\\bar{x}$ 是平均发病率，$m_2$ 是发病率的二阶中心矩，$\\{w_{1j}\\}$ 是空间权重。\n\n首先，我们从发病率数据 $x = \\{12, 18, 10, 25, 15\\}$ 计算必要的统计量。\n普查区的数量为 $n=5$。\n平均发病率为：\n$$\\bar{x} = \\frac{1}{n} \\sum_{k=1}^{n} x_k = \\frac{1}{5} (12 + 18 + 10 + 25 + 15) = \\frac{80}{5} = 16$$\n接下来，我们计算中心化值 $z_k = x_k - \\bar{x}$：\n$$z_1 = 12 - 16 = -4$$\n$$z_2 = 18 - 16 = 2$$\n$$z_3 = 10 - 16 = -6$$\n$$z_4 = 25 - 16 = 9$$\n$$z_5 = 15 - 16 = -1$$\n中心化值的总和为 $\\sum z_k = -4 + 2 - 6 + 9 - 1 = 0$，符合预期。\n\n二阶中心矩 $m_2$ 是中心化值平方的平均值：\n$$m_2 = \\frac{1}{n} \\sum_{k=1}^{n} (x_k - \\bar{x})^2 = \\frac{1}{5} \\left( (-4)^2 + 2^2 + (-6)^2 + 9^2 + (-1)^2 \\right)$$\n$$m_2 = \\frac{1}{5} (16 + 4 + 36 + 81 + 1) = \\frac{138}{5} = 27.6$$\n\n现在我们可以计算在每种权重方案下 $T_1$ 的局部贡献。\n\n**1. 高斯核方案**\n权重 $w_{1j,G}$ 使用公式 $w_{1j,G} = \\exp\\big(-(d_{1j}/b)^2\\big)$ 计算，其中带宽 $b=2.0$。\n$$w_{12,G} = \\exp\\left(-\\left(\\frac{1.0}{2.0}\\right)^2\\right) = \\exp(-0.25)$$\n$$w_{13,G} = \\exp\\left(-\\left(\\frac{2.0}{2.0}\\right)^2\\right) = \\exp(-1.0)$$\n$$w_{14,G} = \\exp\\left(-\\left(\\frac{3.5}{2.0}\\right)^2\\right) = \\exp(-1.75^2) = \\exp(-3.0625)$$\n$$w_{15,G} = \\exp\\left(-\\left(\\frac{4.0}{2.0}\\right)^2\\right) = \\exp(-2.0^2) = \\exp(-4.0)$$\n\n局部贡献 $L_{1,G}$ 为：\n$$L_{1,G} = \\frac{z_1}{m_2} \\sum_{j=2}^{5} w_{1j,G} z_j$$\n$$L_{1,G} = \\frac{-4}{27.6} \\left( z_2 w_{12,G} + z_3 w_{13,G} + z_4 w_{14,G} + z_5 w_{15,G} \\right)$$\n$$L_{1,G} = \\frac{-4}{27.6} \\left( 2\\exp(-0.25) - 6\\exp(-1.0) + 9\\exp(-3.0625) - 1\\exp(-4.0) \\right)$$\n使用指数的数值：\n$$L_{1,G} \\approx \\frac{-4}{27.6} \\left( 2(0.778801) - 6(0.367879) + 9(0.046751) - 1(0.018316) \\right)$$\n$$L_{1,G} \\approx \\frac{-4}{27.6} (1.557602 - 2.207274 + 0.420759 - 0.018316)$$\n$$L_{1,G} \\approx \\frac{-4}{27.6} (-0.247229) \\approx 0.035830$$\n\n**2. 二元邻接方案**\n权重 $w_{1j,B}$ 已给出，$w_{12,B}=1$, $w_{13,B}=1$, $w_{14,B}=0$, $w_{15,B}=0$。\n局部贡献 $L_{1,B}$ 为：\n$$L_{1,B} = \\frac{z_1}{m_2} \\sum_{j=2}^{5} w_{1j,B} z_j$$\n$$L_{1,B} = \\frac{-4}{27.6} (z_2(1) + z_3(1) + z_4(0) + z_5(0))$$\n$$L_{1,B} = \\frac{-4}{27.6} (2 - 6) = \\frac{-4}{27.6} (-4) = \\frac{16}{27.6}$$\n$$L_{1,B} \\approx 0.579710$$\n\n**3. 贡献之差**\n所求的值是差值 $\\Delta L_1 = L_{1,G} - L_{1,B}$。\n$$\\Delta L_1 \\approx 0.035830 - 0.579710 = -0.54388$$\n\n将结果四舍五入到四位有效数字得到 $-0.5439$。\n为了在四舍五入前提供更精确的计算：\n$L_{1,G} = \\frac{4 \\times 0.247229163...}{27.6} = 0.035830313...$\n$L_{1,B} = \\frac{16}{27.6} = 0.579710144...$\n$\\Delta L_1 = 0.035830313... - 0.579710144... = -0.543879831...$\n将结果四舍五入到四位有效数字，我们得到 $-0.5439$。", "answer": "$$\n\\boxed{-0.5439}\n$$", "id": "4528018"}]}