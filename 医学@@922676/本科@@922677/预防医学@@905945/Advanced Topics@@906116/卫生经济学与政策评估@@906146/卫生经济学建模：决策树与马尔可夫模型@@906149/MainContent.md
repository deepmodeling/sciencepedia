## 引言
在现代预防医学和公共卫生领域，决策者常常面临在多种干预策略中进行选择的挑战，这些策略不仅影响人群健康，也涉及巨大的资源投入。为了做出科学、高效且公平的决策，我们迫切需要超越直觉判断，采用定量的分析工具来系统性地评估不同选择的长期成本与效果。健康经济学模型正是为此而生，它为复杂的公共卫生问题提供了一个结构化的分析框架。

本文聚焦于两种最基本也最强大的建模技术：[决策树](@entry_id:265930)与马尔可夫模型。尽管这些模型在学术研究和政策制定中被广泛应用，但许多学习者和实践者对于其内部工作原理、关键假设以及如何根据具体问题选择和构建合适的模型仍感困惑。本文旨在填补这一知识鸿沟，引领读者深入理解这些模型的精髓。

在接下来的内容中，我们将分三个部分展开：首先，在“原理与机制”一章中，我们将剖析决策树和马尔可夫模型的数学基础、核心组件以及计算方法，为您打下坚实的理论基础。接着，在“应用与跨学科交叉”一章中，我们将通过筛查项目评估、慢性病管理等真实世界案例，展示这些模型如何解决实际问题，并探讨其与流行病学、卫生政策等领域的深刻联系。最后，“实践练习”部分将提供具体的计算问题，帮助您巩固所学知识，将理论转化为实践能力。通过本次学习，您将能够掌握构建和解读健康经济学模型的核心技能，为未来的学习和研究工作做好准备。

## 原理与机制

在卫生经济学评估中，为了系统地比较不同预防策略的成本与效果，我们必须依赖于严谨的数学模型。这些模型为决策者提供了一个量化框架，用以预测干预措施在人群中可能产生的长期健康与经济后果。本章将深入探讨两种最核心的建模技术——[决策树](@entry_id:265930)与马尔可夫模型——的基本原理、构建机制及其在预防医学评估中的应用。

### 核心建模框架：决策树与马尔可夫模型

选择正确的建模框架是分析的基石，其决策取决于所研究疾病的性质以及干预措施的作用方式。从根本上说，选择[决策树](@entry_id:265930)还是马尔可夫模型，取决于我们如何处理事件的**复发性**和**时间依赖性** [@problem_id:4530865]。

**决策树（Decision Tree）** 最适用于模拟在相对较短且固定的时间范围内发生的、一次性的或非复发性的事件序列。当一个决策（如是否接种疫苗）引发一系列有限、可清晰枚举的后续事件，并且所有最终结局能在短期内确定时，[决策树](@entry_id:265930)便成为理想工具。例如，在评估一种季节性疾病疫苗时，个体在接种后可能在当季被感染或不被感染，这些结果路径有限，且不会在同一季节内反复发生。决策树的结构清晰地展现了从初始决策到最终结局的各个分支路径。

**马尔可夫模型（Markov Model）** 则专为模拟慢性病或具有复发风险的疾病而设计。当个体可能在多个健康状态之间随时间推移而反复转移，且事件可以在一个漫长的时间跨度（如一生）内多次发生时，马尔可夫模型便显示出其强大威力。例如，在评估高血压管理项目时，个体可能在“健康”、“心血管事件后第一年”、“事件后稳定期”和“死亡”等状态间转换。事件（如中风）可能复发，且每次复发后的风险和成本可能与之前不同。在这种情境下，试图用决策树枚举所有可能发生的事件序列是不切实际的，而马尔可夫模型通过定义状态和周期性的转移概率，能够简洁而有力地模拟这一复杂过程 [@problem_id:4530865]。

### 决策树的剖析

决策树通过图形化的节点和分支，直观地构建出决策问题。它的核心要素包括决策节点、机会节点和终末节点。

#### 节点、分支与终末收益

**决策节点（Decision Node）**，通常用方块表示，代表分析师或决策者可以控制的选择点。从决策节点引出的每个分支代表一个待比较的策略。例如，在评估一项预防性筛查干预时，初始节点就是一个决策节点，其分支为“提供筛查”与“不提供筛查” [@problem_id:4530928]。

**机会节点（Chance Node）**，通常用圆形表示，代表由概率决定的不确定性事件。从机会节点引出的分支必须是**[互斥](@entry_id:752349)（mutually exclusive）**且**完全穷尽（collectively exhaustive）**的，即所有分支的概率之和必须等于 $1$ [@problem_id:4530938]。例如，在“提供筛查”策略下，会有一个机会节点代表受试者的真实患病状况（如“患有癌前病变”或“未患病”），其概率由人群中的患病率决定。在此之后，还可能有一系列机会节点，如筛查测试结果（阳性或阴性，其概率由测试的灵敏度和特异性决定）、诊断性检查是否引发并发症等 [@problem_id:4530928]。

**终末节点（Terminal Node）** 代表一条完整路径的终点，每条路径都对应一个特定的结局。在卫生经济学评估中，一个至关重要的原则是，终末节点的收益（payoff）必须是一个**向量**，通常表示为 $(\text{成本}, \text{效果})$，例如 $(\text{Cost}, \text{QALYs})$。之所以必须采用向量形式，是因为[成本效益分析](@entry_id:200072)的核心目标是评估成本与健康效果之间的权衡。如果将两者合并为一个单一的效用值，我们将无法计算增量成本效果比（ICER）等关键决策指标。此外，向量收益也使我们能够区分那些临床结局相同但成本不同的路径。例如，在一个流感疫苗接种模型中，“未感染”这一结局在“接种疫苗”分支下会产生疫苗成本，而在“不接种疫苗”分支下则成本为零。只有通过向量收益，这种经济上的差异才能被准确捕捉 [@problem_id:4530938]。

#### [期望值](@entry_id:150961)的计算：折叠与加权

决策树分析的核心是计算每个决策分支的**[期望值](@entry_id:150961)（Expected Value）**。这通过一个称为“折叠（folding back）”或“[期望值](@entry_id:150961)加权平均”的过程来完成。其基本公式为：
$E[V] = \sum_i p_i v_i$
其中，$v_i$ 是第 $i$ 个可能结局的收益值（成本或QALYs），$p_i$ 是该结局发生的概率。

计算从右至左（从终末节点到决策节点）进行。在每个机会节点，其[期望值](@entry_id:150961)是其所有分支的[期望值](@entry_id:150961)与其对应概率乘积的总和。最终，每个初始决策分支都会被归结为一个期望成本和期望QALYs。

让我们通过一个具体的例子来阐明这一过程。假设我们评估一项为期一年的结直肠肿瘤筛查项目 [@problem_id:4530928]。

*   **决策节点**：筛查 vs. 不筛查。

*   **“不筛查”策略**：这很简单。个体结果仅取决于其潜在的患病状态。若人群中癌前病变患病率为 $0.06$，且未被发现的病变在一年内有 $0.2$ 的概率出现症状（导致成本 $\$10,000$ 和QALY损失 $0.1$），则：
    *   期望成本 $E[C]_{\text{不筛查}} = 0.06 \times 0.2 \times \$10,000 = \$120$。
    *   期望QALY损失 $E[\Delta Q]_{\text{不筛查}} = 0.06 \times 0.2 \times 0.1 = 0.0012$。

*   **“筛查”策略**：这个分支要复杂得多。所有参与者首先承担筛查测试成本（如 $\$20$）。
    1.  树的第一个机会节点是**患病状态**：$0.06$ 的概率患病，$0.94$ 的概率不患病。
    2.  在每个患病状态分支下，是第二个机会节点：**测试结果**。
        *   若患病，测试呈阳性（[真阳性](@entry_id:637126)）的概率为灵敏度（如 $0.70$），呈阴性（假阴性）的概率为 $1 - 0.70 = 0.30$。
        *   若不患病，测试呈阳性（[假阳性](@entry_id:635878)）的概率为 $1 - \text{特异度}$（如 $1 - 0.94 = 0.06$），呈阴性（真阴性）的概率为特异度（如 $0.94$）。
    3.  任何**阳性测试结果**（真阳性或[假阳性](@entry_id:635878)）都会引向后续的诊断流程（如结肠镜检查，成本 $\$800$），这本身又是一个机会节点，因为检查可能导致并发症（如 $0.002$ 的概率发生严重并发症，产生额外成本和QALY损失）。
    4.  任何**疾病未被检出**的情况（如假阴性），会像“不筛查”策略中的患病者一样，面临发生症状性事件的风险。

    要计算“筛查”策略的总期望值，我们必须枚举所有终末路径，计算每条路径的总成本和总QALY损失，并乘以该路径上所有概率的乘积（路径概率）。例如，“患病 $\rightarrow$ 测试阳性 $\rightarrow$ 检查有并发症”这条路径的概率为 $0.06 \times 0.70 \times 0.002 = 0.000084$。最后，将所有路径的（路径概率 $\times$ 路径收益）相加，得出该策略的总期望成本和总期望QALY损失。通过这样的精细计算，我们可以发现，尽管筛查策略的初始成本更高，但通过早期发现和治疗，它可能在长期内减少更昂贵的症状性事件，并带来健康收益 [@problem_id:4530928]。

### 马尔可夫模型的机制

当疾病过程是慢性的、可复发的，且风险随时间演变时，我们需要一个能够模拟动态过程的模型。马尔可夫模型通过其核心组件——状态、转移概率和记忆缺失特性——实现了这一点。

#### 核心组件

**马尔可夫状态（Markov States）** 是模型的基石。它们是对个体健康状况的一组**互斥**且**完全穷尽**的分类。例如，一个慢性病模型可能包含“健康”、“无症状疾病”、“有症状疾病”和“死亡”等状态 [@problem_id:4530988]。互斥意味着任何个体在任何时刻只能处于一个状态；穷尽意味着所有可能的情况都被这些状态所覆盖。

**记忆缺失特性（Memoryless Property）** 是马尔可夫过程的定义性特征。它指出，系统在未来将转移到哪个状态，其概率**仅**取决于其当前所处的状态，而与它如何到达当前状态的历史路径无关。形式上，记 $X_t$ 为在时间点 $t$ 的状态，该特性表示为：
$\Pr(X_{t+1} = j \mid X_t = i, X_{t-1}=i_{t-1}, \dots) = \Pr(X_{t+1} = j \mid X_t = i)$
这个特性极大地简化了复杂疾病历程的建模，因为它允许我们将注意力集中在当前状态和未来的可能性上，而不必追踪每个个体详尽的病史 [@problem_id:4530988]。

**转移概率（Transition Probabilities）** 是连接状态的纽带。单步转移概率 $p_{ij}$ 定义为从状态 $i$ 在一个模型周期（cycle）内转移到状态 $j$ 的概率，即 $p_{ij} = \Pr(X_{t+1} = j \mid X_t = i)$。这些概率被组织在一个**转移概率矩阵（Transition Probability Matrix）** $P$ 中，其中第 $i$ 行第 $j$ 列的元素就是 $p_{ij}$。这个矩阵必须满足两个条件：所有元素 $p_{ij} \ge 0$，且每一行的元素之和必须等于 $1$（即 $\sum_j p_{ij} = 1$），因为个体必须从当前状态转移到某个（可能包括自身在内的）状态 [@problem_id:4530988]。

**吸收态（Absorbing States）** 是一种特殊的状态，一旦进入就无法离开。在数学上，如果状态 $i$ 是吸收态，则其转移概率为 $p_{ii} = 1$ 且对于所有 $j \neq i$ 有 $p_{ij} = 0$。在健康模型中，“死亡”是典型的吸收态。将其建模为吸收态，不仅符合其生物学上的不可逆性，也确保了模型在数学上的严谨性，因为“死亡”这一行的概率和恰好为 $1$。这一设定也确保了在个体死亡后的所有后续周期中，不会再累积任何成本或健康效用（QALYs），任何临终成本都应作为进入“死亡”状态的一次性转移成本来处理 [@problem_id:4530862]。

#### 模拟队列演变与成本效果累积

马尔可夫模型通常用于模拟一个**队列（cohort）**随时间的演变。我们可以用一个行向量 $\mathbf{x}_t$ 来表示在周期 $t$ 开始时，队列在各个状态的分布情况（即每个状态中的人群比例）。队列在下一个周期的分布可以通过简单的矩阵乘法得到：
$\mathbf{x}_{t+1} = \mathbf{x}_t \mathbf{P}$

为了进行成本效果分析，我们为每个状态 $i$ 分配一个**状态收益向量**，包括该状态下的周期性成本 $c_i$ 和健康效用 $u_i$ [@problem_id:4530859]。例如，“有症状疾病”状态通常关联着较高的医疗成本和较低的健康效用值。

在一个长度为 $\Delta t$ 的周期 $t$ 中，累积的期望成本和QALYs是如何计算的呢？由于个体在周期内可能发生状态转移，最精确的方法是考虑周期内各状态的平均占据时间。一个广泛接受且逻辑上严谨的近似方法是使用**半周期校正（Half-Cycle Correction）**。该方法假设转移平均发生在周期的中点，因此周期内的平均队列分布可以近似为周期开始和结束时分布的平均值。如果我们将状态成本和效用分别表示为列向量 $\mathbf{c}$ 和 $\mathbf{u}$，并考虑贴现因子 $\delta = \frac{1}{1+r}$，则周期 $t$ 的期望贴现成本 $C_t$ 和期望贴现QALYs $Q_t$ 可以表示为：
$C_t = \delta^{t-0.5} \left( \frac{\mathbf{x}_t + \mathbf{x}_{t+1}}{2} \right) \mathbf{c} \Delta t$
$Q_t = \delta^{t-0.5} \left( \frac{\mathbf{x}_t + \mathbf{x}_{t+1}}{2} \right) \mathbf{u} \Delta t$
（注意：此处公式中的 $t-0.5$ 是一个常见的惯例，旨在表示在第 $t$ 个周期（时间从 $t-1$ 到 $t$）的中点进行贴现。其他形式如 $t+0.5$ 也可能出现，取决于周期的索引方式。）
通过逐个周期地计算并累加这些值，我们就可以得到在整个模型时间跨度内的总期望成本和总期望QALYs [@problem_id:4530859]。

### 关键度量与经济学原理

无论是决策树还是马尔可夫模型，其最终目的都是为成本效果分析提供输入。这个分析过程依赖于两个关键要素：健康产出的度量和跨时间价值的比较。

#### 衡量健康产出：QALYs与DALYs

在卫生经济学中，最常用的两种综合性健康产出度量是**质量调整生命年（Quality-Adjusted Life Years, QALYs）**和**伤残调整生命年（Disability-Adjusted Life Years, DALYs）** [@problem_id:4530881]。

**QALY** 是一个衡量**健康收益**的指标。它将生存时间与生命质量相结合。其计算基于效用权重（utility weights），其中 $1.0$ 代表完全健康，$0.0$ 代表死亡。一年处于效用值为 $u$ 的健康状态，就相当于获得了 $u$ 个QALYs。

**DALY** 是一个衡量**健康损失**的指标，代表因疾病、伤残或过早死亡而损失的“健康年”。它由两部分组成：因过早死亡损失的生命年（Years of Life Lost, YLL）和因伤残导致健康受损的年数（Years Lived with Disability, YLD）。其计算基于伤残权重（disability weights），其中 $0.0$ 代表没有伤残，$1.0$ 代表等同于死亡的伤残状态。

尽管两者都试图量化健康，但其哲学基础和计算方法存在差异。QALYs衡量的是“获得的健康”，而DALYs衡量的是“失去的健康”。然而，在特定条件下，两者可以相互关联。如果一个干预措施不影响死亡率（即 YLL = $0$），并且健康状态的效用值 $u$ 与其伤残权重 $dw$ 恰好满足关系 $u = 1 - dw$，那么通过干预所“获得的QALYs”在数值上将等于“避免的DALYs” [@problem_id:4530881]。例如，在一个仅考虑短期发病（不致命）的流感疫苗模型中，若流感期间的健康效用为 $0.8$，而其伤残权重为 $0.2$，则这两个条件都得到满足，两种度量方法会得出相同的增量健康效果。然而，一旦涉及对死亡率的影响，或者效用与伤残权重的度量体系不匹配，两者的结果通常会产生差异 [@problem_id:4530881]。

#### 健康与货币的时间价值：贴现

卫生经济决策通常涉及当前投入与未来收益的权衡。**贴现（Discounting）** 是一个基本的经济学原理，用于将未来发生的成本和健康收益转换成其**现值（Present Value）**，以便进行公平比较。其理论依据主要有二：**时间偏好**（人们普遍倾向于更早地获得收益和更晚地承担成本）和**机会成本**（今天的资源可以被投资并在未来产生回报）[@problem_id:4531024]。

在卫生经济模型中，成本和健康收益（如QALYs）通常都应使用相同的年贴现率 $r$ 进行贴现。对于在每年年末发生的离散成本流 $x_t$，其总现值（PV）的计算公式为：
$PV = \sum_{t=0}^{T} \frac{x_t}{(1+r)^t}$
其中 $x_0$ 代表在时间起点（$t=0$）发生的初始成本。

然而，健康收益（QALYs）通常被认为是在一年中均匀累积的，而非在年末一次性获得。因此，对其进行贴现时，更精确的做法是反映其在周期内的发生时间。这可以通过**连续贴现**（$PV = \int_0^T x(t)e^{-rt} dt$）的数学思想来理解，但在离散时间模型中，一个优秀的实践是采用前文提到的**半周期校正**，即假设收益在周期的中点发生并进行贴现。忽略这种周期内的时点差异，虽然简化了计算，但会引入系统性偏差 [@problem_id:4531024]。

### 建模实践考量与进阶主题

构建一个既严谨又实用的健康经济模型，还需要考虑一系列实践层面的问题和更高级的概念。

#### 选择模型参数：时间跨度与周期长度

**时间跨度（Time Horizon, $T$）** 指的是模型模拟的总时长。一个基本原则是，时间跨度应足够长，以捕捉到所比较策略在成本和健康效果上的所有重要差异。对于许多预防性干预（如癌症筛查、慢性病管理），其主要益处可能在数年甚至数十年后才显现。因此，采用较短的时间跨度（如仅考虑一个预算周期）会系统性地低估这些干预的长期价值，导致错误的决策。通常，对于此类问题，推荐使用**终生时间跨度** [@problem_id:4531036]。

**周期长度（Cycle Length, $t_c$）** 是马尔可夫模型中离散的时间步长。选择周期长度需要在准确性与模型复杂性之间取得平衡。周期过长会引入**离散化误差（Discretization Error）**，即因将连续时间过程强行塞入离散时间步而产生的偏差。最严重的问题是，在一个过长的周期内，可能发生多个相互关联的临床事件（例如，接受手术 $\rightarrow$ 发生并发症 $\rightarrow$ 死亡），而标准的马尔可夫模型在一个周期内只能模拟一次转移，从而无法正确捕捉事件的顺序和后果 [@problem_id:4531036]。

选择周期长度的准则是：它应足够短，以至于在一个周期内发生多个关键临床事件的概率可以忽略不计。例如，在评估一项外科手术后，如果严重并发症（如穿孔、大出血）通常在术后几天内发生，那么使用长达一年的周期长度显然是不合适的。我们可以通过泊松分布等概率工具来定量论证所选周期长度的合理性，即证明在一个周期内发生两次或以上事件的概率极低（如低于 $10^{-4}$）[@problem_id:4531036]。

当模型中既有快速发生的事件（如术后并发症）又有缓慢演变的长期过程（如肿瘤生长）时，一个优雅的解决方案是构建**混合模型（Hybrid Model）**。例如，我们可以使用一个短期（如以天或周为周期）的**决策树**来精确模拟手术及其围手术期的各种即时风险和结果。这个决策树的终末节点将代表患者进入长期健康状态的起点，随后衔接一个长期（如以年为周期）的**马尔可夫模型**来模拟后续的慢性病程。这种结构兼顾了短期精度和长期效率 [@problem_id:4531036]。

#### 处理不确定性

任何模型都是对现实的简化，其结果受到输入参数和模型结构假设不确定性的影响。严谨的建模分析必须对这些不确定性进行评估。

**结构不确定性（Structural Uncertainty）** 源于模型形式或结构的选择，而非参数的具体数值。这包括对健康状态的定义、状态间的转移路径、时间跨度或周期长度的选择等。即使所有输入参数完全相同，不同的模型结构也可能导致截然不同的结论。例如，假设两个团队评估同一种疫苗，一个团队使用简单的决策树，忽略了疫苗可能导致的轻微但有成本和效用损失的不良反应；另一个团队则使用马尔可夫模型，并专门设置了一个“隧道状态（tunnel state）”来模拟第一年发生的不良反应。计算结果可能显示，前一个模型认为疫苗具有成本效益，而后一个模型则得出相反结论。这个差异并非源于参数值，而是源于是否将不良反应这一临床路径纳入模型结构的决策。这凸显了模型结构假设对最终结果的巨大影响 [@problem_id:4531029]。

**参数不确定性（Parameter Uncertainty）** 指的是模型输入参数（如概率、成本、效用值）的真实值未知。处理参数不确定性的标准方法是进行**概率敏感性分析（Probabilistic Sensitivity Analysis, PSA）**。PSA的过程是：为模型中所有不确定的参数指定概率分布，然后通过蒙特卡洛模拟，成千上万次地从这些分布中同时随机抽样，每次抽样都重新计算模型结果（如增量成本效果比或净货币获益）。最终，我们会得到一个结果的分布，从而可以评估决策的不确定性（例如，在给定的支付意愿下，新策略有百分之多少的概率是具有成本效益的）[@problem_id:4530894]。

为参数选择合适的概率分布至关重要，这需要基于参数的数学特性和经验数据：
*   **概率和效用值**：这些参数的取值范围被严格限制在 $[0, 1]$ 之间。**[贝塔分布](@entry_id:137712)（Beta distribution）** 是此类参数的理想选择，因为它不仅定义域匹配，而且形状非常灵活，可以模拟对称、偏斜等多种分布形态。
*   **成本**：成本值必须为非负数，且经验数据常常显示其分布呈[右偏态](@entry_id:275130)（即多数成本较低，少数极高）。**伽马分布（Gamma distribution）** 或[对数正态分布](@entry_id:261888)（Log-normal distribution）非常适合模拟成本，因为它们的定义域为正数，且天然具有右偏性。

通过对这两种不确定性进行系统的分析，我们才能更全面地理解模型的稳健性，并为公共卫生决策提供更可靠的科学依据 [@problem_id:4530894]。