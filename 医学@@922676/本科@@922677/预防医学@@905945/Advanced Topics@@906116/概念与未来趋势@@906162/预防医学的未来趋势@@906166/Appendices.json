{"hands_on_practices": [{"introduction": "循证预防医学的基石在于准确的监测与测量。本练习将带你实践生物统计学的核心技能，展示如何从样本数据中估算关键的公共卫生指标，例如抗菌素耐药性比例[@problem_id:4527010]。通过构建置信区间，你将学会量化监测数据中固有的不确定性，这是做出明智决策的关键一步。", "problem": "在一项区域性抗菌药物耐药性监测项目中，月度抗菌谱汇总了来自急症护理医院的抗生素敏感性测试结果，记录为耐药和敏感菌株的数量。假设在某个月份，有 $n=500$ 株独立的临床菌株针对某种哨点病原体和一种一线抗生素进行了测试，其中有 $x$ 株被记录为耐药。预防医学的决策者希望得到一个基于基本原理的估计量来估计潜在的总体耐药比例 $p$，并对其不确定性进行量化，以用于实时决策阈值。仅使用适用于公共卫生监测和统计抽样的基本原理——即伯努利随机变量的定义、独立伯努利试验计数的二项分布，以及由中心极限定理（CLT）导出的大样本正态近似——完成以下任务：\n\n1. 根据抗菌谱数据结构和二项抽样误差，为耐药比例 $p$ 构建一个估计量，并推导其期望值和方差。\n2. 在基于中心极限定理的估计量抽样分布的正态近似下，推导一个用 $x$ 和 $n$ 表示的关于 $p$ 的双侧 $95\\%$ 置信区间（CI）。\n3. 对于所讨论的月份，抗菌谱报告在 $n=500$ 株测试菌株中有 $x=100$ 株耐药菌株，因此观测到的估计量值为 $\\hat{p}=0.2$。使用你推导出的表达式计算 $p$ 的 $95\\%$ 置信区间的端点。将每个端点四舍五入到四位有效数字。将最终端点表示为小数（不带百分号）。\n\n你的最终答案必须是以单行矩阵形式报告的两个置信区间端点。", "solution": "问题陈述经评估有效。这是一个定义明确、有科学依据的生物统计学问题，没有矛盾或含糊之处。我们可以开始求解。\n\n该问题要求基于基本原理推导总体比例的估计量、其统计特性以及相关的置信区间。\n\n**第1部分：估计量的构建与性质**\n\n设总体中耐药菌株的潜在真实比例为 $p$。该监测项目测试了 $n=500$ 株独立的临床菌株。每个菌株的结果可以建模为一次独立的伯努利试验。\n\n设 $X_i$ 为一个随机变量，表示第 $i$ 株菌株的结果，其中 $i=1, \\dots, n$。如果菌株是耐药的，我们定义 $X_i=1$；如果是敏感的，则定义 $X_i=0$。耐药的概率为 $P(X_i=1) = p$，敏感的概率为 $P(X_i=0) = 1-p$。\n\n单次伯努利试验 $X_i$ 的期望值为：\n$$E[X_i] = (1 \\cdot P(X_i=1)) + (0 \\cdot P(X_i=0)) = p$$\n单次伯努利试验 $X_i$ 的方差为：\n$$Var(X_i) = E[X_i^2] - (E[X_i])^2 = (1^2 \\cdot p + 0^2 \\cdot (1-p)) - p^2 = p - p^2 = p(1-p)$$\n\n耐药菌株的总数 $x$ 是这些独立同分布的伯努利随机变量之和：\n$$x = \\sum_{i=1}^{n} X_i$$\n根据定义，参数为 $p$ 的 $n$ 次独立伯努利试验之和服从二项分布，记为 $x \\sim \\text{Binomial}(n, p)$。\n\n总体比例 $p$ 的一个自然估计量是样本比例，我们记为 $\\hat{p}$。它被定义为耐药菌株数量与测试菌株总数之比：\n$$\\hat{p} = \\frac{x}{n} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$$\n\n为了求出该估计量的期望值，我们使用期望的线性性质：\n$$E[\\hat{p}] = E\\left[\\frac{1}{n}\\sum_{i=1}^{n} X_i\\right] = \\frac{1}{n}\\sum_{i=1}^{n} E[X_i] = \\frac{1}{n}\\sum_{i=1}^{n} p = \\frac{np}{n} = p$$\n由于 $E[\\hat{p}] = p$，样本比例 $\\hat{p}$ 是总体比例 $p$ 的一个无偏估计量。\n\n为了求出估计量的方差，我们使用方差的性质。由于试验 $X_i$ 是独立的，它们的和的方差等于它们方差的和：\n$$Var(\\hat{p}) = Var\\left(\\frac{1}{n}\\sum_{i=1}^{n} X_i\\right) = \\frac{1}{n^2} Var\\left(\\sum_{i=1}^{n} X_i\\right) = \\frac{1}{n^2}\\sum_{i=1}^{n} Var(X_i)$$\n$$Var(\\hat{p}) = \\frac{1}{n^2}\\sum_{i=1}^{n} p(1-p) = \\frac{np(1-p)}{n^2} = \\frac{p(1-p)}{n}$$\n估计量的方差是 $\\frac{p(1-p)}{n}$。估计量的标准差，即比例的标准误，是 $\\sqrt{\\frac{p(1-p)}{n}}$。\n\n**第2部分：95%置信区间的推导**\n\n中心极限定理（CLT）指出，对于足够大的样本量 $n$，样本均值（或比例）$\\hat{p}$ 的抽样分布近似于正态分布。该分布的均值为 $E[\\hat{p}]=p$，方差为 $Var(\\hat{p})=\\frac{p(1-p)}{n}$。因此，我们可以陈述：\n$$\\hat{p} \\approx \\mathcal{N}\\left(p, \\frac{p(1-p)}{n}\\right)$$\n为了构建置信区间，我们将 $\\hat{p}$ 标准化以获得一个标准正态变量 $Z$：\n$$Z = \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\approx \\mathcal{N}(0,1)$$\n一个双侧 $95\\%$ 置信区间由这样的 $p$ 值定义：对于这些 $p$ 值，观测到的 $\\hat{p}$ 不在其抽样分布的极端 $5\\%$ 范围内。这对应于标准正态变量 $Z$ 介于 $-z_{\\alpha/2}$ 和 $+z_{\\alpha/2}$ 之间，其中 $1-\\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。来自标准正态分布的临界值为 $z_{0.025} \\approx 1.96$。\n\n因此我们可以写出概率陈述：\n$$P\\left(-z_{0.025} \\leq \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\leq z_{0.025}\\right) \\approx 0.95$$\n为了分离出 $p$ 并形成一个区间，我们注意到标准误项 $\\sqrt{\\frac{p(1-p)}{n}}$ 本身依赖于未知参数 $p$。对于大的 $n$，我们可以用估计量 $\\hat{p}$ 替代 $p$ 来近似标准误。这得到了估计的标准误 $SE(\\hat{p})$：\n$$SE(\\hat{p}) = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$$\n然后通过重新整理不等式来构建近似置信区间：\n$$\\hat{p} - z_{0.025} \\cdot SE(\\hat{p}) \\leq p \\leq \\hat{p} + z_{0.025} \\cdot SE(\\hat{p})$$\n代入 $\\hat{p}$ 和 $SE(\\hat{p})$ 的表达式，$p$ 的 $95\\%$ 置信区间的通用公式为：\n$$\\frac{x}{n} \\pm z_{0.025} \\sqrt{\\frac{\\frac{x}{n}\\left(1-\\frac{x}{n}\\right)}{n}}$$\n使用 $z_{0.025} \\approx 1.96$，区间变为：\n$$\\hat{p} \\pm 1.96 \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$$\n\n**第3部分：数值计算**\n\n给定数据：$n=500$ 和 $x=100$。\n估计量的观测值为：\n$$\\hat{p} = \\frac{100}{500} = 0.2$$\n正态近似的条件已满足，因为 $n\\hat{p} = 500 \\times 0.2 = 100 > 5$ 且 $n(1-\\hat{p}) = 500 \\times 0.8 = 400 > 5$。\n\n首先，我们计算估计的标准误：\n$$SE(\\hat{p}) = \\sqrt{\\frac{0.2(1-0.2)}{500}} = \\sqrt{\\frac{0.2 \\times 0.8}{500}} = \\sqrt{\\frac{0.16}{500}} = \\sqrt{0.00032}$$\n$$SE(\\hat{p}) \\approx 0.0178885$$\n接下来，我们计算 $95\\%$ 置信区间的误差范围（ME）：\n$$ME = 1.96 \\times SE(\\hat{p}) \\approx 1.96 \\times 0.0178885 \\approx 0.03506154$$\n置信区间为 $\\hat{p} \\pm ME$：\n$$CI_{95\\%} = 0.2 \\pm 0.03506154$$\n下端点：\n$$L = 0.2 - 0.03506154 = 0.16493846$$\n上端点：\n$$U = 0.2 + 0.03506154 = 0.23506154$$\n问题要求将每个端点四舍五入到四位有效数字。\n将下端点四舍五入：$0.16493846 \\rightarrow 0.1649$。\n将上端点四舍五入：$0.23506154 \\rightarrow 0.2351$。\n\n总体耐药比例 $p$ 的 $95\\%$ 置信区间约为 $(0.1649, 0.2351)$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.1649  0.2351 \\end{pmatrix}}$$", "id": "4527010"}, {"introduction": "从测量转向策略，风险分层筛查是未来预防医学的一个重要趋势。本练习利用贝叶斯定理，揭示了疾病患病率与筛查试验预测价值之间的关键联系[@problem_id:4527017]。理解这一原理对于设计高效的筛查方案至关重要，这些方案通过靶向高风险人群，在节约资源的同时实现最大的健康影响。", "problem": "一个正在规划下一代、风险分层的预防医学筛查的卫生系统，正在考虑靶向选择（例如，使用多基因风险评分和连续数字表型分析）将如何改变疾病的验前概率。令 $D$ 表示个体患有所筛查的疾病这一事件，令 $T^{+}$ 表示二元筛查测试的阳性结果。阳性预测值（PPV）定义为 $PPV = P(D \\mid T^{+})$。筛查测试的灵敏度（Se）和特异度（Sp）分别定义为 $Se = P(T^{+} \\mid D)$ 和 $Sp = P(T^{-} \\mid \\overline{D})$，其中 $\\overline{D}$ 表示 $D$ 的补集。\n\n仅从 Bayes 定理和全概率定律出发，代数推导 $PPV$ 如何依赖于该二元筛查测试的疾病患病率 $P(D)$、$Se$ 和 $Sp$。然后，假设 $Se$ 和 $Sp$ 是测试的固定特性，而患病率 $P(D)$ 因风险分层而变化，计算导数 $\\frac{d\\,PPV}{d\\,P(D)}$ 的封闭形式。将您的最终答案表示为关于 $Se$、$Sp$ 和 $P(D)$ 的单个解析表达式。最终表达式不需要四舍五入，也不需要单位。", "solution": "该问题是有效的，因为它在科学上基于概率论和流行病学的原理，问题提出得当并提供了所有必要信息，并且完全客观。\n\n第一个任务是根据疾病患病率 $P(D)$、灵敏度（$Se$）和特异度（$Sp$）推导阳性预测值（$PPV$）的代数表达式。我们从 $PPV$ 的定义开始：\n$$PPV = P(D \\mid T^{+})$$\n其中 $D$ 是患有该疾病的事件，$T^{+}$ 是测试结果为阳性的事件。\n\n使用 Bayes 定理，我们可以将此条件概率表示为：\n$$P(D \\mid T^{+}) = \\frac{P(T^{+} \\mid D) P(D)}{P(T^{+})}$$\n\n分子中的各项是已知的或与已知量直接相关。$P(T^{+} \\mid D)$ 是灵敏度 $Se$ 的定义。$P(D)$ 是疾病的患病率。因此，分子是 $Se \\cdot P(D)$。\n\n分母 $P(T^{+})$ 是测试结果为阳性的总概率。我们可以使用全概率定律展开此项，以个体是否患有疾病（$D$）或未患病（$\\overline{D}$）为条件：\n$$P(T^{+}) = P(T^{+} \\mid D) P(D) + P(T^{+} \\mid \\overline{D}) P(\\overline{D})$$\n\n我们可以将已知量代入此表达式中：\n1. $P(T^{+} \\mid D) = Se$ (灵敏度)。\n2. $P(D)$ 是患病率。\n3. $P(\\overline{D}) = 1 - P(D)$，因为 $\\overline{D}$ 是 $D$ 的补集。\n4. $P(T^{+} \\mid \\overline{D})$ 必须从特异度 $Sp$ 推导得出。特异度定义为 $Sp = P(T^{-} \\mid \\overline{D})$，其中 $T^{-}$ 是阴性测试结果。由于测试是二元的，对于没有疾病的人，测试结果只能是阳性或阴性。因此，$P(T^{+} \\mid \\overline{D}) + P(T^{-} \\mid \\overline{D}) = 1$。这给了我们 $P(T^{+} \\mid \\overline{D}) = 1 - Sp$。此项也称为假阳性率。\n\n将这些分量代回 $P(T^{+})$ 的方程中，得到：\n$$P(T^{+}) = Se \\cdot P(D) + (1 - Sp) (1 - P(D))$$\n\n现在，我们将分子和分母的表达式代回 $PPV$ 的 Bayes 定理公式中：\n$$PPV = \\frac{Se \\cdot P(D)}{Se \\cdot P(D) + (1 - Sp) (1 - P(D))}$$\n这就是所需的 $PPV$ 作为 $P(D)$、$Se$ 和 $Sp$ 的函数的表达式。\n\n第二个任务是计算导数 $\\frac{d\\,PPV}{d\\,P(D)}$，假设 $Se$ 和 $Sp$ 是固定常数。为方便起见，令 $p = P(D)$。$PPV$ 的表达式变为：\n$$PPV(p) = \\frac{Se \\cdot p}{Se \\cdot p + (1 - Sp)(1 - p)}$$\n为了求关于 $p$ 的导数，我们使用除法定则，即对于函数 $f(p) = \\frac{u(p)}{v(p)}$，其导数为 $f'(p) = \\frac{u'(p)v(p) - u(p)v'(p)}{[v(p)]^2}$。\n\n我们定义分子和分母函数：\n- $u(p) = Se \\cdot p$\n- $v(p) = Se \\cdot p + (1 - Sp)(1 - p)$\n\n首先，我们求它们关于 $p$ 的导数：\n- $u'(p) = \\frac{d}{dp}(Se \\cdot p) = Se$\n- 为了求 $v'(p)$，我们可以先展开 $v(p)$：\n  $v(p) = Se \\cdot p + 1 - p - Sp + Sp \\cdot p = (Se + Sp - 1)p + (1 - Sp)$\n  然后，导数是：\n  $v'(p) = \\frac{d}{dp}((Se + Sp - 1)p + (1 - Sp)) = Se + Sp - 1$\n\n现在，我们应用除法定则：\n$$\\frac{d(PPV)}{dp} = \\frac{u'(p)v(p) - u(p)v'(p)}{[v(p)]^2}$$\n$$\\frac{d(PPV)}{dp} = \\frac{(Se)[Se \\cdot p + (1 - Sp)(1 - p)] - (Se \\cdot p)(Se + Sp - 1)}{[Se \\cdot p + (1 - Sp)(1 - p)]^2}$$\n\n我们来简化分子：\n分子 $= Se \\cdot [Se \\cdot p + (1 - Sp)(1-p)] - Se \\cdot p \\cdot (Se + Sp - 1)$\n分子 $= Se^2 \\cdot p + Se(1 - Sp)(1-p) - Se^2 \\cdot p - Se \\cdot Sp \\cdot p + Se \\cdot p$\n分子 $= Se(1 - Sp)(1 - p) - Se \\cdot Sp \\cdot p + Se \\cdot p$\n分子 $= Se(1 - Sp - p + p \\cdot Sp) - Se \\cdot Sp \\cdot p + Se \\cdot p$\n分子 $= Se - Se \\cdot Sp - Se \\cdot p + Se \\cdot p \\cdot Sp - Se \\cdot Sp \\cdot p + Se \\cdot p$\n\n让我们使用 $v(p)$ 的简化形式来更方便地对分子进行代数操作：\n分子 $= u'v - uv'$\n分子 $= Se \\cdot [(Se + Sp - 1)p + (1 - Sp)] - (Se \\cdot p)(Se + Sp - 1)$\n分子 $= Se(Se + Sp - 1)p + Se(1 - Sp) - Se(Se + Sp - 1)p$\n第一项和第三项相互抵消，剩下：\n分子 $= Se(1 - Sp)$\n\n分母是 $[v(p)]^2$。将 $v(p)$ 的原始表达式和 $p=P(D)$ 代入，我们得到导数的最终表达式：\n$$\\frac{d\\,PPV}{d\\,P(D)} = \\frac{Se(1 - Sp)}{[Se \\cdot P(D) + (1 - Sp)(1 - P(D))]^2}$$\n这是阳性预测值关于疾病患病率的导数的封闭形式解析表达式。", "answer": "$$ \\boxed{\\frac{Se(1 - Sp)}{[Se \\cdot P(D) + (1 - Sp)(1 - P(D))]^{2}}} $$", "id": "4527017"}, {"introduction": "在制定了干预策略后，我们必须评估其长期价值。预防性干预通常需要前期投入以换取未来的健康效益，因此需要一个系统的方法来衡量这项投资是否值得[@problem_id:4527040]。本练习介绍卫生经济学中的核心概念——贴现，用于将未来的健康收益（质量调整生命年，即 $QALY$）和成本换算成当下的价值。掌握这项技能对于论证公共卫生投资的合理性与优先排序至关重要。", "problem": "一个城市的卫生部门计划推广一项精准预防项目，该项目利用持续的数字监控和行为助推来降低心脏代谢风险。为了在标准跨期决策框架下评估其长期价值，假设一个恒定的年贴现率 $r=0.03$，采用按年离散复利和年末计息的方式。对于一个代表性参与者，该项目预计在 $t=10$ 年的时间跨度内，每年产生 $0.2$ 个质量调整生命年（QALY）的恒定流，并且每年需要 $C=5000$ 美元的恒定成本流。质量调整生命年（QALY）被定义为健康状态效用对时间的积分，因此恒定的增量效用流会产生单位时间内恒定的 QALY 累积。\n\n从基本定义出发，即在第 $k$ 年末收到的一笔未来量 $X$ 的现值等于 $X$ 乘以贴现因子，并使用在恒定时间偏好下的离散时间贴现的一般定义，从第一性原理推导出一个有限时间跨度内恒定年末流的现值的封闭式表达式。然后应用该表达式计算给定流和时间跨度下 QALY 的现值和成本的现值。\n\n将你的最终数值结果以一个双元素行矩阵的形式报告，其中第一个元素等于 QALY 的现值（单位为 QALY），第二个元素等于成本的现值（单位为美元）。将每个元素四舍五入至四位有效数字。不要在矩阵内包含单位。", "solution": "核心目标是评估在离散时间贴现下，有限时间跨度内每年年末发生的恒定流的价值。我们从两个基本定义开始。\n\n首先，质量调整生命年（QALY）是健康状态效用对时间的积分。当一项干预措施产生恒定的增量效用流，并以恒定速率转换为 QALY 时，在 $n$ 年内的未贴现 QALY 累积量是年 QALY 增量的 $n$ 倍。在本问题中，年增量为每年 $0.2$ QALY。\n\n其次，在恒定年贴现率 $r$ 的离散时间贴现下，于第 $k$ 年末收到的一笔量 $X$ 的现值由 $X$ 乘以贴现因子 $d_{k}$ 给出，其中\n$$\nd_{k} = \\frac{1}{(1+r)^{k}}。\n$$\n这源于基本的时间偏好和资本机会成本原理：未来实现的单位收益在今天的价值会降低，降低的因子等于总累积因子 $(1+r)$ 应用 $k$ 个周期的倒数。\n\n考虑一个为期 $n$ 年、每年金额为 $A$ 的恒定年末流。其现值 $\\mathrm{PV}(A;n,r)$ 为\n$$\n\\mathrm{PV}(A;n,r) = \\sum_{k=1}^{n} \\frac{A}{(1+r)^{k}} = A \\sum_{k=1}^{n} \\left(\\frac{1}{1+r}\\right)^{k}。\n$$\n令 $q = \\frac{1}{1+r}$。该和是一个首项为 $q$、公比为 $q$、项数为 $n$ 的有限几何级数。根据几何级数求和公式可得\n$$\n\\sum_{k=1}^{n} q^{k} = q \\cdot \\frac{1 - q^{n}}{1 - q}。\n$$\n代入 $q = \\frac{1}{1+r}$ 可得\n$$\n\\sum_{k=1}^{n} \\left(\\frac{1}{1+r}\\right)^{k}\n= \\frac{1}{1+r} \\cdot \\frac{1 - \\left(\\frac{1}{1+r}\\right)^{n}}{1 - \\frac{1}{1+r}}\n= \\frac{1 - (1+r)^{-n}}{r}。\n$$\n因此，恒定年末流的现值的封闭式表达式为\n$$\n\\mathrm{PV}(A;n,r) = A \\cdot \\frac{1 - (1+r)^{-n}}{r}。\n$$\n\n我们现在将此公式应用于问题中的两个流，其中 $r=0.03$ 且 $n=t=10$：\n- 年 QALY 流：$A_{Q} = 0.2$ QALY/年。\n- 年成本流：$A_{C} = 5000$ 美元/年。\n\n首先计算公共现值因子 $S(n,r)$：\n$$\nS(10,0.03) = \\frac{1 - (1+0.03)^{-10}}{0.03}。\n$$\n计算 $(1+0.03)^{10}$：\n$$\n(1.03)^{10} \\approx 1.3439163793,\n$$\n所以\n$$\n(1.03)^{-10} \\approx \\frac{1}{1.3439163793} \\approx 0.744094。\n$$\n然后\n$$\n1 - (1.03)^{-10} \\approx 1 - 0.744094 = 0.255906,\n$$\n且\n$$\nS(10,0.03) \\approx \\frac{0.255906}{0.03} \\approx 8.5302。\n$$\n\nQALY 的现值：\n$$\n\\mathrm{PV}_{\\text{QALY}} = A_{Q} \\cdot S(10,0.03) \\approx 0.2 \\times 8.5302 = 1.70604 \\text{ QALYs}。\n$$\n四舍五入到四位有效数字：\n$$\n\\mathrm{PV}_{\\text{QALY}} \\approx 1.706 \\text{ QALYs}。\n$$\n\n成本的现值：\n$$\n\\mathrm{PV}_{\\text{Cost}} = A_{C} \\cdot S(10,0.03) \\approx 5000 \\times 8.5302 = 42651 \\text{ 美元}。\n$$\n四舍五入到四位有效数字，结果是\n$$\n\\mathrm{PV}_{\\text{Cost}} \\approx 4.265 \\times 10^{4} \\text{ 美元}。\n$$\n\n根据报告要求，我们将这两个结果表示为一个行矩阵，第一个元素是 QALY 的现值（单位为 QALY），第二个元素是成本的现值（单位为美元），每个元素都四舍五入到四位有效数字，并在矩阵内省略单位。", "answer": "$$\\boxed{\\begin{pmatrix}1.706  4.265 \\times 10^{4}\\end{pmatrix}}$$", "id": "4527040"}]}