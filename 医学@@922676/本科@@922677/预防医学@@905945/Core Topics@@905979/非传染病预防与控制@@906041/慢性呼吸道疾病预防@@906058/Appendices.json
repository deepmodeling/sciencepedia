{"hands_on_practices": [{"introduction": "在预防医学中，筛查是识别未诊断疾病的关键策略。然而，一个筛查工具的真实价值不仅取决于其固有的准确性，还取决于其在特定人群中的表现。本练习 [@problem_id:4510597] 将通过构建一个$2 \\times 2$列联表，从第一性原理出发，指导您计算阳性预测值 (PPV) 和阴性预测值 (NPV)，这两个指标对于理解筛查在现实世界中的有效性至关重要。", "problem": "一个社区健康项目实施一项筛查问卷，以识别未确诊的慢性阻塞性肺疾病（COPD）。在一家预防医学诊所的 $1{,}000$ 名成年人中，流行病学监测表明有 $20\\%$ 的人患有未确诊的 COPD。与确诊性诊断肺功能测定标准相比，该筛查问卷的灵敏度为 $80\\%$，特异性为 $85\\%$。\n\n仅使用灵敏度是患病者筛查测试呈阳性的概率，特异性是未患病者筛查测试呈阴性的概率这些核心定义，通过构建该队列中真阳性、假阳性、真阴性和假阴性的 $2 \\times 2$ 分类计数表，从基本原理推导出阳性预测值（PPV）和阴性预测值（NPV）。\n\n请按 PPV、NPV 的顺序报告最终结果。将答案表示为小数，并保留 $4$ 位有效数字。", "solution": "该问题有效，因其具有科学依据、提问清晰、客观，并为获得唯一解提供了所有必要数据。\n\n设 $N$ 为队列中的成年人总数，$D$ 表示个体患有慢性阻塞性肺疾病（COPD）的事件，$D^c$ 表示个体未患有 COPD 的事件。设 $T^+$ 表示筛查测试结果为阳性的事件，$T^-$ 表示结果为阴性的事件。\n\n给定的参数如下：\n- 队列总人数：$N = 1000$\n- COPD 患病率：$P(D) = 0.20$\n- 测试的灵敏度：$Sens = P(T^+ | D) = 0.80$\n- 测试的特异性：$Spec = P(T^- | D^c) = 0.85$\n\n问题要求通过构建一个 $2 \\times 2$ 分类计数表，从基本原理推导出阳性预测值（$PPV = P(D|T^+)$）和阴性预测值（$NPV = P(D^c|T^-)$）。\n\n首先，我们确定在 $1000$ 人的队列中患有和未患有 COPD 的人数。\n- 患有 COPD 的人数（存在疾病）：\n$$N_D = N \\times P(D) = 1000 \\times 0.20 = 200$$\n- 未患有 COPD 的人数（不存在疾病）：\n$$N_{D^c} = N \\times P(D^c) = N \\times (1 - P(D)) = 1000 \\times (1 - 0.20) = 1000 \\times 0.80 = 800$$\n\n接下来，我们计算分类表的四个计数：真阳性（$TP$）、假阴性（$FN$）、真阴性（$TN$）和假阳性（$FP$）。\n\n- 真阳性（$TP$）：患有 COPD 且测试呈阳性的个体。这是使用灵敏度计算的。\n$$TP = N_D \\times Sens = 200 \\times 0.80 = 160$$\n- 假阴性（$FN$）：患有 COPD 但测试呈阴性的个体。\n$$FN = N_D \\times (1 - Sens) = 200 \\times (1 - 0.80) = 200 \\times 0.20 = 40$$\n作为检验，$TP + FN = 160 + 40 = 200$，这是患有 COPD 的总人数。\n\n- 真阴性（$TN$）：未患有 COPD 且测试呈阴性的个体。这是使用特异性计算的。\n$$TN = N_{D^c} \\times Spec = 800 \\times 0.85 = 680$$\n- 假阳性（$FP$）：未患有 COPD 但测试呈阳性的个体。\n$$FP = N_{D^c} \\times (1 - Spec) = 800 \\times (1 - 0.85) = 800 \\times 0.15 = 120$$\n作为检验，$TN + FP = 680 + 120 = 800$，这是未患有 COPD 的总人数。\n\n得到的 $2 \\times 2$ 计数表如下：\n\n| | 测试阳性 ($T^+$) | 测试阴性 ($T^-$) | 行总计 |\n|---|---|---|---|\n| 患病 ($D$) | $TP = 160$ | $FN = 40$ | $200$ |\n| 未患病 ($D^c$) | $FP = 120$ | $TN = 680$ | $800$ |\n| 列总计 | $280$ | $720$ | $N=1000$ |\n\n从这个表中，我们可以计算出阳性测试和阴性测试的总数：\n- 阳性测试总数：$TP + FP = 160 + 120 = 280$\n- 阴性测试总数：$FN + TN = 40 + 680 = 720$\n\n现在，我们使用它们的定义来推导 PPV 和 NPV。\n\n阳性预测值（$PPV$）是指测试结果呈阳性的人真正患有该疾病的概率。它是真阳性数与阳性测试总数的比值。\n$$PPV = P(D|T^+) = \\frac{TP}{TP + FP} = \\frac{160}{280} = \\frac{16}{28} = \\frac{4}{7}$$\n将此分数转换为小数约等于 $0.57142857...$。\n\n阴性预测值（$NPV$）是指测试结果呈阴性的人真正未患该疾病的概率。它是真阴性数与阴性测试总数的比值。\n$$NPV = P(D^c|T^-) = \\frac{TN}{TN + FN} = \\frac{680}{720} = \\frac{68}{72} = \\frac{17}{18}$$\n将此分数转换为小数约等于 $0.94444444...$。\n\n问题要求以保留 $4$ 位有效数字的小数形式报告结果。\n- $PPV = 0.57142857... \\approx 0.5714$\n- $NPV = 0.94444444... \\approx 0.9444$", "answer": "$$\\boxed{\\begin{pmatrix} 0.5714  0.9444 \\end{pmatrix}}$$", "id": "4510597"}, {"introduction": "比较不同人群（例如，一个年轻城市与一个退休社区）的疾病患病率是一项常见的流行病学任务，但年龄结构的差异可能会导致误导性结论。年龄标化是一种消除年龄这一混杂因素影响，从而实现公平比较的基本方法。本练习 [@problem_id:4510662] 将从总概率定律出发，推导并应用直接标化法，让您掌握调整患病率的核心技能。", "problem": "一个公共卫生团队正在评估不同年龄结构地区的慢性阻塞性肺疾病（COPD）预防成果。为了以独立于年龄构成的方式比较各地区间的COPD负担，该团队将采用直接年龄标化法。\n\n从基本原理出发，使用以下依据推导出COPD的直接年龄标化患病率的表达式：\n- 患病率的定义，即特定时间内患病个体的比例。\n- 将人群划分为互斥的年龄分层，其中年龄被视为一个分类变量。\n- 将全概率定律应用于以年龄分层为条件的患病事件。\n\n设存在 $k$ 个年龄分层，索引为 $i \\in \\{1,2,\\dots,k\\}$，其特定年龄患病率为 $p_{i}$，并选择一个标准人口，其年龄分布产生的权重为 $w_{i}$，满足 $\\sum_{i=1}^{k} w_{i} = 1$ 且对所有 $i$ 都有 $w_{i} \\ge 0$。请用 $\\{p_{i}\\}$ 和 $\\{w_{i}\\}$ 推导出直接年龄标化患病率 $p_{\\text{std}}$ 的解析表达式。\n\n然后，对于三个年龄分层，其特定年龄COPD患病率分别为 $p_{1} = 5\\%$、$p_{2} = 10\\%$ 和 $p_{3} = 20\\%$，标准人口的年龄权重分别为 $w_{1} = 0.5$、$w_{2} = 0.3$ 和 $w_{3} = 0.2$，请计算COPD的年龄标化患病率。请将您的最终答案表示为小数比例。", "solution": "该问题是有效的，因为它在科学上基于流行病学和概率论的既定原则，问题阐述清晰且提供了所有必要信息，语言客观。\n\n任务是首先从基本原理推导出直接年龄标化患病率 $p_{\\text{std}}$ 的表达式，然后计算一个具体案例中的值。\n\n**1. 直接年龄标化患病率公式的推导**\n\n设 $D$ 为从人群中随机选择一个个体患有慢性阻塞性肺疾病（COPD）的事件。该人群被划分为 $k$ 个互斥且穷尽的年龄分层。设 $A_i$ 为随机选择一个个体属于年龄分层 $i$ 的事件，其中 $i \\in \\{1, 2, \\dots, k\\}$。这些分层构成对总体的划分，这意味着 $\\bigcup_{i=1}^{k} A_i = \\Omega$ （其中 $\\Omega$ 是整个样本空间）且对于所有 $i \\neq j$ 都有 $A_i \\cap A_j = \\emptyset$。\n\n疾病的患病率定义为在特定时间点患有该疾病的个体所占的比例。这对应于概率 $P(D)$。分层 $i$ 的特定年龄患病率（记为 $p_i$）是指在个体属于年龄分层 $i$ 的条件下患病的条件概率。形式上，这表示为：\n$$p_i = P(D | A_i)$$\n\n全概率定律指出，事件 $D$ 的总概率可以通过将其在一组样本空间的划分上的条件概率求和得到。将此定律应用于事件 $D$ 和划分 $\\{A_i\\}_{i=1}^k$，一个群体中的总体患病率为：\n$$P(D) = \\sum_{i=1}^{k} P(D | A_i) P(A_i)$$\n在此表达式中，$P(A_i)$ 是年龄分层 $i$ 中人口的比例。\n\n直接年龄标化是一种计算患病率的方法，该患病率是在研究人群具有“标准”人群年龄结构的情况下预期观察到的率。这通过消除年龄的混杂效应，使得在不同人群之间比较疾病率成为可能。\n\n现选择一个标准人群，其中每个年龄分层 $i$ 的个体比例由权重 $w_i$ 给出。这些权重构成一个概率分布，因此它们必须满足对所有 $i$ 都有 $w_i \\ge 0$ 且 $\\sum_{i=1}^{k} w_i = 1$。因此，权重 $w_i$ 等同于标准人口年龄结构中的概率 $P(A_i)$。\n\n为了计算我们研究人群的直接年龄标化患病率 $p_{\\text{std}}$，我们将观察到的特定年龄患病率（$p_i$）应用于标准人口的年龄结构（$w_i$）。这是通过在全概率定律的公式中，用 $p_i$ 替换 $P(D|A_i)$，用 $w_i$ 替换 $P(A_i)$ 来实现的。这就得出了直接年龄标化患病率的表达式：\n$$p_{\\text{std}} = \\sum_{i=1}^{k} p_i w_i$$\n这个公式代表了特定年龄患病率的加权平均值，其中权重是标准人口中各年龄组的比例。\n\n**2. 年龄标化患病率的计算**\n\n题目为 $k=3$ 的三个年龄分层提供了以下数据：\n特定年龄COPD患病率：\n- $p_{1} = 5\\% = 0.05$\n- $p_{2} = 10\\% = 0.10$\n- $p_{3} = 20\\% = 0.20$\n\n标准人口年龄权重：\n- $w_{1} = 0.5$\n- $w_{2} = 0.3$\n- $w_{3} = 0.2$\n\n我们可以验证权重之和为1：$w_1 + w_2 + w_3 = 0.5 + 0.3 + 0.2 = 1.0$。\n\n使用推导出的 $k=3$ 时的 $p_{\\text{std}}$ 公式：\n$$p_{\\text{std}} = p_1 w_1 + p_2 w_2 + p_3 w_3$$\n\n将给定值代入表达式：\n$$p_{\\text{std}} = (0.05)(0.5) + (0.10)(0.3) + (0.20)(0.2)$$\n$$p_{\\text{std}} = 0.025 + 0.030 + 0.040$$\n$$p_{\\text{std}} = 0.095$$\n\n计算出的COPD直接年龄标化患病率为 $0.095$。题目要求答案以小数比例形式给出。", "answer": "$$\\boxed{0.095}$$", "id": "4510662"}, {"introduction": "预防工作的最终目标是降低疾病负担。我们如何量化一项干预措施（如戒烟计划）的预期效果？本练习将超越静态测量，带您进入动态建模的世界。通过此练习 [@problem_id:4510629]，您将学习如何模拟随着人们行为的改变，疾病发生率（在此案例中为慢阻肺急性加重）如何随时间变化，这为预测公共卫生干预措施的影响提供了强大的工具。", "problem": "我们对一个稳定的慢性阻塞性肺疾病（COPD）患者队列进行为期一个日历年的观察。假设持续吸烟者的年COPD急性加重发生率为 $r_0 = 0.8$ 次/人年。该队列中有一部分比例为 $q$ 的吸烟者在年内的某个时间点戒烟，假定戒烟时间在 $[0,1]$ 年的区间内均匀分布。戒烟后，个体的瞬时急性加重风险相对于持续吸烟者立即减半。未戒烟的个体在全年保持基线风险。\n\n利用以下基本事实：发生率是通过对风险期内的风险进行积分得到的单位时间预期计数，以及混合人群的平均发生率是各亚组特定预期计数的加权平均，请推导出该队列的预期年急性加重率 $R(q)$ 作为 $q$ 的函数。然后，评估当年度戒烟比例从 $q = 0.05$ 增加到 $q = 0.15$ 时，队列年COPD急性加重率的绝对降低值。请使用小数比例（不要使用百分号）。将您的最终数值答案四舍五入至四位有效数字，并以“次急性加重/人年”为单位表示最终的发生率降低值。", "solution": "该问题陈述经评估有效。它在流行病学原理上具有科学依据，内部一致，提法恰当，且客观。它包含了构建和求解模型所需的所有必要信息。\n\n该问题要求推导一个由持续吸烟者和年内戒烟者组成的队列的预期年COPD急性加重率 $R(q)$。队列的平均发生率是这两个亚组发生率的加权平均。\n\n设 $r_0$ 为持续吸烟者的年急性加重发生率，给定为 $r_0 = 0.8$ 次急性加重/人年。观察期为一年，即 $t \\in [0, 1]$。\n\n该队列被分为两组：\n1.  持续吸烟者，占队列的比例为 $1-q$。\n2.  戒烟者，占队列的比例为 $q$。\n\n持续吸烟者组在一年内的预期急性加重次数与其发生率 $r_0$ 和其在队列中的比例 $1-q$ 成正比。他们对队列平均发生率的贡献是 $(1-q)r_0$。\n\n对于戒烟者亚组中的一个个体，戒烟时间 $T_q$ 是在区间 $[0, 1]$ 上均匀分布的随机变量。$T_q$ 的概率密度函数为 $f(t_q) = 1$（当 $t_q \\in [0, 1]$ 时）及 $f(t_q) = 0$（其他情况）。\n\n对于在时间 $T_q$ 戒烟的个体，其瞬时风险率 $\\lambda(t)$ 是随时间变化的。戒烟前，其风险为 $r_0$。戒烟后，风险立即减半至 $r_0/2$。\n$$\n\\lambda(t | T_q) =\n\\begin{cases}\nr_0  \\text{for } 0 \\le t  T_q \\\\\n\\frac{r_0}{2}  \\text{for } T_q \\le t \\le 1\n\\end{cases}\n$$\n该个体在一年期间的预期急性加重次数是其风险函数在区间 $[0, 1]$ 上的积分。\n$$ E_{\\text{exac}}(T_q) = \\int_{0}^{1} \\lambda(t | T_q) dt = \\int_{0}^{T_q} r_0 dt + \\int_{T_q}^{1} \\frac{r_0}{2} dt $$\n$$ E_{\\text{exac}}(T_q) = r_0 [t]_{0}^{T_q} + \\frac{r_0}{2} [t]_{T_q}^{1} = r_0 T_q + \\frac{r_0}{2}(1 - T_q) $$\n$$ E_{\\text{exac}}(T_q) = r_0 T_q + \\frac{r_0}{2} - \\frac{r_0}{2} T_q = \\frac{r_0}{2} + \\frac{r_0}{2} T_q = \\frac{r_0}{2}(1 + T_q) $$\n为了求出戒烟者亚组中任意个体的平均预期急性加重次数，我们必须对 $E_{\\text{exac}}(T_q)$ 在戒烟时间 $T_q$ 的分布上求平均。\n$$ E_q = \\int_{0}^{1} E_{\\text{exac}}(t_q) f(t_q) dt_q = \\int_{0}^{1} \\frac{r_0}{2}(1 + t_q) \\cdot 1 \\, dt_q $$\n$$ E_q = \\frac{r_0}{2} \\int_{0}^{1} (1 + t_q) dt_q = \\frac{r_0}{2} \\left[ t_q + \\frac{t_q^2}{2} \\right]_{0}^{1} $$\n$$ E_q = \\frac{r_0}{2} \\left( (1 + \\frac{1^2}{2}) - (0 + \\frac{0^2}{2}) \\right) = \\frac{r_0}{2} \\left( 1 + \\frac{1}{2} \\right) = \\frac{r_0}{2} \\cdot \\frac{3}{2} = \\frac{3}{4}r_0 $$\n这就是戒烟者亚组中个体的平均年急性加重率。\n\n队列的总体预期年急性加重率 $R(q)$ 是两个亚组发生率的加权和。\n$$ R(q) = (\\text{proportion of smokers}) \\times (\\text{rate for smokers}) + (\\text{proportion of quitters}) \\times (\\text{rate for quitters}) $$\n$$ R(q) = (1-q)r_0 + q E_q = (1-q)r_0 + q\\left(\\frac{3}{4}r_0\\right) $$\n简化 $R(q)$ 的表达式：\n$$ R(q) = r_0 - qr_0 + \\frac{3}{4}qr_0 = r_0 - \\frac{1}{4}qr_0 $$\n$$ R(q) = r_0 \\left(1 - \\frac{q}{4}\\right) $$\n这就是队列的预期年急性加重率作为戒烟比例 $q$ 的函数。\n\n接下来，我们计算当戒烟比例从 $q_1 = 0.05$ 增加到 $q_2 = 0.15$ 时，队列年急性加重率的绝对降低值。降低值为 $\\Delta R = R(q_1) - R(q_2)$。\n$$ \\Delta R = R(0.05) - R(0.15) $$\n$$ \\Delta R = r_0 \\left(1 - \\frac{0.05}{4}\\right) - r_0 \\left(1 - \\frac{0.15}{4}\\right) $$\n$$ \\Delta R = r_0 \\left[ \\left(1 - \\frac{0.05}{4}\\right) - \\left(1 - \\frac{0.15}{4}\\right) \\right] $$\n$$ \\Delta R = r_0 \\left( 1 - \\frac{0.05}{4} - 1 + \\frac{0.15}{4} \\right) $$\n$$ \\Delta R = r_0 \\left( \\frac{0.15 - 0.05}{4} \\right) = r_0 \\left( \\frac{0.10}{4} \\right) $$\n代入给定值 $r_0 = 0.8$：\n$$ \\Delta R = 0.8 \\times \\left( \\frac{0.10}{4} \\right) = 0.8 \\times 0.025 $$\n$$ \\Delta R = 0.02 $$\n问题要求将答案四舍五入至四位有效数字。精确值为 $0.02$。为用四位有效数字表示，我们写作 $0.02000$。数字 $2$ 后面的尾随零是有效数字。单位是“次急性加重/人年”。", "answer": "$$\n\\boxed{0.02000}\n$$", "id": "4510629"}]}