{"hands_on_practices": [{"introduction": "心血管风险评估工具的核心是数学模型，它将个体的多种风险因素转化为一个具体的患病概率。本练习将揭开这一过程的神秘面纱，通过一个简化的、类似弗雷明汉研究的模型，您将亲手计算如何将年龄、胆固醇水平等临床数据，通过对数几率（logit）回归方程，最终转化为一个$10$年心血管事件的风险概率 [@problem_id:4507588]。这个实践将帮助您理解风险预测背后的基本数学原理。", "problem": "在预防医学中，广泛使用的心血管风险评估工具（例如源自弗拉明汉心脏研究的工具）通常使用广义线性模型进行风险预测，这些模型基于比数的定义，其中事件概率为 $p$ 的比数定义为 $\\frac{p}{1-p}$。考虑一个简化的、类似弗拉明汉研究的逻辑斯谛模型，其中个体发生10年期主要心血管事件的对数比数被假定为关键风险因素的自然对数和一个吸烟指示变量的线性函数：\n$$\n\\ln\\!\\left(\\frac{p}{1-p}\\right) = \\alpha + \\beta_{\\ln(\\text{age})}\\,\\ln(\\text{age}) + \\beta_{\\ln(\\text{TC})}\\,\\ln(\\text{TC}) + \\beta_{\\ln(\\text{HDL})}\\,\\ln(\\text{HDL}) + \\beta_{\\text{smoke}}\\,I_{\\text{smoke}},\n$$\n其中 $\\ln(\\cdot)$ 表示自然对数，$\\text{TC}$ 是总胆固醇，$\\text{HDL}$ 是高密度脂蛋白， $I_{\\text{smoke}}$ 是一个指示变量，如果此人当前吸烟，则等于 $1$，否则等于 $0$。假设截距为 $\\alpha=-5.0$，系数为 $\\beta_{\\ln(\\text{age})}=1.2$, $\\beta_{\\ln(\\text{TC})}=1.0$, $\\beta_{\\ln(\\text{HDL})}=-1.5$, $\\beta_{\\text{smoke}}=0.6$。对于一个年龄为 $55$ 岁，$\\text{TC}=220$ mg/dL，$\\text{HDL}=45$ mg/dL，并且当前是吸烟者（$I_{\\text{smoke}}=1$）的个体，计算其10年心血管事件概率 $p$。所有对数变换均使用自然对数。将最终风险表示为小数（不使用百分号），并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求使用给定的逻辑斯谛回归模型，为特定个体计算其10年心血管事件概率 $p$。\n\n该模型将事件比数的自然对数（称为对数比数或logit）定义为几个风险因素的线性组合：\n$$\n\\ln\\left(\\frac{p}{1-p}\\right) = \\alpha + \\beta_{\\ln(\\text{age})}\\,\\ln(\\text{age}) + \\beta_{\\ln(\\text{TC})}\\,\\ln(\\text{TC}) + \\beta_{\\ln(\\text{HDL})}\\,\\ln(\\text{HDL}) + \\beta_{\\text{smoke}}\\,I_{\\text{smoke}}\n$$\n设右侧的线性预测器用 $L$ 表示。\n$$\nL = \\alpha + \\beta_{\\ln(\\text{age})}\\,\\ln(\\text{age}) + \\beta_{\\ln(\\text{TC})}\\,\\ln(\\text{TC}) + \\beta_{\\ln(\\text{HDL})}\\,\\ln(\\text{HDL}) + \\beta_{\\text{smoke}}\\,I_{\\text{smoke}}\n$$\n问题给出了截距和系数的值：\n$\\alpha = -5.0$\n$\\beta_{\\ln(\\text{age})} = 1.2$\n$\\beta_{\\ln(\\text{TC})} = 1.0$\n$\\beta_{\\ln(\\text{HDL})} = -1.5$\n$\\beta_{\\text{smoke}} = 0.6$\n\n该个体的数据为：\nage $= 55$\nTC $= 220$\nHDL $= 45$\n$I_{\\text{smoke}} = 1$ （因为该个体是当前吸烟者）\n\n首先，我们将这些值代入线性预测器 $L$ 的表达式中：\n$$\nL = -5.0 + (1.2) \\cdot \\ln(55) + (1.0) \\cdot \\ln(220) + (-1.5) \\cdot \\ln(45) + (0.6) \\cdot 1\n$$\n我们计算风险因素的自然对数：\n$\\ln(55) \\approx 4.007333185$\n$\\ln(220) \\approx 5.393627735$\n$\\ln(45) \\approx 3.806662490$\n\n将这些值代入 L 的方程中：\n$$\nL \\approx -5.0 + (1.2)(4.007333185) + (1.0)(5.393627735) - (1.5)(3.806662490) + 0.6\n$$\n$$\nL \\approx -5.0 + 4.808799822 + 5.393627735 - 5.709993735 + 0.6\n$$\n$$\nL \\approx 0.092433822\n$$\n$L$ 和概率 $p$ 之间的关系由 $L = \\ln\\left(\\frac{p}{1-p}\\right)$ 给出。为了求出 $p$，我们必须对这个关系求逆。首先，我们对两边取指数：\n$$\n\\exp(L) = \\exp\\left(\\ln\\left(\\frac{p}{1-p}\\right)\\right) = \\frac{p}{1-p}\n$$\n量 $\\exp(L)$ 表示事件的比数。设 $O = \\exp(L)$。我们求解 $p$：\n$$\nO = \\frac{p}{1-p}\n$$\n$$\nO(1-p) = p\n$$\n$$\nO - O \\cdot p = p\n$$\n$$\nO = p + O \\cdot p = p(1+O)\n$$\n$$\np = \\frac{O}{1+O}\n$$\n将 $O = \\exp(L)$ 代回此表达式，我们得到逻辑斯谛函数：\n$$\np = \\frac{\\exp(L)}{1+\\exp(L)}\n$$\n现在，我们代入 $L$ 的计算数值：\n$$\np \\approx \\frac{\\exp(0.092433822)}{1+\\exp(0.092433822)}\n$$\n首先，我们计算指数项：\n$$\n\\exp(0.092433822) \\approx 1.0968255\n$$\n接下来，我们计算 $p$：\n$$\np \\approx \\frac{1.0968255}{1 + 1.0968255} = \\frac{1.0968255}{2.0968255}\n$$\n$$\np \\approx 0.5230867\n$$\n问题要求最终答案四舍五入到四位有效数字。$0.5230867$ 的前四位有效数字是 $5$、$2$、$3$ 和 $0$。第五位有效数字是 $8$，大于或等于 $5$，所以我们将第四位有效数字进位。\n$$\np \\approx 0.5231\n$$\n因此，该个体10年心血管事件的概率约为 $0.5231$。", "answer": "$$\\boxed{0.5231}$$", "id": "4507588"}, {"introduction": "风险评分的最终价值在于指导临床决策，例如决定是否启动预防性治疗。本练习将风险评估从理论计算推向临床应用，介绍循证医学中的一个关键指标——需治人数（NNT），并阐明它如何依赖于患者的基线风险 [@problem_id:4507603]。通过计算和比较不同风险水平患者的NNT，您将学会如何将抽象的风险概率转化为衡量治疗干预效益的具体指标。", "problem": "动脉粥样硬化性心血管疾病 (ASCVD) 风险评估工具，如合并队列方程 (PCE)，用于估计在指定时间范围内心血管事件的基线概率。考虑使用此类工具对两名患者进行 $10$ 年时间范围的评估。患者A的估计基线事件概率为 $0.15$，患者B的估计基线事件概率为 $0.05$。一种中等强度的他汀类药物预计将在该时间范围内使事件概率产生恒定的比例降低，表现为 $0.25$ 的相对风险降低，以乘法方式应用于每位患者的基线风险。\n\n仅使用绝对风险、相对风险和绝对风险降低的核心定义，推导并计算每位患者在 $10$ 年时间范围内的需治数 (NNT)。然后，通过计算患者B的NNT与患者A的NNT之比来量化这种比较。将每个计算量四舍五入至三位有效数字。所有答案均表示为无单位的实数。按以下顺序返回您的最终数值结果：基线为 $0.15$ 时的NNT，基线为 $0.05$ 时的NNT，以及比率 $\\text{NNT}_{0.05} / \\text{NNT}_{0.15}$。", "solution": "风险评估工具，如合并队列方程 (PCE)，提供在指定时间范围内的事件基线概率，我们将其表示为 $p$。他汀类药物的效果由相对风险降低来描述，表示为 $r$，它以乘法方式降低风险，因此治疗后的事件概率变为 $(1 - r)p$。绝对风险降低 (ARR) 是基线风险与治疗后风险之间的差值，由下式给出\n$$\n\\text{ARR} = p - (1 - r)p = rp.\n$$\n在指定时间范围内的需治数 (NNT) 定义为绝对风险降低的倒数：\n$$\nNNT = \\frac{1}{\\text{ARR}} = \\frac{1}{rp}.\n$$\n\n将这些定义应用于每位患者，其中 $r = 0.25$。\n\n对于患者A，其 $p_{A} = 0.15$：\n$$\n\\text{ARR}_{A} = r p_{A} = 0.25 \\times 0.15 = 0.0375,\n$$\n所以\n$$\nNNT_{A} = \\frac{1}{0.0375} = \\frac{1}{\\frac{3}{80}} = \\frac{80}{3} \\approx 26.666\\ldots.\n$$\n四舍五入至三位有效数字：\n$$\nNNT_{A} \\approx 26.7.\n$$\n\n对于患者B，其 $p_{B} = 0.05$：\n$$\n\\text{ARR}_{B} = r p_{B} = 0.25 \\times 0.05 = 0.0125,\n$$\n所以\n$$\nNNT_{B} = \\frac{1}{0.0125} = 80.\n$$\n四舍五入至三位有效数字：\n$$\nNNT_{B} = 80.0.\n$$\n\n为了比较大小，计算患者B的NNT与患者A的NNT之比：\n$$\n\\frac{NNT_{B}}{NNT_{A}} = \\frac{\\frac{1}{r p_{B}}}{\\frac{1}{r p_{A}}} = \\frac{p_{A}}{p_{B}} = \\frac{0.15}{0.05} = 3.\n$$\n四舍五入至三位有效数字：\n$$\n\\frac{NNT_{B}}{NNT_{A}} = 3.00.\n$$\n\n因此，患者A的NNT较低，因为在较高的基线风险下，绝对风险降低更大。比较比率表明，在所述假设下，要预防一个事件，患者B在 $10$ 年时间范围内需要的治疗次数大约是患者A的三倍。", "answer": "$$\\boxed{\\begin{pmatrix}26.7  80.0  3.00\\end{pmatrix}}$$", "id": "4507603"}, {"introduction": "在临床上广泛应用一个风险模型之前，我们必须严格评估其预测性能。本练习聚焦于模型的一个关键性能维度：区分度（discrimination），即模型区分高风险和低风险个体的能力 [@problem_id:4507643]。通过从最基本的定义出发，手动计算受试者工作特征曲线下面积（AUC），您将对这个评估模型性能的常用指标建立起深刻而直观的理解，明白AUC值$1.0$的完美区分究竟意味着什么。", "problem": "在预防医学中，心血管疾病风险预测模型的评估标准是其将发生事件的个体排在不发生事件的个体之前的能力。受试者工作特征曲线下面积（AUC）是受试者工作特征（ROC）曲线下的面积，其中ROC曲线绘制了当决策阈值在分数范围内变化时，真阳性率与假阳性率的关系。一个基础性结论将$AUC$与一个随机选择的病例（事件）的预测风险评分高于一个随机选择的对照（非事件）的概率联系起来，当出现评分相同时，给予二分之一的分值。\n\n考虑一个心血管风险评估工具，其输出在$[0,1]$范围内的连续评分。你有一个小型验证样本，其中病例评分为 $\\{0.8, 0.7, 0.6\\}$，对照评分为 $\\{0.4, 0.5, 0.3\\}$。根据上述核心定义，使用$AUC$的配对比较解释，通过枚举所有病例-对照对来计算$AUC$，如果病例评分超过对照评分，则赋值为$1$，如果小于，则为$0$，如果相等，则为$\\frac{1}{2}$。将最终的$AUC$报告为一个精确的小数，无需四舍五入。", "solution": "该问题是有效的，因为它在科学上基于受试者工作特征（ROC）曲线分析的统计原理，问题陈述清晰，包含所有必要数据和明确的目标，并以精确、客观的语言表达。\n\n受试者工作特征曲线下面积（AUC）可以解释为从病例组（阳性类）中随机选择一个个体比从对照组（阴性类）中随机选择一个个体具有更高风险评分的概率。问题陈述了这种解释，为每个病例-对照对的比较定义了一个分数：如果病例分数更高则为$1$，如果对照分数更高则为$0$，如果分数相同则为$\\frac{1}{2}$。AUC是这些分数在所有可能配对上的平均值。\n\n设 $S_{case}$ 为病例的风险评分集合， $S_{control}$ 为对照的风险评分集合。\n给定数据为：\n$$ S_{case} = \\{0.8, 0.7, 0.6\\} $$\n$$ S_{control} = \\{0.4, 0.5, 0.3\\} $$\n\n病例数为 $n_{case} = |S_{case}| = 3$。\n对照数为 $n_{control} = |S_{control}| = 3$。\n\n唯一的病例-对照对的总数是病例数和对照数的乘积：\n$$ N_{pairs} = n_{case} \\times n_{control} = 3 \\times 3 = 9 $$\n\n我们现在必须枚举所有$9$个配对，并根据病例评分$s_c$和对照评分$s_k$的比较为每个配对赋分。设$I(s_c, s_{k})$为给定配对的分数。\n$$ I(s_c, s_k) = \\begin{cases} 1  \\text{若 } s_c  s_k \\\\ 0.5  \\text{若 } s_c = s_k \\\\ 0  \\text{若 } s_c  s_k \\end{cases} $$\n\n总分$\\Sigma_{scores}$是通过将每个病例评分与每个对照评分进行比较来计算的。\n\n1.  病例评分 $s_c = 0.8$ 的比较：\n    -   配对 $(0.8, 0.4)$: $0.8  0.4$，分数为$1$。\n    -   配对 $(0.8, 0.5)$: $0.8  0.5$，分数为$1$。\n    -   配对 $(0.8, 0.3)$: $0.8  0.3$，分数为$1$。\n    -   $s_c=0.8$ 的小计为 $1+1+1=3$。\n\n2.  病例评分 $s_c = 0.7$ 的比较：\n    -   配对 $(0.7, 0.4)$: $0.7  0.4$，分数为$1$。\n    -   配对 $(0.7, 0.5)$: $0.7  0.5$，分数为$1$。\n    -   配对 $(0.7, 0.3)$: $0.7  0.3$，分数为$1$。\n    -   $s_c=0.7$ 的小计为 $1+1+1=3$。\n\n3.  病例评分 $s_c = 0.6$ 的比较：\n    -   配对 $(0.6, 0.4)$: $0.6  0.4$，分数为$1$。\n    -   配对 $(0.6, 0.5)$: $0.6  0.5$，分数为$1$。\n    -   配对 $(0.6, 0.3)$: $0.6  0.3$，分数为$1$。\n    -   $s_c=0.6$ 的小计为 $1+1+1=3$。\n\n没有任何配对的评分相等，因此没有使用$\\frac{1}{2}$的条件。\n所有配对的总分是：\n$$ \\Sigma_{scores} = 3 + 3 + 3 = 9 $$\n\nAUC是总分除以总配对数：\n$$ AUC = \\frac{\\Sigma_{scores}}{N_{pairs}} = \\frac{9}{9} = 1 $$\n\n在这个特定样本中，每个病例的评分都高于每个对照的评分，这表明该风险评估工具对这个数据集具有完美的区分能力。这导致AUC为$1$。问题要求答案为一个精确的小数。\n\n$$ AUC = 1.0 $$", "answer": "$$\\boxed{1.0}$$", "id": "4507643"}]}