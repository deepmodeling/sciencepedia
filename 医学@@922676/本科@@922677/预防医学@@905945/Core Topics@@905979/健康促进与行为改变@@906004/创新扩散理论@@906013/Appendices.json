{"hands_on_practices": [{"introduction": "许多社会和生物过程，从思想的传播到人口的增长，都遵循着一条独特的S形曲线。本练习将指导您从一个关于采纳行为如何通过模仿传播的直观假设出发，推导出这个著名的逻辑斯谛增长模型。掌握这一推导过程，将使您对许多扩散现象背后的数学引擎有深刻的理解 [@problem_id:4520329]。", "problem": "一个公共卫生部门正在监测初级保健诊所对一项新的预防性干预清单的采纳情况。设 $S(t)$ 表示到时间 $t$ (以月为单位) 为止已采纳该清单的诊所累计数量。假设可能最终采纳的诊所总数为 $K$，并设 $S(0) = S_{0}$。根据创新扩散理论的精神，假设采纳行为主要由诊所间的人际影响驱动：未采纳诊所的瞬时采纳率与当前已采纳诊所的数量和剩余未采纳诊所的数量均成正比。仅使用此假设和标准微积分，推导采纳轨迹 $S(t)$ 的闭合形式解，并证明其具有S形曲线的形状。识别出对应于饱和水平 $K$、内在采纳速度 $r$ 和拐点时间 $t_{0}$ 的参数。\n\n然后，考虑一个具体的推广案例，其中有 $K = 1200$ 家诊所，基线采纳数为 $S(0) = 30$，6个月后观察到的采纳数为 $S(6) = 180$。使用你推导出的模型：\n- 用 $K$、$S_{0}$ 和观察到的 $S(6)$ 表示 $r$ 和 $t_{0}$，然后计算它们的数值。\n- 计算采纳数达到 $0.8K$ 时的时间 $t$。\n\n将你最终的 $t$ 的数值答案四舍五入到四位有效数字，并以月为单位表示时间。不要使用百分号；将 $0.8$ 视为小数。", "solution": "该问题提法清晰，有科学依据，并包含足够的信息以获得唯一解。所描述的模型是经典的逻辑斯蒂增长模型，广泛用于建模扩散过程。\n\n首先，我们推导采纳轨迹 $S(t)$ 的通用闭合形式解。问题陈述指出，瞬时采纳率 $\\frac{dS}{dt}$ 与当前采纳者数量 $S$ 和剩余未采纳者数量 $K-S$ 均成正比。我们可以将其写成一个微分方程：\n$$\n\\frac{dS}{dt} = p S(K-S)\n$$\n其中 $p$ 是一个与采纳率相关的比例常数。这是一个可分离变量的微分方程。我们可以重新整理它来分离变量 $S$ 和 $t$：\n$$\n\\frac{dS}{S(K-S)} = p \\, dt\n$$\n为了对左侧进行积分，我们使用部分分式分解。设\n$$\n\\frac{1}{S(K-S)} = \\frac{A}{S} + \\frac{B}{K-S}\n$$\n两边乘以 $S(K-S)$ 得到 $1 = A(K-S) + BS$。\n令 $S=0$ 得出 $1 = AK$，所以 $A = \\frac{1}{K}$。\n令 $S=K$ 得出 $1 = BK$，所以 $B = \\frac{1}{K}$。\n因此，方程变为：\n$$\n\\frac{1}{K} \\left( \\frac{1}{S} + \\frac{1}{K-S} \\right) dS = p \\, dt\n$$\n对两边进行积分：\n$$\n\\int \\frac{1}{K} \\left( \\frac{1}{S} + \\frac{1}{K-S} \\right) dS = \\int p \\, dt\n$$\n$$\n\\frac{1}{K} \\left( \\ln|S| - \\ln|K-S| \\right) = pt + C_1\n$$\n其中 $C_1$ 是积分常数。由于 $S$ 代表诊所的数量，$0 \\le S \\le K$，我们可以去掉绝对值符号。\n$$\n\\ln\\left(\\frac{S}{K-S}\\right) = Kpt + KC_1\n$$\n让我们定义内在采纳速度为 $r = Kp$。方程变为：\n$$\n\\ln\\left(\\frac{S}{K-S}\\right) = rt + C\n$$\n其中 $C = KC_1$。对两边取指数：\n$$\n\\frac{S}{K-S} = \\exp(rt+C) = \\exp(C)\\exp(rt)\n$$\n我们使用初始条件 $S(0) = S_0$ 来求 $\\exp(C)$：\n$$\n\\frac{S_0}{K-S_0} = \\exp(C)\\exp(0) = \\exp(C)\n$$\n将此代回方程：\n$$\n\\frac{S}{K-S} = \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)\n$$\n现在，我们求解 $S(t)$：\n$S = (K-S) \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)$\n$S \\left(1 + \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)\\right) = K \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)$\n$S(t) = \\frac{K \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)}{1 + \\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)}$\n分子和分母同除以 $\\left(\\frac{S_0}{K-S_0}\\right) \\exp(rt)$：\n$$\nS(t) = \\frac{K}{1 + \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt)}\n$$\n这就是采纳轨迹的闭合形式解。\n\n接下来，我们证明其S形曲线形状并识别参数。\n该函数是一个逻辑斯蒂函数。\n- 当 $t \\to \\infty$ 时，$\\exp(-rt) \\to 0$，所以 $S(t) \\to K$。饱和水平是 $K$。\n- 当 $t \\to -\\infty$ 时，$\\exp(-rt) \\to \\infty$，所以 $S(t) \\to 0$。\n- 导数 $\\frac{dS}{dt} = pS(K-S) = \\frac{r}{K}S(K-S)$ 在 $0  S  K$ 时为正，因此函数是单调递增的。\n- 拐点出现在增长率最大时，即 $\\frac{d^2S}{dt^2} = 0$ 时。\n$$\n\\frac{d^2S}{dt^2} = \\frac{d}{dt}\\left(\\frac{r}{K}S(K-S)\\right) = \\frac{r}{K}(K-2S)\\frac{dS}{dt}\n$$\n令 $\\frac{d^2S}{dt^2}=0$ (并假设 $\\frac{dS}{dt} \\neq 0$)，我们得到 $K-2S=0$，即 $S = \\frac{K}{2}$。当一半的诊所已采纳时，增长率最快。发生这种情况的时间是拐点时间 $t_0$。\n我们通过令 $S(t_0) = \\frac{K}{2}$ 来求 $t_0$：\n$$\n\\frac{K}{2} = \\frac{K}{1 + \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt_0)}\n$$\n$2 = 1 + \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt_0)$\n$1 = \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt_0)$\n$\\exp(rt_0) = \\frac{K-S_0}{S_0} \\implies t_0 = \\frac{1}{r}\\ln\\left(\\frac{K-S_0}{S_0}\\right)$。\n因此，参数为：\n- 饱和水平：$K$。\n- 内在采纳速度：$r$。\n- 拐点时间：$t_0$。\n\n我们可以使用 $t_0$ 将 $S(t)$ 重写为更标准的形式：\n$$\nS(t) = \\frac{K}{1 + \\exp(rt_0)\\exp(-rt)} = \\frac{K}{1 + \\exp(-r(t-t_0))}\n$$\n\n现在，我们使用具体数据：$K = 1200$，$S_0 = S(0) = 30$，以及 $S(6) = 180$。\n首先，我们表示并计算 $r$。从推导出的解：\n$$\n\\frac{K}{S(t)} - 1 = \\left(\\frac{K-S_0}{S_0}\\right) \\exp(-rt)\n$$\n$\\exp(-rt) = \\left(\\frac{S_0}{K-S_0}\\right) \\left(\\frac{K-S(t)}{S(t)}\\right)$\n$-rt = \\ln\\left[ \\frac{S_0(K-S(t))}{S(t)(K-S_0)} \\right]$\n$$\nr = \\frac{1}{t} \\ln\\left[ \\frac{S(t)(K-S_0)}{S_0(K-S(t))} \\right]\n$$\n使用 $t = 6$ 和 $S(6) = 180$：\n$$\nr = \\frac{1}{6} \\ln\\left[ \\frac{180(1200-30)}{30(1200-180)} \\right] = \\frac{1}{6} \\ln\\left[ \\frac{180 \\cdot 1170}{30 \\cdot 1020} \\right] = \\frac{1}{6} \\ln\\left[ \\frac{6 \\cdot 1170}{1020} \\right] = \\frac{1}{6} \\ln\\left[ \\frac{7020}{1020} \\right] = \\frac{1}{6} \\ln\\left(\\frac{117}{17}\\right)\n$$\n数值上，$r \\approx \\frac{1}{6}\\ln(6.88235) \\approx \\frac{1.928928}{6} \\approx 0.321488$ 月$^{-1}$。\n\n接下来，我们表示并计算 $t_0$：\n$$\nt_0 = \\frac{1}{r} \\ln\\left(\\frac{K-S_0}{S_0}\\right) = \\frac{1}{\\frac{1}{6}\\ln\\left(\\frac{117}{17}\\right)} \\ln\\left(\\frac{1200-30}{30}\\right) = \\frac{6 \\ln(39)}{\\ln(117/17)}\n$$\n数值上，$t_0 \\approx \\frac{6 \\cdot 3.66356}{1.928928} \\approx 11.3957$ 月。\n\n最后，我们计算采纳数达到 $0.8K$ 时的时间 $t$。\n$S(t) = 0.8K = 0.8 \\times 1200 = 960$。\n使用形式 $S(t) = \\frac{K}{1 + \\exp(-r(t-t_0))}$：\n$$\n960 = \\frac{1200}{1 + \\exp(-r(t-t_0))}\n$$\n$1 + \\exp(-r(t-t_0)) = \\frac{1200}{960} = \\frac{5}{4}$\n$\\exp(-r(t-t_0)) = \\frac{5}{4} - 1 = \\frac{1}{4}$\n$-r(t-t_0) = \\ln\\left(\\frac{1}{4}\\right) = -\\ln(4)$\n$t-t_0 = \\frac{\\ln(4)}{r}$\n$t = t_0 + \\frac{\\ln(4)}{r}$\n代入 $t_0$ 和 $r$ 的表达式：\n$$\nt = \\frac{\\frac{1}{r} \\ln\\left(\\frac{K-S_0}{S_0}\\right) + \\frac{\\ln(4)}{r}}{1} = \\frac{\\ln\\left(\\frac{K-S_0}{S_0}\\right) + \\ln(4)}{r} = \\frac{\\ln\\left[4 \\left(\\frac{K-S_0}{S_0}\\right)\\right]}{r}\n$$\n代入数值：\n$$\nt = \\frac{\\ln\\left[4 \\left(\\frac{1200-30}{30}\\right)\\right]}{\\frac{1}{6}\\ln\\left(\\frac{117}{17}\\right)} = \\frac{\\ln\\left[4 \\cdot 39\\right]}{\\frac{1}{6}\\ln\\left(\\frac{117}{17}\\right)} = \\frac{6 \\ln(156)}{\\ln(117/17)}\n$$\n现在，我们计算数值：\n$$\nt \\approx \\frac{6 \\cdot 5.049856}{1.928928} \\approx \\frac{30.299136}{1.928928} \\approx 15.70817\n$$\n四舍五入到四位有效数字，我们得到 $t \\approx 15.71$ 月。", "answer": "$$\\boxed{15.71}$$", "id": "4520329"}, {"introduction": "虽然简单的逻辑斯谛模型捕捉了纯粹的模仿过程，但现实世界中的采纳行为通常由多种力量共同驱动。本练习将介绍极具影响力的巴斯（Bass）模型，它巧妙地将扩散的驱动力分解为外部“创新”效应（如媒体宣传）和内部“模仿”效应（如口碑传播）。理解创新系数 $p$ 和模仿系数 $q$ 的作用，对于分析和预测一项创新将如何传播至关重要 [@problem_id:4520327]。", "problem": "一个公共卫生部门正在评估一种新型宫颈癌筛查自采样本工具包在合格人群中的扩散情况。设合格个体总数为 $K$，到时间 $t$ 为止的累计采纳者数量为 $F(t)$。考虑创新扩散（DOI）理论的原理和质量作用混合假设：在任何时间 $t$，尚未采纳的人数为 $K - F(t)$，并且一个非采纳者遇到一个采纳者的概率与采纳者比例 $F(t)/K$ 成正比。假设采纳行为源于两个相加作用的渠道：（i）外部的外生影响（例如，媒体宣传和临床医生推广），它对每个非采纳者贡献一个恒定的瞬时采纳风险；以及（ii）来自社会传染和同伴模仿的内部内生影响（例如，口碑传播、医疗服务提供者网络），它贡献的瞬时采纳风险与采纳者-非采纳者相遇的速率成正比。基于这些原理和定义，选择一个选项，该选项正确地将采纳发生率 $f(t)$ 表示为 $K$ 和 $F(t)$ 的函数，并准确解释了创新系数 $p$ 和模仿系数 $q$ 在预防性干预背景下的作用。\n\nA. $f(t) = p\\big(K - F(t)\\big) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$。在此，$p$ 是非采纳者因独立于同伴采纳的外部驱动因素（例如，公共卫生信息、临床医生建议）而采纳的速率，而 $q$ 是同伴或网络模仿的强度，即瞬时采纳风险与已采纳比例成正比增加。\n\nB. $f(t) = p\\,F(t) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$。在此，$p$ 是当前采纳者因外部驱动因素而继续采纳的速率，$q$ 衡量模仿强度；$f(t)$ 的两项都依赖于采纳者，因为假设外部影响仅在已采纳者中放大。\n\nC. $f(t) = p\\big(K - F(t)\\big) + q\\big(K - F(t)\\big)$。在此，$p$ 和 $q$ 都是仅影响非采纳者的恒定外部速率，其中 $q$ 代表创新影响随时间的衰减；在预防性干预中，同伴效应可以忽略不计。\n\nD. $f(t) = p\\,K + q\\,F(t)$。在此，$p$ 是作用于整个人群的基线外部推动力，无论当前采纳情况如何，而 $q$ 随采纳者数量而变化，但不依赖于剩余的非采纳者；模仿不需要剩余市场。", "solution": "问题陈述描述了一个创新扩散过程，这个过程可以用数学模型来表示。目标是推导出采纳发生率 $f(t)$，即累计采纳者数量的变化率，$f(t) = \\dfrac{dF(t)}{dt}$。\n\n### 第1步：提取已知条件并形式化原理\n问题提供了以下定义和原理：\n1.  $K$：合格个体的总数（市场潜力）。\n2.  $F(t)$：在时间 $t$ 的累计采纳者数量。\n3.  $K - F(t)$：在时间 $t$ 的非采纳者（潜在采纳者）数量。\n4.  $f(t)$：在时间 $t$ 的采纳发生率，或新采纳的速率。根据定义，$f(t) = \\dfrac{dF(t)}{dt}$。\n5.  新采纳的速率 $f(t)$ 是非采纳者数量与单个非采纳者的瞬时采纳风险的乘积。我们将此风险表示为 $h(t)$。\n    $$f(t) = h(t) \\times \\left(K - F(t)\\right)$$\n6.  风险 $h(t)$ 是两个分量的和，一个来自外部渠道，一个来自内部渠道：$h(t) = h_{\\text{external}} + h_{\\text{internal}}$。\n7.  **外部影响（渠道 i）：** 这贡献了一个“恒定的单位非采纳者瞬时采纳风险”。我们称这个常数为 $p$，即创新系数。\n    $$h_{\\text{external}} = p$$\n    这部分采纳与现有采纳者数量无关。它由社会系统外部的因素驱动，如媒体宣传。\n8.  **内部影响（渠道 ii）：** 这贡献了一个“与采纳者-非采纳者相遇速率成正比的瞬时采纳风险”。问题进一步说明，这种相遇的概率“与采纳者比例 $F(t)/K$ 成正比”。我们称这个比例常数为 $q$，即模仿系数。因此，由内部影响引起的单个非采纳者的风险是：\n    $$h_{\\text{internal}} = q \\dfrac{F(t)}{K}$$\n    这部分依赖于社会传染或口碑效应，随着人群中采纳者比例的增长而增加。\n\n### 第2步：验证问题陈述\n问题描述了巴斯扩散模型的基本原理，该模型是定量营销科学的基石，也是流行病学和公共卫生领域广泛用于追踪行为、技术和思想传播的模型。\n\n-   **科学依据：** 该模型在科学上是健全且成熟的。将其应用于预防性健康技术（宫颈癌筛查工具包）的扩散是一个标准且恰当的用例。创新系数（$p$）和模仿系数（$q$）的概念是该理论的核心。\n-   **适定性：** 描述清晰，包含了构建 $F(t)$ 微分方程所需的所有要素。这构成了一个适定的初值问题（假设 $F(0)$ 已知，通常 $F(0) \\approx 0$）。问题要求的是导数 $f(t)$ 的表达式，这可以直接从前提中推导出来。\n-   **客观性：** 问题陈述使用了该领域标准的精确、客观的语言。它没有歧义或主观论断。\n\n问题陈述是有效的。它基于已建立的科学原理，呈现了一个清晰、可形式化的情景。\n\n### 第3步：推导采纳发生率 $f(t)$ 的表达式\n结合第1步中的原理，我们首先组合出单个非采纳者的总瞬时风险 $h(t)$：\n$$h(t) = h_{\\text{external}} + h_{\\text{internal}} = p + q \\dfrac{F(t)}{K}$$\n接下来，我们用这个风险乘以面临采纳风险的个体数量，即非采纳者群体 $K - F(t)$，来求出总的新采纳速率 $f(t)$：\n$$f(t) = h(t) \\times \\left(K - F(t)\\right)$$\n代入 $h(t)$ 的表达式：\n$$f(t) = \\left(p + q \\dfrac{F(t)}{K}\\right) \\left(K - F(t)\\right)$$\n这是巴斯模型的微分形式。我们可以展开这个表达式以匹配选项的格式：\n$$f(t) = p\\left(K - F(t)\\right) + q \\dfrac{F(t)}{K} \\left(K - F(t)\\right)$$\n这个方程表明，新采纳的速率 ($f(t)$) 是两项之和：\n-   代表“创新者”采纳的项：$p\\left(K - F(t)\\right)$。该速率与剩余非采纳者数量成正比，比例常数为 $p$。\n-   代表“模仿者”采纳的项：$q \\dfrac{F(t)}{K} \\left(K - F(t)\\right)$。该速率与非采纳者数量 ($K - F(t)$) 和采纳者比例 ($F(t)/K$) 的乘积成正比，由模仿系数 $q$ 进行缩放。\n\n### 第4步：评估每个选项\n\n**A. $f(t) = p\\big(K - F(t)\\big) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$。在此，$p$ 是非采纳者因独立于同伴采纳的外部驱动因素（例如，公共卫生信息、临床医生建议）而采纳的速率，而 $q$ 是同伴或网络模仿的强度，即瞬时采纳风险与已采纳比例成正比增加。**\n-   **数学形式：** 此表达式与根据问题陈述中的第一性原理推导出的表达式完全相同。\n-   **解释：** 对 $p$ 的解释正确地将其识别为作用于非采纳者的外部影响系数。对 $q$ 的解释正确地将其识别为内部（模仿）影响的系数，其中采纳压力随采纳者比例 $F(t)/K$ 的增长而增长。公式和解释都是正确的。\n-   **结论：** **正确**。\n\n**B. $f(t) = p\\,F(t) + q\\,\\dfrac{F(t)}{K}\\,\\big(K - F(t)\\big)$。在此，$p$ 是当前采纳者因外部驱动因素而继续采纳的速率，$q$ 衡量模仿强度；$f(t)$ 的两项都依赖于采纳者，因为假设外部影响仅在已采纳者中放大。**\n-   **数学形式：** 第一项 $p\\,F(t)$ 是错误的。外部影响必须作用于非采纳者群体 $K - F(t)$，而不是当前采纳者群体 $F(t)$。已经采纳的个体不能再次采纳。\n-   **解释：** 关于 $p$ 是“当前采纳者继续采纳”的速率的解释，对于像首次使用筛查工具包这样的一次性采纳事件来说是无稽之谈。\n-   **结论：** **错误**。\n\n**C. $f(t) = p\\big(K - F(t)\\big) + q\\big(K - F(t)\\big)$。在此，$p$ 和 $q$ 都是仅影响非采纳者的恒定外部速率，其中 $q$ 代表创新影响随时间的衰减；在预防性干预中，同伴效应可以忽略不计。**\n-   **数学形式：** 这可以简化为 $f(t) = (p+q)(K-F(t))$。该模型缺少 $F(t)/K$ 这一项，而这一项是表示依赖于现有采纳者数量的内部影响（模仿）所必需的。它模拟了一个纯粹的外部影响过程，其组合系数为 $(p+q)$。\n-   **解释：** 该解释错误地将 $q$ 归类为外部速率，并做出了未经证实的论断，即“在预防性干预中，同伴效应可以忽略不计”，这与问题中包含一个内部、内生影响渠道的前提相矛盾。\n-   **结论：** **错误**。\n\n**D. $f(t) = p\\,K + q\\,F(t)$。在此，$p$ 是作用于整个人群的基线外部推动力，无论当前采纳情况如何，而 $q$ 随采纳者数量而变化，但不依赖于剩余的非采纳者；模仿不需要剩余市场。**\n-   **数学形式：** 这个方程有根本性的缺陷。关键在于，当采纳者数量 $F(t)$ 接近总人口 $K$ 时，新采纳的速率 $f(t)$ 必须接近 $0$。在这个模型中，当 $F(t) \\to K$ 时，$f(t) \\to pK + qK \\ne 0$。这意味着可能发生无限次的采纳，这违反了 $K$ 作为合格总人口的定义。模型必须包含 $(K - F(t))$ 这一项以确保过程终止。\n-   **解释：** 解释也是错误的。模仿是已采纳者与未采纳者之间的互动；它绝对需要一个由非采纳者组成的“剩余市场”。\n-   **结论：** **错误**。", "answer": "$$\\boxed{A}$$", "id": "4520327"}, {"introduction": "理论模型的真正力量在于其解释真实世界数据的能力。这个动手编程练习将理论与实践联系起来，要求您将巴斯（Bass）模型拟合到采纳数据中。通过估计创新参数 $p$ 和模仿参数 $q$，您将学会如何量化判断一个新项目的传播主要是由外部推广还是内部同伴影响所驱动 [@problem_id:4520340]。", "problem": "一个预防医学联合会在多家诊所启动了一项新的癌症筛查项目。该项目的采纳通过两种力量传播：一种是由主动沟通和临床医生领导力产生的内在创新冲动，另一种是通过诊所间的口碑和同行影响产生的模仿力量。假设存在一个规模为 $M$ 的同质潜在采纳者群体，并令 $F(t)$ 表示到时间 $t$（单位：月）为止的累计采纳者比例。在时间 $t$，一个非采纳者的瞬时采纳风险是一个速率恒为 $p$ 的创新部分与一个速率为 $q$ 乘以已采纳比例的模仿部分之和。在同质性和独立性假设下，这可以推导出微分方程 $dF/dt = \\left(p + q F(t)\\right)\\left(1 - F(t)\\right)$，初始条件为 $F(0) = 0$。您必须从此基础出发，推导出 $F(t)$ 的解析形式，并使用它对累计采纳数据执行非线性最小二乘回归，以估计 $p$ 和 $q$。\n\n您的程序必须对每个数据集，使用带有正值约束（$p  0$, $q  0$）的非线性回归来估计 $p$ 和 $q$，其中观测时间 $t_i$ 的观测累计采纳数为 $N(t_i) = M \\cdot F(t_i)$。估计之后，使用以下规则将扩散过程分类为创新驱动、模仿驱动或不确定（持平）：\n- 如果 $q - p \\ge \\varepsilon$，则为模仿驱动，\n- 如果 $p - q \\ge \\varepsilon$，则为创新驱动，\n- 如果 $\\left|p - q\\right|  \\varepsilon$，则为不确定，\n其中 $\\varepsilon = 10^{-3}$。将所有估计值 $p$ 和 $q$ 表示为四舍五入到五位小数的小数。不得使用百分号。\n\n物理单位：时间 $t$ 以月为单位。不涉及其他物理单位。不使用角度。\n\n测试套件。使用以下三个数据集，每个数据集都提供了符合条件的群体规模 $M$、观测时间 $t$（单位：月）和观测到的累计采纳数 $N(t)$：\n1. 数据集 A（符合条件的群体 $M = 10000$），观测时间 $t \\in \\{1,2,3,4,6,9,12,15\\}$ 月，观测到的累计采纳数 $N(t)$ 由序列 $[490, 961, 1411, 1844, 2653, 3740, 4681, 5495]$ 给出。\n2. 数据集 B（符合条件的群体 $M = 5000$），观测时间 $t \\in \\{1,2,3,4,6,9,12,15\\}$ 月，观测到的累计采纳数 $N(t)$ 由序列 $[61, 151, 279, 460, 1033, 2443, 3843, 4597]$ 给出。\n3. 数据集 C（符合条件的群体 $M = 8000$），观测时间 $t \\in \\{1,2,3,4,6,9,12,15\\}$ 月，观测到的累计采纳数 $N(t)$ 由序列 $[240, 480, 718, 956, 1425, 2110, 2762, 3380]$ 给出。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对每个数据集，输出一个形式为 $[p\\_\\text{hat}, q\\_\\text{hat}, c]$ 的列表，其中 $p\\_\\text{hat}$ 和 $q\\_\\text{hat}$ 是四舍五入到五位小数的估计值，而 $c$ 是分类代码，$0$ 代表创新驱动，$1$ 代表模仿驱动，$2$ 代表不确定。例如，一行输出可能如下所示：$[[0.01234,0.05678,1],[0.04500,0.01000,0],[0.03000,0.03000,2]]$。", "solution": "该问题被评估为 **有效**。这是一个在社会现象数学建模领域中提法明确且有科学依据的问题。该问题要求应用 Bass 扩散模型（一个标准且成熟的模型）来分析预防医学背景下的采纳数据。已知条件完整，术语精确，目标清晰且可量化。该任务涉及标准的数学和统计程序：求解非线性常微分方程和执行非线性最小二乘参数估计。\n\n问题的核心是 Bass 扩散模型，它描述了新思想和新产品在人群中传播的过程。该模型关于累计采纳者比例 $F(t)$ 的微分方程如下：\n$$\n\\frac{dF}{dt} = \\left(p + q F(t)\\right)\\left(1 - F(t)\\right)\n$$\n初始条件为 $F(0) = 0$。这里，$p$ 是创新系数（外部影响），$q$ 是模仿系数（内部影响）。\n\n首先，我们推导 $F(t)$ 的解析解。给定的微分方程是可分离的。我们可以写成：\n$$\n\\frac{dF}{\\left(p + qF\\right)\\left(1 - F\\right)} = dt\n$$\n我们对两边进行积分。左边需要进行部分分式分解。让我们分解这个分式：\n$$\n\\frac{1}{\\left(p + qF\\right)\\left(1 - F\\right)} = \\frac{A}{1 - F} + \\frac{B}{p + qF}\n$$\n通过令分子相等来求解系数 $A$ 和 $B$，得到 $1 = A(p + qF) + B(1 - F)$。此等式必须对所有 $F$ 成立。\n令 $F=1$ 得到 $1 = A(p+q)$，所以 $A = \\frac{1}{p+q}$。\n令 $F=-p/q$ 得到 $1 = B(1 - (-p/q)) = B(1+p/q) = B\\frac{p+q}{q}$，所以 $B = \\frac{q}{p+q}$。\n\n将部分分式代回积分中：\n$$\n\\int \\left( \\frac{1/(p+q)}{1 - F} + \\frac{q/(p+q)}{p + qF} \\right) dF = \\int dt\n$$\n从 $t=0$（此时 $F=0$）积分到一般时间 $t$（此时比例为 $F(t)$）：\n$$\n\\frac{1}{p+q} \\left[ \\int_0^{F(t)} \\frac{dF'}{1 - F'} + q \\int_0^{F(t)} \\frac{dF'}{p + qF'} \\right] = \\int_0^t dt'\n$$\n$$\n\\frac{1}{p+q} \\left[ -\\ln(1-F') + \\ln(p+qF') \\right]_0^{F(t)} = t\n$$\n$$\n\\frac{1}{p+q} \\left( \\left( -\\ln(1-F(t)) + \\ln(p+qF(t)) \\right) - \\left( -\\ln(1) + \\ln(p) \\right) \\right) = t\n$$\n使用 $\\ln(1)=0$，我们得到：\n$$\n\\frac{1}{p+q} \\left( \\ln\\left(\\frac{p+qF(t)}{1-F(t)}\\right) - \\ln(p) \\right) = t\n$$\n$$\n\\ln\\left(\\frac{p+qF(t)}{p(1-F(t))}\\right) = (p+q)t\n$$\n对两边取指数：\n$$\n\\frac{p+qF(t)}{p(1-F(t))} = e^{(p+q)t}\n$$\n现在，我们求解 $F(t)$：\n$$\np+qF(t) = p(1-F(t))e^{(p+q)t} = pe^{(p+q)t} - pF(t)e^{(p+q)t}\n$$\n$$\nF(t) \\left(q + pe^{(p+q)t}\\right) = pe^{(p+q)t} - p\n$$\n$$\nF(t) = \\frac{p\\left(e^{(p+q)t} - 1\\right)}{q + pe^{(p+q)t}}\n$$\n为了得到一个更标准且在数值上更稳定的形式，我们将分子和分母同乘以 $e^{-(p+q)t}$：\n$$\nF(t;p,q) = \\frac{p\\left(1 - e^{-(p+q)t}\\right)}{p + qe^{-(p+q)t}}\n$$\n这就是累计采纳比例 $F(t)$ 的解析解。\n\n对于参数估计，我们有包含观测时间 $t_i$ 和相应累计采纳人数 $N(t_i)$ 的数据集。模型对采纳人数的预测值为 $N_{pred}(t_i) = M \\cdot F(t_i; p, q)$，其中 $M$ 是潜在采纳者的总群体规模。我们将使用非线性最小二乘法 (NLLS) 来找到最小化残差平方和 (SSR) 的参数 $\\hat{p}$ 和 $\\hat{q}$：\n$$\n\\text{SSR}(p, q) = \\sum_{i} \\left(N(t_i) - M \\cdot F(t_i; p, q)\\right)^2\n$$\n这个优化在约束条件 $p  0$ 和 $q  0$ 下进行。`scipy.optimize.curve_fit` 函数非常适合此任务，因为它可以对带有参数边界的 NLLS 进行计算。\n\n在为每个数据集获得估计值 $\\hat{p}$ 和 $\\hat{q}$ 后，我们根据以下规则对扩散过程进行分类，给定阈值为 $\\varepsilon = 10^{-3}$：\n- **模仿驱动**（代码 $1$）：如果 $\\hat{q} - \\hat{p} \\ge \\varepsilon$。这表明同行影响是主导力量。\n- **创新驱动**（代码 $0$）：如果 $\\hat{p} - \\hat{q} \\ge \\varepsilon$。这表明主动沟通和外部因素是主导力量。\n- **不确定**（代码 $2$）：如果 $|\\hat{p} - \\hat{q}|  \\varepsilon$。两种力量的强度相当。\n\n该实现将通过为每个数据集设置带有相应 M 值的模型函数、使用 `curve_fit` 执行 NLLS 拟合，然后应用分类逻辑来处理每个数据集。最终结果，包括四舍五入到五位小数的估计参数和分类代码，将按照规定格式化为单个输出字符串。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the Bass diffusion model parameter estimation and classification problem.\n    \"\"\"\n    test_cases = [\n        {'M': 10000, 't': [1, 2, 3, 4, 6, 9, 12, 15], 'N': [490, 961, 1411, 1844, 2653, 3740, 4681, 5495]},\n        {'M': 5000, 't': [1, 2, 3, 4, 6, 9, 12, 15], 'N': [61, 151, 279, 460, 1033, 2443, 3843, 4597]},\n        {'M': 8000, 't': [1, 2, 3, 4, 6, 9, 12, 15], 'N': [240, 480, 718, 956, 1425, 2110, 2762, 3380]},\n    ]\n    \n    epsilon = 1e-3\n    all_results = []\n\n    def bass_model_fraction(t, p, q):\n        \"\"\"\n        Calculates the cumulative fraction of adopters F(t) using the Bass model.\n        The form used is F(t) = p*(1 - exp(-(p+q)t)) / (p + q*exp(-(p+q)t)),\n        which is numerically stable for p near zero.\n        \"\"\"\n        val = p + q\n        # Ensure t is a numpy array for vectorized operations\n        t = np.asarray(t, dtype=float)\n        \n        # Handle the case where p+q is extremely small to avoid issues with exp\n        if np.isclose(val, 0):\n            # The limit of F(t) as p+q - 0 is p*t, derived from dF/dt = p.\n            return p * t\n\n        exp_term = np.exp(-val * t)\n        \n        numerator = p * (1 - exp_term)\n        denominator = p + q * exp_term\n\n        # Denominator should not be zero for p0, q0 but as a safe guard.\n        # Replace division by zero or NaN with 0.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            F_t = np.true_divide(numerator, denominator)\n            F_t[~np.isfinite(F_t)] = 0  #\n        \n        return F_t\n\n    for case in test_cases:\n        M = case['M']\n        t_data = np.array(case['t'])\n        N_data = np.array(case['N'])\n\n        def model_to_fit(t, p, q):\n            return M * bass_model_fraction(t, p, q)\n\n        # Initial guesses for p and q.\n        # p can be estimated from the first data point: p ~ (N1/M)/t1\n        p_guess = (N_data[0] / M) / t_data[0] if t_data[0]  0 else 0.01\n        # q is often larger than p in imitation-driven scenarios.\n        q_guess = 0.1 \n        initial_guesses = [p_guess, q_guess]\n        \n        # Define bounds for parameters: p  0, q  0\n        # Use a small positive number to avoid p=0 issues in the model's standard form.\n        bounds = ([1e-9, 1e-9], [np.inf, np.inf])\n\n        try:\n            popt, _ = curve_fit(\n                model_to_fit,\n                t_data,\n                N_data,\n                p0=initial_guesses,\n                bounds=bounds,\n                maxfev=5000 # Increase max iterations for convergence\n            )\n            p_hat, q_hat = popt\n        except RuntimeError:\n            # Fallback in case of non-convergence, though unlikely with these data\n            p_hat, q_hat = 0.0, 0.0\n\n        # Classify the diffusion process\n        diff = q_hat - p_hat\n        if diff = epsilon:\n            classification = 1  # Imitation-driven\n        elif -diff = epsilon: # same as p_hat - q_hat = epsilon\n            classification = 0  # Innovation-driven\n        else: # |p_hat - q_hat|  epsilon\n            classification = 2  # Indeterminate\n\n        all_results.append([p_hat, q_hat, classification])\n\n    # Format the final output string as per specifications\n    # Each p, q must be a decimal rounded to five places.\n    result_strings = []\n    for p_val, q_val, c_val in all_results:\n        result_strings.append(f\"[{p_val:.5f},{q_val:.5f},{c_val}]\")\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "4520340"}]}