{"hands_on_practices": [{"introduction": "在任何暴发调查中，一个可靠的病例定义都是基石。诊断测试在识别病例中至关重要，但它们并非完美无缺。本练习将帮助您理解，在真实的暴发情境下，如何量化诊断测试的不确定性，这对正确解读筛查结果至关重要 [@problem_id:4554723]。", "problem": "一个地区卫生部门正在对一个特定高风险接触者队列进行疫情暴发调查。现有某种快速诊断测试，其灵敏度为 $0.85$，特异性为 $0.98$。在筛查时，该队列的真实患病率估计为 $0.10$。请仅使用灵敏度、特异性和患病率作为概率的基本定义，并结合条件概率规则，完成以下任务：推导阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式；计算它们的数值；然后将总错分比例 $M$ 定义为筛查人群中假阳性和假阴性概率的总和，推导 $M$ 的通用表达式，并根据给定参数计算其数值。最后，利用计算出的概率，简要解释在这种情况下哪种类型的错分（假阳性或假阴性）预计更常见，并说明原因。评分时，仅以小数形式报告 $M$ 的值。将最终答案四舍五入至四位有效数字。", "solution": "该问题要求推导和计算几个诊断测试指标，包括阳性预测值 (PPV)、阴性预测值 (NPV) 和总错分比例 ($M$)。我们首先根据所提供的信息正式定义事件和概率。\n\n设 $D$ 为队列中个体患病的事件， $D^c$ 为个体不患病的互补事件。设 $T^+$ 为测试结果为阳性的事件， $T^-$ 为测试结果为阴性的事件。\n\n给定条件可以用概率术语表示：\n- 疾病的患病率为 $P(D) = 0.10$。\n- 不患病的概率为 $P(D^c) = 1 - P(D) = 1 - 0.10 = 0.90$。\n- 测试的灵敏度，即在患病情况下测试为阳性的概率，为 $S_n = P(T^+ | D) = 0.85$。\n- 测试的特异性，即在不患病情况下测试为阴性的概率，为 $S_p = P(T^- | D^c) = 0.98$。\n\n从这些定义中，我们可以推导出以疾病状态为条件的测试错误概率：\n- 假阴性率是在患病情况下测试为阴性的概率：$P(T^- | D) = 1 - P(T^+ | D) = 1 - S_n = 1 - 0.85 = 0.15$。\n- 假阳性率是在不患病情况下测试为阳性的概率：$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - S_p = 1 - 0.98 = 0.02$。\n\n首先，我们推导 PPV 和 NPV 的表达式。\n阳性预测值 $PPV$ 是指测试结果为阳性的个体确实患病的概率，定义为 $P(D | T^+)$。根据贝叶斯定理：\n$$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n分母 $P(T^+)$ 是阳性测试的总概率，可以使用全概率公式求得：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n代入标准参数，我们得到 PPV 的通用表达式：\n$$PPV = \\frac{S_n P(D)}{S_n P(D) + (1 - S_p)(1 - P(D))}$$\n在数值上，我们首先计算 $P(T^+)$：\n$$P(T^+) = (0.85)(0.10) + (0.02)(0.90) = 0.085 + 0.018 = 0.103$$\n那么，PPV 的数值为：\n$$PPV = \\frac{0.085}{0.103} \\approx 0.8252$$\n\n阴性预测值 $NPV$ 是指测试结果为阴性的个体确实未患病的概率，定义为 $P(D^c | T^-)$。根据贝叶斯定理：\n$$NPV = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}$$\n分母 $P(T^-)$ 是阴性测试的总概率。根据全概率公式：\n$$P(T^-) = P(T^- | D) P(D) + P(T^- | D^c) P(D^c)$$\n代入标准参数，我们得到 NPV 的通用表达式：\n$$NPV = \\frac{S_p (1 - P(D))}{(1 - S_n)P(D) + S_p(1 - P(D))}$$\n在数值上，我们首先计算 $P(T^-)$：\n$$P(T^-) = (0.15)(0.10) + (0.98)(0.90) = 0.015 + 0.882 = 0.897$$\n那么，NPV 的数值为：\n$$NPV = \\frac{0.882}{0.897} \\approx 0.9833$$\n\n接下来，我们讨论总错分比例 $M$。问题将 $M$ 定义为筛查人群中假阳性和假阴性概率的总和。\n假阳性对应于不患病且测试为阳性的联合事件，即 $D^c \\cap T^+$。\n假阴性对应于患病且测试为阴性的联合事件，即 $D \\cap T^-$。\n总错分比例 $M$ 是这两个互斥事件并集的概率：\n$$M = P((D^c \\cap T^+) \\cup (D \\cap T^-)) = P(D^c \\cap T^+) + P(D \\cap T^-)$$\n使用条件概率的定义，我们可以将联合概率写为：\n$$P(D^c \\cap T^+) = P(T^+ | D^c) P(D^c) = (1 - S_p)(1 - P(D))$$\n$$P(D \\cap T^-) = P(T^- | D) P(D) = (1 - S_n)P(D)$$\n因此，用患病率 ($P$)、灵敏度 ($S_n$) 和特异性 ($S_p$) 表示的 $M$ 的通用表达式为：\n$$M = (1 - S_p)(1 - P) + (1 - S_n)P$$\n这表示被测试错分的总人口比例。\n我们现在使用给定的数据计算 $M$ 的数值：\n$$M = (1 - 0.98)(1 - 0.10) + (1 - 0.85)(0.10)$$\n$$M = (0.02)(0.90) + (0.15)(0.10)$$\n$$M = 0.018 + 0.015$$\n$$M = 0.033$$\n\n最后，我们解释哪种类型的错分更常见。我们比较 $M$ 的两个组成部分的大小：\n人群中假阳性的概率为 $P(\\text{FP}) = P(D^c \\cap T^+) = 0.018$。\n人群中假阴性的概率为 $P(\\text{FN}) = P(D \\cap T^-) = 0.015$。\n由于 $0.018 > 0.015$，在这种情况下，假阳性比假阴性稍微更常见。其原因是，尽管单个患病个体被错分的条件概率（假阴性率，$0.15$）远高于单个非患病个体被错分的条件概率（假阳性率，$0.02$），但由于非患病人群的规模远大于患病人群（$90\\%$ vs $10\\%$），这导致在整个人群中出现假阳性的总比例（$0.018$）最终略高于假阴性（$0.015$）。\n\n问题要求报告 $M$ 的值，并四舍五入到四位有效数字。\n$M = 0.033$。要用四位有效数字表示，我们添加尾随零：$0.03300$。", "answer": "$$\n\\boxed{0.03300}\n$$", "id": "4554723"}, {"introduction": "在识别病例后，流行病学家会按时间、地点和人群三个维度整理数据，其中流行曲线（按时间分布的病例图）是一个强大的工具。本练习将演示一项经典的流行病学侦探技巧：如何从流行曲线的高峰期入手，结合已知的潜伏期范围，反向推算出最可能的暴露时间，这是找到暴发源头的关键一步 [@problem_id:4554751]。", "problem": "一个实地流行病学家团队已经核实了一起肠胃疾病集群的诊断，并构建了流行曲线。该曲线呈现出单一的尖峰，与点源暴露相符。已知该病原体的潜伏期范围为 $2$ 至 $7$ 天。仅使用暴发调查的核心定义，即潜伏期是自暴露至症状出现的时间，并且对于点源暴发，观察到的发病时间反映了潜伏期分布随暴露时间平移后的结果，推导出相对于众数发病日期的可能暴露日期区间。设众数发病日期为 $M$（在日历时间轴上以天为单位）。请将您的最终答案表示为相对于 $M$ 的两个区间端点（以天为单位），使用带符号的偏移量，其中负值表示 $M$ 之前的天数。请将端点以单行矩阵的形式提供，并且在最终的方框答案中不要包含任何单位。无需四舍五入。", "solution": "该问题要求根据众数发病日期和已知的病原体潜伏期范围，推导出可能的暴露日期区间。让我们正式定义相关变量和关系。\n\n设 $T_{exp}$ 为暴露日期。由于这是一次点源暴发，我们假设所有病例都在这一个单一时间点暴露。\n设 $T_{onset}$ 为某个病例的症状发作日期。\n设 $T_{inc}$ 为某个病例的潜伏期，定义为从暴露到症状发作所经过的时间。\n连接这些变量的基本关系是：\n$$T_{onset} = T_{exp} + T_{inc}$$\n问题陈述，潜伏期的已知范围为最短 $2$ 天到最长 $7$ 天。我们可以将其表示为一个不等式：\n$$2 \\le T_{inc} \\le 7$$\n其中所有量均以天为单位。我们用 $T_{inc, min} = 2$ 表示最短潜伏期，用 $T_{inc, max} = 7$ 表示最长潜伏期。\n$$T_{inc, min} \\le T_{inc} \\le T_{inc, max}$$\n由于所有病例都源于 $T_{exp}$ 这单一暴露事件，观察到的发病日期 $T_{onset}$ 的范围由潜伏期的范围决定。具体来说，任何观察到的发病日期都必须落在由以下公式定义的区间内：\n$$T_{exp} + T_{inc, min} \\le T_{onset} \\le T_{exp} + T_{inc, max}$$\n问题提供了众数发病日期，记为 $M$。众数日期是病例发病频率最高的日期。作为暴发中的一个观察日期，$M$ 本身必须是 $T_{onset}$ 的一个可能值。因此，$M$ 必须满足上述不等式：\n$$T_{exp} + T_{inc, min} \\le M \\le T_{exp} + T_{inc, max}$$\n我们的目标是求出暴露日期 $T_{exp}$ 的可能范围。我们可以通过在复合不等式中分离出 $T_{exp}$ 来实现这一目标。我们分别分析不等式的两部分。\n\n首先，考虑不等式的左侧：\n$$T_{exp} + T_{inc, min} \\le M$$\n从两边减去 $T_{inc, min}$，得到 $T_{exp}$ 的一个上界：\n$$T_{exp} \\le M - T_{inc, min}$$\n接下来，考虑不等式的右侧：\n$$M \\le T_{exp} + T_{inc, max}$$\n从两边减去 $T_{inc, max}$，得到 $T_{exp}$ 的一个下界：\n$$M - T_{inc, max} \\le T_{exp}$$\n结合这两个结果，我们建立了暴露日期 $T_{exp}$ 的可能区间：\n$$M - T_{inc, max} \\le T_{exp} \\le M - T_{inc, min}$$\n该区间代表了与众数发病日期为 $M$ 且潜伏期在其已知范围内相符的单一暴露事件的所有可能日期。\n\n现在，我们代入给定的潜伏期范围数值，$T_{inc, min} = 2$ 和 $T_{inc, max} = 7$：\n$$M - 7 \\le T_{exp} \\le M - 2$$\n问题要求答案表示为相对于众数日期 $M$ 的区间，使用带符号的偏移量。$T_{exp}$ 区间的下端点是 $M - 7$，对应于相对于 $M$ 的 $-7$ 天偏移量。上端点是 $M - 2$，对应于相对于 $M$ 的 $-2$ 天偏移量。\n\n作为相对于 $M$ 的偏移量，这两个区间端点是 $-7$ 和 $-2$。最终答案必须以行矩阵的形式提供。", "answer": "$$\\boxed{\\begin{pmatrix} -7  -2 \\end{pmatrix}}$$", "id": "4554751"}, {"introduction": "当描述性流行病学提供了线索并形成了假设（例如，“鸡肉沙拉导致了疾病”）后，我们必须通过分析性流行病学进行严格的检验。本练习将深入探讨这一过程，不仅展示了如何计算暴露与疾病之间的关联强度，还演示了如何处理复杂情况，例如混杂（第三方因素歪曲了真实关联）和效应修饰（关联强度在不同亚组中有所不同），这些都是假设检验的核心 [@problem_id:4554767]。", "problem": "一次周末静修活动的参与者中暴发了急性肠胃炎。作为暴发调查分析步骤的一部分，您需要评估食用冷鸡肉卷（暴露）是否与患病（结局）相关，以及粗关联是否受到某个场所相关因素的扭曲。您还想评估生物易感性是否修饰了该关联。\n\n请仅使用风险的核心定义（罹患风险等于病例数除以风险人群数）、以风险比值为形式的关联度量以及分层原则逻辑来指导您的推导。不要假设任何非基于这些基础推导出的快捷公式。\n\n此次静修活动在两个用餐区提供食物，这两个区域的背景污染风险不同：L用餐区（背景风险较低）和H用餐区（背景风险较高）。由于参与者自行选择用餐地点以及是否食用鸡肉卷，因此暴露分布在不同用餐区之间存在差异。计数如下：\n\n- L用餐区：\n  - 暴露组：$800$名参与者，其中$160$人患病。\n  - 非暴露组：$200$名参与者，其中$20$人患病。\n- H用餐区：\n  - 暴露组：$200$名参与者，其中$160$人患病。\n  - 非暴露组：$800$名参与者，其中$320$人患病。\n\n基于第一性原理的任务：\n1) 从罹患风险（每风险人群中的病例数）的定义和风险比（风险之比）的定义出发，计算暴露组与非暴露组相比的粗风险比，合并所有用餐区的数据且不进行调整。然后，计算L用餐区和H用餐区内的分层特异性风险比，并确定它们是否大致相等。\n2) 使用按用餐区分层的方法来控制混杂，推导出一个单一的、尊重分层结构且不使用依赖于疾病风险的权重的调整后共同风险比。从第一性原理出发，论证您所使用的加权原则，然后计算调整后的值。\n3) 比较粗度量和调整后度量，以识别并量化混杂，混杂以相对变化的形式计算，公式为 $(\\text{粗值} - \\text{调整值}) / \\text{调整值}$，并以小数表示。\n4) 为了证明生物易感性带来的效应修饰，您还从另一次提供了相同暴露的类似招待会中收集了数据。在那里，您按免疫功能低下状态进行了分层：\n   - 免疫功能低下组：\n     - 暴露组：$60$名参与者，其中$54$人患病。\n     - 非暴露组：$120$名参与者，其中$24$人患病。\n   - 免疫功能正常组：\n     - 暴露组：$300$名参与者，其中$60$人患病。\n     - 非暴露组：$600$名参与者，其中$60$人患病。\n   计算两个分层特异性风险比，并评估它们是否存在差异，以判断是否存在效应修饰。\n\n答案规格：\n- 仅报告任务$2$中计算出的调整后共同风险比作为您的最终数值答案。\n- 最终答案以小数形式表示，并四舍五入至四位有效数字。\n- 最终答案中不包含任何单位或百分号。", "solution": "**任务1：粗风险比和分层特异性风险比**\n\n首先，我们汇总两个用餐区的数据来计算粗度量。\n- 总暴露参与者：$N_{E+} = 800 (\\text{在L}) + 200 (\\text{在H}) = 1000$。\n- 暴露组中总患病人数：$A_{E+} = 160 (\\text{在L}) + 160 (\\text{在H}) = 320$。\n- 总非暴露参与者：$N_{E-} = 200 (\\text{在L}) + 800 (\\text{在H}) = 1000$。\n- 非暴露组中总患病人数：$A_{E-} = 20 (\\text{在L}) + 320 (\\text{在H}) = 340$。\n\n暴露组的粗罹患风险 $R_{E+}$ 为：\n$$R_{E+} = \\frac{A_{E+}}{N_{E+}} = \\frac{320}{1000} = 0.32$$\n非暴露组的粗罹患风险 $R_{E-}$ 为：\n$$R_{E-} = \\frac{A_{E-}}{N_{E-}} = \\frac{340}{1000} = 0.34$$\n粗风险比 $RR_{\\text{crude}}$ 是这些风险的比值：\n$$RR_{\\text{crude}} = \\frac{R_{E+}}{R_{E-}} = \\frac{0.32}{0.34} = \\frac{32}{34} = \\frac{16}{17} \\approx 0.9412$$\n\n接下来，我们计算分层特异性风险比。\n\n对于L用餐区（$L$分层）：\n- 暴露组风险：$R_{E+,L} = \\frac{160}{800} = 0.20$。\n- 非暴露组风险：$R_{E-,L} = \\frac{20}{200} = 0.10$。\n- L分层的特异性风险比：$RR_L = \\frac{R_{E+,L}}{R_{E-,L}} = \\frac{0.20}{0.10} = 2.0$。\n\n对于H用餐区（$H$分层）：\n- 暴露组风险：$R_{E+,H} = \\frac{160}{200} = 0.80$。\n- 非暴露组风险：$R_{E-,H} = \\frac{320}{800} = 0.40$。\n- H分层的特异性风险比：$RR_H = \\frac{R_{E+,H}}{R_{E-,H}} = \\frac{0.80}{0.40} = 2.0$。\n\n分层特异性风险比完全相同（$RR_L = RR_H = 2.0$），表明用餐区不存在效应修饰。粗风险比（$RR_{\\text{crude}} \\approx 0.94$）与分层特异性风险比（$2.0$）之间的差异表明存在混杂。\n\n**任务2：调整后共同风险比**\n\n问题要求使用不依赖于疾病风险的权重来推导调整后的风险比。这可以通过标准化来实现。我们将通过一个“标准”人群的比例对暴露组和非暴露组的分层特异性风险进行加权，从而计算出它们的标准化风险。一个自然的选择是将所有参与者作为标准人群。\n\n- L分层的总参与者：$N_L = 800 + 200 = 1000$。\n- H分层的总参与者：$N_H = 200 + 800 = 1000$。\n- 总人群：$N = N_L + N_H = 2000$。\n- L分层的权重（L分层在总人群中的比例）：$W_L = \\frac{N_L}{N} = \\frac{1000}{2000} = 0.5$。\n- H分层的权重（H分层在总人群中的比例）：$W_H = \\frac{N_H}{N} = \\frac{1000}{2000} = 0.5$。\n\n这些权重 $W_L$ 和 $W_H$ 仅取决于人群在各分层中的分布，而不依赖于疾病风险。\n\n暴露组的调整后风险 $R_{E+, \\text{adj}}$ 是暴露组分层特异性风险的加权平均值：\n$$R_{E+, \\text{adj}} = W_L \\cdot R_{E+,L} + W_H \\cdot R_{E+,H} = (0.5 \\times 0.20) + (0.5 \\times 0.80) = 0.10 + 0.40 = 0.50$$\n非暴露组的调整后风险 $R_{E-, \\text{adj}}$ 是非暴露组分层特异性风险的加权平均值：\n$$R_{E-, \\text{adj}} = W_L \\cdot R_{E-,L} + W_H \\cdot R_{E-,H} = (0.5 \\times 0.10) + (0.5 \\times 0.40) = 0.05 + 0.20 = 0.25$$\n调整后共同风险比 $RR_{\\text{adj}}$ 是这些标准化风险的比值：\n$$RR_{\\text{adj}} = \\frac{R_{E+, \\text{adj}}}{R_{E-, \\text{adj}}} = \\frac{0.50}{0.25} = 2.0$$\n由于分层特异性风险比是一致的（$2.0$），任何有效的加权平均或标准化度量都必须得出此值。我们的推导从第一性原理证实了这一点。\n\n**任务3：量化混杂**\n\n混杂被量化为从调整后度量到粗度量的相对变化。\n$$ \\text{相对变化} = \\frac{RR_{\\text{crude}} - RR_{\\text{adj}}}{RR_{\\text{adj}}} $$\n使用计算出的值：\n$$ \\text{相对变化} = \\frac{\\frac{16}{17} - 2.0}{2.0} = \\frac{\\frac{16}{17} - \\frac{34}{17}}{2.0} = \\frac{-\\frac{18}{17}}{2} = -\\frac{9}{17} \\approx -0.5294 $$\n这表明存在强烈的负向混杂，其中混杂因素（用餐区）将关联的方向从保护性（粗值）逆转为有害性（调整值）。\n\n**任务4：评估生物易感性带来的效应修饰**\n\n我们根据另一次招待会的数据，计算免疫功能低下和免疫功能正常分层的特异性风险比。\n\n对于免疫功能低下分层（$IC$分层）：\n- 暴露组风险：$R_{E+,IC} = \\frac{54}{60} = 0.90$。\n- 非暴露组风险：$R_{E-,IC} = \\frac{24}{120} = 0.20$。\n- 分层特异性风险比：$RR_{IC} = \\frac{R_{E+,IC}}{R_{E-,IC}} = \\frac{0.90}{0.20} = 4.5$。\n\n对于免疫功能正常分层（$IN$分层）：\n- 暴露组风险：$R_{E+,IN} = \\frac{60}{300} = 0.20$。\n- 非暴露组风险：$R_{E-,IN} = \\frac{60}{600} = 0.10$。\n- 分层特异性风险比：$RR_{IN} = \\frac{R_{E+,IN}}{R_{E-,IN}} = \\frac{0.20}{0.10} = 2.0$。\n\n分层特异性风险比 $RR_{IC} = 4.5$ 和 $RR_{IN} = 2.0$ 存在显著差异。这种效应的异质性证明了免疫状态存在效应修饰。与免疫功能正常组相比，食用鸡肉卷的效应在免疫功能低下组中要强两倍以上。\n\n最终要求回答的是任务2中的调整后共同风险比，四舍五入至四位有效数字。该值为$2.0$。为了用四位有效数字表示，写作$2.000$。", "answer": "$$\n\\boxed{2.000}\n$$", "id": "4554767"}]}