{"hands_on_practices": [{"introduction": "在我们能够预防一种疾病之前，我们必须首先了解它的传播方式。本练习将介绍基本再生数 $R_0$，这是流行病学的基石。通过分析其组成部分，我们可以定量地评估哪些因素为控制工作提供了最大的杠杆作用，从而指导公共卫生策略。[@problem_id:4560012]", "problem": "一个公共卫生团队正在对一种性传播感染 (STI) 的传播进行建模，以确定预防性干预措施的优先顺序。考虑一个同质人群，其中每个感染者以恒定的速率进行性接触，并且每次接触都代表一次独立的伯努利传播试验。设每次接触的传播概率为 $\\beta$（无量纲），单位时间内的平均性接触次数为 $c$（次/月），平均感染持续时间为 $D$（月）。基本再生数（记为 $R_0$）定义为在完全易感人群中，由单个典型感染者所产生的预期二代感染人数。要求在这些假设下，从第一性原理推导出 $R_0$。\n\n仅使用 $R_0$ 的定义和上述假设，首先推导出 $R_0$ 关于 $\\beta$、$c$ 和 $D$ 的符号表达式。然后推导出 $R_0$ 对各参数的局部敏感性，即符号化计算 $\\frac{\\partial R_0}{\\partial \\beta}$、$\\frac{\\partial R_0}{\\partial c}$ 和 $\\frac{\\partial R_0}{\\partial D}$。在 $\\beta = 0.02$，$c = 10$ 次/月，$D = 3$ 月的条件下，计算这些偏导数的值。根据这些值，确定哪个参数在其自身尺度上每单位增加对 $R_0$ 具有最大的绝对影响，并通过计算在指定点上最大和最小绝对偏导数的比率来量化此影响。\n\n将该比率以纯数形式（无单位）报告，并四舍五入至三位有效数字。", "solution": "首先根据指定标准验证问题陈述。\n\n### 步骤 1：提取已知条件\n- $\\beta$：每次接触的传播概率（无量纲）。\n- $c$：单位时间内的平均性接触次数（次/月）。\n- $D$：平均感染持续时间（月）。\n- $R_0$：基本再生数，定义为在完全易感人群中，由单个典型感染者所产生的预期二代感染人数。\n- 该模型假设人群是同质的，每个感染者的性接触速率是恒定的，并且每次接触都是一次独立的伯努利传播试验。\n- 任务是：\n    1. 推导出 $R_0$ 关于 $\\beta$、$c$ 和 $D$ 的符号表达式。\n    2. 推导出局部敏感性：$\\frac{\\partial R_0}{\\partial \\beta}$、$\\frac{\\partial R_0}{\\partial c}$ 和 $\\frac{\\partial R_0}{\\partial D}$。\n    3. 在 $\\beta = 0.02$、$c = 10$ 和 $D = 3$ 的条件下计算这些偏导数的值。\n    4. 确定哪个参数具有最大的绝对影响。\n    5. 计算在指定点上最大和最小绝对偏导数的比率。\n    6. 将该比率四舍五入至三位有效数字并报告。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性：** 该问题描述了流行病学中的一个基本概念——基本再生数（$R_0$）。将 $R_0$ 表述为每次接触的传播概率、接触率和感染持续时间的乘积，是简单传染病模型的标准第一性原理推导。其假设（同质混合、恒定速率）是构建基线模型的标准简化方法。该问题是科学合理的。\n- **良定性：** 该问题为 $R_0$ 及其推导所需的参数提供了明确的定义。各项任务是序列化、逻辑化的，并能导出一个唯一的定量答案。该问题是良定的。\n- **客观性：** 语言正式，没有主观性或偏见。所有术语均在流行病学的标准词汇范围内定义。\n\n### 步骤 3：结论与行动\n该问题具有科学性、良定性和客观性，不包含不一致、歧义或事实错误。因此，该问题被认为是**有效的**。现在开始推导解答。\n\n基本再生数 $R_0$ 定义为在完全易感人群中，单个感染者产生的预期新感染人数。根据问题的假设，我们可以推导出其表达式。\n\n一个感染者平均在单位时间内有 $c$ 次接触。其平均感染期为 $D$。因此，该个体在整个感染期内的总接触次数是接触率与持续时间的乘积：\n$$\n\\text{总接触次数} = c \\times D\n$$\n该量的单位是（次/月）$\\times$（月）= 次，量纲上是一致的。\n\n这些接触中的每一次都是一个独立的事件，其传播概率为 $\\beta$。由于 $R_0$ 是一个个体产生的总传播的期望数，我们将总接触次数乘以每次接触的传播概率：\n$$\nR_0 = \\beta \\times (\\text{总接触次数})\n$$\n代入总接触次数的表达式，我们得到 $R_0$ 的符号表达式：\n$$\nR_0 = \\beta c D\n$$\n\n接下来，我们通过计算偏导数来推导 $R_0$ 对每个参数的局部敏感性。\n\n$R_0$ 对传播概率 $\\beta$ 的偏导数为：\n$$\n\\frac{\\partial R_0}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} (\\beta c D) = c D\n$$\n\n$R_0$ 对接触率 $c$ 的偏导数为：\n$$\n\\frac{\\partial R_0}{\\partial c} = \\frac{\\partial}{\\partial c} (\\beta c D) = \\beta D\n$$\n\n$R_0$ 对感染持续时间 $D$ 的偏导数为：\n$$\n\\frac{\\partial R_0}{\\partial D} = \\frac{\\partial}{\\partial D} (\\beta c D) = \\beta c\n$$\n\n现在，我们在指定点上计算这些偏导数的值：$\\beta = 0.02$，$c = 10$ 次/月，以及 $D = 3$ 月。\n\n$$\n\\frac{\\partial R_0}{\\partial \\beta} \\bigg|_{(\\beta, c, D) = (0.02, 10, 3)} = c D = (10)(3) = 30\n$$\n\n$$\n\\frac{\\partial R_0}{\\partial c} \\bigg|_{(\\beta, c, D) = (0.02, 10, 3)} = \\beta D = (0.02)(3) = 0.06\n$$\n\n$$\n\\frac{\\partial R_0}{\\partial D} \\bigg|_{(\\beta, c, D) = (0.02, 10, 3)} = \\beta c = (0.02)(10) = 0.2\n$$\n\n为了确定哪个参数在其自身尺度上每单位增加具有最大的绝对影响，我们比较这些敏感性的绝对值：\n$$\n\\left| \\frac{\\partial R_0}{\\partial \\beta} \\right| = 30\n$$\n$$\n\\left| \\frac{\\partial R_0}{\\partial c} \\right| = 0.06\n$$\n$$\n\\left| \\frac{\\partial R_0}{\\partial D} \\right| = 0.2\n$$\n\n比较这些值，我们发现 $30 > 0.2 > 0.06$。最大的绝对偏导数是关于 $\\beta$ 的，最小的是关于 $c$ 的。这意味着，在此工作点上，$R_0$ 对 $\\beta$ 的单位变化最敏感，而对 $c$ 的单位变化最不敏感。\n\n最后，我们计算最大与最小绝对偏导数的比率：\n$$\n\\text{比率} = \\frac{\\text{最大绝对导数}}{\\text{最小绝对导数}} = \\frac{\\left| \\frac{\\partial R_0}{\\partial \\beta} \\right|}{\\left| \\frac{\\partial R_0}{\\partial c} \\right|} = \\frac{30}{0.06}\n$$\n$$\n\\text{比率} = \\frac{30}{\\frac{6}{100}} = 30 \\times \\frac{100}{6} = \\frac{3000}{6} = 500\n$$\n问题要求答案四舍五入至三位有效数字。精确值为 $500$。用三位有效数字表示为 $500$（其中末尾的零是有效数字），或者更明确地写为 $5.00 \\times 10^2$。", "answer": "$$\n\\boxed{5.00 \\times 10^{2}}\n$$", "id": "4560012"}, {"introduction": "筛查是控制性传播感染的关键工具，但没有一种检测是完美的。本练习侧重于利用灵敏度、特异度和患病率来计算检测在现实世界中的表现，即其阳性预测值 ($PPV$) 和阴性预测值 ($NPV$) 。这项技能对于解读检测结果和理解筛查项目的有效性至关重要。[@problem_id:4559993]", "problem": "一个公共卫生部门正在评估一个针对无症状人群中使用快速检测进行性传播感染（STI）筛查的新项目。据报告，该检测的灵敏度为 $0.95$，特异度为 $0.98$。该感染在目标人群中的时点患病率为 $0.08$。请仅使用灵敏度、特异度和患病率作为条件概率的基本定义，结合全概率公式和贝叶斯定理，计算此情境下的阳性预测值（$PPV$）和阴性预测值（$NPV$）。然后，基于这些值，简要解释它们对于筛查产出（就筛查个体中的真阳性和假阳性而言）意味着什么。\n\n将 $PPV$ 和 $NPV$ 四舍五入至四位有效数字，并以无单位小数表示。以行矩阵的形式提供最终数值结果，作为一个有序对 $\\big(PPV,\\,NPV\\big)$。解释部分应包含在您的推理过程中，但它不属于最终数值答案的一部分。", "solution": "该问题要求在给定筛查测试的灵敏度、特异度以及人群中感染的患病率的情况下，计算其阳性预测值（$PPV$）和阴性预测值（$NPV$）。解答应从第一性原理推导得出，即这些指标作为条件概率的定义、全概率公式和贝叶斯定理。\n\n首先，我们定义相关事件：\n- $D$：个体患有性传播感染（STI）的事件。\n- $D^c$：个体未患有STI的事件。\n- $T^+$：检测结果为阳性的事件。\n- $T^-$：检测结果为阴性的事件。\n\n问题提供了以下信息，我们将其转化为概率术语：\n1.  **患病率**：从人群中随机选择的个体患有该感染的概率。\n    $$P(D) = 0.08$$\n    由此，未患有该感染的概率为：\n    $$P(D^c) = 1 - P(D) = 1 - 0.08 = 0.92$$\n\n2.  **灵敏度**：在个体患有感染的情况下，检测结果为阳性的概率。这是真阳性率。\n    $$\\text{Sensitivity} = P(T^+ | D) = 0.95$$\n\n3.  **特异度**：在个体未患有感染的情况下，检测结果为阴性的概率。这是真阴性率。\n    $$\\text{Specificity} = P(T^- | D^c) = 0.98$$\n\n根据这些定义，我们还可以确定错误结果的概率：\n-   **假阴性率**：在个体患有感染的情况下，检测结果为阴性的概率。\n    $$P(T^- | D) = 1 - P(T^+ | D) = 1 - 0.95 = 0.05$$\n-   **假阳性率**：在个体未患有感染的情况下，检测结果为阳性的概率。\n    $$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - 0.98 = 0.02$$\n\n待计算的量是：\n-   **阳性预测值 ($PPV$)**：在检测结果为阳性的情况下，个体患有感染的概率，即 $P(D | T^+)$。\n-   **阴性预测值 ($NPV$)**：在检测结果为阴性的情况下，个体未患有感染的概率，即 $P(D^c | T^-)$。\n\n我们使用贝叶斯定理来求这些值。对于 $PPV$：\n$$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\n分母 $P(T^+)$ 是获得阳性检测结果的总概率。我们使用全概率公式，通过对两个不相交事件 $D$ 和 $D^c$ 上获得阳性检测的概率求和来找到它：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n代入已知值和符号表示：\n$$P(T^+) = (\\text{Sensitivity}) \\cdot P(D) + (1 - \\text{Specificity}) \\cdot P(D^c)$$\n$$P(T^+) = (0.95)(0.08) + (0.02)(0.92) = 0.076 + 0.0184 = 0.0944$$\n现在，我们可以计算 $PPV$：\n$$PPV = \\frac{P(T^+ | D) P(D)}{P(T^+)} = \\frac{(0.95)(0.08)}{0.0944} = \\frac{0.076}{0.0944} \\approx 0.8050847...$$\n四舍五入至四位有效数字，$PPV \\approx 0.8051$。\n\n类似地，对于 $NPV$，我们使用贝叶斯定理：\n$$NPV = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}$$\n分母 $P(T^-)$ 是获得阴性检测结果的总概率，同样通过全概率公式求得：\n$$P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)$$\n代入已知值和符号表示：\n$$P(T^-) = (\\text{Specificity}) \\cdot P(D^c) + (1 - \\text{Sensitivity}) \\cdot P(D)$$\n$$P(T^-) = (0.98)(0.92) + (0.05)(0.08) = 0.9016 + 0.004 = 0.9056$$\n注意 $P(T^+) + P(T^-) = 0.0944 + 0.9056 = 1$，正如预期。\n现在，我们可以计算 $NPV$：\n$$NPV = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)} = \\frac{(0.9016)}{0.9056} \\approx 0.995583...$$\n四舍五入至四位有效数字，$NPV \\approx 0.9956$。\n\n**解释**：\n阳性预测值（$PPV$）为 $0.8051$ 意味着，在所有检测结果为阳性的个体中，大约有 $80.51\\%$ 是真阳性（他们确实患有STI）。剩下的 $19.49\\%$ 是假阳性。这意味着虽然阳性结果是感染的强有力指标，但大约每 $5$ 个阳性结果中就有 $1$ 个是错误的，因此有必要进行确认性检测。这就是阳性结果的“筛查产出”。\n\n阴性预测值（$NPV$）为 $0.9956$ 意味着，在所有检测结果为阴性的个体中，大约有 $99.56\\%$ 是真阴性（他们实际上没有患STI）。这个非常高的 $NPV$ 表明，阴性检测结果在排除感染方面非常可靠。阴性结果的筛查产出非常好，漏诊的病例非常少（假阴性率，即 $1 - NPV \\approx 0.0044$ 或 $0.44\\%$）。\n\n总之，该筛查项目在识别未感染个体方面非常有效，但会产生相当一部分假阳性，这些假阳性必须在临床路径中得到处理。", "answer": "$$\\boxed{\\begin{pmatrix} 0.8051 & 0.9956 \\end{pmatrix}}$$", "id": "4559993"}, {"introduction": "本高级练习超越了对单个检测的评估，旨在解决整个筛查项目的设计问题。通过使用概率模型，你将确定最佳的筛查时间间隔，以便及时发现新的感染。这展示了数学建模如何为资源分配和公共卫生政策提供信息。[@problem_id:4560038]", "problem": "一项旨在预防性传播感染（STI）的公共卫生项目，其目标是制定一个筛查计划，在确保及时发现新发感染的同时，最大限度地减少筛查负担。假设给定个体的新发感染遵循一个速率为每人月 $\\lambda$ 的泊松过程，而筛查机会独立于感染，遵循一个速率为每人月 $s$ 的泊松过程。当进行筛查时，该个体中任何现有的未检测出的感染都以概率 $1$ 被检测出来。在这些假设下，从感染到检测的时间就是下一次筛查事件的等待时间。\n\n该项目的目标是，一次感染在超过阈值 $T$ 个月后仍未被检测出的概率小于 $0.1$。设筛查间隔定义为 $\\Delta = 1/s$ 个月。给定 $\\lambda = 0.02$ 每人月和 $T = 2$ 个月，请从第一性原理推导 $s$、$T$ 与检测延迟超过 $T$ 的概率之间的关系，然后确定满足该项目目标的最大 $\\Delta$。请以月为单位表示 $\\Delta$ 的最终答案，并四舍五入到四位有效数字。", "solution": "我们从泊松过程的基本定义开始：事件以恒定速率独立发生，且到下一个事件的等待时间呈指数分布。具体来说，对于一个速率为每人月 $s$ 的泊松过程，到下一个事件的等待时间 $D$ 服从指数分布，其概率密度函数为\n$$\nf_{D}(d) = s \\exp(-s d), \\quad d \\geq 0,\n$$\n其生存函数为\n$$\n\\mathbb{P}(D > t) = \\exp(-s t), \\quad t \\geq 0.\n$$\n在这种情况下，检测机制被建模为一个速率为 $s$ 的泊松过程，且独立于感染的发生。当感染发生时，由于独立性以及筛查时检测概率为 $1$ 的假设，检测的延迟恰好是到下一次筛查事件的等待时间 $D$。\n\n因此，一次感染在超过 $T$ 个月后仍未被检测出的概率为\n$$\n\\mathbb{P}(D > T) = \\exp(-s T).\n$$\n该项目目标施加了以下约束条件\n$$\n\\exp(-s T) \\leq 0.1.\n$$\n为了最小化筛查负担，我们选择满足此不等式的最小 $s$（等价于最大 $\\Delta = 1/s$）。对 $s$ 求解，\n$$\n\\exp(-s T) \\leq 0.1 \\quad \\Longrightarrow \\quad -s T \\leq \\ln(0.1) \\quad \\Longrightarrow \\quad s \\geq \\frac{-\\ln(0.1)}{T}.\n$$\n使用恒等式 $\\ln(0.1) = -\\ln(10)$，这可以简化为\n$$\ns^{\\ast} = \\frac{\\ln(10)}{T}.\n$$\n最优筛查间隔 $\\Delta^{\\ast}$ 是 $s^{\\ast}$ 的倒数，\n$$\n\\Delta^{\\ast} = \\frac{1}{s^{\\ast}} = \\frac{T}{\\ln(10)}.\n$$\n代入 $T = 2$ 个月，\n$$\n\\Delta^{\\ast} = \\frac{2}{\\ln(10)}.\n$$\n数值上，$\\ln(10) \\approx 2.302585093$，所以\n$$\n\\Delta^{\\ast} \\approx \\frac{2}{2.302585093} \\approx 0.868588964.\n$$\n四舍五入到四位有效数字，得到\n$$\n\\Delta^{\\ast} \\approx 0.8686 \\text{ 个月}.\n$$\n为了完整起见，我们注意到发病率 $\\lambda = 0.02$ 每人月并不影响检测延迟超过 $T$ 的新发感染的比例，因为在独立性假设下，$\\mathbb{P}(D > T)$ 仅取决于筛查率 $s$ 和阈值 $T$。然而，它确实将每人月内未被检测时间超过 $T$ 的预期感染数调整为 $\\lambda \\exp(-s T)$，在最优的 $s^{\\ast}$ 下，这个值变为 $\\lambda \\times 0.1 = 0.002$ 每人月，这与将目标解释为比例时是一致的。", "answer": "$$\\boxed{0.8686}$$", "id": "4560038"}]}