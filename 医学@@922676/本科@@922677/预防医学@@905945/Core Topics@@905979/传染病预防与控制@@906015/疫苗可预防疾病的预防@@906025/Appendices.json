{"hands_on_practices": [{"introduction": "疫苗接种的最终目标不仅是保护个体，更是通过实现“群体免疫”来保护整个社区。有效再生数 $R_e$ 是衡量群体免疫水平的关键指标，它代表在一个部分免疫的人群中，一个感染者平均能传染的人数。本练习将让你亲手计算在已知疫苗覆盖率和疫苗效力的情况下，特定社区的 $R_e$ 值，从而能够直接评估其暴发疾病的风险。[@problem_id:4560992]", "problem": "一个公共卫生团队正在一个封闭的、均匀混合的社区中评估麻疹的传播潜力。麻疹疫苗是以麻疹-腮腺炎-风疹（MMR）三联疫苗的形式接种的。该社区的疫苗覆盖率为 $0.88$，对于接种者，疫苗对感染的保护效力为 $VE = 0.93$。假设先前感染产生的免疫力可忽略不计，在所考虑的时间尺度内免疫力没有衰减，并且人群的接触结构是同质的，如同易感-感染-康复（SIR）框架中一样。使用麻疹基本再生数 $R_0$ 的定义，即在一个完全易感的群体中，一个典型的感染病例所产生的平均继发病例数，并在此情境下取麻疹的 $R_0 = 15$。\n\n从与SIR模型及上述定义一致的第一性原理出发，推导部分免疫如何影响传播，并计算该社区麻疹的有效再生数 $R_e$。将 $R_e$ 的最终数值四舍五入到三位有效数字。根据您计算出的 $R_e$，简要评估是否已实现群体免疫（解释为 $R_e  1$）以及定性的疫情爆发潜力。所有比例均以小数表示。", "solution": "题目陈述被评估为科学上合理、内容自洽且问题设定良好，为得出有效解提供了充分且一致的信息。因此，我们可以进行推导。\n\n在部分免疫人群中分析疾病传播的核心原理是基本再生数 $R_0$ 与有效再生数 $R_e$ 之间的关系。基本再生数 $R_0$ 代表在一个完全易感的人群中，由单个典型感染者引起的平均继发感染数。有效再生数 $R_e$ 是在由于免疫而并非完全易感的人群中的类似量。\n\n$R_e$ 的值与人群中易感个体的比例成正比。设这个比例为 $s$。它们的关系由以下公式给出：\n$$R_e = R_0 \\cdot s$$\n\n问题在于确定给定社区的 $s$ 值。该人群的特征是疫苗覆盖率（我们表示为 $p_v$）和疫苗效力 $VE$。给定的值为 $p_v = 0.88$ 和 $VE = 0.93$。题目说明假设先前感染产生的免疫力可忽略不计。因此，人群中的易感性仅因疫苗接种而降低。\n\n我们可以将总人口分为两组：接种疫苗者和未接种疫苗者。\n\n1.  人群中**未接种疫苗**的比例是 $1 - p_v$。由于没有其他免疫来源，这整个群体都易受感染。\n    他们对总易感比例的贡献是 $1 - p_v$。\n\n2.  人群中**已接种疫苗**的比例是 $p_v$。疫苗并非完全有效。疫苗效力 $VE$ 是指接种疫苗后成功获得感染保护的个体比例。因此，尽管接种了疫苗但仍然易感的个体（即疫苗失败者）的比例是 $1 - VE$。\n    该群体对总易感比例的贡献是接种疫苗的人数比例乘以这些疫苗接种未能提供保护的比例：$p_v \\cdot (1 - VE)$。\n\n易感个体的总比例 $s$ 是未接种疫苗群体和已接种疫苗群体中易感比例的总和：\n$$s = (1 - p_v) + p_v \\cdot (1 - VE)$$\n\n我们可以对这个表达式进行代数简化，得到一个等价形式：\n$$s = 1 - p_v + p_v - p_v \\cdot VE = 1 - p_v \\cdot VE$$\n第二种形式表明，易感比例是 $1$ 减去总人口中通过疫苗成功免疫的比例，即 $p_v \\cdot VE$。我们将使用第一种表达式，因为它更明确地从亚群构建而来。\n\n现在，我们将给定值代入 $s$ 的表达式中：\n$p_v = 0.88$\n$VE = 0.93$\n\n$$s = (1 - 0.88) + 0.88 \\cdot (1 - 0.93)$$\n$$s = 0.12 + 0.88 \\cdot (0.07)$$\n$$s = 0.12 + 0.0616$$\n$$s = 0.1816$$\n\n因此，人群中对麻疹易感的比例是 $0.1816$，即 $18.16\\%$。\n\n接下来，我们使用给定的麻疹基本再生数 $R_0 = 15$ 来计算有效再生数 $R_e$。\n$$R_e = R_0 \\cdot s$$\n$$R_e = 15 \\cdot 0.1816$$\n$$R_e = 2.724$$\n\n题目要求将最终数值四舍五入到三位有效数字。\n$$R_e \\approx 2.72$$\n\n最后，我们必须评估是否实现了群体免疫，并对疫情爆发的潜力进行评论。当有效再生数小于1，即 $R_e  1$ 时，就实现了群体免疫。这个条件确保了平均而言，一个感染者将感染传播给少于一个人，从而导致疫情消亡。\n\n在这个社区中，计算出的有效再生数是 $R_e \\approx 2.72$。由于 $R_e > 1$，群体免疫尚未实现。由于有效再生数远大于1，将麻疹病例引入该社区预计将导致持续的社区传播和重大疫情爆发，因为每个病例平均会产生 $2.72$ 个新病例。", "answer": "$$\\boxed{2.72}$$", "id": "4560992"}, {"introduction": "在群体免疫计算中使用的参数，如疫苗有效性 (Vaccine Effectiveness, VE)，必须根据真实世界的数据进行精确测量。测试阴性设计 (test-negative design) 是一种强大且常用的观察性研究方法，常用于估算流感等疾病的疫苗有效性。本练习将指导你完成从研究数据中计算 VE 及其置信区间的整个统计过程，这是解读流行病学研究报告的一项关键技能。[@problem_id:4561028]", "problem": "一项流感季节观察性研究使用测试阴性设计（test-negative design）来估计季节性流感疫苗在出现急性呼吸道疾病的成年人中的有效性。通过逆转录聚合酶链式反应（RT-PCR）确诊流感的个体被归类为测试阳性（病例），而流感测试呈阴性的个体被归类为测试阴性（对照）。疫苗接种状态在发病前被确定。观察到以下单元格计数：已接种疫苗的测试阳性者 $a = 120$，未接种疫苗的测试阳性者 $b = 180$，已接种疫苗的测试阴性者 $c = 680$，以及未接种疫苗的测试阴性者 $d = 520$。\n\n仅从优势（odds）和优势比（odds ratio）的核心定义，以及基于独立单元格计数的优势比对数的大样本正态近似出发，推导比较病例与对照的疫苗接种优势比的点估计值，然后推导疫苗有效性，其定义为 $1 - \\text{odds ratio}$。使用对数优势比方法和$\\ln(\\text{odds ratio})$近似服从正态分布的标准大样本结果，构建优势比的95%置信区间，并将其转换为疫苗有效性的95%置信区间。\n\n按此顺序报告三个十进制数量：疫苗有效性点估计值、其95%置信区间的下界和上界。将最终的疫苗有效性数量表示为小数（而非百分比）。将您报告的值四舍五入至四位有效数字。", "solution": "测试阴性设计比较了病例中的疫苗接种优势与对照中的疫苗接种优势。设 $2 \\times 2$ 表格的单元格为 $a$（已接种疫苗的病例）、$b$（未接种疫苗的病例）、$c$（已接种疫苗的对照）和 $d$（未接种疫苗的对照）。根据优势和优势比的定义，病例中的疫苗接种优势为 $a/b$，对照中的为 $c/d$。比较病例与对照的疫苗接种优势比为\n$$\n\\text{OR} \\;=\\; \\frac{a/b}{c/d} \\;=\\; \\frac{a d}{b c}.\n$$\n在测试阴性设计的标准假设下（非差异性检测和可比的就医行为），该优势比估计了已接种疫苗者与未接种疫苗者的发病优势之比，而疫苗有效性（VE）被定义为该优势的比例减少量，即\n$$\n\\text{VE} \\;=\\; 1 - \\text{OR}.\n$$\n\n为了通过对数优势比方法构建95%置信区间，我们使用大样本理论：如果单元格计数来自独立的类泊松抽样或具有固定边际的多项式模型，则根据delta方法\n$$\n\\ln(\\text{OR}) \\;=\\; \\ln(a) + \\ln(d) - \\ln(b) - \\ln(c)\n$$\n近似服从正态分布，其方差为\n$$\n\\mathrm{Var}\\!\\left(\\ln(\\text{OR})\\right) \\;\\approx\\; \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}.\n$$\n这是因为对于一个方差约等于其均值的计数 $N$，$\\mathrm{Var}(\\ln N) \\approx \\left(\\frac{\\partial}{\\partial N}\\ln N\\big|_{N=\\mathbb{E}[N]}\\right)^{2}\\mathrm{Var}(N) = \\left(\\frac{1}{\\mathbb{E}[N]}\\right)^{2}\\mathbb{E}[N] = \\frac{1}{\\mathbb{E}[N]}$，并且独立方差之和适用于所有四个单元格。\n\n因此，$\\ln(\\text{OR})$的标准误（SE）为\n$$\n\\mathrm{SE} \\;=\\; \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}}.\n$$\n在对数尺度上的对称95%置信区间为\n$$\n\\ln(\\text{OR}) \\pm z_{0.975}\\,\\mathrm{SE},\n$$\n其中 $z_{0.975} = 1.96$，取指数运算得到$\\text{OR}$的置信区间。转换为 $\\text{VE} = 1 - \\text{OR}$ 得到VE的相应置信区间：\n$$\n\\big[\\,1 - \\text{OR}_{\\text{upper}},\\; 1 - \\text{OR}_{\\text{lower}}\\,\\big].\n$$\n\n现在用给定的数据进行计算。首先，优势比：\n$$\n\\text{OR} \\;=\\; \\frac{a d}{b c} \\;=\\; \\frac{120 \\times 520}{180 \\times 680} \\;=\\; \\frac{62{,}400}{122{,}400} \\;=\\; \\frac{26}{51}.\n$$\n因此，疫苗有效性的点估计值为\n$$\n\\text{VE} \\;=\\; 1 - \\frac{26}{51} \\;=\\; \\frac{25}{51}.\n$$\n\n接下来，计算标准误：\n$$\n\\mathrm{SE} \\;=\\; \\sqrt{\\frac{1}{120} + \\frac{1}{180} + \\frac{1}{680} + \\frac{1}{520}} \\;=\\; \\sqrt{0.008333333\\ldots + 0.005555556\\ldots + 0.001470588\\ldots + 0.001923077\\ldots}.\n$$\n将平方根内的数值相加，\n$$\n\\frac{1}{120} + \\frac{1}{180} + \\frac{1}{680} + \\frac{1}{520} \\;=\\; 0.017282554\\ldots,\n$$\n所以\n$$\n\\mathrm{SE} \\;\\approx\\; \\sqrt{0.017282554} \\;\\approx\\; 0.131463.\n$$\n\n计算对数优势比：\n$$\n\\ln(\\text{OR}) \\;=\\; \\ln\\!\\left(\\frac{26}{51}\\right) \\;\\approx\\; -0.673729.\n$$\n使用 $z_{0.975} = 1.96$ 在对数尺度上构建95%置信区间：\n$$\n\\ln(\\text{OR}) \\pm 1.96\\,\\mathrm{SE} \\;=\\; -0.673729 \\pm 1.96 \\times 0.131463,\n$$\n$$\n1.96 \\times 0.131463 \\;\\approx\\; 0.257668,\n$$\n所以\n$$\n\\text{lower log bound} \\;=\\; -0.673729 - 0.257668 \\;\\approx\\; -0.931397,\n$$\n$$\n\\text{upper log bound} \\;=\\; -0.673729 + 0.257668 \\;\\approx\\; -0.416061.\n$$\n取指数运算以回到优势比尺度：\n$$\n\\text{OR}_{\\text{lower}} \\;=\\; \\exp(-0.931397) \\;\\approx\\; 0.39400,\n$$\n$$\n\\text{OR}_{\\text{upper}} \\;=\\; \\exp(-0.416061) \\;\\approx\\; 0.65964.\n$$\n转换为疫苗有效性界限：\n$$\n\\text{VE point estimate} \\;=\\; \\frac{25}{51} \\;\\approx\\; 0.490196,\n$$\n$$\n\\text{VE lower bound} \\;=\\; 1 - \\text{OR}_{\\text{upper}} \\;\\approx\\; 1 - 0.65964 \\;\\approx\\; 0.34036,\n$$\n$$\n\\text{VE upper bound} \\;=\\; 1 - \\text{OR}_{\\text{lower}} \\;\\approx\\; 1 - 0.39400 \\;\\approx\\; 0.60600.\n$$\n\n将每个值四舍五入到四位有效数字得到\n$$\n\\text{VE} \\;\\approx\\; 0.4902,\\quad \\text{lower bound} \\;\\approx\\; 0.3404,\\quad \\text{upper bound} \\;\\approx\\; 0.6060.\n$$\n按要求的顺序报告这三个小数。", "answer": "$$\\boxed{\\begin{pmatrix}0.4902  0.3404  0.6060\\end{pmatrix}}$$", "id": "4561028"}, {"introduction": "一个成功的疫苗接种项目不仅取决于其有效性，还取决于其严谨的安全性评估。公共卫生专业人员必须能够量化并沟通疫苗的收益与潜在风险。这最后一个练习将演示如何利用背景发病率和相对风险 (relative risk) 来估算接种后预期发生的不良事件数量，这是药物警戒 (pharmacovigilance) 中的一项基本任务。[@problem_id:4561000]", "problem": "一个公共卫生团队正在通过估算疫苗接种后即刻时期的预期热性惊厥病例数，来评估麻疹、腮腺炎和风疹（MMR）疫苗的短期安全性。考虑一个由$100{,}000$名幼儿组成的队列，他们在同一天接种了麻疹、腮腺炎和风疹（MMR）疫苗。基于标准的流行病学定义和经过充分检验的事实，假设如下：\n\n- 幼儿热性惊厥的背景发病率是恒定的，为每$100{,}000$人日$2$例。\n- 在接种疫苗后的$7$天内，热性惊厥的相对风险（定义为暴露组发病率与非暴露组发病率之比）是背景率的$3$倍。\n- 假设在所述时间窗口内，发病率在个体间和时间上是均一的，并且在$7$天的时间间隔内没有失访或竞争风险。\n\n使用发病率、人时和相对风险的定义，计算该队列在接种疫苗后立即的$7$天内发生的预期热性惊厥病例数。\n\n将您的最终答案表示为一个代表预期病例数的纯数字（无单位）。无需四舍五入。", "solution": "此计算的基本依据采用了标准的流行病学定义：\n\n1. 发病率是每单位人时的预期事件数。如果背景发病率为每$100{,}000$人日$\\lambda_{0}$个事件，那么每人日发病率为\n$$\n\\lambda_{0}^{\\ast} \\;=\\; \\frac{\\lambda_{0}}{100{,}000} \\quad \\text{events per person-day}.\n$$\n\n2. 对于一个大小为$N$、观察时间为$T$天的队列，总人时为\n$$\n\\text{PT} \\;=\\; N \\times T \\quad \\text{person-days}.\n$$\n\n3. 在观察窗口内，给定恒定发病率的预期事件数是发病率与人时的乘积。如果暴露使发病率增加了一个等于相对风险$RR$的乘法因子，那么暴露发病率是$RR \\times \\lambda_{0}^{\\ast}$，暴露窗口内的预期事件数是\n$$\n\\mathbb{E} \\;=\\; (RR \\times \\lambda_{0}^{\\ast}) \\times \\text{PT}.\n$$\n\n我们现在应用给定的量：\n- $N \\;=\\; 100{,}000$，\n- $T \\;=\\; 7$，\n- $\\lambda_{0} \\;=\\; 2$ 每$100{,}000$人日，因此$\\lambda_{0}^{\\ast} \\;=\\; \\frac{2}{100{,}000}$ 每人日，\n- $RR \\;=\\; 3$。\n\n计算人时：\n$$\n\\text{PT} \\;=\\; N \\times T \\;=\\; 100{,}000 \\times 7 \\;=\\; 700{,}000 \\quad \\text{person-days}.\n$$\n\n计算暴露下的预期事件数：\n$$\n\\mathbb{E} \\;=\\; (RR \\times \\lambda_{0}^{\\ast}) \\times \\text{PT}\n\\;=\\; \\left(3 \\times \\frac{2}{100{,}000}\\right) \\times 700{,}000\n\\;=\\; 3 \\times \\left(\\frac{2 \\times 700{,}000}{100{,}000}\\right)\n\\;=\\; 3 \\times \\left(\\frac{1{,}400{,}000}{100{,}000}\\right)\n\\;=\\; 3 \\times 14\n\\;=\\; 42.\n$$\n\n因此，该队列在接种疫苗后立即的$7$天内，预期的热性惊厥病例数为$42$。", "answer": "$$\\boxed{42}$$", "id": "4561000"}]}