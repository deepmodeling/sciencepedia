{"hands_on_practices": [{"introduction": "要应用似然比，第一步是理解它们如何从诊断试验的基本性能指标——即灵敏度（$Se$）和特异度（$Sp$）——中派生出来。本练习将指导您完成这一基础计算，它将试验的内在准确性转化为一个单一的、有力的指标，用以量化阳性或阴性结果所提供的证据强度。[@problem_id:4557276]", "problem": "一个社区预防性健康项目正在评估一种新采用的针对无症状传染病的筛查测试。该测试的性能已在一项多中心验证研究中得到证实。该验证提供了以下汇总指标：灵敏度 $Se = 0.90$ 和特异度 $Sp = 0.95$。灵敏度是指在真正患病的个体中测试结果为阳性的概率，而特异度是指在真正未患病的个体中测试结果为阴性的概率。仅使用灵敏度和特异度作为条件概率的这些基本定义，计算此测试的阳性似然比和阴性似然比。然后，基于这些值，解释阳性结果和阴性结果在多大程度上改变了疾病比值，从而说明它们所提供的证据强度。将两个数值答案四舍五入至四位有效数字，并以小数形式表示。此计算不需要关于疾病患病率的额外数据。", "solution": "问题陈述经过了严格验证，被认为是科学合理的、定义明确的且客观的。它为完整解答提供了所有必要信息，没有任何内部矛盾或含糊不清之处。该问题是生物统计学和流行病学基本原理的标准应用。\n\n我们定义以下事件：\n- $D$：个体患有该疾病的事件。\n- $D^c$：个体未患该疾病的事件。\n- $T^+$：测试结果为阳性的事件。\n- $T^-$：测试结果为阴性的事件。\n\n问题提供了以下定义和数值：\n- 灵敏度 ($Se$)：在真正患病的个体中测试结果为阳性的概率。用条件概率表示为 $Se = P(T^+ | D)$。\n- 特异度 ($Sp$)：在真正未患病的个体中测试结果为阴性的概率。用条件概率表示为 $Sp = P(T^- | D^c)$。\n\n给定值为 $Se = 0.90$ 和 $Sp = 0.95$。\n\n任务是计算阳性似然比 ($LR+$) 和阴性似然比 ($LR-$)。\n\n阳性似然比 $LR+$ 定义为患病个体中测试结果为阳性的概率与非患病个体中测试结果为阳性的概率之比。\n$$LR+ = \\frac{P(T^+ | D)}{P(T^+ | D^c)}$$\n分子 $P(T^+ | D)$ 是灵敏度 $Se$。\n分母 $P(T^+ | D^c)$ 是非患病者测试结果为阳性的概率，即假阳性率。由于对于任何条件事件，所有结果的概率之和必须为 $1$，我们有 $P(T^+ | D^c) + P(T^- | D^c) = 1$。项 $P(T^- | D^c)$ 是特异度 $Sp$。因此，假阳性率为 $P(T^+ | D^c) = 1 - Sp$。\n\n将这些表达式代入 $LR+$ 的公式中：\n$$LR+ = \\frac{Se}{1 - Sp}$$\n\n使用提供的数值：\n$$LR+ = \\frac{0.90}{1 - 0.95} = \\frac{0.90}{0.05} = 18$$\n\n阴性似然比 $LR-$ 定义为患病个体中测试结果为阴性的概率与非患病个体中测试结果为阴性的概率之比。\n$$LR- = \\frac{P(T^- | D)}{P(T^- | D^c)}$$\n分母 $P(T^- | D^c)$ 是特异度 $Sp$。\n分子 $P(T^- | D)$ 是患病者测试结果为阴性的概率，即假阴性率。使用与之前相同的逻辑，$P(T^+ | D) + P(T^- | D) = 1$。项 $P(T^+ | D)$ 是灵敏度 $Se$。因此，假阴性率为 $P(T^- | D) = 1 - Se$。\n\n将这些表达式代入 $LR-$ 的公式中：\n$$LR- = \\frac{1 - Se}{Sp}$$\n\n使用提供的数值：\n$$LR- = \\frac{1 - 0.90}{0.95} = \\frac{0.10}{0.95}$$\n$$LR- \\approx 0.105263157...$$\n按要求四舍五入到四位有效数字，我们得到 $LR- = 0.1053$。\n\n最终的数值结果是 $LR+ = 18$ 和 $LR- \\approx 0.1053$。将 $18$ 表示为四位有效数字得到 $18.00$。\n\n结果解读：\n似然比描述了测试结果在多大程度上改变了患病的比值。其关系为：检验后比值 = 检验前比值 $\\times$ 似然比。\n- 阳性结果 ($T^+$) 对应于 $LR+ = 18.00$。这意味着阳性测试结果使患病比值增加了 $18$ 倍。在临床实践中，$LR+  10$ 被认为为确诊该疾病提供了强有力的证据。因此，该测试的阳性结果是该个体患病的有力指标。\n- 阴性结果 ($T^-$) 对应于 $LR- = 0.1053$。这意味着阴性测试结果将检验前患病比值乘以 $0.1053$。$LR-  0.1$ 通常被认为是排除该疾病的强有力证据。值 $0.1053$ 非常接近这个阈值，表明阴性测试结果为排除疾病提供了中等到强度的证据，显著降低了其可能性。", "answer": "$$\\boxed{\\begin{pmatrix} 18.00  0.1053 \\end{pmatrix}}$$", "id": "4557276"}, {"introduction": "计算出似然比后，下一步就是将其应用于临床决策。本练习通过一个清晰的案例，演示了贝叶斯更新的核心过程：如何将一个初始的验前概率转换为验前比值，利用似然比进行更新，最终得到更为精确的验后概率。这个过程是循证医学中评估诊断信息价值的基石。[@problem_id:4557324]", "problem": "一家社区预防医学诊所正在试行一项针对潜伏性传染病的基于风险的筛查项目。对于高风险分层中的个体，其患有该病的先验概率为 $p=0.10$。筛查检测返回了单一阳性结果，且验证研究表明阳性测试的似然比 ($LR^{+}$) 为 $8$。请仅使用概率、优势、似然比和贝叶斯定理的核心定义，将先验概率 $p$ 转换为先验优势 $\\frac{p}{1-p}$，使用 $LR^{+}$ 更新得到后验优势，然后将其转换回这次单一阳性测试后的后验概率。请明确展示每个转换步骤。将最终的后验概率以小数形式表示，并四舍五入至四位有效数字。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 第1步：提取已知条件\n- 患病的先验概率：$p=0.10$。\n- 筛查检测结果：单一阳性结果。\n- 阳性测试的似然比：$LR^{+} = 8$。\n- 任务是通过先将先验概率转换为先验优势，然后使用似然比更新得到后验优势，最后将后验优势转换回后验概率，来计算阳性测试后的后验概率。最终答案必须是四舍五入至四位有效数字的小数。\n\n### 第2步：使用提取的已知条件进行验证\n根据指定标准对问题进行评估：\n- **科学依据**：该问题使用了流行病学和生物统计学中经过验证的核心概念，即先验概率、优势、似然比和贝叶斯更新。这些是临床和预防医学中解释诊断测试结果的标准工具。给定值（$p=0.10$，$LR^{+}=8$）对于应用于高风险人群的中等性能测试而言是切合实际的。该问题在科学上是合理的。\n- **良构性**：所有必要信息均已提供。概率、优势和似然比之间的关系定义明确。指示明确，并能导出一个唯一、稳定的解。该问题是良构的。\n- **客观性**：语言精确且量化，没有任何主观或模棱两可的术语。\n\n### 第3步：结论与行动\n该问题有效。这是贝叶斯原理在医学背景下的直接应用。将提供完整的解答。\n\n解答过程遵循问题陈述中概述的步骤。设 $D$ 为个体患有该病的事件，设 $T^{+}$ 为测试结果为阳性的事件。\n\n先验概率给定为 $P(D) = p = 0.10$。\n\n**第1步：将先验概率转换为先验优势。**\n\n概率 $P$ 和优势 $O$ 之间的关系定义为 $O = \\frac{P}{1-P}$。\n患病的先验优势 $O_{\\text{prior}}$ 是根据先验概率 $p$ 计算的：\n$$\nO_{\\text{prior}} = \\frac{p}{1-p}\n$$\n代入给定值 $p=0.10$：\n$$\nO_{\\text{prior}} = \\frac{0.10}{1 - 0.10} = \\frac{0.10}{0.90} = \\frac{1}{9}\n$$\n\n**第2步：使用 $LR^{+}$ 更新以获得后验优势。**\n\n贝叶斯定理可以用优势和似然比来表示。后验优势是先验优势与相应似然比的乘积。对于阳性测试结果 ($T^{+}$)，我们使用阳性似然比 $LR^{+}$。\n$$\n\\text{后验优势} = \\text{先验优势} \\times \\text{似然比}\n$$\n在我们的记法中，即为：\n$$\nO_{\\text{post}} = O_{\\text{prior}} \\times LR^{+}\n$$\n此处，$O_{\\text{post}}$ 表示在测试结果为阳性的条件下患病的优势，即 $O(D|T^{+})$。\n代入 $O_{\\text{prior}}$ 和 $LR^{+}$ 的值：\n$$\nO_{\\text{post}} = \\frac{1}{9} \\times 8 = \\frac{8}{9}\n$$\n\n**第3步：将后验优势转换回后验概率。**\n\n将优势 $O$ 转换回概率 $P$ 的关系是 $P = \\frac{O}{1+O}$。\n后验概率 $P_{\\text{post}}$ 是指在测试结果为阳性的条件下患病的概率，即 $P(D|T^{+})$。它是根据后验优势 $O_{\\text{post}}$ 计算的：\n$$\nP_{\\text{post}} = \\frac{O_{\\text{post}}}{1 + O_{\\text{post}}}\n$$\n代入 $O_{\\text{post}}$ 的值：\n$$\nP_{\\text{post}} = \\frac{\\frac{8}{9}}{1 + \\frac{8}{9}} = \\frac{\\frac{8}{9}}{\\frac{9}{9} + \\frac{8}{9}} = \\frac{\\frac{8}{9}}{\\frac{17}{9}} = \\frac{8}{17}\n$$\n\n**最终计算与四舍五入**\n\n问题要求最终答案以小数形式表示，并四舍五入至四位有效数字。\n$$\nP_{\\text{post}} = \\frac{8}{17} \\approx 0.470588235...\n$$\n四舍五入至四位有效数字，得到：\n$$\nP_{\\text{post}} \\approx 0.4706\n$$\n该值表示个体在收到单一阳性测试结果后患有该潜伏性疾病的更新概率。", "answer": "$$\n\\boxed{0.4706}\n$$", "id": "4557324"}, {"introduction": "在掌握了基本计算和应用之后，我们来探讨一个在预防医学中至关重要的现实挑战：基础概率谬误（base rate fallacy）。即使一个试验具有很高的灵敏度和特异度，当筛查罕见病时，其阳性结果的意义也可能出人意料地低。本练习将通过计算阳性预测值（PPV），揭示疾病患病率（即基础概率）如何深刻影响我们对检测结果的解读。[@problem_id:4979036]", "problem": "一家医院对一种罕见病症部署了一项筛查测试。设疾病的患病率为 $\\pi = 0.001$，测试的灵敏度为 $Se = 0.95$，测试的特异度为 $Sp = 0.98$。仅使用灵敏度、特异度、患病率的核心定义以及贝叶斯法则，推导阳性预测值 (PPV) 的表达式，其定义为在测试结果为阳性的条件下患有该疾病的概率，$PPV = P(\\text{Disease} \\mid \\text{Test}+)$。根据给定的参数评估该值，并以小数形式提供最终值。将最终数值答案四舍五入至五位有效数字，不要使用百分号。\n\n此外，请基于贝叶斯法则和几率的概率推理，解释为什么在这种情况下，即使测试具有高灵敏度和高特异度，阳性结果仍然可能对应于较低的患病概率。您的解释应精确地提及基础率（患病率）的作用，以及当 $\\pi$ 非常小时假阳性是如何产生影响的。\n\n将最终数值答案表示为具有五位有效数字的小数，且不包含任何单位。", "solution": "该问题是有效的，因为它科学地基于概率论和医学统计学的原理，问题陈述清晰且提供了所有必要信息，并且表述客观。我们将提供一个完整的解答。\n\n设 $D$ 表示个体患有该疾病的事件，设 $D^c$ 表示个体未患该疾病的补事件。设 $T+$ 表示测试结果为阳性的事件，设 $T-$ 表示测试结果为阴性的事件。\n\n根据问题陈述，我们得到以下概率：\n- 疾病的患病率：$P(D) = \\pi = 0.001$。\n- 测试的灵敏度：$P(T+ \\mid D) = Se = 0.95$。\n- 测试的特异度：$P(T- \\mid D^c) = Sp = 0.98$。\n\n由此，我们可以推导出另外两个必要的概率：\n- 未患病的概率：$P(D^c) = 1 - P(D) = 1 - \\pi = 1 - 0.001 = 0.999$。\n- 在未患病的情况下测试结果为阳性的概率（假阳性率）：$P(T+ \\mid D^c) = 1 - P(T- \\mid D^c) = 1 - Sp = 1 - 0.98 = 0.02$。\n\n主要目标是推导和计算阳性预测值（PPV），其定义为在测试结果为阳性的条件下患病的概率，$PPV = P(D \\mid T+)$。我们将使用贝叶斯法则进行此推导。\n\n贝叶斯法则表述如下：\n$$P(D \\mid T+) = \\frac{P(T+ \\mid D) P(D)}{P(T+)}$$\n分母 $P(T+)$ 是获得阳性测试结果的总概率。它可以通过全概率定律，对疾病状态进行边缘化来求得：\n$$P(T+) = P(T+ \\mid D) P(D) + P(T+ \\mid D^c) P(D^c)$$\n将给定的定义代入此表达式可得：\n$$P(T+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi)$$\n现在，将 $P(T+)$ 的这个展开形式代回贝叶斯法则，即可得到PPV的一般表达式，该表达式以灵敏度、特异度和患病率表示：\n$$PPV = P(D \\mid T+) = \\frac{(Se)(\\pi)}{(Se)(\\pi) + (1 - Sp)(1 - \\pi)}$$\n这就是推导出的阳性预测值的表达式。\n\n接下来，我们根据给定的参数计算这个量：$\\pi = 0.001$，$Se = 0.95$，以及 $Sp = 0.98$。\n$$PPV = \\frac{(0.95)(0.001)}{(0.95)(0.001) + (1 - 0.98)(1 - 0.001)}$$\n$$PPV = \\frac{0.00095}{0.00095 + (0.02)(0.999)}$$\n$$PPV = \\frac{0.00095}{0.00095 + 0.01998}$$\n$$PPV = \\frac{0.00095}{0.02093}$$\n进行除法运算：\n$$PPV \\approx 0.0453893932...$$\n将此结果四舍五入至五位有效数字，我们得到 $0.04539$。\n\n问题的第二部分要求解释为什么尽管灵敏度和特异度很高，PPV却如此之低。其原因在于疾病的极低患病率（或基础率），这是一个被贝叶斯法则在数学上所捕捉的原理。\n\n我们可以使用贝叶斯法则的几率形式来分析这个问题。给定阳性测试结果的疾病后验几率等于疾病的先验几率乘以阳性测试的似然比（$LR+$）。\n$$ \\frac{P(D \\mid T+)}{P(D^c \\mid T+)} = \\frac{P(D)}{P(D^c)} \\times \\frac{P(T+ \\mid D)}{P(T+ \\mid D^c)} $$\n各项分别为：\n- 疾病的先验几率：$\\frac{\\pi}{1 - \\pi} = \\frac{0.001}{0.999} \\approx \\frac{1}{999}$。这个几率非常低，反映了该病症的罕见性。\n- 阳性测试的似然比：$LR+ = \\frac{Se}{1 - Sp} = \\frac{0.95}{0.02} = 47.5$。这个值表明，阳性测试结果在患病者中出现的可能性是在非患病者中出现可能性的 $47.5$ 倍。这代表了测试的诊断强度。\n\n因此，后验几率为：\n$$ \\text{后验几率} = \\left(\\frac{0.001}{0.999}\\right) \\times 47.5 \\approx 0.0475475 $$\n虽然该测试提供了强有力的证据（$LR+ = 47.5$），但它更新的是一个极低的先验信念。得到的后验几率仍然很低（低于 $1:20$）。将这些几率转换回概率即可得到PPV：\n$$PPV = \\frac{\\text{后验几率}}{1 + \\text{后验几率}} \\approx \\frac{0.0475475}{1.0475475} \\approx 0.04539$$\n最终的概率仍然很低，因为初始概率极低。\n\n为了使这一点更具体，我们考虑一个包含 $1,000,000$ 个体的假设人群。\n- 患病个体数量（真实病例）：$1,000,000 \\times \\pi = 1,000,000 \\times 0.001 = 1,000$。\n- 未患病个体数量（健康病例）：$1,000,000 \\times (1 - \\pi) = 1,000,000 \\times 0.999 = 999,000$。\n\n现在我们对这整个群体进行筛查：\n- **真阳性（TP）**：患病且测试结果为阳性的个体数量为 $1,000 \\times Se = 1,000 \\times 0.95 = 950$。\n- **假阳性（FP）**：健康但测试结果为阳性的个体数量为 $999,000 \\times (1 - Sp) = 999,000 \\times 0.02 = 19,980$。\n\n测试结果为阳性的总人数是真阳性和假阳性的总和：$TP + FP = 950 + 19,980 = 20,930$。\n\nPPV 是阳性测试中实际为真阳性的比例：\n$$ PPV = \\frac{TP}{TP + FP} = \\frac{950}{20,930} \\approx 0.04539 $$\n这个计算揭示了核心问题：因为该疾病很罕见，健康个体的群体（$999,000$）远大于患病个体的群体（$1,000$）。即使假阳性率低至 $2\\%$，将其应用于这个庞大的健康人群也会产生绝对数量非常大的假阳性（$19,980$）。这个假阳性的数量完全压倒了真阳性的数量（$950$）。因此，任何一个给定的阳性测试结果，更有可能是一个来自健康人的假阳性，而不是一个来自患病者的真阳性。这种现象被称为基础率谬误，它表明对于筛查罕见病症，即使是具有高灵敏度和高特异度的测试，也可能产生较低的阳性预测值。", "answer": "$$\\boxed{0.04539}$$", "id": "4979036"}]}