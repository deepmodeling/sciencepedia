{"hands_on_practices": [{"introduction": "在收集任何数据之前，一个关键的初始步骤是确定需要多少参与者，即估算样本量。这个过程确保了研究具有足够的统计效力，能够得出精确且有意义的结果。本练习[@problem_id:4517839]将引导您从基本原理出发，推导并计算估算患病率所需的样本量，这是任何横断面研究设计的基石。", "problem": "一个公共卫生团队计划进行一项横断面调查，以估计某大型都市区域成年人中每日使用电子烟的点流行率。该调查将采用不放回简单随机抽样 (SRS) 方法，从一个足够大的总体中抽样，使得抽样分数可以忽略不计。该团队将报告基于二项分布的正态近似（由中心极限定理 (CLT) 证明其合理性）的流行率双侧置信区间 (CI)，并将设计样本量，以使该 CI 的半宽（误差范围）不大于一个预设的目标值。\n\n仅从以下基本依据出发：\n- 根据中心极限定理 (CLT)，如果 $X \\sim \\operatorname{Binomial}(n,p)$ 且 $\\hat{p} = X/n$，那么当 $n$ 很大时，\n$$\n\\frac{\\hat{p}-p}{\\sqrt{p(1-p)/n}} \\approx Z,\n$$\n其中 $Z$ 服从标准正态分布，其累积分布函数为 $\\Phi$。\n- 当总体数量相对于 $n$ 很大时，名义置信水平为 $1-\\alpha$ 的双侧 CI 的形式为 $\\hat{p} \\pm z_{\\alpha/2}\\,\\sqrt{p(1-p)/n}$，其中 $z_{\\alpha/2}$ 满足 $\\Pr(|Z|\\le z_{\\alpha/2}) = 1-\\alpha$。\n- 误差范围是 CI 的半宽。\n\n请从这些基本依据出发，推导出一个表达式，用于计算所需的最小整数样本量 $n$，以确保在名义置信水平为 $1-\\alpha$ 时，当规划基于一个先验的流行率估计值 $p^{\\ast}$ 时，绝对误差范围不超过选定的设计值 $E$。然后，使用设计值 $p^{\\ast} = 0.12$，$E = 0.015$ 和 $1-\\alpha = 0.95$ 计算最小整数 $n$。报告在这些假设下，保证达到设计误差范围目标的最小整数样本量。最终答案必须是单个数字。", "solution": "根据指定的标准，对问题陈述的有效性进行审查。\n\n### 第 1 步：提取已知条件\n- 研究类型：横断面调查\n- 抽样方法：不放回简单随机抽样 (SRS)\n- 总体特征：大型都市区域，抽样分数可忽略不计\n- 目标：估计每日使用电子烟的点流行率 $p$\n- 统计方法：基于二项分布的正态近似的双侧置信区间 (CI)，由中心极限定理 (CLT) 证明其合理性\n- 设计约束：CI 半宽（误差范围）不得超过目标值 $E$。\n- 基本依据 1：对于 $X \\sim \\operatorname{Binomial}(n,p)$ 和 $\\hat{p} = X/n$，标准化的样本比例 $\\frac{\\hat{p}-p}{\\sqrt{p(1-p)/n}}$ 近似服从标准正态随机变量 $Z$ 的分布。\n- 基本依据 2：名义置信水平为 $1-\\alpha$ 的双侧 CI 由 $\\hat{p} \\pm z_{\\alpha/2}\\,\\sqrt{p(1-p)/n}$ 给出，其中 $z_{\\alpha/2}$ 满足 $\\Pr(|Z|\\le z_{\\alpha/2}) = 1-\\alpha$。\n- 基本依据 3：误差范围是 CI 的半宽。\n- 任务 1：推导所需最小整数样本量 $n$ 的表达式，以使在置信水平为 $1-\\alpha$ 时，使用先验流行率估计值 $p^{\\ast}$ 的情况下，误差范围不超过设计值 $E$。\n- 任务 2：使用具体设计值 $p^{\\ast} = 0.12$，$E = 0.015$ 和 $1-\\alpha = 0.95$ 计算最小整数 $n$。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题的科学依据、良定性和客观性进行评估。\n- **科学性和事实性：** 该问题是生物统计学和流行病学中的一个标准的、基础的练习。使用二项分布的正态近似来构建比例的置信区间是中心极限定理的经典应用。置信区间的公式和误差范围的概念都是教科书中的定义。整个前提是科学合理的。\n- **良定性和完整性：** 这个问题是良定的。它要求从指定的第一性原理进行推导，然后使用提供的数值进行计算。所有必要信息都已提供：CI 的形式、误差范围的定义、期望的置信水平、目标误差范围以及用于规划的流行率值。问题结构导向一个唯一的、有意义的解。\n- **客观性和清晰度：** 问题以统计学和公共卫生研究中常见的精确、客观、无歧义的语言陈述。诸如“点流行率”、“简单随机抽样”、“置信水平”和“误差范围”等术语具有清晰、普遍接受的定义。\n\n### 第 3 步：结论与行动\n问题有效。这是一个在应用统计学中定义明确、科学合理且清晰的问题。现在开始求解过程。\n\n### 样本量公式的推导\n\n问题要求从提供的基本依据推导出最小样本量 $n$。\n\n根据基本依据2和3，误差范围（我们记为 $M$）是置信区间的半宽。\n$$\nM = z_{\\alpha/2}\\,\\sqrt{\\frac{p(1-p)}{n}}\n$$\n该表达式取决于真实的总体流行率 $p$，而在研究进行之前 $p$ 是未知的。为了规划目的，如问题所述，我们必须使用一个先验估计值 $p^{\\ast}$ 来代替 $p$。因此，计划的误差范围是：\n$$\nM_{\\text{planned}} = z_{\\alpha/2}\\,\\sqrt{\\frac{p^{\\ast}(1-p^{\\ast})}{n}}\n$$\n设计规范要求这个计划的误差范围不超过目标值 $E$。这建立起以下不等式：\n$$\nz_{\\alpha/2}\\,\\sqrt{\\frac{p^{\\ast}(1-p^{\\ast})}{n}} \\le E\n$$\n为了找到所需的样本量 $n$，我们解这个关于 $n$ 的不等式。我们假设 $E > 0$，$z_{\\alpha/2} > 0$ 且 $0  p^{\\ast}  1$，这在任何实际应用中都是成立的。\n\n首先，我们将不等式两边平方：\n$$\n\\left(z_{\\alpha/2}\\right)^2 \\frac{p^{\\ast}(1-p^{\\ast})}{n} \\le E^2\n$$\n接下来，我们重新整理各项以分离出 $n$。由于 $n$ 必须是正数，我们可以将两边同乘以 $n$ 并除以 $E^2$ 而不改变不等式的方向：\n$$\n\\left(z_{\\alpha/2}\\right)^2 p^{\\ast}(1-p^{\\ast}) \\le n E^2\n$$\n$$\nn \\ge \\frac{\\left(z_{\\alpha/2}\\right)^2 p^{\\ast}(1-p^{\\ast})}{E^2}\n$$\n样本量 $n$ 必须是整数。该不等式指定了 $n$ 可以取的最小值。因此，满足此条件的最小整数样本量是大于或等于右侧表达式的最小整数。这对应于向上取整函数。\n$$\nn_{\\text{min}} = \\left\\lceil \\frac{z_{\\alpha/2}^2 p^{\\ast}(1-p^{\\ast})}{E^2} \\right\\rceil\n$$\n这就是所要求推导的最小整数样本量的表达式。\n\n### 最小样本量的计算\n\n现在，我们使用提供的设计值计算 $n$ 的值：\n- 先验流行率估计值：$p^{\\ast} = 0.12$\n- 目标误差范围：$E = 0.015$\n- 名义置信水平：$1-\\alpha = 0.95$\n\n首先，我们必须确定 $z_{\\alpha/2}$ 的值。置信水平是 $1-\\alpha = 0.95$，这意味着 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。值 $z_{0.025}$ 是来自标准正态分布 $Z$ 的临界值，它满足 $\\Pr(|Z| \\le z_{0.025}) = 0.95$。这等同于找到使上尾部面积为 $0.025$ 的值，即 $\\Pr(Z > z_{0.025}) = 0.025$。累积概率是 $\\Phi(z_{0.025}) = 1 - 0.025 = 0.975$。这是一个标准分位数，其值约为 $1.96$。因此，$z_{0.025} \\approx 1.96$。\n\n我们现在将数值代入推导出的关于 $n$ 的不等式中：\n$$\nn \\ge \\frac{(1.96)^2 \\times 0.12 \\times (1-0.12)}{(0.015)^2}\n$$\n我们计算这个表达式的各个部分：\n- $(1.96)^2 = 3.8416$\n- $p^{\\ast}(1-p^{\\ast}) = 0.12 \\times (0.88) = 0.1056$\n- $E^2 = (0.015)^2 = 0.000225$\n\n将这些值代回不等式中：\n$$\nn \\ge \\frac{3.8416 \\times 0.1056}{0.000225}\n$$\n$$\nn \\ge \\frac{0.405673056}{0.000225}\n$$\n$$\nn \\ge 1802.99136\n$$\n由于样本量 $n$ 必须是整数，所需的最小参与者人数是大于或等于 $1802.99136$ 的最小整数。\n$$\nn = \\lceil 1802.99136 \\rceil = 1803\n$$\n因此，在 95% 置信水平下，基于 0.12 的流行率估计值，为保证误差范围不超过 0.015，所需的最小整数样本量是 1803。", "answer": "$$\n\\boxed{1803}\n$$", "id": "4517839"}, {"introduction": "收集数据后，下一步是量化暴露与结局之间的关联强度。本练习[@problem_id:4517878]将重点介绍如何计算和解释横断面研究中的三种核心关联测量指标：患病率差（$PD$）、患病率比（$PR$）和患病优势比（$POR$）。理解这些绝对和相对测量指标之间的差异，对于从数据中得出正确的公共卫生结论至关重要。", "problem": "一个公共卫生团队对成年居民进行了一项横断面筛查调查，以评估生活在细颗粒物高暴露社区与当前经医生诊断的哮喘之间是否存在关联。在一个时间点上，共抽样了$2400$名成年人。暴露在社区层面被定义为高或低平均细颗粒物浓度。结局是在调查评估时是否存在当前经医生诊断的哮喘。观察到的计数如下：\n\n- 高暴露（暴露组）：$176$人患有哮喘，$924$人无哮喘。\n- 低暴露（非暴露组）：$130$人患有哮喘，$1170$人无哮喘。\n\n仅从适用于横断面研究的核心定义出发——患病率是在特定时间点、特定人群中具有该结局的个体比例，患病率差是暴露组之间的患病率差异，患病率比是这些患病率的比值，患病率比值比是暴露组之间患病优势的比值——完成以下任务：\n\n1. 根据以上数据，计算暴露组和非暴露组中当前哮喘的患病率。\n2. 根据这些患病率，计算患病率比$PR$、患病率差$PD$和患病率比值比$POR$。\n3. 在预防医学的背景下，为$PR$、$PD$和$POR$提供简要解释，强调在横断面设计中每个测量指标所传达的疾病负担信息以及对预防的潜在启示。\n\n最后，定义标量\n$$Q \\equiv \\ln(POR) + PR - PD,$$\n其中$\\ln$表示自然对数。根据您的结果计算$Q$。将$Q$的最终数值答案四舍五入到$4$位有效数字。该量是无量纲的；不包括单位。", "solution": "问题陈述经评估有效。它在科学上基于流行病学原理，数据充分且一致，问题提出得当，并且陈述客观。\n\n该问题提供了一项对$2400$名成年人进行的横断面研究数据，以评估高细颗粒物暴露与医生诊断的哮喘患病率之间的关联。数据可以整理成一个$2 \\times 2$列联表。设$E$表示暴露组（高暴露），$\\bar{E}$表示非暴露组（低暴露）。设$D$表示患有该疾病（哮喘），$\\bar{D}$表示未患该疾病。\n\n观察到的计数如下：\n- 暴露组($E$)：$a = 176$人患有哮喘($D$)，$b = 924$人无哮喘($\\bar{D}$)。\n- 非暴露组($\\bar{E}$)：$c = 130$人患有哮喘($D$)，$d = 1170$人无哮喘($\\bar{D}$)。\n\n暴露组的总人数为 $N_E = a + b = 176 + 924 = 1100$。\n非暴露组的总人数为 $N_{\\bar{E}} = c + d = 130 + 1170 = 1300$。\n总样本量为 $N = N_E + N_{\\bar{E}} = 1100 + 1300 = 2400$，与给定的总数相符。\n\n**1. 计算暴露组和非暴露组中当前哮喘的患病率。**\n\n患病率定义为在特定时间点、特定人群中具有该结局的个体比例。\n\n暴露组中哮喘的患病率($P_E$)是暴露组中的哮喘病例数除以暴露组的总人数：\n$$P_E = \\frac{a}{a+b} = \\frac{176}{1100} = 0.16$$\n\n非暴露组中哮喘的患病率($P_{\\bar{E}}$)是非暴露组中的哮喘病例数除以非暴露组的总人数：\n$$P_{\\bar{E}} = \\frac{c}{c+d} = \\frac{130}{1300} = 0.10$$\n\n因此，高暴露组的哮喘患病率为$16\\%$，低暴露组的哮喘患病率为$10\\%$。\n\n**2. 计算患病率比($PR$)、患病率差($PD$)和患病率比值比($POR$)。**\n\n患病率差($PD$)是两组之间患病率的绝对差异。\n$$PD = P_E - P_{\\bar{E}} = 0.16 - 0.10 = 0.06$$\n\n患病率比($PR$)是暴露组的患病率与非暴露组的患病率之比。\n$$PR = \\frac{P_E}{P_{\\bar{E}}} = \\frac{0.16}{0.10} = 1.6$$\n\n患病率比值比($POR$)是暴露组中患哮喘的优势（odds）与非暴露组中患哮喘的优势之比。\n暴露组中患哮喘的优势为 $Odds_E = \\frac{P_E}{1 - P_E} = \\frac{a/N_E}{b/N_E} = \\frac{a}{b}$。\n$$Odds_E = \\frac{176}{924} = \\frac{16 \\times 11}{84 \\times 11} = \\frac{16}{84} = \\frac{4}{21}$$\n非暴露组中患哮喘的优势为 $Odds_{\\bar{E}} = \\frac{P_{\\bar{E}}}{1 - P_{\\bar{E}}} = \\frac{c/N_{\\bar{E}}}{d/N_{\\bar{E}}} = \\frac{c}{d}$。\n$$Odds_{\\bar{E}} = \\frac{130}{1170} = \\frac{13}{117} = \\frac{1}{9}$$\n患病率比值比是这些优势的比值。\n$$POR = \\frac{Odds_E}{Odds_{\\bar{E}}} = \\frac{a/b}{c/d} = \\frac{ad}{bc} = \\frac{4/21}{1/9} = \\frac{4}{21} \\times 9 = \\frac{36}{21} = \\frac{12}{7}$$\n以小数表示，$POR = \\frac{12}{7} \\approx 1.7142857$。\n\n**3. $PR$、$PD$和$POR$的解释。**\n\n- **患病率差($PD$)**：$PD$为$0.06$，即$6$个百分点。这是一个效应的绝对测量指标。它表示，在调查时，与低暴露社区相比，高暴露社区每$100$人中多出$6$例哮喘病例。从预防医学的角度来看，$PD$量化了与暴露相关的绝对公共卫生负担。如果该关联是因果关系，则该指标意味着消除高暴露可以在人群中每$100$人预防$6$例哮喘病例。\n\n- **患病率比($PR$)**：$PR$为$1.6$。这是一个效应的相对测量指标。它表明，与低暴露组相比，高暴露组的哮喘患病率高出$1.6$倍（或高出$60\\%$）。$PR$用于描述暴露与结局之间关联的强度。大于$1$的值表明存在正相关。在病因学研究中，它有助于评估关联的大小。\n\n- **患病率比值比($POR$)**：$POR$为$12/7 \\approx 1.71$。这也是一个效应的相对测量指标。它意味着，与低暴露组的个体相比，高暴露组的个体患哮喘的优势大约是前者的$1.71$倍。在横断面研究中，$POR$常被用作关联的估计值，特别是在逻辑斯蒂回归模型的背景下。当结局不罕见时（如此例中，患病率为$10\\%$和$16\\%$），$POR$不是$PR$的良好近似值（$1.71$对$1.6$），并且它倾向于高估由$PR$测量的关联强度。对于患病率数据，$PR$通常被认为更具直接可解释性。\n\n**4. $Q$的最终计算。**\n\n标量$Q$定义为：\n$$Q \\equiv \\ln(POR) + PR - PD$$\n代入计算出的值：\n$$PR = 1.6$$\n$$PD = 0.06$$\n$$POR = \\frac{12}{7}$$\n我们有：\n$$Q = \\ln\\left(\\frac{12}{7}\\right) + 1.6 - 0.06$$\n$$Q = \\ln\\left(\\frac{12}{7}\\right) + 1.54$$\n现在，我们计算数值：\n$$\\ln\\left(\\frac{12}{7}\\right) \\approx \\ln(1.7142857...) \\approx 0.5389965...$$\n$$Q \\approx 0.5389965... + 1.54 = 2.0789965...$$\n将结果四舍五入到$4$位有效数字，我们得到：\n$$Q \\approx 2.079$$", "answer": "$$\\boxed{2.079}$$", "id": "4517878"}, {"introduction": "横断面研究的一个常见应用是评估诊断或筛检试验的性能。本练习[@problem_id:4517877]将演示疾病的患病率（一个通常由横断面研究估算出的关键指标）如何深刻影响筛检试验的预测价值（$PPV$和$NPV$）。这个实践揭示了在解释试验结果时，考虑人群背景（即患病率）的极端重要性。", "problem": "在预防医学中，一个横断面筛查项目正在评估一种用于稳定成年人群中无症状慢性病的二元诊断测试。该测试在不同人群和时间中具有恒定的灵敏度和特异性。在横断面设计中，疾病状态和测试结果是同时确定的。\n\n假设该测试的灵敏度为 $0.91$，特异性为 $0.97$。考虑两个仅在真实患病率 $P$ 上有所不同的群体：群体 A 的 $P = 0.05$，群体 B 的 $P = 0.20$。\n\n仅使用灵敏度、特异性和条件概率的基本定义，并从第一性原理出发，完成以下任务：\n1. 推导出阳性预测值 (PPV) 和阴性预测值 (NPV) 作为患病率 $P$、灵敏度和特异性的函数表达式。\n2. 计算群体 A 和群体 B 的 PPV 和 NPV，将数值表示为小数（不要使用百分号）。\n3. 通过报告当患病率从 $0.05$ 增加到 $0.20$ 时 PPV 的绝对增量，来评估患病率 $P$ 变化的影响。\n\n将最终报告的 PPV 增量表示为小数，并将最终报告的数字四舍五入到四位有效数字。最终报告的数字中不要包含任何单位或百分号。", "solution": "经评估，问题陈述有效。它在科学上基于流行病学和生物统计学的原理，特别是诊断性测试理论。该问题提法严谨，提供了所有必要的数据（灵敏度、特异性和患病率值），以推导和计算所需的指标（阳性预测值和阴性预测值）。语言客观且无歧义。该场景是条件概率和贝叶斯定理在医学背景下的一个标准而现实的应用。\n\n让我们定义以下事件：\n- $D$: 个体患有该疾病。\n- $D^c$: 个体未患该疾病。\n- $T^+$: 测试结果为阳性。\n- $T^-$: 测试结果为阴性。\n\n题目给出的已知条件可以用条件概率表示：\n- 患病率，$P = P(D)$。因此，$P(D^c) = 1 - P(D) = 1 - P$。\n- 灵敏度，$Se = P(T^+ | D) = 0.91$。\n- 特异性，$Sp = P(T^- | D^c) = 0.97$。\n\n由此，我们还可以推导出互补事件的概率：\n- 假阴性率是 $P(T^- | D) = 1 - P(T^+ | D) = 1 - Se = 1 - 0.91 = 0.09$。\n- 假阳性率是 $P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp = 1 - 0.97 = 0.03$。\n\n待求的量是阳性预测值 (PPV) 和阴性预测值 (NPV)：\n- $PPV = P(D | T^+)$\n- $NPV = P(D^c | T^-)$\n\n**1. PPV 和 NPV 表达式的推导**\n\n我们使用贝叶斯定理来推导 PPV 和 NPV 的表达式。\n\n对于阳性预测值 (PPV)：\n$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$\n分母 $P(T^+)$ 是测试结果为阳性的总概率，可以使用全概率公式展开：\n$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$\n代入已定义的项 ($Se$, $Sp$, $P$)：\n$P(T^+) = (Se)(P) + (1 - Sp)(1 - P)$\n因此，PPV 的表达式为：\n$PPV(P, Se, Sp) = \\frac{Se \\cdot P}{Se \\cdot P + (1 - Sp)(1 - P)}$\n\n对于阴性预测值 (NPV)：\nNPV 的定义是 $P(D^c | T^-)$。应用贝叶斯定理：\n$NPV = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}$\n分母 $P(T^-)$ 是测试结果为阴性的总概率：\n$P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)$\n代入已定义的项：\n$P(T^-) = (Sp)(1 - P) + (1 - Se)(P)$\n因此，NPV 的表达式为：\n$NPV(P, Se, Sp) = \\frac{Sp \\cdot (1 - P)}{Sp \\cdot (1 - P) + (1 - Se)P}$\n\n**2. 为群体 A 和群体 B 进行计算**\n\n我们已知 $Se = 0.91$, $Sp = 0.97$, $1 - Se = 0.09$, 以及 $1 - Sp = 0.03$。\n\n**对于群体 A：**\n患病率为 $P_A = 0.05$。因此，$1 - P_A = 1 - 0.05 = 0.95$。\n$PPV_A = \\frac{Se \\cdot P_A}{Se \\cdot P_A + (1 - Sp)(1 - P_A)} = \\frac{(0.91)(0.05)}{(0.91)(0.05) + (0.03)(0.95)}$\n$PPV_A = \\frac{0.0455}{0.0455 + 0.0285} = \\frac{0.0455}{0.0740} \\approx 0.6148648...$\n\n$NPV_A = \\frac{Sp \\cdot (1 - P_A)}{Sp \\cdot (1 - P_A) + (1 - Se)P_A} = \\frac{(0.97)(0.95)}{(0.97)(0.95) + (0.09)(0.05)}$\n$NPV_A = \\frac{0.9215}{0.9215 + 0.0045} = \\frac{0.9215}{0.9260} \\approx 0.9951403...$\n\n**对于群体 B：**\n患病率为 $P_B = 0.20$。因此，$1 - P_B = 1 - 0.20 = 0.80$。\n$PPV_B = \\frac{Se \\cdot P_B}{Se \\cdot P_B + (1 - Sp)(1 - P_B)} = \\frac{(0.91)(0.20)}{(0.91)(0.20) + (0.03)(0.80)}$\n$PPV_B = \\frac{0.182}{0.182 + 0.024} = \\frac{0.182}{0.206} \\approx 0.8834951...$\n\n$NPV_B = \\frac{Sp \\cdot (1 - P_B)}{Sp \\cdot (1 - P_B) + (1 - Se)P_B} = \\frac{(0.97)(0.80)}{(0.97)(0.80) + (0.09)(0.20)}$\n$NPV_B = \\frac{0.776}{0.776 + 0.018} = \\frac{0.776}{0.794} \\approx 0.9773299...$\n\n**3. 评估患病率变化的影响**\n\n将患病率从 $P_A = 0.05$ 变为 $P_B = 0.20$ 的影响，通过 PPV 的绝对增量来评估。\n绝对增量 $\\Delta PPV = PPV_B - PPV_A$\n$\\Delta PPV \\approx 0.8834951... - 0.6148648...$\n$\\Delta PPV \\approx 0.2686303...$\n\n题目要求将此最终值四舍五入到四位有效数字。第一个有效数字是 $2$。前四位有效数字是 $2$、$6$、$8$ 和 $6$。第五位有效数字是 $3$，小于 $5$，因此我们不对第四位数字进行进位。\n四舍五入后的值为 $0.2686$。", "answer": "$$\\boxed{0.2686}$$", "id": "4517877"}]}