{"hands_on_practices": [{"introduction": "识别和量化健康差异是公共卫生领域的基石。通过风险差（绝对差异）和风险比（相对差异）等流行病学指标，我们可以精确比较不同人群的健康状况。本练习将以青少年电子烟使用这一紧迫的健康问题为例，指导你如何从原始数据中计算这些基本指标，并理解它们如何从不同但互补的视角揭示健康问题的严重程度。[@problem_id:4500927]", "problem": "一项青少年健康促进监测研究按社会经济地位（SES）分层，对两类高中（低社会经济地位（SES）和高社会经济地位（SES））的学生进行了抽样。在低SES学校中，调查了 $n_{\\text{low}}=520$ 名青少年，其中 $x_{\\text{low}}=130$ 人报告在过去 $30$ 天内有过任何吸电子烟的行为。在高SES学校中，调查了 $n_{\\text{high}}=680$ 名青少年，其中 $x_{\\text{high}}=68$ 人报告在过去 $30$ 天内有过任何吸电子烟的行为。使用流行病学中比较群体间比例以量化健康行为差异的基本定义，将就读于低SES学校视为暴露，将就读于高SES学校视为参照。根据观察到的计数，计算低SES学校和高SES学校之间过去 $30$ 天吸电子烟行为的绝对差异（患病率尺度上的风险差）和相对差异（患病率尺度上的风险比）。将这两个指标都以小数形式表示，并各保留 $4$ 位有效数字。最终数值不需要单位。在推导过程中，请简要解释在此背景下绝对差异与相对差异的含义，但最终答案必须仅包含所要求的两个数值。", "solution": "该问题有效，因为它以流行病学原理为科学基础，问题提出得当，提供了所有必要数据，且表述客观。我们可以开始求解。\n\n目标是计算低SES学校和高SES学校青少年过去 $30$ 天吸电子烟患病率的两种差异指标：绝对差异（风险差）和相对差异（风险比）。问题指明，就读于低SES学校为暴露组，就读于高SES学校为参照组。\n\n首先，我们计算每组中吸电子烟的患病率。患病率（$P$）是指在特定时间点，人群中具有某种特定属性或疾病的个体所占的比例。在这项横断面研究中，患病率是衡量疾病频率的指标。其计算方法为病例数（$x$）除以样本中的总人数（$n$）。\n\n对于低SES组（暴露组），给定数据如下：\n- 样本量，$n_{\\text{low}} = 520$\n- 报告吸电子烟的人数，$x_{\\text{low}} = 130$\n\n低SES组吸电子烟的患病率，记作 $P_{\\text{low}}$，为：\n$$P_{\\text{low}} = \\frac{x_{\\text{low}}}{n_{\\text{low}}} = \\frac{130}{520} = 0.25$$\n\n对于高SES组（参照组或非暴露组），给定数据如下：\n- 样本量，$n_{\\text{high}} = 680$\n- 报告吸电子烟的人数，$x_{\\text{high}} = 68$\n\n高SES组吸电子烟的患病率，记作 $P_{\\text{high}}$，为：\n$$P_{\\text{high}} = \\frac{x_{\\text{high}}}{n_{\\text{high}}} = \\frac{68}{680} = 0.10$$\n\n接下来，我们计算绝对差异，即风险差（$RD$）。$RD$ 在加性尺度上量化了暴露组相对于非暴露组的超额风险。它通过计算两组患病率之差得出。\n$$RD = P_{\\text{low}} - P_{\\text{high}}$$\n代入计算出的患病率值：\n$$RD = 0.25 - 0.10 = 0.15$$\n绝对差异为 $0.15$ 表明，低SES学校的吸电子烟患病率比高SES学校高 $15$ 个百分点。从公共卫生的角度来看，这意味着在低SES环境中，每 $100$ 名学生中，估计有 $15$ 例额外的吸电子烟病例可归因于这种社会经济差异。保留 $4$ 位有效数字，该值为 $0.1500$。\n\n然后，我们计算相对差异，即风险比（$RR$）。$RR$ 在乘性尺度上量化了关联强度，表明暴露组经历该结果的可能性是非暴露组的多少倍。\n$$RR = \\frac{P_{\\text{low}}}{P_{\\text{high}}}$$\n代入计算出的患病率值：\n$$RR = \\frac{0.25}{0.10} = 2.5$$\n相对差异为 $2.5$ 表明，低SES学校的学生报告在过去 $30$ 天内吸电子烟的可能性是高SES学校学生的 $2.5$ 倍。该指标突显了学校SES与吸电子烟行为之间关联的强度。保留 $4$ 位有效数字，该值为 $2.500$。\n\n最终答案要求按顺序给出绝对差异和相对差异，并保留 $4$ 位有效数字。\n绝对差异为 $0.1500$。\n相对差异为 $2.500$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1500  2.500\n\\end{pmatrix}\n}\n$$", "id": "4500927"}, {"introduction": "在识别出健康问题后，有效的筛查通常是下一步关键措施，但没有任何筛查测试是完美的。筛查测试在特定人群中的实际效用，不仅取决于其内在准确性（即敏感性和特异性），还取决于该疾病的患病率。阳性预测值（PPV）和阴性预测值（NPV）正是量化这种现实世界中测试表现的关键指标。本练习将演示如何计算抑郁症筛查工具的PPV和NPV，并解读其结果，以便就如何分配有限的心理健康资源做出明智决策。[@problem_id:4500929]", "problem": "一个学区计划使用青少年患者健康问卷 (PHQ-A) 对青少年抑郁症状进行年度普遍筛查。在经本地验证的阈值得分 $10$ 分时，PHQ-A 检测现患抑郁症的敏感性为 $0.82$，特异性为 $0.88$。该学区青少年人口中现患抑郁症的时点患病率为 $0.15$。从二元分类器的敏感性、特异性和患病率的核心定义以及全概率定律出发，计算在此人群中、在此阈值下 PHQ-A 的阳性预测值 (PPV) 和阴性预测值 (NPV)。将 PPV 和 NPV 均表示为四舍五入到四位有效数字的小数，且不要使用百分号。计算出这些值后，简要解释它们的数值大小应如何为有限的咨询资源在筛查阳性学生的后续评估和筛查阴性学生的监测之间的分配提供信息。按 PPV、NPV 的顺序报告您的数值结果。", "solution": "该问题陈述科学严谨、提法得当且客观。它展示了贝叶斯概率和流行病学原理在一个真实的公共卫生筛查场景中的标准应用。所有必要的数据都已提供，任务是计算定义的量并对其进行解释。因此，该问题是有效的，可以构建解决方案。\n\n设 $D$ 为青少年患有现患抑郁症的事件， $D^c$ 为青少年未患病的事件。设 $T+$ 为测试结果为阳性（PHQ-A 分数 $\\ge 10$）的事件， $T-$ 为测试结果为阴性（PHQ-A 分数 $ 10$）的事件。\n\n给定条件可以转化为概率陈述：\n该疾病的患病率为 $P(D) = 0.15$。\n未患有该疾病的概率为 $P(D^c) = 1 - P(D) = 1 - 0.15 = 0.85$。\n测试的敏感性是在患有该疾病的情况下测试结果为阳性的概率：$P(T+ | D) = 0.82$。\n测试的特异性是在未患有该疾病的情况下测试结果为阴性的概率：$P(T- | D^c) = 0.88$。\n\n根据这些给定条件，我们还可以确定错误测试结果的比率：\n假阳性率 (FPR) 是在未患有该疾病的情况下测试结果为阳性的概率：$P(T+ | D^c) = 1 - P(T- | D^c) = 1 - 0.88 = 0.12$。\n假阴性率 (FNR) 是在患有该疾病的情况下测试结果为阴性的概率：$P(T- | D) = 1 - P(T+ | D) = 1 - 0.82 = 0.18$。\n\n需要计算的量是阳性预测值 (PPV)，定义为 $P(D | T+)$，和阴性预测值 (NPV)，定义为 $P(D^c | T-)$。这些可以使用贝叶斯定理来计算。\n\n首先，我们计算 PPV。PPV 是指测试结果为阳性的个体确实患有该疾病的概率。\n$$ \\text{PPV} = P(D | T+) = \\frac{P(T+ | D) P(D)}{P(T+)} $$\n分母 $P(T+)$ 是测试结果为阳性的总概率。它可以通过全概率定律求得：\n$$ P(T+) = P(T+ | D) P(D) + P(T+ | D^c) P(D^c) $$\n代入给定值：\n$$ P(T+) = (0.82)(0.15) + (0.12)(0.85) $$\n$$ P(T+) = 0.123 + 0.102 = 0.225 $$\n现在我们可以计算 PPV：\n$$ \\text{PPV} = \\frac{0.123}{0.225} \\approx 0.54666... $$\n四舍五入到四位有效数字，PPV 为 $0.5467$。\n\n接下来，我们计算 NPV。NPV 是指测试结果为阴性的个体确实未患病的概率。\n$$ \\text{NPV} = P(D^c | T-) = \\frac{P(T- | D^c) P(D^c)}{P(T-)} $$\n分母 $P(T-)$ 是测试结果为阴性的总概率。我们可以使用全概率定律来求得：\n$$ P(T-) = P(T- | D^c) P(D^c) + P(T- | D) P(D) $$\n或者，由于只有两种结果（$T+$ 或 $T-$），$P(T-) = 1 - P(T+)$。\n$$ P(T-) = 1 - 0.225 = 0.775 $$\n我们用第一个公式来验证：\n$$ P(T-) = (0.88)(0.85) + (0.18)(0.15) $$\n$$ P(T-) = 0.748 + 0.027 = 0.775 $$\n结果一致。现在我们可以计算 NPV：\n$$ \\text{NPV} = \\frac{P(T- | D^c) P(D^c)}{P(T-)} = \\frac{(0.88)(0.85)}{0.775} = \\frac{0.748}{0.775} \\approx 0.96516... $$\n四舍五入到四位有效数字，NPV 为 $0.9652$。\n\n计算出的值为 PPV $\\approx 0.5467$ 和 NPV $\\approx 0.9652$。\n\n这些数值的大小对资源分配有直接影响。\n$0.5467$ 的 PPV 表明，在所有筛查呈阳性的学生中，只有大约 $54.7\\%$ 真正患有抑郁症。其余的 $45.3\\%$ 是假阳性。虽然该测试成功地将筛查人群中患者的比例从 $15\\%$ 的基线患病率提高到 $54.7\\%$ 的测试后概率，但阳性筛查结果本身不具有诊断性。很大一部分阳性结果是不正确的。这要求将大量的咨询资源分配给所有筛查阳性的学生，进行全面的后续诊断评估，以便在开始治疗前区分真阳性和假阳性。对于近一半没有患病的筛查阳性者来说，仅仅根据阳性筛查结果分配治疗资源将是极其低效和不恰当的。\n\n$0.9652$ 的 NPV 非常高。这意味着在筛查呈阴性的学生中，有 $96.5\\%$ 的概率他们确实没有患病。这个群体中漏诊（假阴性）的概率很低，为 $1 - \\text{NPV} \\approx 1 - 0.9652 = 0.0348$，即约 $3.5\\%$。这个高的 NPV 提供了强有力的保证，即阴性结果是可靠的。因此，将最少的密集资源分配给庞大的筛查阴性群体是合理的。这使得有限的咨询资源可以集中在规模更小、风险更高的筛查阳性人群上。虽然对所有学生进行普遍预防和一般心理健康监测仍然是审慎的，但筛查结果支持一种分层方法，即密集型后续干预几乎完全保留给那些筛查呈阳性的人。", "answer": "$$\\boxed{\\begin{pmatrix} 0.5467  0.9652 \\end{pmatrix}}$$", "id": "4500929"}, {"introduction": "青少年的健康风险通常是多种因素相互作用的复杂结果，为了进行有效干预，我们需要能够整合这种复杂性的模型。逻辑回归是一种强大的统计方法，它允许我们基于多个预测因子（包括它们的交互作用）来模拟一个二元结果（如自残行为）的发生概率。这项高阶练习要求你从零开始构建一个预测性风险模型，将流行病学参数（比值比）转化为一个可用的计算工具，从而在风险预测的理论与实践之间架起一座桥梁。[@problem_id:4500966]", "problem": "您的任务是实现一个简约的、机械性的逻辑斯谛风险模型，该模型基于四个预测变量和两个预先指定的交互项，用以估计青少年在 $12$ 个月内至少有一次自残行为的概率。目标是使用核心概率定义和经过充分检验的统计事实，将预防医学风险建模规范转化为精确、可测试的计算。\n\n使用的基础理论：\n- 概率 $p \\in (0,1)$ 和优势 $o = \\dfrac{p}{1-p}$。\n- logit 链接 $\\text{logit}(p) = \\ln\\!\\left(\\dfrac{p}{1-p}\\right)$ 及其反函数 $p = \\dfrac{1}{1+\\exp(-\\eta)}$，其中 $\\eta$ 是一个线性预测器。\n- 在逻辑斯谛回归中，优势（优势比）的乘法效应通过自然对数在对数优势尺度上变为了加法效应。\n\n模型规格：\n- 结果：未来 $12$ 个月内至少发生一次自残行为的概率 $p$。\n- 预测变量：\n  - 先前尝试指标 $A \\in \\{0,1\\}$，其中如果先前至少有一次尝试，则 $A=1$，否则 $A=0$。\n  - 青少年患者健康问卷 (Patient Health Questionnaire for Adolescents, PHQ-A) 上的抑郁得分 $D \\in \\{0,1,2,\\dots,27\\}$。\n  - 欺凌暴露水平 $B \\in \\{0,1,2\\}$，其中 $B=0$ 表示无， $B=1$ 表示偶尔， $B=2$ 表示频繁。\n  - 接触途径指标 $M \\in \\{0,1\\}$，其中如果存在接触途径，则 $M=1$，否则 $M=0$。\n- 交互作用：\n  - 先前尝试与抑郁的交互：当 $A=1$ 时，其效应会调节 $D$ 每单位增量的效应。\n  - 欺凌与接触途径的交互：当 $M=1$ 时，其效应会调节 $B$ 每单位增量的效应。\n\n假设（编码为参数的、经过充分检验的事实）：\n- 在 $A=0, D=0, B=0, M=0$ 时的基线风险为 $p_0 = 0.02$。\n- 单位变化引起的优势比：\n  - 先前尝试：$\\text{OR}_A = 6.0$。\n  - 每分抑郁得分：$\\text{OR}_D = 1.15$。\n  - 每级欺凌暴露：$\\text{OR}_B = 1.6$。\n  - 接触途径：$\\text{OR}_M = 2.0$。\n- 交互优势比：\n  - 当 $A=1$ 时，抑郁得分每分的额外效应：$\\text{OR}_{AD} = 1.05$。\n  - 当 $M=1$ 时，欺凌水平每级的额外效应：$\\text{OR}_{BM} = 1.3$。\n\n任务：\n1. 仅从优势、logit 的定义以及优势的乘法效应在 logit 尺度上是可加的这一事实出发，构建与上述规格相对应的线性预测器 $\\eta$。您的构建必须正确地包含所描述的两个交互作用。\n2. 将模型表示为给定 $(A,D,B,M)$ 时计算 $p$ 的公式。\n3. 实现一个程序，对于下面的每个测试用例，计算预测概率 $p$ 为一个小数（而非百分比），并四舍五入到恰好 $6$ 位小数。\n\n必需的测试套件（每个用例是一个元组 $(A,D,B,M)$）：\n- 用例 1：$(0,0,0,0)$。\n- 用例 2：$(1,27,2,1)$。\n- 用例 3：$(0,10,1,1)$。\n- 用例 4：$(1,2,0,0)$。\n- 用例 5：$(0,5,2,0)$。\n- 用例 6：$(0,0,0,1)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按上述测试用例顺序排列的结果，每个概率都四舍五入到恰好 $6$ 位小数（例如，$[0.123456,0.234567,0.345678,0.456789,0.567890,0.678901]$）。", "solution": "该问题是有效的，因为它在科学上基于逻辑斯谛回归建模的原理，在数学上是适定的，并以客观、明确的规格呈现。它包含了构建唯一且可验证解决方案所需的所有信息。\n\n目标是基于一组预测变量和指定的参数，为青少年自残行为的 $12$ 个月概率 $p$ 构建一个计算模型。该模型遵循逻辑斯谛回归框架。\n\n逻辑斯谛模型的基础是概率 $p$ 和对数优势（也称为 logit）之间的关系。优势 $o$ 定义为事件发生的概率与不发生的概率之比：\n$$o = \\frac{p}{1-p}$$\nLogit 函数将概率 $p \\in (0,1)$ 链接到实值线性预测器 $\\eta \\in (-\\infty, \\infty)$：\n$$\\eta = \\text{logit}(p) = \\ln(o) = \\ln\\left(\\frac{p}{1-p}\\right)$$\n该模型的核心是构建此线性预测器 $\\eta$，作为输入变量的函数。预测变量是先前尝试指标 $A \\in \\{0,1\\}$、抑郁得分 $D \\in \\{0,1,\\dots,27\\}$、欺凌暴露水平 $B \\in \\{0,1,2\\}$ 和接触途径指标 $M \\in \\{0,1\\}$。该模型还包括两个交互项：先前尝试与抑郁的交互 ($A \\cdot D$) 和欺凌与接触途径的交互 ($B \\cdot M$)。\n\n线性预测器 $\\eta$ 的一般形式是预测变量及其交互作用的线性组合：\n$$\\eta(A,D,B,M) = \\beta_0 + \\beta_A A + \\beta_D D + \\beta_B B + \\beta_M M + \\beta_{AD} (A \\cdot D) + \\beta_{BM} (B \\cdot M)$$\n系数 $\\beta_i$ 表示在保持所有其他预测变量不变的情况下，相应预测变量每变化一个单位，对数优势的变化量。这些系数由所提供的优势比 ($\\text{OR}$) 推导得出。其关系为 $\\beta = \\ln(\\text{OR})$。\n\n我们按如下方式推导每个系数：\n\n1.  **截距 ($\\beta_0$)**: 这是当所有预测变量都为零时，即在基线条件 $(A,D,B,M) = (0,0,0,0)$ 下的结果的对数优势。基线概率给定为 $p_0 = 0.02$。基线优势为：\n    $$o_0 = \\frac{p_0}{1-p_0} = \\frac{0.02}{1-0.02} = \\frac{0.02}{0.98}$$\n    截距是基线优势的自然对数：\n    $$\\beta_0 = \\ln(o_0) = \\ln\\left(\\frac{0.02}{0.98}\\right) \\approx -3.8918$$\n\n2.  **主效应系数**: 这些是每个预测变量指定优势比的自然对数。\n    -   先前尝试 ($A$): $\\beta_A = \\ln(\\text{OR}_A) = \\ln(6.0) \\approx 1.7918$\n    -   抑郁得分 ($D$): $\\beta_D = \\ln(\\text{OR}_D) = \\ln(1.15) \\approx 0.1398$\n    -   欺凌暴露 ($B$): $\\beta_B = \\ln(\\text{OR}_B) = \\ln(1.6) \\approx 0.4700$\n    -   接触途径 ($M$): $\\beta_M = \\ln(\\text{OR}_M) = \\ln(2.0) \\approx 0.6931$\n\n3.  **交互作用系数**: 交互项捕捉了一个预测变量的效应如何被另一个预测变量所修正。\n    -   **抑郁与尝试的交互作用 ($\\beta_{AD}$)**: 问题陈述当 $A=1$ 时，抑郁的每分效应有一个额外的优势比 $\\text{OR}_{AD} = 1.05$。在 logit 模型中，抑郁的项是 $(\\beta_D + \\beta_{AD} A)D$。当 $A=0$ 时，$D$ 每增加一个单位，对数优势增加 $\\beta_D$。当 $A=1$ 时，对数优势增加 $\\beta_D + \\beta_{AD}$。相应的优势比是 $\\exp(\\beta_D + \\beta_{AD}) = \\exp(\\beta_D)\\exp(\\beta_{AD}) = \\text{OR}_D \\cdot \\text{OR}_{AD}$。这与规格相符。因此，交互作用系数是：\n        $$\\beta_{AD} = \\ln(\\text{OR}_{AD}) = \\ln(1.05) \\approx 0.0488$$\n    -   **欺凌与途径的交互作用 ($\\beta_{BM}$)**: 类似地，当 $M=1$ 时，欺凌的每级效应有一个额外的优势比 $\\text{OR}_{BM} = 1.3$，其交互作用系数是：\n        $$\\beta_{BM} = \\ln(\\text{OR}_{BM}) = \\ln(1.3) \\approx 0.2624$$\n\n结合这些系数，完整的线性预测器为：\n$$\\eta(A,D,B,M) = \\ln\\left(\\frac{0.02}{0.98}\\right) + A\\ln(6.0) + D\\ln(1.15) + B\\ln(1.6) + M\\ln(2.0) + (A \\cdot D)\\ln(1.05) + (B \\cdot M)\\ln(1.3)$$\n\n为了求出概率 $p$，我们使用逆 logit（逻辑斯谛）函数：\n$$p = \\frac{1}{1 + \\exp(-\\eta)}$$\n代入 $\\eta$ 的表达式，我们得到 $p(A,D,B,M)$ 的完整计算模型：\n$$p(A,D,B,M) = \\frac{1}{1 + \\exp\\left( - \\left[ \\ln\\left(\\frac{0.02}{0.98}\\right) + A\\ln(6.0) + D\\ln(1.15) + B\\ln(1.6) + M\\ln(2.0) + (A D)\\ln(1.05) + (B M)\\ln(1.3) \\right] \\right)}$$\n这个公式允许对任何给定的预测变量值集合 $(A,D,B,M)$ 直接计算风险概率。在实现时，先计算 $\\eta$ 然后应用逻辑斯谛函数，在数值上是稳健的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a logistic risk model to estimate the 12-month probability of\n    self-harm attempt among adolescents based on specified predictors and\n    interaction terms.\n    \"\"\"\n\n    # The test cases are provided as tuples (A, D, B, M).\n    test_cases = [\n        (0, 0, 0, 0),  # Case 1\n        (1, 27, 2, 1), # Case 2\n        (0, 10, 1, 1), # Case 3\n        (1, 2, 0, 0),  # Case 4\n        (0, 5, 2, 0),  # Case 5\n        (0, 0, 0, 1)   # Case 6\n    ]\n\n    # Model parameters derived from the problem statement.\n    # The coefficients (betas) are the natural logarithms of the odds ratios.\n    p0 = 0.02\n    or_a = 6.0\n    or_d = 1.15\n    or_b = 1.6\n    or_m = 2.0\n    or_ad = 1.05\n    or_bm = 1.3\n\n    # Calculate beta coefficients (log-odds ratios)\n    beta_0 = np.log(p0 / (1 - p0))  # Intercept from baseline probability\n    beta_a = np.log(or_a)\n    beta_d = np.log(or_d)\n    beta_b = np.log(or_b)\n    beta_m = np.log(or_m)\n    beta_ad = np.log(or_ad)  # Interaction term A*D\n    beta_bm = np.log(or_bm)  # Interaction term B*M\n\n    def calculate_probability(A, D, B, M):\n        \"\"\"\n        Calculates the probability p for a given set of predictors.\n        \n        Args:\n            A (int): Prior attempts indicator {0, 1}\n            D (int): Depression score {0, ..., 27}\n            B (int): Bullying exposure level {0, 1, 2}\n            M (int): Access to means indicator {0, 1}\n            \n        Returns:\n            float: The predicted probability of self-harm.\n        \"\"\"\n        # Construct the linear predictor (eta)\n        eta = (beta_0 + \n               beta_a * A + \n               beta_d * D + \n               beta_b * B + \n               beta_m * M + \n               beta_ad * A * D + \n               beta_bm * B * M)\n        \n        # Apply the inverse logit (logistic) function to get probability p\n        p = 1 / (1 + np.exp(-eta))\n        \n        return p\n\n    results = []\n    for case in test_cases:\n        A, D, B, M = case\n        probability = calculate_probability(A, D, B, M)\n        # Format the result to exactly 6 decimal places.\n        results.append(f\"{probability:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4500966"}]}