{"hands_on_practices": [{"introduction": "本练习提供了一个关于混杂偏倚的经典计算实例。通过这个假设的队列研究数据，您将亲手计算并比较粗略关联与分层关联的差异，从而揭示混杂效应如何扭曲甚至逆转我们观察到的结果——即著名的“辛普森悖论”。这个练习旨在通过标准化方法，量化混杂偏倚的大小，帮助您深入理解混杂的定义以及调整混杂变量的重要性 [@problem_id:4515384]。", "problem": "一项队列研究评估了一项二元预防性干预（用 $A \\in \\{0,1\\}$ 表示，其中 $A=1$ 表示暴露）是否在一个固定的随访期内降低了二元结局 $Y \\in \\{0,1\\}$ 的风险。在基线时测量了一个二元暴露前因素 $C \\in \\{0,1\\}$，该因素可能与 $A$ 和 $Y$ 都有关。在 $C$ 的各层内，$Y$ 的风险通过经验（大样本比例）得到了很好的估计，具体如下：在分层 $C=0$ 中，对于 $A=1$ 风险为 $0.05$，对于 $A=0$ 风险为 $0.10$；在分层 $C=1$ 中，对于 $A=1$ 风险为 $0.20$，对于 $A=0$ 风险为 $0.30$。$C$ 的分布因暴露情况而异：在 $A=1$ 组中，有 $900$ 个个体 $C=1$，有 $100$ 个个体 $C=0$；在 $A=0$ 组中，有 $100$ 个个体 $C=1$，有 $900$ 个个体 $C=0$。假设每个暴露组有 $1000$ 个个体。\n\n仅使用风险作为概率的基本定义，以及标准化是在 $C$ 的目标分布上对分层特定风险进行平均的思想，完成以下任务：\n\n1. 在 $C=0$ 和 $C=1$ 的层内，使用给定的风险计算比较 $A=1$ 与 $A=0$ 时 $Y$ 的分层特定风险差。除了概率差的定义之外，不要使用任何未提供的公式。\n\n2. 通过使用全概率定律和给定的样本量结合各分层的信息，计算在 $A=1$ 和 $A=0$ 组中 $Y$ 的粗（未校正）风险，然后计算粗风险差。\n\n3. 计算 $A=1$ 与 $A=0$ 的标准化风险差，方法是首先将每组的风险标准化到 $C$ 的总人口分布（该分布由合并样本得出），然后计算它们的差值。\n\n4. 将风险差尺度上的混杂偏倚定义为粗风险差与标准化风险差之间的数值差异，计算方式为粗风险差减去标准化风险差。报告这个单一数值。\n\n将混杂偏倚的最终数值答案四舍五入到四位有效数字。结果以纯小数形式表示（不带百分号）。", "solution": "用户希望分析一项队列研究中的混杂。我将验证该问题，如果问题有效，我将按照用户的指示提供一个分步解答。\n\n### 问题验证\n\n**步骤 1：提取已知信息**\n\n-   二元干预（暴露）：$A \\in \\{0,1\\}$\n-   二元结局：$Y \\in \\{0,1\\}$\n-   二元暴露前因素（潜在混杂因素）：$C \\in \\{0,1\\}$\n-   分层特定风险, $P(Y=1 | A=a, C=c)$:\n    -   $P(Y=1 | A=1, C=0) = 0.05$\n    -   $P(Y=1 | A=0, C=0) = 0.10$\n    -   $P(Y=1 | A=1, C=1) = 0.20$\n    -   $P(Y=1 | A=0, C=1) = 0.30$\n-   样本量：\n    -   $A=1$ 组总人数：$N_1 = 1000$\n    -   $A=1$ 组中 $C=1$ 的人数：$N_{11} = 900$\n    -   $A=1$ 组中 $C=0$ 的人数：$N_{10} = 100$\n    -   $A=0$ 组总人数：$N_0 = 1000$\n    -   $A=0$ 组中 $C=1$ 的人数：$N_{01} = 100$\n    -   $A=0$ 组中 $C=0$ 的人数：$N_{00} = 900$\n-   任务：\n    1.  计算分层特定风险差。\n    2.  计算粗风险和粗风险差。\n    3.  以总人口为标准，计算标准化风险和标准化风险差。\n    4.  计算混杂偏倚 = (粗风险差) - (标准化风险差)。\n-   四舍五入：混杂偏倚的最终答案保留四位有效数字。\n\n**步骤 2：使用提取的已知信息进行验证**\n\n-   **科学依据：** 该问题使用了流行病学的标准基本概念，包括风险、混杂、风险差和标准化。这些是评估医学和公共卫生领域因果关系和干预效果的核心原则。该场景是混杂的一个教科书式案例。\n-   **定义明确：** 所有必要的数据都已提供。问题具体且数学上定义明确，从而可以得出唯一解。为计算目的，混杂偏倚的定义已明确给出。\n-   **客观性：** 该问题以精确的量化术语陈述，没有任何主观或模棱两可的语言。\n-   **内部一致性：** 每个暴露组内的样本量总和正确：对于 $A=1$, $900 + 100 = 1000$；对于 $A=0$, $100 + 900 = 1000$。该问题是自洽且一致的。\n\n**步骤 3：结论和行动**\n\n该问题是有效的，因为它具有科学依据、定义明确、客观且内部一致。我将继续进行解答。\n\n### 解答\n\n令 $R(a, c) = P(Y=1 | A=a, C=c)$ 表示在暴露水平 $a \\in \\{0,1\\}$ 和混杂因素水平 $c \\in \\{0,1\\}$ 下，结局 $Y=1$ 的分层特定风险。\n\n**1. 计算分层特定风险差。**\n\n在 $C$ 的每个分层内，风险差 ($RD$) 是暴露组 ($A=1$) 和非暴露组 ($A=0$) 之间风险的差异。\n\n对于分层 $C=0$：\n$$RD_{C=0} = R(1, 0) - R(0, 0) = P(Y=1 | A=1, C=0) - P(Y=1 | A=0, C=0)$$\n使用给定的值：\n$$RD_{C=0} = 0.05 - 0.10 = -0.05$$\n\n对于分层 $C=1$：\n$$RD_{C=1} = R(1, 1) - R(0, 1) = P(Y=1 | A=1, C=1) - P(Y=1 | A=0, C=1)$$\n使用给定的值：\n$$RD_{C=1} = 0.20 - 0.30 = -0.10$$\n在两个分层中，干预都与结局风险降低相关。\n\n**2. 计算粗（未校正）风险和粗风险差。**\n\n每个暴露组的粗风险是分层特定风险的加权平均值，其中权重是该暴露组内 $C$ 的比例。\n\n首先，我们根据给定的样本量确定每个暴露组内 $C$ 的比例。\n对于暴露组 ($A=1$)：\n$$P(C=0 | A=1) = \\frac{N_{10}}{N_1} = \\frac{100}{1000} = 0.1$$\n$$P(C=1 | A=1) = \\frac{N_{11}}{N_1} = \\frac{900}{1000} = 0.9$$\n\n对于非暴露组 ($A=0$)：\n$$P(C=0 | A=0) = \\frac{N_{00}}{N_0} = \\frac{900}{1000} = 0.9$$\n$$P(C=1 | A=0) = \\frac{N_{01}}{N_0} = \\frac{100}{1000} = 0.1$$\n\n现在，我们使用全概率定律计算粗风险。\n$A=1$ 的粗风险：\n$$P(Y=1 | A=1) = P(Y=1 | A=1, C=0)P(C=0 | A=1) + P(Y=1 | A=1, C=1)P(C=1 | A=1)$$\n$$P(Y=1 | A=1) = (0.05)(0.1) + (0.20)(0.9) = 0.005 + 0.18 = 0.185$$\n\n$A=0$ 的粗风险：\n$$P(Y=1 | A=0) = P(Y=1 | A=0, C=0)P(C=0 | A=0) + P(Y=1 | A=0, C=1)P(C=1 | A=0)$$\n$$P(Y=1 | A=0) = (0.10)(0.9) + (0.30)(0.1) = 0.09 + 0.03 = 0.120$$\n\n粗风险差 ($RD_{crude}$) 为：\n$$RD_{crude} = P(Y=1 | A=1) - P(Y=1 | A=0) = 0.185 - 0.120 = 0.065$$\n粗分析表明干预增加了风险，这与分层特定的发现相反。这是混杂的一个标志。\n\n**3. 计算标准化风险差。**\n\n标准化通过将每组的分层特定风险应用于混杂因素 $C$ 的一个共同的、“标准的”分布来调整风险。该问题指定标准人口是总研究人口。\n\n首先，我们确定 $C$ 在总人口中的分布。\n总人口数 $N_{total} = N_1 + N_0 = 1000 + 1000 = 2000$。\n$C=0$ 的总人数：$N_{C=0} = N_{10} + N_{00} = 100 + 900 = 1000$。\n$C=1$ 的总人数：$N_{C=1} = N_{11} + N_{01} = 900 + 100 = 1000$。\n\n标准人口中 $C$ 的分布为：\n$$P_{std}(C=0) = \\frac{N_{C=0}}{N_{total}} = \\frac{1000}{2000} = 0.5$$\n$$P_{std}(C=1) = \\frac{N_{C=1}}{N_{total}} = \\frac{1000}{2000} = 0.5$$\n\n现在，我们通过这个标准分布对每个暴露组的分层特定风险进行加权，以计算其标准化风险。\n$A=1$ 的标准化风险 ($R_{std,1}$)：\n$$R_{std,1} = P(Y=1 | A=1, C=0)P_{std}(C=0) + P(Y=1 | A=1, C=1)P_{std}(C=1)$$\n$$R_{std,1} = (0.05)(0.5) + (0.20)(0.5) = 0.025 + 0.10 = 0.125$$\n\n$A=0$ 的标准化风险 ($R_{std,0}$)：\n$$R_{std,0} = P(Y=1 | A=0, C=0)P_{std}(C=0) + P(Y=1 | A=0, C=1)P_{std}(C=1)$$\n$$R_{std,0} = (0.10)(0.5) + (0.30)(0.5) = 0.05 + 0.15 = 0.200$$\n\n标准化风险差 ($RD_{std}$) 是这些标准化风险之间的差值：\n$$RD_{std} = R_{std,1} - R_{std,0} = 0.125 - 0.200 = -0.075$$\n标准化风险差显示出保护效应，这与分层特定效应一致。\n\n**4. 计算混杂偏倚。**\n\n该问题将风险差尺度上的混杂偏倚定义为粗风险差减去标准化风险差。\n$$Bias = RD_{crude} - RD_{std}$$\n$$Bias = 0.065 - (-0.075) = 0.065 + 0.075 = 0.140$$\n混杂偏倚为 $0.140$。四舍五入到四位有效数字得到 $0.1400$。这个值代表了粗风险差中可归因于 $C$ 的混杂效应的部分。", "answer": "$$\\boxed{0.1400}$$", "id": "4515384"}, {"introduction": "在识别混杂因素时，数字计算是基础，而因果图则是更强大的逻辑工具。本练习引入了有向无环图（DAGs），它能帮助我们清晰地描绘变量间的因果假设。通过分析一个关于流感疫苗效果的场景，您将学会如何利用DAG识别“后门路径”来定位混杂因素，更重要的是，识别并避免调整“对撞因子”，因为错误地调整对撞因子会引入新的偏倚 [@problem_id:4515346]。", "problem": "一个预防医学团队正在研究流感疫苗接种对社区居住成年人因流感住院的因果效应。令 $E$ 表示接受流感疫苗接种，$D$ 表示因流感住院，$C$ 表示年龄，$U$ 表示一般的健康寻求倾向（它影响就医和依从性，但不是由疫苗接种直接引起的），$S$ 表示研究参与状态。该团队认为以下因果关系成立，并可以用一个有向无环图（DAG）来表示：$C \\to E$，$C \\to D$，$E \\to D$，$E \\to S$，$U \\to S$ 和 $U \\to D$。该团队计划使用观察性队列研究设计来估计 $E$ 对 $D$ 的因果效应，并且必须决定对哪些变量进行调整。\n\n应用于预防医学的因果推断基本定义如下：\n- 混杂因素是任何对暴露和结局都有因果影响，但不在它们之间的因果路径上的变量，从而在未被阻断时产生非因果关联。\n- 对撞因子是任何有来自不同原因的两个箭头指向它的变量；对对撞因子或其后代进行条件化，即使其父节点之间不存在因果关系，也可能在它们之间引入关联。\n- 根据后门准则，一个有效的调整集应阻断所有从 $E$ 到 $D$ 的后门路径，而不对对撞因子或其后代进行条件化。\n\n在上述 DAG 中，找出能够消除 $E$ 对 $D$ 因果效应的混杂，同时不引入对撞偏倚的调整集。选择所有适用项。\n\nA. 仅调整 $C$。\n\nB. 仅调整 $S$。\n\nC. 调整 $C$ 和 $U$。\n\nD. 调整 $C$ 和 $S$。\n\nE. 不进行调整。", "solution": "用户希望我根据预防医学中的因果推断原则解决一个问题。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤 1：提取已知信息**\n\n问题提供了以下信息：\n- **变量：**\n  - $E$：接受流感疫苗接种（暴露）\n  - $D$：因流感住院（结局）\n  - $C$：年龄\n  - $U$：一般的健康寻求倾向\n  - $S$：研究参与状态\n- **因果关系：**\n  - $C \\to E$（年龄影响疫苗接种）\n  - $C \\to D$（年龄影响住院）\n  - $E \\to D$（疫苗接种影响住院；这是我们感兴趣的效应）\n  - $E \\to S$（疫苗接种影响研究参与）\n  - $U \\to S$（健康寻求倾向影响研究参与）\n  - $U \\to D$（健康寻求倾向影响住院）\n- **定义：**\n  - **混杂因素：** 一个对暴露和结局都有因果影响，但不在它们之间因果路径上的变量。\n  - **对撞因子：** 一个有来自不同原因的两个箭头指向它的变量。对对撞因子进行条件化可以在其父节点之间引入关联。\n  - **有效的调整集（后门准则）：** 一个变量集，它阻断从暴露 $E$ 到结局 $D$ 的所有后门路径，而不对路径上的对撞因子或其后代进行条件化。\n\n**步骤 2：使用提取的已知信息进行验证**\n\n- **具有科学依据：** 该问题使用了流行病学和因果推断中标准且成熟的概念，即有向无环图（DAGs）、混杂、对撞偏倚和后门准则。在预防医学的观察性研究背景下，所提出的因果关系是合理的。\n- **定义明确：** 该问题提供了一套完整的因果关系，可以明确地构建一个 DAG。问题要求基于一个明确陈述的准则（后门准则）来识别有效的调整集。问题的结构使其能够从所提供的信息中推导出确定的答案。\n- **客观性：** 问题使用流行病学和统计学中精确、正式的术语进行陈述。定义和关系是客观的，不依赖于主观解释。\n\n**步骤 3：结论与行动**\n\n问题陈述是有效的。它科学合理、定义明确且客观。我现在将开始解答。\n\n### 解题过程\n\n目标是找出所有能够对 $E$ 到 $D$ 的因果效应进行无偏估计的调整集。这需要使用后门准则来识别并阻断所有从 $E$到 $D$ 的非因果（后门）路径，同时避免通过对对撞因子进行条件化而产生新的虚假关联。\n\n**1. 构建有向无环图（DAG）**\n\n根据所提供的因果关系（$C \\to E$，$C \\to D$，$E \\to D$，$E \\to S$，$U \\to S$，$U \\to D$），我们可以绘制出如下的因果结构：\n```\n     C\n    / \\\n   v   v\n  E -> D\n  |   ^\n  v   |\n  S -U\n```\n我们感兴趣的因果路径是直接箭头 $E \\to D$。\n\n**2. 识别 $E$ 和 $D$ 之间的所有路径**\n\n我们必须列出连接 $E$ 和 $D$ 的所有路径，暂时忽略箭头的方向，以识别后门路径和包含对撞因子的路径。\n\n- **路径 1（因果路径）：** $E \\to D$。这是我们希望估计的直接因果效应。我们绝不能阻断这条路径。\n\n- **路径 2（后门路径）：** $E \\leftarrow C \\to D$。这是一条连接 $E$ 和 $D$ 的非因果路径。一个箭头指向 $E$（$E \\leftarrow C$），使其成为一条后门路径。变量 $C$ 是 $E$ 和 $D$ 的共同原因。由于此路径不包含对撞因子，它是一条开放路径，会在 $E$ 和 $D$ 之间产生虚假关联。这是由年龄 $C$ 引起的混杂。为了获得 $E$ 对 $D$ 效应的无偏估计，必须通过对 $C$ 进行条件化来阻断此路径。\n\n- **路径 3（对撞路径）：** $E \\to S \\leftarrow U \\to D$。这是另一条连接 $E$ 和 $D$ 的非因果路径。在这条路径上，变量 $S$ 有两个箭头指向它（$E \\to S$ 和 $U \\to S$）。因此，$S$ 是一个对撞因子。包含未被条件化的对撞因子的路径是自然阻断的。除非我们对对撞因子 $S$（或其后代）进行条件化，否则此路径不会在 $E$ 和 $D$ 之间产生虚假关联。对 $S$ 进行条件化将*打开*这条路径，并在 $E$ 和 $D$ 之间引入非因果关联，这种现象被称为对撞偏倚或 M-偏倚。\n\n**3. 应用后门准则**\n\n如果变量集 $Z$ 满足以下两个条件，则它是一个有效的调整集：\n1. $Z$ 阻断了 $E$ 和 $D$ 之间的每一条后门路径。\n2. $Z$ 不会打开任何已阻断的路径（即，$Z$ 不包含 $E$ 和 $D$ 之间路径上的任何对撞因子或其后代）。\n\n在我们的 DAG 中，只有一条后门路径（$E \\leftarrow C \\to D$）。因此，任何有效的调整集都必须阻断这条路径。阻断此路径的唯一方法是对 $C$ 进行条件化。\n此外，任何有效的调整集都不能对对撞因子 $S$ 进行条件化。\n\n现在，我们来评估每个建议的调整集。\n\n**A. 仅调整 $C$。**\n调整集为 $Z = \\{C\\}$。\n- 它是否阻断了后门路径 $E \\leftarrow C \\to D$？是的，因为 $C \\in Z$。\n- 它是否对对撞因子 $S$ 进行了条件化？没有。\n因此，该集合阻断了所有后门路径，且不引入对撞偏倚。\n**结论：正确。**\n\n**B. 仅调整 $S$。**\n调整集为 $Z = \\{S\\}$。\n- 它是否阻断了后门路径 $E \\leftarrow C \\to D$？没有，因为 $C \\notin Z$。\n- 它是否对对撞因子 $S$ 进行了条件化？是的。这会通过打开路径 $E \\to S \\leftarrow U \\to D$ 来引入对撞偏倚。\n因此，该集合因两个原因而无效。\n**结论：错误。**\n\n**C. 调整 $C$ 和 $U$。**\n调整集为 $Z = \\{C, U\\}$。\n- 它是否阻断了后门路径 $E \\leftarrow C \\to D$？是的，因为 $C \\in Z$。\n- 它是否对对撞因子 $S$ 进行了条件化？没有。\n该集合成功地阻断了通过 $C$ 的混杂路径，并且不引入对撞偏倚。变量 $U$ 不是 $E$-$D$ 关系的混杂因素（因为没有从 $U$ 到 $E$ 的路径）。虽然调整 $U$ 对于控制混杂不是必需的，但包含它并不违反后门准则。集合 $\\{C, U\\}$ 仍然是一个有效的调整集。\n**结论：正确。**\n\n**D. 调整 $C$ 和 $S$。**\n调整集为 $Z = \\{C, S\\}$。\n- 它是否阻断了后门路径 $E \\leftarrow C \\to D$？是的，因为 $C \\in Z$。\n- 它是否对对撞因子 $S$ 进行了条件化？是的。这会引入对撞偏倚。\n因为该集合包含了对撞因子 $S$，所以它是一个无效的调整集。\n**结论：错误。**\n\n**E. 不进行调整。**\n调整集是空集 $Z = \\emptyset$。\n- 它是否阻断了后门路径 $E \\leftarrow C \\to D$？没有。\n因此，由 $C$ 引起的混杂未得到控制。\n**结论：错误。**\n\n根据分析，建议的集合中有两个，即 $\\{C\\}$ 和 $\\{C, U\\}$，是能够消除混杂而不引入对撞偏倚的有效调整集。问题要求选择所有适用项。", "answer": "$$\\boxed{AC}$$", "id": "4515346"}, {"introduction": "将理论应用于实践是预防医学研究的关键。本练习模拟了一个队列研究的设计与分析过程，向您展示如何在研究设计阶段通过“匹配”来控制已知的混杂因素。您将使用分层数据，并应用经典的Mantel-Haenszel方法来计算一个合并的、经过调整的风险比，从而获得一个更接近真实因果效应的估计值 [@problem_id:4515349]。", "problem": "一个公共卫生团队计划进行一项队列研究，以估计职业暴露 $E$ 对在为期 $1$ 年的随访期间出现临床结局 $D$ 的因果效应。根据先前证据，已知变量 $C$ 与暴露 $E$ 和结局 $D$ 均相关，且不在从 $E$ 到 $D$ 的因果路径上。因此，根据混杂的核心定义，$C$ 是一个可能的混杂因素：混杂因素是与暴露和结局相关，但不是从暴露到结局的因果路径上的中间变量。为了在设计阶段控制 $C$ 造成的混杂，研究人员对 $C$ 进行了匹配，然后在分析阶段，他们将按匹配集进行分层，以计算合并的因果效应度量。以下是匹配设计的概述：\n\n- 根据 $C$ 的水平定义分层，并在每个分层内，将暴露参与者与基线时具有相同 $C$ 水平的非暴露参与者进行匹配。\n- 允许不同分层采用可变的匹配比例，以保持可行性，同时保证分层内关于 $C$ 的可交换性。\n- 对所有参与者进行相同固定期限的随访，并记录新发病例 $D$。\n\n随访结束后，按 $C$ 定义的 $4$ 个匹配分层的数据被总结为暴露组和非暴露组的人数以及 $D$ 的病例数。设 $a_i$ 表示分层 $i$ 中暴露组的病例数，$b_i$ 表示分层 $i$ 中暴露组的非病例数，$c_i$ 表示分层 $i$ 中非暴露组的病例数，$d_i$ 表示分层 $i$ 中非暴露组的非病例数。设 $n_{1i} = a_i + b_i$ 为暴露组总人数，$n_{0i} = c_i + d_i$ 为非暴露组总人数，$n_i = n_{1i} + n_{0i}$ 为该分层的总人数。观察到的计数如下：\n\n- 分层 $1$：$n_{1,1} = 120$，$n_{0,1} = 180$，$a_1 = 24$，$b_1 = 96$，$c_1 = 18$，$d_1 = 162$。\n- 分层 $2$：$n_{1,2} = 80$，$n_{0,2} = 80$，$a_2 = 12$，$b_2 = 68$，$c_2 = 20$，$d_2 = 60$。\n- 分层 $3$：$n_{1,3} = 60$，$n_{0,3} = 120$，$a_3 = 9$，$b_3 = 51$，$c_3 = 12$，$d_3 = 108$。\n- 分层 $4$：$n_{1,4} = 140$，$n_{0,4} = 70$，$a_4 = 21$，$b_4 = 119$，$c_4 = 14$，$d_4 = 56$。\n\n仅从基本定义——风险是一个群体中病例的比例，风险比（RR）是暴露组与非暴露组的风险之比——以及匹配加分层分析旨在通过在 $C$ 的分层内进行同类比较来消除混杂这一原则出发，推导出跨分层的风险比的合并匹配估计量。然后，使用所提供的数据计算其值。将您的最终数值答案四舍五入至四位有效数字，并以无单位的纯数字形式报告。", "solution": "问题要求在带有分层分析的队列研究中，推导并计算风险比（$RR$）的合并匹配估计量。分层是基于混杂因素 $C$ 进行的。\n\n首先，我们为每个分层 $i$（其中 $i \\in \\{1, 2, 3, 4\\}$）确定基本量。问题提供了每个分层内暴露组和非暴露组的病例数和非病例数。\n设 $a_i$ 为暴露组的病例数，$n_{1i}$ 为暴露组的总人数，$c_i$ 为非暴露组的病例数，$n_{0i}$ 为非暴露组的总人数。\n\n根据风险作为组内病例比例的基本定义，分层 $i$ 中暴露组的风险为：\n$$ R_{1i} = \\frac{a_i}{n_{1i}} $$\n分层 $i$ 中非暴露组的风险为：\n$$ R_{0i} = \\frac{c_i}{n_{0i}} $$\n分层 $i$ 的风险比（$RR$）是这两个风险的比值：\n$$ RR_i = \\frac{R_{1i}}{R_{0i}} = \\frac{a_i / n_{1i}}{c_i / n_{0i}} $$\n研究设计在分析中使用了基于 $C$ 的匹配和分层来控制 $C$ 造成的混杂。这意味着我们在每个分层内进行“同类比较”。为了获得一个跨所有分层的单一效应汇总度量，我们必须合并各分层的特定信息。这个过程假设真实的基础风险比在所有分层中是恒定的（即，$C$ 不存在效应修饰）。\n\n从分层数据中获得合并风险比的标准且最广泛使用的方法是 Mantel-Haenszel (MH) 估计量。从第一性原理推导该估计量涉及对各分层特定信息进行加权以形成一个汇总估计值。风险比的 MH 估计量 $RR_{MH}$ 的结构是，来自每个分层 $2 \\times 2$ 表格的加权分子部分之和除以加权分母部分之和。\n\nMantel-Haenszel 风险比的公式是：\n$$ RR_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{a_i n_{0i}}{n_i}}{\\sum_{i=1}^{k} \\frac{c_i n_{1i}}{n_i}} $$\n其中 $k$ 是分层数（在本题中 $k=4$），$n_i = n_{1i} + n_{0i}$ 是分层 $i$ 中的参与者总数。这个估计量可以被理解为分层特定风险比 $RR_i$ 的加权平均值，其中权重 $w_i = \\frac{c_i n_{1i}}{n_i}$ 因其理想的统计特性而被选择，以确保即使在某些分层数据稀疏的情况下也能得到稳定且一致的估计。该公式直接汇集了每个分层的交叉乘积项，并按分层总人数的倒数进行加权，以创建一个总体的调整后估计值。\n\n我们现在将此公式应用于所提供的数据。我们将为 4 个分层中的每一个计算分子项 $\\frac{a_i n_{0i}}{n_i}$ 和分母项 $\\frac{c_i n_{1i}}{n_i}$。\n\n**分层 1：**\n$a_1 = 24$，$c_1 = 18$，$n_{1,1} = 120$，$n_{0,1} = 180$。\n总人数：$n_1 = 120 + 180 = 300$。\n分子项：$\\frac{a_1 n_{0,1}}{n_1} = \\frac{24 \\times 180}{300} = \\frac{4320}{300} = 14.4$。\n分母项：$\\frac{c_1 n_{1,1}}{n_1} = \\frac{18 \\times 120}{300} = \\frac{2160}{300} = 7.2$。\n\n**分层 2：**\n$a_2 = 12$，$c_2 = 20$，$n_{1,2} = 80$，$n_{0,2} = 80$。\n总人数：$n_2 = 80 + 80 = 160$。\n分子项：$\\frac{a_2 n_{0,2}}{n_2} = \\frac{12 \\times 80}{160} = \\frac{960}{160} = 6$。\n分母项：$\\frac{c_2 n_{1,2}}{n_2} = \\frac{20 \\times 80}{160} = \\frac{1600}{160} = 10$。\n\n**分层 3：**\n$a_3 = 9$，$c_3 = 12$，$n_{1,3} = 60$，$n_{0,3} = 120$。\n总人数：$n_3 = 60 + 120 = 180$。\n分子项：$\\frac{a_3 n_{0,3}}{n_3} = \\frac{9 \\times 120}{180} = \\frac{1080}{180} = 6$。\n分母项：$\\frac{c_3 n_{1,3}}{n_3} = \\frac{12 \\times 60}{180} = \\frac{720}{180} = 4$。\n\n**分层 4：**\n$a_4 = 21$，$c_4 = 14$，$n_{1,4} = 140$，$n_{0,4} = 70$。\n总人数：$n_4 = 140 + 70 = 210$。\n分子项：$\\frac{a_4 n_{0,4}}{n_4} = \\frac{21 \\times 70}{210} = \\frac{1470}{210} = 7$。\n分母项：$\\frac{c_4 n_{1,4}}{n_4} = \\frac{14 \\times 140}{210} = \\frac{1960}{210} = \\frac{196}{21} = \\frac{28}{3}$。\n\n现在，我们对所有分层的分子项和分母项求和。\n分子项之和：\n$$ \\sum_{i=1}^{4} \\frac{a_i n_{0i}}{n_i} = 14.4 + 6 + 6 + 7 = 33.4 $$\n分母项之和：\n$$ \\sum_{i=1}^{4} \\frac{c_i n_{1i}}{n_i} = 7.2 + 10 + 4 + \\frac{28}{3} = 21.2 + \\frac{28}{3} $$\n为了精确计算这个和，我们使用分数：\n$$ 21.2 + \\frac{28}{3} = \\frac{212}{10} + \\frac{28}{3} = \\frac{106}{5} + \\frac{28}{3} = \\frac{106 \\times 3}{15} + \\frac{28 \\times 5}{15} = \\frac{318 + 140}{15} = \\frac{458}{15} $$\n最后，我们计算 Mantel-Haenszel 风险比：\n$$ RR_{MH} = \\frac{33.4}{\\frac{458}{15}} = \\frac{\\frac{334}{10}}{\\frac{458}{15}} = \\frac{167}{5} \\times \\frac{15}{458} = \\frac{167 \\times 3}{458} = \\frac{501}{458} $$\n为了获得数值，我们进行除法运算：\n$$ RR_{MH} = \\frac{501}{458} \\approx 1.09388646... $$\n问题要求将最终答案四舍五入到四位有效数字。\n$$ RR_{MH} \\approx 1.094 $$\n这个值代表暴露 $E$ 对结局 $D$ 效应的估计风险比，该风险比已根据变量 $C$ 的混杂效应进行了调整。", "answer": "$$\\boxed{1.094}$$", "id": "4515349"}]}