{"hands_on_practices": [{"introduction": "在二级预防中，评估筛查试验在真实人群中的表现是核心环节。一项试验的灵敏度（$Se$）和特异度（$Sp$）是其固有属性，但在实际应用中，其价值更多地体现在阳性预测值（$PPV$）和阴性预测值（$NPV$）上，而这两者都深受疾病患病率的影响。通过这个练习[@problem_id:4573462]，你将学会如何计算这些关键指标并解读其意义，从而理解为何筛查阳性不等于最终诊断，以及为何在高特异度的情况下，阳性预测值仍可能不高。", "problem": "一个社区结直肠癌筛查项目使用粪便免疫化学检测。在目标无症状人群中，先前未诊断的疾病患病率为 $\\pi=0.02$。该检测的灵敏度为 $Se=0.90$，特异度为 $Sp=0.95$。二级预防旨在在无症状个体中早期发现疾病，以降低发病率和死亡率。\n\n仅使用灵敏度、特异度、患病率、条件概率和贝叶斯定理的核心定义，完成以下任务：\n\n1. 用 $Se$、$Sp$ 和 $\\pi$ 推导阳性预测值 $\\mathrm{PPV}$、阴性预测值 $\\mathrm{NPV}$ 和阳性似然比 $LR^{+}$ 的符号表达式。\n2. 代入给定值计算 $\\mathrm{PPV}$、$\\mathrm{NPV}$ 和 $LR^{+}$ 的数值。将每个计算量四舍五入至4位有效数字。将 $\\mathrm{PPV}$ 和 $\\mathrm{NPV}$ 表示为小数（不要使用百分号），并将 $LR^{+}$ 表示为一个纯数。\n3. 在此筛查场景下二级预防的背景中，简明地解释每个量的含义。\n\n你的最终数值答案必须按 $\\mathrm{PPV}$、$\\mathrm{NPV}$、$LR^{+}$ 的顺序提供。", "solution": "该问题是有效的，因为它在流行病学和生物统计学方面有科学依据，提法恰当，并为得出唯一解提供了所有必要信息。我们将首先定义相关事件和参数，然后推导符号表达式，计算数值，最后解释结果。\n\n设 $D$ 为个体患有结直肠癌的事件，$D^c$ 为个体未患该病的事件。设 $T^+$ 表示阳性检测结果，$T^-$ 表示阴性检测结果。\n\n给定信息可以用概率表示如下：\n- 疾病的患病率 $\\pi$ 是患病的先验概率：$P(D) = \\pi = 0.02$。\n- 未患病的概率为 $P(D^c) = 1 - P(D) = 1 - \\pi = 1 - 0.02 = 0.98$。\n- 灵敏度 $Se$ 是在患病情况下检测结果为阳性的概率：$P(T^+ | D) = Se = 0.90$。\n- 特异度 $Sp$ 是在未患病情况下检测结果为阴性的概率：$P(T^- | D^c) = Sp = 0.95$。\n\n根据这些定义，我们还可以定义假阴性率和假阳性率：\n- 假阴性率：$P(T^- | D) = 1 - P(T^+ | D) = 1 - Se = 1 - 0.90 = 0.10$。\n- 假阳性率：$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp = 1 - 0.95 = 0.05$。\n\n**1. 符号表达式的推导**\n\n我们需要推导阳性预测值（$\\mathrm{PPV}$）、阴性预测值（$\\mathrm{NPV}$）和阳性似然比（$LR^{+}$）的表达式。\n\n**阳性预测值 ($\\mathrm{PPV}$)**\n$\\mathrm{PPV}$ 是指在检测结果为阳性的情况下，个体确实患病的概率，即 $P(D | T^+)$。根据贝叶斯定理：\n$$\n\\mathrm{PPV} = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}\n$$\n分母 $P(T^+)$ 是检测结果为阳性的总概率。根据全概率公式，我们可以将其表示为：\n$$\nP(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)\n$$\n代入符号参数：\n$$\nP(T^+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi)\n$$\n因此，$\\mathrm{PPV}$ 的符号表达式为：\n$$\n\\mathrm{PPV} = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)}\n$$\n\n**阴性预测值 ($\\mathrm{NPV}$)**\n$\\mathrm{NPV}$ 是指在检测结果为阴性的情况下，个体确实未患病的概率，即 $P(D^c | T^-)$。根据贝叶斯定理：\n$$\n\\mathrm{NPV} = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}\n$$\n分母 $P(T^-)$ 是检测结果为阴性的总概率。根据全概率公式：\n$$\nP(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)\n$$\n代入符号参数：\n$$\nP(T^-) = (Sp)(1 - \\pi) + (1 - Se)(\\pi)\n$$\n因此，$\\mathrm{NPV}$ 的符号表达式为：\n$$\n\\mathrm{NPV} = \\frac{Sp \\cdot (1 - \\pi)}{Sp \\cdot (1 - \\pi) + (1 - Se) \\cdot \\pi}\n$$\n\n**阳性似然比 ($LR^{+}$)**\n$LR^{+}$ 是患病个体中出现阳性检测结果的概率与未患病个体中出现阳性检测结果的概率之比。\n$$\nLR^{+} = \\frac{P(T^+ | D)}{P(T^+ | D^c)}\n$$\n代入符号参数：\n$$\nLR^{+} = \\frac{Se}{1 - Sp}\n$$\n\n**2. 数值计算**\n\n我们将给定值 $\\pi = 0.02$、$Se = 0.90$ 和 $Sp = 0.95$ 代入推导出的表达式，并四舍五入到4位有效数字。\n\n**$\\mathrm{PPV}$ 计算：**\n$$\n\\mathrm{PPV} = \\frac{(0.90)(0.02)}{(0.90)(0.02) + (1 - 0.95)(1 - 0.02)} = \\frac{0.018}{0.018 + (0.05)(0.98)} = \\frac{0.018}{0.018 + 0.049} = \\frac{0.018}{0.067}\n$$\n$$\n\\mathrm{PPV} \\approx 0.2686567...\n$$\n四舍五入到4位有效数字，$\\mathrm{PPV} \\approx 0.2687$。\n\n**$\\mathrm{NPV}$ 计算：**\n$$\n\\mathrm{NPV} = \\frac{(0.95)(1 - 0.02)}{(0.95)(1 - 0.02) + (1 - 0.90)(0.02)} = \\frac{(0.95)(0.98)}{(0.95)(0.98) + (0.10)(0.02)} = \\frac{0.931}{0.931 + 0.002} = \\frac{0.931}{0.933}\n$$\n$$\n\\mathrm{NPV} \\approx 0.9978563...\n$$\n四舍五入到4位有效数字，$\\mathrm{NPV} \\approx 0.9979$。\n\n**$LR^{+}$ 计算：**\n$$\nLR^{+} = \\frac{0.90}{1 - 0.95} = \\frac{0.90}{0.05} = 18\n$$\n表示为4位有效数字，$LR^{+} = 18.00$。\n\n**3. 结合背景的解释**\n\n-   **$\\mathrm{PPV} = 0.2687$**: 阳性预测值表明，对于该人群中接受筛查检测结果为阳性的无症状个体，他们实际患有结直肠癌的概率约为 $26.87\\%$。这种相对较低的 $\\mathrm{PPV}$ 在低患病率疾病的筛查中很常见，它强调了阳性筛查结果并非诊断，而是需要进行进一步更具决定性的诊断性检测（如结肠镜检查）的指征。\n\n-   **$\\mathrm{NPV} = 0.9979$**: 阴性预测值表明，对于接受筛查检测结果为阴性的无症状个体，他们确实未患结直肠癌的概率为 $99.79\\%$。这个非常高的 $\\mathrm{NPV}$ 是一个好的筛查检测的关键特征，因为它能让人非常放心，并能有效地排除检测结果为阴性个体的患病可能性，从而实现了二级预防的一个主要目标。\n\n-   **$LR^{+} = 18.00$**: 阳性似然比表明，阳性检测结果来自患有结直肠癌的个体的可能性是来自未患病个体的18倍。该值量化了检测在增加疾病确定性方面的能力，且独立于疾病的患病率。一个大的 $LR^{+}$（通常 $10$）表明该检测为确认疾病提供了强有力的证据，将概率从检测前概率（患病率）显著转移到检测后概率（$\\mathrm{PPV}$）。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2687  0.9979  18.00\n\\end{pmatrix}\n}\n$$", "id": "4573462"}, {"introduction": "在掌握了单一试验的评估方法后，我们来探讨一个更现实的决策场景：调整筛查试验的阳性判断阈值。这背后存在一个固有的权衡关系：降低阈值可以提高灵敏度以发现更多病例，但这几乎总是以牺牲特异度为代价，从而导致更多的假阳性结果。这个练习[@problem_id:4573392]将让你亲手量化这一决策的后果，计算其对试验预测能力和假阳性人数的具体影响，这是设计和优化筛查方案时必须考量的关键因素。", "problem": "一个区域性健康项目正考虑将前列腺癌筛查的前列腺特异性抗原 (PSA) 阈值从 $4.0$ ng/mL 降低到 $3.0$ ng/mL。在疾病患病率 $p=0.03$ 的目标人群中，PSA 检测在当前阈值下的操作特性为灵敏度 $0.70$ 和特异度 $0.90$，在较低阈值下的操作特性为灵敏度 $0.85$ 和特异度 $0.80$。假设通过筛查对一个包含 $N=10{,}000$ 名无症状男性的队列实施二级预防。\n\n使用基本定义：灵敏度为 $P(\\text{test positive} \\mid \\text{disease})$，特异度为 $P(\\text{test negative} \\mid \\text{no disease})$，患病率为 $P(\\text{disease})$。阳性预测值 (PPV) 为 $P(\\text{disease} \\mid \\text{test positive})$。\n\n计算以下指标的变化量，变化量定义为“新阈值下的值减去旧阈值下的值”：\n- PPV，以小数（而非百分比）表示，以及\n- 每 $10{,}000$ 名筛查者中的假阳性数量。\n\n将 PPV 的变化量四舍五入至四位有效数字。将假阳性数量的变化量报告为精确整数。请将您的最终答案以单行两个值的形式，按上述顺序列出。", "solution": "该问题陈述经评估有效。其科学依据在于流行病学和诊断测试评估的原则，数学上是适定的，拥有充分且一致的数据，并以客观、明确的语言表述。\n\n任务是计算当筛查阈值降低时，阳性预测值 ($PPV$) 和假阳性 ($FP$) 数量的变化。变化量定义为新阈值下的值减去旧阈值下的值。\n\n设 $D$ 为个体患有该疾病的事件，$D^c$ 为个体未患该疾病的事件。设 $T^+$ 表示阳性检测结果，$T^-$ 表示阴性检测结果。\n\n给定数据如下：\n-   疾病患病率：$p = P(D) = 0.03$。因此，$P(D^c) = 1 - p = 1 - 0.03 = 0.97$。\n-   队列规模：$N = 10,000$。\n\n首先，我们分析在旧 PSA 阈值 $4.0$ ng/mL 下的情况。我们用下标 $1$ 表示此阈值下的各项指标。\n-   灵敏度：$Sens_1 = P(T^+ \\mid D) = 0.70$。\n-   特异度：$Spec_1 = P(T^- \\mid D^c) = 0.90$。\n\n根据特异度的定义，我们可以推导出假阳性率，即在未患病的情况下检测结果为阳性的概率：\n$$P(T^+ \\mid D^c) = 1 - Spec_1 = 1 - 0.90 = 0.10$$\n\n阳性预测值 $PPV_1$ 是指在检测结果为阳性的条件下患有该疾病的概率，即 $P(D \\mid T^+)$。我们使用贝叶斯定理来计算它：\n$$PPV_1 = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)}$$\n分母 $P(T^+)$ 是检测结果为阳性的总概率，可使用全概率公式计算得出：\n$$P(T^+) = P(T^+ \\mid D) P(D) + P(T^+ \\mid D^c) P(D^c)$$\n$$P(T^+) = (Sens_1)(p) + (1 - Spec_1)(1 - p)$$\n代入旧阈值的数据：\n$$P(T^+) = (0.70)(0.03) + (0.10)(0.97) = 0.021 + 0.097 = 0.118$$\n现在，我们可以计算 $PPV_1$：\n$$PPV_1 = \\frac{0.021}{0.118} \\approx 0.177966...$$\n\n在旧阈值下的假阳性数量 $FP_1$ 是指队列中未患病但检测结果为阳性的个体数量。\n$$FP_1 = N \\times P(T^+ \\text{ and } D^c) = N \\times P(T^+ \\mid D^c) \\times P(D^c)$$\n$$FP_1 = N \\times (1 - Spec_1) \\times (1 - p)$$\n$$FP_1 = 10,000 \\times (0.10) \\times (0.97) = 1,000 \\times 0.97 = 970$$\n\n接下来，我们分析在新的、较低的 PSA 阈值 $3.0$ ng/mL 下的情况。我们用下标 $2$ 表示此阈值下的各项指标。\n-   灵敏度：$Sens_2 = P(T^+ \\mid D) = 0.85$。\n-   特异度：$Spec_2 = P(T^- \\mid D^c) = 0.80$。\n\n新的假阳性率为：\n$$P(T^+ \\mid D^c) = 1 - Spec_2 = 1 - 0.80 = 0.20$$\n我们使用相同的公式和新的参数来计算新的阳性预测值 $PPV_2$。首先，计算新的检测阳性总概率：\n$$P(T^+) = (Sens_2)(p) + (1 - Spec_2)(1 - p)$$\n$$P(T^+) = (0.85)(0.03) + (0.20)(0.97) = 0.0255 + 0.194 = 0.2195$$\n现在，我们计算 $PPV_2$：\n$$PPV_2 = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)} = \\frac{(0.85)(0.03)}{0.2195} = \\frac{0.0255}{0.2195} \\approx 0.116173...$$\n\n在新阈值下的假阳性数量 $FP_2$ 为：\n$$FP_2 = N \\times (1 - Spec_2) \\times (1 - p)$$\n$$FP_2 = 10,000 \\times (0.20) \\times (0.97) = 2,000 \\times 0.97 = 1,940$$\n\n最后，我们计算所要求的变化量。\n$PPV$ 的变化量为 $\\Delta PPV = PPV_2 - PPV_1$：\n$$\\Delta PPV = 0.116173... - 0.177966... = -0.0617929...$$\n四舍五入至四位有效数字，我们得到 $-0.06179$。\n\n假阳性数量的变化量为 $\\Delta FP = FP_2 - FP_1$：\n$$\\Delta FP = 1,940 - 970 = 970$$\n这是一个精确整数。\n\n最终答案由这两个值按指定顺序组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.06179  970\n\\end{pmatrix}\n}\n$$", "id": "4573392"}, {"introduction": "最后一个实践练习将深入探讨二级预防中最关键的考量之一：筛查可能带来的潜在危害。一个阳性结果，特别是假阳性，会启动一系列后续的诊断程序，而这些程序本身就带有风险。本练习[@problem_id:4573408]旨在通过一个假设模型，将假阳性这个统计概念与侵入性检查可能导致的严重并发症等具体临床后果联系起来。完成此练习后，你将更深刻地体会到在对无症状人群进行筛查时“首先，不造成伤害”的原则，以及权衡筛查收益与潜在风险的重要性。", "problem": "一个公共卫生项目正在评估对高危人群进行年度低剂量计算机断层扫描（LDCT）肺癌筛查的效果。在符合条件的人群中，肺癌的基线年发病率为 $0.006$。对于单次年度筛查，假设筛查时可检测到的临床前期疾病的有效患病率等于年发病率。该筛查测试的灵敏度为 $Se = 0.93$，特异度为 $Sp = 0.75$。考虑一个由 $N = 1{,}000$ 名独立个体组成的队列接受此项筛查。\n\n仅使用灵敏度、特异度和筛查时患病率的核心定义，并在独立性假设下对期望值进行建模：\n\n1) 推导真阳性、假阴性、真阴性和假阳性的期望数量。\n\n2) 计算每 $1{,}000$ 名筛查者中的假阳性期望数量。\n\n3) 筛查结果为阳性后的后续管理遵循以下分布：$70\\%$ 仅接受短间期 LDCT 监测，$23\\%$ 接受正电子发射断层扫描与计算机断层扫描（PET-CT），$5\\%$ 接受经皮穿刺胸腔针吸活检，$2\\%$ 接受支气管镜活检。为便于计算，假设在这四种途径中的分配独立于真实疾病状态（以筛查阳性为条件），并且短间期 LDCT 和 PET-CT 的严重并发症风险可忽略不计。经皮穿刺胸腔针吸活检的严重并发症风险为每次 $0.05$，支气管镜活检的严重并发症风险为每次 $0.01$。\n\n基于这些假设以及您在第 (1) 和 (2) 部分得到的结果，计算每 $1{,}000$ 名筛查个体中由假阳性导致的严重并发症的期望数量。\n\n将最终报告的答案四舍五入到三位有效数字。将最终结果表示为每 $1{,}000$ 名筛查者中的期望人数。仅提供每 $1{,}000$ 名筛查者中因假阳性导致的严重并发症的期望数量作为您的最终数值答案。", "solution": "该问题被评估为有效，因为它科学地基于流行病学和生物统计学的原理，问题提出得当，信息充足，可得出唯一解，并且其表述是客观的。\n\n目标是计算在一个由 $N = 1,000$ 名接受肺癌筛查的个体组成的队列中，由假阳性导致的严重并发症的期望数量。\n\n设 $D$ 为个体患有肺癌的事件，$D^c$ 为个体未患肺癌的事件。设 $T^+$ 为阳性测试结果，$T^-$ 为阴性测试结果。\n\n已知条件如下：\n- 队列大小：$N = 1,000$\n- 筛查时可检测疾病的患病率：$P(D) = 0.006$\n- 测试的灵敏度：$Se = P(T^+ | D) = 0.93$\n- 测试的特异度：$Sp = P(T^- | D^c) = 0.75$\n\n首先，我们确定队列中患病和未患病个体的期望数量。\n个体未患病的概率为 $P(D^c) = 1 - P(D) = 1 - 0.006 = 0.994$。\n患有肺癌的个体期望数量为：\n$$E[N_D] = N \\times P(D) = 1,000 \\times 0.006 = 6$$\n未患肺癌的个体期望数量为：\n$$E[N_{D^c}] = N \\times P(D^c) = 1,000 \\times 0.994 = 994$$\n\n接下来，我们推导筛查的四种可能结果（真阳性、假阴性、真阴性、假阳性）的期望数量。\n\n1.  **期望真阳性 ($E[TP]$)**：检测结果为阳性的患病个体。\n    $$E[TP] = E[N_D] \\times Se = 6 \\times 0.93 = 5.58$$\n\n2.  **期望假阴性 ($E[FN]$)**：检测结果为阴性的患病个体。其概率为假阴性率，$FNR = 1 - Se$。\n    $$FNR = 1 - 0.93 = 0.07$$\n    $$E[FN] = E[N_D] \\times FNR = 6 \\times 0.07 = 0.42$$\n\n3.  **期望真阴性 ($E[TN]$)**：检测结果为阴性的非患病个体。\n    $$E[TN] = E[N_{D^c}] \\times Sp = 994 \\times 0.75 = 745.5$$\n\n4.  **期望假阳性 ($E[FP]$)**：检测结果为阳性的非患病个体。其概率为假阳性率，$FPR = 1 - Sp$。\n    $$FPR = 1 - 0.75 = 0.25$$\n    $$E[FP] = E[N_{D^c}] \\times FPR = 994 \\times 0.25 = 248.5$$\n\n这就完成了问题的前两项要求。每 $1,000$ 名筛查者中的假阳性期望数量为 $248.5$。\n\n现在，我们必须计算由这些假阳性导致的严重并发症的期望数量。问题陈述，筛查结果为阳性的个体将接受进一步管理，且不同管理途径的分配独立于真实疾病状态（即，对真阳性和假阳性是相同的）。\n\n设 $C$ 表示发生严重并发症的事件。我们首先计算任何测试结果为阳性的个体发生严重并发症的概率，$P(C|T^+)$。该概率由后续程序的分布及其相关的并发症风险决定。\n\n对于测试结果为阳性的人，后续程序及其概率如下：\n- 短间期 LDCT 监测：$P(\\text{LDCT}|T^+) = 0.70$，并发症风险 $P(C|\\text{LDCT}) = 0$。\n- PET-CT：$P(\\text{PET-CT}|T^+) = 0.23$，并发症风险 $P(C|\\text{PET-CT}) = 0$。\n- 经皮穿刺胸腔针吸活检：$P(\\text{Perc. Bx}|T^+) = 0.05$，并发症风险 $P(C|\\text{Perc. Bx}) = 0.05$。\n- 支气管镜活检：$P(\\text{Bronch. Bx}|T^+) = 0.02$，并发症风险 $P(C|\\text{Bronch. Bx}) = 0.01$。\n\n使用全概率定律，给定阳性测试结果，发生严重并发症的总概率为：\n$$P(C|T^+) = \\sum_{\\text{proc}} P(C | \\text{proc}) P(\\text{proc} | T^+)$$\n$$P(C|T^+) = (0 \\times 0.70) + (0 \\times 0.23) + (0.05 \\times 0.05) + (0.01 \\times 0.02)$$\n$$P(C|T^+) = 0 + 0 + 0.0025 + 0.0002 = 0.0027$$\n\n由假阳性导致的严重并发症的期望数量是假阳性的期望数量乘以一个假阳性个体发生并发症的概率。因为管理途径独立于真实疾病状态（以筛查阳性为条件），所以假阳性病例发生并发症的概率就是 $P(C|T^+)$。\n\n$$E[\\text{Complications from FP}] = E[FP] \\times P(C|T^+)$$\n$$E[\\text{Complications from FP}] = 248.5 \\times 0.0027$$\n$$E[\\text{Complications from FP}] = 0.67095$$\n\n问题要求将最终答案四舍五入到三位有效数字。\n$$0.67095 \\approx 0.671$$\n\n因此，每 $1,000$ 名筛查个体中由假阳性导致的严重并发症的期望数量为 $0.671$。", "answer": "$$\\boxed{0.671}$$", "id": "4573408"}]}