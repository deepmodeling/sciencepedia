{"hands_on_practices": [{"introduction": "在我们从数据中进行推断或得出结论之前，我们必须首先准确地描述它。虽然像均值和标准差这样的度量很常用，但它们很容易受到异常值的影响，而由于仪器错误或生物极端情况，异常值在现实世界的医学数据中很常见。本练习 [@problem_id:4519105] 将展示稳健描述性统计（例如截尾均值和中位数绝对偏差）在存在此类异常值时，在提供更稳定、更真实的数据摘要方面的价值。", "problem": "一项预防医学中的人群筛查使用自动化实验室分析仪为 $n=40$ 名成人测量空腹血糖（单位：$\\mathrm{mg/dL}$）。由于间歇性仪器误差，测量值中恰好有 $5\\%$ 是严重离群值。测量值（单位为 $\\mathrm{mg/dL}$）如下：$85, 88, 90, 92, 93, 94, 95, 96, 98, 99, 100, 101, 102, 103, 104, 104, 105, 105, 105, 105, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 118, 120, 122, 124, 126, 128, 400, 405$。使用描述性统计学中的以下基本定义：\n- 样本均值 $\\bar{x}$ 为 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。\n- $p$-截尾均值是舍弃排序后样本中最低的 $p$ 比例和最高的 $p$ 比例的数据，然后计算剩余观测值的均值；对于 $p=0.20$ 和 $n=40$，这意味着移除最低的 $8$ 个值和最高的 $8$ 个值。\n- 样本中位数 $\\tilde{x}$ 是排序后样本的中点；对于偶数 $n$，它是中间两个值的平均数。\n- 中位数绝对偏差 (MAD) 此处定义为 $\\operatorname{MAD} = \\operatorname{median}\\left(|x_i - \\tilde{x}|\\right)$（未经缩放）。\n\n计算这些测量值的 $20\\%$ 截尾均值和 MAD，并通过构建无量纲量\n$$D = \\frac{\\bar{x} - \\bar{x}_{\\text{trim}}}{\\operatorname{MAD}}$$\n将它们与未截尾的样本均值进行对比。\n将 $D$ 的最终答案四舍五入至四位有效数字。$D$ 无需单位。", "solution": "该问题要求计算一个无量纲量 $D$，它将标准样本均值与一个稳健的集中趋势度量（截尾均值）进行对比，并由一个稳健的离散程度度量（中位数绝对偏差，或 MAD）进行缩放。计算将分几步进行：首先，计算样本均值 $\\bar{x}$；其次，计算 $20\\%$ 截尾均值 $\\bar{x}_{\\text{trim}}$；第三，计算样本中位数 $\\tilde{x}$ 及相应的 MAD；最后，计算 $D$ 的值。\n\n所提供的数据集包含 $n=40$ 个空腹血糖测量值。数据已按排序顺序给出，我们将其记为 $x_{(i)}$，其中 $i=1, \\dots, 40$：\n$\\{85, 88, 90, 92, 93, 94, 95, 96, 98, 99, 100, 101, 102, 103, 104, 104, 105, 105, 105, 105, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 118, 120, 122, 124, 126, 128, 400, 405\\}$。\n\n**1. 计算样本均值 ($\\bar{x}$)**\n样本均值定义为 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。\n首先，我们计算所有 $40$ 个观测值的总和：\n$$ \\sum_{i=1}^{40} x_i = 85 + 88 + \\dots + 128 + 400 + 405 = 4833 $$\n因此，样本均值为：\n$$ \\bar{x} = \\frac{4833}{40} = 120.825 $$\n\n**2. 计算 $20\\%$ 截尾均值 ($\\bar{x}_{\\text{trim}}$)**\n问题指定了 $p=0.20$ 的截尾均值。对于样本量 $n=40$，需要从排序后样本的两端各舍弃的观测值数量为 $k = p \\times n = 0.20 \\times 40 = 8$。\n我们必须移除最低的 $8$ 个值和最高的 $8$ 个值。\n最低的 $8$ 个值是：$85, 88, 90, 92, 93, 94, 95, 96$。\n最高的 $8$ 个值是：$118, 120, 122, 124, 126, 128, 400, 405$。\n剩余的观测值数量为 $n - 2k = 40 - 2(8) = 24$。这些是从 $x_{(9)}$ 到 $x_{(32)}$ 的观测值。\n截尾后的数据集是：$\\{98, 99, 100, 101, 102, 103, 104, 104, 105, 105, 105, 105, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116\\}$。\n这 $24$ 个值的总和是：\n$$ \\sum_{i=9}^{32} x_{(i)} = 98 + 99 + \\dots + 116 = 2557 $$\n$20\\%$ 截尾均值是这些剩余值的均值：\n$$ \\bar{x}_{\\text{trim}} = \\frac{2557}{24} $$\n\n**3. 计算样本中位数 ($\\tilde{x}$) 和中位数绝对偏差 (MAD)**\n首先，我们求样本中位数 $\\tilde{x}$。由于 $n=40$ 是偶数，中位数是中间两个观测值 $x_{(n/2)}$ 和 $x_{(n/2)+1}$ 的平均值，即 $x_{(20)}$ 和 $x_{(21)}$。\n根据排序后的数据：\n$x_{(20)} = 105$\n$x_{(21)} = 105$\n样本中位数为：\n$$ \\tilde{x} = \\frac{105 + 105}{2} = 105 $$\n接下来，我们计算 MAD，其定义为 $\\operatorname{MAD} = \\operatorname{median}\\left(|x_i - \\tilde{x}|\\right)$。我们计算所有 $40$ 个观测值与中位数 $105$ 的绝对偏差 $|x_i - 105|$，然后找出这组新值的中位数。\n绝对偏差为：\n$|85-105|=20$, $|88-105|=17$, $|90-105|=15$, $|92-105|=13$, $|93-105|=12$, $|94-105|=11$, $|95-105|=10$, $|96-105|=9$, $|98-105|=7$, $|99-105|=6$, $|100-105|=5$, $|101-105|=4$, $|102-105|=3$, $|103-105|=2$, $|104-105|=1$ (两次), $|105-105|=0$ (五次), $|106-105|=1$, $|107-105|=2$, $|108-105|=3$, $|109-105|=4$, $|110-105|=5$, $|111-105|=6$, $|112-105|=7$, $|113-105|=8$, $|114-105|=9$, $|115-105|=10$, $|116-105|=11$, $|118-105|=13$, $|120-105|=15$, $|122-105|=17$, $|124-105|=19$, $|126-105|=21$, $|128-105|=23$, $|400-105|=295$, $|405-105|=300$。\n\n我们将这 $40$ 个绝对偏差排序：\n$0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 9, 9, 10, 10, 11, 11, 12, 13, 13, 15, 15, 17, 17, 19, 20, 21, 23, 295, 300$。\n为了找到这 $40$ 个值的中位数，我们取第 $20$ 个和第 $21$ 个值的平均数。\n第 $20$ 个值是 $7$。\n第 $21$ 个值是 $8$。\nMAD 为：\n$$ \\operatorname{MAD} = \\frac{7 + 8}{2} = 7.5 $$\n\n**4. 计算无量纲量 $D$**\n我们现在使用公式 $D = \\frac{\\bar{x} - \\bar{x}_{\\text{trim}}}{\\operatorname{MAD}}$ 计算 $D$。\n代入计算出的值：\n$$ D = \\frac{120.825 - \\frac{2557}{24}}{7.5} $$\n首先，我们计算分子：\n$$ \\bar{x} - \\bar{x}_{\\text{trim}} = \\frac{4833}{40} - \\frac{2557}{24} = \\frac{4833 \\times 3}{120} - \\frac{2557 \\times 5}{120} = \\frac{14499 - 12785}{120} = \\frac{1714}{120} = \\frac{857}{60} $$\n现在，我们除以 MAD：\n$$ D = \\frac{857/60}{7.5} = \\frac{857/60}{15/2} = \\frac{857}{60} \\times \\frac{2}{15} = \\frac{857}{30 \\times 15} = \\frac{857}{450} $$\n为了获得最终的数值答案，我们进行除法运算：\n$$ D \\approx 1.90444... $$\n问题要求将结果四舍五入至四位有效数字。\n$$ D \\approx 1.904 $$\n$D$ 的值量化了离群值对样本均值的巨大影响。样本均值与截尾均值之差几乎是中位数绝对偏差值的两倍，这表明样本均值的非稳健性导致了显著的失真。", "answer": "$$\\boxed{1.904}$$", "id": "4519105"}, {"introduction": "从描述单个数据集到比较两组是推断统计学中的一个基本步骤。在预防医学中，我们经常需要评估一项干预措施是否比对照措施更有效，或者不同人群是否具有不同的健康结果。本练习 [@problem_id:4771494] 提供了这项核心任务的动手实例，指导你计算两组之间差异的大小（使用科恩的$d$效应量）以及真实差异的可能范围（置信区间）。", "problem": "一位医学史学家正在研究20世纪初聋人教育中长期存在的教学方法之争，即手语主义（接触手语）与口语主义（纯口语方法）的辩论，这是残疾与康复医学史中的一个核心主题。从学校的档案记录中，确定了两个独立的学生队列。第一个队列由接触手语的学生组成，样本量为 $n_{S} = 60$，样本平均识字分数为 $\\bar{x}_{S} = 78$，样本标准差为 $s_{S} = 10$。第二个队列由在口语主义下受教育的学生组成，样本量为 $n_{O} = 60$，样本平均识字分数为 $\\bar{x}_{O} = 68$，样本标准差为 $s_{O} = 12$。假设组间分数独立且近似正态分布。除非有样本证据支持，否则不要假设总体方差相等。\n\n仅使用关于未知方差下均值差的抽样分布的基本定义和经过充分检验的统计结果，计算：\n- 使用合并组内标准差计算的标准化均值差（Cohen’s $d$）。\n- 原始均值差 $\\bar{x}_{S} - \\bar{x}_{O}$ 的双侧 $95\\%$ 置信区间（CI），以测试的原始分数点表示。\n\n将所有报告的数值结果四舍五入到 $3$ 位有效数字。将最终答案以行向量 $[d,\\ \\text{lower bound},\\ \\text{upper bound}]$ 的形式在框中提供，不带单位。", "solution": "首先提取所有给定信息，然后评估其科学和逻辑完整性，以此来验证问题。\n\n### 步骤1：提取已知信息\n问题为两个独立的学生队列提供了以下数据：\n\n**队列1（手语）：**\n- 样本量：$n_{S} = 60$\n- 样本平均识字分数：$\\bar{x}_{S} = 78$\n- 样本标准差：$s_{S} = 10$\n\n**队列2（口语主义）：**\n- 样本量：$n_{O} = 60$\n- 样本平均识字分数：$\\bar{x}_{O} = 68$\n- 样本标准差：$s_{O} = 12$\n\n**假设与约束：**\n- 两个队列是独立的。\n- 每个总体中的分数近似正态分布。\n- 除非有证据支持，否则不假设总体方差相等。\n- 需要一个双侧 $95\\%$ 置信区间。\n- 所有最终数值结果必须四舍五入到 $3$ 位有效数字。\n\n**要求计算：**\n1. 使用合并组内标准差计算的标准化均值差（Cohen’s $d$）。\n2. 原始均值差 $\\bar{x}_{S} - \\bar{x}_{O}$ 的双侧 $95\\%$ 置信区间。\n\n### 步骤2：使用提取的已知信息进行验证\n问题陈述是描述性统计和推断性统计中的一个标准练习，置于一个合理的历史研究背景下。\n\n- **科学依据：** 所需的方法——计算Cohen's $d$和双样本t区间——是统计学中基础且成熟的方法。比较教育成果的情景是这些方法的常见应用。**通过。**\n- **问题定义良好：** 所有必需的数据（两组的$n$、$\\bar{x}$、$s$）和参数（置信水平）都已提供。问题具体，能导出唯一且有意义的解。**通过。**\n- **客观性：** 问题以客观、定量的语言表述。历史框架作为背景，不会为所需计算引入主观性。**通过。**\n- **不完整或矛盾的设定：** 问题存在轻微的模糊性。它首先建议“除非有证据支持，否则不要假设总体方差相等”，但随后又明确指示“使用合并组内标准差”来计算Cohen's $d$，而这一计算本身就依赖于方差相等的假设。这不是一个致命的矛盾，而是一种常见的教学结构。样本方差之比为 $s_{O}^2 / s_{S}^2 = 12^2 / 10^2 = 144 / 100 = 1.44$。这个比值很小（一个引起关注的常用经验法则是比值大于$4$），这表明为了按要求计算合并标准差，方差相等的假设是合理的。然而，对于置信区间，考虑到最初的指示，更稳健且不假设方差相等的Welch-Satterthwaite方法是最合适的程序。因此，可以通过对每个部分使用指定的方法来遵循指令，而不会产生矛盾。**通过。**\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**，因为它在仔细解读其指令时，是科学上合理、定义良好且内部一致的。开始求解。\n\n### 解答\n\n解答需要进行两项计算：Cohen's $d$ 和均值差的95%置信区间。\n\n**1. Cohen's $d$的计算**\n\n问题明确要求使用合并组内标准差 $s_p$。这在方差齐性假设下计算效应量是合适的，而正如验证中所检查的，这是一个合理的假设。合并标准差的公式是：\n$$ s_p = \\sqrt{\\frac{(n_{S} - 1)s_{S}^2 + (n_{O} - 1)s_{O}^2}{n_{S} + n_{O} - 2}} $$\n代入给定值：\n$$ n_{S} = 60, s_{S} = 10, n_{O} = 60, s_{O} = 12 $$\n由于样本量相等（$n_S = n_O = 60$），合并方差的公式简化为：\n$$ s_p^2 = \\frac{(60 - 1)10^2 + (60 - 1)12^2}{60 + 60 - 2} = \\frac{59(10^2 + 12^2)}{118} = \\frac{59(100 + 144)}{118} = \\frac{1}{2} \\times 244 = 122 $$\n合并标准差是：\n$$ s_p = \\sqrt{122} \\approx 11.04536 $$\nCohen's $d$ 定义为均值之差除以合并标准差：\n$$ d = \\frac{\\bar{x}_{S} - \\bar{x}_{O}}{s_p} $$\n均值之差为 $\\bar{x}_{S} - \\bar{x}_{O} = 78 - 68 = 10$。\n$$ d = \\frac{10}{\\sqrt{122}} \\approx \\frac{10}{11.04536} \\approx 0.90535 $$\n四舍五入到 $3$ 位有效数字，Cohen's $d$ 是 $0.905$。\n\n**2. 95%置信区间的计算**\n\n根据验证分析，最合适的方法是使用不假设总体方差相等的Welch-Satterthwaite方法。两个独立均值之差 $\\mu_S - \\mu_O$ 的置信区间公式为：\n$$ (\\bar{x}_{S} - \\bar{x}_{O}) \\pm t_{\\alpha/2, \\nu} \\cdot \\sqrt{\\frac{s_{S}^2}{n_{S}} + \\frac{s_{O}^2}{n_{O}}} $$\n平方根内的项是差值的标准误的平方：\n$$ SE_{\\bar{x}_S - \\bar{x}_O} = \\sqrt{\\frac{10^2}{60} + \\frac{12^2}{60}} = \\sqrt{\\frac{100}{60} + \\frac{144}{60}} = \\sqrt{\\frac{244}{60}} = \\sqrt{\\frac{61}{15}} \\approx \\sqrt{4.06667} \\approx 2.01660 $$\n对于95%的置信区间，显著性水平为 $\\alpha = 1 - 0.95 = 0.05$，因此 $\\alpha/2 = 0.025$。自由度 $\\nu$ 使用Welch-Satterthwaite方程计算：\n$$ \\nu = \\frac{\\left(\\frac{s_{S}^2}{n_{S}} + \\frac{s_{O}^2}{n_{O}}\\right)^2}{\\frac{\\left(\\frac{s_{S}^2}{n_{S}}\\right)^2}{n_{S} - 1} + \\frac{\\left(\\frac{s_{O}^2}{n_{O}}\\right)^2}{n_{O} - 1}} $$\n代入数值：\n$$ \\nu = \\frac{\\left(\\frac{100}{60} + \\frac{144}{60}\\right)^2}{\\frac{\\left(\\frac{100}{60}\\right)^2}{59} + \\frac{\\left(\\frac{144}{60}\\right)^2}{59}} = \\frac{\\left(\\frac{244}{60}\\right)^2}{\\frac{1}{59}\\left[\\left(\\frac{100}{60}\\right)^2 + \\left(\\frac{144}{60}\\right)^2\\right]} = \\frac{(\\frac{61}{15})^2}{\\frac{1}{59}\\left[(\\frac{5}{3})^2 + (\\frac{12}{5})^2\\right]} $$\n$$ \\nu = \\frac{16.5370}{\\frac{1}{59}\\left[2.7778 + 5.76\\right]} = \\frac{16.5370}{\\frac{8.5378}{59}} \\approx \\frac{16.5370}{0.144708} \\approx 114.28 $$\n自由度通常截尾取整为整数，所以 $\\nu = 114$。我们需要从t分布中找到临界值 $t_{0.025, 114}$。使用标准统计计算器， $t_{0.025, 114} \\approx 1.981$。\n误差范围（$ME$）是：\n$$ ME = t_{\\alpha/2, \\nu} \\cdot SE_{\\bar{x}_S - \\bar{x}_O} \\approx 1.981 \\times 2.01660 \\approx 3.99488 $$\n置信区间是围绕观察到的均值差（即10）计算的：\n$$ CI = 10 \\pm 3.99488 $$\n下限：$10 - 3.99488 = 6.00512$\n上限：$10 + 3.99488 = 13.99488$\n将这些界限四舍五入到 $3$ 位有效数字：\n- 下限：$6.01$\n- 上限：$14.0$\n\n最终答案是一个包含Cohen's $d$、CI下限和CI上限的行向量。\n$$ [d, \\text{lower bound}, \\text{upper bound}] = [0.905, 6.01, 14.0] $$", "answer": "$$ \\boxed{\\begin{bmatrix} 0.905  6.01  14.0 \\end{bmatrix}} $$", "id": "4771494"}, {"introduction": "现实世界的研究往往比简单的两组比较更为复杂。暴露与结局之间的关系可能会被混杂变量（如年龄或性别）所扭曲。本练习 [@problem_id:4519146] 介绍了一种解决此问题的强大技术：分层分析。通过在不同层内分析数据，然后使用曼特尔-汉泽尔（Mantel-Haenszel）方法合并结果，你将学习如何计算一个校正了混杂变量影响的合并风险比，这是从流行病学研究中得出有效结论的一项关键技能。", "problem": "一个公共卫生部门进行了一项分层队列研究，以在预防医学的背景下评估一项新的季节性流感疫苗接种计划。在每个分层（按年龄组定义）内，对两组人群进行了一个流感季节的前瞻性随访：接种疫苗的个体（暴露组）和未接种疫苗的个体（非暴露组）。对于每个分层，研究在一个标准的 $2\\times 2$ 表中记录了流感新发病例和非病例的计数：\n- $a_i$：接种疫苗的病例数，\n- $b_i$：接种疫苗的非病例数，\n- $c_i$：未接种疫苗的病例数，\n- $d_i$：未接种疫苗的非病例数，\n- $n_{1i} = a_i + b_i$：接种疫苗总人数，\n- $n_{0i} = c_i + d_i$：未接种疫苗总人数，\n- $n_i = n_{1i} + n_{0i}$：分层总人数。\n\n来自三个年龄分层的数据如下：\n- 分层 $1$：$a_1 = 30$， $b_1 = 170$， $c_1 = 15$， $d_1 = 285$。\n- 分层 $2$：$a_2 = 36$， $b_2 = 144$， $c_2 = 18$， $d_2 = 252$。\n- 分层 $3$：$a_3 = 18$， $b_3 = 102$， $c_3 = 12$， $d_3 = 228$。\n\n从风险（发病比例）的核心定义 $R_{1i} = a_i / n_{1i}$ 和 $R_{0i} = c_i / n_{0i}$，以及风险比 $RR_i = R_{1i} / R_{0i}$ 出发，假设各分层之间存在同质性，即各分层特定的风险比近似等于一个共同值。仅使用这些定义和二项式计数的大样本性质，推导 Mantel–Haenszel (MH) 合并风险比 $RR_{\\mathrm{MH}}$，使其成为在同质性假设下无偏的观测病例数适当加权和的比率，然后通过将 delta 方法应用于 $\\ln(RR_{\\mathrm{MH}})$ 并结合二项式方差近似，推导 $RR_{\\mathrm{MH}}$ 的一个近似 $95\\%$ 置信区间。报告 $RR_{\\mathrm{MH}}$ 的数值及其 $95\\%$ 置信区间的下限和上限，保留三位有效数字。以行向量的形式 $\\left(RR_{\\mathrm{MH}}, \\text{下限}, \\text{上限}\\right)$ 表达您的最终答案。", "solution": "该问题要求推导 Mantel-Haenszel (MH) 合并风险比 $RR_{\\mathrm{MH}}$ 及其相关的 $95\\%$ 置信区间，然后使用所提供的分层队列研究数据进行数值计算。\n\n首先，我们验证问题陈述。\n**第1步：提取已知信息**\n- 分层 $i \\in \\{1, 2, 3\\}$ 的数据以 $2 \\times 2$ 表的形式给出：$a_i$（接种疫苗病例数），$b_i$（接种疫苗非病例数），$c_i$（未接种疫苗病例数），$d_i$（未接种疫苗非病例数）。\n- 导出量：$n_{1i} = a_i + b_i$（接种疫苗总人数），$n_{0i} = c_i + d_i$（未接种疫苗总人数），$n_i = n_{1i} + n_{0i}$（分层总人数）。\n- 数值数据：\n  - 分层 $1$：$a_1 = 30$, $b_1 = 170$, $c_1 = 15$, $d_1 = 285$。\n  - 分层 $2$：$a_2 = 36$, $b_2 = 144$, $c_2 = 18$, $d_2 = 252$。\n  - 分层 $3$：$a_3 = 18$, $b_3 = 102$, $c_3 = 12$, $d_3 = 228$。\n- 定义：接种疫苗组的风险 $R_{1i} = a_i / n_{1i}$，未接种疫苗组的风险 $R_{0i} = c_i / n_{0i}$，分层特定风险比 $RR_i = R_{1i} / R_{0i}$。\n- 假设：风险比同质性，即存在一个共同的风险比 $RR$，使得对所有分层都有 $RR_i \\approx RR$。\n- 任务：推导 $RR_{\\mathrm{MH}}$ 及其 $95\\%$ 置信区间，然后计算它们的数值。\n\n**第2步：使用提取的已知信息进行验证**\n该问题在科学上基于标准的流行病学方法。问题提法清晰，提供了所有必要的数据和定义。语言客观、精确。数据内部一致且合理。例如，在分层1中，$RR_1 = (30/200) / (15/300) = 0.15 / 0.05 = 3$。在分层2中，$RR_2 = (36/180) / (18/270) = 0.20 / (1/15) = 3$。在分层3中，$RR_3 = (18/120) / (12/240) = 0.15 / 0.05 = 3$。数据完美地满足了同质性假设，使得该问题非常适合应用指定的方法。问题有效。\n\n**第3步：推导与计算**\n\n**1. Mantel-Haenszel 合并风险比 ($RR_{\\mathrm{MH}}$) 的推导**\n\n分层队列研究的模型假设在每个分层 $i$ 内，接种疫苗组的病例数 $a_i$ 服从二项分布 $a_i \\sim \\mathrm{Bin}(n_{1i}, p_{1i})$，并且独立地，未接种疫苗组的病例数 $c_i$ 服从 $c_i \\sim \\mathrm{Bin}(n_{0i}, p_{0i})$。真实风险为 $p_{1i}$ 和 $p_{0i}$，由 $R_{1i} = a_i/n_{1i}$ 和 $R_{0i} = c_i/n_{0i}$ 进行估计。\n\n同质性假设假定各分层存在一个共同的风险比 $RR$，使得对所有 $i$ 都有 $p_{1i} = RR \\cdot p_{0i}$。由此可得 $E[a_i] = n_{1i}p_{1i} = n_{1i} \\cdot RR \\cdot p_{0i}$。\n\n为了估计共同的 $RR$，我们可以通过对各分层的加权观测值求和来构造一个估计量。我们寻求权重 $w_i$ 以形成加权和的比率。让我们提出一个形式如下的估计量：\n$$\n\\widehat{RR} = \\frac{\\sum_i w_i a_i}{\\sum_i w_i (\\text{expected value of } a_i \\text{ if } RR=1)}\n$$\n这不完全正确。一个更好的方法是从关系式 $a_i \\approx n_{1i} \\cdot RR \\cdot (c_i/n_{0i})$ 中解出 $RR$。这表明 $RR \\approx \\frac{a_i n_{0i}}{c_i n_{1i}}$，即分层特定的风险比。为了合并这些，我们通过对这个表达式的分子和分母进行求和来创建一个汇总估计量，但需要适当加权。\n\nMantel-Haenszel 估计量的设计方式可以有效地处理讨厌参数，即基线风险 $p_{0i}$。考虑表达式 $a_i \\approx n_{1i} \\cdot RR \\cdot p_{0i}$。为了消除未知的 $p_{0i}$，我们可以用其估计量 $c_i/n_{0i}$ 代替，但如果 $c_i$ 很小，这可能不稳定。\nMH 方法构造了观测到的暴露组病例的加权和 $\\sum_i w_i a_i$，并将其等同于其在模型下的期望值：$E[\\sum_i w_i a_i] = \\sum_i w_i E[a_i] = \\sum_i w_i n_{1i} p_{1i}$。\n使用同质性假设，这变为 $RR \\sum_i w_i n_{1i} p_{0i}$。这给出了 $RR$ 的一个表达式：\n$$\nRR = \\frac{E[\\sum_i w_i a_i]}{\\sum_i w_i n_{1i} p_{0i}}\n$$\n我们可以通过用观测值替换期望值，用样本估计 $c_i/n_{0i}$ 替换未知的真实参数 $p_{0i}$ 来形成一个估计量：\n$$\n\\widehat{RR} = \\frac{\\sum_i w_i a_i}{\\sum_i w_i n_{1i} (c_i/n_{0i})}\n$$\n权重 $w_i$ 的选择至关重要。Mantel 和 Haenszel 提出了权重 $w_i = n_{0i}/n_i$。这些权重与零假设下分层特定风险差异的方差成反比，并在许多情况下导出一个一致且渐近有效的估计量。\n代入 $w_i = n_{0i}/n_i$：\n$$\nRR_{\\mathrm{MH}} = \\frac{\\sum_i (n_{0i}/n_i) a_i}{\\sum_i (n_{0i}/n_i) n_{1i} (c_i/n_{0i})} = \\frac{\\sum_i \\frac{a_i n_{0i}}{n_i}}{\\sum_i \\frac{c_i n_{1i}}{n_i}}\n$$\n这就是 Mantel-Haenszel 合并风险比估计量。它是观测到的暴露组病例数以 $n_{0i}/n_i$ 加权的总和，与一个代表“期望”暴露病例数的项的总和的比率，后者是通过对观测到的非暴露组病例数进行加权而形成的。具体来说，在给定表 $i$ 的所有边际总数的条件下，项 $c_i n_{1i} / n_i$ 是超几何模型下单元格 $a_i$ 的期望病例数。对于大样本，由于期望的比率约等于比率的期望，该估计量是渐近无偏的。\n\n**2. 95% 置信区间的推导**\n\n$RR_{\\mathrm{MH}}$ 的置信区间通常在对数尺度上构建，因为 $\\ln(RR_{\\mathrm{MH}})$ 的分布更接近正态分布。$\\ln(RR_{\\mathrm{MH}})$ 的 $95\\%$ 置信区间由下式给出：\n$$\n\\ln(RR_{\\mathrm{MH}}) \\pm z_{0.975} \\cdot SE[\\ln(RR_{\\mathrm{MH}})]\n$$\n其中 $SE[\\ln(RR_{\\mathrm{MH}})] = \\sqrt{\\widehat{\\mathrm{Var}}(\\ln(RR_{\\mathrm{MH}}))}$ 且 $z_{0.975} \\approx 1.96$ 是标准正态分布的第 $97.5$ 百分位数。\n\n问题要求使用 delta 方法和二项方差近似推导方差。标准方差估计量的完整推导是复杂的。由 Robins, Breslow, 和 Greenland (RBG) 建立的估计量考虑了协方差结构并具有良好的性质。我们在此介绍这个估计量，因为它是将这些原理应用于分层数据背景下的严谨结果。\n令 $N_{\\mathrm{MH}} = \\sum_i a_i n_{0i} / n_i$ 且 $D_{\\mathrm{MH}} = \\sum_i c_i n_{1i} / n_i$，因此 $RR_{\\mathrm{MH}} = N_{\\mathrm{MH}} / D_{\\mathrm{MH}}$。$\\ln(RR_{\\mathrm{MH}})$ 的 RBG 方差估计量为：\n$$\n\\widehat{\\mathrm{Var}}(\\ln(RR_{\\mathrm{MH}})) = \\frac{\\sum_i (m_i n_{1i} n_{0i} - a_i c_i n_i) / n_i^2}{N_{\\mathrm{MH}} \\cdot D_{\\mathrm{MH}}}\n$$\n其中 $m_i = a_i+c_i$ 是分层 $i$ 中的总病例数。该表达式的分子代表分层特定方差贡献的总和，分母是构成 $RR_{\\mathrm{MH}}$ 估计量本身的各项的乘积。\n\n然后通过对 $\\ln(RR_{\\mathrm{MH}})$ 区间的界限取指数，得到 $RR_{\\mathrm{MH}}$ 的置信区间：\n$$\n\\left[ \\exp(\\ln(RR_{\\mathrm{MH}}) - 1.96 \\cdot SE), \\exp(\\ln(RR_{\\mathrm{MH}}) + 1.96 \\cdot SE) \\right]\n$$\n\n**3. 数值计算**\n\n首先，我们计算每个分层的必要总数。\n- 分层 $1$：$a_1=30, b_1=170, c_1=15, d_1=285$。\n  $n_{11} = 30+170 = 200$。$n_{01} = 15+285 = 300$。$n_1 = 200+300 = 500$。$m_1 = 30+15=45$。\n- 分层 $2$：$a_2=36, b_2=144, c_2=18, d_2=252$。\n  $n_{12} = 36+144 = 180$。$n_{02} = 18+252 = 270$。$n_2 = 180+270 = 450$。$m_2 = 36+18=54$。\n- 分层 $3$：$a_3=18, b_3=102, c_3=12, d_3=228$。\n  $n_{13} = 18+102 = 120$。$n_{03} = 12+228 = 240$。$n_3 = 120+240 = 360$。$m_3 = 18+12=30$。\n\n接下来，我们计算 $RR_{\\mathrm{MH}}$ 的分子 ($N_{\\mathrm{MH}}$) 和分母 ($D_{\\mathrm{MH}}$)：\n$N_{\\mathrm{MH}} = \\sum_i \\frac{a_i n_{0i}}{n_i} = \\frac{30 \\cdot 300}{500} + \\frac{36 \\cdot 270}{450} + \\frac{18 \\cdot 240}{360} = 18 + 21.6 + 12 = 51.6$。\n$D_{\\mathrm{MH}} = \\sum_i \\frac{c_i n_{1i}}{n_i} = \\frac{15 \\cdot 200}{500} + \\frac{18 \\cdot 180}{450} + \\frac{12 \\cdot 120}{360} = 6 + 7.2 + 4 = 17.2$。\n\nMantel-Haenszel 合并风险比为：\n$$\nRR_{\\mathrm{MH}} = \\frac{N_{\\mathrm{MH}}}{D_{\\mathrm{MH}}} = \\frac{51.6}{17.2} = 3\n$$\n\n现在，我们计算 $\\ln(RR_{\\mathrm{MH}})$ 的方差。我们需要方差公式的分子，我们称之为 $V_{num}$：\n$V_{num} = \\sum_i \\frac{m_i n_{1i} n_{0i} - a_i c_i n_i}{n_i^2}$。\n- 分层 $1$：$\\frac{45 \\cdot 200 \\cdot 300 - (30 \\cdot 15) \\cdot 500}{500^2} = \\frac{2,700,000 - 225,000}{250,000} = \\frac{2,475,000}{250,000} = 9.9$。\n- 分层 $2$：$\\frac{54 \\cdot 180 \\cdot 270 - (36 \\cdot 18) \\cdot 450}{450^2} = \\frac{2,624,400 - 291,600}{202,500} = \\frac{2,332,800}{202,500} = 11.52$。\n- 分层 $3$：$\\frac{30 \\cdot 120 \\cdot 240 - (18 \\cdot 12) \\cdot 360}{360^2} = \\frac{864,000 - 77,760}{129,600} = \\frac{786,240}{129,600} = 6.066\\overline{6}$。\n\n$V_{num} = 9.9 + 11.52 + 6.066\\overline{6} = 27.486\\overline{6}$。\n方差公式的分母是 $N_{\\mathrm{MH}} \\cdot D_{\\mathrm{MH}} = 51.6 \\cdot 17.2 = 887.52$。\n\n估计的方差为：\n$$\n\\widehat{\\mathrm{Var}}(\\ln(RR_{\\mathrm{MH}})) = \\frac{27.486\\overline{6}}{887.52} \\approx 0.0309700\n$$\n标准误为：\n$$\nSE[\\ln(RR_{\\mathrm{MH}})] = \\sqrt{0.0309700} \\approx 0.175983\n$$\n对于 $95\\%$ 置信区间，我们使用 $\\ln(RR_{\\mathrm{MH}}) = \\ln(3) \\approx 1.09861$。\n对数尺度上置信区间的界限为：\n$1.09861 \\pm 1.96 \\cdot 0.175983 = 1.09861 \\pm 0.344927$。\n下限 (对数)：$1.09861 - 0.344927 = 0.753683$。\n上限 (对数)：$1.09861 + 0.344927 = 1.443537$。\n\n对这些界限取指数，得到 $RR_{\\mathrm{MH}}$ 的置信区间：\n下限：$\\exp(0.753683) \\approx 2.1248$。\n上限：$\\exp(1.443537) \\approx 4.2355$。\n\n将结果四舍五入到三位有效数字：\n$RR_{\\mathrm{MH}} = 3.00$。\n下限 = $2.12$。\n上限 = $4.24$。\n\n最终答案以行向量 $\\left(RR_{\\mathrm{MH}}, \\text{下限}, \\text{上限}\\right)$ 的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 3.00  2.12  4.24 \\end{pmatrix}}$$", "id": "4519146"}]}