{"hands_on_practices": [{"introduction": "衡量新发病例的频率是流行病学的核心任务。本练习将带你亲手计算发病率，这是一个关键指标，它通过“人时”来精确量化动态人群中的疾病风险。你将学习如何处理研究中常见的复杂情况，例如参试者在不同时间加入（交错进入）和因故中断随访（删失），从而掌握队列研究数据分析的基本功。[@problem_id:4541669]", "problem": "一项队列研究旨在估计在从 $0$ 到 $24$ 个月的固定日历时间窗口内，成年志愿者中某种特定传染病首次发作的发生情况。入组在整个窗口期内是交错进行的。每位参与者从其入组时起被视为处于风险中，直到以下事件中最早发生者为止：首次事件、失访或研究的管理性终止（$24$ 个月）。假设没有参与者经历超过一次事件，并且不存在竞争风险。\n\n给定以下每位参与者的个体层面日历入组时间和退出时间（以月为单位），并为每人注明了退出类型：\n\n- 参与者 $1$：入组时间 $0$，退出时间 $6$（事件）。\n- 参与者 $2$：入组时间 $0$，退出时间 $24$（管理性删失）。\n- 参与者 $3$：入组时间 $4$，退出时间 $17$（事件）。\n- 参与者 $4$：入组时间 $5$，退出时间 $14$（失访）。\n- 参与者 $5$：入组时间 $8$，退出时间 $23$（事件）。\n- 参与者 $6$：入组时间 $10$，退出时间 $24$（管理性删失）。\n- 参与者 $7$：入组时间 $12$，退出时间 $20$（事件）。\n- 参与者 $8$：入组时间 $15$，退出时间 $16$（事件）。\n- 参与者 $9$：入组时间 $18$，退出时间 $24$（管理性删失）。\n- 参与者 $10$：入组时间 $20$，退出时间 $22$（失访）。\n\n任务：\n1. 计算总风险人时（使用 $12$ 个月等于 $1$ 年将月份转换为年份）。\n2. 使用总人时，计算研究窗口内首次事件的发生率。\n\n科学真实性假设：失访是由搬迁或联系信息变更引起的，与疾病过程无关。请清楚地陈述为获得基于人时的无偏发生率所需满足的关于删失的假设，然后在此假设下进行计算。\n\n以“例/人年”为单位表示发生率，并将最终数值答案四舍五入到三位有效数字。", "solution": "该队列在一个固定的日历窗口内被观察，具有交错入组以及由研究管理性终止和失访导致的右删失。根据核心流行病学定义，人时是所有参与者处于风险中的持续时间之和，而发生率是新发事件数与总风险人时的比率。\n\n设 $t_{i}^{\\text{entry}}$ 表示参与者 $i$ 的入组日历时间（以月为单位），$t_{i}^{\\text{exit}}$ 表示参与者 $i$ 的退出日历时间（以月为单位），其中退出发生在首次事件、失访或研究管理性终止中最早的时刻。参与者 $i$ 的人时（以月为单位）为\n$$\n\\Delta t_{i} = t_{i}^{\\text{exit}} - t_{i}^{\\text{entry}}.\n$$\n为了以年为单位表示人时，我们除以 $12$，因为 $12$ 个月等于 $1$ 年。设 $\\delta_{i}$ 为事件指示符，如果退出是由于事件，则 $\\delta_{i} = 1$，否则 $\\delta_{i} = 0$。总事件数为 $\\sum_{i=1}^{10} \\delta_{i}$，总人时（以年为单位）为 $\\sum_{i=1}^{10} \\Delta t_{i} / 12$。\n\n在计算之前，我们陈述关于删失的必要假设：我们假设删失是独立的或非信息性的。具体来说，在给定直至删失时间的观察历史的条件下，被删失个体在删失后的事件风险率将与那些仍在观察中的个体的风险率相同。在本研究背景下，这对应于因搬迁或失联导致的删失与潜在的疾病过程无关，因此右删失不会对基于人时的发生率造成偏倚。\n\n我们现在计算每个 $\\Delta t_{i}$（以月为单位）：\n- 参与者 $1$：$\\Delta t_{1} = 6 - 0 = 6$。\n- 参与者 $2$：$\\Delta t_{2} = 24 - 0 = 24$。\n- 参与者 $3$：$\\Delta t_{3} = 17 - 4 = 13$。\n- 参与者 $4$：$\\Delta t_{4} = 14 - 5 = 9$。\n- 参与者 $5$：$\\Delta t_{5} = 23 - 8 = 15$。\n- 参与者 $6$：$\\Delta t_{6} = 24 - 10 = 14$。\n- 参与者 $7$：$\\Delta t_{7} = 20 - 12 = 8$。\n- 参与者 $8$：$\\Delta t_{8} = 16 - 15 = 1$。\n- 参与者 $9$：$\\Delta t_{9} = 24 - 18 = 6$。\n- 参与者 $10$：$\\Delta t_{10} = 22 - 20 = 2$。\n\n总人时（以月为单位）：\n$$\n\\sum_{i=1}^{10} \\Delta t_{i} = 6 + 24 + 13 + 9 + 15 + 14 + 8 + 1 + 6 + 2 = 98 \\text{ 个月}。\n$$\n转换为年：\n$$\n\\text{总人时（年）} = \\frac{98}{12} = 8.\\overline{16} \\text{ 年}。\n$$\n\n计算事件数：\n- 参与者 $1, 3, 5, 7, 8$ 发生事件，得出 $\\sum_{i=1}^{10} \\delta_{i} = 5$。\n\n根据定义，发生率（例/人年）为\n$$\n\\text{发生率} = \\frac{\\sum_{i=1}^{10} \\delta_{i}}{\\sum_{i=1}^{10} \\Delta t_{i}/12} = \\frac{5}{98/12} = \\frac{60}{98} = \\frac{30}{49}.\n$$\n计算其小数表示以便进行四舍五入：\n$$\n\\frac{30}{49} \\approx 0.6122448979\\ldots\n$$\n四舍五入到三位有效数字，发生率为 $0.612$ 例/人年。\n\n在所述的独立删失（相对于事件风险而言是非信息性的）假设下，这个基于人时的发生率是对观察到的风险时间内的平均事件发生率的无偏估计。", "answer": "$$\\boxed{0.612}$$", "id": "4541669"}, {"introduction": "在确定了疾病的发生频率后，流行病学家下一步通常是量化暴露因素与疾病之间的关联强度。比值比（Odds Ratio, $OR$）是衡量这种关联的基石之一，尤其在病例对照研究中至关重要。通过这个练习，你不仅会计算一个原始的比值比，还将深入探讨其与风险比（Risk Ratio, $RR$）之间的理论关系，理解“罕见病假设”的实际意义。[@problem_id:4541737]", "problem": "对一个制造业工人队列进行了为期$1$年的随访，以研究溶剂暴露与新发接触性皮炎之间的关联。数据按暴露和结局状态汇总在一个 $2 \\times 2$ 表中。在暴露组中，有 $n_{1} = 560$ 名工人，随访期间有 $a = 84$ 例皮炎新发病例。在非暴露组中，有 $n_{0} = 900$ 名工人，随访期间有 $c = 45$ 例新发病例。仅使用风险、比值、风险比和比值比的核心定义，根据这些数据计算暴露与新发皮炎之间关联的粗比值比。然后，使用第一性原理，陈述比值比近似于风险比的数学条件，并解释为什么即使在没有混杂或效应修饰的情况下，比值比的不可合并性也会使边际关联与条件关联的解释变得复杂。\n\n将您的最终数值答案报告为粗比值比，表示为一个纯数字并四舍五入到四位有效数字。最终数值答案中不要包含任何单位或符号。", "solution": "为计算比值比，首先将数据整理至一个标准的 $2 \\times 2$ 列联表。\n\n| | 皮炎（病例） | 无皮炎（非病例） | 总计 |\n| :--- | :---: | :---: | :---: |\n| **暴露** | $a=84$ | $b$ | $n_1=560$ |\n| **非暴露**| $c=45$ | $d$ | $n_0=900$ |\n\n可以根据给定的总数计算每组的非病例数：\n没有患皮炎的暴露工人数：$b = n_1 - a = 560 - 84 = 476$。\n没有患皮炎的非暴露工人数：$d = n_0 - c = 900 - 45 = 855$。\n\n完整的表格是：\n| | 皮炎（病例） | 无皮炎（非病例） | 总计 |\n| :--- | :---: | :---: | :---: |\n| **暴露** | $a=84$ | $b=476$ | $n_1=560$ |\n| **非暴露**| $c=45$ | $d=855$ | $n_0=900$ |\n\n**1. 粗比值比（$OR$）的计算**\n\n疾病的比值（Odds）定义为患病人数与未患病人数之比。\n\n暴露组中患皮炎的比值（$Odds_1$）是：\n$$ Odds_1 = \\frac{\\text{暴露组病例数}}{\\text{暴露组非病例数}} = \\frac{a}{b} = \\frac{84}{476} $$\n\n非暴露组中患皮炎的比值（$Odds_0$）是：\n$$ Odds_0 = \\frac{\\text{非暴露组病例数}}{\\text{非暴露组非病例数}} = \\frac{c}{d} = \\frac{45}{855} $$\n\n比值比（$OR$）是暴露组中疾病比值与非暴露组中疾病比值的比率。\n$$ OR = \\frac{Odds_1}{Odds_0} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n\n代入数据中的数值：\n$$ OR = \\frac{84 \\times 855}{476 \\times 45} = \\frac{71820}{21420} \\approx 3.352941... $$\n\n根据要求四舍五入到四位有效数字，粗比值比是 $3.353$。\n\n**2. $OR \\approx RR$ 的数学条件**\n\n风险（或累积发病率）是在指定时间段内发生疾病的概率。\n暴露组的风险（$R_1$）是：\n$$ R_1 = \\frac{a}{a+b} $$\n非暴露组的风险（$R_0$）是：\n$$ R_0 = \\frac{c}{c+d} $$\n风险比（$RR$）是这两个风险的比率：\n$$ RR = \\frac{R_1}{R_0} = \\frac{a/(a+b)}{c/(c+d)} $$\n任何组中比值与风险之间的关系是 $Odds = \\frac{Risk}{1-Risk}$。\n因此，我们可以用风险来表示比值比：\n$$ OR = \\frac{Odds_1}{Odds_0} = \\frac{R_1/(1-R_1)}{R_0/(1-R_0)} = \\left(\\frac{R_1}{R_0}\\right) \\left(\\frac{1-R_0}{1-R_1}\\right) = RR \\times \\left(\\frac{1-R_0}{1-R_1}\\right) $$\n要使比值比（$OR$）近似于风险比（$RR$），校正因子 $\\frac{1-R_0}{1-R_1}$ 必须约等于 $1$。\n$$ \\frac{1-R_0}{1-R_1} \\approx 1 $$\n当疾病罕见时，此条件成立。具体来说，如果疾病在非暴露组和暴露组中的风险都非常小，那么 $R_0 \\ll 1$ 且 $R_1 \\ll 1$。在这种情况下，分母 $(1-R_0)$ 和 $(1-R_1)$ 都接近 $1$，使得它们的比率也接近 $1$。\n$$ \\text{如果 } R_0 \\to 0 \\text{ 且 } R_1 \\to 0, \\text{ 那么 } (1-R_0) \\to 1 \\text{ 且 } (1-R_1) \\to 1. $$\n$$ \\implies \\frac{1-R_0}{1-R_1} \\to \\frac{1}{1} = 1 $$\n因此，比值比近似于风险比的数学条件是，在所有被比较的组中，结局都是罕见的。这通常被称为“罕见病假设”。\n\n**3. 比值比的不可合并性**\n\n可合并性是指一种关联度量所具有的属性，即其粗略（边际）值是分层特异性（条件）值的加权平均值。风险比和风险差是可合并的。比值比则不是；它是不可合并的。\n\n不可合并性意味着，即使在完全没有混杂的情况下，边际比值比也不是条件比值比的简单加权平均值。当粗略的关联度量与共同的条件度量不同，并且这种差异是由于分层变量与暴露和结局均相关时，就存在混杂。\n\n对于比值比，即使分层变量不是混杂因素（即，在结局的各层内，它与暴露不相关），粗 $OR$ 和共同的分层特异性 $OR$ 之间也可能出现差异。这是 $OR$ 的一个纯数学属性。通常，如果分层特异性比值比在各分层中是恒定的（即没有效应修饰）且大于 $1$，那么边际（粗）比值比将向无效值 $1$ 衰减。也就是说，$1 \\le OR_{crude} \\le OR_{conditional}$。相反，如果条件比值比小于 $1$，则粗比值比会更大（更接近 $1$），即 $OR_{conditional} \\le OR_{crude} \\le 1$。只有当关联无效（$OR=1$）或分层变量与结局不相关时，粗 $OR$ 和条件 $OR$ 才会相等。\n\n这种不可合并性使解释变得复杂，因为它将混杂的概念与粗略估计值和校正估计值之间的差异分离开来。当使用风险比时，如果 $RR_{crude} \\neq RR_{adjusted}$，可以断定存在混杂。而当使用比值比时，$OR_{crude} \\neq OR_{adjusted}$ 本身并不意味着存在混杂；这种差异可能仅仅是由于不可合并性这一属性造成的。这意味着，通过比值比测量的关联强度，仅仅因为对一个非混杂变量进行校正就会看起来发生了变化。因此，当用比值比衡量时，边际（人群平均）效应和条件（分层特异性）效应是根本不同的参数，这在决定是报告粗略估计值还是校正估计值时可能导致解释上的挑战。", "answer": "$$\\boxed{3.353}$$", "id": "4541737"}, {"introduction": "在流行病学研究中，我们观察到的暴露与疾病之间的关联有时会受到“第三者”——混杂因素的干扰，从而导致错误的结论。本练习将向你介绍分层分析和Mantel-Haenszel方法，这是一种控制混杂的经典技术。你将通过计算一个合并调整后的比值比，来揭示年龄是如何混淆暴露与疾病之间的真实联系的，并体会调整混杂在流行病学因果推断中的重要性。[@problem_id:4541790]", "problem": "一项预防医学中的分层病例对照研究调查了职业性溶剂暴露（表示为 $E$，分为暴露与未暴露）与慢性肾脏病（表示为 $D$，分为病例与非病例）之间的关联。年龄被认为是一个潜在的混杂因素，并用于构建两个分层：第 $1$ 层为年龄  50岁的研究对象，第 $2$ 层为年龄 $\\geq 50$ 岁的研究对象。观测到以下数据。\n\n对于第 $1$ 层（年龄  50岁）：\n- 在暴露组中，有 $54$ 名病例和 $246$ 名非病例。\n- 在未暴露组中，有 $30$ 名病例和 $270$ 名非病例。\n\n对于第 $2$ 层（年龄 $\\geq 50$ 岁）：\n- 在暴露组中，有 $120$ 名病例和 $180$ 名非病例。\n- 在未暴露组中，有 $80$ 名病例和 $240$ 名非病例。\n\n一项将年龄分层作为协变量的独立多变量逻辑斯谛回归（logistic regression）分析报告，E与D之间关联的调整后比值比（odds ratio, OR）为 $1.99$。\n\n仅使用比值、比值比的基本定义以及分层分析和跨层适当合并的逻辑，计算两个年龄分层的Mantel-Haenszel（MH）合并比值比。然后，将此合并估计值与粗估计值和基于回归的调整值进行比较，用以评估年龄是否混杂了 $E$ 和 $D$ 之间的粗关联。将你最终的 Mantel-Haenszel 合并比值比四舍五入到四位有效数字，并以小数形式表示。只报告 Mantel-Haenszel 合并比值比作为你的最终答案。", "solution": "该问题要求计算职业性溶剂暴露（$E$）与慢性肾脏病（$D$）之间关联的 Mantel-Haenszel (MH) 合并比值比（$OR_{MH}$），并按年龄分层。分析将首先构建所提供的数据，然后应用 Mantel-Haenszel 公式。\n\n让我们用标准的 $2 \\times 2$ 列联表来表示每个分层 $i$ 的数据，其中 $i=1$ 对应于年龄组  50岁，$i=2$ 对应于年龄组 $\\geq 50$ 岁。单元格定义如下：\n- $a_i$：暴露（$E+$）的病例（患病，$D+$）数。\n- $b_i$：暴露（$E+$）的非病例（未患病，$D-$）数。\n- $c_i$：未暴露（$E-$）的病例（患病，$D+$）数。\n- $d_i$：未暴露（$E-$）的非病例（未患病，$D-$）数。\n分层 $i$ 的研究对象总数为 $N_i = a_i + b_i + c_i + d_i$。\n\n根据题目陈述，我们可以填充两个分层的表格。\n\n对于分层 $1$ （年龄  50岁）：\n- $a_1 = 54$ (暴露病例)\n- $b_1 = 246$ (暴露非病例)\n- $c_1 = 30$ (未暴露病例)\n- $d_1 = 270$ (未暴露非病例)\n该分层的研究对象总数为 $N_1 = 54 + 246 + 30 + 270 = 600$。\n\n对于分层 $2$ （年龄 $\\geq 50$ 岁）：\n- $a_2 = 120$ (暴露病例)\n- $b_2 = 180$ (暴露非病例)\n- $c_2 = 80$ (未暴露病例)\n- $d_2 = 240$ (未暴露非病例)\n该分层的研究对象总数为 $N_2 = 120 + 180 + 80 + 240 = 620$。\n\n跨越 $k$ 个分层的 Mantel-Haenszel 合并比值比公式为：\n$$ OR_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{a_i d_i}{N_i}}{\\sum_{i=1}^{k} \\frac{b_i c_i}{N_i}} $$\n在这个问题中，我们有 $k=2$ 个分层。我们将分别计算分子和分母的项。\n\n分子是每个分层的加权交叉乘积 $\\frac{a_i d_i}{N_i}$ 之和：\n对于分层 $1$：\n$$ \\frac{a_1 d_1}{N_1} = \\frac{54 \\times 270}{600} = \\frac{14580}{600} = 24.3 $$\n对于分层 $2$：\n$$ \\frac{a_2 d_2}{N_2} = \\frac{120 \\times 240}{620} = \\frac{28800}{620} = \\frac{1440}{31} $$\n分子的和为：\n$$ \\sum_{i=1}^{2} \\frac{a_i d_i}{N_i} = 24.3 + \\frac{1440}{31} = \\frac{243}{10} + \\frac{1440}{31} = \\frac{243 \\times 31 + 1440 \\times 10}{310} = \\frac{7533 + 14400}{310} = \\frac{21933}{310} $$\n\n分母是每个分层的加权交叉乘积 $\\frac{b_i c_i}{N_i}$ 之和：\n对于分层 $1$：\n$$ \\frac{b_1 c_1}{N_1} = \\frac{246 \\times 30}{600} = \\frac{7380}{600} = 12.3 $$\n对于分层 $2$：\n$$ \\frac{b_2 c_2}{N_2} = \\frac{180 \\times 80}{620} = \\frac{14400}{620} = \\frac{720}{31} $$\n分母的和为：\n$$ \\sum_{i=1}^{2} \\frac{b_i c_i}{N_i} = 12.3 + \\frac{720}{31} = \\frac{123}{10} + \\frac{720}{31} = \\frac{123 \\times 31 + 720 \\times 10}{310} = \\frac{3813 + 7200}{310} = \\frac{11013}{310} $$\n\n现在，我们可以计算 Mantel-Haenszel 合并比值比：\n$$ OR_{MH} = \\frac{\\frac{21933}{310}}{\\frac{11013}{310}} = \\frac{21933}{11013} \\approx 1.991555434... $$\n\n问题要求将最终答案四舍五入到四位有效数字。计算值为 $1.991555...$。第五位有效数字是 $5$，所以我们将第四位数字向上取整。\n$$ OR_{MH} \\approx 1.992 $$\n\n为了评估是否存在混杂，按照问题的指示，我们将这个调整后的比值比与粗比值比进行比较。首先，我们必须通过将各分层合并成一个单一的 $2 \\times 2$ 表来计算粗比值比：\n- 总暴露病例数：$a_{crude} = a_1 + a_2 = 54 + 120 = 174$\n- 总暴露非病例数：$b_{crude} = b_1 + b_2 = 246 + 180 = 426$\n- 总未暴露病例数：$c_{crude} = c_1 + c_2 = 30 + 80 = 110$\n- 总未暴露非病例数：$d_{crude} = d_1 + d_2 = 270 + 240 = 510$\n\n粗比值比为：\n$$ OR_{crude} = \\frac{a_{crude} \\times d_{crude}}{b_{crude} \\times c_{crude}} = \\frac{174 \\times 510}{426 \\times 110} = \\frac{88740}{46860} \\approx 1.894 $$\n调整后的 Mantel-Haenszel 比值比（$OR_{MH} \\approx 1.992$）与粗比值比（$OR_{crude} \\approx 1.894$）不同。层特异性比值比分别为 $OR_1 = \\frac{54 \\times 270}{246 \\times 30} = \\frac{14580}{7380} \\approx 1.976$ 和 $OR_2 = \\frac{120 \\times 240}{180 \\times 80} = \\frac{28800}{14400} = 2.0$。这些值相对同质，并且都与粗估计值不同，表明年龄是一个混杂因素。Mantel-Haenszel 估计值（$1.992$）提供了一个经年龄调整后的单一关联汇总度量，它与报告的逻辑斯谛回归调整后 OR 值 $1.99$ 非常接近，从而加强了该调整估计值的有效性。粗 OR 低估了关联的强度。\n\n最终要求的答案是 Mantel-Haenszel 合并比值比，四舍五入到四位有效数字。", "answer": "$$\n\\boxed{1.992}\n$$", "id": "4541790"}]}