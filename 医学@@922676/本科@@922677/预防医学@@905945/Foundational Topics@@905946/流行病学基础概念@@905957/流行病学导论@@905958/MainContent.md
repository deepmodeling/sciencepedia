## 引言

流行病学是公共卫生和预防医学的基石，它是一门研究人群中健康相关状态的分布、决定因素并应用于控制健康问题的科学。它的意义远不止于追踪[传染病](@entry_id:182324)暴发，更在于为我们理解为何某些人群比其他人群更健康、以及如何有效干预以促进整体福祉提供了科学的语言和工具。然而，从观察到一个健康现象到得出其背后的因果结论，再到制定有效的公共卫生策略，这一过程充满了挑战。如何系统性地量化疾病负担？如何设计研究来检验一个暴露因素是否真的导致了某种疾病？我们又该如何应对研究中不可避免的偏倚和混杂，以确保结论的可靠性？

本篇文章旨在为这些核心问题提供一个系统性的解答。通过深入学习，读者将掌握流行病学的基本思维方式和核心方法论。我们将分三个章节展开：

在“原理与机制”一章中，我们将奠定理论基础，从衡量疾病频率的发病率和患病率，到支撑因果推断的队列研究和病例对照研究等核心设计，并深入探讨混杂与偏倚等效度威胁。

接下来，在“应用与跨学科联系”一章中，我们将把理论付诸实践，展示流行病学如何在暴发调查、疫苗评价、临床诊断乃至社会政策评估等真实场景中发挥关键作用，并彰显其与临床医学、社会科学等领域的紧密联系。

最后，“动手实践”部分将提供具体的计算练习，帮助您将所学概念应用于实际数据，从而巩固对发病率计算、关联度量和混杂控制等关键技能的理解。

通过这一结构化的学习路径，您将能够建立起对流行病学这门学科的全面认识，为未来在公共卫生或临床领域的实践打下坚实的基础。

## 原理与机制

流行病学作为一门定量科学，其核心在于精确测量人群中的疾病频率，并严谨地评估暴露与结局之间的关联。本章旨在阐述支撑流行病学研究的基本原理和机制。我们将从疾病频率的基础测量指标入手，进而探讨用于获取这些测量值的研究设计，最终深入剖析评估因果关系时所面临的关键挑战，如偏倚与混杂。

### 疾病频率的测量

为了描述疾病在人群中的分布，流行病学使用几个核心指标来量化疾病的发生。这些指标的选择取决于研究问题的性质和可用数据的类型。

#### 发病测量：累积发病率与发病率

发病（Incidence）衡量的是在特定时期内，易感人群中新发疾病的频率。它反映了从“无病”到“有病”状态的转变，是衡量疾病风险和评估预防措施效果的关键。发病可以通过两种主要方式来测量：**累积发病率**和**发病率**。

**累积发病率 (Cumulative Incidence)**，通常也称为**风险 (Risk)**，衡量的是在一个确定的随访时期内，初始无病人群中发生疾病的个体所占的比例。它是一个概率，其数值范围在 $0$ 到 $1$ 之间，没有单位。其计算公式为：

$$ I_c(t) = \frac{\text{在 }[0,t]\text{ 时间段内的新发病例数}}{\text{在 }t=0\text{ 时的初始风险人群数量}} $$

这个指标最适用于**封闭队列 (closed cohort)** 研究，即一个固定的人群从一个时间点开始被完整地追踪。例如，设想一项研究，在 $t=0$ 时招募了 $1000$ 名没有某非传染性疾病的工人，并对他们进行为期两年的随访。如果在随访期间，有 $50$ 名工人患上该病，那么该队列在这两年内的累积发病率（或风险）就是 $50/1000 = 0.05$。这个计算的一个关键假设是所有个体都被完整地随访了整个时期。然而，在现实研究中，常会发生失访或因其他原因死亡（即所谓的**删失 (censoring)**）。当删失发生时，简单地用初始人群作为分母会低估真实风险，因为并非所有人都贡献了完整的风险观察时间。在这种情况下，需要使用生存分析等更复杂的方法来获得无偏的估计 [@problem_id:4541667]。

与累积发病率不同，**发病率 (Incidence Rate)** 或称**发病密度 (Incidence Density)**，衡量的是新发病例发生的速度。它适用于人口不断变化的**动态人群 (dynamic population)**，或者随访时间不固定的队列研究。发病率的分母不再是人口数，而是所有个体处于风险状态下的观察时间总和，即**人时数 (person-time)**。其计算公式为：

$$ \lambda = \frac{\text{新发病例数}}{\text{总人时数}} $$

发病率的单位是时间的倒数，例如“每 $1000$ 人年”或“每人月”。它回答的问题是“疾病发生得有多快？”。例如，一个基层医疗网络服务于一个成员动态变化的社区，在两年内记录了 $80$ 例新发病例，并累计了 $2400$ 个无病成员的观察人月数。那么，该人群的发病率就是 $80 / 2400 = 1/30$ 每人月。这个指标的优势在于它能精确地利用每一个体贡献的风险时间信息，因此在存在大量删失或个体进出队列的情况下，它是比累积发病率更准确的测量方式 [@problem_id:4541667]。

#### 患病测量：时点患病率

与关注新发病例的发病不同，**患病率 (Prevalence)** 衡量的是在特定时间点，人群中存在（包括新发和旧有）某种疾病的个体所占的比例。它提供了一个疾病负担的“快照”。**时点患病率 (Point Prevalence)** 的计算公式为：

$$ P(t^*) = \frac{\text{在 }t^*\text{ 时刻的所有现患病例数}}{\text{在 }t^*\text{ 时刻的总人口数}} $$

患病率是一个比例，其数值范围在 $0$ 到 $1$ 之间，没有单位。它最常用于**横断面研究 (cross-sectional study)**。例如，在某一天对一个拥有 $5000$ 名居民的城市进行普查，发现其中有 $300$ 人患有某种疾病，那么该疾病在此时点的患病率即为 $300 / 5000 = 0.06$ [@problem_id:4541667]。

#### 发病率与患病率的关系

发病率和患病率通过疾病的**病程 (duration)** 联系在一起。在一个处于**[稳态](@entry_id:139253) (steady state)** 的人群中——即发病率和病程都保持稳定，且人口规模不变——患病率、发病率和平均病程之间存在一个简单的近似关系：

$$ P \approx I \times D $$

其中，$P$ 是患病率，$I$ 是发病率，$D$ 是疾病的平均持续时间。这个公式的直观解释是，一个疾病的患病人数（存量）取决于新发病例的流入速率（发病率）和病人从患病状态中恢复或死亡的流出速率（其倒数即为平均病程）。

这个关系的成立依赖于严格的假设，尤其是**[稳态假设](@entry_id:269399)**。如果发病率或病程发生改变，患病率也会随之动态调整，直至达到新的平衡。例如，假设一种慢性病的年发病率 $I$ 突然从 $I_0$ 增加到 $I_1$，而平均病程 $D$ 不变。患病率 $P(t)$ 不会立即跃升至新的[稳态](@entry_id:139253)水平 $I_1 \times D$，而是会从旧的[稳态](@entry_id:139253)水平 $I_0 \times D$ 开始，随时间推移逐渐趋近于新水平。这个动态过程可以通过一个[积分方程](@entry_id:138643)来精确描述，该方程考虑了过去所有时间点新发病的队列中至今仍然患病的人数 [@problem_id:4541817]。这个关系在公共卫生实践中非常重要，例如，一种能延长生存期但不能治愈疾病的新疗法会增加疾病的患病率，即使发病率并未改变。

### 流行病学研究设计

为了获得上述测量指标并检验有关暴露与疾病关系的假说，流行病学家采用不同的研究设计。主要的[观察性研究](@entry_id:174507)设计包括队列研究、病例对照研究和横断面研究。

**队列研究 (Cohort Study)** 的逻辑是“因”到“果”。研究者首先确定一个无特定结局的风险人群（队列），根据他们是否暴露于某个因素（如职业溶剂暴露）将其分为暴露组和非暴露组，然后向前追踪（前瞻性）这个队列，观察并比较两组人群中结局（如慢性呼吸道疾病）的发病情况。因为队列研究直接观察新发病例的出现，所以它能够直接计算**发病率**或**累积发病率**，并进而计算关联强度指标如**风险比**或**率比**。队列研究最显著的优点是其清晰的**时序性 (temporality)**——暴露的测量在结局发生之前，这为因果推断提供了强有力的支持。然而，其主要挑战包括**失访偏倚 (loss to follow-up bias)**，特别是当失访与暴露和结局均相关时。此外，该设计对于研究罕见结局效率较低 [@problem_id:4541694]。

**病例对照研究 (Case-Control Study)** 的逻辑与队列研究相反，是“果”到“因”。研究者首先根据结局状态选择研究对象：一组是患有目标疾病的个体（病例组），另一组是来自同一源人群但不患该病的可比个体（[对照组](@entry_id:188599)）。然后，通过回顾性调查（如查阅记录或访谈）来确定并比较两组人群在过去暴露于某个因素的比例。这种设计本身无法计算发病率或患病率，因为它的人群是研究者根据结局[人为选择](@entry_id:168356)的。它所能估计的主要关联强度指标是**比值比 (Odds Ratio)**。病例对照研究对于研究**罕见结局**非常高效，但其主要软肋在于易受多种偏倚影响，尤其是**选择偏倚 (selection bias)**（[对照组](@entry_id:188599)的选择是否能代表产生病例的源人群）和**回忆偏倚 (recall bias)**（病例可能比对照更清楚地回忆过去的暴露史）。通过选择新发病例，可以在一定程度上加强时序性判断 [@problem_id:4541694]。

**横断面研究 (Cross-Sectional Study)** 在单一时间点上对人群进行“快照”式调查，同时收集关于暴露和结局的信息。因此，它自然地测量**患病率**，并可以计算**患病率比**或**患病率比值比**。这种设计的最大局限在于**时序性模糊**，很难确定是暴露导致了疾病，还是疾病状态影响了个体的暴露（即**因果倒置 (reverse causation)**）。此外，它还容易受到**生存偏倚 (survival bias)** 的影响，因为它倾向于纳入病程较长的病例，而忽略那些病程短（迅速痊愈或死亡）的病例。因此，横断面研究对于进行因果推断的能力非常有限，主要用于描述性目的，如估算疾病负担 [@problem_id:4541694]。

### 关联的量化与解释

在确定了研究设计并收集数据后，下一步是量化暴露与结局之间的关联强度。

基于发病测量的关联指标主要来自队列研究：
*   **风险比 (Risk Ratio, RR)**，也称相对风险 (Relative Risk)，是暴露组的累积发病率与非暴露组累积发病率之比 ($RR = CI_1 / CI_0$)。它回答“暴露使发病风险增加了多少倍？”。
*   **风险差 (Risk Difference, RD)**，是两组累积发病率之差 ($RD = CI_1 - CI_0$)。它衡量了归因于暴露的绝对超额风险，在公共卫生决策中具有重要意义。
*   **率比 (Incidence Rate Ratio, IRR)**，是暴露组的发病率与非暴露组发病率之比 ($IRR = IR_1 / IR_0$)。它用于比较两组疾病发生的速度 [@problem_id:4541729]。

基于比值（Odds）的关联指标：
*   **比值比 (Odds Ratio, OR)** 是暴露组中结局发生的比值与非暴露组中结局发生的比值之比。比值定义为事件发生的概率与不发生的概率之比 ($Odds = p / (1-p)$)。OR是病例对照研究中唯一的关联度量，也常用于横断面研究和逻辑回归分析。在罕见疾病的假设下，OR可以近似等于RR [@problem_id:4541729]。

这些关联指标的计算本身是直接的，但其解释却充满挑战。一个观察到的关联是否反映了真实的因果关系？这引导我们进入流行病学方法论的核心——对偏倚和效度的考量。

### 对因果关系的探寻：偏倚与效度

流行病学的最终目标之一是识别疾病的可改变的决定因素，即寻找因果关系。然而，从观察到的关联到因果结论的道路上布满了陷阱，主要包括混杂偏倚和选择偏倚。

#### 因果效应的定义：潜在结局框架

为了严谨地讨论因果关系，现代流行病学引入了**潜在结局 (potential outcomes)** 或**反事实 (counterfactual)** 框架。让我们定义二元暴露 $A$（$A=1$ 为接受干预，$A=0$ 为未接受）和二元结局 $Y$（$Y=1$ 为患病，$Y=0$ 为未患病）。对于任何一个个体，我们都可以设想其两种潜在结局：$Y^{a=1}$，即该个体假如接受干预后的结局；以及 $Y^{a=0}$，即该个体假如未接受干预后的结局。

对于单个个体而言，其**个体因果效应 (individual causal effect)** 就是 $Y^{a=1} - Y^{a=0}$。然而，在现实中，我们永远只能观察到其中一个潜在结局（事实结局），而另一个则永远无法获知（反事实结局）。这就是“因果推断的根本问题”。因此，我们转向在群体水平上定义**平均因果效应 (Average Causal Effect, ACE)**，即 $E[Y^{a=1} - Y^{a=0}]$。这个量代表了“如果整个人群都接受干预，相比于整个人群都不接受干预，人群平均结局的差异”。例如，公共卫生决策者希望了解某项预防措施能使人群中感染病例数减少多少，他们所关心的目标估计量 (estimand) 正是这个平均因果效应 [@problem_id:4541597]。需要强调的是，这个因果参数与我们在数据中直接计算的关联指标（如 $E[Y|A=1] - E[Y|A=0]$）有着本质区别。后者可能会受到偏倚的影响。

#### 金标准：随机化与[可交换性](@entry_id:263314)

**随机对照试验 (Randomized Controlled Trial, RCT)** 被视为评估因果效应的金标准，其力量源于**随机化 (randomization)**。正确实施的随机化能够确保处理组（$A=1$）和[对照组](@entry_id:188599)（$A=0$）在基线时具有**可交换性 (exchangeability)**。[可交换性](@entry_id:263314)用符号表示为 $Y^a \perp \!\!\! \perp A$，意味着个体的潜在结局与其被分配到的处理组别是统计独立的。换言之，无论一个病人被分到哪个组，他的潜在结局（如预后好坏）都是一样的。

随机化之所以能实现这一点，是因为它使得处理分配 $A$ 与所有基线特征——无论是已测量的协变量 $X$ 还是未测量的协变量 $U$——都相互独立。由于潜在结局 $Y^a$ 本身也是由个体的基线特征决定的，因此它也与处理分配 $A$ 相互独立。[可交换性](@entry_id:263314)是进行因果推断的关键假设，因为它保证了两组之间除了接受的干预不同之外，在所有其他方面都是（期望上）可比的。这样，观察到的结局差异就可以归因于干预本身 [@problem_id:4541635]。

#### [观察性研究](@entry_id:174507)中的威胁：混杂

在非随机化的观察性研究中，我们不能想当然地认为暴露组和非暴露组是可交换的。当存在一个变量，它既是暴露的**[共同原因](@entry_id:266381) (common cause)**，又是结局的[共同原因](@entry_id:266381)时，就会出现**混杂 (confounding)**。混杂的存在意味着暴露组和非暴露组在基线时的疾病风险就不同，从而导致观察到的关联并不等于真实的因果效应。

在潜在结局框架下，混杂被定义为暴露组与非暴露组之间缺乏[可交换性](@entry_id:263314) ($Y^a \not\perp \!\!\! \perp A$)。例如，在一项评估某种预防性药物 ($A$) 能否预防流感 ($Y$) 的队列研究中，年龄 ($L$) 可能是一个混杂因素。老年人 ($L=1$) 可能更倾向于服用预防药物（$L$ 影响 $A$），同时他们自身的免疫力较低，患[流感](@entry_id:190386)的风险也更高（$L$ 影响 $Y$）。即使药物本身完全无效（即在每个年龄层，用药和不用药的[流感](@entry_id:190386)风险相同），由于暴露组中老年人比例更高，我们会观察到暴露组的总体[流感](@entry_id:190386)风险高于非暴露组，从而错误地得出药物有害的结论。

解决混杂的方法之一是**限制 (restriction)** 或**分层 (stratification)**。通过在混杂因素的每个层内部分别计算关联，我们可以消除该因素的混杂效应。在上述例子中，如果在老年人组和年轻人组中分别比较用药和不用药者的风险，我们会发现两组内的风险比都为1，从而得出药物无效的正确结论。这种方法旨在实现**条件[可交换性](@entry_id:263314) (conditional exchangeability)**，即 $Y^a \perp \!\!\! \perp A | L$ [@problem_id:4541781]。

#### 所有研究中的威胁：选择偏倚

与混杂偏倚（通常源于研究设计阶段暴露组与非暴露组的不可比性）不同，**选择偏倚 (selection bias)** 通常是由于研究者在分析阶段选择了一个特定的亚组而引入的。一种特别微妙且重要的选择偏倚是**[对撞偏倚](@entry_id:163186) (collider bias)**。

当两个独立的变量（如暴露 $X$ 和结局 $Y$）共同导致第三个变量（即选择变量 $S$，称为**对撞因子 (collider)**）时，如果我们仅在 $S$ 的某个特定水平上（例如，仅在参与研究的人群中，$S=1$）进行分析，就会在 $X$ 和 $Y$ 之间人为地制造出虚假的关联。

设想在一个源人群中，某种暴露 $X$ 和结局 $Y$ 是完全独立的。但是，参与一项研究 ($S=1$) 的概率同时取决于暴露状态和结局状态（例如，有病的暴露者最愿意参加，无病的非暴露者最不愿意参加）。在这种情况下，即使 $X$ 和 $Y$ 在源人群中毫无关系，但在我们招募的研究参与者中，它们会变得相关。这是因为，例如，在一个参与研究的非暴露者中，他/她更有可能是有病的（因为有病会增加参与意愿，从而弥补非暴露带来的参与意愿的降低）。这就人为地在 $X$ 和 $Y$ 之间建立了一条非因果的关联路径。在数字上可以证明，即使在源人群中 $P(Y=1|X=1) = P(Y=1|X=0)$，但在参与者中 $P(Y=1|S=1, X=1) \neq P(Y=1|S=1, X=0)$ [@problem_id:4541748]。

这个机制解释了为什么在RCT中，一些看似无害的分析选择也会破坏随机化带来的好处。例如，**依从性 (compliance)** 和**失访 (loss to follow-up)** 都是在随机化之后发生的事件，它们本身可能受到处理分配和潜在结局的影响，因此是对撞因子。如果我们只分析那些完全依从医嘱的参与者（即所谓的“**按方案分析 (per-protocol analysis)**”），或者只分析那些完成了随访的参与者（“**完整病例分析 (complete-case analysis)**”），就相当于在对撞因子上进行了条件限制，从而可能引入选择偏倚，破坏了最初由随机化保证的[可交换性](@entry_id:263314)。这就是为什么在RCT中，首选的分析策略是**意向性治疗分析 (intention-to-treat, ITT)**，即“一旦随机，永远分析”，它比较的是最初被随机分配的组，而不管他们后来的依从性或失访情况如何 [@problem_id:4541635]。

#### 内部效度与外部效度

流行病学研究的质量可以用两个维度来评价：**内部效度 (internal validity)** 和**外部效度 (external validity)**。

**内部效度**指的是研究结果在研究人群内部的真实性和准确性。一个具有高度内部效度的研究能够无偏地估计出暴露对结局的因果效应。实现内部效度需要满足三个核心假设：[可交换性](@entry_id:263314)（无混杂）、一致性（潜在结局的定义清晰）和正性（所有亚组中都有暴露和非暴露的个体）。RCT通过随机化来保证可交换性，因此通常具有很高的内部效度 [@problem_id:4541769]。

**外部效度**，也称**可推广性 (generalizability)** 或**可移植性 (transportability)**，指的是将研究结果推广到研究人群之外的目标人群的能力。即使一项RCT具有完美的内部效度，其结果也未必能直接应用于另一个不同的人群。这是因为暴露的效应可能会被其他因素（即**效应修饰因子 (effect modifier)**）所改变，而这些因素在研究人群和目标人群中的分布可能不同。例如，一个在年轻人中有效的疫苗，在老年人中可[能效](@entry_id:272127)果较差。如果我们的试验主要在年轻人中进行，那么将试验结果直接推广到老年人群体中就会出错。

要想在科学上严谨地将一个研究 ($S=1$) 的结果移植到另一个目标人群 ($S=0$)，就需要满足额外的假设，最核心的是：在控制了所有相关的效应修饰因子 $Z$ 之后，潜在结局与人群来源是独立的 ($Y^a \perp S | Z$)。这本质上是说，效应修饰的机制是已知的、可测量的，并且在两个人群中是相同的。在实践中，这通常通过基于模型的标准化或加权方法来实现，而这些模型的正确设定本身也是一个挑战 [@problem_id:4541769]。

#### 关于解释关联指标的注记：比值比的不可折叠性

最后，需要指出一个关于**比值比 (Odds Ratio)** 的特殊数学性质，即**不可折叠性 (non-collapsibility)**。对于像风险差 (RD) 这样的“可折叠”指标，如果它在每个亚组（如男性和女性）中都相同，那么合并人群后的粗略指标将会是这个共同值的加权平均。

然而，比值比并非如此。即使在一个没有混杂的理想场景下（例如，在一个RCT中，暴露 $X$ 与某个基线风险因素 $Z$ 相互独立），由逻辑[回归模型](@entry_id:163386)算出的调整（分层）OR，也通常不等于不考虑 $Z$ 时的粗略（合并）OR。具体来说，只要 $Z$ 是结局的一个风险因素，粗略OR会比调整OR更接近于1（即效应更弱）。

这并非一种偏倚，而是OR这一指标固有的数学特性，源于logit函数的非线性。它提醒我们，当使用逻辑回归时，模型中包含或排除一个与暴露无关的协变量，可能会改变暴露的OR估计值。因此，流行病学家必须清楚地说明他们报告的是一个条件（调整）效应还是一个边际（粗略）效应。值得注意的是，当结局非常罕见时，OR约等于RR，而RR在无混杂时是可折叠的，因此在这种情况下，OR的不可折叠性效应会变得很小，调整与未调整的OR会非常接近 [@problem_id:4541697]。