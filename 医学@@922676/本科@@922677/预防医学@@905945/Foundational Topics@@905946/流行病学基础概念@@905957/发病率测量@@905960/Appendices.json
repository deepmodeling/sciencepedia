{"hands_on_practices": [{"introduction": "本练习将带领你通过一个基础计算来掌握发病衡量中的核心概念：风险 ([@problem_id:4547273])。你将在一个理想化的封闭队列中计算累积发病率，这是量化一个无病个体在特定时期内患病可能性的第一步，也为后续更复杂的分析奠定了坚实基础。", "problem": "一个卫生部门在基线时招募了一个由$5{,}000$名无病成年人组成的封闭队列，并对他们进行了为期$5$年的观察。在整个$5$年期间，该队列保持封闭且随访完整：没有个体进入或离开，没有失访，并且每个新发病例都被确认。在随访期间，恰好有$450$名个体首次被诊断出患有所研究的疾病。采用以下核心定义：在一个随访完整的封闭队列中，特定时期内的风险是指最初无病的个体在该时期内患病的概率，此概率在有限队列中通过观察期内成为新发病例的最初无病个体所占的比例来估计。请基于此定义，计算$5$年累积发病率，并将结果解释为该队列中一个最初无病的个体在$5$年期间的患病风险。将您的数值答案以小数比例形式表示，并四舍五入到四位有效数字。最终数值答案中无需单位。", "solution": "该问题要求计算和解释在一个封闭队列中特定时期内一种疾病的累积发病率。问题陈述中为随访完整的封闭队列中的风险提供的核心定义是，它通过观察期内成为新发（incident）病例的最初无病个体的比例来估计。这就是累积发病率（通常表示为 $CI$）的定义。\n\n累积发病率的公式是：\n$$CI = \\frac{\\text{特定时期内的新发病例数}}{\\text{观察期开始时的风险人口数}}$$\n\n让我们根据问题中提供的信息来定义变量：\n最初处于风险中的个体数量，即在研究开始时（基线时）无病的个体数量，为 $N_0$。\n$$N_0 = 5{,}000$$\n在$5$年随访期内出现的新发（incident）病例数为 $I$。\n$$I = 450$$\n随访期的持续时间为 $T = 5$ 年。\n\n问题指明了这是一个随访完整的封闭队列。这是一个关键条件。“封闭队列”意味着研究开始后没有新的个体加入。“随访完整”意味着所有参与研究的个体在期末都被追踪到，并且他们的患病状态是已知的。在这种理想化的情景中，最初的风险人群 $N_0$ 是适用于整个时期的正确分母。\n\n使用累积发病率的公式，我们可以代入给定的值：\n$$CI_{\\text{5-year}} = \\frac{450}{5{,}000}$$\n\n现在，我们进行计算：\n$$CI_{\\text{5-year}} = 0.09$$\n\n问题要求数值答案以小数比例形式表示，并四舍五入到四位有效数字。计算出的值恰好是 $0.09$。为了用四位有效数字表示，我们必须在后面添加零。第一个有效数字是 $9$。因此，我们将结果写为：\n$$CI_{\\text{5-year}} = 0.0900$$\n\n按要求对该结果的解释是，累积发病率代表了该队列中单个成员的平均风险。在$5$年研究期开始时无病的个体，在该$5$年期间患上该疾病的概率为 $0.0900$（或 $9.00\\%$ 的机会）。这量化了所研究人群在指定时间范围内成为新发病例的风险。", "answer": "$$\\boxed{0.0900}$$", "id": "4547273"}, {"introduction": "在公共卫生实践中，我们获得的患病率数据往往受到诊断试验不完美性的影响。本练习探讨了如何应对这一挑战 ([@problem_id:4547239])，你将学习如何利用诊断试验的灵敏度 ($Se$) 和特异度 ($Sp$) 来校正观察值，从而更准确地估计人群中真实的疾病负担。", "problem": "一项预防医学中的横断面筛查项目使用单一的二元诊断测试来测量被分类为某种慢性感染测试阳性的个体比例。观察到的阳性测试结果比例为 $\\hat{P}_{\\text{obs}}=0.12$。独立的验证研究报告该测试的灵敏度 $Se=0.85$ 和特异度 $Sp=0.95$。从灵敏度 ($Se=\\Pr(T=1\\mid D=1)$) 和特异度 ($Sp=\\Pr(T=0\\mid D=0)$) 的基本定义以及全概率定律出发，用真实患病率 $P=\\Pr(D=1)$ 和测试参数来表示观察到的阳性比例 $\\hat{P}_{\\text{obs}}$，然后通过代数求解 $P$ 以获得经过误分类校正的患病率估计值。使用所提供的值计算校正后的患病率，并将最终数值答案四舍五入至三位有效数字。将最终患病率以小数形式表示（不带百分号）。\n\n此外，根据 $Se$、$Sp$、$\\hat{P}_{\\text{obs}}$ 和 $P$ 之间的关系，简要说明确保校正后估计值具有科学意义的关键合理性约束条件。最终报告的答案必须是校正后患病率的单一数值。", "solution": "该问题陈述被评估为具有科学依据、提法恰当且客观。它提供了一套完整的数据和定义，用于推导和计算经误分类校正的患病率估计值，这是流行病学和生物统计学中的一个标准程序。所提供的灵敏度、特异度和观察到的阳性比例的数值是符合实际的。因此，该问题是有效的，将提供解答。\n\n设 $D$ 为一个二元随机变量，代表真实的疾病状态，其中 $D=1$ 表示存在慢性感染（患病），$D=0$ 表示不存在（未患病）。设 $T$ 为一个代表诊断测试结果的二元随机变量，其中 $T=1$ 是阳性测试，$T=0$ 是阴性测试。\n\n问题提供了以下量：\n- 观察到的阳性测试结果比例，即概率 $\\Pr(T=1)$ 的经验估计值。我们将其表示为 $\\hat{P}_{\\text{obs}} = 0.12$。\n- 测试灵敏度，$Se = \\Pr(T=1 \\mid D=1) = 0.85$。这是一个真正患病的个体测试结果为阳性的概率。\n- 测试特异度，$Sp = \\Pr(T=0 \\mid D=0) = 0.95$。这是一个真正未患病的个体测试结果为阴性的概率。\n\n待估计的量是真实患病率，$P = \\Pr(D=1)$。\n\n全概率定律允许我们通过以疾病状态为条件来表示阳性测试的概率 $\\Pr(T=1)$：\n$$\n\\Pr(T=1) = \\Pr(T=1 \\mid D=1)\\Pr(D=1) + \\Pr(T=1 \\mid D=0)\\Pr(D=0)\n$$\n我们可以将已知的定义代入这个方程。\n- $\\Pr(T=1)$ 是由 $\\hat{P}_{\\text{obs}}$ 估计的量。\n- $\\Pr(T=1 \\mid D=1)$ 是灵敏度 $Se$。\n- $\\Pr(D=1)$ 是真实患病率 $P$。\n- $\\Pr(D=0) = 1 - \\Pr(D=1) = 1-P$。\n- $\\Pr(T=1 \\mid D=0)$ 是假阳性率。它与特异度互补：$\\Pr(T=1 \\mid D=0) = 1 - \\Pr(T=0 \\mid D=0) = 1-Sp$。\n\n将这些项代入全概率定律，得到用真实患病率和测试参数表示的观察阳性比例的表达式：\n$$\n\\hat{P}_{\\text{obs}} = (Se \\cdot P) + ((1-Sp) \\cdot (1-P))\n$$\n这就是所要求的表达式。现在，我们必须通过代数方法解出 $P$。\n$$\n\\hat{P}_{\\text{obs}} = Se \\cdot P + (1-Sp) - P \\cdot (1-Sp)\n$$\n$$\n\\hat{P}_{\\text{obs}} = Se \\cdot P + 1 - Sp - P + Sp \\cdot P\n$$\n将含有 $P$ 的项组合在一起：\n$$\n\\hat{P}_{\\text{obs}} - (1-Sp) = P \\cdot (Se - 1 + Sp)\n$$\n分离出 $P$ 即可得到经误分类校正的患病率估计值的公式：\n$$\nP = \\frac{\\hat{P}_{\\text{obs}} - (1-Sp)}{Se + Sp - 1}\n$$\n这个公式通常被称为 Rogan-Gladen 估计量。\n\n在计算数值之前，我们先确定关键的合理性约束条件。为了使估计的患病率 $P$ 成为一个具有科学意义的概率，它必须位于区间 $[0, 1]$ 内。\n$1$. 分母 $Se+Sp-1$ 不能为零。$Se+Sp$ 的和是衡量测试总诊断准确性的指标。如果 $Se+Sp=1$，则该测试是无信息的（相当于随机猜测），无法从测试数据中确定患病率。一个有用的测试必须满足 $Se+Sp>1$。\n$2$. 假设是一个信息性测试，即 $Se+Sp-1 > 0$，那么条件 $P \\ge 0$ 要求分子为非负数：$\\hat{P}_{\\text{obs}} - (1-Sp) \\ge 0$，这意味着 $\\hat{P}_{\\text{obs}} \\ge 1-Sp$。观察到的阳性比例必须至少与假阳性率一样大。\n$3$. 条件 $P \\le 1$ 要求 $\\frac{\\hat{P}_{\\text{obs}} - (1-Sp)}{Se + Sp - 1} \\le 1$。这可以简化为 $\\hat{P}_{\\text{obs}} - 1 + Sp \\le Se + Sp - 1$，从而得出 $\\hat{P}_{\\text{obs}} \\le Se$。观察到的阳性比例不能超过灵敏度。\n总之，为了使校正后的估计值 $P$ 具有实际意义（$0 \\le P \\le 1$），观察数据必须满足 $1-Sp \\le \\hat{P}_{\\text{obs}} \\le Se$。\n\n现在，我们使用所提供的值计算校正后的患病率：\n$\\hat{P}_{\\text{obs}} = 0.12$\n$Se = 0.85$\n$Sp = 0.95$\n\n首先，检查约束条件：\n假阳性率为 $1-Sp = 1-0.95 = 0.05$。\n灵敏度为 $Se = 0.85$。\n所需条件为 $0.05 \\le 0.12 \\le 0.85$，该条件成立。因此，可以计算出一个介于 $0$ 和 $1$ 之间的有意义的患病率估计值。\n\n将这些值代入推导出的 $P$ 的公式中：\n$$\nP = \\frac{0.12 - (1-0.95)}{0.85 + 0.95 - 1}\n$$\n$$\nP = \\frac{0.12 - 0.05}{1.80 - 1}\n$$\n$$\nP = \\frac{0.07}{0.80}\n$$\n$$\nP = 0.0875\n$$\n问题要求答案四舍五入到三位有效数字。计算出的值 $0.0875$ 有三位有效数字（数字 $8$、$7$ 和 $5$）。因此，无需进一步四舍五入。\n校正后的患病率估计值为 $0.0875$。", "answer": "$$\n\\boxed{0.0875}\n$$", "id": "4547239"}, {"introduction": "公共卫生干预，特别是疾病筛查，可能会对疾病的衡量指标产生意想不到的影响。这个高级练习将引导你探讨过度诊断这一复杂现象 ([@problem_id:4547315])。通过量化筛查如何因检出非进展性病变而人为地推高发病率，本练习旨在培养你对筛查时代疾病数据进行批判性解读的能力。", "problem": "一个由 $N = 200{,}000$ 名成年人组成的封闭队列被观察一年。在时间 $t=0$ 时启动了一项针对某种慢性病的筛查项目，在年初提供一次筛查。该潜在的进展性疾病过程具有稳定的背景发病率 $\\lambda_{p} = 4$ 例/1000 人年（PY）。筛查开始时，队列中亚临床、非进展性病变的患病率为 $\\pi_{n} = 0.015$。队列中，筛查覆盖率为 $c = 0.90$ 的人群参加了筛查，筛查试验对检测这些亚临床、非进展性病变的灵敏度为 $s_{n} = 0.80$。根据定义，如果没有筛查，这些非进展性病变永远不会在临床上显现出来。\n\n使用发病率的基本定义，即发病率等于观察期间内新诊断的总病例数除以该期间内累积的总风险人时。为了在第一个筛查年进行人时核算，做出以下科学上的标准假设：\n- 进展性疾病事件在一年中均匀分布，因此每个进展性病例在诊断前平均贡献 $0.5$ 年的人时。\n- 筛查发现的非进展性病变个体在 $t=0$ 时被诊断，此后贡献的人时可忽略不计。\n- 该疾病足够罕见，可以忽略高阶修正（例如，单个个体的多次事件）。\n\n在有筛查的情况下，观察到的发病率的分子包括年内出现的进展性病例和参加筛查者中在 $t=0$ 时存在的、经筛查发现的亚临床非进展性病变。\n\n计算筛查启动后第一年的观察发病率 $I_{\\text{obs}}$（以例/1000人年表示），然后计算过度诊断膨胀因子 $F$，其定义为观察发病率与潜在进展性疾病发病率之比，$F = I_{\\text{obs}} / \\lambda_{p}$。仅报告 $F$ 的值。将最终答案四舍五入至四位有效数字。最终答案是无量纲的。", "solution": "### 问题验证\n在尝试任何解决方案之前，先对问题进行验证。\n\n#### 步骤 1：提取已知条件\n- 队列规模：$N = 200{,}000$ 名成年人\n- 观察期：$T=1$ 年\n- 筛查启动时间：$t=0$\n- 潜在进展性疾病发病率：$\\lambda_{p} = 4$ 例/1000 人年 (PY)\n- 亚临床非进展性病变患病率：$\\pi_{n} = 0.015$\n- 筛查覆盖率：$c = 0.90$\n- 筛查试验对非进展性病变的灵敏度：$s_{n} = 0.80$\n- 发病率定义：新诊断总数除以总风险人时。\n- 进展性病例的假设：均匀分布，平均贡献 $0.5$ 年的人时。\n- 筛查发现的非进展性病变的假设：在 $t=0$ 时诊断，贡献可忽略的人时（0年）。\n- 疾病罕见性假设：可以忽略高阶修正。\n- 观察发病率分子的定义：包括进展性病例和筛查发现的非进展性病变。\n- 任务：计算过度诊断膨胀因子 $F = I_{\\text{obs}} / \\lambda_{p}$，其中 $I_{\\text{obs}}$ 是以例/1000人年为单位的观察发病率。\n- 最终答案要求：报告 $F$ 并四舍五入至四位有效数字。\n\n#### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据：** 该问题使用了标准的流行病学概念，包括发病率、患病率、人时、筛查灵敏度和过度诊断。该模型虽然简化，却是对公共卫生和预防医学中常见情景的有效表述。\n- **适定性：** 提供了计算所需量的所有必要参数和定义。计算路径清晰，可获得唯一解。\n- **客观性：** 语言正式、精确，没有主观偏见。\n- **完整性与一致性：** 问题是自洽的，其假设是明确且相互一致的。“罕见病”假设为在适当情况下使用一阶近似（例如基于初始队列规模计算发病病例数）提供了理由。\n\n#### 步骤 3：结论与行动\n问题有效。将提供一个合理的解决方案。\n\n### 解题过程\n\n目标是计算过度诊断膨胀因子 $F$，其定义为观察发病率 $I_{\\text{obs}}$ 与潜在进展性疾病发病率 $\\lambda_p$ 之比。\n$$F = \\frac{I_{\\text{obs}}}{\\lambda_p}$$\n观察发病率 $I_{\\text{obs}}$ 定义为在为期一年的观察期内，新诊断的总病例数 $C_{\\text{total}}$ 除以总风险人时 $PT_{\\text{total}}$。\n$$I_{\\text{obs}} = \\frac{C_{\\text{total}}}{PT_{\\text{total}}}$$\n我们将首先计算分子 $C_{\\text{total}}$，然后计算分母 $PT_{\\text{total}}$。分析将在 $T=1$ 年的观察期内进行。\n\n**1. 分子计算：总诊断病例数 ($C_{\\text{total}}$)**\n总诊断病例数是两部分之和：\na) 新发进展性疾病病例数 $C_p$。\nb) 筛查发现的非进展性病变病例数 $C_n$。\n\na) 进展性病例数 $C_p$ 由潜在发病率 $\\lambda_p$ 作用于规模为 $N$ 的队列在 $T=1$ 年的时期内确定。\n发病率 $\\lambda_p$ 给定为 4 例/1000 人年，相当于 $\\lambda_p = 0.004$ PY$^{-1}$。\n$$C_p = N \\times \\lambda_p \\times T = 200{,}000 \\times 0.004 \\text{ year}^{-1} \\times 1 \\text{ year} = 800 \\text{ 例}$$\n\nb) 筛查发现的非进展性病例数 $C_n$ 通过考虑参加筛查且患有非进展性病变的亚群，然后应用试验的灵敏度来计算。\n- 参加筛查的个体数量：$N \\times c = 200{,}000 \\times 0.90 = 180{,}000$。\n- 参加筛查者中患有非进展性病变的个体数量（假设患病率均匀分布）：$(N \\times c) \\times \\pi_n = 180{,}000 \\times 0.015 = 2,700$。\n- 经筛查检测出的这些病变数量（应用灵敏度 $s_n$）：\n$$C_n = (N \\times c \\times \\pi_n) \\times s_n = 2{,}700 \\times 0.80 = 2,160 \\text{ 例}$$\n\n总诊断病例数是这两个部分的总和：\n$$C_{\\text{total}} = C_p + C_n = 800 + 2,160 = 2,960 \\text{ 例}$$\n\n**2. 分母计算：总风险人时 ($PT_{\\text{total}}$)**\n总风险人时以整个队列规模乘以一年时长开始计算，然后减去被诊断个体未累积的人时。\n- 初始潜在人时：$PT_{\\text{potential}} = N \\times T = 200{,}000 \\times 1 \\text{ year} = 200{,}000$ 人年。\n\n我们减去两组病例因诊断而损失的人时：\na) 对于 $C_p = 800$ 例进展性病例，假设他们在全年均匀诊断，平均贡献 $0.5$ 年的人时。因此，相对于一整年，每个病例损失了 $1 - 0.5 = 0.5$ 年的人时。\n- 进展性病例损失的人时：$PT_{\\text{lost,p}} = C_p \\times (1 - 0.5) \\text{ years} = 800 \\times 0.5 = 400$ 人年。\n\nb) 对于 $C_n = 2,160$ 例筛查发现的非进展性病例，假设他们在 $t=0$ 时被诊断，贡献可忽略（0）的人时。因此，每个病例损失了 $1 - 0 = 1$ 年的人时。\n- 非进展性病例损失的人时：$PT_{\\text{lost,n}} = C_n \\times 1 \\text{ year} = 2,160 \\times 1 = 2,160$ 人年。\n\n总风险人时是潜在人时减去损失的人时：\n$$PT_{\\text{total}} = PT_{\\text{potential}} - PT_{\\text{lost,p}} - PT_{\\text{lost,n}} = 200{,}000 - 400 - 2,160 = 197,440 \\text{ 人年}$$\n\n**3. 过度诊断膨胀因子 ($F$) 的计算**\n首先，我们计算观察发病率 $I_{\\text{obs}}$，单位为病例/人年。\n$$I_{\\text{obs}} = \\frac{C_{\\text{total}}}{PT_{\\text{total}}} = \\frac{2,960}{197,440} \\text{ 人年}^{-1}$$\n膨胀因子 $F$ 是该观察发病率与潜在发病率 $\\lambda_p = 0.004$ 人年$^{-1}$ 的比值。\n$$F = \\frac{I_{\\text{obs}}}{\\lambda_p} = \\frac{2,960 / 197,440}{0.004} = \\frac{2,960}{197,440 \\times 0.004} = \\frac{2,960}{789.76}$$\n$$F \\approx 3.747974067...$$\n\n作为一种替代的符号推导，这表明结果与 $N$ 无关：\n对于 $T=1$ 年：\n$$I_{\\text{obs}} = \\frac{N(\\lambda_p + c \\pi_n s_n)}{N(1 - 0.5\\lambda_p - c \\pi_n s_n)} = \\frac{\\lambda_p + c \\pi_n s_n}{1 - 0.5\\lambda_p - c \\pi_n s_n}$$\n那么 $F$ 是：\n$$F = \\frac{I_{\\text{obs}}}{\\lambda_p} = \\frac{1}{\\lambda_p} \\left( \\frac{\\lambda_p + c \\pi_n s_n}{1 - 0.5\\lambda_p - c \\pi_n s_n} \\right)$$\n代入数值：\n$\\lambda_p = 0.004$\n$c = 0.90$\n$\\pi_n = 0.015$\n$s_n = 0.80$\n$$F = \\frac{1}{0.004} \\left( \\frac{0.004 + (0.90)(0.015)(0.80)}{1 - 0.5(0.004) - (0.90)(0.015)(0.80)} \\right)$$\n$$F = \\frac{1}{0.004} \\left( \\frac{0.004 + 0.0108}{1 - 0.002 - 0.0108} \\right) = \\frac{1}{0.004} \\left( \\frac{0.0148}{0.9872} \\right)$$\n$$F \\approx \\frac{3.7}{0.9872} \\approx 3.747974067...$$\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$F \\approx 3.748$$", "answer": "$$\\boxed{3.748}$$", "id": "4547315"}]}