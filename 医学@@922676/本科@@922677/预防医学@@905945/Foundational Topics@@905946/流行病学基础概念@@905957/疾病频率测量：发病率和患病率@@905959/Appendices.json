{"hands_on_practices": [{"introduction": "本练习提供了计算队列研究中发病率的基础实践。您将学习如何使用人时法计算点估计值，并使用泊松精确置信区间来量化其不确定性，这些都是任何前瞻性研究的核心技能。[@problem_id:4547023]", "problem": "一项预防医学的前瞻性队列研究招募了四名参与者，以基于风险人时来量化作为发病率的疾病发生情况。每位参与者从进入队列开始被随访，直至其首次事件发生或删失，得出的随访时间分别为 $1.2$、$0.8$、$2.0$ 和 $0.5$ 年。在这些随访期间，共观察到 $3$ 次首次事件。假设首次事件的发生是一个与罕见事件的泊松模型相符的计数过程，并且发病率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发病率的点估计值，单位为“事件/人-年”。\n- 计算 $95\\%$ 的泊松精确置信区间（首次事件率/人-年），该区间通过对观察到的人时内总事件数的泊松计数模型进行反演得到。\n\n报告您的最终数值结果，单位为“事件/人-年”，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数字按（点估计值，下限，上限）的顺序以单行向量的形式呈现。最终答案中不应使用百分号；所有量均以小数表示。", "solution": "用户希望我解决以下问题：\n 一项预防医学的前瞻性队列研究招募了四名参与者，以基于风险人时来量化作为发病率的疾病发生情况。每位参与者从进入队列开始被随访，直至其首次事件发生或删失，得出的随访时间分别为 $1.2$、$0.8$、$2.0$ 和 $0.5$ 年。在这些随访期间，共观察到 $3$ 次首次事件。假设首次事件的发生是一个与罕见事件的泊松模型相符的计数过程，并且发病率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发病率的点估计值，单位为“事件/人-年”。\n- 计算 $95\\%$ 的泊松精确置信区间（首次事件率/人-年），该区间通过对观察到的人时内总事件数的泊松计数模型进行反演得到。\n\n报告您的最终数值结果，单位为“事件/人-年”，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数字按（点估计值，下限，上限）的顺序以单行向量的形式呈现。最终答案中不应使用百分号；所有量均以小数表示。\n\n### 第1步：提取已知信息\n- 参与者人数：$4$\n- 个体随访时间：$1.2$ 年，$0.8$ 年，$2.0$ 年，$0.5$ 年。\n- 观察到的首次事件总数，$d$：$3$。\n- 统计模型：泊松过程。\n- 置信区间的置信水平：$95\\%$。\n- 要求四舍五入：四位有效数字。\n- 要求输出格式：（点估计值，下限，上限）的行向量。\n\n### 第2步：使用提取的已知信息进行验证\n该问题具有科学依据，提法明确且客观。它描述了根据队列研究数据计算发病率及其置信区间的标准流行病学方法。在这种情况下，使用人时和泊松模型是标准做法。所有必要的数据都已提供，且没有矛盾之处。该问题不违反任何无效性标准。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n该问题要求计算一个发病率的点估计值和一个 $95\\%$ 的精确置信区间。\n\n#### 第1部分：发病率的点估计\n\n发病率（用 $\\lambda$ 表示）定义为每单位风险人时内的新发事件数。点估计值 $\\hat{\\lambda}$ 的计算方法是：观察到的事件总数 $d$ 除以总风险人时 $PT$。\n\n首先，我们通过将所有参与者的随访时间相加来计算总风险人时：\n$$\nPT = 1.2 \\text{ years} + 0.8 \\text{ years} + 2.0 \\text{ years} + 0.5 \\text{ years}\n$$\n$$\nPT = 4.5 \\text{ person-years}\n$$\n\n观察到的事件数已知为 $d = 3$。\n\n那么，发病率的点估计值为：\n$$\n\\hat{\\lambda} = \\frac{d}{PT} = \\frac{3}{4.5} = \\frac{2}{3} \\text{ events per person-year}\n$$\n将其转换为小数，我们得到：\n$$\n\\hat{\\lambda} \\approx 0.666666... \\text{ events per person-year}\n$$\n\n#### 第2部分：发病率的95%精确置信区间\n\n问题指明事件数遵循泊松分布。总事件数 $d=3$ 是来自均值为 $\\mu$ 的泊松分布的单个观测值。均值 $\\mu$ 通过方程 $\\mu = \\lambda \\times PT$ 与发病率 $\\lambda$ 和总人时 $PT$ 相关联。\n\n为了求出率 $\\lambda$ 的置信区间，我们首先计算均值计数 $\\mu$ 的置信区间，然后将其上下限除以 $PT$。\n\n给定观测计数 $d$ 时，泊松均值 $\\mu$ 的精确置信区间基于泊松分布和卡方（$\\chi^2$）分布之间的关系。对于一个 $(1-\\alpha) \\times 100\\%$ 的置信区间，均值 $\\mu$ 的下限 $\\mu_L$ 和上限 $\\mu_U$ 由以下公式给出：\n$$\n\\mu_L = \\frac{1}{2} \\chi^2_{\\alpha/2, 2d}\n$$\n$$\n\\mu_U = \\frac{1}{2} \\chi^2_{1-\\alpha/2, 2(d+1)}\n$$\n其中 $\\chi^2_{p, \\nu}$ 是自由度为 $\\nu$、累积概率为 $p$ 的卡方分布的分位数。\n\n对于 $95\\%$ 的置信区间，$1-\\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。\n观察到的事件数为 $d=3$。\n\n下限的自由度是 $2d = 2 \\times 3 = 6$。\n上限的自由度是 $2(d+1) = 2 \\times (3+1) = 8$。\n\n我们需要以下卡方分位数：\n- 对于下限：$\\chi^2_{\\alpha/2, 2d} = \\chi^2_{0.025, 6}$\n- 对于上限：$\\chi^2_{1-\\alpha/2, 2(d+1)} = \\chi^2_{0.975, 8}$\n\n使用统计表或软件，我们找到这些值：\n$$\n\\chi^2_{0.025, 6} \\approx 1.237344\n$$\n$$\n\\chi^2_{0.975, 8} \\approx 17.534546\n$$\n\n现在，我们可以计算均值计数 $\\mu$ 的置信限：\n$$\n\\mu_L = \\frac{1}{2} \\times 1.237344 = 0.618672\n$$\n$$\n\\mu_U = \\frac{1}{2} \\times 17.534546 = 8.767273\n$$\n这些是在 $4.5$ 人-年内预期事件数的下限和上限。\n\n为了求出发病率 $\\lambda$ 的置信区间，我们将这些限值除以总人时 $PT = 4.5$ 人-年。\n$$\n\\lambda_L = \\frac{\\mu_L}{PT} = \\frac{0.618672}{4.5} \\approx 0.1374827 \\text{ events per person-year}\n$$\n$$\n\\lambda_U = \\frac{\\mu_U}{PT} = \\frac{8.767273}{4.5} \\approx 1.9482829 \\text{ events per person-year}\n$$\n\n#### 第3部分：最终结果与四舍五入\n\n问题要求将点估计值、下限和上限四舍五入到四位有效数字。\n\n- 点估计值：$\\hat{\\lambda} \\approx 0.666666... \\to 0.6667$\n- 置信下限：$\\lambda_L \\approx 0.1374827... \\to 0.1375$\n- 置信上限：$\\lambda_U \\approx 1.9482829... \\to 1.948$\n\n最终结果是有序三元组 $(\\hat{\\lambda}, \\lambda_L, \\lambda_U)$。\n这三个值是 $(0.6667, 0.1375, 1.948)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6667  0.1375  1.948\n\\end{pmatrix}\n}\n$$", "id": "4547023"}, {"introduction": "在比较不同人群的疾病率时，由于年龄等潜在人口结构上的差异，粗率可能会产生误导。本练习将介绍直接标化法，这是一个关键工具，通过计算研究人群在具有与标准人群相同年龄结构的情况下的发病率，来创建公平的比较。[@problem_id:4546940]", "problem": "某市卫生部门正在评估一项针对某种慢性病的新型筛查项目。他们将哈伯市（Harbor City）在单次监测年度内的发病率，与假设哈伯市具有参考人群年龄结构时所预期的发病率进行比较。在为期 $1$ 年的监测期内，哈伯市记录了四个互斥年龄分层中的发病病例和累积风险人时，具体如下：\n- 年龄组 $0$–$19$ 岁：$120{,}000$ 人年内出现 $60$ 例新发病例。\n- 年龄组 $20$–$49$ 岁：$180{,}000$ 人年内出现 $450$ 例新发病例。\n- 年龄组 $50$–$79$ 岁：$90{,}000$ 人年内出现 $600$ 例新发病例。\n- 年龄组 $\\geq 80$ 岁：$15{,}000$ 人年内出现 $150$ 例新发病例。\n\n用于直接标准化的一个假设标准人群，在同一个 $1$ 年期间内，包含以下各年龄特定的人年数：\n- 年龄组 $0$–$19$ 岁：$30{,}000$ 人年。\n- 年龄组 $20$–$49$ 岁：$40{,}000$ 人年。\n- 年龄组 $50$–$79$ 岁：$25{,}000$ 人年。\n- 年龄组 $\\geq 80$ 岁：$5{,}000$ 人年。\n\n仅使用发病率和直接标准化的基本定义，计算哈伯市针对该疾病相对于给定标准人群的直接标化发病率，并从概念上解释其为何与在哈伯市观察到的粗（总）发病率不同。将最终的标化发病率以每 $1{,}000$ 人年表示，并将答案四舍五入至四位有效数字。除标化率指定的单位外，不提供其他额外单位。", "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于流行病学原理，内容自洽，提问明确且客观。计算直接标化发病率所需的所有数据均已提供。\n\n主要目标是计算哈伯市的直接标化发病率。此过程消除了年龄结构的混杂效应，从而可以在具有不同年龄分布的人群之间进行更公平的发病率比较。该方法涉及将研究人群（哈伯市）的年龄别发病率应用于参考或标准人群的年龄结构。\n\n设年龄分层由 $i \\in \\{1, 2, 3, 4\\}$ 索引，分别对应年龄组 $0$–$19$ 岁、$20$–$49$ 岁、$50$–$79$ 岁和 $\\geq 80$ 岁。\n\n首先，我们计算哈伯市的年龄别发病率（$ASIR_i$）。发病率定义为每个分层中的新发病例数（$C_i$）除以总风险人时（$PT_i$）。\n\n哈伯市的给定数据如下：\n- 分层 $1$：$C_1=60$ 病例, $PT_1=120,000$ 人年\n- 分层 $2$：$C_2=450$ 病例, $PT_2=180,000$ 人年\n- 分层 $3$：$C_3=600$ 病例, $PT_3=90,000$ 人年\n- 分层 $4$：$C_4=150$ 病例, $PT_4=15,000$ 人年\n\n年龄别发病率如下：\n$$ ASIR_1 = \\frac{C_1}{PT_1} = \\frac{60}{120,000} = 0.0005 $$\n$$ ASIR_2 = \\frac{C_2}{PT_2} = \\frac{450}{180,000} = 0.0025 $$\n$$ ASIR_3 = \\frac{C_3}{PT_3} = \\frac{600}{90,000} = \\frac{1}{150} \\approx 0.006667 $$\n$$ ASIR_4 = \\frac{C_4}{PT_4} = \\frac{150}{15,000} = 0.01 $$\n\n接下来，我们使用标准人群的人时数据。设 $PT_{S,i}$ 表示标准人群中分层 $i$ 的人年数。\n- $PT_{S,1} = 30,000$ 人年\n- $PT_{S,2} = 40,000$ 人年\n- $PT_{S,3} = 25,000$ 人年\n- $PT_{S,4} = 5,000$ 人年\n\n标准人群的总人时为：\n$$ PT_S = \\sum_{i=1}^{4} PT_{S,i} = 30,000 + 40,000 + 25,000 + 5,000 = 100,000 \\text{ 人年} $$\n\n为了求出直接标化率，我们首先计算如果标准人群经历了哈伯市的年龄别发病率，其每个分层中预期会出现的病例数。设 $E_i$ 为分层 $i$ 中的预期病例数。\n$$ E_i = ASIR_i \\times PT_{S,i} $$\n- 分层 $1$ 的预期病例数：$E_1 = 0.0005 \\times 30,000 = 15$\n- 分层 $2$ 的预期病例数：$E_2 = 0.0025 \\times 40,000 = 100$\n- 分层 $3$ 的预期病例数：$E_3 = \\frac{1}{150} \\times 25,000 = \\frac{2500}{15} = \\frac{500}{3}$\n- 分层 $4$ 的预期病例数：$E_4 = 0.01 \\times 5,000 = 50$\n\n预期总病例数 $E_{total}$ 是所有分层预期病例数的总和：\n$$ E_{total} = \\sum_{i=1}^{4} E_i = 15 + 100 + \\frac{500}{3} + 50 = 165 + \\frac{500}{3} = \\frac{495 + 500}{3} = \\frac{995}{3} $$\n\n直接标化发病率（$DSIR$）是预期总病例数除以标准人群的总人时。\n$$ DSIR = \\frac{E_{total}}{PT_S} = \\frac{995/3}{100,000} = \\frac{995}{300,000} $$\n\n问题要求将发病率以每 $1,000$ 人年表示。因此，我们将 $DSIR$ 乘以 $1,000$：\n$$ \\text{每 } 1,000 \\text{ 人年的发病率} = DSIR \\times 1,000 = \\frac{995}{300,000} \\times 1,000 = \\frac{995}{300} = \\frac{199}{60} \\approx 3.31666... $$\n四舍五入至四位有效数字，标化率为每 $1,000$ 人年 $3.317$。\n\n从概念上讲，这个标化率与哈伯市的粗（总）发病率不同，因为这两个率是相同年龄别发病率的加权平均值，但它们使用了不同的权重集。\n\n哈伯市的粗发病率计算如下：\n$$ \\text{粗率}_{HC} = \\frac{\\text{总病例数}_{HC}}{\\text{总人时}_{HC}} = \\frac{60+450+600+150}{120,000+180,000+90,000+15,000} = \\frac{1,260}{405,000} $$\n每 $1,000$ 人年的粗发病率为 $\\frac{1,260}{405,000} \\times 1,000 = \\frac{1,260}{405} \\approx 3.111$ 每 $1,000$ 人年。\n\n粗率是年龄别发病率的加权平均值，其中权重是哈伯市内各年龄组人时所占的比例：\n$ \\text{粗率}_{HC} = \\sum_{i=1}^{4} ASIR_i \\times \\frac{PT_i}{PT_{HC, total}} $。\n\n标化率也是相同 $ASIR_i$ 的加权平均值，但权重是来自标准人群的人时比例：\n$ DSIR = \\sum_{i=1}^{4} ASIR_i \\times \\frac{PT_{S,i}}{PT_S} $。\n\n粗率（$3.111$）与标化率（$3.317$）之间的差异，是由于哈伯市和标准人群的年龄结构不同，且该疾病的发病率与年龄密切相关（这一现象称为年龄混杂）。高年龄组的发病率（$ASIR_3$ 和 $ASIR_4$）远高于低年龄组（$ASIR_1$ 和 $ASIR_2$）。标准人群的年龄结构比哈伯市略为偏老（例如，$50$岁以上人群的人时比例在标准人群中为 ($25,000+5,000)/100,000 = 30\\%$，而在哈伯市约为 ($90,000+15,000)/405,000 \\approx 25.9\\%$）。通过将哈伯市的高年龄别发病率应用于标准人群较老的年龄结构，我们得到了一个更高的总发病率。这个标化率代表了如果哈伯市具有与标准人群相同的年龄结构时将会观察到的发病率，从而提供了一个不受年龄混杂效应影响的比较基础。", "answer": "$$ \\boxed{3.317} $$", "id": "4546940"}, {"introduction": "发病率和患病率为了解疾病负担提供了不同但相关的视角。本练习探讨了它们之间的动态相互作用，表明稳定的患病率并不一定意味着发病率也稳定。通过一个假设情景，您将应用连接患病率、发病率和平均病程的基本关系，从而更深入地理解人群中的疾病动态。[@problem_id:4547040]", "problem": "一个城市的卫生部门针对一种慢性复发性感染病引入了强化的病例发现措施。该疾病被建模为一个易感-感染-易感（SIS）过程，其中个体在健康状态和患病状态之间循环。在一段时间内，人口规模近似恒定，且该疾病的死亡率可忽略不计，观察到以下情况：病例检出率增加，使得发病率（每易感者人时的新发病例瞬时率）从 $\\lambda_{0} = 0.025$ 每人年上升到 $\\lambda_{1} = 0.050$ 每人年。同时，一种新的疗法缩短了疾病发作的平均持续时间。在年中进行的横断面调查中，发现时点患病率（在特定时间点人口中的患病比例）保持稳定。\n\n假设在所考虑的区间内风险是恒定的，并且康复后个体立即返回易感状态。仅使用时点患病率、发病率和平均病程的核心定义，以及稳态条件下健康状态和患病状态之间的流守恒论证，首先推导出联系此时点患病率 $p$、发病率 $\\lambda$ 和平均病程 $D$ 的稳态表达式。然后，给定基线平均病程 $D_{0} = 2$ 年和干预后发病率 $\\lambda_{1} = 0.050$ 每人年，计算为保持时点患病率与由 $\\lambda_{0}$ 和 $D_{0}$ 所隐含的基线值不变所需的干预后平均病程 $D_{1}$（以年为单位）。用年表示你的最终数值答案，并四舍五入到四位有效数字。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 第一步：提取已知条件\n-   **模型**：易感-感染-易感（SIS）过程。\n-   **人口**：规模近似恒定，与疾病相关的死亡率可忽略不计。\n-   **基线发病率**：$\\lambda_{0} = 0.025$ 每人年。\n-   **干预后发病率**：$\\lambda_{1} = 0.050$ 每人年。\n-   **基线平均病程**：$D_{0} = 2$ 年。\n-   **条件**：时点患病率稳定，意味着基线患病率（$p_0$）等于干预后患病率（$p_1$）。\n-   **假设**：风险恒定；康复后个体立即返回易感状态。\n-   **任务1（推导）**：推导联系时点患病率 $p$、发病率 $\\lambda$ 和平均病程 $D$ 的稳态表达式。\n-   **任务2（计算）**：计算干预后平均病程 $D_{1}$，以维持患病率不变。\n-   **输出格式**：以年为单位的数值答案，四舍五入到四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n根据既定的验证标准对问题进行评估。\n\n-   **科学依据**：该问题基于标准的SIS房室模型，这是数学流行病学中的一个基本概念。关键指标——发病率（$\\lambda$）、时点患病率（$p$）和平均病程（$D$）——是流行病学中的核心定义。使用流守恒论证来建立稳态关系是一种标准且有效的方法。该问题在科学上是合理的。\n-   **适定性**：问题陈述清晰，包含执行所需推导和后续计算的所有必要信息。一旦推导出来，变量之间的关系允许从给定数量中唯一确定未知变量 $D_1$。\n-   **客观性**：问题使用精确、定量和无偏见的语言陈述。数据和条件是客观的，没有主观解释的余地。\n-   **完整性与一致性**：问题是自洽的。所提供的数据（$\\lambda_0$, $\\lambda_1$, $D_0$）和条件（$p_0 = p_1$）是一致的，足以求解。\n-   **现实性**：发病率和病程的数值对于一种慢性、非致命性传染病是合理的。\n\n### 第三步：结论与行动\n该问题是**有效的**。它在科学上合理，适定，客观，并包含足够的信息以获得唯一解。可以进行求解过程。\n\n### 解题过程\n\n问题首先要求我们推导在稳态条件下，一个易感-感染-易感（SIS）模型中时点患病率（$p$）、发病率（$\\lambda$）和平均病程（$D$）之间的关系，然后利用这个关系来计算新的平均病程（$D_1$）。\n\n设 $N$ 为总人口数，假定其为常数。人口被分为两个房室：易感者（$S$）和感染者（$I$）。根据定义，$S + I = N$。\n\n时点患病率 $p$ 是在特定时间点人口中感染者的比例。\n$$p = \\frac{I}{N}$$\n由此，感染者人数为 $I = pN$。因此，易感者人数为 $S = N - I = N - pN = N(1-p)$。\n\n发病率 $\\lambda$ 定义为每单位时间每易感者的新发病例率。因此，单位时间内新发感染总数是发病率与易感人群规模的乘积：\n$$ \\text{感染速率} = \\lambda S = \\lambda N(1-p) $$\n\n平均病程为 $D$。康复率 $\\gamma$ 是平均病程的倒数，即 $\\gamma = \\frac{1}{D}$。这代表感染者康复并返回易感状态的速率。单位时间内康复总数是康复率与感染人群规模的乘积：\n$$ \\text{康复速率} = \\gamma I = \\frac{1}{D} I = \\frac{pN}{D} $$\n\n问题指明了“稳态条件”。在稳态下，每个房室中的个体数量保持不变。这要求流入感染房室的速率（感染速率）必须等于流出感染房室的速率（康复速率）。\n$$ \\text{感染速率} = \\text{康复速率} $$\n$$ \\lambda S = \\gamma I $$\n\n代入 $S$、$I$ 和 $\\gamma$ 的表达式，得到：\n$$ \\lambda N(1-p) = \\frac{pN}{D} $$\n总人口数 $N$ 不为零，可从等式两边消去，从而得到患病率 $p$、发病率 $\\lambda$ 和平均病程 $D$ 之间的基本关系：\n$$ \\lambda (1-p) = \\frac{p}{D} $$\n此表达式完成了问题的第一部分。这个方程可以重新整理以求解患病率 $p$：\n$$ \\lambda D (1-p) = p $$\n$$ \\lambda D - \\lambda D p = p $$\n$$ \\lambda D = p (1 + \\lambda D) $$\n$$ p = \\frac{\\lambda D}{1 + \\lambda D} $$\n另一个有用的重排形式直接用 $\\lambda$ 和 $D$ 表示患病率比值 $\\frac{p}{1-p}$：\n$$ \\frac{p}{1-p} = \\lambda D $$\n\n现在，对于问题的第二部分，我们将此关系应用于两种情景：基线（下标为0）和干预后（下标为1）。\n给定的信息是：\n-   基线：$\\lambda_{0} = 0.025$ 每人年, $D_{0} = 2$ 年。\n-   干预后：$\\lambda_{1} = 0.050$ 每人年。\n核心条件是时点患病率保持稳定，即 $p_{0} = p_{1}$。\n\n使用推导出的患病率比值关系，我们有：\n对于基线情景：\n$$ \\frac{p_{0}}{1-p_{0}} = \\lambda_{0} D_{0} $$\n对于干预后情景：\n$$ \\frac{p_{1}}{1-p_{1}} = \\lambda_{1} D_{1} $$\n由于 $p_{0} = p_{1}$，直接可得，它们的患病率比值也必定相等：\n$$ \\frac{p_{0}}{1-p_{0}} = \\frac{p_{1}}{1-p_{1}} $$\n因此，我们可以令两个方程的右边相等：\n$$ \\lambda_{0} D_{0} = \\lambda_{1} D_{1} $$\n我们需要计算干预后的平均病程 $D_{1}$。我们可以用代数方法解出 $D_{1}$：\n$$ D_{1} = \\frac{\\lambda_{0} D_{0}}{\\lambda_{1}} $$\n现在，代入给定的数值：\n$$ D_{1} = \\frac{(0.025 \\text{ 年}^{-1}) \\times (2 \\text{ 年})}{0.050 \\text{ 年}^{-1}} $$\n$$ D_{1} = \\frac{0.050 \\text{ 年}}{0.050} $$\n$$ D_{1} = 1 \\text{ 年} $$\n问题要求答案保留四位有效数字。精确答案是 $1$。用四位有效数字表示为 $1.000$。\n尽管发病率翻倍，干预后的平均病程必须为 $1.000$ 年，才能保持时点患病率稳定。", "answer": "$$\\boxed{1.000}$$", "id": "4547040"}]}