{"hands_on_practices": [{"introduction": "学习健康不平等的首要步骤是学会如何量化它。本练习将带你使用公共卫生领域的典型汇总数据——年龄标化死亡率，来计算衡量差距的两个最基本指标：绝对梯度和相对梯度。通过这个练习，你将能够清晰地量化最弱势和最优势社会群体之间的健康差距，这是理解和应对社会健康阶梯的第一步。[@problem_id:4577111]", "problem": "在一项都市队列研究中，研究人员使用公认的标准人口进行年龄标准化，估算了社会经济地位 (SES) 五分位数组在5年期间内每$100{,}000$人年的年龄标准化全因死亡率，其中$Q_{1}$表示社会经济地位最低的群体，$Q_{5}$表示社会经济地位最高的群体。观察到的死亡率为：$Q_{1}: 934.7$, $Q_{2}: 811.3$, $Q_{3}: 706.5$, $Q_{4}: 623.9$, $Q_{5}: 571.9$ (死亡数/每$100{,}000$人年)。\n\n从核心的流行病学测量原则（即率定义为每人时事件数）以及社会流行病学中通过比较分布极端值来总结社会经济地位-健康梯度的标准做法出发，计算$Q_{1}$和$Q_{5}$之间的绝对SES死亡率梯度和相对SES死亡率梯度。然后，就人口健康差异方面对这两个量进行简要解释。\n\n以行矩阵的形式提供最终数值答案，顺序为：[绝对梯度, 相对梯度]。将每个量四舍五入到4位有效数字。绝对梯度以每$100{,}000$人年的死亡数表示，相对梯度表示为无单位小数。在加框的最终答案中不要包含任何单位。", "solution": "用户提供了一个来自预防医学领域的问题，具体涉及社会流行病学，并要求计算和解释社会经济健康梯度。\n\n首先，我将验证问题陈述。\n\n### 第1步：提取已知信息\n- **研究类型**：都市队列研究。\n- **标准化**：年龄标准化率。\n- **结局**：全因死亡率。\n- **随访期**：$5$年。\n- **测量单位**：死亡数/每$100{,}000$人年。\n- **暴露变量**：社会经济地位 (SES)，分为五分位数组。\n- **五分位数定义**：$Q_{1}$是社会经济地位最低的群体；$Q_{5}$是社会经济地位最高的群体。\n- **观察到的年龄标准化死亡率 (每$100{,}000$人年)**：\n  - $Q_{1}$的率：$934.7$\n  - $Q_{2}$的率：$811.3$\n  - $Q_{3}$的率：$706.5$\n  - $Q_{4}$的率：$623.9$\n  - $Q_{5}$的率：$571.9$\n- **任务**：\n  1. 计算$Q_{1}$和$Q_{5}$之间的绝对SES死亡率梯度。\n  2. 计算$Q_{1}$和$Q_{5}$之间的相对SES死亡率梯度。\n  3. 对这两个量进行简要解释。\n  4. 以行矩阵形式提供最终数值答案，并四舍五入到4位有效数字。\n\n### 第2步：使用提取的已知信息进行验证\n- **科学依据**：该问题在流行病学和公共卫生原则方面有充分的依据。健康方面的社会经济地位梯度概念、年龄标准化死亡率的使用、人时分母以及社会经济地位五分位数都是该领域的标准且有效的方法论。所提供的数据显示死亡率随贫困程度的增加而单调增加，这与大量科学文献相符。\n- **提法恰当**：该问题提法恰当。它提供了计算所需的所有必要数据和明确的定义。要求通过对比极端五分位数（$Q_{1}$和$Q_{5}$）来计算绝对和相对梯度，是社会流行病学中一种标准且明确的分析方法。\n- **客观性**：该问题是客观、定量的，不含主观或基于观点的陈述。\n\n### 第3步：结论与行动\n该问题是有效的。它科学合理、提法恰当且客观。没有矛盾、信息缺失或逻辑谬误。我现在将着手解决问题。\n\n### 解决方案\n\n该问题要求计算两个基本的健康不平等衡量指标：绝对梯度和相对梯度。这些指标用于量化不同社会经济群体之间健康差异的大小。问题指定比较两个极端的五分位数，$Q_{1}$（最贫困）和$Q_{5}$（最不贫困），这是总结整体梯度的常用做法。\n\n设 $R_{i}$ 表示五分位数 $Q_{i}$ 的年龄标准化死亡率。我们关注的给定率为：\n- $R_1 = 934.7$ 死亡数/每$100{,}000$人年。\n- $R_5 = 571.9$ 死亡数/每$100{,}000$人年。\n\n**1. 绝对SES死亡率梯度**\n\n绝对梯度，在其他情况下也称为率差 (RD) 或绝对风险降低，是两组率之间的算术差。它衡量了较贫困群体比较不贫困群体多出的健康事件（在此例中为死亡）数量。\n\n五分位数 $Q_{1}$ 和 $Q_{5}$ 之间绝对梯度 $G_{A}$ 的计算公式为：\n$$ G_{A} = R_1 - R_5 $$\n代入给定值：\n$$ G_{A} = 934.7 - 571.9 = 362.8 $$\n绝对梯度的单位与率的单位相同，即死亡数/每$100{,}000$人年。数值 $362.8$ 有四位有效数字，因此无需进一步四舍五入。\n\n**2. 相对SES死亡率梯度**\n\n相对梯度，通常也称为率比 (RR) 或相对风险，是两组率的比值。它通过量化较贫困群体中发生健康事件的可能性比较不贫困群体高多少倍来衡量关联的强度。\n\n五分位数 $Q_{1}$ 和 $Q_{5}$ 之间相对梯度 $G_{R}$ 的计算公式为：\n$$ G_{R} = \\frac{R_1}{R_5} $$\n代入给定值：\n$$ G_{R} = \\frac{934.7}{571.9} \\approx 1.634376639... $$\n问题要求四舍五入到4位有效数字。\n$$ G_{R} \\approx 1.634 $$\n相对梯度是一个无量纲的量。\n\n**3. 梯度的解释**\n\n- **绝对梯度的解释 ($G_{A} = 362.8$ 死亡数/每$100{,}000$人年)**：该值表示与最不贫困的社会经济五分位数相比，处于最贫困的社会经济五分位数所带来的超额死亡率。可以这样解释：在一年期间，如果$Q_{1}$五分位数群体的死亡率与$Q_{5}$五分位数相同，那么每$100{,}000$人中，实际死亡人数比预期多出约$363$人。从公共卫生的角度来看，如果消除了健康结果中的社会经济不平等，这部分死亡率是可能被预防的绝对负担。它凸显了问题的严重程度。\n\n- **相对梯度的解释 ($G_{R} \\approx 1.634$)**：该值表示差异的乘法幅度。可以这样解释：在对年龄进行调整后，最贫困五分位数（$Q_{1}$）个体的死亡率是最不贫困五分位数（$Q_{5}$）个体死亡率的$1.634$倍，或者说高出$63.4\\%$。该指标对于传达社会经济地位与死亡率之间关联的强度非常有用，且不受基线率的影响。\n\n这两种衡量指标是互补的。绝对梯度从超额死亡的角度量化了公共卫生影响，而相对梯度则量化了不平等的强度。\n\n最终答案要求将两个计算值以行矩阵形式表示，并四舍五入到4位有效数字。\n绝对梯度：$362.8$\n相对梯度：$1.634$", "answer": "$$ \\boxed{\\begin{pmatrix} 362.8  1.634 \\end{pmatrix}} $$", "id": "4577111"}, {"introduction": "公共卫生专业人员不仅需要识别健康梯度，还需要从不同维度理解风险。本练习将深入探讨源自队列研究数据的三个关键流行病学指标，并强调绝对影响（可以预防多少病例）和相对不平等（风险高出多少倍）之间的关键区别。掌握这些不同指标的计算与解读，对于有效制定干预措施的优先顺序至关重要。[@problem_id:4577300]", "problem": "一个公共卫生部门进行了一项为期五年的队列研究，旨在量化社会经济地位 (SES) 与基线时无糖尿病的成年人中2型糖尿病新发病例之间的关联。社会经济地位 (SES) 被定义为教育、收入和职业等级的综合指标，参与者被分为两组：低社会经济地位组 (low SES) 和高社会经济地位组 (high SES)。在$5$年间，该研究观察了$2400$名低SES成年人和$3200$名高SES成年人，他们在基线时均无糖尿病。在随访期间，有$312$名低SES成年人和$224$名高SES成年人被新诊断出患有糖尿病。\n\n在预防医学中，资源优先排序通常需要权衡不同社会梯度间疾病发生的绝对和相对衡量指标。仅使用以下核心定义：发病比例是在指定时期内，最初无病个体中出现该疾病的比例；优势（odds）是事件发生的概率与不发生的概率之比。请计算以下用于比较低SES与高SES的指标：\n\n1. 风险差。\n2. 风险比。\n3. 优势比。\n\n然后，基于这些指标，解释绝对梯度和相对梯度如何为跨社会经济地位阶层的干预措施优先排序提供信息，重点关注哪个指标更直接地关系到“如果低SES人群的风险降低到高SES人群的水平，预期可以避免的病例数”，以及哪个指标反映了相对不平等。\n\n将这三个指标的最终数值结果，按照上面列出的顺序，以单行矩阵的形式表示。将每个数字四舍五入到三位有效数字。在最终的方框答案中不要包含任何单位或百分号；所有量都用小数表示。", "solution": "该问题提供了一项为期五年的队列研究的数据，并要求计算和解释三种流行病学关联性衡量指标：风险差、风险比和优势比。该问题具有科学依据，提问清晰，并包含了得出唯一解所需的所有信息。\n\n首先，我们根据所提供的数据定义变量。\n设 $N_{low}$ 为基线时低社会经济地位 (SES) 组的总参与人数，设 $N_{high}$ 为高SES组的总参与人数。\n设 $D_{low}$ 为低SES组中糖尿病新发（incident）病例数，设 $D_{high}$ 为高SES组中的新发病例数。\n\n根据问题描述：\n- 低SES组：$N_{low} = 2400$，$D_{low} = 312$\n- 高SES组：$N_{high} = 3200$，$D_{high} = 224$\n\n发病比例，也称为风险 ($R$)，定义为在指定时期内，最初无病的个体中发生该疾病的比例。我们计算每个组的风险。\n\n低SES组的风险 ($R_{low}$) 为：\n$$R_{low} = \\frac{D_{low}}{N_{low}} = \\frac{312}{2400} = 0.13$$\n\n高SES组的风险 ($R_{high}$) 为：\n$$R_{high} = \\frac{D_{high}}{N_{high}} = \\frac{224}{3200} = 0.07$$\n\n有了这些概率，我们就可以计算所需的指标。\n\n1.  **风险差 (RD)**\n    风险差是一种绝对关联性衡量指标，表示暴露组（低SES）相较于非暴露组（高SES）的超额风险。\n    $$RD = R_{low} - R_{high}$$\n    代入计算出的值：\n    $$RD = 0.13 - 0.07 = 0.06$$\n    按要求，我们将其表示为三位有效数字，即 $0.0600$。\n\n2.  **风险比 (RR)**\n    风险比是一种相对关联性衡量指标，表明暴露组发生该疾病的可能性是非暴露组的多少倍。\n    $$RR = \\frac{R_{low}}{R_{high}}$$\n    代入计算出的值：\n    $$RR = \\frac{0.13}{0.07} = \\frac{13}{7} \\approx 1.8571428...$$\n    四舍五入到三位有效数字，风险比为 $1.86$。\n\n3.  **优势比 (OR)**\n    事件的优势（odds）是指事件发生的概率 ($p$) 与其不发生的概率 ($1-p$) 之比。优势比是暴露组中患病优势与非暴露组中患病优势之比。\n\n    低SES组中患糖尿病的优势为：\n    $$Odds_{low} = \\frac{R_{low}}{1 - R_{low}} = \\frac{0.13}{1 - 0.13} = \\frac{0.13}{0.87}$$\n\n    高SES组中患糖尿病的优势为：\n    $$Odds_{high} = \\frac{R_{high}}{1 - R_{high}} = \\frac{0.07}{1 - 0.07} = \\frac{0.07}{0.93}$$\n\n    因此，优势比为：\n    $$OR = \\frac{Odds_{low}}{Odds_{high}} = \\frac{0.13 / 0.87}{0.07 / 0.93} = \\frac{0.13 \\times 0.93}{0.87 \\times 0.07} = \\frac{0.1209}{0.0609} \\approx 1.9852216...$$\n    或者，也可以通过列联表的交叉乘积比来计算，其中非病例数分别为 $NC_{low} = 2400 - 312 = 2088$ 和 $NC_{high} = 3200 - 224 = 2976$。\n    $$OR = \\frac{D_{low} \\times NC_{high}}{D_{high} \\times NC_{low}} = \\frac{312 \\times 2976}{224 \\times 2088} = \\frac{928512}{467712} \\approx 1.9852216...$$\n    四舍五入到三位有效数字，优势比为 $1.99$。\n\n**对干预措施优先排序的解释**\n\n计算出的指标为糖尿病的社会经济梯度提供了不同但互补的见解，从绝对和相对两个角度为干预措施的优先排序提供了信息。\n\n**风险差 ($RD = 0.0600$)** 是一个绝对衡量指标。它量化了低SES组相比高SES组患糖尿病的超额绝对风险。$0.0600$ 的值意味着，在低SES类别中，每100人中，在5年内会比预期（如果他们具有与高SES类别相同的风险状况）多出6例糖尿病病例。该指标直接反映了干预措施的潜在公共卫生影响。它回答了这个问题：“可以避免多少病例？”。如果一项干预措施成功地将低SES个体的风险降低到高SES同伴的水平，那么每1000人中将可以预防60例病例。因此，$RD$ 是根据预期避免的病例数来确定干预措施优先级的最直接指标，而这正是资源分配的一个关键考虑因素。\n\n**风险比 ($RR \\approx 1.86$)** 和 **优势比 ($OR \\approx 1.99$)** 是相对衡量指标。它们量化了SES与糖尿病风险之间关联的强度。$RR$ 为 $1.86$ 表明，低SES个体患糖尿病的风险比高SES个体高出 $86\\%$。$OR$ 为 $1.99$ 表明其优势几乎是后者的两倍。这些指标反映了两个阶层之间相对不平等的程度。如此处所见的高相对风险，加强了解决这种差异的科学和伦理必要性，因为它指出了社会经济劣势与不良健康结局之间的强关联。$RD$ 衡量的是绝对的公共卫生负担，而 $RR$ 和 $OR$ 衡量的则是社会梯度本身的强度。\n\n总之，在干预措施的优先排序方面，$RD$ 更直接地关系到一项干预措施可能避免的预期病例数，从而指导旨在从绝对数量上最大化人群健康收益的决策。而 $RR$ 和 $OR$ 通过反映相对不平等的程度，对于阐明为何应将干预措施针对特定群体以促进健康公平，以及对于理解风险因素的病因学强度至关重要。一个全面的公共卫生策略会同时使用两者：用 $RD$ 来估计总的潜在益处，用 $RR/OR$ 来理解差异的严重程度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.0600  1.86  1.99\n\\end{pmatrix}\n}\n$$", "id": "4577300"}, {"introduction": "这个高级练习模拟了研究人员如何探究连接社会经济地位与健康的生物学通路。它引入了“稳态负荷”（allostatic load）这一概念，作为衡量累积生理损耗的综合指标。通过构建一个包含年龄和性别等其他因素的统计模型，你将学习如何分离并估算社会经济地位对健康的特定影响（由系数 $\\beta_1$ 代表），这反映了现代预防医学中使用的复杂研究方法。[@problem_id:4577251]", "problem": "您的任务是实现一个程序，将预防医学中的一个核心概念——跨社会经济地位的单调健康梯度——进行操作化。该任务涉及两个基于广为接受的定义和建模方法的步骤。首先，使用高风险阈值从生物标志物组构建异体负荷分数。其次，在使用线性回归调整年龄和性别后，对其跨社会经济地位五分位数的梯度进行建模。\n\n基本出发点和定义：\n- 异体负荷是生理失調的累积测量指标。一种标准的操作化方法是累加一组生物标志物中的高风险指标。\n- 普通最小二乘法 (OLS) 是一种经过充分检验的线性回归方法，它通过最小化残差平方和来估计系数。\n- 此处，跨社会经济地位 (SES) 的健康梯度被量化为：在控制年龄和性别的情况下，SES五分位数每增加一个单位，预期的异体负荷发生的变化。\n\n建模要求：\n- 对每个个体 $i$，计算其异体负荷分数 $A_i$，即以下生物标志物高风险指标的总和：C反应蛋白 (CRP)、白细胞介素-6 (IL-6)、皮质醇和收缩压 (SBP)。\n- 使用以下针对特定生物标志物的高风险阈值：\n  - CRP 高风险：如果 $x_{\\text{CRP}} > 3$ mg/L。\n  - IL-6 高风险：如果 $x_{\\text{IL6}} > 3$ pg/mL。\n  - 皮质醇高风险：如果 $x_{\\text{cort}} > 20$ $\\mu$g/dL。\n  - SBP 高风险：如果 $x_{\\text{SBP}} > 130$ mmHg。\n- 将每个个体的异体负荷分数定义为\n  $$A_i = \\sum_{b \\in \\{\\text{CRP}, \\text{IL6}, \\text{cort}, \\text{SBP}\\}} \\mathbb{1}\\{x_{ib} > t_b\\},$$\n  其中 $t_b$ 表示生物标志物 $b$ 的阈值，$\\mathbb{1}\\{\\cdot\\}$ 是指示函数。\n- 拟合以下 OLS 回归模型：\n  $$A_i = \\beta_0 + \\beta_1 \\cdot SES_i + \\beta_2 \\cdot \\text{age}_i + \\beta_3 \\cdot \\text{sex}_i + \\varepsilon_i,$$\n  其中 $SES_i \\in \\{1,2,3,4,5\\}$ 是编码为整数的社会经济地位五分位数，$\\text{age}_i$ 是以年为单位的年龄，$\\text{sex}_i \\in \\{0,1\\}$ 是性别代码（女性为 $0$，男性为 $1$），$\\varepsilon_i$ 是误差项。SES 梯度是系数 $\\beta_1$。\n\n单位：\n- 生物标志物输入必须按以下单位解释：CRP单位为mg/L，IL-6单位为pg/mL，皮质醇单位为$\\mu$g/dL，收缩压单位为mmHg。年龄单位为年。性别无单位，编码为女性 $0$ 和男性 $1$。异体负荷分数和回归系数均无单位。您的程序必须计算并以十进制数输出系数。\n\n需实现的计算细节：\n- 严格按照上述阈值规则为每个个体计算 $A_i$。\n- 使用设计矩阵 $X$ 拟合 OLS 模型，该矩阵的列为：全为1的截距列、$SES_i$、$\\text{age}_i$ 和 $\\text{sex}_i$。通过最小二乘解估计 $\\hat{\\beta}$。提取并报告 SES 系数 $\\hat{\\beta}_1$。\n- 将报告的每个系数表示为四舍五入到 $6$ 位小数的十进制数。\n\n测试套件：\n- 使用以下三个数据集。每个数据集由具有生物标志物值、年龄、性别和SES五分位数的个体组成。对每个数据集，仅计算并报告调整后的 SES 梯度系数 $\\hat{\\beta}_1$。\n\n数据集 $1$ (混合风险，预期为负的SES梯度)：\n- 个体 $1$：CRP $5.0$ mg/L, IL-6 $4.0$ pg/mL, 皮质醇 $22.0$ $\\mu$g/dL, SBP $145.0$ mmHg, 年龄 $55$, 性别 $0$, SES $1$。\n- 个体 $2$：CRP $4.2$, IL-6 $2.5$, 皮质醇 $18.0$, SBP $135.0$, 年龄 $48$, 性别 $1$, SES $1$。\n- 个体 $3$：CRP $3.5$, IL-6 $3.2$, 皮质醇 $19.0$, SBP $128.0$, 年龄 $60$, 性别 $0$, SES $2$。\n- 个体 $4$：CRP $2.0$, IL-6 $1.2$, 皮质醇 $21.0$, SBP $132.0$, 年龄 $45$, 性别 $1$, SES $2$。\n- 个体 $5$：CRP $2.8$, IL-6 $2.0$, 皮质醇 $18.0$, SBP $125.0$, 年龄 $50$, 性别 $0$, SES $3$。\n- 个体 $6$：CRP $3.1$, IL-6 $1.0$, 皮质醇 $16.0$, SBP $120.0$, 年龄 $35$, 性别 $1$, SES $3$。\n- 个体 $7$：CRP $1.5$, IL-6 $1.1$, 皮质醇 $15.0$, SBP $118.0$, 年龄 $42$, 性别 $0$, SES $4$。\n- 个体 $8$：CRP $2.2$, IL-6 $0.9$, 皮质醇 $17.0$, SBP $122.0$, 年龄 $38$, 性别 $1$, SES $4$。\n- 个体 $9$：CRP $0.8$, IL-6 $1.0$, 皮质醇 $14.0$, SBP $110.0$, 年龄 $40$, 性别 $0$, SES $5$。\n- 个体 $10$：CRP $1.0$, IL-6 $0.7$, 皮质醇 $13.0$, SBP $108.0$, 年龄 $33$, 性别 $1$, SES $5$。\n- 个体 $11$：CRP $4.8$, IL-6 $2.8$, 皮质醇 $21.0$, SBP $129.0$, 年龄 $52$, 性别 $0$, SES $2$。\n- 个体 $12$：CRP $3.5$, IL-6 $2.0$, 皮质醇 $22.0$, SBP $131.0$, 年龄 $47$, 性别 $1$, SES $3$。\n\n数据集 $2$ (所有生物标志物均低于阈值：整体异体负荷为零)：\n- 个体 $1$：CRP $2.0$, IL-6 $1.0$, 皮质醇 $18.0$, SBP $120.0$, 年龄 $50$, 性别 $0$, SES $1$。\n- 个体 $2$：CRP $1.5$, IL-6 $0.8$, 皮质醇 $10.0$, SBP $110.0$, 年龄 $60$, 性别 $1$, SES $2$。\n- 个体 $3$：CRP $2.5$, IL-6 $1.2$, 皮质醇 $15.0$, SBP $115.0$, 年龄 $45$, 性别 $0$, SES $3$。\n- 个体 $4$：CRP $2.1$, IL-6 $2.0$, 皮质醇 $12.0$, SBP $118.0$, 年龄 $35$, 性别 $1$, SES $4$。\n- 个体 $5$：CRP $1.0$, IL-6 $0.5$, 皮质醇 $9.0$, SBP $105.0$, 年龄 $30$, 性别 $0$, SES $5$。\n- 个体 $6$：CRP $2.9$, IL-6 $2.5$, 皮质醇 $19.0$, SBP $120.0$, 年龄 $55$, 性别 $1$, SES $2$。\n- 个体 $7$：CRP $2.7$, IL-6 $1.7$, 皮质醇 $17.0$, SBP $122.0$, 年龄 $48$, 性别 $0$, SES $3$。\n- 个体 $8$：CRP $2.2$, IL-6 $1.1$, 皮质醇 $11.0$, SBP $119.0$, 年龄 $41$, 性别 $1$, SES $4$。\n\n数据集 $3$ (所有生物标志物均高于阈值：整体异体负荷为最大值)：\n- 个体 $1$：CRP $3.5$, IL-6 $3.5$, 皮质醇 $21.0$, SBP $140.0$, 年龄 $50$, 性别 $0$, SES $1$。\n- 个体 $2$：CRP $4.0$, IL-6 $3.2$, 皮质醇 $22.0$, SBP $150.0$, 年龄 $60$, 性别 $1$, SES $2$。\n- 个体 $3$：CRP $5.0$, IL-6 $4.0$, 皮质醇 $25.0$, SBP $160.0$, 年龄 $45$, 性别 $0$, SES $3$。\n- 个体 $4$：CRP $3.1$, IL-6 $3.8$, 皮质醇 $23.0$, SBP $135.0$, 年龄 $35$, 性别 $1$, SES $4$。\n- 个体 5：CRP $6.0$, IL-6 $5.0$, 皮质醇 $26.0$, SBP $170.0$, 年龄 $30$, 性别 $0$, SES $5$。\n- 个体 $6$：CRP $3.2$, IL-6 $3.3$, 皮质醇 $24.0$, SBP $145.0$, 年龄 $55$, 性别 $1$, SES $2$。\n- 个体 $7$：CRP $4.5$, IL-6 $4.2$, 皮质醇 $28.0$, SBP $155.0$, 年龄 $48$, 性别 $0$, SES $3$。\n- 个体 $8$：CRP $3.8$, IL-6 $3.6$, 皮质醇 $27.0$, SBP $138.0$, 年龄 $41$, 性别 $1$, SES $4$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个方括号括起来的逗号分隔列表，列表中的每个元素是对应一个数据集的 SES 梯度系数 $\\hat{\\beta}_1$，顺序为数据集 $1$、数据集 $2$、数据集 $3$，每个系数都四舍五入到 $6$ 位小数。例如，输出格式为 $[\\text{d1},\\text{d2},\\text{d3}]$，其中每个 $\\text{d}$ 都是一个十进制数。\n\n禁止外部输入。所有需要的常量和数据已在上方指定。程序必须是自包含的，并且必须在没有用户交互的情况下运行。", "solution": "该问题要求计算调整后的社会经济地位 (SES) 对健康的影响梯度。这一过程通过两个步骤实现操作化：首先，根据一组生物标志物计算异体负荷分数；其次，使用普通最小二乘法 (OLS) 估计一个多元线性回归模型。代表健康梯度的模型中 SES 五分位数的系数，必须针对三个不同的数据集进行计算。\n\n### 第 1 步：问题验证\n\n**1. 提取已知条件：**\n- **异体负荷分数 ($A_i$)：** 对每个个体 $i$，$A_i$ 是超出高风险阈值的生物标志物的数量。\n- **生物标志物和阈值：**\n    - C反应蛋白 (CRP)：若 $x_{\\text{CRP}} > 3$ mg/L 则为高风险。\n    - 白细胞介素-6 (IL-6)：若 $x_{\\text{IL6}} > 3$ pg/mL 则为高风险。\n    - 皮质醇：若 $x_{\\text{cort}} > 20$ $\\mu$g/dL 则为高风险。\n    - 收缩压 (SBP)：若 $x_{\\text{SBP}} > 130$ mmHg 则为高风险。\n- **异体负荷公式：**\n  $$A_i = \\sum_{b \\in \\{\\text{CRP}, \\text{IL6}, \\text{cort}, \\text{SBP}\\}} \\mathbb{1}\\{x_{ib} > t_b\\}$$\n  其中 $\\mathbb{1}\\{\\cdot\\}$ 是指示函数，$t_b$ 是生物标志物 $b$ 的阈值。\n- **普通最小二乘 (OLS) 回归模型：**\n  $$A_i = \\beta_0 + \\beta_1 \\cdot SES_i + \\beta_2 \\cdot \\text{age}_i + \\beta_3 \\cdot \\text{sex}_i + \\varepsilon_i$$\n- **变量定义：**\n    - $SES_i$：社会经济地位五分位数，为 $\\{1, 2, 3, 4, 5\\}$中的整数。\n    - $\\text{age}_i$：以年为单位的年龄。\n    - $\\text{sex}_i$：编码为女性 $0$ 和男性 $1$。\n    - $\\varepsilon_i$：误差项。\n- **目标量：** SES 梯度系数 $\\beta_1$。\n- **计算方法：** OLS 系数向量 $\\hat{\\beta}$ 通过最小二乘解来估计。\n- **数据：** 提供了三个数据集，每个数据集包含四个生物标志物、年龄、性别和 SES 五分位数的个体层面数据。\n- **输出格式：** 包含三个估计系数 $\\hat{\\beta}_1$ 的列表，每个数据集一个，四舍五入到 $6$ 位小数。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题是合理的。异体负荷是心身医学和公共卫生领域广泛接受的用于衡量累积生理压力的概念。对高风险生物标志物指标进行二值化并求和的方法，是一种标准的（尽管是简化的）操作化方式。普通最小二ersch回归是用于建模变量之间关系的基础统计技术。所选的生物标志物是炎症（CRP, IL-6）、应激反应（皮质醇）和心血管健康（SBP）的相关指标。跨社会经济地位的健康梯度的存在是社会流行病学的一项基石性发现。\n- **适定性：** 这是一个适定问题。它提供了所有必要的数据、计算因变量（$A_i$）的明确公式、回归模型的精确规范以及所需输出量（$\\hat{\\beta}_1$）的清晰定义。OLS 解存在且唯一，因为由所提供数据集构成的设计矩阵不表现出完全多重共線性。虽然有两个数据集的因变量没有方差，但这会导出一个确定的、有意义的 OLS 解，其中非截距项的系数为零。\n- **客观性：** 该问题以精确、客观和数学化的语言陈述，没有歧义或主观解释的空间。\n\n**3. 结论与行动：**\n问题陈述是有效的、有科学依据的且适定的。我将继续完成完整的解答。\n\n### 第 2 步：方法论与求解推导\n\n求解过程首先是为每个数据集中的每个个体构建因变量，即异体负荷分数 $A_i$。随后，使用 OLS 方法拟合一个多元线性回归模型，以估计各个系数，特别是与 SES 变量相关的系数 $\\beta_1$。\n\n**1. 异体负荷分数 ($A_i$) 计算：**\n对于每个个体 $i$，异体负荷分数 $A_i$ 是一个介于 $0$ 和 $4$ 之间的整数，通过对超出其指定高风险阈值的生物标志物数量求和计算得出：\n- CRP > 3 mg/L 得 $1$ 分\n- IL-6 > 3 pg/mL 得 $1$ 分\n- 皮质醇 > 20 $\\mu$g/dL 得 $1$ 分\n- SBP > 130 mmHg 得 $1$ 分\n\n**2. OLS 回归：**\n待估计的模型为 $A_i = \\beta_0 + \\beta_1 \\cdot SES_i + \\beta_2 \\cdot \\text{age}_i + \\beta_3 \\cdot \\text{sex}_i + \\varepsilon_i$。\n其矩阵形式写作 $y = X\\beta + \\varepsilon$，其中：\n- $y$ 是异体负荷分数的 $N \\times 1$ 向量，$[A_1, A_2, ..., A_N]^T$。\n- $X$ 是 $N \\times 4$ 的设计矩阵，其中第 $i$ 行对应一个个体，由 $[1, SES_i, \\text{age}_i, \\text{sex}_i]$ 给出。第一列的全1代表截距项 $\\beta_0$。\n- $\\beta$ 是 $4 \\times 1$ 的系数向量，$[\\beta_0, \\beta_1, \\beta_2, \\beta_3]^T$。\n- $\\varepsilon$ 是 $N \\times 1$ 的误差项向量。\n\n系数向量 $\\beta$ 的 OLS 估计量 $\\hat{\\beta}$ 由最小化残差平方和的公式给出：\n$$ \\hat{\\beta} = (X^T X)^{-1} X^T y $$\n我们的目标是找到该向量的第二个元素 $\\hat{\\beta}_1$。\n\n### 第 3 步：应用于数据集\n\n**数据集 1：**\n首先，我们为 12 个个体中的每一个计算异体负荷分数 $A_i$。\n- 个体 $1$：$A_1 = \\mathbb{1}\\{5.0>3\\} + \\mathbb{1}\\{4.0>3\\} + \\mathbb{1}\\{22.0>20\\} + \\mathbb{1}\\{145.0>130\\} = 1+1+1+1=4$\n- 个体 $2$：$A_2 = \\mathbb{1}\\{4.2>3\\} + \\mathbb{1}\\{2.5>3\\} + \\mathbb{1}\\{18.0>20\\} + \\mathbb{1}\\{135.0>130\\} = 1+0+0+1=2$\n- 个体 $3$：$A_3 = \\mathbb{1}\\{3.5>3\\} + \\mathbb{1}\\{3.2>3\\} + \\mathbb{1}\\{19.0>20\\} + \\mathbb{1}\\{128.0>130\\} = 1+1+0+0=2$\n- 个体 $4$：$A_4 = \\mathbb{1}\\{2.0>3\\} + \\mathbb{1}\\{1.2>3\\} + \\mathbb{1}\\{21.0>20\\} + \\mathbb{1}\\{132.0>130\\} = 0+0+1+1=2$\n- 个体 $5$：$A_5 = 0+0+0+0=0$\n- 个体 $6$：$A_6 = \\mathbb{1}\\{3.1>3\\} + 0+0+0=1$\n- 个体 $7$：$A_7 = 0+0+0+0=0$\n- 个体 $8$：$A_8 = 0+0+0+0=0$\n- 个体 $9$：$A_9 = 0+0+0+0=0$\n- 个体 $10$：$A_{10} = 0+0+0+0=0$\n- 个体 $11$：$A_{11} = \\mathbb{1}\\{4.8>3\\} + \\mathbb{1}\\{2.8>3\\} + \\mathbb{1}\\{21.0>20\\} + \\mathbb{1}\\{129.0>130\\} = 1+0+1+0=2$\n- 个体 $12$：$A_{12} = \\mathbb{1}\\{3.5>3\\} + \\mathbb{1}\\{2.0>3\\} + \\mathbb{1}\\{22.0>20\\} + \\mathbb{1}\\{131.0>130\\} = 1+0+1+1=3$\n\n因变量向量为 $y_1 = [4, 2, 2, 2, 0, 1, 0, 0, 0, 0, 2, 3]^T$。\n设计矩阵 $X_1$ 为：\n$$ X_1 = \\begin{pmatrix} 1  1  55  0 \\\\ 1  1  48  1 \\\\ 1  2  60  0 \\\\ 1  2  45  1 \\\\ 1  3  50  0 \\\\ 1  3  35  1 \\\\ 1  4  42  0 \\\\ 1  4  38  1 \\\\ 1  5  40  0 \\\\ 1  5  33  1 \\\\ 1  2  52  0 \\\\ 1  3  47  1 \\end{pmatrix} $$\n计算 $\\hat{\\beta} = (X_1^T X_1)^{-1} X_1^T y_1$ 得出系数向量 $\\hat{\\beta} \\approx [4.295280, -0.871038, 0.009406, 0.061737]^T$。\nSES 梯度为 $\\hat{\\beta}_1 \\approx -0.871038$。\n\n**数据集 2：**\n在此数据集中，每个个体的所有四个生物标志物值均低于各自的高风险阈值。\n- 例如，个体 $1$：$x_{\\text{CRP}}=2.0 \\le 3$, $x_{\\text{IL6}}=1.0 \\le 3$, $x_{\\text{cort}}=18.0 \\le 20$, $x_{\\text{SBP}}=120.0 \\le 130$。\n因此，对于所有 $i$，异体负荷分数 $A_i = 0$。\n因变量向量为 $y_2 = [0, 0, 0, 0, 0, 0, 0, 0]^T$。\n当因变量向量为零向量时，使误差平方和最小化的 OLS 解是系数的零向量，即 $\\hat{\\beta}=[0, 0, 0, 0]^T$。也就是说，$\\hat{\\beta} = (X_2^T X_2)^{-1} X_2^T y_2 = (X_2^T X_2)^{-1} \\mathbf{0} = \\mathbf{0}$。\n因此，SES 梯度为 $\\hat{\\beta}_1 = 0$。\n\n**数据集 3：**\n在此数据集中，每个个体的所有四个生物标志物值均高于各自的高风险阈值。\n- 例如，个体 $1$：$x_{\\text{CRP}}=3.5 > 3$, $x_{\\text{IL6}}=3.5 > 3$, $x_{\\text{cort}}=21.0 > 20$, $x_{\\text{SBP}}=140.0 > 130$。\n因此，对于所有 $i$，异体负荷分数为 $A_i=4$。\n因变量向量为 $y_3=[4, 4, 4, 4, 4, 4, 4, 4]^T$。\n当因变量为常数 $y_i = c$，且模型包含截距项时，截距的 OLS 估计值为 $\\hat{\\beta}_0 = c$，所有其他斜率系数的估计值为 $0$。这将误差平方和最小化到 $0$。此处 $c=4$。\n解为 $\\hat{\\beta}=[4, 0, 0, 0]^T$。\n因此，SES 梯度为 $\\hat{\\beta}_1 = 0$。这个结果是合乎逻辑的：如果结果变量（异体负荷）没有变异，那么任何预测变量（如 SES）都无法解释任何方差。\n\n**结果总结：**\n- 数据集 1：$\\hat{\\beta}_1 \\approx -0.87103753 \\rightarrow -0.871038$\n- 数据集 2：$\\hat{\\beta}_1 = 0.0 \\rightarrow 0.000000$\n- 数据集 3：$\\hat{\\beta}_1 = 0.0 \\rightarrow 0.000000$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the adjusted socioeconomic status (SES) gradient on health for three datasets.\n    The process involves:\n    1. Calculating an allostatic load score for each individual based on biomarker thresholds.\n    2. Fitting an Ordinary Least Squares (OLS) regression of the score on SES, age, and sex.\n    3. Extracting the coefficient for SES.\n    \"\"\"\n    \n    # Define the high-risk thresholds for the biomarkers.\n    # Order: CRP, IL-6, Cortisol, SBP\n    thresholds = np.array([3.0, 3.0, 20.0, 130.0])\n\n    # Define the three test case datasets.\n    # Each entry is a tuple: (biomarkers, covariates)\n    # biomarkers: [CRP, IL-6, Cortisol, SBP]\n    # covariates: [SES, age, sex]\n    test_cases = [\n        # Dataset 1\n        [\n            ([5.0, 4.0, 22.0, 145.0], [1, 55, 0]),\n            ([4.2, 2.5, 18.0, 135.0], [1, 48, 1]),\n            ([3.5, 3.2, 19.0, 128.0], [2, 60, 0]),\n            ([2.0, 1.2, 21.0, 132.0], [2, 45, 1]),\n            ([2.8, 2.0, 18.0, 125.0], [3, 50, 0]),\n            ([3.1, 1.0, 16.0, 120.0], [3, 35, 1]),\n            ([1.5, 1.1, 15.0, 118.0], [4, 42, 0]),\n            ([2.2, 0.9, 17.0, 122.0], [4, 38, 1]),\n            ([0.8, 1.0, 14.0, 110.0], [5, 40, 0]),\n            ([1.0, 0.7, 13.0, 108.0], [5, 33, 1]),\n            ([4.8, 2.8, 21.0, 129.0], [2, 52, 0]),\n            ([3.5, 2.0, 22.0, 131.0], [3, 47, 1]),\n        ],\n        # Dataset 2\n        [\n            ([2.0, 1.0, 18.0, 120.0], [1, 50, 0]),\n            ([1.5, 0.8, 10.0, 110.0], [2, 60, 1]),\n            ([2.5, 1.2, 15.0, 115.0], [3, 45, 0]),\n            ([2.1, 2.0, 12.0, 118.0], [4, 35, 1]),\n            ([1.0, 0.5, 9.0, 105.0], [5, 30, 0]),\n            ([2.9, 2.5, 19.0, 120.0], [2, 55, 1]),\n            ([2.7, 1.7, 17.0, 122.0], [3, 48, 0]),\n            ([2.2, 1.1, 11.0, 119.0], [4, 41, 1]),\n        ],\n        # Dataset 3\n        [\n            ([3.5, 3.5, 21.0, 140.0], [1, 50, 0]),\n            ([4.0, 3.2, 22.0, 150.0], [2, 60, 1]),\n            ([5.0, 4.0, 25.0, 160.0], [3, 45, 0]),\n            ([3.1, 3.8, 23.0, 135.0], [4, 35, 1]),\n            ([6.0, 5.0, 26.0, 170.0], [5, 30, 0]),\n            ([3.2, 3.3, 24.0, 145.0], [2, 55, 1]),\n            ([4.5, 4.2, 28.0, 155.0], [3, 48, 0]),\n            ([3.8, 3.6, 27.0, 138.0], [4, 41, 1]),\n        ]\n    ]\n\n    results = []\n    for dataset in test_cases:\n        # Unpack data for the current dataset\n        biomarker_data = np.array([p[0] for p in dataset])\n        covariate_data = np.array([p[1] for p in dataset])\n        \n        # Step 1: Calculate the allostatic load score (y vector)\n        # Compare each biomarker value against its threshold\n        high_risk_indicators = biomarker_data > thresholds\n        # Sum the indicators for each person to get the allostatic load score\n        y = high_risk_indicators.sum(axis=1)\n\n        # Step 2: Construct the design matrix X\n        num_individuals = covariate_data.shape[0]\n        # Create an intercept column of ones\n        intercept = np.ones((num_individuals, 1))\n        # Combine intercept with covariates (SES, age, sex)\n        X = np.hstack((intercept, covariate_data))\n        \n        # Step 3: Compute OLS coefficients using the normal equation: beta = (X'X)^(-1)X'y\n        # A check for constant y can optimize, but the formula works for all cases.\n        # If y is constant, all non-intercept betas will be zero.\n        try:\n            XTX = X.T @ X\n            XTX_inv = np.linalg.inv(XTX)\n            XTY = X.T @ y\n            beta_hat = XTX_inv @ XTY\n        except np.linalg.LinAlgError:\n            # Fallback to lstsq for numerical stability, though not expected for this data\n            beta_hat = np.linalg.lstsq(X, y, rcond=None)[0]\n        \n        # The SES gradient is the second coefficient (index 1)\n        ses_gradient = beta_hat[1]\n        results.append(ses_gradient)\n\n    # Format the final output as a string with 6 decimal places for each result.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "4577251"}]}