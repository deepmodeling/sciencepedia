{"hands_on_practices": [{"introduction": "心肌细胞的静息膜电位是心脏兴奋性的基石，它主要由钾离子的跨膜浓度梯度决定。本练习将指导你运用能斯特方程 (Nernst equation) 来量化临床常见的缺血事件对静息膜电位的影响，从而揭示代谢应激与电不稳定性之间的直接联系。通过这个计算，你将能更深刻地理解高钾血症为何是导致心律失常的一个重要因素 [@problem_id:4818509]。", "problem": "一个处于生理温度下的心室肌细胞经历了一次缺血性扰动，这改变了跨膜钾离子梯度，而跨膜钾离子梯度是通过去极化诱导的电压门控钠通道失活来驱动心律失常发生的一个关键因素。将静息状态视为主要由钾离子通透性决定，因此静息膜电位近似于钾离子平衡电位。假设溶液为理想稀溶液，并且钾离子的电化学平衡由细胞内外电化学势相等来定义。该心室肌细胞的初始状态特征为：细胞内钾离子浓度 $[K^{+}]_{i,0} = 140\\,\\text{mM}$ 和细胞外钾离子浓度 $[K^{+}]_{o,0} = 4.0\\,\\text{mM}$。在早期缺血期间，这些值变为 $[K^{+}]_{i,1} = 130\\,\\text{mM}$ 和 $[K^{+}]_{o,1} = 7.0\\,\\text{mM}$。温度为 $T = 310\\,\\text{K}$。使用普适气体常数 $R = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$，法拉第常数 $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$，以及钾离子的化合价 $z = +1$。\n\n从平衡时钾离子的电化学势相等和理想稀溶液行为出发，推导出离子平衡电位表达式，并用它来计算缺血引起的钾离子平衡电位变化量 $\\Delta E_{K} = E_{K,1} - E_{K,0}$。将最终答案四舍五入至三位有效数字。以毫伏为单位表示你的答案。", "solution": "跨膜离子梯度改变与心律失常之间的病理生理学联系源于膜电位如何依赖于离子电化学平衡。对于一个化合价为 $z$ 的离子，其电化学势由下式给出\n$$\n\\mu = \\mu^{0} + RT \\ln a + z F \\psi,\n$$\n其中 $a$ 是活度（在理想稀溶液条件下近似为浓度），$R$ 是普适气体常数，$T$ 是绝对温度，$F$ 是法拉第常数，$\\psi$ 是电势。对于一个给定的离子，当其跨越分隔外部（o）和内部（i）区域的膜达到电化学平衡时，我们有\n$$\n\\mu_{o} = \\mu_{i}.\n$$\n使用理想稀溶液活度代入并整理，得到\n$$\n\\mu^{0} + RT \\ln [X]_{o} + z F \\psi_{o} \\;=\\; \\mu^{0} + RT \\ln [X]_{i} + z F \\psi_{i}.\n$$\n消去 $\\mu^{0}$ 并求解电位差 $E \\equiv \\psi_{i} - \\psi_{o}$，得到 Nernst 平衡电位：\n$$\nE \\;=\\; \\frac{RT}{zF} \\ln\\!\\left(\\frac{[X]_{o}}{[X]_{i}}\\right).\n$$\n对于化合价 $z = +1$ 的钾离子，其平衡电位为\n$$\nE_{K} \\;=\\; \\frac{RT}{F} \\ln\\!\\left(\\frac{[K^{+}]_{o}}{[K^{+}]_{i}}\\right).\n$$\n鉴于心室肌细胞的静息膜电位主要由钾离子通透性决定，静息电位近似于 $E_{K}$。因此，缺血引起的静息电位变化可以近似为\n$$\n\\Delta E_{K} \\;=\\; E_{K,1} - E_{K,0} \\;=\\; \\frac{RT}{F} \\left[\\ln\\!\\left(\\frac{[K^{+}]_{o,1}}{[K^{+}]_{i,1}}\\right) - \\ln\\!\\left(\\frac{[K^{+}]_{o,0}}{[K^{+}]_{i,0}}\\right)\\right].\n$$\n合并对数项：\n$$\n\\Delta E_{K} \\;=\\; \\frac{RT}{F} \\ln\\!\\left(\\frac{[K^{+}]_{o,1}/[K^{+}]_{i,1}}{[K^{+}]_{o,0}/[K^{+}]_{i,0}}\\right) \\;=\\; \\frac{RT}{F} \\ln\\!\\left(\\frac{[K^{+}]_{o,1}\\,[K^{+}]_{i,0}}{[K^{+}]_{i,1}\\,[K^{+}]_{o,0}}\\right).\n$$\n代入所给数值，在最后的数值计算步骤前保留符号：\n- $R = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$,\n- $T = 310\\,\\text{K}$,\n- $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$,\n- $[K^{+}]_{o,1} = 7.0\\,\\text{mM}$,\n- $[K^{+}]_{i,1} = 130\\,\\text{mM}$,\n- $[K^{+}]_{o,0} = 4.0\\,\\text{mM}$,\n- $[K^{+}]_{i,0} = 140\\,\\text{mM}$.\n\n计算对数的参数：\n$$\n\\frac{[K^{+}]_{o,1}\\,[K^{+}]_{i,0}}{[K^{+}]_{i,1}\\,[K^{+}]_{o,0}} \\;=\\; \\frac{(7.0)(140)}{(130)(4.0)} \\;=\\; \\frac{980}{520} \\;=\\; \\frac{49}{26} \\;=\\; 1.884615\\ldots.\n$$\n因此，\n$$\n\\Delta E_{K} \\;=\\; \\frac{RT}{F} \\ln\\!\\left(1.884615\\ldots\\right).\n$$\n计算前置因子：\n$$\n\\frac{RT}{F} \\;=\\; \\frac{(8.314)(310)}{96485}\\,\\text{V} \\;\\approx\\; 0.0267\\,\\text{V}.\n$$\n计算自然对数并相乘：\n$$\n\\ln(1.884615\\ldots) \\;\\approx\\; 0.6335,\n$$\n所以\n$$\n\\Delta E_{K} \\;\\approx\\; (0.0267\\,\\text{V})(0.6335) \\;=\\; 0.0169\\,\\text{V} \\;=\\; 16.9\\,\\text{mV}.\n$$\n一个正的 $\\Delta E_{K}$ 表示去极化（一个负得更少的平衡电位），这是致心律失常的，因为它降低了快速钠通道的可用性并减慢了传导速度。四舍五入到三位有效数字并以毫伏表示，缺血引起的变化为 $16.9\\,\\text{mV}$。", "answer": "$$\\boxed{16.9}$$", "id": "4818509"}, {"introduction": "在理解了膜电位的基础上，本练习将聚焦于电压门控钠通道的动力学行为，这对动作电位的传导至关重要。通过对其失活后恢复过程的建模，我们可以定量计算不应期，并理解为何心脏不能被过快地再次兴奋。这一原理是理解和预测与心率相关的传导阻滞及折返现象的关键 [@problem_id:4818499]。", "problem": "一个表现出快速内向钠电流恢复动力学的心肌束，以一个允许在心搏之间完全复极化的基本周期长度进行起搏。考虑钠通道失活门控变量 $h(t)$，在舒张期间隔内，当舒张期膜电位固定为 $-80$ 毫伏时，该变量向其稳态值 $h_{\\infty}$ 进行一阶恢复。恢复动力学由标准的一阶弛豫定律控制：当膜电位保持恒定时，$h(t)$ 以时间常数 $\\tau_{h}$ 向稳态值 $h_{\\infty}$ 弛豫。在舒张期开始时 ($t = 0$)，即在前一个动作电位 (AP) 刚复极化至 $-80$ 毫伏后，失活门控变量的值为 $h(0) = h_{0}$。\n\n在复极化后的时间 $t = \\mathrm{DI}$（舒张期间隔）施加一个期前刺激。为了在该心肌束中实现持续传导，上升支期间膜电位的最大上升速率必须超过一个源-汇阈值，在本情形中，这等效于要求在刺激瞬间可恢复钠通道的比例至少达到一个临界值 $h_{\\mathrm{crit}}$。假设与失活恢复相比，激活门打开得很快，因此上升支期间钠电流的可用性受限于 $h(t)$。\n\n在 $-80$ 毫伏下，使用以下科学上合理的参数：\n- 稳态失活值 $h_{\\infty} = 0.95$，\n- 恢复时间常数 $\\tau_{h} = 30$ 毫秒，\n- 舒张期开始时的初始失活门值 $h_{0} = 0.10$，\n- 临界可用性阈值 $h_{\\mathrm{crit}} = 0.60$。\n\n从第一性原理推导最小舒张期间隔 $\\mathrm{DI}_{\\min}$，使得 $h(\\mathrm{DI}_{\\min}) = h_{\\mathrm{crit}}$。以毫秒为单位报告 $\\mathrm{DI}_{\\min}$ 的值。将您的最终数值答案四舍五入至三位有效数字。", "solution": "本题要求解最小舒张期间隔 $\\mathrm{DI}_{\\min}$，该间隔是钠通道失活门控变量 $h$ 恢复到为维持持续传导所必需的临界值 $h_{\\mathrm{crit}}$ 所需的时间。恢复过程由一阶弛豫定律描述。\n\n其控制原理是：在舒张期间隔，膜电位恒定在 $-80$ 毫伏，失活门控变量 $h(t)$ 以时间常数 $\\tau_{h}$ 向其稳态值 $h_{\\infty}$ 弛豫。此过程由以下一阶线性常微分方程描述：\n$$ \\frac{dh(t)}{dt} = \\frac{h_{\\infty} - h(t)}{\\tau_{h}} $$\n该方程服从舒张期开始时的初始条件，我们定义此时为 $t=0$。此时，失活变量的值为 $h(0) = h_{0}$，代表其在前一个动作电位刚结束后的状态。\n\n为求出 $h(t)$ 随时间的演化，我们必须求解此微分方程。这是一个可分离变量的方程，可写为：\n$$ \\frac{dh}{h_{\\infty} - h} = \\frac{dt}{\\tau_{h}} $$\n我们将方程两边从初始状态 $(t=0, h=h_0)$ 积分到一般状态 $(t, h(t))$：\n$$ \\int_{h_0}^{h(t)} \\frac{1}{h_{\\infty} - h'} dh' = \\int_{0}^{t} \\frac{1}{\\tau_{h}} dt' $$\n积分结果为：\n$$ \\left[-\\ln\\left|h_{\\infty} - h'\\right|\\right]_{h_0}^{h(t)} = \\frac{t}{\\tau_{h}} $$\n由于 $h(t)$ 从 $h_0$ 向 $h_{\\infty}$ 恢复，且 $h_0  h_{\\infty}$，项 $h_{\\infty} - h'$ 在整个区间内将保持为正。因此，绝对值不是严格必需的。计算该定积分可得：\n$$ -\\ln(h_{\\infty} - h(t)) - (-\\ln(h_{\\infty} - h_0)) = \\frac{t}{\\tau_{h}} $$\n$$ \\ln(h_{\\infty} - h_0) - \\ln(h_{\\infty} - h(t)) = \\frac{t}{\\tau_{h}} $$\n利用对数的性质，我们合并对数项：\n$$ \\ln\\left(\\frac{h_{\\infty} - h_0}{h_{\\infty} - h(t)}\\right) = \\frac{t}{\\tau_{h}} $$\n为了解出 $h(t)$，我们首先对等式两边取指数：\n$$ \\frac{h_{\\infty} - h_0}{h_{\\infty} - h(t)} = \\exp\\left(\\frac{t}{\\tau_{h}}\\right) $$\n整理各项以分离出 $h(t)$：\n$$ h_{\\infty} - h(t) = (h_{\\infty} - h_0) \\exp\\left(-\\frac{t}{\\tau_{h}}\\right) $$\n$$ h(t) = h_{\\infty} - (h_{\\infty} - h_0) \\exp\\left(-\\frac{t}{\\tau_{h}}\\right) $$\n此方程描述了舒张期间隔内任意时刻 $t$ 的失活门控变量值。\n\n题目要求找到最小舒张期间隔 $\\mathrm{DI}_{\\min}$，使得 $h(\\mathrm{DI}_{\\min}) = h_{\\mathrm{crit}}$。我们将 $t = \\mathrm{DI}_{\\min}$ 和 $h(t) = h_{\\mathrm{crit}}$ 代入上述解中：\n$$ h_{\\mathrm{crit}} = h_{\\infty} - (h_{\\infty} - h_0) \\exp\\left(-\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}}\\right) $$\n现在，我们必须求解 $\\mathrm{DI}_{\\min}$。首先，分离出指数项：\n$$ (h_{\\infty} - h_0) \\exp\\left(-\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}}\\right) = h_{\\infty} - h_{\\mathrm{crit}} $$\n$$ \\exp\\left(-\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}}\\right) = \\frac{h_{\\infty} - h_{\\mathrm{crit}}}{h_{\\infty} - h_0} $$\n对两边取自然对数：\n$$ -\\frac{\\mathrm{DI}_{\\min}}{\\tau_{h}} = \\ln\\left(\\frac{h_{\\infty} - h_{\\mathrm{crit}}}{h_{\\infty} - h_0}\\right) $$\n最后，解出 $\\mathrm{DI}_{\\min}$：\n$$ \\mathrm{DI}_{\\min} = -\\tau_{h} \\ln\\left(\\frac{h_{\\infty} - h_{\\mathrm{crit}}}{h_{\\infty} - h_0}\\right) $$\n利用性质 $-\\ln(x) = \\ln(1/x)$，我们可以将其写成一个更直观的形式，因为此时对数的自变量将大于 $1$：\n$$ \\mathrm{DI}_{\\min} = \\tau_{h} \\ln\\left(\\frac{h_{\\infty} - h_0}{h_{\\infty} - h_{\\mathrm{crit}}}\\right) $$\n这就是最小舒张期间隔的解析表达式。\n\n给定以下数值参数：\n- $\\tau_{h} = 30$ 毫秒\n- $h_{\\infty} = 0.95$\n- $h_{0} = 0.10$\n- $h_{\\mathrm{crit}} = 0.60$\n\n将这些数值代入推导出的表达式中：\n$$ \\mathrm{DI}_{\\min} = 30 \\ln\\left(\\frac{0.95 - 0.10}{0.95 - 0.60}\\right) $$\n$$ \\mathrm{DI}_{\\min} = 30 \\ln\\left(\\frac{0.85}{0.35}\\right) $$\n$$ \\mathrm{DI}_{\\min} = 30 \\ln\\left(\\frac{17}{7}\\right) $$\n现在，我们计算其数值。\n$$ \\frac{17}{7} \\approx 2.4285714... $$\n$$ \\ln\\left(\\frac{17}{7}\\right) \\approx 0.88725459... $$\n$$ \\mathrm{DI}_{\\min} \\approx 30 \\times 0.88725459... $$\n$$ \\mathrm{DI}_{\\min} \\approx 26.6176378... $$\n题目要求答案保留三位有效数字。前三位有效数字是 $2$、$6$ 和 $6$。第四位数字是 $1$，因此舍去。\n$$ \\mathrm{DI}_{\\min} \\approx 26.6 $$\n单位是毫秒，与 $\\tau_{h}$ 的单位一致。", "answer": "$$\n\\boxed{26.6}\n$$", "id": "4818499"}, {"introduction": "最后的这项实践将细胞层面的电生理特性整合到组织水平，以理解折返 (reentry) 这一许多临床心律失常（如心房颤动）背后的核心机制。你将通过建立一个基于“波长”($\\lambda$)概念的计算模型，来探索心房纤维化等结构性重构是如何创造出足以维持危险折返环路的病理基质的。这项编程练习将让你亲身体验如何使用模型来预测心律失常的风险 [@problem_id:4818468]。", "problem": "您的任务是，基于对心房颤动的病理生理学理解，推导、实现并测试一个关于纤维化心房组织中折返波（rotor）形成与持续存在的准则。请从心脏电生理学的基础定义和经过充分检验的事实出发，不要依赖任何未从第一性原理证明的简化公式。此处，折返波定义为围绕功能性或解剖性障碍物循环的自我维持的折返性激动；在心房纤维化中，传导减慢和不应期异质性可以促成并稳定此类折返波。\n\n使用以下基本和核心定义：\n- 传导速度 $v$ 是激动波前在组织中传播的速度，单位为 $\\mathrm{cm/s}$。\n- 有效不应期 $T_{\\mathrm{ERP}}$ 是激动后组织不能被再次激动的最短时间，单位为 $\\mathrm{s}$。\n- 可兴奋波长 $\\lambda$ 是波前为避免与其不应尾相撞所需的最小空间范围，已知其为传导速度和有效不应期的乘积，$$\\lambda = v \\cdot T_{\\mathrm{ERP}}$$.\n- 围绕障碍物（解剖性或功能性）的闭合环路路径长度 $L$ 必须严格大于波长才能允许折返，即折返波的形成需要满足严格不等式 $$L > \\lambda$$；相等情况不会产生持续的折返，因为波前会遇到不应期组织。\n\n使用以下物理上合理的参数化来模拟心房纤维化和各向异性的影响：\n- 设 $R$ 为有效障碍物半径（单位 $\\mathrm{cm}$），$g$ 为一个无量纲的各向异性因子，它因纤维取向和结构异质性而延长了路径长度。闭合环路路径长度为 $$L = 2\\pi R \\cdot g$$, 使用弧度进行角度测量。\n- 设 $f \\in [0,1]$ 为纤维化分数，$\\beta$ 为一个无量纲的传导减速系数。有效传导速度为 $$v_{\\mathrm{eff}} = \\max\\!\\big(v_{\\min},\\; v_0 \\cdot (1 - \\beta f)\\big)$$, 其中 $v_0$ 是基线传导速度（单位 $\\mathrm{cm/s}$），$v_{\\min}$ 是一个为避免在高 $f$ 值时出现非物理负速度而设定的一个小的正数下界（单位 $\\mathrm{cm/s}$）。\n- 设 $\\sigma \\in [0,1]$ 为一个无量纲的离散幅度，表征不应期的异质性，$h$ 是一个无量纲的缩放因子，将离散幅度映射为沿环路遇到的最小局部不应期的有效缩短。有效不应期为 $$T_{\\mathrm{ERP,eff}} = T_0 \\cdot (1 - h \\sigma)$$, 其中 $T_0$ 是基线有效不应期（单位 $\\mathrm{s}$）。\n- 在纤维化和异质性条件下的可兴奋波长为 $$\\lambda_{\\mathrm{eff}} = v_{\\mathrm{eff}} \\cdot T_{\\mathrm{ERP,eff}}$$.\n\n基于以上基础，推导、论证并实现一个算法，用以计算可以围绕该环路容纳的同时存在、非重叠的折返波数量。一个折返波需要至少一个完整的波长，且该波长严格小于环路路径长度；当多个波长可以无重叠地容纳时，可能存在多个折返波。您的决策规则必须明确强制执行严格不等式 $L > \\lambda_{\\mathrm{eff}}$，并且在 $L \\le \\lambda_{\\mathrm{eff}}$ 时必须返回零。\n\n您的程序必须实现这一逻辑，并评估以下参数集测试套件，每个参数集指定为一个元组 $(R,\\; v_0,\\; T_0,\\; f,\\; \\beta,\\; g,\\; \\sigma,\\; h,\\; v_{\\min})$，单位如上定义。对于任何与角度相关的量，请使用弧度。对每种情况，计算折返波的整数数量。这些情况是：\n\n- 情况 $1$（常规“理想路径”）：($R=1.5\\,\\mathrm{cm}$, $v_0=60\\,\\mathrm{cm/s}$, $T_0=0.09\\,\\mathrm{s}$, $f=0.2$, $\\beta=0.7$, $g=1.1$, $\\sigma=0.2$, $h=0.5$, $v_{\\min}=20\\,\\mathrm{cm/s}$).\n- 情况 $2$（$L$ 等于 $\\lambda_{\\mathrm{eff}}$ 的边界条件）：($R=1.0\\,\\mathrm{cm}$, $v_0=60\\,\\mathrm{cm/s}$, $T_0=0.10472\\,\\mathrm{s}$, $f=0.0$, $\\beta=1.0$, $g=1.0$, $\\sigma=0.0$, $h=0.5$, $v_{\\min}=20\\,\\mathrm{cm/s}$).\n- 情况 $3$（大障碍物，低纤维化，预期有多个折返波）：($R=3.0\\,\\mathrm{cm}$, $v_0=70\\,\\mathrm{cm/s}$, $T_0=0.06\\,\\mathrm{s}$, $f=0.1$, $\\beta=0.5$, $g=1.0$, $\\sigma=0.1$, $h=0.3$, $v_{\\min}=20\\,\\mathrm{cm/s}$).\n- 情况 $4$（伴有传导上限的极端纤维化）：($R=1.0\\,\\mathrm{cm}$, $v_0=50\\,\\mathrm{cm/s}$, $T_0=0.08\\,\\mathrm{s}$, $f=0.95$, $\\beta=1.2$, $g=1.2$, $\\sigma=0.4$, $h=0.5$, $v_{\\min}=15\\,\\mathrm{cm/s}$).\n- 情况 $5$（小障碍物，无折返波）：($R=0.4\\,\\mathrm{cm}$, $v_0=60\\,\\mathrm{cm/s}$, $T_0=0.09\\,\\mathrm{s}$, $f=0.2$, $\\beta=0.7$, $g=1.0$, $\\sigma=0.2$, $h=0.5$, $v_{\\min}=20\\,\\mathrm{cm/s}$).\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result_1,result_2,\\dots]$），其中每个 $result_i$ 是对应测试用例的折返波整数数量。", "solution": "核心任务是推导并实现一个准则，用以在一个纤维化心房组织模型中计算可持续、非重叠的折返回路（折返波）的数量。推导过程必须遵循所提供的基本原理。\n\n单个折返回路形成并自我维持的基本条件是，闭合环路路径的长度 $L$ 必须严格大于可兴奋波长 $\\lambda$。波长 $\\lambda = v \\cdot T_{\\mathrm{ERP}}$ 代表动作电位波的物理长度，其中 $v$ 是传导速度，$T_{\\mathrm{ERP}}$ 是有效不应期。为了让一个波能够重新激动其出发点，它必须在时间 $t = L/v$ 内环绕一个长度为 $L$ 的回路。这个时间，被称为环绕时间，必须大于出发点组织的有效不应期 $T_{\\mathrm{ERP}}$。因此，$L/v > T_{\\mathrm{ERP}}$，可整理为 $L > v \\cdot T_{\\mathrm{ERP}}$，即 $L > \\lambda$。如果 $L \\le \\lambda$，波前在组织恢复之前返回到其出发点，发现组织处于不应期，从而使回路中断。因此，如果 $L \\le \\lambda$，则无法维持任何折返波。\n\n该问题将此情况扩展到存在多个非重叠折返波的场景。如果一个折返波需要的路径长度大于 $\\lambda$，那么 $N$ 个非重叠的折返波在同一总长度为 $L$ 的闭合环路上共存，将需要该路径能容纳 $N$ 个这样的波长。$N$ 个折返波所需的总长度为 $N \\cdot \\lambda$。为了使这 $N$ 个折返波可持续，这个所需长度不能超过可用路径长度 $L$。这给出了条件 $L \\ge N \\cdot \\lambda$。为了找到可能的最大折返波数量 $N_{\\max}$，我们寻求满足此不等式的最大整数 $N$。这由 $N \\le L/\\lambda$ 给出。因此，最大整数值为 $N_{\\max} = \\lfloor L / \\lambda \\rfloor$。\n\n我们必须将此与哪怕只有一个折返波也需要满足的严格不等式 $L > \\lambda$ 相协调。问题明确指出，“在 $L \\le \\lambda_{\\mathrm{eff}}$ 时它必须返回零。”简单应用 $\\lfloor L / \\lambda_{\\mathrm{eff}} \\rfloor$ 是不够的，因为如果 $L = \\lambda_{\\mathrm{eff}}$，该公式会得出 $\\lfloor 1 \\rfloor = 1$，这违反了给定规则。\n\n因此，正确的、有原则的逻辑是一个由两部分组成的准则：\n1. 首先，评估任何折返发生的首要条件：$L > \\lambda_{\\mathrm{eff}}$ 是否成立？\n2. 如果此条件为假（即 $L \\le \\lambda_{\\mathrm{eff}}$），则折返波数量 $N$ 为 $0$。\n3. 如果此条件为真（即 $L > \\lambda_{\\mathrm{eff}}$），则折返是可能的，最大非重叠折返波的数量是能够容纳在路径长度 $L$ 内的完整波长的数量。这可以正确地计算为 $N = \\lfloor L / \\lambda_{\\mathrm{eff}} \\rfloor$。\n\n这导出了针对给定参数集 $(R, v_0, T_0, f, \\beta, g, \\sigma, h, v_{\\min})$ 的以下形式化算法：\n\n步骤 1：计算有效路径长度 $L$。\n路径被建模为一个围绕有效半径为 $R$ 的障碍物的类椭圆环路，其各向异性因子为 $g$。\n$$L = 2\\pi R \\cdot g$$\n\n步骤 2：计算有效传导速度 $v_{\\mathrm{eff}}$。\n纤维化（分数 $f$）减慢传导，这通过一个从基线速度 $v_0$ 开始、系数为 $\\beta$ 的线性减少来建模。施加一个最小速度 $v_{\\min}$ 以防止非物理结果。\n$$v_{\\mathrm{eff}} = \\max\\!\\big(v_{\\min},\\; v_0 \\cdot (1 - \\beta f)\\big)$$\n\n步骤 3：计算有效不应期 $T_{\\mathrm{ERP,eff}}$。\n不应期的异质性（离散幅度 $\\sigma$）可以缩短沿路径遇到的局部不应期，这通过一个从基线周期 $T_0$ 开始、缩放因子为 $h$ 的线性减少来建模。\n$$T_{\\mathrm{ERP,eff}} = T_0 \\cdot (1 - h \\sigma)$$\n\n步骤 4：计算有效波长 $\\lambda_{\\mathrm{eff}}$。\n波长是有效速度和有效不应期的乘积。\n$$\\lambda_{\\mathrm{eff}} = v_{\\mathrm{eff}} \\cdot T_{\\mathrm{ERP,eff}}$$\n\n步骤 5：确定折返波的数量 $N$。\n应用推导出的两部分准则。\n$$N = \\begin{cases} \\lfloor L / \\lambda_{\\mathrm{eff}} \\rfloor  \\text{若 } L  \\lambda_{\\mathrm{eff}} \\\\ 0  \\text{若 } L \\le \\lambda_{\\mathrm{eff}} \\end{cases}$$\n\n此算法将被实现以评估所提供的测试用例。所有计算将使用浮点运算，直到最后将 $N$ 转换为整数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a criterion for rotor formation in a model of\n    atrial tissue with fibrosis, and evaluates it on a suite of test cases.\n    \"\"\"\n\n    # The test suite of parameter sets, each specified as a tuple:\n    # (R, v0, T0, f, beta, g, sigma, h, v_min)\n    test_cases = [\n        # Case 1 (general \"happy path\")\n        (1.5, 60.0, 0.09, 0.2, 0.7, 1.1, 0.2, 0.5, 20.0),\n        # Case 2 (boundary condition where L equals lambda_eff)\n        (1.0, 60.0, 0.10472, 0.0, 1.0, 1.0, 0.0, 0.5, 20.0),\n        # Case 3 (large obstacle, low fibrosis, multiple rotors expected)\n        (3.0, 70.0, 0.06, 0.1, 0.5, 1.0, 0.1, 0.3, 20.0),\n        # Case 4 (extreme fibrosis with conduction cap)\n        (1.0, 50.0, 0.08, 0.95, 1.2, 1.2, 0.4, 0.5, 15.0),\n        # Case 5 (small obstacle, no rotor)\n        (0.4, 60.0, 0.09, 0.2, 0.7, 1.0, 0.2, 0.5, 20.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R, v0, T0, f, beta, g, sigma, h, v_min = case\n\n        # Step 1: Calculate the effective path length L.\n        # L = 2 * pi * R * g\n        path_length = 2 * np.pi * R * g\n\n        # Step 2: Calculate the effective conduction velocity v_eff.\n        # v_eff = max(v_min, v0 * (1 - beta * f))\n        fibrotic_velocity = v0 * (1 - beta * f)\n        v_eff = max(v_min, fibrotic_velocity)\n\n        # Step 3: Calculate the effective refractory period T_ERP,eff.\n        # T_ERP,eff = T0 * (1 - h * sigma)\n        T_erp_eff = T0 * (1 - h * sigma)\n\n        # Step 4: Calculate the effective wavelength lambda_eff.\n        # lambda_eff = v_eff * T_ERP,eff\n        lambda_eff = v_eff * T_erp_eff\n\n        # Step 5: Determine the number of rotors, N, based on the derived criterion.\n        # N = floor(L / lambda_eff) if L  lambda_eff, else 0.\n        num_rotors = 0\n        if path_length  lambda_eff:\n            # If the path is long enough for at least one rotor, calculate\n            # how many full wavelengths can fit.\n            num_rotors = int(np.floor(path_length / lambda_eff))\n        \n        results.append(num_rotors)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4818468"}]}