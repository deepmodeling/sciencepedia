{"hands_on_practices": [{"introduction": "心脏细胞的电稳定性从根本上取决于其细胞膜两侧的离子平衡。本练习将使用能斯特方程（Nernst equation）——电生理学的基石——来探讨一个至关重要的临床情景：心肌缺血期间细胞外钾离子浓度升高如何改变细胞的静息电位。通过这项计算[@problem_id:4846970]，你将定量地理解为何这类离子变化会使心脏极易发生危险的心律失常。", "problem": "一名患有急性心肌缺血的患者在心室间质中出现细胞外钾累积。考虑单个心室肌细胞，其钾平衡电位主导静息膜电位。假设细胞内钾浓度 $[K^+]_{\\mathrm{i}}$ 保持在 $140\\ \\mathrm{mM}$ 不变，而细胞外钾浓度 $[K^+]_{\\mathrm{o}}$ 从 $4\\ \\mathrm{mM}$ 上升到 $8\\ \\mathrm{mM}$。温度为 $37^{\\circ}\\mathrm{C}$（即 $T = 310\\ \\mathrm{K}$）。在计算中使用以下常数：通用气体常数 $R = 8.314\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，法拉第常数 $F = 96485\\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$，以及钾的化合价 $z = +1$。 \n\n从单价离子的电化学平衡定义出发，并使用能斯特框架，计算当 $[K^+]_{\\mathrm{o}}$ 从 $4\\ \\mathrm{mM}$ 增加到 $8\\ \\mathrm{mM}$ 时，钾平衡电位 $\\Delta E_K$ 的变化量（最终值减去初始值）。然后，基于这一变化以及静息膜电位近似于 $E_K$ 的假设，预测静息膜电位（RMP）的移动方向，并简要推断其对心室心肌兴奋性和传导的可能影响。 \n\n将 $\\Delta E_K$ 的最终数值答案以毫伏为单位表示，并四舍五入到四位有效数字。", "solution": "该问题是有效的，因为它具有科学依据，表述清晰且客观。它提供了一个基于能斯特方程的标准电生理学情景，并包含了得出唯一解所需的所有必要参数和常数。\n\n离子在半透膜两侧的平衡电位由能斯特方程描述。对于钾离子（$K^+$），该方程为：\n$$E_K = \\frac{RT}{zF} \\ln\\left( \\frac{[K^+]_{\\mathrm{o}}}{[K^+]_{\\mathrm{i}}} \\right)$$\n其中：\n- $E_K$ 是以伏特（$V$）为单位的钾平衡电位。\n- $R$ 是通用气体常数，给定值为 $8.314\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- $T$ 是绝对温度，给定值为 $310\\ \\mathrm{K}$。\n- $z$ 是离子的化合价，对于钾离子（$K^+$）为 $+1$。\n- $F$ 是法拉第常数，给定值为 $96485\\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$。\n- $[K^+]_{\\mathrm{o}}$ 是细胞外钾浓度。\n- $[K^+]_{\\mathrm{i}}$ 是细胞内钾浓度。\n\n问题要求计算当细胞外钾浓度 $[K^+]_{\\mathrm{o}}$ 从初始值 $4\\ \\mathrm{mM}$ 上升到最终值 $8\\ \\mathrm{mM}$ 时，钾平衡电位 $\\Delta E_K$ 的变化量。细胞内浓度 $[K^+]_{\\mathrm{i}}$ 保持在 $140\\ \\mathrm{mM}$ 不变。\n\n设 $E_{K, \\text{initial}}$ 为 $[K^+]_{\\mathrm{o}} = 4\\ \\mathrm{mM}$ 时的电位，而 $E_{K, \\text{final}}$ 为 $[K^+]_{\\mathrm{o}} = 8\\ \\mathrm{mM}$ 时的电位。\n变化量 $\\Delta E_K$ 定义为：\n$$\\Delta E_K = E_{K, \\text{final}} - E_{K, \\text{initial}}$$\n将能斯特方程代入每一项：\n$$\\Delta E_K = \\left( \\frac{RT}{zF} \\ln\\left( \\frac{[K^+]_{\\mathrm{o, final}}}{[K^+]_{\\mathrm{i}}} \\right) \\right) - \\left( \\frac{RT}{zF} \\ln\\left( \\frac{[K^+]_{\\mathrm{o, initial}}}{[K^+]_{\\mathrm{i}}} \\right) \\right)$$\n将常数项 $\\frac{RT}{zF}$ 提取出来：\n$$\\Delta E_K = \\frac{RT}{zF} \\left( \\ln\\left( \\frac{[K^+]_{\\mathrm{o, final}}}{[K^+]_{\\mathrm{i}}} \\right) - \\ln\\left( \\frac{[K^+]_{\\mathrm{o, initial}}}{[K^+]_{\\mathrm{i}}} \\right) \\right)$$\n使用对数恒等式 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\\Delta E_K = \\frac{RT}{zF} \\ln\\left( \\frac{[K^+]_{\\mathrm{o, final}} / [K^+]_{\\mathrm{i}}}{[K^+]_{\\mathrm{o, initial}} / [K^+]_{\\mathrm{i}}} \\right)$$\n项 $[K^+]_{\\mathrm{i}}$ 被消去，表达式简化为：\n$$\\Delta E_K = \\frac{RT}{zF} \\ln\\left( \\frac{[K^+]_{\\mathrm{o, final}}}{[K^+]_{\\mathrm{o, initial}}} \\right)$$\n现在我们将给定值代入这个简化后的方程：\n- $R = 8.314\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $T = 310\\ \\mathrm{K}$\n- $z = 1$\n- $F = 96485\\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- $[K^+]_{\\mathrm{o, final}} = 8\\ \\mathrm{mM}$\n- $[K^+]_{\\mathrm{o, initial}} = 4\\ \\mathrm{mM}$\n\n$$\\Delta E_K = \\frac{(8.314\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (310\\ \\mathrm{K})}{(1) \\times (96485\\ \\mathrm{C}\\,\\mathrm{mol}^{-1})} \\ln\\left( \\frac{8\\ \\mathrm{mM}}{4\\ \\mathrm{mM}} \\right)$$\n$$\\Delta E_K = \\frac{2577.34}{96485}\\ \\mathrm{V} \\times \\ln(2)$$\n计算数值：\n$$\\Delta E_K \\approx (0.02671228\\ \\mathrm{V}) \\times (0.69314718)$$\n$$\\Delta E_K \\approx 0.0185153\\ \\mathrm{V}$$\n问题要求答案以毫伏（$mV$）为单位。要将伏特转换为毫伏，我们乘以 $1000$：\n$$\\Delta E_K \\approx 18.5153\\ \\mathrm{mV}$$\n四舍五入到四位有效数字，我们得到：\n$$\\Delta E_K \\approx 18.52\\ \\mathrm{mV}$$\n\n$\\Delta E_K$ 的正号表示钾平衡电位变得更不负（即去极化）。根据问题中静息膜电位（RMP）由 $E_K$ 主导并近似于 $E_K$ 的假设，RMP 也会向正方向移动，变得更不负。例如，如果初始 RMP 约为 $-90\\ \\mathrm{mV}$，则新的 RMP 将约为 $-90\\ \\mathrm{mV} + 18.52\\ \\mathrm{mV} = -71.48\\ \\mathrm{mV}$。\n\n这一变化对心肌细胞功能具有关键影响：\n1.  **RMP 移动方向**：RMP 向更不负或更去极化的电位移动。\n2.  **对兴奋性的影响**：RMP 现在更接近触发动作电位所需的阈电位。最初，这种接近意味着只需要一个较小的刺激就能使细胞去极化至阈值，从而增加了心肌细胞的兴奋性。这可能导致异位搏动和折返性心律失常，如室性心动过速。\n3.  **对传导的影响**：持续的去极化有第二个关键作用：它导致电压门控钠通道（$Na_v$）的稳态失活。一部分这些通道进入失活状态，无法通过随后的去极化而打开。由于可用的 $Na_v$ 通道减少，动作电位的上升速度（$0$ 期）显著下降。根据电缆理论，传导速度与动作电位的上升速率成正比。因此，较慢的上升速度导致传导速度减慢。在严重的高钾血症中，显著的 $Na_v$ 通道失活可使心肌变为不可兴奋，导致传导阻滞和心搏停止。这种传导减慢是高钾血症促进折返回路形成的关键机制，而折返回路可能恶化为心室颤动。\n\n总之，细胞外钾的升高使静息膜电位去极化，这具有双重效应：初期增加兴奋性，同时减慢传导速度，并可能导致兴奋性丧失。这两种效应都极易引发心律失常。", "answer": "$$\n\\boxed{18.52}\n$$", "id": "4846970"}, {"introduction": "从单个细胞的层面，我们现在转向组织层面。大多数持续性室性心动过速是由一种称为“折返”（reentry）的机制引起的，即电冲动在一个自我维持的环路中传播。本练习将介绍“电波长”（electrical wavelength）的概念，这是一个决定折返环路能否维持的关键参数[@problem_id:4846934]。通过计算电波长和所需的最小环路长度，你将掌握心脏电生理特性与解剖结构在心律失常形成过程中的关键相互作用。", "problem": "在一个用于模拟室性折返的均匀一维可兴奋心肌组织环中，假设传导速度是恒定的，等于 $\\text{CV}=0.3$ m/s，有效不应期是 $\\text{ERP}=200$ ms。电波长 $\\lambda$ 被定义为波前和波尾之间的最小空间间隔，它等于一个传播的脉冲在组织处于其有效不应期时行进的距离。仅使用运动学恒等式（行进距离等于速度乘以时间）以及有效不应期的定义，推导一个用 $\\text{CV}$ 和 $\\text{ERP}$ 表示 $\\lambda$ 的表达式，计算其数值，并且，基于环路中持续性折返的准则，即环路路径长度必须超过电波长，以便返回的波前遇到完全恢复的组织，推断出在这个理想化模型中维持持续性折返所需的最小环路路径长度。用米表示电波长和最小环路路径长度。报告你的最终数值，严格按照给定数据所隐含的精度，不要额外取整。", "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **模型**：一个均匀的一维可兴奋心肌组织环。\n-   **传导速度**：恒定，$\\text{CV} = 0.3 \\text{ m/s}$。\n-   **有效不应期**：$\\text{ERP} = 200 \\text{ ms}$。\n-   **电波长 ($\\lambda$) 的定义**：一个传播的脉冲在有效不应期内行进的距离。这明确地等同于“波前和波尾之间的最小空间间隔”。\n-   **支配性运动学恒等式**：行进距离等于速度乘以时间。\n-   **持续性折返的准则**：环路路径长度，我们记为 $L$，必须超过电波长 ($\\lambda$)。即 $L > \\lambda$。\n-   **目标**：\n    1.  推导用 $\\text{CV}$ 和 $\\text{ERP}$ 表示 $\\lambda$ 的表达式。\n    2.  计算 $\\lambda$ 的数值，单位为米。\n    3.  推断出维持持续性折返所需的最小环路路径长度 $L_{min}$，单位为米。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于心脏电生理学的基本原理。环形模型是一个用于研究折返性心律失常的标准（尽管是简化的）范式。传导速度、有效不应期和电波长的概念是该领域的核心。给定的数值（$\\text{CV} = 0.3 \\text{ m/s}$，$\\text{ERP} = 200 \\text{ ms}$）对于人类心室心肌是生理上现实的。折返准则 $L > \\lambda$ 是维持折返环路的一个公认条件。\n-   **适定性**：该问题是适定的。它提供了得出唯一、有意义解所需的所有数据和定义。目标陈述清晰，并且可以直接从前提中推导出来。\n-   **客观性**：该问题以精确、定量和无偏见的语言陈述。\n\n### 第3步：结论与行动\n该问题被认为是**有效的**，因为它是科学合理的、适定的和客观的。它不包含任何矛盾、歧义或不合理的假设。现在将构建解决方案。\n\n***\n\n### 解题推导\n\n该问题需要一个由三部分组成的解：推导电波长 $\\lambda$ 的表达式，计算其值，然后确定维持持续性折返所需的最小环路路径长度 $L_{min}$。\n\n**第1部分：电波长 ($\\lambda$) 表达式的推导**\n\n问题将电波长 $\\lambda$ 定义为一个传播的脉冲在心肌组织处于其有效不应期 $\\text{ERP}$ 时行进的距离。它还规定使用运动学恒等式，即距离等于速度乘以时间。\n\n让我们将变量映射到这个恒等式上：\n-   距离 = 电波长, $\\lambda$。\n-   速度 = 传导速度, $\\text{CV}$。\n-   时间 = 有效不应期, $\\text{ERP}$。\n\n将这些代入恒等式中，我们得到电波长的表达式：\n$$\n\\lambda = \\text{CV} \\times \\text{ERP}\n$$\n\n这就是所要求的用给定参数表示 $\\lambda$ 的解析表达式。\n\n**第2部分：电波长 ($\\lambda$) 的计算**\n\n我们已知传导速度和有效不应期的值：\n-   $\\text{CV} = 0.3 \\text{ m/s}$\n-   $\\text{ERP} = 200 \\text{ ms}$\n\n为确保计算中的量纲一致性，必须将有效不应期从毫秒 ($\\text{ms}$) 转换为秒 ($\\text{s}$)。\n$$\n\\text{ERP} = 200 \\text{ ms} = 200 \\times 10^{-3} \\text{ s} = 0.2 \\text{ s}\n$$\n\n现在，我们将数值代入推导出的 $\\lambda$ 表达式中：\n$$\n\\lambda = (0.3 \\text{ m/s}) \\times (0.2 \\text{ s})\n$$\n$$\n\\lambda = 0.06 \\text{ m}\n$$\n电波长为 $0.06$ 米。\n\n**第3部分：最小环路路径长度 ($L_{min}$) 的推断**\n\n问题给出了持续性折返的准则：环路路径长度 $L$ 必须超过电波长 $\\lambda$。这可以写成一个不等式：\n$$\nL > \\lambda\n$$\n\n这个条件是必要的，因为要使折返波在环路周围持续传播，波前必须遇到从前一次兴奋中完全恢复的组织。波的“尾部”，即组织处于不应期的部分，其长度等于波长 $\\lambda$。因此，环路的总长度 $L$ 必须大于这个不应期尾部长度 $\\lambda$，以便为波前重新兴奋提供一个可兴奋组织的“间隙”。\n\n问题要求的是维持持续性折返所需的*最小*环路路径长度。在数学上，所有能够维持折返的可能路径长度 $L$ 的集合是开区间 $(\\lambda, \\infty)$。这个集合的下确界，或最大下界，是 $\\lambda$。在物理学和生理学的背景下，这个边界值被认为是临界或最小所需长度。当路径长度恰好为 $\\lambda$ 时，波前将在某一点刚脱离其不应期时到达该点，这代表了临界情况。任何比 $\\lambda$ 大无穷小的长度都允许持续性折返。因此，我们将最小所需路径长度 $L_{min}$ 定义为这个临界值。\n$$\nL_{min} = \\lambda\n$$\n\n使用在第2部分计算出的 $\\lambda$ 的值：\n$$\nL_{min} = 0.06 \\text{ m}\n$$\n在此模型中，维持持续性折返所需的最小环路路径长度为 $0.06$ 米。所要求的两个值是电波长 $\\lambda = 0.06$ 米，和最小环路路径长度 $L_{min} = 0.06$ 米。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.06  0.06 \\end{pmatrix}}\n$$", "id": "4846934"}, {"introduction": "最后的这项练习将前面的概念整合到一个强大的计算模型中，这反映了心血管研究和药理学的现代方法。你将通过编程来模拟遗传缺陷（如2型长QT综合征）、药物作用以及低钾血症等条件如何危险地延长动作电位时程[@problem_id:4846983]。本练习旨在展示如何将基本原理结合起来，构建有助于我们理解疾病机制和评估心律失常风险的预测工具。", "problem": "要求您编写一个完整、可运行的程序，该程序模拟降低快速延迟整流钾电流（$I_{Kr}$）如何影响心室动作电位时程和心电图QT间期，并特别关注2型长QT综合征（LQT2）中的低钾血症。计算必须以标准电生理学为基础，使用膜方程和能斯特方程，并附有科学合理的参数和明确的单位。\n\n推导基于以下核心关系和定义：\n- 膜电压遵循电容定律 $C_m \\, dV/dt = -I_{\\mathrm{ion}}$，其中 $C_m$ 是单位面积的膜电容，单位为 $\\mathrm{F}/\\mathrm{cm}^2$，$I_{\\mathrm{ion}}$ 是总离子电流密度，单位为 $\\mathrm{A}/\\mathrm{cm}^2$。\n- 在复极化阶段（从平台期到静息期），通过一个有效的线性电导来近似净复极化离子电流密度：$I_{\\mathrm{ion}}(V) \\approx G_{\\mathrm{eff}} \\, (V - V_{\\mathrm{rest}})$，其中 $G_{\\mathrm{eff}}$ 是有效复极化电导，单位为 $\\mathrm{S}/\\mathrm{cm}^2$，$V_{\\mathrm{rest}}$ 是静息膜电位，单位为 $\\mathrm{V}$。\n- 这产生一个一阶线性常微分方程 $dV/dt = -(G_{\\mathrm{eff}}/C_m) (V - V_{\\mathrm{rest}})$，其解为 $V(t) = V_{\\mathrm{rest}} + (V(0) - V_{\\mathrm{rest}}) \\, e^{-t/\\tau}$，其中复极化时间常数 $\\tau = C_m / G_{\\mathrm{eff}}$，单位为 $\\mathrm{s}$。\n- 将复极化90%的动作电位时程（$\\mathrm{APD}_{90}$）定义为动作电位幅度降至静息电位以上剩余10%所需的时间。对于指数解，$\\mathrm{APD}_{90} = \\tau \\, \\ln(10)$，以秒为单位。\n- 快速延迟整流钾电导被建模为 $G_{Kr,\\mathrm{eff}} = G_{Kr,\\mathrm{base}} \\cdot f_{\\mathrm{LQT2}} \\cdot f_{\\mathrm{drug}} \\cdot \\phi([K]_o) \\cdot D([K]_o)$，其中：\n  - $G_{Kr,\\mathrm{base}}$ 是基线 $I_{Kr}$ 电导，单位为 $\\mathrm{S}/\\mathrm{cm}^2$，\n  - $f_{\\mathrm{LQT2}} \\in (0,1]$ 代表2型长QT综合征（LQT2）中的先天性分数性降低，\n  - $f_{\\mathrm{drug}} \\in (0,1]$ 代表药物阻断引起的分数性降低（例如，$0.5$ 表示 $50\\%$ 的阻断），\n  - $\\phi([K]_o)$ 表示通道对细胞外钾离子浓度 $[K]_o$（单位为 $\\mathrm{mM}$）的依赖性；使用 $\\phi([K]_o) = \\sqrt{[K]_o / 5}$ 作为正常条件下简化且生理上合理的标度，\n  - $D([K]_o)$ 表示通过钾反转电位 $E_K$ 引起的驱动力变化；使用 $D([K]_o) = \\lvert V_{\\mathrm{plateau}} - E_K([K]_o) \\rvert / \\lvert V_{\\mathrm{plateau}} - E_K(5) \\rvert$。\n- 使用能斯特方程 $E_K = (RT/F)\\,\\ln\\left([K]_o/[K]_i\\right)$ 计算钾反转电位 $E_K$（单位为 $\\mathrm{V}$），其中 $R$ 是通用气体常数，单位为 $\\mathrm{J}/(\\mathrm{mol}\\cdot\\mathrm{K})$，$T$ 是绝对温度，单位为 $\\mathrm{K}$，$F$ 是法拉第常数，单位为 $\\mathrm{C}/\\mathrm{mol}$，$[K]_i$ 是细胞内钾离子浓度，单位为 $\\mathrm{mM}$。\n\n假设以下科学上合理的常数：\n- $C_m = 1.0 \\times 10^{-6}\\,\\mathrm{F}/\\mathrm{cm}^2$,\n- $V_{\\mathrm{rest}} = -85 \\times 10^{-3}\\,\\mathrm{V}$,\n- $V_{\\mathrm{plateau}} = 0\\,\\mathrm{V}$,\n- $[K]_i = 140\\,\\mathrm{mM}$,\n- $R = 8.314\\,\\mathrm{J}/(\\mathrm{mol}\\cdot\\mathrm{K})$,\n- $T = 310\\,\\mathrm{K}$,\n- $F = 96485\\,\\mathrm{C}/\\mathrm{mol}$,\n- 代表其他电流的背景复极化电导 $G_{\\mathrm{rest}} = 3.0 \\times 10^{-6}\\,\\mathrm{S}/\\mathrm{cm}^2$,\n- 平台期平均的 $I_{Kr}$ 激活分数 $\\bar{x}_{Kr} = 0.6$ (无量纲)。\n- 将有效复极化电导定义为 $G_{\\mathrm{eff}} = G_{\\mathrm{rest}} + \\bar{x}_{Kr}\\,G_{Kr,\\mathrm{eff}}$。\n\n校准要求：\n- 校准 $G_{Kr,\\mathrm{base}}$，使得在正常基线条件（$f_{\\mathrm{LQT2}}=1$，$f_{\\mathrm{drug}}=1$，$[K]_o=5\\,\\mathrm{mM}$）下，模型产生 $\\mathrm{APD}_{90} = 0.280\\,\\mathrm{s}$。这意味着 $G_{\\mathrm{eff,base}} = C_m / (\\mathrm{APD}_{90}/\\ln 10)$，因此 $G_{Kr,\\mathrm{base}} = \\left(G_{\\mathrm{eff,base}} - G_{\\mathrm{rest}}\\right)/\\bar{x}_{Kr}$。\n- 使用固定的加性偏移量预测QT间期，以解释非复极化分量（QRS波群和其他间期）。使用 $QT = \\mathrm{APD}_{90} + 0.120\\,\\mathrm{s}$，这在基线时产生 $QT=0.400\\,\\mathrm{s}$。\n\n任务：\n- 实现上述模型，为以下参数集 $( [K]_o\\,\\mathrm{mM}, f_{\\mathrm{LQT2}}, f_{\\mathrm{drug}} )$ 的测试套件计算 $\\mathrm{APD}_{90}$（以秒为单位）和QT（以秒为单位）：\n  1. $(5.0,\\;1.0,\\;1.0)$ 基线正常，\n  2. $(5.0,\\;1.0,\\;0.5)$ 正常情况下 $50\\%$ $I_{Kr}$ 被阻断，\n  3. $(5.0,\\;0.5,\\;1.0)$ 在正常 $[K]_o$ 下，LQT2伴有 $50\\%$ 的先天性降低，\n  4. $(3.0,\\;0.5,\\;1.0)$ 轻度低钾血症下的LQT2，\n  5. $(2.5,\\;0.5,\\;0.5)$ 中度低钾血症合并 $50\\%$ 药物阻断下的LQT2。\n- 对于每个测试用例，返回一个包含两个浮点数 $[\\mathrm{APD}_{90}, QT]$ 的列表，两者均以秒表示并四舍五入到三位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例的结果，并且本身必须是一个双元素列表。例如：“[[apd1,qt1],[apd2,qt2],...]”。\n\n不允许外部输入。程序必须是自包含的，并且可以“按原样”执行。", "solution": "该问题要求开发一个计算模型，以基于简化的心室肌细胞复极化模型来预测动作电位时程（$\\mathrm{APD}_{90}$）和心电图QT间期。该模型关注快速延迟整流钾电流（$I_{Kr}$）的作用、其在2型长QT综合征（LQT2）中和药物阻断下的减少，以及其受细胞外钾离子浓度（$[K]_o$）的调节，尤其是在低钾血症的情况下。\n\n该模型基于以下物理和生理学原理。\n\n膜电位 $V$ 随时间 $t$ 的变化由膜电容 $C_m$ 和总离子电流密度 $I_{\\mathrm{ion}}$ 决定：\n$$C_m \\frac{dV}{dt} = -I_{\\mathrm{ion}}$$\n在第3阶段复极化期间（从平台期到静息期），主要是外向（复极化）的净离子电流被近似为电压的线性函数：\n$$I_{\\mathrm{ion}}(V) \\approx G_{\\mathrm{eff}} (V - V_{\\mathrm{rest}})$$\n其中 $G_{\\mathrm{eff}}$ 是有效膜电导，$V_{\\mathrm{rest}}$ 是静息膜电位。将此代入膜方程，得到一个一阶线性常微分方程：\n$$\\frac{dV}{dt} = -\\frac{G_{\\mathrm{eff}}}{C_m} (V - V_{\\mathrm{rest}})$$\n该常微分方程的解，从平台期电位 $V(0) = V_{\\mathrm{plateau}}$ 开始，是朝向 $V_{\\mathrm{rest}}$ 的指数衰减：\n$$V(t) = V_{\\mathrm{rest}} + (V_{\\mathrm{plateau}} - V_{\\mathrm{rest}}) e^{-t/\\tau}$$\n复极化的特征时间常数 $\\tau$ 由下式给出：\n$$\\tau = \\frac{C_m}{G_{\\mathrm{eff}}}$$\n复极化90%的动作电位时程（$\\mathrm{APD}_{90}$）被定义为电位下降到其静息电位以上峰值幅度10%所需的时间。这对应于 $V(\\mathrm{APD}_{90}) = V_{\\mathrm{rest}} + 0.1 \\cdot (V_{\\mathrm{plateau}} - V_{\\mathrm{rest}})$。将其代入 $V(t)$ 的解并求解时间可得：\n$$\\mathrm{APD}_{90} = \\tau \\ln(10)$$\n总有效电导 $G_{\\mathrm{eff}}$ 被建模为固定背景电导 $G_{\\mathrm{rest}}$ 与在平台期激活的 $I_{Kr}$ 电流贡献之和：\n$$G_{\\mathrm{eff}} = G_{\\mathrm{rest}} + \\bar{x}_{Kr} G_{Kr,\\mathrm{eff}}$$\n其中 $\\bar{x}_{Kr}$ 是 $I_{Kr}$ 通道的平均激活分数，$G_{Kr,\\mathrm{eff}}$ 是 $I_{Kr}$ 电流的有效电导。$G_{Kr,\\mathrm{eff}}$ 受几个因素的调节：\n$$G_{Kr,\\mathrm{eff}} = G_{Kr,\\mathrm{base}} \\cdot f_{\\mathrm{LQT2}} \\cdot f_{\\mathrm{drug}} \\cdot \\phi([K]_o) \\cdot D([K]_o)$$\n此处，$G_{Kr,\\mathrm{base}}$ 是一个基线电导，$f_{\\mathrm{LQT2}}$ 和 $f_{\\mathrm{drug}}$ 分别是由于遗传缺陷和药物阻断引起的分数性降低。项 $\\phi([K]_o)$ 和 $D([K]_o)$ 说明了对细胞外钾离子浓度 $[K]_o$ 的复杂依赖性。\n项 $\\phi([K]_o)$ 模拟了 $[K]_o$ 对通道渗透性的直接影响：\n$$\\phi([K]_o) = \\sqrt{\\frac{[K]_o}{5}}$$ 其中 $[K]_o$ 的单位是 $\\mathrm{mM}$，参考浓度是 $5\\,\\mathrm{mM}$。\n项 $D([K]_o)$ 说明了钾离子上电驱动力的变化，在这个简化模型中，该变化被并入有效电导中。它被定义为在给定 $[K]_o$ 下的驱动力与在参考浓度 $5\\,\\mathrm{mM}$ 下的驱动力之比：\n$$D([K]_o) = \\frac{\\lvert V_{\\mathrm{plateau}} - E_K([K]_o) \\rvert}{\\lvert V_{\\mathrm{plateau}} - E_K(5) \\rvert}$$\n钾反转电位 $E_K$ 使用能斯特方程计算：\n$$E_K = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o}{[K]_i}\\right)$$\n其中 $R$ 是气体常数，$T$ 是绝对温度，$F$ 是法拉第常数，$[K]_i$ 是细胞内钾离子浓度。\n\n模型必须首先被校准以找到 $G_{Kr,\\mathrm{base}}$ 的值。这是通过使用指定的基线条件完成的：$f_{\\mathrm{LQT2}}=1$，$f_{\\mathrm{drug}}=1$，$[K]_o=5\\,\\mathrm{mM}$，以及目标 $\\mathrm{APD}_{90} = 0.280\\,\\mathrm{s}$。\n1.  计算基线时间常数 $\\tau_{\\mathrm{base}} = \\mathrm{APD}_{90,\\mathrm{base}} / \\ln(10) = 0.280 / \\ln(10)$。\n2.  计算基线有效电导 $G_{\\mathrm{eff,base}} = C_m / \\tau_{\\mathrm{base}}$。\n3.  在基线条件下，$[K]_o=5\\,\\mathrm{mM}$，所以 $\\phi(5) = 1$ 且 $D(5) = 1$。基线有效 $I_{Kr}$ 电导即为 $G_{Kr,\\mathrm{eff,base}} = G_{Kr,\\mathrm{base}}$。\n4.  使用关系式 $G_{\\mathrm{eff,base}} = G_{\\mathrm{rest}} + \\bar{x}_{Kr} G_{Kr,\\mathrm{base}}$ 求解 $G_{Kr,\\mathrm{base}}$：\n    $$G_{Kr,\\mathrm{base}} = \\frac{G_{\\mathrm{eff,base}} - G_{\\mathrm{rest}}}{\\bar{x}_{Kr}}$$\n\n有了校准后的 $G_{Kr,\\mathrm{base}}$，我们现在可以为任何给定的参数集 $([K]_o, f_{\\mathrm{LQT2}}, f_{\\mathrm{drug}})$ 计算 $\\mathrm{APD}_{90}$。每个测试用例的计算过程如下：\n1.  使用能斯特方程计算 $E_K([K]_o)$。\n2.  计算调制因子 $\\phi([K]_o)$ 和 $D([K]_o)$。注意 $E_K(5)$ 是计算 $D([K]_o)$ 所需的常数。\n3.  使用其完整定义计算 $G_{Kr,\\mathrm{eff}}$。\n4.  计算总有效电导 $G_{\\mathrm{eff}}$。\n5.  计算复极化时间常数 $\\tau = C_m / G_{\\mathrm{eff}}$。\n6.  计算 $\\mathrm{APD}_{90} = \\tau \\ln(10)$。\n7.  使用给定的线性关系计算QT间期：$QT = \\mathrm{APD}_{90} + 0.120\\,\\mathrm{s}$。\n8.  最终结果 $\\mathrm{APD}_{90}$ 和 $QT$ 四舍五入到三位小数。\n\n该过程将为每个指定的测试用例实施。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes APD90 and QT interval based on a simplified electrophysiology model.\n    \"\"\"\n\n    # Define constants with units as provided in the problem\n    C_m = 1.0e-6  # Membrane capacitance (F/cm^2)\n    V_rest = -85.0e-3  # Resting potential (V)\n    V_plateau = 0.0  # Plateau potential (V)\n    K_i = 140.0  # Intracellular potassium concentration (mM)\n    R = 8.314  # Universal gas constant (J/(mol*K))\n    T = 310.0  # Absolute temperature (K)\n    F = 96485.0  # Faraday's constant (C/mol)\n    G_rest = 3.0e-6  # Background repolarizing conductance (S/cm^2)\n    x_Kr_bar = 0.6  # Plateau-averaged IKr activation fraction (dimensionless)\n    \n    # Baseline condition values for calibration\n    APD90_base = 0.280  # Baseline APD90 (s)\n    K_o_base = 5.0  # Baseline extracellular potassium (mM)\n    \n    # QT interval offset\n    QT_offset = 0.120 # (s)\n\n    # Pre-compute useful constants\n    ln_10 = np.log(10)\n    RT_over_F = R * T / F  # Thermal voltage (V)\n\n    # --- Calibration Step: Calculate G_Kr_base ---\n    \n    # 1. Calculate baseline time constant\n    tau_base = APD90_base / ln_10\n    \n    # 2. Calculate baseline effective conductance\n    G_eff_base = C_m / tau_base\n    \n    # 3. Under baseline conditions, f_LQT2=1, f_drug=1, phi(K_o=5)=1, D(K_o=5)=1.\n    #    The equation for G_eff is: G_eff_base = G_rest + x_Kr_bar * G_Kr_base\n    \n    # 4. Solve for G_Kr_base\n    G_Kr_base = (G_eff_base - G_rest) / x_Kr_bar\n\n    # Define test cases: ([K]_o in mM, f_LQT2, f_drug)\n    test_cases = [\n        (5.0, 1.0, 1.0),  # 1. Baseline normal\n        (5.0, 1.0, 0.5),  # 2. Normal with 50% IKr blockade\n        (5.0, 0.5, 1.0),  # 3. LQT2 with 50% congenital reduction\n        (3.0, 0.5, 1.0),  # 4. LQT2 under mild hypokalemia\n        (2.5, 0.5, 0.5),  # 5. LQT2 under moderate hypokalemia and 50% drug blockade\n    ]\n\n    results = []\n\n    # Pre-calculate E_K at baseline K_o for the D([K]_o) factor\n    E_K_base = RT_over_F * np.log(K_o_base / K_i)\n    driving_force_base = abs(V_plateau - E_K_base)\n\n    for case in test_cases:\n        K_o, f_LQT2, f_drug = case\n\n        # --- Calculation for each test case ---\n        \n        # 1. Calculate E_K for the current K_o\n        E_K = RT_over_F * np.log(K_o / K_i)\n        \n        # 2. Calculate modulation factors phi and D\n        phi_K_o = np.sqrt(K_o / K_o_base)\n        driving_force_K_o = abs(V_plateau - E_K)\n        D_K_o = driving_force_K_o / driving_force_base\n        \n        # 3. Calculate effective IKr conductance\n        G_Kr_eff = G_Kr_base * f_LQT2 * f_drug * phi_K_o * D_K_o\n        \n        # 4. Calculate total effective conductance\n        G_eff = G_rest + x_Kr_bar * G_Kr_eff\n        \n        # 5. Calculate repolarization time constant\n        tau = C_m / G_eff\n        \n        # 6. Calculate APD90\n        apd90 = tau * ln_10\n        \n        # 7. Calculate QT interval\n        qt = apd90 + QT_offset\n        \n        # Append rounded results\n        results.append([round(apd90, 3), round(qt, 3)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4846983"}]}