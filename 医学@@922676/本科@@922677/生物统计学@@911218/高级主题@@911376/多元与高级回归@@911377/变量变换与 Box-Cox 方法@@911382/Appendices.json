{"hands_on_practices": [{"introduction": "变量变换的一个核心目标是稳定方差，使得数据在不同均值水平下具有相似的离散程度。本练习将引导你使用“德尔塔方法”（delta method），这是一个来自微积分和统计学的强大工具，来从理论上证明为什么平方根变换是处理泊松计数数据的正确选择。通过这个推导，你将理解数据变换背后深刻的数学原理，而不仅仅是记忆规则。[@problem_id:4965046]", "problem": "一位生物统计学家将每个受试者的事件计数建模为泊松随机变量 $Y$，其均值为 $ \\mu > 0 $，因此 $ \\mathbb{E}[Y] = \\mu $ 且 $ \\operatorname{Var}(Y) = \\mu $。为了满足线性建模中要求方差在不同 $ \\mu $ 水平上近似恒定的假设，该生物统计学家考虑使用平方根变换 $ g(Y) = \\sqrt{Y} $，这是Box–Cox变换族的一个特例。请使用一阶泰勒展开（即delta方法）推导 $ g(Y) $ 关于 $ \\mu $ 的近似方差，并确定该变换是否能稳定方差，即主阶近似值不依赖于 $ \\mu $。请以单个精确常数的形式给出近似方差。无需四舍五入，不涉及单位。", "solution": "问题是要求使用一阶泰勒展开（delta方法）推导泊松分布随机变量的平方根变换的近似方差，并确定此变换是否具有方差稳定性。\n\n该问题陈述已经过验证，是合理的。这是一个定义明确的生物统计学问题，具有科学依据且内部一致。\n\n设 $Y$ 是一个表示事件计数的随机变量。问题陈述指出 $Y$ 服从均值为 $\\mu > 0$ 的泊松分布。泊松分布的关键性质是其期望和方差：\n$$ \\mathbb{E}[Y] = \\mu $$\n$$ \\operatorname{Var}(Y) = \\mu $$\n目标是分析新随机变量 $Z = g(Y)$ 的方差，其中变换由 $g(y) = \\sqrt{y}$ 给出。\n\n我们将使用delta方法，该方法基于函数 $g(Y)$ 在 $Y$ 的均值 $\\mu$ 附近的一阶泰勒级数展开。展开式为：\n$$ g(Y) \\approx g(\\mu) + g'(\\mu)(Y - \\mu) $$\n这里，$g'(\\mu)$ 是 $g(y)$ 关于 $y$ 的一阶导数在 $y = \\mu$ 处的值。\n\n这个 $g(Y)$ 的线性近似的方差被用来近似 $g(Y)$ 本身的方差。利用方差的性质，即对于常数 $a$ 和 $b$，有 $\\operatorname{Var}(aX + b) = a^2 \\operatorname{Var}(X)$，我们得到：\n$$ \\operatorname{Var}(g(Y)) \\approx \\operatorname{Var}(g(\\mu) + g'(\\mu)(Y - \\mu)) $$\n由于 $g(\\mu)$ 和 $g'(\\mu)$ 是关于随机变量 $Y$ 的常数，项 $g(\\mu)$ 对 方差没有贡献。因此，\n$$ \\operatorname{Var}(g(Y)) \\approx \\operatorname{Var}(g'(\\mu)(Y - \\mu)) = [g'(\\mu)]^2 \\operatorname{Var}(Y - \\mu) $$\n此外，由于对任意常数 $c$ 都有 $\\operatorname{Var}(Y - c) = \\operatorname{Var}(Y)$，我们得到delta方法方差近似的一般公式：\n$$ \\operatorname{Var}(g(Y)) \\approx [g'(\\mu)]^2 \\operatorname{Var}(Y) $$\n\n现在，我们将此公式应用于具体问题。\n变换为 $g(y) = \\sqrt{y} = y^{1/2}$。\n$g(y)$ 的一阶导数是：\n$$ g'(y) = \\frac{d}{dy}(y^{1/2}) = \\frac{1}{2} y^{-1/2} = \\frac{1}{2\\sqrt{y}} $$\n我们在 $Y$ 的均值 $y = \\mu$ 处计算该导数：\n$$ g'(\\mu) = \\frac{1}{2\\sqrt{\\mu}} $$\n我们已知对于泊松分布，$\\operatorname{Var}(Y) = \\mu$。将这些部分代入delta方法的公式中：\n$$ \\operatorname{Var}(\\sqrt{Y}) \\approx [g'(\\mu)]^2 \\operatorname{Var}(Y) = \\left( \\frac{1}{2\\sqrt{\\mu}} \\right)^2 \\cdot \\mu $$\n现在，我们简化表达式：\n$$ \\operatorname{Var}(\\sqrt{Y}) \\approx \\left( \\frac{1}{4\\mu} \\right) \\cdot \\mu $$\n$$ \\operatorname{Var}(\\sqrt{Y}) \\approx \\frac{\\mu}{4\\mu} = \\frac{1}{4} $$\n\n这个一阶近似的结果是，变换后变量 $\\sqrt{Y}$ 的方差近似为 $\\frac{1}{4}$。\n如果变换后变量的方差近似为常数，即它不依赖于原始变量的均值 $\\mu$，则称该变换是方差稳定的。在本例中，近似方差是常数 $\\frac{1}{4}$，它与 $\\mu$ 无关。因此，平方根变换 $g(Y) = \\sqrt{Y}$ 对于泊松分布是一种方差稳定变换，至少在delta方法提供的一阶近似下是如此。\n\n问题要求以单个精确常数的形式给出近似方差。这个值是 $\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "4965046"}, {"introduction": "理论需要联系实际，Box-Cox变换并非纯粹的抽象概念，它在儿科生长图表（LMS方法）等关键领域有着重要应用。这个练习将理论付诸实践，向你展示如何利用给定的LMS参数（$L$, $M$, $S$）来标准化一个实际的测量值。通过完成这个计算，你将学会如何将一个原始数据点转换为具有临床意义的z分数，从而更好地理解其在群体中的相对位置。[@problem_id:5216265]", "problem": "一位儿科临床医生正在使用基于 Lambda-Mu-Sigma (LMS) 方法的世界卫生组织 (WHO) 生长标准来评估一名儿童。LMS 方法将给定年龄的人体测量指标 $Y$ 建模为：经过一个由三个特定年龄和性别的参数（Box-Cox 幂 $L$、中位数 $M$ 和广义变异系数 $S$）控制的 Box-Cox 族变换后，近似服从正态分布。标准化值被解释为 $z$ 分数，它表示观测值与特定年龄和性别的参考值相差的标准差倍数。请仅从“关于参考值 $M$ 对 $Y$ 进行的 Box-Cox 变换可线性地重新调整偏度和离散度，以近似一个标准正态变量”这一基本定义出发，推导出适当的标准化公式，并计算一名年龄为 $24$ 个月、体重为 $y = 11.8$ 公斤的儿童的年龄别体重 $z$ 分数，已知该年龄和性别的 LMS 参数为 $L = -0.1$，$M = 12.5$ 和 $S = 0.09$。请以无单位的纯数字形式提供最终数值答案，并四舍五入到四位有效数字。", "solution": "该问题陈述具有科学依据、内容完备且提法得当。Lambda-Mu-Sigma (LMS) 方法是世界卫生组织 (WHO) 用于制定生长曲线图的一种标准且有详细记录的统计技术。计算所需的所有参数和数据均已提供，不存在内部矛盾或不科学的前提。因此，该问题被视为有效，并将提供解答。\n\n本任务要求从 LMS 方法的基本原理出发，推导出标准化 $z$ 分数的公式，然后用该公式计算一个具体值。LMS 方法假定，在特定年龄下，给定的人体测量指标 $Y$ 可以被转换成一个服从标准正态分布 $Z \\sim N(0, 1)$ 的变量。该转换基于 Box-Cox 幂变换，并涉及三个参数：中位数 $M$、广义变异系数 $S$ 和 Box-Cox 幂参数 $L$。\n\n推导过程分三步进行：\n1.  **处理尺度和位置**：首先用特定年龄和性别下的中位数 $M$ 对测量值 $Y$ 进行缩放。这是通过计算比率 $\\frac{Y}{M}$ 来实现的。这一步使得测量值与其绝对尺度无关，并将其中心调整到 $1$。\n\n2.  **处理偏度**：使用 Box-Cox 变换对 $\\frac{Y}{M}$ 的偏态分布进行正态化处理。对于一个变量 $X$，其带有幂 $\\lambda$ 的 Box-Cox 变换定义如下：\n    $$ T(X; \\lambda) = \\begin{cases} \\frac{X^\\lambda - 1}{\\lambda}  & \\text{if } \\lambda \\neq 0 \\\\ \\ln(X)  & \\text{if } \\lambda = 0 \\end{cases} $$\n    当 $\\lambda=0$ 时的情形由极限 $\\lim_{\\lambda \\to 0} \\frac{X^\\lambda - 1}{\\lambda} = \\ln(X)$ 推导得出。在 LMS 方法中，该幂由 $L$ 表示。将此变换应用于缩放后的测量值 $\\frac{Y}{M}$，我们得到转换后的变量，称之为 $Y_{T}$：\n    $$ Y_{T} = \\frac{\\left(\\frac{Y}{M}\\right)^L - 1}{L} \\quad (\\text{for } L \\neq 0) $$\n    此变换旨在生成一个变量 $Y_T$，该变量近似服从均值约为 $0$ 的正态分布。\n\n3.  **处理离散度（标准化）**：问题陈述指出，最终的标准化值是一个 $z$ 分数，根据定义，其标准差必须为 $1$。转换后的变量 $Y_T$ 的标准差由参数 $S$（广义变异系数）给出。为了将 $Y_T$ 标准化为一个标准差为 $1$ 的变量 $Z$，我们必须将 $Y_T$ 除以其标准差 $S$。\n    $$ Z = \\frac{Y_T}{\\text{std.dev}(Y_T)} = \\frac{Y_T}{S} $$\n    代入 $Y_T$ 的表达式，我们推导出在 $L \\neq 0$ 的情况下 $z$ 分数的公式：\n    $$ Z = \\frac{\\frac{\\left(\\frac{Y}{M}\\right)^L - 1}{L}}{S} = \\frac{\\left(\\frac{Y}{M}\\right)^L - 1}{LS} $$\n    对于 $L=0$ 的特殊情况，变换是对数变换，公式变为：\n    $$ Z = \\frac{\\ln\\left(\\frac{Y}{M}\\right)}{S} $$\n推导现已完成。我们可以使用所提供的数据进行计算。\n\n给定值为：\n-   实际体重：$y = 11.8$ 公斤\n-   特定年龄和性别的中位数体重：$M = 12.5$\n-   特定年龄和性别的 Box-Cox 幂：$L = -0.1$\n-   特定年龄和性别的广义变异系数：$S = 0.09$\n\n由于 $L = -0.1 \\neq 0$，我们使用第一个推导出的公式：\n$$ Z = \\frac{\\left(\\frac{y}{M}\\right)^L - 1}{LS} $$\n将给定值代入公式：\n$$ Z = \\frac{\\left(\\frac{11.8}{12.5}\\right)^{-0.1} - 1}{(-0.1)(0.09)} $$\n首先，计算比率 $\\frac{y}{M}$：\n$$ \\frac{11.8}{12.5} = 0.944 $$\n现在，将此值代回 $Z$ 的方程中：\n$$ Z = \\frac{(0.944)^{-0.1} - 1}{-0.009} $$\n接下来，我们计算分子中的项。幂项 $(0.944)^{-0.1}$ 的计算方式如下：\n$$ (0.944)^{-0.1} = \\exp(-0.1 \\times \\ln(0.944)) $$\n$$ \\ln(0.944) \\approx -0.0576352 $$\n$$ -0.1 \\times \\ln(0.944) \\approx 0.00576352 $$\n$$ \\exp(0.00576352) \\approx 1.0057801 $$\n现在，我们可以计算分子：\n$$ (0.944)^{-0.1} - 1 \\approx 1.0057801 - 1 = 0.0057801 $$\n最后，我们可以计算出 $z$ 分数 $Z$：\n$$ Z \\approx \\frac{0.0057801}{-0.009} \\approx -0.6422367 $$\n题目要求答案四舍五入到四位有效数字。前四位有效数字是 $6$、$4$、$2$ 和 $2$。第五位数字是 $3$，所以向下舍入。\n$$ Z \\approx -0.6422 $$\n这就是该儿童的年龄别体重 $z$ 分数。", "answer": "$$\\boxed{-0.6422}$$", "id": "5216265"}, {"introduction": "在大多数真实世界的数据分析场景中，最优的变换参数 $\\lambda$ 是未知的，需要从数据本身来估计。这个综合性练习将指导你完成这一核心任务，即通过最大化剖面对数似然函数来找到最佳的 $\\lambda$。你将结合统计理论（似然性）与数值优化技术（网格搜索和牛顿-拉夫逊法），编写一个完整的算法来解决这个问题，从而全面掌握Box-Cox方法的实际应用。[@problem_id:4965153]", "problem": "一位生物统计学家正在评估用于严格正响应变量的单调幂变换，以改善其近似正态性。对于一个包含 $n$ 个独立同分布 (i.i.d.) 观测值 $\\{y_i\\}_{i=1}^n$ 且 $y_i \\gt 0$ 的样本，考虑 Box–Cox 变换族，其定义如下：\n$$\nz_i(\\lambda)=\n\\begin{cases}\n\\dfrac{y_i^{\\lambda}-1}{\\lambda}, & \\lambda \\neq 0, \\\\\n\\log(y_i), & \\lambda = 0,\n\\end{cases}\n$$\n并假设变换后，工作模型假定 $z_i(\\lambda)$ 是服从均值为 $\\mu$、方差为 $\\sigma^2$ 的独立同分布正态变量。推断目标是在此模型下使剖面对数似然最大化的变换参数 $\\lambda$ 的值。\n\n你的任务如下：\n\n1) 从变换后数据的正态似然、独立性假设以及变量替换 $y \\mapsto z(\\lambda)$ 的雅可比行列式出发，通过其最大似然估计 (MLEs) 消去讨厌参数 $\\mu$ 和 $\\sigma^2$，推导出 $\\lambda$ 的剖面对数似然。将结果表示为仅含 $\\lambda$ 和数据 $\\{y_i\\}_{i=1}^n$ 的函数，可相差一个不依赖于 $\\lambda$ 的加法常数。\n\n2) 设计一个算法，通过以下方法来最大化所推导出的函数关于 $\\lambda$ 的值：\n   - 在有界区间上进行粗略网格搜索以获得初始估计。\n   - 使用应用于剖面对数似然函数的牛顿-拉夫逊 (NR) 方法进行优化。对于牛顿-拉夫逊法，使用对称有限差分进行数值微分，计算步长为 $h$ 的一阶和二阶导数，并结合回溯线搜索以确保函数值上升，同时明确指定停止准则。\n\n3) 实现一个完整的程序，该程序：\n   - 不包含任何输入，并在内部定义以下测试套件。每个测试用例都是一个代表样本 $\\{y_i\\}$ 的严格正实数列表。\n     - 测试用例 A (对数对称，预期解在 $\\lambda=0$ 附近): $y = \\exp([-2,-1,0,1,2,-2,-1,0,1,2])$。\n     - 测试用例 B (在原始尺度上近似对称，预期解在 $\\lambda=1$ 附近): $y = [8.0,9.0,9.5,10.0,10.5,11.0,12.0,12.5,13.0,14.0]$。\n     - 测试用例 C (高度右偏，动态范围宽): $y = [0.1,0.2,0.3,0.5,1.0,2.0,4.0,8.0,16.0,32.0]$。\n     - 测试用例 D (对数扩展值，预期解在 $\\lambda=0$ 附近): $y = \\exp([-1.5,-1.0,-0.5,0.0,0.5,1.0,1.5,2.0])$。\n   - 对每个测试用例，执行：\n     - 在 $\\lambda \\in [-2,2]$ 上以步长 $0.01$ 进行网格搜索，以找到初始最大化点。\n     - 以网格搜索找到的最大化点为初始值，进行牛顿-拉夫逊优化。使用步长为 $h = 10^{-4}$ 的对称有限差分，最大迭代次数为 $50$ 次，参数更新的数值容差为 $10^{-10}$，每次更新后将 $\\lambda$ 裁剪到区间 $[-5,5]$ 内，并使用步长减半的回溯线搜索，直到剖面对数似然增加为止。\n     - 在 $\\lambda = 0$ 附近使用其连续极限对 Box-Cox 变换进行数值稳定的评估。\n   - 将每个最终的 $\\lambda$ 估计值四舍五入到小数点后六位。\n\n4) 最终输出格式：\n   - 你的程序应生成单行输出，其中包含四个最终的 $\\lambda$ 估计值，格式为方括号内以逗号分隔的列表（例如，“[x1,x2,x3,x4]”），每个值都打印为四舍五入到小数点后六位的浮点数。\n\n所有数学符号必须按以下方式解释：$\\lambda$ 表示 Box-Cox 幂参数，$\\{y_i\\}_{i=1}^n$ 是原始正尺度上的观测值，$z_i(\\lambda)$ 是变换后的观测值。本问题不涉及角度，也无需报告物理单位。每个测试用例的答案都是浮点数。该问题纯属数学和算法问题，除了此处给出的定义外，不需要任何特定领域的单位或背景知识。确保所有数值计算与标准假设一致，并且数据在整个过程中保持严格为正。", "solution": "该问题陈述清晰，具有科学依据，并为完整解决提供了所有必要信息。它要求推导 Box-Cox 变换参数 $\\lambda$ 的剖面对数似然及其数值最大化过程。\n\n### 1. 剖面对数似然的推导\n\n问题始于一组 $n$ 个独立同分布 (i.i.d.) 的正观测值 $\\{y_i\\}_{i=1}^n$。对每个观测值应用 Box-Cox 变换：\n$$\nz_i(\\lambda) =\n\\begin{cases}\n\\dfrac{y_i^{\\lambda}-1}{\\lambda},  & \\lambda \\neq 0, \\\\\n\\log(y_i),  & \\lambda = 0.\n\\end{cases}\n$$\n工作模型假设变换后的变量 $z_i(\\lambda)$ 独立同分布于正态分布 $N(\\mu, \\sigma^2)$。\n\n单个变换变量 $z_i$ 的概率密度函数 (PDF) 由下式给出：\n$$\nf_{Z}(z_i; \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(z_i - \\mu)^2}{2\\sigma^2}\\right)\n$$\n为了根据原始数据 $y_i$ 求出似然函数，我们进行变量替换。关系式为 $z_i = z_i(y_i, \\lambda)$。$Y_i$ 的概率密度函数为 $f_Y(y_i) = f_Z(z_i(\\lambda)) \\cdot |J|$，其中 $J$ 是变换的雅可比行列式。\n\n$z_i$ 相对于 $y_i$ 的导数为：\n$$\n\\frac{dz_i}{dy_i} = \\frac{d}{dy_i}\\left(\\frac{y_i^{\\lambda}-1}{\\lambda}\\right) = \\frac{1}{\\lambda} (\\lambda y_i^{\\lambda-1}) = y_i^{\\lambda-1}\n$$\n当 $\\lambda \\to 0$ 时，此结果也成立，此时 $\\frac{dz_i}{dy_i} = \\frac{1}{y_i}$。由于 $y_i > 0$，雅可比行列式为 $|J| = \\left|\\frac{dz_i}{dy_i}\\right| = y_i^{\\lambda-1}$。\n\n由于独立同分布的假设，整个样本 $\\{y_i\\}_{i=1}^n$ 的似然函数是单个密度的乘积：\n$$\nL(\\lambda, \\mu, \\sigma^2 | \\{y_i\\}) = \\prod_{i=1}^n f_Y(y_i) = \\prod_{i=1}^n \\left[ \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(z_i(\\lambda) - \\mu)^2}{2\\sigma^2}\\right) \\cdot y_i^{\\lambda-1} \\right]\n$$\n对数似然函数 $\\ell = \\log L$ 为：\n$$\n\\ell(\\lambda, \\mu, \\sigma^2) = \\sum_{i=1}^n \\left[ -\\frac{1}{2}\\log(2\\pi\\sigma^2) - \\frac{(z_i(\\lambda) - \\mu)^2}{2\\sigma^2} + (\\lambda-1)\\log(y_i) \\right]\n$$\n$$\n\\ell(\\lambda, \\mu, \\sigma^2) = -\\frac{n}{2}\\log(2\\pi) - \\frac{n}{2}\\log(\\sigma^2) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^n (z_i(\\lambda) - \\mu)^2 + (\\lambda-1)\\sum_{i=1}^n \\log(y_i)\n$$\n\n为了获得 $\\lambda$ 的剖面对数似然，我们必须首先在 $\\lambda$ 固定时，求出讨厌参数 $\\mu$ 和 $\\sigma^2$ 的最大似然估计 (MLEs)。我们将 $\\ell$ 分别对 $\\mu$ 和 $\\sigma^2$ 求导，并令结果为零。\n\n对于 $\\mu$：\n$$\n\\frac{\\partial \\ell}{\\partial \\mu} = \\frac{1}{\\sigma^2}\\sum_{i=1}^n (z_i(\\lambda) - \\mu) = 0 \\implies \\sum_{i=1}^n z_i(\\lambda) - n\\mu = 0\n$$\n$$\n\\hat{\\mu}(\\lambda) = \\frac{1}{n}\\sum_{i=1}^n z_i(\\lambda)\n$$\n这是变换后数据的样本均值。\n\n对于 $\\sigma^2$：\n$$\n\\frac{\\partial \\ell}{\\partial \\sigma^2} = -\\frac{n}{2\\sigma^2} + \\frac{1}{2(\\sigma^2)^2}\\sum_{i=1}^n (z_i(\\lambda) - \\mu)^2 = 0\n$$\n将 $\\mu$ 替换为 $\\hat{\\mu}(\\lambda)$：\n$$\n\\hat{\\sigma}^2(\\lambda) = \\frac{1}{n}\\sum_{i=1}^n (z_i(\\lambda) - \\hat{\\mu}(\\lambda))^2\n$$\n这是变换后数据的样本方差（分母为 $n$）。\n\n将这些最大似然估计代回对数似然函数，得到剖面对数似然 $\\ell_p(\\lambda)$：\n$$\n\\ell_p(\\lambda) = -\\frac{n}{2}\\log(2\\pi) - \\frac{n}{2}\\log(\\hat{\\sigma}^2(\\lambda)) - \\frac{1}{2\\hat{\\sigma}^2(\\lambda)}\\sum_{i=1}^n (z_i(\\lambda) - \\hat{\\mu}(\\lambda))^2 + (\\lambda-1)\\sum_{i=1}^n \\log(y_i)\n$$\n使用 $\\hat{\\sigma}^2(\\lambda)$ 的定义，平方和项简化为：$\\sum_{i=1}^n (z_i(\\lambda) - \\hat{\\mu}(\\lambda))^2 = n\\hat{\\sigma}^2(\\lambda)$。\n$$\n\\ell_p(\\lambda) = -\\frac{n}{2}\\log(2\\pi) - \\frac{n}{2} - \\frac{n}{2}\\log(\\hat{\\sigma}^2(\\lambda)) + (\\lambda-1)\\sum_{i=1}^n \\log(y_i)\n$$\n为了最大化 $\\ell_p(\\lambda)$，我们可以省略那些相对于 $\\lambda$ 为常数的项，即 $-\\frac{n}{2}\\log(2\\pi)$ 和 $-\\frac{n}{2}$。令待最大化的函数为 $L_{prof}(\\lambda)$：\n$$\nL_{prof}(\\lambda) = -\\frac{n}{2}\\log(\\hat{\\sigma}^2(\\lambda)) + (\\lambda-1)\\sum_{i=1}^n \\log(y_i)\n$$\n这就是我们所求的剖面对数似然函数，它表示为 $\\lambda$ 和数据 $\\{y_i\\}$ 的函数，相差一个加法常数。\n\n### 2. 算法设计\n\n$L_{prof}(\\lambda)$ 的最大化按规定分两个阶段进行。\n\n**阶段 1：粗略网格搜索**\n通过在离散的网格点上评估 $L_{prof}(\\lambda)$ 来找到 $\\lambda$ 的初始估计。\n1.  在区间 $[-2, 2]$ 上定义一个步长为 $0.01$ 的 $\\lambda$ 值网格。\n2.  对于网格中的每个 $\\lambda_j$，计算 $L_{prof}(\\lambda_j)$。\n3.  初始估计 $\\lambda_{init}$ 是产生最大 $L_{prof}(\\lambda_j)$ 值的网格点。\n\n**阶段 2：牛顿-拉夫逊优化**\n从 $\\lambda_{init}$ 开始，使用牛顿-拉夫逊方法优化估计，以找到 $L_{prof}(\\lambda)$ 导数的根。迭代更新规则为：\n$$\n\\lambda_{k+1} = \\lambda_k - \\frac{g(\\lambda_k)}{H(\\lambda_k)}\n$$\n其中 $g(\\lambda) = \\frac{d}{d\\lambda}L_{prof}(\\lambda)$ 是梯度（一阶导数），$H(\\lambda) = \\frac{d^2}{d\\lambda^2}L_{prof}(\\lambda)$ 是海森矩阵（二阶导数）。\n\n- **数值导数**：使用步长为 $h = 10^{-4}$ 的对称有限差分法以数值方式计算导数：\n  - 梯度：$g(\\lambda) \\approx \\frac{L_{prof}(\\lambda+h) - L_{prof}(\\lambda-h)}{2h}$\n  - 海森矩阵：$H(\\lambda) \\approx \\frac{L_{prof}(\\lambda+h) - 2L_{prof}(\\lambda) + L_{prof}(\\lambda-h)}{h^2}$\n\n- **回溯线搜索**：纯牛顿步不保证函数值会增加，尤其是在远离最大值或函数非局部凹的情况下。采用回溯线搜索以确保函数值上升。\n  1.  计算牛顿方向：$p_k = -g(\\lambda_k)/H(\\lambda_k)$。对于最大化问题，仅当 $H(\\lambda_k) < 0$ 时，这才是上升方向。如果 $H(\\lambda_k) \\ge 0$，则纯粹形式的方法不适用；迭代应停止，因为我们不在局部凹区域内。\n  2.  初始化步长因子 $\\alpha = 1$。\n  3.  重复将 $\\alpha$ 减半，直到满足上升条件 $L_{prof}(\\lambda_k + \\alpha p_k) > L_{prof}(\\lambda_k)$。\n  4.  更新则为 $\\lambda_{k+1} = \\lambda_k + \\alpha p_k$。\n\n- **裁剪**：每次更新后，将新的估计值 $\\lambda_{k+1}$ 裁剪到区间 $[-5, 5]$ 内，以防止发散的步长并维持合理的参数范围。\n\n- **停止准则**：当满足以下任一条件时，迭代终止：\n  1.  参数的绝对变化小于容差：$|\\lambda_{k+1} - \\lambda_k| < 10^{-10}$。\n  2.  达到最大迭代次数 $50$ 次。\n\n- **数值稳定性**：对于接近零的 $\\lambda$ 值（例如 $|\\lambda| < 10^{-6}$），$z_i(\\lambda)$ 的计算可能在数值上不稳定。使用 $y_i^\\lambda = \\exp(\\lambda \\log y_i)$ 的二阶泰勒级数展开可以避免此问题：\n$$\nz_i(\\lambda) = \\frac{\\exp(\\lambda \\log y_i) - 1}{\\lambda} \\approx \\frac{(1 + \\lambda \\log y_i + \\frac{1}{2}(\\lambda \\log y_i)^2) - 1}{\\lambda} = \\log y_i + \\frac{\\lambda}{2}(\\log y_i)^2\n$$\n该近似在 $\\lambda=0$ 处提供了一个平滑且精确的过渡。", "answer": "[-0.000000, 1.107758, 0.165682, -0.000000]", "id": "4965153"}]}