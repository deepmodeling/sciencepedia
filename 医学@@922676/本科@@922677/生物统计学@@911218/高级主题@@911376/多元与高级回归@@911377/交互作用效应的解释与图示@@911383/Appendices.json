{"hands_on_practices": [{"introduction": "在我们探索交互效应的旅程中，首先从最直观的线性回归模型开始。本练习将指导您计算“简单效应”，即在调节变量（例如药物剂量）取某一特定值时，一个预测变量（例如基因型）对结果的影响。掌握这项基本计算是理解交互作用如何改变变量之间关系的关键第一步 [@problem_id:4918651]。", "problem": "一项随机临床试验研究了一种降压药剂量对八周后收缩压降低的影响。设结果变量为收缩压的降低值，用 $Y$ 表示（单位为毫米汞柱）。设 $G$ 为一个二元基因型指示变量，其中 $G=1$ 表示药物基因组学变异的携带者，$G=0$ 表示非携带者。设 $X$ 表示药物剂量，以10毫克/天为单位，并以50毫克/天为中心进行中心化，即 $X = \\frac{\\text{剂量 (毫克/天)} - 50}{10}$。\n\n对数据拟合一个带有交互项的线性回归模型，其条件期望建模为\n$$\n\\mathbb{E}[Y \\mid X, G] = \\beta_{0} + \\beta_{X} X + \\beta_{G} G + \\beta_{XG} XG.\n$$\n估计的系数为\n$$\n\\beta_{0} = 8.0, \\quad \\beta_{X} = 1.5, \\quad \\beta_{G} = 2.0, \\quad \\beta_{XG} = 0.6.\n$$\n\n从线性模型下条件期望的定义以及单纯效应作为在调节变量固定值下期望结果的对比的定义出发，计算在70毫克/天的剂量下基因型的单纯效应（携带者减去非携带者）。也就是说，计算在该剂量下，$G=1$ 和 $G=0$ 之间预测的收缩压降低值的差异。\n\n以毫米汞柱表示最终差异，并将答案四舍五入至四位有效数字。", "solution": "问题要求计算在特定药物剂量下，基因型（$G$）对收缩压降低值（$Y$）的单纯效应。单纯效应定义为，在将调节变量保持在固定值的情况下，感兴趣因素的两个水平之间期望结果的差异。\n\n提供的用于 $Y$ 的条件期望的线性回归模型是：\n$$\n\\mathbb{E}[Y \\mid X, G] = \\beta_{0} + \\beta_{X} X + \\beta_{G} G + \\beta_{XG} XG\n$$\n其中 $Y$ 是收缩压的降低值，$G$ 是二元基因型指示变量（$G=1$ 为携带者，$G=0$ 为非携带者），$X$ 是中心化和缩放后的药物剂量。\n\n在对应于值 $x$ 的固定剂量下，基因型的单纯效应是携带者（$G=1$）与非携带者（$G=0$）的 $Y$ 的条件期望之差。这可以表示为：\n$$\n\\text{SE}_{G}(X=x) = \\mathbb{E}[Y \\mid X=x, G=1] - \\mathbb{E}[Y \\mid X=x, G=0]\n$$\n首先，我们使用给定的模型评估 $G$ 的每个水平的条件期望。\n\n对于携带者（$G=1$）：\n$$\n\\mathbb{E}[Y \\mid X=x, G=1] = \\beta_{0} + \\beta_{X} x + \\beta_{G}(1) + \\beta_{XG} x(1) = \\beta_{0} + \\beta_{X} x + \\beta_{G} + \\beta_{XG} x\n$$\n对于非携带者（$G=0$）：\n$$\n\\mathbb{E}[Y \\mid X=x, G=0] = \\beta_{0} + \\beta_{X} x + \\beta_{G}(0) + \\beta_{XG} x(0) = \\beta_{0} + \\beta_{X} x\n$$\n接下来，我们计算差值以求得单纯效应的表达式：\n$$\n\\text{SE}_{G}(X=x) = (\\beta_{0} + \\beta_{X} x + \\beta_{G} + \\beta_{XG} x) - (\\beta_{0} + \\beta_{X} x)\n$$\n通过消去共同项来简化表达式，得到：\n$$\n\\text{SE}_{G}(X=x) = \\beta_{G} + \\beta_{XG} x\n$$\n该方程表明，由于交互项 $\\beta_{XG} XG$ 的存在，基因型的效应不是恒定的，而是药物剂量 $X$ 的线性函数。\n\n问题指定剂量为70毫克/天。我们必须首先使用给定的转换公式将此剂量转换为缩放后的变量 $X$：\n$$\nX = \\frac{\\text{剂量 (毫克/天)} - 50}{10}\n$$\n代入70毫克/天的剂量：\n$$\nx = \\frac{70 - 50}{10} = \\frac{20}{10} = 2\n$$\n所以，70毫克/天的剂量对应于 $X=2$。\n\n现在，我们可以通过将 $x=2$ 和估计的系数代入我们推导出的公式中，来计算此剂量下基因型的单纯效应。给定的系数是：\n$$\n\\beta_{G} = 2.0, \\quad \\beta_{XG} = 0.6\n$$\n代入这些值：\n$$\n\\text{SE}_{G}(X=2) = 2.0 + (0.6)(2)\n$$\n$$\n\\text{SE}_{G}(X=2) = 2.0 + 1.2 = 3.2\n$$\n单纯效应的值为 $3.2$。这表示在70毫克/天的剂量下，携带者与非携带者之间预测的收缩压降低值（单位为毫米汞柱）的差异。具体来说，在该剂量下，预测携带者的血压降低值比非携带者大 $3.2$ 毫米汞柱。\n\n问题要求最终答案四舍五入至四位有效数字。计算出的值 $3.2$ 有两位有效数字。要将其表示为四位有效数字，我们写作 $3.200$。", "answer": "$$\\boxed{3.200}$$", "id": "4918651"}, {"introduction": "许多生物统计学问题涉及二元结果，例如疾病发生与否，此时逻辑回归是核心工具。本练习将带您超越线性模型，探讨在逻辑回归中解释交互作用的复杂性，您将学会在对数几率（log-odds）和概率这两个不同尺度上量化和解释治疗效果，这对于将模型结果转化为临床上有意义的结论至关重要 [@problem_id:4918650]。", "problem": "一个生物统计学团队正在研究接受择期手术的患者在 $30$ 天内发生术后并发症的概率。他们拟合了一个逻辑斯谛回归模型，该模型包含治疗分配和标准化炎症生物标志物之间的交互作用。该模型使用 logit 链接函数，定义如下\n$$\n\\operatorname{logit}(p) \\equiv \\ln\\!\\left(\\frac{p}{1-p}\\right) = \\beta_{0} + \\beta_{1} t + \\beta_{2} x + \\beta_{3} (t \\cdot x) + \\beta_{4} a,\n$$\n其中 $p$ 是并发症的概率，$t \\in \\{0,1\\}$ 表示标准护理 ($t=0$) 与术前康复 ($t=1$)，$x$ 是标准化的生物标志物（均值为 $0$，标准差为 $1$），$a$ 是年龄（以岁为单位）。估计的系数为\n$$\n\\beta_{0} = -2.0,\\quad \\beta_{1} = 0.9,\\quad \\beta_{2} = 0.7,\\quad \\beta_{3} = -0.5,\\quad \\beta_{4} = 0.01.\n$$\n考虑一个生物标志物 $x = 1.5$ 且年龄 $a = 50$ 的患者。在预测对数优势比对 $x$ 的交互作用图中，不同 $t$ 值对应的非平行线反映了治疗效果取决于 $x$。\n\n仅使用 logit 链接函数、优势和优势比的定义，计算在 $x=1.5$ 和 $a=50$ 时的以下数值：\n- 术前康复相对于标准护理的并发症条件优势比（$t=1$ 时的优势除以 $t=0$ 时的优势）。\n- 预测概率的绝对差异 $p(t=1) - p(t=0)$。\n\n将您的答案四舍五入到四位有效数字。将概率差异表示为小数（而不是百分比）。将您的两个数字以有序对 $(\\text{优势比}, \\text{风险差异})$ 的形式提供。", "solution": "并发症概率 $p$ 的逻辑斯谛回归模型由 logit 链接函数给出：\n$$\n\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right) = \\beta_{0} + \\beta_{1} t + \\beta_{2} x + \\beta_{3} (t \\cdot x) + \\beta_{4} a\n$$\n提供的估计系数为 $\\beta_{0} = -2.0$，$\\beta_{1} = 0.9$，$\\beta_{2} = 0.7$，$\\beta_{3} = -0.5$ 和 $\\beta_{4} = 0.01$。分析对象为生物标志物水平 $x = 1.5$ 且年龄 $a = 50$ 的患者。\n\n首先，我们计算术前康复 ($t=1$) 相对于标准护理 ($t=0$) 的并发症条件优势比。事件的优势定义为 $\\frac{p}{1-p}$。对数优势由模型直接给出。设 $L(t, x, a)$ 为给定一组预测变量的对数优势。\n术前康复组 ($t=1$) 的对数优势为：\n$$\nL(t=1, x, a) = \\beta_{0} + \\beta_{1}(1) + \\beta_{2} x + \\beta_{3}(1 \\cdot x) + \\beta_{4} a = \\beta_{0} + \\beta_{1} + \\beta_{2} x + \\beta_{3} x + \\beta_{4} a\n$$\n标准护理组 ($t=0$) 的对数优势为：\n$$\nL(t=0, x, a) = \\beta_{0} + \\beta_{1}(0) + \\beta_{2} x + \\beta_{3}(0 \\cdot x) + \\beta_{4} a = \\beta_{0} + \\beta_{2} x + \\beta_{4} a\n$$\n优势比 (OR) 是术前康复组的优势与标准护理组的优势之比：\n$$\n\\text{OR} = \\frac{\\text{Odds}(t=1)}{\\text{Odds}(t=0)} = \\frac{\\exp(L(t=1, x, a))}{\\exp(L(t=0, x, a))} = \\exp(L(t=1, x, a) - L(t=0, x, a))\n$$\n对数优势的差异，即优势比的自然对数，为：\n$$\n\\ln(\\text{OR}) = L(t=1, x, a) - L(t=0, x, a) = (\\beta_{0} + \\beta_{1} + \\beta_{2} x + \\beta_{3} x + \\beta_{4} a) - (\\beta_{0} + \\beta_{2} x + \\beta_{4} a) = \\beta_{1} + \\beta_{3} x\n$$\n这个表达式表明，治疗的对数优势比取决于生物标志物 $x$ 的值，这就是交互作用效应的定义。现在我们代入系数和 $x=1.5$ 的给定值：\n$$\n\\ln(\\text{OR}) = 0.9 + (-0.5)(1.5) = 0.9 - 0.75 = 0.15\n$$\n为了求出优势比，我们对该值取指数：\n$$\n\\text{OR} = \\exp(0.15) \\approx 1.161834\n$$\n四舍五入到四位有效数字，条件优势比为 $1.162$。\n\n第二，我们计算 $x=1.5$ 且 $a=50$ 的患者的预测概率的绝对差异 $p(t=1) - p(t=0)$。\n为了从对数优势 $L$ 求出概率 $p$，我们使用逆 logit 函数：\n$$\np = \\frac{\\exp(L)}{1 + \\exp(L)} = \\frac{1}{1 + \\exp(-L)}\n$$\n我们必须首先计算该特定患者在两种治疗条件下的对数优势。\n对于术前康复 ($t=1$)：\n$$\nL(t=1, x=1.5, a=50) = -2.0 + 0.9 + 0.7(1.5) + (-0.5)(1.5) + 0.01(50)\n$$\n$$\nL(t=1, x=1.5, a=50) = -2.0 + 0.9 + 1.05 - 0.75 + 0.5 = -0.3\n$$\n对于标准护理 ($t=0$)：\n$$\nL(t=0, x=1.5, a=50) = -2.0 + 0.7(1.5) + 0.01(50)\n$$\n$$\nL(t=0, x=1.5, a=50) = -2.0 + 1.05 + 0.5 = -0.45\n$$\n注意，这些对数优势的差异是 $-0.3 - (-0.45) = 0.15$，这与我们之前对 $\\ln(\\text{OR})$ 的计算相符，证实了一致性。\n现在，我们计算预测概率：\n$$\np(t=1) = \\frac{1}{1 + \\exp(-(-0.3))} = \\frac{1}{1 + \\exp(0.3)} \\approx \\frac{1}{1 + 1.349859} \\approx 0.425557\n$$\n$$\np(t=0) = \\frac{1}{1 + \\exp(-(-0.45))} = \\frac{1}{1 + \\exp(0.45)} \\approx \\frac{1}{1 + 1.568312} \\approx 0.389362\n$$\n预测概率的绝对差异，也称为风险差异，是：\n$$\np(t=1) - p(t=0) \\approx 0.425557 - 0.389362 = 0.036195\n$$\n四舍五入到四位有效数字，概率差异为 $0.03620$。\n\n最终答案是优势比和风险差异的有序对，两者均四舍五入到四位有效数字。", "answer": "$$\n\\boxed{(1.162, 0.03620)}\n$$", "id": "4918650"}, {"introduction": "交互作用的概念并不仅限于线性和逻辑回归，它同样适用于分析计数或率数据，例如感染病例数。本练习将您的技能扩展到泊松和负二项式模型，这些是流行病学和临床研究中的常用模型。您将通过推导交互率比（interaction rate ratio），来理解在对数链接函数下，交互系数如何量化一个因素（如预防措施）的效果是如何被另一个因素（如免疫状态）所调节的 [@problem_id:4918640]。", "problem": "一项关于医院获得性感染的队列研究对患者 $i$ 在长度为 $t_i$（以人日为单位）的随访期间观察到的感染次数 $Y_i$ 进行建模。考虑了两种建率模方法：泊松广义线性模型（GLM）和负二项广义线性模型（GLM），两者都使用对数连接函数和暴露时间的偏移量。协变量包括：是否接受预防性治疗的指示变量 $A_i \\in \\{0,1\\}$，以及是否为免疫功能低下状态的指示变量 $G_i \\in \\{0,1\\}$。模型中包含一个交互项 $A_i G_i$，以允许预防性治疗的效果因免疫功能低下状态而异。\n\n泊松GLM假设 $Y_i \\sim \\text{Poisson}(\\mu_i)$，其均值满足\n$$\n\\ln(\\mu_i) = \\ln(t_i) + \\beta_0 + \\beta_A A_i + \\beta_G G_i + \\beta_{AG} A_i G_i,\n$$\n而负二项GLM假设 $Y_i \\sim \\text{Negative Binomial}(\\mu_i, \\theta)$，其均值满足\n$$\n\\ln(\\mu_i) = \\ln(t_i) + \\gamma_0 + \\gamma_A A_i + \\gamma_G G_i + \\gamma_{AG} A_i G_i,\n$$\n其中 $\\theta$ 是一个过度离散参数。在两个模型中，对数连接和偏移量意味着期望率 $E[Y_i]/t_i$ 由线性预测变量决定。\n\n假设拟合的系数如下：\n- 泊松模型：$\\beta_0 = -3.50$, $\\beta_A = -0.30$, $\\beta_G = 0.40$, $\\beta_{AG} = 0.25$。\n- 负二项模型：$\\gamma_0 = -3.60$, $\\gamma_A = -0.35$, $\\gamma_G = 0.45$, $\\gamma_{AG} = 0.10$。\n\n将预防性治疗的交互作用率比定义为，当 $G_i=1$ 时 $A_i$ 效应的率比与当 $G_i=0$ 时 $A_i$ 效应的率比之比。仅使用上述模型结构和这些系数值，推导每个模型的交互作用率比，然后计算泊松模型的交互作用率比与负二项模型的交互作用率比之比。将你的最终答案表示为一个无量纲小数，并四舍五入到四位有效数字。\n\n为了便于解释，可以想象一个以 $\\ln$-率对 $A_i$ 作图的图表，其中包含分别对应 $G_i=0$ 和 $G_i=1$ 的两条线。交互作用表现为两个 $G_i$ 组之间 $\\ln$-率随 $A_i$ 变化的差异，但在你的推导中不要使用来自这类图表的任何快捷公式；请从上述模型定义出发。", "solution": "该问题要求计算两个交互作用率比的比值，这两个交互作用率比分别源自泊松和负二项广义线性模型（GLM）。我们必须首先根据所提供的模型结构，正式推导交互作用率比的表达式。\n\n对于这两个模型，患者 $i$ 的平均计数 $\\mu_i$ 通过一个对数连接函数与协变量相关联，其中包含暴露时间 $t_i$ 的偏移量 $\\ln(t_i)$。这种关系的一般形式是：\n$$ \\ln(\\mu_i) = \\ln(t_i) + \\eta_i $$\n其中 $\\eta_i$ 是取决于协变量的线性预测变量。患者 $i$ 的期望感染率为 $\\lambda_i = E[Y_i]/t_i = \\mu_i/t_i$。从模型方程中，我们可以重新整理以找到率的表达式：\n$$ \\ln(\\mu_i) - \\ln(t_i) = \\eta_i $$\n$$ \\ln\\left(\\frac{\\mu_i}{t_i}\\right) = \\eta_i $$\n$$ \\ln(\\lambda_i) = \\eta_i $$\n对两边取指数，得到作为线性预测变量函数的率：\n$$ \\lambda_i = \\exp(\\eta_i) $$\n线性预测变量包含一个交互项：$\\eta_i = \\alpha_0 + \\alpha_A A_i + \\alpha_G G_i + \\alpha_{AG} A_i G_i$，其中系数 $\\alpha$ 对应于泊松模型的 $\\beta$ 和负二项模型的 $\\gamma$。\n\n问题将“预防性治疗的交互作用率比”定义为当 $G_i=1$ 时与当 $G_i=0$ 时 $A_i$ 效应的率比（$RR$）之比。让我们来推导这个量。\n\n首先，我们计算非免疫功能低下组（$G_i=0$）中预防性治疗效果（$A_i=1$ 对比 $A_i=0$）的率比。让率表示为 $\\lambda(A,G)$。\n$$ RR_{A|G=0} = \\frac{\\lambda(A=1, G=0)}{\\lambda(A=0, G=0)} = \\frac{\\exp(\\alpha_0 + \\alpha_A(1) + \\alpha_G(0) + \\alpha_{AG}(1)(0))}{\\exp(\\alpha_0 + \\alpha_A(0) + \\alpha_G(0) + \\alpha_{AG}(0)(0))} $$\n$$ RR_{A|G=0} = \\frac{\\exp(\\alpha_0 + \\alpha_A)}{\\exp(\\alpha_0)} = \\exp(\\alpha_A) $$\n\n接下来，我们计算免疫功能低下组（$G_i=1$）中预防性治疗效果的率比。\n$$ RR_{A|G=1} = \\frac{\\lambda(A=1, G=1)}{\\lambda(A=0, G=1)} = \\frac{\\exp(\\alpha_0 + \\alpha_A(1) + \\alpha_G(1) + \\alpha_{AG}(1)(1))}{\\exp(\\alpha_0 + \\alpha_A(0) + \\alpha_G(1) + \\alpha_{AG}(0)(1))} $$\n$$ RR_{A|G=1} = \\frac{\\exp(\\alpha_0 + \\alpha_A + \\alpha_G + \\alpha_{AG})}{\\exp(\\alpha_0 + \\alpha_G)} = \\exp((\\alpha_0 + \\alpha_A + \\alpha_G + \\alpha_{AG}) - (\\alpha_0 + \\alpha_G)) = \\exp(\\alpha_A + \\alpha_{AG}) $$\n\n交互作用率比（$IRR$）是这两个率比的比值：\n$$ IRR = \\frac{RR_{A|G=1}}{RR_{A|G=0}} = \\frac{\\exp(\\alpha_A + \\alpha_{AG})}{\\exp(\\alpha_A)} = \\exp((\\alpha_A + \\alpha_{AG}) - \\alpha_A) = \\exp(\\alpha_{AG}) $$\n这个推导证实了对于一个带对数连接的GLM，交互作用率比就是交互作用系数的指数。这个结果与计数分布的选择（泊松或负二项）无关，因为它只涉及均值模型。\n\n现在，我们将这个一般结果应用于所提供的具体模型。\n\n**1. 泊松模型：**\n交互作用系数为 $\\beta_{AG} = 0.25$。泊松模型的交互作用率比为：\n$$ IRR_{\\text{Poisson}} = \\exp(\\beta_{AG}) = \\exp(0.25) $$\n\n**2. 负二项模型：**\n交互作用系数为 $\\gamma_{AG} = 0.10$。负二项模型的交互作用率比为：\n$$ IRR_{\\text{NB}} = \\exp(\\gamma_{AG}) = \\exp(0.10) $$\n\n最后一步是计算泊松模型的 $IRR$ 与负二项模型的 $IRR$ 之比。设这个比值为 $R$。\n$$ R = \\frac{IRR_{\\text{Poisson}}}{IRR_{\\text{NB}}} = \\frac{\\exp(\\beta_{AG})}{\\exp(\\gamma_{AG})} = \\exp(\\beta_{AG} - \\gamma_{AG}) $$\n\n代入系数的数值：\n$$ R = \\exp(0.25 - 0.10) = \\exp(0.15) $$\n\n我们被要求将此答案表示为一个无量纲小数，并四舍五入到四位有效数字。\n$$ R = \\exp(0.15) \\approx 1.16183424... $$\n四舍五入到四位有效数字得到 $1.162$。", "answer": "$$\\boxed{1.162}$$", "id": "4918640"}]}