{"hands_on_practices": [{"introduction": "新药研发之旅始于确保其安全性。I期剂量探索试验旨在确定一个既安全又有效的剂量，以供后续研究使用。本练习将向您介绍贝叶斯最优区间（BOIN）设计，这是一种简洁且广泛应用的方法，它根据观测到的毒性数据指导剂量递增或递减的决策。通过解决这个问题 ([@problem_id:4892406])，您将练习应用BOIN设计的核心决策规则，这是设计现代早期临床试验的一项基本技能。", "problem": "一项单药I期剂量探索试验采用贝叶斯优化区间 (BOIN) 设计，其目标是确定一个剂量，该剂量的剂量限制性毒性 (DLT) 概率接近预先设定的临床目标 $p^{*} = 0.25$。BOIN设计由两个决策区间边界 $\\lambda_{1}$ 和 $\\lambda_{2}$ 定义，其中 $\\lambda_{1}  p^{*}  \\lambda_{2}$。在一个期中决策点，已在三个有序剂量水平上观察到以下累积DLT结果：剂量水平 $1$ 有 $n_{1} = 3$ 名患者，其中 $y_{1} = 0$ 例发生DLT；剂量水平 $2$ 有 $n_{2} = 6$ 名患者，其中 $y_{2} = 1$ 例发生DLT；剂量水平 $3$ 有 $n_{3} = 0$ 名患者，其中 $y_{3} = 0$ 例发生DLT。正在为下一个队列考虑的当前剂量是剂量水平 $2$。假设没有剂量排除，毒性随剂量的单调性成立，且决策仅移动一个水平。\n\n给定BOIN区间边界 $\\lambda_{1} = 0.20$ 和 $\\lambda_{2} = 0.30$，根据BOIN决策原则确定推荐的下一个剂量水平指数，该原则将当前剂量的观察毒性证据与由 $\\lambda_{1}$ 和 $\\lambda_{2}$ 定义的区间进行比较。\n\n将最终答案表示为推荐剂量水平的整数指数。无需四舍五入。", "solution": "首先将对问题进行验证，以确保其科学基础、良定性和客观性。\n\n### 步骤1：提取已知条件\n- 试验设计：单药I期剂量探索试验。\n- 方法学：贝叶斯优化区间 (BOIN) 设计。\n- 目标剂量限制性毒性 (DLT) 概率：$p^{*} = 0.25$。\n- BOIN决策区间边界：$\\lambda_{1} = 0.20$ 和 $\\lambda_{2} = 0.30$。\n- 累积观察到的DLT结果：\n    - 剂量水平 $1$：$n_{1} = 3$ 名患者， $y_{1} = 0$ 例DLT。\n    - 剂量水平 $2$：$n_{2} = 6$ 名患者， $y_{2} = 1$ 例DLT。\n    - 剂量水平 $3$：$n_{3} = 0$ 名患者， $y_{3} = 0$ 例DLT。\n- 当前考虑的剂量：剂量水平 $2$。\n- 假设和约束：\n    - 无剂量排除。\n    - 毒性随剂量的单调性成立。\n    - 决策仅移动一个水平。\n- 问题：确定推荐的下一个剂量水平指数。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学基础**：该问题基于生物统计学领域，特别是适应性临床试验设计。BOIN设计是I期剂量探索研究中一种成熟且广泛使用的方法。所提供的参数（$p^{*}$、$\\lambda_{1}$、$\\lambda_{2}$）和场景是此类问题的标准配置。\n- **良定性**：该问题是良定的。它提供了应用BOIN决策规则并确定唯一后续行动所需的所有必要信息——当前剂量水平、在该水平上治疗的患者数量和观察到的DLT数量，以及决策边界（$\\lambda_1, \\lambda_2$）。\n- **客观性**：该问题使用临床试验方法学的标准术语，陈述精确、客观且无歧义。\n\n该问题没有说明中列出的任何缺陷。它在事实上是合理的，是可形式化的，是完整的，是现实的，是结构良好的，是非平凡的，并且是科学可验证的。剂量水平 $1$ 和 $3$ 的数据在整个试验的背景下是相关的，但对于在剂量水平 $2$ 上做出具体决策（这是问题的焦点）则不是必需的。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供解决方案。\n\n### 解决方案\n目标是使用贝叶斯优化区间 (BOIN) 设计，为I期临床试验中的新患者队列确定下一个剂量水平。该决策基于当前剂量水平的观察数据。\n\nBOIN设计使用一个简单的基于规则的系统进行剂量递增和递减。下一个队列的决策取决于当前剂量水平（记为 $j$）的观察毒性率。观察到的DLT率 $\\hat{p}_{j}$ 计算为在该剂量下出现DLT的患者数 $y_{j}$ 与接受治疗的总患者数 $n_{j}$ 之比。\n\n$$\n\\hat{p}_{j} = \\frac{y_{j}}{n_{j}}\n$$\n\n决策是通过将 $\\hat{p}_{j}$ 与预先设定的区间边界 $\\lambda_{1}$ 和 $\\lambda_{2}$ 进行比较来做出的。规则如下：\n1.  如果 $\\hat{p}_{j} \\leq \\lambda_{1}$，则递增至下一个更高的剂量水平 $j+1$。\n2.  如果 $\\hat{p}_{j} \\geq \\lambda_{2}$，则递减至下一个更低的剂量水平 $j-1$。\n3.  如果 $\\lambda_{1}  \\hat{p}_{j}  \\lambda_{2}$，则保留当前剂量水平 $j$。\n\n问题陈述当前考虑的剂量是剂量水平 $2$。因此，我们设 $j=2$。该剂量水平的数据为 $n_{2} = 6$ 名患者和 $y_{2} = 1$ 例DLT。\n\n首先，我们计算剂量水平 $2$ 的观察DLT率：\n$$\n\\hat{p}_{2} = \\frac{y_{2}}{n_{2}} = \\frac{1}{6}\n$$\n\n为了应用决策规则，我们将 $\\hat{p}_{2}$ 与给定的边界 $\\lambda_{1} = 0.20$ 和 $\\lambda_{2} = 0.30$ 进行比较。\n观察到的DLT率的数值为：\n$$\n\\hat{p}_{2} = \\frac{1}{6} \\approx 0.1667\n$$\n\n现在我们检查满足哪个条件：\n- $\\hat{p}_{2} \\leq \\lambda_{1}$ 是否成立？我们将 $0.1667$ 与 $0.20$ 进行比较。由于 $0.1667 \\leq 0.20$，此条件满足。\n- $\\hat{p}_{2} \\geq \\lambda_{2}$ 是否成立？我们将 $0.1667$ 与 $0.30$ 进行比较。由于 $0.1667  0.30$，此条件不满足。\n- $\\lambda_{1}  \\hat{p}_{2}  \\lambda_{2}$ 是否成立？我们检查 $0.20  0.1667  0.30$ 是否为真。此为假。\n\n唯一满足的条件是 $\\hat{p}_{2} \\leq \\lambda_{1}$。根据BOIN决策原则，这表明当前剂量的毒性在可接受的低水平，建议进行剂量递增。\n\n当前剂量水平为 $2$。根据问题约束（“决策仅移动一个水平”）递增一个水平，意味着移动到剂量水平 $2+1=3$。\n\n因此，推荐的下一个剂量水平指数是 $3$。有关剂量水平 $1$ 和 $3$ 的信息不直接参与当前剂量的决策，但为整个试验的进展提供了背景信息。", "answer": "$$\\boxed{3}$$", "id": "4892406"}, {"introduction": "在确定了安全剂量后，下一步是检验药物是否真正有效。II期临床试验起着筛选作用，其设计旨在高效地识别有潜力的药物，同时能快速放弃那些无效的药物以节约资源。这个问题 ([@problem_id:4892401]) 将让您扮演一位管理两阶段肿瘤学试验的统计学家的角色，这是一种允许早期因“无效”而停止的经典设计，您将利用期中数据来决定试验是否有足够的前景继续进行。", "problem": "一项单臂II期肿瘤学研究计划采用两阶段设计，以便在缺乏活性的情况下提前终止，同时将I类错误和统计功效控制在设计指定的水平。其二元终点是客观缓解（缓解者与非缓解者）。该设计指定第一阶段入组$n_1=18$名参与者，最大总入组人数为$n=44$名参与者。早期无效边界为$r_1=3$：第一阶段结束后，如果观察到的缓解者人数$x_1 \\le r_1$，试验因无效而终止；否则，试验进入第二阶段。在第二阶段结束时，如果两个阶段的总缓解者人数至少达到最终边界$r=10$，则宣告有效。\n\n假设在完成第一阶段后，观察到的缓解者人数为$x_1=5$。仅使用该两阶段设计的定义属性以及各阶段缓解数与总缓解数之间的算术关系，判断试验是否会进入第二阶段，并计算在第二阶段的额外$n-n_1$名参与者中，为使在总样本量为$n$时最终判定有效所需的最少额外缓解者人数。设$Q$表示第二阶段所需的这个最少额外缓解者人数；以单个整数形式报告$Q$的值。无需四舍五入。", "solution": "该问题是两阶段临床试验设计原则的有效应用。所有必要的参数和条件都已提供，问题具有科学依据、提法明确且客观。我们可以进行正式求解。\n\n该两阶段设计由以下参数定义：\n-   第一阶段的参与者人数：$n_1 = 18$。\n-   如果试验进入第二阶段的总参与者人数：$n = 44$。\n-   第一阶段的早期无效边界：$r_1 = 3$。如果第一阶段的缓解者人数（记为$x_1$）小于或等于此值（$x_1 \\le r_1$），试验将终止。\n-   最终有效性边界：$r = 10$。如果两个阶段的总缓解者人数（记为$x$）大于或等于此值（$x \\ge r$），则试验宣告成功。\n\n问题给出了第一阶段的观察结果：缓解者人数为$x_1 = 5$。\n\n首先，我们必须确定试验是否继续到第二阶段。因无效而提前终止的规则是，如果$x_1 \\le r_1$，则终止试验。在本例中，我们观察到的值为$x_1 = 5$，无效边界为$r_1 = 3$。我们评估该条件：\n$$5 \\le 3$$\n这个不等式是错误的。由于观察到的缓解者人数$x_1=5$大于无效边界$r_1=3$，试验不会因无效而终止。因此，试验进入第二阶段。\n\n在第二阶段，将入组额外的参与者，人数为$n_2$。$n_2$的值是计划总入组人数与第一阶段入组人数之差：\n$$n_2 = n - n_1 = 44 - 18 = 26$$\n设$x_2$为第二阶段这额外$n_2 = 26$名参与者中的缓解者人数。\n\n试验结束时，总缓解者人数是两个阶段缓解者人数之和：\n$$x = x_1 + x_2$$\n为了使试验宣告成功（即宣告有效），总缓解者人数$x$必须达到或超过最终有效性边界$r$。成功的条件是：\n$$x \\ge r$$\n代入$x$的表达式，这变为：\n$$x_1 + x_2 \\ge r$$\n我们已知第一阶段的观察结果$x_1 = 5$和最终边界$r = 10$。我们可以将这些值代入不等式：\n$$5 + x_2 \\ge 10$$\n为了求出第二阶段所需的最少缓解者人数，我们解出$x_2$：\n$$x_2 \\ge 10 - 5$$\n$$x_2 \\ge 5$$\n变量$x_2$代表人数（缓解者），所以它必须是一个非负整数。问题要求的是在第二阶段为宣告有效所需的最少额外缓解者人数。这个数量用$Q$表示。根据不等式$x_2 \\ge 5$， $x_2$能取的最小整数值为5。\n因此，第二阶段所需的最少额外缓解者人数为：\n$$Q = 5$$\n这是一个可行的结果，因为在第二阶段入组的$n_2=26$名参与者中，观察到5名缓解者是可能的（因为$0 \\le 5 \\le 26$）。", "answer": "$$\\boxed{5}$$", "id": "4892401"}, {"introduction": "大规模的确证性试验既昂贵又耗时，因此在试验进行期间对数据进行期中分析对于有效的监督至关重要。条件效力（Conditional Power）是在这些期中分析中使用的关键工具，它计算的是在给定当前已观测数据的情况下，试验在最终取得统计学显著性结果的概率。本练习 ([@problem_id:4892432]) 将指导您在时间-事件数据（time-to-event）的背景下计算条件效力，这是为决定继续、修改或停止一项正在进行的试验而做出明智决策的一项核心技能。", "problem": "一项两臂随机时间-事件临床试验以等量分配的方式比较一种试验性疗法与对照组。主要分析使用对数秩检验，其方向设定为标准化的统计量为正值时，表示试验性疗法更有利。在总共发生 $D_{i} = 150$ 个事件后进行了一次期中分析，得到观测到的期中对数秩 $Z$ 分数为 $Z_{i} = 1.20$。最终分析计划在总共发生 $D_{T} = 400$ 个事件时进行，并将使用 $\\alpha = 0.025$ 的单侧 I 型错误率，对应的标准正态临界值为 $z_{\\alpha}$。\n\n假设从期中分析开始，Cox 比例风险模型成立，试验组相对于对照组的风险比 $HR$ 为恒定值，取 $HR = 0.80$。令 $\\beta = \\ln(HR)$ 表示对数风险比。在信息累积框架下进行计算，该框架中对数秩得分过程具有独立增量，且 $\\beta$ 的观测 Fisher 信息近似为 $I \\approx p(1-p)D$，其中 $p$ 是分配到试验组的随机化比例，$D$ 是观测到的累积事件数。对于等量分配，使用 $p = 1/2$。\n\n从这些原则出发，推导在给定观测到的期中 $Z$ 分数的条件下，最终标准化对数秩统计量的条件分布，然后计算在假定的 $HR$ 下，在最终分析时拒绝原假设的条件功效。将最终的条件功效表示为小数，并将答案四舍五入到四位有效数字。", "solution": "将通过首先提取所有给定信息，然后检查其科学性、完整性和客观性来验证问题。\n\n### 步骤 1：提取给定信息\n- 试验类型：两臂随机时间-事件临床试验。\n- 分配：等量分配 ($p=1/2$)。\n- 主要分析工具：对数秩检验。\n- 约定：标准化的统计量为正值表示试验性疗法更有利。\n- 期中分析事件数：$D_{i} = 150$。\n- 期中对数秩 Z 分数：$Z_{i} = 1.20$。\n- 最终分析事件数：$D_{T} = 400$。\n- 最终分析 I 型错误率（单侧）：$\\alpha = 0.025$。\n- 最终分析的临界值：$z_{\\alpha}$，$\\alpha$ 对应的标准正态临界值。\n- 假设模型：Cox 比例风险模型。\n- 假定的风险比（试验组 vs. 对照组）：$HR = 0.80$。\n- 对数风险比：$\\beta = \\ln(HR)$。\n- 信息累积框架：对数秩得分过程具有独立增量。\n- Fisher 信息近似：$I \\approx p(1-p)D$，其中 $p$ 是随机化比例，$D$ 是事件数。\n\n### 步骤 2：使用提取的给定信息进行验证\n- **科学依据：** 该问题坚实地基于成组序贯和适应性临床试验的统计理论，特别是使用了 Tsiatis、Lan 和 DeMets 开发的方法。对数秩统计量、比例风险模型、与事件数成比例的信息时间概念，以及得分统计量的独立增量性质，都是时间-事件数据生物统计学中的标准和基本概念。具体的参数值对于临床试验场景是现实的。\n- **适定性：** 该问题是适定的。它要求计算条件功效，这是一个定义明确的统计量。执行此计算所需的所有信息都已提供（$D_i$、$D_T$、$Z_i$、$HR$、$\\alpha$）。框架和假设都已明确陈述，从而导出一个唯一的解。\n- **客观性：** 该问题以精确、客观和技术性的语言陈述。它不含任何主观性、模糊性或基于意见的主张。Z 分数方向的约定，虽然在其他情境中有时会相反，但在这里被明确定义且必须遵守。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的，因为它是科学合理的、适定的和客观的。将提供完整的解答。\n\n解答过程首先建立对数秩统计量随时间分布的理论框架，然后推导在给定中期结果的情况下最终统计量的条件分布，最后计算条件功效。\n\n对数秩得分统计量，我们称之为 $S$，已知其行为近似于一个以 Fisher 信息 $I$ 为索引的带漂移的布朗运动。独立增量性质意味着从信息水平 $I_i$ 到 $I_T$ 的得分统计量增量，记为 $S_T - S_i$，与期中分析时的得分统计量 $S_i$ 相互独立。\n\n在信息水平 $I$ 处的标准化对数秩统计量为 $Z = S / \\sqrt{I}$。在对数风险比为 $\\beta = \\ln(HR)$ 的备择假设下，得分统计量 $S$ 近似服从分布 $S \\sim N(\\mu_S, I)$，其中 $\\mu_S$ 是均值。问题陈述一个正的统计量表示试验性疗法更有利。由于 $HR=0.80  1$ 表示试验性疗法更有利，这意味着 Z 统计量的期望值应为正。在标准定义下，小于 1 的风险比（$\\beta  0$）通常会产生一个负的得分统计量。因此，为了与问题的约定保持一致，得分统计量的均值必须定义为与 $\\beta$ 的符号相反。因此，我们取 $S$ 的均值为 $-\\beta I$。\n所以，$S \\sim N(-\\beta I, I)$，并且标准化统计量 $Z$ 近似服从分布 $Z \\sim N(-\\beta\\sqrt{I}, 1)$。\n\n信息 $I$ 由 $I \\approx p(1-p)D$ 给出。对于等量分配，$p=1/2$，所以 $p(1-p) = 1/4$。\n期中和最终分析时的信息分别为：\n$I_i \\approx \\frac{1}{4}D_i$\n$I_T \\approx \\frac{1}{4}D_T$\n信息水平的比率，也称为信息分数，是 $\\tau = \\frac{I_i}{I_T} = \\frac{D_i}{D_T}$。\n\n最终得分统计量 $S_T$ 可以表示为期中得分与从期中到最终的增量之和：$S_T = S_i + (S_T - S_i)$。\n分布为：\n$S_i \\sim N(-\\beta I_i, I_i)$\n$S_T - S_i \\sim N(-\\beta (I_T - I_i), I_T - I_i)$\n\n在观测到的期中得分 $s_i$ 的条件下，最终得分 $S_T$ 的分布为：\n$S_T | (S_i = s_i) \\sim N(s_i - \\beta(I_T - I_i), I_T - I_i)$\n\n我们已知观测到的标准化统计量 $Z_i = z_i = 1.20$。我们可以写出 $s_i = z_i \\sqrt{I_i}$。将此代入 $S_T$ 的条件分布并进行标准化以获得最终的 Z 分数 $Z_T = S_T / \\sqrt{I_T}$：\n$Z_T | (Z_i=z_i) \\sim N\\left(\\frac{z_i \\sqrt{I_i} - \\beta(I_T - I_i)}{\\sqrt{I_T}}, \\frac{I_T - I_i}{I_T}\\right)$\n\n这个条件正态分布的均值和方差可以使用信息分数 $\\tau$ 来简化：\n条件均值：$\\mu_c = \\frac{z_i \\sqrt{I_i}}{\\sqrt{I_T}} - \\frac{\\beta(I_T - I_i)}{\\sqrt{I_T}} = z_i \\sqrt{\\tau} - \\beta\\sqrt{I_T}(1-\\tau)$\n条件方差：$\\sigma_c^2 = \\frac{I_T - I_i}{I_T} = 1 - \\tau$\n\n现在，我们代入给定的数值：\n$D_i = 150$，$D_T = 400 \\implies \\tau = \\frac{150}{400} = \\frac{3}{8} = 0.375$。\n$p=1/2$，所以 $I_T \\approx \\frac{1}{4} D_T = \\frac{1}{4}(400) = 100$。\n$HR = 0.80 \\implies \\beta = \\ln(0.80) \\approx -0.22314$。\n$Z_i = z_i = 1.20$。\n\n让我们计算条件均值 $\\mu_c$ 和方差 $\\sigma_c^2$：\n$\\mu_c = 1.20 \\sqrt{0.375} - \\ln(0.80) \\sqrt{100} (1 - 0.375)$\n$\\mu_c \\approx 1.20 \\times 0.61237 - (-0.22314) \\times 10 \\times 0.625$\n$\\mu_c \\approx 0.73485 + 1.39463 \\approx 2.12948$\n\n$\\sigma_c^2 = 1 - 0.375 = 0.625$\n$\\sigma_c = \\sqrt{0.625} \\approx 0.79057$\n\n所以，最终统计量的条件分布为 $Z_T | (Z_i=1.20) \\sim N(2.12948, 0.625)$。\n\n如果 $Z_T > z_\\alpha$，最终分析将拒绝原假设。单侧显著性水平为 $\\alpha=0.025$。相应的临界值 $z_{0.025}$ 是对于一个标准正态变量 $Z$ 满足 $P(Z > z_{0.025}) = 0.025$ 的值，即 $z_{0.025} = \\Phi^{-1}(1 - 0.025) = \\Phi^{-1}(0.975) \\approx 1.95996$。\n\n条件功效是概率 $P(Z_T > z_{0.025} | Z_i = 1.20)$。为了计算这个概率，我们使用其条件分布的参数对变量 $Z_T$ 进行标准化：\n条件功效 $= P\\left(\\frac{Z_T - \\mu_c}{\\sigma_c} > \\frac{z_{0.025} - \\mu_c}{\\sigma_c}\\right)$\n令 $W = \\frac{Z_T - \\mu_c}{\\sigma_c}$，其中 $W \\sim N(0,1)$。\n条件功效 $= P\\left(W > \\frac{1.95996 - 2.12948}{0.79057}\\right)$\n条件功效 $= P\\left(W > \\frac{-0.16952}{0.79057}\\right)$\n条件功效 $\\approx P(W > -0.21445)$\n\n利用标准正态分布的对称性，$P(W > -x) = P(W  x) = \\Phi(x)$，其中 $\\Phi$ 是标准正态累积分布函数。\n条件功效 $\\approx \\Phi(0.21445)$\n\n使用标准正态分布计算器，$\\Phi(0.21445) \\approx 0.58493$。\n四舍五入到四位有效数字，条件功效为 $0.5849$。", "answer": "$$\\boxed{0.5849}$$", "id": "4892432"}]}