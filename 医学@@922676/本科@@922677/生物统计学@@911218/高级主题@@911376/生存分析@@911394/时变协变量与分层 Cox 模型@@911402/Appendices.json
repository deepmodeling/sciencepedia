{"hands_on_practices": [{"introduction": "要真正掌握含时变协变量的Cox模型，最好的方法莫过于亲手构建其核心部件——部分似然函数。这个练习将引导你为一个小型队列从头开始推导部分似然函数。通过在每个事件时间点追踪风险集的变化和时变协变量的更新，你将深刻理解模型如何整合时间动态信息，为后续更复杂的应用打下坚实基础[@problem_id:4961492]。", "problem": "考虑一个由三名受试者组成的队列，其索引为 $i \\in \\{1,2,3\\}$。每名受试者都恰好经历一次事件，事件时间各不相同，分别为 $T_{1}=2$、$T_{2}=4$ 和 $T_{3}=6$。不存在删失。令 $X_{i}(t)$ 表示受试者 $i$ 的单个标量时变协变量，定义如下：对于所有 $t$，$X_{1}(t)=0$；对于 $t3$，$X_{2}(t)=0$，对于 $t\\ge 3$，$X_{2}(t)=1$；对于 $t3$，$X_{3}(t)=0$，对于 $t\\ge 3$，$X_{3}(t)=2$。假设只有一个层（即不分层），并采用Cox比例风险模型，其在时间 $t$ 对于协变量历史为 $X(t)$ 的受试者的风险函数为 $h(t \\mid X(t))=h_{0}(t)\\exp\\!\\big(\\beta X(t)\\big)$，其中 $h_{0}(t)$ 是一个未指定的基线风险函数，$\\beta$ 是一个未知的回归系数。\n\n仅使用上述模型定义以及将风险解释为瞬时事件率，通过以下步骤推导 $\\beta$ 的偏似然：(i) 确定每个事件时间点的相应风险集，以及 (ii) 在给定该时间点的风险集的情况下，构建观测到的受试者是在该时间点发生事件者的条件概率，并将这些概率相乘。将您的结果简化为关于 $\\beta$ 的单个闭式解析表达式。将您的最终答案表示为精确表达式；无需四舍五入。", "solution": "该问题是有效的，因为它科学地基于生存分析的原理，信息完备、适定，并以客观的数学语言表述。它代表了为带有单个时变协变量的Cox比例风险模型构建偏似然的标准应用。\n\n偏似然 $L(\\beta)$ 是在观测到的事件时间集合上，通过条件概率的乘积构建的。对于时间 $t$ 发生的事件，似然函数中对应的项是这样一个概率：在给定该时间点的风险集（即at risk的受试者集合）以及恰好有一个事件发生的情况下，发生事件的特定受试者就是该受试者的概率。\n\nCox比例风险模型指定了受试者 $i$ 在时间 $t$ 的风险函数为：\n$$ h(t \\mid X_i(t)) = h_0(t) \\exp(\\beta X_i(t)) $$\n其中 $h_0(t)$ 是基线风险函数，$X_i(t)$ 是受试者 $i$ 在时间 $t$ 的时变协变量的值，$\\beta$ 是回归系数。\n\n假设没有并列的事件时间，偏似然的一般公式为：\n$$ L(\\beta) = \\prod_{j=1}^{k} \\frac{h(t_{(j)} \\mid X_{i_j}(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} h(t_{(j)} \\mid X_l(t_{(j)}))} $$\n其中 $k$ 是不同事件时间的数量，$t_{(j)}$ 是排序后的事件时间，$i_j$ 是在时间 $t_{(j)}$ 发生事件的受试者的索引，$R(t_{(j)})$ 是时间 $t_{(j)}$ 的风险集（即，在 $t_{(j)}$ 之前尚未发生事件或被删失的所有受试者的集合）。\n\n将Cox模型的风险函数代入此公式，基线风险项 $h_0(t_{(j)})$ 会从分子和分母中消去：\n$$ L(\\beta) = \\prod_{j=1}^{k} \\frac{h_0(t_{(j)}) \\exp(\\beta X_{i_j}(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} h_0(t_{(j)}) \\exp(\\beta X_l(t_{(j)}))} = \\prod_{j=1}^{k} \\frac{\\exp(\\beta X_{i_j}(t_{(j)}))}{\\sum_{l \\in R(t_{(j)})} \\exp(\\beta X_l(t_{(j)}))} $$\n我们已知有三名受试者，其事件时间各不相同，分别为 $T_1=2$、$T_2=4$ 和 $T_3=6$。不存在删失。排序后的事件时间为 $t_{(1)}=2$（受试者1发生事件）、$t_{(2)}=4$（受试者2发生事件）和 $t_{(3)}=6$（受试者3发生事件）。\n\n让我们计算每个事件对似然的贡献。\n\n**事件1：在 $t_{(1)} = 2$ 时发生事件**\n发生事件的受试者是受试者1。风险集 $R(2)$ 包括在时间2之前所有处于风险中的受试者。由于这是第一个事件，所有三名受试者都在风险集中：$R(2)=\\{1, 2, 3\\}$。\n我们在 $t=2$ 时评估风险集中每个受试者的协变量：\n- 受试者1：$X_1(2) = 0$。\n- 受试者2：协变量定义为当 $t3$ 时 $X_2(t)=0$，所以 $X_2(2) = 0$。\n- 受试者3：协变量定义为当 $t3$ 时 $X_3(t)=0$，所以 $X_3(2) = 0$。\n\n偏似然的第一项 $L_1(\\beta)$ 是发生事件的受试者的风险评分与风险集中所有风险评分总和的比率：\n$$ L_1(\\beta) = \\frac{\\exp(\\beta X_1(2))}{\\exp(\\beta X_1(2)) + \\exp(\\beta X_2(2)) + \\exp(\\beta X_3(2))} = \\frac{\\exp(\\beta \\cdot 0)}{\\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 0)} = \\frac{1}{1+1+1} = \\frac{1}{3} $$\n\n**事件2：在 $t_{(2)} = 4$ 时发生事件**\n发生事件的受试者是受试者2。风险集 $R(4)$ 包括在时间4之前尚未发生事件的受试者。受试者1已经发生事件，所以风险集为 $R(4)=\\{2, 3\\}$。\n我们在 $t=4$ 时评估风险集中每个受试者的协变量：\n- 受试者2：协变量定义为当 $t \\ge 3$ 时 $X_2(t)=1$，所以 $X_2(4) = 1$。\n- 受试者3：协变量定义为当 $t \\ge 3$ 时 $X_3(t)=2$，所以 $X_3(4) = 2$。\n\n偏似然的第二项 $L_2(\\beta)$ 是：\n$$ L_2(\\beta) = \\frac{\\exp(\\beta X_2(4))}{\\exp(\\beta X_2(4)) + \\exp(\\beta X_3(4))} = \\frac{\\exp(\\beta \\cdot 1)}{\\exp(\\beta \\cdot 1) + \\exp(\\beta \\cdot 2)} = \\frac{\\exp(\\beta)}{\\exp(\\beta) + \\exp(2\\beta)} $$\n该表达式可以通过从分母中提出因子 $\\exp(\\beta)$ 来简化：\n$$ L_2(\\beta) = \\frac{\\exp(\\beta)}{\\exp(\\beta)(1 + \\exp(\\beta))} = \\frac{1}{1 + \\exp(\\beta)} $$\n\n**事件3：在 $t_{(3)} = 6$ 时发生事件**\n发生事件的受试者是受试者3。风险集 $R(6)$ 包括尚未发生事件的受试者。受试者1和2已经发生事件，所以风险集为 $R(6)=\\{3\\}$。\n我们在 $t=6$ 时评估受试者3的协变量：\n- 受试者3：协变量定义为当 $t \\ge 3$ 时 $X_3(t)=2$，所以 $X_3(6) = 2$。\n\n偏似然的第三项 $L_3(\\beta)$ 是：\n$$ L_3(\\beta) = \\frac{\\exp(\\beta X_3(6))}{\\exp(\\beta X_3(6))} = 1 $$\n这是一个普遍的结果：最后一个未删失观测值对似然的贡献总是1。\n\n**总偏似然**\n总偏似然 $L(\\beta)$ 是每个事件项的乘积：\n$$ L(\\beta) = L_1(\\beta) \\cdot L_2(\\beta) \\cdot L_3(\\beta) = \\left(\\frac{1}{3}\\right) \\cdot \\left(\\frac{1}{1 + \\exp(\\beta)}\\right) \\cdot (1) $$\n$$ L(\\beta) = \\frac{1}{3(1 + \\exp(\\beta))} $$\n\n这就是偏似然的最终简化闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{3(1 + \\exp(\\beta))}}$$", "id": "4961492"}, {"introduction": "在第一个练习的基础上，我们引入分层的概念，这是处理不同基线风险群体异质性的关键技术。本练习聚焦于计算特定分层内单个事件对部分似然的贡献，这有助于阐明风险集严格限制在层内的核心原则。通过这个假设场景，你将学会如何为分层Cox模型正确构建似然项，并理解时变协变量在特定事件时刻的取值方式[@problem_id:4961494]。", "problem": "一个临床队列使用分层 Cox 比例风险 (PH) 模型进行分析，该模型包含单个随时间变化的协变量。对于层 $s \\in \\{1,2\\}$，假设具有协变量路径 $X(t)$ 的个体的风险函数满足比例风险结构\n$$\nh_{s}(t \\mid X(t)) \\;=\\; h_{0,s}(t)\\,\\exp\\!\\big(\\beta\\,X(t)\\big),\n$$\n其中 $h_{0,s}(t)$ 是层 $s$ 中未知的基线风险，$\\beta$ 是所有层共有的未知回归系数。随时间变化的协变量在离散时间点记录，并被视为一个阶梯函数，在测量时间之间的开区间上是常数，并在右闭端点处取更新值。\n\n受试者 $A$ 属于层 $s=1$。该受试者有纵向协变量测量值 $Z(0)=0$、$Z(2)=1$ 和 $Z(5)=0$，并在时间 $t=6$ 发生事件。使用测量时间和事件时间为受试者 $A$ 构建起始-终止表示法，在最终区间上事件指示符 $\\delta=1$，其他情况下为 $\\delta=0$。\n\n在时间 $t=6$ 时，层 $s=1$ 内的风险集由受试者 $A$ 和另外两个个体组成：\n- 受试者 $B$（也在层 $s=1$ 中），测量值为 $W(0)=1$ 和 $W(4)=2$，在 $t=6$ 之前没有事件。\n- 受试者 $C$（也在层 $s=1$ 中），从基线开始具有恒定协变量 $U(t)\\equiv 0.5$，在 $t=6$ 之前没有事件。\n\n在时间 $t=6$ 时，层 $s=2$ 中还有其他处于风险中的个体，但由于分层，他们不对受试者 $A$ 事件的风险集做出贡献。\n\n仅从上述风险函数的定义以及风险集是在时间 $t$ 之前仍处于风险中的那些个体的解释出发，推导在分层模型下，受试者 $A$ 在 $t=6$ 时的事件对 Cox 偏似然的贡献。将您的最终答案表示为关于 $\\beta$ 的单一简化解析表达式。无需四舍五入。", "solution": "用户提供的问题是生物统计学中一个有效且适定的问题。\n\n### 第一步：提取已知条件\n- **模型**：用于层 $s \\in \\{1,2\\}$ 的分层 Cox 比例风险模型。\n- **风险函数**：$h_{s}(t \\mid X(t)) = h_{0,s}(t)\\,\\exp\\!\\big(\\beta\\,X(t)\\big)$，其中 $h_{0,s}(t)$ 是层 $s$ 的基线风险，$\\beta$ 是一个共有的回归系数。\n- **随时间变化的协变量**：一个阶梯函数，在测量之间的开区间上为常数，在右闭端点处更新。\n- **受试者 A**：属于层 $s=1$。\n  - 协变量测量值：$Z(0)=0$，$Z(2)=1$，$Z(5)=0$。\n  - 事件时间：$t=6$。\n- **风险集**：在时间 $t=6$ 时，层 $s=1$ 中的风险集包括：\n  - **受试者 A**：在 $t=6$ 发生事件。协变量路径 $Z(t)$。\n  - **受试者 B**：在层 $s=1$ 中，在 $t=6$ 之前无事件。协变量测量值 $W(0)=1$，$W(4)=2$。\n  - **受试者 C**：在层 $s=1$ 中，在 $t=6$ 之前无事件。恒定协变量 $U(t) \\equiv 0.5$。\n- **分层**：层 $s=2$ 中的个体不在层 $s=1$ 中事件的风险集内。\n- **任务1**：为受试者 A 构建起始-终止表示法。\n- **任务2**：推导受试者 A 在 $t=6$ 时的事件对 Cox 偏似然的贡献。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据、适定且客观。它描述了生存分析中涉及带有随时间变化协变量的分层 Cox 模型的标准情景。所有必要信息都已提供，数据一致，术语精确。该问题是已建立的统计理论的教科书式应用，不违反任何无效标准。\n\n### 第三步：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n问题要求两部分：为受试者 A 构建起始-终止数据，然后推导其对偏似然的贡献。\n\n#### 第一部分：受试者 A 的起始-终止表示法\n\n对于具有随时间变化协变量的受试者，观察期被分解为由协变量测量时间和最终事件或删失时间定义的区间。每个区间在“起始-终止”格式中构成一条独立的记录。受试者 A 在时间 $t=0, 2, 5$ 有测量值，并在 $t=6$ 发生事件。在每个区间内，协变量值是恒定的。问题陈述协变量“在测量时间之间的开区间上是常数，并在右闭端点处取更新值”，这通常被解释为值在形如 $(t_{start}, t_{stop}]$ 的区间上是恒定的。\n\n对于受试者 A，区间为 $(0, 2]$、$(2, 5]$ 和 $(5, 6]$。\n1.  **区间 1**：从 $t=0$ 到 $t=2$。起始时间是 $0$，终止时间是 $2$。协变量值取自区间开始，对于 $t \\in (0, 2]$，$X(t) = Z(0) = 0$。此区间内没有事件发生，因此事件指示符 $\\delta$ 为 $0$。\n2.  **区间 2**：从 $t=2$ 到 $t=5$。起始时间是 $2$，终止时间是 $5$。协变量值更新为 $X(t) = Z(2) = 1$，对于 $t \\in (2, 5]$。没有事件发生，因此 $\\delta=0$。\n3.  **区间 3**：从 $t=5$ 到事件时间 $t=6$。起始时间是 $5$，终止时间是 $6$。协变量值更新为 $X(t) = Z(5) = 0$，对于 $t \\in (5, 6]$。事件在此区间末尾发生，因此 $\\delta=1$。\n\n受试者 A 的起始-终止表示法如下：\n| 起始时间 ($t_{start}$) | 终止时间 ($t_{stop}$) | 协变量值 ($X$) | 事件指示符 ($\\delta$) |\n|--------------------------|------------------------|-----------------------|----------------------------|\n| $0$                      | $2$                    | $0$                   | $0$                        |\n| $2$                      | $5$                    | $1$                   | $0$                        |\n| $5$                      | $6$                    | $0$                   | $1$                        |\n\n#### 第二部分：对偏似然的贡献\n\nCox 偏似然由对应于每个观测事件的项构成。对于在时间 $t_i$ 发生在层 $s$ 中个体 $i$ 的事件，对似然的贡献是在层 $s$ 的风险集中，在 $t_i$ 时发生一次失败的条件下，这个特定个体失败的概率。这由失败个体的风险与风险集中所有个体风险之和的比值给出。\n\n个体 $i$ 在时间 $t_i$ 于层 $s_i$ 中发生事件的贡献为：\n$$\nL_i = \\frac{h_i(t_i | X_i(t_i))}{\\sum_{j \\in R(t_i, s_i)} h_j(t_i | X_j(t_i))}\n$$\n其中 $R(t_i, s_i)$ 是在时间 $t_i$ 于层 $s_i$ 中的风险集。\n\n代入给定的模型 $h_{s}(t \\mid X(t)) = h_{0,s}(t)\\exp(\\beta X(t))$：\n$$\nL_i = \\frac{h_{0,s_i}(t_i)\\exp(\\beta X_i(t_i))}{\\sum_{j \\in R(t_i, s_i)} h_{0,s_i}(t_i)\\exp(\\beta X_j(t_i))}\n$$\n层 $s_i$ 的公共基线风险项 $h_{0,s_i}(t_i)$ 从分子和分母中约去：\n$$\nL_i = \\frac{\\exp(\\beta X_i(t_i))}{\\sum_{j \\in R(t_i, s_i)} \\exp(\\beta X_j(t_i))}\n$$\n\n我们需要为受试者 A 在 $t=6$ 时于层 $s=1$ 中发生的事件计算此贡献。风险集 $R(6, 1)$ 已给出为 $\\{A, B, C\\}$。我们必须确定在事件时间 $t=6$ 时，这些受试者中每一个的协变量值。\n\n- **受试者 A**：事件发生在 $t=6$。最后一次协变量更新是 $Z(5)=0$。因此，受试者 A 在 $t=6$ 时的协变量值为 $X_A(6)=0$。\n\n- **受试者 B**：在 $t=6$ 之前最后一次协变量更新是 $W(4)=2$。因此，受试者 B 在 $t=6$ 时的协变量值为 $X_B(6)=2$。\n\n- **受试者 C**：协变量是恒定的，$U(t) \\equiv 0.5$。因此，受试者 C 在 $t=6$ 时的协变量值为 $X_C(6)=0.5$。\n\n现在，我们可以构建受试者 A 事件的似然项。\n\n分子是针对发生事件的个体，即受试者 A：\n$$\n\\text{Numerator} = \\exp(\\beta X_A(6)) = \\exp(\\beta \\cdot 0) = 1\n$$\n\n分母是风险集 $R(6, 1) = \\{A, B, C\\}$ 中所有个体的总和：\n$$\n\\text{Denominator} = \\sum_{j \\in \\{A, B, C\\}} \\exp(\\beta X_j(6)) = \\exp(\\beta X_A(6)) + \\exp(\\beta X_B(6)) + \\exp(\\beta X_C(6))\n$$\n代入协变量值：\n$$\n\\text{Denominator} = \\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 2) + \\exp(\\beta \\cdot 0.5)\n$$\n$$\n\\text{Denominator} = 1 + \\exp(2\\beta) + \\exp(0.5\\beta)\n$$\n\n受试者 A 的事件对偏似然的贡献是分子与分母的比值：\n$$\nL_A = \\frac{1}{1 + \\exp(2\\beta) + \\exp(0.5\\beta)}\n$$\n这是用 $\\beta$ 表示的最终简化解析表达式。", "answer": "$$\n\\boxed{\\frac{1}{1 + \\exp(2\\beta) + \\exp(0.5\\beta)}}\n$$", "id": "4961494"}, {"introduction": "真实世界的生存数据常常包含“事件时间节点”（tied failures），即多个个体在同一时间点发生事件，这违反了Cox模型最初的假设。这个高级练习旨在探讨处理这一实际问题的两种常用方法：Breslow近似法和Efron近似法。通过对一个假设案例进行数值计算和比较，你将洞察这两种近似在处理节点时的不同逻辑，加深对生存分析实践中重要细节的理解[@problem_id:4961541]。", "problem": "考虑一个分层 Cox 比例风险模型，其中，在时间 $t$ 时，层 $s$ 中个体 $i$ 的瞬时风险由 $h_{is}(t)=h_{0s}(t)\\exp\\{\\beta X_i(t)\\}$ 给出，其中 $h_{0s}(t)$ 是层特定的基线风险，$X_i(t)$ 是一个时变协变量。在时间 $t=5$ 时，层 $\\mathcal{S}_A$ 内恰好有三个事件同时发生（出现结），分别来自受试者 $1$、$2$ 和 $3$，其协变量值分别为 $X_1(5)=1$、$X_2(5)=3$ 和 $X_3(5)=2$。层特定的风险集 $\\mathcal{R}_A(5)$ 在 $t=5$ 时还包含另外五个处于风险中的个体（受试者 $4$–$8$），其协变量值分别为 $X_4(5)=0$、$X_5(5)=1.5$、$X_6(5)=2.2$、$X_7(5)=-0.5$ 和 $X_8(5)=3.1$。假设所有层共用一个回归系数 $\\beta=0.4$，并且相同时点的事件仅在 $t=5$ 时于层 $\\mathcal{S}_A$ 内发生。\n\n从 Cox 偏似然的定义和处理相同时点事件（结）的概念基础出发，推导在 Breslow 近似（将相同时点事件视为同时发生）和 Efron 近似（将相同时点事件均匀分布在事件区间内）下，$t=5$ 时对偏似然的贡献。根据给定数据，数值计算这两种贡献。然后，报告在 $t=5$ 时偏似然贡献的 $\\text{Efron}/\\text{Breslow}$ 比值，并四舍五入到四位有效数字。将最终比值表示为一个无单位的纯数。", "solution": "Cox 比例风险模型指定 $h_{is}(t)=h_{0s}(t)\\exp\\{\\beta X_i(t)\\}$。对于有序的不同事件时间，偏似然是通过将每个事件时间点上，发生事件个体的风险与该时间点风险集中所有个体风险之和的比值，进行连乘得到的。当出现相同时点事件（结）时，精确似然需要对结内未知的顺序进行积分，因此通常采用广泛使用的近似方法。\n\n在 Breslow 近似下，某个时间点上所有 $d$ 个相同时点事件被视为同时发生，其贡献项的分子是 $d$ 个发生事件个体的相对风险的乘积，分母是风险集总和的 $d$ 次方。在 Efron 近似下，$d$ 个相同时点事件被均匀地分布在事件区间内，其贡献项是 $d$ 个项的乘积，在每一步中，发生事件个体总风险的一部分会从风险集中移除。\n\n由于这是一个分层模型，贡献在层内计算，并且基线风险 $h_{0s}(t)$ 从偏似然中被消去。令 $\\mathcal{R}_A(5)$ 为在 $t=5$ 时层 $\\mathcal{S}_A$ 中的风险集，令 $\\mathcal{D}_A(5)$ 为在 $t=5$ 时层 $\\mathcal{S}_A$ 内 $d=3$ 个相同时点事件的集合。为每个 $i \\in \\mathcal{R}_A(5)$ 定义权重 $\\exp\\{\\beta X_i(5)\\}$。\n\n计算三个发生事件个体的权重：\n- 对于受试者 $1$：$X_1(5)=1$，所以 $\\exp\\{\\beta X_1(5)\\}=\\exp\\{0.4\\times 1\\}=\\exp(0.4)\\approx 1.4918246976412703$。\n- 对于受试者 $2$：$X_2(5)=3$，所以 $\\exp\\{\\beta X_2(5)\\}=\\exp\\{0.4\\times 3\\}=\\exp(1.2)\\approx 3.3201169227365472$。\n- 对于受试者 $3$：$X_3(5)=2$，所以 $\\exp\\{\\beta X_3(5)\\}=\\exp\\{0.4\\times 2\\}=\\exp(0.8)\\approx 2.225540928492468$。\n\n令\n$$\nD \\equiv \\sum_{i\\in \\mathcal{D}_A(5)} \\exp\\{\\beta X_i(5)\\} \\approx 1.4918246976412703 + 3.3201169227365472 + 2.225540928492468 = 7.037482548870285.\n$$\n两种近似的分子都是发生事件个体的相对风险的乘积，\n$$\nN \\equiv \\prod_{i\\in \\mathcal{D}_A(5)} \\exp\\{\\beta X_i(5)\\} = \\exp\\{\\beta[X_1(5)+X_2(5)+X_3(5)]\\} = \\exp(0.4\\times 6)=\\exp(2.4)\\approx 11.023176380641601.\n$$\n\n计算另外五个处于风险中但未发生事件的受试者的权重：\n- 受试者 $4$：$X_4(5)=0$，权重 $\\exp(0.4\\times 0)=\\exp(0)=1$。\n- 受试者 $5$：$X_5(5)=1.5$，权重 $\\exp(0.4\\times 1.5)=\\exp(0.6)\\approx 1.822118800390509$。\n- 受试者 $6$：$X_6(5)=2.2$，权重 $\\exp(0.4\\times 2.2)=\\exp(0.88)\\approx 2.410899706417119$。\n- 受试者 $7$：$X_7(5)=-0.5$，权重 $\\exp(0.4\\times (-0.5))=\\exp(-0.2)\\approx 0.8187307530779818$。\n- 受试者 $8$：$X_8(5)=3.1$，权重 $\\exp(0.4\\times 3.1)=\\exp(1.24)\\approx 3.455613845$ (使用 $\\exp(1.24)=\\exp(1.2)\\exp(0.04)\\approx 3.3201169227365472\\times 1.0408107741923889$)。\n\n对 $t=5$ 时的层特定风险集求和：\n$$\nW \\equiv \\sum_{i\\in \\mathcal{R}_A(5)} \\exp\\{\\beta X_i(5)\\} = D + \\sum_{j=4}^{8} \\exp\\{\\beta X_j(5)\\} \\approx 7.037482548870285 + (1 + 1.822118800390509 + 2.410899706417119 + 0.8187307530779818 + 3.455613845).\n$$\n因此，\n$$\nW \\approx 7.037482548870285 + 9.50736310488561 = 16.544845653755895.\n$$\n\nBreslow 近似：对于 $d=3$ 个相同时点事件，其贡献为\n$$\nL_{\\text{Breslow}}(5) = \\frac{N}{W^{d}} = \\frac{\\exp(2.4)}{W^{3}}.\n$$\n计算 $W^{3}$：\n首先 $W^{2}\\approx 273.731916582$ (来自 $(16.544845653755895)^{2}$)，然后\n$$\nW^{3} = W^{2}\\cdot W \\approx 273.731916582 \\times 16.544845653755895 \\approx 4528.852303465874.\n$$\n因此，\n$$\nL_{\\text{Breslow}}(5) \\approx \\frac{11.023176380641601}{4528.852303465874} \\approx 0.0024330.\n$$\n\nEfron 近似：对于 $d=3$，分母是 $\\left(W - \\frac{r}{d}D\\right)$ 对 $r=0,1,2$ 的连乘积，因此贡献为\n$$\nL_{\\text{Efron}}(5)=\\frac{N}{\\prod_{r=0}^{2}\\left(W - \\frac{r}{3}D\\right)}.\n$$\n计算三个因子：\n$$\n\\frac{D}{3} \\approx \\frac{7.037482548870285}{3} \\approx 2.345827516290095,\n$$\n所以\n$$\n\\begin{aligned}\n\\text{term}_{0} = W \\approx 16.544845653755895,\\\\\n\\text{term}_{1} = W - \\frac{1}{3}D \\approx 16.544845653755895 - 2.345827516290095 \\approx 14.199018137465800,\\\\\n\\text{term}_{2} = W - \\frac{2}{3}D \\approx 16.544845653755895 - 4.691655032580190 \\approx 11.853190621175705.\n\\end{aligned}\n$$\n将分母各项相乘：\n$$\n\\prod_{r=0}^{2}\\left(W - \\frac{r}{3}D\\right) \\approx 16.544845653755895 \\times 14.199018137465800 \\times 11.853190621175705 \\approx 2784.558009.\n$$\n因此，\n$$\nL_{\\text{Efron}}(5) \\approx \\frac{11.023176380641601}{2784.558009} \\approx 0.0039601.\n$$\n\n所求的 Efron 贡献与 Breslow 贡献的比值为\n$$\nR \\equiv \\frac{L_{\\text{Efron}}(5)}{L_{\\text{Breslow}}(5)} = \\frac{W^{3}}{\\prod_{r=0}^{2}\\left(W - \\frac{r}{3}D\\right)} \\approx \\frac{4528.852303465874}{2784.558009} \\approx 1.62642.\n$$\n四舍五入到四位有效数字，该比值为 $1.626$。这个数值演示表明，当相同时点事件具有不同的协变量值时（这会影响 $D$），在这种情况下，Efron 校正产生的贡献比 Breslow 近似更大。这是因为 Efron 近似的分母是通过逐步减去发生事件总风险的一部分来减小风险集总和，而不是将整个风险集总和提高到 $d$ 次方。", "answer": "$$\\boxed{1.626}$$", "id": "4961541"}]}