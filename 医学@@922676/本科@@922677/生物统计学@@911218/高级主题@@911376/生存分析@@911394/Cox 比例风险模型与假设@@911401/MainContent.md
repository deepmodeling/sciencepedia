## 引言
在生物统计学和医学研究中，我们常常关注的不仅仅是事件是否发生，更是事件发生的时间。从患者的生存时间到疾病的复发间隔，理解并预测这些“时间-事件”数据是做出[科学推断](@entry_id:155119)和临床决策的关键。然而，传统的回归方法难以处理这类数据特有的删失（censoring）问题。Cox比例风险模型，作为生存分析领域的一块基石，提供了一个强大而灵活的半参数框架来解决这一挑战，它允许我们研究多个协变量如何影响事件发生的风险，而无需对时间的潜在分布做出严格假设。

本文旨在为读者提供对Cox模型的全面理解，从其基本原理到高级应用。在接下来的章节中，我们将踏上一段结构化的学习之旅：
- **原理与机制**：我们将深入剖析模型的核心结构，理解其如何巧妙地分离基准风险和协变量效应，学习基于[偏似然](@entry_id:165240)的推断方法，并掌握检验和处理模型关键假设（尤其是[比例风险假设](@entry_id:163597)）的诊断工具。
- **应用与跨学科联系**：我们将通过来自临床医学、流行病学和心理学等多个领域的真实案例，展示[Cox模型](@entry_id:164053)如何解决实际问题，包括处理时依协变量、复发事件、[竞争风险](@entry_id:173277)和[高维数据](@entry_id:138874)等复杂情况，并探讨其与[现代机器学习](@entry_id:637169)方法的联系。
- **动手实践**：理论知识需要通过实践来巩固。本章将提供一系列精心设计的练习，引导您手动计算关键统计量、解释模型输出，并进行[模型诊断](@entry_id:136895)，从而将抽象概念转化为扎实的分析技能。

通过学习这些内容，您将不仅掌握Cox模型的技术细节，更能领会其作为数据分析工具的深刻洞察力与广泛适用性。

## 原理与机制

在上一章介绍生存分析的基本概念之后，本章将深入探讨 Cox [比例风险模型](@entry_id:171806)的核心原理与机制。作为生存分析领域应用最广泛的工具之一，Cox 模型以其独特的半参数结构，巧妙地平衡了模型的灵活性与结果的可解释性。我们将从模型的基本定义出发，逐步解析其参数的含义、估计方法，并详细讨论其关键假设的检验与处理方法，最后介绍模型的扩展应用。

### Cox [比例风险模型](@entry_id:171806)的定义与结构

生存分析的核心目标是研究事件发生时间与一系列预测变量（协变量）之间的关系。与直接对时间本身进行建模（如在[线性回归](@entry_id:142318)中）不同，Cox 模型选择对一个更为动态和瞬时的量——**风险函数 (hazard function)**——进行建模。风险函数 $h(t)$ 表示在时间点 $t$ 之前个体仍然存活（即“处于风险中”）的条件下，在下一个极小时间瞬间发生事件的[瞬时速率](@entry_id:182981)。

Cox 模型的核心是**比例风险 (Proportional Hazards, PH) 假设**。该假设认为，任意两个具有不同协变量值的个体，其[风险函数](@entry_id:166593)之比在任何时间点上都是一个常数。换言之，协变量对风险的影响是随时间推移而保持恒定的。

基于此假设，Cox 模型将风险函数 $h(t | \boldsymbol{x})$ 分解为两个独立的部分，其数学形式如下 [@problem_id:4906339]：
$$
h(t | \boldsymbol{x}) = h_0(t) \exp(\boldsymbol{x}^{\top}\boldsymbol{\beta})
$$
其中：
-   $\boldsymbol{x} = (x_1, x_2, \dots, x_p)^{\top}$ 是一个包含 $p$ 个协变量的向量。
-   $\boldsymbol{\beta} = (\beta_1, \beta_2, \dots, \beta_p)^{\top}$ 是对应的回归系数向量。
-   $h_0(t)$ 被称为**基准风险函数 (baseline hazard function)**。它代表当所有协变量值都为零 ($\boldsymbol{x} = \boldsymbol{0}$) 时个体的[风险函数](@entry_id:166593)。$h_0(t)$ 是一个关于时间的、未加任何具体形式限制的非负函数。它是模型中依赖于时间的部分。
-   $\exp(\boldsymbol{x}^{\top}\boldsymbol{\beta})$ 是**相对风险 (relative risk)** 或**风险比 (hazard ratio)**。它是一个不依赖于时间的标量，完全由协变量 $\boldsymbol{x}$ 和系数 $\boldsymbol{\beta}$ 决定。$\boldsymbol{x}^{\top}\boldsymbol{\beta}$ 通常被称为**风险得分 (risk score)** 或线性预测器。

这种结构清晰地将时间依赖性（完全由 $h_0(t)$ 承载）与协变量效应（完全由 $\exp(\boldsymbol{x}^{\top}\boldsymbol{\beta})$ 承载）分离开来。

一个关键特征是，Cox 模型是一个**[半参数模型](@entry_id:200031) (semiparametric model)** [@problem_id:4906339]。它包含一个“参数”[部分和](@entry_id:162077)一个“非参数”部分：
-   **参数部分**：[回归系数](@entry_id:634860) $\boldsymbol{\beta}$ 是一个有限维度的参数向量，其估计和解释方式与[线性回归](@entry_id:142318)或逻辑回归中的参数类似。
-   **非参数部分**：基准[风险函数](@entry_id:166593) $h_0(t)$ 是一个无限维的“滋扰函数” (nuisance function)。Cox 模型的强大之处在于，我们无需对 $h_0(t)$ 的具体形式（如指数分布、[威布尔分布](@entry_id:270143)等）做出任何假设，就能估计出我们关心的参数 $\boldsymbol{\beta}$。这种灵活性使得模型能够适应各种复杂的风险变化模式。

### 模型参数的解释

Cox 模型的参数 $\boldsymbol{\beta}$ 具有非常直观和实用的解释。让我们来推导单个系数 $\beta_j$ 的含义 [@problem_id:4906524]。

考虑两个个体，A 和 B，他们的协变量除了第 $j$ 个协变量 $x_j$ 外完全相同。假设个体 B 的 $x_j$ 值比个体 A 大一个单位。
-   个体 A 的协变量向量为 $\boldsymbol{x}_A = (x_1, \dots, x_j, \dots, x_p)^{\top}$。
-   个体 B 的协变量向量为 $\boldsymbol{x}_B = (x_1, \dots, x_j+1, \dots, x_p)^{\top}$。

根据 Cox 模型，他们在任意时间 $t$ 的风险函数分别为：
$$
h(t | \boldsymbol{x}_A) = h_0(t) \exp(\boldsymbol{x}_A^{\top}\boldsymbol{\beta})
$$
$$
h(t | \boldsymbol{x}_B) = h_0(t) \exp(\boldsymbol{x}_B^{\top}\boldsymbol{\beta})
$$

线性预测器 $\boldsymbol{x}_B^{\top}\boldsymbol{\beta}$ 可以展开为 $\boldsymbol{x}_A^{\top}\boldsymbol{\beta} + \beta_j$。现在，我们计算这两个个体[风险函数](@entry_id:166593)的比值，即**风险比 (Hazard Ratio, HR)**：
$$
HR = \frac{h(t | \boldsymbol{x}_B)}{h(t | \boldsymbol{x}_A)} = \frac{h_0(t) \exp(\boldsymbol{x}_A^{\top}\boldsymbol{\beta} + \beta_j)}{h_0(t) \exp(\boldsymbol{x}_A^{\top}\boldsymbol{\beta})} = \exp(\beta_j)
$$
基准[风险函数](@entry_id:166593) $h_0(t)$ 在分子和分母中被约去，这正是[比例风险假设](@entry_id:163597)的体现：风险比不随时间 $t$ 变化。

这个结果 $\exp(\beta_j)$ 的含义是：在保持其他协变量不变的情况下，协变量 $x_j$ 每增加一个单位，事件的瞬时风险将变为原来的 $\exp(\beta_j)$ 倍。
-   如果 $\beta_j > 0$，则 $\exp(\beta_j) > 1$，表示 $x_j$ 的增加会提高事件风险（即 $x_j$ 是一个风险因素）。
-   如果 $\beta_j  0$，则 $0  \exp(\beta_j)  1$，表示 $x_j$ 的增加会降低事件风险（即 $x_j$ 是一个保护因素）。
-   如果 $\beta_j = 0$，则 $\exp(\beta_j) = 1$，表示 $x_j$ 与事件风险无关。

对上式两边取自然对数，我们得到 $\ln(HR) = \beta_j$。因此，$\beta_j$ 本身就是 $x_j$ 每增加一个单位所对应的**对数风险比 (log-hazard ratio)**。

这个关系可以推广。例如，如果 $x_j$ 增加 2 个单位，风险比将是 $\exp(2\beta_j)$ [@problem_id:4906524]。一般地，对于 $x_j$ 的任意 $c$ 单位变化，风险比为 $\exp(c\beta_j)$。

### 推断引擎：[偏似然](@entry_id:165240)

Cox 模型最精妙的创新之一在于其[参数估计](@entry_id:139349)方法，即**[偏似然](@entry_id:165240) (partial likelihood)**。这种方法允许我们在完全不知道基准风险函数 $h_0(t)$ 的情况下，准确地估计出回归系数 $\boldsymbol{\beta}$。

理解[偏似然](@entry_id:165240)的关键是**风险集 (risk set)** 的概念。在任意时间点 $t$，风险集 $R(t)$ 是指在该时刻仍处于观察中且尚未经历事件的个体集合。个体的成员资格会受到**[右删失](@entry_id:164686) (right-censoring)**（因失访、研究结束等原因停止观察）和**延迟进入 (delayed entry)** 或称**左截断 (left-truncation)**（个体在研究开始一段时间后才进入观察队列）的影响。

正式地，对于个体 $i$，我们定义其进入研究的时间为 $L_i$，其观察到的事件或删失时间为 $Y_i$。那么，在时间 $t$ 的风险集可以定义为 [@problem_id:4906490]：
$$
R(t) = \{i \mid L_i \le t \le Y_i\}
$$
这意味着，一个个体在时间 $t$ 处于风险集中，当且仅当他/她已经在研究中（$L_i \le t$）并且尚未发生事件或被删失（$Y_i \ge t$）。

例如，考虑三个个体的数据 [@problem_id:4906490]：
-   个体 1：进入时间 $L_1=2$，事件时间 $T_1=6$。其处于风险的时间区间为 $[2, 6]$。
-   个体 2：进入时间 $L_2=0$，删失时间 $C_2=4$。其处于风险的时间区间为 $[0, 4]$。
-   个体 3：进入时间 $L_3=5$，事件时间 $T_3=7$。其处于风险的时间区间为 $[5, 7]$。

在时间 $t=4$ 时，个体 1 ($2 \le 4 \le 6$) 和个体 2 ($0 \le 4 \le 4$) 都在风险集中，而个体 3 尚未进入研究。因此 $R(4) = \{1, 2\}$。在时间 $t=6$ 时，个体 1 ($2 \le 6 \le 6$) 和个体 3 ($5 \le 6 \le 7$) 在风险集中，而个体 2 已被删失。因此 $R(6) = \{1, 3\}$。

[偏似然](@entry_id:165240)的构建思想是，我们只关注事件发生的时刻。假设在某个特定的事件时间 $t_{(j)}$，我们观察到风险集 $R(t_{(j)})$ 中恰好有一个个体（记为个体 $i$）发生了事件。[偏似然](@entry_id:165240)考虑这样一个条件概率：给定在 $t_{(j)}$ 时刻风险集中有一个事件发生，这个事件恰好发生在个体 $i$ 身上的概率是多少？

这个[条件概率](@entry_id:151013)可以表示为 [@problem_id:4906342]：
$$
P(\text{个体 } i \text{ 在 } t_{(j)} \text{ 失败} | \text{在 } R(t_{(j)}) \text{ 中有一个失败事件}) = \frac{\text{个体 } i \text{ 的风险}}{\text{风险集中所有个体的风险之和}}
$$
在数学上，这等于：
$$
\frac{h(t_{(j)} | \boldsymbol{x}_i)}{\sum_{k \in R(t_{(j)})} h(t_{(j)} | \boldsymbol{x}_k)} = \frac{h_0(t_{(j)}) \exp(\boldsymbol{x}_i^{\top}\boldsymbol{\beta})}{\sum_{k \in R(t_{(j)})} h_0(t_{(j)}) \exp(\boldsymbol{x}_k^{\top}\boldsymbol{\beta})}
$$
由于基准风险函数 $h_0(t_{(j)})$ 是风险集中所有个体的共同因子，它可以从分子和分母中约去：
$$
\frac{\exp(\boldsymbol{x}_i^{\top}\boldsymbol{\beta})}{\sum_{k \in R(t_{(j)})} \exp(\boldsymbol{x}_k^{\top}\boldsymbol{\beta})}
$$
这个表达式就是事件时间 $t_{(j)}$ 对偏[似然函数](@entry_id:141927)的一项贡献。它只依赖于我们想要估计的参数 $\boldsymbol{\beta}$ 和在该时刻的风险集数据，而与未知的 $h_0(t)$ 无关。通过将所有[独立事件](@entry_id:275822)时间的贡献项连乘起来，就得到了完整的偏[似然函数](@entry_id:141927)。然后，可以通过最大化这个函数来获得 $\boldsymbol{\beta}$ 的估计值 $\hat{\boldsymbol{\beta}}$。

这个巧妙的约去过程依赖于几个关键假设 [@problem_id:4906342]：
1.  **[比例风险假设](@entry_id:163597)**：这是模型结构的基础，保证了风险函数可以分解为时间[部分和](@entry_id:162077)协变量部分。
2.  **共同的基准风险**：风险集中的所有个体共享同一个 $h_0(t)$。如果不同亚组（如不同研究中心）的基准风险不同，则需要使用分层模型（后述）。
3.  **独立的事件时间**：个体间的事件过程是相互独立的。
4.  **非信息性删失 (Non-informative Censoring)**：删失机制独立于事件过程。

### [比例风险假设](@entry_id:163597)：评估与修正

[比例风险](@entry_id:166780) (PH) 假设是 Cox 模型的基石，因此在解释模型结果之前，必须对其进行检验。如果该假设不成立，则意味着协变量的效应随时间变化，$\exp(\beta)$ 不再是一个恒定的风险比。

#### 图形化评估

检验 PH 假设的一个直观方法是**对数-对数生存图 (log-log survival plot)**。其理论基础如下 [@problem_id:4906511]：
首先，我们有生存函数 $S(t|x)$ 和[累积风险函数](@entry_id:169734) $H(t|x)$ 的关系：$S(t|x) = \exp(-H(t|x))$。
在 Cox 模型中，$H(t|x) = \int_0^t h(u|x)du = \int_0^t h_0(u)\exp(\boldsymbol{x}^{\top}\boldsymbol{\beta})du = H_0(t)\exp(\boldsymbol{x}^{\top}\boldsymbol{\beta})$。
将两者结合，我们得到：
$$
S(t|x) = \exp(-H_0(t)\exp(\boldsymbol{x}^{\top}\boldsymbol{\beta}))
$$
对上式进行两次对数变换：
$$
-\ln S(t|x) = H_0(t)\exp(\boldsymbol{x}^{\top}\boldsymbol{\beta})
$$
$$
\ln(-\ln S(t|x)) = \ln(H_0(t)) + \boldsymbol{x}^{\top}\boldsymbol{\beta}
$$
对于一个只有单一[二分类](@entry_id:142257)协变量 $x$（取值为 0 或 1）的情况，我们有：
$$
\ln(-\ln S(t|x=1)) = \ln(H_0(t)) + \beta
$$
$$
\ln(-\ln S(t|x=0)) = \ln(H_0(t))
$$
这两条曲线之间的垂直距离为 $\beta$，是一个与时间无关的常数。这意味着，如果 PH 假设成立，我们将 $\ln(-\ln \hat{S}(t|x))$ 对 $\ln(t)$（或 $t$ 本身）作图，不同协变量组的曲线应该是**相互平行**的。如果曲线出现交叉、发散或收敛，则提示 PH 假设可能被违背 [@problem_id:4906511]。

#### 基于残差的正式检验

更正式的检验方法通常基于**[残差分析](@entry_id:191495)**。

**Schoenfeld 残差**是专门用于检验 PH 假设的工具。对于第 $j$ 个事件时间 $t_j$，其 Schoenfeld 残差定义为发生事件个体的协变量值与风险集中协变量的加权平均值之差 [@problem_id:4906451]：
$$
\boldsymbol{r}_j = \boldsymbol{x}_{(j)} - \bar{\boldsymbol{x}}(t_j, \hat{\boldsymbol{\beta}})
$$
其中 $\boldsymbol{x}_{(j)}$ 是在 $t_j$ 时刻发生事件的个体的协变量向量，而 $\bar{\boldsymbol{x}}(t_j, \hat{\boldsymbol{\beta}})$ 是风险集 $R(t_j)$ 中所有个体协变量的加权平均，权重为每个个体的相对风险：
$$
\bar{\boldsymbol{x}}(t_j, \hat{\boldsymbol{\beta}}) = \frac{\sum_{i \in R(t_j)} \boldsymbol{x}_i \exp(\boldsymbol{x}_i^{\top}\hat{\boldsymbol{\beta}})}{\sum_{k \in R(t_j)} \exp(\boldsymbol{x}_k^{\top}\hat{\boldsymbol{\beta}})}
$$
其背后的直觉是，如果 PH 假设成立（即 $\boldsymbol{\beta}$ 不随时间变化），那么在任何事件时刻，发生事件的个体的协变量特征应该是风险集中的一个“随机”样本。因此，其协变量向量 $\boldsymbol{x}_{(j)}$ 的[期望值](@entry_id:150961)应该等于风险集的加权平均 $\bar{\boldsymbol{x}}(t_j, \boldsymbol{\beta})$。这意味着，真实的 Schoenfeld 残差的[期望值](@entry_id:150961)在每个事件时间点都应为零：$\mathbb{E}[\boldsymbol{r}_j | R(t_j)] = \boldsymbol{0}$ [@problem_id:4906451]。

因此，如果 PH 假设成立，Schoenfeld 残差序列应该不表现出任何系统性趋势，即与时间不相关。如果绘制残差与时间的散点图并观察到明显的趋势（如线性增加或减少），则表明 PH 假设可能不成立。

**Grambsch-Therneau 检验**将这一思想形式化。该检验通[过拟合](@entry_id:139093)一个包含时变系数的备择模型 $\beta_k(t) = \beta_k + \theta_k g(t)$，将对 PH 假设的检验转化为对 $\theta_k=0$ 的检验。该检验实质上是将在每个事件时间点计算的**缩放后 Schoenfeld 残差 (scaled Schoenfeld residuals)** 对某个时间函数 $g(t)$（如 $t$ 或 $\ln(t)$）进行回归 [@problem_id:4906427]。
-   **特定协变量检验**：检验每个回归的斜率是否显著不为零。如果协变量 $k$ 的回归斜率显著，则表明该协变量违背了 PH 假设。斜率的符号还可指示效应随时间变化的趋势（例如，正斜率意味着风险比随时间增加）。
-   **全局检验**：将所有协变量的证据汇总为一个卡方统计量，其自由度等于协变量的个数 $p$。它检验的是所有 $\theta_k$ 同时为零的总体假设 $H_0: \boldsymbol{\theta}=\boldsymbol{0}$。

#### PH 假设违背的处理方法

当发现某个（通常是分类）协变量违背 PH 假设时，一个有效的处理方法是使用**分层 Cox 模型 (stratified Cox model)**。

假设我们发现一个分类变量 $S$（例如，不同的医院站点）不满足 PH 假设，但我们主要关心另一个协变量 $Z$ 的效应，且 $Z$ 在每个站点内都满足 PH 假设。此时，我们可以按 $S$ 进行分层。分层 Cox 模型的形式为 [@problem_id:4906471]：
$$
h(t | Z, S=s) = h_{0s}(t)\exp(\beta Z)
$$
在这个模型中：
-   每个层级（stratum）$s$ 都有其自己独立的、形式未定的基准风险函数 $h_{0s}(t)$。这允许不同层之间的[风险函数](@entry_id:166593)任意交叉，从而解决了 $S$ 的非[比例风险](@entry_id:166780)问题。
-   所有层共享一个共同的回归系数 $\beta$。这表示我们假设协变量 $Z$ 的效应在所有层中是相同的。
-   在估计过程中，[偏似然](@entry_id:165240)的计算是在每个层内部独立进行的。

当一个协变量不满足 PH 假设，但它本身不是研究的主要焦点（即它是一个需要调整的“滋扰”变量）时，分层是一个非常优雅和强大的工具，特别是当该[分类变量](@entry_id:637195)有很多水平时，分层可以避免估计大量不稳定的参数 [@problem_id:4906471]。

### 评估整体[模型拟合](@entry_id:265652)：Cox-Snell 残差

除了检验 PH 这一特定假设外，我们还需要评估模型的**整体拟合优度 (goodness-of-fit)**，即模型是否准确地描述了数据的生成过程。**Cox-Snell 残差**是用于此目的的标准工具。

对于个体 $i$，其 Cox-Snell 残差定义为其在事件或删失时间 $T_i$ 的估计累积风险值 [@problem_id:4906429]：
$$
R_i = \hat{H}(T_i | \boldsymbol{x}_i) = \hat{H}_0(T_i) \exp(\boldsymbol{x}_i^{\top}\hat{\boldsymbol{\beta}})
$$
其中 $\hat{H}_0(t)$ 是对基准[累积风险函数](@entry_id:169734)的估计。

Cox-Snell 残差有一个非常优美的理论性质：如果 Cox 模型被正确指定（包括函数形式和协[变量选择](@entry_id:177971)），那么这些残差（对于未删失的观测）应近似服从速率为 1 的**指数分布 (standard exponential distribution)**。

这个性质可以通过[概率积分变换](@entry_id:262799)的思想来证明 [@problem_id:4906429]。对于一个[连续随机变量](@entry_id:166541) $T$，其生存函数为 $S(t)$，那么 $S(T)$ 服从 $(0,1)$ 上的均匀分布。在我们的模型中，$S(t|x) = \exp(-H(t|x))$。因此，随机变量 $U = S(T|x) = \exp(-H(T|x))$ 服从均匀分布。而 Cox-Snell 残差 $R = H(T|x)$，所以 $U = \exp(-R)$，即 $R = -\ln(U)$。如果 $U \sim U(0,1)$，那么 $-\ln(U)$ 正是服从速率为 1 的[指数分布](@entry_id:273894)。

在实践中，我们可以通过以下方式来检验这一性质：计算所有个体的 Cox-Snell 残差，并将它们视为一个新的生存数据集（其中删失个体的残差同样被视为删失）。然后，计算这些残差的 [Kaplan-Meier](@entry_id:169317) 生存函数 $\hat{S}_{res}(r)$，并绘制其[累积风险函数](@entry_id:169734) $-\ln(\hat{S}_{res}(r))$ 对残差 $r$ 的图形。如果[模型拟合](@entry_id:265652)良好，该图形应近似于一条通过原点、斜率为 1 的直线。

### 高级主题：时依协变量

在许多研究中，协变量的值并非一成不变，而是会随时间变化。Cox 模型可以自然地扩展以包含**时依协变量 (time-dependent covariates, TDCs)**。然而，使用 TDCs 需要特别小心，因为它会引入新的复杂性和潜在的偏倚。

我们需要区分两种主要类型的时依协变量 [@problem_id:4906495]：

1.  **外部 (External) 时依协变量**：这类协变量的路径由外在于个体的过程决定，不受个体健康状况或事件风险的影响。一个典型的例子是每日的空气污染指数或环境温度 $A(t)$。某个病人的病情恶化不会改变整个城市当天的温度。

2.  **内部 (Internal) 时依协变量**：这类协变量是个体内部生理过程的测量值，其路径本身就反映了个体的健康演变。例如，定期测量的某个心脏病生物标志物 $B_i(t)$。这个标志物的水平变化既是疾病进展的结果，也可能是未来事件的预测因子。

在 Cox 模型中纳入 TDCs 进行有效且无偏的分析，必须满足几个关键假设 [@problem_id:4906495]：
-   **协变量的可预测性 (Predictability)**：在构建风险集时，任何时刻 $t$ 的协变量值必须是由 $t$ 之前的历史信息所决定的，绝不能使用未来的信息。
-   **正确的时间编码**：必须仔细处理协变量的更新时间，以避免**不朽时间偏倚 (immortal time bias)**。例如，如果一个协变量在时间 $t_{obs}$ 被更新，它的新值只能应用于时间区间 $[t_{obs}, t_{next\_obs})$ 内的风险计算。
-   **外部协变量的[外生性](@entry_id:146270) (Exogeneity)**：必须假设个体的风险过程不会反过来影响外部协变量的未来路径。
-   **条件独立删失**：删失机制必须在给定协变量历史的条件下独立于事件时间。对于内部协变量，这个问题尤为复杂，因为导致删失的原因（如病情过重退出研究）可能与内部协变量本身密切相关。

处理时依协变量，特别是内部协变量，是生存分析中的一个高级领域，通常需要更复杂的模型（如联合模型, joint models）来正确处理其内在的反馈循环和测量误差。