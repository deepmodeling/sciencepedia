{"hands_on_practices": [{"introduction": "掌握中位生存时间的估计始于亲手实践。本练习将指导你应用Kaplan-Meier乘积极限法，从一组包含删失数据的临床研究数据中，一步步构建生存函数曲线。通过这个核心计算过程，你将学会如何处理事件和删失数据，并准确地从生存曲线中提取中位生存时间这一关键指标 [@problem_id:4911089]。", "problem": "一个由$20$名患者组成的队列参加了一项临床研究，研究人员对其进行随访以观察死亡时间，对于失访或研究结束时仍存活的患者数据进行右删失处理。令 $T$ 表示非负连续的事件时间随机变量，$S(t) = \\Pr(T > t)$ 表示生存函数。假设为非信息性右删失，并且当事件和删失发生在同一记录时间时，事件先于删失处理。观测数据由数对 $(t_i, \\delta_i)$ 组成，其中 $t_i$ 是以月为单位的记录时间，$\\delta_i \\in \\{0,1\\}$ 指示在 $t_i$ 时刻发生的是死亡（$\\delta_i = 1$）还是右删失（$\\delta_i = 0$）。这$20$个观测数对如下：\n- $(2, 1)$，\n- $(3, 1)$，\n- $(3, 0)$，\n- $(4, 0)$，\n- $(5, 1)$，\n- $(6, 1)$，\n- $(7, 0)$，\n- $(8, 1)$，\n- $(9, 0)$，\n- $(10, 1)$，\n- $(11, 1)$，\n- $(12, 0)$，\n- $(12, 1)$，\n- $(13, 0)$，\n- $(14, 0)$，\n- $(15, 1)$，\n- $(16, 0)$，\n- $(18, 0)$，\n- $(20, 1)$，\n- $(22, 0)$。\n\n仅使用生存函数的定义以及在既定假设下处理右删失的原则，通过 Kaplan–Meier 方法根据这些数据构建 $S(t)$ 的阶梯估计量，然后提取估计的中位生存时间（即估计的生存函数小于或等于 $1/2$ 的最小时间 $t$）。最终时间以月为单位表示，并将答案四舍五入到三位有效数字。", "solution": "用户提供了一个生物统计学问题，要求从右删失数据中估计中位生存时间。\n\n### 第一步：提取已知条件\n-   **队列大小**：$n = 20$ 名患者。\n-   **随机变量**：$T$，一个非负连续事件时间变量。\n-   **生存函数**：$S(t) = \\Pr(T > t)$。\n-   **数据结构**：数对 $(t_i, \\delta_i)$，其中 $t_i$ 是以月为单位的时间，$\\delta_i=1$ 表示事件（死亡），$\\delta_i=0$ 表示右删失。\n-   **假设**：非信息性右删失。对于时间上的并列情况，事件在删失之前处理。\n-   **数据集**：这$20$个观测数对是 $(2, 1)$、$(3, 1)$、$(3, 0)$、$(4, 0)$、$(5, 1)$、$(6, 1)$、$(7, 0)$、$(8, 1)$、$(9, 0), (10, 1)$、$(11, 1)$、$(12, 0)$、$(12, 1)$、$(13, 0)$、$(14, 0)$、$(15, 1)$、$(16, 0)$、$(18, 0)$、$(20, 1)$、$(22, 0)$。\n-   **目标**：构建 $S(t)$ 的 Kaplan-Meier 估计量，并找到估计的中位生存时间，定义为 $\\hat{S}(t) \\le 1/2$ 的最小时间 $t$。结果必须以月为单位，并四舍五入到三位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，因为它是生存分析中的一个基本工具——Kaplan-Meier方法的标准应用。它的提法是恰当的，提供了所有必要的数据、明确的目标和具体的定义，包括一个并列处理规则和要使用的中位生存时间的确切定义。语言客观而精确。数据对于一个小型临床研究来说是合理的。该问题没有违反任何无效标准。\n\n### 第三步：结论与行动\n问题有效。将提供完整的解答。\n\n### 解法\n生存函数 $\\hat{S}(t)$ 的 Kaplan-Meier 估计量是一种用于从可能存在右删失的生存数据中估计 $S(t)$ 的非参数方法。它是一个乘积极限估计量，由以下公式给出：\n$$ \\hat{S}(t) = \\prod_{j: t_{(j)} \\le t} \\left(1 - \\frac{d_j}{n_j}\\right) $$\n其中 $t_{(j)}$ 是至少发生一次事件的不同时间点，$d_j$ 是在时间 $t_{(j)}$ 发生的事件数，而 $n_j$ 是在时间 $t_{(j)}$ 之前处于风险中的个体数量（即那些仍然存活且尚未被删失的个体）。按照惯例，$\\hat{S}(0) = 1$。生存函数的估计值是一个阶梯函数，其值仅在观测到事件的时间点发生变化。\n\n为了计算 $\\hat{S}(t)$，我们首先将不同的事件时间排序，并对每个时间点确定风险集中的个体数量（$n_j$）和事件数量（$d_j$）。我们必须在每个时间点减去发生事件或被删失的受试者，从而仔细追踪处于风险中的受试者数量。受试者总数为 $N=20$。\n\n不同的事件时间点为 $t=2, 3, 5, 6, 8, 10, 11, 12, 15, 20$。我们将计算在这些时间点的生存概率。\n\n-   **初始状态**：在 $t=0$ 时，风险集中的受试者数量为 $n=20$。对于 $t \\in [0, 2)$，$\\hat{S}(t)=1$。\n\n-   **在事件时间 $t_{(1)} = 2$**：\n    -   风险集人数：$n_1 = 20$。\n    -   观测到的事件数：$d_1 = 1$。\n    -   $\\hat{S}(2) = \\hat{S}(0) \\times \\left(1 - \\frac{d_1}{n_1}\\right) = 1 \\times \\left(1 - \\frac{1}{20}\\right) = \\frac{19}{20} = 0.95$。\n    -   下一区间剩余受试者数：$20 - 1(\\text{事件}) = 19$。\n\n-   **在事件时间 $t_{(2)} = 3$**：\n    -   风险集人数：$n_2 = 19$。\n    -   观测到的事件数：$d_2 = 1$。\n    -   $\\hat{S}(3) = \\hat{S}(2) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = \\frac{19}{20} \\times \\left(1 - \\frac{1}{19}\\right) = \\frac{19}{20} \\times \\frac{18}{19} = \\frac{18}{20} = 0.90$。\n    -   在 $t=3$ 时，也有一名受试者被删失。剩余受试者数：$19 - 1(\\text{事件}) - 1(\\text{删失}) = 17$。\n\n-   **在 $t=3$ 和 $t=5$ 之间**：在 $t=4$ 时，一名受试者被删失。剩余受试者数：$17 - 1 = 16$。\n\n-   **在事件时间 $t_{(3)} = 5$**：\n    -   风险集人数：$n_3 = 16$。\n    -   观测到的事件数：$d_3 = 1$。\n    -   $\\hat{S}(5) = \\hat{S}(3) \\times \\left(1 - \\frac{d_3}{n_3}\\right) = \\frac{18}{20} \\times \\left(1 - \\frac{1}{16}\\right) = \\frac{18}{20} \\times \\frac{15}{16} = \\frac{270}{320} = \\frac{27}{32} = 0.84375$。\n    -   剩余受试者数：$16 - 1(\\text{事件}) = 15$。\n\n-   **在事件时间 $t_{(4)} = 6$**：\n    -   风险集人数：$n_4 = 15$。\n    -   观测到的事件数：$d_4 = 1$。\n    -   $\\hat{S}(6) = \\hat{S}(5) \\times \\left(1 - \\frac{d_4}{n_4}\\right) = \\frac{27}{32} \\times \\left(1 - \\frac{1}{15}\\right) = \\frac{27}{32} \\times \\frac{14}{15} = \\frac{378}{480} = \\frac{63}{80} = 0.7875$。\n    -   剩余受试者数：$15 - 1 = 14$。在 $t=7$ 时，一名受试者被删失，剩下 $13$ 人。\n\n-   **在事件时间 $t_{(5)} = 8$**：\n    -   风险集人数：$n_5 = 13$。\n    -   观测到的事件数：$d_5 = 1$。\n    -   $\\hat{S}(8) = \\hat{S}(6) \\times \\left(1 - \\frac{d_5}{n_5}\\right) = \\frac{63}{80} \\times \\left(1 - \\frac{1}{13}\\right) = \\frac{63}{80} \\times \\frac{12}{13} = \\frac{756}{1040} = \\frac{189}{260} \\approx 0.7269$。\n    -   剩余受试者数：$13-1=12$。在 $t=9$ 时，一名受试者被删失，剩下 $11$ 人。\n\n-   **在事件时间 $t_{(6)} = 10$**：\n    -   风险集人数：$n_6 = 11$。\n    -   观测到的事件数：$d_6 = 1$。\n    -   $\\hat{S}(10) = \\hat{S}(8) \\times \\left(1 - \\frac{d_6}{n_6}\\right) = \\frac{189}{260} \\times \\left(1 - \\frac{1}{11}\\right) = \\frac{189}{260} \\times \\frac{10}{11} = \\frac{189}{286} \\approx 0.6608$。\n    -   剩余受试者数：$11-1 = 10$。\n\n-   **在事件时间 $t_{(7)} = 11$**：\n    -   风险集人数：$n_7 = 10$。\n    -   观测到的事件数：$d_7 = 1$。\n    -   $\\hat{S}(11) = \\hat{S}(10) \\times \\left(1 - \\frac{d_7}{n_7}\\right) = \\frac{189}{286} \\times \\left(1 - \\frac{1}{10}\\right) = \\frac{189}{286} \\times \\frac{9}{10} = \\frac{1701}{2860} \\approx 0.5948$。\n    -   剩余受试者数：$10-1 = 9$。\n\n-   **在事件时间 $t_{(8)} = 12$**：\n    -   风险集人数：$n_8 = 9$。\n    -   观测到的事件数：$d_8 = 1$。根据规则，在同一时间，事件在删失之前处理。\n    -   $\\hat{S}(12) = \\hat{S}(11) \\times \\left(1 - \\frac{d_8}{n_8}\\right) = \\frac{1701}{2860} \\times \\left(1 - \\frac{1}{9}\\right) = \\frac{1701}{2860} \\times \\frac{8}{9} = \\frac{1512}{2860} = \\frac{378}{715} \\approx 0.5287$。\n    -   剩余受试者数：$9-1(\\text{事件}) - 1(\\text{删失}) = 7$。\n\n-   **在 $t=12$ 和 $t=15$ 之间**：在 $t=13$ 时，一人被删失（剩 6 人）。在 $t=14$ 时，一人被删失（剩 5 人）。\n\n-   **在事件时间 $t_{(9)} = 15$**：\n    -   风险集人数：$n_9 = 5$。\n    -   观测到的事件数：$d_9 = 1$。\n    -   $\\hat{S}(15) = \\hat{S}(12) \\times \\left(1 - \\frac{d_9}{n_9}\\right) = \\frac{378}{715} \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{378}{715} \\times \\frac{4}{5} = \\frac{1512}{3575} \\approx 0.4229$。\n\n我们要找的是中位生存时间，定义为满足 $\\hat{S}(t) \\le 0.5$ 的最小时间 $t$。\n让我们检查一下我们计算出的估计生存函数的值：\n-   对于 $t \\in [12, 15)$，$\\hat{S}(t) = \\hat{S}(12) \\approx 0.5287$，该值大于 $0.5$。\n-   在 $t=15$ 时，生存函数下降到 $\\hat{S}(15) \\approx 0.4229$，该值小于或等于 $0.5$。\n\n因此，满足条件 $\\hat{S}(t) \\le 0.5$ 的最小时间 $t$ 是 $15$ 个月。\n\n问题要求将答案四舍五入到三位有效数字。确切答案是 $15$。要用三位有效数字表示，我们写作 $15.0$。", "answer": "$$\n\\boxed{15.0}\n$$", "id": "4911089"}, {"introduction": "在计算出中位生存时间后，一个自然而然的问题是：如果生存曲线始终不低于$0.5$会怎样？本练习模拟了真实研究中常见的这种情况，即随访结束时，发生事件的患者未过半。你需要正确解读这种情况下的Kaplan-Meier曲线，并理解右删失中位数的概念，这是对生存分析结果进行严谨解释的关键一步 [@problem_id:4605660]。", "problem": "一项队列研究追踪 $10$ 名患者的事件发生时间结果，数据存在独立的右删失。令 $T$ 表示事件时间，生存函数为 $S(t) = \\mathbb{P}(T > t)$。生存函数的 Kaplan–Meier (KM) 估计量，记为 $\\hat S(t)$，是根据观测到的事件时间和删失时间构建的。中位生存时间 $m$ 定义为满足 $S(t) \\le 0.5$ 的最小时间 $t$。管理性删失发生在最长随访时间 $\\tau$。\n\n假设观测数据如下：\n- $3$ 名患者的事件时间（单位：月）：$2$、$4$、$7$。\n- 其余 $7$ 名患者的删失时间（单位：月）：$9$。\n\n假设除了明确说明的情况外没有时间平局。根据 Kaplan–Meier 估计量的基本原理，计算在事件时间点的 $\\hat S(t)$，并确定 $\\hat S(t)$ 是否在时间 $t = \\tau = 9$ 个月前穿过 $0.5$。然后，基于此判断，选择最恰当描述如何处理中位生存时间估计以及如何在这种情况下正式表示删失中位数或不可行估计情景的选项。\n\nA. 报告中位生存时间为 $7$ 个月，因为这是管理性删失前观测到的最后一个事件时间。\n\nB. 报告中位生存时间在 $[0,\\tau]$ 内不可估计，因为 $\\hat S(t)$ 从未下降到 $\\le 0.5$；通过声明 $m > \\tau$ 将中位数视为在 $\\tau$ 之后右删失，并且，如果需要，可以通过对 $\\hat S(t)$ 的置信区间进行反转来提供 $m$ 的单侧置信下限，和/或报告一个替代性总结指标，如限制性平均生存时间 $\\int_{0}^{\\tau} \\hat S(t)\\, dt$。\n\nC. 在 $\\hat S(7)$ 和 $\\hat S(9)$ 之间进行线性插值，以找到使 $\\hat S(t)$ 等于 $0.5$ 的时间 $t \\in (7,9)$，并报告该时间为中位生存时间。\n\nD. 拟合一个指数参数模型来推算中位生存时间，并报告该值作为 Kaplan–Meier 中位数。", "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- 队列研究中的患者总数：$N = 10$。\n- 结局：具有独立右删失的事件发生时间。\n- 事件时间变量：$T$。\n- 生存函数的定义：$S(t) = \\mathbb{P}(T > t)$。\n- 生存函数的估计量：Kaplan–Meier (KM) 估计量，$\\hat S(t)$。\n- 中位生存时间的定义， $m$：满足 $S(t) \\le 0.5$ 的最小时间 $t$。\n- 最长随访时间（管理性删失）：$\\tau$。\n- 观测数据：\n    - 事件时间：$2$、$4$、$7$ 个月（$d=3$ 名患者）。\n    - 删失时间：$9$ 个月（$c=7$ 名患者）。\n- 假设：除数据中明确说明外，无时间平局。\n- 任务：计算在事件时间点的 $\\hat S(t)$，确定 $\\hat S(t)$ 是否在 $t = \\tau = 9$ 个月时穿过 $0.5$，并选择处理中位生存时间估计的适当选项。\n\n根据数据，最长随访时间 $\\tau$ 为 $9$ 个月，因为这是观测到的最晚时间点，并被指定为管理性删失时间。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于 Kaplan–Meier 估计量，这是生物统计学和流行病学中生存分析的基石。所有概念——生存函数、删失、中位生存时间——都是标准且定义明确的。该问题是这一既定方法的直接应用。\n2.  **适定性：** 该问题提供了构建 Kaplan–Meier 曲线所需的所有数据：总样本量、事件的数量和时间，以及删失的数量和时间。问题具体且可回答。可以根据这些数据构建唯一的 Kaplan-Meier 曲线。\n3.  **客观性：** 该问题使用精确、客观和标准的统计术语进行陈述。没有歧义或主观语言。\n4.  **缺陷分析：**\n    - **科学或事实不健全：** 无。生存分析的原理陈述正确。\n    - **不可形式化或不相关：** 无。该问题是生物统计学中一个正式且相关的练习。\n    - **设置不完整或矛盾：** 无。数据是完整且一致的。发生事件的患者数（$3$）和被删失的患者数（$7$）之和等于队列总人数（$10$）。\n    - **不切实际或不可行：** 无。数据代表了一项合理的小规模研究。\n    - **不适定或结构不良：** 无。中位数的定义是标准的。问题根据数据可以得出一个唯一的结论。\n    - **伪深刻、琐碎或同义反复：** 无。该问题要求对一个标准统计估计量进行正确计算和解释，这不是一项微不足道的任务。\n    - **超出科学可验证性：** 无。计算过程完全可以验证。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。将根据所提供的信息推导解决方案。\n\n### Kaplan–Meier 估计量的推导\n\nKaplan–Meier 估计量 $\\hat S(t)$ 是生存函数的非参数乘积极限估计量。其计算公式为：\n$$ \\hat S(t) = \\prod_{i: t_i \\le t} \\left(1 - \\frac{d_i}{n_i}\\right) $$\n其中 $t_i$ 是不同的事件时间，$d_i$ 是在时间 $t_i$ 发生的事件数，而 $n_i$ 是在时间 $t_i$ 之前处于风险中的个体数（即存活且尚未被删失）。\n\n首先按时间对数据进行排序：\n- 事件发生于 $t=2$。\n- 事件发生于 $t=4$。\n- 事件发生于 $t=7$。\n- $7$ 名患者在 $t=9$ 时被删失。\n\n我们构建一个生命表来计算每个事件时间点的 $\\hat S(t)$。\n\n1.  **时间 $t=0$**：研究开始。风险中的患者数为 $n_0=10$。对于 $t \\in [0, 2)$，生存估计为 $\\hat S(t) = 1.0$。\n\n2.  **事件发生于 $t_1 = 2$ 个月**：\n    - 在 $t=2$ 之前的风险人数：$n_1 = 10$。\n    - 在 $t=2$ 的事件数：$d_1 = 1$。\n    - 此步骤的生存概率为 $(1 - d_1/n_1) = (1 - 1/10) = 0.9$。\n    - 累积生存率为 $\\hat S(2) = 1.0 \\times 0.9 = 0.9$。\n    - 对于 $t \\in [2, 4)$，$\\hat S(t) = 0.9$。\n    - 事件发生后，仍有 $10 - 1 = 9$ 名患者处于风险中。\n\n3.  **事件发生于 $t_2 = 4$ 个月**：\n    - 在 $t=4$ 之前的风险人数：$n_2 = 9$。\n    - 在 $t=4$ 的事件数：$d_2 = 1$。\n    - 此步骤的生存概率为 $(1 - d_2/n_2) = (1 - 1/9) = 8/9$。\n    - 累积生存率为 $\\hat S(4) = \\hat S(2) \\times (8/9) = 0.9 \\times (8/9) = (9/10) \\times (8/9) = 8/10 = 0.8$。\n    - 对于 $t \\in [4, 7)$，$\\hat S(t) = 0.8$。\n    - 事件发生后，仍有 $9 - 1 = 8$ 名患者处于风险中。\n\n4.  **事件发生于 $t_3 = 7$ 个月**：\n    - 在 $t=7$ 之前的风险人数：$n_3 = 8$。\n    - 在 $t=7$ 的事件数：$d_3 = 1$。\n    - 此步骤的生存概率为 $(1 - d_3/n_3) = (1 - 1/8) = 7/8$。\n    - 累积生存率为 $\\hat S(7) = \\hat S(4) \\times (7/8) = 0.8 \\times (7/8) = (8/10) \\times (7/8) = 7/10 = 0.7$。\n    - 对于 $t \\in [7, 9)$，$\\hat S(t) = 0.7$。\n    - 事件发生后，仍有 $8 - 1 = 7$ 名患者处于风险中。\n\n5.  **在 $t = 9$ 个月时删失**：\n    - 在 $t=9$ 时，其余 $7$ 名患者被删失。\n    - 删失事件不会导致 Kaplan–Meier 生存估计值发生变化。因此，在 $t=9$ 时，$\\hat S(t)$ 的值仍为 $0.7$。\n    - 研究在 $\\tau=9$ 个月时结束。生存函数的最后一个计算值为 $\\hat S(9) = 0.7$。\n\n### 中位生存时间的确定\n\n中位生存时间 $m$ 定义为使 $\\hat S(t) \\le 0.5$ 成立的最小时间 $t$。\n根据我们的计算，在随访期结束时（$t=\\tau=9$），生存估计的最终值为 $\\hat S(9) = 0.7$。\n由于 $0.7 > 0.5$，Kaplan–Meier 曲线在观测期 $[0, 9]$ 内从未下降到或低于 $0.5$ 的阈值。因此，中位生存时间未达到，无法从观测数据中估计。唯一可以得出的结论是，中位生存时间大于最长随访持续时间，即 $m > 9$ 个月。这被称为右删失中位数。\n\n### 逐项分析选项\n\n**A. 报告中位生存时间为 $7$ 个月，因为这是管理性删失前观测到的最后一个事件时间。**\n- **分析：** 这是不正确的。中位生存时间是由生存概率达到 $0.5$ 定义的，而不是由最后一次观测到的事件时间决定的。在 $t=7$ 个月时，估计的生存概率是 $\\hat S(7) = 0.7$，这远高于 $0.5$。\n- **结论：** 不正确。\n\n**B. 报告中位生存时间在 $[0,\\tau]$ 内不可估计，因为 $\\hat S(t)$ 从未下降到 $\\le 0.5$；通过声明 $m > \\tau$ 将中位数视为在 $\\tau$ 之后右删失，并且，如果需要，可以通过对 $\\hat S(t)$ 的置信区间进行反转来提供 $m$ 的单侧置信下限，和/或报告一个替代性总结指标，如限制性平均生存时间 $\\int_{0}^{\\tau} \\hat S(t)\\, dt$。**\n- **分析：** 该陈述准确地反映了我们推导的结果。KM 估计量 $\\hat S(t)$ 在研究结束时的最小值为 $0.7$，因此它从未达到 $\\le 0.5$。在这种情况下，正确的统计实践是得出结论：中位数在研究时间范围内不可估计，并且是右删失的，即 $m > \\tau=9$ 个月。该选项还正确列出了针对此类情况的标准且适当的替代总结方法：通过对 $S(t)$ 的置信区间进行反转来找到中位数的下限，或计算限制性平均生存时间 (RMST)，即 KM 曲线下直到 $\\tau$ 的面积。此选项代表了一种完整且专业上合理的处理方法。\n- **结论：** 正确。\n\n**C. 在 $\\hat S(7)$ 和 $\\hat S(9)$ 之间进行线性插值，以找到使 $\\hat S(t)$ 等于 $0.5$ 的时间 $t \\in (7,9)$，并报告该时间为中位生存时间。**\n- **分析：** 这是一个无效的程序。Kaplan–Meier 曲线是一个阶梯函数，而不是一条连续的线。它在事件时间之间是恒定的。具体来说，对于区间 $[7, 9)$ 中的任何时间 $t$，$\\hat S(t) = 0.7$。线性插值不是 KM 估计方法的一个特征，它会假设生存概率线性下降，而模型明确指出其是恒定的，从而产生一个虚假的结果。\n- **结论：** 不正确。\n\n**D. 拟合一个指数参数模型来推算中位生存时间，并报告该值作为 Kaplan–Meier 中位数。**\n- **分析：** 该选项建议从非参数方法 (Kaplan–Meier) 转换为参数方法（指数模型）。虽然拟合参数模型是一种有效的统计技术，但由此产生的中位数估计值将来自指数模型，而不是 Kaplan–Meier 估计量。问题明确要求的是 Kaplan–Meier 中位数。将参数估计与非参数估计相混淆是一种方法论上的错误。\n- **结论：** 不正确。", "answer": "$$\\boxed{B}$$", "id": "4605660"}, {"introduction": "一个点估计值，如中位生存时间，本身并不能完全反映信息的全貌；我们还需要了解其不确定性。本练习将引导你超越点估计，探索如何使用非参数自助法（bootstrap）来量化估计的稳健性。通过思考如何对包含删失的数据进行重抽样，你将掌握估计生存统计量（如中位生存时间和限制性平均生存时间）置信区间的基本原理 [@problem_id:4948655]。", "problem": "一位生物统计学家正在分析一项队列研究中的右删失生存数据。对于每个受试者，观测数据包括一个观测时间 $t_i$ 和一个删失指示符 $\\delta_i \\in \\{0,1\\}$，其中 $\\delta_i = 1$ 表示事件发生，$\\delta_i = 0$ 表示右删失。假设受试者是独立同分布的，右删失是非信息性的，并且生存函数 $S(t)$ 通过 Kaplan–Meier (KM) 估计量进行非参数估计。目标泛函是中位生存时间 $m$（定义为使 $S(t) \\leq 0.5$ 的最小时间 $t$）和在预设截断时间 $\\tau$ 的限制性平均生存时间 (RMST)（定义为 $R(\\tau) = \\int_{0}^{\\tau} S(t)\\, dt$）。\n\n该生物统计学家希望使用带有案例重抽样的非参数自助法来获取 $m$ 和 $R(\\tau)$ 的点估计和稳健方差估计。在存在右删失的情况下，以下哪个选项正确且完整地定义了一个科学上合理的、使用案例重抽样来处理 $m$ 和 $R(\\tau)$ 的自助法程序？\n\nA. 从原始样本中有放回地抽取 $n$ 个受试者水平的配对 $(t_i, \\delta_i)$，以形成一个自助样本。在每个自助样本上，计算 Kaplan–Meier 估计量 $\\widehat{S}^{\\ast}(t)$，将自助中位数 $m^{\\ast}$ 定义为使 $\\widehat{S}^{\\ast}(t) \\leq 0.5$ 的最小时间 $t$，并计算自助 RMST $R^{\\ast}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}^{\\ast}(t)\\, dt$（其中 $\\tau$ 固定）。重复此重抽样过程 $B$ 次，以获得 $\\{m^{\\ast}_b\\}_{b=1}^{B}$ 和 $\\{R^{\\ast}_b(\\tau)\\}_{b=1}^{B}$；使用这些自助复制的样本方差作为稳健方差估计，并使用百分位区间作为置信区间。将基于原始样本的 KM 估计得到的 $m$ 和 $R(\\tau)$ 作为点估计报告。\n\nB. 仅对未删失的事件时间 $\\{t_i : \\delta_i = 1\\}$ 进行有放回的重抽样以形成自助样本，忽略删失观测，并将重抽样时间的样本中位数计算为 $m^{\\ast}$。对于 RMST，对在 $\\tau$ 处截断的重抽样事件时间求平均值来定义 $R^{\\ast}(\\tau)$。重复 $B$ 次，并使用复制间的经验变异性进行方差估计。\n\nC. 对原始数据拟合一个指数生存模型，从拟合的模型中模拟 $n$ 个不含删失的生存时间，并直接从模拟的参数生存曲线上计算 $m^{\\ast}$ 和 $R^{\\ast}(\\tau)$。重复 $B$ 次，并使用参数复制间的变异性进行方差估计。\n\nD. 在每个自助复制内部，仅重抽样事件时间以重建风险集，计算 Nelson–Aalen 累积风险 $\\widehat{H}^{\\ast}(t)$，将 $m^{\\ast}$ 设为求解 $\\widehat{H}^{\\ast}(t) = \\log(2)$ 的时间，并将 $R^{\\ast}(\\tau)$ 定义为 $\\int_{0}^{\\tau} \\left[1 - \\widehat{H}^{\\ast}(t)\\right] dt$。重复 $B$ 次，并使用复制间的经验方差进行方差估计。\n\nE. 拟合一个 Cox 比例风险模型，对模型残差进行有放回的重抽样，在每个残差重抽样的数据集上重新拟合模型，并从针对“平均”受试者的基于模型的生存曲线中计算 $m^{\\ast}$ 和 $R^{\\ast}(\\tau)$。重复 $B$ 次，并使用复制间的经验方差进行方差估计。", "solution": "问题陈述提出了生物统计学领域中一个明确定义的问题，具体涉及应用一种标准的重抽样方法来估计常见的生存分析泛函的方差。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   **数据结构**：来自队列研究的右删失生存数据。\n-   **受试者 $i$ 的观测值**：一对值 $(t_i, \\delta_i)$，其中 $t_i$ 是观测时间，$\\delta_i$ 是删失指示符。\n-   **删失指示符**：$\\delta_i \\in \\{0, 1\\}$，其中 $\\delta_i = 1$ 表示事件，$\\delta_i = 0$ 表示右删失。\n-   **假设**：\n    1.  受试者是独立同分布 (i.i.d.) 的。\n    2.  右删失是非信息性的。\n-   **生存函数估计量**：非参数 Kaplan–Meier (KM) 估计量，$\\widehat{S}(t)$。\n-   **目标泛函 1（中位生存时间）**：$m$，定义为使 $S(t) \\leq 0.5$ 的最小时间 $t$。\n-   **目标泛函 2（限制性平均生存时间）**：$R(\\tau) = \\int_{0}^{\\tau} S(t)\\, dt$，其中 $\\tau$ 为预设的截断时间。\n-   **目标**：为使用带有案例重抽样的非参数自助法获取 $m$ 和 $R(\\tau)$ 的点估计和稳健方差估计，定义一个科学上合理的程序。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据、提法明确且客观。\n-   **科学依据**：所提出的概念——右删失、Kaplan-Meier 估计、中位生存时间、限制性平均生存时间以及非参数自助法——都是生存分析和生物统计学中的基本和标准课题。i.i.d. 受试者和非信息性删失的假设是这些方法有效的标准条件。\n-   **提法明确**：该问题要求为一个明确定义的目的，确定一个特定、公认的统计程序（带有案例重抽样的非参数自助法）的正确定义。存在一个唯一的、正确的程序，并且可以从自助法理论的基本原理中推导出来。\n-   **客观性**：所用术语在该领域内是精确和标准的，没有歧义或主观性。\n\n**步骤 3：结论和行动**\n问题陈述是有效的。任务是在给定选项中确定正确的程序。\n\n### 推导与选项分析\n\n由 Bradley Efron 提出的非参数自助法是一种用于估计统计量抽样分布的计算方法。其核心原理是用观测样本的经验分布来近似总体分布。然后通过从这个经验分布中抽样来生成一个自助样本。在独立同分布 (i.i.d.) 数据的背景下，这相当于对原始观测值进行有放回的重抽样。\n\n对于生存数据，其中每个受试者 $i$ 贡献一对观测值 $(t_i, \\delta_i)$，“案例”或“观测单位”就是这对值。为了保持观测时间与事件/删失状态之间的关系，自助法程序必须将这些配对一起进行重抽样。这被称为“案例重抽样”或“对偶重抽样”。\n\n$m$ 和 $R(\\tau)$ 这两个泛函的非参数自助法的一般算法如下：\n\n1.  根据大小为 $n$ 的原始样本 $\\{(t_i, \\delta_i)\\}_{i=1}^n$，计算 Kaplan-Meier 生存曲线 $\\widehat{S}(t)$。\n2.  从 $\\widehat{S}(t)$ 计算中位生存时间的点估计 $\\hat{m} = \\inf\\{t : \\widehat{S}(t) \\leq 0.5\\}$ 和限制性平均生存时间的点估计 $\\widehat{R}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}(t)\\, dt$。这些是最终报告的点估计值。\n3.  重复以下步骤 $b=1, \\dots, B$ 次（其中 $B$ 是一个大数，例如 1000 或更多）：\n    a.  通过从原始样本 $\\{(t_i, \\delta_i)\\}_{i=1}^n$ 中有放回地抽取 $n$ 对值 $(t_i^{\\ast,b}, \\delta_i^{\\ast,b})$，生成一个大小为 $n$ 的自助样本。\n    b.  使用此自助样本，应用与步骤 1 完全相同的估计程序：计算 Kaplan-Meier 曲线 $\\widehat{S}^{\\ast,b}(t)$。\n    c.  从 $\\widehat{S}^{\\ast,b}(t)$ 计算统计量的自助复制值：$m^{\\ast,b} = \\inf\\{t : \\widehat{S}^{\\ast,b}(t) \\leq 0.5\\}$ 和 $R^{\\ast,b}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}^{\\ast,b}(t)\\, dt$。\n4.  自助复制的集合 $\\{m^{\\ast,b}\\}_{b=1}^B$ 和 $\\{R^{\\ast,b}(\\tau)\\}_{b=1}^B$ 分别构成了 $\\hat{m}$ 和 $\\widehat{R}(\\tau)$ 抽样分布的经验近似。\n5.  自助复制的样本方差，例如 $\\widehat{\\text{Var}}(\\hat{m}) \\approx \\frac{1}{B-1}\\sum_{b=1}^{B} (m^{\\ast,b} - \\bar{m}^{\\ast})^2$，被用作原始估计量方差的估计。置信区间可以使用自助分布的百分位数（百分位法）来构建。\n\n我们现在根据这个正确的程序来评估每个选项。\n\n**A. 从原始样本中有放回地抽取 $n$ 个受试者水平的配对 $(t_i, \\delta_i)$，以形成一个自助样本。在每个自助样本上，计算 Kaplan–Meier 估计量 $\\widehat{S}^{\\ast}(t)$，将自助中位数 $m^{\\ast}$ 定义为使 $\\widehat{S}^{\\ast}(t) \\leq 0.5$ 的最小时间 $t$，并计算自助 RMST $R^{\\ast}(\\tau) = \\int_{0}^{\\tau} \\widehat{S}^{\\ast}(t)\\, dt$（其中 $\\tau$ 固定）。重复此重抽样过程 $B$ 次，以获得 $\\{m^{\\ast}_b\\}_{b=1}^{B}$ 和 $\\{R^{\\ast}_b(\\tau)\\}_{b=1}^{B}$；使用这些自助复制的样本方差作为稳健方差估计，并使用百分位区间作为置信区间。将基于原始样本的 KM 估计得到的 $m$ 和 $R(\\tau)$ 作为点估计报告。**\n\n该选项精确且完整地描述了用于生存数据的带有案例重抽样的标准非参数自助法程序。它正确地将重抽样单位确定为配对 $(t_i, \\delta_i)$，指明了对每个自助样本应用相同的估计程序（KM 曲线和派生的泛函），并正确描述了如何使用得到的自助分布进行推断（方差估计、置信区间）以及报告哪些值作为点估计。\n**结论：正确。**\n\n**B. 仅对未删失的事件时间 $\\{t_i : \\delta_i = 1\\}$ 进行有放回的重抽样以形成自助样本，忽略删失观测，并将重抽样时间的样本中位数计算为 $m^{\\ast}$。对于 RMST，对在 $\\tau$ 处截断的重抽样事件时间求平均值来定义 $R^{\\ast}(\\tau)$。重复 $B$ 次，并使用复制间的经验变异性进行方差估计。**\n\n这个程序存在根本性缺陷。忽略删失观测违反了生存分析的原则。在时间 $t_c$ 的一个删失观测提供了受试者至少存活到 $t_c$ 的关键信息。丢弃此信息会导致对生存时间的系统性低估，从而引入显著的偏倚。Kaplan-Meier 估计量正是为了正确地整合来自事件时间和删失时间的信息而设计的。该选项丢弃了关键信息，在科学上是不成立的。\n**结论：不正确。**\n\n**C. 对原始数据拟合一个指数生存模型，从拟合的模型中模拟 $n$ 个不含删失的生存时间，并直接从模拟的参数生存曲线上计算 $m^{\\ast}$ 和 $R^{\\ast}(\\tau)$。重复 $B$ 次，并使用参数复制间的变异性进行方差估计。**\n\n这描述的是一种*参数自助法*。它依赖于生存时间服从指数分布这一强假设。问题指定使用*非参数* KM 估计量，并要求使用带有案例重抽样的*非参数自助法*。该选项描述了一个不同的、且依赖更多假设的程序。\n**结论：不正确。**\n\n**D. 在每个自助复制内部，仅重抽样事件时间以重建风险集，计算 Nelson–Aalen 累积风险 $\\widehat{H}^{\\ast}(t)$，将 $m^{\\ast}$ 设为求解 $\\widehat{H}^{\\ast}(t) = \\log(2)$ 的时间，并将 $R^{\\ast}(\\tau)$ 定义为 $\\int_{0}^{\\tau} \\left[1 - \\widehat{H}^{\\ast}(t)\\right] dt$。重复 $B$ 次，并使用复制间的经验方差进行方差估计。**\n\n这个选项有多个错误。首先，与选项 B 类似，它建议仅重抽样事件时间，这是不正确的，因为它丢弃了来自删失受试者的信息并错误地构建了风险集。其次，RMST 的公式是错误的。RMST 是 $R(\\tau) = \\int_0^\\tau S(t) \\, dt$。生存函数 $S(t)$ 与累积风险函数 $H(t)$ 的关系是 $S(t) = \\exp(-H(t))$。所提出的公式 $\\int_{0}^{\\tau} [1 - \\widehat{H}^{\\ast}(t)] \\, dt$ 与 RMST 的正确定义不等价。近似式 $S(t) \\approx 1 - H(t)$ 仅在 $H(t)$ 非常小（即 $t$ 很小）时才成立。\n**结论：不正确。**\n\n**E. 拟合一个 Cox 比例风险模型，对模型残差进行有放回的重抽样，在每个残差重抽样的数据集上重新拟合模型，并从针对“平均”受试者的基于模型的生存曲线中计算 $m^{\\ast}$ 和 $R^{\\ast}(\\tau)$。重复 $B$ 次，并使用复制间的经验方差进行方差估计。**\n\n这描述了针对 Cox 比例风险模型的一种基于模型的自助法。Cox 模型是一种半参数回归模型，用于评估协变量对生存的影响，这与问题中所述的在单个队列中对生存函数进行非参数估计的目标不同。问题陈述指定使用非参数 Kaplan-Meier 估计量，而不是 Cox 模型。该选项描述了一个完全不同的分析。\n**结论：不正确。**\n\n总而言之，只有选项 A 正确地描述了用于估计从 Kaplan-Meier 曲线派生的泛函方差的、带有案例重抽样的非参数自助法。", "answer": "$$\\boxed{A}$$", "id": "4948655"}]}