{"hands_on_practices": [{"introduction": "指数模型是参数生存模型中最基础的一种，它假设事件发生的风险（或称风险率 $\\lambda$）在整个研究期间保持不变。这个练习将引导你运用最大似然估计（MLE）这一核心统计原理，来推导在存在右删失数据的情况下，如何估计恒定风险率 $\\lambda$。通过这个过程，你将发现抽象的MLE方法最终导向一个非常直观的结果，即将参数 $\\lambda$ 理解为单位时间内的平均事件发生率，这有助于你将理论与流行病学中的发病率概念紧密联系起来。[@problem_id:4978007]", "problem": "在一个评估至复合心血管事件发生时间的随机临床注册研究中，有 $n$ 名患者，每位患者 $i$ 贡献一个观测随访持续时间 $x_i$ 和一个事件指示符 $\\delta_i$，其中 $x_i = \\min\\{t_i, c_i\\}$ 是真实事件时间 $t_i$ 和右删失时间 $c_i$ 的最小值，且 $\\delta_i = \\mathbb{I}(t_i \\le c_i)$ 指示事件是否被观测到。假设为独立的、非信息性的右删失，并采用参数化生存模型，其中事件时间 $t_i$ 服从指数分布，其风险参数 $\\lambda  0$ 为常数。该指数模型的特征为生存函数 $S(t) = \\exp(-\\lambda t)$ 和密度函数 $f(t) = \\lambda \\exp(-\\lambda t)$（对于 $t \\ge 0$）。使用似然原理以及右删失情况下每个受试者的贡献，推导参数 $\\lambda$ 的最大似然估计量，即通过最大似然估计 (MLE) 得到的估计量，并根据本研究中的可观测数量来确定其解释。哪个选项正确陈述了闭式估计量及其解释？\n\nA. 估计量是观测到的事件数除以所有患者的总观测随访时间，它估计了队列累积风险时间内的单位时间平均事件率。\n\nB. 估计量是总观测随访时间除以观测到的事件数，它估计了每个事件的平均生存时间。\n\nC. 在形状参数 $k$ 未知的 Weibull 模型下，估计量是观测到的事件数除以 $x_i^k$ 的总和，它估计了按样本量归一化的瞬时风险。\n\nD. 估计量是观测到的事件数除以入组的患者数，它估计了随访期间经历事件的患者比例。", "solution": "问题陈述是指数模型下带右删失数据的生存分析的标准表述。它具有科学依据，提法恰当且客观。没有矛盾、缺失数据或模糊术语。该问题是有效的。\n\n我们的任务是，在给定右删失数据的情况下，推导指数分布率参数 $\\lambda$ 的最大似然估计量 (MLE)。$n$ 名患者中每位患者的数据都包含一对 $(x_i, \\delta_i)$，其中 $x_i$ 是观测到的随访时间，$\\delta_i$ 是事件指示符。随访时间 $x_i = \\min\\{t_i, c_i\\}$ 是真实事件时间 $t_i$ 和删失时间 $c_i$ 的最小值。事件指示符在事件被观测到时为 $\\delta_i = 1$ ($t_i \\le c_i$)，在观测被删失时为 $\\delta_i = 0$ ($t_i  c_i$)。\n\n推导过程通过构建观测数据的似然函数来进行。对于右删失数据，似然函数构建的原则是：个体对似然函数的贡献，如果在时间 $x_i$ 观测到事件，则为概率密度函数 $f(x_i)$；如果仅知道个体存活至时间 $x_i$，则为生存函数 $S(x_i)$。\n\n患者 $i$ 对似然函数 $L_i(\\lambda)$ 的贡献可以写为：\n$$ L_i(\\lambda) = [f(x_i)]^{\\delta_i} [S(x_i)]^{1-\\delta_i} $$\n这种紧凑形式正确地表示了两种情况下的贡献：\n- 如果事件被观测到 ($\\delta_i=1$): $L_i(\\lambda) = f(x_i)^1 S(x_i)^0 = f(x_i)$。\n- 如果观测被删失 ($\\delta_i=0$): $L_i(\\lambda) = f(x_i)^0 S(x_i)^1 = S(x_i)$。\n\n问题陈述指出事件时间服从参数为 $\\lambda  0$ 的指数分布。概率密度函数 (PDF) 为 $f(t) = \\lambda e^{-\\lambda t}$，生存函数 (SF) 为 $S(t) = e^{-\\lambda t}$。\n将这些代入 $L_i(\\lambda)$ 的表达式中：\n$$ L_i(\\lambda) = [\\lambda e^{-\\lambda x_i}]^{\\delta_i} [e^{-\\lambda x_i}]^{1-\\delta_i} $$\n我们可以通过合并指数项来简化此表达式：\n$$ L_i(\\lambda) = \\lambda^{\\delta_i} (e^{-\\lambda x_i})^{\\delta_i} (e^{-\\lambda x_i})^{1-\\delta_i} = \\lambda^{\\delta_i} e^{-\\lambda x_i (\\delta_i + 1 - \\delta_i)} = \\lambda^{\\delta_i} e^{-\\lambda x_i} $$\n\n假设所有 $n$ 名患者的观测是独立的，总似然函数 $L(\\lambda)$ 是各个贡献的乘积：\n$$ L(\\lambda) = \\prod_{i=1}^{n} L_i(\\lambda) = \\prod_{i=1}^{n} \\left( \\lambda^{\\delta_i} e^{-\\lambda x_i} \\right) $$\n通过分离涉及 $\\lambda$ 的项和指数项，我们得到：\n$$ L(\\lambda) = \\left( \\prod_{i=1}^{n} \\lambda^{\\delta_i} \\right) \\left( \\prod_{i=1}^{n} e^{-\\lambda x_i} \\right) = \\lambda^{\\sum_{i=1}^{n} \\delta_i} \\exp\\left(-\\lambda \\sum_{i=1}^{n} x_i\\right) $$\n\n让我们从数据中定义两个汇总统计量：\n1. 观测到的事件总数：$D = \\sum_{i=1}^{n} \\delta_i$。\n2. 总观测随访时间（或总人时风险）：$T = \\sum_{i=1}^{n} x_i$。\n\n现在，似然函数可以简明地写为：\n$$ L(\\lambda) = \\lambda^D e^{-\\lambda T} $$\n为了找到 MLE，我们关于 $\\lambda$ 最大化 $L(\\lambda)$。在计算上，最大化对数似然函数 $\\ell(\\lambda) = \\ln(L(\\lambda))$ 更为简单。\n$$ \\ell(\\lambda) = \\ln(\\lambda^D e^{-\\lambda T}) = D \\ln(\\lambda) - \\lambda T $$\n为了找到最大值，我们对 $\\ell(\\lambda)$ 关于 $\\lambda$ 求一阶导数，并将其设为零：\n$$ \\frac{d\\ell}{d\\lambda} = \\frac{d}{d\\lambda}(D \\ln(\\lambda) - \\lambda T) = \\frac{D}{\\lambda} - T $$\n将导数设为零，得到 MLE 的方程，记为 $\\hat{\\lambda}$：\n$$ \\frac{D}{\\hat{\\lambda}} - T = 0 \\implies \\frac{D}{\\hat{\\lambda}} = T \\implies \\hat{\\lambda} = \\frac{D}{T} $$\n为了确认这对应一个最大值，我们检查二阶导数：\n$$ \\frac{d^2\\ell}{d\\lambda^2} = -\\frac{D}{\\lambda^2} $$\n由于 $D$（事件数）是非负的，$\\lambda^2$ 是正的，所以二阶导数小于或等于零。对于 $D  0$ 的非平凡情况，二阶导数是严格为负的，这证实了 $\\hat{\\lambda}$ 确实是一个最大似然估计量。\n\n推导出的 MLE 是：\n$$ \\hat{\\lambda} = \\frac{\\sum_{i=1}^{n} \\delta_i}{\\sum_{i=1}^{n} x_i} = \\frac{\\text{总观测事件数}}{\\text{总观测随访时间}} $$\n这是发生率的公式。在指数模型的背景下，参数 $\\lambda$ 代表恒定的风险率，即单位时间内的瞬时事件风险。因此，估计量 $\\hat{\\lambda}$ 是估计的恒定事件率，其计算方法是队列中观测到的事件总数除以该队列累积的风险时间。\n\n现在我们评估每个选项：\n\n**A. 估计量是观测到的事件数除以所有患者的总观测随访时间，它估计了队列累积风险时间内的单位时间平均事件率。**\n- **估计量形式**：“观测到的事件数除以所有患者的总观测随访时间”与我们推导出的估计量 $\\hat{\\lambda} = \\frac{D}{T}$ 完全对应。这是正确的。\n- **解释**：参数 $\\lambda$ 是一个恒定的事件率。MLE $\\hat{\\lambda}$ 是基于整个队列经验的估计值。将其表述为“队列累积风险时间内的单位时间平均事件率”是流行病学中对发生率（即 $\\hat{\\lambda}$ 所代表的）的精确和标准解释。这是正确的。\n- **结论**：正确。\n\n**B. 估计量是总观测随访时间除以观测到的事件数，它估计了每个事件的平均生存时间。**\n- **估计量形式**：这描述的是量 $\\frac{T}{D} = \\frac{1}{\\hat{\\lambda}}$。这是指数模型中平均生存时间 ($1/\\lambda$) 的 MLE，而不是率参数 $\\lambda$ 的 MLE。问题明确要求的是 $\\lambda$ 的估计量。这是不正确的。\n- **解释**：量 $1/\\lambda$ 是平均事件时间。这个解释对于 $1/\\hat{\\lambda}$ 是合理的，但对于 $\\lambda$ 来说，估计量形式是错误的。\n- **结论**：不正确。\n\n**C. 在形状参数 $k$ 未知的 Weibull 模型下，估计量是观测到的事件数除以 $x_i^k$ 的总和，它估计了按样本量归一化的瞬时风险。**\n- **估计量形式**：这个选项将模型从指数模型更改为 Weibull 模型。指数模型是 Weibull 模型在形状参数 $k=1$ 时的特例。如果我们在所给公式中设置 $k=1$，我们会得到 $\\frac{D}{\\sum x_i^1} = \\frac{D}{T}$，这与我们的结果相符。然而，该选项假设一个通用的 Weibull 模型并声称此形式成立，但这仅在 $k$ 已知时才成立。问题陈述明确指定了指数模型。因此，这个选项解决的是一个不同的问题。\n- **结论**：不正确。\n\n**D. 估计量是观测到的事件数除以入组的患者数，它估计了随访期间经历事件的患者比例。**\n- **估计量形式**：这描述的是量 $\\frac{D}{n} = \\frac{\\sum \\delta_i}{n}$。这是发生事件的受试者的简单比例。这不是 $\\lambda$ 的 MLE，因为它忽略了数据的时间维度（即 $x_i$ 的值）。它将一个随访1天的患者与一个随访10年的患者同等对待。这不是从时间-事件数据的似然原理推导出的正确估计量。\n- **结论**：不正确。\n\n基于严谨的推导，只有选项 A 正确地提供了 $\\lambda$ 的 MLE 的数学形式及其在生存分析背景下的正确统计解释。", "answer": "$$\\boxed{A}$$", "id": "4978007"}, {"introduction": "在生存分析中，估计出模型的参数（如指数模型中的 $\\lambda$ 或威布尔模型中的 $k$ 和 $\\alpha$）仅仅是第一步。为了让模型结果具有临床意义，我们需要将这些抽象的参数转化为易于理解和解释的指标，例如中位生存时间，即50%的个体发生事件所需的时间。本练习将指导你如何从生存函数 $S(t)$ 的定义出发，为指数模型和更具灵活性的威爾模型推导出中位生存时间的精确表达式，从而将模型的数学形式与关键的临床终点联系起来。[@problem_id:4977992]", "problem": "一个事件发生时间变量 $T$ 表示在对局限性前列腺癌进行根治性治疗后，一个在复发前无失访的队列中发生生化复发的时间。假设 $T$ 在 $(0,\\infty)$ 上服从连续分布，其概率密度函数严格为正，且无点质量。设生存函数为 $S(t)=\\mathbb{P}(Tt)$，累积分布函数为 $F(t)=\\mathbb{P}(T\\le t)$。\n\n1. 仅使用 $S(t)$ 和 $F(t)$ 的定义，以及中位数 $t_{0.5}$ 的定义（即任何满足 $F(t_{0.5})\\ge 0.5$ 和 $\\mathbb{P}(T\\ge t_{0.5})\\ge 0.5$ 的值），证明在所述的连续性条件下，生存中位数 $t_{0.5}$ 满足 $S(t_{0.5})=0.5$。\n\n2. 在参数化生存模型中，风险函数 $h(t)$ 的定义为 $h(t)=\\lim_{\\Delta t\\downarrow 0}\\frac{\\mathbb{P}(t\\le T  t+\\Delta t \\mid T\\ge t)}{\\Delta t}$。考虑两种模型：(i) 风险率恒为 $\\lambda$ 的指数模型，和 (ii) 风险函数为 $h(t)=\\frac{k}{\\alpha}\\left(\\frac{t}{\\alpha}\\right)^{k-1}$ 的韦伯模型（其中 $k>0$ 为形状参数，$\\alpha>0$ 为尺度参数）。请推导这两种模型的中位生存时间 $t_{0.5}$，并以行向量 $(t_{0.5}^{\\text{(exp)}},\\,t_{0.5}^{\\text{(weib)}})$ 的形式给出结果。", "solution": "我们从生存分析的核心定义开始。对于一个非负、连续分布的事件发生时间变量 $T$，其生存函数为 $S(t)=\\mathbb{P}(Tt)$，累积分布函数为 $F(t)=\\mathbb{P}(T\\le t)$，这两个函数满足基本恒等式\n$$\nF(t) \\;=\\; 1 - S(t),\n$$\n该恒等式直接由补集法则得出，因为 $\\{T\\le t\\}$ 和 $\\{Tt\\}$ 是互补事件。\n\n第1部分：通过生存函数表征中位数。中位数 $t_{0.5}$ 定义为满足 $F(t_{0.5})\\ge 0.5$ 和 $\\mathbb{P}(T\\ge t_{0.5})\\ge 0.5$ 的任何值。在所述的假设下，$T$ 在 $(0,\\infty)$ 上是连续分布且无点质量，$F$ 是连续且严格递增的，而 $S$ 是连续且严格递减的。特别地，连续性意味着中位数的集合是单点集，并且满足\n$$\nF(t_{0.5}) \\;=\\; 0.5.\n$$\n使用 $F(t)=1-S(t)$，我们得到\n$$\nS(t_{0.5}) \\;=\\; 1 - F(t_{0.5}) \\;=\\; 1 - 0.5 \\;=\\; 0.5.\n$$\n因此，在所述条件下，生存中位数 $t_{0.5}$ 由方程 $S(t_{0.5})=0.5$ 刻画。\n\n第2部分：指数模型和韦伯模型中 $t_{0.5}$ 的显式计算。我们从风险函数 $h(t)$ 和累积风险 $H(t)=\\int_{0}^{t}h(u)\\,\\mathrm{d}u$ 的定义出发。一个基本关系连接了生存函数和累积风险：\n$$\nS(t) \\;=\\; \\exp\\!\\bigl(-H(t)\\bigr).\n$$\n这个恒等式可以从微分方程 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\ln S(t) = -h(t)$ 推导出来，而该微分方程本身是通过将 $h(t)=\\frac{f(t)}{S(t)}$ 与 $f(t)=-\\frac{\\mathrm{d}}{\\mathrm{d}t}S(t)$ 结合（对于连续分布）得到的。\n\n指数模型。假设 $h(t)=\\lambda$ ($t0$ 且 $\\lambda0$) 。那么\n$$\nH(t) \\;=\\; \\int_{0}^{t}\\lambda\\,\\mathrm{d}u \\;=\\; \\lambda t,\n$$\n所以生存函数为\n$$\nS(t) \\;=\\; \\exp(-\\lambda t).\n$$\n根据第1部分，中位数 $t_{0.5}$ 满足\n$$\n\\exp(-\\lambda t_{0.5}) \\;=\\; 0.5.\n$$\n取自然对数并求解 $t_{0.5}$，得到\n$$\n-\\lambda t_{0.5} \\;=\\; \\ln(0.5) \\;=\\; -\\ln(2)\n\\quad\\Longrightarrow\\quad\nt_{0.5}^{\\text{(exp)}} \\;=\\; \\frac{\\ln 2}{\\lambda}.\n$$\n\n韦伯模型。假设 $h(t)=\\frac{k}{\\alpha}\\left(\\frac{t}{\\alpha}\\right)^{k-1}$ ($t0$)，其中形状参数 $k0$ 且尺度参数 $\\alpha0$。那么\n$$\nH(t) \\;=\\; \\int_{0}^{t} \\frac{k}{\\alpha}\\left(\\frac{u}{\\alpha}\\right)^{k-1}\\mathrm{d}u.\n$$\n进行变量替换 $v = \\frac{u}{\\alpha}$，则 $\\mathrm{d}u = \\alpha\\,\\mathrm{d}v$，且当 $u=0$ 时 $v=0$，当 $u=t$ 时 $v=\\frac{t}{\\alpha}$。那么\n$$\nH(t) \\;=\\; \\int_{0}^{t/\\alpha} \\frac{k}{\\alpha} v^{k-1}\\,\\alpha\\,\\mathrm{d}v\n\\;=\\; \\int_{0}^{t/\\alpha} k\\,v^{k-1}\\,\\mathrm{d}v\n\\;=\\; \\left[v^{k}\\right]_{0}^{t/\\alpha}\n\\;=\\; \\left(\\frac{t}{\\alpha}\\right)^{k}.\n$$\n因此生存函数是\n$$\nS(t) \\;=\\; \\exp\\!\\left(-\\left(\\frac{t}{\\alpha}\\right)^{k}\\right).\n$$\n根据第1部分，中位数 $t_{0.5}$ 解方程\n$$\n\\exp\\!\\left(-\\left(\\frac{t_{0.5}}{\\alpha}\\right)^{k}\\right) \\;=\\; 0.5,\n$$\n这意味着\n$$\n\\left(\\frac{t_{0.5}}{\\alpha}\\right)^{k} \\;=\\; \\ln 2\n\\quad\\Longrightarrow\\quad\nt_{0.5}^{\\text{(weib)}} \\;=\\; \\alpha\\,(\\ln 2)^{1/k}.\n$$\n\n综合两个结果，所求的二元中位数行向量是\n$$\n\\left(t_{0.5}^{\\text{(exp)}},\\,t_{0.5}^{\\text{(weib)}}\\right)\n\\;=\\;\n\\left(\\frac{\\ln 2}{\\lambda},\\,\\alpha\\,(\\ln 2)^{1/k}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\ln 2}{\\lambda}  \\alpha(\\ln 2)^{1/k}\\end{pmatrix}}$$", "id": "4977992"}, {"introduction": "在生存分析领域，比例风险（Proportional Hazards, PH）模型和加速失效时间（Accelerated Failure Time, AFT）模型是描述协变量效应的两种主要框架。PH模型假设协变量会使风险函数成比例增加或减少，而AFT模型则假设协变量会“加速”或“减速”事件发生的时间进程。本练习探讨了一个特殊情况：当基线事件分布为指数分布时，这两种看似不同的模型实际上是等价的。通过推导PH模型系数 ($\\beta_{\\text{PH}}$) 和AFT模型系数 ($\\gamma_{\\text{AFT}}$) 之间的精确数学关系，你将更深刻地理解风险比（Hazard Ratio）和时间比（Time Ratio）的内在联系。[@problem_id:4977979]", "problem": "在一项评估首次再住院时间的随机临床试验中，令 $T$ 表示非负生存时间。假设基线事件时间分布为威布尔（Weibull）分布，其形状参数为 $k0$，尺度参数为 $\\lambda0$，因此基线生存函数为 $S_{0}(t)=\\exp\\!\\big(-(\\lambda t)^{k}\\big)$，基线风险率为 $h_{0}(t)=k\\,\\lambda^{k}\\,t^{k-1}$。考虑一个表示是否分配到干预组的单一二元协变量 $x\\in\\{0,1\\}$，并在医学中常用的两种备选框架下对协变量效应进行建模：\n\n- 比例风险 (PH) 模型：$h(t\\mid x)=h_{0}(t)\\,\\exp(\\beta_{\\text{PH}}\\,x)$，其中 $\\beta_{\\text{PH}}$ 为某个回归系数。\n- 加速失效时间 (AFT) 模型：$T(x)=T_{0}\\,\\exp(\\gamma_{\\text{AFT}}\\,x)$，其中 $\\gamma_{\\text{AFT}}$ 为某个回归系数，且 $T_{0}$ 服从基线分布。\n\n从上述定义以及生存函数和风险函数的标准属性出发，推导在指数分布这一特例（$k=1$）下，$\\beta_{\\text{PH}}$ 和 $\\gamma_{\\text{AFT}}$ 之间的代数关系。然后，解释在这种指数分布情况下，$x$ 每增加一个单位所对应的风险比与时间比之间的关系，并选择能同时正确描述系数关系和比率解释的陈述。\n\nA. 在指数基线分布下，回归参数满足 $\\beta_{\\text{PH}}=\\gamma_{\\text{AFT}}$，且风险比等于时间比。\n\nB. 在指数基线分布下，回归参数满足 $\\beta_{\\text{PH}}=-\\gamma_{\\text{AFT}}$，且风险比等于时间比的倒数。\n\nC. 在指数基线分布下，回归参数满足 $\\beta_{\\text{PH}}=-k\\,\\gamma_{\\text{AFT}}$（其中 $k$ 为形状参数），因此风险比等于时间比的 $k$ 次方。\n\nD. 在指数基线分布下，$\\beta_{\\text{PH}}$ 和 $\\gamma_{\\text{AFT}}$ 之间不存在代数联系；风险比和时间比无法相互映射。", "solution": "用户要求我先验证问题陈述，如果有效，则继续进行推导和选项评估来解决问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   **生存时间**：$T$ 是一个非负生存时间。\n-   **基线分布**：威布尔（Weibull）分布。\n-   **参数**：形状参数 $k0$，尺度参数 $\\lambda0$。\n-   **基线生存函数**：$S_{0}(t)=\\exp\\!\\big(-(\\lambda t)^{k}\\big)$。\n-   **基线风险函数**：$h_{0}(t)=k\\,\\lambda^{k}\\,t^{k-1}$。\n-   **协变量**：一个单一的二元协变量 $x\\in\\{0,1\\}$。\n-   **比例风险 (PH) 模型**：$h(t\\mid x)=h_{0}(t)\\,\\exp(\\beta_{\\text{PH}}\\,x)$，其中 $\\beta_{\\text{PH}}$ 为回归系数。\n-   **加速失效时间 (AFT) 模型**：$T(x)=T_{0}\\,\\exp(\\gamma_{\\text{AFT}}\\,x)$，其中 $\\gamma_{\\text{AFT}}$ 为回归系数，且 $T_{0}$ 服从基线分布。\n-   **特定情况**：问题关注指数分布这一特例，对应于 $k=1$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题坚实地建立在生存分析的既定理论之上，这是生物统计学和医学统计学的核心主题。威布尔分布及其生存函数和风险函数的定义、比例风险 (PH) 模型和加速失效时间 (AFT) 模型的定义都是标准且正确的。指数分布是威布尔分布在形状参数 $k=1$ 时的特例，这一点是众所周知的。\n-   **适定性**：问题要求在一组明确定义的假设下进行特定的代数推导。当将不同模型应用于同时满足两种模型假设的分布族（如威布尔分布族）时，探究不同模型参数之间的关系是生存分析中的一个经典且适定的问题。预期参数之间存在唯一的关系。\n-   **客观性**：问题使用精确的数学语言和定义进行陈述，没有主观或含糊的术语。\n\n问题陈述没有明显缺陷。它不违反科学原理，是可形式化的、完整的、在理论背景下是现实的，并且是适定的。\n\n**步骤3：结论与行动**\n\n问题是**有效的**。我将继续推导解决方案。\n\n### 推导与求解\n\n目标是当PH模型和AFT模型都被假定适用于具有指数基线分布的过程时，找出回归系数 $\\beta_{\\text{PH}}$ 和 $\\gamma_{\\text{AFT}}$ 之间的关系。这是可能的，因为指数分布（以及更一般的威布尔分布）是唯一一个同时满足PH和AFT假设的常见参数族。我们可以通过找出每个模型下的生存函数并使它们相等来推导这种关系。\n\n**1. AFT模型的生存函数**\n\nAFT模型由关系式 $T(x) = T_0 \\exp(\\gamma_{\\text{AFT}} x)$ 定义，其中 $T_0$ 服从基线分布，其生存函数为 $S_0(t)$。对于协变量为 $x$ 的受试者，其生存函数记为 $S_{\\text{AFT}}(t \\mid x)$：\n$$S_{\\text{AFT}}(t \\mid x) = P(T(x)  t)$$\n$$S_{\\text{AFT}}(t \\mid x) = P(T_0 \\exp(\\gamma_{\\text{AFT}} x)  t)$$\n$$S_{\\text{AFT}}(t \\mid x) = P(T_0  t \\exp(-\\gamma_{\\text{AFT}} x))$$\n根据定义，$P(T_0  u) = S_0(u)$，其中 $u = t \\exp(-\\gamma_{\\text{AFT}} x)$。因此：\n$$S_{\\text{AFT}}(t \\mid x) = S_0\\left(t \\exp(-\\gamma_{\\text{AFT}} x)\\right)$$\n基线分布为威布尔分布：$S_0(t) = \\exp(-(\\lambda t)^k)$。将此代入 $S_{\\text{AFT}}(t \\mid x)$ 的方程中：\n$$S_{\\text{AFT}}(t \\mid x) = \\exp\\left( -\\left(\\lambda \\left[t \\exp(-\\gamma_{\\text{AFT}} x)\\right]\\right)^k \\right)$$\n$$S_{\\text{AFT}}(t \\mid x) = \\exp\\left( -(\\lambda t)^k \\left[\\exp(-\\gamma_{\\text{AFT}} x)\\right]^k \\right)$$\n$$S_{\\text{AFT}}(t \\mid x) = \\exp\\left( -(\\lambda t)^k \\exp(-k \\gamma_{\\text{AFT}} x) \\right)$$\n\n**2. PH模型的生存函数**\n\nPH模型由风险函数 $h(t \\mid x) = h_0(t) \\exp(\\beta_{\\text{PH}} x)$ 定义。生存函数 $S_{\\text{PH}}(t \\mid x)$ 通过 $S_{\\text{PH}}(t \\mid x) = \\exp(-H(t \\mid x))$ 与累积风险函数 $H(t \\mid x) = \\int_0^t h(u \\mid x) du$ 相关联。\n首先，我们求累积风险函数：\n$$H(t \\mid x) = \\int_0^t h_0(u) \\exp(\\beta_{\\text{PH}} x) du = \\exp(\\beta_{\\text{PH}} x) \\int_0^t h_0(u) du$$\n积分 $\\int_0^t h_0(u) du$ 是基线累积风险函数 $H_0(t)$。我们知道 $S_0(t) = \\exp(-H_0(t))$，所以 $H_0(t) = -\\ln(S_0(t))$。\n给定 $S_0(t) = \\exp(-(\\lambda t)^k)$，基线累积风险函数为 $H_0(t) = - \\ln(\\exp(-(\\lambda t)^k)) = (\\lambda t)^k$。\n将此代回 $H(t \\mid x)$ 的表达式中：\n$$H(t \\mid x) = (\\lambda t)^k \\exp(\\beta_{\\text{PH}} x)$$\n因此，PH模型的生存函数是：\n$$S_{\\text{PH}}(t \\mid x) = \\exp(-H(t \\mid x)) = \\exp\\left( -(\\lambda t)^k \\exp(\\beta_{\\text{PH}} x) \\right)$$\n\n**3. 令模型相等并推导系数关系**\n\n要使两个模型对于同一基础过程等价，它们的生存函数必须对所有 $t  0$ 和任何 $x$ 都相同：\n$$S_{\\text{AFT}}(t \\mid x) = S_{\\text{PH}}(t \\mid x)$$\n$$\\exp\\left( -(\\lambda t)^k \\exp(-k \\gamma_{\\text{AFT}} x) \\right) = \\exp\\left( -(\\lambda t)^k \\exp(\\beta_{\\text{PH}} x) \\right)$$\n为使此等式成立，指数函数的参数必须相等：\n$$-(\\lambda t)^k \\exp(-k \\gamma_{\\text{AFT}} x) = -(\\lambda t)^k \\exp(\\beta_{\\text{PH}} x)$$\n两边同除以非零项 $-(\\lambda t)^k$ 得到：\n$$\\exp(-k \\gamma_{\\text{AFT}} x) = \\exp(\\beta_{\\text{PH}} x)$$\n两边取自然对数：\n$$-k \\gamma_{\\text{AFT}} x = \\beta_{\\text{PH}} x$$\n为使此式对任何 $x$（特别是 $x=1$）都成立，我们必须有：\n$$\\beta_{\\text{PH}} = -k \\gamma_{\\text{AFT}}$$\n这是威布尔分布的一般关系。\n\n问题要求的是**指数分布特例**下的结果，即形状参数 $k=1$。将 $k=1$ 代入一般关系式中：\n$$\\beta_{\\text{PH}} = -1 \\cdot \\gamma_{\\text{AFT}} \\implies \\beta_{\\text{PH}} = -\\gamma_{\\text{AFT}}$$\n\n**4. 关联风险比和时间比**\n\n-   **风险比 (HR)**：HR源自PH模型。它是 $x$ 变化一个单位（从 $x=0$ 到 $x=1$）的风险率之比：\n    $$HR = \\frac{h(t \\mid x=1)}{h(t \\mid x=0)} = \\frac{h_0(t)\\,\\exp(\\beta_{\\text{PH}} \\cdot 1)}{h_0(t)\\,\\exp(\\beta_{\\text{PH}} \\cdot 0)} = \\exp(\\beta_{\\text{PH}})$$\n-   **时间比 (TR)**：TR（或加速因子）源自AFT模型。它是 $x$ 变化一个单位所对应的预期（或任何分位数）生存时间之比。如果 $t_p(x)$ 是协变量值为 $x$ 时的第 $p$ 百分位数，我们有 $t_p(x) = t_{p,0} \\exp(\\gamma_{\\text{AFT}}x)$，其中 $t_{p,0}$ 是基线百分位数。\n    $$TR = \\frac{t_p(1)}{t_p(0)} = \\frac{t_{p,0}\\,\\exp(\\gamma_{\\text{AFT}} \\cdot 1)}{t_{p,0}\\,\\exp(\\gamma_{\\text{AFT}} \\cdot 0)} = \\exp(\\gamma_{\\text{AFT}})$$\n-   **关系**：现在我们使用指数分布情况下的系数关系 $\\beta_{\\text{PH}} = -\\gamma_{\\text{AFT}}$ 来关联HR和TR。\n    $$HR = \\exp(\\beta_{\\text{PH}}) = \\exp(-\\gamma_{\\text{AFT}})$$\n    由于 $TR = \\exp(\\gamma_{\\text{AFT}})$，我们可以写出：\n    $$HR = \\frac{1}{\\exp(\\gamma_{\\text{AFT}})} = \\frac{1}{TR}$$\n    因此，在指数分布情况下，风险比是时间比的倒数。\n\n### 选项评估\n\n-   **A. 在指数基线分布下，回归参数满足 $\\beta_{\\text{PH}}=\\gamma_{\\text{AFT}}$，且风险比等于时间比。**\n    推导出的系数关系是 $\\beta_{\\text{PH}}=-\\gamma_{\\text{AFT}}$，而不是 $\\beta_{\\text{PH}}=\\gamma_{\\text{AFT}}$。推导出的比率关系是 $HR = 1/TR$，而不是 $HR=TR$。此陈述**不正确**。\n\n-   **B. 在指数基线分布下，回归参数满足 $\\beta_{\\text{PH}}=-\\gamma_{\\text{AFT}}$，且风险比等于时间比的倒数。**\n    系数关系 $\\beta_{\\text{PH}}=-\\gamma_{\\text{AFT}}$ 对于指数分布情况 ($k=1$) 是正确的。风险比 ($HR$) 等于时间比的倒数 ($1/TR$) 的解释也是正确的，如 $HR = \\exp(\\beta_{\\text{PH}}) = \\exp(-\\gamma_{\\text{AFT}}) = 1/\\exp(\\gamma_{\\text{AFT}}) = 1/TR$ 所示。此陈述**正确**。\n\n-   **C. 在指数基线分布下，回归参数满足 $\\beta_{\\text{PH}}=-k\\,\\gamma_{\\text{AFT}}$（其中 $k$ 为形状参数），因此风险比等于时间比的 $k$ 次方。**\n    威布尔分布的一般公式 $\\beta_{\\text{PH}}=-k\\,\\gamma_{\\text{AFT}}$ 是正确的。然而，对比率的解释是错误的。风险比是 $HR = \\exp(\\beta_{\\text{PH}}) = \\exp(-k\\gamma_{\\text{AFT}}) = (\\exp(\\gamma_{\\text{AFT}}))^{-k} = (TR)^{-k} = 1/(TR)^k$。该选项声称 $HR = (TR)^k$，这是不正确的。此陈述**不正确**。\n\n-   **D. 在指数基线分布下，$\\beta_{\\text{PH}}$ 和 $\\gamma_{\\text{AFT}}$ 之间不存在代数联系；风险比和时间比无法相互映射。**\n    这是错误的。我们已经推导出了一个精确的代数联系 $\\beta_{\\text{PH}}=-\\gamma_{\\text{AFT}}$，这导致了映射关系 $HR=1/TR$。此陈述**不正确**。", "answer": "$$\\boxed{B}$$", "id": "4977979"}]}