{"hands_on_practices": [{"introduction": "在基因组学等高通量研究中，研究人员通常会得到一个长长的 p 值列表。将这些原始 p 值转化为经过校正的“q 值”是一项核心任务。本练习将指导你手动计算 q 值，并理解其与 Benjamini-Hochberg (BH) 程序的内在联系，这是解读多重检验结果的一项基本技能。[@problem_id:4930965]", "problem": "一位生物统计学家在一项队列研究中分析了基因关联性，并获得了一组包含 $m=15$ 个独立假设检验的检验族，其排序后的p值 $p_{(1)} \\leq p_{(2)} \\leq \\dots \\leq p_{(15)}$ 如下所示：\n$$\np_{(1)}=0.0008,\\quad p_{(2)}=0.003,\\quad p_{(3)}=0.0065,\\quad p_{(4)}=0.012,\\quad p_{(5)}=0.018,\n$$\n$$\np_{(6)}=0.021,\\quad p_{(7)}=0.044,\\quad p_{(8)}=0.051,\\quad p_{(9)}=0.062,\\quad p_{(10)}=0.078,\n$$\n$$\np_{(11)}=0.13,\\quad p_{(12)}=0.21,\\quad p_{(13)}=0.27,\\quad p_{(14)}=0.38,\\quad p_{(15)}=0.49.\n$$\n从一个检验的q值的核心定义出发，即在一个检验根据Benjamini–Hochberg程序（BH程序）被纳入拒绝集时的最小错误发现率（FDR）水平，计算与这些排序后的p值相关联的q值向量。然后，使用计算出的q值，在目标q值水平 $q^{\\star}=0.09$ 下选择发现（即被拒绝的假设），并从基本原理出发，解释为什么这种选择等同于在水平 $q^{\\star}$ 下应用一次BH程序。\n\n作为最终答案，报告在水平 $q^{\\star}=0.09$ 下的总发现数。无需四舍五入，最终答案必须是单个实数值。", "solution": "该问题已经过验证，被认为是有效的，因为它科学地基于已确立的多重比较校正的生物统计学理论，是适定的（提供了所有必要数据），并且以客观、正式的语言陈述。\n\n该问题要求为一组给定的p值计算q值，并在指定的错误发现率（FDR）水平上确定显著发现的数量。它还要求解释使用预先计算的q值与直接应用Benjamini-Hochberg（BH）程序之间的等价性。\n\n设 $m$ 是独立假设检验的总数。给定 $m=15$。\n设这些检验排序后的p值为 $p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。给定的值为：\n$p_{(1)}=0.0008$, $p_{(2)}=0.003$, $p_{(3)}=0.0065$, $p_{(4)}=0.012$, $p_{(5)}=0.018$, $p_{(6)}=0.021$, $p_{(7)}=0.044$, $p_{(8)}=0.051$, $p_{(9)}=0.062$, $p_{(10)}=0.078$, $p_{(11)}=0.13$, $p_{(12)}=0.21$, $p_{(13)}=0.27$, $p_{(14)}=0.38$, $p_{(15)}=0.49$。\n\n将FDR控制在水平 $\\alpha$ 的BH程序如下：找到满足 $p_{(k)} \\le \\frac{k}{m}\\alpha$ 的最大整数 $k \\in \\{1, \\dots, m\\}$。如果存在这样的 $k$，则拒绝与 $p_{(1)}, p_{(2)}, \\dots, p_{(k)}$ 对应的原假设。\n\n问题将一个检验的q值定义为该检验被宣布为显著时的最小FDR水平。对于第 $i$ 个排序的检验，其q值（记为 $q_{(i)}$）是使得该检验被拒绝的最小 $\\alpha$。根据BH程序，如果存在某个索引 $j \\ge i$ 使得 $p_{(j)} \\le \\frac{j}{m}\\alpha$，则与 $p_{(i)}$ 对应的检验被拒绝。这等价于 $\\alpha \\ge \\frac{m \\cdot p_{(j)}}{j}$。为了找到允许拒绝第 $i$ 个检验的最小 $\\alpha$，我们必须在所有包含第 $i$ 个检验的可能拒绝集中找到这些阈值的最小值。这引出了BH校正p值的定义，在此背景下即为q值：\n$$q_{(i)} = \\min_{j=i, \\dots, m} \\left( \\frac{m \\cdot p_{(j)}}{j} \\right)$$\n这个定义确保了最终的q值是单调非递减的，即 $q_{(1)} \\le q_{(2)} \\le \\dots \\le q_{(m)}$。\n\n首先，我们计算中间值 $v_i = \\frac{m \\cdot p_{(i)}}{i}$，其中 $i=1, \\dots, 15$。\n$v_1 = \\frac{15}{1}(0.0008) = 0.012$\n$v_2 = \\frac{15}{2}(0.003) = 0.0225$\n$v_3 = \\frac{15}{3}(0.0065) = 0.0325$\n$v_4 = \\frac{15}{4}(0.012) = 0.045$\n$v_5 = \\frac{15}{5}(0.018) = 0.054$\n$v_6 = \\frac{15}{6}(0.021) = 0.0525$\n$v_7 = \\frac{15}{7}(0.044) = \\frac{0.66}{7} \\approx 0.094286$\n$v_8 = \\frac{15}{8}(0.051) = 0.095625$\n$v_9 = \\frac{15}{9}(0.062) = \\frac{0.93}{9} \\approx 0.103333$\n$v_{10} = \\frac{15}{10}(0.078) = 0.117$\n$v_{11} = \\frac{15}{11}(0.13) = \\frac{1.95}{11} \\approx 0.177273$\n$v_{12} = \\frac{15}{12}(0.21) = 0.2625$\n$v_{13} = \\frac{15}{13}(0.27) = \\frac{4.05}{13} \\approx 0.311538$\n$v_{14} = \\frac{15}{14}(0.38) = \\frac{5.7}{14} \\approx 0.407143$\n$v_{15} = \\frac{15}{15}(0.49) = 0.49$\n\n接下来，我们通过从右到左（从 $i=m$ 到 $1$）取累积最小值来计算q值：$q_{(i)} = \\min(v_i, q_{(i+1)})$，其中 $q_{(m)} = v_m$。\n$q_{(15)} = v_{15} = 0.49$\n$q_{(14)} = \\min(v_{14}, q_{(15)}) = \\min(0.4071..., 0.49) = 0.4071... = \\frac{57}{140}$\n$q_{(13)} = \\min(v_{13}, q_{(14)}) = \\min(0.3115..., 0.4071...) = 0.3115... = \\frac{81}{260}$\n$q_{(12)} = \\min(v_{12}, q_{(13)}) = \\min(0.2625, 0.3115...) = 0.2625$\n$q_{(11)} = \\min(v_{11}, q_{(12)}) = \\min(0.1772..., 0.2625) = 0.1772... = \\frac{39}{220}$\n$q_{(10)} = \\min(v_{10}, q_{(11)}) = \\min(0.117, 0.1772...) = 0.117$\n$q_{(9)} = \\min(v_9, q_{(10)}) = \\min(0.1033..., 0.117) = 0.1033... = \\frac{31}{300}$\n$q_{(8)} = \\min(v_8, q_{(9)}) = \\min(0.095625, 0.1033...) = 0.095625$\n$q_{(7)} = \\min(v_7, q_{(8)}) = \\min(0.0942..., 0.095625) = 0.0942... = \\frac{33}{350}$\n$q_{(6)} = \\min(v_6, q_{(7)}) = \\min(0.0525, 0.0942...) = 0.0525$\n$q_{(5)} = \\min(v_5, q_{(6)}) = \\min(0.054, 0.0525) = 0.0525$\n$q_{(4)} = \\min(v_4, q_{(5)}) = \\min(0.045, 0.0525) = 0.045$\n$q_{(3)} = \\min(v_3, q_{(4)}) = \\min(0.0325, 0.045) = 0.0325$\n$q_{(2)} = \\min(v_2, q_{(3)}) = \\min(0.0225, 0.0325) = 0.0225$\n$q_{(1)} = \\min(v_1, q_{(2)}) = \\min(0.012, 0.0225) = 0.012$\n\n最终的q值向量为：\n$q_{(1)}=0.012$, $q_{(2)}=0.0225$, $q_{(3)}=0.0325$, $q_{(4)}=0.045$, $q_{(5)}=0.0525$, $q_{(6)}=0.0525$, $q_{(7)} \\approx 0.0943$, $q_{(8)}=0.095625$, $q_{(9)} \\approx 0.1033$, $q_{(10)}=0.117$, $q_{(11)} \\approx 0.1773$, $q_{(12)}=0.2625$, $q_{(13)} \\approx 0.3115$, $q_{(14)} \\approx 0.4071$, $q_{(15)}=0.49$。\n\n为了在目标水平 $q^{\\star}=0.09$ 下选择发现，我们拒绝所有满足 $q_{(i)} \\le q^{\\star}$ 的假设。\n$q_{(1)} = 0.012 \\le 0.09$ (拒绝)\n$q_{(2)} = 0.0225 \\le 0.09$ (拒绝)\n$q_{(3)} = 0.0325 \\le 0.09$ (拒绝)\n$q_{(4)} = 0.045 \\le 0.09$ (拒绝)\n$q_{(5)} = 0.0525 \\le 0.09$ (拒绝)\n$q_{(6)} = 0.0525 \\le 0.09$ (拒绝)\n$q_{(7)} = \\frac{33}{350} \\approx 0.0943 > 0.09$ (不拒绝)\n由于q值是单调非递减的，所有从 $i=7$ 到 $i=15$ 的后续检验也不会被拒绝。发现的总数为 $6$。\n\n接下来，我们解释为什么这等同于在水平 $\\alpha = q^{\\star}=0.09$ 下应用BH程序。\n直接应用BH程序，我们寻找满足 $p_{(k)} \\le \\frac{k}{m}q^{\\star} = \\frac{k}{15}(0.09) = 0.006k$ 的最大 $k$。\n对于 $k=1: p_{(1)}=0.0008 \\le 0.006(1)=0.006$ (成立)\n对于 $k=2: p_{(2)}=0.003 \\le 0.006(2)=0.012$ (成立)\n对于 $k=3: p_{(3)}=0.0065 \\le 0.006(3)=0.018$ (成立)\n对于 $k=4: p_{(4)}=0.012 \\le 0.006(4)=0.024$ (成立)\n对于 $k=5: p_{(5)}=0.018 \\le 0.006(5)=0.030$ (成立)\n对于 $k=6: p_{(6)}=0.021 \\le 0.006(6)=0.036$ (成立)\n对于 $k=7: p_{(7)}=0.044 > 0.006(7)=0.042$ (不成立)\n满足条件的最大 $k$ 是 $k=6$。BH程序拒绝前 $6$ 个假设，这与使用q值方法得到的结果一致。\n\n这种等价性的正式解释如下。\n设 $q^{\\star}$ 为期望的FDR水平。\n方法1（q值规则）：拒绝所有满足 $q_{(i)} \\le q^{\\star}$ 的假设 $H_{(i)}$。设 $k_q = \\max\\{i: q_{(i)} \\le q^{\\star}\\}$。由于 $q_{(i)}$ 是非递减的，拒绝集为 $\\{H_{(1)}, \\dots, H_{(k_q)}\\}$。\n方法2（BH程序）：找到 $k_{BH} = \\max\\{i: p_{(i)} \\le \\frac{i}{m}q^{\\star}\\}$。拒绝集为 $\\{H_{(1)}, \\dots, H_{(k_{BH})}\\}$。\n我们必须证明 $k_q = k_{BH}$。\n\n首先，我们证明 $q_{(k_{BH})} \\le q^{\\star}$。根据 $k_{BH}$ 的定义，我们有 $p_{(k_{BH})} \\le \\frac{k_{BH}}{m}q^{\\star}$，这意味着 $\\frac{m \\cdot p_{(k_{BH})}}{k_{BH}} \\le q^{\\star}$。\nq值为 $q_{(k_{BH})} = \\min_{j=k_{BH}, \\dots, m} \\left(\\frac{m \\cdot p_{(j)}}{j}\\right)$。\n由于最小化运算中的一项（$j=k_{BH}$ 的那一项）小于或等于 $q^{\\star}$，因此最小值本身也必须小于或等于 $q^{\\star}$。因此，$q_{(k_{BH})} \\le q^{\\star}$。\n根据q值规则，假设 $H_{(k_{BH})}$ 被拒绝。由于q值是非递减的，所有对于 $i \\le k_{BH}$ 的 $H_{(i)}$ 也被拒绝。这表明 $k_q \\ge k_{BH}$。\n\n接下来，我们考察 $q_{(k_{BH}+1)}$。根据 $k_{BH}$ 作为最大索引的定义，对于任何 $j > k_{BH}$，我们必须有 $p_{(j)} > \\frac{j}{m}q^{\\star}$，这等价于 $\\frac{m \\cdot p_{(j)}}{j} > q^{\\star}$。\nq值为 $q_{(k_{BH}+1)} = \\min_{j=k_{BH}+1, \\dots, m} \\left(\\frac{m \\cdot p_{(j)}}{j}\\right)$。\n由于这个最小化运算中的每一项都严格大于 $q^{\\star}$，因此最小值本身也必须严格大于 $q^{\\star}$。所以，$q_{(k_{BH}+1)} > q^{\\star}$。\n根据q值规则，假设 $H_{(k_{BH}+1)}$ 不被拒绝。这意味着被拒绝假设的最大索引是 $k_{BH}$，因此 $k_q \\le k_{BH}$。\n\n结合 $k_q \\ge k_{BH}$ 和 $k_q \\le k_{BH}$，我们得出结论 $k_q = k_{BH}$。因此，这两个程序是等价的。发现的数量为 $6$。", "answer": "$$\\boxed{6}$$", "id": "4930965"}, {"introduction": "标准的 Benjamini-Hochberg (BH) 程序的有效性依赖于对检验之间独立性或正相关的假设。当检验之间可能存在任意依赖关系时，我们需要更稳健的方法。本练习将介绍更为保守的 Benjamini-Yekutieli (BY) 程序，并要求你量化两种方法在发现数量上的差异，从而突显在统计分析中审视基本假设的重要性。[@problem_id:4930944]", "problem": "一位生物统计学家正在分析一项RNA测序实验中 $m = 12$ 个基因的差异表达。对每个基因进行无差异表达的假设检验，得到以下未排序的 $p$ 值：\n$$\n0.02,\\ 0.12,\\ 0.006,\\ 0.0008,\\ 0.08,\\ 0.2,\\ 0.04,\\ 0.025,\\ 0.012,\\ 0.002,\\ 0.06,\\ 0.0045.\n$$\n假设这些检验可能存在任意依赖关系。该生物统计学家希望在 $q = 0.05$ 的水平上控制假发现率（False Discovery Rate, FDR），并考虑了两种标准的上探程序（step-up procedure）：Benjamini–Hochberg (BH) 程序和 Benjamini–Yekutieli (BY) 程序。从FDR是所有发现中假发现的期望比例这一核心定义出发，并使用对 $p$ 值进行排序并将其与递增的临界值进行比较的标准上探框架，确定以下内容：\n\n1. 对于Benjamini–Yekutieli程序，计算拒绝阈值（即，确定对应排序的 $p$ 值被宣布为显著的最大秩 $k$，并报告该秩下相关的BY临界值）。\n\n2. 对于Benjamini–Hochberg程序，计算拒绝的数量。\n\n3. 将BY相对于BH的相对保守性量化为BY程序下拒绝数与BH程序下拒绝数的比率。\n\n将最终的相对保守性度量表示为四舍五入到四位有效数字的小数。不允许使用百分号。", "solution": "在尝试任何解答之前，所提出的问题都经过了严格的验证过程。\n\n### 步骤1：提取已知条件\n问题陈述中明确给出的数据和条件是：\n- 假设检验的总数（基因数）：$m = 12$。\n- 未排序的 $p$ 值：$\\{0.02, 0.12, 0.006, 0.0008, 0.08, 0.2, 0.04, 0.025, 0.012, 0.002, 0.06, 0.0045\\}$。\n- 期望的假发现率（FDR）控制水平：$q = 0.05$。\n- 检验的假设依赖结构：任意依赖。\n- 使用的程序：Benjamini-Hochberg (BH) 和 Benjamini-Yekutieli (BY)。\n- 任务1：对于BY程序，找到拒绝阈值，具体为显著检验的最大秩 $k$ 和相应的临界值。\n- 任务2：对于BH程序，找到拒绝的数量。\n- 任务3：计算BY程序下的拒绝数与BH程序下的拒绝数的比率，四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在多重假设检验的既定统计理论中有坚实的基础。假发现率、Benjamini-Hochberg程序和Benjamini-Yekutieli程序是现代生物统计学中的基石概念，特别是在分析如RNA测序等高通量数据时。BH（用于独立性/正相关性）和BY（用于任意依赖性）之间的区别是一个关键且标准的话题。该问题是这些原理的直接应用。\n- **问题的适定性**：问题陈述清晰，为唯一解提供了所有必要信息。$p$ 值集合、检验总数 $m$ 和期望的FDR水平 $q$ 都已指定。这三个任务是基于所提供数据和标准算法的明确计算练习。\n- **客观性**：问题以客观、定量的语言构建。它引用标准的统计程序，没有主观解释。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的，内容是自洽的，并且是适定的。没有矛盾、歧义或事实错误。因此，该问题是**有效的**，并将提供解答。\n\n解答需要应用两种标准的上探程序来控制假发现率。两种程序都首先将 $m$ 个p值从小到大排序，记为 $p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。\n\n首先，我们对给定的 $p$ 值进行排序：\n$p_{(1)} = 0.0008$\n$p_{(2)} = 0.002$\n$p_{(3)} = 0.0045$\n$p_{(4)} = 0.006$\n$p_{(5)} = 0.012$\n$p_{(6)} = 0.02$\n$p_{(7)} = 0.025$\n$p_{(8)} = 0.04$\n$p_{(9)} = 0.06$\n$p_{(10)} = 0.08$\n$p_{(11)} = 0.12$\n$p_{(12)} = 0.2$\n\n检验总数为 $m=12$，期望的FDR水平为 $q=0.05$。\n\n**任务1：Benjamini–Yekutieli (BY) 程序**\n\nBY程序旨在控制任何依赖形式下的FDR。它通过引入一个校正因子 $c(m)$（即第 $m$ 个调和数）来修正BH程序。该程序是找到从1到 $m$ 的最大整数 $k$，使得：\n$$\np_{(k)} \\le \\frac{k}{m \\cdot c(m)}q\n$$\n对于 $m=12$，校正因子 $c(12)$ 是第12个调和数，$H_{12}$：\n$$\nc(12) = \\sum_{i=1}^{12} \\frac{1}{i} = 1 + \\frac{1}{2} + \\frac{1}{3} + \\dots + \\frac{1}{12} = \\frac{86021}{27720} \\approx 3.10321\n$$\n第 $i$ 个排序的 $p$ 值的临界值为 $\\alpha_{BY,(i)} = \\frac{i}{12 \\cdot c(12)} (0.05)$。我们寻找最大的 $k$ 使得 $p_{(k)} \\le \\alpha_{BY,(k)}$。\n\n让我们将每个 $p_{(i)}$ 与其对应的临界值 $\\alpha_{BY,(i)}$ 进行比较：\n- 对于 $i=1$：$p_{(1)} = 0.0008$。临界值为 $\\alpha_{BY,(1)} = \\frac{1}{12 \\cdot c(12)}(0.05) \\approx \\frac{0.05}{37.2385} \\approx 0.00134$。由于 $0.0008 \\le 0.00134$，条件成立。\n- 对于 $i=2$：$p_{(2)} = 0.002$。临界值为 $\\alpha_{BY,(2)} = \\frac{2}{12 \\cdot c(12)}(0.05) \\approx 2 \\cdot 0.00134 = 0.00268$。由于 $0.002 \\le 0.00268$，条件成立。\n- 对于 $i=3$：$p_{(3)} = 0.0045$。临界值为 $\\alpha_{BY,(3)} = \\frac{3}{12 \\cdot c(12)}(0.05) \\approx 3 \\cdot 0.00134 = 0.00402$。由于 $0.0045 > 0.00402$，条件不成立。\n\n使得条件 $p_{(k)} \\le \\alpha_{BY,(k)}$ 成立的最大秩是 $k_{BY} = 2$。根据上探程序，秩为 $i=1, \\dots, k_{BY}$ 的假设被拒绝。因此，有2个假设被拒绝。根据要求，拒绝阈值是这个最大秩 $k_{BY}=2$ 处的临界值：\n$$\n\\alpha_{BY,(2)} = \\frac{2 \\cdot q}{m \\cdot c(m)} = \\frac{2 \\cdot (0.05)}{12 \\cdot \\frac{86021}{27720}} = \\frac{0.1 \\cdot 27720}{12 \\cdot 86021} = \\frac{2772}{1032252} \\approx 0.0026854\n$$\n在BY程序下，拒绝的数量为 $N_{BY} = 2$。\n\n**任务2：Benjamini–Hochberg (BH) 程序**\n\nBH程序在独立性或正回归依赖性下控制FDR，它不使用 $c(m)$ 校正因子。该程序是找到从1到 $m$ 的最大整数 $k$，使得：\n$$\np_{(k)} \\le \\frac{k}{m}q\n$$\n第 $i$ 个排序的 $p$ 值的临界值为 $\\alpha_{BH,(i)} = \\frac{i}{12}(0.05)$。我们寻找最大的 $k$ 使得 $p_{(k)} \\le \\alpha_{BH,(k)}$。\n\n让我们将每个 $p_{(i)}$ 与其对应的临界值 $\\alpha_{BH,(i)}$ 进行比较：\n- 对于 $i=1$：$p_{(1)} = 0.0008 \\le \\frac{1}{12}(0.05) \\approx 0.00417$。条件成立。\n- 对于 $i=2$：$p_{(2)} = 0.002 \\le \\frac{2}{12}(0.05) \\approx 0.00833$。条件成立。\n- 对于 $i=3$：$p_{(3)} = 0.0045 \\le \\frac{3}{12}(0.05) = 0.0125$。条件成立。\n- 对于 $i=4$：$p_{(4)} = 0.006 \\le \\frac{4}{12}(0.05) \\approx 0.01667$。条件成立。\n- 对于 $i=5$：$p_{(5)} = 0.012 \\le \\frac{5}{12}(0.05) \\approx 0.02083$。条件成立。\n- 对于 $i=6$：$p_{(6)} = 0.02 \\le \\frac{6}{12}(0.05) = 0.025$。条件成立。\n- 对于 $i=7$：$p_{(7)} = 0.025 \\le \\frac{7}{12}(0.05) \\approx 0.02917$。条件成立。\n- 对于 $i=8$：$p_{(8)} = 0.04 > \\frac{8}{12}(0.05) \\approx 0.03333$。条件不成立。\n\n使得条件成立的最大秩是 $k_{BH} = 7$。根据BH程序，所有对于 $i=1, \\dots, k_{BH}$ 的原假设 $H_{(i)}$ 都被拒绝。\n在BH程序下，拒绝的数量为 $N_{BH} = 7$。\n\n**任务3：相对保守性**\n\n相对保守性通过BY程序下的拒绝数与BH程序下的拒绝数的比率来量化。\n$$\n\\text{比率} = \\frac{N_{BY}}{N_{BH}} = \\frac{2}{7}\n$$\n将此分数转换为小数约为 $0.28571428...$。根据问题陈述要求，四舍五入到四位有效数字，我们得到 $0.2857$。该比率小于1，证实了BY程序预期的更高保守性，由于其对任意依赖性有更严格的控制，因此拒绝了更少的假设。", "answer": "$$\n\\boxed{0.2857}\n$$", "id": "4930944"}, {"introduction": "在应用任何正式的统计程序之前，通过可视化来“诊断”数据是一种非常有效的实践。本练习探讨了如何利用 p 值直方图等简单图形来洞察数据结构。通过理解这些图形，我们可以估计真实零假设的比例（$\\pi_0$）并评估信号的强度，从而为 BH 分析的结果建立合理的预期。[@problem_id:4930961]", "problem": "一位生物统计学家计划在一项涉及 $m$ 个假设检验的大规模基因表达研究中，应用 Benjamini-Hochberg (BH) 程序来控制假发现率 (FDR) 在水平 $q$。在确定一个具体的 $q$ 值之前，她希望使用一些可以从基本原理上解释的图表来诊断信号的证据以及真原假设的比例 $\\pi_{0}$。\n\n她考虑了两种诊断方法：\n- 在 $[0,1]$ 区间上的 $p$ 值直方图，用于评估其与“来自真原假设的 $p$ 值是独立的且在 $[0,1]$ 上均匀分布”这一零假设预期的偏差。\n- 一张 BH 折线图，该图绘制了排序后的 $p$ 值 $p_{(1)} \\le \\cdots \\le p_{(m)}$ 相对于其秩次比例 $i/m$ 的关系，并叠加了一条标记了水平 $q$ 的 BH 决策边界的参考线。位于参考线下方的点是 BH 程序下可能被拒绝的假设。\n\n从基本原理出发，我们知道在真原假设和有效的 $p$ 值下，对于任何 $t \\in [0,1]$，分布满足 $\\Pr(p \\le t) = t$，因此 $p$ 值在 $[0,1]$ 上是均匀分布的。当存在备择假设时，边际 $p$ 值直方图是来自真原假设的均匀分布部分和来自非原假设的随机更小的部分的混合，这通常会导致在 $0$ 附近出现过量的小 $p$ 值。BH 程序是一种递增方法，它将排序后的 $p$ 值与一个由 $q$ 和 $m$ 决定的、依赖于秩次的边界进行比较；在独立性或某些正相关结构下，它能将 FDR 控制在 $q$ 或以下。\n\n下列哪个陈述正确描述了如何使用这些诊断方法来评估 $\\pi_{0}$ 和信号的存在，以及与均匀性的偏差如何为 BH 程序的发现提供信息？\n\nA. 在没有信号（$\\pi_{0} = 1$）、$p$ 值独立且有效的情况下，$p$ 值直方图在 $[0,1]$ 上应近似平坦，并且在 BH 折线图上，对于任何 $q \\in (0,1)$，预计很少或没有点会落在 BH 参考线以下，这意味着很少或没有拒绝。\n\nB. $p$ 值直方图的强烈左偏（在 $0$ 附近有明显的过量，而在中等到大的 $p$ 值区域计数近似均匀）与 $\\pi_{0}  1$ 的情况一致，并且通常预示着 BH 折线图将在早期就出现点落在 BH 参考线下方的情况，即使在适度的 $q$ 值下也能产生许多发现。\n\nC. 仅仅在 $1$ 附近缺少 $p$ 值并不足以证明存在许多真备择假设，也不能保证 BH 程序在任何 $q \\in (0,1)$ 下至少会做出 $\\lfloor m q \\rfloor$ 次拒绝。\n\nD. 如果 $p$ 值直方图呈双峰分布，峰值在 $0$ 和 $0.5$ 附近，这必然意味着检验之间存在依赖性，从而使 BH 的 FDR 控制失效，因此 BH 折线图不具信息量。\n\nE. 当 $\\pi_{0}  1$ 但来自非原假设的 $p$ 值仅提供微弱信息时（例如，它们聚集在 $0.2$ 到 $0.4$ 附近而不是接近 $0$），BH 程序在较小的 $q$ 值下可能仍然只会产生很少的拒绝，并且 BH 折线图通常会显示 $p_{(i)}$ 保持在 BH 参考线之上，可能只有最小的几个秩次除外。", "solution": "我们从生物统计学中多重检验的核心定义和经过充分检验的事实开始。\n\n在真原假设下且 $p$ 值有效时，均匀性成立：对于 $t \\in [0,1]$，$\\Pr(p \\le t) = t$，这意味着在大样本中直方图在 $[0,1]$ 区间上是平坦的。在一个包含比例为 $\\pi_{0}$ 的真原假设和 $(1 - \\pi_{0})$ 的备择假设的混合体中，边际 $p$ 值分布可以示意性地写为 $f(p) = \\pi_{0} \\cdot 1_{[0,1]}(p) + (1 - \\pi_{0}) \\cdot g(p)$，其中当检验具有统计功效时，$g(p)$ 在随机意义上小于均匀分布。当存在信号时，这通常会在 $0$ 附近产生过量的小 $p$ 值，而如果存在大量原假设，右尾可能保持接近均匀分布。\n\n用于控制假发现率 (FDR) 的 Benjamini-Hochberg (BH) 程序对 $p$ 值进行排序，并找到使得 $p_{(k)}$ 不大于一个依赖于秩次的边界的最大索引 $k$；它拒绝秩次 $i \\le k$ 的假设。在独立性或某些正相关性（如对子集的正回归依赖性）下，BH 程序将 FDR 控制在水平 $q$ 或以下。诊断性的 BH 折线图将排序后的 $p$ 值 $p_{(i)}$ 叠加在 $i/m$ 和水平 $q$ 的参考边界上；早期位于参考边界下方的点表示潜在的拒绝。\n\n一个有用的启发式方法将纯原假设下的有序 $p$ 值与均匀分布的顺序统计量联系起来：当所有 $m$ 个假设都为真原假设时，$E[p_{(i)}] \\approx i/(m+1)$。将这些与 $q \\in (0,1)$ 的 BH 边界进行比较表明，在没有信号的情况下，交叉很少发生；因此，预期的拒绝数量接近 $0$。\n\n现在我们分析每个选项：\n\nA. 在 $\\pi_{0} = 1$ 和独立性条件下，$p$ 值直方图应在 $[0,1]$ 上近似平坦，反映均匀性。对于 BH 折线图，考虑均匀分布的顺序统计量：$E[p_{(i)}] \\approx i/(m+1)$。对于 $q \\in (0,1)$，BH 参考边界与秩次比例 $i/m$ 成比例；要出现系统性的交叉，有序 $p$ 值需要系统性地小于此边界。在纯原假设的均匀性下，典型值 $p_{(i)}$ 大约在 $i/(m+1)$ 附近，不会小于一个与 $i/m$ 成比例的边界，除非 $q$ 非常大（接近 $1$）。因此，在没有信号且 $q  1$ 的情况下，通常很少或没有点会落在 BH 参考线以下，BH 程序做出很少或没有拒绝。结论：正确。\n\nB. $p$ 值直方图的强烈左偏——在 $0$ 附近有超额质量——是 $(1 - \\pi_{0})  0$（具有统计功效的非原假设）的典型证据，因为非原假设的 $p$ 值在随机意义上小于均匀分布。在 BH 折线图上，最小秩次中的许多小 $p_{(i)}$ 会将经验曲线向下拉，增加了早期有序 $p$ 值落到 BH 参考边界下方的机会。这即使在适度的 $q$ 值（例如 $q$ 接近 $0.05$ 或 $0.10$）下也能产生更多的发现。结论：正确。\n\nC. 仅仅在 $1$ 附近存在缺失并不足以证明存在许多真备择假设；这种情况可能由保守的 $p$ 值、离散的检验统计量、四舍五入或其他伪影引起，并且它不一定意味着有小 $p$ 值集中在 $0$ 附近。此外，BH 程序不保证至少有 $\\lfloor m q \\rfloor$ 次拒绝；在纯原假设下，如通过均匀分布的顺序统计量所论证的，对于 $q \\in (0,1)$，BH 程序通常做出 $0$ 次拒绝。因此，所声称的保证是错误的，前提也不充分。结论：不正确。\n\nD. 峰值在 $0$ 和 $0.5$ 附近的双峰分布可能源于原假设（均匀分布）和具有中等功效的备择假设（在 $0$ 附近产生一个峰）的混合，以及例如特定的效应量分布或离散的 $p$ 值。这不必然意味着检验之间存在依赖性或使 BH 的 FDR 控制失效。BH 控制在独立性和某些正相关结构下是有效的；双峰直方图本身并不能证明这些条件被违反。无论如何，BH 折线图仍然具有信息量，因为它可视化了有序 $p$ 值与 BH 边界的比较情况。结论：不正确。\n\nE. 如果 $\\pi_{0}  1$ 但非原假设的 $p$ 值仅提供微弱信息（例如，它们聚集在 $0.2$ 到 $0.4$ 附近而不是接近 $0$），那么即使在小的 $q$ 值（例如 $q$ 接近 $0.05$）下，小秩次的 BH 边界也非常低，许多在 $0.2$ 到 $0.4$ 范围内的 $p_{(i)}$ 将位于其上方。只有最小的几个秩次可能穿过边界，导致很少的拒绝。这种诊断行为在 $p$ 值直方图（缺少非常小的 $p$ 值）和 BH 折线图（有限的早期交叉）中都有所体现。结论：正确。\n\n总之，选项 A、B 和 E 正确地将诊断图与 $\\pi_{0}$、信号存在以及 BH 的预期联系起来；选项 C 和 D 因所述原因而不正确。", "answer": "$$\\boxed{ABE}$$", "id": "4930961"}]}