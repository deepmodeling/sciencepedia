{"hands_on_practices": [{"introduction": "在应用复杂的分层模型之前，我们必须首先回答一个基本问题：同一聚类内的观测值在多大程度上比不同聚类中的观测值更相似？本练习将介绍组内相关系数（Intraclass Correlation Coefficient, ICC），这是一个量化这种“聚类内聚性”的关键指标。通过根据方差分量计算ICC，你将学会衡量数据中的依赖程度，并为使用专门的统计方法提供依据。[@problem_id:4915039]", "problem": "一项公共卫生研究调查了个体在诊所内的收缩压，其中诊所被视为聚类。令 $Y_{ij}$ 表示诊所 $j$ 中个体 $i$ 的连续结果变量。考虑随机截距线性混合模型 $Y_{ij}=\\mu+b_{j}+\\varepsilon_{ij}$，其中 $b_{j}$ 独立同分布，均值为 $0$，方差为 $\\sigma_{b}^{2}$；$\\varepsilon_{ij}$ 独立同分布，均值为 $0$，方差为 $\\sigma_{w}^{2}$；且 $b_{j}$ 与 $\\varepsilon_{ij}$ 相互独立。使用限制性最大似然估计，诊所间方差的估计值为 $\\hat{\\sigma}_{b}^{2}=0.8$，诊所内方差的估计值为 $\\hat{\\sigma}_{w}^{2}=1.2$（两者均以结果变量的原始平方单位表示）。基于组内相关系数 (ICC) 的核心定义（在该模型下，其定义为从同一诊所中随机选择的两个个体之间的相关性），计算估计的 ICC，并根据聚类内聚性简要解释其大小。将 ICC 的最终数值答案表示为一个无单位的小数，并四舍五入到 $4$ 位有效数字。", "solution": "问题陈述经评估有效。其科学依据在于混合效应统计建模的原理，问题提法恰当，提供了所有必要信息，并以客观、明确的语言表述。\n\n问题描述了一个针对连续结果变量 $Y_{ij}$（诊所 $j$ 中个体 $i$ 的收缩压）的随机截距线性混合模型：\n$$ Y_{ij} = \\mu + b_j + \\varepsilon_{ij} $$\n在此模型中：\n- $\\mu$ 是总体平均收缩压。\n- $b_j$ 是诊所 $j$ 的随机截距，代表诊所 $j$ 的均值与总体均值 $\\mu$ 的偏差。这些随机效应被假定为独立同分布 (i.i.d.)，均值为 $0$，方差为 $\\sigma_{b}^{2}$，即诊所间方差。\n- $\\varepsilon_{ij}$ 是诊所 $j$ 内个体 $i$ 的随机误差，代表个体 $i$ 的测量值与其所在诊所均值的偏差。这些误差被假定为独立同分布 (i.i.d.)，均值为 $0$，方差为 $\\sigma_{w}^{2}$，即诊所内方差。\n- 随机效应 $b_j$ 和误差 $\\varepsilon_{ij}$ 被假定为相互独立。\n\n组内相关系数 (ICC)，用 $\\rho$ 表示，在此背景下定义为从同一诊所 $j$ 中随机选择的两个不同个体（例如 $i$ 和 $k$，其中 $i \\neq k$）的结果之间的相关性。在数学上，这表示为：\n$$ \\rho = \\text{Corr}(Y_{ij}, Y_{kj}) $$\n两个随机变量 $X$ 和 $Z$ 之间相关性的标准公式是 $\\text{Corr}(X, Z) = \\frac{\\text{Cov}(X, Z)}{\\sqrt{\\text{Var}(X)\\text{Var}(Z)}}$。将此应用于我们的模型：\n$$ \\rho = \\frac{\\text{Cov}(Y_{ij}, Y_{kj})}{\\sqrt{\\text{Var}(Y_{ij})\\text{Var}(Y_{kj})}} $$\n\n要计算 $\\rho$，我们必须首先求出单个观测值的总方差 $\\text{Var}(Y_{ij})$，以及来自同一聚类的两个观测值之间的协方差 $\\text{Cov}(Y_{ij}, Y_{kj})$。\n\n$Y_{ij}$ 的总方差通过对模型方程取方差得到。由于 $\\mu$ 是常数，所以 $\\text{Var}(\\mu) = 0$。由于 $b_j$ 和 $\\varepsilon_{ij}$ 的独立性，它们和的方差是它们方差的和：\n$$ \\text{Var}(Y_{ij}) = \\text{Var}(\\mu + b_j + \\varepsilon_{ij}) = \\text{Var}(b_j) + \\text{Var}(\\varepsilon_{ij}) = \\sigma_{b}^{2} + \\sigma_{w}^{2} $$\n表达式 $\\sigma_{b}^{2} + \\sigma_{w}^{2}$ 是结果变量的总方差。\n\n同一诊所 $j$ 内两个不同个体 $i$ 和 $k$ ($i \\neq k$) 的结果之间的协方差为：\n$$ \\text{Cov}(Y_{ij}, Y_{kj}) = \\text{Cov}(\\mu + b_j + \\varepsilon_{ij}, \\mu + b_j + \\varepsilon_{kj}) $$\n使用协方差的性质，并注意到两个表达式之间的共享项是诊所的随机效应 $b_j$：\n$$ \\text{Cov}(Y_{ij}, Y_{kj}) = \\text{Cov}(b_j, b_j) + \\text{Cov}(b_j, \\varepsilon_{kj}) + \\text{Cov}(\\varepsilon_{ij}, b_j) + \\text{Cov}(\\varepsilon_{ij}, \\varepsilon_{kj}) $$\n根据模型假设：\n- $\\text{Cov}(b_j, b_j) = \\text{Var}(b_j) = \\sigma_{b}^{2}$。\n- $\\text{Cov}(b_j, \\varepsilon_{kj}) = 0$ 且 $\\text{Cov}(\\varepsilon_{ij}, b_j) = 0$，因为随机效应和误差是相互独立的。\n- 对于 $i \\neq k$，$\\text{Cov}(\\varepsilon_{ij}, \\varepsilon_{kj}) = 0$，因为不同个体的误差是独立的。\n因此，协方差简化为：\n$$ \\text{Cov}(Y_{ij}, Y_{kj}) = \\sigma_{b}^{2} $$\n同一聚类中两个成员之间的协方差等于聚类间方差。这就是聚类内相关性的来源。\n\n将方差和协方差的表达式代入 $\\rho$ 的公式中：\n$$ \\rho = \\frac{\\sigma_{b}^{2}}{\\sqrt{(\\sigma_{b}^{2} + \\sigma_{w}^{2})(\\sigma_{b}^{2} + \\sigma_{w}^{2})}} = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\sigma_{w}^{2}} $$\nICC 是总方差中由聚类间变异所占的比例。\n\n问题提供了方差分量的限制性最大似然 (REML) 估计值：$\\hat{\\sigma}_{b}^{2} = 0.8$（诊所间）和 $\\hat{\\sigma}_{w}^{2} = 1.2$（诊所内）。我们使用这些估计值来计算估计的 ICC，即 $\\hat{\\rho}$：\n$$ \\hat{\\rho} = \\frac{\\hat{\\sigma}_{b}^{2}}{\\hat{\\sigma}_{b}^{2} + \\hat{\\sigma}_{w}^{2}} = \\frac{0.8}{0.8 + 1.2} = \\frac{0.8}{2.0} = 0.4 $$\n问题要求答案表示为四舍五入到 $4$ 位有效数字的小数。\n$$ \\hat{\\rho} = 0.4000 $$\n\nICC 为 $0.4$ 表示同一诊所内个体之间存在中等程度的相似性或“内聚性”。具体来说，这意味着收缩压测量值总变异性中估计有 $40\\%$ 可归因于诊所之间的系统性差异。这种程度的相关性不可忽略，并且证实了来自同一诊所的观测值不是独立的，这为使用混合效应模型（而非假定所有观测值独立的更简单的模型，如普通最小二乘回归）提供了理由。更高的 ICC 意味着更强的聚类效应（一个诊所内的个体非常相似），而接近 $0$ 的 ICC 则意味着诊所分组对结果几乎没有影响。", "answer": "$$\\boxed{0.4000}$$", "id": "4915039"}, {"introduction": "随机效应模型不仅能处理聚类问题，还使我们能够估计每个聚类的独特效应。本练习演示了如何计算聚类特定随机效应的最佳线性无偏预测（Best Linear Unbiased Predictions, BLUPs），它代表了每个聚类与总体平均值的偏差。掌握这项技术可以让你理解和量化聚类间的异质性，这是线性混合模型（Linear Mixed Models, LMMs）的一个核心特征。[@problem_id:4915025]", "problem": "考虑一个具有随机截距和随机斜率的单一聚类的线性混合模型 (LMM)。设观测响应向量为 $y \\in \\mathbb{R}^{n}$，固定效应设计矩阵为 $X \\in \\mathbb{R}^{n \\times 2}$，其第一列为全1向量，第二列为观测协变量向量 $x \\in \\mathbb{R}^{n}$，随机效应设计矩阵 $Z \\in \\mathbb{R}^{n \\times 2}$ 等于 $X$。固定效应参数向量为 $ \\beta \\in \\mathbb{R}^{2}$，随机效应向量为 $b \\in \\mathbb{R}^{2}$ 且 $b \\sim \\mathcal{N}(0, \\Sigma_b)$，其中 $\\Sigma_b \\in \\mathbb{R}^{2 \\times 2}$ 为给定的正定协方差矩阵，残差满足 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I_n)$，其中 $\\sigma^2 > 0$ 为已知。特定于聚类的数据包括 $y$、$x$、$ \\beta$、$\\Sigma_b$ 和 $\\sigma^2$。\n\n仅使用由 LMM 假设所蕴含的 $(b, y)$ 的联合高斯性质以及多元正态分布的标准条件化结果，推导出一个算法来计算给定观测数据下随机效应向量 $b$ 的最佳线性无偏预测 (BLUP)，并实现该算法。推导必须从 LMM 的设定和多元正态条件化法则开始。请勿在问题陈述中使用或引用任何快捷公式。\n\n您的程序必须实现所推导的算法，为以下每个测试用例计算预测的随机截距和随机斜率。对于每个用例，将两个预测值（截距和斜率）作为浮点数输出，并四舍五入到六位小数。将所有用例的结果按给定顺序汇总到一个列表中，并按照下述确切格式生成单行输出。\n\n测试套件：\n- 用例 $1$（一般情况）：\n  - $n = 5$\n  - $x = [0, 1, 2, 3, 4]$\n  - $y = [1.8, 2.25, 3.25, 3.95, 4.85]$\n  - $\\beta = [1.5, 0.8]$\n  - $\\Sigma_b = \\begin{bmatrix} 0.4 & 0.1 \\\\ 0.1 & 0.3 \\end{bmatrix}$\n  - $\\sigma^2 = 0.5$\n- 用例 $2$（小样本量）：\n  - $n = 2$\n  - $x = [0, 2]$\n  - $y = [-0.25, 2.4]$\n  - $\\beta = [0.0, 1.0]$\n  - $\\Sigma_b = \\begin{bmatrix} 1.0 & 0.2 \\\\ 0.2 & 0.5 \\end{bmatrix}$\n  - $\\sigma^2 = 1.2$\n- 用例 $3$（单次观测）：\n  - $n = 1$\n  - $x = [3]$\n  - $y = [1.3]$\n  - $\\beta = [2.0, -0.5]$\n  - $\\Sigma_b = \\begin{bmatrix} 0.2 & 0.0 \\\\ 0.0 & 0.1 \\end{bmatrix}$\n  - $\\sigma^2 = 0.8$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。该列表应包含用例1的预测随机截距和预测随机斜率，然后是用例2的，再然后是用例3的，所有数值都四舍五入到六位小数。例如，格式必须与 $[b0\\_1,b1\\_1,b0\\_2,b1\\_2,b0\\_3,b1\\_3]$ 完全一样，其中每个 $b$ 都是一个浮点数。", "solution": "该问题被评估为有效，因为它科学地基于标准统计理论，问题设定良好，给出了完整且一致的已知条件，并以客观的数学语言表达。满足有效问题的所有条件。\n\n该问题要求推导并实现一个算法，用于在特定的线性混合模型 (LMM) 中计算随机效应的最佳线性无偏预测 (BLUP)。推导必须基于随机效应和观测数据的联合高斯性质。\n\n单个聚类的 LMM 被指定为：\n$$\ny = X\\beta + Zb + \\varepsilon\n$$\n其中：\n- $y \\in \\mathbb{R}^{n}$ 是观测响应向量。\n- $X \\in \\mathbb{R}^{n \\times 2}$ 是固定效应设计矩阵。\n- $\\beta \\in \\mathbb{R}^{2}$ 是固定效应系数向量。\n- $Z \\in \\mathbb{R}^{n \\times 2}$ 是随机效应设计矩阵，在此问题中 $Z=X$。\n- $b \\in \\mathbb{R}^{2}$ 是随机效应向量。\n- $\\varepsilon \\in \\mathbb{R}^{n}$ 是残差向量。\n\n分布假设为：\n- 随机效应向量 $b$ 服从多元正态分布：$b \\sim \\mathcal{N}(0, \\Sigma_b)$，其中 $\\Sigma_b \\in \\mathbb{R}^{2 \\times 2}$ 是一个给定的正定协方差矩阵。\n- 残差向量 $\\varepsilon$ 服从多元正态分布：$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I_n)$，其中 $\\sigma^2 > 0$ 是已知方差，$I_n$ 是 $n \\times n$ 单位矩阵。\n- 随机效应 $b$ 和残差 $\\varepsilon$ 是相互独立的。\n\n随机效应向量 $b$ 的 BLUP 是其在给定观测数据 $y$ 下的条件期望，记为 $\\hat{b} = E[b|y]$。为了推导它，我们首先确定向量 $\\begin{pmatrix} b \\\\ y \\end{pmatrix}$ 的联合分布。\n\n由于 $y$ 是高斯随机向量 $b$ 和 $\\varepsilon$ 的线性组合，$(b, y)$ 的联合分布也是多元高斯分布。我们需要确定这个联合分布的均值向量和协方差矩阵。\n\n均值向量由下式给出：\n$$\nE\\left[\\begin{pmatrix} b \\\\ y \\end{pmatrix}\\right] = \\begin{pmatrix} E[b] \\\\ E[y] \\end{pmatrix}\n$$\n根据假设，$E[b] = 0$。$y$ 的期望为：\n$$\nE[y] = E[X\\beta + Zb + \\varepsilon] = X\\beta + Z E[b] + E[\\varepsilon] = X\\beta + Z(0) + 0 = X\\beta\n$$\n因此，联合分布的均值为：\n$$\n\\mu = \\begin{pmatrix} 0 \\\\ X\\beta \\end{pmatrix}\n$$\n\n联合分布的协方差矩阵是一个分块矩阵：\n$$\n\\text{Var}\\left(\\begin{pmatrix} b \\\\ y \\end{pmatrix}\\right) = \\begin{pmatrix} \\text{Var}(b) & \\text{Cov}(b, y) \\\\ \\text{Cov}(y, b) & \\text{Var}(y) \\end{pmatrix}\n$$\n这些分块计算如下：\n- $\\text{Var}(b) = \\Sigma_b$（由假设给出）。\n- $\\text{Var}(y)$：\n$$\n\\text{Var}(y) = \\text{Var}(X\\beta + Zb + \\varepsilon) = \\text{Var}(Zb + \\varepsilon)\n$$\n由于 $b$ 和 $\\varepsilon$ 是独立的，$\\text{Cov}(Zb, \\varepsilon) = Z \\text{Cov}(b, \\varepsilon) = 0$。因此：\n$$\n\\text{Var}(y) = \\text{Var}(Zb) + \\text{Var}(\\varepsilon) = Z \\text{Var}(b) Z^T + \\sigma^2 I_n = Z \\Sigma_b Z^T + \\sigma^2 I_n\n$$\n- $\\text{Cov}(b, y)$：\n$$\n\\text{Cov}(b, y) = \\text{Cov}(b, X\\beta + Zb + \\varepsilon) = \\text{Cov}(b, X\\beta) + \\text{Cov}(b, Zb) + \\text{Cov}(b, \\varepsilon)\n$$\n由于 $X\\beta$ 是一个常数，$\\text{Cov}(b, X\\beta) = 0$。由于 $b$ 和 $\\varepsilon$ 是独立的，$\\text{Cov}(b, \\varepsilon) = 0$。剩下：\n$$\n\\text{Cov}(b, y) = \\text{Cov}(b, Zb) = E[b(Zb)^T] - E[b]E[Zb]^T = E[bb^T Z^T] - 0 = E[bb^T]Z^T = \\text{Var}(b)Z^T = \\Sigma_b Z^T\n$$\n- $\\text{Cov}(y, b) = (\\text{Cov}(b, y))^T = ( \\Sigma_b Z^T )^T = Z \\Sigma_b$。\n\n结合这些分量，联合分布为：\n$$\n\\begin{pmatrix} b \\\\ y \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} 0 \\\\ X\\beta \\end{pmatrix}, \\begin{pmatrix} \\Sigma_b & \\Sigma_b Z^T \\\\ Z \\Sigma_b & Z \\Sigma_b Z^T + \\sigma^2 I_n \\end{pmatrix} \\right)\n$$\n\n我们现在应用分块多元正态向量条件分布的标准结果。如果 $\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} \\mu_1 \\\\ \\mu_2 \\end{pmatrix}, \\begin{pmatrix} \\Sigma_{11} & \\Sigma_{12} \\\\ \\Sigma_{21} & \\Sigma_{22} \\end{pmatrix} \\right)$，那么给定 $x_2$ 时 $x_1$ 的条件期望是：\n$$\nE[x_1|x_2] = \\mu_1 + \\Sigma_{12} \\Sigma_{22}^{-1} (x_2 - \\mu_2)\n$$\n通过映射我们的变量（$x_1=b$, $x_2=y$），我们得到 $b$ 的 BLUP：\n$$\n\\hat{b} = E[b|y] = E[b] + \\text{Cov}(b, y) (\\text{Var}(y))^{-1} (y - E[y])\n$$\n代入推导出的项：\n$$\n\\hat{b} = 0 + (\\Sigma_b Z^T) (Z \\Sigma_b Z^T + \\sigma^2 I_n)^{-1} (y - X\\beta)\n$$\n这就是我们想要的随机效应 BLUP 公式。\n\n要实现的算法如下：\n1. 对于每个测试用例，定义输入参数：向量 $y$ 和 $x$，固定效应 $\\beta$，随机效应协方差 $\\Sigma_b$，以及残差方差 $\\sigma^2$。\n2. 从协变量向量 $x$ 构建设计矩阵 $X$（以及 $Z$）。$X$ 的第一列是全1向量，第二列是 $x$。\n3. 计算 $y$ 的边际方差，即 $V = Z \\Sigma_b Z^T + \\sigma^2 I_n$。\n4. 计算 $V$ 的逆矩阵，记为 $V^{-1}$。\n5. 计算观测数据 $y$ 与固定效应均值贡献之间的差值，$y - X\\beta$。\n6. 使用推导出的公式计算 BLUP 向量 $\\hat{b}$：$\\hat{b} = \\Sigma_b Z^T V^{-1} (y - X\\beta)$。\n7. 提取 $\\hat{b}$ 的两个分量，它们分别对应于预测的随机截距和随机斜率，并将它们四舍五入到六位小数。\n8. 按照规定将所有测试用例的结果汇总到一个列表中。", "answer": "[0.291709,-0.016335,-0.155799,0.126588,0.122699,0.184049]", "id": "4915025"}, {"introduction": "当从线性分层模型转向非线性分层模型（如逻辑回归）时，模型系数的解释会变得更加微妙。本练习探讨了条件（聚类特定）效应和边际（总体平均）效应之间的关键区别，这一现象被称为比值比的不可合并性（non-collapsibility）。通过推导和比较这两种类型的比值比，你将更深刻地理解为什么从广义线性混合模型（Generalized Linear Mixed Models, GLMMs）中估计出的效应不能直接与其在总体水平上的对应物相比较。[@problem_id:4915054]", "problem": "一项生物统计学研究记录了医院 $j$ 中患者 $i$ 的二元结局 $Y_{ij} \\in \\{0,1\\}$，以及一个二元暴露 $X_{ij} \\in \\{0,1\\}$。假设数据可信地由一个具有 logit 链接和随机截距的分层广义线性混合模型（GLMM）生成，其中给定医院特定随机效应 $u_{j}$ 的 $Y_{ij}$ 的条件模型为\n$$\n\\operatorname{logit}\\left\\{ \\Pr\\left(Y_{ij}=1 \\mid X_{ij}, u_{j}\\right) \\right\\} = \\alpha + \\beta X_{ij} + u_{j},\n$$\n其中 $u_{j} \\sim \\mathcal{N}(0, \\sigma^{2})$ 且独立于 $X_{ij}$。一个拟合后的模型得出的估计值为 $\\hat{\\beta} = 1.10$ 和 $\\hat{\\sigma}^{2} = 0.60$。暴露的条件（特定于聚类）比值比为 $\\exp(\\beta)$。\n\n从比值比、logit 链接和正态混合分布性质的核心定义出发，通过对随机截距分布进行解析边缘化，并引用一个由分布性质证明的、有原则的近似方法，来推导暴露的近似总体平均（边缘）比值比。然后，使用提供的估计值 $\\hat{\\beta}$ 和 $\\hat{\\sigma}^{2}$ 计算其数值，并简要解释为什么在这种随机截距 logistic 设定下，边缘比值比相对于条件比值比有所衰减。\n\n将你最终的数值比值比四舍五入至四位有效数字。你的答案无需单位。", "solution": "问题要求从给定的条件（特定于聚类）分层 logistic 模型中推导出近似的总体平均（边缘）比值比，根据提供的估计值计算其数值，并解释与条件比值比相比其衰减的原因。\n\n该条件模型是为医院 $j$ 中患者 $i$ 的二元结局 $Y_{ij} \\in \\{0,1\\}$ 和二元暴露 $X_{ij} \\in \\{0,1\\}$ 定义的。该模型被指定为具有 logit 链接和随机截距 $u_j$ 的广义线性混合模型（GLMM）：\n$$\n\\operatorname{logit}\\left\\{ \\Pr\\left(Y_{ij}=1 \\mid X_{ij}, u_{j}\\right) \\right\\} = \\alpha + \\beta X_{ij} + u_{j}\n$$\n其中 $u_{j} \\sim \\mathcal{N}(0, \\sigma^{2})$ 是每个医院 $j$ 的独立同分布随机效应。拟合后的模型提供了估计值 $\\hat{\\beta} = 1.10$ 和 $\\hat{\\sigma}^{2} = 0.60$。\n\n首先，我们确定条件比值比和边缘比值比的定义。\n\n条件比值比（OR）是在随机效应 $u_j$ 的固定水平上定义的。在医院 $j$ 中，暴露 $X_{ij}=1$ 的个体的对数比值为 $\\alpha + \\beta(1) + u_j$。在同一家医院中，暴露 $X_{ij}=0$ 的个体的对数比值为 $\\alpha + \\beta(0) + u_j$。条件对数比值比是这些对数比值之间的差：\n$$\n\\text{log-OR}_{\\text{conditional}} = (\\alpha + \\beta + u_j) - (\\alpha + u_j) = \\beta\n$$\n因此，条件比值比为 $\\text{OR}_{\\text{conditional}} = \\exp(\\beta)$，这个值在所有医院中是恒定的。\n\n边缘比值比是基于边缘概率 $\\Pr(Y_{ij}=1 \\mid X_{ij})$ 定义的，这些概率是通过对随机截距 $u_j$ 的分布进行平均（或边缘化）得到的。\n设 $P(X_{ij}) = \\Pr(Y_{ij}=1 \\mid X_{ij})$。根据定义，\n$$\nP(X_{ij}) = E_{u_j}\\left[ \\Pr\\left(Y_{ij}=1 \\mid X_{ij}, u_j\\right) \\right]\n$$\n条件概率由逆 logit 函数 $\\Lambda(z) = 1/(1+\\exp(-z))$ 给出：\n$$\n\\Pr\\left(Y_{ij}=1 \\mid X_{ij}, u_j\\right) = \\Lambda(\\alpha + \\beta X_{ij} + u_j) = \\frac{\\exp(\\alpha + \\beta X_{ij} + u_j)}{1 + \\exp(\\alpha + \\beta X_{ij} + u_j)}\n$$\n边缘概率是这个条件概率乘以 $u_j$ 的概率密度函数（即正态分布 $\\mathcal{N}(0, \\sigma^2)$）后的积分：\n$$\nP(X_{ij}) = \\int_{-\\infty}^{\\infty} \\frac{\\exp(\\alpha + \\beta X_{ij} + u)}{1 + \\exp(\\alpha + \\beta X_{ij} + u)} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{u^2}{2\\sigma^2}\\right) du\n$$\n这个积分被称为 logistic-正态积分，它没有闭式解析解。因此，我们必须按要求使用一个有原则的近似方法。\n\n推导这种近似的一个强大且有原则的方法源于 logistic 回归模型的潜变量解释。该条件模型等价于假设存在一个潜在一元连续变量 $Y_{ij}^*$，使得：\n$$\nY_{ij}^* = \\alpha + \\beta X_{ij} + u_j + \\epsilon_{ij}\n$$\n且当且仅当 $Y_{ij}^* > 0$ 时，$Y_{ij}=1$。误差项 $\\epsilon_{ij}$ 服从均值为 $0$、方差为 $\\pi^2/3$ 的标准 logistic 分布。这些误差被假设独立于 $u_j$ 和 $X_{ij}$。\n\n为了找到边缘模型，我们考虑复合误差项 $v_{ij} = u_j + \\epsilon_{ij}$。边缘关系的潜变量模型为：\n$$\nY_{ij}^* = \\alpha + \\beta X_{ij} + v_{ij}\n$$\n由于 $u_j$ 和 $\\epsilon_{ij}$ 是独立的，复合误差项的方差是它们方差的和：\n$$\n\\operatorname{Var}(v_{ij}) = \\operatorname{Var}(u_j) + \\operatorname{Var}(\\epsilon_{ij}) = \\sigma^2 + \\frac{\\pi^2}{3}\n$$\n$v_{ij}$ 的分布是正态分布和 logistic 分布的卷积，其本身不是 logistic 分布。近似方法在于用一个具有不同尺度参数 $s_{marginal}$ 的 logistic 分布来近似 $v_{ij}$ 的分布。一个均值为 $0$、尺度参数为 $s$ 的 logistic 分布的方差为 $s^2\\pi^2/3$。我们将近似 logistic 分布的方差与 $v_{ij}$ 的真实方差相匹配：\n$$\ns_{marginal}^2 \\frac{\\pi^2}{3} = \\sigma^2 + \\frac{\\pi^2}{3}\n$$\n求解 $s_{marginal}^2$ 可得：\n$$\ns_{marginal}^2 = \\frac{\\sigma^2 + \\pi^2/3}{\\pi^2/3} = 1 + \\frac{3\\sigma^2}{\\pi^2}\n$$\n因此，近似边缘 logistic 分布的尺度为 $s_{marginal} = \\sqrt{1 + 3\\sigma^2/\\pi^2}$。\n边缘模型中的响应概率为 $\\Pr(Y_{ij}=1 \\mid X_{ij}) \\approx \\Pr(Y_{ij}^* > 0)$，在 $v_{ij}$ 的尺度化 logistic 近似下，该概率为：\n$$\nP(X_{ij}) \\approx \\Pr(v_{ij} > -(\\alpha + \\beta X_{ij})) \\approx \\Lambda\\left(\\frac{\\alpha + \\beta X_{ij}}{s_{marginal}}\\right)\n$$\n这给出了一个近似的边缘 logistic 模型：\n$$\n\\operatorname{logit}\\left\\{ \\Pr(Y_{ij}=1 \\mid X_{ij}) \\right\\} \\approx \\frac{\\alpha}{s_{marginal}} + \\frac{\\beta}{s_{marginal}} X_{ij} = \\alpha^* + \\beta^* X_{ij}\n$$\n边缘对数比值比为 $\\beta^* = \\beta/s_{marginal}$。因此，近似的边缘比值比是：\n$$\n\\text{OR}_{\\text{marginal}} \\approx \\exp(\\beta^*) = \\exp\\left(\\frac{\\beta}{\\sqrt{1 + 3\\sigma^2/\\pi^2}}\\right)\n$$\n现在，我们使用提供的估计值 $\\hat{\\beta} = 1.10$ 和 $\\hat{\\sigma}^2 = 0.60$ 来计算数值。\n首先，用估计的方差计算衰减因子 $s_{marginal}$：\n$$\ns_{marginal} = \\sqrt{1 + \\frac{3\\hat{\\sigma}^2}{\\pi^2}} = \\sqrt{1 + \\frac{3(0.60)}{\\pi^2}} = \\sqrt{1 + \\frac{1.8}{\\pi^2}}\n$$\n使用 $\\pi \\approx 3.14159265$，我们得到 $\\pi^2 \\approx 9.8696044$。\n$$\ns_{marginal} \\approx \\sqrt{1 + \\frac{1.8}{9.8696044}} \\approx \\sqrt{1 + 0.182378} \\approx \\sqrt{1.182378} \\approx 1.087372\n$$\n接下来，我们计算近似的边缘对数比值比 $\\hat{\\beta}^*$：\n$$\n\\hat{\\beta}^* \\approx \\frac{\\hat{\\beta}}{s_{marginal}} \\approx \\frac{1.10}{1.087372} \\approx 1.011614\n$$\n最后，我们计算边缘比值比：\n$$\n\\text{OR}_{\\text{marginal}} \\approx \\exp(\\hat{\\beta}^*) \\approx \\exp(1.011614) \\approx 2.74996\n$$\n四舍五入到四位有效数字，边缘比值比为 $2.750$。\n\n边缘比值比相对于条件比值比发生衰减的原因可以从数学和概念两个层面来解释。\n从数学上看，只要聚类间方差 $\\sigma^2$ 大于 $0$，衰减因子 $s_{marginal} = \\sqrt{1 + 3\\sigma^2/\\pi^2}$ 就严格大于 $1$。因此，边缘对数比值比的绝对值 $|\\beta^*| = |\\beta|/s_{marginal}$ 小于条件对数比值比的绝对值 $|\\beta|$。这意味着 $\\exp(\\beta^*)$ 比 $\\exp(\\beta)$ 更接近 $1$（比值比的零假设值）。衰减的程度随着聚类间异质性 $\\sigma^2$ 的增加而增加。如果 $\\sigma^2=0$，那么 $s_{marginal}=1$，$\\beta^*=\\beta$，条件效应和边缘效应相同，这符合预期。\n\n从概念上讲，这种衰减是一种被称为比值比的不可合并性（non-collapsibility）的统计现象的体现，该现象源于 logit 链接函数的非线性特性。条件比值比衡量的是在基线风险保持不变的特定组（医院 $j$）内，暴露 $X$ 和结局 $Y$ 之间的关联。相比之下，边缘比值比衡量的是整个群体中的关联，这个群体是具有不同基线风险（由随机效应 $u_j$ 决定）的多个组的混合体。当我们对 $u_j$ 的分布进行边缘化时，我们实际上是在对不同的基线风险下的非线性概率函数 $\\Lambda(\\alpha + \\beta X_{ij} + u_j)$ 进行平均。由于应用于非线性 logistic 函数的詹森不等式，这个平均过程导致的 $X$ 和 $Y$ 之间的边缘关系要弱于任何给定层内的条件关系。聚类间基线风险的这种异质性在群体水平上部分地混淆了暴露-结局关系，从而导致边缘比值比的衰减。", "answer": "$$\\boxed{2.750}$$", "id": "4915054"}]}