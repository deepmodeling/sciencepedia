{"hands_on_practices": [{"introduction": "在广义估计方程（GEE）中，一个关键步骤是为组内相关性指定一个“工作”相关矩阵。本练习将带您从第一性原理出发，推导出一阶自回归（AR(1)）相关矩阵，这是一种常用于等距时间纵向数据的结构。通过这个实践[@problem_id:4913842]，您将深入理解相关性如何随时间衰减，以及如何将这种动态过程转化为GEE分析中使用的具体数学形式。", "problem": "一项纵向队列研究在 $4$ 次等间距的临床访视中为每位受试者测量一个连续生物标志物，访视时间索引为 $t \\in \\{0,1,2,3\\}$。为了使用广义估计方程 (GEE) 拟合边际均值模型，需要一个工作相关矩阵来捕捉跨访视的受试者内相关性。考虑使用一阶自回归 (AR(1)) 机制来对受试者内的依赖性进行建模，该机制与等间距时间上的弱平稳性和马尔可夫性质兼容。假设对于一个中心化过程，以下基本条件成立：对每位受试者，定义 $X_{t} = Y_{t} - \\mu$，并假设 $X_{t}$ 满足 $X_{t} = \\rho X_{t-1} + \\epsilon_{t}$，其中 $|\\rho|1$，$\\{\\epsilon_{t}\\}$ 是一个均值为 $0$、方差为 $\\sigma_{\\epsilon}^{2}$ 的白噪声过程，并且在时间上不相关，也与 $X_{t}$ 的过去值不相关。\n\n仅使用这些假设和弱平稳性下自协方差函数的定义，论证为何 AR(1) 工作相关性对于等间距的纵向测量是合适的，并推导在有 $4$ 次访视的单个受试者情况下，其隐含的工作相关矩阵（作为未知参数 $\\rho$ 的函数）。请用一个关于 $\\rho$ 的 $4 \\times 4$ 工作相关矩阵的闭式解析表达式给出你的最终答案。不要对答案进行四舍五入。", "solution": "该问题陈述经评估是有效的。它在随机过程和生物统计学理论中具有科学依据，特别是关于广义估计方程 (GEE) 和 AR(1) 模型。这个问题提法恰当，提供了所有必要的定义和约束，例如 AR(1) 过程的形式 $X_{t} = \\rho X_{t-1} + \\epsilon_{t}$、白噪声过程 $\\{\\epsilon_t\\}$ 的性质、平稳性条件 $|\\rho|1$ 以及时间点的数量。其目标清晰明确：论证使用 AR(1) 结构的合理性，并推导相应的 $4 \\times 4$ 工作相关矩阵。该问题是客观、完整且没有任何逻辑矛盾或事实错误的。\n\n任务是论证一阶自回归 (AR(1)) 工作相关结构对于等间距纵向数据的适用性，并推导相应的 $4 \\times 4$ 工作相关矩阵 $R(\\rho)$。\n\n首先，我们讨论其合理性。AR(1) 模型由于以下几个原因，特别适用于在等时间间隔收集的纵向数据。\n1.  它假定在给定时间 $t$ 的测量值是其紧邻的前一个时间 $t-1$ 的测量值的函数，外加随机噪声。这反映了马尔可夫性质，对于许多生物或物理过程而言，这是一个合理的简化假设，因为在这些过程中，紧邻的过去状态是当前状态最显著的预测因子。\n2.  该模型意味着两次测量之间的相关性随着它们之间的时间滞后增加而呈指数级衰减。对于一个受试者的重复测量，时间上更近的测量值（例如，访视1和访视2）比时间上更远的测量值（例如，访视1和访视4）具有更强的相关性，这是非常合理的。AR(1) 结构在数学上将这种直观的衰减形式化。\n3.  由 GEE 工作相关框架和约束条件 $|\\rho|1$ 所隐含的弱平稳性假设，意味着均值、方差和自相关结构不随时间变化。这为受试者内的依赖性提供了一个稳定且简约的模型，该模型由单一参数 $\\rho$ 表征。\n\n接下来，我们推导工作相关矩阵。单个受试者的相关矩阵 $R$ 的元素为 $R_{ij} = \\text{Corr}(Y_i, Y_j)$，其中 $Y_i$ 和 $Y_j$ 是来自集合 $\\{0, 1, 2, 3\\}$ 的时间索引 $i$ 和 $j$ 时的结果。我们令矩阵索引从1到4，对应于时间 $t=0, 1, 2, 3$。因此，元素 $R_{ij}$ 对应于 $\\text{Corr}(Y_{i-1}, Y_{j-1})$。\n\n给定中心化过程 $X_t = Y_t - \\mu$，$Y_t$ 的协方差和方差性质与 $X_t$ 的相同。具体来说，$\\text{Var}(Y_t) = \\text{Var}(X_t)$ 且 $\\text{Cov}(Y_i, Y_j) = \\text{Cov}(X_i, X_j)$。相关性由下式给出：\n$$\n\\text{Corr}(Y_i, Y_j) = \\frac{\\text{Cov}(Y_i, Y_j)}{\\sqrt{\\text{Var}(Y_i)\\text{Var}(Y_j)}} = \\frac{\\text{Cov}(X_i, X_j)}{\\sqrt{\\text{Var}(X_i)\\text{Var}(X_j)}}\n$$\n在弱平稳性假设下，所有 $t$ 的方差都是恒定的，即 $\\text{Var}(X_t) = \\gamma(0)$，并且协方差仅取决于时间滞后 $k = |i-j|$，即 $\\text{Cov}(X_i, X_j) = \\gamma(k)$。因此，自相关函数 (ACF) 为 $\\rho(k) = \\frac{\\gamma(k)}{\\gamma(0)}$。我们的目标是找到 $\\rho(k)$ 的形式。\n\n1.  推导方差 $\\gamma(0)$：\n根据模型定义，$X_t = \\rho X_{t-1} + \\epsilon_t$。我们计算 $X_t$ 的方差：\n$$\n\\text{Var}(X_t) = \\text{Var}(\\rho X_{t-1} + \\epsilon_t)\n$$\n由于 $\\epsilon_t$ 与 $X_t$ 的过去值（包括 $X_{t-1}$）不相关，和的方差等于方差的和：\n$$\n\\text{Var}(X_t) = \\text{Var}(\\rho X_{t-1}) + \\text{Var}(\\epsilon_t) = \\rho^2 \\text{Var}(X_{t-1}) + \\sigma_{\\epsilon}^2\n$$\n根据弱平稳性，$\\text{Var}(X_t) = \\text{Var}(X_{t-1}) = \\gamma(0)$。将此代入方程得：\n$$\n\\gamma(0) = \\rho^2 \\gamma(0) + \\sigma_{\\epsilon}^2\n$$\n求解 $\\gamma(0)$：\n$$\n\\gamma(0)(1 - \\rho^2) = \\sigma_{\\epsilon}^2 \\implies \\gamma(0) = \\frac{\\sigma_{\\epsilon}^2}{1 - \\rho^2}\n$$\n此结果是有效的，因为问题陈述中说明了 $|\\rho|1$，确保了 $1 - \\rho^2 > 0$。\n\n2.  推导当 $k > 0$ 时的自协方差函数 $\\gamma(k)$：\n滞后 $k$ 的自协方差为 $\\gamma(k) = \\text{Cov}(X_t, X_{t-k})$。由于过程是中心化的 ($E[X_t] = 0$)，这等于 $E[X_t X_{t-k}]$。\n$$\n\\gamma(k) = E[X_t X_{t-k}] = E[(\\rho X_{t-1} + \\epsilon_t) X_{t-k}]\n$$\n根据期望的线性性质：\n$$\n\\gamma(k) = \\rho E[X_{t-1} X_{t-k}] + E[\\epsilon_t X_{t-k}]\n$$\n对于任何滞后 $k > 0$，时间点 $t-k$ 相对于时间 $t$ 属于过去。根据假设，噪声项 $\\epsilon_t$ 与过程 $X$ 的所有过去值都不相关，所以 $E[\\epsilon_t X_{t-k}] = 0$。方程简化为：\n$$\n\\gamma(k) = \\rho E[X_{t-1} X_{t-k}] = \\rho \\text{Cov}(X_{t-1}, X_{t-k})\n$$\n根据平稳性，$\\text{Cov}(X_{t-1}, X_{t-k}) = \\gamma((t-1) - (t-k)) = \\gamma(k-1)$。这得出了 AR(1) 过程的 Yule-Walker 方程：\n$$\n\\gamma(k) = \\rho \\gamma(k-1)\n$$\n这是一个递归关系。从 $k=1$ 开始：\n$\\gamma(1) = \\rho \\gamma(0)$\n$\\gamma(2) = \\rho \\gamma(1) = \\rho (\\rho \\gamma(0)) = \\rho^2 \\gamma(0)$\n通过归纳法，对于任何整数滞后 $k \\ge 0$，自协方差为：\n$$\n\\gamma(k) = \\rho^k \\gamma(0)\n$$\n\n3.  推导自相关函数 $\\rho(k)$：\nACF 定义为 $\\rho(k) = \\frac{\\gamma(k)}{\\gamma(0)}$。代入 $\\gamma(k)$ 的表达式：\n$$\n\\rho(k) = \\frac{\\rho^k \\gamma(0)}{\\gamma(0)} = \\rho^k \\quad \\text{for } k \\ge 0\n$$\n由于 $\\rho(k) = \\rho(-k)$，对于任何整数滞后 $k$，其一般形式为 $\\rho(k) = \\rho^{|k|}$。\n\n4.  构建 $4 \\times 4$ 工作相关矩阵 $R(\\rho)$：\n该矩阵的元素为 $R_{ij} = \\text{Corr}(Y_{i-1}, Y_{j-1}) = \\rho(|(i-1)-(j-1)|) = \\rho^{|i-j|}$，其中 $i,j \\in \\{1, 2, 3, 4\\}$。\n对角线元素对应滞后 $k=0$：$R_{ii} = \\rho^{|i-i|} = \\rho^0 = 1$。\n非对角线元素为：\n$R_{12} = R_{21} = \\rho^{|1-2|} = \\rho^1 = \\rho$\n$R_{13} = R_{31} = \\rho^{|1-3|} = \\rho^2$\n$R_{14} = R_{41} = \\rho^{|1-4|} = \\rho^3$\n$R_{23} = R_{32} = \\rho^{|2-3|} = \\rho^1 = \\rho$\n$R_{24} = R_{42} = \\rho^{|2-4|} = \\rho^2$\n$R_{34} = R_{43} = \\rho^{|3-4|} = \\rho^1 = \\rho$\n\n将这些元素组合成一个 $4 \\times 4$ 矩阵，得到 AR(1) 工作相关矩阵：\n$$\nR(\\rho) = \\begin{pmatrix}\n1  \\rho  \\rho^2  \\rho^3 \\\\\n\\rho  1  \\rho  \\rho^2 \\\\\n\\rho^2  \\rho  1  \\rho \\\\\n\\rho^3  \\rho^2  \\rho  1\n\\end{pmatrix}\n$$\n这是一个对称托普利茨矩阵，是平稳时间序列过程的一个特征。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\rho  \\rho^2  \\rho^3 \\\\\n\\rho  1  \\rho  \\rho^2 \\\\\n\\rho^2  \\rho  1  \\rho \\\\\n\\rho^3  \\rho^2  \\rho  1\n\\end{pmatrix}\n}\n$$", "id": "4913842"}, {"introduction": "广义估计方程的核心是一个看似复杂的矩阵方程，但它是由几个逻辑部分组合而成的。这个练习的目标是让您亲手构建这个方程，从而揭开它的神秘面纱。您将为簇状二元结果数据推导完整的GEE系统[@problem_id:4913837]，这个过程会要求您明确地定义均值、方差和工作相关性等所有关键组成部分，并将它们整合为最终的估计方程。", "problem": "一项队列研究跟踪了$n$个相关个体的簇（例如，兄弟姐妹），其中簇$i$拥有$m_i$个重复的二元结局$\\{Y_{ij}: j=1,\\dots,m_i\\}$和协变量向量$\\{x_{ij} \\in \\mathbb{R}^p\\}$。假设一个使用logit连接函数的广义线性模型，因此边际均值为$\\mu_{ij} = \\Pr(Y_{ij}=1 \\mid x_{ij}) = \\exp(\\eta_{ij})/(1+\\exp(\\eta_{ij}))$，其中线性预测变量为$\\eta_{ij} = x_{ij}^{\\top}\\beta$。令$X_i$为$m_i \\times p$的设计矩阵，其第$j$行为$x_{ij}^{\\top}$，$\\mu_i = (\\mu_{i1},\\dots,\\mu_{im_i})^{\\top}$，以及$y_i = (y_{i1},\\dots,y_{im_i})^{\\top}$。在针对相关结局的广义估计方程方法下，使用以下基本事实：\n- 对于均值为$\\mu_{ij}$的伯努利变量，其方差为$\\mu_{ij}(1-\\mu_{ij})$。\n- 对于logit连接函数，反连接函数的导数满足$\\frac{d\\mu_{ij}}{d\\eta_{ij}} = \\mu_{ij}(1-\\mu_{ij})$。\n- 工作协方差的形式为$V_i = A_i^{1/2} R_i(\\alpha) A_i^{1/2}$，其中$A_i$是边际方差的对角矩阵，$R_i(\\alpha)$是工作相关矩阵。对于可交换结构，$R_i(\\alpha)$的对角线元素为$1$，非对角线元素为$\\alpha$，且$-1/(m_i-1)  \\alpha  1$以确保正定性。\n\n任务：\n1. 用$\\mu_{ij}$（$j=1,\\dots,m_i$）显式表达$A_i$。\n2. 在可交换工作相关性下，推导关于$\\beta$的广义估计方程组，写出估计函数$U(\\beta)$的闭合形式，该形式仅依赖于$X_i$、$\\mu_i$、$y_i$、$\\alpha$、$m_i$、$m_i \\times m_i$的单位矩阵$I_{m_i}$和$m_i \\times m_i$的全1矩阵$J_{m_i}$。您的最终表达式应以$\\alpha$、$m_i$、$I_{m_i}$和$J_{m_i}$表示出显式的$R_i(\\alpha)^{-1}$。\n\n请按顺序以两个表达式的形式提供最终答案：首先是显式的$A_i$，其次是显式的$U(\\beta)$。无需进行数值计算。最终答案中不应包含任何等号。无需四舍五入，也不涉及任何单位。", "solution": "用户提供了一个来自生物统计学领域的、提法良好的问题陈述，具体涉及广义估计方程 (GEE) 的构建。经过严格验证，确认该问题具有科学依据、内容自洽且客观。所有提供的信息、定义和条件在用于相关二元数据的GEE统计理论中都是标准的。\n\n该问题有效。我现在将进行一个完整的、有理有据的解答。\n\n根据要求，解答分为两个部分。首先，我们确定矩阵$A_i$。其次，我们推导GEE估计函数$U(\\beta)$。\n\n### 任务1：显式表达$A_i$\n\n问题陈述$A_i$是簇$i$中结局$Y_{ij}$的边际方差的对角矩阵。结局$\\{Y_{ij}\\}$是二元的，服从伯努利分布。对于一个均值为$\\mu = \\Pr(Y=1)$的伯努利随机变量$Y$，其方差由$\\text{Var}(Y) = \\mu(1-\\mu)$给出。\n\n在这个问题中，$Y_{ij}$的均值被给定为$\\mu_{ij}$。因此，$Y_{ij}$的边际方差是$\\text{Var}(Y_{ij}) = \\mu_{ij}(1-\\mu_{ij})$。\n\n矩阵$A_i$是一个$m_i \\times m_i$的对角矩阵，其第$j$个对角元素是$\\text{Var}(Y_{ij})$。\n所以，$A_i$的元素是$(A_i)_{jk} = \\delta_{jk} \\mu_{ij}(1-\\mu_{ij})$，其中$\\delta_{jk}$是克罗内克δ。\n这可以用$\\text{diag}(\\cdot)$算子写为：\n$$\nA_i = \\text{diag}(\\mu_{i1}(1-\\mu_{i1}), \\mu_{i2}(1-\\mu_{i2}), \\dots, \\mu_{im_i}(1-\\mu_{im_i}))\n$$\n\n### 任务2：推导广义估计方程组\n\n广义估计函数$U(\\beta)$是来自$n$个簇各自贡献的总和：\n$$\nU(\\beta) = \\sum_{i=1}^{n} U_i(\\beta)\n$$\n第$i$个簇的贡献$U_i(\\beta)$由通用公式给出：\n$$\nU_i(\\beta) = D_i^{\\top} V_i^{-1} S_i\n$$\n其中$S_i = y_i - \\mu_i$是簇$i$的残差向量，$V_i$是工作协方差矩阵，而$D_i = \\frac{\\partial \\mu_i}{\\partial \\beta^{\\top}}$是均值向量关于回归系数$\\beta$的$m_i \\times p$导数矩阵。我们依次推导每个部分。\n\n1.  **导数矩阵 $D_i$**：\n    $D_i$的$(j,k)$元素是$\\frac{\\partial \\mu_{ij}}{\\partial \\beta_k}$。使用链式法则：\n    $$\n    \\frac{\\partial \\mu_{ij}}{\\partial \\beta_k} = \\frac{d\\mu_{ij}}{d\\eta_{ij}} \\frac{\\partial \\eta_{ij}}{\\partial \\beta_k}\n    $$\n    问题提供了两个必要的事实：\n    -   对于logit连接函数，$\\frac{d\\mu_{ij}}{d\\eta_{ij}} = \\mu_{ij}(1-\\mu_{ij})$。这是$A_i$的第$j$个对角元素。\n    -   线性预测变量为$\\eta_{ij} = x_{ij}^{\\top}\\beta = \\sum_{l=1}^{p} x_{ijl}\\beta_l$。因此，$\\frac{\\partial \\eta_{ij}}{\\partial \\beta_k} = x_{ijk}$。这是协变量向量$x_{ij}$的第$k$个元素。\n    \n    结合这些，矩阵$D_i$的第$j$行由$\\frac{\\partial \\mu_{ij}}{\\partial \\beta^{\\top}} = \\mu_{ij}(1-\\mu_{ij}) x_{ij}^{\\top}$给出。\n    通过堆叠$m_i$行，我们可以将$D_i$以矩阵形式写为方差对角矩阵$A_i$和设计矩阵$X_i$的乘积：\n    $$\n    D_i = A_i X_i\n    $$\n\n2.  **逆工作协方差矩阵 $V_i^{-1}$**：\n    工作协方差矩阵被给定为$V_i = A_i^{1/2} R_i(\\alpha) A_i^{1/2}$。为了求其逆矩阵，我们使用性质$(BCD)^{-1} = D^{-1}C^{-1}B^{-1}$。\n    由于$A_i$是对角矩阵，$A_i^{1/2}$也是对角矩阵，其逆矩阵$(A_i^{1/2})^{-1}$是一个对角矩阵，元素为$1/\\sqrt{\\mu_{ij}(1-\\mu_{ij})}$。我们将其记为$A_i^{-1/2}$。\n    因此，$V_i$的逆矩阵是：\n    $$\n    V_i^{-1} = (A_i^{1/2} R_i(\\alpha) A_i^{1/2})^{-1} = (A_i^{1/2})^{-1} R_i(\\alpha)^{-1} (A_i^{1/2})^{-1} = A_i^{-1/2} R_i(\\alpha)^{-1} A_i^{-1/2}\n    $$\n\n3.  **逆工作相关矩阵 $R_i(\\alpha)^{-1}$**：\n    可交换工作相关矩阵$R_i(\\alpha)$的对角线上为1，非对角线上为$\\alpha$。这种结构可以表示为单位矩阵$I_{m_i}$和全1矩阵$J_{m_i}$的线性组合：\n    $$\n    R_i(\\alpha) = (1-\\alpha)I_{m_i} + \\alpha J_{m_i}\n    $$\n    这种形式矩阵的逆是一个标准结果。它具有相同的形式，$c_1 I_{m_i} + c_2 J_{m_i}$。通过求解方程$( (1-\\alpha)I_{m_i} + \\alpha J_{m_i} ) (c_1 I_{m_i} + c_2 J_{m_i}) = I_{m_i}$并使用性质$J_{m_i}^2 = m_i J_{m_i}$，我们找到系数$c_1$和$c_2$。\n    得到的逆矩阵是：\n    $$\n    R_i(\\alpha)^{-1} = \\frac{1}{1-\\alpha} I_{m_i} - \\frac{\\alpha}{(1-\\alpha)(1 + (m_i-1)\\alpha)} J_{m_i}\n    $$\n    条件$-1/(m_i-1)  \\alpha  1$确保分母非零且矩阵是正定的。\n\n4.  **组装估计函数 $U(\\beta)$**：\n    现在我们将推导出的各部分代入$U_i(\\beta)$的表达式中：\n    $$\n    U_i(\\beta) = D_i^{\\top} V_i^{-1} S_i = (A_i X_i)^{\\top} (A_i^{-1/2} R_i(\\alpha)^{-1} A_i^{-1/2}) (y_i - \\mu_i)\n    $$\n    使用转置性质$(AB)^\\top = B^\\top A^\\top$：\n    $$\n    U_i(\\beta) = X_i^{\\top} A_i^{\\top} A_i^{-1/2} R_i(\\alpha)^{-1} A_i^{-1/2} (y_i - \\mu_i)\n    $$\n    由于$A_i$是对角矩阵，它是对称的（$A_i^{\\top} = A_i$）。并且，根据定义，$A_i = A_i^{1/2} A_i^{1/2}$。乘积$A_i^{\\top} A_i^{-1/2}$简化为：\n    $$\n    A_i^{\\top} A_i^{-1/2} = A_i A_i^{-1/2} = (A_i^{1/2} A_i^{1/2}) A_i^{-1/2} = A_i^{1/2} (A_i^{1/2} A_i^{-1/2}) = A_i^{1/2} I_{m_i} = A_i^{1/2}\n    $$\n    将此代回$U_i(\\beta)$的表达式中：\n    $$\n    U_i(\\beta) = X_i^{\\top} A_i^{1/2} R_i(\\alpha)^{-1} A_i^{-1/2} (y_i - \\mu_i)\n    $$\n    最后，我们对所有簇$i=1, \\dots, n$求和，并代入$R_i(\\alpha)^{-1}$的显式表达式：\n    $$\n    U(\\beta) = \\sum_{i=1}^{n} X_i^{\\top} A_i^{1/2} \\left( \\frac{1}{1-\\alpha} I_{m_i} - \\frac{\\alpha}{(1-\\alpha)(1 + (m_i-1)\\alpha)} J_{m_i} \\right) A_i^{-1/2} (y_i - \\mu_i)\n    $$\n    这是在指定条件下GEE估计函数的最终闭合形式表达式。它取决于数据（$X_i, y_i$）、模型参数（通过$\\mu_i$的$\\beta$和$\\alpha$）以及簇的大小（$m_i$）。矩阵$A_i$是$\\mu_i$的函数，正如第一部分所确立的。", "answer": "$$\n\\boxed{\nA_i = \\text{diag}(\\mu_{i1}(1-\\mu_{i1}), \\mu_{i2}(1-\\mu_{i2}), \\dots, \\mu_{im_i}(1-\\mu_{im_i}))\n}\n$$\n$$\n\\boxed{\nU(\\beta) = \\sum_{i=1}^{n} X_i^{\\top} A_i^{1/2} \\left[ \\frac{1}{1-\\alpha} I_{m_i} - \\frac{\\alpha}{(1-\\alpha)(1 + (m_i-1)\\alpha)} J_{m_i} \\right] A_i^{-1/2} (y_i - \\mu_i)\n}\n$$", "id": "4913837"}, {"introduction": "建立模型后，下一步关键任务是解释其结果并用它来进行预测，这正是将理论应用于实践的体现。本练习[@problem_id:4913822]将通过一个关于罕见事件的案例，比较对数（log）连接函数和逻辑（logit）连接函数的不同之处。您将学习如何根据连接函数的选择来正确解释模型系数（如风险比与优势比），并动手计算不同模型下的预测风险，从而掌握评估和应用GEE模型的实用技能。", "problem": "一项呼吸道感染监测研究对 $n$ 个家庭进行了连续 $T$ 周的跟踪，产生了相关的二元结果 $Y_{it} \\in \\{0,1\\}$，该结果表示家庭 $i$ 在第 $t$ 周是否报告了至少一例新感染。由于每周的感染不常见，经验边际风险很小。为了在对边际均值进行建模时考虑家庭内部的相关性，分析人员拟合了两个具有可交换工作相关性结构的广义估计方程 (GEE; 广义估计方程)：一个使用对数联接，另一个使用 logit 联接。两个模型都使用相同的协变量向量 $X_{it} = (1, \\text{exposure}_{it}, \\text{age}_{i}^{*})^{\\top}$，其中 $\\text{exposure}_{it} \\in \\{0,1\\}$ 表示在第 $t$ 周是否采取了有针对性的预防措施，而 $\\text{age}_{i}^{*} = (\\text{age}_{i} - 40)/10$ 将年龄以十年为单位进行换算，并以 40 岁为中心。家庭内部工作相关性的估计值为 $\\hat{\\rho} = 0.20$。\n\n从对数联接的 GEE 得到的估计回归系数为 $\\hat{\\beta}^{\\log} = (\\hat{\\beta}^{\\log}_{0}, \\hat{\\beta}^{\\log}_{1}, \\hat{\\beta}^{\\log}_{2}) = (-4.70, 0.40, 0.03)$。从 logit 联接的 GEE 得到的估计回归系数为 $\\hat{\\beta}^{\\mathrm{logit}} = (\\hat{\\beta}^{\\mathrm{logit}}_{0}, \\hat{\\beta}^{\\mathrm{logit}}_{1}, \\hat{\\beta}^{\\mathrm{logit}}_{2}) = (-4.90, 0.70, 0.05)$。\n\n仅使用具有典范联接映射的边际模型的第一性原理，并从 GEE 通过联接函数 $g$ 指定均值模型（即对于边际均值 $\\mu_{it} = \\mathbb{E}(Y_{it} \\mid X_{it})$，有 $g\\!\\left(\\mu_{it}\\right) = X_{it}^{\\top}\\beta$）的定义出发，完成以下任务：\n\n1. 根据边际均值模型的参数，解释在对数联接与 logit 联接下，暴露效应的可解释性有何不同，特别是对于罕见事件。\n2. 对于一个 $\\text{exposure}_{it} = 1$ 且 $\\text{age}_{i} = 30$ 岁的家庭，计算在每个拟合的 GEE 下的预测边际风险。使用 $X_{0} = (1, 1, -1)^{\\top}$，因为 $\\text{age}_{i}^{*} = (30 - 40)/10 = -1$。将两个预测值四舍五入到四位有效数字。将这两个预测值以一个包含两个元素的行矩阵形式报告，其中第一个元素对应于对数联接的 GEE，第二个元素对应于 logit 联接的 GEE。不需要单位。", "solution": "该问题是有效的，因为它在科学上基于广义估计方程 (GEE) 的理论，问题提法清晰，为所需任务提供了所有必要信息，并以客观、正式的语言表述。我们可以开始解题。\n\n问题要求基于 GEE 框架，针对相关的二元结果 $Y_{it}$ 完成两项任务。边际均值 $\\mu_{it} = \\mathbb{E}(Y_{it} \\mid X_{it})$ 通过联接函数 $g$ 建模为 $g(\\mu_{it}) = X_{it}^{\\top}\\beta$。此处，$\\mu_{it}$ 代表家庭 $i$ 在第 $t$ 周的边际感染风险。\n\n### 第一部分：暴露效应的解释\n\n由对应于协变量 $\\text{exposure}_{it}$ 的系数 $\\beta_1$ 所捕捉的暴露效应的可解释性，直接取决于所选的联接函数 $g$。\n\n**对数联接（相对风险模型）**\n\n对于第一个 GEE，联接函数是自然对数 $g(\\mu_{it}) = \\ln(\\mu_{it})$。因此，边际均值模型为：\n$$\n\\ln(\\mu_{it}) = \\beta^{\\log}_{0} + \\beta^{\\log}_{1} \\cdot \\text{exposure}_{it} + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\n$$\n对两边取指数，得到风险本身的模型：\n$$\n\\mu_{it} = \\exp\\left(\\beta^{\\log}_{0} + \\beta^{\\log}_{1} \\cdot \\text{exposure}_{it} + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\\right)\n$$\n为了解释 $\\beta^{\\log}_{1}$，我们在保持所有其他协变量不变的情况下，考察暴露个体 ($\\text{exposure}_{it} = 1$) 与未暴露个体 ($\\text{exposure}_{it} = 0$) 的风险比。这个比率就是风险比 (RR)。\n$$\n\\text{RR} = \\frac{\\mu_{it}(\\text{exposure}_{it}=1)}{\\mu_{it}(\\text{exposure}_{it}=0)} = \\frac{\\exp\\left(\\beta^{\\log}_{0} + \\beta^{\\log}_{1}(1) + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\\right)}{\\exp\\left(\\beta^{\\log}_{0} + \\beta^{\\log}_{1}(0) + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\\right)} = \\exp(\\beta^{\\log}_{1})\n$$\n因此，$\\exp(\\beta^{\\log}_{1})$ 就是风险比。对数联接模型直接估计风险比的对数。效应度量 $\\exp(\\beta^{\\log}_{1})$ 在其他协变量（在此例中为年龄）的所有水平上是恒定的。\n\n**Logit 联接（逻辑斯谛回归模型）**\n\n对于第二个 GEE，联接函数是 logit，$g(\\mu_{it}) = \\text{logit}(\\mu_{it}) = \\ln\\left(\\frac{\\mu_{it}}{1-\\mu_{it}}\\right)$。项 $\\frac{\\mu_{it}}{1-\\mu_{it}}$ 是结果的比值 (odds)。边际均值模型为：\n$$\n\\ln\\left(\\frac{\\mu_{it}}{1-\\mu_{it}}\\right) = \\beta^{\\mathrm{logit}}_{0} + \\beta^{\\mathrm{logit}}_{1} \\cdot \\text{exposure}_{it} + \\beta^{\\mathrm{logit}}_{2} \\cdot \\text{age}_{i}^{*}\n$$\n为了解释 $\\beta^{\\mathrm{logit}}_{1}$，我们在保持其他协变量不变的情况下，考察暴露个体与未暴露个体的比值之比。这就是比值比 (OR)。\n$$\n\\text{OR} = \\frac{\\text{odds}(\\text{exposure}_{it}=1)}{\\text{odds}(\\text{exposure}_{it}=0)} = \\frac{\\exp\\left(\\beta^{\\mathrm{logit}}_{0} + \\beta^{\\mathrm{logit}}_{1}(1) + \\beta^{\\mathrm{logit}}_{2} \\cdot \\text{age}_{i}^{*}\\right)}{\\exp\\left(\\beta^{\\mathrm{logit}}_{0} + \\beta^{\\mathrm{logit}}_{1}(0) + \\beta^{\\mathrm{logit}}_{2} \\cdot \\text{age}_{i}^{*}\\right)} = \\exp(\\beta^{\\mathrm{logit}}_{1})\n$$\n因此，$\\exp(\\beta^{\\mathrm{logit}}_{1})$ 就是比值比。logit 联接模型直接估计比值比的对数。这个效应度量在其他协变量的所有水平上也是恒定的。\n\n**罕见事件的比较**\n\n问题指出感染不常见，意味着边际风险 $\\mu_{it}$ 很小。当 $\\mu_{it} \\to 0$ 时，比值计算中的分母 $1-\\mu_{it}$ 趋近于 1。因此，比值近似于风险：\n$$\n\\text{odds} = \\frac{\\mu_{it}}{1-\\mu_{it}} \\approx \\mu_{it} = \\text{risk}\n$$\n根据这个近似，比值比 (OR) 近似于风险比 (RR)：\n$$\n\\text{OR} = \\frac{\\mu_1/(1-\\mu_1)}{\\mu_0/(1-\\mu_0)} = \\frac{\\mu_1}{\\mu_0} \\cdot \\frac{1-\\mu_0}{1-\\mu_1} = \\text{RR} \\cdot \\frac{1-\\mu_0}{1-\\mu_1} \\approx \\text{RR}\n$$\n因此，对于罕见事件，$\\exp(\\beta^{\\mathrm{logit}}_{1})$（即 OR）是 RR 的一个近似值。相比之下，$\\exp(\\beta^{\\log}_{1})$ 是 RR 的直接估计值，而不是近似值。对数联接提供了对相对风险更直接、更易于解释的度量，这在流行病学中通常是主要关注的量，特别是对于罕见结果。\n\n### 第二部分：边际风险的预测\n\n我们需要为一个 $\\text{exposure}_{it} = 1$ 且 $\\text{age}_{i} = 30$ 岁的家庭计算预测边际风险 $\\hat{\\mu}$。换算后的年龄为 $\\text{age}_{i}^{*} = (30-40)/10 = -1$。协变量向量为 $X_{0} = (1, 1, -1)^{\\top}$。\n\n**对数联接 GEE 的预测**\n\n使用系数 $\\hat{\\beta}^{\\log} = (-4.70, 0.40, 0.03)^{\\top}$ 计算估计的线性预测值 $\\hat{\\eta}^{\\log}$：\n$$\n\\hat{\\eta}^{\\log} = X_{0}^{\\top}\\hat{\\beta}^{\\log} = (1)(-4.70) + (1)(0.40) + (-1)(0.03) = -4.70 + 0.40 - 0.03 = -4.33\n$$\n通过应用反联接函数（即指数函数）可以得到预测风险 $\\hat{\\mu}^{\\log}$：\n$$\n\\hat{\\mu}^{\\log} = \\exp(\\hat{\\eta}^{\\log}) = \\exp(-4.33) \\approx 0.0131682\n$$\n四舍五入到四位有效数字，预测风险为 $0.01317$。\n\n**Logit 联接 GEE 的预测**\n\n使用系数 $\\hat{\\beta}^{\\mathrm{logit}} = (-4.90, 0.70, 0.05)^{\\top}$ 计算估计的线性预测值 $\\hat{\\eta}^{\\mathrm{logit}}$：\n$$\n\\hat{\\eta}^{\\mathrm{logit}} = X_{0}^{\\top}\\hat{\\beta}^{\\mathrm{logit}} = (1)(-4.90) + (1)(0.70) + (-1)(0.05) = -4.90 + 0.70 - 0.05 = -4.25\n$$\n通过应用反 logit（逻辑斯谛）函数可以得到预测风险 $\\hat{\\mu}^{\\mathrm{logit}}$：\n$$\n\\hat{\\mu}^{\\mathrm{logit}} = \\frac{\\exp(\\hat{\\eta}^{\\mathrm{logit}})}{1 + \\exp(\\hat{\\eta}^{\\mathrm{logit}})} = \\frac{\\exp(-4.25)}{1 + \\exp(-4.25)}\n$$\n首先，$\\exp(-4.25) \\approx 0.0142641$。然后，\n$$\n\\hat{\\mu}^{\\mathrm{logit}} = \\frac{0.0142641}{1 + 0.0142641} = \\frac{0.0142641}{1.0142641} \\approx 0.0140635\n$$\n四舍五入到四位有效数字，预测风险为 $0.01406$。\n\n这两个预测值 $0.01317$（来自对数联接模型）和 $0.01406$（来自 logit 联接模型）确实很小，这与问题中关于罕见事件的描述相符。最终答案要求将这两个值放在一个行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.01317   0.01406\n\\end{pmatrix}\n}\n$$", "id": "4913822"}]}