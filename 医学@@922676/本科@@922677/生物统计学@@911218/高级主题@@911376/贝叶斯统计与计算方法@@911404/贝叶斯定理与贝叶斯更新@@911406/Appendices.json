{"hands_on_practices": [{"introduction": "这第一个练习是贝叶斯统计的基石。我们将从第一性原理出发，结合先验知识与新数据来更新我们对总体均值的认知。这个练习将巩固你对正态-正态共轭模型工作原理的理解，并提供一个计算后验分布的具体实例。[@problem_id:4896445]", "problem": "一项临床研究评估了为期四周的干预后收缩压（单位：毫米汞柱，mm Hg）的变化。设独立参与者的血压变化值 $y_i$ 服从模型 $y_i \\sim \\mathcal{N}(\\mu,\\sigma^2)$，其中 $\\mu$ 是未知的总体平均变化值，$\\sigma^2$ 根据先前的校准已知。假设基于早期的试验，关于 $\\mu$ 的先验信念为 $\\mu \\sim \\mathcal{N}(m_0,s_0^2)$。\n\n在本研究中，已知的校准方差为 $\\sigma^2 = 16$，先验参数为 $m_0 = -2$ 和 $s_0^2 = 9$。观测到的 $n=8$ 个变化值为\n$$\n\\{4,\\,-1,\\,3,\\,2,\\,0,\\,1,\\,1,\\,2\\}。\n$$\n\n从贝叶斯定理和正态概率密度函数的标准形式出发，使用第一性原理（即，写出似然函数 $p(y\\mid \\mu)$ 和先验概率 $p(\\mu)$，然后对 $\\mu$ 进行代数配方）来推导后验密度 $p(\\mu\\mid y)$，识别其所属分布族，并将其参数表示为 $m_0$、$s_0^2$、$\\sigma^2$ 和观测数据的函数。然后，使用所提供的数值，计算该数据集中 $\\mu$ 的后验均值。\n\n将最终数值答案（后验均值）以毫米汞柱为单位表示，并四舍五入到四位有效数字。", "solution": "该问题是有效的。它提出了一个贝叶斯生物统计学中的标准、良构问题，涉及一个共轭正态-正态模型，并为求得唯一解提供了所有必要的参数和数据。\n\n该问题要求从第一性原理出发推导总体均值 $\\mu$ 的后验分布，然后进行后验均值的数值计算。\n\n设观测数据为 $y = \\{y_1, y_2, \\dots, y_n\\}$。模型指定数据点 $y_i$ 独立同分布，服从均值为未知 $\\mu$、方差为已知 $\\sigma^2$ 的正态分布。\n$$ y_i \\mid \\mu \\sim \\mathcal{N}(\\mu, \\sigma^2) $$\n关于 $\\mu$ 的先验信念也由一个均值为 $m_0$、方差为 $s_0^2$ 的正态分布建模。\n$$ \\mu \\sim \\mathcal{N}(m_0, s_0^2) $$\n\n根据贝叶斯定理，后验概率密度函数 (PDF) $p(\\mu \\mid y)$ 与似然函数 $p(y \\mid \\mu)$ 和先验概率密度函数 $p(\\mu)$ 的乘积成正比。\n$$ p(\\mu \\mid y) \\propto p(y \\mid \\mu) p(\\mu) $$\n\n首先，我们写出 $\\mu$ 的先验分布的概率密度函数：\n$$ p(\\mu) = \\frac{1}{\\sqrt{2\\pi s_0^2}} \\exp\\left(-\\frac{(\\mu - m_0)^2}{2s_0^2}\\right) $$\n由于观测值 $y_i$ 是独立的，似然函数是各个密度的乘积：\n$$ p(y \\mid \\mu) = \\prod_{i=1}^{n} p(y_i \\mid \\mu) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - \\mu)^2}{2\\sigma^2}\\right) = (2\\pi\\sigma^2)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n}(y_i - \\mu)^2\\right) $$\n现在，我们将先验和似然相乘来求后验概率密度函数。我们可以省略任何不依赖于 $\\mu$ 的常数项。\n$$ p(\\mu \\mid y) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n}(y_i - \\mu)^2\\right) \\exp\\left(-\\frac{(\\mu - m_0)^2}{2s_0^2}\\right) $$\n合并指数部分得到：\n$$ p(\\mu \\mid y) \\propto \\exp\\left[-\\frac{1}{2}\\left(\\frac{\\sum_{i=1}^{n}(y_i - \\mu)^2}{\\sigma^2} + \\frac{(\\mu - m_0)^2}{s_0^2}\\right)\\right] $$\n为识别后验分布，我们展开指数中的项，并将其视为 $\\mu$ 的二次函数。设 $E$ 为括号内的项：\n$$ E = \\frac{1}{\\sigma^2}\\sum_{i=1}^{n}(y_i^2 - 2y_i\\mu + \\mu^2) + \\frac{1}{s_0^2}(\\mu^2 - 2m_0\\mu + m_0^2) $$\n我们合并包含 $\\mu^2$ 和 $\\mu$ 的项：\n$$ E = \\frac{1}{\\sigma^2}(n\\mu^2 - 2\\mu\\sum_{i=1}^{n}y_i + \\sum_{i=1}^{n}y_i^2) + \\frac{1}{s_0^2}(\\mu^2 - 2\\mu m_0 + m_0^2) $$\n$$ E = \\mu^2\\left(\\frac{n}{\\sigma^2} + \\frac{1}{s_0^2}\\right) - 2\\mu\\left(\\frac{\\sum_{i=1}^{n}y_i}{\\sigma^2} + \\frac{m_0}{s_0^2}\\right) + \\left(\\frac{\\sum_{i=1}^{n}y_i^2}{\\sigma^2} + \\frac{m_0^2}{s_0^2}\\right) $$\n设 $\\bar{y} = \\frac{1}{n}\\sum_{i=1}^{n}y_i$ 为样本均值。$E$ 的表达式可以写为：\n$$ E = \\mu^2\\left(\\frac{n}{\\sigma^2} + \\frac{1}{s_0^2}\\right) - 2\\mu\\left(\\frac{n\\bar{y}}{\\sigma^2} + \\frac{m_0}{s_0^2}\\right) + C $$\n其中 $C$ 包含所有不依赖于 $\\mu$ 的项。\n指数的结构是一个关于 $\\mu$ 的二次式，这表明后验分布也是正态分布。设后验分布为 $\\mu \\mid y \\sim \\mathcal{N}(m_n, s_n^2)$。其概率密度函数正比于 $\\exp\\left(-\\frac{(\\mu-m_n)^2}{2s_n^2}\\right)$。展开指数部分：\n$$ -\\frac{(\\mu-m_n)^2}{2s_n^2} = -\\frac{1}{2s_n^2}(\\mu^2 - 2m_n\\mu + m_n^2) = -\\frac{1}{2}\\left(\\frac{1}{s_n^2}\\mu^2 - \\frac{2m_n}{s_n^2}\\mu + \\frac{m_n^2}{s_n^2}\\right) $$\n通过比较我们两个指数表达式中 $\\mu^2$ 和 $\\mu$ 的系数，我们可以确定后验参数 $m_n$ 和 $s_n^2$。\n比较 $\\mu^2$ 的系数：\n$$ \\frac{1}{s_n^2} = \\frac{n}{\\sigma^2} + \\frac{1}{s_0^2} $$\n这给出了后验精度（方差的倒数）。后验方差 $s_n^2$ 为：\n$$ s_n^2 = \\left(\\frac{n}{\\sigma^2} + \\frac{1}{s_0^2}\\right)^{-1} $$\n比较 $\\mu$ 的系数：\n$$ \\frac{m_n}{s_n^2} = \\frac{n\\bar{y}}{\\sigma^2} + \\frac{m_0}{s_0^2} $$\n求解后验均值 $m_n$：\n$$ m_n = s_n^2 \\left(\\frac{n\\bar{y}}{\\sigma^2} + \\frac{m_0}{s_0^2}\\right) = \\frac{\\frac{n\\bar{y}}{\\sigma^2} + \\frac{m_0}{s_0^2}}{\\frac{n}{\\sigma^2} + \\frac{1}{s_0^2}} $$\n因此，后验分布 $p(\\mu \\mid y)$ 是一个正态分布，其均值为 $m_n$，方差为 $s_n^2$，如上所推导。\n\n现在，我们代入所提供的数值来计算后验均值。\n给定的数据如下：\n已知方差：$\\sigma^2 = 16$。\n先验参数：$m_0 = -2$ 和 $s_0^2 = 9$。\n样本量：$n=8$。\n观测到的变化值：$y = \\{4, -1, 3, 2, 0, 1, 1, 2\\}$。\n\n首先，我们计算样本均值 $\\bar{y}$：\n$$ \\sum_{i=1}^{8} y_i = 4 - 1 + 3 + 2 + 0 + 1 + 1 + 2 = 12 $$\n$$ \\bar{y} = \\frac{\\sum_{i=1}^{8} y_i}{n} = \\frac{12}{8} = 1.5 $$\n接下来，我们将这些值代入后验均值 $m_n$ 的公式中：\n$$ m_n = \\frac{\\frac{n\\bar{y}}{\\sigma^2} + \\frac{m_0}{s_0^2}}{\\frac{n}{\\sigma^2} + \\frac{1}{s_0^2}} = \\frac{\\frac{8 \\times 1.5}{16} + \\frac{-2}{9}}{\\frac{8}{16} + \\frac{1}{9}} $$\n我们分别计算分子和分母。\n分母：\n$$ \\frac{8}{16} + \\frac{1}{9} = \\frac{1}{2} + \\frac{1}{9} = \\frac{9}{18} + \\frac{2}{18} = \\frac{11}{18} $$\n分子：\n$$ \\frac{8 \\times 1.5}{16} + \\frac{-2}{9} = \\frac{12}{16} - \\frac{2}{9} = \\frac{3}{4} - \\frac{2}{9} = \\frac{27}{36} - \\frac{8}{36} = \\frac{19}{36} $$\n现在，我们计算比值：\n$$ m_n = \\frac{\\frac{19}{36}}{\\frac{11}{18}} = \\frac{19}{36} \\times \\frac{18}{11} = \\frac{19}{2 \\times 11} = \\frac{19}{22} $$\n最后，我们将此分数转换为小数，并四舍五入到四位有效数字：\n$$ m_n = \\frac{19}{22} \\approx 0.86363636\\dots $$\n四舍五入到四位有效数字，得到 $0.8636$。单位是毫米汞柱 (mm Hg)。\n$\\mu$ 的后验均值为 $0.8636$ mm Hg。", "answer": "$$\\boxed{0.8636}$$", "id": "4896445"}, {"introduction": "我们的先验信念应该在多大程度上影响最终结论？这个练习通过敏感性分析来探讨这一关键问题，它将揭示后验均值是如何成为先验均值和观测数据比例的加权平均。通过调整先验的“强度”，你将对先验信息和数据证据之间的平衡获得更深刻的直觉。[@problem_id:4896446]", "problem": "一个公共卫生团队正在使用一种特异性和灵敏度都完美的血清学检测方法，来估计一个社区中既往感染的患病率 $p$。他们对 $n$ 个个体进行了简单随机抽样检测，观察到 $y$ 个阳性结果。他们为 $p$ 采用贝塔先验分布，其超参数为 $(\\alpha,\\beta)$。其中，先验均值固定为 $m_{0}=\\alpha/(\\alpha+\\beta)$，而先验强度 $s=\\alpha+\\beta$ 则作为敏感性分析的一部分可以变化。数据模型是给定 $p$ 和 $n$ 时 $y$ 的二项分布抽样模型。\n\n在一次具体的调查中，该团队在 $n=240$ 个个体中观察到 $y=36$ 个阳性结果，并将先验均值固定在 $m_{0}=0.1$。使用贝叶斯定理、二项似然和贝塔先验，推导 $p$ 的后验均值作为先验强度 $s$（在 $m_{0}$ 固定的情况下）的函数，并证明后验均值是先验均值 $m_{0}$ 和样本比例 $y/n$ 的加权平均，其权重取决于 $s$ 和 $n$。然后，确定当后验均值等于先验均值 $m_{0}$ 和样本比例 $y/n$ 的简单算术平均值时，$s$ 的值。\n\n对于 $y=36$，$n=240$ 和 $m_{0}=0.1$ 的情况，请提供一个精确的整数作为最终答案。", "solution": "此问题要求我们对一个比例进行贝叶斯分析，并探讨先验强度对后验估计的影响。我们将分步进行推导。\n\n首先，我们确定模型。患病率参数 $p$ 的先验分布是贝塔分布，记作 $p \\sim \\text{Beta}(\\alpha, \\beta)$。其概率密度函数（PDF）的核心部分与 $p^{\\alpha-1} (1-p)^{\\beta-1}$ 成正比。\n数据模型是二项分布抽样。在 $n$ 次试验中观测到 $y$ 次成功，其似然函数 $L(p | y, n)$ 与 $p^y (1-p)^{n-y}$ 成正比。\n\n根据贝叶斯定理，后验分布的PDF与先验和似然的乘积成正比：\n$$ f(p | y, n) \\propto \\left( p^y (1-p)^{n-y} \\right) \\times \\left( p^{\\alpha-1} (1-p)^{\\beta-1} \\right) = p^{y+\\alpha-1} (1-p)^{n-y+\\beta-1} $$\n这个函数形式是另一个贝塔分布的核心。因此，由于共轭性，$p$ 的后验分布是：\n$$ p | y, n \\sim \\text{Beta}(\\alpha', \\beta') $$\n其中后验超参数为 $\\alpha' = \\alpha + y$ 和 $\\beta' = \\beta + n - y$。\n\n一个 $\\text{Beta}(a, b)$ 分布的均值为 $\\frac{a}{a+b}$。因此，$p$ 的后验均值 $m_1$ 为：\n$$ m_1 = E[p | y, n] = \\frac{\\alpha'}{\\alpha'+\\beta'} = \\frac{\\alpha+y}{(\\alpha+y) + (\\beta+n-y)} = \\frac{\\alpha+y}{\\alpha+\\beta+n} $$\n\n接下来，我们将后验均值表示为先验强度 $s = \\alpha+\\beta$ 和先验均值 $m_0 = \\frac{\\alpha}{\\alpha+\\beta}$ 的函数。从这些定义中，我们得到 $\\alpha = m_0 s$。将此代入后验均值的表达式中：\n$$ m_1 = \\frac{m_0 s + y}{s+n} $$\n\n为了证明后验均值是先验均值 $m_0$ 和样本比例 $\\hat{p} = \\frac{y}{n}$ 的加权平均，我们重写上式：\n$$ m_1 = \\frac{s \\cdot m_0 + n \\cdot (y/n)}{s+n} = \\frac{s}{s+n} m_0 + \\frac{n}{s+n} \\hat{p} $$\n这个表达式清晰地表明，后验均值 $m_1$ 是先验均值 $m_0$ 和样本比例 $\\hat{p}$ 的加权平均。权重分别为 $w_{\\text{prior}} = \\frac{s}{s+n}$ 和 $w_{\\text{data}} = \\frac{n}{s+n}$。这些权重之和为1，且分别与先验强度 $s$ 和数据样本量 $n$ 成正比。\n\n最后，我们确定当后验均值 $m_1$ 等于先验均值 $m_0$ 和样本比例 $\\hat{p}$ 的简单算术平均值时，$s$ 的值。简单算术平均值为 $\\frac{m_0 + \\hat{p}}{2}$。我们令两者相等：\n$$ \\left(\\frac{s}{s+n}\\right) m_0 + \\left(\\frac{n}{s+n}\\right) \\hat{p} = \\frac{1}{2} m_0 + \\frac{1}{2} \\hat{p} $$\n为了使这个等式对任意的 $m_0$ 和 $\\hat{p}$（只要它们不相等）都成立，两边 $m_0$ 和 $\\hat{p}$ 的系数必须分别相等。因此，我们得到：\n$$ \\frac{s}{s+n} = \\frac{1}{2} \\quad \\text{和} \\quad \\frac{n}{s+n} = \\frac{1}{2} $$\n两个方程是等价的。解第一个方程：\n$$ 2s = s+n \\implies s = n $$\n这意味着当先验强度 $s$ 等于样本量 $n$ 时，后验均值恰好是先验均值和样本比例的简单算术平均值。\n\n对于本问题中给定的数据 $n=240$，所需的先验强度 $s$ 的值为：\n$$ s = 240 $$\n这是一个精确的整数值。", "answer": "$$ \\boxed{240} $$", "id": "4896446"}, {"introduction": "现实世界的数据往往是不完整的。这个高级练习展示了贝叶斯框架在处理缺失数据方面的强大能力，它将一个简单的“完整案例”分析与一个更复杂的“完全贝叶斯”填补方法进行比较。你将推导利用部分信息所带来的分析优势，然后通过编程实现来量化这一优势，从而突显贝叶斯方法如何带来更高效、更稳健的推断。[@problem_id:4896489]", "problem": "考虑一个生物统计学情境，其中一个连续的生物标志物 $Y$ 的测量存在加性仪器误差。对于每个个体 $i \\in \\{1,\\dots,n\\}$，令 $Y_i$ 表示真实的生物标志物值，$Z_i$ 表示仪器读数。假设存在以下生成模型，其中所有随机变量在个体间相互独立：\n- 未知总体均值的先验分布为 $ \\mu \\sim \\mathcal{N}(\\mu_0, \\tau_0^2) $。\n- 生物标志物值的分布遵循 $ Y_i \\mid \\mu \\sim \\mathcal{N}(\\mu, \\sigma_Y^2) $。\n- 仪器读数的分布遵循 $ Z_i \\mid Y_i \\sim \\mathcal{N}(Y_i, \\sigma_E^2) $。\n\n假设所有个体的 $Z_i$ 都被观测到，而只有一部分个体的 $Y_i$ 被观测到。缺失的生物标志物值是完全随机缺失 (MCAR)，意味着 $Y_i$ 缺失的事件与 $Y_i$ 和 $Z_i$ 均独立。令 $n_{\\text{obs}}$ 表示观测到 $Y_i$ 的个体数量，$n_{\\text{miss}}$ 表示 $Y_i$ 缺失的个体数量，因此有 $n_{\\text{obs}} + n_{\\text{miss}} = n$。\n\n您的任务是通过比较两种分析策略下的后验方差，来量化数据缺失对总体均值 $ \\mu $ 不确定性的影响：\n- 完整病例分析 (Complete-case analysis)：仅使用观测到 $Y_i$ 的个体数据来更新先验，忽略所有 $Z_i$。\n- 全贝叶斯插补 (Full Bayesian imputation)：使用完整模型更新先验，对于 $Y_i$ 缺失的个体，通过对潜变量 $Y_i$ 进行积分，并将其观测到的 $Z_i$ 用作 $Y_i$ 的含噪测量值。\n\n从核心定义和经过验证的事实出发：\n- Bayes 定理： $$ \\pi(\\mu \\mid \\text{data}) \\propto \\pi(\\mu)\\,L(\\text{data}\\mid \\mu), $$\n  其中 $ \\pi $ 表示概率密度函数，$ L $ 表示似然函数。\n- 正态分布的性质，包括以下事实：方差已知的正态似然函数的乘积会产生一个正态的均值参数后验分布；对一个正态潜变量进行积分（边缘化）会得到一个正态的边缘分布。\n- 上述模型中指定的独立性结构。\n\n任务：\n1. 使用 Bayes 定理和模型假设，推导在完整病例分析下 $ \\mu $ 的后验方差（仅使用 $n_{\\text{obs}}$ 个观测到的生物标志物值 $Y_i$，不使用任何个体的 $Z_i$）。\n2. 使用 Bayes 定理和模型假设，推导在全贝叶斯插补下 $ \\mu $ 的后验方差，其中对于 $Y_i$ 缺失的个体，通过分层测量误差模型对缺失的生物标志物进行积分，并使用其观测到的 $Z_i$。\n3. 实现一个程序，对于一组给定的 $(n, n_{\\text{obs}}, \\mu_0, \\tau_0^2, \\sigma_Y^2, \\sigma_E^2)$ 值，计算后验方差的比率，定义为 $$ R = \\frac{\\text{Var}(\\mu \\mid \\text{data})_{\\text{complete-case}}}{\\text{Var}(\\mu \\mid \\text{data})_{\\text{full-Bayes}}}, $$ 其中两个方差都以相同的单位（生物标志物的平方单位）表示。将每个比率 $R$ 作为十进制数输出。\n\n测试集：\n- 情况 $1$：$n = 100$, $n_{\\text{obs}} = 60$, $ \\mu_0 = 0 $, $ \\tau_0^2 = 1.0 $, $ \\sigma_Y^2 = 4.0 $, $ \\sigma_E^2 = 1.0 $。\n- 情况 $2$（无缺失边界情况）：$n = 50$, $n_{\\text{obs}} = 50$, $ \\mu_0 = 0 $, $ \\tau_0^2 = 0.25 $, $ \\sigma_Y^2 = 1.0 $, $ \\sigma_E^2 = 2.0 $。\n- 情况 $3$（理想仪器边界情况）：$n = 80$, $n_{\\text{obs}} = 40$, $ \\mu_0 = 0 $, $ \\tau_0^2 = 1.0 $, $ \\sigma_Y^2 = 2.0 $, $ \\sigma_E^2 = 0.0 $。\n- 情况 $4$（仪器几乎无用）：$n = 100$, $n_{\\text{obs}} = 60$, $ \\mu_0 = 0 $, $ \\tau_0^2 = 1.0 $, $ \\sigma_Y^2 = 4.0 $, $ \\sigma_E^2 = 10000.0 $。\n- 情况 $5$（强先验）：$n = 100$, $n_{\\text{obs}} = 50$, $ \\mu_0 = 0 $, $ \\tau_0^2 = 0.01 $, $ \\sigma_Y^2 = 1.0 $, $ \\sigma_E^2 = 1.0 $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个比率 $R$ 四舍五入到六位小数，并与测试用例的顺序相同（例如，$[R_1,R_2,R_3,R_4,R_5]$）。", "solution": "### 问题验证\n\n#### 步骤 1：提取已知条件\n问题提供了以下数据、变量和模型规格：\n- **分层模型**：\n    - 总体均值的先验分布：$ \\mu \\sim \\mathcal{N}(\\mu_0, \\tau_0^2) $。\n    - 真实的生物标志物值：$ Y_i \\mid \\mu \\sim \\mathcal{N}(\\mu, \\sigma_Y^2) $，对于 $i \\in \\{1,\\dots,n\\}$。\n    - 仪器读数：$ Z_i \\mid Y_i \\sim \\mathcal{N}(Y_i, \\sigma_E^2) $，对于 $i \\in \\{1,\\dots,n\\}$。\n- **独立性**：所有随机变量在个体 $i$ 之间相互独立。\n- **数据结构**：\n    - 个体总数：$n$。\n    - 观测到 $Y_i$ 的个体数量：$n_{\\text{obs}}$。\n    - $Y_i$ 缺失的个体数量：$n_{\\text{miss}}$，其中 $n_{\\text{obs}} + n_{\\text{miss}} = n$。\n    - $Y_i$ 的缺失机制是完全随机缺失 (MCAR)。\n- **分析策略**：\n    - **完整病例分析**：仅使用 $n_{\\text{obs}}$ 个观测到的 $Y_i$ 值。所有 $Z_i$ 值都被忽略。\n    - **全贝叶斯插补**：使用所有可用数据，包括 $n_{\\text{obs}}$ 个观测到的 $Y_i$ 和 $n_{\\text{miss}}$ 个 $Y_i$ 缺失个体的观测值 $Z_i$。\n- **任务**：推导两种策略下 $\\mu$ 的后验方差，并计算它们的比率 $ R = \\frac{\\text{Var}(\\mu \\mid \\text{data})_{\\text{complete-case}}}{\\text{Var}(\\mu \\mid \\text{data})_{\\text{full-Bayes}}} $。\n- **测试用例**：\n    - 情况 $1$：$n = 100$, $n_{\\text{obs}} = 60$, $\\mu_0 = 0$, $\\tau_0^2 = 1.0$, $\\sigma_Y^2 = 4.0$, $\\sigma_E^2 = 1.0$。\n    - 情况 $2$：$n = 50$, $n_{\\text{obs}} = 50$, $\\mu_0 = 0$, $\\tau_0^2 = 0.25$, $\\sigma_Y^2 = 1.0$, $\\sigma_E^2 = 2.0$。\n    - 情况 $3$：$n = 80$, $n_{\\text{obs}} = 40$, $\\mu_0 = 0$, $\\tau_0^2 = 1.0$, $\\sigma_Y^2 = 2.0$, $\\sigma_E^2 = 0.0$。\n    - 情况 $4$：$n = 100$, $n_{\\text{obs}} = 60$, $\\mu_0 = 0$, $\\tau_0^2 = 1.0$, $\\sigma_Y^2 = 4.0$, $\\sigma_E^2 = 10000.0$。\n    - 情况 $5$：$n = 100$, $n_{\\text{obs}} = 50$, $\\mu_0 = 0$, $\\tau_0^2 = 0.01$, $\\sigma_Y^2 = 1.0$, $\\sigma_E^2 = 1.0$。\n\n#### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证：\n- **科学性**：该问题建立在一个标准的分层贝叶斯模型之上，使用了正态分布，这是生物统计学中处理测量误差和缺失数据模型的基石。完整病例分析和贝叶斯插补的概念是成熟的统计方法。所有引用的原则（Bayes 定理，正态分布的性质）都是基础且事实正确的。\n- **适定性**：问题定义清晰。它要求在两种明确指定的情景下推导后验方差及其比率。给定模型，这些方差存在唯一的解析解。测试用例的参数已完全提供。\n- **客观性**：问题以精确、形式化的数学语言陈述。它没有歧义、主观性或基于观点的论断。\n- **完整性和一致性**：问题是自洽的。模型、数据结构和任务都已明确指定。没有缺失的参数或矛盾的约束。MCAR 假设简化了似然函数，并使得分析的分离是有效的。\n- **现实性**：该模型代表了生物统计学中的一个现实场景，其中生物标志物同时受到生物变异和测量误差的影响。参数在合理的范围内。\n- **结构性**：问题结构良好，引导用户在实施前先完成逻辑推导步骤。它不包含循环推理。\n\n#### 步骤 3：结论与行动\n该问题有效。这是一个适定的、科学上合理的贝叶斯生物统计学问题。我将继续进行求解。\n\n### 后验方差的推导\n\n推导依赖于正态-正态共轭模型的性质，即后验精度是先验精度和数据精度的总和。精度是方差的倒数。\n- $\\mu$ 的先验分布：$\\pi(\\mu) = \\mathcal{N}(\\mu_0, \\tau_0^2)$。\n- $\\mu$ 的先验精度：$\\frac{1}{\\tau_0^2}$。\n- 后验分布：$\\pi(\\mu \\mid \\text{data}) \\propto \\pi(\\mu) L(\\text{data} \\mid \\mu)$。\n- $\\mu$ 的后验精度：$\\frac{1}{\\text{Var}(\\mu \\mid \\text{data})} = \\frac{1}{\\tau_0^2} + \\text{_数据精度_}$。\n\n**1. 完整病例分析下的后验方差**\n\n在完整病例分析中，数据仅包含 $n_{\\text{obs}}$ 个观测到的生物标志物值，我们将其表示为 $\\mathbf{Y}_{\\text{obs}} = (Y_1, \\dots, Y_{n_{\\text{obs}}})$。\n- 这些数据点的模型是 $Y_i \\mid \\mu \\sim \\mathcal{N}(\\mu, \\sigma_Y^2)$。\n- 似然函数为 $L(\\mathbf{Y}_{\\text{obs}} \\mid \\mu) = \\prod_{i=1}^{n_{\\text{obs}}} \\mathcal{N}(Y_i \\mid \\mu, \\sigma_Y^2)$。\n- 这 $n_{\\text{obs}}$ 个观测值提供的关于 $\\mu$ 的信息等价于它们的样本均值 $\\bar{Y}_{\\text{obs}}$ 所提供的信息，其分布为 $\\bar{Y}_{\\text{obs}} \\mid \\mu \\sim \\mathcal{N}(\\mu, \\sigma_Y^2 / n_{\\text{obs}})$。\n- 数据贡献的精度是 $\\mu$ 的样本均值估计量方差的倒数，即 $\\frac{n_{\\text{obs}}}{\\sigma_Y^2}$。\n- $\\mu$ 的后验精度是先验精度与数据精度的和：\n$$\n\\frac{1}{\\text{Var}(\\mu \\mid \\mathbf{Y}_{\\text{obs}})_{\\text{cc}}} = \\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2}\n$$\n- 因此，完整病例分析的后验方差为：\n$$\n\\text{Var}(\\mu \\mid \\text{data})_{\\text{complete-case}} = \\left( \\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2} \\right)^{-1}\n$$\n\n**2. 全贝叶斯插补下的后验方差**\n\n在全贝叶斯分析中，我们使用所有可用数据：$n_{\\text{obs}}$ 个 $Y_i$ 值（表示为 $\\mathbf{Y}_{\\text{obs}}$）和 $n_{\\text{miss}}$ 个 $Y_i$ 缺失个体的 $Z_i$ 值（表示为 $\\mathbf{Z}_{\\text{miss}}$）。由于个体之间的独立性，总似然是各组似然的乘积。\n- 来自 $\\mathbf{Y}_{\\text{obs}}$ 对后验精度的贡献与完整病例分析中相同，为 $\\frac{n_{\\text{obs}}}{\\sigma_Y^2}$。\n- 对于 $n_{\\text{miss}}$ 个个体，我们观测到 $Z_j$ 但没有观测到 $Y_j$。我们需要通过对潜变量 $Y_j$ 进行积分，来求出给定 $\\mu$ 时 $Z_j$ 的边缘分布：\n$$\np(Z_j \\mid \\mu) = \\int p(Z_j \\mid Y_j, \\mu) \\, p(Y_j \\mid \\mu) \\, dY_j\n$$\n- 根据模型，$p(Z_j \\mid Y_j, \\mu) = p(Z_j \\mid Y_j) \\sim \\mathcal{N}(Y_j, \\sigma_E^2)$ 且 $p(Y_j \\mid \\mu) \\sim \\mathcal{N}(\\mu, \\sigma_Y^2)$。\n- 这个积分代表两个正态密度的卷积。结果是另一个正态密度。令 $Y_j = \\mu + \\delta_j$，其中 $\\delta_j \\sim \\mathcal{N}(0, \\sigma_Y^2)$，且 $Z_j = Y_j + \\epsilon_j$，其中 $\\epsilon_j \\sim \\mathcal{N}(0, \\sigma_E^2)$。\n- 那么 $Z_j = \\mu + \\delta_j + \\epsilon_j$。给定 $\\mu$ 时 $Z_j$ 的分布是正态的，其参数为：\n    - 均值：$E[Z_j \\mid \\mu] = E[\\mu + \\delta_j + \\epsilon_j] = \\mu + 0 + 0 = \\mu$。\n    - 方差：$\\text{Var}(Z_j \\mid \\mu) = \\text{Var}(\\mu + \\delta_j + \\epsilon_j) = \\text{Var}(\\delta_j) + \\text{Var}(\\epsilon_j) = \\sigma_Y^2 + \\sigma_E^2$。\n- 因此，来自缺失数据组的一个观测值 $Z_j$ 的边缘分布为 $Z_j \\mid \\mu \\sim \\mathcal{N}(\\mu, \\sigma_Y^2 + \\sigma_E^2)$。\n- 这 $n_{\\text{miss}}$ 个 $Z_j$ 观测值贡献的精度为 $\\frac{n_{\\text{miss}}}{\\sigma_Y^2 + \\sigma_E^2}$。\n- 总后验精度是先验精度与两个数据源精度的总和：\n$$\n\\frac{1}{\\text{Var}(\\mu \\mid \\mathbf{Y}_{\\text{obs}}, \\mathbf{Z}_{\\text{miss}})_{\\text{full}}} = \\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2} + \\frac{n_{\\text{miss}}}{\\sigma_Y^2 + \\sigma_E^2}\n$$\n- 因此，全贝叶斯分析的后验方差为：\n$$\n\\text{Var}(\\mu \\mid \\text{data})_{\\text{full-Bayes}} = \\left( \\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2} + \\frac{n_{\\text{miss}}}{\\sigma_Y^2 + \\sigma_E^2} \\right)^{-1}\n$$\n\n**3. 后验方差的比率**\n\n比率 $R$ 定义为 $R = \\frac{\\text{Var}(\\mu \\mid \\text{data})_{\\text{complete-case}}}{\\text{Var}(\\mu \\mid \\text{data})_{\\text{full-Bayes}}}$。\n代入方差的表达式（即精度的倒数）：\n$$\nR = \\frac{\\left( \\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2} \\right)^{-1}}{\\left( \\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2} + \\frac{n_{\\text{miss}}}{\\sigma_Y^2 + \\sigma_E^2} \\right)^{-1}}\n$$\n这可以简化为后验精度的比率：\n$$\nR = \\frac{\\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2} + \\frac{n_{\\text{miss}}}{\\sigma_Y^2 + \\sigma_E^2}}{\\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2}}\n$$\n这可以写作：\n$$\nR = 1 + \\frac{\\frac{n_{\\text{miss}}}{\\sigma_Y^2 + \\sigma_E^2}}{\\frac{1}{\\tau_0^2} + \\frac{n_{\\text{obs}}}{\\sigma_Y^2}}\n$$\n这个表达式表明 $R \\ge 1$，这是符合预期的，因为全贝叶斯方法比完整病例分析使用了更多信息，从而导致后验方差更小或相等。该比率量化了通过对 $Y_i$ 缺失的受试者使用含噪测量值 $Z_i$ 所获得的精度增益。这个公式将用于计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of posterior variances for mu under two analysis strategies:\n    1. Complete-case analysis.\n    2. Full Bayesian imputation.\n    \"\"\"\n    \n    # Test cases: (n, n_obs, mu_0, tau_0_sq, sigma_Y_sq, sigma_E_sq)\n    # Note: mu_0 is not needed for the variance calculation.\n    test_cases = [\n        # Case 1\n        (100, 60, 0, 1.0, 4.0, 1.0),\n        # Case 2 (no missingness boundary)\n        (50, 50, 0, 0.25, 1.0, 2.0),\n        # Case 3 (perfect instrument boundary)\n        (80, 40, 0, 1.0, 2.0, 0.0),\n        # Case 4 (nearly useless instrument)\n        (100, 60, 0, 1.0, 4.0, 10000.0),\n        # Case 5 (strong prior)\n        (100, 50, 0, 0.01, 1.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        n, n_obs, _, tau_0_sq, sigma_Y_sq, sigma_E_sq = case\n        n_miss = n - n_obs\n\n        # The posterior precision is the sum of prior precision and data precision.\n        # Var = 1 / Precision.\n        # The ratio of variances is equivalent to the ratio of precisions.\n        # R = Var_cc / Var_full = Prec_full / Prec_cc.\n\n        # Precision for complete-case analysis\n        prec_cc = (1 / tau_0_sq) + (n_obs / sigma_Y_sq)\n        \n        # Precision from the subjects with missing Y, but observed Z\n        # Each Z_i | mu ~ N(mu, sigma_Y^2 + sigma_E^2)\n        # So n_miss observations of Z contribute n_miss / (sigma_Y^2 + sigma_E^2) to precision\n        if n_miss > 0:\n            prec_from_miss = n_miss / (sigma_Y_sq + sigma_E_sq)\n        else:\n            prec_from_miss = 0.0\n\n        # Precision for full Bayesian imputation analysis\n        prec_full = prec_cc + prec_from_miss\n        \n        # Ratio of posterior variances\n        if prec_cc == 0:\n            # This case (e.g., infinite prior variance and no observed data)\n            # is not in the test suite and would lead to R being undefined or 1.\n            # Here we assume prec_cc > 0.\n            ratio = 1.0 if prec_full == prec_cc else prec_full / prec_cc\n        else:\n            ratio = prec_full / prec_cc\n        \n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4896489"}]}