{"hands_on_practices": [{"introduction": "逻辑回归模型的核心输出是“对数优势”（log-odds），这是一个相对抽象的数值。此练习将引导您完成一个基础但至关重要的转换过程：将对数优势转化为具体的、有临床意义的概率。通过这个实践，您将掌握如何将模型的原始输出解读为对特定个体事件发生风险的预测 [@problem_id:4970702]。", "problem": "一个临床研究团队正在为因急性失代偿性心力衰竭而入住重症监护室（ICU）的患者开发一个$30$天死亡率的预后模型。令 $Y \\in \\{0,1\\}$ 表示二元结局，其中 $Y=1$ 表示$30$天内死亡，$Y=0$ 表示存活。假设 $Y \\mid \\boldsymbol{X}$ 服从参数为 $p(\\boldsymbol{X})$ 的伯努利分布，并且该模型是具有标准logit链接的广义线性模型。对于具有协变量 $\\boldsymbol{X}$ 的特定患者，拟合的线性预测子（也称为对数几率）为 $\\eta=-1.386$。\n\n仅从伯努利模型和广义线性模型中标准logit链接的定义出发，推导从线性预测子 $\\eta$ 到概率 $p(\\boldsymbol{X})$ 的映射关系，并计算该患者的 $p$ 值。简要说明所获得的 $p$ 值对于$30$天死亡风险的临床意义。\n\n提供 $p$ 的值，以小数形式表示并四舍五入到三位有效数字。不要使用百分号。", "solution": "对问题陈述的有效性进行评估。\n\n**第一步：提取已知条件**\n-   结局变量：$Y \\in \\{0,1\\}$，其中 $Y=1$ 表示$30$天内死亡，$Y=0$ 表示存活。\n-   结局的条件分布：$Y \\mid \\boldsymbol{X} \\sim \\text{Bernoulli}(p(\\boldsymbol{X}))$。\n-   模型框架：广义线性模型（GLM）。\n-   链接函数：标准logit链接。\n-   特定患者的拟合线性预测子：$\\eta = -1.386$。\n-   任务：\n    1.  推导从线性预测子 $\\eta$ 到概率 $p(\\boldsymbol{X})$ 的映射关系。\n    2.  计算给定患者的 $p$ 值。\n    3.  简要说明所计算概率的临床意义。\n    4.  提供四舍五入到三位有效数字的 $p$ 值。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在科学上基于广义线性模型理论，这是统计建模中一个标准且基础的课题。在此框架内，对二元结局使用伯努利分布和logit链接函数是标准选择。该问题是适定的，提供了执行所要求的推导和计算所需的所有必要信息，从而能够得到唯一解。所用术语精确且客观。提供的线性预测子值 $\\eta = -1.386$ 是一个合理的真实世界值。不存在矛盾、歧义或违反科学原则的情况。\n\n**第三步：结论与行动**\n问题有效。将提供完整解答。\n\n***\n\n该问题要求在针对伯努利分布结局的广义线性模型（GLM）框架内，推导线性预测子 $\\eta$ 与事件概率 $p$ 之间的关系。\n\n一个广义线性模型包含三个组成部分：\n1.  随机部分：响应变量 $Y$ 的分布是指数族的一员。\n2.  系统部分：一个线性预测子，$\\eta = \\boldsymbol{X}^T\\boldsymbol{\\beta}$。\n3.  链接函数：一个函数 $g$，它将随机部分的期望值 $\\mu = E[Y]$ 与系统部分关联起来，使得 $g(\\mu) = \\eta$。\n\n对于二元结局 $Y \\in \\{0,1\\}$，其条件分布是参数为 $p = P(Y=1 \\mid \\boldsymbol{X})$ 的伯努利分布。其概率质量函数为 $f(y;p) = p^y(1-p)^{1-y}$。为了确定标准链接函数，我们必须将其表示为指数族的标准形式：\n$$f(y; \\theta) = \\exp \\left( \\frac{y\\theta - b(\\theta)}{a(\\phi)} + c(y, \\phi) \\right)$$\n重写伯努利概率质量函数：\n$$f(y;p) = p^y(1-p)^{1-y} = \\exp\\left( \\ln\\left(p^y(1-p)^{1-y}\\right) \\right)$$\n$$= \\exp\\left( y\\ln(p) + (1-y)\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln(p) + \\ln(1-p) - y\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\left[\\ln(p) - \\ln(1-p)\\right] + \\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln\\left(\\frac{p}{1-p}\\right) + \\ln(1-p) \\right)$$\n将此与标准形式进行比较，我们可以确定标准参数为 $\\theta = \\ln\\left(\\frac{p}{1-p}\\right)$。数量 $\\frac{p}{1-p}$ 是事件 $Y=1$ 发生的几率，其自然对数即为对数几率。伯努利变量的期望值为 $\\mu = E[Y] = p$。\n\n标准链接函数是将均值 $\\mu$ 映射到标准参数 $\\theta$ 的函数。对于伯努利分布，该函数为：\n$$g(p) = \\theta = \\ln\\left(\\frac{p}{1-p}\\right)$$\n这个函数 $g(p)$ 被称为logit函数。\n\n在广义线性模型中，链接函数将结局的均值与线性预测子 $\\eta$ 联系起来。使用标准logit链接，我们有：\n$$\\eta = g(p) = \\ln\\left(\\frac{p}{1-p}\\right)$$\n第一个任务是推导从 $\\eta$ 到 $p$ 的映射关系。这需要对logit函数求逆。我们对上述方程求解 $p$：\n$$\\exp(\\eta) = \\frac{p}{1-p}$$\n$$\\exp(\\eta)(1-p) = p$$\n$$\\exp(\\eta) - p\\exp(\\eta) = p$$\n$$\\exp(\\eta) = p + p\\exp(\\eta)$$\n$$\\exp(\\eta) = p(1 + \\exp(\\eta))$$\n$$p = \\frac{\\exp(\\eta)}{1 + \\exp(\\eta)}$$\n该表达式提供了从线性预测子 $\\eta$ 到概率 $p$ 的映射。这个函数通常被称为logistic S型函数（或sigmoid函数）。通过将分子和分母同除以 $\\exp(\\eta)$，可以得到一个等价且通常在数值上更稳定的形式：\n$$p = \\frac{1}{\\exp(-\\eta) + 1}$$\n推导至此完成。\n\n第二个任务是计算线性预测子为 $\\eta = -1.386$ 的患者的 $p$ 值。使用推导出的公式：\n$$p = \\frac{1}{1 + \\exp(-\\eta)} = \\frac{1}{1 + \\exp(-(-1.386))}$$\n$$p = \\frac{1}{1 + \\exp(1.386)}$$\n我们计算 $\\exp(1.386)$ 的值：\n$$\\exp(1.386) \\approx 3.998854$$\n将此值代回 $p$ 的表达式中：\n$$p \\approx \\frac{1}{1 + 3.998854} = \\frac{1}{4.998854} \\approx 0.20004585$$\n问题要求答案四舍五入到三位有效数字。第一位有效数字是 $2$，第二位是 $0$，第三位是 $0$。第四位数字是 $0$，所以我们向下舍入。\n$$p \\approx 0.200$$\n\n最后一个任务是陈述该值的临床意义。概率 $p$ 代表了对于给定协变量集合 $\\boldsymbol{X}$ 的患者，模型预测其发生事件 $Y=1$（30天内死亡）的可能性。因此，$p=0.200$ 的值意味着，对于这位特定患者，该预后模型估计其在入住ICU后30天内死亡的概率为 $20.0\\%$。这是该患者的个体预测风险。", "answer": "$$\n\\boxed{0.200}\n$$", "id": "4970702"}, {"introduction": "在能够为单个案例预测概率之后，下一步是理解模型中每个预测变量的影响力。优势比（Odds Ratio）是量化这种影响的标准方法，它解释了当一个变量改变时，事件发生的“优势”会如何相应地变化。本练习将向您展示如何从回归系数 $\\beta_j$ 推导出其对应的优势比，并解释其在实际临床情境中的含义 [@problem_id:4970670]。", "problem": "一项针对成年手术患者的前瞻性队列研究对二元结局 $Y \\in \\{0,1\\}$ 进行建模，其中 $Y=1$ 表示在 $30$ 天内发生严重术后感染。设 $\\mathbf{x} = (x_1,\\dots,x_p)$ 表示患者协变量，包括高敏C反应蛋白 (hs-CRP)。hs-CRP 协变量被编码为 $x_j$，其定义为 $x_j$ 每增加一个单位，对应于 hs-CRP 增加 $10$ mg/L。研究人员拟合了一个使用 logit 链接函数的逻辑斯蒂回归模型，其中给定协变量下的感染概率为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$，感染比值为 $p(\\mathbf{x})/(1 - p(\\mathbf{x}))$，对数比值 (logit) 为 $\\ln\\!\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)$。假设 $x_j$ 的估计回归系数为 $\\beta_j = 0.693$。\n\n从比值和 logit 链接函数的定义出发，并将所有其他协变量视为固定不变，推导与 $x_j$ 每增加一个单位相关的严重术后感染比值的乘法变化。然后，计算给定 $\\beta_j$ 下的这个乘法变化。将您的最终数值答案四舍五入到四位有效数字，并且不包括单位。此外，请说明 $x_j$ 每增加一个单位，比值比为 $2$ 的临床解释（此解释不作为最终数值答案的一部分）。", "solution": "该问题是有效的，因为它在科学上基于生物统计学原理，特别是逻辑斯蒂回归，并且问题陈述清晰，为得出唯一解提供了所有必要信息。\n\n该问题要求在逻辑斯蒂回归模型中，推导协变量每增加一个单位时事件比值的乘法变化，计算给定系数下的该值，并提供临床解释。\n\n设二元结局为 $Y \\in \\{0, 1\\}$，其中 $Y=1$ 表示目标事件（严重术后感染）。在给定协变量向量 $\\mathbf{x} = (x_1, \\dots, x_p)$ 的条件下，此事件的概率表示为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$。\n\n逻辑斯蒂回归模型使用 logit 链接函数，该函数将事件比值的自然对数建模为协变量的线性函数。比值定义为事件发生的概率与不发生的概率之比：\n$$\n\\text{Odds}(\\mathbf{x}) = \\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\n$$\n因此，对数比值（或 logit）为：\n$$\n\\text{logit}(p(\\mathbf{x})) = \\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)\n$$\n在逻辑斯蒂回归模型中，logit 表示为：\n$$\n\\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p = \\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\n$$\n其中 $\\beta_0, \\beta_1, \\dots, \\beta_p$ 是回归系数。\n\n为了推导与特定协变量 $x_j$ 每增加一个单位相关的比值的乘法变化，我们必须比较 $x_j$ 在两个不同水平下的比值，同时保持所有其他协变量 $(k \\neq j \\text{ 时的 } x_k)$ 不变。\n\n设具有协变量 $\\mathbf{x}$ 的患者的比值为 $\\text{Odds}(\\mathbf{x})$。通过对 logit 方程取指数，我们得到：\n$$\n\\text{Odds}(\\mathbf{x}) = \\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)\n$$\n现在，考虑第二种情况，其中协变量 $x_j$ 增加一个单位至 $x_j + 1$。新的协变量向量为 $\\mathbf{x}' = (x_1, \\dots, x_j+1, \\dots, x_p)$。此情况下的比值为：\n$$\n\\text{Odds}(\\mathbf{x}') = \\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)\n$$\n比值的乘法变化是新比值与原始比值的比率。该比率定义为 $x_j$ 每变化一个单位的比值比 (OR)。\n$$\n\\text{OR}_j = \\frac{\\text{Odds}(\\mathbf{x}')}{\\text{Odds}(\\mathbf{x})} = \\frac{\\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n我们可以重写分子中的指数部分：\n$$\n\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j x_j + \\beta_j = \\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\n$$\n将此代回比值比的表达式中：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n使用性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们得到：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) \\exp(\\beta_j)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n项 $\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)$ 在分子和分母中被约去，从而得出基本结果：\n$$\n\\text{OR}_j = \\exp(\\beta_j)\n$$\n此推导表明，$x_j$ 每增加一个单位，比值的乘法变化等于系数 $\\beta_j$ 的指数。\n\n问题陈述，协变量 $x_j$（代表 hs-CRP）的估计系数为 $\\beta_j = 0.693$。我们现在可以计算比值的乘法变化：\n$$\n\\text{OR}_j = \\exp(0.693)\n$$\n我们计算此值并按要求四舍五入到四位有效数字：\n$$\n\\exp(0.693) \\approx 1.99970535 \\approx 2.000\n$$\n比值的乘法变化为 $2.000$。\n\n该问题还要求对 $x_j$ 每增加一个单位，比值比为 $2$ 进行临床解释。协变量 $x_j$ 的编码方式是，其每增加一个单位对应于 hs-CRP 增加 $10$ mg/L。因此，$x_j$ 的比值比为 $2$ 意味着，假设模型中所有其他患者特征保持不变，患者的 hs-CRP 水平每增加 $10$ mg/L，其在 $30$ 天内发生严重术后感染的比值估计会乘以 $2$（即，增加一倍）。", "answer": "$$\\boxed{2.000}$$", "id": "4970670"}, {"introduction": "到目前为止，我们都是在给定模型系数的情况下进行解释和预测。但这些系数本身是如何计算出来的呢？这个最终的实践将揭开模型拟合过程的“黑匣子”。您将通过手动执行一次“迭代重加权最小二乘法”（IRLS）的核心步骤，体验逻辑回归模型参数估计的底层机制，这有助于深刻理解为何它被称为一种广义线性模型 [@problem_id:4970685]。", "problem": "考虑一个用于短期围手术期研究的二元结果模型，其中每位患者 $i \\in \\{1,2,3\\}$ 贡献一次伯努利试验 $y_{i} \\in \\{0,1\\}$，表示是否发生急性术后并发症。设协变量向量为 $x_{i} \\in \\mathbb{R}^{2}$，包含一个截距项和一个标准化的手术复杂度评分，并将参数向量表示为 $\\beta \\in \\mathbb{R}^{2}$。该广义线性模型使用 logistic 链接函数，因此条件均值 $p_{i} = \\mathbb{E}(y_{i} \\mid x_{i}, \\beta)$ 满足 $\\operatorname{logit}(p_{i}) = x_{i}^{\\top} \\beta$。数据由设计矩阵 $X = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix}$ 和结果向量 $y = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 给出。从初始参数 $\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，执行一次迭代重加权最小二乘法 (Iteratively Reweighted Least Squares, IRLS)（首先从带有 logistic 链接的伯努利对数似然中定义得分和观测信息，然后从这些第一性原理推导出 IRLS 的各个量），并计算初始迭代中的以下对象：模型预测概率向量 $p^{(0)}$、对角权重矩阵 $W^{(0)}$、工作响应 $z^{(0)}$ 以及更新后的参数向量 $\\beta^{(1)}$。将所有计算量精确表示为有理数或整数；无需四舍五入。以包含所有四个结果的单个复合表达式 $\\left(p^{(0)}, W^{(0)}, z^{(0)}, \\beta^{(1)}\\right)$ 的形式提供您的最终答案。", "solution": "用户希望找到逻辑斯谛回归模型在经过一次迭代重加权最小二乘 (IRLS) 算法迭代后，预测的概率 $p^{(0)}$、权重矩阵 $W^{(0)}$、工作响应 $z^{(0)}$ 和更新后的参数向量 $\\beta^{(1)}$。\n\n### 第 1 步：问题验证\n\n该问题是广义线性模型 (GLM) 计算统计学中的一个标准、定义明确的练习。\n\n*   **提取的已知条件**：\n    *   模型：用于二元结果 $y_i \\in \\{0, 1\\}$ 的逻辑斯谛回归。\n    *   观测数量：$N=3$。\n    *   链接函数：$\\operatorname{logit}(p_i) = \\ln\\left(\\frac{p_i}{1-p_i}\\right) = x_i^\\top \\beta$。\n    *   设计矩阵：$X = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix}$。\n    *   结果向量：$y = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n    *   初始参数向量：$\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n    *   任务：从 $\\beta^{(0)}$ 开始执行一次 IRLS 迭代，并计算 $p^{(0)}$、$W^{(0)}$、$z^{(0)}$ 和 $\\beta^{(1)}$。\n\n*   **验证结论**：\n    *   该问题在 GLM 理论中具有**科学依据**。\n    *   它是**适定的**，为 IRLS 算法的单次、唯一迭代提供了所有必要信息。\n    *   语言是**客观的**且数学上是精确的。\n    *   该问题是**有效的**。\n\n### 第 2 步：从第一性原理推导 IRLS 算法\n\nGLM 的 IRLS 算法可以作为一种最大化对数似然的牛顿-拉弗森法来推导。对于二元结果 $y_i \\sim \\text{Bernoulli}(p_i)$，单个观测 $i$ 的对数似然为：\n$$\n\\ell_i(\\beta) = y_i \\ln(p_i) + (1-y_i) \\ln(1-p_i)\n$$\n总对数似然为 $\\ell(\\beta) = \\sum_{i=1}^{N} \\ell_i(\\beta)$。链接函数将概率 $p_i$ 与线性预测器 $\\eta_i = x_i^\\top \\beta$ 关联起来：\n$$\n\\eta_i = \\ln\\left(\\frac{p_i}{1-p_i}\\right) \\implies p_i = \\frac{\\exp(\\eta_i)}{1+\\exp(\\eta_i)} = \\frac{1}{1+\\exp(-\\eta_i)}\n$$\n这是 logistic sigmoid 函数 $\\sigma(\\eta_i)$。其导数为 $\\frac{d p_i}{d \\eta_i} = p_i(1-p_i)$。\n\n**1. 得分函数 (对数似然的梯度)**\n我们求 $\\ell(\\beta)$ 关于参数向量 $\\beta$ 的梯度。对单个观测的贡献使用链式法则：\n$$\n\\frac{\\partial \\ell_i}{\\partial \\beta_j} = \\frac{\\partial \\ell_i}{\\partial p_i} \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta_j}\n$$\n各个分量为：\n$$\n\\frac{\\partial \\ell_i}{\\partial p_i} = \\frac{y_i}{p_i} - \\frac{1-y_i}{1-p_i} = \\frac{y_i - p_i}{p_i(1-p_i)}\n$$\n$$\n\\frac{\\partial p_i}{\\partial \\eta_i} = p_i(1-p_i)\n$$\n$$\n\\frac{\\partial \\eta_i}{\\partial \\beta_j} = \\frac{\\partial (x_i^\\top \\beta)}{\\partial \\beta_j} = x_{ij}\n$$\n将这些组合起来得到：\n$$\n\\frac{\\partial \\ell_i}{\\partial \\beta_j} = \\frac{y_i - p_i}{p_i(1-p_i)} \\cdot p_i(1-p_i) \\cdot x_{ij} = (y_i - p_i) x_{ij}\n$$\n完整数据集的得分向量是所有观测的总和，可以写成矩阵形式：\n$$\nS(\\beta) = \\nabla_\\beta \\ell(\\beta) = \\sum_{i=1}^{N} (y_i - p_i) x_i = X^\\top (y - p)\n$$\n\n**2. 观测信息矩阵 (负海森矩阵)**\n接下来，我们计算海森矩阵 $\\mathcal{H}(\\beta) = \\frac{\\partial^2 \\ell(\\beta)}{\\partial \\beta \\partial \\beta^\\top}$。元素 $(\\mathcal{H})_{jk}$ 是：\n$$\n\\frac{\\partial^2 \\ell}{\\partial \\beta_k \\partial \\beta_j} = \\sum_{i=1}^{N} \\frac{\\partial}{\\partial \\beta_k} \\left[ (y_i - p_i) x_{ij} \\right] = \\sum_{i=1}^{N} - \\frac{\\partial p_i}{\\partial \\beta_k} x_{ij}\n$$\n再次使用链式法则，$\\frac{\\partial p_i}{\\partial \\beta_k} = \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta_k} = p_i(1-p_i) x_{ik}$。将其代入：\n$$\n\\frac{\\partial^2 \\ell}{\\partial \\beta_k \\partial \\beta_j} = \\sum_{i=1}^{N} -p_i(1-p_i) x_{ik} x_{ij}\n$$\n以矩阵形式，海森矩阵为 $\\mathcal{H}(\\beta) = -X^\\top W X$，其中 $W$ 是一个对角矩阵，其对角元素为 $W_{ii} = p_i(1-p_i)$。观测信息矩阵是 $J(\\beta) = -\\mathcal{H}(\\beta) = X^\\top W X$。\n\n**3. IRLS 更新步骤**\n用于找到 $\\ell(\\beta)$ 最大值的牛顿-拉弗森更新为：\n$$\n\\beta^{(t+1)} = \\beta^{(t)} - [\\mathcal{H}(\\beta^{(t)})]^{-1} S(\\beta^{(t)})\n$$\n代入我们得到的得分 $S$ 和海森矩阵 $\\mathcal{H}$ 的表达式：\n$$\n\\beta^{(t+1)} = \\beta^{(t)} - [-X^\\top W^{(t)} X]^{-1} [X^\\top (y - p^{(t)})] = \\beta^{(t)} + (X^\\top W^{(t)} X)^{-1} X^\\top (y - p^{(t)})\n$$\n为了将其看作一个加权最小二乘问题，我们重排各项：\n$$\n(X^\\top W^{(t)} X) \\beta^{(t+1)} = (X^\\top W^{(t)} X) \\beta^{(t)} + X^\\top (y - p^{(t)})\n$$\n让我们定义一个“工作响应”向量 $z^{(t)}$，使得更新是加权正规方程 $\\beta^{(t+1)} = (X^\\top W^{(t)} X)^{-1} X^\\top W^{(t)} z^{(t)}$ 的解。这意味着 $X^\\top W^{(t)} z^{(t)} = (X^\\top W^{(t)} X) \\beta^{(t)} + X^\\top (y - p^{(t)})$。我们可以解出 $z^{(t)}$：\n$$\nW^{(t)} z^{(t)} = W^{(t)} X \\beta^{(t)} + (y - p^{(t)}) \\implies z^{(t)} = X \\beta^{(t)} + (W^{(t)})^{-1} (y - p^{(t)})\n$$\n回顾 $\\eta^{(t)} = X \\beta^{(t)}$，工作响应为：\n$$\nz^{(t)} = \\eta^{(t)} + (W^{(t)})^{-1} (y - p^{(t)})\n$$\n\n### 第 3 步：第一次迭代的计算\n\n给定初始参数向量 $\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n**1. 计算概率 $p^{(0)}$**\n首先，计算线性预测器 $\\eta^{(0)} = X \\beta^{(0)}$：\n$$\n\\eta^{(0)} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n现在，使用反链接函数 $p_i = \\sigma(\\eta_i)$ 计算概率 $p_i^{(0)}$：\n$$\np_i^{(0)} = \\frac{1}{1+\\exp(-\\eta_i^{(0)})} = \\frac{1}{1+\\exp(0)} = \\frac{1}{1+1} = \\frac{1}{2} \\quad \\text{for } i=1,2,3\n$$\n因此，概率向量为：\n$$\np^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}\n$$\n\n**2. 计算权重矩阵 $W^{(0)}$**\n对角权重为 $W_{ii}^{(0)} = p_i^{(0)}(1 - p_i^{(0)})$：\n$$\nW_{ii}^{(0)} = \\frac{1}{2} \\left(1 - \\frac{1}{2}\\right) = \\frac{1}{4} \\quad \\text{for } i=1,2,3\n$$\n权重矩阵为：\n$$\nW^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix}\n$$\n\n**3. 计算工作响应 $z^{(0)}$**\n工作响应为 $z^{(0)} = \\eta^{(0)} + (W^{(0)})^{-1} (y - p^{(0)})$：\n$$\ny - p^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}\n$$\n权重矩阵的逆为 $(W^{(0)})^{-1} = \\text{diag}(4, 4, 4)$。\n$$\nz^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 4  0  0 \\\\ 0  4  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix}\n$$\n\n**4. 计算更新后的参数 $\\beta^{(1)}$**\n更新公式为 $\\beta^{(1)} = (X^\\top W^{(0)} X)^{-1} X^\\top W^{(0)} z^{(0)}$。\n首先，计算 $X^\\top W^{(0)} X$：\n$$\nX^\\top W^{(0)} X = \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3  3 \\\\ 3  5 \\end{pmatrix}\n$$\n接下来，求该矩阵的逆：\n$$\n(X^\\top W^{(0)} X)^{-1} = \\left(\\frac{1}{4} \\begin{pmatrix} 3  3 \\\\ 3  5 \\end{pmatrix}\\right)^{-1} = 4 \\cdot \\frac{1}{3(5)-3(3)} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix} = \\frac{4}{6} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix}\n$$\n现在，计算 $X^\\top W^{(0)} z^{(0)}$：\n$$\nX^\\top W^{(0)} z^{(0)} = \\frac{1}{4} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} -2+2+2 \\\\ 0+2+4 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n最后，计算 $\\beta^{(1)}$：\n$$\n\\beta^{(1)} = \\left(\\frac{2}{3} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix}\\right) \\begin{pmatrix} 1/2 \\\\ 3/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5(1/2) - 3(3/2) \\\\ -3(1/2) + 3(3/2) \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5/2 - 9/2 \\\\ -3/2 + 9/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} -4/2 \\\\ 6/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} -2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}\n$$\n\n在初始迭代中，所求的四个量是：\n$p^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}$，$W^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix}$，$z^{(0)} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix}$，以及 $\\beta^{(1)} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{aligned}\np^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} \\\\\nW^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix} \\\\\nz^{(0)} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} \\\\\n\\beta^{(1)} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}\n\\end{aligned}\n}\n$$", "id": "4970685"}]}