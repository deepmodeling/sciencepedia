{"hands_on_practices": [{"introduction": "在使用对数连接函数的计数回归模型中，原始系数 $\\beta$ 表示预测变量与事件发生率对数之间的线性关系，其本身不具备直接的直观解释。因此，理解模型结果的关键第一步，是将这些系数转换为发病率比（Incident Rate Ratios, IRRs）。本练习将引导您完成这一基本换算，帮助您掌握如何量化解释预测变量一个单位的变化对期望计数值产生的乘法效应 [@problem_id:4905562]。", "problem": "一个生物统计团队使用一个适用于计数数据的广义线性模型来模拟慢性病管理的年度门诊次数，该模型使用对数连接函数，并适用于泊松分布族和负二项分布族。令具有协变量 $\\mathbf{x}$ 的个体的期望计数表示为 $\\mu(\\mathbf{x})$，其中对数连接函数通过将 $\\ln(\\mu(\\mathbf{x}))$ 与一个线性预测子相关联来确保其为正值。考虑一个特定的协变量 $x_{j}$，它代表一个在连续尺度上测量的可改变的风险因素。当 $x_{j}$ 处于参考值时的基线情况下，估计的平均计数为 $\\hat{\\mu}=2$。线性预测子中 $x_{j}$ 的拟合系数为 $\\hat{\\beta}_{j}=0.3$，且所有其他协变量保持不变。\n\n使用具有对数连接的计数回归的基本原理，以及率比（IRR）的标准定义（即协变量增加一个单位时，期望计数的乘法变化），从模型结构中推导出与 $x_{j}$ 增加一个单位相关的IRR以及期望平均计数的相应绝对变化。根据给定的估计值，数值计算这两个量。将您的数值结果四舍五入到四位有效数字。按以下顺序以数对形式提供最终答案：IRR，平均计数的绝对变化。", "solution": "问题要求在一个具有对数连接函数的计数数据广义线性模型框架下，推导和计算当协变量 $x_j$ 增加一个单位时的率比（IRR）以及期望平均计数的绝对变化。\n\n首先，我们建立模型的数学结构。该模型通过一个对数连接函数，将具有协变量向量 $\\mathbf{x}$ 的个体的期望计数 $\\mu$ 与一个线性预测子 $\\eta(\\mathbf{x})$ 相关联。\n线性预测子是协变量的线性组合：\n$$\n\\eta(\\mathbf{x}) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p = \\mathbf{x}^T \\boldsymbol{\\beta}\n$$\n对数连接函数定义为：\n$$\n\\ln(\\mu(\\mathbf{x})) = \\eta(\\mathbf{x})\n$$\n通过对两边取指数，我们可以将期望计数 $\\mu$ 直接表示为协变量的函数：\n$$\n\\mu(\\mathbf{x}) = \\exp(\\eta(\\mathbf{x})) = \\exp(\\mathbf{x}^T \\boldsymbol{\\beta})\n$$\n这种结构在泊松回归模型和负二项回归模型中都很常见。\n\n率比（IRR）定义为当某个特定协变量（例如 $x_j$）增加一个单位，同时保持所有其他协变量不变时，期望计数的乘法变化。让我们将其形式化。\n考虑一组基线协变量 $\\mathbf{x}_{\\text{base}} = (x_1, \\dots, x_j, \\dots, x_p)$。相应的期望计数为：\n$$\n\\mu_{\\text{base}} = \\mu(\\mathbf{x}_{\\text{base}}) = \\exp(\\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p)\n$$\n现在，考虑一组新的协变量 $\\mathbf{x}_{\\text{new}}$，其中只有一个协变量 $x_j$ 增加了一个单位，即其新值为 $x_j+1$。\n$$\n\\mathbf{x}_{\\text{new}} = (x_1, \\dots, x_j+1, \\dots, x_p)\n$$\n新的期望计数为：\n$$\n\\mu_{\\text{new}} = \\mu(\\mathbf{x}_{\\text{new}}) = \\exp(\\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j (x_j+1) + \\dots + \\beta_p x_p)\n$$\n我们可以重写 $\\mu_{\\text{new}}$ 的指数部分：\n$$\n\\mu_{\\text{new}} = \\exp((\\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p) + \\beta_j)\n$$\n$$\n\\mu_{\\text{new}} = \\exp(\\mathbf{x}_{\\text{base}}^T \\boldsymbol{\\beta} + \\beta_j) = \\exp(\\mathbf{x}_{\\text{base}}^T \\boldsymbol{\\beta}) \\cdot \\exp(\\beta_j)\n$$\n注意到 $\\exp(\\mathbf{x}_{\\text{base}}^T \\boldsymbol{\\beta}) = \\mu_{\\text{base}}$，我们得到：\n$$\n\\mu_{\\text{new}} = \\mu_{\\text{base}} \\cdot \\exp(\\beta_j)\n$$\nIRR 是新的期望计数与基线期望计数的比率：\n$$\n\\text{IRR} = \\frac{\\mu_{\\text{new}}}{\\mu_{\\text{base}}} = \\frac{\\mu_{\\text{base}} \\cdot \\exp(\\beta_j)}{\\mu_{\\text{base}}} = \\exp(\\beta_j)\n$$\n这个推导表明，对于一个对数连接模型，与协变量 $x_j$ 增加一个单位相关的 IRR 是其相应系数 $\\beta_j$ 的指数化值。\n\n问题给出了估计系数 $\\hat{\\beta}_j = 0.3$。使用这个估计值，估计的 IRR 是：\n$$\n\\widehat{\\text{IRR}} = \\exp(\\hat{\\beta}_j) = \\exp(0.3)\n$$\n数值上，这个值是：\n$$\n\\widehat{\\text{IRR}} \\approx 1.3498588...\n$$\n四舍五入到四位有效数字，我们得到 $\\widehat{\\text{IRR}} = 1.350$。\n\n接下来，我们推导由 $x_j$ 增加一个单位导致的期望平均计数的绝对变化 $\\Delta\\mu$。绝对变化定义为新的期望计数与基线期望计数之间的差值：\n$$\n\\Delta\\mu = \\mu_{\\text{new}} - \\mu_{\\text{base}}\n$$\n使用我们之前推导的关系式 $\\mu_{\\text{new}} = \\mu_{\\text{base}} \\cdot \\exp(\\beta_j) = \\mu_{\\text{base}} \\cdot \\text{IRR}$，我们可以写出：\n$$\n\\Delta\\mu = (\\mu_{\\text{base}} \\cdot \\exp(\\beta_j)) - \\mu_{\\text{base}} = \\mu_{\\text{base}}(\\exp(\\beta_j) - 1)\n$$\n问题给出了基线处的估计平均计数 $\\hat{\\mu}_{\\text{base}} = 2$ 和估计系数 $\\hat{\\beta}_j = 0.3$。我们可以计算估计的绝对变化 $\\Delta\\hat{\\mu}$：\n$$\n\\Delta\\hat{\\mu} = \\hat{\\mu}_{\\text{base}}(\\exp(\\hat{\\beta}_j) - 1) = 2 \\times (\\exp(0.3) - 1)\n$$\n使用之前计算的 $\\exp(0.3)$ 的值：\n$$\n\\Delta\\hat{\\mu} = 2 \\times (1.3498588... - 1) = 2 \\times 0.3498588... = 0.6997176...\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta\\hat{\\mu} = 0.6997$。\n\n所要求的两个量是数值计算的 IRR 和平均计数的绝对变化。\nIRR: $1.350$\n绝对变化: $0.6997$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.350  0.6997\n\\end{pmatrix}\n}\n$$", "id": "4905562"}, {"introduction": "在拟合模型并解释其系数之后，下一个关键步骤是评估模型的拟合优度，即模型与数据的吻合程度。残差分析是实现这一目标的有力工具，它能帮助我们诊断模型在哪些方面未能有效捕捉数据结构。本练习将向您介绍广义线性模型中两种重要的残差类型——皮尔逊残差（Pearson residuals）和偏差残差（deviance residuals），并演示如何利用它们来量化模型的整体拟合不足情况 [@problem_id:4905640]。", "problem": "一项医院感染监测研究使用广义线性模型 (GLM) 对每个病房的新增感染病例数进行建模。该模型具有泊松响应和标准对数连接，并带有一个表示病房级别暴露的偏移量。对于五个病房，观测到的感染病例数分别为 $y_{1},\\dots,y_{5}$，通过GLM拟合的泊松均值为 $\\hat{\\mu}_{1},\\dots,\\hat{\\mu}_{5}$。按相应顺序，对于 $i=1,\\dots,5$，$y_{i} \\in \\{0,2,3,5,9\\}$ 且 $\\hat{\\mu}_{i} \\in \\{0.8,1.5,2.5,6.0,7.5\\}$。\n\n从泊松概率质量函数和对数似然的定义出发，并利用偏差的定义（饱和模型的对数似然与拟合模型的对数似然之差的两倍），推导泊松GLM的皮尔逊残差 $r_{i}$ 和偏差残差 $d_{i}$ 的表达式。然后，计算这五个病房的残差，并通过计算皮尔逊残差平方和 $\\sum_{i=1}^{5} r_{i}^{2}$ 与偏差残差平方和 $\\sum_{i=1}^{5} d_{i}^{2}$ 来评估模型的拟合优度。\n\n将两个汇总统计量四舍五入至四位有效数字。将最终答案表示为一个包含两个元素的行矩阵，其中依次为皮尔逊残差平方和与偏差残差平方和。无需单位。", "solution": "该问题是有效的，因为它在科学上以统计理论为基础，问题陈述清晰且包含所有必要信息，并且表述客观。我们将开始解题，解题过程包括两个主要部分：首先，推导泊松GLM的皮尔逊残差和偏差残差的表达式；其次，根据给定数据计算它们的平方和。\n\n### 第1部分：残差推导\n\n**皮尔逊残差**\n\n对于广义线性模型 (GLM)，第 $i$ 个观测值的皮尔逊残差定义为原始残差除以响应变量的估计标准差。原始残差是观测值 $y_i$ 与拟合值（均值）$\\hat{\\mu}_i$ 之间的差。\n$$\n\\text{Raw Residual}_i = y_i - \\hat{\\mu}_i\n$$\n响应变量 $Y_i$ 的方差通过方差函数 $V(\\mu_i)$ 与其均值 $\\mu_i$ 相关联，即 $\\text{Var}(Y_i) = \\phi V(\\mu_i)$，其中 $\\phi$ 是离散参数。对于泊松分布，方差等于均值，因此 $V(\\mu_i) = \\mu_i$，且离散参数 $\\phi$ 固定为 $1$。\n因此，$Y_i$ 的标准差是 $\\sqrt{\\mu_i}$。估计标准差是 $\\sqrt{\\hat{\\mu}_i}$。\n因此，皮尔逊残差 $r_i$ 定义为：\n$$\nr_i = \\frac{y_i - \\hat{\\mu}_i}{\\sqrt{V(\\hat{\\mu}_i)}} = \\frac{y_i - \\hat{\\mu}_i}{\\sqrt{\\hat{\\mu}_i}}\n$$\n这就是泊松GLM的皮尔逊残差的所需表达式。\n\n**偏差残差**\n\n偏差定义为饱和模型的对数似然与拟合模型的对数似然之差的两倍。饱和模型是为每个观测值都设置一个参数的模型，使得拟合值与观测值完全相等，即 $\\tilde{\\mu}_i = y_i$。\n\n均值为 $\\mu_i$ 的泊松随机变量 $Y_i$ 的概率质量函数 (PMF) 为：\n$$\nf(y_i; \\mu_i) = \\frac{\\mu_i^{y_i} \\exp(-\\mu_i)}{y_i!}\n$$\n单个观测值 $y_i$ 的对数似然为：\n$$\nl(\\mu_i; y_i) = \\ln(f(y_i; \\mu_i)) = y_i \\ln(\\mu_i) - \\mu_i - \\ln(y_i!)\n$$\n饱和模型的对数似然 $l_{sat}$ 通过设置 $\\mu_i = y_i$ 得到：\n$$\nl(y_i; y_i) = y_i \\ln(y_i) - y_i - \\ln(y_i!)\n$$\n注意，对于 $y_i=0$ 的情况，我们使用极限 $\\lim_{x\\to0} x\\ln(x) = 0$，所以 $l(0;0) = 0 - 0 - \\ln(0!) = 0$。\n\n拟合模型的对数似然 $l_{fit}$ 通过使用拟合均值 $\\hat{\\mu}_i$ 得到：\n$$\nl(\\hat{\\mu}_i; y_i) = y_i \\ln(\\hat{\\mu}_i) - \\hat{\\mu}_i - \\ln(y_i!)\n$$\n第 $i$ 个观测值对总偏差的贡献 $D_i$ 是这些对数似然之差的两倍：\n$$\nD_i = 2 \\left( l(y_i; y_i) - l(\\hat{\\mu}_i; y_i) \\right)\n$$\n$$\nD_i = 2 \\left[ (y_i \\ln(y_i) - y_i - \\ln(y_i!)) - (y_i \\ln(\\hat{\\mu}_i) - \\hat{\\mu}_i - \\ln(y_i!)) \\right]\n$$\n$$\nD_i = 2 \\left[ y_i \\ln(y_i) - y_i \\ln(\\hat{\\mu}_i) - y_i + \\hat{\\mu}_i \\right]\n$$\n$$\nD_i = 2 \\left[ y_i \\ln\\left(\\frac{y_i}{\\hat{\\mu}_i}\\right) - (y_i - \\hat{\\mu}_i) \\right]\n$$\n这是观测值 $i$ 的偏差分量。如果 $y_i=0$，则表达式简化为 $D_i = 2[0 - (0-\\hat{\\mu}_i)] = 2\\hat{\\mu}_i$。\n\n偏差残差 $d_i$ 定义为偏差分量的带符号平方根，其符号与原始残差 $(y_i - \\hat{\\mu}_i)$ 的符号相同：\n$$\nd_i = \\text{sign}(y_i - \\hat{\\mu}_i) \\sqrt{D_i} = \\text{sign}(y_i - \\hat{\\mu}_i) \\sqrt{2 \\left[ y_i \\ln\\left(\\frac{y_i}{\\hat{\\mu}_i}\\right) - (y_i - \\hat{\\mu}_i) \\right]}\n$$\n总偏差是偏差残差的平方和，$D = \\sum_{i} d_i^2 = \\sum_i D_i$。\n\n### 第2部分：拟合优度汇总计算\n\n提供的 5 个病房的数据如下：\n观测计数：$y_i \\in \\{0, 2, 3, 5, 9\\}$，其中 $i=1,\\dots,5$。\n拟合均值：$\\hat{\\mu}_i \\in \\{0.8, 1.5, 2.5, 6.0, 7.5\\}$，其中 $i=1,\\dots,5$。\n\n**皮尔逊残差平方和 ($\\sum r_i^2$)**\n\n这个量也称为皮尔逊卡方统计量，$X^2$。\n$$\nX^2 = \\sum_{i=1}^{5} r_i^2 = \\sum_{i=1}^{5} \\frac{(y_i - \\hat{\\mu}_i)^2}{\\hat{\\mu}_i}\n$$\n代入给定值：\n$$\n\\sum_{i=1}^{5} r_i^2 = \\frac{(0-0.8)^2}{0.8} + \\frac{(2-1.5)^2}{1.5} + \\frac{(3-2.5)^2}{2.5} + \\frac{(5-6.0)^2}{6.0} + \\frac{(9-7.5)^2}{7.5}\n$$\n$$\n\\sum_{i=1}^{5} r_i^2 = \\frac{0.64}{0.8} + \\frac{0.25}{1.5} + \\frac{0.25}{2.5} + \\frac{1.0}{6.0} + \\frac{2.25}{7.5}\n$$\n$$\n\\sum_{i=1}^{5} r_i^2 = 0.8 + 0.16666\\dots + 0.1 + 0.16666\\dots + 0.3\n$$\n$$\n\\sum_{i=1}^{5} r_i^2 = 1.53333\\dots\n$$\n四舍五入至四位有效数字，我们得到 $1.533$。\n\n**偏差残差平方和 ($\\sum d_i^2$)**\n\n这个量就是总偏差 $D$。\n$$\nD = \\sum_{i=1}^{5} d_i^2 = \\sum_{i=1}^{5} 2 \\left[ y_i \\ln\\left(\\frac{y_i}{\\hat{\\mu}_i}\\right) - (y_i - \\hat{\\mu}_i) \\right]\n$$\n我们计算每个分量 $D_i = d_i^2$：\n对于 $i=1$：$y_1=0$，$\\hat{\\mu}_1=0.8$。公式简化为 $D_1 = 2\\hat{\\mu}_1 = 2(0.8) = 1.6$。\n对于 $i=2$：$y_2=2$，$\\hat{\\mu}_2=1.5$。$D_2 = 2 \\left[ 2 \\ln\\left(\\frac{2}{1.5}\\right) - (2-1.5) \\right] = 2[2(0.28768) - 0.5] \\approx 0.150728$。\n对于 $i=3$：$y_3=3$，$\\hat{\\mu}_3=2.5$。$D_3 = 2 \\left[ 3 \\ln\\left(\\frac{3}{2.5}\\right) - (3-2.5) \\right] = 2[3(0.18232) - 0.5] \\approx 0.093929$。\n对于 $i=4$：$y_4=5$，$\\hat{\\mu}_4=6.0$。$D_4 = 2 \\left[ 5 \\ln\\left(\\frac{5}{6.0}\\right) - (5-6.0) \\right] = 2[5(-0.18232) + 1] \\approx 0.176784$。\n对于 $i=5$：$y_5=9$，$\\hat{\\mu}_5=7.5$。$D_5 = 2 \\left[ 9 \\ln\\left(\\frac{9}{7.5}\\right) - (9-7.5) \\right] = 2[9(0.18232) - 1.5] \\approx 0.281788$。\n\n将各分量相加：\n$$\n\\sum_{i=1}^{5} d_i^2 = 1.6 + 0.150728 + 0.093929 + 0.176784 + 0.281788\n$$\n$$\n\\sum_{i=1}^{5} d_i^2 = 2.303229 \\dots\n$$\n四舍五入至四位有效数字，我们得到 $2.303$。\n\n这两个汇总统计量为 $\\sum_{i=1}^{5} r_{i}^{2} \\approx 1.533$ 和 $\\sum_{i=1}^{5} d_{i}^{2} \\approx 2.303$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.533  2.303\n\\end{pmatrix}\n}\n$$", "id": "4905640"}, {"introduction": "真实世界的计数数据很少完美遵循简单的泊松分布，常常表现出过度离散（overdispersion）或零计数过多的现象。这意味着我们必须在多个竞争模型之间做出选择，例如泊松模型、负二项模型及其零膨胀版本。本练习提供了一个实际场景，您将运用基于惩罚似然的准则，即赤池信息准则（AIC）和贝叶斯信息准则（BIC），来系统地比较这些模型，并选出在拟合优度与模型简约性之间达到最佳平衡的模型 [@problem_id:4905584]。", "problem": "一项基于医院的队列研究记录了在 $n=600$ 个病房日内，每个病房每日新增的导管相关性尿路感染病例数。研究人员通过最大似然法拟合了四个计数回归模型，这些模型在均值部分具有相同的 $3$ 个协变量和一个对数连接函数：泊松回归、负二项回归、一个仅含零膨胀截距的零膨胀泊松 (ZIP) 模型，以及一个仅含零膨胀截距的零膨胀负二项 (ZINB) 模型。每个模型中的自由参数数量 $k$ 如下：泊松模型 $k=4$（一个截距加 $3$ 个斜率），负二项模型 $k=5$（泊松模型的参数加一个离散参数），ZIP 模型 $k=5$（泊松模型的参数加一个零膨胀截距），ZINB 模型 $k=6$（负二项模型的参数加一个零膨胀截距）。最大化对数似然值分别为：泊松模型 $\\ell=-980.5$，负二项模型 $\\ell=-910.2$，ZIP 模型 $\\ell=-904.1$，ZINB 模型 $\\ell=-902.6$。\n\n从赤池信息准则和贝叶斯信息准则作为基于最大似然理论的惩罚似然准则的定义出发，利用报告的最大化对数似然值和参数数量，计算每个模型的赤池信息准则和贝叶斯信息准则。然后应用以下决策规则来选择单个模型：\n- 主要选择贝叶斯信息准则最小的模型。\n- 如果最小的两个贝叶斯信息准则值之差小于 $2$，则通过选择赤池信息准则最小的模型来打破僵局。\n- 如果仍然存在平局，则选择参数数量 $k$ 较小的模型。\n\n使用映射：泊松 $\\mapsto 1$，负二项 $\\mapsto 2$，ZIP $\\mapsto 3$，ZINB $\\mapsto 4$，将您的最终选择编码为一个数字代码。仅报告此数字代码作为您的最终答案。最终代码无需四舍五入。", "solution": "任务是根据涉及赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 的特定决策规则，从四个计数回归模型——泊松 (P)、负二项 (NB)、零膨胀泊松 (ZIP) 或零膨胀负二项 (ZINB)——中选择一个。\n\nAIC 和 BIC 的定义是作为惩罚似然准则给出的。设 $\\ell$ 是模型的最大化对数似然， $k$ 是自由参数的数量， $n$ 是样本量。公式如下：\n$$AIC = -2\\ell + 2k$$\n$$BIC = -2\\ell + k \\ln(n)$$\n\n问题提供了以下数据：\n样本量：$n = 600$。\n各模型的特征如下：\n1.  泊松 (P)：参数数量 $k_P = 4$，最大化对数似然 $\\ell_P = -980.5$。\n2.  负二项 (NB)：参数数量 $k_{NB} = 5$，最大化对数似然 $\\ell_{NB} = -910.2$。\n3.  零膨胀泊松 (ZIP)：参数数量 $k_{ZIP} = 5$，最大化对数似然 $\\ell_{ZIP} = -904.1$。\n4.  零膨胀负二项 (ZINB)：参数数量 $k_{ZINB} = 6$，最大化对数似然 $\\ell_{ZINB} = -902.6$。\n\n首先，我们计算每个模型的 AIC 和 BIC。BIC 的计算需要 $\\ln(n)$ 的值：\n$\\ln(n) = \\ln(600)$。\n\n对于泊松模型：\n$AIC_P = -2(-980.5) + 2(4) = 1961 + 8 = 1969.0$\n$BIC_P = -2(-980.5) + 4 \\ln(600) = 1961 + 4 \\ln(600)$\n\n对于负二项模型：\n$AIC_{NB} = -2(-910.2) + 2(5) = 1820.4 + 10 = 1830.4$\n$BIC_{NB} = -2(-910.2) + 5 \\ln(600) = 1820.4 + 5 \\ln(600)$\n\n对于零膨胀泊松模型：\n$AIC_{ZIP} = -2(-904.1) + 2(5) = 1808.2 + 10 = 1818.2$\n$BIC_{ZIP} = -2(-904.1) + 5 \\ln(600) = 1808.2 + 5 \\ln(600)$\n\n对于零膨胀负二项模型：\n$AIC_{ZINB} = -2(-902.6) + 2(6) = 1805.2 + 12 = 1817.2$\n$BIC_{ZINB} = -2(-902.6) + 6 \\ln(600) = 1805.2 + 6 \\ln(600)$\n\n现在，我们应用指定的决策规则。\n\n步骤 1：主要选择 BIC 最小的模型。\n让我们比较一下 BIC 值。\n$BIC_P = 1961 + 4 \\ln(600)$\n$BIC_{NB} = 1820.4 + 5 \\ln(600)$\n$BIC_{ZIP} = 1808.2 + 5 \\ln(600)$\n$BIC_{ZINB} = 1805.2 + 6 \\ln(600)$\n\n为了比较这些值，我们看一下差值。\n$BIC_{NB} - BIC_{ZIP} = (1820.4 + 5 \\ln(600)) - (1808.2 + 5 \\ln(600)) = 12.2  0$，所以 $BIC_{ZIP}  BIC_{NB}$。\n$BIC_{ZINB} - BIC_{ZIP} = (1805.2 + 6 \\ln(600)) - (1808.2 + 5 \\ln(600)) = -3.0 + \\ln(600)$。由于 $\\ln(600) \\approx 6.397$，这个差值是正数。所以 $BIC_{ZIP}  BIC_{ZINB}$。\n泊松模型的 BIC 值比其他模型大得多，因为 $1961$ 远大于其他基数项。\n因此，最小的 BIC 值属于 ZIP 模型。为了确定，让我们按升序列出 BIC 值。我们需要对它们进行数值计算。使用 $\\ln(600) \\approx 6.3969$：\n$BIC_P \\approx 1961 + 4(6.3969) = 1961 + 25.5876 = 1986.5876$\n$BIC_{NB} \\approx 1820.4 + 5(6.3969) = 1820.4 + 31.9845 = 1852.3845$\n$BIC_{ZIP} \\approx 1808.2 + 5(6.3969) = 1808.2 + 31.9845 = 1840.1845$\n$BIC_{ZINB} \\approx 1805.2 + 6(6.3969) = 1805.2 + 38.3814 = 1843.5814$\n\nBIC 值的排序如下：\n$BIC_{ZIP} \\approx 1840.18  BIC_{ZINB} \\approx 1843.58  BIC_{NB} \\approx 1852.38  BIC_P \\approx 1986.59$。\n\n步骤 2：如果最小的两个 BIC 值之差小于 $2$，则通过选择 AIC 最小的模型来打破僵局。\n两个最小的 BIC 值对应于 ZIP 和 ZINB 模型。它们的差值为：\n$\\Delta BIC = BIC_{ZINB} - BIC_{ZIP} = (-3.0 + \\ln(600)) \\approx 3.3969$。\n由于这个差值 $3.3969$ 不小于 $2$，主要选择规则成立。我们不进行打破僵局的步骤。选择 BIC 最小的模型。\n\nBIC 最小的模型是零膨胀泊松 (ZIP) 模型。\n\n问题要求将最终选择编码为一个数字代码，其中泊松 $\\mapsto 1$，负二项 $\\mapsto 2$，ZIP $\\mapsto 3$，ZINB $\\mapsto 4$。\n由于所选模型是 ZIP，对应的数字代码是 $3$。", "answer": "$$\\boxed{3}$$", "id": "4905584"}]}