{"hands_on_practices": [{"introduction": "这项练习旨在帮助您掌握诊断测试核心性能指标的基础计算。通过直接处理一个假设的混淆矩阵，您将计算灵敏度（sensitivity）和特异性（specificity），从而巩固对这些不受患病率影响的指标的理解。这项技能是评估任何诊断测试的关键第一步。", "problem": "在精准肿瘤学背景下，一项靶向下一代测序分析方法被用于评估其检测致病性变异的能力。在一项多中心病例对照评估中，样本被该分析方法分类为阳性或阴性，并使用一个金标准的正交方法来确定其真实的变异状态。设真阳性计数为 $TP = 48$，假阴性计数为 $FN = 12$，假阳性计数为 $FP = 18$，真阴性计数为 $TN = 122$。仅使用条件概率和二元分类中错误率的基本定义，计算以下四个性能特征：灵敏度、特异度、假阳性率和假阴性率。然后，使用关于回顾性（病例对照）抽样下条件概率的第一性原理进行论证，确定这四个量中哪些在病例对照抽样下不受疾病患病率的影响。\n\n将最终答案按顺序 $\\bigl(\\text{sensitivity},\\ \\text{specificity},\\ \\text{false positive rate},\\ \\text{false negative rate},\\ I_{\\text{sensitivity}},\\ I_{\\text{specificity}},\\ I_{\\text{false positive rate}},\\ I_{\\text{false negative rate}}\\bigr)$ 以单行矩阵的形式报告，其中，如果该量在病例对照抽样下不受患病率影响，则 $I_{\\cdot}$ 为 $1$，否则为 $0$。将这四个率表示为精确的既约分数。不允许四舍五入。不变性指标必须报告为精确整数 $0$ 或 $1$。", "solution": "该问题陈述经评估具有科学依据、提法明确、客观且自洽。计算所需的所有数据均已提供，所涉及的概念是统计学和临床诊断学的基础。因此，该问题是有效的。\n\n设 $D^+$ 表示个体携带致病性变异的事件（即病例），$D^-$ 表示个体不携带该变异的事件（即对照）。设 $T^+$ 表示分析结果为阳性的事件，$T^-$ 表示分析结果为阴性的事件。\n\n所提供的数据是二元分类混淆矩阵中四种可能结果的计数：\n- 真阳性（$TP$）：携带变异且检测结果为阳性的个体数量。$TP = 48$。\n- 假阴性（$FN$）：携带变异但检测结果为阴性的个体数量。$FN = 12$。\n- 假阳性（$FP$）：不携带变异但检测结果为阳性的个体数量。$FP = 18$。\n- 真阴性（$TN$）：不携带变异且检测结果为阴性的个体数量。$TN = 122$。\n\n根据这些计数，我们可以确定研究中病例和对照的总数：\n- 病例总数（携带变异的个体）：$P = TP + FN = 48 + 12 = 60$。\n- 对照总数（不携带变异的个体）：$N = FP + TN = 18 + 122 = 140$。\n\n这四个性能特征是根据它们作为条件概率的定义来计算的。\n\n1.  **灵敏度 (True Positive Rate, $TPR$)**\n    灵敏度是在个体确实携带变异的情况下，检测结果为阳性的概率。它是衡量该检测识别真病例能力的指标。\n    $$ \\text{Sensitivity} = P(T^+ | D^+) = \\frac{\\text{Number of individuals with } T^+ \\text{ and } D^+}{\\text{Total number of individuals with } D^+} = \\frac{TP}{TP + FN} $$\n    代入给定值：\n    $$ \\text{Sensitivity} = \\frac{48}{48 + 12} = \\frac{48}{60} = \\frac{4 \\times 12}{5 \\times 12} = \\frac{4}{5} $$\n\n2.  **特异度 (True Negative Rate, $TNR$)**\n    特异度是在个体确实不携带变异的情况下，检测结果为阴性的概率。它是衡量该检测识别真非病例能力的指标。\n    $$ \\text{Specificity} = P(T^- | D^-) = \\frac{\\text{Number of individuals with } T^- \\text{ and } D^-}{\\text{Total number of individuals with } D^-} = \\frac{TN}{TN + FP} $$\n    代入给定值：\n    $$ \\text{Specificity} = \\frac{122}{122 + 18} = \\frac{122}{140} = \\frac{61 \\times 2}{70 \\times 2} = \\frac{61}{70} $$\n\n3.  **假阳性率 ($FPR$)**\n    假阳性率是在个体确实不携带变异的情况下，检测结果为阳性的概率。这是I类错误率。\n    $$ FPR = P(T^+ | D^-) = \\frac{\\text{Number of individuals with } T^+ \\text{ and } D^-}{\\text{Total number of individuals with } D^-} = \\frac{FP}{FP + TN} $$\n    它在定义上也与特异度相关：$FPR = 1 - \\text{Specificity}$。\n    代入给定值：\n    $$ FPR = \\frac{18}{18 + 122} = \\frac{18}{140} = \\frac{9 \\times 2}{70 \\times 2} = \\frac{9}{70} $$\n\n4.  **假阴性率 ($FNR$)**\n    假阴性率是在个体确实携带变异的情况下，检测结果为阴性的概率。这是II类错误率。\n    $$ FNR = P(T^- | D^+) = \\frac{\\text{Number of individuals with } T^- \\text{ and } D^+}{\\text{Total number of individuals with } D^+} = \\frac{FN}{TP + FN} $$\n    它在定义上也与灵敏度相关：$FNR = 1 - \\text{Sensitivity}$。\n    代入给定值：\n    $$ FNR = \\frac{12}{48 + 12} = \\frac{12}{60} = \\frac{1 \\times 12}{5 \\times 12} = \\frac{1}{5} $$\n\n接下来，我们必须确定在病例对照抽样下，这些量中哪些不受疾病患病率的影响。\n\n病例对照研究是一种回顾性研究设计，其中根据受试者已知的结果状态来选择他们。在这里，一组“病例”（携带变异的个体，$D^+$）和一组“对照”（不携带变异的个体，$D^-$）被组合在一起。研究样本中病例与对照的比例是由研究设计决定的，而不是由人群中疾病的自然患病率决定的。患病率 $\\pi = P(D^+)$ 是指在可能从中抽取研究样本的普通人群中患有该疾病的先验概率。在病例对照设计中，样本患病率是人为固定的，并不是对 $\\pi$ 的估计。\n\n我们结合这种抽样方案来分析这四个指标的定义：\n\n-   **灵敏度, $P(T^+|D^+)$**: 这个概率是以事件 $D^+$ 为条件的。计算 $\\frac{TP}{TP+FN}$ 完全在病例组内进行。由于灵敏度的估计仅依赖于已知患病的受试者，因此它与研究中包含了多少未患病的受试者无关。因此，灵敏度是检测方法在患病人群中性能的内在特征，并且对普通人群中的疾病患病率是**不变的**。指标 $I_{\\text{sensitivity}}$ 为 $1$。\n\n-   **特异度, $P(T^-|D^-)$**: 这个概率是以事件 $D^-$ 为条件的。计算 $\\frac{TN}{TN+FP}$ 完全在对照组内进行。与灵敏度类似，特异度的估计仅依赖于已知无病的受试者。因此，它是检测方法在非患病人群中性能的内在特征，并且对疾病患病率是**不变的**。指标 $I_{\\text{specificity}}$ 为 $1$。\n\n-   **假阳性率, $P(T^+|D^-)$**: 这个概率也是以事件 $D^-$ 为条件的。其计算 $\\frac{FP}{FP+TN}$ 完全在对照组内进行。由于它就是 $1 - \\text{Specificity}$，因此它具有相同的性质。假阳性率对疾病患病率是**不变的**。指标 $I_{\\text{false positive rate}}$ 为 $1$。\n\n-   **假阴性率, $P(T^-|D^+)$**: 这个概率也是以事件 $D^+$ 为条件的。其计算 $\\frac{FN}{TP+FN}$ 完全在病例组内进行。由于它就是 $1 - \\text{Sensitivity}$，因此它也具有相同的性质。假阴性率对疾病患病率是**不变的**。指标 $I_{\\text{false negative rate}}$ 为 $1$。\n\n总之，所有四个指标——灵敏度、特异度、假阳性率和假阴性率——都是由以真实疾病状态为条件的概率定义的。病例对照研究设计之所以能够直接估计这些量，正是因为它从患病和非患病这两个不同层级中进行抽样。这些指标是检测方法本身的属性，而不是其使用人群的属性。相比之下，像阳性预测值（$PPV = P(D^+|T^+)$）和阴性预测值（$NPV = P(D^-|T^-)$）这样的指标，通过贝叶斯定理，严重依赖于患病率 $\\pi = P(D^+)$，并且在没有 $\\pi$ 的外部知识的情况下，无法从病例对照研究中直接估计。\n\n计算出的值及其不变性指标如下：\n- 灵敏度：$\\frac{4}{5}$，不变 ($I=1$)\n- 特异度：$\\frac{61}{70}$，不变 ($I=1$)\n- 假阳性率：$\\frac{9}{70}$，不变 ($I=1$)\n- 假阴性率：$\\frac{1}{5}$，不变 ($I=1$)\n\n最终答案按指定顺序以单行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{61}{70}  \\frac{9}{70}  \\frac{1}{5}  1  1  1  1\n\\end{pmatrix}\n}\n$$", "id": "4332588"}, {"introduction": "在灵敏度和特异性概念的基础上，本题将探讨测试在人群中的实际应用。您将学习如何计算和解释阳性预测值（PPV）和阴性预测值（NPV），这两个值都与疾病的患病率 $\\pi$ 密切相关。这项练习强调了测试的内在准确性与其在真实筛查场景（尤其是针对罕见病时）中的预测能力之间的关键区别。", "problem": "一家生物技术公司正在评估一种新的基于血液的筛查检测方法，用于无症状成年人群中的一种罕见遗传病。设 $D$ 表示随机抽取的个体患有该疾病的事件，设 $T^{+}$ 和 $T^{-}$ 分别表示筛查测试结果为阳性和阴性。该检测的灵敏度为 $\\operatorname{Se}=P(T^{+}\\mid D)=0.95$，特异性为 $\\operatorname{Sp}=P(T^{-}\\mid D^{c})=0.90$，并且该疾病在目标筛查人群中的患病率为 $\\pi=P(D)=0.01$。\n\n从灵敏度、特异性和患病率的定义出发，仅使用概率公理、贝叶斯定理和全概率定律，推导阳性预测值 (PPV) $P(D\\mid T^{+})$ 和阴性预测值 (NPV) $P(D^{c}\\mid T^{-})$ 的表达式。然后，使用给定的数值 $\\operatorname{Se}=0.95$、$\\operatorname{Sp}=0.90$ 和 $\\pi=0.01$ 对这些表达式进行数值计算。\n\n最后，在罕见病筛查的背景下，对计算出的 $P(D\\mid T^{+})$ 和 $P(D^{c}\\mid T^{-})$ 进行简要解释，重点说明低患病率如何影响阳性与阴性结果的可信度。\n\n将每个最终数值结果四舍五入到四位有效数字，并以一个双元素行向量 $\\big(\\operatorname{PPV},\\operatorname{NPV}\\big)$ 的形式报告，不带单位。", "solution": "首先验证问题，以确保其科学根据充分、问题定义明确且客观。\n\n**步骤1：提取给定信息**\n问题提供了以下定义和数值：\n- $D$：随机抽取的个体患有该疾病的事件。\n- $D^c$：随机抽取的个体不患有该疾病的事件。\n- $T^{+}$：筛查测试结果为阳性的事件。\n- $T^{-}$：筛查测试结果为阴性的事件。\n- 灵敏度：$\\operatorname{Se} = P(T^{+} \\mid D) = 0.95$。\n- 特异性：$\\operatorname{Sp} = P(T^{-} \\mid D^c) = 0.90$。\n- 患病率：$\\pi = P(D) = 0.01$。\n\n目标是推导阳性预测值 $\\operatorname{PPV} = P(D \\mid T^{+})$ 和阴性预测值 $\\operatorname{NPV} = P(D^c \\mid T^{-})$ 的表达式，对其进行数值计算，并提供解释。\n\n**步骤2：使用提取的给定信息进行验证**\n该问题是贝叶斯概率在诊断测试评估中的标准应用，这是生物统计学和流行病学的核心课题。\n- **科学根据充分：** 灵敏度、特异性、患病率、PPV 和 NPV 的概念是医学诊断学中基础且公认的原则。所提供的值（$\\operatorname{Se}=0.95$, $\\operatorname{Sp}=0.90$, $\\pi=0.01$）对于罕见病的筛查测试是符合实际的。\n- **问题定义明确：** 问题陈述清晰，提供了推导和计算所需概率的所有必要信息。待计算的量由给定信息唯一确定。\n- **客观性：** 问题以精确、客观和标准的数学语言表述，没有歧义或主观陈述。\n\n**步骤3：结论与行动**\n问题陈述有效。解决方案将首先推导 PPV 和 NPV 的通用符号表达式，然后代入给定的数值。\n\n**阳性预测值 (PPV) 的推导**\n阳性预测值是指在测试结果为阳性的条件下，个体确实患有该疾病的概率，记为 $P(D \\mid T^{+})$。我们使用贝叶斯定理来表示这个量：\n$$ \\operatorname{PPV} = P(D \\mid T^{+}) = \\frac{P(T^{+} \\mid D) P(D)}{P(T^{+})} $$\n分母 $P(T^{+})$ 是测试结果为阳性的总概率。我们可以使用全概率定律，在样本空间划分为患病 ($D$) 和不患病 ($D^c$) 的基础上展开此项：\n$$ P(T^{+}) = P(T^{+} \\mid D) P(D) + P(T^{+} \\mid D^c) P(D^c) $$\n我们可以得到或推导出这个展开式中的每一项：\n- $P(T^{+} \\mid D) = \\operatorname{Se}$ (灵敏度)\n- $P(D) = \\pi$ (患病率)\n- $P(D^c) = 1 - P(D) = 1 - \\pi$ (补集概率公理)\n- $P(T^{+} \\mid D^c)$ 是无病个体测试结果为阳性的概率（假阳性率）。它是特异性的补集，因为对于给定的疾病状态，测试结果必须是阳性或阴性。因此，$P(T^{+} \\mid D^c) = 1 - P(T^{-} \\mid D^c) = 1 - \\operatorname{Sp}$。\n\n将这些代入 $P(T^{+})$ 的表达式中：\n$$ P(T^{+}) = (\\operatorname{Se})(\\pi) + (1 - \\operatorname{Sp})(1 - \\pi) $$\n现在，将整个表达式代回 PPV 的公式中：\n$$ \\operatorname{PPV} = \\frac{(\\operatorname{Se})(\\pi)}{(\\operatorname{Se})(\\pi) + (1 - \\operatorname{Sp})(1 - \\pi)} $$\n这就是用灵敏度、特异性和患病率表示的阳性预测值的通用表达式。\n\n**阴性预测值 (NPV) 的推导**\n阴性预测值是在测试结果为阴性的条件下，个体确实没有患该疾病的概率，记为 $P(D^c \\mid T^{-})$。再次应用贝叶斯定理：\n$$ \\operatorname{NPV} = P(D^c \\mid T^{-}) = \\frac{P(T^{-} \\mid D^c) P(D^c)}{P(T^{-})} $$\n分母 $P(T^{-})$ 是测试结果为阴性的总概率。使用全概率定律：\n$$ P(T^{-}) = P(T^{-} \\mid D^c) P(D^c) + P(T^{-} \\mid D) P(D) $$\n我们确定各项：\n- $P(T^{-} \\mid D^c) = \\operatorname{Sp}$ (特异性)\n- $P(D^c) = 1 - \\pi$\n- $P(D) = \\pi$\n- $P(T^{-} \\mid D)$ 是患病个体测试结果为阴性的概率（假阴性率）。它是灵敏度的补集：$P(T^{-} \\mid D) = 1 - P(T^{+} \\mid D) = 1 - \\operatorname{Se}$。\n\n将这些代入 $P(T^{-})$ 的表达式中：\n$$ P(T^{-}) = (\\operatorname{Sp})(1 - \\pi) + (1 - \\operatorname{Se})(\\pi) $$\n现在，将此代回 NPV 的公式中：\n$$ \\operatorname{NPV} = \\frac{(\\operatorname{Sp})(1 - \\pi)}{(\\operatorname{Sp})(1 - \\pi) + (1 - \\operatorname{Se})(\\pi)} $$\n这是阴性预测值的通用表达式。\n\n**数值计算**\n我们代入给定值：$\\operatorname{Se} = 0.95$、$\\operatorname{Sp} = 0.90$ 和 $\\pi = 0.01$。\n\n对于 PPV：\n$$ \\operatorname{PPV} = \\frac{(0.95)(0.01)}{(0.95)(0.01) + (1 - 0.90)(1 - 0.01)} = \\frac{0.0095}{0.0095 + (0.10)(0.99)} = \\frac{0.0095}{0.0095 + 0.099} = \\frac{0.0095}{0.1085} $$\n$$ \\operatorname{PPV} \\approx 0.087557603... $$\n四舍五入到四位有效数字，$\\operatorname{PPV} \\approx 0.08756$。\n\n对于 NPV：\n$$ \\operatorname{NPV} = \\frac{(0.90)(1 - 0.01)}{(0.90)(1 - 0.01) + (1 - 0.95)(0.01)} = \\frac{(0.90)(0.99)}{(0.90)(0.99) + (0.05)(0.01)} = \\frac{0.891}{0.891 + 0.0005} = \\frac{0.891}{0.8915} $$\n$$ \\operatorname{NPV} \\approx 0.999439147... $$\n四舍五入到四位有效数字，$\\operatorname{NPV} \\approx 0.9994$。\n\n**解释**\n计算出的阳性预测值为 $\\operatorname{PPV} \\approx 0.08756$。这意味着如果来自该人群的一个人收到阳性测试结果，他们实际患有该疾病的几率仅为 $8.756\\%$。尽管测试具有高灵敏度（$\\operatorname{Se}=0.95$），阳性结果是假阳性的可能性远大于真阳性。这种违反直觉的结果是疾病低患病率（$\\pi=0.01$）的直接后果。因为这种疾病很罕见，所以测试结果呈阳性的健康个体（假阳性，由 $1-\\operatorname{Sp}$ 决定）的绝对数量远远超过测试结果呈阳性的患病个体（真阳性，由 $\\operatorname{Se}$ 决定）的绝对数量。具体来说，在一个 $100,000$ 人的群体中，有 $1,000$ 人患有此病，而 $99,000$ 人没有。该测试将识别出 $1000 \\times 0.95 = 950$ 个真阳性，以及 $99000 \\times (1-0.90) = 9900$ 个假阳性。因此，PPV 为 $950 / (950 + 9900) \\approx 0.08756$。\n\n计算出的阴性预测值为 $\\operatorname{NPV} \\approx 0.9994$。这意味着如果一个人收到阴性测试结果，他们确实没有患病的几率为 $99.94\\%$。这项筛查测试的阴性结果非常可靠。\n\n总之，对于罕见病的筛查，阴性结果高度可信，能有效排除该病症。然而，阳性结果本身的可信度较低，不应被解释为诊断，而应被视为需要进行进一步、更具特异性（且通常更具侵入性或更昂贵）的确诊性诊断测试的指征。这种现象被称为“基础率谬误”。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.08756  0.9994\n\\end{pmatrix}\n}\n$$", "id": "4908588"}, {"introduction": "这项高级练习将从静态计算转向动态模拟，旨在帮助您更深入地理解诊断测试在处理连续数据时的性能表现。您将设计一个模拟程序，观察患病与非患病人群分布的分离程度如何影响ROC曲线下面积（AUC），并学习如何选择一个最佳决策阈值。本练习将基础指标与强大的接收者操作特征（ROC）分析框架联系起来。", "problem": "给定两种疾病状态下的连续诊断评分分布：$S \\mid D=1$ 表示患病受试者， $S \\mid D=0$ 表示非患病受试者。两种分布均假定为正态（高斯）分布，其均值分别为 $\\mu_1$ 和 $\\mu_0$，标准差分别为 $\\sigma_1$ 和 $\\sigma_0$。一个二元决策规则将评分 $S \\ge t$（其中 $t$ 为阈值）的受试者分类为检验阳性，否则为检验阴性。本问题的基础包括以下定义：灵敏度（真阳性率）为 $\\operatorname{Se}(t) = \\mathbb{P}(S \\ge t \\mid D=1)$，特异度（真阴性率）为 $\\operatorname{Sp}(t) = \\mathbb{P}(S  t \\mid D=0)$，以及受试者工作特征（ROC）曲线下面积（AUC）是概率 $\\mathbb{P}(S_1  S_0)$，其中 $S_1 \\sim S \\mid D=1$ 和 $S_0 \\sim S \\mid D=0$ 是独立的。\n\n设计一个模拟实验，以探究在正态模型下，改变 $S \\mid D=1$ 和 $S \\mid D=0$ 之间的间隔如何影响 $\\operatorname{Se}$、$\\operatorname{Sp}$ 和 AUC。您的程序必须：\n\n- 对每组参数，从 $S \\mid D=1 \\sim \\mathcal{N}(\\mu_1,\\sigma_1^2)$ 中模拟 $n_1$ 个独立样本，并从 $S \\mid D=0 \\sim \\mathcal{N}(\\mu_0,\\sigma_0^2)$ 中模拟 $n_0$ 个独立样本。\n- 在覆盖合并样本范围的阈值网格上，选择使约登指数（Youden's index） $J(t) = \\operatorname{Se}(t) + \\operatorname{Sp}(t) - 1$ 最大化的阈值 $t^\\ast$。必须在经验范围内的规模为 $K$ 的均匀网格上评估阈值；取 $K$ 为 $1001$。\n- 使用模拟数据，根据比例经验性地估计在 $t^\\ast$ 处的 $\\operatorname{Se}$ 和 $\\operatorname{Sp}$。\n- 使用从合并样本的秩计算出的 Mann–Whitney 概率解释 $\\mathbb{P}(S_1  S_0)$ 来经验性地估计 AUC（将 AUC 表示为小数，而非百分比）。\n- 为每个测试用例使用固定的随机种子以确保可复现性。\n\n所有答案均以小数表示。不涉及物理单位。您的程序的最终输出必须是单行文本，包含一个由方括号括起来的逗号分隔列表。列表中的每个元素本身都必须是包含三个浮点数 $[\\operatorname{Se},\\operatorname{Sp},\\mathrm{AUC}]$ 的列表，四舍五入到恰好四位小数，并且整行中不含任何空格。例如，格式必须类似于 $[[0.5000,0.5000,0.5000],[0.8000,0.7000,0.8500]]$。\n\n测试套件（每个用例为 $(\\mu_1,\\mu_0,\\sigma_1,\\sigma_0,n_1,n_0,\\text{seed})$）：\n- 用例 1： $(0,0,1,1,50000,50000,1)$，无间隔的边界条件。\n- 用例 2： $(1,0,1,1,50000,50000,2)$，方差相等，间隔适中。\n- 用例 3： $(2,0,1,1,50000,50000,3)$，方差相等，间隔较大。\n- 用例 4： $(1,0,1.5,1,50000,50000,4)$，方差不等，均值间隔适中。\n- 用例 5： $(4,0,1,1,50000,50000,5)$，方差相等，间隔非常大。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，格式应完全为 $[[\\operatorname{Se}_1,\\operatorname{Sp}_1,\\mathrm{AUC}_1],[\\operatorname{Se}_2,\\operatorname{Sp}_2,\\mathrm{AUC}_2],\\dots,]$，每个数值条目四舍五入到四位小数且不含空格。", "solution": "该问题要求设计一个数值模拟，以在双正态模型下评估诊断测试的性能。该性能通过灵敏度（$\\operatorname{Se}$）、特异度（$\\operatorname{Sp}$）和受试者工作特征曲线下面积（AUC）进行量化。该模拟将探究当基础评分分布的参数变化时，这些指标如何随之改变。\n\n### 1. 问题构建与统计模型\n\n问题的核心在于诊断评分的统计建模。给定患病受试者 ($S \\mid D=1$) 和非患病受试者 ($S \\mid D=0$) 的评分遵循正态（高斯）分布：\n$$\nS \\mid D=1 \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2) \\\\\nS \\mid D=0 \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)\n$$\n如果受试者的评分 $S$ 超过某个阈值 $t$（即 $S \\ge t$），则被分类为阳性。否则，被分类为阴性。\n\n### 2. 性能指标\n该分类规则的质量通过三个标准指标进行评估：\n\n-   **灵敏度（$\\operatorname{Se}$）**：正确识别患病受试者的概率。即真阳性率。\n    $$\n    \\operatorname{Se}(t) = \\mathbb{P}(S \\ge t \\mid D=1)\n    $$\n\n-   **特异度（$\\operatorname{Sp}$）**：正确识别非患病受试者的概率。即真阴性率。\n    $$\n    \\operatorname{Sp}(t) = \\mathbb{P}(S  t \\mid D=0)\n    $$\n\n-   **ROC 曲线下面积（AUC）**：ROC 曲线是对于所有可能的阈值 $t$，绘制 $\\operatorname{Se}(t)$ 与 $1 - \\operatorname{Sp}(t)$ 关系的图。AUC 代表了评分的整体区分能力，与特定阈值无关。它等价于随机选择的患病受试者的评分高于随机选择的非患病受试者的评分的概率。\n    $$\n    \\mathrm{AUC} = \\mathbb{P}(S_1  S_0)\n    $$\n    其中 $S_1$ 和 $S_0$ 分别是从患病和非患病评分分布中抽取的独立随机变量。\n\n### 3. 模拟方法\n\n对于每组参数 $(\\mu_1, \\mu_0, \\sigma_1, \\sigma_0, n_1, n_0, \\text{seed})$，执行以下步骤：\n\n#### 3.1. 数据生成\n使用由指定种子初始化的伪随机数生成器，我们模拟两组评分：\n-   患病组的 $n_1$ 个评分样本：$\\{s_{1,i}\\}_{i=1}^{n_1}$，来自 $\\mathcal{N}(\\mu_1, \\sigma_1^2)$。\n-   非患病组的 $n_0$ 个评分样本：$\\{s_{0,j}\\}_{j=1}^{n_0}$，来自 $\\mathcal{N}(\\mu_0, \\sigma_0^2)$。\n\n#### 3.2. 经验性 AUC 估计\nAUC 使用 Mann-Whitney U 统计量进行估计，该统计量与概率 $\\mathbb{P}(S_1  S_0)$ 直接相关。步骤如下：\n1.  将两个样本 $\\{s_{1,i}\\}$ 和 $\\{s_{0,j}\\}$ 合并为一个大小为 $N = n_1 + n_0$ 的数据集。\n2.  为合并数据集中的所有评分分配秩。如果出现平级（ties），则使用平均秩。令 $R_1$ 为对应于患病组评分 $\\{s_{1,i}\\}$ 的秩之和。\n3.  计算患病组的 Mann-Whitney U 统计量：\n    $$\n    U_1 = R_1 - \\frac{n_1(n_1+1)}{2}\n    $$\n4.  经验性 AUC 则由 $U_1$ 与两组之间评分对总数的比率给出：\n    $$\n    \\widehat{\\mathrm{AUC}} = \\frac{U_1}{n_1 n_0}\n    $$\n该估计量是衡量两种分布之间间隔的非参数且稳健的度量。\n\n#### 3.3. 最优阈值选择\n问题指定通过最大化约登指数（Youden's index） $J(t)$ 来选择单个“最优”阈值 $t^\\ast$。约登指数衡量 ROC 曲线上某点到机会线（chance line）的垂直距离，定义为：\n$$\nJ(t) = \\operatorname{Se}(t) + \\operatorname{Sp}(t) - 1\n$$\n为找到使经验性约登指数 $\\hat{J}(t)$ 最大化的阈值 $\\hat{t}^\\ast$，我们执行网格搜索：\n1.  创建一个由 $K=1001$ 个候选阈值组成的均匀网格。该网格覆盖了观测评分的整个范围，从合并样本中的最小值到最大值。设此网格为 $\\{t_k\\}_{k=1}^{K}$。\n2.  对于网格中的每个阈值 $t_k$，我们从模拟样本中计算经验性灵敏度和特异度：\n    $$\n    \\widehat{\\operatorname{Se}}(t_k) = \\frac{1}{n_1} \\sum_{i=1}^{n_1} \\mathbb{I}(s_{1,i} \\ge t_k) \\\\\n    \\widehat{\\operatorname{Sp}}(t_k) = \\frac{1}{n_0} \\sum_{j=1}^{n_0} \\mathbb{I}(s_{0,j}  t_k)\n    $$\n    其中 $\\mathbb{I}(\\cdot)$ 是指示函数，如果条件为真则为 1，否则为 0。\n3.  为每个阈值计算经验性约登指数：\n    $$\n    \\hat{J}(t_k) = \\widehat{\\operatorname{Se}}(t_k) + \\widehat{\\operatorname{Sp}}(t_k) - 1\n    $$\n4.  最优阈值 $\\hat{t}^\\ast$ 是产生 $\\hat{J}(t_k)$ 最大值的阈值 $t_k$。\n    $$\n    \\hat{t}^\\ast = \\underset{t_k}{\\operatorname{argmax}} \\left\\{ \\hat{J}(t_k) \\right\\}\n    $$\n\n#### 3.4. 最终指标估计\n灵敏度和特异度的最终值是在此最优阈值 $\\hat{t}^\\ast$ 处计算的经验估计值：\n-   $\\widehat{\\operatorname{Se}} = \\widehat{\\operatorname{Se}}(\\hat{t}^\\ast)$\n-   $\\widehat{\\operatorname{Sp}} = \\widehat{\\operatorname{Sp}}(\\hat{t}^\\ast)$\n\n然后为每个测试用例收集三个结果指标 $[\\widehat{\\operatorname{Se}}, \\widehat{\\operatorname{Sp}}, \\widehat{\\mathrm{AUC}}]$。对于给定的种子，整个过程是确定性的，从而确保了可复现性。大样本量（$n_1=n_0=50000$）确保了经验估计值是精确的，并接近其理论对应值。", "answer": "```\n[[0.5028,0.5015,0.5000],[0.6908,0.6923,0.7602],[0.8407,0.8423,0.9213],[0.6387,0.6369,0.6865],[0.9774,0.9775,0.9977]]\n```", "id": "4908600"}]}