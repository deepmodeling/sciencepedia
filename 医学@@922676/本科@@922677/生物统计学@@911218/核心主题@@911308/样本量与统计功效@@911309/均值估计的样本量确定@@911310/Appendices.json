{"hands_on_practices": [{"introduction": "这项实践是估算均值样本量计算的基础。我们将从一个常见场景开始：估算一个比例（例如疾病患病率），这本质上是在估算一个由0和1组成的二元变量的均值。通过这个练习，你将推导出在不同假设下的样本量公式，并理解先验知识（如预期的患病率）如何显著提高研究设计的效率 [@problem_id:4950125]。", "problem": "一个临床流行病学团队计划估计一个二元结果的总体均值，该结果编码为：病原体特异性抗体不存在时为 $a=0$，存在时为 $b=1$。令潜在的总体均值为 $p=\\mathbb{E}[X]$，其中 $X \\in \\{0,1\\}$。该团队将使用基于样本均值 $\\bar{X}$ 的双侧正态近似置信区间来估计均值，置信水平为 $1-\\alpha$ (取 $1-\\alpha=0.95$，因此 $\\alpha=0.05$)，目标半宽为 $d$ (取 $d=0.03$)。假设抽样是独立同分布的，并且有限总体校正可以忽略不计。\n\n从中心极限定理 (CLT) 和通过将标准误乘以标准正态分布的适当分位数所构成的双侧置信区间的定义出发，推导出通用的样本量要求 $n$，以保证区间半宽不超过 $d$。\n\n然后，将您的推导特化到二元情况，此时方差为 $\\sigma^{2}=p(1-p)$，并且：\n\n- 仅使用对任何二元变量 $X \\in \\{0,1\\}$ 都成立的不等式 $\\sigma^{2}\\leq \\frac{1}{4}$，推导出最坏情况下的样本量 $n_{\\text{worst}}$。\n- 当有预期的患病率 $p$ 可用时，使用 $\\sigma^{2}=p(1-p)$ 推导出基于患病率信息的样本量 $n(p)$。\n- 以闭式形式推导出乘法缩减因子 $R(p)=\\frac{n(p)}{n_{\\text{worst}}}$，该因子量化了使用 $p$ 相对于最坏情况能减少多少所需的样本量。\n\n用 $z_{\\alpha/2}$、$d$ 和 $p$ 的闭式解析表达式来表示您的最终答案，其中 $z_{\\alpha/2}$ 表示标准正态分布的上 $\\alpha/2$ 分位数。将您的最终答案以包含 $n_{\\text{worst}}$、$n(p)$ 和 $R(p)$ 的单行矩阵形式提供。不需要进行数值计算，也不需要四舍五入。百分比应以小数形式表示（例如，95% 表示为 $0.95$）。", "solution": "### 推导\n按照指示，推导从中心极限定理 (CLT) 开始。设 $X_1, X_2, \\dots, X_n$ 是从一个均值为 $\\mu$、有限方差为 $\\sigma^2$ 的总体中抽取的 $n$ 个独立同分布的随机变量样本。CLT 表明，对于足够大的样本量 $n$，样本均值 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 的分布近似为正态分布：\n$$\n\\bar{X} \\approx \\mathcal{N}\\left(\\mu, \\frac{\\sigma^2}{n}\\right)\n$$\n将样本均值标准化，得到一个近似于标准正态分布 $\\mathcal{N}(0, 1)$ 的随机变量：\n$$\nZ = \\frac{\\bar{X} - \\mu}{\\sigma / \\sqrt{n}} \\approx \\mathcal{N}(0, 1)\n$$\n总体均值 $\\mu$ 的置信水平为 $1-\\alpha$ 的双侧置信区间是根据枢轴量 $Z$ 构建的。设 $z_{\\alpha/2}$ 是标准正态分布的上 $\\alpha/2$ 分位数，使得 $P(Z > z_{\\alpha/2}) = \\alpha/2$。根据对称性，有 $P(-z_{\\alpha/2} \\le Z \\le z_{\\alpha/2}) = 1-\\alpha$。代入 $Z$ 的表达式可得：\n$$\nP\\left(-z_{\\alpha/2} \\le \\frac{\\bar{X} - \\mu}{\\sigma / \\sqrt{n}} \\le z_{\\alpha/2}\\right) \\approx 1-\\alpha\n$$\n这个不等式可以重新整理以分离出 $\\mu$：\n$$\nP\\left(\\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le \\mu \\le \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\\right) \\approx 1-\\alpha\n$$\n由此得到的 $\\mu$ 的 $(1-\\alpha)$ 置信区间是 $\\left[\\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}, \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\\right]$。该区间的半宽，也称为误差范围，用 $d$ 表示。\n$$\nd = z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n为了找到达到目标半宽 $d$ 所需的样本量 $n$，我们对此方程求解 $n$：\n$$\n\\sqrt{n} = \\frac{z_{\\alpha/2} \\sigma}{d}\n$$\n$$\nn = \\left(\\frac{z_{\\alpha/2} \\sigma}{d}\\right)^2 = \\frac{z_{\\alpha/2}^2 \\sigma^2}{d^2}\n$$\n这是样本量的通用公式。在实践中，总体方差 $\\sigma^2$ 通常是未知的。对于一个二元结果，其中 $X \\in \\{0, 1\\}$，均值是总体比例 $p = \\mathbb{E}[X]$，方差是 $\\sigma^2 = p(1-p)$。\n\n**1. 最坏情况样本量 ($n_{\\text{worst}}$)**\n为了在没有 $p$ 的先验知识的情况下保证半宽最多为 $d$，我们必须使用方差 $\\sigma^2 = p(1-p)$ 的最大可能值。函数 $f(p) = p(1-p)$ 是一个关于 $p$ 的开口向下的二次函数，其最大值在 $p = \\frac{1}{2}$ 时取到。最大值为：\n$$\n\\sigma^2_{\\text{max}} = f\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\\left(1-\\frac{1}{2}\\right) = \\frac{1}{4}\n$$\n将这个最大方差代入样本量公式，得到最坏情况下的样本量 $n_{\\text{worst}}$：\n$$\nn_{\\text{worst}} = \\frac{z_{\\alpha/2}^2 \\sigma^2_{\\text{max}}}{d^2} = \\frac{z_{\\alpha/2}^2 (1/4)}{d^2} = \\frac{z_{\\alpha/2}^2}{4d^2}\n$$\n\n**2. 基于患病率信息的样本量 ($n(p)$)**\n如果可以从先前的研究或专家意见中获得预期的患病率（比例）$p$，我们可以用它来获得更精确的所需样本量估计。我们将 $\\sigma^2 = p(1-p)$ 直接代入通用公式：\n$$\nn(p) = \\frac{z_{\\alpha/2}^2 p(1-p)}{d^2}\n$$\n\n**3. 乘法缩减因子 ($R(p)$)**\n缩减因子 $R(p)$ 量化了与保守的最坏情况相比，使用预期患病率 $p$ 所带来的效率提升。它是基于患病率信息的样本量与最坏情况样本量之比：\n$$\nR(p) = \\frac{n(p)}{n_{\\text{worst}}} = \\frac{\\frac{z_{\\alpha/2}^2 p(1-p)}{d^2}}{\\frac{z_{\\alpha/2}^2}{4d^2}}\n$$\n项 $z_{\\alpha/2}^2$ 和 $d^2$ 相互抵消，表达式简化为：\n$$\nR(p) = \\frac{p(1-p)}{1/4} = 4p(1-p)\n$$\n该因子表明，当 $p=0.5$ 时（此时 $R(0.5) = 4(0.5)(0.5) = 1$），所需样本量最大，并且随着 $p$ 接近 0 或 1 而减小。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{z_{\\alpha/2}^2}{4d^2}  \\frac{z_{\\alpha/2}^2 p(1-p)}{d^2}  4p(1-p)\n\\end{pmatrix}\n}\n$$", "id": "4950125"}, {"introduction": "在生物统计学实践中，我们经常对数据进行变换（如对数变换）以满足正态性或稳定方差的假设。这个练习探讨了一个关键问题：如何在变换后数据的尺度上进行样本量规划，同时确保在原始、可解释的尺度上达到我们期望的精度。你将应用delta方法来连接不同尺度上的置信区间宽度，这是一个在实际研究设计中至关重要的技能 [@problem_id:4950147]。", "problem": "一个临床实验室试图估计一个严格为正的生物标志物 $X$ (单位: $\\mathrm{ng/mL}$) 的总体均值 $\\mu$。一项初步研究表明，工作均值 $\\mu \\approx 50$，总体标准差 $\\sigma \\approx 20$。设计目标是为 $\\mu$ 构建一个双侧 $95\\%$ 置信区间（CI），其在原始尺度上的半宽为 $w = 5$。一种替代的规划方法是基于单调可微变换 $g$，具体为 $g(x) = \\log x$ (自然对数)，意图是在 $g$ 尺度上设定一个置信区间的半宽 $w_g$，然后通过 $g^{-1}$ 反变换得到 $\\mu$ 的置信区间。该实验室使用中心极限定理 (CLT) 来处理样本均值的抽样分布，并使用一阶泰勒近似（delta 方法）来关联原始尺度和变换尺度之间的宽度。在这些假设下，选择正确陈述如何设置 $w_g$ 以使反变换后的置信区间在原始尺度上具有半宽 $w$ 的选项，并说明与直接在原始尺度上进行设计相比，这对所需样本量意味着什么。在适当的情况下，使用 $z_{0.975} = 1.96$，$\\mu = 50$，$\\sigma = 20$ 和 $w = 5$ 进行数值评估。\n\nA. 正确的映射是 $w_g = \\lvert g'(\\mu) \\rvert \\, w$。对于 $g(x) = \\log x$ 和 $\\mu = 50$，这给出 $w_g = \\frac{1}{50} \\cdot 5 = 0.1$。通过此映射，在任一尺度上进行规划都会得到相同的所需样本量，数值上 $n \\approx \\left( \\frac{1.96 \\cdot 20}{5} \\right)^2 \\approx 61.47$，因此向上取整得到 $n = 62$。\n\nB. 因为 $g$ 是单调的，可以在 $g$ 尺度上设置 $w_g = w = 5$，并获得与在原始尺度上规划相同的所需样本量。\n\nC. 正确的映射是 $w_g = \\frac{w}{\\lvert g'(\\mu) \\rvert}$，因此对于 $g(x) = \\log x$ 和 $\\mu = 50$，我们有 $w_g = 250$，这意味着在 $g$ 尺度上的所需样本量远小于原始尺度上的样本量。\n\nD. 即使 $w_g$ 是通过 delta 方法设置的，在对数尺度上进行规划也必然会减少所需的样本量，因为对于 $X0$，$\\mathrm{Var}(\\log X)$ 小于 $\\mathrm{Var}(X)$。\n\nE. 如果在对数尺度上设置 $w_g = 0.1$，则所需样本量为 $n \\approx \\left( \\frac{1.96 \\cdot 20}{0.1} \\right)^2 = 153{,}664$，这远大于原始尺度上的样本量；因此，在变换尺度上进行规划会相对于原始尺度增加 $n$。", "solution": "### 推导\n该问题要求比较两种样本量计算方法。\n\n**方法 1：在原始尺度上进行规划**\n设 $\\bar{X}$ 为来自大小为 $n$ 的样本的样本均值。根据中心极限定理 (CLT)，对于大样本 $n$，$\\bar{X}$ 的抽样分布近似为正态分布：$\\bar{X} \\sim N(\\mu, \\sigma^2/n)$。\n$\\mu$ 的一个双侧 $100(1-\\alpha)\\%$ 置信区间由下式给出：\n$$ \\bar{X} \\pm z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} $$\n该置信区间的半宽为 $w = z_{1-\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}$。\n为达到目标半宽 $w$，所需的样本量 $n$ 为：\n$$ n = \\left( \\frac{z_{1-\\alpha/2} \\sigma}{w} \\right)^2 $$\n使用给定的值：$1-\\alpha = 0.95$，所以 $\\alpha = 0.05$ 且 $z_{1-\\alpha/2} = z_{0.975} = 1.96$。我们有 $\\sigma = 20$ 和 $w = 5$。\n$$ n_{\\text{orig}} = \\left( \\frac{1.96 \\cdot 20}{5} \\right)^2 = \\left( \\frac{39.2}{5} \\right)^2 = (7.84)^2 = 61.4656 $$\n由于样本量必须是整数，我们向上取整得到 $n_{\\text{orig}} = 62$。\n\n**方法 2：在变换尺度上进行规划**\n设 $Y = g(X) = \\log X$。我们想要找到 $\\mu_g = E[Y] \\approx g(\\mu)=\\log \\mu$ 的置信区间。\n首先，我们使用一阶泰勒近似（delta 方法）来求 $Y$ 的方差。\n设 $\\sigma_g^2 = \\mathrm{Var}(Y)$。delta 方法将其近似为：\n$$ \\sigma_g^2 \\approx [g'(\\mu)]^2 \\mathrm{Var}(X) = [g'(\\mu)]^2 \\sigma^2 $$\n对于 $g(x) = \\log x$，其导数为 $g'(x) = 1/x$。在 $x=\\mu$ 处，$g'(\\mu) = 1/\\mu$。\n$$ \\sigma_g^2 \\approx \\left(\\frac{1}{\\mu}\\right)^2 \\sigma^2 = \\left(\\frac{\\sigma}{\\mu}\\right)^2 $$\n在对数尺度上的标准差为 $\\sigma_g \\approx \\frac{\\sigma}{\\mu}$。\n\n接下来，我们按照指定，使用 delta 方法将原始尺度上的半宽 $w$ 与变换尺度上的半宽 $w_g$ 关联起来。$\\mu_g = \\log \\mu$ 的置信区间可用于构建 $\\mu$ 的置信区间。$\\mu_g$ 的对称置信区间形式为 $[\\hat{\\mu}_g - w_g, \\hat{\\mu}_g + w_g]$。通过 $g^{-1}(y) = e^y$ 进行反变换，得到 $\\mu$ 的一个非对称置信区间：$[e^{\\hat{\\mu}_g - w_g}, e^{\\hat{\\mu}_g + w_g}]$。\n问题要求这个反变换后区间的半宽为 $w$。对于非对称区间，“半宽”可能不明确。问题指导我们使用 delta 方法来关联宽度。这对应于线性化。形式为 $[\\bar{X}-w, \\bar{X}+w]$ 的 $\\mu$ 的置信区间被映射为 $g(\\mu)$ 的一个置信区间，其端点为 $g(\\bar{X} \\pm w)$。使用 $g(x)$ 在 $\\bar{X}$ 附近的一阶泰勒展开：\n$$ g(\\bar{X} \\pm w) \\approx g(\\bar{X}) \\pm w \\cdot g'(\\bar{X}) $$\n因此，变换尺度上的半宽为 $w_g \\approx w \\cdot |g'(\\bar{X})|$。由于 $\\bar{X}$ 是 $\\mu$ 的估计量，我们在 $\\mu$ 处进行近似：\n$$ w_g \\approx w \\cdot |g'(\\mu)| $$\n对于 $g(x) = \\log x$，这变为 $w_g = w \\cdot |1/\\mu| = w/\\mu$ (因为 $\\mu0$)。\n\n现在，我们计算在变换尺度上所需的样本量 $n_{\\text{trans}}$。其公式与原始尺度上的公式类似，但使用变换后变量的参数：\n$$ n_{\\text{trans}} = \\left( \\frac{z_{1-\\alpha/2} \\sigma_g}{w_g} \\right)^2 $$\n代入 $\\sigma_g$ 和 $w_g$ 的表达式：\n$$ n_{\\text{trans}} = \\left( \\frac{z_{1-\\alpha/2} (\\sigma/\\mu)}{w/\\mu} \\right)^2 = \\left( \\frac{z_{1-\\alpha/2} \\sigma}{w} \\frac{1/\\mu}{1/\\mu} \\right)^2 = \\left( \\frac{z_{1-\\alpha/2} \\sigma}{w} \\right)^2 $$\n这与 $n_{\\text{orig}}$ 的公式完全相同。\n$$ n_{\\text{trans}} = n_{\\text{orig}} $$\n因此，在 delta 方法近似下，在原始尺度或对数尺度（具有正确映射的宽度）上进行规划，会得到相同的所需样本量。\n\n数值计算：\n$\\mu = 50$，$\\sigma = 20$，$w = 5$。\n$w_g = w/\\mu = 5/50 = 0.1$。\n$\\sigma_g = \\sigma/\\mu = 20/50 = 0.4$。\n$n_{\\text{trans}} = \\left( \\frac{1.96 \\cdot 0.4}{0.1} \\right)^2 = (1.96 \\cdot 4)^2 = (7.84)^2 = 61.4656$。\n向上取整，$n_{\\text{trans}} = 62$。这证实了 $n_{\\text{trans}} = n_{\\text{orig}}$。\n\n### 逐项分析\n\n**A. 正确的映射是 $w_g = \\lvert g'(\\mu) \\rvert \\, w$。对于 $g(x) = \\log x$ 和 $\\mu = 50$，这给出 $w_g = \\frac{1}{50} \\cdot 5 = 0.1$。通过此映射，在任一尺度上进行规划都会得到相同的所需样本量，数值上 $n \\approx \\left( \\frac{1.96 \\cdot 20}{5} \\right)^2 \\approx 61.47$，因此向上取整得到 $n = 62$。**\n- **理由**: 该陈述正确地指出了从 delta 方法推导出的关系 $w_g = |g'(\\mu)|w$。它正确地计算出 $g'(\\mu) = 1/50$ 并随后得到 $w_g = 5/50 = 0.1$。它正确地得出结论，即这种映射导致在两个尺度上样本量相同。样本量的数值计算也是正确的：$n = (1.96 \\cdot 20/5)^2 \\approx 61.47$，向上取整为 $62$。此陈述的所有部分都与我们的推导一致。\n- **结论**: 正确。\n\n**B. 因为 $g$ 是单调的，可以在 $g$ 尺度上设置 $w_g = w = 5$，并获得与在原始尺度上规划相同的所需样本量。**\n- **理由**: 该陈述不正确。原始尺度上的半宽 $w=5$ 的单位是 $\\mathrm{ng/mL}$，而对数尺度上的半宽 $w_g$ 是无单位的。将它们等同在物理上和数学上都是无意义的。单调性确保了置信区间的端点可以被反变换，但这并不成为等同宽度的理由。设置 $w_g = 5$ 将对应于原始尺度上一个极大且不精确的置信区间。\n- **结论**: 不正确。\n\n**C. 正确的映射是 $w_g = \\frac{w}{\\lvert g'(\\mu) \\rvert}$，因此对于 $g(x) = \\log x$ 和 $\\mu = 50$，我们有 $w_g = 250$，这意味着在 $g$ 尺度上的所需样本量远小于原始尺度上的样本量。**\n- **理由**: 所提出的映射 $w_g = w/|g'(\\mu)|$ 是从 delta 方法推导出的正确关系的反向。因此，计算 $w_g = 5 / (1/50) = 250$ 是基于一个错误的前提。一个更大的目标宽度 $w_g$ 确实会导致更小的样本量，但设置 $w_g = 250$ 的前提是根本错误的。\n- **结论**: 不正确。\n\n**D. 即使 $w_g$ 是通过 delta 方法设置的，在对数尺度上进行规划也必然会减少所需的样本量，因为对于 $X0$，$\\mathrm{Var}(\\log X)$ 小于 $\\mathrm{Var}(X)$。**\n- **理由**: 该陈述提出了一个谬误的论点。虽然 $\\mathrm{Var}(\\log X) \\approx (\\sigma/\\mu)^2 = (20/50)^2 = 0.16$ 确实远小于 $\\mathrm{Var}(X) = \\sigma^2 = 400$，但样本量公式取决于标准差与半宽的比率，即 $\\sigma_g/w_g$。如推导所示，delta 方法将 $\\sigma_g$ 和 $w_g$ 都相对于它们在原始尺度上的对应值，按相同的因子 $|g'(\\mu)| = 1/\\mu$ 进行缩放。这个因子会抵消掉，使得所需的样本量完全相同。认为方差越小样本量就越小的假设是不完整的，因为它忽略了目标宽度的变化。\n- **结论**: 不正确。\n\n**E. 如果在对数尺度上设置 $w_g = 0.1$，则所需样本量为 $n \\approx \\left( \\frac{1.96 \\cdot 20}{0.1} \\right)^2 = 153{,}664$，这远大于原始尺度上的样本量；因此，在变换尺度上进行规划会相对于原始尺度增加 $n$。**\n- **理由**: 该陈述在变换尺度上使用了不正确的样本量计算公式。它使用的公式 $n = (z \\cdot \\sigma / w_g)^2$ 错误地将原始尺度上的标准差（$\\sigma=20$）与变换尺度上的半宽（$w_g=0.1$）混合使用。正确的公式是 $n_{\\text{trans}} = (z \\cdot \\sigma_g / w_g)^2$。使用正确的值 $\\sigma_g \\approx \\sigma/\\mu = 0.4$，样本量为 $n_{\\text{trans}} = (1.96 \\cdot 0.4/0.1)^2 \\approx 62$。该选项中显示的计算是有缺陷的，其结论是错误的。\n- **结论**: 不正确。", "answer": "$$\\boxed{A}$$", "id": "4950147"}, {"introduction": "这项最终实践将我们从简单的随机抽样带入更复杂但更现实的世界：两阶段整群抽样。在大型研究中，我们常常先抽取“群组”（如诊所、学校），再在群组内抽取个体，而这项设计会引入额外的变异来源。此练习不仅要求你为这种复杂设计推导样本量，还引入了成本优化的概念，即如何在满足精度要求的前提下，通过优化各阶段的样本分配来最小化总研究预算 [@problem_id:4950146]。", "problem": "在一个旨在估计人群平均收缩压的两阶段整群抽样设计中，您计划抽取 $k$ 个诊所（群组）和每个诊所 $m$ 名患者，所有诊所的样本量相同。每个诊所产生 $c_{0}$ 美元的固定管理成本，每位患者产生 $c_{1}$ 美元的边际成本。根据先验数据，假设一个随机效应模型 $Y_{ij} = \\mu + B_{i} + E_{ij}$，其中 $B_{i}$ 在诊所间独立，均值为 $0$，方差为 $\\sigma_{b}^{2}$；$E_{ij}$ 在诊所内部和诊所之间独立，均值为 $0$，方差为 $\\sigma_{w}^{2}$。假设 $B_{i}$ 和 $E_{ij}$ 相互独立。您要求人群均值的双侧 $(1-\\alpha)$ 置信区间（CI）的半宽度为 $w$（单位为 $\\mathrm{mmHg}$）。使用大样本正态近似。\n\n给定科学上合理的数值 $\\sigma_{b}^{2} = 9$ $\\mathrm{mmHg}^{2}$，$\\sigma_{w}^{2} = 36$ $\\mathrm{mmHg}^{2}$，$c_{0} = 400$ 美元，以及 $c_{1} = 4$ 美元，请完成以下任务：\n\n- 从所述随机效应模型下独立和与均值的方差性质出发，推导在抽取 $k$ 个诊所、每个诊所抽取 $m$ 名患者（每个诊所的 $m$ 相等）时，所有抽样单元总均值的抽样方差。\n- 通过大样本正态近似将此抽样方差与置信区间半宽度 $w$ 联系起来，并构建一个在满足半宽度要求的约束下最小化总成本的约束优化问题。\n- 求解此优化问题，得到连续最优解 $k^{\\star}$ 和 $m^{\\star}$（忽略整数约束），并以 $z_{1-\\alpha/2}$ 和 $w$ 的闭式形式报告您的最终表达式（在适用时）。\n\n将您的最终答案表示为行矩阵 $\\left(k^{\\star},\\,m^{\\star}\\right)$，并以 $\\mathrm{mmHg}$ 表示 $w$。无需四舍五入。", "solution": "该问题要求在两阶段整群抽样设计中对抽样单元进行最优分配，以在满足对总体均值估计的精度约束下，最小化总成本。我们已知一个随机效应模型、成本参数和方差分量。我们将通过首先推导样本均值的方差，然后构建约束优化问题，最后使用拉格朗日乘数法求解连续变量来解决这个问题。\n\n第 $i$ 个诊所中第 $j$ 位患者的收缩压 $Y_{ij}$ 的统计模型由下式给出：\n$$Y_{ij} = \\mu + B_i + E_{ij}$$\n其中 $\\mu$ 是总体均值，$B_i$ 是诊所 $i$ 的随机效应，满足 $E[B_i] = 0$ 和 $\\mathrm{Var}(B_i) = \\sigma_b^2$，$E_{ij}$ 是诊所 $i$ 中患者 $j$ 的随机误差，满足 $E[E_{ij}] = 0$ 和 $\\mathrm{Var}(E_{ij}) = \\sigma_w^2$。所有的 $B_i$ 和 $E_{ij}$ 都相互独立。\n\n总体均值 $\\mu$ 的估计量是来自 $k$ 个诊所、每个诊所 $m$ 名患者样本的所有观测值的总均值 $\\bar{Y}$。\n$$\\bar{Y} = \\frac{1}{km} \\sum_{i=1}^{k} \\sum_{j=1}^{m} Y_{ij}$$\n将模型代入 $\\bar{Y}$ 的表达式中：\n$$\\bar{Y} = \\frac{1}{km} \\sum_{i=1}^{k} \\sum_{j=1}^{m} (\\mu + B_i + E_{ij}) = \\mu + \\frac{1}{k} \\sum_{i=1}^{k} B_i + \\frac{1}{km} \\sum_{i=1}^{k} \\sum_{j=1}^{m} E_{ij}$$\n由于 $E[B_i]=0$ 且 $E[E_{ij}]=0$，该估计量是无偏的。\n\n$\\bar{Y}$ 的抽样方差，记为 $\\mathrm{Var}(\\bar{Y})$，是利用独立随机变量和的方差性质推导出来的：\n$$\\mathrm{Var}(\\bar{Y}) = \\mathrm{Var}\\left(\\frac{1}{k} \\sum_{i=1}^{k} B_i\\right) + \\mathrm{Var}\\left(\\frac{1}{km} \\sum_{i=1}^{k} \\sum_{j=1}^{m} E_{ij}\\right)$$\n$$\\mathrm{Var}(\\bar{Y}) = \\frac{1}{k^2} \\sum_{i=1}^{k} \\mathrm{Var}(B_i) + \\frac{1}{(km)^2} \\sum_{i=1}^{k} \\sum_{j=1}^{m} \\mathrm{Var}(E_{ij})$$\n代入给定的方差 $\\mathrm{Var}(B_i) = \\sigma_b^2$ 和 $\\mathrm{Var}(E_{ij}) = \\sigma_w^2$：\n$$\\mathrm{Var}(\\bar{Y}) = \\frac{1}{k^2} (k \\sigma_b^2) + \\frac{1}{(km)^2} (km \\sigma_w^2) = \\frac{\\sigma_b^2}{k} + \\frac{\\sigma_w^2}{km}$$\n这就是总均值的抽样方差。\n\n接下来，我们将此方差与置信区间（CI）半宽度 $w$ 联系起来。使用大样本正态近似，$\\mu$ 的一个双侧 $(1-\\alpha)$ 置信区间由 $\\bar{Y} \\pm z_{1-\\alpha/2} \\sqrt{\\mathrm{Var}(\\bar{Y})}$ 给出。因此，半宽度 $w$ 为：\n$$w = z_{1-\\alpha/2} \\sqrt{\\frac{\\sigma_b^2}{k} + \\frac{\\sigma_w^2}{km}}$$\n两边平方，得到精度约束：\n$$\\frac{w^2}{z_{1-\\alpha/2}^2} = \\frac{\\sigma_b^2}{k} + \\frac{\\sigma_w^2}{km}$$\n\n研究的总成本 $C$ 是 $k$ 和 $m$ 的函数：\n$$C(k,m) = c_0 k + c_1 km$$\n问题是在满足精度约束的条件下最小化 $C(k,m)$。我们将其构建为一个约束优化问题。为方便起见，令 $V_0 = \\frac{w^2}{z_{1-\\alpha/2}^2}$，这是估计量 $\\bar{Y}$ 的目标方差。\n最小化：$C(k,m) = c_0 k + c_1 km$\n约束条件：$g(k,m) = \\frac{\\sigma_b^2}{k} + \\frac{\\sigma_w^2}{km} - V_0 = 0$\n\n我们使用拉格朗日乘数法，将 $k$ 和 $m$ 视为连续变量。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\\mathcal{L}(k,m,\\lambda) = C(k,m) + \\lambda g(k,m) = c_0 k + c_1 km + \\lambda \\left( \\frac{\\sigma_b^2}{k} + \\frac{\\sigma_w^2}{km} - V_0 \\right)$$\n我们通过将关于 $k$、$m$ 和 $\\lambda$ 的偏导数设为零来找到临界点。\n$$\\frac{\\partial \\mathcal{L}}{\\partial k} = c_0 + c_1 m - \\lambda \\left( \\frac{\\sigma_b^2}{k^2} + \\frac{\\sigma_w^2}{k^2 m} \\right) = 0 \\quad (1)$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial m} = c_1 k - \\lambda \\frac{\\sigma_w^2}{k m^2} = 0 \\quad (2)$$\n由方程 $(2)$，因为 $c_1, k, \\sigma_w^2  0$：\n$$c_1 k = \\frac{\\lambda \\sigma_w^2}{k m^2} \\implies \\lambda = \\frac{c_1 k^2 m^2}{\\sigma_w^2}$$\n将 $\\lambda$ 的这个表达式代入方程 $(1)$：\n$$c_0 + c_1 m = \\frac{c_1 k^2 m^2}{\\sigma_w^2} \\left( \\frac{\\sigma_b^2}{k^2} + \\frac{\\sigma_w^2}{k^2 m} \\right) = \\frac{c_1 m^2}{\\sigma_w^2} \\left( \\sigma_b^2 + \\frac{\\sigma_w^2}{m} \\right)$$\n$$c_0 + c_1 m = \\frac{c_1 \\sigma_b^2}{\\sigma_w^2} m^2 + c_1 m$$\n$$c_0 = \\frac{c_1 \\sigma_b^2}{\\sigma_w^2} m^2$$\n求解 $m$ 得到每个诊所的最优样本量 $m^\\star$：\n$$m^{\\star 2} = \\frac{c_0 \\sigma_w^2}{c_1 \\sigma_b^2} \\implies m^\\star = \\sqrt{\\frac{c_0 \\sigma_w^2}{c_1 \\sigma_b^2}} = \\frac{\\sigma_w}{\\sigma_b} \\sqrt{\\frac{c_0}{c_1}}$$\n为了求出最优诊所数 $k^\\star$，我们将 $m^\\star$ 代回约束方程：\n$$\\frac{\\sigma_b^2}{k^\\star} + \\frac{\\sigma_w^2}{k^\\star m^\\star} = V_0 \\implies \\frac{1}{k^\\star} \\left(\\sigma_b^2 + \\frac{\\sigma_w^2}{m^\\star}\\right) = V_0$$\n$$k^\\star = \\frac{1}{V_0} \\left(\\sigma_b^2 + \\frac{\\sigma_w^2}{m^\\star}\\right) = \\frac{z_{1-\\alpha/2}^2}{w^2} \\left(\\sigma_b^2 + \\frac{\\sigma_w^2}{m^\\star}\\right)$$\n现在我们代入给定的数值：$\\sigma_b^2 = 9$，$\\sigma_w^2 = 36$，$c_0 = 400$，以及 $c_1 = 4$。\n由此，我们得到 $\\sigma_b = \\sqrt{9} = 3$ 和 $\\sigma_w = \\sqrt{36} = 6$。\n首先，我们计算 $m^\\star$ 的数值：\n$$m^\\star = \\frac{6}{3} \\sqrt{\\frac{400}{4}} = 2 \\sqrt{100} = 2 \\times 10 = 20$$\n接下来，我们将 $m^\\star = 20$ 的值代入其公式，以求得 $k^\\star$ 的表达式：\n$$k^\\star = \\frac{z_{1-\\alpha/2}^2}{w^2} \\left(9 + \\frac{36}{20}\\right) = \\frac{z_{1-\\alpha/2}^2}{w^2} \\left(9 + \\frac{9}{5}\\right)$$\n$$k^\\star = \\frac{z_{1-\\alpha/2}^2}{w^2} \\left(\\frac{45}{5} + \\frac{9}{5}\\right) = \\frac{z_{1-\\alpha/2}^2}{w^2} \\left(\\frac{54}{5}\\right)$$\n连续最优样本量的最终表达式为 $m^\\star = 20$ 和 $k^\\star = \\frac{54}{5} \\frac{z_{1-\\alpha/2}^2}{w^2}$。题目要求以行矩阵 $(k^\\star, m^\\star)$ 的形式给出答案。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{54}{5} \\frac{z_{1-\\alpha/2}^2}{w^2}  20 \\end{pmatrix}}\n$$", "id": "4950146"}]}