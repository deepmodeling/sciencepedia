{"hands_on_practices": [{"introduction": "在方差分析（ANOVA）发现组间存在显著差异后，研究者往往希望进一步探究具体哪些组别之间存在差异。这个过程涉及到多重成对比较，但首先我们需要回答一个基本问题：到底有多少对比较需要进行？这个练习将通过基本的组合学原理，推导出计算成对比较总数的通用公式，这对于理解和控制族群错误率（Family-Wise Error Rate, FWER）至关重要。[@problem_id:4938861]", "problem": "一位生物统计学家在一项关于抗高血压药物的随机临床研究中，对$k$个独立的治疗组进行单因素方差分析。在发现一个统计上显著的总体结果后，该生物统计学家计划应用多重比较程序，如Tukey's HSD（Honestly Significant Difference）和Bonferroni方法。这些程序需要计算组间不同成对均值比较的次数，以校准族错误率（FWER）。\n\n仅使用基本计数原理和成对比较的定义——即两个不同组均值之间的无序比较（排除自身比较，且组$A$与组$B$的比较等同于组$B$与组$A$的比较）——推导出一个关于$k$的函数，该函数表示不同成对均值比较的总数。然后，计算当$k=7$时这个数值。\n\n最终答案以一个实数表示。无需四舍五入。", "solution": "该问题要求推导一个计算$k$个组之间不同成对比较数量的通用公式，并计算当$k=7$时的具体数值。问题陈述为成对比较提供了一个精确的定义：两个不同组均值之间的无序比较。\n\n设$k$个治疗组的集合为$G = \\{G_1, G_2, \\dots, G_k\\}$。一次成对比较涉及从这个集合中选择两个不同的组。比较是“无序”的条件意味着组$G_i$与组$G_j$之间的比较等同于组$G_j$与组$G_i$之间的比较。各组必须是“不同”的条件意味着$i \\neq j$，这有效地排除了如$G_i$对$G_i$这样的自身比较。\n\n这个问题是一个经典的组合问题，即从一个包含$k$个元素的集合中选出一个包含2个元素的子集。从一个包含$n$个元素的集合中选择$r$个元素而不考虑选择顺序的方法数由二项式系数给出，记作$\\binom{n}{r}$。\n\n在我们的具体情境中，我们是从一个包含$n=k$个组的集合中选择$r=2$个组。因此，不同成对比较的总数（我们可以用$C$表示）由以下公式给出：\n$$ C = \\binom{k}{2} $$\n\n二项式系数的公式是：\n$$ \\binom{n}{r} = \\frac{n!}{r!(n-r)!} $$\n将$n=k$和$r=2$代入，我们得到$C$作为$k$的函数的解析表达式：\n$$ C(k) = \\binom{k}{2} = \\frac{k!}{2!(k-2)!} $$\n\n我们可以通过将阶乘项$k!$展开为$k \\times (k-1) \\times (k-2)!$来简化这个表达式：\n$$ C(k) = \\frac{k(k-1)(k-2)!}{2!(k-2)!} $$\n分子和分母中的$(k-2)!$项可以消去。由于$2! = 2 \\times 1 = 2$，表达式简化为：\n$$ C(k) = \\frac{k(k-1)}{2} $$\n这就是所要求的不同成对均值比较总数的解析表达式。\n\n这个结果也可以从基本计数原理推导出来。为了形成一对不同的组，我们首先从$k$个可用组中选择一个组。第一次选择有$k$种选择。选择一个组后，还有$k-1$个剩余的组可供选择第二个组。这似乎表明有$k(k-1)$个可能的对。然而，这个过程计算的是有序对。例如，它将对$(G_1, G_2)$与对$(G_2, G_1)$视为不同的。问题陈述指明比较是无序的，意味着组$A$与组$B$的比较等同于组$B$与组$A$的比较。由于在有序计数过程中，每一对不同的组都被精确地计算了两次（一次作为$(G_i, G_j)$，一次作为$(G_j, G_i)$），我们必须将有序对的总数除以2，以得到唯一的、无序的对的数量。\n$$ C(k) = \\frac{k(k-1)}{2} $$\n这证实了我们之前使用二项式系数的推导。\n\n问题的第二部分要求计算当研究有$k=7$个治疗组时这个数值。我们将$k=7$代入我们推导出的公式：\n$$ C(7) = \\frac{7(7-1)}{2} $$\n$$ C(7) = \\frac{7 \\times 6}{2} $$\n$$ C(7) = \\frac{42}{2} $$\n$$ C(7) = 21 $$\n\n因此，对于一个有7个治疗组的研究，在进行如Tukey's HSD等事后分析或应用Bonferroni校正时，需要考虑21个不同的成对均值比较。", "answer": "$$\\boxed{21}$$", "id": "4938861"}, {"introduction": "知道了需要进行的比较次数后，我们就必须控制因多重检验而膨胀的I类错误（假阳性）概率。Bonferroni 校正是控制族群错误率最直接和通用的方法之一，它通过调整单个检验的显著性水平来实现。本练习将带你从第一性原理出发，应用 Bonferroni 校正来分析一组假设的 p 值，并做出统计决策。[@problem_id:4938829]", "problem": "一项生物统计学研究使用单向方差分析（ANOVA）比较 $k$ 个治疗组的平均血清生物标志物水平。研究使用双样本 $t$ 检验对所有组进行事后成对比较，得到所有成对比较的 $m=10$ 个原始 $p$ 值：$p=(0.001,\\,0.02,\\,0.07,\\,0.11,\\,0.23,\\,0.045,\\,0.0045,\\,0.39,\\,0.003,\\,0.12)$。研究者希望在这 $m$ 个比较中将族系误差率（FWER）控制在 $\\alpha=0.05$ 的水平。请从概率的联合界和 FWER 的定义出发，推导 Bonferroni 族系控制方法以及针对 $m$ 个同时检验的相应调整后 $p$ 值映射。然后将此调整应用于给定的原始 $p$ 值，并确定在 $\\alpha=0.05$ 水平下被拒绝的成对原假设的总数。最终数值答案仅报告被拒绝的总数。无需四舍五入。请基于第一性原理，简要说明为什么在这种情况下，与 Tukey、Scheffé 或 Dunnett 程序相比，Bonferroni 方法是适用的，且无需使用问题陈述中的任何捷径公式。", "solution": "该问题被评估为有效。它在科学上基于统计假设检验的原理，问题提出得当，信息充分，可得到唯一解，且表述客观。\n\n该问题要求推导用于控制族系误差率（FWER）的 Bonferroni 校正，将其应用于一组给定的 $p$ 值，计算由此产生的拒绝次数，并说明其使用的理由。\n\n首先，我们从第一性原理推导 Bonferroni 校正。假设有一个包含 $m$ 个原假设的族，记为 $H_{0,i}$，其中 $i \\in \\{1, 2, \\dots, m\\}$。族系误差率（FWER）定义为犯至少一个 I 类错误的概率。I 类错误是指拒绝一个真实的原假设的事件。设 $I_0$ 为索引集合 $\\{1, 2, \\dots, m\\}$ 的一个子集，对于该子集中的所有索引 $i$，其对应的原假设 $H_{0,i}$ 为真。那么 FWER 为：\n$$\n\\text{FWER} = P\\left(\\bigcup_{i \\in I_0} \\{\\text{拒绝 } H_{0,i}\\}\\right)\n$$\n由于在实际实验环境中集合 $I_0$ 是未知的，我们通过限定拒绝 $m$ 个假设中任意一个的概率来控制 FWER，这是对真实 FWER 的一个保守上界：\n$$\n\\text{FWER} \\le P\\left(\\bigcup_{i=1}^{m} \\{\\text{拒绝 } H_{0,i}\\}\\right)\n$$\n我们引用联合界，也称为 Boole 不等式，该不等式指出，对于任意事件集合 $A_1, A_2, \\dots, A_m$，其并集的概率小于或等于它们各自概率的总和：$P(\\cup_{i=1}^m A_i) \\le \\sum_{i=1}^m P(A_i)$。将此应用于我们 FWER 上界的表达式，其中 $A_i$ 是事件 {拒绝 $H_{0,i}$}：\n$$\n\\text{FWER} \\le \\sum_{i=1}^{m} P(\\text{拒绝 } H_{0,i})\n$$\n对于单个假设检验 $i$，如果其相关的 $p$ 值 $p_i$ 小于或等于选定的显著性水平 $\\alpha_i$，我们就拒绝 $H_{0,i}$。在原假设为真的情况下，拒绝它的概率由这个水平控制：$P(\\text{拒绝 } H_{0,i} | H_{0,i} \\text{ 为真}) = \\alpha_i$。因此，对于任何 $i$，$P(\\text{拒绝 } H_{0,i}) \\le \\alpha_i$。将此代入不等式得到：\n$$\n\\text{FWER} \\le \\sum_{i=1}^{m} \\alpha_i\n$$\n为了将整体 FWER 控制在期望的水平 $\\alpha$，我们必须确保 $\\sum_{i=1}^{m} \\alpha_i \\le \\alpha$。满足此条件的最简单和最通用的方法是为每个单独的检验设置相等的显著性水平，即对所有 $i$ 都有 $\\alpha_i = \\alpha^*$。这得出：\n$$\nm \\alpha^* \\le \\alpha \\implies \\alpha^* \\le \\frac{\\alpha}{m}\n$$\nBonferroni 程序将这个单独的显著性阈值设置为 $\\alpha^* = \\frac{\\alpha}{m}$。因此，决策规则是：如果原假设 $H_{0,i}$ 的原始 $p$ 值 $p_i \\le \\frac{\\alpha}{m}$，则拒绝该原假设。\n\n相应的调整后 $p$ 值 $p_i^{\\text{adj}}$ 定义为能够拒绝假设 $H_{0,i}$ 的最小 FWER 水平 $\\alpha$。根据 Bonferroni 法则，如果 $p_i \\le \\frac{\\alpha}{m}$，我们就拒绝假设，这等价于 $\\alpha \\ge m \\cdot p_i$。满足此不等式的最小 $\\alpha$ 值为 $\\alpha = m \\cdot p_i$。由于概率不能超过 1，Bonferroni 调整后的 $p$ 值正式定义为：\n$$\np_i^{\\text{adj}} = \\min(m \\cdot p_i, 1)\n$$\n如果一个假设的调整后 $p$ 值小于或等于期望的 FWER 水平，即 $p_i^{\\text{adj}} \\le \\alpha$，则该假设被拒绝。\n\n现在，我们将此方法应用于给定的问题。我们有 $m=10$ 次成对比较和期望的 FWER 为 $\\alpha=0.05$。对每个单独检验进行 Bonferroni 校正后的显著性水平是：\n$$\n\\alpha^* = \\frac{\\alpha}{m} = \\frac{0.05}{10} = 0.005\n$$\n原始 $p$ 值集合为 $p=(0.001, 0.02, 0.07, 0.11, 0.23, 0.045, 0.0045, 0.39, 0.003, 0.12)$。我们必须将每个原始 $p$ 值与校正后的阈值 $\\alpha^*=0.005$ 进行比较，并计算被拒绝的假设数量。\n1. $p_1 = 0.001 \\le 0.005 \\implies$ 拒绝 $H_{0,1}$\n2. $p_2 = 0.02 > 0.005 \\implies$ 不拒绝 $H_{0,2}$\n3. $p_3 = 0.07 > 0.005 \\implies$ 不拒绝 $H_{0,3}$\n4. $p_4 = 0.11 > 0.005 \\implies$ 不拒绝 $H_{0,4}$\n5. $p_5 = 0.23 > 0.005 \\implies$ 不拒绝 $H_{0,5}$\n6. $p_6 = 0.045 > 0.005 \\implies$ 不拒绝 $H_{0,6}$\n7. $p_7 = 0.0045 \\le 0.005 \\implies$ 拒绝 $H_{0,7}$\n8. $p_8 = 0.39 > 0.005 \\implies$ 不拒绝 $H_{0,8}$\n9. $p_9 = 0.003 \\le 0.005 \\implies$ 拒绝 $H_{0,9}$\n10. $p_{10} = 0.12 > 0.005 \\implies$ 不拒绝 $H_{0,10}$\n\n对应原始 $p$ 值为 $0.001$、$0.0045$ 和 $0.003$ 的假设被拒绝。被拒绝的成对原假设总数为 $3$。\n\n最后，我们说明 Bonferroni 方法的适用性。Bonferroni 校正的推导仅依赖于概率的联合界。这使其普遍适用于任何包含 $m$ 个假设检验的集合，因为它对检验之间的依赖结构或生成 $p$ 值的数据性质不做任何假设。相比之下，其他方法则更为专门化：\n- **Tukey's HSD** 是专门为方差分析（ANOVA）后检验所有成对比较而设计的。其有效性取决于 ANOVA 模型的假设，如正态性、观测独立性和方差齐性，并且在各组样本量相等时表现最佳。本题仅提供了最终的 $p$ 值，并未确认这些基本假设是否得到满足。\n- **Scheffé's Method** 旨在为组均值之间的所有可能的线性组合（contrast）控制 FWER，而不仅仅是成对比较。如果唯一的目标是检验所有成对差异，那么这种方法就过于保守了。\n- **Dunnett's Method** 是为将多个处理组与单个对照组进行比较的特定情况而设计的，而不是用于所有组之间的所有可能成对比较。\n鉴于问题只提供了一组 $p$ 值和控制 $m$ 个同时检验的 FWER 的总目标，从第一性原理出发，Bonferroni 方法是最合适的程序，因为其有效性不依赖于所提供信息之外的任何信息。", "answer": "$$\\boxed{3}$$", "id": "4938829"}, {"introduction": "虽然 Bonferroni 校正普适性强，但有时会过于保守，导致我们错过一些真实的差异。当我们的目标是在 ANOVA 之后检验所有成对比较时，Tukey–Kramer 方法提供了更高的统计功效，并且它能灵活处理各组样本量不相等的情况。通过这个练习，你将学会如何计算 Tukey–Kramer 检验的“临界差”，这是判断组间均值差异是否显著的标尺。[@problem_id:4938779]", "problem": "一个生物统计学团队对一项临床试验进行了方差分析(ANOVA)，比较了 $k=6$ 个处理组，各组样本量不等，分别为 $n=(8,12,9,15,10,11)$。组内均方误差为 $MSE=7.1$，残差自由度为 $df=60$。为了将所有成对比较的族系误差率控制在 $\\alpha=0.05$，他们计划使用 Tukey–Kramer 方法。实验室的统计软件报告称，在这些设置下（$k=6$，$df=60$，$\\alpha=0.05$），学生化全距临界值为 $q^{\\star}=4.05$。\n\n从误差呈正态分布和各组间方差相等的标准方差分析假设出发，推导出一对组均值的 Tukey–Kramer 临界差异，然后计算由三个最小样本量组成的三对组合的 Tukey–Kramer 临界差异，具体为样本量为 $(n_i,n_j)=(8,9)$、$(8,10)$ 和 $(9,10)$ 的配对。将每个临界差异四舍五入到四位有效数字。按 $(8,9)$、$(8,10)$、$(9,10)$ 的顺序提供您的三个数值答案。", "solution": "该问题经检验是合理且表述清晰的。计算所需统计量所需的所有必要数据均已提供。尽管给出的残差自由度 ($df=60$) 与根据给定样本量计算出的值 ($df = \\sum n_i - k = (8+12+9+15+10+11) - 6 = 65 - 6 = 59$) 之间存在微小不一致，但问题明确提供了 $df=60$ 以及相应的学生化全距临界值 $q^{\\star}=4.05$。按照惯例，应使用给定的参数进行计算，因为它们构成了一个自洽且可解的问题集。在使用统计表或软件插值时，使用相邻的整数自由度值（例如，用 $60$ 代替 $59$）是常见的做法，这并不会使问题的结构失效。\n\n目标是为具有不等样本量的特定组对推导并计算 Tukey-Kramer 临界差异。Tukey-Kramer 方法是 Tukey 真实显著性差异 (HSD) 检验的一种改编，旨在处理样本量不等的情况，同时在方差分析后对所有成对比较控制族系误差率 (FWER)。\n\n该方法的核心是学生化全距统计量 $q$，对于组 $i$ 的均值 ($\\bar{y}_i$) 和组 $j$ 的均值 ($\\bar{y}_j$) 之间的比较，其定义为：\n$$\nq = \\frac{|\\bar{y}_i - \\bar{y}_j|}{SE_{ij}}\n$$\n其中 $SE_{ij}$ 是两个均值之差的标准误。在方差分析的方差齐性（所有组的方差 $\\sigma^2$ 相同）的标准假设下，$\\sigma^2$ 的最佳估计是组内均方误差 $MSE$。\n\n两个独立样本均值之差的方差是它们各自方差的和：\n$$\n\\text{Var}(\\bar{y}_i - \\bar{y}_j) = \\text{Var}(\\bar{y}_i) + \\text{Var}(\\bar{y}_j) = \\frac{\\sigma^2}{n_i} + \\frac{\\sigma^2}{n_j} = \\sigma^2 \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)\n$$\n用 $MSE$ 估计 $\\sigma^2$，差值的标准误为：\n$$\nSE_{ij} = \\sqrt{MSE \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)}\n$$\nTukey-Kramer 检验统计量调整了此标准误以适应学生化全距分布。成对比较的统计量通常表示为：\n$$\nq_{ij} = \\frac{|\\bar{y}_i - \\bar{y}_j|}{\\sqrt{\\frac{MSE}{2} \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)}}\n$$\n如果计算出的统计量 $q_{ij}$ 超过了来自学生化全距分布的临界值 $q^{\\star}_{\\alpha, k, df}$，则均值之差 $|\\bar{y}_i - \\bar{y}_j|$ 在 $\\alpha$ 水平上被认为是统计显著的，其中 $k$ 是组数，$df$ 是残差自由度。\n\nTukey-Kramer 临界差异，可记为 $CD_{ij}$，是被认为显著的两个均值之间的最小绝对差值。它是通过对显著性检验的不等式进行重新排列而得出的：\n$$\nCD_{ij} = q^{\\star}_{\\alpha, k, df} \\sqrt{\\frac{MSE}{2} \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)}\n$$\n这是 Tukey-Kramer 临界差异的通用公式。\n\n我们已知以下数值：\n组数，$k=6$。\n组内均方误差，$MSE=7.1$。\n残差自由度，$df=60$。\n族系误差率，$\\alpha=0.05$。\n学生化全距临界值，$q^{\\star} = 4.05$。\n\n我们需要为样本量配对为 $(n_i, n_j)$ 的三组：$(8, 9)$、$(8, 10)$ 和 $(9, 10)$ 计算 $CD_{ij}$。\n\n情况1：样本量配对为 $(n_i, n_j) = (8, 9)$。\n$$\nCD_{8,9} = 4.05 \\sqrt{\\frac{7.1}{2} \\left(\\frac{1}{8} + \\frac{1}{9}\\right)}\n$$\n$$\nCD_{8,9} = 4.05 \\sqrt{3.55 \\left(\\frac{9+8}{72}\\right)} = 4.05 \\sqrt{3.55 \\left(\\frac{17}{72}\\right)}\n$$\n$$\nCD_{8,9} = 4.05 \\sqrt{0.8381944...} = 4.05 \\times 0.915530...\n$$\n$$\nCD_{8,9} = 3.70789...\n$$\n四舍五入到四位有效数字，我们得到 $3.708$。\n\n情况2：样本量配对为 $(n_i, n_j) = (8, 10)$。\n$$\nCD_{8,10} = 4.05 \\sqrt{\\frac{7.1}{2} \\left(\\frac{1}{8} + \\frac{1}{10}\\right)}\n$$\n$$\nCD_{8,10} = 4.05 \\sqrt{3.55 \\left(\\frac{10+8}{80}\\right)} = 4.05 \\sqrt{3.55 \\left(\\frac{18}{80}\\right)}\n$$\n$$\nCD_{8,10} = 4.05 \\sqrt{0.79875} = 4.05 \\times 0.893728...\n$$\n$$\nCD_{8,10} = 3.6196...\n$$\n四舍五入到四位有效数字，我们得到 $3.620$。\n\n情况3：样本量配对为 $(n_i, n_j) = (9, 10)$。\n$$\nCD_{9,10} = 4.05 \\sqrt{\\frac{7.1}{2} \\left(\\frac{1}{9} + \\frac{1}{10}\\right)}\n$$\n$$\nCD_{9,10} = 4.05 \\sqrt{3.55 \\left(\\frac{10+9}{90}\\right)} = 4.05 \\sqrt{3.55 \\left(\\frac{19}{90}\\right)}\n$$\n$$\nCD_{9,10} = 4.05 \\sqrt{0.749444...} = 4.05 \\times 0.865704...\n$$\n$$\nCD_{9,10} = 3.5061...\n$$\n四舍五入到四位有效数字，我们得到 $3.506$。\n\n按照对 $(8,9)$、$(8,10)$ 和 $(9,10)$ 配对的要求排序，三个临界差异分别为 $3.708$、$3.620$ 和 $3.506$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.708  3.620  3.506\n\\end{pmatrix}\n}\n$$", "id": "4938779"}]}