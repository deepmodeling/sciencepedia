{"hands_on_practices": [{"introduction": "方差分析的核心在于将数据的总变异分解为不同变异来源。这个基础练习将指导你完成单因素方差分析（ANOVA）的全过程，从原始摘要统计数据（样本量、均值和方差）出发，亲手构建方差分析表。通过计算组间和组内平方和、自由度、均方，并最终得到 $F$ 统计量，你将深刻理解变异分解的原理。[@problem_id:4957544]", "problem": "一位生物统计学家正在使用单因素方差分析 (ANOVA) 研究四种独立基因型的酶活性，该活性以任意活性单位衡量。对于每种基因型，报告的样本量、样本均值和无偏样本方差如下：基因型 $1$：$n_{1}=15$，$\\bar{x}_{1}=12.0$，$s_{1}^{2}=1.2$；基因型 $2$：$n_{2}=15$，$\\bar{x}_{2}=11.5$，$s_{2}^{2}=0.9$；基因型 $3$：$n_{3}=15$，$\\bar{x}_{3}=10.0$，$s_{3}^{2}=1.5$；基因型 $4$：$n_{4}=15$，$\\bar{x}_{4}=13.0$，$s_{4}^{2}=2.1$。假设采用标准的单因素设计，误差独立且服从正态分布，并且在各基因型之间具有共同方差。从可归因于组间差异和组内离散的变异性的核心定义出发，通过将总变异性分解为“组间”和“组内”分量来构建ANOVA表，并将每个分量与其相应的自由度进行匹配。然后，计算用于检验基因型均值是否相等的ANOVA $F$统计量。\n\n将您的最终数值答案四舍五入至四位有效数字。", "solution": "### 解答\n方差分析（ANOVA）的核心原理是将数据集中的总变异性分解为归因于不同变异来源的分量。在单因素ANOVA中，总平方和 ($SST$)被分解为组间平方和 ($SSB$)和组内平方和 ($SSW$)。\n\n$$SST = SSB + SSW$$\n\n$SSB$分量衡量各组均值围绕总均值的变异性，代表处理或因素（本例中为基因型）的效应。$SSW$分量衡量每个组内个体观测值的合并变异性，代表随机误差或未解释的离散。\n\n首先，我们确定分析所需的常数。\n- 组数为 $k=4$。\n- 所有组的样本量相等：$n_1=n_2=n_3=n_4=15$。\n- 总观测数为 $N = \\sum_{i=1}^{k} n_i = 15+15+15+15 = 60$。\n\n接着，我们计算总均值 $\\bar{x}_{grand}$，即所有观测值的均值。对于所有 $n_i$ 都相等的均衡设计，这可以简化为组均值的平均值。\n$$ \\bar{x}_{grand} = \\frac{1}{N} \\sum_{i=1}^{k} n_i \\bar{x}_i = \\frac{1}{4} \\sum_{i=1}^{4} \\bar{x}_i $$\n$$ \\bar{x}_{grand} = \\frac{12.0 + 11.5 + 10.0 + 13.0}{4} = \\frac{46.5}{4} = 11.625 $$\n\n现在，我们计算平方和。\n\n1.  **组内平方和 ($SSW$)**：这代表合并的组内离散。它是观测值与其各自组均值之差的平方和的总和。第 $i$ 组的无偏样本方差由公式 $s_i^2 = \\frac{1}{n_i-1} \\sum_{j=1}^{n_i} (x_{ij} - \\bar{x}_i)^2$ 给出。因此，第 $i$ 组的平方和为 $(n_i-1)s_i^2$。总的 $SSW$ 是所有组这些值的总和。\n    $$ SSW = \\sum_{i=1}^{k} (n_i-1) s_i^2 $$\n    $$ SSW = (15-1)(1.2) + (15-1)(0.9) + (15-1)(1.5) + (15-1)(2.1) $$\n    $$ SSW = 14(1.2 + 0.9 + 1.5 + 2.1) = 14(5.7) = 79.8 $$\n\n2.  **组间平方和 ($SSB$)**：这代表可归因于组均值之间差异的变异性。它是各组均值与总均值之差的平方，再按各组的样本量加权求和。\n    $$ SSB = \\sum_{i=1}^{k} n_i (\\bar{x}_i - \\bar{x}_{grand})^2 $$\n    $$ SSB = 15(12.0 - 11.625)^2 + 15(11.5 - 11.625)^2 + 15(10.0 - 11.625)^2 + 15(13.0 - 11.625)^2 $$\n    $$ SSB = 15 [ (0.375)^2 + (-0.125)^2 + (-1.625)^2 + (1.375)^2 ] $$\n    $$ SSB = 15 [ 0.140625 + 0.015625 + 2.640625 + 1.890625 ] $$\n    $$ SSB = 15 [ 4.6875 ] = 70.3125 $$\n\n接下来，我们确定与每个平方和相关的自由度 ($df$)。\n-   组间自由度：$df_B = k - 1 = 4 - 1 = 3$。\n-   组内自由度：$df_W = N - k = 60 - 4 = 56$。\n-   总自由度：$df_T = N - 1 = 60 - 1 = 59$。注意 $df_T = df_B + df_W$。\n\n现在我们计算均方 ($MS$)，即平方和除以其各自的自由度。\n-   组间均方：$MSB = \\frac{SSB}{df_B} = \\frac{70.3125}{3} = 23.4375$。\n-   组内均方：$MSW = \\frac{SSW}{df_W} = \\frac{79.8}{56} = 1.425$。$MSW$ 是共同方差 $\\sigma^2$ 的合并估计值。\n\n最后，我们计算ANOVA $F$统计量，它是组间方差估计值与组内方差估计值的比率。\n$$ F = \\frac{MSB}{MSW} = \\frac{23.4375}{1.425} \\approx 16.44736842... $$\n\n完整的ANOVA表构建如下：\n| 变异来源 | 平方和 ($SS$) | 自由度 ($df$) | 均方 ($MS$) | $F$统计量 |\n|----------|---------------|---------------|-------------|-----------|\n| 组间     | $70.3125$     | $3$           | $23.4375$   | $16.45$   |\n| 组内     | $79.8$        | $56$          | $1.425$     |           |\n| 总计     | $150.1125$    | $59$          |             |           |\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$ F \\approx 16.447368... \\rightarrow 16.45 $$", "answer": "$$\n\\boxed{16.45}\n$$", "id": "4957544"}, {"introduction": "在比较多组均值时，我们往往不满足于仅仅知道它们是否“不全相等”，而是希望检验更具体的假设，例如是否存在剂量-反应关系。本练习引入了“线性对比”（linear contrasts）这一强大工具，它允许我们检验组均值之间是否存在特定结构模式。你将学习如何构建一个用于检验线性趋势的对比，并为其计算相应的 $F$ 统计量。[@problem_id:4957537]", "problem": "一项随机临床试验比较了 $4$ 个治疗组的平均血清细胞因子水平：对照组 $(i=1)$ 和三个递增剂量水平组 $(i=2,3,4)$。设第 $i$ 组观察到的细胞因子水平为 $Y_{ij}$，其中 $j=1,\\dots,n_i$。采用具有同方差高斯误差的线性模型的单因素单元均值参数化：$Y_{ij} = \\mu_i + \\varepsilon_{ij}$，其中 $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^2)$ 独立，且 $i=1,\\dots,4$。该研究报告了以下汇总统计数据（样本量 $n_i$、样本均值 $\\bar{Y}_i$ 和样本标准差 $s_i$）：\n- 第 $1$ 组（对照组）：$n_1 = 15$，$\\bar{Y}_1 = 22.4$，$s_1 = 4.8$。\n- 第 $2$ 组（低剂量组）：$n_2 = 12$，$\\bar{Y}_2 = 18.9$，$s_2 = 5.1$。\n- 第 $3$ 组（中剂量组）：$n_3 = 17$，$\\bar{Y}_3 = 17.3$，$s_3 = 4.5$。\n- 第 $4$ 组（高剂量组）：$n_4 = 14$，$\\bar{Y}_4 = 16.8$，$s_4 = 4.2$。\n\n考虑编码了线性剂量趋势的单元均值对比，\n$$L \\;=\\; -3\\,\\mu_1 \\;-\\; 1\\,\\mu_2 \\;+\\; 1\\,\\mu_3 \\;+\\; 3\\,\\mu_4,$$\n其满足 $\\sum_{i=1}^{4} c_i = 0$，系数为 $c_1=-3, c_2=-1, c_3=1, c_4=3$。从模型假设和单因素实验的方差分析分解出发，根据第一性原理推导一个合适的 $F$ 统计量，用于检验原假设 $H_0: L = 0$ 与备择假设 $H_1: L \\neq 0$，然后利用给定的汇总统计数据计算其数值。给出最终的 $F$ 统计量，并将答案四舍五入至四位有效数字。", "solution": "### 解答\n我们的目标是为线性对比 $L$ 检验原假设 $H_0: L=0$。检验统计量是一个$F$统计量，其形式为 $F = \\frac{MS_L}{MS_E}$，其中 $MS_L$ 是对比的均方，$MS_E$ 是均方误差。它服从自由度为 $df_1=1$ 和 $df_2=N-k$ 的$F$分布。\n\n**步骤1：计算对比的均方 ($MS_L$)**\n\n对比的均方 $MS_L$ 是其平方和 $SS_L$ 除以其自由度 ($df_L=1$)。因此，$MS_L = SS_L$。$SS_L$ 的计算公式为：\n$$SS_L = \\frac{(\\hat{L})^2}{\\sum_{i=1}^{k} (c_i^2/n_i)}$$\n其中 $\\hat{L} = \\sum_{i=1}^{k} c_i \\bar{Y}_i$ 是对比的样本估计值。\n\n首先，我们计算 $\\hat{L}$：\n$$ \\hat{L} = (-3)(\\bar{Y}_1) + (-1)(\\bar{Y}_2) + (1)(\\bar{Y}_3) + (3)(\\bar{Y}_4) $$\n$$ \\hat{L} = (-3)(22.4) + (-1)(18.9) + (1)(17.3) + (3)(16.8) $$\n$$ \\hat{L} = -67.2 - 18.9 + 17.3 + 50.4 = -18.4 $$\n\n接下来，计算分母项 $\\sum_{i=1}^{4} \\frac{c_i^2}{n_i}$：\n$$ \\sum_{i=1}^{4} \\frac{c_i^2}{n_i} = \\frac{(-3)^2}{15} + \\frac{(-1)^2}{12} + \\frac{1^2}{17} + \\frac{3^2}{14} $$\n$$ \\sum_{i=1}^{4} \\frac{c_i^2}{n_i} = \\frac{9}{15} + \\frac{1}{12} + \\frac{1}{17} + \\frac{9}{14} \\approx 0.6 + 0.083333 + 0.058824 + 0.642857 \\approx 1.385014 $$\n\n现在，计算 $SS_L$：\n$$ SS_L = \\frac{(-18.4)^2}{1.385014} = \\frac{338.56}{1.385014} \\approx 244.4447 $$\n所以，$MS_L \\approx 244.4447$。\n\n**步骤2：计算均方误差 ($MS_E$)**\n\n均方误差 $MS_E$ 是误差平方和 $SS_E$ 除以误差自由度 $df_E$ 的结果。它是对组内共同方差 $\\sigma^2$ 的估计。\n$$MS_E = \\frac{SS_E}{df_E} = \\frac{\\sum_{i=1}^{k} (n_i-1)s_i^2}{\\sum_{i=1}^{k} (n_i-1)}$$\n\n首先，计算总样本量 $N$ 和误差自由度 $df_E$：\n$$ N = n_1 + n_2 + n_3 + n_4 = 15 + 12 + 17 + 14 = 58 $$\n$$ df_E = N-k = 58 - 4 = 54 $$\n\n接下来，计算误差平方和 $SS_E$：\n$$ SS_E = (n_1-1)s_1^2 + (n_2-1)s_2^2 + (n_3-1)s_3^2 + (n_4-1)s_4^2 $$\n$$ SS_E = (15-1)(4.8)^2 + (12-1)(5.1)^2 + (17-1)(4.5)^2 + (14-1)(4.2)^2 $$\n$$ SS_E = 14(23.04) + 11(26.01) + 16(20.25) + 13(17.64) $$\n$$ SS_E = 322.56 + 286.11 + 324.00 + 229.32 = 1161.99 $$\n\n现在，计算 $MS_E$：\n$$ MS_E = \\frac{1161.99}{54} \\approx 21.518333 $$\n\n**步骤3：计算 F 统计量**\n\n最后，我们将 $MS_L$ 和 $MS_E$ 相除得到 $F$ 统计量：\n$$ F = \\frac{MS_L}{MS_E} = \\frac{244.4447}{21.518333} \\approx 11.36000 $$\n\n将结果四舍五入到四位有效数字，我们得到 $11.36$。", "answer": "$$\n\\boxed{11.36}\n$$", "id": "4957537"}, {"introduction": "现实世界中的生物学实验常常涉及多个影响因素。这个练习将带你进入更复杂的双因素方差分析（two-way ANOVA）世界，你不仅要分析两个独立因素的主效应，更关键的是，还要检验它们之间是否存在交互作用。通过这个案例，你还将实践分层检验（hierarchical testing）的策略，这是一种在交互作用不显著时，通过合并变异来构建更简洁、有效模型的常用方法。[@problem_id:4957533]", "problem": "一项随机生物统计实验研究了促炎性生物标志物响应（记为$Y$）如何在两个固定因子——三水平的饮食因子$A$（水平为$A_1, A_2, A_3$）和两水平的运动因子$B$（水平为$B_1, B_2$）——的组合下变化。该设计为平衡设计，每个单元格有 $n=5$ 名独立受试者。观测到的单元格样本均值 $\\bar{Y}_{ij\\cdot}$（对单元格 $(i,j)$ 中的 $n$ 名受试者取平均）和单元格内无偏样本方差 $s_{ij}^2$ 如下：\n- $A_1$：$\\bar{Y}_{11\\cdot}=10.1$，其中 $s_{11}^2=1.44$；$\\bar{Y}_{12\\cdot}=12.0$，其中 $s_{12}^2=0.81$。\n- $A_2$：$\\bar{Y}_{21\\cdot}=11.0$，其中 $s_{21}^2=1.21$；$\\bar{Y}_{22\\cdot}=13.2$，其中 $s_{22}^2=1.00$。\n- $A_3$：$\\bar{Y}_{31\\cdot}=12.2$，其中 $s_{31}^2=1.00$；$\\bar{Y}_{32\\cdot}=14.1$，其中 $s_{32}^2=1.21$。\n\n假设使用标准的含交互作用的双因素固定效应模型，且个体误差满足方差齐性：对于单元格 $(i,j)$ 中的受试者 $k=1,\\dots,n$，\n$$\nY_{ijk} \\;=\\; \\mu \\;+\\; \\alpha_i \\;+\\; \\beta_j \\;+\\; (\\alpha\\beta)_{ij} \\;+\\; \\varepsilon_{ijk},\n$$\n其中 $E[\\varepsilon_{ijk}]=0$，$\\operatorname{Var}(\\varepsilon_{ijk})=\\sigma^2$，并且 $\\varepsilon_{ijk}$ 相互独立。\n\n仅使用平衡双因素布局中由变异的正交分解导出的离差平方和的定义，以及均方是离差平方和除以其对应自由度这一事实，按以下步骤进行：\n- 为因子$A$、因子$B$、$A\\times B$交互作用以及误差构建方差分析（ANOVA）表的各个部分：通过单元格均值、边际均值和单元格内变异性，明确确定每个来源的自由度和离差平方和。\n- 应用分层检验：首先使用适当的$F$统计量检验是否存在$A\\times B$交互作用。如果在显著性水平$\\alpha=0.05$下交互作用不显著，则将交互作用的离差平方和与误差的离差平方和合并，形成一个新的误差项，然后使用这个合并后的误差项检验因子$A$的主效应。\n\n根据此分层检验规则，用于检验因子$A$主效应的$F$统计量的数值是多少？将您的答案四舍五入到四位有效数字。仅陈述$F$统计量；不要报告$p$值或结论。", "solution": "### 解答\n该问题要求我们采用分层检验策略来计算因子A主效应的F统计量。这意味着我们必须先检验交互作用，如果不显著，则将其变异合并到误差项中，然后用这个新的误差项来检验主效应。\n\n实验设计参数如下：\n- 因子A（饮食）有 $I=3$ 个水平。\n- 因子B（运动）有 $J=2$ 个水平。\n- 每个单元格的重复数为 $n=5$。\n- 总样本量为 $N = I \\times J \\times n = 3 \\times 2 \\times 5 = 30$。\n\n**步骤1：计算方差分析表的基础组件**\n\n首先，我们计算进行F检验所需的离差平方和（SS）、自由度（DF）和均方（MS）。\n\n**自由度 (DF):**\n- 因子A：$DF_A = I-1 = 3-1 = 2$\n- 交互作用 A×B：$DF_{AB} = (I-1)(J-1) = (2)(1) = 2$\n- 误差：$DF_E = IJ(n-1) = 3 \\times 2 \\times (5-1) = 24$\n\n**离差平方和 (SS) 与均方 (MS):**\n\n1.  **误差项 (Error):**\n    $SSE = \\sum_{i,j} (n-1)s_{ij}^2 = (5-1) \\times (1.44 + 0.81 + 1.21 + 1.00 + 1.00 + 1.21) = 4 \\times 6.67 = 26.68$\n    $MSE = \\frac{SSE}{DF_E} = \\frac{26.68}{24} \\approx 1.1117$\n\n2.  **交互作用项 (A×B):**\n    为计算 $SS_{AB}$，我们首先需要边际均值和总均值。\n    - 边际均值 $\\bar{Y}_{i\\cdot\\cdot}$: $\\bar{Y}_{1\\cdot\\cdot}=11.05$, $\\bar{Y}_{2\\cdot\\cdot}=12.10$, $\\bar{Y}_{3\\cdot\\cdot}=13.15$\n    - 边际均值 $\\bar{Y}_{\\cdot j\\cdot}$: $\\bar{Y}_{\\cdot 1\\cdot}=11.1$, $\\bar{Y}_{\\cdot 2\\cdot}=13.1$\n    - 总均值 $\\bar{Y}_{\\cdot\\cdot\\cdot} = 12.1$\n    \n    $SS_{AB} = n \\sum_{i,j} (\\bar{Y}_{ij\\cdot} - \\bar{Y}_{i\\cdot\\cdot} - \\bar{Y}_{\\cdot j\\cdot} + \\bar{Y}_{\\cdot\\cdot\\cdot})^2$\n    $SS_{AB} = 5 \\times [ (10.1 - 11.05 - 11.1 + 12.1)^2 + (12.0 - 11.05 - 13.1 + 12.1)^2 + \\dots ]$\n    $SS_{AB} = 5 \\times [ (0.05)^2 + (-0.05)^2 + (-0.10)^2 + (0.10)^2 + (0.05)^2 + (-0.05)^2 ]$\n    $SS_{AB} = 5 \\times [0.0025 + 0.0025 + 0.01 + 0.01 + 0.0025 + 0.0025] = 5 \\times 0.03 = 0.15$\n    $MS_{AB} = \\frac{SS_{AB}}{DF_{AB}} = \\frac{0.15}{2} = 0.075$\n\n3.  **因子A主效应项 (Factor A):**\n    $SSA = nJ \\sum_{i} (\\bar{Y}_{i\\cdot\\cdot} - \\bar{Y}_{\\cdot\\cdot\\cdot})^2$\n    $SSA = 5 \\times 2 \\times [ (11.05 - 12.1)^2 + (12.10 - 12.1)^2 + (13.15 - 12.1)^2 ]$\n    $SSA = 10 \\times [ (-1.05)^2 + 0^2 + (1.05)^2 ] = 10 \\times [1.1025 + 0 + 1.1025] = 22.05$\n    $MSA = \\frac{SSA}{DF_A} = \\frac{22.05}{2} = 11.025$\n\n**步骤2：分层检验 - 检验交互作用**\n\n首先检验交互作用的显著性。\n$$ F_{AB} = \\frac{MS_{AB}}{MSE} = \\frac{0.075}{1.1117} \\approx 0.06746 $$\n在 $\\alpha=0.05$ 水平下，此检验的临界值为 $F_{0.05, 2, 24} \\approx 3.40$。由于 $F_{AB} \\ll 3.40$，我们得出结论，交互作用不显著。\n\n**步骤3：合并变异并检验主效应**\n\n根据分层检验规则，我们将不显著的交互作用项的离差平方和与自由度合并到误差项中，形成一个新的、更精确的误差估计。\n- **合并后的误差离差平方和 ($SS'_{Error}$):**\n  $SS'_{Error} = SS_{AB} + SSE = 0.15 + 26.68 = 26.83$\n- **合并后的误差自由度 ($DF'_{Error}$):**\n  $DF'_{Error} = DF_{AB} + DF_E = 2 + 24 = 26$\n- **合并后的均方误差 ($MS'_{Error}$):**\n  $MS'_{Error} = \\frac{SS'_{Error}}{DF'_{Error}} = \\frac{26.83}{26} \\approx 1.031923$\n\n最后，我们使用这个合并后的均方误差来检验因子A的主效应。\n$$ F_A = \\frac{MSA}{MS'_{Error}} = \\frac{11.025}{1.031923} \\approx 10.6839... $$\n\n将结果四舍五入到四位有效数字，我们得到 $10.68$。", "answer": "$$\n\\boxed{10.68}\n$$", "id": "4957533"}]}