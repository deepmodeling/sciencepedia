{"hands_on_practices": [{"introduction": "掌握理论后，最好的学习方法莫过于亲手实践。这个练习将指导您从一个小的生物统计学数据集开始，一步步完成基于中位数的Levene检验的全过程。通过计算组中位数、绝对离差，并最终得到方差分析的 $F$ 统计量，您将巩固对该检验核心机制的理解，并思考如何高效地实现这些计算 [@problem_id:4957201]。", "problem": "一名生物统计学研究者正在比较三种治疗方案下某血清生物标志物的变异性。设 $Y_{ij}$ 表示第 $i$ 个治疗组中第 $j$ 名受试者的生物标志物测量值。数据如下：\n- 第1组：$7.2$, $8.1$, $6.9$, $7.8$\n- 第2组：$6.1$, $5.8$, $6.5$, $6.3$, $5.9$\n- 第3组：$7.0$, $6.7$, $7.3$\n\n使用基于中位数的Levene检验（即，在每组中构建与样本中位数的偏差），执行以下操作：\n- 对各组中位数绝对偏差应用单因素方差分析，计算得出的检验统计量。\n- 评估一种计算实现策略，该策略相对于总样本量 $N$ 能达到 $\\mathcal{O}(N)$ 的时间复杂度，并为所有主要步骤（组中心计算、偏差计算、按组聚合以及平方和计算）的时间复杂度进行论证。\n- 针对大样本量 $N$ 的情况，提出以数组和归约操作表示的向量化运算，用于计算 $Z_{ij}$ 以及组间和组内平方和。\n\n设 $g$ 为组数，$N$ 为总观测数。将您的最终答案以行矩阵的形式报告，其中包含 $F$ 统计量的数值（四舍五入到四位有效数字）和以大$\\mathcal{O}$表示法表示的渐近时间复杂度。最终结果中无需单位。", "solution": "该问题是有效的。它提出了一个基于既定原则（用于检验方差齐性的Levene检验、单因素方差分析）的明确定义的统计任务，并提供了所有必要的数据。该问题是自包含的、客观的、有科学依据且计算上可行的。我们将继续进行解答，解答过程包括三个部分：首先，计算检验统计量；其次，分析计算时间复杂度；第三，提出向量化实现策略。\n\n基于中位数的Levene检验评估原假设 $H_0: \\sigma_1^2 = \\sigma_2^2 = \\dots = \\sigma_g^2$ 与备择假设（至少有一个组的方差不同）的对立情况。该过程需要将原始数据 $Y_{ij}$（第 $i$ 组中第 $j$ 名受试者的测量值）转换为与组中位数的绝对偏差，$Z_{ij} = |Y_{ij} - \\tilde{Y}_i|$，其中 $\\tilde{Y}_i$ 是第 $i$ 组的中位数。然后对这些 $Z_{ij}$ 值执行单因素方差分析（ANOVA）。\n\n**第1部分：F统计量的计算**\n\n组数为 $g=3$。数据和各组样本量如下：\n- 第1组：$\\{7.2, 8.1, 6.9, 7.8\\}$，样本量 $n_1=4$。\n- 第2组：$\\{6.1, 5.8, 6.5, 6.3, 5.9\\}$，样本量 $n_2=5$。\n- 第3组：$\\{7.0, 6.7, 7.3\\}$，样本量 $n_3=3$。\n总观测数为 $N = n_1 + n_2 + n_3 = 4 + 5 + 3 = 12$。\n\n首先，我们计算每组的中位数。\n- 对于第1组，排序后的数据为 $\\{6.9, 7.2, 7.8, 8.1\\}$。中位数是中间两个值的平均值：\n  $\\tilde{Y}_1 = \\frac{7.2 + 7.8}{2} = 7.5$。\n- 对于第2组，排序后的数据为 $\\{5.8, 5.9, 6.1, 6.3, 6.5\\}$。中位数是中间值：\n  $\\tilde{Y}_2 = 6.1$。\n- 对于第3组，排序后的数据为 $\\{6.7, 7.0, 7.3\\}$。中位数是中间值：\n  $\\tilde{Y}_3 = 7.0$。\n\n接下来，我们计算每个观测值的绝对偏差 $Z_{ij} = |Y_{ij} - \\tilde{Y}_i|$。\n- 对于第1组：$\\{|7.2-7.5|, |8.1-7.5|, |6.9-7.5|, |7.8-7.5|\\} = \\{0.3, 0.6, 0.6, 0.3\\}$。\n- 对于第2组：$\\{|6.1-6.1|, |5.8-6.1|, |6.5-6.1|, |6.3-6.1|, |5.9-6.1|\\} = \\{0.0, 0.3, 0.4, 0.2, 0.2\\}$。\n- 对于第3组：$\\{|7.0-7.0|, |6.7-7.0|, |7.3-7.0|\\} = \\{0.0, 0.3, 0.3\\}$。\n\n现在，我们对这些 $Z_{ij}$ 值执行单因素方差分析。我们需要偏差的组均值（$\\bar{Z}_i$）和总均值（$\\bar{Z}$）。\n- 偏差的组均值：\n  $\\bar{Z}_1 = \\frac{0.3+0.6+0.6+0.3}{4} = \\frac{1.8}{4} = 0.45$。\n  $\\bar{Z}_2 = \\frac{0.0+0.3+0.4+0.2+0.2}{5} = \\frac{1.1}{5} = 0.22$。\n  $\\bar{Z}_3 = \\frac{0.0+0.3+0.3}{3} = \\frac{0.6}{3} = 0.20$。\n- 偏差的总均值：\n  $\\bar{Z} = \\frac{\\sum_{i,j} Z_{ij}}{N} = \\frac{1.8 + 1.1 + 0.6}{12} = \\frac{3.5}{12} \\approx 0.29167$。\n\n方差分析需要组间平方和（$SSB$）和组内平方和（$SSW$）。\n- 组间平方和：$SSB = \\sum_{i=1}^g n_i (\\bar{Z}_i - \\bar{Z})^2$。\n  $$SSB = 4(0.45 - \\frac{3.5}{12})^2 + 5(0.22 - \\frac{3.5}{12})^2 + 3(0.20 - \\frac{3.5}{12})^2$$\n  $$SSB = 4(\\frac{5.4-3.5}{12})^2 + 5(\\frac{2.64-3.5}{12})^2 + 3(\\frac{2.4-3.5}{12})^2$$\n  $$SSB = 4(\\frac{1.9}{12})^2 + 5(\\frac{-0.86}{12})^2 + 3(\\frac{-1.1}{12})^2$$\n  $$SSB = \\frac{1}{144} [4(3.61) + 5(0.7396) + 3(1.21)] = \\frac{14.44 + 3.698 + 3.63}{144} = \\frac{21.768}{144} \\approx 0.15117$$\n- 组内平方和：$SSW = \\sum_{i=1}^g \\sum_{j=1}^{n_i} (Z_{ij} - \\bar{Z}_i)^2$。\n  对于第1组：$SSW_1 = (0.3-0.45)^2 + (0.6-0.45)^2 + (0.6-0.45)^2 + (0.3-0.45)^2 = 2(-0.15)^2 + 2(0.15)^2 = 4(0.0225) = 0.09$。\n  对于第2组：$SSW_2 = (0.0-0.22)^2 + (0.3-0.22)^2 + (0.4-0.22)^2 + (0.2-0.22)^2 + (0.2-0.22)^2 = 0.0484 + 0.0064 + 0.0324 + 0.0004 + 0.0004 = 0.088$。\n  对于第3组：$SSW_3 = (0.0-0.2)^2 + (0.3-0.2)^2 + (0.3-0.2)^2 = (-0.2)^2 + (0.1)^2 + (0.1)^2 = 0.04 + 0.01 + 0.01 = 0.06$。\n  总 $SSW = SSW_1 + SSW_2 + SSW_3 = 0.09 + 0.088 + 0.06 = 0.238$。\n\n均方是通过将平方和除以其各自的自由度来计算的。\n- 组间自由度：$df_B = g - 1 = 3 - 1 = 2$。\n- 组内自由度：$df_W = N - g = 12 - 3 = 9$。\n- 组间均方：$MSB = \\frac{SSB}{df_B} = \\frac{0.15117}{2} \\approx 0.07558$。\n- 组内均方：$MSW = \\frac{SSW}{df_W} = \\frac{0.238}{9} \\approx 0.02644$。\n\n$F$ 统计量是均方之比。\n$$F = \\frac{MSB}{MSW} = \\frac{0.07558}{0.02644} \\approx 2.8582$$\n四舍五入到四位有效数字，检验统计量为 $F = 2.858$。\n\n**第2部分：$\\mathcal{O}(N)$ 实现的时间复杂度分析**\n\n通过为每个步骤使用高效算法，可以实现相对于总样本量 $N$ 的时间复杂度为 $\\mathcal{O}(N)$ 的实现。\n1.  **组中心（中位数）计算**：要计算每组 $i$（样本量为 $n_i$）的中位数，一种简单的方法是对每组进行排序，这将花费 $\\mathcal{O}(n_i \\log n_i)$ 的时间。总时间 $\\sum_{i} \\mathcal{O}(n_i \\log n_i)$ 不能保证是 $N$ 的线性函数。然而，线性时间选择算法（例如，中位数的中位数算法或内省选择算法）可以在 $\\mathcal{O}(n_i)$ 时间内找到大小为 $n_i$ 的未排序数组的中位数。将此算法应用于所有 $g$ 个组，得到的总时间复杂度为 $\\sum_{i=1}^g \\mathcal{O}(n_i) = \\mathcal{O}(\\sum n_i) = \\mathcal{O}(N)$。\n2.  **偏差计算**：为所有 $N$ 个观测值计算 $Z_{ij} = |Y_{ij} - \\tilde{Y}_i|$ 需要遍历整个数据集一次。对于每个元素，执行一次减法和一次绝对值运算。此步骤的时间复杂度为 $\\mathcal{O}(N)$。\n3.  **按组聚合与平方和计算**：对 $Z_{ij}$ 值进行的最终方差分析计算也可以在 $\\mathcal{O}(N)$ 时间内完成。\n    - 要计算所有组均值 $\\bar{Z}_i$，只需对 $N$ 个 $Z_{ij}$ 值进行一次遍历，即可为每个组累加总和 $\\sum_j Z_{ij}$ 并计数 $n_i$。然后在 $\\mathcal{O}(g)$ 时间内计算出均值。此步骤的总时间为 $\\mathcal{O}(N) + \\mathcal{O}(g)$。\n    - 总均值 $\\bar{Z}$ 是在 $\\mathcal{O}(g)$ 时间内从各组总和计算得出的。\n    - $SSB$ 是通过对 $g$ 个组进行循环计算的，使用预先计算的 $n_i$、$\\bar{Z}_i$ 和 $\\bar{Z}$。这需要 $\\mathcal{O}(g)$ 时间。\n    - $SSW$ 是通过对 $N$ 个 $Z_{ij}$ 值再进行一次遍历来计算的，计算 $\\sum (Z_{ij} - \\bar{Z}_i)^2$。这需要 $\\mathcal{O}(N)$ 时间。\n此阶段的总时间复杂度为 $\\mathcal{O}(N) + \\mathcal{O}(g) + \\mathcal{O}(N) = \\mathcal{O}(N+g)$。由于 $g \\le N$，这可以简化为 $\\mathcal{O}(N)$。\n\n因此，所有主要步骤的总时间复杂度为 $\\mathcal{O}(N) + \\mathcal{O}(N) + \\mathcal{O}(N) = \\mathcal{O}(N)$。\n\n**第3部分：向量化操作**\n\n对于大样本量 $N$，向量化操作对性能至关重要。假设数据存储在数组 $\\mathbf{Y}$ 中，组标签存储在等长的数组 $\\mathbf{I}$ 中：\n1.  **计算 $Z_{ij}$**：\n    - 首先，计算一个长度为 $N$ 的中位数数组 $\\tilde{\\mathbf{Y}}$，其中每个元素 $\\tilde{\\mathbf{Y}}_k$ 是 $\\mathbf{Y}_k$ 所属组的中位数。此操作通常是`group-by`（分组）后跟`transform`（转换）或`broadcast`（广播）。\n    - 然后，通过完全向量化的逐元素操作计算偏差数组 $\\mathbf{Z}$：$\\mathbf{Z} = |\\mathbf{Y} - \\tilde{\\mathbf{Y}}|$。\n2.  **计算平方和**：\n    - **组均值和总均值**：组均值 $\\bar{\\mathbf{Z}}_{\\text{groups}}$（一个长度为 $g$ 的数组）可以通过基于 $\\mathbf{I}$ 对 $\\mathbf{Z}$ 进行分段求和归约，再除以通过分段计数归约得到的各组计数值来得到。总均值 $\\bar{Z}$ 是对 $\\mathbf{Z}$ 进行简单求和归约再除以 $N$。\n    - **组间平方和 ($SSB$)**：使用组计数值数组 $\\mathbf{n}$ 和组均值数组 $\\bar{\\mathbf{Z}}_{\\text{groups}}$：\n      $\\mathrm{SSB} = \\text{sum}(\\mathbf{n} \\odot (\\bar{\\mathbf{Z}}_{\\text{groups}} - \\bar{Z})^2)$，其中 $\\odot$ 表示逐元素乘法。这涉及广播、逐元素操作和最终的求和归约。\n    - **组内平方和 ($SSW$)**：\n      首先，将组均值 $\\bar{\\mathbf{Z}}_{\\text{groups}}$ 广播回一个长度为 $N$ 的数组 $\\bar{\\mathbf{Z}}_{\\text{expanded}}$。\n      $\\mathrm{SSW} = \\text{sum}((\\mathbf{Z} - \\bar{\\mathbf{Z}}_{\\text{expanded}})^2)$。这涉及逐元素减法和平方，然后对整个结果数组进行最终的求和归约。\n\n这些操作利用高效的、通常是并行的底层实现来进行数组范围的计算，从而避免了在高级代码中使用显式循环。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.858  \\mathcal{O}(N)\n\\end{pmatrix}\n}\n$$", "id": "4957201"}, {"introduction": "统计方法的应用并非总是直截了当，我们常常会遇到需要审慎处理的边界情况。本练习探讨了当中位数的Levene检验（即Brown–Forsythe检验）应用于极小样本（例如 $n_i = 2$）时出现的一个微妙问题。您将研究中位数的定义如何导致模糊性，并评估解决此问题的不同策略，从而培养在应用中进行严谨统计思维的能力 [@problem_id:4957191]。", "problem": "一项生物统计学研究使用一种稳健性修正的 Levene 型程序来比较 $k$ 个治疗组的收缩压变异性。对于每个组 $i \\in \\{1,\\dots,k\\}$，其观测值为 $\\{y_{ij}: j=1,\\dots,n_i\\}$，该程序计算转换值 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$，其中 $c_i$ 是特定于组的稳健中心。然后，通过对 $\\{z_{ij}\\}$ 进行单因素方差分析来评估方差的相等性。Brown–Forsythe 变体在每组中使用样本中位数作为稳健中心。\n\n从有限样本的样本中位数定义开始：中位数是任何能够最小化绝对偏差和 $\\sum_{j=1}^{n} \\lvert x_j - m \\rvert$ 的值 $m$。等价地，对于偶数 $n$，两个中间顺序统计量之间的闭区间内的任何值都是中位数。使用这个定义，考虑一个特定的组 $i$，其样本量为 $n_i = 2$，排序后的观测值为 $y_{i(1)} \\le y_{i(2)}$。证明中位数的集合是整个区间 $\\left[y_{i(1)}, y_{i(2)}\\right]$，并推断转换值 $z_{i1} = \\lvert y_{i1} - m \\rvert$ 和 $z_{i2} = \\lvert y_{i2} - m \\rvert$（以及随后的方差分析检验统计量）依赖于在该区间内对 $m$ 的选择。结论是，当某些 $n_i = 2$ 时，除非指定了决断规则或替代的稳健中心，否则基于中位数的 Levene 程序是定义不明确的。\n\n以下哪项修改既解决了定义不明确的问题，又保留了位置估计量的自然不变性（位置等变性和双点样本内的对称性），同时相对于普通均值保持了稳健性？\n\nA. 在任何 $n_i = 2$ 的组中，将 $c_i$ 定义为两个顺序统计量的中点，即 $c_i = \\left(y_{i(1)} + y_{i(2)}\\right)/2$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。\n\nB. 在任何 $n_i = 2$ 的组中，将 $c_i$ 定义为较小的观测值，即 $c_i = y_{i(1)}$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。\n\nC. 将每组中的中位数替换为固定百分比的截尾均值（例如，10% 截尾均值），因此 $c_i$ 是一个唯一的截尾均值，且 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。\n\nD. 从 Levene 型检验中排除任何 $n_i = 2$ 的组，以便所有组都满足 $n_i \\ge 3$。\n\nE. 使用从所有组合并计算的单个合并全局中位数 $\\tilde{y}$ 来计算 $z_{ij} = \\lvert y_{ij} - \\tilde{y} \\rvert$，而不是使用特定于组的中心。\n\n选择所有适用的选项。", "solution": "用户提供了一个生物统计学问题，涉及 Brown–Forsythe 检验，这是 Levene 方差齐性检验的一种变体。任务是首先验证问题的陈述，如果有效，则确定适当的修改方法，以处理在小样本量下出现的特定模糊性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **程序：** 用于比较 $k$ 个组方差是否相等的 Levene 型检验。\n- **组：** $i \\in \\{1, \\dots, k\\}$，观测值为 $\\{y_{ij}: j=1, \\dots, n_i\\}$。\n- **转换：** $z_{ij} = \\lvert y_{ij} - c_i \\rvert$，其中 $c_i$ 是特定于组的稳健中心。\n- **检验：** 对转换值 $\\{z_{ij}\\}$ 进行单因素方差分析 (ANOVA)。\n- **Brown–Forsythe 变体：** 这个特定变体使用样本中位数作为 $c_i$。\n- **中位数定义：** 样本 $\\{x_j: j=1, \\dots, n\\}$ 的中位数 $m$ 是任何能够最小化绝对偏差和 $\\sum_{j=1}^{n} \\lvert x_j - m \\rvert$ 的值。\n- **偶数 $n$ 的中位数：** 两个中间顺序统计量之间的闭区间内的任何值都是中位数。\n- **情景：** 一个组 $i$，其样本量为 $n_i = 2$，排序后的观测值为 $y_{i(1)} \\le y_{i(2)}$。\n- **论证任务：** 问题陈述断言，对于此情景，中位数的集合是 $[y_{i(1)}, y_{i(2)}]$，这使得转换值 $z_{ij}$ 和随后的检验统计量依赖于中位数的选择，从而使程序定义不明确。\n- **问题：** 确定给定的修改项（A-E）中，哪些解决了这个定义不明确的问题，同时满足三个标准：\n    1.  保持位置等变性。\n    2.  保持双点样本的对称性。\n    3.  相对于普通均值保持稳健性。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地建立在公认的统计理论之上。Levene 检验、Brown–Forsythe 修正、样本中位数的性质以及位置等变性、对称性和稳健性等概念都是统计学中的标准课题。偶数个数据点的中位数的模糊性是一个众所周知的数学性质。\n- **问题的适定性：** 问题陈述首先描述了一个有效的统计程序，然后正确地指出了一个特定的边界情况（$n_i=2$），在该情况下程序定义不明确。如何解决这种模糊性是一个有意义且适定的统计学问题。有效修改的标准也已明确说明。\n- **客观性：** 问题以精确、客观、正式的语言陈述。没有主观或基于意见的主张。\n\n**步骤 3：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。它准确地描述了统计方法论中的一个合理问题，并要求一个有原则的解决方案。\n**结论：** 该问题是 **有效的**。\n解决方案现在将首先确认问题的前提，然后根据规定的标准评估每个选项。\n\n### 求解推导\n\n首先，我们确认问题的前提，即对于大小为 $n_i = 2$ 的样本 $\\{y_{i(1)}, y_{i(2)}\\}$，中位数的集合是区间 $[y_{i(1)}, y_{i(2)}]$，并且这导致程序定义不明确。\n\n令 $S(m) = \\sum_{j=1}^{2} \\lvert y_{i(j)} - m \\rvert = \\lvert y_{i(1)} - m \\rvert + \\lvert y_{i(2)} - m \\rvert$。我们寻求最小化函数 $S(m)$。\n- 如果 $m  y_{i(1)}$，那么 $S(m) = (y_{i(1)} - m) + (y_{i(2)} - m) = y_{i(1)} + y_{i(2)} - 2m$。导数 $S'(m) = -2$，所以 $S(m)$ 是递减的。\n- 如果 $m  y_{i(2)}$，那么 $S(m) = (m - y_{i(1)}) + (m - y_{i(2)}) = 2m - y_{i(1)} - y_{i(2)}$。导数 $S'(m) = 2$，所以 $S(m)$ 是递增的。\n- 如果 $y_{i(1)} \\le m \\le y_{i(2)}$，那么 $S(m) = (m - y_{i(1)}) + (y_{i(2)} - m) = y_{i(2)} - y_{i(1)}$，这是一个常数。\n\n因此，$S(m)$ 的最小值是 $y_{i(2)} - y_{i(1)}$，对于任何 $m \\in [y_{i(1)}, y_{i(2)}]$ 均可达到。这证实了中位数的集合是指定的区间。\n\n转换值为 $z_{i1} = \\lvert y_{i(1)} - m \\rvert = m - y_{i(1)}$ 和 $z_{i2} = \\lvert y_{i(2)} - m \\rvert = y_{i(2)} - m$。这些值显然依赖于 $m$ 的选择。例如，如果选择 $m$ 为 $y_{i(1)}$，则值为 $\\{0, y_{i(2)} - y_{i(1)}\\}$。如果选择 $m$ 为中点 $(y_{i(1)} + y_{i(2)})/2$，则值为 $\\{(y_{i(2)} - y_{i(1)})/2, (y_{i(2)} - y_{i(1)})/2\\}$。由于 ANOVA 的 F 统计量是根据这些 $z_{ij}$ 值计算的，因此检验结果不是唯一的。前提是正确的。\n\n我们现在根据三个标准评估每个选项：\n1.  **解决定义不明确问题：** 在 $n_i=2$ 时为 $c_i$ 提供一个唯一的、单一的值。\n2.  **位置等变性：** 对于估计量 $T$，如果对于常数 $a$ 有 $y'_j = y_j + a$，那么 $T(y') = T(y) + a$。\n3.  **对称性：** 对于双点样本 $\\{y_1, y_2\\}$，估计量 $T(y_1, y_2)$ 在点被置换后应保持不变，即 $T(y_1, y_2) = T(y_2, y_1)$。“自然不变性”这个短语也暗示了一个无偏的选择，指向中点 $c_i = (y_1 + y_2)/2$ 作为理想的对称估计量。\n4.  **保持稳健性：** 修改不应使整个程序的稳健性显著低于原始的基于中位数的提议。\n\n**逐项分析**\n\n**A. 在任何 $n_i = 2$ 的组中，将 $c_i$ 定义为两个顺序统计量的中点，即 $c_i = \\left(y_{i(1)} + y_{i(2)}\\right)/2$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。**\n1.  **解决定义不明确问题？** 是。中点为 $c_i$ 提供了一个唯一的、明确定义的值。\n2.  **位置等变性？** 是。令 $y'_{(1)} = y_{(1)} + a$ 和 $y'_{(2)} = y_{(2)} + a$。新的中心是 $c'_i = (y'_{(1)} + y'_{(2)})/2 = (y_{(1)}+a + y_{(2)}+a)/2 = (y_{(1)} + y_{(2)})/2 + a = c_i + a$。\n3.  **对称性？** 是。对于样本 $\\{y_1, y_2\\}$，中心是 $(y_1+y_2)/2$，这是两个点的典型对称位置估计量。\n4.  **保持稳健性？** 是。对于 $n_i  2$，程序仍然使用稳健的中位数。对于 $n_i=2$ 的特殊情况，它使用样本均值。对于大小为 2 的样本，均值、中位数（如选择中点这样的单点）和截尾均值之间没有区别。这个选择是可能的中位数区间中最自然的选择，并且不会损害方法的整体稳健性，后者是由其在所有样本量下的表现定义的。\n\n**结论：** 正确。这是处理此特定问题的标准和推荐方法。\n\n**B. 在任何 $n_i = 2$ 的组中，将 $c_i$ 定义为较小的观测值，即 $c_i = y_{i(1)}$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。**\n1.  **解决定义不明确问题？** 是。它为 $c_i$ 提供了一个唯一的值。\n2.  **位置等变性？** 是。$c'_i = y'_{(1)} = y_{(1)} + a = c_i + a$。\n3.  **对称性？** 否。估计量 $T(y_1, y_2) = \\min(y_1, y_2)$ 在置换下是对称的（$T(y_1, y_2) = T(y_2, y_1)$），但它没有以“自然”的对称性对待这两个点。这是一个任意有偏的选择，总是选择较小的值。中心趋势估计量不应系统性地偏向数据范围的一端。这违背了对称中心估计量的精神。\n4.  **保持稳健性？** 该估计量是一个顺序统计量，它对一侧的离群值是稳健的，但对另一侧的离群值则极为敏感。它不是一个平衡的稳健中心趋势估计量。鉴于在对称性上失败，此选项不合适。\n\n**结论：** 不正确。它未能满足中心估计量的自然对称性要求。\n\n**C. 将每组中的中位数替换为固定百分比的截尾均值（例如，10% 截尾均值），因此 $c_i$ 是一个唯一的截尾均值，且 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。**\n1.  **解决定义不明确问题？** 是。截尾均值对于任何样本量都是唯一定义的（在标准统计软件定义下）。对于 $n_i=2$ 和任何修剪百分比 $\\alpha  50\\%$，从每端修剪的观测数量 $\\lfloor n_i \\alpha \\rfloor$ 为 0。因此，截尾均值就是常规的样本均值，即 $(y_{i(1)}+y_{i(2)})/2$，这是唯一的。\n2.  **位置等变性？** 是。截尾均值是顺序统计量的线性组合，因此它是位置等变的。\n3.  **对称性？** 是。对于 $n_i=2$，截尾均值是中点，这是对称的。对于任何 $n_i$，截尾均值是数据的对称函数。\n4.  **保持稳健性？** 是。截尾均值是一种经典的位置稳健估计量，通常用作中位数的替代品。它在均值的效率和中位数的稳健性之间提供了平衡。这是对 Brown-Forsythe 检验的一个完全有效的替代方案。\n\n**结论：** 正确。此修改不仅解决了 $n_i=2$ 的问题，也解决了所有组大小的问题，并满足所有要求。\n\n**D. 从 Levene 型检验中排除任何 $n_i = 2$ 的组，以便所有组都满足 $n_i \\ge 3$。**\n1.  **解决定义不明确问题？** 是，它通过从分析中移除有问题的案例来回避问题。\n2.  **其他标准：** 这种修改是一种数据删除形式。虽然它在计算上“解决”了模糊性，但这是一种在统计上不健全的做法。它改变了被检验的假设（从比较所有 $k$ 个组变为比较组的子集），并丢弃了可能宝贵的信息。一个有效的统计 *程序* 应该旨在处理数据，而不是在没有充分理由（例如，数据质量问题，但这里不是这种情况）的情况下丢弃数据。这个选项没有提供方法上的修复，而是一种规避。从统计意义上讲，它不是一个恰当的解决方案。\n\n**结论：** 不正确。这是一种糟糕的统计实践，它改变了科学问题的范围，而不是修复方法论。\n\n**E. 使用从所有组合并计算的单个合并全局中位数 $\\tilde{y}$ 来计算 $z_{ij} = \\lvert y_{ij} - \\tilde{y} \\rvert$，而不是使用特定于组的中心。**\n1.  **解决定义不明确问题？** 是，单个合并中位数 $\\tilde{y}$ 可以唯一定义。\n2.  **其他标准：** 此修改从根本上改变了检验的性质。Levene 检验的逻辑要求测量与 *特定于组的* 中心的偏差，以分离出组的内部离散度（方差）。通过使用一个共同的中心 $\\tilde{y}$，转换值 $z_{ij}$ 现在混淆了组的内部离散度与组中心和全局中心之间的距离。对这些 $z_{ij}$ 值进行 ANOVA 将对组均值的差异以及组方差的差异都敏感。因此，它将不再是检验方差齐性的有效方法。该检验也将失去其对单个组位置移动的不变性。\n\n**结论：** 不正确。此修改使该程序作为方差齐性检验失效。\n\n**结论**\n选项 A 和 C 都为 $n_i=2$ 时中位数定义不明确的问题提供了有效的解决方案。两个选项都为 $n_i=2$ 的情况提供了一个唯一的、对称的、位置等变的中心，并且都保持了整个检验程序的稳健性。", "answer": "$$\\boxed{AC}$$", "id": "4957191"}, {"introduction": "现实世界的数据很少是完美的，测量过程本身就可能给我们的分析带来偏差。这个高级练习探讨了数据取整（一种常见的数据离散化形式）如何通过产生过多的相同值（特别是与中位数相等的值）来影响Levene检验的有效性。通过分析这个问题，您将学会识别并采用高级方法来纠正由数据质量问题引起的系统性偏差 [@problem_id:4957221]。", "problem": "一项生物统计学研究比较了 $g$ 个治疗组（标记为 $i=1,\\dots,g$，每个组的样本量为 $n_i$）中某一生物标志物的变异性。潜在的连续测量值为 $Y_{ij}$（代表第 $i$ 组中的第 $j$ 个受试者），但实验室仪器仅在离散网格上记录舍入值 $X_{ij}$：对于第 $i$ 组，观测到的 $X_{ij}$ 满足 $X_{ij} = \\delta_i \\cdot \\mathrm{round}\\!\\left(Y_{ij}/\\delta_i\\right)$，其中 $\\delta_i0$ 是特定于组的舍入宽度，$\\mathrm{round}(\\cdot)$ 映射到最近的整数。为了检验各组间方差的相等性，Brown–Forsythe Levene 方法构建了转换后的观测值 $Z_{ij} = \\lvert X_{ij} - \\tilde{X}_i\\rvert$，其中 $\\tilde{X}_i$ 是第 $i$ 组内的样本中位数，然后对 $Z_{ij}$ 进行单因素方差分析 (ANOVA)。\n\n从以下基本前提开始：\n- 样本中位数 $\\tilde{X}_i$ 是凸损失函数 $L_i(m) = \\sum_{j=1}^{n_i} \\lvert X_{ij} - m\\rvert$ 的任意一个最小值点。当中心出现并列值时，最小值点的集合是相邻顺序统计量之间的一个闭区间 $[\\tilde{X}_i^{\\mathrm{low}}, \\tilde{X}_i^{\\mathrm{high}}]$。\n- 舍入会引入测量误差 $E_{ij} = X_{ij} - Y_{ij}$，且 $E_{ij} \\in [-\\delta_i/2, \\delta_i/2]$。如果 $\\delta_i$ 在各组之间不同，离散化会改变 $\\lvert X_{ij} - \\tilde{X}_i\\rvert$ 的分布，当许多 $X_{ij}$ 等于 $\\tilde{X}_i$ 时，会在 $0$ 处产生过多的并列值。\n\n研究舍入和并列值如何影响 $Z_{ij}$ 及后续的方差分析，并选择一种在计算中位数和绝对偏差时能处理并列值，且不会在各组间方差相等性检验中引入系统性偏差的最佳方法。\n\n哪个选项最合适？\n\nA. 将 $\\tilde{X}_i$ 定义为中位数区间 $[\\tilde{X}_i^{\\mathrm{low}}, \\tilde{X}_i^{\\mathrm{high}}]$ 的中点，对于在该中位数上的并列观测值，用该并列块内的平均绝对偏差替换它们的 $Z_{ij}$ 以避免零值；然后对这些调整后的 $Z_{ij}$ 应用标准方差分析，即使 $\\delta_i$ 在各组间不同，这也能保证无偏推断。\n\nB. 对于每个组 $i$，向 $X_{ij}$ 添加独立的对称抖动 $U_{ij} \\sim \\mathrm{Uniform}(-\\delta_i/2,\\delta_i/2)$ 以获得 $X^{*}_{ij} = X_{ij} + U_{ij}$，计算 $\\{X^{*}_{ij}\\}_{j=1}^{n_i}$ 的样本中位数 $\\tilde{X}^{*}_i$ 和 $Z^{*}_{ij} = \\lvert X^{*}_{ij} - \\tilde{X}^{*}_i\\rvert$，然后对多次抖动重复产生的方差分析检验统计量取平均值；这保留了预期的绝对偏差，并中和了由特定于组的舍入和并列值引入的偏差。\n\nC. 用样本均值 $\\bar{X}_i$ 替换组中心，并计算 $Z_{ij} = \\lvert X_{ij} - \\bar{X}_i\\rvert$；均值不受并列值影响，因此这消除了舍入带来的偏差，并且对这些 $Z_{ij}$ 进行的方差分析在偏态和重尾分布下仍然有效。\n\nD. 通过使用次要键（例如，受试者标识符）对相等的 $X_{ij}$ 进行排序来任意打破并列，选择一个唯一的顺序统计量中位数，然后继续计算 $Z_{ij} = \\lvert X_{ij} - \\tilde{X}_i\\rvert$；任意的并列打破方法消除了零偏差，并产生无偏推断，因为它将绝对偏差均匀地分布到各组中。", "solution": "用户希望我验证问题陈述，如果有效，则通过评估给定选项来解决问题。\n\n### 步骤 1：提取已知条件\n- 一项生物统计学研究比较了 $g$ 个治疗组（$i=1,\\dots,g$）中某一生物标志物的变异性。\n- 第 $i$ 组的样本量为 $n_i$。\n- 潜在的连续测量值：$Y_{ij}$，代表第 $i$ 组中的第 $j$ 个受试者。\n- 观测到的舍入值：$X_{ij}$。\n- 舍入机制：$X_{ij} = \\delta_i \\cdot \\mathrm{round}\\!\\left(Y_{ij}/\\delta_i\\right)$，其中 $\\delta_i0$ 是特定于组的舍入宽度。\n- 检验是针对各组间方差的相等性。\n- 方法是 Brown–Forsythe Levene 型检验。\n- 转换后的观测值：$Z_{ij} = \\lvert X_{ij} - \\tilde{X}_i\\rvert$，其中 $\\tilde{X}_i$ 是 $\\{X_{ij}\\}_{j=1}^{n_i}$ 的样本中位数。\n- 对 $Z_{ij}$ 进行单因素方差分析 (ANOVA)。\n- 基本前提 1：样本中位数 $\\tilde{X}_i$ 是损失函数 $L_i(m) = \\sum_{j=1}^{n_i} \\lvert X_{ij} - m\\rvert$ 的最小值点。如果中心存在并列值，最小值点的集合是一个区间 $[\\tilde{X}_i^{\\mathrm{low}}, \\tilde{X}_i^{\\mathrm{high}}]$。\n- 基本前提 2：舍入误差 $E_{ij} = X_{ij} - Y_{ij}$ 位于 $[-\\delta_i/2, \\delta_i/2]$ 内。特定于组的 $\\delta_i$ 会通过在 $Z_{ij}=0$ 处产生过多的并列值来改变 $Z_{ij}$ 的分布。\n- 目标是找到处理并列值和舍入的最佳方法，以避免在方差相等性检验中产生系统性偏差。\n\n### 步骤 2：使用提取的已知条件进行验证\n检查问题陈述的有效性。\n\n- **科学上合理**：该问题在统计理论和实践中都有充分的根据。Brown-Forsythe 检验是检验方差相等性的标准方法，与其他检验（如 Bartlett 检验或原始 Levene 检验）相比，其稳健性备受推崇。由舍入（数据粗化）引起的测量误差问题是应用统计学中的一个现实而重要的问题，尤其是在仪器精度可能变化的生物统计学中。将中位数描述为绝对偏差之和的最小值点是一个基本属性。关于特定于组的舍入宽度 $\\delta_i$ 如何通过产生不同的并列率来引入偏差的分析在统计上是正确的。\n- **提法得当**：该问题提法得当。它提出了一个明确的统计挑战——方差相等性检验可能被差异性测量误差所混淆——并要求评估提出的解决方案。其目标是确定一种能够减轻这种偏差的方法，这在统计方法学中是一个可定义且可解决的任务。\n- **客观**：该问题使用精确、客观和标准的统计术语进行陈述。没有主观或基于意见的语言。\n\n该问题没有表现出任何无效性缺陷：\n1. 它在科学上是合理的。\n2. 它是可形式化的，并与生物统计学相关。\n3. 其设置是完整且一致的。\n4. 该情景是现实的。\n5. 它结构良好，能够引导对方法进行有意义的比较。\n6. 它解决了应用统计学中一个非同小可的问题。\n7. 所提出方法的有效性可以通过理论和模拟进行科学验证。\n\n### 步骤 3：结论与行动\n问题陈述是 **有效的**。我将继续进行解答。\n\n### 解答推导\n\n问题的核心是，当对具有特定于组的舍入宽度 $\\delta_i$ 的舍入数据 $X_{ij}$ 执行检验时，用于检验潜在连续变量 $Y_{ij}$ 方差相等性的 Brown-Forsythe 检验可能会产生偏差。零假设为 $H_0: \\mathrm{Var}(Y_{1j}) = \\mathrm{Var}(Y_{2j}) = \\dots = \\mathrm{Var}(Y_{gj})$。检验统计量是基于与中位数绝对偏差 $Z_{ij} = \\lvert X_{ij} - \\tilde{X}_i\\rvert$ 的 ANOVA F 统计量。ANOVA 比较这些偏差的组均值，$\\bar{Z}_i = \\frac{1}{n_i} \\sum_{j=1}^{n_i} Z_{ij}$。\n\n偏差的产生是因为较大的舍入宽度 $\\delta_i$ 会导致数据更粗糙，并列值更多。当一个组中有相当一部分数据点 $X_{ij}$ 正好落在组中位数 $\\tilde{X}_i$ 上时，大量的转换值 $Z_{ij}$ 会变为零。这会系统性地降低舍入宽度较大组的组平均偏差 $\\bar{Z}_i$，而这与 $Y_{ij}$ 的真实潜在方差无关。因此，检验可能会在没有差异时错误地检测到方差差异（I 类错误膨胀），或者在存在差异时未能检测到（功效损失），因为它实际上部分地在检验舍入宽度 $\\delta_i$ 的差异。\n\n一个有效的纠正方法必须解决这种在各组之间人为引起的 $Z_{ij}$ 分布差异。具体来说，它应该减轻由舍入引起的过多零值的影响。\n\n### 逐项分析\n\n**A. 将 $\\tilde{X}_i$ 定义为中位数区间 $[\\tilde{X}_i^{\\mathrm{low}}, \\tilde{X}_i^{\\mathrm{high}}]$ 的中点，对于在该中位数上的并列观测值，用该并列块内的平均绝对偏差替换它们的 $Z_{ij}$ 以避免零值；然后对这些调整后的 $Z_{ij}$ 应用标准方差分析，即使 $\\delta_i$ 在各组间不同，这也能保证无偏推断。**\n\n该选项提出了一种特设的插补方法。“该并列块内的平均绝对偏差”这一说法含糊不清。如果并列块由所有等于中位数 $\\tilde{X}_i$ 的观测值 $X_{ij}$ 组成，那么它们所有的偏差 $\\lvert X_{ij} - \\tilde{X}_i\\rvert$ 都为零，平均值也为零。这并不能解决问题。如果它的意思是对组内的非零偏差求平均，并用这个值进行插补，这是一种没有理论依据的任意修正。其“保证无偏推断”的强有力声明极不可能是真实的。这种简单的插补方案很少能完全纠正复杂的系统性偏差。\n\n**结论：不正确。**\n\n**B. 对于每个组 $i$，向 $X_{ij}$ 添加独立的对称抖动 $U_{ij} \\sim \\mathrm{Uniform}(-\\delta_i/2,\\delta_i/2)$ 以获得 $X^{*}_{ij} = X_{ij} + U_{ij}$，计算 $\\{X^{*}_{ij}\\}_{j=1}^{n_i}$ 的样本中位数 $\\tilde{X}^{*}_i$ 和 $Z^{*}_{ij} = \\lvert X^{*}_{ij} - \\tilde{X}^{*}_i\\rvert$，然后对多次抖动重复产生的方差分析检验统计量取平均值；这保留了预期的绝对偏差，并中和了由特定于组的舍入和并列值引入的偏差。**\n\n该选项描述了一种处理舍入数据的统计学原理方法，通常称为“去舍入”或“抖动”。舍入过程 $X_{ij} = \\delta_i \\cdot \\mathrm{round}(Y_{ij}/\\delta_i)$ 意味着真实值 $Y_{ij}$ 位于区间 $[X_{ij} - \\delta_i/2, X_{ij} + \\delta_i/2]$ 内。从该区间的范围内添加一个随机均匀偏差，即 $U_{ij} \\sim \\mathrm{Uniform}(-\\delta_i/2, \\delta_i/2)$，可以创建一个新的连续变量 $X^{*}_{ij} = X_{ij} + U_{ij}$。这可以解释为，在均匀条件分布的假设下（在没有其他信息的情况下是常见假设），从 $Y_{ij}$ 的已知区间中抽取一个可能的数值。\n\n这种抖动过程打破了 $X_{ij}$ 数据中的并列值，创建了一个连续样本 $X^{*}_{ij}$。因此，任何 $X^{*}_{ij}$ 恰好等于新中位数 $\\tilde{X}^{*}_i$ 的概率为零。这直接消除了 $Z_{ij}$ 值在零处有过量集中的问题。通过对抖动后的数据进行检验，我们是在一个试图重构原始连续尺度的尺度上评估变异性。对多次抖动重复的检验统计量取平均是一种基于模拟的推断形式（类似于多重插补），它对重构过程的不确定性进行了平均，从而得出更稳定和有效的推断。这个程序旨在中和由各组之间不同舍入引入的偏差。\n\n**结论：正确。**\n\n**C. 用样本均值 $\\bar{X}_i$ 替换组中心，并计算 $Z_{ij} = \\lvert X_{ij} - \\bar{X}_i\\rvert$；均值不受并列值影响，因此这消除了舍入带来的偏差，并且对这些 $Z_{ij}$ 进行的方差分析在偏态和重尾分布下仍然有效。**\n\n该选项建议回归到原始的 Levene 检验，该检验使用均值 $\\bar{X}_i$ 作为中心度量。引入 Brown-Forsythe 修正（使用中位数）正是因为原始 Levene 检验对非正态性，特别是偏态分布不具有稳健性。在偏态分布中，绝对偏差的均值与数据的均值相关，这可能使检验因错误的原因而拒绝方差相等的零假设。因此，该检验“在偏态和重尾分布下仍然有效”的说法是错误的；这恰恰是这种方法的弱点。此外，虽然均值的计算是唯一的，但“这消除了舍入带来的偏差”的说法也是错误的。舍入仍然影响 $X_{ij}$ 的值，从而也影响它们的均值 $\\bar{X}_i$。不同的舍入宽度 $\\delta_i$ 仍然会扭曲数据分布，从而扭曲绝对偏差的分布，尽管其方式可能与使用中位数时不同。这并不能解决根本问题。\n\n**结论：不正确。**\n\n**D. 通过使用次要键（例如，受试者标识符）对相等的 $X_{ij}$ 进行排序来任意打破并列，选择一个唯一的顺序统计量中位数，然后继续计算 $Z_{ij} = \\lvert X_{ij} - \\tilde{X}_i\\rvert$；任意的并列打破方法消除了零偏差，并产生无偏推断，因为它将绝对偏差均匀地分布到各组中。**\n\n这个选项没有抓住问题的要点。困难不在于中位数的不唯一性，这只在样本量为偶数且两个中心顺序统计量不同时才会发生。主要问题是大量观测值*等于*中位数，导致它们所有的 $Z_{ij}=0$。任意对并列值排序（例如，使用受试者 ID）可能有助于从一组并列的中心值中选择单个数据点作为中位数，但这并不能改变许多其他数据点可能具有相同值的事实。例如，如果数据是 $\\{10, 20, 20, 20, 30\\}$，中位数是 $20$。任意对三个值为 $20$ 的数据进行排序并不能改变中位数的值，也不能改变对于三个观测值 $Z_{ij} = \\lvert 20 - 20 \\rvert = 0$ 这一事实。声称这“消除了零偏差”是错误的。声称能产生“无偏推断”同样没有根据，因为这个过程根本没有解决舍入造成的失真问题。\n\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "4957221"}]}