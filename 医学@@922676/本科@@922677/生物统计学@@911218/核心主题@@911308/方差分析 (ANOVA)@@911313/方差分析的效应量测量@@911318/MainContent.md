## 引言
在统计分析中，[方差分析](@entry_id:275547)（ANOVA）的$F$检验是判断组间均值是否存在差异的有力工具。然而，一个显著的$p$值仅仅告诉我们效应可能存在，却无法衡量其大小或现实意义——这是一个关键的知识缺口。效应大小度量正是为了弥补这一不足而生，它量化了自变量对因变量影响的强度，为我们提供了超越统计显著性的、更具实践价值的洞见。

本文将系统地引导您掌握[方差分析](@entry_id:275547)中的效应大小。在第一部分**「原理与机制」**中，我们将从方差分解的基本思想出发，深入剖析Eta平方（$\eta^2$）、Omega平方（$\omega^2$）和偏Eta平方（$\eta_p^2$）的计算公式、理论偏差及其在复杂设计下的应用。接着，在**「应用与跨学科连接」**部分，我们将展示这些度量如何在医学研究、心理学和生物信息学等真实场景中，帮助研究者[量化效应](@entry_id:198269)、改进实验设计并进行有效的科学沟通。最后，通过**「动手实践」**部分，您将有机会运用所学知识解决具体问题，巩固对不同设计下效应大小计算的理解。让我们一同开启这段旅程，学习如何更全面、更深刻地解读您的研究数据。

## 原理与机制

在方差分析（Analysis of Variance, ANOVA）的框架中，显著性检验（如 $F$ 检验）能够告诉我们一个或多个分组（或因子）的均值之间是否存在统计学上显著的差异。然而，它并不能量化这种差异的大小或其在现实世界中的重要性。一个非常显著的 $p$ 值可能仅仅反映了巨大的样本量，而效应本身可能微不足道。因此，为了衡量一个自变量（或因子）对因变量的影响程度，我们需要使用**效应大小（effect size）**指标。本章将系统阐述方差分析中各种效应大小度量的基本原理、计算机制及其在不同研究设计下的应用和解释。

### 基本原理：[方差分解](@entry_id:272134)与Eta平方 ($\eta^2$)

方差分析的核心思想是将因变量的总变异（variation）分解为不同来源的部分。在最简单的[单因素方差分析](@entry_id:163873)中，总变异由**总平方和（Total Sum of Squares, $SS_T$）**来度量，它可以被精确地分解为两部分：一部分是由于不同处理组（或因子水平）之间的均值差异所引起的**组间平方和（Between-groups Sum of Squares, $SS_B$）**，这部分变异被视为模型可以解释的变异；另一部分是每个处理组内部的随机波动，即**组内平方和（Within-groups Sum of Squares, $SS_W$）**，也被称为[误差平方和](@entry_id:149299)（$SS_{\text{Error}}$），代表了模型无法解释的变异。这种分解关系可以表示为：

$SS_T = SS_B + SS_W$

基于这一基本原理，最直观的效应大小度量是计算由自变量解释的变异占总变异的比例。这个度量被称为 **Eta平方（eta-squared）**，用符号 $\eta^2$ 表示。它直接反映了[自变量](@entry_id:267118)解释了因变量总方差的百分之多少。其计算公式为：

$$ \eta^2 = \frac{SS_B}{SS_T} $$

例如，在一项使用[单因素方差分析](@entry_id:163873)的研究中，如果分析得出总平方和 $SS_T = 1500$，而由不同处理水平引起的组间平方和 $SS_B = 450$，那么该处理的效应大小 $\eta^2$ 为 $450 / 1500 = 0.3$。这表明，因变量总变异的 $30\%$ 可以由该处理（自变量）的不同水平来解释 [@problem_id:4909857]。

为了更深入地理解[方差分解](@entry_id:272134)，我们可以从原始数据出发。假设一项临床试验比较三种膳食干预措施对[低密度脂蛋白胆固醇](@entry_id:172654)（LDL-C）降低值的影响。总样本量为 $N=60$，三个组各 $n=20$ 人。已知各组均值和组内平方和后，我们可以独立计算 $SS_B$ 和 $SS_W$。例如，若组均值分别为 $47, 50, 53 \ \mathrm{mg/dL}$，总体均值为 $50 \ \mathrm{mg/dL}$，则组间平方和 $SS_B$ 计算为各组均值与[总体均值](@entry_id:175446)之差的加权平方和：

$$ SS_B = \sum_{g=1}^{G} n_g (\bar{y}_g - \bar{y})^2 = 20(47-50)^2 + 20(50-50)^2 + 20(53-50)^2 = 360 $$

若已知各组内部的平方和总计为 $SS_W = 840$，我们可以验证[方差分解](@entry_id:272134)的恒等式：$SS_B + SS_W = 360 + 840 = 1200$。如果研究报告的总平方和 $SS_T$ 恰好是 $1200$，则证明了数据的一致性。此时，我们可以计算出归因于膳食干预的[已解释方差](@entry_id:172726)比例为 $\eta^2 = SS_B / SS_T = 360 / 1200 = 0.3$ [@problem_id:4909836]。

### 与广义线性模型的联系：$\eta^2$ 和[决定系数](@entry_id:142674) ($R^2$)

[方差分析](@entry_id:275547)并非一个孤立的统计方法，它实际上是广义线性模型（General Linear Model, GLM）的一个特例。一个[单因素方差分析](@entry_id:163873)模型可以等价地表示为一个使用指示变量（indicator variables）的[线性回归](@entry_id:142318)模型。在这种回归表述中，模型的**回归平方和（Regression Sum of Squares, $SSR$）**度量了由自变量（即分组[指示变量](@entry_id:266428)）解释的变异。

通过数学推导可以证明，在单因素固定效应方差分析中，组间平方和 $SS_B$ 与其等价[回归模型](@entry_id:163386)中的回归平方和 $SSR$ 是完全相等的。[回归分析](@entry_id:165476)中一个核心的效应大小度量是**[决定系数](@entry_id:142674)（coefficient of determination）**，记为 $R^2$，它定义为由回归模型解释的变异占总变异的比例，即 $R^2 = SSR / SS_T$。

由于在[单因素ANOVA](@entry_id:163873)中 $SS_B = SSR$，因此我们得到一个重要的结论：

$$ \eta^2 = \frac{SS_B}{SS_T} = \frac{SSR}{SS_T} = R^2 $$

这意味着，对于单因素固定效应ANOVA，Eta平方和[决定系数](@entry_id:142674)在数值上是完全相同的。例如，对于一个 $SS_T = 1000$ 和 $SS_B = 300$ 的单因素设计，我们计算得到 $\eta^2 = 300/1000 = 0.3$。其等价的[回归模型](@entry_id:163386)也会得到 $R^2 = 0.3$ [@problem_id:4909875]。

然而，这种等价性仅限于单因[素模型](@entry_id:155161)。当模型中包含多个因子（如双因素[ANOVA](@entry_id:275547)）、协变量（如ANCOVA）或随机效应时，模型的总 $R^2$ 会汇总所有解释变量的贡献，而针对单个因子的 $\eta^2$（即 $SS_{\text{factor}} / SS_T$）则只反映该因子的贡献，此时两者便不再相等。这个区别也为我们引入更复杂的效应大小度量埋下了伏笔。

### 从样本到总体：$\eta^2$ 的偏差与Omega平方 ($\omega^2$)

我们从样本数据中计算出的 $\eta^2$ 是对总体中真实效应大小 $\eta_p^2$ 的一个估计。然而，$\eta^2$ 是一个**有偏估计量（biased estimator）**，它倾向于系统性地高估总体的真实效应大小。

这种向上偏差的根本原因在于，即使在总体中没有任何真实效应（即所有组的总体均值完全相等），仅由于[抽样误差](@entry_id:182646)，我们观察到的样本组均值几乎总会存在一些差异。这些随机差异会被计算到 $SS_B$ 中，导致样本中的 $\eta^2$ 值大于零。我们可以通过期望均方（Expected Mean Squares）的框架来量化这种偏差。在[固定效应模型](@entry_id:142997)中，$SS_B$ 的[期望值](@entry_id:150961)不仅包含由真实效应 $\tau_i$ 贡献的部分，还包含一个与误差方差 $\sigma^2$ 相关的部分：

$$ \mathbb{E}[SS_B] = n G \sigma_\tau^2 + (G-1)\sigma^2 $$

其中 $G$ 是组数，$n$ 是每组样本量，$\sigma_\tau^2$ 是真实效应的方差。这个 $(G-1)\sigma^2$ 项就是源于抽样误差的“噪音”污染，它系统性地抬高了 $SS_B$ 的值，从而导致 $\mathbb{E}[\eta^2] > \eta_p^2$ [@problem_id:4909881]。在一个极端情况——即零假设成立（$\sigma_\tau^2=0$）时——可以精确证明 $\mathbb{E}[\eta^2] = (G-1)/(N-1)$，这个值显然大于零，从而证实了其正向偏差。

为了修正这种偏差，统计学家提出了 **Omega平方（omega-squared）**，记为 $\omega^2$。它通过从 $SS_B$ 中减去其期望的噪音部分，并对分母进行相应调整，来提供一个偏差更小的估计。其计算公式为：

$$ \omega^2 = \frac{SS_B - (G - 1) MS_W}{SS_T + MS_W} $$

这里，$G$ 是组数，$MS_W$ 是组内均方（$SS_W$ 除以其自由度），它是对误差方差 $\sigma^2$ 的一个无偏估计。因此，分子中的 $(G - 1) MS_W$ 就是对 $SS_B$ 中噪音成分的估计。

通过比较 $\eta^2$ 和 $\omega^2$，我们通常会发现 $\omega^2  \eta^2$。例如，在一项 $G=4$ 个干预组的研究中，若 $SS_T=1500$, $SS_B=450$, 且 $MS_W=10$，我们计算得出：
$\eta^2 = 450 / 1500 = 0.3$
$\omega^2 = (450 - (4-1) \times 10) / (1500 + 10) = 420 / 1510 \approx 0.2781$
可以看到，经过偏差校正后的 $\omega^2$ 值更小，这通常被认为是对总体效应大小更保守、更准确的估计 [@problem_id:4909891]。

### 复杂设计中的效应大小：偏Eta平方 ($\eta_p^2$)

当研究设计包含多个因子时（例如，一个双因素[ANOVA](@entry_id:275547)），总变异会被分解为多个主效应、[交互效应](@entry_id:164533)以及误差项的贡献，即 $SS_{\text{Total}} = SS_A + SS_B + SS_{AB} + SS_{\text{Error}}$。在这种情况下，如果我们使用传统的 $\eta^2$ 来计算因子A的效应大小（即 $\eta_A^2 = SS_A / SS_{\text{Total}}$），其值会因为分母中包含了由其他因子（$B$ 和 $AB$）解释的变异而被“稀释”。

为了解决这个问题，研究者引入了 **偏Eta平方（partial eta-squared）**，记为 $\eta_p^2$。它衡量的是某个特定因子解释的变异占“剩余”变异的比例，这里的“剩余”变异指的是该因子能够解释的变异与所有模型都无法解释的变异（即误差）之和。对于因子A，其计算公式为：

$$ \eta_{p,A}^2 = \frac{SS_A}{SS_A + SS_{\text{Error}}} $$

这个公式的分母排除了由模型中其他因子（$B$ 和 $AB$）所解释的变异，从而提供了一个“纯粹”的、不受模型中其他因素影响的效应大小度量。

由于 $\eta_p^2$ 的分母通常小于或等于 $\eta^2$ 的分母（$SS_{\text{Total}}$），因此对于同一个效应，$\eta_p^2$ 的值通常会大于或等于 $\eta^2$ 的值 [@problem_id:4909871]。例如，在一个双因素ANOVA中，若 $SS_A = 120$, $SS_B = 80$, $SS_{AB} = 60$, $SS_{\text{Error}} = 740$，则 $SS_{\text{Total}} = 1000$。对于因子A：
- 传统的 $\eta_A^2 = 120 / 1000 = 0.12$
- 偏 $\eta_{p,A}^2 = 120 / (120 + 740) = 120 / 860 \approx 0.1395$
在此例中，$\eta_p^2$ 的值更大，因为它没有受到因子B和[交互作用](@entry_id:164533)项解释的方差的影响 [@problem_id:4909873]。正因如此，在多因素设计中，报告 $\eta_p^2$ 更为常见，因为它使得不同研究中对同一个因子的效应大小比较成为可能——但这需要一个重要的前提。

### 高级考量与注意事项

#### 效应大小的可比性

尽管 $\eta_p^2$ 的设计初衷是为了提高跨研究的可比性，但这种可比性是有严格限制的。$\eta_p^2$ 的值严重依赖于模型设定，特别是模型中包含哪些其他效应。这是因为 $SS_{\text{Error}}$ 的值会随着模型中包含的因子数量和类型的变化而变化。

让我们通过一个思想实验来理解这一点 [@problem_id:4909834]。假设研究1只包含因子A，得到 $SS_A = 180$, $SS_{\text{Error}} = 420$。此时，$\eta_{p,A}^2 = 180 / (180 + 420) = 0.30$。现在，研究2在模型中额外加入了因子B和交互项 $A \times B$。假设因子A的平方和仍然是 $SS_A = 180$（在平衡设计中可能发生），但由于因子B和交互项解释了一部分原先归于误差的方差，新的[误差平方和](@entry_id:149299)减小为 $SS_{\text{Error}} = 260$。此时，因子A的偏Eta平方变为 $\eta_{p,A}^2 = 180 / (180 + 260) \approx 0.409$。

这个例子清楚地表明，仅仅因为在模型中加入了其他预测变量，因子A的偏效应大小就从 $0.30$ 显著增加到 $0.409$。因此，一个至关重要的结论是：**只有当两个研究的[统计模型](@entry_id:755400)完全相同时（即包含相同的因子、协变量和交互项），它们报告的偏Eta平方值才是可以直接比较的。**

#### 非平衡设计与平方和类型

在现实研究中，非平衡设计（即各组样本量不同）非常普遍。在非平衡设计中，各个因子和交互项所解释的方差不再是正交（orthogonal）的，它们之间存在重叠。这导致了计算平方和的不同方法，主要有三种类型：

- **I型平方和（Type I SS）**：又称序贯平方和，其值依赖于因子进入模型的顺序。它将重叠部分的方差全部分配给先进入模型的因子。这种方法通常不适用于[假设检验](@entry_id:142556)，因为结果会因研究者主观设定的模型顺序而异。

- **II型平方和（Type II SS）**：又称分层或部分平方和，它在计算一个主效应的平方和时，会校正（控制）其他主效应的影响，但忽略[交互效应](@entry_id:164533)。这种方法基于“边际性原则”，只有在假设[交互效应](@entry_id:164533)为零时才是合适的。

- **III型平方和（Type III SS）**：又称边际或正交平方和，它在计算一个效应的平方和时，会校正模型中所有其他效应（包括其他主效应和[交互效应](@entry_id:164533)）的影响。它检验的是一个因子在所有其他因子存在的情况下的“独特”贡献。当存在显著的[交互效应](@entry_id:164533)时，III型平方和通常是解释主效应的首选。

在非平衡设计中，这三种类型的平方和计算出的值通常是不同的。因此，研究者报告的效应大小（无论是 $\eta^2$ 还是 $\eta_p^2$）的值将取决于他们使用了哪种类型的平方和。在平衡设计中，所有因子的效应都是正交的，三种类型的平方和会得到完全相同的结果。因此，在阅读或报告来自非平衡设计的效应大小时，明确平方和的类型至关重要 [@problem_id:4909893]。

#### 重复测量与混合设计中的效应大小

在包含重复测量（within-subject）因子的设计中，[方差分解](@entry_id:272134)变得更加复杂，因为总变异中包含了被试间的个体差异。为了处理这种情况并提供更具可比性的效应大小度量，**广义Eta平方（Generalized Eta-Squared, $\eta_G^2$）**被提出。

$\eta_G^2$ 的核心思想是通过精心选择分母中的[方差分量](@entry_id:267561)，使得效应大小在不同设计（纯组间、纯组内或混合设计）之间具有更好的可比性。然而，并没有一个唯一的“正确”公式。分母的选择取决于研究者想要回答的问题。例如，一个效应的大小是相对于所有可测量的变异，还是相对于所有与被试个体差异无关的变异？[@problem_id:4909903]

例如，在一个混合设计中，我们可以将某效应的平方和（如组[内因子](@entry_id:148039)A的 $SS_A$）除以所有固定效应（包括交互项）的平方和之和。这个分母排除了所有与随机被试效应相关的[方差分量](@entry_id:267561)（如 $SS_{S(B)}$ 和 $SS_{S(B) \times A}$），从而提供了一个关注于“可操纵”变量效应强度的度量。这种灵活但复杂的选择凸显了一个高级主题：效应大小度量远不止一个简单的公式，它是一个工具箱，研究者必须根据其研究设计和理论问题，明智地选择并清晰地报告他们所使用的度量及其背后的原理。