{"hands_on_practices": [{"introduction": "第一个练习旨在建立方差分析（ANOVA）检验中的 $F$ 统计量与偏 eta 平方（$\\eta_p^2$）效应量之间的直接数学联系。通过从已知的 $F$ 值反推，您不仅能计算出效应量，还能加深对平方和、均方及自由度之间内在关系的理解。这个练习清楚地表明，F 检验告诉我们效应是否*存在*，而 $\\eta_p^2$ 则告诉我们该效应有多*大*。[@problem_id:4909886]", "problem": "一个生物统计学团队进行单因素方差分析（ANOVA），以比较 $3$ 个治疗组的某个连续生物标志物。已发表的摘要报告了一个 $F$ 统计量 $F=12.0$，其分子自由度（效应自由度）为 $df_{\\text{effect}}=2$，分母自由度（误差自由度）为 $df_{\\text{error}}=40$。从方差分析（ANOVA）的基本定义出发——即效应平方和与误差平方和划分了模型的变异性，某来源的均方（MS）等于其平方和除以其自由度，以及 $F$ 统计量等于效应均方与误差均方之比——请从第一性原理推导出所报告效应的偏eta平方（$\\eta_p^2$）。将偏eta平方（$\\eta_p^2$）解释为在只考虑效应和误差分量时，可归因于效应的模型变异性的比例。\n\n然后，为了说明 $F$ 统计量、自由度和平方和之间的关系，采用任意缩放，将误差均方设置为 $MS_{\\text{error}}=1$，并在此缩放下反向计算出与所报告的 $F$、$df_{\\text{effect}}$ 和 $df_{\\text{error}}$ 一致的相应 $SS_{\\text{effect}}$ 和 $SS_{\\text{error}}$。使用这些值来验证您推导出的 $\\eta_{p}^{2}$ 表达式。\n\n最终答案仅报告 $\\eta_p^2$ 的数值。以小数形式表示最终答案，并四舍五入到四位有效数字。", "solution": "首先提取给定信息，然后评估其科学有效性和完整性，从而对问题进行验证。\n\n**步骤1：提取已知条件**\n-   分析方法为单因素方差分析（ANOVA）。\n-   治疗组数量：$3$。\n-   $F$ 统计量：$F=12.0$。\n-   分子自由度（效应）：$df_{\\text{effect}}=2$。\n-   分母自由度（误差）：$df_{\\text{error}}=40$。\n-   基本定义：\n    -   效应平方和（$SS_{\\text{effect}}$）与误差平方和（$SS_{\\text{error}}$）划分了模型的变异性。\n    -   均方（MS）：$MS = \\frac{SS}{df}$。\n    -   $F$ 统计量：$F = \\frac{MS_{\\text{effect}}}{MS_{\\text{error}}}$。\n-   偏 eta 平方（$\\eta_p^2$）的定义：在只考虑效应和误差分量时，可归因于效应的模型变异性的比例。这意味着 $\\eta_p^2 = \\frac{SS_{\\text{effect}}}{SS_{\\text{effect}} + SS_{\\text{error}}}$。\n-   需要进行验证任务：设置 $MS_{\\text{error}}=1$，反向计算 $SS_{\\text{effect}}$ 和 $SS_{\\text{error}}$，并用它们来确认 $\\eta_p^2$ 的值。\n-   $\\eta_p^2$ 的最终答案必须是四舍五入到四位有效数字的小数。\n\n**步骤2：使用已知条件进行验证**\n问题具有科学依据，提法明确且客观。\n-   **科学依据：** 问题基于方差分析（ANOVA）的基本原理，这是一种标准且普遍接受的统计方法。所提供的 $MS$、$F$ 和 $\\eta_p^2$ 的定义是正确的。组数（$k=3$）与效应自由度一致，因为 $df_{\\text{effect}} = k-1 = 3-1 = 2$。\n-   **提法明确性：** 提供了所有必要信息（$F$、$df_{\\text{effect}}$、$df_{\\text{error}}$）以推导出 $\\eta_p^2$ 的唯一值。指令清晰，能导出一个单一、可验证的解。\n-   **客观性：** 问题使用精确、标准的统计术语提出，没有任何主观或含糊的语言。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。现在开始解题过程。\n\n目标是根据 $F$ 统计量及其相关自由度推导出偏 eta 平方 $\\eta_p^2$ 的表达式，然后计算其值。\n\n根据所提供的定义，偏 eta 平方是效应平方和相对于效应平方和与误差平方和之和的比例。用数学公式表示为：\n$$ \\eta_p^2 = \\frac{SS_{\\text{effect}}}{SS_{\\text{effect}} + SS_{\\text{error}}} $$\n为了用给定数量表示该式，我们使用方差分析的基本定义。$F$ 统计量是效应均方与误差均方之比：\n$$ F = \\frac{MS_{\\text{effect}}}{MS_{\\text{error}}} $$\n而均方又被定义为平方和除以其各自的自由度：\n$$ MS_{\\text{effect}} = \\frac{SS_{\\text{effect}}}{df_{\\text{effect}}} \\quad \\text{和} \\quad MS_{\\text{error}} = \\frac{SS_{\\text{error}}}{df_{\\text{error}}} $$\n将这些代入 $F$ 统计量的表达式中，得到：\n$$ F = \\frac{SS_{\\text{effect}} / df_{\\text{effect}}}{SS_{\\text{error}} / df_{\\text{error}}} $$\n从此方程中，我们可以分离出平方和的比率：\n$$ \\frac{SS_{\\text{effect}}}{SS_{\\text{error}}} = F \\cdot \\frac{df_{\\text{effect}}}{df_{\\text{error}}} $$\n现在，我们回到 $\\eta_p^2$ 的定义。为了将其与此比率联系起来，我们可以将 $\\eta_p^2$ 表达式的分子和分母同时除以 $SS_{\\text{error}}$：\n$$ \\eta_p^2 = \\frac{SS_{\\text{effect}} / SS_{\\text{error}}}{(SS_{\\text{effect}} / SS_{\\text{error}}) + (SS_{\\text{error}} / SS_{\\text{error}})} = \\frac{SS_{\\text{effect}} / SS_{\\text{error}}}{(SS_{\\text{effect}} / SS_{\\text{error}}) + 1} $$\n代入我们从 $F$ 统计量推导出的平方和比率的表达式：\n$$ \\eta_p^2 = \\frac{F \\cdot \\frac{df_{\\text{effect}}}{df_{\\text{error}}}}{F \\cdot \\frac{df_{\\text{effect}}}{df_{\\text{error}}} + 1} $$\n为了简化此表达式，我们将分子和分母同时乘以 $df_{\\text{error}}$：\n$$ \\eta_p^2 = \\frac{F \\cdot df_{\\text{effect}}}{F \\cdot df_{\\text{effect}} + df_{\\text{error}}} $$\n这就是从第一性原理推导出的偏 eta 平方的通用公式。\n\n我们现在可以代入给定的数值：$F=12.0$，$df_{\\text{effect}}=2$ 和 $df_{\\text{error}}=40$。\n$$ \\eta_p^2 = \\frac{12.0 \\times 2}{(12.0 \\times 2) + 40} = \\frac{24}{24 + 40} = \\frac{24}{64} $$\n化简该分数得到：\n$$ \\eta_p^2 = \\frac{3 \\times 8}{8 \\times 8} = \\frac{3}{8} = 0.375 $$\n\n接下来，我们进行所要求的验证。我们采用任意缩放，将误差均方设置为 $MS_{\\text{error}} = 1$。\n使用 $F$ 统计量的定义，我们可以找到相应的效应均方：\n$$ MS_{\\text{effect}} = F \\cdot MS_{\\text{error}} = 12.0 \\times 1 = 12.0 $$\n现在，我们反向计算出与这些均方和给定自由度一致的平方和：\n$$ SS_{\\text{effect}} = MS_{\\text{effect}} \\cdot df_{\\text{effect}} = 12.0 \\times 2 = 24 $$\n$$ SS_{\\text{error}} = MS_{\\text{error}} \\cdot df_{\\text{error}} = 1 \\times 40 = 40 $$\n使用这些平方和，我们可以直接从其基本定义计算 $\\eta_p^2$：\n$$ \\eta_p^2 = \\frac{SS_{\\text{effect}}}{SS_{\\text{effect}} + SS_{\\text{error}}} = \\frac{24}{24 + 40} = \\frac{24}{64} = 0.375 $$\n此结果与使用推导公式计算出的值相符，从而验证了其正确性。\n\n问题要求最终答案四舍五入到四位有效数字。精确值为 $0.375$。为了用四位有效数字表示，我们写作 $0.3750$。\n这个$\\eta_p^2 = 0.3750$的值意味着模型中 $37.5\\%$ 的变异性（由效应和误差组成）可归因于治疗组效应。", "answer": "$$\\boxed{0.3750}$$", "id": "4909886"}, {"introduction": "在上一练习的基础上，本题将探讨在多因素方差分析中总变异是如何被分解的。您将使用一个平衡双因素设计的数据，计算每个主效应和交互作用的 eta 平方（$\\eta^2$）。此练习将突显平衡设计的一个关键特性：正交性。在正交设计中，由各部分解释的方差可以清晰地相加，其总和等于模型解释的总方差（$R^2$），从而为我们提供一幅关于每个因素贡献的清晰、可解释的图景。[@problem_id:4909895]", "problem": "一个生物统计学团队进行了一项平衡双因素实验，以研究一个连续生物标志物的变异性。因素$A$具有代表饮食模式的固定水平，因素$B$具有代表身体活动类别的固定水平，并且考虑了它们的交互作用。该研究设计在所有单元格上都是平衡的，并使用了标准的双因素方差分析（ANOVA）。从拟合模型中报告的平方和为：总平方和 $SS_T = 2400$，因素$A$的主效应平方和 $SS_A = 600$，因素$B$的主效应平方和 $SS_B = 300$，以及交互作用平方和 $SS_{AB} = 200$。\n\n从方差分析中效应量的核心定义出发，即效应量量化了可归因于特定来源的总变异性的比例，并且模型的整体解释力由所有建模来源共同解释的总变异性的比例来量化，推导并计算每个建模来源（$A$、$B$ 和 $A \\times B$）的eta平方（$\\eta^2$）以及模型的决定系数（$R^2$）。然后，在这种平衡双因素方差分析的背景下，解释各个来源的eta平方值之和与模型$R^2$之间是否存在任何差异。\n\n将所有数值结果以精确分数形式报告。无需四舍五入。解释应包含在您的推导过程中，但最终答案必须只包含所要求的数值结果。", "solution": "该问题是有效的，因为它科学地基于方差分析（ANOVA）的原理，问题陈述清晰，数据充分且一致，并以客观语言表达。\n\n分析从方差分析（ANOVA）背景下效应量度量的基本定义开始。总平方和（Total Sum of Squares, $SS_T$）代表了所收集数据中的总变异性。给定值为 $SS_T = 2400$。\n\n效应量度量eta平方，记作$\\eta^2$，量化了可归因于特定变异来源（一个因素或一个交互作用）的总变异性的比例。其定义为：\n$$ \\eta^2_{\\text{source}} = \\frac{SS_{\\text{source}}}{SS_T} $$\n其中 $SS_{\\text{source}}$ 是特定来源的平方和。\n\n我们将此定义应用于问题中提供的每个建模来源：因素$A$、因素$B$以及交互作用$A \\times B$。\n\n对于因素$A$，其平方和为 $SS_A = 600$。相应的eta平方为：\n$$ \\eta^2_A = \\frac{SS_A}{SS_T} = \\frac{600}{2400} = \\frac{1}{4} $$\n这表明因素$A$（饮食模式）解释了该生物标志物总变异性的$25\\%$。\n\n对于因素$B$，其平方和为 $SS_B = 300$。相应的eta平方为：\n$$ \\eta^2_B = \\frac{SS_B}{SS_T} = \\frac{300}{2400} = \\frac{3}{24} = \\frac{1}{8} $$\n这表明因素$B$（身体活动类别）解释了总变异性的$12.5\\%$。\n\n对于交互作用效应$A \\times B$，其平方和为 $SS_{AB} = 200$。相应的eta平方为：\n$$ \\eta^2_{AB} = \\frac{SS_{AB}}{SS_T} = \\frac{200}{2400} = \\frac{2}{24} = \\frac{1}{12} $$\n这表明饮食和身体活动之间的交互作用解释了总变异性的大约$8.33\\%$。\n\n接下来，我们讨论模型的整体解释力，它由决定系数 $R^2$ 量化。$R^2$ 定义为所有建模来源共同解释的总变异性的比例。这是模型平方和 $SS_{\\text{model}}$ 与总平方和 $SS_T$ 的比率。\n$$ R^2 = \\frac{SS_{\\text{model}}}{SS_T} $$\n模型平方和 $SS_{\\text{model}}$ 是方差分析模型所捕获的总变异，包括所有因素及其交互作用。一个关键信息是该实验采用了**平衡设计**。在平衡方差分析中，不同效应（主效应和交互作用）的平方和是正交的。这意味着它们代表了不重叠的方差来源，它们的和等于模型所解释的总平方和。\n因此，对于这种平衡设计，模型平方和就是模型中包含的每个效应的平方和之和：\n$$ SS_{\\text{model}} = SS_A + SS_B + SS_{AB} $$\n使用给定值：\n$$ SS_{\\text{model}} = 600 + 300 + 200 = 1100 $$\n现在，我们可以计算决定系数 $R^2$：\n$$ R^2 = \\frac{SS_{\\text{model}}}{SS_T} = \\frac{1100}{2400} = \\frac{11}{24} $$\n这意味着整个模型（饮食、活动及其交互作用）解释了该生物标志物总变异性的大约$45.83\\%$。\n\n最后，我们解释各个eta平方值之和与模型$R^2$之间的关系。让我们计算这个和：\n$$ \\eta^2_A + \\eta^2_B + \\eta^2_{AB} = \\frac{1}{4} + \\frac{1}{8} + \\frac{1}{12} $$\n为了对这些分数求和，我们找到一个公分母，即$24$：\n$$ \\frac{6}{24} + \\frac{3}{24} + \\frac{2}{24} = \\frac{6+3+2}{24} = \\frac{11}{24} $$\n我们观察到：\n$$ \\eta^2_A + \\eta^2_B + \\eta^2_{AB} = R^2 $$\n在这种平衡双因素方差分析的背景下，不存在差异。各个来源的eta平方值之和恰好等于模型的总决定系数$R^2$。这是平衡设计中平方和正交性的直接数学结果。总解释方差 $SS_{\\text{model}}$被清晰地划分到各个因素及其交互作用中，并且这种可加性划分直接延续到总方差的比例（$\\eta^2$值）上。值得注意的是，这种简单的可加关系在非平衡设计中不成立，因为在非平衡设计中，各效应的平方和是相关的，它们的和不等于模型平方和。\n\n计算出的数值结果是：$\\eta^2_A = \\frac{1}{4}$，$\\eta^2_B = \\frac{1}{8}$，$\\eta^2_{AB} = \\frac{1}{12}$，以及 $R^2 = \\frac{11}{24}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{1}{8}  \\frac{1}{12}  \\frac{11}{24} \\end{pmatrix}}\n$$", "id": "4909895"}, {"introduction": "现实世界的数据很少是完美平衡的。最后一个练习将带您直面不平衡设计的挑战，在这种情况下，方差分量的简单可加性将不复存在。您将使用 II 型平方和来计算效应量，并从概念上探讨为什么不同的计算方法（如 I 型平方和）会得出不同的结果，从而强调在各因素相关时选择正确分析策略的至关重要性。[@problem_id:4909850]", "problem": "一项生物统计学中的双因素研究评估了在不同膳食方案和基因型下一种炎症生物标志物的反应。因素$\\mathcal{A}$是膳食方案，有$3$个水平（低、中、高）；因素$\\mathcal{B}$是基因型，有$2$个水平（X、Y）。该设计为非均衡设计，各单元格的样本量为：$n_{A_1B_1}=12$, $n_{A_1B_2}=8$, $n_{A_2B_1}=9$, $n_{A_2B_2}=13$, $n_{A_3B_1}=11$, $n_{A_3B_2}=7$，因此总样本量为$N=60$。拟合了一个带有交互作用的双因素方差分析（ANOVA）模型，报告的主效应和交互作用的II型平方和（SS）如下：$SS_{\\mathcal{A}}=280$，自由度$\\mathrm{df}_{\\mathcal{A}}=2$；$SS_{\\mathcal{B}}=210$，自由度$\\mathrm{df}_{\\mathcal{B}}=1$；$SS_{\\mathcal{A}\\mathcal{B}}=70$，自由度$\\mathrm{df}_{\\mathcal{A}\\mathcal{B}}=2$。残差（误差）平方和为$SS_{\\mathrm{E}}=420$，自由度$\\mathrm{df}_{\\mathrm{E}}=54$；总平方和为$SS_{\\mathrm{T}}=980$，自由度$\\mathrm{df}_{\\mathrm{T}}=59$。\n\n从方差分析分解的基本原理和解释变异比例的定义出发，使用所提供的II型平方和，计算膳食$\\mathcal{A}$主效应的效应量$\\eta^2$。将你的答案四舍五入至四位有效数字，并以小数形式表示（不要使用百分号）。然后，根据因子方差分析中平方和的结构，简要解释为什么在这种非均衡设计中，I型（序贯）平方和会得出与II型结果不同的主效应值。", "solution": "该问题要求在双因素方差分析（ANOVA）中计算一个主效应的效应量指标eta平方（$\\eta^2$），并从概念上解释在非均衡设计的背景下，I型和II型平方和之间的差异。\n\n首先，我们验证问题陈述。已知条件如下：\n- 因素$\\mathcal{A}$（膳食）有$a=3$个水平。\n- 因素$\\mathcal{B}$（基因型）有$b=2$个水平。\n- 一个总样本量为$N=60$的非均衡设计。\n- II型平方和（SS）：$SS_{\\mathcal{A}}=280$，$SS_{\\mathcal{B}}=210$，$SS_{\\mathcal{A}\\mathcal{B}}=70$。\n- 残差（误差）平方和：$SS_{\\mathrm{E}}=420$。\n- 总平方和：$SS_{\\mathrm{T}}=980$。\n- 自由度（df）：$\\mathrm{df}_{\\mathcal{A}}=a-1=2$，$\\mathrm{df}_{\\mathcal{B}}=b-1=1$，$\\mathrm{df}_{\\mathcal{A}\\mathcal{B}}=(a-1)(b-1)=2$，$\\mathrm{df}_{\\mathrm{E}}=N-ab=60-6=54$，以及$\\mathrm{df}_{\\mathrm{T}}=N-1=59$。\n所有提供的自由度值都与设计参数一致。模型平方和与误差平方和的总和为 $SS_{\\mathcal{A}} + SS_{\\mathcal{B}} + SS_{\\mathcal{A}\\mathcal{B}} + SS_{\\mathrm{E}} = 280 + 210 + 70 + 420 = 980$，这等于所提供的$SS_{\\mathrm{T}}$。这表明在这个特定案例（一个双因素模型）中，所提供的II型平方和与误差项一起划分了总平方和。该问题内部一致，具有统计理论的科学依据，且提法明确。我们可以继续进行解答。\n\n第一部分：因素$\\mathcal{A}$的Eta平方（$\\eta^2$）计算\n\nEta平方系数$\\eta^2$是一种效应量度量，它量化了因变量总方差中与某一特定自变量（或因素）相关的比例。它被定义为所关注效应的平方和与总平方和的比率。\n\n一个通用效应的$\\eta^2$公式为：\n$$ \\eta^2_{\\text{effect}} = \\frac{SS_{\\text{effect}}}{SS_{\\mathrm{T}}} $$\n在本题中，我们被要求计算膳食主效应（即因素$\\mathcal{A}$）的$\\eta^2$。问题提供了必要的值：因素$\\mathcal{A}$的平方和为$SS_{\\mathcal{A}} = 280$，总平方和为$SS_{\\mathrm{T}} = 980$。\n\n将这些值代入公式：\n$$ \\eta^2_{\\mathcal{A}} = \\frac{SS_{\\mathcal{A}}}{SS_{\\mathrm{T}}} = \\frac{280}{980} $$\n这个分数可以简化为：\n$$ \\frac{280}{980} = \\frac{28}{98} = \\frac{14}{49} = \\frac{2}{7} $$\n为了将其表示为四舍五入到四位有效数字的小数，我们进行除法运算：\n$$ \\eta^2_{\\mathcal{A}} = \\frac{2}{7} \\approx 0.28571428... $$\n四舍五入到四位有效数字得到$0.2857$。这意味着炎症生物标志物反应总变异的大约$28.57\\%$可归因于膳食方案的主效应。\n\n第二部分：I型与II型平方和的解释\n\n在方差分析中，对于非正交设计（即因素间存在相关的设计），区分不同类型的平方和（I型、II型、III型）至关重要。非均衡设计，如此问题中单元格样本量不相等的情况，是非正交性的一个主要例子。\n\n在均衡的因子设计（单元格样本量相等）中，各因素是正交的。这意味着不同效应（$SS_{\\mathcal{A}}$、$SS_{\\mathcal{B}}$、$SS_{\\mathcal{A}\\mathcal{B}}$）的平方和是独立的，并且以唯一可加的方式划分模型平方和。在这种情况下，I型和II型平方和将是相同的。\n\n在非均衡设计中，各因素是非正交的。这种非正交性意味着由因素$\\mathcal{A}$和因素$\\mathcal{B}$解释的方差存在重叠。不同类型的平方和代表了分配这种共享方差的不同策略。\n\nI型（序贯）平方和：这种方法是依赖于顺序的。每个因素的平方和是根据它在模型中已存在的因素之外所能解释的额外方差来计算的。\n- 如果模型指定的顺序是$\\mathcal{A}$，然后是$\\mathcal{B}$，则平方和为：\n  - $SS_{\\mathcal{A}}(\\text{Type I}) = SS(\\mathcal{A})$\n  - $SS_{\\mathcal{B}}(\\text{Type I}) = SS(\\mathcal{B} | \\mathcal{A})$\n- 如果模型指定的顺序是$\\mathcal{B}$，然后是$\\mathcal{A}$，则平方和为：\n  - $SS_{\\mathcal{B}}(\\text{Type I}) = SS(\\mathcal{B})$\n  - $SS_{\\mathcal{A}}(\\text{Type I}) = SS(\\mathcal{A} | \\mathcal{B})$\n由于非正交性，$SS(\\mathcal{A}) \\neq SS(\\mathcal{A} | \\mathcal{B})$ 且 $SS(\\mathcal{B}) \\neq SS(\\mathcal{B} | \\mathcal{A})$。因此，I型主效应平方和的值取决于分析时选择的顺序。\n\nII型（部分）平方和：这种方法在考虑了所有其他主效应之后，检验每个主效应。它遵循边际性原则，即不根据包含某个主效应的任何交互作用项来调整该主效应。对于一个有交互作用的双因素模型：\n- 因素$\\mathcal{A}$的平方和是根据因素$\\mathcal{B}$进行调整的：$SS_{\\mathcal{A}}(\\text{Type II}) = SS(\\mathcal{A} | \\mathcal{B})$。\n- 因素$\\mathcal{B}$的平方和是根据因素$\\mathcal{A}$进行调整的：$SS_{\\mathcal{B}}(\\text{Type II}) = SS(\\mathcal{B} | \\mathcal{A})$。\n- 交互作用的平方和是根据两个主效应进行调整的：$SS_{\\mathcal{A}\\mathcal{B}}(\\text{Type II}) = SS(\\mathcal{A}\\mathcal{B} | \\mathcal{A}, \\mathcal{B})$。\n这些值与模型中因素指定的顺序无关。\n\n比较结论：所提供的$SS_{\\mathcal{A}} = 280$是II型平方和，代表$SS(\\mathcal{A} | \\mathcal{B})$。如果因素$\\mathcal{A}$首先进入模型，I型分析会对$SS_{\\mathcal{A}}$产生不同的结果。在这种情况下，I型平方和将是$SS(\\mathcal{A})$，即由$\\mathcal{A}$单独解释的方差，而未对$\\mathcal{B}$进行调整。因为设计是非均衡的，这个值不会等于$SS(\\mathcal{A} | \\mathcal{B})$。因此，在非均衡设计中，I型平方和对方差的序贯划分导致了主效应的结果依赖于顺序，这与II型平方和不依赖于顺序的结果不同。", "answer": "$$ \\boxed{0.2857} $$", "id": "4909850"}]}