{"hands_on_practices": [{"introduction": "序贯检验中的统计量并非相互独立；它们之间存在相关性，这种相关性源于累积数据的性质。这个练习将深入探讨经典的联合正态框架，通过推导序贯检验统计量之间的协方差结构，来理解这一核心概念。掌握这种相关性是设定正确的期中分析停止边界和控制总体I类错误率的基石。[@problem_id:4918094]", "problem": "一项双臂随机临床试验采用成组序贯设计进行监察，在信息时间 $t_{1} = 0.25$，$t_{2} = 0.50$ 和 $t_{3} = 1.00$ 进行三次分析。在典范联合正态框架下，序贯检验统计量 $\\{Z_{i}\\}$ 通过带漂移的标准化布朗运动表示来建模：对于每个分析时间 $t$，统计量 $Z(t)$ 定义为 $Z(t) = \\left(W(t) + \\theta t\\right)/\\sqrt{t}$，其中 $W(t)$ 是标准布朗运动，$\\theta$ 是一个恒定的漂移参数，代表标准化治疗效应。已知 $W(t)$ 的协方差函数为 $\\operatorname{Cov}\\!\\left(W(s), W(t)\\right) = \\min\\{s,t\\}$ 且 $W(0) = 0$。\n\n从这些基本定义出发，推导在 $\\left(t_{1}, t_{2}, t_{3}\\right)$ 处的 $\\left(Z_{1}, Z_{2}, Z_{3}\\right)$ 的协方差矩阵，并以精确的封闭形式表示其元素。然后，从第一性原理出发，验证该协方差矩阵是半正定的。使用根式和分数以最简精确形式表示矩阵元素，不要对任何量进行四舍五入。", "solution": "该问题指定了成组序贯设计中中期检验统计量的典范联合正态表示。其基础是带漂移的标准化布朗运动 $W(t)$，它是一个高斯过程，满足 $W(0) = 0$，均值为 $0$，协方差函数为 $\\operatorname{Cov}\\!\\left(W(s), W(t)\\right) = \\min\\{s,t\\}$。在时间 $t$ 的典范统计量由下式给出\n$$\nZ(t) = \\frac{W(t) + \\theta t}{\\sqrt{t}}.\n$$\n对于任何固定的分析时间集 $t_{1}, t_{2}, t_{3}$，向量 $\\left(Z(t_{1}), Z(t_{2}), Z(t_{3})\\right)$ 是联合正态的。其协方差结构可以直接从 $W(t)$ 的协方差推导出来，因为漂移 $\\theta t$ 只对均值有贡献，而对协方差没有影响。\n\n具体而言，对于 $i,j \\in \\{1,2,3\\}$，\n$$\n\\operatorname{Cov}\\!\\left(Z(t_{i}), Z(t_{j})\\right)\n= \\operatorname{Cov}\\!\\left(\\frac{W(t_{i})}{\\sqrt{t_{i}}}, \\frac{W(t_{j})}{\\sqrt{t_{j}}}\\right)\n= \\frac{\\operatorname{Cov}\\!\\left(W(t_{i}), W(t_{j})\\right)}{\\sqrt{t_{i} t_{j}}}\n= \\frac{\\min\\{t_{i}, t_{j}\\}}{\\sqrt{t_{i} t_{j}}}.\n$$\n这表明协方差矩阵 $\\Sigma$ 的元素为\n$$\n\\Sigma_{ij} = \\frac{\\min\\{t_{i}, t_{j}\\}}{\\sqrt{t_{i} t_{j}}}.\n$$\n观察到当 $i = j$ 时，$\\Sigma_{ii} = \\min\\{t_{i}, t_{i}\\}/t_{i} = 1$，因此每个 $Z(t_{i})$ 都被标准化为方差为 $1$。当 $i  j$ 时，$\\Sigma_{ij} = \\frac{t_{i}}{\\sqrt{t_{i} t_{j}}} = \\sqrt{\\frac{t_{i}}{t_{j}}}$。\n\n当 $t_{1} = 0.25$，$t_{2} = 0.50$，$t_{3} = 1.00$ 时，我们计算非对角线元素：\n- 对于 $i=1$, $j=2$，$\\Sigma_{12} = \\sqrt{\\frac{t_{1}}{t_{2}}} = \\sqrt{\\frac{0.25}{0.50}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}$。\n- 对于 $i=1$, $j=3$，$\\Sigma_{13} = \\sqrt{\\frac{t_{1}}{t_{3}}} = \\sqrt{\\frac{0.25}{1.00}} = \\sqrt{\\frac{1}{4}} = \\frac{1}{2}$。\n- 对于 $i=2$, $j=3$，$\\Sigma_{23} = \\sqrt{\\frac{t_{2}}{t_{3}}} = \\sqrt{\\frac{0.50}{1.00}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}$。\n\n根据对称性，$\\Sigma_{21} = \\Sigma_{12}$，$\\Sigma_{31} = \\Sigma_{13}$，且 $\\Sigma_{32} = \\Sigma_{23}$。完整的协方差矩阵是\n$$\n\\Sigma =\n\\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  1  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  1\n\\end{pmatrix}.\n$$\n\n我们现在来验证 $\\Sigma$ 是半正定的。一个概念上合理的做法是利用这样一个事实：$\\Sigma$ 来自于一个通过对 $W(t)$ 进行线性缩放而构造的联合正态向量的协方差。任何高斯向量的协方差矩阵根据其构造都是对称且半正定的。尽管如此，我们可以通过证明 $\\Sigma$ 的所有特征值都是非负的来明确地验证其半正定性。\n\n因为 $\\Sigma$ 是对称的，并且在第一和第三坐标上具有回文结构，我们可以利用对称性来找到特征值。令 $a = \\frac{1}{\\sqrt{2}}$ 且 $b = \\frac{1}{2}$。考虑特征向量 $v_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$。那么\n$$\n\\Sigma v_{1} =\n\\begin{pmatrix}\n1  a  b \\\\\na  1  a \\\\\nb  a  1\n\\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n=\n\\begin{pmatrix}\n1 - b \\\\ a - a \\\\ b - 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{2} \\\\ 0 \\\\ -\\frac{1}{2}\n\\end{pmatrix}\n=\n\\frac{1}{2}\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ -1\n\\end{pmatrix}.\n$$\n因此，$v_{1}$ 是一个特征向量，其特征值为 $\\lambda_{1} = \\frac{1}{2}$。\n\n接下来，考虑形如 $v = \\begin{pmatrix} 1 \\\\ r \\\\ 1 \\end{pmatrix}$ 的特征向量，这利用了第一和第三坐标之间的对称性。计算\n$$\n\\Sigma v =\n\\begin{pmatrix}\n1 + a r + b \\\\\na + r + a \\\\\n1 + a r + b\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 + a r + b \\\\\nr + 2 a \\\\\n1 + a r + b\n\\end{pmatrix}.\n$$\n如果 $v$ 是一个特征值为 $\\lambda$ 的特征向量，那么我们必须有\n$$\n1 + a r + b = \\lambda, \\quad r + 2 a = \\lambda r.\n$$\n使用 $\\lambda = 1 + a r + b$ 消去 $\\lambda$，得到关于 $r$ 的二次方程：\n$$\n(1 + a r + b) r = r + 2 a \\implies a r^{2} + b r = 2 a.\n$$\n代入 $a = \\frac{1}{\\sqrt{2}}$ 和 $b = \\frac{1}{2}$，方程变为\n$$\n\\frac{1}{\\sqrt{2}} r^{2} + \\frac{1}{2} r - \\frac{2}{\\sqrt{2}} = 0.\n$$\n两边乘以 $\\sqrt{2}$ 得到\n$$\nr^{2} + \\frac{1}{\\sqrt{2}} r - 2 = 0,\n$$\n其解为\n$$\nr = \\frac{-\\frac{1}{\\sqrt{2}} \\pm \\sqrt{\\left(\\frac{1}{\\sqrt{2}}\\right)^{2} + 8}}{2}\n= \\frac{-\\frac{1}{\\sqrt{2}} \\pm \\sqrt{\\frac{1}{2} + 8}}{2}\n= \\frac{-\\frac{1}{\\sqrt{2}} \\pm \\sqrt{\\frac{17}{2}}}{2}\n= \\frac{-1 \\pm \\sqrt{17}}{2 \\sqrt{2}}.\n$$\n对于每个根 $r$，相应的特征值为\n$$\n\\lambda = 1 + a r + b = \\frac{3}{2} + \\frac{r}{\\sqrt{2}}.\n$$\n由于 $\\frac{r}{\\sqrt{2}} = \\frac{-1 \\pm \\sqrt{17}}{4}$，这两个特征值为\n$$\n\\lambda_{2} = \\frac{5}{4} + \\frac{\\sqrt{17}}{4}, \\qquad \\lambda_{3} = \\frac{5}{4} - \\frac{\\sqrt{17}}{4}.\n$$\n数值上，$\\lambda_{1} = \\frac{1}{2} > 0$，$\\lambda_{2} = \\frac{5 + \\sqrt{17}}{4} \\approx 2.2808 > 0$，以及 $\\lambda_{3} = \\frac{5 - \\sqrt{17}}{4} \\approx 0.2192 > 0$。所有三个特征值都严格为正，因此 $\\Sigma$ 是正定的（从而也是半正定的）。这就从第一性原理验证了所要求的性质。\n\n因此，协方差矩阵是\n$$\n\\Sigma =\n\\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  1  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  1\n\\end{pmatrix},\n$$\n由于其特征值为非负，所以它是半正定的。", "answer": "$$\\boxed{\\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  1  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  1\n\\end{pmatrix}}$$", "id": "4918094"}, {"introduction": "在理解了检验统计量之间的内在关联后，下一步自然是设计有效的停止规则。这个练习将模拟临床试验设计的一个关键步骤：计算在特定效应大小下，试验因有效或无效而提前终止的概率。评估这些“操作特性”对于选择一个既有统计效力又符合伦理的试验设计至关重要。[@problem_id:4918101]", "problem": "一项双臂随机优效性试验比较一个试验组与一个对照组之间的连续性临床结局，两组的标准差 $\\sigma$ 已知且相同。该设计包括一次计划在信息分数 $t = 0.5$（总信息量的一半）时进行的期中分析，如果未达到期中界值，则继续进行期末分析。在每次分析中，监测试验统计量为标准化的 $z$ 统计量 $Z(t)$，其计算方法为估计的均值差除以其标准误。因此，在固定备择假设下，经典联合正态模型意味着 $Z(t) \\sim \\mathcal{N}(\\mu \\sqrt{t}, 1)$，其中 $\\mu$ 是标准化效应量（由真实均值差引起的漂移参数）。\n\n期中监查在期中访视时使用两个不重叠的停止规则：\n- 提前有效：如果 $Z(t) \\geq a_{1}$ 则停止。\n- 提前无效：如果 $Z(t) \\leq b_{1}$ 则停止。\n\n如果在期中分析时两个界值都未达到，试验将继续进行至期末分析。考虑一个单侧监查设计，其期中界值为 $a_{1} = 2.342$（有效性）和 $b_{1} = 0.2$（无效性），并假设真实的标准化效应量为 $\\mu = 1.5$。\n\n仅使用正态分布的性质和经典联合正态模型下 $Z(t)$ 的定义，计算在 $\\mu$ 条件下，期中因有效性与无效性而提前停止的联合概率向量，即 $\\left(P_{\\text{efficacy}}, P_{\\text{futility}}\\right)$，表示为两个实值概率。将每个概率四舍五入到四位有效数字。将最终答案表示为按 $\\left(P_{\\text{efficacy}}, P_{\\text{futility}}\\right)$ 顺序排列的行向量。", "solution": "目标是计算在单次计划的期中分析时，因有效和无效而提前停止的概率。这些概率分别表示为 $P_{\\text{efficacy}}$ 和 $P_{\\text{futility}}$。停止规则是根据在信息分数 $t=0.5$ 时标准化 $z$ 统计量 $Z(t)$ 的值来定义的。\n\n问题陈述指出，在真实标准化效应量为 $\\mu$ 的固定备择假设下，监测试验统计量 $Z(t)$ 服从正态分布：\n$$Z(t) \\sim \\mathcal{N}(\\mu \\sqrt{t}, 1)$$\n这是组序贯设计的经典联合正态模型。\n\n我们已知以下值：\n- 期中分析的信息分数：$t = 0.5$\n- 真实标准化效应量（漂移参数）：$\\mu = 1.5$\n- 有效性停止界值：$a_1 = 2.342$\n- 无效性停止界值：$b_1 = 0.2$\n\n首先，我们必须确定在指定的真实效应量 $\\mu=1.5$ 下，检验统计量 $Z(0.5)$ 在期中访视时的具体分布。将给定值代入一般分布形式，我们求得分布的均值：\n$$\\text{E}[Z(0.5)] = \\mu \\sqrt{t} = 1.5 \\times \\sqrt{0.5} = 1.5 \\times \\frac{1}{\\sqrt{2}} = \\frac{1.5}{\\sqrt{2}}$$\n数值上，均值约为 $1.06066$。方差给定为 $1$。\n因此，期中分析时统计量的分布为：\n$$Z(0.5) \\sim \\mathcal{N}\\left(1.5\\sqrt{0.5}, 1\\right)$$\n\n因有效而停止的概率 $P_{\\text{efficacy}}$ 是观察到的统计量 $Z(0.5)$ 大于或等于有效性界值 $a_1$ 的概率。\n$$P_{\\text{efficacy}} = P(Z(0.5) \\geq a_1)$$\n代入 $a_1$ 的值：\n$$P_{\\text{efficacy}} = P(Z(0.5) \\geq 2.342)$$\n\n为了计算这个概率，我们对随机变量进行标准化。令 $X = Z(0.5)$。我们知道 $X \\sim \\mathcal{N}(\\nu, 1)$，其中 $\\nu = 1.5\\sqrt{0.5}$。那么变量 $W = X - \\nu$ 服从标准正态分布，即 $W \\sim \\mathcal{N}(0, 1)$。\n$$P(X \\geq 2.342) = P(X - \\nu \\geq 2.342 - \\nu) = P(W \\geq 2.342 - 1.5\\sqrt{0.5})$$\n令 $\\Phi(\\cdot)$ 表示标准正态分布的累积分布函数（CDF）。那么 $P(W \\geq z) = 1 - P(W  z) = 1 - \\Phi(z)$。\n$$P_{\\text{efficacy}} = 1 - \\Phi(2.342 - 1.5\\sqrt{0.5})$$\n我们现在计算 CDF 的参数：\n$$2.342 - 1.5\\sqrt{0.5} \\approx 2.342 - 1.060660 = 1.281340$$\n所以，$P_{\\text{efficacy}} = 1 - \\Phi(1.281340)$。使用标准正态概率表或计算工具，我们得到：\n$$\\Phi(1.281340) \\approx 0.899963$$\n$$P_{\\text{efficacy}} \\approx 1 - 0.899963 = 0.100037$$\n四舍五入到四位有效数字，我们得到 $P_{\\text{efficacy}} = 0.1000$。\n\n接下来，我们计算因无效而停止的概率 $P_{\\text{futility}}$。这是观察到的统计量 $Z(0.5)$ 小于或等于无效性界值 $b_1$ 的概率。\n$$P_{\\text{futility}} = P(Z(0.5) \\leq b_1)$$\n代入 $b_1$ 的值：\n$$P_{\\text{futility}} = P(Z(0.5) \\leq 0.2)$$\n同样，我们使用其已知分布 $Z(0.5) \\sim \\mathcal{N}(1.5\\sqrt{0.5}, 1)$ 对随机变量进行标准化。\n$$P(Z(0.5) \\leq 0.2) = P(Z(0.5) - 1.5\\sqrt{0.5} \\leq 0.2 - 1.5\\sqrt{0.5})$$\n这等价于求标准正态 CDF 在指定点的值。\n$$P_{\\text{futility}} = \\Phi(0.2 - 1.5\\sqrt{0.5})$$\n我们计算 CDF 的参数：\n$$0.2 - 1.5\\sqrt{0.5} \\approx 0.2 - 1.060660 = -0.860660$$\n所以，$P_{\\text{futility}} = \\Phi(-0.860660)$。使用标准正态概率表或计算工具，我们得到：\n$$P_{\\text{futility}} \\approx 0.194723$$\n四舍五入到四位有效数字，我们得到 $P_{\\text{futility}} = 0.1947$。\n\n问题陈述中说明停止规则是不重叠的，这一点由 $a_1 > b_1$ 证实。因此，所求的提前停止联合概率向量就是包含这两个单独计算出的概率的向量。\n\n最终的概率向量是 $(P_{\\text{efficacy}}, P_{\\text{futility}})$，四舍五入后为 $(0.1000, 0.1947)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1000  0.1947\n\\end{pmatrix}\n}\n$$", "id": "4918101"}, {"introduction": "在现实世界中，临床试验的执行很少能完美遵循预设的时间表。本练习将展示α消耗法这一现代工具的强大之处，它允许期中分析的时间点具有灵活性，同时严格控制总体的I类错误率。通过本练习，你将学会如何量化这种时间偏差对$α$分配的影响，从而更好地应对临床试验中的实际挑战。[@problem_id:4918088]", "problem": "一项随机临床试验采用成组序贯设计进行监察，并使用alpha消耗法来控制总体I类错误率。设总体双侧I类错误为 $\\alpha=0.05$，并假设数据与安全监察委员会（DSMB）使用指数为 $\\rho=2$ 的幂α消耗函数，因此到信息时间 $t \\in [0,1]$ 为止累计消耗的alpha是消耗函数 $g(t)$，该函数满足 $g(0)=0$, $g(1)=\\alpha$，关于 $t$ 单调，并具有与保守的早期分析一致的后期消耗模式。\n\n该试验计划在信息时间 $(0.25, 0.50, 0.75)$ 进行三次期中分析，但由于操作上的变动，实际分析发生在 $(0.22, 0.49, 0.85)$。使用幂消耗范式以及信息时间作为已累积的计划最大Fisher信息比例的定义，通过计算在相应分析时点上，计划与实际累计alpha消耗之间的绝对偏差之和，来量化这种非计划的时间变动对三次分析的累计alpha分配的影响：\n$$\n\\Delta \\equiv \\sum_{i=1}^{3} \\left| g\\big(t^{\\text{actual}}_{i}\\big) - g\\big(t^{\\text{planned}}_{i}\\big) \\right|.\n$$\n\n将您计算出的 $\\Delta$ 的最终数值答案表示为小数，并四舍五入到四位有效数字。", "solution": "问题的核心在于幂α消耗函数的应用。该函数族由以下公式定义：\n$$\ng(t) = \\alpha t^{\\rho}\n$$\n其中 $t$ 是信息时间（已累积的计划总信息量的比例，其中 $t \\in [0,1]$），$\\alpha$ 是总I类错误率，$\\rho$ 是一个控制消耗速率的参数。$\\rho > 1$ 的值对应于“后期消耗”函数，这种函数在早期分析中更为保守。\n\n问题指明了总体双侧I类错误率为 $\\alpha=0.05$，指数为 $\\rho=2$。将这些值代入通用公式，得到本次试验的特定消耗函数：\n$$\ng(t) = 0.05 \\times t^2\n$$\n目标是计算三次期中分析中，计划与实际累计alpha分配之间的总绝对偏差 $\\Delta$。$\\Delta$ 的计算公式如下：\n$$\n\\Delta = \\sum_{i=1}^{3} \\left| g\\big(t^{\\text{actual}}_{i}\\big) - g\\big(t^{\\text{planned}}_{i}\\big) \\right|\n$$\n计划的信息时间为 $t^{\\text{planned}}_1 = 0.25$，$t^{\\text{planned}}_2 = 0.50$ 和 $t^{\\text{planned}}_3 = 0.75$。\n实际观测到的信息时间为 $t^{\\text{actual}}_1 = 0.22$，$t^{\\text{actual}}_2 = 0.49$ 和 $t^{\\text{actual}}_3 = 0.85$。\n\n首先，我们计算为每次分析计划的累计alpha分配：\n\\begin{itemize}\n    \\item 分析1 ($i=1$): $g(t^{\\text{planned}}_1) = g(0.25) = 0.05 \\times (0.25)^2 = 0.05 \\times 0.0625 = 0.003125$。\n    \\item 分析2 ($i=2$): $g(t^{\\text{planned}}_2) = g(0.50) = 0.05 \\times (0.50)^2 = 0.05 \\times 0.25 = 0.0125$。\n    \\item 分析3 ($i=3$): $g(t^{\\text{planned}}_3) = g(0.75) = 0.05 \\times (0.75)^2 = 0.05 \\times 0.5625 = 0.028125$。\n\\end{itemize}\n\n接下来，我们计算与实际分析发生时的信息时间相对应的累计alpha分配：\n\\begin{itemize}\n    \\item 分析1 ($i=1$): $g(t^{\\text{actual}}_1) = g(0.22) = 0.05 \\times (0.22)^2 = 0.05 \\times 0.0484 = 0.00242$。\n    \\item 分析2 ($i=2$): $g(t^{\\text{actual}}_2) = g(0.49) = 0.05 \\times (0.49)^2 = 0.05 \\times 0.2401 = 0.012005$。\n    \\item 分析3 ($i=3$): $g(t^{\\text{actual}}_3) = g(0.85) = 0.05 \\times (0.85)^2 = 0.05 \\times 0.7225 = 0.036125$。\n\\end{itemize}\n\n现在，我们计算每个相应分析指数的绝对偏差：\n\\begin{itemize}\n    \\item 分析1的偏差：$| g(t^{\\text{actual}}_1) - g(t^{\\text{planned}}_1) | = |0.00242 - 0.003125| = |-0.000705| = 0.000705$。\n    \\item 分析2的偏差：$| g(t^{\\text{actual}}_2) - g(t^{\\text{planned}}_2) | = |0.012005 - 0.0125| = |-0.000495| = 0.000495$。\n    \\item 分析3的偏差：$| g(t^{\\text{actual}}_3) - g(t^{\\text{planned}}_3) | = |0.036125 - 0.028125| = |0.008| = 0.008$。\n\\end{itemize}\n\n最后，我们将这三个绝对偏差相加来求得 $\\Delta$：\n$$\n\\Delta = 0.000705 + 0.000495 + 0.008 = 0.0092\n$$\n问题要求答案四舍五入到四位有效数字。计算出的值为 $0.0092$。前导零不是有效数字。为了用四位有效数字表示该值，我们在后面添加两个零。因此，该值变为 $0.009200$。", "answer": "$$\n\\boxed{0.009200}\n$$", "id": "4918088"}]}