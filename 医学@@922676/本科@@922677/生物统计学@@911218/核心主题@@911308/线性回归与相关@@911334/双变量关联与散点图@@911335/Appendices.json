{"hands_on_practices": [{"introduction": "在我们解释相关性之前，我们必须首先理解它是如何计算的。这个练习将带您回归基础，展示皮尔逊相关系数 $r$ 是如何从基本汇总统计量中推导出来的。通过完成这个推导，您不仅能掌握其计算机制，还能体会到在真实数据分析中确保计算准确性的重要考量。[@problem_id:4897905]", "problem": "一项心血管队列研究调查了低密度脂蛋白胆固醇与全身性炎症之间的双变量关联。对于 $n$ 名成年人中的每一位，设 $x_i$ 表示以毫克/分升为单位测量的低密度脂蛋白胆固醇，而 $y_i$ 表示以毫克/升为单位测量的高敏C反应蛋白。假设对于一个包含 $n = 40$ 名参与者的数据集，从数据系统中可以获得以下汇总统计数据：$\\sum_{i=1}^{n} x_i = 5200$，$\\sum_{i=1}^{n} y_i = 80$，$\\sum_{i=1}^{n} x_i^2 = 712000$，$\\sum_{i=1}^{n} y_i^2 = 217.6$，以及 $\\sum_{i=1}^{n} x_i y_i = 10976$。\n\n从样本均值 $\\bar{x}$ 和 $\\bar{y}$、样本协方差 $s_{xy}$ 以及样本标准差 $s_x$ 和 $s_y$ 的基本定义出发，推导出一个仅用 $n$、$\\sum x_i$、$\\sum y_i$、$\\sum x_i^2$、$\\sum y_i^2$ 和 $\\sum x_i y_i$ 表示的皮尔遜积矩相关系数 $r$ 的公式。然后，利用此推导过程，解释如何通过适当的中心化来获得避免灾难性抵消的数值稳定表达式，并证明它们与用所给汇总数据表示的公式是等价的。最后，使用给定的汇总数据计算 $r$ 的数值。将您的答案四舍五入到四位有效数字。以无单位的相关系数形式提供最终答案。", "solution": "该问题要求推导皮尔遜积矩相关系数 $r$ 的计算公式，解释数值稳定性，并根据提供的汇总统计数据计算 $r$。该问题在统计学和数学上是良定的，并包含了所有必要的信息。\n\n皮尔遜积矩相关系数 $r$ 的基本定义是样本协方差 $s_{xy}$ 与样本标准差 $s_x$ 和 $s_y$ 乘积的比值。\n$$\nr = \\frac{s_{xy}}{s_x s_y}\n$$\n样本协方差定义为：\n$$\ns_{xy} = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})\n$$\n样本标准差定义为：\n$$\ns_x = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\quad \\text{和} \\quad s_y = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2}\n$$\n其中 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$ 和 $\\bar{y} = \\frac{1}{n}\\sum_{i=1}^{n} y_i$ 是样本均值。\n\n将这些定义代入 $r$ 的公式中：\n$$\nr = \\frac{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2}}\n$$\n分子和分母中的因子 $\\frac{1}{n-1}$相互抵消，得到：\n$$\nr = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\sqrt{\\sum_{i=1}^{n} (y_i - \\bar{y})^2}}\n$$\n该表达式中的项分别是修正的交叉乘积和 ($SS_{xy}$)、$x$ 的修正平方和 ($SS_{xx}$) 以及 $y$ 的修正平方和 ($SS_{yy}$)。\n$$\nSS_{xy} = \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y}) \\\\\nSS_{xx} = \\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\\\\nSS_{yy} = \\sum_{i=1}^{n} (y_i - \\bar{y})^2\n$$\n为了推导用给定汇总统计数据表示的公式，我们展开这些项中的每一项。\n\n对于 $SS_{xy}$：\n$$\nSS_{xy} = \\sum_{i=1}^{n} (x_i y_i - x_i \\bar{y} - y_i \\bar{x} + \\bar{x}\\bar{y}) \\\\\n= \\sum_{i=1}^{n} x_i y_i - \\bar{y}\\sum_{i=1}^{n} x_i - \\bar{x}\\sum_{i=1}^{n} y_i + \\sum_{i=1}^{n} \\bar{x}\\bar{y} \\\\\n= \\sum_{i=1}^{n} x_i y_i - \\left(\\frac{\\sum y_i}{n}\\right) (\\sum x_i) - \\left(\\frac{\\sum x_i}{n}\\right) (\\sum y_i) + n\\left(\\frac{\\sum x_i}{n}\\right)\\left(\\frac{\\sum y_i}{n}\\right) \\\\\n= \\sum_{i=1}^{n} x_i y_i - \\frac{(\\sum x_i)(\\sum y_i)}{n} - \\frac{(\\sum x_i)(\\sum y_i)}{n} + \\frac{(\\sum x_i)(\\sum y_i)}{n} \\\\\n= \\sum_{i=1}^{n} x_i y_i - \\frac{(\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n}\n$$\n\n对于 $SS_{xx}$：\n$$\nSS_{xx} = \\sum_{i=1}^{n} (x_i^2 - 2x_i\\bar{x} + \\bar{x}^2) \\\\\n= \\sum_{i=1}^{n} x_i^2 - 2\\bar{x}\\sum_{i=1}^{n} x_i + \\sum_{i=1}^{n} \\bar{x}^2 \\\\\n= \\sum_{i=1}^{n} x_i^2 - 2\\left(\\frac{\\sum x_i}{n}\\right)(\\sum x_i) + n\\left(\\frac{\\sum x_i}{n}\\right)^2 \\\\\n= \\sum_{i=1}^{n} x_i^2 - 2\\frac{(\\sum x_i)^2}{n} + \\frac{(\\sum x_i)^2}{n} \\\\\n= \\sum_{i=1}^{n} x_i^2 - \\frac{(\\sum_{i=1}^{n} x_i)^2}{n}\n$$\n同理可得，对于 $SS_{yy}$：\n$$\nSS_{yy} = \\sum_{i=1}^{n} y_i^2 - \\frac{(\\sum_{i=1}^{n} y_i)^2}{n}\n$$\n将这些表达式代回公式 $r = \\frac{SS_{xy}}{\\sqrt{SS_{xx}SS_{yy}}}$，得到所需的计算公式：\n$$\nr = \\frac{\\sum_{i=1}^{n} x_i y_i - \\frac{(\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n}}{\\sqrt{\\left(\\sum_{i=1}^{n} x_i^2 - \\frac{(\\sum_{i=1}^{n} x_i)^2}{n}\\right)\\left(\\sum_{i=1}^{n} y_i^2 - \\frac{(\\sum_{i=1}^{n} y_i)^2}{n}\\right)}}\n$$\n此公式仅用 $n$ 和所提供的总和来表示。\n\n数值稳定性问题源于类似 $SS_{xx} = \\sum x_i^2 - \\frac{(\\sum x_i)^2}{n}$ 的计算。如果数据值 $x_i$ 很大但方差很小，则 $\\sum x_i^2$ 和 $\\frac{(\\sum x_i)^2}{n}$ 这两项可能非常大且几乎相等。在浮点运算中，两个这样的数相减会导致相对精度的急剧损失，这种效应被称为灾难性抵消。\n\n为了获得数值稳定的表达式，应使用基于中心化数据的公式：$SS_{xx} = \\sum_{i=1}^{n} (x_i - \\bar{x})^2$。这涉及一个两遍算法：首先，计算均值 $\\bar{x}$，其次，计算与该均值之差的平方和。这种方法更稳定，因为减法 $(x_i - \\bar{x})$ 是对单个数据点进行的，这些数据点的数量级通常远小于总和 $\\sum x_i^2$ 和 $(\\sum x_i)^2$。随后对均为非负的平方差求和，在数值上是一种良性操作。这些中心化表达式与上面推导的计算公式的等价性已在推导过程中通过代数方式证明。推导过程表明，$\\sum_{i=1}^{n} (x_i - \\bar{x})^2$ 在代数上恒等于 $\\sum_{i=1}^{n} x_i^2 - \\frac{(\\sum_{i=1}^{n} x_i)^2}{n}$，对于 $SS_{yy}$ 和 $SS_{xy}$ 也是如此。虽然它们在代数上是等价的，但在有限精度算法中，它们在计算上并不等价。基于中心化数据的表达式可以防止灾难性抵消，因此在数值上更优越。\n\n现在，我们使用给定的汇总数据和推导出的计算公式来计算 $r$ 的数值。\n给定的数据是：\n$n = 40$\n$\\sum_{i=1}^{n} x_i = 5200$\n$\\sum_{i=1}^{n} y_i = 80$\n$\\sum_{i=1}^{n} x_i^2 = 712000$\n$\\sum_{i=1}^{n} y_i^2 = 217.6$\n$\\sum_{i=1}^{n} x_i y_i = 10976$\n\n首先，我们计算分量 $SS_{xy}$、$SS_{xx}$ 和 $SS_{yy}$。\n$$\nSS_{xy} = \\sum_{i=1}^{n} x_i y_i - \\frac{(\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n} = 10976 - \\frac{(5200)(80)}{40} = 10976 - \\frac{416000}{40} = 10976 - 10400 = 576\n$$\n$$\nSS_{xx} = \\sum_{i=1}^{n} x_i^2 - \\frac{(\\sum_{i=1}^{n} x_i)^2}{n} = 712000 - \\frac{(5200)^2}{40} = 712000 - \\frac{27040000}{40} = 712000 - 676000 = 36000\n$$\n$$\nSS_{yy} = \\sum_{i=1}^{n} y_i^2 - \\frac{(\\sum_{i=1}^{n} y_i)^2}{n} = 217.6 - \\frac{(80)^2}{40} = 217.6 - \\frac{6400}{40} = 217.6 - 160 = 57.6\n$$\n现在，我们计算 $r$：\n$$\nr = \\frac{SS_{xy}}{\\sqrt{SS_{xx} SS_{yy}}} = \\frac{576}{\\sqrt{36000 \\times 57.6}} = \\frac{576}{\\sqrt{2073600}}\n$$\n分母的值是：\n$$\n\\sqrt{2073600} = 1440\n$$\n因此，相关系数为：\n$$\nr = \\frac{576}{1440} = 0.4\n$$\n问题要求答案四舍五入到四位有效数字。精确值为 $0.4$。为了用四位有效数字表示，我们写作 $0.4000$。", "answer": "$$\n\\boxed{0.4000}\n$$", "id": "4897905"}, {"introduction": "像相关系数这样的汇总统计量有时可能会产生误导，尤其是当数据由不同子组合并而成时。这个练习将介绍一个著名的统计现象——辛普森悖论，即在整个数据集中观察到的趋势在按组别进行分解后会发生逆转。通过分解协方差，您将学会识别导致这种悖论的条件，并理解为什么在对关联下结论之前检查混杂变量至关重要。[@problem_id:4897914]", "problem": "一位生物统计学家研究了两种连续生物标志物（记为 $X$ 和 $Y$）之间的关联。这些标志物是在从两个临床中心招募的参与者身上测量的，临床中心由一个二元变量 $Z \\in \\{0,1\\}$ 索引。两个中心按比例 $\\mathbb{P}(Z=1)=p$ 和 $\\mathbb{P}(Z=0)=1-p$ 招募参与者，其中 $p \\in (0,1)$。在给定 $Z=z$ 的条件下，$(X,Y)$ 的联合分布是二元正态分布，其均值向量为 $(\\mu_{x,z},\\mu_{y,z})$，边际标准差为 $\\sigma_{x,z}0$ 和 $\\sigma_{y,z}0$，中心内相关性为 $\\rho_{z} \\in (-1,1)$；也就是说，$(X,Y)\\mid Z=z \\sim \\mathcal{N}_2\\big((\\mu_{x,z},\\mu_{y,z}), \\Sigma_{z}\\big)$，其中\n$$\n\\Sigma_{z}=\\begin{pmatrix}\n\\sigma_{x,z}^{2}  \\rho_{z}\\,\\sigma_{x,z}\\sigma_{y,z}\\\\\n\\rho_{z}\\,\\sigma_{x,z}\\sigma_{y,z}  \\sigma_{y,z}^{2}\n\\end{pmatrix}.\n$$\n该生物统计学家考虑了以下旨在形式化散点图中辛普森悖论的特定参数化：对于 $Z=0$，令 $(\\mu_{x,0},\\mu_{y,0})=(0,10)$，$\\sigma_{x,0}=\\sigma_{y,0}=1$ 且 $\\rho_{0}=0.4$；对于 $Z=1$，令 $(\\mu_{x,1},\\mu_{y,1})=(10,0)$，$\\sigma_{x,1}=\\sigma_{y,1}=1$ 且 $\\rho_{1}=0.4$。\n\n仅以协方差和条件期望的定义为出发点，完成以下任务：\n\n- 从第一性原理出发，推导边际协方差 $\\operatorname{Cov}(X,Y)$ 的表达式，用 $p$, $\\{\\mu_{x,z},\\mu_{y,z},\\sigma_{x,z},\\sigma_{y,z},\\rho_{z}\\}_{z\\in\\{0,1\\}}$ 表示，并明确展示中心内和中心间分量是如何构成的。\n\n- 根据你推导出的表达式，陈述一个一般条件，在该条件下边际相关性 $\\operatorname{Corr}(X,Y)$ 为负，而中心内相关性 $\\operatorname{Corr}(X,Y\\mid Z=0)$ 和 $\\operatorname{Corr}(X,Y\\mid Z=1)$ 均为正。用文字解释这个条件在合并散点图与分层散点图中是如何表现的。\n\n- 将你的结果应用于上述数值参数化，将 $\\operatorname{Cov}(X,Y)$ 简化为 $p$ 的函数，并求解使边际协方差为零的两个混合比例。将较小的根记为 $p_{-}$。\n\n报告 $p_{-}$ 的值，四舍五入到四位有效数字。不包含单位。以不带百分号的数字表示最终结果。全文假设方差是有限且非零的，因此相关性有良好定义，并且任何相关性公式中的分母都严格为正。本题不涉及角度测量。", "solution": "本题将按要求分三部分解答。首先，我们将推导边际协方差 $\\operatorname{Cov}(X,Y)$ 的一般表达式。其次，我们将使用此表达式来阐明辛普森悖论的条件。第三，我们将应用所提供的特定参数值来求解数值解。\n\n**第一部分：边际协方差的推导**\n\n$X$ 和 $Y$ 之间的边际协方差定义为 $\\operatorname{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y]$。为了用给定的条件参数推导表达式，我们使用全期望定律和全协方差定律。全协方差定律表明，对于随机变量 $X$、$Y$ 和 $Z$：\n$$\n\\operatorname{Cov}(X,Y) = \\mathbb{E}[\\operatorname{Cov}(X,Y \\mid Z)] + \\operatorname{Cov}(\\mathbb{E}[X \\mid Z], \\mathbb{E}[Y \\mid Z])\n$$\n这个公式巧妙地将总协方差分解为两个分量：一个中心内分量和一个中心间分量。\n\n第一项 $\\mathbb{E}[\\operatorname{Cov}(X,Y \\mid Z)]$ 代表中心内协方差的平均值，按每个中心的概率加权。当条件变量 $Z$ 等于 $z$ 时，随机变量 $\\operatorname{Cov}(X,Y \\mid Z)$ 的取值为 $\\operatorname{Cov}(X,Y \\mid Z=z)$。根据题目陈述，$\\operatorname{Cov}(X,Y \\mid Z=z) = \\rho_z \\sigma_{x,z} \\sigma_{y,z}$。该期望是关于 $Z$ 的分布计算的：\n\\begin{align*} \\mathbb{E}[\\operatorname{Cov}(X,Y \\mid Z)] = \\sum_{z \\in \\{0,1\\}} \\mathbb{P}(Z=z) \\operatorname{Cov}(X,Y \\mid Z=z) \\\\ = \\mathbb{P}(Z=0) \\operatorname{Cov}(X,Y \\mid Z=0) + \\mathbb{P}(Z=1) \\operatorname{Cov}(X,Y \\mid Z=1) \\\\ = (1-p) (\\rho_0 \\sigma_{x,0} \\sigma_{y,0}) + p (\\rho_1 \\sigma_{x,1} \\sigma_{y,1})\\end{align*}\n这就是总协方差的**中心内分量**。\n\n第二项 $\\operatorname{Cov}(\\mathbb{E}[X \\mid Z], \\mathbb{E}[Y \\mid Z])$ 代表条件均值的协方差。令 $U = \\mathbb{E}[X \\mid Z]$ 和 $V = \\mathbb{E}[Y \\mid Z]$。这些是依赖于 $Z$ 的随机变量。\n$U$ 以 $1-p$ 的概率取值 $\\mu_{x,0}$（当 $Z=0$ 时），以 $p$ 的概率取值 $\\mu_{x,1}$（当 $Z=1$ 时）。\n$V$ 以 $1-p$ 的概率取值 $\\mu_{y,0}$（当 $Z=0$ 时），以 $p$ 的概率取值 $\\mu_{y,1}$（当 $Z=1$ 时）。\n协方差为 $\\operatorname{Cov}(U,V) = \\mathbb{E}[UV] - \\mathbb{E}[U]\\mathbb{E}[V]$。\n期望为：\n$$\n\\mathbb{E}[U] = (1-p)\\mu_{x,0} + p\\mu_{x,1}\n$$\n$$\n\\mathbb{E}[V] = (1-p)\\mu_{y,0} + p\\mu_{y,1}\n$$\n乘积的期望为：\n$$\n\\mathbb{E}[UV] = \\mathbb{P}(Z=0) \\mu_{x,0}\\mu_{y,0} + \\mathbb{P}(Z=1) \\mu_{x,1}\\mu_{y,1} = (1-p)\\mu_{x,0}\\mu_{y,0} + p\\mu_{x,1}\\mu_{y,1}\n$$\n将这些代入协方差公式：\n\\begin{align*} \\operatorname{Cov}(U,V) = [(1-p)\\mu_{x,0}\\mu_{y,0} + p\\mu_{x,1}\\mu_{y,1}] - [(1-p)\\mu_{x,0} + p\\mu_{x,1}][(1-p)\\mu_{y,0} + p\\mu_{y,1}] \\\\ = (1-p)\\mu_{x,0}\\mu_{y,0} + p\\mu_{x,1}\\mu_{y,1} - \\left( (1-p)^2\\mu_{x,0}\\mu_{y,0} + p(1-p)\\mu_{x,0}\\mu_{y,1} + p(1-p)\\mu_{x,1}\\mu_{y,0} + p^2\\mu_{x,1}\\mu_{y,1} \\right) \\\\ = \\mu_{x,0}\\mu_{y,0} ((1-p) - (1-p)^2) + \\mu_{x,1}\\mu_{y,1} (p - p^2) - p(1-p)\\mu_{x,0}\\mu_{y,1} - p(1-p)\\mu_{x,1}\\mu_{y,0} \\\\ = \\mu_{x,0}\\mu_{y,0} (p(1-p)) + \\mu_{x,1}\\mu_{y,1} (p(1-p)) - p(1-p)\\mu_{x,0}\\mu_{y,1} - p(1-p)\\mu_{x,1}\\mu_{y,0} \\\\ = p(1-p) [ \\mu_{x,0}\\mu_{y,0} - \\mu_{x,0}\\mu_{y,1} - \\mu_{x,1}\\mu_{y,0} + \\mu_{x,1}\\mu_{y,1} ] \\\\ = p(1-p) [ (\\mu_{x,1} - \\mu_{x,0})(\\mu_{y,1} - \\mu_{y,0}) ] \\end{align*}\n这就是总协方差的**中心间分量**。\n\n结合这两个分量，边际协方差的最终表达式为：\n$$\n\\operatorname{Cov}(X,Y) = \\underbrace{(1-p)(\\rho_0 \\sigma_{x,0} \\sigma_{y,0}) + p(\\rho_1 \\sigma_{x,1} \\sigma_{y,1})}_\\text{中心内（平均协方差）} + \\underbrace{p(1-p)(\\mu_{x,1}-\\mu_{x,0})(\\mu_{y,1}-\\mu_{y,0})}_\\text{中心间（均值的协方差）}\n$$\n\n**第二部分：边际负相关而条件正相关的条件**\n\n边际（合并）相关性与条件（分层）相关性符号相反的现象被称为辛普森悖论。我们被要求找出 $\\operatorname{Corr}(X,Y)  0$ 而 $\\operatorname{Corr}(X,Y\\mid Z=0)  0$ 和 $\\operatorname{Corr}(X,Y\\mid Z=1)  0$ 的条件。\n\n由于边际标准差 $\\sigma_X = \\sqrt{\\operatorname{Var}(X)}$ 和 $\\sigma_Y = \\sqrt{\\operatorname{Var}(Y)}$ 严格为正，相关性的符号由协方差的符号决定。因此，$\\operatorname{Corr}(X,Y)  0 \\iff \\operatorname{Cov}(X,Y)  0$。\n对中心内相关性的条件是 $\\operatorname{Corr}(X,Y\\mid Z=z) = \\rho_z  0$，对于 $z \\in \\{0, 1\\}$。\n\n给定 $\\rho_0  0$ 和 $\\rho_1  0$，对于 $p \\in (0,1)$，协方差的中心内分量 $(1-p)(\\rho_0 \\sigma_{x,0} \\sigma_{y,0}) + p(\\rho_1 \\sigma_{x,1} \\sigma_{y,1})$ 恒为正。\n\n为了使总协方差 $\\operatorname{Cov}(X,Y)$ 为负，中心间分量必须为负，并且其绝对值必须超过正的中心内分量的绝对值。\n因子 $p(1-p)$ 对于 $p \\in (0,1)$ 恒为正。因此，要使中心间分量为负，我们必须有：\n$$\n(\\mu_{x,1}-\\mu_{x,0})(\\mu_{y,1}-\\mu_{y,0})  0\n$$\n这是关键条件。它意味着两个条件分布的中心必须是负相关的：当 $X$ 的均值从一个中心到另一个中心增加时，$Y$ 的均值必须减少，反之亦然。\n\n悖论发生的完整条件是：\n$$\n\\underbrace{p(1-p)(\\mu_{x,1}-\\mu_{x,0})(\\mu_{y,1}-\\mu_{y,0})}_\\text{负的中心间项}  - \\underbrace{((1-p)\\rho_0 \\sigma_{x,0} \\sigma_{y,0} + p\\rho_1 \\sigma_{x,1} \\sigma_{y,1})}_\\text{正的中心内项}\n$$\n\n在散点图中，这表现如下：\n- **分层散点图**：当分别为每个中心（$Z=0$ 和 $Z=1$）绘制 $(X,Y)$ 数据时，我们会看到两个不同的点云。因为 $\\rho_0  0$ 和 $\\rho_1  0$，每个点云都会呈现出明显的正向（向上倾斜）趋势。\n- **合并散点图**：当将所有数据点绘制在一起并忽略中心标签 $Z$ 时，整体的视觉趋势可能为负。这是因为两个点云的中心位置形成了一种主导性的负相关。例如，$Z=0$ 的点云中心位于低 $X$ 和高 $Y$（例如 $(\\mu_{x,0}, \\mu_{y,0})$），而 $Z=1$ 的点云中心位于高 $X$ 和低 $Y$（例如 $(\\mu_{x,1}, \\mu_{y,1})$）。组均值之间的这种强烈的负趋势可以压倒每个组内部较弱的正趋势，从而导致整体呈负相关。\n\n**第三部分：应用与计算**\n\n我们现在代入给定的数值参数化：\n- 对于 $Z=0$：$(\\mu_{x,0},\\mu_{y,0})=(0,10)$，$\\sigma_{x,0}=1$，$\\sigma_{y,0}=1$，$\\rho_{0}=0.4$。\n- 对于 $Z=1$：$(\\mu_{x,1},\\mu_{y,1})=(10,0)$，$\\sigma_{x,1}=1$，$\\sigma_{y,1}=1$，$\\rho_{1}=0.4$。\n\n首先，我们计算中心内协方差分量：\n$$\n\\mathbb{E}[\\operatorname{Cov}(X,Y \\mid Z)] = (1-p)(0.4 \\times 1 \\times 1) + p(0.4 \\times 1 \\times 1) = 0.4(1-p) + 0.4p = 0.4\n$$\n接下来，我们计算中心间协方差分量：\n$$\n\\operatorname{Cov}(\\mathbb{E}[X \\mid Z], \\mathbb{E}[Y \\mid Z]) = p(1-p)(\\mu_{x,1}-\\mu_{x,0})(\\mu_{y,1}-\\mu_{y,0})\n$$\n均值之差为：\n$$\n\\mu_{x,1}-\\mu_{x,0} = 10 - 0 = 10\n$$\n$$\n\\mu_{y,1}-\\mu_{y,0} = 0 - 10 = -10\n$$\n所以中心间分量是：\n$$\np(1-p)(10)(-10) = -100p(1-p)\n$$\n边际协方差作为 $p$ 的函数是：\n$$\n\\operatorname{Cov}(X,Y) = 0.4 - 100p(1-p) = 0.4 - 100p + 100p^2\n$$\n我们被要求找出使边际协方差为零的 $p$ 值。我们令 $\\operatorname{Cov}(X,Y)=0$：\n$$\n100p^2 - 100p + 0.4 = 0\n$$\n这是一个关于 $p$ 的一元二次方程。我们使用求根公式 $p = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中 $a=100$，$b=-100$，$c=0.4$。\n$$\np = \\frac{-(-100) \\pm \\sqrt{(-100)^2 - 4(100)(0.4)}}{2(100)} = \\frac{100 \\pm \\sqrt{10000 - 160}}{200} = \\frac{100 \\pm \\sqrt{9840}}{200}\n$$\n现在，我们计算平方根的数值：\n$$\n\\sqrt{9840} \\approx 99.1967741\n$$\n$p$ 的两个根是：\n$$\np_{+} = \\frac{100 + 99.1967741}{200} = \\frac{199.1967741}{200} \\approx 0.99598387\n$$\n$$\np_{-} = \\frac{100 - 99.1967741}{200} = \\frac{0.8032259}{200} \\approx 0.00401613\n$$\n题目要求的是较小的根，记为 $p_{-}$。\n$$\np_{-} \\approx 0.00401613\n$$\n四舍五入到四位有效数字得到：\n$$\np_{-} \\approx 0.004016\n$$", "answer": "$$\\boxed{0.004016}$$", "id": "4897914"}]}