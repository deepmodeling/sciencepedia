{"hands_on_practices": [{"introduction": "拟合线性回归模型只是分析的第一步；我们还需要评估模型对数据的拟合程度。此练习将介绍决定系数（$R^2$），这是一个衡量模型解释了结果变量中多大比例变异的关键指标。通过这个练习，您将学会如何利用方差分析（ANOVA）表中的基本方差成分来计算和理解 $R^2$ [@problem_id:1895447]。", "problem": "一位农业科学家正在研究添加到土壤中的特定营养补充剂的量（单位：克）与一个新开发的植物物种的后续高度（单位：厘米）之间的关系。使用一个简单线性回归模型来拟合收集到的数据。为了评估模型的拟合优度，进行了一项方差分析 (ANOVA)。分析得出回归平方和 (SSR) 为 90.0 cm$^2$，总平方和 (SST) 为 120.0 cm$^2$。\n\n计算该线性回归模型的决定系数，记为 $R^2$。将答案以小数值形式表示。", "solution": "线性回归的决定系数定义为可由回归解释的总变异性的比例：\n$$\nR^{2}=\\frac{\\text{SSR}}{\\text{SST}}.\n$$\n已知 $\\text{SSR}=90.0$ 且 $\\text{SST}=120.0$，代入公式：\n$$\nR^{2}=\\frac{90.0}{120.0}=\\frac{9}{12}=\\frac{3}{4}=0.75.\n$$\n因此，决定系数为 $0.75$。", "answer": "$$\\boxed{0.75}$$", "id": "1895447"}, {"introduction": "在现实世界中，一个变量的影响往往取决于另一个变量的水平，简单的线性相加模型可能无法捕捉这种复杂性。这个练习将探讨一个更高级但更贴近现实的情景：交互效应，即两个或多个预测变量的联合效应不等于它们各自效应之和。通过分析药物效果如何随患者年龄变化，您将掌握解读包含交互项的模型系数的技能，这在生物统计学中至关重要 [@problem_id:4919994]。", "problem": "一项临床试验研究某种降脂药物对低密度脂蛋白胆固醇 (LDL-C) 的影响，其单位为毫克/分升 (mg/dL)。设结果变量为空腹LDL-C水平，记为 $Y$。考虑两个预测变量：用于药物分配的二元指示变量 $X_{1}$（如果患者接受药物治疗，则 $X_{1}=1$，否则 $X_{1}=0$）和以年为单位的年龄 $X_{2}$。为了使药物效果能够随年龄变化，模型中加入了 $X_{1}$ 和 $X_{2}$ 之间的交互项。条件均值函数的普通最小二乘 (OLS) 估计为\n$$\n\\mathbb{E}[Y \\mid X_{1}, X_{2}] = \\beta_{0} + \\beta_{1} X_{1} + \\beta_{2} X_{2} + \\beta_{3} X_{1} X_{2},\n$$\n拟合系数为 $\\beta_{0} = 160$，$\\beta_{1} = -30$，$\\beta_{2} = 0.6$ 和 $\\beta_{3} = 0.2$。\n\n从线性模型中条件均值的定义和交互项的含义出发，解释与省略交互项的模型相比，包含乘积项 $X_{1} X_{2}$ 如何改变主效应系数 $\\beta_{1}$ 和 $\\beta_{2}$ 的解释。然后，使用上述拟合系数，计算在 $X_{2} = 60$ 时，$X_{1}$ 对期望LDL-C的边际效应，该边际效应定义为在保持 $X_{2}$ 不变的情况下，$X_{1}$ 增加一个单位时 $\\mathbb{E}[Y \\mid X_{1}, X_{2}]$ 的变化。用 mg/dL 表示你的数值答案，并四舍五入到四位有效数字。", "solution": "给定预测变量 $X_1$（用药状态）和 $X_2$（年龄），结果变量 $Y$（LDL-C 水平）的条件均值的指定普通最小二乘 (OLS) 模型是：\n$$\n\\mathbb{E}[Y \\mid X_{1}, X_{2}] = \\beta_{0} + \\beta_{1} X_{1} + \\beta_{2} X_{2} + \\beta_{3} X_{1} X_{2}\n$$\n\n为了理解交互项 $X_{1}X_{2}$ 如何改变主效应系数 $\\beta_1$ 和 $\\beta_2$ 的解释，我们首先考虑一个不含此项的模型，通常称为加性模型或主效应模型：\n$$\n\\mathbb{E}[Y \\mid X_{1}, X_{2}] = \\alpha_{0} + \\alpha_{1} X_{1} + \\alpha_{2} X_{2}\n$$\n在这个加性模型中，系数 $\\alpha_1$ 代表在保持 $X_2$ 不变的情况下，$X_1$ 从0变为1时 $Y$ 均值的差异。这个效应在 $X_2$ 的所有值上都是恒定的。类似地，$\\alpha_2$ 代表在保持 $X_1$ 不变的情况下，$X_2$ 每增加一个单位时 $Y$ 均值的变化。这个效应被假定对于用药组 ($X_1=1$) 和对照组 ($X_1=0$) 是相同的。\n\n现在，我们回到带交互项的模型：\n$$\n\\mathbb{E}[Y \\mid X_{1}, X_{2}] = \\beta_{0} + \\beta_{1} X_{1} + \\beta_{2} X_{2} + \\beta_{3} X_{1} X_{2}\n$$\n包含乘积项 $X_1X_2$ 使得每个预测变量对结果的影响可以依赖于另一个预测变量的水平。\n\n**$\\beta_1$的解释：**\n药物的“效应”，即患者接受药物治疗时（$X_1$ 从0变为1）期望LDL-C的变化，是通过计算条件期望的差值得出的：\n$$\n\\text{Effect of } X_1 = \\mathbb{E}[Y \\mid X_1=1, X_2] - \\mathbb{E}[Y \\mid X_1=0, X_2]\n$$\n代入模型方程：\n$$\n\\text{Effect of } X_1 = (\\beta_0 + \\beta_1(1) + \\beta_2 X_2 + \\beta_3(1)X_2) - (\\beta_0 + \\beta_1(0) + \\beta_2 X_2 + \\beta_3(0)X_2)\n$$\n$$\n\\text{Effect of } X_1 = (\\beta_0 + \\beta_1 + \\beta_2 X_2 + \\beta_3 X_2) - (\\beta_0 + \\beta_2 X_2) = \\beta_1 + \\beta_3 X_2\n$$\n与效应是常数（$\\alpha_1$）的加性模型不同，在这里药物的效应是年龄 $X_2$ 的函数。系数 $\\beta_1$ 不再是药物的总体主效应。相反，它代表在 $X_2=0$ 的特定条件下药物的效应。也就是说，$\\beta_1$ 是年龄为0的人在用药组和对照组之间LDL-C的期望差异。在加性模型中，$\\alpha_1$ 代表任何年龄下的这种差异。\n\n**$\\beta_2$的解释：**\n年龄每增加一个单位（$X_2$）对期望LDL-C的影响可以通过对条件均值函数求关于 $X_2$ 的偏导数得到：\n$$\n\\frac{\\partial}{\\partial X_2} \\mathbb{E}[Y \\mid X_1, X_2] = \\frac{\\partial}{\\partial X_2} (\\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\beta_3 X_1 X_2) = \\beta_2 + \\beta_3 X_1\n$$\n年龄的效应不再是一个常数，而是取决于用药状态 $X_1$。\n- 对于对照组 ($X_1=0$)，年龄每增加一岁的影响是 $\\beta_2 + \\beta_3(0) = \\beta_2$。\n- 对于用药组 ($X_1=1$)，年龄每增加一岁的影响是 $\\beta_2 + \\beta_3(1) = \\beta_2 + \\beta_3$。\n\n因此，系数 $\\beta_2$ 不像在加性模型中那样是年龄的一般效应。相反，它仅代表在对照组 ($X_1=0$) 中，年龄每增加一岁对LDL-C的特定效应。相比之下，在加性模型中，$\\alpha_2$ 代表两组中年龄的效应。\n\n**总结：** 包含交互项 $X_1X_2$ 将 $\\beta_1$ 和 $\\beta_2$ 的解释从平均效应或主效应改变为条件效应或简单效应。$\\beta_1$ 成为当 $X_2=0$ 时 $X_1$ 的效应，而 $\\beta_2$ 成为当 $X_1=0$ 时 $X_2$ 的效应。\n\n现在，我们计算在 $X_2 = 60$ 时，$X_1$ 对期望LDL-C的边际效应。$X_1$ 的边际效应是当 $X_1$ 增加一个单位时 $\\mathbb{E}[Y \\mid X_1, X_2]$ 的变化，我们已经推导过：\n$$\n\\text{Marginal Effect of } X_1 = \\beta_1 + \\beta_3 X_2\n$$\n问题提供了拟合系数：$\\beta_1 = -30$，$\\beta_3 = 0.2$。我们被要求在年龄 $X_2 = 60$ 时评估这个效应。\n代入数值：\n$$\n\\text{Marginal Effect at } X_2=60 = -30 + (0.2)(60)\n$$\n$$\n= -30 + 12\n$$\n$$\n= -18\n$$\n这意味着对于一个60岁的患者，与不接受药物治疗相比，接受药物治疗与LDL-C平均降低18 mg/dL相关。问题要求答案四舍五入到四位有效数字。因此，$-18$ 应表示为 $-18.00$。", "answer": "$$\n\\boxed{-18.00}\n$$", "id": "4919994"}, {"introduction": "数据分析不仅是运行算法，更是对数据的仔细审查，因为并非所有数据点都是平等的。此练习将您置于数据分析师的角色，利用杠杆率和库克距离等诊断工具来识别有影响力的异常观测值。此练习旨在强调，处理异常值需要有原则的判断，而不是机械地删除，必须结合统计证据和科学背景来区分一个点是宝贵信息还是需要修正的错误 [@problem_id:4920003]。", "problem": "一个生物统计学团队在一个样本量为 $n=120$ 的社区研究中，将非糖尿病成年人的空腹血浆葡萄糖（用 $Y$ 表示，单位为毫克/分升）建模为年龄（用 $X$ 表示，单位为年）的线性函数。该团队拟合了普通最小二乘法 (OLS) 简单线性回归模型 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$，并使用标准诊断方法来评估异常或有影响的观测值。有两个观测值引起了关注：\n\n1. 受试者 A 的数据为 $X=92$ 和 $Y=95$。对受试者 A 的诊断显示，杠杆值 $h_{ii}=0.30$，学生化残差 $r_i=0.4$，库克距离 $D_i=0.08$。该受试者 92 岁的年龄在研究的目标人群范围内，重复检查确认测量程序被正确遵循。拟合模型在 $X=92$ 处的点预测值为 $98$，与观测到的 $Y$ 值接近。\n\n2. 受试者 B 的数据为 $X=34$ 和 $Y=540$。对受试者 B 的诊断显示，杠杆值 $h_{ii}=0.10$，学生化残差 $r_i=5.2$，库克距离 $D_i=1.1$。对于非糖尿病患者的空腹测量，实验室参考资料表明，在没有与研究纳入标准不符的急性病理情况下，高于 400 毫克/分升的数值在生理上是不合理的。一份实验室审计报告指出，该样本严重溶血，并且分析仪对该标本触发了校准标志。\n\n基于线性回归的基本原理和科学严谨的离群值评估方法，哪个选项最恰当地区分了 $X$ 方向的离群值和 $Y \\mid X$ 方向的离群值，并为可能的排除设定了有原则的行动方案？\n\nA. 立即排除两名受试者，因为诊断表明他们具有影响力。\n\nB. 在确认测量有效性和科学合理性后保留受试者 A；对于受试者 B，调查数据来源，考虑生理合理性和有记录的测量误差，如果测量误差得到证实或该值对目标人群不合理，则排除受试者 B；否则，通过包含和不包含受试者 B 的数据重新拟合模型进行敏感性分析，并报告其影响。\n\nC. 排除任何具有高杠杆值 $h_{ii}$ 的观测值，无论其残差或合理性如何，因为高杠杆值总是会使斜率估计产生偏倚。\n\nD. 保留两个观测值并收集更多数据，直到它们的影响可以忽略不计；排除永远没有正当理由，因为它会引入偏倚。", "solution": "处理异常观测值的核心原则是，统计诊断是用于识别的工具，而不是用于排除的自动裁决者。移除一个数据点的决定必须有模型拟合本身之外的证据来支持，这些证据通常与数据完整性或人群定义有关。\n\n**对受试者 A 的分析：**\n- 该观测值具有高杠杆值（$h_{ii}=0.30$），意味着其 $X$ 值（$X=92$）远离受试者的平均年龄 $\\bar{X}$。高杠杆值的一个常用阈值是 $2p/n$，其中 $p$ 是模型参数的数量（对于 $\\beta_0, \\beta_1$，$p=2$），$n$ 是样本量（$n=120$）。在这里，$2p/n = 4/120 \\approx 0.033$。由于 $0.30 \\gg 0.033$，受试者 A 具有高杠杆值。\n- 学生化残差很小（$r_i=0.4$），表明观测到的 $Y$ 值（$Y=95$）非常接近回归线预测的值（$\\hat{Y}=98$）。该点符合其他数据点建立的线性趋势。\n- 库克距离（$D_i=0.08$）高于 $4/n \\approx 0.033$ 的阈值，表明有一定影响，但不是压倒性的巨大（例如，不大于 $1$）。\n- 背景至关重要：该年龄对于该人群是合理的，并且测量结果已经过验证。\n- **对受试者 A 的结论**：这是一个“好的”高杠杆点。它是来自目标人群的真实观测值，位于预测变量空间的远端，但与模型一致。这样的点可以提高斜率估计的精度（即，减小 $\\hat{\\beta}_1$ 的标准误），应该被保留。没有原则性的理由将其排除。\n\n**对受试者 B 的分析：**\n- 该观测值具有中等杠杆值（$h_{ii}=0.10$），仍高于 $2p/n \\approx 0.033$ 的阈值，但没有受试者 A 那么极端。\n- 学生化残差非常大（$r_i=5.2$）。一个通用的经验法则是将 $|r_i|>3$ 的观测值标记为极端离群值。这意味着观测到的 $Y$ 值（$Y=540$）与模型为年龄 $X=34$ 预测的值相差甚远。这是一个在给定 $X$ 的条件下，$Y$ 方向上的明显离群值。\n- 库克距离非常大（$D_i=1.1$），超过了常用的阈值 $1$，表明该点具有高度影响力。将其移除将导致估计的截距 $\\hat{\\beta}_0$ 和斜率 $\\hat{\\beta}_1$ 发生实质性变化。\n- 背景为行动提供了明确的理由。对于非糖尿病个体，540 mg/dL 的空腹血糖被认为是“生理上不合理的”。更重要的是，存在具体的、有记录的测量误差：“严重溶血”的样本和“校准标志”。\n- **对受试者 B 的结论**：该点不能有效代表目标人群中潜在的生物学关系。它是一个受污染的测量值。统计诊断正确地将其标记为有问题，随后的调查证实了它是坏数据。正确的做法是排除这个观测值，以避免用错误信息对模型造成偏倚。\n\n**评估选项**\n\n**A. 立即排除两名受试者，因为诊断表明他们具有影响力。**\n这是对诊断工具不当的、机械的应用。受试者 A 是一个有效的数据点，应该被保留。影响力本身不是排除的充分标准。必须考虑数据点的有效性和科学背景。\n**结论：不正确**\n\n**B. 在确认测量有效性和科学合理性后保留受试者 A；对于受试者 B，调查数据来源，考虑生理合理性和有记录的测量误差，如果测量误差得到证实或该值对目标人群不合理，则排除受试者 B；否则，通过包含和不包含受试者 B 的数据重新拟合模型进行敏感性分析，并报告其影响。**\n这个选项描述了科学上和统计学上严谨的方法。它正确地建议保留有效的高杠杆点（受试者 A）。对于受试者 B，它正确地将调查离群状态的原因放在首位。由于问题陈述为受试者 B 提供了测量误差和生理不合理性的证据，根据该选项的框架，排除是合理的。如果调查没有定论，它还正确地将敏感性分析指定为备用方案。这是正确的方法论。\n**结论：正确**\n\n**C. 排除任何具有高杠杆值 $h_{ii}$ 的观测值，无论其残差或合理性如何，因为高杠杆值总是会使斜率估计产生偏倚。**\n这个说法是错误的。高杠杆值并不总是使斜率产生偏倚。一个残差小的高杠杆点（如受试者 A）符合模型，并且可以提高斜率估计的精度。排除所有高杠杆点是一种丢弃有价值信息的有缺陷的策略。\n**结论：不正确**\n\n**D. 保留两个观测值并收集更多数据，直到它们的影响可以忽略不计；排除永远没有正当理由，因为它会引入偏倚。**\n这包含一个危险的谬论。虽然不明智的排除会引入偏倚，但断言排除*永远*没有正当理由是错误的。明知一个数据点被证实是错误的（由于设备故障、样本污染等，如受试者 B 的情况），还将其包含在内，会破坏分析并使结果产生偏倚。目标是模拟真实的关系，而包含已知是错误的数据会破坏这个目标。移除一个可证明是无效的数据点是*减少*偏倚的必要步骤。\n**结论：不正确**", "answer": "$$\\boxed{B}$$", "id": "4920003"}]}