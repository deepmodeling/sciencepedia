{"hands_on_practices": [{"introduction": "要真正掌握皮尔逊相关系数，最好的方法莫过于亲手实践其计算过程。这个练习将引导你从最原始的数据出发，一步步计算得出最终的相关系数值。通过手动计算样本均值、标准差和协方差这些核心组成部分，你将深刻理解这些基础统计量是如何共同作用，最终量化两个变量间的线性关联强度的。[@problem_id:4825168]", "problem": "一项循证医学（EBM）领域的试点研究探讨了高血压成年人基线膳食钠摄入量与12周收缩压变化之间的线性关联。对于每位参与者，配对数据 $(x_i,y_i)$ 包括：$x_i$ 等于基线时每日摄入的钠克数，$y_i$ 等于随访期间收缩压的变化量，单位为毫米汞柱（$y_i$为正值表示升高）。样本量为 $n=5$，观测到的数据对为：$(2,3)$, $(4,5)$, $(6,4)$, $(8,9)$, $(10,11)$。\n\n请仅使用适用于统计推断的基本定义，从第一性原理出发，计算钠摄入量（$X$）和血压变化（$Y$）的以下样本摘要统计量：样本均值 $\\bar{x}$ 和 $\\bar{y}$，无偏样本标准差 $s_X$ 和 $s_Y$，无偏样本协方差 $s_{XY}$，以及被解释为标准化协方差的皮尔逊积矩相关系数 $r$。请在循证医学的背景下，对 $r$ 的大小进行简短的定性解释，并指出样本量较小这一事实。\n\n仅报告保留四位有效数字的 $r$ 最终值。中间计算量应尽可能保留精确形式，不要进行不必要的四舍五入。最终答案必须是无单位的单一数字。", "solution": "问题陈述经评估有效。它具有科学依据，问题提出得当，客观，并包含得出唯一解所需的所有必要信息。其背景是循证医学（EBM）中的一项标准统计分析，数据亦属合理。陈述中没有矛盾、歧义或逻辑缺陷。因此，我们可以开始解题。\n\n问题要求从第一性原理出发，为一组 $n=5$ 的配对观测值 $(x_i, y_i)$ 计算若干样本统计量。数据如下：$(2,3)$, $(4,5)$, $(6,4)$, $(8,9)$, $(10,11)$。其中，$x_i$ 代表基线膳食钠摄入量（单位：克/天），$y_i$ 代表收缩压的变化量（单位：mmHg）。\n\n首先，我们计算 $X$ 和 $Y$ 的样本均值，记为 $\\bar{x}$ 和 $\\bar{y}$。\n样本均值的公式为 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。\n对于钠摄入量数据 $X$：\n$$ \\sum_{i=1}^{5} x_i = 2 + 4 + 6 + 8 + 10 = 30 $$\n$$ \\bar{x} = \\frac{30}{5} = 6 $$\n对于血压变化数据 $Y$：\n$$ \\sum_{i=1}^{5} y_i = 3 + 5 + 4 + 9 + 11 = 32 $$\n$$ \\bar{y} = \\frac{32}{5} = 6.4 $$\n\n接下来，我们计算无偏样本标准差 $s_X$ 和 $s_Y$。这需要先计算无偏样本方差 $s_X^2$ 和 $s_Y^2$。无偏样本方差的公式是 $s^2 = \\frac{1}{n-1}\\sum_{i=1}^{n} (z_i - \\bar{z})^2$，其中求和部分是离均差平方和，常记为 $SS$。\n\n对于 $X$，离均差平方和 $SS_{xx}$ 为：\n$$ SS_{xx} = \\sum_{i=1}^{5} (x_i - \\bar{x})^2 = (2-6)^2 + (4-6)^2 + (6-6)^2 + (8-6)^2 + (10-6)^2 $$\n$$ SS_{xx} = (-4)^2 + (-2)^2 + (0)^2 + (2)^2 + (4)^2 = 16 + 4 + 0 + 4 + 16 = 40 $$\n$X$ 的无偏样本方差为：\n$$ s_X^2 = \\frac{SS_{xx}}{n-1} = \\frac{40}{5-1} = \\frac{40}{4} = 10 $$\n$X$ 的无偏样本标准差为：\n$$ s_X = \\sqrt{s_X^2} = \\sqrt{10} $$\n\n对于 $Y$，离均差平方和 $SS_{yy}$ 为：\n$$ SS_{yy} = \\sum_{i=1}^{5} (y_i - \\bar{y})^2 = (3-6.4)^2 + (5-6.4)^2 + (4-6.4)^2 + (9-6.4)^2 + (11-6.4)^2 $$\n$$ SS_{yy} = (-3.4)^2 + (-1.4)^2 + (-2.4)^2 + (2.6)^2 + (4.6)^2 = 11.56 + 1.96 + 5.76 + 6.76 + 21.16 = 47.2 $$\n$Y$ 的无偏样本方差为：\n$$ s_Y^2 = \\frac{SS_{yy}}{n-1} = \\frac{47.2}{5-1} = \\frac{47.2}{4} = 11.8 $$\n$Y$ 的无偏样本标准差为：\n$$ s_Y = \\sqrt{s_Y^2} = \\sqrt{11.8} $$\n\n现在，我们计算无偏样本协方差 $s_{XY}$。其公式为 $s_{XY} = \\frac{1}{n-1}\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$。求和部分是离均差乘积和，记为 $SS_{xy}$。\n$$ SS_{xy} = \\sum_{i=1}^{5} (x_i - \\bar{x})(y_i - \\bar{y}) $$\n$$ SS_{xy} = (2-6)(3-6.4) + (4-6)(5-6.4) + (6-6)(4-6.4) + (8-6)(9-6.4) + (10-6)(11-6.4) $$\n$$ SS_{xy} = (-4)(-3.4) + (-2)(-1.4) + (0)(-2.4) + (2)(2.6) + (4)(4.6) $$\n$$ SS_{xy} = 13.6 + 2.8 + 0 + 5.2 + 18.4 = 40 $$\n无偏样本协方差为：\n$$ s_{XY} = \\frac{SS_{xy}}{n-1} = \\frac{40}{5-1} = \\frac{40}{4} = 10 $$\n\n最后，我们计算皮尔逊积矩相关系数 $r$。它被定义为样本协方差除以样本标准差的乘积，即标准化后的协方差。\n$$ r = \\frac{s_{XY}}{s_X s_Y} $$\n代入我们计算出的值：\n$$ r = \\frac{10}{\\sqrt{10} \\sqrt{11.8}} = \\frac{\\sqrt{10}}{\\sqrt{11.8}} = \\sqrt{\\frac{10}{11.8}} = \\sqrt{\\frac{100}{118}} = \\sqrt{\\frac{50}{59}} $$\n为了获得最终数值，我们计算平方根并四舍五入到四位有效数字：\n$$ r \\approx \\sqrt{0.8474576...} \\approx 0.9205746... $$\n$$ r \\approx 0.9206 $$\n\n对此结果的定性解释如下。皮尔逊相关系数 $r \\approx 0.9206$ 表明，在此特定样本中，基线膳食钠摄入量与12周收缩压变化之间存在非常强的正线性关系。随着钠摄入量的增加，收缩压的变化也倾向于以高度线性的方式增加。然而，在循证医学的背景下，必须极其谨慎地解释这一发现。$n=5$ 的样本量对于做出任何可推广的推断来说都非常小。在如此小的数据集中，强相关性很可能偶然出现，并且对总体相关性的估计会受到非常大的抽样误差的影响。因此，尽管这一试点研究结果具有提示性，但它远非结论性的，在主张任何临床相关性之前，尚需在更大规模、设计精良的研究中进行验证。", "answer": "$$\\boxed{0.9206}$$", "id": "4825168"}, {"introduction": "在掌握了皮尔逊相关系数的基本计算后，探索其特性与潜在的“陷阱”至关重要。此练习通过一个包含极端离群值（outlier）的特殊数据集，生动地揭示了相关系数 $r$ 对极端值的极度敏感性。这个实践将告诉你，为什么在进行任何相关性分析之前，通过散点图等方式对数据进行可视化检查是不可或缺的一步，并帮助你建立一种宝贵的批判性思维能力。[@problem_id:4825051]", "problem": "一个转化医学团队正在研究一个小型试点队列中，在同一天记录的促炎性生物标志物与临床严重程度评分之间的关联。对于每个个体，设 $x$ 表示记录的生物标志物值，$y$ 表示记录的临床评分。给定 $n=6$ 个观测对：\n$$(x,y)\\in\\{(1,5),(2,4),(3,3),(4,2),(5,1),(100,100)\\}.$$\n最后一对数据是一个可疑的极端离群值，它可能是由数据处理错误（例如，单位换算错位）引起的。从样本均值、样本方差、样本协方差和皮尔逊积矩相关系数的核心定义出发，通过将其表示为样本原始和的形式，从第一性原理推导出相关系数。计算所有 $6$ 对数据的样本皮尔逊相关系数 $r$，然后在您的推导中，明确指出对应于交叉离差（分子）和边际平方和（分母）的项。使用这些已识别的项来解释，在这个医学数据背景下，单个极端离群值如何改变每个组成部分，并因此改变 $r$ 的值。将您的最终数值答案 $r$ 四舍五入到 $4$ 位有效数字。", "solution": "我们将首先提取给定信息，然后评估其科学和逻辑完整性，以此来验证问题陈述。\n\n### 步骤 1：提取已知信息\n-   观测对的数量为 $n=6$。\n-   数据由数对 $(x,y)$ 组成，其中 $x$ 是生物标志物值，$y$ 是临床评分。\n-   数据集为 $\\{(1,5),(2,4),(3,3),(4,2),(5,1),(100,100)\\}$。\n-   任务是从第一性原理出发，通过原始和的形式推导皮尔逊积矩相关系数 $r$。\n-   任务要求计算给定 $6$ 对数据的 $r$ 值。\n-   任务要求明确指出交叉离差和边际平方和的项。\n-   任务要求解释单个极端离群值 $(100,100)$ 如何改变每个组成部分以及 $r$ 的最终值。\n-   最终数值答案 $r$ 必须四舍五入到 $4$ 位有效数字。\n\n### 步骤 2：使用提取的已知信息进行验证\n-   **科学依据**：该问题基于描述性统计学的基本且普遍接受的原理。皮尔逊相关系数、样本均值、方差、协方差以及离群值的概念是生物统计学和数据分析中的标准主题。所呈现的场景（生物标志物与临床评分，并伴有数据处理错误）在医学研究中是现实且常见的。该问题在科学上是合理的。\n-   **适定性**：问题提供了所有必要的数据和一个清晰、明确的目标。可以从给定信息中确定一个唯一且有意义的解（$r$ 的值和所要求的解释）。\n-   **客观性**：问题使用精确、客观的数学和统计术语进行陈述。它要求进行一次计算，并基于该计算给出一个机理性的解释，不含主观因素。\n-   **缺陷清单**：问题没有违反任何无效性标准。它是事实可靠、可形式化、完整、可行、适定、非平凡且科学可验证的。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供完整的解答。\n\n### 解答推导与计算\n\n皮尔逊积矩相关系数 $r$ 定义为两个变量的样本协方差除以它们的样本标准差的乘积。\n\n设两个变量为 $x$ 和 $y$，样本为 $n$ 对数据 $(x_i, y_i)$。\n$x$ 的样本均值为 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$。\n$y$ 的样本均值为 $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i$。\n\n样本协方差定义为 $\\text{Cov}(x,y) = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$。\n$x$ 的样本方差为 $s_x^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2$。样本标准差为 $s_x = \\sqrt{s_x^2}$。\n$y$ 的样本方差为 $s_y^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2$。样本标准差为 $s_y = \\sqrt{s_y^2}$。\n\n皮尔逊相关系数 $r$ 由下式给出：\n$$r = \\frac{\\text{Cov}(x,y)}{s_x s_y} = \\frac{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2}}$$\n分子和分母中的因子 $\\frac{1}{n-1}$ 可以消掉，得到用离差平方和表示的表达式：\n$$r = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}}$$\n这就是所要求的第一性原理推导。\n\n在此公式中：\n-   分子，$SS_{xy} = \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$，是**交叉离差和**。\n-   分母平方根内的项是**边际平方和**：$SS_{xx} = \\sum_{i=1}^{n} (x_i - \\bar{x})^2$ 是关于 $x$ 的边际平方和，$SS_{yy} = \\sum_{i=1}^{n} (y_i - \\bar{y})^2$ 是关于 $y$ 的边际平方和。\n\n为了计算方便，这些和可以用原始和来表示，这样可以避免计算每个单独的离差：\n$SS_{xy} = \\sum x_i y_i - n\\bar{x}\\bar{y} = \\sum x_i y_i - \\frac{(\\sum x_i)(\\sum y_i)}{n}$\n$SS_{xx} = \\sum x_i^2 - n\\bar{x}^2 = \\sum x_i^2 - \\frac{(\\sum x_i)^2}{n}$\n$SS_{yy} = \\sum y_i^2 - n\\bar{y}^2 = \\sum y_i^2 - \\frac{(\\sum y_i)^2}{n}$\n\n数据为：$n=6$，数据对为 $(1,5), (2,4), (3,3), (4,2), (5,1), (100,100)$。\n首先，我们计算必要的原始和：\n$\\sum x_i = 1+2+3+4+5+100 = 115$\n$\\sum y_i = 5+4+3+2+1+100 = 115$\n$\\sum x_i^2 = 1^2+2^2+3^2+4^2+5^2+100^2 = 1+4+9+16+25+10000 = 10055$\n$\\sum y_i^2 = 5^2+4^2+3^2+2^2+1^2+100^2 = 25+16+9+4+1+10000 = 10055$\n$\\sum x_i y_i = (1)(5)+(2)(4)+(3)(3)+(4)(2)+(5)(1)+(100)(100) = 5+8+9+8+5+10000 = 10035$\n\n现在我们计算分量 $SS_{xy}$、$SS_{xx}$ 和 $SS_{yy}$：\n$SS_{xy} = 10035 - \\frac{(115)(115)}{6} = 10035 - \\frac{13225}{6} = \\frac{60210 - 13225}{6} = \\frac{46985}{6}$\n$SS_{xx} = 10055 - \\frac{(115)^2}{6} = 10055 - \\frac{13225}{6} = \\frac{60330 - 13225}{6} = \\frac{47105}{6}$\n$SS_{yy} = 10055 - \\frac{(115)^2}{6} = 10055 - \\frac{13225}{6} = \\frac{60330 - 13225}{6} = \\frac{47105}{6}$\n\n最后，我们计算 $r$：\n$$r = \\frac{SS_{xy}}{\\sqrt{SS_{xx} SS_{yy}}} = \\frac{\\frac{46985}{6}}{\\sqrt{\\frac{47105}{6} \\cdot \\frac{47105}{6}}} = \\frac{\\frac{46985}{6}}{\\frac{47105}{6}} = \\frac{46985}{47105}$$\n$r \\approx 0.99745250...$\n四舍五入到 $4$ 位有效数字，$r \\approx 0.9975$。\n\n### 离群值影响的解释\n\n为了理解离群值的影响，我们首先分析不包含它的数据。前五对数据是 $(1,5), (2,4), (3,3), (4,2), (5,1)$。对于这 $n'=5$ 个点：\n$\\sum x'_i = 1+2+3+4+5 = 15 \\implies \\bar{x}' = \\frac{15}{5} = 3$\n$\\sum y'_i = 5+4+3+2+1 = 15 \\implies \\bar{y}' = \\frac{15}{5} = 3$\n$SS'_{xy} = \\sum(x'_i - \\bar{x}')(y'_i - \\bar{y}') = (1-3)(5-3) + (2-3)(4-3) + (3-3)(3-3) + (4-3)(2-3) + (5-3)(1-3) = (-2)(2) + (-1)(1) + (0)(0) + (1)(-1) + (2)(-2) = -4 - 1 + 0 - 1 - 4 = -10$\n$SS'_{xx} = \\sum(x'_i - \\bar{x}')^2 = (-2)^2 + (-1)^2 + 0^2 + 1^2 + 2^2 = 4+1+0+1+4 = 10$\n$SS'_{yy} = \\sum(y'_i - \\bar{y}')^2 = (2)^2 + (1)^2 + 0^2 + (-1)^2 + (-2)^2 = 4+1+0+1+4 = 10$\n这五个点的相关系数为 $r' = \\frac{-10}{\\sqrt{10 \\cdot 10}} = -1$。\n这表明存在完美的负线性关系。这些点位于直线 $y = 6 - x$ 上。\n\n现在，我们引入离群值 $(100,100)$ 并分析它对决定整体相关性的各项和的影响。新的均值为 $\\bar{x} = \\frac{115}{6} \\approx 19.17$ 和 $\\bar{y} = \\frac{115}{6} \\approx 19.17$。数据云的中心被猛烈地从 $(3,3)$ 拉向离群值。\n\n我们来研究单个离群值 $(x_6, y_6) = (100, 100)$ 对完整数据集（$n=6$）的平方和的贡献：\n1.  **边际平方和（$SS_{xx}$ 和 $SS_{yy}$）**：离群值对 $SS_{xx}$ 的贡献是 $(x_6 - \\bar{x})^2 = (100 - \\frac{115}{6})^2 = (\\frac{485}{6})^2 = \\frac{235225}{36} \\approx 6534.03$。前五个点的贡献总和是 $\\sum_{i=1}^{5}(x_i - \\bar{x})^2 \\approx 1316.81$。因此，离群值在 $x$ 上的离差平方比其他所有点的离差平方之和大约 $4.96$ 倍。由于数据的对称性，同样的情况也适用于 $SS_{yy}$。这单个点极大地夸大了 $x$ 和 $y$ 的感知方差。\n\n2.  **交叉离差和（$SS_{xy}$）**：离群值的贡献是 $(x_6 - \\bar{x})(y_6 - \\bar{y}) = (100 - \\frac{115}{6})(100 - \\frac{115}{6}) = (\\frac{485}{6})^2 = \\frac{235225}{36} \\approx 6534.03$。前五个点的贡献总和是 $\\sum_{i=1}^{5}(x_i - \\bar{x})(y_i - \\bar{y}) \\approx 1296.81$。离群值的交叉乘积项比其他所有点的总和大约 $5.04$ 倍。\n\n**结论**：离群值 $(100,100)$ 具有极高的杠杆效应。因为它远离均值 $(\\bar{x}, \\bar{y})$，所以它对平方和（$SS_{xx}, SS_{yy}$）和交叉离差和（$SS_{xy}$）的单个贡献是巨大的。这些单点贡献在总和中占主导地位，淹没了其他五个点的集体贡献。最初的强负相关性（$r = -1$）是由前五个点的负交叉离差和（$SS'_{xy} = -10$）决定的。离群值给这个和增加了一个巨大的正值，使其符号翻转，并变得很大且为正（$SS_{xy} \\approx 7830.83$）。同时，它极大地夸大了分母项 $SS_{xx}$ 和 $SS_{yy}$。因为离群值位于直线 $y=x$ 上，它对 $SS_{xy}$ 的贡献几乎与其对 $SS_{xx}$ 和 $SS_{yy}$ 的贡献相同。这迫使比率 $\\frac{SS_{xy}}{\\sqrt{SS_{xx}SS_{yy}}}$ 非常接近 $+1$，从而完全逆转并掩盖了大部分数据中的潜在关系。这证明了皮尔逊 $r$ 对单个极端离群值的极度敏感性，这是在任何科学数据分析中都必须考虑的一个关键特性。", "answer": "$$\\boxed{0.9975}$$", "id": "4825051"}, {"introduction": "皮尔逊相关系数不仅是一个描述性统计量，它也是进行统计推断的有力工具，可以帮助我们判断样本中的关联是否可能存在于更大的群体中。本问题将介绍一种直观且强大的非参数方法——置换检验（permutation test），用于检验相关性为零的原假设（$H_0: \\rho=0$）。通过模拟在原假设下所有可能的数据配对情况，你将亲手构建出检验统计量的完整分布，从而具体地理解 $p$ 值的真实含义。[@problem_id:4825062]", "problem": "在一个初步的重症监护队列研究中，研究人员对同一组患者测量了两个连续的生物标志物：动脉血乳酸浓度（变量 $X$）和碱剩余（变量 $Y$），两者都经过预处理，使其中心化并缩放到可比较的单位。为了进行教学说明，考虑以下一个由 $n=4$ 名患者组成的简单示例样本，其 $(X_i,Y_i)$ 对由 $(x_i,y_i)\\in\\{-\\tfrac{3}{2},-\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{3}{2}\\}\\times\\{-\\tfrac{3}{2},-\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{3}{2}\\}$ 给出，对于每个 $i\\in\\{1,2,3,4\\}$，观测到的配对为 $y_i=x_i$。科学问题是，在总体中是否存在 $X$ 和 $Y$ 之间的线性关联证据，通过原假设 $H_0:\\rho=0$ 进行检验，其中 $\\rho$ 是总体皮尔逊积矩相关系数。\n\n请你从第一性原理出发，推理如何构建一个在 $H_0$ 下有效的置换检验，然后通过枚举所有标签置换来计算当 $n$ 很小时的精确概率值（p值）。\n\n哪个选项同时正确地描述了：\n- 如何通过相对于固定的 $x_i$ 重排 $y_i$ 并重复重新计算样本皮尔逊相关系数 $r$ 来实施一个用于 $H_0:\\rho=0$ 的有效置换检验，包括在离散随机化分布下双侧p值的正确定义；以及\n- 通过对所有 $n!$ 种置换进行穷举枚举，得出给定样本的精确双侧p值？\n\nA. 在 $X$ 和 $Y$ 独立且 $n$ 对数据独立同分布（IID）的原假设 $H_0$ 下，当以观测到的 $X$ 为条件时，$Y$ 相对于标签是可交换的。一个有效的算法是固定 $\\{x_i\\}_{i=1}^n$，重复抽取 $\\{1,\\dots,n\\}$ 的一个随机置换 $\\pi$，形成置换后的响应 $y_i^{\\ast}=y_{\\pi(i)}$，为每次置换重新计算检验统计量 $r^{\\ast}$（样本皮尔逊相关系数），并近似 $H_0$ 下 $r^{\\ast}$ 的随机化分布。双侧p值为 $p=\\Pr_{\\text{perm}}\\left(|r^{\\ast}|\\ge |r_{\\text{obs}}|\\right)$，对于较小的 $n$，可以通过计算 $|r^{\\ast}|\\ge |r_{\\text{obs}}|$ 的置换在所有 $n!$ 次置换中所占的比例来精确计算。对于给定的样本，$n=4$ 且 $r_{\\text{obs}}=1$，在 $4!=24$ 次置换中，恰好有 $2$ 次置换满足 $|r^{\\ast}|\\ge 1$（恒等置换和完全逆序置换），所以精确的双侧p值为 $p=2/24\\approx 0.0833$。\n\nB. 在 $H_0:\\rho=0$ 下，正确的随机化方法是联合地置换配对观测值 $(x_i,y_i)$（即打乱行），并每次重新计算 $r$，这种方法在 $H_0$ 下会保留任何关联。双侧p值为 $p=\\Pr_{\\text{perm}}\\left(|r^{\\ast}| |r_{\\text{obs}}|\\right)$，对于给定的样本，它等于 $p=1$，因为对于每一次置换，$r^{\\ast}=r_{\\text{obs}}$。\n\nC. 在 $H_0:\\rho=0$ 下，一个有效的随机化方法是保持标签固定，并以1/2的概率独立地将每个 $y_i$ 乘以 $\\pm 1$，然后每次重新计算 $r$；对于给定的样本，精确的双侧p值为 $p=(2-1)/24\\approx 0.0417$。\n\nD. 在 $H_0:\\rho=0$ 下，置换方法是不必要的；应该使用 $r$ 的大样本正态近似，并报告渐近双侧p值。对于给定的样本，$r_{\\text{obs}}=1$ 且 $n=4$，渐近双侧p值实际上为 $0$，并且即使对于小样本 $n$ 也是精确答案。", "solution": "用户要求对问题陈述进行严格验证，然后从第一性原理推导解决方案，并对所提供的选项进行评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   **背景**：初步的重症监护队列研究。\n-   **变量**:\n    -   $X$：动脉血乳酸浓度。\n    -   $Y$：碱剩余。\n    -   两者都是连续的、中心化的和缩放过的。\n-   **样本量**：$n=4$。\n-   **样本数据**：\n    -   $X$ 和 $Y$ 的观测值集合均为 $\\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$。\n    -   观测到的配对为 $y_i = x_i$（对于 $i \\in \\{1, 2, 3, 4\\}$）。因此，样本包含数据对 $(-\\frac{3}{2}, -\\frac{3}{2}), (-\\frac{1}{2}, -\\frac{1}{2}), (\\frac{1}{2}, \\frac{1}{2}), (\\frac{3}{2}, \\frac{3}{2})$。\n-   **假设检验**：\n    -   **科学问题**：检验 $X$ 和 $Y$ 之间是否存在线性关联的证据。\n    -   **原假设**：$H_0: \\rho=0$，其中 $\\rho$ 是总体皮尔逊积矩相关系数。\n-   **要求的方法**：\n    -   构建一个在 $H_0$ 下有效的置换检验。\n    -   通过枚举所有 $n!$ 种置换来计算精确的双侧p值。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题设定在生物统计学中是标准的。使用置换检验来检验两个生物标志物之间的相关性是一种有效且公认的统计程序。原假设 $H_0: \\rho=0$ 是检验无线性相关的标准原假设。从技术上讲，置换检验检验的是 $X$ 和 $Y$ 之间独立性的更强原假设，该假设意味着 $\\rho=0$。这是一种有效的方法。\n-   **定义明确**：该问题定义明确。它提供了具体的数据集、清晰的原假设以及特定的推断程序（完全枚举的置换检验）。问题要求描述该程序并给出精确的p值，这两者都由所提供的信息唯一确定。\n-   **客观性**：语言精确客观，使用了标准的统计术语。\n-   **完整性和一致性**：问题包含了所有必要信息。数据“中心化”的陈述与所提供的值一致，因为样本均值为 $\\sum_{i=1}^4 x_i / 4 = (-\\frac{3}{2} - \\frac{1}{2} + \\frac{1}{2} + \\frac{3}{2})/4 = 0/4 = 0$，对 $Y$ 也是如此。没有内部矛盾。\n-   **可行性**：当 $n=4$ 时，总置换数为 $4! = 24$，这个数量小到足以按要求进行穷举枚举。\n\n**步骤3：结论与行动**\n问题陈述是有效的。这是一个在计算统计学和假设检验理论中定义明确且标准的练习。我将继续进行解答。\n\n### 解题推导\n\n**1. 检验统计量与观测值**\n\n检验统计量是样本皮尔逊积矩相关系数 $r$。其公式为：\n$$r = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^n (x_i - \\bar{x})^2} \\sqrt{\\sum_{i=1}^n (y_i - \\bar{y})^2}}$$\n鉴于数据是中心化的，我们有 $\\bar{x} = 0$ 和 $\\bar{y} = 0$。公式简化为：\n$$r = \\frac{\\sum_{i=1}^n x_i y_i}{\\sqrt{\\sum_{i=1}^n x_i^2} \\sqrt{\\sum_{i=1}^n y_i^2}}$$\n对于观测样本，我们已知对所有 $i$ 都有 $y_i = x_i$。我们将观测到的相关系数称为 $r_{\\text{obs}}$。\n$$r_{\\text{obs}} = \\frac{\\sum_{i=1}^n x_i^2}{\\sqrt{\\sum_{i=1}^n x_i^2} \\sqrt{\\sum_{i=1}^n x_i^2}} = \\frac{\\sum_{i=1}^n x_i^2}{\\sum_{i=1}^n x_i^2} = 1$$\n这是预料之中的，因为数据完全落在直线 $y=x$ 上。\n为了完整起见，我们计算平方和：\n$$ \\sum_{i=1}^4 x_i^2 = \\left(-\\frac{3}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{3}{2}\\right)^2 = \\frac{9}{4} + \\frac{1}{4} + \\frac{1}{4} + \\frac{9}{4} = \\frac{20}{4} = 5 $$\n所以，$\\sum x_i^2 = 5$ 且 $\\sum y_i^2 = 5$。观测协方差（分子）是 $\\sum x_i y_i = \\sum x_i^2 = 5$。\n因此，$r_{\\text{obs}} = \\frac{5}{\\sqrt{5}\\sqrt{5}} = 1$。\n\n**2. 置换检验原理**\n\n置换检验用于检验 $X$ 和 $Y$ 之间独立性的原假设。在此原假设下，观测到的 $Y$ 值与观测到的 $X$ 值的任何配对都是等可能的。步骤如下：\n1.  固定 $x_i$ 值的集合：$\\{x_1, x_2, x_3, x_4\\} = \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$。\n2.  考虑 $y_i$ 值的所有可能置换：$\\{y_1, y_2, y_3, y_4\\} = \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$。共有 $n! = 4! = 24$ 种置换。\n3.  对于索引 $\\{1, 2, 3, 4\\}$ 的每一种置换 $\\pi$，创建一个新的数据集 $(x_i, y_{\\pi(i)})$ 并计算相关系数，记为 $r^*$。\n4.  这24个 $r^*$ 值的集合构成了在 $H_0$ 下检验统计量的精确随机化分布。\n\n**3. P值计算**\n\n双侧p值是在原假设分布下，观测到与观测值一样极端或更极端的检验统计量的概率。\n$$ p = \\Pr_{\\text{perm}}(|r^*| \\ge |r_{\\text{obs}}|) $$\n由于 $r_{\\text{obs}} = 1$，我们有：\n$$ p = \\Pr_{\\text{perm}}(|r^*| \\ge 1) $$\n根据柯西-施瓦茨不等式，皮尔逊相关系数 $r$ 总是在区间 $[-1, 1]$ 内。因此，对于所有置换，都有 $|r^*| \\le 1$。条件 $|r^*| \\ge 1$ 简化为 $|r^*| = 1$，这意味着 $r^*=1$ 或 $r^*=-1$。\n\np值是 $|r^*|=1$ 的置换所占的比例：\n$$ p = \\frac{\\text{导致 } |r^*|=1 \\text{ 的置换数}}{\\text{总置换数}} $$\n我们需要计算有多少置换能得到 $r^*=1$ 或 $r^*=-1$。对于所有置换，$r^*$ 的分母是恒定的：$\\sqrt{\\sum x_i^2}\\sqrt{\\sum y_i^2} = \\sqrt{5}\\sqrt{5}=5$。所以我们寻找的是那些使分子 $\\sum x_i y_{\\pi(i)}$ 等于 $5$ 或 $-5$ 的置换。\n\n根据重排不等式，对于两个有序数列 $a_1 \\le a_2 \\le \\dots \\le a_n$ 和 $b_1 \\le b_2 \\le \\dots \\le b_n$，乘积和 $\\sum_{i=1}^n a_i b_{\\pi(i)}$：\n-   当序列以相同顺序配对时（即，$b_{\\pi(i)}$ 的排序与 $a_i$ 相同），总和**最大**。这得到 $\\sum a_i b_i$。\n-   当序列以相反顺序配对时（即，$b_{\\pi(i)}$ 的排序与 $a_i$ 相反），总和**最小**。这得到 $\\sum a_i b_{n-i+1}$。\n\n我们的有序 $x$ 和 $y$ 序列是相同的：$\\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$。\n-   最大和发生在我们配对 $x_i$ 和 $y_i=x_i$ 时。这对应于恒等置换。总和为 $\\sum x_i^2 = 5$。这得到 $r^* = 5/5 = 1$。恰好有 **1** 种这样的置换。\n-   最小和发生在我们配对有序的 $x_i$ 值与逆序的 $y_i$ 值时：$(-\\frac{3}{2}, \\frac{3}{2}), (-\\frac{1}{2}, \\frac{1}{2}), (\\frac{1}{2}, -\\frac{1}{2}), (\\frac{3}{2}, -\\frac{3}{2})$。总和为 $(-\\frac{3}{2})(\\frac{3}{2}) + (-\\frac{1}{2})(\\frac{1}{2}) + (\\frac{1}{2})(-\\frac{1}{2}) + (\\frac{3}{2})(-\\frac{3}{2}) = -\\frac{9}{4} - \\frac{1}{4} - \\frac{1}{4} - \\frac{9}{4} = -\\frac{20}{4} = -5$。这得到 $r^* = -5/5 = -1$。恰好有 **1** 种这样的置换。\n\n没有其他置换能达到这些极值。因此，在24种置换中，恰好有2种导致 $|r^*|=1$。\n精确的双侧p值为：\n$$p = \\frac{2}{24} = \\frac{1}{12} \\approx 0.0833$$\n\n### 选项评估\n\n**A. 在 $X$ 和 $Y$ 独立...的原假设 $H_0$ 下...一个有效的算法是固定 $\\{x_i\\}_{i=1}^n$，重复抽取 $\\{1,\\dots,n\\}$ 的一个随机置换 $\\pi$，形成置换后的响应 $y_i^{\\ast}=y_{\\pi(i)}$，重新计算检验统计量 $r^{\\ast}$...双侧p值为 $p=\\Pr_{\\text{perm}}\\left(|r^{\\ast}|\\ge |r_{\\text{obs}}|\\right)$...对于给定的样本，$n=4$ 且 $r_{\\text{obs}}=1$，在 $4!=24$ 次置换中，恰好有 $2$ 次置换满足 $|r^{\\ast}|\\ge 1$（恒等置换和完全逆序置换），所以精确的双侧p值为 $p=2/24\\approx 0.0833$。**\n-   此选项正确地描述了独立性置换检验的逻辑。\n-   它正确地定义了随机化检验的双侧p值。\n-   它正确地识别出只有2种置换（完全一致和完全不一致）能得到 $|r^*|=1$。\n-   它正确地计算出精确p值为 $2/24 \\approx 0.0833$。\n-   **结论：正确。**\n\n**B. 在 $H_0:\\rho=0$ 下，正确的随机化方法是联合地置换配对观测值 $(x_i,y_i)$（即打乱行），并每次重新计算 $r$...双侧p值为 $p=\\Pr_{\\text{perm}}\\left(|r^{\\ast}| |r_{\\text{obs}}|\\right)$，对于给定的样本，它等于 $p=1$，因为对于每一次置换，$r^{\\ast}=r_{\\text{obs}}$。**\n-   这描述了一个错误的随机化程序。打乱数据对 $(x_i, y_i)$ 并不能打破每对数据中 $X$ 和 $Y$ 之间的关联。样本相关系数对数据对的顺序不敏感，所以 $r^*$ 将永远等于 $r_{\\text{obs}}$。这样的程序无法检验无关联的原假设。\n-   使用严格不等式定义p值对于离散检验统计量来说是非标准的，并且在这里存在问题。\n-   **结论：错误。**\n\n**C. 在 $H_0:\\rho=0$ 下，一个有效的随机化方法是保持标签固定，并以1/2的概率独立地将每个 $y_i$ 乘以 $\\pm 1$ ... 精确的双侧p值为 $p=(2-1)/24\\approx 0.0417$ ...**\n-   所提议的随机化方法（随机符号翻转）是一个有效的随机化检验，但针对的是不同的假设，通常与对称性有关。它不是问题所要求的用于独立性检验的标准置换检验。\n-   该程序的可能结果数量是 $2^n = 2^4 = 16$，而不是 $n!=24$。因此，p值计算中的分母与所提出的程序不一致。\n-   分子 `(2-1)` 和最终结果值是任意的，并且不是从任何与此问题相关的有效统计原理推导出来的。\n-   **结论：错误。**\n\n**D. 在 $H_0:\\rho=0$ 下，置换方法是不必要的；应该使用大样本正态近似...对于给定的样本，$r_{\\text{obs}}=1$ 且 $n=4$，渐近双侧p值实际上为 $0$ ...**\n-   这种方法根本上是错误的。对于 $n=4$，大样本近似是无效的。问题明确要求使用置换检验，这是一种精确检验，并且在满足其假设的情况下，是适用于小样本的恰当方法。\n-   声称渐近结果对于小样本是“精确的”是矛盾且错误的。\n-   对于 $r_{\\text{obs}}=1$，标准的渐近检验统计量 $t = r\\sqrt{(n-2)/(1-r^2)}$ 是未定义的。虽然当 $r \\to 1$ 时极限意味着p值为0，但这忽略了离散性和有限样本空间，而置换检验正确地处理了这些问题。在 $H_0$ 下偶然观测到 $r=1$ 的真实概率是非零的（$1/12$）。\n-   **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "4825062"}]}