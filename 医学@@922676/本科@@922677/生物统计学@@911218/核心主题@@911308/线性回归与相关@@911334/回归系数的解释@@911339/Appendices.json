{"hands_on_practices": [{"introduction": "掌握回归系数的解释是理解变量之间关系的关键第一步。这个练习提供了一个简单线性回归的基本场景，旨在帮助你练习如何精确解释斜率和截距的含义，并将这些解释应用于一个具体的计算中，从而将抽象的统计概念与实际的量化预测联系起来。", "problem": "一项针对成年门诊患者的队列研究调查了每日钠摄入量与收缩压之间的关系，其中结果变量是以毫米汞柱（mm Hg）为单位测量的收缩压，暴露变量是以克为单位测量的每日钠摄入量。假设总体机制满足经典简单线性回归的条件，即给定钠摄入量下收缩压的条件均值与摄入量成线性关系，并且给定摄入量下残差的均值为零。对收缩压关于钠摄入量进行简单线性回归，得到的拟合系数为 $\\hat{\\beta}_{0}=110$ 和 $\\hat{\\beta}_{1}=2.5$。该队列中观察到的每日钠摄入量范围在 $1$ 到 $6$ 克之间。\n\n基于条件期望和线性回归模型的基本定义，请就指定摄入量下的预期收缩压，对截距 $\\hat{\\beta}_{0}$ 和斜率 $\\hat{\\beta}_{1}$ 给出精确的解释。然后，仅使用这些定义，推导出钠摄入量分别为 $x_{1}=2$ 克和 $x_{2}=5$ 克的个体之间平均收缩压的预期差异的表达式，并计算其数值。以毫米汞柱（mm Hg）为单位表示最终的预期差异。不要四舍五入；报告精确值。", "solution": "我们从经典假设下简单线性回归模型的核心定义开始：存在一个表示形式\n$$\nY=\\beta_{0}+\\beta_{1}X+\\varepsilon,\n$$\n其中 $Y$ 是收缩压，$X$ 是每日钠摄入量，误差项 $\\varepsilon$ 满足 $\\mathbb{E}[\\varepsilon \\mid X]=0$ 且方差有限。由此，可得出条件期望的基本性质：\n$$\n\\mathbb{E}[Y \\mid X=x]=\\beta_{0}+\\beta_{1}x.\n$$\n该模型下系数的解释基于条件均值函数。\n\n截距 $\\hat{\\beta}_{0}$ 的解释：截距对应于当 $X=0$ 时 $Y$ 的期望值。具体来说，为了解释，用其估计量替换总体参数，\n$$\n\\widehat{\\mathbb{E}}[Y \\mid X=0]=\\hat{\\beta}_{0}.\n$$\n因此，$\\hat{\\beta}_{0}=110$ 被解释为每日钠摄入量为 $0$ 克的个体的估计平均收缩压（单位：毫米汞柱），同时需要认识到 $0$ 克超出了观察范围，因此这种解释涉及外推。\n\n斜率 $\\hat{\\beta}_{1}$ 的解释：斜率是 $X$ 每增加一个单位时，$Y$ 的条件均值的边际变化。形式上，对于任何 $x$ 和增量 $\\Delta$，\n$$\n\\mathbb{E}[Y \\mid X=x+\\Delta]-\\mathbb{E}[Y \\mid X=x]=\\beta_{1}\\Delta.\n$$\n使用估计量，$\\hat{\\beta}_{1}=2.5$ 被解释为在模型中保持其他所有条件不变的情况下，每日钠摄入量每增加一克，平均收缩压估计会增加 $2.5$ 毫米汞柱。\n\n为了计算钠摄入量为 $x_{2}=5$ 克和 $x_{1}=2$ 克的个体之间平均收缩压的预期差异，我们利用条件均值的线性性质：\n$$\n\\Delta_{5-2}=\\widehat{\\mathbb{E}}[Y \\mid X=5]-\\widehat{\\mathbb{E}}[Y \\mid X=2] = \\left(\\hat{\\beta}_{0}+\\hat{\\beta}_{1}\\cdot 5\\right)-\\left(\\hat{\\beta}_{0}+\\hat{\\beta}_{1}\\cdot 2\\right).\n$$\n截距 $\\hat{\\beta}_{0}$ 被抵消，得到\n$$\n\\Delta_{5-2}=\\hat{\\beta}_{1}(5-2).\n$$\n代入 $\\hat{\\beta}_{1}=2.5$，\n$$\n\\Delta_{5-2}=2.5 \\times 3=7.5.\n$$\n因此，每日摄入 $5$ 克钠与摄入 $2$ 克钠的个体之间，平均收缩压的预期差异为 $7.5$ 毫米汞柱。该计算仅依赖于将斜率解释为暴露量每单位变化引起的条件均值变化，并且不需要超出观察范围的外推，因为 $2$ 克和 $5$ 克都在观察到的摄入量范围内。", "answer": "$$\\boxed{7.5}$$", "id": "4804683"}, {"introduction": "在现实世界的数据分析中，我们很少只处理两个变量之间的简单关系。这个练习引入了“混杂”这一关键概念，它展示了当忽略一个与自变量和因变量都相关的第三个变量（混杂变量）时，我们对主要效应的估计会如何产生偏差。通过计算未校正和校正后的斜率差异，你将亲身体会到在多元回归中控制混杂因素的重要性。[@problem_id:4804683]", "problem": "考虑一项针对无心血管病史成年人的大型观察性队列研究，旨在估计每日钠摄入量与收缩压之间的关联。令 $Y$ 表示以毫米汞柱（$\\text{mm Hg}$）为单位的收缩压，令 $X$ 表示以克（$\\text{grams}$）为单位的每日钠摄入量，令 $Z$ 表示以年（$\\text{years}$）为单位的年龄。假设以下总体水平的数据生成过程和联合分布成立：结果变量服从线性结构模型 $Y=\\beta_{0}+\\beta_{X}X+\\beta_{Z}Z+\\varepsilon$，其中 $\\mathbb{E}[\\varepsilon\\mid X,Z]=0$，并且 $(X,Z)$ 服从二元正态分布，其均值分别为 $\\mu_{X}=3.5$ 和 $\\mu_{Z}=55$，标准差分别为 $\\sigma_{X}=1.2$ 和 $\\sigma_{Z}=12$，相关系数为 $\\rho_{XZ}=0.25$。假设真实的调整后关联为 $\\beta_{X}=0.3$（可解释为每克钠对应 $0.3 \\text{ mm Hg}$）和 $\\beta_{Z}=0.2$（可解释为每岁年龄对应 $0.2 \\text{ mm Hg}$）。假设该研究的样本量足够大，因此仅对 $X$ 进行的 $Y$ 的简单线性回归和对 $(X,Z)$ 进行的 $Y$ 的多元线性回归能够一致地估计它们各自的总体斜率。\n\n计算 $Y$ 对 $X$ 的未调整总体斜率（来自 $Y$ 对 $X$ 的简单回归）与 $Y$ 对 $X$ 的调整后总体斜率（来自 $Y$ 对 $(X,Z)$ 的多元回归）之间的数值差异 $\\Delta$。以每克钠对应的毫米汞柱（$\\text{mm Hg}$ per $\\text{gram}$ of sodium）为单位表示您的最终答案。无需四舍五入。用一句话，从年龄在此医学背景下的混杂效应角度解释 $\\Delta$ 的符号，但最终答案只需提供数值。", "solution": "该问题要求计算收缩压（$Y$）对钠摄入量（$X$）的未调整总体斜率与控制了年龄（$Z$）的相应调整后总体斜率之间的数值差异 $\\Delta$。\n\n真实的数据生成过程由以下多元线性回归模型给出：\n$$Y = \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\varepsilon$$\n其中 $\\mathbb{E}[\\varepsilon \\mid X, Z] = 0$。在此模型中，系数 $\\beta_X$ 代表控制了 $Z$ 后，$Y$ 对 $X$ 的调整后总体斜率。问题陈述该值为 $\\beta_X = 0.3$。因此，我们有：\n$$\\beta_{YX}^{\\text{adj}} = \\beta_X = 0.3$$\n\n$Y$ 对 $X$ 的未调整总体斜率，记作 $\\beta_{YX}^{\\text{unadj}}$，是仅对 $X$ 进行的 $Y$ 的简单线性回归的系数。该总体斜率的公式由 $X$ 和 $Y$ 的协方差与 $X$ 的方差之比给出：\n$$\\beta_{YX}^{\\text{unadj}} = \\frac{\\text{Cov}(X, Y)}{\\text{Var}(X)}$$\n\n为了计算 $\\text{Cov}(X, Y)$，我们使用 $Y$ 的真实结构方程：\n$$\\text{Cov}(X, Y) = \\text{Cov}(X, \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\varepsilon)$$\n利用协方差的性质，上式可展开为：\n$$\\text{Cov}(X, Y) = \\text{Cov}(X, \\beta_{0}) + \\text{Cov}(X, \\beta_{X}X) + \\text{Cov}(X, \\beta_{Z}Z) + \\text{Cov}(X, \\varepsilon)$$\n$$\\text{Cov}(X, Y) = 0 + \\beta_{X}\\text{Cov}(X, X) + \\beta_{Z}\\text{Cov}(X, Z) + \\text{Cov}(X, \\varepsilon)$$\n因为 $\\text{Cov}(X, X) = \\text{Var}(X)$，且条件 $\\mathbb{E}[\\varepsilon \\mid X, Z] = 0$ 意味着 $\\varepsilon$ 与 $X$ 和 $Z$ 的任何函数（包括 $X$ 本身）都不相关，所以我们有 $\\text{Cov}(X, \\varepsilon) = 0$。表达式简化为：\n$$\\text{Cov}(X, Y) = \\beta_{X}\\text{Var}(X) + \\beta_{Z}\\text{Cov}(X, Z)$$\n\n现在我们将此表达式代回未调整斜率的公式中：\n$$\\beta_{YX}^{\\text{unadj}} = \\frac{\\beta_{X}\\text{Var}(X) + \\beta_{Z}\\text{Cov}(X, Z)}{\\text{Var}(X)} = \\beta_{X} + \\beta_{Z} \\frac{\\text{Cov}(X, Z)}{\\text{Var}(X)}$$\n项 $\\frac{\\text{Cov}(X, Z)}{\\text{Var}(X)}$ 是被遗漏变量 $Z$ 对被包含变量 $X$ 的简单线性回归的总体斜率。我们将其记作 $\\beta_{ZX}$。因此：\n$$\\beta_{YX}^{\\text{unadj}} = \\beta_{X} + \\beta_{Z}\\beta_{ZX}$$\n\n问题要求计算差异 $\\Delta = \\beta_{YX}^{\\text{unadj}} - \\beta_{YX}^{\\text{adj}}$。代入上述表达式：\n$$\\Delta = (\\beta_{X} + \\beta_{Z}\\beta_{ZX}) - \\beta_{X} = \\beta_{Z}\\beta_{ZX}$$\n这是众所周知的遗漏变量偏误公式。该偏误是被遗漏变量（$Z$）对结果变量（$Y$）的影响（即 $\\beta_Z$）与被遗漏变量（$Z$）和被包含变量（$X$）之间的关联（即 $\\beta_{ZX}$）的乘积。\n\n我们需要计算 $\\beta_{ZX} = \\frac{\\text{Cov}(X, Z)}{\\text{Var}(X)}$。我们已知相关系数 $\\rho_{XZ}$ 以及标准差 $\\sigma_X$ 和 $\\sigma_Z$。协方差可以表示为 $\\text{Cov}(X, Z) = \\rho_{XZ}\\sigma_X\\sigma_Z$。方差为 $\\text{Var(X)} = \\sigma_X^2$。\n因此，斜率 $\\beta_{ZX}$ 为：\n$$\\beta_{ZX} = \\frac{\\rho_{XZ}\\sigma_X\\sigma_Z}{\\sigma_X^2} = \\rho_{XZ}\\frac{\\sigma_Z}{\\sigma_X}$$\n\n现在我们可以计算 $\\Delta$ 的值：\n$$\\Delta = \\beta_{Z} \\left( \\rho_{XZ}\\frac{\\sigma_Z}{\\sigma_X} \\right)$$\n问题提供了以下数值：\n$\\beta_Z = 0.2$\n$\\rho_{XZ} = 0.25$\n$\\sigma_Z = 12$\n$\\sigma_X = 1.2$\n\n将这些值代入 $\\Delta$ 的表达式中：\n$$\\Delta = 0.2 \\times \\left( 0.25 \\times \\frac{12}{1.2} \\right)$$\n$$\\Delta = 0.2 \\times (0.25 \\times 10)$$\n$$\\Delta = 0.2 \\times 2.5$$\n$$\\Delta = 0.5$$\n\n数值差异为 $0.5 \\, \\text{mm Hg per gram of sodium}$。$\\Delta$ 的正号表示正向混杂，即未调整的关联高估了钠对血压的真实影响，因为混杂因素（年龄）与钠摄入量（$\\rho_{XZ} > 0$）和血压（$\\beta_Z > 0$）都呈正相关。", "answer": "$$\\boxed{0.5}$$", "id": "4804684"}, {"introduction": "除了混杂之外，变量之间的关系还可能更加复杂，其中一个变量的效应可能会受到另一个变量水平的影响，这种现象称为“交互作用”或“效应修饰”。本练习将指导你如何解释包含交互项的回归模型。你将学习如何计算和解释在不同条件下变化的斜率，这对于在生物统计学和医学研究中得出精确和有意义的结论至关重要。[@problem_id:4804684]", "problem": "一项针对新诊断为2型糖尿病的成年人的纵向队列研究，随时间追踪了每位参与者的糖化血红蛋白A1c (HbA1c)。设 $Y$ 表示HbA1c（单位：百分点），$X$ 表示诊断后时间（单位：月），$Z$ 表示药物依从性（在 $0$–$10$ 的量表上测量，数值越高表示依从性越好）。研究人员使用条件均值模型拟合了一个包含时间与依从性交互作用的线性回归：\n$$\n\\mathbb{E}[Y \\mid X,Z] \\;=\\; \\beta_{0} \\;+\\; \\beta_{1} X \\;+\\; \\beta_{2} Z \\;+\\; \\beta_{3} XZ,\n$$\n其中 $\\beta_{0}$ 是截距，$\\beta_{1}$ 是时间的主效应，$\\beta_{2}$ 是依从性的主效应，$\\beta_{3}$ 捕捉了依从性对时间效应的修饰作用。假设与时间相关的参数的估计系数为 $\\hat{\\beta}_{1} = 0.10$ 和 $\\hat{\\beta}_{3} = -0.02$。\n\n从条件均值模型和变化率作为偏导数的基本定义出发，推导在固定依从性水平 $Z$ 下，HbA1c相对于时间的斜率表达式，然后使用给定的估计值计算当 $Z = 2$ 和 $Z = 8$ 时的斜率。请以 HbA1c百分点/月的单位表示您的最终数值答案，并四舍五入到四位有效数字。", "solution": "该问题已经过验证，被认为是生物统计学领域内一个适定、有科学依据且客观的问题。它为得出唯一且有意义的解提供了所有必要的信息和条件。\n\n该问题要求在给定一个线性回归的条件均值模型的情况下，推导糖化血红蛋白A1c (HbA1c) 相对于时间的变化率（斜率）。这个变化率在数学上等同于结果变量 $Y$ 的条件期望对时间变量 $X$ 的偏导数。\n\n给定的条件均值模型是：\n$$\n\\mathbb{E}[Y \\mid X,Z] = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ\n$$\n其中 $Y$ 是HbA1c（百分点），$X$ 是时间（月），$Z$ 是药物依从性（0到10的量表）。系数 $\\beta_{0}$、$\\beta_{1}$、$\\beta_{2}$ 和 $\\beta_{3}$ 是模型的参数。\n\n在固定的依从性水平 $Z$ 下，HbA1c相对于时间的斜率是条件均值 $\\mathbb{E}[Y \\mid X,Z]$ 对 $X$ 的偏导数。它衡量了在保持依从性不变的情况下，时间每增加一个单位，平均HbA1c预期的变化量。\n$$\n\\text{时间相关的斜率} = \\frac{\\partial}{\\partial X} \\mathbb{E}[Y \\mid X,Z]\n$$\n我们对模型的每一项应用偏导数算子，由于求导是相对于 $X$ 并保持 $Z$ 固定，因此将 $Z$ 视为常数。\n$$\n\\frac{\\partial}{\\partial X} (\\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ) = \\frac{\\partial}{\\partial X}(\\beta_{0}) + \\frac{\\partial}{\\partial X}(\\beta_{1} X) + \\frac{\\partial}{\\partial X}(\\beta_{2} Z) + \\frac{\\partial}{\\partial X}(\\beta_{3} XZ)\n$$\n各项的导数分别为：\n1.  截距 $\\beta_{0}$ 相对于 $X$ 的导数是 $0$，因为 $\\beta_{0}$ 是一个常数。\n2.  $\\beta_{1} X$ 相对于 $X$ 的导数是 $\\beta_{1}$。\n3.  $\\beta_{2} Z$ 相对于 $X$ 的导数是 $0$，因为在此情境下 $\\beta_{2}$ 和 $Z$ 都被视为常数。\n4.  $\\beta_{3} XZ$ 相对于 $X$ 的导数是 $\\beta_{3} Z$，因为 $\\beta_{3} Z$ 是 $X$ 的常数系数。\n\n将这些结果相加，得到斜率的一般表达式：\n$$\n\\frac{\\partial}{\\partial X} \\mathbb{E}[Y \\mid X,Z] = 0 + \\beta_{1} + 0 + \\beta_{3} Z = \\beta_{1} + \\beta_{3} Z\n$$\n这个推导出的表达式表明，时间对平均HbA1c的影响不是恒定的；相反，它是药物依从性水平 $Z$ 的一个线性函数。这就是交互项 $\\beta_{3} XZ$ 的意义。\n\n问题提供了相关系数的估计值：$\\hat{\\beta}_{1} = 0.10$ 和 $\\hat{\\beta}_{3} = -0.02$。我们将这些估计值代入我们推导出的斜率表达式中，得到估计斜率，记为 $\\widehat{\\text{Slope}}(Z)$：\n$$\n\\widehat{\\text{Slope}}(Z) = \\hat{\\beta}_{1} + \\hat{\\beta}_{3} Z = 0.10 + (-0.02) Z = 0.10 - 0.02 Z\n$$\n这个斜率的单位是 $Y$ 的单位每单位 $X$，即 HbA1c百分点/月。\n\n我们需要计算在两个特定的依从性水平下的斜率：$Z=2$ 和 $Z=8$。\n\n对于依从性水平 $Z = 2$：\n$$\n\\widehat{\\text{Slope}}(Z=2) = 0.10 - 0.02 \\times 2 = 0.10 - 0.04 = 0.06\n$$\n这意味着，对于依从性评分为2的患者，估计的平均HbA1c每月增加0.06个百分点。\n\n对于依从性水平 $Z = 8$：\n$$\n\\widehat{\\text{Slope}}(Z=8) = 0.10 - 0.02 \\times 8 = 0.10 - 0.16 = -0.06\n$$\n这意味着，对于依从性评分为8的患者，估计的平均HbA1c每月减少0.06个百分点。\n\n问题要求最终的数值答案四舍五入到四位有效数字。\n- 对于 $Z=2$ 的值为 $0.06$。保留四位有效数字，写作 $0.06000$。\n- 对于 $Z=8$ 的值为 $-0.06$。保留四位有效数字，写作 $-0.06000$。\n\n最终答案分别是 $Z=2$ 和 $Z=8$ 时计算出的斜率。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06000  -0.06000\n\\end{pmatrix}\n}\n$$", "id": "4804658"}]}