{"hands_on_practices": [{"introduction": "在深入探讨复杂解释之前，我们必须首先掌握决定系数 $R^2$ 的基本含义。这个练习旨在阐明一个核心概念：在简单的双变量关系中，$R^2$ 是衡量线性关联强度的对称指标。通过这个思想实验 [@problem_id:1955424]，您将发现，无论您将哪个变量作为预测变量，哪个作为响应变量，$R^2$ 的值都保持不变，这揭示了它与相关系数的内在联系。", "problem": "一位材料科学家正在研究一种新型聚合物粘合剂的特性。对于一批 $n$ 个样品，测量了两个变量：固化时间 $T$（小时）和最终的剪切强度 $S$（兆帕，MPa）。假设在这些样品中，测得的固化时间和剪切强度都存在一定的变异，因此它们的样本方差非零。\n\n对该数据集进行了两种不同的分析。\n\n分析 1：拟合一个简单线性回归模型，使用固化时间 ($T$) 作为预测变量来预测剪切强度 ($S$)。模型形式为 $S = \\beta_0 + \\beta_1 T + \\epsilon$。该模型的决定系数被计算并记为 $R^2_{S|T}$。\n\n分析 2：对同一数据集拟合第二个简单线性回归模型，但这次是使用剪切强度 ($S$) 作为预测变量来预测固化时间 ($T$)。模型形式为 $T = \\gamma_0 + \\gamma_1 S + \\delta$。该第二个模型的决定系数被计算并记为 $R^2_{T|S}$。\n\n分析 1 中的 $R^2_{S|T}$ 值与分析 2 中的 $R^2_{T|S}$ 值相比如何？\n\nA. $R^2_{S|T}$ 总是大于 $R^2_{T|S}$。\n\nB. $R^2_{S|T}$ 总是小于 $R^2_{T|S}$。\n\nC. $R^2_{S|T}$ 总是等于 $R^2_{T|S}$。\n\nD. 该关系取决于数据集中的具体数值，无法一概而论。\n\nE. 该关系取决于变量 $T$ 或 $S$ 哪个具有更大的样本方差。", "solution": "设 $(T_{i},S_{i})$（$i=1,\\dots,n$）表示观测对，并假设 $\\sum_{i=1}^{n}(T_{i}-\\bar T)^{2}>0$ 和 $\\sum_{i=1}^{n}(S_{i}-\\bar S)^{2}>0$。定义中心化和\n$$\nS_{TT}=\\sum_{i=1}^{n}(T_{i}-\\bar T)^{2},\\quad\nS_{SS}=\\sum_{i=1}^{n}(S_{i}-\\bar S)^{2},\\quad\nS_{ST}=\\sum_{i=1}^{n}(S_{i}-\\bar S)(T_{i}-\\bar T).\n$$\n同时定义样本相关系数\n$$\nr_{ST}=\\frac{S_{ST}}{\\sqrt{S_{SS}S_{TT}}}.\n$$\n\n分析 1（$S$ 对 $T$ 进行回归）：普通最小二乘斜率为\n$$\n\\hat{\\beta}_{1}=\\frac{S_{ST}}{S_{TT}},\n$$\n拟合值为 $\\hat S_{i}=\\bar S+\\hat{\\beta}_{1}(T_{i}-\\bar T)$。可解释平方和为\n$$\n\\mathrm{SSR}_{S|T}=\\sum_{i=1}^{n}(\\hat S_{i}-\\bar S)^{2}\n=\\hat{\\beta}_{1}^{2}\\sum_{i=1}^{n}(T_{i}-\\bar T)^{2}\n=\\hat{\\beta}_{1}^{2}S_{TT}.\n$$\n总平方和为 $\\mathrm{SST}_{S}=S_{SS}$。因此\n$$\nR^{2}_{S|T}=\\frac{\\mathrm{SSR}_{S|T}}{\\mathrm{SST}_{S}}\n=\\frac{\\hat{\\beta}_{1}^{2}S_{TT}}{S_{SS}}\n=\\frac{\\left(\\frac{S_{ST}}{S_{TT}}\\right)^{2}S_{TT}}{S_{SS}}\n=\\frac{S_{ST}^{2}}{S_{SS}S_{TT}}\n=r_{ST}^{2}.\n$$\n\n分析 2（$T$ 对 $S$ 进行回归）：斜率为\n$$\n\\hat{\\gamma}_{1}=\\frac{S_{ST}}{S_{SS}},\n$$\n可解释平方和为\n$$\n\\mathrm{SSR}_{T|S}=\\hat{\\gamma}_{1}^{2}S_{SS}.\n$$\n$T$ 的总平方和为 $\\mathrm{SST}_{T}=S_{TT}$。因此\n$$\nR^{2}_{T|S}=\\frac{\\mathrm{SSR}_{T|S}}{\\mathrm{SST}_{T}}\n=\\frac{\\hat{\\gamma}_{1}^{2}S_{SS}}{S_{TT}}\n=\\frac{\\left(\\frac{S_{ST}}{S_{SS}}\\right)^{2}S_{SS}}{S_{TT}}\n=\\frac{S_{ST}^{2}}{S_{SS}S_{TT}}\n=r_{ST}^{2}.\n$$\n\n因此，两个 $R^{2}$ 值都等于 $S$ 和 $T$ 之间的样本相关系数的平方，前提是两个变量的样本方差都非零且模型包含截距项。所以\n$$\nR^{2}_{S|T}=R^{2}_{T|S}.\n$$\n这个等式不依赖于哪个变量的方差更大，也不依赖于除了方差非零条件之外的数据集具体值。", "answer": "$$\\boxed{C}$$", "id": "1955424"}, {"introduction": "虽然 $R^2$ 是一个方便的汇总统计量，但单独依赖它可能具有误导性。这个练习 [@problem_id:1455423] 提出了一个经典的场景：一个看似完美的 $R^2$ 值掩盖了模型的根本缺陷。它强调了残差分析在验证模型假定（如线性关系）方面的不可或缺的作用，并教导我们一个重要教训：高 $R^2$ 值本身并不能保证所选模型是描述数据内在关系的正确选择。", "problem": "一名本科生正在开发一种用于检测水中亚硝酸盐 ($NO_2^−$) 的新型分析方法。该方法涉及一个产生有色化合物的化学反应，学生使用智能手机摄像头来量化颜色强度。为了建立校准曲线，该学生配制了一系列已知亚硝酸盐浓度的标准溶液，并测量了相应的信号强度。收集到的数据如下：\n\n-   标准浓度 ($C$，单位 $\\mu M$)：1.0, 5.0, 10.0, 15.0, 20.0\n-   测量信号 ($S$，任意单位)：7.0, 14.5, 23.0, 30.5, 37.0\n\n对这些数据进行线性回归分析，得到最佳拟合直线方程 $S = (1.57 \\times C) + 5.61$，决定系数 $R^2 = 0.9996$。\n\n尽管非常高的 $R^2$ 值表明线性拟合效果极佳，但该学生决定通过绘制残差图来更仔细地检查数据。残差的计算方式为（测量信号 - 预测信号）。该学生观察到残差中存在一个明显的、非随机的模式：在最低和最高浓度处，残差略为负值，但在中间浓度处则明显为正值。\n\n根据所有提供的信息，以下哪个陈述是关于该分析方法的最准确结论？\n\nA. 高 $R^2$ 值证实了线性模型对于预测未知浓度是适当且准确的。观察到的残差模式很可能是由随机实验误差引起的。\n\nB. 仪器存在恒定的系统误差，例如空白样品制备不当，这是导致非零残差的原因。\n\nC. 残差的模式表明，浓度和信号之间的真实关系是非线性的。线性模型对于该系统是一个糟糕的选择，应该被舍弃。\n\nD. 残差中的系统性模式表明，虽然关系具有强线性，但并非完全线性。线性模型可能不是最准确的模型，一个非线性模型（例如，二次模型）可能会提供更好的拟合度和更准确的结果。\n\nE. 学生很可能在制备具有最大残差的标准溶液时犯了一个重大错误，这个单点扭曲了一个本应是完美的线性关系。", "solution": "设线性校准模型为 $S_{\\text{pred}}(C) = mC + b$，其中 $m = 1.57$ 和 $b = 5.61$，这是从回归分析中得到的，其 $R^{2} = 0.9996$。将浓度 $C$ 处的残差定义为\n$$\nr(C) = S_{\\text{meas}}(C) - S_{\\text{pred}}(C).\n$$\n观察到的残差模式是，在最低和最高的 $C$ 值处 $r(C)  0$，而在中间的 $C$ 值处 $r(C) > 0$。这样一个系统性的、非随机的模式意味着模型设定错误，而不是随机误差。具体来说，符号的变化表明存在曲率：数据点在两端位于拟合线下方，在中间位于拟合线上方，这与一个下凹关系一致。一个二次模型，例如 $S(C) = a C^2 + b C + c$（其中 $a  0$），会自然地在中间范围内产生 $S_{\\text{true}}(C) > S_{\\text{lin}}(C)$ 并且在两端产生 $S_{\\text{true}}(C)  S_{\\text{lin}}(C)$，从而消除这种系统性的残差模式。\n\n一个恒定的系统误差（例如，不正确的空白样）会产生近似恒定的残差 $r(C) \\approx \\Delta b$，并且在所有 $C$ 值上符号相同，这与观察到的情况不符。单一的严重制备误差会产生一个大的离群残差，而不是一个跨越多个数据点的、平滑且依赖于浓度的模式。最后，仅凭一个高的 $R^{2}$ 值并不能验证函数形式的正确性；在一个有限的范围内，即使存在曲率，$R^{2}$ 值也可能保持很高，而残差分析是诊断这种非线性的恰当方法。\n\n因此，最准确的结论是，该关系具有强线性但并非完全线性，而一个非线性模型（例如二次模型）很可能会改善拟合度和预测准确性。", "answer": "$$\\boxed{D}$$", "id": "1455423"}, {"introduction": "当我们从简单线性回归过渡到多元线性回归时，一个新的挑战出现了：每增加一个预测变量，即使它与响应变量无关，$R^2$ 值几乎总会增加。这种现象可能导致我们构建出过于复杂的“过拟合”模型。这个练习 [@problem_id:4795902] 引入了调整后决定系数（Adjusted $R^2$）作为解决方案，它通过对模型中的变量数量进行惩罚，为我们提供了一个更公允的模型解释力评估，这在构建实用且可靠的统计模型时至关重要。", "problem": "一个临床研究团队使用普通最小二乘法（OLS）拟合了一个多元线性回归模型，以一个包含 $n=60$ 名成年患者的队列中常规收集的预测变量为基础，对基线对数转换后的C反应蛋白进行建模。该模型包含一个截距项和 $p=10$ 个解释变量（不包括截距项）。报告的决定系数为 $R^{2}=0.35$。本着统计推断和循证医学的精神，研究人员希望以一种能考虑到由多个预测变量引起的有限样本偏差的方式来量化模型的拟合度。\n\n请仅从OLS回归的方差分析分解和基于自由度的经典无偏方差估计量出发，推导调整后决定系数的表达式（用 $n$、$p$ 和 $R^{2}$ 表示）。然后，使用 $n=60$、$p=10$ 和 $R^{2}=0.35$ 计算调整后的决定系数。将您的数值答案四舍五入到四位有效数字，并以小数形式表示。最后，评估自由度惩罚是否在此医学背景下显著改变了对模型拟合度的解释，重点关注变化的幅度是否可能影响关于解释强度的结论。", "solution": "**第一部分：调整后决定系数（$R_{adj}^2$）的推导**\n\n推导始于普通最小二乘法（OLS）线性回归模型的方差分析（ANOVA）分解。响应变量的总变异被分解为模型解释的变异和未解释的（残差）变异。\n\n总平方和（$SST$）衡量因变量 $y$ 的总方差。其定义为 $SST = \\sum_{i=1}^{n} (y_i - \\bar{y})^2$，其中 $n$ 是样本量，$\\bar{y}$ 是 $y$ 的样本均值。\n\n回归平方和（$SSR$）衡量因变量中由回归模型解释的方差量。其定义为 $SSR = \\sum_{i=1}^{n} (\\hat{y}_i - \\bar{y})^2$，其中 $\\hat{y}_i$ 是模型的拟合值。\n\n残差平方和（$SSE$），也称为误差平方和，衡量未解释的方差。其定义为 $SSE = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2$。\n\n基本的方差分析恒等式是：\n$$SST = SSR + SSE$$\n\n标准决定系数 $R^2$ 定义为因变量总方差中可由自变量预测的比例。\n$$R^2 = \\frac{SSR}{SST} = 1 - \\frac{SSE}{SST}$$\n$R^2$ 的一个已知问题是，它是总体决定系数的一个有偏估计量。当向模型中添加新的预测变量时，即使它们不相关，$R^2$ 也永远不会减小。这可能导致对模型拟合度的评估过于乐观，这种现象称为过拟合，尤其是在预测变量数量 $p$ 相对于样本量 $n$ 较大时。\n\n调整后决定系数 $R_{adj}^2$ 通过惩罚无关预测变量的引入来纠正这一点。它通过使用方差的无偏估计量来实现。总体总方差 $\\sigma_y^2$ 的无偏估计量是总均方（$MST$），即总平方和除以其自由度 $df_T = n-1$。\n$$MST = \\frac{SST}{n-1}$$\n误差方差 $\\sigma^2$ 的无偏估计量是均方误差（$MSE$），即残差平方和除以其自由度 $df_E = n - k$，其中 $k$ 是模型中估计的系数总数。对于一个有 $p$ 个预测变量和一个截距项的多元线性回归，$k = p+1$。因此，误差自由度为：\n$$df_E = n - (p+1) = n-p-1$$\n因此，均方误差为：\n$$MSE = \\frac{SSE}{n-p-1}$$\n调整后 $R^2$ 的定义与 $R^2$ 类似，但使用的是这些方差的无偏估计量：\n$$R_{adj}^2 = 1 - \\frac{MSE}{MST} = 1 - \\frac{SSE/(n-p-1)}{SST/(n-1)}$$\n为了用原始 $R^2$ 来表示 $R_{adj}^2$，我们可以重新整理这个表达式：\n$$R_{adj}^2 = 1 - \\left(\\frac{SSE}{SST}\\right) \\left(\\frac{n-1}{n-p-1}\\right)$$\n根据 $R^2$ 的定义，我们知道 $\\frac{SSE}{SST} = 1 - R^2$。将此代入 $R_{adj}^2$ 的方程，得到所需的关系：\n$$R_{adj}^2 = 1 - (1 - R^2) \\frac{n-1}{n-p-1}$$\n这个表达式显示了调整后 $R^2$ 是如何通过对 $R^2$ 应用一个惩罚因子 $\\frac{n-1}{n-p-1}$ 推导出来的，对于 $p>0$，该因子总是大于1。这个因子随着 $p$ 的增加或 $n$ 的减小而增大，使得对于预测变量数相对于样本量较多的模型，调整更为严厉。\n\n**第二部分：数值计算**\n\n问题提供了以下值：\n样本量，$n = 60$。\n解释变量数，$p = 10$。\n决定系数，$R^2 = 0.35$。\n\n使用推导出的公式：\n$$R_{adj}^2 = 1 - (1 - R^2) \\frac{n-1}{n-p-1}$$\n将给定值代入表达式：\n$$R_{adj}^2 = 1 - (1 - 0.35) \\frac{60-1}{60-10-1}$$\n$$R_{adj}^2 = 1 - (0.65) \\frac{59}{49}$$\n现在我们计算数值：\n$$R_{adj}^2 = 1 - 0.65 \\times \\left(\\frac{59}{49}\\right) \\approx 1 - 0.65 \\times 1.2040816...$$\n$$R_{adj}^2 \\approx 1 - 0.78265306...$$\n$$R_{adj}^2 \\approx 0.2173469...$$\n按要求将结果四舍五入到四位有效数字，得到：\n$$R_{adj}^2 \\approx 0.2173$$\n\n**第三部分：对解释变化的评估**\n\n原始决定系数 $R^2 = 0.35$ 表明模型解释了基线对数转换后C反应蛋白35%的方差。在许多医学研究背景下，这将被认为是中等但可能有意义的解释能力水平。\n\n调整后决定系数 $R_{adj}^2 \\approx 0.2173$ 表明，在考虑了模型中相对于样本量所使用的预测变量数量后，估计的方差解释比例仅为约21.7%。\n\n从0.35降至0.2173是一次大幅下降。绝对减少量为 $0.35 - 0.2173 = 0.1327$。相对减少量为 $\\frac{0.1327}{0.35} \\approx 0.379$，与原始 $R^2$ 值相比下降了近38%。\n\n这一变化意义重大，几乎肯定会影响关于模型解释强度的结论。对于一个中等样本量（$n=60$），使用相对较多的预测变量（$p=10$）产生了过拟合的巨大可能性。未经调整的 $R^2$ 因此而被夸大。调整后的 $R^2$ 对模型在样本所属总体上的性能提供了一个更现实（也更发人深省）的评估。\n\n在循证医学领域，这是一个关键的区别。一个解释了35%方差的模型可能被视为开发预测工具的一个有希望的起点。相比之下，一个仅解释了21.7%方差的模型将被认为解释能力有限。这样的结果会削弱研究者的热情，并表明这组预测变量虽然可能在统计上显著，但并不构成一个强大的解释框架。这会促使研究人员去寻找更有影响力的预测变量，考虑简化模型，或者得出结论认为使用现有数据本身就很难预测该结果。在本例中，对模型复杂度的惩罚已将解释从“中等效用”显著地改变为“有限效用”。", "answer": "$$\\boxed{0.2173}$$", "id": "4795902"}]}