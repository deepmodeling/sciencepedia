{"hands_on_practices": [{"introduction": "在生物统计学中，我们常常需要利用一个变量来预测另一个变量的平均值。这个基础练习将指导你完成一个核心任务：在一个简单的线性回归模型中，为平均响应计算置信区间。我们将使用一个常见的临床场景，探索空腹血糖和C反应蛋白之间的关系。更重要的是，我们将研究为什么当我们对远离数据中心点的值进行预测时，置信区间的宽度会增加，这是任何实践者都必须掌握的关键直觉。[@problem_id:4904392]", "problem": "一项临床研究调查了成年人空腹血糖 $x$ (mg/dL) 与高敏C反应蛋白 $y$ (mg/L) 之间的线性关系。假设简单线性模型为 $y_{i}=\\beta_{0}+\\beta_{1}x_{i}+\\varepsilon_{i}$，其中误差 $\\varepsilon_{i}$ 独立同分布于 $\\mathcal{N}(0,\\sigma^{2})$。使用普通最小二乘法 (OLS) 拟合该模型。从 $n$ 名受试者中，已知以下汇总统计量：样本量 $n=20$，样本均值 $\\bar{x}=110$ 和 $\\bar{y}=3.5$，中心化平方和 $S_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}=4300$，交叉离差和 $S_{xy}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y})=215$，以及残差标准误 $\\hat{\\sigma}=0.8$。在模型假设下进行计算，并仅使用这些统计数据。\n\n基于线性模型假设和OLS估计量的抽样行为，运用第一性原理，为在 $x_{0}=130$ 处的平均响应 $\\mu(x_{0})=\\mathbb{E}[Y\\mid X=x_{0}]$ 构建双侧 $95\\%$ 置信区间 (CI)。将置信区间的端点以 mg/L 表示，并将每个端点四舍五入到四位有效数字。\n\n然后，通过推导当 $x_{0}$ 从 $\\bar{x}$ 移动到 $x_{0}=\\bar{x}+20$ 时置信区间半宽度的乘性膨胀因子，分析性地评估将 $x_{0}$ 移离 $\\bar{x}$ 如何影响置信区间的宽度。报告此膨胀因子，四舍五入到四位有效数字。你的最终答案应仅为这一个四舍五入后的数字（无量纲）。", "solution": "### 步骤1：提取给定信息\n问题为简单线性回归模型 $y_{i}=\\beta_{0}+\\beta_{1}x_{i}+\\varepsilon_{i}$ 提供了以下信息，其中 $\\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2})$：\n- 样本量: $n=20$\n- 预测变量的样本均值: $\\bar{x}=110$ mg/dL\n- 响应变量的样本均值: $\\bar{y}=3.5$ mg/L\n- $x$ 的中心化平方和: $S_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}=4300$\n- 交叉离差和: $S_{xy}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y})=215$\n- 残差标准误: $\\hat{\\sigma}=0.8$ mg/L\n- 目标预测变量值: $x_{0}=130$ mg/dL\n- 置信水平: $95\\%$，这意味着显著性水平 $\\alpha=0.05$。\n- 任务是求出在 $x_{0}=130$ 处平均响应 $\\mu(x_{0})$ 的 $95\\%$ 置信区间，然后求出当 $x_{0}$ 从 $\\bar{x}$ 移动到 $x_{0}=\\bar{x}+20$ 时置信区间半宽度的乘性膨胀因子。\n\n### 步骤2：使用提取的信息进行验证\n根据指定标准对问题进行验证。\n\n- **科学依据：**该问题基于带有高斯误差的简单线性回归模型，这是统计学和生物统计学中的一个基本和标准主题。普通最小二乘法 (OLS)、平均响应的置信区间以及区间宽度的分析都是公认的统计学原理。\n- **良构问题：**所有必要的汇总统计量 ($n, \\bar{x}, \\bar{y}, S_{xx}, S_{xy}, \\hat{\\sigma}$) 都已提供，可以执行所需的计算。问题具体明确，能导出一个唯一且有意义的解。\n- **客观性：**问题使用精确、客观和标准的统计术语陈述。没有主观或含糊不清的语言。\n\n问题没有表现出任何诸如科学不健全、信息缺失或逻辑矛盾等缺陷。这是一个在应用统计学中标准的、表述良好的教科书式问题。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供完整的解答。\n\n### 解题推导\n\n问题需要两个部分：为平均响应构建一个置信区间，并分析其宽度。\n\n**第1部分：平均响应 $\\mu(x_0)$ 的置信区间**\n\n在给定值 $x_0$ 处的平均响应是 $\\mu(x_0) = \\mathbb{E}[Y | X=x_0] = \\beta_0 + \\beta_1 x_0$。$\\mu(x_0)$ 的 OLS 点估计量是 $\\hat{\\mu}(x_0) = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_0$。\n\n斜率和截距的 OLS 估计量是：\n$$ \\hat{\\beta}_1 = \\frac{S_{xy}}{S_{xx}} $$\n$$ \\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x} $$\n将 $\\hat{\\beta}_0$ 代入 $\\hat{\\mu}(x_0)$ 的表达式中，得到一个更便于计算的形式：\n$$ \\hat{\\mu}(x_0) = (\\bar{y} - \\hat{\\beta}_1 \\bar{x}) + \\hat{\\beta}_1 x_0 = \\bar{y} + \\hat{\\beta}_1 (x_0 - \\bar{x}) $$\n在模型假设下，枢轴量 $\\frac{\\hat{\\mu}(x_0) - \\mu(x_0)}{\\text{SE}(\\hat{\\mu}(x_0))}$ 的抽样分布服从自由度为 $n-2$ 的 $t$ 分布。平均响应的标准误 $\\text{SE}(\\hat{\\mu}(x_0))$ 是从估计量的方差推导出来的：\n$$ \\text{Var}(\\hat{\\mu}(x_0)) = \\text{Var}(\\bar{y} + \\hat{\\beta}_1(x_0 - \\bar{x})) $$\n由于 OLS 估计量 $\\bar{y}$ 和 $\\hat{\\beta}_1$ 不相关，它们的和的方差是它们方差的和：\n$$ \\text{Var}(\\hat{\\mu}(x_0)) = \\text{Var}(\\bar{y}) + (x_0 - \\bar{x})^2 \\text{Var}(\\hat{\\beta}_1) = \\frac{\\sigma^2}{n} + \\frac{\\sigma^2(x_0 - \\bar{x})^2}{S_{xx}} = \\sigma^2 \\left( \\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{S_{xx}} \\right) $$\n用其无偏估计量，即残差均方 $\\hat{\\sigma}^2$，替换未知方差 $\\sigma^2$，我们得到标准误的平方。标准误为：\n$$ \\text{SE}(\\hat{\\mu}(x_0)) = \\hat{\\sigma} \\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{S_{xx}}} $$\n$\\mu(x_0)$ 的双侧 $(1-\\alpha) \\times 100\\%$ 置信区间为：\n$$ \\hat{\\mu}(x_0) \\pm t_{n-2, \\alpha/2} \\cdot \\text{SE}(\\hat{\\mu}(x_0)) $$\n其中 $t_{n-2, \\alpha/2}$ 是自由度为 $n-2$ 的 $t$ 分布的上 $\\alpha/2$ 临界值。\n\n现在，我们代入给定的值。\n1.  计算 $\\hat{\\beta}_1$：\n    $$ \\hat{\\beta}_1 = \\frac{S_{xy}}{S_{xx}} = \\frac{215}{4300} = 0.05 $$\n2.  计算点估计值 $\\hat{\\mu}(130)$：\n    $$ \\hat{\\mu}(130) = \\bar{y} + \\hat{\\beta}_1 (x_0 - \\bar{x}) = 3.5 + 0.05 (130 - 110) = 3.5 + 0.05(20) = 3.5 + 1.0 = 4.5 $$\n3.  确定临界值。对于 $95\\%$ 的置信区间，$\\alpha=0.05$，所以 $\\alpha/2=0.025$。自由度为 $df = n-2 = 20-2=18$。临界值为 $t_{18, 0.025} = 2.101$。\n4.  计算标准误 $\\text{SE}(\\hat{\\mu}(130))$：\n    $$ \\text{SE}(\\hat{\\mu}(130)) = \\hat{\\sigma} \\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{S_{xx}}} = 0.8 \\sqrt{\\frac{1}{20} + \\frac{(130 - 110)^2}{4300}} $$\n    $$ \\text{SE}(\\hat{\\mu}(130)) = 0.8 \\sqrt{0.05 + \\frac{20^2}{4300}} = 0.8 \\sqrt{0.05 + \\frac{400}{4300}} = 0.8 \\sqrt{0.05 + \\frac{4}{43}} $$\n    $$ \\text{SE}(\\hat{\\mu}(130)) = 0.8 \\sqrt{\\frac{0.05 \\times 43 + 4}{43}} = 0.8 \\sqrt{\\frac{2.15 + 4}{43}} = 0.8 \\sqrt{\\frac{6.15}{43}} \\approx 0.302547 \\text{ mg/L} $$\n5.  计算误差范围 (ME)：\n    $$ \\text{ME} = t_{18, 0.025} \\cdot \\text{SE}(\\hat{\\mu}(130)) = 2.101 \\times 0.302547 \\approx 0.635651 \\text{ mg/L} $$\n6.  构建置信区间：\n    $$ \\text{CI} = \\hat{\\mu}(130) \\pm \\text{ME} = 4.5 \\pm 0.635651 $$\n    下界是 $4.5 - 0.635651 = 3.864349$。四舍五入到四位有效数字，为 $3.864$ mg/L。\n    上界是 $4.5 + 0.635651 = 5.135651$。四舍五入到四位有效数字，为 $5.136$ mg/L。\n    在 $x_0=130$ 处平均响应的 $95\\%$ 置信区间是 $[3.864, 5.136]$ mg/L。\n\n**第2部分：置信区间半宽度的膨胀因子**\n\n置信区间的半宽度是误差范围，我们记为 $W(x_0)$：\n$$ W(x_0) = t_{n-2, \\alpha/2} \\cdot \\hat{\\sigma} \\sqrt{\\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{S_{xx}}} $$\n当 $x_0 = \\bar{x}$ 时，置信区间最窄，因为项 $(x_0 - \\bar{x})^2$ 在零处取得最小值。此时的半宽度为：\n$$ W(\\bar{x}) = t_{n-2, \\alpha/2} \\cdot \\hat{\\sigma} \\sqrt{\\frac{1}{n} + 0} = t_{n-2, \\alpha/2} \\cdot \\frac{\\hat{\\sigma}}{\\sqrt{n}} $$\n我们需要求出当 $x_0$ 从 $\\bar{x}$ 移动到 $x_0=\\bar{x}+20$ 时置信区间半宽度的乘性膨胀因子。这个因子 $F$ 是半宽度之比 $W(\\bar{x}+20) / W(\\bar{x})$。\n\n在 $x_0=\\bar{x}+20$ 处的半宽度是：\n$$ W(\\bar{x}+20) = t_{n-2, \\alpha/2} \\cdot \\hat{\\sigma} \\sqrt{\\frac{1}{n} + \\frac{((\\bar{x}+20) - \\bar{x})^2}{S_{xx}}} = t_{n-2, \\alpha/2} \\cdot \\hat{\\sigma} \\sqrt{\\frac{1}{n} + \\frac{20^2}{S_{xx}}} $$\n膨胀因子 $F$ 是：\n$$ F = \\frac{W(\\bar{x}+20)}{W(\\bar{x})} = \\frac{t_{n-2, \\alpha/2} \\cdot \\hat{\\sigma} \\sqrt{\\frac{1}{n} + \\frac{400}{S_{xx}}}}{t_{n-2, \\alpha/2} \\cdot \\hat{\\sigma} \\sqrt{\\frac{1}{n}}} $$\n公共项 $t_{n-2, \\alpha/2}$ 和 $\\hat{\\sigma}$ 消掉了：\n$$ F = \\frac{\\sqrt{\\frac{1}{n} + \\frac{400}{S_{xx}}}}{\\sqrt{\\frac{1}{n}}} = \\sqrt{\\frac{\\frac{1}{n} + \\frac{400}{S_{xx}}}{\\frac{1}{n}}} = \\sqrt{1 + \\frac{400n}{S_{xx}}} $$\n现在，我们代入 $n$ 和 $S_{xx}$ 的数值：\n$$ F = \\sqrt{1 + \\frac{400 \\times 20}{4300}} = \\sqrt{1 + \\frac{8000}{4300}} = \\sqrt{1 + \\frac{80}{43}} $$\n$$ F = \\sqrt{\\frac{43}{43} + \\frac{80}{43}} = \\sqrt{\\frac{123}{43}} $$\n计算数值：\n$$ F \\approx \\sqrt{2.8604651} \\approx 1.691291 $$\n四舍五入到四位有效数字，膨胀因子为 $1.691$。", "answer": "$$\\boxed{1.691}$$", "id": "4904392"}, {"introduction": "学会了如何估计*平均*响应之后，一个自然而然的问题是：“对于一个*新*的个体，我们能预测什么？”。本练习通过对比均值响应的置信区间（Confidence Interval）和单个未来观测值的预测区间（Prediction Interval），直接回答了这个问题。理解这两者之间的关键区别——即它们包含的不同不确定性来源——对于正确解释和应用统计模型至关重要。[@problem_id:4904388]", "problem": "生物统计学中的一项剂量-反应研究旨在探究循环生物标志物浓度（单位：纳克/毫升）如何随给药剂量变化。对于每个受试者 $i \\in \\{1,\\dots,n\\}$，设剂量为 $x_i$，生物标志物反应为 $Y_i$。假设采用简单线性模型 $Y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i$，其中误差项 $\\varepsilon_i$ 是独立的，服从正态分布 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$。参数 $\\beta_0$ 和 $\\beta_1$ 通过普通最小二乘法（OLS）进行估计，在设计点 $x_0$ 处的拟合值为 $\\hat{Y}(x_0) = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_0$。\n\n从所述模型和 OLS 估计量的定义出发，根据第一性原理推导出：\n- 在 $x_0$ 处均值响应的置信区间，以及\n- 在 $x_0$ 处未来响应的预测区间，\n两者都需用方差估计量 $s^2$、置信水平为 $0.95$ 时相应的学生 t 分布（Student’s $t$）临界值，以及源于 OLS 几何的杠杆函数 $h(x_0)$ 来表示。\n\n然后，考虑研究中使用的以下科学上真实的设计：剂量变量已经过中心化和标准化，使其样本均值为 $0$，样本方差为 $1$。在此设计下，样本量 $n = 25$，设计点 $x_0 = 1.5$（解释为高于平均剂量 $1.5$ 个样本标准差），计算杠杆值 $h(x_0)$，并用它来求出在 $x_0$ 处，预测区间的总宽度与均值响应置信区间的总宽度之比 $R$。\n\n将你的最终数值答案 $R$ 四舍五入到四位有效数字。将最终数值表示为无单位的纯数。", "solution": "问题陈述是理论与应用生物统计学中的一个标准练习，具体涉及简单线性回归中的推断。所有定义、假设和数据均已给出，并且它们在科学上是合理的、内部是一致的。该问题提法恰当且客观。因此，该问题被认为是有效的，可以构建一个完整的解答。\n\n简单线性回归模型由下式给出：\n$$Y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i, \\quad \\text{for } i \\in \\{1,\\dots,n\\}$$\n其中误差项 $\\varepsilon_i$ 是独立同分布的，服从 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。参数 $\\beta_0$ 和 $\\beta_1$ 使用普通最小二乘法（OLS）进行估计，得到估计量 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$。\n\nOLS 估计量为：\n$$ \\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(Y_i - \\bar{Y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2} = \\frac{S_{xy}}{S_{xx}} $$\n$$ \\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{x} $$\n其中 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^n x_i$ 且 $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^n Y_i$。\n\n在点 $x_0$ 处的拟合值，或估计的均值响应，是 $\\hat{Y}(x_0) = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_0$。我们可以将此估计量重写为：\n$$ \\hat{Y}(x_0) = (\\bar{Y} - \\hat{\\beta}_1 \\bar{x}) + \\hat{\\beta}_1 x_0 = \\bar{Y} + \\hat{\\beta}_1 (x_0 - \\bar{x}) $$\n\n由于 $\\hat{Y}(x_0)$ 是正态分布随机变量 $Y_i$ 的线性组合，它本身也服从正态分布。其期望值为：\n$$ E[\\hat{Y}(x_0)] = E[\\bar{Y}] + (x_0 - \\bar{x}) E[\\hat{\\beta}_1] $$\n已知 $E[\\bar{Y}] = \\beta_0 + \\beta_1 \\bar{x}$ 且 $E[\\hat{\\beta}_1] = \\beta_1$，我们有：\n$$ E[\\hat{Y}(x_0)] = (\\beta_0 + \\beta_1 \\bar{x}) + (x_0 - \\bar{x})\\beta_1 = \\beta_0 + \\beta_1 x_0 = E[Y(x_0)] $$\n这表明 $\\hat{Y}(x_0)$ 是在 $x_0$ 处均值响应的无偏估计量。\n\n$\\hat{Y}(x_0)$ 的方差可以通过注意到在简单线性回归中，$\\bar{Y}$ 和 $\\hat{\\beta}_1$ 是不相关的，即 $\\text{Cov}(\\bar{Y}, \\hat{\\beta}_1) = 0$ 来求得。\n$$ \\text{Var}(\\hat{Y}(x_0)) = \\text{Var}(\\bar{Y} + \\hat{\\beta}_1(x_0 - \\bar{x})) = \\text{Var}(\\bar{Y}) + (x_0 - \\bar{x})^2 \\text{Var}(\\hat{\\beta}_1) $$\n各分量的方差为 $\\text{Var}(\\bar{Y}) = \\frac{\\sigma^2}{n}$ 和 $\\text{Var}(\\hat{\\beta}_1) = \\frac{\\sigma^2}{S_{xx}}$。代入这些值得到：\n$$ \\text{Var}(\\hat{Y}(x_0)) = \\frac{\\sigma^2}{n} + \\frac{\\sigma^2(x_0 - \\bar{x})^2}{S_{xx}} = \\sigma^2 \\left( \\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{\\sum_{i=1}^n(x_i - \\bar{x})^2} \\right) $$\n括号中的项被定义为杠杆函数 $h(x_0)$。\n$$ h(x_0) = \\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{\\sum_{i=1}^n(x_i - \\bar{x})^2} $$\n因此，$\\text{Var}(\\hat{Y}(x_0)) = \\sigma^2 h(x_0)$。\n\n未知的误差方差 $\\sigma^2$ 由 $s^2 = \\frac{SSE}{n-2}$ 估计，其中 $SSE = \\sum_{i=1}^n (Y_i - \\hat{Y}_i)^2$。均值响应的估计标准误是 $s.e.(\\hat{Y}(x_0)) = \\sqrt{s^2 h(x_0)}$。\n\n均值响应的枢轴量为：\n$$ T = \\frac{\\hat{Y}(x_0) - E[Y(x_0)]}{s.e.(\\hat{Y}(x_0))} = \\frac{\\hat{Y}(x_0) - (\\beta_0 + \\beta_1 x_0)}{\\sqrt{s^2 h(x_0)}} $$\n这个量服从自由度为 $n-2$ 的学生 t 分布（Student's $t$-distribution）。\n\n**1. 均值响应的置信区间**\n均值响应 $E[Y(x_0)]$ 的一个 $100(1-\\alpha)\\%$ 置信区间由枢轴量构造得出：\n$$ \\hat{Y}(x_0) \\pm t_{1-\\alpha/2, n-2} \\sqrt{s^2 h(x_0)} $$\n对于 $0.95$ 的置信水平，$\\alpha=0.05$，该区间为 $\\hat{Y}(x_0) \\pm t_{0.975, n-2} \\sqrt{s^2 h(x_0)}$。这是第一个要求的推导。\n\n**2. 未来响应的预测区间**\n预测区间是针对单个未来观测值 $Y_{new}(x_0)$，而不是其均值。\n$$ Y_{new}(x_0) = \\beta_0 + \\beta_1 x_0 + \\varepsilon_{new} $$\n其中 $\\varepsilon_{new} \\sim \\mathcal{N}(0, \\sigma^2)$ 且与原始数据独立。预测误差是差值 $Y_{new}(x_0) - \\hat{Y}(x_0)$。\n预测误差的期望为 $E[Y_{new}(x_ o) - \\hat{Y}(x_0)] = E[Y_{new}(x_0)] - E[\\hat{Y}(x_0)] = 0$。\n预测误差的方差为：\n$$ \\text{Var}(Y_{new}(x_0) - \\hat{Y}(x_0)) = \\text{Var}(Y_{new}(x_0)) + \\text{Var}(\\hat{Y}(x_0)) $$\n这是因为未来观测值与拟合值是独立的。\n$$ \\text{Var}(Y_{new}(x_0) - \\hat{Y}(x_0)) = \\sigma^2 + \\sigma^2 h(x_0) = \\sigma^2(1 + h(x_0)) $$\n预测的标准误估计为 $s.e.(pred) = \\sqrt{s^2(1 + h(x_0))}$。相应的预测枢轴量为：\n$$ T = \\frac{Y_{new}(x_0) - \\hat{Y}(x_0)}{\\sqrt{s^2(1 + h(x_0))}} $$\n这也服从自由度为 $n-2$ 的学生 t 分布。\n\n未来响应 $Y_{new}(x_0)$ 的一个 $100(1-\\alpha)\\%$ 预测区间为：\n$$ \\hat{Y}(x_0) \\pm t_{1-\\alpha/2, n-2} \\sqrt{s^2(1 + h(x_0))} $$\n对于 $0.95$ 的置信水平，该区间为 $\\hat{Y}(x_0) \\pm t_{0.975, n-2} \\sqrt{s^2(1+h(x_0))}$。这是第二个要求的推导。\n\n**3. 比率 $R$ 的计算**\n给定以下条件：\n- 样本量：$n = 25$\n- 协变量 $x$ 已经过中心化和标准化，因此其样本均值为 $\\bar{x}=0$，样本方差为 $1$。样本方差为 $\\frac{S_{xx}}{n-1} = 1$，这意味着 $S_{xx} = n-1$。\n- 感兴趣的设计点是 $x_0 = 1.5$。\n- 置信水平为 $0.95$。\n\n首先，我们为给定设计计算杠杆值 $h(x_0)$。\n$$ S_{xx} = n-1 = 25-1 = 24 $$\n在 $x_0=1.5$ 处的杠杆值为：\n$$ h(1.5) = \\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{S_{xx}} = \\frac{1}{25} + \\frac{(1.5 - 0)^2}{24} = \\frac{1}{25} + \\frac{2.25}{24} $$\n$$ h(1.5) = 0.04 + 0.09375 = 0.13375 $$\n\n接下来，我们定义置信区间（$W_{CI}$）和预测区间（$W_{PI}$）的总宽度。\nt 分布的自由度是 $n-2 = 25-2 = 23$。设 $t^* = t_{0.975, 23}$。\n$$ W_{CI} = 2 \\times t^* \\sqrt{s^2 h(x_0)} $$\n$$ W_{PI} = 2 \\times t^* \\sqrt{s^2(1 + h(x_0))} $$\n\n预测区间的总宽度与置信区间的总宽度之比 $R$ 为：\n$$ R = \\frac{W_{PI}}{W_{CI}} = \\frac{2 t^* \\sqrt{s^2(1 + h(x_0))}}{2 t^* \\sqrt{s^2 h(x_0)}} = \\frac{\\sqrt{s^2(1 + h(x_0))}}{\\sqrt{s^2 h(x_0)}} = \\sqrt{\\frac{1 + h(x_0)}{h(x_0)}} $$\n注意，比率 $R$ 与估计方差 $s^2$ 和临界值 $t^*$ 无关。\n\n代入计算出的 $h(x_0) = h(1.5) = 0.13375$ 值：\n$$ R = \\sqrt{\\frac{1 + 0.13375}{0.13375}} = \\sqrt{\\frac{1.13375}{0.13375}} $$\n$$ R = \\sqrt{8.4766353...} \\approx 2.911466... $$\n\n四舍五入到四位有效数字，我们得到 $R = 2.911$。", "answer": "$$\\boxed{2.911}$$", "id": "4904388"}, {"introduction": "现实世界中的关系并非总是线性的，而且许多研究结果是二元的（例如，出现并发症/未出现并发症）。这个进阶练习将展示如何在更广泛的模型框架下，即广义线性模型（Generalized Linear Models, GLMs），构建置信区间。我们将以一个逻辑回归模型为例，并引入一个强大的工具——delta方法，它使我们能够为模型参数的非线性函数的方差找到一个近似值，这在现代生物统计学中是一项不可或缺的技能。[@problem_id:4904356]", "problem": "一项大型队列研究使用广义线性模型(GLM)对术后并发症的概率进行建模，该模型使用二项式结果的典范链接。令 $Y_{i} \\in \\{0,1\\}$ 表示并发症状态，并假设条件均值满足 $\\mu(x) = \\mathbb{E}(Y \\mid x)$，使用典范 logit 链接 $g(\\mu) = \\ln\\!\\left(\\frac{\\mu}{1 - \\mu}\\right)$。其逆链接函数为 $g^{-1}(\\eta) = \\frac{1}{1 + \\exp(-\\eta)}$，因此，在协变量向量 $x$ 处的平均响应为 $\\mu(x) = g^{-1}(x^{\\top}\\beta)$。协变量向量为 $x = (1, x_{1}, x_{2})^{\\top}$，包含一个截距项、一个中心化和标准化后的年龄协变量 $x_{1}$，以及一个标准化的生物标志物 $x_{2}$。\n\n从一个足够大以支持渐近性理论的样本（大小为 $n$）中，获得了 $\\beta$ 的最大似然估计量(MLE)，记为 $\\hat{\\beta}$。在协变量点 $x_{0} = (1, 2.0, 1.5)^{\\top}$ 处，拟合值为\n$$\n\\hat{\\beta} = \\begin{pmatrix} -2.3 \\\\ 0.9 \\\\ 0.25 \\end{pmatrix}, \\quad \\widehat{\\mathrm{Var}}(\\hat{\\beta}) = \\begin{pmatrix}\n0.04  -0.01  0.005 \\\\\n-0.01  0.09  -0.02 \\\\\n0.005  -0.02  0.04\n\\end{pmatrix}.\n$$\n您的目标是为平均响应 $\\mu(x_{0})$ 构建一个基于正态分布的置信区间。从适用于 GLM 估计的第一性原理和一阶 delta 方法出发，用基本量推导 $\\hat{\\mu}(x_{0})$ 的渐近方差，然后使用上述数值进行计算。将您的最终数值结果四舍五入到四位有效数字，并将其报告为一个无量纲的量。", "solution": "用户要求推导和计算广义线性模型(GLM)中估计的平均响应的渐近方差。\n\n### 第1步：提取已知条件\n- **模型类型**：用于二项式结果的广义线性模型，$Y_{i} \\in \\{0,1\\}$。\n- **链接函数**：典范 logit 链接，$g(\\mu) = \\ln\\left(\\frac{\\mu}{1 - \\mu}\\right)$，其中 $\\mu(x) = \\mathbb{E}(Y \\mid x)$。\n- **逆链接函数**：$g^{-1}(\\eta) = \\frac{1}{1 + \\exp(-\\eta)}$。\n- **平均响应模型**：$\\mu(x) = g^{-1}(x^{\\top}\\beta)$。\n- **协变量向量形式**：$x = (1, x_{1}, x_{2})^{\\top}$。\n- **估计**：来自大样本($n$)的最大似然估计量 $\\hat{\\beta}$。\n- **感兴趣的协变量点**：$x_{0} = (1, 2.0, 1.5)^{\\top}$。\n- **估计参数**：\n  - 系数向量：$\\hat{\\beta} = \\begin{pmatrix} -2.3 \\\\ 0.9 \\\\ 0.25 \\end{pmatrix}$。\n  - $\\hat{\\beta}$的协方差矩阵：$\\widehat{\\mathrm{Var}}(\\hat{\\beta}) = \\begin{pmatrix} 0.04  -0.01  0.005 \\\\ -0.01  0.09  -0.02 \\\\ 0.005  -0.02  0.04 \\end{pmatrix}$。\n- **目标**：使用一阶 delta 方法推导并计算 $\\hat{\\mu}(x_{0})$ 的渐近方差，记为 $\\widehat{\\mathrm{Var}}(\\hat{\\mu}(x_{0}))$。\n- **报告**：将最终数值结果四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，描述了生物统计学中的一个标准任务：从逻辑回归模型中求出预测概率的方差。所指定的方法——delta 方法——是完成此任务的正确理论工具。该问题是适定的，提供了所有必要的数值（$\\hat{\\beta}$、$\\widehat{\\mathrm{Var}}(\\hat{\\beta})$、$x_0$）和函数形式（$g^{-1}$）。所提供的协方差矩阵 $\\widehat{\\mathrm{Var}}(\\hat{\\beta})$ 是对称的，经检查确认为正定矩阵，这是有效协方差矩阵的必要条件。问题陈述客观，没有任何歧义。因此，该问题是有效的。\n\n### 第3步：行动（求解）\n目标是推导并计算估计的平均响应 $\\hat{\\mu}(x_0) = g^{-1}(x_0^{\\top}\\hat{\\beta})$ 的渐近方差。这可以通过使用一阶多元 delta 方法来完成。\n\ndelta 方法为渐近正态随机向量的函数的方差提供了一个近似值。鉴于最大似然估计量 $\\hat{\\beta}$ 是渐近正态的，其协方差矩阵由 $\\widehat{\\mathrm{Var}}(\\hat{\\beta})$ 估计，那么变换后的估计量 $h(\\hat{\\beta})$ 的方差近似为：\n$$ \\widehat{\\mathrm{Var}}(h(\\hat{\\beta})) \\approx [\\nabla_{\\beta} h(\\hat{\\beta})]^{\\top} \\widehat{\\mathrm{Var}}(\\hat{\\beta}) [\\nabla_{\\beta} h(\\hat{\\beta})] $$\n在这个问题中，函数 $h$ 是在特定协变量向量 $x_0$ 处求值的平均响应函数：\n$$ h(\\beta) = \\mu(x_0) = g^{-1}(x_0^{\\top}\\beta) $$\n首先，我们必须推导 $h(\\beta)$ 关于 $\\beta$ 的梯度，记为 $\\nabla_{\\beta} h(\\beta)$。令 $\\eta = x_0^{\\top}\\beta$ 为线性预测变量。使用链式法则，关于向量 $\\beta$ 的每个分量 $\\beta_j$ 的偏导数为：\n$$ \\frac{\\partial h}{\\partial \\beta_j} = \\frac{d g^{-1}(\\eta)}{d\\eta} \\cdot \\frac{\\partial \\eta}{\\partial \\beta_j} $$\n线性预测变量为 $\\eta = x_{00}\\beta_0 + x_{01}\\beta_1 + x_{02}\\beta_2$，其中 $x_{00}=1$。$\\eta$ 关于 $\\beta_j$ 的导数就是相应的协变量值 $x_{0j}$。因此，$\\eta$ 关于向量 $\\beta$ 的梯度是向量 $x_0$：\n$$ \\nabla_{\\beta} \\eta = x_0 $$\n接下来，我们求逆 logit 链接函数 $g^{-1}(\\eta) = \\frac{1}{1 + \\exp(-\\eta)}$ 的导数。\n$$ \\frac{d g^{-1}(\\eta)}{d\\eta} = \\frac{d}{d\\eta} (1 + \\exp(-\\eta))^{-1} = -1(1 + \\exp(-\\eta))^{-2} \\cdot (-\\exp(-\\eta)) = \\frac{\\exp(-\\eta)}{(1 + \\exp(-\\eta))^2} $$\n这个表达式可以通过用平均响应 $\\mu = g^{-1}(\\eta)$ 来表示，从而进行简化：\n$$ \\frac{d g^{-1}(\\eta)}{d\\eta} = \\left(\\frac{1}{1 + \\exp(-\\eta)}\\right) \\left(\\frac{\\exp(-\\eta)}{1 + \\exp(-\\eta)}\\right) = \\mu \\cdot (1-\\mu) $$\n这个结果 $\\mu(1-\\mu)$ 是伯努利或二项响应的方差函数，是具有典范链接的 GLM 的一个基本性质。\n\n将这些部分结合起来， $h(\\beta)$ 的梯度为：\n$$ \\nabla_{\\beta} h(\\beta) = \\frac{d g^{-1}(\\eta)}{d\\eta} \\cdot \\nabla_{\\beta} \\eta = \\mu(x_0)(1-\\mu(x_0)) \\cdot x_0 $$\n将该梯度代入 delta 方法公式，得到 $\\hat{\\mu}(x_0)$ 的渐近方差的表达式：\n$$ \\mathrm{Var}(\\hat{\\mu}(x_0)) \\approx \\left[ \\mu(x_0)(1-\\mu(x_0)) x_0 \\right]^{\\top} \\mathrm{Var}(\\hat{\\beta}) \\left[ \\mu(x_0)(1-\\mu(x_0)) x_0 \\right] $$\n因为 $\\mu(x_0)(1-\\mu(x_0))$ 是一个标量，它可以从二次型中提出来：\n$$ \\mathrm{Var}(\\hat{\\mu}(x_0)) \\approx [\\mu(x_0)(1-\\mu(x_0))]^2 \\cdot x_0^{\\top} \\mathrm{Var}(\\hat{\\beta}) x_0 $$\n为了获得数值估计，我们将最大似然估计量 $\\hat{\\beta}$ 和 $\\widehat{\\mathrm{Var}}(\\hat{\\beta})$ 代入公式：\n$$ \\widehat{\\mathrm{Var}}(\\hat{\\mu}(x_0)) = [\\hat{\\mu}(x_0)(1-\\hat{\\mu}(x_0))]^2 \\cdot x_0^{\\top} \\widehat{\\mathrm{Var}}(\\hat{\\beta}) x_0 $$\n现在我们使用给定的值进行数值计算。\n\n首先，计算估计的线性预测变量 $\\hat{\\eta}_0 = x_0^{\\top}\\hat{\\beta}$：\n$$ \\hat{\\eta}_0 = \\begin{pmatrix} 1  2.0  1.5 \\end{pmatrix} \\begin{pmatrix} -2.3 \\\\ 0.9 \\\\ 0.25 \\end{pmatrix} = 1(-2.3) + 2.0(0.9) + 1.5(0.25) = -2.3 + 1.8 + 0.375 = -0.125 $$\n接下来，计算估计的平均响应 $\\hat{\\mu}(x_0)$：\n$$ \\hat{\\mu}(x_0) = g^{-1}(\\hat{\\eta}_0) = \\frac{1}{1 + \\exp(-\\hat{\\eta}_0)} = \\frac{1}{1 + \\exp(0.125)} \\approx \\frac{1}{1 + 1.133148} \\approx 0.468789 $$\n标量前置因子为 $[\\hat{\\mu}(x_0)(1-\\hat{\\mu}(x_0))]^2$：\n$$ \\hat{\\mu}(x_0)(1-\\hat{\\mu}(x_0)) \\approx 0.468789 \\cdot (1 - 0.468789) = 0.468789 \\cdot 0.531211 \\approx 0.249012 $$\n$$ [\\hat{\\mu}(x_0)(1-\\hat{\\mu}(x_0))]^2 \\approx (0.249012)^2 \\approx 0.062007 $$\n接下来，计算二次型 $x_0^{\\top} \\widehat{\\mathrm{Var}}(\\hat{\\beta}) x_0$：\n$$ x_0^{\\top} \\widehat{\\mathrm{Var}}(\\hat{\\beta}) x_0 = \\begin{pmatrix} 1  2.0  1.5 \\end{pmatrix} \\begin{pmatrix} 0.04  -0.01  0.005 \\\\ -0.01  0.09  -0.02 \\\\ 0.005  -0.02  0.04 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2.0 \\\\ 1.5 \\end{pmatrix} $$\n我们首先计算乘积 $\\widehat{\\mathrm{Var}}(\\hat{\\beta}) x_0$：\n$$ \\begin{pmatrix} 0.04  -0.01  0.005 \\\\ -0.01  0.09  -0.02 \\\\ 0.005  -0.02  0.04 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2.0 \\\\ 1.5 \\end{pmatrix} = \\begin{pmatrix} 0.04(1) - 0.01(2.0) + 0.005(1.5) \\\\ -0.01(1) + 0.09(2.0) - 0.02(1.5) \\\\ 0.005(1) - 0.02(2.0) + 0.04(1.5) \\end{pmatrix} = \\begin{pmatrix} 0.0275 \\\\ 0.14 \\\\ 0.025 \\end{pmatrix} $$\n然后，我们通过前乘以 $x_0^{\\top}$ 来计算完整的二次型：\n$$ x_0^{\\top} \\widehat{\\mathrm{Var}}(\\hat{\\beta}) x_0 = \\begin{pmatrix} 1  2.0  1.5 \\end{pmatrix} \\begin{pmatrix} 0.0275 \\\\ 0.14 \\\\ 0.025 \\end{pmatrix} = 1(0.0275) + 2.0(0.14) + 1.5(0.025) = 0.0275 + 0.28 + 0.0375 = 0.345 $$\n最后，我们将两个主要部分相乘以求得估计方差：\n$$ \\widehat{\\mathrm{Var}}(\\hat{\\mu}(x_0)) \\approx 0.062007 \\times 0.345 \\approx 0.021392415 $$\n四舍五入到四位有效数字，最终结果是 $0.02139$。", "answer": "$$\n\\boxed{0.02139}\n$$", "id": "4904356"}]}