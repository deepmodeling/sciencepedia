{"hands_on_practices": [{"introduction": "在生物统计学中，变量之间的关系通常不是简单的线性关系。然而，通过对数等数学变换，我们可以将非线性关系线性化，从而应用线性回归模型。本练习提供了一个在对数变换尺度上计算决定系数（$R^2$）的实践机会，旨在加深您对 $R^2$ 作为已解释方差比例这一定义的理解。[@problem_id:4914681]", "problem": "一项生物统计学研究调查了当关系为乘性时，血清生物标志物 $y$ 如何随药物剂量 $x$ 变化。其科学前提是，$y$ 中的乘性误差可通过自然对数来稳定，并且生物标志物与剂量之间的转换后关系可进行线性建模。具体而言，工作模型为\n$$\\ln(y_i) = a + b \\ln(x_i) + e_i,$$\n其中 $a$ 和 $b$ 是未知参数，$e_i$ 代表对数尺度上的零均值随机误差。使用普通最小二乘法（OLS）在转换后的尺度上拟合该直线。\n\n在指数增长的剂量下收集了一组 $n=5$ 的配对观测值，这些剂量被选择以跨越一个宽动态范围。对于每个受试者 $i$，记录了 $\\ln(x_i)$ 和 $\\ln(y_i)$ 如下（按 $\\ln(x_i)$ 递增排序）：\n$$(\\ln(x_i), \\ln(y_i)) \\in \\{(0, 0.45), (1, 1.25), (2, 2.20), (3, 3.05), (4, 3.95)\\}.$$\n\n从最小二乘拟合的核心定义和转换后响应的方差分解出发，计算此对数转换尺度上拟合线性模型的决定系数 $R^2$。将最终答案表示为一个纯数字（无单位），并四舍五入到四位有效数字。", "solution": "该问题陈述经评估后被认为是有效的。这是一个在生物统计学中提法得当、有科学依据的问题，提供了完整且一致的数据集和明确的目标。所指定的模型涉及对数转换以线性化幂律关系并稳定方差，是统计建模中一种标准且受推崇的技术。所有计算所需量值的必要信息均已提供。\n\n问题要求计算拟合对数转换数据的线性模型的决定系数，记为 $R^2$。该模型由下式给出：\n$$ \\ln(y_i) = a + b \\ln(x_i) + e_i $$\n为了后续计算的清晰和方便，我们定义转换后的变量为 $X_i' = \\ln(x_i)$ 和 $Y_i' = \\ln(y_i)$。那么模型就是一个简单的线性回归模型：\n$$ Y_i' = a + b X_i' + e_i $$\n数据集包含 $n=5$ 组配对观测值 $(X_i', Y_i')$：\n$$ (X_i', Y_i') \\in \\{(0, 0.45), (1, 1.25), (2, 2.20), (3, 3.05), (4, 3.95)\\} $$\n\n决定系数 $R^2$ 表示因变量 $Y_i'$ 的总方差中，可由与自变量 $X_i'$ 的线性关系解释的比例。其定义为：\n$$ R^2 = 1 - \\frac{\\text{SS}_{\\text{res}}}{\\text{SS}_{\\text{tot}}} $$\n其中 $\\text{SS}_{\\text{tot}}$ 是总平方和，$\\text{SS}_{\\text{res}}$ 是残差平方和。\n\n总平方和度量了响应变量 $Y_i'$ 的总变异性：\n$$ \\text{SS}_{\\text{tot}} = \\sum_{i=1}^{n} (Y_i' - \\overline{Y'})^2 $$\n其中 $\\overline{Y'}$ 是 $Y_i'$ 值的样本均值。\n\n残差平方和度量了拟合回归线后仍未被解释的变异性：\n$$ \\text{SS}_{\\text{res}} = \\sum_{i=1}^{n} (Y_i' - \\hat{Y}_i')^2 $$\n其中 $\\hat{Y}_i' = \\hat{a} + \\hat{b}X_i'$ 是从普通最小二乘法（OLS）回归中获得的拟合值。\n\n对于只有一个预测变量的简单线性回归模型，$R^2$ 等于 $X'$ 和 $Y'$ 之间的皮尔逊积矩相关系数 $r$ 的平方。这提供了一条更直接的计算路径。$r^2$ 的公式为：\n$$ R^2 = r^2 = \\left( \\frac{\\sum_{i=1}^{n} (X_i' - \\overline{X'})(Y_i' - \\overline{Y'})}{\\sqrt{\\sum_{i=1}^{n} (X_i' - \\overline{X'})^2 \\sum_{i=1}^{n} (Y_i' - \\overline{Y'})^2}} \\right)^2 = \\frac{S_{X'Y'}^2}{S_{X'X'} S_{Y'Y'}} $$\n其中我们定义了校正后的平方和与叉积和：\n$S_{X'X'} = \\sum_{i=1}^{n} (X_i' - \\overline{X'})^2$\n$S_{Y'Y'} = \\sum_{i=1}^{n} (Y_i' - \\overline{Y'})^2$\n$S_{X'Y'} = \\sum_{i=1}^{n} (X_i' - \\overline{X'})(Y_i' - \\overline{Y'})$\n\n为了计算这些量，我们首先从数据中计算出必要的和与均值。\n数据点为：\n$X': \\{0, 1, 2, 3, 4\\}$\n$Y': \\{0.45, 1.25, 2.20, 3.05, 3.95\\}$\n\n首先，我们计算和：\n$$ \\sum_{i=1}^{5} X_i' = 0 + 1 + 2 + 3 + 4 = 10 $$\n$$ \\sum_{i=1}^{5} Y_i' = 0.45 + 1.25 + 2.20 + 3.05 + 3.95 = 10.90 $$\n接着，我们计算样本均值：\n$$ \\overline{X'} = \\frac{1}{n}\\sum_{i=1}^{n} X_i' = \\frac{10}{5} = 2 $$\n$$ \\overline{Y'} = \\frac{1}{n}\\sum_{i=1}^{n} Y_i' = \\frac{10.90}{5} = 2.18 $$\n\n接下来，我们使用校正平方和与叉积和的计算公式，这比使用定义公式更方便。\n$S_{X'X'} = \\sum_{i=1}^{n} (X_i')^2 - \\frac{(\\sum_{i=1}^{n} X_i')^2}{n}$\n$S_{Y'Y'} = \\sum_{i=1}^{n} (Y_i')^2 - \\frac{(\\sum_{i=1}^{n} Y_i')^2}{n}$\n$S_{X'Y'} = \\sum_{i=1}^{n} X_i' Y_i' - \\frac{(\\sum_{i=1}^{n} X_i')(\\sum_{i=1}^{n} Y_i')}{n}$\n\n我们需要以下额外的和：\n$$ \\sum_{i=1}^{5} (X_i')^2 = 0^2 + 1^2 + 2^2 + 3^2 + 4^2 = 0 + 1 + 4 + 9 + 16 = 30 $$\n$$ \\sum_{i=1}^{5} (Y_i')^2 = (0.45)^2 + (1.25)^2 + (2.20)^2 + (3.05)^2 + (3.95)^2 $$\n$$ = 0.2025 + 1.5625 + 4.84 + 9.3025 + 15.6025 = 31.51 $$\n$$ \\sum_{i=1}^{5} X_i' Y_i' = (0)(0.45) + (1)(1.25) + (2)(2.20) + (3)(3.05) + (4)(3.95) $$\n$$ = 0 + 1.25 + 4.40 + 9.15 + 15.80 = 30.60 $$\n\n现在我们可以计算 $S_{X'X'}$、$S_{Y'Y'}$ 和 $S_{X'Y'}$：\n$$ S_{X'X'} = 30 - \\frac{(10)^2}{5} = 30 - \\frac{100}{5} = 30 - 20 = 10 $$\n$$ S_{Y'Y'} = 31.51 - \\frac{(10.90)^2}{5} = 31.51 - \\frac{118.81}{5} = 31.51 - 23.762 = 7.748 $$\n$$ S_{X'Y'} = 30.60 - \\frac{(10)(10.90)}{5} = 30.60 - \\frac{109}{5} = 30.60 - 21.80 = 8.80 $$\n\n最后，我们将这些值代入 $R^2$ 的公式中：\n$$ R^2 = \\frac{S_{X'Y'}^2}{S_{X'X'} S_{Y'Y'}} = \\frac{(8.80)^2}{(10)(7.748)} = \\frac{77.44}{77.48} $$\n$$ R^2 \\approx 0.9994837377... $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $9, 9, 9, 4$。第五位有效数字是 $8$，因此我们将第四位向上取整。\n$$ R^2 \\approx 0.9995 $$\n这个值表明，生物标志物浓度的对数中约有 $99.95\\%$ 的方差可由药物剂量的对数解释，这标志着在转换尺度上具有极强的线性拟合。", "answer": "$$ \\boxed{0.9995} $$", "id": "4914681"}, {"introduction": "在多元回归分析中，一个核心问题是评估单个预测变量在控制其他变量后对响应变量的独特贡献。本练习将引导您计算偏决定系数和半偏决定系数，这两个指标是量化这种独特贡献的有力工具。通过此练习，您将清晰地辨别它们在解释上的细微差别，即它们分别以何种方差作为解释的基准。[@problem_id:4914694]", "problem": "一项生物统计学研究使用多元线性回归模型分析收缩压，预测变量为年龄、身体质量指数和血浆钠浓度。响应变量是连续的收缩压。假设具有独立、同方差误差的标准线性模型成立。将包含所有三个预测变量的模型称为完整模型，将排除血浆钠（但包括年龄和身体质量指数）的模型称为简化模型。给定以下最小二乘法摘要量：总平方和 $SST = 24000$，简化模型的误差平方和 (SSE) $SSE_{\\mathrm{red}} = 18000$，以及完整模型的误差平方和 $SSE_{\\mathrm{full}} = 17100$。从总平方和、残差平方和以及决定系数 ($R^2$) 的核心定义出发，推导计算血浆钠的偏决定系数（在控制年龄和身体质量指数后）和半偏决定系数所需的表达式。使用这些推导，计算血浆钠的偏决定系数与半偏决定系数之比。将最终答案表示为一个纯数（无单位）。", "solution": "此问题要求计算一个预测变量（血浆钠）在控制其他变量（年龄和身体质量指数）后，其偏决定系数与半偏决定系数之比。问题已适当地给出所有必要信息：总平方和（SST）、包含所有变量的完整模型的误差平方和（$SSE_{\\mathrm{full}}$），以及排除目标变量的简化模型的误差平方和（$SSE_{\\mathrm{red}}$）。\n\n首先，我们明确各个术语的定义和给定的数值：\n*   总平方和 (Total Sum of Squares): $SST = 24000$。这代表了响应变量（收缩压）的总变异。\n*   简化模型的误差平方和 (Error Sum of Squares for the reduced model): $SSE_{\\mathrm{red}} = 18000$。这是仅使用年龄和身体质量指数进行预测时，模型未能解释的变异。\n*   完整模型的误差平方和 (Error Sum of Squares for the full model): $SSE_{\\mathrm{full}} = 17100$。这是使用年龄、身体质量指数和血浆钠进行预测时，模型未能解释的变异。\n\n**偏决定系数 (Partial Coefficient of Determination)**\n血浆钠的偏决定系数，记为 $r^2_{Y,p|\\mathrm{red}}$，衡量的是在简化模型（年龄和身体质量指数）未能解释的方差中，有多少比例可以被血浆钠所解释。\n*   简化模型未能解释的方差为 $SSE_{\\mathrm{red}}$。\n*   通过在模型中加入血浆钠，额外解释的方差量等于误差平方和的减少量，即 $SSE_{\\mathrm{red}} - SSE_{\\mathrm{full}}$。\n*   因此，偏决定系数的计算公式为：\n$$ r^2_{Y,p|\\mathrm{red}} = \\frac{SSE_{\\mathrm{red}} - SSE_{\\mathrm{full}}}{SSE_{\\mathrm{red}}} $$\n代入数值：\n$$ r^2_{Y,p|\\mathrm{red}} = \\frac{18000 - 17100}{18000} = \\frac{900}{18000} = 0.05 $$\n\n**半偏决定系数 (Semipartial Coefficient of Determination)**\n血浆钠的半偏决定系数，记为 $r^2_{Y(p|\\mathrm{red})}$，衡量的是响应变量的*总*方差中，有多少比例可以被血浆钠*唯一*地解释（即在控制了年龄和身体质量指数之后）。\n*   由血浆钠唯一解释的方差量仍然是 $SSE_{\\mathrm{red}} - SSE_{\\mathrm{full}}$。\n*   这个唯一解释的方差是相对于总方差 $SST$ 的比例。\n*   因此，半偏决定系数的计算公式为：\n$$ r^2_{Y(p|\\mathrm{red})} = \\frac{SSE_{\\mathrm{red}} - SSE_{\\mathrm{full}}}{SST} $$\n代入数值：\n$$ r^2_{Y(p|\\mathrm{red})} = \\frac{18000 - 17100}{24000} = \\frac{900}{24000} = 0.0375 $$\n\n**计算比率**\n问题要求计算偏决定系数与半偏决定系数之比：\n$$ \\text{比率} = \\frac{\\text{偏决定系数}}{\\text{半偏决定系数}} = \\frac{r^2_{Y,p|\\mathrm{red}}}{r^2_{Y(p|\\mathrm{red})}} $$\n代入各自的公式：\n$$ \\text{比率} = \\frac{\\frac{SSE_{\\mathrm{red}} - SSE_{\\mathrm{full}}}{SSE_{\\mathrm{red}}}}{\\frac{SSE_{\\mathrm{red}} - SSE_{\\mathrm{full}}}{SST}} $$\n分子分母中的 $(SSE_{\\mathrm{red}} - SSE_{\\mathrm{full}})$ 项可以消去，代数上简化为：\n$$ \\text{比率} = \\frac{SST}{SSE_{\\mathrm{red}}} $$\n现在，我们代入给定的数值进行计算：\n$$ \\text{比率} = \\frac{24000}{18000} = \\frac{24}{18} = \\frac{4}{3} $$\n因此，血浆钠的偏决定系数是其半偏决定系数的 $\\frac{4}{3}$ 倍。", "answer": "$$\n\\boxed{\\frac{4}{3}}\n$$", "id": "4914694"}, {"introduction": "将总方差分解为模型解释部分和未解释部分，是理解拟合优度的核心思想，这一思想并不仅限于连续预测变量的回归分析。本练习将展示这一原则如何同样应用于方差分析（ANOVA），其中 $R^2$（在此情景下常称为 $\\eta^2$）衡量了由组别成员身份所解释的响应变量方差的比例。通过本练习，您将把回归分析和方差分析这两个概念统一在广义线性模型的框架之下。[@problem_id:4914695]", "problem": "一个生物统计学团队使用单向固定效应方差分析 (ANOVA) 来研究三种降压方案八周后收缩压的平均降低值。各组的摘要如下：\n\n- 治疗方案 A：样本量 $n_{1} = 40$，组均值 $\\bar{y}_{1} = 8.2$，无偏样本方差 $s_{1}^{2} = 14.0$。\n- 治疗方案 B：样本量 $n_{2} = 35$，组均值 $\\bar{y}_{2} = 5.7$，无偏样本方差 $s_{2}^{2} = 11.5$。\n- 治疗方案 C：样本量 $n_{3} = 45$，组均值 $\\bar{y}_{3} = 10.1$，无偏样本方差 $s_{3}^{2} = 18.3$。\n\n将数据视为来自具有独立误差和同质组水平方差（由提供的无偏样本方差估计）的标准单向方差分析模型 $y_{ij} = \\mu + \\tau_{j} + \\varepsilon_{ij}$。根据决定系数（记为 $R^{2}$）是结果总变异中可由模型解释的比例，以及标准化的方差分析效应量是通过已解释变异与未解释变异的比率来定义的核心定义，计算此设计的科恩 $f$ 效应量。\n\n将科恩 $f$ 的最终答案四舍五入到四位有效数字。将最终值表示为一个无单位的纯数。", "solution": "单向固定效应方差分析 (ANOVA) 模型 $y_{ij} = \\mu + \\tau_{j} + \\varepsilon_{ij}$ 将结果的总变异分解为组间均值的变异和组内变异。设总样本量为 $N = \\sum_{j=1}^{3} n_{j}$。加权总均值为\n$$\n\\bar{y} \\;=\\; \\frac{\\sum_{j=1}^{3} n_{j}\\,\\bar{y}_{j}}{N}.\n$$\n组间平方和为\n$$\n\\mathrm{SSB} \\;=\\; \\sum_{j=1}^{3} n_{j}\\,(\\bar{y}_{j} - \\bar{y})^{2},\n$$\n并且根据各组内无偏样本方差的定义，组内（误差）平方和为\n$$\n\\mathrm{SSE} \\;=\\; \\sum_{j=1}^{3} (n_{j} - 1)\\,s_{j}^{2}.\n$$\n总平方和为 $\\mathrm{SST} = \\mathrm{SSB} + \\mathrm{SSE}$。根据已解释变异比例的定义，决定系数为\n$$\nR^{2} \\;=\\; \\frac{\\mathrm{SSB}}{\\mathrm{SST}}.\n$$\n对于标准化的方差分析效应量，科恩 $f$ 定义为 $f^{2} = \\frac{R^{2}}{1 - R^{2}}$，且 $f = \\sqrt{f^{2}}$。\n\n我们根据提供的摘要计算每个量。\n\n首先，总样本量为\n$$\nN \\;=\\; n_{1} + n_{2} + n_{3} \\;=\\; 40 + 35 + 45 \\;=\\; 120.\n$$\n加权总均值为\n$$\n\\bar{y} \\;=\\; \\frac{n_{1}\\bar{y}_{1} + n_{2}\\bar{y}_{2} + n_{3}\\bar{y}_{3}}{N}\n\\;=\\; \\frac{40 \\cdot 8.2 + 35 \\cdot 5.7 + 45 \\cdot 10.1}{120}\n\\;=\\; \\frac{328 + 199.5 + 454.5}{120}\n\\;=\\; \\frac{982.0}{120}\n\\;=\\; 8.183\\overline{3}.\n$$\n组间平方和：\n$$\n\\begin{aligned}\n\\mathrm{SSB}\n= 40\\,(8.2 - 8.183\\overline{3})^{2}\n+ 35\\,(5.7 - 8.183\\overline{3})^{2}\n+ 45\\,(10.1 - 8.183\\overline{3})^{2}\n\\\\\n= 40\\,(0.016\\overline{6})^{2}\n+ 35\\,(-2.483\\overline{3})^{2}\n+ 45\\,(1.916\\overline{6})^{2}.\n\\end{aligned}\n$$\n计算每一项：\n$$\n40\\,(0.016\\overline{6})^{2} \\;=\\; 40 \\cdot 0.000277\\overline{7} \\;=\\; 0.011111\\ldots,\n$$\n$$\n35\\,(-2.483\\overline{3})^{2} \\;\\approx\\; 35 \\cdot 6.166944\\ldots \\;=\\; 215.843055\\ldots,\n$$\n$$\n45\\,(1.916\\overline{6})^{2} \\;=\\; 45 \\cdot 3.673611\\ldots \\;=\\; 165.3125.\n$$\n因此，\n$$\n\\mathrm{SSB} \\;\\approx\\; 0.011111 + 215.843056 + 165.3125 \\;=\\; 381.166667.\n$$\n组内平方和：\n$$\n\\mathrm{SSE} \\;=\\; (40-1)\\cdot 14.0 \\;+\\; (35-1)\\cdot 11.5 \\;+\\; (45-1)\\cdot 18.3\n\\;=\\; 39\\cdot 14.0 \\;+\\; 34\\cdot 11.5 \\;+\\; 44\\cdot 18.3,\n$$\n所以\n$$\n\\mathrm{SSE} \\;=\\; 546 \\;+\\; 391 \\;+\\; 805.2 \\;=\\; 1742.2.\n$$\n总平方和：\n$$\n\\mathrm{SST} \\;=\\; \\mathrm{SSB} + \\mathrm{SSE} \\;\\approx\\; 381.166667 + 1742.2 \\;=\\; 2123.366667.\n$$\n因此，\n$$\nR^{2} \\;=\\; \\frac{\\mathrm{SSB}}{\\mathrm{SST}} \\;\\approx\\; \\frac{381.166667}{2123.366667}\n\\;=\\; \\frac{11435}{63701} \\;\\approx\\; 0.1795.\n$$\n现在，\n$$\nf^{2} \\;=\\; \\frac{R^{2}}{1 - R^{2}} \\;=\\; \\frac{11435/63701}{1 - 11435/63701}\n\\;=\\; \\frac{11435}{63701 - 11435}\n\\;=\\; \\frac{11435}{52266}\n\\;\\approx\\; 0.2187847,\n$$\n且\n$$\nf \\;=\\; \\sqrt{f^{2}} \\;\\approx\\; \\sqrt{0.2187847} \\;\\approx\\; 0.467744.\n$$\n四舍五入到四位有效数字，科恩 $f$ 效应量为\n$$\n0.4677.\n$$", "answer": "$$\\boxed{0.4677}$$", "id": "4914695"}]}