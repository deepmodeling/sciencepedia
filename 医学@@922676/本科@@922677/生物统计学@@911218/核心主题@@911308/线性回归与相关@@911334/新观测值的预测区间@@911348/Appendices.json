{"hands_on_practices": [{"introduction": "预测区间的一个核心应用是在质量控制和可靠性工程中。这个练习提供了一个典型的场景：根据一小批原型产品的测试数据，预测单个新产品的性能。通过计算电池寿命的预测区间，你将掌握从样本数据（均值和标准差未知）为单个未来观测值构建预测区间的基本方法[@problem_id:1945989]。", "problem": "一家科技初创公司正在开发一种新型固态电池，用于高空大气监测无人机。为了评估其产品的可靠性，他们对一小批原型电池进行了生命周期测试。一个由10块电池组成的随机样本，其寿命（以连续运行至失效的小时数计算）记录如下：\n48.5, 55.2, 46.1, 51.9, 43.8, 53.0, 49.7, 58.1, 44.5, 49.2。\n假设这些电池的寿命服从一个均值和方差均未知的正态分布。\n基于这个样本，工程团队需要为下一块下线电池的性能提供一个统计预测。计算单个新制造电池寿命的90%预测区间。报告该区间的下限和上限（单位为小时），并四舍五入到四位有效数字。", "solution": "设 $X_{1},\\dots,X_{n}\\stackrel{\\text{iid}}{\\sim}\\mathcal{N}(\\mu,\\sigma^{2})$，其中 $\\mu$ 和 $\\sigma^{2}$ 均未知，并设 $X_{n+1}$ 表示来自同一分布的单个未来观测值。精确的预测枢轴量为\n$$\nT=\\frac{X_{n+1}-\\bar{X}}{S\\sqrt{1+\\frac{1}{n}}}\\sim t_{n-1},\n$$\n其中 $\\bar{X}$ 是样本均值，$S^{2}$ 是无偏样本方差。因此，$X_{n+1}$ 的一个覆盖率为 $1-\\alpha$ 的双侧预测区间为\n$$\n\\bar{X}\\pm t_{1-\\frac{\\alpha}{2},\\,n-1}\\,S\\,\\sqrt{1+\\frac{1}{n}}.\n$$\n\n这里 $n=10$，数据为 $x=(48.5,\\,55.2,\\,46.1,\\,51.9,\\,43.8,\\,53.0,\\,49.7,\\,58.1,\\,44.5,\\,49.2)$。\n\n计算样本均值：\n$$\n\\sum_{i=1}^{10}x_{i}=500.0,\\quad \\bar{x}=\\frac{500.0}{10}=50.0.\n$$\n\n计算无偏样本方差：\n$$\nS^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}=\\frac{1}{9}\\left[(48.5-50.0)^{2}+(55.2-50.0)^{2}+\\cdots+(49.2-50.0)^{2}\\right].\n$$\n离差平方为\n$$\n2.25,\\;27.04,\\;15.21,\\;3.61,\\;38.44,\\;9.00,\\;0.09,\\;65.61,\\;30.25,\\;0.64,\n$$\n其总和为 $192.14$。因此\n$$\nS^{2}=\\frac{192.14}{9}\\approx 21.3488888889,\\qquad S=\\sqrt{21.3488888889}\\approx 4.6204858.\n$$\n\n对于覆盖率为 $0.90$ 的双侧预测区间，取 $\\alpha=0.10$，自由度为 $n-1=9$，所以\n$$\nt_{1-\\frac{\\alpha}{2},\\,9}=t_{0.95,\\,9}\\approx 1.8331129327.\n$$\n此外，\n$$\n\\sqrt{1+\\frac{1}{n}}=\\sqrt{1+\\frac{1}{10}}=\\sqrt{\\frac{11}{10}}\\approx 1.0488088482.\n$$\n\n预测区间的边际误差为\n$$\nM=t_{0.95,\\,9}\\,S\\,\\sqrt{1+\\frac{1}{n}}\\approx 1.8331129327\\times 4.6204858\\times 1.0488088482\\approx 8.883276985.\n$$\n因此，单个新电池寿命的 $0.90$ 预测区间是\n$$\n\\bar{x}\\pm M=50.0\\pm 8.883276985,\n$$\n即，\n$$\n\\left(50.0-8.883276985,\\;50.0+8.883276985\\right)=(41.116723015,\\;58.883276985).\n$$\n\n将每个端点四舍五入到四位有效数字，得到 $41.12$ 和 $58.88$（单位为小时）。", "answer": "$$\\boxed{\\begin{pmatrix}41.12  58.88\\end{pmatrix}}$$", "id": "1945989"}, {"introduction": "在许多科学研究中，我们更关心的是如何利用一个变量来预测另一个变量。这个练习将预测区间的概念扩展到了简单线性回归的框架中。你将学会如何为一个具有特定自变量值的新个体，预测其因变量的范围，并理解预测的不确定性是如何受到新观测点与数据中心距离的影响的[@problem_id:1945976]。", "problem": "一位政治学家进行了一项研究，以检验个人教育水平与其在标准化政治容忍度量表上的得分之间可能存在的线性关系。政治容忍度得分记为 $y$，范围从 0 到 150。正规教育年数记为 $x$。对从 $n=50$ 名个体样本中收集的数据进行了简单线性回归分析。分析的汇总统计数据如下：\n\n-   样本量：$n = 50$\n-   估计回归线：$\\hat{y} = 15.0 + 4.2x$\n-   预测变量（教育）的均值：$\\bar{x} = 13.5$ 年\n-   预测变量的离差平方和：$S_{xx} = \\sum_{i=1}^{n} (x_i - \\bar{x})^2 = 250.0$\n-   残差标准误（估计的标准误）：$s_e = 8.5$\n\n利用这些信息，计算一个受过 $x_0 = 16$ 年正规教育的新个体的政治容忍度得分的 90% 预测区间。在您的计算中，您可以使用自由度为 48 的 t 分布的临界值，即 $t_{0.05, 48} = 1.677$。\n\n按顺序提供预测区间的下界和上界，作为一对数字。将您的最终答案四舍五入到三位有效数字。", "solution": "我们通过简单线性回归 $\\hat{y}=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x$ 将政治容忍度得分 $y$ 建模为教育年数 $x$ 的线性函数。对于一个 $x_{0}$ 处的新个体，点预测为 $\\hat{y}_{0}=\\hat{\\beta}_{0}+\\hat{\\beta}_{1}x_{0}$，新观测值的双侧 $(1-\\alpha)$ 预测区间由下式给出：\n$$\n\\hat{y}_{0}\\ \\pm\\ t_{\\alpha/2,\\ n-2}\\ s_{e}\\ \\sqrt{1+\\frac{1}{n}+\\frac{(x_{0}-\\bar{x})^{2}}{S_{xx}}}.\n$$\n这里，$n=50$，$x_{0}=16$，$\\bar{x}=13.5$，$S_{xx}=250.0$，$s_{e}=8.5$，且 $t_{0.05,48}=1.677$。\n\n首先计算点预测：\n$$\n\\hat{y}_{0}=15.0+4.2\\times 16=15.0+67.2=82.2.\n$$\n接下来计算平方根内的标准误差因子：\n$$\n1+\\frac{1}{n}+\\frac{(x_{0}-\\bar{x})^{2}}{S_{xx}}=1+\\frac{1}{50}+\\frac{(16-13.5)^{2}}{250}=1+0.02+\\frac{2.5^{2}}{250}=1+0.02+\\frac{6.25}{250}=1+0.02+0.025=1.045.\n$$\n因此\n$$\ns_{e}\\sqrt{1+\\frac{1}{n}+\\frac{(x_{0}-\\bar{x})^{2}}{S_{xx}}}=8.5\\sqrt{1.045}\\approx 8.5\\times 1.02225\\approx 8.689125.\n$$\n误差范围是\n$$\nt_{0.05,48}\\times 8.689125=1.677\\times 8.689125\\approx 14.571662625.\n$$\n因此，90% 的预测区间是\n$$\n82.2\\pm 14.571662625,\n$$\n这给出了下界和上界\n$$\n82.2-14.571662625\\approx 67.628337375,\\quad 82.2+14.571662625\\approx 96.771662625.\n$$\n四舍五入到三位有效数字得到 $67.6$ 和 $96.8$。", "answer": "$$\\boxed{\\begin{pmatrix}67.6  96.8\\end{pmatrix}}$$", "id": "1945976"}, {"introduction": "为了更深入地理解预测区间的性质，我们来做一个理论推导练习。这个练习要求你比较预测单个未来观测值与预测多个未来观测值均值的区间宽度，这有助于揭示预测误差的两个来源：模型参数的不确定性和数据本身的内在变异。通过推导这个比率，你将从数学上理解为什么预测一个平均值比预测一个单独的值更为精确[@problem_id:1946001]。", "problem": "一个材料科学研究团队正在分析一种新开发的陶瓷复合材料的抗压强度。抗压强度以兆帕（MPa）为单位，假定其为一个服从正态分布的随机变量，其均值 $\\mu$ 和方差 $\\sigma^2$ 未知。该团队对 $n$ 个陶瓷样本进行了一项初步实验，得到了样本均值 $\\bar{x}$ 和样本标准差 $s$。\n\n首先，该团队为单个随机抽取的新样本的抗压强度构建了一个 $100(1-\\alpha)\\%$ 的预测区间。设该区间的宽度为 $W_1$。\n\n为了提高预测的精度，该团队决定生产第二批共 $m$ 个新样本。他们的目标是通过构建一个新的 $100(1-\\alpha)\\%$ 预测区间来预测这批 $m$ 个新样本的*平均*抗压强度。设这第二个区间的宽度为 $W_m$。\n\n假设最初的 $n$ 个样本和未来的 $m$ 个样本都来自同一个正态分布，求比值 $\\frac{W_m}{W_1}$。你的最终答案应该是一个用 $n$ 和 $m$ 表示的单一闭式解析表达式。", "solution": "设 $X_{1},\\dots,X_{n} \\sim \\mathcal{N}(\\mu,\\sigma^{2})$ 为初始样本，其样本均值为 $\\bar{X}$，样本标准差为 $S$。对于来自同一分布的单个未来观测值 $Y$，利用 $(\\bar{X},S)$ 和 $Y$ 的独立性以及正态性，可以注意到 $Y-\\mu \\sim \\mathcal{N}(0,\\sigma^{2})$，$\\bar{X}-\\mu \\sim \\mathcal{N}(0,\\sigma^{2}/n)$，以及 $Y-\\bar{X} \\sim \\mathcal{N}\\!\\left(0,\\sigma^{2}\\left(1+\\frac{1}{n}\\right)\\right)$。因为 $(n-1)S^{2}/\\sigma^{2} \\sim \\chi^{2}_{n-1}$ 且 $S$ 与 $Y-\\bar{X}$ 独立，所以枢轴量\n$$\n\\frac{Y-\\bar{X}}{S\\sqrt{1+\\frac{1}{n}}} \\sim t_{n-1}.\n$$\n因此，$Y$ 的一个对称的 $100(1-\\alpha)\\%$ 预测区间为\n$$\n\\bar{X} \\pm t_{n-1,1-\\alpha/2}\\, S \\sqrt{1+\\frac{1}{n}},\n$$\n所以其宽度为\n$$\nW_{1}=2\\, t_{n-1,1-\\alpha/2}\\, S \\sqrt{1+\\frac{1}{n}}.\n$$\n\n对于与初始样本独立的 $m$ 个未来观测值 $Y_{1},\\dots,Y_{m} \\sim \\mathcal{N}(\\mu,\\sigma^{2})$，设 $\\bar{Y}_{m}$ 表示它们的均值。那么 $\\bar{Y}_{m}-\\mu \\sim \\mathcal{N}\\!\\left(0,\\frac{\\sigma^{2}}{m}\\right)$，$\\bar{X}-\\mu \\sim \\mathcal{N}\\!\\left(0,\\frac{\\sigma^{2}}{n}\\right)$，并且 $\\bar{Y}_{m}-\\bar{X} \\sim \\mathcal{N}\\!\\left(0,\\sigma^{2}\\left(\\frac{1}{m}+\\frac{1}{n}\\right)\\right)$。在 $S$ 独立且 $(n-1)S^{2}/\\sigma^{2} \\sim \\chi^{2}_{n-1}$ 的条件下，枢轴量\n$$\n\\frac{\\bar{Y}_{m}-\\bar{X}}{S\\sqrt{\\frac{1}{m}+\\frac{1}{n}}} \\sim t_{n-1}.\n$$\n因此，$\\bar{Y}_{m}$ 的一个 $100(1-\\alpha)\\%$ 预测区间为\n$$\n\\bar{X} \\pm t_{n-1,1-\\alpha/2}\\, S \\sqrt{\\frac{1}{m}+\\frac{1}{n}},\n$$\n并且其宽度为\n$$\nW_{m}=2\\, t_{n-1,1-\\alpha/2}\\, S \\sqrt{\\frac{1}{m}+\\frac{1}{n}}.\n$$\n\n求二者之比，\n$$\n\\frac{W_{m}}{W_{1}}=\\frac{2\\, t_{n-1,1-\\alpha/2}\\, S \\sqrt{\\frac{1}{m}+\\frac{1}{n}}}{2\\, t_{n-1,1-\\alpha/2}\\, S \\sqrt{1+\\frac{1}{n}}}\n=\\sqrt{\\frac{\\frac{1}{m}+\\frac{1}{n}}{1+\\frac{1}{n}}}\n=\\sqrt{\\frac{\\frac{n+m}{mn}}{\\frac{n+1}{n}}}\n=\\sqrt{\\frac{n+m}{m(n+1)}}.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{n+m}{m(n+1)}}}$$", "id": "1946001"}]}