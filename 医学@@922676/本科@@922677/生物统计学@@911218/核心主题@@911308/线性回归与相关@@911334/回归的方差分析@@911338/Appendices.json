{"hands_on_practices": [{"introduction": "方差分析（ANOVA）表是回归分析的核心，它清晰地展示了响应变量的总变异如何被模型解释和未被解释的部分所瓜分。这项练习将帮助你熟悉方差分析表的基本结构，并掌握其核心计算。通过一个简单的线性回归场景，你将利用已知的平方和（$SST$、$SSR$）与自由度信息，亲手计算出用于检验模型整体显著性的 $F$ 统计量 [@problem_id:1895430]。", "problem": "一位农业科学家正在研究施用于土壤的新型营养补充剂的用量与特定植物物种后续高度之间的关系。一个简单线性回归模型被拟合到收集的数据上，用以根据补充剂的用量预测植物高度。\n\n拟合模型后，统计分析得出以下量值：\n- 总平方和（$SST$），衡量植物高度的总方差，计算得出为 $100.0$。\n- 回归平方和（$SSR$），代表由回归模型解释的植物高度变异，计算得出为 $40.0$。\n- 该分析基于的样本容量使得误差（残差）项的自由度为 $df_E = 10$。\n\n根据方差分析（ANOVA）的这些结果，计算用于检验简单线性回归模型整体显著性的 F统计量。将您的答案表示为一个四舍五入到三位有效数字的数值。", "solution": "在具有一个预测变量和截距的简单线性回归中，方差分析（ANOVA）将总变异分解为 $SST = SSR + SSE$。因此，误差平方和为\n$$\nSSE = SST - SSR.\n$$\n回归均方和误差均方定义为\n$$\nMSR = \\frac{SSR}{df_{R}}, \\quad MSE = \\frac{SSE}{df_{E}},\n$$\n而总体的 F统计量为\n$$\nF = \\frac{MSR}{MSE} = \\frac{\\frac{SSR}{df_{R}}}{\\frac{SSE}{df_{E}}}.\n$$\n对于简单线性回归，$df_{R} = 1$。使用给定值 $SST = 100.0$、$SSR = 40.0$ 和 $df_{E} = 10$ 进行计算\n$$\nSSE = 100.0 - 40.0 = 60.0,\n$$\n$$\nMSR = \\frac{40.0}{1} = 40.0, \\quad MSE = \\frac{60.0}{10} = 6.0,\n$$\n因此\n$$\nF = \\frac{40.0}{6.0} = 6.\\overline{6}.\n$$\n四舍五入到三位有效数字，F统计量为 $6.67$。", "answer": "$$\\boxed{6.67}$$", "id": "1895430"}, {"introduction": "统计软件能为我们自动计算方差分析中的各项指标，但深刻的理解往往源于亲手实践。这个练习将带你深入幕后，从一个具体的生物统计学数据集出发，一步步计算总平方和（$SST$）、回归平方和（$SSR$）和误差平方和（$SSE$）。通过这个过程，你不仅能具体地理解这些统计量如何量化数据中的变异，还能亲手验证方差分析的基本恒等式 $SST = SSR + SSE$ [@problem_id:4893782]。", "problem": "一位生物统计学家正在研究一个关于连续健康结果对膳食暴露的简单线性回归模型。设计矩阵 $X$ 包括一个截距项和一个连续预测变量 $x$。对于 $n=5$ 名受试者，预测变量值和观测结果如下：\n$$\nx = \\begin{pmatrix}0  1  2  3  4\\end{pmatrix}, \\quad y = \\begin{pmatrix}2.2  3.5  5.3  6.7  8.0\\end{pmatrix}.\n$$\n假设使用常规的固定设计线性模型 $y = X\\beta + \\varepsilon$，该模型包含一个截距项和一个预测变量，并通过普通最小二乘法 (OLS) 拟合模型。使用回归的方差分析 (ANOVA) 框架，从该数据集中明确计算总平方和 (SST)、回归平方和 (SSR) 和误差平方和 (SSE)，并用数值验证分解式 $\\,\\text{SST} = \\text{SSR} + \\text{SSE}\\,$ 成立。将您报告的三个平方和四舍五入到四位有效数字。以行向量的形式 $\\big(\\text{SST},\\,\\text{SSR},\\,\\text{SSE}\\big)$ 表达您的最终答案。", "solution": "## 解\n\n本题要求计算简单线性回归分析中的方差组成部分：总平方和 (SST)、回归平方和 (SSR) 和误差平方和 (SSE)。模型由 $y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i$ 给出，其中 $i=1, \\dots, n$。\n\n首先，我们计算预测变量 $x$ 和结果 $y$ 的样本均值。样本量为 $n=5$。\n\n预测变量值的总和是：\n$$ \\sum_{i=1}^5 x_i = 0 + 1 + 2 + 3 + 4 = 10 $$\n预测变量的均值是：\n$$ \\bar{x} = \\frac{1}{n} \\sum_{i=1}^5 x_i = \\frac{10}{5} = 2 $$\n\n结果值的总和是：\n$$ \\sum_{i=1}^5 y_i = 2.2 + 3.5 + 5.3 + 6.7 + 8.0 = 25.7 $$\n结果的均值是：\n$$ \\bar{y} = \\frac{1}{n} \\sum_{i=1}^5 y_i = \\frac{25.7}{5} = 5.14 $$\n\n**1. 总平方和 (SST)**\nSST 衡量结果变量 $y$ 的总变异性。它定义为每个观测值与其样本均值 $\\bar{y}$ 之差的平方和。\n$$ \\text{SST} = \\sum_{i=1}^n (y_i - \\bar{y})^2 $$\n使用给定数据：\n$$ \\text{SST} = (2.2 - 5.14)^2 + (3.5 - 5.14)^2 + (5.3 - 5.14)^2 + (6.7 - 5.14)^2 + (8.0 - 5.14)^2 $$\n$$ \\text{SST} = (-2.94)^2 + (-1.64)^2 + (0.16)^2 + (1.56)^2 + (2.86)^2 $$\n$$ \\text{SST} = 8.6436 + 2.6896 + 0.0256 + 2.4336 + 8.1796 = 21.972 $$\n\n**2. 普通最小二乘法 (OLS) 估计**\n要计算 SSR 和 SSE，我们必须首先通过 OLS 拟合回归线 $\\hat{y} = \\hat{\\beta}_0 + \\hat{\\beta}_1 x$。斜率 ($\\hat{\\beta}_1$) 和截距 ($\\hat{\\beta}_0$) 的估计量是：\n$$ \\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2} = \\frac{S_{xy}}{S_{xx}} $$\n$$ \\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x} $$\n首先，我们计算 $S_{xx}$ 和 $S_{xy}$：\n$$ S_{xx} = (0-2)^2 + (1-2)^2 + (2-2)^2 + (3-2)^2 + (4-2)^2 = (-2)^2 + (-1)^2 + 0^2 + 1^2 + 2^2 = 4 + 1 + 0 + 1 + 4 = 10 $$\n$$ S_{xy} = (0-2)(2.2-5.14) + (1-2)(3.5-5.14) + (2-2)(5.3-5.14) + (3-2)(6.7-5.14) + (4-2)(8.0-5.14) $$\n$$ S_{xy} = (-2)(-2.94) + (-1)(-1.64) + (0)(0.16) + (1)(1.56) + (2)(2.86) = 5.88 + 1.64 + 0 + 1.56 + 5.72 = 14.8 $$\n现在我们可以计算系数：\n$$ \\hat{\\beta}_1 = \\frac{14.8}{10} = 1.48 $$\n$$ \\hat{\\beta}_0 = 5.14 - (1.48)(2) = 5.14 - 2.96 = 2.18 $$\n拟合的回归方程是 $\\hat{y}_i = 2.18 + 1.48 x_i$。\n\n**3. 预测值和残差**\n使用拟合方程，我们求出预测值 ($\\hat{y}_i$) 和残差 ($e_i = y_i - \\hat{y}_i$)：\n- 对于 $x_1=0$: $\\hat{y}_1 = 2.18 + 1.48(0) = 2.18$。残差 $e_1 = 2.2 - 2.18 = 0.02$。\n- 对于 $x_2=1$: $\\hat{y}_2 = 2.18 + 1.48(1) = 3.66$。残差 $e_2 = 3.5 - 3.66 = -0.16$。\n- 对于 $x_3=2$: $\\hat{y}_3 = 2.18 + 1.48(2) = 5.14$。残差 $e_3 = 5.3 - 5.14 = 0.16$。\n- 对于 $x_4=3$: $\\hat{y}_4 = 2.18 + 1.48(3) = 6.62$。残差 $e_4 = 6.7 - 6.62 = 0.08$。\n- 对于 $x_5=4$: $\\hat{y}_5 = 2.18 + 1.48(4) = 8.10$。残差 $e_5 = 8.0 - 8.10 = -0.10$。\n\n**4. 回归平方和 (SSR)**\nSSR 衡量由回归模型解释的变异性。它是预测值与观测值均值之差的平方和。\n$$ \\text{SSR} = \\sum_{i=1}^n (\\hat{y}_i - \\bar{y})^2 $$\n使用计算出的值：\n$$ \\text{SSR} = (2.18 - 5.14)^2 + (3.66 - 5.14)^2 + (5.14 - 5.14)^2 + (6.62 - 5.14)^2 + (8.10 - 5.14)^2 $$\n$$ \\text{SSR} = (-2.96)^2 + (-1.48)^2 + 0^2 + (1.48)^2 + (2.96)^2 $$\n$$ \\text{SSR} = 8.7616 + 2.1904 + 0 + 2.1904 + 8.7616 = 21.904 $$\n\n**5. 误差平方和 (SSE)**\nSSE 衡量模型未解释的变异性（残差变异性）。它是残差的平方和。\n$$ \\text{SSE} = \\sum_{i=1}^n (y_i - \\hat{y}_i)^2 = \\sum_{i=1}^n e_i^2 $$\n使用计算出的残差：\n$$ \\text{SSE} = (0.02)^2 + (-0.16)^2 + (0.16)^2 + (0.08)^2 + (-0.10)^2 $$\n$$ \\text{SSE} = 0.0004 + 0.0256 + 0.0256 + 0.0064 + 0.0100 = 0.068 $$\n\n**6. 分解的验证**\n回归的方差分析的基本恒等式是 $\\text{SST} = \\text{SSR} + \\text{SSE}$。我们用计算出的值进行数值验证：\n$$ \\text{SSR} + \\text{SSE} = 21.904 + 0.068 = 21.972 $$\n这个值与我们计算的 SST 完全相同，因此恒等式 $\\text{SST} = \\text{SSR} + \\text{SSE}$ 得到证实。\n\n**7. 最终答案的构建**\n问题要求 SST、SSR 和 SSE 的值四舍五入到四位有效数字。\n- $\\text{SST} = 21.972 \\approx 21.97$\n- $\\text{SSR} = 21.904 \\approx 21.90$\n- $\\text{SSE} = 0.06800$ (保留四位有效数字)\n\n最终答案以行向量 $(\\text{SST}, \\text{SSR}, \\text{SSE})$ 的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n21.97  21.90  0.06800\n\\end{pmatrix}\n}\n$$", "id": "4893782"}, {"introduction": "简单的线性回归模型是分析的起点，但真实的生物学数据常常展现出更复杂的模式，例如非线性关系或异方差性。这项练习展示了方差分析框架在处理复杂模型时的强大功能与灵活性。你将面对一个初始模型不适用的情景，并探索如何通过数据变换和引入多项式（二次）项来改进模型，最终利用方差分析的原理来评估这个更复杂模型的显著性 [@problem_id:4893869]。", "problem": "一个生物统计学团队研究了连续剂量变量 $x$ 与非负响应 $y$ 之间的关系，其中 $y$ 代表 $n=20$ 只动物组织学图像中每个视野的酶聚集体计数。拟合了一个初始的简单线性回归模型 $y_i=\\beta_0+\\beta_1 x_i+\\varepsilon_i$。对于这个初始拟合，获得了以下汇总统计量：\n- 关于均值的总平方和：$\\sum_{i=1}^{n}(y_i-\\bar{y})^2 = 520$。\n- 回归平方和：$\\sum_{i=1}^{n}(\\hat{y}_i-\\bar{y})^2 = 120$。\n- 误差平方和：$\\sum_{i=1}^{n}(y_i-\\hat{y}_i)^2 = 400$。\n\n诊断图显示出明显的曲率和随拟合均值增大的方差，表明线性和同方差性的假设被违反。受计数型响应的近似方差稳定化方法的启发，该团队应用了平方根变换 $z_i=\\sqrt{y_i}$ 并将均值函数扩展为关于 $x$ 的二次函数：\n$$\nz_i=\\gamma_0+\\gamma_1 x_i+\\gamma_2 x_i^2+\\varepsilon_i',\n$$\n其中 $\\varepsilon_i'$ 是在变换尺度上具有恒定方差的独立误差。\n\n对于变换后的二次模型，团队报告了：\n- 关于变换后均值的总平方和：$\\sum_{i=1}^{n}(z_i-\\bar{z})^2 = 49.98$。\n- 序贯回归平方和：在仅含截距项的模型中加入 $x$ 时为 $14.04$；在模型中已有 $x$ 的情况下加入 $x^2$ 时为 $22.68$。因此，总回归平方和为 $36.72$。\n- 误差平方和：$\\sum_{i=1}^{n}(z_i-\\hat{z}_i)^2 = 13.26$。\n\n假设回归的方差分析的标准条件在每个尺度上都适用：特别是在相关尺度上，误差独立、具有恒定方差且服从正态分布。使用回归平方和、误差平方和、均方以及用于检验所有斜率系数均为零的 $F$ 统计量的核心定义，完成以下任务：\n- 确定初始线性模型和变换后二次模型中回归、误差和总的自由度，并口头陈述相应的方差分析分解（各组成部分及其自由度）。\n- 使用变换后的二次模型，计算用于检验 $H_0:\\gamma_1=\\gamma_2=0$ 相对于一般备择假设的 $F$ 统计量。\n\n将最终数值答案四舍五入到四位有效数字。不需要单位。", "solution": "该问题要求对两种不同的回归模型进行方差分析（ANOVA）。任务的第一部分是确定每个模型的自由度（$df$）并陈述相应的方差分析分解。第二部分是计算第二个模型的总体 $F$ 统计量。\n\n根据本文中定义的约定，对于一个包含 $k$ 个参数（包括截距项）并基于 $n$ 个观测值的线性回归模型，自由度的分解如下：\n- 总自由度为 $df_{Total} = n - 1$。\n- 回归自由度为 $df_{Reg} = k - 1$。\n- 误差（或残差）自由度为 $df_{Error} = n - k$。\n一个基本恒等式是 $df_{Total} = df_{Reg} + df_{Error}$。\n\n**初始简单线性模型的分析**\n第一个模型是简单线性回归 $y_i=\\beta_0+\\beta_1 x_i+\\varepsilon_i$。\n给定样本量为 $n=20$。\n这个模型有两个参数（$\\beta_0, \\beta_1$），因此 $k=2$。\n现在我们可以计算该模型的自由度：\n- $df_{Total} = n - 1 = 20 - 1 = 19$。\n- $df_{Reg} = k - 1 = 2 - 1 = 1$。\n- $df_{Error} = n - k = 20 - 2 = 18$。\n该模型的方差分析分解的口头陈述如下：具有 $19$ 个自由度的总平方和（$SSTO = \\sum_{i=1}^{n}(y_i-\\bar{y})^2 = 520$）被分解为具有 $1$ 个自由度的回归平方和（$SSR = \\sum_{i=1}^{n}(\\hat{y}_i-\\bar{y})^2 = 120$）和具有 $18$ 个自由度的误差平方和（$SSE = \\sum_{i=1}^{n}(y_i-\\hat{y}_i)^2 = 400$）。\n\n**变换后二次模型的分析**\n第二个模型是关于变换后响应的二次回归：$z_i=\\gamma_0+\\gamma_1 x_i+\\gamma_2 x_i^2+\\varepsilon_i'$。\n样本量仍然是 $n=20$。\n这个模型包含三个参数（$\\gamma_0, \\gamma_1, \\gamma_2$），因此 $k=3$。\n该模型的自由度（用撇号表示以作区分）为：\n- $df'_{Total} = n - 1 = 20 - 1 = 19$。\n- $df'_{Reg} = k - 1 = 3 - 1 = 2$。\n- $df'_{Error} = n - k = 20 - 3 = 17$。\n该模型的方差分析分解的口头陈述为：在变换尺度上，具有 $19$ 个自由度的总平方和（$SSTO' = \\sum_{i=1}^{n}(z_i-\\bar{z})^2 = 49.98$）被分解为具有 $2$ 个自由度的回归平方和（$SSR' = 36.72$）和具有 $17$ 个自由度的误差平方和（$SSE' = \\sum_{i=1}^{n}(z_i-\\hat{z}_i)^2 = 13.26$）。\n\n**变换后模型的 F 统计量计算**\n任务是计算用于检验原假设 $H_0: \\gamma_1 = \\gamma_2 = 0$ 的 $F$ 统计量。这是检验回归模型显著性的总体 $F$ 检验。$F$ 统计量定义为回归均方（$MSR'$）与误差均方（$MSE'$）的比值。\n\n首先，我们计算回归均方：\n$$\nMSR' = \\frac{SSR'}{df'_{Reg}}\n$$\n使用给定的平方和 $SSR' = 36.72$ 和计算出的自由度 $df'_{Reg} = 2$：\n$$\nMSR' = \\frac{36.72}{2} = 18.36\n$$\n\n接下来，我们计算误差均方：\n$$\nMSE' = \\frac{SSE'}{df'_{Error}}\n$$\n使用给定的平方和 $SSE' = 13.26$ 和计算出的自由度 $df'_{Error} = 17$：\n$$\nMSE' = \\frac{13.26}{17}\n$$\n\n最后，$F$ 统计量是这两个均方的比值：\n$$\nF = \\frac{MSR'}{MSE'} = \\frac{18.36}{\\frac{13.26}{17}} = \\frac{18.36 \\times 17}{13.26} = \\frac{312.12}{13.26} \\approx 23.5384615\n$$\n问题要求将最终答案四舍五入到四位有效数字。这得到 $23.54$。", "answer": "$$\\boxed{23.54}$$", "id": "4893869"}]}