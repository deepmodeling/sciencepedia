{"hands_on_practices": [{"introduction": "生物统计学中的一个核心任务是评估两个分类变量之间是否存在关联。皮尔逊卡方检验为我们提供了一个强大的工具，用以检验观测到的关联是否具有统计学意义，还是仅仅由随机抽样变异引起。通过此练习，您将亲手计算卡方统计量，这是分析列联表和检验独立性假设的一项基本技能。[@problem_id:4920920]", "problem": "一项队列研究在一个基于人群的成年人样本中，检验了三水平种系变异状态与三阶段疾病状态之间的关联。令 $G \\in \\{G_{0}, G_{1}, G_{2}\\}$ 表示基因型类别（无、杂合、纯合风险），令 $S \\in \\{S_{0}, S_{1}, S_{2}\\}$ 表示疾病状态（无疾病、临床前期、临床期）。该研究记录了以下列联计数 $n_{ij}$，其中 $i$ 表示基因型类别，$j$ 表示疾病状态：\n- 对于 $G_{0}$：在 $(S_{0}, S_{1}, S_{2})$ 上的计数为 $(98, 35, 17)$。\n- 对于 $G_{1}$：在 $(S_{0}, S_{1}, S_{2})$ 上的计数为 $(72, 43, 35)$。\n- 对于 $G_{2}$：在 $(S_{0}, S_{1}, S_{2})$ 上的计数为 $(30, 28, 62)$。\n\n仅使用联合概率 $p_{ij}$、边际概率 $p_{i+}$ 和 $p_{+j}$ 的核心定义，以及独立性定义 $p_{ij} = p_{i+} p_{+j}$，为整个 $3 \\times 3$ 表格构建 $G$ 和 $S$之间独立性的大样本 Pearson 卡方检验（即，不对任何协变量进行条件限制）。具体来说，根据经验边际分布推导独立性模型下每个单元格的期望计数，然后通过比较观测计数与这些期望计数来计算 Pearson 卡方检验统计量。\n\n该表格的 Pearson 卡方检验统计量的数值是多少？将您的答案四舍五入到四位有效数字。", "solution": "首先验证问题，以确保其科学基础扎实、提法恰当、客观且完整。\n\n**步骤1：提取已知信息**\n-   基因型变量 $G \\in \\{G_{0}, G_{1}, G_{2}\\}$。\n-   疾病状态变量 $S \\in \\{S_{0}, S_{1}, S_{2}\\}$。\n-   列联计数 $n_{ij}$，其中 $i \\in \\{0, 1, 2\\}$ 表示基因型，$j \\in \\{0, 1, 2\\}$ 表示疾病状态。\n-   $G_{0}$ 的计数：$(n_{00}, n_{01}, n_{02}) = (98, 35, 17)$。\n-   $G_{1}$ 的计数：$(n_{10}, n_{11}, n_{12}) = (72, 43, 35)$。\n-   $G_{2}$ 的计数：$(n_{20}, n_{21}, n_{22}) = (30, 28, 62)$。\n-   任务：构建 $G$ 和 $S$ 之间独立性的 Pearson 卡方检验统计量。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题是生物统计学中涉及列联表分析的标准练习。所提供的数据由整数计数组成，这在当前情境下是合适的。该任务要求应用基本的统计学定义：联合概率和边际概率、独立性以及 Pearson 卡方统计量的公式。该问题是自洽的、科学上合理的且提法恰当。没有矛盾、歧义或违反科学原则之处。\n\n**步骤3：结论与行动**\n问题有效。将提供完整的解答。\n\n**解题过程**\n\n该问题要求计算一个 $3 \\times 3$ 观测计数列联表的 Pearson 卡方统计量。首先，我们将给定的计数（记为 $O_{ij}$）整理成一个表格，并计算边际总和。设 $i$ 为行索引（代表基因型 $G$），$j$ 为列索引（代表疾病状态 $S$）。\n\n观测计数 $O_{ij}$ 的表格如下：\n$$\n\\begin{array}{c|ccc|c}\n  S_{0}  S_{1}  S_{2}  \\text{行总计 } (n_{i+}) \\\\\n\\hline\nG_{0}  98  35  17  150 \\\\\nG_{1}  72  43  35  150 \\\\\nG_{2}  30  28  62  120 \\\\\n\\hline\n\\text{列总计 } (n_{+j})  200  106  114  420\n\\end{array}\n$$\n行总计为：\n$n_{0+} = 98 + 35 + 17 = 150$\n$n_{1+} = 72 + 43 + 35 = 150$\n$n_{2+} = 30 + 28 + 62 = 120$\n\n列总计为：\n$n_{+0} = 98 + 72 + 30 = 200$\n$n_{+1} = 35 + 43 + 28 = 106$\n$n_{+2} = 17 + 35 + 62 = 114$\n\n受试者总数为 $N = 150 + 150 + 120 = 420$。\n\nPearson 卡方检验评估了零假设 $H_0$，即两个分类变量——基因型 $G$ 和疾病状态 $S$——是独立的。在此假设下，观察到一个个体在单元格 $(i, j)$ 中的联合概率是边际概率的乘积：$p_{ij} = p_{i+} p_{+j}$。\n\n我们从数据中估计这些边际概率：\n$\\hat{p}_{i+} = \\frac{n_{i+}}{N}$\n$\\hat{p}_{+j} = \\frac{n_{+j}}{N}$\n\n在独立性假设下，每个单元格 $(i, j)$ 的期望计数 $E_{ij}$ 计算如下：\n$$E_{ij} = N \\times \\hat{p}_{i+} \\times \\hat{p}_{+j} = N \\left( \\frac{n_{i+}}{N} \\right) \\left( \\frac{n_{+j}}{N} \\right) = \\frac{n_{i+} n_{+j}}{N}$$\n\n使用此公式，我们计算所有 $9$ 个单元格的期望计数：\n$E_{00} = \\frac{150 \\times 200}{420} = \\frac{30000}{420} = \\frac{500}{7} \\approx 71.429$\n$E_{01} = \\frac{150 \\times 106}{420} = \\frac{15900}{420} = \\frac{265}{7} \\approx 37.857$\n$E_{02} = \\frac{150 \\times 114}{420} = \\frac{17100}{420} = \\frac{285}{7} \\approx 40.714$\n\n$E_{10} = \\frac{150 \\times 200}{420} = \\frac{30000}{420} = \\frac{500}{7} \\approx 71.429$\n$E_{11} = \\frac{150 \\times 106}{420} = \\frac{15900}{420} = \\frac{265}{7} \\approx 37.857$\n$E_{12} = \\frac{150 \\times 114}{420} = \\frac{17100}{420} = \\frac{285}{7} \\approx 40.714$\n\n$E_{20} = \\frac{120 \\times 200}{420} = \\frac{24000}{420} = \\frac{400}{7} \\approx 57.143$\n$E_{21} = \\frac{120 \\times 106}{420} = \\frac{12720}{420} = \\frac{212}{7} \\approx 30.286$\n$E_{22} = \\frac{120 \\times 114}{420} = \\frac{13680}{420} = \\frac{228}{7} \\approx 32.571$\n\nPearson 卡方检验统计量，记为 $\\chi^2$，定义为观测计数与期望计数之差的平方，再除以期望计数，然后对所有单元格求和：\n$$\\chi^2 = \\sum_{i=0}^{2} \\sum_{j=0}^{2} \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}$$\n\n我们现在计算总和中的每一项：\n$(0,0)$ 项：$\\frac{(98 - 71.429)^2}{71.429} = \\frac{(26.571)^2}{71.429} \\approx 9.8846$\n$(0,1)$ 项：$\\frac{(35 - 37.857)^2}{37.857} = \\frac{(-2.857)^2}{37.857} \\approx 0.2156$\n$(0,2)$ 项：$\\frac{(17 - 40.714)^2}{40.714} = \\frac{(-23.714)^2}{40.714} \\approx 13.8125$\n\n$(1,0)$ 项：$\\frac{(72 - 71.429)^2}{71.429} = \\frac{(0.571)^2}{71.429} \\approx 0.0046$\n$(1,1)$ 项：$\\frac{(43 - 37.857)^2}{37.857} = \\frac{(5.143)^2}{37.857} \\approx 0.6987$\n$(1,2)$ 项：$\\frac{(35 - 40.714)^2}{40.714} = \\frac{(-5.714)^2}{40.714} \\approx 0.8020$\n\n$(2,0)$ 项：$\\frac{(30 - 57.143)^2}{57.143} = \\frac{(-27.143)^2}{57.143} \\approx 12.8929$\n$(2,1)$ 项：$\\frac{(28 - 30.286)^2}{30.286} = \\frac{(-2.286)^2}{30.286} \\approx 0.1725$\n$(2,2)$ 项：$\\frac{(62 - 32.571)^2}{32.571} = \\frac{(29.429)^2}{32.571} \\approx 26.5890$\n\n将这些项相加得到 $\\chi^2$ 统计量：\n$\\chi^2 \\approx 9.8846 + 0.2156 + 13.8125 + 0.0046 + 0.6987 + 0.8020 + 12.8929 + 0.1725 + 26.5890$\n$\\chi^2 \\approx 65.0724$\n\n问题要求将结果四舍五入到四位有效数字。数值 $65.0724$ 四舍五入到四位有效数字是 $65.07$。", "answer": "$$\\boxed{65.07}$$", "id": "4920920"}, {"introduction": "在探索变量间的关系时，简单的汇总分析有时会掩盖真相，甚至得出完全相反的结论。这个练习将引导您揭示著名的辛普森悖论，即在每个亚组中都存在的关联趋势，在数据合并后却可能消失或逆转。通过计算分层和边际比值比，您将深刻理解混杂因素如何扭曲关联性，以及为什么分层分析在因果推断中至关重要。[@problem_id:4920952]", "problem": "一项生物统计学中的观察性队列研究考察了一个二元暴露 $X \\in \\{0,1\\}$（其中 $X=1$ 表示接受治疗，$X=0$ 表示未接受治疗）、一个二元结局 $Y \\in \\{0,1\\}$（其中 $Y=1$ 表示康复，$Y=0$ 表示未康复）以及一个表示虚弱状态的二元测量混杂因素 $Z \\in \\{0,1\\}$（其中 $Z=0$ 表示低度虚弱，$Z=1$ 表示高度虚弱）。构建的联合频数旨在说明辛普森悖论，同时保持科学上的合理性。观察到的分层数据如下。\n\n在分层 $Z=0$（低度虚弱）中：\n- 在 $X=1$ 的人群中：$Y=1$ 的计数为 $9$，$Y=0$ 的计数为 $1$。\n- 在 $X=0$ 的人群中：$Y=1$ 的计数为 $80$，$Y=0$ 的计数为 $20$。\n\n在分层 $Z=1$（高度虚弱）中：\n- 在 $X=1$ 的人群中：$Y=1$ 的计数为 $30$，$Y=0$ 的计数为 $20$。\n- 在 $X=0$ 的人群中：$Y=1$ 的计数为 $5$，$Y=0$ 的计数为 $15$。\n\n仅使用联合概率、条件概率和边际概率的基本定义、全概率定律以及几率和比值比（OR）的定义，完成以下任务：\n\n- 任务 $1$：对于每个分层 $z \\in \\{0,1\\}$，计算比较 $X=1$ 与 $X=0$ 的层特异性比值比 $OR_{z}$，并验证 $OR_{z}>1$。\n- 任务 $2$：对 $Z$ 进行汇总，使用整个样本计算比较 $X=1$ 与 $X=0$ 的合并边际比值比，并确认尽管层特异性比值比都超过 $1$，但该值小于 $1$。\n- 任务 $3$：根据 $p(Z \\mid X)$ 如何通过全概率定律进入边际化过程，解释为什么合并关联的方向会发生逆转，而层内关联却没有，并讨论混杂情况下的因果解释。\n\n将任务 $2$ 中的合并边际比值比表示为精确分数；不要四舍五入。最终答案无需物理单位。", "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 二元暴露 $X \\in \\{0,1\\}$，其中 $X=1$ 表示接受治疗，$X=0$ 表示未接受治疗。\n- 二元结局 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示康复，$Y=0$ 表示未康复。\n- 二元混杂因素 $Z \\in \\{0,1\\}$，其中 $Z=0$ 表示低度虚弱，$Z=1$ 表示高度虚弱。\n- 分层 $Z=0$ 中的联合频数：\n  - $X=1, Y=1$ 的计数为 $9$。\n  - $X=1, Y=0$ 的计数为 $1$。\n  - $X=0, Y=1$ 的计数为 $80$。\n  - $X=0, Y=0$ 的计数为 $20$。\n- 分层 $Z=1$ 中的联合频数：\n  - $X=1, Y=1$ 的计数为 $30$。\n  - $X=1, Y=0$ 的计数为 $20$。\n  - $X=0, Y=1$ 的计数为 $5$。\n  - $X=0, Y=0$ 的计数为 $15$。\n- 任务 $1$：计算 $z \\in \\{0,1\\}$ 的层特异性比值比 $OR_{z}$，并验证 $OR_z > 1$。\n- 任务 $2$：计算合并边际比值比，并确认其小于 $1$。\n- 任务 $3$：根据 $p(Z \\mid X)$ 解释悖论性的逆转，并讨论因果解释。\n- 最终答案要求：任务 $2$ 中的合并边际比值比应为精确分数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题阐述了辛普森悖论，这是统计学和流行病学中一个公认的现象。变量及其关系（指征混杂）在生物统计学背景下是科学合理的。\n- **适定性：** 问题提供了执行所需计算的所有必要数据（联合频数计数）。任务定义清晰，几率和比值比的定义是标准的，确保了唯一且有意义的解。\n- **客观性：** 问题陈述使用了精确、客观和正式的语言，没有主观论断或歧义。\n- **结论：** 问题是自洽的、一致的且科学上合理的。判定为有效。\n\n### 解答\n令 $N(x,y,z)$ 表示暴露为 $X=x$、结局为 $Y=y$、混杂因素状态为 $Z=z$ 的受试者计数。所提供的数据可以整理成两个列联表，每个 $Z$ 的分层各一个。\n\n对于分层 $Z=0$（低度虚弱）：\n| | $Y=1$ (康复) | $Y=0$ (未康复) | 总计 |\n|---|---|---|---|\n| $X=1$ (治疗) | $9$ | $1$ | $10$ |\n| $X=0$ (未治疗) | $80$ | $20$ | $100$ |\n\n对于分层 $Z=1$（高度虚弱）：\n| | $Y=1$ (康复) | $Y=0$ (未康复) | 总计 |\n|---|---|---|---|\n| $X=1$ (治疗) | $30$ | $20$ | $50$ |\n| $X=0$ (未治疗) | $5$ | $15$ | $20$ |\n\n**任务 1：层特异性比值比**\n\n在特定分层 $z$ 内，对于给定的暴露水平 $x$，康复（$Y=1$）的几率定义为 $Odds(Y=1 \\mid X=x, Z=z) = \\frac{p(Y=1 \\mid X=x, Z=z)}{p(Y=0 \\mid X=x, Z=z)}$。由于在一个已定义的子组内，概率与频数成正比，我们可以直接使用计数：\n$$Odds(Y=1 \\mid X=x, Z=z) = \\frac{N(x,1,z)}{N(x,0,z)}$$\n层特异性比值比 $OR_z$ 比较了该层内治疗组（$X=1$）与未治疗组（$X=0$）的康复几率：\n$$OR_z = \\frac{Odds(Y=1 \\mid X=1, Z=z)}{Odds(Y=1 \\mid X=0, Z=z)} = \\frac{N(1,1,z) / N(1,0,z)}{N(0,1,z) / N(0,0,z)} = \\frac{N(1,1,z) \\cdot N(0,0,z)}{N(1,0,z) \\cdot N(0,1,z)}$$\n\n对于分层 $Z=0$（低度虚弱）：\n治疗组的康复几率为 $Odds(Y=1 \\mid X=1, Z=0) = \\frac{9}{1} = 9$。\n未治疗组的康复几率为 $Odds(Y=1 \\mid X=0, Z=0) = \\frac{80}{20} = 4$。\n层特异性比值比为：\n$$OR_0 = \\frac{9}{4} = 2.25$$\n按要求，$OR_0 = 2.25 > 1$。这表明，在低度虚弱的个体中，与不接受治疗相比，接受治疗与高出 $2.25$ 倍的康复几率相关联。\n\n对于分层 $Z=1$（高度虚弱）：\n治疗组的康复几率为 $Odds(Y=1 \\mid X=1, Z=1) = \\frac{30}{20} = \\frac{3}{2} = 1.5$。\n未治疗组的康复几率为 $Odds(Y=1 \\mid X=0, Z=1) = \\frac{5}{15} = \\frac{1}{3}$。\n层特异性比值比为：\n$$OR_1 = \\frac{3/2}{1/3} = \\frac{3}{2} \\cdot 3 = \\frac{9}{2} = 4.5$$\n按要求，$OR_1 = 4.5 > 1$。这表明，在高度虚弱的个体中，与不接受治疗相比，接受治疗与高出 $4.5$ 倍的康复几率相关联。在两个分层中，治疗都显示出益处。\n\n**任务 2：合并边际比值比**\n\n为了计算合并边际比值比，我们首先将各个 $Z$ 分层的数据进行汇总，以形成 $X$ 和 $Y$ 的边际列联表。\n- $N(X=1, Y=1) = N(1,1,0) + N(1,1,1) = 9 + 30 = 39$\n- $N(X=1, Y=0) = N(1,0,0) + N(1,0,1) = 1 + 20 = 21$\n- $N(X=0, Y=1) = N(0,1,0) + N(0,1,1) = 80 + 5 = 85$\n- $N(X=0, Y=0) = N(0,0,0) + N(0,0,1) = 20 + 15 = 35$\n\n汇总后的列联表如下：\n| | $Y=1$ (康复) | $Y=0$ (未康复) |\n|---|---|---|\n| $X=1$ (治疗) | $39$ | $21$ |\n| $X=0$ (未治疗) | $85$ | $35$ |\n\n合并边际比值比 $OR_{marginal}$ 由此汇总表计算得出：\n$$OR_{marginal} = \\frac{N(X=1,Y=1) \\cdot N(X=0,Y=0)}{N(X=1,Y=0) \\cdot N(X=0,Y=1)} = \\frac{39 \\cdot 35}{21 \\cdot 85}$$\n为了简化分数：\n$$OR_{marginal} = \\frac{(3 \\cdot 13) \\cdot (5 \\cdot 7)}{(3 \\cdot 7) \\cdot (5 \\cdot 17)} = \\frac{3 \\cdot 5 \\cdot 7 \\cdot 13}{3 \\cdot 5 \\cdot 7 \\cdot 17} = \\frac{13}{17}$$\n我们确认 $OR_{marginal} = \\frac{13}{17}  1$。这就是悖论所在：边际分析表明治疗与较低的康复几率相关，这与层特异性分析的结果直接矛盾。\n\n**任务 3：解释与因果推断**\n\n关联的逆转是辛普森悖论的一个标志，由混杂引起。在这里，虚弱状态（$Z$）是一个混杂因素，因为它既与暴露（治疗，$X$）相关，也与结局（康复，$Y$）相关。\n\n结局的边际概率是混杂因素各分层中条件概率的加权平均，由全概率定律描述：\n$$p(Y=y \\mid X=x) = \\sum_{z \\in \\{0,1\\}} p(Y=y \\mid X=x, Z=z) \\cdot p(Z=z \\mid X=x)$$\n悖论的产生是因为权重因子 $p(Z=z \\mid X=x)$ 对于治疗组（$X=1$）和未治疗组（$X=0$）有显著不同。\n\n我们来计算这些权重：\n- 对于治疗组（$X=1$），受试者总数为 $N(X=1) = 10 + 50 = 60$。\n  - $p(Z=1 \\mid X=1) = \\frac{N(X=1, Z=1)}{N(X=1)} = \\frac{50}{60} = \\frac{5}{6}$\n- 对于未治疗组（$X=0$），受试者总数为 $N(X=0) = 100 + 20 = 120$。\n  - $p(Z=1 \\mid X=0) = \\frac{N(X=0, Z=1)}{N(X=0)} = \\frac{20}{120} = \\frac{1}{6}$\n\n这显示了 $Z$ 和 $X$ 之间的强关联：治疗组主要由高度虚弱的个体组成（$p(Z=1|X=1) = 5/6$），而未治疗组主要由低度虚弱的个体组成（$p(Z=0|X=0) = 100/120 = 5/6$）。这是一个典型的“指征混杂”例子，即病情更重（虚弱程度更高）的患者更可能接受治疗。\n\n此外，虚弱状态与结局也密切相关。无论是否接受治疗，高度虚弱层（$Z=1$）的康复概率都远低于低度虚弱层（$Z=0$）。\n- $p(Y=1 \\mid X=1, Z=0) = 9/10 = 0.9$ 对比 $p(Y=1 \\mid X=1, Z=1) = 30/50 = 0.6$\n- $p(Y=1 \\mid X=0, Z=0) = 80/100 = 0.8$ 对比 $p(Y=1 \\mid X=0, Z=1) = 5/20 = 0.25$\n\n治疗组的边际康复概率 $p(Y=1 \\mid X=1)$ 是层特异性概率 $p(Y=1 \\mid X=1, Z=0)=0.9$ 和 $p(Y=1 \\mid X=1, Z=1)=0.6$ 的加权平均。由于治疗组主要为高度虚弱者，这个平均值更偏重于较低的概率（$0.6$），导致整体康复率较低：$p(Y=1 \\mid X=1) = (0.9)\\frac{1}{6} + (0.6)\\frac{5}{6} = 0.15 + 0.5 = 0.65$。\n\n相反，未治疗组的边际康复概率 $p(Y=1 \\mid X=0)$ 是 $p(Y=1 \\mid X=0, Z=0)=0.8$ 和 $p(Y=1 \\mid X=0, Z=1)=0.25$ 的加权平均。由于未治疗组主要为低度虚弱者，这个平均值更偏重于较高的概率（$0.8$），导致整体康复率较高：$p(Y=1 \\mid X=0) = (0.8)\\frac{5}{6} + (0.25)\\frac{1}{6} \\approx 0.708$。\n\n**因果推断：** 边际比值比（$OR_{marginal}   1$）不是治疗因果效应的有效估计。它因虚弱状态的混杂效应而产生偏倚。这种比较是不公平的，因为它将未接受治疗的健康人群与接受了治疗的虚弱人群合并在一起。分层比值比 $OR_0$ 和 $OR_1$ 通过将混杂因素保持恒定来控制它。由于两者都大于 $1$，它们表明治疗对低度虚弱和高度虚弱的患者都有益。因此，基于这些数据的因果结论是，该治疗是有效的。边际结果是一个统计学假象。", "answer": "$$\\boxed{\\frac{13}{17}}$$", "id": "4920952"}, {"introduction": "我们使用的每一个统计公式都建立在特定的数学定义和假设之上。这个练习挑战我们思考条件概率的边界情况：当我们试图以一个从未发生过的事件为条件时，会发生什么？通过分析一个包含零计数的列联表，您将探讨条件概率的定义在数据稀疏时的实际影响，并理解“正性假设”（positivity assumption）在统计建模中的重要性。[@problem_id:4920943]", "problem": "一项生物统计监测研究记录了一个具有三个类别 $i \\in \\{1,2,3\\}$ 的暴露变量 $X$ 和一个具有两个水平 $j \\in \\{0,1\\}$ 的二元结局 $Y$。观测到的双向列联表计数 $n_{ij}$ 如下：\n- $n_{10} = 36$, $n_{11} = 9$,\n- $n_{20} = 24$, $n_{21} = 6$,\n- $n_{30} = 0$, $n_{31} = 0$。\n\n设总样本量为 $N = 75$，因此经验联合概率为 $\\hat p_{ij} = n_{ij}/N$，经验行边缘概率为 $\\hat p_{i+} = \\sum_{j} \\hat p_{ij}$，经验列边缘概率为 $\\hat p_{+j} = \\sum_{i} \\hat p_{ij}$。根据列联表的联合概率、边缘概率和条件概率的标准定义，考虑当行边缘概率 $p_{i+}$ 等于 $0$ 时，条件概率 $P(Y=j \\mid X=i)$ 的状态。以上表为具体情境，判断下列哪些陈述是正确的。选择所有适用的选项。\n\nA. $P(Y=j \\mid X=3)$ 是未定义的，因为 $p_{3+} = 0$；条件概率的定义不允许以零概率事件为条件。在实践中，如果不引入外部建模假设、平滑处理或重新定义类别以确保概率为正，就无法进行以 $X=3$ 为条件的条件分析。\n\nB. 因为 $n_{3+} = 0$，正确的约定是对所有 $j$ 都有 $P(Y=j \\mid X=3) = 0$。通过这样的赋值，以 $X=3$ 为条件的条件分析仍然有效。\n\nC. 已定义分层的估计条件概率为 $P(Y=1 \\mid X=1) = 9/45$ 和 $P(Y=1 \\mid X=2) = 6/30$，并且根据分母为 $0$ 时比率的连续性，$P(Y=1 \\mid X=3) = 0$。\n\nD. 如果 $p_{i+} = 0$，那么对所有 $j$ 都有 $p_{ij} = 0$，因此 $P(Y=j \\mid X=i)$ 是未定义的。在基于模型的分析中（例如，逻辑回归或分层风险估计），如果没有约束、借用信息（borrowing strength）或先验信息，涉及 $X=i$ 的参数或分层特定风险是不可识别的；这是对正性（重叠）假设（positivity/overlap assumption）违反的一种表现。\n\nE. 零行边缘概率迫使 $P(Y=j \\mid X=i) = P(Y=j)$，因为以不可能事件为条件使分布保持不变，并且条件概率简化为边缘概率。", "solution": "用户希望我验证问题陈述，然后提供详细的解答。\n\n### 步骤1：提取已知条件\n- 一个暴露变量 $X$ 有三个类别，索引为 $i \\in \\{1, 2, 3\\}$。\n- 一个二元结局变量 $Y$ 有两个水平，索引为 $j \\in \\{0, 1\\}$。\n- 给出了观测计数 $n_{ij}$ 的双向列联表：\n  - $n_{10} = 36$, $n_{11} = 9$\n  - $n_{20} = 24$, $n_{21} = 6$\n  - $n_{30} = 0$, $n_{31} = 0$\n- 总样本量为 $N = 75$。\n- 经验联合概率定义为 $\\hat p_{ij} = n_{ij}/N$。\n- 经验行边缘概率定义为 $\\hat p_{i+} = \\sum_{j} \\hat p_{ij}$。\n- 经验列边缘概率定义为 $\\hat p_{+j} = \\sum_{i} \\hat p_{ij}$。\n- 问题的核心是，使用给定的数据作为具体示例，评估当相应的行边缘概率 $p_{i+}$ 为零时，条件概率 $P(Y=j \\mid X=i)$ 的状态。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述根据既定标准进行评估。\n\n- **科学基础**：该问题牢固地植根于基本概率论及其在生物统计学中的应用，特别是关于列联表的分析。该问题涉及条件概率的基本定义以及处理数据中零计数的实际问题，这是一个标准课题。所涉及的原理在科学上是合理的。\n- **良置性**：该问题是良置的。它提供了分析情况所需的所有数据和定义。数据是内部一致的：所提供计数的总和为 $n_{10} + n_{11} + n_{20} + n_{21} + n_{30} + n_{31} = 36 + 9 + 24 + 6 + 0 + 0 = 75$，与给定的总样本量 $N=75$ 相符。问题要求评估几个陈述，这些陈述可以根据数学和统计原理明确地判断为正确或不正确。\n- **客观性**：问题以精确、客观和无歧义的语言陈述。它使用标准的数学和统计符号。\n\n该问题没有表现出说明中列出的任何缺陷（例如，科学上不合理、信息缺失、含糊不清）。在实践中，具有零观测值的类别是常见情况，这会导致统计分析中重要且不平凡的考虑。\n\n### 步骤3：结论和行动\n问题陈述是**有效的**。开始进行解答。\n\n### 解答推导\n\n事件 $A$ 在给定事件 $B$ 的条件下的基本条件概率定义为\n$$ P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)} $$\n这个定义仅在 $P(B)  0$ 时有效。如果 $P(B) = 0$，则条件概率是未定义的。\n\n在给定问题的背景下，我们关心的是在暴露类别 $X=i$ 的条件下，结局 $Y=j$ 的条件概率。这表示为：\n$$ P(Y=j \\mid X=i) = \\frac{P(Y=j, X=i)}{P(X=i)} $$\n使用问题陈述中的符号，这对应于：\n$$ P(Y=j \\mid X=i) = \\frac{p_{ij}}{p_{i+}} $$\n问题提供了样本计数 $n_{ij}$，我们用它来计算经验概率（用帽子符号 $\\hat p$ 表示）。总样本量为 $N=75$。我们被要求考虑行边缘概率为零的情况，特别是对于 $i=3$。\n\n首先，我们计算行总数和经验行边缘概率：\n- 对于 $i=1$：$n_{1+} = n_{10} + n_{11} = 36 + 9 = 45$。经验边缘概率为 $\\hat p_{1+} = 45/75 = 3/5$。\n- 对于 $i=2$：$n_{2+} = n_{20} + n_{21} = 24 + 6 = 30$。经验边缘概率为 $\\hat p_{2+} = 30/75 = 2/5$。\n- 对于 $i=3$：$n_{3+} = n_{30} + n_{31} = 0 + 0 = 0$。经验边缘概率为 $\\hat p_{3+} = 0/75 = 0$。\n\n问题集中在分层 $X=3$ 的条件概率上。对于这个分层，条件事件 $\\{X=3\\}$ 的经验概率为 $\\hat p_{3+} = 0$。涉及此分层的联合概率也为零：\n- $\\hat p_{30} = n_{30}/N = 0/75 = 0$。\n- $\\hat p_{31} = n_{31}/N = 0/75 = 0$。\n\n现在，我们尝试计算经验条件概率 $\\hat P(Y=j \\mid X=3)$：\n$$ \\hat P(Y=j \\mid X=3) = \\frac{\\hat p_{3j}}{\\hat p_{3+}} = \\frac{0}{0} $$\n这个表达式是 $0$ 除以 $0$ 的比率，这在数学上是不定的和未定义的。因此，根据条件概率的标准定义，无法从给定数据中计算出 $P(Y=j \\mid X=3)$。\n\n基于此，我们评估给出的每个选项。\n\n### 逐项分析选项\n\n**A. $P(Y=j \\mid X=3)$ 是未定义的，因为 $p_{3+} = 0$；条件概率的定义不允许以零概率事件为条件。在实践中，如果不引入外部建模假设、平滑处理或重新定义类别以确保概率为正，就无法进行以 $X=3$ 为条件的条件分析。**\n\n这个陈述准确地反映了数学情况及其现实后果。\n- 第一部分正确地指出条件概率是未定义的，因为条件事件的概率为零（$p_{3+}=0$）。这直接源于定义 $P(A \\mid B) = P(A \\cap B)/P(B)$，该定义要求 $P(B)0$。\n- 第二部分正确地描述了统计实践中处理零计数单元格的常见补救措施。当我们因缺乏数据而无法计算分层特定的估计时，我们必须求助于诸如以下方法：\n    - **建模**：假设一个参数模型（例如逻辑回归），该模型关联不同分层之间的结果。这允许“借用信息”，但依赖于模型设定是正确的。\n    - **平滑处理**：向所有单元格添加小的伪计数（例如，使用先验的贝叶斯方法，或简单的连续性校正，如加0.5），以确保所有边缘概率为正。\n    - **重新定义类别**：将零计数的类别与相邻类别合并，假设它们足够相似。\n这个陈述是对该问题的完整而准确的总结。\n**结论：正确。**\n\n**B. 因为 $n_{3+} = 0$，正确的约定是对所有 $j$ 都有 $P(Y=j \\mid X=3) = 0$。通过这样的赋值，以 $X=3$ 为条件的条件分析仍然有效。**\n\n这个陈述提出了一个约定。对于任何给定的条件（例如 $X=3$），所有可能结果的条件概率之和必须为1。这是概率的一个基本公理：对于任何给定的 $i$，$\\sum_j P(Y=j \\mid X=i) = 1$。\n如果我们采纳约定，对所有 $j \\in \\{0, 1\\}$，都有 $P(Y=j \\mid X=3) = 0$，那么总和将是：\n$$ P(Y=0 \\mid X=3) + P(Y=1 \\mid X=3) = 0 + 0 = 0 $$\n由于 $0 \\neq 1$，这个约定违反了概率的基本定律。因此，这不是一个“正确的约定”，并且会使后续分析无效，而不是有效。\n**结论：不正确。**\n\n**C. 已定义分层的估计条件概率为 $P(Y=1 \\mid X=1) = 9/45$ 和 $P(Y=1 \\mid X=2) = 6/30$，并且根据分母为 $0$ 时比率的连续性，$P(Y=1 \\mid X=3) = 0$。**\n\n陈述的第一部分正确计算了分层1和2的经验条件概率：\n- $\\hat P(Y=1 \\mid X=1) = n_{11} / n_{1+} = 9/45 = 1/5$。\n- $\\hat P(Y=1 \\mid X=2) = n_{21} / n_{2+} = 6/30 = 1/5$。\n然而，关于 $X=3$ 情况的推理是错误的。它声称“根据分母为 $0$ 时比率的连续性，$P(Y=1 \\mid X=3) = 0$”。对于 $X=3$ 的比率是 $\\hat p_{31} / \\hat p_{3+} = 0/0$。在微积分中，$0/0$ 的形式是不定的。当 $f(x) \\to 0$ 和 $g(x) \\to 0$ 时，比率 $f(x)/g(x)$ 的极限可以是任何值，或者可能不存在。没有普遍的“比率连续性”原则会将 $0/0$ 表达式赋值为 $0$。这个推理在数学上是不合理的。\n**结论：不正确。**\n\n**D. 如果 $p_{i+} = 0$，那么对所有 $j$ 都有 $p_{ij} = 0$，因此 $P(Y=j \\mid X=i)$ 是未定义的。在基于模型的分析中（例如，逻辑回归或分层风险估计），如果没有约束、借用信息或先验信息，涉及 $X=i$ 的参数或分层特定风险是不可识别的；这是对正性（重叠）假设违反的一种表现。**\n\n这个陈述提供了一个详细且技术上精确的说明。\n- “如果 $p_{i+} = 0$，那么对所有 $j$ 都有 $p_{ij} = 0$”：这是正确的。因为 $p_{i+} = \\sum_j p_{ij}$ 并且联合概率 $p_{ij}$ 是非负的，所以只有当和中的每一项都为零时，和才能为零。\n- “... 因此 $P(Y=j \\mid X=i)$ 是未定义的”：如前所述，比率 $p_{ij}/p_{i+}$ 变为 $0/0$，这是未定义的。这是正确的。\n- 陈述的其余部分正确解释了其对统计建模的影响。不可识别性是描述无法从数据中估计参数的精确术语。如果没有 $X=3$ 的受试者，就不存在任何数据来为描述 $X=3$ 效应的任何参数（例如，回归模型中的系数）提供信息。\n- 最后，它正确地将此问题识别为违反“正性假设”（在因果推断中也称为重叠或共同支持假设），该假设要求群体中的每个个体在任何给定的暴露/治疗组中都有非零概率，即对所有 $i$ 都有 $P(X=i)  0$。在我们的样本中，经验概率 $\\hat P(X=3)=0$，表明数据中缺乏对该假设的支持。\n这个陈述是完全正确的。\n**结论：正确。**\n\n**E. 零行边缘概率迫使 $P(Y=j \\mid X=i) = P(Y=j)$，因为以不可能事件为条件使分布保持不变，并且条件概率简化为边缘概率。**\n\n这个陈述声称如果 $p_{i+} = 0$，那么以 $X=i$ 为条件等价于独立。事件 $A=\\{Y=j\\}$ 和 $B=\\{X=i\\}$ 之间独立的条件是 $P(A \\cap B) = P(A)P(B)$。给定 $P(B)=p_{i+}=0$，我们有 $P(A \\cap B) = p_{ij} = 0$（如对 D 的分析所示）。独立性方程变为 $0 = P(A) \\cdot 0$，这对任何 $P(A)$ 都成立。所以，从技术上讲，一个概率为零的事件与任何其他事件都是独立的。\n然而，这并不意味着 $P(A \\mid B) = P(A)$。后一个公式是独立性的一个*推论*，它只在 $P(B)  0$ 时有效，因为它是从 $P(A \\cap B) / P(B) = P(A)$ 推导出来的，这需要除以 $P(B)$。“以不可能事件为条件使分布保持不变”这个基本前提不是概率论的标准公理或定理；实际上，在这个基本框架中，以零概率事件为条件根本没有定义。该选项做出了一个无效的逻辑跳跃。\n**结论：不正确。**\n\n### 结论\n陈述 A 和 D 都是正确的。它们从略有不同但互补的角度描述了同一个核心问题。陈述 A 对问题和实际解决方案进行了总体概述，而陈述 D 在统计建模的背景下提供了更技术性的解释，引入了诸如“可识别性”和“正性”等关键术语。", "answer": "$$\\boxed{AD}$$", "id": "4920943"}]}