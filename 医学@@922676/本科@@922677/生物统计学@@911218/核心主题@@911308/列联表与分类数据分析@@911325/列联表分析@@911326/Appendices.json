{"hands_on_practices": [{"introduction": "列联表分析的核心是检验两个分类变量之间是否存在关联。本练习将指导您完成皮尔逊卡方检验的基本步骤，从计算边际总和到将观测频数与独立性零假设下的期望频数进行比较。通过这个基础练习 [@problem_id:4905106]，您将掌握检验两个变量是否独立的通用方法。", "problem": "一项临床队列研究记录了按三个暴露水平和三个健康结局严重程度等级（轻度、中度、重度）分类的个体计数。得到的 $3 \\times 3$ 计数列联表如下：\n$$\n\\begin{pmatrix}\n4  6  10 \\\\\n5  7  8 \\\\\n3  9  8\n\\end{pmatrix}.\n$$\n从列联表的核心定义出发，完成以下操作：\n1. 计算所有行合计、所有列合计以及总计。\n2. 使用总计，计算单元格比例矩阵。\n3. 在暴露水平和结局严重程度相互独立的假设下，使用观测到的边际合计推导出期望单元格计数，然后计算用于检验行和列独立性的皮尔逊卡方检验统计量。\n\n将检验统计量的最终数值答案四舍五入至四位有效数字。最终数值答案不需要单位。", "solution": "该问题是有效的，因为它提出了生物统计学中一个标准的、定义明确的任务：列联表分析。它在科学上基于已建立的统计理论，提供了所有必要的数据，没有歧义，并要求一个可计算的、唯一的结果。\n\n给定的 $3 \\times 3$ 列联表代表观测计数，我们将其表示为矩阵 $O$。\n$$\nO = \\begin{pmatrix}\n4  6  10 \\\\\n5  7  8 \\\\\n3  9  8\n\\end{pmatrix}\n$$\n其中 $O_{ij}$ 是第 $i$ 行和第 $j$ 列的观测计数。\n\n**1. 计算合计**\n\n首先，我们计算行合计 ($R_i$)、列合计 ($C_j$) 和总计 ($N$)。\n\n行合计是每行中计数的总和：\n$$\nR_1 = 4 + 6 + 10 = 20 \\\\\nR_2 = 5 + 7 + 8 = 20 \\\\\nR_3 = 3 + 9 + 8 = 20\n$$\n\n列合计是每列中计数的总和：\n$$\nC_1 = 4 + 5 + 3 = 12 \\\\\nC_2 = 6 + 7 + 9 = 22 \\\\\nC_3 = 10 + 8 + 8 = 26\n$$\n\n总计 $N$ 是表中所有计数的总和。它可以通过对行合计或列合计求和来计算。\n使用行合计：$N = R_1 + R_2 + R_3 = 20 + 20 + 20 = 60$。\n使用列合计：$N = C_1 + C_2 + C_3 = 12 + 22 + 26 = 60$。\n总计为 $N=60$。\n\n**2. 计算单元格比例**\n\n单元格比例矩阵 $P$ 是通过将每个观测计数 $O_{ij}$ 除以总计 $N=60$ 计算得出的。\n$$\nP_{ij} = \\frac{O_{ij}}{N}\n$$\n$$\nP = \\begin{pmatrix}\n\\frac{4}{60}  \\frac{6}{60}  \\frac{10}{60} \\\\\n\\frac{5}{60}  \\frac{7}{60}  \\frac{8}{60} \\\\\n\\frac{3}{60}  \\frac{9}{60}  \\frac{8}{60}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{15}  \\frac{1}{10}  \\frac{1}{6} \\\\\n\\frac{1}{12}  \\frac{7}{60}  \\frac{2}{15} \\\\\n\\frac{1}{20}  \\frac{3}{20}  \\frac{2}{15}\n\\end{pmatrix}\n$$\n\n**3. 计算皮尔逊卡方检验统计量**\n\n为了计算皮尔逊卡方统计量，我们首先需要确定在行变量（暴露水平）和列变量（结局严重程度）之间相互独立的零假设下，期望的单元格计数。\n\n在独立性假设下，第 $i$ 行和第 $j$ 列单元格的期望计数 $E_{ij}$ 由以下公式给出：\n$$\nE_{ij} = \\frac{R_i \\times C_j}{N}\n$$\n使用行合计 ($R_1=R_2=R_3=20$)、列合计 ($C_1=12, C_2=22, C_3=26$) 和总计 ($N=60$)，我们计算期望计数矩阵 $E$。\n$$\nE_{11} = \\frac{20 \\times 12}{60} = 4 \\\\\nE_{12} = \\frac{20 \\times 22}{60} = \\frac{22}{3} \\\\\nE_{13} = \\frac{20 \\times 26}{60} = \\frac{26}{3}\n$$\n由于所有行合计都相同 ($R_1=R_2=R_3=20$)，因此每列的期望计数在各行中都是相同的。\n$$\nE = \\begin{pmatrix}\n4  \\frac{22}{3}  \\frac{26}{3} \\\\\n4  \\frac{22}{3}  \\frac{26}{3} \\\\\n4  \\frac{22}{3}  \\frac{26}{3}\n\\end{pmatrix}\n$$\n\n皮尔逊卡方检验统计量 $\\chi^2$ 定义为表中所有单元格的观测计数与期望计数之差的平方除以期望计数的总和。\n$$\n\\chi^2 = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}\n$$\n我们计算每个单元格对总 $\\chi^2$ 值的贡献：\n- 单元格 (1,1): $\\frac{(4 - 4)^2}{4} = 0$\n- 单元格 (1,2): $\\frac{(6 - \\frac{22}{3})^2}{\\frac{22}{3}} = \\frac{(\\frac{18-22}{3})^2}{\\frac{22}{3}} = \\frac{(-\\frac{4}{3})^2}{\\frac{22}{3}} = \\frac{\\frac{16}{9}}{\\frac{22}{3}} = \\frac{16}{9} \\cdot \\frac{3}{22} = \\frac{8}{33}$\n- 单元格 (1,3): $\\frac{(10 - \\frac{26}{3})^2}{\\frac{26}{3}} = \\frac{(\\frac{30-26}{3})^2}{\\frac{26}{3}} = \\frac{(\\frac{4}{3})^2}{\\frac{26}{3}} = \\frac{\\frac{16}{9}}{\\frac{26}{3}} = \\frac{16}{9} \\cdot \\frac{3}{26} = \\frac{8}{39}$\n- 单元格 (2,1): $\\frac{(5 - 4)^2}{4} = \\frac{1}{4}$\n- 单元格 (2,2): $\\frac{(7 - \\frac{22}{3})^2}{\\frac{22}{3}} = \\frac{(\\frac{21-22}{3})^2}{\\frac{22}{3}} = \\frac{(-\\frac{1}{3})^2}{\\frac{22}{3}} = \\frac{\\frac{1}{9}}{\\frac{22}{3}} = \\frac{1}{9} \\cdot \\frac{3}{22} = \\frac{1}{66}$\n- 单元格 (2,3): $\\frac{(8 - \\frac{26}{3})^2}{\\frac{26}{3}} = \\frac{(\\frac{24-26}{3})^2}{\\frac{26}{3}} = \\frac{(-\\frac{2}{3})^2}{\\frac{26}{3}} = \\frac{\\frac{4}{9}}{\\frac{26}{3}} = \\frac{4}{9} \\cdot \\frac{3}{26} = \\frac{2}{39}$\n- 单元格 (3,1): $\\frac{(3 - 4)^2}{4} = \\frac{1}{4}$\n- 单元格 (3,2): $\\frac{(9 - \\frac{22}{3})^2}{\\frac{22}{3}} = \\frac{(\\frac{27-22}{3})^2}{\\frac{22}{3}} = \\frac{(\\frac{5}{3})^2}{\\frac{22}{3}} = \\frac{\\frac{25}{9}}{\\frac{22}{3}} = \\frac{25}{9} \\cdot \\frac{3}{22} = \\frac{25}{66}$\n- 单元格 (3,3): $\\frac{(8 - \\frac{26}{3})^2}{\\frac{26}{3}} = \\frac{(\\frac{24-26}{3})^2}{\\frac{26}{3}} = \\frac{(-\\frac{2}{3})^2}{\\frac{26}{3}} = \\frac{\\frac{4}{9}}{\\frac{26}{3}} = \\frac{4}{9} \\cdot \\frac{3}{26} = \\frac{2}{39}$\n\n现在，我们将这些贡献相加：\n$$\n\\chi^2 = 0 + \\frac{8}{33} + \\frac{8}{39} + \\frac{1}{4} + \\frac{1}{66} + \\frac{2}{39} + \\frac{1}{4} + \\frac{25}{66} + \\frac{2}{39}\n$$\n按分母分组各项：\n$$\n\\chi^2 = \\left(\\frac{1}{4} + \\frac{1}{4}\\right) + \\left(\\frac{8}{33}\\right) + \\left(\\frac{1}{66} + \\frac{25}{66}\\right) + \\left(\\frac{8}{39} + \\frac{2}{39} + \\frac{2}{39}\\right)\n$$\n$$\n\\chi^2 = \\frac{2}{4} + \\frac{8}{33} + \\frac{26}{66} + \\frac{12}{39}\n$$\n化简分数：\n$$\n\\chi^2 = \\frac{1}{2} + \\frac{8}{33} + \\frac{13}{33} + \\frac{4}{13} = \\frac{1}{2} + \\left(\\frac{8+13}{33}\\right) + \\frac{4}{13}\n$$\n$$\n\\chi^2 = \\frac{1}{2} + \\frac{21}{33} + \\frac{4}{13} = \\frac{1}{2} + \\frac{7}{11} + \\frac{4}{13}\n$$\n为了求得精确和，我们使用公分母 $2 \\times 11 \\times 13 = 286$：\n$$\n\\chi^2 = \\frac{1 \\cdot 143}{286} + \\frac{7 \\cdot 26}{286} + \\frac{4 \\cdot 22}{286} = \\frac{143}{286} + \\frac{182}{286} + \\frac{88}{286} = \\frac{143 + 182 + 88}{286} = \\frac{413}{286}\n$$\n最后，我们按照要求将这个分数转换为小数，并四舍五入到四位有效数字。\n$$\n\\chi^2 = \\frac{413}{286} \\approx 1.4440559...\n$$\n四舍五入到四位有效数字得到 $1.444$。", "answer": "$$\n\\boxed{1.444}\n$$", "id": "4905106"}, {"introduction": "在理解了单一表格中的关联性之后，我们来探讨一个更复杂的情形：当第三个变量影响我们正在研究的关系时会发生什么？这个练习 [@problem_id:4905061] 通过一个精心设计的思想实验，揭示了辛普森悖论。这个悖论展示了在不同分组中观察到的关联，在合并分组后可能完全逆转或消失，从而强调了识别和控制混杂变量的重要性。", "problem": "一项随机对照研究在两个临床中心进行，标记为层 $A$ 和层 $B$。在每个层中，患者接受治疗（$X=1$）或对照（$X=0$），且每位患者的结果为成功（$Y=1$）或失败（$Y=0$）。观察到的 $2\\times 2$ 计数列表如下，使用常规布局，行由暴露（$X$）索引，列由结局（$Y$）索引：\n- 层 $A$：第一行（治疗组）有 $18$ 例成功和 $2$ 例失败；第二行（对照组）有 $2$ 例成功和 $18$ 例失败。因此，列表为 $\\begin{pmatrix}18  2\\\\ 2  18\\end{pmatrix}$。\n- 层 $B$：第一行（治疗组）有 $2$ 例成功和 $18$ 例失败；第二行（对照组）有 $18$ 例成功和 $2$ 例失败。因此，列表为 $\\begin{pmatrix}2  18\\\\ 18  2\\end{pmatrix}$。\n\n从“比数（odds）”定义为成功概率与失败概率之比，以及“比值比（odds ratio）”定义为治疗组比数与对照组比数之比出发，推导 $2\\times 2$ 列表中比值比关于单元格计数的表达式，然后计算层 $A$ 和层 $B$ 各自的比值比。接下来，通过将相应单元格相加来合并各层数据，形成边际 $2\\times 2$ 列表，并计算其边际比值比。简要解释合并后的列表是保留还是反转了层内关联，从而展示在边际化下可能出现的悖论。\n\n仅报告边际比值比作为您的最终数值答案，四舍五入到四位有效数字。无需单位。", "solution": "该问题是有效的，因为它科学地基于标准的生物统计学原理，数据完整一致，问题阐述清晰，并且表述客观。\n\n首先，我们从一个 $2 \\times 2$ 列联表推导比值比（OR）的一般公式。设计数表如下：\n$$\n\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}\n$$\n在这里，行对应于暴露状态（行1：治疗，$X=1$；行2：对照，$X=0$），列对应于结局（列1：成功，$Y=1$；列2：失败，$Y=0$）。各单元格计数为：\n- $a$：治疗组成功数\n- $b$：治疗组失败数\n- $c$：对照组成功数\n- $d$：对照组失败数\n\n治疗组的总患者数为 $a+b$，对照组为 $c+d$。\n给定治疗下成功的概率估计为 $P(Y=1|X=1) = \\frac{a}{a+b}$。\n给定治疗下失败的概率估计为 $P(Y=0|X=1) = \\frac{b}{a+b}$。\n根据定义，治疗组成功的比数（odds）是成功概率与失败概率之比：\n$$\n\\text{Odds}_{X=1} = \\frac{P(Y=1|X=1)}{P(Y=0|X=1)} = \\frac{a/(a+b)}{b/(a+b)} = \\frac{a}{b}\n$$\n同样，对于对照组：\n给定对照下成功的概率估计为 $P(Y=1|X=0) = \\frac{c}{c+d}$。\n给定对照下失败的概率估计为 $P(Y=0|X=0) = \\frac{d}{c+d}$。\n对照组成功的比数是：\n$$\n\\text{Odds}_{X=0} = \\frac{P(Y=1|X=0)}{P(Y=0|X=0)} = \\frac{c/(c+d)}{d/(c+d)} = \\frac{c}{d}\n$$\n比值比定义为治疗组成功比数与对照组成功比数之比：\n$$\n\\text{OR} = \\frac{\\text{Odds}_{X=1}}{\\text{Odds}_{X=0}} = \\frac{a/b}{c/d} = \\frac{ad}{bc}\n$$\n这是样本比值比的标准公式，也称为交叉乘积比。\n\n接下来，我们计算各层的比值比。\n对于层 $A$，列表为 $\\begin{pmatrix}18  2\\\\ 2  18\\end{pmatrix}$。\n单元格计数为 $a_A = 18$, $b_A = 2$, $c_A = 2$, and $d_A = 18$。\n层 $A$ 的比值比为：\n$$\n\\text{OR}_A = \\frac{a_A d_A}{b_A c_A} = \\frac{18 \\times 18}{2 \\times 2} = \\frac{324}{4} = 81\n$$\n$81$ 的比值比表明在层 $A$ 中，治疗与成功之间存在强烈的正相关。\n\n对于层 $B$，列表为 $\\begin{pmatrix}2  18\\\\ 18  2\\end{pmatrix}$。\n单元格计数为 $a_B = 2$, $b_B = 18$, $c_B = 18$, and $d_B = 2$。\n层 $B$ 的比值比为：\n$$\n\\text{OR}_B = \\frac{a_B d_B}{b_B c_B} = \\frac{2 \\times 2}{18 \\times 18} = \\frac{4}{324} = \\frac{1}{81}\n$$\n比值比为 $\\frac{1}{81}$（约 $0.0123$）表明在层 $B$ 中，治疗与成功之间存在强烈的负相关；也就是说，与对照组相比，治疗组的成功比数要低得多。\n\n现在，我们通过将相应单元格相加来合并各层数据，形成边际 $2 \\times 2$ 列表：\n$$\n\\text{Marginal Table} = \\begin{pmatrix} a_A+a_B  b_A+b_B \\\\ c_A+c_B  d_A+d_B \\end{pmatrix} = \\begin{pmatrix} 18+2  2+18 \\\\ 2+18  18+2 \\end{pmatrix} = \\begin{pmatrix} 20  20 \\\\ 20  20 \\end{pmatrix}\n$$\n边际列表的单元格计数为 $a_M = 20$, $b_M = 20$, $c_M = 20$, and $d_M = 20$。\n我们根据这个合并后的列表计算边际比值比：\n$$\n\\text{OR}_M = \\frac{a_M d_M}{b_M c_M} = \\frac{20 \\times 20}{20 \\times 20} = \\frac{400}{400} = 1\n$$\n边际比值比恰好为 $1$。这一结果表明，在合并数据中，治疗与结局之间没有关联。层内关联（虽然强烈但方向相反，$\\text{OR}_A=81$ 和 $\\text{OR}_B=1/81$）被完全掩盖了。合并后的列表没有保留层内关联；相反，它显示了一个无效效应，这与在两个层中观察到的强效应是相反的。这种在不同组内存在的关联在组合各组后发生逆转或消失的现象，是辛普森悖论（Simpson's paradox）的一个典型例子。分层变量（临床中心）是一个效应修饰因子，因为治疗的效果在不同层之间存在质的差异。因此，边际分析具有高度的误导性。\n\n问题要求将边际比值比四舍五入到四位有效数字。由于该值恰好为 $1$，表示为四位有效数字即为 $1.000$。", "answer": "$$\n\\boxed{1.000}\n$$", "id": "4905061"}, {"introduction": "在认识到忽略分层的潜在陷阱后，本练习将介绍处理此类数据的正式统计工具。您将学习如何计算 Mantel–Haenszel 公共比值比，这是跨层关联的加权平均值。同时，您还将计算 Cochran–Mantel–Haenszel 检验统计量 [@problem_id:4905088]，它可以在考虑分层变量的情况下，评估关联的总体显著性。", "problem": "一项多中心病例对照研究调查了三个临床中心中二元暴露与二元疾病之间的关联。在每个中心（层）内，按设计抽样了固定数量的病例和对照，因此在每个层内，相应列联表的行合计和列合计是固定的。对于层指数 $i \\in \\{1,2,3\\}$，其 $2 \\times 2$ 表格组织如下：\n$$\n\\begin{pmatrix}\na_i  b_i \\\\\nc_i  d_i\n\\end{pmatrix},\n$$\n其中 $a_i$ 是暴露病例数，$b_i$ 是暴露对照数，$c_i$ 是未暴露病例数，$d_i$ 是未暴露对照数。观测到的计数为：\n- 层 1：$\\left(a_1,b_1;c_1,d_1\\right) = \\left(12,8;5,15\\right)$，\n- 层 2：$\\left(a_2,b_2;c_2,d_2\\right) = \\left(7,13;11,9\\right)$，\n- 层 3：$\\left(a_3,b_3;c_3,d_3\\right) = \\left(14,6;10,10\\right)$。\n\n使用分层 $2 \\times 2$ 表中层特异性比值比和跨层公共比值比的定义，并将每个层视为适用于病例对照抽样的固定边际超几何模型，执行以下操作：\n1. 计算公共比值比的 Mantel–Haenszel 估计量，记为 $\\hat{\\theta}_{MH}$。\n2. 在层内暴露与疾病无关联的原假设下，计算跨越三个层的条件独立性的 Cochran–Mantel–Haenszel (CMH) 检验统计量。不进行连续性校正。\n\n报告所要求的两个量，$\\hat{\\theta}_{MH}$ 和 CMH 检验统计量，四舍五入到四位有效数字。将最终答案表示为两个不带单位的数字。", "solution": "该问题要求从分层 $2 \\times 2$ 列联表分析中计算两个关键统计量：公共比值比的 Mantel-Haenszel 估计量和条件独立性的 Cochran-Mantel-Haenszel 检验统计量。该研究是一个按三个临床中心分层的病例对照设计。\n\n对于一组由 $i = 1, \\dots, k$ 索引的 $k$ 个层，每个层的数据排列在一个 $2 \\times 2$ 表中：\n$$\n\\begin{pmatrix}\na_i  b_i \\\\\nc_i  d_i\n\\end{pmatrix}\n$$\n第 $i$ 层的边际总计为：\n- 行合计：$R_{1i} = a_i + b_i$（暴露总数），$R_{2i} = c_i + d_i$（未暴露总数）\n- 列合计：$C_{1i} = a_i + c_i$（病例总数），$C_{2i} = b_i + d_i$（对照总数）\n- 层总计：$N_i = a_i + b_i + c_i + d_i = R_{1i} + R_{2i} = C_{1i} + C_{2i}$\n\n问题为 $k=3$ 个层提供了以下数据：\n- 层 1：$a_1=12$, $b_1=8$, $c_1=5$, $d_1=15$。\n  - $N_1 = 12+8+5+15 = 40$。\n- 层 2：$a_2=7$, $b_2=13$, $c_2=11$, $d_2=9$。\n  - $N_2 = 7+13+11+9 = 40$。\n- 层 3：$a_3=14$, $b_3=6$, $c_3=10$, $d_3=10$。\n  - $N_3 = 14+6+10+10 = 40$。\n\n**1. 公共比值比的 Mantel-Haenszel 估计量 ($\\hat{\\theta}_{MH}$)**\n\n跨越 $k$ 个层的公共比值比 $\\theta$ 的 Mantel-Haenszel 估计量是层特异性比值比的加权平均值。其计算公式如下：\n$$\n\\hat{\\theta}_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{a_i d_i}{N_i}}{\\sum_{i=1}^{k} \\frac{b_i c_i}{N_i}}\n$$\n我们为每个层计算分项：\n- 对于层 1：\n  - 分子项：$\\frac{a_1 d_1}{N_1} = \\frac{12 \\times 15}{40} = \\frac{180}{40} = 4.5$\n  - 分母项：$\\frac{b_1 c_1}{N_1} = \\frac{8 \\times 5}{40} = \\frac{40}{40} = 1.0$\n- 对于层 2：\n  - 分子项：$\\frac{a_2 d_2}{N_2} = \\frac{7 \\times 9}{40} = \\frac{63}{40} = 1.575$\n  - 分母项：$\\frac{b_2 c_2}{N_2} = \\frac{13 \\times 11}{40} = \\frac{143}{40} = 3.575$\n- 对于层 3：\n  - 分子项：$\\frac{a_3 d_3}{N_3} = \\frac{14 \\times 10}{40} = \\frac{140}{40} = 3.5$\n  - 分母项：$\\frac{b_3 c_3}{N_3} = \\frac{6 \\times 10}{40} = \\frac{60}{40} = 1.5$\n\n现在，我们将这些项跨层相加：\n- 分子项之和：$\\sum_{i=1}^{3} \\frac{a_i d_i}{N_i} = 4.5 + 1.575 + 3.5 = 9.575$\n- 分母项之和：$\\sum_{i=1}^{3} \\frac{b_i c_i}{N_i} = 1.0 + 3.575 + 1.5 = 6.075$\n\n最后，我们计算比率：\n$$\n\\hat{\\theta}_{MH} = \\frac{9.575}{6.075} \\approx 1.5761317...\n$$\n四舍五入到四位有效数字，我们得到 $\\hat{\\theta}_{MH} \\approx 1.576$。\n\n**2. Cochran-Mantel-Haenszel (CMH) 检验统计量**\n\nCMH 检验用于检验在给定分层的条件下，暴露与疾病之间无关联的原假设。这对应于公共比值比 $\\theta=1$。检验统计量（无连续性校正）为：\n$$\nX^2_{CMH} = \\frac{\\left( \\sum_{i=1}^{k} [a_i - E(a_i)] \\right)^2}{\\sum_{i=1}^{k} \\text{Var}(a_i)}\n$$\n在原假设下，并以每张表的行和列边际为条件（超几何模型），单元格计数 $a_i$ 的期望值 $E(a_i)$ 和方差 $\\text{Var}(a_i)$ 为：\n$$\nE(a_i) = \\frac{(a_i+b_i)(a_i+c_i)}{N_i} = \\frac{R_{1i} C_{1i}}{N_i}\n$$\n$$\n\\text{Var}(a_i) = \\frac{(a_i+b_i)(c_i+d_i)(a_i+c_i)(b_i+d_i)}{N_i^2 (N_i-1)} = \\frac{R_{1i} R_{2i} C_{1i} C_{2i}}{N_i^2 (N_i-1)}\n$$\n\n我们为每个层计算这些量：\n- 对于层 1 ($a_1=12, N_1=40$):\n  - 边际：$R_{11}=12+8=20$, $R_{21}=5+15=20$, $C_{11}=12+5=17$, $C_{21}=8+15=23$。\n  - $E(a_1) = \\frac{20 \\times 17}{40} = 8.5$\n  - $\\text{Var}(a_1) = \\frac{20 \\times 20 \\times 17 \\times 23}{40^2 (40-1)} = \\frac{156400}{1600 \\times 39} = \\frac{156400}{62400} = \\frac{391}{156} \\approx 2.50641$\n  - 观测值减去期望值：$a_1 - E(a_1) = 12 - 8.5 = 3.5$\n\n- 对于层 2 ($a_2=7, N_2=40$):\n  - 边际：$R_{12}=7+13=20$, $R_{22}=11+9=20$, $C_{12}=7+11=18$, $C_{22}=13+9=22$。\n  - $E(a_2) = \\frac{20 \\times 18}{40} = 9.0$\n  - $\\text{Var}(a_2) = \\frac{20 \\times 20 \\times 18 \\times 22}{40^2 (40-1)} = \\frac{158400}{1600 \\times 39} = \\frac{158400}{62400} = \\frac{396}{156} \\approx 2.53846$\n  - 观测值减去期望值：$a_2 - E(a_2) = 7 - 9.0 = -2.0$\n\n- 对于层 3 ($a_3=14, N_3=40$):\n  - 边际：$R_{13}=14+6=20$, $R_{23}=10+10=20$, $C_{13}=14+10=24$, $C_{23}=6+10=16$。\n  - $E(a_3) = \\frac{20 \\times 24}{40} = 12.0$\n  - $\\text{Var}(a_3) = \\frac{20 \\times 20 \\times 24 \\times 16}{40^2 (40-1)} = \\frac{153600}{1600 \\times 39} = \\frac{153600}{62400} = \\frac{384}{156} \\approx 2.46154$\n  - 观测值减去期望值：$a_3 - E(a_3) = 14 - 12.0 = 2.0$\n\n现在，我们将偏差和方差跨层相加：\n- 偏差之和：$\\sum_{i=1}^{3} [a_i - E(a_i)] = 3.5 + (-2.0) + 2.0 = 3.5$\n- 方差之和：$\\sum_{i=1}^{3} \\text{Var}(a_i) = \\frac{391}{156} + \\frac{396}{156} + \\frac{384}{156} = \\frac{391+396+384}{156} = \\frac{1171}{156} \\approx 7.50641$\n\n最后，我们计算 CMH 统计量：\n$$\nX^2_{CMH} = \\frac{(3.5)^2}{\\frac{1171}{156}} = \\frac{12.25}{1171/156} = \\frac{12.25 \\times 156}{1171} = \\frac{1911}{1171} \\approx 1.6319385...\n$$\n在原假设下，该统计量服从自由度为 $1$ 的卡方分布。四舍五入到四位有效数字，我们得到 $X^2_{CMH} \\approx 1.632$。\n\n所要求的两个量四舍五入到四位有效数字为：\n$\\hat{\\theta}_{MH} = 1.576$\n$X^2_{CMH} = 1.632$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.576  1.632\n\\end{pmatrix}\n}\n$$", "id": "4905088"}]}