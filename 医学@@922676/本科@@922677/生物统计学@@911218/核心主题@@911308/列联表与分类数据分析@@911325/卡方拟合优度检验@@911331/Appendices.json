{"hands_on_practices": [{"introduction": "卡方统计量告诉我们观测值与期望值之间的总体差异，但它没有指出差异具体来自哪里。为了更深入地诊断模型的拟合情况，我们需要检查每个类别的贡献，也就是所谓的“残差”。本练习将指导你如何计算和解释皮尔逊残差 (Pearson residuals)，从而精确定位导致模型失拟的来源 [@problem_id:4899481]。", "problem": "一位生物统计学家正在评估一个针对大种群中突变类型的五分类模型的拟合优度。零模型指定的分类概率为 $\\{p_1, p_2, p_3, p_4, p_5\\} = \\{0.10, 0.20, 0.25, 0.30, 0.15\\}$。一个大小为 $n = 400$ 的样本得到的观测计数为 $\\{O_1, O_2, O_3, O_4, O_5\\} = \\{48, 70, 110, 130, 42\\}$。在零假设下的期望计数为 $\\{E_1, E_2, E_3, E_4, E_5\\} = \\{40, 80, 100, 120, 60\\}$，因为 $E_i = n p_i$。从卡方拟合优度检验的核心设定出发——即在大样本的零模型下，每个单元格的计数被建模为一个随机变量，其均值为 $E_i$，方差由抽样方案确定——构建一个可以汇总得到皮尔逊卡方统计量的单元格水平的标准化残差。然后，解释该残差的符号和大小如何诊断单个单元格中的拟合不足。最后，将你的结果应用于上述数据。\n\n选择所有正确的陈述。\n\nA. 在均值为 $E_i$ 的单元格计数的独立泊松抽样方案下，适当的单元格标准化残差等于观测值与期望值之差除以方差的平方根，因此残差为 $(O_i - E_i)/\\sqrt{E_i}$。正值表示计数比模型预期的要多；单元格 $i$ 对皮尔逊卡方统计量的贡献是残差的平方 $r_i^2$。\n\nB. 在总数固定的多项式模型下，单元格计数 $O_i$ 的方差导出的标准化残差为 $(O_i - E_i)/\\sqrt{E_i \\left(1 - E_i/n\\right)}$，并且这个量是卡方拟合优度检验中使用的皮尔逊残差。\n\nC. 对于给定的数据，第5类的残差约为 $-2.32$，这表明计数比模型预期少约 $2.32$ 个标准差；在五个类别中，第5类的绝对残差最大，是拟合不足的主要驱动因素。\n\nD. 皮尔逊残差的符号没有意义；负残差表示比预期更多的计数，并且只有绝对值 $|r_i|$ 对诊断拟合不足有意义。\n\nE. 对于从这五个类别计算出的皮尔逊卡方统计量，其自由度为 $5$，无论单元格概率模型中是否估计了任何参数。", "solution": "用户希望我验证所提供的关于卡方拟合优度检验的问题陈述，然后评估给定的选项。\n\n### 步骤1：提取已知条件\n-   分类数：$k=5$。\n-   零假设概率：$\\{p_1, p_2, p_3, p_4, p_5\\} = \\{0.10, 0.20, 0.25, 0.30, 0.15\\}$。\n-   总样本量：$n = 400$。\n-   观测计数：$\\{O_1, O_2, O_3, O_4, O_5\\} = \\{48, 70, 110, 130, 42\\}$。\n-   期望计数定义：$E_i = n p_i$。\n-   期望计数（已提供）：$\\{E_1, E_2, E_3, E_4, E_5\\} = \\{40, 80, 100, 120, 60\\}$。\n-   问题要求构建一个可以汇总得到皮尔逊卡方统计量的单元格水平标准化残差，对其进行解释，并将其应用于数据。\n\n### 步骤2：使用提取的已知条件进行验证\n首先，我验证所提供数据的内部一致性。\n-   概率之和：$0.10 + 0.20 + 0.25 + 0.30 + 0.15 = 1.00$。这是正确的。\n-   观测计数之和：$48 + 70 + 110 + 130 + 42 = 400 = n$。这是正确的。\n-   期望计数的计算：\n    -   $E_1 = n p_1 = 400 \\times 0.10 = 40$。匹配。\n    -   $E_2 = n p_2 = 400 \\times 0.20 = 80$。匹配。\n    -   $E_3 = n p_3 = 400 \\times 0.25 = 100$。匹配。\n    -   $E_4 = n p_4 = 400 \\times 0.30 = 120$。匹配。\n    -   $E_5 = n p_5 = 400 \\times 0.15 = 60$。匹配。\n-   期望计数之和：$40 + 80 + 100 + 120 + 60 = 400 = n$。这也是正确的。\n\n问题是：\n-   **科学上合理的**：它描述了一个标准的卡方拟合优度检验，这是生物统计学中的一个基本程序。其前提基于已建立的统计理论。\n-   **提法恰当的**：它提供了回答问题所需的所有必要数据和背景。问题是具体的，并允许一个唯一的、稳定的解决方案。\n-   **客观的**：语言是精确的、定量的，并且没有偏见或主观陈述。\n-   **完整且一致的**：如上所验证，问题是自洽的，所有数值相互一致。\n\n### 步骤3：结论和行动\n问题陈述是有效的。我将继续推导解决方案并评估每个选项。\n\n### 推导与选项分析\n\n皮尔逊卡方拟合优度检验统计量由以下公式给出：\n$$ \\chi^2 = \\sum_{i=1}^{k} \\frac{(O_i - E_i)^2}{E_i} $$\n其中 $O_i$ 是类别 $i$ 的观测计数，$E_i$ 是零假设下类别 $i$ 的期望计数，$k$ 是类别数量。\n\n问题要求构建一个可以汇总得到该统计量的单元格水平残差。总和中的各项是平方分量。这表明可以定义一个单元格水平的残差，称为**皮尔逊残差**，如下：\n$$ r_i = \\frac{O_i - E_i}{\\sqrt{E_i}} $$\n这些残差的平方和即为皮尔逊卡方统计量：\n$$ \\sum_{i=1}^{k} r_i^2 = \\sum_{i=1}^{k} \\left( \\frac{O_i - E_i}{\\sqrt{E_i}} \\right)^2 = \\sum_{i=1}^{k} \\frac{(O_i - E_i)^2}{E_i} = \\chi^2 $$\n残差 $r_i$ 的符号表示偏差的方向：正号表示 $O_i  E_i$（观测值多于期望值），而负号表示 $O_i  E_i$（观测值少于期望值）。大小 $|r_i|$ 以 $\\sqrt{E_i}$ 为单位衡量差异的大小，$\\sqrt{E_i}$ 是均值为 $E_i$ 的泊松变量的标准差。在大样本近似下，残差 $r_i$ 的行为近似于标准正态变量（尽管它们不是独立的），$|r_i|  2$ 或 $|r_i|  3$ 的值通常被标记为表示该特定单元格存在显著的拟合不足。\n\n现在，我们来评估每个选项。\n\n**A. 在均值为 $E_i$ 的单元格计数的独立泊松抽样方案下，适当的单元格标准化残差等于观测值与期望值之差除以方差的平方根，因此残差为 $(O_i - E_i)/\\sqrt{E_i}$。正值表示计数比模型预期的要多；单元格 $i$ 对皮尔逊卡方统计量的贡献是残差的平方 $r_i^2$。**\n\n-   在泊松抽样模型中，每个单元格计数 $O_i$ 是一个独立的随机变量 $O_i \\sim \\text{Poisson}(\\lambda_i)$。在零假设下，我们检验是否 $\\lambda_i = E_i$。\n-   对于泊松分布，均值等于方差：$E[O_i] = \\text{Var}(O_i) = E_i$。\n-   标准化残差是 $(O_i - \\text{均值}) / \\sqrt{\\text{方差}} = (O_i - E_i) / \\sqrt{E_i}$。这与给定的公式相匹配。\n-   $(O_i - E_i)/\\sqrt{E_i}$ 的正值意味着 $O_i - E_i  0$，所以 $O_i  E_i$，即计数多于预期。这是正确的。\n-   单元格 $i$ 对卡方统计量的贡献是 $\\frac{(O_i - E_i)^2}{E_i}$。如果我们将残差定义为 $r_i = \\frac{O_i - E_i}{\\sqrt{E_i}}$，那么它的平方就是 $r_i^2 = \\frac{(O_i - E_i)^2}{E_i}$。这也是正确的。\n-   结论：**正确**。\n\n**B. 在总数固定的多项式模型下，单元格计数 $O_i$ 的方差导出的标准化残差为 $(O_i - E_i)/\\sqrt{E_i \\left(1 - E_i/n\\right)}$，并且这个量是卡方拟合优度检验中使用的皮尔逊残差。**\n\n-   在样本量为 $n$、概率为 $p_i$ 的多项式模型中，单元格计数 $O_i$ 的边际分布是二项分布：$O_i \\sim \\text{Binomial}(n, p_i)$。\n-   $O_i$ 的方差是 $\\text{Var}(O_i) = n p_i (1 - p_i)$。由于 $E_i = n p_i$，我们可以将方差写为 $E_i (1 - p_i) = E_i(1 - E_i/n)$。\n-   用这个边际方差标准化的残差确实是 $\\frac{O_i - E_i}{\\sqrt{E_i(1 - E_i/n)}}$。这个量被称为“标准化残差”或“调整后残差”。\n-   然而，该陈述声称这是“皮尔逊残差”。这是不正确的。**皮尔逊残差**定义为 $r_i = (O_i - E_i)/\\sqrt{E_i}$。皮尔逊残差是其平方和等于皮尔逊 $\\chi^2$ 统计量的分量。“标准化残差”的平方和不等于皮尔逊 $\\chi^2$ 统计量。\n-   结论：**不正确**。\n\n**C. 对于给定的数据，第5类的残差约为 $-2.32$，这表明计数比模型预期少约 $2.32$ 个标准差；在五个类别中，第5类的绝对残差最大，是拟合不足的主要驱动因素。**\n\n-   首先，我们计算第5类的皮尔逊残差：$O_5 = 42$，$E_5 = 60$。\n    $$ r_5 = \\frac{O_5 - E_5}{\\sqrt{E_5}} = \\frac{42 - 60}{\\sqrt{60}} = \\frac{-18}{\\sqrt{60}} \\approx \\frac{-18}{7.746} \\approx -2.3237... $$\n    该值约为 $-2.32$。这是正确的。将此值解释为比期望值低约 $2.32$ 个标准差也是正确的。\n-   接下来，我们必须计算所有残差，以检查第5类是否具有最大的绝对值。\n    -   $r_1 = \\frac{48 - 40}{\\sqrt{40}} = \\frac{8}{\\sqrt{40}} \\approx \\frac{8}{6.325} \\approx 1.265$\n    -   $r_2 = \\frac{70 - 80}{\\sqrt{80}} = \\frac{-10}{\\sqrt{80}} \\approx \\frac{-10}{8.944} \\approx -1.118$\n    -   $r_3 = \\frac{110 - 100}{\\sqrt{100}} = \\frac{10}{10} = 1.000$\n    -   $r_4 = \\frac{130 - 120}{\\sqrt{120}} = \\frac{10}{\\sqrt{120}} \\approx \\frac{10}{10.954} \\approx 0.913$\n-   残差的绝对值约为 $\\{1.265, 1.118, 1.000, 0.913, 2.324\\}$。\n-   最大的绝对残差是 $|r_5| \\approx 2.324$。如此大小的绝对残差是拟合不足的有力指标，因此将其确定为“主要驱动因素”是有效的统计解释。\n-   结论：**正确**。\n\n**D. 皮尔逊残差的符号没有意义；负残差表示比预期更多的计数，并且只有绝对值 $|r_i|$ 对诊断拟合不足有意义。**\n\n-   这个陈述包含多个错误。皮尔逊残差 $r_i = (O_i - E_i)/\\sqrt{E_i}$ 的符号非常有意义。它表示差异的方向：如果 $r_i  0$，则 $O_i  E_i$；如果 $r_i  0$，则 $O_i  E_i$。\n-   声称负残差表示比预期*更多*的计数是错误的。负残差意味着 $O_i - E_i  0$，即 $O_i  E_i$，或比预期*更少*的计数。\n-   虽然绝对值 $|r_i|$ 决定了对 $\\chi^2$ 统计量贡献的大小，但符号对于理解模型在特定类别上*如何*失效至关重要。\n-   结论：**不正确**。\n\n**E. 对于从这五个类别计算出的皮尔逊卡方统计量，其自由度为 $5$，无论单元格概率模型中是否估计了任何参数。**\n\n-   在卡方拟合优度检验中，自由度 ($df$) 的通用公式是 $df = k - 1 - m$，其中 $k$ 是类别数量，$m$ 是从数据中估计出来用以定义零假设的独立参数数量。\n-   在这个问题中，有 $k=5$ 个类别。概率 $p_i$ 是*先验*指定的，而不是从观测数据 $\\{O_i\\}$ 中估计的。因此，$m=0$。\n-   自由度是 $df = 5 - 1 - 0 = 4$。\n-   该陈述声称自由度为 $5$。这是不正确的；它用的是 $k$ 而不是 $k-1$。\n-   该陈述还声称这个值是正确的“无论是否估计了任何参数”，这也是错误的。每估计一个参数，自由度就明确地减少1。\n-   结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "4899481"}, {"introduction": "哈代-温伯格平衡 (Hardy-Weinberg equilibrium) 是群体遗传学中的一个基本原理，而检验某群体是否处于此平衡状态是卡方拟合优度检验的一个经典应用。这个练习尤为重要，因为它展示了一个常见情景：期望频率并非预先固定，而是需要根据从数据中估计出的参数（等位基因频率）来计算。通过这个过程，你将清楚地理解估计参数如何影响检验的自由度 [@problem_id:4899472]。", "problem": "一位生物统计学家正在检验一个具有等位基因 $A$ 和 $a$ 的双等位基因座在大型随机交配种群中是否处于哈迪-温伯格平衡（HWE）状态。从 $n=500$ 个无亲缘关系的二倍体个体中进行简单随机抽样，得到以下观察到的基因型计数：$n_{AA}=310$，$n_{Aa}=150$，$n_{aa}=40$。在种群处于 HWE 的零假设下，基因型概率由等位基因 $A$ 的单个等位基因频率参数 $p$ 决定。\n\n从基因型计数的多项式抽样模型和哈迪-温伯格平衡原理出发，完成以下任务：\n\n- 在种群处于 HWE 的零假设下，推导等位基因 $A$ 频率的最大似然估计 $\\hat{p}$。\n- 使用该估计值，构建 HWE 下三种基因型类别的预期基因型计数。\n- 使用皮尔逊卡方拟合优度检验框架，计算比较观察计数与 HWE 下预期计数的检验统计量。\n\n将您的最终答案表示为卡方检验统计量的单个数值，四舍五入到四位有效数字。不要计算 $p$ 值。最终答案不需要单位。", "solution": "所述问题具有科学依据，提法明确，客观且内部一致。唯一解所需的所有数据均已提供：样本量为 $n=500$ 个个体，观察到的基因型计数为 $n_{AA}=310$，$n_{Aa}=150$ 和 $n_{aa}=40$。计数总和 $310+150+40=500$ 与总样本量 $n$ 相符。任务是执行标准的皮尔逊卡方拟合优度检验以验证哈迪-温伯格平衡（HWE），这是生物统计学中的一个常规程序。我们按以下步骤进行求解。\n\n解决方案按要求包括三个主要步骤：\n1.  推导等位基因 $A$ 频率的最大似然估计（MLE），记为 $p$。\n2.  使用 MLE 计算 HWE 零假设下的预期基因型计数。\n3.  计算皮尔逊卡方检验统计量。\n\n**步骤 1：推导最大似然估计（$\\hat{p}$）**\n\n在 HWE 的零假设下，观察到基因型 $AA$、$Aa$ 和 $aa$ 的概率分别为 $p^2$、$2p(1-p)$ 和 $(1-p)^2$，其中 $p$ 是等位基因 $A$ 的频率。观察到的计数 $(n_{AA}, n_{Aa}, n_{aa})$ 服从总数为 $n$ 且具有这些概率的多项式分布。\n\n观察数据的似然函数 $L(p)$ 与多项式分布的概率质量函数成正比：\n$$L(p | n_{AA}, n_{Aa}, n_{aa}) \\propto (p^2)^{n_{AA}} [2p(1-p)]^{n_{Aa}} [(1-p)^2]^{n_{aa}}$$\n为了找到 MLE，我们最大化对数似然函数 $\\ell(p) = \\ln(L(p))$：\n$$\\ell(p) = \\ln\\left( (p^2)^{n_{AA}} [2p(1-p)]^{n_{Aa}} [(1-p)^2]^{n_{aa}} \\right) + C$$\n其中 $C$ 是一个不依赖于 $p$ 的常数。\n$$\\ell(p) = n_{AA}\\ln(p^2) + n_{Aa}\\ln(2p(1-p)) + n_{aa}\\ln((1-p)^2) + C$$\n$$\\ell(p) = 2n_{AA}\\ln(p) + n_{Aa}(\\ln(2) + \\ln(p) + \\ln(1-p)) + 2n_{aa}\\ln(1-p) + C$$\n对包含 $p$ 的项进行分组：\n$$\\ell(p) = (2n_{AA} + n_{Aa})\\ln(p) + (n_{Aa} + 2n_{aa})\\ln(1-p) + n_{Aa}\\ln(2) + C$$\n为了找到使 $\\ell(p)$ 最大化的 $p$ 值，我们对 $p$ 求一阶导数并令其为零：\n$$\\frac{d\\ell}{dp} = \\frac{2n_{AA} + n_{Aa}}{p} - \\frac{n_{Aa} + 2n_{aa}}{1-p} = 0$$\n求解 MLE, $\\hat{p}$：\n$$\\frac{2n_{AA} + n_{Aa}}{\\hat{p}} = \\frac{n_{Aa} + 2n_{aa}}{1-\\hat{p}}$$\n$$(1-\\hat{p})(2n_{AA} + n_{Aa}) = \\hat{p}(n_{Aa} + 2n_{aa})$$\n$$2n_{AA} + n_{Aa} - \\hat{p}(2n_{AA} + n_{Aa}) = \\hat{p}(n_{Aa} + 2n_{aa})$$\n$$2n_{AA} + n_{Aa} = \\hat{p}(2n_{AA} + n_{Aa} + n_{Aa} + 2n_{aa})$$\n$$2n_{AA} + n_{Aa} = \\hat{p}(2n_{AA} + 2n_{Aa} + 2n_{aa})$$\n因为 $n = n_{AA} + n_{Aa} + n_{aa}$，所以括号中的项是 $2n$。\n$$2n_{AA} + n_{Aa} = \\hat{p}(2n)$$\n因此，等位基因 $A$ 频率的 MLE 是：\n$$\\hat{p} = \\frac{2n_{AA} + n_{Aa}}{2n}$$\n这就是“基因计数”估计量：样本中 $A$ 等位基因的总数除以等位基因的总数（$2n$）。\n\n代入给定值 $n_{AA}=310$，$n_{Aa}=150$ 和 $n=500$：\n$$\\hat{p} = \\frac{2(310) + 150}{2(500)} = \\frac{620 + 150}{1000} = \\frac{770}{1000} = 0.77$$\n等位基因 $a$ 的估计频率是 $\\hat{q} = 1 - \\hat{p} = 1 - 0.77 = 0.23$。\n\n**步骤 2：构建预期基因型计数**\n\nHWE 下的预期基因型计数是使用估计的等位基因频率计算的。\n预期概率为：\n$P(AA) = \\hat{p}^2 = (0.77)^2 = 0.5929$\n$P(Aa) = 2\\hat{p}\\hat{q} = 2(0.77)(0.23) = 0.3542$\n$P(aa) = \\hat{q}^2 = (0.23)^2 = 0.0529$\n\n预期计数 ($E$) 是通过将这些概率乘以总样本量 $n=500$ 得到的：\n$E_{AA} = n \\times \\hat{p}^2 = 500 \\times 0.5929 = 296.45$\n$E_{Aa} = n \\times 2\\hat{p}\\hat{q} = 500 \\times 0.3542 = 177.1$\n$E_{aa} = n \\times \\hat{q}^2 = 500 \\times 0.0529 = 26.45$\n作为检验，预期计数的总和是 $296.45 + 177.1 + 26.45 = 500$，等于总样本量。\n\n**步骤 3：计算卡方检验统计量**\n\n皮尔逊卡方（$\\chi^2$）检验统计量计算为观察计数（$O$）与预期计数（$E$）之差的平方之和，再除以每个类别的预期计数：\n$$\\chi^2 = \\sum_{i \\in \\{AA, Aa, aa\\}} \\frac{(O_i - E_i)^2}{E_i}$$\n观察计数为 $O_{AA}=310$，$O_{Aa}=150$ 和 $O_{aa}=40$。\n预期计数为 $E_{AA}=296.45$，$E_{Aa}=177.1$ 和 $E_{aa}=26.45$。\n\n将这些值代入公式：\n$$\\chi^2 = \\frac{(310 - 296.45)^2}{296.45} + \\frac{(150 - 177.1)^2}{177.1} + \\frac{(40 - 26.45)^2}{26.45}$$\n$$\\chi^2 = \\frac{(13.55)^2}{296.45} + \\frac{(-27.1)^2}{177.1} + \\frac{(13.55)^2}{26.45}$$\n$$\\chi^2 = \\frac{183.6025}{296.45} + \\frac{734.41}{177.1} + \\frac{183.6025}{26.45}$$\n现在，我们计算每一项的值：\n$$\\chi^2 \\approx 0.619335 + 4.146866 + 6.941493$$\n$$\\chi^2 \\approx 11.707694$$\n按要求四舍五入到四位有效数字，得到 $11.71$。该统计量将与自由度为 1 的 $\\chi^2$ 分布进行比较，但题目不要求这最后一步。自由度的计算方法是（类别数）- 1 -（估计参数的个数），即 $3 - 1 - 1 = 1$。", "answer": "$$\\boxed{11.71}$$", "id": "4899472"}, {"introduction": "科学假设往往比将数据与一组固定比例进行比较更为复杂。本练习将探讨如何检验那些对不同类别概率施加了特定关系（即约束条件，如 $p_1 = p_2$）的假设。这需要你运用最大似然估计 (Maximum Likelihood Estimation, MLE) 来找到在这些约束下最拟合的概率，并为你展示一种更通用的方法来确定自由度 [@problem_id:4899436]。", "problem": "一个公共卫生实验室根据生化测试将细菌分离株分为 $6$ 个表型类别。在一个包含 $n=300$ 个分离株的监测样本中，观测到的计数如下：\n- 类别 $1$：$42$\n- 类别 $2$：$58$\n- 类别 $3$：$30$\n- 类别 $4$：$41$\n- 类别 $5$：$29$\n- 类别 $6$：$100$\n\n将该计数向量建模为来自参数向量为 $\\mathbf{p}=(p_{1},p_{2},p_{3},p_{4},p_{5},p_{6})$ 且总数为 $n=300$ 的多项分布的一次抽取。你希望检验一个具有科学动机的原假设，该假设对某些单元格概率施加了相等性约束：在 $H_{0}$ 下，前两个类别是等可能的，接下来的三个类别是等可能的，即：\n$$\nH_{0}:\\; p_{1}=p_{2},\\quad p_{3}=p_{4}=p_{5},\\quad p_{i}\\ge 0,\\quad \\sum_{i=1}^{6}p_{i}=1.\n$$\n\n仅从多项模型的定义和最大似然估计量 (MLE) 的定义出发，并且不假设任何关于检验自由度的预先推导公式：\n1) 推导在 $H_{0}$ 下受约束参数的 MLE 以及相应的期望计数。\n2) 从第一性原理构建皮尔逊拟合优度统计量。\n3) 解释相等性约束如何改变 $H_{0}$ 下参数空间的维度，并利用这一点推导检验统计量的适当大样本参考分布，包括其自由度 (df)，并从多项计数和约束下参数估计的渐近行为来证明你的结果。\n\n最后，使用你推导的参考分布和观测数据，计算该检验的大样本 $p$ 值。将你的最终数值答案四舍五入到四位有效数字，并以纯小数形式表示（不带百分号）。", "solution": "该问题是有效的，因为它基于已建立的统计理论（多项模型、最大似然估计、卡方检验），具有科学依据，其提法是适定的，数据充分且一致，并且表述客观。观测计数之和为 $42+58+30+41+29+100 = 300$，与指定的总样本量 $n=300$ 相匹配。\n\n解答过程按顺序处理问题的不同部分。\n\n**1. 受约束参数的 MLE 和期望计数**\n\n观测计数向量为 $\\mathbf{O} = (O_1, O_2, O_3, O_4, O_5, O_6) = (42, 58, 30, 41, 29, 100)$。分离株总数为 $n=300$。数据被建模为来自具有 $k=6$ 个类别和参数向量 $\\mathbf{p} = (p_1, p_2, p_3, p_4, p_5, p_6)$ 的多项分布的一次抽取。似然函数由下式给出：\n$$\nL(\\mathbf{p} | \\mathbf{O}) \\propto \\prod_{i=1}^{6} p_i^{O_i} = p_1^{42} p_2^{58} p_3^{30} p_4^{41} p_5^{29} p_6^{100}\n$$\n原假设 $H_0$ 施加了约束 $p_1=p_2$ 和 $p_3=p_4=p_5$。我们引入一组更少的参数来反映这些约束。设 $\\theta_A = p_1 = p_2$，$\\theta_B = p_3 = p_4 = p_5$，以及 $\\theta_C = p_6$。在 $H_0$ 下的概率向量是 $(\\theta_A, \\theta_A, \\theta_B, \\theta_B, \\theta_B, \\theta_C)$。条件 $\\sum p_i = 1$ 成为对新参数的约束：\n$$\n2\\theta_A + 3\\theta_B + \\theta_C = 1\n$$\n为了求出 $H_0$ 下参数的最大似然估计量 (MLE)，我们在该约束条件下最大化似然函数。这等价于最大化对数似然函数 $\\ell(\\mathbf{p}) = \\ln(L(\\mathbf{p}))$，并且这样做更简单。代入受约束的参数：\n$$\n\\ell(\\theta_A, \\theta_B, \\theta_C) = 42\\ln(\\theta_A) + 58\\ln(\\theta_A) + 30\\ln(\\theta_B) + 41\\ln(\\theta_B) + 29\\ln(\\theta_B) + 100\\ln(\\theta_C)\n$$\n$$\n\\ell(\\theta_A, \\theta_B, \\theta_C) = (42+58)\\ln(\\theta_A) + (30+41+29)\\ln(\\theta_B) + 100\\ln(\\theta_C)\n$$\n$$\n\\ell(\\theta_A, \\theta_B, \\theta_C) = 100\\ln(\\theta_A) + 100\\ln(\\theta_B) + 100\\ln(\\theta_C)\n$$\n我们使用拉格朗日乘数法来最大化 $\\ell$，其约束条件为 $g(\\theta_A, \\theta_B, \\theta_C) = 2\\theta_A + 3\\theta_B + \\theta_C - 1 = 0$。拉格朗日函数为：\n$$\n\\mathcal{L}(\\theta_A, \\theta_B, \\theta_C, \\lambda) = 100\\ln(\\theta_A) + 100\\ln(\\theta_B) + 100\\ln(\\theta_C) - \\lambda(2\\theta_A + 3\\theta_B + \\theta_C - 1)\n$$\n我们求偏导数并令其为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta_A} = \\frac{100}{\\theta_A} - 2\\lambda = 0 \\implies \\theta_A = \\frac{100}{2\\lambda} = \\frac{50}{\\lambda}\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta_B} = \\frac{100}{\\theta_B} - 3\\lambda = 0 \\implies \\theta_B = \\frac{100}{3\\lambda}\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\theta_C} = \\frac{100}{\\theta_C} - \\lambda = 0 \\implies \\theta_C = \\frac{100}{\\lambda}\n$$\n将这些代入约束方程：\n$$\n2\\left(\\frac{50}{\\lambda}\\right) + 3\\left(\\frac{100}{3\\lambda}\\right) + \\frac{100}{\\lambda} = 1\n$$\n$$\n\\frac{100}{\\lambda} + \\frac{100}{\\lambda} + \\frac{100}{\\lambda} = 1 \\implies \\frac{300}{\\lambda} = 1 \\implies \\lambda = 300\n$$\n现在我们求出 $H_0$ 下参数的 MLE：\n$$\n\\hat{\\theta}_A = \\frac{50}{300} = \\frac{1}{6}\n$$\n$$\n\\hat{\\theta}_B = \\frac{100}{3 \\times 300} = \\frac{1}{9}\n$$\n$$\n\\hat{\\theta}_C = \\frac{100}{300} = \\frac{1}{3}\n$$\n在 $H_0$ 下，完整参数向量 $\\mathbf{p}$ 的 MLE 为：\n$$\n\\hat{\\mathbf{p}}_{H_0} = (\\hat{p}_1, \\hat{p}_2, \\hat{p}_3, \\hat{p}_4, \\hat{p}_5, \\hat{p}_6) = \\left(\\frac{1}{6}, \\frac{1}{6}, \\frac{1}{9}, \\frac{1}{9}, \\frac{1}{9}, \\frac{1}{3}\\right)\n$$\n在 $H_0$ 下，期望计数 $E_i$ 计算为 $E_i = n\\hat{p}_i$：\n- $E_1 = n\\hat{p}_1 = 300 \\times \\frac{1}{6} = 50$\n- $E_2 = n\\hat{p}_2 = 300 \\times \\frac{1}{6} = 50$\n- $E_3 = n\\hat{p}_3 = 300 \\times \\frac{1}{9} = \\frac{100}{3}$\n- $E_4 = n\\hat{p}_4 = 300 \\times \\frac{1}{9} = \\frac{100}{3}$\n- $E_5 = n\\hat{p}_5 = 300 \\times \\frac{1}{9} = \\frac{100}{3}$\n- $E_6 = n\\hat{p}_6 = 300 \\times \\frac{1}{3} = 100$\n\n**2. 皮尔逊拟合优度统计量**\n\n皮尔逊拟合优度统计量 $\\chi^2$ 定义为观测计数与期望计数之差的平方和，并用期望计数进行标准化：\n$$\n\\chi^2 = \\sum_{i=1}^{k} \\frac{(O_i - E_i)^2}{E_i}\n$$\n使用观测计数 $\\mathbf{O}=(42, 58, 30, 41, 29, 100)$ 和推导出的期望计数：\n$$\n\\chi^2 = \\frac{(42 - 50)^2}{50} + \\frac{(58 - 50)^2}{50} + \\frac{(30 - 100/3)^2}{100/3} + \\frac{(41 - 100/3)^2}{100/3} + \\frac{(29 - 100/3)^2}{100/3} + \\frac{(100 - 100)^2}{100}\n$$\n$$\n\\chi^2 = \\frac{(-8)^2}{50} + \\frac{8^2}{50} + \\frac{(-10/3)^2}{100/3} + \\frac{(23/3)^2}{100/3} + \\frac{(-13/3)^2}{100/3} + 0\n$$\n$$\n\\chi^2 = \\frac{64}{50} + \\frac{64}{50} + \\frac{100/9}{100/3} + \\frac{529/9}{100/3} + \\frac{169/9}{100/3}\n$$\n$$\n\\chi^2 = 1.28 + 1.28 + \\frac{100}{9}\\frac{3}{100} + \\frac{529}{9}\\frac{3}{100} + \\frac{169}{9}\\frac{3}{100}\n$$\n$$\n\\chi^2 = 2.56 + \\frac{1}{3} + \\frac{529}{300} + \\frac{169}{300}\n$$\n为了精确求和，我们使用公分母 $300$：\n$$\n\\chi^2 = \\frac{256 \\times 3}{100 \\times 3} + \\frac{1 \\times 100}{3 \\times 100} + \\frac{529}{300} + \\frac{169}{300} = \\frac{768}{300} + \\frac{100}{300} + \\frac{529}{300} + \\frac{169}{300}\n$$\n$$\n\\chi^2 = \\frac{768 + 100 + 529 + 169}{300} = \\frac{1566}{300} = 5.22\n$$\n\n**3. 参考分布和自由度的推导**\n\n皮尔逊统计量的大样本参考分布是卡方 ($\\chi^2$) 分布。自由度 (df) 由参数空间的维度决定。\n\n- **无约束模型：** 完整参数空间由向量 $\\mathbf{p} = (p_1, \\dots, p_6)$ 组成，受单个约束 $\\sum_{i=1}^6 p_i = 1$ 的限制。自由参数的数量，即该空间的维度，是 $6 - 1 = 5$。\n\n- **约束模型 ($H_0$)：** 原假设施加了额外的相等性约束：$p_1 = p_2$ 和 $p_3 = p_4 = p_5$。\n  - 约束 $p_1 = p_2$ 可以写成一个线性方程：$p_1 - p_2 = 0$。\n  - 约束 $p_3 = p_4 = p_5$ 可以写成两个独立的线性方程，例如：$p_3 - p_4 = 0$ 和 $p_4 - p_5 = 0$。\n  - 这些是 $H_0$ 对参数施加的 $1+2=3$ 个独立约束。\n\n$H_0$ 下参数空间的维度是无约束空间的维度减去假设施加的独立约束的数量。\n$$\n\\text{dim}(H_0) = (6 - 1) - 3 = 2\n$$\n或者，在 $H_0$ 下，概率向量由三个参数 $(\\theta_A, \\theta_B, \\theta_C)$ 确定，并受一个约束 $2\\theta_A + 3\\theta_B + \\theta_C = 1$ 的限制。因此，自由参数的数量是 $3 - 1 = 2$。例如，如果我们指定了 $\\theta_A$ 和 $\\theta_B$，那么 $\\theta_C$ 就是固定的。\n\n卡方拟合优度检验的自由度由以下公式给出：\n$$\n\\text{df} = (\\text{类别数} - 1) - (\\text{估计的独立参数个数})\n$$\n此处，类别数为 $k=6$。从数据中估计用于定义原假设概率的独立参数个数是 $H_0$ 下参数空间的维度，即 $2$。\n$$\n\\text{df} = (6 - 1) - 2 = 3\n$$\n这个结果源于最大似然估计量的渐近理论。标准化的单元格计数向量渐近服从一个多元正态分布。皮尔逊统计量是该向量的一个二次型，它服从 $\\chi^2$ 分布。从数据中估计的每个参数都会对单元格计数残差施加一个额外的线性约束，从而使所得分布的自由度减一。由于我们估计了两个独立参数（$\\hat{\\theta}_A$ 和 $\\hat{\\theta}_B$）来找到期望计数，我们从基准的 $k-1=5$ 中失去了两个自由度。\n\n因此，该检验统计量的适当大样本参考分布是自由度为 $3$ 的卡方分布，记为 $\\chi^2_3$。\n\n**4. 大样本 p 值**\n\np 值是在假设原假设为真的情况下，观测到与计算出的检验统计量一样极端或更极端的检验统计量的概率。我们计算 $P(\\chi^2_3 \\ge 5.22)$。\n使用计算工具或自由度为 $df=3$ 的详细卡方分布表：\n$$\np\\text{值} = P(\\chi^2_3 \\ge 5.22) \\approx 0.15638\n$$\n按要求四舍五入到四位有效数字，p 值为 $0.1564$。\n由于该 p 值大于常规的显著性水平（例如 $\\alpha = 0.05$），我们不拒绝原假设。观测数据与所提出的 $p_1=p_2$ 和 $p_3=p_4=p_5$ 的模型是一致的。", "answer": "$$\\boxed{0.1564}$$", "id": "4899436"}]}