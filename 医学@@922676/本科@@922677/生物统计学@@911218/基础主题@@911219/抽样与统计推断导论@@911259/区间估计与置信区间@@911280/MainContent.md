## 引言
在任何依赖样本数据的科学研究中，结论都伴随着不确定性。[区间估计](@entry_id:177880)，特别是[置信区间](@entry_id:138194)的构建与解释，是量化并传达这种不确定性的基石。它超越了[假设检验](@entry_id:142556)提供的简单“是/否”答案，为我们提供了一个关于未知总体参数（如效应大小或风险因素强度）的合理取值范围。然而，对[置信区间](@entry_id:138194)的深刻理解远不止于记住其计算公式，它要求我们掌握其背后的统计哲学，并能根据不同的科学问题和数据类型选择和应用恰当的方法。

本文旨在系统性地填补从基础概念到高级应用之间的知识鸿沟。我们将不再停留于表面，而是深入探索[区间估计](@entry_id:177880)的理论核心与实践智慧。通过学习，您将不仅能够正确计算[置信区间](@entry_id:138194)，更能洞悉其内在逻辑，辨析不同类型区间的差异，并将其灵活运用于复杂的科研实践。

为实现这一目标，本文将分为三个核心章节。在“原理与机制”部分，我们将剖析[置信区间](@entry_id:138194)的频率主义基础，介绍枢轴量法、[大样本理论](@entry_id:175645)和自助法等核心构建技术。接下来，在“应用与跨学科联系”部分，我们将通过临床试验、流行病学研究和统计建模中的丰富案例，展示这些理论如何转化为解决实际问题的强大工具。最后，“动手实践”部分将提供精选的练习，帮助您将理论知识付诸实践，巩固并深化您的理解。

## 原理与机制

本章旨在深入探讨[区间估计](@entry_id:177880)的核心原理与机制。在前一章介绍其基本概念之后，我们将系统性地剖析[置信区间](@entry_id:138194)的构建方法、阐释其严谨的统计学意义，并区分不同类型的[区间估计](@entry_id:177880)，以应对生物统计学中多样化的科学问题。

### [置信区间](@entry_id:138194)的[频率主义诠释](@entry_id:173710)

要精确地应用和解读[区间估计](@entry_id:177880)，首先必须掌握其背后的频率主义哲学。这一视角定义了[置信区间](@entry_id:138194)的本质，并将其与其它推断范式（如贝叶斯推断）明确区分开来。

#### 定义与核心思想

在[频率主义统计学](@entry_id:175639)中，我们待估计的总体参数，例如[总体均值](@entry_id:175446) $\mu$ 或比例 $p$，被视为一个**固定但未知**的常数。随机性并非源于参数本身，而是源于我们的抽样过程。每次抽样都会得到一组不同的数据，从而计算出一个不同的样本统计量（如样本均值 $\bar{x}$）。

一个 $(1-\alpha)$ **[置信区间](@entry_id:138194) (Confidence Interval, CI)** 是一个由样本数据决定的**随机区间**，其构造过程保证了在大量重复实验中，该区间包含真实参数 $\theta$ 的比例不小于 $(1-\alpha)$。形式上，若 $C(X)$ 是一个由随机样本 $X$ 构成的区间，那么它被称为一个 $(1-\alpha)$ [置信区间](@entry_id:138194)，如果对于所有可能的参数值 $\theta$，都满足：

$$
P_{\theta}(\theta \in C(X)) \ge 1-\alpha
$$

这里的概率 $P_{\theta}$ 是在以 $\theta$ 为真值的样本分布下计算的。这个概率描述的是**程序**的长期性能，而非单个、已实现的区间的性质。

理解这一点的关键在于区分“实验前”和“实验后”。**实验前**，数据尚未观测，区间 $C(X)$ 是一个端点随样本而变的随机变量，我们有 $(1-\alpha)$ 的“信心”它将覆盖住真值 $\theta$。**实验后**，我们观测到具体数据 $x$，并计算出一个具体的、固定的数值区间 $C(x)$，例如 $[10.2, 15.8]$。此时，固定的真值 $\theta$ 要么在这个区间内，要么不在。不存在概率问题，该论断的真实性非真即假。因此，诸如“对于我计算出的这个 $[10.2, 15.8]$ 区间，真实均值 $\mu$ 有 $95\%$ 的概率落于其中”的表述，是对频率主义[置信区间](@entry_id:138194)的根本性误解 [@problem_id:4805533, @problem_id:4805604]。正确的表述应为：“我用来构建这个区间的**方法**，在长期重复使用下，有 $95\%$ 的成功率（即生成的区间能包含真实参数）。”

#### 频率主义解释的严格化：大数定律

置信水平的“长期频率”含义可以通过[大数定律](@entry_id:140915)（Law of Large Numbers, LLN）得到严格的数学表述。设想我们在相同的真实参数 $\theta$ 下，独立重复进行 $m$ 次实验，每次都构建一个 $(1-\alpha)$ [置信区间](@entry_id:138194)。令 $I\{\theta \in C(X_i)\}$ 为一个[指示变量](@entry_id:266428)，当第 $i$ 次实验得到的区间 $C(X_i)$ 包含 $\theta$ 时取值为1，否则为0。

这个指示变量的[期望值](@entry_id:150961)等于其取值为1的概率，即覆盖概率：

$$
E_{\theta}[I\{\theta \in C(X_i)\}] = P_{\theta}(\theta \in C(X_i))
$$

根据[置信区间](@entry_id:138194)的定义，这个概率至少为 $1-\alpha$。根据[弱大数定律](@entry_id:159016)（WLLN），当重复实验次数 $m$ 趋于无穷时，这 $m$ 个区间中成功覆盖真实参数 $\theta$ 的经验比例（即[指示变量](@entry_id:266428)的样本均值）将依概率收敛于其[期望值](@entry_id:150961)，即真实的覆盖概率。这意味着，长期来看，我们观察到的成功覆盖频率将接近（并至少为）我们预设的[置信水平](@entry_id:182309) $1-\alpha$ [@problem_id:4805533]。

#### [置信区间](@entry_id:138194) vs. [贝叶斯可信区间](@entry_id:183625)

对[置信区间](@entry_id:138194)的误解常常源于与[贝叶斯推断](@entry_id:146958)中**[可信区间](@entry_id:176433) (Credible Interval)** 的混淆。贝叶斯学派将参数 $\theta$ 视为一个随机变量，并为其赋予一个**先验分布 (prior distribution)** $\pi(\theta)$，该分布反映了我们在观测数据前对 $\theta$ 的信念。在观测到数据 $x$ 后，通过贝叶斯定理，[先验分布](@entry_id:141376)被更新为**后验分布 (posterior distribution)** $\pi(\theta|x)$。

一个 $(1-\alpha)$ [可信区间](@entry_id:176433)是后验分布上的一个区间，它包含参数 $\theta$ 的后验概率为 $(1-\alpha)$。也就是说，对于一个计算出的[可信区间](@entry_id:176433) $C(x)$，贝叶斯主义者可以理直气壮地宣称：

$$
P(\theta \in C(x) | X=x) = 1-\alpha
$$

这正是在频率主义框架下被禁止的表述。[置信区间](@entry_id:138194)和[可信区间](@entry_id:176433)的根本区别在于：[置信区间](@entry_id:138194)对**数据**的[抽样分布](@entry_id:269683)做概率陈述，而[可信区间](@entry_id:176433)对**参数**的后验分布做概率陈述 [@problem_id:4805604]。

在某些特殊情况下，例如对正态均值使用特定的“无信息”先验（如均匀分布的非正常（improper）先验）时，计算出的[贝叶斯可信区间](@entry_id:183625)在数值上可能与频率主义[置信区间](@entry_id:138194)完全相同。然而，它们的解释截然不同。当使用有信息的先验时，例如，在分析一项新疗法改变血压的临床研究中，若研究者基于先验知识认为血压变化均值 $\theta$ 可能接近-2 mmHg，并设定了一个 $\mathcal{N}(-2, 2^2)$ 的先验分布，那么即使观测到的样本均值为-5 mmHg，最终的[贝叶斯可信区间](@entry_id:183625)也会被[先验信息](@entry_id:753750)“拉向”先验均值-2，其结果通常会与纯粹基于数据的频率主义[置信区间](@entry_id:138194)产生差异 [@problem_id:4805604, @problem_id:4919239]。类似地，**费雪（Fisher）的基准推断 (fiducial inference)** 也试图在不引入先验的情况下为参数做出后验概率陈述，在某些简单模型（如已知方差的正态模型）中，其生成的基准区间（fiducial interval）在数值上亦可与[置信区间](@entry_id:138194)重合，但其逻辑基础也与频率主义不同 [@problem_id:4919239]。

#### [假设检验与置信区间](@entry_id:176458)的对偶性

[置信区间与假设检验](@entry_id:178870)之间存在着深刻而实用的**对偶关系 (duality)**。一个 $(1-\alpha)$ [置信区间](@entry_id:138194)的构建过程可以等价地视为对所有可能的参数值 $\theta_0$ 进行一系列[显著性水平](@entry_id:170793)为 $\alpha$ 的假设检验。

具体而言，一个 $(1-\alpha)$ 置信集 $C(X)$ 可以被定义为所有那些“可信”的参数值 $\theta_0$ 的集合，即对于这些 $\theta_0$，原假设 $H_0: \theta = \theta_0$ **不会**被一个 $\alpha$ 水平的检验所拒绝。反之，如果我们已经有了一个 $(1-\alpha)$ [置信区间](@entry_id:138194)，就可以用它来进行[假设检验](@entry_id:142556)：对于任何一个原假设 $H_0: \theta = \theta_0$，如果 $\theta_0$ 不在[置信区间](@entry_id:138194)内，我们就在 $\alpha$ 水平上拒绝 $H_0$。

这种对偶性在临床试验中应用广泛。例如，在非劣效性检验中，我们的目标是证明新药（T）不比标准疗法（C）差太多，即风险差 $\theta = p_T - p_C$ 小于一个预设的非劣效性界值 $\Delta$。这等价于检验 $H_0: \theta \ge \Delta$ vs. $H_A: \theta  \Delta$。通过对偶性，我们可以构建一个单侧 $(1-\alpha)$ [置信区间](@entry_id:138194)，并检查其上限是否小于 $\Delta$。如果小于，则可以在 $\alpha$ 水平上拒绝 $H_0$，宣布非劣效性成立 [@problem_id:4805533]。

### [置信区间](@entry_id:138194)的构建：[枢轴量](@entry_id:168397)法

既然我们理解了[置信区间](@entry_id:138194)的哲学，下一个问题就是如何具体地构建它们。对于许多参数模型，最经典和最严谨的方法是**枢轴量法 (pivotal method)**。

#### 什么是[枢轴量](@entry_id:168397)？

一个**[枢轴量](@entry_id:168397) (pivotal quantity)** 或**枢轴统计量 (pivot)** 是一个同时依赖于样本数据和待估参数的函数，其特殊之处在于它的**[抽样分布](@entry_id:269683)完全已知，且不依赖于任何未知参数**。找到了这样的枢轴量，就等于找到了构建精确[置信区间](@entry_id:138194)的“钥匙”。

#### 案例一：已知方差的正态总体均值

让我们从最简单的情景开始：我们有一组来自正态分布 $\mathcal{N}(\mu, \sigma^2)$ 的[独立同分布](@entry_id:169067)样本 $X_1, \dots, X_n$，其中总体方差 $\sigma^2$ 是已知的，而均值 $\mu$ 未知。

我们知道样本均值 $\bar{X} = \frac{1}{n}\sum X_i$ 的抽样分布是 $\bar{X} \sim \mathcal{N}(\mu, \sigma^2/n)$。对其进行标准化，我们得到：

$$
Z = \frac{\bar{X} - \mu}{\sigma/\sqrt{n}}
$$

这个量 $Z$ 的分布是 $\mathcal{N}(0, 1)$，即[标准正态分布](@entry_id:184509)。请注意，$Z$ 是数据的函数（通过 $\bar{X}$），也是参数的函数（通过 $\mu$），但其自身的分布 $\mathcal{N}(0, 1)$ 不依赖于未知的 $\mu$ 或已知的 $\sigma$。因此，$Z$ 是一个用于推断 $\mu$ 的[枢轴量](@entry_id:168397)。

构建[置信区间](@entry_id:138194)的过程就是“反演”这个枢轴量。我们从一个关于[枢轴量](@entry_id:168397)的概率声明开始。令 $z_{1-\alpha/2}$ 表示[标准正态分布](@entry_id:184509)的 $(1-\alpha/2)$ 分位数（即其右侧尾部面积为 $\alpha/2$ 的临界值，也可用[逆累积分布函数](@entry_id:266870) $\Phi^{-1}(1-\alpha/2)$ 表示）。我们有：

$$
P\left( -z_{1-\alpha/2} \le \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \le z_{1-\alpha/2} \right) = 1-\alpha
$$

接下来，我们在不等式内部进行代数变换，以隔离出参数 $\mu$：

$$
-z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}} \le \bar{X} - \mu \le z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}}
$$

$$
-\bar{X} - z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}} \le -\mu \le -\bar{X} + z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}}
$$

$$
\bar{X} - z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}} \le \mu \le \bar{X} + z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}}
$$

我们就得到了关于 $\mu$ 的 $(1-\alpha)$ [置信区间](@entry_id:138194)的表达式：

$$
\left[ \bar{X} - z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}}, \bar{X} + z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}} \right]
$$

这个区间可以写成 $\bar{X} \pm w$，其中**半宽度 (half-width)** $w = z_{1-\alpha/2} \frac{\sigma}{\sqrt{n}}$，它仅由置信水平 $\alpha$、[总体标准差](@entry_id:188217) $\sigma$ 和样本量 $n$ 决定 [@problem_id:4805542]。

#### 案例二：未知方差的正态[总体均值](@entry_id:175446)

在绝大多数实际应用中，总体方差 $\sigma^2$ 也是未知的。此时，量 $Z = (\bar{X} - \mu) / (\sigma/\sqrt{n})$ 不再是枢轴量，因为它依赖于未知参数 $\sigma$。

自然的思路是用样本标准差 $S = \sqrt{\frac{1}{n-1}\sum(X_i - \bar{X})^2}$ 来估计 $\sigma$。我们构造一个新的统计量：

$$
T = \frac{\bar{X} - \mu}{S/\sqrt{n}}
$$

这个量是否是[枢轴量](@entry_id:168397)呢？答案是肯定的。根据正态总体的[抽样理论](@entry_id:268394)（Cochran定理的一个推论），我们有以下两个关键事实：
1.  $\frac{(n-1)S^2}{\sigma^2}$ 服从自由度为 $(n-1)$ 的**卡方分布 ($\chi^2_{n-1}$)**。
2.  $\bar{X}$ 和 $S^2$ 是相互独立的随机变量。

我们可以将 $T$ 统计量巧妙地改写为：

$$
T = \frac{(\bar{X} - \mu)/(\sigma/\sqrt{n})}{\sqrt{S^2/\sigma^2}} = \frac{\mathcal{N}(0,1) \text{ 变量}}{\sqrt{(\chi^2_{n-1} \text{ 变量})/(n-1)}}
$$

根据定义，一个标准正态随机变量与一个独立的、除以其自由度的卡方随机变量的平方根之比，服从**[学生t分布](@entry_id:267063) ([Student's t-distribution](@entry_id:142096))**，其自由度与卡方分布相同。因此，我们得到：

$$
T = \frac{\bar{X} - \mu}{S/\sqrt{n}} \sim t_{n-1}
$$

$T$ 的分布 $t_{n-1}$ 仅依赖于样本量 $n$，不依赖于任何未知参数 $\mu$ 或 $\sigma^2$。所以，$T$ 是在 $\sigma^2$ 未知时推断 $\mu$ 的正确[枢轴量](@entry_id:168397) [@problem_id:4560486]。

这里的**自由度 (degrees of freedom)** 参数 $\nu = n-1$ 源于对 $\sigma^2$ 的估计。在计算样本方差 $S^2$ 时，我们使用了 $n$ 个离差 $(X_i - \bar{X})$，但这些离差受到一个[线性约束](@entry_id:636966) $\sum(X_i - \bar{X}) = 0$ 的限制。这意味着，一旦前 $n-1$ 个离差确定，最后一个就随之确定了。因此，实际上只有 $n-1$ 个“自由”的信息片段可用于估计方差 [@problem_id:4919248]。

构建[置信区间](@entry_id:138194)的步骤与已知方差时完全类似，只是将 $z$ 分布替换为 $t$ 分布：

$$
\left[ \bar{X} - t_{1-\alpha/2, n-1} \frac{S}{\sqrt{n}}, \bar{X} + t_{1-\alpha/2, n-1} \frac{S}{\sqrt{n}} \right]
$$

其中 $t_{1-\alpha/2, n-1}$ 是自由度为 $n-1$ 的[t分布](@entry_id:267063)的 $(1-\alpha/2)$ [分位数](@entry_id:178417)。由于t分布比标准正态分布的尾部更“厚”（尤其是在 $n$ 较小时），这反映了因估计 $\sigma$ 而引入的额外不确定性，导致 $t$ 临界值大于对应的 $z$ 临界值，从而区间更宽。

### 超越均值估计：区间类型的区分

[置信区间](@entry_id:138194)的概念非常普遍，但精确理解其目标至关重要。同一个数据集可以用来回答不同类型的科学问题，从而需要构建不同类型的区间。对于一个正态分布的生物标志物，以下三种区间有着本质的区别 [@problem_id:4919244]。

#### [置信区间](@entry_id:138194) (Confidence Interval, CI)
这是我们已经熟悉的区间，其目标是估计一个**固定的总体参数**，如总体均值 $\mu$。它量化了我们对该参数真实位置的不确定性。
- **目标**: 估计 $\mu$
- **公式 (未知方差)**: $\bar{x} \pm t_{1-\alpha/2, n-1} \frac{s}{\sqrt{n}}$

#### [预测区间](@entry_id:635786) (Prediction Interval, PI)
[预测区间](@entry_id:635786)的目标是为一个**未来的、单个新观测值** $X_{\text{new}}$ 提供一个范围。它的不确定性来源有两个：(1) 对总体均值 $\mu$ 的估计不确定性（由 $\bar{x}$ 体现），以及 (2) 单个观测值围绕总体均值 $\mu$ 的固有随机变异性（由 $\sigma$ 体现）。因此，[预测区间](@entry_id:635786)必须比[置信区间](@entry_id:138194)更宽。
- **目标**: 预测 $X_{\text{new}}$
- **关键量**: 预测误差 $X_{\text{new}} - \bar{X}$，其方差为 $\text{Var}(X_{\text{new}}) + \text{Var}(\bar{X}) = \sigma^2 + \sigma^2/n = \sigma^2(1+1/n)$。
- **公式 (未知方差)**: $\bar{x} \pm t_{1-\alpha/2, n-1} s \sqrt{1 + \frac{1}{n}}$

注意到PI公式中的因子 $\sqrt{1+1/n}$ 总是大于CI公式中的 $1/\sqrt{n}$，并且当 $n \to \infty$ 时，$\sqrt{1+1/n} \to 1$，而 $1/\sqrt{n} \to 0$。这意味着即使样本量极大，对均值的估计非常精确（CI趋向于一个点），但预测单个新观测值的固有不确定性（由 $\sigma$ 决定）仍然存在，PI的宽度会趋向于 $\pm z_{1-\alpha/2} \sigma$。

#### 容忍区间 (Tolerance Interval, TI)
容忍区间的目标则更为宏大：它旨在以一定的[置信度](@entry_id:267904) $\gamma$ 捕获**总体分布中至少一定比例 $p$ 的个体**。例如，我们可能希望有 $95\%$ 的信心（$\gamma=0.95$）确定一个区间，该区间能覆盖人群中 $90\%$ ($p=0.90$) 的生物标志物值。
- **目标**: 覆盖总体分布中至少比例为 $p$ 的部分。
- **公式 (未知方差)**: $\bar{x} \pm k \cdot s$

这里的因子 $k$ 的计算比CI或PI复杂得多。它需要同时考虑 $\bar{x}$ 和 $s$ 的抽样不确定性，并确保随机覆盖比例 $\text{Coverage}(\bar{X}, S)$ 大于等于 $p$ 的概率至少为 $\gamma$。即 $k$ 的取值需要满足：
$$
\Pr \left( \Phi\left(\frac{\bar{X}-\mu}{\sigma} + k\frac{S}{\sigma}\right) - \Phi\left(\frac{\bar{X}-\mu}{\sigma} - k\frac{S}{\sigma}\right) \ge p \right) = \gamma
$$
这个 $k$ 值通常通过查表或专用软件计算，它依赖于 $n$, $p$ 和 $\gamma$。

总之，CI针对参数，PI针对单个未来观测，TI针对总体分布的大部分。三者回答的问题不同，宽度也依次递增：CI  PI  TI (对于典型的 $p$ 和 $\gamma$ 值)。

### 大样本方法：渐近[置信区间](@entry_id:138194)

枢轴量法非常优雅，但它依赖于严格的分布假设（如正态性），且并非总能找到合适的枢轴量。当样本量 $n$ 足够大时，我们可以借助**[中心极限定理](@entry_id:143108) (Central Limit Theorem, CLT)** 等[大样本理论](@entry_id:175645)来构建**渐近[置信区间](@entry_id:138194) (asymptotic confidence intervals)**。

一个典型的例子是估计二项分布的比例参数 $p$。设在 $n$ 次试验中观察到 $X$ 次成功，则 $p$ 的[最大似然估计](@entry_id:142509)（MLE）为 $\hat{p} = X/n$。根据CLT，当 $n$ 较大时，$\hat{p}$ 近似服从正态分布：

$$
\hat{p} \approx \mathcal{N}\left(p, \frac{p(1-p)}{n}\right)
$$

基于此，发展出了多种通过检验反演得到的渐近区间构造方法 [@problem_id:4805592]。

#### 三种主要的[渐近方法](@entry_id:177759)

1.  **沃尔德（Wald）区间**: 这是最直接的方法，它将上式中的未知方差 $p(1-p)/n$ 用其MLE估计 $\hat{p}(1-\hat{p})/n$ 代替，构造出一个近似的枢轴量 $(\hat{p}-p)/\sqrt{\hat{p}(1-\hat{p})/n}$。反演后得到沃尔德区间：
    $$
    \hat{p} \pm z_{1-\alpha/2} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}
    $$
    沃尔德区间计算简单，但性能较差。在小样本或当 $p$ 接近0或1时，其真实覆盖概率可能远低于名义水平 $(1-\alpha)$。特别地，当 $X=0$ 或 $X=n$ 时，$\hat{p}$ 为0或1，导致区间宽度为0，这显然是不合理的。此外，其端点可能超出 $[0,1]$ 的合理范围。

2.  **分数（Score）区间 (又称Wilson区间)**: 此方法反演的是分数检验。分数检验在计算方差时，使用的是原假设下的参数值 $p_0$，而非MLE $\hat{p}$。因此，分数区间是所有满足以下不等式的 $p_0$ 的集合：
    $$
    \frac{|\hat{p} - p_0|}{\sqrt{p_0(1-p_0)/n}} \le z_{1-\alpha/2}
    $$
    解这个关于 $p_0$ 的二次不等式可以得到区间的解析表达式。分数区间的性能远优于沃尔德区间，尤其是在小样本和边界情况下，其覆盖概率更接近名义水平，且端点总在 $[0,1]$ 内。

3.  **似然比（Likelihood-Ratio, LR）区间**: 此方法反演[似然比检验](@entry_id:268070)。[似然比检验统计量](@entry_id:169778)为 $\lambda(p_0) = 2[\ln L(\hat{p}) - \ln L(p_0)]$，其中 $L(\cdot)$ 是[似然函数](@entry_id:141927)。根据[Wilks定理](@entry_id:169826)，在大样本下，$\lambda(p_0)$ 近似服从 $\chi^2_1$ 分布。因此，LR区间由所有满足 $\lambda(p_0) \le \chi^2_{1, 1-\alpha}$ 的 $p_0$ 构成。该区间的性能通常与分数区间相当，都非常出色。

#### [重参数化不变性](@entry_id:197540)

一个理想的[统计推断](@entry_id:172747)方法不应因参数的表示方式改变而改变结论。例如，对比例 $p$ 进行[logit变换](@entry_id:272173) $\theta = \ln(p/(1-p))$，在 $\theta$ 的尺度上做分析，再将结果变换回 $p$ 的尺度，所得结论应与直接在 $p$ 尺度上分析一致。这个性质称为**[重参数化不变性](@entry_id:197540) (invariance to reparameterization)**。

-   **[似然比检验](@entry_id:268070)和LR区间是具有不变性的**。因为似然函数的值本身不依赖于参数的表达形式。
-   **沃尔德检验和[Wald区间](@entry_id:173132)不具有不变性**。为 $\theta$ 构建的[Wald区间](@entry_id:173132)变换回 $p$ 尺度后，与直接为 $p$ 构建的[Wald区间](@entry_id:173132)不同。这实际上有时被用作一种“疗法”：在变换后的尺度上（如logit尺度）构建[Wald区间](@entry_id:173132)，其性能可能优于原始尺度。
-   **分数检验和Score区间也不具有不变性**。

因此，从理论优雅性角度看，LR方法更具优势 [@problem_id:4805592]。

### 评估区间性能：覆盖概率的精确性

我们已经看到，不同的区间构造方法性能各异。我们可以根据其覆盖概率 $C(p, n) = \Pr_p(p \in \mathcal{I}_\alpha(X))$ 的性质，对它们进行分类 [@problem_id:4919252]。

-   **精确区间 (Exact Interval)**: 一个理想的区间应满足 $C(p,n) = 1-\alpha$ 对于所有 $p$ 和有限的 $n$ 都成立。然而，对于[离散分布](@entry_id:193344)（如二项分布），由于其概率质量函数是阶梯状的，任何非随机化的区间构造方法的覆盖概率函数 $C(p,n)$ 必然是 $p$ 的一个波动多项式，不可能恒等于 $1-\alpha$。因此，“精确”区间在离散情况下是一个无法达成的理想。

-   **保守区间 (Conservative Interval)**: 既然无法精确达到，一个退而求其次的可靠保证是确保覆盖概率**永不低于**名义水平。一个保守区间满足 $C(p,n) \ge 1-\alpha$ 对于所有 $p$ 和有限的 $n$ 都成立。这提供了一个统一的、最差情况下的性能保证。著名的Clopper-Pearson区间就是二项比例的一个保守区间。其代价通常是区间比必要的更宽，导致覆盖率在多数 $p$ 值下都“过于”保守（远大于 $1-\alpha$）。

-   **渐近区间 (Asymptotic Interval)**: 这类区间（如Wald, Score, LR）的保证只在样本量趋于无穷的极限下成立。即对于每个固定的 $p$，我们有 $\lim_{n \to \infty} C(p, n) = 1-\alpha$。在任何**有限**样本量 $n$ 下，其覆盖概率 $C(p,n)$ 可能在 $1-\alpha$ 上下波动，对某些 $p$ 值可能显著低于名义水平。这种收敛通常不是在 $p$ 上一致的，意味着对于任意大的 $n$，总可能存在某些（通常是接近边界的）$p$ 值使得覆盖性能很差。

### 计算密集型方法：[自助法](@entry_id:139281)（Bootstrap）

当分布形式未知或过于复杂，以至于难以应用枢轴量法或[渐近理论](@entry_id:162631)时，我们可以求助于现代的计算密集型方法，其中最著名的就是**[自助法](@entry_id:139281) (Bootstrap)**。

#### 自助法的核心思想

Bootstrap的核心思想是：用**样本自身**来模拟**从总体到样本**的抽样过程。如果样本足够大，那么样本的[经验分布](@entry_id:274074)可以看作是总体分布的一个良好近似。因此，我们可以通过从原始样本中有放回地[重复抽样](@entry_id:274194)来模拟“从总体中抽取新样本”的过程。

具体步骤如下：
1.  我们有原始样本，大小为 $n$。计算出我们关心的统计量 $\hat{\theta}$。
2.  从原始样本中**有放回地**抽取 $n$ 个观测值，形成一个“自助样本 (bootstrap sample)”。
3.  基于这个自助样本，计算出相应的统计量，记为 $\hat{\theta}^*_1$。
4.  重复步骤2和3共 $B$ 次（$B$ 通常很大，如1000或10000），得到 $B$ 个自助统计量 $\hat{\theta}^*_1, \hat{\theta}^*_2, \dots, \hat{\theta}^*_B$。
5.  这 $B$ 个值的[经验分布](@entry_id:274074)，就构成了对真实抽样分布 $\hat{\theta}$ 的近似。

#### 百分位[置信区间](@entry_id:138194)

利用自助法得到的分布，最简单的区间构造方法是**百分位法 (percentile method)**。我们直接取自助统计量分布的经验[分位数](@entry_id:178417)作为[置信区间](@entry_id:138194)的端点。

一个 $(1-\alpha)$ 的百分位[置信区间](@entry_id:138194)由自助分布的 $\alpha/2$ 和 $1-\alpha/2$ [分位数](@entry_id:178417)构成：

$$
[\hat{q}_{\alpha/2}, \hat{q}_{1-\alpha/2}]
$$

其中 $\hat{q}_{\gamma}$ 是 $\{\hat{\theta}^*_b\}_{b=1}^B$ 的第 $100\gamma$ 百分位数。

百分位区间具有一些重要性质 [@problem_id:4805519]：
-   **一阶准确性 (First-order accuracy)**: 其覆盖概率误差为 $O(n^{-1/2})$，与标准的基于[正态近似](@entry_id:261668)的区间（如[Wald区间](@entry_id:173132)）在同一水平。
-   **变换等价性 (Transformation equivariance)**: 这是百分位法的一个突出优点。如果对参数 $\theta$ 进行一个单调变换 $g(\theta)$，那么新参数 $g(\theta)$ 的百分位[置信区间](@entry_id:138194)就是原区间端点经过 $g$ 变换后的结果，即 $[g(\hat{q}_{\alpha/2}), g(\hat{q}_{1-\alpha/2})]$（假设 $g$ 是增函数）。这意味着分析结果不依赖于[参数化](@entry_id:265163)的选择，具有理论上的优雅性。

尽管百分位法非常直观和方便，但它并非没有缺点（例如，在某些情况下可能存在偏误）。更高级的[自助法](@entry_id:139281)，如偏差校正和加速（BCa）法或[学生化自助法](@entry_id:178833)（bootstrap-t），通过更复杂的校正来尝试达到二阶准确性（误差为 $O(n^{-1})$），但代价是计算更复杂且可能失去变换等价性。在许多生物统计学应用中，百分位法因其简单、直观和良好的变换性质而成为一种广受欢迎的工具。