## 引言
现实世界的研究，尤其在生物统计学和健康科学领域，常常受制于成本与可行性，不得不依赖非概率抽样，其中[便利抽样](@entry_id:175175)最为普遍。尽管概率抽样是统计推断的黄金标准，但理解如何处理[便利抽样](@entry_id:175175)这类“次优”数据是研究者必备的关键技能。这类抽样方法的核心挑战在于其固有的选择性偏误，它严重威胁着研究结论的外部有效性，使得从样本到总体的推断变得不再直接。本文旨在系统性地解决这一问题，为读者提供一个从理论到实践的完整框架。

在接下来的章节中，我们将首先深入**原理与机制**，剖析选择性偏误的来源以及基于模型的校正理论基础。随后，我们将通过丰富的**应用与跨学科联系**，展示这些校正策略在流行病学和诊断医学等真实场景中的具体运用。最后，读者将通过一系列**动手实践**，巩固对关键校正技术的理解与操作能力。让我们从探究[便利抽样](@entry_id:175175)的根本缺陷——设计的缺失——开始。

## 原理与机制

在[统计推断](@entry_id:172747)领域，从样本中获取关于总体的知识是核心任务。抽样方法的选择从根本上决定了此类推断的有效性和可靠性。上一章我们介绍了[抽样理论](@entry_id:268394)的基本框架，本章我们将深入探讨一类广泛应用但充满挑战的方法：非概率抽样，特别是其中的[便利抽样](@entry_id:175175)。我们将剖析其基本原理、内在机制，以及为何它对严谨的[科学推断](@entry_id:155119)构成威胁。同时，我们也将探索在何种条件下，以及通过何种统计学校正方法，我们能够从便利样本中挽救有价值的信息。

### 设计的缺失：概率抽样与[便利抽样](@entry_id:175175)的分野

在理想的统计世界中，我们使用**概率抽样 (probability sampling)**。其基石在于一个明确定义的**抽样设计 (sampling design)**。对于一个包含 $N$ 个单元的有限目标总体（或称抽样框）$U = \{1, 2, \dots, N\}$，抽样设计是一个在 $U$ 的所有子集（即幂集 $2^U$）上定义的[概率测度](@entry_id:190821)。这个设计为总体中的每一个单元 $i$ 赋予了一个已知的、大于零的**入选概率 (inclusion probability)**，记为 $\pi_i = \mathbb{P}(i \in S)$，其中 $S$ 是随机抽取的样本。

$\pi_i > 0$ 的要求确保了总体中的每个单元都有机会被抽中，从而避免了系统性的覆盖偏误。$\pi_i$ 已知的要求则是**基于设计的推断 (design-based inference)** 的核心。它允许我们通过为样本观测值赋予其入选概率的倒数作为权重（例如，在霍维茨-汤普森估计量中），来构建总体参数的[无偏估计量](@entry_id:756290)。在这种框架下，随机性完全来源于研究者控制的抽样过程，而总体中每个单元的测量值 $Y_i$ 被视为固定的未知常数。

与此相对，**[便利抽样](@entry_id:175175) (convenience sampling)** 的根本特征是**设计的缺失**。样本成员的入选不是由一个已知的、预设的随机化机制决定的，而是基于可及性、自愿性或易于接触等因素。在一个纯粹的基于设计的推断框架中，[便利抽样](@entry_id:175175)的入选概率 $\pi_i$ 是未定义的，因为不存在一个由研究者指定的、覆盖整个总体框 $U$ 的概率分布。

设想一个研究场景：研究者希望了解某家医院所有注册成年患者的健康状况。一个[便利抽样](@entry_id:175175)方案可能是：“在周一上午于医院自助餐厅旁设立站点，招募前 $m$ 位愿意参与研究的志愿者” [@problem_id:4932669]。这里的抽样框 $U$ 是所有注册患者的名单。然而，抽样规则并未对这个名单上的所有子集定义一个概率。一个患者是否入选，取决于他/她是否恰好在那个时间经过餐厅、是否愿意参与，以及是否在名额满之前到达。这些都是由患者自身行为和偶然因素决定的，而不是由研究者控制的[随机过程](@entry_id:268487)。对于任何一个不在那个时段出现的患者，其入选概率实际上是 $0$。对于可能出现的患者，其入选概率也是未知的，并且依赖于复杂的、不可观测的行为模式。因此，从设计推断的角度看，$\pi_i$ 对所有患者 $i \in U$ 都是未定义的。

这一根本区别意味着，依赖于已知 $\pi_i$ 的传统设计无偏估计方法在[便利抽样](@entry_id:175175)面前完全失效。试图将从便利样本中获得的结论直接推广到目标总体，就如同在没有地图和指南针的情况下穿越一片未知的领域，其风险是显而易见的。

### 选择性偏误的必然性

如果不能使用基于设计的经典方法，一个自然而然的想法是：我们能否直接使用便利样本的均值来估计总体的均值？答案是否定的，因为这会不可避免地导致**选择性偏误 (selection bias)**。

在统计学中，我们通常希望估计的是**目标总体 (target population)** 的某个参数，例如总体均值 $\theta = \mathbb{E}[Y]$。然而，便利样本并非从目标总体中随机抽取，而是从一个特殊的子总体中抽取。让 $S$ 成为一个二元选择[指示变量](@entry_id:266428)，当一个单元被纳入样本时 $S=1$，否则 $S=0$。便利样本中的所有观测值都满足 $S=1$ 的条件。根据[大数定律](@entry_id:140915)，当样本量足够大时，样本均值会收敛到其所抽取分布的[期望值](@entry_id:150961)。对于便利样本，这意味着样本均值 $\bar{Y}_S$ 收敛到的是在**被抽样子总体 (sampled subpopulation)** 中的条件期望 $\mathbb{E}[Y \mid S=1]$，而不是目标总体的期望 $\mathbb{E}[Y]$ [@problem_id:4932738]。

选择性偏误可以精确地定义为这两者之差：
$$
\text{偏误} = \mathbb{E}[Y \mid S=1] - \mathbb{E}[Y]
$$
只有当入选样本与我们关心的结果变量 $Y$ 无关时（即 $S \perp Y$），这个偏误才为零。然而，在[便利抽样](@entry_id:175175)的实践中，这个假设几乎总是被违反。例如，在一个评估某城市居民平均收缩压的研究中，如果我们在门诊诊所招募参与者，那么那些因为健康问题（可能包括高血压）而更频繁就医的人，其入选概率会更高。这会导致样本中的平均血压系统性地高于整个城市的平均水平。

一个常见的误解是，只要样本量足够大，选择性偏误就会消失。这是一个危险的错误观念。增加样本量只会减少随机误差，让我们对 $\mathbb{E}[Y \mid S=1]$ 这个（通常是错误的）量有更精确的估计，但它丝毫不会减小 $\mathbb{E}[Y \mid S=1]$ 与 $\mathbb{E}[Y]$ 之间的系统性差距。

我们可以通过一个简化的数学模型来清晰地说明这一点 [@problem_id:4932749]。假设一个人的健康结果 $Y$ 与其“可及性”分数 $X$ 存在线性关系 $Y = \beta_0 + \beta_1 X + \varepsilon$，其中 $X$ 在总体中服从[标准正态分布](@entry_id:184509) $\mathcal{N}(0, 1)$，$\varepsilon$ 是一个独立于 $X$ 的随机误差。总体的平均健康结果是 $\mathbb{E}[Y] = \beta_0$。现在，假设我们的[便利抽样](@entry_id:175175)方法只能招募到那些“可及性”分数高于某个阈值 $t$ 的人（即 $X > t$）。根据[大数定律](@entry_id:140915)，便利样本的均值将收敛于 $\mathbb{E}[Y \mid X > t] = \beta_0 + \beta_1 \mathbb{E}[X \mid X > t]$。对于[标准正态分布](@entry_id:184509)，可以证明 $\mathbb{E}[X \mid X > t] = \frac{\varphi(t)}{1-\Phi(t)}$，其中 $\varphi(\cdot)$ 和 $\Phi(\cdot)$ 分别是标准正态分布的概率密度函数和累积分布函数。这个值（被称为逆米尔斯比率）对于任何有限的 $t$ 都是正的。因此，样本均值的极限是 $\beta_0 + \beta_1 \frac{\varphi(t)}{1-\Phi(t)}$。只要 $\beta_1 \neq 0$，这个极限值就偏离了真实的总体均值 $\beta_0$。无论样本量 $n$ 变得多大，这个结构性的偏误都始终存在。

### 偏误的[结构分析](@entry_id:153861)：基于协变量的选择与基于结果的选择

为了更深入地理解并最终尝试纠正选择性偏误，我们需要一个能够剖析偏误来源的分析框架。关键在于对选择过程 $\Pr(S=1 \mid Y, X)$ 进行建模，其中 $X$ 是我们能够观测到的个体协变量向量（如年龄、性别等）。根据选择概率是否依赖于结果变量 $Y$，我们可以将选择机制分为两大类 [@problem_id:4932751]。

1.  **基于协变量的选择 (Selection on Covariates)**：在这种机制下，入选样本的概率只依赖于可观测的协变量 $X$，而在给定 $X$ 的条件下，与结果 $Y$ 无关。这在数学上等价于[条件独立性](@entry_id:262650)陈述 $S \perp Y \mid X$，即 $\Pr(S=1 \mid Y, X) = \Pr(S=1 \mid X)$。这意味着，在具有相同协变量 $X$ 的人群中，无论其结果 $Y$ 的值是多少，他们被选入样本的概率是相同的。

2.  **基于结果的选择 (Selection on Outcomes)**：在这种更复杂的情况下，即使在控制了所有可观测的协变量 $X$ 之后，入选概率仍然依赖于结果 $Y$ 本身。形式化地，这意味着 $S \not\perp Y \mid X$，即 $\Pr(S=1 \mid Y, X) \neq \Pr(S=1 \mid X)$。

这个区分至关重要。如果选择机制是**基于协变量的**，那么虽然样本中协变量的分布可能与总体不同（例如，样本中老年人比例更高），但在每个协变量层级内部，$Y$ 与 $X$ 之间的关系没有被扭曲。也就是说，$\mathbb{E}[Y \mid X, S=1] = \mathbb{E}[Y \mid X]$。这就为我们通过调整协变量分布来纠正偏误打开了大门。相反，如果选择机制是**基于结果的**，那么即使在相同的协变量层级内，样本中的条件均值 $\mathbb{E}[Y \mid X, S=1]$ 也已经偏离了总体的条件均值 $\mathbb{E}[Y \mid X]$，这使得校正变得极为困难，甚至不可能。

我们可以通过一个正式的偏误分解公式来精确地理解这一点 [@problem_id:4932628]。令 $\mu(x) = \mathbb{E}[Y \mid X=x]$ 为总体中给定 $X=x$ 的条件均值，$\mu_1(x) = \mathbb{E}[Y \mid X=x, S=1]$ 为样本中对应的条件均值。令 $f_X(x)$ 和 $f_{X \mid S}(x \mid 1)$ 分别为总体和样本中协变量 $X$ 的[概率密度函数](@entry_id:140610)。总偏误可以分解为两个部分：
$$
\text{Bias} = \underbrace{\int_{\mathcal{X}} (\mu_1(x) - \mu(x)) f_{X \mid S}(x \mid 1) \,dx}_{\text{部分 A}} + \underbrace{\int_{\mathcal{X}} \mu(x) (f_{X \mid S}(x \mid 1) - f_{X}(x)) \,dx}_{\text{部分 B}}
$$
- **部分 B** 代表了由于**协变量分布差异**造成的偏误。即使在每个 $x$ 层内样本和[总体均值](@entry_id:175446)相同（$\mu_1(x) = \mu(x)$），但如果样本中高 $Y$ 值的 $x$ 群体被过度抽样（即 $f_{X \mid S}(x \mid 1) > f_X(x)$），总均值仍然会有偏。
- **部分 A** 代表了由于**条件关系本身被扭曲**造成的偏误。这是“基于结果的选择”的直接后果。在这种情况下，$\mu_1(x) \neq \mu(x)$。

当“基于协变量的选择”假设（即 $S \perp Y \mid X$）成立时，$\mu_1(x) = \mu(x)$，偏误分解中的部分 A 为零。偏误完全来自于部分 B，即协变量分布的失衡。这就提示我们，如果能设法“重新加权”样本，使其协变量分布与总体一致，就有可能消除偏误。

### 基于模型的校正：推广性所需的三大假设

既然基于设计的推断路径被堵死，我们必须转向**基于模型的推断 (model-based inference)** [@problem_id:4932739]。这种方法不依赖于已知的抽样概率，而是依赖于对数据生成过程和选择机制所做的一系列假设。这些假设往往是无法通过数据直接检验的，因此需要研究者基于领域知识进行审慎的判断。为了从便利样本中识别出总体均值 $\mathbb{E}[Y]$，通常需要三个核心假设：

1.  **条件可忽略性 (Conditional Ignorability)**：这个假设也被称为**[随机缺失](@entry_id:168632) (Missing At Random, MAR)**，它精确地对应我们之前讨论的“基于协变量的选择”。即 $S \perp Y \mid X$。这是所有校正方法中最关键、也是最具挑战性的假设。它断言，我们观测到的协变量 $X$ 已经捕捉了所有同时影响样本入选 $S$ 和结果 $Y$ 的共同因素。

2.  **正定性 (Positivity)** 或称**重叠性 (Overlap)**：对于总体中任何具有特定协变量值 $x$ 的个体，他们被选入样本的概率都必须大于零。即 $\Pr(S=1 \mid X=x) > 0$ 对所有在总体中存在的 $x$ 都成立。这个假设确保了在样本中我们能观察到具有各种协变量特征的个体，从而学习到在整个协变量空间上的 $Y$ 与 $X$ 的关系。

3.  **模型设定的正确性 (Correct Model Specification)**：在实际操作中，我们需要使用[统计模型](@entry_id:755400)来估计条件均值（如 $\mathbb{E}[Y \mid X, S=1]$）或入选概率（[倾向得分](@entry_id:635864) $\Pr(S=1 \mid X)$）。这些模型（例如线性回归或逻辑回归）必须被正确设定，才能得到一致的估计。

**条件可忽略性**的合理性是实践中的主要争论点。例如，在一个评估某城市免费代谢筛查效果的研究中，研究者收集了参与者的年龄、性别和居住社区作为协变量 $X$。然而，决定一个人是否参加筛查（$S=1$）的因素，很可能还包括一些未被测量的变量，如他/她对自身健康的关注程度、是否有糖尿病家族史或是否已出现相关症状。这些“健康寻求行为”或潜在健康状况很可能既影响参与意愿，也与血糖水平 $Y$ 直接相关。在这种情况下，仅仅控制年龄、性别和社区这些 $X$ 变量，并不能保证 $S$ 和 $Y$ 在给定 $X$ 后是独立的，条件可忽略性假设很可能不成立 [@problem_id:4932649]。

然而，如果我们愿意接受这三个假设，那么识别总体均值 $\mathbb{E}[Y]$ 的路径就变得清晰了。根据[全期望定律](@entry_id:265946)，我们可以写出：
$$
\mathbb{E}[Y] = \mathbb{E}_X[\mathbb{E}[Y \mid X]]
$$
在条件可忽略性假设下，我们有 $\mathbb{E}[Y \mid X] = \mathbb{E}[Y \mid X, S=1]$。因此，上式可以改写为：
$$
\mathbb{E}[Y] = \mathbb{E}_X[\mathbb{E}[Y \mid X, S=1]]
$$
这个公式是可识别的，因为它只依赖于两部分信息：(1) 样本内部的[条件期望](@entry_id:159140) $\mathbb{E}[Y \mid X, S=1]$，我们可以通过对便利样本数据进行[回归建模](@entry_id:170726)来估计；(2) 总体中协变量 $X$ 的分布，这可以从外部数据源（如人口普查数据）获得 [@problem_id:4932684]。

这个识别策略催生了两类主要的校正方法 [@problem_id:4932738]：
- **标准化 (Standardization)** 或**后分层 (Post-stratification)**：首先，使用便利样本[数据拟合](@entry_id:149007)一个模型来估计 $\hat{\mu}_1(x) = \mathbb{E}[Y \mid X=x, S=1]$。然后，将这个模型应用到目标总体的每一个个体（或每一个协变量层），并根据总体中 $X$ 的分布进行加权平均，得到校正后的[总体均值](@entry_id:175446)估计。
- **逆概率加权 (Inverse Probability Weighting, IPW)**：首先，建立一个模型来估计每个个体基于其协变量 $X$ 被选入样本的概率，即**[倾向得分](@entry_id:635864)** $e(X) = \Pr(S=1 \mid X)$。然后，通过为样本中的每个观测值赋予其[倾向得分](@entry_id:635864)的倒数 $1/e(X)$作为权重，计算加权平均值来估计[总体均值](@entry_id:175446)。这种方法通过给那些在样本中代表性不足的个体（即入选概率低）更大的权重，来重构一个“伪总体”。

例如，假设在一个总体中，协变量 $X \sim \mathcal{N}(1, 1)$，而结果由模型 $Y = 3 + 2X - \frac{1}{2}X^2 + \varepsilon$ 决定。真实的总体均值是 $\mathbb{E}[Y] = \mathbb{E}[3 + 2X - \frac{1}{2}X^2] = 3 + 2\mathbb{E}[X] - \frac{1}{2}\mathbb{E}[X^2] = 3 + 2(1) - \frac{1}{2}(1^2+1) = 4$。如果我们有一个便利样本，并愿意做出条件可忽略性等假设，我们就可以通过回归或IPW方法，从样本数据和已知的 $X$ 的分布中一致地估计出这个值为 $4.000$ 的真实均值，无论选择机制有多么复杂 [@problem_id:4932684]。

### [便利抽样](@entry_id:175175)中的进阶议题

#### 随机化试验的内部有效性与外部有效性

[便利抽样](@entry_id:175175)在临床试验中极为常见，研究者常常在医院或诊所中招募便利样本，然后对这些参与者进行随机分组（例如，实验组和[对照组](@entry_id:188599)）。这引发了一个关于**内部有效性 (internal validity)** 与**外部有效性 (external validity)** 的重要问题 [@problem_id:4932697]。

- **内部有效性**关注的是：在该研究的**参与者群体**中，我们所估计的干预措施的因果效应是否是真实可靠的？其目标参数是在样本中的平均因果效应，即 $\Delta_S = \mathbb{E}[Y^1 - Y^0 \mid S=1]$，其中 $Y^a$ 是个体接受干预 $a$ 时的潜在结果。
- **外部有效性**关注的是：在该研究中获得的因果效应结论，是否可以被**推广**到我们真正关心的更广泛的**目标总体**？其目标参数是总体平均因果效应，即 $\Delta_{\text{pop}} = \mathbb{E}[Y^1 - Y^0]$。

好消息是，在便利样本内部进行的**随机化分组**是确保内部有效性的强大工具。只要随机化过程本身是成功的（即满足[交换性](@entry_id:140240)、正定性，且满足SUTVA等基本因果推断假设），那么在样本内部，处理组和[对照组](@entry_id:188599)在所有基线特征（无论是可观测的还是不可观测的）上都是可比的。因此，两组间结局的简单差异就是对样本内部因果效应 $\Delta_S$ 的一个[无偏估计](@entry_id:756289)。[便利抽样](@entry_id:175175)这个“进入”研究的过程，并不会破坏研究“内部”由随机化所建立的因果推断基础。

坏消息是，[便利抽样](@entry_id:175175)严重威胁了**外部有效性**。因为样本（例如，医院的患者）与目标总体（例如，该地区所有居民）在很多方面都可能存在差异，而这些差异本身可能就是**效应修饰因子 (effect modifiers)**。也就是说，干预措施对样本人群产生的效果，可能与对总体产生的效果完全不同。例如，病情更重的患者可能更倾向于在医院被招募，而他们对治疗的反应（即 $Y^1 - Y^0$ 的值）也可能异于病情较轻的普通患者。因此，即使我们对 $\Delta_S$ 有了一个内部有效的估计，我们也没有理由相信 $\Delta_S = \Delta_{\text{pop}}$。

#### 超越[点估计](@entry_id:174544)：界定偏误的界限

到目前为止，我们讨论的校正方法都依赖于一个核心的、但无法验证的条件可忽略性假设 ($S \perp Y \mid X$)。如果我们对这一假设没有信心，或者有理由相信存在未测量的混杂因素（如前述的“健康寻求行为”），我们该怎么办？

在这种情况下，承认我们无法得到一个唯一的**[点估计](@entry_id:174544) (point estimate)** 是更诚实、更科学的做法。因为如果没有MAR假设，[总体均值](@entry_id:175446) $\mathbb{E}[Y]$ 将不再是**点可识别 (point-identified)** 的。这意味着，观测到的数据（便利样本和外部协变量信息）可以与多个不同的真实[总体均值](@entry_id:175446)相容。

我们可以通过构造性例子来证明这一点 [@problem_id:4932692]。假设我们观测到便利样本中，年轻组 ($X=0$) 和年长组 ($X=1$) 的某项指标阳性率分别为 $0.8$ 和 $0.2$。总体中两组人数各占一半。如果我们假设MAR成立，通过标准化可以算出一个总体阳性率为 $0.5 \times 0.8 + 0.5 \times 0.2 = 0.5$。然而，我们也可以构想一个极端[选择偏误](@entry_id:172119)的场景：在未被抽到的人群中，年轻组的阳性率为 $0$，而年长组的阳性率为 $1$。经过计算，这个场景同样与我们观测到的所有数据完全吻合，但它所对应的真实总体阳性率却是 $0.82$。既然 $0.5$ 和 $0.82$ 两个不同的真实值都能完美解释我们手中的数据，我们就无法确定哪一个（或两者之间任何其他可能的值）是真相。

面对这种由数据和可信假设的局限性所导致的根本不确定性，一个严谨的替代方案是计算目标参数的**界限 (bounds)**。界限分析旨在确定与观测数据和最弱的、无可争议的假设（例如，一个[二元结果](@entry_id:173636)的概率必须在 $[0, 1]$ 之间）相容的参[数值范围](@entry_id:752817)。最终报告的可能不是一个单一数值，而是一个区间，例如“总体均值位于 $[0.45, 0.85]$ 之间”。

这种做法体现了一种重要的**认知谦逊 (epistemic humility)**：它坦率地承认了我们知识的边界，避免了基于脆弱且无法检验的假设而做出的过度精确的声明。在处理[便利抽样](@entry_id:175175)这类 inherently flawed 的数据时，理解我们能知道什么和不能知道什么的界限，是进行负责任的科学探究的关键。