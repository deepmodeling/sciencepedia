{"hands_on_practices": [{"introduction": "在许多实际研究中，我们是从一个有限的总体中进行不放回抽样。本练习旨在探讨总体规模有限这一事实如何影响样本均值的方差。你将从第一性原理出发，推导并应用“有限总体校正”（Finite Population Correction, FPC），这是一个关键的调整项，它解释了当样本量占总体比例增大时，估计不确定性是如何降低的。理解有限总体校正对于准确评估现实世界中有限总体调查的精度至关重要，是抽样理论的基石之一。 [@problem_id:4938646]", "problem": "一个生物统计学团队从一个多医院网络中构建了一个成年患者的完整抽样框。该抽样框列举了 $N=10{,}000$ 条唯一的患者记录。他们计划通过抽取一个大小为 $n=500$ 的无放回简单随机样本（正式称为无放回简单随机抽样，SRSWOR）来估计有限总体收缩压均值。设有限总体方差由 $S^2$ 表示，定义为 $S^2=\\frac{1}{N-1}\\sum_{i=1}^{N}\\left(Y_i-\\bar{Y}_U\\right)^2$，其中 $\\bar{Y}_U$ 是有限总体均值，$Y_i$ 是抽样框中患者 $i$ 记录的收缩压。根据在SRSWOR下相关抽样平均值的方差和协方差的基本原理，以及分母为N的有限总体方差 $\\sigma^2=\\frac{1}{N}\\sum_{i=1}^{N}\\left(Y_i-\\bar{Y}_U\\right)^2$ 与 $S^2$ 之间的关系，推导一个包含有限总体校正（FPC）的样本均值方差表达式，以及一个忽略有限总体校正（将抽样视为如同来自无限总体的独立抽样）的表达式。然后，对于给定的 $N$ 和 $n$，量化使用FPC与忽略FPC相比的相对效率，该效率定义为无FPC方差与有FPC方差之比。用 $S^2$、$N$ 和 $n$ 表示所有结果，然后代入 $N=10{,}000$ 和 $n=500$ 得到封闭形式的表达式。不要四舍五入；报告精确表达式。您的最终答案应按顺序依次列出：无FPC的方差、有FPC的方差以及所定义的相对效率。", "solution": "该问题要求在无放回简单随机抽样（SRSWOR）下，推导包含和不包含有限总体校正（FPC）的样本均值方差表达式，然后计算相对效率。\n\n设有限总体由数值集合 $\\{Y_1, Y_2, \\dots, Y_N\\}$ 表示。总体大小为 $N=10{,}000$。从中抽取一个大小为 $n=500$ 的无放回简单随机样本。设表示连续抽样的随机变量为 $y_1, y_2, \\dots, y_n$。样本均值 $\\bar{y}$ 是总体均值 $\\bar{Y}_U = \\frac{1}{N}\\sum_{i=1}^{N}Y_i$ 的一个估计量。样本均值定义为：\n$$\n\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i\n$$\n样本均值的方差由随机变量线性组合的方差通用公式给出：\n$$\n\\text{Var}(\\bar{y}) = \\text{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} y_i\\right) = \\frac{1}{n^2} \\text{Var}\\left(\\sum_{i=1}^{n} y_i\\right) = \\frac{1}{n^2} \\left[ \\sum_{i=1}^{n} \\text{Var}(y_i) + \\sum_{i \\neq j} \\text{Cov}(y_i, y_j) \\right]\n$$\n由于简单随机抽样的对称性，这些抽样是可交换的。这意味着任何单次抽样 $y_i$ 的边际分布是相同的，并且对于 $i \\neq j$ 的任何一对抽样 $(y_i, y_j)$ 的联合分布也是相同的。因此，对于所有 $i$，$\\text{Var}(y_i) = \\text{Var}(y_1)$，并且对于所有 $i \\neq j$，$\\text{Cov}(y_i, y_j) = \\text{Cov}(y_1, y_2)$。方差公式简化为：\n$$\n\\text{Var}(\\bar{y}) = \\frac{1}{n^2} \\left[ n \\cdot \\text{Var}(y_1) + n(n-1) \\cdot \\text{Cov}(y_1, y_2) \\right] = \\frac{1}{n} \\left[ \\text{Var}(y_1) + (n-1) \\text{Cov}(y_1, y_2) \\right]\n$$\n为了继续，我们必须推导 $\\text{Var}(y_1)$ 和 $\\text{Cov}(y_1, y_2)$ 的表达式。\n\n首先，考虑单次抽样的方差 $\\text{Var}(y_1)$。随机变量 $y_1$ 可以等概率地取总体中的任何值 $Y_k$，即 $P(y_1 = Y_k) = \\frac{1}{N}$。\n$y_1$ 的期望值为 $E[y_1] = \\sum_{k=1}^{N} Y_k P(y_1 = Y_k) = \\frac{1}{N} \\sum_{k=1}^{N} Y_k = \\bar{Y}_U$。\n$y_1$ 的方差为 $\\text{Var}(y_1) = E[y_1^2] - (E[y_1])^2 = \\left(\\frac{1}{N}\\sum_{k=1}^{N} Y_k^2\\right) - \\bar{Y}_U^2$。根据定义，这是分母为 $N$ 的有限总体方差，记为 $\\sigma^2$：\n$$\n\\sigma^2 = \\frac{1}{N} \\sum_{i=1}^{N} (Y_i - \\bar{Y}_U)^2 = \\text{Var}(y_1)\n$$\n问题中定义 $S^2 = \\frac{1}{N-1}\\sum_{i=1}^{N}(Y_i-\\bar{Y}_U)^2$。$S^2$ 和 $\\sigma^2$ 之间的关系是 $\\sigma^2 = \\frac{N-1}{N}S^2$。因此，\n$$\n\\text{Var}(y_1) = \\frac{N-1}{N}S^2\n$$\n\n接下来，考虑两次不同抽样的协方差 $\\text{Cov}(y_1, y_2)$。\n$\\text{Cov}(y_1, y_2) = E[y_1 y_2] - E[y_1]E[y_2] = E[y_1 y_2] - \\bar{Y}_U^2$。\n为了在SRSWOR下找到 $E[y_1 y_2]$，我们考虑对于任何一对不同的总体单位 $k \\neq l$，先抽到 $Y_k$ 再抽到 $Y_l$ 的概率是 $P(y_1=Y_k, y_2=Y_l) = P(y_1=Y_k)P(y_2=Y_l|y_1=Y_k) = \\frac{1}{N} \\frac{1}{N-1}$。\n$$\nE[y_1 y_2] = \\sum_{k=1}^{N} \\sum_{l \\neq k} Y_k Y_l P(y_1=Y_k, y_2=Y_l) = \\frac{1}{N(N-1)} \\sum_{k \\neq l} Y_k Y_l\n$$\n使用恒等式 $(\\sum_{k=1}^N Y_k)^2 = \\sum_{k=1}^N Y_k^2 + \\sum_{k \\neq l} Y_k Y_l$，我们可以写出 $\\sum_{k \\neq l} Y_k Y_l = (N\\bar{Y}_U)^2 - \\sum_{k=1}^N Y_k^2$。\n将此代入 $E[y_1 y_2]$ 的表达式中：\n$$\nE[y_1 y_2] = \\frac{N^2\\bar{Y}_U^2 - \\sum_{k=1}^N Y_k^2}{N(N-1)}\n$$\n现在，协方差是：\n$$\n\\text{Cov}(y_1, y_2) = \\frac{N^2\\bar{Y}_U^2 - \\sum Y_k^2}{N(N-1)} - \\bar{Y}_U^2 = \\frac{N^2\\bar{Y}_U^2 - \\sum Y_k^2 - N(N-1)\\bar{Y}_U^2}{N(N-1)}\n$$\n$$\n\\text{Cov}(y_1, y_2) = \\frac{N\\bar{Y}_U^2 - \\sum Y_k^2}{N(N-1)} = -\\frac{1}{N-1} \\left( \\frac{\\sum Y_k^2}{N} - \\bar{Y}_U^2 \\right) = -\\frac{\\sigma^2}{N-1}\n$$\n用 $S^2$ 表示：\n$$\n\\text{Cov}(y_1, y_2) = -\\frac{1}{N-1} \\left(\\frac{N-1}{N}S^2\\right) = -\\frac{S^2}{N}\n$$\n\n**1. 包含有限总体校正（FPC）的样本均值方差**\n我们现在将 $\\text{Var}(y_1)$ 和 $\\text{Cov}(y_1, y_2)$ 的表达式代入SRSWOR的 $\\text{Var}(\\bar{y})$ 公式中：\n$$\n\\text{Var}_{\\text{SRSWOR}}(\\bar{y}) = \\frac{1}{n} \\left[ \\frac{N-1}{N}S^2 + (n-1)\\left(-\\frac{S^2}{N}\\right) \\right]\n$$\n$$\n\\text{Var}_{\\text{SRSWOR}}(\\bar{y}) = \\frac{S^2}{nN} [ (N-1) - (n-1) ] = \\frac{S^2}{nN} [N-n] = \\frac{S^2}{n} \\left(\\frac{N-n}{N}\\right)\n$$\n这个表达式是包含FPC的样本均值方差，FPC即因子 $\\left(1-\\frac{n}{N}\\right)$。\n代入 $N=10{,}000$ 和 $n=500$：\n$$\n\\text{Var}_{\\text{SRSWOR}}(\\bar{y}) = \\frac{S^2}{500} \\left(1 - \\frac{500}{10{,}000}\\right) = \\frac{S^2}{500} \\left(1 - \\frac{1}{20}\\right) = \\frac{S^2}{500} \\left(\\frac{19}{20}\\right) = \\frac{19S^2}{10{,}000}\n$$\n\n**2. 不包含FPC的样本均值方差**\n忽略FPC等同于将抽样视为来自无限总体或有放回抽样。在这种情况下，抽样 $y_i$ 是独立的，这意味着对于 $i \\neq j$，$\\text{Cov}(y_i, y_j) = 0$。样本均值的方差公式简化为：\n$$\n\\text{Var}_{\\text{no FPC}}(\\bar{y}) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\text{Var}(y_i) = \\frac{n \\cdot \\text{Var}(y_1)}{n^2} = \\frac{\\text{Var}(y_1)}{n}\n$$\n在无限总体的理想情况下，$S^2$ 和 $\\sigma^2$ 之间的区别消失了。在这种情况下，样本均值方差的标准公式是 $\\frac{S^2}{n}$，其中 $S^2$ 是总体方差。这相当于将FPC因子 $\\left(\\frac{N-n}{N}\\right)$ 设为 $1$。\n$$\n\\text{Var}_{\\text{no FPC}}(\\bar{y}) = \\frac{S^2}{n}\n$$\n代入 $n=500$：\n$$\n\\text{Var}_{\\text{no FPC}}(\\bar{y}) = \\frac{S^2}{500}\n$$\n\n**3. 相对效率**\n相对效率定义为无FPC的方差与有FPC的方差之比。\n$$\n\\text{Relative Efficiency} = \\frac{\\text{Var}_{\\text{no FPC}}(\\bar{y})}{\\text{Var}_{\\text{SRSWOR}}(\\bar{y})} = \\frac{S^2/n}{\\frac{S^2}{n}\\left(\\frac{N-n}{N}\\right)} = \\frac{1}{\\frac{N-n}{N}} = \\frac{N}{N-n}\n$$\n代入 $N=10{,}000$ 和 $n=500$：\n$$\n\\text{Relative Efficiency} = \\frac{10{,}000}{10{,}000 - 500} = \\frac{10{,}000}{9{,}500} = \\frac{100}{95} = \\frac{20}{19}\n$$\n\n所需的三个量是：\n- 无FPC的方差：$\\frac{S^2}{500}$\n- 有FPC的方差：$\\frac{19S^2}{10,000}$\n- 相对效率：$\\frac{20}{19}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{S^2}{500}  \\frac{19S^2}{10000}  \\frac{20}{19} \\end{pmatrix}}\n$$", "id": "4938646"}, {"introduction": "研究总体通常是异质的，我们可以利用这种结构来提高抽样效率。本练习将展示分层抽样（stratified sampling）的强大之处，这是一种在抽样前将总体划分为若干同质子群（层）的技术。你将计算分层估计量的方差，并将其效率与简单随机抽样的效率进行比较，从而量化设计上的改进。掌握这种通过巧妙的抽样设计来提升估计精度的方法，对于设计经济高效的研究至关重要。 [@problem_id:4938682]", "problem": "一个卫生系统维护着一个按年龄组分层的成年患者的完整抽样框：层 $h=1$ 为 $18$–$44$ 岁，层 $h=2$ 为 $45$–$64$ 岁，层 $h=3$ 为 $\\ge 65$ 岁。有限总体容量为 $N_1 = 2000$，$N_2 = 1500$ 和 $N_3 = 1500$，因此层权重为 $W_h = N_h/N$，其中 $N = 5000$，即 $W_1 = 0.4$，$W_2 = 0.3$，$W_3 = 0.3$。采用分层简单随机无放回抽样，抽取了 $n_1 = 80$，$n_2 = 60$ 和 $n_3 = 60$ 名患者（总共 $n = 200$）。结果变量 $Y$ 是以毫米汞柱为单位的收缩压。层内样本均值和方差为\n$\\bar{y}_1 = 130$，$s_1^2 = 225$；$\\bar{y}_2 = 140$，$s_2^2 = 400$；$\\bar{y}_3 = 150$，$s_3^2 = 625$。\n\n仅使用分层抽样和简单随机抽样下期望和方差的核心定义，以及样本方差的定义，完成以下任务：\n\n1. 从基本定义出发，构建总体均值 $\\bar{Y}$ 的分层估计量，并推导其在分层简单随机无放回抽样下的基于设计的方差，在每层内包含有限总体校正（FPC）。然后，使用以上数据计算该方差估计量的数值。\n\n2. 反事实地考虑，从容量为 $N = 5000$ 的同一总体中进行一次容量为 $n = 200$ 的简单随机无放回抽样（SRS）。从样本方差的定义出发，推导如何从分组（层级）的汇总数据中计算 $Y$ 的总样本方差的无偏估计量，并使用给定的 $\\bar{y}_h$、$s_h^2$ 和 $n_h$ 获得其数值。利用这个结果，获得样本均值的常规SRS方差估计量，并包含针对整个总体的FPC。\n\n最后，计算SRS方差估计量与分层抽样方差估计量的比率 $R$，\n$$\nR \\equiv \\frac{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}})}{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}})}.\n$$\n将 $R$ 报告为一个无量纲数，四舍五入到四位有效数字。", "solution": "该问题要求在两种不同的抽样设计（分层简单随机抽样和简单随机抽样）下，计算和比较总体均值的方差估计量。该问题定义明确、科学合理且内部一致。\n\n首先，我们根据问题陈述建立符号表示。\n$H=3$ 是层的数量。\n$N_h$ 是第 $h$ 层的总体容量，其中 $N_1=2000$，$N_2=1500$，$N_3=1500$。\n$N = \\sum_{h=1}^H N_h = 5000$ 是总总体容量。\n$W_h = N_h/N$ 是第 $h$ 层的总体权重，其中 $W_1=0.4$，$W_2=0.3$，$W_3=0.3$。\n$n_h$ 是从第 $h$ 层抽取的样本量，其中 $n_1=80$，$n_2=60$，$n_3=60$。\n$n = \\sum_{h=1}^H n_h = 200$ 是总样本量。\n$\\bar{y}_h$ 是第 $h$ 层的样本均值，其中 $\\bar{y}_1=130$，$\\bar{y}_2=140$，$\\bar{y}_3=150$。\n$s_h^2$ 是第 $h$ 层的样本方差，其中 $s_1^2=225$，$s_2^2=400$，$s_3^2=625$。\n$\\bar{Y}$ 是真实总体均值。\n$\\bar{Y}_h$ 是第 $h$ 层的真实总体均值。\n$S_h^2$ 是第 $h$ 层的真实总体方差。\n$S^2$ 是真实总总体方差。\n$f_h = n_h/N_h$ 是第 $h$ 层的抽样比。\n$f = n/N$ 是总抽样比。\n\n第一部分：分层抽样下的分析\n\n在分层抽样下，总体均值 $\\bar{Y}$ 的估计量，记作 $\\bar{y}_{\\mathrm{st}}$，是各层样本均值的加权平均，权重等于总体层权重 $W_h$。\n$$ \\bar{y}_{\\mathrm{st}} = \\sum_{h=1}^{H} W_h \\bar{y}_h $$\n该估计量是无偏的，即 $E[\\bar{y}_{\\mathrm{st}}] = \\bar{Y}$。\n\n为了推导其方差，我们利用样本是从各层中独立抽取的性质。因此，和的方差等于方差的和：\n$$ \\operatorname{Var}(\\bar{y}_{\\mathrm{st}}) = \\operatorname{Var}\\left(\\sum_{h=1}^{H} W_h \\bar{y}_h\\right) = \\sum_{h=1}^{H} \\operatorname{Var}(W_h \\bar{y}_h) = \\sum_{h=1}^{H} W_h^2 \\operatorname{Var}(\\bar{y}_h) $$\n在每个层 $h$ 内，从容量为 $N_h$ 的总体中抽取一个容量为 $n_h$ 的简单随机无放回样本。样本均值 $\\bar{y}_h$ 的方差由以下公式给出：\n$$ \\operatorname{Var}(\\bar{y}_h) = \\frac{S_h^2}{n_h} \\left(1 - \\frac{n_h}{N_h}\\right) $$\n其中 $(1 - n_h/N_h)$ 是第 $h$ 层的有限总体校正（FPC）。\n将此代入 $\\operatorname{Var}(\\bar{y}_{\\mathrm{st}})$ 的表达式中，得到：\n$$ \\operatorname{Var}(\\bar{y}_{\\mathrm{st}}) = \\sum_{h=1}^{H} W_h^2 \\frac{S_h^2}{n_h} \\left(1 - \\frac{n_h}{N_h}\\right) $$\n这是分层估计量的真实方差。为了从样本数据中估计此方差，我们将未知的总体方差 $S_h^2$ 替换为其无偏样本估计量，即样本方差 $s_h^2$。得到的基于设计的方差估计量为：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}}) = \\sum_{h=1}^{H} W_h^2 \\frac{s_h^2}{n_h} \\left(1 - \\frac{n_h}{N_h}\\right) $$\n现在，我们使用所提供的数据计算该估计量的数值。\n对于层 $h=1$：\n$W_1^2 \\frac{s_1^2}{n_1} (1 - \\frac{n_1}{N_1}) = (0.4)^2 \\frac{225}{80} (1 - \\frac{80}{2000}) = 0.16 \\times 2.8125 \\times (1 - 0.04) = 0.45 \\times 0.96 = 0.432$。\n对于层 $h=2$：\n$W_2^2 \\frac{s_2^2}{n_2} (1 - \\frac{n_2}{N_2}) = (0.3)^2 \\frac{400}{60} (1 - \\frac{60}{1500}) = 0.09 \\times \\frac{20}{3} \\times (1 - 0.04) = 0.6 \\times 0.96 = 0.576$。\n对于层 $h=3$：\n$W_3^2 \\frac{s_3^2}{n_3} (1 - \\frac{n_3}{N_3}) = (0.3)^2 \\frac{625}{60} (1 - \\frac{60}{1500}) = 0.09 \\times \\frac{625}{60} \\times (1 - 0.04) = 0.9375 \\times 0.96 = 0.9$。\n总估计方差是这些分量之和：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}}) = 0.432 + 0.576 + 0.9 = 1.908 $$\n\n第二部分：简单随机抽样（SRS）下的反事实分析\n\n我们考虑一个从总容量 $N=5000$ 中抽取的容量为 $n=200$ 的假设性简单随机样本。总体均值的估计量将是样本均值 $\\bar{y}_{\\mathrm{SRS}}$。其方差的标准无偏估计量为：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}}) = \\frac{s^2}{n} \\left(1 - \\frac{n}{N}\\right) $$\n其中 $s^2$ 是总样本方差。问题要求我们从提供的层级汇总数据中推导 $s^2$ 的计算。我们拥有的数据来自一个分层样本，而非简单随机样本（SRS）。我们将各层的数据合并，以计算这 $n=200$ 个个体的总样本方差。\n\n合并样本的样本方差 $s^2$ 的定义是：\n$$ s^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2 $$\n其中 $\\bar{y}$ 是总样本均值，计算方式为 $\\bar{y} = \\frac{1}{n} \\sum_{h=1}^H n_h \\bar{y}_h$。总平方和 $TSS = \\sum_{i=1}^n(y_i - \\bar{y})^2 = (n-1)s^2$ 可以被分解。我们将对所有个体 $i$ 的求和表示为对层 $h$ 和层内个体 $i$ 的双重求和：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y})^2 $$\n其中 $y_{hi}$ 是第 $h$ 层中第 $i$ 个个体的值。我们在平方内加上并减去层样本均值 $\\bar{y}_h$：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} \\left( (y_{hi} - \\bar{y}_h) + (\\bar{y}_h - \\bar{y}) \\right)^2 $$\n展开平方项得：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} \\left( (y_{hi} - \\bar{y}_h)^2 + 2(y_{hi} - \\bar{y}_h)(\\bar{y}_h - \\bar{y}) + (\\bar{y}_h - \\bar{y})^2 \\right) $$\n分配求和符号：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)^2 + \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} 2(y_{hi} - \\bar{y}_h)(\\bar{y}_h - \\bar{y}) + \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} (\\bar{y}_h - \\bar{y})^2 $$\n交叉乘积项得到简化。对于每个层 $h$，$(\\bar{y}_h - \\bar{y})$ 相对于内层求和是常数，因此我们有 $2(\\bar{y}_h - \\bar{y}) \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)$。根据样本均值的定义，$\\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h) = 0$。因此，整个交叉乘积项为零。\n我们得到方差分析（ANOVA）分解：\n$$ TSS = \\sum_{h=1}^{H} \\underbrace{\\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)^2}_{\\text{组内平方和 (SSW)}} + \\sum_{h=1}^{H} \\underbrace{\\sum_{i=1}^{n_h} (\\bar{y}_h - \\bar{y})^2}_{\\text{组间平方和 (SSB)}} $$\n根据样本方差的定义 $s_h^2 = \\frac{1}{n_h-1} \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)^2$，第一项是 $SSW = \\sum_{h=1}^H (n_h-1)s_h^2$。第二项是 $SSB = \\sum_{h=1}^H n_h (\\bar{y}_h - \\bar{y})^2$。\n因此，从分组数据计算 $s^2$ 的公式是：\n$$ s^2 = \\frac{1}{n-1} \\left( \\sum_{h=1}^{H} (n_h-1)s_h^2 + \\sum_{h=1}^{H} n_h(\\bar{y}_h - \\bar{y})^2 \\right) $$\n这个计算出的 $s^2$ 是容量为 $n=200$ 的合并样本的样本方差，并作为SRS公式所需的总总体方差 $S^2$ 的估计。\n\n我们现在计算数值。首先是总样本均值 $\\bar{y}$：\n$$ \\bar{y} = \\frac{1}{200} \\left(80 \\times 130 + 60 \\times 140 + 60 \\times 150 \\right) = \\frac{10400 + 8400 + 9000}{200} = \\frac{27800}{200} = 139 $$\n接下来，我们计算 SSW 和 SSB：\n$$ SSW = (80-1)(225) + (60-1)(400) + (60-1)(625) = 79 \\times 225 + 59 \\times 400 + 59 \\times 625 = 17775 + 23600 + 36875 = 78250 $$\n$$ SSB = 80(130-139)^2 + 60(140-139)^2 + 60(150-139)^2 = 80(-9)^2 + 60(1)^2 + 60(11)^2 = 80(81) + 60(1) + 60(121) = 6480 + 60 + 7260 = 13800 $$\n总平方和为 $TSS = 78250 + 13800 = 92050$。\n总样本方差 $s^2$ 为：\n$$ s^2 = \\frac{92050}{n-1} = \\frac{92050}{199} $$\n现在我们计算在 SRS 下的均值估计方差：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}}) = \\frac{s^2}{n} \\left(1 - \\frac{n}{N}\\right) = \\frac{92050/199}{200} \\left(1 - \\frac{200}{5000}\\right) = \\frac{92050}{199 \\times 200} (1 - 0.04) = \\frac{92050}{39800} \\times 0.96 = \\frac{88368}{39800} \\approx 2.2203015 $$\n\n最后一步：计算比率 $R$\n\nSRS方差估计量与分层抽样方差估计量的比率 $R$ 是：\n$$ R = \\frac{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}})}{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}})} = \\frac{88368 / 39800}{1.908} \\approx \\frac{2.2203015}{1.908} \\approx 1.1636799 $$\n四舍五入到四位有效数字，我们得到 $R = 1.164$。这个值通常与设计效应有关，它表明对于这个总体和变量，在相同的总样本量下，比例分配的分层抽样比简单随机抽样的效率高约 $16.4\\%$（即产生更小的方差）。", "answer": "$$\\boxed{1.164}$$", "id": "4938682"}, {"introduction": "有时，与抽样个体相比，抽样个体所处的群体（即“整群”或“聚类”）在操作上更为便捷和经济。本练习深入探讨整群抽样（cluster sampling）的核心概念，重点关注“组内相关系数”（intracluster correlation coefficient, $\\rho$），该系数衡量了同一聚类中不同单元之间的相似程度。你将计算 $\\rho$ 值及其引申出的“设计效应”（design effect），后者量化了整群效应对估计量方差的影响。掌握这些概念对于规划和分析整群抽样数据至关重要，因为忽略组内相关性可能会导致对真实方差的严重低估。 [@problem_id:4938664]", "problem": "一个公共卫生团队正计划进行一项单阶段整群抽样，以估计某地区成年患者中一种连续性生物标志物的均值。目标人群是该地区所有在初级保健诊所接受治疗的成年患者。抽样框是该地区所有诊所的完整名录，而群组即为诊所。在一项预试验中，拟合了一个以诊所为随机截距的双层随机效应模型，得到了估计的诊所间方差 $\\sigma_{b}^{2}$ 和诊所内（残差）方差 $\\sigma_{w}^{2}$。为了规划，假设预试验得出 $\\sigma_{b}^{2}=12.5$ 和 $\\sigma_{w}^{2}=37.5$。行政数据表明，在调查时，每个抽样诊所的平均合格患者人数将为 $\\bar{m}=8$，并且设计将力求群组大小大致相等。\n\n仅使用方差分量和相关性的基本定义，计算这些方差分量所隐含的组内相关系数 $\\rho$，以及在平均群组大小为 $\\bar{m}$ 的情况下，计划研究的相应设计效应。将 $\\rho$ 和设计效应均报告为四舍五入到四位有效数字的数值。无需单位。假设在设计阶段，采用群组大小相等的近似是合适的。", "solution": "该问题是有效的，因为它在生物统计学方面有科学依据，问题阐述清晰且客观。它提供了使用标准定义计算所要求数量的所有必要信息。\n\n该场景描述了一个双层数据结构，其中患者（第一层）嵌套在诊所（第二层）内。双层随机效应模型适合分析此类数据。设 $y_{ij}$ 为第 $i$ 个诊所中第 $j$ 位患者的生物标志物值。模型可以指定为：\n$$\ny_{ij} = \\mu + u_i + e_{ij}\n$$\n其中 $\\mu$ 是人群中生物标志物值的总体均值，$u_i$ 是与第 $i$ 个诊所相关的随机效应，$e_{ij}$ 是第 $i$ 个诊所中第 $j$ 位患者的残差。随机效应 $u_i$ 假设为独立同分布，均值为 $0$，方差为 $\\sigma_{b}^{2}$，即 $u_i \\sim N(0, \\sigma_{b}^{2})$。残差 $e_{ij}$ 假设为独立同分布，均值为 $0$，方差为 $\\sigma_{w}^{2}$，即 $e_{ij} \\sim N(0, \\sigma_{w}^{2})$。假设项 $u_i$ 和 $e_{ij}$ 相互独立。\n\n给定的方差分量是诊所间方差 $\\sigma_{b}^{2} = 12.5$ 和诊所内（或残差）方差 $\\sigma_{w}^{2} = 37.5$。\n\n首先，我们计算组内相关系数 $\\rho$。根据定义，$\\rho$ 是从同一群组中选出的两个不同个体的结果之间的相关性。让我们考虑来自同一诊所 $i$ 的两名不同患者 $j$ 和 $k$（其中 $j \\neq k$）。相关性由下式给出：\n$$\n\\rho = \\text{Corr}(y_{ij}, y_{ik}) = \\frac{\\text{Cov}(y_{ij}, y_{ik})}{\\sqrt{\\text{Var}(y_{ij})\\text{Var}(y_{ik})}}\n$$\n我们需要找到观测值的方差和协方差。由于其分量的独立性，单个观测值 $y_{ij}$ 的总方差是其分量方差的总和：\n$$\n\\text{Var}(y_{ij}) = \\text{Var}(\\mu + u_i + e_{ij}) = \\text{Var}(u_i) + \\text{Var}(e_{ij}) = \\sigma_{b}^{2} + \\sigma_{w}^{2}\n$$\n来自同一诊所 $i$ 的两个不同观测值 $y_{ij}$ 和 $y_{ik}$ 之间的协方差为：\n$$\n\\text{Cov}(y_{ij}, y_{ik}) = \\text{Cov}(\\mu + u_i + e_{ij}, \\mu + u_i + e_{ik})\n$$\n由于 $\\mu$ 是一个常数，并使用协方差的性质：\n$$\n\\text{Cov}(y_{ij}, y_{ik}) = \\text{Cov}(u_i + e_{ij}, u_i + e_{ik}) = \\text{Cov}(u_i, u_i) + \\text{Cov(u_i, e_{ik})} + \\text{Cov}(e_{ij}, u_i) + \\text{Cov}(e_{ij}, e_{ik})\n$$\n根据假设，随机效应 $u_i$ 与残差 $e_{ij}$ 和 $e_{ik}$ 相互独立。此外，不同个体的残差是独立的。因此，对于 $j \\neq k$，有 $\\text{Cov}(u_i, e_{ik}) = 0$，$\\text{Cov}(e_{ij}, u_i) = 0$ 和 $\\text{Cov}(e_{ij}, e_{ik}) = 0$。这剩下：\n$$\n\\text{Cov}(y_{ij}, y_{ik}) = \\text{Cov}(u_i, u_i) = \\text{Var}(u_i) = \\sigma_{b}^{2}\n$$\n将方差和协方差的表达式代入相关性的定义中：\n$$\n\\rho = \\frac{\\sigma_{b}^{2}}{\\text{Var}(y_{ij})} = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\sigma_{w}^{2}}\n$$\n这个公式表明，$\\rho$ 是总方差中可归因于群组间方差的比例。使用给定的值 $\\sigma_{b}^{2} = 12.5$ 和 $\\sigma_{w}^{2} = 37.5$：\n$$\n\\rho = \\frac{12.5}{12.5 + 37.5} = \\frac{12.5}{50.0} = 0.25\n$$\n\n接下来，我们计算设计效应 DEFF。设计效应衡量了由于复杂抽样设计（此处为整群抽样），估计量的方差相对于同样总样本量的简单随机抽样 (SRS) 的膨胀程度。对于从群组大小相等的单阶段整群抽样中估计均值，设计效应由下式给出：\n$$\n\\text{DEFF} = 1 + (m-1)\\rho\n$$\n问题陈述设计将力求群组大小大致相等，平均每个诊所有 $\\bar{m}=8$ 名患者。为设计目的，通常的做法是在此公式中使用平均群组大小。因此，我们设 $m = \\bar{m} = 8$。\n代入 $\\rho = 0.25$ 和 $m=8$ 的值：\n$$\n\\text{DEFF} = 1 + (8 - 1) \\times 0.25 = 1 + 7 \\times 0.25 = 1 + 1.75 = 2.75\n$$\n问题要求结果报告为四位有效数字。\n组内相关系数 $\\rho$ 为 $0.25$，保留四位有效数字为 $0.2500$。\n设计效应 DEFF 为 $2.75$，保留四位有效数字为 $2.750$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.2500  2.750 \\end{pmatrix}}\n$$", "id": "4938664"}]}