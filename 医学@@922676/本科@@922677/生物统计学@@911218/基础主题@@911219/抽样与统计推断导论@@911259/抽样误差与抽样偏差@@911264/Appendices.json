{"hands_on_practices": [{"introduction": "在生物统计学中，我们经常遇到由特征各异的不同亚组（或称“层”）组成的总体。一个常见的错误是，在对这些亚组进行不成比例的抽样后，不进行适当加权就直接合并结果。本练习 [@problem_id:4951835] 提供了一个清晰的假设情景，旨在说明这种抽样策略如何导致显著的抽样偏倚，并让您亲手量化这一误差的大小。理解这个陷阱是设计更可靠研究的第一步。", "problem": "一个公共卫生机构旨在通过合并从两个亚区域（记为 $A$ 和 $B$）收集的样本来估计一种二元疾病结果的区域患病率。每个亚区域内的真实患病率是恒定的。该机构的现场团队为了追求效率，在他们认为患病率较高的亚区域进行了更密集的抽样。考虑以下具体情景，该情景旨在作为一个反例，说明如果使用简单的合并方法，这种抽样方案会如何夸大估计的区域患病率。\n\n- 亚区域 $A$ 的总体规模为 $N_{A} = 6000$，真实患病率为 $p_{A} = 0.12$。\n- 亚区域 $B$ 的总体规模为 $N_{B} = 14000$，真实患病率为 $p_{B} = 0.03$。\n- 真实的区域患病率定义为各亚区域患病率的总体规模加权平均值。\n- 该抽样方案在每个亚区域内使用无放回简单随机抽样，从亚区域 $A$ 抽取 $m_{A} = 400$ 个个体，从亚区域 $B$ 抽取 $m_{B} = 100$ 个个体。\n- 令 $\\hat{p}_{A}$ 和 $\\hat{p}_{B}$ 表示两个亚区域中疾病的样本比例。该机构将合并的、未加权的样本比例 $\\hat{p}_{\\text{naive}} = \\dfrac{m_{A}\\hat{p}_{A} + m_{B}\\hat{p}_{B}}{m_{A} + m_{B}}$ 作为区域估计值进行报告。\n\n仅使用抽样理论和概率论的核心定义（将患病率定义为指示变量的总体均值，无放回简单随机抽样下样本比例的期望，以及将偏差定义为估计量的期望与目标参数之差），从解析上证明该抽样设计相对于真实的区域患病率，会夸大简单的合并估计量的期望值。然后计算偏差的大小，定义为 $|\\mathbb{E}[\\hat{p}_{\\text{naive}}] - p_{\\text{true}}|$，其中 $p_{\\text{true}}$ 表示真实的区域患病率。将最终答案以小数形式表示（不带百分号）。无需四舍五入。", "solution": "该问题提法明确且科学上合理，可以进行完整的解析求解。我们首先正式定义感兴趣的参数，即真实的区域患病率，以及该机构提出的估计量。然后，我们将分析该估计量的统计特性，特别是其期望，以量化其偏差。\n\n该区域的总人口为 $N = N_{A} + N_{B}$。亚区域 $A$ 的患病人数为 $N_{A}p_{A}$，亚区域 $B$ 的患病人数为 $N_{B}p_{B}$。真实的区域患病率 $p_{\\text{true}}$ 定义为该区域的总患病人数除以总人口规模。这等同于各亚区域患病率的总体规模加权平均值。\n$$p_{\\text{true}} = \\frac{N_{A}p_{A} + N_{B}p_{B}}{N_{A} + N_{B}}$$\n让我们将亚区域 $A$ 的总体权重定义为 $W_{A} = \\frac{N_{A}}{N_{A}+N_{B}}$，亚区域 $B$ 的总体权重定义为 $W_{B} = \\frac{N_{B}}{N_{A}+N_{B}}$，其中 $W_{A}+W_{B}=1$。那么，真实患病率可以写为：\n$$p_{\\text{true}} = W_{A}p_{A} + W_{B}p_{B}$$\n\n该机构提出的估计量 $\\hat{p}_{\\text{naive}}$ 是合并样本中患病个体的未加权比例。令 $X_{A} = m_{A}\\hat{p}_{A}$ 为从亚区域 $A$ 抽取的样本中的患病人数，令 $X_{B} = m_{B}\\hat{p}_{B}$ 为从亚区域 $B$ 抽取的样本中的患病人数。该估计量为：\n$$\\hat{p}_{\\text{naive}} = \\frac{X_{A} + X_{B}}{m_{A} + m_{B}} = \\frac{m_{A}\\hat{p}_{A} + m_{B}\\hat{p}_{B}}{m_{A} + m_{B}}$$\n为评估该估计量的偏差，我们首先计算其期望值 $\\mathbb{E}[\\hat{p}_{\\text{naive}}]$。利用期望算子的线性性质：\n$$\\mathbb{E}[\\hat{p}_{\\text{naive}}] = \\mathbb{E}\\left[\\frac{m_{A}\\hat{p}_{A} + m_{B}\\hat{p}_{B}}{m_{A} + m_{B}}\\right] = \\frac{m_{A}\\mathbb{E}[\\hat{p}_{A}] + m_{B}\\mathbb{E}[\\hat{p}_{B}]}{m_{A} + m_{B}}$$\n每个亚区域内的抽样是无放回简单随机抽样 (SRSWOR)。抽样理论的一个基本结果是，样本比例 $\\hat{p}$ 是总体比例 $p$ 的无偏估计量。因此，$\\mathbb{E}[\\hat{p}_{A}] = p_{A}$ 且 $\\mathbb{E}[\\hat{p}_{B}] = p_{B}$。将这些代入期望值方程，得到：\n$$\\mathbb{E}[\\hat{p}_{\\text{naive}}] = \\frac{m_{A}p_{A} + m_{B}p_{B}}{m_{A} + m_{B}}$$\n该表达式表明，简单估计量的期望值是亚区域患病率的加权平均值，其中权重由样本量决定，而非总体规模。让我们将样本权重定义为 $w_{A} = \\frac{m_{A}}{m_{A}+m_{B}}$ 和 $w_{B} = \\frac{m_{B}}{m_{A}+m_{B}}$，其中 $w_{A}+w_{B}=1$。那么，\n$$\\mathbb{E}[\\hat{p}_{\\text{naive}}] = w_{A}p_{A} + w_{B}p_{B}$$\n\n该估计量的偏差是其期望与真实参数值之差：\n$$\\text{Bias}(\\hat{p}_{\\text{naive}}) = \\mathbb{E}[\\hat{p}_{\\text{naive}}] - p_{\\text{true}} = (w_{A}p_{A} + w_{B}p_{B}) - (W_{A}p_{A} + W_{B}p_{B})$$\n使用 $w_{B} = 1 - w_{A}$ 和 $W_{B} = 1 - W_{A}$，我们可以重新整理这些项：\n$$\\text{Bias}(\\hat{p}_{\\text{naive}}) = (w_{A} - W_{A})p_{A} + ((1-w_{A}) - (1-W_{A}))p_{B} = (w_{A} - W_{A})p_{A} - (w_{A} - W_{A})p_{B}$$\n$$\\text{Bias}(\\hat{p}_{\\text{naive}}) = (w_{A} - W_{A})(p_{A} - p_{B})$$\n问题陈述该抽样方案对患病率较高的亚区域进行了过度抽样。给定数据为 $p_{A} = 0.12$ 和 $p_{B} = 0.03$，因此 $p_{A} > p_{B}$，这使得 $(p_{A} - p_{B})$ 项为正。\n亚区域 $A$ 的抽样权重为 $w_{A} = \\frac{m_{A}}{m_{A}+m_{B}} = \\frac{400}{400+100} = \\frac{400}{500} = 0.8$。\n亚区域 $A$ 的总体权重为 $W_{A} = \\frac{N_{A}}{N_{A}+N_{B}} = \\frac{6000}{6000+14000} = \\frac{6000}{20000} = 0.3$。\n由于 $w_{A} > W_{A}$，$(w_{A} - W_{A})$ 项也为正。因此，乘积 $(w_{A} - W_{A})(p_{A} - p_{B})$ 为正，这从解析上证明了偏差为正。这意味着 $\\mathbb{E}[\\hat{p}_{\\text{naive}}] > p_{\\text{true}}$，正如所声称的那样，简单估计量被夸大了。这种夸大源于亚区域 $A$ 的抽样比例（$80\\%$）远大于其总体比例（$30\\%$），从而对其较高的患病率赋予了不成比例的权重。\n\n现在，我们计算偏差大小的数值。\n首先，我们计算真实的区域患病率 $p_{\\text{true}}$：\n$$p_{\\text{true}} = \\frac{N_{A}p_{A} + N_{B}p_{B}}{N_{A} + N_{B}} = \\frac{(6000)(0.12) + (14000)(0.03)}{6000 + 14000} = \\frac{720 + 420}{20000} = \\frac{1140}{20000} = 0.057$$\n接下来，我们计算简单的合并估计量的期望值 $\\mathbb{E}[\\hat{p}_{\\text{naive}}]$：\n$$\\mathbb{E}[\\hat{p}_{\\text{naive}}] = \\frac{m_{A}p_{A} + m_{B}p_{B}}{m_{A} + m_{B}} = \\frac{(400)(0.12) + (100)(0.03)}{400 + 100} = \\frac{48 + 3}{500} = \\frac{51}{500} = 0.102$$\n偏差是这两个值之差：\n$$\\text{Bias} = \\mathbb{E}[\\hat{p}_{\\text{naive}}] - p_{\\text{true}} = 0.102 - 0.057 = 0.045$$\n偏差大小是偏差的绝对值：\n$$|\\text{Bias}| = |0.045| = 0.045$$\n这证实了存在一个显著的正偏差，导致对真实区域患病率的平均高估了 $4.5$ 个百分点。", "answer": "$$\\boxed{0.045}$$", "id": "4951835"}, {"introduction": "既然我们已经看到了不当抽样或分析如何引入抽样偏倚，现在我们来学习一个强大的修正工具：霍维茨-汤普森（Horvitz-Thompson, HT）估计量。该估计量通过对每个观测值赋予其入样概率的倒数作为权重，从而获得无偏估计。本练习 [@problem_id:4951792] 将引导您在一个小规模的不等概率抽样设计中，动手计算HT估计量及其方差，从而揭示逆概率加权这一巧妙原则的运作机制。", "problem": "一个卫生监测团队希望采用不等概率无放回抽样选出的单个样本，来估计一个小规模有限诊所总体中某种疾病的确诊病例总数。该总体包含 $N=4$ 家诊所，其病例数 $\\{y_i\\}$ 为固定值：\n- $y_1 = 12$\n- $y_2 = 7$\n- $y_3 = 9$\n- $y_4 = 5$\n\n采用样本量为 $n=2$ 的固定样本量设计。一阶包含概率为\n- $\\pi_1 = 0.6$，$\\pi_2 = 0.5$，$\\pi_3 = 0.5$，$\\pi_4 = 0.4$，\n\n且成对包含概率（对于 $i \\neq j$）为\n- $\\pi_{12} = 0.20$，$\\pi_{13} = 0.24$，$\\pi_{14} = 0.16$，\n- $\\pi_{23} = 0.16$，$\\pi_{24} = 0.14$，$\\pi_{34} = 0.10$。\n\n抽取得到的单个样本包含单元 $\\{1,3\\}$。\n\n仅使用包含指示变量的核心定义、基于权重 $\\pi_i^{-1}$ 构建的 Horvitz–Thompson (HT) 估计量，以及根据包含指示变量和包含概率的基于设计的方差定义（不使用任何外部简化公式），计算：\n- 对于抽到的样本 $\\{1,3\\}$，总体总值 $Y = \\sum_{i=1}^{4} y_i$ 的 Horvitz–Thompson 估计量 $\\hat{Y}_{HT}$，\n- 在给定的抽样设计下，$\\hat{Y}_{HT}$ 的精确设计方差 $\\operatorname{Var}(\\hat{Y}_{HT})$，用 $\\{\\pi_i\\}$、$\\{\\pi_{ij}\\}$ 和 $\\{y_i\\}$ 表示。\n\n将两个最终值作为无四舍五入的精确数值提供。将最终答案表示为纯数字（无单位）。您的最终答案必须按顺序 $\\hat{Y}_{HT}$，然后是 $\\operatorname{Var}(\\hat{Y}_{HT})$ 列出这两个数。", "solution": "所给问题是有效的。这是一个抽样调查理论中的适定问题，提供了所有必要的数据。对于从一个规模为 $N=4$ 的总体中抽取样本量为 $n=2$ 的固定样本量抽样设计，所给的包含概率是内部一致的。\n\n第一个目标是计算对于所抽到的样本 $S=\\{1,3\\}$，总体总值 $Y = \\sum_{i=1}^{4} y_i$ 的 Horvitz-Thompson (HT) 估计量 $\\hat{Y}_{HT}$。HT 估计量的公式为：\n$$ \\hat{Y}_{HT} = \\sum_{i \\in S} \\frac{y_i}{\\pi_i} $$\n其中 $y_i$ 是单元 $i$ 的目标变量值，$\\pi_i$ 是其一阶包含概率。抽到的样本由单元 $1$ 和 $3$ 组成。这些单元的值为 $y_1 = 12$ 和 $y_3 = 9$，相应的一阶包含概率为 $\\pi_1 = 0.6$ 和 $\\pi_3 = 0.5$。\n将这些值代入估计量公式：\n$$ \\hat{Y}_{HT} = \\frac{y_1}{\\pi_1} + \\frac{y_3}{\\pi_3} = \\frac{12}{0.6} + \\frac{9}{0.5} $$\n$$ \\hat{Y}_{HT} = 20 + 18 = 38 $$\n\n第二个目标是计算 $\\hat{Y}_{HT}$ 的精确设计方差，记为 $\\operatorname{Var}(\\hat{Y}_{HT})$。按照要求，我们从估计量关于包含指示变量的基本定义开始。设 $I_i$ 是一个随机变量，如果单元 $i$ 被包含在样本中，则 $I_i=1$，否则 $I_i=0$。HT 估计量可以表示为这些指示变量的线性组合：\n$$ \\hat{Y}_{HT} = \\sum_{i=1}^{N} \\frac{y_i}{\\pi_i} I_i $$\n该估计量的方差可使用随机变量和的方差性质求得：\n$$ \\operatorname{Var}(\\hat{Y}_{HT}) = \\operatorname{Var}\\left(\\sum_{i=1}^{N} \\frac{y_i}{\\pi_i} I_i\\right) = \\sum_{i=1}^{N} \\left(\\frac{y_i}{\\pi_i}\\right)^2 \\operatorname{Var}(I_i) + \\sum_{i=1}^{N} \\sum_{j \\neq i} \\left(\\frac{y_i}{\\pi_i}\\right) \\left(\\frac{y_j}{\\pi_j}\\right) \\operatorname{Cov}(I_i, I_j) $$\n根据定义，包含指示变量的期望为 $E[I_i] = \\pi_i = P(i \\in S)$。由于 $I_i$ 是一个伯努利变量，其方差为 $\\operatorname{Var}(I_i) = E[I_i^2] - (E[I_i])^2 = \\pi_i - \\pi_i^2 = \\pi_i(1-\\pi_i)$，因为 $I_i^2 = I_i$。\n两个不同指示变量 $I_i$ 和 $I_j$ 之间的协方差为 $\\operatorname{Cov}(I_i, I_j) = E[I_i I_j] - E[I_i]E[I_j] = \\pi_{ij} - \\pi_i \\pi_j$，其中 $\\pi_{ij} = P(i \\in S \\text{ and } j \\in S)$ 是成对包含概率。将这些代入方差表达式，得到 Horvitz-Thompson 方差公式：\n$$ \\operatorname{Var}(\\hat{Y}_{HT}) = \\sum_{i=1}^{N} \\frac{y_i^2}{\\pi_i^2} \\pi_i(1-\\pi_i) + \\sum_{i=1}^{N} \\sum_{j \\neq i} \\frac{y_i y_j (\\pi_{ij} - \\pi_i \\pi_j)}{\\pi_i \\pi_j} $$\n这可以简化为：\n$$ \\operatorname{Var}(\\hat{Y}_{HT}) = \\sum_{i=1}^{N} \\frac{y_i^2(1-\\pi_i)}{\\pi_i} + \\sum_{i=1}^{N} \\sum_{j \\neq i} \\frac{y_i y_j (\\pi_{ij} - \\pi_i \\pi_j)}{\\pi_i \\pi_j} $$\n我们分别计算这个和的两项。第一项是：\n$$ \\sum_{i=1}^{4} \\frac{y_i^2(1-\\pi_i)}{\\pi_i} = \\frac{12^2(1-0.6)}{0.6} + \\frac{7^2(1-0.5)}{0.5} + \\frac{9^2(1-0.5)}{0.5} + \\frac{5^2(1-0.4)}{0.4} $$\n$$ = \\frac{144(0.4)}{0.6} + \\frac{49(0.5)}{0.5} + \\frac{81(0.5)}{0.5} + \\frac{25(0.6)}{0.4} $$\n$$ = 96 + 49 + 81 + 37.5 = 263.5 $$\n第二项是一个双重求和。我们计算每一对 $(i, j)$（其中 $i \\neq j$）的被加数。设 $w_i = y_i/\\pi_i$。这些项是 $w_i w_j (\\pi_{ij} - \\pi_i \\pi_j)$。\n-  $i=1, j=2$: $(\\frac{12}{0.6})(\\frac{7}{0.5})(0.20 - 0.6 \\times 0.5) = (20)(14)(0.20 - 0.30) = 280(-0.1) = -28$.\n-  $i=1, j=3$: $(\\frac{12}{0.6})(\\frac{9}{0.5})(0.24 - 0.6 \\times 0.5) = (20)(18)(0.24 - 0.30) = 360(-0.06) = -21.6$.\n-  $i=1, j=4$: $(\\frac{12}{0.6})(\\frac{5}{0.4})(0.16 - 0.6 \\times 0.4) = (20)(12.5)(0.16 - 0.24) = 250(-0.08) = -20$.\n-  $i=2, j=3$: $(\\frac{7}{0.5})(\\frac{9}{0.5})(0.16 - 0.5 \\times 0.5) = (14)(18)(0.16 - 0.25) = 252(-0.09) = -22.68$.\n-  $i=2, j=4$: $(\\frac{7}{0.5})(\\frac{5}{0.4})(0.14 - 0.5 \\times 0.4) = (14)(12.5)(0.14 - 0.20) = 175(-0.06) = -10.5$.\n-  $i=3, j=4$: $(\\frac{9}{0.5})(\\frac{5}{0.4})(0.10 - 0.5 \\times 0.4) = (18)(12.5)(0.10 - 0.20) = 225(-0.1) = -22.5$.\n该双重求和包含每个对子两次（例如，$(1,2)$ 和 $(2,1)$）。由于被加数是对称的，我们将计算出的值相加再乘以 $2$：\n$$ \\sum_{i \\neq j} \\dots = 2 \\times (-28 - 21.6 - 20 - 22.68 - 10.5 - 22.5) $$\n$$ = 2 \\times (-125.28) = -250.56 $$\n总方差是这两部分之和：\n$$ \\operatorname{Var}(\\hat{Y}_{HT}) = 263.5 + (-250.56) = 12.94 $$\n所求的两个值是 $\\hat{Y}_{HT} = 38$ 和 $\\operatorname{Var}(\\hat{Y}_{HT}) = 12.94$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 38  12.94 \\end{pmatrix} } $$", "id": "4951792"}, {"introduction": "除了确保估计量的无偏性，我们还必须控制其变异性，即抽样误差，以保证研究结果的精确度。本实践练习 [@problem_id:4951762] 聚焦于研究设计中这一关键环节。您将推导并应用公式，计算在给定误差范围下所需的最小样本量，同时还将考虑有限总体校正系数——当抽样比例占已知总体相当一部分时，这是一个不可忽视的重要因素。", "problem": "一个生物统计学团队计划使用无放回简单随机抽样（SRSWOR）来估计一个有限的成年患者登记库中的平均身体质量指数。该登记库包含一个已知的、固定大小的总体，其规模为 $N = 5000$。根据对同一登记库的先前普查，已知总体方差为 $S^{2} = 36$，并且据信该方差保持稳定。该团队希望为总体均值构建一个置信水平为 $1 - \\alpha = 0.95$ 的双侧置信区间，并要求误差范围最多为 $m = 0.5$（以身体质量指数为单位）。假设在无放回简单随机抽样下，抽样估计量是无偏的，并且正态近似适用于样本均值的抽样分布。在您的推导和计算中，请明确包含有限总体校正。\n\n从区分抽样误差和抽样偏差的基本定义出发，并基于无放回简单随机抽样下样本均值是无偏的这一核心事实进行推导。从以标准正态分位数 $z_{1-\\alpha/2}$ 和无放回简单随机抽样下样本均值的标准误定义的均值的双侧 $(1 - \\alpha)$ 置信区间的定义开始，推导出一个表达式，用于计算能使误差范围恰好等于 $m$ 的连续（实值）样本量 $n_{\\text{cont}}$。然后，通过取满足您推导所隐含的不等式的最小整数，确定保证误差范围要求的最小整数样本量 $n_{\\min}$。\n\n对于 $\\alpha = 0.05$，使用 $z_{1-\\alpha/2} = z_{0.975}$，并用 $z_{0.975} \\approx 1.96$ 进行数值计算。报告最小整数样本量 $n_{\\min}$。不要按有效数字四舍五入；相反，请提供满足要求的最小整数 $n$。", "solution": "问题要求确定从有限总体中使用无放回简单随机抽样（SRSWOR）估计总体均值时，为满足指定的误差范围和置信水平所需的最小整数样本量 $n_{\\min}$。解答必须从基本统计原理出发，进行严格推导。\n\n首先，我们必须区分抽样偏差（sampling bias）和抽样误差（sampling error）。抽样偏差指的是估计量的期望值与真实总体参数之间的系统性差异。如果参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的期望值等于真实值，即 $E[\\hat{\\theta}] = \\theta$，则该估计量是无偏的。相反，抽样误差是估计量的值在不同样本之间存在的随机变异性，这是抽样过程所固有的。它不是系统性误差，而是观测一个子集而非整个总体的结果。抽样误差的大小通常用估计量的标准误来量化。\n\n问题指定使用无放回简单随机抽样（SRSWOR），对于这种方法，样本均值 $\\bar{y}$ 是总体均值 $\\mu$ 的一个公认的无偏估计量。因此，$E[\\bar{y}] = \\mu$，不存在需要考虑的抽样偏差。我们的任务是通过确保样本量足够大来控制抽样误差。\n\n总体均值 $\\mu$ 在置信水平为 $1 - \\alpha$ 的双侧置信区间构造如下：\n$$ \\bar{y} \\pm m $$\n其中 $m$ 是误差范围。在样本均值的抽样分布近似为正态分布的假设下，误差范围定义为：\n$$ m = z_{1-\\alpha/2} \\times \\text{SE}(\\bar{y}) $$\n此处，$z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数，而 $\\text{SE}(\\bar{y})$ 是样本均值的标准误。\n\n对于从大小为 $N$ 的有限总体中进行的无放回简单随机抽样，样本均值的方差由下式给出：\n$$ \\text{Var}(\\bar{y}) = \\frac{S^2}{n} \\left( \\frac{N-n}{N} \\right) $$\n其中 $S^2$ 是总体方差，$n$ 是样本量，而项 $\\left( \\frac{N-n}{N} \\right)$ 是有限总体校正（FPC）。标准误是方差的平方根：\n$$ \\text{SE}(\\bar{y}) = \\sqrt{\\frac{S^2}{n} \\left( \\frac{N-n}{N} \\right)} $$\n问题要求误差范围最多为 $m = 0.5$。为求得最小样本量，我们将误差范围设定为其允许的最大值：\n$$ m = z_{1-\\alpha/2} \\sqrt{\\frac{S^2}{n} \\left( \\frac{N-n}{N} \\right)} $$\n我们现在求解这个关于 $n$ 的方程。将两边平方得到：\n$$ m^2 = z_{1-\\alpha/2}^2 \\left( \\frac{S^2}{n} \\right) \\left( \\frac{N-n}{N} \\right) $$\n$$ m^2 = z_{1-\\alpha/2}^2 S^2 \\left( \\frac{1}{n} - \\frac{1}{N} \\right) $$\n为分离出 $n$，我们首先求解 $\\frac{1}{n}$：\n$$ \\frac{m^2}{z_{1-\\alpha/2}^2 S^2} = \\frac{1}{n} - \\frac{1}{N} $$\n$$ \\frac{1}{n} = \\frac{m^2}{z_{1-\\alpha/2}^2 S^2} + \\frac{1}{N} $$\n让我们定义 $n_0$ 为无限总体（或者等效地说，如果忽略 FPC）所需的样本量。这可以通过将 FPC 因子设为 $1$ 来找到：\n$$ n_0 = \\frac{z_{1-\\alpha/2}^2 S^2}{m^2} $$\n将此定义代入我们关于 $\\frac{1}{n}$ 的方程中：\n$$ \\frac{1}{n} = \\frac{1}{n_0} + \\frac{1}{N} $$\n这巧妙地将所需样本量 $n$ 与无限总体样本量 $n_0$ 及总体大小 $N$ 联系起来。为了找到连续样本量 $n_{\\text{cont}}$ 的表达式，我们求解 $n$：\n$$ \\frac{1}{n} = \\frac{N + n_0}{n_0 N} $$\n$$ n = n_{\\text{cont}} = \\frac{n_0 N}{n_0 + N} = \\frac{n_0}{1 + \\frac{n_0}{N}} $$\n这就是推导出的能使误差范围恰好等于 $m$ 的连续样本量 $n_{\\text{cont}}$ 的表达式。\n\n现在，我们代入给定的数值：\n总体大小 $N = 5000$。\n总体方差 $S^2 = 36$。\n期望的误差范围 $m = 0.5$。\n置信水平 $1 - \\alpha = 0.95$，这得出 $\\alpha = 0.05$。相应的标准正态分位数为 $z_{1-\\alpha/2} = z_{0.975} \\approx 1.96$。\n\n首先，我们计算初始样本量估计值 $n_0$：\n$$ n_0 = \\frac{(1.96)^2 \\times 36}{(0.5)^2} = \\frac{3.8416 \\times 36}{0.25} = 3.8416 \\times 144 = 553.1904 $$\n接下来，我们用这个值来计算包含有限总体校正的连续样本量 $n_{\\text{cont}}$：\n$$ n_{\\text{cont}} = \\frac{n_0}{1 + \\frac{n_0}{N}} = \\frac{553.1904}{1 + \\frac{553.1904}{5000}} = \\frac{553.1904}{1 + 0.11063808} = \\frac{553.1904}{1.11063808} \\approx 498.0835 $$\n值 $n_{\\text{cont}} \\approx 498.0835$ 是能产生恰好为 $m=0.5$ 的误差范围的精确实值样本量。然而，样本量必须是整数。误差范围是样本量 $n$ 的递减函数。为确保误差范围*最多*为 $m=0.5$，所选的整数样本量 $n$ 必须大于或等于 $n_{\\text{cont}}$。因此，最小整数样本量 $n_{\\min}$ 是满足此条件的最小整数，即 $n_{\\text{cont}}$ 的向上取整（ceiling）：\n$$ n_{\\min} = \\lceil n_{\\text{cont}} \\rceil = \\lceil 498.0835 \\rceil = 499 $$\n样本量为 $n=498$ 会导致误差范围略大于 $0.5$，因此不满足要求。样本量为 $n=499$ 是保证误差范围不超过 $0.5$ 的最小整数值。", "answer": "$$\\boxed{499}$$", "id": "4951762"}]}