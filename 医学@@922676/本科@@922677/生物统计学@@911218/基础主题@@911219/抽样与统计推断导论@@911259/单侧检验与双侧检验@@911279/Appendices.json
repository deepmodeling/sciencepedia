{"hands_on_practices": [{"introduction": "这个练习将巩固你对单尾和双尾 $p$ 值基本含义的理解。我们将从一个给定的、服从标准正态分布的检验统计量出发，看看研究问题的方向性如何直接转化为对分布尾部概率的计算，这是所有假设检验背后的核心逻辑。[@problem_id:4934926]", "problem": "一项多中心随机试验评估了一种新的疗法是否比标准护理能更有效地改善某个生物标志物的水平。设 $\\mu_{\\text{new}}-\\mu_{\\text{standard}}$ 表示从基线变化的平均差异（正值表示改善效果更好）。研究者预先设定了一个支持新疗法效果更强的优效性声明，即备择假设是单侧的：$H_{1}: \\mu_{\\text{new}}-\\mu_{\\text{standard}} > 0$。通过已知或良好估计方差的大样本分析，在原假设 $H_{0}: \\mu_{\\text{new}}-\\mu_{\\text{standard}}=0$ 下，检验统计量近似服从标准正态分布。观测到的 $Z$-统计量为 $z_{\\text{obs}}=2.1$。\n\n仅使用 $p$-值的定义（即在原假设下，获得至少与观测到的检验统计量一样极端的尾部概率）和标准正态分布的性质，计算：\n1) 针对优效性备择假设 $H_{1}$ 的单尾 $p$-值，\n2) 针对无方向性备择假设 $H_{1}: \\mu_{\\text{new}}-\\mu_{\\text{standard}}\\neq 0$ 的双尾 $p$-值。\n\n然后，在常规显著性水平下解释支持优效性声明的证据强度，并从第一性原理出发证明你的推理。\n\n按顺序报告单尾和双尾 $p$-值的数值结果。将你的数值答案四舍五入到四位有效数字。最终数值答案不带单位。", "solution": "首先评估问题的有效性。\n\n### 步骤 1：提取给定信息\n- **关注参数：** 某生物标志物从基线变化的平均差异，$\\mu_{\\text{new}}-\\mu_{\\text{standard}}$。正值表示新疗法更有效。\n- **原假设 ($H_{0}$)：** $\\mu_{\\text{new}}-\\mu_{\\text{standard}}=0$。\n- **备择假设 ($H_{1}$)，单侧：** $H_{1}: \\mu_{\\text{new}}-\\mu_{\\text{standard}} > 0$（新疗法的优效性声明）。\n- **备择假设 ($H_{1}$)，双侧：** $\\mu_{\\text{new}}-\\mu_{\\text{standard}}\\neq 0$。\n- **检验统计量 ($Z$)：** 在 $H_0$ 下，该统计量近似服从标准正态分布，$Z \\sim N(0,1)$。\n- **观测到的检验统计量 ($z_{\\text{obs}}$)：** $z_{\\text{obs}}=2.1$。\n- **任务：**\n    1. 计算优效性假设的单尾 $p$-值。\n    2. 计算无方向性假设的双尾 $p$-值。\n    3. 解释优效性声明的证据强度。\n    4. 报告两个 $p$-值，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的信息进行验证\n- **科学依据：** 该问题牢固地建立在频率学派假设检验的原则之上，这是生物统计学的基石。在大样本中，使用Z检验来比较均值是一种标准且有效的方法。\n- **适定性：** 该问题是适定的。所有必要的组成部分都已提供：原假设和备择假设、检验统计量的零分布（$N(0,1)$）以及统计量的观测值（$z_{\\text{obs}} = 2.1$）。这使得所需 $p$-值的计算是唯一的。\n- **客观性：** 该问题以客观、正式的语言陈述，这是统计学和生物统计学的典型特征，不含任何主观或基于意见的声明。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、适定的和客观的。它不包含任何矛盾或缺失的信息。结论是该问题是**有效的**。将提供一个解决方案。\n\n***\n\n$p$-值定义为在原假设（$H_0$）下，获得至少与实际观测到的检验统计量结果一样极端的概率。原假设指出，我们的检验统计量 $Z$ 服从标准正态分布，记为 $Z \\sim N(0,1)$。观测到的检验统计量为 $z_{\\text{obs}} = 2.1$。\n\n**1) 单尾 $p$-值的计算**\n\n单尾备择假设是优效性声明，$H_1: \\mu_{\\text{new}}-\\mu_{\\text{standard}} > 0$。这个单尾检验的拒绝域位于标准正态分布的右上尾。大于或等于观测值 $z_{\\text{obs}}$ 的检验统计量值被认为是在备择假设方向上“至少一样极端”的。\n\n因此，我们记为 $p_{1}$ 的单尾 $p$-值是在 $H_0$ 为真的假设下，概率 $P(Z \\ge z_{\\text{obs}})$。\n$$p_{1} = P(Z \\ge 2.1 | H_0)$$\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数（CDF），定义为 $\\Phi(z) = P(Z \\le z)$。位于右上尾的概率可以计算为：\n$$p_{1} = 1 - P(Z  2.1) = 1 - \\Phi(2.1)$$\n使用标准统计表或计算软件计算标准正态CDF，我们发现 $\\Phi(2.1) \\approx 0.9821356$。\n$$p_{1} \\approx 1 - 0.9821356 = 0.0178644$$\n四舍五入到四位有效数字，单尾 $p$-值为 $0.01786$。\n\n**2) 双尾 $p$-值的计算**\n\n对于双尾备择假设 $H_1: \\mu_{\\text{new}}-\\mu_{\\text{standard}} \\neq 0$，“至少一样极端”指的是观测到一个检验统计量值与零假设值（$0$）的距离至少与 $z_{\\text{obs}}$ 一样远，无论方向如何。这意味着我们关注的是满足 $|Z| \\ge |z_{\\text{obs}}|$ 的 $Z$ 值。\n\n记为 $p_{2}$ 的双尾 $p$-值为：\n$$p_{2} = P(|Z| \\ge |2.1| | H_0) = P(Z \\ge 2.1 \\text{ or } Z \\le -2.1)$$\n由于事件 $Z \\ge 2.1$ 和 $Z \\le -2.1$ 是互斥的，它们的并集概率是它们各自概率的总和：\n$$p_{2} = P(Z \\ge 2.1) + P(Z \\le -2.1)$$\n由于标准正态分布关于 $0$ 的对称性，对于任何 $z  0$，我们有 $P(Z \\le -z) = P(Z \\ge z)$。因此，$P(Z \\le -2.1) = P(Z \\ge 2.1)$。\n这可将双尾 $p$-值的表达式简化为：\n$$p_{2} = 2 \\times P(Z \\ge 2.1) = 2 \\times p_{1}$$\n使用未四舍五入的 $p_1$ 值：\n$$p_{2} \\approx 2 \\times 0.0178644 = 0.0357288$$\n四舍五入到四位有效数字，双尾 $p$-值为 $0.03573$。\n\n**证据强度的解释**\n\n对优效性声明证据的解释必须基于预先设定的单尾假设及其对应的 $p$-值，$p_{1} \\approx 0.01786$。在假设检验中，我们将 $p$-值与预先确定的显著性水平（记为 $\\alpha$）进行比较。$\\alpha$ 的常规值为 $0.05$ 和 $0.01$。\n- 如果我们使用 $\\alpha = 0.05$ 的显著性水平，我们发现 $p_{1} \\approx 0.01786  0.05$。根据这个约定，结果是统计显著的。我们将拒绝原假设 $H_0$，采纳备择假设 $H_1$，即新疗法更优越。\n- 如果我们使用更严格的显著性水平 $\\alpha = 0.01$，我们发现 $p_{1} \\approx 0.01786 > 0.01$。根据这个约定，结果不是统计显著的。我们将无法拒绝原假设 $H_0$。\n\n因此，新疗法优效性的证据在 $\\alpha=0.05$ 水平上是统计显著的，但在更严格的 $\\alpha=0.01$ 水平上则不显著。这表明存在中等强度的证据反对原假设，支持优效性声明。从第一性原理的解释如下：如果新疗法与标准护理相比确实没有效果（即 $H_0$ 为真），那么在该试验中观测到至少与当前结果一样有利于新疗法的概率大约是 $1.8\\%$。这是一个小概率事件，表明原假设可能不成立。", "answer": "$$\\boxed{\\begin{pmatrix} 0.01786  0.03573 \\end{pmatrix}}$$", "id": "4934926"}, {"introduction": "现在，让我们将理论应用于临床试验中的一个常见场景：比较两组的均值。这个问题 [@problem_id:4821265] 将我们从一个给定的 $Z$ 统计量带入到根据汇总数据计算 $t$ 统计量的完整过程。它演示了如何使用临界值做出决策，以及单尾和双尾检验的选择如何影响你的结论，特别是当结果接近统计显著性的阈值时。", "problem": "一项随机对照试验 (RCT) 评估了一种连续生物标志物的改善情况，比较了治疗组和对照组。设真实均值差异为 $\\Delta = \\mu_T - \\mu_C$，其中 $\\mu_T$ 是治疗组的均值，$\\mu_C$ 是对照组的均值。研究者们对两种检验都感兴趣：一种是与治疗效果更优的先验信念一致的单侧检验，另一种是对方向不敏感的双侧检验。样本量分别为 $n_T = 50$ 和 $n_C = 50$。观测到的样本均值差异为 $\\hat{\\Delta} = 0.35$，有利于治疗组。在等方差假设下，根据无偏合并方差估计量计算出的合并样本标准差为 $s = 0.8$。假设独立抽样、个体结果近似正态分布、以及各组间方差相等。对于单侧检验，使用假设 $H_0: \\Delta \\le 0$ 对 $H_1: \\Delta  0$。对于双侧检验，使用 $H_0: \\Delta = 0$ 对 $H_1: \\Delta \\ne 0$。\n\n使用等方差双样本学生 t 检验框架，从基本原理出发计算标准化检验统计量，并在显著性水平 $\\alpha = 0.025$ 和 $\\alpha = 0.05$ 下对单侧和双侧检验做出正式的拒绝决策。以指标形式报告最终决策，其中 $1$ 表示“拒绝 $H_0$”，$0$ 表示“不拒绝 $H_0$”。按以下顺序将您的最终答案表示为行矩阵\n$$(D_{\\text{one-sided},\\,\\alpha=0.05},\\;D_{\\text{one-sided},\\,\\alpha=0.025},\\;D_{\\text{two-sided},\\,\\alpha=0.05},\\;D_{\\text{two-sided},\\,\\alpha=0.025}).$$\n最终指标无需指定舍入规则。", "solution": "其基本依据是在正态模型下，当方差未知但相等时，均值差异的抽样分布。在等方差假设下，用于检验均值差异的标准化统计量使用合并标准差，并服从学生 t 分布。具体来说，对于大小为 $n_T$ 和 $n_C$ 的独立样本，样本均值为 $\\bar{X}_T$ 和 $\\bar{X}_C$，合并标准差为 $s$，则差异 $\\hat{\\Delta} = \\bar{X}_T - \\bar{X}_C$ 的标准误为\n$$\\operatorname{SE}(\\hat{\\Delta}) = s\\sqrt{\\frac{1}{n_T} + \\frac{1}{n_C}}.$$\n在检验 $H_0: \\Delta = 0$ 时（或在单侧检验情况下检验 $H_0: \\Delta \\le 0$，其在边界 $\\Delta=0$ 下使用相同的枢轴量），标准化检验统计量为\n$$t = \\frac{\\hat{\\Delta} - 0}{s\\sqrt{\\frac{1}{n_T} + \\frac{1}{n_C}}},$$\n该统计量在 $H_0$ 下服从自由度为\n$$\\nu = n_T + n_C - 2$$\n的学生 t 分布。\n\n我们计算标准误。当 $n_T = 50$，$n_C = 50$，且 $s = 0.8$ 时，\n$$\\operatorname{SE}(\\hat{\\Delta}) = 0.8\\sqrt{\\frac{1}{50} + \\frac{1}{50}} = 0.8\\sqrt{\\frac{2}{50}} = 0.8\\sqrt{0.04} = 0.8 \\times 0.2 = 0.16.$$\n因此，检验统计量为\n$$t = \\frac{0.35}{0.16} = 2.1875.$$\n自由度为\n$$\\nu = 50 + 50 - 2 = 98.$$\n\n决策规则：\n- 对于显著性水平为 $\\alpha$ 的单侧检验 $H_0: \\Delta \\le 0$ 对 $H_1: \\Delta  0$，如果 $t  t_{1-\\alpha,\\,\\nu}$，则拒绝 $H_0$。其中 $t_{1-\\alpha,\\,\\nu}$ 是自由度为 $\\nu$ 的学生 t 分布的 $(1-\\alpha)$ 分位数。\n- 对于显著性水平为 $\\alpha$ 的双侧检验 $H_0: \\Delta = 0$ 对 $H_1: \\Delta \\ne 0$，如果 $|t|  t_{1-\\alpha/2,\\,\\nu}$，则拒绝 $H_0$。\n\n现在我们将 $t = 2.1875$ 与 $\\nu = 98$ 的相关临界值进行比较。根据学生 t 分布的标准分位数：\n- $t_{0.95,\\,98} \\approx 1.660$,\n- $t_{0.975,\\,98} \\approx 1.984$,\n- $t_{0.9875,\\,98} \\approx 2.241$.\n\n单侧检验决策：\n- 当 $\\alpha = 0.05$ 时：将 $t$ 与 $t_{0.95,\\,98} \\approx 1.660$ 比较。由于 $2.1875  1.660$，拒绝 $H_0$ $\\Rightarrow D_{\\text{one-sided},\\,\\alpha=0.05} = 1$。\n- 当 $\\alpha = 0.025$ 时：将 $t$ 与 $t_{0.975,\\,98} \\approx 1.984$ 比较。由于 $2.1875  1.984$，拒绝 $H_0$ $\\Rightarrow D_{\\text{one-sided},\\,\\alpha=0.025} = 1$。\n\n双侧检验决策：\n- 当 $\\alpha = 0.05$ 时：将 $|t|$ 与 $t_{0.975,\\,98} \\approx 1.984$ 比较。由于 $2.1875  1.984$，拒绝 $H_0$ $\\Rightarrow D_{\\text{two-sided},\\,\\alpha=0.05} = 1$。\n- 当 $\\alpha = 0.025$ 时：将 $|t|$ 与 $t_{0.9875,\\,98} \\approx 2.241$ 比较。由于 $2.1875  2.241$，不拒绝 $H_0$ $\\Rightarrow D_{\\text{two-sided},\\,\\alpha=0.025} = 0$。\n\n按要求，我们按顺序 $(D_{\\text{one-sided},\\,\\alpha=0.05},\\,D_{\\text{one-sided},\\,\\alpha=0.025},\\,D_{\\text{two-sided},\\,\\alpha=0.05},\\,D_{\\text{two-sided},\\,\\alpha=0.025})$ 报告指标：\n$$(1,\\,1,\\,1,\\,0).$$", "answer": "$$\\boxed{\\begin{pmatrix}1  1  1  0\\end{pmatrix}}$$", "id": "4821265"}, {"introduction": "我们之前的例子都使用了连续分布。然而，许多生物统计数据是离散的，比如具有特定结局的患者计数。这个练习 [@problem_id:4821185] 探讨了使用二项分布进行假设检验时的细微差别。你将学习计算精确双尾 $p$ 值的正确方法，并理解为什么“将单尾 $p$ 值加倍”这个简单的启发式方法在这些情况下并非总是有效。", "problem": "一项临床预试验评估一种新的干预措施是否能提高相对于中性基准的二元临床成功概率。假设在成功概率为 $p=0.5$ 的原假设下，患者结局是独立同分布的。令 $X$ 表示 $n=10$ 名患者中的成功次数，因此 $X$ 服从二项分布 $X\\sim \\mathrm{Bin}(10,0.5)$。在一个观察队列中，记录到 $x=9$ 次成功。\n\n从基本定义出发，使用 $p$-值的定义，即在原假设下，结果至少与观察值一样极端的概率（其中“极端性”由适用于二项模型的单调似然比排序确定），来：\n\n- 计算优效性备择假设 $p0.5$ 的单侧精确 $p$-值，即在 $p=0.5$ 下的 $P(X\\geq 9)$。\n- 在 $p=0.5$ 的条件下，通过对所有概率 $P(X=k)$ 小于或等于 $P(X=9)$ 的样本点 $k$ 在原假设下的概率进行双尾求和，构建一个有效的双侧精确 $p$-值。\n\n然后，基于上述定义，简要解释为什么在医学研究中遇到的离散情况下，常见的“将较小单侧尾部概率加倍”规则通常不能得出一个有效的双侧精确 $p$-值，尽管在这个特定的对称情况下结果可能恰好吻合。\n\n将所有最终数值精确表示为有理数，无需四舍五入。你的最终答案必须只包含单侧和双侧的 $p$-值。", "solution": "问题陈述是统计假设检验中一个有效且定义明确的问题。它要求计算二项检验的单侧和双侧精确 $p$-值，并解释关于离散分布双侧检验的一个关键细微之处。\n\n该实验设置由一个随机变量 $X$ 建模，它表示在 $n=10$ 次独立伯努利试验中的成功次数。在原假设 $H_0$ 下，每次试验的成功概率为 $p=0.5$。因此，$H_0$ 下 $X$ 的分布是二项分布，$X \\sim \\mathrm{Bin}(n=10, p=0.5)$。\n\n在 $H_0$ 下的概率质量函数（PMF）由下式给出：\n$$P(X=k | H_0) = \\binom{n}{k} p^k (1-p)^{n-k} = \\binom{10}{k} (0.5)^k (1-0.5)^{10-k} = \\binom{10}{k} (0.5)^{10}$$\n由于 $(0.5)^{10} = (\\frac{1}{2})^{10} = \\frac{1}{1024}$，概率质量函数为：\n$$P(X=k | H_0) = \\frac{\\binom{10}{k}}{1024}$$\n观察到的结果是 $x=9$ 次成功。\n\n**第一部分：单侧精确 $p$-值**\n对于优效性备择假设 $p0.5$ 的单侧 $p$-值，其定义为在备择假设的方向上，观察到至少与观察数据（$x=9$）一样极端的结果的概率。对于备择假设 $p0.5$，“更极端”意味着更多的成功次数。因此，$p$-值为 $P(X \\ge 9 | H_0)$。\n\n$$p_{\\text{one-sided}} = P(X \\ge 9 | H_0) = P(X=9) + P(X=10)$$\n我们计算各个概率：\n$$P(X=9) = \\binom{10}{9} (0.5)^{10} = 10 \\times \\frac{1}{1024} = \\frac{10}{1024}$$\n$$P(X=10) = \\binom{10}{10} (0.5)^{10} = 1 \\times \\frac{1}{1024} = \\frac{1}{1024}$$\n将这些概率相加得到单侧 $p$-值：\n$$p_{\\text{one-sided}} = \\frac{10}{1024} + \\frac{1}{1024} = \\frac{11}{1024}$$\n\n**第二部分：双侧精确 $p$-值**\n问题指定通过对所有概率 $P(X=k)$ 小于或等于观察结果概率 $P(X=9)$ 的样本点 $k$ 在原假设下的概率进行求和，来构建双侧 $p$-值。这是一个精确双侧 $p$-值的标准定义，有时被称为“小 $p$”法。\n\n首先，我们确定观察结果的概率：$P(X=9) = \\frac{10}{1024}$。接下来，我们必须找到所有可能的结果 $k \\in \\{0, 1, \\dots, 10\\}$，使得 $P(X=k) \\leq P(X=9)$。这等价于找到所有满足以下条件的 $k$：\n$$\\frac{\\binom{10}{k}}{1024} \\leq \\frac{10}{1024} \\implies \\binom{10}{k} \\leq 10$$\n我们列出二项式系数 $\\binom{10}{k}$：\n- $\\binom{10}{0} = 1$ (满足 $\\leq 10$)\n- $\\binom{10}{1} = 10$ (满足 $\\leq 10$)\n- $\\binom{10}{2} = 45$ (不满足)\n- $\\binom{10}{3} = 120$ (不满足)\n- $\\binom{10}{4} = 210$ (不满足)\n- $\\binom{10}{5} = 252$ (不满足)\n由于二项式系数的对称性 $\\binom{n}{k} = \\binom{n}{n-k}$，我们有：\n- $\\binom{10}{6} = \\binom{10}{4} = 210$ (不满足)\n- $\\binom{10}{7} = \\binom{10}{3} = 120$ (不满足)\n- $\\binom{10}{8} = \\binom{10}{2} = 45$ (不满足)\n- $\\binom{10}{9} = \\binom{10}{1} = 10$ (满足 $\\leq 10$)\n- $\\binom{10}{10} = \\binom{10}{0} = 1$ (满足 $\\leq 10$)\n\n与 $x=9$ 一样极端或更极端（即，概率相等或更小）的结果集合是 $\\{0, 1, 9, 10\\}$。双侧 $p$-值是它们概率的总和：\n$$p_{\\text{two-sided}} = P(X=0) + P(X=1) + P(X=9) + P(X=10)$$\n$$p_{\\text{two-sided}} = \\frac{\\binom{10}{0}}{1024} + \\frac{\\binom{10}{1}}{1024} + \\frac{\\binom{10}{9}}{1024} + \\frac{\\binom{10}{10}}{1024}$$\n$$p_{\\text{two-sided}} = \\frac{1 + 10 + 10 + 1}{1024} = \\frac{22}{1024} = \\frac{11}{512}$$\n\n**第三部分：“尾部概率加倍”规则的解释**\n“将较小单侧尾部概率加倍”规则是近似计算双侧 $p$-值的一种常用启发式方法。对于观察结果 $x=9$，单侧尾部概率为 $P(X \\ge 9) = \\frac{11}{1024}$。将此值加倍得到 $2 \\times \\frac{11}{1024} = \\frac{22}{1024} = \\frac{11}{512}$。在这个特定案例中，该结果与上面计算的精确双侧 $p$-值吻合。\n\n然而，这种吻合是原假设分布 $X \\sim \\mathrm{Bin}(10, p=0.5)$ 对称性所致的人为结果。构建双侧 $p$-值的基本原则是，将所有概率等于或小于观察结果概率的结果的概率相加。对于对称的离散分布，一个尾部的结果 $k$ 与另一尾部其对应的结果 $n-k$ 具有相同的概率，即 $P(X=k) = P(X=n-k)$。在我们的案例中，$P(X=9)=P(X=1)$ 且 $P(X=10)=P(X=0)$。结果集合 $\\{k | P(X=k) \\le P(X=9)\\}$ 为 $\\{0, 1, 9, 10\\}$。总概率为 $P(X \\le 1) + P(X \\ge 9)$，并且由于对称性，$P(X \\le 1) = P(X \\ge 9)$，因此总概率确实是 $2 \\times P(X \\ge 9)$。\n\n这个规则对于在医学研究中常见的非对称离散分布（例如，当原假设概率不为 $0.5$ 时，或使用像 Poisson 分布这样的分布时）是无效的。在非对称分布中，两个分别位于两尾的结果通常不会有相同的概率。对于一个观察结果 $x_{obs}$，“尾部概率加倍”规则缺乏严格的理由，因为“同等极端”必须由概率来定义，而不是由与均值或其他任何中心性度量的距离来定义。即使上尾的结果 $k_2$ 离均值“更远”，下尾的结果 $k_1$ 的概率也可能比 $k_2$ 的概率更小，即 $P(X=k_1)  P(X=k_2)$。正确的程序始终是找出所有满足 $P(X=k) \\le P(X=x_{obs})$ 的结果 $k$，并将其概率相加。“尾部概率加倍”的捷径忽略了这一原则，因此对于离散分布通常是无效的，在原假设分布不对称时会产生不正确的 $p$-值。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{11}{1024}  \\frac{11}{512} \\end{pmatrix}}$$", "id": "4821185"}]}