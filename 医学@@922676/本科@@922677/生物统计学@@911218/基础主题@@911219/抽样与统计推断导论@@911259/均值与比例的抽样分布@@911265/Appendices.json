{"hands_on_practices": [{"introduction": "在生物统计学中，我们经常需要比较两个独立群体的比率，例如两种疗法的成功率或两个人群中某种生物标志物的患病率。这个练习将指导你应用中心极限定理来推导两个样本比例之差的抽样分布。掌握这一基本技能对于构建置信区间和进行假设检验至关重要。[@problem_id:4951512]", "problem": "一位生物统计学家正在比较两种独立队列中某一特定生物标志物的存在情况。在队列 $1$ 中，每个受试者的生物标志物状态被建模为成功概率为 $p_{1}$ 的独立伯努利随机变量 $X_{1,i}$；在队列 $2$ 中，每个受试者的生物标志物状态被建模为成功概率为 $p_{2}$ 的独立伯努利随机变量 $X_{2,j}$。设样本量分别为 $n_{1}$ 和 $n_{2}$，样本比例定义为 $\\hat{p}_{1} = \\frac{1}{n_{1}}\\sum_{i=1}^{n_{1}} X_{1,i}$ 和 $\\hat{p}_{2} = \\frac{1}{n_{2}}\\sum_{j=1}^{n_{2}} X_{2,j}$。假设在队列内部以及队列之间都是独立的。\n\n仅使用伯努利随机变量的定义和针对独立和的中心极限定理 (CLT)，推导当 $n_{1} \\to \\infty$ 和 $n_{2} \\to \\infty$ 时 $\\hat{p}_{1} - \\hat{p}_{2}$ 的渐近分布，并求出其以 $p_{1}$、 $p_{2}$、 $n_{1}$ 和 $n_{2}$ 表示的渐近方差。\n\n然后，对于 $p_{1} = 0.12$、 $p_{2} = 0.08$、 $n_{1} = 800$ 和 $n_{2} = 1000$ 的情况，数值计算该渐近方差。将您的答案四舍五入到四位有效数字。", "solution": "首先根据指定程序验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 队列 $1$：受试者的生物标志物状态被建模为成功概率为 $p_{1}$ 的独立伯努利随机变量 $X_{1,i}$。样本量为 $n_{1}$。\n- 队列 $2$：受试者的生物标志物状态被建模为成功概率为 $p_{2}$ 的独立伯努利随机变量 $X_{2,j}$。样本量为 $n_{2}$。\n- 队列 $1$ 的样本比例：$\\hat{p}_{1} = \\frac{1}{n_{1}}\\sum_{i=1}^{n_{1}} X_{1,i}$。\n- 队列 $2$ 的样本比例：$\\hat{p}_{2} = \\frac{1}{n_{2}}\\sum_{j=1}^{n_{2}} X_{2,j}$。\n- 假设在队列内部以及队列之间都是独立的。\n- 任务是使用中心极限定理 (CLT) 推导当 $n_{1} \\to \\infty$ 和 $n_{2} \\to \\infty$ 时 $\\hat{p}_{1} - \\hat{p}_{2}$ 的渐近分布。\n- 任务要求以 $p_{1}$、 $p_{2}$、 $n_{1}$ 和 $n_{2}$ 表示渐近方差。\n- 任务要求对 $p_{1} = 0.12$、 $p_{2} = 0.08$、 $n_{1} = 800$ 和 $n_{2} = 1000$ 的情况进行方差的数值计算。\n- 数值结果必须四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据**：该问题是生物统计学中的一个标准练习，依赖于概率论的基本原理，包括伯努利分布、抽样分布和中心极限定理。所有前提在事实上和科学上都是合理的。\n- **适定性**：问题定义清晰。它提供了推导所要求的渐近分布及其方差所需的所有必要信息（分布、参数、样本量、独立性假设）。该问题有唯一且有意义的解。\n- **客观性**：语言精确、正式，没有任何主观或含糊的术语。\n\n该问题没有表现出任何列出的缺陷。它不是科学上不合理、不可形式化、不完整、不切实际、不适定或微不足道的。它是统计理论中一个标准的、可验证的问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。下面提供了完整的解答。\n\n该问题要求推导样本比例之差 $\\hat{p}_{1} - \\hat{p}_{2}$ 的渐近分布。这可以通过首先分别确定每个样本比例的渐近分布，然后将它们组合起来完成。\n\n对于队列 $1$，每个 $X_{1,i}$ 是一个成功概率为 $p_{1}$ 的独立伯努利随机变量。$X_{1,i}$ 的期望和方差为：\n$$\nE[X_{1,i}] = p_{1}\n$$\n$$\n\\text{Var}(X_{1,i}) = p_{1}(1 - p_{1})\n$$\n样本比例 $\\hat{p}_{1}$ 是 $n_{1}$ 个独立同分布 (i.i.d.) 随机变量的样本均值。$\\hat{p}_{1}$ 的期望是：\n$$\nE[\\hat{p}_{1}] = E\\left[\\frac{1}{n_{1}}\\sum_{i=1}^{n_{1}} X_{1,i}\\right] = \\frac{1}{n_{1}}\\sum_{i=1}^{n_{1}} E[X_{1,i}] = \\frac{1}{n_{1}}(n_{1}p_{1}) = p_{1}\n$$\n由于 $X_{1,i}$ 变量的独立性，$\\hat{p}_{1}$ 的方差是：\n$$\n\\text{Var}(\\hat{p}_{1}) = \\text{Var}\\left(\\frac{1}{n_{1}}\\sum_{i=1}^{n_{1}} X_{1,i}\\right) = \\frac{1}{n_{1}^{2}}\\sum_{i=1}^{n_{1}} \\text{Var}(X_{1,i}) = \\frac{1}{n_{1}^{2}}(n_{1}p_{1}(1 - p_{1})) = \\frac{p_{1}(1 - p_{1})}{n_{1}}\n$$\n根据中心极限定理，当 $n_{1} \\to \\infty$ 时，$\\hat{p}_{1}$ 的抽样分布收敛于一个均值为 $p_{1}$、方差为 $\\frac{p_{1}(1 - p_{1})}{n_{1}}$ 的正态分布。我们可以将其写为：\n$$\n\\hat{p}_{1} \\overset{d}{\\to} N\\left(p_{1}, \\frac{p_{1}(1 - p_{1})}{n_{1}}\\right)\n$$\n其中 $\\overset{d}{\\to}$ 表示依分布收敛。\n\n类似地，对于队列 $2$，我们有 $X_{2,j} \\sim \\text{Bernoulli}(p_{2})$，其 $E[X_{2,j}] = p_{2}$ 且 $\\text{Var}(X_{2,j}) = p_{2}(1 - p_{2})$。样本比例 $\\hat{p}_{2}$ 的期望和方差为：\n$$\nE[\\hat{p}_{2}] = p_{2}\n$$\n$$\n\\text{Var}(\\hat{p}_{2}) = \\frac{p_{2}(1 - p_{2})}{n_{2}}\n$$\n根据中心极限定理，当 $n_{2} \\to \\infty$ 时，$\\hat{p}_{2}$ 的渐近分布是：\n$$\n\\hat{p}_{2} \\overset{d}{\\to} N\\left(p_{2}, \\frac{p_{2}(1 - p_{2})}{n_{2}}\\right)\n$$\n问题陈述两个队列是独立的。因此，随机变量 $\\hat{p}_{1}$ 和 $\\hat{p}_{2}$ 是独立的。正态分布的一个性质是，两个独立的服从正态分布的随机变量之差也服从正态分布。\n\n我们关心的是差值 $D = \\hat{p}_{1} - \\hat{p}_{2}$ 的分布。该差值的期望是：\n$$\nE[D] = E[\\hat{p}_{1} - \\hat{p}_{2}] = E[\\hat{p}_{1}] - E[\\hat{p}_{2}] = p_{1} - p_{2}\n$$\n由于 $\\hat{p}_{1}$ 和 $\\hat{p}_{2}$ 的独立性，差值的方差是它们方差的和：\n$$\n\\text{Var}(D) = \\text{Var}(\\hat{p}_{1} - \\hat{p}_{2}) = \\text{Var}(\\hat{p}_{1}) + \\text{Var}(\\hat{p}_{2}) = \\frac{p_{1}(1 - p_{1})}{n_{1}} + \\frac{p_{2}(1 - p_{2})}{n_{2}}\n$$\n因此，当 $n_{1} \\to \\infty$ 和 $n_{2} \\to \\infty$ 时，$\\hat{p}_{1} - \\hat{p}_{2}$ 的渐近分布是一个均值为 $p_{1} - p_{2}$、方差为 $\\frac{p_{1}(1 - p_{1})}{n_{1}} + \\frac{p_{2}(1 - p_{2})}{n_{2}}$ 的正态分布。形式上：\n$$\n\\hat{p}_{1} - \\hat{p}_{2} \\overset{d}{\\to} N\\left(p_{1} - p_{2}, \\frac{p_{1}(1 - p_{1})}{n_{1}} + \\frac{p_{2}(1 - p_{2})}{n_{2}}\\right)\n$$\n$\\hat{p}_{1} - \\hat{p}_{2}$ 的渐近方差是：\n$$\n\\text{Var}(\\hat{p}_{1} - \\hat{p}_{2}) = \\frac{p_{1}(1 - p_{1})}{n_{1}} + \\frac{p_{2}(1 - p_{2})}{n_{2}}\n$$\n现在，我们使用给定的数值进行数值计算：$p_{1} = 0.12$、 $p_{2} = 0.08$、 $n_{1} = 800$ 和 $n_{2} = 1000$。\n$$\n\\text{Var}(\\hat{p}_{1} - \\hat{p}_{2}) = \\frac{0.12(1 - 0.12)}{800} + \\frac{0.08(1 - 0.08)}{1000}\n$$\n$$\n\\text{Var}(\\hat{p}_{1} - \\hat{p}_{2}) = \\frac{0.12(0.88)}{800} + \\frac{0.08(0.92)}{1000}\n$$\n$$\n\\text{Var}(\\hat{p}_{1} - \\hat{p}_{2}) = \\frac{0.1056}{800} + \\frac{0.0736}{1000}\n$$\n$$\n\\text{Var}(\\hat{p}_{1} - \\hat{p}_{2}) = 0.000132 + 0.0000736\n$$\n$$\n\\text{Var}(\\hat{p}_{1} - \\hat{p}_{2}) = 0.0002056\n$$\n问题要求答案四舍五入到四位有效数字。计算值为 $0.0002056$。第一个有效数字是第一个非零数字，即 $2$。四位有效数字是 $2、0、5$ 和 $6$。计算出的数字 $0.0002056$ 已经恰好有四位有效数字。因此，不需要额外的四舍五入。\n结果是 $0.0002056$。", "answer": "$$\n\\boxed{0.0002056}\n$$", "id": "4951512"}, {"introduction": "当我们处理连续数据时，一个常见的挑战是比较两组的均值，特别是当不能假定它们的总体方差相等时。这个练习探讨了为什么在这种情况下，标准学生$t$分布不再适用，并引导你推导Welch-Satterthwaite近似。这是进行稳健两样本比较的一个关键工具，解决了经典的Behrens-Fisher问题。[@problem_id:4951504]", "problem": "一个生物统计学团队正在比较两个独立队列（一个治疗组和一个对照组）之间收缩压平均值的变化。假设每组的变化（随访值减去基线值）是从方差可能不相等的正态总体中抽取的随机样本。设治疗组的样本量为 $n_1$，样本方差为 $s_1^{2}$；对照组的样本量为 $n_2$，样本方差为 $s_2^{2}$。样本均值分别为 $\\bar{X}_1$ 和 $\\bar{X}_2$。考虑标准化均值差统计量\n$$\nT \\;=\\; \\frac{\\bar{X}_1 - \\bar{X}_2}{\\sqrt{\\frac{s_1^{2}}{n_1} + \\frac{s_2^{2}}{n_2}}}.\n$$\n仅从以下基本事实和定义出发：\n- 如果 $X_1,\\dots,X_{n}$ 是来自均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态分布的独立同分布样本，那么样本均值 $\\bar{X}$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}/n$ 的正态分布。\n- 对于正态样本，无偏样本方差 $S^{2}$ 满足 $(n-1)\\,S^{2}/\\sigma^{2} \\sim \\chi^{2}_{n-1}$，且 $S^{2}$ 与 $\\bar{X}$ 独立。\n- 如果 $U \\sim \\chi^{2}_{k}$，那么 $E[U] = k$ 且 $\\operatorname{Var}(U) = 2k$。\n- 中心极限定理 (CLT) 保证了在有限方差条件下，和与平均值具有近似正态性。\n\n任务：\n1. 解释为什么在方差不相等的情况下，即使在正态性假设下，比率 $T$ 也不精确服从学生t分布（Student’s $t$ random variable），以及为什么需要一个近似。\n2. 使用矩匹配法将随机分母 $\\frac{s_1^{2}}{n_1} + \\frac{s_2^{2}}{n_2}$ 近似为一个缩放的卡方分布，推导出在方差不等情况下 $T$ 的抽样分布的 Satterthwaite 自由度 (df) 近似。\n3. 一项研究记录了以下数据：$n_1 = 42$，$s_1^{2} = 12.1$，$n_2 = 67$，$s_2^{2} = 18.7$。在上述假设下，计算 $T$ 的抽样分布的近似 Satterthwaite 自由度。\n\n将您的最终数值答案四舍五入至四位有效数字。最终答案中不要包含任何单位。", "solution": "这个问题是生物统计学中关于 Behrens-Fisher 问题的一个有效练习，该问题处理的是来自两个未知且可能不等的方差的正态总体的均值比较。这个问题设定良好，有科学依据，并为其解决提供了所有必要的信息。\n\n该问题要求完成三项任务：解释检验统计量 $T$ 的分布性质，推导 Satterthwaite 自由度近似，以及为给定数据集计算这些自由度的数值。\n\n**任务1：为什么 Welch t-统计量 $T$ 不精确服从学生t分布**\n\n一个随机变量若能写成比率 $t_k = \\frac{Z}{\\sqrt{U/k}}$ 的形式，则称其服从自由度为 $k$ 的学生t分布（记为 $t_k$），其中 $Z$ 是一个标准正态随机变量（$Z \\sim N(0,1)$），$U$ 是一个自由度为 $k$ 的卡方随机变量（$U \\sim \\chi_k^2$），且 $Z$ 和 $U$ 相互独立。\n\n我们来分析统计量 $T = \\frac{\\bar{X}_1 - \\bar{X}_2}{\\sqrt{\\frac{s_1^{2}}{n_1} + \\frac{s_2^{2}}{n_2}}}$。\n\n分子是 $\\bar{X}_1 - \\bar{X}_2$。根据提供的基本事实，由于样本是从正态总体中抽取的，所以 $\\bar{X}_1 \\sim N(\\mu_1, \\sigma_1^2/n_1)$ 且 $\\bar{X}_2 \\sim N(\\mu_2, \\sigma_2^2/n_2)$。由于两个队列是独立的，$\\bar{X}_1$ 和 $\\bar{X}_2$ 也是独立的。两个独立正态变量的差也服从正态分布。因此，差值的分布为 $\\bar{X}_1 - \\bar{X}_2 \\sim N(\\mu_1 - \\mu_2, \\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2})$。\n\n为了构建一个标准正态变量 $Z$，我们对这个差值进行标准化：\n$$\nZ = \\frac{(\\bar{X}_1 - \\bar{X}_2) - (\\mu_1 - \\mu_2)}{\\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}} \\sim N(0,1)\n$$\n在零假设 $H_0: \\mu_1=\\mu_2$ 下，统计量 $T$ 的分子是 $\\bar{X}_1 - \\bar{X}_2$。\n\n$T$ 的分母是量 $V = \\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}$ 的平方根。这个项 $V$ 是分子真实方差 $\\operatorname{Var}(\\bar{X}_1 - \\bar{X}_2) = \\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}$ 的一个估计量。对于正态样本，$\\bar{X}$ 和 $S^2$ 的独立性意味着分子 $\\bar{X}_1 - \\bar{X}_2$ 与分母项 $V$ 是独立的。\n\n现在，我们来考察 $V$ 的分布。从基本事实可知，对于每个样本 $i \\in \\{1, 2\\}$，量 $\\frac{(n_i-1)s_i^2}{\\sigma_i^2}$ 服从自由度为 $n_i-1$ 的卡方分布，即 $\\frac{(n_i-1)s_i^2}{\\sigma_i^2} \\sim \\chi_{n_i-1}^2$。这可以改写为 $s_i^2 \\sim \\frac{\\sigma_i^2}{n_i-1}\\chi_{n_i-1}^2$。\n\n因此，项 $V$ 是两个独立的、缩放的卡方变量的线性组合：\n$$\nV = \\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2} \\sim \\frac{\\sigma_1^2}{n_1(n_1-1)}\\chi_{n_1-1}^2 + \\frac{\\sigma_2^2}{n_2(n_2-1)}\\chi_{n_2-1}^2\n$$\n统计学中的一个基本定理指出，独立卡方变量的线性组合 $Y = \\sum a_i \\chi_{k_i}^2$ 仅在特定情况下（例如所有缩放系数 $a_i$ 都相等时）本身才是一个缩放的卡方变量。在我们的例子中，缩放系数是 $\\frac{\\sigma_1^2}{n_1(n_1-1)}$ 和 $\\frac{\\sigma_2^2}{n_2(n_2-1)}$。这些系数仅在总体方差和样本量满足非常严格的条件下才相等，这在一般情况下是不成立的，尤其是当 $\\sigma_1^2 \\neq \\sigma_2^2$ 时。\n\n由于随机变量 $V$ 通常不是一个单一的缩放卡方变量，所以比率 $T$ 并不精确服从学生t分布。它的精确分布很复杂，这使得使用近似方法成为必要，例如 Satterthwaite 对有效自由度的近似。\n\n**任务2：Satterthwaite 自由度的推导**\n\nSatterthwaite 近似旨在将 $V = \\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}$ 的分布近似为一个形式为 $c \\cdot \\chi_\\nu^2$ 的缩放卡方分布，其中 $\\nu$ 代表有效自由度。该近似是通过将 $V$ 的前两个矩（均值和方差）与 $c \\cdot \\chi_\\nu^2$ 的矩进行匹配来实现的。\n\n首先，我们求 $V$ 的均值和方差。\n$V$ 的期望是：\n$E[V] = E\\left[\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}\\right] = \\frac{1}{n_1}E[s_1^2] + \\frac{1}{n_2}E[s_2^2]$。\n由于 $s_i^2$ 是总体方差 $\\sigma_i^2$ 的无偏估计量，我们有 $E[s_i^2] = \\sigma_i^2$。\n因此，$E[V] = \\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}$。\n\n利用 $s_1^2$ 和 $s_2^2$ 的独立性，$V$ 的方差是：\n$\\operatorname{Var}(V) = \\operatorname{Var}\\left(\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}\\right) = \\frac{1}{n_1^2}\\operatorname{Var}(s_1^2) + \\frac{1}{n_2^2}\\operatorname{Var}(s_2^2)$。\n为了求 $\\operatorname{Var}(s_i^2)$，我们使用 $\\frac{(n_i-1)s_i^2}{\\sigma_i^2} \\sim \\chi_{n_i-1}^2$ 这一事实。\n这意味着 $s_i^2 = \\frac{\\sigma_i^2}{n_i-1}\\chi_{n_i-1}^2$。\n$\\operatorname{Var}(s_i^2) = \\operatorname{Var}\\left(\\frac{\\sigma_i^2}{n_i-1}\\chi_{n_i-1}^2\\right) = \\left(\\frac{\\sigma_i^2}{n_i-1}\\right)^2 \\operatorname{Var}(\\chi_{n_i-1}^2)$。\n使用给定的事实 $\\operatorname{Var}(\\chi_k^2) = 2k$，我们得到：\n$\\operatorname{Var}(s_i^2) = \\frac{\\sigma_i^4}{(n_i-1)^2} \\cdot 2(n_i-1) = \\frac{2\\sigma_i^4}{n_i-1}$。\n将此代入 $\\operatorname{Var}(V)$ 的表达式中：\n$\\operatorname{Var}(V) = \\frac{1}{n_1^2}\\left(\\frac{2\\sigma_1^4}{n_1-1}\\right) + \\frac{1}{n_2^2}\\left(\\frac{2\\sigma_2^4}{n_2-1}\\right)$。\n\n现在，考虑近似分布 $A = c \\cdot \\chi_\\nu^2$。它的矩是：\n$E[A] = c \\cdot E[\\chi_\\nu^2] = c\\nu$。\n$\\operatorname{Var}(A) = c^2 \\cdot \\operatorname{Var}(\\chi_\\nu^2) = c^2 (2\\nu) = 2c^2\\nu$。\n\n令 $V$ 和 $A$ 的矩相等：\n1. $E[V] = E[A] \\implies \\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2} = c\\nu$\n2. $\\operatorname{Var}(V) = \\operatorname{Var}(A) \\implies \\frac{2\\sigma_1^4}{n_1^2(n_1-1)} + \\frac{2\\sigma_2^4}{n_2^2(n_2-1)} = 2c^2\\nu$\n\n从方程（1），我们解出 $c$：$c = \\frac{1}{\\nu}\\left(\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}\\right)$。\n将此代入方程（2），并约去因子 2：\n$\\frac{\\sigma_1^4}{n_1^2(n_1-1)} + \\frac{\\sigma_2^4}{n_2^2(n_2-1)} = c^2\\nu = \\left[\\frac{1}{\\nu}\\left(\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}\\right)\\right]^2\\nu = \\frac{1}{\\nu}\\left(\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}\\right)^2$。\n\n现在，我们解出自由度 $\\nu$：\n$$\n\\nu = \\frac{\\left(\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}\\right)^2}{\\frac{\\sigma_1^4}{n_1^2(n_1-1)} + \\frac{\\sigma_2^4}{n_2^2(n_2-1)}}\n$$\n这可以写成一个更易于记忆的形式：\n$$\n\\nu = \\frac{\\left(\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}\\right)^2}{\\frac{\\left(\\frac{\\sigma_1^2}{n_1}\\right)^2}{n_1-1} + \\frac{\\left(\\frac{\\sigma_2^2}{n_2}\\right)^2}{n_2-1}}\n$$\n由于总体方差 $\\sigma_1^2$ 和 $\\sigma_2^2$ 是未知的，我们用它们的无偏样本估计量 $s_1^2$ 和 $s_2^2$ 来替代，从而得到估计的自由度，我们将其表示为 $df$：\n$$\ndf = \\frac{\\left(\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}\\right)^2}{\\frac{\\left(\\frac{s_1^2}{n_1}\\right)^2}{n_1-1} + \\frac{\\left(\\frac{s_2^2}{n_2}\\right)^2}{n_2-1}}\n$$\n这就是近似自由度的 Welch-Satterthwaite 方程。\n\n**任务3：自由度的数值计算**\n\n问题提供了以下数据：$n_1 = 42$，$s_1^2 = 12.1$，$n_2 = 67$ 和 $s_2^2 = 18.7$。我们将这些值代入推导出的 $df$ 公式中。\n\n首先，计算各个项 $\\frac{s_i^2}{n_i}$：\n$v_1 = \\frac{s_1^2}{n_1} = \\frac{12.1}{42} \\approx 0.288095$\n$v_2 = \\frac{s_2^2}{n_2} = \\frac{18.7}{67} \\approx 0.279104$\n\n现在，将这些值代入 Satterthwaite 公式：\n$$\ndf = \\frac{(v_1 + v_2)^2}{\\frac{v_1^2}{n_1-1} + \\frac{v_2^2}{n_2-1}} = \\frac{\\left(\\frac{12.1}{42} + \\frac{18.7}{67}\\right)^2}{\\frac{\\left(\\frac{12.1}{42}\\right)^2}{42-1} + \\frac{\\left(\\frac{18.7}{67}\\right)^2}{67-1}}\n$$\n$$\ndf = \\frac{\\left(0.288095238... + 0.279104477...\\right)^2}{\\frac{\\left(0.288095238...\\right)^2}{41} + \\frac{\\left(0.279104477...\\right)^2}{66}}\n$$\n$$\ndf = \\frac{\\left(0.567199715...\\right)^2}{\\frac{0.083000997...}{41} + \\frac{0.077900003...}{66}}\n$$\n$$\ndf = \\frac{0.321715115...}{0.002024414... + 0.001180303...}\n$$\n$$\ndf = \\frac{0.321715115...}{0.003204717...}\n$$\n$$\ndf \\approx 100.38797\n$$\n将结果四舍五入至四位有效数字，我们得到 $100.4$。", "answer": "$$\\boxed{100.4}$$", "id": "4951504"}, {"introduction": "许多生物统计估计量是样本统计量的非线性函数，例如均值的比率。这个练习将向你介绍一种功能强大的通用技术——Delta方法，用于近似复杂估计量的抽样分布和方差。通过推导两个独立样本均值之比的渐近方差，你将学会如何处理这类更复杂的统计推断问题。[@problem_id:4951505]", "problem": "一项生物统计学研究比较了两个独立的队列，以估计群体平均生物标志物水平的比率。设 $\\{X_{i}\\}_{i=1}^{n_{X}}$ 是来自一个均值为 $\\mu_{X}$、方差为 $\\sigma_{X}^{2}$ 的总体的独立同分布实值观测值，并设 $\\{Y_{j}\\}_{j=1}^{n_{Y}}$ 是来自第二个独立的、均值为 $\\mu_{Y} \\neq 0$、方差为 $\\sigma_{Y}^{2}$ 的总体的独立同分布实值观测值。假设所有四阶矩都是有限的。定义样本均值 $\\bar{X} = \\frac{1}{n_{X}} \\sum_{i=1}^{n_{X}} X_{i}$ 和 $\\bar{Y} = \\frac{1}{n_{Y}} \\sum_{j=1}^{n_{Y}} Y_{j}$，并考虑总体均值之比的估计量 $R = \\bar{X}/\\bar{Y}$，其目标参数为 $\\mu_{X}/\\mu_{Y}$。\n\n仅使用样本均值的中心极限定理 (CLT) 和函数 $g(x,y) = x/y$ 的一阶可微性，在独立性和有限方差的假设下，推导 $R$ 的一阶渐近分布。然后，用 $\\mu_{X}$、$\\mu_{Y}$、$\\sigma_{X}^{2}$、$\\sigma_{Y}^{2}$、$n_{X}$ 和 $n_{Y}$ 显式地计算 $R$ 的渐近方差的闭合形式表达式。请仅提供 $R$ 的渐近方差的单一简化解析表达式作为最终答案。不需要进行数值计算。", "solution": "该问题是有效的，因为它代表了统计学中渐近理论的一个标准应用，特别是多元 Delta 方法，应用于生物统计学中一个定义明确且有科学依据的问题。所有必要的信息和条件都已提供，可以推导出唯一的解。\n\n目标是求出参数 $\\mu_X/\\mu_Y$ 的估计量 $R = \\bar{X}/\\bar{Y}$ 的渐近方差。推导过程依赖于中心极限定理 (CLT) 和对随机变量函数的一阶泰勒展开，这种技术通常被称为 Delta 方法。\n\n首先，我们确定样本均值的渐近分布。根据中心极限定理，对于一个来自总体均值为 $\\mu_X$、有限方差为 $\\sigma_X^2$ 的独立同分布 (i.i.d.) 随机变量样本 $\\{X_i\\}_{i=1}^{n_X}$，样本均值 $\\bar{X}$ 是渐近正态分布的。具体来说，当 $n_X \\to \\infty$ 时：\n$$ \\sqrt{n_X}(\\bar{X} - \\mu_X) \\xrightarrow{d} N(0, \\sigma_X^2) $$\n其中 $\\xrightarrow{d}$ 表示依分布收敛。这意味着对于大的 $n_X$，$\\bar{X}$ 近似服从均值为 $\\mu_X$、方差为 $\\frac{\\sigma_X^2}{n_X}$ 的正态分布。\n同样，对于来自总体均值为 $\\mu_Y$、方差为 $\\sigma_Y^2$ 的独立样本 $\\{Y_j\\}_{j=1}^{n_Y}$，当 $n_Y \\to \\infty$ 时：\n$$ \\sqrt{n_Y}(\\bar{Y} - \\mu_Y) \\xrightarrow{d} N(0, \\sigma_Y^2) $$\n这意味着对于大的 $n_Y$，$\\bar{Y}$ 近似服从均值为 $\\mu_Y$、方差为 $\\frac{\\sigma_Y^2}{n_Y}$ 的正态分布。\n\n由于两个样本 $\\{X_i\\}$ 和 $\\{Y_j\\}$ 是独立的，它们各自的样本均值 $\\bar{X}$ 和 $\\bar{Y}$ 也是独立的随机变量。\n我们可以将这两个样本均值组合成一个向量统计量 $T = \\begin{pmatrix} \\bar{X} \\\\ \\bar{Y} \\end{pmatrix}$。对应的参数向量是 $\\theta = \\begin{pmatrix} \\mu_X \\\\ \\mu_Y \\end{pmatrix}$。\n向量 $T$ 的渐近分布是一个二元正态分布。均值向量是 $E[T] = \\begin{pmatrix} E[\\bar{X}] \\\\ E[\\bar{Y}] \\end{pmatrix} = \\begin{pmatrix} \\mu_X \\\\ \\mu_Y \\end{pmatrix} = \\theta$。\n$T$ 的协方差矩阵，记为 $\\Sigma_T$，是：\n$$ \\Sigma_T = \\text{Cov}(T) = \\begin{pmatrix} \\text{Var}(\\bar{X})  \\text{Cov}(\\bar{X}, \\bar{Y}) \\\\ \\text{Cov}(\\bar{X}, \\bar{Y})  \\text{Var}(\\bar{Y}) \\end{pmatrix} $$\n根据中心极限定理，$\\text{Var}(\\bar{X}) = \\frac{\\sigma_X^2}{n_X}$ 且 $\\text{Var}(\\bar{Y}) = \\frac{\\sigma_Y^2}{n_Y}$。由于两个样本的独立性，$\\text{Cov}(\\bar{X}, \\bar{Y}) = 0$。\n因此，渐近协方差矩阵是：\n$$ \\Sigma_T = \\begin{pmatrix} \\frac{\\sigma_X^2}{n_X}  0 \\\\ 0  \\frac{\\sigma_Y^2}{n_Y} \\end{pmatrix} $$\n所以，对于大的 $n_X$ 和 $n_Y$，向量 $T = \\begin{pmatrix} \\bar{X} \\\\ \\bar{Y} \\end{pmatrix}$ 近似服从一个二元正态分布：\n$$ \\begin{pmatrix} \\bar{X} \\\\ \\bar{Y} \\end{pmatrix} \\stackrel{a}{\\sim} N\\left( \\begin{pmatrix} \\mu_X \\\\ \\mu_Y \\end{pmatrix}, \\begin{pmatrix} \\frac{\\sigma_X^2}{n_X}  0 \\\\ 0  \\frac{\\sigma_Y^2}{n_Y} \\end{pmatrix} \\right) $$\n\n我们感兴趣的估计量是 $R = \\bar{X}/\\bar{Y}$，它是 $\\bar{X}$ 和 $\\bar{Y}$ 的函数。设此函数为 $g(x,y) = x/y$。我们的估计量是 $R = g(\\bar{X}, \\bar{Y})$。我们使用多元 Delta 方法来求其渐近分布。\nDelta 方法指出，对于一个具有连续一阶偏导数的函数 $g$，$g(T)$ 的渐近分布是正态分布，其均值为 $g(\\theta)$，方差由 $D_g(\\theta) \\Sigma_T (D_g(\\theta))^T$ 给出，其中 $D_g(\\theta)$ 是 $g$ 在 $\\theta$ 处求值的梯度。\n\n函数是 $g(x,y) = x/y$。我们计算它的梯度，即其偏导数的行向量：\n$$ D_g(x,y) = \\begin{pmatrix} \\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{y}  -\\frac{x}{y^2} \\end{pmatrix} $$\n我们在均值向量 $\\theta = (\\mu_X, \\mu_Y)$ 处评估此梯度。问题中说明了 $\\mu_Y \\neq 0$，因此导数在这一点上是良定义的。\n$$ D_g(\\mu_X, \\mu_Y) = \\begin{pmatrix} \\frac{1}{\\mu_Y}  -\\frac{\\mu_X}{\\mu_Y^2} \\end{pmatrix} $$\n$R$ 的渐近方差，记为 $\\text{AsyVar}(R)$，由以下公式给出：\n$$ \\text{AsyVar}(R) = D_g(\\mu_X, \\mu_Y) \\Sigma_T (D_g(\\mu_X, \\mu_Y))^T $$\n代入梯度和协方差矩阵的表达式：\n$$ \\text{AsyVar}(R) = \\begin{pmatrix} \\frac{1}{\\mu_Y}  -\\frac{\\mu_X}{\\mu_Y^2} \\end{pmatrix} \\begin{pmatrix} \\frac{\\sigma_X^2}{n_X}  0 \\\\ 0  \\frac{\\sigma_Y^2}{n_Y} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\mu_Y} \\\\ -\\frac{\\mu_X}{\\mu_Y^2} \\end{pmatrix} $$\n我们进行矩阵乘法。首先，将行向量（梯度）乘以协方差矩阵：\n$$ \\begin{pmatrix} \\frac{1}{\\mu_Y}  -\\frac{\\mu_X}{\\mu_Y^2} \\end{pmatrix} \\begin{pmatrix} \\frac{\\sigma_X^2}{n_X}  0 \\\\ 0  \\frac{\\sigma_Y^2}{n_Y} \\end{pmatrix} = \\begin{pmatrix} \\left(\\frac{1}{\\mu_Y}\\right)\\left(\\frac{\\sigma_X^2}{n_X}\\right) + (0)  (0) + \\left(-\\frac{\\mu_X}{\\mu_Y^2}\\right)\\left(\\frac{\\sigma_Y^2}{n_Y}\\right) \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sigma_X^2}{n_X \\mu_Y}  -\\frac{\\mu_X \\sigma_Y^2}{n_Y \\mu_Y^2} \\end{pmatrix} $$\n接下来，将得到的行向量乘以转置的（列）梯度向量：\n$$ \\text{AsyVar}(R) = \\begin{pmatrix} \\frac{\\sigma_X^2}{n_X \\mu_Y}  -\\frac{\\mu_X \\sigma_Y^2}{n_Y \\mu_Y^2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\mu_Y} \\\\ -\\frac{\\mu_X}{\\mu_Y^2} \\end{pmatrix} $$\n$$ \\text{AsyVar}(R) = \\left(\\frac{\\sigma_X^2}{n_X \\mu_Y}\\right)\\left(\\frac{1}{\\mu_Y}\\right) + \\left(-\\frac{\\mu_X \\sigma_Y^2}{n_Y \\mu_Y^2}\\right)\\left(-\\frac{\\mu_X}{\\mu_Y^2}\\right) $$\n$$ \\text{AsyVar}(R) = \\frac{\\sigma_X^2}{n_X \\mu_Y^2} + \\frac{\\mu_X^2 \\sigma_Y^2}{n_Y \\mu_Y^4} $$\n这个表达式代表了 $R$ 的渐近方差。\n因此，完整的渐近分布为：\n$$ R \\stackrel{a}{\\sim} N\\left( \\frac{\\mu_X}{\\mu_Y}, \\frac{\\sigma_X^2}{n_X \\mu_Y^2} + \\frac{\\mu_X^2 \\sigma_Y^2}{n_Y \\mu_Y^4} \\right) $$\n为了提供单一简化的解析表达式作为最终答案，我们可以通过找到公分母 $n_X n_Y \\mu_Y^4$ 来合并方差表达式中的各项：\n$$ \\text{AsyVar}(R) = \\frac{\\sigma_X^2 (n_Y \\mu_Y^2)}{n_X \\mu_Y^2 (n_Y \\mu_Y^2)} + \\frac{\\mu_X^2 \\sigma_Y^2 (n_X)}{n_Y \\mu_Y^4 (n_X)} = \\frac{n_Y \\sigma_X^2 \\mu_Y^2}{n_X n_Y \\mu_Y^4} + \\frac{n_X \\mu_X^2 \\sigma_Y^2}{n_X n_Y \\mu_Y^4} $$\n$$ \\text{AsyVar}(R) = \\frac{n_Y \\sigma_X^2 \\mu_Y^2 + n_X \\mu_X^2 \\sigma_Y^2}{n_X n_Y \\mu_Y^4} $$\n这就是用给定的总体和样本量参数表示的 $R$ 的渐近方差的闭合形式表达式。", "answer": "$$\n\\boxed{\\frac{n_Y \\sigma_X^2 \\mu_Y^2 + n_X \\mu_X^2 \\sigma_Y^2}{n_X n_Y \\mu_Y^4}}\n$$", "id": "4951505"}]}