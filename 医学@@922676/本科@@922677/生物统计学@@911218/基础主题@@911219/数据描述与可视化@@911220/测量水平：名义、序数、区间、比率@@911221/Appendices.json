{"hands_on_practices": [{"introduction": "理解测量尺度定义的最佳方式，是检验哪些数学变换能保持其结构不变。本练习将使用我们熟悉的摄氏度与华氏度之间的转换——一个经典的仿射变换例子——来探讨哪些统计特性得以保留。通过解决这个问题，你将对区间尺度（Interval Scale）与定序尺度（Ordinal Scale）或定比尺度（Ratio Scale）的区别有更实际的理解，并巩固仿射变换在统计分析中的核心作用。[@problem_id:4922421]", "problem": "在一项临床监测研究中，记录了 $n = 8$ 名患者的口腔温度测量值（单位为摄氏度），记为向量 $C = (c_{1}, \\dots, c_{8})$，观测值分别为 $36.6$、$37.0$、$37.8$、$38.1$、$36.9$、$39.0$、$38.4$ 和 $37.3$。为了向一个使用华氏度的合作实验室报告结果，该团队使用精确的仿射变换 $$F = \\frac{9}{5}C + 32,$$ 对每个测量值进行转换，其中乘法和加法对 $C$ 的每个分量进行运算。\n\n使用四种测量尺度——名义、顺序、区间和比率——的核心定义，结合形式为 $$Y = aX + b$$ 的仿射变换的数学性质，判断从 $C$ 转换到 $F$ 时，哪些类别的统计陈述被保留，哪些不被保留。你的推理必须从这些尺度类型的形式化定义和变换结构出发，而不是依赖捷径。\n\n然后，使用上述指定的精确转换，计算摄氏度向量 $C$ 和其华氏度变换 $F$ 之间的皮尔逊积矩相关系数 $r$。将最终数值答案四舍五入至四位有效数字。最终答案不需要单位。", "solution": "该问题提出了两个不同的任务：首先，基于测量尺度的定义，分析在温度尺度之间的仿射变换下统计陈述的不变性；其次，计算原始数据向量和变换后数据向量之间的皮尔逊积矩相关系数。\n\n### 第一部分：测量尺度不变性分析\n\n此分析的基础在于四种测量尺度（名义、顺序、区间、比率）的形式化定义，以及保持每种尺度结构不变的变换类别。从摄氏度 ($C$) 到华氏度 ($F$) 的变换由正仿射变换 $F = aC + b$ 给出，其中 $a = \\frac{9}{5}  0$ 且 $b = 32$。\n\n1.  **名义尺度：** 名义尺度对数据进行分类，没有任何内在顺序。唯一允许的形式关系是相等 ($=$) 或不相等 ($\\neq$)。如果变换是一一对应的，则陈述被保留。对于任意两个测量值 $c_i$ 和 $c_j$，如果 $c_i = c_j$，则 $f_i = \\frac{9}{5}c_i + 32 = \\frac{9}{5}c_j + 32 = f_j$。反之，如果 $f_i = f_j$，则 $\\frac{9}{5}c_i + 32 = \\frac{9}{5}c_j + 32$，这意味着 $\\frac{9}{5}c_i = \\frac{9}{5}c_j$，因此 $c_i = c_j$。该变换是双射。因此，关于同一性和差异性的陈述（例如，“患者A的体温与患者B的体温相同”）被保留。\n\n2.  **顺序尺度：** 顺序尺度具有名义尺度的属性，但增加了有意义的顺序关系 ($$, $$)。如果变换是严格单调的，则陈述被保留。设 $c_i  c_j$。由于系数 $a = \\frac{9}{5}$ 是正数，用 $a$ 乘以不等式会保持其方向：$\\frac{9}{5}c_i  \\frac{9}{5}c_j$。在两边加上常数 $b=32$ 也会保持不等式：$\\frac{9}{5}c_i + 32  \\frac{9}{5}c_j + 32$，即 $f_i  f_j$。该变换是严格单调递增的。因此，所有关于顺序的陈述（例如，“患者A比患者B体温高”）都被保留。\n\n3.  **区间尺度：** 区间尺度具有顺序尺度的属性，此外，数值之间的差异是有意义且可比较的。区间尺度的一个标志是在正仿射变换 ($Y = aX+b$, $a0$) 下，区间比率的不变性。让我们检验摄氏度中两个区间的比率 $\\frac{c_j - c_i}{c_l - c_k}$。华氏度中对应的值为 $f_i = ac_i+b$、$f_j = ac_j+b$、$f_k = ac_k+b$ 和 $f_l = ac_l+b$。新的区间比率为：\n$$ \\frac{f_j - f_i}{f_l - f_k} = \\frac{(ac_j + b) - (ac_i + b)}{(ac_l + b) - (ac_k + b)} = \\frac{a(c_j - c_i)}{a(c_l - c_k)} = \\frac{c_j - c_i}{c_l - c_k} $$\n由于区间比率保持不变，所有依赖此属性的统计陈述都被保留。这包括关于差异相等（例如，“患者A到患者B的温度升高量与患者C到患者D的相同”）和差异相对大小的陈述。摄氏温标本身是一个区间尺度，因为它的零点是任意的（水的冰点，而不是热能的绝对缺失）。向华氏度的转换（这是另一个区间尺度）正是保留区间属性的那种类型。\n\n4.  **比率尺度：** 比率尺度具有区间尺度的所有属性，外加一个真实的、非任意的零点。这个绝对零点使得数值的比率有意义。保持比率尺度不变的变换类别是正比例变换 ($Y = aX$, $a0$)。给定的变换 $F = \\frac{9}{5}C + 32$ 包含一个加法常数 $b=32 \\neq 0$。让我们检验两个值的比率 $\\frac{c_j}{c_i}$。华氏度中对应的比率为：\n$$ \\frac{f_j}{f_i} = \\frac{\\frac{9}{5}c_j + 32}{\\frac{9}{5}c_i + 32} $$\n一般来说，$\\frac{\\frac{9}{5}c_j + 32}{\\frac{9}{5}c_i + 32} \\neq \\frac{c_j}{c_i}$。例如，从热力学意义上讲，$20^\\circ C$ 的温度不是 $10^\\circ C$ 的“两倍热”。这个陈述在转换后不被保留：$f(20) = 68^\\circ F$ 和 $f(10)=50^\\circ F$，并且 $\\frac{68}{50} = 1.36 \\neq 2$。加法常数 $b$ 的存在破坏了数值比率的不变性。因此，依赖于真实零点和有意义的数值比率的统计陈述不被保留。\n\n总之，对于名义、顺序和区间尺度有效的陈述，在摄氏度到华氏度的转换下被保留。需要比率尺度的陈述则不被保留。\n\n### 第二部分：皮尔逊相关系数的计算\n\n两个变量（此处记为 $C$ 和 $F$）之间的皮尔逊积矩相关系数 $r$ 定义为：\n$$ r_{CF} = \\frac{\\text{cov}(C, F)}{\\sigma_C \\sigma_F} $$\n其中 $\\text{cov}(C, F)$ 是 $C$ 和 $F$ 的协方差，$\\sigma_C$ 和 $\\sigma_F$ 是它们各自的标准差。\n\n问题指明了 $F$ 和 $C$ 之间存在一个完美的线性关系：$F = aC + b$，其中 $a = \\frac{9}{5}$ 且 $b = 32$。我们可以利用协方差和方差在线性变换下的性质来确定相关系数，而无需对提供的具体数据点进行计算。\n\n设 $c_i$ 表示摄氏度的单个测量值，$f_i = ac_i + b$ 是华氏度中对应的测量值。\n协方差由 $\\text{cov}(C, F) = E[(C - E[C])(F - E[F])]$ 给出。\n我们知道 $E[F] = E[aC+b] = aE[C] + b$。\n将此代入协方差公式：\n$$ \\text{cov}(C, F) = E[(C - E[C])((aC + b) - (aE[C] + b))] $$\n$$ \\text{cov}(C, F) = E[(C - E[C])(a(C - E[C]))] $$\n$$ \\text{cov}(C, F) = a E[(C - E[C])^2] = a \\cdot \\text{var}(C) = a \\sigma_C^2 $$\n$F$ 的方差是：\n$$ \\text{var}(F) = \\text{var}(aC + b) = a^2 \\text{var}(C) = a^2 \\sigma_C^2 $$\n因此，$F$ 的标准差是：\n$$ \\sigma_F = \\sqrt{a^2 \\sigma_C^2} = |a| \\sqrt{\\sigma_C^2} = |a| \\sigma_C $$\n现在，我们将 $\\text{cov}(C, F)$ 和 $\\sigma_F$ 的这些表达式代回到 $r_{CF}$ 的公式中：\n$$ r_{CF} = \\frac{a \\sigma_C^2}{\\sigma_C (|a| \\sigma_C)} = \\frac{a \\sigma_C^2}{|a| \\sigma_C^2} = \\frac{a}{|a|} $$\n这个一般性结果表明，一个变量与其仿射变换之间的相关系数仅取决于缩放系数 $a$ 的符号。\n对于给定的变换，$a = \\frac{9}{5}$，这是一个正值。\n$$ r_{CF} = \\frac{\\frac{9}{5}}{|\\frac{9}{5}|} = \\frac{\\frac{9}{5}}{\\frac{9}{5}} = 1 $$\n相关系数恰好为 $1$，表示一个完美的正线性关系。数据点 $(c_i, f_i)$ 完全位于一条具有正斜率的直线上。推导这个结果并不需要温度的具体数值。\n\n问题要求将数值答案四舍五入到四位有效数字。精确值 $1$ 表示为四位有效数字是 $1.000$。", "answer": "$$\n\\boxed{1.000}\n$$", "id": "4922421"}, {"introduction": "数据分析中一个常见的错误是，将有序的类别（如疼痛评分或调查问卷响应）当作它们之间的数值距离具有实际意义来处理。本练习将展示一个引人注目的场景：这样做会导致关于治疗效果的结论完全自相矛盾。通过揭示这个悖论，你将明白为何对定序数据比较均值是不恰当的，并学习一种更稳健且在尺度变换下保持不变的分析方法。[@problem_id:4922405]", "problem": "一个生物统计学团队使用一种治疗后疼痛评分来评估一种镇痛剂，该评分是在一个从 $0$ 到 $10$ 的离散标度上记录的。临床专家确认该疼痛标度是序数标度：唯一有意义的信息是分数的排序，任何对分数的严格递增变换都会保留其测量内容。考虑两个随机分组，其观测到的疼痛评分如下：\n对照组 $C$：$[3,4,5,6,7]$，\n治疗组 $T$：$[0,1,2,3,10]$。\n针对这些相同的数据，提出了两种分析方法：\n分析 A 计算原始标度上的样本均值之差 $\\bar{x}_{T}-\\bar{x}_{C}$。\n分析 B 对每个分数应用严格递增变换 $f(s)=s^{3}$，然后计算均值之差 $\\overline{f(s)}_{T}-\\overline{f(s)}_{C}$。\n执行这两种分析，并判断它们是否就镇痛剂是否减轻疼痛得出相互矛盾的结论。仅使用测量水平及其容许变换的基本定义，通过检查在严格递增变换下的不变性来确定哪个结论是有意义的。最后，为了以一种适用于序数标度的方式总结治疗效果，计算优越概率 $\\theta=\\Pr(S_{T}  S_{C}) + \\frac{1}{2}\\Pr(S_{T}=S_{C})$。", "solution": "此问题旨在揭示为何对序数数据计算均值是危险的，以及如何使用一个在序数变换下保持不变的稳健统计量来得出有意义的结论。\n\n### 分析A和B：矛盾的结论\n\n首先，我们执行问题中描述的两种分析。\n\n**分析 A：基于原始分数的均值比较**\n\n*   对照组分数 $C$：$[3, 4, 5, 6, 7]$\n*   治疗组分数 $T$：$[0, 1, 2, 3, 10]$\n\n计算两组的样本均值：\n$$ \\bar{x}_{C} = \\frac{3+4+5+6+7}{5} = \\frac{25}{5} = 5.0 $$\n$$ \\bar{x}_{T} = \\frac{0+1+2+3+10}{5} = \\frac{16}{5} = 3.2 $$\n\n均值之差为 $\\bar{x}_{T} - \\bar{x}_{C} = 3.2 - 5.0 = -1.8$。\n由于治疗组的平均疼痛评分较低，该分析表明治疗是有效的。\n\n**分析 B：基于变换后分数的均值比较**\n\n所应用的变换是 $f(s) = s^3$，这是一个严格递增函数，因此对于序数标度是容许的。\n\n*   变换后的对照组分数 $f(C)$：$[3^3, 4^3, 5^3, 6^3, 7^3] = [27, 64, 125, 216, 343]$\n*   变换后的治疗组分数 $f(T)$：$[0^3, 1^3, 2^3, 3^3, 10^3] = [0, 1, 8, 27, 1000]$\n\n计算变换后分数的样本均值：\n$$ \\overline{f(s)}_{C} = \\frac{27+64+125+216+343}{5} = \\frac{775}{5} = 155 $$\n$$ \\overline{f(s)}_{T} = \\frac{0+1+8+27+1000}{5} = \\frac{1036}{5} = 207.2 $$\n\n均值之差为 $\\overline{f(s)}_{T} - \\overline{f(s)}_{C} = 207.2 - 155 = 52.2$。\n现在，治疗组的平均“变换后疼痛评分”更高，该分析表明治疗是有害的。\n\n**结论的矛盾性**：分析A和分析B得出了完全相反的结论。由于疼痛标度是序数的，其科学结论不应依赖于我们选择的任何一个特定的、但保持顺序的数值编码方案。均值比较的结果依赖于所选的编码，因此根据“有意义性”原则，这种比较是无意义的。\n\n### 优越概率的计算\n\n优越概率 $\\theta = \\Pr(S_{T}  S_{C}) + \\frac{1}{2}\\Pr(S_{T}=S_{C})$ 是一个适用于序数数据的稳健统计量。它量化了从治疗组中随机抽取一个观测值小于从对照组中随机抽取一个观测值的概率（考虑平局情况）。它仅依赖于排序，因此在任何严格递增变换下其值保持不变，是一个有意义的统计量。\n\n我们有 $n_C = 5$ 个对照组观测值和 $n_T = 5$ 个治疗组观测值，总共有 $n_C \\times n_T = 25$ 对可能的配对。我们逐对比较：\n\n*   对于 $s_T = 0$：小于所有5个 $s_C$ 值 ($3,4,5,6,7$)。\n*   对于 $s_T = 1$：小于所有5个 $s_C$ 值。\n*   对于 $s_T = 2$：小于所有5个 $s_C$ 值。\n*   对于 $s_T = 3$：小于4个 $s_C$ 值 ($4,5,6,7$)，等于1个 $s_C$ 值 ($3$)。\n*   对于 $s_T = 10$：不小于任何 $s_C$ 值。\n\n总计：\n*   $S_T  S_C$ 的配对数量 = $5 + 5 + 5 + 4 + 0 = 19$。\n*   $S_T = S_C$ 的配对数量 = $1$。\n*   $S_T > S_C$ 的配对数量 = $25 - 19 - 1 = 5$。\n\n现在我们计算概率：\n$$ \\Pr(S_{T}  S_{C}) = \\frac{19}{25} = 0.76 $$\n$$ \\Pr(S_{T} = S_{C}) = \\frac{1}{25} = 0.04 $$\n\n最后，计算优越概率 $\\theta$：\n$$ \\theta = 0.76 + \\frac{1}{2}(0.04) = 0.76 + 0.02 = 0.78 $$\n\n这个值远大于0.5，表明治疗组的疼痛评分有很强的倾向低于对照组，即治疗是有效的。这个结论在任何严格递增变换下都是稳健的。\n\n为了将最终答案格式化为四位有效数字，我们将 $0.78$ 写为 $0.7800$。", "answer": "$$\n\\boxed{0.7800}\n$$", "id": "4922405"}, {"introduction": "前一个练习表明，错误地将定序尺度当作区间尺度处理会导致有缺陷的结论。本练习则更进一步，要求你量化这种错误所引入的误差，即“偏倚”（bias）。通过对一个真实的临床场景进行建模，你将计算当一个真实间距不等的定序预测变量被错误地假定为“等间距”时，回归模型的效果估计会被扭曲多少，从而为这种分析错误提供一个具体的度量。[@problem_id:4922401]", "problem": "一个临床数据集记录了一个四水平的有序暴露变量——吸烟强度，由受过培训的护士将其分为“不吸烟”、“轻度吸烟”、“中度吸烟”和“重度吸烟”。设有序类别得分为 $S \\in \\{0,1,2,3\\}$，分别对应“不吸烟”、“轻度吸烟”、“中度吸烟”和“重度吸烟”。假设在现实中，每个类别对应于每日吸烟的典型数量，记为 $c$，其中“不吸烟”的 $c=0$，“轻度吸烟”的 $c=5$，“中度吸烟”的 $c=12$，“重度吸烟”的 $c=30$。二元结局 $Y \\in \\{0,1\\}$ 是C-反应蛋白（CRP）升高，并且数据是在大型、均衡的分层中收集的，每个吸烟类别中的个体数量相等。\n\n假设结局的真实数据生成机制是一个逻辑斯谛回归，其线性预测器是基于潜在的连续暴露量 $c$ 的线性函数，\n$$\n\\operatorname{logit}\\big(P(Y=1 \\mid c)\\big) \\;=\\; \\alpha + \\gamma\\,c,\n$$\n其中 $\\alpha$ 是截距，$\\gamma$ 是每支香烟的对数优势增量。假设 $\\gamma = 0.02$。\n\n一位分析师将有序量表 $S$ 错误地当作等间距的区间量表，转而拟合了具有以下线性预测器的逻辑斯谛模型：\n$$\n\\operatorname{logit}\\big(P(Y=1 \\mid S)\\big) \\;=\\; \\alpha' + \\beta\\,S,\n$$\n使用等间距得分 $S=0,1,2,3$。\n\n将感兴趣的目标效应定义为真实模型下重度吸烟与不吸烟的对数优势差异，即 $\\gamma\\,(c_{\\text{heavy}}-c_{\\text{none}})$，并将分析师的错误分类效应估计定义为 $\\beta\\,(S_{\\text{heavy}}-S_{\\text{none}})$。利用在各类别权重相等的情况下，真实线性预测器 $\\alpha + \\gamma c$ 对 $\\alpha' + \\beta S$ 的最佳线性近似是通过最小二乘投影得到的这一事实，计算偏差\n$$\n\\text{Bias} \\;=\\; \\beta\\,(S_{\\text{heavy}}-S_{\\text{none}}) \\;-\\; \\gamma\\,(c_{\\text{heavy}}-c_{\\text{none}}),\n$$\n对于给定的 $c$ 值和 $\\gamma$。将您的答案四舍五入到四位有效数字。将最终值表示为一个纯数（对数优势单位是无量纲的）。", "solution": "该问题要求我们量化当一个具有不等间距的有序预测变量被错误地当作等间距区间变量处理时，对回归模型效应估计所引入的偏差。\n\n真实的数据生成模型依赖于连续变量 $c$，其线性预测器为 $\\eta(c) = \\alpha + \\gamma c$。分析师使用的错误模型依赖于有序得分 $S$，其线性预测器为 $\\eta'(S) = \\alpha' + \\beta S$。根据题意，$\\alpha'$ 和 $\\beta$ 是通过将真实预测值 $\\eta(c)$ 对有序得分 $S$ 进行普通最小二乘回归得到的（因为各类别权重相等）。\n\n我们需要找到回归的斜率系数 $\\beta$。斜率 $\\beta$ 的公式为：\n$$ \\beta = \\frac{\\text{Cov}(S, \\eta)}{\\text{Var}(S)} $$\n由于 $\\eta(c) = \\alpha + \\gamma c$，协方差为 $\\text{Cov}(S, \\alpha + \\gamma c) = \\gamma \\text{Cov}(S, c)$。因此，\n$$ \\beta = \\gamma \\frac{\\text{Cov}(S, c)}{\\text{Var}(S)} $$\n这等价于对 $c$ 关于 $S$ 进行回归的斜率乘以 $\\gamma$。我们来计算该斜率。\n\n我们有四对数据点 $(S, c)$：$(0, 0)$, $(1, 5)$, $(2, 12)$, $(3, 30)$。\n\n1.  计算 $S$ 和 $c$ 的均值：\n    $$ \\bar{S} = \\frac{0 + 1 + 2 + 3}{4} = 1.5 $$\n    $$ \\bar{c} = \\frac{0 + 5 + 12 + 30}{4} = \\frac{47}{4} = 11.75 $$\n\n2.  计算 $S$ 的方差（的分母部分，即平方和）：\n    $$ \\sum_{i=1}^{4} (S_i - \\bar{S})^2 = (0 - 1.5)^2 + (1 - 1.5)^2 + (2 - 1.5)^2 + (3 - 1.5)^2 $$\n    $$ = 2.25 + 0.25 + 0.25 + 2.25 = 5 $$\n\n3.  计算 $S$ 和 $c$ 的协方差（的分子部分，即偏差乘积和）：\n    $$ \\sum_{i=1}^{4} (S_i - \\bar{S})(c_i - \\bar{c}) = (0-1.5)(0-11.75) + (1-1.5)(5-11.75) + (2-1.5)(12-11.75) + (3-1.5)(30-11.75) $$\n    $$ = (-1.5)(-11.75) + (-0.5)(-6.75) + (0.5)(0.25) + (1.5)(18.25) $$\n    $$ = 17.625 + 3.375 + 0.125 + 27.375 = 48.5 $$\n\n4.  计算 $\\beta$：\n    $$ \\beta = \\gamma \\frac{\\sum (S_i - \\bar{S})(c_i - \\bar{c})}{\\sum (S_i - \\bar{S})^2} = \\gamma \\frac{48.5}{5} = 9.7\\gamma $$\n\n现在，我们计算真实效应和估计效应。\n*   **真实效应** (重度吸烟 vs. 不吸烟):\n    $$ E_{\\text{true}} = \\gamma(c_{\\text{heavy}} - c_{\\text{none}}) = \\gamma(30 - 0) = 30\\gamma $$\n*   **估计效应** (基于错误模型的重度吸烟 vs. 不吸烟):\n    $$ E_{\\text{analyst}} = \\beta(S_{\\text{heavy}} - S_{\\text{none}}) = \\beta(3 - 0) = 3\\beta $$\n\n将 $\\beta = 9.7\\gamma$ 代入估计效应的表达式：\n$$ E_{\\text{analyst}} = 3(9.7\\gamma) = 29.1\\gamma $$\n\n偏差（Bias）定义为估计效应与真实效应之差：\n$$ \\text{Bias} = E_{\\text{analyst}} - E_{\\text{true}} = 29.1\\gamma - 30\\gamma = -0.9\\gamma $$\n\n给定 $\\gamma = 0.02$，我们可以计算偏差的数值：\n$$ \\text{Bias} = -0.9 \\times 0.02 = -0.018 $$\n\n问题要求答案四舍五入到四位有效数字，因此结果为 $-0.01800$。这个负偏差表明，分析师的错误模型低估了重度吸烟相对于不吸烟的真实风险增加幅度。", "answer": "$$\\boxed{-0.01800}$$", "id": "4922401"}]}