{"hands_on_practices": [{"introduction": "重测信度研究是评估测量可靠性的一种直观方法。通过在短时间内对同一受试者进行两次测量，我们可以将真正的生物学差异与测量过程中的随机噪声区分开来。本练习将展示这两次测量之间的相关性如何直接用于估算测量误差的方差，为我们提供一个量化不确定性的实用工具 [@problem_id:4956402]。", "problem": "一项生物统计学研究考虑了在普通成年人群中测量的连续生物标志物的经典测量误差模型。设个体水平的真实生物标志物表示为 $X$，并假设根据 $W = X + U$ 观察到单次临床读数 $W$，其中 $U$ 是一个随机测量误差，满足 $E(U) = 0$，$\\operatorname{Var}(U) = \\sigma_{U}^{2}$，且 $U$ 与 $X$ 无关。在一项重测子研究中，在短时间内对同一个体在相同条件下进行第二次读数 $W'$，以确保真实值保持不变。第二次读数遵循 $W' = X + U'$，其中 $U'$ 是 $U$ 的一个独立副本，并且与 $X$ 和 $U$ 无关。\n\n从重测子研究中，从一个大样本中估计出总体重测相关性 $\\rho_{WW'}$ 为 $0.75$。从一项独立的大规模人群健康调查中，估计出单次临床读数 $W$ 的总体方差为 $\\sigma_{W}^{2} = 196$ $\\mathrm{mmHg}^{2}$。\n\n仅使用协方差 $\\operatorname{Cov}(\\cdot,\\cdot)$ 和相关性的定义，以及上述经典测量误差模型的假设，推导 $\\sigma_{U}^{2}$ 关于 $\\rho_{WW'}$ 和 $\\sigma_{W}^{2}$ 的矩估计量。在您的推导中，通过证明在经典误差下 $\\lambda = \\rho_{WW'}$，将重测相关性 $\\rho_{WW'}$ 与信度系数 $\\lambda$ 联系起来。然后，使用给定的数值，计算 $\\sigma_{U}^{2}$ 的估计值。将您的最终数值答案四舍五入到四位有效数字。以 $\\mathrm{mmHg}^{2}$ 为单位表示方差。", "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据，提法明确，且客观。该问题描述了经典测量误差模型，这是生物统计学中的一个基本概念。所提供的数据和假设是完整、一致且足以推导出唯一解的。\n\n问题要求推导测量误差方差 $\\sigma_{U}^{2}$ 的矩估计量，并根据所提供的数据进行后续计算。\n\n经典测量误差模型由观测读数 $W$、真实基础值 $X$ 和随机测量误差 $U$ 之间的关系给出。\n第一次读数建模为：\n$$W = X + U$$\n经典模型的假设是：\n1.  测量误差的均值为零：$E(U) = 0$。\n2.  测量误差的方差是一个常数：$\\operatorname{Var}(U) = \\sigma_{U}^{2}$。\n3.  测量误差 $U$ 与真实值 $X$ 无关。\n\n从这些假设中，我们可以推导出观测读数 $W$ 的方差。设 $\\operatorname{Var}(X) = \\sigma_{X}^{2}$。\n$$\n\\sigma_{W}^{2} = \\operatorname{Var}(W) = \\operatorname{Var}(X + U)\n$$\n由于 $X$ 和 $U$ 的独立性，它们和的方差是它们方差的和：\n$$\n\\sigma_{W}^{2} = \\operatorname{Var}(X) + \\operatorname{Var}(U) = \\sigma_{X}^{2} + \\sigma_{U}^{2}\n$$\n这个方程表明，观测方差是真实生物学方差和测量误差方差之和。\n\n一项重测子研究提供了对同一个体的第二次测量 $W'$。假设真实值 $X$ 保持不变。第二次读数的模型是：\n$$W' = X + U'$$\n这里，$U'$ 是第二次读数的测量误差。假设它是 $U$ 的一个独立副本，意味着 $E(U') = 0$，$\\operatorname{Var}(U') = \\sigma_{U}^{2}$，且 $U'$ 与 $X$ 和 $U$ 无关。\n\n问题要求我们使用重测相关性 $\\rho_{WW'}$。$W$ 和 $W'$ 之间的相关系数定义为：\n$$\n\\rho_{WW'} = \\frac{\\operatorname{Cov}(W, W')}{\\sqrt{\\operatorname{Var}(W)\\operatorname{Var}(W')}}\n$$\n由于测量是在相同条件下进行的，所以 $\\operatorname{Var}(W') = \\operatorname{Var}(W) = \\sigma_{W}^{2}$。因此，分母是 $\\sqrt{\\sigma_{W}^{2} \\cdot \\sigma_{W}^{2}} = \\sigma_{W}^{2}$。\n公式简化为：\n$$\n\\rho_{WW'} = \\frac{\\operatorname{Cov}(W, W')}{\\sigma_{W}^{2}}\n$$\n接下来，我们必须使用模型定义 $W = X + U$ 和 $W' = X + U'$ 来计算协方差项 $\\operatorname{Cov}(W, W')$。\n$$\n\\operatorname{Cov}(W, W') = \\operatorname{Cov}(X + U, X + U')\n$$\n使用协方差的双线性性质：\n$$\n\\operatorname{Cov}(X + U, X + U') = \\operatorname{Cov}(X, X) + \\operatorname{Cov}(X, U') + \\operatorname{Cov}(U, X) + \\operatorname{Cov}(U, U')\n$$\n我们根据独立性假设来评估每一项：\n-   $\\operatorname{Cov}(X, X) = \\operatorname{Var}(X) = \\sigma_{X}^{2}$。\n-   $X$ 和 $U'$ 是独立的，所以 $\\operatorname{Cov}(X, U') = 0$。\n-   $U$ 和 $X$ 是独立的，所以 $\\operatorname{Cov}(U, X) = 0$。\n-   $U$ 和 $U'$ 是独立的，所以 $\\operatorname{Cov}(U, U') = 0$。\n\n将这些结果代回，我们得到：\n$$\n\\operatorname{Cov}(W, W') = \\sigma_{X}^{2}\n$$\n现在，我们将这个结果代入重测相关性的公式中：\n$$\n\\rho_{WW'} = \\frac{\\sigma_{X}^{2}}{\\sigma_{W}^{2}}\n$$\n问题还要求将其与信度系数 $\\lambda$ 联系起来。在经典测验理论中，信度系数定义为总观测方差中由真实分数方差引起的比例。\n$$\n\\lambda = \\frac{\\text{True Score Variance}}{\\text{Observed Score Variance}} = \\frac{\\operatorname{Var}(X)}{\\operatorname{Var}(W)} = \\frac{\\sigma_{X}^{2}}{\\sigma_{W}^{2}}\n$$\n通过将此定义与我们推导的重测相关性表达式进行比较，我们发现：\n$$\n\\lambda = \\rho_{WW'}\n$$\n这表明在经典测量误差模型下，重测相关性等同于信度系数。\n\n现在，我们推导 $\\sigma_{U}^{2}$ 的矩估计量。我们有一个包含总体矩 ($\\sigma_{W}^{2}$, $\\rho_{WW'}$) 和模型参数 ($\\sigma_{X}^{2}$, $\\sigma_{U}^{2}$) 的方程组：\n1.  $\\sigma_{W}^{2} = \\sigma_{X}^{2} + \\sigma_{U}^{2}$\n2.  $\\rho_{WW'} = \\frac{\\sigma_{X}^{2}}{\\sigma_{W}^{2}}$\n\n我们的目标是用可估计量 $\\sigma_{W}^{2}$ 和 $\\rho_{WW'}$ 来表示 $\\sigma_{U}^{2}$。\n从方程(2)中，我们可以将未观测到的真实方差 $\\sigma_{X}^{2}$ 表示为：\n$$\n\\sigma_{X}^{2} = \\rho_{WW'} \\sigma_{W}^{2}\n$$\n现在，我们将这个 $\\sigma_{X}^{2}$ 的表达式代入方程(1)：\n$$\n\\sigma_{W}^{2} = (\\rho_{WW'} \\sigma_{W}^{2}) + \\sigma_{U}^{2}\n$$\n最后，我们解出 $\\sigma_{U}^{2}$：\n$$\n\\sigma_{U}^{2} = \\sigma_{W}^{2} - \\rho_{WW'} \\sigma_{W}^{2}\n$$\n提出 $\\sigma_{W}^{2}$ 因子，得到所需的估计量：\n$$\n\\hat{\\sigma}_{U}^{2} = \\hat{\\sigma}_{W}^{2} (1 - \\hat{\\rho}_{WW'})\n$$\n其中帽子符号表示估计值。问题提供了大样本估计值，我们在本次计算中将其视为真实的总体值。\n\n给定的数值为：\n-   $\\rho_{WW'} = 0.75$\n-   $\\sigma_{W}^{2} = 196$ $\\mathrm{mmHg}^{2}$\n\n将这些值代入我们推导的 $\\sigma_{U}^{2}$ 公式中：\n$$\n\\sigma_{U}^{2} = 196 \\times (1 - 0.75)\n$$\n$$\n\\sigma_{U}^{2} = 196 \\times 0.25\n$$\n$$\n\\sigma_{U}^{2} = \\frac{196}{4} = 49\n$$\n测量误差方差的最终估计值为 $49$ $\\mathrm{mmHg}^{2}$。问题要求将最终答案四舍五入到四位有效数字。作为一个精确的整数，$49$ 可以写成 $49.00$ 来满足此要求。", "answer": "$$\n\\boxed{49.00}\n$$", "id": "4956402"}, {"introduction": "虽然简单的重测设计很有用，但研究中通常会针对每个受试者收集多个重复测量值。方差分析 (ANOVA) 提供了一个强大的框架，可以将观测到的总变异严格地分解为组内方差（代表测量误差）和组间方差（代表真实的生物学差异）。本练习将指导你通过推导这些关键方差组分的估计量，从而更深入地理解和量化不同来源的变异 [@problem_id:4956444]。", "problem": "一个生物统计学团队正在研究一种生物标志物，通过对每个个体进行重复测量来量化测量误差和真实的受试者间变异。对于 $i \\in \\{1,\\dots,n\\}$ 名受试者和每名受试者的 $j \\in \\{1,\\dots,r\\}$ 次技术重复，观测到的测量值被建模为 $W_{ij} = X_i + U_{ij}$，其中 $X_i$ 是未观测到的真实受试者水平的量，$U_{ij}$ 是测量误差。假设 $X_i$ 独立同分布，其期望为 $E[X_i] = \\mu$，方差为 $\\operatorname{Var}(X_i) = \\sigma_{X}^{2}$；$U_{ij}$ 独立同分布，其期望为 $E[U_{ij}] = 0$，方差为 $\\operatorname{Var}(U_{ij}) = \\sigma_{U}^{2}$，且与 $\\{X_i\\}$ 独立。仪器的任何潜在系统性偏差被建模为一个对所有观测值都相同的未知常数偏移量 $b$，该团队关心的是方差分量，这些分量应不受 $b$ 的影响。在此均衡设计下，使用方差分析（ANOVA）的标准框架，推导受试者内方差分量 $\\sigma_{U}^{2}$ 和受试者间方差分量 $\\sigma_{X}^{2}$ 的无偏估计量。将您的最终估计量表示为关于观测数据 $\\{W_{ij}\\}$、受试者特定均值 $\\bar{W}_{i\\cdot} = \\frac{1}{r}\\sum_{j=1}^{r} W_{ij}$ 和总均值 $\\bar{W}_{\\cdot\\cdot} = \\frac{1}{nr}\\sum_{i=1}^{n}\\sum_{j=1}^{r} W_{ij}$ 的闭式解析表达式。将最终答案以行矩阵 $\\left(\\hat{\\sigma}_{U}^{2}, \\hat{\\sigma}_{X}^{2}\\right)$ 的形式呈现。无需进行数值四舍五入；请提供精确的符号表达式。", "solution": "这个问题提法明确且具有科学依据。它描述了一个标准的单因素随机效应模型，这在生物统计学中常用于评估变异的来源。我们可以继续使用方差分析（ANOVA）框架来推导方差分量 $\\sigma_{U}^{2}$ 和 $\\sigma_{X}^{2}$ 的估计量。\n\n对于受试者 $i$ 和重复实验 $j$，观测测量值的模型为 $W_{ij} = X_i + U_{ij}$。题目中提到系统性偏差 $b$ 是一个对所有观测值都存在的常数偏移，因此我们可以将完整模型写为 $W_{ij} = b + X_i + U_{ij}$。随机变量 $X_i$ 代表真实的受试者水平的量，它们是独立同分布的（i.i.d.），均值为 $E[X_i] = \\mu$，方差为 $\\operatorname{Var}(X_i) = \\sigma_{X}^{2}$。$U_{ij}$ 项代表测量误差，它们是独立同分布的，均值为 $E[U_{ij}] = 0$，方差为 $\\operatorname{Var}(U_{ij}) = \\sigma_{U}^{2}$。变量集 $\\{X_i\\}$ 和 $\\{U_{ij}\\}$ 是相互独立的。\n\n我们的目标是找到受试者内方差分量 $\\sigma_{U}^{2}$ 和受试者间方差分量 $\\sigma_{X}^{2}$ 的无偏估计量。我们使用矩法，在这种情况下，这涉及到计算ANOVA均方的期望值，并将其与观测到的均方相等。\n\n单因素方差分析中的关键量是离差平方和。\n受试者内离差平方和（$SSW$）定义为：\n$$SSW = \\sum_{i=1}^{n} \\sum_{j=1}^{r} (W_{ij} - \\bar{W}_{i\\cdot})^2$$\n其中 $\\bar{W}_{i\\cdot} = \\frac{1}{r} \\sum_{j=1}^{r} W_{ij}$ 是受试者 $i$ 的均值。\n\n受试者间离差平方和（$SSB$）定义为：\n$$SSB = \\sum_{i=1}^{n} \\sum_{j=1}^{r} (\\bar{W}_{i\\cdot} - \\bar{W}_{\\cdot\\cdot})^2 = r \\sum_{i=1}^{n} (\\bar{W}_{i\\cdot} - \\bar{W}_{\\cdot\\cdot})^2$$\n其中 $\\bar{W}_{\\cdot\\cdot} = \\frac{1}{nr} \\sum_{i=1}^{n} \\sum_{j=1}^{r} W_{ij}$ 是总均值。\n\n相应的均方是离差平方和除以其自由度。\n受试者内均方（$MSW$）具有 $n(r-1)$ 的自由度：\n$$MSW = \\frac{SSW}{n(r-1)}$$\n受试者间均方（$MSB$）具有 $n-1$ 的自由度：\n$$MSB = \\frac{SSB}{n-1}$$\n\n为了找到无偏估计量，我们首先计算 $MSW$ 和 $MSB$ 的期望值。\n\n让我们分析 $(W_{ij} - \\bar{W}_{i\\cdot})$ 这一项：\n$\\bar{W}_{i\\cdot} = \\frac{1}{r} \\sum_{j=1}^{r} (b + X_i + U_{ij}) = b + X_i + \\frac{1}{r} \\sum_{j=1}^{r} U_{ij} = b + X_i + \\bar{U}_{i\\cdot}$。\n$W_{ij} - \\bar{W}_{i\\cdot} = (b + X_i + U_{ij}) - (b + X_i + \\bar{U}_{i\\cdot}) = U_{ij} - \\bar{U}_{i\\cdot}$。\n注意，系统性偏差 $b$ 和受试者特定的真实值 $X_i$ 被抵消了，这意味着 $SSW$ 和 $MSW$ 不受它们的影响。\n\n$SSW$ 的期望值为：\n$$E[SSW] = E\\left[\\sum_{i=1}^{n} \\sum_{j=1}^{r} (U_{ij} - \\bar{U}_{i\\cdot})^2\\right] = \\sum_{i=1}^{n} E\\left[\\sum_{j=1}^{r} (U_{ij} - \\bar{U}_{i\\cdot})^2\\right]$$\n对于任何给定的受试者 $i$，项 $\\sum_{j=1}^{r} (U_{ij} - \\bar{U}_{i\\cdot})^2$ 是 $r$ 个独立同分布误差项 $\\{U_{ij}\\}_{j=1}^r$ 的样本方差的 $(r-1)$ 倍。样本方差的期望值是总体方差 $\\sigma_{U}^{2}$。\n因此，$E\\left[\\sum_{j=1}^{r} (U_{ij} - \\bar{U}_{i\\cdot})^2\\right] = (r-1)\\sigma_{U}^{2}$。\n对所有 $n$ 个受试者求和，我们得到：\n$$E[SSW] = \\sum_{i=1}^{n} (r-1)\\sigma_{U}^{2} = n(r-1)\\sigma_{U}^{2}$$\n现在，我们求 $MSW$ 的期望：\n$$E[MSW] = \\frac{E[SSW]}{n(r-1)} = \\frac{n(r-1)\\sigma_{U}^{2}}{n(r-1)} = \\sigma_{U}^{2}$$\n这表明 $MSW$ 是受试者内方差 $\\sigma_{U}^{2}$ 的一个无偏估计量。\n\n接下来，我们计算 $MSB$ 的期望值。首先，考虑 $(\\bar{W}_{i\\cdot} - \\bar{W}_{\\cdot\\cdot})$ 这些项：\n$\\bar{W}_{\\cdot\\cdot} = \\frac{1}{n} \\sum_{i=1}^{n} \\bar{W}_{i\\cdot} = \\frac{1}{n} \\sum_{i=1}^{n} (b + X_i + \\bar{U}_{i\\cdot}) = b + \\bar{X}_{\\cdot} + \\bar{U}_{\\cdot\\cdot}$。\n$\\bar{W}_{i\\cdot} - \\bar{W}_{\\cdot\\cdot} = (b + X_i + \\bar{U}_{i\\cdot}) - (b + \\bar{X}_{\\cdot} + \\bar{U}_{\\cdot\\cdot}) = (X_i - \\bar{X}_{\\cdot}) + (\\bar{U}_{i\\cdot} - \\bar{U}_{\\cdot\\cdot})$。\n同样，偏差 $b$ 被抵消。$SSB$ 的期望值为：\n$$E[SSB] = E\\left[r \\sum_{i=1}^{n} ( (X_i - \\bar{X}_{\\cdot}) + (\\bar{U}_{i\\cdot} - \\bar{U}_{\\cdot\\cdot}) )^2\\right]$$\n由于 $X_i$ 和 $U_{ij}$ 的独立性，交叉乘积项的期望为零。\n$$E[SSB] = r E\\left[\\sum_{i=1}^{n} (X_i - \\bar{X}_{\\cdot})^2\\right] + r E\\left[\\sum_{i=1}^{n} (\\bar{U}_{i\\cdot} - \\bar{U}_{\\cdot\\cdot})^2\\right]$$\n第一项涉及 $\\{X_i\\}$ 的样本方差。由于 $E[\\sum_{i=1}^{n} (X_i - \\bar{X}_{\\cdot})^2] = (n-1)\\operatorname{Var}(X_i) = (n-1)\\sigma_{X}^{2}$。\n第二项涉及 $\\{\\bar{U}_{i\\cdot}\\}$ 的样本方差。变量 $\\bar{U}_{i\\cdot}$ 是独立同分布的，均值为 $0$，方差为 $\\operatorname{Var}(\\bar{U}_{i\\cdot}) = \\operatorname{Var}(\\frac{1}{r}\\sum_j U_{ij}) = \\frac{1}{r^2} \\sum_j \\operatorname{Var}(U_{ij}) = \\frac{r\\sigma_{U}^{2}}{r^2} = \\frac{\\sigma_{U}^{2}}{r}$。\n所以，$E[\\sum_{i=1}^{n} (\\bar{U}_{i\\cdot} - \\bar{U}_{\\cdot\\cdot})^2] = (n-1)\\operatorname{Var}(\\bar{U}_{i\\cdot}) = (n-1)\\frac{\\sigma_{U}^{2}}{r}$。\n综合这些结果：\n$$E[SSB] = r(n-1)\\sigma_{X}^{2} + r(n-1)\\frac{\\sigma_{U}^{2}}{r} = r(n-1)\\sigma_{X}^{2} + (n-1)\\sigma_{U}^{2}$$\n现在，我们求 $MSB$ 的期望：\n$$E[MSB] = \\frac{E[SSB]}{n-1} = \\frac{r(n-1)\\sigma_{X}^{2} + (n-1)\\sigma_{U}^{2}}{n-1} = r\\sigma_{X}^{2} + \\sigma_{U}^{2}$$\n我们得到了一个包含两个未知方差分量的两方程方程组：\n1. $E[MSW] = \\sigma_{U}^{2}$\n2. $E[MSB] = r\\sigma_{X}^{2} + \\sigma_{U}^{2}$\n\n使用矩法，我们用观测到的统计量代替它们的期望，以获得估计量 $\\hat{\\sigma}_{U}^{2}$ 和 $\\hat{\\sigma}_{X}^{2}$。\n从方程 1，我们得到受试者内方差的估计量：\n$$\\hat{\\sigma}_{U}^{2} = MSW = \\frac{SSW}{n(r-1)} = \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{r} (W_{ij} - \\bar{W}_{i\\cdot})^2}{n(r-1)}$$\n从方程 2，我们将 $\\hat{\\sigma}_{U}^{2}$ 代替 $\\sigma_{U}^{2}$：\n$MSB = r\\hat{\\sigma}_{X}^{2} + \\hat{\\sigma}_{U}^{2} = r\\hat{\\sigma}_{X}^{2} + MSW$。\n解出 $\\hat{\\sigma}_{X}^{2}$：\n$$r\\hat{\\sigma}_{X}^{2} = MSB - MSW$$\n$$\\hat{\\sigma}_{X}^{2} = \\frac{MSB - MSW}{r}$$\n代入 $MSB$ 和 $MSW$ 的表达式：\n$$\\hat{\\sigma}_{X}^{2} = \\frac{1}{r} \\left( \\frac{SSB}{n-1} - \\frac{SSW}{n(r-1)} \\right)$$\n$$\\hat{\\sigma}_{X}^{2} = \\frac{1}{r} \\left( \\frac{r \\sum_{i=1}^{n} (\\bar{W}_{i\\cdot} - \\bar{W}_{\\cdot\\cdot})^2}{n-1} - \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{r} (W_{ij} - \\bar{W}_{i\\cdot})^2}{n(r-1)} \\right)$$\n这两个关于 $\\hat{\\sigma}_{U}^{2}$ 和 $\\hat{\\sigma}_{X}^{2}$ 的表达式就是所求的无偏估计量。\n\n最终的估计量为：\n对于受试者内方差分量 $\\sigma_U^2$：\n$$\\hat{\\sigma}_{U}^{2} = \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{r} (W_{ij} - \\bar{W}_{i\\cdot})^2}{n(r-1)}$$\n对于受试者间方差分量 $\\sigma_X^2$：\n$$\\hat{\\sigma}_{X}^{2} = \\frac{1}{r} \\left( \\frac{r \\sum_{i=1}^{n} (\\bar{W}_{i\\cdot} - \\bar{W}_{\\cdot\\cdot})^2}{n-1} - \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{r} (W_{ij} - \\bar{W}_{i\\cdot})^2}{n(r-1)} \\right)$$", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{r} (W_{ij} - \\bar{W}_{i\\cdot})^2}{n(r-1)}, & \\frac{1}{r} \\left( \\frac{r \\sum_{i=1}^{n} (\\bar{W}_{i\\cdot} - \\bar{W}_{\\cdot\\cdot})^2}{n-1} - \\frac{\\sum_{i=1}^{n}\\sum_{j=1}^{r} (W_{ij} - \\bar{W}_{i\\cdot})^2}{n(r-1)} \\right) \\end{pmatrix} } $$", "id": "4956444"}, {"introduction": "量化误差之后，我们必须考虑其后果。即使是随机的测量误差，也会增加数据的方差，从而降低研究检测到真实效应的统计功效。这项实践练习将展示如何计算所需的样本量增加幅度，以补偿这种功效损失，这对于设计高效且有力的临床试验是一项至关重要的技能 [@problem_id:4956457]。", "problem": "考虑一项均衡的随机对照试验 (RCT)，该试验以等量分配的方式比较一种二元处理 ($X_{i} \\in \\{0,1\\}$)。参与者 $i$ 的连续结果遵循经典的正态线性模型\n$$\nY_{i} = \\beta_{0} + \\beta_{1} X_{i} + \\varepsilon_{i},\n$$\n其中 $\\varepsilon_{i}$ 是独立同分布的，满足 $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})$，并且独立于 $X_{i}$。感兴趣的科学估计量是处理效应 $\\beta_{1} = \\Delta \\neq 0$。由于测量不完美，观测结果会受到加性的、独立的测量误差的影响：\n$$\nY_{i}^{*} = Y_{i} + V_{i}, \\quad V_{i} \\sim \\mathcal{N}(0,\\sigma_{V}^{2}),\n$$\n其中 $V_{i}$ 独立于 $Y_{i}$ 和 $X_{i}$。一位研究者使用常规的双样本 $t$ 检验（等价于将 $Y_{i}^{*}$ 对 $X_{i}$ 进行带截距项的普通最小二乘回归）在固定的显著性水平下检验 $H_{0}:\\beta_{1}=0$，并通过备择假设 $\\beta_{1}=\\Delta$ 下 t 统计量的非中心化参数来考虑检验效能。\n\n设总样本量为 $n$，每个组有 $n/2$ 个个体。仅使用 t 统计量的定义以及在独立同分布的正态误差下样本均值的方差，首先推导在 $Y^{*}$ 条件下的非中心化参数，并用 $\\Delta$、$n$、$\\sigma_{Y}^{2}$ 和 $\\sigma_{V}^{2}$ 来表示。然后，通过将此参数与在无误差结果 $Y$（即方差为 $\\sigma_{Y}^{2}$）下获得的非中心化参数相等，推导在 $Y^{*}$ 条件下为保持与使用 $Y$ 时相同的非中心化参数所需的样本量膨胀因子 $k = n^{*}/n$。将您的最终答案表示为关于 k 的单个简化解析表达式。无需进行数值计算或四舍五入，最终表达式中也不应包含任何单位。", "solution": "用户希望我按照以下步骤解决问题：\n1. 验证问题陈述。\n2. 如果有效，推导基于观测结果的 t 检验的非中心化参数。\n3. 推导为保持与基于真实结果的检验相同的检验效能所需的样本量膨胀因子。\n\n### 第 1 步：提取已知条件\n-   **真实结果模型：** $Y_{i} = \\beta_{0} + \\beta_{1} X_{i} + \\varepsilon_{i}$\n-   **处理变量：** $X_{i} \\in \\{0,1\\}$\n-   **处理分配：** 均衡的随机对照试验，等量分配，总样本量为 $n$，因此每个组有 $n/2$ 个个体。\n-   **真实结果的误差项：** $\\varepsilon_{i}$ 是独立同分布 (i.i.d.) 的，$\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})$，并且 $\\varepsilon_{i}$ 独立于 $X_{i}$。\n-   **感兴趣的估计量：** $\\beta_{1} = \\Delta \\neq 0$。\n-   **测量误差模型：** 观测结果为 $Y_{i}^{*} = Y_{i} + V_{i}$。\n-   **测量误差项：** $V_{i} \\sim \\mathcal{N}(0,\\sigma_{V}^{2})$，独立同分布。\n-   **测量误差的独立性：** $V_{i}$ 独立于 $Y_{i}$ 和 $X_{i}$。\n-   **统计检验：** 对 $Y_{i}^{*}$ 进行双样本 t 检验以检验 $H_{0}:\\beta_{1}=0$。\n-   **目标：** 首先，推导使用 $Y_{i}^{*}$ 进行检验的非中心化参数。其次，推导为保持与基于无误差结果 $Y_i$ 的检验相同的非中心化参数所需的样本量膨胀因子 $k = n^{*}/n$。\n\n### 第 2 步：使用提取的已知条件进行验证\n-   **科学依据：** 问题使用了经典正态线性模型和经典加性测量误差。这些是统计学和生物统计学中标准的、成熟的模型。该框架在科学上是合理的。\n-   **适定性：** 问题提供了所有必要的定义，并要求推导特定的解析量（非中心化参数和膨胀因子）。任务清晰，存在唯一的数学解。\n-   **客观性：** 语言是正式的，没有主观性陈述。\n-   **完整性：** 问题明确了分布、独立性假设、实验设计和分析方法。所有必需的信息都已提供。\n-   **一致性：** 没有矛盾的陈述。各项假设是相互兼容的。\n\n### 第 3 步：结论与行动\n问题是有效的。这是一个关于测量误差对统计检验效能影响的标准统计理论练习。我将继续进行求解。\n\n### 推导过程\n求解过程分为三个主要部分：首先，我们描述观测结果 $Y_i^*$ 的统计特性；其次，我们推导基于 $Y_i^*$ 的双样本 t 检验的非中心化参数 (NCP)；第三，我们将其与基于真实结果 $Y_i$ 的假设检验的 NCP 进行比较，以求出所需的样本量膨胀因子。\n\n参与者 i 的真实结果模型由下式给出\n$$\nY_{i} = \\beta_{0} + \\beta_{1} X_{i} + \\varepsilon_{i}, \\quad \\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})\n$$\n观测结果 $Y_i^*$ 受到一个独立的、加性的测量误差 $V_i$ 的影响：\n$$\nY_{i}^{*} = Y_{i} + V_{i}, \\quad V_{i} \\sim \\mathcal{N}(0,\\sigma_{V}^{2})\n$$\n我们可以将第一个方程代入第二个方程，得到观测结果的模型：\n$$\nY_{i}^{*} = (\\beta_{0} + \\beta_{1} X_{i} + \\varepsilon_{i}) + V_{i} = \\beta_{0} + \\beta_{1} X_{i} + U_{i}\n$$\n其中 $U_{i} = \\varepsilon_{i} + V_{i}$。由于 $\\varepsilon_{i}$ 和 $V_{i}$ 是独立的正态分布，它们的和 $U_i$ 也是正态分布。$U_i$ 的均值为 $E[U_{i}] = E[\\varepsilon_{i}] + E[V_{i}] = 0 + 0 = 0$。由于它们的独立性，$U_i$ 的方差为 $\\operatorname{Var}(U_{i}) = \\operatorname{Var}(\\varepsilon_{i}) + \\operatorname{Var}(V_{i}) = \\sigma_{Y}^{2} + \\sigma_{V}^{2}$。我们将新误差项的方差记为 $\\sigma_{Y^{*}}^{2} = \\sigma_{Y}^{2} + \\sigma_{V}^{2}$。\n因此，观测结果的模型是\n$$\nY_{i}^{*} = \\beta_{0} + \\beta_{1} X_{i} + U_{i}, \\quad U_{i} \\sim \\mathcal{N}(0, \\sigma_{Y^{*}}^{2})\n$$\n这表明结果中的加性测量误差不会在参数估计中引入偏差，但会增大残差方差。\n\n双样本 t 检验用于检验原假设 $H_{0}: \\beta_{1}=0$。这等价于将 $Y_i^*$ 对 $X_i$ 进行普通最小二乘回归。$\\beta_1$ 的 OLS 估计量是 $\\hat{\\beta}_1 = \\bar{Y}_1^* - \\bar{Y}_0^*$，其中 $\\bar{Y}_1^*$ 和 $\\bar{Y}_0^*$ 分别是处理组 ($X_i=1$) 和控制组 ($X_i=0$) 中观测结果的样本均值。该试验是均衡的，每个组有 $n/2$ 名受试者。\n\n在备择假设 $H_A: \\beta_1 = \\Delta$ 下，估计量的期望值为：\n$$\nE[\\hat{\\beta}_1] = E[\\bar{Y}_1^* - \\bar{Y}_0^*] = E[\\bar{Y}_1^*] - E[\\bar{Y}_0^*]\n$$\n处理组中结果的期望值为 $E[Y_i^* | X_i=1] = \\beta_0 + \\Delta$，控制组中为 $E[Y_i^* | X_i=0] = \\beta_0$。因此，$E[\\hat{\\beta}_1] = (\\beta_0 + \\Delta) - \\beta_0 = \\Delta$。\n\n估计量的方差为：\n$$\n\\operatorname{Var}(\\hat{\\beta}_1) = \\operatorname{Var}(\\bar{Y}_1^* - \\bar{Y}_0^*) = \\operatorname{Var}(\\bar{Y}_1^*) + \\operatorname{Var}(\\bar{Y}_0^*)\n$$\n样本均值的方差为 $\\operatorname{Var}(\\bar{Y}_1^*) = \\frac{\\sigma_{Y^{*}}^{2}}{n/2}$ 和 $\\operatorname{Var}(\\bar{Y}_0^*) = \\frac{\\sigma_{Y^{*}}^{2}}{n/2}$。因此，\n$$\n\\operatorname{Var}(\\hat{\\beta}_1) = \\frac{\\sigma_{Y^{*}}^{2}}{n/2} + \\frac{\\sigma_{Y^{*}}^{2}}{n/2} = \\frac{2 \\sigma_{Y^{*}}^{2}}{n/2} = \\frac{4 \\sigma_{Y^{*}}^{2}}{n}\n$$\nt 统计量为 $T = \\frac{\\hat{\\beta}_1}{\\operatorname{SE}(\\hat{\\beta}_1)}$。在备择假设下，此统计量遵循非中心 t 分布。非中心化参数 (NCP)，我们记为 $\\delta^*$，由分子的真实均值除以其真实标准差给出：\n$$\n\\delta^{*} = \\frac{E[\\hat{\\beta}_1]}{\\sqrt{\\operatorname{Var}(\\hat{\\beta}_1)}} = \\frac{\\Delta}{\\sqrt{\\frac{4 \\sigma_{Y^{*}}^{2}}{n}}} = \\frac{\\Delta \\sqrt{n}}{2 \\sigma_{Y^{*}}}\n$$\n代入 $\\sigma_{Y^{*}}^{2} = \\sigma_{Y}^{2} + \\sigma_{V}^{2}$，我们得到使用观测数据 $Y^*$ 进行检验的非中心化参数的表达式：\n$$\n\\delta^{*} = \\frac{\\Delta \\sqrt{n}}{2 \\sqrt{\\sigma_{Y}^{2} + \\sigma_{V}^{2}}}\n$$\n推导的第一部分到此结束。\n\n对于第二部分，我们考虑无误差结果 $Y_i$ 的假设情景。在这种情况下，测量误差 $V_i$ 为零，因此 $\\sigma_V^2=0$。结果的方差就是 $\\operatorname{Var}(Y_i | X_i) = \\sigma_Y^2$。对于样本量为 $n$ 的基于 $Y_i$ 的检验，其非中心化参数我们记为 $\\delta$，可以通过在 $\\delta^*$ 的表达式中令 $\\sigma_V^2=0$ 得到：\n$$\n\\delta = \\frac{\\Delta \\sqrt{n}}{2 \\sqrt{\\sigma_{Y}^{2}}}\n$$\n问题要求我们找到在有测量误差的研究中（使用结果 $Y^*$）所需的样本量 $n^*$，以达到与样本量为 $n$ 的无误差研究相同的非中心化参数 $\\delta$。我们将样本量为 $n^*$ 的观测数据研究的 NCP 设为与 $\\delta$ 相等：\n$$\n\\frac{\\Delta \\sqrt{n^{*}}}{2 \\sqrt{\\sigma_{Y}^{2} + \\sigma_{V}^{2}}} = \\frac{\\Delta \\sqrt{n}}{2 \\sqrt{\\sigma_{Y}^{2}}}\n$$\n由于 $\\Delta \\neq 0$，我们可以消去等式两边的 $\\Delta/2$：\n$$\n\\frac{\\sqrt{n^{*}}}{\\sqrt{\\sigma_{Y}^{2} + \\sigma_{V}^{2}}} = \\frac{\\sqrt{n}}{\\sqrt{\\sigma_{Y}^{2}}}\n$$\n将方程两边平方，得到：\n$$\n\\frac{n^{*}}{\\sigma_{Y}^{2} + \\sigma_{V}^{2}} = \\frac{n}{\\sigma_{Y}^{2}}\n$$\n现在我们可以解出所需的样本量 $n^{*}$：\n$$\nn^{*} = n \\left( \\frac{\\sigma_{Y}^{2} + \\sigma_{V}^{2}}{\\sigma_{Y}^{2}} \\right)\n$$\n样本量膨胀因子为 $k = n^{*}/n$。将上述方程两边除以 $n$ 即可得到 $k$ 的最终表达式：\n$$\nk = \\frac{n^{*}}{n} = \\frac{\\sigma_{Y}^{2} + \\sigma_{V}^{2}}{\\sigma_{Y}^{2}} = 1 + \\frac{\\sigma_{V}^{2}}{\\sigma_{Y}^{2}}\n$$\n该因子表示为抵消结果变量中加性测量误差导致的统计检验效能损失所需的样本量比例增加。", "answer": "$$ \\boxed{1 + \\frac{\\sigma_V^2}{\\sigma_Y^2}} $$", "id": "4956457"}]}