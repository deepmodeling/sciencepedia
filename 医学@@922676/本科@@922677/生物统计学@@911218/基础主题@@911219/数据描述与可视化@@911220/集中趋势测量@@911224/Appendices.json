{"hands_on_practices": [{"introduction": "在生物统计学实践中，我们常常需要整合来自不同研究或子群的数据。例如，在汇总不同医院的患者数据或进行元分析时，我们可能只知道各组的平均值和样本量。本练习 [@problem_id:1934455] 将引导你推导出一个通用公式，用于计算合并组的总平均值，从而强调加权平均这一核心概念，并说明为何不能简单地对各组的平均值再取平均。", "problem": "一位金融分析师正在研究两个不同投资组合（投资组合A和投资组合B）的表现。对于投资组合A，该分析师研究了 $n_A$ 支个股的样本，发现其平均年回报率为 $\\bar{r}_A$。类似地，对于投资组合B，一个包含 $n_B$ 支不同个股的样本，其平均年回报率为 $\\bar{r}_B$。现在，该分析师希望计算这两个投资组合中所有股票合并后的总平均年回报率。\n\n假设这两个投资组合包含完全不同的股票，请推导合并平均年回报率 $\\bar{r}_c$ 的通用代数表达式，该表达式应以样本量 $n_A$ 和 $n_B$ 以及样本均值 $\\bar{r}_A$ 和 $\\bar{r}_B$ 来表示。", "solution": "设投资组合A中的个体年回报率表示为 $r_{A,i}$（其中 $i=1,2,\\dots,n_{A}$），投资组合B中的个体年回报率表示为 $r_{B,j}$（其中 $j=1,2,\\dots,n_{B}$）。根据样本均值的定义，投资组合A的平均年回报率为\n$$\n\\bar{r}_{A} = \\frac{1}{n_{A}} \\sum_{i=1}^{n_{A}} r_{A,i},\n$$\n这意味着\n$$\n\\sum_{i=1}^{n_{A}} r_{A,i} = n_{A} \\bar{r}_{A}.\n$$\n类似地，对于投资组合B，\n$$\n\\bar{r}_{B} = \\frac{1}{n_{B}} \\sum_{j=1}^{n_{B}} r_{B,j}\n\\quad \\Rightarrow \\quad\n\\sum_{j=1}^{n_{B}} r_{B,j} = n_{B} \\bar{r}_{B}.\n$$\n由于这两个投资组合包含不相交的股票集，合并后的总体共有 $n_{A} + n_{B}$ 支股票，其回报率的总和是两个独立总和之和：\n$$\nS_{c} = \\sum_{i=1}^{n_{A}} r_{A,i} + \\sum_{j=1}^{n_{B}} r_{B,j} = n_{A} \\bar{r}_{A} + n_{B} \\bar{r}_{B}.\n$$\n根据合并后总体的样本均值定义，合并平均年回报率是总和除以股票总数：\n$$\n\\bar{r}_{c} = \\frac{S_{c}}{n_{A} + n_{B}} = \\frac{n_{A} \\bar{r}_{A} + n_{B} \\bar{r}_{B}}{n_{A} + n_{B}}.\n$$\n这是两个投资组合均值的加权平均值，其权重分别为 $n_{A}$ 和 $n_{B}$。", "answer": "$$\\boxed{\\frac{n_{A}\\bar{r}_{A}+n_{B}\\bar{r}_{B}}{n_{A}+n_{B}}}$$", "id": "1934455"}, {"introduction": "真实世界的生物医学数据很少是完美无瑕的；它们经常包含异常值，即由于测量误差、仪器故障或生物变异而产生的极端数值。算术平均值对这些异常值极为敏感，而稳健的统计方法则能更好地抵御其影响。通过这个练习 [@problem_id:4811621]，你将亲手计算并比较均值、中位数、缩尾均值和缩限均值，从而直观地理解不同集中趋势度量在数据污染面前的稳健性差异。", "problem": "一家医院实验室进行了一项小型初步研究，评估一种新的C-反应蛋白自动化分析方法。对于一个包含 $n=7$ 名患者的方便样本，新分析方法的首次运行得出了以下数值（单位为 $\\mathrm{mg/L}$）：$\\{2, 3, 3, 4, 4, 5, 50\\}$。一位资深生物统计学家指出，数值 $50$ 可能反映了仪器伪影。要求您仅从核心定义出发，使用几种对污染具有不同稳健性的度量来量化该分布的中心：样本均值（算术平均值）、样本中位数（中间顺序统计量）、$\\gamma=0.2$ 的$\\gamma$-缩尾均值（在求平均前从两尾丢弃相等比例的数据），以及$\\gamma=0.2$的$\\gamma$-缩限均值（在求平均前用最接近的剩余值替换最低和最高比例的值）。\n\n仅使用这些核心定义和顺序统计学的基本原理，对给定数据集执行以下操作：计算样本均值、样本中位数、0.2-缩尾均值和0.2-缩限均值。然后，在定性稳健性方面比较这四种汇总统计量，涉及极端污染下的崩溃点以及极端值处的无穷小污染是否会对估计量产生无界影响。\n\n作为您的最终数值答案，报告此数据集的0.2-缩尾均值。将最终答案四舍五入至四位有效数字，并以 $\\mathrm{mg/L}$ 为单位表示。", "solution": "第一步是通过定义数据集及其顺序统计量来形式化问题。样本大小为 $n=7$。给定的C-反应蛋白值数据集为 $X = \\{2, 3, 3, 4, 4, 5, 50\\}$。为了计算基于顺序的统计量（中位数、缩尾均值、缩限均值），我们必须首先按升序对数据进行排序。设 $X_{(i)}$ 表示第 $i$ 个顺序统计量。\n\n排序后的数据集为：\n$X_{(1)} = 2$\n$X_{(2)} = 3$\n$X_{(3)} = 3$\n$X_{(4)} = 4$\n$X_{(5)} = 4$\n$X_{(6)} = 5$\n$X_{(7)} = 50$\n\n我们现在计算所要求的四种集中趋势度量。\n\n1.  **样本均值 ($\\bar{x}$)**\n    样本均值是所有观测值的算术平均值。其定义为 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$。\n    对于给定的数据：\n    $$ \\bar{x} = \\frac{1}{7} (2 + 3 + 3 + 4 + 4 + 5 + 50) = \\frac{71}{7} \\approx 10.1429 $$\n\n2.  **样本中位数 ($\\tilde{x}$)**\n    样本中位数是将数据样本较高一半与较低一半分开的值。对于奇数样本大小 $n$，中位数是中间的顺序统计量，即 $X_{((n+1)/2)}$。\n    对于 $n=7$，中位数是第 $((7+1)/2)$ 个值，即第 4 个顺序统计量 $X_{(4)}$。\n    $$ \\tilde{x} = X_{(4)} = 4 $$\n\n3.  **$\\gamma$-缩尾均值 ($\\bar{x}_{\\gamma}$)**\n    $\\gamma$-缩尾均值的计算方法是：从排序后的数据中丢弃最低和最高值的 $\\gamma$ 比例，然后计算剩余数据的均值。从两端要修剪的观测数量为 $k = \\lfloor n\\gamma \\rfloor$。\n    给定 $\\gamma=0.2$ 和 $n=7$：\n    $$ k = \\lfloor 7 \\times 0.2 \\rfloor = \\lfloor 1.4 \\rfloor = 1 $$\n    这意味着我们必须丢弃单个最小值（$X_{(1)}=2$）和单个最大值（$X_{(7)}=50$）。剩余的数据点是 $\\{X_{(2)}, X_{(3)}, X_{(4)}, X_{(5)}, X_{(6)}\\} = \\{3, 3, 4, 4, 5\\}$。\n    剩余观测值的数量是 $n - 2k = 7 - 2(1) = 5$。\n    0.2-缩尾均值 $\\bar{x}_{0.2}$ 是这 5 个值的平均值：\n    $$ \\bar{x}_{0.2} = \\frac{1}{5} (3 + 3 + 4 + 4 + 5) = \\frac{19}{5} = 3.8 $$\n\n4.  **$\\gamma$-缩限均值 ($\\bar{x}_{W,\\gamma}$)**\n    $\\gamma$-缩限均值的计算方法是：用第 $(k+1)$ 小的值替换 $k = \\lfloor n\\gamma \\rfloor$ 个最小值，并用第 $(n-k)$ 大的值替换 $k$ 个最大值。然后在这个新的、修改过的数据集上计算均值。\n    和之前一样，对于 $\\gamma=0.2$ 和 $n=7$，我们有 $k=1$。\n    最小值 $X_{(1)}=2$ 被替换为第 $(1+1)$ 个值，即 $X_{(2)}=3$。\n    最大值 $X_{(7)}=50$ 被替换为第 $(7-1)$ 个值，即 $X_{(6)}=5$。\n    原始的有序集合 $\\{2, 3, 3, 4, 4, 5, 50\\}$ 被转换为缩限集合 $\\{3, 3, 3, 4, 4, 5, 5\\}$。\n    0.2-缩限均值 $\\bar{x}_{W,0.2}$ 是这个包含 $n=7$ 个值的新集合的平均值：\n    $$ \\bar{x}_{W,0.2} = \\frac{1}{7} (3 + 3 + 3 + 4 + 4 + 5 + 5) = \\frac{27}{7} \\approx 3.8571 $$\n\n**稳健性的定性比较**\n\n稳健性指的是估计量抵抗离群值或模型假设偏差过度影响的能力。我们可以根据它们的崩溃点和极端值的影响来比较这四个估计量。\n\n-   **样本均值**：均值不是一个稳健的估计量。它的崩溃点是 $1/n$，对于大样本，该值趋近于 $0$。这意味着单个任意大的观测值可以将均值移动到任何值。在我们的例子中，单个离群值 $50$ 将均值（$\\approx 10.14$）拉离了数据点的中心集群（所有这些点都 $\\leq 5$）。极端值处的无穷小污染具有无界影响，因为其影响函数是线性的且无界的。\n\n-   **样本中位数**：中位数是一个高度稳健的估计量。它的崩溃点约为 $50\\%$，这意味着必须污染近一半的数据才能使中位数变得任意大或小。其影响是有界的；对极端值的无穷小改变对中位数的影响为零，只要该值不跨越中位数本身。在我们的样本中，中位数为 $4$，它完美地反映了非离群数据的中心，并且完全不受数值 $50$ 的影响。\n\n-   **缩尾均值**：缩尾均值是一个稳健的估计量，其稳健性由缩尾比例 $\\gamma$ 控制。其崩溃点等于 $\\gamma$。对于 $\\gamma=0.2$，其崩溃点为 $20\\%$。超出缩尾范围的极端值被完全丢弃，因此它们对估计量的影响为零。得到的估计量 $\\bar{x}_{0.2}=3.8$ 非常接近中位数，并提供了一个不受离群值影响的稳定中心估计。\n\n-   **缩限均值**：缩限均值也是一个稳健的估计量，其崩溃点为 $\\gamma=0.2$。它不是丢弃极端值，而是用最接近的保留值替换它们，从而保留了样本大小。如果基础分布是重尾的，这通常比缩尾均值具有更高的统计效率。它对极端值的影响是有界的——离群值的值仅在它被识别为位于要被替换的尾部时才有意义。得到的估计值 $\\bar{x}_{W,0.2} \\approx 3.86$ 也很稳定，并接近中位数和缩尾均值。\n\n总而言之，稳健性排名为：中位数  缩尾/缩限均值  样本均值。均值对离群值 $50$ 高度敏感，而中位数、缩尾均值和缩限均值都提供了围绕 $4$ 的集中趋势的稳定估计。\n\n要求的最终答案是 0.2-缩尾均值，四舍五入到四位有效数字。\n计算值为：$\\bar{x}_{0.2} = 3.8$。\n写成四位有效数字是 $3.800$。", "answer": "$$ \\boxed{3.800} $$", "id": "4811621"}, {"introduction": "随着数据规模的不断增大，传统的统计计算方法面临着新的挑战，尤其是在处理无法一次性装入内存的数据流时。在这种情况下，我们需要能够“在线”更新统计量的有效算法。本练习 [@problem_id:1934443] 让你从第一性原理出发，推导一个用于计算移动平均值的递归公式，这不仅是一个巧妙的代数技巧，更是现代计算统计学中处理大规模数据流的基础。", "problem": "一台深空探测器的星载计算机负责分析高能粒子的通量。探测器的传感器生成一个测量数据流 $x_1, x_2, x_3, \\dots$，其中 $x_k$ 是在时间步 $k$ 进行的测量。由于严格的内存限制，计算机无法存储所有历史测量数据。因此，它必须在单次遍历中计算移动算术平均值。\n\n设 $\\mu_n$ 为前 $n$ 个测量值的算术平均值，即 $\\mu_n = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。当一个新的测量值 $x_n$ 到达时（对于 $n  1$），计算机会将之前的平均值 $\\mu_{n-1}$ 更新为新的平均值 $\\mu_n$。这个更新规则可以表示为前一个平均值和新数据点的线性组合：\n$$ \\mu_n = A_n \\mu_{n-1} + B_n x_n $$\n其中系数 $A_n$ 和 $B_n$ 是测量次数 $n$ 的函数。\n\n确定系数 $B_n$ 作为 $n$ 的函数的表达式。", "solution": "我们从前 $n$ 个测量值的移动平均值的定义开始：\n$$\n\\mu_{n}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n将这个和式分解为前 $n-1$ 项和第 $n$ 项：\n$$\n\\mu_{n}=\\frac{1}{n}\\left(\\sum_{i=1}^{n-1}x_{i}+x_{n}\\right).\n$$\n使用定义 $\\mu_{n-1}=\\frac{1}{n-1}\\sum_{i=1}^{n-1}x_{i}$，将部分和 $\\sum_{i=1}^{n-1}x_{i}$ 用 $\\mu_{n-1}$ 表示，这意味着\n$$\n\\sum_{i=1}^{n-1}x_{i}=(n-1)\\mu_{n-1}.\n$$\n将此代入 $\\mu_n$ 的表达式中：\n$$\n\\mu_{n}=\\frac{1}{n}\\left((n-1)\\mu_{n-1}+x_{n}\\right)=\\frac{n-1}{n}\\mu_{n-1}+\\frac{1}{n}x_{n}.\n$$\n与更新形式 $\\mu_{n}=A_{n}\\mu_{n-1}+B_{n}x_{n}$ 进行比较，我们确定\n$$\nB_{n}=\\frac{1}{n}.\n$$", "answer": "$$\\boxed{\\frac{1}{n}}$$", "id": "1934443"}]}