{"hands_on_practices": [{"introduction": "在生物统计学中，我们常常需要综合多个独立研究的结果来得到一个更精确的总体效应估计，这个过程称为荟萃分析 (meta-analysis)。一个自然的想法是对所有研究的效应估计值求算术平均，但这忽略了不同研究的精度差异。这个练习将通过推导固定效应荟萃分析中的最优估计量，来展示加权平均如何超越简单算术平均，它是通过为更精确的研究（即方差更小的研究）赋予更大的权重，从而得到合并效应量的最小方差无偏估计 [@problem_id:4943456]。", "problem": "一位生物统计学家正在一个固定效应模型下，综合来自 $k$ 个独立研究的证据，每个研究都估计了相同的生物学效应大小。研究 $i \\in \\{1,\\dots,k\\}$ 报告了一个共同效应 $\\theta$ 的估计量 $\\hat{\\theta}_{i}$，已知 $\\hat{\\theta}_{i}$ 是 $\\theta$ 的无偏估计，即 $\\mathbb{E}[\\hat{\\theta}_{i}] = \\theta$，并且具有已知的研究内方差 $\\operatorname{Var}(\\hat{\\theta}_{i}) = \\sigma_{i}^{2}$，其中 $\\sigma_{i}^{2} \\in (0,\\infty)$ 被视为已知。假设 $\\hat{\\theta}_{1},\\dots,\\hat{\\theta}_{k}$ 相互独立。\n\n仅使用算术平均值的基本性质（期望的线性性）、独立随机变量的方差可加性以及基本的约束优化方法，推导形式为 $\\tilde{\\theta} = \\sum_{i=1}^{k} w_{i}\\hat{\\theta}_{i}$ 的唯一线性无偏估计量，使其在满足 $\\sum_{i=1}^{k} w_{i} = 1$ 的所有权重选择中具有最小方差。将此估计量表示为一个加权算术平均值，你必须根据已知的方差 $\\sigma_{i}^{2}$ 确定其权重，并以闭合形式计算其方差。\n\n将你的最终答案以一个双元素行矩阵的形式给出，第一个元素等于该估计量，第二个元素等于其方差。无需进行数值评估。不包括任何单位。如果选择简化，请保持代数上的精确性，不要近似。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 有 $k$ 个独立研究，其中 $i \\in \\{1,\\dots,k\\}$。\n- 每个研究都估计一个共同的效应大小 $\\theta$。\n- 模型是固定效应模型。\n- 研究 $i$ 提供一个估计量 $\\hat{\\theta}_{i}$。\n- 每个估计量都是 $\\theta$ 的无偏估计：$\\mathbb{E}[\\hat{\\theta}_{i}] = \\theta$。\n- 每个估计量的方差都是已知的：$\\operatorname{Var}(\\hat{\\theta}_{i}) = \\sigma_{i}^{2}$，其中 $\\sigma_{i}^{2} \\in (0,\\infty)$。\n- 估计量 $\\hat{\\theta}_{1},\\dots,\\hat{\\theta}_{k}$ 相互独立。\n- 将要构建一个新的估计量，形式为线性组合：$\\tilde{\\theta} = \\sum_{i=1}^{k} w_{i}\\hat{\\theta}_{i}$。\n- 该估计量必须是无偏的。\n- 权重 $w_i$ 必须满足约束条件 $\\sum_{i=1}^{k} w_{i} = 1$。\n- 目标是找到使 $\\tilde{\\theta}$ 的方差最小化的权重 $w_i$。\n- 推导过程必须仅使用期望、方差的基本性质以及基本的约束优化方法。\n- 最终答案必须提供最优估计量 $\\tilde{\\theta}$ 及其方差 $\\operatorname{Var}(\\tilde{\\theta})$ 的表达式。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题是荟萃分析（meta-analysis）领域的一个基础且经典的推导，荟萃分析是生物统计学的一个核心子学科。它描述了逆方差加权平均的推导过程，这是一种在固定效应模型下合并证据的标准方法。所引用的所有原理——无偏估计量、独立随机变量线性组合的方差以及约束优化——都是数理统计学的基础。\n- **适定性**：该问题是适定的。它要求在一个线性约束（一个超平面）上最小化一个凸函数（权重的二次型）。这保证了唯一最小值的存在，可以使用标准方法（如拉格朗日乘子法）找到。条件 $\\sigma_{i}^{2}  0$ 确保不会发生除以零的情况。\n- **目标**：问题以精确、无歧义的数学语言陈述。\n- **结论**：该问题没有科学、逻辑或结构上的缺陷。它是有效的。\n\n### 第 3 步：结论与行动\n问题被认为是有效的。将提供完整的解答。\n\n### 解答推导\n目标是找到一组权重 $\\{w_1, w_2, \\dots, w_k\\}$，使得组合估计量 $\\tilde{\\theta} = \\sum_{i=1}^{k} w_{i}\\hat{\\theta}_{i}$ 的方差最小，同时满足该估计量是无偏的条件。\n\n首先，我们验证无偏性条件。利用期望算子的线性性质以及每个 $\\hat{\\theta}_i$ 都是 $\\theta$ 的无偏估计量（$\\mathbb{E}[\\hat{\\theta}_i] = \\theta$）这一事实，我们有：\n$$\n\\mathbb{E}[\\tilde{\\theta}] = \\mathbb{E}\\left[\\sum_{i=1}^{k} w_{i}\\hat{\\theta}_{i}\\right] = \\sum_{i=1}^{k} w_{i}\\mathbb{E}[\\hat{\\theta}_{i}] = \\sum_{i=1}^{k} w_{i}\\theta = \\theta \\left(\\sum_{i=1}^{k} w_{i}\\right)\n$$\n为了使 $\\tilde{\\theta}$ 成为 $\\theta$ 的无偏估计量，我们必须有 $\\mathbb{E}[\\tilde{\\theta}] = \\theta$，这要求 $\\sum_{i=1}^{k} w_{i} = 1$。这个约束条件在问题陈述中已经给出。\n\n接下来，我们推导 $\\tilde{\\theta}$ 的方差。由于估计量 $\\hat{\\theta}_i$ 相互独立，它们的加权和的方差等于它们方差的加权和，其中权重是平方的。\n$$\n\\operatorname{Var}(\\tilde{\\theta}) = \\operatorname{Var}\\left(\\sum_{i=1}^{k} w_{i}\\hat{\\theta}_{i}\\right) = \\sum_{i=1}^{k} \\operatorname{Var}(w_{i}\\hat{\\theta}_{i}) = \\sum_{i=1}^{k} w_{i}^{2}\\operatorname{Var}(\\hat{\\theta}_{i})\n$$\n代入已知的方差 $\\operatorname{Var}(\\hat{\\theta}_{i}) = \\sigma_{i}^{2}$，需要最小化的表达式是：\n$$\nV(w_1, \\dots, w_k) = \\sum_{i=1}^{k} w_{i}^{2}\\sigma_{i}^{2}\n$$\n这是我们的目标函数。最小化受约束条件 $g(w_1, \\dots, w_k) = \\sum_{i=1}^{k} w_{i} - 1 = 0$ 的限制。\n\n我们使用拉格朗日乘子法。拉格朗日函数 $\\mathcal{L}$ 定义为：\n$$\n\\mathcal{L}(w_1, \\dots, w_k, \\lambda) = \\sum_{i=1}^{k} w_{i}^{2}\\sigma_{i}^{2} - \\lambda\\left(\\sum_{i=1}^{k} w_{i} - 1\\right)\n$$\n为了找到最优权重，我们对 $\\mathcal{L}$ 关于每个权重 $w_j$ 求偏导数，并令其为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w_j} = 2w_j\\sigma_{j}^{2} - \\lambda = 0 \\quad \\text{for } j = 1, \\dots, k\n$$\n由于给定 $\\sigma_{j}^{2}  0$，我们可以解出 $w_j$：\n$$\nw_j = \\frac{\\lambda}{2\\sigma_{j}^{2}}\n$$\n这个结果表明，每个研究估计量的最优权重与其方差成反比。\n\n为了确定拉格朗日乘子 $\\lambda$ 的值，我们将 $w_j$ 的这个表达式代回约束方程 $\\sum_{j=1}^{k} w_{j} = 1$ 中：\n$$\n\\sum_{j=1}^{k} \\frac{\\lambda}{2\\sigma_{j}^{2}} = 1\n$$\n提出包含 $\\lambda$ 的常数项：\n$$\n\\frac{\\lambda}{2} \\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}} = 1\n$$\n解出 $\\lambda$：\n$$\n\\lambda = \\frac{2}{\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}}\n$$\n现在，通过将 $\\lambda$ 的表达式代回 $w_i$ 的方程，我们可以找到最优权重 $w_i$ 的显式形式：\n$$\nw_i = \\frac{1}{2\\sigma_{i}^{2}} \\left( \\frac{2}{\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}} \\right) = \\frac{\\frac{1}{\\sigma_{i}^{2}}}{\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}}\n$$\n为了清晰起见，我们可以在分母的和式中使用相同的索引 $i$，因为它是一个定和：\n$$\nw_i = \\frac{\\frac{1}{\\sigma_{i}^{2}}}{\\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}}\n$$\n因此，最小方差估计量，记作 $\\tilde{\\theta}_{MVUE}$ (最小方差无偏估计量)，为：\n$$\n\\tilde{\\theta} = \\sum_{i=1}^{k} w_{i}\\hat{\\theta}_{i} = \\sum_{i=1}^{k} \\left( \\frac{\\frac{1}{\\sigma_{i}^{2}}}{\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}} \\right) \\hat{\\theta}_{i} = \\frac{\\sum_{i=1}^{k} \\frac{\\hat{\\theta}_{i}}{\\sigma_{i}^{2}}}{\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}}\n$$\n\n最后，我们计算这个最优估计量的方差 $\\operatorname{Var}(\\tilde{\\theta})$。我们使用方差的通用公式并代入我们的最优权重：\n$$\n\\operatorname{Var}(\\tilde{\\theta}) = \\sum_{i=1}^{k} w_{i}^{2}\\sigma_{i}^{2} = \\sum_{i=1}^{k} \\left( \\frac{\\frac{1}{\\sigma_{i}^{2}}}{\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}} \\right)^{2} \\sigma_{i}^{2}\n$$\n$$\n\\operatorname{Var}(\\tilde{\\theta}) = \\sum_{i=1}^{k} \\frac{\\frac{1}{\\sigma_{i}^{4}}}{\\left(\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}\\right)^{2}} \\sigma_{i}^{2} = \\frac{1}{\\left(\\sum_{j=1}^{k} \\frac{1}{\\sigma_{j}^{2}}\\right)^{2}} \\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}\n$$\n分子中的项 $\\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}$ 与分母中一个相同的项相消，得到方差的最终结果：\n$$\n\\operatorname{Var}(\\tilde{\\theta}) = \\frac{1}{\\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}}\n$$\n这表明组合估计量的精度（方差的倒数）是各个精度的总和。\n\n最终答案由最优估计量 $\\tilde{\\theta}$ 及其方差 $\\operatorname{Var}(\\tilde{\\theta})$ 组成。\n估计量为 $\\tilde{\\theta} = \\frac{\\sum_{i=1}^{k} \\frac{\\hat{\\theta}_{i}}{\\sigma_{i}^{2}}}{\\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}}$。\n方差为 $\\operatorname{Var}(\\tilde{\\theta}) = \\frac{1}{\\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sum_{i=1}^{k} \\frac{\\hat{\\theta}_{i}}{\\sigma_{i}^{2}}}{\\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}}  \\frac{1}{\\sum_{i=1}^{k} \\frac{1}{\\sigma_{i}^{2}}} \\end{pmatrix}}\n$$", "id": "4943456"}, {"introduction": "算术平均的一个基本性质是其方差的计算（$\\operatorname{Var}(\\bar{Y}) = \\frac{\\sigma^2}{n}$）依赖于数据点的独立性假设，但在许多生物医学研究中，数据是“聚类”的（例如，来自同一家医院的患者），这导致了组内观测值存在相关性。本练习将探讨分层数据结构对样本均值性质的影响，你将推导组内相关系数 (ICC) 并计算聚类平均值方差的精确表达式 [@problem_id:4943405]。这个过程揭示了为什么在处理非独立数据时，必须修正对平均值变异性的估计，这是设计和分析聚类研究的关键一步。", "problem": "一项公共卫生研究从 $K$ 个社区诊所收集一种连续生物标志物。在诊所 $j \\in \\{1,\\dots,K\\}$ 中，有 $m_j$ 名个体，索引为 $i \\in \\{1,\\dots,m_j\\}$。测量值 $Y_{ij}$ 由一个两水平随机截距模型建模：\n\n$$\nY_{ij} \\;=\\; \\mu \\;+\\; b_j \\;+\\; \\varepsilon_{ij},\n$$\n\n其中 $\\mu$ 是一个未知常数，$b_j$ 是诊所特异性随机截距，满足 $\\mathbb{E}[b_j]=0$ 和 $\\operatorname{Var}(b_j)=\\tau^2$，而 $\\varepsilon_{ij}$ 是个体水平的残差，满足 $\\mathbb{E}[\\varepsilon_{ij}]=0$ 和 $\\operatorname{Var}(\\varepsilon_{ij})=\\sigma^2$。假设 $\\{b_j\\}$ 在各诊所间独立，$\\{\\varepsilon_{ij}\\}$ 在所有个体和诊所间独立，且对于所有的 $i,j$，$b_j$ 与 $\\varepsilon_{ij}$ 独立。令 $\\sigma_Y^2 := \\operatorname{Var}(Y_{ij})$ 表示单个观测值的边际方差。\n\n定义诊所内算术平均值为 $\\bar{Y}_j := \\frac{1}{m_j}\\sum_{i=1}^{m_j} Y_{ij}$，并定义等权重聚类平均均值\n\n$$\nM \\;:=\\; \\frac{1}{K} \\sum_{j=1}^{K} \\bar{Y}_j.\n$$\n\n\n任务：\n- 仅使用协方差和相关性的定义，将该模型的组内相关系数 (ICC) $\\rho$ 定义为从同一诊所抽样的两个不同观测值之间的相关性，并用 $\\tau^2$ 和 $\\sigma^2$ 表示 $\\rho$。\n- 然后，推导 $\\operatorname{Var}(M)$ 的一个闭式表达式，用 $\\rho$、$\\sigma_Y^2$、$K$ 以及诊所内样本量 $\\{m_j\\}_{j=1}^{K}$ 来表示。您可以先用 $\\tau^2$ 和 $\\sigma^2$ 进行计算，然后再重新参数化。\n\n将您的最终答案表示为 $\\operatorname{Var}(M)$ 关于 $\\rho$、$\\sigma_Y^2$、$K$ 和 $\\{m_j\\}$ 的单一解析表达式。不需要进行数值舍入。", "solution": "问题陈述具有科学依据，提法恰当且客观。它代表了分层线性模型理论中的一个标准推导。我们开始解答。\n\n问题分为两个任务。第一，定义并推导组内相关系数 (ICC) $\\rho$；第二，推导聚类平均均值的方差 $\\operatorname{Var}(M)$。\n\n**任务1：推导组内相关系数 ($\\rho$)**\n\n组内相关系数 (ICC) 定义为从同一诊所 $j$ 抽取的两个不同观测值 $Y_{ij}$ 和 $Y_{i'j}$ 之间的相关性，其中 $i \\neq i'$。相关性的公式是 $\\operatorname{Corr}(X, Z) = \\frac{\\operatorname{Cov}(X, Z)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Z)}}$。\n\n首先，我们确定单个观测值的边际方差 $\\sigma_Y^2 = \\operatorname{Var}(Y_{ij})$。观测值的模型是 $Y_{ij} = \\mu + b_j + \\varepsilon_{ij}$。\n由于 $\\mu$ 是一个常数，其方差为零。随机项 $b_j$ 和 $\\varepsilon_{ij}$ 假设是独立的。因此，它们之和的方差是它们各自方差之和：\n$$\n\\sigma_Y^2 = \\operatorname{Var}(Y_{ij}) = \\operatorname{Var}(\\mu + b_j + \\varepsilon_{ij}) = \\operatorname{Var}(b_j + \\varepsilon_{ij}) = \\operatorname{Var}(b_j) + \\operatorname{Var}(\\varepsilon_{ij})\n$$\n使用给定的方差，我们得到：\n$$\n\\sigma_Y^2 = \\tau^2 + \\sigma^2\n$$\n这是任何单个观测值的总方差。\n\n接下来，我们计算来自同一诊所的两个不同观测值之间的协方差，即 $\\operatorname{Cov}(Y_{ij}, Y_{i'j})$，其中 $i \\neq i'$。\n$$\n\\operatorname{Cov}(Y_{ij}, Y_{i'j}) = \\operatorname{Cov}(\\mu + b_j + \\varepsilon_{ij}, \\mu + b_j + \\varepsilon_{i'j})\n$$\n利用协方差的双线性性质，并注意到 $\\mu$ 是一个常数：\n$$\n\\operatorname{Cov}(Y_{ij}, Y_{i'j}) = \\operatorname{Cov}(b_j + \\varepsilon_{ij}, b_j + \\varepsilon_{i'j}) = \\operatorname{Cov}(b_j, b_j) + \\operatorname{Cov}(b_j, \\varepsilon_{i'j}) + \\operatorname{Cov}(\\varepsilon_{ij}, b_j) + \\operatorname{Cov}(\\varepsilon_{ij}, \\varepsilon_{i'j})\n$$\n我们计算每一项：\n- $\\operatorname{Cov}(b_j, b_j) = \\operatorname{Var}(b_j) = \\tau^2$。\n- 根据假设，$b_j$ 与所有的 $\\varepsilon_{ik}$ 独立，所以 $\\operatorname{Cov}(b_j, \\varepsilon_{i'j}) = 0$ 且 $\\operatorname{Cov}(\\varepsilon_{ij}, b_j) = 0$。\n- 对于诊所内的不同个体 ($i \\neq i'$)，残差 $\\varepsilon_{ij}$ 和 $\\varepsilon_{i'j}$ 是独立的，所以 $\\operatorname{Cov}(\\varepsilon_{ij}, \\varepsilon_{i'j}) = 0$。\n\n将这些项相加，得到协方差：\n$$\n\\operatorname{Cov}(Y_{ij}, Y_{i'j}) = \\tau^2 + 0 + 0 + 0 = \\tau^2\n$$\n同一诊所内两个观测值之间的协方差是诊所间方差 $\\tau^2$。\n\n现在我们可以计算 ICC, $\\rho$：\n$$\n\\rho = \\operatorname{Corr}(Y_{ij}, Y_{i'j}) = \\frac{\\operatorname{Cov}(Y_{ij}, Y_{i'j})}{\\sqrt{\\operatorname{Var}(Y_{ij}) \\operatorname{Var}(Y_{i'j})}}\n$$\n由于所有观测值的方差是恒定的，$\\operatorname{Var}(Y_{ij}) = \\operatorname{Var}(Y_{i'j}) = \\sigma_Y^2 = \\tau^2 + \\sigma^2$。\n$$\n\\rho = \\frac{\\tau^2}{\\sqrt{(\\tau^2 + \\sigma^2)(\\tau^2 + \\sigma^2)}} = \\frac{\\tau^2}{\\tau^2 + \\sigma^2}\n$$\nICC, $\\rho$，是总方差中可归因于诊所间变异的部分。\n\n**任务2：推导 $\\operatorname{Var}(M)$**\n\n聚类平均均值定义为 $M = \\frac{1}{K} \\sum_{j=1}^{K} \\bar{Y}_j$。我们需要求其方差 $\\operatorname{Var}(M)$。\n$$\n\\operatorname{Var}(M) = \\operatorname{Var}\\left(\\frac{1}{K} \\sum_{j=1}^{K} \\bar{Y}_j\\right) = \\frac{1}{K^2} \\operatorname{Var}\\left(\\sum_{j=1}^{K} \\bar{Y}_j\\right)\n$$\n项 $\\bar{Y}_j$ 是来自不同诊所的观测值的平均值。由于随机截距 $\\{b_j\\}$ 在各诊所间独立，且残差 $\\{\\varepsilon_{ij}\\}$ 在所有个体和诊所间独立，所以从不相交的诊所集合中派生出的任何量都是独立的。因此，当 $j \\neq j'$ 时，$\\bar{Y}_j$ 和 $\\bar{Y}_{j'}$ 是独立的。\n对于独立的随机变量，和的方差等于方差的和：\n$$\n\\operatorname{Var}(M) = \\frac{1}{K^2} \\sum_{j=1}^{K} \\operatorname{Var}(\\bar{Y}_j)\n$$\n现在，我们必须求出单个诊所内平均值的方差 $\\operatorname{Var}(\\bar{Y}_j)$。\n首先，用模型的分量来表示 $\\bar{Y}_j$：\n$$\n\\bar{Y}_j = \\frac{1}{m_j}\\sum_{i=1}^{m_j} Y_{ij} = \\frac{1}{m_j}\\sum_{i=1}^{m_j} (\\mu + b_j + \\varepsilon_{ij}) = \\frac{1}{m_j} (m_j\\mu + m_j b_j + \\sum_{i=1}^{m_j} \\varepsilon_{ij}) = \\mu + b_j + \\bar{\\varepsilon}_j\n$$\n其中 $\\bar{\\varepsilon}_j = \\frac{1}{m_j}\\sum_{i=1}^{m_j} \\varepsilon_{ij}$。\n现在，我们计算 $\\bar{Y}_j$ 的方差：\n$$\n\\operatorname{Var}(\\bar{Y}_j) = \\operatorname{Var}(\\mu + b_j + \\bar{\\varepsilon}_j)\n$$\n由于 $\\mu$ 是一个常数，且 $b_j$ 与所有的 $\\varepsilon_{ik}$ 独立（因此也与其均值 $\\bar{\\varepsilon}_j$ 独立），这可以简化为：\n$$\n\\operatorname{Var}(\\bar{Y}_j) = \\operatorname{Var}(b_j) + \\operatorname{Var}(\\bar{\\varepsilon}_j) = \\tau^2 + \\operatorname{Var}\\left(\\frac{1}{m_j}\\sum_{i=1}^{m_j} \\varepsilon_{ij}\\right)\n$$\n各个残差 $\\varepsilon_{ij}$ 是独立的，所以我们有：\n$$\n\\operatorname{Var}\\left(\\frac{1}{m_j}\\sum_{i=1}^{m_j} \\varepsilon_{ij}\\right) = \\frac{1}{m_j^2} \\operatorname{Var}\\left(\\sum_{i=1}^{m_j} \\varepsilon_{ij}\\right) = \\frac{1}{m_j^2} \\sum_{i=1}^{m_j} \\operatorname{Var}(\\varepsilon_{ij}) = \\frac{1}{m_j^2} \\sum_{i=1}^{m_j} \\sigma^2 = \\frac{m_j \\sigma^2}{m_j^2} = \\frac{\\sigma^2}{m_j}\n$$\n将此代回，我们得到诊所内平均值的方差：\n$$\n\\operatorname{Var}(\\bar{Y}_j) = \\tau^2 + \\frac{\\sigma^2}{m_j}\n$$\n最后，我们将其代入 $\\operatorname{Var}(M)$ 的表达式中：\n$$\n\\operatorname{Var}(M) = \\frac{1}{K^2} \\sum_{j=1}^{K} \\left(\\tau^2 + \\frac{\\sigma^2}{m_j}\\right)\n$$\n最后一步是用 $\\rho = \\frac{\\tau^2}{\\tau^2+\\sigma^2}$ 和 $\\sigma_Y^2 = \\tau^2+\\sigma^2$ 对该表达式进行重新参数化。\n从这些定义中，我们可以将 $\\tau^2$ 和 $\\sigma^2$ 写为：\n$$\n\\tau^2 = \\rho \\sigma_Y^2\n$$\n$$\n\\sigma^2 = \\sigma_Y^2 - \\tau^2 = \\sigma_Y^2 - \\rho \\sigma_Y^2 = (1-\\rho)\\sigma_Y^2\n$$\n现在，将这些代入 $\\operatorname{Var}(M)$ 的表达式中：\n$$\n\\operatorname{Var}(M) = \\frac{1}{K^2} \\sum_{j=1}^{K} \\left(\\rho \\sigma_Y^2 + \\frac{(1-\\rho)\\sigma_Y^2}{m_j}\\right)\n$$\n我们可以从求和中提出公因式 $\\sigma_Y^2$：\n$$\n\\operatorname{Var}(M) = \\frac{\\sigma_Y^2}{K^2} \\sum_{j=1}^{K} \\left(\\rho + \\frac{1-\\rho}{m_j}\\right)\n$$\n这就是 $\\operatorname{Var}(M)$ 关于所要求的量：$\\rho$、$\\sigma_Y^2$、$K$ 以及诊所内样本量集合 $\\{m_j\\}_{j=1}^{K}$ 的最终闭式表达式。", "answer": "$$\\boxed{\\frac{\\sigma_Y^2}{K^2} \\sum_{j=1}^{K} \\left(\\rho + \\frac{1-\\rho}{m_j}\\right)}$$", "id": "4943405"}]}