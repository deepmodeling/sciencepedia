{"hands_on_practices": [{"introduction": "伽马分布在生物统计学中常用于模拟正值变量，如等待时间或生物标志物的浓度。通过这个练习，我们将运用微积分的基本原理来推导其众数。这个过程不仅能巩固你寻找函数最大值的能力，还能揭示分布的形状（如单峰或J形）是如何由其参数决定的 [@problem_id:4909555]。", "problem": "一位生物统计学家用形状参数为 $\\alpha0$、尺度参数为 $\\theta0$ 的伽马分布来为一个正值生物标志物建模。伽马分布的概率密度函数（PDF）对于 $x0$ 定义如下：\n$$\nf(x;\\alpha,\\theta)=\\frac{x^{\\alpha-1}\\exp(-x/\\theta)}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}}.\n$$\n从众数是使其概率密度函数（PDF）在其定义域上最大化的 $x$ 值的基本定义出发，利用第一性原理推导众数的位置作为 $\\alpha$ 和 $\\theta$ 的函数。然后，使用你的推导来分类当 $\\alpha\\leq 1$ 时与 $\\alpha1$ 时分布的模态。\n\n请以一个单一的闭式解析表达式给出最终答案，该表达式给出众数 $m(\\alpha,\\theta)$ 与 $\\alpha$ 和 $\\theta$ 的关系，并根据 $\\alpha\\leq 1$ 和 $\\alpha1$ 的范围分段写出。不需要进行数值舍入，最终表达式中也不应包含单位。", "solution": "经评估，该问题陈述有效。它在概率论中有科学依据，是适定且客观的。它提出了数理统计中的一个标准问题，没有任何事实上的不健全、模糊或矛盾之处。\n\n目标是求伽马分布的众数，即随机变量 $x$ 使概率密度函数(PDF)最大化的值。生物标志物的定义域为正值，因此我们寻求 $f(x;\\alpha,\\theta)$ 在 $x \\in (0, \\infty)$ 上的最大值。PDF 由下式给出：\n$$\nf(x;\\alpha,\\theta)=\\frac{x^{\\alpha-1}\\exp(-x/\\theta)}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}}\n$$\n其中形状参数 $\\alpha  0$ 且尺度参数 $\\theta  0$。\n\n为了找到 $f(x;\\alpha,\\theta)$ 的最大值，通常更方便的是找到其自然对数 $\\ln(f(x;\\alpha,\\theta))$ 的最大值，因为对数函数是严格递增函数。最大化 $\\ln(f(x))$ 将得到与最大化 $f(x)$ 相同的 $x$ 值。令 $L(x) = \\ln(f(x;\\alpha,\\theta))$。\n$$\nL(x) = \\ln\\left(\\frac{x^{\\alpha-1}\\exp(-x/\\theta)}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}}\\right)\n$$\n使用对数的性质，我们可以展开这个表达式：\n$$\nL(x) = (\\alpha-1)\\ln(x) - \\frac{x}{\\theta} - \\ln(\\Gamma(\\alpha)) - \\alpha\\ln(\\theta)\n$$\n项 $-\\ln(\\Gamma(\\alpha)) - \\alpha\\ln(\\theta)$ 是关于 $x$ 的常数。为了找到使 $L(x)$ 最大化的 $x$ 值，我们求 $L(x)$ 对 $x$ 的一阶导数，并令其为零。\n$$\n\\frac{dL}{dx} = \\frac{d}{dx}\\left( (\\alpha-1)\\ln(x) - \\frac{x}{\\theta} - \\text{constant} \\right) = \\frac{\\alpha-1}{x} - \\frac{1}{\\theta}\n$$\n令导数为零可以得到在定义域 $x0$ 内的任何临界点的位置：\n$$\n\\frac{\\alpha-1}{x} - \\frac{1}{\\theta} = 0\n$$\n$$\n\\frac{\\alpha-1}{x} = \\frac{1}{\\theta}\n$$\n如果 $\\alpha-1 \\neq 0$，我们可以解出 $x$：\n$$\nx = \\theta(\\alpha-1)\n$$\n这个临界点只有在它位于分布的定义域内时才有意义，即要求 $x  0$。因为 $\\theta  0$，所以这个条件当且仅当 $\\alpha-1  0$，即 $\\alpha  1$ 时成立。\n\n现在，我们必须确定这个临界点对应的是最大值、最小值还是鞍点。我们使用二阶导数检验。$L(x)$ 对 $x$ 的二阶导数是：\n$$\n\\frac{d^2L}{dx^2} = \\frac{d}{dx}\\left( (\\alpha-1)x^{-1} - \\frac{1}{\\theta} \\right) = -(\\alpha-1)x^{-2} = -\\frac{\\alpha-1}{x^2}\n$$\n要使临界点为局部最大值，在该点计算的二阶导数必须为负。鉴于对于 $x  0$，$x^2$ 总是正的，二阶导数的符号由 $-(\\alpha-1)$ 的符号决定。\n如果 $\\alpha  1$，则 $\\alpha-1  0$，且 $\\frac{d^2L}{dx^2} = -\\frac{\\alpha-1}{x^2}  0$。\n这证实了当 $\\alpha  1$ 时，函数在 $x = \\theta(\\alpha-1)$ 处有一个唯一的局部最大值。由于这是定义域 $(0, \\infty)$ 内唯一的临界点，并且当 $x \\to 0^+$ (因为 $\\alpha-1  0$) 和 $x \\to \\infty$ 时，函数 $f(x)$ 趋近于 $0$，因此这个局部最大值就是全局最大值。\n因此，当 $\\alpha  1$ 时，分布的众数是 $m = \\theta(\\alpha-1)$。该分布是单峰的，其峰值位于其支撑集的内部。\n\n接下来，我们必须分析 $\\alpha \\leq 1$ 的情况。\n\n情况1：$\\alpha = 1$。\n在这种情况下，对数概率密度函数的一阶导数是：\n$$\n\\frac{dL}{dx} = \\frac{1-1}{x} - \\frac{1}{\\theta} = -\\frac{1}{\\theta}\n$$\n因为 $\\theta  0$，所以对于所有 $x  0$，导数 $\\frac{dL}{dx}$ 是一个负常数。这意味着函数 $L(x)$ (以及 $f(x)$) 在其整个定义域 $(0, \\infty)$ 上是严格递减的。对于一个在 $(0, \\infty)$ 上严格递减的函数，当 $x$ 趋近于定义域的左边界 $x \\to 0^+$ 时，函数值趋近于最大值。因此，众数位于 $x=0$。在这种情况下，伽马分布简化为指数分布，已知其众数在 $x=0$。\n\n情况2：$0  \\alpha  1$。\n在这种情况下，项 $\\alpha-1$ 是负的。一阶导数是：\n$$\n\\frac{dL}{dx} = \\frac{\\alpha-1}{x} - \\frac{1}{\\theta}\n$$\n因为 $\\alpha-1  0$、$x  0$ 且 $\\theta  0$，所以 $\\frac{\\alpha-1}{x}$ 和 $-\\frac{1}{\\theta}$ 这两项都是负的。因此，它们的和对于所有 $x \\in (0, \\infty)$ 总是负的。\n$$\n\\frac{dL}{dx}  0 \\quad \\text{for all } x0\n$$\n与 $\\alpha=1$ 的情况一样，函数 $f(x)$ 在其整个定义域上是严格递减的。最大值同样在 $x \\to 0^+$ 时趋近。因此，众数位于 $x=0$。在这个范围内，当 $\\alpha  1$ 且 $x \\to 0^+$ 时，$x^{\\alpha-1} \\to \\infty$，所以概率密度函数在 $x=0$ 处有一条垂直渐近线。\n\n总之，我们可以根据 $\\alpha$ 的值对模态进行分类：\n- 如果 $\\alpha  1$，分布是单峰的，在 $m = \\theta(\\alpha-1)$ 处有唯一众数。PDF 从 $0$ 开始，上升到一个峰值，然后衰减。\n- 如果 $0  \\alpha \\leq 1$，PDF 从其在 $x=0$ 处的最大值（或上确界）开始严格递减。众数在 $m=0$。这包括指数分布（$\\alpha=1$）和其他 J 形分布。\n\n结合这些结果，我们可以将众数的位置 $m(\\alpha, \\theta)$ 写成关于参数 $\\alpha$ 和 $\\theta$ 的分段函数：\n$$\nm(\\alpha, \\theta) = \\begin{cases} \\theta(\\alpha-1)  \\text{if } \\alpha  1 \\\\ 0  \\text{if } 0  \\alpha \\leq 1 \\end{cases}\n$$\n该表达式提供了所要求的完整解。", "answer": "$$\n\\boxed{\n\\begin{cases}\n\\theta(\\alpha-1)  \\text{if } \\alpha  1 \\\\\n0  \\text{if } 0  \\alpha \\leq 1\n\\end{cases}\n}\n$$", "id": "4909555"}, {"introduction": "与连续分布不同，离散分布（如负二项分布）的众数不能通过求导得到。本练习将介绍一种分析离散数据的新方法：检验连续概率值的比率。通过为临床试验中的计数数据建模，你将学会如何确定离散分布的众数，并处理可能出现多个相邻众数的边界效应 [@problem_id:4909516]。", "problem": "一个生物统计学团队对一项序贯临床试验中观察到的第 $r$ 个应答者出现之前的无应答者数量进行建模，其中每位患者以概率 $p \\in (0,1)$ 独立地产生应答。令 $K$ 表示在第 $r$ 个应答者出现之前观察到的无应答者的随机数量。根据负二项分布的标准定义，$K$ 的概率质量函数 (PMF) 由下式给出：\n$$\n\\Pr(K=k) \\;=\\; \\binom{k+r-1}{k} \\, p^{r} \\, (1-p)^{k}, \\quad k \\in \\{0,1,2,\\dots\\}, \\quad r \\in \\{1,2,3,\\dots\\}, \\quad p \\in (0,1).\n$$\n请仅从此 PMF 出发，并利用序列的基本性质，通过检验连续概率的比值来证明 $K$ 的分布是单峰的。然后，推导最大众数（即最大化 $\\Pr(K=k)$ 的最大整数 $k$）的闭式表达式，并仔细处理可能在相邻整数上产生相等最大概率的两点平台的离散边界效应。\n\n请以 $r$ 和 $p$ 的单个闭式表达式的形式提供您的最终答案。无需进行数值计算。如果您的推导在出现平局的情况下得到多个候选众数，请报告最大的众数。不涉及单位，也无需进行四舍五入。", "solution": "问题要求从给定的概率质量函数 (PMF) 出发，证明负二项分布的单峰性，并推导其最大众数的闭式表达式。随机变量 $K$ 代表在第 $r$ 个应答者出现之前的无应答者数量，其中应答的概率为 $p$。其 PMF 如下所示：\n$$\n\\Pr(K=k) = \\binom{k+r-1}{k} p^{r} (1-p)^{k}, \\quad k \\in \\{0, 1, 2, \\dots\\}\n$$\n\n如果一个离散分布的概率 $\\Pr(K=k)$ 先递增至一个最大值（或一个最大值平台），然后递减，则该分布是单峰的。为了分析这种行为，我们考察 $k \\in \\{1, 2, 3, \\dots\\}$ 时连续概率的比值 $R(k) = \\frac{\\Pr(K=k)}{\\Pr(K=k-1)}$。\n\n该比值的构造如下：\n$$\nR(k) = \\frac{\\Pr(K=k)}{\\Pr(K=k-1)} = \\frac{\\binom{k+r-1}{k} p^{r} (1-p)^{k}}{\\binom{(k-1)+r-1}{k-1} p^{r} (1-p)^{k-1}} = \\frac{\\binom{k+r-1}{k}}{\\binom{k+r-2}{k-1}} (1-p)\n$$\n我们使用阶乘定义 $\\binom{n}{m} = \\frac{n!}{m!(n-m)!}$ 来化简二项式系数的比值：\n$$\n\\frac{\\binom{k+r-1}{k}}{\\binom{k+r-2}{k-1}} = \\frac{\\frac{(k+r-1)!}{k!(r-1)!}}{\\frac{(k+r-2)!}{(k-1)!(r-1)!}} = \\frac{(k+r-1)!}{k!(r-1)!} \\cdot \\frac{(k-1)!(r-1)!}{(k+r-2)!} = \\frac{k+r-1}{k}\n$$\n将此结果代回 $R(k)$ 的表达式中：\n$$\nR(k) = \\frac{k+r-1}{k} (1-p)\n$$\n该比值的大小决定了概率如何从 $k-1$ 变化到 $k$：\n- 如果 $R(k) > 1$，则 $\\Pr(K=k) > \\Pr(K=k-1)$，概率序列是递增的。\n- 如果 $R(k)  1$，则 $\\Pr(K=k)  \\Pr(K=k-1)$，概率序列是递减的。\n- 如果 $R(k) = 1$，则 $\\Pr(K=k) = \\Pr(K=k-1)$，表明存在一个平台。\n\n让我们找出概率递增的条件：\n$$\nR(k) > 1 \\implies \\frac{k+r-1}{k} (1-p) > 1\n$$\n由于 $k \\ge 1$ 且 $p \\in (0,1)$，所以 $k$ 和 $1-p$ 均为正数，因此我们可以进行乘法运算而不改变不等号的方向：\n$$\n(k+r-1)(1-p) > k\n$$\n$$\nk(1-p) + (r-1)(1-p) > k\n$$\n$$\n(r-1)(1-p) > k - k(1-p)\n$$\n$$\n(r-1)(1-p) > k(1 - (1-p))\n$$\n$$\n(r-1)(1-p) > kp\n$$\n$$\nk  \\frac{(r-1)(1-p)}{p}\n$$\n反之，当 $k > \\frac{(r-1)(1-p)}{p}$ 时，概率是递减的，即 $R(k)  1$；当 $k = \\frac{(r-1)(1-p)}{p}$ 时，概率相等，即 $R(k) = 1$。\n\n令临界值为 $C = \\frac{(r-1)(1-p)}{p}$。由于 $r \\ge 1$ 且 $p \\in (0,1)$，我们有 $C \\ge 0$。概率序列 $\\Pr(K=k)$ 对于所有 $k  C$ 的情况是递增的，对于所有 $k > C$ 的情况是递减的。这证实了该分布是单峰的。\n\n众数，记为 $k_{mode}$，是使 $\\Pr(K=k)$ 最大化的整数 $k$ 值。一个众数 $k_{mode}$ 必须满足两个条件：$\\Pr(K=k_{mode}) \\ge \\Pr(K=k_{mode}-1)$ 和 $\\Pr(K=k_{mode}) \\ge \\Pr(K=k_{mode}+1)$。对于 $k \\ge 1$，这些条件可以转化为 $R(k_{mode}) \\ge 1$ 和 $R(k_{mode}+1) \\le 1$。\n\n条件 $R(k_{mode}) \\ge 1$ 意味着：\n$$\nk_{mode} \\le \\frac{(r-1)(1-p)}{p} = C\n$$\n条件 $R(k_{mode}+1) \\le 1$ 意味着：\n$$\nk_{mode}+1 \\ge \\frac{(r-1)(1-p)}{p} = C\n$$\n$$\nk_{mode} \\ge C - 1\n$$\n结合这两个不等式，任何众数 $k_{mode}$ 都必须是满足以下条件的整数：\n$$\nC - 1 \\le k_{mode} \\le C\n$$\n现在我们根据 $C$ 的值分两种情况进行分析。\n\n情况 1：$C = \\frac{(r-1)(1-p)}{p}$ 不是整数。\n在这种情况下，区间 $(C-1, C)$ 中只有一个整数 $k$，即 $k = \\lfloor C \\rfloor$。不等式 $k_{mode}  C$ 和 $k_{mode} > C-1$ 是严格的。\n因此，对于 $k \\le \\lfloor C \\rfloor$，有 $R(k) > 1$；对于 $k \\ge \\lfloor C \\rfloor + 1$，有 $R(k)  1$。\n概率序列在达到 $\\lfloor C \\rfloor$ 之前是严格递增的，此后是严格递减的：\n$$\n\\Pr(K=0)  \\dots  \\Pr(K=\\lfloor C \\rfloor - 1)  \\Pr(K=\\lfloor C \\rfloor) > \\Pr(K=\\lfloor C \\rfloor + 1) > \\dots\n$$\n因此，存在唯一的众数，即 $k_{mode} = \\lfloor C \\rfloor$。\n\n情况 2：$C = \\frac{(r-1)(1-p)}{p}$ 是一个整数。\n在这种情况下，条件 $k=C$ 给出 $R(C) = 1$，这意味着 $\\Pr(K=C) = \\Pr(K=C-1)$。\n对于 $k  C$，我们有 $R(k) > 1$，因此概率在达到 $k=C-1$ 之前是严格递增的。\n对于 $k > C$，我们有 $R(k)  1$，因此概率在 $k \\ge C+1$ 时是严格递减的。\n概率序列为：\n$$\n\\Pr(K=0)  \\dots  \\Pr(K=C-2)  \\Pr(K=C-1) = \\Pr(K=C) > \\Pr(K=C+1) > \\dots\n$$\n该分布有一个由最大概率构成的两点平台。两个众数是 $C-1$ 和 $C$。问题要求的是最大的众数，即 $C$。\n\n我们可以将这两种情况统一为一个表达式。\n- 在情况 1（C 不是整数）中，最大的众数是 $\\lfloor C \\rfloor$。\n- 在情况 2（C 是整数）中，最大的众数是 $C$。由于 $C$ 是整数，所以 $C = \\lfloor C \\rfloor$。\n在这两种情况下，最大化 $\\Pr(K=k)$ 的最大整数 $k$ 都由 $C$ 的下取整函数给出。\n\n因此，最大众数的闭式表达式为：\n$$\nk_{mode, max} = \\left\\lfloor \\frac{(r-1)(1-p)}{p} \\right\\rfloor\n$$\n这个公式对所有 $r \\in \\{1, 2, 3, \\dots\\}$ 都有效。例如，如果 $r=1$（几何分布），该公式给出 $\\lfloor 0 \\rfloor = 0$，这是正确的众数。如果 $\\frac{(r-1)(1-p)}{p}  1$，该公式给出 $0$，这也是正确的，因为 $R(1) = r(1-p)  1$ 意味着 $\\Pr(K=1)  \\Pr(K=0)$。", "answer": "$$\n\\boxed{\\left\\lfloor \\frac{(r-1)(1-p)}{p} \\right\\rfloor}\n$$", "id": "4909516"}, {"introduction": "从理论转向实践，直方图是我们评估样本数据分布形状最常用的工具。然而，你所看到的“峰”的数量可能具有误导性。这个练习通过一个具体的计算案例，说明了不同的分箱规则（如Scott规则和Freedman-Diaconis规则）如何能从同一个单峰数据集中产生不同数量的模式，突显了在解释经验分布时保持批判性思维的重要性 [@problem_id:4909562]。", "problem": "一位生物统计学研究者正在使用由单一单峰总体的小样本构建的直方图，来评估经验分布的众数性（即局部最大值的数量）。考虑来自一项预研究的以下残差生物标志物 $z$-分数样本：$-3$, $-0.2$, $0$, $0.1$, $0.2$, $0.3$, $0.4$, $3$。令 $n$ 表示样本量，$\\bar{x}$ 表示样本均值，$s$ 表示样本标准差，$\\mathrm{IQR}$ 表示四分位距，定义为 $Q_{3} - Q_{1}$。对于偶数 $n$，四分位数通过“中位数折半法”（median-of-halves method）计算（即，在对数据排序后，$Q_{1}$ 是下半部分数据的中位数，$Q_{3}$ 是上半部分数据的中位数，必要时使用两个中间点的平均值）。该研究者计划比较使用 Scott 法则和 Freedman–Diaconis 法则构建的直方图。直方图将按照以下约定构建：除了最后一个组是右闭的外，所有组都是左闭右开的；组的原点位于样本最小值 $x_{(1)}$ 处；连续的组是通过根据所用法则加上一个恒定的宽度 $h$ 形成的。\n\n使用 Scott 法则和 Freedman–Diaconis 法则的标准定义，为给定样本构建两个直方图。将直方图“众数”定义为频数严格大于其相邻组频数的任何组；对于边缘组，仅与单个相邻组进行比较。计算每个直方图中的众数数量，然后计算差值“Freedman–Diaconis 众数数量减去 Scott 众数数量”。将最终差值表示为一个整数。无需四舍五入。", "solution": "该问题被验证为具有科学依据、良定且客观。它提出了一个基于生物统计学标准原则的清晰计算任务。所有必需的数据、定义和规则都已提供，使问题自洽且可解。\n\n解题过程首先计算必要的样本统计量，然后应用 Scott 法则和 Freedman–Diaconis 法则确定组宽，构建相应的直方图，最后根据给定的定义确定每个直方图中的众数数量。\n\n提供的样本数据是 $z$-分数集合 $X = \\{-3, -0.2, 0, 0.1, 0.2, 0.3, 0.4, 3\\}$。\n样本量为 $n=8$。\n\n首先，我们对数据进行排序以方便计算：$x_{(1)} = -3$, $x_{(2)} = -0.2$, $x_{(3)} = 0$, $x_{(4)} = 0.1$, $x_{(5)} = 0.2$, $x_{(6)} = 0.3$, $x_{(7)} = 0.4$, $x_{(8)} = 3$。\n样本最小值为 $x_{(1)} = -3$。\n\n样本均值 $\\bar{x}$ 计算如下：\n$$ \\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i = \\frac{1}{8} (-3 - 0.2 + 0 + 0.1 + 0.2 + 0.3 + 0.4 + 3) = \\frac{0.8}{8} = 0.1 $$\n\n样本标准差 $s$ 使用公式 $s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2}$ 计算。\n离均差平方和为：\n$$ \\sum_{i=1}^{8} (x_i - 0.1)^2 = (-3.1)^2 + (-0.3)^2 + (-0.1)^2 + (0)^2 + (0.1)^2 + (0.2)^2 + (0.3)^2 + (2.9)^2 $$\n$$ \\sum (x_i - 0.1)^2 = 9.61 + 0.09 + 0.01 + 0 + 0.01 + 0.04 + 0.09 + 8.41 = 18.26 $$\n因此，样本方差 $s^2$ 为 $\\frac{18.26}{7}$。\n样本标准差为 $s = \\sqrt{\\frac{18.26}{7}}$。\n\n接下来，我们使用中位数折半法计算四分位数 $Q_1$ 和 $Q_3$。对于 $n=8$，样本被分成各有 $4$ 个数据点的两半。\n下半部分：$\\{-3, -0.2, 0, 0.1\\}$\n上半部分：$\\{0.2, 0.3, 0.4, 3\\}$\n$Q_1$ 是下半部分的中位数，即其两个中间值的平均数：\n$$ Q_1 = \\frac{-0.2 + 0}{2} = -0.1 $$\n$Q_3$ 是上半部分的中位数，即其两个中间值的平均数：\n$$ Q_3 = \\frac{0.3 + 0.4}{2} = 0.35 $$\n四分位距 $\\mathrm{IQR}$ 是：\n$$ \\mathrm{IQR} = Q_3 - Q_1 = 0.35 - (-0.1) = 0.45 $$\n\n有了这些统计量，我们就可以计算组宽了。对于这两种法则，我们都需要 $n^{1/3} = 8^{1/3} = 2$。\n\n对于 Scott 法则：\n$$ h_{\\mathrm{Scott}} = \\frac{3.49 s}{n^{1/3}} = \\frac{3.49 \\sqrt{\\frac{18.26}{7}}}{2} \\approx \\frac{3.49 \\times 1.6151}{2} \\approx 2.8184 $$\n对于 Freedman–Diaconis 法则：\n$$ h_{\\mathrm{FD}} = \\frac{2 \\cdot \\mathrm{IQR}}{n^{1/3}} = \\frac{2 \\times 0.45}{2} = 0.45 $$\n\n现在，我们构建每个直方图。原点是样本最小值 $x_{(1)} = -3$。\n\n**Scott 直方图构建**\n组宽为 $h_{\\mathrm{Scott}} \\approx 2.8184$。\n- 组 1：$[-3, -3 + 2.8184) = [-3, -0.1816)$。该组包含数据点 $-3$ 和 $-0.2$。频数为 $2$。\n- 组 2：$[-0.1816, -0.1816 + 2.8184) = [-0.1816, 2.6368)$。该组包含数据点 $0, 0.1, 0.2, 0.3, 0.4$。频数为 $5$。\n- 组 3：$[2.6368, 2.6368 + 2.8184) = [2.6368, 5.4552)$。该组包含数据点 $3$。频数为 $1$。\n直方图的组和频数如下：\n- $B_{\\mathrm{Scott}, 1}$：频数 = $2$\n- $B_{\\mathrm{Scott}, 2}$：频数 = $5$\n- $B_{\\mathrm{Scott}, 3}$：频数 = $1$\n为了找出众数的数量，我们应用定义：一个组的频数必须严格大于其相邻组的频数。\n- $B_{\\mathrm{Scott}, 1}$ (边缘组)：频数为 $2$。相邻频数为 $5$。$2 > 5$ 是假的。不是众数。\n- $B_{\\mathrm{Scott}, 2}$ (内部组)：频数为 $5$。相邻频数为 $2$ 和 $1$。$5 > 2$ 和 $5 > 1$ 都为真。这是一个众数。\n- $B_{\\mathrm{Scott}, 3}$ (边缘组)：频数为 $1$。相邻频数为 $5$。$1 > 5$ 是假的。不是众数。\nScott 直方图有 $1$ 个众数。\n\n**Freedman–Diaconis 直方图构建**\n组宽为 $h_{\\mathrm{FD}} = 0.45$。原点在 $-3$。我们通过计算组索引 $j = \\lfloor \\frac{x - (-3)}{0.45} \\rfloor$ 来确定每个数据点 $x$ 所在的组。\n- $x=-3$：$j = \\lfloor \\frac{-3+3}{0.45} \\rfloor = 0$。\n- $x=-0.2$：$j = \\lfloor \\frac{-0.2+3}{0.45} \\rfloor = \\lfloor 6.22...\\rfloor = 6$。\n- $x=0$：$j = \\lfloor \\frac{0+3}{0.45} \\rfloor = \\lfloor 6.66...\\rfloor = 6$。\n- $x=0.1$：$j = \\lfloor \\frac{0.1+3}{0.45} \\rfloor = \\lfloor 6.88...\\rfloor = 6$。\n- $x=0.2$：$j = \\lfloor \\frac{0.2+3}{0.45} \\rfloor = \\lfloor 7.11...\\rfloor = 7$。\n- $x=0.3$：$j = \\lfloor \\frac{0.3+3}{0.45} \\rfloor = \\lfloor 7.33...\\rfloor = 7$。\n- $x=0.4$：$j = \\lfloor \\frac{0.4+3}{0.45} \\rfloor = \\lfloor 7.55...\\rfloor = 7$。\n- $x=3$：$j = \\lfloor \\frac{3+3}{0.45} \\rfloor = \\lfloor 13.33...\\rfloor = 13$。\n直方图从组 $0$ 跨越到组 $13$。各组 $B_{\\mathrm{FD},0}, B_{\\mathrm{FD},1}, \\dots, B_{\\mathrm{FD},13}$ 的频数序列是：\n$[1, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 1]$\n为了找出众数的数量，我们应用定义：\n- $B_{\\mathrm{FD}, 0}$ (边缘组)：频数为 $1$。相邻频数为 $0$。$1 > 0$ 为真。这是一个众数。\n- $B_{\\mathrm{FD}, 1}$ 至 $B_{\\mathrm{FD}, 5}$：频数为 $0$。不是众数。\n- $B_{\\mathrm{FD}, 6}$ (内部组)：频数为 $3$。相邻频数为 $0$ 和 $3$。$3 > 0$ 为真，但 $3 > 3$ 为假。不是众数。\n- $B_{\\mathrm{FD}, 7}$ (内部组)：频数为 $3$。相邻频数为 $3$ 和 $0$。$3 > 3$ 为假，但 $3 > 0$ 为真。不是众数。\n- $B_{\\mathrm{FD}, 8}$ 至 $B_{\\mathrm{FD}, 12}$：频数为 $0$。不是众数。\n- $B_{\\mathrm{FD}, 13}$ (边缘组)：频数为 $1$。相邻频数为 $0$。$1 > 0$ 为真。这是一个众数。\nFreedman–Diaconis 直方图有 $2$ 个众数。\n\n**最终计算**\n问题要求计算差值：Freedman–Diaconis 众数数量减去 Scott 众数数量。\nFreedman–Diaconis 众数数量 = $2$。\nScott 众数数量 = $1$。\n差值 = $2 - 1 = 1$。\n结果是一个整数，并且在最后步骤中没有进行四舍五入。", "answer": "$$\\boxed{1}$$", "id": "4909562"}]}