{"hands_on_practices": [{"introduction": "掌握离散程度度量的第一步是亲手计算它们。本练习将指导您使用一个包含高血压患者收缩压读数的小型临床数据集，计算全距、样本方差和样本标准差[@problem_id:4812293]。通过这个过程，您不仅能熟悉基本的计算方法，还能理解为何在处理样本数据时，方差的计算需要进行一个微小但关键的调整。", "problem": "一个临床研究团队从一家高血压诊所的 $n=6$ 名成年患者的简单随机样本中收集收缩压（SBP）值，单位为毫米汞柱（mmHg）：$[120,126,130,140,142,150]$。请使用基于独立同分布随机变量变异性核心定义的基础优先方法，计算该数据集的三个标准离散度量：全距、样本方差和样本标准差。基于无偏性概念以及从同一数据中估计均值所引入的约束，证明有限样本方差估计量选择的合理性。然后，用临床术语解释每个度量，明确地将离散程度与样本中患者SBP的变异性联系起来。\n\n将您的全距、样本方差和样本标准差的最终数值表示为四舍五入到四位有效数字。在讨论临床解释时，请使用毫米汞柱（mmHg）。最终数值答案必须只包含三个值，不带单位。", "solution": "该问题要求计算和解释给定收缩压（SBP）值数据集的三个离散度量——全距、样本方差和样本标准差。它还要求基于无偏估计的概念，为样本方差所使用的公式提供合理解释。该问题在科学上和统计学上是合理的，表述清晰，并包含了所有必要的信息。\n\n给定数据是一个 $n=6$ 的SBP值的简单随机样本：$X = \\{120, 126, 130, 140, 142, 150\\}$。单位是毫米汞柱（mmHg）。\n\n首先，我们计算样本均值（$\\bar{x}$），这是计算样本方差和标准差的先决条件。样本均值是观测值的总和除以观测值的数量。\n$$ \\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i $$\n$$ \\bar{x} = \\frac{120 + 126 + 130 + 140 + 142 + 150}{6} = \\frac{808}{6} = \\frac{404}{3} \\approx 134.67 \\text{ mmHg} $$\n\n**1. 全距**\n\n全距（$R$）是最简单的离散度量，定义为数据集中最大值与最小值之差。\n$$ R = x_{\\text{max}} - x_{\\text{min}} $$\n从数据集中，最大值为 $x_{\\text{max}} = 150$，最小值为 $x_{\\text{min}} = 120$。\n$$ R = 150 - 120 = 30 $$\n四舍五入到四位有效数字，全距为 $30.00$。\n\n临床解释：$30$ mmHg 的全距表明，在这六名患者的样本中，SBP值的总分布范围是 $30$ mmHg。这是血压最高（$150$ mmHg）的患者与血压最低（$120$ mmHg）的患者之间的差异。\n\n**2. 样本方差 ($s^2$)**\n\n该问题要求对样本方差估计量的选择提供基础性论证。样本方差，记为 $s^2$，是对真实但未知的总体方差 $\\sigma^2$ 的估计量。一个好的估计量的一个关键属性是它是无偏的，即它在所有可能的容量为 $n$ 的样本上的期望值等于它所估计的参数。\n\n如果总体均值 $\\mu$ 已知，$\\sigma^2$ 的一个无偏估计量将是 $\\frac{1}{n}\\sum_{i=1}^{n}(x_i - \\mu)^2$。然而，$\\mu$ 是未知的，必须使用样本均值 $\\bar{x}$ 从数据中进行估计。与样本均值的离差平方和 $\\sum(x_i - \\bar{x})^2$ 在 $\\bar{x}$ 处最小化，这意味着对于任何样本，它总是小于或等于与真实均值 $\\mu$ 的离差平方和（即 $\\sum(x_i - \\bar{x})^2 \\leq \\sum(x_i - \\mu)^2$）。\n\n因此，使用分母 $n$ 和样本均值，如 $\\frac{1}{n}\\sum(x_i - \\bar{x})^2$ 所示，会系统性地低估真实的总体方差。这个有偏估计量的期望值是 $E\\left[\\frac{1}{n}\\sum(x_i - \\bar{x})^2\\right] = \\frac{n-1}{n}\\sigma^2$。\n\n为了纠正这种低估，我们使用分母 $n-1$ 而不是 $n$。这被称为 Bessel's 校正。由此得到的样本方差估计量是：\n$$ s^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2 $$\n这个估计量是无偏的，因为它的期望值等于总体方差：$E[s^2] = \\sigma^2$。$n-1$ 项代表自由度。由于从数据中估计均值“用掉”了一个自由度（因为离差 $x_i - \\bar{x}$ 的总和必须为零），所以这些离差中只有 $n-1$ 个可以自由变化。\n\n现在，我们为给定数据计算 $s^2$ 的值。我们首先计算离差平方和（SS）：\n$$ \\sum_{i=1}^{n} (x_i - \\bar{x})^2 = \\sum_{i=1}^{6} \\left(x_i - \\frac{404}{3}\\right)^2 $$\n$$ = \\left(120 - \\frac{404}{3}\\right)^2 + \\left(126 - \\frac{404}{3}\\right)^2 + \\left(130 - \\frac{404}{3}\\right)^2 + \\left(140 - \\frac{404}{3}\\right)^2 + \\left(142 - \\frac{404}{3}\\right)^2 + \\left(150 - \\frac{404}{3}\\right)^2 $$\n$$ = \\left(-\\frac{44}{3}\\right)^2 + \\left(-\\frac{26}{3}\\right)^2 + \\left(-\\frac{14}{3}\\right)^2 + \\left(\\frac{16}{3}\\right)^2 + \\left(\\frac{22}{3}\\right)^2 + \\left(\\frac{46}{3}\\right)^2 $$\n$$ = \\frac{1936}{9} + \\frac{676}{9} + \\frac{196}{9} + \\frac{256}{9} + \\frac{484}{9} + \\frac{2116}{9} = \\frac{5664}{9} = 629.333... $$\n现在，我们除以自由度，$n-1 = 6-1=5$：\n$$ s^2 = \\frac{629.333...}{5} = 125.8666... $$\n四舍五入到四位有效数字，样本方差为 $125.9$。\n\n临床解释：样本方差为 $125.9$ mmHg$^2$。方差的单位（测量单位的平方）在临床环境中不直观。它的主要作用是作为一种数学上基本的离散度量，为其他统计检验和标准差提供了基础。\n\n**3. 样本标准差 ($s$)**\n\n样本标准差（$s$）是样本方差的正平方根。它更适用于解释，因为它的单位与原始数据相同。\n$$ s = \\sqrt{s^2} $$\n$$ s = \\sqrt{125.8666...} \\approx 11.21903... $$\n四舍五入到四位有效数字，样本标准差为 $11.22$。\n\n临床解释：样本标准差为 $11.22$ mmHg。这个值代表了单个患者的SBP偏离样本平均SBP $134.7$ mmHg 的典型或平均量。一个SBP为 $145.9$ mmHg（$134.7+11.2$）的患者将被认为比该样本的平均值高一个标准差。更大的标准差将意味着患者之间血压读数的异质性更大，而较小的值则表示读数更紧密地聚集在平均值周围。", "answer": "$$ \\boxed{ \\begin{pmatrix} 30.00  125.9  11.22 \\end{pmatrix} } $$", "id": "4812293"}, {"introduction": "一个好的统计量不仅要易于计算，还应能准确反映数据的真实情况。本练习旨在培养您的批判性思维，通过比较两个来自临床实验室的假设数据集，您将看到单个异常值（或离群值）如何极大地扭曲全距这一度量[@problem_id:4812168]。这个例子鲜明地揭示了依赖极值度量的局限性，并促使我们思考何时需要更稳健的离散程度度量。", "problem": "一个临床实验室正在通过重复测量五个相同的等分试样来验证两种生物标志物检测的测量流程。从流程 $A$ 记录的值为 $A=[5,6,6,7,8]$，从流程 $B$ 记录的值为 $B=[5,5,5,5,13]$。假设所有值都处于同一测量尺度，并代表来自相同基础过程的独立重复测量。从有限样本中顺序统计量的核心定义出发，使用仅依赖于样本中观测到的最小值和最大值的基于极值的度量，推导每个流程的离散度。然后，通过计算流程 $B$ 与流程 $A$ 的基于极值的离散度之比，来量化 $B$ 中单个极值对可解释性的影响。以无四舍五入的简化精确分数形式提供此比率。在您的推导中，明确论证为何单个极值会扭曲临床实验室数据中的此度量，并将这种敏感性与包含所有观测值的离散度度量（例如，样本方差和样本标准差）以及稳健度量（例如，四分位距 (IQR) 和中位数绝对偏差 (MAD)）进行对比。", "solution": "理论基础是顺序统计量的定义以及由其构建的离散度度量。对于一个有限样本 $X_{1},\\dots,X_{n}$，令 $X_{(1)}=\\min\\{X_{1},\\dots,X_{n}\\}$ 表示最小顺序统计量，令 $X_{(n)}=\\max\\{X_{1},\\dots,X_{n}\\}$ 表示最大顺序统计量。从顺序统计量推导出的基于极值的离散度度量是最大观测值与最小观测值之差，即极差。用符号表示，一个样本 $X_{1},\\dots,X_{n}$ 的极差 $R$ 是\n$$\nR \\equiv X_{(n)} - X_{(1)}.\n$$\n此定义仅使用两个极值，不使用其他任何样本信息。\n\n计算流程 $A$ 的极差。样本为 $A=[5,6,6,7,8]$，因此\n$$\nX_{(1)}^{A}=5,\\quad X_{(n)}^{A}=8,\\quad R_{A}=X_{(n)}^{A}-X_{(1)}^{A}=8-5=3.\n$$\n计算流程 $B$ 的极差。样本为 $B=[5,5,5,5,13]$，因此\n$$\nX_{(1)}^{B}=5,\\quad X_{(n)}^{B}=13,\\quad R_{B}=X_{(n)}^{B}-X_{(1)}^{B}=13-5=8.\n$$\n所要求的对异常值效应的定量总结是极差之比：\n$$\n\\frac{R_{B}}{R_{A}}=\\frac{8}{3}.\n$$\n\n为解释单个极值对临床实验室数据可解释性的影响，注意到极差完全依赖于 $X_{(1)}$ 和 $X_{(n)}$。如果由于分析前或分析中的问题（例如，瞬时仪器故障、样本混淆或污染），单个观测值异常地高，那么 $X_{(n)}$ 可能会远远偏离其余数据，从而增大了 $R$ 值，即使大部分测量值是一致的。在样本 $B$ 中，四个观测值为 $5$，一个观测值为 $13$。极差从 $A$ 中的 $3$ 增加到 $B$ 中的 $8$，增大了 $\\frac{8}{3}$ 倍，尽管 $B$ 中的大部分观测值都集中在 $5$，这表明对于大多数重复测量而言，其基础测量过程的离散程度很低。\n\n相比之下，包含所有观测值的离散度度量，如样本方差 $s^{2}$ 和样本标准差 $s$，会对整个数据集的偏差进行加权：\n$$\n\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n} x_{i},\\quad s^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2},\\quad s=\\sqrt{s^{2}}.\n$$\n对于 $A$，$\\bar{x}_{A}=\\frac{5+6+6+7+8}{5}=\\frac{32}{5}=6.4$ 且\n$$\ns_{A}^{2}=\\frac{1}{4}\\big[(5-6.4)^{2}+(6-6.4)^{2}+(6-6.4)^{2}+(7-6.4)^{2}+(8-6.4)^{2}\\big]=\\frac{5.20}{4}=1.30,\\quad s_{A}=\\sqrt{1.30}.\n$$\n对于 $B$，$\\bar{x}_{B}=\\frac{5+5+5+5+13}{5}=\\frac{33}{5}=6.6$ 且\n$$\ns_{B}^{2}=\\frac{1}{4}\\big[(5-6.6)^{2}+(5-6.6)^{2}+(5-6.6)^{2}+(5-6.6)^{2}+(13-6.6)^{2}\\big]=\\frac{51.20}{4}=12.80,\\quad s_{B}=\\sqrt{12.80}.\n$$\n这些量显示出由于异常值引起的膨胀，但它们也通过均值和平方偏差的分布反映了四个值集中在 $5$ 的情况。能够降低对极值敏感性的稳健离散度度量，例如由 $Q_{3}-Q_{1}$ 定义的四分位距 (IQR)（其中 $Q_{1}$ 和 $Q_{3}$ 分别是第一和第三四分位数），以及由 $\\mathrm{MAD}=\\mathrm{median}(|x_{i}-\\mathrm{median}(x)|)$ 定义的中位数绝对偏差 (MAD)，受到的影响较小。对于 $A$，中位数为 $6$，且 $\\mathrm{MAD}_{A}=\\mathrm{median}(|[5,6,6,7,8]-6|)=\\mathrm{median}([1,0,0,1,2])=1$。对于 $B$，中位数为 $5$，且 $\\mathrm{MAD}_{B}=\\mathrm{median}(|[5,5,5,5,13]-5|)=\\mathrm{median}([0,0,0,0,8])=0$。因此，尽管 $B$ 的极差因极值而膨胀，但 MAD 表明 $B$ 的数据中心主体部分非常集中。这种对比说明，当存在异常值时，在临床质量评估中仅仅依赖极差可能会产生误导；使用考虑完整分布的度量或稳健度量可以为检测精度提供更具可解释性的表征。\n\n所要求的最终数值，即极差之比，是 $\\frac{8}{3}$。", "answer": "$$\\boxed{\\frac{8}{3}}$$", "id": "4812168"}, {"introduction": "在生物统计学中，我们常常需要比较两组（例如，治疗组与对照组）的差异。本练习将您带入这一常见场景，介绍“合并方差”的概念，这是一种结合两个独立样本的方差信息以获得对共同总体方差更精确估计的方法[@problem_id:4812171]。理解这一技术至关重要，因为它是双样本$t$检验等关键统计推断方法的基础，同时本练习也强调了在使用它之前必须检验其背后假设的重要性。", "problem": "在一项针对两种降压疗法的随机比较效果研究中，主要终点是从基线到第$12$周的收缩压标准化变化，其中“标准化”意味着每次变化都已通过基线标准差进行缩放，因此结果是无单位的。设$A$组表示接受疗法$A$的患者，$B$组表示接受疗法$B$的患者。已知$A$组的样本量为$n_A = 25$，样本方差为$s_A^2 = 9$；$B$组的样本量为$n_B = 35$，样本方差为$s_B^2 = 16$。\n\n仅从样本方差作为关于样本均值的平均平方偏差的核心定义以及独立平方和的可加性出发，从第一性原理推导出一个共同方差的估计量，假设两组共享一个单一的总体方差。然后，根据上述数据计算其值。最后，描述在此临床背景下，跨组合并信息以估计共同方差是合理的所需的最小统计假设，并描述一种这些假设在实践中可能失效的现实方式，以及相应的分析补救措施。\n\n将合并方差报告为精确数（不要四舍五入），并省略任何单位，因为终点已经标准化并且是无量纲的。", "solution": "该问题要求从两个独立样本推导共同方差的估计量，为给定数据计算其值，并讨论其背后的统计假设。\n\n对问题陈述的验证发现其具有科学依据、问题明确且客观。这是一个统计推断中的标准问题，指令清晰，数据充分。因此，有必要提供完整的解答。\n\n**1. 合并方差估计量的推导**\n\n推导从单个组的样本方差定义开始。对于一个大小为 $n$、观测值为 $x_i$、样本均值为 $\\bar{x}$ 的样本，其无偏样本方差 $s^2$ 定义为离均差平方和除以自由度：\n$$ s^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2 $$\n这个量是总体方差 $\\sigma^2$ 的一个无偏估计量。分子 $\\sum_{i=1}^{n} (x_i - \\bar{x})^2$ 被称为离均差平方和（$SS$），它与 $df = n-1$ 的自由度相关联。\n\n对于A组，其样本量为 $n_A$，样本方差为 $s_A^2$，其平方和为：\n$$ SS_A = (n_A - 1)s_A^2 $$\n该平方和具有 $df_A = n_A - 1$ 的自由度。\n\n同理，对于B组，其样本量为 $n_B$，样本方差为 $s_B^2$，其平方和为：\n$$ SS_B = (n_B - 1)s_B^2 $$\n该平方和具有 $df_B = n_B - 1$ 的自由度。\n\n问题假设存在一个两组共有的单一总体方差 $\\sigma^2$。为了为这个共同方差创建一个更精确的单一估计量，我们合并（或“汇集”）来自两个独立样本的信息。根据规定，我们援引独立平方和的可加性原理。由于随机研究中的两组是独立的，我们可以将它们各自的平方和相加，得到一个总的或合并的平方和 $SS_p$：\n$$ SS_p = SS_A + SS_B = (n_A - 1)s_A^2 + (n_B - 1)s_B^2 $$\n由于独立性，与此合并平方和相关的自由度也是可加的：\n$$ df_p = df_A + df_B = (n_A - 1) + (n_B - 1) = n_A + n_B - 2 $$\n合并方差估计量，记为 $s_p^2$，定义为该合并平方和除以合并自由度。这提供了各个样本方差的加权平均值，其权重为它们各自的自由度。\n$$ s_p^2 = \\frac{SS_p}{df_p} = \\frac{(n_A - 1)s_A^2 + (n_B - 1)s_B^2}{(n_A - 1) + (n_B - 1)} = \\frac{(n_A - 1)s_A^2 + (n_B - 1)s_B^2}{n_A + n_B - 2} $$\n这个表达式就是从第一性原理推导出的共同方差的估计量。\n\n**2. 合并方差的计算**\n\n给定的数据是：\n对于A组：$n_A = 25$, $s_A^2 = 9$。\n对于B组：$n_B = 35$, $s_B^2 = 16$。\n\n将这些值代入推导出的 $s_p^2$ 公式中：\n$$ s_p^2 = \\frac{(25 - 1) \\cdot 9 + (35 - 1) \\cdot 16}{25 + 35 - 2} $$\n$$ s_p^2 = \\frac{24 \\cdot 9 + 34 \\cdot 16}{58} $$\n$$ s_p^2 = \\frac{216 + 544}{58} $$\n$$ s_p^2 = \\frac{760}{58} $$\n为了简化分数，我们可以将分子和分母同时除以它们的最大公约数。两者都是偶数，因此除以 $2$：\n$$ s_p^2 = \\frac{380}{29} $$\n由于 $29$ 是一个质数，而 $380 = 2^2 \\cdot 5 \\cdot 19$ 不能被 $29$ 整除，所以这个分数是最简形式。\n\n**3. 最小统计假设**\n\n合并方差估计的合理性依赖于三个主要假设：\n\n1.  **方差齐性（Homoscedasticity）**：这是最关键的假设。它假定两个组的真实总体方差相等，即 $\\sigma_A^2 = \\sigma_B^2 = \\sigma^2$。合并方差 $s_p^2$ 是这个单一共同方差 $\\sigma^2$ 的估计量。如果违反此假设，合并估计量将是有偏的，并可能导致不正确的统计推断。\n2.  **样本独立性**：A组的观测值必须与B组的观测值在统计上独立。在随机比较研究的背景下，将参与者随机分配到不同的治疗组是确保这种独立性成立的标准程序。\n3.  **正态性**：为了在正式的推断程序（如双样本t检验或置信区间的构建）中使用合并方差估计量，假定每个组内的数据都从正态分布中抽样。也就是说，A组的收缩压标准化变化遵循 $N(\\mu_A, \\sigma^2)$ 分布，B组则遵循 $N(\\mu_B, \\sigma^2)$ 分布。虽然点估计 $s_p^2$ 可以在没有这个假设的情况下计算出来，但它的抽样分布（一个缩放的卡方分布）及其在假设检验中的后续使用都依赖于正态性。\n\n**4. 假设的现实失效与分析补救措施**\n\n在这一临床背景下，这些假设失效的一个现实方式是违反了方差齐性。这两种降压疗法可能不仅平均效果不同，对反应变异性的影响也可能不同。例如，疗法A可能对所有患者都有一致的、中等的效果，导致较小的方差。而疗法B可能是一种新药，对一部分患者（例如，具有特定遗传标记的患者）非常有效，但对其他患者几乎没有效果。这种差异性反应将导致B组结果的方差远大于A组，即 $\\sigma_A^2 \\neq \\sigma_B^2$。\n\n当有证据表明存在异方差性（heteroscedasticity）时，适当的分析补救措施是使用不依赖于方差相等假设的统计方法。对于比较两个独立组的均值，标准的补救措施是**Welch t检验**。与合并方差t检验不同，Welch检验不合并样本方差。相反，其检验统计量是使用各自的样本方差计算的：\n$$ t_{Welch} = \\frac{\\bar{x}_A - \\bar{x}_B}{\\sqrt{\\frac{s_A^2}{n_A} + \\frac{s_B^2}{n_B}}} $$\n该统计量的自由度不是简单的 $n_A + n_B - 2$，而是使用**Welch-Satterthwaite方程**来近似计算。当不能假定总体方差相等时，这种方法为均值差异提供了更稳健和可靠的推断。", "answer": "$$\\boxed{\\frac{380}{29}}$$", "id": "4812171"}]}