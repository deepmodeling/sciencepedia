{"hands_on_practices": [{"introduction": "本练习将引导你从第一性原理出发，构建统计推断的基石。我们将从最基本的伯努利试验出发，推导出似然函数——这是衡量特定参数值与观测数据契合程度的数学表达。通过最大化这个函数，你将找到参数的最优估计（最大似然估计），并进一步构建似然比检验，这是在统计学中用于检验关于参数假设的黄金标准方法之一 ([@problem_id:4957552])。这个过程不仅能让你掌握核心技术，更能让你深刻理解统计推断的逻辑内核。", "problem": "一个临床实验室正在验证一种新的二元检测方法，当该方法应用于从目标人群中随机抽取的样本时，其返回阳性结果的未知概率为 $p$。假设 $X_{1}, X_{2}, \\ldots, X_{n}$ 是成功概率为 $p$ 的独立同分布 (i.i.d.) 伯努利随机变量，其中 $X_{i}=1$ 表示检测结果为阳性，$X_{i}=0$ 表示检测结果为阴性。设 $K=\\sum_{i=1}^{n} X_{i}$ 为观测到的阳性总数。\n\n仅使用伯努利概率质量函数、独立性的基本定义，以及似然函数作为给定观测数据下参数的函数的联合概率的定义，完成以下任务：\n\n1) 基于观测数据推导 $p$ 的似然函数，并将其简化为充分统计量 $K$ 的函数。将此结果解释为此模型中 $p$ 的剖面似然。\n\n2) 通过在 $p \\in [0,1]$ 上最大化似然函数来确定最大似然估计量 $\\hat{p}$，并特别注意边界情况 $K=0$ 和 $K=n$。\n\n3) 构建似然比检验 (LRT) 统计量，用于检验简单原假设 $H_{0}: p=p_{0}$ 与双边备择假设 $H_{1}: p \\neq p_{0}$。对于内部情况 $0  k  n$。", "solution": "**步骤1：提取已知条件**\n- 独立同分布 (i.i.d.) 伯努利随机变量：$X_{1}, X_{2}, \\ldots, X_{n}$。\n- 成功概率：$p$。\n- 编码：$X_{i}=1$ 表示阳性检测，$X_{i}=0$ 表示阴性检测。\n- 阳性总数：$K=\\sum_{i=1}^{n} X_{i}$。\n- 任务1：推导 $p$ 的似然函数 $L(p)$，并将其表示为充分统计量 $K$ 的函数。\n- 任务2：确定在 $p \\in [0,1]$ 上的最大似然估计量 $\\hat{p}$，包括边界情况 $K=0$ 和 $K=n$。\n- 任务3：构建用于检验 $H_{0}: p=p_{0}$ 与 $H_{1}: p \\neq p_{0}$ 的似然比检验 (LRT) 统计量 $W=-2\\ln \\lambda$。对于内部情况 $0  k  n$。", "answer": "$$\\boxed{2.936}$$", "id": "4957552"}, {"introduction": "在掌握了如何分析已有数据之后，生物统计学的一个关键实践环节是“研究设计”，即如何科学地规划未来的研究。本练习直面研究设计中的核心问题：为了得到一个具有足够精度的估计，我们需要多大的样本量？你将运用中心极限定理，推导出估算患病率时控制误差范围所需的样本量公式，并学会如何做出“保守”选择以确保研究的稳健性 ([@problem_id:4957558])。这是将统计理论转化为具体、可操作的研究计划的关键一步。", "problem": "在一项横断面生物统计学研究中，您将使用独立同分布的伯努利观测值来估计一种二元生物标志物的患病率 $p$。您计划在中心极限定理（CLT）支持的正态近似下，报告一个名义置信水平为 $1-\\alpha$ 的 $p$ 的双侧置信区间。从伯努利随机变量和二项样本比例的定义出发，并利用当 $n$ 较大时标准化样本比例近似服从标准正态分布这一事实，推导所需样本量 $n$ 的设计表达式，以确保在置信度为 $1-\\alpha$ 的情况下，绝对误差范围不超过预设的容差 $\\epsilon$。然后，确定能产生保守（最坏情况）设计的 $p$ 值，并用它来计算确保对于任何真实 $p \\in [0,1]$，误差范围最大为 $\\epsilon$ 的最小整数 $n$。\n\n假设 $\\alpha = 0.05$ 和 $\\epsilon = 0.04$，并将对应于置信水平 $1-\\alpha$ 的标准正态上分位数 $z_{1-\\alpha/2}$ 取为实践中常用的值。报告满足要求的最小整数 $n$。不要包含单位。不需要按有效数字进行四舍五入；报告满足设计准则的精确最小整数。", "solution": "该问题要求推导一个用于估计总体比例 $p$ 的样本量公式，并将其应用于一个具体案例。我们首先定义统计框架。\n\n设 $X_1, X_2, \\dots, X_n$ 为一组来自参数为 $p$ 的伯努利分布的 $n$ 个独立同分布（i.i.d.）随机变量，记作 $X_i \\sim \\text{Bernoulli}(p)$。参数 $p$ 代表总体中该生物标志物的真实患病率。对于每个观测值 $i$，如果生物标志物存在，$X_i=1$（概率为 $p$）；如果不存在，$X_i=0$（概率为 $1-p$）。每个观测值的期望值为 $E[X_i] = p$，方差为 $\\text{Var}(X_i) = p(1-p)$。\n\n样本比例 $\\hat{p}$ 是 $p$ 的点估计量，定义为观测值的均值：\n$$ \\hat{p} = \\frac{1}{n} \\sum_{i=1}^{n} X_i $$\n作为一个估计量，$\\hat{p}$ 的期望值为 $E[\\hat{p}] = E\\left[\\frac{1}{n}\\sum_{i=1}^{n} X_i\\right] = \\frac{1}{n}\\sum_{i=1}^{n} E[X_i] = \\frac{1}{n}(np) = p$，这使得它成为 $p$ 的一个无偏估计量。由于观测值的独立性，$\\hat{p}$ 的方差由 $\\text{Var}(\\hat{p}) = \\text{Var}\\left(\\frac{1}{n}\\sum_{i=1}^{n} X_i\\right) = \\frac{1}{n^2}\\sum_{i=1}^{n} \\text{Var}(X_i) = \\frac{1}{n^2}(np(1-p)) = \\frac{p(1-p)}{n}$ 给出。\n\n根据中心极限定理（CLT），对于足够大的样本量 $n$，$\\hat{p}$ 的抽样分布近似为正态分布：\n$$ \\hat{p} \\approx N\\left(p, \\frac{p(1-p)}{n}\\right) $$\n将随机变量 $\\hat{p}$ 标准化，可以得到一个近似服从标准正态分布的变量：\n$$ Z = \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\approx N(0,1) $$\n基于枢轴量 $Z$ 构建 $p$ 的置信水平为 $1-\\alpha$ 的双侧置信区间。我们寻求找到满足以下条件的界限：\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\le z_{1-\\alpha/2}\\right) \\approx 1-\\alpha $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的上 $1-\\alpha/2$ 分位数。\n\n绝对误差范围，我们可以记作 $E_{margin}$，是置信区间的半宽。从上述不等式可以清楚地看出，估计 $p$ 的误差范围表达式为 $E_{margin} = z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}}$。问题要求这个误差范围不应超过预设的容差 $\\epsilon$。\n$$ z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}} \\le \\epsilon $$\n我们的目标是找到满足此条件的最小样本量 $n$。我们重排不等式以求解 $n$：\n$$ \\sqrt{\\frac{p(1-p)}{n}} \\le \\frac{\\epsilon}{z_{1-\\alpha/2}} $$\n$$ \\frac{p(1-p)}{n} \\le \\left(\\frac{\\epsilon}{z_{1-\\alpha/2}}\\right)^2 $$\n$$ n \\ge p(1-p) \\left(\\frac{z_{1-\\alpha/2}}{\\epsilon}\\right)^2 $$\n这是所需样本量的一般设计表达式。然而，这个表达式依赖于未知的比例 $p$。为了保证对于 $p \\in [0, 1]$ 的*任何*可能值，误差范围的要求都能得到满足，我们必须采取一种保守（最坏情况）的方法。这涉及到找到使所需样本量 $n$ 最大化的 $p$ 值。当 $p(1-p)$ 这一项最大化时，样本量 $n$ 也最大化。\n\n设 $f(p) = p(1-p) = p - p^2$。为了找到这个函数在区间 $[0, 1]$ 上的最大值，我们可以使用微积分。一阶导数是 $f'(p) = 1 - 2p$。令导数为零，$1 - 2p = 0$，得到 $p = \\frac{1}{2} = 0.5$。由于二阶导数 $f''(p) = -2$ 为负，所以 $p=0.5$ 是一个局部最大值。这也是在区间 $[0, 1]$ 上的全局最大值，最大值为 $f(0.5) = 0.5(1-0.5) = 0.25$。\n\n通过将这个最坏情况下的 $p(1-p)$ 值代入样本量不等式，我们得到了一个不依赖于 $p$ 的保守公式 $n$：\n$$ n \\ge 0.25 \\left(\\frac{z_{1-\\alpha/2}}{\\epsilon}\\right)^2 $$\n我们已知以下数值：\n- 置信水平 $1-\\alpha = 1 - 0.05 = 0.95$。\n- 这意味着 $\\alpha/2 = 0.025$，所以我们需要标准正态分布的 $1 - 0.025 = 0.975$ 分位数。问题指定使用“常用值”，即 $z_{0.975} = 1.96$。\n- 最大可容忍误差范围 $\\epsilon = 0.04$。\n\n将这些值代入保守的样本量公式：\n$$ n \\ge 0.25 \\left(\\frac{1.96}{0.04}\\right)^2 $$\n首先，我们计算括号内的比率：\n$$ \\frac{1.96}{0.04} = \\frac{196}{4} = 49 $$\n现在，我们将其代回不等式中：\n$$ n \\ge 0.25 \\times (49)^2 $$\n$$ n \\ge 0.25 \\times 2401 $$\n$$ n \\ge 600.25 $$\n由于样本量 $n$ 必须是整数，我们必须选择满足此条件的最小整数。因此，我们对计算出的值向上取整：\n$$ n_{min} = \\lceil 600.25 \\rceil = 601 $$\n为确保在 $95\\%$ 的置信度下，对于任何真实的患病率 $p$，误差范围最大为 $0.04$ 所需的最小整数样本量是 $601$。", "answer": "$$ \\boxed{601} $$", "id": "4957558"}, {"introduction": "虽然点估计（如最大似然估计）为我们提供了参数的最佳猜测值，但区间估计（置信区间）通过量化不确定性，为我们描绘了一幅更完整的图景。这个高级练习将带你超越单一方法的学习，通过编程实现并比较三种经典的置信区间构造方法：Wald区间、Wilson得分区间和Clopper-Pearson精确区间 ([@problem_id:4957555])。通过评估它们在不同情境下的覆盖率和期望长度，你将认识到统计方法的优劣并非绝对，并学会批判性地选择最适合当前研究问题的工具。", "problem": "一个成功概率为 $p$ 的 $n$ 次独立同分布伯努利试验序列产生了总共 $k$ 次成功，其中 $k \\in \\{0,1,\\dots,n\\}$。令 $\\ell(p)$ 表示二项对数似然， $U(p)$ 表示得分函数， $I(p)$ 表示费雪信息。仅从以下基本要素出发：\n- 伯努利模型和二项模型的定义。\n- 二项对数似然及其导数。\n- 在简单零假设下，得分检验统计量的大样本正态近似。\n您必须推导出一个算法，该算法通过反演水平为 $\\alpha$ 的双边得分检验来构建 $p$ 的威尔逊得分区间。具体来说，构建 $H_0: p = p_0$ 在水平 $\\alpha$ 下的得分检验的接受域，并对其进行数学反演，以获得一个依赖于 $n$ 和观测值 $k$ 的关于 $p$ 的区间。\n\n然后，给定 $n$ 和 $k$，实现三个关于 $p$ 的区间估计量：\n1. 基于最大似然估计 (MLE) $\\hat{p}$ 和大样本正态近似的沃尔德区间。\n2. 通过反演上述推导的得分检验获得的威尔逊得分区间。\n3. 通过反演精确二项累积分布函数 (CDF) 获得的克洛普-皮尔逊区间。\n\n为确保数值有效性，对于任何端点在单位区间之外的区间估计量，将端点截断到单位区间 $[0,1]$。对于克洛普-皮尔逊区间，处理极端结果 $k=0$ 和 $k=n$ 的方式应与精确二项反演一致，以确保允许的端点始终在 $[0,1]$ 内。\n\n对于一个固定的真实 $p$ 和样本量 $n$，将区间过程的覆盖概率定义为（相对于 $K \\sim \\text{Binomial}(n,p)$ 的二项抽样分布而言）随机区间包含真实参数 $p$ 的概率：\n$$\n\\text{coverage}(n,p,\\alpha) \\;=\\; \\sum_{k=0}^{n} \\mathbb{I}\\{L(n,k,\\alpha) \\le p \\le U(n,k,\\alpha)\\} \\cdot \\binom{n}{k} p^k (1-p)^{n-k},\n$$\n其中 $[L(n,k,\\alpha),U(n,k,\\alpha)]$ 是该方法为实现的 $k$ 所产生的区间，而 $\\mathbb{I}\\{\\cdot\\}$ 是指示函数。将在 $(n,p,\\alpha)$ 处区间方法的期望长度定义为\n$$\n\\text{Elen}(n,p,\\alpha) \\;=\\; \\sum_{k=0}^{n} \\left(U(n,k,\\alpha) - L(n,k,\\alpha)\\right) \\cdot \\binom{n}{k} p^k (1-p)^{n-k}.\n$$\n\n您的程序必须为每个测试用例 $(n,p,\\alpha)$ 计算每种方法的两个浮点数：覆盖概率和期望长度，使用对 $k \\in \\{0,\\dots,n\\}$ 的精确求和以及二项概率质量函数。不允许使用蒙特卡洛模拟。\n\n测试套件：\n- 案例 1：$n=10$，$p=0.2$，$\\alpha=0.05$。\n- 案例 2：$n=40$，$p=0.5$，$\\alpha=0.05$。\n- 案例 3：$n=5$，$p=0.05$，$\\alpha=0.05$。\n- 案例 4：$n=30$，$p=0.9$，$\\alpha=0.05$。\n- 案例 5：$n=2$，$p=0.5$，$\\alpha=0.10$。\n- 案例 6：$n=100$，$p=0.01$，$\\alpha=0.05$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个子列表。对于每个测试用例，按以下顺序输出一个包含六个数字的列表：\n$[\\text{沃尔德覆盖率}, \\text{沃尔德期望长度}, \\text{威尔逊覆盖率}, \\text{威尔逊期望长度}, \\text{克洛普-皮尔逊覆盖率}, \\text{克洛普-皮尔逊期望长度}]$。\n最后一行必须看起来像\n$$\n[\\,[w_1,w_2,w_3,w_4,w_5,w_6],\\,[\\dots],\\dots\\,]\n$$\n所有数值都以小数形式表示（无百分号），并且全部输出都在单行上，没有附加文本。", "solution": "该问题要求推导并实现三种不同的二项比例 $p$ 的置信区间估计量，并随后基于覆盖概率和期望长度对其进行评估。我们将首先按规定提供每种方法的理论背景和推导过程。\n\n### 1. 置信区间的推导与公式\n\n令 $K$ 为一系列 $n$ 次独立同分布伯努利试验中成功的次数，成功概率为 $p$。随机变量 $K$ 服从二项分布，$K \\sim \\text{Binomial}(n,p)$，其概率质量函数 (PMF) 为 $f(k;p) = \\binom{n}{k} p^k (1-p)^{n-k}$，适用于 $k \\in \\{0, 1, \\dots, n\\}$。给定观测到的成功次数 $k$，我们的目标是为 $p$ 构建一个 $100(1-\\alpha)\\%$ 的置信区间。\n\n#### 1.1. 威尔逊得分区间\n\n该区间是通过对零假设 $H_0: p = p_0$ 的得分检验进行反演推导出来的。推导过程从二项对数似然函数开始。\n\n观测值为 $k$ 时的似然函数为 $L(p) = \\binom{n}{k} p^k (1-p)^{n-k}$。对数似然函数为：\n$$ \\ell(p) = \\log L(p) = \\log\\binom{n}{k} + k \\log(p) + (n-k) \\log(1-p) $$\n得分函数 $U(p)$ 是对数似然函数关于 $p$ 的一阶导数：\n$$ U(p) = \\frac{d\\ell(p)}{dp} = \\frac{k}{p} - \\frac{n-k}{1-p} = \\frac{k - np}{p(1-p)} $$\n费雪信息 $I(p)$ 是对数似然函数二阶导数的负期望。二阶导数为：\n$$ \\frac{d^2\\ell(p)}{dp^2} = -\\frac{k}{p^2} - \\frac{n-k}{(1-p)^2} $$\n取负期望，其中 $E[K] = np$，我们得到：\n$$ I(p) = -E\\left[\\frac{d^2\\ell(p)}{dp^2}\\right] = E\\left[\\frac{K}{p^2} + \\frac{n-K}{(1-p)^2}\\right] = \\frac{np}{p^2} + \\frac{n-np}{(1-p)^2} = \\frac{n}{p} + \\frac{n}{1-p} = \\frac{n}{p(1-p)} $$\n对于零假设 $H_0: p = p_0$ 的得分检验统计量由 $Z = U(p_0) / \\sqrt{I(p_0)}$ 给出。对于大样本 $n$，$Z$ 近似服从标准正态分布，$Z \\sim N(0,1)$。\n$$ Z = \\frac{ (k - np_0) / (p_0(1-p_0)) }{ \\sqrt{n / (p_0(1-p_0))} } = \\frac{k - np_0}{\\sqrt{n p_0 (1-p_0)}} $$\n令 $\\hat{p} = k/n$ 为最大似然估计 (MLE)。该统计量可写作 $Z = (\\hat{p}-p_0)/\\sqrt{p_0(1-p_0)/n}$。在显著性水平 $\\alpha$ 下，如果 $|Z| \\le z_{\\alpha/2}$，则双边得分检验不拒绝 $H_0$，其中 $z_{\\alpha/2}$ 是标准正态分布的上 $\\alpha/2$ 分位数。$p_0$ 的接受域由以下不等式定义：\n$$ \\frac{(\\hat{p} - p_0)^2}{p_0(1-p_0)/n} \\le z_{\\alpha/2}^2 $$\n为了获得 $p$ 的置信区间，我们对这个不等式求解 $p_0$，现在我们将其视为变量 $p$：\n$$ n(\\hat{p}-p)^2 \\le z_{\\alpha/2}^2 p(1-p) $$\n$$ n(\\hat{p}^2 - 2\\hat{p}p + p^2) \\le z_{\\alpha/2}^2(p-p^2) $$\n整理各项后，得到一个关于 $p$ 的二次不等式：\n$$ (n + z_{\\alpha/2}^2)p^2 - (2n\\hat{p} + z_{\\alpha/2}^2)p + n\\hat{p}^2 \\le 0 $$\n置信区间的端点是相应二次方程 $Ap^2 + Bp + C = 0$ 的根，其中 $A = n+z_{\\alpha/2}^2$，$B = -(2n\\hat{p} + z_{\\alpha/2}^2)$，$C = n\\hat{p}^2$。使用二次公式 $p = (-B \\pm \\sqrt{B^2-4AC})/(2A)$，端点为：\n$$ p = \\frac{2n\\hat{p} + z_{\\alpha/2}^2 \\pm \\sqrt{(2n\\hat{p} + z_{\\alpha/2}^2)^2 - 4(n+z_{\\alpha/2}^2)(n\\hat{p}^2)}}{2(n+z_{\\alpha/2}^2)} $$\n判别式可简化为 $B^2 - 4AC = z_{\\alpha/2}^2(4n\\hat{p}(1-\\hat{p}) + z_{\\alpha/2}^2)$。代入 $\\hat{p}=k/n$：\n$$ p = \\frac{2k + z_{\\alpha/2}^2 \\pm z_{\\alpha/2}\\sqrt{4k(1-k/n) + z_{\\alpha/2}^2}}{2(n+z_{\\alpha/2}^2)} $$\n这个公式定义了威尔逊得分区间的下界和上界，即 $[L_W(k,n,\\alpha), U_W(k,n,\\alpha)]$。根据其构造，所得区间包含在 $[0,1]$ 内。\n\n#### 1.2. 沃尔德区间\n沃尔德区间基于最大似然估计 (MLE) $\\hat{p}=k/n$ 分布的大样本正态近似。$\\hat{p}$ 的方差为 $p(1-p)/n$，通过代入 MLE 进行估计，得到估计的标准误 $\\text{SE}(\\hat{p}) = \\sqrt{\\hat{p}(1-\\hat{p})/n}$。\n沃尔德区间以 $\\hat{p}$ 为中心，其误差范围由 $z_{\\alpha/2}$ 决定：\n$$ \\left[ \\hat{p} - z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}, \\quad \\hat{p} + z_{\\alpha/2}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} \\right] $$\n该区间在 $n$ 较小以及 $p$ 接近 0 或 1 时表现不佳。当 $k=0$ 或 $k=n$ 时，$\\hat{p}$ 分别为 0 或 1，导致标准误变为 0，区间坍缩为一个点。根据题目要求，端点被截断到区间 $[0,1]$。\n\n#### 1.3. 克洛普-皮尔逊区间\n克洛普-皮尔逊区间是一种“精确”方法，它基于反演两个单边二项检验，确保对于所有的 $p$，覆盖概率至少为 $1-\\alpha$。其端点 $[p_L, p_U]$ 定义如下：\n1. 下界 $p_L$ 是方程 $P(K \\ge k | p=p_L) = \\sum_{i=k}^{n} \\binom{n}{i}p_L^i(1-p_L)^{n-i} = \\alpha/2$ 的解。\n2. 上界 $p_U$ 是方程 $P(K \\le k | p=p_U) = \\sum_{i=0}^{k} \\binom{n}{i}p_U^i(1-p_U)^{n-i} = \\alpha/2$ 的解。\n\n这些方程可以使用二项累积分布函数 (CDF) 和正则化不完全 Beta 函数之间的关系来求解。解由 Beta 分布的分位数给出：\n- $p_L = \\text{BetaInv}(\\alpha/2; k, n-k+1)$\n- $p_U = \\text{BetaInv}(1-\\alpha/2; k+1, n-k)$\n其中 $\\text{BetaInv}(q; a, b)$ 是形状参数为 $a$ 和 $b$ 的 Beta 分布的 $q$ 分位数。\n对于极端情况：\n- 如果 $k=0$，下界方程为 $P(K \\ge 0 | p_L) = 1 = \\alpha/2$，此方程无解。下界取为 $p_L=0$。\n- 如果 $k=n$，上界方程为 $P(K \\le n | p_U) = 1 = \\alpha/2$，同样无解。上界取为 $p_U=1$。\n这些约定与 Beta 分布分位数函数的极限是一致的。\n\n### 2. 评估指标与算法\n\n这些区间估计量的性能通过两个指标进行评估，这两个指标是通过对所有可能的结果 $k \\in \\{0, 1, \\dots, n\\}$ 进行加权（权重为其二项概率）求和计算得出的。\n\n- **覆盖概率**：随机区间 $[L(K), U(K)]$ 包含真实参数 $p$ 的概率。\n$$ \\text{coverage}(n,p,\\alpha) = \\sum_{k=0}^{n} \\mathbb{I}\\{L(n,k,\\alpha) \\le p \\le U(n,k,\\alpha)\\} \\cdot \\binom{n}{k} p^k (1-p)^{n-k} $$\n- **期望长度**：区间的平均长度。\n$$ \\text{Elen}(n,p,\\alpha) = \\sum_{k=0}^{n} \\left(U(n,k,\\alpha) - L(n,k,\\alpha)\\right) \\cdot \\binom{n}{k} p^k (1-p)^{n-k} $$\n这里，$\\mathbb{I}\\{\\cdot\\}$ 是指示函数。\n\n为给定 $(n, p, \\alpha)$ 计算这些指标的算法如下：\n1. 初始化六个累加器为 0：三种方法（沃尔德、威尔逊、克洛普-皮尔逊）中的每一种都有一个用于覆盖率，一个用于长度。\n2. 计算标准正态分位数 $z_{\\alpha/2}$。\n3. 对于从 0 到 $n$ 的每个整数 $k$：\n   a. 计算二项概率 $P(K=k) = \\binom{n}{k} p^k (1-p)^{n-k}$。\n   b. 对三种方法中的每一种，计算与观测值 $k$ 对应的置信区间 $[L, U]$。\n   c. 对每种方法，如果真实参数 $p$ 位于其计算出的区间 $[L, U]$ 内，则将步骤 3a 中的概率加到该方法的覆盖率累加器中。\n   d. 对每种方法，将区间长度 $(U-L)$ 与步骤 3a 中的概率的乘积加到该方法的期望长度累加器中。\n4. 在遍历所有 $k$ 之后，累加器将保存每种方法的覆盖概率和期望长度的最终值。实现遵循此精确求和过程。", "answer": "$$[[0.929807,0.358581,0.966652,0.457817,0.991386,0.536966],[0.951476,0.303961,0.951476,0.306915,0.957235,0.312955],[0.773781,0.129322,0.950000,0.316881,0.997577,0.443049],[0.934827,0.165447,0.958289,0.174116,0.976078,0.182061],[0.500000,0.500000,1.000000,0.810575,1.000000,0.900000],[0.735759,0.038165,0.952554,0.057394,0.985994,0.063864]]$$", "id": "4957555"}]}