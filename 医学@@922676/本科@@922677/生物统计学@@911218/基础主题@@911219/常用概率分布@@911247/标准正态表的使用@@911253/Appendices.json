{"hands_on_practices": [{"introduction": "本节的第一个练习将重点介绍一项基本技能：为正态分布变量计算概率。我们将引导您完成标准化的过程，该过程将任何正态分布转换为标准正态分布，然后使用标准正态分布表来查找所需的概率。这个练习 [@problem_id:4964786] 对于掌握处理正态分布的核心技巧至关重要。", "problem": "一位生物统计学家将成人舒张压建模为一个连续随机变量 $X$，单位为毫米汞柱 (mmHg)，其中 $X$ 服从均值为 $\\mu$、标准差为 $\\sigma$ 的正态分布。对于一个特定人群，经验研究支持将 $X$ 建模为 $\\mu = 80$ 和 $\\sigma = 12$ 的正态分布。请仅从累积分布函数 (CDF) 的定义以及正态随机变量仿射变换的分布特性出发，推导一个分步算法，通过标准化和查找仅列出 $z \\ge 0$ 时 $\\Phi(z) = P(Z \\le z)$ 值的标准正态分布表，来计算 $P(a  X  b)$，其中 $Z$ 表示一个标准正态随机变量。您的算法必须明确说明如何处理负的标准化边界值以及 $a$ 和 $b$ 的顺序问题。推导出算法后，请应用该算法，仅使用可从标准正态分布表中获得的值，计算该人群中 $P(68  X  95)$ 的值，并将最终概率四舍五入至四位有效数字。请以小数形式表示您的答案，不要使用百分号。", "solution": "题目要求推导一个计算一般正态分布变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的区间概率 $P(a  X  b)$ 的算法，并应用该算法解决具体问题。\n\n**第一部分：通用算法的推导**\n\n1.  **用CDF表示概率**：对于任何连续随机变量 $X$，其在区间 $(a, b)$ 内的概率为 $P(a  X  b) = P(X \\le b) - P(X \\le a)$。这可以用 $X$ 的累积分布函数 (CDF) $F_X(x)$ 表示为 $F_X(b) - F_X(a)$。为使区间有意义，我们假设 $a  b$。\n\n2.  **标准化**: 任何正态变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 都可以通过变换 $Z = \\frac{X - \\mu}{\\sigma}$ 转化为标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$。因此，$P(X \\le x)$ 等价于 $P(Z \\le \\frac{x - \\mu}{\\sigma})$。用标准正态CDF $\\Phi(z)$ 表示，我们有 $F_X(x) = \\Phi(\\frac{x - \\mu}{\\sigma})$。\n\n3.  **最终表达式**: 结合以上两点，区间概率可以完全用标准正态CDF表示：\n    $$P(a  X  b) = \\Phi\\left(\\frac{b - \\mu}{\\sigma}\\right) - \\Phi\\left(\\frac{a - \\mu}{\\sigma}\\right)$$\n\n4.  **处理负Z值**: 由于标准正态分布关于0对称，其CDF满足恒等式 $\\Phi(-z) = 1 - \\Phi(z)$。这使得我们可以利用只提供正z值的表格来计算任意z值的累积概率。\n\n**算法步骤**:\n1.  验证 $a  b$。\n2.  计算标准化的边界值：$z_a = (a - \\mu)/\\sigma$ 和 $z_b = (b - \\mu)/\\sigma$。\n3.  使用标准正态表查找 $\\Phi(z_a)$ 和 $\\Phi(z_b)$ 的值。如果z值为负，则利用对称性 $\\Phi(-z) = 1 - \\Phi(z)$ 计算。\n4.  计算最终概率：$\\Phi(z_b) - \\Phi(z_a)$。\n\n**第二部分：算法的应用**\n\n我们需要计算 $P(68  X  95)$，其中 $X \\sim \\mathcal{N}(\\mu=80, \\sigma=12)$。\n\n1.  **验证边界**: $a=68$, $b=95$。由于 $68  95$，我们可以继续。\n\n2.  **标准化**:\n    $$z_a = \\frac{68 - 80}{12} = -1.00$$\n    $$z_b = \\frac{95 - 80}{12} = 1.25$$\n\n3.  **计算概率**:\n    $$P(68  X  95) = P(-1.00  Z  1.25) = \\Phi(1.25) - \\Phi(-1.00)$$\n\n4.  **查表与计算**:\n    -   从表中查得 $\\Phi(1.25) \\approx 0.8944$。\n    -   利用对称性计算 $\\Phi(-1.00) = 1 - \\Phi(1.00)$。查表得 $\\Phi(1.00) \\approx 0.8413$，所以 $\\Phi(-1.00) \\approx 1 - 0.8413 = 0.1587$。\n    -   最终概率为：$0.8944 - 0.1587 = 0.7357$。\n\n将结果四舍五入至四位小数，我们得到 $0.7357$。", "answer": "$$\\boxed{0.7357}$$", "id": "4964786"}, {"introduction": "在概率计算的基础上，这个练习将探讨生物统计学中的一个常见应用：构建置信区间和确定样本量。在这里，您将学习如何在正态分布表中执行“反向查找”，以找到定义给定置信水平边界的关键值（例如 $z_{0.975}$）。这项技能 [@problem_id:4964856] 对于设计实验和解释研究结果至关重要。", "problem": "在一项临床生物标志物研究中，独立测量值 $X_{1}, X_{2}, \\dots, X_{n}$ 被建模为均值为 $\\mu$、标准差 $\\sigma$ 已知的同分布正态随机变量。令 $\\overline{X}$ 表示样本均值。研究人员通常会报告名义覆盖率为 $c \\in (0,1)$ 的双侧正态理论置信区间，并使用相应的临界值来构建假设检验的拒绝域。仅使用以下基础事实和定义作为出发点，推导出一个公式，用于计算在双側置信区间中达到预设绝对误差范围 $M0$ 所需的最小样本量，然后将其特例化以比较两种常见的覆盖水平：\n- 在模型假设下，$(\\overline{X}-\\mu)/(\\sigma/\\sqrt{n})$ 服从标准正态分布的分布事实。\n- 标准正态分布的累积分布函数 (CDF) $\\Phi(z)$ 的定义，以及对于 $p \\in (0,1)$ 满足 $\\Phi(z_{p})=p$ 的相关分位数 $z_{p}$。\n\n您必须说明双侧名义覆盖率 $c$ 如何确定出现在置信区间半宽中的相应标准正态分位数。然后，对于双侧覆盖水平 $c=0.95$ 和 $c=0.90$，用标准正态分位数表示所需最小样本量之比 $R$：\n$$\nR \\;=\\; \\frac{n_{0.95}}{n_{0.90}},\n$$\n确定所需的具体表条目，并通过从标准正态表中读取这些分位数来计算 $R$。作为您推理的一部分，请简要说明这些分位数在生物统计学中是如何被规范地用于构建双侧置信区间和假设检验中的临界区的。\n\n将您的最终数值答案 $R$ 四舍五入到四位有效数字。答案中不要包含任何单位，也不要使用百分号；请将概率表示为 $(0,1)$ 范围内的小数。", "solution": "该问题要求推导一个公式，用于计算在正态均值的双侧置信区间中达到指定误差范围所需的最小样本量，然后使用该公式比较置信水平为 $95\\%$ 和 $90\\%$ 时所需的样本量。\n\n令随机变量 $Z$ 定义为 $Z = \\frac{\\overline{X}-\\mu}{\\sigma/\\sqrt{n}}$。根据问题陈述，$Z$ 服从标准正态分布，记为 $Z \\sim N(0,1)$。$Z$ 的累积分布函数 (CDF) 为 $\\Phi(z) = P(Z \\le z)$，其对应的分位数函数给出满足 $\\Phi(z_p) = p$ 的值 $z_p$。\n\n对于均值 $\\mu$，名义覆盖概率为 $c \\in (0,1)$ 的双侧置信区间是根据关于 $Z$ 的概率陈述构建的。我们寻找一个对称区间 $[-z^*, z^*]$，使得 $P(-z^* \\le Z \\le z^*) = c$。\n根据 CDF 的性质，这个概率可以写成：\n$$P(-z^* \\le Z \\le z^*) = \\Phi(z^*) - \\Phi(-z^*)$$\n由于标准正态分布关于 $0$ 对称，我们有 $\\Phi(-z^*) = 1 - \\Phi(z^*)$。将其代入方程得到：\n$$\\Phi(z^*) - (1 - \\Phi(z^*)) = 2\\Phi(z^*) - 1$$\n我们令其等于期望的覆盖率 $c$：\n$$2\\Phi(z^*) - 1 = c$$\n求解 $\\Phi(z^*)$ 得：\n$$\\Phi(z^*) = \\frac{1+c}{2}$$\n这意味着临界值 $z^*$ 是对应于累积概率为 $\\frac{1+c}{2}$ 的分位数。使用问题中的记法，$z^* = z_{(1+c)/2}$。\n\n在生物统计学中，这种分位数的选择对于双侧推断是规范性的。它定义了概率质量中心部分占比为 $c$ 的边界。剩余的概率 $1-c$ 被均等地分配到分布的两个尾部，每个尾部的面积为 $\\frac{1-c}{2}$。对于显著性水平为 $\\alpha$ 的假设检验，双侧检验的临界值是那些定义了总概率为 $\\alpha$ 的拒绝域的值。临界值为 $\\pm z_{1-\\alpha/2}$。双侧检验与置信区间之间的形式等价性是通过设置显著性水平 $\\alpha = 1-c$ 来建立的，这导致临界值为 $\\pm z_{1-(1-c)/2} = \\pm z_{(1+c)/2}$，与用于置信区间的值相同。\n\n现在，我们通过将 $Z$ 的表达式代入概率陈述来构建置信区间：\n$$P\\left(-z_{(1+c)/2} \\le \\frac{\\overline{X}-\\mu}{\\sigma/\\sqrt{n}} \\le z_{(1+c)/2}\\right) = c$$\n为了分离出 $\\mu$，我们重排不等式：\n$$-z_{(1+c)/2} \\frac{\\sigma}{\\sqrt{n}} \\le \\overline{X}-\\mu \\le z_{(1+c)/2} \\frac{\\sigma}{\\sqrt{n}}$$\n$$- \\overline{X} - z_{(1+c)/2} \\frac{\\sigma}{\\sqrt{n}} \\le -\\mu \\le -\\overline{X} + z_{(1+c)/2} \\frac{\\sigma}{\\sqrt{n}}$$\n乘以 $-1$ 并反转不等式，得到：\n$$\\overline{X} - z_{(1+c)/2} \\frac{\\sigma}{\\sqrt{n}} \\le \\mu \\le \\overline{X} + z_{(1+c)/2} \\frac{\\sigma}{\\sqrt{n}}$$\n这个表达式定义了 $\\mu$ 的 $100c\\%$ 置信区间。该区间以 $\\overline{X}$ 为中心，其半宽（称为误差范围 $M$）由下式给出：\n$$M = z_{(1+c)/2} \\frac{\\sigma}{\\sqrt{n}}$$\n问题指定了一个期望的绝对误差范围 $M > 0$。为求得达到此目标所需的最小样本量 $n$，我们对上述方程求解 $n$：\n$$\\sqrt{n} = \\frac{z_{(1+c)/2} \\sigma}{M}$$\n$$n = \\left(\\frac{z_{(1+c)/2} \\sigma}{M}\\right)^2$$\n由于样本量必须是整数，所需的最小样本量是大于或等于此值的最小整数，即 $n_{\\text{min}} = \\lceil \\left(\\frac{z_{(1+c)/2} \\sigma}{M}\\right)^2 \\rceil$。为了计算不同覆盖水平下的样本量之比，常数 $\\sigma$ 和 $M$ 将会抵消，而向上取整函数的影响通常被忽略，将 $n$ 视为一个连续量进行比较。\n\n我们现在将此公式特例化用于两种指定的覆盖水平，$c_1=0.95$ 和 $c_2=0.90$。\n\n对于 $c = 0.95$：\n所需的分位数是 $z_{(1+0.95)/2} = z_{0.975}$。样本量记为 $n_{0.95}$，为：\n$$n_{0.95} = \\left(\\frac{z_{0.975} \\sigma}{M}\\right)^2$$\n\n对于 $c = 0.90$：\n所需的分位数是 $z_{(1+0.90)/2} = z_{0.95}$。样本量记为 $n_{0.90}$，为：\n$$n_{0.90} = \\left(\\frac{z_{0.95} \\sigma}{M}\\right)^2$$\n\n这些所需样本量之比 $R$ 为：\n$$R = \\frac{n_{0.95}}{n_{0.90}} = \\frac{\\left(\\frac{z_{0.975} \\sigma}{M}\\right)^2}{\\left(\\frac{z_{0.95} \\sigma}{M}\\right)^2} = \\left(\\frac{z_{0.975}}{z_{0.95}}\\right)^2$$\n\n为了计算 $R$ 的数值，我们必须从标准正态表中查找 $z_{0.975}$ 和 $z_{0.95}$ 的值。\n1. 对于 $z_{0.975}$，我们在表的主体部分查找累积概率 $p=0.9750$。该条目对应的 z-分数为 $1.96$。因此，$z_{0.975} = 1.96$。\n2. 对于 $z_{0.95}$，我们查找累积概率 $p=0.9500$。标准表通常显示 $\\Phi(1.64) = 0.9495$ 和 $\\Phi(1.65) = 0.9505$。$p=0.9500$ 这个值恰好位于这两个概率的中间。通过线性插值（或查阅更高精度的表），对应的 z-分数为 $1.645$。因此，$z_{0.95} = 1.645$。\n\n将这些分位数的值代入 $R$ 的表达式中：\n$$R = \\left(\\frac{1.96}{1.645}\\right)^2$$\n计算其值：\n$$R \\approx (1.19148936...)^2 \\approx 1.4196469...$$\n将结果四舍五入到四位有效数字，我们得到 $1.420$。", "answer": "$$\\boxed{1.420}$$", "id": "4964856"}, {"introduction": "正态分布的强大之处在于它能够近似其他分布，这一概念植根于中心极限定理。最后一个练习 [@problem_id:4964841] 将演示如何使用正态分布来近似二项式概率，这是临床试验中的常见情景。您还将研究“连续性校正”，这是一个微小的调整，却能显著提高近似的准确性，从而凸显了审慎应用统计工具的重要性。", "problem": "在一项二元临床检测的验证性研究中，考虑在 $n=20$ 次独立试验中检测出的阳性数量 $X$，每次试验的成功概率为 $p=0.5$。我们感兴趣的尾部概率是至少有10次检出的概率，即 $P(X \\geq 10)$。\n\n从二项分布的定义以及当 $p=0.5$ 时的对称性出发，用单点概率 $P(X=10)$ 来表示 $P(X \\geq 10)$ 的精确值。然后，利用中心极限定理 (CLT) 中标准化的二项变量趋近于标准正态分布这一经过充分检验的结果，用两种方法近似计算 $P(X \\geq 10)$：\n- 不使用连续性校正，将离散尾部 $X \\geq 10$ 直接映射到标准正态变量 $Z$ 的一个尾部；\n- 使用连续性校正，将离散事件 $X \\geq 10$ 映射到正态变量 $Y$ 的连续事件 $Y \\geq 9.5$。\n\n使用标准正态分布表计算这两种正态近似值。为确保您的计算是基于表格的，请使用以下标准正态累积分布函数 (CDF) 的值和性质进行插值：\n- $\\Phi(0)=0.5$，\n- $\\Phi(0.22)=0.5871$，\n- $\\Phi(0.23)=0.5910$，\n- $\\Phi(-z)=1-\\Phi(z)$，\n并根据需要在 $z=0.22$ 和 $z=0.23$ 之间进行线性插值。\n\n最后，通过构建绝对误差之比来量化准确性的提升，\n$$\nR \\;=\\; \\frac{\\left|P_{\\text{normal,no-cc}} - P_{\\text{exact}}\\right|}{\\left|P_{\\text{normal,cc}} - P_{\\text{exact}}\\right|}.\n$$\n将 $R$ 的最终数值四舍五入到四位有效数字。最终答案不需要单位。", "solution": "该问题要求进行四部分计算：精确概率、两种正态近似，以及它们的误差之比。\n\n**第1部分：精确概率 ($P_{\\text{exact}}$)**\n随机变量 $X$ 服从二项分布 $B(n=20, p=0.5)$。其概率质量函数 (PMF) 由下式给出：\n$$\nP(X=k) = \\binom{n}{k} p^k (1-p)^{n-k} = \\binom{20}{k} (0.5)^k (0.5)^{20-k} = \\binom{20}{k} (0.5)^{20}\n$$\n我们需要计算 $P_{\\text{exact}} = P(X \\geq 10)$。\n当 $p=0.5$ 时，二项分布关于其均值 $\\mu=np=10$ 对称。这种对称性意味着 $P(X=k) = P(X=n-k)$。\n总概率为 $\\sum_{k=0}^{20} P(X=k) = 1$。我们可以将这个和式拆分为：\n$$\n\\sum_{k=0}^{9} P(X=k) + P(X=10) + \\sum_{k=11}^{20} P(X=k) = 1\n$$\n利用对称性，$\\sum_{k=11}^{20} P(X=k) = \\sum_{j=0}^{9} P(X=j)$。代入总概率方程中得到 $2 \\sum_{k=0}^{9} P(X=k) + P(X=10) = 1$，因此 $\\sum_{k=0}^{9} P(X=k) = \\frac{1 - P(X=10)}{2}$。\n所求概率为 $P(X \\geq 10) = P(X=10) + \\sum_{k=11}^{20} P(X=k)$。再次利用对称性，$\\sum_{k=11}^{20} P(X=k) = \\sum_{k=0}^{9} P(X=k)$。\n$$\nP_{\\text{exact}} = P(X \\geq 10) = P(X=10) + \\frac{1 - P(X=10)}{2} = \\frac{1 + P(X=10)}{2}\n$$\n现在我们计算 $P(X=10)$ 的值：\n$$\nP(X=10) = \\binom{20}{10} (0.5)^{20} = \\frac{184756}{2^{20}} = \\frac{184756}{1048576} \\approx 0.17619705\n$$\n将此代入 $P_{\\text{exact}}$ 的表达式中：\n$$\nP_{\\text{exact}} \\approx \\frac{1 + 0.17619705}{2} \\approx 0.588098525\n$$\n\n**第2部分：不带连续性校正的正态近似 ($P_{\\text{normal,no-cc}}$)**\n我们用正态分布 $Y \\sim N(\\mu, \\sigma^2)$ 来近似二项分布 $X \\sim B(n=20, p=0.5)$。\n均值为 $\\mu = np = 20(0.5) = 10$。\n方差为 $\\sigma^2 = np(1-p) = 20(0.5)(0.5) = 5$，因此标准差为 $\\sigma = \\sqrt{5}$。\n不使用连续性校正，我们用 $P(Y \\geq 10)$ 来近似 $P(X \\geq 10)$。\n我们将变量 $Y$ 标准化为标准正态变量 $Z = \\frac{Y-\\mu}{\\sigma} \\sim N(0,1)$。\n$$\nP(Y \\geq 10) = P\\left(\\frac{Y - 10}{\\sqrt{5}} \\geq \\frac{10 - 10}{\\sqrt{5}}\\right) = P(Z \\geq 0)\n$$\n使用给定的CDF值 $\\Phi(0)=0.5$，我们有：\n$$\nP(Z \\geq 0) = 1 - P(Z  0) = 1 - \\Phi(0) = 1 - 0.5 = 0.5\n$$\n因此，$P_{\\text{normal,no-cc}} = 0.5$。\n\n**第3部分：带连续性校正的正态近似 ($P_{\\text{normal,cc}}$)**\n使用连续性校正，离散事件 $X \\geq 10$ 被近似为连续事件 $Y \\geq 10 - 0.5 = 9.5$。\n我们计算 $P(Y \\geq 9.5)$。将其标准化得到：\n$$\nP(Y \\geq 9.5) = P\\left(Z \\geq \\frac{9.5 - 10}{\\sqrt{5}}\\right) = P\\left(Z \\geq \\frac{-0.5}{\\sqrt{5}}\\right) = P\\left(Z \\geq -0.2236068\\right)\n$$\n利用性质 $P(Z \\geq -z) = P(Z \\leq z) = \\Phi(z)$，我们有 $P_{\\text{normal,cc}} = \\Phi(0.2236068)$。\n我们使用线性插值来求这个值。自变量为 $z_c \\approx 0.2236$。\n我们在给定点 $z_1 = 0.22$ 和 $z_2 = 0.23$ 之间进行插值，其中 $\\Phi(z_1) = 0.5871$ 和 $\\Phi(z_2) = 0.5910$。\n线性插值公式为 $\\Phi(z_c) \\approx \\Phi(z_1) + \\frac{z_c - z_1}{z_2 - z_1}(\\Phi(z_2) - \\Phi(z_1))$。\n$$\nP_{\\text{normal,cc}} \\approx 0.5871 + \\frac{0.2236068 - 0.22}{0.23 - 0.22}(0.5910 - 0.5871)\n$$\n$$\nP_{\\text{normal,cc}} \\approx 0.5871 + \\frac{0.0036068}{0.01}(0.0039) \\approx 0.5871 + (0.36068)(0.0039) \\approx 0.58850665\n$$\n\n**第4部分：绝对误差之比 ($R$)**\n该比率定义为 $R = \\frac{\\left|P_{\\text{normal,no-cc}} - P_{\\text{exact}}\\right|}{\\left|P_{\\text{normal,cc}} - P_{\\text{exact}}\\right|}$。\n不带连续性校正的近似的绝对误差为：\n$$\nE_{\\text{no-cc}} = |0.5 - 0.588098525| = 0.088098525\n$$\n带连续性校正的近似的绝对误差为：\n$$\nE_{\\text{cc}} = |0.58850665 - 0.588098525| = 0.000408125\n$$\n现在，我们计算比率 $R$：\n$$\nR = \\frac{0.088098525}{0.000408125} \\approx 215.85965...\n$$\n将结果四舍五入到四位有效数字，得到 $215.9$。", "answer": "$$\\boxed{215.9}$$", "id": "4964841"}]}