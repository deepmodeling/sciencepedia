{"hands_on_practices": [{"introduction": "假设检验和置信区间是统计推断的两个核心工具。本练习旨在巩固单样本 t 检验的基本计算，并揭示一个基本原理：两者之间的对偶性。通过计算置信区间并进行相应的假设检验，你将亲手验证一个 $(1-\\alpha)$ 置信区间如何包含了所有在显著性水平 $\\alpha$ 下不会被双侧检验拒绝的原假设值 [@problem_id:4934484]。掌握这一联系对于准确解释统计结果至关重要。", "problem": "一个临床研究团队正在研究标准化干预后血清中C反应蛋白的平均浓度。假设浓度的基础群体分布是方差未知的近似正态分布。一个大小为 $n=25$ 的简单随机样本产生的样本均值为 $\\bar{x}=9.8$，样本标准差为 $s=2.5$（单位均为 $\\mathrm{mg}/\\mathrm{L}$）。考虑在显著性水平 $\\alpha=0.05$ 下对 $H_{0}:\\ \\mu=\\mu_{0}$ 与 $H_{1}:\\ \\mu\\neq\\mu_{0}$ 进行双侧假设检验，其中 $\\mu_{0}=9$（单位为 $\\mathrm{mg}/\\mathrm{L}$）。使用适用于单样本 $t$ 程序的首要原则，计算真实均值 $\\mu$ 的 $95\\%$ $t$-置信区间，并验证相应的在 $\\alpha=0.05$ 水平下的双侧单样本 $t$-检验的决策是否与 $\\mu_{0}$ 是否包含在置信区间内相匹配。报告两个区间端点，并将检验决策数值编码为：$1$ 表示“拒绝 $H_{0}$”，$0$ 表示“未能拒绝 $H_{0}$”。将所有报告的数值四舍五入至四位有效数字。区间端点以 $\\mathrm{mg}/\\mathrm{L}$ 为单位表示。", "solution": "该问题要求我们基于给定的样本数据，计算总体均值 $\\mu$ 的95%置信区间，并进行单样本t检验，最后验证两者结论的一致性。由于总体方差未知，t检验是合适的方法。\n\n**1. 计算95%置信区间**\n\n$\\mu$ 的 $(1-\\alpha) \\times 100\\%$ 置信区间的公式为：\n$$ \\bar{x} \\pm t_{\\alpha/2, n-1} \\frac{s}{\\sqrt{n}} $$\n根据题意，我们有：\n-   样本均值 $\\bar{x} = 9.8$\n-   样本标准差 $s = 2.5$\n-   样本大小 $n = 25$\n-   显著性水平 $\\alpha = 0.05$\n\n首先，计算自由度（df）和标准误（SE）：\n-   自由度 $df = n-1 = 25-1 = 24$。\n-   标准误 $SE_{\\bar{x}} = \\frac{s}{\\sqrt{n}} = \\frac{2.5}{\\sqrt{25}} = 0.5$。\n\n接下来，查找t分布的临界值。对于95%的双侧置信区间，我们需要 $t_{0.025, 24}$。查表或使用软件可得 $t_{0.025, 24} \\approx 2.0639$。\n\n计算误差边际（ME）：\n$$ ME = t_{0.025, 24} \\times SE_{\\bar{x}} \\approx 2.0639 \\times 0.5 = 1.03195 $$\n\n最后，计算置信区间：\n$$ \\text{CI} = \\bar{x} \\pm ME = 9.8 \\pm 1.03195 = (8.76805, 10.83195) $$\n将端点四舍五入至四位有效数字，得到：\n-   下端点：$8.768$ $\\mathrm{mg}/\\mathrm{L}$\n-   上端点：$10.83$ $\\mathrm{mg}/\\mathrm{L}$\n\n**2. 进行单样本t检验**\n\n我们要检验的假设是：\n-   $H_0: \\mu = 9$\n-   $H_1: \\mu \\neq 9$\n\nt检验统计量的计算公式为：\n$$ t = \\frac{\\bar{x} - \\mu_0}{s/\\sqrt{n}} = \\frac{9.8 - 9}{0.5} = \\frac{0.8}{0.5} = 1.6 $$\n\n我们将计算出的t值与临界值进行比较。在 $\\alpha=0.05$ 的双侧检验中，拒绝域为 $|t| > t_{0.025, 24} \\approx 2.0639$。\n由于 $|1.6| = 1.6  2.0639$，我们的t统计量不落在拒绝域内。因此，我们**未能拒绝原假设 $H_0$**。\n根据题意，该决策的数值编码为 $0$。\n\n**3. 验证对偶性**\n\n对偶性原理指出，在显著性水平 $\\alpha$ 下，如果一个值 $\\mu_0$ 包含在 $(1-\\alpha)$ 置信区间内，那么以该值为原假设的t检验将不会拒绝 $H_0$。\n-   我们计算的95%置信区间是 $(8.768, 10.83)$。\n-   我们的原假设值是 $\\mu_0 = 9$。\n\n由于 $8.768  9  10.83$，$\\mu_0=9$ 确实位于置信区间内。这与我们未能拒绝 $H_0$ 的检验决策完全一致。验证成功。\n\n**最终答案**\n\n-   置信区间下端点：$8.768$\n-   置信区间上端点：$10.83$\n-   检验决策代码：$0$", "answer": "$$\n\\boxed{\\begin{pmatrix} 8.768  10.83  0 \\end{pmatrix}}\n$$", "id": "4934484"}, {"introduction": "理论计算通常基于理想假设，但真实世界的数据很少能完美符合这些假设。本练习将引导你思考一个在实践中常见的问题：当 t 检验的正态性假设不完全满足时该如何处理 [@problem_id:4934529]。你将学习到 t 检验在何种程度上对偏离正态性的情况具有“稳健性”，并理解如何结合探索性数据分析做出明智的判断，而不是机械地应用规则。", "problem": "一项临床试验评估了一种新的饮食干预后收缩压（单位：毫米汞柱）的平均变化。对于 $n=20$ 名参与者，观察到的样本均值变化为 $\\bar{x}=-6.2$，样本标准差为 $s=8.5$。主要目标是检验 $H_0:\\mu=0$ 与 $H_1:\\mu0$，其中 $\\mu$ 是总体均值变化。探索性图表显示数据呈轻度右偏，没有极端离群值。对这些变化应用Shapiro-Wilk正态性检验，得到的$p$值为 $p=0.03$。\n\n你的任务是决定如何对 $\\mu$ 进行推断，并通过明确引用基本原理来证明你的选择，这些原理包括均值的抽样分布、单样本 $t$ 检验中分布假设的作用，以及正态性检验 $p$ 值的解释。选择唯一的最佳选项。\n\nA. 在预设的显著性水平下，继续进行关于 $\\mu$ 的单样本 $t$ 检验，并指出在没有极端离群值的情况下，对于 $n=20$ 的样本量，该检验对轻度非正态性具有稳健性，同时辅以敏感性分析（例如，Wilcoxon 符号秩检验）来证实结论。\n\nB. 放弃 $t$ 检验，改用单样本 $z$ 检验，因为 $p=0.03$ 使 $t$ 检验无效，而 $z$ 检验不需要分布假设。\n\nC. 当正态性检验的 $p0.05$ 时，不使用任何参数方法；仅使用 Wilcoxon 符号秩检验，因为拒绝正态性原假设会自动使 $t$ 检验变得不适用。\n\nD. 将显著性水平提高到 $\\alpha=0.10$ 以补偿 Shapiro-Wilk 检验检测到的非正态性，这会使检验更加保守。\n\nE. 对数据进行变换，直到达到精确正态性，然后应用单样本 $t$ 检验；如果无法达到精确正态性，则无法对 $\\mu$ 进行推断。", "solution": "这个问题要求我们在面对轻度非正态数据时，选择最合适的统计推断策略。核心在于理解t检验的稳健性以及如何解读正态性检验的结果。\n\n**情景分析：**\n-   样本量 $n=20$，属于中等偏小。\n-   数据分布呈“轻度右偏”，且“没有极端离群值”。\n-   Shapiro-Wilk正态性检验的结果是显著的（$p=0.03$），意味着我们有证据拒绝数据来自正态分布的原假设。\n\n**选项分析：**\n\n**A. （正确选项）** 这个选项体现了统计实践中一种务实且严谨的态度。\n    -   **t检验的稳健性**：单样本t检验对违反其正态性假设的情况具有一定的稳健性，这主要归功于中心极限定理（CLT）。即使原始数据非正态，样本均值的抽样分布也会随着样本量的增加而趋于正态。对于$n=20$的样本量，且数据仅为“轻度”偏态且无离群值，t检验的结果（特别是第一类错误率）通常仍然是相当可靠的。\n    -   **敏感性分析**：承认正态性假设可能被违反，并使用一个非参数检验（如Wilcoxon符号秩检验）来验证t检验的结论，是一种优秀的科学实践。如果两种方法得出相似的结论，我们会对结果更有信心。如果结论不同，则需要进一步探究原因。这表明了一种审慎而非教条的方法。\n\n**B. （错误选项）**\n    -   单样本z检验要求总体方差 $\\sigma^2$ 已知，而本题中方差是未知的（只能从样本中估计标准差 $s=8.5$）。因此，z检验根本不适用。\n    -   z检验同样依赖于（或受益于）样本均值的正态性，因此它并不是解决非正态性问题的办法。\n\n**C. （错误选项）**\n    -   这是一个过于僵化和教条的规则。正态性检验（如Shapiro-Wilk）在样本量不大时功效有限，而在样本量较大时又过于敏感，可能会因为微不足道的偏离而拒绝正态性。将 $p0.05$ 作为一个自动触发器来完全放弃t检验，忽略了t检验对轻度偏离的稳健性。这是一种“机械式”统计，而非深思熟虑的分析。\n\n**D. （错误选项）**\n    -   显著性水平 $\\alpha$ 是我们愿意承担的第一类错误（错误地拒绝真原假设）的风险阈值。将其从（通常的）0.05提高到0.10会使检验变得更“激进”（更容易拒绝原假设），而不是更“保守”。这样做与补偿非正态性没有任何逻辑关系。\n\n**E. （错误选项）**\n    -   寻求通过变换达到“精确正态性”往往是不现实的，而且数据转换会改变检验的假设（例如，从算术均值变为几何均值）。更重要的是，“如果无法达到精确正态性，则无法对$\\mu$进行推断”是一个完全错误的结论。我们有稳健的参数方法和非参数方法等多种工具来处理这种情况。\n\n**结论：**\n选项A最好地平衡了理论（t检验的稳健性）与实践（承认数据的不完美并进行敏感性分析）。它代表了在真实数据分析中处理假设检验违规问题的标准方法。", "answer": "$$\\boxed{A}$$", "id": "4934529"}, {"introduction": "除了分布假设，数据中的极端异常值是统计分析面临的另一个严峻挑战。本练习通过一个具体的案例，量化展示了单个异常值如何通过不成比例地增大样本方差来扭曲标准 t 检验的结果 [@problem_id:4934504]。你将通过计算和比较，直观地感受到异常值的影响，并学习一种被称为“缩尾”（Winsorization）的稳健统计方法，作为减轻异常值影响、获得更可靠结论的实用策略。", "problem": "一项临床研究监测了一组健康成年人的空腹血糖浓度（mg/dL），以评估其总体均值是否等于一个参考值。假设观测值是来自一个连续总体的独立同分布样本，且原假设为总体均值等于 $100$ mg/dL。考虑以下来自 $10$ 名参与者的样本：$96$、$102$、$105$、$98$、$110$、$94$、$101$、$99$、$107$、$100$。然后，假设由于一个校准错误的设备，无意中引入了一个错误的极端测量值：$300$ mg/dL，从而得到一个包含 $11$ 个观测值的增广样本。\n\n从第一性原理出发——即在正态抽样下的样本均值、无偏样本方差和单样本 $t$ 统计量的定义——执行以下操作：\n\n- 使用包含 $10$ 个观测值的样本，计算无偏样本方差 $S_{\\text{clean}}^{2}$ 和用于检验均值是否等于 $100$ mg/dL 的单样本 $t$ 统计量。\n- 使用包含 $11$ 个观测值的样本（即原始的 $10$ 个观测值加上一个极端离群值 $300$ mg/dL），计算无偏样本方差 $S_{\\text{out}}^{2}$ 和用于检验均值是否等于 $100$ mg/dL 的单样本 $t$ 统计量。\n- 通过比率 $R = S_{\\text{out}}^{2} / S_{\\text{clean}}^{2}$ 来量化由离群值引起的变异性膨胀。\n- 为了进行稳健性比较，对包含 $11$ 个观测值的样本进行 $20\\%$ 的缩尾分析（winsorized analysis）：将最低的 $g$ 个和最高的 $g$ 个观测值分别替换为第 $(g+1)$ 小和第 $(n-g)$ 大的观测值，其中 $g = \\lfloor 0.2 n \\rfloor$ 且 $n = 11$。使用缩尾样本计算缩尾均值和缩尾无偏样本方差 $S_{\\text{win}}^{2}$。在常规的单样本 $t$ 构造中，用缩尾均值和 $\\sqrt{S_{\\text{win}}^{2}}$ 替换经典均值和标准差，构建一个类 $t$ 统计量。在显著性水平 $\\alpha = 0.05$（双侧）下，比较包含离群值的经典分析和缩尾稳健分析的检验决策是否发生改变。\n- 令 $t_{\\text{out}}$ 表示在包含离群值的 $11$ 个观测值样本上计算的经典 $t$ 统计量，令 $t_{\\text{win}}$ 表示在 $11$ 个观测值样本上计算的缩尾类 $t$ 统计量。定义标量\n$$\nQ \\;=\\; R \\;-\\; \\left(|t_{\\text{win}}| \\;-\\; |t_{\\text{out}}|\\right).\n$$\n\n将 $Q$ 的最终数值四舍五入到四位有效数字。最终答案以无量纲数表示。", "solution": "该问题要求我们逐步分析一个离群值对单样本t检验的影响，并使用缩尾方法进行稳健性比较。原假设为 $H_0: \\mu = 100$。\n\n**1. 对10个观测值（干净）样本的分析**\n干净样本数据 ($n_{\\text{clean}} = 10$): $\\{96, 102, 105, 98, 110, 94, 101, 99, 107, 100\\}$。\n\n-   **样本均值 $\\bar{x}_{\\text{clean}}$**:\n    $$ \\bar{x}_{\\text{clean}} = \\frac{96+102+105+98+110+94+101+99+107+100}{10} = \\frac{1012}{10} = 101.2 $$\n-   **无偏样本方差 $S_{\\text{clean}}^{2}$**:\n    $$ \\sum (x_i - \\bar{x}_{\\text{clean}})^2 = (96-101.2)^2 + \\dots + (100-101.2)^2 = 221.6 $$\n    $$ S_{\\text{clean}}^{2} = \\frac{221.6}{10-1} = \\frac{221.6}{9} \\approx 24.6222 $$\n-   **t统计量 $t_{\\text{clean}}$**:\n    $$ t_{\\text{clean}} = \\frac{\\bar{x}_{\\text{clean}} - \\mu_0}{\\sqrt{S_{\\text{clean}}^{2} / n_{\\text{clean}}}} = \\frac{101.2 - 100}{\\sqrt{24.6222 / 10}} \\approx \\frac{1.2}{1.5692} \\approx 0.76472 $$\n\n**2. 对11个观测值（含离群值）样本的分析**\n含离群值样本数据 ($n_{\\text{out}} = 11$): $\\{96, \\dots, 100, 300\\}$。\n\n-   **样本均值 $\\bar{x}_{\\text{out}}$**:\n    $$ \\bar{x}_{\\text{out}} = \\frac{1012 + 300}{11} = \\frac{1312}{11} \\approx 119.273 $$\n-   **无偏样本方差 $S_{\\text{out}}^{2}$**:\n    $$ \\sum x_i^2 = (102636) + 300^2 = 192636 $$\n    $$ S_{\\text{out}}^{2} = \\frac{1}{11-1} \\left( \\sum x_i^2 - \\frac{(\\sum x_i)^2}{n} \\right) = \\frac{1}{10} \\left( 192636 - \\frac{1312^2}{11} \\right) = \\frac{397652}{110} \\approx 3615.018 $$\n-   **t统计量 $t_{\\text{out}}$**:\n    $$ t_{\\text{out}} = \\frac{\\bar{x}_{\\text{out}} - \\mu_0}{\\sqrt{S_{\\text{out}}^{2} / n_{\\text{out}}}} = \\frac{(1312/11) - 100}{\\sqrt{3615.018 / 11}} \\approx \\frac{19.273}{18.128} \\approx 1.0631 $$\n\n**3. 量化变异性膨胀**\n比率 $R = S_{\\text{out}}^{2} / S_{\\text{clean}}^{2}$：\n$$ R = \\frac{3615.018}{24.6222} \\approx 146.819 $$\n单个离群值使样本方差膨胀了约147倍。\n\n**4. 稳健缩尾分析与决策比较**\n对于$n=11$的样本，进行$20\\%$的缩尾，需替换的观测值数量为 $g = \\lfloor 0.2 \\times 11 \\rfloor = 2$。\n-   排序后样本：$\\{94, 96, 98, 99, 100, 101, 102, 105, 107, 110, 300\\}$。\n-   替换最低的2个值($94, 96$)为第3个值($98$)，替换最高的2个值($110, 300$)为第9个值($107$)。\n-   缩尾后样本：$\\{98, 98, 98, 99, 100, 101, 102, 105, 107, 107, 107\\}$。\n\n-   **缩尾均值 $\\bar{x}_{\\text{win}}$**:\n    $$ \\bar{x}_{\\text{win}} = \\frac{3 \\times 98 + 99+100+101+102+105 + 3 \\times 107}{11} = \\frac{1122}{11} = 102 $$\n-   **缩尾方差 $S_{\\text{win}}^{2}$**:\n    $$ \\sum (x_{i, \\text{win}} - \\bar{x}_{\\text{win}})^2 = 3(98-102)^2 + \\dots + 3(107-102)^2 = 146 $$\n    $$ S_{\\text{win}}^{2} = \\frac{146}{11-1} = 14.6 $$\n-   **缩尾类t统计量 $t_{\\text{win}}$**:\n    $$ t_{\\text{win}} = \\frac{\\bar{x}_{\\text{win}} - \\mu_0}{\\sqrt{S_{\\text{win}}^{2} / n}} = \\frac{102 - 100}{\\sqrt{14.6 / 11}} \\approx \\frac{2}{1.152} \\approx 1.7360 $$\n\n-   **决策比较** (双侧检验, $\\alpha=0.05$):\n    -   **经典分析**: $t_{\\text{out}} \\approx 1.063$ ($df=10$)。临界值 $t_{0.025, 10} = 2.228$。因为 $|1.063|  2.228$，不拒绝 $H_0$。\n    -   **缩尾分析**: $t_{\\text{win}} \\approx 1.736$ ($df=n-2g-1=6$)。临界值 $t_{0.025, 6} = 2.447$。因为 $|1.736|  2.447$，不拒绝 $H_0$。\n    -   在这种情况下，检验决策没有改变。\n\n**5. $Q$的最终计算**\n$$ Q = R - (|t_{\\text{win}}| - |t_{\\text{out}}|) $$\n使用之前计算的数值：\n$$ Q \\approx 146.8193 - (|1.7360| - |1.0631|) = 146.8193 - 0.6729 = 146.1464 $$\n四舍五入到四位有效数字，得到 $Q = 146.1$。", "answer": "$$\\boxed{146.1}$$", "id": "4934504"}]}