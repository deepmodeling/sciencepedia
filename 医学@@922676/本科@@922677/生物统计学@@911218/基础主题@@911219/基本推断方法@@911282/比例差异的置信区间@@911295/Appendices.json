{"hands_on_practices": [{"introduction": "在生物统计学和许多其他领域，我们经常需要比较两组之间的比例或发生率，例如比较两种疗法的有效率。这个练习将引导你完成一项核心任务：使用大样本近似法为两个独立比例之差构建一个置信区间。通过解决这个问题 [@problem_id:4903850]，你将掌握计算点估计值 $\\hat{\\Delta} = \\hat{p}_1 - \\hat{p}_2$、相应的标准误以及最终置信区间的基本步骤，为更复杂的分析奠定坚实的基础。", "problem": "一位生物统计学家正在比较两个独立队列中二元临床终点的比例。在队列 $1$ 中，有 $n_1=150$ 名参与者和 $x_1=30$ 次观测事件。在队列 $2$ 中，有 $n_2=200$ 名参与者和 $x_2=20$ 次观测事件。令 $\\Delta=p_1-p_2$ 表示队列 $1$ 和队列 $2$ 之间真实比例的差异。仅使用源自中心极限定理 (CLT) 的标准大样本近似法，并假设每个队列中均为独立的伯努利抽样，为 $\\Delta$ 构建一个置信水平为 $0.95$ 的渐近置信区间，该置信区间使用“置入式”方差和相应的正态分位数。将区间的两个端点以小数形式报告，并将您的数值答案四舍五入到四位有效数字。最终答案必须只包含两个端点。", "solution": "用户希望基于样本数据，为两个独立总体比例之差 $\\Delta = p_1 - p_2$ 构建一个 $95\\%$ 的置信区间。指定的方法是使用中心极限定理的大样本近似法和方差的“置入式”估计。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 队列 $1$ 样本量：$n_1=150$\n- 队列 $1$ 事件数：$x_1=30$\n- 队列 $2$ 样本量：$n_2=200$\n- 队列 $2$ 事件数：$x_2=20$\n- 关注参数：$\\Delta=p_1-p_2$，真实比例之差。\n- 置信水平：$0.95$\n- 方法论约束：使用源自中心极限定理 (CLT) 的标准大样本近似法，假设独立的伯努利抽样，并采用“置入式”方差。\n- 输出要求：将区间端点以小数形式报告，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是生物统计学中比较两个比例的标准练习，这是一个基础且成熟的程序。\n- **适定性**：该问题提供了所有必要的数据（$n_1$, $x_1$, $n_2$, $x_2$），并指定了置信水平（$0.95$）和确切的统计方法（大样本，“置入式”方差）。存在唯一解。\n- **客观性**：问题以精确、定量的语言陈述，没有歧义或主观性。\n- **检查缺陷**：\n  - 问题在事实上和数学上都是合理的。\n  - 这是一个正式的统计问题，而非比喻。\n  - 问题设置是完整的，没有矛盾之处。\n  - 样本量足够大，使得中心极限定理的近似是合理的。一个常见的经验法则是，$n\\hat{p}$ 和 $n(1-\\hat{p})$ 至少应为 $5$ 或 $10$。在这里，我们有 $x_1=30$，$n_1-x_1=120$，$x_2=20$ 以及 $n_2-x_2=180$。所有值都大于 $10$，因此大样本方法是合理的。\n  - 问题结构良好，并非不适定问题。\n\n### 步骤 3：结论与行动\n问题是有效的。我现在将继续进行求解。\n\n用于两个比例之差 $\\Delta = p_1 - p_2$ 的大样本置信区间的通用形式是：\n$$ (\\hat{p}_1 - \\hat{p}_2) \\pm z_{\\alpha/2} \\times \\widehat{SE}(\\hat{p}_1 - \\hat{p}_2) $$\n其中 $\\hat{p}_1$ 和 $\\hat{p}_2$ 是样本比例，$z_{\\alpha/2}$ 是在给定置信水平 $1-\\alpha$ 下，来自标准正态分布的临界值，而 $\\widehat{SE}$ 是该差异的估计标准误。\n\n1.  **计算样本比例（$\\hat{p}_1$ 和 $\\hat{p}_2$）以及差异的点估计值（$\\hat{\\Delta}$）。**\n    队列 $1$ 的样本比例是：\n    $$ \\hat{p}_1 = \\frac{x_1}{n_1} = \\frac{30}{150} = 0.2 $$\n    队列 $2$ 的样本比例是：\n    $$ \\hat{p}_2 = \\frac{x_2}{n_2} = \\frac{20}{200} = 0.1 $$\n    比例差异的点估计值为：\n    $$ \\hat{\\Delta} = \\hat{p}_1 - \\hat{p}_2 = 0.2 - 0.1 = 0.1 $$\n\n2.  **确定临界值（$z_{\\alpha/2}$）。**\n    置信水平为 $1-\\alpha=0.95$，因此显著性水平为 $\\alpha=0.05$。对于双侧区间，我们使用 $\\alpha/2$：\n    $$ \\alpha/2 = \\frac{0.05}{2} = 0.025 $$\n    临界值 $z_{0.025}$ 是标准正态分布的上 $0.025$ 分位数，即满足 $P(Z > z) = 0.025$ 的值 $z$。该值为：\n    $$ z_{0.025} \\approx 1.96 $$\n\n3.  **计算差异的估计标准误（$\\widehat{SE}(\\hat{\\Delta})$）。**\n    由于两个队列是独立的，样本比例之差的方差是它们各自方差的总和：\n    $$ \\text{Var}(\\hat{p}_1 - \\hat{p}_2) = \\text{Var}(\\hat{p}_1) + \\text{Var}(\\hat{p}_2) = \\frac{p_1(1-p_1)}{n_1} + \\frac{p_2(1-p_2)}{n_2} $$\n    标准误是方差的平方根。由于真实比例 $p_1$ 和 $p_2$ 是未知的，我们使用“置入式”方法，代入样本比例 $\\hat{p}_1$ 和 $\\hat{p}_2$ 来估计标准误：\n    $$ \\widehat{SE}(\\hat{\\Delta}) = \\sqrt{\\frac{\\hat{p}_1(1-\\hat{p}_1)}{n_1} + \\frac{\\hat{p}_2(1-\\hat{p}_2)}{n_2}} $$\n    代入给定值：\n    $$ \\widehat{SE}(\\hat{\\Delta}) = \\sqrt{\\frac{0.2(1-0.2)}{150} + \\frac{0.1(1-0.1)}{200}} $$\n    $$ \\widehat{SE}(\\hat{\\Delta}) = \\sqrt{\\frac{0.2(0.8)}{150} + \\frac{0.1(0.9)}{200}} $$\n    $$ \\widehat{SE}(\\hat{\\Delta}) = \\sqrt{\\frac{0.16}{150} + \\frac{0.09}{200}} $$\n    $$ \\widehat{SE}(\\hat{\\Delta}) = \\sqrt{0.0010666... + 0.00045} = \\sqrt{0.00151666...} $$\n    $$ \\widehat{SE}(\\hat{\\Delta}) \\approx 0.03894438... $$\n\n4.  **构建置信区间。**\n    首先，计算误差范围（$ME$）：\n    $$ ME = z_{\\alpha/2} \\times \\widehat{SE}(\\hat{\\Delta}) \\approx 1.96 \\times 0.03894438... \\approx 0.0763310... $$\n    置信区间为 $(\\hat{\\Delta} - ME, \\hat{\\Delta} + ME)$。\n    下限是：\n    $$ L = 0.1 - 0.0763310... = 0.0236689... $$\n    上限是：\n    $$ U = 0.1 + 0.0763310... = 0.1763310... $$\n\n5.  **将结果四舍五入到四位有效数字。**\n    对于下限，第一个非零数字在百分位上。四位有效数字是 $2$, $3$, $6$，第四位是 $6$，由于下一位是 $8$，因此向上舍入为 $7$。\n    $$ L \\approx 0.02367 $$\n    对于上限，第一位有效数字在十分位上。四位有效数字是 $1$, $7$, $6$, 和 $3$。下一位是 $3$，所以我们不向上舍入。\n    $$ U \\approx 0.1763 $$\n    $\\Delta = p_1 - p_2$ 的 $95\\%$ 置信区间约为 $(0.02367, 0.1763)$。", "answer": "$$ \\boxed{\\begin{pmatrix} 0.02367  0.1763 \\end{pmatrix}} $$", "id": "4903850"}, {"introduction": "掌握了基本计算之后，我们来探讨一个更微妙的问题：如何最好地估计标准误？标准误的计算存在两种主流方法：“非合并”（unpooled）估计和“合并”（pooled）估计。后者基于一个重要假设，即两个总体的真实比例相等 ($p_1 = p_2$)，这在进行假设检验时很常见，但在构建置信区间时则需谨慎。这个练习 [@problem_id:4903857] 要求你计算并比较这两种方法得出的置信区间宽度，从而让你亲身体会统计假设对最终结果的实际影响。", "problem": "一位生物统计学研究员正在比较两个独立队列中二元不良结局的发生率。在队列$1$中，有$n_{1}=60$名患者，其中$x_{1}=18$人出现不良结局。在队列$2$中，有$n_{2}=90$名患者，其中$x_{2}=12$人出现不良结局。令$\\Delta=p_{1}-p_{2}$表示队列$1$和队列$2$中不良结局的真实总体比例之差。\n\n假设每个队列均由独立同分布的伯努利观测组成，并且样本量足够大，可以使用正态近似进行科学合理的分析。使用此近似方法，通过以下两种方法构建$\\Delta$的双侧$95\\%$置信区间（confidence interval (CI)）：\n- 基于分离样本方差估计量（非合并）的置信区间。\n- 基于假设$p_{1}=p_{2}$的合并方差估计量的置信区间。\n\n然后，通过计算这两个置信区间的总宽度之比（非合并宽度除以合并宽度）来量化它们之间的差异。使用双侧$95\\%$置信区间的标准正态临界值。将最终的比率四舍五入至四位有效数字。仅以数值形式提供该比率作为最终答案。", "solution": "用户希望我解决一个生物统计学问题。\n\n这是我的计划：\n1.  **验证问题：**我需要检查问题陈述是否科学合理、表述清晰且客观。\n    *   **第1步：提取已知条件：**我将列出所有给定的数字和定义。\n        *   队列1：$n_1 = 60$，$x_1 = 18$。\n        *   队列2：$n_2 = 90$，$x_2 = 12$。\n        *   目标参数：$\\Delta = p_1 - p_2$。\n        *   假设：\n            *   独立队列。\n            *   每个队列都有独立同分布的伯努利观测。\n            *   样本量足够大，可进行正态近似。\n        *   任务：\n            *   使用非合并方差估计量构建$\\Delta$的95%置信区间。\n            *   使用合并方差估计量（假设$p_1 = p_2$）构建$\\Delta$的95%置信区间。\n            *   计算这两个置信区间的宽度之比（非合并宽度 / 合并宽度）。\n        *   置信水平：95%。\n        *   最终答案：比率四舍五入至四位有效数字。\n\n    *   **第2步：验证：**我将检查是否存在任何缺陷。\n        *   **科学依据：**该问题是关于两个比例之差的置信区间的标准应用。这是生物统计学和普通统计学中的一个基本课题。使用非合并（类似Welch-Satterthwaite）和合并方差估计量是标准做法。正态近似也是标准的，但需要检查样本量条件。\n            *   检查正态近似的样本量条件：\n                *   对于比例之差，我们通常检查$n_1 \\hat{p}_1$、$n_1(1-\\hat{p}_1)$、$n_2 \\hat{p}_2$和$n_2(1-\\hat{p}_2)$是否都大于某个阈值（例如5或10）。\n                *   $\\hat{p}_1 = x_1 / n_1 = 18 / 60 = 0.3$。\n                *   $\\hat{p}_2 = x_2 / n_2 = 12 / 90 = 4/30 = 2/15 \\approx 0.1333$。\n                *   $n_1 \\hat{p}_1 = 60 \\times 0.3 = 18$。\n                *   $n_1 (1-\\hat{p}_1) = 60 \\times 0.7 = 42$。\n                *   $n_2 \\hat{p}_2 = 90 \\times (12/90) = 12$。\n                *   $n_2 (1-\\hat{p}_2) = 90 \\times (1 - 12/90) = 90 \\times (78/90) = 78$。\n                *   所有这些值（18、42、12、78）都大于10。因此正态近似是合理的。\n        *   **表述清晰：**问题定义明确。它要求基于给定数据和标准统计方法进行具体计算（两种置信区间及其宽度比）。存在唯一解。\n        *   **客观性：**语言精确且专业，没有主观因素。\n        *   **完整性：**所有必要数据（$n_1, x_1, n_2, x_2$）和置信水平（95%）都已提供。方法也已指定（非合并/合并）。\n        *   **一致性：**没有矛盾之处。\n        *   **现实性：**该场景对于临床或流行病学研究是现实的。数据是合理的。\n        *   **其他缺陷：**该问题不是无关紧要的、隐喻性的或超出科学可验证范围的。\n\n    *   **第3步：结论：**问题是**有效的**。\n\n2.  **解决问题：**现在我将进行详细计算。\n\n    *   **$p_1 - p_2$置信区间的通用公式**：\n        比例之差$p_1 - p_2$的置信区间的一般形式为：\n        $$(\\hat{p}_1 - \\hat{p}_2) \\pm z_{\\alpha/2} \\times SE(\\hat{p}_1 - \\hat{p}_2)$$\n        其中$\\hat{p}_1 = x_1/n_1$和$\\hat{p}_2 = x_2/n_2$是样本比例，$z_{\\alpha/2}$是置信水平为$1-\\alpha$时来自标准正态分布的临界值，$SE(\\hat{p}_1 - \\hat{p}_2)$是差值的标准误。\n\n    *   **计算样本比例**：\n        *   $\\hat{p}_1 = \\frac{x_1}{n_1} = \\frac{18}{60} = 0.3$。\n        *   $\\hat{p}_2 = \\frac{x_2}{n_2} = \\frac{12}{90} = \\frac{2}{15} \\approx 0.1333...$\n\n    *   **求临界值$z_{\\alpha/2}$**：\n        *   对于95%置信区间，$\\alpha = 1 - 0.95 = 0.05$。\n        *   $\\alpha/2 = 0.025$。\n        *   $z_{\\alpha/2} = z_{0.025}$是满足$P(Z > z_{0.025}) = 0.025$的值。这对应于标准正态分布的第97.5个百分位数。\n        *   $z_{0.025} \\approx 1.96$。问题陈述要求使用“标准正态临界值”，这意味着使用这个标准值。\n\n    *   **置信区间的宽度**：\n        置信区间的宽度由下式给出：\n        $$W = 2 \\times z_{\\alpha/2} \\times SE(\\hat{p}_1 - \\hat{p}_2)$$\n\n    *   **情况1：非合并（分离样本）方差估计量**：\n        标准误是使用各自的样本比例计算的。这种方法通常更受青睐，因为它不假设$p_1 = p_2$。\n        *   差值的方差是 $$Var(\\hat{p}_1 - \\hat{p}_2) = Var(\\hat{p}_1) + Var(\\hat{p}_2) = \\frac{p_1(1-p_1)}{n_1} + \\frac{p_2(1-p_2)}{n_2}$$。\n        *   我们使用样本比例来估计这个方差：$$\\widehat{Var}(\\hat{p}_1 - \\hat{p}_2) = \\frac{\\hat{p}_1(1-\\hat{p}_1)}{n_1} + \\frac{\\hat{p}_2(1-\\hat{p}_2)}{n_2}$$。\n        *   非合并标准误是 $$SE_{unpooled} = \\sqrt{\\frac{\\hat{p}_1(1-\\hat{p}_1)}{n_1} + \\frac{\\hat{p}_2(1-\\hat{p}_2)}{n_2}}$$。\n        *   我们来计算各项：\n            *   $\\hat{p}_1(1-\\hat{p}_1) = 0.3 \\times 0.7 = 0.21$。\n            *   $\\hat{p}_2(1-\\hat{p}_2) = \\frac{12}{90} \\times \\left(1 - \\frac{12}{90}\\right) = \\frac{2}{15} \\times \\frac{13}{15} = \\frac{26}{225}$。\n            *   $\\frac{\\hat{p}_1(1-\\hat{p}_1)}{n_1} = \\frac{0.21}{60} = \\frac{21/100}{60} = \\frac{21}{6000} = \\frac{7}{2000} = 0.0035$。\n            *   $\\frac{\\hat{p}_2(1-\\hat{p}_2)}{n_2} = \\frac{26/225}{90} = \\frac{26}{20250} = \\frac{13}{10125}$。\n        *   $$SE_{unpooled}^2 = \\frac{7}{2000} + \\frac{13}{10125}$$。\n        *   为了将这些分数相加，我们找到一个公分母。$2000 = 2^4 \\cdot 5^3$ 且 $10125 = 3^4 \\cdot 5^3$。最小公倍数是 $2^4 \\cdot 3^4 \\cdot 5^3 = 162000$。\n        *   $$SE_{unpooled}^2 = \\frac{7 \\cdot 81}{162000} + \\frac{13 \\cdot 16}{162000} = \\frac{567 + 208}{162000} = \\frac{775}{162000} = \\frac{31}{6480}$$。\n        *   $$SE_{unpooled} = \\sqrt{\\frac{31}{6480}}$$。\n        *   非合并置信区间的宽度：$$W_{unpooled} = 2 z_{0.025} SE_{unpooled}$$。\n\n    *   **情况2：合并方差估计量**：\n        此方法使用一个合并比例 $\\hat{p}_{pooled}$，它是在假设$p_1 = p_2 = p$下的共同比例$p$的估计值。\n        *   首先，我们计算合并比例：\n            $$\\hat{p}_{pooled} = \\frac{x_1 + x_2}{n_1 + n_2} = \\frac{18 + 12}{60 + 90} = \\frac{30}{150} = 0.2$$\n        *   合并标准误是：\n            $$SE_{pooled} = \\sqrt{\\hat{p}_{pooled}(1-\\hat{p}_{pooled})\\left(\\frac{1}{n_1} + \\frac{1}{n_2}\\right)}$$\n        *   我们来计算各项：\n            *   $\\hat{p}_{pooled}(1-\\hat{p}_{pooled}) = 0.2 \\times 0.8 = 0.16$。\n            *   $\\frac{1}{n_1} + \\frac{1}{n_2} = \\frac{1}{60} + \\frac{1}{90} = \\frac{3+2}{180} = \\frac{5}{180} = \\frac{1}{36}$。\n        *   $$SE_{pooled}^2 = 0.16 \\times \\frac{1}{36} = \\frac{16}{100} \\times \\frac{1}{36} = \\frac{4}{100 \\times 9} = \\frac{1}{225}$$。\n        *   $$SE_{pooled} = \\sqrt{\\frac{1}{225}} = \\frac{1}{15}$$。\n        *   合并置信区间的宽度：$$W_{pooled} = 2 z_{0.025} SE_{pooled}$$。\n\n    *   **量化差异**：\n        问题要求计算总宽度的比率：\n        $$Ratio = \\frac{W_{unpooled}}{W_{pooled}}$$\n        项$2 z_{0.025}$在分子和分母中都存在，因此可以消掉：\n        $$Ratio = \\frac{2 z_{0.025} SE_{unpooled}}{2 z_{0.025} SE_{pooled}} = \\frac{SE_{unpooled}}{SE_{pooled}}$$\n\n    *   **计算比率**：\n        我们代入标准误的精确表达式：\n        $$Ratio = \\frac{\\sqrt{\\frac{31}{6480}}}{\\frac{1}{15}} = 15 \\sqrt{\\frac{31}{6480}}$$\n        为了简化，我们可以将比率平方：\n        $$Ratio^2 = 15^2 \\times \\frac{31}{6480} = 225 \\times \\frac{31}{6480}$$\n        我们可以通过将分子和分母除以它们的最大公约数来简化分数$\\frac{225}{6480}$。$225 = 9 \\times 25$ 且 $6480 = 10 \\times 648 = 10 \\times 8 \\times 81 = 10 \\times 8 \\times 9 \\times 9$。\n        $$\\frac{225}{6480} = \\frac{9 \\times 25}{6480} = \\frac{25}{720} = \\frac{5}{144}$$\n        所以，\n        $$Ratio^2 = \\frac{5}{144} \\times 31 = \\frac{155}{144}$$\n        取平方根得到精确的比率：\n        $$Ratio = \\sqrt{\\frac{155}{144}} = \\frac{\\sqrt{155}}{12}$$\n\n    *   **最终数值计算**：\n        我们现在计算数值，并按要求四舍五入到四位有效数字。\n        $$Ratio = \\frac{\\sqrt{155}}{12} \\approx \\frac{12.4498996}{12} \\approx 1.03749163$$\n        四舍五入到四位有效数字，我们得到$1.037$。第五位有效数字是$4$，所以我们向下舍入。", "answer": "$$\n\\boxed{1.037}\n$$", "id": "4903857"}, {"introduction": "经典的大样本方法在样本量充足且比例远离边界（0 或 1）时表现良好，但当数据稀疏时，例如在某个组中观察到零个事件时，它可能会失效。在这种情况下，标准的置信区间可能会变得过窄甚至产生不合逻辑的边界。这个练习 [@problem_id:4903883] 介绍了一种简单而有效的修正方法：Agresti-Caffo 调整。通过为每个组别“添加”一个成功和一个失败，该方法可以显著改善置信区间在小样本和极端比例情况下的性能，确保结果的合理性和可靠性。", "problem": "一项随机临床研究比较了两个独立组别之间不良事件的发生比例。在第 $1$ 组中，观察了 $n_1 = 20$ 名参与者，其中 $x_1 = 0$ 人发生该事件。在第 $2$ 组中，观察了 $n_2 = 20$ 名参与者，其中 $x_2 = 3$ 人发生该事件。设第 $1$ 组和第 $2$ 组的真实事件概率分别为 $p_1$ 和 $p_2$，并考虑感兴趣的参数 $\\Delta = p_1 - p_2$。从二项抽样模型和独立样本比例差异的大样本正态近似出发，使用 Agresti–Caffo 调整法为 $\\Delta$ 构建一个 $95\\%$ 置信区间（CI）。该方法在构建大样本置信区间之前，将每个观测计数 $(x_i, n_i)$ 替换为 $(x_i + 1, n_i + 2)$。然后，简要评估所得到的调整后区间是否遵守基本约束 $\\Delta \\in [-1, 1]$，这与未经调整的 Wald 置信区间在样本比例处于边界时（例如，当 $x_1 \\in \\{0, n_1\\}$ 时）可能出现的众所周知的边界问题形成对比。将您的数值置信区间端点四舍五入至四位有效数字，并以不带百分号的小数形式表示。", "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。这是生物统计推断中的一个标准问题。\n\n目标是使用 Agresti–Caffo 调整法为两个独立总体比例之差 $\\Delta = p_1 - p_2$ 构建一个 $95\\%$ 置信区间（CI）。\n\n$\\Delta = p_1 - p_2$ 的大样本 Wald 型置信区间的一般形式由下式给出：\n$$ (\\hat{p}_1 - \\hat{p}_2) \\pm z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}_1(1-\\hat{p}_1)}{n_1} + \\frac{\\hat{p}_2(1-\\hat{p}_2)}{n_2}} $$\n其中 $\\hat{p}_i = x_i/n_i$ 是第 $i$ 组的样本比例，$n_i$ 是样本量，$x_i$ 是事件数，$z_{\\alpha/2}$ 是在置信水平为 $1-\\alpha$ 时来自标准正态分布的临界值。\n\nAgresti–Caffo 调整法通过先为每组的事件数加 $1$，样本量加 $2$ 来修改此过程。调整后的计数（记作 $\\tilde{x}_i$）和调整后的样本量（记作 $\\tilde{n}_i$）用于计算调整后的比例 $\\tilde{p}_i$。然后使用这些调整后的量在标准公式中构建置信区间。\n\n给定数据如下：\n对于第 $1$ 组：$n_1 = 20$, $x_1 = 0$。\n对于第 $2$ 组：$n_2 = 20$, $x_2 = 3$。\n\n首先，我们应用 Agresti–Caffo 调整法：\n对于第 $1$ 组：\n$$ \\tilde{x}_1 = x_1 + 1 = 0 + 1 = 1 $$\n$$ \\tilde{n}_1 = n_1 + 2 = 20 + 2 = 22 $$\n对于第 $2$ 组：\n$$ \\tilde{x}_2 = x_2 + 1 = 3 + 1 = 4 $$\n$$ \\tilde{n}_2 = n_2 + 2 = 20 + 2 = 22 $$\n\n接下来，我们计算调整后的样本比例：\n$$ \\tilde{p}_1 = \\frac{\\tilde{x}_1}{\\tilde{n}_1} = \\frac{1}{22} $$\n$$ \\tilde{p}_2 = \\frac{\\tilde{x}_2}{\\tilde{n}_2} = \\frac{4}{22} = \\frac{2}{11} $$\n\n差值 $\\Delta$ 的点估计为：\n$$ \\tilde{p}_1 - \\tilde{p}_2 = \\frac{1}{22} - \\frac{4}{22} = -\\frac{3}{22} \\approx -0.136364 $$\n\nAgresti–Caffo 置信区间由以下公式给出：\n$$ (\\tilde{p}_1 - \\tilde{p}_2) \\pm z_{\\alpha/2} \\sqrt{\\frac{\\tilde{p}_1(1-\\tilde{p}_1)}{\\tilde{n}_1} + \\frac{\\tilde{p}_2(1-\\tilde{p}_2)}{\\tilde{n}_2}} $$\n\n对于 $95\\%$ 的置信水平，$1-\\alpha = 0.95$，所以 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。相应的临界值是 $z_{0.025}$，即标准正态分布的第 $97.5$ 个百分位数。该值为 $z_{0.025} \\approx 1.96$。\n\n现在，我们使用调整后的比例计算差值的标准误（SE）：\n$$ \\text{SE} = \\sqrt{\\frac{\\tilde{p}_1(1-\\tilde{p}_1)}{\\tilde{n}_1} + \\frac{\\tilde{p}_2(1-\\tilde{p}_2)}{\\tilde{n}_2}} $$\n$$ \\text{SE} = \\sqrt{\\frac{(\\frac{1}{22})(1-\\frac{1}{22})}{22} + \\frac{(\\frac{4}{22})(1-\\frac{4}{22})}{22}} $$\n$$ \\text{SE} = \\sqrt{\\frac{(\\frac{1}{22})(\\frac{21}{22})}{22} + \\frac{(\\frac{4}{22})(\\frac{18}{22})}{22}} $$\n$$ \\text{SE} = \\sqrt{\\frac{1}{22} \\left[ \\frac{21}{22^2} + \\frac{72}{22^2} \\right]} = \\sqrt{\\frac{1}{22} \\frac{93}{484}} = \\sqrt{\\frac{93}{10648}} $$\n数值上，$\\text{SE} \\approx \\sqrt{0.008733565} \\approx 0.093454$。\n\n误差范围（ME）为：\n$$ \\text{ME} = z_{\\alpha/2} \\times \\text{SE} \\approx 1.96 \\times 0.093454 \\approx 0.18317 $$\n\n最后，$\\Delta = p_1 - p_2$ 的 $95\\%$ 置信区间为：\n$$ (\\tilde{p}_1 - \\tilde{p}_2) \\pm \\text{ME} \\approx -0.136364 \\pm 0.18317 $$\n下界是：\n$$ L = -0.136364 - 0.18317 = -0.319534 $$\n上界是：\n$$ U = -0.136364 + 0.18317 = 0.046806 $$\n\n将端点四舍五入至四位有效数字，得到：\n下界：$-0.3195$\n上界：$0.04681$\n得到的 $95\\%$ 置信区间是 $[-0.3195, 0.04681]$。\n\n为了评估该区间是否遵守基本约束 $\\Delta \\in [-1, 1]$，我们观察我们计算出的区间 $[-0.3195, 0.04681]$。下限 $-0.3195$ 和上限 $0.04681$ 都在有效范围 $[-1, 1]$ 之内。\n\n这一观察结果反映了 Agresti–Caffo 方法的一个普遍性质。该调整保证了调整后的比例 $\\tilde{p}_1$ 和 $\\tilde{p}_2$ 总是严格介于 $0$ 和 $1$ 之间。具体来说，$\\tilde{p}_i = (x_i+1)/(n_i+2)$ 的界限是 $1/(n_i+2)$ 和 $(n_i+1)/(n_i+2)$。这可以防止方差项 $\\tilde{p}_i(1-\\tilde{p}_i)/\\tilde{n}_i$ 变为零。相比之下，此问题的未经调整的 Wald 区间会使用 $\\hat{p}_1 = 0/20 = 0$，导致第一个样本的方差估计 $\\hat{p}_1(1-\\hat{p}_1)/n_1$ 恰好为 $0$。这人为地减小了标准误，并导致置信区间过窄。虽然在这个具体例子中，未经调整的 Wald 区间没有产生超出 $[-1, 1]$ 的端点，但众所周知，它在其他情况下会失效（例如，产生大于 $1$ 的上界）。Agresti–Caffo 区间保证其端点位于区间 $(-1, 1)$ 内，因此总能产生数学上一致的结果。", "answer": "$$ \\boxed{\\begin{pmatrix} -0.3195  0.04681 \\end{pmatrix}} $$", "id": "4903883"}]}