{"hands_on_practices": [{"introduction": "为了衡量暴露与疾病之间的关联，我们首先必须掌握流行病学的基本语言：疾病频率的测量指标。本练习提供了一个动手实践的机会，让你能够根据一个队列研究场景计算三个不同但相关的测量指标——累积发病率、发病率和比值。通过解决这个问题 [@problem_id:4910872]，你将明晰每个指标的精确定义和计算方法，为更复杂的分析打下坚实的基础。", "problem": "一个公共卫生团队计划对 $10,000$ 名在基线时未患有某种特定疾病的成年人进行队列研究。每位参与者计划进行为期 $1$ 年的随访。在研究期间，有 $150$ 人发生了该疾病事件。由于交错入组、删失和失访，观察到的总随访时间累积为 $8,900$ 人年。使用流行病学的核心定义并从第一性原理出发，计算 $1$ 年期间的累积发病比例、观察到的人时期间的发病率以及该时期内事件的比值。按以下顺序以小数形式报告这三个结果：累积发病比例、发病率、比值。将每个结果四舍五入至四位有效数字。将发病率以每人年事件数表示。不要使用百分号；所有量均以小数表示。", "solution": "首先对问题进行验证，以确保其科学基础扎实、提法恰当、客观且信息自足。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 初始队列规模：$N = 10,000$ 名成年人\n- 初始状态：所有参与者均未患病。\n- 计划随访期：$1$ 年\n- 新发疾病事件数：$D = 150$\n- 观察到的总人时：$T_{obs} = 8,900$ 人年\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题描述了一个经典的队列研究场景，这是流行病学中的一种基本研究设计。所要求的计算——累积发病率、发病率和比值——是疾病频率的标准度量。所提供的数值对于一项大规模公共卫生研究是合理的。该问题基于生物统计学的既定原则。\n- **提法恰当**：计算这三个量所需的所有信息均已提供。累积发病率、发病率（使用人时）和比值的定义是标准的，可以计算出唯一的、有意义的解。\n- **客观性**：问题使用精确、无偏见的语言和定量数据进行陈述。\n- **一致性检查**：最大可能的人时为 $10,000 \\text{ 参与者} \\times 1 \\text{ 年/参与者} = 10,000$ 人年。观察到的人时为 $8,900$ 人年。这种差异由“交错入组、删失和失访”明确解释，并且患病个体不再贡献风险人时。整个设定是内部一致且现实的。\n\n**结论**\n该问题被判定为**有效**。这是一个提法恰当、科学合理、客观的问题，植根于流行病学的核心原则。我现在将进行求解。\n\n**解题过程**\n\n问题要求根据所提供的队列研究数据计算三个基本的流行病学度量。我们将从第一性原理出发计算每个度量。\n\n已知数据如下：\n- 初始风险人群数量，$N = 10,000$。\n- 研究期间观察到的新发疾病事件数，$D = 150$。\n- 研究期间观察到的总风险人时，$T_{obs} = 8,900$ 人年。\n\n**1. 累积发病比例 (CI)**\n\n累积发病比例，通常也称为风险，是在一个指定时期内，一个固定人群（队列）中发生目标事件的比例。其计算方法是新发病例数除以期初的风险人群数。\n\n累积发病比例的计算公式为：\n$$ CI = \\frac{\\text{Number of new cases}}{\\text{Number of individuals at risk at baseline}} $$\n使用所提供的数据：\n$$ CI = \\frac{D}{N} = \\frac{150}{10,000} = 0.015 $$\n问题要求结果报告至四位有效数字。因此，我们将累积发病比例表示为 $0.01500$。\n\n**2. 发病率 (IR)**\n\n发病率，也称为发病密度，衡量的是人群中新事件发生的速率。当个体间的随访时间不同时，该指标尤其有用。其计算方法是新发病例数除以总风险人时。单位通常是每人时的事件数。\n\n发病率的计算公式为：\n$$ IR = \\frac{\\text{Number of new cases}}{\\text{Total person-time at risk}} $$\n使用所提供的数据：\n$$ IR = \\frac{D}{T_{obs}} = \\frac{150 \\text{ events}}{8,900 \\text{ person-years}} \\approx 0.01685393... \\; \\frac{\\text{events}}{\\text{person-year}} $$\n将此结果四舍五入至四位有效数字，得到：\n$$ IR \\approx 0.01685 \\; \\frac{\\text{events}}{\\text{person-year}} $$\n\n**3. 事件的比值**\n\n事件的比值定义为事件发生的概率与事件不发生的概率之比。在本次固定时期的队列研究背景下，其计算方法是发生事件的个体数与未发生事件的个体数之比。\n\n未发生事件的个体数是初始队列规模减去发生事件的个体数：\n$$ N - D = 10,000 - 150 = 9,850 $$\n事件比值的计算公式为：\n$$ \\text{Odds} = \\frac{\\text{Number of individuals with the event}}{\\text{Number of individuals without the event}} $$\n使用推导出的数字：\n$$ \\text{Odds} = \\frac{D}{N - D} = \\frac{150}{9,850} \\approx 0.01522842... $$\n将此结果四舍五入至四位有效数字，得到：\n$$ \\text{Odds} \\approx 0.01523 $$\n\n**结果总结**\n\n所要求的三个度量，四舍五入至四位有效数字后，分别为：\n- 累积发病比例：$0.01500$\n- 发病率：$0.01685$ 事件/人年\n- 事件比值：$0.01523$\n\n这些结果按要求的顺序呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01500  0.01685  0.01523 \\end{pmatrix}}\n$$", "id": "4910872"}, {"introduction": "一旦我们掌握了如何测量疾病频率，下一个合乎逻辑的步骤就是比较暴露组和非暴露组的疾病频率，从而量化关联的强度。本练习侧重于比值比（$OR$），这是一个尤其在病例-对照研究中至关重要的关联度量指标。通过计算 $OR$ 并构建其置信水平为 $0.95$ 的置信区间 [@problem_id:4910899]，你将从一个简单的点估计，发展到理解和表述效应量周围的统计不确定性。", "problem": "一项病例对照研究调查了经常饮用未经巴氏消毒的果汁是否与弯曲杆菌感染有关。研究人员招募了 $200$ 名参与者：$18$ 名病例和 $182$ 名对照。在病例中，$12$ 人报告经常饮用（暴露组），$6$ 人没有（非暴露组）。在对照组中，$88$ 人报告经常饮用，$94$ 人没有。设 $2 \\times 2$ 表的单元格计数按常规布局用 $a$、$b$、$c$ 和 $d$ 表示：$a$ 是暴露病例数，$b$ 是暴露对照数，$c$ 是非暴露病例数，$d$ 是非暴露对照数。在本研究中，$a=12$，$b=88$，$c=6$，$d=94$。\n\n从优势 (odds) 和优势比 (odds ratio) 的定义出发，并假设一个大样本近似，其中优势比自然对数的抽样分布近似为正态分布，其方差等于四个单元格计数倒数之和，构建优势比对数的双侧 Wald $95\\%$ 置信区间。报告：\n- 估计的优势比，以及\n- 优势比对数的 $95\\%$ 置信区间的下限和上限。\n\n使用与双侧 $95\\%$ 置信水平相对应的标准正态分位数，以及由上述方差的平方根给出的标准误。将报告的每个量四舍五入到四位有效数字。以对数标度表示最终的置信区间；不要对其端点进行指数化处理。", "solution": "该问题是有效的，因为它有科学依据、提法得当且客观。它为标准的生物统计计算提供了所有必要的数据和清晰的方法。\n\n该问题要求根据一项病例对照研究的数据，计算估计的优势比以及优势比自然对数的 $95\\%$ 置信区间。\n\n提供的数据来自一个 $2 \\times 2$ 表，其单元格计数如下：\n- 暴露病例：$a = 12$\n- 暴露对照：$b = 88$\n- 非暴露病例：$c = 6$\n- 非暴露对照：$d = 94$\n\n病例总数为 $a+c = 12+6 = 18$。\n对照总数为 $b+d = 88+94 = 182$。\n参与者总数为 $a+b+c+d = 12+88+6+94 = 200$。\n\n首先，我们定义并计算样本优势比（$\\widehat{OR}$）。在病例对照研究中，优势比是病例中暴露优势与对照中暴露优势的比率。\n病例中的暴露优势由暴露病例数与非暴露病例数的比率给出：\n$$ \\text{Odds}_{\\text{cases}} = \\frac{a}{c} $$\n对照中的暴露优势由暴露对照数与非暴露对照数的比率给出：\n$$ \\text{Odds}_{\\text{controls}} = \\frac{b}{d} $$\n样本优势比是这两个优势的比率：\n$$ \\widehat{OR} = \\frac{\\text{Odds}_{\\text{cases}}}{\\text{Odds}_{\\text{controls}}} = \\frac{a/c}{b/d} = \\frac{ad}{bc} $$\n代入给定值：\n$$ \\widehat{OR} = \\frac{12 \\times 94}{88 \\times 6} = \\frac{1128}{528} \\approx 2.13636... $$\n按要求四舍五入到四位有效数字，估计的优势比为 $2.136$。\n\n接下来，我们构建优势比自然对数 $\\ln(OR)$ 的 $95\\%$ 置信区间。$\\ln(OR)$ 的点估计是 $\\ln(\\widehat{OR})$：\n$$ \\ln(\\widehat{OR}) = \\ln\\left(\\frac{1128}{528}\\right) \\approx 0.759055 $$\n问题指明 $\\ln(\\widehat{OR})$ 的抽样分布近似为正态分布，其方差 $V$ 由单元格计数的倒数之和给出：\n$$ V = \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d} $$\n$\\ln(\\widehat{OR})$ 的标准误 $SE$ 是方差的平方根：\n$$ SE(\\ln(\\widehat{OR})) = \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}} $$\n代入单元格计数：\n$$ SE(\\ln(\\widehat{OR})) = \\sqrt{\\frac{1}{12} + \\frac{1}{88} + \\frac{1}{6} + \\frac{1}{94}} $$\n$$ SE(\\ln(\\widehat{OR})) \\approx \\sqrt{0.083333... + 0.011364... + 0.166667... + 0.010638...} $$\n$$ SE(\\ln(\\widehat{OR})) \\approx \\sqrt{0.271992...} \\approx 0.521528 $$\n$\\ln(OR)$ 的双侧 $95\\%$ Wald 置信区间构建如下：\n$$ \\ln(\\widehat{OR}) \\pm z_{1-\\alpha/2} \\times SE(\\ln(\\widehat{OR})) $$\n对于 $95\\%$ 的置信水平，$\\alpha = 0.05$，因此 $1-\\alpha/2 = 0.975$。对应的标准正态分位数为 $z_{0.975} \\approx 1.96$。\n\n误差范围（$ME$）为：\n$$ ME = 1.96 \\times SE(\\ln(\\widehat{OR})) \\approx 1.96 \\times 0.521528 \\approx 1.022195 $$\n置信区间的下限是：\n$$ L = \\ln(\\widehat{OR}) - ME \\approx 0.759055 - 1.022195 \\approx -0.263140 $$\n置信区间的上限是：\n$$ U = \\ln(\\widehat{OR}) + ME \\approx 0.759055 + 1.022195 \\approx 1.781250 $$\n将端点四舍五入到四位有效数字，我们得到：\n- 下限：$-0.2631$\n- 上限：$1.781$\n\n所求的量，四舍五入到四位有效数字，是：\n- 估计的优势比：$2.136$\n- $\\ln(OR)$ 的 $95\\%$ 置信区间下限：$-0.2631$\n- $\\ln(OR)$ 的 $95\\%$ 置信区间上限：$1.781$", "answer": "$$\\boxed{\\begin{pmatrix} 2.136  -0.2631  1.781 \\end{pmatrix}}$$", "id": "4910899"}, {"introduction": "计算关联度量指标本身不难，但由于“混杂”现象的存在，正确解释结果却充满挑战。这个高级练习将通过一个经典的辛普森悖论案例，让你直面这一问题，在案例中，总体数据显示的关联方向与在特定亚组中观察到的方向完全相反。通过分析粗略风险比与分层风险比 [@problem_id:4910845]，你将对为何控制混杂因素对得出有效的科学结论至关重要，获得深刻而实际的理解。", "problem": "一家医院正在评估一种新的抗生素预防措施对术后$30$天内感染风险的影响。患者根据基线严重程度自然分为$2$个层：重症监护室（ICU）入院（高风险）和普通病房（GW）入院（低风险）。在ICU中，抗生素的使用更为普遍。记录了以下队列数据：\n\n- ICU层：在接受治疗的患者中，$800$人中有$320$人发生感染；在未接受治疗的患者中，$200$人中有$100$人发生感染。\n- GW层：在接受治疗的患者中，$200$人中有$10$人发生感染；在未接受治疗的患者中，$800$人中有$80$人发生感染。\n\n仅使用风险（累积发病率）和风险比（相对风险）的基本定义，以及分层分析在疑似混杂因素的水平上进行“同类比较”的原则：\n\n1) 计算每个分层中，接受治疗和未接受治疗患者的风险，以及各分层特定的风险比。解释这些分层特定的比较表明是有益还是有害。\n\n2) 计算所有接受治疗患者和所有未接受治疗患者的粗略（未分层）风险，然后计算粗略风险比。解释粗略比较表明是有益还是有害。\n\n3) 论证为什么在此情境下，ICU与GW的入院状态是一个混杂因素，以及为什么它会导致粗略比较和分层比较之间的符号反转（辛普森悖论）。\n\n4) 使用标准的、能够消除ICU与GW变量混杂效应的分层方法（例如，用于合并各分层$2 \\times 2$表格的Mantel–Haenszel逻辑），计算跨分层的共同风险比的单一合并估计值。作为最终数值答案，报告此合并风险比。\n\n将最终数值答案四舍五入至$4$位有效数字，并以小数形式表示（不要使用百分号）。", "solution": "将首先提取给定数据，然后评估其科学依据、一致性和完整性，从而对问题进行验证。\n\n### 第1步：提取已知信息\n- 研究设计：评估抗生素预防术后感染效果的队列研究。\n- 分层变量：患者入住重症监护室（ICU）与普通病房（GW）。\n- 结局：$30$天内发生感染。\n- ICU分层数据：\n    - 治疗组：$800$名患者中有$320$人感染。\n    - 未治疗组：$200$名患者中有$100$人感染。\n- GW分层数据：\n    - 治疗组：$200$名患者中有$10$人感染。\n    - 未治疗组：$800$名患者中有$80$人感染。\n- 任务：\n    1. 计算分层特异性风险和风险比（RR）。\n    2. 计算粗略（未分层）风险和RR。\n    3. 在此背景下解释混杂和辛普森悖论。\n    4. 使用像Mantel-Haenszel这样的分层方法计算合并RR，并报告至$4$位有效数字。\n\n### 第2步：使用提取的已知信息进行验证\n这个问题具有科学依据，提法严谨且客观。它展示了生物统计学和流行病学中一个经典而现实的场景，用于阐释混杂这一关键概念以及辛普森悖论的可能性。数据完整、内部一致，足以执行所有要求的计算。问题明确，并引导进行标准的流行病学分析。该问题不违反任何科学或数学逻辑原则，不基于错误的前提，也不包含主观论断。该问题是有效的。\n\n### 第3步：解答\n分析将按要求分四部分进行。基本定义如下：\n- 风险（或累积发病率，$CI$）：在指定时间段内，特定人群中发生结局的比例。如果$A$是发生结局的个体数，$N$是开始时该组的总个体数，则风险为 $CI = \\frac{A}{N}$。\n- 风险比（$RR$）：暴露（治疗）组的风险（$CI_T$）与非暴露（未治疗）组的风险（$CI_U$）之比。$RR = \\frac{CI_T}{CI_U}$。$RR  1$ 表示有保护作用，$RR > 1$ 表示有害作用，$RR = 1$ 表示无关联。\n\n#### 1) 分层特异性分析\n\n首先，我们分别分析每个分层（ICU和GW）内的数据，以获得分层特异性的关联度量。\n\n**ICU分层：**\n- 治疗患者的风险：$CI_{T, ICU} = \\frac{320}{800} = 0.4$。\n- 未治疗患者的风险：$CI_{U, ICU} = \\frac{100}{200} = 0.5$。\n- ICU分层的特异性风险比：$RR_{ICU} = \\frac{CI_{T, ICU}}{CI_{U, ICU}} = \\frac{0.4}{0.5} = 0.8$。\n\n由于$RR_{ICU} = 0.8$，小于$1$，ICU分层内的分析表明该抗生素具有保护作用，将感染风险降低了$20\\%$。\n\n**GW分层：**\n- 治疗患者的风险：$CI_{T, GW} = \\frac{10}{200} = 0.05$。\n- 未治疗患者的风险：$CI_{U, GW} = \\frac{80}{800} = 0.1$。\n- GW分层的特异性风险比：$RR_{GW} = \\frac{CI_{T, GW}}{CI_{U, GW}} = \\frac{0.05}{0.1} = 0.5$。\n\n由于$RR_{GW} = 0.5$，小于$1$，GW分层内的分析也表明该抗生素具有保护作用，将感染风险降低了$50\\%$。在两个分层中，治疗均显示出益处。\n\n#### 2) 粗略（未分层）分析\n\n接下来，我们忽略分层，汇总数据以计算粗略风险比。\n\n- 接受治疗的总患者数：$N_T = 800 (\\text{ICU}) + 200 (\\text{GW}) = 1000$。\n- 接受治疗患者中的总感染数：$A_T = 320 (\\text{ICU}) + 10 (\\text{GW}) = 330$。\n- 接受治疗患者的粗略风险：$CI_{T, crude} = \\frac{A_T}{N_T} = \\frac{330}{1000} = 0.33$。\n\n- 未接受治疗的总患者数：$N_U = 200 (\\text{ICU}) + 800 (\\text{GW}) = 1000$。\n- 未接受治疗患者中的总感染数：$A_U = 100 (\\text{ICU}) + 80 (\\text{GW}) = 180$。\n- 未接受治疗患者的粗略风险：$CI_{U, crude} = \\frac{A_U}{N_U} = \\frac{180}{1000} = 0.18$。\n\n- 粗略风险比：$RR_{crude} = \\frac{CI_{T, crude}}{CI_{U, crude}} = \\frac{0.33}{0.18} \\approx 1.8333$。\n\n粗略分析得出$RR_{crude} \\approx 1.83$，大于$1$。这表明该抗生素有害，使感染风险增加了约$83\\%$。这一结果与分层分析的发现直接矛盾。\n\n#### 3) 混杂与辛普森悖论\n\n分层分析和粗略分析之间关联方向的反转是辛普森悖论的一个经典例子。这种悖论的出现是由于存在混杂变量。如果一个变量与暴露和结局都有关联，并且不在它们之间的因果路径上，那么它就是一个混杂因素。在这里，入院状态（ICU vs. GW）就是混杂因素。\n\n1.  **与暴露（治疗）的关联：** 接受抗生素治疗的患者比例在不同分层之间存在巨大差异。\n    - 在ICU分层中，$1000$名患者中有$800$名（$80\\%$）接受了治疗。\n    - 在GW分层中，$1000$名患者中有$200$名（$20\\%$）接受了治疗。\n    因此，入院状态与接受治疗的可能性密切相关。ICU患者接受治疗的可能性要大得多。\n\n2.  **与结局（感染）的关联：** 感染的基线风险在不同分层之间是不同的，这与治疗无关。我们可以通过比较未治疗组的风险来观察到这一点。\n    - 在ICU，未治疗患者的风险为 $CI_{U, ICU} = 0.5$ ($50\\%$)。\n    - 在GW，未治疗患者的风险为 $CI_{U, GW} = 0.1$ ($10\\%$)。\n    ICU的感染风险是GW的$5$倍，这证实了入院状态是结局的一个强风险因素。\n\n3.  **不在因果路径上：** 入院状态（患者严重程度的标志）先于给予预防性治疗的决定。治疗不会导致患者的入院状态。\n\n由于ICU/GW状态是一个混杂因素，粗略比较是无效的。它不公平地将一个主要由高风险ICU患者组成的治疗组（$80\\%$的治疗患者来自ICU）与一个主要由低风险GW患者组成的未治疗组（$80\\%$的未治疗患者来自GW）进行比较。粗略$RR$被扭曲了，因为它反映的是比较组之间基线严重程度的差异，而不是抗生素的真实效果。分层分析通过在每个严重程度级别内进行“同类比较”来控制这种混杂，从而揭示了治疗的真实有益效果。\n\n#### 4) 合并的Mantel-Haenszel风险比\n\n为了获得一个经入院状态混杂因素调整后的单一效应总结度量，我们可以计算Mantel-Haenszel合并风险比（$RR_{MH}$）。$RR_{MH}$的公式是各分层特异性风险比的加权平均值：\n\n$$ RR_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{A_{Ti} N_{Ui}}{N_i}}{\\sum_{i=1}^{k} \\frac{A_{Ui} N_{Ti}}{N_i}} $$\n\n其中，$i$是分层的索引（$i=1$代表ICU，$i=2$代表GW），$A_{Ti}$和$A_{Ui}$是治疗组和未治疗组中的事件数，$N_{Ti}$和$N_{Ui}$是组的大小，$N_i = N_{Ti} + N_{Ui}$是第$i$层的总大小。\n\n每个分层$i$的数据可以总结在一个$2 \\times 2$表格中：\n\n| 分层 $i$ | 感染 | 未感染 | 总计 |\n|-------------|----------|--------------|-------|\n| 治疗组     | $A_{Ti}$ | $B_{Ti}$     | $N_{Ti}$ |\n| 未治疗组   | $A_{Ui}$ | $B_{Ui}$     | $N_{Ui}$ |\n| 总计       | $M_{1i}$ | $M_{0i}$     | $N_i$ |\n\n对于分层$1$ (ICU)：\n- $A_{T1} = 320$, $N_{T1} = 800$\n- $A_{U1} = 100$, $N_{U1} = 200$\n- $N_1 = 800 + 200 = 1000$\n\n对于分层$2$ (GW)：\n- $A_{T2} = 10$, $N_{T2} = 200$\n- $A_{U2} = 80$, $N_{U2} = 800$\n- $N_2 = 200 + 800 = 1000$\n\n现在，我们计算$RR_{MH}$公式的各个组成部分。\n\n来自于分层$1$ (ICU) 的分子部分：\n$$ \\frac{A_{T1} N_{U1}}{N_1} = \\frac{320 \\times 200}{1000} = 64 $$\n来自于分层$2$ (GW) 的分子部分：\n$$ \\frac{A_{T2} N_{U2}}{N_2} = \\frac{10 \\times 800}{1000} = 8 $$\n分子总计：$\\sum \\frac{A_{Ti} N_{Ui}}{N_i} = 64 + 8 = 72$。\n\n来自于分层$1$ (ICU) 的分母部分：\n$$ \\frac{A_{U1} N_{T1}}{N_1} = \\frac{100 \\times 800}{1000} = 80 $$\n来自于分层$2$ (GW) 的分母部分：\n$$ \\frac{A_{U2} N_{T2}}{N_2} = \\frac{80 \\times 200}{1000} = 16 $$\n分母总计：$\\sum \\frac{A_{Ui} N_{Ti}}{N_i} = 80 + 16 = 96$。\n\n最后，Mantel-Haenszel合并风险比为：\n$$ RR_{MH} = \\frac{72}{96} = 0.75 $$\n\n这个$0.75$的合并估计值代表了跨分层的、经入院状态混杂效应调整后的平均治疗效果。该值介于两个分层特异性风险比（$0.5$和$0.8$）之间，并证实了该抗生素平均而言具有保护作用。题目要求答案四舍五入至$4$位有效数字。\n\n$RR_{MH} = 0.7500$。", "answer": "$$\\boxed{0.7500}$$", "id": "4910845"}]}