{"hands_on_practices": [{"introduction": "实验设计的基石之一是确定研究所需的参与者数量。本练习将引导你从第一性原理出发，推导在比较两组均值时计算样本量的经典公式。通过这一推导过程，你将深刻理解统计功效、显著性水平、效应大小和数据变异性之间的相互关系，这对于规划任何有效且可靠的研究都至关重要。", "problem": "一位生物统计学家正在计划一项随机双臂研究，以比较治疗A和治疗B下连续性结局的均值。A组的结局是独立同分布的，服从 $N(\\mu_{A}, \\sigma^{2})$ 分布，B组的结局也独立同分布，服从 $N(\\mu_{B}, \\sigma^{2})$ 分布，两组的方差相同，均为 $\\sigma^{2}$。分配是均等的，每组有 $n$ 名受试者。主要分析将采用双侧合并双样本 $t$ 检验，在显著性水平 $\\alpha$ 下，检验零假设 $H_{0}: \\mu_{A} - \\mu_{B} = 0$ 与双侧备择假设 $H_{1}: \\mu_{A} - \\mu_{B} \\neq 0$。设计目标是在备择假设下，以 $1 - \\beta$ 的功效（power）检测出预先设定的差异 $\\delta = \\mu_{A} - \\mu_{B}$，其中 $\\delta \\neq 0$。\n\n从抽样分布的第一性原理、I型错误和功效的定义出发，并使用基于正态分布的 $t$ 检验的科学标准大样本计划近似，推导所需每组样本量 $n$ 的封闭式解析表达式，该表达式应以 $\\sigma^{2}$、$\\alpha$、$\\beta$ 和 $\\delta$ 表示。明确说明每一步所使用的假设，包括分布假设、独立性、方差相等、均等分配以及任何大样本近似。定义标准正态分位数 $z_{p}$ 满足 $\\Pr(Z \\leq z_{p}) = p$，其中 $Z \\sim N(0,1)$，并使用此符号表示您的答案。\n\n将最终答案表示为 $n$ 的单一封闭式解析表达式，无需四舍五入。本问题中 $n$ 没有物理单位。不要提供任何数值计算。", "solution": "### 推导\n我们首先根据所给的假设将问题形式化。\n\n**1. 假设：**\n- 设 $X_{A,i}$（其中 $i=1, \\dots, n$）为来自A组的独立同分布结局，其中 $X_{A,i} \\sim N(\\mu_A, \\sigma^2)$。\n- 设 $X_{B,i}$（其中 $i=1, \\dots, n$）为来自B组的独立同分布结局，其中 $X_{B,i} \\sim N(\\mu_B, \\sigma^2)$。\n- 两个样本相互独立。\n- 为计划目的，假定总体方差 $\\sigma^2$ 已知，这是对 $t$ 检验进行大样本近似的本质。\n\n**2. 均值差的抽样分布：**\n设 $\\bar{X}_A = \\frac{1}{n} \\sum_{i=1}^{n} X_{A,i}$ 和 $\\bar{X}_B = \\frac{1}{n} \\sum_{i=1}^{n} X_{B,i}$ 分别为A组和B组的样本均值。\n根据正态分布的性质，样本均值的抽样分布为：\n$\\bar{X}_A \\sim N\\left(\\mu_A, \\frac{\\sigma^2}{n}\\right)$\n$\\bar{X}_B \\sim N\\left(\\mu_B, \\frac{\\sigma^2}{n}\\right)$\n\n样本均值之差为 $\\bar{X}_A - \\bar{X}_B$。由于样本是独立的，这个差值的分布也是正态的。\n差值的均值为 $E[\\bar{X}_A - \\bar{X}_B] = E[\\bar{X}_A] - E[\\bar{X}_B] = \\mu_A - \\mu_B$。\n差值的方差为 $Var(\\bar{X}_A - \\bar{X}_B) = Var(\\bar{X}_A) + Var(\\bar{X}_B) = \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n} = \\frac{2\\sigma^2}{n}$。\n因此，均值差的抽样分布为：\n$$(\\bar{X}_A - \\bar{X}_B) \\sim N\\left(\\mu_A - \\mu_B, \\frac{2\\sigma^2}{n}\\right)$$\n\n**3. 检验统计量和拒绝域：**\n在大样本近似下，$\\sigma^2$ 被视为已知，检验统计量为：\n$$Z_{\\text{stat}} = \\frac{(\\bar{X}_A - \\bar{X}_B) - (\\mu_A - \\mu_B)_0}{\\sqrt{\\frac{2\\sigma^2}{n}}}$$\n在零假设 $H_0: \\mu_A - \\mu_B = 0$ 下，$(\\mu_A - \\mu_B)_0$ 的值为 $0$。该统计量变为：\n$$Z_{\\text{stat}} = \\frac{\\bar{X}_A - \\bar{X}_B}{\\sigma\\sqrt{\\frac{2}{n}}}$$\n在 $H_0$ 下，此统计量服从标准正态分布，$Z_{\\text{stat}} \\sim N(0,1)$。\n\n对于显著性水平为 $\\alpha$ 的双侧检验，如果 $|Z_{\\text{stat}}|$ 的观测值大于临界值 $z_{1-\\alpha/2}$，我们拒绝 $H_0$。拒绝域由 $|Z_{\\text{stat}}| > z_{1-\\alpha/2}$ 定义。分位数 $z_{1-\\alpha/2}$ 的选择使得 $\\Pr(Z > z_{1-\\alpha/2}) = \\alpha/2$，其中 $Z \\sim N(0,1)$。\n\n**4. 功效计算：**\n功效是在备择假设 $H_1$ 为真时拒绝 $H_0$ 的概率。功效为 $1-\\beta$。我们设计此研究是为了检测一个特定的差异 $\\delta = \\mu_A - \\mu_B$。\n在 $H_1$ 下，$(\\bar{X}_A - \\bar{X}_B)$ 的真实均值为 $\\delta$。检验统计量 $Z_{\\text{stat}}$ 不再以 $0$ 为中心。其在 $H_1$ 下的分布为：\n$$E[Z_{\\text{stat}}] = E\\left[\\frac{\\bar{X}_A - \\bar{X}_B}{\\sigma\\sqrt{\\frac{2}{n}}}\\right] = \\frac{E[\\bar{X}_A - \\bar{X}_B]}{\\sigma\\sqrt{\\frac{2}{n}}} = \\frac{\\delta}{\\sigma\\sqrt{\\frac{2}{n}}}$$\n$$Var(Z_{\\text{stat}}) = Var\\left(\\frac{\\bar{X}_A - \\bar{X}_B}{\\sigma\\sqrt{\\frac{2}{n}}}\\right) = \\frac{Var(\\bar{X}_A - \\bar{X}_B)}{(\\sigma\\sqrt{\\frac{2}{n}})^2} = \\frac{2\\sigma^2/n}{2\\sigma^2/n} = 1$$\n因此，在 $H_1$ 下，$Z_{\\text{stat}} \\sim N\\left(\\frac{\\delta}{\\sigma\\sqrt{2/n}}, 1\\right)$。\n\n功效是在 $H_1$ 为真的条件下，检验统计量落入拒绝域的概率：\n$$1 - \\beta = \\Pr(\\text{Reject } H_0 | H_1 \\text{ is true}) = \\Pr\\left(|Z_{\\text{stat}}| > z_{1-\\alpha/2} | \\mu_A - \\mu_B = \\delta\\right)$$\n这可展开为：\n$$1 - \\beta = \\Pr\\left(Z_{\\text{stat}} > z_{1-\\alpha/2} | H_1\\right) + \\Pr\\left(Z_{\\text{stat}}  -z_{1-\\alpha/2} | H_1\\right)$$\n不失一般性，假设 $\\delta  0$。在 $H_1$ 下，$Z_{\\text{stat}}$ 的均值为正，因此分布向右平移。对于典型的功效水平（例如 $ 0.5$），概率 $\\Pr\\left(Z_{\\text{stat}}  -z_{1-\\alpha/2} | H_1\\right)$ 变得可以忽略不计。因此，功效主要由第一项决定：\n$$1 - \\beta \\approx \\Pr\\left(Z_{\\text{stat}}  z_{1-\\alpha/2} | H_1\\right)$$\n为了计算这个概率，我们通过减去其在 $H_1$ 下的均值来对 $Z_{\\text{stat}}$ 进行标准化：\n$$1 - \\beta = \\Pr\\left(Z_{\\text{stat}} - \\frac{\\delta}{\\sigma\\sqrt{2/n}}  z_{1-\\alpha/2} - \\frac{\\delta}{\\sigma\\sqrt{2/n}}\\right)$$\n设 $W = Z_{\\text{stat}} - \\frac{\\delta}{\\sigma\\sqrt{2/n}}$。在 $H_1$ 下，$W \\sim N(0,1)$。\n$$1 - \\beta = \\Pr\\left(W  z_{1-\\alpha/2} - \\frac{\\delta}{\\sigma\\sqrt{2/n}}\\right)$$\n根据功效 $1-\\beta$ 的定义，对于标准正态分布 $W$，其右侧概率为 $1-\\beta$ 的点是 $z_{\\beta}$。因此，概率函数的参数必须等于 $z_\\beta$：\n$$z_{\\beta} = z_{1-\\alpha/2} - \\frac{\\delta}{\\sigma\\sqrt{2/n}}$$\n利用标准正态分位数的对称性，$z_{\\beta} = -z_{1-\\beta}$，我们得到：\n$$-z_{1-\\beta} = z_{1-\\alpha/2} - \\frac{\\delta}{\\sigma\\sqrt{2/n}}$$\n该方程假设 $\\delta > 0$。对于 $\\delta  0$ 的情况，推导会得到一个等价的方程，其中 $\\delta$ 被 $-\\delta$ (即 $|\\delta|$) 替代。因此，一个可以涵盖两种情况的通用方程是：\n$$z_{1-\\alpha/2} + z_{1-\\beta} = \\frac{|\\delta|}{\\sigma\\sqrt{2/n}}$$\n\n**5. 求解样本量 n：**\n我们现在求解方程，以得到每组的样本量 $n$。\n$$z_{1-\\alpha/2} + z_{1-\\beta} = \\frac{|\\delta|\\sqrt{n}}{\\sigma\\sqrt{2}}$$\n$$\\sqrt{n} = \\frac{\\sigma\\sqrt{2}(z_{1-\\alpha/2} + z_{1-\\beta})}{|\\delta|}$$\n两边平方，得到 $n$ 的表达式：\n$$n = \\left(\\frac{\\sigma\\sqrt{2}(z_{1-\\alpha/2} + z_{1-\\beta})}{|\\delta|}\\right)^2$$\n$$n = \\frac{2\\sigma^2(z_{1-\\alpha/2} + z_{1-\\beta})^2}{\\delta^2}$$\n由于 $\\delta$ 被平方，绝对值符号不再是必需的。这就是每组所需样本量的最终封闭式表达式。", "answer": "$$\n\\boxed{\\frac{2\\sigma^{2}(z_{1-\\alpha/2} + z_{1-\\beta})^{2}}{\\delta^{2}}}\n$$", "id": "4941140"}, {"introduction": "实验结束后，我们必须选择恰当的指标来量化处理效应。本练习要求你基于一组假设的试验数据，计算三种常见的效应量：风险差、风险比和优势比。更重要的是，本练习将引导你运用潜在结果框架，阐释为何风险差是随机化试验旨在识别的核心因果量——平均因果效应——的最直接估计，从而加深对随机化设计原理的理解。", "problem": "一个临床团队进行了一项随机对照试验 (RCT)，以评估一项旨在降低实验室确认的二元结局（$30$ 天内感染）风险的预防性干预措施。参与者在完全随机化、完全依从且无失访的条件下，被随机分配到干预组或对照组。令 $Y$ 表示二元结局（$Y=1$ 表示感染；$Y=0$ 表示未感染）。潜在结果为干预下的 $Y(1)$ 和对照下的 $Y(0)$，并且稳定单位处理价值假设 (SUTVA) 成立。实现的样本量和事件计数为：干预组 $n_{1}=184$，$x_{1}=28$ 例感染；对照组 $n_{0}=176$，$x_{0}=44$ 例感染。\n\n使用风险、优势和基于设计的因果推断的基本定义：\n- 计算两组的观测风险 $p_{1}$ 和 $p_{0}$，\n- 计算风险差 $p_{1}-p_{0}$、风险比 $p_{1}/p_{0}$ 和优势比 $\\frac{p_{1}/(1-p_{1})}{p_{0}/(1-p_{0})}$，\n- 从潜在结果框架和随机分配原则出发，解释这些待估参数中哪一个与随机化设计的目标因果效应最直接一致，并说明原因，明确指出该设计所能识别的因果量。\n\n将风险差 $p_{1}-p_{0}$ 作为您的最终数值答案，四舍五入到四位有效数字并以小数形式表示（不要使用百分号）。最终答案框中不应报告其他任何量。", "solution": "首先，我们计算干预组和对照组的观测风险（感染比例）。令 $p_1$ 为干预组的风险，$p_0$ 为对照组的风险。已知条件为：\n- 干预组：样本量 $n_1 = 184$，感染数 $x_1 = 28$。\n- 对照组：样本量 $n_0 = 176$，感染数 $x_0 = 44$。\n\n观测风险计算为各组的事件数除以参与者人数：\n$$p_1 = \\frac{x_1}{n_1} = \\frac{28}{184}$$\n$$p_0 = \\frac{x_0}{n_0} = \\frac{44}{176} = \\frac{1}{4} = 0.25$$\n\n现在，我们计算三个要求的待估参数：风险差 ($RD$)、风险比 ($RR$) 和优势比 ($OR$)。\n\n1.  **风险差 ($RD$)**:\n    $$RD = p_1 - p_0 = \\frac{28}{184} - \\frac{44}{176} = \\frac{28}{184} - \\frac{1}{4} = \\frac{28 - 46}{184} = \\frac{-18}{184} = -\\frac{9}{92}$$\n    以小数表示，$RD \\approx -0.097826...$\n\n2.  **风险比 ($RR$)**:\n    $$RR = \\frac{p_1}{p_0} = \\frac{28/184}{1/4} = \\frac{28 \\times 4}{184} = \\frac{112}{184} = \\frac{28}{46} = \\frac{14}{23}$$\n    以小数表示，$RR \\approx 0.608695...$\n\n3.  **优势比 ($OR$)**:\n    干预组的感染优势为 $o_1 = \\frac{p_1}{1-p_1}$。\n    $$1-p_1 = 1 - \\frac{28}{184} = \\frac{184-28}{184} = \\frac{156}{184}$$\n    $$o_1 = \\frac{28/184}{156/184} = \\frac{28}{156} = \\frac{7}{39}$$\n    对照组的感染优势为 $o_0 = \\frac{p_0}{1-p_0}$。\n    $$1-p_0 = 1 - \\frac{1}{4} = \\frac{3}{4}$$\n    $$o_0 = \\frac{1/4}{3/4} = \\frac{1}{3}$$\n    优势比是这些优势的比值：\n    $$OR = \\frac{o_1}{o_0} = \\frac{7/39}{1/3} = \\frac{7 \\times 3}{39} = \\frac{21}{39} = \\frac{7}{13}$$\n    以小数表示，$OR \\approx 0.538461...$\n\n任务的第二部分是解释在潜在结果框架内，这些待估参数中哪一个与随机化设计所针对的因果效应最直接一致。\n\n在许多情况下，我们感兴趣的主要因果待估参数是平均因果效应 (ACE)，也称为平均处理效应 (ATE)。对于个体 $i$，干预的因果效应定义为其潜在结果之间的差异：$Y_i(1) - Y_i(0)$，其中 $Y_i(1)$ 是他们接受干预时的结果，$Y_i(0)$ 是他们处于对照组时的结果。因果推断的基本问题是，对于任何给定的个体，我们只能观察到这两个潜在结果中的一个。\n\nATE 是这个体层面因果效应在整个群体上的期望：\n$$ATE = E[Y(1) - Y(0)]$$\n根据期望的线性性质，ATE可以写成：\n$$ATE = E[Y(1)] - E[Y(0)]$$\n由于结局 $Y$ 是一个二元变量（$0$ 或 $1$），其期望等于它取值为 $1$ 的概率。因此：\n$$E[Y(1)] = P(Y(1)=1)$$\n$$E[Y(0)] = P(Y(0)=1)$$\n所以，ATE 是在整个群体都暴露于两种条件下，结局发生概率的差异：\n$$ATE = P(Y(1)=1) - P(Y(0)=1)$$\n这就是因果风险差。\n\n随机对照试验的关键特征是处理分配，我们称之为 $Z$（其中 $Z=1$ 表示干预，$Z=0$ 表示对照），与潜在结果 $(Y(1), Y(0))$ 独立。这就是可交换性，形式上写为 $Z \\perp \\{Y(1), Y(0)\\}$。这个由随机化保证的性质，使我们能够从观测数据中识别 ATE。\n\n干预组中的观测风险 $p_1$ 是条件概率 $P(Y=1 | Z=1)$ 的估计。在潜在结果框架和稳定单位处理价值假设 (SUTVA) 下，对于 $Z=1$ 的个体，观测到的结局是 $Y = Y(1)$。因此：\n$$P(Y=1 | Z=1) = P(Y(1)=1 | Z=1)$$\n由于随机化 ($Z \\perp Y(1)$)，一个人在处理下的潜在结果与他是否真的被分配到处理组是独立的。因此：\n$$P(Y(1)=1 | Z=1) = P(Y(1)=1)$$\n这意味着干预组中的观测风险 $p_1$ 是“如果每个人都接受处理”这一情况下群体层面风险 $P(Y(1)=1)$ 的一个相合且无偏的估计量。\n\n类似地，对于对照组：\n$$P(Y=1 | Z=0) = P(Y(0)=1 | Z=0) = P(Y(0)=1)$$\n对照组中的观测风险 $p_0$ 是“如果每个人都未接受处理”这一情况下群体层面风险 $P(Y(0)=1)$ 的一个相合且无偏的估计量。\n\n基于这两个结果，观测到的风险差 $p_1 - p_0$ 是平均处理效应的一个相合且无偏的估计量：\n$$E[p_1 - p_0] = E[p_1] - E[p_0] = P(Y(1)=1) - P(Y(0)=1) = ATE$$\n风险差直接对应于 ATE，ATE 是在加性尺度上定义的，代表了个体层面因果效应的平均值 $E[Y_i(1) - Y_i(0)]$。\n\n风险比和优势比也是有效的因果待估参数，代表了乘性尺度上的因果效应。因果风险比是 $\\frac{P(Y(1)=1)}{P(Y(0)=1)}$，因果优势比是 $\\frac{P(Y(1)=1)/P(Y(1)=0)}{P(Y(0)=1)/P(Y(0)=0)}$。虽然随机化允许对它们进行无偏估计（例如，在对数尺度上），但它们是概率的非线性变换。它们不是个体层面效应的平均值。例如，风险比是平均值的比值 $\\frac{E[Y(1)]}{E[Y(0)]}$，而不是比值的平均值 $E[\\frac{Y(1)}{Y(0)}]$。因此，风险差被认为是随机化设计所针对的平均因果效应的最直接和最基本的度量，因为它将加性结构从个体层面保持到群体平均层面。它量化了由干预引起的平均风险的绝对变化。\n\n要求的最终答案是风险差 $p_1 - p_0$ 的数值，四舍五入到四位有效数字。\n$$p_1 - p_0 = -\\frac{9}{92} \\approx -0.09782608...$$\n四舍五入到四位有效数字得到 $-0.09783$。", "answer": "$$ \\boxed{-0.09783} $$", "id": "4941285"}]}