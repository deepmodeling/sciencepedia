{"hands_on_practices": [{"introduction": "本练习将通过一个地质勘探的实例，来巩固我们对条件概率乘法法则的理解。计算一个多阶段项目（先成功钻透覆盖岩层，再发现天然气）的总体成功率，是应用该法则的经典场景。这个基础练习旨在帮助你掌握如何计算一系列相依事件的联合概率，为后续更复杂的生物统计学问题打下坚实基础。", "problem": "一家地质勘探公司正在评估一个潜在的天然气钻探地点。目标储层位于厚厚的盖岩层之下。根据广泛的地质调查，该公司确定了此次作业的两个关键概率。首先，钻头成功穿透盖岩层的概率估计为0.82。其次，在成功穿透盖岩层的情况下，钻头接着能打到下方地层中的天然气储层的概率为0.35。\n\n如果钻头首先穿透盖岩层，然后打到天然气储层，则该作业被视为“完全成功”。根据公司的估计，完全成功的概率是多少？\n\n请将您的答案以十进制形式表示，并四舍五入到三位有效数字。", "solution": "设 $C$ 为钻头穿透盖岩层的事件，$G$ 为钻头打到天然气储层的事件。如果两个事件都发生，即 $C \\cap G$，则作业完全成功。\n\n根据条件概率的乘法法则，\n$$\nP(C \\cap G) = P(C) \\, P(G \\mid C).\n$$\n代入给定值，\n$$\nP(C \\cap G) = 0.82 \\times 0.35.\n$$\n具体计算如下：\n$$\n0.82 \\times 0.35 = \\frac{82}{100} \\times \\frac{35}{100} = \\frac{82 \\times 35}{10000} = \\frac{2870}{10000} = 0.287.\n$$\n四舍五入到三位有效数字，概率为 $0.287$。", "answer": "$$\\boxed{0.287}$$", "id": "1402914"}, {"introduction": "这个练习将条件概率的应用提升到了一个新的层次：统计推断。通过一个保险风险评估的案例，我们将模拟生物统计学中常见的诊断测试情景。此问题要求我们利用贝叶斯定理，根据新的证据（客户提出索赔）来更新我们对一个事件（客户为高风险）的判断概率，这正是条件概率在现实世界中发挥强大作用的核心体现。", "problem": "一家名为“神盾汽车保险”的保险公司分析其新投保人，以更好地了解风险状况。根据历史数据，该公司确定新投保人可分为两类：高风险和低风险。在他们庞大的新客户群体中，25%被归类为高风险，其余75%被归类为低风险。\n\n公司的数据还显示了投保人在其第一年保险期内至少提出一次索赔的可能性。高风险投保人在第一年内至少提出一次索赔的概率是0.60。低风险投保人在第一年内至少提出一次索赔的概率是0.15。\n\n假设随机选择一名新投保人，并观察到他们在第一年内至少提出了一次索赔。该投保人是高风险驾驶员的概率是多少？将你的答案表示为四舍五入到四位有效数字的小数。", "solution": "令$H$表示投保人为高风险，$L$表示低风险，$C$表示投保人在第一年内至少提出了一次索赔。已知$P(H)=0.25$，$P(L)=0.75$，$P(C \\mid H)=0.60$ 和 $P(C \\mid L)=0.15$。\n\n我们要求解 $P(H \\mid C)$，根据贝叶斯定理，它等于\n$$\nP(H \\mid C)=\\frac{P(C \\mid H)P(H)}{P(C)}.\n$$\n使用全概率公式，\n$$\nP(C)=P(C \\mid H)P(H)+P(C \\mid L)P(L).\n$$\n代入给定值，\n$$\nP(C)=0.60 \\cdot 0.25+0.15 \\cdot 0.75=0.15+0.1125=0.2625.\n$$\n因此，\n$$\nP(H \\mid C)=\\frac{0.60 \\cdot 0.25}{0.2625}=\\frac{0.15}{0.2625}.\n$$\n为了精确简化，注意分子和分母同乘以$400$得\n$$\n\\frac{0.15}{0.2625}=\\frac{60}{105}=\\frac{4}{7}.\n$$\n因此，\n$$\nP(H \\mid C)=\\frac{4}{7}\\approx 0.571428\\ldots\n$$\n四舍五入到四位有效数字，结果是$0.5714$。", "answer": "$$\\boxed{0.5714}$$", "id": "1351175"}, {"introduction": "本练习将引导我们探索生物统计学中一个深刻而关键的概念——辛普森悖论。通过分析一个关于呼吸疗法的观察性研究数据，你将看到一个惊人的现象：在每个亚组中均显示有效的疗法，在总体上却可能表现出相反的效果。这个问题将迫使我们使用总概率定律和条件概率来剖析数据，理解“混杂变量”是如何扭曲结果的，并凸显分层分析在得出可靠科学结论中的关键作用 [@problem_id:4901792]。", "problem": "在一项关于呼吸系统疗法的观察性队列研究中，设 $A$ 表示患者在 $30$ 天内达到临床验证康复的事件，设 $B$ 表示患者接受该疗法的事件，设 $B^{c}$ 表示患者未接受该疗法的补事件。设 $C$ 表示基线时的疾病严重程度，分为两个分层：$C=\\text{High}$ 和 $C=\\text{Low}$。观察到以下计数：\n\n- 在 $C=\\text{High}$ 分层中：\n  - 在 $B$ 组中，有 $900$ 名患者，其中 $180$ 人达到了 $A$。\n  - 在 $B^{c}$ 组中，有 $100$ 名患者，其中 $15$ 人达到了 $A$。\n\n- 在 $C=\\text{Low}$ 分层中：\n  - 在 $B$ 组中，有 $100$ 名患者，其中 $98$ 人达到了 $A$。\n  - 在 $B^{c}$ 组中，有 $900$ 名患者，其中 $855$ 人达到了 $A$。\n\n仅使用条件概率的核心定义、乘法法则以及基于划分 $\\{C=\\text{High},\\,C=\\text{Low}\\}$ 的全概率定律，完成以下任务：\n\n1. 计算分层特定概率 $P(A \\mid B, C=\\text{High})$、$P(A \\mid B^{c}, C=\\text{High})$、$P(A \\mid B, C=\\text{Low})$ 和 $P(A \\mid B^{c}, C=\\text{Low})$，并验证在每个分层内都有 $P(A \\mid B, C)>P(A \\mid B^{c}, C)$。\n\n2. 用分层特定概率和分层权重表示边际概率 $P(A \\mid B)$ 和 $P(A \\mid B^{c})$，并根据给定计数计算它们的值。使用全概率定律以及 $C$ 在 $B$ 和 $B^{c}$ 中的分布，解释边际比较相对于分层特定比较是如何反转的。\n\n3. 计算边际风险差 $P(A \\mid B)-P(A \\mid B^{c})$。将最终数值答案四舍五入到四位有效数字。将概率表示为小数。", "solution": "设一个组中的个体数量用 $N(\\cdot)$ 表示。提供的计数如下：\n在 $C=\\text{High}$ 分层中：\n- $N(B \\cap \\{C=\\text{High}\\}) = 900$\n- $N(A \\cap B \\cap \\{C=\\text{High}\\}) = 180$\n- $N(B^c \\cap \\{C=\\text{High}\\}) = 100$\n- $N(A \\cap B^c \\cap \\{C=\\text{High}\\}) = 15$\n\n在 $C=\\text{Low}$ 分层中：\n- $N(B \\cap \\{C=\\text{Low}\\}) = 100$\n- $N(A \\cap B \\cap \\{C=\\text{Low}\\}) = 98$\n- $N(B^c \\cap \\{C=\\text{Low}\\}) = 900$\n- $N(A \\cap B^c \\cap \\{C=\\text{Low}\\}) = 855$\n\n**1. 分层特定概率和比较**\n\n我们计算在给定治疗状态（$B$ 或 $B^c$）和疾病严重程度分层（$C$）的情况下，康复（$A$）的分层特定概率。条件概率 $P(X \\mid Y)$ 根据计数估计为 $\\frac{N(X \\cap Y)}{N(Y)}$。\n\n对于 $C=\\text{High}$ 分层：\n接受治疗后康复的概率是：\n$$P(A \\mid B, C=\\text{High}) = \\frac{N(A \\cap B \\cap \\{C=\\text{High}\\})}{N(B \\cap \\{C=\\text{High}\\})} = \\frac{180}{900} = 0.20$$\n未接受治疗而康复的概率是：\n$$P(A \\mid B^c, C=\\text{High}) = \\frac{N(A \\cap B^c \\cap \\{C=\\text{High}\\})}{N(B^c \\cap \\{C=\\text{High}\\})} = \\frac{15}{100} = 0.15$$\n比较这些值，我们发现 $0.20 > 0.15$，因此 $P(A \\mid B, C=\\text{High}) > P(A \\mid B^c, C=\\text{High})$。\n\n对于 $C=\\text{Low}$ 分层：\n接受治疗后康复的概率是：\n$$P(A \\mid B, C=\\text{Low}) = \\frac{N(A \\cap B \\cap \\{C=\\text{Low}\\})}{N(B \\cap \\{C=\\text{Low}\\})} = \\frac{98}{100} = 0.98$$\n未接受治疗而康复的概率是：\n$$P(A \\mid B^c, C=\\text{Low}) = \\frac{N(A \\cap B^c \\cap \\{C=\\text{Low}\\})}{N(B^c \\cap \\{C=\\text{Low}\\})} = \\frac{855}{900} = 0.95$$\n比较这些值，我们发现 $0.98 > 0.95$，因此 $P(A \\mid B, C=\\text{Low}) > P(A \\mid B^c, C=\\text{Low})$。\n\n在两个分层中，接受治疗的患者康复的概率都更高。这验证了在每个分层 $C$ 内，都有 $P(A \\mid B, C) > P(A \\mid B^c, C)$。\n\n**2. 边际概率与反转的解释**\n\n我们使用全概率定律，以划分 $\\{C=\\text{High}, C=\\text{Low}\\}$ 为条件，来表示边际概率 $P(A \\mid B)$ 和 $P(A \\mid B^c)$。\n$P(A \\mid B)$ 的公式是：\n$$P(A \\mid B) = P(A \\mid B, C=\\text{High})P(C=\\text{High} \\mid B) + P(A \\mid B, C=\\text{Low})P(C=\\text{Low} \\mid B)$$\n类似地，对于 $P(A \\mid B^c)$：\n$$P(A \\mid B^c) = P(A \\mid B^c, C=\\text{High})P(C=\\text{High} \\mid B^c) + P(A \\mid B^c, C=\\text{Low})P(C=\\text{Low} \\mid B^c)$$\n\n项 $P(C \\mid B)$ 和 $P(C \\mid B^c)$ 作为权重。我们根据数据计算这些值：\n$B$ 组的总患者数：$N(B) = N(B \\cap \\{C=\\text{High}\\}) + N(B \\cap \\{C=\\text{Low}\\}) = 900 + 100 = 1000$。\n$B^c$ 组的总患者数：$N(B^c) = N(B^c \\cap \\{C=\\text{High}\\}) + N(B^c \\cap \\{C=\\text{Low}\\}) = 100 + 900 = 1000$。\n\n治疗组（$B$）的权重是：\n$P(C=\\text{High} \\mid B) = \\frac{N(B \\cap \\{C=\\text{High}\\})}{N(B)} = \\frac{900}{1000} = 0.9$\n$P(C=\\text{Low} \\mid B) = \\frac{N(B \\cap \\{C=\\text{Low}\\})}{N(B)} = \\frac{100}{1000} = 0.1$\n\n未治疗组（$B^c$）的权重是：\n$P(C=\\text{High} \\mid B^c) = \\frac{N(B^c \\cap \\{C=\\text{High}\\})}{N(B^c)} = \\frac{100}{1000} = 0.1$\n$P(C=\\text{Low} \\mid B^c) = \\frac{N(B^c \\cap \\{C=\\text{Low}\\})}{N(B^c)} = \\frac{900}{1000} = 0.9$\n\n现在，我们使用加权平均计算边际概率：\n$P(A \\mid B) = (0.20)(0.9) + (0.98)(0.1) = 0.18 + 0.098 = 0.278$。\n$P(A \\mid B^c) = (0.15)(0.1) + (0.95)(0.9) = 0.015 + 0.855 = 0.870$。\n\n我们可以直接从总计数中验证这些结果：\n$B$ 组的总康复人数：$N(A \\cap B) = 180 + 98 = 278$。\n$P(A \\mid B) = \\frac{N(A \\cap B)}{N(B)} = \\frac{278}{1000} = 0.278$。\n$B^c$ 组的总康复人数：$N(A \\cap B^c) = 15 + 855 = 870$。\n$P(A \\mid B^c) = \\frac{N(A \\cap B^c)}{N(B^c)} = \\frac{870}{1000} = 0.870$。\n计算结果一致。\n\n边际比较为 $P(A \\mid B) = 0.278$ 和 $P(A \\mid B^c) = 0.870$，这表明 $P(A \\mid B)  P(A \\mid B^c)$。这与在每个分层内观察到的关联是相反的。\n\n这种反转（辛普森悖论）的解释在于疾病严重程度（$C$）的混杂效应。变量 $C$ 是一个混杂因素，因为它与治疗（$B$）和结果（$A$）都有关联。具体来说：\n- $C$ 与结果 $A$ 相关：无论是否接受治疗，严重程度低的患者康复的机会要高得多（低严重程度组为 $0.98$ 和 $0.95$，而高严重程度组为 $0.20$ 和 $0.15$）。\n- $C$ 与治疗 $B$ 相关：在治疗组和未治疗组之间，疾病严重程度的分布差异巨大。在治疗组（$B$）中，$90\\%$ 的患者是高严重程度疾病（$P(C=\\text{High} \\mid B) = 0.9$）。在未治疗组（$B^c$）中，只有 $10\\%$ 是高严重程度疾病；相反，$90\\%$ 是低严重程度疾病（$P(C=\\text{Low} \\mid B^c) = 0.9$）。\n这表明该疗法优先用于预后较差的高严重程度疾病患者。边际概率 $P(A \\mid B)$ 是一个加权平均值，受高严重程度组的低康复率的严重影响。相比之下，边际概率 $P(A \\mid B^c)$ 则受构成未治疗人群 $90\\%$ 的低严重程度组的高康复率的严重影响。预后因素 $C$ 在各治疗组中的这种不平衡造成了误导性的边际关联，掩盖了在每个同质分层内疗法的益处。\n\n**3. 边际风险差**\n\n边际风险差是治疗组和未治疗组的边际康复概率之差。\n$$ \\text{风险差} = P(A \\mid B) - P(A \\mid B^c) $$\n使用计算出的值：\n$$ \\text{风险差} = 0.278 - 0.870 = -0.592 $$\n问题要求将结果四舍五入到四位有效数字。\n$$ \\text{风险差} \\approx -0.5920 $$", "answer": "$$\\boxed{-0.5920}$$", "id": "4901792"}]}