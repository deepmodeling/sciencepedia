{"hands_on_practices": [{"introduction": "本练习旨在巩固关于互斥且穷尽事件的最基本但至关重要的概率公理。通过一个简单的假设场景，你将练习应用以下原则：一组完整的、不重叠结果的总概率必须为 1。这是为任何概率分析划分样本空间的基础。", "problem": "一个实验室正在对一种新型量子系统进行实验。当被观测时，该系统会坍缩到三个可能且互不相同的状态之一，分别标记为状态1、状态2和状态3。实验的设计使得该系统必须且只能坍缩到这三个状态中的一个。\n\n令 $E_1$ 为系统坍缩到状态1的事件，$E_2$ 为系统坍缩到状态2的事件，$E_3$ 为系统坍缩到状态3的事件。前两个事件的概率给定如下：\n- $P(E_1) = p_1$\n- $P(E_2) = p_2$\n\n其中 $p_1$ 和 $p_2$ 是正数常量，且满足 $p_1 + p_2  1$。\n\n使用概率论的基本公理，推导系统坍缩到状态3的概率 $P(E_3)$ 的表达式。", "solution": "我们使用三个互斥且完备事件满足的公理\n$$P(E_1)+P(E_2)+P(E_3)=1.$$\n代入 $P(E_1)=p_1$ 和 $P(E_2)=p_2$：\n$$p_1 + p_2 + P(E_3) = 1.$$\n整理以求解 $P(E_3)$：\n$$P(E_3) = 1 - p_1 - p_2.$$", "answer": "$$\\boxed{1 - p_1 - p_2}$$", "id": "11"}, {"introduction": "在概率论中，互斥性与独立性是两个常被混淆的概念，然而它们描述的是事件之间根本不同的关系。本实践题将要求你利用一个涉及生物标记物和临床结果的真实生物统计学数据集，来区分这两个概念。掌握这种区分对于正确解释医学研究中的关联至关重要。", "problem": "一个生物统计学团队正在一个队列研究中，研究一个二元实验室生物标志物 $M$（阳性 $M^+$，阴性 $M^-$）和一个二元临床结局 $Y$（改善 $Y^+$，未改善 $Y^-$）之间的关系。一名随机选择的参与者的样本空间 $\\Omega$ 由四个联合结局组成：$\\{(M^+,Y^+),(M^+,Y^-),(M^-,Y^+),(M^-,Y^-)\\}$，每个联合结局都被赋予了概率。对于下面的每个选项，都给出了关于 $\\Omega$ 的一个完整概率模型以及事件 $A$ 和 $B$ 的定义。选择所有 $A$ 和 $B$ 既相互独立又非互斥的选项。必须使用所提供的概率模型，从第一性原理出发来评估独立性、互斥性和穷尽性。\n\n选项 A:\n- 联合概率: $P(M^+,Y^+)=0.20$, $P(M^+,Y^-)=0.20$, $P(M^-,Y^+)=0.30$, $P(M^-,Y^-)=0.30$。\n- 事件: $A=\\{M^+\\}$, $B=\\{Y^+\\}$。\n\n选项 B:\n- 联合概率: $P(M^+,Y^+)=0.10$, $P(M^+,Y^-)=0.30$, $P(M^-,Y^+)=0.40$, $P(M^-,Y^-)=0.20$。\n- 事件: $A=\\{M^+\\}$, $B=\\{Y^+\\}$。\n\n选项 C:\n- 联合概率: $P(M^+,Y^+)=0.20$, $P(M^+,Y^-)=0.20$, $P(M^-,Y^+)=0.30$, $P(M^-,Y^-)=0.30$。\n- 事件: $A=\\{M^+\\}$, $B=\\{M^-\\}$。\n\n选项 D:\n- 联合概率: $P(M^+,Y^+)=0.20$, $P(M^+,Y^-)=0.20$, $P(M^-,Y^+)=0.30$, $P(M^-,Y^-)=0.30$。\n- 事件: $A=\\{M^+\\cup Y^+\\}$, $B=\\{Y^+\\}$。\n\n选项 E:\n- 联合概率: $P(M^+,Y^+)=0.30$, $P(M^+,Y^-)=0.30$, $P(M^-,Y^+)=0.20$, $P(M^-,Y^-)=0.20$。\n- 事件: $A=\\{M^+\\}$, $B=\\{Y^+\\}$。", "solution": "首先将验证问题陈述的科学合理性、清晰性和完整性。\n\n### 步骤1：提取已知条件\n\n-   **样本空间**：一名随机选择的参与者的样本空间 $\\Omega$ 由四个联合结局组成：$\\Omega = \\{(M^+,Y^+),(M^+,Y^-),(M^-,Y^+),(M^-,Y^-)\\}$。\n-   **生物标志物**：一个二元实验室生物标志物 $M$，状态为阳性 ($M^+$) 和阴性 ($M^-$)。\n-   **临床结局**：一个二元临床结局 $Y$，状态为改善 ($Y^+$) 和未改善 ($Y^-$)。\n-   **任务**：对于每个选项，都给出了一个完整的概率模型。我们必须选择所有定义的事件 $A$ 和 $B$ 既相互独立又非互斥的选项。\n-   **要求分析**：评估必须基于概率论的第一性原理。\n\n### 步骤2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于初等概率论及其在生物统计学中的应用，这是一个标准且合法的科学领域。样本空间、事件、联合概率、边际概率、独立性和互斥性的概念是概率论的基础。该场景是临床研究中常见的场景。\n-   **良态问题**：该问题是良态的。对于每个选项，都提供了样本空间上的一个完整概率分布（概率之和为 $1$），并且事件 $A$ 和 $B$ 的定义清晰明确。问题要求基于这些定义进行判断，每个选项都有唯一的答案。\n-   **客观性**：问题以精确、客观的语言陈述。独立性（$P(A \\cap B) = P(A)P(B)$）和互斥性（$A \\cap B = \\emptyset$，意味着 $P(A \\cap B)=0$）的标准是标准的数学定义。\n\n该问题不违反任何无效性标准。这是一个应用概率论中的直接问题。\n\n### 步骤3：结论与行动\n\n问题陈述是 **有效的**。开始求解。\n\n### 解题过程\n\n问题要求我们找出所有选项，其中事件 $A$ 和 $B$ 同时满足：\n1.  **独立**：两个事件 $A$ 和 $B$ 相互独立，当且仅当 $P(A \\cap B) = P(A)P(B)$。\n2.  **非互斥**：两个事件 $A$ 和 $B$ 不是互斥的，如果它们的交集非空，即 $A \\cap B \\neq \\emptyset$。对于一个所有基本结局概率都非零的有效概率模型，这等价于 $P(A \\cap B)  0$。\n\n我们将根据这两个标准分析每个选项。事件 $\\{M^+\\}$ 对应于结局集合 $\\{(M^+, Y^+), (M^+, Y^-)\\}$，事件 $\\{Y^+\\}$ 对应于 $\\{(M^+, Y^+), (M^-, Y^+)\\}$。这类事件的概率（边际概率）是通过将其包含的基本结局的概率相加得到的。\n\n**选项 A**\n-   联合概率: $P(M^+,Y^+)=0.20$, $P(M^+,Y^-)=0.20$, $P(M^-,Y^+)=0.30$, $P(M^-,Y^-)=0.30$。概率和为 $0.20+0.20+0.30+0.30=1.00$。\n-   事件: $A=\\{M^+\\}$, $B=\\{Y^+\\}$。\n-   每个事件的基本结局是：\n    -   $A = \\{(M^+, Y^+), (M^+, Y^-)\\}$.\n    -   $B = \\{(M^+, Y^+), (M^-, Y^+)\\}$.\n-   事件的交集是 $A \\cap B = \\{(M^+, Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(M^+, Y^+) = 0.20$。\n-   因为 $P(A \\cap B) = 0.20  0$，所以事件 **非互斥**。\n-   现在，我们检查独立性。我们计算边际概率 $P(A)$ 和 $P(B)$：\n    -   $P(A) = P(M^+) = P(M^+, Y^+) + P(M^+, Y^-) = 0.20 + 0.20 = 0.40$。\n    -   $P(B) = P(Y^+) = P(M^+, Y^+) + P(M^-, Y^+) = 0.20 + 0.30 = 0.50$。\n-   我们计算乘积 $P(A)P(B) = 0.40 \\times 0.50 = 0.20$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.20$ 并且 $P(A)P(B) = 0.20$。因为 $P(A \\cap B) = P(A)P(B)$，所以事件是 **独立的**。\n-   结论：选项A满足两个条件（独立且非互斥）。**正确**。\n\n**选项 B**\n-   联合概率: $P(M^+,Y^+)=0.10$, $P(M^+,Y^-)=0.30$, $P(M^-,Y^+)=0.40$, $P(M^-,Y^-)=0.20$。概率和为 $0.10+0.30+0.40+0.20=1.00$。\n-   事件: $A=\\{M^+\\}$, $B=\\{Y^+\\}$。\n-   交集是 $A \\cap B = \\{(M^+, Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(M^+, Y^+) = 0.10$。\n-   因为 $P(A \\cap B) = 0.10  0$，所以事件 **非互斥**。\n-   现在，我们检查独立性：\n    -   $P(A) = P(M^+) = P(M^+, Y^+) + P(M^+, Y^-) = 0.10 + 0.30 = 0.40$。\n    -   $P(B) = P(Y^+) = P(M^+, Y^+) + P(M^-, Y^+) = 0.10 + 0.40 = 0.50$。\n-   我们计算乘积 $P(A)P(B) = 0.40 \\times 0.50 = 0.20$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.10$ 并且 $P(A)P(B) = 0.20$。因为 $P(A \\cap B) \\neq P(A)P(B)$，所以事件 **不独立**。\n-   结论：选项B不满足独立性条件。**不正确**。\n\n**选项 C**\n-   联合概率: 与选项A相同。$P(M^+,Y^+)=0.20$, $P(M^+,Y^-)=0.20$, $P(M^-,Y^+)=0.30$, $P(M^-,Y^-)=0.30$。\n-   事件: $A=\\{M^+\\}$, $B=\\{M^-\\}$。\n-   事件定义为：\n    -   $A = \\{(M^+, Y^+), (M^+, Y^-)\\}$.\n    -   $B = \\{(M^-, Y^+), (M^-, Y^-)\\}$.\n-   这两个集合的交集为空：$A \\cap B = \\emptyset$。\n-   因此，事件是 **互斥的**。\n-   问题要求事件 *非* 互斥。\n-   结论：选项C不满足“非互斥”条件。**不正确**。\n\n**选项 D**\n-   联合概率: 与选项A相同。$P(M^+,Y^+)=0.20$, $P(M^+,Y^-)=0.20$, $P(M^-,Y^+)=0.30$, $P(M^-,Y^-)=0.30$。\n-   事件: $A=\\{M^+\\cup Y^+\\}$, $B=\\{Y^+\\}$。\n-   每个事件的基本结局是：\n    -   $A = \\{M^+\\} \\cup \\{Y^+\\} = \\{(M^+,Y^+), (M^+,Y^-)\\} \\cup \\{(M^+,Y^+), (M^-,Y^+)\\} = \\{(M^+,Y^+), (M^+,Y^-), (M^-,Y^+)\\}$。\n    -   $B = \\{Y^+\\} = \\{(M^+,Y^+), (M^-,Y^+)\\}$。\n-   交集是 $A \\cap B = B = \\{(M^+,Y^+), (M^-,Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(B) = P(Y^+) = P(M^+,Y^+) + P(M^-,Y^+) = 0.20 + 0.30 = 0.50$。\n-   因为 $P(A \\cap B) = 0.50  0$，所以事件 **非互斥**。\n-   现在，我们检查独立性。我们需要 $P(A)$ 和 $P(B)$。我们已经有 $P(B)=0.50$。\n    -   $P(A) = P(\\{(M^+,Y^+), (M^+,Y^-), (M^-,Y^+)\\}) = P(M^+,Y^+) + P(M^+,Y^-) + P(M^-,Y^+) = 0.20 + 0.20 + 0.30 = 0.70$。\n-   我们计算乘积 $P(A)P(B) = 0.70 \\times 0.50 = 0.35$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.50$ 并且 $P(A)P(B) = 0.35$。因为 $P(A \\cap B) \\neq P(A)P(B)$，所以事件 **不独立**。（注意：当一个事件 $B$ 是另一个事件 $A$ 的真子集时，即 $B \\subset A$，它们只有在 $P(B)0$ 且 $P(A)=1$ 时，或者在 $P(B)=0$ 时才能独立。这里，$P(A)=0.70 \\neq 1$ 且 $P(B)=0.50  0$，所以它们不可能是独立的。）\n-   结论：选项D不满足独立性条件。**不正确**。\n\n**选项 E**\n-   联合概率: $P(M^+,Y^+)=0.30$, $P(M^+,Y^-)=0.30$, $P(M^-,Y^+)=0.20$, $P(M^-,Y^-)=0.20$。概率和为 $0.30+0.30+0.20+0.20=1.00$。\n-   事件: $A=\\{M^+\\}$, $B=\\{Y^+\\}$。\n-   交集是 $A \\cap B = \\{(M^+, Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(M^+, Y^+) = 0.30$。\n-   因为 $P(A \\cap B) = 0.30  0$，所以事件 **非互斥**。\n-   现在，我们检查独立性：\n    -   $P(A) = P(M^+) = P(M^+, Y^+) + P(M^+, Y^-) = 0.30 + 0.30 = 0.60$。\n    -   $P(B) = P(Y^+) = P(M^+, Y^+) + P(M^-, Y^+) = 0.30 + 0.20 = 0.50$。\n-   我们计算乘积 $P(A)P(B) = 0.60 \\times 0.50 = 0.30$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.30$ 并且 $P(A)P(B) = 0.30$。因为 $P(A \\cap B) = P(A)P(B)$，所以事件是 **独立的**。\n-   结论：选项E满足两个条件（独立且非互斥）。**正确**。\n\n总结来说，选项 A 和 E 都描述了事件 $A$ 和 $B$ 既相互独立又非互斥的情形。", "answer": "$$\\boxed{AE}$$", "id": "4931655"}, {"introduction": "最后的这项练习将从基础理论过渡到生物统计学的实际应用。在分析分类数据时，例如将患者分为不同的疾病组，我们依赖于这些类别是互斥且穷尽的事实。本练习将引导你推导并应用多项分布模型[@problem_id:4931638]，这是从样本计数中估计疾病患病率的关键工具。", "problem": "一项医院监测研究将每位患者精确地分入$K$个互斥且穷尽的疾病类别之一，这意味着对于任何单个患者，$K$个类别中恰好有一个会发生，且没有两个类别会同时发生。假设患者的入组就其疾病类别而言是独立同分布的（i.i.d.），并令 $\\mathbf{p} = (p_{1}, \\dots, p_{K})$ 表示各类别的（未知）概率向量，其中 $\\sum_{k=1}^{K} p_{k} = 1$ 且对所有 $k$ 都有 $p_{k} \\in (0,1)$。\n\n根据概率论的第一性原理（概率公理以及互斥和穷尽事件的定义），对于$n$名独立患者的计数向量 $\\mathbf{X} = (X_{1}, \\dots, X_{K})$，可以使用一个经过充分检验的、适用于总和约束为$n$的多变量计数的分布来进行建模。请明确地建立这个模型，并利用似然原理和约束优化，根据观测到的计数推导出每个 $p_{k}$ 的最大似然估计（MLE）。\n\n将您的推导应用于以下来自 $n = 320$ 名患者、分为 $K = 5$ 个类别的数据：\n- 传染病：$X_{1} = 124$\n- 心血管疾病：$X_{2} = 89$\n- 呼吸系统疾病：$X_{3} = 57$\n- 肿瘤：$X_{4} = 38$\n- 其他诊断：$X_{5} = 12$\n\n将最终的估计概率表示为四舍五入到四位有效数字的小数，并按照与上述类别对应的顺序 $(p_{1}, p_{2}, p_{3}, p_{4}, p_{5})$ 排列。", "solution": "问题陈述经评估为有效。它在科学上基于概率论和统计推断的原理，特别是关于分类数据分析，这是生物统计学的一个核心课题。该问题提法恰当，提供了所有必要的数据和明确的目标：推导并应用多项分布参数的最大似然估计量。所提供的数据是自洽的，因为计数总和 $124 + 89 + 57 + 38 + 12 = 320$ 等于患者总数 $n$。该问题是客观的，没有歧义。\n\n该问题描述了将 $n$ 名独立患者分入 $K$ 个互斥且穷尽的类别之一的过程。这是一个经典的多项实验设置。\n令 $\\mathbf{X} = (X_1, X_2, \\dots, X_K)$ 为 $K$ 个类别中每个类别的计数的随机向量，其中 $\\sum_{k=1}^{K} X_k = n$。\n令 $\\mathbf{p} = (p_1, p_2, \\dots, p_K)$ 为单个患者落入每个类别的概率向量，其中对所有 $k$ 都有 $p_k  0$ 且 $\\sum_{k=1}^{K} p_k = 1$。\n\n由于患者是独立同分布（i.i.d.）入组的，计数向量 $\\mathbf{X}$ 服从多项分布。观测到特定计数向量 $\\mathbf{x} = (x_1, x_2, \\dots, x_K)$ 的概率质量函数（PMF）由下式给出：\n$$ P(\\mathbf{X} = \\mathbf{x} | \\mathbf{p}) = \\frac{n!}{x_1! x_2! \\dots x_K!} \\prod_{k=1}^{K} p_k^{x_k} $$\n其中 $\\sum_{k=1}^{K} x_k = n$。\n\n$\\mathbf{p}$ 的最大似然估计（MLE）是使似然函数 $L(\\mathbf{p} | \\mathbf{x})$ 最大化的 $\\mathbf{p}$ 值，该函数在数值上等同于概率质量函数，但在固定观测数据 $\\mathbf{x}$ 的情况下被视为参数 $\\mathbf{p}$ 的函数。\n$$ L(\\mathbf{p}; \\mathbf{x}) = \\frac{n!}{\\prod_{k=1}^{K} x_k!} \\prod_{k=1}^{K} p_k^{x_k} $$\n为简化最大化过程，我们使用对数似然函数 $\\ell(\\mathbf{p}; \\mathbf{x}) = \\ln(L(\\mathbf{p}; \\mathbf{x}))$。由于对数是单调递增函数，最大化对数似然等价于最大化似然。\n$$ \\ell(\\mathbf{p}; \\mathbf{x}) = \\ln\\left(\\frac{n!}{\\prod_{k=1}^{K} x_k!}\\right) + \\ln\\left(\\prod_{k=1}^{K} p_k^{x_k}\\right) = \\ln(C) + \\sum_{k=1}^{K} x_k \\ln(p_k) $$\n其中 $C$ 是多项系数，它是一个相对于 $\\mathbf{p}$ 的常数。\n\n我们必须在概率总和为一的约束条件 $g(\\mathbf{p}) = \\sum_{k=1}^{K} p_k - 1 = 0$ 下最大化 $\\ell(\\mathbf{p}; \\mathbf{x})$。这是一个可以使用拉格朗日乘数法解决的约束优化问题。拉格朗日函数 $\\mathcal{L}(\\mathbf{p}, \\lambda)$ 为：\n$$ \\mathcal{L}(\\mathbf{p}, \\lambda) = \\ell(\\mathbf{p}; \\mathbf{x}) - \\lambda g(\\mathbf{p}) = \\left( \\ln(C) + \\sum_{k=1}^{K} x_k \\ln(p_k) \\right) - \\lambda \\left(\\sum_{k=1}^{K} p_k - 1\\right) $$\n为了找到临界点，我们对 $\\mathcal{L}$ 分别求关于每个 $p_j$（对于 $j = 1, \\dots, K$）和拉格朗日乘数 $\\lambda$ 的偏导数，并令它们为零。\n$$ \\frac{\\partial \\mathcal{L}}{\\partial p_j} = \\frac{x_j}{p_j} - \\lambda = 0 $$\n这得到 $x_j = \\lambda p_j$，或 $p_j = \\frac{x_j}{\\lambda}$，对于每个 $j = 1, \\dots, K$。\n\n关于 $\\lambda$ 的偏导数恢复了约束条件：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{k=1}^{K} p_k - 1\\right) = 0 \\implies \\sum_{k=1}^{K} p_k = 1 $$\n现在，我们将表达式 $p_k = x_k/\\lambda$ 代入约束方程中：\n$$ \\sum_{k=1}^{K} \\frac{x_k}{\\lambda} = 1 $$\n$$ \\frac{1}{\\lambda} \\sum_{k=1}^{K} x_k = 1 $$\n鉴于观测总数为 $n = \\sum_{k=1}^{K} x_k$，我们求出乘数 $\\lambda$ 的值：\n$$ \\frac{n}{\\lambda} = 1 \\implies \\lambda = n $$\n将 $\\lambda$ 的这个值代回到 $p_j$ 的表达式中，我们得到最大似然估计量 $\\hat{p}_j$：\n$$ \\hat{p}_j = \\frac{x_j}{n} $$\n因此，每个类别概率的MLE是其样本比例。\n\n现在，我们将此结果应用于给定数据：\n患者总数，$n = 320$。\n类别数，$K = 5$。\n观测计数：\n- 传染病：$x_1 = 124$\n- 心血管疾病：$x_2 = 89$\n- 呼吸系统疾病：$x_3 = 57$\n- 肿瘤：$x_4 = 38$\n- 其他诊断：$x_5 = 12$\n\n我们计算估计概率 $\\hat{p}_k = x_k/n$ 并四舍五入到四位有效数字：\n- $\\hat{p}_1 = \\frac{124}{320} = 0.3875$。\n- $\\hat{p}_2 = \\frac{89}{320} = 0.278125 \\approx 0.2781$。\n- $\\hat{p}_3 = \\frac{57}{320} = 0.178125 \\approx 0.1781$。\n- $\\hat{p}_4 = \\frac{38}{320} = 0.11875 \\approx 0.1188$。\n- $\\hat{p}_5 = \\frac{12}{320} = 0.0375$。为表示为四位有效数字，我们可写为 $0.03750$。\n\n最终的估计概率向量为 $(\\hat{p}_1, \\hat{p}_2, \\hat{p}_3, \\hat{p}_4, \\hat{p}_5)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3875  0.2781  0.1781  0.1188  0.03750 \\end{pmatrix}}\n$$", "id": "4931638"}]}