{"hands_on_practices": [{"introduction": "在生物统计学中，生成模拟数据对于测试统计方法的性能和理解复杂模型至关重要。反变换采样法是一种从任何分布中模拟随机变量的基本技术，前提是我们知道其累积分布函数（CDF）。本练习将指导您为指数分布推导此方法，从而加深对概率密度函数（PDF）与其所描述的数据之间直接而实际的联系的理解。[@problem_id:4942189]", "problem": "在一个具有恒定风险率的事件发生时间数据的生物统计学模拟研究中，假设一个齐次泊松过程中直到下一个事件的等待时间由一个率参数为 $\\lambda0$ 的指数分布建模。您希望通过从单位区间上的均匀分布随机变量进行单次抽样，来实现逆变换采样，以生成合成的生存时间。\n\n从以下基本定义出发：(i) 率为 $\\lambda$ 的指数分布的概率密度函数 (PDF) $f(x)$ 定义在 $x\\geq 0$ 上，是非负的，并且积分为 $1$；(ii) 一个连续随机变量的累积分布函数 (CDF) $F(x)$ 定义为 $F(x)=\\int_{-\\infty}^{x} f(t)\\,dt$。请推导指数分布 Exponential($\\lambda$) 的累积分布函数 $F(x)$ 的显式形式。然后，对 $x$ 求解方程 $u=F(x)$，以获得从均匀分布 $U \\sim \\mathrm{Unif}(0,1)$ 的样本生成指数随机变量 $X$ 所需的变换公式。", "solution": "本问题要求推导使用逆变换方法，从一个均匀随机变量 $U$ 生成一个服从率参数为 $\\lambda$ 的指数分布的随机变量 $X$ 的公式，并验证所得到的变量 $X$ 确实服从指定的指数分布。\n\n首先，我们验证问题陈述的有效性。\n该问题在科学上和数学上是合理的，因为它基于概率论的基本原理，特别是指数分布、概率密度函数(PDF)、累积分布函数(CDF)和逆变换采样方法。这是一个计算统计学和生物统计学中的标准、适定问题。该问题是客观、完整、无矛盾或歧义的。结论是该问题有效。\n\n我们按照要求开始推导。\n\n第一个原理是率参数为 $\\lambda  0$ 的指数分布的概率密度函数（PDF）的定义。代表等待时间的随机变量必须是非负的。PDF $f(x)$ 由下式给出：\n$$\nf(x) = \\begin{cases} \\lambda \\exp(-\\lambda x)   \\text{if } x \\geq 0 \\\\ 0   \\text{if } x  0 \\end{cases}\n$$\n对于 $\\lambda  0$，此函数是非负的，且积分为 $1$，因为 $\\int_{0}^{\\infty} \\lambda \\exp(-\\lambda x) \\,dx = [-\\exp(-\\lambda x)]_{0}^{\\infty} = 0 - (-1) = 1$。\n\n接下来，我们推导累积分布函数 (CDF) $F(x)$，其定义为 $F(x) = \\int_{-\\infty}^{x} f(t)\\,dt$。\n对于任何 $x  0$，PDF $f(t)$ 为 $0$，因此 $F(x) = \\int_{-\\infty}^{x} 0 \\,dt = 0$。\n对于任何 $x \\geq 0$，CDF 计算如下：\n$$\nF(x) = \\int_{-\\infty}^{x} f(t)\\,dt = \\int_{-\\infty}^{0} 0\\,dt + \\int_{0}^{x} \\lambda \\exp(-\\lambda t)\\,dt\n$$\n$$\nF(x) = 0 + \\lambda \\int_{0}^{x} \\exp(-\\lambda t)\\,dt\n$$\n$$\nF(x) = \\lambda \\left[ -\\frac{1}{\\lambda} \\exp(-\\lambda t) \\right]_{0}^{x} = \\left[ -\\exp(-\\lambda t) \\right]_{0}^{x}\n$$\n$$\nF(x) = (-\\exp(-\\lambda x)) - (-\\exp(-\\lambda \\cdot 0)) = -\\exp(-\\lambda x) - (-1) = 1 - \\exp(-\\lambda x)\n$$\n因此，指数分布 Exponential($\\lambda$) 的 CDF 为：\n$$\nF(x) = \\begin{cases} 1 - \\exp(-\\lambda x)   \\text{if } x \\geq 0 \\\\ 0   \\text{if } x  0 \\end{cases}\n$$\n\n逆变换方法包括将 CDF 等于从区间 $(0, 1)$ 上的均匀分布中抽取的值 $u$，即 $u = F(x)$，然后对 $x$ 求解。这就得到了逆 CDF，$x = F^{-1}(u)$。给定 $U \\sim \\mathrm{Unif}(0,1)$，并且 $X = F^{-1}(U)$。由于 $x \\geq 0$，一个有效的 $x$ 解会将 $u \\in (0, 1)$ 映射到 $x \\in [0, \\infty)$。\n我们对给定的 $u \\in (0, 1)$ 求解关于 $x$ 的方程：\n$$\nu = 1 - \\exp(-\\lambda x)\n$$\n重新整理各项以解出 $x$：\n$$\n\\exp(-\\lambda x) = 1 - u\n$$\n对两边取自然对数：\n$$\n\\ln(\\exp(-\\lambda x)) = \\ln(1 - u)\n$$\n$$\n-\\lambda x = \\ln(1 - u)\n$$\n$$\nx = -\\frac{1}{\\lambda} \\ln(1 - u)\n$$\n这就是逆 CDF $F^{-1}(u)$ 的表达式。通过将均匀随机变量 $U$ 代替 $u$ 来生成随机变量 $X$：\n$$\nX = F^{-1}(U) = -\\frac{1}{\\lambda} \\ln(1 - U)\n$$\n这就是所要求的最终表达式。\n\n最后，问题要求严格验证 $X = -\\frac{1}{\\lambda} \\ln(1 - U)$ 服从指数分布 Exponential($\\lambda$)。我们将通过求出 $X$ 的 CDF（称之为 $G_X(x)$）并证明其与上面推导出的 $F(x)$ 相同来做到这一点。$X$ 的 CDF 定义为 $G_X(x) = P(X \\leq x)$。\n\n首先，我们确定 $X$ 的支撑集。由于 $U \\sim \\mathrm{Unif}(0,1)$，$U$ 的取值范围是区间 $(0, 1)$。那么 $1-U$ 的取值范围也是 $(0, 1)$。自然对数 $\\ln(1-U)$ 的取值范围是 $(-\\infty, 0)$。因为 $\\lambda  0$，所以 $-\\frac{1}{\\lambda}$ 是负数。因此，$X = -\\frac{1}{\\lambda} \\ln(1 - U)$ 的取值范围是 $(0, \\infty)$。$X$ 的支撑集是 $x  0$。这意味着对于任何 $x \\leq 0$，$G_X(x) = P(X \\leq x) = 0$。\n\n现在，对于 $x  0$，我们计算 $G_X(x)$：\n$$\nG_X(x) = P(X \\leq x) = P\\left(-\\frac{1}{\\lambda} \\ln(1 - U) \\leq x\\right)\n$$\n我们处理不等式以分离出 $U$：\n$$\n\\ln(1 - U) \\geq -\\lambda x\n$$\n（不等式反向，因为我们乘以了 $-\\lambda$，这是一个负数）。\n我们对两边取指数。由于指数函数 $y \\mapsto \\exp(y)$ 是单调递增的，不等式方向保持不变：\n$$\n\\exp(\\ln(1 - U)) \\geq \\exp(-\\lambda x)\n$$\n$$\n1 - U \\geq \\exp(-\\lambda x)\n$$\n$$\n-U \\geq \\exp(-\\lambda x) - 1\n$$\n$$\nU \\leq 1 - \\exp(-\\lambda x)\n$$\n（不等式再次反向，因为我们乘以了 $-1$）。\n\n所以我们有：\n$$\nG_X(x) = P(U \\leq 1 - \\exp(-\\lambda x))\n$$\n由于 $U \\sim \\mathrm{Unif}(0,1)$，其 CDF 为 $F_U(v) = P(U \\leq v) = v$（对于 $v \\in [0, 1]$）。对于 $x  0$，项 $1 - \\exp(-\\lambda x)$ 在区间 $(0, 1)$ 内。令 $v = 1 - \\exp(-\\lambda x)$。那么，$G_X(x) = F_U(1 - \\exp(-\\lambda x)) = 1 - \\exp(-\\lambda x)$。\n\n综合各种情况，$X$ 的 CDF 是：\n$$\nG_X(x) = \\begin{cases} 1 - \\exp(-\\lambda x)   \\text{if } x \\geq 0 \\\\ 0   \\text{if } x  0 \\end{cases}\n$$\n这与我们之前推导的指数分布 Exponential($\\lambda$) 的 CDF $F(x)$ 完全相同。通过对 $x \\geq 0$ 的 $G_X(x)$ 关于 $x$ 求导，我们将得到 PDF $f(x) = \\lambda \\exp(-\\lambda x)$，这证实了 $X$ 确实是一个率参数为 $\\lambda$ 的指数分布随机变量。验证完成。\n\n问题要求给出 $X$ 关于 $U$ 和 $\\lambda$ 的最终表达式。", "answer": "$$\n\\boxed{-\\frac{1}{\\lambda}\\ln(1 - U)}\n$$", "id": "4942189"}, {"introduction": "在生物统计建模中，我们常常需要对变量进行变换，以更好地满足模型的假设或提高结果的可解释性，例如将一个在 $(0,1)$ 区间内的概率转换到整个实数轴上。本练习将演示强大的变量替换公式，该公式使我们能够为一个变换后的随机变量推导出其确切的概率密度函数。掌握这项技术对于开发和理解复杂的统计模型至关重要。[@problem_id:4942226]", "problem": "在一个个体层面风险的生物统计模型中，假设潜在风险概率 $X \\in (0,1)$ 服从参数为 $(\\alpha,\\beta)$ 的贝塔分布（$\\mathrm{Beta}(\\alpha,\\beta)$），其概率密度函数（PDF）为\n$$\nf_{X}(x) \\;=\\; \\frac{1}{B(\\alpha,\\beta)}\\, x^{\\alpha - 1}\\,(1-x)^{\\beta - 1}, \\quad x \\in (0,1),\n$$\n其中 $\\alpha0$，$\\beta0$，且 $B(\\alpha,\\beta)$ 表示贝塔函数。定义逻辑斯谛（logit）变换 $Z = \\log\\!\\left(\\frac{X}{1-X}\\right)$，它将区间 $(0,1)$ 映射到 $\\mathbb{R}$。\n\n从第一性原理出发——即概率密度函数的定义以及可微、单调的变量变换的定义——推导：\n- 从 $z$ 到 $x$ 的变换的雅可比行列式的绝对值，以及\n- $Z$ 的导出概率密度函数。\n\n您的推导必须清楚地确定每个变量的支撑集，并且只能使用基本定义和公认事实，不得引用任何预先给出的变换公式。将您的最终答案表示为一个数对，包含雅可比行列式（作为 $z$ 的函数）和导出概率密度函数 $f_{Z}(z)$，两者都需用精确的符号形式表示。不需要数值近似。", "solution": "该问题陈述经评估有效。它具有科学依据，问题定义明确，客观且自洽。它提出了概率论中的一个标准问题——推导变换后随机变量的概率密度函数（PDF）——使用了贝塔分布和logit变换等在生物统计学中至关重要的既定概念。不存在不一致、模糊不清或事实错误之处。因此，我们可以开始推导。\n\n此推导的核心原理是概率密度函数的变量变换定理。设 $X$ 是一个连续随机变量，其 PDF 为 $f_{X}(x)$，定义在支撑集 $S_{X}$ 上。设 $Z = g(X)$ 是一个新的随机变量，其中函数 $g$ 在 $S_{X}$ 上是连续可微且严格单调的。这保证了存在唯一的反函数 $X = h(Z) = g^{-1}(Z)$。$Z$ 的 PDF，记为 $f_{Z}(z)$，由以下公式给出：\n$$\nf_{Z}(z) = f_{X}(h(z)) \\left| \\frac{dh}{dz}(z) \\right|\n$$\n项 $\\left| \\frac{dh}{dz} \\right|$ 是反变换的雅可比行列式的绝对值。对于一维变换，这仅仅是反函数导数的绝对值。$Z$ 的支撑集，记为 $S_{Z}$，是 $S_{X}$ 在变换 $g$下的像。\n\n首先，我们必须求出反变换 $x = h(z)$。给定的变换是 $z = g(x) = \\log\\left(\\frac{x}{1-x}\\right)$。\n为了求反函数，我们解出 $x$：\n$$\nz = \\ln\\left(\\frac{x}{1-x}\\right)\n$$\n以 $e$为底对两边取指数：\n$$\n\\exp(z) = \\frac{x}{1-x}\n$$\n现在，我们整理方程以分离出 $x$：\n$$\n\\exp(z)(1-x) = x\n$$\n$$\n\\exp(z) - x\\exp(z) = x\n$$\n$$\n\\exp(z) = x + x\\exp(z)\n$$\n$$\n\\exp(z) = x(1 + \\exp(z))\n$$\n$$\nx = \\frac{\\exp(z)}{1+\\exp(z)}\n$$\n这就是反函数 $x = h(z)$。这个函数通常被称为逻辑斯谛S型函数。\n\n接下来，我们确定新变量 $Z$ 的支撑集。$X$ 的支撑集是开区间 $(0,1)$。我们考察 $z = \\log\\left(\\frac{x}{1-x}\\right)$ 在该区间边界处的行为。\n当 $x \\to 0^{+}$ 时，比率 $\\frac{x}{1-x} \\to 0^{+}$，因此 $z = \\ln\\left(\\frac{x}{1-x}\\right) \\to -\\infty$。\n当 $x \\to 1^{-}$ 时，分母 $1-x \\to 0^{+}$，比率 $\\frac{x}{1-x} \\to +\\infty$，因此 $z = \\ln\\left(\\frac{x}{1-x}\\right) \\to +\\infty$。\n因此，$Z$ 的支撑集是整个实数轴，$S_Z = (-\\infty, \\infty)$ 或 $\\mathbb{R}$，与问题陈述一致。\n\n现在，我们推导第一个要求的量：从 $z$ 到 $x$ 的变换的雅可比行列式的绝对值。即 $\\left|\\frac{dx}{dz}\\right|$。\n对 $x(z) = \\frac{\\exp(z)}{1+\\exp(z)}$ 使用商法则求导：\n设 $u = \\exp(z)$ 且 $v = 1+\\exp(z)$。则 $u' = \\exp(z)$ 且 $v' = \\exp(z)$。\n$$\n\\frac{dx}{dz} = \\frac{u'v - uv'}{v^2} = \\frac{\\exp(z)(1+\\exp(z)) - \\exp(z)(\\exp(z))}{(1+\\exp(z))^2}\n$$\n$$\n\\frac{dx}{dz} = \\frac{\\exp(z) + \\exp(2z) - \\exp(2z)}{(1+\\exp(z))^2} = \\frac{\\exp(z)}{(1+\\exp(z))^2}\n$$\n由于对于所有 $z \\in \\mathbb{R}$ 都有 $\\exp(z)  0$，导数 $\\frac{dx}{dz}$ 始终为正。这证实了该变换是严格单调（递增）的。因此，雅可比行列式的绝对值等于其导数本身：\n$$\n\\left|\\frac{dx}{dz}\\right| = \\frac{\\exp(z)}{(1+\\exp(z))^2}\n$$\n\n最后，我们推导 $Z$ 的导出 PDF $f_Z(z)$。我们从 $X$ 的 PDF 开始：\n$$\nf_{X}(x) = \\frac{1}{B(\\alpha,\\beta)}\\, x^{\\alpha - 1}\\,(1-x)^{\\beta - 1}\n$$\n我们将 $x$ 替换为 $h(z) = \\frac{\\exp(z)}{1+\\exp(z)}$。我们还需要用 $z$ 表示 $1-x$：\n$$\n1-x = 1 - \\frac{\\exp(z)}{1+\\exp(z)} = \\frac{1+\\exp(z)-\\exp(z)}{1+\\exp(z)} = \\frac{1}{1+\\exp(z)}\n$$\n现在，将这些代入 $f_{X}(x)$：\n$$\nf_{X}(h(z)) = \\frac{1}{B(\\alpha,\\beta)} \\left(\\frac{\\exp(z)}{1+\\exp(z)}\\right)^{\\alpha-1} \\left(\\frac{1}{1+\\exp(z)}\\right)^{\\beta-1}\n$$\n合并分母中的项：\n$$\nf_{X}(h(z)) = \\frac{1}{B(\\alpha,\\beta)} \\frac{(\\exp(z))^{\\alpha-1}}{(1+\\exp(z))^{\\alpha-1}} \\frac{1}{(1+\\exp(z))^{\\beta-1}} = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1))}{(1+\\exp(z))^{\\alpha+\\beta-2}}\n$$\n现在，我们应用变量变换公式：\n$$\nf_Z(z) = f_X(h(z)) \\left|\\frac{dx}{dz}\\right|\n$$\n$$\nf_Z(z) = \\left( \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1))}{(1+\\exp(z))^{\\alpha+\\beta-2}} \\right) \\left( \\frac{\\exp(z)}{(1+\\exp(z))^2} \\right)\n$$\n通过将指数相加来合并分子和分母：\n$$\nf_Z(z) = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1)) \\exp(z)}{(1+\\exp(z))^{\\alpha+\\beta-2} (1+\\exp(z))^2}\n$$\n$$\nf_Z(z) = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(z(\\alpha-1)+z)}{(1+\\exp(z))^{(\\alpha+\\beta-2)+2}}\n$$\n$$\nf_Z(z) = \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(\\alpha z)}{(1+\\exp(z))^{\\alpha+\\beta}}\n$$\n这就是随机变量 $Z$ 的 PDF，它对所有 $z \\in \\mathbb{R}$ 都有定义。该分布被称为广义逻辑斯谛分布或对数-贝塔分布。\n\n两个所求量分别是雅可比行列式的绝对值 $\\frac{\\exp(z)}{(1+\\exp(z))^2}$ 和 PDF $f_Z(z)$ $\\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(\\alpha z)}{(1+\\exp(z))^{\\alpha+\\beta}}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\exp(z)}{(1+\\exp(z))^{2}}  \\frac{1}{B(\\alpha,\\beta)} \\frac{\\exp(\\alpha z)}{(1+\\exp(z))^{\\alpha+\\beta}} \\end{pmatrix}}\n$$", "id": "4942226"}, {"introduction": "生物统计学的一个主要目标是从观测数据中推断模型参数，而概率密度函数正是实现这一目标的桥梁。本练习将介绍最大似然估计（MLE）的概念，其中PDF被用来构建一个似然函数，该函数量化了在给定数据下不同参数值的合理性。通过找到使该似然函数最大化的参数，我们便能为模型获得符合原理的估计值。[@problem_id:4942238]", "problem": "一个生物统计学团队对一项标准化检测中每个受试者发生固定数量分子结合事件所需的总观测时间进行建模。对于每个受试者 $i \\in \\{1,\\dots,n\\}$，直到 $k$ 个事件发生所需的总等待时间 $X_i$ 假定为独立同分布 (i.i.d.)，服从 Gamma 分布，其形状参数 $k0$ 已知，尺度参数 $\\theta0$ 未知，记为 $X_i \\sim \\mathrm{Gamma}(k,\\theta)$。$X_i$ 的概率密度函数 (PDF) 为\n$$\nf(x_i; k,\\theta) = \\frac{x_i^{k-1} \\exp(-x_i/\\theta)}{\\Gamma(k)\\,\\theta^{k}}, \\quad x_i0,\n$$\n其中 $\\Gamma(k)$ 是 Gamma 函数。你观测到一组实现值 $x_1,\\dots,x_n$。\n\n从 i.i.d. 样本的似然函数定义、分数函数 $U(\\theta)=\\frac{\\partial}{\\partial \\theta}\\ell(\\theta)$（其中 $\\ell(\\theta)$ 是对数似然函数）的定义以及费雪信息 (FI) $I(\\theta)=-\\mathbb{E}\\!\\left[\\frac{\\partial^2}{\\partial \\theta^2}\\ell(\\theta)\\right]$ 的定义出发，推导分数函数 $U(\\theta)$ 和费雪信息 $I(\\theta)$ 的精确形式，并求解 $\\theta$ 的最大似然估计 (MLE)，记为 $\\hat{\\theta}$。将你的最终答案表示为一个单行向量，其元素分别为 $U(\\theta)$、$I(\\theta)$ 和 $\\hat{\\theta}$，并用 $n$、$k$ 和观测数据 $\\{x_i\\}_{i=1}^n$ 表示。请提供精确表达式，无需四舍五入。", "solution": "用户提供了一个生物统计学领域的问题，具体聚焦于 Gamma 分布的参数估计。我将首先验证问题陈述，如果问题有效，则提供完整的推导。\n\n### 第 1 步：提取已知条件\n-   数据由 $n$ 个独立同分布 (i.i.d.) 的随机变量 $X_i$ 组成，其中 $i \\in \\{1, \\dots, n\\}$。\n-   每个 $X_i$ 代表一个受试者等待 $k$ 个事件发生的总时间。\n-   每个 $X_i$ 的分布是 Gamma 分布，记为 $X_i \\sim \\mathrm{Gamma}(k,\\theta)$。\n-   形状参数 $k0$ 已知。\n-   尺度参数 $\\theta0$ 未知。\n-   概率密度函数 (PDF) 给出为 $f(x_i; k,\\theta) = \\frac{x_i^{k-1} \\exp(-x_i/\\theta)}{\\Gamma(k)\\,\\theta^{k}}$，其中 $x_i0$。\n-   观测数据是一组实现值 $\\{x_1, \\dots, x_n\\}$。\n-   对数似然函数记为 $\\ell(\\theta)$。\n-   分数函数定义为 $U(\\theta)=\\frac{\\partial}{\\partial \\theta}\\ell(\\theta)$。\n-   费雪信息 (FI) 定义为 $I(\\theta)=-\\mathbb{E}\\!\\left[\\frac{\\partial^2}{\\partial \\theta^2}\\ell(\\theta)\\right]$。\n-   $\\theta$ 的最大似然估计 (MLE) 记为 $\\hat{\\theta}$。\n-   任务是推导 $U(\\theta)$、$I(\\theta)$ 和 $\\hat{\\theta}$ 的精确形式。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。这是最大似然估计理论中的一个标准练习，该理论是经典统计学的基石，并在生物统计学中得到广泛应用。Gamma 分布是用于等待时间的常用且合适的模型。分数函数和费雪信息的定义是标准的。该问题是自洽的、适定的，并且没有歧义或矛盾。它既不简单也不过于复杂，代表了该领域的一个标准推导。因此，该问题被认为是 **有效的**。\n\n### 第 3 步：结论与行动\n问题是有效的。我现在将进行求解。\n\n###\n解决方案包括三个主要部分：推导分数函数 $U(\\theta)$，找到最大似然估计量 $\\hat{\\theta}$，以及计算费雪信息 $I(\\theta)$。\n\n#### 似然函数和对数似然函数\n鉴于观测值 $x_1, \\dots, x_n$ 是 i.i.d. 随机变量 $X_1, \\dots, X_n$ 的实现，似然函数 $L(\\theta)$ 是各个概率密度函数的乘积：\n$$\nL(\\theta) = \\prod_{i=1}^{n} f(x_i; k, \\theta) = \\prod_{i=1}^{n} \\frac{x_i^{k-1} \\exp(-x_i/\\theta)}{\\Gamma(k)\\,\\theta^{k}}\n$$\n我们可以将依赖于 $\\theta$ 的项与不依赖于 $\\theta$ 的项分开：\n$$\nL(\\theta) = \\left( \\prod_{i=1}^{n} \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) \\left( \\frac{1}{\\theta^k} \\right)^n \\exp\\left(-\\sum_{i=1}^{n} \\frac{x_i}{\\theta}\\right) = \\left( \\prod_{i=1}^{n} \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) \\frac{1}{\\theta^{nk}} \\exp\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\\right)\n$$\n对数似然函数 $\\ell(\\theta)$ 是似然函数的自然对数：\n$$\n\\ell(\\theta) = \\ln(L(\\theta)) = \\ln\\left[ \\left( \\prod_{i=1}^{n} \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) \\frac{1}{\\theta^{nk}} \\exp\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\\right) \\right]\n$$\n利用对数的性质，我们可以展开这个表达式：\n$$\n\\ell(\\theta) = \\sum_{i=1}^{n} \\ln\\left( \\frac{x_i^{k-1}}{\\Gamma(k)} \\right) + \\ln(\\theta^{-nk}) + \\ln\\left( \\exp\\left(-\\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\\right) \\right)\n$$\n$$\n\\ell(\\theta) = \\sum_{i=1}^{n} ((k-1)\\ln(x_i) - \\ln(\\Gamma(k))) - nk\\ln(\\theta) - \\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\n$$\n第一项是关于 $\\theta$ 的常数，所以我们可以将 $\\ell(\\theta)$ 写成（相差一个加性常数）：\n$$\n\\ell(\\theta) = \\mathrm{const} - nk\\ln(\\theta) - \\frac{1}{\\theta}\\sum_{i=1}^{n} x_i\n$$\n\n#### 分数函数 $U(\\theta)$ 的推导\n分数函数 $U(\\theta)$ 是对数似然函数关于参数 $\\theta$ 的一阶导数。\n$$\nU(\\theta) = \\frac{\\partial \\ell(\\theta)}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\mathrm{const} - nk\\ln(\\theta) - \\left(\\sum_{i=1}^{n} x_i\\right)\\theta^{-1} \\right)\n$$\n$$\nU(\\theta) = 0 - nk\\left(\\frac{1}{\\theta}\\right) - \\left(\\sum_{i=1}^{n} x_i\\right)(-1)\\theta^{-2}\n$$\n$$\nU(\\theta) = -\\frac{nk}{\\theta} + \\frac{\\sum_{i=1}^{n} x_i}{\\theta^2}\n$$\n这可以写成一个共同的分母：\n$$\nU(\\theta) = \\frac{\\sum_{i=1}^{n} x_i - nk\\theta}{\\theta^2}\n$$\n这是第一个要求的表达式。\n\n#### 最大似然估计量 $\\hat{\\theta}$ 的推导\n最大似然估计量 (MLE) $\\hat{\\theta}$ 是使似然函数最大化的 $\\theta$ 值，这等同于使对数似然函数最大化。我们通过将分数函数（一阶导数）设为零并求解 $\\theta$ 来找到它。\n$$\nU(\\hat{\\theta}) = 0 \\implies \\frac{\\sum_{i=1}^{n} x_i - nk\\hat{\\theta}}{\\hat{\\theta}^2} = 0\n$$\n由于 $\\theta  0$，我们知道 $\\hat{\\theta}^2 \\neq 0$。因此，分子必须为零：\n$$\n\\sum_{i=1}^{n} x_i - nk\\hat{\\theta} = 0\n$$\n求解 $\\hat{\\theta}$：\n$$\nnk\\hat{\\theta} = \\sum_{i=1}^{n} x_i \\implies \\hat{\\theta} = \\frac{\\sum_{i=1}^{n} x_i}{nk}\n$$\n为了确认这是一个最大值，我们检查 $\\ell(\\theta)$ 的二阶导数的符号。\n$$\n\\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2} = \\frac{\\partial U(\\theta)}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( -nk\\theta^{-1} + \\left(\\sum_{i=1}^{n} x_i\\right)\\theta^{-2} \\right) = -nk(-1)\\theta^{-2} + \\left(\\sum_{i=1}^{n} x_i\\right)(-2)\\theta^{-3}\n$$\n$$\n\\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2} = \\frac{nk}{\\theta^2} - \\frac{2\\sum_{i=1}^{n} x_i}{\\theta^3}\n$$\n在 $\\theta=\\hat{\\theta}$ 处求值，并代入 $\\sum_{i=1}^{n} x_i = nk\\hat{\\theta}$：\n$$\n\\left. \\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2} \\right|_{\\theta=\\hat{\\theta}} = \\frac{nk}{\\hat{\\theta}^2} - \\frac{2(nk\\hat{\\theta})}{\\hat{\\theta}^3} = \\frac{nk}{\\hat{\\theta}^2} - \\frac{2nk}{\\hat{\\theta}^2} = -\\frac{nk}{\\hat{\\theta}^2}\n$$\n由于 $n  0$、$k  0$ 且 $\\hat{\\theta}^2  0$，二阶导数为负。这证实了 $\\hat{\\theta}$ 是一个局部最大值。由于它是参数空间中的唯一临界点，因此它也是全局最大值。\nMLE 是 $\\hat{\\theta} = \\frac{\\sum_{i=1}^{n} x_i}{nk}$。\n\n#### 费雪信息 $I(\\theta)$ 的推导\n费雪信息 $I(\\theta)$ 定义为对数似然函数二阶导数期望值的负数。\n$$\nI(\\theta) = -\\mathbb{E}\\left[\\frac{\\partial^2 \\ell(\\theta)}{\\partial \\theta^2}\\right] = -\\mathbb{E}\\left[\\frac{nk}{\\theta^2} - \\frac{2\\sum_{i=1}^{n} X_i}{\\theta^3}\\right]\n$$\n利用期望的线性性：\n$$\nI(\\theta) = -\\left( \\mathbb{E}\\left[\\frac{nk}{\\theta^2}\\right] - \\mathbb{E}\\left[\\frac{2\\sum_{i=1}^{n} X_i}{\\theta^3}\\right] \\right) = -\\frac{nk}{\\theta^2} + \\frac{2}{\\theta^3}\\mathbb{E}\\left[\\sum_{i=1}^{n} X_i\\right]\n$$\n具有给定 PDF 的 $\\mathrm{Gamma}(k,\\theta)$ 分布的均值是 $\\mathbb{E}[X_i] = k\\theta$。由于 $X_i$ 是同分布的：\n$$\n\\mathbb{E}\\left[\\sum_{i=1}^{n} X_i\\right] = \\sum_{i=1}^{n} \\mathbb{E}[X_i] = \\sum_{i=1}^{n} k\\theta = nk\\theta\n$$\n将此结果代入 $I(\\theta)$ 的表达式中：\n$$\nI(\\theta) = -\\frac{nk}{\\theta^2} + \\frac{2}{\\theta^3}(nk\\theta) = -\\frac{nk}{\\theta^2} + \\frac{2nk}{\\theta^2} = \\frac{nk}{\\theta^2}\n$$\n这就是参数 $\\theta$ 的费雪信息。\n\n推导出的三个量是：\n1.  分数函数：$U(\\theta) = \\frac{\\sum_{i=1}^{n} x_i - nk\\theta}{\\theta^2}$\n2.  费雪信息：$I(\\theta) = \\frac{nk}{\\theta^2}$\n3.  最大似然估计量：$\\hat{\\theta} = \\frac{\\sum_{i=1}^{n} x_i}{nk}$\n这些量将表示为一个单行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sum_{i=1}^n x_i - nk\\theta}{\\theta^2}  \\frac{nk}{\\theta^2}  \\frac{\\sum_{i=1}^n x_i}{nk} \\end{pmatrix}}\n$$", "id": "4942238"}]}