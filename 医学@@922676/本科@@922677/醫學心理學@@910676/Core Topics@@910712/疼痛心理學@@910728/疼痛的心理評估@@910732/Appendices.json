{"hands_on_practices": [{"introduction": "在解释任何心理评估分数时，首要步骤是承认其固有的不确定性。本练习将引导您应用经典测量理论（CTT）的基本原理，通过计算测量的标准误（SEM）来量化疼痛评分的测量误差。您将为一个观察到的疼痛分数构建一个置信区间，从而更准确地理解患者的真实疼痛水平可能所在的范围，这是负责任地解读分数的基石。[@problem_id:4738170]", "problem": "一家诊所常规使用数字评分量表 (NRS) 来评估患者的疼痛。该量表定义为一个从 $0$ 到 $10$ 的标尺，患者用一个数字来报告他们当前的疼痛强度。根据经典测试理论 (CTT)，观测分数 $X$ 被概念化为真实分数 $T$ 和误差分数 $E$ 的和，而信度系数 $r$ 则被定义为真实分数方差在观测分数方差中所占的比例。一位患有慢性下背痛的患者报告其 NRS 分数为 $x=6.8$。从该诊所对此工具的验证样本中，我们得知其重测信度系数为 $r=0.86$，观测分数的标准差为 $s=2.1$。\n\n假设 CTT 适用，且测量误差是独立的、中心在零，并且近似服从正态分布，请从第一性原理推导测量标准误 (SEM)，然后使用适当的标准正态临界值，围绕观测分数计算患者潜在真实疼痛分数的双侧 $95\\%$ 置信区间 (CI)。将最终的区间界限表示为四舍五入到四位有效数字的数值。最后，请针对 NRS 上为 $7$ 的严重程度分类阈值，陈述一个由计算出的置信区间得出的临床相关推论。最终的数值答案必须只包含置信区间的界限。", "solution": "该问题是有效的，因为它在科学上基于经典测试理论 (CTT)，提法得当，数据充分且一致，并且表述客观。因此，我们可以着手求解。\n\n该问题要求完成三项任务：推导测量标准误 (SEM)，计算患者真实疼痛分数的 $95\\%$ 置信区间 (CI)，以及陈述该区间的临床意义。\n\n首先，我们从 CTT 的第一性原理推导 SEM 的公式。CTT 的基本方程将观测分数 $X$ 与真实分数 $T$ 和误差分数 $E$ 联系起来：\n$$X = T + E$$\nCTT 的一个核心假设是真实分数与误差分数不相关，即它们的协方差为零。在此假设下，观测分数的方差 $\\sigma_X^2$ 可以表示为真实分数的方差 $\\sigma_T^2$ 与误差分数的方差 $\\sigma_E^2$ 之和：\n$$\\sigma_X^2 = \\sigma_T^2 + \\sigma_E^2$$\n信度系数，记为 $r$，被定义为可归因于真实分数方差的部分在总观测分数方差中所占的比例：\n$$r = \\frac{\\sigma_T^2}{\\sigma_X^2}$$\n根据这个定义，我们可以将真实分数方差表示为 $\\sigma_T^2 = r \\cdot \\sigma_X^2$。将其代入方差分解方程，得到：\n$$\\sigma_X^2 = (r \\cdot \\sigma_X^2) + \\sigma_E^2$$\n我们现在可以求解误差方差 $\\sigma_E^2$：\n$$\\sigma_E^2 = \\sigma_X^2 - r \\cdot \\sigma_X^2$$\n$$\\sigma_E^2 = \\sigma_X^2(1 - r)$$\n根据定义，测量标准误 (SEM) 是误差分数 $\\sigma_E$ 的标准差。对误差方差取平方根，即可得到 SEM 的公式：\n$$\\text{SEM} = \\sigma_E = \\sqrt{\\sigma_X^2(1 - r)} = \\sigma_X \\sqrt{1 - r}$$\n这就完成了从第一性原理的推导。在实践中，我们使用样本统计量来估计这些总体参数。题目提供了样本观测分数的标准差 $s=2.1$ 和样本信度系数 $r=0.86$。我们用这些值来计算 SEM 的估计值。\n$$\\text{SEM} = s \\sqrt{1 - r} = 2.1 \\sqrt{1 - 0.86} = 2.1 \\sqrt{0.14}$$\n$$\\text{SEM} \\approx 2.1 \\times 0.3741657 = 0.785748$$\n\n第二，我们计算患者潜在真实疼痛分数 $T$ 的双侧 $95\\%$ 置信区间。患者的观测分数为 $x=6.8$。置信区间是围绕这个观测分数构建的。置信区间的公式为：\n$$\\text{CI} = x \\pm z \\cdot \\text{SEM}$$\n对于双侧 $95\\%$ 置信区间，来自标准正态分布的临界值 $z$ 是在每个尾部留下 $2.5\\%$ 面积的值，对应于 $0.975$ 的累积概率。这个值是 $z = 1.96$。\n使用 $x$、$z$ 和计算出的 SEM 的值：\n$$\\text{CI} = 6.8 \\pm 1.96 \\cdot (2.1 \\sqrt{0.14})$$\n$$\\text{CI} = 6.8 \\pm 1.96 \\cdot 0.785748$$\n$$\\text{CI} = 6.8 \\pm 1.539866$$\n区间的下界是：\n$$L = 6.8 - 1.539866 = 5.260134$$\n区间的上界是：\n$$U = 6.8 + 1.539866 = 8.339866$$\n题目要求最终的区间界限四舍五入到四位有效数字。\n下界四舍五入后为：$5.260$\n上界四舍五入后为：$8.340$\n因此，患者真实分数的 $95\\%$ 置信区间为 $[5.260, 8.340]$。\n\n第三，我们针对数字评分量表 (NRS) 上为 $7$ 的严重程度阈值，陈述该区间的一个临床相关推论。患者的观测分数为 $x=6.8$，这低于通常用于将疼痛分类为“剧烈”的 $7$ 的阈值。然而，患者真实分数的 $95\\%$ 置信区间 $[5.260, 8.340]$ 包含并显著超出了这个阈值。这意味着，虽然单个观测分数表明患者的疼痛不剧烈，但由于测量误差的存在，我们无法对这一评估充满信心。正如置信区间所示，存在一种合理的可能性，即患者的真实疼痛水平实际上是 $7$ 或更高，属于剧烈疼痛类别。临床决策，例如决定是否适合使用强效镇痛药，不应仅仅基于 $6.8$ 这个点估计值，而应考虑到置信区间所代表的不确定性。忽视测量标准误可能导致对患者痛苦的低估，并可能导致对其疼痛的治疗不足。", "answer": "$$\\boxed{\\begin{pmatrix} 5.260  8.340 \\end{pmatrix}}$$", "id": "4738170"}, {"introduction": "评估治疗效果不仅仅是比較治疗前后的分数。本练习将带您超越简单的减法，进入临床意义的层面。您将使用简明疼痛量表（BPI）的数据，计算疼痛对日常功能干扰的变化，并应用“最小重要差异”（MID）的概念来判断这种变化是否对患者具有实际意义。[@problem_id:4738112]", "problem": "一位临床心理学研究者正在使用简明疼痛量表（Brief Pain Inventory, BPI）评估一个为期四周的多学科疼痛管理项目对疼痛相关干扰的影响。简明疼痛量表（BPI）的干扰领域包含七个项目，采用 $0$-$10$ 的数字评分法进行评分，分值越高表示对日常功能的干扰越大。在此背景下，最小重要差异（Minimal Important Difference, MID）被定义为患者认为重要的平均干扰分数的最小变化，先验地设定为在 $0$-$10$ 量表上的 $1.0$ 分。\n\n一名患有慢性下背痛的参与者在基线和四周后完成了 BPI 干扰项目。项目层面的得分如下：\n\n- 一般活动：基线 $7$，随访 $5$\n- 情绪：基线 $5$，随访 $4$\n-行走能力：基线 $6$，随访 $5$\n- 正常工作：基线 $7$，随访 $6$\n- 与他人关系：基线 $4$，随访 $3$\n- 睡眠：基线 $5$，随访 $4$\n- 生活乐趣：基线 $6$，随访 $5$\n\n使用操作性定义，即平均干扰分数是每个时间点七个领域项目的算术平均值，计算变化分数，即基线平均值减去随访平均值。然后，根据所述的最小重要差异（MID），判断该变化是否代表了临床上有意义的改善。最终只需提供变化分数作为您的数值答案。将您的变化分数四舍五入到三位有效数字。", "solution": "问题陈述已经过严格审查，并被认为是有效的。它在科学上基于心理测量学和临床研究的原理，问题提出得当，提供了所有必要信息，并且语言客观。数据和要求的计算与使用如简明疼痛量表（BPI）等工具评估患者报告结局的标准实践相一致。\n\n任务是计算单个参与者在 BPI 干扰领域的变化分数，并确定这一变化是否具有临床意义。平均干扰分数被定义为在给定时间点七个项目分数的算术平均值。变化分数是基线平均值减去随访平均值。\n\n令 $B_i$ 表示第 $i$ 个项目在基线时的分数，令 $F_i$ 表示第 $i$ 个项目在随访时的分数，其中 $i$ 的范围从 $1$ 到 $N=7$。\n\n基线分数如下：\n$B_1 = 7$ (一般活动)\n$B_2 = 5$ (情绪)\n$B_3 = 6$ (行走能力)\n$B_4 = 7$ (正常工作)\n$B_5 = 4$ (与他人关系)\n$B_6 = 5$ (睡眠)\n$B_7 = 6$ (生活乐趣)\n\n平均基线分数 $\\bar{B}$ 计算为这些分数的算术平均值：\n$$ \\bar{B} = \\frac{1}{N} \\sum_{i=1}^{N} B_i = \\frac{1}{7} (7 + 5 + 6 + 7 + 4 + 5 + 6) $$\n$$ \\bar{B} = \\frac{40}{7} $$\n\n四周后的随访分数如下：\n$F_1 = 5$ (一般活动)\n$F_2 = 4$ (情绪)\n$F_3 = 5$ (行走能力)\n$F_4 = 6$ (正常工作)\n$F_5 = 3$ (与他人关系)\n$F_6 = 4$ (睡眠)\n$F_7 = 5$ (生活乐趣)\n\n平均随访分数 $\\bar{F}$ 计算为这些分数的算术平均值：\n$$ \\bar{F} = \\frac{1}{N} \\sum_{i=1}^{N} F_i = \\frac{1}{7} (5 + 4 + 5 + 6 + 3 + 4 + 5) $$\n$$ \\bar{F} = \\frac{32}{7} $$\n\n变化分数，记作 $\\Delta S$，定义为基线平均分数与随访平均分数之差：\n$$ \\Delta S = \\bar{B} - \\bar{F} $$\n$$ \\Delta S = \\frac{40}{7} - \\frac{32}{7} = \\frac{40 - 32}{7} = \\frac{8}{7} $$\n\n为了便于比较和四舍五入，将此分数转换为小数值：\n$$ \\Delta S = \\frac{8}{7} \\approx 1.142857... $$\n\n问题要求将变化分数四舍五入到三位有效数字。前三位有效数字是 $1$、$1$ 和 $4$。第四位有效数字是 $2$，小于 $5$，因此我们向下取整（即截断）。\n$$ \\Delta S \\approx 1.14 $$\n\n问题还要求根据所述的最小重要差异（MID）来判断该变化是否代表了临床上有意义的改善。先验的 MID 设定为 $1.0$。如果变化分数大于或等于 MID，则观察到临床上有意义的改善。\n$$ \\Delta S \\approx 1.14 $$\n$$ \\text{MID} = 1.0 $$\n由于 $1.14 > 1.0$，观察到的 BPI 平均干扰分数的降低代表了该参与者临床上有意义的改善。\n\n最终要求的答案仅为变化分数的数值，四舍五入到三位有效数字。", "answer": "$$\\boxed{1.14}$$", "id": "4738112"}, {"introduction": "心理评估的最终目标之一是理解心理因素如何相互作用。本练习将向您展示如何使用统计模型来检验关于疼痛的心理学理论，特别是探讨疼痛灾难化思想在疼痛强度与功能障碍之间所扮演的中介角色。通过估计“间接效应”，您将量化灾难化思想在多大程度上解释了疼痛与功能障碍之间的关联，从而深入了解疼痛体验的心理机制。[@problem_id:4738254]", "problem": "医学心理学中的一个简单中介框架考虑了疼痛灾难化如何在疼痛强度与功能障碍之间的关系中起中介作用。令 $X$ 表示疼痛强度（数字评定量表），$M$ 表示疼痛灾难化（问卷得分），$Y$ 表示功能障碍（功能限制得分）。假设以下基于基本统计学原理的经典线性模型设定：所有变量均为观测变量，变量间存在线性关系，且残差均值为零，方差有限，并与预测变量不相关。在这些假设下，中介作用由两个关联的线性模型定义：其中 $M$ 对 $X$ 进行回归，而 $Y$ 对 $X$ 和 $M$ 同时进行回归。$X$ 通过 $M$ 对 $Y$ 的间接效应是由该线性系统内路径 $X \\rightarrow M \\rightarrow Y$ 所蕴含的效应，并通过普通最小二乘法 (OLS) 获得的系数进行估计。\n\n您的任务是为下方的每个测试用例，使用数值线性代数实现以下步骤：\n1. 对 $M$ 在 $X$ 上进行带截距的回归拟合，以获得量化 $M$ 随 $X$ 单位变化而变化的系数。\n2. 对 $Y$ 在 $X$ 和 $M$ 上进行带截距的回归拟合，以获得在保持 $X$ 恒定时，量化 $Y$ 随 $M$ 单位变化而变化的系数。\n3. 根据这两个拟合关系，计算 $X$ 通过 $M$ 对 $Y$ 的估计间接效应。\n4. 将每个测试用例的估计间接效应报告为四舍五入到 $4$ 位小数的浮点数。\n\n使用以下测试套件。在每个案例中，数据均通过指定公式确定性地生成，以便开发者可以精确地复现数组。所有数组都是有限的，大小适中，适合进行 OLS 估计。没有物理单位。\n\n测试用例 $1$ (一般正向中介)：\n- $X_1 = [$ $2$, $3$, $4$, $5$, $6$, $7$, $8$, $9$, $4$, $6$, $5$, $7$, $3$, $8$, $1$, $2$, $9$, $6$, $5$, $4$ $]$.\n- $\\epsilon_{M,1} = [$ $-1.0$, $0.5$, $0.2$, $-0.3$, $0.1$, $-0.2$, $0.3$, $0.0$, $0.1$, $-0.1$, $0.0$, $0.2$, $-0.4$, $0.3$, $-0.2$, $0.1$, $0.2$, $-0.3$, $0.0$, $0.1$ $]$.\n- $\\epsilon_{Y,1} = [$ $0.5$, $-0.2$, $0.3$, $0.1$, $-0.4$, $0.2$, $-0.1$, $0.0$, $0.3$, $-0.2$, $0.1$, $0.2$, $-0.3$, $0.1$, $0.4$, $-0.1$, $0.0$, $0.2$, $-0.2$, $0.1$ $]$.\n- $M_1 = $ $3$ $+$ $2.0 X_1$ $+$ $\\epsilon_{M,1}$.\n- $Y_1 = $ $5$ $+$ $1.0 X_1$ $+$ $0.8 M_1$ $+$ $\\epsilon_{Y,1}$.\n\n测试用例 $2$ ($X$ 与 $M$ 之间无关系，间接效应接近于零)：\n- $X_2 = [$ $1$, $3$, $2$, $4$, $5$, $7$, $6$, $8$, $9$, $10$ $]$.\n- $\\epsilon_{M,2} = [$ $0.2$, $-0.2$, $0.1$, $-0.1$, $0.0$, $-0.3$, $0.3$, $-0.4$, $0.4$, $-0.5$ $]$.\n- $\\epsilon_{Y,2} = [$ $0.1$, $-0.1$, $0.2$, $-0.2$, $0.0$, $0.3$, $-0.3$, $0.2$, $-0.2$, $0.1$ $]$.\n- $M_2 = $ $10$ $+$ $\\epsilon_{M,2}$.\n- $Y_2 = $ $2$ $+$ $1.2 X_2$ $+$ $0.5 M_2$ $+$ $\\epsilon_{Y,2}$.\n\n测试用例 $3$ ($M$ 与 $X$ 相关，但在给定 $X$ 的情况下，$M$ 对 $Y$ 没有额外效应，间接效应接近于零)：\n- $X_3 = [$ $2$, $4$, $3$, $5$, $6$, $8$, $7$, $9$, $10$, $1$ $]$.\n- $\\epsilon_{M,3} = [$ $1.0$, $-0.5$, $0.3$, $-0.2$, $0.4$, $-0.1$, $0.2$, $0.0$, $-0.3$, $0.5$ $]$.\n- $\\epsilon_{Y,3} = [$ $0.2$, $-0.1$, $0.1$, $-0.2$, $0.0$, $0.3$, $-0.3$, $0.2$, $-0.2$, $0.1$ $]$.\n- $M_3 = $ $10$ $+$ $0.5 X_3$ $+$ $\\epsilon_{M,3}$.\n- $Y_3 = $ $4$ $+$ $2.0 X_3$ $+$ $\\epsilon_{Y,3}$.\n\n测试用例 $4$ (负向中介，在控制强度后，较高的灾难化程度反而减少了功能障碍；间接效应为负)：\n- $X_4 = [$ $3$, $5$, $2$, $6$, $7$, $4$, $8$, $9$, $1$, $10$ $]$.\n- $\\epsilon_{M,4} = [$ $0.0$, $-0.1$, $0.2$, $0.1$, $-0.2$, $0.3$, $-0.3$, $0.2$, $0.1$, $-0.4$ $]$.\n- $\\epsilon_{Y,4} = [$ $-0.1$, $0.2$, $-0.2$, $0.1$, $0.0$, $-0.1$, $0.3$, $-0.2$, $0.2$, $0.0$ $]$.\n- $M_4 = $ $5$ $+$ $1.5 X_4$ $+$ $\\epsilon_{M,4}$.\n- $Y_4 = $ $3$ $+$ $1.5 X_4$ $-$ $0.7 M_4$ $+$ $\\epsilon_{Y,4}$.\n\n测试用例 $5$ (小样本量；正向中介)：\n- $X_5 = [$ $2$, $4$, $6$, $8$, $10$ $]$.\n- $\\epsilon_{M,5} = [$ $0.1$, $-0.2$, $0.3$, $-0.1$, $0.0$ $]$.\n- $\\epsilon_{Y,5} = [$ $0.0$, $0.2$, $-0.1$, $0.1$, $-0.2$ $]$.\n- $M_5 = $ $4$ $+$ $0.8 X_5$ $+$ $\\epsilon_{M,5}$.\n- $Y_5 = $ $5$ $+$ $0.5 X_5$ $+$ $0.9 M_5$ $+$ $\\epsilon_{Y,5}$.\n\n实现要求：\n- 使用普通最小二乘法 (OLS)，通过在带有截距列的设计矩阵上进行数值线性代数求解。\n- 对于每个测试用例，计算拟合模型所蕴含的估计间接效应，并四舍五入到 $4$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，例如 $[$ $r_1$, $r_2$, $r_3$, $r_4$, $r_5$ $]$，其中每个 $r_i$ 是测试用例 $i$ 的间接效应估计值（浮点数），四舍五入到 $4$ 位小数。", "solution": "该问题陈述经过了严格验证，被认定为有效。它在科学上基于线性回归和中介分析的原理，这些是定量社会科学和医学科学的基础。该问题表述清晰，为生成变量提供了所有必要的数据和确定性公式，确保每个测试用例都存在唯一且可计算的解。目标定义明确，术语精确无歧义。任务是使用普通最小二乘法 (OLS) 回归这一标准且适当的统计技术，在简单中介模型中估计间接效应。\n\n该中介框架涉及三个变量：一个自变量 $X$，一个中介变量 $M$，以及一个因变量 $Y$。$X$ 通过 $M$ 对 $Y$ 的间接效应通过分析一个由两个线性回归模型组成的系统来量化。该系统的结构遵循经典的中介分析方法。\n\n第一个模型代表从 $X$到 $M$ 的路径，是 $M$ 对 $X$ 的简单线性回归：\n$$\nM_i = \\beta_{a,0} + \\beta_a X_i + \\epsilon_{M,i}\n$$\n这里，$\\beta_a$ 是表示自变量 $X$ 每变化一个单位，中介变量 $M$ 变化的系数。$\\beta_{a,0}$ 是截距项，$\\epsilon_{M,i}$ 是观测值 $i$ 的残差。\n\n第二个模型代表从 $X$ 和 $M$ 到 $Y$ 的路径，是 $Y$ 对 $X$ 和 $M$ 的多元线性回归：\n$$\nY_i = \\beta_{b,0} + \\beta_{c'} X_i + \\beta_b M_i + \\epsilon_{Y,i}\n$$\n在这个模型中，$\\beta_b$ 是在保持 $X$ 恒定的情况下，中介变量 $M$ 每变化一个单位，因变量 $Y$ 变化的系数。$\\beta_{c'}$ 代表在考虑中介变量 $M$ 之后，$X$ 对 $Y$ 的直接效应。$\\beta_{b,0}$ 是截距，$\\epsilon_{Y,i}$ 是残差。\n\n$X$ 通过 $M$ 对 $Y$ 的间接效应定义为第一条路径的系数 $\\beta_a$ 与第二条路径的系数 $\\beta_b$ 的乘积。因此，估计的间接效应计算为 $\\hat{\\beta}_a \\times \\hat{\\beta}_b$。\n\n为了估计这些系数，我们采用普通最小二乘法 (OLS)。对于以矩阵形式表示为 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$ 的一般线性模型，OLS 寻找使残差平方和（即残差向量的欧几里得范数平方 $\\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|_2^2$）最小化的系数向量 $\\boldsymbol{\\hat{\\beta}}$。该最小化问题的解析解由正规方程给出：$\\boldsymbol{\\hat{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$。为了数值稳定性和效率，该系统通常使用 QR 分解等技术来求解，这些技术已在标准数值线性代数库中实现。\n\n对于第一个回归 $M \\sim X$，响应向量 $\\mathbf{y}$ 是观测到的 $M$ 值的向量。设计矩阵 $\\mathbf{X}_a$ 由两列构成：一列全为1，代表截距 $\\beta_{a,0}$；另一列为观测到的 $X$ 值。求解 OLS 问题得到系数向量 $\\boldsymbol{\\hat{\\beta}}_a = [\\hat{\\beta}_{a,0}, \\hat{\\beta}_a]^T$。所需的系数是 $\\hat{\\beta}_a$。\n\n对于第二个回归 $Y \\sim X + M$，响应向量 $\\mathbf{y}$ 是观测到的 $Y$ 值的向量。设计矩阵 $\\mathbf{X}_b$ 由三列构成：一列全为1，代表截距 $\\beta_{b,0}$；一列为 $X$ 值；一列为 $M$ 值。OLS 估计得到系数向量 $\\boldsymbol{\\hat{\\beta}}_b = [\\hat{\\beta}_{b,0}, \\hat{\\beta}_{c'}, \\hat{\\beta}_b]^T$。所需的系数是 $\\hat{\\beta}_b$。\n\n每个测试用例的步骤如下：\n$1$. 对于每个案例 $k \\in \\{1, 2, 3, 4, 5\\}$，使用提供的 $X_k$ 数组、误差项 $\\epsilon_{M,k}$ 和 $\\epsilon_{Y,k}$ 及其确定性生成公式，构造向量 $M_k$ 和 $Y_k$。\n$2$. 对每个案例，拟合第一个回归模型 $M_k \\sim X_k$ 以获得估计值 $\\hat{\\beta}_a$。这涉及构建相应的设计矩阵并求解 OLS 问题。\n$3$. 对每个案例，拟合第二个回归模型 $Y_k \\sim X_k + M_k$ 以获得估计值 $\\hat{\\beta}_b$。\n$4$. 计算乘积 $\\hat{\\beta}_a \\times \\hat{\\beta}_b$ 以得到估计的间接效应。\n$5$. 按要求将最终值四舍五入到 $4$ 位小数。\n整个过程对每个指定的测试用例都进行数值化实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the indirect effect in a simple mediation model for five test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"X\": np.array([2, 3, 4, 5, 6, 7, 8, 9, 4, 6, 5, 7, 3, 8, 1, 2, 9, 6, 5, 4], dtype=float),\n            \"e_M\": np.array([-1.0, 0.5, 0.2, -0.3, 0.1, -0.2, 0.3, 0.0, 0.1, -0.1, 0.0, 0.2, -0.4, 0.3, -0.2, 0.1, 0.2, -0.3, 0.0, 0.1], dtype=float),\n            \"e_Y\": np.array([0.5, -0.2, 0.3, 0.1, -0.4, 0.2, -0.1, 0.0, 0.3, -0.2, 0.1, 0.2, -0.3, 0.1, 0.4, -0.1, 0.0, 0.2, -0.2, 0.1], dtype=float),\n            \"M_formula\": lambda x, e: 3.0 + 2.0 * x + e,\n            \"Y_formula\": lambda x, m, e: 5.0 + 1.0 * x + 0.8 * m + e,\n        },\n        {\n            \"X\": np.array([1, 3, 2, 4, 5, 7, 6, 8, 9, 10], dtype=float),\n            \"e_M\": np.array([0.2, -0.2, 0.1, -0.1, 0.0, -0.3, 0.3, -0.4, 0.4, -0.5], dtype=float),\n            \"e_Y\": np.array([0.1, -0.1, 0.2, -0.2, 0.0, 0.3, -0.3, 0.2, -0.2, 0.1], dtype=float),\n            \"M_formula\": lambda x, e: 10.0 + e,\n            \"Y_formula\": lambda x, m, e: 2.0 + 1.2 * x + 0.5 * m + e,\n        },\n        {\n            \"X\": np.array([2, 4, 3, 5, 6, 8, 7, 9, 10, 1], dtype=float),\n            \"e_M\": np.array([1.0, -0.5, 0.3, -0.2, 0.4, -0.1, 0.2, 0.0, -0.3, 0.5], dtype=float),\n            \"e_Y\": np.array([0.2, -0.1, 0.1, -0.2, 0.0, 0.3, -0.3, 0.2, -0.2, 0.1], dtype=float),\n            \"M_formula\": lambda x, e: 10.0 + 0.5 * x + e,\n            \"Y_formula\": lambda x, m, e: 4.0 + 2.0 * x + e,\n        },\n        {\n            \"X\": np.array([3, 5, 2, 6, 7, 4, 8, 9, 1, 10], dtype=float),\n            \"e_M\": np.array([0.0, -0.1, 0.2, 0.1, -0.2, 0.3, -0.3, 0.2, 0.1, -0.4], dtype=float),\n            \"e_Y\": np.array([-0.1, 0.2, -0.2, 0.1, 0.0, -0.1, 0.3, -0.2, 0.2, 0.0], dtype=float),\n            \"M_formula\": lambda x, e: 5.0 + 1.5 * x + e,\n            \"Y_formula\": lambda x, m, e: 3.0 + 1.5 * x - 0.7 * m + e,\n        },\n        {\n            \"X\": np.array([2, 4, 6, 8, 10], dtype=float),\n            \"e_M\": np.array([0.1, -0.2, 0.3, -0.1, 0.0], dtype=float),\n            \"e_Y\": np.array([0.0, 0.2, -0.1, 0.1, -0.2], dtype=float),\n            \"M_formula\": lambda x, e: 4.0 + 0.8 * x + e,\n            \"Y_formula\": lambda x, m, e: 5.0 + 0.5 * x + 0.9 * m + e,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        X = case[\"X\"]\n        e_M = case[\"e_M\"]\n        e_Y = case[\"e_Y\"]\n        \n        # Generate M and Y vectors based on the deterministic formulas\n        M = case[\"M_formula\"](X, e_M)\n        Y = case[\"Y_formula\"](X, M, e_Y)\n        \n        n = len(X)\n        \n        # Step 1: Fit regression of M on X to get the 'a' path coefficient (beta_a)\n        # Design matrix includes an intercept column\n        design_matrix_a = np.c_[np.ones(n), X]\n        coeffs_a = np.linalg.lstsq(design_matrix_a, M, rcond=None)[0]\n        beta_a = coeffs_a[1]  # Coefficient for X\n        \n        # Step 2: Fit regression of Y on X and M to get the 'b' path coefficient (beta_b)\n        # Design matrix includes intercept, X, and M columns\n        design_matrix_b = np.c_[np.ones(n), X, M]\n        coeffs_b = np.linalg.lstsq(design_matrix_b, Y, rcond=None)[0]\n        beta_b = coeffs_b[2]  # Coefficient for M\n        \n        # Step 3: Compute the estimated indirect effect\n        indirect_effect = beta_a * beta_b\n        \n        # Step 4: Report the estimated indirect effect rounded to 4 decimal places\n        results.append(f\"{indirect_effect:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4738254"}]}