{"hands_on_practices": [{"introduction": "心理筛查的核心是理解各项评估指标如何从原始数据中派生出来。本练习将逆转这一过程，要求您从给定的指标（患病率、特异度和阳性预测值）出发，构建一个$2 \\times 2$混淆矩阵。这项实践有助于您深入理解真阳性、假阳性、真阴性和假阴性这些基本概念是如何共同决定筛查工具的整体性能的 [@problem_id:4739947]。", "problem": "在一家初级保健诊所，正在评估一种用于重度抑郁症（MDD）的二元筛查工具。假设该诊所人群的疾病患病率为 $0.10$。该筛查工具的特异性为 $0.90$，其阳性预测值（PPV）为 $0.40$。请构建一个最小可能的整数值 $2\\times 2$ 混淆矩阵，其条目包括真阳性、假阳性、真阴性和假阴性，并且在所述患病率下与这三个指标完全一致。对于所有指标，仅使用小数或分数，不要使用百分号。请根据您构建的矩阵明确验证患病率、特异性和阳性预测值。\n\n要使这样一个与这些指标完全匹配的整数值矩阵存在，所需的最小总样本量 $N$ 是多少？请以精确整数形式提供您的最终答案，无需四舍五入。", "solution": "在进行求解之前，将根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 正在评估一种用于重度抑郁症（MDD）的二元筛查工具。\n- 疾病患病率，$P = 0.10$。\n- 筛查工具的特异性，$\\text{Sp} = 0.90$。\n- 筛查工具的阳性预测值，$\\text{PPV} = 0.40$。\n- 任务是构建一个最小可能的整数值 $2 \\times 2$ 混淆矩阵，其条目包括真阳性（TP）、假阳性（FP）、真阴性（TN）和假阴性（FN）。\n- 任务是根据构建的矩阵明确验证患病率、特异性和阳性预测值。\n- 最后一个问题是，存在这样一个矩阵所需的最小总样本量 $N$ 是多少。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于生物统计学和流行病学这一成熟领域。患病率、特异性、阳性预测值和混淆矩阵等概念是评估诊断测试的标准基础工具。所提供的数值（$P=0.10$, $\\text{Sp}=0.90$, $\\text{PPV}=0.40$）对于临床环境中的筛查工具是合理的。\n2.  **适定的：** 该问题是适定的。它为混淆矩阵的四个变量提供了三个独立的约束。附加的约束条件，即变量必须是最小可能的正整数，使得该系统得以解决，从而得到唯一解。\n3.  **客观性：** 该问题以精确、量化且无偏见的语言陈述。它不含任何主观或基于意见的主张。\n\n该问题是自洽的、一致的且科学合理的。它没有违反任何无效标准。\n\n### 步骤3：结论与操作\n该问题有效。现在将提供完整的解决方案。\n\n设 $2 \\times 2$ 混淆矩阵的四个条目由以下整数变量表示：\n- $\\text{TP}$：真阳性（患有该疾病且检测结果为阳性的个体）\n- $\\text{FP}$：假阳性（未患有该疾病但检测结果为阳性的个体）\n- $\\text{TN}$：真阴性（未患有该疾病且检测结果为阴性的个体）\n- $\\text{FN}$：假阴性（患有该疾病但检测结果为阴性的个体）\n\n总人口规模为 $N = \\text{TP} + \\text{FP} + \\text{TN} + \\text{FN}$。\n患有该疾病的个体数量为 $\\text{TP} + \\text{FN}$。\n未患有该疾病的个体数量为 $\\text{FP} + \\text{TN}$。\n检测结果为阳性的个体数量为 $\\text{TP} + \\text{FP}$。\n\n给定的指标可以用包含这些变量的方程来表示。\n\n1.  **阳性预测值（PPV）：** 检测结果为阳性的受试者实际患有该疾病的概率。\n    $$ \\text{PPV} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}} = 0.40 = \\frac{4}{10} = \\frac{2}{5} $$\n    从此方程中，我们可以建立 $\\text{TP}$ 和 $\\text{FP}$ 之间的比率关系：\n    $$ 5 \\times \\text{TP} = 2 \\times (\\text{TP} + \\text{FP}) $$\n    $$ 5 \\times \\text{TP} = 2 \\times \\text{TP} + 2 \\times \\text{FP} $$\n    $$ 3 \\times \\text{TP} = 2 \\times \\text{FP} $$\n    这意味着比率 $\\frac{\\text{TP}}{\\text{FP}} = \\frac{2}{3}$。为了使 $\\text{TP}$ 和 $\\text{FP}$ 为整数，它们必须分别是 $2$ 和 $3$ 的整数倍。我们可以写成 $\\text{TP} = 2k$ 和 $\\text{FP} = 3k$，其中 $k$ 为某个正整数。\n\n2.  **特异性（Sp）：** 未患病的受试者检测结果为阴性的概率。\n    $$ \\text{Sp} = \\frac{\\text{TN}}{\\text{FP} + \\text{TN}} = 0.90 = \\frac{9}{10} $$\n    从此方程中，我们可以建立 $\\text{TN}$ 和 $\\text{FP}$ 之间的比率关系：\n    $$ 10 \\times \\text{TN} = 9 \\times (\\text{FP} + \\text{TN}) $$\n    $$ 10 \\times \\text{TN} = 9 \\times \\text{FP} + 9 \\times \\text{TN} $$\n    $$ \\text{TN} = 9 \\times \\text{FP} $$\n    代入 $\\text{FP} = 3k$：\n    $$ \\text{TN} = 9 \\times (3k) = 27k $$\n\n3.  **患病率（P）：** 人群中患有该疾病的比例。\n    $$ P = \\frac{\\text{患病人数}}{\\text{总人口}} = \\frac{\\text{TP} + \\text{FN}}{\\text{TP} + \\text{FP} + \\text{TN} + \\text{FN}} = 0.10 = \\frac{1}{10} $$\n    表达患病率的另一种等效方法是通过患病个体与未患病个体的比率：\n    $$ \\frac{\\text{患病人数}}{\\text{未患病人数}} = \\frac{P}{1-P} = \\frac{0.10}{1 - 0.10} = \\frac{0.10}{0.90} = \\frac{1}{9} $$\n    所以，我们有：\n    $$ \\frac{\\text{TP} + \\text{FN}}{\\text{FP} + \\text{TN}} = \\frac{1}{9} $$\n    现在，用含 $k$ 的表达式代入 $\\text{TP}$、$\\text{FP}$ 和 $\\text{TN}$：\n    $$ \\frac{2k + \\text{FN}}{3k + 27k} = \\frac{1}{9} $$\n    $$ \\frac{2k + \\text{FN}}{30k} = \\frac{1}{9} $$\n    $$ 9 \\times (2k + \\text{FN}) = 30k $$\n    $$ 18k + 9 \\times \\text{FN} = 30k $$\n    $$ 9 \\times \\text{FN} = 12k $$\n    $$ \\text{FN} = \\frac{12k}{9} = \\frac{4k}{3} $$\n\n现在我们已经用单个参数 $k$ 表示了混淆矩阵的所有四个组成部分：\n- $\\text{TP} = 2k$\n- $\\text{FP} = 3k$\n- $\\text{TN} = 27k$\n- $\\text{FN} = \\frac{4k}{3}$\n\n为了使 $\\text{TP}$、$\\text{FP}$、$\\text{TN}$ 和 $\\text{FN}$ 均为正整数，$k$ 必须是一个正整数，并且从 $\\text{FN}$ 的表达式来看，$k$ 还必须是 $3$ 的倍数。为了找到*最小可能整数值*矩阵，我们必须选择满足此条件的最小正整数 $k$。这个最小值是 $k=3$。\n\n代入 $k=3$：\n- $\\text{TP} = 2 \\times 3 = 6$\n- $\\text{FP} = 3 \\times 3 = 9$\n- $\\text{TN} = 27 \\times 3 = 81$\n- $\\text{FN} = \\frac{4 \\times 3}{3} = 4$\n\n因此，最小的整数值混淆矩阵是：\n- $\\text{TP} = 6$\n- $\\text{FP} = 9$\n- $\\text{TN} = 81$\n- $\\text{FN} = 4$\n\n这个最小矩阵的总样本量 $N$ 是：\n$N = \\text{TP} + \\text{FP} + \\text{TN} + \\text{FN} = 6 + 9 + 81 + 4 = 100$。\n\n最后，我们验证该矩阵与给定的指标是否一致：\n- **患病率：** $P = \\frac{\\text{TP} + \\text{FN}}{N} = \\frac{6+4}{100} = \\frac{10}{100} = 0.10$。这是正确的。\n- **特异性：** $\\text{Sp} = \\frac{\\text{TN}}{\\text{FP} + \\text{TN}} = \\frac{81}{9 + 81} = \\frac{81}{90} = 0.90$。这是正确的。\n- **阳性预测值：** $\\text{PPV} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}} = \\frac{6}{6 + 9} = \\frac{6}{15} = \\frac{2}{5} = 0.40$。这是正确的。\n\n所有条件均已满足。存在这样一个整数值矩阵所需的最小总样本量 $N$ 为 100。", "answer": "$$\\boxed{100}$$", "id": "4739947"}, {"introduction": "在临床实践中，我们常常需要在筛查工具的准确性与实用性（如时间成本）之间做出权衡。本练习模拟了这样一个决策场景：比较一个完整版和一个简版筛查工具 [@problem_id:4739919]。通过计算和比较两种工具的阳性预测值（PPV），您将亲身体会到灵敏度和特异度的变化如何影响筛查结果的临床意义，尤其是在患病率固定的情况下。", "problem": "一家医院的基层医疗诊所正在考虑从一种经过验证的完整版心理筛查工具，转换为一种经过验证的简版筛查工具，用于检测成年患者中的某一目标精神健康状况。该目标状况在此诊所人群中的时点患病率可视为恒定值 $0.15$。在相同临床环境下获得的验证数据显示，完整版筛查工具的灵敏度为 $0.88$，特异度为 $0.82$，而简版筛查工具的灵敏度为 $0.76$，特异度为 $0.90$。仅使用灵敏度、特异度和患病率的基本定义以及贝叶斯定理，推导阳性预测值（PPV）的表达式，并计算在患病率保持不变的情况下，从完整版筛查工具更换为简版筛查工具时PPV的变化。将此变化表示为 $\\text{PPV}_{\\text{short}} - \\text{PPV}_{\\text{full}}$。以小数形式表示您的最终答案，并四舍五入至 $4$ 位有效数字。", "solution": "所述问题具有科学依据、提法明确、客观，并包含得出唯一解所需的所有信息。因此，该问题被认定为有效。\n\n目标是推导阳性预测值（PPV）的表达式，并计算当诊所从完整版心理筛查工具切换到简版筛查工具时PPV的变化。\n\n设 $D$ 为患者患有目标精神健康状况的事件，设 $D^c$ 为患者未患该状况的事件。设 $T$ 为患者在筛查中测试结果为阳性的事件。\n\n给定的量为：\n该状况的患病率，$p = P(D) = 0.15$。\n患者未患该状况的概率为 $P(D^c) = 1 - p = 1 - 0.15 = 0.85$。\n\n对于完整版筛查工具（下标 $F$）：\n灵敏度：$Se_F = P(T_F|D) = 0.88$。\n特异度：$Sp_F = P(T_F^c|D^c) = 0.82$。\n\n对于简版筛查工具（下标 $S$）：\n灵敏度：$Se_S = P(T_S|D) = 0.76$。\n特异度：$Sp_S = P(T_S^c|D^c) = 0.90$。\n\n阳性预测值（PPV）是指在患者收到阳性测试结果的情况下，其确实患有该状况的概率。这表示为 $P(D|T)$。我们使用贝叶斯定理来推导PPV的表达式。\n\n贝叶斯定理表述为：\n$$ \\text{PPV} = P(D|T) = \\frac{P(T|D) P(D)}{P(T)} $$\n\n分母中的项 $P(T)$ 是测试结果为阳性的总概率。它可以使用全概率公式展开：\n$$ P(T) = P(T|D)P(D) + P(T|D^c)P(D^c) $$\n\n我们识别出各项：\n$P(T|D)$ 是灵敏度，$Se$。\n$P(D)$ 是患病率，$p$。\n$P(D^c) = 1-p$。\n项 $P(T|D^c)$ 是在没有该状况的情况下测试结果为阳性的概率。这是假阳性率，等于 $1 - \\text{特异度}$。\n$$ P(T|D^c) = 1 - P(T^c|D^c) = 1 - Sp $$\n\n将这些项代入 $P(T)$ 的表达式中：\n$$ P(T) = (Se)(p) + (1 - Sp)(1 - p) $$\n\n现在，将此代回PPV的贝叶斯定理公式，得到通用的推导表达式：\n$$ \\text{PPV} = \\frac{(Se)(p)}{(Se)(p) + (1 - Sp)(1 - p)} $$\n\n接下来，我们使用所提供的值计算每种筛查工具的PPV。\n\n对于完整版筛查工具（$\\text{PPV}_F$）：\n$Se_F = 0.88$, $Sp_F = 0.82$, $p = 0.15$。\n假阳性率为 $1 - Sp_F = 1 - 0.82 = 0.18$。\n$$ \\text{PPV}_F = \\frac{(0.88)(0.15)}{(0.88)(0.15) + (0.18)(0.85)} $$\n$$ \\text{PPV}_F = \\frac{0.132}{0.132 + 0.153} $$\n$$ \\text{PPV}_F = \\frac{0.132}{0.285} \\approx 0.46315789... $$\n\n对于简版筛查工具（$\\text{PPV}_S$）：\n$Se_S = 0.76$, $Sp_S = 0.90$, $p = 0.15$。\n假阳性率为 $1 - Sp_S = 1 - 0.90 = 0.10$。\n$$ \\text{PPV}_S = \\frac{(0.76)(0.15)}{(0.76)(0.15) + (0.10)(0.85)} $$\n$$ \\text{PPV}_S = \\frac{0.114}{0.114 + 0.085} $$\n$$ \\text{PPV}_S = \\frac{0.114}{0.199} \\approx 0.57286432... $$\n\n问题要求计算PPV的变化，定义为 $\\text{PPV}_S - \\text{PPV}_F$。\n$$ \\Delta \\text{PPV} = \\text{PPV}_S - \\text{PPV}_F \\approx 0.57286432 - 0.46315789 $$\n$$ \\Delta \\text{PPV} \\approx 0.10970643... $$\n\n将此结果四舍五入至 $4$ 位有效数字，我们得到 $0.1097$。\nPPV的变化是增加了约 $0.1097$。这归因于简版筛查工具具有更高的特异度，从而降低了假阳性率，并因此提高了阳性结果的预测能力，尽管其灵敏度较低。", "answer": "$$\\boxed{0.1097}$$", "id": "4739919"}, {"introduction": "筛查工具的性能并非一成不变，它会受到应用人群特征的影响，这一现象被称为“谱系偏倚”（spectrum bias）。本练习通过一个假设场景，展示了当一个在专科诊所验证的工具被应用于初级保健机构时，其阳性预测值（PPV）会如何发生巨大变化 [@problem_id:4739896]。完成此练习将帮助您批判性地评估筛查研究，并理解为何在不同临床环境中应用同一工具时必须谨慎。", "problem": "一种新的双项目抑郁筛查工具在一个情感障碍专科诊所进行了验证，该诊所的病例组合主要由中度至重度的患者构成。在该验证环境中，真正符合当前重度抑郁发作标准的患者比例（患病率）为 $0.60$，观察到的灵敏度为 $0.90$，特异度为 $0.85$。后来，该工具被应用于一个普通初级保健诊所，那里当前重度抑郁发作的患病率为 $0.10$。由于初级保健人群中包含许多较轻微和非典型的病例，预计在初级保健中的灵敏度为 $0.80$，而特异度保持为 $0.85$。\n\n从灵敏度、特异度和患病率的核心定义出发，确定该工具在专科诊所和初级保健中的阳性预测值 (PPV)。然后，计算从专科诊所转移到初级保健时 PPV 的预期下降值。用一两句话简要解释这些变化如何说明心理筛查中的谱系偏倚。\n\n将最终数值表示为小数，并四舍五入至四位有效数字。不要使用百分号。", "solution": "问题陈述被评估为有效。它在科学上基于生物统计学和流行病学的原理，提供了一个提法得当的问题以及一套完整且一致的数据。所用术语（灵敏度、特异度、患病率、PPV、谱系偏倚）是标准的且使用正确。数值对于所描述的临床环境是符合实际的。\n\n阳性预测值 (PPV) 是指检测结果为阳性的受试者确实患有该疾病的概率。它通过条件概率来正式定义。设 $D^+$ 为患者患有重度抑郁发作的事件，设 $T^+$ 为筛查工具给出阳性结果的事件。那么 PPV 就是 $P(D^+ | T^+)$。\n\n使用贝叶斯定理，PPV 可以表示为：\n$$\n\\text{PPV} = P(D^+ | T^+) = \\frac{P(T^+ | D^+) P(D^+)}{P(T^+)}\n$$\n该方程中的各项与给定的参数相关：\n- 患病率 ($P$): 患有该疾病的先验概率，$P = P(D^+)$。\n- 灵敏度 ($Se$): 在患有疾病的情况下检测结果为阳性的概率，$Se = P(T^+ | D^+)$。\n- 特异度 ($Sp$): 在未患疾病的情况下检测结果为阴性的概率，$Sp = P(T^- | D^-)$。\n\n分母 $P(T^+)$ 是检测结果为阳性的总概率，可以使用全概率公式求得：\n$$\nP(T^+) = P(T^+ | D^+) P(D^+) + P(T^+ | D^-) P(D^-)\n$$\n我们注意到 $P(D^-) = 1 - P(D^+) = 1 - P$，并且假阳性率是 $P(T^+ | D^-) = 1 - P(T^- | D^-) = 1 - Sp$。将这些代入 $P(T^+)$ 的表达式中，得到：\n$$\nP(T^+) = (Se \\cdot P) + ((1 - Sp) \\cdot (1 - P))\n$$\n因此，PPV 的通用公式为：\n$$\n\\text{PPV} = \\frac{Se \\cdot P}{(Se \\cdot P) + (1 - Sp)(1 - P)}\n$$\n现在我们将此公式应用于两个指定的临床环境。\n\n1.  **情感障碍专科诊所**\n    设专科诊所的参数用下标 $S$ 表示。\n    - 患病率: $P_S = 0.60$\n    - 灵敏度: $Se_S = 0.90$\n    - 特异度: $Sp_S = 0.85$\n\n    专科诊所的阳性预测值 $PPV_S$ 为：\n    $$\n    PPV_S = \\frac{Se_S \\cdot P_S}{(Se_S \\cdot P_S) + (1 - Sp_S)(1 - P_S)}\n    $$\n    $$\n    PPV_S = \\frac{0.90 \\cdot 0.60}{(0.90 \\cdot 0.60) + (1 - 0.85)(1 - 0.60)}\n    $$\n    $$\n    PPV_S = \\frac{0.54}{0.54 + (0.15)(0.40)}\n    $$\n    $$\n    PPV_S = \\frac{0.54}{0.54 + 0.06} = \\frac{0.54}{0.60} = 0.90\n    $$\n\n2.  **普通初级保健诊所**\n    设初级保健诊所的参数用下标 $PC$ 表示。\n    - 患病率: $P_{PC} = 0.10$\n    - 灵敏度: $Se_{PC} = 0.80$\n    - 特异度: $Sp_{PC} = 0.85$\n\n    初级保健中的阳性预测值 $PPV_{PC}$ 为：\n    $$\n    PPV_{PC} = \\frac{Se_{PC} \\cdot P_{PC}}{(Se_{PC} \\cdot P_{PC}) + (1 - Sp_{PC})(1 - P_{PC})}\n    $$\n    $$\n    PPV_{PC} = \\frac{0.80 \\cdot 0.10}{(0.80 \\cdot 0.10) + (1 - 0.85)(1 - 0.10)}\n    $$\n    $$\n    PPV_{PC} = \\frac{0.08}{0.08 + (0.15)(0.90)}\n    $$\n    $$\n    PPV_{PC} = \\frac{0.08}{0.08 + 0.135} = \\frac{0.08}{0.215} \\approx 0.37209302...\n    $$\n\n3.  **PPV 的预期下降值**\n    PPV 的下降值是专科诊所中的值与初级保健中的值之间的差。\n    $$\n    \\Delta \\text{PPV} = PPV_S - PPV_{PC}\n    $$\n    $$\n    \\Delta \\text{PPV} = 0.90 - \\frac{0.08}{0.215} \\approx 0.90 - 0.37209302 = 0.52790698...\n    $$\n    将此结果四舍五入至四位有效数字，得到 $0.5279$。\n\n4.  **谱系偏倚的说明**\n    谱系偏倚是选择偏倚的一种形式，当一项诊断测试应用于与验证人群具有不同疾病谱（例如，严重程度、分期）的人群时，其性能特征（特别是灵敏度和特异度）会发生变化。本问题直接说明了这一点，因为该测试从一个有“中度至重度表现”患者的专科诊所，转移到一个有“较轻微和非典型病例”患者的初级保健诊所，导致灵敏度从 $0.90$ 下降到 $0.80$。", "answer": "$$\\boxed{0.5279}$$", "id": "4739896"}]}