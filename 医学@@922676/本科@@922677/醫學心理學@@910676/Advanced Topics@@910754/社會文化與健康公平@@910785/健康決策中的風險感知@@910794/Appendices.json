{"hands_on_practices": [{"introduction": "在健康决策中，一个核心技能是在获得新信息（如诊断测试结果）后，准确地更新个人对疾病风险的认知。然而，人类的直觉在处理这类概率更新时常常出错，导致对风险的评估过高或过低。本练习 [@problem_id:4743806] 将指导您使用贝叶斯定理这一基本工具，来计算在收到阳性测试结果后患病的真实后验概率，从而掌握风险评估的规范方法。", "problem": "一个医学心理学研究团队研究个体在收到诊断测试结果后如何更新其对疾病的感知风险。设 $H$ 表示患者患有某种特定疾病的事件，$D$ 表示筛查测试返回阳性结果的事件。该患者属于一个亚组，其测试前（先验）概率为 $P(H)=0.10$。该测试的灵敏度为 $P(D \\mid H)=0.90$，特异度为 $P(\\neg D \\mid \\neg H)=0.95$。该患者的测试结果为阳性。\n\n从条件概率和全概率定律的基本定义出发，推导规范性后验风险 $P(H \\mid D)$，并使用给定参数计算其数值。将最终答案表示为四舍五入到三位有效数字的小数。", "solution": "目标是计算后验概率 $P(H \\mid D)$，即在测试结果为阳性的条件下，患者患有该疾病的概率。在医学心理学中，这个量通常被称为阳性预测值 (PPV)，它为获得诊断证据后的风险感知提供了规范性基准。\n\n我们从条件概率的定义开始：\n$$\nP(H \\mid D) = \\frac{P(H \\cap D)}{P(D)}.\n$$\n根据乘法法则（条件概率定义的另一种形式），\n$$\nP(H \\cap D) = P(D \\mid H) P(H).\n$$\n因此，\n$$\nP(H \\mid D) = \\frac{P(D \\mid H) P(H)}{P(D)}.\n$$\n我们现在使用全概率定律，在划分 $\\{H, \\neg H\\}$ 上表示 $P(D)$：\n$$\nP(D) = P(D \\mid H) P(H) + P(D \\mid \\neg H) P(\\neg H).\n$$\n量 $P(D \\mid \\neg H)$ 是假阳性率，等于 1 减去特异度。已知特异度 $P(\\neg D \\mid \\neg H) = 0.95$，我们有\n$$\nP(D \\mid \\neg H) = 1 - P(\\neg D \\mid \\neg H) = 1 - 0.95 = 0.05.\n$$\n另外，\n$$\nP(\\neg H) = 1 - P(H) = 1 - 0.10 = 0.90.\n$$\n将给定值代入 $P(D)$ 的表达式中，\n$$\nP(D) = (0.90)(0.10) + (0.05)(0.90) = 0.09 + 0.045 = 0.135.\n$$\n现在计算 $P(H \\mid D)$：\n$$\nP(H \\mid D) = \\frac{(0.90)(0.10)}{0.135} = \\frac{0.09}{0.135} = \\frac{9}{13.5} = \\frac{2}{3} = 0.666\\ldots.\n$$\n四舍五入到三位有效数字，结果是\n$$\n0.667.\n$$\n因此，规范性后验风险 $P(H \\mid D)$，即阳性预测值 (PPV)，在四舍五入到三位有效数字后是 $0.667$。", "answer": "$$\\boxed{0.667}$$", "id": "4743806"}, {"introduction": "虽然贝叶斯定理在形式上是精确的，但其抽象的概率形式对许多人来说在认知上存在挑战，容易导致“基础概率忽略”等偏误。为了克服这一困难，认知心理学家提出了“自然频率”这一更直观的表达方式。本练习 [@problem_id:4743796] 将引导您将相同的风险情景转化为具体的人数（自然频率），通过简单的计数来解决问题，从而亲身体验这种方法如何简化复杂的风险沟通和计算。", "problem": "一家初级保健诊所使用一份简短的筛查问卷来筛查广泛性焦虑症 (GAD)。在筛查人群中，GAD 的基础率（患病率）为 $0.06$。该问卷的灵敏度（真阳性率）为 $0.80$，特异度（真阴性率）为 $0.90$。灵敏度的定义是，在患有该疾病的情况下，测试结果为阳性的概率；特异度的定义是，在没有该疾病的情况下，测试结果为阴性的概率。为了研究自然频率如何帮助风险感知和决策，请将此情景转换为一个大小为 $N$ 的队列的自然频率，以使结果的计数为整数（您可以使用 $N=2000$）。仅使用这些定义和给定参数，计算队列中的真阳性数和假阳性数，然后计算在测试结果为阳性的患者中，实际患有 GAD 的患者的后验比例，以小数形式表示。将您最终的后验比例四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题要求将给定的概率转换为指定大小队列的自然频率，然后从这些频率计算出各种量。\n\n设 $D$ 为患者患有 GAD 的事件， $D^c$ 为患者没有患 GAD 的事件。\n设 $T^+$ 为测试结果为阳性的事件， $T^-$ 为测试结果为阴性的事件。\n\n给定的概率是：\n- 患病率：$P(D) = 0.06$。\n- 灵敏度：$P(T^+|D) = 0.80$。\n- 特异度：$P(T^-|D^c) = 0.90$。\n\n由此，我们可以推断：\n- $P(D^c) = 1 - P(D) = 1 - 0.06 = 0.94$。\n- 假阴性的概率为 $P(T^-|D) = 1 - P(T^+|D) = 1 - 0.80 = 0.20$。\n- 假阳性的概率为 $P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - 0.90 = 0.10$。\n\n我们考虑一个大小为 $N = 2000$ 的队列。\n\n1.  **计算队列中患有和未患有 GAD 的个体数量。**\n    - 患有 GAD 的个体数量：\n      $$N_D = N \\times P(D) = 2000 \\times 0.06 = 120$$\n    - 未患有 GAD 的个体数量：\n      $$N_{D^c} = N \\times P(D^c) = 2000 \\times 0.94 = 1880$$\n    作为检验，$N_D + N_{D^c} = 120 + 1880 = 2000$，即总队列大小。\n\n2.  **计算患有 GAD 群体的测试结果数量。**\n    - **真阳性 (TP)**：患有 GAD 且测试结果为阳性的个体。这是第一个要求计算的量。\n      $$N_{TP} = N_D \\times P(T^+|D) = 120 \\times 0.80 = 96$$\n    - 假阴性 (FN)：患有 GAD 且测试结果为阴性的个体。\n      $$N_{FN} = N_D \\times P(T^-|D) = 120 \\times 0.20 = 24$$\n    总和为 $96 + 24 = 120$，与患有 GAD 的个体数量相符。\n\n3.  **计算未患有 GAD 群体的测试结果数量。**\n    - **假阳性 (FP)**：未患有 GAD 但测试结果为阳性的个体。这是第二个要求计算的量。\n      $$N_{FP} = N_{D^c} \\times P(T^+|D^c) = 1880 \\times 0.10 = 188$$\n    - 真阴性 (TN)：未患有 GAD 且测试结果为阴性的个体。\n      $$N_{TN} = N_{D^c} \\times P(T^-|D^c) = 1880 \\times 0.90 = 1692$$\n    总和为 $188 + 1692 = 1880$，与未患有 GAD 的个体数量相符。\n\n4.  **计算后验比例。**\n    问题要求计算在测试结果为阳性的患者中，实际患有 GAD 的患者的后验比例。这也被称为阳性预测值 (PPV)，或 $P(D|T^+)$。\n    这个比例可以使用自然频率计算：\n    $$P(D|T^+) = \\frac{\\text{Number of true positives}}{\\text{Total number of positives}}$$\n    测试结果为阳性的患者总数是真阳性数和假阳性数之和。\n    $$N_{T^+} = N_{TP} + N_{FP} = 96 + 188 = 284$$\n    因此，后验比例为：\n    $$P(D|T^+) = \\frac{N_{TP}}{N_{T^+}} = \\frac{96}{284}$$\n    为了获得最终的小数值，我们进行除法运算：\n    $$\\frac{96}{284} = \\frac{24}{71} \\approx 0.338028169...$$\n    将此结果四舍五入到四位有效数字，得到 $0.3380$。\n\n所要求的量是：\n- 真阳性数：$96$。\n- 假阳性数：$188$。\n- 后验比例：$0.3380$。\n\n最终答案是后验比例。", "answer": "$$\\boxed{0.3380}$$", "id": "4743796"}, {"introduction": "从个体风险计算转向群体数据分析时，我们会遇到更复杂的挑战，其中最著名的是辛普森悖论。在这种情况下，一个干预措施在总体数据上看似有害，但在每个亚组中却显示出明确的益处，这通常是由混杂变量的不均衡分布引起的。本练习 [@problem_id:4743718] 模拟了这样一个真实世界的研究场景，要求您识别并解决这一悖论，通过统计学校正方法揭示干预措施的真实效果，这对于循证医学实践至关重要。", "problem": "一项医学心理学领域的队列研究探讨了风险感知如何影响健康决策和结果。个体根据他们对未来发生焦虑相关健康事件的感知易感性，来决定是否采纳一项认知行为压力管理干预措施。研究结局是在一个固定的随访期内，是否发生至少一次临床上显著的焦虑发作。根据基线感知易感性定义了两个分层：高感知易感性层和低感知易感性层。由于感知易感性既影响采纳干预措施的可能性，也影响基线结局风险，因此它是一个潜在的混杂因素。\n\n数据如下。在高感知易感性层中，有$800$名干预参与者，其风险为$0.35$；有$200$名非干预参与者，其风险为$0.40$。在低感知易感性层中，有$200$名干预参与者，其风险为$0.08$；有$800$名非干预参与者，其风险为$0.10$。此处的“风险”指的是在随访期间经历至少一次焦虑发作的概率。\n\n使用风险（结局的概率）、风险差（干预组风险减去非干预组风险）的核心定义以及全概率定律，首先验证通过忽略分层计算出的未调整（边际）风险差表明干预措施有害，而两个分层内的分层特异性风险差均表明有益。然后，通过计算干预组与非干预组的直接标准化调整风险差来解决辛普森悖论，其中使用合并的研究人群作为计算分层权重的标准人群。\n\n将你最终的调整风险差以小数形式表示，并四舍五入到四位有效数字。", "solution": "该问题要求首先验证一个辛普森悖论的实例，然后通过计算调整后的风险差来解决它。我将系统地进行处理。\n\n设两个分层分别用$S=1$表示高感知易感性（HPS）层，用$S=2$表示低感知易感性（LPS）层。设暴露用$E=I$表示干预组，用$E=N$表示非干预组。风险$R$是结局（焦虑发作）的概率。\n\n所提供的数据可以总结如下：\n对于HPS层（$S=1$）：\n干预组人数：$N_{1,I} = 800$\n干预组风险：$R_{1,I} = 0.35$\n非干预组人数：$N_{1,N} = 200$\n非干预组风险：$R_{1,N} = 0.40$\n\n对于LPS层（$S=2$）：\n干预组人数：$N_{2,I} = 200$\n干预组风险：$R_{2,I} = 0.08$\n非干预组人数：$N_{2,N} = 800$\n非干预组风险：$R_{2,N} = 0.10$\n\n**第1部分：验证辛普森悖论**\n\n首先，我们通过忽略分层来计算未调整的（边际）风险。为此，我们需要计算两个分层中每个组（干预组和非干预组）的总参与人数和总焦虑发作次数。\n\n每个亚组的焦虑发作次数（$C$）由$C = N \\times R$给出：\n$C_{1,I} = N_{1,I} \\times R_{1,I} = 800 \\times 0.35 = 280$\n$C_{1,N} = N_{1,N} \\times R_{1,N} = 200 \\times 0.40 = 80$\n$C_{2,I} = N_{2,I} \\times R_{2,I} = 200 \\times 0.08 = 16$\n$C_{2,N} = N_{2,N} \\times R_{2,N} = 800 \\times 0.10 = 80$\n\n现在，我们为边际分析计算总数：\n干预组总参与人数：$N_I = N_{1,I} + N_{2,I} = 800 + 200 = 1000$\n非干预组总参与人数：$N_N = N_{1,N} + N_{2,N} = 200 + 800 = 1000$\n\n干预组总发作次数：$C_I = C_{1,I} + C_{2,I} = 280 + 16 = 296$\n非干预组总发作次数：$C_N = C_{1,N} + C_{2,N} = 80 + 80 = 160$\n\n未调整的（边际）风险为：\n干预组的边际风险：$R_I = \\frac{C_I}{N_I} = \\frac{296}{1000} = 0.296$\n非干预组的边际风险：$R_N = \\frac{C_N}{N_N} = \\frac{160}{1000} = 0.160$\n\n未调整的风险差（$RD_{unadj}$）为：\n$$RD_{unadj} = R_I - R_N = 0.296 - 0.160 = 0.136$$\n由于$RD_{unadj} > 0$，粗略分析表明干预措施增加了焦虑发作的风险，即表明其有害。\n\n接下来，我们考察分层特异性风险差（$RD_s = R_{s,I} - R_{s,N}$）：\n对于HPS层（$S=1$）：$RD_1 = R_{1,I} - R_{1,N} = 0.35 - 0.40 = -0.05$\n对于LPS层（$S=2$）：$RD_2 = R_{2,I} - R_{2,N} = 0.08 - 0.10 = -0.02$\n\n在两个分层中，风险差均为负值，表明干预措施具有有益效果（即降低了风险）。未调整的风险差与分层特异性风险差的符号相反。这证实了辛普森悖论的存在。该悖论的产生是因为混杂因素（感知易感性）在干预组和非干预组之间的分布不均。具有高感知易感性的个体既更可能采纳干预措施，又具有更高的焦虑基线风险。\n\n**第2部分：通过直接标准化解决**\n\n为解决此悖论，我们使用直接标准化方法计算调整后的风险差。此方法计算的是，如果混杂变量在干预组和非干预组中具有相同的分布，风险将会是多少。问题指定使用合并的研究人群作为标准人群。\n\n首先，我们确定这个标准人群的构成。\nHPS层总人数：$N_1 = N_{1,I} + N_{1,N} = 800 + 200 = 1000$\nLPS层总人数：$N_2 = N_{2,I} + N_{2,N} = 200 + 800 = 1000$\n研究总人数：$N_{total} = N_1 + N_2 = 1000 + 1000 = 2000$\n\n用于标准化的权重（$w_s$）是标准人群在每个分层中的比例：\nHPS层的权重：$w_1 = \\frac{N_1}{N_{total}} = \\frac{1000}{2000} = 0.5$\nLPS层的权重：$w_2 = \\frac{N_2}{N_{total}} = \\frac{1000}{2000} = 0.5$\n\n接下来，我们通过对分层特异性风险进行加权平均来计算每个组的标准化风险，权重使用$w_1$和$w_2$。\n干预组的标准化风险（$R_{std, I}$）：\n$$R_{std, I} = w_1 R_{1,I} + w_2 R_{2,I} = (0.5 \\times 0.35) + (0.5 \\times 0.08) = 0.175 + 0.040 = 0.215$$\n\n非干预组的标准化风险（$R_{std, N}$）：\n$$R_{std, N} = w_1 R_{1,N} + w_2 R_{2,N} = (0.5 \\times 0.40) + (0.5 \\times 0.10) = 0.200 + 0.050 = 0.250$$\n\n最后，直接标准化调整风险差（$RD_{adj}$）是这些标准化风险之间的差值：\n$$RD_{adj} = R_{std, I} - R_{std, N} = 0.215 - 0.250 = -0.035$$\n\n这个调整后的风险差是负值，这与每个分层内的发现一致，并代表了在排除感知易感性混杂效应后，干预措施的估计效果。它也可以通过计算分层特异性风险差的加权平均值得到：$RD_{adj} = w_1 RD_1 + w_2 RD_2 = 0.5 \\times (-0.05) + 0.5 \\times (-0.02) = -0.025 - 0.010 = -0.035$。\n\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。计算值为$-0.035$。有效数字是$3$和$5$。为了将其表示为四位有效数字，我们在后面添加两个零。因此，该值为$-0.03500$。", "answer": "$$\\boxed{-0.03500}$$", "id": "4743718"}]}