{"hands_on_practices": [{"introduction": "在临床诊断中，一个阳性测试结果并不等同于百分之百确诊。贝叶斯定理使我们能够量化在给定阳性测试结果时，目标病原体真实存在的概率，即阳性预测值 (PPV)。这项练习 [@problem_id:5225298] 将通过一个典型场景，演示如何结合患病率（先验概率）与检测方法的固有准确性（灵敏度和特异性），来计算和理解阳性结果的真实临床意义，这是准确解读实验室数据的核心技能。", "problem": "一家临床微生物学实验室对重症监护室（ICU）中疑似为革兰氏阴性非发酵菌的分离株采用一种组合鉴定算法。该算法整合了多项独立观察结果（氧化酶阳性、高温下生长、特征性色素产生，以及确认性的基质辅助激光解吸/电离飞行时间质谱法），经验证，该算法在此类分离株中检测铜绿假单胞菌（Pseudomonas aeruginosa）真实病例的灵敏度为 $0.95$，特异度为 $0.98$。在某特定ICU中，革兰氏阴性非发酵菌分离株中铜绿假单胞菌的检验前患病率（先验概率）为 $0.30$。\n\n请从灵敏度、特异度和贝叶斯定理的定义出发，推导在该算法给出阳性结果的情况下，一个分离株确实是铜绿假单胞菌的后验概率，并根据所提供的参数计算其值。最终答案请表示为 $0$ 到 $1$ 之间的一个小数，四舍五入至四位有效数字。请勿使用百分号。", "solution": "该问题陈述被认为是有效的，因为它科学地基于诊断统计学和贝叶斯概率的原理，问题提法恰当，并提供了足够的信息以获得唯一解，且以客观、明确的语言表述。\n\n我们定义相关事件如下：\n- $D$：分离株确实是 *Pseudomonas aeruginosa* 的事件。\n- $D^c$：分离株不是 *Pseudomonas aeruginosa* 的事件。\n- $T^+$：鉴定算法得出阳性结果的事件。\n- $T^-$：鉴定算法得出阴性结果的事件。\n\n问题提供了以下信息，我们可以用概率术语表示：\n\n1.  *Pseudomonas aeruginosa* 的检验前患病率（先验概率）为 $P(D) = 0.30$。\n    根据全概率定律，分离株不是 *P. aeruginosa* 的先验概率为 $P(D^c) = 1 - P(D) = 1 - 0.30 = 0.70$。\n\n2.  该算法的灵敏度是在分离株确实是 *P. aeruginosa* 的条件下，测试结果为阳性的概率。这是真阳性率：\n    $$P(T^+ | D) = 0.95$$\n\n3.  该算法的特异度是在分离株不是 *P. aeruginosa* 的条件下，测试结果为阴性的概率。这是真阴性率：\n    $$P(T^- | D^c) = 0.98$$\n\n根据特异度的定义，我们可以确定假阳性率，即在分离株不是 *P. aeruginosa* 的条件下，测试结果为阳性的概率：\n$$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - 0.98 = 0.02$$\n\n问题要求我们推导并计算在算法给出阳性结果的情况下，分离株确实是 *P. aeruginosa* 的后验概率。这个量记为 $P(D | T^+)$，也称为阳性预测值 (PPV)。\n\n我们从贝叶斯定理出发，该定理源于条件概率的定义。给定事件 $T^+$ 时事件 $D$ 的条件概率为：\n$$P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)}$$\n其中 $P(D \\cap T^+)$ 是两个事件同时发生的联合概率。\n\n使用概率的乘法法则，我们可以将分子中的联合概率表示为：\n$$P(D \\cap T^+) = P(T^+ | D) P(D)$$\n\n分母 $P(T^+)$ 表示获得阳性测试结果的总概率。这可以通过全概率定律计算，将事件 $T^+$ 在由 $\\{D, D^c\\}$ 定义的样本空间上进行划分：\n$$P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)$$\n对该和式中的每一项应用乘法法则，得到：\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\n\n将这些表达式代回 $P(D | T^+)$ 的公式，我们得到该问题的贝叶斯定理的显式形式：\n$$P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)}$$\n\n该公式以后验概率 $P(D | T^+)$ 的形式表示，其中包含了先验概率 $P(D)$、灵敏度 $P(T^+ | D)$ 和假阳性率 $P(T^+ | D^c)$。\n\n现在，我们将给定的数值代入这个推导出的公式中：\n- $P(D) = 0.30$\n- $P(D^c) = 0.70$\n- $P(T^+ | D) = 0.95$\n- $P(T^+ | D^c) = 0.02$\n\n$$P(D | T^+) = \\frac{(0.95)(0.30)}{(0.95)(0.30) + (0.02)(0.70)}$$\n\n首先，我们计算分子和分母中各项的值：\n- 分子：$P(T^+ | D) P(D) = 0.95 \\times 0.30 = 0.285$\n- 分母第1项：$P(T^+ | D) P(D) = 0.285$\n- 分母第2项：$P(T^+ | D^c) P(D^c) = 0.02 \\times 0.70 = 0.014$\n\n阳性测试的总概率 $P(T^+)$ 是分母两项之和：\n$$P(T^+) = 0.285 + 0.014 = 0.299$$\n\n最后，我们计算后验概率：\n$$P(D | T^+) = \\frac{0.285}{0.299}$$\n$$P(D | T^+) \\approx 0.9531772575...$$\n\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $9$、$5$、$3$ 和 $1$。第五位有效数字是 $7$，大于或等于 $5$，所以我们将第四位有效数字向上取整。\n$$P(D | T^+) \\approx 0.9532$$\n这就是在算法给出阳性测试结果的情况下，一个分离株确实是 *Pseudomonas aeruginosa* 的后验概率。", "answer": "$$\\boxed{0.9532}$$", "id": "5225298"}, {"introduction": "在评估一种鉴定算法时，仅仅知道其“大部分时间”有效是远远不够的，我们必须深入了解其具体的错误模式。混淆矩阵是一种强大的工具，它通过将每个类别的正确和错误预测进行分类制表，从而详细地展示了分类器的性能。这项练习 [@problem_id:5225359] 要求您构建一个混淆矩阵，通过计算真阳性、假阳性、真阴性和假阴性的期望计数，您将学会如何量化特定诊断规则的风险与优势，从而超越单一指标，实现对算法性能的全面评估。", "problem": "一个临床微生物学实验室正在评估一项决策规则，该规则仅使用氧化酶和硝酸盐还原这两种常规检验来区分 *Achromobacter* 和 *Pseudomonas* 的分离株。考虑一批 $N = 400$ 株非发酵性革兰氏阴性分离株，其真实属组成为 $P(\\text{Achromobacter}) = 0.30$ 和 $P(\\text{Pseudomonas}) = 0.70$。对于 *Achromobacter*，分离株氧化酶阳性的概率为 $P(O^{+} \\mid A) = 0.92$，硝酸盐阳性的概率为 $P(N^{+} \\mid A) = 0.45$。对于 *Pseudomonas*，分离株氧化酶阳性的概率为 $P(O^{+} \\mid P) = 0.98$，硝酸盐阳性的概率为 $P(N^{+} \\mid P) = 0.85$。假设在每个属内，氧化酶和硝酸盐检测结果是条件独立的，即对于 $G \\in \\{A,P\\}$，有 $P(O^{+} \\cap N^{+} \\mid G) = P(O^{+} \\mid G) \\times P(N^{+} \\mid G)$。\n\n该实验室仅根据这两项测试结果使用以下确定性决策规则：当且仅当两项测试均为阳性时，预测为 *Pseudomonas*；否则，预测为 *Achromobacter*。\n\n使用条件概率的核心定义和条件独立性下的乘法法则，推导出这批样本的期望混淆矩阵（预测属 vs 实际属），以期望计数表示，然后计算总体误分类率，该率定义为预测属与真实属不同的分离株的期望分数。\n\n将每个混淆矩阵条目四舍五入到三位有效数字。将总体误分类率报告为一个四舍五入到四位有效数字的单一小数值。以小数形式表示误分类率（不带百分号）。", "solution": "首先验证问题以确保其具有科学依据、问题提出得当且客观。\n\n### 步骤1：提取已知条件\n- 分离株总数：$N = 400$\n- 分离株为 *Achromobacter* 的先验概率：$P(A) = 0.30$\n- 分离株为 *Pseudomonas* 的先验概率：$P(P) = 0.70$\n- *Achromobacter* 氧化酶检测阳性的条件概率：$P(O^{+} \\mid A) = 0.92$\n- *Achromobacter* 硝酸盐检测阳性的条件概率：$P(N^{+} \\mid A) = 0.45$\n- *Pseudomonas* 氧化酶检测阳性的条件概率：$P(O^{+} \\mid P) = 0.98$\n- *Pseudomonas* 硝酸盐检测阳性的条件概率：$P(N^{+} \\mid P) = 0.85$\n- 条件独立性假设：对于属 $G \\in \\{A, P\\}$，有 $P(O^{+} \\cap N^{+} \\mid G) = P(O^{+} \\mid G) \\times P(N^{+} \\mid G)$。\n- 决策规则：当且仅当氧化酶测试和硝酸盐测试均为阳性（$O^{+}$ 和 $N^{+}$）时，预测为 *Pseudomonas*。否则，预测为 *Achromobacter*。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是概率论在评估诊断分类规则方面的标准应用。所提供的概率是一致的（例如，$P(A) + P(P) = 0.30 + 0.70 = 1.00$）。问题设定完整，包含所有必要数据和一条清晰的确定性规则。该场景在临床微生物学的背景下是科学现实的。问题提出得当，因为它要求明确定义的统计指标（混淆矩阵和误分类率），这些指标可以从给定条件中推导出唯一解。没有事实错误、矛盾或歧义。\n\n### 步骤3：结论和行动\n问题有效。将推导解答。\n\n### 推导\n令 $\\hat{A}$ 表示分离株被预测为 *Achromobacter* 的事件，$\\hat{P}$ 表示其被预测为 *Pseudomonas* 的事件。决策规则可以表述为：\n- 如果结果为 $O^{+} \\cap N^{+}$，则分离株被预测为 *Pseudomonas* ($\\hat{P}$)。\n- 否则，即如果结果为 $\\neg(O^{+} \\cap N^{+})$，则分离株被预测为 *Achromobacter* ($\\hat{A}$)。\n\n首先，我们使用条件独立性假设，计算在给定真实属的情况下，预测结果的条件概率。\n\n对于一个真实为 *Achromobacter* 的分离株（事件 $A$）：\n将其预测为 *Pseudomonas* 的概率为：\n$$P(\\hat{P} \\mid A) = P(O^{+} \\cap N^{+} \\mid A) = P(O^{+} \\mid A) \\times P(N^{+} \\mid A)$$\n$$P(\\hat{P} \\mid A) = 0.92 \\times 0.45 = 0.414$$\n将其正确预测为 *Achromobacter* 的概率是其补集：\n$$P(\\hat{A} \\mid A) = 1 - P(\\hat{P} \\mid A) = 1 - 0.414 = 0.586$$\n\n对于一个真实为 *Pseudomonas* 的分离株（事件 $P$）：\n将其正确预测为 *Pseudomonas* 的概率为：\n$$P(\\hat{P} \\mid P) = P(O^{+} \\cap N^{+} \\mid P) = P(O^{+} \\mid P) \\times P(N^{+} \\mid P)$$\n$$P(\\hat{P} \\mid P) = 0.98 \\times 0.85 = 0.833$$\n将其错误分类为 *Achromobacter* 的概率是其补集：\n$$P(\\hat{A} \\mid P) = 1 - P(\\hat{P} \\mid P) = 1 - 0.833 = 0.167$$\n\n接下来，我们计算这批 $N=400$ 株分离株的期望计数。\n真实 *Achromobacter* 分离株的期望数量：$N_A = N \\times P(A) = 400 \\times 0.30 = 120$。\n真实 *Pseudomonas* 分离株的期望数量：$N_P = N \\times P(P) = 400 \\times 0.70 = 280$。\n\n混淆矩阵包含四种可能结果（真实属 vs 预测属）中每一种的期望计数。\n各个条目的计算如下：\n- **真实 *Achromobacter*，预测 *Achromobacter***（真阴性，如果将 $P$ 视为“阳性”）：\n  $E[\\text{count}(\\hat{A}, A)] = N_A \\times P(\\hat{A} \\mid A) = 120 \\times 0.586 = 70.32$\n- **真实 *Achromobacter*，预测 *Pseudomonas***（假阳性）：\n  $E[\\text{count}(\\hat{P}, A)] = N_A \\times P(\\hat{P} \\mid A) = 120 \\times 0.414 = 49.68$\n- **真实 *Pseudomonas*，预测 *Achromobacter***（假阴性）：\n  $E[\\text{count}(\\hat{A}, P)] = N_P \\times P(\\hat{A} \\mid P) = 280 \\times 0.167 = 46.76$\n- **真实 *Pseudomonas*，预测 *Pseudomonas***（真阳性）：\n  $E[\\text{count}(\\hat{P}, P)] = N_P \\times P(\\hat{P} \\mid P) = 280 \\times 0.833 = 233.24$\n\n根据要求，将条目四舍五入到三位有效数字后，构建期望混淆矩阵。行代表预测属，列代表实际属。\n$$\n\\begin{array}{ccc}\n  \\textbf{实际 } A  \\textbf{实际 } P \\\\\n\\textbf{预测 } A  70.3  46.8 \\\\\n\\textbf{预测 } P  49.7  233\n\\end{array}\n$$\n\n最后，我们计算总体误分类率。这是所有被错误分类的分离株的期望分数。被错误分类的分离株总数是未四舍五入的混淆矩阵的非对角线元素之和。\n期望误分类分离株数 = $E[\\text{count}(\\hat{P}, A)] + E[\\text{count}(\\hat{A}, P)] = 49.68 + 46.76 = 96.44$。\n总体误分类率是该数值除以分离株总数 $N$。\n$$ \\text{误分类率} = \\frac{96.44}{400} = 0.2411 $$\n\n或者，该率也可以使用全概率定律直接计算。误分类的概率 $P(\\text{misc})$ 是两种类型错误概率的总和：\n$$P(\\text{misc}) = P(\\hat{P} \\cap A) + P(\\hat{A} \\cap P)$$\n使用条件概率的定义，$P(X \\cap Y) = P(X \\mid Y)P(Y):$\n$$P(\\text{misc}) = P(\\hat{P} \\mid A)P(A) + P(\\hat{A} \\mid P)P(P)$$\n$$P(\\text{misc}) = (0.414)(0.30) + (0.167)(0.70)$$\n$$P(\\text{misc}) = 0.1242 + 0.1169 = 0.2411$$\n问题要求将此率四舍五入到四位有效数字。计算出的值 $0.2411$ 已经有四位有效数字。", "answer": "$$\n\\boxed{0.2411}\n$$", "id": "5225359"}, {"introduction": "在现实世界的微生物鉴定中，我们很少依赖单一测试。检验医师会综合多种证据，从简单的生化反应到生长特性，来做出最终判断。朴素贝叶斯分类器是一个强大的概率模型，它将这一推理过程形式化，通过结合多个独立测试的证据来计算最可能的鉴定结果。这项练习 [@problem_id:5225341] 将挑战您从零开始构建一个分类器，您将学习如何利用先验概率和多个条件概率来进行复杂的、基于证据的决策，这恰恰反映了许多自动化鉴定系统背后的核心逻辑。", "problem": "一个临床微生物学实验室寻求使用一种基于四项常规可用测试结果的分类器，来形式化对革兰氏阴性、不发酵葡萄糖的杆菌的鉴定过程。这四项测试是：氧化酶反应、在$42^{\\circ}\\mathrm{C}$下的生长情况、色素产生以及氧化-发酵试验模式。目标是区分三种常见菌属：Pseudomonas、Acinetobacter 和 Stenotrophomonas。从贝叶斯定理和条件独立性的定义出发，推导一个朴素贝叶斯分类规则，该规则结合这四个特征，用于在给定观测到的测试组合的情况下，计算每个菌属的后验概率。然后，将您推导出的规则应用于以下根据实验室处理的不发酵菌历史代表性数据集估计出的经验性先验概率和条件概率。\n\n设类别变量为 $C \\in \\{P, A, S\\}$，其中 $P$ 表示 Pseudomonas，$A$ 表示 Acinetobacter，$S$ 表示 Stenotrophomonas。特征变量为：\n- $X_1$：氧化酶反应，取值为 $\\{\\text{阳性}, \\text{阴性}\\}$。\n- $X_2$：在$42^{\\circ}\\mathrm{C}$下的生长情况，取值为 $\\{\\text{生长}, \\text{不生长}\\}$。\n- $X_3$：色素产生，取值为 $\\{\\text{有}, \\text{无}\\}$，其中色素指的是琼脂上类似绿脓菌素的生色表型。\n- $X_4$：葡萄糖的氧化-发酵(OF)试验模式，取值为 $\\{\\text{氧化型}, \\text{非利用型}, \\text{发酵型}\\}$，其中氧化-发酵试验(OF)是经典的Hugh and Leifson方法。\n\n假设先验概率如下：\n- $\\Pr(C=P) = 0.4$，$\\Pr(C=A) = 0.35$，$\\Pr(C=S) = 0.25$。\n\n假设条件概率如下：\n- 氧化酶($X_1$)：$\\Pr(X_1=\\text{阳性}\\mid C=P)=0.96$，$\\Pr(X_1=\\text{阳性}\\mid C=A)=0.04$，$\\Pr(X_1=\\text{阳性}\\mid C=S)=0.08$；在每种情况下，使用补集计算$\\text{阴性}$的概率。\n- 在$42^{\\circ}\\mathrm{C}$下生长($X_2$)：$\\Pr(X_2=\\text{生长}\\mid C=P)=0.88$，$\\Pr(X_2=\\text{生长}\\mid C=A)=0.18$，$\\Pr(X_2=\\text{生长}\\mid C=S)=0.06$；在每种情况下，使用补集计算$\\text{不生长}$的概率。\n- 色素($X_3$)：$\\Pr(X_3=\\text{有}\\mid C=P)=0.72$，$\\Pr(X_3=\\text{有}\\mid C=A)=0.02$，$\\Pr(X_3=\\text{有}\\mid C=S)=0.12$；在每种情况下，使用补集计算$\\text{无}$的概率。\n- OF模式($X_4$)：$\\Pr(X_4=\\text{氧化型}\\mid C=P)=0.93$，$\\Pr(X_4=\\text{非利用型}\\mid C=P)=0.07$，$\\Pr(X_4=\\text{发酵型}\\mid C=P)=0.00$；$\\Pr(X_4=\\text{氧化型}\\mid C=A)=0.35$，$\\Pr(X_4=\\text{非利用型}\\mid C=A)=0.65$，$\\Pr(X_4=\\text{发酵型}\\mid C=A)=0.00$；$\\Pr(X_4=\\text{氧化型}\\mid C=S)=0.89$，$\\Pr(X_4=\\text{非利用型}\\mid C=S)=0.11$，$\\Pr(X_4=\\text{发酵型}\\mid C=S)=0.00$。\n\n对于一个观测组合为 $X_1=\\text{阳性}$, $X_2=\\text{生长}$, $X_3=\\text{有}$, 和 $X_4=\\text{氧化型}$ 的分离株，计算你的朴素贝叶斯分类器得出的后验概率 $\\Pr(C=P \\mid X_1, X_2, X_3, X_4)$。以小数形式表示你的答案，并四舍五入到四位有效数字。概率无需物理单位。", "solution": "用户希望我解决这个问题。\n用户希望我扮演一位严谨、苛刻的STEM领域教授的角色。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n\n- **类别变量：** $C \\in \\{P, A, S\\}$，其中 $P$ 是 Pseudomonas，$A$ 是 Acinetobacter，$S$ 是 Stenotrophomonas。\n- **特征变量：**\n  - $X_1$：氧化酶反应 $\\in \\{\\text{阳性}, \\text{阴性}\\}$\n  - $X_2$：在 $42^{\\circ}\\mathrm{C}$ 下生长 $\\in \\{\\text{生长}, \\text{不生长}\\}$\n  - $X_3$：色素产生 $\\in \\{\\text{有}, \\text{无}\\}$\n  - $X_4$：OF试验模式 $\\in \\{\\text{氧化型}, \\text{非利用型}, \\text{发酵型}\\}$\n- **先验概率：**\n  - $\\Pr(C=P) = 0.4$\n  - $\\Pr(C=A) = 0.35$\n  - $\\Pr(C=S) = 0.25$\n- **条件概率（似然）：**\n  - 对于 $X_1$：\n    - $\\Pr(X_1=\\text{阳性}\\mid C=P)=0.96$\n    - $\\Pr(X_1=\\text{阳性}\\mid C=A)=0.04$\n    - $\\Pr(X_1=\\text{阳性}\\mid C=S)=0.08$\n  - 对于 $X_2$：\n    - $\\Pr(X_2=\\text{生长}\\mid C=P)=0.88$\n    - $\\Pr(X_2=\\text{生长}\\mid C=A)=0.18$\n    - $\\Pr(X_2=\\text{生长}\\mid C=S)=0.06$\n  - 对于 $X_3$：\n    - $\\Pr(X_3=\\text{有}\\mid C=P)=0.72$\n    - $\\Pr(X_3=\\text{有}\\mid C=A)=0.02$\n    - $\\Pr(X_3=\\text{有}\\mid C=S)=0.12$\n  - 对于 $X_4$：\n    - $\\Pr(X_4=\\text{氧化型}\\mid C=P)=0.93$, $\\Pr(X_4=\\text{非利用型}\\mid C=P)=0.07$, $\\Pr(X_4=\\text{发酵型}\\mid C=P)=0.00$\n    - $\\Pr(X_4=\\text{氧化型}\\mid C=A)=0.35$, $\\Pr(X_4=\\text{非利用型}\\mid C=A)=0.65$, $\\Pr(X_4=\\text{发酵型}\\mid C=A)=0.00$\n    - $\\Pr(X_4=\\text{氧化型}\\mid C=S)=0.89$, $\\Pr(X_4=\\text{非利用型}\\mid C=S)=0.11$, $\\Pr(X_4=\\text{发酵型}\\mid C=S)=0.00$\n- **观测数据组合：**\n  - $X_1=\\text{阳性}$, $X_2=\\text{生长}$, $X_3=\\text{有}$, $X_4=\\text{氧化型}$\n- **目标：**\n  - 推导朴素贝叶斯分类规则。\n  - 计算给定组合下 $\\Pr(C=P \\mid X_1, X_2, X_3, X_4)$ 的值，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 问题设置在真实的临床微生物学背景中。所涉及的微生物、测试和一般特性与既定的细菌学知识一致。分离株是“不发酵葡萄糖的杆菌”这一前提得到了数据的支持，因为对于所有类别 $C$，$\\Pr(X_4=\\text{发酵型} \\mid C)=0.00$。使用朴素贝叶斯进行分类是生物信息学和机器学习中的标准方法。该问题在科学上是合理的。\n2.  **适定性：** 问题要求基于一套完整的数据和一个标准的、可推导的算法进行特定计算。存在唯一解。\n3.  **客观性：** 问题使用精确、客观和定量的语言陈述。\n4.  **设置不完整或矛盾：** 问题是完整和自洽的。先验概率之和为 $1$：$0.4 + 0.35 + 0.25 = 1.0$。对于多状态特征 $X_4$，每个类别的条件概率之和也为 $1$。对于二元特征，其互补事件的概率是明确定义的。没有矛盾之处。\n5.  **不切实际或不可行：** 所提供的概率是经验确定的值，并非物理上不可能或不一致。\n6.  **不适定或结构不良：** 术语清晰，逻辑流程直接。它要求先推导后应用，这是一个标准的学术结构。\n7.  **故作高深、琐碎或同义反复：** 该问题需要多步推导和非平凡的计算，考验对概率论的理解。\n8.  **超出科学可验证范围：** 解答是数学上可推导和计算上可验证的。\n\n**步骤3：结论与行动**\n\n问题是**有效的**。将提供解答。\n\n**推导与求解**\n\n目标是推导一个朴素贝叶斯分类规则，并应用它来求后验概率 $\\Pr(C=P \\mid \\mathbf{X})$，其中 $\\mathbf{X}$ 是观测到的测试结果向量 $(X_1, X_2, X_3, X_4)$。\n\n推导始于贝叶斯定理，该定理将类别 $c_k$（来自集合 $\\{P, A, S\\}$）的后验概率与该类别的先验概率以及证据的类条件概率联系起来：\n$$ \\Pr(C=c_k \\mid \\mathbf{X}) = \\frac{\\Pr(\\mathbf{X} \\mid C=c_k) \\Pr(C=c_k)}{\\Pr(\\mathbf{X})} $$\n在这里，$\\Pr(C=c_k)$ 是类别 $c_k$ 的先验概率。$\\Pr(\\mathbf{X} \\mid C=c_k)$ 是在类别为 $c_k$ 的条件下观测到特征向量 $\\mathbf{X}$ 的似然。$\\Pr(\\mathbf{X})$ 是观测到特征向量 $\\mathbf{X}$ 的边际概率，通常称为证据。\n\n朴素贝叶斯分类器的“朴素”假设是，特征 $X_1, X_2, X_3, X_4$ 在给定类别 $C$ 的条件下是条件独立的。在数学上，这表示为：\n$$ \\Pr(\\mathbf{X} \\mid C=c_k) = \\Pr(X_1, X_2, X_3, X_4 \\mid C=c_k) = \\prod_{i=1}^{4} \\Pr(X_i \\mid C=c_k) $$\n将此独立性假设代入贝叶斯定理，得到朴素贝叶斯分类规则：\n$$ \\Pr(C=c_k \\mid \\mathbf{X}) = \\frac{\\Pr(C=c_k) \\prod_{i=1}^{4} \\Pr(X_i \\mid C=c_k)}{\\Pr(\\mathbf{X})} $$\n分母 $\\Pr(\\mathbf{X})$ 用作归一化常数，以确保所有类别的后验概率之和为 $1$。它可以通过对所有可能类别 $c_j \\in \\{P, A, S\\}$ 的未归一化后验概率（分子）求和来计算：\n$$ \\Pr(\\mathbf{X}) = \\sum_{j \\in \\{P,A,S\\}} \\Pr(\\mathbf{X} \\mid C=c_j) \\Pr(C=c_j) = \\sum_{j \\in \\{P,A,S\\}} \\left( \\Pr(C=c_j) \\prod_{i=1}^{4} \\Pr(X_i \\mid C=c_j) \\right) $$\n因此，给定类别 $c_k$ 的后验概率的完整表达式为：\n$$ \\Pr(C=c_k \\mid \\mathbf{X}) = \\frac{\\Pr(C=c_k) \\prod_{i=1}^{4} \\Pr(X_i \\mid C=c_k)}{\\sum_{j \\in \\{P,A,S\\}} \\left( \\Pr(C=c_j) \\prod_{i=1}^{4} \\Pr(X_i \\mid C=c_j) \\right)} $$\n这就是推导出的朴素贝叶斯分类规则。\n\n现在，我们将此规则应用于所给的具体案例。观测到的特征向量是 $\\mathbf{x}_{\\text{obs}} = (X_1=\\text{阳性}, X_2=\\text{生长}, X_3=\\text{有}, X_4=\\text{氧化型})$。我们需要计算 $\\Pr(C=P \\mid \\mathbf{x}_{\\text{obs}})$。\n\n为此，我们为三个类别中的每一个计算未归一化的后验概率，该值与真实后验概率成正比。我们将此量表示为 $L(C)$。\n\n对于 Pseudomonas ($C=P$)：\n$$ L(P) = \\Pr(C=P) \\times \\Pr(X_1=\\text{阳性}\\mid C=P) \\times \\Pr(X_2=\\text{生长}\\mid C=P) \\times \\Pr(X_3=\\text{有}\\mid C=P) \\times \\Pr(X_4=\\text{氧化型}\\mid C=P) $$\n$$ L(P) = 0.4 \\times 0.96 \\times 0.88 \\times 0.72 \\times 0.93 $$\n$$ L(P) = 0.225796096 $$\n\n对于 Acinetobacter ($C=A$)：\n$$ L(A) = \\Pr(C=A) \\times \\Pr(X_1=\\text{阳性}\\mid C=A) \\times \\Pr(X_2=\\text{生长}\\mid C=A) \\times \\Pr(X_3=\\text{有}\\mid C=A) \\times \\Pr(X_4=\\text{氧化型}\\mid C=A) $$\n$$ L(A) = 0.35 \\times 0.04 \\times 0.18 \\times 0.02 \\times 0.35 $$\n$$ L(A) = 0.00001764 $$\n\n对于 Stenotrophomonas ($C=S$)：\n$$ L(S) = \\Pr(C=S) \\times \\Pr(X_1=\\text{阳性}\\mid C=S) \\times \\Pr(X_2=\\text{生长}\\mid C=S) \\times \\Pr(X_3=\\text{有}\\mid C=S) \\times \\Pr(X_4=\\text{氧化型}\\mid C=S) $$\n$$ L(S) = 0.25 \\times 0.08 \\times 0.06 \\times 0.12 \\times 0.89 $$\n$$ L(S) = 0.00012816 $$\n\n归一化常数（证据）是这些值的总和：\n$$ \\Pr(\\mathbf{x}_{\\text{obs}}) = L(P) + L(A) + L(S) $$\n$$ \\Pr(\\mathbf{x}_{\\text{obs}}) = 0.225796096 + 0.00001764 + 0.00012816 = 0.225941896 $$\n\n最后，我们通过将Pseudomonas的未归一化后验概率除以证据项来计算其后验概率：\n$$ \\Pr(C=P \\mid \\mathbf{x}_{\\text{obs}}) = \\frac{L(P)}{\\Pr(\\mathbf{x}_{\\text{obs}})} $$\n$$ \\Pr(C=P \\mid \\mathbf{x}_{\\text{obs}}) = \\frac{0.225796096}{0.225941896} \\approx 0.999354714 $$\n\n问题要求答案四舍五入到四位有效数字。\n$$ \\Pr(C=P \\mid \\mathbf{x}_{\\text{obs}}) \\approx 0.9994 $$", "answer": "$$\\boxed{0.9994}$$", "id": "5225341"}]}