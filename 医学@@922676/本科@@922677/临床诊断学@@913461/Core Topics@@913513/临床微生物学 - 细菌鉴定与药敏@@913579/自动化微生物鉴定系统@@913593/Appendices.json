{"hands_on_practices": [{"introduction": "MALDI-TOF MS 技术的核心在于其极高的质量精度。然而，任何仪器都存在固有的校准误差，通常以百万分率 ($ppm$) 来衡量。本练习将引导您动手计算一个恒定的相对误差如何转化为随质量数增加而增大的绝对误差，并直接影响鉴定算法的匹配准确率。通过这个实践，您将深刻理解为何高质量范围的精确测量对于 MALDI-TOF 系统至关重要 [@problem_id:5208469]。", "problem": "一个基于基质辅助激光解吸/电离飞行时间质谱 (MALDI-TOF MS) 的自动化微生物鉴定系统会生成一个指纹图谱，该图谱由显著的离子峰组成，这些离子峰在 $[2, 20]\\,\\mathrm{kDa}$ 的质量范围内主要对应于完整的核糖体蛋白。假设如下：\n\n- 系统性质量校准误差在整个质量范围内产生一个恒定的相对质量漂移，大小为 $50\\,\\mathrm{ppm}$。根据定义，百万分率 (ppm) 误差意味着 $50 \\times 10^{-6}$ 的相对误差。\n- 如果一个峰的绝对质量偏差在 $\\pm 0.3\\,\\mathrm{Da}$ 的绝对容差窗口内，匹配算法则判定该峰与参考库正确匹配。\n- 指纹图谱中的峰在 $[2, 20]\\,\\mathrm{kDa}$ 范围内质量上呈均匀分布。\n- 将匹配准确度定义为，在 $50\\,\\mathrm{ppm}$ 系统性校准误差下，$[2, 20]\\,\\mathrm{kDa}$ 范围内满足匹配标准的峰所占的比例。\n\n仅使用以上定义和假设，计算匹配准确度，并将其表示为单个实数。将最终答案表示为无量纲小数，并四舍五入至四位有效数字。", "solution": "用户提供了一个需要解决的问题，我的首要责任是验证其完整性。\n\n### 第 1 步：提取已知条件\n问题陈述提供了以下数据和定义：\n- **质量范围：** 系统分析质量范围在 $[2, 20]\\,\\mathrm{kDa}$ 内的峰。\n- **系统误差：** 一个恒定的相对质量漂移 $\\delta = 50\\,\\mathrm{ppm}$。\n- **ppm 误差的定义：** 相对误差被明确定义为 $50 \\times 10^{-6}$。\n- **匹配标准：** 如果一个峰的绝对质量偏差在 $\\pm T$ 的容差窗口内，则认为该峰匹配，其中 $T = 0.3\\,\\mathrm{Da}$。\n- **峰分布：** 指纹图谱的峰在 $[2, 20]\\,\\mathrm{kDa}$ 区间内质量上呈均匀分布。\n- **匹配准确度的定义：** 在指定质量范围内满足匹配标准的峰的比例。\n- **要求输出：** 匹配准确度的单个实数，四舍五入至四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题进行验证检查。\n- **科学依据：** 该问题基于质谱分析的原理，特别是 MALDI-TOF MS，这是分析化学和微生物学中的一种标准技术。给定的参数——核糖体蛋白的质量范围、用于质量精度的 ppm 误差以及道尔顿水平的容差——对于此类仪器是符合实际的。该问题是一个有效（尽管简化了）的仪器性能评估模型。\n- **适定性：** 这是一个适定问题。它提供了所有必要的信息：质量范围、系统误差的性质和大小、匹配容差以及变量（质量）的分布。这使得能够计算出唯一、稳定且有意义的匹配准确度解。\n- **客观性：** 语言是技术性的，没有主观性。所有术语都进行了定量定义。\n\n该问题没有表现出任何科学上不健全、不完整、矛盾或模糊等缺陷。它是一个可以形式化的物理和统计问题。\n\n### 第 3 步：结论和行动\n该问题被判定为**有效**。我将继续提供完整解答。\n\n### 解题推导\n\n设 $m$ 为蛋白质峰的真实质量。问题陈述中感兴趣的质量范围是 $[2, 20]\\,\\mathrm{kDa}$。为了方便计算，我们使用单一的质量单位道尔顿（$\\mathrm{Da}$），其中 $1\\,\\mathrm{kDa} = 1000\\,\\mathrm{Da}$。因此，质量范围是 $[2000, 20000]\\,\\mathrm{Da}$。设该范围的下限和上限分别为 $m_{min} = 2000\\,\\mathrm{Da}$ 和 $m_{max} = 20000\\,\\mathrm{Da}$。\n\n系统引入了一个恒定的相对质量漂移 $\\delta$。给定值为 $50\\,\\mathrm{ppm}$，其定义为：\n$$ \\delta = 50 \\times 10^{-6} $$\n\n对于一个真实质量 $m$，观测到的质量 $m_{obs}$ 将会发生漂移。绝对质量偏差 $\\Delta m$ 是观测质量与真实质量之差的绝对值：\n$$ \\Delta m = |m_{obs} - m| $$\n给定相对误差 $\\delta$，观测质量为 $m_{obs} = m(1 \\pm \\delta)$。问题中的“质量漂移”措辞暗示了方向性误差，但匹配标准是基于“绝对质量偏差”，因此漂移的符号对偏差的大小无关紧要。偏差为：\n$$ \\Delta m = |m(1+\\delta) - m| = |m\\delta| $$\n由于质量 $m$ 和相对误差因子 $\\delta$ 都是正数，我们可以写成：\n$$ \\Delta m = m\\delta $$\n这个方程表明，绝对质量偏差不是恒定的，而是随质量 $m$ 线性增加。\n\n如果一个峰的绝对质量偏差在指定的容差窗口内，则该峰被正确匹配。设容差为 $T = 0.3\\,\\mathrm{Da}$。匹配标准是：\n$$ \\Delta m \\le T $$\n代入 $\\Delta m$ 的表达式，成功匹配的条件变为：\n$$ m\\delta \\le T $$\n\n这个不等式定义了峰能被正确识别的质量范围。我们可以求解满足匹配标准的最大质量，称之为 $m_{crit}$。在这个临界质量下，偏差恰好等于容差：\n$$ m_{crit}\\delta = T $$\n解出 $m_{crit}$：\n$$ m_{crit} = \\frac{T}{\\delta} $$\n代入给定值：\n$$ m_{crit} = \\frac{0.3\\,\\mathrm{Da}}{50 \\times 10^{-6}} = \\frac{0.3}{5 \\times 10^{-5}} = \\frac{3 \\times 10^{-1}}{5 \\times 10^{-5}} = 0.6 \\times 10^{4}\\,\\mathrm{Da} = 6000\\,\\mathrm{Da} $$\n\n任何质量 $m \\le m_{crit}$ 的峰都将满足匹配标准 ($m\\delta \\le T$)，而任何质量 $m  m_{crit}$ 的峰则不满足。因此，在仪器的操作范围 $[m_{min}, m_{max}]$ 内，成功匹配的峰的质量范围是 $[m_{min}, m_{crit}]$，因为 $m_{min} = 2000\\,\\mathrm{Da}  m_{crit} = 6000\\,\\mathrm{Da}$ 并且 $m_{max} = 20000\\,\\mathrm{Da}  m_{crit}$。成功匹配的具体区间是 $[2000, 6000]\\,\\mathrm{Da}$。\n\n问题将匹配准确度定义为被正确匹配的峰的比例。题目说明峰在整个 $[m_{min}, m_{max}]$ 范围内质量上呈均匀分布。对于均匀分布，这个比例等于“匹配”质量区间的长度与总质量区间长度之比。\n\n总质量区间的长度 $L_{total}$：\n$$ L_{total} = m_{max} - m_{min} = 20000\\,\\mathrm{Da} - 2000\\,\\mathrm{Da} = 18000\\,\\mathrm{Da} $$\n\n成功匹配的质量区间的长度 $L_{matched}$：\n$$ L_{matched} = m_{crit} - m_{min} = 6000\\,\\mathrm{Da} - 2000\\,\\mathrm{Da} = 4000\\,\\mathrm{Da} $$\n\n匹配准确度，我们记为 $A$，是以下比率：\n$$ A = \\frac{L_{matched}}{L_{total}} = \\frac{4000}{18000} = \\frac{4}{18} = \\frac{2}{9} $$\n\n为了给出最终答案，我们必须将此分数表示为小数，并四舍五入至四位有效数字。\n$$ A = \\frac{2}{9} = 0.22222... $$\n四舍五入至四位有效数字得到 $0.2222$。", "answer": "$$ \\boxed{0.2222} $$", "id": "5208469"}, {"introduction": "与物理测量不同，生化反应在生物学上并非总是“全或无”的。自动化生化鉴定系统正是通过概率模型来应对这种不确定性。本练习模拟了一个典型的鉴定过程，要求您应用贝叶斯定理，结合特定物种引起不同生化反应的概率（似然）和物种本身的流行率（先验概率），来计算给定一组反应结果时最可能的微生物种类 [@problem_id:5208490]。", "problem": "一个自动化微生物鉴定系统评估一组$20$个生化孔，每个孔产生一个二元反应结果$R_{i} \\in \\{0,1\\}$，其中$1$表示阳性反应，$0$表示阴性反应。假设在给定微生物物种$S \\in \\{1,2,3\\}$的条件下，各个孔是条件独立的，并且每个孔都有一个物种特异性的阳性反应概率。该鉴定引擎使用基于贝叶斯定理的最大后验 (MAP) 估计。各物种的先验概率为$P(S=1)=0.5$、$P(S=2)=0.3$和$P(S=3)=0.2$。\n\n这$20$个孔被分为四个生化特性一致的组，对于给定物种，每个组内的条件阳性概率相同：\n- $\\mathcal{C}$组 (碳水化合物利用)：孔 $1$–$5$。\n- $\\mathcal{D}$组 (氨基酸脱羧酶)：孔 $6$–$12$。\n- $\\mathcal{E}$组 (酶活性)：孔 $13$–$15$。\n- $\\mathcal{M}$组 (其他反应)：孔 $16$–$20$。\n\n对于每个物种 $s \\in \\{1,2,3\\}$ 和组 $G \\in \\{\\mathcal{C},\\mathcal{D},\\mathcal{E},\\mathcal{M}\\}$，该组中任意孔出现阳性反应的条件概率为 $p_{G|s}$，具体如下：\n- $p_{\\mathcal{C}|1}=0.9$, $p_{\\mathcal{C}|2}=0.6$, $p_{\\mathcal{C}|3}=0.3$。\n- $p_{\\mathcal{D}|1}=0.2$, $p_{\\mathcal{D}|2}=0.7$, $p_{\\mathcal{D}|3}=0.4$。\n- $p_{\\mathcal{E}|1}=0.95$, $p_{\\mathcal{E}|2}=0.5$, $p_{\\mathcal{E}|3}=0.8$。\n- $p_{\\mathcal{M}|1}=0.4$, $p_{\\mathcal{M}|2}=0.3$, $p_{\\mathcal{M}|3}=0.6$。\n\n一个样本产生了以下观察到的反应向量$\\mathbf{r}=(r_{1},\\dots,r_{20})$：\n- 孔 $1$–$5$：$\\{1,1,1,1,0\\}$。\n- 孔 $6$–$12$：$\\{1,0,0,1,0,0,0\\}$。\n- 孔 $13$–$15$：$\\{1,1,1\\}$。\n- 孔 $16$–$20$：$\\{0,0,0,1,0\\}$。\n\n使用贝叶斯定理和各孔之间条件独立的假设，计算最大后验物种归属。将最终答案表示为物种索引 $s^{*} \\in \\{1,2,3\\}$。无需四舍五入。", "solution": "该问题要求对于一组给定的生化反应结果，确定其最大后验 (MAP) 物种归属。物种 $S$ 的最大后验估计 $s^{*}$ 是使后验概率 $P(S=s | \\mathbf{R}=\\mathbf{r})$ 最大化的 $s \\in \\{1,2,3\\}$ 的值，其中 $\\mathbf{r}$ 是观察到的反应向量。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$\nP(S=s | \\mathbf{R}=\\mathbf{r}) = \\frac{P(\\mathbf{R}=\\mathbf{r} | S=s) P(S=s)}{P(\\mathbf{R}=\\mathbf{r})}\n$$\n分母 $P(\\mathbf{R}=\\mathbf{r})$ 是观察到数据的边际概率，对于所有物种 $s$ 都是一个常数。因此，为了找到使后验概率最大化的物种，我们只需要最大化分子，它与后验概率成正比。让我们为每个物种 $s$ 定义一个分数 $\\text{Score}(s)$，即这个分子：\n$$\n\\text{Score}(s) = P(\\mathbf{R}=\\mathbf{r} | S=s) P(S=s)\n$$\n那么，最大后验估计为 $s^{*} = \\arg\\max_{s \\in \\{1,2,3\\}} \\text{Score}(s)$。\n\n项 $P(\\mathbf{R}=\\mathbf{r} | S=s)$ 是在给定物种 $s$ 的条件下观察到反应向量 $\\mathbf{r}$ 的似然。问题陈述，在给定物种 $S$ 的条件下，这$20$个生化孔是条件独立的。因此，似然是各个反应结果概率的乘积：\n$$\nP(\\mathbf{R}=\\mathbf{r} | S=s) = \\prod_{i=1}^{20} P(R_i=r_i | S=s)\n$$\n这些孔被分为四组，$\\mathcal{C}、 \\mathcal{D}、 \\mathcal{E}、 \\mathcal{M}$，其大小分别为 $n_{\\mathcal{C}}=5$、$n_{\\mathcal{D}}=7$、$n_{\\mathcal{E}}=3$ 和 $n_{\\mathcal{M}}=5$。在每个组 $G$ 内部，阳性反应的条件概率 $P(R_i=1 | S=s)$ 是恒定的，记为 $p_{G|s}$。阴性反应的概率为 $P(R_i=0 | S=s) = 1 - p_{G|s}$。\n\n设 $k_G$ 为在组 $G$ 中观察到的阳性反应数。组 $G$ 对总似然的贡献是 $p_{G|s}^{k_G} (1 - p_{G|s})^{n_G - k_G}$。总似然 $L(s) = P(\\mathbf{R}=\\mathbf{r} | S=s)$ 是这些贡献的乘积：\n$$\nL(s) = \\left( p_{\\mathcal{C}|s}^{k_{\\mathcal{C}}} (1-p_{\\mathcal{C}|s})^{n_{\\mathcal{C}} - k_{\\mathcal{C}}} \\right) \\left( p_{\\mathcal{D}|s}^{k_{\\mathcal{D}}} (1-p_{\\mathcal{D}|s})^{n_{\\mathcal{D}} - k_{\\mathcal{D}}} \\right) \\left( p_{\\mathcal{E}|s}^{k_{\\mathcal{E}}} (1-p_{\\mathcal{E}|s})^{n_{\\mathcal{E}} - k_{\\mathcal{E}}} \\right) \\left( p_{\\mathcal{M}|s}^{k_{\\mathcal{M}}} (1-p_{\\mathcal{M}|s})^{n_{\\mathcal{M}} - k_{\\mathcal{M}}} \\right)\n$$\n根据观察到的反应向量 $\\mathbf{r}$：\n-   $\\mathcal{C}$组 (孔 $1$–$5$)：$\\{1,1,1,1,0\\}$。因此，$k_{\\mathcal{C}}=4$ 且 $n_{\\mathcal{C}}-k_{\\mathcal{C}}=1$。\n-   $\\mathcal{D}$组 (孔 $6$–$12$)：$\\{1,0,0,1,0,0,0\\}$。因此，$k_{\\mathcal{D}}=2$ 且 $n_{\\mathcal{D}}-k_{\\mathcal{D}}=5$。\n-   $\\mathcal{E}$组 (孔 $13$–$15$)：$\\{1,1,1\\}$。因此，$k_{\\mathcal{E}}=3$ 且 $n_{\\mathcal{E}}-k_{\\mathcal{E}}=0$。\n-   $\\mathcal{M}$组 (孔 $16$–$20$)：$\\{0,0,0,1,0\\}$。因此，$k_{\\mathcal{M}}=1$ 且 $n_{\\mathcal{M}}-k_{\\mathcal{M}}=4$。\n\n我们现在计算每个物种的分数。\n\n对于物种 $S=1$：\n先验概率为 $P(S=1)=0.5$。条件概率为 $p_{\\mathcal{C}|1}=0.9$、$p_{\\mathcal{D}|1}=0.2$、$p_{\\mathcal{E}|1}=0.95$ 和 $p_{\\mathcal{M}|1}=0.4$。\n似然为：\n$L(1) = (0.9^{4} \\cdot (1-0.9)^{1}) \\cdot (0.2^{2} \\cdot (1-0.2)^{5}) \\cdot (0.95^{3} \\cdot (1-0.95)^{0}) \\cdot (0.4^{1} \\cdot (1-0.4)^{4})$\n$L(1) = (0.9^{4} \\cdot 0.1^{1}) \\cdot (0.2^{2} \\cdot 0.8^{5}) \\cdot (0.95^{3} \\cdot 0.05^{0}) \\cdot (0.4^{1} \\cdot 0.6^{4})$\n$L(1) = (0.6561 \\cdot 0.1) \\cdot (0.04 \\cdot 0.32768) \\cdot (0.857375 \\cdot 1) \\cdot (0.4 \\cdot 0.1296)$\n$L(1) = (0.06561) \\cdot (0.0131072) \\cdot (0.857375) \\cdot (0.05184)$\n$L(1) \\approx 3.82216 \\times 10^{-5}$\n分数为：\n$\\text{Score}(1) = L(1) \\cdot P(S=1) \\approx (3.82216 \\times 10^{-5}) \\cdot 0.5 = 1.91108 \\times 10^{-5}$\n\n对于物种 $S=2$：\n先验概率为 $P(S=2)=0.3$。条件概率为 $p_{\\mathcal{C}|2}=0.6$、$p_{\\mathcal{D}|2}=0.7$、$p_{\\mathcal{E}|2}=0.5$ 和 $p_{\\mathcal{M}|2}=0.3$。\n似然为：\n$L(2) = (0.6^{4} \\cdot (1-0.6)^{1}) \\cdot (0.7^{2} \\cdot (1-0.7)^{5}) \\cdot (0.5^{3} \\cdot (1-0.5)^{0}) \\cdot (0.3^{1} \\cdot (1-0.3)^{4})$\n$L(2) = (0.6^{4} \\cdot 0.4^{1}) \\cdot (0.7^{2} \\cdot 0.3^{5}) \\cdot (0.5^{3} \\cdot 0.5^{0}) \\cdot (0.3^{1} \\cdot 0.7^{4})$\n$L(2) = (0.1296 \\cdot 0.4) \\cdot (0.49 \\cdot 0.00243) \\cdot (0.125 \\cdot 1) \\cdot (0.3 \\cdot 0.2401)$\n$L(2) = (0.05184) \\cdot (0.0011907) \\cdot (0.125) \\cdot (0.07203)$\n$L(2) \\approx 5.55806 \\times 10^{-7}$\n分数为：\n$\\text{Score}(2) = L(2) \\cdot P(S=2) \\approx (5.55806 \\times 10^{-7}) \\cdot 0.3 = 1.66742 \\times 10^{-7}$\n\n对于物种 $S=3$：\n先验概率为 $P(S=3)=0.2$。条件概率为 $p_{\\mathcal{C}|3}=0.3$、$p_{\\mathcal{D}|3}=0.4$、$p_{\\mathcal{E}|3}=0.8$ 和 $p_{\\mathcal{M}|3}=0.6$。\n似然为：\n$L(3) = (0.3^{4} \\cdot (1-0.3)^{1}) \\cdot (0.4^{2} \\cdot (1-0.4)^{5}) \\cdot (0.8^{3} \\cdot (1-0.8)^{0}) \\cdot (0.6^{1} \\cdot (1-0.6)^{4})$\n$L(3) = (0.3^{4} \\cdot 0.7^{1}) \\cdot (0.4^{2} \\cdot 0.6^{5}) \\cdot (0.8^{3} \\cdot 0.2^{0}) \\cdot (0.6^{1} \\cdot 0.4^{4})$\n$L(3) = (0.0081 \\cdot 0.7) \\cdot (0.16 \\cdot 0.07776) \\cdot (0.512 \\cdot 1) \\cdot (0.6 \\cdot 0.0256)$\n$L(3) = (0.00567) \\cdot (0.0124416) \\cdot (0.512) \\cdot (0.01536)$\n$L(3) \\approx 5.54755 \\times 10^{-7}$\n分数为：\n$\\text{Score}(3) = L(3) \\cdot P(S=3) \\approx (5.54755 \\times 10^{-7}) \\cdot 0.2 = 1.10951 \\times 10^{-7}$\n\n比较分数：\n$\\text{Score}(1) \\approx 1.91108 \\times 10^{-5}$\n$\\text{Score}(2) \\approx 1.66742 \\times 10^{-7}$\n$\\text{Score}(3) \\approx 1.10951 \\times 10^{-7}$\n\n由于 $1.91108 \\times 10^{-5}$ 是最大值，物种 $s=1$ 的分数最高。\n因此，最大后验物种归属为 $s^{*}=1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "5208490"}, {"introduction": "在临床实践中，鉴定系统的“准确性”并非一个简单的数字，其评估与报告策略密切相关。当系统难以区分亲缘关系极近的物种时，实验室可能会选择报告到更高级别的“属”水平。本练习将让您通过计算精确率、召回率和 $F_1$-分数等关键性能指标，来量化这种报告策略的改变对系统整体性能评估的影响，从而理解诊断精确性与临床实用性之间的权衡 [@problem_id:5208465]。", "problem": "一个临床微生物学实验室正在评估一个自动化微生物鉴定系统（例如，基质辅助激光解吸/电离飞行时间（MALDI-TOF）质谱法），该系统用于鉴定属于两个属的四种临床相关物种。每个分离株仅属于一个真实物种，且该系统对每个分离株仅输出一个预测物种。测试集包含每种物种的 $100$ 个分离株。物种及其所属的属如下：\n- A属：物种 $A_1$ 和物种 $A_2$。\n- B属：物种 $B_1$ 和物种 $B_2$。\n\n观察到的物种级别结果（行是真实物种；值为预测为各个物种的分离株数量）如下：\n- 真实 $A_1$：预测 $A_1$ 为 $40$，$A_2$ 为 $50$，$B_1$ 为 $7$，$B_2$ 为 $3$。\n- 真实 $A_2$：预测 $A_1$ 为 $45$，$A_2$ 为 $42$，$B_1$ 为 $8$，$B_2$ 为 $5$。\n- 真实 $B_1$：预测 $A_1$ 为 $6$，$A_2$ 为 $4$，$B_1$ 为 $52$，$B_2$ 为 $38$。\n- 真实 $B_2$：预测 $A_1$ 为 $3$，$A_2$ 为 $7$，$B_1$ 为 $41$，$B_2$ 为 $49$。\n\n在属级别报告时，实验室通过将属于同一属的物种相加，从而将真实标签和预测结果都合并到属级别（也就是说，对 $A_1$ 或 $A_2$ 的预测被视为A属；对 $B_1$ 或 $B_2$ 的预测被视为B属）。\n\n仅使用多类别单标签分类中精确率、召回率和F$_1$分数的基本定义，计算从物种级别报告切换到属级别报告时，宏平均F$_1$分数的绝对变化。此处，宏平均F$_1$分数是在该报告级别下所有类别的F$_1$分数的算术平均值。将最终结果表示为十进制数，并四舍五入到四位有效数字。答案中请勿包含任何单位。", "solution": "这个问题是有效的，因为它具有科学依据、问题明确、客观，并包含得出唯一解所需的所有信息。我们将首先计算物种级别的宏平均F$_1$分数，然后计算属级别的宏平均F$_1$分数，最后计算这两个分数之间的绝对差值来解决这个问题。\n\n给定类别 $i$ 的性能指标定义如下：\n精确率 (Precision): $P_i = \\frac{TP_i}{TP_i + FP_i}$\n召回率 (Recall): $R_i = \\frac{TP_i}{TP_i + FN_i}$\nF$_1$分数 (F$_1$-score): $F_{1,i} = 2 \\cdot \\frac{P_i \\cdot R_i}{P_i + R_i}$\n其中 $TP_i$ 是类别 $i$ 的真阳性数量，$FP_i$ 是假阳性数量，$FN_i$ 是假阴性数量。宏平均F$_1$分数是所有类别F$_1$分数的算术平均值。\n\n物种级别的结果可以用一个 $4 \\times 4$ 的混淆矩阵 $C_S$ 来表示，其中行是真实物种，列是预测物种。类别为 $A_1$、$A_2$、$B_1$ 和 $B_2$。\n$$ C_S = \\begin{pmatrix} 40  50  7  3 \\\\ 45  42  8  5 \\\\ 6  4  52  38 \\\\ 3  7  41  49 \\end{pmatrix} $$\n每个真实物种的分离株数量为 $100$。\n\n首先，我们计算物种级别的宏平均F$_1$分数（$F_{1,\\text{species}}$）。\n\n对于物种 $A_1$：\n$TP_{A_1} = 40$\n$FP_{A_1} = 45 + 6 + 3 = 54$\n$FN_{A_1} = 50 + 7 + 3 = 60$\n$P_{A_1} = \\frac{40}{40 + 54} = \\frac{40}{94}$\n$R_{A_1} = \\frac{40}{40 + 60} = \\frac{40}{100}$\n$F_{1, A_1} = 2 \\cdot \\frac{\\frac{40}{94} \\cdot \\frac{40}{100}}{\\frac{40}{94} + \\frac{40}{100}} = \\frac{2 \\cdot 40}{94 + 100} = \\frac{80}{194} = \\frac{40}{97}$\n\n对于物种 $A_2$：\n$TP_{A_2} = 42$\n$FP_{A_2} = 50 + 4 + 7 = 61$\n$FN_{A_2} = 45 + 8 + 5 = 58$\n$P_{A_2} = \\frac{42}{42 + 61} = \\frac{42}{103}$\n$R_{A_2} = \\frac{42}{42 + 58} = \\frac{42}{100}$\n$F_{1, A_2} = 2 \\cdot \\frac{\\frac{42}{103} \\cdot \\frac{42}{100}}{\\frac{42}{103} + \\frac{42}{100}} = \\frac{2 \\cdot 42}{103 + 100} = \\frac{84}{203} = \\frac{12}{29}$\n\n对于物种 $B_1$：\n$TP_{B_1} = 52$\n$FP_{B_1} = 7 + 8 + 41 = 56$\n$FN_{B_1} = 6 + 4 + 38 = 48$\n$P_{B_1} = \\frac{52}{52 + 56} = \\frac{52}{108}$\n$R_{B_1} = \\frac{52}{52 + 48} = \\frac{52}{100}$\n$F_{1, B_1} = 2 \\cdot \\frac{\\frac{52}{108} \\cdot \\frac{52}{100}}{\\frac{52}{108} + \\frac{52}{100}} = \\frac{2 \\cdot 52}{108 + 100} = \\frac{104}{208} = \\frac{1}{2}$\n\n对于物种 $B_2$：\n$TP_{B_2} = 49$\n$FP_{B_2} = 3 + 5 + 38 = 46$\n$FN_{B_2} = 3 + 7 + 41 = 51$\n$P_{B_2} = \\frac{49}{49 + 46} = \\frac{49}{95}$\n$R_{B_2} = \\frac{49}{49 + 51} = \\frac{49}{100}$\n$F_{1, B_2} = 2 \\cdot \\frac{\\frac{49}{95} \\cdot \\frac{49}{100}}{\\frac{49}{95} + \\frac{49}{100}} = \\frac{2 \\cdot 49}{95 + 100} = \\frac{98}{195}$\n\n物种的宏平均F$_1$分数是这四个分数的平均值：\n$F_{1,\\text{species}} = \\frac{1}{4} (F_{1, A_1} + F_{1, A_2} + F_{1, B_1} + F_{1, B_2})$\n$F_{1,\\text{species}} = \\frac{1}{4} \\left(\\frac{40}{97} + \\frac{12}{29} + \\frac{1}{2} + \\frac{98}{195}\\right)$\n使用小数近似值：\n$F_{1,\\text{species}} \\approx \\frac{1}{4} (0.412371 + 0.413793 + 0.5 + 0.502564) = \\frac{1}{4}(1.828728) = 0.457182$\n\n接下来，我们计算属级别的宏平均F$_1$分数（$F_{1,\\text{genus}}$）。我们将 $4 \\times 4$ 的矩阵 $C_S$ 合并为针对A属和B属的 $2 \\times 2$ 矩阵 $C_G$。\n\n属级别混淆矩阵 $C_G$ 的计数如下：\n$N(\\text{真实A, 预测A}) = 40 + 50 + 45 + 42 = 177$\n$N(\\text{真实A, 预测B}) = 7 + 3 + 8 + 5 = 23$\n$N(\\text{真实B, 预测A}) = 6 + 4 + 3 + 7 = 20$\n$N(\\text{真实B, 预测B}) = 52 + 38 + 41 + 49 = 180$\n\n得到的 $2 \\times 2$ 混淆矩阵 $C_G$ 如下：\n$$ C_G = \\begin{pmatrix} 177  23 \\\\ 20  180 \\end{pmatrix} $$\n\n对于A属：\n$TP_A = 177$\n$FP_A = 20$\n$FN_A = 23$\n$P_A = \\frac{177}{177+20} = \\frac{177}{197}$\n$R_A = \\frac{177}{177+23} = \\frac{177}{200}$\n$F_{1, A} = 2 \\cdot \\frac{\\frac{177}{197} \\cdot \\frac{177}{200}}{\\frac{177}{197} + \\frac{177}{200}} = \\frac{2 \\cdot 177}{197+200} = \\frac{354}{397}$\n\n对于B属：\n$TP_B = 180$\n$FP_B = 23$\n$FN_B = 20$\n$P_B = \\frac{180}{180+23} = \\frac{180}{203}$\n$R_B = \\frac{180}{180+20} = \\frac{180}{200}$\n$F_{1, B} = 2 \\cdot \\frac{\\frac{180}{203} \\cdot \\frac{180}{200}}{\\frac{180}{203} + \\frac{180}{200}} = \\frac{2 \\cdot 180}{203+200} = \\frac{360}{403}$\n\n属的宏平均F$_1$分数是这两个分数的平均值：\n$F_{1,\\text{genus}} = \\frac{1}{2} (F_{1, A} + F_{1, B}) = \\frac{1}{2}\\left(\\frac{354}{397} + \\frac{360}{403}\\right)$\n使用小数近似值：\n$F_{1,\\text{genus}} \\approx \\frac{1}{2}(0.891688 + 0.893300) = \\frac{1}{2}(1.784988) = 0.892494$\n\n最后，我们计算宏平均F$_1$分数的绝对变化：\n$|\\Delta F_1| = |F_{1,\\text{genus}} - F_{1,\\text{species}}|$\n$|\\Delta F_1| \\approx |0.892494 - 0.457182| = 0.435312$\n\n将结果四舍五入到四位有效数字，得到 $0.4353$。", "answer": "$$\\boxed{0.4353}$$", "id": "5208465"}]}