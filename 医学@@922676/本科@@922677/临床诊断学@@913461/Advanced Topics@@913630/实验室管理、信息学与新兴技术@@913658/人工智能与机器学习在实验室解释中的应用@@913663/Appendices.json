{"hands_on_practices": [{"introduction": "机器学习分类器通常输出一个连续的风险评分，而临床决策往往需要一个明确的“阳性”或“阴性”判断。这就要求我们选择一个最佳的决策阈值，以平衡诊断的敏感性与特异性。本练习将指导您应用约登指数（Youden's Index）来确定最佳阈值，并批判性地思考其在真实临床情境中的适用性与局限性。[@problem_id:5207994]", "problem": "一家医院的实验室正在试用一种人工智能（AI）和机器学习（ML）分类器，以辅助临床解读急性肾损伤的连续实验室风险评分。在一个前瞻性验证队列中，有 $N^{+} = 120$ 名确诊患者和 $N^{-} = 180$ 名非患病者。该分类器输出一个在 $[0,1]$ 范围内的校准风险评分，并通过一个决策阈值 $t$ 将评分转换为二元的阳性/阴性结果。\n\n对于每个候选阈值 $t \\in \\{0.30, 0.50, 0.70, 0.85\\}$，在患病（$N^{+}$）和非患病（$N^{-}$）组中被预测为阳性（即分类器输出 $\\geq t$）的患者数量记录如下：\n- 当 $t = 0.30$ 时：患病者中预测为阳性的人数 = 110；非患病者中预测为阳性的人数 = 70。\n- 当 $t = 0.50$ 时：患病者中预测为阳性的人数 = 96；非患病者中预测为阳性的人数 = 36。\n- 当 $t = 0.70$ 时：患病者中预测为阳性的人数 = 80；非患病者中预测为阳性的人数 = 20。\n- 当 $t = 0.85$ 时：患病者中预测为阳性的人数 = 60；非患病者中预测为阳性的人数 = 10。\n\n仅使用混淆矩阵中灵敏度和特异度的基本定义，计算每个阈值 $t$ 对应的灵敏度 $Se(t)$ 和特异度 $Sp(t)$，然后根据这些值计算约登指数 $J(t)$。找出使 $J(t)$ 最大化的单个阈值 $t$。在您的推理中，阐明在何种假设下最大化 $J(t)$ 适用于实验室诊断中的临床决策，并解释该标准在实践中至少存在的两个局限性。\n\n将使 $J(t)$ 最大化的阈值 $t$ 的值作为最终答案。不要包含任何单位。如果您的计算得出精确的小数值，请不要四舍五入。", "solution": "该问题要求在四个不同的决策阈值下评估一个用于急性肾损伤的机器学习分类器。我们必须首先验证问题陈述的有效性。\n\n已知条件如下：\n- 确诊患病患者数（阳性）：$N^{+} = 120$。\n- 未患病患者数（阴性）：$N^{-} = 180$。\n- 候选决策阈值集合：$t \\in \\{0.30, 0.50, 0.70, 0.85\\}$。\n- 每个阈值下的真阳性（$TP$）和假阳性（$FP$）数量：\n  - 对于 $t = 0.30$：$TP(0.30) = 110$, $FP(0.30) = 70$。\n  - 对于 $t = 0.50$：$TP(0.50) = 96$, $FP(0.50) = 36$。\n  - 对于 $t = 0.70$：$TP(0.70) = 80$, $FP(0.70) = 20$。\n  - 对于 $t = 0.85$：$TP(0.85) = 60$, $FP(0.85) = 10$。\n\n该问题具有科学依据，提法明确，客观，并包含完整且一致的数据。它使用了诊断医学和统计学中的标准度量指标。每个类别中预测为阳性的数量没有超过该类别的总数。此外，随着阈值 $t$ 的增加，被分类为阳性的样本数（包括 $TP$ 和 $FP$）非递增，这是基于阈值的分类器的一个必要属性。因此，该问题被认为是有效的。\n\n我们首先根据混淆矩阵定义必要的性能度量指标，然后继续求解。对于给定的阈值 $t$，混淆矩阵的元素如下：\n- 真阳性（$TP(t)$）：患病且被正确分类为阳性的患者。\n- 假阳性（$FP(t)$）：未患病但被错误分类为阳性的患者。\n- 假阴性（$FN(t)$）：患病但被错误分类为阴性的患者。\n- 真阴性（$TN(t)$）：未患病且被正确分类为阴性的患者。\n\n患病和非患病患者的总数分别为 $N^{+} = TP(t) + FN(t)$ 和 $N^{-} = FP(t) + TN(t)$。由此，我们可以计算出 $FN(t) = N^{+} - TP(t)$ 和 $TN(t) = N^{-} - FP(t)$。\n\n主要度量指标定义如下：\n- 灵敏度（$Se(t)$），或称真阳性率：被正确识别的患病患者的比例。\n$$Se(t) = \\frac{TP(t)}{N^{+}} = \\frac{TP(t)}{TP(t) + FN(t)}$$\n- 特异度（$Sp(t)$），或称真阴性率：被正确识别的非患病患者的比例。\n$$Sp(t) = \\frac{TN(t)}{N^{-}} = \\frac{TN(t)}{TN(t) + FP(t)}$$\n- 约登指数（$J(t)$），或称约登J统计量：一个概括诊断测试能力的度量指标。它是灵敏度与特异度之和减一。\n$$J(t) = Se(t) + Sp(t) - 1$$\n我们现在为每个给定的阈值计算这些值。\n\n对于 $t = 0.30$：\n- 已知：$TP(0.30) = 110$, $FP(0.30) = 70$。\n- $FN(0.30) = N^{+} - TP(0.30) = 120 - 110 = 10$。\n- $TN(0.30) = N^{-} - FP(0.30) = 180 - 70 = 110$。\n- $Se(0.30) = \\frac{110}{120} = \\frac{11}{12}$。\n- $Sp(0.30) = \\frac{110}{180} = \\frac{11}{18}$。\n- $J(0.30) = \\frac{11}{12} + \\frac{11}{18} - 1 = \\frac{33 + 22}{36} - 1 = \\frac{55}{36} - \\frac{36}{36} = \\frac{19}{36}$。\n\n对于 $t = 0.50$：\n- 已知：$TP(0.50) = 96$, $FP(0.50) = 36$。\n- $FN(0.50) = N^{+} - TP(0.50) = 120 - 96 = 24$。\n- $TN(0.50) = N^{-} - FP(0.50) = 180 - 36 = 144$。\n- $Se(0.50) = \\frac{96}{120} = \\frac{4 \\times 24}{5 \\times 24} = \\frac{4}{5}$。\n- $Sp(0.50) = \\frac{144}{180} = \\frac{4 \\times 36}{5 \\times 36} = \\frac{4}{5}$。\n- $J(0.50) = \\frac{4}{5} + \\frac{4}{5} - 1 = \\frac{8}{5} - 1 = \\frac{3}{5}$。\n\n对于 $t = 0.70$：\n- 已知：$TP(0.70) = 80$, $FP(0.70) = 20$。\n- $FN(0.70) = N^{+} - TP(0.70) = 120 - 80 = 40$。\n- $TN(0.70) = N^{-} - FP(0.70) = 180 - 20 = 160$。\n- $Se(0.70) = \\frac{80}{120} = \\frac{2}{3}$。\n- $Sp(0.70) = \\frac{160}{180} = \\frac{8}{9}$。\n- $J(0.70) = \\frac{2}{3} + \\frac{8}{9} - 1 = \\frac{6 + 8}{9} - 1 = \\frac{14}{9} - \\frac{9}{9} = \\frac{5}{9}$。\n\n对于 $t = 0.85$：\n- 已知：$TP(0.85) = 60$, $FP(0.85) = 10$。\n- $FN(0.85) = N^{+} - TP(0.85) = 120 - 60 = 60$。\n- $TN(0.85) = N^{-} - FP(0.85) = 180 - 10 = 170$。\n- $Se(0.85) = \\frac{60}{120} = \\frac{1}{2}$。\n- $Sp(0.85) = \\frac{170}{180} = \\frac{17}{18}$。\n- $J(0.85) = \\frac{1}{2} + \\frac{17}{18} - 1 = \\frac{9 + 17}{18} - 1 = \\frac{26}{18} - \\frac{18}{18} = \\frac{8}{18} = \\frac{4}{9}$。\n\n现在，我们比较 $J(t)$ 的值来找到最大值。为了便于比较，我们将分数转换为公分母为 $180$ 的形式：\n- $J(0.30) = \\frac{19}{36} = \\frac{19 \\times 5}{36 \\times 5} = \\frac{95}{180}$。\n- $J(0.50) = \\frac{3}{5} = \\frac{3 \\times 36}{5 \\times 36} = \\frac{108}{180}$。\n- $J(0.70) = \\frac{5}{9} = \\frac{5 \\times 20}{9 \\times 20} = \\frac{100}{180}$。\n- $J(0.85) = \\frac{4}{9} = \\frac{4 \\times 20}{9 \\times 20} = \\frac{80}{180}$。\n\n比较分子（$80, 95, 100, 108$），约登指数的最大值是 $J(0.50) = \\frac{108}{180} = \\frac{3}{5}$。因此，使 $J(t)$ 最大化的阈值是 $t=0.50$。\n\n关于假设和局限性的讨论：\n\n在临床决策中，最大化约登指数 $J(t) = Se(t) + Sp(t) - 1$ 的做法是在一个关键假设下是合适的：即当灵敏度和特异度被赋予同等权重时，该测试的效用最大化。这意味着与假阴性（漏诊一个真实病例）相关的成本或危害被认为与假阳性（将健康个体错误地标记为患病）的成本或危害相等。因此，当目标是最大化被正确分类的患者总数（包括患病和非患病者），而不优先考虑某一种类型的错误时，该标准是最佳的。\n\n然而，这种方法在临床实践中至少存在两个显著的局限性：\n1.  **错误分类成本相等的假设：** 假阴性和假阳性具有相同后果的核心假设在医学上很少成立。对于像急性肾损伤这样的严重疾病，一个假阴性（$FN$）可能导致治疗延误或错失，从而导致严重的并发症（例如，发展为慢性肾脏病，需要透析）或死亡。而一个假阳性（$FP$），虽然会引起患者焦虑，并可能导致不必要的后续检查和费用，但其相关的危害通常要低得多。如果一个 $FN$ 的成本远高于一个 $FP$ 的成本，那么通过最大化约登指数选择的阈值可能是次优的，甚至是危险的。明确地对这些不同成本进行建模的决策分析方法通常更为合适。\n2.  **独立于疾病患病率：** 约登指数是根据灵敏度和特异度计算的，这两者是测试的内在属性，与被测人群中的疾病患病率无关。然而，用于临床应用的最佳决策阈值*应该*受到患病率的影响。例如，在低患病率的环境中，即使是特异度很高的测试也会产生大量的假阳性，导致阳性预测值（$PPV$）较低。因此，临床医生可能更倾向于使用更高的阈值来提高特异度并改善 $PPV$。相反，在高患病率的环境中，为了最大化灵敏度，较低的阈值可能是可以接受的。约登指数没有考虑这种背景，它所确定的阈值可能无法在特定的目标人群中优化测试的效用。\n\n总而言之，尽管最大化约登指数在数学上很简单，但它脱离了具体情境，并且常常无法反映临床决策中固有的复杂权衡。", "answer": "$$\\boxed{0.50}$$", "id": "5207994"}, {"introduction": "在医学诊断中，尤其是在罕见病筛查等场景下，数据不平衡是普遍现象。在这种情况下，传统的ROC曲线下面积（ROC AUC）可能会给出过于乐观的评估，从而误导决策。本练习将介绍一种更适合评估不平衡数据的指标——精确率-召回率曲线下面积（PR AUC），并带您通过计算和理论分析，理解其为何在罕见病筛查中更具信息价值。[@problem_id:5207923]", "problem": "一个临床实验室正在验证一个用于在转诊人群中筛查一种罕见自身抗体的机器学习分类器，该人群的疾病患病率为 $\\pi = 0.02$。该模型输出连续的分数，通过设定阈值来产生二元判决。从一个内部验证集中，通过扫描决策阈值获得了以下精确率-召回率工作点（按召回率 $R$ 递增的顺序列出，以召回率 $R$ 和精确率 $P$ 的有序对报告）：\n- $(R,P) = (0, 1.0)$\n- $(R,P) = (0.10, 0.60)$\n- $(R,P) = (0.30, 0.50)$\n- $(R,P) = (0.55, 0.40)$\n- $(R,P) = (0.80, 0.30)$\n- $(R,P) = (1.00, 0.20)$\n\n假设在每对连续点之间，精确率-召回率曲线作为 $R$ 的函数 $P(R)$ 在 $R \\in [0,1]$ 上是线性插值的，并采用精确率-召回率曲线下面积的标准定义，即 $P(R)$ 对 $R$ 在 $[0,1]$ 上的积分。\n\n任务：\n1. 仅使用以上信息，计算精确率-召回率曲线下面积 (PR AUC)。答案以四位有效数字的小数形式给出。\n2. 使用诊断测试指标的基本原理，简要说明为什么在 $\\pi$ 很小的情况下，对于罕见病筛查，精确率-召回率曲线下面积 (PR AUC) 比受试者工作特征曲线下面积 (ROC AUC) 更具信息量。此论证无需计算；请基于精确率、召回率、假阳性率的定义以及患病率在后验概率中的作用进行推理。\n\n第1部分只对数值进行评分；请以纯数字形式表示，不带百分号或单位。", "solution": "该问题已经过验证，被认为是可靠、提法得当且客观的。它基于机器学习模型评估的既定原则，并为提供完整解决方案提供了所有必要信息。\n\n该问题要求完成两项任务：首先，根据给定的一组工作点计算精确率-召回率曲线下面积 (PR AUC)；其次，为在罕见病筛查背景下 PR AUC 相较于 ROC AUC 的效用提供概念性论证。\n\n**第1部分：计算精确率-召回率曲线下面积 (PR AUC)**\n\n问题指明，精确率-召回率曲线（表示为函数 $P(R)$）是通过在一组给定的工作点 $(R_i, P_i)$ 之间进行线性插值形成的。曲线下面积 (AUC) 定义为积分 $\\int_0^1 P(R) dR$。通过分段线性插值，该积分可以通过将每对连续点之间形成的梯形面积相加来计算。\n\n给定的工作点是：\n- $(R_0, P_0) = (0, 1.0)$\n- $(R_1, P_1) = (0.10, 0.60)$\n- $(R_2, P_2) = (0.30, 0.50)$\n- $(R_3, P_3) = (0.55, 0.40)$\n- $(R_4, P_4) = (0.80, 0.30)$\n- $(R_5, P_5) = (1.00, 0.20)$\n\n点 $(R_i, P_i)$ 和 $(R_{i+1}, P_{i+1})$ 之间的梯形面积由以下公式给出：\n$$ A_i = \\frac{1}{2} (P_i + P_{i+1}) (R_{i+1} - R_i) $$\n\n我们计算由这六个点定义的五个线段中每一段的面积：\n\n第1段：从 $(0, 1.0)$ 到 $(0.10, 0.60)$\n$$ A_1 = \\frac{1}{2} (1.0 + 0.60) (0.10 - 0) = \\frac{1}{2} (1.60)(0.10) = 0.08 $$\n\n第2段：从 $(0.10, 0.60)$ 到 $(0.30, 0.50)$\n$$ A_2 = \\frac{1}{2} (0.60 + 0.50) (0.30 - 0.10) = \\frac{1}{2} (1.10)(0.20) = 0.11 $$\n\n第3段：从 $(0.30, 0.50)$ 到 $(0.55, 0.40)$\n$$ A_3 = \\frac{1}{2} (0.50 + 0.40) (0.55 - 0.30) = \\frac{1}{2} (0.90)(0.25) = 0.1125 $$\n\n第4段：从 $(0.55, 0.40)$ 到 $(0.80, 0.30)$\n$$ A_4 = \\frac{1}{2} (0.40 + 0.30) (0.80 - 0.55) = \\frac{1}{2} (0.70)(0.25) = 0.0875 $$\n\n第5段：从 $(0.80, 0.30)$ 到 $(1.00, 0.20)$\n$$ A_5 = \\frac{1}{2} (0.30 + 0.20) (1.00 - 0.80) = \\frac{1}{2} (0.50)(0.20) = 0.05 $$\n\n总 PR AUC 是这些单个面积的总和：\n$$ \\text{PR AUC} = A_1 + A_2 + A_3 + A_4 + A_5 $$\n$$ \\text{PR AUC} = 0.08 + 0.11 + 0.1125 + 0.0875 + 0.05 $$\n$$ \\text{PR AUC} = 0.19 + 0.2000 + 0.05 = 0.44 $$\n问题要求答案保留四位有效数字。计算值为 $0.44$，可以表示为 $0.4400$。\n\n**第2部分：在罕见病筛查中 PR AUC 相较于 ROC AUC 更优的论证**\n\n为了说明为什么对于罕见病（患病率 $\\pi$ 很小），PR AUC 比 ROC AUC 更具信息量，我们必须检查所涉及指标的定义。设 $D^+$ 表示存在疾病，$T^+$ 表示阳性测试结果。\n\n受试者工作特征 (ROC) 曲线的指标是：\n- **真阳性率 (TPR)**，也称为召回率 ($R$) 或灵敏度：$R = \\text{TPR} = P(T^+|D^+)$。这是被正确识别的实际阳性样本的比例。\n- **假阳性率 (FPR)**: $\\text{FPR} = P(T^+|\\neg D^+)$。这是被错误识别为阳性的实际阴性样本的比例。\n\nROC 曲线绘制的是 TPR 与 FPR 的关系。这两个指标都是以真实疾病状态为条件的。因此，ROC 曲线及其面积 (ROC AUC) 不受疾病患病率 $\\pi = P(D^+)$ 的影响。\n\n精确率-召回率 (PR) 曲线的指标是：\n- **召回率 (R)**，如上定义。\n- **精确率 (P)**，也称为阳性预测值 (PPV)：$P = P(D^+|T^+)$。这是阳性测试结果中正确的比例。\n\n精确率是一个后验概率，其与患病率的关系可以通过贝叶斯定理明确表示：\n$$ P(D^+|T^+) = \\frac{P(T^+|D^+)P(D^+)}{P(T^+)} $$\n分母 $P(T^+)$ 可以使用全概率定律展开：\n$$ P(T^+) = P(T^+|D^+)P(D^+) + P(T^+|\\neg D^+)P(\\neg D^+) $$\n代入 TPR、FPR 和患病率 $\\pi$ 的定义：\n$$ P = \\frac{\\text{TPR} \\cdot \\pi}{\\text{TPR} \\cdot \\pi + \\text{FPR} \\cdot (1 - \\pi)} $$\n这个方程表明，精确率从根本上依赖于患病率 $\\pi$。\n\n在罕见病的背景下，$\\pi$ 非常小，因此 $(1 - \\pi)$ 接近于 $1$。非患病人群的数量远大于患病人群。因此，即使一个非常小的 FPR 也可能导致大量的假阳性 ($FP$) 绝对数量，这个数量很容易超过真阳性 ($TP$) 的数量。这对精确率有深远的影响。例如，如果 $\\pi = 0.02$，一个具有高 TPR ($0.9$) 和低 FPR ($0.05$) 的分类器，其精确率将为：\n$$ P = \\frac{0.9 \\cdot 0.02}{0.9 \\cdot 0.02 + 0.05 \\cdot 0.98} = \\frac{0.018}{0.018 + 0.049} \\approx 0.2687 $$\n尽管在 ROC 曲线上产生了一个优秀的工作点，但只有不到 $27\\%$ 的阳性分类是正确的。\n\nROC AUC 对患病率不敏感，因此在罕见病场景下可能会对分类器的性能给出一个具有误导性的乐观评估。它衡量的是区分阳性类别和阴性类别的能力，而不考虑它们在人群中的比例。相比之下，PR AUC 通过精确率指标直接包含了患病率的影响。它有效地评估了在少数（阳性）类别上的性能，这在筛查应用中通常是主要关注点。PR 曲线的急剧下降立即表明，在给定的召回率水平上，分类器产生的假阳性相对于真阳性过多，这是一个在 ROC 空间中被掩盖的关键信息。因此，在评估不平衡数据集（例如罕见病筛查）上的分类器时，PR AUC 是一个比 ROC AUC 更具信息量和相关性的指标。", "answer": "$$\\boxed{0.4400}$$", "id": "5207923"}, {"introduction": "一个在特定训练人群中表现优异的机器学习模型，在部署到新的临床环境时，其性能可能会发生变化。这通常是由于不同人群中的疾病患病率（prevalence）不同所导致的“数据集漂移”。本练习将引导您运用贝叶斯定理，量化患病率变化对模型阳性预测值（PPV）的影响，并探索如何通过校准来修正模型，以确保其在不同应用场景下的可靠性。[@problem_id:5208013]", "problem": "一个用于根据常规实验室特征标记血流感染的机器学习分类器，是在一个疾病患病率为 $ \\pi_{\\text{train}} $ 的住院患者队列上开发的。在训练队列上，于一个固定的决策阈值下，测得其工作特性为敏感性 $ \\mathrm{Se} $ 和特异性 $ \\mathrm{Sp} $。该模型经过校准，使其预测概率能反映训练患病率下的真实后验概率（即，它在训练队列上是经过良好校准的）。然后，在不改变分数分布或决策阈值的情况下，该模型被部署到一个疾病患病率不同的急诊护理队列中，其患病率为 $ \\pi_{\\text{deploy}} $。假设只发生先验概率（患病率）漂移：类条件分数分布，因此 $ \\mathrm{Se} $ 和 $ \\mathrm{Sp} $，在训练和部署之间保持不变。\n\n仅使用敏感性、特异性、患病率和贝叶斯定理的基本定义，首先推导出阳性预测值 $ \\mathrm{PPV} $ 作为 $ \\mathrm{Se} $、$ \\mathrm{Sp} $ 和患病率 $ \\pi $ 的函数表达式。然后，对于 $ \\mathrm{Se} = 0.92 $、$ \\mathrm{Sp} = 0.97 $、$ \\pi_{\\text{train}} = 0.10 $ 和 $ \\pi_{\\text{deploy}} = 0.025 $，计算部署时阳性预测值的乘法变化，定义为\n$$\n\\lambda \\equiv \\frac{\\mathrm{PPV}(\\pi_{\\text{deploy}})}{\\mathrm{PPV}(\\pi_{\\text{train}})}.\n$$\n接下来，考虑模型在训练队列上的校准可以用逻辑斯蒂链接函数写成 $ \\operatorname{logit}(p_{\\text{train}}(s)) = a + b\\,s $，其中 $ s $ 是分类器分数，$ a $ 是截距，$ b $ 是斜率。在纯粹的先验漂移下，根据贝叶斯定理推导所需的截距调整量 $ \\Delta $，以将后验概率重新校准到部署患病率，同时保持 $ b $ 不变，并针对给定的患病率对 $ \\Delta $ 进行数值计算。将数对 $ (\\lambda, \\Delta) $ 作为你的最终答案。\n\n将 $ \\lambda $ 和 $ \\Delta $ 均以小数形式表示，并各四舍五入到四位有效数字。不需要单位。", "solution": "该问题被评估为有效。它在科学上基于概率论和机器学习原理，是适定的，有足够的信息得到唯一解，并以客观、正式的语言表述。我们开始解题。\n\n问题要求计算两个量：在疾病患病率发生漂移的情况下，阳性预测值的乘法变化（$\\lambda$）和用于重新校准逻辑斯蒂分类器的截距调整量（$\\Delta$）。我们将按要求从第一性原理出发，依次解决每个部分。\n\n设 $D^+$ 表示患者患有该疾病（血流感染）的事件，$D^-$ 表示患者未患病的事件。设 $T^+$ 表示机器学习模型给出阳性分类的事件，$T^-$ 表示阴性分类。\n\n患病率 $\\pi$ 是疾病的先验概率：$\\pi = P(D^+)$。\n敏感性 $\\mathrm{Se}$ 是真阳性率：$\\mathrm{Se} = P(T^+|D^+)$。\n特异性 $\\mathrm{Sp}$ 是真阴性率：$\\mathrm{Sp} = P(T^-|D^-)$。\n根据特异性的定义，假阳性率为 $P(T^+|D^-) = 1 - P(T^-|D^-) = 1 - \\mathrm{Sp}$。\n\n### 第1部分：PPV的推导与$\\lambda$的计算\n\n阳性预测值（$\\mathrm{PPV}$）是在测试结果为阳性的条件下，患有该疾病的后验概率，即 $P(D^+|T^+)$。我们使用贝叶斯定理推导其表达式：\n$$ \\mathrm{PPV} = P(D^+|T^+) = \\frac{P(T^+|D^+) P(D^+)}{P(T^+)} $$\n分母 $P(T^+)$ 是测试结果为阳性的边缘概率。它可以使用全概率定律展开：\n$$ P(T^+) = P(T^+|D^+) P(D^+) + P(T^+|D^-) P(D^-) $$\n代入已定义的术语：\n$$ P(T^+) = (\\mathrm{Se})(\\pi) + (1-\\mathrm{Sp})(1-\\pi) $$\n将此代回 $\\mathrm{PPV}$ 的表达式，即可得到所需的以 $\\pi$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 为变量的公式：\n$$ \\mathrm{PPV}(\\pi, \\mathrm{Se}, \\mathrm{Sp}) = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp})(1 - \\pi)} $$\n现在，我们使用给定的数值来计算训练队列和部署队列的PPV。给定值为 $\\mathrm{Se} = 0.92$、$\\mathrm{Sp} = 0.97$、$\\pi_{\\text{train}} = 0.10$ 和 $\\pi_{\\text{deploy}} = 0.025$。假阳性率为 $1 - \\mathrm{Sp} = 1 - 0.97 = 0.03$。\n\n对于训练队列：\n$$ \\mathrm{PPV}(\\pi_{\\text{train}}) = \\frac{0.92 \\cdot 0.10}{0.92 \\cdot 0.10 + (0.03)(1 - 0.10)} = \\frac{0.092}{0.092 + (0.03)(0.90)} = \\frac{0.092}{0.092 + 0.027} = \\frac{0.092}{0.119} $$\n$$ \\mathrm{PPV}(\\pi_{\\text{train}}) \\approx 0.773109... $$\n对于部署队列：\n$$ \\mathrm{PPV}(\\pi_{\\text{deploy}}) = \\frac{0.92 \\cdot 0.025}{0.92 \\cdot 0.025 + (0.03)(1 - 0.025)} = \\frac{0.023}{0.023 + (0.03)(0.975)} = \\frac{0.023}{0.023 + 0.02925} = \\frac{0.023}{0.05225} $$\n$$ \\mathrm{PPV}(\\pi_{\\text{deploy}}) \\approx 0.440191... $$\n乘法变化 $\\lambda$ 是这两个值的比率：\n$$ \\lambda = \\frac{\\mathrm{PPV}(\\pi_{\\text{deploy}})}{\\mathrm{PPV}(\\pi_{\\text{train}})} = \\frac{0.023 / 0.05225}{0.092 / 0.119} \\approx \\frac{0.440191...}{0.773109...} \\approx 0.569398... $$\n四舍五入到四位有效数字，我们得到 $\\lambda \\approx 0.5694$。\n\n### 第2部分：截距调整量$\\Delta$的推导与计算\n\n问题假设了一个逻辑斯蒂校准模型，该模型通过 logit 链接函数 $\\operatorname{logit}(p) = \\ln(\\frac{p}{1-p})$ 将模型分数 $s$ 与后验概率 $p(s) = P(D^+|s)$ 联系起来。数量 $\\frac{p}{1-p}$ 代表后验几率。\n\n根据贝叶斯定理，给定分数 $s$ 时疾病的后验几率可以写为该分数的似然比与疾病先验几率的乘积：\n$$ \\frac{P(D^+|s)}{P(D^-|s)} = \\frac{P(s|D^+)}{P(s|D^-)} \\cdot \\frac{P(D^+)}{P(D^-)} $$\n对两边取自然对数，得到在对数几率（logit）空间中的关系：\n$$ \\ln\\left(\\frac{P(D^+|s)}{P(D^-|s)}\\right) = \\ln\\left(\\frac{P(s|D^+)}{P(s|D^-)}\\right) + \\ln\\left(\\frac{P(D^+)}{P(D^-)}\\right) $$\n令 $p(s) = P(D^+|s)$ 且 $\\pi = P(D^+)$。方程变为：\n$$ \\operatorname{logit}(p(s)) = \\ln\\left(\\frac{P(s|D^+)}{P(s|D^-)}\\right) + \\operatorname{logit}(\\pi) $$\n“仅先验概率漂移”的假设意味着类条件分数分布 $P(s|D^+)$ 和 $P(s|D^-)$ 在训练队列和部署队列之间是不变的。因此，对数似然比项 $\\ln\\left(\\frac{P(s|D^+)}{P(s|D^-)}\\right)$ 也是不变的。\n\n对于训练队列，校准模型为 $\\operatorname{logit}(p_{\\text{train}}(s)) = a + b\\,s$。根据我们的推导，这意味着：\n$$ a + b\\,s = \\ln\\left(\\frac{P(s|D^+)}{P(s|D^-)}\\right) + \\operatorname{logit}(\\pi_{\\text{train}}) $$\n对于部署队列，重新校准的模型是 $\\operatorname{logit}(p_{\\text{deploy}}(s)) = (a+\\Delta) + b\\,s$，其中 $b$ 不变，$\\Delta$ 是截距调整量。这必须满足：\n$$ (a+\\Delta) + b\\,s = \\ln\\left(\\frac{P(s|D^+)}{P(s|D^-)}\\right) + \\operatorname{logit}(\\pi_{\\text{deploy}}) $$\n用第二个方程减去第一个方程，我们分离出调整项 $\\Delta$：\n$$ ((a+\\Delta) + b\\,s) - (a + b\\,s) = \\left(\\ln\\left(\\frac{P(s|D^+)}{P(s|D^-)}\\right) + \\operatorname{logit}(\\pi_{\\text{deploy}})\\right) - \\left(\\ln\\left(\\frac{P(s|D^+)}{P(s|D^-)}\\right) + \\operatorname{logit}(\\pi_{\\text{train}})\\right) $$\n$(a+b\\,s)$ 项和对数似然比项相互抵消，得到 $\\Delta$ 的表达式：\n$$ \\Delta = \\operatorname{logit}(\\pi_{\\text{deploy}}) - \\operatorname{logit}(\\pi_{\\text{train}}) $$\n这表明，对 logit 空间截距所需的调整量，恰好是经过 logit 变换后的两个患病率之差。我们现在计算其数值：\n$$ \\Delta = \\ln\\left(\\frac{\\pi_{\\text{deploy}}}{1 - \\pi_{\\text{deploy}}}\\right) - \\ln\\left(\\frac{\\pi_{\\text{train}}}{1 - \\pi_{\\text{train}}}\\right) = \\ln\\left(\\frac{\\pi_{\\text{deploy}}(1 - \\pi_{\\text{train}})}{\\pi_{\\text{train}}(1 - \\pi_{\\text{deploy}})}\\right) $$\n代入患病率 $\\pi_{\\text{train}} = 0.10$ 和 $\\pi_{\\text{deploy}} = 0.025$：\n$$ \\Delta = \\ln\\left(\\frac{0.025 \\cdot (1 - 0.10)}{0.10 \\cdot (1 - 0.025)}\\right) = \\ln\\left(\\frac{0.025 \\cdot 0.90}{0.10 \\cdot 0.975}\\right) = \\ln\\left(\\frac{0.0225}{0.0975}\\right) $$\n$$ \\Delta = \\ln\\left(\\frac{225}{975}\\right) = \\ln\\left(\\frac{3}{13}\\right) \\approx -1.466337... $$\n四舍五入到四位有效数字，我们得到 $\\Delta \\approx -1.466$。\n\n最终答案是数对 $(\\lambda, \\Delta)$，其值均四舍五入到四位有效数字。\n$\\lambda \\approx 0.5694$\n$\\Delta \\approx -1.466$", "answer": "$$\\boxed{\\begin{pmatrix} 0.5694 & -1.466 \\end{pmatrix}}$$", "id": "5208013"}]}