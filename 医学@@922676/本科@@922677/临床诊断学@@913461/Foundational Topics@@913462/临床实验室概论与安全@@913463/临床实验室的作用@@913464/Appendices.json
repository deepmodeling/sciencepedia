{"hands_on_practices": [{"introduction": "临床实验室的一个核心职责是评估诊断检测的性能。在引入一项新检测之前，我们必须量化其在区分患病和非患病个体方面的能力。此练习将引导您计算一系列关键的性能指标，包括灵敏度、特异性、预测值和似然比，这些是理解和传达检测价值的基础。通过这种方式，您可以将抽象的统计特性转化为对临床决策有实际影响的明确指标。[@problem_id:5236897]", "problem": "一家临床实验室正在评估一种新的单阈值诊断检测方法，用于检测一种人群患病率为 $0.15$ 的疾病。在选定的决策阈值下，该检测方法的灵敏度为 $0.92$，特异性为 $0.88$。临床实验室的职责包括量化这些操作特性如何转化为测后可解释性和整体区分能力，以支持临床决策。\n\n仅使用基本概率定义、贝叶斯定理以及正态分布作为连续检测结果模型的标准性质，按以下步骤进行：\n\n1. 根据灵敏度、特异性的核心定义以及疾病患病率，推导出阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式，并计算它们的数值。\n2. 使用似然比 (LR) 的定义，即在患病状态下获得某一检测结果的概率与在非患病状态下获得该结果的概率之比，为给定的灵敏度和特异性推导并计算阳性似然比和阴性似然比，记为 $LR^{+}$ 和 $LR^{-}$。\n3. 为将单个操作点与预期的整体区分性能联系起来，假设连续检测测量值遵循一个等方差双正态模型：非患病者的结果服从标准正态分布，而患病者的结果服从一个具有未知均值漂移但方差相同的正态分布。利用此模型下受试者工作特征 (ROC) 的定义性质，用标准化均值差表示曲线下面积 (AUC)，从固定阈值下观察到的灵敏度和特异性推断出此均值差，并计算预期的 AUC。\n\n将 $PPV$、$NPV$、$LR^{+}$、$LR^{-}$ 和 $AUC$ 的最终数值以小数形式报告。将每个值四舍五入至四位有效数字。", "solution": "经评估，本问题有效。其科学依据源于生物统计学和诊断检验评估的原理，问题陈述清晰，信息充分且一致，表述客观。下面我们进行求解。\n\n设 $D$ 为受试者患病的事件，$D^c$ 为受试者未患病的事件。设 $T^+$ 为检测结果为阳性的事件，$T^-$ 为检测结果为阴性的事件。\n\n给定信息如下：\n- 人群患病率：$P(D) = 0.15$\n- 灵敏度 (真阳性率, TPR): $\\text{Sens} = P(T^+|D) = 0.92$\n- 特异性 (真阴性率, TNR): $\\text{Spec} = P(T^-|D^c) = 0.88$\n\n由此，我们可以推导出其他基本概率：\n- 未患病概率：$P(D^c) = 1 - P(D) = 1 - 0.15 = 0.85$\n- 假阳性率 (FPR): $P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - \\text{Spec} = 1 - 0.88 = 0.12$\n- 假阴性率 (FNR): $P(T^-|D) = 1 - P(T^+|D) = 1 - \\text{Sens} = 1 - 0.92 = 0.08$\n\n**1. 阳性预测值 (PPV) 和阴性预测值 (NPV)**\n\n阳性预测值，$PPV = P(D|T^+)$，是指检测结果为阳性的受试者实际患病的概率。使用贝叶斯定理：\n$$PPV = P(D|T^+) = \\frac{P(T^+|D)P(D)}{P(T^+)}$$\n为了求得 $P(T^+)$，即检测结果为阳性的总概率，我们使用全概率公式：\n$$P(T^+) = P(T^+|D)P(D) + P(T^+|D^c)P(D^c)$$\n代入已知值：\n$$P(T^+) = (0.92)(0.15) + (0.12)(0.85) = 0.138 + 0.102 = 0.24$$\n现在我们可以计算 $PPV$：\n$$PPV = \\frac{0.138}{0.24} = 0.575$$\n\n阴性预测值，$NPV = P(D^c|T^-)$，是指检测结果为阴性的受试者实际未患病的概率。使用贝叶斯定理：\n$$NPV = P(D^c|T^-) = \\frac{P(T^-|D^c)P(D^c)}{P(T^-)}$$\n为了求得 $P(T^-)$，即检测结果为阴性的总概率，我们可以使用 $P(T^-) = 1 - P(T^+) = 1 - 0.24 = 0.76$。或者，使用全概率公式：\n$$P(T^-) = P(T^-|D)P(D) + P(T^-|D^c)P(D^c) = (0.08)(0.15) + (0.88)(0.85) = 0.012 + 0.748 = 0.76$$\n现在我们可以计算 $NPV$：\n$$NPV = \\frac{(0.88)(0.85)}{0.76} = \\frac{0.748}{0.76} \\approx 0.9842105$$\n\n**2. 似然比 ($LR^+$ 和 $LR^-$)**\n\n阳性似然比，$LR^+$，是患病受试者检测结果为阳性的概率与非患病受试者检测结果为阳性的概率之比。\n$$LR^+ = \\frac{P(T^+|D)}{P(T^+|D^c)} = \\frac{\\text{Sens}}{1 - \\text{Spec}}$$\n代入数值：\n$$LR^+ = \\frac{0.92}{0.12} = \\frac{92}{12} = \\frac{23}{3} \\approx 7.6666...$$\n\n阴性似然比，$LR^-$，是患病受试者检测结果为阴性的概率与非患病受试者检测结果为阴性的概率之比。\n$$LR^- = \\frac{P(T^-|D)}{P(T^-|D^c)} = \\frac{1 - \\text{Sens}}{\\text{Spec}}$$\n代入数值：\n$$LR^- = \\frac{0.08}{0.88} = \\frac{8}{88} = \\frac{1}{11} \\approx 0.090909...$$\n\n**3. 曲线下面积 (AUC)**\n\n我们假设一个等方差双正态模型。设非患病受试者的连续检测测量值为随机变量 $X_{D^c} \\sim \\mathcal{N}(0, 1)$，服从标准正态分布。对于患病受试者，测量值为 $X_D \\sim \\mathcal{N}(\\mu_D, 1)$，方差相同但有均值漂移 $\\mu_D$。\n\n设 $c$ 为决策阈值。如果测量值超过 $c$，则检测为阳性。\n特异性是非患病受试者检测结果为阴性的概率：\n$$\\text{Spec} = P(X_{D^c} \\le c) = \\Phi(c)$$\n其中 $\\Phi$ 是标准正态分布的累积分布函数 (CDF)。\n给定 $\\text{Spec} = 0.88$，我们有 $\\Phi(c) = 0.88$，这意味着 $c = \\Phi^{-1}(0.88)$。\n\n灵敏度是患病受试者检测结果为阳性的概率：\n$$\\text{Sens} = P(X_D > c) = 1 - P(X_D \\le c)$$\n为了计算 $P(X_D \\le c)$，我们对变量进行标准化：$Z = \\frac{X_D - \\mu_D}{1} \\sim \\mathcal{N}(0,1)$。\n$$P(X_D \\le c) = P\\left(\\frac{X_D - \\mu_D}{1} \\le \\frac{c - \\mu_D}{1}\\right) = \\Phi(c - \\mu_D)$$\n因此，$\\text{Sens} = 1 - \\Phi(c - \\mu_D)$。给定 $\\text{Sens}=0.92$，我们有：\n$$0.92 = 1 - \\Phi(c - \\mu_D) \\implies \\Phi(c - \\mu_D) = 0.08$$\n这意味着 $c - \\mu_D = \\Phi^{-1}(0.08)$。\n\n我们现在有一个包含两个方程的方程组来求解标准化均值差 $\\mu_D$：\n1. $c = \\Phi^{-1}(0.88)$\n2. $c - \\mu_D = \\Phi^{-1}(0.08)$\n\n将第一个方程代入第二个方程得到：\n$$\\Phi^{-1}(0.88) - \\mu_D = \\Phi^{-1}(0.08)$$\n求解 $\\mu_D$：\n$$\\mu_D = \\Phi^{-1}(0.88) - \\Phi^{-1}(0.08)$$\n使用标准正态分布的对称性质 $\\Phi^{-1}(p) = -\\Phi^{-1}(1-p)$，我们有 $\\Phi^{-1}(0.08) = -\\Phi^{-1}(1-0.08) = -\\Phi^{-1}(0.92)$。\n$$\\mu_D = \\Phi^{-1}(0.88) + \\Phi^{-1}(0.92)$$\n使用标准统计表或软件，我们找到分位数：\n$\\Phi^{-1}(0.88) \\approx 1.174987$\n$\\Phi^{-1}(0.92) \\approx 1.405072$\n因此，均值差为：\n$$\\mu_D \\approx 1.174987 + 1.405072 = 2.580059$$\n\n对于等方差双正态模型，ROC 曲线下面积 (AUC) 由以下公式给出：\n$$AUC = \\Phi\\left(\\frac{\\mu_D}{\\sqrt{2}}\\right)$$\n代入 $\\mu_D$ 的值：\n$$AUC = \\Phi\\left(\\frac{2.580059}{\\sqrt{2}}\\right) \\approx \\Phi(1.82436)$$\n使用标准正态CDF，我们求得 AUC：\n$$AUC \\approx 0.965935$$\n\n最后，我们将所有计算值四舍五入至四位有效数字：\n- $PPV = 0.575 \\rightarrow 0.5750$\n- $NPV \\approx 0.9842105 \\rightarrow 0.9842$\n- $LR^+ \\approx 7.6666... \\rightarrow 7.667$\n- $LR^- \\approx 0.090909... \\rightarrow 0.09091$\n- $AUC \\approx 0.965935 \\rightarrow 0.9659$", "answer": "$$\\boxed{\\begin{pmatrix} 0.5750  0.9842  7.667  0.09091  0.9659 \\end{pmatrix}}$$", "id": "5236897"}, {"introduction": "即使一个检测方法在理论上很出色，其结果的准确性也可能受到样本质量的影响。分析干扰，例如溶血（红细胞破裂），是临床实验室日常面临的实际挑战。本练习模拟了一个常见场景：您需要根据已知的干扰效应，量化溶血对血钾检测结果造成的偏倚，并依据实验室制定的样本接收标准，做出是否拒收样本的关键决定。[@problem_id:5236877]", "problem": "临床实验室的临床化学部门使用间接离子选择电极（ISE）法检测血清钾。该实验室通过溶血指数来监测分析前溶血，该指数报告为血清中游离血红蛋白的浓度。在一次方法评估中，钾的检测方法表现出由游离血红蛋白引起的线性正干扰：在已验证的线性范围内，游离血红蛋白每增加 $0.3$ g/L，测得的钾浓度增加 $+0.3$ mmol/L。一份患者样本送达，其溶血指数对应于 $0.5$ g/L 的游离血红蛋白浓度。实验室的样本接收标准规定，由溶血引起的钾检测结果的最大允许绝对偏差为 $0.3$ mmol/L。\n\n从分析干扰在已验证线性范围内会产生与干扰物浓度成正比的系统误差这一基本定义出发，计算该样本中由溶血引起的预期偏差，并根据所述标准判断是否应拒收该样本。将此决定编码为 $D$，如果样本必须被拒收（预期偏差严格大于允许阈值），则 $D = 1$，否则 $D = 0$。报告 $D$ 作为您的最终答案（无单位）。", "solution": "用户希望我解决这个问题。我已经验证了这个问题并且发现它是有效的。我现在将着手解决。\n\n问题要求根据溶血引起的血清钾测量预期分析偏差来判断是否应拒收一份患者样本。该决定需要编码为一个二元变量 $D$。\n\n首先，我们必须将干扰物（游离血红蛋白）浓度与由此产生的钾测量偏差之间的关系形式化。问题指出干扰是线性的，这意味着偏差与游离血红蛋白的浓度成正比。设 $C_{Hb}$ 为游离血红蛋白的浓度（单位 g/L），设 $\\Delta K$ 为由此产生的钾浓度正偏差（单位 mmol/L）。该关系可以表示为：\n$$\n\\Delta K = k \\cdot C_{Hb}\n$$\n其中 $k$ 是比例常数，或称为干扰系数。\n\n问题提供了确定 $k$ 值所需的信息。它指出“游离血红蛋白每增加 $0.3$ g/L，测得的钾浓度增加 $+0.3$ mmol/L”。这可以写成：\n$$\n+0.3 \\text{ mmol/L} = k \\cdot (0.3 \\text{ g/L})\n$$\n求解 $k$，我们得到：\n$$\nk = \\frac{0.3 \\text{ mmol/L}}{0.3 \\text{ g/L}} = 1.0 \\frac{\\text{mmol/L}}{\\text{g/L}}\n$$\n这个常数定量了干扰的程度。由于这种特定的分析干扰，游离血红蛋白每增加 $1$ g/L，测得的钾浓度预计会增加 $1.0$ mmol/L。\n\n接下来，我们将此关系应用于所讨论的患者样本。该样本的溶血指数对应的游离血红蛋白浓度为 $C_{Hb, patient} = 0.5$ g/L。我们可以使用推导出的干扰系数 $k$ 来计算该样本的预期偏差 $\\Delta K_{patient}$：\n$$\n\\Delta K_{patient} = k \\cdot C_{Hb, patient} = \\left(1.0 \\frac{\\text{mmol/L}}{\\text{g/L}}\\right) \\cdot (0.5 \\text{ g/L})\n$$\n$$\n\\Delta K_{patient} = 0.5 \\text{ mmol/L}\n$$\n因此，对于这个特定样本，由溶血引起的钾检测结果的预期偏差为 $+0.5$ mmol/L。\n\n最后一步是将计算出的偏差与实验室的样本接收标准进行比较。该标准规定，最大允许绝对偏差（我们称之为 $\\text{Bias}_{max}$）为 $0.3$ mmol/L。如果预期偏差*严格大于*此阈值，则必须拒收样本。拒收的条件是：\n$$\n|\\Delta K_{patient}| > \\text{Bias}_{max}\n$$\n问题指明了是正干扰，因此 $\\Delta K_{patient}$ 是正值，其绝对值等于其本身。阈值为 $\\text{Bias}_{max} = 0.3$ mmol/L。我们必须检查以下不等式是否成立：\n$$\n0.5 \\text{ mmol/L} > 0.3 \\text{ mmol/L}\n$$\n这个不等式是成立的，因为 $0.5$ 确实大于 $0.3$。\n\n由于满足了拒收条件，该样本必须被拒收。问题定义了一个决策变量 $D$，其中 $D=1$ 表示拒收，$D=0$ 表示接收（或不拒收）。因为该样本必须被拒收，所以决策变量的值为 $D=1$。", "answer": "$$\\boxed{1}$$", "id": "5236877"}, {"introduction": "临床实验室的有效性不仅取决于结果的准确性，还取决于其及时性。特别是在公共卫生危机等高需求情况下，管理工作流程、仪器通量和人力资源以满足周转时间（$TAT$）目标至关重要。本练习将让您扮演实验室管理者的角色，综合考虑样本量、仪器产能、利用率上限和劳动标准，计算出维持关键检测服务所需的人力资源。[@problem_id:5236921]", "problem": "一家公共卫生临床实验室必须将严重急性呼吸综合征冠状病毒2型 (SARS-CoV-2) 逆转录聚合酶链式反应 (RT-PCR) 检测的样本周转时间 (TAT) 维持在 $24$ 小时以下。每日接收的患者样本量为 $500$ 份。该实验室目前拥有一台高通量RT-PCR仪器，经认证在满负荷运行时，每天最多可产出 $300$ 份可报告结果。为保证实际操作中的TAT，实验室对每台分析仪器强制执行 $0.85$ 的计划利用率上限，以应对重复检测、质量控制 (QC) 和短暂的停机时间。如有需要，实验室可立即部署一台额外的相同仪器。工作日安排为三个 $8$ 小时的班次，以确保 $24$ 小时全天候运作。\n\n基于标准临床实验室工作流程的岗位和时间标准如下：\n- 分析前处理（登记、贴标、分液）每份样本需要 $0.10$ 小时的技术员时间。\n- 分析后发布（结果验证、文件记录、报告）每份样本需要 $0.05$ 小时的技术员时间。\n- RT-PCR以标准批次进行，每板 $100$ 份患者样本；假设对照品已包含在仪器的额定日处理能力中，且不改变批次大小或上述的每样本劳动时间。\n- 对于每次RT-PCR运行，用于设置和文件记录的分析技术员劳动时间总计为每次运行 $0.83$ 小时。\n- 每台仪器每天需要 $0.50$ 小时的日常维护劳动时间。\n- 一名全职等效 (FTE) 技术员每班工作 $8$ 小时，其中 $0.85$ 的有效工作时间用于直接检测工作，剩余时间分配给休息、安全任务和质量管理。\n\n在基线水平，人员配置为三个班次每班一名医学实验室科学家（基线人员配置等于 $3$ FTE）。仅使用TAT、通量、利用率、批处理和劳动时间核算的定义，并假设在利用率上限下进行稳态日常操作，确定在每日 $500$ 份样本量的情况下维持 $24$ 小时的TAT，所需的额外技术员全职等效的最小数量。将您的答案四舍五入到两位有效数字，并以全职等效 (FTE) 为单位表示。在最终的方框答案中不要包含单位。", "solution": "经评估，该问题是有效的，因为它具有科学依据、问题明确且客观。它提出了一个临床实验室背景下的定量运营管理问题，使用了标准且切合实际的参数。所有必要信息均已提供，问题没有矛盾或模糊之处。\n\n目标是确定在遵守所有指定约束条件的情况下，处理每日样本量所需的额外全职等效 (FTE) 技术员的最小数量，记作 $N_{add}$。\n\n额外FTE的数量是所需的总FTE数量 $N_{total}$ 与基线FTE数量 $N_{baseline}$ 之间的差值。\n$$N_{add} = N_{total} - N_{baseline}$$\n给定基线人员配置为 $N_{baseline} = 3$ FTE。\n\n所需的总FTE数量是每日总劳动小时需求 $L_{total}$ 与单个FTE每天提供的有效劳动小时数 $L_{FTE}$ 的比值。\n$$N_{total} = \\frac{L_{total}}{L_{FTE}}$$\n\n首先，我们必须确定每日总劳动小时数 $L_{total}$。这是分析前处理 ($L_{pre}$)、分析后处理 ($L_{post}$)、分析工作 ($L_{analytic}$) 和仪器维护 ($L_{maint}$) 的劳动小时数的总和。\n$$L_{total} = L_{pre} + L_{post} + L_{analytic} + L_{maint}$$\n\n为了计算维护劳动时间 $L_{maint}$，我们必须首先确定处理每日样本量 $V_{daily} = 500$ 所需的仪器数量 $N_{instr}$。每台仪器的最大容量为每天 $C_{instr} = 300$ 个结果，但受到计划利用率上限 $U_{cap} = 0.85$ 的限制。因此，一台仪器的有效容量 $C_{eff}$ 为：\n$$C_{eff} = C_{instr} \\times U_{cap} = 300 \\times 0.85 = 255 \\text{ results per day}$$\n所需的仪器数量是每日样本量除以每台仪器的有效容量，并向上取整到最近的整数，因为不能部署部分仪器。\n$$N_{instr} = \\left\\lceil \\frac{V_{daily}}{C_{eff}} \\right\\rceil = \\left\\lceil \\frac{500}{255} \\right\\rceil = \\lceil 1.96... \\rceil = 2$$\n因此，需要两台仪器。\n\n现在我们可以计算总劳动需求 $L_{total}$ 的每个组成部分：\n\n1.  **分析前劳动时间 ($L_{pre}$):** 这是每份样本所需时间乘以样本数量。\n    $$L_{pre} = V_{daily} \\times T_{pre} = 500 \\text{ specimens} \\times 0.10 \\frac{\\text{hours}}{\\text{specimen}} = 50 \\text{ hours}$$\n\n2.  **分析后劳动时间 ($L_{post}$):** 这是每份样本所需时间乘以样本数量。\n    $$L_{post} = V_{daily} \\times T_{post} = 500 \\text{ specimens} \\times 0.05 \\frac{\\text{hours}}{\\text{specimen}} = 25 \\text{ hours}$$\n\n3.  **分析劳动时间 ($L_{analytic}$):** 该劳动时间基于RT-PCR的运行次数。批次大小为每次运行 $B_{size} = 100$ 份样本，则运行次数 $N_{runs}$ 为：\n    $$N_{runs} = \\left\\lceil \\frac{V_{daily}}{B_{size}} \\right\\rceil = \\left\\lceil \\frac{500}{100} \\right\\rceil = 5 \\text{ runs}$$\n    总分析劳动时间是运行次数乘以每次运行的劳动时间 $T_{run} = 0.83$ 小时。\n    $$L_{analytic} = N_{runs} \\times T_{run} = 5 \\text{ runs} \\times 0.83 \\frac{\\text{hours}}{\\text{run}} = 4.15 \\text{ hours}$$\n\n4.  **维护劳动时间 ($L_{maint}$):** 这是每台仪器每日的维护时间 $T_{maint} = 0.50$ 小时，乘以所用仪器的数量。\n    $$L_{maint} = N_{instr} \\times T_{maint} = 2 \\text{ instruments} \\times 0.50 \\frac{\\text{hours}}{\\text{instrument}} = 1.0 \\text{ hour}$$\n\n每日总劳动需求是这些组成部分的总和：\n$$L_{total} = 50 + 25 + 4.15 + 1.0 = 80.15 \\text{ hours}$$\n\n接下来，我们计算一个FTE每天提供的有效劳动小时数 $L_{FTE}$。一个FTE被定义为工作一个 $8$ 小时的班次，其有效工作时间比例为 $F_{prod} = 0.85$。\n$$L_{FTE} = 8 \\frac{\\text{hours}}{\\text{FTE}} \\times 0.85 = 6.8 \\frac{\\text{productive hours}}{\\text{FTE}}$$\n\n现在，我们可以计算满足总劳动需求所需的FTE总数。\n$$N_{total} = \\frac{L_{total}}{L_{FTE}} = \\frac{80.15 \\text{ hours}}{6.8 \\frac{\\text{hours}}{\\text{FTE}}} \\approx 11.78676 \\text{ FTE}$$\n\n最后，我们通过减去基线人员配置水平来确定所需的额外FTE数量。\n$$N_{add} = N_{total} - N_{baseline} = 11.78676 - 3 = 8.78676 \\text{ FTE}$$\n\n问题要求答案四舍五入到两位有效数字。第一位有效数字是 $8$，第二位是 $7$。后一位数字是 $8$，大于或等于 $5$，因此我们将第二位有效数字向上取整。\n$$N_{add} \\approx 8.8$$\n因此，至少需要 $8.8$ 名额外的FTE。", "answer": "$$\\boxed{8.8}$$", "id": "5236921"}]}