{"hands_on_practices": [{"introduction": "理解自闭症谱系障碍 (ASD) 等神经发育障碍的根源，区分遗传与环境因素的相对贡献至关重要。双生子研究为我们提供了剖析这一复杂问题的经典而有力的工具。本实践将引导你应用一种称为ACE模型的量化遗传学方法，通过对双生子研究的摘要统计数据进行拟合，你将能亲手估算一项复杂性状（如社交缺陷）的遗传度，并检验共享环境因素是否起到了显著作用。[@problem_id:5054375]", "problem": "您将获得自闭症谱系障碍 (ASD) 中社交沟通缺陷得分的双生子研究摘要统计数据。目标是在经典双生子模型下推断方差组分，并正式检验共享环境是否对 ASD 社交缺陷表型有显著贡献。请使用以下来自数量遗传学和多元正态理论的基本定义和假设。\n\n基本定义和假设：\n- 设表型 $Y$ 的方差组分为 $\\mathrm{A}$（加性遗传）、$\\mathrm{C}$（共享环境）和 $\\mathrm{E}$（独特环境），使得 $\\mathrm{Var}(Y) = \\mathrm{A} + \\mathrm{C} + \\mathrm{E}$，且所有组分均为非负。\n- 同卵 (MZ) 双生子共享约 $100\\%$ 的加性遗传影响，而异卵 (DZ) 双生子共享约 $50\\%$ 的加性遗传影响。遗传相关系数 $r_g$ 对于 MZ 双生子为 $1$，对于 DZ 双生子为 $0.5$。\n- 在经典双生子模型下，一对双生子的协方差为 $\\mathrm{Cov}(Y_1,Y_2) = r_g \\cdot \\mathrm{A} + \\mathrm{C}$，每个双生子的方差为 $\\mathrm{Var}(Y) = \\mathrm{A} + \\mathrm{C} + \\mathrm{E}$。\n- 假设在每项研究中，ASD 社交缺陷得分都经过标准化，使得观测到的双生子内方差为 $1$。每个组别观测到的双生子对摘要统计数据分别是同卵双生子对的组内相关性 $r_{MZ}$ 和异卵双生子对的组内相关性 $r_{DZ}$，以及各自独立的双生子对数量 $n_{MZ}$ 和 $n_{DZ}$。\n- 假设双变量双生子得分服从联合多元正态分布。对于一个期望协方差矩阵为 $\\Sigma$ 的双生子组，拥有样本协方差矩阵 $S$ 的 $n$ 对独立双生子，其负二倍对数似然（相差一个常数）由 $-2\\ell = n\\left(\\log|\\Sigma| + \\mathrm{tr}(S\\Sigma^{-1})\\right)$ 给出。\n\n任务：\n1. 对于每个测试用例，将观测到的每组 $2 \\times 2$ 样本协方差矩阵视为 $S_{MZ} = \\begin{bmatrix} 1  r_{MZ} \\\\ r_{MZ}  1 \\end{bmatrix}$ 和 $S_{DZ} = \\begin{bmatrix} 1  r_{DZ} \\\\ r_{DZ}  1 \\end{bmatrix}$。在加性遗传-共享环境-独特环境 (ACE) 模型下，根据方差分解和遗传相关性假设推导出同卵和异卵双生子对的期望协方差矩阵，并通过在 $\\mathrm{A} \\ge 0$、$\\mathrm{C} \\ge 0$ 和 $\\mathrm{E} \\ge 0$ 的约束下最大化两组的联合对数似然来拟合参数 $\\mathrm{A}$、$\\mathrm{C}$ 和 $\\mathrm{E}$。\n2. 通过约束 $\\mathrm{C} = 0$ 并在相同的似然框架下重新优化 $\\mathrm{A}$ 和 $\\mathrm{E}$，来拟合嵌套的加性遗传-独特环境 (AE) 模型。\n3. 计算似然比检验统计量 $D = \\left(-2\\ell_{\\mathrm{AE}}\\right) - \\left(-2\\ell_{\\mathrm{ACE}}\\right)$，在原假设 $\\mathrm{C} = 0$ 下，该统计量近似服从自由度为 $1$ 的 $\\chi^2$ 分布。返回相关的 $p$ 值以及关于共享环境是否有显著贡献（定义为 $p  0.05$）的布尔决策。\n4. 报告 ACE 模型的最大似然估计值 $\\hat{\\mathrm{A}}$、$\\hat{\\mathrm{C}}$ 和 $\\hat{\\mathrm{E}}$，似然比检验的 $p$ 值，以及每个测试用例的布尔决策。所有浮点数输出均表示为四舍五入到三位小数。\n\n测试套件：\n- 用例 $1$：$r_{MZ} = 0.70$, $r_{DZ} = 0.35$, $n_{MZ} = 150$, $n_{DZ} = 250$。\n- 用例 $2$：$r_{MZ} = 0.60$, $r_{DZ} = 0.50$, $n_{MZ} = 180$, $n_{DZ} = 180$。\n- 用例 $3$：$r_{MZ} = 0.25$, $r_{DZ} = 0.05$, $n_{MZ} = 120, n_{DZ} = 220$。\n- 用例 $4$：$r_{MZ} = 0.90$, $r_{DZ} = 0.45$, $n_{MZ} = 40, n_{DZ} = 60$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是 $[\\hat{\\mathrm{A}}, \\hat{\\mathrm{C}}, \\hat{\\mathrm{E}}, p, \\text{decision}]$ 形式的列表，其中 $\\hat{\\mathrm{A}}$、$\\hat{\\mathrm{C}}$、$\\hat{\\mathrm{E}}$ 和 $p$ 是四舍五入到三位小数的浮点数，而 $\\text{decision}$ 是一个布尔值。例如，整体输出应类似于 $[[a_1,c_1,e_1,p_1,\\text{True}],[a_2,c_2,e_2,p_2,\\text{False}],\\dots]$，不含空格。", "solution": "该问题要求将数量遗传学建模应用于自闭症谱系障碍 (ASD) 双生子研究的摘要统计数据。目标是估计加性遗传 ($\\mathrm{A}$)、共享环境 ($\\mathrm{C}$) 和独特环境 ($\\mathrm{E}$) 对社交沟通缺陷得分方差的贡献。这通过使用最大似然法将两个竞争模型（ACE 模型和 AE 模型）拟合到数据来完成。然后执行似然比检验，以正式评估共享环境组分的显著性。\n\n分析的基础是经典双生子模型，它将总表型方差 $\\sigma^2_P$ 分解为三个组分：$\\sigma^2_P = \\mathrm{A} + \\mathrm{C} + \\mathrm{E}$。参数 $\\mathrm{A}$、$\\mathrm{C}$ 和 $\\mathrm{E}$ 代表绝对方差，并被约束为非负：$\\mathrm{A} \\ge 0$、$\\mathrm{C} \\ge 0$、$\\mathrm{E} \\ge 0$。\n\n根据这种分解，我们可以为同卵 (MZ) 和异卵 (DZ) 双生子对指定期望协方差矩阵。MZ 双生子平均共享 $100\\%$ 的加性遗传物质，而 DZ 双生子共享 $50\\%$。根据定义，两种类型的双生子都共享其共同的环境。同样根据定义，双生子之间的独特环境是不相关的。\n\n任何个体的期望总方差为 $\\mathrm{Var}(Y) = \\mathrm{A} + \\mathrm{C} + \\mathrm{E}$。\nMZ 对的期望协方差为 $\\mathrm{Cov}(Y_{MZ1}, Y_{MZ2}) = 1.0 \\cdot \\mathrm{A} + 1.0 \\cdot \\mathrm{C}$。\nDZ 对的期望协方差为 $\\mathrm{Cov}(Y_{DZ1}, Y_{DZ2}) = 0.5 \\cdot \\mathrm{A} + 1.0 \\cdot \\mathrm{C}$。\n\n这导出了 ACE 模型的以下理论协方差矩阵：\n$$ \\Sigma_{MZ} = \\begin{pmatrix} \\mathrm{A}+\\mathrm{C}+\\mathrm{E}  \\mathrm{A}+\\mathrm{C} \\\\ \\mathrm{A}+\\mathrm{C}  \\mathrm{A}+\\mathrm{C}+\\mathrm{E} \\end{pmatrix} $$\n$$ \\Sigma_{DZ} = \\begin{pmatrix} \\mathrm{A}+\\mathrm{C}+\\mathrm{E}  0.5\\mathrm{A}+\\mathrm{C} \\\\ 0.5\\mathrm{A}+\\mathrm{C}  \\mathrm{A}+\\mathrm{C}+\\mathrm{E} \\end{pmatrix} $$\n\n数据以样本组内相关性 ($r_{MZ}, r_{DZ}$) 和样本量 ($n_{MZ}, n_{DZ}$) 的形式提供。表型得分是标准化的，因此样本方差为 $1$。因此，样本协方差矩阵为：\n$$ S_{MZ} = \\begin{pmatrix} 1  r_{MZ} \\\\ r_{MZ}  1 \\end{pmatrix}, \\quad S_{DZ} = \\begin{pmatrix} 1  r_{DZ} \\\\ r_{DZ}  1 \\end{pmatrix} $$\n\n模型的参数通过最小化两个双生子组的总负二倍对数似然 ($-2\\ell$) 来估计。对于具有样本协方差矩阵 $S$ 和模型预测协方差矩阵 $\\Sigma$ 的 $n$ 对单一组，该函数由下式给出：\n$$ -2\\llap{\\raisebox{0.5ex}{$\\scriptstyle\\ell$}} = n \\left( \\log|\\Sigma| + \\mathrm{tr}(S\\Sigma^{-1}) \\right) $$\n要最小化的总函数是 MZ 和 DZ 组的总和：\n$$ -2\\ell_{\\text{total}}(\\mathrm{A,C,E}) = n_{MZ} \\left(\\log|\\Sigma_{MZ}| + \\mathrm{tr}(S_{MZ}\\Sigma_{MZ}^{-1})\\right) + n_{DZ} \\left(\\log|\\Sigma_{DZ}| + \\mathrm{tr}(S_{DZ}\\Sigma_{DZ}^{-1})\\right) $$\n令 $v = \\mathrm{A}+\\mathrm{C}+\\mathrm{E}$，$c_{MZ} = \\mathrm{A}+\\mathrm{C}$，以及 $c_{DZ} = 0.5\\mathrm{A}+\\mathrm{C}$。要最小化的函数是：\n$$ -2\\ell_{\\text{total}} = n_{MZ} \\left[ \\log(v^2 - c_{MZ}^2) + \\frac{2(v - r_{MZ}c_{MZ})}{v^2 - c_{MZ}^2} \\right] + n_{DZ} \\left[ \\log(v^2 - c_{DZ}^2) + \\frac{2(v - r_{DZ}c_{DZ})}{v^2 - c_{DZ}^2} \\right] $$\n\n估计过程分两步进行：\n1.  **ACE 模型拟合**：通过在非负约束条件下数值最小化函数 $-2\\ell_{\\text{total}}(\\mathrm{A,C,E})$ 来估计参数 $\\mathrm{A}$、$\\mathrm{C}$ 和 $\\mathrm{E}$。这将得出参数估计值 $\\hat{\\mathrm{A}}$、$\\hat{\\mathrm{C}}$、$\\hat{\\mathrm{E}}$ 和最小化的对数似然值 $-2\\ell_{ACE}$。\n\n2.  **AE 模型拟合**：通过设置 $\\mathrm{C}=0$ 来拟合一个嵌套的、更简约的模型。这个 AE 模型假定只有加性遗传和独特环境因素影响该性状。通过最小化 $-2\\ell_{\\text{total}}(\\mathrm{A},0,\\mathrm{E})$ 来估计参数 $\\mathrm{A}$ 和 $\\mathrm{E}$，从而得到值 $-2\\ell_{AE}$。\n\n为了检验共享环境对总方差有显著贡献的假设 ($H_0: \\mathrm{C}=0$)，我们使用似然比检验。检验统计量 $D$ 是嵌套模型 (AE) 和完整模型 (ACE) 的最小化负对数似然之差：\n$$ D = (-2\\ell_{AE}) - (-2\\ell_{ACE}) $$\n在原假设下，该统计量渐近服从卡方 ($\\chi^2$) 分布。该检验的自由度是两个模型自由参数数量之差，即 $3-2=1$。因此，$D \\sim \\chi^2_1$。\n\n$p$ 值计算为在原假设分布下观测到等于或比 $D$ 更极端的检验统计量的概率，即 $P(X \\ge D)$，其中 $X \\sim \\chi^2_1$。小于显著性水平 $\\alpha=0.05$ 的 $p$ 值会导致拒绝原假设，表明共享环境的贡献在统计上是显著的。\n\n整个过程是自动化的。对于每个测试用例，使用一种数值优化算法 (L-BFGS-B) 在指定约束下为 ACE 和 AE 模型找到最大似然估计。然后计算 LRT 统计量和相应的 $p$ 值，以得出最终决策。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Solves the quantitative genetics problem for all test cases.\n    It fits ACE and AE models to twin correlation data, performs a\n    likelihood ratio test, and reports the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'r_mz': 0.70, 'r_dz': 0.35, 'n_mz': 150, 'n_dz': 250},\n        {'r_mz': 0.60, 'r_dz': 0.50, 'n_mz': 180, 'n_dz': 180},\n        {'r_mz': 0.25, 'r_dz': 0.05, 'n_mz': 120, 'n_dz': 220},\n        {'r_mz': 0.90, 'r_dz': 0.45, 'n_mz': 40, 'n_dz': 60}\n    ]\n\n    def neg_log_likelihood(params, r_mz, r_dz, n_mz, n_dz, model_type):\n        \"\"\"\n        Calculates the total negative twice log-likelihood for ACE or AE models.\n        \"\"\"\n        if model_type == 'ACE':\n            A, C, E = params\n        elif model_type == 'AE':\n            A, E = params\n            C = 0.0\n        else:\n            raise ValueError(\"model_type must be 'ACE' or 'AE'\")\n        \n        # Enforce non-negativity constraint. Optimizer handles this via bounds,\n        # but good practice for robustness.\n        if A  0 or C  0 or E  0:\n            return np.inf\n\n        v = A + C + E # Total variance\n\n        # Handle singularity\n        if v  1e-9:\n            return np.inf\n\n        # MZ group calculations\n        c_mz = A + C\n        rho_mz_sq = (c_mz / v)**2\n        if rho_mz_sq >= 1.0: # Numerical stability\n            return np.inf\n        log_det_mz = np.log(v**2 * (1 - rho_mz_sq))\n        tr_term_mz = 2 * (v - r_mz * c_mz) / (v**2 * (1 - rho_mz_sq))\n        nll_mz = n_mz * (log_det_mz + tr_term_mz)\n\n        # DZ group calculations\n        c_dz = 0.5 * A + C\n        rho_dz_sq = (c_dz / v)**2\n        if rho_dz_sq >= 1.0: # Numerical stability\n            return np.inf\n        log_det_dz = np.log(v**2 * (1 - rho_dz_sq))\n        tr_term_dz = 2 * (v - r_dz * c_dz) / (v**2 * (1 - rho_dz_sq))\n        nll_dz = n_dz * (log_det_dz + tr_term_dz)\n\n        return nll_mz + nll_dz\n\n    results_as_strings = []\n    for case in test_cases:\n        r_mz, r_dz = case['r_mz'], case['r_dz']\n        n_mz, n_dz = case['n_mz'], case['n_dz']\n        \n        args = (r_mz, r_dz, n_mz, n_dz)\n\n        # --- ACE Model Fit ---\n        # Initial guess from Falconer's formulae (clipping C at 0)\n        a0 = 2 * (r_mz - r_dz)\n        c0 = r_mz - a0\n        if c0  0: c0=0\n        e0 = 1 - a0- c0\n        if e0  0: e0=0\n        initial_guess_ace = np.array([a0, c0, e0])\n        bounds_ace = [(0, None), (0, None), (0, None)]\n        \n        res_ace = minimize(\n            fun=neg_log_likelihood,\n            x0=initial_guess_ace,\n            args=(*args, 'ACE'),\n            method='L-BFGS-B',\n            bounds=bounds_ace\n        )\n        a_hat, c_hat, e_hat = res_ace.x\n        nll_ace = res_ace.fun\n\n        # --- AE Model Fit ---\n        initial_guess_ae = np.array([r_mz, 1.0 - r_mz])\n        bounds_ae = [(0, None), (0, None)]\n\n        res_ae = minimize(\n            fun=neg_log_likelihood,\n            x0=initial_guess_ae,\n            args=(*args, 'AE'),\n            method='L-BFGS-B',\n            bounds=bounds_ae\n        )\n        nll_ae = res_ae.fun\n        \n        # --- Likelihood Ratio Test ---\n        # Ensure LRT statistic is non-negative, accounting for potential\n        # tiny numerical floating point errors.\n        lrt_stat = max(0, nll_ae - nll_ace)\n        \n        # p-value from chi-squared distribution with 1 degree of freedom\n        p_value = chi2.sf(lrt_stat, df=1)\n        \n        # Decision\n        decision = p_value  0.05\n        \n        # Format and store result\n        res_str = f\"[{a_hat:.3f},{c_hat:.3f},{e_hat:.3f},{p_value:.3f},{decision}]\"\n        results_as_strings.append(res_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n```", "id": "5054375"}, {"introduction": "在探究了性状的遗传基础后，我们转向其神经层面的实现机制。许多神经精神障碍的核心假说之一是神经环路中兴奋（E）与抑制（I）的失衡。本练习旨在将这一抽象概念具体化，你将使用一个简洁而深刻的皮层微环路数学模型，通过分析该模型的稳定性来揭示突触连接强度如何决定网络是维持健康的稳定状态，还是陷入失控的过度兴奋。[@problem_id:5054391] 这为你理解环路功能障碍的产生提供了清晰的动力学视角。", "problem": "考虑一个由兴奋性群体和抑制性群体组成的$2$-群体皮层微电路。令群体活动向量为 $\\mathbf{r}(t) = \\begin{pmatrix} r_{\\mathrm{E}}(t) \\\\ r_{\\mathrm{I}}(t) \\end{pmatrix}$，其中 $r_{\\mathrm{E}}(t)$ 和 $r_{\\mathrm{I}}(t)$ 分别是兴奋性神经元和抑制性神经元的瞬时发放率。在稳态附近，假设由背景波动驱动的线性化动力学为：\n$$\\frac{d\\mathbf{r}}{dt} = -\\mathbf{r} + g\\, W\\, \\mathbf{r} + \\boldsymbol{\\xi}(t),$$ \n其中 $\\boldsymbol{\\xi}(t)$ 代表零均值外部随机输入，$g  0$ 是一个有效的突触增益，可受神经生物学因素（如N-甲基-D-天冬氨酸（NMDA）受体效能和γ-氨基丁酸（GABA）能抑制）的调节，而 $W$ 是有效连接矩阵，捕捉了两个群体之间和内部的平均耦合强度：\n$$\nW = \\begin{pmatrix}\nw_{\\mathrm{EE}}  -w_{\\mathrm{EI}} \\\\\nw_{\\mathrm{IE}}  -w_{\\mathrm{II}}\n\\end{pmatrix}.\n$$\n此处 $w_{\\mathrm{EE}}  0$ 是兴奋性到兴奋性的耦合，$w_{\\mathrm{EI}}  0$ 是从抑制性到兴奋性的抑制强度（在矩阵中以负号出现，因为抑制性突触会降低活动），$w_{\\mathrm{IE}}  0$ 是兴奋性到抑制性的耦合，$w_{\\mathrm{II}}  0$ 是抑制性到抑制性的耦合。这个最小模型被广泛用于概念化兴奋-抑制平衡及其在精神病和神经发育障碍中的扰动（例如，在精神分裂症中，改变的 $g$ 反映了 NMDA 功能减退，或在自闭症谱系障碍中，GABA能中间神经元效能的变化）。\n\n从上述定义和基本的线性系统稳定性出发，计算 $W$ 的特征值，并解析确定临界增益 $g^{\\star}$，在该增益下，线性算子 $g\\, W - \\mathbf{I}$ 的特征值的最大实部穿过零。将此阈值解释为区分两个区域：一个是由波动产生平衡的非规则活动的区域（具有噪声驱动变异性的稳定动力学），另一个是失控兴奋的区域（具有发散活动的不稳定动力学）。请直接从 $W$ 的特征多项式进行推导，不要假设任何数值。作为最终答案，报告 $g^{\\star}$ 关于 $w_{\\mathrm{EE}}, w_{\\mathrm{EI}}, w_{\\mathrm{IE}}, w_{\\mathrm{II}}$ 的闭式表达式。无需四舍五入。", "solution": "系统的动力学由以下线性随机微分方程描述：\n$$\n\\frac{d\\mathbf{r}}{dt} = (gW - \\mathbf{I})\\mathbf{r} + \\boldsymbol{\\xi}(t)\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。系统确定性部分的稳定性由矩阵 $M = gW - \\mathbf{I}$ 的特征值决定。系统稳定的充要条件是 $M$ 的所有特征值都具有负实部。当至少一个特征值的实部穿过零变为正值时，系统发生向不稳定的转变。临界增益 $g^{\\star}$ 是发生此转变的最小正 $g$ 值。\n\n令 $\\lambda_W$ 为连接矩阵 $W$ 的一个特征值。则 $M = gW - \\mathbf{I}$ 的特征值为 $\\lambda_M = g\\lambda_W - 1$。当 $\\text{Re}(\\lambda_M) = 0$ 时达到稳定性边界。这得出：\n$$\n\\text{Re}(g\\lambda_W - 1) = 0 \\implies g \\text{Re}(\\lambda_W) - 1 = 0 \\implies g = \\frac{1}{\\text{Re}(\\lambda_W)}\n$$\n由于 $g$ 必须为正，这种转变只有在 $W$ 存在一个具有正实部的特征值时才可能发生。当 $g$ 从 $0$ 开始增加时，第一个不稳定性将由 $W$ 的具有最大实部的特征值触发。令此值为 $\\max_{\\lambda_W} \\text{Re}(\\lambda_W)$。因此，临界增益为：\n$$\ng^{\\star} = \\frac{1}{\\max_{\\lambda_W} \\text{Re}(\\lambda_W)}\n$$\n问题要求我们从 $W$ 的特征多项式开始。矩阵 $W$ 为：\n$$\nW = \\begin{pmatrix}\nw_{\\mathrm{EE}}  -w_{\\mathrm{EI}} \\\\\nw_{\\mathrm{IE}}  -w_{\\mathrm{II}}\n\\end{pmatrix}\n$$\n特征方程为 $\\det(W - \\lambda_W \\mathbf{I}) = 0$：\n$$\n\\det \\begin{pmatrix}\nw_{\\mathrm{EE}} - \\lambda_W  -w_{\\mathrm{EI}} \\\\\nw_{\\mathrm{IE}}  -w_{\\mathrm{II}} - \\lambda_W\n\\end{pmatrix} = 0\n$$\n$$\n(w_{\\mathrm{EE}} - \\lambda_W)(-w_{\\mathrm{II}} - \\lambda_W) - (-w_{\\mathrm{EI}})(w_{\\mathrm{IE}}) = 0\n$$\n$$\n\\lambda_W^2 + w_{\\mathrm{II}}\\lambda_W - w_{\\mathrm{EE}}\\lambda_W - w_{\\mathrm{EE}}w_{\\mathrm{II}} + w_{\\mathrm{EI}}w_{\\mathrm{IE}} = 0\n$$\n$$\n\\lambda_W^2 - (w_{\\mathrm{EE}} - w_{\\mathrm{II}})\\lambda_W + (w_{\\mathrm{EI}}w_{\\mathrm{IE}} - w_{\\mathrm{EE}}w_{\\mathrm{II}}) = 0\n$$\n这是一个标准的二次方程 $\\lambda_W^2 - \\text{Tr}(W)\\lambda_W + \\det(W) = 0$。$W$ 的特征值是该多项式的根：\n$$\n\\lambda_{W, \\pm} = \\frac{(w_{\\mathrm{EE}} - w_{\\mathrm{II}}) \\pm \\sqrt{(w_{\\mathrm{EE}} - w_{\\mathrm{II}})^2 - 4(w_{\\mathrm{EI}}w_{\\mathrm{IE}} - w_{\\mathrm{EE}}w_{\\mathrm{II}})}}{2}\n$$\n平方根内的项是判别式，我们可以将其简化：\n$$\n\\Delta = (w_{\\mathrm{EE}} - w_{\\mathrm{II}})^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}} + 4w_{\\mathrm{EE}}w_{\\mathrm{II}} = w_{\\mathrm{EE}}^2 - 2w_{\\mathrm{EE}}w_{\\mathrm{II}} + w_{\\mathrm{II}}^2 + 4w_{\\mathrm{EE}}w_{\\mathrm{II}} - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}}\n$$\n$$\n\\Delta = w_{\\mathrm{EE}}^2 + 2w_{\\mathrm{EE}}w_{\\mathrm{II}} + w_{\\mathrm{II}}^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}} = (w_{\\mathrm{EE}} + w_{\\mathrm{II}})^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}}\n$$\n所以 $W$ 的特征值为：\n$$\n\\lambda_{W, \\pm} = \\frac{(w_{\\mathrm{EE}} - w_{\\mathrm{II}}) \\pm \\sqrt{(w_{\\mathrm{EE}} + w_{\\mathrm{II}})^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}}}}{2}\n$$\n为了找到 $\\max_{\\lambda_W} \\text{Re}(\\lambda_W)$，我们根据判别式 $\\Delta$ 的符号考虑两种情况：\n\n情况1：$\\Delta \\ge 0$。特征值 $\\lambda_{W, \\pm}$ 是实数。最大实部就是较大的特征值 $\\lambda_{W, +}$：\n$$\n\\max \\text{Re}(\\lambda_W) = \\lambda_{W, +} = \\frac{(w_{\\mathrm{EE}} - w_{\\mathrm{II}}) + \\sqrt{(w_{\\mathrm{EE}} + w_{\\mathrm{II}})^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}}}}{2}\n$$\n\n情况2：$\\Delta  0$。特征值是一对共轭复数。项 $\\sqrt{\\Delta}$ 是虚数。两个特征值的实部相同：\n$$\n\\max \\text{Re}(\\lambda_W) = \\frac{w_{\\mathrm{EE}} - w_{\\mathrm{II}}}{2}\n$$\n\n我们可以写出一个覆盖两种情况的单一闭式表达式。一个数 $z$ 的平方根的实部可以用最大值函数来写。具体来说，对于实数 $\\Delta$，$\\text{Re}(\\sqrt{\\Delta}) = \\sqrt{\\max(0, \\Delta)}$。\n如果 $\\Delta \\ge 0$，则 $\\text{Re}(\\sqrt{\\Delta}) = \\sqrt{\\Delta}$。\n如果 $\\Delta  0$，$\\sqrt{\\Delta}$ 是纯虚数，所以 $\\text{Re}(\\sqrt{\\Delta}) = 0$。\n表达式 $\\sqrt{\\max(0, \\Delta)}$ 正确地捕捉了这种行为。因此，我们可以为 $W$ 的特征值的最大实部写出一个统一的表达式：\n$$\n\\max_{\\lambda_W} \\text{Re}(\\lambda_W) = \\frac{(w_{\\mathrm{EE}} - w_{\\mathrm{II}}) + \\text{Re}\\left(\\sqrt{\\Delta}\\right)}{2} = \\frac{(w_{\\mathrm{EE}} - w_{\\mathrm{II}}) + \\sqrt{\\max\\left(0, (w_{\\mathrm{EE}} + w_{\\mathrm{II}})^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}}\\right)}}{2}\n$$\n问题暗示对于 $g0$ 存在不稳定性，意味着 $\\max \\text{Re}(\\lambda_W)  0$。临界增益 $g^{\\star}$ 是该值的倒数：\n$$\ng^{\\star} = \\frac{1}{\\max_{\\lambda_W} \\text{Re}(\\lambda_W)} = \\frac{2}{(w_{\\mathrm{EE}} - w_{\\mathrm{II}}) + \\sqrt{\\max\\left(0, (w_{\\mathrm{EE}} + w_{\\mathrm{II}})^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}}\\right)}}\n$$\n这个表达式给出了系统失去稳定性时的临界增益，对应于从平衡的、噪声驱动的活动稳定区域到失控兴奋的不稳定区域的转变。", "answer": "$$\n\\boxed{\\frac{2}{(w_{\\mathrm{EE}} - w_{\\mathrm{II}}) + \\sqrt{\\max\\left(0, (w_{\\mathrm{EE}} + w_{\\mathrm{II}})^2 - 4w_{\\mathrm{EI}}w_{\\mathrm{IE}}\\right)}}}\n$$", "id": "5054391"}, {"introduction": "神经环路的功能建立在突触通讯之上，而突触通讯的核心是神经递质受体。本练习将带你深入神经药理学的前沿，探索药物如何与大脑相互作用。你将运用化学反应中的质量作用定律，定量计算一种精神科药物如何与大脑内源性神经递质竞争相同的受体结合位点。[@problem_id:5054336] 这个计算是理解药物剂量、疗效以及药物如何调节神经活动以达到治疗效果的关键一步。", "problem": "一名精神分裂症患者正在使用多巴胺受体稳定剂aripiprazole进行治疗，同时使用甘氨酸位点部分激动剂D-cycloserine来解决符合自闭症谱系障碍特征的共病社交沟通障碍。在稳态下，假设每个受体只有一个结合位点、受体守恒，并且平衡受可逆结合的质量作用定律支配。解离常数定义为 $K_{d} = \\frac{[R][L]}{[RL]}$，其中 $[R]$ 是游离受体，$[L]$ 是游离配体，$[RL]$ 是受体-配体复合物。对于竞争相同正构位点的多种配体，每种配体的结合都遵循相同的定律。忽略受体内化、脱敏和下游信号传导效应，并假设下面给出的游离配体浓度在脑细胞外间隙中保持不变。\n\n对于多巴胺 $\\mathrm{D2}$ 受体：\n- 内源性多巴胺的浓度为 $[{\\mathrm{DA}}] = 40\\,\\mathrm{nM}$，解离常数为 $K_{d,\\mathrm{DA}} = 30\\,\\mathrm{nM}$。\n- Aripiprazole的游离脑浓度为 $[{\\mathrm{Ari}}] = 5\\,\\mathrm{nM}$，解离常数为 $K_{d,\\mathrm{Ari}} = 0.5\\,\\mathrm{nM}$。\n\n假设多巴胺和aripiprazole竞争$\\mathrm{D2}$上的相同正构结合位点。\n\n对于N-甲基-D-天冬氨酸（NMDA）受体甘氨酸共激动剂位点：\n- 内源性甘氨酸的浓度为 $[{\\mathrm{Gly}}] = 10\\,\\mu\\mathrm{M}$，解离常数为 $K_{d,\\mathrm{Gly}} = 1\\,\\mu\\mathrm{M}$。\n- D-cycloserine的浓度为 $[{\\mathrm{DCS}}] = 20\\,\\mu\\mathrm{M}$，解离常数为 $K_{d,\\mathrm{DCS}} = 80\\,\\mu\\mathrm{M}$。\n\n假设甘氨酸和D-cycloserine竞争NMDA上的相同甘氨酸位点。\n\n使用源自质量作用定律和受体守恒的类Michaelis–Menten饱和动力学，计算每种受体类型上被任一激动剂结合的受体平衡分数占有率，该值定义为稳态下总受体池中被任一竞争性激动剂结合的部分。首先计算$\\mathrm{D2}$受体，然后计算NMDA受体（甘氨酸位点）。将每个占有率四舍五入至四位有效数字，并将最终占有率表示为无单位的小数。以一个包含两个条目的行矩阵形式提供您的最终答案，其中$\\mathrm{D2}$占有率在前，NMDA占有率在后。", "solution": "该问题要求计算当存在两种竞争性配体（配体 $L_1$ 和配体 $L_2$）时，受体的总分数占有率。总分数占有率 $\\theta_{total}$ 是被任一配体结合的受体占总受体群体 $[R_T]$ 的比例。\n\n$$\n\\theta_{total} = \\frac{[RL_1] + [RL_2]}{[R_T]}\n$$\n\n根据受体守恒原理，总受体浓度 $[R_T]$ 是游离受体 $[R]$ 和所有结合的受体种类的总和。\n$$\n[R_T] = [R] + [RL_1] + [RL_2]\n$$\n\n根据解离常数的定义 $K_d = \\frac{[R][L]}{[RL]}$，我们可以用游离受体浓度 $[R]$、游离配体浓度 $[L]$ 和各自的解离常数 $K_d$ 来表示每种受体-配体复合物的浓度。\n$$\n[RL_1] = \\frac{[R][L_1]}{K_{d1}}\n$$\n$$\n[RL_2] = \\frac{[R][L_2]}{K_{d2}}\n$$\n\n将这些表达式代入受体守恒方程：\n$$\n[R_T] = [R] + \\frac{[R][L_1]}{K_{d1}} + \\frac{[R][L_2]}{K_{d2}} = [R] \\left( 1 + \\frac{[L_1]}{K_{d1}} + \\frac{[L_2]}{K_{d2}} \\right)\n$$\n\n分数占有率方程的分子是 $[RL_1] + [RL_2]$。我们也可以用 $[R]$ 来表示它：\n$$\n[RL_1] + [RL_2] = \\frac{[R][L_1]}{K_{d1}} + \\frac{[R][L_2]}{K_{d2}} = [R] \\left( \\frac{[L_1]}{K_{d1}} + \\frac{[L_2]}{K_{d2}} \\right)\n$$\n\n现在，我们可以通过代入分子和分母的表达式来写出 $\\theta_{total}$ 的表达式：\n$$\n\\theta_{total} = \\frac{[R] \\left( \\frac{[L_1]}{K_{d1}} + \\frac{[L_2]}{K_{d2}} \\right)}{[R] \\left( 1 + \\frac{[L_1]}{K_{d1}} + \\frac{[L_2]}{K_{d2}} \\right)}\n$$\n\n游离受体浓度项 $[R]$ 被消去，得到竞争性结合条件下总分数占有率的通用公式：\n$$\n\\theta_{total} = \\frac{\\frac{[L_1]}{K_{d1}} + \\frac{[L_2]}{K_{d2}}}{1 + \\frac{[L_1]}{K_{d1}} + \\frac{[L_2]}{K_{d2}}}\n$$\n\n此公式将应用于每个受体系统。\n\n**1. 多巴胺 D2 受体系统**\n竞争性配体是内源性多巴胺（DA）和aripiprazole（Ari）。\n- $[L_1] = [\\mathrm{DA}] = 40\\,\\mathrm{nM}$\n- $K_{d1} = K_{d,\\mathrm{DA}} = 30\\,\\mathrm{nM}$\n- $[L_2] = [\\mathrm{Ari}] = 5\\,\\mathrm{nM}$\n- $K_{d2} = K_{d,\\mathrm{Ari}} = 0.5\\,\\mathrm{nM}$\n\n首先，我们计算归一化浓度项：\n$$\n\\frac{[\\mathrm{DA}]}{K_{d,\\mathrm{DA}}} = \\frac{40\\,\\mathrm{nM}}{30\\,\\mathrm{nM}} = \\frac{4}{3}\n$$\n$$\n\\frac{[\\mathrm{Ari}]}{K_{d,\\mathrm{Ari}}} = \\frac{5\\,\\mathrm{nM}}{0.5\\,\\mathrm{nM}} = 10\n$$\n\n现在，将这些值代入总分数占有率公式：\n$$\n\\theta_{\\mathrm{D2}, total} = \\frac{\\frac{4}{3} + 10}{1 + \\frac{4}{3} + 10} = \\frac{\\frac{4+30}{3}}{1 + \\frac{4+30}{3}} = \\frac{\\frac{34}{3}}{\\frac{3}{3} + \\frac{34}{3}} = \\frac{\\frac{34}{3}}{\\frac{37}{3}} = \\frac{34}{37}\n$$\n\n将此分数转换为小数并四舍五入至四位有效数字：\n$$\n\\theta_{\\mathrm{D2}, total} \\approx 0.9189189... \\approx 0.9189\n$$\n\n**2. NMDA 受体甘氨酸位点系统**\n竞争性配体是内源性甘氨酸（Gly）和D-cycloserine（DCS）。\n- $[L_1] = [\\mathrm{Gly}] = 10\\,\\mu\\mathrm{M}$\n- $K_{d1} = K_{d,\\mathrm{Gly}} = 1\\,\\mu\\mathrm{M}$\n- $[L_2] = [\\mathrm{DCS}] = 20\\,\\mu\\mathrm{M}$\n- $K_{d2} = K_{d,\\mathrm{DCS}} = 80\\,\\mu\\mathrm{M}$\n\n首先，我们计算归一化浓度项：\n$$\n\\frac{[\\mathrm{Gly}]}{K_{d,\\mathrm{Gly}}} = \\frac{10\\,\\mu\\mathrm{M}}{1\\,\\mu\\mathrm{M}} = 10\n$$\n$$\n\\frac{[\\mathrm{DCS}]}{K_{d,\\mathrm{DCS}}} = \\frac{20\\,\\mu\\mathrm{M}}{80\\,\\mu\\mathrm{M}} = \\frac{1}{4} = 0.25\n$$\n\n现在，将这些值代入总分数占有率公式：\n$$\n\\theta_{\\mathrm{NMDA}, total} = \\frac{10 + 0.25}{1 + 10 + 0.25} = \\frac{10.25}{11.25} = \\frac{1025}{1125}\n$$\n\n为了简化分数，我们可以用公因数去除分子和分母。两者都可以被 $25$ 整除。\n$$\n1025 = 41 \\times 25\n$$\n$$\n1125 = 45 \\times 25\n$$\n所以，分数简化为：\n$$\n\\theta_{\\mathrm{NMDA}, total} = \\frac{41}{45}\n$$\n\n将此分数转换为小数并四舍五入至四位有效数字：\n$$\n\\theta_{\\mathrm{NMDA}, total} \\approx 0.9111111... \\approx 0.9111\n$$\n\n最终答案要求将D2受体和NMDA受体甘氨酸位点的两个占有率分别呈现在一个双条目行矩阵中。\n- D2受体总分数占有率：$0.9189$\n- NMDA受体甘氨酸位点总分数占有率：$0.9111$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9189  0.9111\n\\end{pmatrix}\n}\n$$", "id": "5054336"}]}