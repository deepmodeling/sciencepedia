{"hands_on_practices": [{"introduction": "亨廷顿病的一个核心病理特征是突变的亨廷顿蛋白 (mHTT) 的错误折叠和聚集。这个练习将这个复杂的过程简化为一个可管理的化学平衡模型，帮助你理解不同的蛋白质形态——单体、寡聚体和纤维——是如何根据热力学原理进行动态分配的 [@problem_id:5025629]。通过推导平衡浓度，你将亲身体验如何使用基本的生物物理原理来洞察致病蛋白质的行为。", "problem": "亨廷顿病病理生理学的一个核心特征是，带有扩展多聚谷氨酰胺 (polyQ) 链的突变亨廷顿蛋白 (mHTT) 发生错误折叠和自组装，形成寡聚体和纤维。考虑一个粗粒化准平衡模型，其中 mHTT 单体等效物的细胞池分布于三种构象状态：单体 $M$、寡聚体 $O$ 和纤维 $F$。设单体等效物的总浓度为 $C_T$，因此质量守恒要求 $[M] + [O] + [F] = C_T$。假设各状态之间处于热力学平衡，并根据状态相互转换的质量作用定律定义无量纲平衡常数：$M \\rightleftharpoons O$ 的平衡常数为 $K_1$，$O \\rightleftharpoons F$ 的平衡常数为 $K_2$，其中 $K_1 \\equiv \\frac{[O]}{[M]}$ 且 $K_2 \\equiv \\frac{[F]}{[O]}$。从这些定义和质量守恒约束出发，推导平衡浓度 $[M]$、$[O]$ 和 $[F]$ 作为 $K_1$、$K_2$ 和 $C_T$ 的函数的解析表达式。然后，使用第一性原理，确定寡聚体群体占主导地位（即寡聚体浓度超过单体和纤维浓度）的参数范围（用 $K_1$ 和 $K_2$ 表示）。以闭合形式的符号表达式提供最终的平衡浓度。如果进行任何数值计算，请以微摩尔浓度表示，但本题不要求进行数值计算。最终报告的答案必须是一个包含 $[M]$、$[O]$ 和 $[F]$ 作为 $K_1$、$K_2$ 和 $C_T$ 的函数的单行向量。", "solution": "用户提供了一个需要解决的问题。根据说明，第一步是验证问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n-   **构象状态：** 单体 ($M$)、寡聚体 ($O$)、纤维 ($F$)。\n-   **总浓度：** 单体等效物的总浓度为 $C_T$。\n-   **质量守恒：** $[M] + [O] + [F] = C_T$。\n-   **平衡反应：** $M \\rightleftharpoons O$ 和 $O \\rightleftharpoons F$。\n-   **平衡常数：** $K_1 \\equiv \\frac{[O]}{[M]}$ 和 $K_2 \\equiv \\frac{[F]}{[O]}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准评估问题的有效性。\n-   **有科学依据：** 该问题描述了一个简化的蛋白质聚集准平衡模型，这是生物物理化学和神经生物学中常用且有效的方法。质量作用定律和质量守恒约束的使用是基本原理。亨廷顿病和突变亨廷顿蛋白 (mHTT) 的背景是科学准确的。\n-   **适定性：** 该问题为三个未知浓度（$[M]$, $[O]$, $[F]$）提供了一个包含三个线性代数方程的方程组。该系统是自洽、一致的，并且有唯一解。\n-   **客观性：** 该问题使用精确的数学关系和客观的语言进行定义。没有主观或基于观点的论断。\n-   **其他缺陷：** 该问题没有违反任何其他无效性标准。它是可形式化的、完整的、可行的、结构良好的、非平凡的，并且在科学上是可验证的。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。现在开始求解过程。\n\n### 解题推导\n目标是根据总浓度 $C_T$ 和平衡常数 $K_1$、$K_2$ 求出平衡浓度 $[M]$、$[O]$ 和 $[F]$。该系统由以下三个方程定义：\n1.  质量守恒：$[M] + [O] + [F] = C_T$\n2.  第一个平衡：$[O] = K_1 [M]$\n3.  第二个平衡：$[F] = K_2 [O]$\n\n我们可以用 $[M]$ 来表示 $[O]$ 和 $[F]$。$[O]$ 的表达式已由方程 (2) 给出。为了用 $[M]$ 表示 $[F]$，我们将方程 (2) 代入方程 (3)：\n$$[F] = K_2 ([O]) = K_2 (K_1 [M]) = K_1 K_2 [M]$$\n\n现在，我们得到了 $[O]$ 和 $[F]$ 作为 $[M]$ 的函数。我们可以将这些表达式代入质量守恒方程 (1)：\n$$[M] + (K_1 [M]) + (K_1 K_2 [M]) = C_T$$\n\n从方程左侧提取公因式 $[M]$：\n$$[M] (1 + K_1 + K_1 K_2) = C_T$$\n\n解出 $[M]$，得到单体的平衡浓度：\n$$[M] = \\frac{C_T}{1 + K_1 + K_1 K_2}$$\n\n在已知 $[M]$ 的表达式后，我们可以求出寡聚体 $[O]$ 和纤维 $[F]$ 的平衡浓度。\n\n对于寡聚体浓度 $[O]$，我们使用方程 (2)：\n$$[O] = K_1 [M] = K_1 \\left( \\frac{C_T}{1 + K_1 + K_1 K_2} \\right) = \\frac{K_1 C_T}{1 + K_1 + K_1 K_2}$$\n\n对于纤维浓度 $[F]$，我们使用关系式 $[F] = K_1 K_2 [M]$：\n$$[F] = K_1 K_2 [M] = K_1 K_2 \\left( \\frac{C_T}{1 + K_1 + K_1 K_2} \\right) = \\frac{K_1 K_2 C_T}{1 + K_1 + K_1 K_2}$$\n\n这三个表达式给出了每种物种的平衡浓度，它们是给定参数的函数。\n\n### 寡聚体主导性分析\n问题的第二部分要求确定寡聚体群体占主导地位的参数范围，即其浓度大于单体和纤维浓度的范围。这由以下联立不等式表示：\n1.  $[O] > [M]$\n2.  $[O] > [F]$\n\n我们来分析第一个不等式 $[O] > [M]$：\n$$\\frac{K_1 C_T}{1 + K_1 + K_1 K_2} > \\frac{C_T}{1 + K_1 + K_1 K_2}$$\n由于浓度和平衡常数是非负的，所以 $C_T > 0$ 且分母 $(1 + K_1 + K_1 K_2)$ 严格为正。因此，我们可以将两边同乘以 $\\frac{1 + K_1 + K_1 K_2}{C_T}$ 而不改变不等号的方向：\n$$K_1 > 1$$\n这个条件意味着平衡 $M \\rightleftharpoons O$ 必须有利于寡聚体的形成。\n\n接下来，我们分析第二个不等式 $[O] > [F]$：\n$$\\frac{K_1 C_T}{1 + K_1 + K_1 K_2} > \\frac{K_1 K_2 C_T}{1 + K_1 + K_1 K_2}$$\n假设 $K_1 > 0$，我们可以将两边同乘以 $\\frac{1 + K_1 + K_1 K_2}{K_1 C_T}$:\n$$1 > K_2$$\n这个条件意味着平衡 $O \\rightleftharpoons F$ 必须有利于寡聚体状态而非纤维状态。\n\n因此，当两个条件 $K_1 > 1$ 和 $K_2  1$ 都满足时，寡聚体群体占主导地位。这个范围对应的情景是，从单体到寡聚体的转化是有利的，但从寡聚体到纤维的转化是不利的，导致中间态寡聚体物种的积累。\n\n最终答案仅要求以特定格式给出推导出的浓度表达式。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{C_T}{1 + K_1 + K_1 K_2}  \\frac{K_1 C_T}{1 + K_1 + K_1 K_2}  \\frac{K_1 K_2 C_T}{1 + K_1 + K_1 K_2} \\end{pmatrix} } $$", "id": "5025629"}, {"introduction": "除了蛋白质聚集，兴奋性毒性是导致纹状体神经元死亡的另一个关键机制。这个练习引导你建立一个模型，量化由NMDA受体过度激活引起的灾难性钙离子 ($Ca^{2+}$) 内流 [@problem_id:5025600]。更进一步，你将计算出阻止这种毒性所需的拮抗剂浓度，从而将药理学原理与神经保护策略直接联系起来。", "problem": "在亨廷顿舞蹈病中，纹状体中型多棘神经元在强谷氨酸能输入和摄取受损期间，因N-甲基-D-天冬氨酸（NMDA）受体的过度激活而经历病理性钙超载。考虑一个单室神经元，其中胞质钙离子浓度（记为 $[Ca^{2+}]$）在持续刺激下遵循一级平衡动力学：$d[Ca^{2+}]/dt = J_{\\mathrm{in}} - k_{\\mathrm{eff}}[Ca^{2+}]$。此处，$J_{\\mathrm{in}}$ 是NMDA受体介导的钙离子内流速率，$k_{\\mathrm{eff}}$ 是一个有效的表征缓冲、泵和隔离作用的一级清除速率常数。在持续输入下，假设细胞膜充分去极化，使得NMDA受体的镁离子阻断被解除，且甘氨酸共激动剂位点达到饱和。进一步假设NMDA受体的开放概率与被谷氨酸占据的受体分数成正比，您必须使用适用于含竞争性拮抗剂的单结合位点的质量作用定律对此进行建模。\n\n设 $[G]$ 为高输入期间的谷氨酸浓度，$[A]$ 为竞争性NMDA受体拮抗剂的浓度，$K_G$ 为谷氨酸的解离常数，$K_A$ 为拮抗剂的解离常数。在这些假设下，设 $J_{\\mathrm{in}} = \\alpha f_G$，其中 $\\alpha$ 是一个缩放受体群最大钙离子内流速率的常数，$f_G$ 是在拮抗剂存在下被谷氨酸占据的受体分数。在稳态下，$[Ca^{2+}]_{\\mathrm{ss}} = J_{\\mathrm{in}}/k_{\\mathrm{eff}}$。\n\n使用以下参数值，这些值被选择用来反映与亨廷顿舞蹈病病理生理学相关的高输入、转运体受损状态：\n- $[G] = 20\\,\\mu\\mathrm{M}$\n- $K_G = 2.0\\,\\mu\\mathrm{M}$\n- $K_A = 1.0\\,\\mu\\mathrm{M}$\n- $\\alpha = 0.15\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{eff}} = 0.25\\,\\mathrm{s}^{-1}$\n- 目标阈值 $[Ca^{2+}]^\\ast = 0.30\\,\\mu\\mathrm{M}$\n\n从适用于含竞争性拮抗剂的单受体结合位点的质量作用定律和上述钙平衡方程出发，推导一个表达式，用于计算在持续高输入条件下能保证 $[Ca^{2+}]_{\\mathrm{ss}} \\le [Ca^{2+}]^\\ast$ 的最小拮抗剂浓度 $[A]_{\\min}$。然后使用所给参数计算其数值。将最终结果四舍五入至两位有效数字。最终的拮抗剂浓度以微摩尔（$\\mu\\mathrm{M}$）为单位表示。", "solution": "所述问题具有科学依据，提法恰当且信息自洽。所用模型是生物物理药理学中的一个标准简化模型，不存在任何矛盾或事实错误。所有必要的参数和关系都已提供，足以得出一个唯一的、有意义的解。因此，该问题是有效的，完整解答如下。\n\n问题的核心是确定所需的竞争性拮抗剂的最小浓度 $[A]_{\\min}$，以将稳态细胞内钙离子浓度 $[Ca^{2+}]_{\\mathrm{ss}}$ 维持在指定阈值 $[Ca^{2+}]^\\ast$ 以下。\n\n首先，我们必须推导在谷氨酸（$[G]$）和竞争性拮抗剂（$[A]$）同时存在时，被谷氨酸占据的NMDA受体分数 $f_G$ 的表达式。根据单结合位点的质量作用定律，激动剂（谷氨酸, $G$）和拮抗剂（$A$）与受体（$R$）结合的平衡关系如下：\n$$R + G \\rightleftharpoons RG \\quad \\text{解离常数为} \\quad K_G = \\frac{[R][G]}{[RG]}$$\n$$R + A \\rightleftharpoons RA \\quad \\text{解离常数为} \\quad K_A = \\frac{[R][A]}{[RA]}$$\n受体的总浓度 $[R]_{\\mathrm{tot}}$ 是所有可能状态下受体浓度之和：未结合（$[R]$）、谷氨酸结合（$[RG]$）和拮抗剂结合（$[RA]$）。\n$$[R]_{\\mathrm{tot}} = [R] + [RG] + [RA]$$\n我们可以用游离受体浓度 $[R]$ 来表示结合状态的浓度：\n$$[RG] = \\frac{[R][G]}{K_G} \\quad \\text{和} \\quad [RA] = \\frac{[R][A]}{K_A}$$\n将这些代入 $[R]_{\\mathrm{tot}}$ 的方程中：\n$$[R]_{\\mathrm{tot}} = [R] + \\frac{[R][G]}{K_G} + \\frac{[R][A]}{K_A} = [R] \\left(1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}\\right)$$\n被谷氨酸占据的受体分数 $f_G$ 是 $[RG]/[R]_{\\mathrm{tot}}$ 的比值：\n$$f_G = \\frac{\\frac{[R][G]}{K_G}}{[R] \\left(1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}\\right)} = \\frac{\\frac{[G]}{K_G}}{1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}}$$\n分子和分母同乘以 $K_G$，得到 $f_G$ 的最终表达式：\n$$f_G = \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}}$$\n接下来，我们建立稳态钙离子浓度 $[Ca^{2+}]_{\\mathrm{ss}}$ 的关系式。系统动力学由 $\\frac{d[Ca^{2+}]}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}[Ca^{2+}]$ 给出。在稳态下，$\\frac{d[Ca^{2+}]}{dt} = 0$，可得：\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{J_{\\mathrm{in}}}{k_{\\mathrm{eff}}}$$\n问题陈述钙离子内流 $J_{\\mathrm{in}}$ 与谷氨酸结合的受体分数成正比，$J_{\\mathrm{in}} = \\alpha f_G$。代入此关系可得：\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{\\alpha f_G}{k_{\\mathrm{eff}}}$$\n现在，我们将 $f_G$ 和 $[Ca^{2+}]_{\\mathrm{ss}}$ 的表达式合并：\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{\\alpha}{k_{\\mathrm{eff}}} \\left( \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}} \\right)$$\n需要满足的条件是 $[Ca^{2+}]_{\\mathrm{ss}} \\le [Ca^{2+}]^\\ast$。为了求得最小拮抗剂浓度 $[A]_{\\min}$，我们解等式 $[Ca^{2+}]_{\\mathrm{ss}} = [Ca^{2+}]^\\ast$。\n$$\\frac{\\alpha}{k_{\\mathrm{eff}}} \\left( \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}} \\right) = [Ca^{2+}]^\\ast$$\n我们重排此方程以求解 $[A]$。由于所有项均为正，我们可以直接处理该表达式：\n$$K_G + [G] + [A]\\frac{K_G}{K_A} = \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast}$$\n分离含有 $[A]$ 的项：\n$$[A]\\frac{K_G}{K_A} = \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast} - (K_G + [G])$$\n最后，求解 $[A]$ 得到所需最小浓度 $[A]_{\\min}$ 的通用表达式：\n$$[A]_{\\min} = \\frac{K_A}{K_G} \\left( \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast} - (K_G + [G]) \\right)$$\n现在，我们将给定的数值代入此表达式：\n- $[G] = 20\\,\\mu\\mathrm{M}$\n- $K_G = 2.0\\,\\mu\\mathrm{M}$\n- $K_A = 1.0\\,\\mu\\mathrm{M}$\n- $\\alpha = 0.15\\,\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{eff}} = 0.25\\,\\mathrm{s}^{-1}$\n- $[Ca^{2+}]^\\ast = 0.30\\,\\mu\\mathrm{M}$\n\n首先，我们计算项 $\\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast}$：\n$$\\frac{(0.15)(20)}{(0.25)(0.30)} \\mu\\mathrm{M} = \\frac{3.0}{0.075} \\mu\\mathrm{M} = 40\\,\\mu\\mathrm{M}$$\n接下来，我们计算项 $(K_G + [G])$：\n$$2.0\\,\\mu\\mathrm{M} + 20\\,\\mu\\mathrm{M} = 22\\,\\mu\\mathrm{M}$$\n将这些结果代回 $[A]_{\\min}$ 的方程中：\n$$[A]_{\\min} = \\frac{1.0}{2.0} \\left( 40\\,\\mu\\mathrm{M} - 22\\,\\mu\\mathrm{M} \\right)$$\n$$[A]_{\\min} = 0.5 \\left( 18\\,\\mu\\mathrm{M} \\right)$$\n$$[A]_{\\min} = 9.0\\,\\mu\\mathrm{M}$$\n结果为 $9.0\\,\\mu\\mathrm{M}$。该值已按要求以两位有效数字表示。", "answer": "$$\\boxed{9.0}$$", "id": "5025600"}, {"introduction": "最后，我们将视角从单个细胞的层面提升到整个神经环路。这个实践要求你构建一个基底节环路的计算模型，来模拟亨廷顿病典型的症状演变——从早期的舞蹈样运动（运动过多）到晚期的运动不能（运动减少）[@problem_id:5025611]。通过这个练习，你将综合运用系统神经科学的知识，以编程的方式再现疾病的临床表现，深刻理解环路功能障碍如何导致复杂的行为表型。", "problem": "您需要构建、解释并实现一个基底节-丘脑-皮层运动输出的离散时间进展模型，该模型通过追踪间接通路中型多棘神经元（MSNs）的退化，并预测运动输出中的阈值交叉转变，来关联亨廷顿病病理生理学中早期的运动功能亢进症状与后期的运动功能减退症状。您必须从核心的神经生物学符号规则和标准的放电率传递函数推导出该模型，然后实现它并在指定的测试套件上进行评估。所有神经活动都应被视为无量纲的任意单位（a.u.）。最终的程序输出必须是单行，包含所有测试用例结果的逗号分隔的 Python 风格列表，具体如下所述。\n\n使用的基础和定义：\n- 基底节环路符号规则。直接通路（纹状体-黑质）抑制苍白球内侧部（GPi），从而去抑制丘脑并促进运动；间接通路（通过苍白球外侧部（GPe）和丘脑底核（STN）的纹状体-苍白球通路）对 GPi 有净兴奋效应，从而抑制丘脑并抑制运动。丘脑兴奋运动皮层。\n- 亨廷顿病早期优先使间接通路 MSNs 退化，有效减少了对 GPi 的净兴奋驱动，导致丘脑去抑制和运动功能亢进；疾病后期涉及的退化减少了直接通路 MSNs 和皮层驱动，增加了 GPi 的影响并导致运动功能减退。\n- 速率模型假设。每个神经核的输出是其输入加权和的单调函数。对丘脑传递函数使用静态逻辑非线性。\n\n待推导和实现的模型规范：\n- 令 $C_t$ 表示离散时间步长 $t$ 时的皮层驱动，单位为 a.u.。\n- 令 $D_t \\in [0,1]$ 表示在时间 $t$ 时完好的直接通路 MSN 的比例，令 $I_t \\in [0,1]$ 表示在时间 $t$ 时完好的间接通路 MSN 的比例。\n- 令 $G_t$ 表示时间 $t$ 时的 GPi 输出， $T_t$ 表示时间 $t$ 时的丘脑输出。\n- 参数是固定常数：基线 GPi 输出 $G_0 = 1.0$ (a.u.)，间接通路增益 $k_I = 1.0$，直接通路增益 $k_D = 1.0$，丘脑预激活偏置 $u_0 = 0.0$，皮层增益 $k_C = 1.0$，GPi 到丘脑的增益 $k_G = 1.0$，以及丘脑逻辑增益 $g = 4.0$（无量纲）。\n- 使用定性符号结构构建以下计算阶段：\n  1) 计算 GPi 输出 $G_t$，作为基线 $G_0$ 加上净间接通路效应（对 GPi 是兴奋性的）减去净直接通路效应（对 GPi 是抑制性的），每项都与相应的 MSN 比例和皮层驱动成正比，这与前馈近似一致。\n  2) 计算丘脑预激活 $U_t$，作为兴奋性皮层项和抑制性 GPi 项之差，并带有偏置 $u_0$。\n  3) 使用斜率参数为 $g$ 的逻辑传递函数 $S(x) = \\dfrac{1}{1 + \\exp(-x)}$ 将 $U_t$ 映射到丘脑输出 $T_t$，即 $T_t = S(g \\, U_t)$。\n  4) 将 $T_t$ 视为 $[0,1]$ 范围内的无量纲运动输出代理。\n- 定义两个具有临床可解释性的阈值：运动功能亢进阈值 $H = 0.8$ 和运动功能减退阈值 $A = 0.2$。运动功能亢进期在最小索引 $t$ 处开始，满足 $T_t \\ge H$。运动功能减退期在最小索引 $t$ 处开始，满足 $T_t \\le A$。如果在给定的序列中不存在这样的索引，则为该转变返回 $-1$。\n\n输入和测试套件（硬编码；无用户输入）：\n对于每个测试用例，您必须按所述生成 $t = 0, 1, \\dots, T-1$ 的离散序列。所有序列和常数都以 a.u. 为单位，不涉及角度。\n- 测试用例 1（正常路径，早期运动功能亢进，后期运动功能减退）：\n  - 时间范围 $T = 11$。\n  - 间接通路完整性 $I_t$ 从 $t = 0$ 时的 $1.0$ 线性减少到 $t = 10$ 时的 $0.2$。\n  - 直接通路完整性 $D_t$ 在 $t \\le 5$ 时保持为 $1.0$，然后线性减少到 $t = 10$ 时的 $0.1$。\n  - 皮层驱动 $C_t$ 在 $t \\le 5$ 时保持为 $1.0$，然后线性减少到 $t = 10$ 时的 $0.5$。\n- 测试用例 2（边缘案例：仅间接通路损失；运动功能亢进但无运动功能减退）：\n  - 时间范围 $T = 11$。\n  - $I_t$ 从 $t = 0$ 时的 $1.0$ 线性减少到 $t = 10$ 时的 $0.2$。\n  - 对于所有 $t$，$D_t \\equiv 1.0$。\n  - 对于所有 $t$，$C_t \\equiv 1.0$。\n- 测试用例 3（边缘案例：后期运动功能减退，无先前的运动功能亢进）：\n  - 时间范围 $T = 11$。\n  - 对于所有 $t$，$I_t \\equiv 0.9$。\n  - $D_t$ 从 $t = 0$ 时的 $1.0$ 线性减少到 $t = 10$ 时的 $0.1$。\n  - $C_t$ 从 $t = 0$ 时的 $1.0$ 线性减少到 $t = 10$ 时的 $0.5$。\n- 测试用例 4（边界条件：精确阈值相等）：\n  - 时间范围 $T = 2$。\n  - 令 $U^\\star = \\dfrac{\\ln 4}{g}$ 以使 $S(g \\, U^\\star) = 0.8$，并令 $U_\\star = -\\dfrac{\\ln 4}{g}$ 以使 $S(g \\, U_\\star) = 0.2$。\n  - 对于 $t = 0$，使用 $C_0 = 1.0, D_0 = 1.0$ 和 $I_0 = 1.0 - U^\\star$，这样 $U_0 = 1.0 - I_0 = U^\\star$ 因而 $T_0 = 0.8$。\n  - 对于 $t = 1$，使用 $C_1 = 1.0$，设置 $I_1 = I_0$，并选择 $D_1 = I_0 + U_\\star$，这样 $U_1 = D_1 - I_1 = U_\\star$ 因而 $T_1 = 0.2$。\n\n必需的计算：\n- 对于每个测试用例，如上生成 $I_t$、$D_t$ 和 $C_t$，然后计算所有 $t$ 的 $G_t$、$U_t$ 和 $T_t$。\n- 确定满足 $T_t \\ge H$ 的最小时间索引 $t_H$ 和满足 $T_t \\le A$ 的最小时间索引 $t_A$。如果在时间范围内从未满足某个条件，则为该索引报告 $-1$。\n- 程序必须输出单行，其中包含一个 Python 风格的列表的列表，其中包含每个测试用例（按 1 到 4 的顺序）的配对 $[t_H, t_A]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如，`[[t_{H,1}, t_{A,1}],[t_{H,2}, t_{A,2}],[t_{H,3}, t_{A,3}],[t_{H,4}, t_{A,4}]]`，其中每个条目都是一个整数。不得打印任何额外文本。", "solution": "该问题要求构建并实现一个基底节-丘脑-皮层环路的离散时间计算模型，以模拟亨廷顿病的运动症状。该模型必须根据指定的神经生物学原理推导出来，然后用于预测一系列测试用例中运动功能亢进和运动功能减退阶段的开始时间。\n\n### 原理与模型推导\n\n该模型基于运动环路中关键神经核的简化速率表示，与已建立的环路图一致。核心组成部分是皮层、纹状体（包括直接和间接通路的中型多棘神经元，或 MSNs）、苍白球内侧部（GPi）和丘脑。控制它们相互作用的符号规则如下：皮层驱动兴奋两个纹状体通路；直接通路最终抑制 GPi；间接通路最终兴奋 GPi；GPi 强直性抑制丘脑；丘脑兴奋运动皮层，从而闭合环路。运动输出通过丘脑去抑制（即 GPi 活动减少）来促进。\n\n亨廷顿病的进展通过 MSN 群体的选择性退化来建模。在疾病早期，退化集中在间接通路 MSNs（$I_t$ 减少）。间接通路功能减弱，减少了对 GPi 的净兴奋驱动。这降低了 GPi 的输出，使丘脑去抑制，并导致过度的运动输出（运动功能亢进）。后期，该疾病也影响直接通路 MSNs（$D_t$ 减少）并减少皮层驱动（$C_t$ 减少）。直接通路功能的丧失减少了对 GPi 的抑制性影响，而皮层驱动的减少则降低了系统的总输入。净效应是 GPi 抑制性输出的病理性增加，这会抑制丘脑活动并导致运动缺失（运动功能减退）。\n\n我们将这个概念模型形式化为一组离散时间方程。所有活动都是无量纲的，单位为任意单位（a.u.）。\n\n**1. GPi 输出 ($G_t$)**\n\n在时间 $t$ 的 GPi 输出，表示为 $G_t$，由基线活动 $G_0$ 决定，并受到直接和间接通路相反效应的调节。\n- 间接通路的净效应对 GPi 是兴奋性的。其影响与完好的间接通路 MSN 的比例 $I_t$、皮层驱动 $C_t$ 和一个增益因子 $k_I$ 成正比。此项为 $+k_I I_t C_t$。\n- 直接通路的净效应对 GPi 是抑制性的。其影响与完好的直接通路 MSN 的比例 $D_t$、皮层驱动 $C_t$ 和一个增益因子 $k_D$ 成正比。此项为 $-k_D D_t C_t$。\n\nGPi 输出的方程为：\n$$\nG_t = G_0 + k_I I_t C_t - k_D D_t C_t\n$$\n使用给定的参数（$G_0=1.0$, $k_I=1.0$, $k_D=1.0$）：\n$$\nG_t = 1.0 + (1.0) \\cdot I_t C_t - (1.0) \\cdot D_t C_t = 1.0 + C_t(I_t - D_t)\n$$\n\n**2. 丘脑预激活 ($U_t$)**\n\n丘脑接收来自皮层的兴奋性输入和来自 GPi 的抑制性输入。其预激活电位 $U_t$ 是这些输入的加权和加上一个偏置项 $u_0$。\n- 来自皮层的兴奋性输入与皮层驱动 $C_t$ 成正比，增益为 $k_C$。项：$+k_C C_t$。\n- 来自 GPi 的抑制性输入与 GPi 输出 $G_t$ 成正比，增益为 $k_G$。项：$-k_G G_t$。\n\n丘脑预激活的方程为：\n$$\nU_t = u_0 + k_C C_t - k_G G_t\n$$\n使用给定的参数（$u_0=0.0$, $k_C=1.0$, $k_G=1.0$）：\n$$\nU_t = 0.0 + (1.0) \\cdot C_t - (1.0) \\cdot G_t = C_t - G_t\n$$\n将 $G_t$ 的表达式代入 $U_t$ 的方程中：\n$$\nU_t = C_t - (1.0 + C_t(I_t - D_t)) = C_t - 1.0 - C_t I_t + C_t D_t\n$$\n提取公因式 $C_t$ 得到最终的紧凑形式：\n$$\nU_t = C_t(1.0 - I_t + D_t) - 1.0\n$$\n\n**3. 丘脑输出 ($T_t$)**\n\n丘脑输出 $T_t$ 作为运动输出的代理，是其预激活的一个非线性、饱和函数。我们使用标准的逻辑函数 $S(x) = \\frac{1}{1 + \\exp(-x)}$，其中增益参数 $g$ 控制响应的陡峭程度。\n$$\nT_t = S(g \\cdot U_t)\n$$\n使用给定的丘脑逻辑增益 $g = 4.0$：\n$$\nT_t = \\frac{1}{1 + \\exp(-4.0 \\cdot U_t)}\n$$\n\n**4. 临床阶段开始**\n\n模型的输出 $T_t$ 与两个阈值进行比较，以确定临床阶段的开始。\n- **运动功能亢进开始 ($t_H$)**：运动输出超过高阈值 $H = 0.8$ 的第一个时间索引 $t$。形式上，$t_H = \\min(\\{t \\mid T_t \\ge 0.8\\} \\cup \\{-1\\})$，如果集合为空，则使用 $-1$。\n- **运动功能减退开始 ($t_A$)**：运动输出低于低阈值 $A = 0.2$ 的第一个时间索引 $t$。形式上，$t_A = \\min(\\{t \\mid T_t \\le 0.2\\} \\cup \\{-1\\})$。\n\n### 算法实现\n\n实现过程首先定义模型参数和逻辑函数。然后，对四个测试用例中的每一个，我们执行以下步骤：\n1.  在指定的时间范围 $T$ 内（从 $t=0$ 到 $t=T-1$），为 $I_t$、$D_t$ 和 $C_t$ 生成输入时间序列。这涉及创建常数数组或使用线性插值（例如，通过 `numpy.linspace`）来生成指定的简单或分段线性函数。\n2.  将推导出的方程向量化地应用于时间序列数组，以计算 GPi 输出（$G_t$）、丘脑预激活（$U_t$）以及最终的运动输出（$T_t$）序列。\n3.  在得到的 $T_t$ 序列中搜索满足运动功能亢进（$T_t \\ge 0.8$）和运动功能减退（$T_t \\le 0.2$）条件的第一个索引。`numpy.where` 函数适用于查找满足条件的所有索引；结果索引数组的第一个元素是所需的开始时间。如果条件从未满足，索引数组将为空，我们报告 $-1$。\n4.  为每个测试用例存储结果对 $[t_H, t_A]$。\n5.  处理完所有测试用例后，将收集到的结果格式化为表示 Python 列表的列表的单个字符串，例如 `[[t_H1, t_A1],[t_H2, t_A2],...]`，并将其打印到标准输出。这需要仔细的字符串格式化以精确匹配所需的输出，不带多余的空格。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Derives and implements a discrete-time model for Huntington's disease\n    pathophysiology, evaluating it on four test cases to find the onset times\n    of hyperkinesia and akinesia.\n    \"\"\"\n\n    # Define model parameters\n    G_0 = 1.0\n    k_I = 1.0\n    k_D = 1.0\n    u_0 = 0.0\n    k_C = 1.0\n    k_G = 1.0\n    g = 4.0\n    \n    # Define clinical thresholds\n    H = 0.8\n    A = 0.2\n\n    def S(x):\n        \"\"\"Logistic transfer function.\"\"\"\n        return 1.0 / (1.0 + np.exp(-g * x))\n\n    def run_simulation(C_t, D_t, I_t):\n        \"\"\"\n        Computes GPi, thalamic pre-activation, and thalamic output series.\n        \n        Args:\n            C_t (np.ndarray): Cortical drive time series.\n            D_t (np.ndarray): Direct-pathway integrity time series.\n            I_t (np.ndarray): Indirect-pathway integrity time series.\n\n        Returns:\n            np.ndarray: Thalamic output (motor proxy) time series.\n        \"\"\"\n        G_t = G_0 + k_I * I_t * C_t - k_D * D_t * C_t\n        U_t = u_0 + k_C * C_t - k_G * G_t\n        T_t = S(U_t)\n        return T_t\n\n    def find_onsets(T_series):\n        \"\"\"\n        Finds the first time indices for hyperkinesia and akinesia.\n\n        Args:\n            T_series (np.ndarray): Thalamic output time series.\n\n        Returns:\n            list[int, int]: A pair of indices [t_H, t_A].\n        \"\"\"\n        tH_indices = np.where(T_series >= H)[0]\n        tH = tH_indices[0] if len(tH_indices) > 0 else -1\n        \n        tA_indices = np.where(T_series <= A)[0]\n        tA = tA_indices[0] if len(tA_indices) > 0 else -1\n        \n        return [tH, tA]\n\n    all_results = []\n\n    # Test Case 1: Happy path (hyperkinesia then akinesia)\n    T = 11\n    I_t1 = np.linspace(1.0, 0.2, T)\n    D_t1 = np.ones(T)\n    D_t1[5:] = np.linspace(1.0, 0.1, T - 5)\n    C_t1 = np.ones(T)\n    C_t1[5:] = np.linspace(1.0, 0.5, T - 5)\n    T_series_1 = run_simulation(C_t1, D_t1, I_t1)\n    all_results.append(find_onsets(T_series_1))\n\n    # Test Case 2: Indirect-pathway loss only (hyperkinesia only)\n    T = 11\n    I_t2 = np.linspace(1.0, 0.2, T)\n    D_t2 = np.ones(T)\n    C_t2 = np.ones(T)\n    T_series_2 = run_simulation(C_t2, D_t2, I_t2)\n    all_results.append(find_onsets(T_series_2))\n\n    # Test Case 3: Late akinesia without preceding hyperkinesia\n    T = 11\n    I_t3 = np.full(T, 0.9)\n    D_t3 = np.linspace(1.0, 0.1, T)\n    C_t3 = np.linspace(1.0, 0.5, T)\n    T_series_3 = run_simulation(C_t3, D_t3, I_t3)\n    all_results.append(find_onsets(T_series_3))\n\n    # Test Case 4: Boundary conditions (exact threshold equality)\n    T = 2\n    U_star = math.log(4) / g\n    U_star_neg = -math.log(4) / g\n    \n    C_t4 = np.ones(T)\n    D_t4 = np.zeros(T)\n    I_t4 = np.zeros(T)\n    \n    # Time t=0 setup\n    D_t4[0] = 1.0\n    I_t4[0] = 1.0 - U_star\n    \n    # Time t=1 setup\n    I_t4[1] = I_t4[0]\n    D_t4[1] = I_t4[0] + U_star_neg\n    \n    T_series_4 = run_simulation(C_t4, D_t4, I_t4)\n    all_results.append(find_onsets(T_series_4))\n    \n    # Format the final output string precisely as specified\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "5025611"}]}