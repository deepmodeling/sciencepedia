{"hands_on_practices": [{"introduction": "神经纤维髓鞘的健康对于快速信号传导至关重要。神经科学家使用“$g$比率”这一指标来量化髓鞘的厚度，它定义为轴突直径与纤维总直径之比。这项练习将让你探索髓鞘的变化（例如在多发性硬化症的脱髓鞘攻击后不完全的修复）如何直接影响轴突的传导速度，通过计算来量化这种功能性后果 [@problem_id:5034824]。", "problem": "一个受多发性硬化症（MS）影响的中枢神经系统轴突会经历髓鞘再生，导致其髓鞘比病变前状态更薄。这种厚度变化体现在 $g$ 比率上，其定义为 $g = \\frac{d}{D_{\\text{fiber}}}$，其中 $d$ 是轴突直径，$D_{\\text{fiber}}$ 是总纤维直径（轴突加髓鞘）。对于有髓鞘的轴突，由于节间膜电容减小和膜电阻增大的共同作用，传导速度 $v$ 与总纤维直径呈线性关系；即 $v$ 与 $D_{\\text{fiber}}$ 成正比。假设在两种状态下，节间长度、郎飞氏节特性和轴突直径 $d$ 保持不变。\n\n如果 $g$ 比率从 $0.6$（髓鞘再生前）变为 $0.8$（髓鞘再生后），计算髓鞘再生后的传导速度与髓鞘再生前的传导速度之比，即 $\\frac{v_{\\text{after}}}{v_{\\text{before}}}$。请用一个小数表示你的答案。无需四舍五入。", "solution": "用户希望我首先验证问题的有效性，如果有效，则提供分步解答。\n\n### 第 1 步：提取已知条件\n- $g$ 比率的定义：$g = \\frac{d}{D_{\\text{fiber}}}$，其中 $d$ 是轴突直径，$D_{\\text{fiber}}$ 是总纤维直径。\n- 传导速度 $v$ 与总纤维直径之间的关系：$v$ 与 $D_{\\text{fiber}}$ 成正比，可写作 $v \\propto D_{\\text{fiber}}$。\n- 节间长度、郎飞氏节特性和轴突直径 $d$ 保持不变。\n- 初始 $g$ 比率（髓鞘再生前）：$g_{\\text{before}} = 0.6$。问题中表述为“髓鞘再生前”，但较低的 g 比率对应于更健康、更厚的髓鞘。准确地说，这是指病变前的状态。\n- 最终 $g$ 比率（髓鞘再生后）：$g_{\\text{after}} = 0.8$。\n- 目标是计算比率 $\\frac{v_{\\text{after}}}{v_{\\text{before}}}$。\n\n### 第 2 步：使用已知条件进行验证\n- **科学依据**：该问题基于神经生物学的基本原理。$g$ 比率是神经解剖学中用于量化髓鞘化程度的标准度量。纤维直径、髓鞘化和传导速度之间的关系是理解神经功能的基石。已知在许多脊椎动物的神经系统中，大约 $0.6$ 的 $g$ 比率对于最大化传导速度是最佳的。增加到 $0.8$ 则表示病态的薄髓鞘，这在多发性硬化症等脱髓鞘事件后的不完全髓鞘再生中可以观察到。这种变化影响传导速度的前提在科学上是正确的。简化为线性关系 ($v \\propto D_{\\text{fiber}}$) 在跳跃式传导的入门模型中是一种常见且可接受的近似。\n- **问题适定**：该问题是适定的。它提供了所有必要的信息：$g$ 比率的定义方程、速度与纤维直径之间的关系、初始和最终状态，以及轴突直径 $d$ 保持不变的关键约束。这使得计算一个唯一的、有意义的数值比率成为可能。\n- **客观性**：该问题以精确、客观和定量的术语陈述，没有主观或偏颇的语言。\n\n### 第 3 步：结论与行动\n该问题具有科学依据、适定且客观，因此是有效的。我现在将着手解决问题。\n\n### 解题过程\n问题要求我们确定髓鞘再生后的传导速度与脱髓鞘事件前的传导速度之比，记为 $\\frac{v_{\\text{after}}}{v_{\\text{before}}}$。\n\n给定传导速度 $v$ 的关系如下：\n$$v \\propto D_{\\text{fiber}}$$\n这可以用一个比例常数 $k$ 来表示：\n$$v = k D_{\\text{fiber}}$$\n常数 $k$ 取决于假定固定的轴突生物物理特性（例如，轴浆和离子通道的特性）。\n\n$g$ 比率定义为：\n$$g = \\frac{d}{D_{\\text{fiber}}}$$\n其中 $d$ 是轴突直径，$D_{\\text{fiber}}$ 是总纤维直径。\n\n我们已知轴突直径 $d$ 保持不变。我们可以重新整理 $g$ 比率的定义，用 $d$ 和 $g$ 来表示 $D_{\\text{fiber}}$：\n$$D_{\\text{fiber}} = \\frac{d}{g}$$\n现在，我们可以将这个 $D_{\\text{fiber}}$ 的表达式代入传导速度 $v$ 的方程中：\n$$v = k \\left(\\frac{d}{g}\\right)$$\n由于 $k$ 和 $d$ 都是常数，我们可以看到传导速度 $v$ 与 $g$ 比率成反比：\n$$v \\propto \\frac{1}{g}$$\n\n我们想要求解比率 $\\frac{v_{\\text{after}}}{v_{\\text{before}}}$。使用上面推导出的关系，我们可以写出“之前”和“之后”状态的速度：\n$$v_{\\text{before}} = \\frac{kd}{g_{\\text{before}}}$$\n$$v_{\\text{after}} = \\frac{kd}{g_{\\text{after}}}$$\n\n现在，我们计算这两个速度的比值：\n$$\\frac{v_{\\text{after}}}{v_{\\text{before}}} = \\frac{\\left(\\frac{kd}{g_{\\text{after}}}\\right)}{\\left(\\frac{kd}{g_{\\text{before}}}\\right)}$$\n项 $kd$ 在分子和分母中被消去：\n$$\\frac{v_{\\text{after}}}{v_{\\text{before}}} = \\frac{\\frac{1}{g_{\\text{after}}}}{\\frac{1}{g_{\\text{before}}}} = \\frac{g_{\\text{before}}}{g_{\\text{after}}}$$\n\n我们已知 $g$ 比率的值：\n$g_{\\text{before}} = 0.6$\n$g_{\\text{after}} = 0.8$\n\n将这些值代入速度比的表达式中：\n$$\\frac{v_{\\text{after}}}{v_{\\text{before}}} = \\frac{0.6}{0.8}$$\n化简该分数得到：\n$$\\frac{0.6}{0.8} = \\frac{6}{8} = \\frac{3}{4} = 0.75$$\n\n髓鞘再生后的传导速度与病变前的传导速度之比为 $0.75$。这个结果与较高的 $g$ 比率（更薄的髓鞘）导致较慢的传导速度这一认识是一致的。", "answer": "$$\\boxed{0.75}$$", "id": "5034824"}, {"introduction": "临床医生如何“看到”由脱髓鞘引起的神经信号传导减慢？视觉诱发电位（VEP）测试是一种关键的诊断工具，它测量视觉信号从眼睛传播到大脑视觉皮层所需的时间。在这个练习中，你将通过计算特定脱髓鞘程度下VEP潜伏期的延迟，将脱髓鞘的生物物理学原理与真实的临床测量联系起来 [@problem_id:5034777]。", "problem": "一位临床医生正在分析一位疑似脱髓鞘病变患者的视觉诱发电位（VEP），以评估视神经节段的传导功能。在一个简化的生物物理模型中，假设遵循以下基本原理：\n\n- 通过一个节段的传导时间等于距离除以传导速度。\n- 脱髓鞘会降低传导速度，但不会改变路径长度。\n- 在此模型中，非传导延迟（例如，突触整合和光转导）被视为常数，不受脱髓鞘的影响。\n\n所关注的视神经节段长度为 $L = 100$ 毫米。在健康的基线状态下，可归因于该节段传导的VEP潜伏期测量值为 $T_{\\text{normal}} = 100$ 毫秒。在脱髓鞘状态下，沿该节段的传导速度相对于基线降低了 $0.30$，所有其他延迟保持不变。\n\n从上述原理出发，推导仅因此节段传导速度降低而引起的潜伏期变化表达式，并计算其值。相对于正常的 $100$ 毫秒基线，潜伏期增加了多少？请用毫秒表示答案，并四舍五入到四位有效数字。", "solution": "在尝试求解之前，将首先验证问题陈述的科学合理性、自洽性和清晰度。\n\n### 步骤 1：提取已知信息\n问题陈述中逐字提供了以下信息：\n- **基本原理 1**：通过一个节段的传导时间等于距离除以传导速度。\n- **基本原理 2**：脱髓鞘会降低传导速度，但不会改变路径长度。\n- **基本原理 3**：非传导延迟被视为常数，不受脱髓鞘的影响。\n- **节段长度**：$L = 100$ 毫米。\n- **正常传导时间**：$T_{\\text{normal}} = 100$ 毫秒。这是健康状态下可归因于通过指定节段传导的VEP潜伏期分量。\n- **速度降低**：在脱髓鞘状态下，传导速度相对于基线降低了 $0.30$。\n- **目标**：推导因传导速度降低而引起的潜伏期变化表达式，并计算其相对于正常基线的增加值。最终答案必须以毫秒为单位，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知信息进行验证\n根据既定的验证标准对问题进行评估。\n- **科学依据**：该问题基于神经生理学和生物物理学的基本原理。时间、距离和速度之间的关系 ($t = d/v$) 是一条基本的物理定律。核心概念——脱髓鞘降低神经冲动的传导速度——是多发性硬化症等脱髓鞘疾病的病理生理学基石。使用视觉诱发电位（VEP）测量视神经传导潜伏期是一种标准的临床诊断技术。该问题提出了一个简化但有效的一阶模型。\n- **适定性**：该问题是适定的。它提供了确定唯一解所需的所有必要信息。初始状态（正常）和扰动（脱髓鞘引起的速度变化）都得到了明确定义，从而可以计算由此产生的潜伏期变化。\n- **客观性**：问题以客观、精确和正式的语言陈述，没有主观或含糊不清的术语。\n- **一致性与完整性**：所提供的数据内部一致且充分。问题陈述阐明了 $T_{\\text{normal}} = 100$ 毫秒的潜伏期是*由传导引起*的分量，而其他延迟（突触延迟等）是恒定的。这使得潜伏期的变化可以完全归因于传导时间的变化，正如题目所要求。术语“相对于基线降低了 $0.30$”是一个无歧义的分数减少陈述，意味着新值是原始值的 $(1 - 0.30)$ 倍。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**，因为它具有科学依据、适定且自洽。现在可以推导求解。\n\n### 解题推导\n设 $L$ 为视神经节段的长度。\n设 $v_{\\text{normal}}$ 为健康（正常）状态下的传导速度。\n设 $T_{\\text{normal}}$ 为正常状态下通过该节段的传导时间。\n设 $v_{\\text{demyelinated}}$ 为脱髓鞘状态下的传导速度。\n设 $T_{\\text{demyelinated}}$ 为脱髓鞘状态下通过该节段的传导时间。\n\n根据基本原理，传导时间、长度和速度之间的关系是：\n$$T = \\frac{L}{v}$$\n\n对于正常状态，我们有：\n$$T_{\\text{normal}} = \\frac{L}{v_{\\text{normal}}}$$\n\n已知 $L = 100$ 毫米 和 $T_{\\text{normal}} = 100$ 毫秒。\n\n对于脱髓鞘状态，传导速度“相对于基线降低了 $0.30$”。这意味着减少量是 $0.30 \\times v_{\\text{normal}}$。因此，新的速度是：\n$$v_{\\text{demyelinated}} = v_{\\text{normal}} - 0.30 \\times v_{\\text{normal}} = (1 - 0.30) \\times v_{\\text{normal}} = 0.70 \\times v_{\\text{normal}}$$\n\n脱髓鞘状态下的传导时间是：\n$$T_{\\text{demyelinated}} = \\frac{L}{v_{\\text{demyelinated}}}$$\n\n代入 $v_{\\text{demyelinated}}$ 的表达式：\n$$T_{\\text{demyelinated}} = \\frac{L}{0.70 \\times v_{\\text{normal}}}$$\n\n我们可以通过提出正常传导时间的项来重写这个表达式：\n$$T_{\\text{demyelinated}} = \\frac{1}{0.70} \\left( \\frac{L}{v_{\\text{normal}}} \\right) = \\frac{1}{0.70} T_{\\text{normal}}$$\n\n问题要求的是潜伏期的*增加量*，即变化量 $\\Delta T$。\n$$\\Delta T = T_{\\text{demyelinated}} - T_{\\text{normal}}$$\n\n代入推导出的 $T_{\\text{demyelinated}}$ 表达式：\n$$\\Delta T = \\left( \\frac{1}{0.70} T_{\\text{normal}} \\right) - T_{\\text{normal}}$$\n\n提出 $T_{\\text{normal}}$ 得到潜伏期变化的一般表达式：\n$$\\Delta T = T_{\\text{normal}} \\left( \\frac{1}{0.70} - 1 \\right)$$\n\n这个表达式代表了从问题原理推导出的潜伏期变化。现在，我们使用给定的数据计算其数值。\n已知 $T_{\\text{normal}} = 100$ 毫秒：\n$$\\Delta T = 100 \\text{ ms} \\times \\left( \\frac{1}{0.70} - \\frac{0.70}{0.70} \\right)$$\n$$\\Delta T = 100 \\text{ ms} \\times \\left( \\frac{1 - 0.70}{0.70} \\right)$$\n$$\\Delta T = 100 \\text{ ms} \\times \\left( \\frac{0.30}{0.70} \\right)$$\n$$\\Delta T = 100 \\times \\frac{3}{7} \\text{ ms}$$\n$$\\Delta T = \\frac{300}{7} \\text{ ms}$$\n\n为了给出最终答案，我们计算其数值并四舍五入到四位有效数字：\n$$\\Delta T \\approx 42.85714... \\text{ ms}$$\n四舍五入到四位有效数字得到 $42.86$ 毫秒。\n这就是相对于正常基线的潜伏期增加量。", "answer": "$$\\boxed{42.86}$$", "id": "5034777"}, {"introduction": "预测像多发性硬化症这样复杂疾病的病程是临床神经病学中的一个重大挑战。通过使用数学模型，我们可以模拟疾病进展，并理解复发和疾病修正疗法等不同因素的长期影响。这项高级练习将引导你建立一个简单的计算模型，来估算患者残疾随时间推移的预期轨迹，让你一窥临床研究中使用的定量方法 [@problem_id:5034848]。", "problem": "我们使用一个简化的确定性期望值模型来估计在固定时间范围内，多发性硬化症患者的扩展残疾状态量表 (EDSS) 如何演变。该疾病被表示为一个双态离散时间马尔可夫链，包含复发缓解型多发性硬化症 (RRMS) 和继发进展型多发性硬化症 (SPMS) 两个状态。继发进展型多发性硬化症 (SPMS) 是一个吸收态，意味着一旦转换到此状态，便无法返回 RRMS 状态。该模型必须遵循以下基本依据和定义：\n\n- 扩展残疾状态量表 (EDSS) 是一个从 $0$ 到 $10$ 的无单位、单调非递减量表，用于追踪残疾程度。\n- RRMS 中的年化复发率 (ARR) 被建模为一个速率参数为每年 $\\lambda$ 的泊松过程。对于泊松过程，在 $1$ 年内事件的期望数量为 $\\mathbb{E}[N(1)] = \\lambda$。\n- 每次复发都会导致 EDSS 永久性增加 $\\alpha$ (无单位)。\n- 除了复发之外，在 RRMS 状态下，每年的基线 EDSS 漂移为 $\\mu_{\\mathrm{RR}}$；在 SPMS 状态下，为 $\\mu_{\\mathrm{SP}}$。\n- 该马尔可夫链具有从 RRMS 到 SPMS 的年度转换概率 $q$，且 SPMS 为吸收态。如果 $p_t$ 是在第 $t$ 年初处于 SPMS 状态的概率，则 $p_t$ 的演变遵循马尔可夫链的第一性原理。\n- 应通过结合上述原理计算期望 EDSS，无需任何随机模拟。将给定年份的期望 EDSS 增量视为依赖于状态的基线漂移和期望复发贡献的混合，并根据该年处于各状态的概率进行加权。使用该年年初处于 SPMS 的概率进行加权。\n- 每次年度更新后，EDSS 的上限为 $10$。\n- 初始条件：在第 $0$ 年初，患者处于 RRMS 状态的概率为 $1$ (即 $p_0 = 0$)，且 EDSS 为 $E_0$。\n\n您的任务：\n\n- 在给定参数 $E_0$、$\\lambda$、$q$、$\\mu_{\\mathrm{RR}}$、$\\mu_{\\mathrm{SP}}$ 和 $\\alpha$ 以及 EDSS 上限为 $10$ 的情况下，从第一性原理推导出计算 $T$ 年内每年年末期望 EDSS 的递推关系。\n- 实现一个程序，为每个测试用例计算 $T = 5$ 年的期望 EDSS 轨迹，返回第 $1$ 年末、第 $2$ 年末... 直至第 $5$ 年末的 EDSS 值。\n- 不要使用任何随机数生成；以确定性的方式计算期望值。\n- 将每个 EDSS 值四舍五入到三位小数后输出。\n\n待实现和评估的测试套件：\n\n- 用例 $1$ (正常路径)：$T=5$, $E_0=1.5$, $\\lambda=0.5$, $q=0.1$, $\\mu_{\\mathrm{RR}}=0.1$, $\\mu_{\\mathrm{SP}}=0.3$, $\\alpha=0.5$。\n- 用例 $2$ (无复发)：$T=5$, $E_0=1.5$, $\\lambda=0.0$, $q=0.1$, $\\mu_{\\mathrm{RR}}=0.1$, $\\mu_{\\mathrm{SP}}=0.3$, $\\alpha=0.5$。\n- 用例 $3$ (立即进展)：$T=5$, $E_0=1.5$, $\\lambda=0.5$, $q=1.0$, $\\mu_{\\mathrm{RR}}=0.1$, $\\mu_{\\mathrm{SP}}=0.3$, $\\alpha=0.5$。\n- 用例 $4$ (不进展到 SPMS)：$T=5$, $E_0=1.5$, $\\lambda=0.5$, $q=0.0$, $\\mu_{\\mathrm{RR}}=0.1$, $\\mu_{\\mathrm{SP}}=0.3$, $\\alpha=0.5$。\n- 用例 $5$ (EDSS 上限压力测试)：$T=5$, $E_0=9.8$, $\\lambda=0.5$, $q=0.5$, $\\mu_{\\mathrm{RR}}=0.4$, $\\mu_{\\mathrm{SP}}=0.6$, $\\alpha=0.8$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个含 $25$ 个浮点数的列表。该列表通过按上述给定的测试用例顺序连接五个测试用例的 $5$ 年轨迹而得。在每个轨迹中，列出从第 $1$ 年末到第 $5$ 年末的 EDSS。每个值必须四舍五入到三位小数。输出必须是单个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,\\dots,x_{25}]$）。", "solution": "我们根据基本定义构建期望值模型。设 $E_t$ 表示第 $t$ 年初的期望扩展残疾状态量表 (EDSS)，其中 $E_0$ 为给定值。设 $p_t$ 为患者在第 $t$ 年初处于继发进展型多发性硬化症 (SPMS) 状态的概率。初始时，$p_0 = 0$，因为假定患者从复发缓解型多发性硬化症 (RRMS) 开始。该马尔可夫链是双态的，其中 SPMS 为吸收态，从 RRMS 到 SPMS 的年度转换概率为 $q$。根据马尔可夫链的全概率定律，$p_t$ 在一年内的演变过程为\n$$\np_{t+1} = p_t + (1 - p_t)\\, q,\n$$\n因为有 $p_t$ 的概率已经处于 SPMS 状态并保持在该状态，有 $(1 - p_t)$ 的概率处于 RRMS 状态并以概率 $q$ 转换到 SPMS。\n\n现在考虑单一年份内期望 EDSS 的增量。在 RRMS 状态下，与转换无关，根据速率为 $\\lambda$ 的泊松过程，一年内期望的复发次数为 $\\mathbb{E}[N(1)] = \\lambda$。每次复发贡献一个永久性的 EDSS 增量 $\\alpha$，因此在 RRMS 状态下，一年内与复发相关的期望 EDSS 增量为 $\\alpha \\lambda$。此外，在 RRMS 状态下有基线年度 EDSS 漂移 $\\mu_{\\mathrm{RR}}$，在 SPMS 状态下有 $\\mu_{\\mathrm{SP}}$，这代表了期望的非复发性进展。因此，在第 $t \\to t+1$ 年的期望 EDSS 增量是这些依赖于状态的增量的混合，并按第 $t$ 年初处于各状态的概率进行加权。使用年初的混合作为该年度的期望占用近似，可得\n$$\n\\Delta E_t = (1 - p_t)\\, (\\mu_{\\mathrm{RR}} + \\alpha \\lambda) + p_t \\, \\mu_{\\mathrm{SP}}.\n$$\n然后，每年更新后的 EDSS 上限为 $10$：\n$$\nE_{t+1} = \\min\\left(10,\\; E_t + \\Delta E_t\\right).\n$$\n\n计算 $T$ 年期望轨迹的算法如下：\n\n1. 初始化 $E \\leftarrow E_0$，$p \\leftarrow 0$，以及一个空列表用于存储年末 EDSS 值。\n2. 对每一年 $t = 0, 1, \\dots, T-1$：\n   - 计算期望增量\n   $$\n   \\Delta E = (1 - p)\\, (\\mu_{\\mathrm{RR}} + \\alpha \\lambda) + p \\, \\mu_{\\mathrm{SP}}.\n   $$\n   - 更新 EDSS 并应用上限\n   $$\n   E \\leftarrow \\min(10,\\; E + \\Delta E).\n   $$\n   - 将四舍五入后的 $E$ 追加到轨迹中。\n   - 通过马尔可夫更新来更新 SPMS 概率\n   $$\n   p \\leftarrow p + (1 - p)\\, q.\n   $$\n3. 返回包含 $T$ 个四舍五入后的年末 EDSS 值的列表。\n\n该方法基于：\n- 泊松过程在一年窗口内的期望计数属性 $\\mathbb{E}[N(1)] = \\lambda$。\n- 使用马尔可夫链占用概率计算状态条件增量的混合期望。\n- 双态马尔可夫链中 SPMS 的吸收性质。\n\n将此方法应用于 $T=5$ 的测试套件可提供确定性轨迹。例如，在用例 $1$ 中，$E_0=1.5$，$\\lambda=0.5$，$q=0.1$，$\\mu_{\\mathrm{RR}}=0.1$，$\\mu_{\\mathrm{SP}}=0.3$，$\\alpha=0.5$，我们有 $(\\mu_{\\mathrm{RR}} + \\alpha \\lambda) = 0.1 + 0.5 \\cdot 0.5 = 0.35$。从 $p_0=0$ 开始，第一年的期望 EDSS 增量为 $0.35$，因此 $E_1=1.85$。然后 $p_1 = 0.1$。第二年混合了 RRMS 和 SPMS 的期望：$\\Delta E_1 = 0.9 \\cdot 0.35 + 0.1 \\cdot 0.3 = 0.345$，得出 $E_2=2.195$，依此类推，其中 $p_t$ 通过 $p_{t+1} = p_t + (1 - p_t) q$ 进行演变。如有必要，每年的 EDSS 上限为 $10$。将每个年末值四舍五入到三位小数即可得出轨迹。相同的过程适用于所有用例，包括 $q=1.0$（第一年后立即进入 SPMS）、$q=0.0$（不进展到 SPMS）、$\\lambda=0.0$（无复发）以及高初始 $E_0$ 以测试 $10$ 这个上限的边界情况。\n\n最终的程序实现了这些递推关系，计算所有五个轨迹，按指定顺序将它们平铺成一个列表，四舍五入到三位小数，并打印单行格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef expected_edss_trajectory(T, E0, lam, q, mu_rr, mu_sp, alpha, edss_cap=10.0):\n    \"\"\"\n    Compute the expected EDSS trajectory over T years using a two-state Markov chain\n    (RRMS - SPMS absorbing) and Poisson expected relapse counts.\n\n    Parameters:\n        T (int): number of years\n        E0 (float): initial EDSS at start of year 0\n        lam (float): annualized relapse rate in RRMS (Poisson rate)\n        q (float): per-year transition probability from RRMS to SPMS\n        mu_rr (float): baseline annual EDSS drift in RRMS\n        mu_sp (float): baseline annual EDSS drift in SPMS\n        alpha (float): EDSS increment per relapse\n        edss_cap (float): maximum EDSS cap (default 10.0)\n\n    Returns:\n        list of float: expected EDSS at the end of each year 1..T\n    \"\"\"\n    E = float(E0)\n    p_sp = 0.0  # probability of being in SPMS at the start of the current year\n    trajectory = []\n    for _ in range(T):\n        # Expected EDSS increment for this year: mixture of state-conditional increments\n        increment_rr = mu_rr + alpha * lam\n        expected_increment = (1.0 - p_sp) * increment_rr + p_sp * mu_sp\n\n        # Update EDSS with cap\n        E = E + expected_increment\n        if E > edss_cap:\n            E = edss_cap\n\n        trajectory.append(E)\n\n        # Update SPMS probability via Markov chain\n        p_sp = p_sp + (1.0 - p_sp) * q\n\n    return trajectory\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (T, E0, lam, q, mu_rr, mu_sp, alpha)\n    test_cases = [\n        (5, 1.5, 0.5, 0.1, 0.1, 0.3, 0.5),  # Case 1: happy path\n        (5, 1.5, 0.0, 0.1, 0.1, 0.3, 0.5),  # Case 2: no relapses\n        (5, 1.5, 0.5, 1.0, 0.1, 0.3, 0.5),  # Case 3: immediate SPMS\n        (5, 1.5, 0.5, 0.0, 0.1, 0.3, 0.5),  # Case 4: no progression to SPMS\n        (5, 9.8, 0.5, 0.5, 0.4, 0.6, 0.8),  # Case 5: EDSS cap stress test\n    ]\n\n    results = []\n    for case in test_cases:\n        T, E0, lam, q, mu_rr, mu_sp, alpha = case\n        traj = expected_edss_trajectory(T, E0, lam, q, mu_rr, mu_sp, alpha, edss_cap=10.0)\n        # Round to three decimals and flatten into results\n        for value in traj:\n            results.append(f\"{value:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "5034848"}]}