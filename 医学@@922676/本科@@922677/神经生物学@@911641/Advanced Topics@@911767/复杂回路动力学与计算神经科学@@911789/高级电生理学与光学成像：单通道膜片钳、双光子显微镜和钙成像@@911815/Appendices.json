{"hands_on_practices": [{"introduction": "单通道记录技术的基础在于能够分辨出流经单个离子通道蛋白的微弱电流。本练习将引导你使用电路分析的基石——欧姆定律，来完成这种“单位电流”的基本计算。更重要的是，它揭示了一个看似微小的实验疏忽——液体接界电位（LJP），会如何系统性地影响你的测量结果，从而强调了在定量电生理学中进行精确校准和误差分析的至关重要性。[@problem_id:4995877]", "problem": "对一个表达某种通道的神经元进行单通道膜片钳记录，该通道在感兴趣的电压范围内是欧姆性的，意味着单通道电流与电化学驱动力成正比。该通道的开放电导为 $20$ 皮西门子 (pS)。实验者设定的指令膜电位为 $V_{\\text{command}}=-60$ 毫伏 (mV)，通道的反转电位为 $E_{\\text{rev}}=-80$ mV。假设外向正电流遵循传统的电生理学符号约定。由于电极-浴槽离子成分差异，存在一个 $+2$ mV 的未补偿正液接电位 (LJP)，使得真实膜电位根据 $V_{\\text{true}}=V_{\\text{command}}-2$ mV 发生偏移。\n\n使用关联单个开放通道的电流、电导和电化学驱动力的第一性原理，计算：\n- 在预期指令电位下的期望单位电流（忽略LJP），以及\n- $+2$ mV 的LJP如何使估计产生偏差（即，实际单位电流与 $V_{\\text{command}}$ 下的期望值有何不同）。\n\n最后，报告在未补偿LJP下测得的有偏差的单位电流幅值。将最终答案以皮安 (pA) 表示，并四舍五入至三位有效数字。", "solution": "该问题被评估为具有科学依据、问题明确且客观。计算所需的所有参数都已提供，并且它们处于标准单通道膜片钳实验的实际范围内。其基本原理是欧姆定律在离子通道电流上的直接应用，这是电生理学中的一个基本概念。该问题是有效的，可以确定一个解。\n\n流经单个开放离子通道的单位电流 ($i$)、其电导 ($\\gamma$)、膜电位 ($V_m$) 和通道的反转电位 ($E_{\\text{rev}}$) 之间的关系由该通道的欧姆定律描述。由于该通道被说明是欧姆性的，这种关系是线性的：\n$$i = \\gamma (V_m - E_{\\text{rev}})$$\n项 $(V_m - E_{\\text{rev}})$ 代表电化学驱动力。符号约定规定，正电荷的外向流动为正电流。\n\n给定的参数是：\n- 单通道电导，$\\gamma = 20 \\text{ pS} = 20 \\times 10^{-12} \\text{ S}$\n- 指令膜电位， $V_{\\text{command}} = -60 \\text{ mV} = -60 \\times 10^{-3} \\text{ V}$\n- 反转电位， $E_{\\text{rev}} = -80 \\text{ mV} = -80 \\times 10^{-3} \\text{ V}$\n- 液接电位， $LJP = +2 \\text{ mV} = +2 \\times 10^{-3} \\text{ V}$\n\n首先，我们计算期望单位电流 $i_{\\text{expected}}$，这是在真实膜电位与指令电位相同（即忽略LJP）时的理论电流。在这种情况下，$V_m = V_{\\text{command}}$。\n\n驱动力为 $V_{\\text{command}} - E_{\\text{rev}} = (-60 \\text{ mV}) - (-80 \\text{ mV}) = +20 \\text{ mV}$。\n期望电流为：\n$$i_{\\text{expected}} = \\gamma (V_{\\text{command}} - E_{\\text{rev}})$$\n$$i_{\\text{expected}} = (20 \\times 10^{-12} \\text{ S}) \\times (20 \\times 10^{-3} \\text{ V})$$\n$$i_{\\text{expected}} = 400 \\times 10^{-15} \\text{ A} = 0.4 \\times 10^{-12} \\text{ A} = 0.4 \\text{ pA}$$\n正的驱动力导致外向电流，该电流被定义为正。计算出的符号与约定一致。\n\n接下来，我们考虑未补偿的液接电位 (LJP)。LJP 在指令电位和跨膜的真实电位 $V_{\\text{true}}$ 之间引入了一个误差。问题给出了以下关系：\n$$V_{\\text{true}} = V_{\\text{command}} - LJP$$\n代入给定值：\n$$V_{\\text{true}} = -60 \\text{ mV} - (+2 \\text{ mV}) = -62 \\text{ mV}$$\n实验者将测得的实际单位电流 $i_{\\text{actual}}$ 由这个真实膜电位 $V_{\\text{true}}$ 决定。现在的驱动力为 $V_{\\text{true}} - E_{\\text{rev}} = (-62 \\text{ mV}) - (-80 \\text{ mV}) = +18 \\text{ mV}$。\n\n实际电流为：\n$$i_{\\text{actual}} = \\gamma (V_{\\text{true}} - E_{\\text{rev}})$$\n$$i_{\\text{actual}} = (20 \\times 10^{-12} \\text{ S}) \\times (18 \\times 10^{-3} \\text{ V})$$\n$$i_{\\text{actual}} = 360 \\times 10^{-15} \\text{ A} = 0.36 \\times 10^{-12} \\text{ A} = 0.36 \\text{ pA}$$\n\nLJP引入的偏差是实际电流与期望电流之间的差值：\n$$\\text{Bias} = i_{\\text{actual}} - i_{\\text{expected}} = 0.36 \\text{ pA} - 0.4 \\text{ pA} = -0.04 \\text{ pA}$$\n$+2$ mV 的正LJP使得真实膜电位比指令电位更负，将驱动力从 $+20$ mV 减小到 $+18$ mV。这导致测得的外向电流比没有LJP时预期的值小 $0.04$ pA。\n\n问题要求的是将要测得的有偏差的单位电流幅值。这就是 $i_{\\text{actual}}$ 的值。问题要求最终答案四舍五入至三位有效数字。\n$$i_{\\text{actual}} = 0.36 \\text{ pA}$$\n四舍五入到三位有效数字，我们得到 $0.360$ pA。", "answer": "$$\\boxed{0.360}$$", "id": "4995877"}, {"introduction": "当我们将膜片钳与双光子显微镜配对使用时，必须权衡这两种技术的需求。本练习将深入探讨激光扫描显微镜的基本限制，迫使我们直面成像速度（帧率）与信号质量（信噪比，$SNR$）之间固有的权衡关系。通过推导像素驻留时间及其对光子收集的影响，你将掌握设计成像实验的核心技能，从而有效地捕捉感兴趣的动态过程，而不会被噪声所淹没。[@problem_id:4995828]", "problem": "一个双光子显微镜（TPM）系统用于通过光栅扫描对小鼠皮层进行钙成像。视场为 $256\\ \\mu\\mathrm{m} \\times 256\\ \\mu\\mathrm{m}$，使用间距为 $\\Delta_{x} = \\Delta_{y} = 0.50\\ \\mu\\mathrm{m}$ 的方形像素进行采样。帧率为每秒 $f_{\\mathrm{frame}}$ 帧，行和帧回扫的总开销是每帧周期的固定比例 $\\alpha$，因此净扫描占空比为 $D = 1 - \\alpha$。仅使用光栅扫描和时间预算的基本定义，推导出像素驻留时间 $t_{\\mathrm{dwell}}$ 关于 $f_{\\mathrm{frame}}$、$D$、视场尺寸和像素间距的显式表达式。\n\n然后，考虑在散粒噪声限制条件下、信号与背景服从独立泊松统计且电子噪声可忽略的钙成像过程中的光子探测情景。探测器上的入射光子通量为 $F = 3.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$。探测器的量子效率为 $\\eta = 0.25$，因此探测到的信号计数率为 $R_{c} = \\eta F$。背景计数率为 $b = 5.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$。对于目标信噪比（SNR），记为 $K$，其定义为在一个像素驻留时间内累积的平均探测信号计数与噪声计数的均方根之比，请确定达到 $K=8$ 所需的最小像素驻留时间 $t_{\\mathrm{min}}$。\n\n请将 $t_{\\mathrm{min}}$ 的最终数值答案以微秒为单位表示，并四舍五入到四位有效数字。", "solution": "我们从光栅扫描和时间预算的基本定义开始。设视场尺寸为 $L_{x}$ 和 $L_{y}$，像素间距为 $\\Delta_{x}$ 和 $\\Delta_{y}$。每行的像素数为\n$$\nN_{x} = \\frac{L_{x}}{\\Delta_{x}},\n$$\n每帧的行数为\n$$\nN_{y} = \\frac{L_{y}}{\\Delta_{y}}。\n$$\n因此，每帧的总像素数为\n$$\nN_{\\mathrm{pix}} = N_{x} N_{y} = \\frac{L_{x} L_{y}}{\\Delta_{x} \\Delta_{y}}。\n$$\n\n设帧率为 $f_{\\mathrm{frame}}$，则一帧周期的时间为\n$$\nT_{\\mathrm{frame}} = \\frac{1}{f_{\\mathrm{frame}}}。\n$$\n如果每帧周期的一个固定比例 $\\alpha$ 是开销（例如，行和帧的回扫、光束稳定、消隐），那么可用于像素积分的净比例（占空比）是\n$$\nD = 1 - \\alpha。\n$$\n根据定义，所有像素驻留时间的总和必须等于每帧的净积分时间，所以\n$$\nN_{\\mathrm{pix}} \\, t_{\\mathrm{dwell}} = D \\, T_{\\mathrm{frame}} = \\frac{D}{f_{\\mathrm{frame}}}。\n$$\n解出像素驻留时间，可得关系式\n$$\nt_{\\mathrm{dwell}} = \\frac{D}{f_{\\mathrm{frame}} \\, N_{x} \\, N_{y}} = \\frac{D}{f_{\\mathrm{frame}}} \\cdot \\frac{\\Delta_{x} \\Delta_{y}}{L_{x} L_{y}}。\n$$\n该表达式表明，对于固定的视场和像素间距，$t_{\\mathrm{dwell}}$ 与乘积 $f_{\\mathrm{frame}} N_{x} N_{y}$ 成反比，即增加帧率或增加像素数会减少驻留时间。\n\n接下来，我们确定在散粒噪声限制条件下、信号与背景服从独立泊松统计时，达到目标信噪比（SNR）所需的最小驻留时间。设探测到的信号计数率为 $R_{c} = \\eta F$，背景计数率为 $b$。在驻留时间 $t$ 内，平均探测信号计数为\n$$\nS(t) = R_{c} \\, t,\n$$\n平均背景计数为\n$$\nB(t) = b \\, t。\n$$\n对于泊松统计，总计数的方差等于平均总计数，因此均方根噪声为\n$$\n\\sigma(t) = \\sqrt{S(t) + B(t)} = \\sqrt{(R_{c} + b)\\, t}。\n$$\n将目标信噪比 $K$ 定义为\n$$\nK = \\frac{S(t)}{\\sigma(t)} = \\frac{R_{c} \\, t}{\\sqrt{(R_{c} + b)\\, t}} = \\frac{R_{c}}{\\sqrt{R_{c} + b}} \\, \\sqrt{t}。\n$$\n解出 $t$，\n$$\nK = \\frac{R_{c}}{\\sqrt{R_{c} + b}} \\, \\sqrt{t}\n\\quad \\Longrightarrow \\quad\n\\sqrt{t} = K \\, \\frac{\\sqrt{R_{c} + b}}{R_{c}}\n\\quad \\Longrightarrow \\quad\nt = \\left( K \\, \\frac{\\sqrt{R_{c} + b}}{R_{c}} \\right)^{2}。\n$$\n等价地，\n$$\nt = \\frac{K^{2} \\, (R_{c} + b)}{R_{c}^{2}}。\n$$\n\n我们现在代入给定的数值。探测器上的入射光子通量为 $F = 3.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$，探测器量子效率为 $\\eta = 0.25$，因此探测到的信号计数率为\n$$\nR_{c} = \\eta F = 0.25 \\times 3.0 \\times 10^{7} = 7.5 \\times 10^{6}\\ \\mathrm{s}^{-1}。\n$$\n背景计数率为\n$$\nb = 5.0 \\times 10^{5}\\ \\mathrm{s}^{-1}。\n$$\n信噪比目标为\n$$\nK = 8。\n$$\n因此，\n$$\nt_{\\mathrm{min}} = \\frac{K^{2} \\, (R_{c} + b)}{R_{c}^{2}}\n= \\frac{64 \\times \\left(7.5 \\times 10^{6} + 5.0 \\times 10^{5}\\right)}{\\left(7.5 \\times 10^{6}\\right)^{2}}\n= \\frac{64 \\times 8.0 \\times 10^{6}}{56.25 \\times 10^{12}}。\n$$\n计算该分数：\n$$\nt_{\\mathrm{min}} = \\frac{5.12 \\times 10^{8}}{5.625 \\times 10^{13}} = 9.102222\\ldots \\times 10^{-6}\\ \\mathrm{s}。\n$$\n以微秒表示，\n$$\nt_{\\mathrm{min}} \\approx 9.102222\\ldots\\ \\mu\\mathrm{s}。\n$$\n按要求四舍五入到四位有效数字，\n$$\nt_{\\mathrm{min}} = 9.102\\ \\mu\\mathrm{s}。\n$$", "answer": "$$\\boxed{9.102}$$", "id": "4995828"}, {"introduction": "一连串的单通道数据不仅仅是电信号的起伏，它更是一扇观察单个分子构象变化的窗口。这最后一个练习将通过引入最大似然估计（MLE）这一强大的统计工具，来搭建从原始数据到生物物理学洞见的桥梁。你将学习如何从一系列驻留时间中估算通道的开放和关闭速率，并且至关重要地，学习如何校正那些任何真实仪器都不可避免会遗漏的短事件。[@problem_id:4995859]", "problem": "您正在分析来自一个在关闭态和开放态之间转换的两态离子通道的理想化单通道膜片钳数据。假设这是一个具有恒定转换速率 $k_{co}$ (从关闭态到开放态) 和 $k_{oc}$ (从开放态到关闭态) 的连续时间、无记忆性的两态马尔可夫过程。在此模型下，关闭态的驻留时间是速率为 $k_{co}$ 的独立同分布指数随机变量，而开放态的驻留时间是速率为 $k_{oc}$ 的独立同分布指数随机变量。\n\n测量的时间序列是通过一个带宽有限的放大器和一个采样间隔有限的数字化仪获取的。有限的带宽引入了低通滤波器的特征上升时间，记为 $t_r$ (秒)，而数字化则由采样间隔 $\\Delta t$ (秒) 表征。由于滤波和采样的卷积效应，短于有效分辨率的事件会被漏失。对于本问题，将有效死时间 (即最小可分辨事件持续时间) 建模为\n$$\n\\tau_{\\mathrm{res}} = \\sqrt{t_r^2 + (\\Delta t)^2}.\n$$\n假设理想化的驻留时间是由一个完美的理想化算法确定的，该算法只标记持续时间超过 $\\tau_{\\mathrm{res}}$ 的事件。在这些假设下，每个状态的观测驻留时间是在超过 $\\tau_{\\mathrm{res}}$ 的条件下呈指数分布的，也就是说，如果 $T$ 是对应于某个状态、速率为 $\\lambda$ 的指数随机变量，那么在 $T \\ge \\tau_{\\mathrm{res}}$ 的条件下，观测到的 $T_{\\mathrm{obs}}$ 的条件密度为\n$$\nf_{T_{\\mathrm{obs}}}(t \\mid t \\ge \\tau_{\\mathrm{res}}) = \\lambda \\, e^{-\\lambda (t - \\tau_{\\mathrm{res}})}, \\quad \\text{for } t \\ge \\tau_{\\mathrm{res}}.\n$$\n这通过在 $\\tau_{\\mathrm{res}}$ 处进行截断来解释漏失事件的校正，而不拼接漏失的微观事件，这在 $\\tau_{\\mathrm{res}}$ 相对于平均驻留时间很小的情况下是合适的。\n\n从这些假设和最大似然估计 (MLE) 的定义出发，根据分别在关闭态和开放态观测到的驻留时间，以及给定的 $t_r$ 和 $\\Delta t$，为 $k_{co}$ 和 $k_{oc}$ 构建一个估计器。该估计器必须使用上面定义的 $\\tau_{\\mathrm{res}}$ 来明确地校正漏失事件。\n\n您的程序必须实现该估计器，并为以下测试套件计算估计值。所有持续时间均以秒为单位， $t_r$ 和 $\\Delta t$ 也以秒为单位。将最终估计的速率以 $\\mathrm{s}^{-1}$ (每秒) 的形式表示为浮点数。您的输出必须是单行文本，其中包含一个方括号括起来的逗号分隔列表形式的结果。\n\n测试套件：\n- 案例 1 (理想情况，中等分辨率):\n  - $t_r = 0.0005$, $\\Delta t = 0.0002$。使用 $\\tau_{\\mathrm{res}} = \\sqrt{(0.0005)^2 + (0.0002)^2}$。\n  - 关闭态观测驻留时间 $C_1$: $[0.0054385165, 0.0056385165, 0.0058385165, 0.0052385165, 0.0055385165, 0.0057385165, 0.0053385165, 0.0059385165]$。\n  - 开放态观测驻留时间 $O_1$: $[0.0033385165, 0.0036385165, 0.0037385165, 0.0035385165, 0.0034385165, 0.0038385165, 0.0036385165, 0.0032385165]$。\n- 案例 2 (粗分辨率，大 $\\tau_{\\mathrm{res}}$):\n  - $t_r = 0.0020$, $\\Delta t = 0.0010$。使用 $\\tau_{\\mathrm{res}} = \\sqrt{(0.0020)^2 + (0.0010)^2}$。\n  - 关闭态观测驻留时间 $C_2$: $[0.01523606798, 0.01723606798, 0.01623606798, 0.01823606798, 0.01573606798]$。\n  - 开放态观测驻留时间 $O_2$: $[0.00773606798, 0.00833606798, 0.00853606798, 0.00823606798, 0.00793606798]$。\n- 案例 3 (采样受限，$\\Delta t$ 占主导):\n  - $t_r = 0.0001$, $\\Delta t = 0.0020$。使用 $\\tau_{\\mathrm{res}} = \\sqrt{(0.0001)^2 + (0.0020)^2}$。\n  - 关闭态观测驻留时间 $C_3$: $[0.00670249844, 0.00720249844, 0.00710249844, 0.00690249844]$。\n  - 开放态观测驻留时间 $O_3$: $[0.00530249844, 0.00560249844, 0.00540249844, 0.00570249844]$。\n\n您的程序应生成单行输出，其中包含按 $[k_{co,1}, k_{oc,1}, k_{co,2}, k_{oc,2}, k_{co,3}, k_{oc,3}]$ 顺序排列的结果，形式为方括号括起来的逗号分隔列表，其中下标表示案例编号。数值必须以 $\\mathrm{s}^{-1}$ 表示。\n\n注意：虽然电生理学、双光子显微镜和钙成像在神经生物学中是整合的方法论领域，但本问题侧重于从单通道膜片钳的理想化数据中进行速率估计，这为在互补性实验中解释钙动力学和光学信号提供了机制性参数。", "solution": "该问题要求基于被有限仪器分辨率截断的观测驻留时间数据，为两态马尔可夫离子通道的转换速率构建并实现一个最大似然估计 (MLE)。转换速率分别是 $k_{co}$ (从关闭态到开放态的转换) 和 $k_{oc}$ (从开放态到关闭态的转换)。\n\n其基础过程规定，在一个离开速率为 $\\lambda$ 的状态中，驻留时间呈指数分布。然而，由于受到滤波器上升时间 $t_r$ 和采样间隔 $\\Delta t$ 所表征的仪器限制，任何短于有效死时间 $\\tau_{\\mathrm{res}}$ 的事件 (驻留时间) 都会被漏失。死时间被建模为 $\\tau_{\\mathrm{res}} = \\sqrt{t_r^2 + (\\Delta t)^2}$。\n\n问题陈述，对于一个基础速率为 $\\lambda$ 的状态，其观测驻留时间 $T_{\\mathrm{obs}}$ 是以真实驻留时间 $T$ 大于或等于 $\\tau_{\\mathrm{res}}$ 为条件的。这些观测时间的概率密度函数 (PDF) 如下所示：\n$$\nf_{T_{\\mathrm{obs}}}(t \\mid t \\ge \\tau_{\\mathrm{res}}) = \\lambda \\, e^{-\\lambda (t - \\tau_{\\mathrm{res}})}, \\quad \\text{for } t \\ge \\tau_{\\mathrm{res}}\n$$\n这是一个被 $\\tau_{\\mathrm{res}}$ 平移了的指数分布的概率密度函数。我们将此 PDF 表示为 $f(t; \\lambda, \\tau_{\\mathrm{res}})$。\n\n我们的目标是，给定一组 $n$ 个独立同分布 (i.i.d.) 的观测驻留时间 $\\{t_i\\}_{i=1}^n$，求出速率参数 $\\lambda$ 的最大似然估计。似然函数 $L(\\lambda)$ 是观测到每个 $t_i$ 的概率的乘积：\n$$\nL(\\lambda | \\{t_i\\}_{i=1}^n, \\tau_{\\mathrm{res}}) = \\prod_{i=1}^{n} f(t_i; \\lambda, \\tau_{\\mathrm{res}}) = \\prod_{i=1}^{n} \\lambda \\, e^{-\\lambda (t_i - \\tau_{\\mathrm{res}})}\n$$\n为了简化最大化过程，我们使用对数似然函数 $\\ln L(\\lambda)$：\n$$\n\\ln L(\\lambda) = \\ln \\left( \\prod_{i=1}^{n} \\lambda \\, e^{-\\lambda (t_i - \\tau_{\\mathrm{res}})} \\right) = \\sum_{i=1}^{n} \\ln \\left( \\lambda \\, e^{-\\lambda (t_i - \\tau_{\\mathrm{res}})} \\right)\n$$\n利用对数的性质，上式变为：\n$$\n\\ln L(\\lambda) = \\sum_{i=1}^{n} \\left[ \\ln(\\lambda) + \\ln(e^{-\\lambda (t_i - \\tau_{\\mathrm{res}})}) \\right] = \\sum_{i=1}^{n} \\left[ \\ln(\\lambda) - \\lambda(t_i - \\tau_{\\mathrm{res}}) \\right]\n$$\n$$\n\\ln L(\\lambda) = n \\ln(\\lambda) - \\lambda \\sum_{i=1}^{n} (t_i - \\tau_{\\mathrm{res}})\n$$\n为了找到使该函数最大化的 $\\lambda$ 值，我们对 $\\lambda$ 求一阶导数并令其为零：\n$$\n\\frac{d}{d\\lambda} \\ln L(\\lambda) = \\frac{n}{\\lambda} - \\sum_{i=1}^{n} (t_i - \\tau_{\\mathrm{res}}) = 0\n$$\n求解 $\\lambda$ 得到最大似然估计值 $\\hat{\\lambda}_{\\mathrm{MLE}}$：\n$$\n\\frac{n}{\\hat{\\lambda}_{\\mathrm{MLE}}} = \\sum_{i=1}^{n} (t_i - \\tau_{\\mathrm{res}})\n$$\n$$\n\\hat{\\lambda}_{\\mathrm{MLE}} = \\frac{n}{\\sum_{i=1}^{n} t_i - n\\tau_{\\mathrm{res}}}\n$$\n这个表达式可以用观测驻留时间的样本均值 $\\bar{t} = \\frac{1}{n} \\sum_{i=1}^{n} t_i$ 来重写：\n$$\n\\hat{\\lambda}_{\\mathrm{MLE}} = \\frac{1}{\\frac{1}{n}\\left(\\sum_{i=1}^{n} t_i - n\\tau_{\\mathrm{res}}\\right)} = \\frac{1}{\\left(\\frac{1}{n}\\sum_{i=1}^{n} t_i\\right) - \\tau_{\\mathrm{res}}} = \\frac{1}{\\bar{t} - \\tau_{\\mathrm{res}}}\n$$\n这个结果在直观上是令人满意的。平移指数分布的均值是 $\\tau_{\\mathrm{res}} + 1/\\lambda$。样本均值 $\\bar{t}$ 是该量的一个无偏估计量。通过设 $\\bar{t} \\approx \\tau_{\\mathrm{res}} + 1/\\lambda$ 并求解 $\\lambda$，我们得到了与 MLE 相同的表达式。\n\n问题提供了两组独立的观测驻留时间：用于估计 $k_{co}$ 的关闭时间 $\\{C_i\\}$ 和用于估计 $k_{oc}$ 的开放时间 $\\{O_j\\}$。每个速率的估计都使用推导出的公式独立进行。\n\n从关闭态到开放态的速率估计器 $\\hat{k}_{co}$ 是：\n$$\n\\hat{k}_{co} = \\frac{1}{\\bar{C} - \\tau_{\\mathrm{res}}}\n$$\n其中 $\\bar{C}$ 是观测到的关闭态驻留时间的样本均值。\n\n从开放态到关闭态的速率估计器 $\\hat{k}_{oc}$ 是：\n$$\n\\hat{k}_{oc} = \\frac{1}{\\bar{O} - \\tau_{\\mathrm{res}}}\n$$\n其中 $\\bar{O}$ 是观测到的开放态驻留时间的样本均值。\n\n每个测试案例的总体步骤如下：\n1.  给定 $t_r$ 和 $\\Delta t$，计算有效死时间 $\\tau_{\\mathrm{res}} = \\sqrt{t_r^2 + (\\Delta t)^2}$。\n2.  对于关闭态驻留时间集合，计算其样本均值 $\\bar{C}$。\n3.  计算速率估计值 $\\hat{k}_{co} = 1 / (\\bar{C} - \\tau_{\\mathrm{res}})$。\n4.  对于开放态驻留时间集合，计算其样本均值 $\\bar{O}$。\n5.  计算速率估计值 $\\hat{k}_{oc} = 1 / (\\bar{O} - \\tau_{\\mathrm{res}})$。\n\n此过程将应用于问题陈述中提供的三个测试案例中的每一个。最终输出是包含六个估计速率的列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating ion channel transition rates from truncated\n    dwell-time data using Maximum Likelihood Estimation.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"tr\": 0.0005,\n            \"dt\": 0.0002,\n            \"closed_times\": np.array([\n                0.0054385165, 0.0056385165, 0.0058385165, 0.0052385165,\n                0.0055385165, 0.0057385165, 0.0053385165, 0.0059385165\n            ]),\n            \"open_times\": np.array([\n                0.0033385165, 0.0036385165, 0.0037385165, 0.0035385165,\n                0.0034385165, 0.0038385165, 0.0036385165, 0.0032385165\n            ])\n        },\n        {\n            \"tr\": 0.0020,\n            \"dt\": 0.0010,\n            \"closed_times\": np.array([\n                0.01523606798, 0.01723606798, 0.01623606798,\n                0.01823606798, 0.01573606798\n            ]),\n            \"open_times\": np.array([\n                0.00773606798, 0.00833606798, 0.00853606798,\n                0.00823606798, 0.00793606798\n            ])\n        },\n        {\n            \"tr\": 0.0001,\n            \"dt\": 0.0020,\n            \"closed_times\": np.array([\n                0.00670249844, 0.00720249844, 0.00710249844, 0.00690249844\n            ]),\n            \"open_times\": np.array([\n                0.00530249844, 0.00560249844, 0.00540249844, 0.00570249844\n            ])\n        }\n    ]\n\n    def estimate_rate(dwell_times, t_r, delta_t):\n        \"\"\"\n        Calculates the MLE for the rate of a truncated exponential distribution.\n\n        Args:\n            dwell_times (np.ndarray): Array of observed dwell times.\n            t_r (float): Filter rise time.\n            delta_t (float): Sampling interval.\n\n        Returns:\n            float: The estimated rate parameter.\n        \"\"\"\n        # Calculate the effective dead-time (resolution)\n        tau_res = np.sqrt(t_r**2 + delta_t**2)\n\n        # Calculate the sample mean of the observed dwell times\n        mean_dwell_time = np.mean(dwell_times)\n\n        # Apply the MLE formula for the rate of a truncated exponential distribution\n        # rate = 1 / (mean_observed_time - resolution_time)\n        rate_estimate = 1.0 / (mean_dwell_time - tau_res)\n        \n        return rate_estimate\n\n    results = []\n    for case in test_cases:\n        # Estimate the closed-to-open transition rate (k_co)\n        k_co = estimate_rate(case[\"closed_times\"], case[\"tr\"], case[\"dt\"])\n        \n        # Estimate the open-to-closed transition rate (k_oc)\n        k_oc = estimate_rate(case[\"open_times\"], case[\"tr\"], case[\"dt\"])\n        \n        results.extend([k_co, k_oc])\n\n    # Format the output as a comma-separated list of floating point numbers\n    # enclosed in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "4995859"}]}