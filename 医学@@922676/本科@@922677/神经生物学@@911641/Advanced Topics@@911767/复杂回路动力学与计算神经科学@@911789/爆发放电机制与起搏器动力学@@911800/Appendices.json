{"hands_on_practices": [{"introduction": "真实的起搏神经元通常表现为簇状放电，这是一种比简单的持续放电更复杂的模式。本练习从LIF模型进阶到一个最小化的双变量系统，该系统通过快慢动态的相互作用捕捉了簇状放电产生的本质。通过对该模型进行数值模拟并计算簇状放电的“占空比”，您将获得关于内在节律性机制的实践经验，并学会如何量化复杂的放电模式。[@problem_id:5003133]", "problem": "题目要求你实现并分析一个最小电导起搏器模型，以量化簇发放占空比。该模型基于标准的被动膜方程和一阶门控动力学。考虑如下系统：\n$$\nC \\frac{dV}{dt} = I_{\\mathrm{app}} + F(V,w), \\quad \\frac{dw}{dt} = G(V,w),\n$$\n其中\n$$\nF(V,w) = -g_{\\mathrm{Na}}\\,m_{\\infty}(V)\\,(V-E_{\\mathrm{Na}}) - g_{\\mathrm{K}}\\,w\\,(V-E_{\\mathrm{K}}) - g_L\\,(V-E_L),\n$$\n且\n$$\nG(V,w) = \\alpha(V)\\,(1-w) - \\beta(V)\\,w.\n$$\n稳态激活函数为\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{V - V_m}{V_k}\\right)\\right),\n$$\n电压依赖的激活和失活速率为\n$$\n\\alpha(V) = \\phi\\,\\exp\\left(\\frac{V - V_a}{V_b}\\right), \\quad \\beta(V) = \\phi\\,\\exp\\left(-\\frac{V - V_a}{V_b}\\right).\n$$\n模型参数固定如下：\n$$\nC = 20.0,\\quad g_{\\mathrm{Na}}=4.4,\\quad g_{\\mathrm{K}}=8.0,\\quad g_L=2.0,\n$$\n$$\nE_{\\mathrm{Na}}=50.0,\\quad E_{\\mathrm{K}}=-84.0,\\quad E_L=-60.0,\n$$\n$$\nV_m=-1.2,\\quad V_k=18.0,\\quad V_a=2.0,\\quad V_b=30.0,\\quad \\phi=0.04.\n$$\n所有电压单位为毫伏（mV），时间单位为毫秒（ms）；电导和电流采用一致的任意单位，所选单位使方程在量纲上保持一致。设初始条件为\n$$\nV(0)=-60.0,\\quad w(0)=0.0.\n$$\n你必须使用固定的时间步长和四阶龙格－库塔（Runge–Kutta fourth order (RK4)）方法，在一个固定的仿真区间内对系统进行数值积分。使用：\n- 仿真时长：$$T_{\\mathrm{sim}}=4000.0\\ \\text{ms}$$。\n- 时间步长：$$\\Delta t=0.01\\ \\text{ms}$$。\n- 瞬态丢弃时间：$$T_{\\mathrm{discard}}=2000.0\\ \\text{ms}$$。\n- 活动态检测阈值：$$V_{\\mathrm{th}}=-20.0\\ \\text{mV}$$。\n\n将活动相定义为满足 $$V(t) > V_{\\mathrm{th}}$$ 的时间集合，静息相定义为满足 $$V(t) \\le V_{\\mathrm{th}}$$ 的时间集合。在瞬态后的窗口 $$[T_{\\mathrm{discard}},T_{\\mathrm{sim}}]$$ 内，计算簇发放占空比，其为以下比率：\n$$\n\\mathcal{D} = \\frac{T_{\\mathrm{active}}}{T_{\\mathrm{silent}}},\n$$\n其中 $$T_{\\mathrm{active}}$$ 和 $$T_{\\mathrm{silent}}$$ 分别表示在瞬态后窗口内系统处于活动相和静息相的总时间。如果 $$T_{\\mathrm{silent}}=0$$，则定义 $$\\mathcal{D}=+\\infty$$。占空比 $$\\mathcal{D}$$ 是无量纲的。你的数值估算结果必须报告并四舍五入到三位小数，但值 $$+\\infty$$ 应表示为你的编程语言中代表正无穷大的字符串。\n\n建模基本依据：\n- 被动膜电流平衡：$$C \\frac{dV}{dt} = -I_{\\mathrm{ion}} + I_{\\mathrm{app}}$$，其中 $$I_{\\mathrm{ion}}$$ 是离子电流的总和。\n- 一阶门控动力学：$$\\frac{dw}{dt} = \\alpha(V)\\,(1-w) - \\beta(V)\\,w$$。\n- 稳态激活和速率函数如上定义。\n\n任务：\n- 使用给定参数实现一个 RK4 求解器。\n- 使用 $$V_{\\mathrm{th}}$$ 检测活动相与静息相。\n- 在 $$[T_{\\mathrm{discard}},T_{\\mathrm{sim}}]$$ 上计算 $$\\mathcal{D}$$。\n- 四舍五入到三位小数（标准四舍五入到最接近的数值，中间值按典型浮点行为允许的方式舍入到最接近的偶数）。\n\n测试套件：\n评估以下三组参数集的占空比，这些参数集仅改变 $$I_{\\mathrm{app}}$$ 的值，而其他所有参数均与上文所列相同：\n1. 情况 A（振荡/起搏器机制候选）：$$I_{\\mathrm{app}}=90.0$$。\n2. 情况 B（静息机制候选）：$$I_{\\mathrm{app}}=0.0$$。\n3. 情况 C（持续活动机制候选）：$$I_{\\mathrm{app}}=200.0$$。\n\n最终输出格式：\n你的程序应产生单行输出，其中包含三个占空比结果，按情况 A、情况 B、情况 C 的顺序排列，形式为逗号分隔的列表并用方括号括起，例如：\n$$\n[\\mathcal{D}_A,\\mathcal{D}_B,\\mathcal{D}_C].\n$$\n每个 $$\\mathcal{D}$$ 都应按规定四舍五入到三位小数。如果 $$\\mathcal{D}=+\\infty$$，相应的条目应为编程语言的无穷大字面量。不应打印任何额外文本。", "solution": "## 问题验证\n\n### 第 1 步：提取已知条件\n\n该问题提供了一个神经元起搏器的数学模型，由一个包含两个耦合常微分方程（ODE）的系统定义：\n1.  **膜电位动力学**：\n    $$C \\frac{dV}{dt} = I_{\\mathrm{app}} + F(V,w)$$\n2.  **门控变量动力学**：\n    $$\\frac{dw}{dt} = G(V,w)$$\n\n函数 $F(V,w)$ 和 $G(V,w)$ 定义如下：\n$$F(V,w) = -g_{\\mathrm{Na}}\\,m_{\\infty}(V)\\,(V-E_{\\mathrm{Na}}) - g_{\\mathrm{K}}\\,w\\,(V-E_{\\mathrm{K}}) - g_L\\,(V-E_L)$$\n$$G(V,w) = \\alpha(V)\\,(1-w) - \\beta(V)\\,w$$\n\n稳态激活和电压依赖性速率的辅助函数为：\n$$m_{\\infty}(V) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{V - V_m}{V_k}\\right)\\right)$$\n$$\\alpha(V) = \\phi\\,\\exp\\left(\\frac{V - V_a}{V_b}\\right)$$\n$$\\beta(V) = \\phi\\,\\exp\\left(-\\frac{V - V_a}{V_b}\\right)$$\n\n提供了一组固定的参数：\n- 电容：$C = 20.0$\n- 电导：$g_{\\mathrm{Na}}=4.4$，$g_{\\mathrm{K}}=8.0$，$g_L=2.0$\n- 反转电位：$E_{\\mathrm{Na}}=50.0$ mV，$E_{\\mathrm{K}}=-84.0$ mV，$E_L=-60.0$ mV\n- 门控参数：$V_m=-1.2$ mV，$V_k=18.0$ mV，$V_a=2.0$ mV，$V_b=30.0$ mV，$\\phi=0.04$\n\n系统在时间 $t=0$ 的初始条件为：\n$$V(0)=-60.0 \\text{ mV}, \\quad w(0)=0.0$$\n\n数值模拟和分析协议规定如下：\n- 数值方法：四阶龙格－库塔（RK4）\n- 仿真时长：$T_{\\mathrm{sim}}=4000.0$ ms\n- 时间步长：$\\Delta t=0.01$ ms\n- 瞬态丢弃时间：$T_{\\mathrm{discard}}=2000.0$ ms\n- 活动态阈值：$V_{\\mathrm{th}}=-20.0$ mV\n\n需要计算的量是在区间 $[T_{\\mathrm{discard}}, T_{\\mathrm{sim}}]$ 上的簇发放占空比 $\\mathcal{D}$：\n$$\\mathcal{D} = \\frac{T_{\\mathrm{active}}}{T_{\\mathrm{silent}}}$$\n其中 $T_{\\mathrm{active}}$ 是 $V(t) > V_{\\mathrm{th}}$ 的总时间，$T_{\\mathrm{silent}}$ 是 $V(t) \\le V_{\\mathrm{th}}$ 的总时间。定义了一种特殊情况：如果 $T_{\\mathrm{silent}}=0$，则 $\\mathcal{D}=+\\infty$。\n\n任务是针对三个测试用例评估 $\\mathcal{D}$，仅改变外加电流 $I_{\\mathrm{app}}$：\n- 情况 A：$I_{\\mathrm{app}}=90.0$\n- 情况 B：$I_{\\mathrm{app}}=0.0$\n- 情况 C：$I_{\\mathrm{app}}=200.0$\n\n### 第 2 步：使用提取的已知条件进行验证\n\n根据指定标准对问题进行验证：\n- **科学依据**：该模型是 Hodgkin–Huxley 类型的一个简化电导模型，是计算神经科学的基石。膜电位动力学方程（包含离子电流的被动膜方程）和一阶门控动力学是该领域的基本原理。激活和速率常数（S 型和指数型）的函数形式是标准的，并具有生物物理动机。该问题在科学上是合理的。\n- **良态性**：该问题是一个包含两个一阶常微分方程组的初值问题（IVP）。右端函数 $F(V,w)$ 和 $G(V,w)$ 关于其参数 $V$ 和 $w$ 是光滑的（无穷可微的）。根据 Picard–Lindelöf 定理，存在唯一且连续的解。任务要求在有限区间上进行数值近似，这是一个标准的、定义明确的计算任务。目标度量 $\\mathcal{D}$ 的定义是精确的，包括其在 $T_{\\mathrm{silent}}=0$ 边界情况下的行为。\n- **客观性**：该问题以精确的数学语言陈述。所有量都有定义，任务是基于这些定义的纯计算练习。没有主观或模棱两可的陈述。\n- **完整性与一致性**：解决问题所需的所有参数、初始条件和程序细节都已明确提供。没有缺失的数据点或矛盾的约束。单位被说明是一致的。\n\n### 第 3 步：结论与行动\n\n该问题是有效的。它是一个良态的、有科学依据且完全指定的计算神经生物学问题。我将继续制定和实施解决方案。\n\n## 解决方案\n\n解决方案涉及对给定的常微分方程组进行数值积分，然后分析得到的电压轨迹以计算指定的占空比 $\\mathcal{D}$。对三个不同的外加电流 $I_{\\text{app}}$ 值重复此过程。\n\n### 1. 数学公式\n待求解的系统是关于状态向量 $Y(t) = [V(t), w(t)]^T$ 的一对耦合一阶常微分方程：\n$$\n\\frac{dY}{dt} = f(Y; I_{\\text{app}}) = \\begin{bmatrix} \\frac{1}{C} \\left( I_{\\text{app}} -g_{\\mathrm{Na}}\\,m_{\\infty}(V)\\,(V-E_{\\mathrm{Na}}) - g_{\\mathrm{K}}\\,w\\,(V-E_{\\mathrm{K}}) - g_L\\,(V-E_L) \\right) \\\\ \\alpha(V)\\,(1-w) - \\beta(V)\\,w \\end{bmatrix}\n$$\n所有参数和辅助函数均如问题陈述中定义。\n\n### 2. 数值积分：四阶龙格－库塔（RK4）\n从初始条件 $Y_0 = [V(0), w(0)]^T = [-60.0, 0.0]^T$ 开始，使用 RK4 方法和固定时间步长 $\\Delta t = 0.01$ ms 对系统进行积分。对于从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的每一步，状态向量 $Y_{n+1}$ 由 $Y_n$ 计算如下：\n$$Y_{n+1} = Y_n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$\n其中中间斜率为：\n$$\n\\begin{aligned}\nk_1 = f(Y_n; I_{\\text{app}}) \\\\\nk_2 = f(Y_n + \\frac{\\Delta t}{2} k_1; I_{\\text{app}}) \\\\\nk_3 = f(Y_n + \\frac{\\Delta t}{2} k_2; I_{\\text{app}}) \\\\\nk_4 = f(Y_n + \\Delta t k_3; I_{\\text{app}})\n\\end{aligned}\n$$\n此迭代过程在整个仿真时长 $T_{\\text{sim}} = 4000.0$ ms 内重复进行，生成膜电位的离散时间序列 $V(t_i)$，其中 $t_i = i \\Delta t$。\n\n### 3. 占空比计算\n占空比 $\\mathcal{D}$ 在瞬态后分析窗口 $[T_{\\mathrm{discard}}, T_{\\mathrm{sim}}]$ 上计算，该窗口从 $t=2000.0$ ms 延伸到 $t=4000.0$ ms。\n分析此窗口内的离散电压轨迹 $V(t_i)$。分析窗口由一系列时长为 $\\Delta t$ 的时间区间组成。对于每个从时间 $t_i$ 开始的此类区间，系统状态根据电压 $V(t_i)$ 进行分类：\n-   如果 $V(t_i) > V_{\\mathrm{th}} = -20.0$ mV，则该区间被分类为**活动**。\n-   如果 $V(t_i) \\le V_{\\mathrm{th}} = -20.0$ mV，则该区间被分类为**静息**。\n\n在每个相中花费的总时间通过对相应区间的时长求和来计算：\n$$T_{\\mathrm{active}} = (\\text{活动区间数}) \\times \\Delta t$$\n$$T_{\\mathrm{silent}} = (\\text{静息区间数}) \\times \\Delta t$$\n分析窗口的总时长为 $T_{\\mathrm{sim}} - T_{\\mathrm{discard}} = 2000.0$ ms，所以 $T_{\\mathrm{active}} + T_{\\mathrm{silent}} = 2000.0$ ms。\n\n然后占空比计算为以下比率：\n$$\\mathcal{D} = \\frac{T_{\\mathrm{active}}}{T_{\\mathrm{silent}}}$$\n在分析窗口中的所有区间都是活动的情况下，$T_{\\mathrm{silent}}$ 将为 $0$。按规定，占空比则定义为 $\\mathcal{D} = +\\infty$。\n\n### 4. 测试用例的实现\n整个过程——从 RK4 积分到占空比计算——被封装起来，并对 $I_{\\text{app}}$ 的三个给定测试用例：$90.0$（情况 A）、$0.0$（情况 B）和 $200.0$（情况 C）分别执行。最终的数值结果四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the full solution to the pacemaker model problem.\n    It simulates the neuron dynamics for three different applied currents\n    and calculates the burst duty cycle for each case.\n    \"\"\"\n    \n    # --- Model Parameters ---\n    # These are shared across all test cases.\n    params = {\n        'C': 20.0, 'g_Na': 4.4, 'g_K': 8.0, 'g_L': 2.0,\n        'E_Na': 50.0, 'E_K': -84.0, 'E_L': -60.0,\n        'V_m': -1.2, 'V_k': 18.0, 'V_a': 2.0, 'V_b': 30.0, 'phi': 0.04\n    }\n\n    # --- Simulation Parameters ---\n    T_sim = 4000.0\n    dt = 0.01\n    T_discard = 2000.0\n    V_th = -20.0\n    V0 = -60.0\n    w0 = 0.0\n\n    # --- Helper Functions for the Model Gating Variables and Currents ---\n    def m_inf(V, p):\n        return 0.5 * (1.0 + np.tanh((V - p['V_m']) / p['V_k']))\n\n    def alpha(V, p):\n        return p['phi'] * np.exp((V - p['V_a']) / p['V_b'])\n\n    def beta(V, p):\n        return p['phi'] * np.exp(-(V - p['V_a']) / p['V_b'])\n\n    # --- ODE System Definition ---\n    # This function calculates the derivatives dV/dt and dw/dt.\n    def derivatives(state, I_app, p):\n        V, w = state\n        \n        # dV/dt component based on ionic currents\n        I_Na = p['g_Na'] * m_inf(V, p) * (V - p['E_Na'])\n        I_K = p['g_K'] * w * (V - p['E_K'])\n        I_L = p['g_L'] * (V - p['E_L'])\n        dVdt = (I_app - I_Na - I_K - I_L) / p['C']\n        \n        # dw/dt component based on gating kinetics\n        a_V = alpha(V, p)\n        b_V = beta(V, p)\n        dwdt = a_V * (1.0 - w) - b_V * w\n        \n        return np.array([dVdt, dwdt])\n\n    # --- Main Solver and Analysis Function ---\n    def run_simulation_and_analyze(I_app, p):\n        \"\"\"\n        Runs a single RK4 simulation and computes the duty cycle.\n        \"\"\"\n        # Initialization\n        num_steps = int(T_sim / dt)\n        V_trace = np.zeros(num_steps + 1)\n        \n        state = np.array([V0, w0])\n        V_trace[0] = state[0]\n        \n        # RK4 Integration Loop\n        for i in range(num_steps):\n            k1 = derivatives(state, I_app, p)\n            k2 = derivatives(state + 0.5 * dt * k1, I_app, p)\n            k3 = derivatives(state + 0.5 * dt * k2, I_app, p)\n            k4 = derivatives(state + dt * k3, I_app, p)\n            \n            state += (dt / 6.0) * (k1 + 2.0*k2 + 2.0*k3 + k4)\n            V_trace[i+1] = state[0]\n            \n        # Post-transient analysis\n        discard_index = int(T_discard / dt)\n        # The analysis window includes time points from T_discard up to (but not including) T_sim.\n        # This corresponds to num_steps - discard_index intervals of duration dt.\n        analysis_v_values = V_trace[discard_index:num_steps]\n        \n        num_active_intervals = np.sum(analysis_v_values > V_th)\n        num_silent_intervals = len(analysis_v_values) - num_active_intervals\n        \n        T_active = num_active_intervals * dt\n        T_silent = num_silent_intervals * dt\n        \n        # Compute Duty Cycle\n        if T_silent == 0.0:\n            duty_cycle = float('inf')\n        else:\n            duty_cycle = T_active / T_silent\n        \n        return duty_cycle\n\n    # --- Run Test Suite ---\n    test_cases = [\n        90.0,   # Case A\n        0.0,    # Case B\n        200.0,  # Case C\n    ]\n    results = []\n\n    for i_app in test_cases:\n        duty_cycle = run_simulation_and_analyze(i_app, params)\n        if duty_cycle == float('inf'):\n            results.append(str(duty_cycle))\n        else:\n            results.append(f\"{duty_cycle:.3f}\")\n            \n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "5003133"}, {"introduction": "特定的离子通道是如何赋予神经元起搏器特性的？这个高级实践通过模拟动态钳（dynamic clamp）实验来回答此问题，重点关注超极化激活阳离子电流 $I_h$ 的关键作用。您将从经典的、在静息状态下不放电的 Hodgkin-Huxley 模型入手，通过计算注入一个合成的 $I_h$ 电流，并观察它如何转变为一个自主起搏器。该练习弥合了理论模型与实验神经科学之间的鸿沟，揭示了节律产生的离子基础。[@problem_id:5003163]", "problem": "您的任务是，在纯粹的数学和算法层面，设计并分析一个单室电导神经元模型。该模型初始时处于静息状态，当通过动态钳技术加入一种人工的超极化激活阳离子电导（通常称为超极化激活电流，$I_h$）后，会转变为起搏神经元。在这里，动态钳表现为注入一种合成电流，该电流根据指定的动力学特性从膜电压实时计算得出。目标是确定合成 $I_h$ 的参数范围，使其在没有任何外部施加电流的情况下，诱发自主的起搏放电。\n\n从一个经过充分检验的、电容为 $C$ 的空间等电位房室的膜电流平衡方程开始：\n$$\nC \\frac{dV}{dt} = -\\left(I_{\\text{Na}} + I_{\\text{K}} + I_{\\text{L}} + I_h\\right) + I_{\\text{app}},\n$$\n其中，$V$ 是膜电位，$I_{\\text{Na}}$ 是快速钠电流，$I_{\\text{K}}$ 是延迟整流钾电流，$I_{\\text{L}}$ 是漏电流，$I_h$ 是通过动态钳注入的合成超极化激活电流，$I_{\\text{app}}$ 是施加的电流。在本实验中，您必须设置 $I_{\\text{app}} = 0$，以使自主放电（起搏动力学）成为节律性的唯一来源。\n\n对 $I_{\\text{Na}}$ 和 $I_{\\text{K}}$ 使用 Hodgkin-Huxley 型动力学，采用以下经过充分检验的公式，所有单位均为毫伏（$\\text{mV}$）和毫秒（$\\text{ms}$）：\n$$\nI_{\\text{Na}} = g_{\\text{Na}} m^3 h \\left(V - E_{\\text{Na}}\\right), \\quad I_{\\text{K}} = g_{\\text{K}} n^4 \\left(V - E_{\\text{K}}\\right), \\quad I_{\\text{L}} = g_{\\text{L}} \\left(V - E_{\\text{L}}\\right),\n$$\n其门控变量动力学为\n$$\n\\frac{dm}{dt} = \\alpha_m(V)\\left(1 - m\\right) - \\beta_m(V) m, \\quad \\frac{dh}{dt} = \\alpha_h(V)\\left(1 - h\\right) - \\beta_h(V) h, \\quad \\frac{dn}{dt} = \\alpha_n(V)\\left(1 - n\\right) - \\beta_n(V) n,\n$$\n其中速率函数为\n$$\n\\alpha_m(V) = 0.1 \\frac{V + 40}{1 - e^{-(V + 40)/10}}, \\quad \\beta_m(V) = 4 e^{-(V + 65)/18},\n$$\n$$\n\\alpha_h(V) = 0.07 e^{-(V + 65)/20}, \\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V + 35)/10}},\n$$\n$$\n\\alpha_n(V) = 0.01 \\frac{V + 55}{1 - e^{-(V + 55)/10}}, \\quad \\beta_n(V) = 0.125 e^{-(V + 65)/80}.\n$$\n使用以下标准参数集\n$$\nC = 1.0 \\ \\mu\\text{F}/\\text{cm}^2, \\quad g_{\\text{Na}} = 120.0 \\ \\text{mS}/\\text{cm}^2, \\quad g_{\\text{K}} = 36.0 \\ \\text{mS}/\\text{cm}^2, \\quad g_{\\text{L}} = 0.3 \\ \\text{mS}/\\text{cm}^2,\n$$\n$$\nE_{\\text{Na}} = 50.0 \\ \\text{mV}, \\quad E_{\\text{K}} = -77.0 \\ \\text{mV}, \\quad E_{\\text{L}} = -54.4 \\ \\text{mV}.\n$$\n将动态钳 $I_h$ 建模为\n$$\nI_h = g_h r \\left(V - E_h\\right),\n$$\n其中 $g_h$ 是最大电导，$E_h$ 是反转电位，$r$ 是一个遵循一级动力学的激活变量\n$$\n\\frac{dr}{dt} = \\frac{r_{\\infty}(V) - r}{\\tau_h},\n$$\n其稳态激活函数为\n$$\nr_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{1/2}}{k}\\right)}.\n$$\n这一选择确保了当 $V$ 更加超极化时，$r_{\\infty}(V)$ 会增加，这与超极化激活的特性一致。为简化起见，这里的 $\\tau_h$ 取为常数，$V_{1/2}$ 是半激活电压，$k$ 是斜率因子。\n\n初始条件应为在钳制电位 $V_{\\text{init}} = -65.0 \\ \\text{mV}$ 下 $m$、$h$ 和 $n$ 的稳态值，同时 $r = r_{\\infty}(V_{\\text{init}})$ 且 $V(0) = V_{\\text{init}}$。\n\n$I_h$ 的科学合理参数范围为：$E_h$ 在 $-30.0 \\ \\text{mV}$ 到 $-20.0 \\ \\text{mV}$ 之间，$V_{1/2}$ 在 $-90.0 \\ \\text{mV}$ 到 $-70.0 \\ \\text{mV}$ 之间，$k$ 在 $5.0 \\ \\text{mV}$ 到 $10.0 \\ \\text{mV}$ 之间，$\\tau_h$ 在 $50.0 \\ \\text{ms}$ 到 $500.0 \\ \\text{ms}$ 之间。在本问题中，固定 $E_h = -30.0 \\ \\text{mV}$，$k = 7.0 \\ \\text{mV}$，并如下文所述改变 $g_h$、$V_{1/2}$ 和 $\\tau_h$。\n\n仿真要求：\n- 使用固定时间步长 $dt = 0.01 \\ \\text{ms}$ 对系统进行积分，总时长为 $T = 3000.0 \\ \\text{ms}$，并设 $I_{\\text{app}} = 0.0$。\n- 将 $V$ 向上穿过 $0.0 \\ \\text{mV}$ 的事件检测为峰电位。\n- 按如下方式定义起搏状态：考虑在初始瞬态之后（$t \\ge 2000.0 \\ \\text{ms}$）发生的峰电位。如果在最后 $1000.0 \\ \\text{ms}$ 内至少有 $3$ 个峰电位，并且该时间窗内峰间期的变异系数（标准差除以平均值）$\\le 0.3$，则报告平均放电频率（单位为 $\\text{Hz}$），其值为 1 除以平均峰间期（单位为 $\\text{s}$）。如果在最后 $1000.0 \\ \\text{ms}$ 内没有峰电位，且平均膜电位 $\\ge -45.0 \\ \\text{mV}$，则报告一个哨兵值 $-1.0$ 以指示去极化阻滞。否则，报告 $0.0$ 以指示静息或不规则/非起搏放电。\n- 将每个测试案例的最终放电频率以 $\\text{Hz}$ 为单位，表示为浮点数。\n\n测试套件：\n提供以下参数集的结果，所有其他参数均按前述固定：\n- 案例 1（对照组，静息）：$g_h = 0.0 \\ \\text{mS}/\\text{cm}^2$, $V_{1/2} = -80.0 \\ \\text{mV}$, $\\tau_h = 200.0 \\ \\text{ms}$。\n- 案例 2（预期起搏）：$g_h = 0.05 \\ \\text{mS}/\\text{cm}^2$, $V_{1/2} = -80.0 \\ \\text{mV}$, $\\tau_h = 200.0 \\ \\text{ms}$。\n- 案例 3（边界情况，可能出现去极化阻滞）：$g_h = 0.20 \\ \\text{mS}/\\text{cm}^2$, $V_{1/2} = -80.0 \\ \\text{mV}$, $\\tau_h = 200.0 \\ \\text{ms}$。\n- 案例 4（较不超极化的激活）：$g_h = 0.05 \\ \\text{mS}/\\text{cm}^2$, $V_{1/2} = -70.0 \\ \\text{mV}$, $\\tau_h = 200.0 \\ \\text{ms}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是相应案例的 $\\text{Hz}$ 值，对于去极化阻滞使用哨兵值 $-1.0$，对于静息或非起搏放电使用 $0.0$，如上定义。", "solution": "该问题要求设计一种数值仿真和分析算法，以研究合成的超极化激活阳离子电流 $I_h$ 如何在一个原本静息的单室 Hodgkin-Huxley 型神经元模型中诱发起搏活动。该神经元的动力学由一个一阶常微分方程（ODE）组描述。\n\n模型的核心是膜电位方程，它平衡了神经元膜上的各种电流：\n$$\nC \\frac{dV}{dt} = -I_{\\text{ion}} + I_{\\text{app}}\n$$\n其中 $C = 1.0 \\ \\mu\\text{F}/\\text{cm}^2$ 是膜电容，$V$ 是以 $\\text{mV}$ 为单位的膜电位，$I_{\\text{app}}$ 是外部施加电流，在本问题中设为 $I_{\\text{app}} = 0.0 \\ \\mu\\text{A}/\\text{cm}^2$ 以研究自主放电。总离子电流 $I_{\\text{ion}}$ 是四个分量的总和：\n$$\nI_{\\text{ion}} = I_{\\text{Na}} + I_{\\text{K}} + I_{\\text{L}} + I_h\n$$\n各电流定义如下：\n1.  **快速钠电流 ($I_{\\text{Na}}$)**: $I_{\\text{Na}} = g_{\\text{Na}} m^3 h (V - E_{\\text{Na}})$，其中 $g_{\\text{Na}} = 120.0 \\ \\text{mS}/\\text{cm}^2$，$E_{\\text{Na}} = 50.0 \\ \\text{mV}$。\n2.  **延迟整流钾电流 ($I_{\\text{K}}$)**: $I_{\\text{K}} = g_{\\text{K}} n^4 (V - E_{\\text{K}})$，其中 $g_{\\text{K}} = 36.0 \\ \\text{mS}/\\text{cm}^2$，$E_{\\text{K}} = -77.0 \\ \\text{mV}$。\n3.  **漏电流 ($I_{\\text{L}}$)**: $I_{\\text{L}} = g_{\\text{L}} (V - E_{\\text{L}})$，其中 $g_{\\text{L}} = 0.3 \\ \\text{mS}/\\text{cm}^2$，$E_{\\text{L}} = -54.4 \\ \\text{mV}$。\n4.  **超极化激活阳离子电流 ($I_h$)**: 这是一个合成电流，建模为 $I_h = g_h r (V - E_h)$，其中 $E_h = -30.0 \\ \\text{mV}$。最大电导 $g_h$ 是一个可变参数。\n\n这些电流的动力学由门控变量 $m$、$h$、$n$ 和 $r$ 控制，每个变量都遵循一级动力学。完整的 ODE 系统如下：\n$$\n\\frac{dV}{dt} = \\frac{1}{C} \\left( -g_{\\text{Na}} m^3 h (V - E_{\\text{Na}}) - g_{\\text{K}} n^4 (V - E_{\\text{K}}) - g_{\\text{L}} (V - E_{\\text{L}}) - g_h r (V - E_h) \\right)\n$$\n$$\n\\frac{dm}{dt} = \\alpha_m(V)(1-m) - \\beta_m(V)m\n$$\n$$\n\\frac{dh}{dt} = \\alpha_h(V)(1-h) - \\beta_h(V)h\n$$\n$$\n\\frac{dn}{dt} = \\alpha_n(V)(1-n) - \\beta_n(V)n\n$$\n$$\n\\frac{dr}{dt} = \\frac{r_{\\infty}(V) - r}{\\tau_h}\n$$\n对于 $x \\in \\{m, h, n\\}$，电压依赖的速率函数 $\\alpha_x(V)$ 和 $\\beta_x(V)$，以及 $I_h$ 电流的稳态激活函数 $r_{\\infty}(V)$ 由以下公式给出：\n$$\n\\alpha_m(V) = 0.1 \\frac{V + 40}{1 - e^{-(V + 40)/10}}, \\quad \\beta_m(V) = 4 e^{-(V + 65)/18}\n$$\n$$\n\\alpha_h(V) = 0.07 e^{-(V + 65)/20}, \\quad \\beta_h(V) = \\frac{1}{1 + e^{-(V + 35)/10}}\n$$\n$$\n\\alpha_n(V) = 0.01 \\frac{V + 55}{1 - e^{-(V + 55)/10}}, \\quad \\beta_n(V) = 0.125 e^{-(V + 65)/80}\n$$\n$$\nr_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{1/2}}{k}\\right)}\n$$\n其中 $k = 7.0 \\ \\text{mV}$，$V_{1/2}$ 和 $\\tau_h$ 是可变参数。速率函数 $\\alpha_m(V)$ 和 $\\alpha_n(V)$ 分别在 $V = -40 \\ \\text{mV}$ 和 $V = -55 \\ \\text{mV}$ 处有可去奇点。通过应用洛必达法则处理这些奇点，得到 $\\lim_{V \\to -40} \\alpha_m(V) = 1.0$ 和 $\\lim_{V \\to -55} \\alpha_n(V) = 0.1$。\n\n系统在 $t=0$ 时的初始状态由钳制电位 $V_{\\text{init}} = -65.0 \\ \\text{mV}$ 决定。门控变量的初始值是它们在此电位下的稳态值：\n$$\nV(0) = V_{\\text{init}}\n$$\n$$\nm(0) = m_{\\infty}(V_{\\text{init}}) = \\frac{\\alpha_m(V_{\\text{init}})}{\\alpha_m(V_{\\text{init}}) + \\beta_m(V_{\\text{init}})}\n$$\n$$\nh(0) = h_{\\infty}(V_{\\text{init}}) = \\frac{\\alpha_h(V_{\\text{init}})}{\\alpha_h(V_{\\text{init}}) + \\beta_h(V_{\\text{init}})}\n$$\n$$\nn(0) = n_{\\infty}(V_{\\text{init}}) = \\frac{\\alpha_n(V_{\\text{init}})}{\\alpha_n(V_{\\text{init}}) + \\beta_n(V_{\\text{init}})}\n$$\n$$\nr(0) = r_{\\infty}(V_{\\text{init}})\n$$\n\n算法设计分为两个阶段：数值积分和时间序列分析。\n\n**1. 数值积分算法**\n使用前向欧拉法对 ODE 系统进行数值求解，固定时间步长为 $dt = 0.01 \\ \\text{ms}$，总时长为 $T = 3000.0 \\ \\text{ms}$。设时间步 $i$ 处的状态向量为 $\\mathbf{y}_i = [V_i, m_i, h_i, n_i, r_i]^T$。下一个时间步的状态 $\\mathbf{y}_{i+1}$ 计算如下：\n$\\mathbf{y}_{i+1} = \\mathbf{y}_i + dt \\cdot \\frac{d\\mathbf{y}}{dt}\\bigg|_{\\mathbf{y}_i}$。\n具体来说，对每个变量：\n$$\nV_{i+1} = V_i + \\frac{dt}{C} \\left( -I_{\\text{ion}}(V_i, m_i, h_i, n_i, r_i) \\right)\n$$\n$$\nm_{i+1} = m_i + dt \\cdot (\\alpha_m(V_i)(1-m_i) - \\beta_m(V_i)m_i)\n$$\n$$\nh_{i+1} = h_i + dt \\cdot (\\alpha_h(V_i)(1-h_i) - \\beta_h(V_i)h_i)\n$$\n$$\nn_{i+1} = n_i + dt \\cdot (\\alpha_n(V_i)(1-n_i) - \\beta_n(V_i)n_i)\n$$\n$$\nr_{i+1} = r_i + dt \\cdot \\left(\\frac{r_{\\infty}(V_i) - r_i}{\\tau_h}\\right)\n$$\n仿真总共运行 $N = T/dt = 300,000$ 个步长，并且在每一步都存储膜电位 $V(t)$ 以供后续分析。\n\n**2. 仿真后分析算法**\n分析是在 $t = 2000.0 \\ \\text{ms}$ 到 $t = 3000.0 \\ \\text{ms}$ 的分析窗口内的电压轨迹上进行的。\n首先，检测动作电位（峰电位）。如果膜电位在 $t_j$ 时刻向上穿过 $0.0 \\ \\text{mV}$ 的阈值，即 $V(t_j-dt)  0.0$ 且 $V(t_j) \\ge 0.0$，则记录一个峰电位。\n\n对分析窗口内得到的峰电位时间列表按以下逻辑进行处理：\n- 如果检测到的峰电位数量 $\\ge 3$：\n    1.  计算峰间期（ISI），即连续峰电位之间的时间差。\n    2.  计算 ISI 的平均值（$\\mu_{ISI}$）和标准差（$\\sigma_{ISI}$）。\n    3.  计算变异系数 $CV = \\sigma_{ISI} / \\mu_{ISI}$。\n    4.  如果 $CV \\le 0.3$，则认为放电是规则的（起搏状态）。输出是以赫兹为单位的平均放电频率，计算公式为 $f = 1000 / \\mu_{ISI}$（因为 ISI 的单位是毫秒）。\n    5.  如果 $CV > 0.3$，则放电不规则，输出为 $0.0$。\n- 如果检测到的峰电位数量小于 3：\n    1.  如果有 0 个峰电位，则计算分析窗口内的平均膜电位 $\\mu_V$。\n    2.  如果 $\\mu_V \\ge -45.0 \\ \\text{mV}$，则神经元处于去极化阻滞状态，输出为哨兵值 $-1.0$。\n    3.  否则（即，有 0 个峰电位且 $\\mu_V  -45.0 \\ \\text{mV}$，或有 1 或 2 个峰电位），则认为神经元处于静息状态或表现出非起搏放电，输出为 $0.0$。\n\n将此完整算法应用于测试套件中指定的每个参数集，以确定神经元模型的动力学状态。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n\n    # Test cases: (g_h, V_1/2, tau_h)\n    test_cases = [\n        (0.0, -80.0, 200.0),   # Case 1: Control, quiescent\n        (0.05, -80.0, 200.0),  # Case 2: Expected pacemaker\n        (0.20, -80.0, 200.0),  # Case 3: Edge, potential depolarization block\n        (0.05, -70.0, 200.0)   # Case 4: Less hyperpolarized activation\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(params)\n        results.append(result)\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(params):\n    \"\"\"\n    Runs a single simulation of the Hodgkin-Huxley model with an Ih current.\n    \"\"\"\n    g_h, V_half, tau_h = params\n\n    # Fixed parameters\n    C = 1.0  # uF/cm^2\n    g_Na = 120.0  # mS/cm^2\n    g_K = 36.0   # mS/cm^2\n    g_L = 0.3    # mS/cm^2\n    E_Na = 50.0  # mV\n    E_K = -77.0  # mV\n    E_L = -54.4  # mV\n    E_h = -30.0  # mV\n    k_h = 7.0    # mV\n\n    # Rate functions for gating variables\n    def alpha_m(V):\n        if abs(V + 40.0)  1e-6:\n            return 1.0  # L'Hopital's rule\n        return 0.1 * (V + 40.0) / (1.0 - np.exp(-(V + 40.0) / 10.0))\n\n    def beta_m(V):\n        return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\n    def alpha_h(V):\n        return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\n    def beta_h(V):\n        return 1.0 / (1.0 + np.exp(-(V + 35.0) / 10.0))\n\n    def alpha_n(V):\n        if abs(V + 55.0)  1e-6:\n            return 0.1 # L'Hopital's rule\n        return 0.01 * (V + 55.0) / (1.0 - np.exp(-(V + 55.0) / 10.0))\n\n    def beta_n(V):\n        return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\n    # Steady-state activation for I_h\n    def r_inf(V):\n        return 1.0 / (1.0 + np.exp((V - V_half) / k_h))\n\n    # Simulation setup\n    dt = 0.01  # ms\n    T = 3000.0 # ms\n    num_steps = int(T / dt)\n    \n    V = np.zeros(num_steps + 1)\n    \n    # Initial conditions\n    V_init = -65.0\n    V[0] = V_init\n    \n    m = alpha_m(V_init) / (alpha_m(V_init) + beta_m(V_init))\n    h = alpha_h(V_init) / (alpha_h(V_init) + beta_h(V_init))\n    n = alpha_n(V_init) / (alpha_n(V_init) + beta_n(V_init))\n    r = r_inf(V_init)\n\n    # Simulation loop\n    for i in range(num_steps):\n        # Calculate ionic currents\n        I_Na = g_Na * m**3 * h * (V[i] - E_Na)\n        I_K = g_K * n**4 * (V[i] - E_K)\n        I_L = g_L * (V[i] - E_L)\n        I_h_val = g_h * r * (V[i] - E_h)\n        I_total = I_Na + I_K + I_L + I_h_val\n\n        # Update state variables using forward Euler method\n        V[i+1] = V[i] + (dt / C) * (-I_total)\n        m = m + dt * (alpha_m(V[i]) * (1.0 - m) - beta_m(V[i]) * m)\n        h = h + dt * (alpha_h(V[i]) * (1.0 - h) - beta_h(V[i]) * h)\n        n = n + dt * (alpha_n(V[i]) * (1.0 - n) - beta_n(V[i]) * n)\n        r = r + dt * ((r_inf(V[i]) - r) / tau_h)\n\n    # Analysis\n    analysis_start_index = int(2000.0 / dt)\n    V_analysis = V[analysis_start_index:]\n    \n    # Spike detection\n    spike_times = []\n    spike_threshold = 0.0\n    for i in range(1, len(V_analysis)):\n        if V_analysis[i-1]  spike_threshold and V_analysis[i] >= spike_threshold:\n            spike_time = 2000.0 + i * dt\n            spike_times.append(spike_time)\n            \n    num_spikes = len(spike_times)\n\n    if num_spikes >= 3:\n        isis = np.diff(spike_times)\n        mean_isi = np.mean(isis)\n        std_isi = np.std(isis)\n        \n        cv = std_isi / mean_isi if mean_isi > 0 else float('inf')\n        \n        if cv = 0.3:\n            # Pacemaker regime\n            frequency = 1000.0 / mean_isi # ISI in ms -> freq in Hz\n            return round(frequency, 4)\n        else:\n            # Irregular firing\n            return 0.0\n    elif num_spikes == 0:\n        mean_V = np.mean(V_analysis)\n        if mean_V >= -45.0:\n            # Depolarization block\n            return -1.0\n        else:\n            # Quiescence\n            return 0.0\n    else: # 1 or 2 spikes\n        # Not pacemaker firing\n        return 0.0\n\nif __name__ == '__main__':\n    solve()\n```", "id": "5003163"}]}