{"hands_on_practices": [{"introduction": "神经元最基本的电气特性可以通过一个简单的 $RC$（电阻-电容）电路来建模。这个练习将帮助你理解神经元膜电位如何被动地整合随时间变化的输入电流，这构成了其计算能力的基础。通过运用线性叠加原理分析更复杂的输入 [@problem_id:5061374]，你将掌握分析线性神经元模型响应的核心技能。", "problem": "考虑一个单室被动神经元，其模型为电阻-电容（RC）膜，具有膜电容 $C_{m}$、漏电导 $g_{L}$ 和漏泄反转（静息）电位 $E_{L}$。膜电位 $V(t)$ 根据线性微分方程演化\n$$\nC_{m}\\,\\frac{dV}{dt}=-g_{L}\\,\\big(V(t)-E_{L}\\big)+I(t),\n$$\n初始条件为 $V(0)=E_{L}$。一个恒定的注入电流 $I(t)$ 以两个阶跃的形式施加：第一个阶跃幅度为 $I_{1}=100$ pA，从 $t=0$ 开始；第二个阶跃幅度为 $I_{2}=-60$ pA，从 $t_{2}=10$ ms 开始。假设参数为 $C_{m}=200$ pF，$g_{L}=10$ nS，以及 $E_{L}=-70$ mV。\n\n从膜方程和该线性系统的线性叠加原理出发，推导 $V(t)$ 在所有 $t\\geq 0$ 时的解析表达式。然后计算 $V(t)$ 在 $t\\geq 0$ 上的最大值。将最终数值答案四舍五入到四位有效数字，并以 mV 表示。最后，根据您推导的表达式，通过推理判断 $V(t)$ 是否曾超过 $-65$ mV（不要使用绘图；请进行解析证明）。", "solution": "### 步骤 1：提取已知条件\n- **模型方程**：$C_{m}\\,\\frac{dV}{dt}=-g_{L}\\,\\big(V(t)-E_{L}\\big)+I(t)$\n- **初始条件**：$V(0)=E_{L}$\n- **模型参数**：\n  - 膜电容, $C_{m}=200$ pF\n  - 漏电导, $g_{L}=10$ nS\n  - 漏泄反转电位, $E_{L}=-70$ mV\n- **输入电流**：$I(t)$ 是两个阶跃函数的和：\n  - 第一个阶跃：幅度 $I_{1}=100$ pA，从 $t=0$ 开始。\n  - 第二个阶跃：幅度 $I_{2}=-60$ pA，从 $t_{2}=10$ ms 开始。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了一个单室被动神经元，这是计算神经科学中的一个标准基本模型（RC 电路）。其控制方程是一个一阶线性常微分方程，正确地模拟了此类电路的物理过程。参数值在符合生理实际的范围内。该问题具有科学合理性。\n2.  **适定性**：该问题是一个适定的一阶线性常微分方程初值问题。对于给定的输入电流，存在唯一、稳定的解。所提出的问题（推导解析表达式、求最大值、评估条件）在数学上是精确的，并且可以从推导出的解中得到答案。\n3.  **客观性**：该问题使用精确、客观的数学和物理术语进行陈述，没有歧义或主观性语言。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解题推导\n\n膜电位 $V(t)$ 的动态由以下一阶线性常微分方程描述：\n$$C_{m}\\,\\frac{dV}{dt}=-g_{L}\\,\\big(V(t)-E_{L}\\big)+I(t)$$\n该方程可以通过定义膜时间常数 $\\tau_{m} = C_{m}/g_{L}$ 和膜电阻 $R_{m} = 1/g_{L}$ 来重写。两边同除以 $g_{L}$：\n$$ \\frac{C_{m}}{g_{L}}\\,\\frac{dV}{dt} = -(V(t)-E_{L}) + \\frac{1}{g_{L}}I(t) $$\n$$ \\tau_{m}\\,\\frac{dV}{dt} + V(t) = E_{L} + R_{m}I(t) $$\n首先，我们根据给定参数计算 $\\tau_{m}$ 和 $R_{m}$ 的值：\n$C_{m} = 200 \\times 10^{-12} \\text{ F}$\n$g_{L} = 10 \\times 10^{-9} \\text{ S}$\n$R_{m} = \\frac{1}{g_{L}} = \\frac{1}{10 \\times 10^{-9} \\text{ S}} = 10^{8} \\, \\Omega = 100 \\text{ M}\\Omega$\n$\\tau_{m} = \\frac{C_{m}}{g_{L}} = \\frac{200 \\times 10^{-12} \\text{ F}}{10 \\times 10^{-9} \\text{ S}} = 20 \\times 10^{-3} \\text{ s} = 20 \\text{ ms}$\n\n输入电流 $I(t)$ 由两个阶跃函数组成。使用赫维赛德阶跃函数 $u(\\cdot)$，我们可以将 $I(t)$ 写为：\n$$ I(t) = I_{1} u(t) + I_{2} u(t-t_{2}) $$\n其中 $I_{1} = 100 \\text{ pA}$，$I_{2} = -60 \\text{ pA}$，以及 $t_{2} = 10 \\text{ ms}$。\n\n该系统是线性的，因此叠加原理适用。总解 $V(t)$ 是对初始条件的响应和对每个电流阶跃的响应之和。初始条件为 $V(0) = E_{L}$。\n系统从静息状态 $V(0)=E_{L}$ 开始，对在时间 $t_{s}$ 施加的幅度为 $I_{s}$ 的单个阶跃电流的响应由下式给出：\n$$ \\Delta V_{s}(t) = R_{m} I_{s} \\left(1 - \\exp\\left(-\\frac{t-t_{s}}{\\tau_{m}}\\right)\\right) u(t-t_{s}) $$\n总电压是这些响应与静息电位 $E_{L}$ 之和：\n$$ V(t) = E_{L} + \\Delta V_{1}(t) + \\Delta V_{2}(t) $$\n$$ V(t) = E_{L} + R_{m}I_{1}\\left(1 - \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)\\right)u(t) + R_{m}I_{2}\\left(1 - \\exp\\left(-\\frac{t-t_{2}}{\\tau_{m}}\\right)\\right)u(t-t_{2}) $$\n这就是 $V(t)$ 在 $t \\ge 0$ 上的通用解析表达式。\n\n为了计算，我们求出由电流引起的电压变化：\n$R_{m}I_{1} = (100 \\times 10^{6} \\, \\Omega) \\times (100 \\times 10^{-12} \\text{ A}) = 10^{-2} \\text{ V} = 10 \\text{ mV}$\n$R_{m}I_{2} = (100 \\times 10^{6} \\, \\Omega) \\times (-60 \\times 10^{-12} \\text{ A}) = -6 \\times 10^{-3} \\text{ V} = -6 \\text{ mV}$\n\n我们可以将解写成分段形式：\n对于 $0 \\le t  t_{2}$：\n$$ V(t) = E_{L} + R_{m}I_{1}\\left(1 - \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)\\right) = -70 \\text{ mV} + 10 \\left(1 - \\exp\\left(-\\frac{t}{20 \\text{ ms}}\\right)\\right) \\text{ mV} $$\n对于 $t \\ge t_{2}$：\n$$ V(t) = E_{L} + R_{m}I_{1}\\left(1 - \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)\\right) + R_{m}I_{2}\\left(1 - \\exp\\left(-\\frac{t-t_{2}}{\\tau_{m}}\\right)\\right) $$\n$$ V(t) = -70 \\text{ mV} + 10 \\left(1 - \\exp\\left(-\\frac{t}{20 \\text{ ms}}\\right)\\right) \\text{ mV} - 6 \\left(1 - \\exp\\left(-\\frac{t-10 \\text{ ms}}{20 \\text{ ms}}\\right)\\right) \\text{ mV} $$\n\n接下来，我们求 $V(t)$ 的最大值。我们分析 $V(t)$ 对时间的导数。从原始方程可知：\n$$ \\frac{dV}{dt} = \\frac{1}{C_{m}} \\left( -g_{L}(V(t)-E_{L}) + I(t) \\right) = \\frac{1}{\\tau_{m}} \\left( -(V(t)-E_{L}) + R_{m}I(t) \\right) $$\n或者，我们可以对我们的分段解进行微分。\n1.  对于 $0  t  t_{2}$：\n    $I(t) = I_{1} = 100 \\text{ pA} > 0$。电位 $V(t)$ 从 $V(0)=E_L=-70$ mV 增加，趋向于稳态值 $V_{\\infty,1} = E_{L} + R_{m}I_{1} = -70 + 10 = -60$ mV。由于区间在 $t_2=10$ ms 结束，该时间小于 $\\infty$，因此 $V(t)$ 在 $[0, t_2)$ 上是严格递增的。\n    其导数为 $\\frac{dV}{dt} = \\frac{R_{m}I_{1}}{\\tau_{m}}\\exp\\left(-\\frac{t}{\\tau_{m}}\\right) = \\frac{10 \\text{ mV}}{20 \\text{ ms}}\\exp\\left(-\\frac{t}{20}\\right) > 0$。\n\n2.  对于 $t > t_{2}$：\n    总电流是 $I(t) = I_{1} + I_{2} = 100 - 60 = 40 \\text{ pA} > 0$。系统将趋向于一个新的稳态值 $V_{\\infty,2} = E_{L} + R_{m}(I_{1}+I_{2}) = -70 + R_m(40 \\text{ pA}) = -70 + 4 = -66$ mV。\n    让我们通过对解析解进行微分来分析 $t > t_{2}$ 时的导数：\n    $$ \\frac{dV}{dt} = \\frac{d}{dt} \\left[ E_{L} + R_{m}I_{1} - R_{m}I_{1}e^{-t/\\tau_{m}} + R_{m}I_{2} - R_{m}I_{2}e^{-(t-t_{2})/\\tau_{m}} \\right] $$\n    $$ \\frac{dV}{dt} = \\frac{R_{m}I_{1}}{\\tau_{m}}e^{-t/\\tau_{m}} + \\frac{R_{m}I_{2}}{\\tau_{m}}e^{-(t-t_{2})/\\tau_{m}} = \\frac{e^{-t/\\tau_{m}}}{\\tau_{m}} \\left( R_{m}I_{1} + R_{m}I_{2} e^{t_{2}/\\tau_{m}} \\right) $$\n    导数的符号由括号中的项决定：\n    $$ R_{m}I_{1} + R_{m}I_{2} e^{t_{2}/\\tau_{m}} = 10 \\text{ mV} + (-6 \\text{ mV}) \\exp\\left(\\frac{10}{20}\\right) = 10 - 6\\sqrt{e} \\text{ mV} $$\n    使用近似值 $\\sqrt{e} \\approx 1.6487$，我们得到 $10 - 6 \\times 1.6487 = 10 - 9.8922 = 0.1078 > 0$。\n    由于当 $t > t_2$ 时导数也为正，函数 $V(t)$ 在 $t > t_2$ 时继续增加。\n\n函数 $V(t)$ 是连续的，并且其导数在所有 $t>0$ 时都为正（除了在 $t=t_2$ 处，导数不连续，但在两侧都为正）。因此，$V(t)$ 是在所有 $t \\ge 0$ 上的严格单调递增函数。最大值是函数的上确界，即当 $t \\to \\infty$ 时的极限：\n$$ V_{max} = \\lim_{t\\to\\infty} V(t) = \\lim_{t\\to\\infty} \\left[ E_{L} + R_{m}I_{1}\\left(1 - e^{-t/\\tau_{m}}\\right) + R_{m}I_{2}\\left(1 - e^{-(t-t_{2})/\\tau_{m}}\\right) \\right] $$\n$$ V_{max} = E_{L} + R_{m}I_{1} + R_{m}I_{2} = E_{L} + R_{m}(I_{1}+I_{2}) $$\n$$ V_{max} = -70 \\text{ mV} + R_{m}(40 \\text{ pA}) = -70 \\text{ mV} + 4 \\text{ mV} = -66 \\text{ mV} $$\n四舍五入到四位有效数字，最大值为 $-66.00$ mV。\n\n最后，我们判断 $V(t)$ 是否曾超过 $-65$ mV。\n我们已经确定 $V(t)$ 是在所有 $t \\ge 0$ 上的严格递增函数。它从 $V(0) = -70$ mV 开始，并随着 $t \\to \\infty$ 趋近其上确界 $V_{sup} = -66$ mV。这意味着对于任何有限时间 $t$，电压 $V(t)$ 严格小于 $-66$ mV。\n在数学上，$V(t)  -66$ mV 对于所有 $t \\in [0, \\infty)$ 都成立。\n问题是 $V(t) > -65$ mV 是否可能。\n因为 $-65 > -66$，并且我们知道对于所有的 $t$，$V(t)  -66$ mV，所以 $V(t)$ 不可能超过 $-65$ mV。\n\n最终答案是：\n1.  $V(t)$ 的最大值是 $-66.00$ mV。\n2.  不，$V(t)$ 永远不会超过 $-65$ mV。理由是 $V(t)$ 是一个严格递增的函数，其上确界为 $-66$ mV，所以它总是小于 $-66$ mV，因此也总是小于 $-65$ mV。", "answer": "$$\\boxed{-66.00}$$", "id": "5061374"}, {"introduction": "在被动模型的基础上，我们可以通过增加一个“发放”机制来模拟神经元的动作电位。漏泄整合-发放（LIF）模型是研究神经元如何将连续的输入电流转换为离散的脉冲序列的经典模型。这个练习 [@problem_id:5061370] 旨在探索神经元基本的输入-输出关系，即频率-电流（$f-I$）曲线，并分析复位电压等内在参数如何塑造其“增益”，从而影响信息处理。", "problem": "考虑一个由漏泄整合发放（Leaky Integrate-and-Fire, LIF）动力学模型描述的单个神经元。其膜电位 $V(t)$ 根据被动膜方程演化\n$$C \\frac{dV}{dt} = -g_L \\left(V - V_{\\text{rest}}\\right) + I,$$\n其中 $C$ 是膜电容，$g_L$ 是漏电导，$V_{\\text{rest}}$ 是静息电位，$I$ 是恒定输入电流。定义膜时间常数 $\\tau_m = \\frac{C}{g_L}$ 和膜电阻 $R = \\frac{1}{g_L}$。当膜电位达到尖峰阈值 $V_{\\text{th}}$ 时，神经元会发放一个尖峰，其电位瞬时重置为 $V_r$，并在绝对不应期 $\\tau_{\\text{ref}}$ 内保持静默。\n\n在恒定电流 $I$ 的驱动下，发放率 $f(I)$ 定义为尖峰间隔时间的倒数，该间隔时间包括膜电位从 $V_r$ 演化到 $V_{\\text{th}}$ 所需的时间以及绝对不应期。仅使用上述定义和被动膜方程的解，推导在固定电流 $I_0$ 下频率-电流（$f$–$I$）关系的斜率 $\\frac{df}{dI}$ 的表达式，并在保持所有其他参数不变的情况下，对两个不同的重置电位 $V_r$ 计算该斜率的值。\n\n使用以下参数值：\n- $V_{\\text{rest}} = -65\\,\\mathrm{mV}$,\n- $V_{\\text{th}} = -50\\,\\mathrm{mV}$,\n- $V_r^{(1)} = -65\\,\\mathrm{mV}$,\n- $V_r^{(2)} = -60\\,\\mathrm{mV}$,\n- $\\tau_m = 20\\,\\mathrm{ms}$,\n- $\\tau_{\\text{ref}} = 2\\,\\mathrm{ms}$,\n- $R = 100\\,\\mathrm{M}\\Omega$,\n- $I_0 = 0.300\\,\\mathrm{nA}$.\n\n计算在 $I_0$ 处，对应 $V_r^{(1)}$ 和 $V_r^{(2)}$ 的 $\\frac{df}{dI}$ 值，计算中所有物理量需统一转换为伏特、秒、欧姆和安培。以 $\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$ 为单位报告你的两个数值答案，并将每个答案四舍五入到四位有效数字。你的最终答案必须仅包含这两个值，并以单行矩阵的形式呈现，顺序为 $\\left[\\frac{df}{dI}\\big|_{V_r^{(1)}},\\ \\frac{df}{dI}\\big|_{V_r^{(2)}}\\right]$。", "solution": "首先根据要求验证问题陈述。\n\n### 步骤1：提取已知条件\n- **模型：** 漏泄整合发放（LIF）神经元。\n- **控制方程：** $C \\frac{dV}{dt} = -g_L \\left(V - V_{\\text{rest}}\\right) + I$。\n- **参数定义：** $\\tau_m = \\frac{C}{g_L}$, $R = \\frac{1}{g_L}$。\n- **动力学：** 当 $V(t)$ 达到 $V_{\\text{th}}$ 时发放一个尖峰。然后电位重置为 $V_r$ 并在绝对不应期 $\\tau_{\\text{ref}}$ 内保持不变。\n- **发放率定义：** $f(I) = \\frac{1}{T_{ISI}}$，其中 $T_{ISI}$ 是从 $V_r$ 充电到 $V_{\\text{th}}$ 所需时间与不应期 $\\tau_{\\text{ref}}$ 之和。\n- **任务：** 推导并计算在 $I_0$ 处，对应两个重置电位 $V_r^{(1)}$ 和 $V_r^{(2)}$ 的斜率 $\\frac{df}{dI}$。\n- **参数值：**\n  - $V_{\\text{rest}} = -65\\,\\mathrm{mV}$\n  - $V_{\\text{th}} = -50\\,\\mathrm{mV}$\n  - $V_r^{(1)} = -65\\,\\mathrm{mV}$\n  - $V_r^{(2)} = -60\\,\\mathrm{mV}$\n  - $\\tau_m = 20\\,\\mathrm{ms}$\n  - $\\tau_{\\text{ref}} = 2\\,\\mathrm{ms}$\n  - $R = 100\\,\\mathrm{M}\\Omega$\n  - $I_0 = 0.300\\,\\mathrm{nA}$\n- **输出要求：** 两个 $\\frac{df}{dI}$ 的数值答案，单位为 $\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$，四舍五入到四位有效数字，以行矩阵形式呈现。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础：** 该问题使用标准的漏泄整合发放模型，这是计算神经科学的基石。其底层物理是RC电路，这是一个基本概念。所有定义在该领域都是标准的。该问题在科学上是合理的。\n- **良态问题：** 推导频率-电流关系及其导数所需的所有参数和条件都已提供。需要检查发放条件：为了使神经元发放，稳态电压 $V_{\\infty} = V_{\\text{rest}} + RI$ 必须超过阈值 $V_{\\text{th}}$。使用给定值，$RI_0 = (100 \\times 10^6\\,\\mathrm{\\Omega})(0.300 \\times 10^{-9}\\,\\mathrm{A}) = 0.030\\,\\mathrm{V} = 30\\,\\mathrm{mV}$。因此，$V_{\\infty}(I_0) = -65\\,\\mathrm{mV} + 30\\,\\mathrm{mV} = -35\\,\\mathrm{mV}$。由于 $V_{\\infty}(I_0) = -35\\,\\mathrm{mV}  V_{\\text{th}} = -50\\,\\mathrm{mV}$，神经元将会发放。该问题是一致且适定的（well-posed）。\n- **客观性：** 问题以精确、定量的术语陈述，没有任何主观或模棱两可的语言。\n\n### 步骤3：结论与行动\n问题在科学上是合理的，自洽的，且是良态的。判定为 **有效**。将继续进行求解。\n\n**发放率 $f(I)$ 的推导**\n\n膜电位 $V(t)$ 的演化由下式给出：\n$$C \\frac{dV}{dt} = -g_L (V - V_{\\text{rest}}) + I$$\n使用定义 $\\tau_m = \\frac{C}{g_L}$ 和 $R = \\frac{1}{g_L}$，我们可以重写该方程。两边乘以 $R$：\n$$\\tau_m \\frac{dV}{dt} = -(V - V_{\\text{rest}}) + RI$$\n我们定义恒定电流 $I$ 下的稳态电压为 $V_{\\infty}(I) = V_{\\text{rest}} + RI$。方程变为：\n$$\\tau_m \\frac{dV}{dt} = - (V - V_{\\infty}(I))$$\n这是一个一阶线性常微分方程。对于初始条件 $V(t=0) = V_0$，其解为：\n$$V(t) = V_{\\infty}(I) + (V_0 - V_{\\infty}(I)) \\exp\\left(-\\frac{t}{\\tau_m}\\right)$$\n为了求得电位从重置值 $V_r$ 上升到阈值 $V_{\\text{th}}$ 所需的时间 $T_{\\text{charge}}$，我们设置 $V(0) = V_r$ 并求解当 $V(T_{\\text{charge}}) = V_{\\text{th}}$ 时的时间 $t = T_{\\text{charge}}$：\n$$V_{\\text{th}} = V_{\\infty}(I) + (V_r - V_{\\infty}(I)) \\exp\\left(-\\frac{T_{\\text{charge}}}{\\tau_m}\\right)$$\n求解 $T_{\\text{charge}}$：\n$$\\exp\\left(-\\frac{T_{\\text{charge}}}{\\tau_m}\\right) = \\frac{V_{\\text{th}} - V_{\\infty}(I)}{V_r - V_{\\infty}(I)}$$\n$$T_{\\text{charge}}(I) = -\\tau_m \\ln\\left(\\frac{V_{\\text{th}} - V_{\\infty}(I)}{V_r - V_{\\infty}(I)}\\right) = \\tau_m \\ln\\left(\\frac{V_r - V_{\\infty}(I)}{V_{\\text{th}} - V_{\\infty}(I)}\\right)$$\n为使神经元发放，必须有 $V_{\\infty}(I)  V_{\\text{th}}$，这确保了对数的参数为正且大于1（因为 $V_r \\le V_{\\text{th}}$）。总的尖峰间隔时间 $T_{ISI}$ 是 $T_{\\text{charge}}$ 与绝对不应期 $\\tau_{\\text{ref}}$ 之和：\n$$T_{ISI}(I) = \\tau_{\\text{ref}} + \\tau_m \\ln\\left(\\frac{V_r - V_{\\text{rest}} - RI}{V_{\\text{th}} - V_{\\text{rest}} - RI}\\right)$$\n发放率 $f(I)$ 是尖峰间隔时间的倒数：\n$$f(I) = \\left[ \\tau_{\\text{ref}} + \\tau_m \\ln\\left(\\frac{V_r - V_{\\text{rest}} - RI}{V_{\\text{th}} - V_{\\text{rest}} - RI}\\right) \\right]^{-1}$$\n\n**斜率 $\\frac{df}{dI}$ 的推导**\n\n为求得频率-电流关系的斜率，我们将 $f(I)$ 对 $I$ 求导。使用链式法则，$\\frac{df}{dI} = \\frac{d}{dI} [T_{ISI}(I)]^{-1}$：\n$$\\frac{df}{dI} = -[T_{ISI}(I)]^{-2} \\frac{dT_{ISI}}{dI} = -f(I)^2 \\frac{dT_{ISI}}{dI}$$\n我们计算 $T_{ISI}(I)$ 的导数：\n$$\\frac{dT_{ISI}}{dI} = \\frac{d}{dI} \\left[ \\tau_{\\text{ref}} + \\tau_m \\left( \\ln(V_r - V_{\\text{rest}} - RI) - \\ln(V_{\\text{th}} - V_{\\text{rest}} - RI) \\right) \\right]$$\n$$\\frac{dT_{ISI}}{dI} = \\tau_m \\left[ \\frac{1}{V_r - V_{\\text{rest}} - RI} \\cdot (-R) - \\frac{1}{V_{\\text{th}} - V_{\\text{rest}} - RI} \\cdot (-R) \\right]$$\n$$\\frac{dT_{ISI}}{dI} = -R\\tau_m \\left[ \\frac{1}{V_r - V_{\\text{rest}} - RI} - \\frac{1}{V_{\\text{th}} - V_{\\text{rest}} - RI} \\right]$$\n合并同类项：\n$$\\frac{dT_{ISI}}{dI} = -R\\tau_m \\frac{(V_{\\text{th}} - V_{\\text{rest}} - RI) - (V_r - V_{\\text{rest}} - RI)}{(V_r - V_{\\text{rest}} - RI)(V_{\\text{th}} - V_{\\text{rest}} - RI)} = - R\\tau_m \\frac{V_{\\text{th}} - V_r}{(V_r - V_{\\infty}(I))(V_{\\text{th}} - V_{\\infty}(I))}$$\n将此结果代回 $\\frac{df}{dI}$ 的表达式中：\n$$\\frac{df}{dI} = -f(I)^2 \\left( - R\\tau_m \\frac{V_{\\text{th}} - V_r}{(V_r - V_{\\infty}(I))(V_{\\text{th}} - V_{\\infty}(I))} \\right)$$\n$$\\frac{df}{dI} = f(I)^2 \\frac{R\\tau_m(V_{\\text{th}} - V_r)}{(V_r - V_{\\infty}(I))(V_{\\text{th}} - V_{\\infty}(I))}$$\n\n**数值计算**\n\n首先，将所有参数转换为国际单位制（SI）基本单位：\n- $V_{\\text{rest}} = -0.065\\,\\mathrm{V}$\n- $V_{\\text{th}} = -0.050\\,\\mathrm{V}$\n- $V_r^{(1)} = -0.065\\,\\mathrm{V}$\n- $V_r^{(2)} = -0.060\\,\\mathrm{V}$\n- $\\tau_m = 0.020\\,\\mathrm{s}$\n- $\\tau_{\\text{ref}} = 0.002\\,\\mathrm{s}$\n- $R = 1.00 \\times 10^8\\,\\mathrm{\\Omega}$\n- $I_0 = 0.300 \\times 10^{-9}\\,\\mathrm{A}$\n\n计算在 $I = I_0$ 时的公共中间量：\n- $RI_0 = (1.00 \\times 10^8\\,\\mathrm{\\Omega})(0.300 \\times 10^{-9}\\,\\mathrm{A}) = 0.030\\,\\mathrm{V}$\n- $V_{\\infty}(I_0) = V_{\\text{rest}} + RI_0 = -0.065\\,\\mathrm{V} + 0.030\\,\\mathrm{V} = -0.035\\,\\mathrm{V}$\n\n**情况1：重置电位 $V_r^{(1)} = -0.065\\,\\mathrm{V}$**\n这是 $V_r = V_{\\text{rest}}$ 的特殊情况。\n- $T_{\\text{charge}}^{(1)}(I_0) = \\tau_m \\ln\\left(\\frac{V_r^{(1)} - V_{\\infty}(I_0)}{V_{\\text{th}} - V_{\\infty}(I_0)}\\right) = 0.020 \\ln\\left(\\frac{-0.065 - (-0.035)}{-0.050 - (-0.035)}\\right) = 0.020 \\ln\\left(\\frac{-0.030}{-0.015}\\right) = 0.020 \\ln(2) \\approx 0.013863\\,\\mathrm{s}$。\n- $T_{ISI}^{(1)}(I_0) = \\tau_{\\text{ref}} + T_{\\text{charge}}^{(1)}(I_0) = 0.002\\,\\mathrm{s} + 0.013863\\,\\mathrm{s} = 0.015863\\,\\mathrm{s}$。\n- $f^{(1)}(I_0) = \\frac{1}{T_{ISI}^{(1)}(I_0)} = \\frac{1}{0.015863} \\approx 63.040\\,\\mathrm{s}^{-1}$。\n- 现在，我们计算在 $I_0$ 处的 $\\frac{df}{dI}$。我们可以使用 $\\frac{dT_{ISI}}{dI}$ 的表达式来简化计算。\n- $\\frac{dT_{ISI}^{(1)}}{dI}\\bigg|_{I_0} = -R\\tau_m \\left[ \\frac{1}{V_r^{(1)} - V_{\\infty}(I_0)} - \\frac{1}{V_{\\text{th}} - V_{\\infty}(I_0)} \\right]$\n- $R\\tau_m = (10^8\\,\\Omega)(0.020\\,\\mathrm{s}) = 2.0 \\times 10^6\\,\\Omega\\cdot\\mathrm{s}$。\n- $\\frac{dT_{ISI}^{(1)}}{dI}\\bigg|_{I_0} = -(2.0 \\times 10^6) \\left[ \\frac{1}{-0.030\\,\\mathrm{V}} - \\frac{1}{-0.015\\,\\mathrm{V}} \\right] = -(2.0 \\times 10^6) \\left[ -\\frac{100}{3} + \\frac{200}{3} \\right] = -(2.0 \\times 10^6) \\left[ \\frac{100}{3} \\right] = -\\frac{2}{3} \\times 10^8\\,\\mathrm{s/A}$。\n- $\\frac{df^{(1)}}{dI}\\bigg|_{I_0} = -f^{(1)}(I_0)^2 \\frac{dT_{ISI}^{(1)}}{dI}\\bigg|_{I_0} = -(63.040)^2 \\left( -\\frac{2}{3} \\times 10^8 \\right) \\approx (3974.0) \\left( \\frac{2}{3} \\times 10^8 \\right) \\approx 2.6493 \\times 10^{11}\\,\\mathrm{s}^{-1}/\\mathrm{A}$。\n- 为转换为 $\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$，我们乘以 $1\\,\\mathrm{A} / 10^9\\,\\mathrm{nA}$：\n- $\\frac{df^{(1)}}{dI}\\bigg|_{I_0} \\approx 2.6493 \\times 10^{11} \\times 10^{-9} = 264.93\\,\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$。\n- 四舍五入到四位有效数字，结果为 $264.9\\,\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$。\n\n**情况2：重置电位 $V_r^{(2)} = -0.060\\,\\mathrm{V}$**\n- $T_{\\text{charge}}^{(2)}(I_0) = \\tau_m \\ln\\left(\\frac{V_r^{(2)} - V_{\\infty}(I_0)}{V_{\\text{th}} - V_{\\infty}(I_0)}\\right) = 0.020 \\ln\\left(\\frac{-0.060 - (-0.035)}{-0.050 - (-0.035)}\\right) = 0.020 \\ln\\left(\\frac{-0.025}{-0.015}\\right) = 0.020 \\ln(\\frac{5}{3}) \\approx 0.010217\\,\\mathrm{s}$。\n- $T_{ISI}^{(2)}(I_0) = \\tau_{\\text{ref}} + T_{\\text{charge}}^{(2)}(I_0) = 0.002\\,\\mathrm{s} + 0.010217\\,\\mathrm{s} = 0.012217\\,\\mathrm{s}$。\n- $f^{(2)}(I_0) = \\frac{1}{T_{ISI}^{(2)}(I_0)} = \\frac{1}{0.012217} \\approx 81.855\\,\\mathrm{s}^{-1}$。\n- 计算在 $I_0$ 处的 $\\frac{dT_{ISI}^{(2)}}{dI}$：\n- $\\frac{dT_{ISI}^{(2)}}{dI}\\bigg|_{I_0} = -R\\tau_m \\left[ \\frac{1}{V_r^{(2)} - V_{\\infty}(I_0)} - \\frac{1}{V_{\\text{th}} - V_{\\infty}(I_0)} \\right]$\n- $\\frac{dT_{ISI}^{(2)}}{dI}\\bigg|_{I_0} = -(2.0 \\times 10^6) \\left[ \\frac{1}{-0.025\\,\\mathrm{V}} - \\frac{1}{-0.015\\,\\mathrm{V}} \\right] = -(2.0 \\times 10^6) \\left[ -40 + \\frac{200}{3} \\right] = -(2.0 \\times 10^6) \\left[ \\frac{-120 + 200}{3} \\right] = -(2.0 \\times 10^6) \\left[ \\frac{80}{3} \\right] = -\\frac{1.6}{3} \\times 10^8\\,\\mathrm{s/A}$。\n- $\\frac{df^{(2)}}{dI}\\bigg|_{I_0} = -f^{(2)}(I_0)^2 \\frac{dT_{ISI}^{(2)}}{dI}\\bigg|_{I_0} = -(81.8554)^2 \\left( -\\frac{1.6}{3} \\times 10^8 \\right) \\approx (6700.31) \\left( \\frac{1.6}{3} \\times 10^8 \\right) \\approx 3.5735 \\times 10^{11}\\,\\mathrm{s}^{-1}/\\mathrm{A}$。\n- 转换为 $\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$：\n- $\\frac{df^{(2)}}{dI}\\bigg|_{I_0} \\approx 3.5735 \\times 10^{11} \\times 10^{-9} = 357.35\\,\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$。\n- 四舍五入到四位有效数字，结果为 $357.4\\,\\mathrm{s}^{-1}\\,\\mathrm{nA}^{-1}$。\n\n两个结果是 $264.9$ 和 $357.4$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n264.9  357.4\n\\end{pmatrix}\n}\n$$", "id": "5061370"}, {"introduction": "掌握了单个神经元的动力学后，我们将注意力转向神经元之间的连接。赫布可塑性（Hebbian plasticity）是神经科学中关于学习和记忆的基石，其核心思想是“共同发放的细胞连接在一起”。这个练习 [@problem_id:5061354] 将引导你把这一概念性规则转化为精确的数学方程，并亲手计算一个神经元如何通过赫布规则从其输入中学习统计特征。", "problem": "考虑一个单一线性神经元，其输出 $y$ 由 $y = w^{\\top} x$ 定义，其中 $w \\in \\mathbb{R}^{2}$ 是突触权重向量，$x \\in \\mathbb{R}^{2}$ 是输入向量。假设输入 $x$ 来自一个零均值分布，其协方差矩阵为 $\\Sigma \\in \\mathbb{R}^{2 \\times 2}$。根据赫布可塑性原理，当突触前活动和突触后活动同时发生时，突触会得到加强。利用这一原理以及零均值随机向量的期望性质，推导出期望的突触更新（用 $\\Sigma$ 和 $w$ 表示）。\n\n现在，不精确计算期望，而是通过模拟单一样本的赫布更新来近似一个期望更新步骤。使用当前权重 $w = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$、样本输入 $x = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}$ 和学习率 $\\eta = 0.01$。使用 $y = w^{\\top} x$ 计算模拟的更新 $\\Delta w$。\n\n请将您最终的模拟更新数值答案以一个双元素行矩阵的形式给出。无需四舍五入。", "solution": "首先验证问题，以确保其具有科学依据、是良态的且客观。\n\n### 第 1 步：提取已知条件\n- 神经元输出：$y = w^{\\top} x$\n- 突触权重向量：$w \\in \\mathbb{R}^{2}$\n- 输入向量：$x \\in \\mathbb{R}^{2}$\n- 输入分布特征：零均值 ($E[x] = 0$)，协方差矩阵 $\\Sigma \\in \\mathbb{R}^{2 \\times 2}$\n- 学习原理：赫布可塑性，即当突触前 ($x$) 和突触后 ($y$) 活动共同发生时，突触得到加强。\n- 任务 1：推导期望的突触更新 $E[\\Delta w]$，用 $\\Sigma$ 和 $w$ 表示。\n- 任务 2：使用以下特定值，模拟一次单样本赫布更新 $\\Delta w$：\n  - 当前权重：$w = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$\n  - 样本输入：$x = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}$\n  - 学习率：$\\eta = 0.01$\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题进行有效性审查。\n- **科学性**：问题描述了一个单一线性神经元和一个赫布学习法则，这些是计算神经科学和机器学习中的基本和标准概念。使用期望和协方差矩阵是对此类模型的标准数学处理方法。该问题根植于已建立的理论。\n- **良态性**：该问题是良态的。它首先要求进行一般性推导，然后进行具体的数值计算。两部分所需的所有信息都已提供。推导有明确的目标，数值部分拥有计算唯一解所需的所有值（$w$、$x$、$\\eta$）。\n- **客观性**：问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n- **完整性与一致性**：问题是自洽的。突触前 ($x$) 和突触后 ($y$) 活动共现的赫布原理在数学上被形式化为一个更新规则，其中权重的变化 $\\Delta w$ 与 $y$ 和 $x$ 的乘积成正比，即 $\\Delta w = \\eta y x$。这是一种标准而直接的形式化方法。所有向量和矩阵的维度都是一致的。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。这是一个神经网络理论中的标准练习。可以继续进行求解。\n\n### 解题推导\n\n该问题包括两部分。第一部分是期望突触更新的一般性推导，第二部分是单次更新步骤的具体数值计算。\n\n**第 1 部分：期望突触更新的推导**\n\n赫布可塑性原理指出，突触权重的变化与突触前和突触后活动之间的相关性成正比。突触前活动是输入向量 $x$，突触后活动是神经元的标量输出 $y$。该原理通过赫布学习法则进行数学表达：\n$$\n\\Delta w = \\eta y x\n$$\n其中 $\\eta$ 是学习率，一个正常量。\n\n神经元的输出是输入的线性函数：\n$$\ny = w^{\\top} x\n$$\n将 $y$ 的表达式代入学习法则，可以得到 $\\Delta w$ 关于输入 $x$ 和当前权重向量 $w$ 的更新式：\n$$\n\\Delta w = \\eta (w^{\\top} x) x\n$$\n由于 $w^{\\top} x$ 是一个标量，我们可以利用矩阵性质重写此表达式。注意，对于向量 $x$ 和可适配的向量 $w$，$x (w^{\\top} x) = (x x^{\\top}) w$。因此，更新法则可以写成：\n$$\n\\Delta w = \\eta (x x^{\\top}) w\n$$\n问题要求的是期望的突触更新，即 $E[\\Delta w]$。我们对该表达式关于输入向量 $x$ 的分布取期望。在计算给定状态的期望时，权重向量 $w$ 和学习率 $\\eta$ 被视为常数。\n$$\nE[\\Delta w] = E[\\eta (x x^{\\top}) w]\n$$\n利用期望算子的线性性质，我们可以写出：\n$$\nE[\\Delta w] = \\eta E[x x^{\\top}] w\n$$\n随机向量 $x$ 的协方差矩阵 $\\Sigma$ 定义为 $\\Sigma = E[(x - E[x])(x - E[x])^{\\top}]$。问题陈述中指出，输入 $x$ 来自一个零均值分布，这意味着 $E[x] = 0$。在这种特殊情况下，协方差矩阵简化为：\n$$\n\\Sigma = E[(x - 0)(x - 0)^{\\top}] = E[x x^{\\top}]\n$$\n将此结果代回期望更新的表达式中，得到问题第一部分的最终结果：\n$$\nE[\\Delta w] = \\eta \\Sigma w\n$$\n这个结果表明，平均而言，权重向量 $w$ 的变化方向是由输入协方差矩阵 $\\Sigma$ 对 $w$ 的作用决定的。这是 Oja 法则的核心，它是赫布学习的一种归一化版本，该法则能使权重向量收敛到协方差矩阵的主特征向量。\n\n**第 2 部分：单一样本更新的数值模拟**\n\n问题的第二部分要求计算单一样本的更新 $\\Delta w$，这可作为期望更新的单一样本（随机）近似。使用的公式是在取任何期望之前的基本更新法则 $\\Delta w = \\eta y x$。\n\n我们给定的值如下：\n- 学习率：$\\eta = 0.01$\n- 当前权重向量：$w = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$\n- 样本输入向量：$x = \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}$\n\n首先，我们根据给定的 $w$ 和 $x$ 计算突触后活动 $y$：\n$$\ny = w^{\\top} x = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = (1)(2) + (0)(1) = 2\n$$\n现在，我们使用计算出的 $y$ 来计算突触更新向量 $\\Delta w$：\n$$\n\\Delta w = \\eta y x = (0.01)(2) \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\Delta w = 0.02 \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.02 \\times 2 \\\\ 0.02 \\times 1 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.02 \\end{pmatrix}\n$$\n模拟的更新是 $\\Delta w = \\begin{pmatrix} 0.04 \\\\ 0.02 \\end{pmatrix}$。问题要求最终答案以一个双元素行矩阵的形式给出。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.04  0.02 \\end{pmatrix}}\n$$", "id": "5061354"}]}