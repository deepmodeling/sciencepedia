{"hands_on_practices": [{"introduction": "在神经发育过程中，突触的总数会经历一个动态的增减过程。我们可以通过一个简洁的数学模型来描绘这一宏观景象，将突触的生成视为“出生”过程，将剪裁视为“死亡”过程。这个练习将引导你推导出一个描述突触密度随时间变化的方程，并理解系统如何达到一个稳定的平衡状态，即突触的生成速率与消除速率相匹配。[@problem_id:5067629]", "problem": "考虑一个均质的神经毡体积，其中突触在发育过程中因突触生成和剪枝而分别形成和消除。设期望突触密度由 $S(t)$ 表示，其度量为在时间 $t$ 时单位体积内的期望突触数量。假设突触的诞生是以恒定的突触生成率 $\\beta$（单位体积单位时间内）发生的独立事件，而突触的剪枝是以瞬时剪枝风险 $h(t)=\\lambda$（单位突触单位时间内）为特征的独立的无记忆事件，其中 $\\beta \\ge 0$ 且 $\\lambda \\ge 0$。根据定义，风险 $h(t)$ 给出单个突触在时间间隔 $\\mathrm{d}t$ 内被消除的单位时间的瞬时概率。\n\n从 (i) 恒定的诞生率和 (ii) 恒定的消除风险（无记忆剪枝）的基本含义出发，推导在给定初始密度 $S(0)$ 的情况下，期望突触密度 $S(t)$ 的闭式轨迹。然后，确定在何种参数 $\\beta$ 和 $\\lambda$ 的条件下 $S(t)$ 会在 $t \\to \\infty$ 时趋近于一个稳态，并确定该稳态值（如果存在）。\n\n你的最终答案必须是 $S(t)$ 的单一解析表达式。最终表达式中不要包含单位。无需进行数值四舍五入。", "solution": "对问题陈述进行有效性评估。\n\n### 步骤 1：提取已知条件\n- $S(t)$：时间 $t$ 时的期望突触密度。\n- $\\beta$：一个恒定的突触生成率，单位为“突触/单位体积/单位时间”。$\\beta \\ge 0$。\n- $h(t) = \\lambda$：一个恒定的瞬时剪枝风险，单位为“/突触/单位时间”。$\\lambda \\ge 0$。\n- $S(0)$：$t=0$ 时的初始突触密度。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n- **科学依据：** 该问题描述了一个经典的生灭过程，这是统计物理学、种群动力学和系统生物学中一个基本且广泛使用的数学模型。它在突触动力学中的应用是理论神经科学中一个标准且科学上合理的方法，用于模拟突触形成和消除之间的平衡。恒定诞生率（泊松过程）和恒定消除风险（意味着无记忆的指数等待时间）的概念在数学上是严谨且成熟的。\n- **适定性：** 该问题在数学上是适定的。它提供了两个非负常数参数 $\\beta$ 和 $\\lambda$，以及一个初始条件 $S(0)$，这些足以确定系统期望状态 $S(t)$ 演化的唯一解。推导轨迹 $S(t)$ 并分析其稳态行为的目标是明确且可实现的。\n- **客观性：** 语言正式、精确且客观。所有术语，如“期望突触密度”、“恒定速率”和“瞬时剪枝风险”，在随机过程理论中都是标准术语，并具有明确的数学解释。\n- **其他缺陷：** 该问题没有列出的缺陷。它在科学上是合理的，可以立即形式化为微分方程，是完整的，在数学建模的背景下是现实的，结构良好，非平凡，且科学上可验证。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n期望突触密度 $S(t)$ 的演化可以用一个微分方程来描述，该方程考虑了突触形成率和突触消除率。我们考虑 $S(t)$ 在一个无穷小时间间隔 $dt$ 内的变化。\n\n突触形成（诞生）的速率被给定为一个常数 $\\beta$，即单位体积单位时间内形成的新突触数量。这对 $S(t)$ 的变化率贡献了 $+\\beta$ 项。\n$$ \\text{Rate of formation} = \\beta $$\n\n突触消除（剪枝）的速率取决于现有突触的数量。瞬时剪枝风险 $\\lambda$ 是单个突触在单位时间内被消除的概率。对于密度为 $S(t)$ 的突触群体，单位体积的总消除率是单位突触速率与突触密度的乘积。这是基于每个突触的剪枝事件是独立的假设。\n$$ \\text{Rate of elimination} = \\lambda S(t) $$\n\n结合这两个过程，期望突触密度的净变化率 $\\frac{dS(t)}{dt}$ 是形成率减去消除率：\n$$ \\frac{dS(t)}{dt} = \\beta - \\lambda S(t) $$\n这是一个具有常系数的一阶线性常微分方程。我们给定的初始条件是 $S(t=0) = S(0)$。\n\n我们求解这个微分方程。首先，考虑 $\\lambda > 0$ 的情况。我们可以将方程重写为标准形式：\n$$ \\frac{dS}{dt} + \\lambda S = \\beta $$\n这个方程可以使用积分因子法求解。积分因子 $I(t)$ 由下式给出：\n$$ I(t) = \\exp\\left(\\int \\lambda \\, dt\\right) = \\exp(\\lambda t) $$\n将整个微分方程乘以 $I(t)$：\n$$ \\exp(\\lambda t) \\frac{dS}{dt} + \\lambda \\exp(\\lambda t) S(t) = \\beta \\exp(\\lambda t) $$\n左边是乘积 $S(t) \\exp(\\lambda t)$ 对 $t$ 的导数：\n$$ \\frac{d}{dt} \\left( S(t) \\exp(\\lambda t) \\right) = \\beta \\exp(\\lambda t) $$\n对两边关于 $t$ 积分：\n$$ \\int \\frac{d}{dt} \\left( S(t) \\exp(\\lambda t) \\right) dt = \\int \\beta \\exp(\\lambda t) dt $$\n$$ S(t) \\exp(\\lambda t) = \\frac{\\beta}{\\lambda} \\exp(\\lambda t) + C $$\n其中 $C$ 是积分常数。为了求出 $S(t)$ 的解，我们除以积分因子 $\\exp(\\lambda t)$：\n$$ S(t) = \\frac{\\beta}{\\lambda} + C \\exp(-\\lambda t) $$\n现在，我们应用初始条件 $S(t=0) = S(0)$ 来确定常数 $C$：\n$$ S(0) = \\frac{\\beta}{\\lambda} + C \\exp(- \\lambda \\cdot 0) = \\frac{\\beta}{\\lambda} + C $$\n求解 $C$：\n$$ C = S(0) - \\frac{\\beta}{\\lambda} $$\n将这个 $C$ 的表达式代回通解，得到期望突触密度的闭式轨迹：\n$$ S(t) = \\frac{\\beta}{\\lambda} + \\left( S(0) - \\frac{\\beta}{\\lambda} \\right) \\exp(-\\lambda t) $$\n这个表达式可以重新整理，以突出来自初始状态和新突触生成的贡献：\n$$ S(t) = S(0) \\exp(-\\lambda t) + \\frac{\\beta}{\\lambda} \\left( 1 - \\exp(-\\lambda t) \\right) $$\n第一项代表初始突触群体的衰减，而第二项代表新突触向稳态水平的累积。\n\n接下来，我们考虑 $\\lambda = 0$ 的特殊情况。微分方程简化为：\n$$ \\frac{dS}{dt} = \\beta $$\n对 $t$ 积分：\n$$ S(t) = \\beta t + C' $$\n使用初始条件 $S(0)$：\n$$ S(0) = \\beta(0) + C' \\implies C' = S(0) $$\n因此，对于 $\\lambda = 0$，解为：\n$$ S(t) = S(0) + \\beta t $$\n这表明如果没有剪枝，突触密度会随时间线性增加（如果 $\\beta = 0$ 则保持不变）。\n\n最后，我们分析当 $t \\to \\infty$ 时达到稳态的条件。稳态 $S_{\\infty}$ 是 $S(t)$ 在时间趋于无穷时的极限。\n$$ S_{\\infty} = \\lim_{t \\to \\infty} S(t) $$\n使用 $\\lambda > 0$ 的解：\n$$ S_{\\infty} = \\lim_{t \\to \\infty} \\left[ \\frac{\\beta}{\\lambda} + \\left( S(0) - \\frac{\\beta}{\\lambda} \\right) \\exp(-\\lambda t) \\right] $$\n要趋近于一个稳态，这个极限必须存在且为有限值。\n如果 $\\lambda > 0$，那么当 $t \\to \\infty$ 时，项 $\\exp(-\\lambda t) \\to 0$。因此，极限存在：\n$$ S_{\\infty} = \\frac{\\beta}{\\lambda} + \\left( S(0) - \\frac{\\beta}{\\lambda} \\right) \\cdot 0 = \\frac{\\beta}{\\lambda} $$\n如果 $\\lambda = 0$ (且 $\\beta > 0$), $S(t) = S(0) + \\beta t$，当 $t \\to \\infty$ 时，它会发散到无穷大。没有达到稳态。\n如果 $\\lambda=0$ 且 $\\beta=0$，则对所有 $t$ 都有 $S(t)=S(0)$，因此系统从一开始就处于永久稳态。\n因此，$S(t)$ 趋近于一个非平凡的、与初始条件 $S(0)$ 无关的稳态的条件是 $\\lambda>0$。该稳态的值是形成率与消除率之比，$S_{\\infty} = \\frac{\\beta}{\\lambda}$。这个值也可以通过在微分方程中设置 $\\frac{dS}{dt}=0$ 直接求得。\n\n问题要求给出 $S(t)$ 的单一解析表达式，这是为一般情况 $\\lambda \\ne 0$ 推导出的解。", "answer": "$$\\boxed{S(t) = \\frac{\\beta}{\\lambda} + \\left( S(0) - \\frac{\\beta}{\\lambda} \\right) \\exp(-\\lambda t)}$$", "id": "5067629"}, {"introduction": "从宏观的突触密度变化转向微观层面，一个核心问题是：是什么决定了哪些突触被保留，哪些被淘汰？“用进废退”原则在这里起着关键作用，而这个练习将通过模拟突触间对有限神经营养因子的竞争来阐释这一原则。通过这个练习，你将看到一个突触的存活不仅取决于其自身的活动水平，还取决于它与竞争对手相比的相对“实力”。[@problem_id:5067605]", "problem": "在神经环路的发育过程中，突触输入的存活可能依赖于神经营养因子（例如脑源性神经营养因子 BDNF）从突触后靶点的逆向递送。考虑一个由 $N$ 个突触前输入组成的群体，它们投射到单个神经元上，索引为 $i=1,\\dots,N$。每个输入都有一个活动水平 $a_i$，该活动水平驱动神经营养因子的结合以及向突触前末梢的逆向运输。假设以下基本依据，这些依据与已有的神经生物学知识一致：\n1. 在稳态下，有一个固定的总逆向神经营养因子量 $R$ 可供分配给所有输入，因此分配给输入 $i$ 的量 $r_i$ 满足守恒定律 $\\sum_{i=1}^{N} r_i = R$。\n2. 在低饱和状态下的受体限制性结合条件下，输入 $i$ 的摄取通量与其活动 $a_i$ 成正比。\n3. 一个突触前输入能存活的充分必要条件是其获得的逆向神经营养因子分配量超过一个阈值 $r_{\\min}$，即存活需要 $r_i > r_{\\min}$；否则，将启动程序性细胞死亡（凋亡）。\n\n仅从上述基本依据出发，推导与守恒和正比摄取相一致的分配规则 $r_i$，并说明存活标准如何意味着相对于整个群体而言，较弱的输入会被淘汰。最后，针对 $N=100$ 个输入（其活动为 $a_i=i$，$i=1,\\dots,100$）、总逆向神经营养因子 $R=1.0$（任意单位）以及阈值 $r_{\\min}=0.008$（任意单位）的具体情况，评估所推导的模型。计算该模型下存活输入的数量。无需四舍五入；将最终答案以单个整数形式报告，不带单位。", "solution": "生物学背景是，逆向神经营养因子（如脑源性神经营养因子BDNF）是有限的，必须在相互竞争的突触输入之间进行分配。在稳态下，可用的总逆向神经营养因子 $R$ 必须在所有输入中保持守恒。如果在低饱和状态下，对输入 $i$ 的摄取与其活动 $a_i$ 成正比，那么输入 $i$ 所获得的份额将由其活动 $a_i$ 在所有输入总活动中的占比决定。\n\n设 $A=\\sum_{j=1}^{N} a_j$ 表示所有输入的总活动。正比假设意味着分配给输入 $i$ 的 $R$ 的分数必须与其贡献的总活动的分数相匹配，即 $\\frac{a_i}{A}$。应用守恒约束 $\\sum_{i=1}^{N} r_i = R$ 可以得出与这两个原则都一致的唯一分配方案：\n$$\nr_i = R \\,\\frac{a_i}{A}.\n$$\n这个规则是直接从质量守恒和摄取与活动的线性正比关系推导出来的。\n\n存活标准是 $r_i > r_{\\min}$。代入分配规则可得\n$$\nR \\,\\frac{a_i}{A} > r_{\\min} \\quad \\Longleftrightarrow \\quad a_i > \\frac{r_{\\min}}{R}\\,A.\n$$\n因此，存活与否取决于其活动 $a_i$ 是否超过一个阈值，该阈值与总活动 $A$ 以及比率 $r_{\\min}/R$ 成比例。因为不等式右侧依赖于汇集了所有竞争者活动的 $A$，该模型预测了相对于群体而言较弱输入会被淘汰：$a_i$ 较小的输入更有可能低于阈值，而较强的输入则会存活。\n\n现在评估这个具体案例。我们有 $N=100$ 且活动为 $a_i=i$，$i=1,\\dots,100$。计算总活动：\n$$\nA = \\sum_{i=1}^{100} i = \\frac{100 \\cdot 101}{2} = 5050.\n$$\n给定 $R=1.0$ 和 $r_{\\min}=0.008$，存活的活动阈值为\n$$\na_{\\text{thr}} = \\frac{r_{\\min}}{R}\\,A = 0.008 \\times 5050 = 40.4.\n$$\n一个输入 $i$ 能存活，如果 $a_i=i > 40.4$。由于 $i$ 是整数，存活的最小索引是 $i=41$。因此，存活的输入是 $i=41,42,\\dots,100$。存活输入的数量是\n$$\n100 - 40 = 60.\n$$\n无需四舍五入；模型预测有 $60$ 个输入存活。", "answer": "$$\\boxed{60}$$", "id": "5067605"}, {"introduction": "理论模型为我们提供了理解突触动力学的框架，但这些模型如何与真实的生物学数据联系起来？这个练习将带你扮演一位实验神经科学家的角色，学习如何分析从双光子显微镜纵向成像实验中获得的（模拟）数据。你将构建一个马尔可夫链模型来量化树突棘的转换——即突触的形成与消除——的概率，从而将抽象的理论概念转化为可测量的实验参数。[@problem_id:5067598]", "problem": "双光子激光扫描显微镜（一种双光子激发技术，能够以较小的光损伤进行深层组织成像）可以对树突棘进行多次重复的纵向、在体观察。在此类延时实验中，根据固定的检测阈值，在每次成像会话中将每个识别出的树突棘标注为“存在”或“消失”。由突触修剪和形成引起的树突棘更替可以建模为一个具有两个状态的随机过程：存在和消失。假设实验设计如下：成像会话之间的时间间隔相等，各时间间隔的转移概率均一，且误分类可忽略不计（即，被记为“存在”的树突棘确实存在，反之亦然）。进一步假设，在给定当前状态的情况下，不同树突棘之间以及不同时间间隔之间的状态转换是条件独立的，这与马尔可夫性质一致。\n\n构建一个离散时间双态马尔可夫链，其状态为 $\\{ \\text{存在}, \\text{消失} \\}$，每个时间间隔的转移概率为：从“存在”到“消失”的概率 $p_{PA}$，从“消失”到“存在”的概率 $p_{AP}$（以及 $p_{PP} = 1 - p_{PA}$，$p_{AA} = 1 - p_{AP}$）。从马尔可夫性质和独立试验的二项模型的定义出发，推导出 $p_{PA}$ 和 $p_{AP}$ 的最大似然估计量。然后，将你的估计量应用于以下汇总的所有树突棘在所有等长连续成像间隔中的时间序列计数：\n\n- 从时间 $t$ 的“存在”状态到时间 $t + 1$：$N_{PP} = 144$ 个保持“存在”状态，$N_{PA} = 56$ 个变为“消失”状态，总共有 $N_{P} = 200$ 个“存在”状态的实例对下一次观测有贡献。\n- 从时间 $t$ 的“消失”状态到时间 $t + 1$：$N_{AP} = 45$ 个变为“存在”状态，$N_{AA} = 105$ 个保持“消失”状态，总共有 $N_{A} = 150$ 个“消失”状态的实例对下一次观测有贡献。\n\n根据你的推导计算 $p_{PA}$ 的数值。用小数表示最终数值答案，并四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题陈述经评估是科学上合理的、适定的、客观的且自洽的。它描述了使用离散时间马尔可夫链对生物数据建模的标准应用，这是定量神经生物学中一种常用且有效的方法。状态条件独立性（马尔可夫性质）和转移概率均一性的假设被明确陈述，使得问题可形式化并可解。所提供的数据是内部一致的。因此，将推导求解。\n\n目标是找到一个双态马尔可夫链的转移概率 $p_{PA}$（存在 $\\to$ 消失）和 $p_{AP}$（消失 $\\to$ 存在）的最大似然估计量（MLE）。\n\n设系统的两个状态为 $S_1 = \\text{存在}$ 和 $S_2 = \\text{消失}$。转移概率是针对单个时间间隔定义的。\n$p_{PA}$ 是从状态 $S_1$ 转移到状态 $S_2$ 的概率。\n$p_{PP} = 1 - p_{PA}$ 是保持在状态 $S_1$ 的概率。\n$p_{AP}$ 是从状态 $S_2$ 转移到状态 $S_1$ 的概率。\n$p_{AA} = 1 - p_{AP}$ 是保持在状态 $S_2$ 的概率。\n\n问题陈述指出，在给定当前状态的情况下，不同树突棘之间以及不同时间间隔之间的状态转换是条件独立的。这使我们可以将所有源自同一状态的转换视为一组独立的伯努利试验。\n\n首先，考虑在时间 $t$ 树突棘处于“存在”状态的所有实例。设这些实例的总数为 $N_P$。根据数据，$N_P = N_{PP} + N_{PA} = 144 + 56 = 200$。这 $N_P$ 个实例中的每一个都代表一次独立的试验。对于每次试验，在时间 $t+1$ 有两种可能的结果：树突棘变为“消失”（在此情景下可称之为“失败”），其概率为 $p_{PA}$；或者树突棘保持“存在”（“成功”），其概率为 $p_{PP} = 1 - p_{PA}$。\n\n观察到从“存在”到“消失”的转换次数为 $N_{PA} = 56$，观察到从“存在”到“存在”的转换次数为 $N_{PP} = 144$。在给定参数 $p_{PA}$ 的情况下，观察到这一特定结果的可能性遵循二项分布。参数 $p_{PA}$ 的似然函数 $L_P$ 与在 $N_P$ 次试验中获得 $N_{PA}$ 次失败和 $N_{PP}$ 次成功的概率成正比。\n$$L_P(p_{PA}) = \\binom{N_P}{N_{PA}} (p_{PA})^{N_{PA}} (1 - p_{PA})^{N_{PP}}$$\n为了找到最大似然估计量，我们对该函数关于 $p_{PA}$ 进行最大化。由于对数是单调函数，最大化似然函数的自然对数，即对数似然 $\\ell_P(p_{PA}) = \\ln(L_P(p_{PA}))$，在计算上更简单。\n$$\\ell_P(p_{PA}) = \\ln\\left(\\binom{N_P}{N_{PA}}\\right) + N_{PA} \\ln(p_{PA}) + N_{PP} \\ln(1 - p_{PA})$$\n为了求最大值，我们对 $\\ell_P(p_{PA})$ 关于 $p_{PA}$ 求导，并将其设为零。第一项是常数，其导数为零。\n$$\\frac{d\\ell_P}{dp_{PA}} = \\frac{N_{PA}}{p_{PA}} - \\frac{N_{PP}}{1 - p_{PA}}$$\n将导数设为零以找到临界点：\n$$\\frac{N_{PA}}{p_{PA}} - \\frac{N_{PP}}{1 - p_{PA}} = 0$$\n$$\\frac{N_{PA}}{p_{PA}} = \\frac{N_{PP}}{1 - p_{PA}}$$\n$$N_{PA}(1 - p_{PA}) = N_{PP} p_{PA}$$\n$$N_{PA} - N_{PA} p_{PA} = N_{PP} p_{PA}$$\n$$N_{PA} = (N_{PP} + N_{PA}) p_{PA}$$\n认识到 $N_{PP} + N_{PA} = N_P$，我们得到：\n$$N_{PA} = N_P p_{PA}$$\n求解估计量 $\\hat{p}_{PA}$：\n$$\\hat{p}_{PA} = \\frac{N_{PA}}{N_P} = \\frac{N_{PA}}{N_{PP} + N_{PA}}$$\n\n对于 $p_{AP}$ 也可进行类似的推导。有 $N_A = N_{AP} + N_{AA} = 45 + 105 = 150$ 个树突棘处于“消失”状态的实例。这些构成了 $N_A$ 次独立的伯努利试验，其中“变为存在”是一个结果，概率为 $p_{AP}$。$p_{AP}$ 的最大似然估计量可类似地由下式给出：\n$$\\hat{p}_{AP} = \\frac{N_{AP}}{N_A} = \\frac{N_{AP}}{N_{AA} + N_{AP}}$$\n数据的总似然为 $L(p_{PA}, p_{AP}) = L_P(p_{PA}) \\cdot L_A(p_{AP})$，因为从“存在”状态出发的转换集合与从“消失”状态出发的转换集合是独立的。对数似然为 $\\ell(p_{PA}, p_{AP}) = \\ell_P(p_{PA}) + \\ell_A(p_{AP})$。由于对数似然函数的两个部分依赖于不同的参数，分别对它们进行最大化等同于对联合似然进行最大化。因此，所推导出的估计量是联合最大似然估计量。\n\n问题要求计算 $p_{PA}$ 的数值。使用推导出的估计量和所提供的数据：\n$N_{PA} = 56$\n$N_{PP} = 144$\n从“存在”状态开始的试验总数为 $N_P = N_{PP} + N_{PA} = 144 + 56 = 200$。\n$p_{PA}$ 的最大似然估计为：\n$$\\hat{p}_{PA} = \\frac{56}{200} = \\frac{28}{100} = 0.28$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$0.2800$$", "answer": "$$\n\\boxed{0.2800}\n$$", "id": "5067598"}]}