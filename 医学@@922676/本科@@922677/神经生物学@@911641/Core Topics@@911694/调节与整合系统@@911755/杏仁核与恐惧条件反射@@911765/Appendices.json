{"hands_on_practices": [{"introduction": "理解恐惧条件反射的神经回路，第一步是探究单个神经元如何处理信息。这个练习将引导你使用一个简化的线性求和模型，来模拟外侧杏仁核（LA）神经元如何整合来自不同脑区的信号[@problem_id:5069610]。通过计算突触驱动并将其与放电阈值进行比较，你将亲身体验神经元做出放电“决策”的基本计算原理。", "problem": "在听觉恐惧条件反射中，外侧杏仁核 (LA) 的神经元整合来自内侧膝状体核内侧部 (MGm) 和听觉皮层 (ctx) 的汇集性兴奋性输入。作为与实验神经生理学一致的一阶近似，突触整合可以被建模为一个线性总和，其中净突触驱动取决于由突触效能缩放的突触前放电率。设突触权重为 $w_{\\mathrm{MGm}}$ 和 $w_{\\mathrm{ctx}}$（无量纲效能），突触前放电率为 $r_{\\mathrm{MGm}}$ 和 $r_{\\mathrm{ctx}}$（单位为赫兹，Hz）。那么，到 LA 神经元的组合突触驱动定义为\n$$D = w_{\\mathrm{MGm}}\\, r_{\\mathrm{MGm}} + w_{\\mathrm{ctx}}\\, r_{\\mathrm{ctx}}.$$\n假设一个用于尖峰发放的简化确定性阈值模型，其中只有当突触驱动等于或超过一个阈值 $D^{*}$ 时，神经元才会发放一个尖峰；否则，它不发放尖峰。在此模型下，当 $D \\ge D^{*}$ 时，预测的尖峰放电概率为 $1$，当 $D  D^{*}$ 时，预测的尖峰放电概率为 $0$。\n\n给定 $w_{\\mathrm{MGm}} = 0.6$，$w_{\\mathrm{ctx}} = 0.4$，$r_{\\mathrm{MGm}} = 50$ Hz，$r_{\\mathrm{ctx}} = 20$ Hz，以及阈值 $D^{*} = 40$（任意单位，A.U.），计算 $D$ 并使用上述阈值规则预测 LA 尖峰放电概率。将计算出的 $D$ 四舍五入至四位有效数字，并以 A.U. 表示。最终答案仅报告预测的 LA 尖峰放电概率。", "solution": "用户提供了一个问题，在尝试解答之前需要进行验证。\n\n### 步骤 1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n- 到 LA 神经元的组合突触驱动定义为：$$D = w_{\\mathrm{MGm}}\\, r_{\\mathrm{MGm}} + w_{\\mathrm{ctx}}\\, r_{\\mathrm{ctx}}$$\n- 突触权重（无量纲效能）：$w_{\\mathrm{MGm}}$，$w_{\\mathrm{ctx}}$\n- 突触前放电率（单位为赫兹，Hz）：$r_{\\mathrm{MGm}}$，$r_{\\mathrm{ctx}}$\n- 一个用于尖峰发放的确定性阈值模型：\n  - 当 $D \\ge D^{*}$ 时，预测的尖峰放电概率为 $1$\n  - 当 $D  D^{*}$ 时，预测的尖峰放电概率为 $0$\n- 一个给定的尖峰放电阈值：$D^{*}$\n- 提供的具体数值：\n  - $w_{\\mathrm{MGm}} = 0.6$\n  - $w_{\\mathrm{ctx}} = 0.4$\n  - $r_{\\mathrm{MGm}} = 50$ Hz\n  - $r_{\\mathrm{ctx}} = 20$ Hz\n  - $D^{*} = 40$（任意单位，A.U.）\n- 任务是计算 $D$，将其四舍五入至四位有效数字，用 A.U. 表示，并使用阈值规则预测 LA 尖峰放电概率，最终答案只报告该概率。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **具有科学依据**：问题陈述在科学上是合理的。它使用了一个简化的，但标准且公认的线性求和模型来描述神经元中的突触整合。涉及从内侧膝状体核 (MGm) 和听觉皮层 (ctx) 到外侧杏仁核 (LA) 的输入的听觉恐惧条件反射情境，是关于恐惧和学习的神经生物学研究的基石。确定性阈值模型是神经元放电的常见一阶近似。\n- **适定的**：问题是适定的。它提供了一个清晰的公式，公式中变量的所有必要数值，以及一个确定输出的明确规则。存在唯一解，并且可以直接计算。\n- **客观的**：问题以精确、定量且无偏见的语言陈述。\n\n该问题没有任何使其无效的缺陷。对驱动 $D$ 和阈值 $D^{*}$ 使用“任意单位”(A.U.) 是可以接受的；它建立了一个自洽的系统，其中突触驱动的单位由问题本身定义。由于权重 $w$ 是无量纲的，而速率 $r$ 的单位是赫兹 (Hz)，因此得到的驱动 $D$ 的单位是赫兹 (Hz)。问题暗示了 $1 \\text{ A.U.} = 1 \\text{ Hz}$，这是一个有效的内部定义。该问题被认为是**有效的**。\n\n### 步骤 3：解答\n问题是有效的，将提供解答。\n\n到外侧杏仁核 (LA) 神经元的突触驱动 $D$ 使用提供的线性求和模型计算：\n$$D = w_{\\mathrm{MGm}}\\, r_{\\mathrm{MGm}} + w_{\\mathrm{ctx}}\\, r_{\\mathrm{ctx}}$$\n将给定值代入此方程：\n- $w_{\\mathrm{MGm}} = 0.6$\n- $r_{\\mathrm{MGm}} = 50$ Hz\n- $w_{\\mathrm{ctx}} = 0.4$\n- $r_{\\mathrm{ctx}} = 20$ Hz\n\n计算过程如下：\n$$D = (0.6)(50) + (0.4)(20)$$\n$$D = 30 + 8$$\n$$D = 38$$\n问题指明驱动的单位是任意单位 (A.U.)。因此，计算出的突触驱动为 $D = 38$ A.U.。根据指令将该值四舍五入至四位有效数字，得到 $38.00$ A.U.。\n\n接下来，我们应用确定性阈值模型来确定尖峰放电概率。该模型陈述：\n- 如果 $D \\ge D^{*}$，尖峰放电概率为 $1$\n- 如果 $D  D^{*}$，尖峰放电概率为 $0$\n\n给定的阈值为 $D^{*} = 40$ A.U.。我们必须将计算出的驱动 $D$ 与此阈值进行比较。\n我们有 $D = 38$ A.U. 和 $D^{*} = 40$ A.U.。比较结果是：\n$38  40$\n因此，满足条件 $D  D^{*}$。\n\n根据指定的规则，当 $D  D^{*}$ 时，预测的尖峰放电概率为 $0$。", "answer": "$$\\boxed{0}$$", "id": "5069610"}, {"introduction": "神经元不仅整合信号，还会根据经验调整其连接强度，这正是学习的本质。本练习将向你介绍经典的Rescorla-Wagner模型，它阐明了学习是由“预测误差”（即预期与实际结果之间的差异）驱动的[@problem_id:5069627]。通过一步步计算关联强度的变化，你将直观地理解为何学习总是在初始阶段最快，并随着预测变得准确而逐渐减慢。", "problem": "在一个巴甫洛夫恐惧条件反射范式中，一个音调条件刺激（CS）与足部电击非条件刺激（US）配对，而基底外侧杏仁核（BLA）中的突触变化被认为编码了联结强度。设经过 $n$ 次 CS-US 配对后的联结强度为 $V_{n}$，它代表了下一次试验中预期的 US 强度。联结学习中的经验和理论研究表明，学习是由预测误差驱动的，预测误差定义为所传递的 US 幅度与当前预期之间的差异，并使用误差校正来减少平方损失。\n\n从以下符合情境的基础出发：\n- 瞬时预测误差为 $\\delta = \\lambda - V$，其中 $\\lambda$ 是 US 幅度，$V$ 是当前预期。\n- 损失函数是瞬时平方误差 $E(V) = \\tfrac{1}{2}\\,\\delta^{2} = \\tfrac{1}{2}\\,(\\lambda - V)^{2}$。\n- 突触更新遵循在 $E(V)$ 上的标准梯度下降法，学习率为 $\\alpha$，因此单次配对中联结强度的变化为 $\\Delta V = -\\alpha\\,\\dfrac{dE}{dV}$。\n\n(a) 根据这些假设，推导 $\\Delta V$ 的逐次试验学习更新规则。然后，用 $V_{n}$、$\\alpha$ 和 $\\lambda$ 写出 $V_{n+1}$ 的递推关系。\n\n(b) 考虑习得过程，其中 US 幅度恒为 $\\lambda = 1$，学习率为 $\\alpha = 0.1$，从 $V_{0} = 0$ 开始。使用你推导出的更新规则，计算三次 CS-US 配对后的 $V_{1}$、$V_{2}$ 和 $V_{3}$。将这些值表示为精确小数，无需四舍五入。\n\n(c) 结合预测误差，简要解释随着试验次数 $n$ 的增加，$V_{n}$ 如何接近其渐近线，以及学习过程是会减慢还是加速。\n\n在你的最终答案中，将(b)部分的三个数值按顺序以单行矩阵的形式呈现。不需要单位。", "solution": "问题陈述描述了联结学习的 Rescorla-Wagner 模型，这是计算神经科学和心理学中的一个基本概念。该模型提出学习是由预测误差驱动的，并且可以通过在平方误差损失函数上使用梯度下降来形式化。该问题具有科学依据，提法明确，并提供了求解所需的所有必要信息。\n\n(a) 学习更新规则和递推关系的推导。\n\n问题提供了以下信息：\n损失函数，即瞬时平方误差，由 $E(V) = \\frac{1}{2}(\\lambda - V)^{2}$ 给出，其中 $\\lambda$ 是非条件刺激 (US) 的幅度，$V$ 是当前的联结强度，即对 US 的预期。\n更新联结强度的规则以梯度下降的形式给出：\n$$\n\\Delta V = -\\alpha\\,\\dfrac{dE}{dV}\n$$\n其中 $\\alpha$ 是学习率。\n\n为了找到具体的更新规则，我们必须首先计算损失函数 $E(V)$ 关于 $V$ 的导数。使用链式法则，设 $u = \\lambda - V$。那么 $\\frac{du}{dV} = -1$。\n$$\n\\dfrac{dE}{dV} = \\dfrac{d}{dV} \\left( \\frac{1}{2}(\\lambda - V)^{2} \\right) = \\dfrac{d}{dV} \\left( \\frac{1}{2}u^{2} \\right) = \\dfrac{dE}{du}\\dfrac{du}{dV} = (u)(-1) = -(\\lambda - V)\n$$\n将这个导数代回 $\\Delta V$ 的表达式中：\n$$\n\\Delta V = -\\alpha \\left( -(\\lambda - V) \\right) = \\alpha(\\lambda - V)\n$$\n这就是明确的逐次试验学习更新规则。它表明联结强度的变化与预测误差 $\\delta = \\lambda - V$ 成正比。\n\n第 $n+1$ 次试验后的联结强度，记为 $V_{n+1}$，是试验前强度 $V_n$ 与试验期间发生的变化 $\\Delta V_n$ 之和。变化量 $\\Delta V_n$ 是根据第 $n$ 次试验开始时的条件计算的：\n$$\n\\Delta V_n = \\alpha(\\lambda - V_n)\n$$\n因此，$V_{n+1}$ 的递推关系是：\n$$\nV_{n+1} = V_n + \\Delta V_n = V_n + \\alpha(\\lambda - V_n)\n$$\n\n(b) $V_{1}$、$V_{2}$ 和 $V_{3}$ 的计算。\n\n我们已知初始条件 $V_{0} = 0$ 以及常数参数 $\\lambda = 1$ 和 $\\alpha = 0.1$。我们使用 (a) 部分推导出的递推关系：$V_{n+1} = V_n + 0.1(1 - V_n)$。\n\n对于试验 1（从 $V_0$ 计算 $V_1$）：\n$$\nV_{1} = V_{0} + \\alpha(\\lambda - V_{0}) = 0 + 0.1(1 - 0) = 0.1\n$$\n\n对于试验 2（从 $V_1$ 计算 $V_2$）：\n$$\nV_{2} = V_{1} + \\alpha(\\lambda - V_{1}) = 0.1 + 0.1(1 - 0.1) = 0.1 + 0.1(0.9) = 0.1 + 0.09 = 0.19\n$$\n\n对于试验 3（从 $V_2$ 计算 $V_3$）：\n$$\nV_{3} = V_{2} + \\alpha(\\lambda - V_{2}) = 0.19 + 0.1(1 - 0.19) = 0.19 + 0.1(0.81) = 0.19 + 0.081 = 0.271\n$$\n因此，经过三次 CS-US 配对后，联结强度分别为 $V_1 = 0.1$，$V_2 = 0.19$ 和 $V_3 = 0.271$。\n\n(c) 学习动态的解释。\n\n学习过程由递推关系 $V_{n+1} = V_n + \\alpha(\\lambda - V_n)$ 控制。只要联结强度发生变化，即只要 $\\Delta V_n = \\alpha(\\lambda - V_n) \\neq 0$，学习就会继续。由于学习率 $\\alpha$ 是一个正常数，只有当预测误差项 $\\delta_n = \\lambda - V_n$ 变为零时，学习才会停止。这发生在 $V_n = \\lambda$ 的时候。因此，联结强度 $V_n$ 接近一个等于 US 幅度的渐近值，即 $V_{\\infty} = \\lambda$。\n\n在初始试验中，当 $V_n$ 远离 $\\lambda$ 时，预测误差 $\\delta_n$ 很大。例如，在第一次试验中，$\\delta_0 = \\lambda - V_0 = 1 - 0 = 1$，这是可能的最大误差。这个大的预测误差会驱动联结强度产生相应的大幅更新，$\\Delta V_0 = \\alpha \\delta_0 = 0.1$。\n\n随着 $n$ 的增加，$V_n$ 逐渐接近 $\\lambda = 1$。因此，预测误差 $\\delta_n = \\lambda - V_n$ 随每次试验而减小。由于更新的幅度 $\\Delta V_n$ 与预测误差成正比，联结强度的增量在每次连续试验中都会变小。例如，$\\Delta V_0 = 0.1$，$\\Delta V_1 = 0.09$，$ \\Delta V_2 = 0.081$。\n\n这表明，在习得初期，当 US 最令人意外时，学习速度最快；而随着联结强度接近真实的 US 幅度且 US 变得完全可预测时，学习速度会**减慢**。学习曲线是负加速的，显示出每次配对的收益递减。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1  0.19  0.271\n\\end{pmatrix}\n}\n$$", "id": "5069627"}, {"introduction": "我们已经探讨了信号整合与学习规则，现在让我们将这些概念置于一个更真实的生物物理网络中，看看神经元间的相互作用如何控制像“冻结”这样的复杂行为。这个高级练习要求你构建一个包含杏仁核中央外侧核（CeL）和中央内侧核（CeM）的计算模型[@problem_id:5069617]。通过应用神经科学中经典的“leaky integrate-and-fire”模型，你将模拟CeL的抑制性信号如何调控CeM的输出，从而为理解恐惧表达的门控机制提供一个可操作的框架。", "problem": "要求您对一个由杏仁核中央外侧核 (CeL) 抑制性神经元和杏仁核中央内侧核 (CeM) 输出神经元组成的最小确定性网络模型进行形式化、模拟和分析，以在一个有原则的生物物理框架下，证明 CeL 抑制性驱动的增强如何将 CeM 的放电率降低到与冻结行为相关的阈值以下。目标是从适合神经生物学的第一性原理推导出控制方程，并实现一个数值模拟，该模拟能对几个测试用例输出 CeM 放电率是高于还是低于指定的冻结阈值。请使用以下基本基础和模型规范。\n\n基本基础：\n- 神经元膜被视为一个电阻-电容电路。设膜电容为 $C_m$，膜电阻为 $R_m$。电流平衡方程为\n$$\nC_m \\frac{dV(t)}{dt} = -\\frac{V(t) - V_{\\mathrm{rest}}}{R_m} + I_{\\mathrm{tot}}(t),\n$$\n其中 $V(t)$ 是以毫伏为单位的膜电位，$V_{\\mathrm{rest}}$ 是以毫伏为单位的静息电位，$I_{\\mathrm{tot}}(t)$ 是以纳安为单位的总输入电流。定义膜时间常数 $ \\tau_m = R_m C_m $ 并将方程重写为\n$$\n\\frac{dV(t)}{dt} = \\frac{-(V(t)-V_{\\mathrm{rest}}) + R_m I_{\\mathrm{tot}}(t)}{\\tau_m}.\n$$\n这就是带欧姆漏电的漏电积分-发放模型。\n- 来自 CeL 的抑制性突触电流通过一个门控变量 $s(t)$ 进行建模，该变量的演化遵循\n$$\n\\frac{ds(t)}{dt} = -\\frac{s(t)}{\\tau_{\\mathrm{syn}}} + \\sum_k \\delta(t - t_k),\n$$\n其中 $\\tau_{\\mathrm{syn}}$ 是以毫秒为单位的突触时间常数，$\\delta(\\cdot)$ 是狄拉克δ函数，$t_k$ 是来自 CeL 的抑制性脉冲时间。抑制性电流为\n$$\nI_{\\mathrm{inh}}(t) = w_{\\mathrm{inh}} \\, s(t),\n$$\n其中 $w_{\\mathrm{inh}}$ 以纳安为单位。\n- 条件刺激 (CS) 向 CeM 注入一个恒定的兴奋性电流：\n$$\nI_{\\mathrm{exc}}(t) = I_{\\mathrm{CS}},\n$$\n其中 $I_{\\mathrm{CS}}$ 以纳安为单位。\n- 流向 CeM 的总电流为 $I_{\\mathrm{tot}}(t) = I_{\\mathrm{exc}}(t) - I_{\\mathrm{inh}}(t)$。\n\nCeM 脉冲发放规则：\n- 当 $V(t)$ 从下方穿过阈值 $V_{\\mathrm{th}}$ 时，记录一个脉冲并将 $V(t)$ 重置为 $V_{\\mathrm{reset}}$。实现一个持续时间为 $t_{\\mathrm{ref}}$ 毫秒的绝对不应期，在此期间 $V(t)$ 保持在 $V_{\\mathrm{reset}}$。\n\n数值方法：\n- 使用具有固定步长 $\\Delta t$ 的显式 Euler 积分法在时间上推进 $V(t)$ 和 $s(t)$。CeL 脉冲序列是确定性的，且以频率 $f_{\\mathrm{CeL}}$ (单位：赫兹) 周期性出现，产生脉冲间隔 $T_{\\mathrm{CeL}} = 1000/f_{\\mathrm{CeL}}$ 毫秒。当 $f_{\\mathrm{CeL}} = 0$ 时，没有 CeL 脉冲。\n\n行为决策规则：\n- 将 CeM 放电率 $r_{\\mathrm{CeM}}$ (单位：赫兹) 定义为 CeM 脉冲数量除以模拟持续时间 (单位：秒)。定义冻结阈值 $r_{\\mathrm{freeze}}$ (单位：赫兹)。当且仅当 $r_{\\mathrm{CeM}}$ 严格大于 $r_{\\mathrm{freeze}}$ 时，认为冻结行为被触发。\n\n单位：\n- 时间变量 ($t$, $\\tau_m$, $\\tau_{\\mathrm{syn}}$, $t_{\\mathrm{ref}}$, 模拟持续时间) 必须以毫秒为单位。\n- 膜电位 ($V$, $V_{\\mathrm{rest}}$, $V_{\\mathrm{th}}$, $V_{\\mathrm{reset}}$) 必须以毫伏为单位。\n- 电流 ($I_{\\mathrm{CS}}$, $I_{\\mathrm{inh}}$, $I_{\\mathrm{tot}}$) 必须以纳安为单位。\n- 电阻 ($R_m$) 必须以兆欧为单位，这样当 $I$ 以纳安为单位时，$R_m I$ 的结果为毫伏。\n- 频率 ($f_{\\mathrm{CeL}}$, $r_{\\mathrm{CeM}}$, $r_{\\mathrm{freeze}}$) 必须以赫兹为单位。\n\n实现要求：\n- 实现指定的模型，为下面列出的每个测试用例计算 CeM 放电率 $r_{\\mathrm{CeM}}$，然后计算表示冻结行为是否被触发的布尔值 ($r_{\\mathrm{CeM}} > r_{\\mathrm{freeze}}$)。\n- 您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔的结果列表 (例如，\"[result1,result2,result3]\")。\n\n测试套件 (每个用例指定参数；请精确使用这些值)：\n- 用例 1 (正常路径，中等抑制)：$T = 1000$ ms, $\\Delta t = 0.1$ ms, $V_{\\mathrm{rest}} = -65$ mV, $V_{\\mathrm{th}} = -50$ mV, $V_{\\mathrm{reset}} = -65$ mV, $\\tau_m = 20$ ms, $R_m = 100$ MOhm, $t_{\\mathrm{ref}} = 2$ ms, $\\tau_{\\mathrm{syn}} = 10$ ms, $I_{\\mathrm{CS}} = 0.25$ nA, $w_{\\mathrm{inh}} = 0.02$ nA, $f_{\\mathrm{CeL}} = 10$ Hz, $r_{\\mathrm{freeze}} = 10$ Hz。\n- 用例 2 (抑制增强，预期抑制)：与用例 1 相同，但 $w_{\\mathrm{inh}} = 0.08$ nA 且 $f_{\\mathrm{CeL}} = 25$ Hz, $r_{\\mathrm{freeze}} = 10$ Hz。\n- 用例 3 (CeL 输入为零的边界情况)：与用例 1 相同，但 $w_{\\mathrm{inh}} = 0$ nA 且 $f_{\\mathrm{CeL}} = 0$ Hz, $r_{\\mathrm{freeze}} = 10$ Hz。\n\n输出规范：\n- 对于每个用例，输出一个布尔值，表示 $r_{\\mathrm{CeM}} > r_{\\mathrm{freeze}}$ 是否成立。将三个布尔值聚合成单行输出，格式为 \"[b1,b2,b3]\"。", "solution": "我们从神经元膜的电阻-电容描述开始构建模型。膜电位 $V(t)$ 的基本电流平衡方程为\n$$\nC_m \\frac{dV(t)}{dt} = -\\frac{V(t) - V_{\\mathrm{rest}}}{R_m} + I_{\\mathrm{tot}}(t),\n$$\n其中 $C_m$ 是膜电容，$R_m$ 是膜电阻，$V_{\\mathrm{rest}}$ 是静息电位，$I_{\\mathrm{tot}}(t)$ 是所有进入膜的外部电流之和。定义膜时间常数 $ \\tau_m = R_m C_m $，我们可以将漏电积分-发放动力学表示为\n$$\n\\frac{dV(t)}{dt} = \\frac{-(V(t)-V_{\\mathrm{rest}}) + R_m I_{\\mathrm{tot}}(t)}{\\tau_m}.\n$$\n该公式使用 $V=IR$ 形式的欧姆定律，将通过 $R_m$ (单位：兆欧) 的输入电流 (单位：纳安) 映射为等效的毫伏驱动，从而确保单位的一致性。\n\n我们将进入 CeM 神经元的总输入电流分为代表条件刺激的兴奋性分量 $I_{\\mathrm{exc}}(t)$ 和代表 CeL 效应的抑制性分量 $I_{\\mathrm{inh}}(t)$：\n$$\nI_{\\mathrm{tot}}(t) = I_{\\mathrm{exc}}(t) - I_{\\mathrm{inh}}(t), \\quad I_{\\mathrm{exc}}(t) = I_{\\mathrm{CS}}.\n$$\n对于抑制性突触，我们使用一个标准的一阶动力学模型来描述门控变量 $s(t)$：\n$$\n\\frac{ds(t)}{dt} = -\\frac{s(t)}{\\tau_{\\mathrm{syn}}} + \\sum_k \\delta(t - t_k),\n$$\n其中 $\\tau_{\\mathrm{syn}}$ 是突触衰减时间常数，$t_k$ 是来自 CeL 的确定性抑制性脉冲时间。每个脉冲使 $s(t)$ 瞬时增加 1，并且 $s(t)$ 在脉冲之间呈指数衰减。抑制性电流由下式给出\n$$\nI_{\\mathrm{inh}}(t) = w_{\\mathrm{inh}} s(t),\n$$\n其中 $w_{\\mathrm{inh}}$ 设定了每单位 $s(t)$ 的抑制强度。\n\n当 $V(t)$ 从下方穿过 $V_{\\mathrm{th}}$ 时，检测到 CeM 脉冲。发生脉冲时，膜电位被重置为 $V_{\\mathrm{reset}}$ 并在此期间保持一个绝对不应期 $t_{\\mathrm{ref}}$。放电率 $r_{\\mathrm{CeM}}$ 是脉冲计数除以模拟持续时间 (秒)。\n\n使用显式 Euler 积分的算法设计：\n1. 初始化 $V(0) = V_{\\mathrm{rest}}$，$s(0) = 0$，脉冲计数 $N_{\\mathrm{spk}} = 0$，以及不应期计时器 $t_{\\mathrm{ref,rem}} = 0$。\n2. 确定 CeL 脉冲间隔 $T_{\\mathrm{CeL}} = 1000/f_{\\mathrm{CeL}}$ ms。如果 $f_{\\mathrm{CeL}} = 0$，则不发生抑制性脉冲。\n3. 对于从 $t=0$ 到 $t=T$ 的大小为 $\\Delta t$ 的离散时间步：\n   - 如果 $t$ 到达下一个 CeL 脉冲时间 $t_k$，则将 $s$ 增加为 $s \\leftarrow s + 1$，并安排下一个脉冲在 $t_k + T_{\\mathrm{CeL}}$ 发生。\n   - 使用以下公式更新突触门控变量\n     $$\n     s \\leftarrow s + \\left(-\\frac{s}{\\tau_{\\mathrm{syn}}}\\right) \\Delta t.\n     $$\n   - 计算 $I_{\\mathrm{inh}} = w_{\\mathrm{inh}} s$ 和 $I_{\\mathrm{tot}} = I_{\\mathrm{CS}} - I_{\\mathrm{inh}}$。\n   - 如果 $t_{\\mathrm{ref,rem}} > 0$，则设置 $V \\leftarrow V_{\\mathrm{reset}}$ 并递减 $t_{\\mathrm{ref,rem}} \\leftarrow t_{\\mathrm{ref,rem}} - \\Delta t$。\n   - 否则，使用以下公式更新膜电位\n     $$\n     V \\leftarrow V + \\frac{-(V - V_{\\mathrm{rest}}) + R_m I_{\\mathrm{tot}}}{\\tau_m} \\Delta t.\n     $$\n   - 如果 $V \\ge V_{\\mathrm{th}}$ (在离散时间内从下方穿过)，则记录一个脉冲 ($N_{\\mathrm{spk}} \\leftarrow N_{\\mathrm{spk}} + 1$)，设置 $V \\leftarrow V_{\\mathrm{reset}}$，并设置 $t_{\\mathrm{ref,rem}} \\leftarrow t_{\\mathrm{ref}}$。\n4. 循环结束后，计算\n   $$\n   r_{\\mathrm{CeM}} = \\frac{N_{\\mathrm{spk}}}{T/1000}.\n   $$\n5. 通过评估布尔值 $r_{\\mathrm{CeM}} > r_{\\mathrm{freeze}}$ 来确定是否触发冻结行为。\n\n科学解释：\n- 对于频率为 $f_{\\mathrm{CeL}}$ 的周期性抑制性脉冲序列，在稳态下，门控变量满足 $s_{\\mathrm{ss}} \\approx \\tau_{\\mathrm{syn}} f_{\\mathrm{CeL}}$ (因为每个脉冲增加 1，而 $s$ 以时间常数 $\\tau_{\\mathrm{syn}}$ 衰减)，从而产生平均抑制电流\n$$\n\\langle I_{\\mathrm{inh}} \\rangle \\approx w_{\\mathrm{inh}} \\tau_{\\mathrm{syn}} f_{\\mathrm{CeL}}.\n$$\n- 增加 $w_{\\mathrm{inh}}$ 或 $f_{\\mathrm{CeL}}$ 都会增加 $\\langle I_{\\mathrm{inh}} \\rangle$，降低膜方程中的驱动项 $R_m I_{\\mathrm{tot}}$，减少 $V(t)$ 在阈值附近停留的时间，因此降低脉冲计数 $N_{\\mathrm{spk}}$ 和放电率 $r_{\\mathrm{CeM}}$。\n- 如果抑制性驱动足够强，$r_{\\mathrm{CeM}}$ 可以被降低到行为阈值 $r_{\\mathrm{freeze}}$ 以下，从而预测尽管存在兴奋性 CS，但不会出现冻结行为。\n\n测试套件探讨了：\n- 用例 1：中等抑制，预期 $r_{\\mathrm{CeM}}$ 高于阈值 ($r_{\\mathrm{freeze}} = 10$ Hz)。\n- 用例 2：通过更高的 $w_{\\mathrm{inh}}$ 和 $f_{\\mathrm{CeL}}$ 增加抑制，预期抑制到阈值以下。\n- 用例 3：零 CeL 抑制 (抑制驱动的下限边界)，对于给定的 $I_{\\mathrm{CS}}$，产生最大的 $r_{\\mathrm{CeM}}$。\n\n程序计算每个用例的布尔结果 $[b_1, b_2, b_3]$ (表示 $r_{\\mathrm{CeM}} > r_{\\mathrm{freeze}}$)，并以指定格式将它们打印为单行输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_cem_cel_case(\n    T_ms,\n    dt_ms,\n    V_rest_mV,\n    V_thresh_mV,\n    V_reset_mV,\n    tau_m_ms,\n    R_m_MOhm,\n    t_ref_ms,\n    tau_syn_ms,\n    I_CS_nA,\n    w_inh_nA,\n    f_CeL_Hz,\n    r_freeze_Hz,\n):\n    \"\"\"\n    Simulate a minimal deterministic network:\n    - CeM: leaky integrate-and-fire neuron.\n    - CeL: periodic inhibitory spike train driving a decaying synaptic gating variable s(t).\n\n    Returns: boolean indicating whether freezing is engaged (CeM rate  r_freeze_Hz).\n    \"\"\"\n    n_steps = int(T_ms / dt_ms)\n    V = V_rest_mV\n    s_inh = 0.0\n    spikes = 0\n    ref_remaining_ms = 0.0\n\n    # CeL spike scheduling\n    if f_CeL_Hz  0.0:\n        cel_interval_ms = 1000.0 / f_CeL_Hz\n        next_cel_spike_ms = 0.0\n    else:\n        cel_interval_ms = None\n        next_cel_spike_ms = None\n\n    t_ms = 0.0\n    for _ in range(n_steps):\n        # CeL spike occurs?\n        if next_cel_spike_ms is not None and t_ms = next_cel_spike_ms:\n            s_inh += 1.0  # instantaneous increment per inhibitory spike\n            next_cel_spike_ms += cel_interval_ms\n\n        # Synaptic gating decay (explicit Euler)\n        s_inh += (-s_inh / tau_syn_ms) * dt_ms\n\n        # Inhibitory current\n        I_inh_nA = w_inh_nA * s_inh\n\n        # Total input current to CeM\n        I_tot_nA = I_CS_nA - I_inh_nA\n\n        if ref_remaining_ms  0.0:\n            # Absolute refractory: hold at reset\n            V = V_reset_mV\n            ref_remaining_ms = max(0.0, ref_remaining_ms - dt_ms)\n        else:\n            # Membrane update (explicit Euler)\n            dVdt = (-(V - V_rest_mV) + R_m_MOhm * I_tot_nA) / tau_m_ms\n            V += dVdt * dt_ms\n\n            # Spike condition\n            if V = V_thresh_mV:\n                spikes += 1\n                V = V_reset_mV\n                ref_remaining_ms = t_ref_ms\n\n        t_ms += dt_ms\n\n    duration_s = T_ms / 1000.0\n    r_CeM_Hz = spikes / duration_s\n    return r_CeM_Hz  r_freeze_Hz\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path, moderate inhibition\n        {\n            \"T_ms\": 1000.0,\n            \"dt_ms\": 0.1,\n            \"V_rest_mV\": -65.0,\n            \"V_thresh_mV\": -50.0,\n            \"V_reset_mV\": -65.0,\n            \"tau_m_ms\": 20.0,\n            \"R_m_MOhm\": 100.0,\n            \"t_ref_ms\": 2.0,\n            \"tau_syn_ms\": 10.0,\n            \"I_CS_nA\": 0.25,\n            \"w_inh_nA\": 0.02,\n            \"f_CeL_Hz\": 10.0,\n            \"r_freeze_Hz\": 10.0,\n        },\n        # Case 2: increased inhibition, expected suppression\n        {\n            \"T_ms\": 1000.0,\n            \"dt_ms\": 0.1,\n            \"V_rest_mV\": -65.0,\n            \"V_thresh_mV\": -50.0,\n            \"V_reset_mV\": -65.0,\n            \"tau_m_ms\": 20.0,\n            \"R_m_MOhm\": 100.0,\n            \"t_ref_ms\": 2.0,\n            \"tau_syn_ms\": 10.0,\n            \"I_CS_nA\": 0.25,\n            \"w_inh_nA\": 0.08,\n            \"f_CeL_Hz\": 25.0,\n            \"r_freeze_Hz\": 10.0,\n        },\n        # Case 3: zero CeL input (boundary)\n        {\n            \"T_ms\": 1000.0,\n            \"dt_ms\": 0.1,\n            \"V_rest_mV\": -65.0,\n            \"V_thresh_mV\": -50.0,\n            \"V_reset_mV\": -65.0,\n            \"tau_m_ms\": 20.0,\n            \"R_m_MOhm\": 100.0,\n            \"t_ref_ms\": 2.0,\n            \"tau_syn_ms\": 10.0,\n            \"I_CS_nA\": 0.25,\n            \"w_inh_nA\": 0.0,\n            \"f_CeL_Hz\": 0.0,\n            \"r_freeze_Hz\": 10.0,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = simulate_cem_cel_case(**params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "5069617"}]}