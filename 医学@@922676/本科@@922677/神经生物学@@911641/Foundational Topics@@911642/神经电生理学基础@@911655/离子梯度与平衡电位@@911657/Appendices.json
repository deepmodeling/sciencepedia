{"hands_on_practices": [{"introduction": "能斯特方程和戈德曼-霍奇金-卡茨（GHK）方程中都包含一个关键项 $RT/F$，其单位是电压。本练习将通过从基本物理常数（如玻尔兹曼常数 $k_B$ 和基本电荷 $e$）出发，来探究这个“热电压”的物理起源。理解这个术语至关重要，因为它代表了连接热运动和电势的能量尺度，构成了神经生理学中所有平衡电位计算的基础 [@problem_id:5028022]。", "problem": "一个单价离子在电化学平衡状态下穿过神经元膜的过程，受到热能和电功之间平衡的支配。仅从玻尔兹曼常数 ($k_B$)、元电荷 ($e$)、阿伏伽德罗常数 ($N_A$)、气体常数 ($R$) 和法拉第常数 ($F$) 的定义出发，展示在平衡关系中出现的特征电压尺度是如何产生的。具体来说：\n- 从移动电荷 $q$ 穿过电势差 $V$ 所需的电功为 $qV$，以及在绝对温度 $T$ 下每个粒子的特征热能为 $k_B T$ 这一陈述开始。\n- 使用定义 $R = N_A k_B$ 和 $F = N_A e$ 将每个粒子的量转换为每摩尔的量，并推导出一个用基本常数表示的 $RT/F$ 的表达式。\n- 解释为什么这个比率设定了与单价离子平衡电位相关的单位电荷能量尺度（有时称为热电压）。\n\n然后，使用精确的常数值 $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，$N_A = 6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}$，计算在 $T = 298\\,\\mathrm{K}$ 和 $T = 310\\,\\mathrm{K}$ 时的 $RT/F$。将两个结果都以毫伏表示。最后，将比率 $\\left(\\frac{RT}{F}\\right)_{310} \\big/ \\left(\\frac{RT}{F}\\right)_{298}$ 四舍五入到四位有效数字，作为你的唯一最终答案报告。该比率是无量纲的，但中间电压必须以 $\\mathrm{mV}$ 表示，以证明和解释在 $T=298\\,\\mathrm{K}$ 时常用的近似值 $25.7\\,\\mathrm{mV}$ 和在 $T=310\\,\\mathrm{K}$ 时常用的近似值 $26.7\\,\\mathrm{mV}$。", "solution": "该问题被验证为具有科学依据、问题明确、客观且完整。它基于应用于神经生物学的统计力学和电磁学的基本原理。所有必需的常数和条件都已提供，任务结构逻辑清晰且可解。\n\n该问题要求推导特征电压尺度，解释其重要性，计算其在两个温度下的值，并最终计算这些值的比率。\n\n离子跨膜电化学平衡的核心原理是电场做的功与驱动扩散的热搅动所做的有效“功”之间的平衡。我们被要求从单个粒子的角度开始。\n\n移动一个带电荷 $q$ 的单个粒子穿过电势差 $V$ 所需的电功 $W_{elec}$ 由下式给出：\n$$\nW_{elec} = qV\n$$\n对于单价离子，电荷 $q$ 等于元电荷 $e$。因此，对于单个单价离子，电功为 $eV$。\n\n在绝对温度 $T$ 下，单个粒子的特征热能 $E_{th}$ 由下式给出：\n$$\nE_{th} = k_B T\n$$\n其中 $k_B$ 是玻尔兹曼常数。\n\n在电化学平衡时，跨膜的电能差被与浓度差相关的熵贡献所平衡。能斯特电位是这种平衡发生时的特定电压。浓度梯度和电势之间的关系由热能调节。浓度比由玻尔兹曼因子给出，该因子关联了不同能量状态的概率。单价离子穿过电势 $V$ 的能量差是 $eV$。因此，平衡由一个方程描述，其中电势 $V$ 与单位电荷的热能成正比，即 $k_B T / e$。这个比率 $k_B T / e$ 作为自然电压尺度出现，它决定了给定浓度比下平衡电位的大小。它的单位是焦耳每库仑，即伏特。\n\n问题要求使用气体常数 $R$ 和法拉第常数 $F$ 来证明这个单粒子尺度与每摩尔尺度的等价性。我们被给出的定义是：\n$$\nR = N_A k_B\n$$\n$$\nF = N_A e\n$$\n其中 $N_A$ 是阿伏伽德罗常数。\n\n使用这些定义，我们可以构建比率 $RT/F$，并展示其与基本常数 $k_B$、$T$ 和 $e$ 的关系。\n$$\n\\frac{RT}{F} = \\frac{(N_A k_B) T}{(N_A e)}\n$$\n阿伏伽德罗常数 $N_A$ 在分子和分母中被消去，得到：\n$$\n\\frac{RT}{F} = \\frac{k_B T}{e}\n$$\n这个推导正式证明了在摩尔形式的能斯特方程中出现的量 $RT/F$ 与从单粒子考虑中得到的量 $k_B T/e$ 是相同的。这个比率通常被称为“热电压”，$V_T$。它代表了对单位电荷（$e$ 或 $F$）做等于特征热能（$k_B T$ 或 $RT$）的电功所需的电压。它是连接平衡状态下电驱动力和化学（扩散）驱动力的基本单位电荷能量尺度。\n\n接下来，我们的任务是使用提供的精确常数值计算该热电压在两个特定温度下的值：\n$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n\n情况 1：$T_1 = 298\\,\\mathrm{K}$ (约 $25^\\circ\\mathrm{C}$)\n热电压，我们记为 $V_{T,1}$，是：\n$$\nV_{T,1} = \\frac{k_B T_1}{e} = \\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\times (298\\,\\mathrm{K})}{1.602176634 \\times 10^{-19}\\,\\mathrm{C}}\n$$\n$$\nV_{T,1} \\approx \\frac{4.114334 \\times 10^{-21}\\,\\mathrm{J}}{1.602176634 \\times 10^{-19}\\,\\mathrm{C}} \\approx 0.0256795\\,\\mathrm{V}\n$$\n以毫伏表示，这是 $25.6795\\,\\mathrm{mV}$。这证实了在此温度下常用的近似值 $25.7\\,\\mathrm{mV}$。\n\n情况 2：$T_2 = 310\\,\\mathrm{K}$ (生理温度，约 $37^\\circ\\mathrm{C}$)\n热电压 $V_{T,2}$ 是：\n$$\nV_{T,2} = \\frac{k_B T_2}{e} = \\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\times (310\\,\\mathrm{K})}{1.602176634 \\times 10^{-19}\\,\\mathrm{C}}\n$$\n$$\nV_{T,2} \\approx \\frac{4.2799919 \\times 10^{-21}\\,\\mathrm{J}}{1.602176634 \\times 10^{-19}\\,\\mathrm{C}} \\approx 0.0267139\\,\\mathrm{V}\n$$\n以毫伏表示，这是 $26.7139\\,\\mathrm{mV}$。这证实了在此温度下常用的近似值 $26.7\\,\\mathrm{mV}$。\n\n最后，我们必须计算在 $T_2 = 310\\,\\mathrm{K}$ 时的热电压与在 $T_1 = 298\\,\\mathrm{K}$ 时的热电压之比。\n$$\n\\text{比率} = \\frac{\\left(\\frac{RT}{F}\\right)_{310}}{\\left(\\frac{RT}{F}\\right)_{298}} = \\frac{V_{T,2}}{V_{T,1}}\n$$\n由于 $V_T = k_B T / e$，该比率可以简化为：\n$$\n\\text{比率} = \\frac{k_B T_2 / e}{k_B T_1 / e} = \\frac{T_2}{T_1}\n$$\n常数 $k_B$、$R$、$e$ 和 $F$ 被消去，只留下绝对温度的简单比率。\n$$\n\\text{比率} = \\frac{310\\,\\mathrm{K}}{298\\,\\mathrm{K}} \\approx 1.040268456...\n$$\n问题要求将此结果四舍五入到四位有效数字。\n$$\n\\text{比率} \\approx 1.040\n$$", "answer": "$$\\boxed{1.040}$$", "id": "5028022"}, {"introduction": "虽然能斯特方程描述了单个离子的平衡状态，但真实的神经元通道，如AMPA受体，通常对多种离子都具有通透性。本练习应用戈德曼-霍奇金-卡茨（GHK）方程来计算该通道的翻转电位，即净离子电流为零时的膜电位。通过解决这个问题，你将理解离子通透性和浓度梯度如何共同决定一个突触通道的电压响应 [@problem_id:5028003]。", "problem": "一个兴奋性突触表达一种AMPA受体通道（α-氨基-3-羟基-5-甲基-4-异恶唑丙酸），该通道对钠离子和钾离子具有通透性，但对氯离子或钙离子不具通透性。考虑一个神经元，其胞内浓度为 $[\\text{Na}^{+}]_{i} = 12\\,\\text{mM}$ 和 $[\\text{K}^{+}]_{i} = 140\\,\\text{mM}$，浸泡在胞外溶液中，其浓度为 $[\\text{Na}^{+}]_{o} = 145\\,\\text{mM}$ 和 $[\\text{K}^{+}]_{o} = 4\\,\\text{mM}$。该通道对钠和钾的相对渗透性分别为 $P_{\\text{Na}} = 1.2$ 和 $P_{\\text{K}} = 1.0$。假设两种离子都是单价阳离子，电荷数为 $z = +1$，温度恒定为 $T = 310\\,\\text{K}$，并使用普适气体常数 $R = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ 和法拉第常数 $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$。 \n\n从反转电位是指通过通道的净电流为零时的膜电位这一条件出发，并引用恒定场近似以及离子独立运动原理，确定通道的反转电位 $E_{\\text{rev}}$。以毫伏为单位表示您的最终答案，并四舍五入到三位有效数字。", "solution": "用户希望我扮演一位严谨的STEM教授。我将验证该问题，如果问题有效，则提供解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n- 胞内钠离子浓度：$[\\text{Na}^{+}]_{i} = 12\\,\\text{mM}$\n- 胞内钾离子浓度：$[\\text{K}^{+}]_{i} = 140\\,\\text{mM}$\n- 胞外钠离子浓度：$[\\text{Na}^{+}]_{o} = 145\\,\\text{mM}$\n- 胞外钾离子浓度：$[\\text{K}^{+}]_{o} = 4\\,\\text{mM}$\n- 钠的相对渗透性：$P_{\\text{Na}} = 1.2$\n- 钾的相对渗透性：$P_{\\text{K}} = 1.0$\n- 可渗透离子：钠 (Na$^+$), 钾 (K$^+$)\n- 不可渗透离子：氯 (Cl$^-$), 钙 (Ca$^{2+}$)\n- 可渗透离子的电荷数：Na$^+$ 和 K$^+$ 均为 $z = +1$\n- 温度：$T = 310\\,\\text{K}$\n- 普适气体常数：$R = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n- 法拉第常数：$F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$\n- 任务：确定通道反转电位 $E_{\\text{rev}}$。\n- 约束：从净电流为零的条件出发，引用恒定场近似和离子独立运动原理。\n- 输出要求：以毫伏为单位表示答案，并四舍五入到三位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题坚实地基于电生理学和物理化学的原理。从恒定场和独立性假设推导出的 Goldman-Hodgkin-Katz (GHK) 模型是进行此计算的标准理论框架。对 AMPA 受体离子渗透性的描述以及给定的浓度是哺乳动物神经元的典型特征。该问题在科学上是合理的。\n- **适定性：** 该问题提供了计算唯一反转电位所需的所有必要数据（离子浓度、相对渗透性、温度和物理常数）。指示清晰明确。\n- **客观性：** 该问题以精确的、定量的术语陈述，不含主观语言或观点。\n\n**步骤3：结论与行动**\n\n问题有效。将提供完整解答。\n\n### 解答\n\n反转电位 $E_{\\text{rev}}$ 定义为穿过膜的所有可渗透离子的净电流为零时的膜电位。该问题要求基于恒定场近似和离子独立性原理进行推导。这些假设导出了 Goldman-Hodgkin-Katz (GHK) 电压方程。\n\n通过通道的总电流密度 $J_{\\text{tot}}$ 是每种可渗透离子（在此情况下为钠 ($J_{\\text{Na}}$) 和钾 ($J_{\\text{K}}$)）的单个电流密度的总和。反转电位是使 $J_{\\text{tot}} = J_{\\text{Na}} + J_{\\text{K}} = 0$ 成立的膜电位 $E_m$。\n\n对于一组单价阳离子，通用的 GHK 电压方程给出膜电位 $E_m$ 为：\n$$E_m = \\frac{RT}{F} \\ln \\left( \\frac{\\sum_{i} P_{C_i} [C_i]_{\\text{o}}}{\\sum_{i} P_{C_i} [C_i]_{\\text{i}}} \\right)$$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$F$ 是法拉第常数，$P_{C_i}$ 是第 $i$ 种阳离子 $C_i$ 的渗透性，$[C_i]_{\\text{o}}$ 和 $[C_i]_{\\text{i}}$ 分别是其胞外和胞内浓度。\n\n对于给定的 AMPA 受体通道，该通道仅对 $\\text{Na}^{+}$ 和 $\\text{K}^{+}$ 离子（电荷数均为 $z=+1$）通透，其反转电位 $E_{\\text{rev}}$ 由以下公式给出：\n$$E_{\\text{rev}} = \\frac{RT}{F} \\ln \\left( \\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{o}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{o}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{i}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{i}}} \\right)$$\n\n我们已知以下数值：\n- $R = 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n- $T = 310\\,\\text{K}$\n- $F = 96485\\,\\text{C}\\,\\text{mol}^{-1}$\n- $P_{\\text{Na}} = 1.2$\n- $P_{\\text{K}} = 1.0$\n- $[\\text{Na}^{+}]_{\\text{o}} = 145\\,\\text{mM}$\n- $[\\text{K}^{+}]_{\\text{o}} = 4\\,\\text{mM}$\n- $[\\text{Na}^{+}]_{\\text{i}} = 12\\,\\text{mM}$\n- $[\\text{K}^{+}]_{\\text{i}} = 140\\,\\text{mM}$\n\n首先，我们计算热电压项 $\\frac{RT}{F}$：\n$$\\frac{RT}{F} = \\frac{(8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}) \\times (310\\,\\text{K})}{96485\\,\\text{C}\\,\\text{mol}^{-1}} \\approx 0.026712\\,\\text{V}$$\n\n接下来，我们计算自然对数参数的分子和分母。浓度单位（$\\text{mM}$）会消掉，因此我们可以直接使用数值。\n\n分子为：\n$$P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{o}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{o}} = (1.2 \\times 145) + (1.0 \\times 4) = 174 + 4 = 178$$\n\n分母为：\n$$P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{i}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{i}} = (1.2 \\times 12) + (1.0 \\times 140) = 14.4 + 140 = 154.4$$\n\n现在，将这些值代入 GHK 方程：\n$$E_{\\text{rev}} = \\left( \\frac{RT}{F} \\right) \\ln \\left( \\frac{178}{154.4} \\right)$$\n$$E_{\\text{rev}} \\approx (0.026712\\,\\text{V}) \\times \\ln(1.1528497...)$$\n$$E_{\\text{rev}} \\approx (0.026712\\,\\text{V}) \\times (0.142273...)$$\n$$E_{\\text{rev}} \\approx 0.0038002\\,\\text{V}$$\n\n问题要求答案以毫伏（$\\text{mV}$）为单位。为了从伏特转换为毫伏，我们乘以 $1000$：\n$$E_{\\text{rev}} \\approx 0.0038002 \\times 1000\\,\\text{mV} = 3.8002\\,\\text{mV}$$\n\n最后，四舍五入到三位有效数字，我们得到：\n$$E_{\\text{rev}} = 3.80\\,\\text{mV}$$", "answer": "$$\n\\boxed{3.80}\n$$", "id": "5028003"}, {"introduction": "离子梯度是神经元的“电池”，但它们并非取之不竭；信号传递过程中的离子流动会改变这些梯度。这项高级练习将挑战你建立一个计算模型，模拟短暂的钠离子内流如何改变细胞内浓度，并因此改变钠离子的平衡电位。这个练习提供了一个动态的视角，将静态的平衡概念与活跃神经元中发生的持续变化联系起来 [@problem_id:5028020]。", "problem": "您将编写一个完整、可运行的程序，该程序模拟钠选择性通道群的短暂开放如何改变细胞内钠离子浓度，并因此改变钠平衡电位。该建模必须基于第一性原理：电流是单位时间的电荷量，单价离子通量通过法拉第常数将电荷与摩尔数联系起来，电化学平衡使得理想稀溶液中的电化学势相等。\n\n将使用的假设和定义：\n- 钠是单价的：化合价 $z=+1$。\n- 对于理想稀溶液，活度等于浓度。\n- 开放通道表现为理想欧姆导体，其电流在离子的平衡电位处反转；总电导是开放通道数量乘以单通道电导。\n- 正电流对应于正电荷流出隔室；负电流对应于正电荷流入隔室。\n- 细胞内隔室是混合均匀的，体积为 $V$。\n- 常量：气体常数 $R=8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$，法拉第常数 $F=96485.33212\\,\\mathrm{C\\cdot mol^{-1}}$。\n\n您的程序必须为每个测试用例，从第一性原理出发完成以下所有任务：\n1) 根据理想稀溶液中单价离子的电化学平衡，推导出钠平衡电位 $E_{\\mathrm{Na}}$ 的表达式，该表达式依赖于温度 $T$ 以及瞬时的细胞内和细胞外钠离子浓度。然后在整个模拟过程中计算瞬时 $E_{\\mathrm{Na}}(t)$。\n2) 使用电流是单位时间电荷量的定义以及单价离子的电荷与摩尔数之间的关系，推导当一组钠通道开放有限时间段时，细胞内钠离子浓度 $[{\\mathrm{Na}}^+]_i(t)$ 的时间演化。假设膜电位 $V_m$ 保持恒定（电压钳）。\n3) 在开放区间上使用固定的时间步长 $\\Delta t$ 进行时间积分，以更新 $[{\\mathrm{Na}}^+]_i(t)$，并从而更新 $E_{\\mathrm{Na}}(t)$，使用与上述第一性原理关系一致的显式方法。\n4) 在通道关闭后，报告由最终的 $[{\\mathrm{Na}}^+]_i$ 和给定的 $[{\\mathrm{Na}}^+]_o$ 及 $T$ 计算得出的最终钠平衡电位 $E_{\\mathrm{Na,final}}$。\n\n物理和数值单位：\n- 浓度单位必须是 $\\mathrm{mol\\cdot L^{-1}}$。\n- 体积单位必须是 $\\mathrm{L}$。\n- 温度单位必须是 $\\mathrm{K}$。\n- 电导单位必须是 $\\mathrm{S}$。\n- 膜电位和平衡电位单位必须是 $\\mathrm{V}$；但是，要求的输出单位是 $\\mathrm{mV}$。\n- 时间单位必须是 $\\mathrm{s}$。\n\n符号约定和建模关系（需使用第一性原理实现，而非作为给定公式使用）：将总钠通道电流定义为总电导与驱动力的乘积，正号表示正电荷外流。使用 $z=+1$ 的电荷-摩尔转换关系，将细胞内钠摩尔数的变化率与电流联系起来，并通过隔室体积将摩尔数与浓度联系起来。\n\n数值积分要求：\n- 在持续时间为 $\\tau_{\\mathrm{open}}$ 的开放区间内，使用固定的时间步长 $\\Delta t$ 来推进细胞内浓度的计算。选择更新方式，使得更多的内向（负）电流增加 $[{\\mathrm{Na}}^+]_i$，而外向（正）电流减少它。\n- 确保在计算过程中细胞内浓度保持为正。\n\n测试套件：\n每个测试用例是一个元组，其字段\n$\\left([{\\mathrm{Na}}^+]_{i0}, [{\\mathrm{Na}}^+]_o, T, V, N_{\\mathrm{open}}, g_{\\mathrm{single}}, V_m, \\tau_{\\mathrm{open}}, \\Delta t, \\mathrm{VmEqualsENa0}\\right)$\n按以下顺序排列：\n- $[{\\mathrm{Na}}^+]_{i0}$，单位为 $\\mathrm{mol\\cdot L^{-1}}$，\n- $[{\\mathrm{Na}}^+]_o$，单位为 $\\mathrm{mol\\cdot L^{-1}}$，\n- $T$，单位为 $\\mathrm{K}$，\n- $V$，单位为 $\\mathrm{L}$，\n- $N_{\\mathrm{open}}$（整数计数），\n- $g_{\\mathrm{single}}$，单位为 $\\mathrm{S}$，\n- $V_m$，单位为 $\\mathrm{V}$，\n- $\\tau_{\\mathrm{open}}$，单位为 $\\mathrm{s}$，\n- $\\Delta t$，单位为 $\\mathrm{s}$，\n- $\\mathrm{VmEqualsENa0}$ 是一个布尔标志：如果为真，则忽略提供的 $V_m$，而是将 $V_m$ 设置为由 $[{\\mathrm{Na}}^+]_{i0}$、$[{\\mathrm{Na}}^+]_o$ 和 $T$ 所隐含的初始平衡电位。\n\n提供以下确切的测试用例：\n- 用例 1：$\\left(0.012,\\,0.145,\\,310.0,\\,1.0\\times 10^{-15},\\,10,\\,1.0\\times 10^{-11},\\,-0.065,\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-6},\\,\\text{False}\\right)$。\n- 用例 2：$\\left(0.012,\\,0.145,\\,310.0,\\,1.0\\times 10^{-15},\\,0,\\,1.0\\times 10^{-11},\\,-0.065,\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-6},\\,\\text{False}\\right)$。\n- 用例 3：$\\left(0.012,\\,0.145,\\,310.0,\\,1.0\\times 10^{-15},\\,50,\\,1.0\\times 10^{-11},\\,0.0,\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-6},\\,\\text{True}\\right)$。\n- 用例 4：$\\left(0.012,\\,0.145,\\,310.0,\\,1.0\\times 10^{-18},\\,10,\\,1.0\\times 10^{-11},\\,-0.065,\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-7},\\,\\text{False}\\right)$。\n- 用例 5：$\\left(0.012,\\,0.145,\\,310.0,\\,1.0\\times 10^{-15},\\,10,\\,1.0\\times 10^{-11},\\,0.10,\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-6},\\,\\text{False}\\right)$。\n\n答案规格：\n- 对于每个测试用例，您的程序必须输出最终的钠平衡电位 $E_{\\mathrm{Na,final}}$，单位为 $\\mathrm{mV}$，并四舍五入到恰好六位小数。\n- 最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，例如 $\\left[\\text{result}_1,\\text{result}_2,\\ldots\\right]$，不含空格。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$）。每个 $\\text{result}_k$ 必须是一个浮点数，单位为 $\\mathrm{mV}$，并四舍五入到六位小数。", "solution": "该问题要求开发一个数值模型，以模拟由钠选择性通道的离子电流引起的细胞内钠离子浓度 $[{\\mathrm{Na}}^+]_i$ 和相应的钠平衡电位 $E_{\\mathrm{Na}}$ 的变化。该解决方案源自应用于神经生物学的电化学和电路理论的第一性原理。\n\n**1. 钠平衡电位（$E_{\\mathrm{Na}}$）的推导**\n\n离子的平衡电位是指跨膜该离子的净流量为零时的膜电位。当移动一个离子穿过膜所需的电功与浓度梯度所做的化学功大小相等、方向相反时，此条件得以满足。离子种类 $j$ 的电化学势 $\\mu_j$ 由下式给出：\n\n$$ \\mu_j = \\mu_j^0 + RT \\ln(a_j) + z_j F V $$\n\n其中 $\\mu_j^0$ 是标准化学势，$R$ 是普适气体常数（$8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$），$T$ 是以开尔文为单位的绝对温度，$a_j$ 是离子的化学活度，$z_j$ 是其化合价，$F$ 是法拉第常数（$96485.33212\\,\\mathrm{C\\cdot mol^{-1}}$），$V$ 是隔室的电势。\n\n在平衡状态下，细胞内钠的电化学势 $\\mu_{\\mathrm{Na,i}}$ 必须等于细胞外钠的电化学势 $\\mu_{\\mathrm{Na,o}}$：\n\n$$ \\mu_{\\mathrm{Na,i}} = \\mu_{\\mathrm{Na,o}} $$\n$$ \\mu_{\\mathrm{Na}}^0 + RT \\ln(a_{\\mathrm{Na,i}}) + z_{\\mathrm{Na}} F V_i = \\mu_{\\mathrm{Na}}^0 + RT \\ln(a_{\\mathrm{Na,o}}) + z_{\\mathrm{Na}} F V_o $$\n\n标准电势 $\\mu_{\\mathrm{Na}}^0$ 被消去。重新排列各项以求解跨膜电位差 $V_m = V_i - V_o$，在平衡时即为平衡电位 $E_{\\mathrm{Na}}$：\n\n$$ z_{\\mathrm{Na}} F (V_i - V_o) = RT (\\ln(a_{\\mathrm{Na,o}}) - \\ln(a_{\\mathrm{Na,i}})) $$\n$$ z_{\\mathrm{Na}} F E_{\\mathrm{Na}} = RT \\ln\\left(\\frac{a_{\\mathrm{Na,o}}}{a_{\\mathrm{Na,i}}}\\right) $$\n\n问题陈述，对于理想稀溶液，活度可以用摩尔浓度（$a_j = [j]$）代替，并且钠是单价阳离子（$z_{\\mathrm{Na}} = +1$）。这得出了钠的能斯特方程：\n\n$$ E_{\\mathrm{Na}}(t) = \\frac{RT}{F} \\ln\\left(\\frac{[{\\mathrm{Na}}^+]_o}{[{\\mathrm{Na}}^+]_i(t)}\\right) $$\n\n该方程允许根据细胞内和细胞外钠浓度以及温度计算瞬时钠平衡电位。\n\n**2. 细胞内钠浓度时间演化的推导**\n\n细胞内钠浓度随时间的变化由穿过细胞膜的钠离子通量决定。该通量由电流 $I_{\\mathrm{Na}}$ 表示。\n\n首先，使用欧姆定律对钠电流 $I_{\\mathrm{Na}}$ 进行建模。开放通道提供总电导 $G_{\\mathrm{Na}}$，净驱动力是膜电位 $V_m$ 和钠平衡电位 $E_{\\mathrm{Na}}$ 之间的差值。对于正电荷的外向流动，电流为正：\n\n$$ I_{\\mathrm{Na}}(t) = G_{\\mathrm{Na}} (V_m - E_{\\mathrm{Na}}(t)) $$\n\n总电导 $G_{\\mathrm{Na}}$ 是开放通道数 $N_{\\mathrm{open}}$ 与单通道电导 $g_{\\mathrm{single}}$ 的乘积：\n\n$$ G_{\\mathrm{Na}} = N_{\\mathrm{open}} \\cdot g_{\\mathrm{single}} $$\n\n其次，电流定义为电荷流动的速率，$I = dQ/dt$。一个外向电流 $I_{\\mathrm{Na}}$ 对应于正电荷离开细胞的速率。因此，进入细胞的电荷速率是 $-I_{\\mathrm{Na}}(t)$。\n\n第三，法拉第常数 $F$ 通过 $Q = n z F$ 将电荷 $Q$ 与化合价为 $z$ 的离子的摩尔数 $n$ 联系起来。对于钠（$z=+1$），单位时间进入细胞的钠摩尔数与流入的电荷流相关：\n\n$$ \\frac{dn_{\\mathrm{Na,i}}}{dt} = \\frac{-I_{\\mathrm{Na}}(t)}{z_{\\mathrm{Na}} F} = \\frac{-I_{\\mathrm{Na}}(t)}{F} $$\n\n第四，对于一个体积恒定为 $V$ 且混合均匀的细胞内隔室，钠的摩尔数为 $n_{\\mathrm{Na,i}}(t) = [{\\mathrm{Na}}^+]_i(t) \\cdot V$。对时间求导得出：\n\n$$ \\frac{dn_{\\mathrm{Na,i}}}{dt} = V \\frac{d[{\\mathrm{Na}}^+]_i}{dt} $$\n\n通过令 $dn_{\\mathrm{Na,i}}/dt$ 的两个表达式相等，我们得到细胞内钠浓度的常微分方程（ODE）：\n\n$$ V \\frac{d[{\\mathrm{Na}}^+]_i}{dt} = \\frac{-I_{\\mathrm{Na}}(t)}{F} = -\\frac{G_{\\mathrm{Na}}}{F} (V_m - E_{\\mathrm{Na}}(t)) $$\n$$ \\frac{d[{\\mathrm{Na}}^+]_i}{dt} = -\\frac{N_{\\mathrm{open}} \\cdot g_{\\mathrm{single}}}{V \\cdot F} \\left(V_m - \\frac{RT}{F} \\ln\\left(\\frac{[{\\mathrm{Na}}^+]_o}{[{\\mathrm{Na}}^+]_i(t)}\\right)\\right) $$\n\n这个方程描述了当通道打开时 $[{\\mathrm{Na}}^+]_i$ 如何随时间变化。\n\n**3. 数值积分方法**\n\n问题要求使用固定的时间步长 $\\Delta t$ 在有限时间间隔 $\\tau_{\\mathrm{open}}$ 内数值求解此 ODE。我们将使用显式前向欧拉法。令 $[{\\mathrm{Na}}^+]_i^k$ 表示在时间步 $k$ 时的细胞内钠浓度。下一个时间步 $k+1$ 的浓度近似为：\n\n$$ [{\\mathrm{Na}}^+]_i^{k+1} = [{\\mathrm{Na}}^+]_i^k + \\Delta t \\cdot \\left(\\frac{d[{\\mathrm{Na}}^+]_i}{dt}\\right)\\bigg|_{t=k\\Delta t} $$\n\n代入导数的表达式：\n\n$$ [{\\mathrm{Na}}^+]_i^{k+1} = [{\\mathrm{Na}}^+]_i^k - \\Delta t \\cdot \\frac{G_{\\mathrm{Na}}}{V \\cdot F} (V_m - E_{\\mathrm{Na}}^k) $$\n\n其中 $E_{\\mathrm{Na}}^k$ 是使用 $[{\\mathrm{Na}}^+]_i^k$ 计算出的平衡电位：\n\n$$ E_{\\mathrm{Na}}^k = \\frac{RT}{F} \\ln\\left(\\frac{[{\\mathrm{Na}}^+]_o}{[{\\mathrm{Na}}^+]_i^k}\\right) $$\n\n此更新规则被迭代应用。\n\n**4. 算法摘要**\n\n对每个测试用例，执行以下步骤：\n1.  初始化常数 $R = 8.314462618\\,\\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$ 和 $F = 96485.33212\\,\\mathrm{C\\cdot mol^{-1}}$。\n2.  解包测试用例参数：初始细胞内钠浓度 $[{\\mathrm{Na}}^+]_{i0}$，细胞外钠浓度 $[{\\mathrm{Na}}^+]_o$，温度 $T$，体积 $V$，开放通道数 $N_{\\mathrm{open}}$，单通道电导 $g_{\\mathrm{single}}$，膜电位 $V_m$，通道开放持续时间 $\\tau_{\\mathrm{open}}$，以及时间步长 $\\Delta t$。\n3.  处理 `VmEqualsENa0` 标志：如果为 `True`，计算初始平衡电位 $E_{\\mathrm{Na,0}} = \\frac{RT}{F} \\ln([{\\mathrm{Na}}^+]_o / [{\\mathrm{Na}}^+]_{i0})$ 并设置 $V_m = E_{\\mathrm{Na,0}}$。\n4.  计算总积分步数，$N_{\\mathrm{steps}} = \\mathrm{round}(\\tau_{\\mathrm{open}} / \\Delta t)$。\n5.  将当前细胞内钠浓度 $[{\\mathrm{Na}}^+]_i$ 设置为其初始值 $[{\\mathrm{Na}}^+]_{i0}$。\n6.  迭代 $N_{\\mathrm{steps}}$ 次：\n    a. 使用当前的 $[{\\mathrm{Na}}^+]_i$ 计算当前平衡电位 $E_{\\mathrm{Na}}$。\n    b. 计算总钠电流 $I_{\\mathrm{Na}} = N_{\\mathrm{open}} \\cdot g_{\\mathrm{single}} \\cdot (V_m - E_{\\mathrm{Na}})$。\n    c. 计算在时间步长 $\\Delta t$ 内钠摩尔浓度的变化：$\\Delta[{\\mathrm{Na}}^+]_i = -I_{\\mathrm{Na}} \\cdot \\Delta t / (V \\cdot F)$。\n    d. 更新浓度：$[{\\mathrm{Na}}^+]_i = [{\\mathrm{Na}}^+]_i + \\Delta[{\\mathrm{Na}}^+]_i$。\n7.  循环结束后，最终浓度为 $[{\\mathrm{Na}}^+]_{i, \\mathrm{final}}$。\n8.  计算最终平衡电位 $E_{\\mathrm{Na,final}} = \\frac{RT}{F} \\ln([{\\mathrm{Na}}^+]_o / [{\\mathrm{Na}}^+]_{i, \\mathrm{final}})$。\n9.  将 $E_{\\mathrm{Na,final}}$ 从伏特（V）转换为毫伏（mV），即乘以 $1000$，并格式化结果。\n\n此过程应用于每个测试用例，以生成最终报告的值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the final sodium equilibrium potential based on a simulation of\n    ion channel activity, derived from first principles.\n    \"\"\"\n    # Define physical constants as specified\n    R = 8.314462618  # Universal gas constant in J·mol⁻¹·K⁻¹\n    F = 96485.33212  # Faraday constant in C·mol⁻¹\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # ([Na+]_i0, [Na+]_o, T, V, N_open, g_single, V_m, tau_open, dt, VmEqualsENa0)\n        # Case 1: Standard influx\n        (0.012, 0.145, 310.0, 1.0e-15, 10, 1.0e-11, -0.065, 1.0e-3, 1.0e-6, False),\n        # Case 2: Control with no open channels\n        (0.012, 0.145, 310.0, 1.0e-15, 0, 1.0e-11, -0.065, 1.0e-3, 1.0e-6, False),\n        # Case 3: Control with Vm set to initial E_Na\n        (0.012, 0.145, 310.0, 1.0e-15, 50, 1.0e-11, 0.0, 1.0e-3, 1.0e-6, True),\n        # Case 4: Larger concentration change due to small volume\n        (0.012, 0.145, 310.0, 1.0e-18, 10, 1.0e-11, -0.065, 1.0e-3, 1.0e-7, False),\n        # Case 5: Outward current (efflux)\n        (0.012, 0.145, 310.0, 1.0e-15, 10, 1.0e-11, 0.10, 1.0e-3, 1.0e-6, False),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        Na_i_0, Na_o, T, V, N_open, g_single, Vm, tau_open, dt, VmEqualsENa0 = case\n\n        # Initialize intracellular sodium concentration from the test case\n        Na_i = Na_i_0\n        \n        # Handle the VmEqualsENa0 flag: if True, Vm is set to the initial E_Na\n        if VmEqualsENa0:\n            if Na_i > 0:\n                E_Na_initial = (R * T / F) * np.log(Na_o / Na_i)\n                Vm = E_Na_initial\n\n        # Calculate total conductance\n        G_Na = N_open * g_single\n\n        # The number of steps is the total open time divided by the time step.\n        # Use round() to mitigate potential floating-point inaccuracies.\n        num_steps = int(round(tau_open / dt))\n\n        # Simulate over the open interval using the explicit forward Euler method\n        for _ in range(num_steps):\n            # Ensure intracellular concentration remains positive for the Nernst equation\n            if Na_i = 0:\n                break\n                \n            # 1. Calculate the instantaneous sodium equilibrium potential (Nernst equation)\n            E_Na = (R * T / F) * np.log(Na_o / Na_i)\n            \n            # 2. Calculate the total sodium current (Ohm's law)\n            # Positive current is outward flow of positive charge.\n            I_Na = G_Na * (Vm - E_Na)\n            \n            # 3. Calculate the change in intracellular sodium concentration\n            # d[Na_i]/dt = -I_Na / (V * F)\n            # Integrate over one time step: delta_[Na_i] = dt * d[Na_i]/dt\n            delta_Na_i = -I_Na * dt / (V * F)\n\n            # 4. Update the intracellular sodium concentration\n            Na_i += delta_Na_i\n\n        # After the simulation, calculate the final equilibrium potential\n        Na_i_final = Na_i\n        \n        E_Na_final = np.nan # Default to NaN if concentration becomes non-positive\n        if Na_i_final > 0:\n            E_Na_final = (R * T / F) * np.log(Na_o / Na_i_final)\n\n        # Convert the final potential from Volts to millivolts\n        E_Na_final_mV = E_Na_final * 1000.0\n        results.append(E_Na_final_mV)\n\n    # Format the results to exactly six decimal places as strings\n    results_str = [f\"{res:.6f}\" for res in results]\n    \n    # Print the final output in the specified single-line format\n    print(f\"[{','.join(results_str)}]\")\n\n# Execute the main solver function\nsolve()\n```", "id": "5028020"}]}