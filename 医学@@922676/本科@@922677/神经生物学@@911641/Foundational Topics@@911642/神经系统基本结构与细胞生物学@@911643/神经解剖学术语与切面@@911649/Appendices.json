{"hands_on_practices": [{"introduction": "为了分析大脑结构，我们必须首先建立一个清晰且明确的坐标系。本练习将神经解剖学中用于切面（矢状面、冠状面和轴状面）的抽象术语，与解析几何的具体语言联系起来。通过推导这些基本平面的方程，你将巩固对大脑空间关系如何被正式描述的理解，这是解读神经影像数据的关键第一步。[@problem_id:5040436]", "problem": "在神经解剖学中，常规切面是相对于与生物体方向相关的规范轴来定义的。考虑一个笛卡尔坐标系，其坐标轴与人体神经解剖学方向对齐：$x$轴向右（从左到右）增加，$y$轴向前（从后到前）增加，$z$轴向上（从下到上）增加。这是右-前-上（RAS）约定。根据定义，矢状面划分左右并与左右轴正交，冠状面（额状面）划分前后并与前后轴正交，轴状面（横断面）划分上下并与上下轴正交。假设原点位于正中矢状面、正中冠状面和正中轴状面相交的唯一点。\n\n仅使用以下核心几何事实：与坐标轴正交的平面其法向量与该轴平行，且任何平面都可以写成 $a x + b y + c z + d = 0$ 的形式，其法向量为 $(a,b,c)$。请在此坐标系中推导正中矢状面、正中冠状面和正中轴状面的显式平面方程，并列出每种情况下对应的元组 $(a,b,c,d)$。然后，构建一个 $3 \\times 3$ 矩阵，其行按顺序分别是矢状面、冠状面和轴状面的法向量，并计算其行列式。请将行列式作为最终答案。如果需要近似值，则应四舍五入到四位有效数字，但此处应给出精确值。无需单位。", "solution": "首先对问题陈述进行验证过程，以确保其科学性和逻辑完整性。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 坐标系：右-前-上（RAS）笛卡尔坐标系。\n- $x$轴：与从左到右方向对齐，向右增加。\n- $y$轴：与从后到前方向对齐，向前增加。\n- $z$轴：与从下到上方向对齐，向上增加。\n- 原点 $(0,0,0)$：正中矢状面、正中冠状面和正中轴状面的交点。\n- 矢状面：与左右轴正交。\n- 冠状面：与前后轴正交。\n- 轴状面：与上下轴正交。\n- 通用平面方程：$a x + b y + c z + d = 0$。\n- 法向量：$\\vec{n} = (a, b, c)$。\n- 几何前提：与坐标轴正交的平面其法向量与该轴平行。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地基于标准的神经解剖学和数学原理。RAS坐标系是医学成像中广泛使用的约定（例如，在NIfTI数据格式中）。矢状面、冠状面和轴状面作为相互正交的平面的定义是正确的。使用法向量和方程 $a x + b y + c z + d = 0$ 来表示平面是解析几何中的一个基本概念。该问题在科学上是合理的。\n- **适定性：** 该问题是无歧义且自洽的。它提供了建立坐标系和平面几何属性所需的所有定义。推导平面方程并计算行列式的任务是明确的，并导向一个唯一的、稳定的解。\n- **客观性：** 该问题以精确、客观的语言陈述，不含任何主观或基于意见的主张。\n\n**步骤3：结论与行动**\n该问题被认为是**有效的**，因为它具有科学依据、适定性和客观性。不存在矛盾、歧义或事实错误。可以继续进行求解过程。\n\n**平面方程推导与行列式计算**\n\n任务是推导三个主要神经解剖学平面的方程，然后计算由它们的法向量构成的矩阵的行列式。设平面的通用形式为 $ax + by + cz + d = 0$，其中 $\\vec{n} = (a,b,c)$ 是平面的法向量。\n\n1.  **正中矢状面：**\n    根据定义，矢状面与左右轴正交。在给定的RAS坐标系中，左右轴是 $x$轴。与 $x$轴正交的平面必须有一个与 $x$轴平行的法向量。$x$轴的方向向量是 $(1,0,0)$。因此，我们可以选择矢状面的法向量为 $\\vec{n}_{sag} = (a,b,c) = (1,0,0)$。任何非零标量倍数，例如对于 $k \\in \\mathbb{R}, k \\neq 0$ 的 $(k,0,0)$，也是平行的，但 $(1,0,0)$ 是最简单和最规范的选择。\n\n    因此，该平面的方程为 $1 \\cdot x + 0 \\cdot y + 0 \\cdot z + d = 0$，简化为 $x + d = 0$。\n    问题指定的是*正中矢状面*，根据定义，它通过原点 $(0,0,0)$。将原点坐标代入平面方程得出：\n    $0 + d = 0 \\implies d = 0$。\n    因此，正中矢状面的方程是 $x = 0$。对应的系数元组是 $(a,b,c,d) = (1,0,0,0)$。\n\n2.  **正中冠状面：**\n    冠状面被定义为与从后到前轴正交。这在我们的坐标系中对应于 $y$轴。与 $y$轴正交的平面有一个与 $y$轴平行的法向量。我们选择法向量为 $y$方向的单位向量，$\\vec{n}_{cor} = (a,b,c) = (0,1,0)$。\n\n    该平面的方程变为 $0 \\cdot x + 1 \\cdot y + 0 \\cdot z + d = 0$，简化为 $y + d = 0$。\n    *正中冠状面*也必须通过原点 $(0,0,0)$。代入这些坐标：\n    $0 + d = 0 \\implies d = 0$。\n    因此，正中冠状面的方程是 $y = 0$。对应的系数元组是 $(a,b,c,d) = (0,1,0,0)$。\n\n3.  **正中轴状面：**\n    轴状面被定义为与从下到上轴正交，也就是 $z$轴。这样一个平面的法向量必须与 $z$轴平行。我们选择法向量为 $z$方向的单位向量，$\\vec{n}_{ax} = (a,b,c) = (0,0,1)$。\n\n    该平面的方程是 $0 \\cdot x + 0 \\cdot y + 1 \\cdot z + d = 0$，或 $z + d = 0$。\n    *正中轴状面*包含原点 $(0,0,0)$。代入：\n    $0 + d = 0 \\implies d = 0$。\n    正中轴状面的方程是 $z = 0$。对应的系数元组是 $(a,b,c,d) = (0,0,1,0)$。\n\n4.  **矩阵构建与行列式计算：**\n    问题要求构建一个 $3 \\times 3$ 的矩阵，我们称之为 $M$，其行按顺序分别是矢状面、冠状面和轴状面的法向量。\n    - 第1行：$\\vec{n}_{sag} = (1,0,0)$\n    - 第2行：$\\vec{n}_{cor} = (0,1,0)$\n    - 第3行：$\\vec{n}_{ax} = (0,0,1)$\n\n    得到的矩阵是：\n    $$M = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n    这是 $3 \\times 3$ 的单位矩阵 $I_{3}$。任何维度的单位矩阵的行列式都是 $1$。我们也可以使用沿第一行的代数余子式展开直接计算它：\n    $$\\det(M) = 1 \\cdot \\begin{vmatrix} 1  0 \\\\ 0  1 \\end{vmatrix} - 0 \\cdot \\begin{vmatrix} 0  0 \\\\ 0  1 \\end{vmatrix} + 0 \\cdot \\begin{vmatrix} 0  1 \\\\ 0  0 \\end{vmatrix}$$\n    $$\\det(M) = 1 \\cdot (1 \\cdot 1 - 0 \\cdot 0) - 0 + 0 = 1$$\n    行列式恰好是 $1$。法向量构成一个标准正交基（因此这些向量构成的矩阵是单位矩阵）这一事实，是建立一个与相互正交的解剖平面相符的笛卡尔坐标系的直接逻辑结果。", "answer": "$$\\boxed{1}$$", "id": "5040436"}, {"introduction": "虽然标准解剖平面是重要的参考，但临床和研究中的图像通常是倾斜获取的，从而产生“斜切”面。本练习将演示如何量化这种切面相对于标准平面的方向。掌握这项技术使你能够精确描述任何切面方向，从定性描述转向可重复科学测量所必需的定量分析。[@problem_id:5040409]", "problem": "在神经解剖学中，标准冠状面划分前部和后部区域，并与前后轴正交。考虑一个与标准神经解剖轴对齐的右手笛卡尔坐标系：$x$轴从左到右递增，$y$轴从后到前递增，$z$轴从下到上递增。在此坐标系中，标准冠状面的单位法向量为 $\\mathbf{n}_{\\text{cor}} = (0, 1, 0)$。一位研究人员获取了一个斜向磁共振成像（MRI）切片，其所在平面由法向量 $\\mathbf{n} = (1, 2, 2)$ 描述（该向量不一定是单位向量）。\n\n仅使用向量、点积和解剖平面的基本定义，推导切片平面与标准冠状面之间夹角 $\\theta$ 的精确表达式，并计算 $\\theta$。将最终角度以弧度表示为一个闭式解析表达式（不进行四舍五入）。然后，解释 $\\theta$ 的大小在解剖学上的意义，即该切片如何偏离一个完美的冠状切面。", "solution": "该问题被认为是有效的，因为它以向量数学和标准神经解剖学惯例为科学基础，是适定的，具有唯一且稳定的解，并使用客观、精确的语言进行陈述。所有必要信息均已提供，不存在矛盾或歧义。\n\n两个平面之间的夹角定义为其各自法向量之间的锐角。设两个平面为 $P_1$ 和 $P_2$，法向量分别为 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$。这两个平面之间的夹角 $\\theta$ 可由点积定义推导出的公式给出：\n$$\n\\cos(\\theta) = \\frac{|\\mathbf{n}_1 \\cdot \\mathbf{n}_2|}{\\|\\mathbf{n}_1\\| \\|\\mathbf{n}_2\\|}\n$$\n其中 $\\theta$ 的范围是 $[0, \\frac{\\pi}{2}]$。\n\n根据问题陈述，我们已知标准冠状面和斜向MRI切片平面的法向量。\n\n标准冠状面的法向量是一个单位向量：\n$$\n\\mathbf{n}_{\\text{cor}} = (0, 1, 0)\n$$\n斜向切片平面的法向量是：\n$$\n\\mathbf{n} = (1, 2, 2)\n$$\n\n首先，我们计算两个法向量的点积 $\\mathbf{n}_{\\text{cor}} \\cdot \\mathbf{n}$：\n$$\n\\mathbf{n}_{\\text{cor}} \\cdot \\mathbf{n} = (0)(1) + (1)(2) + (0)(2) = 0 + 2 + 0 = 2\n$$\n\n接下来，我们计算每个向量的模（范数）。\n$\\mathbf{n}_{\\text{cor}}$ 的模是：\n$$\n\\|\\mathbf{n}_{\\text{cor}}\\| = \\sqrt{0^2 + 1^2 + 0^2} = \\sqrt{1} = 1\n$$\n这证实了问题陈述中 $\\mathbf{n}_{\\text{cor}}$ 是一个单位向量的说法。\n\n$\\mathbf{n}$ 的模是：\n$$\n\\|\\mathbf{n}\\| = \\sqrt{1^2 + 2^2 + 2^2} = \\sqrt{1 + 4 + 4} = \\sqrt{9} = 3\n$$\n\n现在，我们将这些值代入夹角 $\\theta$ 的余弦公式中：\n$$\n\\cos(\\theta) = \\frac{|\\mathbf{n}_{\\text{cor}} \\cdot \\mathbf{n}|}{\\|\\mathbf{n}_{\\text{cor}}\\| \\|\\mathbf{n}\\|} = \\frac{|2|}{(1)(3)} = \\frac{2}{3}\n$$\n由于余弦值为正，向量之间的夹角已经是锐角，因此在这种特定情况下，绝对值运算是多余的。\n\n为了求出以弧度表示的角 $\\theta$，我们取该值的反余弦：\n$$\n\\theta = \\arccos\\left(\\frac{2}{3}\\right)\n$$\n这就是两个平面之间夹角的精确、闭式解析表达式。\n\n$\\theta$ 大小的解剖学意义在于，它量化了斜向MRI切片偏离真实冠状切面的程度。\n\n一个完美的冠状切片其夹角应为 $\\theta = 0$ 弧度。这种情况发生在其法向量与 $\\mathbf{n}_{\\text{cor}} = (0, 1, 0)$ 平行时。\n\n夹角 $\\theta = \\frac{\\pi}{2}$ 弧度表示该切片平面与冠状面正交。此类平面的例子包括矢状面（法向量通常与 $x$ 轴对齐）和轴状面（或水平面）（法向量与 $z$ 轴对齐）。\n\n计算出的角度 $\\theta = \\arccos\\left(\\frac{2}{3}\\right)$ 是一个介于 $0$ 和 $\\frac{\\pi}{2}$ 之间的中间值，表明该切片是“斜向的”。此角度的大小是衡量该切片相对于标准冠状视图倾斜程度的单一综合度量。\n\n通过检查法向量 $\\mathbf{n} = (1, 2, 2)$ 的分量，可以理解这种倾斜的性质。标准冠状面的法向量 $\\mathbf{n}_{\\text{cor}} = (0, 1, 0)$ 仅在 $y$ 轴（后-前）方向上有分量。而斜向切片的法向量在 $x$ 轴（左-右）和 $z$ 轴（下-上）方向上还有额外的分量。\n\\begin{itemize}\n    \\item 非零的 $x$ 分量（$1$）表示相对于矢状面存在倾斜。具体来说，由 $x + 2y + 2z = d$（其中 $d$ 为常数）定义的平面是倾斜的，使得对于固定的 $z$，当 $x$ 增加（向右移动）时，$y$ 必须减少（向后移动）。这意味着切片的方向是从左前延伸到右后。\n    \\item 非零的 $z$ 分量（$2$）表示相对于轴状面存在倾斜。对于固定的 $x$，当 $z$ 增加（向上移动）时，$y$ 必须减少（向后移动）。这意味着切片的方向也是从下前延伸到上后。\n\\end{itemize}\n因此，角度 $\\theta = \\arccos\\left(\\frac{2}{3}\\right)$ 代表了复合倾斜的总角幅度：相对于真实的冠状面，该切片平面在其右侧向后倾斜，并且在其上侧也向后倾斜。一个更大的 $\\theta$ 值将意味着与标准解剖平面更严重的偏离。", "answer": "$$\\boxed{\\arccos\\left(\\frac{2}{3}\\right)}$$", "id": "5040409"}, {"introduction": "在神经影像学领域，你会遇到不同的数据显示约定，最著名的是神经学视角和放射学视角，它们在左右方向上有所不同。本练习旨在解决在两个标准坐标系之间转换坐标的关键任务。通过构建一个变换矩阵，你将学习到翻转和重定向大脑图像背后的数学基础，这是图像分析软件和临床实践中常见且必要的操作。[@problem_id:5040383]", "problem": "一个三维脑部图像容积在神经解剖学中两种公认的显示约定下被采集和可视化：放射学约定和神经学约定。坐标是相对于位于前連合（AC）的共享原点报告的。基本定义如下：在神经学约定中，坐标轴满足$x_{N}$向患者左侧递增，$y_{N}$向前方递增，$z_{N}$向上方递增。在放射学约定中，显示相对于神经学约定是左右翻转的，因此$x_{R}$向患者右侧递增，而$y_{R}$和$z_{R}$分别向前方和上方递增。您被告知两个坐标系都使用相同的毫米线性尺度，并且两个坐标系的原点都是AC。\n\n使用上述基本定义以及坐标系之间的刚性映射可以表示为齐次坐标中的旋转（可能包括关于一个平面的奇偶反转）和平移这一事实，构建一个$4 \\times 4$的旋转-平移矩阵$\\mathbf{T}$（在齐次坐标中），该矩阵将放射学坐标系中表示的坐标映射到神经学坐标系。也就是说，对于一个以齐次形式写为$(x_{R},\\,y_{R},\\,z_{R},\\,1)$的放射学坐标，映射后的神经学坐标为$(x_{N},\\,y_{N},\\,z_{N},\\,1) = \\mathbf{T}\\,(x_{R},\\,y_{R},\\,z_{R},\\,1)$。\n\n使用三个不对称的神经解剖学标志点来验证您派生的映射，这些标志点的位置在每种约定下都是独立测量的。放射学坐标（单位为毫米）如下：\n- 左侧颞平面质心：$\\left(-18,\\, -12,\\, 8\\right)$，\n- 右侧颞平面质心：$\\left(22,\\, -10,\\, 9\\right)$，\n- 左侧Broca区中心：$\\left(-50,\\, 20,\\, 10\\right)$。\n\n相同标志点的神经学坐标（单位为毫米）如下：\n- 左侧颞平面质心：$\\left(18,\\, -12,\\, 8\\right)$，\n- 右侧颞平面质心：$\\left(-22,\\, -10,\\, 9\\right)$，\n- 左侧Broca区中心：$\\left(50,\\, 20,\\, 10\\right)$。\n\n将您的最终答案表示为完整的$4 \\times 4$齐次旋转-平移矩阵$\\mathbf{T}$。无需四舍五入。矩阵项中不包含单位。", "solution": "此问题基于神经影像学中的标准坐标系约定，在科学上是合理的且适定的。我们将推导一个齐次变换矩阵 $\\mathbf{T}$，用于将放射学坐标转换为神经学坐标。\n\n**1. 坐标系关系分析**\n\n齐次变换矩阵 $\\mathbf{T}$ 的一般形式为：\n$$\n\\mathbf{T} = \\begin{pmatrix}\n\\mathbf{R} & \\mathbf{t} \\\\\n\\mathbf{0}^T & 1\n\\end{pmatrix}\n$$\n其中 $\\mathbf{R}$ 是一个 $3 \\times 3$ 的旋转/反射矩阵，$\\mathbf{t}$ 是一个 $3 \\times 1$ 的平移向量。\n\n*   **平移 ($\\mathbf{t}$):** 问题陈述指出，两个坐标系共享同一个原点（前連合）。这意味着从一个坐标系到另一个坐标系没有平移。因此，平移向量是零向量：$\\mathbf{t} = (0, 0, 0)^T$。\n\n*   **旋转/反射 ($\\mathbf{R}$):** 我们需要确定坐标轴之间的关系来构建矩阵 $\\mathbf{R}$。\n    *   **$x$ 轴:** 神经学约定中，$x_N$ 轴向患者**左侧**递增。放射学约定中，$x_R$ 轴向患者**右侧**递增。“左”与“右”方向相反，因此 $x_N = -x_R$。\n    *   **$y$ 轴:** 两个约定中，$y_N$ 和 $y_R$ 轴均向**前方**递增。方向相同，因此 $y_N = y_R$。\n    *   **$z$ 轴:** 两个约定中，$z_N$ 和 $z_R$ 轴均向**上方**递增。方向相同，因此 $z_N = z_R$。\n\n这些关系可以写成一个线性方程组：\n$$\nx_N = (-1)x_R + (0)y_R + (0)z_R \\\\\ny_N = (0)x_R + (1)y_R + (0)z_R \\\\\nz_N = (0)x_R + (0)y_R + (1)z_R\n$$\n用矩阵形式表示为：\n$$\n\\begin{pmatrix} x_N \\\\ y_N \\\\ z_N \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} x_R \\\\ y_R \\\\ z_R \\end{pmatrix}\n$$\n因此，$3 \\times 3$ 矩阵 $\\mathbf{R}$ 是：\n$$\n\\mathbf{R} = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n该矩阵代表关于 $y-z$ 平面的反射。\n\n**2. 构建齐次变换矩阵 $\\mathbf{T}$**\n\n将矩阵 $\\mathbf{R}$ 和平移向量 $\\mathbf{t}$ 组合成 $4 \\times 4$ 的齐次矩阵 $\\mathbf{T}$，我们得到：\n$$\n\\mathbf{T} = \\begin{pmatrix}\n-1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\n**3. 使用标志点进行验证**\n\n我们将此矩阵应用于给定的放射学坐标，并检查结果是否与神经学坐标匹配。\n\n*   **标志点1 (左侧颞平面质心):**\n    放射学坐标：$\\mathbf{p}_{R,1} = (-18, -12, 8, 1)^T$。\n    $$\n    \\mathbf{T} \\mathbf{p}_{R,1} = \\begin{pmatrix} -1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -18 \\\\ -12 \\\\ 8 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 18 \\\\ -12 \\\\ 8 \\\\ 1 \\end{pmatrix}\n    $$\n    得到的神经学坐标为 $(18, -12, 8)$，与提供的数据匹配。\n\n*   **标志点2 (右侧颞平面质心):**\n    放射学坐标：$\\mathbf{p}_{R,2} = (22, -10, 9, 1)^T$。\n    $$\n    \\mathbf{T} \\mathbf{p}_{R,2} = \\begin{pmatrix} -1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 22 \\\\ -10 \\\\ 9 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -22 \\\\ -10 \\\\ 9 \\\\ 1 \\end{pmatrix}\n    $$\n    得到的神经学坐标为 $(-22, -10, 9)$，与提供的数据匹配。\n\n*   **标志点3 (左侧Broca区中心):**\n    放射学坐标：$\\mathbf{p}_{R,3} = (-50, 20, 10, 1)^T$。\n    $$\n    \\mathbf{T} \\mathbf{p}_{R,3} = \\begin{pmatrix} -1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} -50 \\\\ 20 \\\\ 10 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 50 \\\\ 20 \\\\ 10 \\\\ 1 \\end{pmatrix}\n    $$\n    得到的神经学坐标为 $(50, 20, 10)$，与提供的数据匹配。\n\n所有三个标志点均通过派生的矩阵 $\\mathbf{T}$ 正确转换，验证了该矩阵的正确性。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n}\n$$", "id": "5040383"}]}