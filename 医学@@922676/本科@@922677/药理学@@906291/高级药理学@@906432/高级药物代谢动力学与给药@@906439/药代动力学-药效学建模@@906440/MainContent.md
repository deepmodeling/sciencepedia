## 引言
药代动力学-药效动力学（PK-PD）建模是现代药理学和[药物开发](@entry_id:169064)的核心支柱，它将“机体如何处置药物”（药代动力学，PK）与“药物如何影响机体”（药效动力学，PD）这两个基本问题用严谨的数学语言联系起来。传统药理学在很大程度上是描述性的，而PK-PD建模的出现填补了从定性观察到定量预测的关键空白，它使我们能够超越简单的剂量-效应关系，深入理解药物浓度随时间变化的全过程如何驱动药理效应的动态变化，从而更科学、更精确地使用和开发药物。

本文将带领读者系统性地探索PK-PD建模的世界。在**第一章：原理与机制**中，我们将从第一性原理出发，剖析构建PK-PD模型的基本模块，包括经典的房室模型、Emax模型，并探讨非线性动力学、[滞后现象](@entry_id:268538)以及群体变异性等高级概念，为理解模型奠定坚实的理论基础。随后，在**第二章：应用与跨学科交叉**中，我们将视野扩展到真实世界，展示这些模型如何在模型引导的药物开发（MIDD）、精准医疗、临床试验设计和法规决策中发挥关键作用，揭示其作为连接多学科桥梁的巨大价值。最后，**第三章：动手实践**将理论付诸实践，通过一系列精心设计的计算练习，引导读者亲手解决从预测药物浓度到解释效应延迟等典型问题，巩固所学知识并提升定量分析能力。

通过这三个层层递进的章节，读者不仅将掌握PK-PD建模的理论精髓，更将学会如何运用这一强大工具来解决药理学研究与实践中的复杂问题。

## 原理与机制

本章旨在系统性地阐述药代动力学-药效动力学（PK-PD）模型构建的核心原理与底层机制。我们将从基本的房室模型概念出发，逐步深入到描述药物浓度-效应关系的复杂模型，并探讨非线性动力学、生理学模型以及群体变异性的量化方法。本章的组织结构旨在通过第一性原理推导，帮助读者建立对模型结构、参数及其生物学意义的深刻理解。

### 药代动力学[房室模型](@entry_id:185959)的基础

药代动力学模型旨在数学化地描述药物在体内的吸收、分布、代谢和排泄（ADME）过程。其最核心的构建模块是**房室（compartment）**概念。一个房室并非指一个具体的解剖位置，而是一个或一组组织/体液，其中药物的动力学行为被假定为均一的。换言之，房室内的药物被视为是“充分混合”的，其浓度在整个空间内瞬时[达到平衡](@entry_id:170346)。

#### 单房室与双房室模型

最简单的结构是**单[房室模型](@entry_id:185959)（one-compartment model）**。该模型将整个身体简化为一个单一的、均质的动力学空间。其核心假设是，药物在给药后能够瞬时且均匀地分布到所有组织中。因此，在中心循环（如血浆）中测得的药物浓度可以代表整个身体的药物浓度。在此模型下，药物的消除过程通常遵循一级动力学，即消除速率与体内药物总量成正比，导致在静脉快速推注（IV bolus）后，药物浓度随时间呈单指数衰减。

然而，对于许多药物而言，其在不同组织间的分布速率存在显著差异。为了描述这种现象，**双[房室模型](@entry_id:185959)（two-compartment model）**应运而生。该模型将身体划分为两个动力学上不同的空间[@problem_id:4971842]：
- **中央房室（central compartment）**：通常包括血液以及那些血流灌注良好、药物能够迅速分布的器官（如心脏、肺、肝、肾）。药物的给药和消除通常发生在此房室。
- **外周房室（peripheral compartment）**：代表血流灌注较慢、药物分布相对延迟的组织（如肌肉、脂肪、皮肤）。

双房室模型的核心假设是，药物在中央房室和外周房室之间的转运并非瞬时完成，而是遵循一个有限速率的[一级动力学](@entry_id:183701)过程。这种分布延迟导致在静脉快速推注后，药物浓度曲线呈现双指数衰减，初期为快速的分布相（distribution phase），随后是较慢的消除相（elimination phase）。

基于质量守恒定律，我们可以构建描述双房室模型中药物量随时间变化的[微分方程组](@entry_id:148215)。假设药物经静脉快速推注进入中央房室，且仅从中央房室消除，则模型可由以下方程描述[@problem_id:4971842]：

$$
\frac{dA_c}{dt} = k_{21}A_p - (k_{10}+k_{12})A_c
$$

$$
\frac{dA_p}{dt} = k_{12}A_c - k_{21}A_p
$$

其中，$A_c(t)$ 和 $A_p(t)$ 分别是中央和外周房室中的药物量。$k_{10}$ 是从中央房室消除的一级[速率常数](@entry_id:140362)，$k_{12}$ 是从中央到外周的转运[速率常数](@entry_id:140362)，$k_{21}$ 是从外周回到中央的转运[速率常数](@entry_id:140362)。若在时间 $t=0$ 时给予剂量为 $D$ 的静脉快速推注，则初始条件为：

$$
A_c(0^+) = D, \quad A_p(0^+) = 0
$$

#### 核心药代动力学参数

无论是何种[房室模型](@entry_id:185959)，其行为都由一组核心参数决定，这些参数具有明确的生理学和物理学意义。

- **表观分布容积（Apparent Volume of Distribution, $V$）**：此参数将测得的血浆药物浓度 $C(t)$ 与体内的药物总量 $A(t)$ 联系起来，定义为 $V = \frac{A(t)}{C(t)}$。它并非一个真实的生理容积，而是一个比例常数，反映了药物在全身组织相对于在血浆中的分布倾向。一个较大的 $V$ 值（例如，远超人体总体液量）意味着药物广泛分布于组织中，导致血浆浓度相对较低。其单位是体积，如升（$\mathrm{L}$）。[@problem_id:4971848]

- **消除[速率常数](@entry_id:140362)（Elimination Rate Constant, $k$）**：在一级消除动力学模型中，药物从体内消除的速率与当时的药物总量成正比。这个比例常数就是消除[速率常数](@entry_id:140362) $k$。其数学定义源于[微分](@entry_id:158422)方程 $\frac{dA(t)}{dt} = -k \cdot A(t)$。它代表单位时间内从体内消除的药物量所占的比例。因此，其单位是时间的倒数，如 $\mathrm{h}^{-1}$。[@problem_id:4971848]

- **清除率（Clearance, $Cl$）**：清除率是一个更为生理学的概念，它被定义为单位时间内从药物中被完全清除的血浆（或血液）的体积。操作上，它是在任何时刻，药物消除速率与当时血浆浓度的比例常数，即 $\text{消除速率} = Cl \cdot C(t)$。其单位是体积/时间，如 $\mathrm{L/h}$。清除率是衡量身体消除药物能力的核心指标，主要由肝脏和肾脏等器官的功能决定。[@problem_id:4971848]

这三个核心参数并非相互独立。通过联立它们的定义，我们可以推导出它们之间至关重要的关系。根据定义，消除速率既可以表示为 $k \cdot A(t)$，也可以表示为 $Cl \cdot C(t)$。因此：

$$
k \cdot A(t) = Cl \cdot C(t)
$$

代入 $A(t) = V \cdot C(t)$，我们得到：

$$
k \cdot (V \cdot C(t)) = Cl \cdot C(t)
$$

当体内有药物存在时（$C(t) > 0$），可以消去 $C(t)$，从而得到一个不随时间变化的基本关系：

$$
Cl = k \cdot V
$$

这个关系式是线性[药代动力学模型](@entry_id:264874)的基石，它将反映药物分布特性的参数（$V$）和反映消除速率的参数（$k$）与衡量整体消除能力的生理学参数（$Cl$）联系在一起。[@problem_id:4971848]

### 药物输入与暴露量度

除了药物在体内的处置过程，药物的进入方式（即吸收）也对浓度-时间曲线有决定性影响。

#### 吸收模型

对于血管外给药（如口服），药物必须先从给药部位（如胃肠道）吸收入体循环。最常见的两种吸收模型是**一级吸收（first-order absorption）**和**零级吸收（zero-order absorption）**。[@problem_id:4971790]

- **一级吸收**假设吸收速率在任何时刻都与当时在吸收部位剩余的药物量成正比。这类似于放射性衰变，吸收过程随时间推移而减慢。其特征是一个吸收[速率常数](@entry_id:140362) $k_a$（单位为 $\text{time}^{-1}$）。大多数速释口服制剂的吸收过程近似于一级吸收。

- **零级吸收**则假设药物以一个恒定的速率被吸收，直到吸收部位的药物被耗尽。其特征是一个零级吸收速率 $k_0$（单位为 $\text{amount/time}$）。这种模型适用于某些[控释](@entry_id:157498)制剂或通过饱和转运体吸收的药物。在零级吸收模型中，吸收持续的时间与总剂量 $D$ 成正比（持续时间 = $D/k_0$）。[@problem_id:4971790]

在实际情况中，口服药物的吸收可能不会立即开始，例如由于[胃排空](@entry_id:163659)延迟。这种延迟可以通过引入一个**吸收迟滞时间（lag time, $t_{\text{lag}}$）**来建模。它是一个时间参数，表示从给药到吸收过程实际开始之间的时间间隔，而不会改变吸收过程本身的动力学特征（如 $k_a$ 或 $k_0$ 的值）。[@problem_id:4971790]

#### 暴露量度

为了定量评价药物在体内的暴露程度，药代动力学分析使用一系列从浓度-时间曲线上计算得出的参数。

- **血药浓度-时间曲线下面积（Area Under the Curve, AUC）**：AUC 是浓度-时间曲线从零到无穷大的积分，即 $AUC = \int_{0}^{\infty} C(t) dt$。它综合反映了药物暴露的总量，是评估生物利用度和比较不同给药方案暴露程度的金标准。对于[线性动力学](@entry_id:177848)，总暴露量与进入体循环的剂量成正比。对于静脉给药，全部剂量 $D$ 进入体循环，因此有一个基本关系：$AUC = \frac{D}{Cl}$。对于生物利用度为 $F$ 的口服给药，则是 $AUC = \frac{F \cdot D}{Cl}$。[@problem_id:4971930]

- **峰浓度（Maximum Concentration, $C_{\max}$）**：指给药后血浆药物浓度达到的最高值。

- **达峰时间（Time to Maximum Concentration, $T_{\max}$）**：指达到峰浓度所需的时间。$C_{\max}$ 和 $T_{\max}$ 是评估药物吸收速率的重要指标。对于口服一级吸收模型，$T_{\max}$ 取决于吸收[速率常数](@entry_id:140362) $k_a$ 和消除[速率常数](@entry_id:140362) $k$ 的相对大小，可通过求解浓度方程的导数为零得到：$T_{\max} = \frac{\ln(k_a/k)}{k_a - k}$。[@problem_id:4971930]

### 药代动力学的非线性

在上述讨论中，我们默认了一个前提：药代动力学是**线性的**，即参数 $Cl$ 和 $V$ 是不随剂量或浓度变化的常数。这意味着暴露量（如 AUC）与剂量成**剂量正比（dose proportional）**关系。然而，当处理药物的 ADME 过程的蛋白质（如代谢酶、转运体）发生饱和时，这种线性关系就会被打破，出现**非线性药代动力学（nonlinear pharmacokinetics）**。

一个典型的例子是**饱和性消除（saturable elimination）**，常由 [Michaelis-Menten](@entry_id:145978) 动力学描述。当药物浓度较低时，消除速率与浓度近似成正比，清除率恒定。但当浓度升高到足以使代谢[酶饱和](@entry_id:263091)时，消除速率达到一个最大值（$V_{\max}$），不再随浓度增加而增加。

这种非线性行为有几个关键特征[@problem_id:4971783]：
1.  **清除率随剂量增加而降低**：由于 $Cl = D/AUC$，当 AUC 的增幅超过剂量的增幅时，计算出的表观清除率会下降。
2.  **半衰期随剂量增加而延长**：消除过程变慢，导致药物在体内[停留时间](@entry_id:263953)更长。
3.  **AUC的增加幅度超过剂量的增加幅度**：例如，当剂量增加4倍时，AUC的增加可能超过4倍。我们可以通过计算**剂量归一化AUC（dose-normalized AUC）**，即 $AUC/D$，来判断。在[线性动力学](@entry_id:177848)中，该值为常数；而在饱和性消除时，该值随剂量增加而增加。

我们可以用一个幂律关系式 $AUC \propto D^\beta$ 来量化偏离剂量正比的程度。在线性情况下，$\beta=1$。对于饱和性消除，$\beta > 1$。通过在不同剂量下测定 AUC，可以估算 $\beta$ 值，从而定量描述非线性的严重程度。例如，一项研究在50 mg和800 mg剂量下测得的AUC分别为12和520 $\mathrm{mg\cdot h/L}$，通过计算发现，暴露量的增加幅度远超剂量的增加幅度，表明存在饱和性消除，其幂指数 $\beta$ 约为 1.36。[@problem_id:4971783]

### 药效动力学模型的基础

药效动力学（PD）研究药物浓度与生理或药理效应之间的关系。与PK模型描述“身体如何处置药物”不同，PD模型描述“药物如何影响身体”。

最常用的PD模型是基于[受体理论](@entry_id:202660)的 **$E_{\max}$ 模型**。该模型假设药物效应是通过与受体结合产生的，并且效应的大小与受体占有率成正比。对于非[协同性](@entry_id:147884)结合（一个药物分子结合一个受体位点），根据质量作用定律，受体占有率 $f_{\text{occ}}$ 与药物浓度 $C$ 的关系为：

$$
f_{\text{occ}} = \frac{C}{K_d + C}
$$

其中 $K_d$ 是[解离常数](@entry_id:265737)。如果效应 $E$ 与基线效应 $E_0$ 的差值与受体占有率成线性关系，即 $E(C) - E_0 \propto f_{\text{occ}}$，那么浓度-效应关系可以写为[@problem_id:4971857]：

$$
E(C) = E_0 + \frac{E_{\max} \cdot C}{EC_{50} + C}
$$

这个模型包含两个核心PD参数：
- **功效（Efficacy, $E_{\max}$）**：指药物能产生的最大效应增量（相对于基线）。它反映了药物的内在活性，即药物-受体复合物激活下游信号通路的能力。
- **效价（Potency, $EC_{50}$）**：指产生50%最大效应时所需的药物浓度。它反映了药物与受体结合的亲和力以及产生效应所需的浓度范围。$EC_{50}$ 值越小，药物的效价越高。

必须强调，**功效和效价是两个完全不同的概念**。功效描述效应的“高度”，而效价描述效应曲线在浓度轴上的“位置”。一个高效价的药物（$EC_{50}$ 小）不一定有高功效（$E_{\max}$ 大），反之亦然。[@problem_id:4971857]

为了描述药物与受体之间的**协同性（cooperativity）**，可将 $E_{\max}$ 模型扩展为**S型 $E_{\max}$ 模型（Sigmoid $E_{\max}$ model）**，也称为**希尔模型（Hill model）**：

$$
E(C) = E_0 + \frac{E_{\max} \cdot C^n}{EC_{50}^n + C^n}
$$

这里的 $n$ 是**[希尔系数](@entry_id:190239)（Hill coefficient）**。当 $n=1$ 时，该[模型简化](@entry_id:171175)为标准的 $E_{\max}$ 模型。当 $n>1$ 时，表示正[协同性](@entry_id:147884)（即一个药物分子的结合促进了其他分子的结合），浓度-效应曲线在 $EC_{50}$ 附近变得更加陡峭。当 $n1$ 时，表示负[协同性](@entry_id:147884)。[@problem_id:4971857]

### 连接药代动力学与药效动力学

PK-PD模型的核心任务是连接描述浓度时程的PK模型和描述浓度-效应关系的PD模型，从而预测效应随时间的变化 $E(t)$。

#### 直接连接模型与[滞后现象](@entry_id:268538)

最简单的连接方式是**直接连接模型（direct link model）**，它假设效应在任何时刻都只是当时血浆浓度 $C(t)$ 的一个瞬时函数，即 $E(t) = f(C(t))$。例如，将S型 $E_{\max}$ 模型中的 $C$ 替换为 $C(t)$。这种模型的一个重要推论是，在效应-浓度图上，所有 $(C(t), E(t))$ 数据点都会落在一条单一的曲线上，无论时间早晚。换言之，它**不产生滞后（hysteresis）**。[@problem_id:4971914]

然而，在许多实际情况中，效应和浓度之间存在时间上的不匹配，导致在效应-浓度图上形成一个环状轨迹，即**滞后环（hysteresis loop）**。滞后环的方向具有重要的机制意义。

- **逆时针滞后（Counterclockwise Hysteresis）**：当浓度相同时，在浓度下降阶段（较晚时间）观测到的效应高于在浓度上升阶段（较早时间）的效应。这种现象通常源于**分布延迟**，即药物从血浆分布到作用靶点所在的组织（即**生物相 (biophase)**）需要时间。血浆浓度已经达峰并开始下降时，靶点部位的浓度可能仍在上升或刚刚达峰。为了模拟这种现象，引入了**效应室模型（effect compartment model）**。该模型假设存在一个质量可忽略不计的虚拟“效应室”，其浓度 $C_e(t)$ 与血浆浓度 $C_p(t)$ 之间存在一级动力学平衡过程（例如，$dC_e/dt = k_{e0}(C_p - C_e)$）。效应被认为是 $C_e(t)$ 的瞬时函数，即 $E(t)=f(C_e(t))$。由于 $C_e(t)$ 的变化总是滞后于 $C_p(t)$，该模型能够自然地产生逆时针滞后环。值得注意的是，效应室是一个数学构建，其存在不影响测得的血浆PK特征。[@problem_id:4971914] [@problem_id:4971981] 此外，如果药物的活性代谢产物的生成和消除比母体药物慢，也会导致在绘制母体药物浓度-效应图时出现逆时针滞后。

- **顺时针滞后（Clockwise Hysteresis）**：当浓度相同时，在浓度下降阶段观测到的效应低于在浓度上升阶段的效应。这通常表明系统对药物的敏感性随时间推移而降低，即产生了**急性耐受（acute tolerance或tachyphylaxis）**。例如，药物暴露可能导致[受体下调](@entry_id:193221)或功能脱敏。这种现象可以通过一个描述敏感性 $S(t)$ 随药物暴露而衰减的模型来捕捉，效应则被认为是浓度和当前敏感性的共同函数，如 $E(t) = S(t) \cdot f(C_p(t))$。[@problem_id:4971981]

在[稳态](@entry_id:139253)（steady state）条件下，例如通过长时间恒速静脉输注，血浆浓度和效应室浓度都达到恒定值，[滞后现象](@entry_id:268538)消失。因此，仅凭[稳态](@entry_id:139253)数据无法区分直接连接模型和效应室模型。[@problem_id:4971914]

### 高级PK-PD模型结构

#### 间接效应模型

许多药物并不直接作用于我们所观察的生理指标（如血压、凝血因子），而是通过调节这些指标的生成或降解速率来发挥作用。这类过程需要**间接效应模型（indirect response models）**来描述，其中最常见的是**周转模型（turnover model）**。

一个基本的周转模型描述了一个生理反应指标 $R$ 的动态平衡，其变化率由一个零级生成速率 $k_{\text{in}}$ 和一个一级降解[速率常数](@entry_id:140362) $k_{\text{out}}$ 决定[@problem_id:4971892]：

$$
\frac{dR}{dt} = k_{\text{in}} - k_{\text{out}} \cdot R
$$

在没有药物的情况下，系统处于[稳态](@entry_id:139253) $R_0 = k_{\text{in}} / k_{\text{out}}$。药物可以通过以下几种方式影响该系统：
1.  **抑制生成**：药物使有效生成速率变为 $k_{\text{in}} \cdot (1 - I(C))$，其中 $I(C)$ 是与浓度相关的抑制函数。
2.  **刺激降解**：药物使有效降解[速率常数](@entry_id:140362)变为 $k_{\text{out}} \cdot (1 + S(C))$，其中 $S(C)$ 是与浓度相关的刺激函数。
3.  **抑制降解**或**刺激生成**。

这些不同的作用机制不仅会改变新的[稳态](@entry_id:139253)水平 $R_{ss}$，还可能影响系统趋近新[稳态](@entry_id:139253)的时间尺度（由时间常数 $\tau$ 表征）。例如，对于**输入抑制**，新的[稳态](@entry_id:139253) $R_{ss} = \frac{k_{\text{in}}(1-I)}{k_{\text{out}}}$，但系统的时间常数 $\tau = 1/k_{\text{out}}$ 保持不变。而对于**输出刺激**，新的[稳态](@entry_id:139253) $R_{ss} = \frac{k_{\text{in}}}{k_{\text{out}}(1+S)}$，同时系统的[时间常数](@entry_id:267377)变为 $\tau = \frac{1}{k_{\text{out}}(1+S)}$，表明系统更快地达到新的、更低的[稳态](@entry_id:139253)。[@problem_id:4971892]

#### 生理药代动力学模型

传统的房室模型是经验性的，其参数（如 $V$ 和 $k$）是多个生理过程的综合体现。与之相对，**生理药代动力学（Physiologically-Based Pharmacokinetic, PBPK）**模型试图从更机制化的层面描述药物的体内过程。

PBPK模型将身体描绘成由各个真实器官（如肝、肾、脑）组成的网络，这些器官通过血液循环系统连接。每个器官被视为一个房室，其特征由真实的生理学和解剖学参数定义[@problem_id:4971859]：
- **器官体积（$V_i$）**和**血流量（$Q_i$）**：这些是生物体的固有属性。
- **组织-血液分配系数（$K_{p,i}$）**：这是一个描述药物在特定组织和血液之间[达到平衡](@entry_id:170346)时浓度比的参数，反映了药物对该组织的亲和力。$K_{p,i} = C_{\text{tissue}} / C_{\text{blood at equilibrium}}$。

通过对每个器官应用质量守恒定律，可以构建一个描述药物在全身各处浓度随时间变化的复杂的[微分](@entry_id:158422)方程系统。例如，对于一个由血流灌注限制（perfusion-limited）的非清除器官 $i$，其浓度 $C_i$ 的变化可以描述为：

$$
V_i \frac{dC_i}{dt} = Q_i \left( C_{\text{arterial blood}} - C_{\text{venous blood from organ } i} \right)
$$

其中，流出该器官的静脉血浓度 $C_{\text{venous blood from organ } i}$ 与组织浓度 $C_i$ 的关系为 $C_{\text{venous}} = C_i / K_{p,i}$。[PBPK模型](@entry_id:190843)的优势在于其强大的预测能力，例如，可以进行物种间外推或预测特殊人群（如肝损伤患者）的药代动力学。[@problem_id:4971859]

### 群体建模与变异性

个体对药物的反应千差万别。**群体药代动力学（Population PK）**旨在描述和量化这种变异性，而不是仅仅关注“平均”个体。它通过分析来自一组个体的稀疏或密集采样数据，来表征药物在一个目标人群中的典型PK特征以及变异性的来源和大小。

在一个包含重复给药场合的研究设计中，变异性可以被分解为几个层次[@problem_id:4971802]：
1.  **个体间变异（Inter-Individual Variability, IIV）**：指不同个体之间PK参数（如 $Cl$, $V$）的随机差异。这种差异对某个特定个体来说是系统性的、稳定的。
2.  **个体内变[异或](@entry_id:172120)场合间变异（Inter-Occasion Variability, IOV）**：指同一个体在不同给药场合（例如，相隔数周的两次给药）之间PK参数的随机波动。这可能源于生理状态的短期变化、饮食影响等。
3.  **残差未知变异（Residual Unexplained Variability, RUV）**：这是最低层次的变异，指模型预测浓度与实际观测浓度之间的差异。它包括了生物分析方法的测量误差、模型设定偏误以及其他所有未解释的随机噪声。

为了在[统计模型](@entry_id:755400)中恰当地表示这些变异性，并确保参数的物理约束（如 $Cl, V$ 必须为正值），标准做法是采用**[对数正态分布](@entry_id:261888)模型（log-normal model）**。该模型假设参数的对数值服从正态分布，从而保证原参数值恒为正，并且变异性在自然尺度上是[乘性](@entry_id:187940)的，这更符合生物学现象。

一个典型的包含IIV和IOV的参数模型可以表示为[@problem_id:4971802]：

$$
Cl_{i,k} = TV_{Cl} \cdot \exp(\eta_{Cl,i} + \kappa_{Cl,i,k})
$$

其中：
- $Cl_{i,k}$ 是第 $i$ 个个体在第 $k$ 个场合的清除率值。
- $TV_{Cl}$ 是群体典型清除率值。
- $\eta_{Cl,i}$ 是一个服从均值为0、方差为 $\omega_{Cl}^2$ 的正态分布的随机变量，代表了第 $i$ 个个体的IIV。
- $\kappa_{Cl,i,k}$ 是一个服从均值为0、方差为 $\pi_{Cl}^2$ 的正态分布的随机变量，代表了第 $i$ 个个体在第 $k$ 个场合的IOV。

对于残差变异，由于测量误差可能同时包含与浓度成比例的[部分和](@entry_id:162077)恒定的部分，一个灵活的**混合误差模型（combined error model）**被广泛使用：

$$
y_{i,k,j} = C_{\text{pred},i,k,j} \cdot (1 + \varepsilon_{p,i,k,j}) + \varepsilon_{a,i,k,j}
$$

其中 $y_{i,k,j}$ 是观测值，$C_{\text{pred},i,k,j}$ 是模型预测值，$\varepsilon_p$ 和 $\varepsilon_a$ 分别代表比例误差和加性误差。通过这种分层统计建模，我们可以全面地理解药物在人群中的行为，并为个体化给药方案的设计提供依据。[@problem_id:4971802]