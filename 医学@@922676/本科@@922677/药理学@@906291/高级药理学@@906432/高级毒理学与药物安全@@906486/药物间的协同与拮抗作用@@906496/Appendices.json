{"hands_on_practices": [{"introduction": "药物相互作用的量化是药理学研究的关键一步。本练习将指导您使用最广泛接受的方法之一——Chou-Talalay方法，来计算组合指数（$CI$）。通过这个计算，您将能根据实验数据，客观地判断两种药物的组合是产生协同、相加还是拮抗作用，这是评估联合疗法潜力的基本技能。[@problem_id:5008658]", "problem": "一个转化药理学团队正在设计一种针对临床前模型中致癌信号通路的双药联合疗法。假设每种单一药物的反应都遵循基于质量作用的中效原理，这意味着每种药物都存在单调的剂量-效应关系，并为任何分数效应水平 $x \\in (0,1)$ 定义了单一药物剂量 $D_{A,x}$（对于药物 $A$）和 $D_{B,x}$（对于药物 $B$），即单独给药时能产生分数效应 $x$ 的剂量。在 Loewe 相加性和相互排斥（没有重叠的结合位点或本身不产生协同作用的独立机制）的框架下，Chou–Talalay 联合指数 (CI) 用于量化在指定效应水平 $x$ 下与相加性的偏差，其中 $CI=1$ 对应于相加性，$CI < 1$ 表示协同作用，$CI > 1$ 表示拮抗作用。\n\n对于目标分数效应水平 $x=0.7$，通过经验确定的达到该效应 $x$ 的单一药物剂量为 $D_{A,0.7}=4\\,\\mu \\mathrm{M}$ 和 $D_{B,0.7}=10\\,\\mu \\mathrm{M}$。在相同目标效应水平下的固定比例联合实验中，测得的联合用药剂量为 $c_A=2\\,\\mu \\mathrm{M}$ 和 $c_B=6\\,\\mu \\mathrm{M}$。使用所描述的 Chou–Talalay 框架，计算该组合在 $x=0.7$ 时的联合指数 (CI)。将您的最终答案表示为一个无单位的纯数字。无需四舍五入。", "solution": "该问题是有效的。这是一个在定量药理学领域中提法恰当、有科学依据的问题，要求使用提供的经验数据计算一个标准指标——联合指数（CI）。所有必要的值都已给出，其基本原理在转化医学领域已得到公认。\n\n该问题要求计算在指定的分数效应水平 $x$ 下，双药联合疗法的 Chou–Talalay 联合指数 ($CI$)。该指数的理论基础是应用于剂量-效应关系的中效原理。对于两种相互排斥的药物（此处指定为药物 $A$ 和药物 $B$）的组合，在效应水平 $x$ 下的 $CI$ 定义为分数剂量的总和。每个分数剂量是指联合用药中该药物的浓度与单独使用时能产生相同效应水平 $x$ 的单一药物浓度的比值。通用公式为：\n$$CI_x = \\frac{(D)_A}{(D_x)_A} + \\frac{(D)_B}{(D_x)_B}$$\n在此方程中，$(D)_A$ 和 $(D)_B$ 是在组合中为达到效应 $x$ 所使用的药物 $A$ 和药物 $B$ 的剂量。项 $(D_x)_A$ 和 $(D_x)_B$ 代表单一药物的等效剂量（即，单独使用药物 $A$ 或药物 $B$ 产生效应 $x$ 所需的剂量）。\n\n问题陈述提供了以下符号和数值：\n- 目标分数效应水平为 $x = 0.7$。\n- 达到此效应的联合用药中各药物的剂量为 $c_A = 2\\,\\mu\\mathrm{M}$ 和 $c_B = 6\\,\\mu\\mathrm{M}$。\n- 单独使用时达到相同效应的单一药物剂量为 $D_{A,0.7} = 4\\,\\mu\\mathrm{M}$ 和 $D_{B,0.7} = 10\\,\\mu\\mathrm{M}$。\n\n将通用公式调整为该问题的特定符号，我们得到：\n$$CI_{0.7} = \\frac{c_A}{D_{A,0.7}} + \\frac{c_B}{D_{B,0.7}}$$\n该方程量化了药物相互作用的性质。$CI_{0.7} = 1$ 的值表示相加性，这是 Loewe 相加性模型中的基线假设。$CI_{0.7} < 1$ 的值表示协同作用，意味着药物联合使用的效果比预期的更好。$CI_{0.7} > 1$ 的值表示拮抗作用，意味着药物相互干扰或在联合使用时效果较差。\n\n现在我们可以将给定的数值代入公式：\n$$CI_{0.7} = \\frac{2\\,\\mu\\mathrm{M}}{4\\,\\mu\\mathrm{M}} + \\frac{6\\,\\mu\\mathrm{M}}{10\\,\\mu\\mathrm{M}}$$\n每个分数项的分子和分母中的浓度单位（$\\mu\\mathrm{M}$）会相互抵消，这证实了 $CI$ 是一个无量纲的量，符合要求。\n$$CI_{0.7} = \\frac{2}{4} + \\frac{6}{10}$$\n对每个分数进行算术运算：\n$$CI_{0.7} = 0.5 + 0.6$$\n将两项相加，得到联合指数的最终值：\n$$CI_{0.7} = 1.1$$\n计算得出的该药物组合在 $70\\%$ 效应水平（$x=0.7$）下的联合指数为 $1.1$。由于该值大于 $1$，因此药物 $A$ 和药物 $B$ 在此特定剂量比和效应水平下的相互作用被归类为拮抗作用。", "answer": "$$\\boxed{1.1}$$", "id": "5008658"}, {"introduction": "协同作用的原理不仅适用于抗癌药物，也同样是微生物学中评估抗生素联合用药的核心。本练习将带您进入临床微生物学的场景，应用分数抑制浓度指数（$FICI$）来评估两种抗生素的相互作用。您将发现，尽管应用领域不同，其背后的Loewe相加性原理与组合指数（$CI$）是相通的，这展示了科学原理的普适性。[@problem_id:4991995]", "problem": "一个临床微生物学实验室进行棋盘格法测定，以评估两种抗生素对单一细菌分离株的相互作用。最低抑菌浓度 (MIC) 定义为在标准化条件下观察不到可见生长的最低浓度。这些抗生素在等效水平（$24$ 小时完全抑制生长）下单用和联用进行测试。\n\n抗生素 $A$ 的单用最低抑菌浓度 (MIC) 为 $8$ 微克/毫升，抗生素 $B$ 的单用最低抑菌浓度 (MIC) 为 $1$ 微克/毫升。在达到同样无生长效果的联合用药孔中，测得的浓度为 $A$ 是 $2$ 微克/毫升，$B$ 是 $0.25$ 微克/毫升。\n\n从Loewe相加模型原理出发，在等效联合用药中，每种药物沿等效线贡献的份额是其相对于其单用有效浓度的比例。请构建一个合适的无量纲指数来汇总两种药物的贡献，并计算其在观察到的联合用药组合下的值。将该指数的最终结果以一个无量纲数的形式报告。答案四舍五入到四位有效数字。", "solution": "该问题陈述已经过严格验证，被认为是合理的。它在科学上基于药理学和微生物学的原理，问题提出得当，提供了所有必要信息，并且语言客观。该问题要求基于Loewe相加模型原理计算一个无量纲指数，Loewe相加模型是评估药物相互作用的标准模型。所有提供的数据都是一致且符合实际的。因此，可以构建一个正式的解决方案。\n\n该问题要求基于Loewe相加模型原理，构建并计算一个无量纲指数，以量化两种抗生素 $A$ 和 $B$ 之间的相互作用。该原理提供了一个定义相加作用的框架，协同作用或拮抗作用可以与此进行比较衡量。对于等效组合，例如达到最低抑菌浓度 (MIC)，Loewe相加模型假定每种药物的分数贡献之和应等于1。\n\n每种药物的分数贡献是其在有效组合中的浓度与单独使用时产生相同效果的浓度之比。根据定义，后者的浓度即为该药物单用时的MIC。设 $MIC_A$ 和 $MIC_B$ 分别为抗生素 $A$ 和 $B$ 单独使用时的最低抑菌浓度。设 $C_A$ 和 $C_B$ 为在联合用药中同样达到MIC效果（无可见生长）时抗生素 $A$ 和 $B$ 的浓度。\n\n每种药物的分数抑菌浓度 ($FIC$) 定义为：\n$$FIC_A = \\frac{C_A}{MIC_A}$$\n$$FIC_B = \\frac{C_B}{MIC_B}$$\n\n汇总这些贡献的无量纲指数是各个 $FIC$ 值的总和，称为分数抑菌浓度指数 ($FICI$ 或 $\\sum FIC$）。\n$$FICI = FIC_A + FIC_B$$\n\n代入 $FIC_A$ 和 $FIC_B$ 的定义，该指数的公式为：\n$$FICI = \\frac{C_A}{MIC_A} + \\frac{C_B}{MIC_B}$$\n\n该指数提供了药物相互作用的定量度量：\n- 如果 $FICI = 1$，则相互作用称为相加作用。联合效应与Loewe相加模型的预测完全一致。\n- 如果 $FICI < 1$，则相互作用为协同作用。药物联合使用比预测的更有效，意味着达到该效果所需的总分数浓度更低。临床上显著协同作用的常用阈值为 $FICI \\leq 0.5$。\n- 如果 $FICI > 1$，则相互作用为拮抗作用。药物联合使用效果较差，需要更高的总分数浓度才能达到该效果。\n\n问题提供了以下数据：\n- 抗生素 $A$ 的MIC， $MIC_A = 8$ 微克/毫升。\n- 抗生素 $B$ 的MIC， $MIC_B = 1$ 微克/毫升。\n- 有效组合中 $A$ 的浓度， $C_A = 2$ 微克/毫升。\n- 有效组合中 $B$ 的浓度， $C_B = 0.25$ 微克/毫升。\n\n现在我们可以计算各个 $FIC$ 值：\n$$FIC_A = \\frac{2 \\, \\mu\\text{g/mL}}{8 \\, \\mu\\text{g/mL}} = 0.25$$\n$$FIC_B = \\frac{0.25 \\, \\mu\\text{g/mL}}{1 \\, \\mu\\text{g/mL}} = 0.25$$\n\n$FICI$ 是这些值的总和：\n$$FICI = 0.25 + 0.25 = 0.5$$\n\n问题要求结果保留四位有效数字。计算出的精确值为 $0.5$。为了用四位有效数字表示，我们写作 $0.5000$。此结果表明抗生素 $A$ 和 $B$ 之间的相互作用是协同作用。", "answer": "$$\\boxed{0.5000}$$", "id": "4991995"}, {"introduction": "在实验室中发现的协同作用，必须能够成功转化为临床可行的治疗方案才有价值。本高级练习将挑战您运用药代动力学（$PK$）模型，将体外协同作用的要求转化为具体的给药方案设计。通过模拟药物在人体内的时间-浓度曲线，您将评估一个实际的给药方案是否能达到产生协同作用所需的药物暴露重叠时间，这是连接基础研究与临床应用的关键一步。[@problem_id:4991951]", "problem": "一家药理学实验室表征了两种小分子药物间的体外协同作用，该作用要求在每个给药间隔内，两种药物的游离浓度同时暴露于各自药物特异性的浓度阈值之上，并维持最短的持续时间。请将此要求转化为一项针对人体药代动力学的临床检验，通过对口服给药下预期的游离浓度-时间曲线进行建模，并评估在稳态下是否达到了所需的重叠时间。请使用以下基础和规则来制定、实施和计算结果。\n\n从以下核心定义和经过充分检验的公式开始：\n- 对于每种药物，均假定为具有一级吸收和一级消除的单室血管外（口服）给药模型。对于在时间 $t_0$ 单次口服给药，在具有一级吸收速率常数 $k_a$ 和消除速率常数 $k_{el}$ 的单室模型中，时间 $t \\ge t_0$ 时的浓度由下式给出\n$$\nC_{\\text{one-dose}}(t; t_0) \\;=\\; \\frac{F \\cdot D}{V} \\cdot \\frac{k_a}{k_a - k_{el}} \\left( e^{-k_{el}(t-t_0)} - e^{-k_a (t-t_0)} \\right),\n$$\n当 $k_a \\to k_{el}$ 时，其众所知的连续极限为\n$$\n\\lim_{k_a \\to k_{el}} C_{\\text{one-dose}}(t; t_0) \\;=\\; \\frac{F \\cdot D}{V} \\cdot k_{el} \\cdot (t-t_0) \\cdot e^{-k_{el}(t-t_0)}.\n$$\n此处，$F$ 是口服生物利用度（无单位），$D$ 是剂量（单位 $\\mathrm{mg}$），$V$ 是表观分布容积（单位 $\\mathrm{L}$）。消除速率常数通过 $k_{el} = \\ln(2)/t_{1/2}$ 与半衰期相关联，其中 $t_{1/2}$ 的单位为 $\\mathrm{h}$，$k_{el}$ 的单位为 $\\mathrm{h}^{-1}$。浓度 $C$ 的单位为 $\\mathrm{mg/L}$。\n- 对于线性药代动力学条件下以间隔 $\\tau$（单位 $\\mathrm{h}$）进行的多次给药，应用叠加原理：时间 $t$ 时的总浓度是所有在时间 $t_0 = s + n \\tau$（其中 $n \\in \\mathbb{Z}_{\\ge 0}$ 且 $t_0 \\le t$）给予的先前剂量的贡献之和，其中 $s$ 是给药方案的起始时间偏移量（单位 $\\mathrm{h}$）。\n- 只有未结合部分具有药理活性。如果 $f_u$ 是未结合分数（无单位），则游离浓度为 $C_{\\text{free}}(t) = f_u \\cdot C_{\\text{total}}(t)$。\n- 需要转换的体外协同作用要求是：在稳态下，于一个共同的给药间隔 $\\tau$ 内，药物 A 和药物 B 的游离浓度必须同时达到或超过各自的药物特异性阈值 $C^{\\text{req}}_{\\text{A,free}}$ 和 $C^{\\text{req}}_{\\text{B,free}}$（单位 $\\mathrm{mg/L}$），且累积持续时间至少为 $T_{\\text{req}}$（单位 $\\mathrm{h}$）。\n- 稳态通过给予足够多的先前剂量来近似，使得超过 10 个半衰期的残留贡献可以忽略不计。对于数值评估，以步长 $\\Delta t$（单位 $\\mathrm{h}$）将时间均匀离散化，在最后一个间隔 $[T_{\\text{end}}-\\tau,\\, T_{\\text{end}}]$ 上计算 $C_{\\text{free,A}}(t_k)$ 和 $C_{\\text{free,B}}(t_k)$，其中 $T_{\\text{end}}$ 是在多个先前间隔之后选择的，并将同时重叠的持续时间估计为两个不等式均成立的所有网格点上 $\\Delta t$ 的总和。\n\n任务：\n- 实现一个程序，针对每个测试用例，计算一个布尔值，该值指示在最后一个共同间隔内，稳态下的同时暴露持续时间是否大于或等于 $T_{\\text{req}}$。\n- 使用上述数学模型、叠加原理和游离浓度的定义。\n- 使用 $\\Delta t = 0.01 \\,\\mathrm{h}$ 的固定时间步长，并通过在 $\\lvert k_a - k_{el} \\rvert < 10^{-8}$ 时使用连续极限表达式来稳健地处理 $k_a \\approx k_{el}$ 的情况。\n\n数值单位与输出：\n- 所有剂量单位为 $\\mathrm{mg}$，容积单位为 $\\mathrm{L}$，时间单位为 $\\mathrm{h}$，浓度单位为 $\\mathrm{mg/L}$。\n- 对于每个测试用例，输出一个布尔值：如果重叠持续时间至少为 $T_{\\text{req}}$，则为 $ \\text{True}$，否则为 $ \\text{False}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[ \\text{True},\\text{False},\\text{True} ]$。\n\n测试套件：\n对于以下所有情况，根据给定的半衰期计算 $k_{el} = \\ln(2) / t_{1/2}$，并在长度为 $\\tau$ 的最终间隔上模拟稳态。在所有情况下，两种药物共享相同的 $\\tau$，但可能有不同的起始偏移量 $s$。\n\n- 情况 1（理想路径，同时给药，可达到的要求）：\n  - 共同给药间隔：$\\tau = 12.0 \\,\\mathrm{h}$。\n  - 药物 A：$F_{\\text{A}} = 0.8$, $V_{\\text{A}} = 40 \\,\\mathrm{L}$, $k_{a,\\text{A}} = 1.2 \\,\\mathrm{h}^{-1}$, $t_{1/2,\\text{A}} = 6.0 \\,\\mathrm{h}$, $f_{u,\\text{A}} = 0.1$, $D_{\\text{A}} = 500 \\,\\mathrm{mg}$, $s_{\\text{A}} = 0.0 \\,\\mathrm{h}$。\n  - 药物 B：$F_{\\text{B}} = 0.6$, $V_{\\text{B}} = 20 \\,\\mathrm{L}$, $k_{a,\\text{B}} = 1.5 \\,\\mathrm{h}^{-1}$, $t_{1/2,\\text{B}} = 4.0 \\,\\mathrm{h}$, $f_{u,\\text{B}} = 0.5$, $D_{\\text{B}} = 250 \\,\\mathrm{mg}$, $s_{\\text{B}} = 0.0 \\,\\mathrm{h}$。\n  - 协同作用阈值和要求：$C^{\\text{req}}_{\\text{A,free}} = 0.6 \\,\\mathrm{mg/L}$, $C^{\\text{req}}_{\\text{B,free}} = 1.0 \\,\\mathrm{mg/L}$, $T_{\\text{req}} = 2.5 \\,\\mathrm{h}$。\n\n- 情况 2（起始时间错开，更严格以致失败）：\n  - 共同给药间隔：$\\tau = 12.0 \\,\\mathrm{h}$。\n  - 药物 A：$F_{\\text{A}} = 0.8$, $V_{\\text{A}} = 40 \\,\\mathrm{L}$, $k_{a,\\text{A}} = 1.2 \\,\\mathrm{h}^{-1}$, $t_{1/2,\\text{A}} = 6.0 \\,\\mathrm{h}$, $f_{u,\\text{A}} = 0.1$, $D_{\\text{A}} = 500 \\,\\mathrm{mg}$, $s_{\\text{A}} = 0.0 \\,\\mathrm{h}$。\n  - 药物 B：$F_{\\text{B}} = 0.6$, $V_{\\text{B}} = 20 \\,\\mathrm{L}$, $k_{a,\\text{B}} = 1.5 \\,\\mathrm{h}^{-1}$, $t_{1/2,\\text{B}} = 4.0 \\,\\mathrm{h}$, $f_{u,\\text{B}} = 0.5$, $D_{\\text{B}} = 250 \\,\\mathrm{mg}$, $s_{\\text{B}} = 6.0 \\,\\mathrm{h}$。\n  - 协同作用阈值和要求：$C^{\\text{req}}_{\\text{A,free}} = 0.6 \\,\\mathrm{mg/L}$, $C^{\\text{req}}_{\\text{B,free}} = 1.0 \\,\\mathrm{mg/L}$, $T_{\\text{req}} = 2.5 \\,\\mathrm{h}$。\n\n- 情况 3（关于所需重叠时间的边界条件）：\n  - 参数与情况 2 相同，但 $T_{\\text{req}} = 0.0 \\,\\mathrm{h}$。\n\n- 情况 4（$k_a \\approx k_{el}$ 的数值边界情况，可达到的要求）：\n  - 共同给药间隔：$\\tau = 8.0 \\,\\mathrm{h}$。\n  - 药物 A：$F_{\\text{A}} = 0.9$, $V_{\\text{A}} = 30 \\,\\mathrm{L}$, $k_{a,\\text{A}} = 0.14 \\,\\mathrm{h}^{-1}$, $t_{1/2,\\text{A}} = 5.0 \\,\\mathrm{h}$, $f_{u,\\text{A}} = 0.2$, $D_{\\text{A}} = 200 \\,\\mathrm{mg}$, $s_{\\text{A}} = 0.0 \\,\\mathrm{h}$。\n  - 药物 B：$F_{\\text{B}} = 0.9$, $V_{\\text{B}} = 25 \\,\\mathrm{L}$, $k_{a,\\text{B}} = 0.18 \\,\\mathrm{h}^{-1}$, $t_{1/2,\\text{B}} = 5.0 \\,\\mathrm{h}$, $f_{u,\\text{B}} = 0.3$, $D_{\\text{B}} = 150 \\,\\mathrm{mg}$, $s_{\\text{B}} = 0.0 \\,\\mathrm{h}$。\n  - 协同作用阈值和要求：$C^{\\text{req}}_{\\text{A,free}} = 0.1 \\,\\mathrm{mg/L}$, $C^{\\text{req}}_{\\text{B,free}} = 0.2 \\,\\mathrm{mg/L}$, $T_{\\text{req}} = 1.0 \\,\\mathrm{h}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个情况的布尔值，按上述情况顺序列出，并以逗号分隔，用方括号括起来，例如 $[ \\text{True},\\text{False},\\text{True},\\text{True} ]$。", "solution": "该问题要求在稳态下评估两种药物（药物 A 和药物 B）之间已定义的药代动力学（PK）协同作用标准。此评估基于口服给药的单室模型。\n\n### **问题验证**\n**步骤 1：提取已知信息**\n- **药代动力学模型：** 具有一级吸收和一级消除的单室血管外（口服）模型。\n- **单次给药后的浓度：** 在时间 $t_0$ 单次口服给药剂量 $D$ 后，时间 $t$ 时的浓度 $C(t)$ 由下式给出：\n$$\nC_{\\text{one-dose}}(t; t_0) \\;=\\; \\frac{F \\cdot D}{V} \\cdot \\frac{k_a}{k_a - k_{el}} \\left( e^{-k_{el}(t-t_0)} - e^{-k_a (t-t_0)} \\right) \\quad \\text{for } t \\ge t_0\n$$\n其中 $F$ 是生物利用度，$V$ 是分布容积，$k_a$ 是吸收速率常数，$k_{el}$ 是消除速率常数。\n- **特殊情况：** 对于 $k_a \\to k_{el}$，公式为：\n$$\n\\lim_{k_a \\to k_{el}} C_{\\text{one-dose}}(t; t_0) \\;=\\; \\frac{F \\cdot D}{V} \\cdot k_{el} \\cdot (t-t_0) \\cdot e^{-k_{el}(t-t_0)}\n$$\n当 $\\lvert k_a - k_{el} \\rvert < 10^{-8}$ 时使用此公式。\n- **速率常数计算：** 消除速率常数 $k_{el}$（单位 $\\mathrm{h}^{-1}$）由消除半衰期 $t_{1/2}$（单位 $\\mathrm{h}$）通过 $k_{el} = \\ln(2)/t_{1/2}$ 确定。\n- **多次给药与稳态：** 对于给药间隔为 $\\tau$、起始偏移量为 $s$ 的给药方案，时间 $t$ 的总浓度是所有在时间 $t_0 = s + n \\tau \\le t$ 之前给药的贡献之和。稳态将通过模拟足够数量的剂量来近似，使得（清除较慢药物的）至少 10 个半衰期的给药前周期已经过去。\n- **游离浓度：** 具有药理活性的游离浓度为 $C_{\\text{free}}(t) = f_u \\cdot C_{\\text{total}}(t)$，其中 $f_u$ 是药物未与血浆蛋白结合的部分。\n- **协同作用条件：** 协同作用的要求是，在稳态下的单个给药间隔 $\\tau$ 内，两种药物的游离浓度必须同时高于它们各自的阈值 $C^{\\text{req}}_{\\text{A,free}}$ 和 $C^{\\text{req}}_{\\text{B,free}}$，总持续时间至少为 $T_{\\text{req}}$。\n- **数值参数：** 时间将以 $\\Delta t = 0.01 \\,\\mathrm{h}$ 的步长进行离散化。\n- **测试用例：** 提供了针对药物 A、B 和协同作用要求的四组特定参数。\n\n**步骤 2：验证评估**\n该问题在药代动力学这一成熟领域具有科学依据。单室模型是一个基础工具，所有概念（叠加原理、稳态、游离药物假说）都是标准原则。该问题定义明确，为每个测试用例提供了所有必要的数据、公式和约束，以得出唯一的、可计算的答案。语言客观且量化。所有参数值都在真实药物的合理范围内。因此，该问题被认定为有效。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解决方案。\n\n### **解决方法论**\n解决方案的核心在于精确计算药物 A 和药物 B 在稳态下的游离浓度-时间曲线，然后量化它们同时超过指定阈值的持续时间。\n\n**1. 单剂量浓度函数**\n实现一个函数，记为 $C_{\\text{one-dose}}(t; t_0, \\text{params})$，用于计算在时间 $t_0$ 单次口服给药后在时间 $t$ 产生的血浆浓度。此函数接收药物的参数（$F$, $D$, $V$, $k_a$, $k_{el}$）作为输入。它必须明确处理所提供的两种情况：\n- 如果 $\\lvert k_a - k_{el} \\rvert \\ge 10^{-8}$，使用标准的双指数公式。\n- 如果 $\\lvert k_a - k_{el} \\rvert < 10^{-8}$，使用极限公式以防止数值不稳定（灾难性抵消）并确保正确性。\n\n**2. 通过叠加原理进行稳态模拟**\n为了模拟稳态下的浓度，我们遵循问题的指令，模拟足够数量的给药间隔。这种直接模拟方法能正确处理两种药物方案的不同起始时间偏移量（$s_A, s_B$）。\n- **确定模拟持续时间：** 对于每个测试用例，我们首先确定两种药物中的最大半衰期，$t_{1/2,\\max} = \\max(t_{1/2,A}, t_{1/2,B})$。为确保达到稳态，我们模拟一个至少为 $10 \\cdot t_{1/2,\\max}$ 的“洗入”期。先决给药间隔数 $M$ 计算为 $M = \\lceil (10 \\cdot t_{1/2,\\max}) / \\tau \\rceil$。\n- **定义评估区间：** 分析在此洗入期之后的一个完整给药间隔 $\\tau$ 内进行。为了适应不同的起始时间 $s_A$ 和 $s_B$，评估区间设置为 $[T_{\\text{start}}, T_{\\text{end}}]$，其中 $T_{\\text{start}} = M \\cdot \\tau + \\max(s_A, s_B)$ 且 $T_{\\text{end}} = T_{\\text{start}} + \\tau$。\n- **时间离散化：** 评估区间被离散化为一系列时间点 $t_k$，步长为 $\\Delta t = 0.01 \\,\\mathrm{h}$。\n\n**3. 总浓度计算**\n对于每种药物（$i \\in \\{A, B\\}$）以及评估区间中的每个时间点 $t_k$，通过应用叠加原理计算总血浆浓度 $C_{i, \\text{total}}(t_k)$。我们对截至时间 $t_k$（包括 $t_k$）所有已给药剂量的贡献求和：\n$$\nC_{i,\\text{total}}(t_k) = \\sum_{j=0}^{N_k} C_{i,\\text{one-dose}}(t_k; s_i + j\\tau)\n$$\n其中，求和遍历所有满足给药时间 $s_i + j\\tau \\le t_k$ 的整数 $j \\ge 0$。\n\n**4. 协同作用评估**\n- 在每个时间点 $t_k$，计算两种药物的游离浓度：\n  $$C_{A, \\text{free}}(t_k) = f_{u,A} \\cdot C_{A, \\text{total}}(t_k)$$\n  $$C_{B, \\text{free}}(t_k) = f_{u,B} \\cdot C_{B, \\text{total}}(t_k)$$\n- 然后将这些值与它们各自的阈值进行比较：\n  如果 $C_{A, \\text{free}}(t_k) \\ge C^{\\text{req}}_{A,\\text{free}}$ 且 $C_{B, \\text{free}}(t_k) \\ge C^{\\text{req}}_{B,\\text{free}}$，则在该时间点满足协同作用条件。\n- 协同重叠的总持续时间 $T_{\\text{overlap}}$ 通过对满足条件的时间步长 $\\Delta t$ 求和来计算：\n  $$ T_{\\text{overlap}} = \\sum_{k} \\Delta t \\cdot \\mathbb{I}(C_{A, \\text{free}}(t_k) \\ge C^{\\text{req}}_{A,\\text{free}} \\land C_{B, \\text{free}}(t_k) \\ge C^{\\text{req}}_{B,\\text{free}}) $$\n  其中 $\\mathbb{I}(\\cdot)$ 是指示函数。\n\n**5. 最终决策**\n最后，对于每个测试用例，将计算出的重叠持续时间 $T_{\\text{overlap}}$ 与所需持续时间 $T_{\\text{req}}$ 进行比较。如果 $T_{\\text{overlap}} \\ge T_{\\text{req}}$，则结果为 $\\text{True}$，否则为 $\\text{False}$。对所有四个测试用例重复此过程，以生成最终的布尔结果列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the pharmacokinetic synergy problem for all test cases.\n    \"\"\"\n    \n    # Define test cases as a list of dictionaries.\n    test_cases = [\n        # Case 1\n        {\n            \"tau\": 12.0,\n            \"drug_A\": {\"F\": 0.8, \"V\": 40.0, \"ka\": 1.2, \"t_half\": 6.0, \"fu\": 0.1, \"D\": 500.0, \"s\": 0.0},\n            \"drug_B\": {\"F\": 0.6, \"V\": 20.0, \"ka\": 1.5, \"t_half\": 4.0, \"fu\": 0.5, \"D\": 250.0, \"s\": 0.0},\n            \"req\": {\"C_A_free\": 0.6, \"C_B_free\": 1.0, \"T\": 2.5}\n        },\n        # Case 2\n        {\n            \"tau\": 12.0,\n            \"drug_A\": {\"F\": 0.8, \"V\": 40.0, \"ka\": 1.2, \"t_half\": 6.0, \"fu\": 0.1, \"D\": 500.0, \"s\": 0.0},\n            \"drug_B\": {\"F\": 0.6, \"V\": 20.0, \"ka\": 1.5, \"t_half\": 4.0, \"fu\": 0.5, \"D\": 250.0, \"s\": 6.0},\n            \"req\": {\"C_A_free\": 0.6, \"C_B_free\": 1.0, \"T\": 2.5}\n        },\n        # Case 3\n        {\n            \"tau\": 12.0,\n            \"drug_A\": {\"F\": 0.8, \"V\": 40.0, \"ka\": 1.2, \"t_half\": 6.0, \"fu\": 0.1, \"D\": 500.0, \"s\": 0.0},\n            \"drug_B\": {\"F\": 0.6, \"V\": 20.0, \"ka\": 1.5, \"t_half\": 4.0, \"fu\": 0.5, \"D\": 250.0, \"s\": 6.0},\n            \"req\": {\"C_A_free\": 0.6, \"C_B_free\": 1.0, \"T\": 0.0}\n        },\n        # Case 4\n        {\n            \"tau\": 8.0,\n            \"drug_A\": {\"F\": 0.9, \"V\": 30.0, \"ka\": 0.14, \"t_half\": 5.0, \"fu\": 0.2, \"D\": 200.0, \"s\": 0.0},\n            \"drug_B\": {\"F\": 0.9, \"V\": 25.0, \"ka\": 0.18, \"t_half\": 5.0, \"fu\": 0.3, \"D\": 150.0, \"s\": 0.0},\n            \"req\": {\"C_A_free\": 0.1, \"C_B_free\": 0.2, \"T\": 1.0}\n        }\n    ]\n\n    def C_one_dose(t, t0, F, D, V, ka, kel):\n        \"\"\"Calculates concentration from a single oral dose.\"\"\"\n        delta_t = t - t0\n        if delta_t < 0:\n            return 0.0\n        \n        # Per problem spec, use limit expression when ka and kel are very close.\n        if abs(ka - kel) < 1e-8:\n            return (F * D / V) * kel * delta_t * np.exp(-kel * delta_t)\n        else:\n            factor = (F * D / V) * (ka / (ka - kel))\n            return factor * (np.exp(-kel * delta_t) - np.exp(-ka * delta_t))\n\n    def calculate_synergy(case_params, dt=0.01, stability_threshold_h=10.0):\n        \"\"\"Calculates if the synergy requirement is met for a given case.\"\"\"\n        tau = case_params[\"tau\"]\n        req = case_params[\"req\"]\n        \n        # Drug A parameters\n        pA = case_params[\"drug_A\"]\n        F_A, V_A, ka_A, t_half_A, fu_A, D_A, s_A = \\\n            pA[\"F\"], pA[\"V\"], pA[\"ka\"], pA[\"t_half\"], pA[\"fu\"], pA[\"D\"], pA[\"s\"]\n        kel_A = np.log(2) / t_half_A\n\n        # Drug B parameters\n        pB = case_params[\"drug_B\"]\n        F_B, V_B, ka_B, t_half_B, fu_B, D_B, s_B = \\\n            pB[\"F\"], pB[\"V\"], pB[\"ka\"], pB[\"t_half\"], pB[\"fu\"], pB[\"D\"], pB[\"s\"]\n        kel_B = np.log(2) / t_half_B\n\n        # Determine simulation time to reach steady state\n        t_half_max = max(t_half_A, t_half_B)\n        num_intervals = int(np.ceil(stability_threshold_h * t_half_max / tau))\n        \n        # Define evaluation interval\n        s_max = max(s_A, s_B)\n        eval_start_time = num_intervals * tau + s_max\n        eval_end_time = eval_start_time + tau\n\n        # Generate time points for evaluation\n        time_points = np.arange(eval_start_time, eval_end_time, dt)\n\n        # Generate all dose times up to the end of the evaluation period\n        dose_times_A = np.arange(s_A, eval_end_time, tau)\n        dose_times_B = np.arange(s_B, eval_end_time, tau)\n        \n        overlap_duration = 0.0\n        for t in time_points:\n            # Calculate total concentration for Drug A by superposition\n            conc_A = sum(C_one_dose(t, t_dose, F_A, D_A, V_A, ka_A, kel_A) \n                         for t_dose in dose_times_A if t_dose <= t)\n            free_conc_A = fu_A * conc_A\n\n            # Calculate total concentration for Drug B by superposition\n            conc_B = sum(C_one_dose(t, t_dose, F_B, D_B, V_B, ka_B, kel_B)\n                         for t_dose in dose_times_B if t_dose <= t)\n            free_conc_B = fu_B * conc_B\n            \n            # Check if synergy condition is met\n            if free_conc_A >= req[\"C_A_free\"] and free_conc_B >= req[\"C_B_free\"]:\n                overlap_duration += dt\n                \n        # Check if the cumulative overlap duration meets the requirement.\n        # Use a small tolerance for floating-point comparison.\n        return overlap_duration >= req[\"T\"] - 1e-9\n\n    results = []\n    for case in test_cases:\n        result = calculate_synergy(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "4991951"}]}