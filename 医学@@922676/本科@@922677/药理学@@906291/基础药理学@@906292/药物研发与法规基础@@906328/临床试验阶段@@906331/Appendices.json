{"hands_on_practices": [{"introduction": "I期临床试验首次在人体中测试新药，因此安全性是首要考虑的因素。本练习将引导你应用经典的“3+3”设计规则，这是在I期剂量递增研究中用以确定最大耐受剂量（MTD）的一种保守方法。通过该实践，你将学会运用基础的概率论来量化药物毒性风险，从而为剂量调整决策提供科学依据。[@problem_id:4934607]", "problem": "药理学中的I期剂量递增研究旨在通过一种保守的、基于规则的设计（通常称为“3+3”规则方案）来找到最大耐受剂量（MTD）。在此设计中，患者以规模为 $n=3$ 的队列在给定的剂量水平下入组。根据方案，剂量限制性毒性（DLT）被定义为每个患者的二元事件。在给定的剂量水平下，假设每位患者独立地以概率 $p_{\\mathrm{DLT}}$ 经历一次DLT，且一个队列中的DLT数量 $X$ 服从二项分布模型。\n\n在针对初始 $n=3$ 队列的保守的、基于规则的决策框架下：\n- 若 $X=0$，则剂量递增至下一个更高的剂量水平。\n- 若 $X=1$，则在同一剂量水平下再治疗3名患者（总计 $n=6$），然后对该剂量水平做出最终决定。\n- 若 $X\\geq 2$，则剂量递减且不再递增；前一个剂量水平被认为等于或低于最大耐受剂量（MTD）。\n\n从每个患者的DLT结果是概率为 $p_{\\mathrm{DLT}}$ 的独立伯努利试验，因此队列总数 $X$ 服从二项分布的基本定义出发，根据第一性原理推导出在 $p_{\\mathrm{DLT}}=0.2$ 时，初始 $n=3$ 队列中至少出现一次DLT的概率。然后，在相同的基础上，解释该概率结构如何映射到此基于规则的设计中的剂量递增决策（最终数值答案中不包含任何定性解释）。\n\n计算当 $n=3$ 且 $p_{\\mathrm{DLT}}=0.2$ 时，至少发生一次DLT的概率。最终答案以小数表示，并四舍五入至三位有效数字。", "solution": "问题陈述经验证具有科学依据、提法明确且客观。它描述了药理学和生物统计学中一个标准的“3+3”剂量递增设计。所需计算的所有必要参数和定义均已提供，且不存在内部矛盾或逻辑缺陷。\n\n问题要求计算在一个初始 $n=3$ 患者队列中，观察到至少一次剂量限制性毒性（DLT）的概率，前提是单个患者经历DLT的概率为 $p_{\\mathrm{DLT}}=0.2$。\n\n设 $X$ 为随机变量，表示在一个规模为 $n$ 的队列中经历DLT的患者数量。问题陈述指出，每个患者的结果都是一次独立试验。每个患者的结果是二元的：要么发生DLT（概率为 $p_{\\mathrm{DLT}}$），要么不发生（概率为 $1 - p_{\\mathrm{DLT}}$）。这种设置对应于一系列 $n$ 次独立的伯努利试验。\n\n因此，随机变量 $X$ 服从二项分布，记作 $X \\sim \\mathrm{Binomial}(n, p_{\\mathrm{DLT}})$。该分布的概率质量函数（PMF）给出了在 $n$ 名患者的队列中观察到恰好 $k$ 次DLT的概率：\n$$P(X=k) = \\binom{n}{k} p_{\\mathrm{DLT}}^{k} (1 - p_{\\mathrm{DLT}})^{n-k}$$\n其中 $\\binom{n}{k} = \\frac{n!}{k!(n-k)!}$ 是二项式系数。\n\n问题要求计算至少发生一次DLT的概率，表示为 $P(X \\geq 1)$。使用互补法则计算此概率在计算上更有效率。事件“至少一次DLT”（$X \\geq 1$）的互补事件是“零次DLT”（$X=0$）。\n$$P(X \\geq 1) = 1 - P(X=0)$$\n\n我们可以将 $k=0$ 代入二项分布的PMF来计算 $P(X=0)$：\n$$P(X=0) = \\binom{n}{0} p_{\\mathrm{DLT}}^{0} (1 - p_{\\mathrm{DLT}})^{n-0}$$\n由于对于任何非零的 $p_{\\mathrm{DLT}}$，都有 $\\binom{n}{0}=1$ 和 $p_{\\mathrm{DLT}}^{0}=1$，因此上式可简化为：\n$$P(X=0) = (1 - p_{\\mathrm{DLT}})^{n}$$\n\n现在，我们可以将至少发生一次DLT的概率表示为：\n$$P(X \\geq 1) = 1 - (1 - p_{\\mathrm{DLT}})^{n}$$\n\n问题提供了具体数值 $n=3$ 和 $p_{\\mathrm{DLT}}=0.2$。将这些值代入推导出的公式：\n$$P(X \\geq 1) = 1 - (1 - 0.2)^{3}$$\n$$P(X \\geq 1) = 1 - (0.8)^{3}$$\n计算乘方：\n$$(0.8)^{3} = 0.8 \\times 0.8 \\times 0.8 = 0.64 \\times 0.8 = 0.512$$\n最后，将此值代回：\n$$P(X \\geq 1) = 1 - 0.512 = 0.488$$\n\n这个概率 $P(X \\geq 1)$ 直接映射到所描述的决策框架上。事件 $\\{X \\geq 1\\}$ 是两个互斥事件的并集，这两个事件会触发除立即递增之外的决策：\n1.  事件 $\\{X=1\\}$，导致扩大队列。\n2.  事件 $\\{X \\geq 2\\}$，导致剂量递减。\n\n因此，$P(X \\geq 1)$ 表示在观察初始三名患者的队列后，试验不会递增至下一个剂量水平的总概率。它是扩大当前队列和剂量递减的概率之和，$P(X \\geq 1) = P(X=1) + P(X \\geq 2)$。事件 $\\{X=0\\}$，其概率为 $P(X=0)=0.512$，是导致立即剂量递增的唯一结果。\n\n计算出的值为 $0.488$，已经有三位有效数字，无需进一步四舍五入。", "answer": "$$\\boxed{0.488}$$", "id": "4934607"}, {"introduction": "在证实了药物的安全性与初步疗效后，III期试验旨在最终确认其有效性。启动一项耗资巨大的III期试验之前，必须确保招募足够数量的受试者以得出可靠结论。本练习将带你推导并计算研究所需的样本量，这是平衡统计功效（检出真实效应的能力）与I型和II型错误风险的关键步骤。[@problem_id:4934547]", "problem": "一家申办方正计划进行一项III期随机对照试验 (RCT)，以证明一种新型口服镇痛药在降低12周时连续性疼痛严重程度评分方面优于安慰剂。该试验将以$1{:}1$的比例将受试者随机分配至研究药物组或安慰剂组。主要终点是一个标准化的连续性评分，其共同的总体标准差为 $\\sigma=1$。目标临床上有意义的均值差异为 $\\Delta=0.5$（研究药物组减去安慰剂组）。该研究将使用大样本正态 (Z) 检验来检验两个独立样本均值之差，设定的双侧I类错误率为 $\\alpha=0.05$，期望的把握度为 $0.9$。\n\n从I类错误 ($\\alpha$) 和II类错误 ($\\beta$) 的核心定义、标准正态分布的性质以及等比例分配下两个独立样本均值之差的抽样分布出发，推导确保在显著性水平 $\\alpha$ 下，能以指定的把握度检测出均值差异 $\\Delta$ 所需的每组样本量表达式。然后，根据上述设计假设，数值计算所需的每组样本量。\n\n报告未取整的连续型每组样本量，保留四位有效数字。最后，通过取能达到至少目标把握度的最小整数（即，应用向上取整函数），给出所需的整数型每组样本量。最终答案应仅为每组的样本量，表示为一个不带单位的整数。", "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观，是生物统计学中一个标准的样本量计算问题。\n\n设 $\\mu_T$ 和 $\\mu_P$ 分别表示研究药物组和安慰剂组的真实平均疼痛严重程度评分。设 $\\sigma$ 为该评分的共同总体标准差。该试验旨在检验以下假设：\n原假设, $H_0: \\mu_T - \\mu_P = 0$。\n备择假设, $H_A: \\mu_T - \\mu_P \\neq 0$。\n\n该研究使用双侧检验，I类错误率为 $\\alpha$。设 $n$ 为每组的样本量，采用等比例分配 ($n_T = n_P = n$)。设 $\\bar{X}_T$ 和 $\\bar{X}_P$ 为从两组获得的样本均值。对于大样本，样本均值之差 $\\bar{X}_T - \\bar{X}_P$ 的抽样分布近似于正态分布。\n\n两个独立样本均值之差的方差为：\n$$ \\text{Var}(\\bar{X}_T - \\bar{X}_P) = \\text{Var}(\\bar{X}_T) + \\text{Var}(\\bar{X}_P) = \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n} = \\frac{2\\sigma^2}{n} $$\n因此，该差值的标准误 (SE) 为：\n$$ \\text{SE} = \\sqrt{\\frac{2\\sigma^2}{n}} = \\sigma\\sqrt{\\frac{2}{n}} $$\n均值之差的检验统计量是 Z 统计量：\n$$ Z = \\frac{(\\bar{X}_T - \\bar{X}_P) - (\\mu_T - \\mu_P)}{\\text{SE}} = \\frac{(\\bar{X}_T - \\bar{X}_P) - (\\mu_T - \\mu_P)}{\\sigma\\sqrt{2/n}} $$\n在原假设 $H_0$（即 $\\mu_T - \\mu_P = 0$）下，该统计量变为：\n$$ Z_0 = \\frac{\\bar{X}_T - \\bar{X}_P}{\\sigma\\sqrt{2/n}} $$\n$Z_0$ 服从标准正态分布 $N(0,1)$。\n\n对于双侧检验，为了将I类错误率控制在 $\\alpha$，如果检验统计量的绝对值超过临界值 $z_{1-\\alpha/2}$，我们就拒绝 $H_0$。$z_{1-\\alpha/2}$ 是标准正态分布的分位数，满足 $P(Z  z_{1-\\alpha/2}) = \\alpha/2$。拒绝法则是：\n$$ |Z_0|  z_{1-\\alpha/2} \\quad \\Leftrightarrow \\quad |\\bar{X}_T - \\bar{X}_P|  z_{1-\\alpha/2} \\sigma\\sqrt{\\frac{2}{n}} $$\n这定义了观测到的均值差异的拒绝域。\n\n把握度（记为 $1-\\beta$）是在备择假设 $H_A$ 为真时正确拒绝 $H_0$ 的概率。我们针对一个特定的、临床上有意义的均值差异 $\\Delta$ 来计算把握度。假设真实差异为 $|\\mu_T - \\mu_P| = \\Delta$。不失一般性地，设 $\\mu_T - \\mu_P = \\Delta$，其中 $\\Delta  0$。\n\n把握度是在真实差异为 $\\Delta$ 的条件下，观测到的差异 $\\bar{X}_T - \\bar{X}_P$ 落在拒绝域内的概率：\n$$ \\text{Power} = P\\left(|\\bar{X}_T - \\bar{X}_P|  z_{1-\\alpha/2} \\sigma\\sqrt{\\frac{2}{n}} \\;\\middle|\\; \\mu_T - \\mu_P = \\Delta\\right) $$\n这等价于：\n$$ \\text{Power} = P\\left(\\bar{X}_T - \\bar{X}_P  z_{1-\\alpha/2} \\sigma\\sqrt{\\frac{2}{n}}\\right) + P\\left(\\bar{X}_T - \\bar{X}_P  -z_{1-\\alpha/2} \\sigma\\sqrt{\\frac{2}{n}}\\right) $$\n其中概率是以 $\\mu_T - \\mu_P = \\Delta$ 为条件的。对于一个有足够把握度的研究，由于 $\\bar{X}_T - \\bar{X}_P$ 的分布以 $\\Delta$ 为中心，而 $\\Delta$ 远离负临界值，因此对应于下侧尾部的第二项可以忽略不计。所以，我们可以只考虑上侧尾部来近似计算把握度：\n$$ \\text{Power} \\approx P\\left( \\bar{X}_T - \\bar{X}_P  z_{1-\\alpha/2} \\sigma\\sqrt{\\frac{2}{n}} \\;\\middle|\\; \\mu_T - \\mu_P = \\Delta \\right) $$\n为了计算这个概率，我们通过从随机变量 $\\bar{X}_T - \\bar{X}_P$ 中减去其真实均值 $\\Delta$ 并除以其标准误 $\\sigma\\sqrt{2/n}$ 来将其标准化。\n$$ \\text{Power} \\approx P\\left( \\frac{(\\bar{X}_T - \\bar{X}_P) - \\Delta}{\\sigma\\sqrt{2/n}}  \\frac{z_{1-\\alpha/2} \\sigma\\sqrt{2/n} - \\Delta}{\\sigma\\sqrt{2/n}} \\right) $$\n不等式左边是一个标准正态变量 $Z \\sim N(0,1)$。\n$$ \\text{Power} \\approx P\\left( Z  z_{1-\\alpha/2} - \\frac{\\Delta}{\\sigma\\sqrt{2/n}} \\right) $$\n我们期望把握度为 $1-\\beta$。满足 $P(Zc)=1-\\beta$ 的值 $c$ 是 $z_{1-(1-\\beta)} = z_{\\beta}$。按照惯例，$z_\\beta = -z_{1-\\beta}$。因此，我们必须有：\n$$ z_{1-\\alpha/2} - \\frac{\\Delta}{\\sigma\\sqrt{2/n}} = -z_{1-\\beta} $$\n现在我们求解每组的样本量 $n$：\n$$ z_{1-\\alpha/2} + z_{1-\\beta} = \\frac{\\Delta}{\\sigma\\sqrt{2/n}} $$\n$$ \\sqrt{n} = \\frac{\\sigma\\sqrt{2}(z_{1-\\alpha/2} + z_{1-\\beta})}{\\Delta} $$\n对两边平方，得到每组样本量的一般表达式：\n$$ n = \\frac{2\\sigma^2(z_{1-\\alpha/2} + z_{1-\\beta})^2}{\\Delta^2} $$\n这就是推导出的每组样本量的表达式。\n\n接下来，我们根据问题给出的具体数值进行计算：\n-   标准差, $\\sigma = 1$。\n-   均值差异, $\\Delta = 0.5$。\n-   I类错误率, $\\alpha = 0.05$ (双侧)。\n-   把握度, $1-\\beta = 0.9$，这意味着II类错误率为 $\\beta = 0.1$。\n\n我们从标准正态分布中查找对应的分位数：\n-   对于 $\\alpha = 0.05$，我们需要 $z_{1-\\alpha/2} = z_{1-0.025} = z_{0.975} \\approx 1.959964$。\n-   对于 $\\beta = 0.1$，我们需要 $z_{1-\\beta} = z_{1-0.1} = z_{0.9} \\approx 1.281552$。\n\n将这些值代入样本量公式：\n$$ n = \\frac{2(1)^2(1.959964 + 1.281552)^2}{(0.5)^2} $$\n$$ n = \\frac{2(3.241516)^2}{0.25} $$\n$$ n = 8 \\times (3.241516)^2 \\approx 8 \\times 10.507409 $$\n$$ n \\approx 84.05927 $$\n报告到四位有效数字，未取整的连续型每组样本量为 $84.06$。\n\n为确保把握度至少为 $0.9$，我们必须将这个连续的样本量向上取整到下一个整数。这可以通过应用向上取整函数来实现：\n$$ n_{\\text{所需}} = \\lceil 84.05927 \\rceil = 85 $$\n因此，每组需要 $85$ 名受试者。", "answer": "$$ \\boxed{85} $$", "id": "4934547"}, {"introduction": "当一项III期试验完成后，分析数据以理解药物的真实效果至关重要。不同的统计指标可以从不同角度描述试验结果，准确理解它们的含义是临床决策的基础。此练习要求你根据一组假设的试验数据，计算并解释三种核心效应量指标：风险差、风险比和优势比，从而掌握如何从绝对和相对两个维度来评估临床疗效。[@problem_id:4952905]", "problem": "一项III期随机对照试验（RCT）比较了一种新的预防性方案与标准护理在预防术后30天内感染方面的效果。在治疗组中，200名参与者中有40人出现感染。在对照组中，200名参与者中有60人出现感染。使用临床流行病学中概率和优势的核心定义，计算以下以对照组为参照的治疗组的比较效应指标：风险差（治疗组减去对照组）、风险比（治疗组风险除以对照组风险）以及优势比（治疗组优势除以对照组优势）。将每个指标表示为小数，并四舍五入到四位有效数字。然后，根据每个量如何量化组间事件发生的绝对和相对差异，从临床角度解释每个量。不要使用百分号；将任何差异的大小表示为小数。", "solution": "该问题陈述是临床流行病学和生物统计学基本原理的有效应用。它自成体系、有科学依据且表述清晰。所有必要的数据都已提供，目标也已明确定义。\n\n首先，我们根据所提供的数据定义必要的量。\n设 $e_T$ 为治疗组中发生感染（事件）的参与者人数，$n_T$ 为治疗组的总参与者人数。\n设 $e_C$ 为对照组中发生感染的参与者人数，$n_C$ 为对照组的总参与者人数。\n\n根据问题陈述，已知条件如下：\n- 治疗组：$e_T = 40$, $n_T = 200$\n- 对照组：$e_C = 60$, $n_C = 200$\n\n事件的风险是指事件在某个组中发生的概率。它通过将事件数除以该组的总参与者人数来计算。\n治疗组的风险 $R_T$ 为：\n$$ R_T = \\frac{e_T}{n_T} = \\frac{40}{200} = 0.2 $$\n对照组的风险 $R_C$ 为：\n$$ R_C = \\frac{e_C}{n_C} = \\frac{60}{200} = 0.3 $$\n\n事件的优势是事件发生的概率与事件不发生的概率之比。对于给定的风险 $R$，优势 $O$ 计算如下：\n$$ O = \\frac{R}{1 - R} $$\n治疗组的感染优势 $O_T$ 为：\n$$ O_T = \\frac{R_T}{1 - R_T} = \\frac{0.2}{1 - 0.2} = \\frac{0.2}{0.8} = 0.25 $$\n对照组的感染优势 $O_C$ 为：\n$$ O_C = \\frac{R_C}{1 - R_C} = \\frac{0.3}{1 - 0.3} = \\frac{0.3}{0.7} = \\frac{3}{7} $$\n\n现在，我们计算所要求的三个比较效应指标。\n\n1.  **风险差 (RD)**\n风险差是两组风险的绝对差值。它通过治疗组的风险减去对照组的风险来计算。\n$$ \\text{RD} = R_T - R_C = 0.2 - 0.3 = -0.1 $$\n四舍五入到四位有效数字，我们得到 $-0.1000$。\n\n2.  **风险比 (RR)**\n风险比，也称为相对风险，是治疗组风险与对照组风险的比值。\n$$ \\text{RR} = \\frac{R_T}{R_C} = \\frac{0.2}{0.3} = \\frac{2}{3} \\approx 0.66666... $$\n四舍五入到四位有效数字，我们得到 $0.6667$。\n\n3.  **优势比 (OR)**\n优势比是治疗组事件优势与对照组事件优势的比值。\n$$ \\text{OR} = \\frac{O_T}{O_C} = \\frac{0.25}{3/7} = 0.25 \\times \\frac{7}{3} = \\frac{1}{4} \\times \\frac{7}{3} = \\frac{7}{12} \\approx 0.58333... $$\n四舍五入到四位有效数字，我们得到 $0.5833$。\n\n最后，我们从临床角度解释每个指标。\n\n- **风险差（RD）的解释**：风险差为 $-0.1000$，是一个绝对效应量。负号表示与标准护理相比，新的预防性方案降低了感染风险。具体来说，新方案相关的绝对风险降低值为 $0.10$。这意味着每100名接受新方案治疗的患者中，到第30天时发生的感染比标准护理下少10例。这个值也可以用来计算为预防一个不良结局所需的治疗人数（需治数，NNT），即绝对风险降低值的倒数：$\\text{NNT} = \\frac{1}{|\\text{RD}|} = \\frac{1}{0.1} = 10$。这意味着与标准护理相比，需要用新方案治疗10名患者才能额外预防一例感染。\n\n- **风险比（RR）的解释**：风险比为 $0.6667$，是一个相对效应量。小于1的值表示治疗组的风险降低。它表明接受新方案治疗的患者的感染风险约为接受标准护理患者风险的 $0.6667$ 倍，即三分之二。这也可以表示为相对风险降低（RRR），计算公式为 $1 - \\text{RR} = 1 - 0.6667 = 0.3333$。因此，与标准护理相比，新方案将感染的相对风险降低了约 $0.3333$（或 $33.33\\%$）。\n\n- **优势比（OR）的解释**：优势比为 $0.5833$，也是一个相对效应量。小于1的值表示事件在治疗组中发生的可能性较小。它意味着接受新方案治疗的患者发生术后感染的优势约为接受标准护理患者的 $0.5833$ 倍。虽然RR通常更直观，但OR具有理想的数学特性（例如对称性，即事件的OR是无事件OR的倒数），并且是病例对照研究和逻辑回归分析中的自然效应量。当事件发生率较低时（通常  0.1），OR可以很好地近似RR。在这种情况下，风险分别为 $0.2$ 和 $0.3$，OR（$0.5833$）明显小于RR（$0.6667$），这与预期相符。", "answer": "$$ \\boxed{\\begin{pmatrix} -0.1000  0.6667  0.5833 \\end{pmatrix}} $$", "id": "4952905"}]}