{"hands_on_practices": [{"introduction": "药物与蛋白质的结合能力往往取决于其物理化学性质，尤其是其电荷状态。许多药物是弱酸或弱碱，它们在体内的离子化程度取决于生理pH值和药物自身的$pK_a$。本练习将基础的酸碱化学与药理学联系起来，通过计算药物在特定pH下的离子化分数，进而定性预测其与血浆中主要结合蛋白（如α-1-酸性糖蛋白，AAG）的结合趋势，帮助您理解药物结构、电荷与蛋白亲和力之间的关系。[@problem_id:4979928]", "problem": "一种药物是单质子弱碱，其共轭酸的酸解离常数 $K_{a}$ 满足 $pK_{a} = 9.0$。在生理条件下的血浆中，氢离子活度对应于 $pH = 7.40$。仅使用共轭酸的酸解离常数定义 $K_{a} = \\frac{[B][H^{+}]}{[BH^{+}]}$，以及 $pH = -\\log_{10}([H^{+}])$ 和 $pK_{a} = -\\log_{10}(K_{a})$ 的定义，从第一性原理推导出一个表达式，用于表示在任意 $pH$ 下，处于离子化（质子化）形式 $BH^{+}$ 的碱的比例，该表达式应以 $pH$ 和 $pK_{a}$ 表示。然后，在 $pH = 7.40$ 和 $pK_{a} = 9.0$ 的条件下计算该比例。将您最终的离子化比例数值答案四舍五入至四位有效数字，并以不带单位的小数形式表示。\n\n在计算出离子化比例后，根据电荷状态分布以及已知的 alpha-1-acid glycoprotein (AAG) 优先结合阳离子配体的特性，简要解释在生理 $pH$ 下是否预期该药物会与 AAG 发生强结合。此解释部分不需要额外的数值计算。", "solution": "该问题被评估为有效，因为它科学地基于酸碱化学和药理学原理，问题阐述清晰且提供了所有必要信息，并且没有任何事实、逻辑或结构上的缺陷。\n\n第一步是推导药物处于离子化（质子化）形式 $BH^{+}$ 的比例的通用表达式。药物的总浓度 $C_{total}$ 是未离子化形式（游离碱，$B$）和离子化形式（共轭酸，$BH^{+}$）的浓度之和。\n$$C_{total} = [B] + [BH^{+}]$$\n离子化比例，我们记为 $f_{ionized}$，定义为离子化形式的浓度除以药物总浓度。\n$$f_{ionized} = \\frac{[BH^{+}]}{C_{total}} = \\frac{[BH^{+}]}{[B] + [BH^{+}]}$$\n为了用与 $pH$ 和 $pK_a$ 相关的量来表示这个比例，我们必须首先关联两种形式的浓度，$[B]$ 和 $[BH^{+}]$。题目给出了共轭酸 $BH^{+}$ 的酸解离常数 $K_a$ 的定义：\n$$K_a = \\frac{[B][H^{+}]}{[BH^{+}]}$$\n我们可以重新整理这个表达式来求解未离子化碱的浓度 $[B]$：\n$$[B] = K_a \\frac{[BH^{+}]}{[H^{+}]}$$\n现在，我们将 $[B]$ 的这个表达式代入 $f_{ionized}$ 的方程中：\n$$f_{ionized} = \\frac{[BH^{+}]}{\\left(K_a \\frac{[BH^{+}]}{[H^{+}]}\\right) + [BH^{+}]}$$\n项 $[BH^{+}]$ 同时出现在分子和分母的每一项中，因此可以提取出来并约分：\n$$f_{ionized} = \\frac{[BH^{+}]}{[BH^{+}] \\left(\\frac{K_a}{[H^{+}]} + 1\\right)} = \\frac{1}{\\frac{K_a}{[H^{+}]} + 1}$$\n这个表达式给出了以 $K_a$ 和 $[H^{+}]$ 表示的离子化比例。题目要求用 $pK_a$ 和 $pH$ 来表示。我们使用给定的定义：$pK_a = -\\log_{10}(K_a)$ 和 $pH = -\\log_{10}([H^{+}])$。这些可以重写为指数形式 $K_a = 10^{-pK_a}$ 和 $[H^{+}] = 10^{-pH}$。将这些代入我们的 $f_{ionized}$ 表达式中：\n$$f_{ionized} = \\frac{1}{\\frac{10^{-pK_a}}{10^{-pH}} + 1}$$\n使用指数性质 $\\frac{10^a}{10^b} = 10^{a-b}$，分母中的比率变为：\n$$\\frac{10^{-pK_a}}{10^{-pH}} = 10^{-pK_a - (-pH)} = 10^{pH - pK_a}$$\n将其代回，得到在任意 $pH$ 下离子化比例的最终推导表达式：\n$$f_{ionized} = \\frac{1}{10^{pH - pK_a} + 1}$$\n接下来，我们针对给定条件 $pH = 7.40$ 和 $pK_a = 9.0$ 计算这个比例。\n$$pH - pK_a = 7.40 - 9.0 = -1.60$$\n将这个值代入表达式中：\n$$f_{ionized} = \\frac{1}{10^{-1.60} + 1}$$\n我们计算 $10^{-1.60}$ 的值：\n$$10^{-1.60} \\approx 0.02511886$$\n现在，我们计算这个比例：\n$$f_{ionized} \\approx \\frac{1}{0.02511886 + 1} = \\frac{1}{1.02511886} \\approx 0.975499$$\n按照要求将此结果四舍五入到四位有效数字，我们得到：\n$$f_{ionized} \\approx 0.9755$$\n\n最后，我们来讨论与 alpha-1-acid glycoprotein (AAG) 结合的问题。计算表明，在生理 $pH$ 值为 $7.40$ 时，药物的离子化比例约为 $0.9755$。这意味着超过 $97\\%$ 的药物以其质子化的共轭酸形式 $BH^{+}$ 存在。这种形式带有正电荷，使其成为阳离子。鉴于已知 AAG 优先结合阳离子配体，并且该药物在生理条件下绝大部分以阳离子形式存在，因此可以预期它会与 AAG 发生强结合。", "answer": "$$\\boxed{0.9755}$$", "id": "4979928"}, {"introduction": "在理解了药物是否可能与蛋白质结合后，下一步是量化其结合程度。本练习将带您从定性预测转向定量计算，探索蛋白质结合的非线性特征。您将学习到，药物的未结合分数$f_u$并非一个恒定值，它会随着药物总浓度的变化而改变，尤其是在高浓度下，这涉及到可饱和的结合位点和平衡解离常数$K_d$等核心概念。通过解决这个基于Langmuir结合等温线的实际问题，您将能更深刻地理解药物与蛋白质相互作用的动态平衡。[@problem_id:4980018]", "problem": "一种药物可逆地与组织中单一、均质的蛋白质位点结合。该结合的特征是有限的最大结合位点浓度 $B_{\\max}$ 和平衡解离常数 $K_d$。设组织中的总药物浓度为 $C_t$，游离（未结合）药物浓度为 $C_f$，结合药物浓度为 $B$。定义未结合分数 $f_u$ 为游离浓度与总浓度的比值，即 $f_u = C_f / C_t$。假设瞬时达到平衡，组织内无代谢，且结合遵循单位点可逆相互作用。\n\n给定 $B_{\\max} = 600\\ \\mu \\mathrm{M}$，$K_d = 10\\ \\mu \\mathrm{M}$，以及 $C_t = 1\\ \\mu \\mathrm{M}$，计算 $f_u$。将您的数值结果四舍五入至四位有效数字，并以无单位的小数形式表示。在计算出 $f_u$ 后，根据 $C_f$ 相对于 $K_d$ 的大小以及比值 $B/B_{\\max}$，判断结合位点是处于低占有率（线性）区域还是接近饱和，但不要将此解释包含在您的最终数值答案中。", "solution": "该问题要求计算药物与组织蛋白结合时的未结合分数 $f_u$。总药物浓度 ($C_t$)、游离药物浓度 ($C_f$) 和结合药物浓度 ($B$) 之间的关系由质量平衡方程给出：\n$$C_t = C_f + B \\quad (1)$$\n未结合分数 $f_u$ 定义为游离药物浓度与总药物浓度的比值：\n$$f_u = \\frac{C_f}{C_t} \\quad (2)$$\n结合过程被描述为处于平衡状态的单位点可逆相互作用。这可以用Langmuir结合等温线来表征，它将结合浓度 $B$ 与游离浓度 $C_f$ 联系起来：\n$$B = \\frac{B_{\\max} C_f}{K_d + C_f} \\quad (3)$$\n此处，$B_{\\max}$ 是最大结合位点浓度，$K_d$ 是平衡解离常数。\n\n为了求解 $f_u$，我们必须首先确定 $C_f$ 的值。我们可以通过将方程 $(3)$ 代入方程 $(1)$，得到一个仅含 $C_f$ 的方程：\n$$C_t = C_f + \\frac{B_{\\max} C_f}{K_d + C_f}$$\n为了求解 $C_f$，我们将此方程变形为一个标准的二次方程形式。我们将所有项乘以 $(K_d + C_f)$，这是允许的，因为浓度是非负的，从而确保 $K_d + C_f  0$：\n$$C_t (K_d + C_f) = C_f (K_d + C_f) + B_{\\max} C_f$$\n展开乘积得到：\n$$C_t K_d + C_t C_f = K_d C_f + C_f^2 + B_{\\max} C_f$$\n将各项移到一边，得到一个关于变量 $C_f$ 的二次方程：\n$$C_f^2 + (K_d + B_{\\max}) C_f - C_t C_f - C_t K_d = 0$$\n$$C_f^2 + (K_d + B_{\\max} - C_t) C_f - C_t K_d = 0$$\n该方程具有一般二次方程形式 $ax^2 + bx + c = 0$，其中 $x = C_f$，系数为：\n$$a = 1$$\n$$b = K_d + B_{\\max} - C_t$$\n$$c = -C_t K_d$$\n$C_f$ 的解可以使用二次公式求得：\n$$C_f = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n$$C_f = \\frac{-(K_d + B_{\\max} - C_t) \\pm \\sqrt{(K_d + B_{\\max} - C_t)^2 - 4(1)(-C_t K_d)}}{2}$$\n作为一个物理量，$C_f$ 必须是非负的。两个根的乘积由 $c/a = -C_t K_d$ 给出，该值为负（因为 $C_t  0$ 且 $K_d  0$）。这意味着一个根是正的，另一个根是负的。为了获得物理上有效的正根，我们必须在分子中选择‘$+$’号：\n$$C_f = \\frac{-(K_d + B_{\\max} - C_t) + \\sqrt{(K_d + B_{\\max} - C_t)^2 + 4C_t K_d}}{2}$$\n问题提供了以下数值：$B_{\\max} = 600\\ \\mu \\mathrm{M}$，$K_d = 10\\ \\mu \\mathrm{M}$，以及 $C_t = 1\\ \\mu \\mathrm{M}$。我们将这些值代入系数 $b$ 和 $c$ 的表达式中：\n$$b = 10\\ \\mu \\mathrm{M} + 600\\ \\mu \\mathrm{M} - 1\\ \\mu \\mathrm{M} = 609\\ \\mu \\mathrm{M}$$\n$$c = -(1\\ \\mu \\mathrm{M})(10\\ \\mu \\mathrm{M}) = -10\\ (\\mu \\mathrm{M})^2$$\n现在，我们计算 $C_f$ 的值：\n$$C_f = \\frac{-609\\ \\mu \\mathrm{M} + \\sqrt{(609\\ \\mu \\mathrm{M})^2 + 4(1\\ \\mu \\mathrm{M})(10\\ \\mu \\mathrm{M})}}{2}$$\n$$C_f = \\frac{-609 + \\sqrt{370881 + 40}}{2}\\ \\mu \\mathrm{M}$$\n$$C_f = \\frac{-609 + \\sqrt{370921}}{2}\\ \\mu \\mathrm{M}$$\n计算 $C_f$ 的数值结果得出：\n$$C_f \\approx \\frac{-609 + 609.0328399}{2}\\ \\mu \\mathrm{M} \\approx 0.01641995\\ \\mu \\mathrm{M}$$\n在确定了 $C_f$ 之后，我们可以使用方程 $(2)$ 计算未结合分数 $f_u$：\n$$f_u = \\frac{C_f}{C_t} = \\frac{0.01641995\\ \\mu \\mathrm{M}}{1\\ \\mu \\mathrm{M}} = 0.01641995$$\n问题要求最终答案应四舍五入至四位有效数字。\n$$f_u \\approx 0.01642$$\n\n此外，问题要求判断结合位点是处于低占有率区域还是接近饱和。我们将计算出的游离浓度 $C_f \\approx 0.01642\\ \\mu \\mathrm{M}$ 与解离常数 $K_d = 10\\ \\mu \\mathrm{M}$ 进行比较。由于 $C_f \\ll K_d$，结合处于低占有率（线性）区域。我们也可以评估位点占有率分数，$B/B_{\\max}$。结合浓度为 $B = C_t - C_f \\approx 1\\ \\mu \\mathrm{M} - 0.01642\\ \\mu \\mathrm{M} = 0.98358\\ \\mu \\mathrm{M}$。占有率为：\n$$\\text{Occupancy} = \\frac{B}{B_{\\max}} = \\frac{0.98358\\ \\mu \\mathrm{M}}{600\\ \\mu \\mathrm{M}} \\approx 0.00164$$\n这对应于仅约 $0.16\\%$ 的占有率，证实了结合位点远未达到饱和。", "answer": "$$\\boxed{0.01642}$$", "id": "4980018"}, {"introduction": "最后的这个实践练习将前述概念整合到一个动态系统中，展示了基础的结合参数——如血浆和组织中的未结合分数（$f_u$和$f_{u,t}$）——如何成为构建药代动力学模型的关键输入。通过参数化一个基础的生理药代动力学（PBPK）模型，您将模拟药物在体内的分布和消除过程，并预测其浓度随时间的变化。这项练习让您一窥现代药理学中基于模拟的研究方法，体验如何将微观的结合特性转化为宏观的药物行为预测，这是连接理论与临床应用的重要一步。[@problem_id:4980010]", "problem": "给定一种假想药物在血浆和组织中测得的游离分数，分别表示为 $f_u$ 和 $f_{u,t}$。您必须使用这些测量值，对一个由两个房室组成的最小化基于生理的药代动力学 (PBPK) 模型进行参数化：血浆和单个集总组织。假设：\n- 游离药物在毛细血管壁两侧瞬时达到平衡（平衡时血浆和组织中的游离浓度相等）。\n- 组织为灌注限制型，具有恒定的血流量 $Q$ (单位为 $\\mathrm{L/h}$)。\n- 全身消除发生在血浆中，其速率与游离血浆浓度成正比，游离清除率为 $CL_u$ (单位为 $\\mathrm{L/h}$)。\n- 在 $t=0$ 时，将剂量为 $D$ (单位为 $\\mathrm{mg}$) 的药物以静脉推注方式给入血浆房室。\n\n从基本的药理学定义出发：\n- 血浆中的游离分数 $f_u$ 是血浆中游离药物浓度与总药物浓度之比。\n- 组织中的游离分数 $f_{u,t}$ 是组织中游离药物浓度与总药物浓度之比。\n- 当被动分布占主导时，在充分混合的相邻空间之间，平衡状态下的游离浓度相等。\n\n根据这些原理，推导：\n1) 通过令平衡时的游离浓度相等，并使用分配系数（定义为平衡时总组织浓度与总血浆浓度之比）的定义，用 $f_u$ 和 $f_{u,t}$ 表示组织-血浆分配系数 $K_p$。\n2) 血浆和组织中药物总量 $A_p(t)$ 和 $A_t(t)$ (单位为 $\\mathrm{mg}$) 的质量平衡常微分方程 (ODE)，其中总血浆浓度为 $C_p(t)=A_p(t)/V_p$，总组织浓度为 $C_t(t)=A_t(t)/V_t$。该 ODE 必须表达：\n   - 在瞬时平衡的假设下，由灌注以及血浆浓度与离开组织的静脉血浓度之间的差异驱动的交换。\n   - 从血浆中消除，速率与游离血浆浓度成正比。\n3) 该两房室最小化模型的稳态分布容积 $V_{ss}$ (单位为 $\\mathrm{L}$)。\n\n程序要求：\n- 实现推导出的关于 $A_p(t)$ 和 $A_t(t)$ 的 ODE 系统。\n- 使用推导出的 $K_p$ 对模型进行参数化。\n- 在向血浆中静脉推注剂量 $D$ 后，模拟系统从 $t=0$ 到 $t=24$ (单位为 $\\mathrm{h}$) 的行为。\n- 对每个测试用例，计算：\n  - 稳态分布容积 $V_{ss}$ (单位为 $\\mathrm{L}$)。\n  - 在 $t=1$ $\\mathrm{h}$、$t=4$ $\\mathrm{h}$ 和 $t=24$ $\\mathrm{h}$ 时的总组织浓度 $C_t(t)$ (单位为 $\\mathrm{mg/L}$)。\n\n使用的物理单位：\n- 容积 $V_p$、$V_t$ 和 $V_{ss}$ 单位为 $\\mathrm{L}$。\n- 流量 $Q$ 和清除率 $CL_u$ 单位为 $\\mathrm{L/h}$。\n- 剂量 $D$ 单位为 $\\mathrm{mg}$。\n- 浓度 $C_p$、$C_t$ 单位为 $\\mathrm{mg/L}$。\n- 时间 $t$ 单位为 $\\mathrm{h}$。\n\n$t=0$ 时的初始条件：\n- $A_p(0)=D$。\n- $A_t(0)=0$。\n\n测试套件 (每个用例是一个元组 $\\left(f_u, f_{u,t}, V_p, V_t, Q, CL_u, D\\right)$)：\n- 用例 1: $\\left(0.1, 0.01, 3.0, 35.0, 60.0, 3.0, 100.0\\right)$。\n- 用例 2: $\\left(0.5, 0.5, 3.0, 35.0, 60.0, 3.0, 100.0\\right)$。\n- 用例 3: $\\left(0.02, 0.2, 3.0, 35.0, 60.0, 3.0, 100.0\\right)$。\n- 用例 4: $\\left(1.0, 0.01, 3.0, 35.0, 60.0, 3.0, 100.0\\right)$。\n\n输出规范：\n- 您的程序必须为每个测试用例计算一个列表，其中包含：\n  - $V_{ss}$ (单位为 $\\mathrm{L}$)。\n  - $C_t(1\\,\\mathrm{h})$ (单位为 $\\mathrm{mg/L}$)。\n  - $C_t(4\\,\\mathrm{h})$ (单位为 $\\mathrm{mg/L}$)。\n  - $C_t(24\\,\\mathrm{h})$ (单位为 $\\mathrm{mg/L}$)。\n- 将所有报告的浮点数四舍五入到恰好 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表，用方括号括起，并按测试用例的顺序排列。例如：\n  - $[[V_{ss,1}, C_{t,1}(1), C_{t,1}(4), C_{t,1}(24)], [V_{ss,2}, C_{t,2}(1), C_{t,2}(4), C_{t,2}(24)], \\dots]$\n- 所有量均使用上述指定单位表示，输出值中不包括单位符号。如上所述，所有时间单位为 $\\mathrm{h}$，浓度单位为 $\\mathrm{mg/L}$；$V_{ss}$ 单位为 $\\mathrm{L}$。\n\n您的实现必须是一个完整、可运行的程序，为所提供的测试套件执行这些计算，而无需任何用户输入或外部数据文件。", "solution": "在尝试求解之前，对用户提供的问题进行有效性评估。\n\n### 步骤1：提取已知条件\n\n- **符号和定义：**\n    - 血浆中的游离分数：$f_u$，血浆中游离药物浓度与总药物浓度之比。\n    - 组织中的游离分数：$f_{u,t}$，组织中游离药物浓度与总药物浓度之比。\n    - 血流量：$Q$ (单位为 $\\mathrm{L/h}$)。\n    - 游离清除率：$CL_u$ (单位为 $\\mathrm{L/h}$)。\n    - 静脉推注剂量：$D$ (单位为 $\\mathrm{mg}$)。\n    - 血浆中的药物量：$A_p(t)$ (单位为 $\\mathrm{mg}$)。\n    - 组织中的药物量：$A_t(t)$ (单位为 $\\mathrm{mg}$)。\n    - 总血浆浓度：$C_p(t) = A_p(t)/V_p$。\n    - 总组织浓度：$C_t(t) = A_t(t)/V_t$。\n    - 血浆容积：$V_p$ (单位为 $\\mathrm{L}$)。\n    - 组织容积：$V_t$ (单位为 $\\mathrm{L}$)。\n    - 组织-血浆分配系数：$K_p$。\n    - 稳态分布容积：$V_{ss}$ (单位为 $\\mathrm{L}$)。\n- **假设：**\n    1. 一个两房室模型：血浆和单个集总组织。\n    2. 游离药物在毛细血管壁两侧瞬时达到平衡：血浆和组织中的游离浓度相等。\n    3. 组织为灌注限制型，具有恒定的血流量 $Q$。\n    4. 全身消除发生在血浆中，其速率与游离血浆浓度成正比，由 $CL_u$ 控制。\n    5. 在时间 $t=0$ 时，将静脉推注剂量 $D$ 给入血浆房室。\n- **初始条件：**\n    - $A_p(0) = D$。\n    - $A_t(0) = 0$。\n- **测试套件：** 一组四个测试用例，每个都是参数元组 $(f_u, f_{u,t}, V_p, V_t, Q, CL_u, D)$：\n    - 用例 1: $(0.1, 0.01, 3.0, 35.0, 60.0, 3.0, 100.0)$。\n    - 用例 2: $(0.5, 0.5, 3.0, 35.0, 60.0, 3.0, 100.0)$。\n    - 用例 3: $(0.02, 0.2, 3.0, 35.0, 60.0, 3.0, 100.0)$。\n    - 用例 4: $(1.0, 0.01, 3.0, 35.0, 60.0, 3.0, 100.0)$。\n- **所需计算：**\n    1. 推导 $K_p$ 关于 $f_u$ 和 $f_{u,t}$ 的表达式。\n    2. 推导 $A_p(t)$ 和 $A_t(t)$ 的质量平衡常微分方程 (ODE)。\n    3. 推导 $V_{ss}$ 的表达式。\n    4. 对每个测试用例，计算 $V_{ss}$ 以及在 $t=1\\,\\mathrm{h}$、$t=4\\,\\mathrm{h}$ 和 $t=24\\,\\mathrm{h}$ 时的 $C_t(t)$。\n- **输出格式：**\n    - 一行文本，表示一个列表的列表：$[[V_{ss,1}, C_{t,1}(1), \\dots], [V_{ss,2}, \\dots], \\dots]$。\n    - 所有数值结果四舍五入到 $6$ 位小数。\n\n### 步骤2：使用提取的已知条件进行验证\n\n- **科学依据：** 该问题牢固地植根于药代动力学的基本原理，特别是基于生理的药代动力学 (PBPK) 建模。蛋白质结合（由 $f_u$ 和 $f_{u,t}$ 表示）、灌注限制性分布、分配系数、清除率和分布容积等概念都是该领域的标准和核心内容。该模型是一种常见且有效的简化。\n- **良态问题：** 该问题是良态的。它要求推导标准药代动力学参数，并求解一个定义明确的线性一阶常微分方程组的初值问题。所有必要的参数和初始条件都已提供，确保存在唯一且稳定的数值解。\n- **客观性：** 问题以精确、定量和无偏见的语言陈述。所有术语均为该学科内的标准术语。\n\n问题没有表现出科学上不健全、不完整、矛盾或模糊等任何缺陷。这些假设是 PBPK 建模入门中标准的简化假设。\n\n### 步骤3：结论与行动\n\n问题陈述是 **有效的**。将提供解决方案。\n\n***\n\n### 解题推导\n\n解决方案需要三个连续的推导步骤，然后进行数值实现。\n\n**1. 组织-血浆分配系数 ($K_p$) 的推导**\n\n组织-血浆分配系数 $K_p$ 定义为平衡状态下组织中总药物浓度 $C_t$ 与血浆中总药物浓度 $C_p$ 之比。\n$$ K_p = \\frac{C_t^{eq}}{C_p^{eq}} $$\n游离分数定义为：\n$$ f_u = \\frac{C_{u,p}}{C_p} \\quad \\text{和} \\quad f_{u,t} = \\frac{C_{u,t}}{C_t} $$\n其中 $C_{u,p}$ 和 $C_{u,t}$ 分别是血浆和组织中的游离浓度。整理可得：\n$$ C_p = \\frac{C_{u,p}}{f_u} \\quad \\text{和} \\quad C_t = \\frac{C_{u,t}}{f_{u,t}} $$\n一个核心假设是，由于被动扩散，平衡时各房室间的游离药物浓度相等：\n$$ C_{u,p}^{eq} = C_{u,t}^{eq} $$\n将总浓度的表达式代入 $K_p$ 的定义：\n$$ K_p = \\frac{C_t^{eq}}{C_p^{eq}} = \\frac{C_{u,t}^{eq} / f_{u,t}}{C_{u,p}^{eq} / f_u} $$\n由于 $C_{u,p}^{eq} = C_{u,t}^{eq}$，我们可以消去这些项：\n$$ K_p = \\frac{1/f_{u,t}}{1/f_u} = \\frac{f_u}{f_{u,t}} $$\n该方程将药物在组织和血浆之间的分配与其在每个房室中的结合程度联系起来。\n\n**2. 质量平衡常微分方程 (ODE) 的推导**\n\n我们为血浆中药物量 $A_p(t)$ 和组织中药物量 $A_t(t)$ 的变化率构建一个常微分方程组。\n\n对于组织房室：药物量的变化 $dA_t/dt$ 是药物进入的速率减去通过血流 $Q$ 离开的速率。\n- 进入速率：$Q \\cdot C_p(t)$，其中 $C_p(t)=A_p(t)/V_p$ 是进入组织的动脉血浆浓度。\n- 离开速率：$Q \\cdot C_{p,ven}(t)$，其中 $C_{p,ven}(t)$ 是离开组织的静脉血浆浓度。\n\n在灌注限制模型中，假定离开组织的静脉血中的药物与组织本身中的药物处于平衡状态。这种平衡由分配系数 $K_p$ 描述。\n$$ K_p = \\frac{C_t(t)}{C_{p,ven}(t)} \\implies C_{p,ven}(t) = \\frac{C_t(t)}{K_p} $$\n代入浓度表达式 ($C_p(t) = A_p(t)/V_p$ 和 $C_t(t) = A_t(t)/V_t$)：\n$$ \\frac{dA_t}{dt} = Q \\left( \\frac{A_p(t)}{V_p} - \\frac{A_t(t)/V_t}{K_p} \\right) = Q \\left( \\frac{A_p(t)}{V_p} - \\frac{A_t(t)}{K_p V_t} \\right) $$\n\n对于血浆房室：药物量的变化 $dA_p/dt$ 由与组织的交换和全身消除决定。\n- 与组织的交换：药物从血浆*到*组织的净转移速率为 $\\frac{dA_t}{dt}$。因此，从组织*到*血浆的净转移速率为 $-\\frac{dA_t}{dt}$。\n$Q \\left( \\frac{A_t(t)}{K_p V_t} - \\frac{A_p(t)}{V_p} \\right)$\n- 消除：消除发生在血浆中，其速率与游离血浆浓度 $C_{u,p}(t)$ 成正比，比例常数为游离清除率 $CL_u$。\n- 消除速率 = $CL_u \\cdot C_{u,p}(t) = CL_u \\cdot (f_u C_p(t)) = CL_u f_u \\frac{A_p(t)}{V_p}$。\n\n结合这些项，得到血浆房室的 ODE：\n$$ \\frac{dA_p}{dt} = Q \\left( \\frac{A_t(t)}{K_p V_t} - \\frac{A_p(t)}{V_p} \\right) - \\frac{CL_u f_u}{V_p} A_p(t) $$\n\n完整的 ODE 系统为：\n$$ \\frac{dA_p}{dt} = -\\left( \\frac{Q}{V_p} + \\frac{CL_u f_u}{V_p} \\right) A_p(t) + \\left( \\frac{Q}{K_p V_t} \\right) A_t(t) $$\n$$ \\frac{dA_t}{dt} = \\left( \\frac{Q}{V_p} \\right) A_p(t) - \\left( \\frac{Q}{K_p V_t} \\right) A_t(t) $$\n\n**3. 稳态分布容积 ($V_{ss}$) 的推导**\n\n稳态分布容积 $V_{ss}$ 是一个比例常数，它将体内药物总量与稳态时的血浆浓度联系起来。\n$$ V_{ss} = \\frac{A_{total}^{ss}}{C_p^{ss}} = \\frac{A_p^{ss} + A_t^{ss}}{C_p^{ss}} $$\n在稳态下，房室之间的净通量为零，所以 $dA_t/dt = 0$。从组织的 ODE 可知：\n$$ Q \\left( \\frac{A_p^{ss}}{V_p} - \\frac{A_t^{ss}}{K_p V_t} \\right) = 0 \\implies \\frac{A_p^{ss}}{V_p} = \\frac{A_t^{ss}}{K_p V_t} $$\n这可以写成浓度的形式：$C_p^{ss} = C_t^{ss}/K_p$，即平衡条件。整理得到 $A_t^{ss}$：\n$$ A_t^{ss} = K_p \\frac{V_t}{V_p} A_p^{ss} $$\n将此代入 $V_{ss}$ 的表达式：\n$$ V_{ss} = \\frac{A_p^{ss} + K_p \\frac{V_t}{V_p} A_p^{ss}}{C_p^{ss}} = \\frac{A_p^{ss} \\left( 1 + K_p \\frac{V_t}{V_p} \\right)}{A_p^{ss}/V_p} $$\n消去 $A_p^{ss}$ 并化简：\n$$ V_{ss} = V_p \\left( 1 + K_p \\frac{V_t}{V_p} \\right) = V_p + K_p V_t $$\n最后，代入推导出的表达式 $K_p = f_u/f_{u,t}$：\n$$ V_{ss} = V_p + \\left( \\frac{f_u}{f_{u,t}} \\right) V_t $$\n\n### 数值实现\n\n为了找到特定时间点的 $C_t(t)$，我们必须求解由推导出的 ODE 和初始条件 $A_p(0)=D$ 及 $A_t(0)=0$ 定义的初值问题。\n1. 对每个测试用例，使用参数 $(f_u, f_{u,t}, V_p, V_t, Q, CL_u, D)$。\n2. 首先，直接用推导出的公式计算 $K_p$ 和 $V_{ss}$。\n3. 将 ODE 系统定义为一个函数，供数值求解器使用。\n4. 使用 `scipy.integrate.solve_ivp` 函数对 ODE 系统从 $t=0$ 到 $t=24\\,\\mathrm{h}$ 进行积分。使用 `t_eval` 参数请求在 $t \\in \\{1, 4, 24\\}\\,\\mathrm{h}$ 时的解。\n5. 求解器返回在所请求时间点的药物量 $A_p(t)$ 和 $A_t(t)$。\n6. 通过将组织中的药物量 $A_t(t)$ 除以组织容积 $V_t$，计算组织浓度 $C_t(t)$。\n7. 收集所需的值 $V_{ss}$ 和三个 $C_t(t)$ 值，四舍五入到 $6$ 位小数，并按指定格式进行格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves a two-compartment PBPK model problem.\n    Derives Kp, Vss, and simulates ODEs for drug concentrations.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (fu, fut, Vp, Vt, Q, CLu, D)\n    test_cases = [\n        (0.1, 0.01, 3.0, 35.0, 60.0, 3.0, 100.0),\n        (0.5, 0.5, 3.0, 35.0, 60.0, 3.0, 100.0),\n        (0.02, 0.2, 3.0, 35.0, 60.0, 3.0, 100.0),\n        (1.0, 0.01, 3.0, 35.0, 60.0, 3.0, 100.0),\n    ]\n\n    all_results = []\n    \n    # Time points for evaluation in hours\n    t_eval_points = np.array([1.0, 4.0, 24.0])\n    t_span = [0, t_eval_points[-1]]\n\n    def pbpk_odes(t, y, Vp, Vt, Q, CLu, fu, Kp):\n        \"\"\"\n        Defines the system of ordinary differential equations for the 2-compartment model.\n        \n        Args:\n            t (float): Time.\n            y (list): State vector [Ap, At], amounts in plasma and tissue.\n            Vp (float): Plasma volume (L).\n            Vt (float): Tissue volume (L).\n            Q (float): Blood flow (L/h).\n            CLu (float): Unbound clearance (L/h).\n            fu (float): Unbound fraction in plasma.\n            Kp (float): Tissue-to-plasma partition coefficient.\n            \n        Returns:\n            list: Derivatives [dAp/dt, dAt/dt].\n        \"\"\"\n        Ap, At = y\n        \n        # Concentrations\n        Cp = Ap / Vp\n        Ct = At / Vt\n        \n        # Venous plasma concentration leaving tissue\n        C_p_ven = Ct / Kp\n        \n        # ODE for tissue compartment\n        dAt_dt = Q * (Cp - C_p_ven)\n        \n        # ODE for plasma compartment\n        elimination_rate = CLu * fu * Cp\n        dAp_dt = Q * (C_p_ven - Cp) - elimination_rate\n        \n        return [dAp_dt, dAt_dt]\n\n    for case in test_cases:\n        fu, fut, Vp, Vt, Q, CLu, D = case\n        \n        # Step 1: Calculate the partition coefficient Kp\n        # Kp = fu / fut\n        Kp = fu / fut\n        \n        # Step 2: Calculate the steady-state volume of distribution Vss\n        # Vss = Vp + Kp * Vt\n        Vss = Vp + Kp * Vt\n        \n        # Step 3: Set up and solve the ODE system\n        # Initial conditions: Ap(0) = D, At(0) = 0\n        y0 = [D, 0.0]\n        \n        # Arguments to pass to the ODE function\n        args = (Vp, Vt, Q, CLu, fu, Kp)\n        \n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=pbpk_odes,\n            t_span=t_span,\n            y0=y0,\n            args=args,\n            t_eval=t_eval_points,\n            method='RK45', \n            rtol=1e-9, \n            atol=1e-12\n        )\n        \n        # Extract tissue amounts at evaluation times\n        At_values = sol.y[1]\n        \n        # Calculate tissue concentrations\n        Ct_values = At_values / Vt\n        \n        # Assemble the results for this case and round\n        case_results = [Vss] + list(Ct_values)\n        rounded_results = [round(x, 6) for x in case_results]\n        all_results.append(rounded_results)\n\n    # Final print statement in the exact required format\n    # The string representation of a list is \"[item1, item2, ...]\"\n    # Joining these string representations with a comma creates the desired output.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "4980010"}]}