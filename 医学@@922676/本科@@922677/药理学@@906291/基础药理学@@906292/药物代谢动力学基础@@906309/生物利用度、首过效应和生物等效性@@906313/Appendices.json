{"hands_on_practices": [{"introduction": "绝对生物利用度 ($F$) 是一个关键的药代动力学参数，它量化了口服药物有多少比例能够进入体循环。本练习将让你实践如何利用静脉和口服给药的实验性血药浓度-时间曲线下面积 (AUC) 数据，来计算这一基本参数。掌握这种剂量校正的计算方法，是理解药物吸收特性的第一个基本步骤。[@problem_id:4928516]", "problem": "对一种已知具有线性和给药途径非依赖性系统清除率特征的药物，进行了一项单剂量药代动力学研究。该药物在不同时间分别以静脉（IV）推注和口服速释片的形式给予同一名健康志愿者，并设有充分的清洗期。获得了以下数据：静脉注射剂量 $D_{iv} = 100\\,\\text{mg}$ 后，从零时到无穷大的曲线下面积（AUC）为 $AUC_{iv} = 80\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}$；口服剂量 $D_{oral} = 200\\,\\text{mg}$ 后，口服给药的AUC为 $AUC_{oral} = 48\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}$。\n\n假设药代动力学为线性，不同给药途径的系统清除率相同，且给药期间生理学上的时间依赖性变化可忽略不计。绝对生物利用度 $F$ 定义为给药剂量中以原形药物形式到达体循环的部分。利用以下基本事实：AUC是血浆浓度的时间积分，$AUC = \\int_{0}^{\\infty} C(t)\\, dt$；在线性药代动力学条件下，全身暴露量与到达体循环的药量成正比，与系统清除率成反比。\n\n根据这些数据计算绝对生物利用度 $F$。将您的答案四舍五入至四位有效数字，并以无单位的小数形式表示。简要地用文字评估计算出的 $F$ 对于经受全身前损失（如肝脏首过效应）的药物是否合理，但最终答案只提供 $F$ 的数值。", "solution": "该问题经确认具有科学依据、问题明确且客观。其包含充分且一致的信息，足以根据已确立的药代动力学原理确定药物的绝对生物利用度。\n\n分析始于线性药代动力学的基本原理。该原理指出，从零时到无穷大的血浆浓度-时间曲线下面积（记为 $AUC$）与以原形到达体循环的药物总量 $D_{\\text{systemic}}$ 成正比，与药物的系统清除率 $CL$ 成反比。该关系在数学上表示为：\n$$AUC = \\frac{D_{\\text{systemic}}}{CL}$$\n\n对于静脉（IV）给药，全部剂量直接进入体循环。根据定义，静脉注射剂量的生物利用度为 $100\\%$，即 $1$。因此，到达体循环的药量等于静脉注射剂量 $D_{iv}$。相应的曲线下面积为 $AUC_{iv}$。静脉给药途径的方程为：\n$$AUC_{iv} = \\frac{1 \\times D_{iv}}{CL} = \\frac{D_{iv}}{CL}$$\n问题给出的值为 $D_{iv} = 100\\,\\mathrm{mg}$ 和 $AUC_{iv} = 80\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}$。\n\n对于口服（血管外）给药，只有一部分给药剂量 $D_{oral}$ 到达体循环。这是由于可能存在胃肠道吸收不完全和/或在肠壁和肝脏中的全身前代谢（首过效应）。这个分数被定义为绝对生物利用度，用符号 $F$ 表示。因此，到达体循环的药量为 $D_{\\text{systemic}} = F \\times D_{oral}$。相应的曲线下面积为 $AUC_{oral}$。口服途径的主导方程为：\n$$AUC_{oral} = \\frac{F \\times D_{oral}}{CL}$$\n问题给出的值为 $D_{oral} = 200\\,\\mathrm{mg}$ 和 $AUC_{oral} = 48\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}$。\n\n问题中陈述的一个关键前提是系统清除率 $CL$ 是给药途径非依赖性的。这意味着对于静脉和口服两种给药方式，$CL$ 的值是相同的。这使我们能够从每组数据中推导出 $CL$ 的表达式，并将它们相等。\n\n根据静脉注射数据，我们可以将 $CL$ 表示为：\n$$CL = \\frac{D_{iv}}{AUC_{iv}}$$\n\n根据口服数据，$CL$ 可以表示为：\n$$CL = \\frac{F \\times D_{oral}}{AUC_{oral}}$$\n\n将常数 $CL$ 的两个表达式相等：\n$$\\frac{D_{iv}}{AUC_{iv}} = \\frac{F \\times D_{oral}}{AUC_{oral}}$$\n\n该方程可以重新整理以求解绝对生物利用度 $F$：\n$$F = \\frac{AUC_{oral}}{AUC_{iv}} \\times \\frac{D_{iv}}{D_{oral}}$$\n该公式通常表示为口服途径的剂量标准化 $AUC$ 值与静脉途径的剂量标准化 $AUC$ 值之比：\n$$F = \\frac{AUC_{oral} / D_{oral}}{AUC_{iv} / D_{iv}}$$\n\n我们现在将给定的数值代入此表达式：\n$D_{iv} = 100\\,\\mathrm{mg}$\n$AUC_{iv} = 80\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}$\n$D_{oral} = 200\\,\\mathrm{mg}$\n$AUC_{oral} = 48\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}$\n\n$$F = \\frac{(48\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}) / (200\\,\\mathrm{mg})}{(80\\,\\mathrm{mg}\\cdot\\mathrm{h}\\cdot\\mathrm{L}^{-1}) / (100\\,\\mathrm{mg})}$$\n\n首先，我们计算剂量标准化的 $AUC$ 值。每个项的结果单位将是 $\\mathrm{h}\\cdot\\mathrm{L}^{-1}$。\n对于口服剂量：\n$$\\frac{AUC_{oral}}{D_{oral}} = \\frac{48}{200} \\, \\mathrm{h}\\cdot\\mathrm{L}^{-1} = 0.24 \\, \\mathrm{h}\\cdot\\mathrm{L}^{-1}$$\n对于静脉注射剂量：\n$$\\frac{AUC_{iv}}{D_{iv}} = \\frac{80}{100} \\, \\mathrm{h}\\cdot\\mathrm{L}^{-1} = 0.80 \\, \\mathrm{h}\\cdot\\mathrm{L}^{-1}$$\n\n将这些值代回 $F$ 的方程中：\n$$F = \\frac{0.24}{0.80} = \\frac{24}{80} = \\frac{3 \\times 8}{10 \\times 8} = \\frac{3}{10} = 0.3$$\n问题要求答案报告为四位有效数字。作为一个无单位的小数，即为 $0.3000$。\n\n计算出的绝对生物利用度 $F = 0.3000$ 表明，口服给药的药物中有 $30\\%$ 到达了体循环。这个值在药理学上是合理的，因为它表明有相当一部分剂量（$70\\%$）在到达体循环前就已损失，这与药物经受显著的全身前损失（如吸收不完全或高的肝脏首过提取）的情况相符。", "answer": "$$\\boxed{0.3000}$$", "id": "4928516"}, {"introduction": "生物利用度数据在其最重要的实际应用——生物等效性研究中，发挥着决定性作用。本练习将引导你超越简单的数值计算，进入药物监管科学核心的统计学解读领域。通过应用置信区间法这一国际通用的标准，你将能够判断仿制药与原研药是否等效，深刻理解药代动力学理论如何指导着真实的药品审批决策。[@problem_id:4928559]", "problem": "一项双周期随机交叉生物等效性研究比较了同一种药物的仿制制剂与参比制剂。对血浆浓度-时间曲线下面积 (AUC) 进行对数转换后，分析报告的几何均值比（仿制/参比）为 $0.93$，其在比率标度上的 $90$ % 置信区间为 $[0.85, 1.02]$。假设标准生物等效性标准为：如果真实的几何均值比在比率标度上位于 $[0.80, 1.25]$ 区间内，则判定为等效。\n\n仅使用置信区间和假设检验的基本定义和普遍接受的性质，在对数转换后的度量近似服从正态抽样的前提下：\n\n- 在自然对数标度上，通过建立和解释双单侧检验 (TOST) 程序，判断在显著性水平 $\\alpha = 0.05$ 下，两种产品是否生物等效。根据正态理论下的置信区间包含原则，从第一性原理出发，清楚地论证你的决策。\n\n- 为提供一个定量论证指标，计算报告的 $90$ % 置信区间端点与生物等效性界限之间的最小自然对数标度距离。具体地，如果 $L = 0.85$ 和 $U = 1.02$ 表示报告的置信区间在比率标度上的下端点和上端点，而 $\\theta_{L} = 0.80$ 和 $\\theta_{U} = 1.25$ 是比率标度上的生物等效性限值，定义\n$$\nd_{L} = \\ln(L) - \\ln(\\theta_{L}), \\quad d_{U} = \\ln(\\theta_{U}) - \\ln(U), \\quad d_{\\min} = \\min\\{d_{L}, d_{U}\\}.\n$$\n将 $d_{\\min}$ 作为你的最终数值答案。答案四舍五入至四位有效数字。无需单位。", "solution": "任务是利用核心定义和性质来判断生物等效性，并定量说明报告的区间落在接受限内的裕度。\n\n从对数正态分布的药代动力学指标的生物等效性定义开始。设 $\\mu_{T}$ 和 $\\mu_{R}$ 分别表示试验（仿制）产品和参比产品的 AUC 自然对数的期望值。在自然对数标度上，原始标度上的几何均值比落在 $[\\theta_{L}, \\theta_{U}] = [0.80, 1.25]$ 内，等价于均值差异 $\\Delta = \\mu_{T} - \\mu_{R}$ 落在 $[\\ln(\\theta_{L}), \\ln(\\theta_{U})]$ 内。\n\n在显著性水平 $\\alpha = 0.05$ 下的双单侧检验 (TOST) 框架提出了两个原假设：\n- $H_{01}: \\Delta \\le \\ln(\\theta_{L})$ 对 $H_{A1}: \\Delta  \\ln(\\theta_{L})$，\n- $H_{02}: \\Delta \\ge \\ln(\\theta_{U})$ 对 $H_{A2}: \\Delta  \\ln(\\theta_{U})$。\n\n如果 $H_{01}$ 和 $H_{02}$ 均在水平 $\\alpha$ 下被拒绝，则判定为等效。在 $\\Delta$ 的估计量近似服从正态分布并使用基于 t 分布的置信区间的情况下，假设检验与置信区间之间存在对偶性：在水平 $\\alpha$ 下拒绝两个单侧原假设，等价于 $\\Delta$ 的 $(1 - 2\\alpha) \\times 100$ % 置信区间完全落在 $[\\ln(\\theta_{L}), \\ln(\\theta_{U})]$ 内。在比率标度上，这转化为几何均值比的 $(1 - 2\\alpha) \\times 100$ % 置信区间完全落在 $[\\theta_{L}, \\theta_{U}]$ 内。对于 $\\alpha = 0.05$，相应的置信水平是 $90$ %。\n\n报告的几何均值比的 $90$ % 置信区间为 $[L, U] = [0.85, 1.02]$。接受界限为 $[\\theta_{L}, \\theta_{U}] = [0.80, 1.25]$。因为 $L = 0.85  0.80 = \\theta_{L}$ 且 $U = 1.02  1.25 = \\theta_{U}$，所以整个 $90$ % 置信区间都落在接受域内。根据正态理论下的置信区间包含原则，这意味着两个单侧检验在 $\\alpha = 0.05$ 的水平下都拒绝了它们的原假设，因此判定为生物等效。\n\n为提供定量论证，计算置信区间端点到等效性界限的自然对数标度距离：\n- $d_{L} = \\ln(L) - \\ln(\\theta_{L}) = \\ln\\!\\left(\\frac{L}{\\theta_{L}}\\right) = \\ln\\!\\left(\\frac{0.85}{0.80}\\right) = \\ln(1.0625)$。\n- $d_{U} = \\ln(\\theta_{U}) - \\ln(U) = \\ln\\!\\left(\\frac{\\theta_{U}}{U}\\right) = \\ln\\!\\left(\\frac{1.25}{1.02}\\right) = \\ln\\!\\left(\\frac{125}{102}\\right)$。\n\n计算这些值：\n- $\\ln(1.0625) = \\ln\\!\\left(\\frac{17}{16}\\right) = \\ln(17) - \\ln(16) \\approx 2.833213344 - 2.772588722 = 0.060624622$。\n- $\\ln\\!\\left(\\frac{125}{102}\\right) = \\ln(125) - \\ln(102) \\approx 4.828313737 - 4.624972813 = 0.203340924$。\n\n因此，\n$$\nd_{\\min} = \\min\\{0.060624622,\\ 0.203340924\\} = 0.060624622.\n$$\n\n这个正的 $d_{\\min}$ 值证实了整个 $90$ % 置信区间都在接受限之内，这与在 $\\alpha = 0.05$ 水平下 TOST 拒绝两个原假设的结果一致。将 $d_{\\min}$ 四舍五入至四位有效数字，得到 $0.06062$。", "answer": "$$\\boxed{0.06062}$$", "id": "4928559"}, {"introduction": "我们计算出的生物利用度数值，究竟是由哪些生物学机制决定的？这项高级练习将挑战你从观察药代动力学参数，转向对底层过程进行建模。通过从基本原理出发，构建一个肠道细胞的动态模型，你将能够模拟药物转运体（如P-gp）和代谢酶（如CYP酶）之间复杂的相互作用，正是这种相互作用决定了肠道首过效应的程度。这项实践将为你深入理解低生物利用度的成因和潜在的药物相互作用提供一个强有力的工具。[@problem_id:4928581]", "problem": "将单个肠上皮细胞（肠细胞）建模为一个充分混合的细胞内室，该室与肠腔和门静脉进行药物交换，同时药物经由细胞色素P450 (CYP) 酶代谢，并通过P-糖蛋白 (P-gp) 从顶端外排。仅从质量守恒和标准动力学定律出发，构建一个动力学系统，以模拟肠腔、肠细胞、门静脉（原形药物）中药物以及代谢产物的量随时间的演变。\n\n使用以下基本依据和假设，且不得在这些原则之外引入任何额外的简化方法：\n- 各室中的质量守恒：量的变化率等于流入量减去流出量再减去任何化学消耗。\n- 肠腔和细胞之间的被动跨细胞通量服从由浓度差驱动的一级过程，其比例常数的单位为体积/时间。\n- 从细胞到门静脉的基底外排服从关于细胞内药物量的一级过程，其速率常数的单位为时间的倒数。\n- 从细胞返回肠腔的顶端P-糖蛋白 (P-gp) 外排遵循关于细胞内浓度的米氏-门氏动力学。\n- 细胞内细胞色素P450 (CYP) 代谢遵循关于细胞内浓度的米氏-门氏动力学。\n- 门静脉作为一个汇，累积原形药物，而代谢产物则作为单独的量进行追踪。\n\n将状态变量定义为量：$Q_L$（肠腔，单位 mg）、$Q_C$（细胞，单位 mg）、$Q_P$（门静脉原形药物，单位 mg）和 $Q_M$（代谢量，单位 mg）。定义肠腔和细胞体积 $V_L$ 和 $V_C$（单位 mL）。定义动力学参数 $k_{\\text{pass}}$（单位 mL/s）、$k_{\\text{baso}}$（单位 s$^{-1}$）、$V_{\\max,\\text{pgp}}$（单位 mg/(mL·s)）、$K_{m,\\text{pgp}}$（单位 mg/mL）、$V_{\\max,\\text{cyp}}$（单位 mg/(mL·s)）和 $K_{m,\\text{cyp}}$（单位 mg/mL）。$t=0$ 时的初始条件是口服剂量 $D$ 完全置于肠腔中：$Q_L(0)=D$，$Q_C(0)=0$，$Q_P(0)=0$，$Q_M(0)=0$。\n\n您的程序必须：\n1. 根据所述原则，使用细胞内浓度 $C_C=Q_C/V_C$ 和肠腔浓度 $C_L=Q_L/V_L$ 于米氏-门氏项中，推导出关于 $\\frac{dQ_L}{dt}$、$\\frac{dQ_C}{dt}$、$\\frac{dQ_P}{dt}$ 和 $\\frac{dQ_M}{dt}$ 的常微分方程组。\n2. 对该系统从 $t=0$ 到 $t=T$ 秒进行数值积分。\n3. 计算到达门静脉的原形药物占给药剂量的分数（肠道首过后的生物利用度），定义为 $F=Q_P(T)/D$。将 $F$ 表示为小数（无百分号）。\n4. 对于所有测试用例，仅报告量 $F$。\n\n物理单位：\n- 量 $Q_*$ 单位为 mg。\n- 体积 $V_*$ 单位为 mL。\n- 时间 $t$ 单位为 s。\n- 速率常数 $k_{\\text{pass}}$ 单位为 mL/s，$k_{\\text{baso}}$ 单位为 s$^{-1}$。\n- 米氏-门氏参数 $V_{\\max,*}$ 单位为 mg/(mL·s)，$K_{m,*}$ 单位为 mg/mL。\n\n测试套件（每个测试用例是一个有序元组 $(D,V_L,V_C,k_{\\text{pass}},k_{\\text{baso}},V_{\\max,\\text{pgp}},K_{m,\\text{pgp}},V_{\\max,\\text{cyp}},K_{m,\\text{cyp}},T)$）：\n- 用例1（正常路径，基线转运和代谢）：$(100.0, 250.0, 1.0, 0.05, 0.0007, 0.02, 0.10, 0.02, 0.05, 10800.0)$。\n- 用例2（部分P-gp抑制）：$(100.0, 250.0, 1.0, 0.05, 0.0007, 0.005, 0.10, 0.02, 0.05, 10800.0)$。\n- 用例3（完全P-gp抑制）：$(100.0, 250.0, 1.0, 0.05, 0.0007, 0.0, 0.10, 0.02, 0.05, 10800.0)$。\n- 用例4（无CYP代谢边界情况）：$(100.0, 250.0, 1.0, 0.05, 0.0007, 0.02, 0.10, 0.0, 0.05, 10800.0)$。\n- 用例5（剂量饱和边缘情况）：$(1000.0, 250.0, 1.0, 0.05, 0.0007, 0.02, 0.10, 0.02, 0.05, 10800.0)$。\n\n输出规格：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），其中每个结果是按上文所列顺序对应测试用例的小数 $F$。", "solution": "该问题要求建立并数值求解一个常微分方程组 (ODE)，该方程组描述了药物在简化肠细胞模型中的药代动力学。推导过程必须严格基于质量守恒原理和指定的动力学定律。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n\n- **状态变量（量，单位 mg）**：\n  - $Q_L$：肠腔中的药物量。\n  - $Q_C$：肠细胞中的药物量。\n  - $Q_P$：门静脉中的原形药物量。\n  - $Q_M$：代谢产物的量。\n- **系统参数**：\n  - $V_L$：肠腔体积 (mL)。\n  - $V_C$：肠细胞体积 (mL)。\n  - $k_{\\text{pass}}$：被动通量的比例常数 (mL/s)。\n  - $k_{\\text{baso}}$：基底外排的一级速率常数 (s$^{-1}$)。\n  - $V_{\\max,\\text{pgp}}$：P-gp 外排的最大速率 (mg/(mL·s))。\n  - $K_{m,\\text{pgp}}$：P-gp 外排的米氏常数 (mg/mL)。\n  - $V_{\\max,\\text{cyp}}$：CYP 代谢的最大速率 (mg/(mL·s))。\n  - $K_{m,\\text{cyp}}$：CYP 代谢的米氏常数 (mg/mL)。\n- **$t=0$ 时的初始条件**：\n  - $Q_L(0) = D$（初始剂量）。\n  - $Q_C(0) = 0$。\n  - $Q_P(0) = 0$。\n  - $Q_M(0) = 0$。\n- **基本原理**：\n  - 质量守恒：量的变化率 = 流入量 - 流出量 - 化学消耗。\n  - 被动跨细胞通量：一级过程，由浓度差 $(C_L - C_C)$ 驱动。\n  - 基底外排：关于细胞内药物量 $Q_C$ 的一级过程。\n  - P-糖蛋白 (P-gp) 外排：关于细胞内浓度 $C_C$ 的米氏-门氏动力学。\n  - 细胞色素P450 (CYP) 代谢：关于细胞内浓度 $C_C$ 的米氏-门氏动力学。\n  - 门静脉和代谢物室作为汇。\n- **任务**：\n  1. 推导关于 $\\frac{dQ_L}{dt}$、$\\frac{dQ_C}{dt}$、$\\frac{dQ_P}{dt}$ 和 $\\frac{dQ_M}{dt}$ 的常微分方程组。\n  2. 对系统从 $t=0$ 到 $t=T$ 进行数值积分。\n  3. 计算生物利用度 $F = Q_P(T)/D$。\n  4. 报告给定测试套件的 $F$ 值。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据**：该问题牢固地植根于药代动力学房室模型的既定原则。质量平衡、用于被动扩散的一级动力学以及用于载体介导转运和酶促代谢的米氏-门氏动力学，这些都是药理学和系统生物学中标准且科学有效的方法。\n- **适定性**：该问题指定了一个具有完整初始条件的一阶常微分方程组。这构成了一个适定的初值问题 (IVP)，在非病态条件下（此处条件已满足，因为对于非负浓度，速率函数是平滑的），保证存在唯一解。模拟所需的所有参数均已提供。\n- **客观性**：问题以精确、定量且无偏见的语言陈述。所有定义和任务都明确无误。\n- **一致性与完整性**：所提供的参数及其单位在量纲上与其描述的物理过程一致。例如，由 $k_{\\text{pass}} [mL/s] \\times \\Delta C [mg/mL]$ 给出的被动通量速率，其单位正确地得到 $mg/s$，这是一个量的变化率。类似地，按规定构建的米氏-门氏项在量纲上也是正确的。整个设定是自洽且完整的。\n\n**1.3. 结论与行动**\n\n问题有效。它科学合理、适定，并提供了所有必要信息。开始进行求解。\n\n### 步骤2：常微分方程组的推导\n\n该系统是通过对四个室中的每一个应用质量守恒原理推导出来的。每个室中药物量的变化率 $\\frac{dQ_i}{dt}$ 是所有流入速率之和减去所有流出速率之和。\n\n首先，我们定义肠腔和细胞中的药物浓度，因为这些是动力学速率定律所必需的：\n- 肠腔浓度：$C_L = Q_L / V_L$\n- 细胞内浓度：$C_C = Q_C / V_C$\n\n接下来，我们将转运和代谢过程的速率（通量）形式化，单位为量/时间 ($mg/s$)。\n\n1.  **被动通量 ($J_{\\text{pass}}$)**：药物通过被动扩散从肠腔进入细胞的速率。它与浓度梯度成正比。\n    $$J_{\\text{pass}} = k_{\\text{pass}} (C_L - C_C) = k_{\\text{pass}} \\left( \\frac{Q_L}{V_L} - \\frac{Q_C}{V_C} \\right)$$\n    此通量代表从肠腔流出并流入细胞。\n\n2.  **P-gp 外排 ($J_{\\text{P-gp}}$)**：由 P-gp 介导的从细胞回到肠腔的主动转运速率。这遵循基于细胞内浓度 $C_C$ 的米氏-门氏动力学。参数 $V_{\\max,\\text{pgp}}$ 的单位是质量/体积/时间 ($mg/(mL \\cdot s)$)，表示浓度的最大变化率。为了获得总的量的变化率，必须将其乘以过程发生所在室的体积，即细胞体积 $V_C$。\n    $$J_{\\text{P-gp}} = \\frac{V_{\\max,\\text{pgp}} C_C}{K_{m,\\text{pgp}} + C_C} \\cdot V_C = \\frac{V_{\\max,\\text{pgp}} (Q_C/V_C)}{K_{m,\\text{pgp}} + (Q_C/V_C)} \\cdot V_C$$\n    此通量是从细胞流出并流入肠腔。\n\n3.  **基底外排 ($J_{\\text{baso}}$)**：药物从细胞转运到门静脉的速率。这是一个关于细胞内*药物量* $Q_C$ 的一级过程。\n    $$J_{\\text{baso}} = k_{\\text{baso}} Q_C$$\n    此通量是从细胞流出并流入门静脉室。\n\n4.  **CYP 代谢 ($J_{\\text{CYP}}$)**：细胞内药物代谢的速率。此过程也遵循依赖于 $C_C$ 的米氏-门氏动力学。与 P-gp 外排类似，该速率必须按细胞体积 $V_C$ 进行缩放。\n    $$J_{\\text{CYP}} = \\frac{V_{\\max,\\text{cyp}} C_C}{K_{m,\\text{cyp}} + C_C} \\cdot V_C = \\frac{V_{\\max,\\text{cyp}} (Q_C/V_C)}{K_{m,\\text{cyp}} + (Q_C/V_C)} \\cdot V_C$$\n    此过程代表细胞内原形药物的消耗和代谢物的形成。它是从细胞室 ($Q_C$) 流出并流入代谢量室 ($Q_M$)。\n\n有了这些通量项，我们现在可以为每个状态变量写出质量平衡方程：\n\n-   **肠腔 ($Q_L$)**：\n    $$\\frac{dQ_L}{dt} = (\\text{从细胞流入}) - (\\text{流向细胞}) = J_{\\text{P-gp}} - J_{\\text{pass}}$$\n    $$\\frac{dQ_L}{dt} = \\frac{V_{\\max,\\text{pgp}} (Q_C/V_C)}{K_{m,\\text{pgp}} + (Q_C/V_C)} V_C - k_{\\text{pass}} \\left( \\frac{Q_L}{V_L} - \\frac{Q_C}{V_C} \\right)$$\n\n-   **细胞 ($Q_C$)**：\n    $$\\frac{dQ_C}{dt} = (\\text{从肠腔流入}) - (\\text{流出}) = J_{\\text{pass}} - J_{\\text{P-gp}} - J_{\\text{baso}} - J_{\\text{CYP}}$$\n    $$\\frac{dQ_C}{dt} = k_{\\text{pass}} \\left( \\frac{Q_L}{V_L} - \\frac{Q_C}{V_C} \\right) - \\frac{V_{\\max,\\text{pgp}} (Q_C/V_C)}{K_{m,\\text{pgp}} + (Q_C/V_C)} V_C - k_{\\text{baso}} Q_C - \\frac{V_{\\max,\\text{cyp}} (Q_C/V_C)}{K_{m,\\text{cyp}} + (Q_C/V_C)} V_C$$\n\n-   **门静脉 ($Q_P$)**：\n    $$\\frac{dQ_P}{dt} = (\\text{从细胞流入}) = J_{\\text{baso}}$$\n    $$\\frac{dQ_P}{dt} = k_{\\text{baso}} Q_C$$\n\n-   **代谢物 ($Q_M$)**：\n    $$\\frac{dQ_M}{dt} = (\\text{从细胞代谢流入}) = J_{\\text{CYP}}$$\n    $$\\frac{dQ_M}{dt} = \\frac{V_{\\max,\\text{cyp}} (Q_C/V_C)}{K_{m,\\text{cyp}} + (Q_C/V_C)} V_C$$\n\n作为内部一致性的检查，我们验证总质量（药物加代谢物）守恒。将四个导数相加：\n$$\\frac{dQ_L}{dt} + \\frac{dQ_C}{dt} + \\frac{dQ_P}{dt} + \\frac{dQ_M}{dt} = (J_{\\text{P-gp}} - J_{\\text{pass}}) + (J_{\\text{pass}} - J_{\\text{P-gp}} - J_{\\text{baso}} - J_{\\text{CYP}}) + (J_{\\text{baso}}) + (J_{\\text{CYP}}) = 0$$\n总和为零，符合预期，证实了系统内质量是守恒的。\n\n### 步骤3：数值解法与生物利用度计算\n\n这个由四个耦合一阶常微分方程组成的系统构成一个初值问题，其状态向量为 $Y(t) = [Q_L(t), Q_C(t), Q_P(t), Q_M(t)]^T$，初始条件为 $Y(0) = [D, 0, 0, 0]^T$。可以使用合适的算法（如龙格-库塔法）在时间区间 $[0, T]$ 上进行数值求解。\n\n数值积分后，在最终时间 $T$ 到达门静脉的原形药物量为 $Q_P(T)$。肠道生物利用度 $F$ 是该量占初始剂量 $D$ 的分数。\n$$F = \\frac{Q_P(T)}{D}$$\n将为提供的每个测试用例计算此量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves a system of ODEs for drug transport and metabolism\n    in a single-enterocyte model to calculate intestinal bioavailability.\n    \"\"\"\n\n    # Test suite: (D, V_L, V_C, k_pass, k_baso, V_max_pgp, K_m_pgp, V_max_cyp, K_m_cyp, T)\n    test_cases = [\n        # Case 1 (happy path, baseline transport and metabolism)\n        (100.0, 250.0, 1.0, 0.05, 0.0007, 0.02, 0.10, 0.02, 0.05, 10800.0),\n        # Case 2 (partial P-gp inhibition)\n        (100.0, 250.0, 1.0, 0.05, 0.0007, 0.005, 0.10, 0.02, 0.05, 10800.0),\n        # Case 3 (complete P-gp inhibition)\n        (100.0, 250.0, 1.0, 0.05, 0.0007, 0.0, 0.10, 0.02, 0.05, 10800.0),\n        # Case 4 (no CYP metabolism boundary case)\n        (100.0, 250.0, 1.0, 0.05, 0.0007, 0.02, 0.10, 0.0, 0.05, 10800.0),\n        # Case 5 (dose saturation edge case)\n        (1000.0, 250.0, 1.0, 0.05, 0.0007, 0.02, 0.10, 0.02, 0.05, 10800.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        D, V_L, V_C, k_pass, k_baso, V_max_pgp, K_m_pgp, V_max_cyp, K_m_cyp, T = case\n\n        def derivatives(t, y, params):\n            \"\"\"\n            Computes the derivatives of the state variables based on the compartmental model.\n            y: state vector [QL, QC, QP, QM]\n            params: tuple of model parameters\n            \"\"\"\n            V_L, V_C, k_pass, k_baso, V_max_pgp, K_m_pgp, V_max_cyp, K_m_cyp = params\n            \n            QL, QC, QP, QM = y\n\n            # To prevent numerical artifacts from producing negative amounts\n            QL = max(0.0, QL)\n            QC = max(0.0, QC)\n\n            # Concentrations (mg/mL)\n            C_L = QL / V_L\n            C_C = QC / V_C\n\n            # Fluxes (mg/s)\n            \n            # Passive flux from lumen to cell\n            j_pass = k_pass * (C_L - C_C)\n            \n            # P-gp efflux from cell to lumen (Michaelis-Menten)\n            # The rate expression is V_max * C / (K_m + C) in mg/(mL*s).\n            # Total amount rate is this multiplied by cell volume V_C.\n            if K_m_pgp + C_C > 0:\n                j_pgp = (V_max_pgp * C_C / (K_m_pgp + C_C)) * V_C\n            else:\n                 # Handles the case where Km=0 and C=0, rate must be 0\n                j_pgp = 0.0\n\n            # Basolateral efflux from cell to portal vein (first-order in amount)\n            j_baso = k_baso * QC\n            \n            # CYP metabolism in cell (Michaelis-Menten)\n            if K_m_cyp + C_C > 0:\n                j_cyp = (V_max_cyp * C_C / (K_m_cyp + C_C)) * V_C\n            else:\n                j_cyp = 0.0\n                \n            # System of ODEs\n            dQL_dt = j_pgp - j_pass\n            dQC_dt = j_pass - j_pgp - j_baso - j_cyp\n            dQP_dt = j_baso\n            dQM_dt = j_cyp\n            \n            return [dQL_dt, dQC_dt, dQP_dt, dQM_dt]\n\n        # Initial conditions\n        y0 = [D, 0.0, 0.0, 0.0]\n        \n        # Time span for integration\n        t_span = [0.0, T]\n\n        # Bundle parameters for the solver\n        # Note: D and T are not needed by the derivative function itself\n        model_params = (V_L, V_C, k_pass, k_baso, V_max_pgp, K_m_pgp, V_max_cyp, K_m_cyp)\n\n        # Numerically solve the ODE system\n        sol = solve_ivp(\n            fun=derivatives,\n            t_span=t_span,\n            y0=y0,\n            method='RK45',\n            args=(model_params,),\n            dense_output=True\n        )\n\n        # Final amount in portal vein\n        QP_final = sol.y[2, -1]\n\n        # Bioavailability calculation (F)\n        # Avoid division by zero if dose is zero\n        F = QP_final / D if D > 0 else 0.0\n        \n        results.append(F)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "4928581"}]}