{"hands_on_practices": [{"introduction": "本练习将指导您建立一个连接药物浓度与胰岛素分泌的数学模型。通过应用质量作用定律，您将了解我们如何定量预测药物效应，这是药效学的基石。该练习旨在巩固受体理论与生理反应之间的联系。[@problem_id:4991589]", "problem": "磺脲类药物通过与ATP敏感性钾通道（adenosine triphosphate-sensitive potassium channel, 简称$K_{\\text{ATP}}$）的磺脲类受体1（SUR1）亚基结合，降低$K_{\\text{ATP}}$电导，使细胞膜去极化，打开电压门控钙通道，并增加钙依赖性胞吐作用，从而刺激胰腺β细胞分泌胰岛素。考虑一个在葡萄糖作用下处于稳态的β细胞簇，其基础胰岛素分泌率为 $S_{\\text{base}}$，药物的游离细胞外浓度为 $C$，该浓度约等于胰岛内的游离组织间液浓度。\n\n使用以下机理假设和定义作为基本依据：\n- 磺脲类药物与SUR1上的一类非相互作用位点结合，并在平衡状态下遵循质量作用定律。平衡解离常数 $K_{d}$ 定义为 $K_{d} = \\frac{[R][L]}{[RL]}$，其中 $[R]$ 是游离受体位点的浓度，$[L]$ 是游离配体的浓度，$[RL]$ 是配体-受体复合物的浓度。总受体位点浓度为 $[R_{T}] = [R] + [RL]$。\n- 分数占据率 $\\theta$ 定义为 $\\theta = \\frac{[RL]}{[R_{T}]}$。\n- $K_{\\text{ATP}}$电导的分数抑制（表示为 $E$）与 $\\theta$ 成正比，并在最大分数抑制 $E_{\\max}$ 处饱和；也就是说，$E$ 随 $\\theta$ 的增加而增加，并以 $E_{\\max}$ 为上限。\n- 在感兴趣的范围内，超出基础水平的胰岛素分泌率增量与分数抑制 $E$ 成正比，比例常数为 $\\gamma$，因此分泌率 $S = S_{\\text{base}} + \\gamma E$。\n\n给定参数值 $K_{d} = 30$ nM，$E_{\\max} = 0.85$ (无单位)，$S_{\\text{base}} = 0.8$ pmol/min，$\\gamma = 1.6$ pmol/min，以及游离磺脲类药物浓度 $C = 50$ nM，请根据质量作用定律对 $K_{d}$ 的定义和上述转导假设，推导出 $S$ 作为 $C$ 的函数表达式。然后计算在 $C = 50$ nM 时的预测胰岛素分泌率。最终胰岛素分泌率以 pmol/min 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "该问题被认为是有效的，因为它在科学上基于药理学和内分泌学的既定原则，问题陈述清晰，信息充分且一致，并且客观陈述。我们可以进行正式的推导和计算。\n\n目标是首先推导出胰岛素分泌率 $S$ 作为游离磺脲类药物浓度 $C$ 的函数表达式，然后计算在给定浓度下 $S$ 的值。推导过程通过连接从药物结合到最终生理反应的事件链来进行。\n\n首先，我们确定分数受体占据率 $\\theta$ 作为药物浓度 $C$ 的函数。问题指出，结合过程遵循单类非相互作用位点的质量作用定律。平衡解离常数由以下公式给出：\n$$\nK_{d} = \\frac{[R][L]}{[RL]}\n$$\n其中 $[R]$ 是游离受体的浓度，$[L]$ 是游离配体的浓度，$[RL]$ 是配体-受体复合物的浓度。总受体浓度 $[R_T]$ 是游离受体和结合受体之和：\n$$\n[R_T] = [R] + [RL]\n$$\n由此，我们可以将游离受体浓度表示为 $[R] = [R_T] - [RL]$。将其代入 $K_d$ 的表达式中：\n$$\nK_d = \\frac{([R_T] - [RL])[L]}{[RL]}\n$$\n我们重排此方程以求解配体-受体复合物的浓度 $[RL]$：\n$$\nK_d [RL] = ([R_T] - [RL])[L] = [R_T][L] - [RL][L]\n$$\n$$\nK_d [RL] + [RL][L] = [R_T][L]\n$$\n$$\n[RL](K_d + [L]) = [R_T][L]\n$$\n$$\n[RL] = \\frac{[R_T][L]}{K_d + [L]}\n$$\n分数占据率 $\\theta$ 定义为结合受体与总受体的比率，即 $\\theta = \\frac{[RL]}{[R_T]}$。代入 $[RL]$ 的表达式得到：\n$$\n\\theta = \\frac{1}{[R_T]} \\left( \\frac{[R_T][L]}{K_d + [L]} \\right) = \\frac{[L]}{K_d + [L]}\n$$\n问题指明游离配体浓度 $[L]$ 即为游离细胞外磺脲类药物浓度 $C$。因此，分数占据率作为 $C$ 的函数为：\n$$\n\\theta(C) = \\frac{C}{K_d + C}\n$$\n第二，我们将分数占据率 $\\theta$ 与$K_{\\text{ATP}}$通道电导的分数抑制 $E$ 联系起来。问题指出，$E$ 与 $\\theta$ 成正比，并在最大值 $E_{\\max}$ 处饱和。这意味着存在一个形如 $E = k \\theta$ 的线性关系，其中 $k$ 为某个常数。由于 $\\theta$ 的最大值为 $1$（当 $C \\to \\infty$ 时），$E$ 的最大值即为 $k$。鉴于这个最大值是 $E_{\\max}$，因此 $k = E_{\\max}$。于是，该关系为：\n$$\nE = E_{\\max} \\theta\n$$\n代入已推导出的 $\\theta(C)$ 表达式：\n$$\nE(C) = E_{\\max} \\left( \\frac{C}{K_d + C} \\right) = \\frac{E_{\\max} C}{K_d + C}\n$$\n第三，我们将总胰岛素分泌率 $S$ 表示为 $E$ 的函数。问题指出，分泌率超出基础水平 $S_{\\text{base}}$ 的增量与 $E$ 成正比，比例常数为 $\\gamma$。这可以写成：\n$$\nS - S_{\\text{base}} = \\gamma E\n$$\n$$\nS = S_{\\text{base}} + \\gamma E\n$$\n最后，通过将 $E(C)$ 的表达式代入 $S$ 的方程，我们得到了所求的胰岛素分泌率作为磺脲类药物浓度 $C$ 的函数表达式：\n$$\nS(C) = S_{\\text{base}} + \\gamma \\left( \\frac{E_{\\max} C}{K_d + C} \\right) = S_{\\text{base}} + \\frac{\\gamma E_{\\max} C}{K_d + C}\n$$\n推导到此完成。\n\n现在，我们计算在指定浓度下的预测胰岛素分泌率。给定的参数值为：\n- $K_d = 30$ nM\n- $E_{\\max} = 0.85$ (无单位)\n- $S_{\\text{base}} = 0.8$ pmol/min\n- $\\gamma = 1.6$ pmol/min\n- $C = 50$ nM\n\n我们将这些值代入推导出的 $S(C)$ 表达式中：\n$$\nS(50) = 0.8 + \\frac{(1.6)(0.85)(50)}{30 + 50}\n$$\n$K_d$ 和 $C$ 的单位都是 nM，因此它们在分数中相互抵消，使得该项的单位与 $\\gamma$ 的单位相同，即 pmol/min。这与 $S_{\\text{base}}$ 的单位是一致的。\n$$\nS(50) = 0.8 + \\frac{(1.36)(50)}{80}\n$$\n$$\nS(50) = 0.8 + \\frac{68}{80}\n$$\n$$\nS(50) = 0.8 + 0.85\n$$\n$$\nS(50) = 1.65 \\, \\text{pmol/min}\n$$\n题目要求答案四舍五入到四位有效数字。计算出的值 $1.65$ 有三位有效数字。为了用四位有效数字表示，我们在后面加一个零。\n$$\nS(50) = 1.650 \\, \\text{pmol/min}\n$$", "answer": "$$\n\\boxed{1.650}\n$$", "id": "4991589"}, {"introduction": "从细胞层面转向系统层面，本练习将探讨磺脲类药物一个常见的临床副作用：体重增加。您将计算因尿糖丢失减少而产生的热量盈余，这是药物降糖效应的直接后果。该练习突出了药理学原理如何解释并量化患者层面的治疗结果。[@problem_id:4991541]", "problem": "一名2型糖尿病患者开始服用磺脲类药物。磺脲类药物及相关的格列奈类药物通过与ATP敏感性钾通道（$K_{\\text{ATP}}$）上的磺脲类受体1（SUR1）结合，导致通道关闭、膜去极化、电压门控钙离子内流和胰岛素颗粒的胞吐，从而增加胰腺β细胞的胰岛素分泌。增加的胰岛素会增强骨骼肌和脂肪组织中葡萄糖转运蛋白$4$型（GLUT4）的转位，刺激糖原合成和从头脂肪生成，并抑制激素敏感性脂肪酶，从而促进合成代谢储存并抑制脂肪分解。在未控制的糖尿病中，当血浆葡萄糖超过肾脏重吸收能力时，能量以葡萄糖的形式从尿液中流失；改善胰岛素水平可以减少糖尿，导致净能量保留，从而有助于体重增加。\n\n考虑一名成年人，其一天内的基线平均血浆葡萄糖浓度为 $G_{0} = 350\\,\\mathrm{mg/dL}$。肾小球滤过率（GFR）为 $125\\,\\mathrm{mL/min}$，即 $1.25\\,\\mathrm{dL/min}$。肾脏的葡萄糖转运最大值（转运最大值，$T_{\\mathrm{m}}$）为 $375\\,\\mathrm{mg/min}$，并假定在相关范围内保持不变。葡萄糖的热量值为 $E_{g} = 4\\,\\mathrm{kcal/g}$。开始服用磺脲类药物后，根据经验观察，在持续的每日周期内，平均血浆胰岛素浓度增加了 $\\Delta I = 20\\,\\mathrm{\\mu U/mL}$。在此范围内，平均血浆葡萄糖与平均血浆胰岛素之间的关系可视为线性关系，斜率为 $\\alpha = 2.5\\,\\mathrm{mg/dL}$ 每 $\\mathrm{\\mu U/mL}$，因此增加的胰岛素暴露会相应地降低平均血浆葡萄糖。\n\n从葡萄糖滤过负荷（$\\mathrm{filtered\\ load} = \\mathrm{GFR} \\times \\mathrm{plasma\\ glucose}$）、转运最大值 $T_{\\mathrm{m}}$ 和尿糖排泄（$\\mathrm{excretion\\ rate} = \\max(0, \\mathrm{filtered\\ load} - T_{\\mathrm{m}})$）的定义出发，并利用葡萄糖的能量含量，推导出仅由胰岛素介导的平均血浆葡萄糖降低所带来的尿糖流失减少所产生的预期每日热量盈余。假设在全天内，平均血浆葡萄糖在其基线值和治疗后值处有效恒定，并且 GFR 和 $T_{\\mathrm{m}}$ 保持不变。以 $\\mathrm{kcal/day}$ 为单位表示最终能量，并将答案四舍五入至四位有效数字。", "solution": "此问题经评估是有效的。它在科学上基于肾脏生理学和内分泌学的既定原则，问题设定良好，数据完整且一致，表述客观。该问题可通过基于所提供的定义和数值的一系列逻辑计算来解决。\n\n目标是计算服用磺脲类药物治疗后，因尿糖流失减少而产生的预期每日热量盈余。这需要计算治疗前后的尿糖排泄率，求出其差值，并将每日葡萄糖质量的差值转换为其等效热量。\n\n设基线平均血浆葡萄糖为 $G_0 = 350\\,\\mathrm{mg/dL}$。\n设肾小球滤过率为 $\\mathrm{GFR} = 1.25\\,\\mathrm{dL/min}$。\n设肾脏对葡萄糖的转运最大值为 $T_{\\mathrm{m}} = 375\\,\\mathrm{mg/min}$。\n葡萄糖的热量值为 $E_g = 4\\,\\mathrm{kcal/g}$。\n胰岛素的增加量为 $\\Delta I = 20\\,\\mathrm{\\mu U/mL}$。\n葡萄糖对胰岛素的敏感度由斜率 $\\alpha = 2.5\\,\\mathrm{mg/dL}$ 每 $\\mathrm{\\mu U/mL}$ 给出。\n\n首先，我们计算磺脲类药物治疗后的新平均血浆葡萄糖水平 $G_1$。增加的胰岛素浓度导致血浆葡萄糖降低。降低的幅度 $\\Delta G$ 由下式给出：\n$$ \\Delta G = \\alpha \\times \\Delta I $$\n$$ \\Delta G = \\left(2.5\\,\\frac{\\mathrm{mg/dL}}{\\mathrm{\\mu U/mL}}\\right) \\times \\left(20\\,\\mathrm{\\mu U/mL}\\right) = 50\\,\\mathrm{mg/dL} $$\n因此，新的血浆葡萄糖浓度 $G_1$ 为：\n$$ G_1 = G_0 - \\Delta G = 350\\,\\mathrm{mg/dL} - 50\\,\\mathrm{mg/dL} = 300\\,\\mathrm{mg/dL} $$\n\n接下来，我们计算基线时（$E_{\\text{rate}, 0}$）和治疗后（$E_{\\text{rate}, 1}$）的尿糖排泄率。排泄率定义为葡萄糖的滤过负荷减去重吸收量，重吸收量最大不超过转运最大值 $T_{\\mathrm{m}}$。\n$$ E_{\\text{rate}} = \\max(0, \\text{Filtered Load} - T_{\\mathrm{m}}) $$\n其中滤过负荷由下式给出：\n$$ \\text{Filtered Load} = \\mathrm{GFR} \\times \\text{Plasma Glucose} $$\n\n在基线状态（状态 $0$）：\n葡萄糖的滤过负荷 $L_0$ 为：\n$$ L_0 = \\mathrm{GFR} \\times G_0 = (1.25\\,\\mathrm{dL/min}) \\times (350\\,\\mathrm{mg/dL}) = 437.5\\,\\mathrm{mg/min} $$\n由于 $L_0  T_{\\mathrm{m}}$（$437.5\\,\\mathrm{mg/min}  375\\,\\mathrm{mg/min}$），葡萄糖被排泄到尿液中。基线排泄率 $E_{\\text{rate}, 0}$ 为：\n$$ E_{\\text{rate}, 0} = L_0 - T_{\\mathrm{m}} = 437.5\\,\\mathrm{mg/min} - 375\\,\\mathrm{mg/min} = 62.5\\,\\mathrm{mg/min} $$\n\n治疗后（状态 $1$）：\n新的葡萄糖滤过负荷 $L_1$ 为：\n$$ L_1 = \\mathrm{GFR} \\times G_1 = (1.25\\,\\mathrm{dL/min}) \\times (300\\,\\mathrm{mg/dL}) = 375\\,\\mathrm{mg/min} $$\n在这种情况下，滤过负荷恰好等于转运最大值，$L_1 = T_{\\mathrm{m}}$。治疗后的排泄率 $E_{\\text{rate}, 1}$ 为：\n$$ E_{\\text{rate}, 1} = \\max(0, L_1 - T_{\\mathrm{m}}) = \\max(0, 375\\,\\mathrm{mg/min} - 375\\,\\mathrm{mg/min}) = 0\\,\\mathrm{mg/min} $$\n\n葡萄糖流失率的减少量 $\\Delta E_{\\text{rate}}$ 是基线排泄率与治疗后排泄率之差：\n$$ \\Delta E_{\\text{rate}} = E_{\\text{rate}, 0} - E_{\\text{rate}, 1} = 62.5\\,\\mathrm{mg/min} - 0\\,\\mathrm{mg/min} = 62.5\\,\\mathrm{mg/min} $$\n该值表示每分钟从尿液流失中节省的葡萄糖质量。\n\n为求出每日节省的葡萄糖总质量 $\\Delta M_{\\text{daily}}$，我们必须将此速率从分钟转换为天。一天有 $24 \\times 60 = 1440$ 分钟。\n$$ \\Delta M_{\\text{daily}} = \\Delta E_{\\text{rate}} \\times 1440\\,\\mathrm{min/day} $$\n$$ \\Delta M_{\\text{daily}} = (62.5\\,\\mathrm{mg/min}) \\times (1440\\,\\mathrm{min/day}) = 90000\\,\\mathrm{mg/day} $$\n\n问题要求计算热量盈余。我们首先将质量从毫克转换为克：\n$$ 90000\\,\\mathrm{mg/day} = 90\\,\\mathrm{g/day} $$\n现在，我们使用葡萄糖的热量值 $E_g = 4\\,\\mathrm{kcal/g}$ 来计算每日总热量盈余 $\\Delta C_{\\text{daily}}$：\n$$ \\Delta C_{\\text{daily}} = (90\\,\\mathrm{g/day}) \\times (4\\,\\mathrm{kcal/g}) = 360\\,\\mathrm{kcal/day} $$\n\n问题要求答案四舍五入到四位有效数字。计算值为 $360$。为了用四位有效数字表示，我们将其写作 $360.0$。\n每日热量盈余为 $360.0\\,\\mathrm{kcal/day}$。", "answer": "$$\n\\boxed{360.0}\n$$", "id": "4991541"}, {"introduction": "在我们之前的练习中，我们使用已知的参数（如 $EC_{50}$ 和 $E_{\\max}$）来预测效应。这最后一个练习则处理相反的问题：我们如何从实验数据中确定这些参数？您将把一个药效学模型拟合到浓度-效应数据中，这为计算药理学和实验结果的统计分析提供了一个实践入门。[@problem_id:4991566]", "problem": "提供给您的是磺酰脲类药物格列美脲（glimepiride）经基线校正的稳态浓度-效应数据，该药物通过关闭胰腺β细胞中的三磷酸腺苷（Adenosine Triphosphate, ATP）敏感性钾（$K_{ATP}$）通道来刺激胰岛素分泌。您将使用基于第一性原理的推导和一致的非线性回归方法，从一个可饱和的浓度-效应模型中估计两个药效学参数，并量化其不确定性。\n\n基本原理：\n- 对于单一类别的非协同结合位点，平衡状态下的质量作用定律意味着分数占据率与配体浓度成正比，并受饱和度的限制。\n- 如果药理效应与具有有限最大容量的占据率成正比，则浓度与效应之间会出现可饱和的双曲线关系。\n- 非线性最小二乘估计通过最小化残差平方和来实现，而估计参数的近似大样本协方差由观测信息的逆矩阵（或高斯-牛顿近似）给出，从而可以通过学生t分布（Student’s $t$-distribution）构建双侧置信区间。\n\n任务：\n- 从质量作用定律和效应与占据率的比例关系出发，推导出一个双参数可饱和模型，该模型使用最大效应 $E_{\\max}$ 和半数有效浓度 $EC_{50}$（半最大效应浓度）这两个参数，将浓度 $C$ 映射到效应 $E(C)$。\n- 通过最小化测量的胰岛素增加量与模型预测的胰岛素增加量之间的残差平方和来拟合此模型。\n- 使用来自参数协方差矩阵的标准误和自由度为 $n - p$（其中 $n$ 是观测次数，$p$ 是拟合参数的个数，此处 $p = 2$）的学生t分布（Student’s $t$-distribution），计算 $E_{\\max}$ 和 $EC_{50}$ 的近似 $95\\%$ 双侧置信区间。对于 $95\\%$ 区间，使用对应于上尾部 $0.975$ 的双侧分位数。\n- 在估计过程中，将参数约束为非负。\n- 以微摩尔（micromolar）表示 $EC_{50}$，以微国际单位/毫升（micro-international units per milliliter）表示 $E_{\\max}$。所有最终的数值输出必须四舍五入到两位小数。不要在最后一行输出单位；只输出数字。\n\n数据（所有浓度单位为微摩尔，所有胰岛素增加量单位为微国际单位/毫升）：\n- 测试用例A（均衡范围，中等噪声）：\n  - 浓度 $C_A$：$[0.0, 0.5, 1.0, 2.0, 3.0, 5.0, 10.0, 20.0]$\n  - 效应 $E_A$：$[0.0, 14.1, 22.0, 36.0, 44.2, 51.0, 63.0, 70.5]$\n- 测试用例B（仅低浓度，饱和信息弱）：\n  - 浓度 $C_B$：$[0.0, 0.1, 0.2, 0.4, 0.8]$\n  - 效应 $E_B$：$[0.0, 1.6, 2.9, 6.3, 10.8]$\n- 测试用例C（在中高浓度附近有噪声和异常值）：\n  - 浓度 $C_C$：$[0.0, 0.5, 1.0, 1.5, 3.0, 6.0]$\n  - 效应 $E_C$：$[0.0, 26.0, 39.0, 48.0, 85.0, 82.0]$\n- 测试用例D（接近饱和，有清晰的平台期）：\n  - 浓度 $C_D$：$[0.0, 2.0, 4.0, 8.0, 16.0, 32.0]$\n  - 效应 $E_D$：$[0.0, 29.5, 41.0, 47.5, 52.8, 56.3]$\n\n角度单位不适用。不输出百分比。\n\n您的程序必须：\n- 实现推导出的可饱和模型。\n- 对于每个测试用例，通过带有非负参数约束的非线性最小二乘法估计 $EC_{50}$ 和 $E_{\\max}$。\n- 使用参数标准误和自由度为 $n - 2$ 的双侧学生t分位数（Student’s $t$ quantile）计算两个参数的近似 $95\\%$ 置信区间。\n- 将所有报告的数字四舍五入到两位小数。\n\n最终输出格式：\n- 生成单行输出，包含一个结果列表，每个测试用例一个结果，按A、B、C、D的顺序排列。\n- 每个结果必须是包含六个浮点数的列表，顺序完全如下：$[EC_{50}, E_{\\max}, EC_{50,\\mathrm{low}}, EC_{50,\\mathrm{high}}, E_{\\max,\\mathrm{low}}, E_{\\max,\\mathrm{high}}]$，其中“low”和“high”表示双侧 $95\\%$ 置信区间的边界。\n- 所有数字必须四舍五入到两位小数。\n- 输出必须打印为列表的列表的单行字符串表示形式，方括号内为逗号分隔的值，例如：$[[a,b,c,d,e,f],[\\dots],\\dots]$。\n\n测试套件覆盖范围说明：\n- 用例A考察标准的可识别拟合。\n- 用例B探究当浓度远低于半最大效应区域时模型参数的弱可识别性。\n- 用例C探究对噪声和异常值的鲁棒性。\n- 用例D探究接近饱和时的可识别性。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[[r_1,r_2,r_3,r_4,r_5,r_6],[\\dots],[\\dots],[\\dots]]$）。", "solution": "该问题要求使用基于第一性原理推导的模型，根据浓度-效应数据估计药效学参数。这包括三个步骤：模型推导、通过非线性最小二乘法进行参数估计，以及使用统计理论进行不确定性量化。\n\n### 步骤1：可饱和浓度-效应模型的推导\n\n该模型源于质量作用定律，应用于药物（配体，$D$）与同质、非协同的受体群体（$R$）之间的可逆、单一位点结合相互作用。\n\n结合反应处于平衡状态：\n$$\nD + R \\rightleftharpoons DR\n$$\n其中 $DR$ 是药物-受体复合物。\n\n平衡解离常数 $K_D$ 定义为：\n$$\nK_D = \\frac{[D][R]}{[DR]}\n$$\n其中 $[D]$、$[R]$ 和 $[DR]$ 分别是游离药物、游离受体和药物-受体复合物的摩尔浓度。药物浓度 $[D]$ 用 $C$ 表示。\n\n受体总浓度 $[R]_{\\text{total}}$ 是游离受体和结合受体之和：\n$$\n[R]_{\\text{total}} = [R] + [DR]\n$$\n由此，我们将游离受体浓度表示为 $[R] = [R]_{\\text{total}} - [DR]$。将其代入 $K_D$ 的表达式中：\n$$\nK_D = \\frac{C ([R]_{\\text{total}} - [DR])}{[DR]}\n$$\n重新整理以求解复合物浓度 $[DR]$：\n$$\nK_D [DR] = C [R]_{\\text{total}} - C [DR]\n$$\n$$\n[DR] (K_D + C) = C [R]_{\\text{total}}\n$$\n$$\n[DR] = \\frac{[R]_{\\text{total}} C}{K_D + C}\n$$\n分数占据率 $\\theta$ 是被药物结合的受体所占的比例：\n$$\n\\theta = \\frac{[DR]}{[R]_{\\text{total}}} = \\frac{C}{K_D + C}\n$$\n此药效学模型的核心假设是，观察到的效应 $E$ 与受体分数占据率成正比。当所有受体都被占据时（即在饱和药物浓度下，此时 $\\theta \\to 1$），达到最大可能效应 $E_{\\max}$。因此：\n$$\nE(C) = E_{\\max} \\cdot \\theta\n$$\n代入 $\\theta$ 的表达式：\n$$\nE(C) = E_{\\max} \\frac{C}{K_D + C}\n$$\n参数 $EC_{50}$ 的正式定义是产生 $50\\%$ 最大效应的药物浓度。在 $C=EC_{50}$ 时，设 $E(C) = E_{\\max}/2$：\n$$\n\\frac{E_{\\max}}{2} = E_{\\max} \\frac{EC_{50}}{K_D + EC_{50}}\n$$\n$$\n\\frac{1}{2} = \\frac{EC_{50}}{K_D + EC_{50}} \\implies K_D + EC_{50} = 2 \\cdot EC_{50} \\implies K_D = EC_{50}\n$$\n因此，解离常数 $K_D$ 与半最大效应浓度 $EC_{50}$ 相同。最终将浓度 $C$ 与效应 $E(C)$ 相关联的双参数模型是：\n$$\nE(C) = \\frac{E_{\\max} C}{EC_{50} + C}\n$$\n这是一个标准的双曲线饱和模型，在酶动力学背景下通常被称为米氏方程（Michaelis-Menten equation）。\n\n### 步骤2：通过非线性最小二乘法进行参数估计\n\n通过将推导出的模型与实验数据对 $(C_i, E_i)$（其中 $i=1, \\dots, n$）进行拟合，来估计参数 $E_{\\max}$ 和 $EC_{50}$。使用非线性最小二乘法（NLS），该方法寻找使残差平方和（SSR）$S$ 最小化的参数值：\n$$\nS(E_{\\max}, EC_{50}) = \\sum_{i=1}^{n} \\left( E_i - E(C_i; E_{\\max}, EC_{50}) \\right)^2\n$$\n优化在两个参数都必须为非负的物理约束下进行，即 $E_{\\max} \\ge 0$ 和 $EC_{50} \\ge 0$。这种约束优化问题通常使用像Levenberg-Marquardt这样的迭代数值算法来解决。`scipy.optimize.curve_fit` 函数提供了此过程的实现。\n\n### 步骤3：不确定性量化\n\n估计参数 $(\\hat{E}_{\\max}, \\hat{EC}_{50})$ 的不确定性通过构建置信区间来量化。NLS拟合过程产生参数协方差矩阵 $\\boldsymbol{\\Sigma}$ 的估计值。对于大样本量，该矩阵近似为：\n$$\n\\boldsymbol{\\Sigma} \\approx \\hat{\\sigma}^2 (\\mathbf{J}^T \\mathbf{J})^{-1}\n$$\n其中 $\\mathbf{J}$ 是模型函数关于参数的雅可比矩阵，在最优参数值处求值，而 $\\hat{\\sigma}^2$ 是残差的估计方差。\n\n$\\boldsymbol{\\Sigma}$ 的对角元素，记作 $\\Sigma_{jj}$，是参数估计值的估计方差。参数估计值 $\\hat{p}_j$ 的标准误（SE）是其方差的平方根：\n$$\nSE(\\hat{p}_j) = \\sqrt{\\Sigma_{jj}}\n$$\n参数 $p_j$ 的一个双侧 $(1-\\alpha) \\times 100\\%$ 置信区间使用学生t分布（Student's $t$-distribution）构建：\n$$\n\\text{CI} = \\hat{p}_j \\pm t_{1-\\alpha/2, \\nu} \\cdot SE(\\hat{p}_j)\n$$\n其中 $\\nu = n - p$ 是自由度（$n$ 是数据点数量，$p$ 是参数数量），$t_{1-\\alpha/2, \\nu}$ 是来自t分布的临界值，对应于 $1 - \\alpha/2$ 的累积概率。\n\n对于此问题，我们需要一个 $95\\%$ 的置信区间，因此 $\\alpha=0.05$。临界值为 $t_{0.975, n-2}$，因为有 $p=2$ 个参数（$E_{\\max}$ 和 $EC_{50}$）。该方法将应用于四个提供的数据集中的每一个，以估计参数及其相应的置信界限。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Solves the pharmacodynamic parameter estimation problem for four test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A (balanced range, moderate noise)\n        (np.array([0.0, 0.5, 1.0, 2.0, 3.0, 5.0, 10.0, 20.0]),\n         np.array([0.0, 14.1, 22.0, 36.0, 44.2, 51.0, 63.0, 70.5])),\n        # Test Case B (low concentrations only, weak saturation information)\n        (np.array([0.0, 0.1, 0.2, 0.4, 0.8]),\n         np.array([0.0, 1.6, 2.9, 6.3, 10.8])),\n        # Test Case C (noisy with an outlier)\n        (np.array([0.0, 0.5, 1.0, 1.5, 3.0, 6.0]),\n         np.array([0.0, 26.0, 39.0, 48.0, 85.0, 82.0])),\n        # Test Case D (near-saturation with clear plateau)\n        (np.array([0.0, 2.0, 4.0, 8.0, 16.0, 32.0]),\n         np.array([0.0, 29.5, 41.0, 47.5, 52.8, 56.3]))\n    ]\n\n    def saturable_model(C, Emax, EC50):\n        \"\"\"\n        Saturable concentration-effect model derived from law of mass action.\n        E(C) = (Emax * C) / (EC50 + C)\n        \"\"\"\n        # Use np.divide to handle potential division by zero safely,\n        # although C and EC50 are non-negative.\n        return np.divide(Emax * C, EC50 + C, out=np.zeros_like(C), where=(EC50 + C) != 0)\n\n    all_results = []\n    \n    for C_data, E_data in test_cases:\n        n = len(C_data)  # Number of observations\n        p_count = 2      # Number of parameters (Emax, EC50)\n        df = n - p_count # Degrees of freedom\n\n        # Provide reasonable initial guesses to aid convergence\n        # Emax guess: max observed effect\n        # EC50 guess: median of non-zero concentrations\n        Emax_guess = np.max(E_data) if E_data.size > 0 else 1.0\n        \n        # Ensure C_data[C_data > 0] is not empty\n        positive_C = C_data[C_data > 0]\n        EC50_guess = np.median(positive_C) if positive_C.size > 0 else 1.0\n        \n        # Handle case where all E_data is zero\n        if Emax_guess == 0: Emax_guess = 1.0\n            \n        initial_guess = [Emax_guess, EC50_guess]\n\n        try:\n            # Perform nonlinear least squares fitting\n            # The order of parameters in the model is Emax, EC50\n            # Bounds are [0, inf] for both parameters.\n            params, pcov = curve_fit(saturable_model, C_data, E_data, \n                                     p0=initial_guess, \n                                     bounds=([0, 0], [np.inf, np.inf]))\n            \n            Emax_hat, EC50_hat = params\n            \n            # Calculate standard errors from the covariance matrix\n            param_std_err = np.sqrt(np.diag(pcov))\n            SE_Emax, SE_EC50 = param_std_err\n\n            # Calculate the critical t-value for a 95% confidence interval\n            alpha = 0.05\n            t_crit = t.ppf(1 - alpha / 2, df)\n\n            # Calculate the 95% confidence intervals\n            EC50_low = EC50_hat - t_crit * SE_EC50\n            EC50_high = EC50_hat + t_crit * SE_EC50\n            \n            Emax_low = Emax_hat - t_crit * SE_Emax\n            Emax_high = Emax_hat + t_crit * SE_Emax\n\n            # Assemble the results in the specified order and round to two decimal places\n            # Order: [EC50, Emax, EC50_low, EC50_high, Emax_low, Emax_high]\n            result_list = [\n                round(EC50_hat, 2),\n                round(Emax_hat, 2),\n                round(EC50_low, 2),\n                round(EC50_high, 2),\n                round(Emax_low, 2),\n                round(Emax_high, 2)\n            ]\n            all_results.append(result_list)\n            \n        except RuntimeError:\n            # This can occur if the fit fails to converge, which is possible \n            # for ill-conditioned data. The problem assumes a fit will be found.\n            # If a fit fails, we would append a placeholder, but per problem structure,\n            # all test cases are expected to yield a result.\n            # As a fallback, use NaN values if fit fails.\n            all_results.append([np.nan] * 6)\n\n    # Format the final output string as a list of lists, with no spaces\n    # and all numbers formatted to two decimal places.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "4991566"}]}