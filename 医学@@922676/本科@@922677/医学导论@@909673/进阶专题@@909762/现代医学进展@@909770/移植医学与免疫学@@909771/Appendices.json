{"hands_on_practices": [{"introduction": "在为患者寻找合适的器官时，一个关键的障碍是他们可能已经存在的针对潜在捐赠者群体中常见人类白细胞抗原（HLA）的抗体，这种情况被称为致敏。计算群体反应性抗体（cPRA）是量化这一障碍的标准方法，它代表了患者与随机捐赠者不相容的概率。这个练习将引导你从群体遗传学的基本原理出发，计算一位致敏患者的 cPRA 值，从而理解其在器官分配中的重要性。[@problem_id:4985317]", "problem": "一位肾移植候选者有一份人类白细胞抗原 (Human Leukocyte Antigen, HLA) 列表，由于预先形成的供体特异性抗体，这些抗原被认为是不可接受的。计算的群体反应性抗体 (calculated panel reactive antibody, cPRA) 定义为随机选择的已故供体至少带有一个不可接受的抗原的概率，这使得该供体在虚拟交叉配型下对该受体是免疫学上不相容的。\n\n对于供体群体，假设如下：\n- 在每个基因座上，基因型遵循哈代-温伯格平衡。\n- 基因座之间存在连锁平衡，因此基因座在统计上是独立的。\n- 每个列出的抗原在其基因座内都是一个互斥的等位基因类别。\n- 供体是二倍体，每个基因座携带两个等位基因。\n\n该受体的不可接受抗原及其在供体群体中的估计等位基因频率如下：\n- HLA-A：A2 频率为 $0.26$，A24 频率为 $0.14$。\n- HLA-B：B7 频率为 $0.09$，B44 频率为 $0.12$。\n- HLA-DRB1：DR3 频率为 $0.11$，DR4 频率为 $0.13$。\n\n仅使用基本概率规则和上述假设，计算该受体的计算群体反应性抗体 (cPRA) 的单一概率值。将最终答案表示为不带百分号的小数，并四舍五入到四位有效数字。", "solution": "问题要求计算群体反应性抗体 ($cPRA$)。$cPRA$ 定义为随机选择的供体至少带有一个不可接受抗原的概率。这是免疫学上不相容匹配的概率。\n\n设 $P(\\text{不相容})$ 为随机供体不相容的概率。根据定义，$cPRA = P(\\text{不相容})$。计算其互补事件的概率 $P(\\text{相容})$ 更为直接，即随机供体相容的概率。一个相容的供体*不*拥有任何指定的不可接受抗原。这些概率之间的关系是：\n$$cPRA = 1 - P(\\text{相容})$$\n\n问题指出，三个指定的 HLA 基因座（HLA-A、HLA-B 和 HLA-DRB1）之间存在连锁平衡。这个统计独立性的假设允许我们将总体的相容概率计算为每个独立基因座相容概率的乘积：\n$$P(\\text{相容}) = P(\\text{在A基因座相容}) \\times P(\\text{在B基因座相容}) \\times P(\\text{在DRB1基因座相容})$$\n\n我们现在必须确定每个基因座的相容概率。问题指明供体是二倍体，并且群体处于哈代-温伯格平衡状态。对于一个供体来说，要在某个特定基因座上相容，他们就不能表达该基因座的任何不可接受抗原。由于 HLA 抗原是共显性表达的，这意味着供体的基因型不能包含任何不可接受的等位基因。\n\n设 $p_{U}$ 为某一基因座上所有不可接受等位基因的总频率。该基因座上剩余的“可接受”等位基因的频率为 $q = 1 - p_{U}$。对于一个二倍体个体，要使其基因型不含任何不可接受的等位基因，其在该基因座上的两个等位基因都必须来自可接受的等位基因池。根据哈代-温伯格平衡，一个个体对来自可接受池的等位基因为纯合子的概率是 $q^2$。\n\n让我们为每个基因座计算这个值。\n\n**HLA-A 基因座：**\n不可接受的抗原是 $A2$ 和 $A24$，对应的等位基因频率为 $p_{A2} = 0.26$ 和 $p_{A24} = 0.14$。问题指出这些是互斥的等位基因类别。A 基因座上不可接受等位基因的总频率是：\n$$p_{U,A} = p_{A2} + p_{A24} = 0.26 + 0.14 = 0.40$$\nA 基因座上可接受等位基因的频率是：\n$$q_A = 1 - p_{U,A} = 1 - 0.40 = 0.60$$\n供体在 A 基因座上相容（即基因型不含 $A2$ 或 $A24$ 等位基因）的概率是：\n$$P(\\text{在A基因座相容}) = q_A^2 = (0.60)^2 = 0.36$$\n\n**HLA-B 基因座：**\n不可接受的抗原是 $B7$ 和 $B44$，等位基因频率为 $p_{B7} = 0.09$ 和 $p_{B44} = 0.12$。B 基因座上不可接受等位基因的总频率是：\n$$p_{U,B} = p_{B7} + p_{B44} = 0.09 + 0.12 = 0.21$$\nB 基因座上可接受等位基因的频率是：\n$$q_B = 1 - p_{U,B} = 1 - 0.21 = 0.79$$\n供体在 B 基因座上相容的概率是：\n$$P(\\text{在B基因座相容}) = q_B^2 = (0.79)^2 = 0.6241$$\n\n**HLA-DRB1 基因座：**\n不可接受的抗原是 $DR3$ 和 $DR4$，等位基因频率为 $p_{DR3} = 0.11$ 和 $p_{DR4} = 0.13$。DRB1 基因座上不可接受等位基因的总频率是：\n$$p_{U,DR} = p_{DR3} + p_{DR4} = 0.11 + 0.13 = 0.24$$\nDRB1 基因座上可接受等位基因的频率是：\n$$q_{DR} = 1 - p_{U,DR} = 1 - 0.24 = 0.76$$\n供体在 DRB1 基因座上相容的概率是：\n$$P(\\text{在DRB1基因座相容}) = q_{DR}^2 = (0.76)^2 = 0.5776$$\n\n现在，我们可以通过将每个基因座的概率相乘来计算供体总的相容概率：\n$$P(\\text{相容}) = P(\\text{在A基因座相容}) \\times P(\\text{在B基因座相容}) \\times P(\\text{在DRB1基因座相容})$$\n$$P(\\text{相容}) = (0.36) \\times (0.6241) \\times (0.5776)$$\n$$P(\\text{相容}) \\approx 0.1297624576$$\n\n最后，我们使用互补概率计算 $cPRA$：\n$$cPRA = 1 - P(\\text{相容})$$\n$$cPRA \\approx 1 - 0.1297624576 = 0.8702375424$$\n\n问题要求结果四舍五入到四位有效数字。\n$$cPRA \\approx 0.8702$$", "answer": "$$\\boxed{0.8702}$$", "id": "4985317"}, {"introduction": "一旦确定了潜在的捐赠者，下一个关键步骤是精确评估供受者之间的不相容程度。这项练习将探讨组织相容性的三个不同解析度层面——等位基因、抗原和表位簇（eplet），以提供对免疫风险的精细评估。你将学习如何计算这些不同层面的错配数量，并理解它们对 T 细胞和 B 细胞介导的排斥反应的独特意义。[@problem_id:4985311]", "problem": "一名患者正在接受肾移植评估。人类白细胞抗原 (HLA) 分型显示以下 I 类 HLA-A 等位基因：供体表达 HLA-A $\\text{A*}02{:}01$ 和 $\\text{A*}24{:}02$，而受体表达 HLA-A $\\text{A*}02{:}01$ 和 $\\text{A*}03{:}01$。运用基础免疫学知识，思考不同粒度层级上的错配如何与同种异体识别（allorecognition）的可能性以及供体特异性抗体 (DSA) 的产生相关联。从第一性原理出发：\n\n- HLA 等位基因的定义：一个基因座上由特定序列定义的变体。\n- HLA-A 的抗原水平匹配使用两位数抗原组（例如 $\\text{A2}$、$\\text{A3}$、$\\text{A24}$）。\n- 一个 eplet 是 HLA 分子表面的一个最小多态性斑块，可作为 B 细胞受体和抗体的靶点；eplet 错配定义为供体 eplet 中不存在于任何受体等位基因上的 eplet 数量。\n\n在下述指定且简化的 HLA-A eplet 库下，计算等位基因水平的错配数、抗原水平的错配数和 eplet 水平的错配数：\n\n- 由 $\\text{A*}02{:}01$ 携带的 Eplet：$E(\\text{A*}02{:}01) = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\}$。\n- 由 $\\text{A*}24{:}02$ 携带的 Eplet：$E(\\text{A*}24{:}02) = \\{ e_{62}, e_{70Q}, e_{76E}, e_{90N}, e_{116Y}, e_{144}, e_{163} \\}$。\n- 由 $\\text{A*}03{:}01$ 携带的 Eplet：$E(\\text{A*}03{:}01) = \\{ e_{62}, e_{76E}, e_{90D}, e_{145R}, e_{152} \\}$。\n\n仅使用上述提供的 eplet 定义。假设抗原水平分组为：$\\text{A*}02{:}01 \\rightarrow \\text{A2}$，$\\text{A*}24{:}02 \\rightarrow \\text{A24}$，$\\text{A*}03{:}01 \\rightarrow \\text{A3}$。将错配数定义如下：\n\n- 等位基因错配数 $m_{\\text{allele}}$ 是在受体等位基因中未找到的供体等位基因的数量。\n- 抗原错配数 $m_{\\text{antigen}}$ 是在受体抗原中未找到的供体抗原的数量。\n- eplet 错配数 $m_{\\text{eplet}}$ 是不存在于任何受体等位基因上的独特供体 eplet 的数量。\n\n然后，从第一性原理出发，简要讨论为什么每个错配水平都可能在移植免疫学中导致同种异体识别和 DSA 的形成，将您的讨论建立在 T 细胞和 B 细胞识别的概念上，而不是基于注册库衍生的启发式方法。将您最终计算出的错配数表示为一个行矩阵 $\\left( m_{\\text{allele}}, m_{\\text{antigen}}, m_{\\text{eplet}} \\right)$。无需四舍五入；报告精确的整数计数，不带单位。", "solution": "该问题要求计算肾脏供体和受体之间三种不同类型的人类白细胞抗原 (HLA) 错配数，并随后讨论每种错配类型背后的免疫学原理。\n\n首先，我们将给定信息形式化。\n设 $D_{\\text{alleles}}$ 为供体表达的 HLA-A 等位基因集合， $R_{\\text{alleles}}$ 为受体表达的 HLA-A 等位基因集合。\n$$D_{\\text{alleles}} = \\{\\text{A*}02{:}01, \\text{A*}24{:}02\\}$$\n$$R_{\\text{alleles}} = \\{\\text{A*}02{:}01, \\text{A*}03{:}01\\}$$\n\n根据提供的规则，我们可以定义相应的 HLA-A 抗原集合 $D_{\\text{antigens}}$ 和 $R_{\\text{antigens}}$。\n$$D_{\\text{antigens}} = \\{\\text{A2}, \\text{A24}\\}$$\n$$R_{\\text{antigens}} = \\{\\text{A2}, \\text{A3}\\}$$\n\n每个等位基因的 eplet 组成以集合形式提供：\n$E(\\text{A*}02{:}01) = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\}$\n$E(\\text{A*}24{:}02) = \\{ e_{62}, e_{70Q}, e_{76E}, e_{90N}, e_{116Y}, e_{144}, e_{163} \\}$\n$E(\\text{A*}03{:}01) = \\{ e_{62}, e_{76E}, e_{90D}, e_{145R}, e_{152} \\}$\n\n利用这些信息，我们开始计算三种指定的错配数。\n\n1.  **等位基因错配数 ($m_{\\text{allele}}$)**\n    等位基因错配数 $m_{\\text{allele}}$ 定义为在受体等位基因中未找到的供体等位基因的数量。这是集合差 $D_{\\text{alleles}} \\setminus R_{\\text{alleles}}$ 的基数。\n    $$D_{\\text{alleles}} \\setminus R_{\\text{alleles}} = \\{\\text{A*}02{:}01, \\text{A*}24{:}02\\} \\setminus \\{\\text{A*}02{:}01, \\text{A*}03{:}01\\} = \\{\\text{A*}24{:}02\\}$$\n    这个结果集的基数是 $1$。\n    $$m_{\\text{allele}} = |\\{\\text{A*}24{:}02\\}| = 1$$\n\n2.  **抗原错配数 ($m_{\\text{antigen}}$)**\n    抗原错配数 $m_{\\text{antigen}}$ 定义为在受体抗原中未找到的供体抗原的数量。这是集合差 $D_{\\text{antigens}} \\setminus R_{\\text{antigens}}$ 的基数。\n    $$D_{\\text{antigens}} \\setminus R_{\\text{antigens}} = \\{\\text{A2}, \\text{A24}\\} \\setminus \\{\\text{A2}, \\text{A3}\\} = \\{\\text{A24}\\}$$\n    这个集合的基数是 $1$。\n    $$m_{\\text{antigen}} = |\\{\\text{A24}\\}| = 1$$\n\n3.  **Eplet 错配数 ($m_{\\text{eplet}}$)**\n    eplet 错配数 $m_{\\text{eplet}}$ 是不存在于任何受体等位基因上的独特供体 eplet 的数量。为计算此值，我们首先确定供体表达的完整 eplet 集合 $E_D$ 和受体表达的完整 eplet 集合 $E_R$。这些是它们各自等位基因的 eplet 的并集。\n\n    供体 eplet 集合 $E_D$：\n    $$E_D = E(\\text{A*}02{:}01) \\cup E(\\text{A*}24{:}02)$$\n    $$E_D = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\} \\cup \\{ e_{62}, e_{70Q}, e_{76E}, e_{90N}, e_{116Y}, e_{144}, e_{163} \\}$$\n    $$E_D = \\{ e_{62}, e_{70Q}, e_{76E}, e_{76V}, e_{90N}, e_{116Y}, e_{144}, e_{149A}, e_{163} \\}$$\n\n    受体 eplet 集合 $E_R$：\n    $$E_R = E(\\text{A*}02{:}01) \\cup E(\\text{A*}03{:}01)$$\n    $$E_R = \\{ e_{62}, e_{76V}, e_{90N}, e_{144}, e_{149A} \\} \\cup \\{ e_{62}, e_{76E}, e_{90D}, e_{145R}, e_{152} \\}$$\n    $$E_R = \\{ e_{62}, e_{76E}, e_{76V}, e_{90D}, e_{90N}, e_{144}, e_{145R}, e_{149A}, e_{152} \\}$$\n\n    错配的 eplet 是指那些在 $E_D$ 中但不在 $E_R$ 中的 eplet。我们计算集合差 $E_D \\setminus E_R$。\n    $$E_D \\setminus E_R = \\{ e_{70Q}, e_{116Y}, e_{163} \\}$$\n    Eplet $e_{62}$、$e_{76E}$、$e_{76V}$、$e_{90N}$、$e_{144}$ 和 $e_{149A}$ 存在于两个集合中，因此不构成错配。计数是结果集的基数。\n    $$m_{\\text{eplet}} = |\\{ e_{70Q}, e_{116Y}, e_{163} \\}| = 3$$\n\n**免疫学讨论**\n\n这三个错配水平对应于看待供体器官异源性的不同粒度，每个粒度都与受体免疫应答的特定机制相关。\n\n- **等位基因水平错配 ($m_{\\text{allele}}=1$)：**一个 HLA 等位基因对应于 HLA 蛋白的特定氨基酸序列。一个错配的等位基因，如本例中供体的 $\\text{A*}24{:}02$，对受体的免疫系统来说是一个外来蛋白。这种异源性是 T 细胞介导的同种异体识别的主要触发因素。\n    - **直接同种异体识别：**受体 T 细胞经过教育以识别自身 HLA 分子上的外来肽，它们可以交叉反应性地识别供体抗原呈递细胞 (APC) 表面上完整的、外来的供体 HLA 分子 ($\\text{A*}24{:}02$)。该通路会引发针对移植物的强大而迅速的 T 细胞反应。\n    - **间接同种异体识别：**外来的供体 HLA 蛋白 ($\\text{A*}24{:}02$) 被受体自身的 APC 摄取并加工成更小的肽段。这些肽段随后在受体自身的 HLA 分子（例如 $\\text{A*}02{:}01$ 或 $\\text{A*}03{:}01$）上呈递给受体辅助性 T 细胞。这种辅助性 T 细胞的活化对于协调整个抗移植物反应至关重要，包括为 B 细胞提供辅助。\n    因此，等位基因错配为 T 细胞驱动的排斥反应提供了基本的分子基础。\n\n- **抗原水平错配 ($m_{\\text{antigen}}=1$)：**这是一个基于历史血清学分型的较低分辨率的分类。抗原水平的错配（此处为供体的 $\\text{A24}$）意味着供体和受体 HLA 分子之间存在显著的结构差异。这种广泛的差异几乎保证了大量的氨基酸和 eplet 错配。因此，它可作为通过直接和间接途径发生强烈 T 细胞同种异体识别的一个强有力但较粗略的预测指标。\n\n- **Eplet 水平错配 ($m_{\\text{eplet}}=3$)：**这代表了与体液（抗体介导）反应相关的最高免疫学分辨率水平。一个 eplet 是 HLA 表面上由多态性氨基酸组成的最小三维斑块，可被 B 细胞受体 (BCR) 识别，并可成为抗体的靶点。\n    - **B 细胞识别与 DSA 形成：**B 细胞直接识别外来蛋白上的构象表位。供体 HLA 分子上的错配 eplet（此处为 $e_{70Q}$、$e_{116Y}$ 和 $e_{163}$）对受体的 B 细胞库来说是外来表位。其 BCR 能结合这些 eplet 中之一的 B 细胞可被激活。这种激活通过辅助性 T 细胞（通过间接途径激活）的辅助而大大增强。被激活的 B 细胞随后成熟为浆细胞，分泌针对该供体 eplet 的特异性抗体。这些抗体被称为供体特异性抗体 (DSA)。\n    - **抗体介导的排斥反应 (AMR)：**DSA 可以与表达在移植物血管内皮上的供体 HLA 分子结合。这种结合可以触发补体活化、炎症和内皮损伤，导致 AMR，这是急性和慢性移植物衰竭的主要原因。因此，eplet 错配数是评估产生 DSA 及后续 AMR 风险的定量指标。\n\n总而言之，等位基因错配是驱动 T 细胞反应的异源性的基本度量，而 eplet 错配则为 B 细胞活化和致病性 DSA 的产生风险提供了更精确的定量评估。\n\n计算出的错配数为 $m_{\\text{allele}} = 1$、$m_{\\text{antigen}} = 1$ 和 $m_{\\text{eplet}} = 3$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 3\n\\end{pmatrix}\n}\n$$", "id": "4985311"}, {"introduction": "成功的器官移植依赖于终身免疫抑制来预防排斥反应，但由于个体差异，药物剂量选择是一个重大挑战。这项练习将引入一个药代动力学模型，模拟患者的基因型（特别是 CYP3A5 基因）如何影响药物代谢。通过模拟药物浓度随时间的变化，你将亲身体验为何个体化给药对于安全有效地达到治疗目标至关重要。[@problem_id:4985320]", "problem": "你需要实现一个模拟，模拟他克莫司在一级消除单室模型中的谷浓度动态学，以比较细胞色素P450 3A族A亚族成员5 (CYP3A5) 表达者与非表达者之间的给药需求。目标是计算在两种给药策略下开始治疗时，达到指定目标谷浓度所需的时间。\n\n基础原理：\n- 一级消除：在两次给药之间，浓度 $C(t)$ 遵循 $dC/dt = -k\\,C(t)$，其中 $k$ 是消除速率常数。\n- 分布容积 $V$ 和清除率 $CL$ 的关系为 $k = CL/V$。\n- 对于口服给药，一部分剂量（比例为 $F$，即生物利用度）会到达中央室。\n- 在固定的时间间隔 $\\tau$ 内重复给药，其瞬时输入可近似为每个给药时间点的瞬时推注。\n\n模型假设及使用的固定参数：\n- 生物利用度 $F = 0.25$ (无单位)。\n- 每公斤分布容积 $V_d = 1.5\\,\\mathrm{L/kg}$。\n- CYP3A5 非表达者的每公斤清除率 $CL_{\\text{nonexp}} = 0.06\\,\\mathrm{L/h/kg}$。\n- CYP3A5 表达者的每公斤清除率 $CL_{\\text{exp}} = 0.12\\,\\mathrm{L/h/kg}$。\n- 给药间隔 $\\tau = 12\\,\\mathrm{h}$ (每日两次)。\n- 初始浓度 $C(0) = 0\\,\\mathrm{mg/L}$。\n- 目标谷浓度 $C_{\\text{tgt}} = 0.01\\,\\mathrm{mg/L}$。\n\n定义：\n- 对于体重为 $W$ (单位为 $\\mathrm{kg}$) 的患者，给定每日剂量 $D_{\\text{day}}$ (单位为 $\\mathrm{mg/kg/day}$)，在时间点 $n \\in \\{1,2,3,\\dots\\}$ 的每次给药剂量为 $\\frac{D_{\\text{day}}\\,W}{2}$ (单位为 $\\mathrm{mg}$)，每 $\\tau$ 小时给药一次。\n- 给药后浓度立即产生的有效增量为 $\\Delta C = \\dfrac{F \\cdot \\left(\\frac{D_{\\text{day}}\\,W}{2}\\right)}{V_d\\,W} = \\dfrac{F\\,D_{\\text{day}}}{2\\,V_d}$ (单位为 $\\mathrm{mg/L}$)，此增量与 $W$ 无关。\n- 在两次给药之间，浓度以因子 $r = e^{-k \\tau}$ 指数衰减，其中 $k = \\dfrac{CL}{V}$ 且 $CL = CL_{\\text{kg}} \\cdot W$，$V = V_d \\cdot W$，因此 $k = \\dfrac{CL_{\\text{kg}}}{V_d}$ 与 $W$ 无关。\n- 令 $C_n$ 表示第 $n$ 次给药前瞬间的谷浓度。那么 $C_0 = 0$，且对于 $n \\ge 1$ 有 $C_n = \\left(C_{n-1} + \\Delta C\\right) \\cdot r$。\n\n你的程序必须：\n1. 对于每个测试用例，判断目标谷浓度 $C_{\\text{tgt}}$ 是否可达。如果稳态谷浓度 $C_{\\text{ss}}$ 严格小于 $C_{\\text{tgt}}$，则声明其不可达。否则，模拟谷浓度的离散递推过程，直到 $C_n \\ge C_{\\text{tgt}}$，并报告最早的时间 $t_n = n \\cdot \\tau$ (单位为小时)，然后将其转换为天数，即 $t_n/24$。\n2. 以天为单位输出时间，结果为保留两位小数的浮点数。如果不可达，则输出 $-1.00$。\n\n角度单位不适用。物理单位：\n- 浓度在概念上以 $\\mathrm{mg/L}$ 为单位，但你的程序仅输出以天为单位的时间。\n- 最终时间严格以天为单位表示，并保留两位小数。\n\n测试套件：\n使用以下四个测试用例，每个用例由基因型和起始日剂量 $D_{\\text{day}}$ 定义：\n- 用例 1：基因型 = 非表达者, $D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$。\n- 用例 2：基因型 = 表达者, $D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$。\n- 用例 3：基因型 = 非表达者, $D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$。\n- 用例 4：基因型 = 表达者, $D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$。\n\n当 $D_{\\text{day}}$ 以每公斤为单位指定时，体重 $W$ 会在模型中被消去，但为了完整性，请在你的实现中假设 $W = 70\\,\\mathrm{kg}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如：$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是达到目标所需的天数（保留两位小数），如果不可达则为 $-1.00$。不应打印任何额外文本。", "solution": "该问题已经过验证，并被确定为具有科学依据、提法明确且客观。所有必要的参数和条件都已提供，可用于基于标准单室药代动力学模型来形式化一个解。该问题是可解的。\n\n### 1. 模型构建\n\n该问题使用一级消除单室模型和重复口服推注给药来描述他克莫司的谷浓度。\n\n在两次给药之间，血浆中的药物浓度 $C(t)$ 由一级消除的微分方程所决定：\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\n其中 $k$ 是消除速率常数。其解为指数衰减：$C(t) = C(t_0) e^{-k(t-t_0)}$。\n\n关键参数定义如下：\n- 生物利用度：$F = 0.25$\n- 每公斤分布容积：$V_d = 1.5\\,\\mathrm{L/kg}$\n- 给药间隔：$\\tau = 12\\,\\mathrm{h}$\n- 患者体重 $W$ 假设为 $70\\,\\mathrm{kg}$，但在浓度计算中被消去。\n- 每公斤清除率 $CL_{\\text{kg}}$ 取决于患者的基因型：\n  - CYP3A5 非表达者：$CL_{\\text{nonexp}} = 0.06\\,\\mathrm{L/h/kg}$\n  - CYP3A5 表达者：$CL_{\\text{exp}} = 0.12\\,\\mathrm{L/h/kg}$\n\n消除速率常数 $k$ 由清除率 ($CL$) 与分布容积 ($V$) 的比值给出。由于两者均与体重 $W$ 成正比（即 $CL = CL_{\\text{kg}} W$ 和 $V = V_d W$），因此 $k$ 与体重无关：\n$$\nk = \\frac{CL}{V} = \\frac{CL_{\\text{kg}} W}{V_d W} = \\frac{CL_{\\text{kg}}}{V_d}\n$$\n\n每 $\\tau=12$ 小时给药一次。每日剂量为 $D_{\\text{day}}$ (单位 $\\mathrm{mg/kg/day}$)，因此每次剂量为 $\\frac{D_{\\text{day}}W}{2}$。到达中央室的有效剂量为 $F \\cdot \\frac{D_{\\text{day}}W}{2}$。该剂量会引起浓度的瞬时增加，即 $\\Delta C$：\n$$\n\\Delta C = \\frac{\\text{有效剂量}}{\\text{容积}} = \\frac{F \\cdot \\frac{D_{\\text{day}}W}{2}}{V_d W} = \\frac{F D_{\\text{day}}}{2 V_d}\n$$\n这个增量也与患者体重 $W$ 无关。\n\n在两次给药之间，浓度按因子 $r$ 衰减：\n$$\nr = e^{-k \\tau}\n$$\n\n设 $C_n$ 为第 $n$ 次给药前瞬间测得的谷浓度（在时间 $t=(n-1)\\tau$）。初始浓度为 $C_0=0$，尽管本问题使用的索引方式略有不同，其中第一个谷浓度为 $C_1$。第 $(n-1)$ 次给药后的瞬时浓度为 $C_{n-1} + \\Delta C$。经过一个间隔 $\\tau$ 的衰减后，浓度变为下一个谷浓度 $C_n$。这就建立了递推关系：\n$$\nC_n = (C_{n-1} + \\Delta C) r, \\quad \\text{对于 } n \\ge 1 \\text{ 且 } C_0 = 0\\,\\mathrm{mg/L}\n$$\n\n### 2. 稳态分析与可达性\n\n谷浓度随每次给药而增加，并趋近于一个稳态值 $C_{\\text{ss}}$。通过在递推关系中设置 $C_n = C_{n-1} = C_{\\text{ss}}$ 可以求得此值：\n$$\nC_{\\text{ss}} = (C_{\\text{ss}} + \\Delta C) r \\implies C_{\\text{ss}}(1-r) = r \\Delta C \\implies C_{\\text{ss}} = \\frac{r \\Delta C}{1-r}\n$$\n只有当稳态谷浓度大于或等于目标浓度时，才能达到目标谷浓度 $C_{\\text{tgt}} = 0.01\\,\\mathrm{mg/L}$。然而，如果 $C_{\\text{ss}} = C_{\\text{tgt}}$，则只能在无穷长时间内渐近达到目标。因此，要在有限时间内达到目标，必须有 $C_{\\text{ss}} > C_{\\text{tgt}}$。问题陈述中提到，如果 $C_{\\text{ss}}  C_{\\text{tgt}}$，则认为目标不可达，我们将其解释为，对于有限时间的解，要求 $C_{\\text{ss}}  C_{\\text{tgt}}$。\n\n### 3. 达到目标时间的解析解\n\n如果目标可达，我们需要找到最小的整数给药次数 $n \\ge 1$，使得 $C_n \\ge C_{\\text{tgt}}$。该递推关系有一个闭式解：\n$$\nC_n = \\Delta C \\frac{r(1-r^n)}{1-r} = C_{\\text{ss}}(1-r^n)\n$$\n我们需要解不等式中的 $n$：\n$$\nC_{\\text{ss}}(1-r^n) \\ge C_{\\text{tgt}}\n$$\n$$\n1-r^n \\ge \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\n$$\n$$\nr^n \\le 1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\n$$\n由于 $r=e^{-k\\tau}$ 介于 0 和 1 之间，其对数为负。对两边取自然对数并除以 $\\ln(r)$ 会使不等式反向：\n$$\nn \\ln(r) \\le \\ln\\left(1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\\right)\n$$\n$$\nn \\ge \\frac{\\ln\\left(1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\\right)}{\\ln(r)}\n$$\n由于 $n$ 必须是整数，我们对右侧表达式取上整：\n$$\nn = \\left\\lceil \\frac{\\ln\\left(1 - \\frac{C_{\\text{tgt}}}{C_{\\text{ss}}}\\right)}{\\ln(r)} \\right\\rceil\n$$\n达到目标所需的时间为 $n$ 次给药的时间，每个给药周期为 $\\tau=12$ 小时。问题指定以 $t = n \\cdot \\tau$ 报告时间。以天为单位的时间是 $t_{\\text{days}} = \\frac{n \\cdot \\tau}{24}$。\n\n### 4. 各用例分步计算\n\n**常数：**\n- $F = 0.25$, $V_d = 1.5\\,\\mathrm{L/kg}$, $\\tau = 12\\,\\mathrm{h}$, $C_{\\text{tgt}} = 0.01\\,\\mathrm{mg/L}$。\n- 小时到天的转换因子：$1/24$。\n\n**用例 1：非表达者，$D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.06\\,\\mathrm{L/h/kg}$。\n2.  $k = \\frac{0.06}{1.5} = 0.04\\,\\mathrm{h}^{-1}$。\n3.  $r = e^{-0.04 \\cdot 12} = e^{-0.48} \\approx 0.61878$。\n4.  $\\Delta C = \\frac{0.25 \\cdot 0.1}{2 \\cdot 1.5} = \\frac{0.025}{3} \\approx 0.00833\\,\\mathrm{mg/L}$。\n5.  $C_{\\text{ss}} = \\frac{0.61878 \\cdot (0.025/3)}{1 - 0.61878} \\approx 0.01351\\,\\mathrm{mg/L}$。\n6.  $C_{\\text{ss}}  C_{\\text{tgt}}$? 是，$0.01351  0.01$。可达。\n7.  $n = \\lceil \\frac{\\ln(1 - 0.01/0.01351)}{\\ln(0.61878)} \\rceil = \\lceil \\frac{\\ln(0.2598)}{\\-0.48} \\rceil = \\lceil 2.807 \\rceil = 3$。\n8.  $t_{\\text{days}} = \\frac{3 \\cdot 12}{24} = 1.5$。结果：$1.50$。\n\n**用例 2：表达者，$D_{\\text{day}} = 0.1\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.12\\,\\mathrm{L/h/kg}$。\n2.  $k = \\frac{0.12}{1.5} = 0.08\\,\\mathrm{h}^{-1}$。\n3.  $r = e^{-0.08 \\cdot 12} = e^{-0.96} \\approx 0.38289$。\n4.  $\\Delta C = \\frac{0.25 \\cdot 0.1}{2 \\cdot 1.5} = \\frac{0.025}{3} \\approx 0.00833\\,\\mathrm{mg/L}$。\n5.  $C_{\\text{ss}} = \\frac{0.38289 \\cdot (0.025/3)}{1 - 0.38289} \\approx 0.00518\\,\\mathrm{mg/L}$。\n6.  $C_{\\text{ss}}  C_{\\text{tgt}}$? 是，$0.00518  0.01$。不可达。\n7.  结果：$-1.00$。\n\n**用例 3：非表达者，$D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.06\\,\\mathrm{L/h/kg}$，$k = 0.04\\,\\mathrm{h}^{-1}$，$r \\approx 0.61878$。\n2.  $\\Delta C = \\frac{0.25 \\cdot 0.2}{2 \\cdot 1.5} = \\frac{0.05}{3} \\approx 0.01667\\,\\mathrm{mg/L}$。\n3.  $C_{\\text{ss}} = \\frac{0.61878 \\cdot (0.05/3)}{1 - 0.61878} \\approx 0.02702\\,\\mathrm{mg/L}$。\n4.  $C_{\\text{ss}}  C_{\\text{tgt}}$? 是，$0.02702  0.01$。可达。\n5.  $n = \\lceil \\frac{\\ln(1 - 0.01/0.02702)}{\\ln(0.61878)} \\rceil = \\lceil \\frac{\\ln(0.6300)}{\\-0.48} \\rceil = \\lceil 0.963 \\rceil = 1$。\n6.  $t_{\\text{days}} = \\frac{1 \\cdot 12}{24} = 0.5$。结果：$0.50$。\n\n**用例 4：表达者，$D_{\\text{day}} = 0.2\\,\\mathrm{mg/kg/day}$**\n1.  $CL_{\\text{kg}} = 0.12\\,\\mathrm{L/h/kg}$，$k = 0.08\\,\\mathrm{h}^{-1}$，$r \\approx 0.38289$。\n2.  $\\Delta C = \\frac{0.25 \\cdot 0.2}{2 \\cdot 1.5} = \\frac{0.05}{3} \\approx 0.01667\\,\\mathrm{mg/L}$。\n3.  $C_{\\text{ss}} = \\frac{0.38289 \\cdot (0.05/3)}{1 - 0.38289} \\approx 0.01037\\,\\mathrm{mg/L}$。\n4.  $C_{\\text{ss}}  C_{\\text{tgt}}$? 是，$0.01037  0.01$。可达。\n5.  $n = \\lceil \\frac{\\ln(1 - 0.01/0.01037)}{\\ln(0.38289)} \\rceil = \\lceil \\frac{\\ln(0.0354)}{\\-0.96} \\rceil = \\lceil 3.48 \\rceil = 4$。\n6.  $t_{\\text{days}} = \\frac{4 \\cdot 12}{24} = 2.0$。结果：$2.00$。\n\n四个测试用例的计算结果为 $[1.50, -1.00, 0.50, 2.00]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Computes the time required to reach a target tacrolimus trough concentration\n    for different genotypes and dosing strategies in a one-compartment model.\n    \"\"\"\n    \n    # Define problem constants\n    F = 0.25            # Bioavailability (unitless)\n    V_d = 1.5           # Volume of distribution per kg (L/kg)\n    tau = 12.0          # Dosing interval (h)\n    C_tgt = 0.01        # Target trough concentration (mg/L)\n    \n    # Genotype-specific clearance rates per kg\n    CL_nonexp = 0.06    # Clearance for CYP3A5 nonexpressers (L/h/kg)\n    CL_exp = 0.12       # Clearance for CYP3A5 expressers (L/h/kg)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'genotype': 'nonexpresser', 'D_day': 0.1},\n        {'genotype': 'expresser', 'D_day': 0.1},\n        {'genotype': 'nonexpresser', 'D_day': 0.2},\n        {'genotype': 'expresser', 'D_day': 0.2},\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Determine parameters for the case\n        D_day = case['D_day']\n        if case['genotype'] == 'nonexpresser':\n            CL_kg = CL_nonexp\n        else:\n            CL_kg = CL_exp\n            \n        # 2. Calculate model constants based on case parameters\n        # Elimination rate constant, k (h^-1)\n        k = CL_kg / V_d\n        \n        # Decay factor over one dosing interval, r\n        r = np.exp(-k * tau)\n        \n        # Concentration increment per dose, delta_C (mg/L)\n        delta_C = (F * D_day) / (2 * V_d)\n        \n        # 3. Check for reachability by calculating steady-state trough concentration\n        # C_ss = (r * delta_C) / (1 - r)\n        # The target is unreachable if C_ss is not strictly greater than C_tgt,\n        # as reaching it would take infinite time if C_ss = C_tgt.\n        if (1 - r) == 0 or ((r * delta_C) / (1 - r)) = C_tgt:\n            results.append(\"{:.2f}\".format(-1.0))\n            continue\n            \n        C_ss = (r * delta_C) / (1 - r)\n\n        # 4. Analytically solve for the number of doses 'n'\n        # Formula: n = ceil( ln(1 - C_tgt/C_ss) / ln(r) )\n        # This is derived from solving C_n >= C_tgt for n.\n        ratio = C_tgt / C_ss\n        n = np.ceil(np.log(1 - ratio) / np.log(r))\n        \n        # 5. Calculate time in days and format the output\n        # Time in hours = n * tau\n        # Time in days = (n * tau) / 24.0\n        time_days = (n * tau) / 24.0\n        results.append(\"{:.2f}\".format(time_days))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "4985320"}]}