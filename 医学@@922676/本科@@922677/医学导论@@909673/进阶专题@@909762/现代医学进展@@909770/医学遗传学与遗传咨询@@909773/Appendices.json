{"hands_on_practices": [{"introduction": "理解复发风险是遗传咨询的基石。这个练习探讨了一个经典的常染色体隐性遗传场景，其中一个患病孩子的出生提供了关键信息，使我们能够精确地确定该状况在未来后代中出现的概率 [@problem_id:4968954]。", "problem": "一对无已知近亲关系且无既往家族史的夫妇，育有一个孩子，该孩子患有由单个基因的双等位基因致病性变异引起的完全外显的常染色体隐性遗传病。假设满足以下科学标准条件：\n- 群体足够大，在所研究的基因座上存在随机婚配，且该疾病足够罕见，以至于父母双方均患病的概率可以忽略不计。\n- 不存在表型模仿（即没有模仿该疾病的非遗传性状），且在同一个孩子身上产生两个致病等位基因的新生突变率可以忽略不计。\n- 孟德尔分离定律适用，因此携带者夫妇的每个孩子都独立地从父母各方获得一个等位基因。\n\n仅使用常染色体隐性遗传的定义和条件概率法则（包括Bayes定理），计算这对夫妇的下一个孩子患病的复发风险，条件是他们已有一个患病孩子。请将最终答案表示为最简分数，不要四舍五入。", "solution": "用户要求计算一种常染色体隐性遗传病的复发风险。\n\n### 步骤1：问题验证\n\n首先，我将提取已知条件并验证问题陈述。\n\n**提取的已知条件：**\n1.  该疾病是常染色体隐性遗传且完全外显，由单个基因的双等位基因致病性变异引起。\n2.  一对夫妇有一个孩子患有此病。\n3.  这对夫妇无已知近亲关系，也无该疾病的既往家族史。\n4.  标准的群体遗传学假设适用：大群体、随机婚配、罕见病。\n5.  不存在表型模仿。\n6.  产生两个致病等位基因的新生突变率可以忽略不计。\n7.  孟德尔分离定律适用，且每个孩子的遗传结果是独立的。\n8.  任务是计算下一个孩子的复发风险，条件是已有一个患病孩子。\n9.  该方法必须使用常染色体隐性遗传的定义和条件概率。\n10. 最终答案必须是最简分数。\n\n**验证分析：**\n该问题科学上基于孟德尔遗传学的基本原理。常染色体隐性遗传病要求个体从父母各方遗传一个致病等位基因，即共遗传两个致病等位基因。这对夫妇已有一个患病孩子是关键信息。这个问题提法得当，因为在给定的假设（完全外显、无表型模仿、新生突变率可忽略）下，这一信息足以确定父母的基因型。其语言客观且精确。该问题自成体系且逻辑一致。这是医学遗传学和遗传咨询中遇到的一个经典、现实的场景。因此，该问题被视为有效。\n\n### 步骤2：解题推导\n\n设 `$A$` 表示显性野生型等位基因，`$a$` 表示隐性致病等位基因。对于常染色体隐性遗传病，基因型与表型的对应关系如下：\n-   基因型 `$AA$`：未患病，非携带者。\n-   基因型 `$Aa$`：未患病，携带者。\n-   基因型 `$aa$`：患病。\n\n问题陈述，这对夫妇有一个患病的孩子。这意味着患病孩子的基因型必定是 `$aa$`。\n\n要生育一个基因型为 `$aa$` 的孩子，该孩子必须从父母各方遗传一个 `$a$` 等位基因。这为我们提供了关于父母基因型的确定信息。由于父母表型未患病（这一点由“无既往家族史”和为能生育的夫妇计算复发风险这一大背景所暗示），他们的基因型不可能是 `$aa$`。为了让每个亲本在未患病的情况下都能提供一个 `$a$` 等位基因，他们必须都是杂合携带者。因此，母亲和父亲的基因型都必定是 `$Aa$`。他们已有一个患病孩子的这一观察结果，使他们成为“必然携带者”。\n\n问题要求的是复发风险，即这对夫妇的下一个孩子患病的概率。这可以构建为一个条件概率：\n设 `$C_1$` 为第一个孩子患病的事件。\n设 `$C_2$` 为第二个（下一个）孩子患病的事件。\n我们要求解 `$P(C_2 | C_1)$`。\n\n在父母基因型固定的条件下，他们连续生育的孩子的基因型是独立事件。也就是说，`$P(C_2 | C_1, G_{\\text{parents}}) = P(C_2 | G_{\\text{parents}})$`，其中 `$G_{\\text{parents}}$` 代表父母的基因型。\n\n问题的核心是确定 `$G_{\\text{parents}}$`。事件 `$C_1$`（第一个孩子的基因型为 `$aa$`）更新了我们对父母基因型的认知。如上所述，在完全外显和新生突变率可忽略的情况下，事件 `$C_1$` 只有在父母双方都是携带者（`$Aa \\times Aa$`）时才可能发生。用Bayes的术语来说，在已知有一个患病孩子的条件下，父母是携带者的后验概率为 `$1$`。\n`$P(G_{\\text{parents}} = Aa \\times Aa | C_1) = 1$`。\n\n因此，问题简化为计算在父母基因型为 `$Aa$` 和 `$Aa$` 的情况下，生育一个患病孩子的概率。\n`$P(C_2 | C_1) = P(C_2 | G_{\\text{parents}} = Aa \\times Aa)$`。\n\n我们可以根据孟德尔分离定律的原理，使用庞氏表来确定 `$Aa \\times Aa$` 杂交后代的基因型概率。每个亲本以 `$\\frac{1}{2}$` 的概率传递等位基因 `$A$` 或 `$a$`。\n\n后代可能的基因型有：\n1.  `$AA$`：孩子从母亲（概率 `$\\frac{1}{2}$`）和父亲（概率 `$\\frac{1}{2}$`）那里都遗传到 `$A$`。\n    `$P(AA) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$`。这个孩子未患病。\n2.  `$Aa$`：孩子从母亲遗传 `$A$` 并从父亲遗传 `$a$`，或者从母亲遗传 `$a$` 并从父亲遗传 `$A$`。\n    `$P(Aa) = (\\frac{1}{2} \\times \\frac{1}{2}) + (\\frac{1}{2} \\times \\frac{1}{2}) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$`。这个孩子是未患病的携带者。\n3.  `$aa$`：孩子从母亲（概率 `$\\frac{1}{2}$`）和父亲（概率 `$\\frac{1}{2}$`）那里都遗传到 `$a$`。\n    `$P(aa) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$`。这个孩子患病。\n\n复发风险是下一个孩子患病的概率，这对应于基因型 `$aa$` 的概率。根据上述计算，这个概率是 `$\\frac{1}{4}$`。关于群体遗传学的大量信息和对Bayes定理的提及，虽然在技术上与完整的形式推导相关，但由于“已有一个患病孩子”这一条件事件的存在，问题变得简单了，因为该事件消除了关于父母携带者状态的所有不确定性。之后每次怀孕的风险都是独立的，并且保持为 `$\\frac{1}{4}$`。\n\n最终答案是基因型为 `$aa$` 的概率。\n复发风险 `$ = P(aa) = \\frac{1}{4}$`。\n这已是按要求的最简分数。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "4968954"}, {"introduction": "遗传风险通常比简单的孟德尔比例所显示的更为复杂，因为并非每个携带致病性变异的人都会发病。本练习介绍了不完全外显率这一关键概念，要求您将遗传基因的概率与基因表达的年龄依赖性概率结合起来 [@problem_id:4968892]。", "problem": "一个家庭就一种由已知致病性变异引起的常染色体显性遗传病寻求指导。该变异的估计终生外显率为 $80\\%$，到 $60$ 岁时的累积外显率为 $70\\%$。父母一方有临床表型，并已证实为该变异的杂合子。另一方无表型且不携带该变异。假设该疾病遵循常染色体显性遗传方式，不存在位点异质性，新发突变率可忽略不计，没有表型模拟，且疾病表达仅根据给定的外显率曲线在携带者中发生。使用孟德尔遗传定律和外显率（即给定基因型下出现表型的概率）的定义，计算他们的孩子在 $60$ 岁前表现出该疾病的概率。将最终答案以小数形式表示，并四舍五入至四位有效数字。", "solution": "该情景遵循常染色体显性遗传和外显率的定义。我们从两个基本依据出发：\n\n1. 孟德尔遗传（孟德尔第一分离定律）：常染色体位点上的杂合子亲本将其变异等位基因传递给后代的概率为 $1/2$。\n2. 外显率：根据定义，在给定年龄 $t$ 时的外显率是条件概率 $P(\\text{年龄 } t \\text{ 前出现表型} \\mid \\text{携带致病性变异的基因型})$。\n\n设 $I$ 表示孩子继承变异等位基因的事件，设 $M_{60}$ 表示孩子在 $60$ 岁前表现出疾病的事件。在没有表型模拟且新发突变可忽略不计的假设下，疾病表现需要继承致病性变异。因此，\n$$\nP(M_{60}) \\;=\\; P(M_{60} \\cap I) \\;=\\; P(I)\\,P(M_{60} \\mid I).\n$$\n根据孟德尔遗传定律，当一个亲本为杂合子患病者，而另一个亲本为无表型非携带者时，我们有\n$$\nP(I) \\;=\\; \\frac{1}{2}.\n$$\n根据给定的到 $60$ 岁的累积外显率，我们有\n$$\nP(M_{60} \\mid I) \\;=\\; 0.70.\n$$\n因此，\n$$\nP(M_{60}) \\;=\\; \\frac{1}{2} \\times 0.70 \\;=\\; 0.35.\n$$\n所提供的终生外显率 $80\\%$（即 $0.80$）对于计算特定年龄的风险不是必需的，因为问题明确要求的是在 $60$ 岁前发病的情况，其对应的外显率是 $0.70$。\n\n将 $0.35$ 四舍五入到四位有效数字，得到 $0.3500$。", "answer": "$$\\boxed{0.3500}$$", "id": "4968892"}, {"introduction": "现代医学在很大程度上依赖于筛查测试，但解释其结果需要严谨的概率推理。这个练习要求您将贝叶斯定理应用于一个真实的产前筛查场景，展示测试的性能特征和初始风险（患病率）如何共同决定阳性或阴性结果的真正含义 [@problem_id:4968949]。", "problem": "一名孕妇正在接受针对胎儿$21$三体综合征的无创产前检测 (NIPT)，其母龄特异性$21$三体综合征患病率为$1/200$。所使用的NIPT针对$21$三体综合征的灵敏度为$0.99$，特异性为$0.999$。请仅使用“灵敏度为给定患病情况下检测结果为阳性的概率”和“特异性为给定未患病情况下检测结果为阴性的概率”这两个基本定义，以及基于贝叶斯定理的标准概率推理，计算阳性预测值（即在NIPT结果为阳性的情况下胎儿患有$21$三体综合征的概率）和NIPT结果为阴性后的残留风险（即在NIPT结果为阴性的情况下胎儿患有$21$三体综合征的概率）。将每个概率表示为最简精确分数，且不要转换为百分比。将两个最终值一起以单行矩阵的形式给出。", "solution": "本题要求计算两个条件概率：阳性预测值 (PPV) 和检测结果为阴性后的疾病残留风险。我们将使用贝叶斯定理，该定理指出，对于两个事件 $A$ 和 $B$，给定 $B$ 的情况下 $A$ 的条件概率由 $P(A|B) = \\frac{P(B|A)P(A)}{P(B)}$ 给出。\n\n首先，我们根据题目陈述定义事件：\n- 令 $D$ 为胎儿患有21三体综合征的事件。\n- 令 $D^c$ 为胎儿未患有21三体综合征的事件。\n- 令 $T^+$ 为无创产前检测 (NIPT) 结果为阳性的事件。\n- 令 $T^-$ 为NIPT结果为阴性的事件。\n\n根据题目陈述，我们已知以下概率：\n- 21三体综合征的患病率：$P(D) = \\frac{1}{200}$。\n- 检测的灵敏度：$P(T^+|D) = 0.99 = \\frac{99}{100}$。这是指在疾病存在的情况下，检测结果为阳性的概率。\n- 检测的特异性：$P(T^-|D^c) = 0.999 = \\frac{999}{1000}$。这是指在疾病不存在的情况下，检测结果为阴性的概率。\n\n根据这些已知条件，我们可以推导出其他必要的概率：\n- 胎儿未患有21三体综合征的概率：$P(D^c) = 1 - P(D) = 1 - \\frac{1}{200} = \\frac{199}{200}$。\n- 假阴性率，即在疾病存在的情况下检测结果为阴性的概率：$P(T^-|D) = 1 - P(T^+|D) = 1 - \\frac{99}{100} = \\frac{1}{100}$。\n- 假阳性率，即在疾病不存在的情况下检测结果为阳性的概率：$P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - \\frac{999}{1000} = \\frac{1}{1000}$。\n\n**1. 计算阳性预测值 (PPV)**\n\nPPV是在检测结果为阳性的情况下患有该疾病的概率，即 $P(D|T^+)$。使用贝叶斯定理：\n$$P(D|T^+) = \\frac{P(T^+|D)P(D)}{P(T^+)}$$\n为了求出 $P(D|T^+)$，我们首先需要使用全概率公式计算检测结果为阳性的总概率 $P(T^+)$：\n$$P(T^+) = P(T^+|D)P(D) + P(T^+|D^c)P(D^c)$$\n将已知值以精确分数的形式代入：\n$$P(T^+) = \\left(\\frac{99}{100}\\right)\\left(\\frac{1}{200}\\right) + \\left(\\frac{1}{1000}\\right)\\left(\\frac{199}{200}\\right)$$\n$$P(T^+) = \\frac{99}{20000} + \\frac{199}{200000}$$\n为了将这些分数相加，我们找到公分母 $200000$：\n$$P(T^+) = \\frac{99 \\times 10}{200000} + \\frac{199}{200000} = \\frac{990}{200000} + \\frac{199}{200000} = \\frac{990 + 199}{200000} = \\frac{1189}{200000}$$\n现在，我们可以计算PPV，$P(D|T^+)$。贝叶斯定理的分子是 $P(T^+|D)P(D) = \\frac{99}{20000}$。\n$$P(D|T^+) = \\frac{\\frac{99}{20000}}{\\frac{1189}{200000}} = \\frac{99}{20000} \\times \\frac{200000}{1189} = \\frac{99 \\times 10}{1189} = \\frac{990}{1189}$$\n分子 $990$ 的质因数分解为 $990 = 2 \\times 3^2 \\times 5 \\times 11$。分母 $1189$ 不能被 $2$、$3$、$5$ 或 $11$ 整除。进一步研究表明 $1189 = 29 \\times 41$。由于没有公因数，分数 $\\frac{990}{1189}$ 是最简形式。\n\n**2. 计算阴性结果后的残留风险**\n\n残留风险是在检测结果为阴性的情况下患有该疾病的概率，即 $P(D|T^-)$。再次使用贝叶斯定理：\n$$P(D|T^-) = \\frac{P(T^-|D)P(D)}{P(T^-)}$$\n首先，我们使用全概率公式计算检测结果为阴性的总概率 $P(T^-)$：\n$$P(T^-) = P(T^-|D)P(D) + P(T^-|D^c)P(D^c)$$\n将已知值以精确分数的形式代入：\n$$P(T^-) = \\left(\\frac{1}{100}\\right)\\left(\\frac{1}{200}\\right) + \\left(\\frac{999}{1000}\\right)\\left(\\frac{199}{200}\\right)$$\n$$P(T^-) = \\frac{1}{20000} + \\frac{999 \\times 199}{200000}$$\n为了计算乘积 $999 \\times 199$，我们得到 $999 \\times 199 = 198801$。\n$$P(T^-) = \\frac{1 \\times 10}{200000} + \\frac{198801}{200000} = \\frac{10 + 198801}{200000} = \\frac{198811}{200000}$$\n(或者，$P(T^-) = 1 - P(T^+) = 1 - \\frac{1189}{200000} = \\frac{200000-1189}{200000} = \\frac{198811}{200000}$。)\n现在，我们可以计算残留风险，$P(D|T^-)$。贝叶斯定理的分子是 $P(T^-|D)P(D) = \\frac{1}{20000}$。\n$$P(D|T^-) = \\frac{\\frac{1}{20000}}{\\frac{198811}{200000}} = \\frac{1}{20000} \\times \\frac{200000}{198811} = \\frac{10}{198811}$$\n分子是 $10 = 2 \\times 5$。分母 $198811$ 不能被 $2$ 或 $5$ 整除。因此，分数 $\\frac{10}{198811}$ 是最简形式。\n\n所要求的两个值是阳性预测值 $\\frac{990}{1189}$ 和阴性结果后的残留风险 $\\frac{10}{198811}$。我们将它们以单行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{990}{1189} & \\frac{10}{198811}\n\\end{pmatrix}\n}\n$$", "id": "4968949"}]}