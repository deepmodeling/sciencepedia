{"hands_on_practices": [{"introduction": "$I$ 型超敏反应，如过敏性休克，是临床上最迅速和剧烈的免疫反应之一。其核心触发机制是过敏原与肥大细胞表面的 $\\text{IgE}$ 受体结合，导致细胞脱颗粒，而这个过程可以用化学动力学中的受体-配体结合模型来精确描述。\n\n通过本练习，你将从第一性原理出发，推导并计算触发脱颗粒所需的时间。这不仅能加深你对 $I$ 型超敏反应发生速度的理解，还能锻炼你将基础生物物理模型应用于临床相关问题的能力。[@problem_id:4964937]", "problem": "一名有特应性病史的患者经历了由免疫球蛋白E（IgE）介导的速发型I型超敏反应。在组织中，肥大细胞表面展示着与高亲和力Fc epsilon受体I（$Fc\\varepsilon RI$）结合的IgE。一种多价过敏原突然扩散到组织中，并维持恒定的细胞外浓度。过敏原对IgE-$Fc\\varepsilon RI$的交联引发了脱颗粒。对于此情景，假设以下基于生物物理学的近似：一旦被过敏原占据的$Fc\\varepsilon RI$结合IgE的分数达到阈值分数$p_{\\mathrm{th}}$，脱颗粒就会被可靠地触发，这反映了当占据率足够高时，会发生充分的交联。在时间$t=0$时，过敏原浓度跃升并保持恒定，且所有受体最初都未被占据。\n\n请使用恒定配体浓度下受体-配体结合的质量作用定律作为出发点。过敏原浓度为$C = 5.0 \\times 10^{-9}$ M。过敏原与受体结合的IgE的结合（on）速率常数为$k_{\\mathrm{on}} = 2.0 \\times 10^{5}$ M$^{-1}$ s$^{-1}$，解离（off）速率常数为$k_{\\mathrm{off}} = 2.0 \\times 10^{-3}$ s$^{-1}$。脱颗粒阈值为$p_{\\mathrm{th}} = 0.25$。假设环境混合均匀，$C$随时间恒定，并且每个受体的占据动态遵循单位点可逆结合过程。\n\n请从第一性原理出发，推导出受体占据率达到$p_{\\mathrm{th}}$所需的时间$t^{\\ast}$，并计算其数值。最终时间以秒为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "该问题陈述经评估有效，因为它在科学上基于化学动力学和免疫学原理，问题设定良好，信息充分，目标明确，并且没有任何不合格的缺陷。\n\n问题要求计算，在引入恒定浓度的配体（过敏原）后，受体占据分数$p(t)$达到阈值$p_{\\mathrm{th}}$所需的时间$t^{\\ast}$。该结合过程被建模为单位点可逆过程。\n\n设$R$表示未结合的IgE-$Fc\\varepsilon$RI复合物，$A$表示过敏原。过敏原结合的复合物$RA$的形成由以下反应描述：\n$$ R + A \\underset{k_{\\mathrm{off}}}{\\stackrel{k_{\\mathrm{on}}}{\\rightleftharpoons}} RA $$\n其中$k_{\\mathrm{on}}$是结合速率常数，$k_{\\mathrm{off}}$是解离速率常数。\n\n根据质量作用定律，结合复合物浓度$[RA]$的变化率由下式给出：\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}[R][A] - k_{\\mathrm{off}}[RA] $$\n问题陈述过敏原浓度是恒定的，所以我们设$[A] = C$。\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}C[R] - k_{\\mathrm{off}}[RA] $$\n受体总浓度$[R_T]$是恒定的，等于未结合受体和已结合受体的浓度之和：$[R_T] = [R] + [RA]$。因此，我们可以将$[R]$表示为$[R] = [R_T] - [RA]$。将此代入速率方程得到：\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}C([R_T] - [RA]) - k_{\\mathrm{off}}[RA] $$\n受体的占据分数定义为$p(t) = \\frac{[RA]}{[R_T]}$。由此可得$[RA] = p(t)[R_T]$。对时间求导，并注意到$[R_T]$是常数，我们得到$\\frac{d[RA]}{dt} = [R_T]\\frac{dp}{dt}$。\n\n将$[RA]$及其导数的这些表达式代入速率方程：\n$$ [R_T]\\frac{dp}{dt} = k_{\\mathrm{on}}C([R_T] - p(t)[R_T]) - k_{\\mathrm{off}}(p(t)[R_T]) $$\n总受体浓度$[R_T]$是一个公因子，可以从方程中消去：\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C(1 - p) - k_{\\mathrm{off}}p $$\n这是一个关于占据分数$p(t)$的一阶线性常微分方程。我们可以通过对含$p$的项进行分组来重新整理它：\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C - (k_{\\mathrm{on}}C + k_{\\mathrm{off}})p $$\n我们定义观察到的伪一阶速率常数$k_{\\mathrm{obs}} = k_{\\mathrm{on}}C + k_{\\mathrm{off}}$。方程变为：\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C - k_{\\mathrm{obs}}p $$\n在平衡状态下（$t \\to \\infty$），净速率为零（$\\frac{dp}{dt} = 0$），占据率达到其平衡值$p_{\\mathrm{eq}}$。\n$$ 0 = k_{\\mathrm{on}}C - k_{\\mathrm{obs}}p_{\\mathrm{eq}} \\implies p_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{obs}}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{on}}C + k_{\\mathrm{off}}} $$\n我们可以用$p_{\\mathrm{eq}}$和$k_{\\mathrm{obs}}$重写这个微分方程：\n$$ \\frac{dp}{dt} = k_{\\mathrm{obs}}p_{\\mathrm{eq}} - k_{\\mathrm{obs}}p = -k_{\\mathrm{obs}}(p - p_{\\mathrm{eq}}) $$\n为了解这个方程，我们使用分离变量法，并利用初始条件，即在$t=0$时，受体未被占据，即$p(0)=0$。\n$$ \\int_{p(0)}^{p(t)} \\frac{dp'}{p' - p_{\\mathrm{eq}}} = \\int_{0}^{t} -k_{\\mathrm{obs}} dt' $$\n$$ \\int_{0}^{p(t)} \\frac{dp'}{p' - p_{\\mathrm{eq}}} = -k_{\\mathrm{obs}} t $$\n$$ \\left[ \\ln|p' - p_{\\mathrm{eq}}| \\right]_{0}^{p(t)} = -k_{\\mathrm{obs}} t $$\n$$ \\ln|p(t) - p_{\\mathrm{eq}}| - \\ln|-p_{\\mathrm{eq}}| = -k_{\\mathrm{obs}} t $$\n因为对于任何有限时间$t$，$p(t)  p_{\\mathrm{eq}}$，所以$|p(t) - p_{\\mathrm{eq}}| = p_{\\mathrm{eq}} - p(t)$。\n$$ \\ln\\left(\\frac{p_{\\mathrm{eq}} - p(t)}{p_{\\mathrm{eq}}}\\right) = -k_{\\mathrm{obs}}t $$\n$$ \\ln\\left(1 - \\frac{p(t)}{p_{\\mathrm{eq}}}\\right) = -k_{\\mathrm{obs}}t $$\n求解$p(t)$：\n$$ 1 - \\frac{p(t)}{p_{\\mathrm{eq}}} = \\exp(-k_{\\mathrm{obs}}t) $$\n$$ p(t) = p_{\\mathrm{eq}}\\left(1 - \\exp(-k_{\\mathrm{obs}}t)\\right) $$\n我们需要找到使$p(t^{\\ast}) = p_{\\mathrm{th}}$成立的时间$t^{\\ast}$。\n$$ p_{\\mathrm{th}} = p_{\\mathrm{eq}}\\left(1 - \\exp(-k_{\\mathrm{obs}}t^{\\ast})\\right) $$\n求解$t^{\\ast}$：\n$$ \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}} = 1 - \\exp(-k_{\\mathrm{obs}}t^{\\ast}) $$\n$$ \\exp(-k_{\\mathrm{obs}}t^{\\ast}) = 1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}} $$\n$$ -k_{\\mathrm{obs}}t^{\\ast} = \\ln\\left(1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}}\\right) $$\n$$ t^{\\ast} = -\\frac{1}{k_{\\mathrm{obs}}} \\ln\\left(1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}}\\right) $$\n这就是达到阈值所需时间的符号表达式。\n\n现在，我们代入给定的数值：\n$C = 5.0 \\times 10^{-9}$ M\n$k_{\\mathrm{on}} = 2.0 \\times 10^{5}$ M$^{-1}$ s$^{-1}$\n$k_{\\mathrm{off}} = 2.0 \\times 10^{-3}$ s$^{-1}$\n$p_{\\mathrm{th}} = 0.25$\n\n首先，我们计算中间项$k_{\\mathrm{obs}}$和$p_{\\mathrm{eq}}$。\n乘积$k_{\\mathrm{on}}C$为：\n$$ k_{\\mathrm{on}}C = (2.0 \\times 10^{5} \\, \\mathrm{M}^{-1}\\mathrm{s}^{-1}) \\times (5.0 \\times 10^{-9} \\, \\mathrm{M}) = 10.0 \\times 10^{-4} \\, \\mathrm{s}^{-1} = 1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1} $$\n观察到的速率常数$k_{\\mathrm{obs}}$为：\n$$ k_{\\mathrm{obs}} = k_{\\mathrm{on}}C + k_{\\mathrm{off}} = (1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}) + (2.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}) = 3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1} $$\n平衡占据分数$p_{\\mathrm{eq}}$为：\n$$ p_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{on}}C + k_{\\mathrm{off}}} = \\frac{1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}}{3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}} = \\frac{1}{3} $$\n阈值占据率为$p_{\\mathrm{th}}=0.25 = \\frac{1}{4}$。由于$p_{\\mathrm{th}}  p_{\\mathrm{eq}}$（即$\\frac{1}{4}  \\frac{1}{3}$），阈值将在有限时间内达到。\n\n现在，我们计算$t^{\\ast}$：\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}} \\ln\\left(1 - \\frac{1/4}{1/3}\\right) $$\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3}} \\ln\\left(1 - \\frac{3}{4}\\right) \\, \\mathrm{s} $$\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3}} \\ln\\left(\\frac{1}{4}\\right) \\, \\mathrm{s} $$\n使用恒等式$\\ln(1/x) = -\\ln(x)$，我们有$\\ln(1/4) = -\\ln(4)$。\n$$ t^{\\ast} = \\frac{1}{3.0 \\times 10^{-3}} \\ln(4) \\, \\mathrm{s} $$\n$$ t^{\\ast} = \\frac{\\ln(2^2)}{3.0 \\times 10^{-3}} \\, \\mathrm{s} = \\frac{2\\ln(2)}{3.0 \\times 10^{-3}} \\, \\mathrm{s} $$\n使用$\\ln(2) \\approx 0.693147$的值：\n$$ t^{\\ast} \\approx \\frac{2 \\times 0.693147}{3.0 \\times 10^{-3}} \\, \\mathrm{s} = \\frac{1.386294}{3.0 \\times 10^{-3}} \\, \\mathrm{s} \\approx 462.098 \\, \\mathrm{s} $$\n根据要求，将结果四舍五入到四位有效数字：\n$$ t^{\\ast} \\approx 462.1 \\, \\mathrm{s} $$", "answer": "$$\\boxed{462.1}$$", "id": "4964937"}, {"introduction": "$II$ 型超敏反应涉及抗体介导的细胞毒性，例如药物引起的溶血性贫血。在这种情况下，抗体（$\\text{IgG}$）与细胞表面抗原结合，并启动补体系统，最终导致细胞裂解，而这个过程的有效性取决于单个细胞上结合的抗体数量，这是一个概率性事件。\n\n本练习将指导你结合平衡结合理论和概率论，来量化发生细胞溶解的红细胞比例。这种方法让你能够从分子相互作用的微观层面，预测细胞群体水平的宏观病理后果，是理解和评估 $II$ 型超敏反应严重程度的关键技能。[@problem_id:4964883]", "problem": "一名患者在接触一种能使红细胞膜半抗原化的β-内酰胺类抗生素后，出现了与II型（抗体介导的细胞毒性）超敏反应一致的药物诱导性溶血性贫血。在一项平衡状态下的受控体外测定中，每个红细胞（RBC）带有正好 $N = 10$ 个相同的半抗原化位点，这些位点可被循环中的免疫球蛋白G（IgG）识别。对于每个位点，抗药物IgG的平衡解离常数为 $K_{D} = 10\\,\\text{nM}$，血浆中的总IgG浓度为 $[\\text{IgG}]_{\\text{tot}} = 5\\,\\text{nM}$。红细胞浓度足够低，以至于游离IgG浓度约等于总IgG浓度（即 $[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}}$）。假设所有位点都是等效的，并且独立结合。\n\n假设经典补体途径在测定时间内裂解一个红细胞的条件是，当且仅当至少有两个IgG分子同时结合到该红细胞表面（也就是说，在同一个红细胞上有两个或更多被占据的位点，就足以在测定的时间尺度上触发C1q的结合和膜攻击复合物的形成）。\n\n仅从平衡状态下配体-受体结合的质量作用定律和对 $N$ 个位点进行独立伯努利试验的定义出发，推导在该测定中发生补体介导裂解的红细胞预期比例的表达式，并根据上述参数进行数值计算。将最终答案表示为四舍五入到四位有效数字的无量纲小数。", "solution": "该场景可以通过免疫球蛋白G（IgG）与每个红细胞（RBC）上 $N$ 个相同、独立的位点的平衡配体结合模型，以及经典补体激活的概率性要求来建模。基本出发点是：\n\n1. 单个位点的质量作用定律：对于平衡状态下的可逆结合反应 $\\text{IgG} + \\text{Site} \\rightleftharpoons \\text{IgG}\\text{-Site}$，解离常数 $K_{D}$ 定义为\n$$\nK_{D} = \\frac{[\\text{IgG}]_{\\text{free}} \\,[\\text{Site}]_{\\text{free}}}{[\\text{IgG}\\text{-Site}]}.\n$$\n对于单个位点，在平衡状态下的占据分数 $\\theta$（即给定站点被结合的概率）由经过充分验证的关系式给出\n$$\n\\theta = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}}.\n$$\n\n2. 红细胞上的独立相同结合位点意味着每个红细胞上结合的IgG分子数量遵循参数为 $N$ 和 $p$ 的二项分布，其中 $p$ 是每个位点的结合概率：\n$$\np = \\theta = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}}.\n$$\n\n3. 在此测定中，经典补体的要求是，当且仅当至少有两个IgG分子结合到一个红细胞上时，该红细胞才会裂解。因此，一个红细胞被裂解的概率等于在 $N$ 次试验中，成功概率为 $p$ 的情况下，至少有两次成功（结合位点）的二项概率：\n$$\nP(\\text{lysis}) = \\sum_{k=2}^{N} \\binom{N}{k} p^{k} (1-p)^{N-k} = 1 - \\left[ \\binom{N}{0} p^{0} (1-p)^{N} + \\binom{N}{1} p^{1} (1-p)^{N-1} \\right].\n$$\n这可以简化为\n$$\nP(\\text{lysis}) = 1 - \\left[ (1-p)^{N} + N p (1-p)^{N-1} \\right].\n$$\n\n我们现在使用给定的参数从结合平衡中计算 $p$。假设 $[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}}$ 是合理的，因为红细胞浓度相对于IgG池来说很低，所以\n$$\n[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}} = 5\\,\\text{nM}, \\quad K_{D} = 10\\,\\text{nM}.\n$$\n因此，\n$$\np = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}} = \\frac{5}{10 + 5} = \\frac{5}{15} = \\frac{1}{3}.\n$$\n\n当 $N = 10$ 且 $p = \\frac{1}{3}$ 时，裂解概率的精确表达式变为\n$$\nP(\\text{lysis}) = 1 - \\left[ \\left(1 - \\frac{1}{3}\\right)^{10} + 10 \\cdot \\frac{1}{3} \\left(1 - \\frac{1}{3}\\right)^{9} \\right]\n= 1 - \\left[ \\left(\\frac{2}{3}\\right)^{10} + \\frac{10}{3} \\left(\\frac{2}{3}\\right)^{9} \\right].\n$$\n我们可以将所有项通分到共同的分母 $3^{10}$ 上：\n$$\n\\left(\\frac{2}{3}\\right)^{10} = \\frac{2^{10}}{3^{10}} = \\frac{1024}{59049}, \\quad\n\\frac{10}{3} \\left(\\frac{2}{3}\\right)^{9} = \\frac{10 \\cdot 2^{9}}{3^{10}} = \\frac{5120}{59049}.\n$$\n因此，\n$$\nP(\\text{lysis}) = 1 - \\frac{1024 + 5120}{59049} = 1 - \\frac{6144}{59049} = \\frac{59049 - 6144}{59049} = \\frac{52905}{59049}.\n$$\n这个分数可以约去一个因子3：\n$$\nP(\\text{lysis}) = \\frac{17635}{19683}.\n$$\n其数值为，\n$$\nP(\\text{lysis}) \\approx 0.8959508\\ldots\n$$\n作为无量纲小数，四舍五入到四位有效数字，\n$$\nP(\\text{lysis}) \\approx 0.8960.\n$$\n\n因此，在所述条件下，发生补体介导裂解的红细胞的预期比例在四舍五入到四位有效数字后为 $0.8960$。", "answer": "$$\\boxed{0.8960}$$", "id": "4964883"}, {"introduction": "自身免疫病的一个核心特征是“表位扩散”（epitope spreading），即免疫反应从最初的几个自身抗原表位逐渐扩展到更多表位，导致疾病的慢性化和恶化。我们可以通过建立一个动态系统模型来模拟这一复杂过程，该模型描述了已识别表位的数量如何随时间演变。\n\n在这项练习中，你将推导出一个描述表位扩散的数学模型，并编写代码来实现它。这不仅能让你深入理解自身免疫病进展的内在逻辑，也是一次将免疫学原理与计算思维相结合的宝贵实践，体现了现代定量医学的研究范式。[@problem_id:4964942]", "problem": "要求您形式化一个关于自身抗原生成和表位扩散的原则性定量模型，从基础免疫学和概率论中推导出期望的离散时间更新，并实现该模型以计算在连续的炎症周期中，适应性免疫系统识别出的不同自身表位的期望数量。该模型必须基于以下基本定义和经过充分检验的事实：表位扩散是指免疫反应最初集中于一组有限的表位，由于持续的组织损伤和抗原处理，反应范围扩大到包括其他表位的过程；克隆选择需要在激活性环境中进行抗原识别；期望的线性性允许对期望计数进行加性分解；有限的抗原库限制了可被识别的新表位的数量。\n\n假设和定义：\n- 目标组织中存在一个大小为 $M$ 的有限潜在自身表位库。这代表了在所考虑的炎症环境下，原则上所有可能被识别的不同表位。\n- 在离散周期 $t$，令 $n_t$ 表示当前已识别（主动靶向）的独特自身表位的期望数量。\n- 每个已识别的表位都会导致组织损伤和抗原释放；在每个周期中，每个已识别的表位平均会向抗原处理途径释放或揭示 $r$ 个新的候选表位（自身抗原生成）。\n- 对于每个新释放的候选表位，其被处理、呈递并打破耐受从而被添加到已识别集合中的独立概率为 $p$。一个调节控制参数 $c \\in [0,1]$ 将有效激活概率缩放为 $p_{\\mathrm{eff}} = (1 - c)\\,p$，这反映了当 $c$ 接近 1 时的抑制作用。\n- 只有之前未被识别的表位可以被添加。在有限库的约束下，周期 $t$ 释放的候选表位中新表位的期望比例为 $\\frac{M - n_t}{M}$。\n- 您应假设候选表位的评估是独立的，并应用期望的线性性来获得一个确定性的期望值更新。在所有周期中，期望计数必须保持在闭区间 $[0,M]$ 内。\n\n任务：\n1. 根据所述假设，逻辑推导出从 $n_t$ 到 $n_{t+1}$ 的确定性离散时间期望更新，用 $M$、$r$、$p$、$c$ 和 $n_t$ 表示，不引入任何未声明的参数。\n2. 实现一个程序，该程序：\n   - 根据给定的值初始化 $n_0$。\n   - 对下面每个测试案例，将推导出的期望值更新迭代恰好 $T$ 个周期，以获得 $n_T$。\n   - 通过在必要时（由于浮点运算）进行适当的钳位操作，确保每一步的期望计数都保持在 $[0,M]$ 范围内。\n   - 以四舍五入到恰好3位小数的实数形式生成结果。\n\n测试套件：\n为下面列出的每个参数集 $(M, n_0, r, p, c, T)$ 计算 $n_T$：\n- 案例 A: $M=100$, $n_0=1$, $r=3$, $p=0.1$, $c=0.2$, $T=10$。\n- 案例 B: $M=50$, $n_0=5$, $r=0$, $p=0.5$, $c=0.0$, $T=20$。\n- 案例 C: $M=5$, $n_0=1$, $r=5$, $p=0.8$, $c=0.0$, $T=10$。\n- 案例 D: $M=1000$, $n_0=10$, $r=0.05$, $p=0.02$, $c=0.5$, $T=50$。\n- 案例 E: $M=20$, $n_0=20$, $r=10$, $p=1.0$, $c=0.0$, $T=100$。\n- 案例 F: $M=200$, $n_0=2$, $r=1.5$, $p=0.2$, $c=1.0$, $T=15$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,\\dots,x_6]$），其中每个 $x_i$ 是对应案例计算出的 $n_T$，四舍五入到恰好3位小数。不应产生任何其他输出。此问题中没有物理单位，答案为实数（浮点数）。", "solution": "该问题被评估为有效，因为它具有免疫学原理的科学基础，在数学上是适定的、客观的，并包含一套完整且一致的定义和参数。它代表了一个与指定主题直接相关的、可形式化的定量建模任务。\n\n### 第1部分：离散时间期望更新的推导\n\n目标是推导 $n_{t+1}$（在周期 $t+1$ 时识别的独特自身表位的期望数量）的更新规则，作为 $n_t$（在周期 $t$ 时的数量）的函数。我们将根据所给的假设，应用期望的线性性原理，一步步进行推导。\n\n1.  **周期 $t$ 时已识别表位的期望数量**：用 $n_t$ 表示。这是我们系统的状态变量。\n\n2.  **自身抗原生成的总期望值**：问题陈述，每个已识别的 $n_t$ 个表位都会导致组织损伤，进而导致新的候选表位被释放或揭示。平均而言，每个已识别的表位在每个周期会产生 $r$ 个新的候选表位。根据期望的线性性，在周期 $t$ 内生成的候选表位的总期望数量是已识别表位的数量与每个表位的生成率的乘积：\n    $$ E[\\text{candidates generated}] = n_t \\times r $$\n\n3.  **新候选表位的比例**：潜在自身表位的总库是有限的，大小为 $M$。在周期 $t$，$n_t$ 个表位已被识别。因此，未被识别的（即“新的”）表位的数量是 $M - n_t$。问题给出的假设是，释放的候选表位中新表位的期望比例由下式给出：\n    $$ \\text{Fraction}_{\\text{novel}} = \\frac{M - n_t}{M} = 1 - \\frac{n_t}{M} $$\n    这假设生成的候选表位是整个表位库的一个代表性样本。\n\n4.  **新候选表位的期望数量**：为了求出在周期 $t$ 内生成的新候选表位的期望数量，我们将生成的候选表位总数乘以期望为新表位的比例：\n    $$ E[\\text{novel candidates}] = (n_t r) \\times \\left( \\frac{M - n_t}{M} \\right) $$\n\n5.  **打破耐受的概率**：每个新的候选表位都必须被处理、由抗原提呈细胞呈递，并在一个能打破自身耐受的环境中被T细胞或B细胞克隆识别。这一系列事件的基础概率是 $p$。该概率受到一个调节控制参数 $c \\in [0, 1]$ 的调制，其中 $c \\approx 1$ 意味着强烈的抑制作用。有效概率 $p_{\\mathrm{eff}}$ 由下式给出：\n    $$ p_{\\mathrm{eff}} = (1 - c) p $$\n\n6.  **新识别表位的期望数量**：假设对每个新候选表位打破耐受的过程是独立事件，我们可以再次应用期望的线性性。新加入到已识别集合中的新表位的期望数量（记为 $\\Delta n_t$）是新候选表位的期望数量乘以有效识别概率：\n    $$ \\Delta n_t = E[\\text{newly recognized}] = E[\\text{novel candidates}] \\times p_{\\mathrm{eff}} $$\n    代入第4步和第5步的表达式：\n    $$ \\Delta n_t = \\left( n_t r \\frac{M - n_t}{M} \\right) \\times (1 - c) p $$\n\n7.  **更新方程**：在周期 $t+1$ 时已识别表位的期望数量（记为 $n_{t+1}$）是周期 $t$ 时已识别的数量与该周期内新识别表位的期望数量之和：\n    $$ n_{t+1} = n_t + \\Delta n_t $$\n    代入 $\\Delta n_t$ 的完整表达式，得到最终的确定性离散时间更新方程：\n    $$ n_{t+1} = n_t + n_t r \\left( \\frac{M - n_t}{M} \\right) p (1 - c) $$\n    这可以改写成类似于离散逻辑斯谛方程的形式：\n    $$ n_{t+1} = n_t + r p (1 - c) n_t \\left(1 - \\frac{n_t}{M}\\right) $$\n    该方程描述了已识别表位的期望数量随离散时间周期的演变。模型的约束要求 $n_t \\in [0, M]$。如果参数导致 $n_{t+1}$ 的值超出此范围，则必须对其进行钳位处理。具体来说，如果计算出的 $n_{t+1}$ 超过 $M$，则将其设为 $M$，代表表位库饱和。如果它低于 $0$（仅可能由于浮点误差，因为当 $n_t \\in [0,M]$ 时增量为非负），则将其设为 $0$。\n\n### 第2部分：实现\n\n推导出的更新规则在一个程序中实现，该程序对每个给定的参数集迭代 $T$ 个周期。状态变量 $n_t$ 用 $n_0$ 初始化，并根据公式进行更新。在每一步中，该值都被钳位在区间 $[0, M]$ 内。最终值 $n_T$ 四舍五入到3位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the expected number of distinct self-epitopes recognized by the\n    adaptive immune system over T inflammatory cycles for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (M, n0, r, p, c, T)\n    test_cases = [\n        (100, 1, 3, 0.1, 0.2, 10),      # Case A\n        (50, 5, 0, 0.5, 0.0, 20),      # Case B\n        (5, 1, 5, 0.8, 0.0, 10),      # Case C\n        (1000, 10, 0.05, 0.02, 0.5, 50),  # Case D\n        (20, 20, 10, 1.0, 0.0, 100),   # Case E\n        (200, 2, 1.5, 0.2, 1.0, 15),   # Case F\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M, n0, r, p, c, T = case\n        \n        # Initialize the expected number of recognized epitopes.\n        # Use floating-point numbers for the calculation.\n        n_current = float(n0)\n        M_float = float(M)\n\n        # Iterate the discrete-time update for T cycles.\n        for _ in range(T):\n            # The model is invalid if n_current  M_float or n_current  0.\n            # We proceed assuming n_current is in [0, M] due to clamping.\n            \n            # The fraction of candidates that are novel.\n            # This term is zero if M is zero to avoid division by zero, or if all epitopes are recognized.\n            if M_float == 0 or n_current = M_float:\n                novel_fraction = 0.0\n            else:\n                novel_fraction = (M_float - n_current) / M_float\n\n            # Calculate the expected number of newly recognized epitopes.\n            # This is the core of the derived update rule.\n            increment = r * n_current * novel_fraction * (1.0 - c) * p\n            \n            # Update the expected number of recognized epitopes.\n            n_current += increment\n            \n            # Enforce the constraint that n must be in [0, M] by clamping.\n            # This is necessary for discrete models with high growth rates (e.g., Case C)\n            # and as a safeguard against floating-point inaccuracies.\n            n_current = max(0.0, min(n_current, M_float))\n\n        # Append the final result, rounded to 3 decimal places.\n        # The f-string format ensures exactly three decimal places.\n        results.append(f\"{n_current:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "4964942"}]}