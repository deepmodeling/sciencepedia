{"hands_on_practices": [{"introduction": "发病率是衡量疾病频率的基本指标，但更精确的发病密度（Incidence Density）通过引入“人时”（person-time）的概念，能够准确处理动态人群中个体观察时间不等的复杂情况。本练习 [@problem_id:4977179] 将指导你完成一次队列研究中的人时计算，这是流行病学研究中的一项核心技能，对于准确评估疾病风险至关重要。通过这个具体的计算，你将深入理解动态风险评估的精髓。", "problem": "一项在某城市进行的队列研究对一个封闭人群进行了一个日历年的随访，以测量一种新发慢性病的发生情况。在1月$1$日，有$12{,}000$名成年人被确认为未患该病。随访期为同一个平年的1月$1$日至12月$31$日。请仅使用流行病学中发病率和人时的核心定义。\n\n在这一年中，发生了以下事件，其时间点是相对于随访开始时指定的。所有计数均指不同的个体；没有个体经历超过一个事件。患上该疾病的个体被认为在所列时刻发生事件，此后不再贡献风险时间。在患病前迁出或死亡的个体在所列时刻被删失，并贡献截至该时刻的风险时间。将每个月视为一年的十二分之一，并将“[月份]末”解释为该月的最后一天。\n\n- 新发疾病病例：3月底（时间 $3/12$ 年）有 $40$ 例，6月底（时间 $6/12$ 年）有 $60$ 例，9月底（时间 $9/12$ 年）有 $50$ 例，12月底（时间 $12/12$ 年）有 $30$ 例。\n- 与疾病无关的失访（删失）：4月底（时间 $4/12$ 年）有 $200$ 人迁出，8月底（时间 $8/12$ 年）有 $150$ 人迁出，10月底（时间 $10/12$ 年）有 $120$ 人因其他原因死亡。\n\n请仅使用基本定义，计算该人群在这一年中的疾病发病率（也称为发病密度），以每 $1{,}000$ 人年表示。将您的答案四舍五入到四位有效数字。将最终发病率表示为对应于“每 $1{,}000$ 人年”的纯数字。", "solution": "该问题提问明确，科学严谨，并提供了计算发病率所需的所有信息。因此，该问题被认为是有效的。\n\n核心任务是计算发病率（也称为发病密度），这是流行病学中衡量疾病频率的一个基本指标。发病率，记作 $IR$，定义为在特定时期内发生的新发病例数 $I$ 除以同一时期内的总风险人时 $PT$。\n\n$$\nIR = \\frac{I}{PT}\n$$\n\n计算将分三步进行：\n1.  确定新发病例总数 $I$。\n2.  计算整个队列在一年随访期内的总风险人时 $PT$。\n3.  计算发病率，将其换算为每 $1{,}000$ 人年的比率，并按要求四舍五入到四位有效数字。\n\n**步骤1：计算新发病例总数 ($I$)**\n\n问题给出了在一年中特定时间点诊断出的新发病例数。新发病例总数 $I$ 是这些病例数的总和。\n-   3月底的病例：$40$\n-   6月底的病例：$60$\n-   9月底的病例：$50$\n-   12月底的病例：$30$\n\n新发病例总数为：\n$$\nI = 40 + 60 + 50 + 30 = 180\n$$\n\n**步骤2：计算总风险人时 ($PT$)**\n\n人时是每个个体被随访并处于疾病风险状态的时间总和。一旦个体患病或被删失（因迁出或因其他原因死亡而失访），他们就不再贡献人时。\n\n初始风险人群为 $N_0 = 12{,}000$。我们可以通过将队列中三个不同群体的贡献相加来计算总人时：\n1.  完成全年随访且未患病或被删失的个体。\n2.  患上该疾病的个体（发病病例）。\n3.  被删失的个体。\n\n首先，让我们确定每个群体的人数。\n-   新发病例总数：$I = 180$。\n-   被删失个体总数：问题陈述 $200$ 人在4月底迁出，$150$ 人在8月底迁出，$120$ 人在10月底因其他原因死亡。\n    $$\n    C_{total} = 200 + 150 + 120 = 470\n    $$\n-   完成全年风险随访的个体数量：这是初始人群减去成为病例或被删失的人数。\n    $$\n    N_{complete} = N_0 - I - C_{total} = 12{,}000 - 180 - 470 = 11{,}350\n    $$\n\n现在，我们计算每个群体的人时贡献，时间以年为单位。\n-   **完成全年随访的个体贡献的人时 ($PT_{complete}$):**\n    这 $11{,}350$ 名个体在整个 $1$ 年期间都处于风险之中。\n    $$\n    PT_{complete} = 11{,}350 \\text{ persons} \\times 1 \\text{ year} = 11{,}350 \\text{ person-years}\n    $$\n\n-   **发病病例贡献的人时 ($PT_{cases}$):**\n    每个病例从研究开始到被诊断的时刻贡献人时。\n    -   $40$ 例在时间 $t = 3/12$ 年：$40 \\times \\frac{3}{12} = 10$ 人年。\n    -   $60$ 例在时间 $t = 6/12$ 年：$60 \\times \\frac{6}{12} = 30$ 人年。\n    -   $50$ 例在时间 $t = 9/12$ 年：$50 \\times \\frac{9}{12} = 37.5$ 人年。\n    -   $30$ 例在时间 $t = 12/12$ 年：$30 \\times \\frac{12}{12} = 30$ 人年。\n    来自病例的总人时是其总和：\n    $$\n    PT_{cases} = 10 + 30 + 37.5 + 30 = 107.5 \\text{ person-years}\n    $$\n\n-   **被删失个体贡献的人时 ($PT_{censored}$):**\n    每个被删失的个体从研究开始到失访的时刻贡献人时。\n    -   $200$ 人在时间 $t = 4/12$ 年被删失：$200 \\times \\frac{4}{12} = \\frac{800}{12} = \\frac{200}{3}$ 人年。\n    -   $150$ 人在时间 $t = 8/12$ 年被删失：$150 \\times \\frac{8}{12} = 100$ 人年。\n    -   $120$ 人在时间 $t = 10/12$ 年被删失：$120 \\times \\frac{10}{12} = 100$ 人年。\n    来自被删失个体的总人时是其总和：\n    $$\n    PT_{censored} = \\frac{200}{3} + 100 + 100 = 200 + \\frac{200}{3} = \\frac{600}{3} + \\frac{200}{3} = \\frac{800}{3} \\text{ person-years}\n    $$\n\n-   **总人时 ($PT$):**\n    队列的总风险人时是所有三个群体贡献的总和。\n    $$\n    PT = PT_{complete} + PT_{cases} + PT_{censored} = 11{,}350 + 107.5 + \\frac{800}{3}\n    $$\n    为了精确求和，我们使用分数：$107.5 = \\frac{215}{2}$。\n    $$\n    PT = 11{,}350 + \\frac{215}{2} + \\frac{800}{3} = \\frac{11{,}350 \\times 6}{6} + \\frac{215 \\times 3}{6} + \\frac{800 \\times 2}{6}\n    $$\n    $$\n    PT = \\frac{68{,}100 + 645 + 1{,}600}{6} = \\frac{70{,}345}{6} \\text{ person-years}\n    $$\n\n**步骤3：计算最终发病率**\n\n现在我们使用总病例数 $I=180$ 和总人时 $PT = \\frac{70{,}345}{6}$ 人年来计算发病率。\n$$\nIR = \\frac{I}{PT} = \\frac{180}{\\frac{70{,}345}{6}} = \\frac{180 \\times 6}{70{,}345} = \\frac{1{,}080}{70{,}345} \\text{ cases per person-year}\n$$\n\n问题要求以每 $1{,}000$ 人年表示的发病率。我们将计算出的比率乘以 $1{,}000$。\n$$\nIR_{1000} = \\frac{1{,}080}{70{,}345} \\times 1{,}000\n$$\n现在我们进行除法和乘法运算：\n$$\nIR_{1000} \\approx 0.0153528 \\times 1{,}000 \\approx 15.3528 \\text{ per } 1{,}000 \\text{ person-years}\n$$\n最后，我们必须将结果四舍五入到四位有效数字。前四位有效数字是 $1$、$5$、$3$ 和 $5$。第五位有效数字是 $2$，小于 $5$，所以我们向下舍入。\n\n最终发病率为 $15.35$ 每 $1{,}000$ 人年。问题要求的是纯数字。", "answer": "$$\n\\boxed{15.35}\n$$", "id": "4977179"}, {"introduction": "在评估疾病严重性时，病死率（Case Fatality Rate, CFR）是一个关键指标，但在疫情暴发的早期阶段，其计算充满了挑战。由于病例从确诊到出现最终结局（康复或死亡）需要时间，不同计算方法可能导致对病毒致死性的截然不同的评估。这项练习 [@problem_id:2087580] 旨在揭示这种“结局延迟”偏倚，通过计算原始病死率和解决病例病死率，让你亲身体会数据解读中的关键细微差别。", "problem": "在一种名为 Krona-77 的新型病原体爆发的早期阶段，流行病学家们正在努力了解其严重性。该病毒引起的疾病有一个显著特征：在致死病例中，从症状出现到死亡的时间通常远短于非致死病例中从症状出现到完全康复的时间。\n\n疫情爆发第45天，该市的公共卫生当局发布了以下累计数据：\n- 累计确诊病例：8,450\n- 累计死亡人数：625\n- 累计康复人数：1,875\n\n为了评估其致死率，考虑了两种不同的病死率（CFR）计算指标：\n1.  **粗病死率（Crude CFR）**：总死亡人数与总确诊病例数的比率。\n2.  **已解决病例病死率（Resolved-case CFR）**：总死亡人数与已有结果病例总数（即死亡人数和康复人数之和）的比率。\n\n根据第45天的数据，以下哪个选项分别正确报告了粗病死率和已解决病例病死率？将两种率均表示为保留两位有效数字的小数。\n\nA. 粗病死率：0.074；已解决病例病死率：0.25\n\nB. 粗病死率：0.25；已解决病例病死率：0.074\n\nC. 粗病死率：0.074；已解决病例病死率：0.33\n\nD. 粗病死率：0.22；已解决病例病死率：0.75\n\nE. 粗病死率：0.25；已解决病例病死率：0.75", "solution": "粗病死率定义为总死亡人数与总确诊病例数的比率。使用 $D$ 代表死亡人数，$C$ 代表总确诊病例数，$R$ 代表康复人数：\n$$\\text{Crude CFR}=\\frac{D}{C}=\\frac{625}{8450}=\\frac{25}{338}\\approx 0.07396\\ \\rightarrow\\ 0.074\\ \\text{to two significant figures}.$$\n已解决病例病死率定义为总死亡人数与已解决病例总数的比率，其中已解决病例为 $D+R$：\n$$\\text{Resolved-case CFR}=\\frac{D}{D+R}=\\frac{625}{625+1875}=\\frac{625}{2500}=0.25.$$\n因此，正确的组合是粗病死率 $=0.074$ 和已解决病例病死率 $=0.25$，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "2087580"}, {"introduction": "准确的诊断是控制疾病传播的基础，而评估诊断测试的性能则是流行病学的核心任务之一。灵敏度（Sensitivity）和特异度（Specificity）是衡量测试内在准确性的指标，但它们并不能直接告诉我们在实际应用中一个阳性或阴性结果的可信度有多高。本练习 [@problem_id:4666923] 将引导你推导并计算阳性预测值（PPV）和阴性预测值（NPV），从而理解测试的实际应用价值是如何依赖于疾病在人群中的流行率的。", "problem": "一家医院实验室使用聚合酶链式反应（PCR）作为参考标准，评估一种用于呼吸道病原体的新型快速抗原检测试验。在一个验证队列中，该试验应用于由参考标准确定的两组人群：第一组由$180$名确诊感染者组成，其中$168$人检测结果为阳性；第二组由$220$名确诊未感染者组成，其中$198$人检测结果为阴性。随后，该试验计划用于一个社区筛查项目，已知该社区的感染患病率为$P = 0.15$。\n\n从灵敏度是条件概率$P(\\text{test positive} \\mid \\text{disease})$，特异度是条件概率$P(\\text{test negative} \\mid \\text{no disease})$，患病率是边缘概率$P(\\text{disease})$这些基础流行病学定义出发，首先，根据验证队列中的观测计数推导灵敏度$Se$和特异度$Sp$的表达式。然后，利用全概率定律和贝叶斯定理，推导阳性预测值$PPV = P(\\text{disease} \\mid \\text{test positive})$和阴性预测值$NPV = P(\\text{no disease} \\mid \\text{test negative})$关于$P$、$Se$和$Sp$的解析表达式。最后，计算所述试验和筛查情境下$Se$、$Sp$、$PPV$和$NPV$的数值，将每个值表示为小数（而非百分比），并将所有四个量四舍五入到四位有效数字。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 确诊感染（患病）人数：$N_D = 180$。\n- 检测结果为阳性的感染者人数（真阳性，$TP$）：$168$。\n- 确诊未感染（未患病）人数：$N_{\\bar{D}} = 220$。\n- 检测结果为阴性的未感染者人数（真阴性，$TN$）：$198$。\n- 社区筛查项目中的感染患病率：$P = P(\\text{disease}) = 0.15$。\n- 灵敏度定义：$Se = P(\\text{test positive} \\mid \\text{disease})$。\n- 特异度定义：$Sp = P(\\text{test negative} \\mid \\text{no disease})$。\n- 阳性预测值定义：$PPV = P(\\text{disease} \\mid \\text{test positive})$。\n- 阴性预测值定义：$NPV = P(\\text{no disease} \\mid \\text{test negative})$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，采用了流行病学和生物统计学中普遍接受的标准原理（灵敏度、特异度、预测值、贝叶斯定理）。验证诊断试验的场景是医学科学中一项常规且基础的任务。问题提法严谨，为推导和计算提供了所有必要数据。数据内部一致（例如，$168 \\leq 180$ 且 $198 \\leq 220$）。语言客观，术语定义明确。问题完整且无矛盾。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n设$D$为个体患病的事件，$\\bar{D}$为个体未患病的事件。设$T^+$为检测结果为阳性的事件，$T^-$为检测结果为阴性的事件。\n\n问题需要一个三部分的解答：\n1.  根据验证队列数据推导灵敏度（$Se$）和特异度（$Sp$）的表达式。\n2.  推导阳性预测值（$PPV$）和阴性预测值（$NPV$）关于患病率（$P$）、$Se$和$Sp$的解析表达式。\n3.  计算$Se$、$Sp$、$PPV$和$NPV$的数值。\n\n**第1部分：灵敏度（$Se$）和特异度（$Sp$）的推导**\n\n根据验证队列数据，我们可以定义真阳性（$TP$）、真阴性（$TN$）、假阳性（$FP$）和假阴性（$FN$）的计数。\n- 真阳性（$TP$）：检测结果为阳性的患病者人数。已知$TP = 168$。\n- 假阴性（$FN$）：检测结果为阴性的患病者人数。这是患病者总数减去真阳性人数。$FN = N_D - TP = 180 - 168 = 12$。\n- 真阴性（$TN$）：检测结果为阴性的非患病者人数。已知$TN = 198$。\n- 假阳性（$FP$）：检测结果为阳性的非患病者人数。这是非患病者总数减去真阴性人数。$FP = N_{\\bar{D}} - TN = 220 - 198 = 22$。\n\n灵敏度$Se$是在患病条件下检测结果为阳性的条件概率，即$P(T^+ \\mid D)$。这个概率通过验证数据中检测结果为阳性的患病者比例来估计。\n$$Se = \\frac{\\text{真阳性人数}}{\\text{患病总人数}} = \\frac{TP}{TP + FN}$$\n特异度$Sp$是在未患病条件下检测结果为阴性的条件概率，即$P(T^- \\mid \\bar{D})$。这通过验证数据中检测结果为阴性的非患病者比例来估计。\n$$Sp = \\frac{\\text{真阴性人数}}{\\text{未患病总人数}} = \\frac{TN}{TN + FP}$$\n这些就是用观测计数表示的所需表达式。\n\n**第2部分：阳性预测值（$PPV$）和阴性预测值（$NPV$）的推导**\n\n阳性预测值$PPV = P(D \\mid T^+)$是在检测结果为阳性的条件下患病的条件概率。我们使用贝叶斯定理来推导其表达式：\n$$PPV = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)}$$\n项$P(D)$是患病率，给定为$P$。项$P(T^+ \\mid D)$是灵敏度$Se$。分母$P(T^+)$是检测结果为阳性的边缘概率，可以使用全概率定律展开：\n$$P(T^+) = P(T^+ \\mid D)P(D) + P(T^+ \\mid \\bar{D})P(\\bar{D})$$\n我们有$P(D) = P$和$P(\\bar{D}) = 1 - P$。我们知道$P(T^+ \\mid D) = Se$。项$P(T^+ \\mid \\bar{D})$是假阳性率，它与特异度的关系为$P(T^+ \\mid \\bar{D}) = 1 - P(T^- \\mid \\bar{D}) = 1 - Sp$。\n将这些代入$P(T^+)$的展开式中：\n$$P(T^+) = (Se)(P) + (1 - Sp)(1 - P)$$\n将此代回$PPV$的表达式中：\n$$PPV = \\frac{Se \\cdot P}{Se \\cdot P + (1 - Sp)(1 - P)}$$\n阴性预测值$NPV = P(\\bar{D} \\mid T^-)$是在检测结果为阴性的条件下未患病的条件概率。使用贝叶斯定理：\n$$NPV = P(\\bar{D} \\mid T^-) = \\frac{P(T^- \\mid \\bar{D}) P(\\bar{D})}{P(T^-)}$$\n项$P(\\bar{D}) = 1 - P$。项$P(T^- \\mid \\bar{D})$是特异度$Sp$。分母$P(T^-)$是检测结果为阴性的边缘概率，使用全概率定律展开：\n$$P(T^-) = P(T^- \\mid \\bar{D})P(\\bar{D}) + P(T^- \\mid D)P(D)$$\n项$P(T^- \\mid D)$是假阴性率，它与灵敏度的关系为$P(T^- \\mid D) = 1 - P(T^+ \\mid D) = 1 - Se$。\n将这些代入$P(T^-)$的展开式中：\n$$P(T^-) = (Sp)(1 - P) + (1 - Se)(P)$$\n将此代回$NPV$的表达式中：\n$$NPV = \\frac{Sp \\cdot (1 - P)}{Sp \\cdot (1 - P) + (1 - Se)P}$$\n\n**第3部分：数值计算**\n\n首先，我们根据验证队列数据计算$Se$和$Sp$的值。\n$$Se = \\frac{168}{180} = \\frac{14}{15} \\approx 0.933333...$$\n四舍五入到四位有效数字，$Se = 0.9333$。\n$$Sp = \\frac{198}{220} = \\frac{9}{10} = 0.9$$\n表示为四位有效数字，$Sp = 0.9000$。\n\n接下来，我们计算社区筛查项目的$PPV$和$NPV$，其中患病率为$P = 0.15$。因此，$1 - P = 0.85$。\n使用推导出的公式以及计算出的$Se$和$Sp$值：\n对于$PPV$，我们使用$Se = \\frac{14}{15}$和$Sp = \\frac{9}{10}$：\n$$PPV = \\frac{(\\frac{14}{15}) \\cdot 0.15}{(\\frac{14}{15}) \\cdot 0.15 + (1 - \\frac{9}{10})(1 - 0.15)} = \\frac{\\frac{14}{15} \\cdot \\frac{15}{100}}{\\frac{14}{15} \\cdot \\frac{15}{100} + (\\frac{1}{10})(0.85)} = \\frac{\\frac{14}{100}}{\\frac{14}{100} + \\frac{8.5}{100}} = \\frac{0.14}{0.14 + 0.085} = \\frac{0.140}{0.225}$$\n$$PPV = \\frac{140}{225} = \\frac{28}{45} \\approx 0.622222...$$\n四舍五入到四位有效数字，$PPV = 0.6222$。\n\n对于$NPV$，我们使用$Se = \\frac{14}{15}$和$Sp = \\frac{9}{10}$：\n$$NPV = \\frac{\\frac{9}{10} \\cdot (1 - 0.15)}{\\frac{9}{10} \\cdot (1 - 0.15) + (1 - \\frac{14}{15}) \\cdot 0.15} = \\frac{0.9 \\cdot 0.85}{0.9 \\cdot 0.85 + (\\frac{1}{15})(0.15)} = \\frac{0.765}{0.765 + (\\frac{1}{15}) \\frac{15}{100}} = \\frac{0.765}{0.765 + \\frac{1}{100}}$$\n$$NPV = \\frac{0.765}{0.765 + 0.01} = \\frac{0.765}{0.775} = \\frac{765}{775} = \\frac{153}{155} \\approx 0.987096...$$\n四舍五入到四位有效数字，$NPV = 0.9871$。\n\n计算出的四个数值是：\n- 灵敏度（$Se$）：$0.9333$\n- 特异度（$Sp$）：$0.9000$\n- 阳性预测值（$PPV$）：$0.6222$\n- 阴性预测值（$NPV$）：$0.9871$\n这些值在最终答案中以行矩阵的形式按（$Se$、$Sp$、$PPV$、$NPV$）的顺序呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9333  0.9000  0.6222  0.9871\n\\end{pmatrix}\n}\n$$", "id": "4666923"}]}