{"hands_on_practices": [{"introduction": "虽然灵敏度（sensitivity）和特异度（specificity）描述了一项检测技术的内在准确性，但其临床价值通常更好地由预测价值来体现。本练习旨在提供一项基础实践，即根据检测的性能特征和特定人群中的疾病患病率（prevalence），来计算阳性预测值（PPV）和阴性预测值（NPV）。通过此练习，您将学会如何为患者的诊疗解释这些关键指标 [@problem_id:4954900]。", "problem": "一家社区诊所正在考虑采用一种新的筛查检测方法来筛查一种慢性病。在该诊所的目标人群中，该疾病的患病率估计为 $0.03$。在验证性研究中，该检测方法显示出灵敏度为 $0.92$，特异度为 $0.95$。仅使用概率论的核心定义（包括条件概率和全概率公式）以及流行病学中关于灵敏度、特异度和患病率的定义，推导出阳性预测值（PPV）和阴性预测值（NPV）关于灵敏度、特异度和患病率的表达式。然后，计算该诊所情况下PPV和NPV的数值。将PPV和NPV均表示为 $0$ 和 $1$ 之间的小数。将每个值四舍五入至三位有效数字。最后，为每个值提供一句临床解释，说明它在该情景下对患者的检测结果意味着什么。按 $\\text{PPV}$、$\\text{NPV}$ 的顺序报告您的最终数值答案。", "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它提供了生物统计学和流行病学中的一个标准任务，可以使用概率论的基本原理解答。\n\n我们定义以下事件：\n- $D$：从人群中随机选择的个体患有该慢性病的事件。\n- $D^c$：该个体未患该病的事件。\n- $T^+$：个体检测结果为阳性的事件。\n- $T^-$：个体检测结果为阴性的事件。\n\n问题陈述中提供的信息可以转化为概率术语。\n疾病的患病率，记为 $P$，是患有该疾病的先验概率：\n$$P(D) = P = 0.03$$\n因此，未患该病的概率是：\n$$P(D^c) = 1 - P(D) = 1 - 0.03 = 0.97$$\n\n检测的灵敏度，记为 $S_n$，是在个体患有该疾病的条件下，检测结果为阳性的条件概率：\n$$S_n = P(T^+ | D) = 0.92$$\n\n检测的特异度，记为 $S_p$，是在个体未患该疾病的条件下，检测结果为阴性的条件概率：\n$$S_p = P(T^- | D^c) = 0.95$$\n\n问题要求计算阳性预测值（PPV）和阴性预测值（NPV）。\n\nPPV 是在检测结果为阳性的条件下，个体患有该疾病的条件概率，即 $P(D | T^+)$。\nNPV 是在检测结果为阴性的条件下，个体未患该疾病的条件概率，即 $P(D^c | T^-)$。\n\n首先，我们推导 PPV 的表达式。使用条件概率的定义（这也是贝叶斯定理的基础）：\n$$\\text{PPV} = P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)}$$\n分子可以再次使用条件概率的定义重写：$P(D \\cap T^+) = P(T^+ | D)P(D)$。\n分母 $P(T^+)$ 可以使用全概率公式展开：\n$$P(T^+) = P(T^+ | D)P(D) + P(T^+ | D^c)P(D^c)$$\n我们知道 $P(T^+ | D) = S_n$ 且 $P(D) = P$。项 $P(T^+ | D^c)$ 是假阳性的概率。它与特异度 $S_p = P(T^- | D^c)$ 相关。由于对于一个未患病的人，检测结果要么是阳性，要么是阴性，所以 $P(T^+ | D^c) + P(T^- | D^c) = 1$。因此，$P(T^+ | D^c) = 1 - S_p$。\n将这些代入 $P(T^+)$ 的表达式中：\n$$P(T^+) = S_n \\cdot P + (1 - S_p) \\cdot (1 - P)$$\n现在，将所有部分代回 PPV 的公式中：\n$$\\text{PPV} = \\frac{P(T^+ | D)P(D)}{P(T^+ | D)P(D) + P(T^+ | D^c)P(D^c)} = \\frac{S_n \\cdot P}{S_n \\cdot P + (1 - S_p) \\cdot (1 - P)}$$\n这就是 PPV 关于灵敏度、特异度和患病率的通用表达式。\n\n接下来，我们推导 NPV 的表达式。遵循类似的步骤：\n$$\\text{NPV} = P(D^c | T^-) = \\frac{P(D^c \\cap T^-)}{P(T^-)}$$\n分子是 $P(D^c \\cap T^-) = P(T^- | D^c)P(D^c)$。\n分母 $P(T^-)$ 可通过全概率公式求得：\n$$P(T^-) = P(T^- | D)P(D) + P(T^- | D^c)P(D^c)$$\n我们知道 $P(T^- | D^c) = S_p$ 且 $P(D^c) = 1-P$。项 $P(T^- | D)$ 是假阴性的概率。它与灵敏度 $S_n = P(T^+ | D)$ 相关。由于对于一个患病的人，检测结果要么是阳性，要么是阴性，所以 $P(T^+ | D) + P(T^- | D) = 1$。因此，$P(T^- | D) = 1 - S_n$。\n将这些代入 $P(T^-)$ 的表达式中：\n$$P(T^-) = (1 - S_n) \\cdot P + S_p \\cdot (1 - P)$$\n现在，将所有部分代回 NPV 的公式中：\n$$\\text{NPV} = \\frac{P(T^- | D^c)P(D^c)}{P(T^- | D)P(D) + P(T^- | D^c)P(D^c)} = \\frac{S_p \\cdot (1 - P)}{(1 - S_n) \\cdot P + S_p \\cdot (1 - P)}$$\n这就是 NPV 的通用表达式。\n\n现在我们使用给定的数据计算数值：$P = 0.03$，$S_n = 0.92$，$S_p = 0.95$。\n\n对于 PPV：\n$$\\text{PPV} = \\frac{0.92 \\cdot 0.03}{0.92 \\cdot 0.03 + (1 - 0.95) \\cdot (1 - 0.03)} = \\frac{0.0276}{0.0276 + 0.05 \\cdot 0.97} = \\frac{0.0276}{0.0276 + 0.0485} = \\frac{0.0276}{0.0761} \\approx 0.362679$$\n四舍五入到三位有效数字，我们得到 $\\text{PPV} \\approx 0.363$。\n\n对于 NPV：\n$$\\text{NPV} = \\frac{0.95 \\cdot (1 - 0.03)}{(1 - 0.92) \\cdot 0.03 + 0.95 \\cdot (1 - 0.03)} = \\frac{0.95 \\cdot 0.97}{0.08 \\cdot 0.03 + 0.95 \\cdot 0.97} = \\frac{0.9215}{0.0024 + 0.9215} = \\frac{0.9215}{0.9239} \\approx 0.997402$$\n四舍五入到三位有效数字，我们得到 $\\text{NPV} \\approx 0.997$。\n\n最后，我们为这些值提供单句的临床解释。\n\nPPV 临床解释：对于来自该人群且检测结果为阳性的患者，他们实际患有该慢性病的概率为 $36.3\\%$。\n\nNPV 临床解释：对于来自该人群且检测结果为阴性的患者，他们确实未患该慢性病的概率为 $99.7\\%$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.363  0.997 \\end{pmatrix}}$$", "id": "4954900"}, {"introduction": "一个常见的误解是，一项“好”的检测在所有情况下都表现良好。本练习将展示疾病患病率对检测预测能力的关键影响，即使其灵敏度和特异度很高且保持不变。通过计算阳性预测值（PPV）在高患病率和低患病率情境下的变化，您将更深刻地理解为何必须审慎地应用筛查检测 [@problem_id:4954872]。", "problem": "一家医院正在考虑采用一种新的疾病诊断测试。该测试的内在准确性特征很高且固定：灵敏度为 $0.95$，特异度为 $0.95$。设疾病患病率用 $\\pi$ 表示，其定义为从目标人群中随机选择一名患者患有该疾病的先验概率。阳性预测值（PPV）定义为在测试结果为阳性的情况下，患者患有该疾病的后验概率。\n\n仅使用核心概率定义和贝叶斯定理（不使用任何预先推导的诊断测试快捷公式），推导出 $PPV$ 关于灵敏度、特异度和 $\\pi$ 的表达式，并计算比率\n$$R=\\frac{PPV\\text{ at } \\pi=0.01}{PPV\\text{ at } \\pi=0.50}.$$\n这个比率量化了即使在灵敏度和特异度保持高且固定的情况下，当患病率下降时，阳性预测值下降的程度。\n\n将 $R$ 的最终结果表示为四舍五入到四位有效数字的小数。不要使用百分号。", "solution": "首先验证问题的科学合理性、自洽性和良构性。\n\n**步骤1：提取已知条件**\n- 灵敏度，记为 $s$，是在患有疾病的情况下测试结果为阳性的概率：$s = 0.95$。\n- 特异度，记为 $c$，是在未患疾病的情况下测试结果为阴性的概率：$c = 0.95$。\n- 疾病患病率，记为 $\\pi$，是患病的先验概率。\n- 阳性预测值，$PPV$，是在测试结果为阳性的情况下患病的后验概率。\n- 任务是使用贝叶斯定理推导出 $PPV$ 关于 $s$、$c$ 和 $\\pi$ 的表达式。\n- 第二个任务是计算比率 $R = \\frac{PPV\\text{ at } \\pi=0.01}{PPV\\text{ at } \\pi=0.50}$。\n- $R$ 的最终结果必须是四舍五入到四位有效数字的小数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 问题使用了流行病学和生物统计学中的标准基础概念（灵敏度、特异度、患病率、PPV、贝叶斯定理）。所提供的值对于高性能诊断测试是现实的。该问题具有科学合理性。\n- **良构性：** 提供了所有必要信息。定义清晰且标准。期望的输出（一个公式和一个数值比率）被明确指定。存在唯一解。\n- **客观性：** 问题以精确、客观的数学语言陈述。\n- **结论：** 问题有效。\n\n**步骤3：判定与行动**\n问题被判定为有效。将提供完整解答。\n\n**PPV的推导**\n设 $D$ 为随机选择的患者患有该疾病的事件， $D^c$ 为患者未患该疾病的事件。设 $T$ 为测试结果为阳性的事件， $T^c$ 为测试结果为阴性的事件。\n\n给定的量可以表示为条件概率：\n- 患病率：$P(D) = \\pi$。因此，未患病的概率为 $P(D^c) = 1 - P(D) = 1 - \\pi$。\n- 灵敏度：$P(T|D) = s = 0.95$。\n- 特异度：$P(T^c|D^c) = c = 0.95$。\n\n根据特异度的定义，我们可以求出假阳性概率，即在患者未患病的情况下测试结果为阳性的概率：\n$$P(T|D^c) = 1 - P(T^c|D^c) = 1 - c = 1 - 0.95 = 0.05$$\n\n阳性预测值（$PPV$）是在测试结果为阳性的情况下患者患有该疾病的概率，即 $P(D|T)$。\n\n根据贝叶斯定理，这表示为：\n$$PPV = P(D|T) = \\frac{P(T|D)P(D)}{P(T)}$$\n\n分母 $P(T)$ 是测试结果为阳性的总概率。可以使用全概率公式，通过对疾病状态进行边缘化来求得：\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\n\n将我们已知条件的符号表示代入此 $P(T)$ 的表达式中：\n$$P(T) = s \\cdot \\pi + (1 - c) \\cdot (1 - \\pi)$$\n\n现在，我们将这个展开的 $P(T)$ 形式代回贝叶斯定理的 $PPV$ 表达式中：\n$$PPV(\\pi) = \\frac{s \\cdot \\pi}{s \\cdot \\pi + (1 - c) \\cdot (1 - \\pi)}$$\n这是 $PPV$ 关于灵敏度（$s$）、特异度（$c$）和患病率（$\\pi$）的通用表达式。\n\n**比率 R 的计算**\n我们已知 $s = 0.95$ 和 $c = 0.95$。将这些值代入推导出的公式中：\n$$PPV(\\pi) = \\frac{0.95 \\cdot \\pi}{0.95 \\cdot \\pi + (1 - 0.95) \\cdot (1 - \\pi)} = \\frac{0.95\\pi}{0.95\\pi + 0.05(1 - \\pi)}$$\n\n首先，我们计算患病率为 $\\pi_1 = 0.01$ 时的 $PPV$。\n$$PPV(\\pi=0.01) = \\frac{0.95 \\times 0.01}{0.95 \\times 0.01 + 0.05 \\times (1 - 0.01)}$$\n$$PPV(\\pi=0.01) = \\frac{0.0095}{0.0095 + 0.05 \\times 0.99}$$\n$$PPV(\\pi=0.01) = \\frac{0.0095}{0.0095 + 0.0495} = \\frac{0.0095}{0.059}$$\n\n接下来，我们计算患病率为 $\\pi_2 = 0.50$ 时的 $PPV$。\n$$PPV(\\pi=0.50) = \\frac{0.95 \\times 0.50}{0.95 \\times 0.50 + 0.05 \\times (1 - 0.50)}$$\n$$PPV(\\pi=0.50) = \\frac{0.475}{0.475 + 0.05 \\times 0.50}$$\n$$PPV(\\pi=0.50) = \\frac{0.475}{0.475 + 0.025} = \\frac{0.475}{0.500} = 0.95$$\n\n最后，我们计算比率 $R$：\n$$R = \\frac{PPV(\\pi=0.01)}{PPV(\\pi=0.50)} = \\frac{\\frac{0.0095}{0.059}}{0.95}$$\n$$R = \\frac{0.0095}{0.059 \\times 0.95} = \\frac{0.0095}{0.05605}$$\n$$R \\approx 0.1694915254237$$\n\n按要求将结果四舍五入到四位有效数字：\n$$R \\approx 0.1695$$\n这个结果表明，尽管该测试具有很高的内在准确性（灵敏度和特异度均为$95\\%$），但在筛查低患病率人群时，其阳性结果的预测值与高患病率人群相比显著下降。在$1\\%$患病率下的$PPV$仅为$50\\%$患病率下$PPV$的约$17\\%$。", "answer": "$$\\boxed{0.1695}$$", "id": "4954872"}, {"introduction": "如果研究人群不能代表真实的临床环境，那么所报告的诊断检测性能可能会产生误导，这种现象被称为“谱系偏倚”（spectrum bias）。本练习模拟了两种不同的验证研究设计，用以量化将患者选择范围限制在重症病例中，会如何人为地抬高灵敏度并改变特异度。理解这种偏倚对于批判性地评估已发表的诊断检测证据至关重要 [@problem_id:4954827]。", "problem": "一家医院正在评估一种用于呼吸道感染的新型即时诊断检测。该检测产生二元结果（阳性与阴性）。为了探究病例组合如何影响表观性能，我们考虑以下在临床上合理的分层方法：对真正患病的患者按疾病严重程度分层，对真正未患病的患者按临床表现分层。\n\n在真正患病的患者中：轻症病例（$200$ 名患者：$110$ 名阳性，$90$ 名阴性），中症病例（$150$ 名患者：$120$ 名阳性，$30$ 名阴性），以及重症病例（$100$ 名患者：$95$ 名阳性，$5$ 名阴性）。\n\n在真正未患病的患者中：社区健康对照组（$250$ 名患者：$5$ 名阳性，$245$ 名阴性）和有症状的疾病模拟患者（$200$ 名患者：$60$ 名阳性，$140$ 名阴性）。\n\n考虑两种验证设计：\n\n- 全谱评估：包括所有三个患病分层和两个非患病分层。\n- 限制谱评估：仅招募重症患病病例和有症状的疾病模拟非患病患者。\n\n仅使用灵敏度和特异度的核心定义（即，灵敏度是在真正患病的情况下检测结果为阳性的概率，特异度是在未患病的情况下检测结果为阴性的概率），完成以下任务：\n\n1. 计算全谱评估下的灵敏度和特异度。\n2. 计算限制谱评估下的灵敏度和特异度。\n3. 将净谱系偏倚大小定义为\n$$\nB \\equiv \\left(\\text{sensitivity}_{\\text{restricted}} - \\text{sensitivity}_{\\text{full}}\\right) + \\left(\\text{specificity}_{\\text{full}} - \\text{specificity}_{\\text{restricted}}\\right).\n$$\n计算 $B$。\n\n将 $B$ 的最终答案四舍五入到 $4$ 位有效数字，并以纯数（无单位）表示。", "solution": "首先根据所需标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- **真正患病患者数据：**\n  - 轻症病例：$200$ 名患者（$110$ 名阳性，$90$ 名阴性）。\n  - 中症病例：$150$ 名患者（$120$ 名阳性，$30$ 名阴性）。\n  - 重症病例：$100$ 名患者（$95$ 名阳性，$5$ 名阴性）。\n- **真正未患病患者数据：**\n  - 社区健康对照组：$250$ 名患者（$5$ 名阳性，$245$ 名阴性）。\n  - 有症状的疾病模拟患者：$200$ 名患者（$60$ 名阳性，$140$ 名阴性）。\n- **验证设计：**\n  - 全谱评估：包括所有三个患病分层和两个非患病分层。\n  - 限制谱评估：仅包括重症患病病例和有症状的疾病模拟非患病患者。\n- **定义：**\n  - 灵敏度：在真正患病的情况下检测结果为阳性的概率，$P(T^+|D)$。\n  - 特异度：在未患病的情况下检测结果为阴性的概率，$P(T^-|D^c)$。\n- **计算公式：**\n  - 净谱系偏倚大小：$B \\equiv (\\text{sensitivity}_{\\text{restricted}} - \\text{sensitivity}_{\\text{full}}) + (\\text{specificity}_{\\text{full}} - \\text{specificity}_{\\text{restricted}})$。\n- **要求输出：**\n  - 计算 $B$，四舍五入到 $4$ 位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于评估诊断检测的生物统计学和流行病学的基本原则。灵敏度、特异度和谱系偏倚的概念是标准且明确定义的。\n- **表述清晰：** 该问题提供了执行所需计算的所有必要数据和清晰定义。存在唯一、稳定且有意义的解。\n- **客观性：** 该问题以精确、客观的语言陈述。数据虽然是假设的，但在临床上是合理的。\n- **内部一致性：** 每个分层中阳性和阴性结果的数量之和等于患者总数（例如，对于轻症病例，$110 + 90 = 200$）。设置没有矛盾之处。\n\n**步骤3：结论和行动**\n- 该问题有效，因为它科学合理、表述清晰、客观且内部一致。可以开始求解过程。\n\n**求解推导**\n\n灵敏度和特异度的核心定义基于真阳性（$TP$）、真阴性（$TN$）、假阴性（$FN$）和假阳性（$FP$）的数量。令 $D$ 表示患病事件，$D^c$ 表示未患病事件。令 $T^+$ 和 $T^-$ 分别表示阳性和阴性检测结果。\n灵敏度定义为 $P(T^+|D) = \\frac{\\text{真阳性数}}{\\text{患病个体总数}}$。\n特异度定义为 $P(T^-|D^c) = \\frac{\\text{真阴性数}}{\\text{未患病个体总数}}$。\n\n**1. 全谱评估**\n对于此评估，我们考虑所有患者分层。\n\n真正患病患者的总数是轻症、中症和重症分层中患者数量的总和：\n$$N_D = 200 + 150 + 100 = 450$$\n真阳性（$TP_{full}$）的总数是这些分层中阳性结果的总和：\n$$TP_{full} = 110 + 120 + 95 = 325$$\n因此，全谱评估的灵敏度为：\n$$\\text{sensitivity}_{\\text{full}} = \\frac{TP_{full}}{N_D} = \\frac{325}{450}$$\n\n真正未患病患者的总数是健康对照组和疾病模拟分层中患者数量的总和：\n$$N_{D^c} = 250 + 200 = 450$$\n真阴性（$TN_{full}$）的总数是这些分层中阴性结果的总和：\n$$TN_{full} = 245 + 140 = 385$$\n因此，全谱评估的特异度为：\n$$\\text{specificity}_{\\text{full}} = \\frac{TN_{full}}{N_{D^c}} = \\frac{385}{450}$$\n\n**2. 限制谱评估**\n对于此评估，我们仅考虑重症患病病例和有症状的疾病模拟非患病患者。\n\n真正患病患者的数量是重症病例的数量：\n$$N'_D = 100$$\n真阳性（$TP_{restr}$）的数量是重症分层中阳性结果的数量：\n$$TP_{restr} = 95$$\n限制谱评估的灵敏度为：\n$$\\text{sensitivity}_{\\text{restr}} = \\frac{TP_{restr}}{N'_D} = \\frac{95}{100}$$\n\n真正未患病患者的数量是有症状的疾病模拟患者的数量：\n$$N'_{D^c} = 200$$\n真阴性（$TN_{restr}$）的数量是此分层中阴性结果的数量：\n$$TN_{restr} = 140$$\n限制谱评估的特异度为：\n$$\\text{specificity}_{\\text{restr}} = \\frac{TN_{restr}}{N'_{D^c}} = \\frac{140}{200}$$\n\n**3. 净谱系偏倚大小 ($B$)**\n净谱系偏倚大小 $B$ 定义为：\n$$B = (\\text{sensitivity}_{\\text{restr}} - \\text{sensitivity}_{\\text{full}}) + (\\text{specificity}_{\\text{full}} - \\text{specificity}_{\\text{restr}})$$\n代入推导出的分数值：\n$$B = \\left(\\frac{95}{100} - \\frac{325}{450}\\right) + \\left(\\frac{385}{450} - \\frac{140}{200}\\right)$$\n我们简化这些分数：\n$\\frac{95}{100} = \\frac{19}{20}$\n$\\frac{325}{450} = \\frac{65}{90} = \\frac{13}{18}$\n$\\frac{385}{450} = \\frac{77}{90}$\n$\\frac{140}{200} = \\frac{14}{20} = \\frac{7}{10}$\n\n将这些简化的分数代入 $B$ 的表达式中：\n$$B = \\left(\\frac{19}{20} - \\frac{13}{18}\\right) + \\left(\\frac{77}{90} - \\frac{7}{10}\\right)$$\n为了计算第一项，我们找到公分母 $180$：\n$$\\frac{19}{20} - \\frac{13}{18} = \\frac{19 \\times 9}{180} - \\frac{13 \\times 10}{180} = \\frac{171 - 130}{180} = \\frac{41}{180}$$\n为了计算第二项，我们找到公分母 $90$：\n$$\\frac{77}{90} - \\frac{7}{10} = \\frac{77}{90} - \\frac{7 \\times 9}{90} = \\frac{77 - 63}{90} = \\frac{14}{90} = \\frac{7}{45}$$\n现在，我们将这两项相加：\n$$B = \\frac{41}{180} + \\frac{7}{45}$$\n使用公分母 $180$：\n$$B = \\frac{41}{180} + \\frac{7 \\times 4}{180} = \\frac{41 + 28}{180} = \\frac{69}{180}$$\n通过将分子和分母除以 $3$ 来简化最终的分数：\n$$B = \\frac{23}{60}$$\n为了获得数值，我们进行除法运算：\n$$B = \\frac{23}{60} = 0.383333...$$\n四舍五入到 $4$ 位有效数字，我们得到 $0.3833$。", "answer": "$$\\boxed{0.3833}$$", "id": "4954827"}]}