{"hands_on_practices": [{"introduction": "突触传递的核心是“量子”释放，即神经递质以离散的数据包（量子）形式释放。突触的强度可以通过“量子内容”（$m$）来量化，它代表单次动作电位平均释放的量子数量。这个值由两个关键参数决定：准备好释放的囊泡数量（$N$）和每个囊泡的释放概率（$p$）。本练习 [@problem_id:4764374] 将通过一个模拟神经毒素影响的场景，帮助你直接计算改变这些参数之一（在此例中是$N$）如何影响突触的输出，从而巩固你对量子释放基本模型（$m = Np$）的理解。", "problem": "研究一个人类前额叶皮层中的谷氨酸能突触。该突触因其在情绪和认知调节中的作用而与临床精神病学相关。研究在低频刺激条件下进行，此时单个动作电位期间的囊泡耗竭可忽略不计。在静息状态下，突触前末梢含有一个由$10$个停靠的突触囊泡组成的易释放池。当一个动作电位到达时，每个停靠的囊泡都进行独立的释放尝试，释放概率为$0.3$。一种损害可溶性NSF附着蛋白受体（SNARE）复合物组装的突触前神经毒素，选择性地使停靠囊泡的数量减少$50\\%$，但不会改变钙离子内流、每个囊泡的内在释放概率或突触后受体的敏感性。\n\n从突触传递的量子假说和独立囊泡释放事件的二项模型出发，推导毒素暴露前后的预期诱发量子含量，并计算单个动作电位下预期诱发量子含量的绝对减少量（基线值减去毒素作用后值）。将最终答案表示为一个纯数（无量纲）。不要四舍五入，给出精确值。", "solution": "首先对问题的科学合理性、自我一致性和清晰性进行验证。\n\n**步骤1：提取已知条件**\n- 模型：突触传递的量子假说，独立囊泡释放的二项模型。\n- 系统：人前额叶皮层中的一个谷氨酸能突触。\n- 条件：低频刺激，每次动作电位的囊泡耗竭可忽略不计。\n- 基线（毒素前）参数：\n  - 易释放池中的停靠突触囊泡数量，$N_{pre}$: $10$。\n  - 每个囊泡的释放概率，$p$: $0.3$。\n- 毒素效应：\n  - 使停靠囊泡的数量减少$50\\%$。\n  - 未改变的参数：钙离子内流、每个囊泡的内在释放概率（$p$）、突触后受体敏感性。\n- 任务：\n  1. 推导毒素暴露前的预期诱发量子含量。\n  2. 推导毒素暴露后的预期诱发量子含量。\n  3. 计算预期诱发量子含量的绝对减少量。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题坚实地基于神经递质释放的量子假说和二项模型，这些是突触生理学中基础且公认的原理。诸如易释放池大小为$N=10$和释放概率为$p=0.3$的参数，对于中枢突触而言在生理上是现实的。所描述的神经毒素作用——通过损害SNARE复合物组装来减少停靠囊泡的数量——是诸如肉毒杆菌神经毒素和破伤风神经毒素等毒素的已知作用机制。\n- **问题适定性：** 该问题提供了求解所需量所需的所有必要信息。初始条件（$N_{pre}$，$p$）、毒素引起的具体变化（$N$减少$50\\%$）以及需要计算的量都得到了明确定义。使用二项模型为求解提供了直接且明确的数学路径。\n- **客观性：** 该问题以精确、定量和无偏见的语言陈述，不含主观或基于观点的断言。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它具有科学合理性、适定性和客观性。将根据所提供的信息推导解答。\n\n**求解推导**\n\n量子假说认为，神经递质从突触前末梢的释放是以离散的包（即量子）的形式发生的，每个量子对应于单个突触囊泡的内容物。单个动作电位释放的量子数量是一个概率过程。\n\n问题指明该过程遵循二项模型。设随机变量$k$表示单个动作电位下释放的囊泡数量。该变量服从二项分布，$k \\sim B(N, p)$，其中$N$是易释放池中囊泡的总数（独立试验的次数），$p$是任何单个囊泡的释放概率（每次试验成功的概率）。\n\n预期诱发量子含量，记为$m$，是随机变量$k$的期望值（均值）。对于二项分布$B(N, p)$，其期望值由试验次数和成功概率的乘积给出：\n$$m = E[k] = N \\times p$$\n\n首先，我们计算施加神经毒素前的预期量子含量，记为$m_{pre}$。\n给定的停靠囊泡数量为$N_{pre} = 10$。\n给定的释放概率为$p = 0.3$。\n因此，毒素作用前的预期量子含量为：\n$$m_{pre} = N_{pre} \\times p = 10 \\times 0.3 = 3$$\n\n接着，我们计算施加神经毒素后的预期量子含量，记为$m_{post}$。\n毒素使停靠囊泡的数量减少了$50\\%$。新的囊泡数量$N_{post}$为：\n$$N_{post} = N_{pre} \\times (1 - 0.5) = 10 \\times 0.5 = 5$$\n问题指出，每个囊泡的内在释放概率$p$不受毒素影响。因此，$p$保持为$0.3$。\n毒素作用后的预期量子含量为：\n$$m_{post} = N_{post} \\times p = 5 \\times 0.3 = 1.5$$\n\n最后，我们计算预期诱发量子含量的绝对减少量$\\Delta m$。这是毒素暴露前后预期量子含量之差。\n$$\\Delta m = m_{pre} - m_{post}$$\n代入计算出的值：\n$$\\Delta m = 3 - 1.5 = 1.5$$\n\n或者，该减少量也可以根据囊泡数量的变化$\\Delta N = N_{pre} - N_{post}$直接计算。\n$$\\Delta m = (N_{pre} \\times p) - (N_{post} \\times p) = (N_{pre} - N_{post}) \\times p = \\Delta N \\times p$$\n$$\\Delta N = 10 - 5 = 5$$\n$$\\Delta m = 5 \\times 0.3 = 1.5$$\n\n预期诱发量子含量的绝对减少量为$1.5$。由于量子含量是一个无量纲的比率（每次事件释放的囊泡数），最终答案是一个纯数。", "answer": "$$\\boxed{1.5}$$", "id": "4764374"}, {"introduction": "在上一个练习中，我们将释放概率 $p$ 视为一个固定值，但在生物体内，它是一个受精密调控的动态变量。本练习 [@problem_id:4764403] 将深入探讨钙离子（$Ca^{2+}$）作为囊泡释放主要触发因素的关键作用。你将通过计算来探索释放过程的“协同性”——即多个钙离子必须协同作用才能触发释放，这导致了释放概率与钙离子浓度之间存在高度非线性的关系，使得突触对钙离子浓度的变化异常敏感。", "problem": "在哺乳动物中枢神经系统 (CNS) 的一个突触前末梢中，神经递质的释放取决于钙传感器处的局部突触前钙离子浓度。许多快速突触的实验观察表明，由于协同结合，瞬时释放概率与传感器处局部钙离子浓度的四次方成正比，因此释放概率可以建模为与 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{sensor}}^{4}$ 成正比。假设在感兴趣的范围内，局部传感器微域的钙离子浓度 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{sensor}}$ 与细胞外钙离子浓度 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}}$ 成线性关系，因为在此狭窄范围内，突触前电压门控钙通道的电导和开放概率保持不变，且驱动力变化极小。考虑 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}}$ 从 $1~\\mathrm{mM}$ 变为 $2~\\mathrm{mM}$。\n\n使用所述的依赖关系和定义，计算释放概率的相对变化，其定义为分数变化\n$$\\frac{p_{\\mathrm{new}} - p_{\\mathrm{old}}}{p_{\\mathrm{old}}},$$\n其中 $p_{\\mathrm{old}}$ 是在 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}} = 1~\\mathrm{mM}$ 时的释放概率，而 $p_{\\mathrm{new}}$ 是在 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}} = 2~\\mathrm{mM}$ 时的释放概率。将您的答案表示为一个无单位的实数。无需四舍五入。", "solution": "首先验证问题以确保其自洽、有科学依据且提法恰当。所给陈述与已建立的突触传递生物物理模型一致。释放概率 ($p$) 与钙离子浓度之间的关系 $p \\propto [\\mathrm{Ca}^{2+}]^n$（其中 $n \\approx 4$）是一个经典的发现。对于所述条件，假设细胞外和局部细胞内钙离子浓度之间存在线性关系是一个合理的简化。该问题是完整的、客观的，并允许有唯一解。因此，该问题是有效的，我们继续进行求解。\n\n令 $p$ 表示瞬时释放概率。\n令 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{sensor}}$ 表示传感器处的局部钙离子浓度。\n令 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}}$ 表示细胞外钙离子浓度。\n\n根据问题陈述，释放概率与传感器处局部钙离子浓度的四次方成正比。这可以表示为以下正比关系：\n$$p \\propto \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{sensor}}^{4}$$\n引入一个比例常数 $k_1$，我们得到：\n$$p = k_1 \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{sensor}}^{4}$$\n\n问题还指出，传感器处的局部钙离子浓度与细胞外钙离子浓度成线性关系。这可以表示为：\n$$\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{sensor}} \\propto \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}}$$\n引入第二个比例常数 $k_2$，我们得到：\n$$\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{sensor}} = k_2 \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}}$$\n\n为了找到释放概率 $p$ 和细胞外钙离子浓度 $\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}}$ 之间的关系，我们将第二个方程代入第一个方程：\n$$p = k_1 \\left( k_2 \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}} \\right)^{4}$$\n$$p = k_1 k_2^4 \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}} \\right)^{4}$$\n令 $K = k_1 k_2^4$ 为组合后的比例常数。则该关系为：\n$$p = K \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext}} \\right)^{4}$$\n\n我们已知旧的和新的细胞外钙离子浓度：\n$$\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}} = 1~\\mathrm{mM}$$\n$$\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, new}} = 2~\\mathrm{mM}$$\n\n相应的释放概率 $p_{\\mathrm{old}}$ 和 $p_{\\mathrm{new}}$ 分别为：\n$$p_{\\mathrm{old}} = K \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}} \\right)^{4}$$\n$$p_{\\mathrm{new}} = K \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, new}} \\right)^{4}$$\n\n我们需要计算释放概率的相对变化，其定义为：\n$$\\frac{p_{\\mathrm{new}} - p_{\\mathrm{old}}}{p_{\\mathrm{old}}}$$\n代入 $p_{\\mathrm{old}}$ 和 $p_{\\mathrm{new}}$ 的表达式：\n$$\\frac{K \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, new}} \\right)^{4} - K \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}} \\right)^{4}}{K \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}} \\right)^{4}}$$\n常数 $K$ 从分子和分母中消去：\n$$\\frac{\\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, new}} \\right)^{4} - \\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}} \\right)^{4}}{\\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}} \\right)^{4}}$$\n这个表达式可以通过拆分分数来简化：\n$$\\frac{\\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, new}} \\right)^{4}}{\\left( \\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}} \\right)^{4}} - 1$$\n$$\\left( \\frac{\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, new}}}{\\left[ \\mathrm{Ca}^{2+} \\right]_{\\mathrm{ext, old}}} \\right)^{4} - 1$$\n\n现在，我们代入给定的数值：\n$$\\left( \\frac{2~\\mathrm{mM}}{1~\\mathrm{mM}} \\right)^{4} - 1$$\n浓度单位 ($\\mathrm{mM}$) 消掉了：\n$$\\left( \\frac{2}{1} \\right)^{4} - 1 = 2^4 - 1$$\n计算该值：\n$$16 - 1 = 15$$\n因此，释放概率的相对变化是 $15$。这表示增加了 $1500\\%$。", "answer": "$$\\boxed{15}$$", "id": "4764403"}, {"introduction": "在真实的神经科学研究中，我们通常无法直接知道突触的内在参数，如 $n$、$p$ 和 $q$。相反，我们能做的是测量突触传递的结果——即记录突触后电位。这个高级练习 [@problem_id:4981908] 将引导你逆向思考，展示神经生理学家如何通过分析实验数据（如平均值、方差和失败率）来推断出这些基本的量子参数。这个过程被称为“量子分析”，是理解突触功能和可塑性的强大工具，让你一窥真实科研中的数据驱动方法。", "problem": "您的任务是仅依据第一性原理，形式化并实现一个用于突触传递的量子分析估计器。考虑一个具有 $n$ 个独立突触前释放位点的突触。在每次刺激下，每个位点独立地选择释放失败或释放一个量子。任何位点的释放事件都被建模为成功概率为 $p$ 的伯努利试验。每次成功的释放都会贡献一个固定的突触后幅度 $q$。在一次试验中，观测到的突触后幅度是所有成功的量子贡献之和，加上一个与释放无关、均值为零且方差已知为 $\\sigma^2$ 的附加测量噪声。观测到零幅度的试验比例即为失败率 $f_0$。在此框架下，每次刺激释放的量子数量是在 $n$ 个位点上的成功次数，而突触后幅度是相同量子贡献加上噪声的随机和。对于每个测试用例，您将获得凭经验测量的平均幅度 $\\mu$（单位 $\\mathrm{mV}$）、测量的方差 $s^2$（单位 $\\mathrm{mV}^2$）、测量的失败率 $f_0$（小数形式）以及独立测量的噪声方差 $\\sigma^2$（单位 $\\mathrm{mV}^2$）。利用这些数据，仅使用二项独立模型以及随机和的期望与方差性质，估计与数据最一致的三元组 $(n,p,q)$。\n\n对于每个测试用例，您的程序必须输出一个估计的整数 $n$、一个以小数形式（而非百分比）表示的概率 $p$ 以及一个以 $\\mathrm{mV}$ 表示的量子大小 $q$。浮点数必须四舍五入到 $3$ 位小数。估计过程必须符合原理：从上述生成性假设中推导出关系，并选择一个整数 $n$，该 $n$ 在使用测量的失败率推断 $p$ 和使用测量的平均值推断 $q$ 时，能在预测方差和测量方差之间产生最佳的一致性。\n\n请使用以下参数集测试套件。每个测试用例提供 $(\\mu, s^2, f_0, \\sigma^2)$，其中 $\\mu$ 的单位为 $\\mathrm{mV}$，$s^2$ 和 $\\sigma^2$ 的单位为 $\\mathrm{mV}^2$：\n- 测试用例 1：$\\mu = 1.0\\,\\mathrm{mV}$，$s^2 = 0.31\\,\\mathrm{mV}^2$，$f_0 = 0.07776$，$\\sigma^2 = 0.01\\,\\mathrm{mV}^2$。\n- 测试用例 2：$\\mu = 0.18\\,\\mathrm{mV}$，$s^2 = 0.0056\\,\\mathrm{mV}^2$，$f_0 = 0.1$，$\\sigma^2 = 0.002\\,\\mathrm{mV}^2$。\n- 测试用例 3：$\\mu = 0.15\\,\\mathrm{mV}$，$s^2 = 0.04775\\,\\mathrm{mV}^2$，$f_0 = 0.5987369392$，$\\sigma^2 = 0.005\\,\\mathrm{mV}^2$。\n- 测试用例 4：$\\mu = 0.8\\,\\mathrm{mV}$，$s^2 = 0.26\\,\\mathrm{mV}^2$，$f_0 = 0.0625$，$\\sigma^2 = 0.1\\,\\mathrm{mV}^2$。\n\n为确保覆盖性而设计：该集合包括一个通用情况、一个单位点边界情况、一个高失败率机制和一个噪声主导机制。您的算法必须在合理的整数 $n$ 范围内（例如，从 $1$ 到 $50$）进行搜索，对每个候选 $n$ 使用失败率 $f_0$ 推断 $p$，对每个候选 $n$ 及其推断出的 $p$ 使用平均值 $\\mu$ 推断 $q$，然后选择能使预测方差与测量方差之间差异最小的 $n$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有测试用例的结果，聚合为一个逗号分隔的列表的列表，每个内部列表的形式为 $[n,p,q]$，其中浮点数（$p$ 和 $q$）四舍五入到 $3$ 位小数，且 $q$ 的单位默认为 $\\mathrm{mV}$。例如，您的输出必须类似 $[[n_1,p_1,q_1],[n_2,p_2,q_2],[n_3,p_3,q_3],[n_4,p_4,q_4]]$，并显示在单行上。", "solution": "从经验数据估计突触传递参数的问题，可以通过一个基于既定生物物理原理的概率模型来形式化。我们的任务是从突触后电位的测量统计数据中，估计释放位点的数量 ($n$)、释放概率 ($p$) 和量子大小 ($q$)。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **模型：** 一个具有 $n$ 个独立突触前释放位点的突触。\n- **释放动力学：** 每个位点遵循成功概率为 $p$ 的伯努利试验，以释放一个量子。\n- **量子贡献：** 每次成功的释放都会为突触后响应增加一个固定的幅度 $q$。\n- **测量模型：** 观测到的总幅度 $A$ 是量子贡献之和，加上一个独立的、附加的、均值为零且方差已知为 $\\sigma^2$ 的测量噪声 $E$。\n- **输入数据：** 对于每个测试用例，我们获得：\n    - 测量的平均幅度 $\\mu$\n    - 测量的总幅度方差 $s^2$\n    - 测量的失败率 $f_0$\n    - 独立测量的噪声方差 $\\sigma^2$\n- **估计目标：** 估计参数三元组 $(n, p, q)$。\n- **估计步骤：**\n    1. 在一个合理的整数 $n$ 值范围（指定为 $1$ 到 $50$）内进行搜索。\n    2. 对于每个候选 $n$，使用 $f_0$ 推断 $p$。\n    3. 对于每个候选 $n$ 及其推断的 $p$，使用 $\\mu$ 推断 $q$。\n    4. 对于每个三元组 $(n, p, q)$，预测突触响应的理论方差。\n    5. 选择能使预测方差与测量方差之间差异最小的 $n$ 值（及其对应的 $p$ 和 $q$）。\n\n**1.2. 对照标准进行验证**\n- **科学依据：** 该问题基于 del Castillo 和 Katz 引入的经典的神经递质释放量子模型，这是突触生理学的基石。使用二项分布对固定数量的独立位点的释放进行建模是标准做法。该问题具有科学合理性。\n- **适定性：** 该问题是适定的。它提供了足够的数据和一个清晰、确定性的程序（在指定搜索空间上最小化一个成本函数），以得到一组唯一的估计值。\n- **客观性：** 该问题使用精确、客观的数学和科学语言陈述，没有歧义或主观论断。\n\n**1.3. 结论**\n该问题是有效的。它是一个定义明确、有科学依据的估计问题，可以从第一性原理解决。\n\n### 步骤 2：推导估计框架\n\n设 $K$ 为单次刺激时释放的量子数量的随机变量。给定 $n$ 个独立的释放位点，每个位点的释放概率为 $p$，则 $K$ 服从二项分布：\n$$\nK \\sim \\text{Binomial}(n, p)\n$$\n其概率质量函数为 $P(K=k) = \\binom{n}{k} p^k (1-p)^{n-k}$，其中 $k \\in \\{0, 1, \\dots, n\\}$。\n\n突触后响应的总幅度 $A$ 是信号分量 $S$ 和噪声分量 $E$ 的和。信号分量是释放的量子数乘以量子大小，即 $S = qK$。因此，\n$$\nA = qK + E\n$$\n我们已知噪声 $E$ 的均值 $E[E] = 0$，方差 $\\text{Var}(E) = \\sigma^2$，且 $E$ 与量子释放过程 $K$ 独立。\n\n我们现在根据模型参数 $(n, p, q)$ 推导 $A$ 的各阶矩的表达式。\n\n**平均幅度 ($\\mu$)**\n观测幅度 $A$ 的期望值是测量的平均值 $\\mu$。\n$$\n\\mu = E[A] = E[qK + E]\n$$\n根据期望的线性和 $K$ 与 $E$ 的独立性：\n$$\n\\mu = qE[K] + E[E]\n$$\n二项分布 $\\text{Binomial}(n, p)$ 的均值为 $E[K] = np$。代入此式及 $E[E] = 0$：\n$$\n\\mu = qnp \\quad (1)\n$$\n\n**失败率 ($f_0$)**\n失败率 $f_0$ 是观测到零量子释放（“失败”）的概率。这对应于 $K=0$ 的情况。\n$$\nf_0 = P(K=0) = \\binom{n}{0} p^0 (1-p)^{n-0}\n$$\n$$\nf_0 = (1-p)^n \\quad (2)\n$$\n\n**幅度方差 ($s^2$)**\n观测幅度 $A$ 的方差是测量的总方差 $s^2$。\n$$\ns^2 = \\text{Var}(A) = \\text{Var}(qK + E)\n$$\n因为 $K$ 和 $E$ 是独立的随机变量，它们的和的方差等于它们各自方差的和：\n$$\ns^2 = \\text{Var}(qK) + \\text{Var}(E) = q^2\\text{Var}(K) + \\sigma^2\n$$\n二项分布 $\\text{Binomial}(n, p)$ 的方差为 $\\text{Var}(K) = np(1-p)$。代入此式，我们得到：\n$$\ns^2 = q^2 np(1-p) + \\sigma^2 \\quad (3)\n$$\n问题提供了测量的总方差 $s^2$ 和噪声方差 $\\sigma^2$。因此，仅由量子过程引起的方差分量为 $\\sigma_S^2 = s^2 - \\sigma^2$。我们的模型预测此量子方差为：\n$$\n\\sigma_{S, \\text{pred}}^2 = q^2 np(1-p)\n$$\n\n**估计算法**\n按照指令，我们构建一个算法来寻找最优的整数 $n \\in [1, 50]$。对于每个候选 $n$：\n\n1.  **估计 $p$：** 我们重排方程 (2) 来求解 $p$。\n    $$\n    p_{\\text{est}}(n) = 1 - f_0^{1/n}\n    $$\n    这对于给定的 $n$ 和 $f_0$ 唯一地确定了 $p$。\n\n2.  **估计 $q$：** 我们重排方程 (1) 并代入我们对 $p$ 的估计。\n    $$\n    q_{\\text{est}}(n) = \\frac{\\mu}{n \\cdot p_{\\text{est}}(n)} = \\frac{\\mu}{n(1 - f_0^{1/n})}\n    $$\n    这在给定 $n$ 和推断的 $p$ 的情况下，从平均幅度确定了 $q$。一个非零的平均值 $\\mu > 0$ 要求 $p>0$ 和 $q>0$，这意味着 $f_0  1$。\n\n3.  **评估拟合度：** 我们使用这些估计值 $p_{\\text{est}}(n)$ 和 $q_{\\text{est}}(n)$ 来预测量子方差，并将其与经验推导值 $\\sigma_{S, \\text{meas}}^2 = s^2 - \\sigma^2$ 进行比较。预测的量子方差是：\n    $$\n    \\sigma_{S, \\text{pred}}^2(n) = q_{\\text{est}}(n)^2 \\cdot n \\cdot p_{\\text{est}}(n) \\cdot (1 - p_{\\text{est}}(n))\n    $$\n    我们将成本函数 $C(n)$ 定义为测量的量子方差与预测的量子方差之间的平方差，并寻求将其最小化。\n    $$\n    C(n) = \\left( \\sigma_{S, \\text{pred}}^2(n) - (s^2 - \\sigma^2) \\right)^2\n    $$\n    $n$ 的最优估计值（表示为 $n^*$）是最小化此成本函数的值：\n    $$\n    n^* = \\underset{n \\in \\{1, 2, \\dots, 50\\}}{\\arg\\min} C(n)\n    $$\n    \n4.  **最终参数：** 最终的估计参数为 $(n^*, p_{\\text{est}}(n^*), q_{\\text{est}}(n^*))$。此过程将对提供的每个测试用例实施。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_quantal_params(mu, s2, f0, sigma2):\n    \"\"\"\n    Estimates the quantal parameters (n, p, q) based on measured statistics.\n\n    The function searches for the number of release sites 'n' that provides the\n    most consistent explanation of the data, based on a binomial model of release.\n\n    Args:\n        mu (float): Measured mean amplitude (mV).\n        s2 (float): Measured variance of amplitude (mV^2).\n        f0 (float): Measured failure fraction (proportion).\n        sigma2 (float): Measured noise variance (mV^2).\n\n    Returns:\n        tuple[int, float, float]: The estimated parameters (n, p, q).\n    \"\"\"\n    n_search_range = range(1, 51)\n    \n    # The variance component derived from the quantal release process.\n    measured_quantal_var = s2 - sigma2\n\n    best_n = -1\n    best_p = -1.0\n    best_q = -1.0\n    min_cost = float('inf')\n\n    for n in n_search_range:\n        # Step 1: Estimate p from the failure fraction f0.\n        # f0 = (1-p)^n  =>  p = 1 - f0^(1/n)\n        # Handle edge case where f0 is exactly 1.0 or 0.0, although not in test cases.\n        if f0 == 1.0:\n            p_est = 0.0\n        elif f0 == 0.0:\n            p_est = 1.0\n        else:\n            if n > 0 :\n                p_est = 1.0 - f0**(1.0 / n)\n            else:\n                continue\n\n        # Step 2: Estimate q from the mean amplitude mu.\n        # mu = n * p * q  =>  q = mu / (n * p)\n        denominator = n * p_est\n        if denominator == 0:\n            # If mu > 0, this is an inconsistency (infinite q).\n            # If mu = 0, q is indeterminate. We can set it to 0.\n            if mu > 0:\n                cost = float('inf')\n                q_est = float('inf')\n            else:\n                q_est = 0.0\n        else:\n            q_est = mu / denominator\n\n        # Step 3: Predict the quantal variance and calculate the cost.\n        # Predicted quantal variance = q^2 * n * p * (1-p)\n        predicted_quantal_var = q_est**2 * n * p_est * (1.0 - p_est)\n        \n        # Cost is the squared difference between predicted and measured quantal variance.\n        cost = (predicted_quantal_var - measured_quantal_var)**2\n        \n        # Step 4: Update the best parameters if the current n yields a lower cost.\n        if cost  min_cost:\n            min_cost = cost\n            best_n = n\n            best_p = p_est\n            best_q = q_est\n            \n    return best_n, best_p, best_q\n\ndef solve():\n    \"\"\"\n    Runner function to process all test cases and print the final output.\n    \"\"\"\n    # Each test case is a tuple: (mu, s^2, f0, sigma^2)\n    test_cases = [\n        # Test case 1: General case\n        (1.0, 0.31, 0.07776, 0.01),\n        # Test case 2: Single-site boundary case (n=1)\n        (0.18, 0.0056, 0.1, 0.002),\n        # Test case 3: High-failure regime (low p)\n        (0.15, 0.04775, 0.5987369392, 0.005),\n        # Test case 4: Noise-dominated regime\n        (0.8, 0.26, 0.0625, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, s2, f0, sigma2 = case\n        n, p, q = estimate_quantal_params(mu, s2, f0, sigma2)\n        \n        # Format the results as required: [n, p_rounded, q_rounded]\n        # Floats are rounded to 3 decimal places.\n        formatted_result = [n, round(p, 3), round(q, 3)]\n        results.append(formatted_result)\n\n    # The final print statement must produce a single line in the specified format.\n    # e.g., [[n1,p1,q1],[n2,p2,q2],...]\n    # Using map(str, results) and join correctly formats the list of lists.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "4981908"}]}