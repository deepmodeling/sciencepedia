{"hands_on_practices": [{"introduction": "要掌握药代动力学，我们首先必须理解药物在体内的浓度如何随时间变化。本练习将指导您从基本原理出发，推导单次静脉推注给药后，描述药物消除过程的基础方程。通过这个练习，您将掌握描述药物浓度指数衰减的核心模型，为后续更复杂的药代动力学情景打下坚实的数学基础 [@problem_id:4976395]。", "problem": "在时间 $t=0$ 时，向一位患者单次静脉（IV）推注剂量为 $D$ 的药物，该患者的身体可被模型化为一个具有恒定分布容积 $V_d$ 的单一充分混合房室。假设混合是瞬时的，$t=0$ 后无额外药物输入，且药物消除过程为线性一级消除，其消除速率常数为 $k$。仅根据以下核心定义：(i) 体内药量 $A(t)$ 与血浆浓度 $C(t)$ 的关系为 $A(t)=V_d\\,C(t)$，以及 (ii) 一级消除意味着损失速率与剩余药量成正比，请选择与这些假设一致的血浆浓度 $C(t)$ 作为时间 $t$ 的函数表达式。\n\n选择一个选项：\nA. $C(t)=\\dfrac{D}{V_d}\\,e^{-k t}$\n\nB. $C(t)=D\\,e^{-k t}$\n\nC. $C(t)=\\dfrac{D}{V_d}\\left(1-e^{-k t}\\right)$\n\nD. $C(t)=\\dfrac{D}{V_d}\\,e^{k t}$\n\nE. $C(t)=\\dfrac{D}{V_d}\\,\\dfrac{1}{1+k t}$", "solution": "首先将验证问题陈述的科学合理性、一致性和完整性。\n\n### 步骤1：提取已知条件\n-   **剂量：**单次静脉（IV）推注，剂量为 $D$。\n-   **给药时间：**$t=0$。\n-   **药代动力学模型：**单一充分混合房室。\n-   **分布容积：**恒定容积 $V_d$。\n-   **混合：**瞬时。\n-   **输入：**$t=0$ 后无额外输入。\n-   **消除过程：**线性一级消除。\n-   **消除速率常数：**$k$。\n-   **定义 (i)：**药量-浓度关系：$A(t) = V_d\\,C(t)$，其中 $A(t)$ 是体内药量，$C(t)$ 是血浆浓度。\n-   **定义 (ii)：**一级消除意味着损失速率与剩余药量成正比。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了一个经典的静脉推注给药后的单房室药代动力学模型。\n\n-   **科学依据：**该模型是药理学和药代动力学中用于描述药物在体内处置的一个基本且标准的简化模型。分布容积、一级消除以及由此产生的微分方程等概念是该领域的基石。该问题是科学合理的。\n-   **适定性：**该问题提供了一个控制原理（一级消除）、一个初始条件（$t=0$ 时推注剂量 $D$）以及求解未知函数 $C(t)$ 所需的关系。这个设定足以推导出唯一的数学解。\n-   **客观性：**所使用的术语（“单一充分混合房室”、“线性一级消除”）是标准术语，在此背景下具有精确的数学含义。问题陈述中没有主观或含糊的语言。\n\n所有验证标准均已满足。该问题不存在所列出的缺陷（例如，在简化模型的背景下，它没有矛盾、不完整或不切实际之处）。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将推导解答。\n\n### 正确表达式的推导\n\n问题要求我们找出作为时间函数的血浆浓度 $C(t)$。我们将从所提供的基本原理开始。\n\n1.  **建立微分方程：**\n    “一级消除意味着损失速率与剩余药量成正比” 这句话定义了体内药量 $A(t)$ 的变化率。“损失速率”意味着一个负的变化率。这可以表示为一个微分方程：\n    $$\n    \\frac{dA(t)}{dt} = -k A(t)\n    $$\n    其中 $k$ 是正的消除速率常数。\n\n2.  **求解微分方程：**\n    这是一个一阶线性常微分方程。可以通过分离变量法求解。\n    $$\n    \\frac{dA}{A} = -k \\, dt\n    $$\n    对两边从初始时间 $t=0$ 到稍后的时间 $t$ 进行积分：\n    $$\n    \\int_{A(0)}^{A(t)} \\frac{1}{A'} \\, dA' = \\int_{0}^{t} -k \\, d\\tau\n    $$\n    $$\n    \\left[ \\ln(A') \\right]_{A(0)}^{A(t)} = \\left[ -k\\tau \\right]_{0}^{t}\n    $$\n    $$\n    \\ln(A(t)) - \\ln(A(0)) = -kt - 0\n    $$\n    $$\n    \\ln\\left( \\frac{A(t)}{A(0)} \\right) = -kt\n    $$\n    对两边取指数，得到药量 $A(t)$ 的解：\n    $$\n    A(t) = A(0) \\, e^{-kt}\n    $$\n\n3.  **应用初始条件：**\n    在时间 $t=0$ 时，单次静脉推注剂量为 $D$ 的药物被给予。 “瞬时混合” 的假设意味着在 $t=0$ 时，全部剂量都存在于房室中。因此，体内的初始药量是：\n    $$\n    A(0) = D\n    $$\n    将此代入我们关于 $A(t)$ 的方程中：\n    $$\n    A(t) = D \\, e^{-kt}\n    $$\n\n4.  **将药量转换为浓度：**\n    问题要求的是血浆浓度 $C(t)$。我们使用所给的定义关系：$A(t) = V_d\\,C(t)$。整理得到 $C(t)$：\n    $$\n    C(t) = \\frac{A(t)}{V_d}\n    $$\n    代入我们关于 $A(t)$ 的表达式：\n    $$\n    C(t) = \\frac{D\\,e^{-kt}}{V_d}\n    $$\n    通常写作：\n    $$\n    C(t) = \\frac{D}{V_d} \\, e^{-kt}\n    $$\n该表达式描述了静脉推注后单房室模型中药物浓度的指数衰减。$t=0$ 时的初始浓度为 $C(0) = \\frac{D}{V_d}$，即初始剂量分布在整个分布容积中。\n\n### 逐项分析选项\n\n-   **A. $C(t)=\\dfrac{D}{V_d}\\,e^{-k t}$**\n    这个表达式与从基本原理推导出的表达式完全匹配。它正确地捕捉了单房室一级消除的指数衰减特性，并且具有正确的初始浓度 $C(0) = D/V_d$。\n    **结论：正确。**\n\n-   **B. $C(t)=D\\,e^{-k t}$**\n    这个表达式代表体内的药量 $A(t)$，而不是血浆浓度 $C(t)$。它在量纲上是不正确的，因为浓度（质量/体积）被等同于药量（质量）。它省略了除以分布容积 $V_d$。\n    **结论：错误。**\n\n-   **C. $C(t)=\\dfrac{D}{V_d}\\left(1-e^{-k t}\\right)$**\n    这个表达式描述的是一个累积过程，而不是推注给药后的消除过程。例如，它适用于恒速静脉输注接近稳态的情况。在 $t=0$ 时，该表达式得出 $C(0) = \\frac{D}{V_d}(1-1) = 0$，这对于静脉推注是错误的，因为在 $t=0$ 时浓度应为最大值。\n    **结论：错误。**\n\n-   **D. $C(t)=\\dfrac{D}{V_d}\\,e^{k t}$**\n    正指数 $e^{kt}$ 意味着药物浓度随时间指数增长。这与药物从体内被清除的消除原理相矛盾。\n    **结论：错误。**\n\n-   **E. $C(t)=\\dfrac{D}{V_d}\\,\\dfrac{1}{1+k t}$**\n    这种代数衰减形式 $C(t) \\propto (1+kt)^{-1}$ 是二级消除过程（消除速率与 $C(t)^2$ 成正比）的特征，而不是问题陈述中指定的一级过程。微分方程 $\\frac{dC}{dt} = -k'C^2$ 的解具有这种形式。\n    **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "4976395"}, {"introduction": "在掌握了理想化的静脉给药模型后，我们将转向更为普遍的口服给药途径。口服药物在发挥作用前，必须“闯过”胃肠道吸收和肝脏代谢这两道关卡。本练习将引导您计算药物的口服生物利用度，即综合考虑吸收、肠壁和肝脏首过效应后，最终进入体循环的药物比例，这是药物开发与临床治疗中的一项关键技能 [@problem_id:4976420]。", "problem": "一种新的口服候选药物在肠壁和肝脏中均会经历首过代谢。考虑在空腹状态下给健康成年人单次口服剂量。剂量中溶解并穿过肠上皮进入门静脉循环的部分（吸收分数）测量为 $F_{a} = 0.78$。肠壁会代谢一部分被吸收的药物；肠道（肠）提取率定义为在首过效应期间被肠上皮细胞不可逆地清除的已吸收药物部分，其测量值为 $E_{g} = 0.20$。肝消除遵循标准的良好搅拌模型假设。肝血流量为 $Q_{h} = 90$ $\\mathrm{L\\,h^{-1}}$，血中未结合分数（记为 $f_{u}$）为 $f_{u} = 0.25$，内在清除率（记为 $CL_{\\text{int}}$）为 $CL_{\\text{int}} = 120$ $\\mathrm{L\\,h^{-1}}$。假设为无饱和的线性动力学，且肠道和肝脏的首过损失是依次独立发生的。\n\n仅使用分数、质量平衡的基本定义以及肝提取的良好搅拌模型，推导出口服剂量到达体循环的总分数（口服生物利用度）$F$，并根据给定参数计算其数值。将最终结果表示为无单位的小数，并四舍五入到四位有效数字。", "solution": "该问题是有效的，因为它在科学上基于已建立的药代动力学原理，问题阐述清晰且提供了所有必要的参数，并以客观、正式的语言表述。其中没有矛盾、模糊之处或事实错误。\n\n目标是推导口服生物利用度 $F$ 的表达式并计算其值。口服生物利用度定义为口服给药剂量中以原形到达体循环的部分。问题指出，药物损失通过三个独立的过程相继发生：胃肠道（GI）的不完全吸收、肠壁（肠）的代谢以及肝脏的代谢。\n\n总生物利用度 $F$ 可以表示为药物通过每个连续屏障后存留分数的乘积：\n$$ F = F_a \\times F_g \\times F_h $$\n其中：\n- $F_a$ 是从胃肠道腔吸收进入门静脉循环的剂量分数。\n- $F_g$ 是通过肠壁首过代谢后存留的已吸收药物的分数。\n- $F_h$ 是到达肝脏的药物通过肝脏首过代谢后存留的分数。\n\n这些分数的值将根据给定参数确定。\n\n1.  **吸收分数, $F_a$**:\n    该值在问题陈述中已直接给出。\n    $$ F_a = 0.78 $$\n\n2.  **通过肠道代谢后的存留分数, $F_g$**:\n    肠道（肠）提取率 $E_g$ 定义为药物首次通过肠壁时被不可逆地清除的已吸收药物的分数。未被清除（即存留）的分数是 $F_g$。根据定义，这两个分数之和必须为 $1$。\n    $$ F_g = 1 - E_g $$\n    已知 $E_g = 0.20$，我们有：\n    $$ F_g = 1 - 0.20 = 0.80 $$\n\n3.  **通过肝脏代谢后的存留分数, $F_h$**:\n    类似地，肝提取率 $E_h$ 是进入肝脏的药物在首次通过时被清除的分数。存留的分数是 $F_h$：\n    $$ F_h = 1 - E_h $$\n    为了求得 $E_h$，我们必须使用肝消除的良好搅拌模型。在此模型中，肝提取率与肝血流量 $Q_h$ 和药物的内在清除率 $CL_{\\text{int}}$ 相关。内在清除率代表在没有血流限制的情况下，肝脏代谢药物的最大理论能力。它通常受到血中药物未结合分数 $f_u$ 的调节，因为通常只有未结合的药物可被代谢。\n\n    肝提取率 $E_h$ 是 $Q_h$、$f_u$ 和 $CL_{\\text{int}}$ 的函数。它被定义为肝清除率 $CL_h$ 与肝血流量 $Q_h$ 的比值：\n    $$ E_h = \\frac{CL_h}{Q_h} $$\n    根据良好搅拌模型，肝清除率由下式给出：\n    $$ CL_h = Q_h \\left( \\frac{f_u \\cdot CL_{\\text{int}}}{Q_h + f_u \\cdot CL_{\\text{int}}} \\right) $$\n    将 $CL_h$ 的这个表达式代入 $E_h$ 的方程中，得到：\n    $$ E_h = \\frac{1}{Q_h} \\left[ Q_h \\left( \\frac{f_u \\cdot CL_{\\text{int}}}{Q_h + f_u \\cdot CL_{\\text{int}}} \\right) \\right] = \\frac{f_u \\cdot CL_{\\text{int}}}{Q_h + f_u \\cdot CL_{\\text{int}}} $$\n    现在我们可以使用给定的参数计算 $E_h$：\n    -   $Q_h = 90$ $\\mathrm{L\\,h^{-1}}$\n    -   $f_u = 0.25$\n    -   $CL_{\\text{int}} = 120$ $\\mathrm{L\\,h^{-1}}$\n\n    首先，计算乘积 $f_u \\cdot CL_{\\text{int}}$：\n    $$ f_u \\cdot CL_{\\text{int}} = 0.25 \\times 120 \\ \\mathrm{L\\,h^{-1}} = 30 \\ \\mathrm{L\\,h^{-1}} $$\n    现在将此结果代入 $E_h$ 的表达式中：\n    $$ E_h = \\frac{30 \\ \\mathrm{L\\,h^{-1}}}{90 \\ \\mathrm{L\\,h^{-1}} + 30 \\ \\mathrm{L\\,h^{-1}}} = \\frac{30}{120} = 0.25 $$\n    计算出 $E_h$ 后，我们可以求得通过肝脏首过后的存留分数 $F_h$：\n    $$ F_h = 1 - E_h = 1 - 0.25 = 0.75 $$\n\n4.  **总口服生物利用度, $F$**:\n    推导出的口服生物利用度的通用表达式为：\n    $$ F = F_a \\cdot (1 - E_g) \\cdot \\left(1 - \\frac{f_u \\cdot CL_{\\text{int}}}{Q_h + f_u \\cdot CL_{\\text{int}}}\\right) $$\n    现在，我们可以代入每个分数的计算值，来求得 $F$ 的最终数值答案：\n    $$ F = F_a \\times F_g \\times F_h $$\n    $$ F = 0.78 \\times 0.80 \\times 0.75 $$\n    $$ F = 0.624 \\times 0.75 $$\n    $$ F = 0.468 $$\n    问题要求将结果四舍五入到四位有效数字。因此，我们将最终答案表示为 $0.4680$。", "answer": "$$\n\\boxed{0.4680}\n$$", "id": "4976420"}, {"introduction": "药代动力学的最终目标之一是设计安全有效的给药方案。对于治疗窗窄的药物，如何将药物浓度维持在有效但又低于中毒水平的区间内，是一项重大的临床挑战。本练习将理论付诸实践，您将推导多次给药后的稳态浓度公式，并用它来确定一个安全的给药剂量范围，从而深刻理解治疗药物监测（TDM）这一临床实践的理论依据 [@problem_id:4976428]。", "problem": "一种窄治疗指数药物通过静脉推注方式给药，进入一个遵循一级消除的单一、混合良好的房室。建模的基础是单房室系统中的质量平衡，由此可得出关于浓度 $C(t)$ 的常微分方程：$\\frac{dC}{dt} = -k\\,C$，其中消除速率常数 $k$ 通过 $k = \\frac{\\ln 2}{t_{1/2}}$ 与半衰期 $t_{1/2}$ 相关。每隔 $\\tau$（单位为 $\\mathrm{h}$）给予剂量为 $D$（单位为 $\\mathrm{mg}$）的药物，分布容积为 $V$（单位为 $\\mathrm{L}$），并假设为瞬时混合。最低有效浓度 $C_{\\min}^{\\mathrm{eff}}$（单位为 $\\mathrm{mg}/\\mathrm{L}$）和毒性浓度阈值 $C_{\\mathrm{tox}}$（单位为 $\\mathrm{mg}/\\mathrm{L}$）是药物和患者的固定属性。\n\n您的任务是：\n- 根据给定的基本原理，且不使用任何未经证明的简化公式，利用第一性原理（微分方程的解和跨剂量的线性叠加）推导稳态峰浓度和谷浓度如何依赖于 $D$、$V$、$k$ 和 $\\tau$。明确使用 $k = \\frac{\\ln 2}{t_{1/2}}$ 以及一级消除的指数解的性质。\n- 使用推导出的关系，用 $V$、$t_{1/2}$、$\\tau$、$C_{\\min}^{\\mathrm{eff}}$ 和 $C_{\\mathrm{tox}}$ 表示以下量：\n  1. 为使稳态谷浓度至少达到 $C_{\\min}^{\\mathrm{eff}}$ 所需的最小剂量 $D_{\\min}$（单位为 $\\mathrm{mg}$）。\n  2. 为使稳态峰浓度不超过 $C_{\\mathrm{tox}}$ 所允许的最大剂量 $D_{\\max}$（单位为 $\\mathrm{mg}$）。\n  3. 一个布尔指标，用于指示是否存在同时满足这两个条件的非空剂量区间，该指标可操作化地表明对此方案进行谷浓度监测的充分性。\n  4. 当给药剂量恰好达到最低有效谷浓度时，其毒性边际，定义为所产生的稳态峰浓度与 $C_{\\mathrm{tox}}$ 的比值，以小数形式表示（无单位）。\n- 实现一个程序，对每个测试用例，使用您的推导计算上述各量。\n\n单位和数值说明：\n- 剂量以 $\\mathrm{mg}$ 表示，浓度以 $\\mathrm{mg}/\\mathrm{L}$ 表示，时间以 $\\mathrm{h}$ 表示，容积以 $\\mathrm{L}$ 表示。\n- 毒性边际必须以小数（而非百分比）表示。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果本身应为一个 $[\\text{feasible\\_boolean}, D_{\\min}, D_{\\max}, \\text{toxicity\\_margin}]$ 形式的列表，总体输出应为这些列表组成的单个列表，例如 $[[\\dots],[\\dots],[\\dots],[\\dots]]$。\n\n测试套件：\n使用以下科学上合理的参数集，这些参数集可检验典型场景和边缘场景：\n- 测试用例 1（一般情况，中等波动）：$V = 40\\,\\mathrm{L}$，$t_{1/2} = 12\\,\\mathrm{h}$，$\\tau = 12\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 5\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n- 测试用例 2（边界情况，临界可行性）：$V = 30\\,\\mathrm{L}$，$t_{1/2} = 8\\,\\mathrm{h}$，$\\tau = 8\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 7.5\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n- 测试用例 3（因峰谷波动过大而不可行）：$V = 40\\,\\mathrm{L}$，$t_{1/2} = 4\\,\\mathrm{h}$，$\\tau = 12\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 5\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n- 测试用例 4（长半衰期，小波动，宽可行性范围）：$V = 60\\,\\mathrm{L}$，$t_{1/2} = 48\\,\\mathrm{h}$，$\\tau = 12\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 10\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n\n您的程序必须为每个测试用例计算所要求的量，并以上述确切的最终输出格式、使用指定的单位打印它们。", "solution": "现在分析用户提供的问题。\n\n### 第 1 步：提取已知条件\n- **控制方程：** $\\frac{dC}{dt} = -k\\,C$\n- **消除速率常数：** $k = \\frac{\\ln 2}{t_{1/2}}$\n- **剂量：** $D$ (单位为 $\\mathrm{mg}$)\n- **给药间隔：** $\\tau$ (单位为 $\\mathrm{h}$)\n- **分布容积：** $V$ (单位为 $\\mathrm{L}$)\n- **模型假设：** 静脉推注给药，单房室、混合良好，一级消除，瞬时混合。\n- **药物属性：**\n    - 最低有效浓度：$C_{\\min}^{\\mathrm{eff}}$ (单位为 $\\mathrm{mg}/\\mathrm{L}$)\n    - 毒性浓度阈值：$C_{\\mathrm{tox}}$ (单位为 $\\mathrm{mg}/\\mathrm{L}$)\n- **任务：**\n    1. 从第一性原理推导稳态峰浓度和谷浓度。\n    2. 推导以下量的表达式：\n        a. 确保 $C_{\\text{ss, trough}} \\ge C_{\\min}^{\\mathrm{eff}}$ 的最小剂量 $D_{\\min}$。\n        b. 确保 $C_{\\text{ss, peak}} \\le C_{\\mathrm{tox}}$ 的最大剂量 $D_{\\max}$。\n        c. 指示是否存在可行给药区间（$D_{\\min} \\le D_{\\max}$）的布尔指标。\n        d. 毒性边际，定义为使用 $D_{\\min}$ 给药时 $\\frac{C_{\\text{ss, peak}}}{C_{\\mathrm{tox}}}$ 的比值。\n    3. 实现一个程序来为给定的测试用例计算这些量。\n- **测试用例：**\n    1. $V = 40\\,\\mathrm{L}$，$t_{1/2} = 12\\,\\mathrm{h}$，$\\tau = 12\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 5\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n    2. $V = 30\\,\\mathrm{L}$，$t_{1/2} = 8\\,\\mathrm{h}$，$\\tau = 8\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 7.5\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n    3. $V = 40\\,\\mathrm{L}$，$t_{1/2} = 4\\,\\mathrm{h}$，$\\tau = 12\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 5\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n    4. $V = 60\\,\\mathrm{L}$，$t_{1/2} = 48\\,\\mathrm{h}$，$\\tau = 12\\,\\mathrm{h}$，$C_{\\min}^{\\mathrm{eff}} = 10\\,\\mathrm{mg}/\\mathrm{L}$，$C_{\\mathrm{tox}} = 15\\,\\mathrm{mg}/\\mathrm{L}$。\n- **输出格式：** 单行 `[[布尔值_1, D_min_1, D_max_1, 边际_1],[布尔值_2, D_min_2, D_max_2, 边际_2],...]`。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于带有一级消除的单房室模型，这是经典药代动力学的基石。控制微分方程以及速率常数和半衰期之间的关系是标准且正确的。所有概念都牢固地植根于已确立的科学之中。\n2.  **适定性：** 该问题定义清晰，要求从给定模型推导特定量，并随后为一组参数进行计算。该设置保证了每个量都存在唯一、稳定且有意义的解。\n3.  **客观性：** 问题陈述使用了精确、定量和无偏见的语言。没有主观或基于观点的论断。\n4.  **完整性和一致性：** 为推导和数值计算提供了所有必要的变量（$V, t_{1/2}, \\tau, C_{\\min}^{\\mathrm{eff}}, C_{\\mathrm{tox}}$）和定义。测试用例参数是内部一致且科学上合理的。\n5.  **无其他缺陷：** 该问题不是隐喻性的、琐碎的或不可验证的。它是数学建模在真实世界科学学科中的直接应用。\n\n### 第 3 步：结论与行动\n问题有效。将提供一个完整的、有理有据的解决方案。\n\n### 推导与求解\n\n**1. 稳态峰浓度和谷浓度的推导**\n\n基本模型是描述单房室中药物浓度 $C(t)$ 遵循一级消除的常微分方程：\n$$\n\\frac{dC}{dt} = -kC(t)\n$$\n其中 $k$ 是消除速率常数。这是一个可分离的一阶线性常微分方程。给定初始浓度 $C(t_0) = C_0$，其解为：\n$$\nC(t) = C_0 e^{-k(t-t_0)}\n$$\n这种指数衰减就是问题中提到的“一级消除的指数解的性质”。\n\n现在我们考虑一个多次给药方案，每隔 $\\tau$ 小时静脉注射一次剂量为 $D$ 的药物。将静脉推注剂量 $D$ 注入容积 $V$ 中，会导致浓度瞬时增加 $\\Delta C = D/V$。我们可以通过应用线性叠加原理来追踪浓度随时间的变化。\n\n设 $C_{n, \\text{peak}}$ 为第 $n$ 次给药后（时间 $t = (n-1)\\tau$）的瞬时峰浓度，$C_{n, \\text{trough}}$ 为第 $n$ 次给药前的瞬时谷浓度。\n\n- **第 1 次给药后（$t=0$ 时）：**\n  初始浓度为 $0$。给药使其达到第一个峰值：\n  $C_{1, \\text{peak}} = \\frac{D}{V}$。\n- **第 2 次给药前（$t=\\tau$ 时）：**\n  浓度衰减一个周期 $\\tau$：\n  $C_{2, \\text{trough}} = C_{1, \\text{peak}} e^{-k\\tau} = \\frac{D}{V} e^{-k\\tau}$。\n- **第 2 次给药后（$t=\\tau$ 时）：**\n  加入新剂量，浓度增加 $D/V$：\n  $C_{2, \\text{peak}} = C_{2, \\text{trough}} + \\frac{D}{V} = \\frac{D}{V}e^{-k\\tau} + \\frac{D}{V} = \\frac{D}{V}(1 + e^{-k\\tau})$。\n- **第 3 次给药前（$t=2\\tau$ 时）：**\n  浓度再衰减一个周期 $\\tau$：\n  $C_{3, \\text{trough}} = C_{2, \\text{peak}} e^{-k\\tau} = \\frac{D}{V}(1 + e^{-k\\tau})e^{-k\\tau} = \\frac{D}{V}(e^{-k\\tau} + e^{-2k\\tau})$。\n- **第 $n$ 次给药后（$t=(n-1)\\tau$ 时）：**\n  通过归纳法，峰浓度是所有先前剂量残留的总和：\n  $C_{n, \\text{peak}} = \\frac{D}{V} + \\frac{D}{V}e^{-k\\tau} + \\frac{D}{V}e^{-2k\\tau} + \\dots + \\frac{D}{V}e^{-(n-1)k\\tau} = \\frac{D}{V} \\sum_{i=0}^{n-1} (e^{-k\\tau})^i$。\n\n这是一个有限几何级数。在稳态时（定义为 $n \\to \\infty$ 的极限），该级数变为无穷几何级数。由于 $k > 0$ 和 $\\tau > 0$，公比 $r = e^{-k\\tau}$ 满足 $0  r  1$，因此级数收敛。\n\n稳态峰浓度 $C_{\\text{ss, peak}}$ 为：\n$$\nC_{\\text{ss, peak}} = \\lim_{n\\to\\infty} C_{n, \\text{peak}} = \\frac{D}{V} \\sum_{i=0}^{\\infty} (e^{-k\\tau})^i = \\frac{D}{V} \\left( \\frac{1}{1 - e^{-k\\tau}} \\right)\n$$\n稳态谷浓度 $C_{\\text{ss, trough}}$ 是下一次给药前的浓度，即稳态峰浓度经过一个给药间隔 $\\tau$ 衰减后的浓度：\n$$\nC_{\\text{ss, trough}} = C_{\\text{ss, peak}} e^{-k\\tau} = \\frac{D}{V} \\left( \\frac{e^{-k\\tau}}{1 - e^{-k\\tau}} \\right)\n$$\n这些就是从第一性原理推导出的稳态浓度所需表达式。\n\n**2. 给药相关量的推导**\n\n现在我们使用这些表达式来求解 $D_{\\min}$、$D_{\\max}$、可行性条件和毒性边际。我们将使用关系式 $k = \\frac{\\ln 2}{t_{1/2}}$，这意味着 $e^{-k\\tau} = e^{-(\\ln 2 / t_{1/2})\\tau} = (e^{\\ln 2})^{-\\tau/t_{1/2}} = 2^{-\\tau/t_{1/2}}$。\n\n**a. 最小剂量 $D_{\\min}$**\n条件是稳态谷浓度必须至少为最低有效浓度：$C_{\\text{ss, trough}} \\ge C_{\\min}^{\\mathrm{eff}}$。最小剂量 $D_{\\min}$ 是导致 $C_{\\text{ss, trough}} = C_{\\min}^{\\mathrm{eff}}$ 的剂量。\n$$\nC_{\\min}^{\\mathrm{eff}} = \\frac{D_{\\min}}{V} \\left( \\frac{e^{-k\\tau}}{1 - e^{-k\\tau}} \\right)\n$$\n求解 $D_{\\min}$：\n$$\nD_{\\min} = C_{\\min}^{\\mathrm{eff}} V \\left( \\frac{1 - e^{-k\\tau}}{e^{-k\\tau}} \\right) = C_{\\min}^{\\mathrm{eff}} V (e^{k\\tau} - 1)\n$$\n代入 $e^{k\\tau} = 2^{\\tau/t_{1/2}}$：\n$$\nD_{\\min} = C_{\\min}^{\\mathrm{eff}} V (2^{\\tau/t_{1/2}} - 1)\n$$\n\n**b. 最大剂量 $D_{\\max}$**\n条件是稳态峰浓度不得超过毒性浓度：$C_{\\text{ss, peak}} \\le C_{\\mathrm{tox}}$。最大剂量 $D_{\\max}$ 是导致 $C_{\\text{ss, peak}} = C_{\\mathrm{tox}}$ 的剂量。\n$$\nC_{\\mathrm{tox}} = \\frac{D_{\\max}}{V} \\left( \\frac{1}{1 - e^{-k\\tau}} \\right)\n$$\n求解 $D_{\\max}$：\n$$\nD_{\\max} = C_{\\mathrm{tox}} V (1 - e^{-k\\tau})\n$$\n代入 $e^{-k\\tau} = 2^{-\\tau/t_{1/2}}$：\n$$\nD_{\\max} = C_{\\mathrm{tox}} V (1 - 2^{-\\tau/t_{1/2}})\n$$\n\n**c. 可行性指标**\n当且仅当存在一个非空的可接受剂量范围时，治疗性给药方案才是可行的。这要求 $D_{\\min} \\le D_{\\max}$。\n$$\nC_{\\min}^{\\mathrm{eff}} V (e^{k\\tau} - 1) \\le C_{\\mathrm{tox}} V (1 - e^{-k\\tau})\n$$\n由于 $V0$，我们可以消去它。另外，$1 - e^{-k\\tau} = e^{-k\\tau}(e^{k\\tau} - 1)$。\n$$\nC_{\\min}^{\\mathrm{eff}} (e^{k\\tau} - 1) \\le C_{\\mathrm{tox}} e^{-k\\tau} (e^{k\\tau} - 1)\n$$\n由于 $\\tau  0$ 且 $k  0$，项 $(e^{k\\tau} - 1)$ 为正，因此我们可以用它来除。\n$$\nC_{\\min}^{\\mathrm{eff}} \\le C_{\\mathrm{tox}} e^{-k\\tau} \\quad \\implies \\quad C_{\\min}^{\\mathrm{eff}} e^{k\\tau} \\le C_{\\mathrm{tox}}\n$$\n这个条件有一个清晰的物理诠释。对于任何剂量，稳态时的峰谷浓度比为 $\\frac{C_{\\text{ss, peak}}}{C_{\\text{ss, trough}}} = e^{k\\tau}$。这就是波动因子。要使一个方案可行，治疗窗必须足够大以容纳这种波动，即 $\\frac{C_{\\mathrm{tox}}}{C_{\\min}^{\\mathrm{eff}}} \\ge e^{k\\tau}$。\n如果 $D_{\\min} \\le D_{\\max}$（或其等效条件 $C_{\\min}^{\\mathrm{eff}} 2^{\\tau/t_{1/2}} \\le C_{\\mathrm{tox}}$），则布尔指标为“真”(True)，否则为“假”(False)。\n\n**d. 毒性边际**\n这被定义为使用 $D_{\\min}$ 给药时（即，当给药使谷浓度恰好为 $C_{\\min}^{\\mathrm{eff}}$ 时），所产生的稳态峰浓度与 $C_{\\mathrm{tox}}$ 的比值。\n我们将由剂量 $D_{\\min}$ 产生的峰浓度称为 $C_{\\text{peak}}^*$。\n当 $C_{\\text{ss, trough}} = C_{\\min}^{\\mathrm{eff}}$ 时，相应的峰浓度为 $C_{\\text{peak}}^* = C_{\\text{ss, trough}} \\cdot e^{k\\tau} = C_{\\min}^{\\mathrm{eff}} e^{k\\tau}$。\n那么毒性边际为：\n$$\n\\text{毒性边际} = \\frac{C_{\\text{peak}}^*}{C_{\\mathrm{tox}}} = \\frac{C_{\\min}^{\\mathrm{eff}} e^{k\\tau}}{C_{\\mathrm{tox}}}\n$$\n代入 $e^{k\\tau} = 2^{\\tau/t_{1/2}}$：\n$$\n\\text{毒性边际} = \\frac{C_{\\min}^{\\mathrm{eff}} \\cdot 2^{\\tau/t_{1/2}}}{C_{\\mathrm{tox}}}\n$$\n注意，可行性条件 $C_{\\min}^{\\mathrm{eff}} e^{k\\tau} \\le C_{\\mathrm{tox}}$ 等价于毒性边际小于或等于 1。\n\n这些推导出的表达式将在程序中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes pharmacokinetic parameters for several test cases based on a \n    one-compartment model with first-order elimination.\n    \"\"\"\n    \n    # Test cases as provided in the problem statement.\n    # Each tuple is (V, t_1/2, tau, C_min_eff, C_tox)\n    test_cases = [\n        # Test case 1 (general case, moderate fluctuations)\n        (40.0, 12.0, 12.0, 5.0, 15.0),\n        # Test case 2 (boundary, knife-edge feasibility)\n        (30.0, 8.0, 8.0, 7.5, 15.0),\n        # Test case 3 (infeasible due to large peak–trough swing)\n        (40.0, 4.0, 12.0, 5.0, 15.0),\n        # Test case 4 (long half-life, small fluctuations, wide feasibility)\n        (60.0, 48.0, 12.0, 10.0, 15.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        V, t_half, tau, C_min_eff, C_tox = case\n\n        # The term 2^(tau/t_half) is equivalent to exp(k*tau) and represents\n        # the fluctuation factor between peak and trough concentrations.\n        # This factor appears in all derived formulas.\n        fluctuation_factor = 2**(tau / t_half)\n\n        # 1. Minimum dose D_min\n        # Derived from C_min_eff = (D_min/V) * (exp(-k*tau) / (1 - exp(-k*tau)))\n        # which simplifies to D_min = C_min_eff * V * (exp(k*tau) - 1)\n        D_min = C_min_eff * V * (fluctuation_factor - 1)\n\n        # 2. Maximum dose D_max\n        # Derived from C_tox = (D_max/V) * (1 / (1 - exp(-k*tau)))\n        # which simplifies to D_max = C_tox * V * (1 - exp(-k*tau))\n        D_max = C_tox * V * (1 - 1/fluctuation_factor)\n\n        # 3. Feasibility boolean\n        # A feasible dosing window exists if and only if D_min = D_max.\n        is_feasible = D_min = D_max\n\n        # 4. Toxicity margin\n        # This is the ratio of the peak concentration (when dosing with D_min) \n        # to the toxic concentration C_tox.\n        # The peak when trough is C_min_eff is simply C_min_eff * exp(k*tau).\n        # Margin = (C_min_eff * exp(k*tau)) / C_tox\n        toxicity_margin = (C_min_eff * fluctuation_factor) / C_tox\n\n        results.append([is_feasible, D_min, D_max, toxicity_margin])\n\n    # Format the final output string exactly as specified.\n    # Each sublist is formatted as \"[val1,val2,...]\" without spaces.\n    formatted_results = []\n    for res in results:\n        # str(res[0]) gives \"True\" or \"False\"\n        # The other elements are floats.\n        # Using a list comprehension with map for conciseness.\n        s = f\"[{','.join(map(str, res))}]\"\n        formatted_results.append(s)\n    \n    # The final output is a list of these formatted strings, joined by commas,\n    # and enclosed in brackets.\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "4976428"}]}