{"hands_on_practices": [{"introduction": "理解疫苗在受控试验与真实世界中表现的差异至关重要。本练习将指导你如何从随机对照试验（RCT）中计算疫苗效力（efficacy），并如何在观察性研究中调整混杂因素以估算疫苗的有效性（effectiveness），从而提升你的流行病学技能。[@problem_id:4986215]", "problem": "一种预防季节性流感的疫苗首先在一项随机对照试验（RCT）中进行评估，之后在一项大型观察性队列研究（OCS）中进行评估。在RCT中，对等规模的疫苗组和安慰剂组进行了一个流感季节的随访，结局指标为经实验室确诊的症状性流感。在OCS中，疫苗接种是自我选择的，并且存在年龄混杂；该队列按两个年龄类别进行分层：小于$65$岁和$65$岁及以上。请仅使用风险、发病比例、发生率的比较指标以及风险按比例降低的概念来推导所需的估计量。\n\n数据：\n\n- RCT：\n  - 疫苗组：$6000$名参与者；随访期间有$72$人出现症状性流感。\n  - 安慰剂组：$6000$名参与者；随访期间有$240$人出现症状性流感。\n\n- OCS，按年龄分层：\n  - 小于$65$岁：疫苗接种者$8000$人，出现$40$例病例；未接种者$4000$人，出现$80$例病例。\n  - $65$岁及以上：疫苗接种者$2000$人，出现$60$例病例；未接种者$1000$人，出现$60$例病例。\n\n任务：\n\n1. 使用风险和比较指标的核心定义，推导在随机化环境中，疫苗组相对于安慰剂组的风险按比例降低的表达式，并根据RCT数据计算其值。该量被称为疫苗效力。\n2. 用一句话清晰阐明疫苗效力（来自随机试验）和疫苗有效性（来自观察性研究）在概念上的区别，并提及随机化和混杂的作用。\n3. 在OCS中，对两个年龄分层使用科学上适当的分层调整方法，通过首先获得跨分层的单一调整后比较指标，然后将其转换为相应的保护分数，来计算观察性有效性估计值。\n\n将您的数值答案四舍五入至三位有效数字，并以小数形式表示（不要使用百分号）。按顺序报告任务$1$和$3$中要求的两个量作为您的最终答案。", "solution": "该问题陈述已经过严格验证，并被认为是有效的。它在流行病学和生物统计学原理方面具有科学依据，问题阐述清晰，数据充足，可进行所需计算，并且表述客观。该问题为定量分析提供了坚实的基础。\n\n### 任务 1：来自随机对照试验（RCT）的疫苗效力\n\n在此背景下，主要的效果度量是风险，或称发病比例，定义为在指定时期内，最初无病人群中出现疾病的比例。对于一个组，风险 $R$ 的计算公式为：\n$$R = \\frac{\\text{Number of new cases}}{\\text{Number of individuals in the population at the start}}$$\n\n在随机对照试验（RCT）中，我们获得了疫苗组和安慰剂组的数据。设 $R_V$ 为疫苗组的风险，$R_P$ 为安慰剂组的风险。\n\n根据提供的RCT数据：\n- 疫苗组：$N_V^{RCT} = 6000$ 名参与者，$I_V^{RCT} = 72$ 例病例。\n- 安慰剂组：$N_P^{RCT} = 6000$ 名参与者，$I_P^{RCT} = 240$ 例病例。\n\n各组的风险计算如下：\n$$R_V^{RCT} = \\frac{I_V^{RCT}}{N_V^{RCT}} = \\frac{72}{6000} = 0.012$$\n$$R_P^{RCT} = \\frac{I_P^{RCT}}{N_P^{RCT}} = \\frac{240}{6000} = 0.040$$\n\n发生率的比较指标是风险比（$RR$），即疫苗组的风险与安慰剂组的风险之比。\n$$RR = \\frac{R_V^{RCT}}{R_P^{RCT}}$$\n\n疫苗效力（$VE$）定义为接种疫苗者相对于未接种疫苗者的风险按比例降低的幅度。推导如下：\n$$VE = \\frac{R_P - R_V}{R_P} = 1 - \\frac{R_V}{R_P} = 1 - RR$$\n\n使用RCT数据计算出的风险：\n$$RR^{RCT} = \\frac{0.012}{0.040} = 0.3$$\n因此，疫苗效力为：\n$$VE = 1 - RR^{RCT} = 1 - 0.3 = 0.7$$\n四舍五入至三位有效数字，疫苗效力为 $0.700$。\n\n### 任务 2：效力与有效性之间的概念差异\n\n疫苗效力源自随机试验，通过随机化将混杂因素降至最低，从而衡量疫苗在理想环境下的直接保护效果；而疫苗有效性源自观察性研究，衡量疫苗在真实世界环境中的总体保護效果，在此类环境中，混杂是需要关注并进行统计学控制的问题。\n\n### 任务 3：来自观察性队列研究（OCS）的调整后疫苗有效性\n\n在观察性队列研究（OCS）中，疫苗接种是自我选择的，且问题陈述指出了存在年龄混杂。为了计算无混杂的疫苗有效性估计值，我们必须进行分层分析以调整年龄的影响。获得跨分层的单一调整后比较指标的适当方法是使用风险比的Mantel-Haenszel（MH）估计量。该方法计算特定分层风险比的加权平均值。\n\n设两个年龄分层由下标 $i$ 表示，其中 $i=Y$ 代表小于$65$岁的组，$i=O$ 代表$65$岁及以上的组。对于每个分层 $i$，我们定义：\n- $a_i$：疫苗接种者中的病例数。\n- $N_{V,i}$：疫苗接种者总数。\n- $c_i$：未接种者中的病例数。\n- $N_{U,i}$：未接种者总数。\n- $T_i = N_{V,i} + N_{U,i}$：该分层中的总人数。\n\n特定分层的数据如下：\n\n- 分层 $Y$（小于$65$岁）：\n  - $a_Y = 40$，$N_{V,Y} = 8000$\n  - $c_Y = 80$，$N_{U,Y} = 4000$\n  - $T_Y = 8000 + 4000 = 12000$\n\n- 分层 $O$（$65$岁及以上）：\n  - $a_O = 60$，$N_{V,O} = 2000$\n  - $c_O = 60$，$N_{U,O} = 1000$\n  - $T_O = 2000 + 1000 = 3000$\n\nMantel-Haenszel调整后的风险比 $RR_{MH}$ 由以下公式给出：\n$$RR_{MH} = \\frac{\\sum_{i} \\frac{a_i N_{U,i}}{T_i}}{\\sum_{i} \\frac{c_i N_{V,i}}{T_i}}$$\n\n我们分别计算分子和分母项。\n分子：\n$$\\sum_{i} \\frac{a_i N_{U,i}}{T_i} = \\left(\\frac{40 \\times 4000}{12000}\\right) + \\left(\\frac{60 \\times 1000}{3000}\\right) = \\frac{160000}{12000} + \\frac{60000}{3000} = \\frac{40}{3} + 20 = \\frac{40+60}{3} = \\frac{100}{3}$$\n\n分母：\n$$\\sum_{i} \\frac{c_i N_{V,i}}{T_i} = \\left(\\frac{80 \\times 8000}{12000}\\right) + \\left(\\frac{60 \\times 2000}{3000}\\right) = \\frac{640000}{12000} + \\frac{120000}{3000} = \\frac{160}{3} + 40 = \\frac{160+120}{3} = \\frac{280}{3}$$\n\n现在，我们计算调整后的风险比：\n$$RR_{MH} = \\frac{\\frac{100}{3}}{\\frac{280}{3}} = \\frac{100}{280} = \\frac{10}{28} = \\frac{5}{14}$$\n\n调整后的疫苗有效性（$VEff$）是与此调整后风险比相对应的保护分数：\n$$VEff = 1 - RR_{MH} = 1 - \\frac{5}{14} = \\frac{9}{14}$$\n\n以小数形式表示，该值为：\n$$VEff = \\frac{9}{14} \\approx 0.642857...$$\n四舍五入至三位有效数字，调整后的疫苗有效性为 $0.643$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.700  0.643 \\end{pmatrix}}$$", "id": "4986215"}, {"introduction": "疫苗的初始保护并非永久有效；理解免疫力减弱的速率是维持长期防御的关键。本练习将引入一个抗体衰减的数学模型，让你能够推导出抗体半衰期，并确定加强针的最佳接种时机以确保持续的保护。[@problem_id:4986217]", "problem": "一家公共卫生诊所监测针对某种呼吸道病原体疫苗接种后的抗体滴度。在此背景下，请定性地定义免疫力减弱（waning immunity）与疫苗接种后抗体浓度和保护作用的关系。然后，从抗体滴度的瞬时下降速率与当前滴度成正比（比例常数为 $k$，单位为 $\\text{time}^{-1}$）且初始条件为 $A(0)=A_{0}$ 的假设出发，推导抗体滴度 $A(t)$ 作为时间 $t$ 的函数的通式。利用该表达式，推导用 $k$ 表示的抗体反应半衰期 $t_{1/2}$。接下来，对于一种加强针策略，其中每次加强针瞬时将滴度恢复到 $A_{0}$，随后的下降遵循相同的动力学规律，请确定最大加强针间隔时间 $T_{\\max}$，使得在下一次加强针接种时，滴度恰好达到保护阈值 $A^{*}$。请用 $A_{0}$、$A^{*}$ 和 $k$ 表示该间隔。\n\n最后，考虑一种疫苗，其加强针接种后的峰值抗体滴度为 $A_{0}=160$ 国际单位/毫升 (IU/mL)，保护阈值为 $A^{*}=20$ IU/mL，抗体半衰期为 $t_{1/2}=6$ 个月。计算最大加强针间隔时间 $T_{\\max}$（以月为单位）。将最终数值答案四舍五入至三位有效数字，并以月为单位表示时长。", "solution": "该问题被评估为有效，因为它具有科学依据、问题明确且客观。它基于药代动力学和免疫学中常用的一阶衰减标准模型，并且为获得唯一解提供了所有必要的参数和条件。\n\n首先，我们按要求定性地定义免疫力减弱。免疫力减弱是指在接种疫苗或自然感染后，免疫保护的强度和/或有效性逐渐下降。在本问题的背景下，它特指抗体浓度的下降。宿主免疫系统受到疫苗刺激后，抗体浓度（滴度）会上升到一个峰值水平，然后随着时间的推移开始下降。这种衰减是由于抗体的自然更新和清除，以及产生抗体的浆细胞数量减少所致。对病原体的保护作用通常与将抗体滴度维持在某个最低保护阈值之上相关。当抗体滴度降至该阈值以下时，免疫力减弱就具有了临床意义，这会使个体易于感染或患病。\n\n接下来，我们推导抗体滴度 $A(t)$ 作为时间 $t$ 的函数的数学表达式。问题陈述，抗体滴度的瞬时下降速率与当前滴度成正比。这可以表示为以下一阶常微分方程：\n$$\n\\frac{dA}{dt} = -k A(t)\n$$\n其中 $k$ 是单位为 $\\text{time}^{-1}$ 的正常数比例常数，负号表示滴度的减少或下降。这是一个可分离的微分方程，可以整理为：\n$$\n\\frac{dA}{A} = -k \\, dt\n$$\n我们对等式两边进行积分：\n$$\n\\int \\frac{1}{A} \\, dA = \\int -k \\, dt\n$$\n积分得到：\n$$\n\\ln(A) = -kt + C\n$$\n其中 $C$ 是积分常数。为了解出 $A(t)$，我们对两边取指数：\n$$\nA(t) = \\exp(-kt + C) = \\exp(C) \\exp(-kt)\n$$\n我们使用初始条件 $A(0) = A_{0}$ 来确定常数 $\\exp(C)$。在 $t=0$ 时：\n$$\nA(0) = \\exp(C) \\exp(-k \\cdot 0) = \\exp(C) \\cdot 1 = A_{0}\n$$\n因此，常数 $\\exp(C)$ 等于初始抗体滴度 $A_{0}$。将其代回方程，得到抗体滴度随时间变化的通式：\n$$\nA(t) = A_{0} \\exp(-kt)\n$$\n该方程描述了抗体滴度从初始值 $A_{0}$ 开始的指数衰减。\n\n现在，我们推导抗体反应的半衰期 $t_{1/2}$。半衰期的定义是抗体滴度降低到其初始值一半所需的时间，即 $A(t_{1/2}) = \\frac{A_{0}}{2}$。我们将这个条件代入我们推导出的 $A(t)$ 表达式中：\n$$\n\\frac{A_{0}}{2} = A_{0} \\exp(-k t_{1/2})\n$$\n两边同时除以 $A_{0}$ (假设 $A_{0} > 0$)：\n$$\n\\frac{1}{2} = \\exp(-k t_{1/2})\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k t_{1/2}\n$$\n使用对数性质 $\\ln(1/x) = -\\ln(x)$，我们得到：\n$$\n-\\ln(2) = -k t_{1/2}\n$$\n求解半衰期 $t_{1/2}$，得到其与衰减常数 $k$ 的关系：\n$$\nt_{1/2} = \\frac{\\ln(2)}{k}\n$$\n\n接下来，我们确定最大加强针间隔时间 $T_{\\max}$。该策略要求，从加强针接种后的水平 $A_{0}$ 开始，滴度可以衰减，直到在时间 $t = T_{\\max}$ 时恰好达到保护阈值 $A^{*}$。因此，我们必须有 $A(T_{\\max}) = A^{*}$。使用 $A(t)$ 的通式：\n$$\nA^{*} = A_{0} \\exp(-k T_{\\max})\n$$\n为了解出 $T_{\\max}$，我们首先两边除以 $A_{0}$：\n$$\n\\frac{A^{*}}{A_{0}} = \\exp(-k T_{\\max})\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{A^{*}}{A_{0}}\\right) = -k T_{\\max}\n$$\n使用对数性质 $\\ln(x/y) = -\\ln(y/x)$：\n$$\n-\\ln\\left(\\frac{A_{0}}{A^{*}}\\right) = -k T_{\\max}\n$$\n最后，求解 $T_{\\max}$ 得到：\n$$\nT_{\\max} = \\frac{1}{k} \\ln\\left(\\frac{A_{0}}{A^{*}}\\right)\n$$\n这个表达式给出了用 $A_{0}$、$A^{*}$ 和衰减常数 $k$ 表示的最大加强针间隔时间。\n\n最后，我们使用给定参数计算 $T_{\\max}$ 的数值：$A_{0} = 160$ IU/mL，$A^{*} = 20$ IU/mL，以及 $t_{1/2} = 6$ 个月。\n首先，我们需要根据给定的半衰期求出衰减常数 $k$。整理半衰期公式：\n$$\nk = \\frac{\\ln(2)}{t_{1/2}} = \\frac{\\ln(2)}{6 \\text{ months}}\n$$\n现在我们将这个 $k$ 的表达式代入 $T_{\\max}$ 的方程中：\n$$\nT_{\\max} = \\frac{1}{\\frac{\\ln(2)}{t_{1/2}}} \\ln\\left(\\frac{A_{0}}{A^{*}}\\right) = t_{1/2} \\frac{\\ln\\left(\\frac{A_{0}}{A^{*}}\\right)}{\\ln(2)}\n$$\n现在，我们将数值代入该方程：\n$$\nT_{\\max} = (6 \\text{ months}) \\times \\frac{\\ln\\left(\\frac{160}{20}\\right)}{\\ln(2)}\n$$\n滴度之比为 $\\frac{160}{20} = 8$。\n$$\nT_{\\max} = 6 \\times \\frac{\\ln(8)}{\\ln(2)}\n$$\n使用对数性质 $\\ln(x^y) = y \\ln(x)$，我们可以写出 $\\ln(8) = \\ln(2^3) = 3 \\ln(2)$。\n$$\nT_{\\max} = 6 \\times \\frac{3 \\ln(2)}{\\ln(2)}\n$$\n$\\ln(2)$ 项消掉了：\n$$\nT_{\\max} = 6 \\times 3 = 18 \\text{ months}\n$$\n问题要求答案四舍五入至三位有效数字。确切答案是 $18$，可以写成 $18.0$ 以表示三位有效数字。单位是月。", "answer": "$$\n\\boxed{18.0}\n$$", "id": "4986217"}, {"introduction": "高疫苗效力百分比并不总能转化为巨大的公共卫生影响；疾病的基线风险是等式中的关键部分。在本练习中，你将推导绝对风险降低率（Absolute Risk Reduction）和需接种人数（Number Needed to Vaccinate, NNV）的公式，学习如何将相对效力转化为能够为临床和公共卫生决策提供信息的绝对指标。[@problem_id:4986269]", "problem": "在某一群体中，评估一种疫苗在固定的随访期内预防一种明确定义的严重结局（例如，住院）的能力。设未接种疫苗者发生严重结局的基线风险为概率 $r \\in (0,1)$，疫苗效力（VE）记为 $VE \\in [0,1]$。假设 $VE$ 表示在同一时期内，接种疫苗者相对于未接种疫苗者发生严重结局概率的比例下降值。\n\n仅使用基础的流行病学定义（事件概率、相对风险和绝对风险降低），并将此二元结局的最小临床重要差异（MCID）解释为因接种疫苗而导致的事件概率的绝对降低值，推导出 MCID 和避免一例严重结局所需接种人数（NNV）的封闭式表达式，用 $r$ 和 $VE$ 表示。\n\n将您的最终答案表示为不带单位的代数表达式。无需四舍五入。如果提供多个表达式，请将它们一起表示为单个行矩阵。", "solution": "首先验证该问题，以确保其具有科学依据、自洽且适定。\n\n### 步骤 1：提取已知条件\n-   未接种疫苗者发生严重结局的基线风险：$r \\in (0,1)$。\n-   疫苗效力：$VE \\in [0,1]$。\n-   疫苗效力（$VE$）的定义：接种疫苗者相对于未接种疫苗者发生严重结局概率的比例下降值。\n-   最小临床重要差异（$MCID$）的定义：因接种疫苗而导致的事件概率的绝对降低值。\n-   目标：推导 $MCID$ 和需接种人数（$NNV$）关于 $r$ 和 $VE$ 的封闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n-   **科学依据**：基线风险（$r$）、疫苗效力（$VE$）、绝对风险降低（$ARR$）和需接种人数（$NNV$）等概念是流行病学和临床医学中的基础和标准概念。所提供的定义是正确的，并与既定原则一致。\n-   **适定性**：问题提供了所有必要信息以及清晰、明确的定义。给定的变量 $r$ 和 $VE$ 足以唯一确定所需量 $MCID$ 和 $NNV$。对变量的约束条件 $r \\in (0,1)$ 和 $VE \\in [0,1]$ 确保了问题在数学上是合理的。\n-   **客观性**：问题陈述使用了精确、正式的语言，不含任何主观或基于意见的主张。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的，因为它是自洽的、适定的并且有科学依据的。将推导解答。\n\n### 推导过程\n令 $P(\\text{Outcome}|U)$ 为未接种疫苗者发生严重结局的概率，令 $P(\\text{Outcome}|V)$ 为接种疫苗者发生严重结局的概率。\n根据问题陈述，基线风险为 $r$。\n$$ P(\\text{Outcome}|U) = r $$\n疫苗效力 $VE$ 定义为接种疫苗组相对于未接种疫苗组的风险比例下降值。这在数学上表示为：\n$$ VE = \\frac{P(\\text{Outcome}|U) - P(\\text{Outcome}|V)}{P(\\text{Outcome}|U)} $$\n代入已知值 $P(\\text{Outcome}|U) = r$：\n$$ VE = \\frac{r - P(\\text{Outcome}|V)}{r} $$\n我们可以重新整理此方程，以求解接种疫苗组的风险 $P(\\text{Outcome}|V)$：\n$$ r \\cdot VE = r - P(\\text{Outcome}|V) $$\n$$ P(\\text{Outcome}|V) = r - r \\cdot VE = r(1 - VE) $$\n问题将最小临床重要差异 $MCID$ 定义为事件概率的绝对降低值。这等同于绝对风险降低 $ARR$。\n$$ MCID = ARR = P(\\text{Outcome}|U) - P(\\text{Outcome}|V) $$\n代入概率的表达式：\n$$ MCID = r - r(1 - VE) $$\n简化表达式可得 $MCID$ 的公式：\n$$ MCID = r - r + rVE $$\n$$ MCID = rVE $$\n这是第一个所需的表达式。\n\n接下来，我们推导需接种人数 $NNV$。$NNV$ 是为预防一例严重结局而需要接种疫苗的人数。它被定义为绝对风险降低 $ARR$ 的倒数。\n$$ NNV = \\frac{1}{ARR} $$\n既然我们已经确定 $ARR = MCID = rVE$，我们可以将其代入 $NNV$ 的方程中。\n$$ NNV = \\frac{1}{rVE} $$\n该表达式是第二个要求的结果。只要分母 $rVE$ 不为零，它就是有明确定义的。由于 $r \\in (0,1)$，只要 $VE > 0$，分母就不为零。如果 $VE=0$，则 $MCID$ 为 $0$，而 $NNV$ 变为无穷大，这表示效力为零的疫苗无法预防任何结局，这是一个一致且有意义的解释。\n\n推导出的两个表达式是：\n1.  $MCID = rVE$\n2.  $NNV = \\frac{1}{rVE}$", "answer": "$$ \\boxed{\\begin{pmatrix} rVE  \\frac{1}{rVE} \\end{pmatrix}} $$", "id": "4986269"}]}