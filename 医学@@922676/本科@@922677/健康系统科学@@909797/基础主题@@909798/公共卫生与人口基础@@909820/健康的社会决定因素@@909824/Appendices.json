{"hands_on_practices": [{"introduction": "在解决健康不平等的议题时，首要步骤是精确地衡量其程度。斜率不平等指数（Slope Index of Inequality, SII）是一个强有力的工具，它能以一个单一数值，概括在整个社会经济地位谱系中，健康结果的绝对差异。本练习将通过一个具体案例，指导你如何计算并解读SII，从而将健康的社会梯度这一抽象概念转化为一个可量化的指标 [@problem_id:4395936]。", "problem": "将一个人口划分为五个有序的收入五分位数，从最低收入 ($Q_1$) 到最高收入 ($Q_5$)，每个分位数包含相同比例的人口。观测到的这些五分位数的平均收缩压 (SBP)，从 $Q_1$ 到 $Q_5$ 的顺序依次为 $[140, 135, 130, 125, 120]$ 毫米汞柱 (mmHg)。使用由 ridit 分数衡量的相对社会经济地位的概念，将组 $i$ 的 ridit 分数 $r_i$ 定义为严格低于组 $i$ 的累积人口比例加上组 $i$ 中人口比例的一半。假设所有五分位数的人口份额相等。\n\n不平等斜率指数 (Slope Index of Inequality, SII) 定义为加权线性回归 $y_i = a + b\\,r_i$ 的斜率参数 $b$，其中 $y_i$ 是组 $i$ 的平均收缩压，$r_i$ 是组 $i$ 的 ridit 分数，权重是各组的人口份额。SII 被解释为收入分布底部 ($r=0$) 和顶部 ($r=1$) 之间预期收缩压的绝对差异；其符号表示梯度相对于收入等级增加的方向。\n\n从 ridit 评分和加权普通最小二乘法的定义出发，通过拟合 $y_i = a + b\\,r_i$ 并使用等于五分位数人口份额的权重来计算 SII。将 SII 报告为带符号的斜率 $b$。然后，以整个收入范围内 mmHg 的差异来解释绝对梯度 $|b|$。将 SII 的最终数值答案以毫米汞柱 (mmHg) 为单位表示，并四舍五入到四位有效数字。仅提供带符号的 SII $b$ 的数值以供评分。", "solution": "该问题要求计算一个被分层为五个有序收入五分位数的人口的不平等斜率指数 (SII)。SII 定义为平均健康结果对社会经济地位的加权线性回归的斜率参数 $b$。\n\n首先，我们确定给定的数据和参数。\n人口被划分为 $N=5$ 个五分位数，从最低收入 ($Q_1$) 到最高收入 ($Q_5$) 。\n每个五分位数 $i$ 的平均收缩压 (SBP)，记为 $y_i$，由向量给出：\n$$ \\mathbf{y} = [y_1, y_2, y_3, y_4, y_5] = [140, 135, 130, 125, 120] \\text{ mmHg} $$\n每个五分位数包含相等的人口份额，因此每个组 $i$ 的人口比例 $p_i$ 为：\n$$ p_i = \\frac{1}{5} = 0.2 $$\n这些比例作为加权线性回归的权重 $w_i$，因此对于所有 $i \\in \\{1, 2, 3, 4, 5\\}$，$w_i = p_i = 0.2$。权重之和为 $\\sum_{i=1}^5 w_i = 1$。\n\n接下来，我们必须计算每个五分位数的 ridit 分数 $r_i$。组 $i$ 的 ridit 分数定义为严格低于组 $i$ 的累积人口比例，加上组 $i$ 中人口比例的一半。\n令 $C_i = \\sum_{j=1}^{i-1} p_j$ 为低于组 $i$ 的累积比例。则 ridit 分数 $r_i$ 由下式给出：\n$$ r_i = C_i + \\frac{1}{2} p_i $$\n我们计算每个五分位数的 ridit 分数：\n对于 $Q_1$ ($i=1$)：其下的累积比例为 $C_1 = 0$。\n$$ r_1 = 0 + \\frac{1}{2}(0.2) = 0.1 $$\n对于 $Q_2$ ($i=2$)：其下的累积比例为 $C_2 = p_1 = 0.2$。\n$$ r_2 = 0.2 + \\frac{1}{2}(0.2) = 0.3 $$\n对于 $Q_3$ ($i=3$)：其下的累积比例为 $C_3 = p_1 + p_2 = 0.4$。\n$$ r_3 = 0.4 + \\frac{1}{2}(0.2) = 0.5 $$\n对于 $Q_4$ ($i=4$)：其下的累积比例为 $C_4 = p_1 + p_2 + p_3 = 0.6$。\n$$ r_4 = 0.6 + \\frac{1}{2}(0.2) = 0.7 $$\n对于 $Q_5$ ($i=5$)：其下的累积比例为 $C_5 = p_1 + p_2 + p_3 + p_4 = 0.8$。\n$$ r_5 = 0.8 + \\frac{1}{2}(0.2) = 0.9 $$\nridit 分数的向量为 $\\mathbf{r} = [0.1, 0.3, 0.5, 0.7, 0.9]$。\n\nSII 是加权线性回归模型 $y_i = a + b\\,r_i$ 的斜率 $b$。在加权普通最小二乘法 (WOLS) 回归中，斜率 $b$ 的公式为：\n$$ b = \\frac{\\sum_{i=1}^{N} w_i(r_i - \\bar{r}_w)(y_i - \\bar{y}_w)}{\\sum_{i=1}^{N} w_i(r_i - \\bar{r}_w)^2} $$\n其中 $\\bar{r}_w$ 和 $\\bar{y}_w$ 分别是 ridit 分数和 SBP 值的加权平均值。\n首先，我们计算这些加权平均值。由于 $\\sum w_i = 1$，公式为：\n$$ \\bar{r}_w = \\sum_{i=1}^{5} w_i r_i = 0.2(0.1 + 0.3 + 0.5 + 0.7 + 0.9) = 0.2(2.5) = 0.5 $$\n$$ \\bar{y}_w = \\sum_{i=1}^{5} w_i y_i = 0.2(140 + 135 + 130 + 125 + 120) = 0.2(650) = 130 $$\n现在，我们可以计算斜率 $b$ 的分子和分母。\n\n分子是 $r$ 和 $y$ 的加权协方差：\n$$ \\text{Numerator} = \\sum_{i=1}^{5} w_i(r_i - \\bar{r}_w)(y_i - \\bar{y}_w) $$\n$$ \\text{Numerator} = 0.2 \\sum_{i=1}^{5} (r_i - 0.5)(y_i - 130) $$\n$$ \\text{Numerator} = 0.2 [ (0.1 - 0.5)(140 - 130) + (0.3 - 0.5)(135 - 130) + (0.5 - 0.5)(130 - 130) + (0.7 - 0.5)(125 - 130) + (0.9 - 0.5)(120 - 130) ] $$\n$$ \\text{Numerator} = 0.2 [ (-0.4)(10) + (-0.2)(5) + (0)(0) + (0.2)(-5) + (0.4)(-10) ] $$\n$$ \\text{Numerator} = 0.2 [ -4.0 - 1.0 + 0 - 1.0 - 4.0 ] = 0.2(-10.0) = -2.0 $$\n\n分母是 $r$ 的加权方差：\n$$ \\text{Denominator} = \\sum_{i=1}^{5} w_i(r_i - \\bar{r}_w)^2 $$\n$$ \\text{Denominator} = 0.2 \\sum_{i=1}^{5} (r_i - 0.5)^2 $$\n$$ \\text{Denominator} = 0.2 [ (-0.4)^2 + (-0.2)^2 + (0)^2 + (0.2)^2 + (0.4)^2 ] $$\n$$ \\text{Denominator} = 0.2 [ 0.16 + 0.04 + 0 + 0.04 + 0.16 ] = 0.2(0.40) = 0.08 $$\n\n最后，我们计算斜率 $b$：\n$$ b = \\frac{\\text{Numerator}}{\\text{Denominator}} = \\frac{-2.0}{0.08} = -25 $$\n因此，SII 为 $-25 \\text{ mmHg}$。负号表示收入与收缩压之间存在反比关系；较高的收入与较低的收缩压相关。\n\nSII 的解释是社会经济层级理论上的顶部 ($r=1$) 和底部 ($r=0$) 之间结果变量的预测差异。这个差异由 $(a + b \\cdot 1) - (a + b \\cdot 0) = b$ 给出。因此，最高收入个体的预期收缩压比最低收入个体的预期收缩压低 $25 \\text{ mmHg}$。绝对梯度 $|b| = |-25| = 25 \\text{ mmHg}$ 代表了整个社会经济范围内这种健康不平等的幅度。\n\n问题要求提供带符号的 SII $b$ 的数值，并四舍五入到四位有效数字。\n$$ b = -25.00 $$", "answer": "$$ \\boxed{-25.00} $$", "id": "4395936"}, {"introduction": "在衡量了健康不平等的存在之后，我们进而希望探究其背后的驱动因素。健康的社会决定因素（SDOH）常常在群体层面发挥作用，例如，人们居住的社区环境。组内相关系数（Intraclass Correlation Coefficient, ICC）为我们提供了一种方法，用以衡量健康结果的总变异中，有多大比例可以归因于群体（如社区）之间的差异 [@problem_id:4395899]。通过这个练习，你将学会如何计算ICC，并借此理解“背景”或“环境”在塑造健康结果中的重要性。", "problem": "一个公共卫生团队正在研究作为健康核心社会决定因素的社区环境如何与收缩压相关。他们从嵌套在多个社区中的成年居民那里收集收缩压测量值，并拟合了一个形式为 $Y_{ij}=\\mu+u_{j}+\\varepsilon_{ij}$ 的随机截距线性混合模型，其中 $Y_{ij}$ 是社区 $j$ 中个体 $i$ 的收缩压，$u_{j}$ 是特定于社区的随机效应，而 $\\varepsilon_{ij}$ 是个体层面的残差。该模型假设 $u_{j}\\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{neigh}})$，$\\varepsilon_{ij}\\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{resid}})$，并且 $u_{j}$ 和 $\\varepsilon_{ij}$ 相互独立。估计的方差分量为 $\\sigma^{2}_{\\text{neigh}}=30 \\, \\text{mmHg}^{2}$ 和 $\\sigma^{2}_{\\text{resid}}=90 \\, \\text{mmHg}^{2}$。使用组内相关系数（ICC）的核心定义（该定义在此模型中量化了可归因于社区间差异的总结果方差的比例），计算社区的ICC。请以小数形式表示您的答案，并且不要四舍五入（提供精确值）。然后，用一句话解释在健康社会决定因素的背景下，这个值对于社区内收缩压的聚集性意味着什么。您的最终数值答案必须仅为ICC值。", "solution": "该问题要求根据一个给定的随机截距线性混合模型，计算并解释组内相关系数（ICC）。模型指定为：\n$$Y_{ij} = \\mu + u_j + \\varepsilon_{ij}$$\n其中 $Y_{ij}$ 表示社区 $j$ 中个体 $i$ 的收缩压，$\\mu$ 是总体平均收缩压，$u_j$ 是社区 $j$ 的随机效应，而 $\\varepsilon_{ij}$ 是个体层面的残差。\n\n随机分量的假设如下：\n1.  特定于社区的随机效应 $u_j$ 服从均值为 $0$、方差为 $\\sigma^{2}_{\\text{neigh}}$ 的正态分布：$u_{j}\\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{neigh}})$。这个方差 $\\sigma^{2}_{\\text{neigh}}$ 代表社区间方差。\n2.  个体层面的残差 $\\varepsilon_{ij}$ 服从均值为 $0$、方差为 $\\sigma^{2}_{\\text{resid}}$ 的正态分布：$\\varepsilon_{ij}\\sim \\mathcal{N}(0,\\sigma^{2}_{\\text{resid}})$。这个方差 $\\sigma^{2}_{\\text{resid}}$ 代表社区内（或残差）方差。\n3.  随机效应 $u_j$ 和残差 $\\varepsilon_{ij}$ 是独立的。\n\n个体收缩压测量值 $Y_{ij}$ 的总方差可以被分解。由于 $\\mu$ 是一个常数，其方差为 $0$。由于 $u_j$ 和 $\\varepsilon_{ij}$ 的独立性，它们的和的方差等于它们各自方差的和。\n$$\\text{Var}(Y_{ij}) = \\text{Var}(\\mu + u_j + \\varepsilon_{ij}) = \\text{Var}(u_j) + \\text{Var}(\\varepsilon_{ij})$$\n因此，总方差 $\\sigma^{2}_{\\text{total}}$ 为：\n$$\\sigma^{2}_{\\text{total}} = \\sigma^{2}_{\\text{neigh}} + \\sigma^{2}_{\\text{resid}}$$\n\n问题将组内相关系数（ICC）定义为可归因于社区间差异的总结果方差的比例。这与两水平随机截距模型中ICC的标准定义相对应。在数学上，它是组间（社区）方差与总方差的比率。\n$$\\text{ICC} = \\frac{\\sigma^{2}_{\\text{neigh}}}{\\sigma^{2}_{\\text{total}}} = \\frac{\\sigma^{2}_{\\text{neigh}}}{\\sigma^{2}_{\\text{neigh}} + \\sigma^{2}_{\\text{resid}}}$$\n\n问题提供了估计的方差分量：\n-   社区间方差：$\\sigma^{2}_{\\text{neigh}} = 30 \\, \\text{mmHg}^{2}$\n-   社区内方差：$\\sigma^{2}_{\\text{resid}} = 90 \\, \\text{mmHg}^{2}$\n\n将这些值代入ICC的公式中：\n$$\\text{ICC} = \\frac{30}{30 + 90} = \\frac{30}{120}$$\n化简该分数可得精确的小数值：\n$$\\text{ICC} = \\frac{1}{4} = 0.25$$\n\n问题还要求对这个值进行一句话的解释。ICC为 $0.25$ 表明收缩压总变异的 $25\\%$ 可归因于社区间的差异。在健康社会决定因素的背景下，这个值意味着个体所居住的社区解释了其收缩压变异性的很大一部分，从而强调了其作为健康社会决定因素的重要性。", "answer": "$$\\boxed{0.25}$$", "id": "4395899"}, {"introduction": "在研究中发现某个社会决定因素与健康结果之间存在关联后，严谨的科学态度要求我们对其进行批判性审视。一个常见的挑战是“未测量的混杂因素”可能会歪曲我们的结论。E值（E-value）是一种重要的敏感性分析工具，它帮助我们回答一个关键问题：“一个未测量的混杂因素需要有多强，才能完全解释掉我们观察到的关联？”[@problem_id:4575881]。本练习将引导你计算E值，从而量化研究结论在面对潜在偏倚时的稳健性。", "problem": "某市公共卫生部门进行了一项前瞻性队列研究，以评估住房不稳定性（暴露 $E$）与一年内后续住院（结局 $Y$）之间的关联。住房不稳定性根据标准化标准（多次搬家、驱逐威胁或无家可归）定义，住院情况通过关联的卫生系统记录进行测量。该研究估计，在控制了已测量的混杂因素（年龄、性别、基线合并症和保险状况）后，住房不稳定性与住院之间关联的校正风险比（RR）为 $RR=2.4$。为了评估该观测关联对潜在未测量混杂的稳健性，该部门希望计算 E-value。\n\n从风险比和混杂概念的基本流行病学定义出发，将风险比的 E-value 定义为：在没有其他偏倚的情况下，一个未测量的混杂因素在风险比尺度上需要与暴露和结局（在已测量协变量的条件下）同时具有的最小关联强度，才能完全解释掉观察到的关联（即将观察到的 $RR$ 降至 $1$）。推导 E-value 关于观察到的 $RR$ 的闭式表达式，并计算当 $RR=2.4$ 时的值。\n\n将您的最终数值答案表示为一个纯数（无量纲），并四舍五入到 $3$ 位有效数字。", "solution": "本题要求定义和推导观察到的风险比（$RR$）的 E-value，然后针对一个具体案例进行计算。\n\n**1. 形式化定义与设定**\n设 $E$ 为二元暴露（$E=1$ 表示暴露，$E=0$ 表示未暴露），$Y$ 为二元结局（$Y=1$ 表示出现结局，$Y=0$ 表示未出现）。经测量混杂因素校正后的观察风险比记为 $RR_{obs}$。\n$$\nRR_{obs} = \\frac{P(Y=1|E=1)}{P(Y=1|E=0)} = 2.4\n$$\n设 $U$ 是一个单一的未测量的二元混杂因素（$U=1$ 表示存在，$U=0$ 表示不存在）。$U$ 的存在会使观察到的关联产生偏倚。观察到的风险比（$RR_{obs}$）与真实因果风险比（$RR_{true}$）之间的关系可以表示为 $RR_{obs} = RR_{true} \\times B$，其中 $B$ 是偏倚因子。本题要求我们找出能够“解释掉”观察关联的条件，这意味着真实的因果风险比 $RR_{true} = 1$。在这种情况下，观察到的风险比完全由偏倚引起，因此 $RR_{obs} = B$。\n\n偏倚因子 $B$ 取决于混杂因素 $U$ 与暴露 $E$ 之间以及混杂因素 $U$ 与结局 $Y$ 之间关联的强度。我们来定义这些关联：\n- $RR_{UY}$：在暴露 $E$ 的条件下，混杂因素 $U$ 与结局 $Y$ 之间关联的风险比。假设该值在 $E$ 的不同分层中是恒定的，则 $RR_{UY} = \\frac{P(Y=1|U=1, E=e)}{P(Y=1|U=0, E=e)}$，对于 $e \\in \\{0, 1\\}$。\n- $RR_{EU}$：衡量混杂因素 $U$ 与暴露 $E$ 之间关联的风险比。在此推导中，我们可将其定义为患病率比，即 $RR_{EU} = \\frac{P(U=1|E=1)}{P(U=1|E=0)}$。设 $p_1 = P(U=1|E=1)$ 且 $p_0 = P(U=1|E=0)$，因此 $RR_{EU} = p_1/p_0$。\n\n**2. 偏倚因子的推导**\n如果真实的风险比 $RR_{true} = 1$，则在混杂因素 $U$ 的各分层内，暴露 $E$ 对结局 $Y$ 没有影响。也就是说，$P(Y=1|E=1, U=u) = P(Y=1|E=0, U=u)$，对于 $u \\in \\{0, 1\\}$。\n\n观察到的风险比可以通过对 $U$ 的各分层求和来表示：\n$$\nRR_{obs} = \\frac{P(Y=1|E=1)}{P(Y=1|E=0)} = \\frac{P(Y=1|U=1,E=1)P(U=1|E=1) + P(Y=1|U=0,E=1)P(U=0|E=1)}{P(Y=1|U=1,E=0)P(U=1|E=0) + P(Y=1|U=0,E=0)P(U=0|E=0)}\n$$\n使用我们的定义和 $RR_{true}=1$ 的假设：\n$$\nRR_{obs} = \\frac{P(Y=1|U=1,E=0)p_1 + P(Y=1|U=0,E=0)(1-p_1)}{P(Y=1|U=1,E=0)p_0 + P(Y=1|U=0,E=0)(1-p_0)}\n$$\n我们将分子和分母同时除以 $P(Y=1|U=0,E=0)$：\n$$\nRR_{obs} = \\frac{\\frac{P(Y=1|U=1,E=0)}{P(Y=1|U=0,E=0)}p_1 + (1-p_1)}{\\frac{P(Y=1|U=1,E=0)}{P(Y=1|U=0,E=0)}p_0 + (1-p_0)} = \\frac{RR_{UY}p_1 + 1-p_1}{RR_{UY}p_0 + 1-p_0}\n$$\n这个表达式可以改写为：\n$$\nRR_{obs} = \\frac{p_1(RR_{UY}-1)+1}{p_0(RR_{UY}-1)+1}\n$$\n\n**3. 应用 E-value 的定义**\nE-value 定义为混杂因素 $U$ 必须与暴露 $E$ 和结局 $Y$ 同时具有的、能够解释掉观察风险比的最小关联强度 $\\gamma$。这意味着我们设 $RR_{EU} = \\gamma$ 和 $RR_{UY} = \\gamma$。\n\n将 $RR_{UY} = \\gamma$ 和 $p_1 = p_0 \\cdot RR_{EU} = p_0\\gamma$ 代入我们的偏倚方程：\n$$\nRR_{obs} = \\frac{p_0\\gamma(\\gamma-1)+1}{p_0(\\gamma-1)+1}\n$$\n我们需要找到最小的 $\\gamma  1$，使得该方程对于某个有效的概率 $p_0$ 成立。概率 $p_0$ 必须满足 $0 \\le p_0 \\le 1$。此外，由于 $p_1$ 也是一个概率，我们必须有 $p_1 = p_0\\gamma \\le 1$，这意味着 $p_0 \\le 1/\\gamma$。因此，我们在区间 $[0, 1/\\gamma]$ 内寻求 $p_0$ 的解。\n\n我们求解关于 $p_0$ 的方程：\n$$\np_0 = \\frac{RR_{obs} - 1}{(\\gamma-1)(\\gamma - RR_{obs})}\n$$\n为了使 $p_0$ 是一个有效的概率，我们必须有 $p_0  0$。由于 $RR_{obs} = 2.4  1$ 并且我们寻求 $\\gamma  1$，分子 $(RR_{obs} - 1)$ 和因子 $(\\gamma-1)$ 都是正数。因此，要使 $p_0  0$，我们必须有 $(\\gamma - RR_{obs})  0$，这意味着 $\\gamma  RR_{obs}$。\n\n现在我们应用第二个约束条件，$p_0 \\le 1/\\gamma$：\n$$\n\\frac{RR_{obs} - 1}{(\\gamma-1)(\\gamma - RR_{obs})} \\le \\frac{1}{\\gamma}\n$$\n整理后得到一个关于 $\\gamma$ 的二次不等式：\n$$\n\\gamma^2 - 2\\gamma RR_{obs} + RR_{obs} \\ge 0\n$$\n我们正在寻找满足此不等式且符合条件 $\\gamma  RR_{obs}$ 的 $\\gamma$ 的最小值。$\\gamma$ 的最小可能值将出现在解集的边界上，即等式成立的地方：\n$$\n\\gamma^2 - (2RR_{obs})\\gamma + RR_{obs} = 0\n$$\n使用二次公式求解 $\\gamma$：\n$$\n\\gamma = RR_{obs} \\pm \\sqrt{RR_{obs}(RR_{obs}-1)}\n$$\n我们得到两个解。然而，我们之前已经确定了必要条件 $\\gamma  RR_{obs}$。对于 $RR_{obs}1$，解 $\\gamma_1 = RR_{obs} + \\sqrt{RR_{obs}(RR_{obs}-1)}$ 总是大于 $RR_{obs}$。因此，唯一允许存在有效混杂因素患病率 $p_0$ 的物理上合理的解是较大的根。这代表了 $\\gamma$ 必须达到的、用以解释观察风险比的最小值。\n\n推导出的 E-value 表达式为：\n$$\n\\text{E-value} = RR_{obs} + \\sqrt{RR_{obs}(RR_{obs}-1)}\n$$\n\n**4. 计算**\n给定观察到的风险比 $RR_{obs} = 2.4$，我们现在可以计算 E-value。\n$$\n\\text{E-value} = 2.4 + \\sqrt{2.4(2.4-1)}\n$$\n$$\n\\text{E-value} = 2.4 + \\sqrt{2.4 \\times 1.4}\n$$\n$$\n\\text{E-value} = 2.4 + \\sqrt{3.36}\n$$\n$$\n\\text{E-value} \\approx 2.4 + 1.83303027...\n$$\n$$\n\\text{E-value} \\approx 4.23303027...\n$$\n四舍五入到 $3$ 位有效数字，得到 $4.23$。\n\n这个结果意味着，一个未测量的混杂因素，如果它与住房不稳定性和住院的关联（在已测量协变量的条件下）的风险比均至少为 $4.23$，就足以完全解释掉观察到的 $2.4$ 的风险比。反之，如果认为不存在这样的混杂因素，那么该关联对于较小强度的未测量混杂是稳健的。", "answer": "$$\\boxed{4.23}$$", "id": "4575881"}]}