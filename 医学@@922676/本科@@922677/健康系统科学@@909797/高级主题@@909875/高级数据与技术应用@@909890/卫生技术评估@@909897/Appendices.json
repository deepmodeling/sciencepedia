{"hands_on_practices": [{"introduction": "卫生技术评估通常涉及在结果不确定的情况下比较不同策略。本练习介绍了预期成本这一基本概念，它是一个强大的工具，通过将每种可能的成本与其发生的概率进行加权，来总结决策可能带来的财务后果。通过解决这个问题 [@problem_id:4534999]，你将学会运用概率论原理，对两种不同的公共卫生方法进行清晰的比较。", "problem": "一家公共卫生机构正在从支付方的角度对一项预防性干预措施进行卫生技术评估 (HTA)，评估期限为$1$年，忽略贴现。针对面临特定急性事件风险的人群，正在比较两种互斥策略：“治疗”与“不治疗”。“治疗”策略会产生每人$\\$500$的前期实施成本，并带有每人$0.05$的并发症风险；如果发生并发症，则会产生每人$\\$10000$的额外成本。“不治疗”策略没有前期实施成本，但带有每人$0.02$的事件风险；如果事件发生，则会产生每人$\\$30000$的成本。假设在评估期内，每个人最多只发生一次结果（并发症或事件），并且风险和成本在不同个体间是独立的。使用概率论中期望值的基本定义和卫生技术评估 (HTA) 中的标准成本汇总方法，计算每种策略下的人均期望成本。最终答案以美元 (USD) 表示。如果选择四舍五入，请保留四位有效数字。请按“治疗”、“不治疗”的顺序提供最终的期望成本对。", "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它为卫生技术评估 (HTA) 中的一个标准成本分析问题提供了一套完整且一致的数据，该问题基于概率论的基本原理。\n\n任务是计算“治疗”和“不治疗”这两种互斥策略的人均期望成本。离散随机变量的期望值是该变量每个可能值与其相应概率的乘积之和。令 $E[C]$ 表示期望成本。\n\n让我们定义“治疗”策略的参数，用下标 $T$ 表示。\n人均前期实施成本为 $C_{T, \\text{upfront}} = \\$500$。\n发生并发症的概率为 $p_{\\text{comp}} = 0.05$。\n发生并发症时产生的成本为 $C_{\\text{comp}} = \\$10000$。\n\n在“治疗”策略下，一个人的成本是一个随机变量 $C_T$。根据问题中最多只发生一次结果的假设，有两种可能的结果：\n$1$. 发生并发症。总成本是前期成本与并发症成本之和：$C_{T,1} = C_{T, \\text{upfront}} + C_{\\text{comp}} = \\$500 + \\$10000 = \\$10500$。此结果的概率为 $p_{\\text{comp}} = 0.05$。\n$2$. 不发生并发症。总成本仅为前期成本：$C_{T,2} = C_{T, \\text{upfront}} = \\$500$。此结果的概率为 $1 - p_{\\text{comp}} = 1 - 0.05 = 0.95$。\n\n“治疗”策略的人均期望成本 $E[C_T]$ 计算如下：\n$$ E[C_T] = C_{T,1} \\cdot p_{\\text{comp}} + C_{T,2} \\cdot (1 - p_{\\text{comp}}) $$\n代入数值：\n$$ E[C_T] = (\\$10500) \\cdot (0.05) + (\\$500) \\cdot (0.95) $$\n$$ E[C_T] = \\$525 + \\$475 = \\$1000 $$\n或者，利用期望的线性性质，期望成本是确定的前期成本加上并发症的期望成本：\n$$ E[C_T] = C_{T, \\text{upfront}} + (C_{\\text{comp}} \\cdot p_{\\text{comp}} + \\$0 \\cdot (1 - p_{\\text{comp}})) $$\n$$ E[C_T] = \\$500 + (\\$10000 \\cdot 0.05) = \\$500 + \\$500 = \\$1000 $$\n\n接下来，我们定义“不治疗”策略的参数，用下标 $NT$ 表示。\n前期实施成本为 $C_{NT, \\text{upfront}} = \\$0$。\n发生急性事件的概率为 $p_{\\text{event}} = 0.02$。\n事件发生时产生的成本为 $C_{\\text{event}} = \\$30000$。\n\n在“不治疗”策略下，一个人的成本是一个随机变量 $C_{NT}$。有两种可能的结果：\n$1$. 事件发生。总成本为 $C_{NT,1} = C_{\\text{event}} = \\$30000$。此结果的概率为 $p_{\\text{event}} = 0.02$。\n$2$. 事件不发生。总成本为 $C_{NT,2} = \\$0$。此结果的概率为 $1 - p_{\\text{event}} = 1 - 0.02 = 0.98$。\n\n“不治疗”策略的人均期望成本 $E[C_{NT}]$ 计算如下：\n$$ E[C_{NT}] = C_{NT,1} \\cdot p_{\\text{event}} + C_{NT,2} \\cdot (1 - p_{\\text{event}}) $$\n代入数值：\n$$ E[C_{NT}] = (\\$30000) \\cdot (0.02) + (\\$0) \\cdot (0.98) $$\n$$ E[C_{NT}] = \\$600 + \\$0 = \\$600 $$\n\n计算得出的期望成本为：“治疗”策略$\\$1000$，“不治疗”策略$\\$600$。结果是精确整数，因此无需四舍五入。问题要求按“治疗”、“不治疗”的顺序提供最终的期望成本对。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1000  600\n\\end{pmatrix}\n}\n$$", "id": "4534999"}, {"introduction": "当我们了解了不同健康干预措施的成本和效果后，我们需要一种系统性的方法来对它们进行比较。本实践介绍了增量成本效果比（ICER），这是成本效果分析的基石，它衡量了每获得一个额外健康单位（如质量调整生命年，QALY）所需付出的额外成本。通过计算ICER并应用决策规则 [@problem_id:4535048]，你将亲身体验全球范围内用于判断一项新技术是否物有所值的核心指标。", "problem": "一家公共卫生机构正在对两种预防性干预措施 A 和 B 进行卫生技术评估 (HTA)，每种措施都相对于一个标准基线进行评估。干预措施 A 的总成本和效果由数对 $\\left(C_{A}, E_{A}\\right) = \\left(\\$8000, 0.4\\ \\text{质量调整生命年 (QALYs)}\\right)$ 表示，干预措施 B 的总成本和效果为 $\\left(C_{B}, E_{B}\\right) = \\left(\\$11500, 0.7\\ \\text{QALYs}\\right)$。使用增量成本效果比 (ICER) 的基本定义，即比较一个选项相对于另一个选项的增量成本与增量效果，计算 B 相对于 A 的 ICER，单位为美元/质量调整生命年 ($\\$/\\text{QALY}$)。然后，使用每 QALY $\\$40000$ 美元的标准支付意愿阈值 $\\lambda$，根据常规决策规则（如果一个选项的每 QALY 增量成本不超过 $\\lambda$，则接受该选项），在假设增量效果为正的情况下，判断 B 相对于 A 是否具有成本效益。\n\n以 $\\$/\\text{QALY}$ 为单位表示 ICER，并将您的数值结果四舍五入到四位有效数字。您提供的最终答案必须仅为 ICER 的单个数值；不要在最终的方框答案中包含单位。", "solution": "问题根据既定标准进行验证。\n\n### 第 1 步：提取已知信息\n- 干预措施 A：成本 $C_{A} = \\$8000$，效果 $E_{A} = 0.4$ 质量调整生命年 (QALYs)。\n- 干预措施 B：成本 $C_{B} = \\$11500$，效果 $E_{B} = 0.7$ QALYs。\n- 支付意愿阈值：$\\lambda = \\$40000$ 每 QALY。\n- 目标 1：计算 B 相对于 A 的增量成本效果比 (ICER)。\n- 目标 2：使用阈值 $\\lambda$ 判断 B 相对于 A 是否具有成本效益。\n- 四舍五入要求：最终的 ICER 数值需四舍五入到四位有效数字。\n\n### 第 2 步：使用提取的已知信息进行验证\n该问题具有科学依据，提法明确且客观。它运用了卫生技术评估 (HTA) 的基本概念，包括增量成本效果比 (ICER)、质量调整生命年 (QALYs) 和支付意愿阈值，这些都是卫生经济学和预防医学中的标准指标。所提供的数据 ($C_A, E_A, C_B, E_B, \\lambda$) 完整、一致，并且对于真实世界的情景是合理的。问题陈述清晰，所有术语都有定义，没有歧义。它要求一个具体的可计算量和一个基于正式规则的决策。因此，该问题被认为是有效的。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n主要任务是计算干预措施 B 相对于干预措施 A 的增量成本效果比 (ICER)。ICER 定义为两种备选干预措施之间总成本变化与总效果变化的比率。\n\n干预措施 B 与干预措施 A 相比的 ICER 公式如下：\n$$\n\\text{ICER}_{B \\text{ vs } A} = \\frac{\\Delta C}{\\Delta E} = \\frac{C_B - C_A}{E_B - E_A}\n$$\n其中 $\\Delta C$ 是增量成本，$\\Delta E$ 是增量效果。\n\n给定值为：\n- 对于干预措施 A：$C_A = 8000$ 美元， $E_A = 0.4$ QALYs。\n- 对于干预措施 B：$C_B = 11500$ 美元， $E_B = 0.7$ QALYs。\n\n首先，我们计算增量成本 $\\Delta C$：\n$$\n\\Delta C = C_B - C_A = \\$11500 - \\$8000 = \\$3500\n$$\n\n接着，我们计算增量效果 $\\Delta E$：\n$$\n\\Delta E = E_B - E_A = 0.7 \\text{ QALYs} - 0.4 \\text{ QALYs} = 0.3 \\text{ QALYs}\n$$\n\n由于增量效果 $\\Delta E = 0.3$ 为正，干预措施 B 比干预措施 A 更有效，ICER 可以被有意义地解释为每增加一个单位健康收益所需的额外成本。\n\n现在，我们计算 ICER：\n$$\n\\text{ICER} = \\frac{\\Delta C}{\\Delta E} = \\frac{\\$3500}{0.3 \\text{ QALYs}} = 11666.666... \\frac{\\$}{\\text{QALY}}\n$$\n\n题目要求将此结果四舍五入到四位有效数字。前四位有效数字是 $1, 1, 6, 6$。第五位数字是 $6$，大于或等于 $5$，所以我们将第四位数字向上取整。\n$$\n\\text{ICER}_{\\text{rounded}} \\approx 11670 \\frac{\\$}{\\text{QALY}}\n$$\n\n任务的第二部分是判断干预措施 B 相对于 A 是否具有成本效益。决策规则规定，如果一项干预措施的 ICER 不超过支付意愿阈值 $\\lambda$，则认为该干预具有成本效益。这表示为：\n$$\n\\text{ICER} \\le \\lambda\n$$\n\n给定的支付意愿阈值为 $\\lambda = \\$40000$ 每 QALY。我们将我们计算出的 ICER 与此阈值进行比较：\n$$\n11666.666... \\frac{\\$}{\\text{QALY}} \\le \\$40000 \\frac{\\$}{\\text{QALY}}\n$$\n这个不等式成立。由于 B 相对于 A 的 ICER 小于指定的支付意愿阈值，因此在此决策框架下，判定干预措施 B 相较于干预措施 A 具有成本效益。\n\n题目要求提供 ICER 的单个数值，并四舍五入到四位有效数字。", "answer": "$$\\boxed{11670}$$", "id": "4535048"}, {"introduction": "许多健康状况和干预措施的效果会随时间推移而长期显现。为了捕捉这些长期动态，卫生技术评估依赖于模拟模型。本动手练习将指导你实现一个马尔可夫模型，这是一个基础工具，用于模拟患者队列随时间在不同健康状态之间的转换。通过编写这个模型 [@problem_id:4374956]，你将学会预测如生存率和累积成本等关键的长期结果，这些都是进行复杂卫生经济学评估所必需的重要输入数据。", "problem": "马尔可夫队列模型在卫生技术评估（HTA）中用于估计离散时间周期内的预期临床和经济结果。考虑一个简单的三状态马尔可夫模型，其状态为健康（$H$）、患病（$S$）和死亡（$D$）。该过程是时间同质的，年度周期长度为$1$年。队列在时间$t=0$时从健康状态开始，初始状态占据向量为$\\pi_0 = [1,0,0]$。死亡状态是吸收态。队列的演变遵循马尔可夫性质和状态转移矩阵$P$，因此每个周期的占据向量根据$\\pi_{t+1} = \\pi_t P$进行更新。\n\n该模型使用以下基本定义：\n- 转移矩阵$P$的健康行由年转移概率$p_{HS}$（从健康到患病）、$p_{HD}$（从健康到死亡）以及剩余概率$p_{HH} = 1 - p_{HS} - p_{HD}$（保持健康）定义，其中$0 \\le p_{HS} \\le 1$，$0 \\le p_{HD} \\le 1$，且$p_{HS} + p_{HD} \\le 1$。\n- 患病行由$p_{SD}$（从患病到死亡）和$p_{SS} = 1 - p_{SD}$（保持患病）定义。在这个简化模型中，不允许从患病状态转移到健康状态。\n- 死亡行是吸收态：$p_{DD} = 1$ 且 $p_{DH} = p_{DS} = 0$。\n- 每个周期的状态特定成本被指定为健康状态的$c_H$、患病状态的$c_S$和死亡状态的$c_D$，单位均为美元（USD）/人/年。\n\n基于这些定义：\n- $5$年生存率定义为在$5$个周期结束时存活的概率，即$S_5 = \\pi_5(H) + \\pi_5(S)$，其中$\\pi_5 = \\pi_0 P^5$。\n- $5$个周期内的总未贴现预期成本是每个周期预期成本的总和，$C_5 = \\sum_{t=0}^{4} \\pi_t \\cdot c$，其中$c = [c_H, c_S, c_D]$且$\\cdot$表示点积。成本在每个周期开始时累积（无半周期校正，无贴现）。\n\n您的任务是实现一个程序，在给定$p_{HS}$、$p_{SD}$、$p_{HD}$和成本向量$[c_H,c_S,c_D]$的情况下，计算队列的$5$年生存率$S_5$和总成本$C_5$。将生存率表示为四舍五入到$6$位小数的小数，将成本表示为四舍五入到$2$位小数的美元数值。角度不适用。不得使用百分比。\n\n测试套件：\n为以下参数集提供计算（所有成本单位均为美元/人/年）：\n1. $p_{HS} = 0.1$，$p_{SD} = 0.2$，$p_{HD} = 0.02$，$[c_H,c_S,c_D] = [500,3000,0]$。\n2. $p_{HS} = 0$，$p_{SD} = 0.2$，$p_{HD} = 0$，$[c_H,c_S,c_D] = [100,1000,0]$。\n3. $p_{HS} = 0.05$，$p_{SD} = 0.5$，$p_{HD} = 0.9$，$[c_H,c_S,c_D] = [200,2000,0]$。\n4. $p_{HS} = 0.3$，$p_{SD} = 0$，$p_{HD} = 0.05$，$[c_H,c_S,c_D] = [400,1500,0]$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素都是一个双项列表$[S_5,C_5]$，按顺序对应于测试用例。例如，输出格式为$[[s_1,c_1],[s_2,c_2],[s_3,c_3],[s_4,c_4]]$，所有数值均按指定要求四舍五入。", "solution": "该问题要求实现一个三状态离散时间马尔可夫队列模型，以计算两个关键结果：$5$年生存率（$S_5$）和总$5$周期未贴现预期成本（$C_5$）。该模型包含三个状态：健康（$H$）、患病（$S$）和死亡（$D$）。该过程由年度周期定义，队列将被跟踪$5$年。\n\n控制系统演变的基本数学对象是状态转移矩阵$P$。状态按$[H, S, D]$排序。矩阵$P$是一个$3 \\times 3$的右随机矩阵，其中元素$P_{ij}$表示在一个周期内从状态$i$转移到状态$j$的概率。问题提供了构建此矩阵所需的参数。\n- 第一行对应于从健康状态的转移。给定转移到患病状态的年概率$p_{HS}$和转移到死亡状态的年概率$p_{HD}$，保持健康状态的概率$p_{HH}$由行概率之和必须为$1$的事实推导得出。因此，$p_{HH} = 1 - p_{HS} - p_{HD}$。$P$的第一行是$[1 - p_{HS} - p_{HD}, p_{HS}, p_{HD}]$。\n- 第二行对应于从患病状态的转移。问题指出不可能恢复到健康状态，因此$p_{SH}=0$。给定从患病状态死亡的概率$p_{SD}$，保持患病状态的概率$p_{SS}$为$1 - p_{SD}$。$P$的第二行是$[0, 1 - p_{SD}, p_{SD}]$。\n- 第三行对应于死亡状态，这是一个吸收态。处于此状态的个体以概率$1$保持在该状态。因此，$P$的第三行是$[0, 0, 1]$。\n\n因此，完整的转移矩阵$P$为：\n$$\nP = \\begin{pmatrix}\n1 - p_{HS} - p_{HD} & p_{HS} & p_{HD} \\\\\n0 & 1 - p_{SD} & p_{SD} \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n在每个周期$t$开始时，队列在各个状态的分布由状态占据向量$\\pi_t = [\\pi_t(H), \\pi_t(S), \\pi_t(D)]$表示。在时间$t=0$时，整个队列都处于健康状态，因此初始向量为$\\pi_0 = [1, 0, 0]$。状态向量根据马尔可夫性质随时间演变：$\\pi_{t+1} = \\pi_t P$。这也可以表示为$\\pi_t = \\pi_0 P^t$。\n\n$5$个周期内的总未贴现预期成本$C_5$是在每个周期开始时（从$t=0$到$t=4$）累积的预期成本之和。从时间$t$开始的单个周期的成本是状态占据向量$\\pi_t$和状态成本向量$c = [c_H, c_S, c_D]^T$的点积。总成本为：\n$$\nC_5 = \\sum_{t=0}^{4} (\\pi_t \\cdot c)\n$$\n为了计算这个值，我们可以使用一个迭代算法。我们从$\\pi_0 = [1, 0, 0]$和一个初始化为零的总成本开始。对于从$0$到$4$的每个周期$t$，我们计算该周期的成本，将其加到我们的运行总和中，然后将状态向量更新为$\\pi_{t+1}$以用于下一个周期。\n\n$5$年生存率$S_5$是在第五个周期结束时存活（处于状态$H$或$S$）的队列比例。这对应于时间点$t=5$。此时的状态占据向量是$\\pi_5$。生存概率是处于健康或患病状态的概率之和：\n$$\nS_5 = \\pi_5(H) + \\pi_5(S)\n$$\n状态向量$\\pi_5$是在从初始状态经过$5$次转移后得到的，即$\\pi_5 = \\pi_0 P^5$。该向量是在用于成本计算的迭代循环完成后得到的最终状态占据向量。\n\n每个测试用例的总体算法如下：\n1. 使用提供的参数构建矩阵$P$和成本向量$c$。`numpy`库适合此任务。\n2. 初始化状态向量$\\pi = [1.0, 0.0, 0.0]$和总成本$C_{total} = 0.0$。\n3. 对$t$从$0$到$4$进行循环：\n    a. 计算当前周期的成本：$\\text{cost}_{\\text{cycle}} = \\pi \\cdot c$。\n    b. 将此成本加到总成本中：$C_{total} = C_{total} + \\text{cost}_{\\text{cycle}}$。\n    c. 为下一个周期更新状态向量：$\\pi = \\pi P$。\n4. 循环终止后，最终的状态向量是$\\pi_5$。计算生存率为$S_5 = \\pi[0] + \\pi[1]$。总成本为$C_5 = C_{total}$。\n5. 按照规定，将$S_5$四舍五入到$6$位小数，将$C_5$四舍五入到$2$位小数。然后将结果格式化以用于最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes 5-year survival and total 5-cycle cost for a three-state Markov model\n    based on a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (p_HS, p_SD, p_HD, costs_vector)\n    test_cases = [\n        (0.1, 0.2, 0.02, [500, 3000, 0]),\n        (0.0, 0.2, 0.0, [100, 1000, 0]),\n        (0.05, 0.5, 0.9, [200, 2000, 0]),\n        (0.3, 0.0, 0.05, [400, 1500, 0]),\n    ]\n\n    results = []\n    for case in test_cases:\n        p_hs, p_sd, p_hd, costs_list = case\n        costs = np.array(costs_list)\n        \n        # 1. Construct the transition matrix P\n        p_hh = 1.0 - p_hs - p_hd\n        p_ss = 1.0 - p_sd\n        \n        P = np.array([\n            [p_hh, p_hs, p_hd],\n            [0.0,  p_ss, p_sd],\n            [0.0,  0.0,  1.0]\n        ])\n\n        # 2. Initialize state vector and total cost\n        pi_current = np.array([1.0, 0.0, 0.0]) # pi_0\n        total_cost = 0.0\n        num_cycles = 5\n\n        # 3. Loop through cycles to calculate total cost and final state vector\n        for _ in range(num_cycles): # t = 0, 1, 2, 3, 4\n            # Accrue cost at the start of the cycle\n            cycle_cost = np.dot(pi_current, costs)\n            total_cost += cycle_cost\n            \n            # Update state vector for the next cycle\n            pi_current = np.dot(pi_current, P)\n\n        # After the loop, pi_current is pi_5\n        pi_5 = pi_current\n        \n        # 4. Calculate 5-year survival (S_5)\n        # S_5 is the probability of being in state H or S at t=5\n        survival_5_year = pi_5[0] + pi_5[1]\n        \n        # 5. Round the results as specified\n        s5_rounded = round(survival_5_year, 6)\n        c5_rounded = round(total_cost, 2)\n        \n        results.append([s5_rounded, c5_rounded])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists matches the required format.\n    print(f\"{results}\")\n\nsolve()\n```", "id": "4374956"}]}