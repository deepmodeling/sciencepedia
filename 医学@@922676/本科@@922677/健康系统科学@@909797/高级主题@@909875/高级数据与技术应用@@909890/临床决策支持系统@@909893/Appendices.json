{"hands_on_practices": [{"introduction": "临床决策支持系统 (CDSS) 的核心功能之一是帮助临床医生解读诊断测试结果。此练习将让您亲手实践应用贝叶斯定理，根据新的测试信息来更新对患者患病可能性的判断 ([@problem_id:4826791])。掌握这项技能对于在证据驱动的临床环境中量化不确定性至关重要。", "problem": "一个临床决策支持系统 (CDSS) 被配置用于辅助对一种二元状况（记为 $D$）进行决策，该决策基于一项单一诊断测试，其结果为阳性 ($+$) 或阴性 ($-$)。该CDSS使用以下经过充分检验的定义：灵敏度，记为 $p(+\\mid D)$，是指在患病情况下测试结果为阳性的概率；特异度，记为 $p(-\\mid D^{c})$，是指在未患病情况下测试结果为阴性的概率；以及患病率，记为 $p(D)$，是目标人群中该疾病的先验概率。考虑一个设定，其中 $p(D)=0.2$，灵敏度 $=0.9$，特异度 $=0.8$。该CDSS中的行动策略使用两个源自期望效用考量的阈值：治疗阈值 $\\tau_{\\mathrm{treat}}=0.3$ 和排除阈值 $\\tau_{\\mathrm{ruleout}}=0.05$。请仅从条件概率和全概率公式的核心定义出发，计算一名患者单次测试结果的 $p(D\\mid +)$ 和 $p(D\\mid -)$。请以精确形式给出最终的数值。在您的推导过程中，请通过将这些后验概率与 $\\tau_{\\mathrm{treat}}$ 和 $\\tau_{\\mathrm{ruleout}}$ 进行比较，来解释它们的临床相关性；然而，最终答案应仅包含计算出的两个概率值。", "solution": "该问题提法明确，有科学依据，并提供了计算所需后验概率的全部必要信息。灵敏度、特异度、患病率和后验概率等概念，是贝叶斯统计学在医学诊断中应用的标准组成部分。所有给定的数值都在有效的概率范围（$0$到$1$）内，并代表了一个现实的临床场景。因此，该问题是有效的。\n\n目标是计算在给定测试结果为阳性 ($+$) 或阴性 ($-$) 的情况下，患者患有疾病 ($D$) 的后验概率。这些概率分别记为 $p(D\\mid +)$ 和 $p(D\\mid -)$。我们将仅从条件概率和全概率公式的核心定义出发来推导结果。\n\n已知条件如下：\n患病率：$p(D) = 0.2$\n灵敏度：$p(+\\mid D) = 0.9$\n特异度：$p(-\\mid D^{c}) = 0.8$\n\n根据患病率，我们可以确定未患病（记为 $D^c$）的概率：\n$$p(D^c) = 1 - p(D) = 1 - 0.2 = 0.8$$\n\n测试结果是二元的（阳性或阴性）。因此，我们可以求出与灵敏度和特异度相关的互补事件的概率：\n假阴性率是指在患病情况下测试结果为阴性的概率：\n$$p(-\\mid D) = 1 - p(+\\mid D) = 1 - 0.9 = 0.1$$\n假阳性率是指在未患病情况下测试结果为阳性的概率：\n$$p(+\\mid D^c) = 1 - p(-\\mid D^c) = 1 - 0.8 = 0.2$$\n\n现在我们来计算 $p(D\\mid +)$，即阳性预测值。\n根据条件概率的定义：\n$$p(D\\mid +) = \\frac{p(D \\cap +)}{p(+)}$$\n分子是患病且测试结果为阳性的联合概率，可以根据条件概率的定义重写为 $p(D \\cap +) = p(+\\mid D)p(D)$。\n分母是测试结果为阳性的总概率，可以通过以是否患病为条件，使用全概率公式求得：\n$$p(+) = p(+ \\cap D) + p(+ \\cap D^c) = p(+\\mid D)p(D) + p(+\\mid D^c)p(D^c)$$\n将这些结合起来，得到适用于本例的贝叶斯定理：\n$$p(D\\mid +) = \\frac{p(+\\mid D)p(D)}{p(+\\mid D)p(D) + p(+\\mid D^c)p(D^c)}$$\n代入数值：\n$$p(D\\mid +) = \\frac{0.9 \\times 0.2}{(0.9 \\times 0.2) + (0.2 \\times 0.8)} = \\frac{0.18}{0.18 + 0.16} = \\frac{0.18}{0.34}$$\n将其表示为精确分数：\n$$p(D\\mid +) = \\frac{18}{34} = \\frac{9}{17}$$\n\n接下来，我们计算 $p(D\\mid -)$，即在测试结果为阴性时患病的概率。\n根据条件概率的定义：\n$$p(D\\mid -) = \\frac{p(D \\cap -)}{p(-)}$$\n分子可以重写为 $p(D \\cap -) = p(-\\mid D)p(D)$。\n分母是测试结果为阴性的总概率，使用全概率公式求得：\n$$p(-) = p(- \\cap D) + p(- \\cap D^c) = p(-\\mid D)p(D) + p(-\\mid D^c)p(D^c)$$\n或者，因为测试结果是二元的，所以 $p(-) = 1 - p(+) = 1 - 0.34 = 0.66$。\n将这些结合起来，得到相应形式的贝叶斯定理：\n$$p(D\\mid -) = \\frac{p(-\\mid D)p(D)}{p(-\\mid D)p(D) + p(-\\mid D^c)p(D^c)}$$\n代入数值：\n$$p(D\\mid -) = \\frac{0.1 \\times 0.2}{(0.1 \\times 0.2) + (0.8 \\times 0.8)} = \\frac{0.02}{0.02 + 0.64} = \\frac{0.02}{0.66}$$\n将其表示为精确分数：\n$$p(D\\mid -) = \\frac{2}{66} = \\frac{1}{33}$$\n\n为分析其临床相关性，我们将这些后验概率与给定的阈值进行比较：治疗阈值 $\\tau_{\\mathrm{treat}}=0.3$ 和排除阈值 $\\tau_{\\mathrm{ruleout}}=0.05$。\n疾病的先验概率 $p(D)=0.2$ 位于这两个阈值之间 ($0.05  0.2  0.3$)，表明在没有更多信息的情况下无法做出决策，因此有必要进行测试。\n在测试结果为阳性后，后验概率为 $p(D\\mid +) = \\frac{9}{17} \\approx 0.529$。由于 $p(D\\mid +) > \\tau_{\\mathrm{treat}}$，证据足以支持推荐治疗。\n在测试结果为阴性后，后验概率为 $p(D\\mid -) = \\frac{1}{33} \\approx 0.0303$。由于 $p(D\\mid -)  \\tau_{\\mathrm{ruleout}}$，证据足以支持排除该疾病并推荐不进行治疗。\n在这种情况下，该诊断测试是有效的，因为它成功地将概率从中间的“测试区”移入了“治疗”或“排除”区。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{9}{17}  \\frac{1}{33} \\end{pmatrix}}$$", "id": "4826791"}, {"introduction": "在计算出概率之后，一个有效的临床决策支持系统还必须辅助做出最优决策。这个练习建立在贝叶斯推理的基础上，引入了误分类成本的概念，要求您通过比较预期成本来评估一项诊断测试的经济效益 ([@problem_id:4363287])。这有助于理解 CDSS 如何在资源有限和风险并存的现实世界中权衡利弊。", "problem": "一家医院计划将一个二元诊断分类器集成到临床决策支持系统 (CDSS) 中，以指导对患病率 $\\pi = 0.10$ 的某种疾病的检测决策。该分类器的灵敏度 $\\text{Se} = 0.90$，特异度 $\\text{Sp} = 0.80$。CDSS 将考虑误分类成本，其中假阳性的成本为 $c_{FP} = 1$，假阴性的成本为 $c_{FN} = 10$。假设不进行检测时的基线策略是将所有患者分类为阴性。仅使用灵敏度、特异度、患病率和 Bayes 定理的核心定义，推导该分类器的阳性预测值 (PPV) 和阴性预测值 (NPV)，计算使用检测时每位患者的预期误分类成本，将其与基线无检测策略下的预期误分类成本进行比较，并决定在该成本结构下 CDSS 是否应推荐进行检测。为便于评分，请仅报告检测策略下每位患者的预期误分类成本，以单个实数形式表示。请以成本单位表示您的最终答案，并四舍五入到四位有效数字。", "solution": "该问题经评估为有效，因为它具有科学依据、问题明确且客观，为获得唯一解提供了所有必要信息，没有矛盾或歧义。\n\n设 $D$ 为患者患有该疾病的事件，$D^c$ 为患者未患该疾病的事件。设 $T^+$ 和 $T^-$ 分别为检测结果为阳性和阴性的事件。给定的条件可以正式表示为概率：\n\n该疾病的患病率：\n$P(D) = \\pi = 0.10$\n不患该疾病的概率为：\n$P(D^c) = 1 - \\pi = 1 - 0.10 = 0.90$\n\n分类器的灵敏度：\n$\\text{Se} = P(T^+ | D) = 0.90$\n这意味着假阴性率 (FNR) 为：\n$P(T^- | D) = 1 - \\text{Se} = 1 - 0.90 = 0.10$\n\n分类器的特异度：\n$\\text{Sp} = P(T^- | D^c) = 0.80$\n这意味着假阳性率 (FPR) 为：\n$P(T^+ | D^c) = 1 - \\text{Sp} = 1 - 0.80 = 0.20$\n\n误分类的成本如下：\n假阳性的成本，$c_{FP} = 1$。假阳性发生在患者被分类为阳性但实际上没有患病 ($D^c$) 的情况。\n假阴性的成本，$c_{FN} = 10$。假阴性发生在患者被分类为阴性但实际上患有该疾病 ($D$) 的情况。\n\n首先，我们推导阳性预测值 (PPV) 和阴性预测值 (NPV)。这需要使用全概率定律计算阳性检测的总概率 $P(T^+)$ 和阴性检测的总概率 $P(T^-)$。\n\n$P(T^+) = P(T^+ | D)P(D) + P(T^+ | D^c)P(D^c)$\n$P(T^+) = (\\text{Se})(\\pi) + (1 - \\text{Sp})(1 - \\pi)$\n$P(T^+) = (0.90)(0.10) + (0.20)(0.90) = 0.09 + 0.18 = 0.27$\n\n$P(T^-) = P(T^- | D)P(D) + P(T^- | D^c)P(D^c)$\n$P(T^-) = (1 - \\text{Se})(\\pi) + (\\text{Sp})(1 - \\pi)$\n$P(T^-) = (0.10)(0.10) + (0.80)(0.90) = 0.01 + 0.72 = 0.73$\n作为检验，$P(T^+) + P(T^-) = 0.27 + 0.73 = 1.00$。\n\n阳性预测值，$PPV = P(D | T^+)$，是在给定阳性检测结果的情况下患有该疾病的概率。使用 Bayes 定理：\n$PPV = P(D | T^+) = \\frac{P(T^+ | D)P(D)}{P(T^+)} = \\frac{(0.90)(0.10)}{0.27} = \\frac{0.09}{0.27} = \\frac{1}{3}$\n\n阴性预测值，$NPV = P(D^c | T^-)$，是在给定阴性检测结果的情况下未患该疾病的概率。使用 Bayes 定理：\n$NPV = P(D^c | T^-) = \\frac{P(T^- | D^c)P(D^c)}{P(T^-)} = \\frac{(0.80)(0.90)}{0.73} = \\frac{0.72}{0.73}$\n\n接下来，我们计算当 CDSS 使用该检测时，每位患者的预期误分类成本。该策略是如果检测结果为阳性 ($T^+$) 则将患者分类为阳性，如果检测结果为阴性 ($T^-$) 则分类为阴性。只有在发生误分类时才会产生成本。存在两种类型的误分类：\n\n1.  假阳性 (FP) 发生在检测结果为阳性 ($T^+$) 但患者未患病 ($D^c$) 的情况。此联合事件的概率是：\n    $P(\\text{FP}) = P(T^+, D^c) = P(T^+ | D^c)P(D^c) = (1 - \\text{Sp})(1 - \\pi) = (0.20)(0.90) = 0.18$\n\n2.  假阴性 (FN) 发生在检测结果为阴性 ($T^-$) 但患者患有该疾病 ($D$) 的情况。此联合事件的概率是：\n    $P(\\text{FN}) = P(T^-, D) = P(T^- | D)P(D) = (1 - \\text{Se})(\\pi) = (0.10)(0.10) = 0.01$\n\n在检测策略下，每位患者的预期误分类成本 $E[\\text{Cost}_{\\text{test}}]$ 是每种错误类型的成本与其各自概率加权的总和：\n$E[\\text{Cost}_{\\text{test}}] = c_{FP} \\times P(\\text{FP}) + c_{FN} \\times P(\\text{FN})$\n$E[\\text{Cost}_{\\text{test}}] = (1) \\times (0.18) + (10) \\times (0.01)$\n$E[\\text{Cost}_{\\text{test}}] = 0.18 + 0.10 = 0.28$\n\n现在，我们计算在基线无检测策略下（即所有患者均被分类为阴性）的预期误分类成本。\n在此策略下，误分类仅发生在被分类为阴性的患者实际上患有疾病的情况下。这是一种假阴性。\n该事件的概率就是疾病的患病率，$P(D) = \\pi$。\n没有假阳性，因为没有任何患者被分类为阳性。\n无检测策略下的预期成本 $E[\\text{Cost}_{\\text{no-test}}]$ 为：\n$E[\\text{Cost}_{\\text{no-test}}] = c_{FN} \\times P(\\text{patient has disease}) = c_{FN} \\times \\pi$\n$E[\\text{Cost}_{\\text{no-test}}] = (10) \\times (0.10) = 1.0$\n\n最后，我们比较这两个预期成本，以决定 CDSS 是否应该推荐进行检测。\n$E[\\text{Cost}_{\\text{test}}] = 0.28$\n$E[\\text{Cost}_{\\text{no-test}}] = 1.0$\n由于 $0.28  1.0$，检测策略的预期误分类成本更低。因此，CDSS 应该推荐进行检测。\n\n问题要求仅报告检测策略下每位患者的预期误分类成本，并四舍五入到四位有效数字。\n计算出的成本是 $0.28$。保留四位有效数字，即为 $0.2800$。", "answer": "$$\\boxed{0.2800}$$", "id": "4363287"}, {"introduction": "许多临床决策支持系统并非基于复杂的概率模型，而是依赖于明确的“如果-那么”规则。本练习模拟了一个基于规则的系统，您需要评估一系列逻辑条件来计算风险评分 ([@problem_id:4606609])。通过这个过程，您将了解知识型 CDSS 如何将临床指南和专家知识转化为可执行的自动化逻辑。", "problem": "一个基于规则的临床决策支持系统使用具有明确布尔语义的命题逻辑和加权线性聚合来生成一个无量纲的警报严重性评分。本问题的基础包括以下经过充分检验的定义和事实：由真值函数语义定义的合取和析取的命题逻辑，知识库系统中的封闭世界假设（未指明的事实被视为假），以及在临床决策支持中使用的规则激活的标准线性加权聚合。合取的定义为：对于命题 $X$ 和 $Y$，其真值 $t(X \\land Y)$ 等于 $1$ 当且仅当 $t(X) = 1$ 且 $t(Y) = 1$，否则为 $0$。析取的定义为：$t(X \\lor Y) = 1$ 当且仅当 $t(X) = 1$ 或 $t(Y) = 1$，否则为 $0$。在封闭世界假设下，任何未出现在患者数据中的前件文字都被赋值为 $0$。\n\n考虑以下患者事实和旨在检测与非甾体抗炎药（NSAID）相关的肾脏和胃肠道风险的规则库。患者的估算肾小球滤过率（eGFR）为 $g = 45 \\, \\text{mL/min/1.73m}^2$，目前正在服用布洛芬（一种NSAID），无胃肠道（GI）出血史。没有正在使用的抗凝剂，也没有正在使用的血管紧张素转换酶（ACE）抑制剂。将这些事实编码为布尔命题：$A$ 表示“正在服用布洛芬”，$H$ 表示“有胃肠道出血史”，$B$ 表示“正在使用抗凝剂”，$P$ 表示“正在使用ACE抑制剂”。$g$ 与阈值的数值比较被视为前件文字，如果为真则产生 $1$，如果为假则产生 $0$。该系统的三个规则是：\n\n- 规则 $R_1$：$A \\land (g  60) \\Rightarrow$ 肾脏风险；权重 $w_1 = 0.57$。\n- 规则 $R_2$：$A \\land (H \\lor B) \\Rightarrow$ 胃肠道风险；权重 $w_2 = 0.28$。\n- 规则 $R_3$：$(g  30) \\lor (A \\land P) \\Rightarrow$ 高严重性禁忌症；权重 $w_3 = 0.42$。\n\n警报严重性评分 $S$ 通过将每个规则的权重与其真值相乘后的乘积求和来计算，即 $S = \\sum_{i=1}^{3} w_i \\cdot t(R_i)$，其中 $t(R_i) \\in \\{0,1\\}$ 是规则 $R_i$ 的真值，通过用给定的患者事实评估其前件得到。系统的警报阈值为 $\\theta = 0.50$，意味着当且仅当 $S \\ge \\theta$ 时触发警报。\n\n根据患者的事实评估这三个规则及其合取和析取前件，从基本原则推导出警报决策，并计算最终的警报严重性评分 $S$。将最终的严重性评分表示为无量纲实数，并将您的答案四舍五入到 $4$ 位有效数字。最终答案中不要包含任何单位。", "solution": "这个问题是有效的，因为它有科学依据、良定且客观。它提供了一套完整且一致的定义、事实和规则，这些是使用命题逻辑和加权聚合的既定原则来计算唯一解所必需的，而这些原则在临床决策支持系统领域是标准方法。\n\n目标是根据一组规则为给定患者计算警报严重性评分 $S$，并确定是否触发警报。该评分使用公式 $S = \\sum_{i=1}^{3} w_i \\cdot t(R_i)$ 计算，其中 $w_i$ 是规则 $R_i$ 的权重，$t(R_i)$ 是其前件的布尔真值（真为 $1$，假为 $0$）。\n\n首先，我们必须将患者的临床数据形式化为问题中定义的命题文字的真值。患者数据如下：\n- 估算肾小球滤过率，$g = 45$。\n- 正在服用布洛芬，对应于命题 $A$。\n- 无胃肠道出血史，对应于命题 $H$。\n- 无正在使用的抗凝剂，对应于命题 $B$。\n- 无正在使用的ACE抑制剂，对应于命题 $P$。\n\n基于这些事实，我们为命题赋真值：\n- $t(A) = 1$，因为患者正在服用布洛芬。\n- $t(H) = 0$，因为没有胃肠道出血史。\n- $t(B) = 0$，因为没有正在使用的抗凝剂。\n- $t(P) = 0$，因为没有正在使用的ACE抑制剂。\n\n接下来，我们评估涉及患者 eGFR $g = 45$ 的数值比较文字：\n- 文字 $(g  60)$ 评估为 $45  60$，为真。因此，$t(g  60) = 1$。\n- 文字 $(g  30)$ 评估为 $45  30$，为假。因此，$t(g  30) = 0$。\n\n现在我们可以评估每个规则的前件以确定其真值 $t(R_i)$。\n\n规则 $R_1$ 的评估：前件是 $A \\land (g  60)$。\n真值 $t(R_1)$ 是合取 $t(A \\land (g  60))$ 的真值。\n根据合取的定义，$t(X \\land Y)$ 为 $1$ 当且仅当 $t(X)=1$ 且 $t(Y)=1$。\n我们有 $t(A) = 1$ 和 $t(g  60) = 1$。\n因此，$t(R_1) = 1 \\land 1 = 1$。规则 $R_1$ 被激活。\n\n规则 $R_2$ 的评估：前件是 $A \\land (H \\lor B)$。\n真值 $t(R_2)$ 是 $t(A \\land (H \\lor B))$。我们首先评估析取 $(H \\lor B)$。\n根据析取的定义，$t(X \\lor Y)$ 为 $1$ 当且仅当 $t(X)=1$ 或 $t(Y)=1$。\n我们有 $t(H) = 0$ 和 $t(B) = 0$。\n因此，$t(H \\lor B) = 0 \\lor 0 = 0$。\n现在我们评估合取 $A \\land (H \\lor B)$。我们有 $t(A) = 1$ 和 $t(H \\lor B) = 0$。\n因此，$t(R_2) = 1 \\land 0 = 0$。规则 $R_2$ 未被激活。\n\n规则 $R_3$ 的评估：前件是 $(g  30) \\lor (A \\land P)$。\n真值 $t(R_3)$ 是 $t((g  30) \\lor (A \\land P))$。我们首先评估合取 $(A \\land P)$。\n我们有 $t(A) = 1$ 和 $t(P) = 0$。\n因此，$t(A \\land P) = 1 \\land 0 = 0$。\n现在我们评估析取 $(g  30) \\lor (A \\land P)$。我们有 $t(g  30) = 0$ 和 $t(A \\land P) = 0$。\n因此，$t(R_3) = 0 \\lor 0 = 0$。规则 $R_3$ 未被激活。\n\n在确定了每个规则前件的真值（$t(R_1) = 1$，$t(R_2) = 0$，$t(R_3) = 0$）后，我们现在可以计算警报严重性评分 $S$。给定的规则权重为 $w_1 = 0.57$，$w_2 = 0.28$ 和 $w_3 = 0.42$。\n$$ S = w_1 \\cdot t(R_1) + w_2 \\cdot t(R_2) + w_3 \\cdot t(R_3) $$\n$$ S = (0.57 \\cdot 1) + (0.28 \\cdot 0) + (0.42 \\cdot 0) $$\n$$ S = 0.57 + 0 + 0 $$\n$$ S = 0.57 $$\n警报阈值给定为 $\\theta = 0.50$。如果 $S \\ge \\theta$，系统将触发警报。\n由于 $S = 0.57$，且 $0.57 \\ge 0.50$，所以确实生成了警报。\n\n问题要求将最终的警报严重性评分 $S$ 表示为无量纲实数，并四舍五入到 $4$ 位有效数字。计算出的评分为 $S=0.57$。将此值表示为 $4$ 位有效数字得到 $0.5700$。", "answer": "$$ \\boxed{0.5700} $$", "id": "4606609"}]}