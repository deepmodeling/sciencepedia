{"hands_on_practices": [{"introduction": "理解行为干预在现实世界中的影响是一项至关重要的技能。第一个实践练习将要求你分析一个假设情景，其中一个“选择退出”系统通过针对不作为偏见来提高药物依从性。通过计算相对风险和风险差异等标准流行病学指标，你将学习如何量化行为“助推”的效应大小和临床意义 [@problem_id:4361478]。", "problem": "一个卫生系统正在测试一种旨在抵消“不作为偏见”的行为“助推”。不作为偏见是一种倾向，即人们宁愿因不作为而受到伤害，也不愿因作为而受到同等的伤害。在一个针对高血压患者的药物依从性项目中，观察到基线依从性（没有助推的情况下）为 $0.60$。在实施了一个针对不作为偏见的选择退出式药物补充和提醒系统后，依从性增加到 $0.72$。请使用卫生系统科学中概率论和流行病学的基本定义，计算干预措施与基线相比，依从性的相对风险和风险差异。然后，解释这些指标在每 $100$ 名患者中预期依从性变化方面的临床意义，并简要说明为什么抵消不作为偏见是观察到的变化的一个合理解释机制。将相对风险和风险差异均以小数形式表示（不使用百分号），并将您的数值结果四舍五入至四位有效数字。", "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 第一步：提取已知条件\n- 基线药物依从性（对照组）：$P_{baseline} = 0.60$\n- 干预后依从性（干预组）：$P_{intervention} = 0.72$\n- 干预措施：一个针对不作为偏见的选择退出式药物补充和提醒系统。\n- 要求计算：\n    1. 依从性的相对风险 ($RR$)。\n    2. 依从性的风险差异 ($RD$)。\n- 要求解释：\n    1. 这些指标在每 $100$ 名患者中预期依从性变化方面的临床意义。\n    2. 抵消不作为偏见为何是合理解释机制的理由。\n- 格式要求：将数值结果以小数形式表示，并四舍五入至四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题具有科学依据。药物依从性、不作为偏见、行为助推（特别是选择退出系统）、相对风险和风险差异等概念在卫生系统科学、流行病学和行为经济学领域都是成熟的核心概念。所提供的依从率是切合实际的概率。\n- **适定性**：该问题是适定的。它提供了计算所定义的流行病学指标所需的所有数据。根据标准定义，所提出的问题有清晰、唯一且有意义的答案。\n- **客观性**：该问题陈述客观，并使用了精确的术语。\n- **缺陷分析**：\n    - 该问题不违反任何科学原则。\n    - 它可以使用标准的数学定义直接形式化。\n    - 它是完整的且内部一致的。\n    - 场景和数据是合理且现实的。\n    - 在流行病学的背景下，这些术语是明确无误的。\n\n### 第三步：结论与行动\n该问题被判定为**有效**。将生成一个解决方案。\n\n### 解决方案\n该问题要求在一个旨在提高药物依从性的行为干预背景下，计算并解释两个基本的流行病学指标：相对风险 ($RR$) 和风险差异 ($RD$)。\n\n设 $P_{intervention}$ 代表接受干预（“助推”）组的依从概率，设 $P_{baseline}$ 代表基线组（无干预）的依从概率。根据问题陈述，我们有：\n$$P_{intervention} = 0.72$$\n$$P_{baseline} = 0.60$$\n\n**1. 相对风险 ($RR$) 的计算**\n\n相对风险是干预组中的风险（在此案例中为依从概率）与基线组中风险的比率。它量化了干预组中出现结果的可能性是对照组的多少倍。\n\n相对风险的公式是：\n$$RR = \\frac{P_{intervention}}{P_{baseline}}$$\n\n代入给定值：\n$$RR = \\frac{0.72}{0.60} = 1.2$$\n\n根据要求四舍五入至四位有效数字，相对风险为 $1.200$。\n\n**2. 风险差异 ($RD$) 的计算**\n\n风险差异，也称为绝对风险增加，是两组之间结果风险的简单算术差。它提供了干预措施绝对效果的度量。\n\n风险差异的公式是：\n$$RD = P_{intervention} - P_{baseline}$$\n\n代入给定值：\n$$RD = 0.72 - 0.60 = 0.12$$\n\n根据要求四舍五入至四位有效数字，风险差异为 $0.1200$。\n\n**3. 临床意义的解释**\n\n- **相对风险 ($RR = 1.200$)**：该值表明，与基线条件下的患者相比，干预组的患者坚持其药物治疗方案的可能性是前者的 $1.2$ 倍，即高出 $20\\%$。虽然这个指标有助于理解效应的相对大小，但它并不能传达对患者群体的绝对影响。\n\n- **风险差异 ($RD = 0.1200$)**：该值具有更直接的临床解释。它表示由于干预，依从概率绝对增加了 $0.12$。为了根据患者数量来解释这一点，我们可以考虑一个包含 $100$ 名患者的队列。$RD$ 预测了在干预组中会出现该结果的额外人数。因此，在每 $100$ 名参与选择退出系统的患者中，我们预期会有 $100 \\times RD = 100 \\times 0.1200 = 12$ 名额外的患者变得依从，这是与在基线系统下观察到的情况相比。该指标对于卫生系统规划和资源分配通常更有价值。它也可以用来计算需要治疗的人数（或在此案例中，“需要助推的人数”），即 $RD$ 的倒数：$1/0.1200 \\approx 8.33$。这意味着大约需要对 $8$ 名患者进行干预，才能使一名额外的患者变得依从。\n\n**4. 机制的合理解释（不作为偏见）**\n\n不作为偏见是一种认知偏见，描述了人们倾向于认为有害的作为比同等有害的不作为（忽略）更糟糕或更不道德。在基线情景中，依从性需要一系列主动选择：患者必须决定要求补充药物，并决定每天服药。如果患者什么都不做，不依从就是默认结果；这是一种不作为。\n\n“选择退出”干预从根本上重构了选择架构。通过自动化药物补充和发送提醒，依从性成为新的默认状态。在这个系统中，不依从需要患者采取刻意的行动：他们必须主动选择取消药物补充或忽略提醒并且不服药。心理负担被转移了。现在，不作为（忽略）导致了依从，而不依从则需要一个作为（实施）。通过使期望的行为成为阻力最小的路径，该干预利用了患者潜在的不作为偏见来促进而非阻碍依从性。一个在旧系统下可能因被动而未能补充其处方药的患者，现在在新系统下更有可能被动地接受自动补充。因此，通过改变默认选项来对抗（或者更准确地说，利用）不作为偏见，是观察到药物依从性从 $0.60$ 增加到 $0.72$ 的一个非常合理的机制。", "answer": "$$\\boxed{\\begin{pmatrix} 1.200  0.1200 \\end{pmatrix}}$$", "id": "4361478"}, {"introduction": "除了衡量干预是否有效，卫生系统还必须评估其效率以有效分配资源。这个问题引入了“助推所需人数”（NNN），这是一个改编自临床流行病学的强大概念。你将推导并计算NNN，以确定需要应用多少次助推才能预防一个不良结果的发生，从而为干预措施的实际成本效益提供一个清晰的衡量标准 [@problem_id:4361462]。", "problem": "一家医院在其电子健康记录系统中实施了一项默认排序引导，通过巧妙地引导临床医生做出符合指南的选择，以减少不适当的门诊抗生素处方。设每次符合条件的就诊中，开具不适当抗生素疗程的基线概率为 $p_{0} = 0.25$。假设每次接受引导的医患互动中，该引导使此概率产生一个恒定的绝对降低值 $\\Delta = 0.05$。假设各次互动是相互独立的，并且引导的效果（即绝对降低值 $\\Delta$）在所有互动中是相同的。\n\n定义“需引导数”（Number Needed to Nudge, NNN）为，仅因该引导而避免一次不适当抗生素疗程所需的受引导互动次数的期望值。从概率、伯努利事件的期望以及绝对风险降低（事件概率之差）的核心定义出发，推导出一个用 $\\Delta$ 表示 NNN 的表达式。然后，根据给定参数 $p_{0} = 0.25$ 和 $\\Delta = 0.05$ 计算 NNN。\n\n将最终答案表示为一个精确整数（无需四舍五入）。最终答案不需要单位。", "solution": "该问题要求推导“需引导数”（NNN）的表达式，并根据所给参数进行计算。NNN 定义为避免一次不适当抗生素疗程所需的受引导互动次数的期望值。我们将通过形式化概率框架来解决此问题。\n\n设 $p_0$ 表示每次符合条件的就诊中开具不适当抗生素疗程的基线概率。题目陈述给出该值为 $p_{0} = 0.25$。\n设 $p_1$ 为在有引导的互动中开具不适当抗生素疗程的概率。\n题目将 $\\Delta$ 定义为由引导引起的该概率的恒定绝对降低值。在数学上，这表示为绝对风险降低 (ARR)：\n$$ \\Delta = p_0 - p_1 $$\n已知 $\\Delta = 0.05$。由此，我们可以计算出有引导情况下不适当疗程的概率为：\n$$ p_1 = p_0 - \\Delta = 0.25 - 0.05 = 0.20 $$\n这是一个有效的概率，因为它位于区间 $[0, 1]$ 内。\n\n单次受引导互动“避免了一次不适当疗程”这一事件，对应于一次概念性试验中的“成功”。这次成功的概率，我们称之为 $p_{\\text{success}}$，是归因于干预措施的事件发生率的降低值。在大量的互动（$N$ 次）中，没有引导时不适当疗程的期望数量为 $N p_0$，有引导时为 $N p_1$。避免的疗程的期望数量是二者之差：\n$$ \\text{Expected averted courses in } N \\text{ encounters} = N p_0 - N p_1 = N(p_0 - p_1) = N\\Delta $$\n在任何单次互动中避免一次疗程的概率是避免的疗程总期望数除以互动总次数：\n$$ p_{\\text{success}} = \\frac{N\\Delta}{N} = \\Delta $$\n每次受引导的互动都是一次独立的伯努利试验，其成功概率为 $\\Delta$。\n\nNNN 是为达到首次成功所需的试验（互动）次数的期望值。这在形式上是几何分布的期望。设 $K$ 是一个随机变量，表示直到首次避免不适当疗程为止的互动次数。$K$ 的概率质量函数为：\n$$ P(K=k) = (1 - p_{\\text{success}})^{k-1} p_{\\text{success}} \\quad \\text{for } k \\in \\{1, 2, 3, \\dots\\} $$\n服从几何分布的随机变量 $K$ 的期望值由成功概率的倒数给出：\n$$ E[K] = \\frac{1}{p_{\\text{success}}} $$\n根据定义，NNN 就是这个期望值 $E[K]$。代入 $p_{\\text{success}} = \\Delta$，我们得到 NNN 的通用表达式：\n$$ \\text{NNN} = \\frac{1}{\\Delta} $$\n这表明 NNN 是概率绝对降低值的倒数，这一原则与流行病学中的“需治疗数”（Number Needed to Treat, NNT）相同。\n\n现在，我们必须使用给定数据计算 NNN 的具体值。题目指出绝对降低值为 $\\Delta = 0.05$。\n将此值代入推导出的公式中：\n$$ \\text{NNN} = \\frac{1}{0.05} $$\n为了计算这个值，我们可以将分母表示为分数：\n$$ 0.05 = \\frac{5}{100} = \\frac{1}{20} $$\n因此，NNN 为：\n$$ \\text{NNN} = \\frac{1}{\\frac{1}{20}} = 20 $$\n因此，为避免一次不适当的抗生素疗程，所需的受引导互动次数的期望值为 $20$。", "answer": "$$\\boxed{20}$$", "id": "4361462"}, {"introduction": "为了真正掌握行为经济学，我们必须超越观察效果，对潜在的心理机制进行建模。这最后一个练习挑战你使用捕捉当下偏见的准双曲贴现模型来模拟患者的决策过程。通过编写程序来模拟日常麻烦成本和未来健康收益之间的相互作用，你将获得一个基础理论的实践经验，并了解如何对提醒等干预措施进行量化评估 [@problem_id:4361491]。", "problem": "一个卫生系统正在使用行为经济学模型评估每日电子提醒对药物依从性的影响。假设患者每日服药的决策遵循准双曲贴现（QHD）模型，其中现时偏误由参数 $\\hat{\\beta}$ 和 $\\hat{\\delta}$ 表示。设 $\\hat{\\beta} = 0.7$ 且 $\\hat{\\delta} = 0.99$。决策规则如下：在每一天 $t$，患者会将一个即时麻烦成本 $h_t$（一个非负随机变量）与今日服药所带来的健康益处的感知现值进行比较，其中量级为 $b$ 的益处从明天开始，每天产生一次，持续 $L$ 天。时间单位是天。在QHD模型下，今天的即时回报权重为 $1$，而从 $t+k$ 天（$k \\geq 1$）开始的任何回报的权重为 $\\hat{\\beta} \\hat{\\delta}^k$。患者在第 $t$ 天依从当且仅当今日服药产生的未来收益流的感知现值至少与 $h_t$ 一样大。电子提醒被建模为将即时麻烦成本乘以一个因子 $1 - 0.20$ 进行减少（即，有提醒时的麻烦成本为 $0.80 h_t$）。目标是模拟在有提醒和无提醒两种情况下 $T$ 天内的每日依从性轨迹，并报告依从性的变化，该变化定义为在 $T$ 天的期限内，有提醒时的依从天数比例与无提醒时的依从天数比例之差。[@problem_id:150]\n\n基本假设：\n- 准双曲贴现（QHD）：对未来 $k$ 天后（$k \\geq 1$）实现的回报应用的权重为 $\\hat{\\beta} \\hat{\\delta}^k$，对即时回报应用的权重为 $1$。\n- 每次服药的每日益处是恒定的 $b$，并从第二天开始连续累积 $L$ 天。\n- 即时麻烦成本 $h_t$ 是随机的，并且在各天之间独立分布，服从均值为 $\\mu_h$、标准差为 $\\sigma_h$ 的正态分布，并在 $0$ 处进行下方截断（即，通过裁剪将负样本设置为 $0$）。\n- 第 $t$ 天的依从决策是：在无提醒的情况下，如果今日服药产生的未来收益流的 QHD 加权现值大于或等于已实现的即时麻烦成本 $h_t$，则依从；在有提醒的情况下，如果该现值大于或等于 $0.80 h_t$，则依从。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n1.  给定 $b$、$\\hat{\\beta}$ 和 $\\hat{\\delta}$，计算今日服药产生的为期 $L$ 天的未来收益流的 QHD 加权现值。\n2.  根据每个测试用例指定的分布，模拟 $T$ 天的每日麻烦成本 $h_t$，并构建两条依从性轨迹：一条无提醒（阈值为 $h_t$），一条有提醒（阈值为 $0.80 h_t$）。每一天的决策都是独立的，基于将相同的感知收益现值与当天的阈值进行比较。\n3.  为每个测试用例报告在 $T$ 天内的依从性变化，该变化定义为有提醒时的依从天数比例减去无提醒时的依从天数比例。将此变化表示为小数（不使用百分号），并四舍五入到小数点后四位。\n\n科学真实性与单位：\n- 时间以天为单位。模拟期限 $T$ 指定了天数。\n- $T$ 天内的依从率是一个在 $[0,1]$ 范围内的无量纲分数。将变化报告为四舍五入到小数点后四位的小数。\n- 益处 $b$ 和麻烦成本 $h_t$ 使用一致的效用单位。\n\n测试套件：\n使用以下参数集，其中所有数学实体和数字均已指定：\n- 案例 1：$b = 0.002$, $\\mu_h = 0.020$, $\\sigma_h = 0.005$, $L = 14$, $T = 30$, $\\text{seed} = 101$。\n- 案例 2（单日收益的边界情况）：$b = 0.020$, $\\mu_h = 0.014$, $\\sigma_h = 0.002$, $L = 1$, $T = 30$, $\\text{seed} = 202$。\n- 案例 3（低收益，高成本）：$b = 0.001$, $\\mu_h = 0.030$, $\\sigma_h = 0.008$, $L = 30$, $T = 30$, $\\text{seed} = 303$。\n- 案例 4（阈值附近的高变异性）：$b = 0.0025$, $\\mu_h = 0.020$, $\\sigma_h = 0.010$, $L = 10$, $T = 30$, $\\text{seed} = 404$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_i$ 是案例 $i$ 的依从性变化，表示为四舍五入到小数点后四位的小数。不应打印任何其他文本。无需用户输入；程序必须是自包含的，并且仅使用指定的参数值。", "solution": "问题陈述经评估有效。它基于已建立的行为经济学模型——准双曲贴现模型，具有科学依据，定义明确，提供了所有必需的参数和条件，并以清晰、客观的语言表述。不存在内部矛盾、模糊不清或事实错误。该任务是一个基于形式化原则的、定义明确的计算模拟。\n\n解决方案分四个阶段进行：\n1.  推导药物未来收益的感知现值。\n2.  模拟每日随机麻烦成本。\n3.  应用两种情景（有提醒和无提醒）下的每日依从决策规则。\n4.  计算模拟期限内依从率的变化。\n\n**1. 收益的感知现值**\n\n根据准双曲贴现（QHD）模型，从当前（$t$）起 $k$ 天后收到的未来回报，其贴现因子为 $\\hat{\\beta} \\hat{\\delta}^k$（$k \\ge 1$）。第 $t$ 天的即时回报不贴现（权重为1）。\n\n在此问题中，在第 $t$ 天服药会产生一个收益流，从第 $t+1$ 天开始到第 $t+L$ 天结束，连续 $L$ 天，每天的收益量级为 $b$。从第 $t$ 天的角度看，这整个未来收益流的感知现值（记为 $V$）是每个每日收益的贴现值之和。\n\n$$ V = \\sum_{k=1}^{L} \\hat{\\beta} \\hat{\\delta}^k b $$\n\n我们可以提出常数项 $b$ 和 $\\hat{\\beta}$：\n\n$$ V = b \\hat{\\beta} \\sum_{k=1}^{L} \\hat{\\delta}^k $$\n\n求和项是一个有限几何级数：$\\sum_{k=1}^{L} \\hat{\\delta}^k = \\hat{\\delta}^1 + \\hat{\\delta}^2 + \\dots + \\hat{\\delta}^L$。首项为 $a$，公比为 $r$，项数为 $n$ 的几何级数的和由 $a(1-r^n)/(1-r)$ 给出。在我们的例子中，首项为 $a = \\hat{\\delta}$，公比为 $r = \\hat{\\delta}$，项数为 $n = L$。因此，和为：\n\n$$ \\sum_{k=1}^{L} \\hat{\\delta}^k = \\hat{\\delta} \\frac{1 - \\hat{\\delta}^L}{1 - \\hat{\\delta}} $$\n\n将此代入 $V$ 的表达式，我们得到收益感知现值的闭式公式，该值对于每个测试用例都是恒定的：\n\n$$ V = b \\hat{\\beta} \\hat{\\delta} \\frac{1 - \\hat{\\delta}^L}{1 - \\hat{\\delta}} $$\n\nQHD 参数给定为 $\\hat{\\beta} = 0.7$ 和 $\\hat{\\delta} = 0.99$。\n\n**2. 每日麻烦成本的模拟**\n\n第 $t$ 天的即时麻烦成本（记为 $h_t$）是一个随机变量。对于 $T$ 天模拟期限内的每一天，我们都必须生成一个 $h_t$ 的值。问题规定，这些成本根据均值为 $\\mu_h$、标准差为 $\\sigma_h$ 的正态分布独立分布，然后在 $0$ 处进行截断。这意味着任何生成的小于 $0$ 的样本都将被设置为 $0$。\n\n对于每个测试用例，我们将使用一个以指定种子初始化的伪随机数生成器，生成一个包含 $T$ 个此类随机样本的向量，以确保结果的可复现性。\n\n**3. 依从规则的应用**\n\n在从 $1$ 到 $T$ 的每一天 $t$，患者通过比较收益的感知现值 $V$ 和即时麻烦成本 $h_t$ 来决定是否依从用药计划。\n\n*   **无提醒**：如果收益至少与成本一样大，则患者依从。\n    $$ \\text{Adherence}_{\\text{no\\_rem}, t} \\iff V \\ge h_t $$\n\n*   **有提醒**：电子提醒将感知麻烦成本降低一个因子 $1 - 0.20 = 0.80$。依从条件变为：\n    $$ \\text{Adherence}_{\\text{rem}, t} \\iff V \\ge 0.80 h_t $$\n\n对于每个测试用例，我们将为每个情景生成两条长度为 $T$ 的布尔型依从性轨迹。\n\n**4. 依从性变化的计算**\n\n给定情景的依从率是 $T$ 天期限内患者依从的天数所占的比例。\n设 $N_{\\text{no\\_rem}}$ 为无提醒时依从的总天数， $N_{\\text{rem}}$ 为有提醒时依从的总天数。各自的依从率为：\n\n$$ R_{\\text{no\\_rem}} = \\frac{N_{\\text{no\\_rem}}}{T} $$\n$$ R_{\\text{rem}} = \\frac{N_{\\text{rem}}}{T} $$\n\n所期望的输出是依从性的变化 $\\Delta R$，定义为这两个率之间的差：\n\n$$ \\Delta R = R_{\\text{rem}} - R_{\\text{no\\_rem}} $$\n\n该值为每个测试用例计算，并四舍五入到小数点后四位。实现将使用 `NumPy` 来高效地进行麻烦成本、依从决策和比率的向量化计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates medication adherence based on a Quasi-Hyperbolic Discounting model\n    and calculates the change in adherence due to electronic reminders.\n    \"\"\"\n    \n    # QHD parameters constant across all test cases\n    BETA_HAT = 0.7\n    DELTA_HAT = 0.99\n    REMINDER_EFFECT = 0.80\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (b, mu_h, sigma_h, L, T, seed)\n        (0.002, 0.020, 0.005, 14, 30, 101),\n        (0.020, 0.014, 0.002, 1, 30, 202),\n        (0.001, 0.030, 0.008, 30, 30, 303),\n        (0.0025, 0.020, 0.010, 10, 30, 404),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        b, mu_h, sigma_h, L, T, seed = case\n        \n        # Step 1: Compute the QHD-weighted present value of the future benefit stream.\n        # This is the sum of a finite geometric series: b * beta_hat * sum_{k=1 to L} (delta_hat^k)\n        if DELTA_HAT == 1.0:\n            # Special case for geometric series if delta_hat were 1\n            sum_geom_series = float(L)\n        else:\n            sum_geom_series = DELTA_HAT * (1 - DELTA_HAT**L) / (1 - DELTA_HAT)\n        \n        present_value_benefits = b * BETA_HAT * sum_geom_series\n\n        # Step 2: Simulate T daily hassle costs h_t.\n        # Initialize the random number generator for reproducibility.\n        rng = np.random.default_rng(seed)\n        \n        # Generate T samples from a Normal distribution.\n        hassle_costs = rng.normal(loc=mu_h, scale=sigma_h, size=T)\n        \n        # Truncate at 0 (negative costs are not possible).\n        hassle_costs = np.clip(hassle_costs, 0, None)\n\n        # Step 3: Construct two adherence trajectories.\n        # Without reminders: adhere if benefits = h_t\n        adherence_no_reminder = (present_value_benefits = hassle_costs)\n        \n        # With reminders: adhere if benefits = 0.80 * h_t\n        adherence_with_reminder = (present_value_benefits = REMINDER_EFFECT * hassle_costs)\n\n        # Step 4: Report the change in adherence.\n        # Adherence rate is the mean of the boolean array (True=1, False=0).\n        rate_no_reminder = np.mean(adherence_no_reminder)\n        rate_with_reminder = np.mean(adherence_with_reminder)\n        \n        # Change is the difference in rates.\n        adherence_change = rate_with_reminder - rate_no_reminder\n        \n        # Round to four decimal places as required.\n        rounded_result = round(adherence_change, 4)\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    # The output format must be a comma-separated list in brackets,\n    # with no spaces between items.\n    results_str = [f\"{r:.4f}\" for r in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "4361491"}]}