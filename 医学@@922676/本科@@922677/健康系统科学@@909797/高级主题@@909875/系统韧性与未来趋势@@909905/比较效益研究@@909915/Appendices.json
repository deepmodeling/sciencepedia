{"hands_on_practices": [{"introduction": "在比较效果研究中，处理观察性数据时最大的挑战之一是混杂偏倚。有向无环图 (Directed Acyclic Graphs, DAGs) 是一种强大的可视化工具，可以明确地表达我们对变量之间因果关系的假设。通过这个练习，你将学会如何利用DAG来识别“后门路径”并选择合适的协变量进行调整，同时理解错误地控制对撞因子或中介变量可能如何引入偏倚。[@problem_id:4364917]", "problem": "一个卫生系统正在进行比较效果研究（CER），旨在使用观察性数据估计一种新的降压治疗对主要心血管事件的总因果效应。研究人员使用有向无环图（DAG）来表示他们的假设。设 $T$ 表示治疗分配，$Y$ 表示结局，$L$ 表示测量的基线心血管风险，$U$ 表示一个未测量的生物风险因素，$M$ 表示治疗后的一个中间临床反应（例如，治疗开始后的收缩压水平），$C$ 表示护理强度的一个度量（例如，后续随访的频率）。该DAG由以下箭头指定：$L \\to T$，$L \\to Y$，$T \\to M$，$M \\to Y$，$U \\to Y$，$U \\to C$ 和 $T \\to C$。所有箭头都被假定是正确的，且没有额外的箭头。目标是确定一个有效的协变量调整集，以便在这种情况下得到 $T$ 对 $Y$ 的总因果效应的无偏估计。\n\n哪个选项正确地识别了一个最小的有效后门调整集，并正确解释了对撞击子或中介变量进行条件化将如何使效应估计产生偏倚？\n\nA. 仅对 $\\{L\\}$ 进行调整。对 $C$ 进行条件化会打开路径 $T \\to C \\leftarrow U \\to Y$ 从而引入偏倚，而对 $M$ 进行条件化会阻断从 $T$ 到 $Y$ 的部分因果效应，从而使总效应估计产生偏倚。\n\nB. 对 $\\{L, C\\}$ 进行调整。为了阻断通过 $U$ 产生的混杂，对 $C$ 进行条件化是必要的，因为 $C$ 位于 $U$ 和 $Y$ 之间，而对 $M$ 进行条件化是可选的，因为 $M$ 位于因果路径上。\n\nC. 对 $\\{L, M\\}$ 进行调整。为了避免高估，需要对 $M$ 进行条件化，因为 $M$ 是 $T$ 的下游，而对 $C$ 进行条件化是无害的，因为更多的调整不会引入偏倚。\n\nD. 对 $\\{L, C, M\\}$ 进行调整。更广泛的调整总是更安全；对撞击子进行条件化不会产生偏倚，并且即使目标估计量是总效应，也应该对中介变量进行条件化以分离直接效应。", "solution": "该问题要求我们确定一个有效的协变量调整集，以估计治疗 $T$ 对结局 $Y$ 的总因果效应。我们将使用有向无环图 (DAG) 和后门准则来解决这个问题。\n\n首先，我们根据问题描述分析变量之间的因果路径：\n1.  **混杂路径**：$L \\to T$ 和 $L \\to Y$ 这两个关系表明，$L$ 是治疗 $T$ 和结局 $Y$ 的一个共同原因，即一个混杂因素。它构成了一条需要被阻断的后门路径：$T \\leftarrow L \\to Y$。为了获得 $T$ 对 $Y$ 的无偏因果效应，我们必须通过对 $L$ 进行条件化（调整）来阻断这条路径。\n2.  **因果路径**：$T \\to M \\to Y$ 是一条从 $T$ 到 $Y$ 的因果路径，其中 $M$ 是一个中介变量。我们的目标是估计 $T$ 对 $Y$ 的**总**因果效应，这个效应包括通过 $M$ 的间接效应。因此，我们**不能**对 $M$ 进行条件化，因为这会阻断部分因果效应，导致估计结果偏向于仅评估直接效应。\n3.  **对撞路径**：$T \\to C \\leftarrow U \\to Y$ 是一条非因果路径。在这条路径中，$C$ 是一个对撞因子 (collider)，因为它有两条指向它的箭头 ($T \\to C$ 和 $U \\to C$)。根据 DAG 规则，包含对撞因子的路径在默认情况下是封闭的，不会在 $T$ 和 $Y$ 之间产生关联。然而，如果我们对对撞因子 $C$ 进行条件化，这条路径就会被“打开”，从而在 $T$ 和 $Y$ 之间通过 $U$ 引入一个虚假的关联，导致偏倚。因此，我们**不能**对 $C$ 进行条件化。\n\n综上所述，为了得到 $T$ 对 $Y$ 的总因果效应的无偏估计，我们唯一需要做的就是调整 $L$。因此，最小有效调整集是 $\\{L\\}$。\n\n现在我们来评估各个选项：\n*   **A.** 仅对 $\\{L\\}$ 进行调整。对 $C$ 进行条件化会打开路径 $T \\to C \\leftarrow U \\to Y$ 从而引入偏倚，而对 $M$ 进行条件化会阻断从 $T$ 到 $Y$ 的部分因果效应，从而使总效应估计产生偏倚。这个解释完全正确。\n*   **B.** 对 $\\{L, C\\}$ 进行调整。这个选项是错误的，因为如上所述，对对撞因子 $C$ 进行条件化会引入偏倚。\n*   **C.** 对 $\\{L, M\\}$ 进行调整。这个选项是错误的，因为对中介变量 $M$ 进行条件化会阻断部分因果效应，导致无法估计总效应。\n*   **D.** 对 $\\{L, C, M\\}$ 进行调整。这个选项是错误的，因为它同时犯了对对撞因子和中介变量进行条件化的错误。\n\n因此，选项 A 是唯一正确的答案。", "answer": "$$\\boxed{A}$$", "id": "4364917"}, {"introduction": "一旦我们通过DAG等工具识别了潜在的混杂因素，下一步就是应用统计方法来调整它们的影响。逆概率加权 (Inverse Probability Weighting, IPW) 是一种核心技术，它利用倾向性得分来重新加权样本，从而创建一个“伪人群”，在这个人群中，处理组和对照组的基线特征变得平衡，模拟了随机对照试验的效果。这个练习将指导你从基本原理出发，动手计算一个平均处理效应 (Average Treatment Effect, ATE) 的IPW估计值。[@problem_id:4364875]", "problem": "一项观察性比较效果研究评估了一种新型降压药与常规护理的效果。对于每个个体 $i \\in \\{1,\\dots,n\\}$，令 $T_i \\in \\{0,1\\}$ 表示治疗状态（如果接受了新药治疗，则 $T_i=1$；否则 $T_i=0$），令 $Y_i$ 表示6个月内收缩压的变化（单位为毫米汞柱，$\\mathrm{mm\\,Hg}$；负值表示降低），并令 $\\hat{e}(X_i)$ 表示估计的倾向性得分，定义为在给定已测量协变量 $X_i$ 的条件下接受治疗的估计概率。该研究旨在采用逆概率加权（IPW）方法，在一致性、给定协变量下的条件可交换性和正值性等条件下，估计治疗对结果的因果效应。IPW是一种基于潜在结果框架和迭代期望定律的方法。\n\n从潜在结果 $Y_i(1)$ 和 $Y_i(0)$、定义为 $\\mathbb{E}\\!\\left[Y(1)-Y(0)\\right]$ 的平均治疗效应（ATE）、倾向性得分 $e(X)=\\mathbb{P}(T=1\\mid X)$ 以及 Horvitz–Thompson 风格的重加权逻辑等基本定义出发，推导使用基于 $\\hat{e}(X_i)$ 的权重的 ATE 的 IPW 估计量，然后为下面的样本计算其值。最后，在本研究的背景下，用文字解释目标估计量。\n\n使用以下 $n=10$ 个个体的数据：\n- 个体 1：$T_1=1$, $Y_1=-12$, $\\hat{e}(X_1)=0.70$。\n- 个体 2：$T_2=1$, $Y_2=-8$, $\\hat{e}(X_2)=0.55$。\n- 个体 3：$T_3=1$, $Y_3=-5$, $\\hat{e}(X_3)=0.40$。\n- 个体 4：$T_4=1$, $Y_4=-10$, $\\hat{e}(X_4)=0.80$。\n- 个体 5：$T_5=0$, $Y_5=-4$, $\\hat{e}(X_5)=0.35$。\n- 个体 6：$T_6=0$, $Y_6=-2$, $\\hat{e}(X_6)=0.60$。\n- 个体 7：$T_7=0$, $Y_7=-1$, $\\hat{e}(X_7)=0.25$。\n- 个体 8：$T_8=1$, $Y_8=-7$, $\\hat{e}(X_8)=0.65$。\n- 个体 9：$T_9=0$, $Y_9=-3$, $\\hat{e}(X_9)=0.50$。\n- 个体 10：$T_{10}=0$, $Y_{10}=-6$, $\\hat{e}(X_{10})=0.20$。\n\n使用这些值计算推导出的 IPW 估计量。将最终数值答案四舍五入到四位有效数字。以 $\\mathrm{mm\\,Hg}$ 为单位表示最终效应。", "solution": "在进行解答之前，首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **研究背景**：一项观察性比较效果研究，比较一种新型降压药（$T_i=1$）与常规护理（$T_i=0$）。\n- **样本量**：$n=10$ 个个体。\n- **个体 $i$ 的变量**：\n  - $T_i \\in \\{0, 1\\}$：治疗状态。\n  - $Y_i$：观察到的结果，即 6 个月内收缩压的变化，单位为 $\\mathrm{mm\\,Hg}$。\n  - $\\hat{e}(X_i)$：估计的倾向性得分，表示在协变量 $X_i$ 条件下接受治疗的估计概率，即 $\\hat{\\mathbb{P}}(T_i=1 \\mid X_i)$。\n- **因果框架与假设**：\n  - 潜在结果：$Y_i(1)$（治疗下的结果）和 $Y_i(0)$（对照下的结果）。\n  - 目标估计量：平均治疗效应（ATE），$\\tau = \\mathbb{E}[Y(1) - Y(0)]$。\n  - 方法：使用 Horvitz–Thompson 风格重加权的逆概率加权（IPW）。\n  - 假设：一致性（$Y_i = T_i Y_i(1) + (1-T_i)Y_i(0)$）、条件可交换性（对于 $t \\in \\{0,1\\}$，$Y(t) \\perp T \\mid X$）和正值性（$0  e(X)  1$）。\n- **任务**：\n  1. 推导 ATE 的 IPW 估计量。\n  2. 为提供的样本数据计算其值。\n  3. 在研究背景下解释 ATE。\n- **数据 ($n=10$)**：\n  - $i=1$：$T_1=1$, $Y_1=-12$, $\\hat{e}(X_1)=0.70$\n  - $i=2$：$T_2=1$, $Y_2=-8$, $\\hat{e}(X_2)=0.55$\n  - $i=3$：$T_3=1$, $Y_3=-5$, $\\hat{e}(X_3)=0.40$\n  - $i=4$：$T_4=1$, $Y_4=-10$, $\\hat{e}(X_4)=0.80$\n  - $i=5$：$T_5=0$, $Y_5=-4$, $\\hat{e}(X_5)=0.35$\n  - $i=6$：$T_6=0$, $Y_6=-2$, $\\hat{e}(X_6)=0.60$\n  - $i=7$：$T_7=0$, $Y_7=-1$, $\\hat{e}(X_7)=0.25$\n  - $i=8$：$T_8=1$, $Y_8=-7$, $\\hat{e}(X_8)=0.65$\n  - $i=9$：$T_9=0$, $Y_9=-3$, $\\hat{e}(X_9)=0.50$\n  - $i=10$：$T_{10}=0$, $Y_{10}=-6$, $\\hat{e}(X_{10})=0.20$\n- **计算要求**：将最终数值答案四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题在卫生系统科学和生物统计学领域的因果推断方面有坚实的理论基础。潜在结果、ATE、倾向性得分和 IPW 等概念是该领域的标准和基础。该场景在科学上是现实的。\n- **适定性**：该问题是适定的。它清晰地定义了估计量，提供了所有必要的数据和假设，并要求进行特定的推导和计算。所有倾向性得分都严格介于 0 和 1 之间，满足了该样本的正值性假设。\n- **客观性**：该问题使用精确、客观和正式的语言陈述，不含任何主观或基于意见的内容。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的，因为它具有科学依据、适定性、客观性和完整性。我将继续进行推导和求解。\n\n### ATE 的 IPW 估计量的推导\n\n平均治疗效应（ATE）定义为在治疗和对照条件下潜在结果之间的期望差异：\n$$ \\tau = \\mathbb{E}[Y(1) - Y(0)] $$\n根据期望的线性性质，这可以分为两个部分：\n$$ \\tau = \\mathbb{E}[Y(1)] - \\mathbb{E}[Y(0)] = \\mu_1 - \\mu_0 $$\n我们将使用逆概率加权法为每个部分 $\\mu_1$ 和 $\\mu_0$ 推导一个估计量。\n\n首先，考虑 $\\mu_1 = \\mathbb{E}[Y(1)]$。我们可以使用迭代期望定律将其写为 $\\mu_1 = \\mathbb{E}_X[\\mathbb{E}[Y(1) \\mid X]]$。IPW 的关键思想是构建一个其期望值为 $\\mu_1$ 的量。考虑随机变量 $\\frac{TY}{e(X)}$，其中 $T$ 是治疗指示变量，$Y$ 是观察到的结果，$e(X) = \\mathbb{P}(T=1 \\mid X)$ 是真实的倾向性得分。其期望值为：\n$$ \\mathbb{E}\\left[\\frac{TY}{e(X)}\\right] = \\mathbb{E}_X\\left[\\mathbb{E}\\left[\\frac{TY}{e(X)} \\mid X\\right]\\right] $$\n在以 $X$ 为条件时，$e(X)$ 是一个常数，所以：\n$$ \\mathbb{E}\\left[\\frac{TY}{e(X)} \\mid X\\right] = \\frac{1}{e(X)} \\mathbb{E}[TY \\mid X] $$\n项 $\\mathbb{E}[TY \\mid X]$ 展开为 $\\mathbb{P}(T=1 \\mid X) \\mathbb{E}[Y \\mid T=1, X] + \\mathbb{P}(T=0 \\mid X) \\mathbb{E}[Y \\mid T=0, X] \\times 0$。根据定义，$\\mathbb{P}(T=1 \\mid X) = e(X)$，所以这简化为 $e(X) \\mathbb{E}[Y \\mid T=1, X]$。将其代回得到：\n$$ \\mathbb{E}\\left[\\frac{TY}{e(X)} \\mid X\\right] = \\frac{1}{e(X)} [e(X) \\mathbb{E}[Y \\mid T=1, X]] = \\mathbb{E}[Y \\mid T=1, X] $$\n现在，我们应用因果假设。根据一致性假设，对于接受治疗的个体（$T=1$），他们观察到的结果就是他们在治疗下的潜在结果：$Y=Y(1)$。因此，$\\mathbb{E}[Y \\mid T=1, X] = \\mathbb{E}[Y(1) \\mid T=1, X]$。根据条件可交换性假设（$Y(1) \\perp T \\mid X$），我们有 $\\mathbb{E}[Y(1) \\mid T=1, X] = \\mathbb{E}[Y(1) \\mid X]$。结合这些步骤，我们证明了：\n$$ \\mathbb{E}\\left[\\frac{TY}{e(X)}\\right] = \\mathbb{E}_X[\\mathbb{E}[Y(1) \\mid X]] = \\mathbb{E}[Y(1)] = \\mu_1 $$\n对于 $\\mu_0 = \\mathbb{E}[Y(0)]$，也存在一个类似的推导。我们考虑量 $\\frac{(1-T)Y}{1-e(X)}$：\n$$ \\mathbb{E}\\left[\\frac{(1-T)Y}{1-e(X)}\\right] = \\mathbb{E}_X\\left[\\frac{1}{1-e(X)} \\mathbb{E}[(1-T)Y \\mid X]\\right] $$\n内部期望是 $\\mathbb{P}(T=0 \\mid X) \\mathbb{E}[Y \\mid T=0, X] = (1-e(X))\\mathbb{E}[Y \\mid T=0, X]$。这导致：\n$$ \\mathbb{E}\\left[\\frac{(1-T)Y}{1-e(X)}\\right] = \\mathbb{E}_X[\\mathbb{E}[Y \\mid T=0, X]] $$\n根据一致性（如果 $T=0$，则 $Y=Y(0)$）和条件可交换性（$Y(0) \\perp T \\mid X$），这变为 $\\mathbb{E}_X[\\mathbb{E}[Y(0) \\mid X]] = \\mathbb{E}[Y(0)] = \\mu_0$。\n结合 $\\mu_1$ 和 $\\mu_0$ 的结果：\n$$ \\tau = \\mu_1 - \\mu_0 = \\mathbb{E}\\left[\\frac{TY}{e(X)}\\right] - \\mathbb{E}\\left[\\frac{(1-T)Y}{1-e(X)}\\right] = \\mathbb{E}\\left[\\frac{TY}{e(X)} - \\frac{(1-T)Y}{1-e(X)}\\right] $$\n基于矩估计法，我们可以用样本均值来估计这个期望。这就得到了 ATE 的 Horvitz-Thompson 风格的 IPW 估计量，其中使用了估计的倾向性得分 $\\hat{e}(X_i)$：\n$$ \\hat{\\tau}_{IPW} = \\frac{1}{n} \\sum_{i=1}^{n} \\left(\\frac{T_i Y_i}{\\hat{e}(X_i)} - \\frac{(1-T_i)Y_i}{1-\\hat{e}(X_i)}\\right) $$\n这个表达式可以分解为来自治疗组（$T_i=1$）和对照组（$T_i=0$）的贡献：\n$$ \\hat{\\tau}_{IPW} = \\frac{1}{n} \\sum_{i: T_i=1} \\frac{Y_i}{\\hat{e}(X_i)} - \\frac{1}{n} \\sum_{i: T_i=0} \\frac{Y_i}{1-\\hat{e}(X_i)} $$\n注意，$\\hat{\\tau}_{IPW} = \\hat{\\mu}_1 - \\hat{\\mu}_0$，其中 $\\hat{\\mu}_1 = \\frac{1}{n}\\sum_{i} \\frac{T_i Y_i}{\\hat{e}(X_i)}$ 和 $\\hat{\\mu}_0 = \\frac{1}{n}\\sum_{i} \\frac{(1-T_i)Y_i}{1-\\hat{e}(X_i)}$。\n\n### 估计量的计算\n\n我们现在为给定的 $n=10$ 的样本计算 $\\hat{\\tau}_{IPW}$ 的值。\n\n首先，我们计算治疗组个体（$T_i=1$）的加权结果之和：\n- $i=1$: $\\frac{Y_1}{\\hat{e}(X_1)} = \\frac{-12}{0.70} \\approx -17.142857$\n- $i=2$: $\\frac{Y_2}{\\hat{e}(X_2)} = \\frac{-8}{0.55} \\approx -14.545455$\n- $i=3$: $\\frac{Y_3}{\\hat{e}(X_3)} = \\frac{-5}{0.40} = -12.5$\n- $i=4$: $\\frac{Y_4}{\\hat{e}(X_4)} = \\frac{-10}{0.80} = -12.5$\n- $i=8$: $\\frac{Y_8}{\\hat{e}(X_8)} = \\frac{-7}{0.65} \\approx -10.769231$\n治疗组的总和是：\n$$ \\sum_{i: T_i=1} \\frac{Y_i}{\\hat{e}(X_i)} \\approx -17.142857 - 14.545455 - 12.5 - 12.5 - 10.769231 = -67.457543 $$\n因此，治疗条件下平均潜在结果的估计值为 $\\hat{\\mu}_1 = \\frac{-67.457543}{10} = -6.7457543$。\n\n接下来，我们计算对照组个体（$T_i=0$）的加权结果之和：\n- $i=5$: $\\frac{Y_5}{1-\\hat{e}(X_5)} = \\frac{-4}{1-0.35} = \\frac{-4}{0.65} \\approx -6.153846$\n- $i=6$: $\\frac{Y_6}{1-\\hat{e}(X_6)} = \\frac{-2}{1-0.60} = \\frac{-2}{0.40} = -5.0$\n- $i=7$: $\\frac{Y_7}{1-\\hat{e}(X_7)} = \\frac{-1}{1-0.25} = \\frac{-1}{0.75} \\approx -1.333333$\n- $i=9$: $\\frac{Y_9}{1-\\hat{e}(X_9)} = \\frac{-3}{1-0.50} = \\frac{-3}{0.50} = -6.0$\n- $i=10$: $\\frac{Y_{10}}{1-\\hat{e}(X_{10})} = \\frac{-6}{1-0.20} = \\frac{-6}{0.80} = -7.5$\n对照组的总和是：\n$$ \\sum_{i: T_i=0} \\frac{Y_i}{1-\\hat{e}(X_i)} \\approx -6.153846 - 5.0 - 1.333333 - 6.0 - 7.5 = -25.987179 $$\n因此，对照条件下平均潜在结果的估计值为 $\\hat{\\mu}_0 = \\frac{-25.987179}{10} = -2.5987179$。\n\n最后，ATE 估计值是这两个估计均值之差：\n$$ \\hat{\\tau}_{IPW} = \\hat{\\mu}_1 - \\hat{\\mu}_0 \\approx -6.7457543 - (-2.5987179) = -4.1470364 $$\n四舍五入到四位有效数字，结果是 $-4.147$。\n\n### 目标估计量的解释\n\n目标估计量，即平均治疗效应（ATE），$\\mathbb{E}[Y(1) - Y(0)]$，代表了与常规护理相比，新药对 6 个月内收缩压变化的平均因果效应，该效应是针对抽样所来自的整个群体而言的。具体来说，它是指如果我们让群体中的每个个体都服用新药 6 个月，所观察到的平均收缩压变化，与如果我们让该群体中的每个个体都接受常规护理 6 个月，所观察到的平均收缩压变化之间的差异。像这里估计出的负值表明，与常规护理相比，新药能导致收缩压的平均降幅更大。估计效应为 $-4.147\\,\\mathrm{mm\\,Hg}$，表明与常规护理相比，新药在 6 个月内平均额外多降低约 $4.15\\,\\mathrm{mm\\,Hg}$ 的收缩压。", "answer": "$$\n\\boxed{-4.147}\n$$", "id": "4364875"}, {"introduction": "在观察性研究中，即使我们调整了所有已知的混杂因素，研究结果的有效性仍然可能受到未测量混杂因素的威胁。E值是一种敏感性分析工具，它帮助我们量化一个未测量的混杂因素需要多强才能完全“解释掉”我们观察到的关联。这项练习将向你展示如何计算和解释E值，从而为评估研究结论的稳健性提供一个重要的量化指标。[@problem_id:4364910]", "problem": "一项非随机化比较效果研究（CER）比较了一种新型抗凝剂与一种标准药物在预防心房颤动患者发生凝血事件方面的效果。在对已测量的协变量进行调整后，使用新型抗凝剂相对于标准药物发生大出血的估计风险比（RR）为 $RR=1.65$。为评估结果对未测量混杂的稳健性，您决定量化一个未测量的混杂因素需要与治疗分配和结局在风险比尺度上具有的最小关联强度（在调整已测量协变量的条件下），才能完全解释观察到的关联（即将真实的因果风险比降至 $1$）。\n\n从卫生系统科学和比较效果研究中使用的核心定义出发——即风险比 $RR$ 定义为暴露组与非暴露组之间的风险之比，混杂是治疗和结局的共同原因这一概念，以及将未测量混杂的量级与风险比尺度上的偏倚联系起来的经过充分检验的界限——在简化假设（即未测量的混杂因素是二元的，且其与治疗和结局的关联在风险比尺度上相等）下，推导出这种最小所需强度的表达式。然后，使用您推导的表达式计算观察到的 $RR=1.65$ 所对应的证据值，也称为 E 值。\n\n最后，简要解释计算出的量值对于要完全解释观察到的关联所需未测量混杂的程度意味着什么，假设已测量的协变量已得到充分调整。\n\n将您的最终数值答案四舍五入到四位有效数字，并以无单位小数表示。不要在您的答案中包含任何置信区间或不确定性量化。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了流行病学方法和比较效果研究中的一个标准任务：使用 E 值框架对未测量的混杂进行敏感性分析。所提供的数据充分且一致，足以推导所要求的表达式并进行计算。因此，该问题是有效的。\n\n我们首先将问题形式化。设 $E$ 表示暴露，其中 $E=1$ 代表新型抗凝剂，$E=0$ 代表标准药物。设 $D$ 表示二元结局，其中 $D=1$ 代表发生大出血事件，$D=0$ 代表未发生事件。观察到的风险比如下：$RR_{\\text{obs}} = 1.65$。这是暴露组中结局风险与非暴露组中结局风险的比值：\n$$RR_{\\text{obs}} = \\frac{\\mathbb{P}(D=1 \\mid E=1)}{\\mathbb{P}(D=1 \\mid E=0)}$$\n目标是评估一个未测量的混杂因素 $U$ 对这一观察到的关联的潜在影响。我们需要找到 $U$ 必须与 $E$ 和 $D$ 同时具有的最小关联强度，才能完全解释观察到的效应。“完全解释”意味着真实的因果风险比 $RR_{\\text{true}}$ 等于 $1$，而观察到的关联完全是混杂造成的一种假象。\n\n观察到的风险比、真实的风险比和混杂偏倚之间的关系可以表示为 $RR_{\\text{obs}} = RR_{\\text{true}} \\times B$，其中 $B$ 是偏倚因子。如果要让该效应完全由混杂来解释，那么 $RR_{\\text{true}} = 1$，这意味着 $B = RR_{\\text{obs}}$。\n\n问题要求我们使用“将未测量混杂的量级与风险比尺度上的偏倚联系起来的经过充分检验的界限”。对于单个、未测量的二元混杂因素 $U$，偏倚因子 $B$ 的一个既定界限由表征该混杂因素与暴露和结局关联的参数给出。设 $RR_{EU}$ 为混杂因素与暴露之间关联的风险比，设 $RR_{UD}$ 为在调整已测量协变量的条件下，混杂因素与结局之间关联的风险比。可产生的最大偏倚因子 $B_{\\text{max}}$ 是有界的。文献中的一个关键结果（Ding  VanderWeele, 2016）给出了最大可能偏倚因子如下：\n$$B \\le \\frac{RR_{EU} \\cdot RR_{UD}}{RR_{EU} + RR_{UD} - 1}$$\n该界限在混杂因素患病率的最坏情景下成立，并假设 $RR_{EU} > 1$ 和 $RR_{UD} > 1$。\n\n问题引入了一个简化假设，即混杂因素与治疗和结局的关联在风险比尺度上是相等的。我们用 $\\gamma$ 表示这个共同的关联强度。\n$$ \\gamma = RR_{EU} = RR_{UD} $$\n将 $\\gamma$ 代入偏倚因子的不等式，最大可能偏倚变为：\n$$ B \\le \\frac{\\gamma^2}{2\\gamma - 1} $$\n为了找到能够完全解释观察到的风险比 $RR_{\\text{obs}}$ 的 $\\gamma$ 的最小值，我们将观察到的风险比设为等于这个最大可能偏倚：\n$$ RR_{\\text{obs}} = \\frac{\\gamma^2}{2\\gamma - 1} $$\n我们现在求解这个关于 $\\gamma$ 的方程。\n$$ RR_{\\text{obs}} (2\\gamma - 1) = \\gamma^2 $$\n$$ 2\\gamma \\cdot RR_{\\text{obs}} - RR_{\\text{obs}} = \\gamma^2 $$\n整理各项得到一个关于 $\\gamma$ 的二次方程：\n$$ \\gamma^2 - (2 \\cdot RR_{\\text{obs}})\\gamma + RR_{\\text{obs}} = 0 $$\n我们使用二次方程求根公式 $\\gamma = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\gamma$ 的方程，其中 $a=1$，$b = -2 \\cdot RR_{\\text{obs}}$，$c = RR_{\\text{obs}}$。\n$$ \\gamma = \\frac{2 \\cdot RR_{\\text{obs}} \\pm \\sqrt{(-2 \\cdot RR_{\\text{obs}})^2 - 4(1)(RR_{\\text{obs}})}}{2(1)} $$\n$$ \\gamma = \\frac{2 \\cdot RR_{\\text{obs}} \\pm \\sqrt{4 \\cdot RR_{\\text{obs}}^2 - 4 \\cdot RR_{\\text{obs}}}}{2} $$\n$$ \\gamma = \\frac{2 \\cdot RR_{\\text{obs}} \\pm 2\\sqrt{RR_{\\text{obs}}^2 - RR_{\\text{obs}}}}{2} $$\n$$ \\gamma = RR_{\\text{obs}} \\pm \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}} - 1)} $$\n这会产生两个可能的 $\\gamma$ 解。然而，$\\gamma$ 代表混杂关联的强度，对于一个观察到的 $RR_{\\text{obs}} > 1$，它必须大于 $1$ 才能产生正向偏倚。我们来检验较小的根，$\\gamma_{-} = RR_{\\text{obs}} - \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}} - 1)}$。对于任何 $RR_{\\text{obs}} > 1$，我们有 $RR_{\\text{obs}} - 1  \\sqrt{(RR_{\\text{obs}})^2 - RR_{\\text{obs}}} = \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}} - 1)}$。因此，$\\gamma_{-}$ 将小于 $1$。由于混杂风险比必须大于 $1$ 才能引起观察到的正向关联，所以较小的根不是相关的解。所需的最小关联强度必须是较大的根。\n\n因此，最小所需强度的表达式，也就是 E 值的定义，是：\n$$ \\text{E-value} = RR_{\\text{obs}} + \\sqrt{RR_{\\text{obs}}(RR_{\\text{obs}} - 1)} $$\n\n接下来，我们计算观察到的风险比 $RR_{\\text{obs}} = 1.65$ 的 E 值。\n$$ \\text{E-value} = 1.65 + \\sqrt{1.65(1.65 - 1)} $$\n$$ \\text{E-value} = 1.65 + \\sqrt{1.65(0.65)} $$\n$$ \\text{E-value} = 1.65 + \\sqrt{1.0725} $$\n$$ \\text{E-value} \\approx 1.65 + 1.03561576 $$\n$$ \\text{E-value} \\approx 2.68561576 $$\n四舍五入到四位有效数字，我们得到 $2.686$。\n\n最后，我们解释这个结果。E 值为 $2.686$ 意味着，要让一个未测量的混杂因素完全解释观察到的 $1.65$ 的风险比，该混杂因素需要与暴露（接受新型抗凝剂）和结局（大出血）都相关，在调整了分析中已包含的协变量后，其各自的风险比至少为 $2.686$。例如，如果一个未测量的遗传因素是这个混杂因素，那么它需要使患者接受新药的几率增加 $2.686$ 倍，并且还要独立地使大出血的风险增加 $2.686$ 倍。观察到的关联完全由混杂引起的可能性，可以通过考虑是否存在如此强的、未被测量的混杂因素来判断。E 值越大，表明研究结果对未测量混杂的稳健性越强。在这种情况下，研究人员必须评估，在心房颤动治疗的背景下，一个关联强度达到 $2.686$ 的混杂因素是否合理。", "answer": "$$\n\\boxed{2.686}\n$$", "id": "4364910"}]}